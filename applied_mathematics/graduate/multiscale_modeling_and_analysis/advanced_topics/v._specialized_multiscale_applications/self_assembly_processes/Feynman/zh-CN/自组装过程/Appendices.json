{
    "hands_on_practices": [
        {
            "introduction": "自组装代表了从无序到有序的迷人转变，其驱动力是能量与熵之间微妙的相互作用。一个基本问题是确定有序结构在何种条件下能够达到热力学稳定。本练习  将指导您使用平均场近似这一统计力学中的强大工具，来推导基于格点系统的临界温度 $T_c$。通过这个练习，您将从第一性原理层面理解微观相互作用如何引发宏观相变。",
            "id": "3805762",
            "problem": "考虑一个在规则晶格上的自组装过程，该过程在介观尺度上通过晶格气 (Lattice Gas, LG) 模型进行建模，其中格点 $i = 1,\\dots,N$ 上的占据变量为 $n_{i} \\in \\{0,1\\}$。两个被占据的最近邻格点 $\\langle i j \\rangle$ 对微观态能量贡献一个吸引对能量 $-\\epsilon$，其中 $\\epsilon > 0$ 是对相互作用强度。每个格点有 $z$ 个最近邻（配位数），并假设系统很大且具有平移不变性。令粗粒化序参量为平均占据数（覆盖度）$\\phi = \\langle n_{i} \\rangle$。\n\n使用平均场 (Mean-Field, MF) 近似，其中对关联函数分解为 $\\langle n_{i} n_{j} \\rangle \\approx \\langle n_{i} \\rangle \\langle n_{j} \\rangle = \\phi^{2}$，以及经过充分检验的独立格点占据的组合（混合）熵，构建每个格点的亥姆霍兹 (Helmholtz) 自由能 $f(\\phi,T)$，该自由能结合了熵的贡献和平均相互作用能。然后，在对称点 $\\phi = \\tfrac{1}{2}$ 对无序态进行稳定性分析，以确定有序组装（非均匀、对称性破缺态）相对于无序态变得热力学稳定的温度，即无序态失去局部凸性的温度。\n\n从基本定义和上述平均场近似出发，推导临界温度 $T_{c}$ 关于配位数 $z$、对相互作用 $\\epsilon$ 和玻尔兹曼 (Boltzmann) 常数 $k_{B}$ 的封闭形式表达式。忽略外场和长程相互作用，并假设为具有均匀 $z$ 的规则晶格。\n\n请以 $z$、$\\epsilon$ 和 $k_{B}$ 的符号表达式形式提供最终答案。无需进行数值计算或四舍五入。最终的方框表达式中不要包含单位。",
            "solution": "该问题要求在平均场 (Mean-Field, MF) 近似下推导晶格气模型的临界温度 $T_c$。临界温度标志着均匀（无序）相不稳定性的开始，预示着向有序（相分离）态的转变。这种不稳定性对应于每个格点的亥姆霍兹自由能 $f(\\phi, T)$ 在对称点处局部凸性的丧失。\n\n推导过程主要分为三个步骤：\n$1$. 使用平均场近似构建每个格点的平均内能 $u(\\phi)$。\n$2$. 使用独立格点占据的组合公式构建每个格点的构型熵 $s(\\phi)$。\n$3$. 构建每个格点的亥姆霍兹自由能 $f(\\phi, T) = u(\\phi) - T s(\\phi)$，并通过考察其关于序参量 $\\phi$ 的二阶导数进行后续的稳定性分析。\n\n首先，我们确定每个格点的平均内能 $u(\\phi)$。该模型为每对被占据的最近邻格点定义了一个吸引能贡献 $-\\epsilon$，其中 $\\epsilon > 0$。对于一个有 $N$ 个格点且配位数为 $z$ 的规则晶格，最近邻对的总数为 $\\frac{Nz}{2}$。任意两个特定的最近邻格点（例如 $i$ 和 $j$）都被占据的概率由对关联函数 $\\langle n_i n_j \\rangle$ 给出。在平均场近似中，该关联被分解为：$\\langle n_i n_j \\rangle \\approx \\langle n_i \\rangle \\langle n_j \\rangle$。由于平移不变性，所有格点的平均占据数是均匀的，即对所有 $i$ 都有 $\\langle n_i \\rangle = \\phi$。因此，发生相互作用的概率是 $\\phi^2$。\n\n系统的总平均内能 $U$ 是总对数、每对发生相互作用的概率以及每次相互作用能量的乘积：\n$$U(\\phi) = \\left(\\frac{Nz}{2}\\right) \\langle n_i n_j \\rangle (-\\epsilon) \\approx \\left(\\frac{Nz}{2}\\right) \\phi^2 (-\\epsilon) = -\\frac{Nz\\epsilon}{2} \\phi^2$$\n那么，每个格点的平均内能 $u(\\phi)$ 为：\n$$u(\\phi) = \\frac{U(\\phi)}{N} = -\\frac{z\\epsilon}{2} \\phi^2$$\n\n接下来，我们确定每个格点的构型熵 $s(\\phi)$。系统包含 $N$ 个格点，其中 $N\\phi$ 个格点被占据，$N(1-\\phi)$ 个格点为空。将这 $N\\phi$ 个粒子排列在 $N$ 个格点上的方式数 $\\Omega$ 由二项式系数给出：\n$$\\Omega = \\binom{N}{N\\phi} = \\frac{N!}{(N\\phi)![N(1-\\phi)]!}$$\n熵 $S$ 由玻尔兹曼公式给出，$S = k_B \\ln \\Omega$，其中 $k_B$ 是玻尔兹曼常数。\n$$S(\\phi) = k_B \\ln\\left( \\frac{N!}{(N\\phi)![N(1-\\phi)]!} \\right)$$\n对于大系统（$N \\to \\infty$），我们使用斯特林 (Stirling) 近似公式 $\\ln(m!) \\approx m \\ln(m) - m$：\n$$S(\\phi) \\approx k_B \\left[ (N\\ln N - N) - (N\\phi \\ln(N\\phi) - N\\phi) - (N(1-\\phi)\\ln(N(1-\\phi)) - N(1-\\phi)) \\right]$$\n展开各项：\n$$S(\\phi) \\approx k_B \\left[ N\\ln N - N - N\\phi(\\ln N + \\ln\\phi) + N\\phi - N(1-\\phi)(\\ln N + \\ln(1-\\phi)) + N(1-\\phi) \\right]$$\n项 $N\\ln N$、$N\\phi \\ln N$ 和 $N(1-\\phi)\\ln N$相互抵消，项 $-N$、$+N\\phi$ 和 $+N(1-\\phi)$ 也同样抵消。简化后得到：\n$$S(\\phi) \\approx -N k_B \\left[ \\phi\\ln\\phi + (1-\\phi)\\ln(1-\\phi) \\right]$$\n每个格点的熵 $s(\\phi)$ 为：\n$$s(\\phi) = \\frac{S(\\phi)}{N} = -k_B \\left[ \\phi\\ln\\phi + (1-\\phi)\\ln(1-\\phi) \\right]$$\n\n现在我们通过组合能量和熵的贡献来构建每个格点的亥姆霍兹自由能 $f(\\phi, T)$：$f = u - Ts$。\n$$f(\\phi, T) = -\\frac{z\\epsilon}{2}\\phi^2 - T \\left( -k_B \\left[ \\phi\\ln\\phi + (1-\\phi)\\ln(1-\\phi) \\right] \\right)$$\n$$f(\\phi, T) = -\\frac{z\\epsilon}{2}\\phi^2 + k_B T \\left[ \\phi\\ln\\phi + (1-\\phi)\\ln(1-\\phi) \\right]$$\n\n无序（均匀）态的稳定性由自由能相对于序参量 $\\phi$ 的曲率决定。如果 $f(\\phi, T)$ 是凸的，即 $\\frac{\\partial^2 f}{\\partial \\phi^2} > 0$，则该状态是局部稳定的。稳定性的极限，即旋节线点 (spinodal point)，出现在曲率为零的地方，即 $\\frac{\\partial^2 f}{\\partial \\phi^2} = 0$。我们计算 $f(\\phi, T)$ 对 $\\phi$ 的二阶导数。\n\n一阶导数：\n$$\\frac{\\partial f}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\left( -\\frac{z\\epsilon}{2}\\phi^2 + k_B T \\left[ \\phi\\ln\\phi + (1-\\phi)\\ln(1-\\phi) \\right] \\right)$$\n$$\\frac{\\partial f}{\\partial \\phi} = -z\\epsilon\\phi + k_B T \\left[ (\\ln\\phi + \\frac{\\phi}{\\phi}) + (-\\ln(1-\\phi) - \\frac{1-\\phi}{1-\\phi}) \\right]$$\n$$\\frac{\\partial f}{\\partial \\phi} = -z\\epsilon\\phi + k_B T \\left[ \\ln\\phi - \\ln(1-\\phi) \\right] = -z\\epsilon\\phi + k_B T \\ln\\left(\\frac{\\phi}{1-\\phi}\\right)$$\n\n二阶导数：\n$$\\frac{\\partial^2 f}{\\partial \\phi^2} = \\frac{\\partial}{\\partial \\phi} \\left( -z\\epsilon\\phi + k_B T \\left[ \\ln\\phi - \\ln(1-\\phi) \\right] \\right)$$\n$$\\frac{\\partial^2 f}{\\partial \\phi^2} = -z\\epsilon + k_B T \\left[ \\frac{1}{\\phi} - \\frac{-1}{1-\\phi} \\right] = -z\\epsilon + k_B T \\left[ \\frac{1}{\\phi} + \\frac{1}{1-\\phi} \\right]$$\n$$\\frac{\\partial^2 f}{\\partial \\phi^2} = -z\\epsilon + \\frac{k_B T}{\\phi(1-\\phi)}$$\n\n问题要求的是对称点 $\\phi = \\frac{1}{2}$ 处的临界温度 $T_c$。这是在该浓度下，无序态首次变得不稳定的温度。我们在 $\\phi = \\frac{1}{2}$ 和 $T = T_c$ 处将二阶导数设为零：\n$$\\left. \\frac{\\partial^2 f}{\\partial \\phi^2} \\right|_{\\phi=\\frac{1}{2}, T=T_c} = -z\\epsilon + \\frac{k_B T_c}{\\frac{1}{2}\\left(1-\\frac{1}{2}\\right)} = 0$$\n$$-z\\epsilon + \\frac{k_B T_c}{1/4} = 0$$\n$$-z\\epsilon + 4k_B T_c = 0$$\n求解 $T_c$ 可得到临界温度的表达式：\n$$4k_B T_c = z\\epsilon$$\n$$T_c = \\frac{z\\epsilon}{4k_B}$$\n这是晶格气模型的平均场临界温度，它在数学上等同于二元合金的 Bragg-Williams 近似或伊辛 (Ising) 模型的平均场解。低于此温度，自由能在偏离 $\\phi = \\frac{1}{2}$ 的位置出现两个极小值，使得向低密度和高密度区域的相分离在热力学上是有利的。",
            "answer": "$$\\boxed{\\frac{z\\epsilon}{4k_B}}$$"
        },
        {
            "introduction": "热力学告诉我们自组装过程*是否*有利，而动力学则揭示其发生的*速率*。许多自组装过程，即使在能量上总体是下坡的，也必须首先越过一个自由能垒才能形成稳定的核。本练习  深入探讨了经典成核理论以量化此过程，要求您推导并计算稳态成核速率 $J$。该练习将热力学自由能形貌与动力学速率联系起来，这是预测自组装时间尺度的关键一步。",
            "id": "3805754",
            "problem": "考虑一个溶液中的自组装过程，该过程在介观尺度上通过团簇尺寸变量 $n$ 和一个在临界尺寸 $n^{*}$ 处存在成核势垒的自由能形貌 $\\Delta G(n)$ 来建模。团簇尺寸分布 $c(n,t)$ 的时间演化由 $n$ 空间中的一维 Fokker-Planck 方程（FPE）描述，该过程由随机的单体添加/脱离事件驱动，并受到 $\\Delta G(n)$ 梯度的偏置，其热尺度由玻尔兹曼常数 $k_{B}$ 和温度 $T$ 设定。在稳态下，单位体积的成核速率 $J$ 等于在 $n$ 空间中穿过 $n^{*}$ 处势垒顶部的恒定通量。在 $n^{*}$ 附近，假设势垒是局部二次的，$\\Delta G(n) \\approx \\Delta G^{*} + \\frac{1}{2} \\Delta G''(n^{*}) (n-n^{*})^{2}$，其中曲率为负 $\\Delta G''(n^{*})  0$。\n\n从 FPE 和应用于尺寸坐标 $n$ 的一维越垒第一性原理（Kramers 理论）出发，推导稳态成核速率 $J$ 的表达式，该表达式用势垒顶部曲率 $\\Delta G''(n^{*})$、正向单体附着频率 $f^{+}$ 和临界团簇的平衡浓度 $c_{n^{*}}$ 来表示。你的推导应清楚地表明尺寸坐标中的动力学系数与 $f^{+}$ 的等同关系，并展示勢壘曲率是如何作为归一化因子引入的。\n\n然后，使用以下从多尺度建模中获得的物理上一致的参数来计算 $J$：比率 $\\Delta G''(n^{*})/(k_{B}T)$ 为 $-0.015708$，温度为 $T=300\\ \\mathrm{K}$，单体扩散系数为 $D=2.0\\times 10^{-10}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$，临界团簇的捕获半径为 $R^{*}=2.5\\times 10^{-9}\\ \\mathrm{m}$，单体浓度为 $c_{1}=1.0\\times 10^{24}\\ \\mathrm{m}^{-3}$，临界团簇的平衡浓度为 $c_{n^{*}}=1.00\\times 10^{11}\\ \\mathrm{m}^{-3}$。将临界尺寸下的单体附着视为扩散限制过程。以 $\\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$ 为单位表示最终的单位体积成核速率，并将答案四舍五入到 $4$ 位有效数字。",
            "solution": "该问题要求基于团簇生长的 Fokker-Planck 形式主义推导稳态成核速率 $J$，然后利用一组给定的物理参数对该速率进行数值计算。\n\n**第 1 部分：成核速率 $J$ 的推导**\n\n团簇尺寸分布 $c(n,t)$（其中 $n$ 是团簇中的单体数）的时间演化，可以由连续变量 $n$ 的一维 Fokker-Planck 方程（FPE）描述。FPE 是一个连续性方程，$\\frac{\\partial c(n,t)}{\\partial t} = -\\frac{\\partial J(n,t)}{\\partial n}$，其中 $J(n,t)$ 是尺寸空间中团簇的通量。该通量由一个扩散项和一个由自由能梯度引起的漂移项驱动：\n$$J(n,t) = -D_n(n) \\frac{\\partial c(n,t)}{\\partial n} - D_n(n) \\frac{c(n,t)}{k_B T} \\frac{d\\Delta G(n)}{dn}$$\n此处，$\\Delta G(n)$ 是形成尺寸为 $n$ 的团簇的自由能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$D_n(n)$ 是尺寸空间中的“扩散系数”。\n\n为了确定 $D_n(n)$，我们考虑其底层的离散过程，即单体的添加和脱离：\n$n \\xrightarrow{f^+(n)} n+1$ 和 $n \\xleftarrow{f^-(n)} n-1$，其中 $f^+(n)$ 和 $f^-(n)$ 分别是正向和反向速率频率。在离散图像中，从尺寸 $n$到 $n+1$ 的净通量为 $J_n = f^+(n) c(n) - f^-(n+1) c(n+1)$。在连续极限下（$n \\gg 1$），这必须与 FPE 通量 $J(n)$ 相匹配。在平衡状态（$J=0$）下，我们有细致平衡：$f^+(n) c_{eq}(n) = f^-(n+1) c_{eq}(n+1)$。平衡分布由玻尔兹曼因子给出，$c_{eq}(n) \\propto \\exp(-\\Delta G(n)/k_B T)$。这意味着 $f^-(n+1) = f^+(n) \\frac{c_{eq}(n)}{c_{eq}(n+1)} = f^+(n) \\exp\\left(\\frac{\\Delta G(n+1)-\\Delta G(n)}{k_B T}\\right)$。\n对大的 $n$ 进行展开，$\\Delta G(n+1)-\\Delta G(n) \\approx \\frac{d\\Delta G}{dn}$。因此，$f^-(n+1) \\approx f^+(n) \\exp(\\frac{1}{k_B T}\\frac{d\\Delta G}{dn})$。\n展开连续通量 $J(n) \\approx f^+(n)c(n) - f^-(n+1)(c(n)+\\frac{\\partial c}{\\partial n})$，并对小梯度使用 $f^-(n+1)$ 的近似，我们发现：\n$$J(n) \\approx -f^+(n) \\left(\\frac{\\partial c}{\\partial n} + \\frac{c}{k_B T} \\frac{d\\Delta G}{dn}\\right)$$\n通过将其与 FPE 通量表达式进行比较，我们将动力学系数（尺寸空间中的扩散系数）确定为正向单体附着频率：$D_n(n) = f^+(n)$。因此，通量为：\n$$J(n,t) = -f^+(n) \\left( \\frac{\\partial c(n,t)}{\\partial n} + \\frac{c(n,t)}{k_B T} \\frac{d\\Delta G(n)}{dn} \\right)$$\n在稳态下，$\\frac{\\partial c}{\\partial t} = 0$，这意味着通量 $J$ 相对于 $n$ 是恒定的。我们可以将稳态通量方程重写为：\n$$\\frac{J}{f^+(n)} = -\\exp\\left(-\\frac{\\Delta G(n)}{k_B T}\\right) \\frac{d}{dn} \\left[ c(n) \\exp\\left(\\frac{\\Delta G(n)}{k_B T}\\right) \\right]$$\n我们对该方程进行重排，并跨越成核势垒进行积分，从小编簇区域（例如 $n=a$）到大团簇区域（例如 $n=b$）：\n$$J \\int_{a}^{b} \\frac{\\exp(\\frac{\\Delta G(n)}{k_B T})}{f^+(n)} dn = -\\left[ c(n) \\exp\\left(\\frac{\\Delta G(n)}{k_B T}\\right) \\right]_{a}^{b}$$\n成核的边界条件是：\n1. 对于小的 $n$（在 $n=a$ 处），团簇与单体处于平衡状态，因此 $c(a) = c_{eq}(a)$。\n2. 对于大的 $n$（在 $n=b$ 处），团簇已越过势垒并被消耗，因此 $c(b) \\to 0$。\n平衡浓度为 $c_{eq}(n) = c_{eq}(n^*) \\exp\\left( -\\frac{\\Delta G(n)-\\Delta G(n^*)}{k_B T} \\right)$，其中 $c_{n^*} \\equiv c_{eq}(n^*)$ 是临界团簇的平衡浓度。在 $n=a$ 处，右侧（RHS）项为 $c_{eq}(a)\\exp(\\frac{\\Delta G(a)}{k_B T}) = c_{n^*} \\exp(\\frac{\\Delta G(n^*)}{k_B T})$。\n积分方程的右侧变为 $c_{n^*} \\exp(\\Delta G^*/k_B T)$，其中 $\\Delta G^* \\equiv \\Delta G(n^*)$。\n$$J = \\frac{c_{n^*} \\exp(\\Delta G^*/k_B T)}{\\int_{a}^{b} \\frac{\\exp(\\Delta G(n)/k_B T)}{f^+(n)} dn}$$\n分母中的积分主要由 $n=n^*$ 处势垒最大值周围的区域贡献。因此，我们可以近似 $f^+(n) \\approx f^+(n^*) \\equiv f^+$ 并使用自由能势垒的二次展开：\n$$\\Delta G(n) \\approx \\Delta G^* + \\frac{1}{2} \\Delta G''(n^*) (n-n^*)^2$$\n其中 $\\Delta G''(n^*)  0$。积分变为：\n$$I = \\int_{a}^{b} \\frac{\\exp(\\frac{\\Delta G(n)}{k_B T})}{f^+} dn \\approx \\frac{1}{f^+} \\int_{-\\infty}^{\\infty} \\exp\\left(\\frac{\\Delta G^* + \\frac{1}{2} \\Delta G''(n^*) (n-n^*)^2}{k_B T}\\right) dn$$\n由于被积函数是一个急剧峰值的的高斯函数，我们将积分限扩展到 $\\pm \\infty$。\n$$I \\approx \\frac{\\exp(\\Delta G^*/k_B T)}{f^+} \\int_{-\\infty}^{\\infty} \\exp\\left(\\frac{\\Delta G''(n^*)}{2k_B T} (n-n^*)^2\\right) d(n-n^*)$$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} e^{-\\alpha x^2} dx = \\sqrt{\\pi/\\alpha}$，其中 $\\alpha = -\\frac{\\Delta G''(n^*)}{2k_B T} > 0$。\n$$I \\approx \\frac{\\exp(\\Delta G^*/k_B T)}{f^+} \\sqrt{\\frac{\\pi}{-\\frac{\\Delta G''(n^*)}{2k_B T}}} = \\frac{\\exp(\\Delta G^*/k_B T)}{f^+} \\sqrt{\\frac{2\\pi k_B T}{-\\Delta G''(n^*)}}$$\n将此积分代回到 $J$ 的表达式中：\n$$J = \\frac{c_{n^*} \\exp(\\Delta G^*/k_B T)}{\\frac{\\exp(\\Delta G^*/k_B T)}{f^+} \\sqrt{\\frac{2\\pi k_B T}{-\\Delta G''(n^*)}}} = f^+ c_{n^*} \\sqrt{\\frac{-\\Delta G''(n^*)}{2\\pi k_B T}}$$\n这就是所求的稳态成核速率的表达式。它清楚地显示了 $J$ 对附着频率 $f^+$、临界团簇的平衡浓度 $c_{n^*}$ 以及势垒曲率 $\\Delta G''(n^*)$ 的依赖关系，后者通过所谓的 Zeldovich 因子引入。\n\n**第 2 部分：数值计算**\n\n我们需要使用推导出的公式和给定的参数来计算 $J$。\n首先，我们计算正向单体附着频率 $f^+$。问题指出附着过程是扩散限制的。单个临界团簇的单体附着频率由扩散限制速率常数 $k_D$ 和单体浓度 $c_1$ 的乘积给出：\n$$f^+ = k_D c_1$$\n对于扩散到半径为 $R^*$ 的球形靶，Smoluchowski 速率常数为 $k_D = 4\\pi D R^*$，其中 $D$ 是单体扩散系数。\n$$f^+ = 4\\pi D R^* c_1$$\n代入给定值：\n$D = 2.0 \\times 10^{-10}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n$R^{*} = 2.5 \\times 10^{-9}\\ \\mathrm{m}$\n$c_{1} = 1.0 \\times 10^{24}\\ \\mathrm{m}^{-3}$\n$$f^+ = 4\\pi (2.0 \\times 10^{-10}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}) (2.5 \\times 10^{-9}\\ \\mathrm{m}) (1.0 \\times 10^{24}\\ \\mathrm{m}^{-3})$$\n$$f^+ = 4\\pi (5.0 \\times 10^{-19}\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}) (1.0 \\times 10^{24}\\ \\mathrm{m}^{-3}) = 20\\pi \\times 10^5\\ \\mathrm{s}^{-1}$$\n接下来，我们计算 Zeldovich 因子项 $\\sqrt{\\frac{-\\Delta G''(n^*)}{2\\pi k_B T}}$。我们已知无量纲比率 $\\frac{\\Delta G''(n^{*})}{k_{B}T} = -0.015708$。\n数值 $0.015708$ 是 $\\pi/200 \\approx 0.01570796$ 的一个高精度近似值。为简便起见，我们假设这就是预期的值。\n$$\\sqrt{\\frac{-\\Delta G''(n^*)}{2\\pi k_B T}} = \\sqrt{\\frac{-(\\frac{\\Delta G''(n^*)}{k_B T})}{2\\pi}} = \\sqrt{\\frac{-(-0.015708)}{2\\pi}} = \\sqrt{\\frac{\\pi/200}{2\\pi}} = \\sqrt{\\frac{1}{400}} = \\frac{1}{20}$$\n现在，我们可以使用给定值 $c_{n^{*}} = 1.00 \\times 10^{11}\\ \\mathrm{m}^{-3}$ 来计算成核速率 $J$。\n$$J = f^+ c_{n^*} \\sqrt{\\frac{-\\Delta G''(n^*)}{2\\pi k_B T}} = (20\\pi \\times 10^5\\ \\mathrm{s}^{-1}) (1.00 \\times 10^{11}\\ \\mathrm{m}^{-3}) \\left(\\frac{1}{20}\\right)$$\n$$J = \\pi \\times 10^5 \\times 1.00 \\times 10^{11}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1} = \\pi \\times 10^{16}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$$\n最后，我们进行数值计算并四舍五入到 $4$ 位有效数字：\n$$J \\approx 3.14159265... \\times 10^{16}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$$\n$$J \\approx 3.142 \\times 10^{16}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$$",
            "answer": "$$\\boxed{3.142 \\times 10^{16}}$$"
        },
        {
            "introduction": "现代自组装系统，如DNA折纸术，通常涉及多种组分和复杂的竞争反应路径。为了理解和优化这类系统，我们需要从简单的解析模型转向综合性的计算模拟。这项动手编程练习  要求您构建一个动力学网络模型，以模拟整个组装过程并预测最终产率。该练习将热力学原理和动力学速率整合到一个强大的预测工具中，体现了在模拟复杂自组装方面的先进水平。",
            "id": "3805751",
            "problem": "您的任务是使用一个动力学网络模型计算脱氧核糖核酸（DNA）折纸结构在指定温度方案下的预期产率，该模型捕捉了具有协同相互作用的可逆性短链结合。预期产率定义为在方案结束时，所有短链都与骨架结合的概率，这对应于网络的完全组装状态。\n\n您必须实现一个连续时间马尔可夫链 (CTMC)，其时间依赖的转移速率源自质量作用动力学和细致平衡。状态空间是长度为 $N$ 的所有二进制向量的集合（总共有 $2^N$ 个状态），其中 $N$ 是不同短链的数量。每个状态 $x \\in \\{0,1\\}^N$ 编码了每个短链的结合（1）或未结合（0）状态。CTMC 根据概率列向量 $p(t)$ 的主方程演化，\n$$\n\\frac{d}{dt} p(t) = Q(t)^{\\top} p(t),\n$$\n其中 $Q(t)$ 是时间依赖的生成矩阵，其非对角线项为非负转移速率，对角线项强制概率守恒。\n\n对于短链 $i \\in \\{1,\\dots,N\\}$，在当前状态 $x$ 下结合时的有效自由能变化为\n$$\n\\Delta G_i^{\\mathrm{eff}}(x) = \\Delta G_i + \\sum_{j=1}^{N} \\Delta G_{ij}^{\\mathrm{coop}} \\, x_j,\n$$\n其中 $\\Delta G_i$ 是短链 $i$ 的单个结合自由能，$\\Delta G_{ij}^{\\mathrm{coop}}$ 是短链 $i$ 和 $j$ 之间的成对协同自由能。所有能量必须以千卡/摩尔为单位提供。对于不相互作用的对，协同能量可以为零。气体常数为\n$$\nR = 1.98720425864083 \\times 10^{-3} \\ \\text{kcal}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}.\n$$\n\n假设质量作用动力学具有统一的二阶结合速率常数 $k_{\\mathrm{on}}^{(0)}$（单位为 $\\text{M}^{-1}\\cdot\\text{s}^{-1}$）和短链浓度 $c_i$（单位为 $\\text{mol}\\cdot\\text{L}^{-1}$）。在恒定 $c_i$ 的伪一级条件下，短链 $i$ 的结合和解离速率由细致平衡确定。从状态 $\\mathbf{x}$ (其中 $x_i=0$) 结合短链 $i$ 的速率为：\n$$\nk_{i}^{\\mathrm{bind}}(t) = k_{\\mathrm{on}}^{(0)} \\, c_i,\n$$\n从状态 $\\mathbf{y}$ (其中 $y_i=1$) 解离短链 $i$ 的速率为：\n$$\nk_{i}^{\\mathrm{unbind}}(t, \\mathbf{y}) = \\frac{k_{\\mathrm{on}}^{(0)}}{K_{a,i}(T(t), \\mathbf{x})},\n$$\n其中 $\\mathbf{x}$ 是解离后的状态。相应结合反应（$\\mathbf{x} \\to \\mathbf{y}$）的结合常数 $K_{a,i}$ 的定义为：\n$$\nK_{a,i}(T(t), \\mathbf{x}) = \\exp\\left(-\\frac{\\Delta G_i^{\\mathrm{eff}}(\\mathbf{x})}{R \\, T(t)}\\right),\n$$\n$T(t)$ 是作为时间函数的温度方案（单位为开尔文）。生成矩阵 $Q(t)$ 的构建仅允许单个短链翻转：从状态 $x$ 到在第 $i$ 位上不同的状态 $y$，当 $0 \\to 1$ 翻转时使用 $k_{i}^{\\mathrm{bind}}(t)$，当 $1 \\to 0$ 翻转时使用 $k_{i}^{\\mathrm{unbind}}(t, x)$。对角线项的设置使得每行之和为零。\n\n温度方案由一系列断点 $\\{(t_k, T_k)\\}$ 指定，其中时间以秒为单位，温度以开尔文为单位，并在断点之间进行线性插值。在断点范围之外，$T(t)$ 保持在最近的端点值不变。初始条件是在时间 $t=0$ 时完全处于未结合状态的概率为 $1$，即 $p(0)$ 将所有质量置于 $x = (0,\\dots,0)$。\n\n您必须在给定的方案下，数值求解主方程直至最终时间 $t_{\\mathrm{final}}$，即最大的断点时间。预期产率是在 $t_{\\mathrm{final}}$ 时处于完全结合状态 $x = (1,\\dots,1)$ 的概率。产率是无量纲的，必须表示为保留六位小数的小数。\n\n物理单位和规格：\n- 能量 $\\Delta G_i$ 和 $\\Delta G_{ij}^{\\mathrm{coop}}$ 必须以 $\\text{kcal}\\cdot\\text{mol}^{-1}$ 为单位。\n- 浓度 $c_i$ 必须以 $\\text{mol}\\cdot\\text{L}^{-1}$ 为单位。\n- 温度必须以开尔文为单位。\n- 时间必须以秒为单位。\n- 二阶结合速率常数 $k_{\\mathrm{on}}^{(0)}$ 必须以 $\\text{M}^{-1}\\cdot\\text{s}^{-1}$ 为单位。\n\n实现程序以计算以下参数集测试套件的产率。每个测试案例指定为：\n- 短链数量 $N$。\n- 对 $i=1,\\dots,N$ 的结合自由能向量 $\\Delta G_i$。\n- 大小为 $N \\times N$ 的对称协同自由能矩阵 $\\Delta G_{ij}^{\\mathrm{coop}}$，对角线为零。\n- 对 $i=1,\\dots,N$ 的短链浓度向量 $c_i$。\n- 作为断点 $(t_k, T_k)$ 并采用分段线性插值的温度方案。\n- 二阶结合速率常数 $k_{\\mathrm{on}}^{(0)}$。\n\n测试套件：\n1. 案例 A：\n   - $N = 3$,\n   - $\\Delta G = [-7.0,-8.0,-6.5] \\ \\text{kcal}\\cdot\\text{mol}^{-1}$,\n   - $\\Delta G^{\\mathrm{coop}}$ 除 $\\Delta G_{12}^{\\mathrm{coop}} = \\Delta G_{21}^{\\mathrm{coop}} = -0.8$，$\\Delta G_{23}^{\\mathrm{coop}} = \\Delta G_{32}^{\\mathrm{coop}} = -0.6$ 外均为零，\n   - $c = [2.0 \\times 10^{-7}, 2.0 \\times 10^{-7}, 2.0 \\times 10^{-7}] \\ \\text{mol}\\cdot\\text{L}^{-1}$,\n   - 温度方案： $(0, 340)$, $(3600, 298)$,\n   - $k_{\\mathrm{on}}^{(0)} = 1.0 \\times 10^{6} \\ \\text{M}^{-1}\\cdot\\text{s}^{-1}$。\n\n2. 案例 B：\n   - $N = 4$,\n   - $\\Delta G = [-5.0,-5.0,-5.0,-5.0] \\ \\text{kcal}\\cdot\\text{mol}^{-1}$,\n   - $\\Delta G^{\\mathrm{coop}}$ 是 $4 \\times 4$ 的零矩阵，\n   - $c = [5.0 \\times 10^{-7}, 5.0 \\times 10^{-7}, 5.0 \\times 10^{-7}, 5.0 \\times 10^{-7}] \\ \\text{mol}\\cdot\\text{L}^{-1}$,\n   - 温度方案： $(0, 340)$, $(3600, 315)$,\n   - $k_{\\mathrm{on}}^{(0)} = 1.0 \\times 10^{6} \\ \\text{M}^{-1}\\cdot\\text{s}^{-1}$。\n\n3. 案例 C：\n   - $N = 3$,\n   - $\\Delta G = [-12.0,-12.0,-11.5] \\ \\text{kcal}\\cdot\\text{mol}^{-1}$,\n   - $\\Delta G^{\\mathrm{coop}}$ 对于 $i \\neq j$ 有 $\\Delta G_{ij}^{\\mathrm{coop}} = -2.0$，对角线为 $0.0$，\n   - $c = [1.0 \\times 10^{-6}, 1.0 \\times 10^{-6}, 1.0 \\times 10^{-6}] \\ \\text{mol}\\cdot\\text{L}^{-1}$,\n   - 温度方案： $(0, 350)$, $(7200, 295)$,\n   - $k_{\\mathrm{on}}^{(0)} = 1.0 \\times 10^{6} \\ \\text{M}^{-1}\\cdot\\text{s}^{-1}$。\n\n4. 案例 D：\n   - $N = 3$,\n   - $\\Delta G = [-6.0,-6.0,-6.0] \\ \\text{kcal}\\cdot\\text{mol}^{-1}$,\n   - $\\Delta G^{\\mathrm{coop}}$ 是 $3 \\times 3$ 的零矩阵，\n   - $c = [1.0 \\times 10^{-12}, 1.0 \\times 10^{-12}, 1.0 \\times 10^{-12}] \\ \\text{mol}\\cdot\\text{L}^{-1}$,\n   - 温度方案： $(0, 340)$, $(3600, 298)$,\n   - $k_{\\mathrm{on}}^{(0)} = 1.0 \\times 10^{6} \\ \\text{M}^{-1}\\cdot\\text{s}^{-1}$。\n\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔结果列表，每个产率均四舍五入到六位小数（例如，$[0.123456,0.654321,0.999999,0.000001]$）。",
            "solution": "该问题要求计算DNA折纸结构的预期产率，该结构被建模为连续时间马尔可夫链（CTMC）。产率是在指定的温度退火方案结束时达到完全组装状态的概率。解决方案涉及为该系统构建并数值积分化学主方程。\n\n系统状态由一个二进制向量 $\\boldsymbol{x} \\in \\{0,1\\}^N$ 描述，其中 $N$ 是短链的数量，$x_i=1$ 表示短链 $i$ 与骨架结合，$x_i=0$ 则表示未结合。状态总数为 $2^N$。我们可以将每个状态向量 $\\boldsymbol{x}$ 通过关系 $s = \\sum_{i=1}^{N} x_i 2^{i-1}$ 映射到一个唯一的整数索引 $s \\in \\{0, 1, \\dots, 2^N-1\\}$。这些状态上的概率分布的演化，由一个大小为 $2^N$ 的列向量 $\\boldsymbol{p}(t)$ 表示，并由主方程控制：\n$$\n\\frac{d\\boldsymbol{p}(t)}{dt} = \\boldsymbol{Q}(t)^{\\top} \\boldsymbol{p}(t)\n$$\n这里，$\\boldsymbol{Q}(t)$ 是时间依赖的生成矩阵。该矩阵的元素 $Q_{s',s}(t)$ 表示从状态 $s$ 到状态 $s'$ 的转移速率。按照惯例，对角线元素的定义使得 $\\boldsymbol{Q}(t)$ 的行和为零，即 $Q_{s,s}(t) = -\\sum_{s' \\neq s} Q_{s',s}(t)$。使用转置 $\\boldsymbol{Q}(t)^{\\top}$ 将此定义与概率列向量的主方程正确对齐。\n\n状态之间的转移仅限于单个短链的结合或解离。这些转移的速率源自质量作用动力学和细致平衡原理。\n\n温度 $T(t)$ 是时间的函数，由所提供的断点 $\\{(t_k, T_k)\\}$ 的分段线性插值确定。\n\n短链 $i$ 的结合速率，对应于从 $x_i=0$ 的状态 $\\boldsymbol{x}$ 到 $x'_i=1$ 的状态 $\\boldsymbol{x}'$ 的转移，由伪一级动力学给出：\n$$\nk_{i}^{\\mathrm{bind}} = k_{\\mathrm{on}}^{(0)} c_i\n$$\n由于浓度 $c_i$ 和结合速率常数 $k_{\\mathrm{on}}^{(0)}$ 是恒定的，所以该速率在时间上是恒定的。\n\n短链 $i$ 的解离速率，即从 $y_i=1$ 的状态 $\\boldsymbol{y}$ 到 $y'_i=0$ 的状态 $\\boldsymbol{y}'$ 的转移，通过细致平衡与结合速率相关联。解离转变 $\\boldsymbol{y} \\to \\boldsymbol{y}'$ 的速率由下式给出：\n$$\nk_{i}^{\\mathrm{unbind}}(t, \\boldsymbol{y}) = \\frac{k_{\\mathrm{on}}^{(0)}}{K_{a,i}(T(t), \\boldsymbol{y}')}\n$$\n这里，$K_{a,i}(T(t), \\boldsymbol{y}')$ 是逆反应的结合常数，即短链 $i$ 在状态 $\\boldsymbol{y}'$ 下与骨架结合的常数。该常数依赖于结合的有效自由能变化 $\\Delta G_i^{\\mathrm{eff}}(\\boldsymbol{y}')$：\n$$\nK_{a,i}(T(t), \\boldsymbol{y}') = \\exp\\left(-\\frac{\\Delta G_i^{\\mathrm{eff}}(\\boldsymbol{y}')}{R \\, T(t)}\\right)\n$$\n有效自由能变化包括与已结合短链的协同相互作用：\n$$\n\\Delta G_i^{\\mathrm{eff}}(\\boldsymbol{y}') = \\Delta G_i + \\sum_{j=1}^{N} \\Delta G_{ij}^{\\mathrm{coop}} y'_j\n$$\n其中 $R$ 是气体常数 ($1.98720425864083 \\times 10^{-3} \\ \\text{kcal}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$)。\n\n利用这些速率，可以在每个时间 $t$ 构建生成矩阵 $\\boldsymbol{Q}(t)$。对于每个状态 $s$（向量 $\\boldsymbol{x}$），我们考虑向所有仅相差一位 $i$ 的相邻状态 $s'$（向量 $\\boldsymbol{x}'$）的转移：\n- 如果 $x_i=0$ 且 $x'_i=1$，转移为结合：$Q_{s',s}(t) = k_i^{\\mathrm{bind}}$。\n- 如果 $x_i=1$ 且 $x'_i=0$，转移为解离：$Q_{s',s}(t) = k_i^{\\mathrm{unbind}}(t, \\boldsymbol{x})$。根据细致平衡关系，该速率使用目标状态 $\\boldsymbol{x}'$ 进行自由能计算。\n\n因此，该问题是一个包含 $2^N$ 个耦合线性常微分方程（ODEs）组的初值问题。在 $t=0$ 时的初始条件是系统以概率 1 处于完全未结合状态 $\\boldsymbol{x}=(0, \\dots, 0)$。在我们的索引表示中，这意味着 $p_0(0)=1$ 且对于 $s0$ 有 $p_s(0)=0$。\n\n为了找到最终的概率分布 $\\boldsymbol{p}(t_{\\mathrm{final}})$，我们从 $t=0$ 到 $t=t_{\\mathrm{final}}$ 对 ODE 系统进行数值积分。速率可能会跨越多个数量级，这会使系统变得刚性。因此，适用于刚性常微分方程的数值求解器，例如 Radau 方法，是合适的。\n\n最终产率是在最终时间 $t_{\\mathrm{final}}$ 时处于完全组装状态 $\\boldsymbol{x}=(1, \\dots, 1)$ 的概率。这对应于解向量的最后一个元素，$p_{2^N-1}(t_{\\mathrm{final}})$。每个测试案例的算法步骤如下：\n1.  定义状态空间以及整数索引和二进制向量之间的映射。\n2.  实现时间依赖的温度方案函数 $T(t)$。\n3.  为 ODE 求解器定义右侧函数，该函数对于给定的时间 $t$ 和概率向量 $\\boldsymbol{p}$，构建矩阵 $\\boldsymbol{Q}(t)$ 并返回 $\\boldsymbol{Q}(t)^{\\top}\\boldsymbol{p}$。\n4.  初始化概率向量 $\\boldsymbol{p}(0)$ 以表示完全未结合状态。\n5.  使用数值 ODE 求解器（例如，使用 `method='Radau'` 的 `scipy.integrate.solve_ivp`）在时间区间 $[0, t_{\\mathrm{final}}]$ 上积分该系统。\n6.  从最终解向量中提取完全结合状态（$s = 2^N-1$）的概率。\n7.  按要求将所得产率四舍五入到六位小数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom functools import lru_cache\n\ndef solve():\n    \"\"\"\n    Main function to solve the DNA origami yield problem for the given test cases.\n    \"\"\"\n    # Gas constant in kcal/mol/K\n    R = 1.98720425864083e-3\n\n    # Define the test suite\n    test_cases = [\n        {\n            \"N\": 3,\n            \"delta_G\": [-7.0, -8.0, -6.5],\n            \"delta_G_coop\": { (0, 1): -0.8, (1, 0): -0.8, (1, 2): -0.6, (2, 1): -0.6 },\n            \"c\": [2.0e-7, 2.0e-7, 2.0e-7],\n            \"temp_protocol\": [(0, 340), (3600, 298)],\n            \"k_on_0\": 1.0e6,\n        },\n        {\n            \"N\": 4,\n            \"delta_G\": [-5.0, -5.0, -5.0, -5.0],\n            \"delta_G_coop\": {},\n            \"c\": [5.0e-7, 5.0e-7, 5.0e-7, 5.0e-7],\n            \"temp_protocol\": [(0, 340), (3600, 315)],\n            \"k_on_0\": 1.0e6,\n        },\n        {\n            \"N\": 3,\n            \"delta_G\": [-12.0, -12.0, -11.5],\n            \"delta_G_coop\": { (0, 1): -2.0, (1, 0): -2.0, (0, 2): -2.0, (2, 0): -2.0, (1, 2): -2.0, (2, 1): -2.0 },\n            \"c\": [1.0e-6, 1.0e-6, 1.0e-6],\n            \"temp_protocol\": [(0, 350), (7200, 295)],\n            \"k_on_0\": 1.0e6,\n        },\n        {\n            \"N\": 3,\n            \"delta_G\": [-6.0, -6.0, -6.0],\n            \"delta_G_coop\": {},\n            \"c\": [1.0e-12, 1.0e-12, 1.0e-12],\n            \"temp_protocol\": [(0, 340), (3600, 298)],\n            \"k_on_0\": 1.0e6,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        yield_val = compute_yield(case, R)\n        results.append(yield_val)\n\n    # Format output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_yield(params, R):\n    \"\"\"\n    Computes the yield for a single parameter set.\n    \"\"\"\n    N = params['N']\n    delta_G = np.array(params['delta_G'])\n    \n    # Construct cooperative energy matrix\n    g_coop_map = params['delta_G_coop']\n    delta_G_coop = np.zeros((N, N))\n    for (i, j), val in g_coop_map.items():\n        delta_G_coop[i, j] = val\n        \n    c = np.array(params['c'])\n    temp_protocol = params['temp_protocol']\n    k_on_0 = params['k_on_0']\n    \n    num_states = 1  N\n\n    @lru_cache(maxsize=None)\n    def int_to_bin_vec(s_idx, n):\n        return np.array([(s_idx >> i)  1 for i in range(n)], dtype=np.int8)\n\n    t_points = np.array([p[0] for p in temp_protocol])\n    T_points = np.array([p[1] for p in temp_protocol])\n\n    def get_T(t):\n        return np.interp(t, t_points, T_points)\n\n    def ode_system(t, p_vec):\n        T = get_T(t)\n        Q = np.zeros((num_states, num_states))\n\n        for s_idx in range(num_states):\n            x = int_to_bin_vec(s_idx, N)\n            row_sum = 0.0\n\n            for i in range(N):\n                d_idx = s_idx ^ (1  i)\n                \n                if x[i] == 0:  # Binding staple i\n                    rate = k_on_0 * c[i]\n                    Q[s_idx, d_idx] = rate\n                    row_sum += rate\n                else:  # Unbinding staple i\n                    x_prime = int_to_bin_vec(d_idx, N)\n                    dG_eff = delta_G[i] + np.dot(delta_G_coop[i, :], x_prime)\n                    \n                    # Prevent overflow in exp\n                    arg = -dG_eff / (R * T)\n                    if arg > 700: # np.exp(709) is ~inf\n                        Ka = np.inf\n                    else:\n                        Ka = np.exp(arg)\n                        \n                    if Ka == 0 or np.isinf(Ka):\n                        rate = 0.0 if np.isinf(Ka) else np.inf\n                    else:\n                        rate = k_on_0 / Ka\n                    \n                    Q[s_idx, d_idx] = rate\n                    row_sum += rate\n            \n            Q[s_idx, s_idx] = -row_sum\n\n        return Q.T @ p_vec\n\n    t_final = temp_protocol[-1][0]\n    t_span = [0, t_final]\n    \n    p0 = np.zeros(num_states)\n    p0[0] = 1.0\n\n    sol = solve_ivp(\n        ode_system, \n        t_span, \n        p0, \n        method='Radau', \n        dense_output=True, \n        rtol=1e-8, \n        atol=1e-12\n    )\n    \n    final_p_vec = sol.sol(t_final)\n    yield_val = final_p_vec[-1]\n\n    return yield_val\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}