{
    "hands_on_practices": [
        {
            "introduction": "In our journey to understand fracture across scales, we begin at the level of the material's fundamental building blocks. For crystalline solids, fracture is often not an isotropic process; the energy required to create new surfaces can vary dramatically with crystallographic direction. This exercise  challenges you to apply an anisotropic form of the Griffith criterion to determine the preferred cleavage plane in a single crystal, providing a direct link between atomic-scale surface energetics and the macroscopic path a crack will follow.",
            "id": "3785454",
            "problem": "A brittle single crystal with cubic symmetry exhibits anisotropic surface energy of cleavage facets. Consider an initially straight, atomically sharp crack aligned with the crystallographic $\\langle 100 \\rangle$ axis in the crystal’s reference frame. The orientation of a prospective cleavage facet is described by an in-plane angle $\\theta$ measured from the $\\langle 100 \\rangle$ axis, with $0 \\leq \\theta < \\pi$. The crystallographic anisotropy of the cleavage surface energy per unit area is given by\n$$\n\\gamma(\\theta) = \\gamma_{0}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right],\n$$\nwhere $\\gamma_{0}$, $c_{4}$, and $c_{8}$ are material parameters reflecting cubic symmetry.\n\nAssume negligible lattice trapping and inelastic dissipation so that the critical energy release rate obeys the Griffith criterion $G_{c}(\\theta) = 2\\,\\gamma(\\theta)$. Under remote loading, the crack is subjected to pure mode I with stress intensity factor $K_{I}$ and no mode II. Treat the elastic response as homogeneous and isotropic for the purpose of the near-tip energetic balance, under plane strain. The far-field thermodynamic driving energy release rate is therefore\n$$\nG = \\frac{(1-\\nu^{2})}{E}K_{I}^{2},\n$$\nwhere $E$ is the Young’s modulus and $\\nu$ is the Poisson’s ratio.\n\nGiven the material parameters $\\gamma_{0} = 1.2\\,\\mathrm{J/m^{2}}$, $c_{4} = 0.3$, $c_{8} = 0.05$, and elastic properties $E = 200\\,\\mathrm{GPa}$, $\\nu = 0.30$, together with loading $K_{I} = 1.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, determine the preferred cleavage plane by minimizing $G_{c}(\\theta)$ with respect to $\\theta$ and verify that propagation is energetically admissible, i.e., that $G \\geq G_{c}(\\theta^{\\ast})$ for the minimizer $\\theta^{\\ast}$. Report the resulting crack direction as the smallest positive minimizing angle $\\theta^{\\ast}$ measured in radians from the $\\langle 100 \\rangle$ axis. Express your final answer for $\\theta^{\\ast}$ in radians, in exact form (do not round).",
            "solution": "The problem requires the determination of the preferred cleavage plane for a brittle single crystal under mode I loading. This is achieved by finding the angle $\\theta$ that minimizes the critical energy release rate, $G_c(\\theta)$. Subsequently, it must be verified that the available energy release rate, $G$, is sufficient to drive the crack along this preferred path.\n\nFirst, we perform a validation of the problem statement.\n\n### Step 1: Extract Givens\n- The crystal has cubic symmetry.\n- An initially straight crack is aligned with the $\\langle 100 \\rangle$ crystallographic axis.\n- The orientation of a prospective cleavage facet is described by an angle $\\theta$, with $0 \\leq \\theta < \\pi$, measured from the $\\langle 100 \\rangle$ axis.\n- The cleavage surface energy per unit area is given by $\\gamma(\\theta) = \\gamma_{0}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right]$.\n- The critical energy release rate is defined by the Griffith criterion: $G_{c}(\\theta) = 2\\,\\gamma(\\theta)$.\n- The loading is pure mode I with stress intensity factor $K_{I}$ and no mode II.\n- Elastic response is treated as homogeneous and isotropic under plane strain conditions.\n- The far-field thermodynamic driving energy release rate is $G = \\frac{(1-\\nu^{2})}{E}K_{I}^{2}$.\n- Material parameters: $\\gamma_{0} = 1.2\\,\\mathrm{J/m^{2}}$, $c_{4} = 0.3$, $c_{8} = 0.05$.\n- Elastic properties: $E = 200\\,\\mathrm{GPa}$, $\\nu = 0.30$.\n- Loading: $K_{I} = 1.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing standard principles of linear elastic fracture mechanics (LEFM), specifically the Griffith theory for brittle fracture. The expression for anisotropic surface energy is a valid phenomenological model for cubic symmetry. The expression for the energy release rate $G$ under plane strain is correct. The provided material properties and loading values are physically realistic for brittle materials and metals. The problem is self-contained, with all necessary data and equations provided. It is well-posed as a calculus optimization problem followed by a comparison. There are no scientific flaws, ambiguities, or contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be developed.\n\nThe preferred cleavage plane corresponds to the direction $\\theta$ which minimizes the resistance to fracture. The resistance to fracture is given by the critical energy release rate $G_{c}(\\theta)$. Therefore, we must find the angle $\\theta^{\\ast}$ that minimizes $G_{c}(\\theta)$.\nThe function to be minimized is:\n$$G_{c}(\\theta) = 2\\gamma(\\theta) = 2\\gamma_{0}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right]$$\nTo find the extrema, we compute the first derivative of $G_{c}(\\theta)$ with respect to $\\theta$ and set it to zero.\n$$\\frac{dG_{c}}{d\\theta} = 2\\gamma_{0} \\frac{d}{d\\theta}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right]$$\n$$\\frac{dG_{c}}{d\\theta} = 2\\gamma_{0}\\left[-4c_{4}\\sin(4\\theta) - 8c_{8}\\sin(8\\theta)\\right]$$\nSetting $\\frac{dG_{c}}{d\\theta} = 0$:\n$$-4c_{4}\\sin(4\\theta) - 8c_{8}\\sin(8\\theta) = 0$$\nWe use the double-angle identity $\\sin(8\\theta) = 2\\sin(4\\theta)\\cos(4\\theta)$:\n$$-4c_{4}\\sin(4\\theta) - 8c_{8}\\left(2\\sin(4\\theta)\\cos(4\\theta)\\right) = 0$$\n$$-4\\sin(4\\theta)\\left[c_{4} + 4c_{8}\\cos(4\\theta)\\right] = 0$$\nThis equation provides two possibilities for critical points:\n1. $\\sin(4\\theta) = 0$\n2. $c_{4} + 4c_{8}\\cos(4\\theta) = 0$\n\nLet's analyze the first case, $\\sin(4\\theta) = 0$. This implies $4\\theta = n\\pi$ for any integer $n$. Thus, $\\theta = \\frac{n\\pi}{4}$. Within the specified domain $0 \\leq \\theta < \\pi$, the possible values for $\\theta$ are:\n- $n=0: \\theta = 0$\n- $n=1: \\theta = \\frac{\\pi}{4}$\n- $n=2: \\theta = \\frac{2\\pi}{4} = \\frac{\\pi}{2}$\n- $n=3: \\theta = \\frac{3\\pi}{4}$\n\nNow, let's analyze the second case, $c_{4} + 4c_{8}\\cos(4\\theta) = 0$.\n$$\\cos(4\\theta) = -\\frac{c_{4}}{4c_{8}}$$\nSubstituting the given material parameters $c_{4} = 0.3$ and $c_{8} = 0.05$:\n$$\\cos(4\\theta) = -\\frac{0.3}{4(0.05)} = -\\frac{0.3}{0.2} = -1.5$$\nSince the value of the cosine function must be in the range $[-1, 1]$, there are no real solutions for $\\theta$ from this second case. The only critical points are those found from the first case.\n\nTo determine which of these critical points are minima, we employ the second derivative test. The second derivative of $G_{c}(\\theta)$ is:\n$$\\frac{d^2G_{c}}{d\\theta^2} = \\frac{d}{d\\theta} \\left( 2\\gamma_{0}\\left[-4c_{4}\\sin(4\\theta) - 8c_{8}\\sin(8\\theta)\\right] \\right)$$\n$$\\frac{d^2G_{c}}{d\\theta^2} = 2\\gamma_{0}\\left[-16c_{4}\\cos(4\\theta) - 64c_{8}\\cos(8\\theta)\\right]$$\n$$\\frac{d^2G_{c}}{d\\theta^2} = -32\\gamma_{0}\\left[c_{4}\\cos(4\\theta) + 4c_{8}\\cos(8\\theta)\\right]$$\nA local minimum occurs where $\\frac{d^2G_{c}}{d\\theta^2} > 0$. Since $\\gamma_{0}$ is a positive constant, this condition is equivalent to $c_{4}\\cos(4\\theta) + 4c_{8}\\cos(8\\theta) < 0$. We test each critical point with $c_4=0.3$ and $c_8=0.05$:\n\n- For $\\theta = 0$: $\\cos(0)=1$, $\\cos(0)=1$. The expression is $c_{4} + 4c_{8} = 0.3 + 4(0.05) = 0.5 > 0$. Thus, $\\frac{d^2G_{c}}{d\\theta^2} < 0$, which indicates a local maximum.\n- For $\\theta = \\frac{\\pi}{4}$: $\\cos(\\pi)=-1$, $\\cos(2\\pi)=1$. The expression is $c_{4}(-1) + 4c_{8}(1) = -c_{4} + 4c_{8} = -0.3 + 4(0.05) = -0.1 < 0$. Thus, $\\frac{d^2G_{c}}{d\\theta^2} > 0$, which indicates a local minimum.\n- For $\\theta = \\frac{\\pi}{2}$: $\\cos(2\\pi)=1$, $\\cos(4\\pi)=1$. The expression is $c_{4} + 4c_{8} = 0.5 > 0$. Thus, $\\frac{d^2G_{c}}{d\\theta^2} < 0$, which indicates a local maximum.\n- For $\\theta = \\frac{3\\pi}{4}$: $\\cos(3pi)=-1$, $\\cos(6\\pi)=1$. The expression is $c_{4}(-1) + 4c_{8}(1) = -c_{4} + 4c_{8} = -0.1 < 0$. Thus, $\\frac{d^2G_{c}}{d\\theta^2} > 0$, which indicates a local minimum.\n\nThe local minima occur at $\\theta = \\frac{\\pi}{4}$ and $\\theta = \\frac{3\\pi}{4}$. To find the global minimum, we evaluate $G_{c}(\\theta)$ at these two angles.\nFor $\\theta = \\frac{\\pi}{4}$:\n$$G_{c}\\left(\\frac{\\pi}{4}\\right) = 2\\gamma_{0}\\left[1 + c_{4}\\cos\\left(4\\frac{\\pi}{4}\\right) + c_{8}\\cos\\left(8\\frac{\\pi}{4}\\right)\\right] = 2\\gamma_{0}\\left[1 + c_{4}\\cos(\\pi) + c_{8}\\cos(2\\pi)\\right]$$\n$$G_{c}\\left(\\frac{\\pi}{4}\\right) = 2\\gamma_{0}(1 - c_{4} + c_{8})$$\nFor $\\theta = \\frac{3\\pi}{4}$:\n$$G_{c}\\left(\\frac{3\\pi}{4}\\right) = 2\\gamma_{0}\\left[1 + c_{4}\\cos\\left(4\\frac{3\\pi}{4}\\right) + c_{8}\\cos\\left(8\\frac{3\\pi}{4}\\right)\\right] = 2\\gamma_{0}\\left[1 + c_{4}\\cos(3\\pi) + c_{8}\\cos(6\\pi)\\right]$$\n$$G_{c}\\left(\\frac{3\\pi}{4}\\right) = 2\\gamma_{0}(1 - c_{4} + c_{8})$$\nThe values of $G_{c}$ at the two minima are identical. The problem asks for the smallest positive minimizing angle $\\theta^{\\ast}$. Comparing $\\frac{\\pi}{4}$ and $\\frac{3\\pi}{4}$, the smallest positive angle is $\\theta^{\\ast} = \\frac{\\pi}{4}$.\n\nNext, we must verify that crack propagation is energetically admissible, i.e., $G \\geq G_{c}(\\theta^{\\ast})$.\nFirst, calculate the far-field energy release rate $G$:\n$$G = \\frac{(1-\\nu^{2})}{E}K_{I}^{2}$$\nThe given values must be in consistent SI units: $E = 200\\,\\mathrm{GPa} = 200 \\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.30$, and $K_{I} = 1.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}} = 1.0 \\times 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$.\n$$G = \\frac{1 - (0.30)^{2}}{200 \\times 10^{9}\\,\\mathrm{Pa}} \\left(1.0 \\times 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}\\right)^{2}$$\n$$G = \\frac{1 - 0.09}{200 \\times 10^{9}} \\left(1.0 \\times 10^{12}\\right)\\,\\mathrm{J/m^{2}}$$\n$$G = \\frac{0.91}{200} \\times 10^{3}\\,\\mathrm{J/m^{2}} = 4.55\\,\\mathrm{J/m^{2}}$$\n\nNext, calculate the minimum critical energy release rate $G_{c}(\\theta^{\\ast})$:\n$$G_{c}(\\theta^{\\ast}) = G_{c}\\left(\\frac{\\pi}{4}\\right) = 2\\gamma_{0}(1 - c_{4} + c_{8})$$\nUsing the given values $\\gamma_{0} = 1.2\\,\\mathrm{J/m^{2}}$, $c_{4} = 0.3$, and $c_{8} = 0.05$:\n$$G_{c}(\\theta^{\\ast}) = 2(1.2\\,\\mathrm{J/m^{2}})(1 - 0.3 + 0.05)$$\n$$G_{c}(\\theta^{\\ast}) = 2.4(0.75)\\,\\mathrm{J/m^{2}} = 1.8\\,\\mathrm{J/m^{2}}$$\n\nFinally, we compare $G$ and $G_{c}(\\theta^{\\ast})$:\n$$G = 4.55\\,\\mathrm{J/m^{2}}$$\n$$G_{c}(\\theta^{\\ast}) = 1.8\\,\\mathrm{J/m^{2}}$$\nSince $4.55 > 1.8$, the condition $G \\geq G_{c}(\\theta^{\\ast})$ is satisfied. Crack propagation is energetically admissible along the direction $\\theta^{\\ast}$.\n\nThe preferred cleavage plane is given by the smallest positive angle that minimizes $G_c(\\theta)$, which is $\\theta^{\\ast} = \\frac{\\pi}{4}$.",
            "answer": "$$\\boxed{\\frac{\\pi}{4}}$$"
        },
        {
            "introduction": "While sharp-crack models like Linear Elastic Fracture Mechanics (LEFM) are foundational, they predict unphysical stress singularities. This practice  explores a more sophisticated approach using a nonlocal damage model, which introduces an intrinsic material length scale, $\\ell$, to regularize the strain field. By analyzing geometrically similar specimens of varying sizes, you will uncover the \"size effect\"—a critical phenomenon where the apparent strength transitions from LEFM's characteristic $D^{-1/2}$ scaling for small sizes to a size-independent limit for large structures, bridging two classical failure regimes.",
            "id": "3785435",
            "problem": "Consider a family of geometrically similar single-edge-notched tensile specimens of characteristic size $D$ subjected to remote uniform tension. Assume small-strain linear elasticity with Young’s modulus $E$ and a scalar nonlocal damage initiation criterion defined by a threshold on a nonlocal equivalent strain. The goal is to compute the apparent tensile strength (the remote stress at the onset of damage initiation at the notch root) for different specimen sizes using a nonlocal damage model, and to compare the size dependence against the scaling predicted by Linear Elastic Fracture Mechanics (LEFM).\n\nFundamental base and model assumptions:\n\n- Linear elastic constitutive law: the local strain $ \\varepsilon $ relates to the local stress $ \\sigma $ through $ \\sigma = E \\varepsilon $, with $ E > 0 $ constant. Damage initiation is governed by a nonlocal measure of strain as defined below. Before damage initiation, $ d = 0 $, so material response is elastic.\n- The nonlocal equivalent strain $ \\bar{\\varepsilon}(\\mathbf{x}) $ is defined as a normalized spatial average of the local equivalent strain $ \\varepsilon(\\mathbf{y}) $ over the body $ \\Omega $ using a positive, radially decaying kernel $ w(r) $, where $ r = \\lVert \\mathbf{x} - \\mathbf{y} \\rVert $. Specifically,\n$$\n\\bar{\\varepsilon}(\\mathbf{x}) = \\frac{\\int_{\\Omega} w(\\lVert \\mathbf{x} - \\mathbf{y} \\rVert) \\, \\varepsilon(\\mathbf{y}) \\, \\mathrm{d}\\mathbf{y}}{\\int_{\\Omega} w(\\lVert \\mathbf{x} - \\mathbf{y} \\rVert) \\, \\mathrm{d}\\mathbf{y}}.\n$$\n- Let the nonlocal kernel be an exponential of characteristic material length $ \\ell > 0 $, and for analytical tractability in a near-notch-root neighborhood, approximate the problem as one-dimensional along the radial direction $ r \\ge 0 $ from the notch root. Then use\n$$\nw(r) = \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right), \\quad r \\ge 0,\n$$\nand restrict the averaging integral to $ r \\in [0,\\infty) $ along the notch flank.\n- For a geometrically similar notch with root radius $ \\rho = \\eta D $ for some fixed acuity parameter $ \\eta \\in (0,1) $, approximate the local strain field along the notch flank under remote stress $ \\sigma $ by\n$$\n\\varepsilon(r;D,\\sigma) = \\frac{\\sigma}{E} K_t \\, g\\!\\left(\\frac{r}{\\rho}\\right),\n$$\nwhere $ K_t > 0 $ is the elastic stress concentration factor (independent of $ D $ for geometrically similar notches), and $ g(\\xi) $ is a dimensionless attenuation function with $ g(0) = 1 $ and $ g(\\xi) $ monotonically decreasing with $ \\xi $. Use the specific choice\n$$\ng\\!\\left(\\frac{r}{\\rho}\\right) = \\left(1 + \\frac{r}{\\rho}\\right)^{-\\frac{1}{2}},\n$$\nwhich regularizes the near-root field and yields a finite notch-root strain.\n- The damage initiation criterion is $ \\bar{\\varepsilon}(0;D,\\sigma) = \\varepsilon_f $, where $ \\varepsilon_f > 0 $ is the material nonlocal strain threshold for damage onset, and $ \\bar{\\varepsilon}(0;D,\\sigma) $ is the nonlocal equivalent strain evaluated at the notch root $ r = 0 $.\n\nTask requirements:\n\n1. Starting from the above definitions, derive a computable expression for the apparent tensile strength $ \\sigma_{\\text{app}}(D) $ in terms of $ E $, $ K_t $, $ \\varepsilon_f $, $ \\ell $, $ \\eta $, and $ D $, by evaluating the one-dimensional nonlocal averaging integral at the notch root. Your derivation must be based on the integral representation with the specified kernel and attenuation function and must not introduce any ad hoc shortcut formulas.\n\n2. For comparison, derive the LEFM-based apparent strength scaling for a geometrically similar cracked specimen with crack length $ a = \\alpha D $, Stress Intensity Factor (SIF) geometry coefficient $ Y $, and fracture toughness $ K_{IC} $. The LEFM prediction is\n$$\n\\sigma_{\\text{LEFM}}(D) = \\frac{K_{IC}}{Y \\sqrt{\\pi a}} = \\frac{K_{IC}}{Y \\sqrt{\\pi \\alpha D}},\n$$\nwhere $ K_{IC} $ is the mode-$ I $ fracture toughness.\n\n3. Implement a program that, for each specimen size in the provided test suite, computes:\n   - The nonlocal damage model apparent tensile strength $ \\sigma_{\\text{app}}(D) $ in megapascals (MPa).\n   - The LEFM predicted apparent tensile strength $ \\sigma_{\\text{LEFM}}(D) $ in megapascals (MPa).\n   The program should numerically evaluate any needed integrals robustly and handle cases where the specimen size is small relative to the material length $ \\ell $ and vice versa.\n\n4. Use the following scientifically plausible material and geometry parameters in your computations:\n   - Young’s modulus: $ E = 30000 $ MPa.\n   - Nonlocal strain threshold: $ \\varepsilon_f = 0.0002 $ (dimensionless).\n   - Nonlocal characteristic length: $ \\ell = 0.05 $ m.\n   - Notch acuity parameter: $ \\eta = 0.01 $ (dimensionless), so $ \\rho = \\eta D $.\n   - Stress concentration factor: $ K_t = 3.0 $ (dimensionless).\n   - LEFM parameters: fracture toughness $ K_{IC} = 1.0 $ MPa$\\sqrt{\\mathrm{m}}$, geometry factor $ Y = 1.12 $ (dimensionless), crack-length proportion $ \\alpha = 0.25 $ (dimensionless).\n\n5. Test suite (specimen sizes in meters):\n   - Small-size extreme: $ D = 0.001 $ m.\n   - Small-size: $ D = 0.005 $ m.\n   - Near material length: $ D = 0.05 $ m.\n   - Moderate: $ D = 0.5 $ m.\n   - Large: $ D = 5.0 $ m.\n   - Very large: $ D = 10.0 $ m.\n\n6. Output specification:\n   - Express each computed apparent strength in megapascals (MPa) as a floating-point number.\n   - Your program should produce a single line of output containing the results as a comma-separated list of lists, where each inner list corresponds to one test case and has the form $ [\\sigma_{\\text{app}}(D), \\sigma_{\\text{LEFM}}(D)] $. For example, $ [[x_1,y_1],[x_2,y_2],\\dots] $.\n   - No extra text or commentary should be printed.\n\nScientific realism and discussion requirement:\n\n- In your solution, explain from first principles how the nonlocal averaging modifies the near-notch strain and introduces a material length $ \\ell $, and analyze the asymptotic behavior of $ \\sigma_{\\text{app}}(D) $ for $ D \\ll \\ell $ and $ D \\gg \\ell $. Discuss deviations from classic Linear Elastic Fracture Mechanics (LEFM) scaling, highlighting under which regimes the nonlocal prediction recovers $ D^{-\\frac{1}{2}} $ behavior and where it deviates to an approximately size-independent strength.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of continuum damage mechanics and linear elastic fracture mechanics, is well-posed with a complete and consistent set of definitions and parameters, and is expressed in objective, formal language. The task is non-trivial, requiring mathematical derivation, numerical implementation, and scientific analysis of the results.\n\n### 1. Derivation of Nonlocal Apparent Strength $\\sigma_{\\text{app}}(D)$\n\nThe analysis begins with the damage initiation criterion, which states that failure initiates at the notch root ($r=0$) when the nonlocal equivalent strain $\\bar{\\varepsilon}$ at that point reaches a critical material threshold $\\varepsilon_f$.\n$$\n\\bar{\\varepsilon}(0;D,\\sigma_{\\text{app}}) = \\varepsilon_f\n$$\nThe nonlocal equivalent strain $\\bar{\\varepsilon}(\\mathbf{x})$ is defined as a weighted average of the local equivalent strain field $\\varepsilon(\\mathbf{y})$. For the one-dimensional approximation along the notch flank ($r \\ge 0$) from the notch root, with $\\mathbf{x}=0$ and $\\mathbf{y}=r$, the expression becomes:\n$$\n\\bar{\\varepsilon}(0) = \\frac{\\int_{0}^{\\infty} w(r) \\, \\varepsilon(r) \\, dr}{\\int_{0}^{\\infty} w(r) \\, dr}\n$$\nThe specified weight function is the exponential kernel $w(r) = \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right)$. First, we evaluate the normalization integral in the denominator:\n$$\n\\int_{0}^{\\infty} w(r) \\, dr = \\int_{0}^{\\infty} \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right) \\, dr = \\left[ -\\exp\\left(-\\frac{r}{\\ell}\\right) \\right]_{0}^{\\infty} = 0 - (-1) = 1\n$$\nSince the kernel is properly normalized, the nonlocal strain at the notch root simplifies to:\n$$\n\\bar{\\varepsilon}(0) = \\int_{0}^{\\infty} w(r) \\, \\varepsilon(r) \\, dr\n$$\nWe now substitute the expressions for the kernel $w(r)$ and the local strain field $\\varepsilon(r;D,\\sigma) = \\frac{\\sigma}{E} K_t (1 + \\frac{r}{\\rho})^{-\\frac{1}{2}}$, where $\\rho = \\eta D$:\n$$\n\\bar{\\varepsilon}(0;D,\\sigma) = \\int_{0}^{\\infty} \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right) \\left[ \\frac{\\sigma}{E} K_t \\left(1 + \\frac{r}{\\rho}\\right)^{-\\frac{1}{2}} \\right] dr\n$$\nFactoring out terms that are constant with respect to the integration variable $r$, we get:\n$$\n\\bar{\\varepsilon}(0;D,\\sigma) = \\frac{\\sigma K_t}{E \\ell} \\int_{0}^{\\infty} \\exp\\left(-\\frac{r}{\\ell}\\right) \\left(1 + \\frac{r}{\\rho}\\right)^{-\\frac{1}{2}} dr\n$$\nLet the integral be denoted by $I(\\rho, \\ell)$. To solve it, we perform a change of variables. Let $u^2 = 1 + \\frac{r}{\\rho}$. This implies $r = \\rho(u^2 - 1)$ and $dr = 2\\rho u \\, du$. The integration limits change from $r \\in [0, \\infty)$ to $u \\in [1, \\infty)$.\n$$\nI(\\rho, \\ell) = \\int_{1}^{\\infty} \\exp\\left(-\\frac{\\rho(u^2 - 1)}{\\ell}\\right) (u^2)^{-\\frac{1}{2}} (2\\rho u \\, du)\n$$\n$$\nI(\\rho, \\ell) = \\int_{1}^{\\infty} \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\exp\\left(-\\frac{\\rho u^2}{\\ell}\\right) u^{-1} (2\\rho u \\, du) = 2\\rho \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\int_{1}^{\\infty} \\exp\\left(-\\frac{\\rho u^2}{\\ell}\\right) du\n$$\nThe remaining integral is related to the complementary error function, $\\text{erfc}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} e^{-t^2} dt$. We introduce another substitution: let $t = u \\sqrt{\\frac{\\rho}{\\ell}}$, so $du = \\sqrt{\\frac{\\ell}{\\rho}} dt$. The lower integration limit becomes $u=1 \\implies t=\\sqrt{\\frac{\\rho}{\\ell}}$.\n$$\n\\int_{1}^{\\infty} \\exp\\left(-\\frac{\\rho u^2}{\\ell}\\right) du = \\int_{\\sqrt{\\rho/\\ell}}^{\\infty} \\exp(-t^2) \\sqrt{\\frac{\\ell}{\\rho}} dt = \\sqrt{\\frac{\\ell}{\\rho}} \\left( \\frac{\\sqrt{\\pi}}{2} \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right) \\right)\n$$\nSubstituting this back into the expression for $I(\\rho, \\ell)$:\n$$\nI(\\rho, \\ell) = 2\\rho \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\left[ \\sqrt{\\frac{\\ell}{\\rho}} \\frac{\\sqrt{\\pi}}{2} \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right) \\right] = \\sqrt{\\pi \\rho \\ell} \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right)\n$$\nNow, we apply the damage initiation criterion $\\bar{\\varepsilon}(0;D,\\sigma_{\\text{app}}) = \\varepsilon_f$ with $\\sigma = \\sigma_{\\text{app}}(D)$:\n$$\n\\varepsilon_f = \\frac{\\sigma_{\\text{app}}(D) K_t}{E \\ell} I(\\rho, \\ell)\n$$\nSolving for the apparent strength $\\sigma_{\\text{app}}(D)$:\n$$\n\\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f \\ell}{K_t I(\\rho, \\ell)} = \\frac{E \\varepsilon_f \\ell}{K_t \\sqrt{\\pi \\rho \\ell} \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right)}\n$$\nSubstituting $\\rho = \\eta D$ and simplifying, we obtain the final expression for the apparent strength based on the nonlocal model:\n$$\n\\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f}{K_t} \\frac{\\sqrt{\\ell / (\\pi \\eta D)}}{ \\exp\\left(\\frac{\\eta D}{\\ell}\\right) \\text{erfc}\\left(\\sqrt{\\frac{\\eta D}{\\ell}}\\right)}\n$$\nFor numerical stability, it is advantageous to use the scaled complementary error function, $\\text{erfcx}(x) = \\exp(x^2)\\text{erfc}(x)$. Letting $x = \\sqrt{\\eta D/\\ell}$, the expression becomes:\n$$\n\\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f}{K_t} \\frac{\\sqrt{\\ell / (\\pi \\eta D)}}{\\text{erfcx}\\left(\\sqrt{\\frac{\\eta D}{\\ell}}\\right)}\n$$\n\n### 2. LEFM Apparent Strength Scaling $\\sigma_{\\text{LEFM}}(D)$\n\nLinear Elastic Fracture Mechanics (LEFM) postulates that fracture occurs when the stress intensity factor, $K_I$, reaches a critical material property, the fracture toughness $K_{IC}$. For a specimen with a crack of length $a$ under remote stress $\\sigma$, the stress intensity factor is given by $K_I = \\sigma Y \\sqrt{\\pi a}$, where $Y$ is a dimensionless geometry factor. For geometrically similar specimens, we have $a = \\alpha D$.\nThe LEFM failure criterion is $K_I = K_{IC}$, which leads to:\n$$\n\\sigma_{\\text{LEFM}}(D) Y \\sqrt{\\pi (\\alpha D)} = K_{IC}\n$$\nSolving for the apparent strength $\\sigma_{\\text{LEFM}}(D)$ gives the well-known scaling law:\n$$\n\\sigma_{\\text{LEFM}}(D) = \\frac{K_{IC}}{Y \\sqrt{\\pi \\alpha D}}\n$$\nThis predicts that the strength is inversely proportional to the square root of the characteristic size, $\\sigma_{\\text{LEFM}} \\propto D^{-1/2}$.\n\n### 3. Scientific Discussion and Asymptotic Analysis\n\nThe introduction of nonlocal averaging with a characteristic length $\\ell$ regularizes the problem of fracture initiation at a stress concentration. Instead of failure being dictated by a singular point of infinite stress (as in a sharp crack) or a maximum stress at a point (as in a local notch analysis), it is governed by the state of strain over a finite material volume. This physical regularization introduces a material length scale $\\ell$ which competes with the structural size $D$, giving rise to a size effect.\n\nWe analyze the asymptotic behavior of $\\sigma_{\\text{app}}(D)$ by examining the argument $x = \\sqrt{\\eta D/\\ell}$.\n\n**Case 1: Large specimens ($D \\gg \\ell/\\eta \\implies x \\to \\infty$)**\nFor large arguments, the scaled complementary error function has the asymptotic expansion $\\text{erfcx}(x) \\sim \\frac{1}{x\\sqrt{\\pi}}$.\n$$\n\\lim_{D\\to\\infty} \\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f}{K_t} \\lim_{x\\to\\infty} \\frac{1/(x\\sqrt{\\pi})}{1/(x\\sqrt{\\pi})} = \\frac{E \\varepsilon_f}{K_t}\n$$\nIn this limit, the apparent strength becomes size-independent. This corresponds to a classical strength-of-materials criterion, where failure occurs when the maximum local stress, $\\sigma_{\\text{max}} = K_t \\sigma_{\\text{app}}$, reaches a material strength limit, which we can identify as $\\sigma_0 = E\\varepsilon_f$. For very large structures, the nonlocal region $\\ell$ is negligible compared to the geometry, and the model converges to a local failure theory.\n\n**Case 2: Small specimens ($D \\ll \\ell/\\eta \\implies x \\to 0$)**\nFor small arguments, $\\text{erfcx}(x) \\approx 1$.\n$$\n\\lim_{D\\to 0} \\sigma_{\\text{app}}(D) \\approx \\frac{E \\varepsilon_f}{K_t} \\frac{\\sqrt{\\ell / (\\pi \\eta D)}}{1} = \\left( \\frac{E \\varepsilon_f}{K_t} \\sqrt{\\frac{\\ell}{\\pi \\eta}} \\right) D^{-1/2}\n$$\nIn this limit, the nonlocal apparent strength exhibits a $D^{-1/2}$ scaling, which is the characteristic signature of LEFM. When the specimen is small compared to the material length scale, the blunt notch behaves effectively like a sharp crack, and the model recovers the LEFM size effect.\n\nIn summary, the nonlocal damage model provides a unified framework that bridges the gap between two classical failure theories. It transitions from LEFM-like behavior for small structures to a size-independent strength criterion for large structures. The transition is governed by the dimensionless ratio of a geometry-dependent length scale, $\\rho = \\eta D$, to the intrinsic material length scale, $\\ell$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erfcx\n\ndef solve():\n    \"\"\"\n    Computes apparent tensile strength using a nonlocal damage model and LEFM\n    for a range of specimen sizes.\n    \"\"\"\n    # Material and geometry parameters\n    E = 30000.0   # Young's modulus [MPa]\n    eps_f = 0.0002  # Nonlocal strain threshold [dimensionless]\n    l = 0.05      # Nonlocal characteristic length [m]\n    eta = 0.01      # Notch acuity parameter [dimensionless]\n    K_t = 3.0       # Stress concentration factor [dimensionless]\n    \n    # LEFM parameters\n    K_IC = 1.0    # Fracture toughness [MPa*m^0.5]\n    Y = 1.12      # SIF geometry coefficient [dimensionless]\n    alpha = 0.25    # Crack-length proportion [dimensionless]\n\n    # Test suite of specimen sizes [m]\n    test_cases = [0.001, 0.005, 0.05, 0.5, 5.0, 10.0]\n\n    results = []\n\n    for D in test_cases:\n        # --- Nonlocal Damage Model Calculation ---\n        \n        # Derived expression for apparent strength sigma_app(D)\n        # sigma_app(D) = (E * eps_f / K_t) * (sqrt(l / (pi * eta * D)) / erfcx(sqrt(eta * D / l)))\n        \n        rho = eta * D\n        \n        # Argument for the scaled complementary error function\n        x = np.sqrt(rho / l)\n        \n        # Numerator term from the derived formula\n        numerator_term = np.sqrt(l / (np.pi * rho))\n        \n        # The scaled complementary error function erfcx(x) = exp(x^2)*erfc(x)\n        # is used for numerical stability, especially for large x where exp(x^2)\n        # would overflow and erfc(x) would underflow.\n        erfcx_val = erfcx(x)\n        \n        sigma_app = (E * eps_f / K_t) * (numerator_term / erfcx_val)\n        \n        # --- LEFM Calculation ---\n        \n        # LEFM predicted apparent strength sigma_lefm(D)\n        # sigma_lefm(D) = K_IC / (Y * sqrt(pi * alpha * D))\n        \n        a = alpha * D\n        sigma_lefm = K_IC / (Y * np.sqrt(np.pi * a))\n        \n        results.append([sigma_app, sigma_lefm])\n\n    # Format the output as a string representation of a list of lists.\n    # e.g., [[val1_1, val1_2], [val2_1, val2_2]]\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]}]\" for res in results]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Understanding the energetic driving force is central to predicting fracture, and the $J$-integral is the paramount tool for its quantification in computational mechanics. Theoretically representing the energy flux into the crack tip, its value is path-independent in elastic materials, making it a robust numerical measure. This hands-on coding exercise  guides you through the process of numerically evaluating the $J$-integral on different contours, allowing you to verify its path-independence and gain firsthand experience with a fundamental technique used in virtually all modern fracture simulation software.",
            "id": "3785413",
            "problem": "You are given a scenario in Linear Elastic Fracture Mechanics (LEFM) under small-strain, quasi-static conditions for an isotropic, homogeneous material containing a sharp crack. The crack tip exhibits a near-tip singular field. The objective is to compute the energy release rate, known as the $J$-integral, and to assess its path independence by evaluating $J$ over multiple closed contours encircling the crack tip.\n\nStarting from the fundamental base:\n- The strain energy density is defined by $W = \\tfrac{1}{2} \\,\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\sigma_{xx}\\,\\varepsilon_{xx} + \\sigma_{yy}\\,\\varepsilon_{yy} + 2\\,\\sigma_{xy}\\,\\varepsilon_{xy}\\right)$.\n- The traction vector on a contour with outward unit normal $\\boldsymbol{n}$ is $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\cdot\\boldsymbol{n}$.\n- The $J$-integral represents the energy flux into the crack tip per unit thickness along the crack extension direction $x_1$, and is expressed by a contour integral derived from energy-momentum conservation laws.\n\nFor numerical evaluation, use the circular contour parameterization around the crack tip with radius $R$ and polar angle $\\theta$, where the outward normal is $\\boldsymbol{n} = [\\cos\\theta,\\sin\\theta]$ and the line element is $ds = R\\,d\\theta$. Compute the field quantities on the contour from a near-tip asymptotic Mode I solution for displacements $\\boldsymbol{u} = [u_x,u_y]$, then obtain displacement gradients $\\partial u_i/\\partial x_j$, strains $\\boldsymbol{\\varepsilon}$, stresses $\\boldsymbol{\\sigma}$ via linear elasticity, and assemble the $J$-integral along each contour using the contour definition.\n\nYour program must:\n1. Implement the above principle-based numerical procedure to evaluate $J$ on multiple circular contours of radii $R$ centered at the crack tip.\n2. Use the plane stress or plane strain assumptions as specified for each test case. For plane strain, use Lamé parameters $\\lambda$ and $\\mu$; for plane stress, use two-dimensional elasticity relations.\n3. Quantify path independence by computing the coefficient of variation across the set of contour-evaluated $J$ values, defined as $\\mathrm{CV} = \\sigma_J / \\overline{J}$, where $\\sigma_J$ is the standard deviation of the set of $J$ values and $\\overline{J}$ is the mean of the set.\n\nPhysical and numerical setup:\n- Material is isotropic with Young’s modulus $E$ and Poisson’s ratio $\\nu$.\n- Mode I stress intensity factor $K_I$ is specified.\n- The thickness is unity; report $J$ in $\\mathrm{N}/\\mathrm{m}$ internally, but the final program output should only be the dimensionless coefficient of variation values per test case.\n- Angles are in radians.\n\nTest suite:\n- Case $1$: plane strain with $E = 210\\,\\mathrm{GPa}$, $\\nu = 0.3$, $K_I = 50\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, contour radii $R = [0.01, 0.02, 0.04]\\,\\mathrm{m}$, using $N_\\theta = 400$ quadrature points.\n- Case $2$: plane stress with $E = 70\\,\\mathrm{GPa}$, $\\nu = 0.33$, $K_I = 30\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, contour radii $R = [0.005, 0.015, 0.03]\\,\\mathrm{m}$, using $N_\\theta = 240$ quadrature points.\n- Case $3$: plane strain with $E = 100\\,\\mathrm{GPa}$, $\\nu = 0.45$, $K_I = 10\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, contour radii $R = [0.002, 0.004, 0.008]\\,\\mathrm{m}$, using $N_\\theta = 120$ quadrature points.\n\nYour program should produce a single line of output containing the coefficient of variation values for the three cases as a comma-separated list enclosed in square brackets, for example $[v_1,v_2,v_3]$, where each $v_i$ is a floating-point number.\n\nUnit conventions and conversions:\n- Convert $E$ from $\\mathrm{GPa}$ to $\\mathrm{Pa}$.\n- Convert $K_I$ from $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ to $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$.\n- Internally compute $J$ in $\\mathrm{N}/\\mathrm{m}$; however, the final output is the dimensionless coefficient of variation for each case.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result1,result2,result3]$).",
            "solution": "We derive a numerical procedure to evaluate the $J$-integral around the crack tip and to assess its path independence using multiple contours. The derivation starts from conservation of energy and the definition of the $J$-integral as an energy flux quantity.\n\nFundamental principles and definitions:\n1. Consider a crack in an isotropic, homogeneous, linear elastic material under small strain and quasi-static conditions, as in Linear Elastic Fracture Mechanics (LEFM). The strain tensor is $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla\\boldsymbol{u} + (\\nabla\\boldsymbol{u})^\\top\\right)$, and the Cauchy stress tensor $\\boldsymbol{\\sigma}$ is related to the strain by Hooke’s law for isotropic elasticity. The strain energy density is $W = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$.\n2. The traction vector on a contour with outward unit normal $\\boldsymbol{n}$ is $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\cdot\\boldsymbol{n}$.\n3. The $J$-integral is defined as the energy flux into the crack tip per unit extension along the $x_1$ (crack propagation) direction. From the energy-momentum tensor derivation (Eshelby/Rice), one obtains a path-independent contour integral:\n$$\nJ \\;=\\; \\oint_\\Gamma \\left( W\\,n_1 \\;-\\; \\sigma_{ij}\\,\\frac{\\partial u_i}{\\partial x_1}\\,n_j \\right) \\, ds,\n$$\nwhere $n_1$ is the first component of the unit normal $\\boldsymbol{n}$, indices $i,j\\in\\{1,2\\}$ refer to the Cartesian components, and $ds$ is the line element along the contour $\\Gamma$ that encircles the crack tip.\n\nNear-tip asymptotic fields for Mode I:\nWe use the classical near-tip asymptotic solution for Mode I displacements, expressed in polar coordinates $(r,\\theta)$ centered at the crack tip, with the crack lying along the negative $x$-axis and the $x$-direction taken as the crack extension direction. The displacement components $u_x(r,\\theta)$ and $u_y(r,\\theta)$ are given by\n$$\nu_x(r,\\theta) \\;=\\; \\frac{K_I}{E'}\\,\\sqrt{\\frac{r}{2\\pi}}\\,\\cos\\!\\left(\\frac{\\theta}{2}\\right)\\,\\left(\\kappa \\;-\\; \\cos\\theta\\right),\n$$\n$$\nu_y(r,\\theta) \\;=\\; \\frac{K_I}{E'}\\,\\sqrt{\\frac{r}{2\\pi}}\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)\\,\\left(\\kappa \\;-\\; \\cos\\theta\\right),\n$$\nwhere $K_I$ is the Mode I stress intensity factor, $E'$ is the effective modulus, and $\\kappa$ is the Kolosov constant. For plane strain, $E' = \\dfrac{E}{1-\\nu^2}$ and $\\kappa = 3 - 4\\nu$; for plane stress, $E' = E$ and $\\kappa = \\dfrac{3 - \\nu}{1 + \\nu}$. These expressions are well-tested and form the foundation of the near-tip approximation in LEFM.\n\nField gradients and constitutive relations:\nTo evaluate the contour integral, we require spatial derivatives of the displacement. We compute partial derivatives in polar coordinates and then map them to Cartesian derivatives via the chain rule. Let\n$$\nA(r) \\;=\\; \\frac{K_I}{E'}\\,\\sqrt{\\frac{r}{2\\pi}}, \\quad \\frac{\\partial A}{\\partial r} \\;=\\; \\frac{K_I}{E'}\\,\\frac{1}{2\\sqrt{2\\pi r}},\n$$\nand define the common factor $C(\\theta) = \\kappa - \\cos\\theta$. The polar partial derivatives are\n$$\n\\frac{\\partial u_x}{\\partial r} \\;=\\; \\frac{\\partial A}{\\partial r} \\,\\cos\\!\\left(\\frac{\\theta}{2}\\right)\\,C(\\theta),\n\\quad\n\\frac{\\partial u_x}{\\partial \\theta} \\;=\\; A(r)\\,\\left(\\,-\\tfrac{1}{2}\\sin\\!\\left(\\frac{\\theta}{2}\\right) C(\\theta) \\;+\\; \\cos\\!\\left(\\frac{\\theta}{2}\\right)\\sin\\theta \\right),\n$$\n$$\n\\frac{\\partial u_y}{\\partial r} \\;=\\; \\frac{\\partial A}{\\partial r} \\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)\\,C(\\theta),\n\\quad\n\\frac{\\partial u_y}{\\partial \\theta} \\;=\\; A(r)\\,\\left(\\,\\tfrac{1}{2}\\cos\\!\\left(\\frac{\\theta}{2}\\right) C(\\theta) \\;+\\; \\sin\\!\\left(\\frac{\\theta}{2}\\right)\\sin\\theta \\right).\n$$\nThe polar-to-Cartesian derivatives use\n$$\n\\frac{\\partial r}{\\partial x} \\;=\\; \\cos\\theta, \\quad \\frac{\\partial r}{\\partial y} \\;=\\; \\sin\\theta,\n\\quad\n\\frac{\\partial \\theta}{\\partial x} \\;=\\; -\\frac{\\sin\\theta}{r}, \\quad \\frac{\\partial \\theta}{\\partial y} \\;=\\; \\frac{\\cos\\theta}{r}.\n$$\nThus,\n$$\n\\frac{\\partial u_x}{\\partial x} \\;=\\; \\frac{\\partial u_x}{\\partial r}\\,\\cos\\theta \\;+\\; \\frac{\\partial u_x}{\\partial \\theta}\\,\\left(-\\frac{\\sin\\theta}{r}\\right),\n\\quad\n\\frac{\\partial u_x}{\\partial y} \\;=\\; \\frac{\\partial u_x}{\\partial r}\\,\\sin\\theta \\;+\\; \\frac{\\partial u_x}{\\partial \\theta}\\,\\left(\\frac{\\cos\\theta}{r}\\right),\n$$\n$$\n\\frac{\\partial u_y}{\\partial x} \\;=\\; \\frac{\\partial u_y}{\\partial r}\\,\\cos\\theta \\;+\\; \\frac{\\partial u_y}{\\partial \\theta}\\,\\left(-\\frac{\\sin\\theta}{r}\\right),\n\\quad\n\\frac{\\partial u_y}{\\partial y} \\;=\\; \\frac{\\partial u_y}{\\partial r}\\,\\sin\\theta \\;+\\; \\frac{\\partial u_y}{\\partial \\theta}\\,\\left(\\frac{\\cos\\theta}{r}\\right).\n$$\n\nStrain components are then\n$$\n\\varepsilon_{xx} \\;=\\; \\frac{\\partial u_x}{\\partial x}, \\quad\n\\varepsilon_{yy} \\;=\\; \\frac{\\partial u_y}{\\partial y}, \\quad\n\\varepsilon_{xy} \\;=\\; \\tfrac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right).\n$$\nFor plane strain, we use the three-dimensional isotropic linear elasticity restricted to plane strain:\n$$\n\\mu \\;=\\; \\frac{E}{2(1+\\nu)}, \\quad \\lambda \\;=\\; \\frac{E\\nu}{(1+\\nu)(1-2\\nu)},\n$$\nand\n$$\n\\sigma_{xx} \\;=\\; 2\\mu\\,\\varepsilon_{xx} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}), \\quad\n\\sigma_{yy} \\;=\\; 2\\mu\\,\\varepsilon_{yy} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}), \\quad\n\\sigma_{xy} \\;=\\; 2\\mu\\,\\varepsilon_{xy}.\n$$\nFor plane stress, the constitutive relations are\n$$\n\\sigma_{xx} \\;=\\; \\frac{E}{1-\\nu^2}\\left(\\varepsilon_{xx} + \\nu\\,\\varepsilon_{yy}\\right), \\quad\n\\sigma_{yy} \\;=\\; \\frac{E}{1-\\nu^2}\\left(\\varepsilon_{yy} + \\nu\\,\\varepsilon_{xx}\\right), \\quad\n\\sigma_{xy} \\;=\\; \\frac{E}{1+\\nu}\\,\\varepsilon_{xy}.\n$$\nThe strain energy density is\n$$\nW \\;=\\; \\tfrac{1}{2}\\left(\\sigma_{xx}\\,\\varepsilon_{xx} + \\sigma_{yy}\\,\\varepsilon_{yy} + 2\\,\\sigma_{xy}\\,\\varepsilon_{xy}\\right).\n$$\n\nContour integral assembly:\nFor a circular contour of radius $R$, parametrize by $\\theta\\in[-\\pi,\\pi)$, with unit normal $\\boldsymbol{n} = [\\cos\\theta,\\sin\\theta]$ and line element $ds = R\\,d\\theta$. The traction vector is\n$$\nt_x \\;=\\; \\sigma_{xx}\\cos\\theta + \\sigma_{xy}\\sin\\theta, \\quad\nt_y \\;=\\; \\sigma_{xy}\\cos\\theta + \\sigma_{yy}\\sin\\theta.\n$$\nThe integrand of the $J$-integral is\n$$\n\\mathcal{I}(\\theta) \\;=\\; W\\,n_1 \\;-\\; \\left(t_x\\,\\frac{\\partial u_x}{\\partial x} + t_y\\,\\frac{\\partial u_y}{\\partial x}\\right),\n$$\nand the numerical approximation using the trapezoidal rule with $N_\\theta$ points is\n$$\nJ(R) \\;\\approx\\; \\sum_{k=1}^{N_\\theta} \\mathcal{I}(\\theta_k)\\,R\\,\\Delta\\theta, \\quad \\Delta\\theta = \\frac{2\\pi}{N_\\theta}, \\quad \\theta_k = -\\pi + (k-1)\\Delta\\theta.\n$$\n\nPath independence assessment:\nCompute $J(R)$ for each radius $R$ in a specified set and quantify variation by the coefficient of variation,\n$$\n\\mathrm{CV} \\;=\\; \\frac{\\sqrt{\\frac{1}{N}\\sum_{i=1}^N\\left(J(R_i) - \\overline{J}\\right)^2}}{\\overline{J}}, \\quad \\overline{J} = \\frac{1}{N}\\sum_{i=1}^N J(R_i).\n$$\n\nAlgorithmic design:\n1. Convert $E$ from $\\mathrm{GPa}$ to $\\mathrm{Pa}$ and $K_I$ from $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ to $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$.\n2. For each test case and each contour radius $R$:\n   - Loop over $\\theta$ with $N_\\theta$ evenly spaced points.\n   - Evaluate $u_x(r,\\theta)$ and $u_y(r,\\theta)$ at $r=R$ using the near-tip asymptotic solution.\n   - Compute $\\partial u_i/\\partial r$ and $\\partial u_i/\\partial \\theta$, then map to Cartesian derivatives $\\partial u_i/\\partial x$ and $\\partial u_i/\\partial y$ using the chain rule.\n   - Assemble strains and stresses using the appropriate plane stress or plane strain constitutive laws.\n   - Compute $W$, $\\boldsymbol{t}$, and the integrand $\\mathcal{I}(\\theta)$.\n   - Numerically integrate around the contour to obtain $J(R)$.\n3. For each test case, compute the coefficient of variation across all $J(R)$ values.\n4. Output the coefficient of variation values for the three test cases as a single list.\n\nNotes on realism and edge cases:\n- Very small radii $R$ increase sensitivity to numerical quadrature due to stronger gradients; coarse angular discretization $N_\\theta$ may increase variation.\n- High Poisson’s ratio in plane strain (e.g., $\\nu = 0.45$) approaches incompressible behavior, challenging numerical evaluation.\n\nThe final program implements this procedure for the provided test suite and prints the coefficients of variation for Cases $1$, $2$, and $3$ in the required format.",
            "answer": "```python\nimport numpy as np\n\ndef kappa(mode: str, nu: float) -> float:\n    \"\"\"Kolosov constant.\"\"\"\n    if mode == 'plane_stress':\n        return (3.0 - nu) / (1.0 + nu)\n    elif mode == 'plane_strain':\n        return 3.0 - 4.0 * nu\n    else:\n        raise ValueError(\"mode must be 'plane_stress' or 'plane_strain'\")\n\ndef effective_modulus(mode: str, E: float, nu: float) -> float:\n    \"\"\"Effective modulus E' for Mode I scaling.\"\"\"\n    if mode == 'plane_stress':\n        return E\n    elif mode == 'plane_strain':\n        return E / (1.0 - nu**2)\n    else:\n        raise ValueError(\"mode must be 'plane_stress' or 'plane_strain'\")\n\ndef displacement_mode_I(K: float, Eprime: float, nu: float, mode: str, r: float, th: float):\n    \"\"\"Near-tip Mode I displacement field u_x, u_y in polar coordinates.\"\"\"\n    kap = kappa(mode, nu)\n    A = (K / Eprime) * np.sqrt(r / (2.0 * np.pi))\n    common = kap - np.cos(th)\n    ux = A * np.cos(th / 2.0) * common\n    uy = A * np.sin(th / 2.0) * common\n    return ux, uy\n\ndef displacement_partials(K: float, Eprime: float, nu: float, mode: str, r: float, th: float):\n    \"\"\"Partial derivatives of u_x and u_y w.r.t r and theta.\"\"\"\n    kap = kappa(mode, nu)\n    A = (K / Eprime) * np.sqrt(r / (2.0 * np.pi))\n    dA_dr = (K / Eprime) * (1.0 / (2.0 * np.sqrt(2.0 * np.pi * r)))\n    common = kap - np.cos(th)\n    # u_x\n    ux_r = dA_dr * np.cos(th / 2.0) * common\n    ux_th = A * (-0.5 * np.sin(th / 2.0) * common + np.cos(th / 2.0) * np.sin(th))\n    # u_y\n    uy_r = dA_dr * np.sin(th / 2.0) * common\n    uy_th = A * (0.5 * np.cos(th / 2.0) * common + np.sin(th / 2.0) * np.sin(th))\n    return ux_r, ux_th, uy_r, uy_th\n\ndef spatial_gradients(K: float, Eprime: float, nu: float, mode: str, r: float, th: float):\n    \"\"\"Compute spatial gradients: ux_x, ux_y, uy_x, uy_y at (r,theta).\"\"\"\n    ux_r, ux_th, uy_r, uy_th = displacement_partials(K, Eprime, nu, mode, r, th)\n    cos_th = np.cos(th)\n    sin_th = np.sin(th)\n    dr_dx, dr_dy = cos_th, sin_th\n    dth_dx = -sin_th / r\n    dth_dy = cos_th / r\n    ux_x = ux_r * dr_dx + ux_th * dth_dx\n    ux_y = ux_r * dr_dy + ux_th * dth_dy\n    uy_x = uy_r * dr_dx + uy_th * dth_dx\n    uy_y = uy_r * dr_dy + uy_th * dth_dy\n    return ux_x, ux_y, uy_x, uy_y\n\ndef strains_from_gradients(ux_x: float, ux_y: float, uy_x: float, uy_y: float):\n    \"\"\"Compute strain components from displacement gradients.\"\"\"\n    exx = ux_x\n    eyy = uy_y\n    exy = 0.5 * (ux_y + uy_x)\n    return exx, eyy, exy\n\ndef stresses_plane_strain(E: float, nu: float, exx: float, eyy: float, exy: float):\n    \"\"\"Plane strain stresses from strains.\"\"\"\n    mu = E / (2.0 * (1.0 + nu))\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    tr = exx + eyy\n    sxx = 2.0 * mu * exx + lam * tr\n    syy = 2.0 * mu * eyy + lam * tr\n    sxy = 2.0 * mu * exy\n    return sxx, syy, sxy\n\ndef stresses_plane_stress(E: float, nu: float, exx: float, eyy: float, exy: float):\n    \"\"\"Plane stress stresses from strains.\"\"\"\n    Eps = E / (1.0 - nu**2)\n    sxx = Eps * (exx + nu * eyy)\n    syy = Eps * (eyy + nu * exx)\n    sxy = E / (1.0 + nu) * exy\n    return sxx, syy, sxy\n\ndef energy_density(sxx: float, syy: float, sxy: float, exx: float, eyy: float, exy: float):\n    \"\"\"Compute strain energy density W.\"\"\"\n    return 0.5 * (sxx * exx + syy * eyy + 2.0 * sxy * exy)\n\ndef traction_on_circle(sxx: float, syy: float, sxy: float, th: float):\n    \"\"\"Compute traction components on a circular contour with outward normal n=[cos, sin].\"\"\"\n    c = np.cos(th)\n    s = np.sin(th)\n    tx = sxx * c + sxy * s\n    ty = sxy * c + syy * s\n    return tx, ty\n\ndef compute_J_for_radius(E: float, nu: float, K: float, mode: str, R: float, n_theta: int):\n    \"\"\"Compute J integral around a circular contour of radius R.\"\"\"\n    Eprime = effective_modulus(mode, E, nu)\n    dth = 2.0 * np.pi / n_theta\n    J_sum = 0.0\n    # Loop over theta points\n    for k in range(n_theta):\n        th = -np.pi + k * dth\n        # Displacement gradients at (r=R,theta=th)\n        ux_x, ux_y, uy_x, uy_y = spatial_gradients(K, Eprime, nu, mode, R, th)\n        # Strains\n        exx, eyy, exy = strains_from_gradients(ux_x, ux_y, uy_x, uy_y)\n        # Stresses\n        if mode == 'plane_strain':\n            sxx, syy, sxy = stresses_plane_strain(E, nu, exx, eyy, exy)\n        else:\n            sxx, syy, sxy = stresses_plane_stress(E, nu, exx, eyy, exy)\n        # Energy density\n        W = energy_density(sxx, syy, sxy, exx, eyy, exy)\n        # Traction and integrand\n        tx, ty = traction_on_circle(sxx, syy, sxy, th)\n        nx = np.cos(th)\n        integrand = W * nx - (tx * ux_x + ty * uy_x)\n        J_sum += integrand\n    J = J_sum * R * dth\n    return J\n\ndef coefficient_of_variation(values: np.ndarray) -> float:\n    mean = float(np.mean(values))\n    std = float(np.std(values))\n    # Avoid divide by zero; if mean is zero, return 0.0 if all values are zero, else inf.\n    if mean == 0.0:\n        return 0.0 if np.allclose(values, 0.0) else float('inf')\n    return std / mean\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: plane strain, E=210 GPa, nu=0.3, K_I=50 MPa sqrt(m), R=[0.01,0.02,0.04] m, N_theta=400\n        {\n            \"mode\": \"plane_strain\",\n            \"E_GPa\": 210.0,\n            \"nu\": 0.3,\n            \"K_MPa_sqrt_m\": 50.0,\n            \"radii_m\": [0.01, 0.02, 0.04],\n            \"n_theta\": 400,\n        },\n        # Case 2: plane stress, E=70 GPa, nu=0.33, K_I=30 MPa sqrt(m), R=[0.005,0.015,0.03] m, N_theta=240\n        {\n            \"mode\": \"plane_stress\",\n            \"E_GPa\": 70.0,\n            \"nu\": 0.33,\n            \"K_MPa_sqrt_m\": 30.0,\n            \"radii_m\": [0.005, 0.015, 0.03],\n            \"n_theta\": 240,\n        },\n        # Case 3: plane strain, E=100 GPa, nu=0.45, K_I=10 MPa sqrt(m), R=[0.002,0.004,0.008] m, N_theta=120\n        {\n            \"mode\": \"plane_strain\",\n            \"E_GPa\": 100.0,\n            \"nu\": 0.45,\n            \"K_MPa_sqrt_m\": 10.0,\n            \"radii_m\": [0.002, 0.004, 0.008],\n            \"n_theta\": 120,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        mode = case[\"mode\"]\n        E = case[\"E_GPa\"] * 1e9  # Pa\n        nu = case[\"nu\"]\n        K = case[\"K_MPa_sqrt_m\"] * 1e6  # Pa * sqrt(m)\n        radii = case[\"radii_m\"]\n        n_theta = case[\"n_theta\"]\n\n        J_values = []\n        for R in radii:\n            J_R = compute_J_for_radius(E, nu, K, mode, R, n_theta)\n            J_values.append(J_R)\n        J_values = np.array(J_values, dtype=float)\n        cv = coefficient_of_variation(J_values)\n        results.append(cv)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}