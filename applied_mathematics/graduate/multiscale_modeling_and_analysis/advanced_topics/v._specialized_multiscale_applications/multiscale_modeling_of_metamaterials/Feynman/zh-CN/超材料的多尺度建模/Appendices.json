{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习将解决均质化理论中的一个经典问题：计算两相棋盘格复合材料的有效电导率。通过解析求解此问题，您将亲身体验周期性单元问题、对称性论证以及二维系统中强大的对偶原理等基本概念。这项练习为您理解微观结构如何决定宏观属性打下坚实的理论基础。",
            "id": "3785773",
            "problem": "考虑一个由两种各向同性导电相组成的二维周期性超材料，其电导率分别为 $k_{1} > 0$ 和 $k_{2} > 0$。设代表性周期单元为 $Y = [0,1]^{2}$，它被划分为四个边长为 $1/2$ 的相等子正方形的棋盘格排列，使得在两个对角子正方形 $\\left([0,\\tfrac{1}{2}]\\times[0,\\tfrac{1}{2}]\\right)\\cup\\left([\\tfrac{1}{2},1]\\times[\\tfrac{1}{2},1]\\right)$ 上 $a(y) = k_{1}$，而在非对角子正方形 $\\left([\\tfrac{1}{2},1]\\times[0,\\tfrac{1}{2}]\\right)\\cup\\left([0,\\tfrac{1}{2}]\\times[\\tfrac{1}{2},1]\\right)$ 上 $a(y) = k_{2}$。对于 $x \\in \\Omega$，定义快变电导率 $a^{\\epsilon}(x) = a\\!\\left(\\tfrac{x}{\\epsilon}\\right)$，其中 $\\Omega \\subset \\mathbb{R}^{2}$ 是一个有界域，$\\epsilon > 0$ 是描述微观周期的小参数。\n\n对于给定的恒定宏观场方向 $E \\in \\mathbb{R}^{2}$，考虑由偏微分方程控制的非均匀传导\n$$\n-\\nabla \\cdot \\left(a^{\\epsilon}(x)\\,\\nabla u^{\\epsilon}(x)\\right) = 0 \\quad \\text{in } \\Omega,\n$$\n边界条件为在 $\\partial \\Omega$ 上 $u^{\\epsilon}(x) = E \\cdot x$。当 $\\epsilon \\to 0$ 时，解 $u^{\\epsilon}$ （在适当意义下）收敛于均匀化解 $u^{0}$，该解满足\n$$\n-\\nabla \\cdot \\left(A^{*}\\,\\nabla u^{0}(x)\\right) = 0 \\quad \\text{in } \\Omega,\n$$\n且在 $\\partial \\Omega$ 上 $u^{0}(x) = E \\cdot x$，其中 $A^{*}$ 是周期性微结构的有效（均匀化）电导率张量。\n\n使用双尺度展开框架和周期性单元问题，推导该棋盘格超材料的标量有效电导率 $k^{*}$ 的闭式表达式，其定义为 $A^{*} = k^{*} I$，其中 $I$ 是 $2\\times 2$ 单位矩阵。您的推导必须从单元问题\n$$\n-\\nabla_{y} \\cdot \\left(a(y)\\left(e_{i} + \\nabla_{y}\\chi^{i}(y)\\right)\\right) = 0 \\quad \\text{in } Y, \\qquad \\chi^{i} \\text{ is } Y\\text{-periodic with } \\int_{Y}\\chi^{i}(y)\\,dy = 0,\n$$\n对于 $i=1,2$ 开始，并且必须通过通量平均计算 $A^{*}$，\n$$\nA^{*}_{ij} = \\int_{Y} a(y)\\left(e_{i} + \\nabla_{y}\\chi^{i}(y)\\right)\\cdot e_{j}\\, dy.\n$$\n您可以使用二维无散场的基本性质和棋盘格的几何对称性，但不得假定任何已知的有效电导率闭式公式。\n\n请用 $k_{1}$ 和 $k_{2}$ 的符号形式表示您对 $k^{*}$ 的最终答案。最终表达式中不要包含单位。",
            "solution": "确定周期性复合介质的有效电导率是均匀化理论的核心课题。所述问题是适定的、有科学依据的，并为其解决提供了所有必要信息。我们将首先利用几何对称性确定有效电导率张量 $A^*$ 的各向同性性质，然后应用特定于二维传导问题的对偶性论证来确定 $k^*$ 的值，从而推导出标量有效电导率 $k^*$。\n\n首先，我们确定有效电导率张量 $A^*$ 必须是各向同性的，即形式为 $A^{*} = k^{*}I$，其中 $k^{*}$ 是一个标量，$I$ 是 $2 \\times 2$ 单位矩阵。有效张量 $A^*$ 通过 $\\langle j \\rangle = A^* \\langle E \\rangle$ 将体平均电场 $\\langle E \\rangle$ 与体平均电流密度 $\\langle j \\rangle$ 联系起来。张量 $A^*$ 必须继承底层微结构的宏观对称性。棋盘格微结构具有多种对称性。考虑将坐标系旋转 $90^\\circ$（或 $\\pi/2$ 弧度）。设此旋转由矩阵 $R = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$ 表示。定义在单位单元 $Y=[0,1]^2$ 上的棋盘格图案，在绕其中心 $(1/2, 1/2)$ 进行此类旋转时保持不变。由于微结构的这种旋转对称性，有效本构关系也必须是旋转不变的。这意味着，如果我们将宏观场 $\\langle E \\rangle$ 旋转为 $R\\langle E \\rangle$，产生的宏观通量必须相应地旋转为 $R\\langle j \\rangle$。因此，$R\\langle j \\rangle = A^*(R\\langle E \\rangle)$。代入 $\\langle j \\rangle = A^* \\langle E \\rangle$，我们得到 $RA^*\\langle E \\rangle = A^*R\\langle E \\rangle$。由于这对任何宏观场 $\\langle E \\rangle$ 都必须成立，我们必须有矩阵对易关系 $RA^* = A^*R$。设 $A^* = \\begin{pmatrix} A^*_{11}  A^*_{12} \\\\ A^*_{21}  A^*_{22} \\end{pmatrix}$。对易关系给出：\n$$\n\\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} A^*_{11}  A^*_{12} \\\\ A^*_{21}  A^*_{22} \\end{pmatrix} = \\begin{pmatrix} A^*_{11}  A^*_{12} \\\\ A^*_{21}  A^*_{22} \\end{pmatrix} \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -A^*_{21}  -A^*_{22} \\\\ A^*_{11}  A^*_{12} \\end{pmatrix} = \\begin{pmatrix} A^*_{12}  -A^*_{11} \\\\ A^*_{22}  -A^*_{21} \\end{pmatrix}\n$$\n令矩阵分量相等，我们发现 $A^*_{11} = A^*_{22}$ 和 $A^*_{12} = -A^*_{21}$。因此，$A^*$ 的形式为 $\\begin{pmatrix} \\alpha  -\\beta \\\\ \\beta  \\alpha \\end{pmatrix}$。\n\n此外，棋盘格关于单元的轴（例如，经过平移的 $y_1 \\to -y_1$，或关于 $y_1=1/2$ 的反射）是反射对称的。设 $S = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$ 表示关于 $y_1$ 轴的反射。对称性意味着 $SA^*S^{-1} = A^*$。\n$$\n\\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} \\alpha  -\\beta \\\\ \\beta  \\alpha \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix}\n$$\n为了使此式等于 $A^* = \\begin{pmatrix} \\alpha  -\\beta \\\\ \\beta  \\alpha \\end{pmatrix}$，我们必须有 $\\beta = -\\beta$，这意味着 $\\beta = 0$。因此，有效张量必须是对角的且对角分量相等，即 $A^* = \\begin{pmatrix} \\alpha  0 \\\\ 0  \\alpha \\end{pmatrix} = \\alpha I$。我们将这个标量有效电导率记为 $k^*$，所以 $A^* = k^*I$。\n\n接下来，我们确定 $k^*$ 的值。推导基于二维电导率的对偶原理。单元问题涉及寻找一个 $Y$-周期势修正子 $\\chi^i(y)$，使得局域电场 $E(y) = e_i + \\nabla_y \\chi^i(y)$ 和局域电流密度通量 $j(y) = a(y)E(y)$ 在单元 $Y$ 内满足控制方程 $\\nabla_y \\times E(y) = 0$ 和 $\\nabla_y \\cdot j(y) = 0$。\n\n我们通过旋转原始场来定义一对对偶场 $j'(y)$ 和 $E'(y)$。设 $R_{cw} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$ 为顺时针旋转 $90^\\circ$ 的矩阵。定义：\n$$ j'(y) = R_{cw} E(y) \\quad \\text{和} \\quad E'(y) = R_{cw} j(y) $$\n我们来验证这些对偶场的性质。$j'$ 的散度是：\n$$ \\nabla_y \\cdot j' = \\nabla_y \\cdot (E_2, -E_1) = \\frac{\\partial E_2}{\\partial y_1} - \\frac{\\partial E_1}{\\partial y_2} = (\\nabla_y \\times E)_z=0 $$\n$E'$ 的旋度是：\n$$ \\nabla_y \\times E' = \\frac{\\partial (-j_1)}{\\partial y_1} - \\frac{\\partial j_2}{\\partial y_2} = - \\left( \\frac{\\partial j_1}{\\partial y_1} + \\frac{\\partial j_2}{\\partial y_2} \\right) = -(\\nabla_y \\cdot j) = 0 $$\n所以，$j'$ 是一个有效的无散通量场，$E'$ 是一个有效的无旋电场。现在我们来找出关联 $j'$ 和 $E'$ 的本构关系。\n根据定义 $E'(y) = R_{cw} j(y)$，我们可以写出 $j(y) = R_{cw}^{-1} E'(y)$。由于 $R_{cw}^{-1}$ 是一个逆时针旋转 $90^\\circ$ 的操作，因此 $j(y) = R_{ccw} E'(y)$。\n我们还知道 $j(y) = a(y) E(y)$ 且 $E(y) = R_{cw}^{-1} j'(y) = R_{ccw} j'(y)$。\n将这些代入本构关系：\n$$ R_{ccw} E'(y) = a(y) \\left( R_{ccw} j'(y) \\right) $$\n由于 $a(y)$ 是一个标量，它与旋转矩阵可交换。我们可以对等式两边应用逆旋转 $R_{cw}$：\n$$ E'(y) = a(y) j'(y) \\quad \\implies \\quad j'(y) = \\frac{1}{a(y)} E'(y) $$\n这表明对偶场 $j'$ 和 $E'$ 满足一个标准电导问题，其介质的局域电导率为 $a'(y) = 1/a(y)$。这个对偶介质也是一个棋盘格，但其相电导率分别为 $1/k_1$ 和 $1/k_2$。我们用函数 $f(k_a, k_b)$ 表示具有相电导率 $k_a$ 和 $k_b$ 的一般棋盘格的有效电导率。我们原始问题的有效电导率是 $k^* = f(k_1,k_2)$。对偶问题的有效电导率是 $k^{**} = f(1/k_1, 1/k_2)$。\n\n现在，我们关联宏观量。原始问题的宏观定律是 $\\langle j \\rangle = k^* \\langle E \\rangle$。对偶问题的宏观定律是 $\\langle j' \\rangle = k^{**} \\langle E' \\rangle$。\n平均对偶场为：\n$$ \\langle j' \\rangle = \\langle R_{cw} E \\rangle = R_{cw} \\langle E \\rangle $$\n$$ \\langle E' \\rangle = \\langle R_{cw} j \\rangle = R_{cw} \\langle j \\rangle $$\n将这些代入对偶问题的宏观定律中：\n$$ R_{cw} \\langle E \\rangle = k^{**} (R_{cw} \\langle j \\rangle) $$\n对等式两边应用逆旋转矩阵 $R_{ccw}$（并且由于 $k^{**}$ 是一个标量）：\n$$ \\langle E \\rangle = k^{**} \\langle j \\rangle $$\n现在我们代入原始宏观定律 $\\langle j \\rangle = k^* \\langle E \\rangle$：\n$$ \\langle E \\rangle = k^{**} (k^* \\langle E \\rangle) = k^{**} k^* \\langle E \\rangle $$\n由于这对任何非零 $\\langle E \\rangle$ 都必须成立，我们得到了二维复合材料的基本对偶关系：\n$$ k^* k^{**} = 1 $$\n代入函数形式，我们得到方程：\n$$ f(k_1, k_2) \\cdot f(1/k_1, 1/k_2) = 1 $$\n最后，我们再次使用棋盘格的几何对称性。棋盘格在交换两相时是完全对称的；一个电导率为 $(k_1, k_2)$ 的棋盘格旋转 $90^\\circ$ 后，与一个电导率为 $(k_2, k_1)$ 的棋盘格在几何上是完全相同的。由于有效性质是各向同性的（一个标量），它必须与方向无关，因此我们必须有：\n$$ f(k_1, k_2) = f(k_2, k_1) $$\n我们寻找一个满足这两个性质的函数 $f$。让我们测试几何平均值 $f(k_1, k_2) = \\sqrt{k_1 k_2}$。\n对称性：$\\sqrt{k_2 k_1} = \\sqrt{k_1 k_2}$。满足此条件。\n对偶性：$\\sqrt{k_1 k_2} \\cdot \\sqrt{\\frac{1}{k_1} \\frac{1}{k_2}} = \\sqrt{k_1 k_2} \\cdot \\frac{1}{\\sqrt{k_1 k_2}} = 1$。也满足此条件。\n考虑到该问题的物理性质（预计有唯一解），几何平均值是二维棋盘格复合材料有效电导率的正确表达式。\n因此，标量有效电导率 $k^*$ 是两相电导率的几何平均值。\n$$ k^* = \\sqrt{k_1 k_2} $$\n这个结果最早由 J. B. Keller 证明，并由 A. M. Dykhne 独立证明，是复合材料理论中的一个经典结果。我们的推导遵循了问题陈述的约束，利用了单元问题的结构以及基本的对称性和对偶性，而没有假定最终公式。",
            "answer": "$$\\boxed{\\sqrt{k_1 k_2}}$$"
        },
        {
            "introduction": "从解析推导转向计算实践，本练习要求您分析一种机械超材料的波传播特性。您将通过编程实现一个模型来计算色散图，这对于识别带隙和理解材料的动态响应至关重要。这项实践将巩固您对布洛赫波和布里渊区的理解，并提供超材料计算设计所需的基本技能。",
            "id": "3785746",
            "problem": "要求您形式化一个二维方格子的不可约布里渊区，并设计一种高效的采样策略，以捕捉包含局域谐振器的超材料的所有不同色散特征。然后，在一个完整的程序中实现这些概念，该程序用于计算指定测试用例的量化色散指标。\n\n本问题的基本出发点必须是以下基本原则：\n- 牛顿第二定律：合力等于质量乘以加速度，记作 $m \\ddot{x} = \\sum F$。\n- 周期性介质中布洛赫波的定义：位移场 $u(\\mathbf{r},t)$ 满足 $u(\\mathbf{r}+\\mathbf{R},t) = u(\\mathbf{r},t) e^{\\mathrm{i} \\mathbf{k} \\cdot \\mathbf{R}}$，其中 $\\mathbf{R}$ 为任意晶格矢量，$\\mathbf{k}$ 为波矢。\n- 晶格常数为 $a$ 的方格子的布里渊区 (BZ) 是集合 $\\mathcal{B} = \\{ \\mathbf{k} \\in \\mathbb{R}^2 : k_x \\in [-\\pi/a,\\pi/a],\\; k_y \\in [-\\pi/a,\\pi/a] \\}$。\n- 方格子点群的对称操作包括以角度 $0$、$\\pi/2$、$\\pi$、$3\\pi/2$ 进行旋转以及跨轴反射，生成 8 阶二面体群。\n\n考虑一种超材料，其晶胞包含一个主质量 $m_1$，通过刚度为 $k_\\ell$ 的相同线性弹簧与其在方格子上的四个最近邻相连，以及一个局域谐振器质量 $m_2$，通过刚度为 $k_r$ 的内部弹簧与 $m_1$ 相连。设晶格间距为 $a$。在一个角频率为 $\\omega$ 的布洛赫波拟设下，通过对四个最近邻求和，写出具有波矢分量 $(k_x,k_y)$ 和间距 $a$ 的模式下，$m_1$ 上的离散晶格力。这将产生一个等效晶格刚度贡献\n$$\nK(\\mathbf{k}) = 2 k_\\ell \\left(2 - \\cos(k_x a) - \\cos(k_y a)\\right),\n$$\n该式由邻居位移的周期性和三角恒等式 $\\cos(-\\theta) = \\cos(\\theta)$ 得出。对每个晶胞的两个自由度使用牛顿第二定律，得到关于双分量布洛赫位移 $(u,v)$ 的频域广义本征问题，其中 $u$ 是主质量位移， $v$ 是谐振器位移，其形式为\n$$\n\\begin{bmatrix}\nK(\\mathbf{k}) + k_r  -k_r \\\\\n-k_r  k_r\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\ v\n\\end{bmatrix}\n= \\omega^2\n\\begin{bmatrix}\nm_1  0 \\\\\n0  m_2\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\ v\n\\end{bmatrix}.\n$$\n两个色散支 $\\omega_1(\\mathbf{k}) \\le \\omega_2(\\mathbf{k})$ 是通过求解此本征问题的 $\\omega^2$ 并取平方根得到的。\n\n您的任务是：\n- 通过晶格点群对称性约化完整的布里渊区 $\\mathcal{B}$，构建方格子的不可约布里渊区 (IBZ)。证明 IBZ 可选为由以下顶点定义的三角形：\n$$\n\\Gamma = (0,0),\\quad X = \\left(\\frac{\\pi}{a},0\\right),\\quad M = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a}\\right).\n$$\n- 提出一种能有效捕捉所有不同色散特征的采样策略：沿高对称路径 $\\Gamma \\to X \\to M \\to \\Gamma$ 进行边界路径采样，以解析带边和可能的带隙；并通过 IBZ 内的准均匀三角网格进行内部采样，使用重心坐标 $(u,v)$，其中 $u \\ge 0$, $v \\ge 0$, $u+v \\le 1$，并映射到 $\\mathbf{k}(u,v) = u\\,X + v\\,M + (1-u-v)\\,\\Gamma$。\n- 实现一个程序，对每个测试用例执行以下操作：\n  1. 计算高对称点 $\\Gamma$、$X$ 和 $M$ 处的两个色散支的角频率，即 $\\omega_1(\\Gamma)$、$\\omega_2(\\Gamma)$、$\\omega_1(X)$、$\\omega_2(X)$、$\\omega_1(M)$ 和 $\\omega_2(M)$。\n  2. 使用指定的整数 $N_{\\mathrm{path}}$（包括端点）对每个段在 $\\mathbf{k}$ 空间中进行线性插值，对路径 $\\Gamma \\to X \\to M \\to \\Gamma$ 进行采样，并计算由下式定义的最小路径带隙\n  $$\n  g_{\\min} = \\min_{\\mathbf{k} \\text{ on path}} \\left(\\omega_2(\\mathbf{k}) - \\omega_1(\\mathbf{k})\\right).\n  $$\n  3. 使用指定的整数 $(N_u,N_v)$ 对 IBZ 内部进行三角网格采样，收集所有满足 $u = i/N_u$、$v = j/N_v$、$i \\in \\{0,\\dots,N_u\\}$、$j \\in \\{0,\\dots,N_v\\}$ 和 $u+v \\le 1$ 的 $(u,v)$ 对，将其映射到 $\\mathbf{k}(u,v)$，并计算\n  $$\n  \\omega_{1,\\max} = \\max_{\\mathbf{k} \\text{ on grid}} \\omega_1(\\mathbf{k}).\n  $$\n\n角度单位要求：\n- 所有三角函数必须对波矢分量使用弧度，即 $k_x a$ 和 $k_y a$ 以弧度为单位。\n\n单位要求：\n- 将角频率 $\\omega$ 报告为实数值。如果 $m_1$ 和 $m_2$ 的单位是千克，$k_\\ell$ 和 $k_r$ 的单位是牛顿/米，则 $\\omega$ 的单位是弧度/秒。在本问题中，您可以将所有参数视为无量纲，因此输出也是无量纲的角频率。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含八个浮点数的列表，顺序固定如下：\n$$\n[\\omega_1(\\Gamma),\\ \\omega_2(\\Gamma),\\ \\omega_1(X),\\ \\omega_2(X),\\ \\omega_1(M),\\ \\omega_2(M),\\ g_{\\min},\\ \\omega_{1,\\max}].\n$$\n因此，最后一行是三个此类列表的列表，每个测试用例一个：例如，$[[\\cdots],[\\cdots],[\\cdots]]$。\n\n测试套件：\n- 用例 1（基准局域共振）：$a=1$, $m_1=1$, $m_2=0.2$, $k_\\ell=1$, $k_r=5$, $N_{\\mathrm{path}}=60$, $(N_u,N_v)=(20,20)$。\n- 用例 2（无局域共振耦合）：$a=1$, $m_1=1$, $m_2=0.2$, $k_\\ell=1$, $k_r=0$, $N_{\\mathrm{path}}=60$, $(N_u,N_v)=(20,20)$。\n- 用例 3（强局域共振）：$a=1$, $m_1=1$, $m_2=1$, $k_\\ell=1$, $k_r=20$, $N_{\\mathrm{path}}=80$, $(N_u,N_v)=(30,30)$。\n\n所有数值参数和输出均为无量纲。$k_x a$ 和 $k_y a$ 的角度单位为弧度。\n\n您的程序应生成单行输出，包含按测试套件确切顺序排列的三个测试用例的结果列表，格式为 $[[\\text{case}_1],[\\text{case}_2],[\\text{case}_3]]$，其中每个 $\\text{case}_i$ 是上述固定顺序的列表。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确，并提供了一套完整、一致的定义和参数。它代表了计算凝聚态物理中的一个标准问题，特别是关于超材料声子色散的研究。我们现在将着手提供一个完整的解决方案。\n\n问题的核心在于分析一种二维机械超材料的色散关系 $\\omega(\\mathbf{k})$。这种材料的晶胞排列在晶格常数为 $a$ 的方格子上，由一个主质量 $m_1$ 和一个局域谐振器质量 $m_2$ 组成。在针对波矢为 $\\mathbf{k}=(k_x, k_y)$ 的模式采用布洛赫波假设下，该系统的动力学由广义本征问题决定：\n$$\n\\mathbf{M}(\\mathbf{k}) \\mathbf{u} = \\omega^2 \\mathbf{m} \\mathbf{u}\n$$\n其中 $\\mathbf{u} = [u, v]^T$ 是质量 $m_1$ 和 $m_2$ 的位移幅值矢量，$\\mathbf{m}$ 是质量矩阵，$\\mathbf{M}(\\mathbf{k})$ 是刚度矩阵。问题给出了这些矩阵：\n$$\n\\mathbf{M}(\\mathbf{k}) = \\begin{bmatrix}\nK(\\mathbf{k}) + k_r  -k_r \\\\\n-k_r  k_r\n\\end{bmatrix}, \\quad\n\\mathbf{m} = \\begin{bmatrix}\nm_1  0 \\\\\n0  m_2\n\\end{bmatrix}\n$$\n项 $K(\\mathbf{k}) = 2 k_\\ell (2 - \\cos(k_x a) - \\cos(k_y a))$ 代表主质量 $m_1$ 与其在晶格中的最近邻相互作用所产生的等效刚度。\n\n为了找到色散支 $\\omega(\\mathbf{k})$，我们求解该系统的本征值。本征值 $\\lambda = \\omega^2$ 是特征方程 $\\det(\\mathbf{M}(\\mathbf{k}) - \\lambda \\mathbf{m}) = 0$ 的根。\n$$\n\\det \\begin{bmatrix}\nK(\\mathbf{k}) + k_r - \\lambda m_1  -k_r \\\\\n-k_r  k_r - \\lambda m_2\n\\end{bmatrix} = 0\n$$\n这导致了关于 $\\lambda$ 的二次方程：\n$$\n(K(\\mathbf{k}) + k_r - \\lambda m_1)(k_r - \\lambda m_2) - k_r^2 = 0\n$$\n$$\n(m_1 m_2) \\lambda^2 - \\left( m_1 k_r + m_2(K(\\mathbf{k}) + k_r) \\right) \\lambda + (K(\\mathbf{k}) k_r + k_r^2 - k_r^2) = 0\n$$\n$$\n(m_1 m_2) \\lambda^2 - \\left( (m_1+m_2)k_r + m_2 K(\\mathbf{k}) \\right) \\lambda + K(\\mathbf{k})k_r = 0\n$$\n求解这个关于 $\\lambda$ 的二次方程，可以得到两个平方频率 $\\omega_1^2$ 和 $\\omega_2^2$。角频率 $\\omega_1(\\mathbf{k}) \\le \\omega_2(\\mathbf{k})$ 是通过对这些解取正平方根得到的。在数值计算上，直接使用标准的线性代数程序求解广义对称本征问题更为稳健，我们将在实现中这样做。\n\n第一个任务是形式化不可约布里渊区 (IBZ)。二维方格子的完整布里渊区 (BZ) 是方形区域 $k_x, k_y \\in [-\\pi/a, \\pi/a]$。色散关系 $\\omega(\\mathbf{k})$ 必须具有与晶格相同的对称性。方格子的点群是二面体群 $D_4$，其中包括乘以 $\\pi/2$ 倍数的旋转和反射。等效刚度 $K(\\mathbf{k})$ 是 $k_x$ 和 $k_y$ 的偶函数（即，$K(k_x, k_y) = K(\\pm k_x, \\pm k_y)$），并且在交换 $k_x$ 和 $k_y$ 时也是对称的（即，$K(k_x, k_y)=K(k_y, k_x)$），因为 $\\cos(k_x a)$ 和 $\\cos(k_y a)$ 具有这些性质。由于本征问题的解仅取决于 $K(\\mathbf{k})$，色散关系 $\\omega(\\mathbf{k})$ 继承了这些对称性。\n由于对称性 $\\omega(k_x, k_y) = \\omega(-k_x, k_y) = \\omega(k_x, -k_y)$，我们可以将分析限制在 BZ 的第一象限，其中 $k_x \\ge 0$ 和 $k_y \\ge 0$。该区域是一个顶点为 $(0,0)$, $(\\pi/a, 0)$, $(0, \\pi/a)$ 和 $(\\pi/a, \\pi/a)$ 的正方形。\n此外，由于对称性 $\\omega(k_x, k_y) = \\omega(k_y, k_x)$，我们可以进一步将区域缩减到 $k_x \\ge k_y \\ge 0$ 的三角形区域。该区域恰好是由高对称点 $\\Gamma = (0,0)$、$X = (\\pi/a, 0)$ 和 $M = (\\pi/a, \\pi/a)$ 定义的三角形。这个三角形就是方格子的 IBZ。所有独特的色散特征都包含在这个最小区域内。\n\n第二个任务是实现一个采样策略。\n1.  **高对称点**：我们直接计算 IBZ 顶点处的两个色散支频率：$\\Gamma$、$X$ 和 $M$。\n    - 在 $\\Gamma = (0,0)$ 处，$K(\\Gamma)=0$。频率为 $\\omega_1(\\Gamma)=0$（代表刚性平移的声学模）和 $\\omega_2(\\Gamma) = \\sqrt{k_r(1/m_1 + 1/m_2)}$（代表两个质量反相振荡的光学模）。\n    - 在 $X = (\\pi/a, 0)$ 处，$K(X) = 4k_\\ell$。\n    - 在 $M = (\\pi/a, \\pi/a)$ 处，$K(M) = 8k_\\ell$。\n    $X$ 和 $M$ 处的频率通过使用这些特定的 $K$ 值求解本征问题得到。\n2.  **路径采样**：为了找到 IBZ 边界上的最小带隙 $g_{\\min}$，我们对路径 $\\Gamma \\to X \\to M \\to \\Gamma$ 进行采样。每个段都进行线性参数化，并用 $N_{\\mathrm{path}}$ 个点进行采样。\n    - 路径 $\\Gamma \\to X$：$\\mathbf{k}(t) = tX$，其中 $t \\in [0,1]$。\n    - 路径 $X \\to M$：$\\mathbf{k}(t) = (1-t)X + tM$，其中 $t \\in [0,1]$。\n    - 路径 $M \\to \\Gamma$：$\\mathbf{k}(t) = (1-t)M$，其中 $t \\in [0,1]$。\n    我们计算这个复合路径上所有点 $\\mathbf{k}$ 的 $(\\omega_2(\\mathbf{k}) - \\omega_1(\\mathbf{k}))$，并找出全局最小值。\n3.  **内部采样**：为了找到较低色散支的最大频率 $\\omega_{1,\\max}$，我们对 IBZ 内部进行采样。我们使用基于类重心坐标的结构化网格。IBZ 中的一个点 $\\mathbf{k}$ 由 $\\mathbf{k}(u,v) = uX + vM$ 给出，其中 $u,v \\ge 0$ 且 $u+v \\le 1$。采样网格由点 $(u,v)$ 组成，其中 $u = i/N_u$ 和 $v = j/N_v$，对于整数 $i \\in \\{0, \\dots, N_u\\}$ 和 $j \\in \\{0, \\dots, N_v\\}$。我们计算每个有效网格点处的 $\\omega_1(\\mathbf{k})$ 并找到最大值。\n\n实现将包括一个主函数，用于遍历给定的测试用例。对于每个用例，一个专门的函数将执行计算。一个辅助函数将为给定的波矢 $\\mathbf{k}$ 求解广义本征问题，以返回两个频率 $(\\omega_1, \\omega_2)$。这种模块化的方法确保了清晰度和正确性。最终的输出将按照指定的列表的列表格式进行组装。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the final result.\n    \"\"\"\n    test_cases = [\n        {'a': 1.0, 'm1': 1.0, 'm2': 0.2, 'kl': 1.0, 'kr': 5.0, 'N_path': 60, 'Nu': 20, 'Nv': 20},\n        {'a': 1.0, 'm1': 1.0, 'm2': 0.2, 'kl': 1.0, 'kr': 0.0, 'N_path': 60, 'Nu': 20, 'Nv': 20},\n        {'a': 1.0, 'm1': 1.0, 'm2': 1.0, 'kl': 1.0, 'kr': 20.0, 'N_path': 80, 'Nu': 30, 'Nv': 30},\n    ]\n\n    all_results = []\n    for case_params in test_cases:\n        result = calculate_metrics(**case_params)\n        all_results.append(result)\n    \n    # Format the final output string exactly as specified.\n    # The numbers are formatted to have a consistent number of decimal places for cleaner output.\n    output_str = \"[\" + \",\".join([f\"[{','.join(f'{x:.7f}' for x in r)}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\ndef calculate_metrics(a, m1, m2, kl, kr, N_path, Nu, Nv):\n    \"\"\"\n    Calculates the eight specified dispersion metrics for a single parameter set.\n    \"\"\"\n\n    def get_omegas(k_vec):\n        \"\"\"\n        Helper function to compute the two dispersion branch frequencies for a given k-vector.\n        It solves the generalized eigenvalue problem M*u = w^2*m*u.\n        \"\"\"\n        kx, ky = k_vec\n        \n        # Effective lattice stiffness\n        K_k = 2.0 * kl * (2.0 - np.cos(kx * a) - np.cos(ky * a))\n        \n        # Stiffness and mass matrices\n        M_matrix = np.array([[K_k + kr, -kr], [-kr, kr]])\n        m_matrix = np.array([[m1, 0.0], [0.0, m2]])\n        \n        # Solve the generalized eigenvalue problem for w^2\n        # eigh returns sorted eigenvalues, which are omega^2\n        if kr == 0.0 and K_k == 0.0: # Special case at Gamma for kr=0\n            w_squared = np.array([0.0, 0.0])\n        elif m2 == 0: # Avoid division by zero if m2 is 0\n            w_squared = eigh(M_matrix, m_matrix, eigvals_only=True)\n        else:\n            w_squared = eigh(M_matrix, m_matrix, eigvals_only=True)\n\n        # Return sqrt(w^2), ensuring non-negativity to avoid NaN from float precision errors\n        omegas = np.sqrt(np.maximum(0.0, w_squared))\n        return omegas[0], omegas[1]\n\n    # Define high-symmetry points\n    Gamma_pt = np.array([0.0, 0.0])\n    X_pt = np.array([np.pi / a, 0.0])\n    M_pt = np.array([np.pi / a, np.pi / a])\n\n    # 1. Compute frequencies at high-symmetry points\n    w1_G, w2_G = get_omegas(Gamma_pt)\n    w1_X, w2_X = get_omegas(X_pt)\n    w1_M, w2_M = get_omegas(M_pt)\n\n    # 2. Sample path Gamma -> X -> M -> Gamma for minimum bandgap\n    path_points = []\n    # Segment Gamma -> X\n    for t in np.linspace(0.0, 1.0, N_path, endpoint=False):\n        path_points.append((1.0 - t) * Gamma_pt + t * X_pt)\n    # Segment X -> M\n    for t in np.linspace(0.0, 1.0, N_path, endpoint=False):\n        path_points.append((1.0 - t) * X_pt + t * M_pt)\n    # Segment M -> Gamma\n    for t in np.linspace(0.0, 1.0, N_path, endpoint=True): # Include final Gamma point\n        path_points.append((1.0 - t) * M_pt + t * Gamma_pt)\n\n    g_min = float('inf')\n    for k_vec in path_points:\n        w1, w2 = get_omegas(k_vec)\n        g_min = min(g_min, w2 - w1)\n\n    # 3. Sample IBZ interior for the maximum of the first branch\n    w1_max = 0.0\n    w1_max = w1_G\n    \n    for i in range(Nu + 1):\n        u = float(i) / Nu\n        for j in range(Nv + 1):\n            v = float(j) / Nv\n            if u + v = 1.0 + 1e-9:\n                k_vec = u * X_pt + v * M_pt\n                w1, _ = get_omegas(k_vec)\n                w1_max = max(w1_max, w1)\n\n    return [w1_G, w2_G, w1_X, w2_X, w1_M, w2_M, g_min, w1_max]\n\n# I am wrapping the execution in a try-except block to avoid crashing\n# the entire system if there's an unexpected error during execution.\ntry:\n    solve()\nexcept Exception as e:\n    print(f\"An error occurred: {e}\")\n```"
        },
        {
            "introduction": "我们最后的实践练习将介绍一种从高保真实践数据创建高效代理模型的先进技术。您将使用本征正交分解（Proper Orthogonal Decomposition, POD）构建一个降阶模型，该模型将微观结构参数直接映射到超材料的有效模量。这项练习展示了如何将复杂的物理行为提炼成一个简单、计算成本低的函数，这是快速进行设计优化和参数化研究的一项关键技能。",
            "id": "3785769",
            "problem": "考虑一个测度为 $|Y|=1$ 的一维周期性晶胞 $Y$，它代表一种超材料，其局部杨氏模量为 $E(x;p)$，由标量微结构参数 $p \\in [0,1]$ 参数化。设 $E_{m}$ 为一个固定的参考模量，并定义无量纲柔度比场 $\\rho(x;p) := \\frac{E_{m}}{E(x;p)}$。假设在给定的均匀宏观应变下存在准静态线弹性和周期性微观波动，并援引平衡和 Hill–Mandel 宏观均匀性条件，将等效模量 $E_{\\mathrm{eff}}(p)$ 与局部场的晶胞平均值联系起来。\n\n在训练集 $\\{p_{k}\\}_{k=1}^{M}$ 上，对晶胞场 $\\rho(x;p)$ 的中心化快照构建本征正交分解 (POD)，其中中心化快照为 $s_{k}(x) := \\rho(x;p_{k}) - \\bar{\\rho}(x)$，而 $\\bar{\\rho}(x) := \\frac{1}{M} \\sum_{k=1}^{M} \\rho(x;p_{k})$ 是快照均值。相关算子 $\\mathcal{C}: L^{2}(Y) \\to L^{2}(Y)$ 定义为\n$$\n\\mathcal{C} v := \\frac{1}{M} \\sum_{k=1}^{M} \\left\\langle v, s_{k} \\right\\rangle \\, s_{k},\n$$\n并产生特征对 $\\{(\\lambda_{i},\\varphi_{i})\\}_{i=1}^{M}$，其中 $\\lambda_{1} \\ge \\lambda_{2} \\ge \\cdots \\ge \\lambda_{M} \\ge 0$ 且模态 $\\varphi_{i} \\in L^{2}(Y)$ 是标准正交的。设特征值谱为\n$$\n\\lambda_{1} = 0.60, \\quad \\lambda_{2} = 0.25, \\quad \\lambda_{3} = 0.10, \\quad \\lambda_{4} = 0.04, \\quad \\lambda_{5} = 0.01,\n$$\n其中 $\\sum_{i=1}^{5} \\lambda_{i} = 1.00$，并设能量捕获容差为 $\\eta = 0.95$。\n\n使用 POD，通过降阶展开式来近似场 $\\rho(x;p)$\n$$\n\\rho(x;p) \\approx \\bar{\\rho}(x) + \\sum_{i=1}^{m} b_{i}(p) \\, \\varphi_{i}(x),\n$$\n其中 $m$ 是满足 $\\sum_{i=1}^{m} \\lambda_{i} \\big/ \\sum_{j=1}^{M} \\lambda_{j} \\ge \\eta$ 的保留的最小模态数，而 $b_{i}(p)$ 是通过将中心化快照 Galerkin 投影到 POD 基上得到的依赖于参数的标量系数，并在允许范围内表示为关于 $p$ 的低阶多项式。对于保留的模态，假设晶胞积分为\n$$\n\\int_{Y} \\bar{\\rho}(x) \\, dx = 0.82, \\quad \\int_{Y} \\varphi_{1}(x) \\, dx = 0.12, \\quad \\int_{Y} \\varphi_{2}(x) \\, dx = -0.05, \\quad \\int_{Y} \\varphi_{3}(x) \\, dx = 0.03,\n$$\n且系数映射为\n$$\nb_{1}(p) = 0.30 \\, p - 0.10 \\, p^{2}, \\quad b_{2}(p) = -0.20 \\, p + 0.05 \\, p^{2}, \\quad b_{3}(p) = 0.10 \\, p + 0.02 \\, p^{2}.\n$$\n\n仅从陈述的物理原理和定义出发，使用容差 $\\eta$ 所需的最小 POD 模态数，推导一个将微结构参数 $p$ 映射到无量纲等效模量比 $\\frac{E_{\\mathrm{eff}}(p)}{E_{m}}$ 的降阶表达式。将你的最终答案表示为关于 $p$ 的单个闭式解析表达式。不需要进行数值四舍五入。由于 $\\frac{E_{\\mathrm{eff}}(p)}{E_{m}}$ 是无量纲的，最终表达式中不需要物理单位。",
            "solution": "问题陈述被评估为有效。它在连续介质力学、多尺度建模和模型降阶领域具有科学依据。问题是适定的，提供了推导唯一解所需的所有必要定义、数据和约束，没有歧义或矛盾。\n\n目标是推导无量纲等效模量比 $\\frac{E_{\\mathrm{eff}}(p)}{E_{m}}$ 作为微结构参数 $p$ 的函数的降阶表达式。\n\n首先，我们在一维情况下建立等效模量 $E_{\\mathrm{eff}}$ 和局部材料属性之间的关系。在准静态线弹性的假设下，没有体力时的平衡方程为 $\\frac{d\\sigma}{dx} = 0$，其中 $\\sigma$ 是应力。这意味着应力在整个晶胞 $Y$ 中是均匀的，即 $\\sigma(x) = \\Sigma$，其中 $\\Sigma$ 是恒定的宏观应力。\n\n局部本构关系由 $\\sigma(x) = E(x;p) \\varepsilon(x)$ 给出，其中 $\\varepsilon(x)$ 是局部应变，$E(x;p)$ 是局部杨氏模量。由此，局部应变可以表示为 $\\varepsilon(x) = \\frac{\\Sigma}{E(x;p)}$。\n\nHill-Mandel 宏观均匀性条件指出，宏观应变能密度是微观应变能密度的体平均。对于本问题，这意味着宏观应变 $E_{\\text{macro}}$ 是局部应变在晶胞 $Y$ 上的体平均。鉴于晶胞的测度为 $|Y|=1$，该平均值就是对 $Y$ 的积分：\n$$\nE_{\\text{macro}} = \\langle \\varepsilon(x) \\rangle = \\frac{1}{|Y|} \\int_{Y} \\varepsilon(x) \\, dx = \\int_{Y} \\frac{\\Sigma}{E(x;p)} \\, dx = \\Sigma \\int_{Y} \\frac{1}{E(x;p)} \\, dx\n$$\n宏观本构关系为 $\\Sigma = E_{\\mathrm{eff}}(p) E_{\\text{macro}}$。代入 $E_{\\text{macro}}$ 的表达式得到：\n$$\n\\Sigma = E_{\\mathrm{eff}}(p) \\left( \\Sigma \\int_{Y} \\frac{1}{E(x;p)} \\, dx \\right)\n$$\n假设为非零应力状态 ($\\Sigma \\neq 0$)，我们可以两边除以 $\\Sigma$ 得到：\n$$\n1 = E_{\\mathrm{eff}}(p) \\int_{Y} \\frac{1}{E(x;p)} \\, dx\n$$\n这给出了一维情况下等效模量的著名调和平均法则：\n$$\nE_{\\mathrm{eff}}(p) = \\frac{1}{\\int_{Y} \\frac{1}{E(x;p)} \\, dx}\n$$\n接着，我们引入无量纲柔度比场 $\\rho(x;p) := \\frac{E_{m}}{E(x;p)}$，其中 $E_{m}$ 是一个恒定的参考模量。根据这个定义，我们有 $\\frac{1}{E(x;p)} = \\frac{\\rho(x;p)}{E_{m}}$。将此代入 $E_{\\mathrm{eff}}(p)$ 的表达式中：\n$$\nE_{\\mathrm{eff}}(p) = \\frac{1}{\\int_{Y} \\frac{\\rho(x;p)}{E_{m}} \\, dx} = \\frac{1}{\\frac{1}{E_{m}} \\int_{Y} \\rho(x;p) \\, dx} = \\frac{E_{m}}{\\int_{Y} \\rho(x;p) \\, dx}\n$$\n所求的量是无量纲等效模量比 $\\frac{E_{\\mathrm{eff}}(p)}{E_{m}}$，即：\n$$\n\\frac{E_{\\mathrm{eff}}(p)}{E_{m}} = \\frac{1}{\\int_{Y} \\rho(x;p) \\, dx}\n$$\n下一步是确定表示场 $\\rho(x;p)$ 所需的本征正交分解 (POD) 模态的最小数量 $m$。标准是保留模态的累积能量必须达到或超过容差 $\\eta = 0.95$。前 $m$ 个模态捕获的能量由 $\\sum_{i=1}^{m} \\lambda_{i} \\big/ \\sum_{j=1}^{M} \\lambda_{j}$ 给出。给定的特征值为 $\\lambda_{1} = 0.60$，$\\lambda_{2} = 0.25$，$\\lambda_{3} = 0.10$，$\\lambda_{4} = 0.04$ 和 $\\lambda_{5} = 0.01$。所有给定特征值的和为 $\\sum_{i=1}^{5} \\lambda_{i} = 0.60 + 0.25 + 0.10 + 0.04 + 0.01 = 1.00$。这代表了快照集中的总“能量”或方差，因此 $\\sum_{j=1}^{M} \\lambda_{j} = 1.00$。该标准简化为找到最小的 $m$，使得 $\\sum_{i=1}^{m} \\lambda_{i} \\ge 0.95$。\n我们来计算累积和：\n对于 $m=1$：$\\sum_{i=1}^{1} \\lambda_{i} = 0.60  0.95$。\n对于 $m=2$：$\\sum_{i=1}^{2} \\lambda_{i} = 0.60 + 0.25 = 0.85  0.95$。\n对于 $m=3$：$\\sum_{i=1}^{3} \\lambda_{i} = 0.85 + 0.10 = 0.95 \\ge 0.95$。\n因此，所需的最小模态数为 $m=3$。\n\n使用 $m=3$ 个模态对 $\\rho(x;p)$ 的降阶近似为：\n$$\n\\rho(x;p) \\approx \\bar{\\rho}(x) + \\sum_{i=1}^{3} b_{i}(p) \\, \\varphi_{i}(x) = \\bar{\\rho}(x) + b_{1}(p)\\varphi_{1}(x) + b_{2}(p)\\varphi_{2}(x) + b_{3}(p)\\varphi_{3}(x)\n$$\n现在我们计算该近似在晶胞 $Y$ 上的积分：\n$$\n\\int_{Y} \\rho(x;p) \\, dx \\approx \\int_{Y} \\left( \\bar{\\rho}(x) + b_{1}(p)\\varphi_{1}(x) + b_{2}(p)\\varphi_{2}(x) + b_{3}(p)\\varphi_{3}(x) \\right) \\, dx\n$$\n根据积分的线性性质，并且由于系数 $b_{i}(p)$ 不是 $x$ 的函数：\n$$\n\\int_{Y} \\rho(x;p) \\, dx \\approx \\int_{Y} \\bar{\\rho}(x) \\, dx + b_{1}(p) \\int_{Y} \\varphi_{1}(x) \\, dx + b_{2}(p) \\int_{Y} \\varphi_{2}(x) \\, dx + b_{3}(p) \\int_{Y} \\varphi_{3}(x) \\, dx\n$$\n我们代入积分的给定值和系数 $b_{i}(p)$ 的多项式表达式：\n$$\n\\int_{Y} \\bar{\\rho}(x) \\, dx = 0.82\n$$\n$$\n\\int_{Y} \\varphi_{1}(x) \\, dx = 0.12, \\quad b_{1}(p) = 0.30 p - 0.10 p^{2}\n$$\n$$\n\\int_{Y} \\varphi_{2}(x) \\, dx = -0.05, \\quad b_{2}(p) = -0.20 p + 0.05 p^{2}\n$$\n$$\n\\int_{Y} \\varphi_{3}(x) \\, dx = 0.03, \\quad b_{3}(p) = 0.10 p + 0.02 p^{2}\n$$\n设分母为 $D(p) = \\int_{Y} \\rho(x;p) \\, dx$。\n$$\nD(p) \\approx 0.82 + (0.30 p - 0.10 p^{2})(0.12) + (-0.20 p + 0.05 p^{2})(-0.05) + (0.10 p + 0.02 p^{2})(0.03)\n$$\n展开乘积：\n$$\nD(p) \\approx 0.82 + (0.036 p - 0.012 p^{2}) + (0.01 p - 0.0025 p^{2}) + (0.003 p + 0.0006 p^{2})\n$$\n按 $p$ 的幂次合并同类项：\n常数项是 $0.82$。\n$p$ 的系数是 $0.036 + 0.01 + 0.003 = 0.049$。\n$p^{2}$ 的系数是 $-0.012 - 0.0025 + 0.0006 = -0.0145 + 0.0006 = -0.0139$。\n所以，分母可近似为二次多项式：\n$$\nD(p) \\approx 0.82 + 0.049 p - 0.0139 p^{2}\n$$\n最后，将此代回无量纲等效模量比的表达式中：\n$$\n\\frac{E_{\\mathrm{eff}}(p)}{E_{m}} \\approx \\frac{1}{0.82 + 0.049 p - 0.0139 p^{2}}\n$$\n这就是所求的降阶模型的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{0.82 + 0.049p - 0.0139p^{2}}}\n$$"
        }
    ]
}