{
    "hands_on_practices": [
        {
            "introduction": "能斯特-普朗克（Nernst-Planck）方程是描述离子输运的基石，它统一了由浓度梯度驱动的扩散和由电场驱动的漂移。通过从第一性原理出发推导高盛-霍奇金-卡茨（Goldman-Hodgkin-Katz, GHK）通量方程，你将深入理解这两种驱动力的相互作用。这项经典的分析实践为在简化但富有洞察力的条件下求解离子通量提供了坚实的基础 。",
            "id": "3771120",
            "problem": "考虑单一种类离子通过一个长度为 $L$ 的一维通道的输运，该通道连接着两个充分搅拌的蓄液池。位于 $z=0$ 处的左侧蓄液池浓度固定为 $c_{L}$，位于 $z=L$ 处的右侧蓄液池浓度固定为 $c_{R}$。温度为 $T$，离子价态为 $z$，元电荷为 $e$，扩散系数 $D$ 在空间上是常数。假设处于稳态，因此粒子通量 $J$ 与 $z$ 无关。通道内的静电势是预设的，并且仅由线性分布在通道上的外加电压降 $V$ 构成，即 $\\phi(z)=\\phi_{0}-V z/L$，其中 $\\phi_{0}$ 是一个恒定的偏移量。忽略空间电荷耦合，并将 $\\phi(z)$ 视为给定值。从一维 Nernst-Planck (NP) 方程和连接漂移迁移率与扩散的 Einstein 关系式出发，在边界条件 $c(0)=c_{L}$ 和 $c(L)=c_{R}$ 下，推导稳态浓度分布 $c(z)$ 和恒定通量 $J$。确定 $J$ 在扩散主导输运（小外加电压）和漂移主导输运（大外加电压）下的极限形式，并明确其对 $c_{L}$ 和 $c_{R}$ 的依赖关系。定义无量纲电压 $U = z e V/(k_{B} T)$，其中 $k_{B}$ 是玻尔兹曼常数。\n\n请提供稳态通量 $J$ 关于 $D$、$L$、$c_{L}$、$c_{R}$ 和 $U$ 的单一闭式解析表达式作为最终答案。无需进行数值计算。",
            "solution": "该问题被评估为科学上合理、适定且客观。它提出了一个物理化学和生物物理学中的标准可解问题。所有必要的参数和条件都已提供，不存在矛盾之处。\n\n这个问题的出发点是一维稳态 Nernst-Planck (NP) 方程，它描述了在浓度梯度和电场共同影响下离子种类的通量 $J$。在稳态下，通量 $J$ 被认为是恒定的。NP 方程为：\n$$J = -D \\frac{dc}{dz} + J_{\\text{drift}}$$\n其中 $D$ 是扩散系数，$c(z)$ 是位置 $z$ 处的离子浓度，$J_{\\text{drift}}$ 是由外力引起的漂移通量分量。漂移通量由 $J_{\\text{drift}} = c v_{\\text{drift}}$ 给出，其中漂移速度 $v_{\\text{drift}}$ 通过迁移率 $\\mu$ 与外施力 $F$ 相关，即 $v_{\\text{drift}} = \\mu F$。作用在离子上的力是其势能的负梯度，即 $F = -\\frac{d\\Phi_{tot}}{dz}$。因此，漂移通量为 $J_{\\text{drift}} = -c \\mu \\frac{d\\Phi_{tot}}{dz}$，完整的 NP 方程为：\n$$J = -D \\frac{dc}{dz} - c \\mu \\frac{d\\Phi_{tot}}{dz}$$\nEinstein 关系式通过 $\\mu = D/(k_B T)$ 将迁移率 $\\mu$ 和扩散系数 $D$ 联系起来，其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。将此代入 NP 方程可得：\n$$J = -D \\left( \\frac{dc}{dz} + \\frac{c}{k_B T} \\frac{d\\Phi_{tot}}{dz} \\right)$$\n一个价态（电荷数）为 $z$、元电荷为 $e$ 的离子在静电势 $\\phi(z)$ 中的势能为 $\\Phi_{tot}(z) = ze\\phi(z)$。问题规定了一个线性电势分布：\n$$\\phi(z) = \\phi_{0} - \\frac{Vz}{L}$$\n其中 $V$ 是施加在长度为 $L$ 的通道上的电压降。因此，势能的梯度为：\n$$\\frac{d\\Phi_{tot}}{dz} = \\frac{d}{dz} \\left( ze \\left(\\phi_{0} - \\frac{Vz}{L}\\right) \\right) = - \\frac{zeV}{L}$$\n将此代入 NP 方程可得：\n$$J = -D \\left( \\frac{dc}{dz} - \\frac{zeV}{k_B T L} c(z) \\right)$$\n使用无量纲电压的定义 $U = zeV/(k_B T)$，方程简化为：\n$$-\\frac{J}{D} = \\frac{dc}{dz} - \\frac{U}{L} c(z)$$\n这是一个关于浓度分布 $c(z)$ 的一阶线性常微分方程：\n$$\\frac{dc}{dz} - \\frac{U}{L} c(z) = -\\frac{J}{D}$$\n为了求解这个常微分方程，我们使用一个积分因子 $I(z)$，其表达式为：\n$$I(z) = \\exp \\left( \\int -\\frac{U}{L} dz \\right) = \\exp \\left(-\\frac{Uz}{L}\\right)$$\n将常微分方程两边乘以 $I(z)$：\n$$\\exp\\left(-\\frac{Uz}{L}\\right) \\frac{dc}{dz} - \\frac{U}{L} \\exp\\left(-\\frac{Uz}{L}\\right) c(z) = -\\frac{J}{D} \\exp\\left(-\\frac{Uz}{L}\\right)$$\n左边是一个乘积的导数：\n$$\\frac{d}{dz} \\left( c(z) \\exp\\left(-\\frac{Uz}{L}\\right) \\right) = -\\frac{J}{D} \\exp\\left(-\\frac{Uz}{L}\\right)$$\n我们在通道内从 $z=0$ 到任意位置 $z$ 对两边进行积分，假设 $U \\neq 0$：\n$$\\int_{0}^{z} \\frac{d}{d\\zeta} \\left( c(\\zeta) \\exp\\left(-\\frac{U\\zeta}{L}\\right) \\right) d\\zeta = \\int_{0}^{z} -\\frac{J}{D} \\exp\\left(-\\frac{U\\zeta}{L}\\right) d\\zeta$$\n$$c(z)\\exp\\left(-\\frac{Uz}{L}\\right) - c(0)\\exp(0) = -\\frac{J}{D} \\left[-\\frac{L}{U} \\exp\\left(-\\frac{U\\zeta}{L}\\right)\\right]_{0}^{z}$$\n应用边界条件 $c(0) = c_L$：\n$$c(z)\\exp\\left(-\\frac{Uz}{L}\\right) - c_L = \\frac{JL}{DU} \\left( \\exp\\left(-\\frac{Uz}{L}\\right) - 1 \\right)$$\n求解浓度分布 $c(z)$：\n$$c(z) = c_L \\exp\\left(\\frac{Uz}{L}\\right) + \\frac{JL}{DU} \\left( 1 - \\exp\\left(\\frac{Uz}{L}\\right) \\right)$$\n这就是通道内的稳态浓度分布 $c(z)$。\n\n为了求出恒定通量 $J$，我们应用第二个边界条件 $c(L) = c_R$：\n$$c_R = c_L \\exp\\left(\\frac{UL}{L}\\right) + \\frac{JL}{DU} \\left( 1 - \\exp\\left(\\frac{UL}{L}\\right) \\right)$$\n$$c_R = c_L \\exp(U) + \\frac{JL}{DU} (1 - \\exp(U))$$\n现在，我们求解 $J$：\n$$c_R - c_L \\exp(U) = \\frac{JL}{DU} (1 - \\exp(U))$$\n$$J = \\frac{DU}{L} \\frac{c_R - c_L \\exp(U)}{1 - \\exp(U)}$$\n将分子和分母同乘以 $-1$ 得到更常见的形式：\n$$J = \\frac{DU}{L} \\frac{c_L \\exp(U) - c_R}{\\exp(U) - 1}$$\n这就是 Goldman-Hodgkin-Katz (GHK) 通量方程，即所要求的稳态通量 $J$ 的表达式。\n\n最后，我们分析 $J$ 的极限形式。\n\n1.  **扩散主导输运（小电压，$U \\to 0$）：**\n    当 $U \\to 0$ 时，$J$ 的表达式变为 $0/0$ 的不定形式。我们对表达式中依赖于 $U$ 的部分使用 L'Hôpital's rule。令 $f(U) = U(c_L \\exp(U) - c_R)$ 且 $g(U) = \\exp(U) - 1$。\n    $$J = \\frac{D}{L} \\lim_{U \\to 0} \\frac{f(U)}{g(U)} = \\frac{D}{L} \\lim_{U \\to 0} \\frac{f'(U)}{g'(U)}$$\n    导数为：\n    $$f'(U) = (c_L \\exp(U) - c_R) + U(c_L \\exp(U))$$\n    $$g'(U) = \\exp(U)$$\n    取极限：\n    $$\\lim_{U \\to 0} \\frac{f'(U)}{g'(U)} = \\frac{(c_L \\exp(0) - c_R) + 0}{\\exp(0)} = c_L - c_R$$\n    因此，极限通量为：\n    $$J_{U \\to 0} = \\frac{D}{L} (c_L - c_R)$$\n    这是 Fick's first law of diffusion，其中通量由浓度差 $(c_L - c_R)$ 驱动。\n\n2.  **漂移主导输运（大电压，$|U| \\to \\infty$）：**\n    a. 对于大正电压 ($U \\to +\\infty$)：$\\exp(U)$ 变得非常大，因此 $\\exp(U)-1 \\approx \\exp(U)$。\n    $$J_{U \\to +\\infty} \\approx \\frac{DU}{L} \\frac{c_L \\exp(U)}{\\exp(U)} = \\frac{DU c_L}{L}$$\n    通量与源蓄液池的浓度 $c_L$ 和外加电压成正比（因为 $U \\propto V$）。这表示离子被强电场从高浓度一侧扫过。\n\n    b. 对于大负电压 ($U \\to -\\infty$)：$\\exp(U) \\to 0$。\n    $$J_{U \\to -\\infty} \\approx \\frac{DU}{L} \\frac{c_L(0) - c_R}{0 - 1} = \\frac{DU c_R}{L}$$\n    此时通量与另一个蓄液池的浓度 $c_R$ 和外加电压成正比。$U$ 的负号表示通量方向相反，由电场将离子从 $z=L$ 处的蓄液池中拉出驱动。\n\n在两种漂移主导的情况下，通量都与电压 $V$ 和源蓄液池的浓度呈线性关系。",
            "answer": "$$\\boxed{\\frac{DU}{L} \\frac{c_{L} \\exp(U) - c_{R}}{\\exp(U) - 1}}$$"
        },
        {
            "introduction": "经典模型（如GHK方程）将离子视为点状粒子，这在高浓度下是不切实际的。通过在能斯特-普朗克模型中引入比克曼（Bikerman）立体效应项，我们可以考虑离子的有限体积，从而得到更真实的电流-浓度关系，该关系呈现非单调特性。这项实践将指导你如何改进基础模型以捕捉离子拥挤和通道饱和等复杂物理现象 。",
            "id": "3771085",
            "problem": "您将实现并分析在一维能斯特-普朗克（NP）模型中引入比克曼空间位阻项如何改变窄离子通道中高浓度下的离子电流行为，并将此改变与密度泛函理论（DFT）的预测联系起来。请从以下基本基础开始：\n\n- 在电化学势梯度下，离子种类 $i$ 的通量的能斯特-普朗克（NP）表达式为 $J_i = -\\dfrac{D_i}{k_{\\mathrm{B}} T} C_i \\dfrac{d \\mu_i}{dx}$，其中 $D_i$ 是扩散系数，$C_i$ 是数密度，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n- 电化学势包含一个静电贡献项 $z_i e \\phi$，其中 $z_i$ 是化合价，$e$ 是元电荷，$\\phi$ 是电势。\n- 化学势中的比克曼晶格气体空间位阻贡献源于占据晶格的有限尺寸离子的构型熵。对于粒子体积 $v_i = v$ 的等尺寸离子，无量纲的占据分数为 $\\theta = \\sum_i v C_i$，并且过量项通过晶格气体自由能所蕴含的混合熵进入化学势。\n\n假设一种对称二元电解质，其 $z_+ = +1$ 且 $z_- = -1$，扩散系数相等 $D_+ = D_- = D$，离子尺寸相同，体积为 $v_+ = v_- = v$。考虑在长度为 $L$、横截面积为 $A$ 的通道上施加均匀电场 $E = V/L$，且 $D$ 或 $v$ 无空间变化。使用数密度表示法（单位：粒子/立方米），因此 $v$ 的单位是 $\\mathrm{m}^3$/粒子，对于等浓度 $C_+ = C_- = C$ 的情况，占据分数为 $\\theta = 2 v C$。\n\n任务：\n\n1. 使用能斯特-普朗克通量定义和对化学势的晶格气体空间位阻修正，从第一性原理推导经典电流密度 $j_{\\mathrm{np}}$ 如何依赖于 $C$ 和 $E$，并分别推导经比克曼修正的电流密度 $j_{\\mathrm{bik}}$ 如何依赖于 $C$、$E$ 以及与 $\\theta$ 相关的自由体积分数。不要使用任何简便公式；在输运论证中明确地引入晶格气体模型所蕴含的热力学因子。将总电流 $I$（单位：安培）表示为 $I = A j$。\n2. 识别空间位阻项在高浓度下改变电流饱和行为的机制。解释是什么饱和了以及为什么会饱和，并将该行为与晶格气体的密度泛函理论（DFT）对拥挤环境中输运的预测进行比较。\n3. 实现一个程序，为以下参数值测试套件计算 $I_{\\mathrm{np}}$ 和 $I_{\\mathrm{bik}}$。所有物理常数必须使用其具体数值，并且所有量必须以一致的物理单位进行计算和报告：\n   - 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n   - 元电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n   - 绝对温度 $T = 298\\,\\mathrm{K}$。\n   - 扩散系数 $D = 10^{-9}\\,\\mathrm{m^2/s}$。\n   - 通道长度 $L = 5 \\times 10^{-9}\\,\\mathrm{m}$。\n   - 横截面积 $A = 2 \\times 10^{-18}\\,\\mathrm{m^2}$。\n   - 化合价大小 $|z| = 1$。\n   - 该测试套件包含六个案例，每个案例由 $(C, v, V)$ 给出，其中 $C$ 的单位是 $\\mathrm{m^{-3}}$（数密度），$v$ 的单位是 $\\mathrm{m^3}$（每粒子），$V$ 的单位是伏特：\n     1. $(1.0 \\times 10^{25}, 1.0 \\times 10^{-28}, 0.05)$，稀疏案例。\n     2. $(2.5 \\times 10^{27}, 1.0 \\times 10^{-28}, 0.05)$，接近比克曼修正电导预测峰值的中间案例。\n     3. $(4.95 \\times 10^{27}, 1.0 \\times 10^{-28}, 0.05)$，接近堆积极限。\n     4. $(2.5 \\times 10^{27}, 5.0 \\times 10^{-29}, 0.05)$，相同浓度下较小的离子体积。\n     5. $(2.5 \\times 10^{27}, 1.0 \\times 10^{-28}, 0.15)$，中间浓度下较高的施加电压。\n     6. $(0.0, 1.0 \\times 10^{-28}, 0.05)$，零浓度边界案例。\n4. 对每个案例，计算：\n   - 经典NP电流 $I_{\\mathrm{np}}$，单位为 $\\mathrm{A}$。\n   - 经比克曼修正的电流 $I_{\\mathrm{bik}}$，单位为 $\\mathrm{A}$。\n   - 比率 $r = I_{\\mathrm{bik}}/I_{\\mathrm{np}}$，以小数形式表示，并遵循约定：如果 $I_{\\mathrm{np}} = 0$，则 $r = 0.0$。\n5. 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[I_{\\mathrm{np}}^{(1)}, I_{\\mathrm{bik}}^{(1)}, r^{(1)}, I_{\\mathrm{np}}^{(2)}, I_{\\mathrm{bik}}^{(2)}, r^{(2)}, \\dots, I_{\\mathrm{np}}^{(6)}, I_{\\mathrm{bik}}^{(6)}, r^{(6)}]$。所有电流必须以安培为单位，以浮点数形式表示，并始终使用国际单位制（SI）。\n\n此问题要求从NP通量和晶格气体空间位阻自由能贡献出发进行推导，解释高浓度 $C$ 下饱和的物理机制，并将此机制与密度泛函理论（DFT）对拥挤离子系统的预测联系起来。数值实现必须反映此推导过程，并为测试套件计算指定的量。解决方案不应引入或依赖任何未从所述基础中证明的简便公式。",
            "solution": "该问题要求推导和分析纳米通道中的离子电流，比较经典的能斯特-普朗克（NP）模型和一个包含了比克曼模型所描述的拥挤系统中空间位阻效应的修正版本。分析必须基于第一性原理，并且推导出的表达式必须进行数值实现。\n\n离子种类 $i$ 的通量的基本表达式由能斯特-普朗克方程给出，它将通量 $J_i$ 与电化学势 $\\tilde{\\mu}_i$ 的梯度联系起来：\n$$J_i = -\\frac{D_i C_i}{k_{\\mathrm{B}} T} \\frac{d\\tilde{\\mu}_i}{dx}$$\n这里，$D_i$ 是扩散系数，$C_i$ 是数密度，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。总电流密度 $j$ 是各离子种类部分电流的总和，$j = \\sum_i z_i e J_i$，其中 $z_i$ 是化合价，$e$ 是元电荷。通过面积为 $A$ 的通道的总电流 $I$ 是 $I = jA$。\n\n**1. 经典电流和经比克曼修正的电流的推导**\n\n我们考虑一个对称二元电解质，其中 $z_+ = +1$，$z_- = -1$，浓度相等 $C_+ = C_- = C$，扩散系数相等 $D_+ = D_- = D$。通道内有均匀电场 $E = V/L$，并假设浓度 $C$ 沿通道长度 $L$ 是均匀的。\n\n**经典能斯特-普朗克（NP）电流**\n\n在经典模型中，离子被视作点粒子。电化学势 $\\tilde{\\mu}_i$ 是理想化学势和静电势之和：\n$$\\tilde{\\mu}_i^{\\mathrm{ideal}} = \\mu_i^0 + k_{\\mathrm{B}} T \\ln(C_i) + z_i e \\phi(x)$$\n其中 $\\mu_i^0$ 是标准态势。电化学势的梯度为：\n$$\\frac{d\\tilde{\\mu}_i^{\\mathrm{ideal}}}{dx} = k_{\\mathrm{B}} T \\frac{1}{C_i} \\frac{dC_i}{dx} + z_i e \\frac{d\\phi}{dx}$$\n在所述的均匀浓度条件下，$\\frac{dC_i}{dx} = 0$。电场是均匀的，$E = - \\frac{d\\phi}{dx}$，所以 $\\frac{d\\phi}{dx} = -E$。梯度简化为：\n$$\\frac{d\\tilde{\\mu}_i^{\\mathrm{ideal}}}{dx} = -z_i e E$$\n将此代入阳离子（$i=+$）和阴离子（$i=-$）的通量方程：\n$$J_+ = -\\frac{D C}{k_{\\mathrm{B}} T} (-z_+ e E) = \\frac{D C e E}{k_{\\mathrm{B}} T}$$\n$$J_- = -\\frac{D C}{k_{\\mathrm{B}} T} (-z_- e E) = \\frac{D C (-e) E}{k_{\\mathrm{B}} T} = -\\frac{D C e E}{k_{\\mathrm{B}} T}$$\n总电流密度 $j_{\\mathrm{np}}$ 是：\n$$j_{\\mathrm{np}} = z_+ e J_+ + z_- e J_- = (+1)e J_+ + (-1)e J_- = e(J_+ - J_-)$$\n$$j_{\\mathrm{np}} = e \\left( \\frac{D C e E}{k_{\\mathrm{B}} T} - \\left(-\\frac{D C e E}{k_{\\mathrm{B}} T}\\right) \\right) = \\frac{2 D e^2 C E}{k_{\\mathrm{B}} T}$$\n总电流 $I_{\\mathrm{np}}$ 是通过乘以面积 $A$ 并代入 $E=V/L$ 得到的：\n$$I_{\\mathrm{np}} = A j_{\\mathrm{np}} = \\frac{2 A D e^2 V C}{k_{\\mathrm{B}} T L}$$\n这个经典结果预测电流随浓度 $C$ 线性无限增长。\n\n**经比克曼修正的电流**\n\n比克曼模型考虑了离子的有限体积。这种空间位阻排斥通过晶格气体概念引入。在拥挤的环境中，一个离子的运动会受到其邻近离子的阻碍。一个离子成功移动到相邻位置的概率与目标位置为空的概率成正比。这引入了一种动力学减速。对此效应最简单的平均场近似是通过一个等于可用自由体积分数的因子 $(1-\\theta)$ 来修正扩散系数，其中 $\\theta$ 是离子占据的总体积分数。\n对于体积为 $v$ 的等尺寸离子，占据分数为 $\\theta = vC_+ + vC_- = 2vC$。有效扩散系数变得与浓度相关：\n$$D_{\\text{eff}}(C) = D(1-\\theta) = D(1-2vC)$$\n其中 $D$ 是无限稀释时的扩散系数。这一修正是晶格气体自由能中构型熵项的直接结果，当通过动力学理论或DFT框架进行推导时，会导致一个在系统接近密堆积（$\\theta \\to 1$）时趋于零的输运系数。\n\n我们在经典推导中用 $D_{\\text{eff}}(C)$ 替换 $D$。所有其他步骤保持不变，因为均匀浓度的假设仍然隔离了电流的漂移分量，该分量与迁移率成正比，因此也与扩散系数成正比。\n因此，经比克曼修正的电流密度 $j_{\\mathrm{bik}}$ 为：\n$$j_{\\mathrm{bik}} = \\frac{2 D_{\\text{eff}}(C) e^2 C E}{k_{\\mathrm{B}} T} = \\frac{2 D(1-2vC) e^2 C E}{k_{\\mathrm{B}} T}$$\n总的比克曼修正电流 $I_{\\mathrm{bik}}$ 是：\n$$I_{\\mathrm{bik}} = A j_{\\mathrm{bik}} = \\frac{2 A D e^2 V C(1-2vC)}{k_{\\mathrm{B}} T L}$$\n\n**2. 饱和机制及其与密度泛函理论（DFT）的联系**\n\n经典NP模型预测 $I_{\\mathrm{np}} \\propto C$，这是一个单调递增的函数。这在高浓度下是不符合物理实际的。比克曼修正引入了因子 $C(1-2vC)$，这是一个关于 $C$ 的抛物线函数。\n- 在低浓度下（$2vC \\ll 1$），$I_{\\mathrm{bik}} \\approx I_{\\mathrm{np}}$，表现出线性行为。\n- 随着 $C$ 增加，项 $(1-2vC)$ 减小，表示由于拥挤导致离子迁移率的降低。电流是电荷载流子数量（$C$）和其有效迁移率（与 $D(1-2vC)$ 成正比）的乘积。\n- 这种竞争导致在特定浓度下出现最大电流。通过对 $C(1-2vC)$ 关于 $C$ 求导并令其为零（$1-4vC=0$），我们发现峰值电流出现在 $C = 1/(4v)$，这对应于占据分数 $\\theta = 2vC = 0.5$。\n- 超过这个峰值后，增加更多的离子对输运的阻碍作用超过了其增加电荷载流子的作用，导致总电流*减小*。\n- 当 $C$ 接近物理堆积极限 $C \\to 1/(2v)$（即 $\\theta \\to 1$）时，项 $(1-2vC) \\to 0$，电流 $I_{\\mathrm{bik}} \\to 0$。通道变得完全堵塞，宏观输运停止。这种现象被称为离子电流饱和与阻塞。\n\n这一行为与密度泛函理论（DFT）的预测一致。对于描述具有硬核排斥和其他相互作用的流体，DFT提供了一个比简单的平均场比克曼模型更严谨的框架。对拥挤系统中输运的DFT计算证实，电导率是密度的非单调函数。虽然简单的 $(1-\\theta)$ 因子是一阶近似，但DFT会得出一个更复杂的热力学因子，该因子能捕捉流体的详细结构关联，但其定性结果——电流在高密度下出现转折并随后下降——仍然是拥挤环境中输运的一个基本特征。\n\n**3.  4. 计算实现**\n\n上述推导的公式将用于数值计算。\n$$I_{\\mathrm{np}} = \\left( \\frac{2 A D e^2 V}{k_{\\mathrm{B}} T L} \\right) C$$\n$$I_{\\mathrm{bik}} = I_{\\mathrm{np}} \\times (1-2vC)$$\n比率为 $r = I_{\\mathrm{bik}}/I_{\\mathrm{np}} = (1-2vC)$。如果 $C=0$，则 $I_{\\mathrm{np}}=0$，且 $r$ 定义为 $0.0$。\n所有参数将使用国际单位制（SI）基本单位。\n- $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- $T = 298\\,\\mathrm{K}$\n- $D = 10^{-9}\\,\\mathrm{m^2/s}$\n- $L = 5 \\times 10^{-9}\\,\\mathrm{m}$\n- $A = 2 \\times 10^{-18}\\,\\mathrm{m^2}$\n\n测试套件将根据这些表达式进行处理。对于任何 $2vC \\ge 1$ 的情况，比克曼模型预测电流为零或非物理的负值；我们将遵循该公式，因为它反映了模型对输运停止的预测。然而，对于给定的测试案例，占据分数 $\\theta = 2vC$ 不会超过1。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes classical Nernst-Planck (NP) and Bikerman-modified ionic currents\n    for a symmetric binary electrolyte in a narrow channel.\n    \"\"\"\n    # Physical constants in SI units\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    \n    # System parameters in SI units\n    T = 298.0  # Absolute temperature in K\n    D = 1.0e-9   # Diffusion coefficient in m^2/s\n    L = 5.0e-9   # Channel length in m\n    A = 2.0e-18  # Cross-sectional area in m^2\n    \n    # Test suite: (C, v, V)\n    # C: number density in m^-3\n    # v: ion volume in m^3\n    # V: applied voltage in V\n    test_cases = [\n        (1.0e25, 1.0e-28, 0.05),\n        (2.5e27, 1.0e-28, 0.05),\n        (4.95e27, 1.0e-28, 0.05),\n        (2.5e27, 5.0e-29, 0.05),\n        (2.5e27, 1.0e-28, 0.15),\n        (0.0, 1.0e-28, 0.05),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        C, v, V = case\n        \n        # Calculate the common prefactor for current calculation\n        # This prefactor groups all constants and system parameters\n        # Prefactor = (2 * A * D * e^2 * V) / (k_B * T * L)\n        # Note: I_np = prefactor * C\n        if K_B * T * L == 0:\n            prefactor = 0.0 # Avoid division by zero, though parameters prevent this\n        else:\n            prefactor = (2 * A * D * E_CHARGE**2 * V) / (K_B * T * L)\n\n        # 1. Classical Nernst-Planck current (I_np)\n        # I_np = prefactor * C\n        i_np = prefactor * C\n        \n        # 2. Bikerman-modified current (I_bik)\n        # The modification is a steric factor (1 - theta), where theta = 2*v*C\n        occupancy_fraction = 2 * v * C\n        \n        # The model assumes theta  1 for physical validity. All test cases satisfy this.\n        steric_factor = 1.0 - occupancy_fraction\n        \n        # I_bik = prefactor * C * (1 - 2*v*C) = I_np * (1 - 2*v*C)\n        i_bik = i_np * steric_factor\n        \n        # 3. Ratio r = I_bik / I_np\n        # According to the problem, if I_np is 0, r is 0.0.\n        if i_np == 0.0:\n            ratio = 0.0\n        else:\n            ratio = i_bik / i_np\n            \n        results.extend([i_np, i_bik, ratio])\n\n    # Format the final output as a comma-separated list in brackets\n    # Example: [I_np_1, I_bik_1, r_1, I_np_2, I_bik_2, r_2, ...]\n    formatted_results = [f\"{res:.6e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从连续介质模型过渡到诸如非平衡分子动力学（NEMD）这样基于粒子的模拟会带来新的挑战。在NEMD模拟中施加外部电场时，恒温器的作用可能会引起虚假的溶剂流动，从而污染计算得到的离子电流。这项实践旨在解决这一关键问题，通过推导并实施一种基于能量平衡的校正方案，你将学会如何确保模拟结果准确反映真实的电扩散过程，而非模拟方法本身引入的伪影 。",
            "id": "3771134",
            "problem": "一名开发人员的任务是，在一个施加电场的离子通道中，对通过非平衡分子动力学（NEMD）计算出的离子电流实施一种基于物理原理的校正。该校正需确保能量平衡，并消除由恒温器引入的伪流体动力学流。该通道沿轴向坐标被视为一维，具有均匀的横截面积和均匀的轴向电场。该系统由一组以 $i$ 为索引的离子种类组成，每种离子分别具有电荷 $q_i$、质量 $m_i$、摩擦系数 $\\gamma_i$ 和数密度 $n_i$（单位体积内的数量）。溶剂的质量密度为 $\\rho_s$，其等效恒温器摩擦系数为 $\\gamma_s$。所施加的电场用 $E$ 表示，并沿通道轴线方向。通道的长度为 $L$，横截面积为 $A$，因此通道体积为 $V = A L$。\n\n您的程序必须：\n- 根据给定的定律和约束推导出稳态速度 $v_i$，确定满足能量平衡的均匀溶剂漂移 $u$，数值上验证能量平衡，并计算校正后的离子电流 $I_{\\text{corr}} = A \\sum_i n_i q_i v_i^{\\text{corr}}$。未校正或朴素电流为 $I_{\\text{naive}} = A \\sum_i n_i q_i v_i$，但您只需报告校正后的电流。\n- 在计算 $I_{\\text{corr}}$ 时，通过从离子速度中减去 $u$ 来显式地移除伪流体动力学流。\n- 通过检查输入电功率 $P_{\\text{in}} = V \\sum_i n_i q_i E v_i$ 与总耗散功率 $P_{\\text{diss}} = V \\left( \\sum_i n_i m_i \\gamma_i \\left(v_i - u\\right)^2 + \\rho_s \\gamma_s u^2 \\right)$ 之间的差值是否可以忽略不计（相对容差在 $10^{-12}$ 之内）来验证能量平衡。\n- 电流以安培（A）为单位，速度以米/秒（m/s）为单位表示。\n\n使用以下科学上一致的参数集作为测试套件，涵盖理想路径、电中性、零场边界和高溶剂摩擦边缘情况。在所有情况下，设置通道长度和半径为 $L = 5.0 \\times 10^{-9}$ 米和 $r = 0.5 \\times 10^{-9}$ 米，因此 $A = \\pi r^2$。使用元电荷 $e = 1.602 \\times 10^{-19}$ 库仑。考虑两种离子：电荷为 $q_+ = +e$ 的阳离子和电荷为 $q_- = -e$ 的阴离子，其质量分别为 $m_+ = 3.817 \\times 10^{-26}$ 千克和 $m_- = 5.887 \\times 10^{-26}$ 千克。除非另有说明，否则使用离子摩擦系数 $\\gamma_+ = 5.0 \\times 10^{12}$ 每秒和 $\\gamma_- = 5.0 \\times 10^{12}$ 每秒，溶剂质量密度 $\\rho_s = 1000$ 千克/立方米，以及溶剂恒温器摩擦系数 $\\gamma_s = 1.0 \\times 10^{11}$ 每秒。\n\n测试用例：\n1. 理想路径对称电解质：\n   - $E = 2.0 \\times 10^{7}$ 伏特/米，\n   - $n_+ = 1.0 \\times 10^{27}$ 每立方米，\n   - $n_- = 1.0 \\times 10^{27}$ 每立方米。\n2. 通过能量平衡产生均匀溶剂漂移的非电中性混合物：\n   - $E = 2.0 \\times 10^{7}$ 伏特/米，\n   - $n_+ = 1.2 \\times 10^{27}$ 每立方米，\n   - $n_- = 0.8 \\times 10^{27}$ 每立方米。\n3. 零场边界情况：\n   - $E = 0$ 伏特/米，\n   - $n_+ = 1.0 \\times 10^{27}$ 每立方米，\n   - $n_- = 1.0 \\times 10^{27}$ 每立方米。\n4. 高溶剂摩擦边缘情况（伪流减少）：\n   - $E = 2.0 \\times 10^{7}$ 伏特/米，\n   - $n_+ = 1.2 \\times 10^{27}$ 每立方米，\n   - $n_- = 0.8 \\times 10^{27}$ 每立方米，\n   - $\\gamma_s = 1.0 \\times 10^{14}$ 每秒。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按顺序输出三个条目：校正后的离子电流 $I_{\\text{corr}}$（单位为安培 A，浮点数），一个布尔值（指示能量平衡检查是否在规定容差内通过），以及被消除的均匀溶剂漂移 $u$（单位为米/秒 m/s，浮点数）。因此，对于四个测试用例，您的单行输出必须是一个包含12个条目的扁平列表，顺序为 $[I_{\\text{corr,1}}, \\text{EB}_{1}, u_1, I_{\\text{corr,2}}, \\text{EB}_{2}, u_2, I_{\\text{corr,3}}, \\text{EB}_{3}, u_3, I_{\\text{corr,4}}, \\text{EB}_{4}, u_4]$。",
            "solution": "该问题要求在一个一维纳米通道模型中，推导并计算校正后的离子电流，同时考虑非平衡分子动力学（NEMD）模拟中由恒温器引起的伪溶剂流。推导过程基于所提供的基本原理：用于离子漂移的牛顿第二定律、稳态条件以及全系统的能量平衡。\n\n首先，我们确定每种离子 $i$ 的稳态漂移速度。问题提供了离子种类 $i$ 的平均漂移速度 $v_i$ 的运动方程：\n$$m_i \\frac{dv_i}{dt} = q_i E - m_i \\gamma_i (v_i - u)$$\n其中 $m_i$ 是离子质量，$q_i$ 是其电荷，$E$ 是施加的电场，$\\gamma_i$ 是离子的有效摩擦系数，$u$ 是溶剂的均匀漂移速度。\n\n在稳态条件下，$dv_i/dt = 0$。方程简化为：\n$$0 = q_i E - m_i \\gamma_i (v_i - u)$$\n我们可以求解这个代数方程以得到稳态速度 $v_i$：\n$$m_i \\gamma_i (v_i - u) = q_i E$$\n$$v_i - u = \\frac{q_i E}{m_i \\gamma_i}$$\n这给出了离子种类 $i$ 的速度，表示为尚未确定的溶剂漂移 $u$ 的函数：\n$$v_i = u + \\frac{q_i E}{m_i \\gamma_i}$$\n项 $\\frac{q_i E}{m_i \\gamma_i}$ 代表离子相对于溶剂的漂移速度。\n\n接下来，我们通过强制执行能量平衡约束来确定溶剂漂移速度 $u$。电场输入到系统中的能量速率必须等于恒温器耗散能量的速率。在通道体积 $V$ 上的总输入功率由 $P_{\\text{in}} = V \\sum_i n_i q_i E v_i$ 给出。总耗散功率是离子和溶剂耗散的总和，$P_{\\text{diss}} = V \\left( \\sum_i n_i m_i \\gamma_i (v_i - u)^2 + \\rho_s \\gamma_s u^2 \\right)$。令功率密度相等（通过除以 $V$）可得：\n$$\\sum_i n_i q_i E v_i = \\sum_i n_i m_i \\gamma_i (v_i - u)^2 + \\rho_s \\gamma_s u^2$$\n我们将 $v_i$ 和 $(v_i - u)$ 的表达式代入此方程。\n对于左侧（LHS）：\n$$\\text{LHS} = \\sum_i n_i q_i E \\left( u + \\frac{q_i E}{m_i \\gamma_i} \\right) = u E \\sum_i n_i q_i + E^2 \\sum_i \\frac{n_i q_i^2}{m_i \\gamma_i}$$\n对于右侧（RHS）：\n$$\\text{RHS} = \\sum_i n_i m_i \\gamma_i \\left(\\frac{q_i E}{m_i \\gamma_i}\\right)^2 + \\rho_s \\gamma_s u^2 = \\sum_i n_i m_i \\gamma_i \\frac{q_i^2 E^2}{m_i^2 \\gamma_i^2} + \\rho_s \\gamma_s u^2 = E^2 \\sum_i \\frac{n_i q_i^2}{m_i \\gamma_i} + \\rho_s \\gamma_s u^2$$\n令 LHS 和 RHS 相等：\n$$u E \\sum_i n_i q_i + E^2 \\sum_i \\frac{n_i q_i^2}{m_i \\gamma_i} = E^2 \\sum_i \\frac{n_i q_i^2}{m_i \\gamma_i} + \\rho_s \\gamma_s u^2$$\n项 $E^2 \\sum_i \\frac{n_i q_i^2}{m_i \\gamma_i}$ 从两侧消去，得到一个关于 $u$ 的更简单的方程：\n$$u E \\sum_i n_i q_i = \\rho_s \\gamma_s u^2$$\n这可以重写为：\n$$u \\left( \\rho_s \\gamma_s u - E \\sum_i n_i q_i \\right) = 0$$\n该方程产生两个可能的 $u$ 解：$u=0$ 或 $u = \\frac{E \\sum_i n_i q_i}{\\rho_s \\gamma_s}$。非零解代表在非电中性系统（$\\sum_i n_i q_i \\neq 0$）中，由于离子向溶剂传递动量（该动量被恒温器的摩擦力所平衡），在电场作用下产生的伪流体动力学流。因此，物理上相关的溶剂漂移是：\n$$u = \\frac{E \\sum_i n_i q_i}{\\rho_s \\gamma_s}$$\n\n校正后的离子速度 $v_i^{\\text{corr}}$ 是相对于溶剂流的速度：\n$$v_i^{\\text{corr}} = v_i - u$$\n使用我们从稳态条件得到的结果：\n$$v_i^{\\text{corr}} = \\frac{q_i E}{m_i \\gamma_i}$$\n校正后的离子电流 $I_{\\text{corr}}$ 使用这些校正后的速度和通道横截面积 $A$ 来计算：\n$$I_{\\text{corr}} = A \\sum_i n_i q_i v_i^{\\text{corr}}$$\n代入 $v_i^{\\text{corr}}$ 的表达式：\n$$I_{\\text{corr}} = A \\sum_i n_i q_i \\left( \\frac{q_i E}{m_i \\gamma_i} \\right) = A E \\sum_i \\frac{n_i q_i^2}{m_i \\gamma_i}$$\n$I_{\\text{corr}}$ 的这个最终表达式与溶剂性质 $\\rho_s$ 和 $\\gamma_s$ 无关，这在物理上是正确的，因为该校正旨在消除与溶剂和恒温器模型相关的伪影。\n\n最后，为了对能量平衡进行数值验证，我们使用计算出的速度 $v_i = u + v_i^{\\text{corr}}$ 和溶剂漂移 $u$ 来计算总输入功率 $P_{\\text{in}}$ 和总耗散功率 $P_{\\text{diss}}$。\n$$P_{\\text{in}} = V \\sum_i n_i q_i E v_i$$\n$$P_{\\text{diss}} = V \\left( \\sum_i n_i m_i \\gamma_i (v_i - u)^2 + \\rho_s \\gamma_s u^2 \\right)$$\n当 $P_{\\text{in}} \\neq 0$ 时，如果 $|P_{\\text{in}} - P_{\\text{diss}}| / |P_{\\text{in}}|  10^{-12}$，或者如果两者都为零，则平衡得到确认。\n\n每个测试用例的算法如下：\n1.  定义该用例的所有物理常数和参数。\n2.  计算通道横截面积 $A = \\pi r^2$ 和体积 $V = AL$。\n3.  计算净电荷密度 $\\rho_q = \\sum_i n_i q_i$。\n4.  计算溶剂漂移速度 $u = (E \\rho_q) / (\\rho_s \\gamma_s)$。\n5.  计算校正后的电流 $I_{\\text{corr}} = A E \\sum_i (n_i q_i^2) / (m_i \\gamma_i)$。\n6.  计算未校正的漂移速度 $v_i = u + (q_i E) / (m_i \\gamma_i)$。\n7.  计算 $P_{\\text{in}}$ 和 $P_{\\text{diss}}$ 并验证它们在指定的相对容差内相等。\n8.  收集并按要求格式化结果（$I_{\\text{corr}}$、能量平衡布尔值、$u$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the corrected ionic current, energy balance, and solvent drift\n    for a series of test cases based on a 1D ion channel model.\n    \"\"\"\n\n    # --- Constants and Default Parameters ---\n    L = 5.0e-9  # Channel length (m)\n    r = 0.5e-9  # Channel radius (m)\n    A = np.pi * r**2  # Channel cross-sectional area (m^2)\n    V = A * L  # Channel volume (m^3)\n    e = 1.602e-19  # Elementary charge (C)\n\n    # Ion properties: cation (+) and anion (-)\n    q_vals = np.array([e, -e])  # Charges (C)\n    m_vals = np.array([3.817e-26, 5.887e-26])  # Masses (kg)\n    gamma_ion_vals = np.array([5.0e12, 5.0e12])  # Ionic friction coeffs (1/s)\n\n    # Default solvent properties\n    rho_s_default = 1000.0  # Solvent mass density (kg/m^3)\n    gamma_s_default = 1.0e11  # Solvent thermostat friction coeff (1/s)\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case 1: Happy path symmetric electrolyte\n        {\n            \"E\": 2.0e7, \n            \"n_vals\": np.array([1.0e27, 1.0e27]),\n            \"rho_s\": rho_s_default,\n            \"gamma_s\": gamma_s_default,\n        },\n        # Case 2: Non-neutral mixture\n        {\n            \"E\": 2.0e7,\n            \"n_vals\": np.array([1.2e27, 0.8e27]),\n            \"rho_s\": rho_s_default,\n            \"gamma_s\": gamma_s_default,\n        },\n        # Case 3: Zero-field boundary case\n        {\n            \"E\": 0.0,\n            \"n_vals\": np.array([1.0e27, 1.0e27]),\n            \"rho_s\": rho_s_default,\n            \"gamma_s\": gamma_s_default,\n        },\n        # Case 4: High solvent friction edge case\n        {\n            \"E\": 2.0e7,\n            \"n_vals\": np.array([1.2e27, 0.8e27]),\n            \"rho_s\": rho_s_default,\n            \"gamma_s\": 1.0e14,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        E = case[\"E\"]\n        n_vals = case[\"n_vals\"]\n        rho_s = case[\"rho_s\"]\n        gamma_s = case[\"gamma_s\"]\n\n        # Net charge density (rho_q = sum(n_i * q_i))\n        net_charge_density = np.sum(n_vals * q_vals)\n\n        # Calculate solvent drift velocity u\n        # u = (E * sum(n_i * q_i)) / (rho_s * gamma_s)\n        denominator_u = rho_s * gamma_s\n        if denominator_u == 0:\n            # Avoid division by zero, though not expected with given params\n            u = 0.0 \n        else:\n            u = (E * net_charge_density) / denominator_u\n\n        # Calculate corrected ionic current I_corr\n        # I_corr = A * E * sum(n_i * q_i^2 / (m_i * gamma_i))\n        conductivity_term = np.sum(n_vals * q_vals**2 / (m_vals * gamma_ion_vals))\n        I_corr = A * E * conductivity_term\n\n        # --- Energy Balance Verification ---\n        # Corrected velocities (relative to solvent)\n        v_corr_vals = q_vals * E / (m_vals * gamma_ion_vals)\n        \n        # Uncorrected (lab frame) velocities\n        v_vals = u + v_corr_vals\n\n        # Power input from electric field\n        P_in = V * E * np.sum(n_vals * q_vals * v_vals)\n        \n        # Power dissipated by thermostat\n        P_diss_ions = V * np.sum(n_vals * m_vals * gamma_ion_vals * v_corr_vals**2)\n        P_diss_solvent = V * rho_s * gamma_s * u**2\n        P_diss = P_diss_ions + P_diss_solvent\n\n        # Check for balance with a relative tolerance\n        is_balanced = np.isclose(P_in, P_diss, rtol=1e-12, atol=1e-30)\n\n        results.extend([I_corr, is_balanced, u])\n\n    # Final print statement in the exact required format\n    # Convert booleans to strings ('True', 'False') for printing\n    final_output_list = []\n    for item in results:\n        if isinstance(item, bool):\n            final_output_list.append(str(item).lower())\n        else:\n            final_output_list.append(f\"{item:.6e}\")\n            \n    print(f\"[{','.join(final_output_list)}]\")\n\nsolve()\n\n```"
        }
    ]
}