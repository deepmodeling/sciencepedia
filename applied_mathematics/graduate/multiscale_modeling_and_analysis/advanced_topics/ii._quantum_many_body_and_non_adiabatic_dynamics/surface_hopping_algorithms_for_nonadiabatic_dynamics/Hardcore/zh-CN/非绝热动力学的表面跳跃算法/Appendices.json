{
    "hands_on_practices": [
        {
            "introduction": "非绝热跃迁的核心驱动力是势能面之间的非绝热耦合。为了将这一抽象概念具体化，本练习将指导您在一个常见的模型系统——线性振动耦合模型中，通过编程计算非绝热耦合的大小。通过亲手计算并识别出耦合强度较大的区域，您将对势能面上最可能发生表面跳跃的“热点”区域建立起直观的认识。",
            "id": "3811646",
            "problem": "您需要实现一个程序，用于分析二维线性振动耦合模型中的非绝热导数耦合。其物理模型由两个与核坐标线性耦合的透热电子态定义。程序必须在笛卡尔网格上计算两个绝热态之间非绝热导数耦合矢量的大小较大的点集，并为每个测试用例输出这些点的数量。\n\n模型规格与定义：\n- 考虑核坐标 $(x,y)$，单位为埃 (Å)。\n- 透热电子哈密顿量 $\\mathbf{H}(x,y)$ 是一个 $2\\times 2$ 矩阵，其元素为\n$$\nH_{11}(x,y) = \\kappa_x x + \\kappa_y y,\\quad\nH_{22}(x,y) = -\\kappa_x x - \\kappa_y y,\\quad\nH_{12}(x,y) = H_{21}(x,y) = V,\n$$\n其中 $\\kappa_x$ 和 $\\kappa_y$ 是斜率，单位为电子伏特每埃 (eV/Å)，$V$ 是一个恒定的透热耦合，单位为电子伏特 (eV)。\n- 绝热态 $\\lvert \\phi_1(x,y)\\rangle$ 和 $\\lvert \\phi_2(x,y)\\rangle$ 是 $\\mathbf{H}(x,y)$ 的归一化本征矢量。\n- 绝热态 $1$ 和 $2$ 之间的非绝热导数耦合矢量由以下基本表达式定义\n$$\n\\mathbf{d}_{12}(x,y) = \\langle \\phi_1(x,y) \\lvert \\nabla_{\\mathbf{R}} \\rvert \\phi_2(x,y) \\rangle,\n$$\n其中 $\\nabla_{\\mathbf{R}} = \\left(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right)$ 作用于核坐标。其大小 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ 的单位为埃的倒数 ($\\mathrm{Å}^{-1}$)。\n\n计算任务：\n- 对于每个测试用例，在指定的矩形域上以指定的间距构建一个均匀的 $(x,y)$ 网格。\n- 在每个网格点上，构建 $\\mathbf{H}(x,y)$，获得绝热态，并根据上述定义计算 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$。\n- 识别出满足 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert \\ge \\tau$ 的网格点集，其中 $\\tau$ 是为每个测试用例指定的阈值，单位为 $\\mathrm{Å}^{-1}$。\n- 为每个测试用例报告这些网格点的整数数量。\n\n物理单位和数值要求：\n- 坐标 $(x,y)$ 的单位必须是 Å。\n- 参数 $\\kappa_x,\\kappa_y$ 的单位必须是 eV/Å，$V$ 的单位必须是 eV。\n- 阈值 $\\tau$ 的单位必须是 $\\mathrm{Å}^{-1}$。\n- 所有计算都必须在这些单位下保持数值一致性。\n\n测试套件：\n实现您的程序以评估以下测试用例，每个用例由一个元组 $(\\kappa_x,\\kappa_y,V,\\tau,x_{\\max},y_{\\max},\\Delta)$ 指定，其中 $x\\in[-x_{\\max},x_{\\max}]$，$y\\in[-y_{\\max},y_{\\max}]$，网格间距 $\\Delta$ 的单位为 Å：\n1. $(0.1, 0.1, 0.05, 1.0, 10.0, 10.0, 0.05)$\n2. $(0.1, 0.1, 0.05, 1.5, 10.0, 10.0, 0.05)$\n3. $(0.2, 0.05, 0.05, 0.5, 10.0, 10.0, 0.05)$\n4. $(0.0, 0.0, 0.05, 0.01, 10.0, 10.0, 0.05)$\n5. $(0.1, 0.1, 0.005, 10.0, 10.0, 10.0, 0.05)$\n\n输出格式：\n您的程序应生成单行输出，其中包含五个整数结果，以逗号分隔的列表形式并用方括号括起来（例如，“[n1,n2,n3,n4,n5]”）。不应打印任何其他文本。\n\n使用的科学和算法基础：\n- 使用混合量子-经典动力学中电子结构的第一性原理：绝热态通过 $\\mathbf{H}(x,y)$ 的对角化定义，非绝热导数耦合源于绝热态的坐标梯度。\n- 您可以使用已确立的两态系统恒等式，将导数耦合表示为从 $\\mathbf{H}(x,y)$ 推导出的量的函数，前提是这些恒等式遵循上述定义并与指定单位保持一致；请勿假定或引入无法从所述基本定义推导出的快捷公式。\n\n确保科学真实性：所选参数和域与用于非绝热动力学表面跳跃算法中的典型线性振动耦合模型一致。程序应是自包含的，并在指定的网格和参数范围内具有数值稳健性。",
            "solution": "目标是计算在指定的二维域中，非绝热导数耦合矢量的大小 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ 超过给定阈值 $\\tau$ 的网格点数量。解决方案包括从给定的透热哈密顿量解析推导 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ 的表达式，然后通过数值实现来在网格上评估此量并统计符合条件的点。\n\n首先，我们建立非绝热耦合矢量的解析表达式。透热哈密顿量 $\\mathbf{H}(x,y)$ 如下：\n$$\n\\mathbf{H}(x,y) = \\begin{pmatrix} H_{11}(x,y)  H_{12}(x,y) \\\\ H_{21}(x,y)  H_{22}(x,y) \\end{pmatrix} = \\begin{pmatrix} \\kappa_x x + \\kappa_y y  V \\\\ V  -(\\kappa_x x + \\kappa_y y) \\end{pmatrix}\n$$\n为方便起见，令 $U(x,y) = \\kappa_x x + \\kappa_y y$。哈密顿量简化为：\n$$\n\\mathbf{H}(x,y) = \\begin{pmatrix} U(x,y)  V \\\\ V  -U(x,y) \\end{pmatrix}\n$$\n绝热态 $\\lvert \\phi_1(x,y)\\rangle$ 和 $\\lvert \\phi_2(x,y)\\rangle$ 是 $\\mathbf{H}(x,y)$ 的本征矢量，其对应的本征值（绝热能量）为 $E_1(x,y)$ 和 $E_2(x,y)$。这些本征值通过求解特征方程得到：\n$$\n(U-E)(-U-E) - V^2 = 0 \\implies E^2 - U^2 - V^2 = 0 \\implies E = \\pm \\sqrt{U^2+V^2}\n$$\n我们将较低的能量赋给 $E_1$，较高的能量赋给 $E_2$：\n$$\nE_1 = -\\sqrt{U^2+V^2}, \\quad E_2 = +\\sqrt{U^2+V^2}\n$$\n能量差为 $\\Delta E = E_2 - E_1 = 2\\sqrt{U^2+V^2}$。由于所有测试用例中 $V0$，该差值永远不为零，因此态是非简并的。\n\n非绝热导数耦合矢量定义为 $\\mathbf{d}_{12} = \\langle \\phi_1 \\lvert \\nabla_{\\mathbf{R}} \\rvert \\phi_2 \\rangle$。从 Hellmann-Feynman 定理推导出的关于非对角元素的标准结果提供了一个计算上更方便的形式：\n$$\n\\mathbf{d}_{12}(x,y) = \\frac{\\langle \\phi_1(x,y) \\lvert (\\nabla_{\\mathbf{R}} \\mathbf{H}(x,y)) \\rvert \\phi_2(x,y) \\rangle}{E_2(x,y) - E_1(x,y)}\n$$\n其中 $\\nabla_{\\mathbf{R}} = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$。我们需要计算哈密顿量梯度 $\\nabla_{\\mathbf{R}}\\mathbf{H}$ 的矩阵元。其梯度分量为：\n$$\n\\frac{\\partial \\mathbf{H}}{\\partial x} = \\begin{pmatrix} \\kappa_x  0 \\\\ 0  -\\kappa_x \\end{pmatrix}, \\quad \\frac{\\partial \\mathbf{H}}{\\partial y} = \\begin{pmatrix} \\kappa_y  0 \\\\ 0  -\\kappa_y \\end{pmatrix}\n$$\n为了评估 $q \\in \\{x,y\\}$ 时的矩阵元 $\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial q} \\rvert \\phi_2 \\rangle$，我们可以通过一个混合角为 $\\theta$ 的旋转，用透热态来表示绝热态。$\\mathbf{H}$ 的本征矢量为：\n$$\n\\lvert \\phi_1 \\rangle = \\begin{pmatrix} -\\sin \\theta \\\\ \\cos \\theta \\end{pmatrix}, \\quad \\lvert \\phi_2 \\rangle = \\begin{pmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{pmatrix}\n$$\n其中混合角由 $\\tan(2\\theta) = H_{12} / \\frac{1}{2}(H_{11}-H_{22}) = V/U$ 定义。由此可得 $\\sin(2\\theta) = V/\\sqrt{U^2+V^2}$ 和 $\\cos(2\\theta) = U/\\sqrt{U^2+V^2}$。\n\nx分量所需的矩阵元为：\n$$\n\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial x} \\rvert \\phi_2 \\rangle = \\begin{pmatrix} -\\sin \\theta  \\cos \\theta \\end{pmatrix} \\begin{pmatrix} \\kappa_x  0 \\\\ 0  -\\kappa_x \\end{pmatrix} \\begin{pmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -\\sin \\theta  \\cos \\theta \\end{pmatrix} \\begin{pmatrix} \\kappa_x \\cos \\theta \\\\ -\\kappa_x \\sin \\theta \\end{pmatrix} = -\\kappa_x \\sin\\theta\\cos\\theta - \\kappa_x \\cos\\theta\\sin\\theta = -\\kappa_x \\sin(2\\theta)\n$$\n代入 $\\sin(2\\theta) = V/\\sqrt{U^2+V^2}$，我们得到：\n$$\n\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial x} \\rvert \\phi_2 \\rangle = -\\kappa_x \\frac{V}{\\sqrt{U^2+V^2}}\n$$\n耦合矢量的x分量则为：\n$$\nd_{12,x} = \\frac{-\\kappa_x V / \\sqrt{U^2+V^2}}{2\\sqrt{U^2+V^2}} = \\frac{-\\kappa_x V}{2(U^2+V^2)}\n$$\n通过相同的过程，y分量为：\n$$\nd_{12,y} = \\frac{-\\kappa_y V}{2(U^2+V^2)}\n$$\n耦合矢量大小的平方是：\n$$\n\\lVert \\mathbf{d}_{12} \\rVert^2 = d_{12,x}^2 + d_{12,y}^2 = \\left( \\frac{-\\kappa_x V}{2(U^2+V^2)} \\right)^2 + \\left( \\frac{-\\kappa_y V}{2(U^2+V^2)} \\right)^2 = \\frac{(\\kappa_x^2 + \\kappa_y^2)V^2}{4(U^2+V^2)^2}\n$$\n取平方根并代回 $U = \\kappa_x x + \\kappa_y y$，我们得到非绝热导数耦合大小的最终解析表达式：\n$$\n\\lVert \\mathbf{d}_{12}(x,y) \\rVert = \\frac{\\sqrt{\\kappa_x^2 + \\kappa_y^2} |V|}{2\\left( (\\kappa_x x + \\kappa_y y)^2 + V^2 \\right)}\n$$\n由于所有测试用例中给定的 $V$ 均为正数，因此 $|V|=V$。\n\n数值实现按以下步骤进行。对于每个测试用例：\n1.  在域 $[-x_{\\max}, x_{\\max}] \\times [-y_{\\max}, y_{\\max}]$ 上以间距 $\\Delta$ 构建一个均匀的笛卡尔坐标 $(x,y)$ 网格。这可以通过使用 `numpy.linspace` 生成坐标数组和 `numpy.meshgrid` 创建二维网格来高效完成。\n2.  在网格上的每个点评估 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ 的表达式。为提高效率，此计算是矢量化的：使用网格数组 `X` 和 `Y` 计算 $U$ 值的数组，然后用它来计算 $\\lVert \\mathbf{d}_{12} \\rVert$ 值的数组。\n3.  通过将得到的大小数组与阈值 $\\tau$ 进行比较，创建一个布尔掩码。\n4.  通过对布尔掩码的元素求和，可以找到满足条件 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert \\ge \\tau$ 的点的数量。\n5.  为每个测试用例存储最终的整数计数。\n\n这种方法是数值稳定的，因为当 $V0$ 时，分母 $((\\kappa_x x + \\kappa_y y)^2 + V^2)$ 严格为正。由于使用了直接的解析公式和矢量化操作，它的计算效率也很高。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of grid points where the magnitude of the nonadiabatic\n    derivative coupling exceeds a threshold for several test cases of a linear\n    vibronic coupling model.\n    \"\"\"\n    \n    # Test cases are tuples of the form:\n    # (kappa_x, kappa_y, V, tau, x_max, y_max, delta)\n    test_cases = [\n        (0.1, 0.1, 0.05, 1.0, 10.0, 10.0, 0.05),\n        (0.1, 0.1, 0.05, 1.5, 10.0, 10.0, 0.05),\n        (0.2, 0.05, 0.05, 0.5, 10.0, 10.0, 0.05),\n        (0.0, 0.0, 0.05, 0.01, 10.0, 10.0, 0.05),\n        (0.1, 0.1, 0.005, 10.0, 10.0, 10.0, 0.05),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        kappa_x, kappa_y, V, tau, x_max, y_max, delta = case\n\n        # Set up the computational grid.\n        # The number of points is calculated to ensure the spacing is delta.\n        # This is robust for cases where 2*x_max/delta is an integer.\n        nx = int(round(2 * x_max / delta)) + 1\n        ny = int(round(2 * y_max / delta)) + 1\n        x_coords = np.linspace(-x_max, x_max, nx)\n        y_coords = np.linspace(-y_max, y_max, ny)\n        \n        X, Y = np.meshgrid(x_coords, y_coords, indexing='ij')\n\n        # The analytical formula for the magnitude of the derivative coupling vector is:\n        # ||d_12|| = (sqrt(kappa_x^2 + kappa_y^2) * |V|) / (2 * ((kappa_x*x + kappa_y*y)^2 + V^2))\n        \n        # Vectorized calculation over the entire grid.\n        # Term U simplifies the expression\n        U = kappa_x * X + kappa_y * Y\n        \n        # Numerator is constant over the grid\n        numerator = np.sqrt(kappa_x**2 + kappa_y**2) * V\n        \n        # Denominator depends on grid position\n        denominator = 2 * (U**2 + V**2)\n        \n        # Handle the case where the numerator is zero to prevent 0/0 if V=0.\n        # This also correctly handles the kappa_x = kappa_y = 0 case.\n        if numerator == 0.0:\n            d_mag = np.zeros_like(X)\n        else:\n            d_mag = numerator / denominator\n        \n        # Count the number of grid points where the magnitude exceeds the threshold\n        count = np.sum(d_mag >= tau)\n        \n        results.append(int(count))\n\n    # Print the final list of counts in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们刚刚探讨过的非绝热耦合，会直接影响电子波函数随时间的演化。本练习将应用含时薛定谔方程，在一个微小的时间步长内来量化这一影响。通过计算，您将看到系统电子态的布居数如何从初始状态开始发生变化，从而为理解表面跳跃概率的计算打下基础。",
            "id": "3811679",
            "problem": "一个双态分子系统使用最少切换表面跳跃 (FSSH) 算法进行演化，其中原子核遵循经典轨迹，而电子振幅则沿该轨迹进行量子力学演化。考虑绝热表象，其中电子态为 $\\{|\\phi_{1}(\\mathbf{R})\\rangle, |\\phi_{2}(\\mathbf{R})\\rangle\\}$，绝热能为 $E_{1}=0$ 和 $E_{2}=0.1$ eV，初始电子态由系数 $c_{1}(0)=1$ 和 $c_{2}(0)=0$ 指定。核速度大小为 $|\\mathbf{v}|=0.5$ \\AA/fs。非绝热耦合矢量的定义为 $\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$，并且在所考虑的时间窗口内，其沿轨迹的投影满足 $\\mathbf{v}\\cdot\\mathbf{d}_{12}=0.02$ fs$^{-1}$。假设绝热电子态被选为实函数，因此 $\\mathbf{d}_{jk}\\in\\mathbb{R}$ 且 $\\mathbf{d}_{jk}=-\\mathbf{d}_{kj}$，并假设绝热能和非绝热耦合在短时间间隔 $\\Delta t=0.2$ fs 内均为常数。\n\n从沿经典轨迹的电子振幅的含时薛定谔方程出发，计算到 $\\Delta t$ 的领头非平庸阶，推导态2的电子布居数变化 $\\Delta |c_{2}|^{2}=|c_{2}(\\Delta t)|^{2}-|c_{2}(0)|^{2}$ 的表达式，并利用给定数据计算其值。将最终答案表示为一个无量纲数。如果对最终数值进行近似，请使用标准科学记数法，除为清晰表示计算值所必需的四舍五入外，无需额外舍入。",
            "solution": "### 步骤1：提取已知条件\n- 系统：一个$2$态分子系统。\n- 算法：最少切换表面跳跃 (FSSH)。\n- 绝热表象：电子态 $\\{|\\phi_{1}(\\mathbf{R})\\rangle, |\\phi_{2}(\\mathbf{R})\\rangle\\}$。\n- 绝热能：$E_{1}=0$ eV, $E_{2}=0.1$ eV。\n- 初始电子态系数：$c_{1}(0)=1$, $c_{2}(0)=0$。\n- 核速度大小：$|\\mathbf{v}|=0.5$ Å/fs。\n- 非绝热耦合矢量定义：$\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$。\n- 投影的非绝热耦合：$\\mathbf{v}\\cdot\\mathbf{d}_{12}=0.02$ fs$^{-1}$。\n- 耦合性质：$\\mathbf{d}_{jk}\\in\\mathbb{R}$ 且 $\\mathbf{d}_{jk}=-\\mathbf{d}_{kj}$。\n- 时间间隔：$\\Delta t=0.2$ fs。\n- 假设：在 $\\Delta t$ 内绝热能和非绝热耦合为常数。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。它描述了电子态振幅沿经典核轨迹的演化，这是非绝热分子动力学中的一个核心概念，特别是在表面跳跃算法的框架内。其控制方程，即绝热基下的含时薛定谔方程 (TDSE)，以及非绝热耦合矢量的定义，都是该领域的标准内容。\n\n该问题是适定的。它提供了一套完整的初始条件、参数和简化假设（在时间步长内能量和耦合保持不变），从而可以计算出一个唯一的、有意义的量 $\\Delta |c_{2}|^{2}$，并达到所要求的近似阶数。\n\n该问题是客观的。其语言技术性强且精确，没有任何主观或模棱两可的陈述。所有术语在理论化学和物理学的背景下都有明确的定义。所提供的数值对于经历非绝热事件的分子系统来说是物理上合理的。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个将短时近似应用于电子振幅的TDSE的标准练习，是理解非绝热动力学模拟的一项核心技能。我将继续进行求解。\n\n电子态振幅 $c_{j}(t)$ 沿经典核轨迹 $\\mathbf{R}(t)$ 的演化由绝热基下的含时薛定谔方程决定：\n$$ i\\hbar \\frac{dc_j(t)}{dt} = \\sum_k c_k(t) \\left( E_k(\\mathbf{R}(t)) \\delta_{jk} - i\\hbar \\dot{\\mathbf{R}} \\cdot \\mathbf{d}_{jk}(\\mathbf{R}(t)) \\right) $$\n其中 $\\hbar$ 是约化普朗克常数，$E_k$ 是绝热电子能，$\\delta_{jk}$ 是克罗内克δ函数，$\\dot{\\mathbf{R}} = \\mathbf{v}$ 是核速度，而 $\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$ 是态 $j$ 和 $k$ 之间的非绝热耦合矢量。\n\n对于给定的$2$态系统，其中 $j, k \\in \\{1, 2\\}$，耦合方程为：\n$$ i\\hbar \\frac{dc_1}{dt} = c_1 E_1 - i\\hbar c_2 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n$$ i\\hbar \\frac{dc_2}{dt} = c_2 E_2 - i\\hbar c_1 (\\mathbf{v}\\cdot\\mathbf{d}_{21}) $$\n利用实波函数具有 $\\mathbf{d}_{21} = -\\mathbf{d}_{12}$ 的性质，并除以 $i\\hbar$，我们得到：\n$$ \\frac{dc_1}{dt} = -\\frac{i}{\\hbar}E_1 c_1 - c_2 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n$$ \\frac{dc_2}{dt} = -\\frac{i}{\\hbar}E_2 c_2 + c_1 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n我们需要在短时间间隔 $\\Delta t$ 内求解这些系数，初始条件为 $c_1(0)=1$ 和 $c_2(0)=0$。问题要求解到 $\\Delta t$ 的领头非平庸阶。这可以通过对微分方程进行一阶前向欧拉积分得到，这等价于解的一阶泰勒级数展开。\n\n让我们对 $c_2(t)$ 的方程从 $t=0$ 积分到 $t=\\Delta t$：\n$$ \\int_{0}^{\\Delta t} \\frac{dc_2}{dt} dt = \\int_{0}^{\\Delta t} \\left(-\\frac{i}{\\hbar}E_2 c_2(t) + c_1(t) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) dt $$\n$$ c_2(\\Delta t) - c_2(0) = \\int_{0}^{\\Delta t} \\left(-\\frac{i}{\\hbar}E_2 c_2(t) + c_1(t) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) dt $$\n对于一个小的时间步长 $\\Delta t$，我们可以使用 $t=0$ 时的系数值来近似被积函数。这对应于展开中的领头阶项。已知在该区间内 $E_2$ 和 $\\mathbf{v}\\cdot\\mathbf{d}_{12}$ 是常数。\n$$ c_2(\\Delta t) - c_2(0) \\approx \\left(-\\frac{i}{\\hbar}E_2 c_2(0) + c_1(0) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) \\Delta t $$\n代入初始条件 $c_1(0)=1$ 和 $c_2(0)=0$：\n$$ c_2(\\Delta t) - 0 \\approx \\left(-\\frac{i}{\\hbar}E_2 \\cdot 0 + 1 \\cdot (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) \\Delta t $$\n$$ c_2(\\Delta t) \\approx (\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t $$\n这是 $c_2(\\Delta t)$ 的领头非平庸阶（$\\Delta t$ 的一阶）表达式。\n\n我们感兴趣的量是态2的布居数变化，即 $\\Delta |c_{2}|^{2} = |c_{2}(\\Delta t)|^{2} - |c_{2}(0)|^{2}$。\n给定 $c_2(0)=0$，我们有 $|c_2(0)|^2 = 0$。因此，\n$$ \\Delta |c_2|^2 = |c_2(\\Delta t)|^2 $$\n使用我们为 $c_2(\\Delta t)$ 推导的领头阶表达式：\n$$ \\Delta |c_2|^2 \\approx |(\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t|^2 $$\n问题说明 $\\mathbf{d}_{jk} \\in \\mathbb{R}$，这意味着 $\\mathbf{v}\\cdot\\mathbf{d}_{12}$ 是一个实数。时间步长 $\\Delta t$ 也是实数。因此，该表达式是实数，其模的平方就是它的平方：\n$$ \\Delta |c_2|^2 \\approx ((\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t)^2 $$\n这个表达式代表了布居数变化的领头非平庸阶，它是 $(\\Delta t)^2$ 阶的。绝热能 $E_1$ 和 $E_2$ 对这个领头阶项没有贡献；它们将首先出现在 $c_2(\\Delta t)$ 的高阶修正中，并因此出现在布居数变化的 $(\\Delta t)^4$ 阶或更高阶项中。\n\n现在我们代入给定的数值：\n- $\\mathbf{v}\\cdot\\mathbf{d}_{12} = 0.02$ fs$^{-1}$\n- $\\Delta t = 0.2$ fs\n\n乘积 $(\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t$ 为：\n$$ (\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t = (0.02 \\text{ fs}^{-1}) \\times (0.2 \\text{ fs}) = 0.004 $$\n这个乘积是无量纲的，正如对电子态系数所预期的那样。\n那么布居数的变化是：\n$$ \\Delta |c_2|^2 \\approx (0.004)^2 = 0.000016 $$\n用标准科学记数法表示该值为 $1.6 \\times 10^{-5}$。\n最终推导出的布居数变化表达式为 $\\Delta |c_{2}|^{2} = ((\\mathbf{v}\\cdot\\mathbf{d}_{12})\\Delta t)^{2}$。\n计算值为 $(0.02 \\times 0.2)^{2} = 1.6 \\times 10^{-5}$。",
            "answer": "$$\\boxed{1.6 \\times 10^{-5}}$$"
        },
        {
            "introduction": "当电子态演化并随机触发一次跳跃后，算法必须确保体系的总能量守恒，这是维持物理真实性的关键。在最少切换表面跳跃（FSSH）算法中，这通常通过调整原子核的动能来实现。本练习将带您完成这一关键的能量守恒检查和动量重标度步骤，深入理解FSSH算法的核心机制之一。",
            "id": "3811686",
            "problem": "考虑在最少开关表面跳跃（FSSH）框架下的一个双态非绝热跃迁，其中质量为 $M$ 的经典原子核在绝热电子势能面 $E_1(\\mathbf{R})$ 和 $E_2(\\mathbf{R})$ 上运动。在固定的原子核位置 $\\mathbf{R}$ 处，从态 1 跳跃到态 2 会使电子能量改变 $\\Delta E \\equiv E_2(\\mathbf{R}) - E_1(\\mathbf{R})$。在 FSSH 中，通过仅重新标定原子核动量沿着非绝热耦合方向的分量，来实现在跳跃瞬间的总能量守恒。设非绝热耦合方向与当前原子核动量 $\\mathbf{P}$ 对齐，因此重标定完全沿着 $\\mathbf{P}$ 方向作用。\n\n从经典动能 $K = \\frac{|\\mathbf{P}|^2}{2M}$ 的定义和跳跃时总能量守恒的要求出发，确定对于以下参数，跃迁 $1 \\to 2$ 在能量上是否被允许：\n- $\\Delta E = 0.08\\,\\mathrm{eV}$，\n- $M = 10\\,\\mathrm{amu}$，\n- $|\\mathbf{P}| = 5\\,\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$，\n- 非绝热耦合方向与 $\\mathbf{P}$ 对齐。\n\n假设仅当沿重标定方向可用的动能足以补偿电子能量的增加时，跳跃才被允许，并且如果允许，新的动量大小 $|\\mathbf{P}'|$ 是通过仅沿耦合方向重标定的能量守恒得到的。使用以下基本常数：$1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$，$1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$，$1\\,\\mathrm{fs} = 1.0 \\times 10^{-15}\\,\\mathrm{s}$，以及 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n\n将你的最终答案表示为一个行矩阵 $\\begin{pmatrix} a  b \\end{pmatrix}$，其中如果跳跃被允许，则 $a$ 为 1，否则为 0，而 $b$ 是重标定后的动量大小 $|\\mathbf{P}'|$，单位为 $\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$。将 $b$ 四舍五入到四位有效数字。最终的方框答案中不包含任何单位。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- **系统**：双态非绝热跃迁。\n- **算法**：最少开关表面跳跃（FSSH）。\n- **粒子**：质量为 $M$ 的经典原子核。\n- **势能面**：绝热电子势能面 $E_1(\\mathbf{R})$ 和 $E_2(\\mathbf{R})$。\n- **跃迁**：从态 1 跳跃到态 2。\n- **电子能量变化**：$\\Delta E \\equiv E_2(\\mathbf{R}) - E_1(\\mathbf{R}) = 0.08\\,\\mathrm{eV}$。\n- **质量**：$M = 10\\,\\mathrm{amu}$。\n- **初始动量**：$|\\mathbf{P}| = 5\\,\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$。\n- **动量重标定规则**：通过重新标定原子核动量沿非绝热耦合方向的分量来保持总能量守恒。\n- **特殊条件**：非绝热耦合方向与当前原子核动量 $\\mathbf{P}$ 对齐。\n- **跳跃条件**：当且仅当沿重标定方向的动能足以弥补电子能量增量 $\\Delta E$ 时，跳跃才被允许。\n- **常数**：$1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$，$1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$，$1\\,\\mathrm{fs} = 1.0 \\times 10^{-15}\\,\\mathrm{s}$，以及 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n- **要求输出**：一个行矩阵 $\\begin{pmatrix} a  b \\end{pmatrix}$，其中如果跳跃被允许则 $a=1$（否则 $a=0$），$b$ 是最终的动量大小 $|\\mathbf{P}'|$，单位为 $\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$，保留四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题在计算化学理论，特别是非绝热分子动力学方面有坚实的基础。FSSH 是一种标准且广泛使用的算法。能量守恒和动量重标定的原则是其构成的核心。\n- **适定性**：该问题是适定的。它提供了所有必要的数据和一个清晰、明确的准则来确定结果。可以计算出唯一的解。\n- **客观性**：问题以客观、定量的术语陈述，没有主观或含糊的语言。\n- **完整性与一致性**：给定的条件集合是完整的且内部一致。动量和耦合矢量平行的特殊条件简化了计算，但没有引入矛盾。\n- **现实性**：提供的质量、动量和能量参数在分子模拟的实际范围内。\n\n**步骤 3：结论与行动**\n该问题被认为是有效的。将提供解答。\n\n**求解过程**\n在跳跃之前，当电子态为 1 时，系统的总能量是势能 $E_1(\\mathbf{R})$ 和原子核动能 $K_1$ 的和：\n$$E_{tot, 1} = E_1(\\mathbf{R}) + K_1$$\n动能由 $K_1 = \\frac{|\\mathbf{P}|^2}{2M}$ 给出。\n\n成功跳跃到态 2 后，总能量为：\n$$E_{tot, 2} = E_2(\\mathbf{R}) + K_2$$\n其中 $K_2 = \\frac{|\\mathbf{P}'|^2}{2M}$ 是与重标定后的动量 $\\mathbf{P}'$ 相应的新动能。\n\nFSSH 算法要求在跳跃瞬间总能量守恒，所以 $E_{tot, 1} = E_{tot, 2}$。\n$$E_1(\\mathbf{R}) + K_1 = E_2(\\mathbf{R}) + K_2$$\n重新整理以求解最终动能 $K_2$：\n$$K_2 = K_1 - (E_2(\\mathbf{R}) - E_1(\\mathbf{R})) = K_1 - \\Delta E$$\n向更高势能的态（$\\Delta E  0$）的跳跃在能量上是可能的，当且仅当最终动能 $K_2$ 非负。这给出了允许跳跃的条件：\n$$K_2 \\ge 0 \\implies K_1 - \\Delta E \\ge 0 \\implies K_1 \\ge \\Delta E$$\n问题陈述，沿重标定方向可用的动能必须足够。由于非绝热耦合方向与动量 $\\mathbf{P}$ 对齐，因此全部动能 $K_1$ 都可用于此交换。\n\n为了检验这个条件，我们必须计算初始动能 $K_1$ 并将其与 $\\Delta E$ 进行比较。单位必须一致。我们将所有量转换为一个一致的能量单位，即电子伏特（$\\mathrm{eV}$）。\n\n首先，我们用其原生单位 $\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2$ 计算 $K_1$：\n$$K_1 = \\frac{|\\mathbf{P}|^2}{2M} = \\frac{(5\\,\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs})^2}{2(10\\,\\mathrm{amu})} = \\frac{25}{20}\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2 = 1.25\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2$$\n\n接下来，我们找到从 $\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2$ 到焦耳（$\\mathrm{J}$），然后再到电子伏特（$\\mathrm{eV}$）的转换因子。\n$$1\\,\\mathrm{\\AA}/\\mathrm{fs} = \\frac{10^{-10}\\,\\mathrm{m}}{10^{-15}\\,\\mathrm{s}} = 10^5\\,\\mathrm{m/s}$$\n$$1\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2 = (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) \\cdot (10^5\\,\\mathrm{m/s})^2$$\n$$= 1.66053906660 \\times 10^{-17}\\,\\mathrm{J}$$\n现在，使用 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$ 将其转换为 $\\mathrm{eV}$：\n$$\\frac{1.66053906660 \\times 10^{-17}\\,\\mathrm{J}}{1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}} \\approx 103.642696\\,\\mathrm{eV}$$\n所以，$1\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2 \\approx 103.642696\\,\\mathrm{eV}$。\n\n现在，我们可以用 $\\mathrm{eV}$ 表示 $K_1$：\n$$K_1 = 1.25 \\times 103.642696\\,\\mathrm{eV} \\approx 129.55337\\,\\mathrm{eV}$$\n\n我们将其与所需的能量增量 $\\Delta E$ 进行比较：\n$$K_1 \\approx 129.55\\,\\mathrm{eV}$$\n$$\\Delta E = 0.08\\,\\mathrm{eV}$$\n因为 $K_1  \\Delta E$，所以在能量上允许跳跃。因此，答案的第一部分是 $a=1$。\n\n接下来，我们计算重标定动量的大小 $|\\mathbf{P}'|$。根据能量守恒关系：\n$$K_2 = K_1 - \\Delta E$$\n由于 $K \\propto |\\mathbf{P}|^2$，我们可以写出：\n$$\\frac{|\\mathbf{P}'|^2}{2M} = \\frac{|\\mathbf{P}|^2}{2M} - \\Delta E$$\n这导致：\n$$\\frac{|\\mathbf{P}'|^2}{|\\mathbf{P}|^2} = 1 - \\frac{\\Delta E}{K_1}$$\n$$|\\mathbf{P}'| = |\\mathbf{P}| \\sqrt{1 - \\frac{\\Delta E}{K_1}}$$\n代入以 $\\mathrm{eV}$ 为单位的值：\n$$|\\mathbf{P}'| = 5 \\sqrt{1 - \\frac{0.08}{129.55337}} \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\sqrt{1 - 0.00061750...} \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\sqrt{0.99938249...} \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\times 0.99969119... \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| \\approx 4.9984559... \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n将此结果四舍五入到四位有效数字，得到 $b = 4.998$。\n\n最终答案是行矩阵 $\\begin{pmatrix} a  b \\end{pmatrix} = \\begin{pmatrix} 1  4.998 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  4.998\n\\end{pmatrix}\n}\n$$"
        }
    ]
}