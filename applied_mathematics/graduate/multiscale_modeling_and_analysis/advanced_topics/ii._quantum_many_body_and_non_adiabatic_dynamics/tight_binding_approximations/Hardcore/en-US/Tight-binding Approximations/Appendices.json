{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration with the most fundamental system in tight-binding theory: a one-dimensional chain of atoms. This exercise guides you through the process of translating this physical system into a concrete mathematical object, the Hamiltonian matrix, for a finite number of atoms. By constructing the matrix for both open and periodic boundary conditions, you will gain a firsthand understanding of how the system's topology is encoded in the Hamiltonian and how it directly influences the resulting energy spectrum . Solving this canonical problem provides an exact analytical solution that serves as a crucial benchmark for all further studies.",
            "id": "3824015",
            "problem": "Consider a one-dimensional lattice of $N$ sites with a single orbital per site. In the tight-binding (TB) approximation, assume a uniform onsite energy $\\epsilon$ and a uniform nearest-neighbor hopping amplitude $t$. Starting from the definition of the tight-binding Hamiltonian built on an orthonormal set of localized orbitals $\\{|i\\rangle\\}_{i=1}^{N}$, construct the finite $N\\times N$ Hamiltonian matrix for two boundary-condition scenarios: (i) an open chain and (ii) a periodic chain. For each case, state clearly the nonzero matrix elements and discuss the sparsity pattern, including how boundary conditions alter the pattern. Then, by solving the resulting discrete eigenvalue problems under the respective boundary conditions, obtain the full set of eigenvalues in closed form for each case. Finally, focusing on the open chain, derive a closed-form analytic expression for the determinant of its TB Hamiltonian matrix as a function of $N$, $\\epsilon$, and $t$, assuming $t\\neq 0$. Express the final answer as a single closed-form analytic expression with no units and no numerical approximation.",
            "solution": "The problem statement is well-posed, scientifically grounded, and internally consistent. It presents a standard, canonical problem in condensed matter physics concerning the tight-binding model for a one-dimensional system. All provided information is sufficient and necessary for a complete derivation. We will proceed with the solution.\n\nThe tight-binding Hamiltonian $\\hat{H}$ is defined by its matrix elements in the basis of localized orthonormal orbitals $\\{|i\\rangle\\}_{i=1}^{N}$, where $\\langle i | j \\rangle = \\delta_{ij}$. The matrix elements are given by:\n$H_{ii} = \\langle i | \\hat{H} | i \\rangle = \\epsilon$ (onsite energy).\n$H_{ij} = \\langle i | \\hat{H} | j \\rangle = t$ if sites $i$ and $j$ are nearest neighbors (hopping amplitude).\n$H_{ij} = \\langle i | \\hat{H} | j \\rangle = 0$ otherwise.\nSince the Hamiltonian must be Hermitian, we assume $\\epsilon$ and $t$ are real-valued parameters.\n\n**Case (i): Open Chain (Open Boundary Conditions)**\n\nFor an open one-dimensional chain of $N$ sites, the sites are labeled $i = 1, 2, \\dots, N$. The nearest neighbors of site $i$ are $i-1$ and $i+1$, with the exceptions of site $1$ (only neighbor is $2$) and site $N$ (only neighbor is $N-1$).\n\nThe nonzero matrix elements of the $N \\times N$ Hamiltonian matrix, $H_{\\text{open}}$, are:\n$$(H_{\\text{open}})_{ii} = \\epsilon \\quad \\text{for } i = 1, \\dots, N$$\n$$(H_{\\text{open}})_{i, i+1} = (H_{\\text{open}})_{i+1, i} = t \\quad \\text{for } i = 1, \\dots, N-1$$\nThis structure results in a symmetric, tridiagonal matrix:\n$$H_{\\text{open}} = \\begin{pmatrix}\n\\epsilon  t  0  \\dots  0  0 \\\\\nt  \\epsilon  t  \\dots  0  0 \\\\\n0  t  \\epsilon  \\ddots  \\vdots  \\vdots \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  t  0 \\\\\n0  0  \\dots  t  \\epsilon  t \\\\\n0  0  \\dots  0  t  \\epsilon\n\\end{pmatrix}$$\nThe sparsity pattern is tridiagonal. The matrix is sparse, containing only $N$ diagonal elements and $2(N-1)$ off-diagonal elements, for a total of $3N-2$ nonzero entries out of $N^2$.\n\nTo find the eigenvalues $E$, we solve the eigenvalue equation $H_{\\text{open}}\\boldsymbol{\\psi} = E\\boldsymbol{\\psi}$, where $\\boldsymbol{\\psi}$ is an eigenvector with components $\\psi_j = \\langle j | \\boldsymbol{\\psi} \\rangle$. This yields a system of linear equations:\n$$t\\psi_{j-1} + \\epsilon\\psi_j + t\\psi_{j+1} = E\\psi_j \\quad \\text{for } j=2, \\dots, N-1$$\nsubject to the boundary conditions arising from the first and last rows of the matrix:\n$$\\epsilon\\psi_1 + t\\psi_2 = E\\psi_1$$\n$$t\\psi_{N-1} + \\epsilon\\psi_N = E\\psi_N$$\nThese boundary equations can be incorporated into the general equation by defining fictitious sites $j=0$ and $j=N+1$ and imposing the conditions $\\psi_0 = 0$ and $\\psi_{N+1} = 0$.\n\nThe general equation can be rewritten as a finite-difference equation:\n$$t(\\psi_{j-1} + \\psi_{j+1}) = (E - \\epsilon)\\psi_j$$\nWe propose an ansatz of the form of a standing wave, $\\psi_j = A \\sin(kj)$, which is motivated by the boundary conditions. Substituting this into the difference equation:\n$$t(A\\sin(k(j-1)) + A\\sin(k(j+1))) = (E - \\epsilon)A\\sin(kj)$$\n$$t(\\sin(kj)\\cos(k) - \\cos(kj)\\sin(k) + \\sin(kj)\\cos(k) + \\cos(kj)\\sin(k)) = (E - \\epsilon)\\sin(kj)$$\n$$2t\\cos(k)\\sin(kj) = (E - \\epsilon)\\sin(kj)$$\nThis yields the dispersion relation $E = \\epsilon + 2t\\cos(k)$. The boundary condition $\\psi_0 = A\\sin(k \\cdot 0) = 0$ is automatically satisfied. The condition $\\psi_{N+1} = A\\sin(k(N+1)) = 0$ quantizes the wavevector $k$:\n$$k(N+1) = m\\pi \\implies k_m = \\frac{m\\pi}{N+1}$$\nwhere $m$ is an integer. To obtain $N$ unique, non-trivial eigenvectors, we choose the values $m = 1, 2, \\dots, N$. The value $m=0$ gives the trivial solution $\\psi_j=0$.\n\nThe full set of $N$ distinct eigenvalues for the open chain is:\n$$E_m^{\\text{open}} = \\epsilon + 2t\\cos\\left(\\frac{m\\pi}{N+1}\\right) \\quad \\text{for } m=1, 2, \\dots, N$$\n\n**Case (ii): Periodic Chain (Periodic Boundary Conditions)**\n\nFor a periodic chain, the sites form a ring, meaning site $N$ is connected back to site $1$.\n\nThe nonzero matrix elements of the $N \\times N$ Hamiltonian, $H_{\\text{periodic}}$, are:\n$$(H_{\\text{periodic}})_{ii} = \\epsilon \\quad \\text{for } i = 1, \\dots, N$$\n$$(H_{\\text{periodic}})_{i, i+1} = (H_{\\text{periodic}})_{i+1, i} = t \\quad \\text{for } i = 1, \\dots, N-1$$\n$$(H_{\\text{periodic}})_{1, N} = (H_{\\text{periodic}})_{N, 1} = t$$\nThis structure forms a symmetric, circulant matrix:\n$$H_{\\text{periodic}} = \\begin{pmatrix}\n\\epsilon  t  0  \\dots  0  t \\\\\nt  \\epsilon  t  \\dots  0  0 \\\\\n0  t  \\epsilon  \\ddots  \\vdots  \\vdots \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  t  0 \\\\\n0  0  \\dots  t  \\epsilon  t \\\\\nt  0  \\dots  0  t  \\epsilon\n\\end{pmatrix}$$\nThe sparsity pattern is altered from the open case by the addition of the two corner elements $(H_{\\text{periodic}})_{1,N}$ and $(H_{\\text{periodic}})_{N,1}$. This matrix has $3N$ nonzero elements.\n\nThe eigenvalue equation $H_{\\text{periodic}}\\boldsymbol{\\psi} = E\\boldsymbol{\\psi}$ must satisfy periodic boundary conditions, $\\psi_{j+N} = \\psi_j$. The set of equations is $t\\psi_{j-1} + \\epsilon\\psi_j + t\\psi_{j+1} = E\\psi_j$, where all indices are taken modulo $N$.\nWe use a traveling wave ansatz consistent with Bloch's theorem, $\\psi_j = A e^{ikj}$. Substituting this into the general equation yields the same dispersion relation as before:\n$$t(e^{-ik} + e^{ik}) + \\epsilon = E \\implies E = \\epsilon + 2t\\cos(k)$$\nThe periodic boundary condition $\\psi_{j+N} = \\psi_j$ implies $e^{ik(j+N)} = e^{ikj}$, which gives $e^{ikN} = 1$. This quantizes the wavevector $k$:\n$$kN = 2\\pi m \\implies k_m = \\frac{2\\pi m}{N}$$\nwhere $m$ is an integer. A set of $N$ unique wavevectors is obtained by choosing $m = 0, 1, \\dots, N-1$.\n\nThe full set of $N$ eigenvalues for the periodic chain (some of which may be degenerate) is:\n$$E_m^{\\text{periodic}} = \\epsilon + 2t\\cos\\left(\\frac{2\\pi m}{N}\\right) \\quad \\text{for } m=0, 1, \\dots, N-1$$\n\n**Determinant of the Open Chain Hamiltonian**\n\nTo find the determinant of $H_{\\text{open}}$, let $D_N = \\det(H_{\\text{open}})$. We can establish a recurrence relation by cofactor expansion along the first row:\n$$D_N = \\epsilon \\cdot D_{N-1} - t \\cdot \\det\\begin{pmatrix}\nt  t  0  \\dots \\\\\n0  \\epsilon  t  \\dots \\\\\n0  t  \\ddots  \\dots \\\\\n\\vdots  \\vdots  \n\\end{pmatrix}_{(N-1) \\times (N-1)}$$\nThe determinant of the second matrix is $t \\cdot D_{N-2}$. This gives the linear homogeneous recurrence relation:\n$$D_N = \\epsilon D_{N-1} - t^2 D_{N-2}$$\nwith initial conditions $D_1 = \\epsilon$ and $D_2 = \\epsilon^2 - t^2$. We can define $D_0=1$ for consistency ($D_2 = \\epsilon D_1 - t^2 D_0 = \\epsilon^2 - t^2$).\n\nThis recurrence relation can be solved using its characteristic equation $r^2 - \\epsilon r + t^2 = 0$. Let $\\epsilon = 2t\\cos\\theta$. The roots are $r_{1,2} = t(\\cos\\theta \\pm i\\sin\\theta) = t e^{\\pm i\\theta}$.\nThe general solution is $D_N = A(t e^{i\\theta})^N + B(t e^{-i\\theta})^N$. Using the initial conditions $D_0=1$ and $D_1=\\epsilon$ to solve for $A$ and $B$, we find:\n$$D_N = t^N \\frac{\\sin((N+1)\\theta)}{\\sin\\theta}$$\nwhere $\\theta = \\arccos(\\epsilon/(2t))$.\nThis result is directly related to the Chebyshev polynomials of the second kind, $U_N(x)$, for which $U_N(\\cos\\theta) = \\frac{\\sin((N+1)\\theta)}{\\sin\\theta}$.\nTherefore, with $x = \\epsilon/(2t)$, we have:\n$$D_N = t^N U_N\\left(\\frac{\\epsilon}{2t}\\right)$$\nThis formula is succinct and holds for any real $\\epsilon$ and $t \\neq 0$. If $|\\epsilon/(2t)| > 1$, the argument of $U_N$ is outside $[-1,1]$, and the function is defined through the same recurrence, equivalent to a hyperbolic form. The expression in terms of $U_N$ is the most general closed form.",
            "answer": "$$\\boxed{t^N U_N\\left(\\frac{\\epsilon}{2t}\\right)}$$"
        },
        {
            "introduction": "Building upon the monatomic chain, this practice introduces a new layer of complexity and physical realism: a chain with a two-atom basis in its unit cell. This is a crucial step towards modeling real-world materials, such as binary compounds or polymers like polyacetylene. You will construct the momentum-space Bloch Hamiltonian, which is now a $2 \\times 2$ matrix, and discover how the difference in on-site energies between the two atoms opens a band gap at the edge of the Brillouin zone . Mastering this problem provides a deep, intuitive understanding of the origin of band gaps, a concept that forms the bedrock of semiconductor physics.",
            "id": "3824045",
            "problem": "Consider a one-dimensional crystalline chain with a two-site basis per unit cell of length $a$. Let the two inequivalent sites be labeled $A$ and $B$, with onsite energies $\\epsilon_{A}$ and $\\epsilon_{B}$, respectively. Assume nearest-neighbor hopping of uniform amplitude $t$ that connects each $A$ site to its two neighboring $B$ sites (one within the same unit cell and one in the adjacent unit cell), and similarly each $B$ site to its neighboring $A$ sites. You may take $t$ to be real. The system is perfectly periodic, so Bloch’s theorem applies.\n\nStarting from the real-space tight-binding Hamiltonian and using Bloch’s theorem as the fundamental base, construct the Bloch Hamiltonian in reciprocal space for wavevector $k$ in the first Brillouin zone (BZ), derive the two energy bands, and then compute the direct band gap at the crystal momentum $k=\\pi/a$. Define $\\Delta=\\epsilon_{A}-\\epsilon_{B}$ and express the final band gap at $k=\\pi/a$ as a single closed-form expression in terms of $\\Delta$ and $t$. Provide the final expression only; no derivation is required in the final answer box.",
            "solution": "We model the one-dimensional chain with a two-site basis $\\{|n,A\\rangle, |n,B\\rangle\\}$, where $n$ labels the unit cell and $A, B$ label the sites within the cell. The on-site energies are $\\epsilon_A$ and $\\epsilon_B$. Each $A$ site is connected to its neighboring $B$ sites, and vice-versa, with a uniform real hopping amplitude $t$.\n\nThe real-space Hamiltonian can be written as:\n$$ \\hat{H} = \\sum_n \\left( \\epsilon_A |n,A\\rangle\\langle n,A| + \\epsilon_B |n,B\\rangle\\langle n,B| \\right) + t \\sum_n \\left( |n,A\\rangle\\langle n,B| + |n+1,A\\rangle\\langle n,B| + \\text{h.c.} \\right) $$\nwhere h.c. denotes the Hermitian conjugate.\n\nWe use Bloch's theorem to construct symmetry-adapted basis states for a given wavevector $k$:\n$$|k,A\\rangle = \\frac{1}{\\sqrt{N}}\\sum_n e^{ikna}|n,A\\rangle$$\n$$|k,B\\rangle = \\frac{1}{\\sqrt{N}}\\sum_n e^{ikna}|n,B\\rangle$$\nThe Bloch Hamiltonian $H(k)$ is a $2\\times2$ matrix in the basis $\\{|k,A\\rangle, |k,B\\rangle\\}$. Its elements are $H_{\\alpha\\beta}(k) = \\langle k,\\alpha|\\hat{H}|k,\\beta\\rangle$.\n\nThe diagonal elements are the on-site energies:\n$$H_{AA}(k) = \\epsilon_A$$\n$$H_{BB}(k) = \\epsilon_B$$\n\nThe off-diagonal element $H_{AB}(k)$ is the Fourier transform of the real-space hopping terms connecting $A$ sites to $B$ sites. A $B$ site in cell $m$, $|m,B\\rangle$, is connected to an $A$ site in the same cell, $|m,A\\rangle$, and an $A$ site in the next cell, $|m+1,A\\rangle$. So, $\\langle n,A|\\hat{H}|m,B\\rangle = t(\\delta_{nm} + \\delta_{n,m+1})$.\n$$H_{AB}(k) = \\frac{1}{N}\\sum_{n,m}e^{ik(m-n)a} \\langle n,A|\\hat{H}|m,B\\rangle = \\frac{1}{N}\\sum_m \\left( e^{ik(m-m)a}t + e^{ik(m-(m+1))a}t \\right) = t(1+e^{-ika})$$\nSince the Hamiltonian is Hermitian, $H_{BA}(k) = H_{AB}(k)^* = t(1+e^{ika})$.\n\nThe Bloch Hamiltonian is:\n$$ H(k) = \\begin{pmatrix} \\epsilon_A  t(1+e^{-ika}) \\\\ t(1+e^{ika})  \\epsilon_B \\end{pmatrix} $$\n\nThe energy bands $E(k)$ are the eigenvalues of $H(k)$, found by solving the characteristic equation $\\det(H(k) - E \\cdot I) = 0$. The eigenvalues of a generic $2\\times2$ Hermitian matrix $\\begin{pmatrix} a  c \\\\ c^*  b \\end{pmatrix}$ are $\\frac{a+b}{2} \\pm \\sqrt{(\\frac{a-b}{2})^2 + |c|^2}$.\nHere, $a = \\epsilon_A$, $b = \\epsilon_B$, and $|c|^2 = |t(1+e^{-ika})|^2 = t^2(1+e^{-ika})(1+e^{ika}) = t^2(2+2\\cos(ka)) = 4t^2\\cos^2(ka/2)$.\nDefining $\\bar{\\epsilon} = (\\epsilon_A+\\epsilon_B)/2$ and $\\Delta = \\epsilon_A-\\epsilon_B$, the two energy bands are:\n$$ E_{\\pm}(k) = \\bar{\\epsilon} \\pm \\sqrt{\\left(\\frac{\\Delta}{2}\\right)^2 + 4t^2\\cos^2(ka/2)} $$\n\nThe direct band gap at a given $k$ is $\\text{Gap}(k) = E_+(k) - E_-(k)$. We are asked to compute this at the edge of the first Brillouin zone, $k = \\pi/a$.\n$$ \\text{Gap}(k=\\pi/a) = E_+(\\pi/a) - E_-(\\pi/a) = 2 \\sqrt{\\left(\\frac{\\Delta}{2}\\right)^2 + 4t^2\\cos^2\\left(\\frac{\\pi a}{2a}\\right)} $$\nSince $\\cos(\\pi/2) = 0$, the second term in the square root vanishes.\n$$ \\text{Gap}(k=\\pi/a) = 2 \\sqrt{\\left(\\frac{\\Delta}{2}\\right)^2} = 2 \\left|\\frac{\\Delta}{2}\\right| = |\\Delta| $$\nThe direct band gap at the Brillouin zone edge is $|\\Delta| = |\\epsilon_A - \\epsilon_B|$.",
            "answer": "$$\\boxed{|\\Delta|}$$"
        },
        {
            "introduction": "Our final practice bridges the gap between pen-and-paper theory and computational implementation, a vital transition for any modern scientist or engineer. This task involves extending the tight-binding model to a two-dimensional square lattice and, most importantly, writing a program to validate the numerical implementation against the analytical formulas you derive . This exercise reinforces the idea that the momentum-space Hamiltonian is the Fourier transform of the real-space hopping parameters while instilling the critical skill of numerical validation and error analysis. This practice is essential for developing confidence in computational models and for building a foundation for more advanced multiscale simulations.",
            "id": "2866058",
            "problem": "You are asked to validate a general-purpose implementation of the Tight-Binding (TB) approximation by reproducing analytic band dispersions for one-dimensional chains and two-dimensional square lattices with one orbital per lattice site and nearest-neighbor hopping, and by quantifying numerical error norms. The validation must be self-consistent and based on derivations from first principles without using pre-quoted dispersion formulas in the problem statement.\n\nFundamental base to be used in your derivations:\n- Periodicity of a crystalline lattice and Bloch's theorem: electronic eigenstates in a periodic potential can be labeled by crystal momentum $k$ in the Brillouin Zone (BZ).\n- The Tight-Binding (TB) approximation: start from orthonormal, localized atomic-like orbitals centered on lattice sites, retain on-site energy and a finite set of hopping integrals between sites, and use lattice translation symmetry to write the Hamiltonian in reciprocal space.\n- For numerical comparison, periodic boundary conditions imply a first Brillouin Zone of $[-\\pi/a, \\pi/a]$ in one dimension and $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$ in two dimensions when the lattice constant is $a$.\n\nTasks:\n1. Starting from the TB Hamiltonian with a single orbital per site and only nearest-neighbor hopping on:\n   - a one-dimensional Bravais lattice,\n   - a two-dimensional square Bravais lattice,\n   derive the analytic expressions for the band energies $E(k)$ and $E(k_x, k_y)$ using Bloch's theorem and the Fourier representation of the lattice sums. Your derivations must start from the fundamental definitions of the TB Hamiltonian and Bloch states and justify each step to obtain the closed-form analytic expressions.\n\n2. Implement a program that:\n   - Constructs the Bloch Hamiltonian $H(k)$ (or $H(k_x, k_y)$) from on-site energy and nearest-neighbor hopping vectors using lattice translation symmetry.\n   - Computes the numerical band energies by diagonalizing $H(k)$ for each $k$-point on a uniform grid that spans the first Brillouin Zone (BZ).\n   - Independently computes the analytic band energies using the expressions you derived in Task $1$ (do not hard-code any formulas from the problem statement because none are given; you must encode your derived expressions).\n   - Computes two absolute error norms over the sampled BZ:\n     - The uniform norm (also called the $L_\\infty$ norm): $\\max |E_{\\text{num}} - E_{\\text{ana}}|$.\n     - The root-mean-square (RMS) norm: $\\sqrt{\\langle (E_{\\text{num}} - E_{\\text{ana}})^2 \\rangle}$ where the average is over the sampled BZ grid points.\n\n3. Use the following test suite of parameter sets to exercise different aspects of your implementation:\n   - Test Case $1$ (one-dimensional chain, general case): lattice constant $a = 0.246 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = 0.3\\,\\text{eV}$, nearest-neighbor hopping $t = -2.7\\,\\text{eV}$, number of evenly spaced $k$-points $N_k = 257$ over the closed interval $[-\\pi/a, \\pi/a]$.\n   - Test Case $2$ (one-dimensional chain, boundary case): lattice constant $a = 0.5 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = 1.0\\,\\text{eV}$, nearest-neighbor hopping $t = 0.0\\,\\text{eV}$, number of $k$-points $N_k = 1$ (interpret this as sampling only $k = 0$).\n   - Test Case $3$ (two-dimensional square lattice, general case): lattice constant $a = 0.35 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = -0.2\\,\\text{eV}$, nearest-neighbor hopping $t = 1.1\\,\\text{eV}$, number of evenly spaced grid points $N_{k_x} = 129$ and $N_{k_y} = 127$ over the closed rectangle $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$.\n   - Test Case $4$ (two-dimensional square lattice, symmetry and sign check): lattice constant $a = 0.3 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = 0.0\\,\\text{eV}$, nearest-neighbor hopping $t = -3.33\\,\\text{eV}$, number of grid points $N_{k_x} = 31$ and $N_{k_y} = 31$ over the closed rectangle $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$.\n\nAngle units and physical units:\n- Crystal momenta must be treated in radians, i.e., the scalar products $k \\cdot R$ and $k_x a$, $k_y a$ are in radians.\n- Lattice constants $a$ must be treated in meters.\n- Energies must be expressed in electronvolts (eV).\n- Numerical error norms must be reported in electronvolts (eV).\n\nNumerical protocol:\n- For $N_k = 1$ in one dimension, use $k = 0$ only.\n- For $N_k \\ge 2$ in one dimension, sample $k$ uniformly over $[-\\pi/a, \\pi/a]$ including both endpoints.\n- For two dimensions, sample a Cartesian product grid $k_x \\in [-\\pi/a, \\pi/a]$, $k_y \\in [-\\pi/a, \\pi/a]$ including both endpoints in each direction if $N_{k_x}, N_{k_y} \\ge 2$; if $N_{k_x} = 1$ or $N_{k_y} = 1$, use the single point $0$ for that direction.\n- Compute the two norms over the full set of sampled points. Round each norm to $12$ decimal places.\n\nRequired final output format:\n- For each test case, produce a list with two floats $[L_\\infty, L_2]$ in electronvolts, each rounded to $12$ decimal places.\n- Aggregate the four test-case results into a single Python-style list and print it as one line only, with no extra spaces inserted beyond those necessary for valid comma separation. For example: $[[x_{11},x_{12}],[x_{21},x_{22}],[x_{31},x_{32}],[x_{41},x_{42}]]$.\n\nYour program must be a complete, runnable program that performs all computations without user input and prints exactly one line in the format specified above.",
            "solution": "The problem is found to be valid. It is a well-posed, scientifically grounded task from fundamental solid-state physics, requiring the derivation and numerical verification of the tight-binding band structure for simple lattices. All required parameters are provided, and the task is unambiguous.\n\nThe solution proceeds in $2$ stages. First, the analytic dispersion relations are derived from first principles for a $1$-dimensional ($1$D) chain and a $2$-dimensional ($2$D) square lattice. Second, these derivations are used to construct a self-consistent numerical validation program.\n\n**Derivation of the Analytic Band Dispersion**\n\nThe tight-binding model starts with a basis of localized atomic-like orbitals $|\\phi_{\\mathbf{R}}\\rangle$ centered at each lattice site $\\mathbf{R}$. These orbitals are assumed to form an orthonormal set: $\\langle \\phi_{\\mathbf{R}} | \\phi_{\\mathbf{R}'} \\rangle = \\delta_{\\mathbf{R}\\mathbf{R}'}$. The Hamiltonian $H$ is defined by its matrix elements in this basis. For a model with a single ($1$) orbital per site, an on-site energy $\\varepsilon_0$, and a hopping integral $t$ only between nearest neighbors, the matrix elements are:\n$$\n\\langle \\phi_{\\mathbf{R}'} | H | \\phi_{\\mathbf{R}} \\rangle =\n\\begin{cases}\n\\varepsilon_0  \\text{if } \\mathbf{R}' = \\mathbf{R} \\\\\nt  \\text{if } \\mathbf{R}' \\text{ and } \\mathbf{R} \\text{ are nearest neighbors} \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n\nAccording to Bloch's theorem, the eigenstates of a periodic system can be written as Bloch waves, which are superpositions of the localized orbitals, distinguished by a crystal momentum vector $\\mathbf{k}$ from the first Brillouin Zone. For a lattice with $N$ sites, the Bloch state is:\n$$\n|\\psi_{\\mathbf{k}}\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}} e^{i\\mathbf{k} \\cdot \\mathbf{R}} |\\phi_{\\mathbf{R}}\\rangle\n$$\nSince there is $1$ orbital per site, the basis for the eigenstates for a given $\\mathbf{k}$ is $1$-dimensional. The Bloch Hamiltonian $H(\\mathbf{k})$ is therefore a $1 \\times 1$ matrix, whose single element is the energy eigenvalue $E(\\mathbf{k})$. This is calculated as the expectation value of the Hamiltonian in the Bloch state:\n$$\nE(\\mathbf{k}) = \\langle \\psi_{\\mathbf{k}} | H | \\psi_{\\mathbf{k}} \\rangle = \\frac{1}{N} \\sum_{\\mathbf{R}, \\mathbf{R}'} e^{-i\\mathbf{k} \\cdot \\mathbf{R}'} e^{i\\mathbf{k} \\cdot \\mathbf{R}} \\langle \\phi_{\\mathbf{R}'} | H | \\phi_{\\mathbf{R}} \\rangle\n$$\nBy using the translation invariance of the lattice, we can set one summation index, say $\\mathbf{R}'$, as the origin without loss of generality and sum over displacement vectors $\\boldsymbol{\\delta} = \\mathbf{R} - \\mathbf{R}'$. This simplifies the expression to a sum over neighbors:\n$$\nE(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} H_{\\mathbf{0}, \\boldsymbol{\\delta}}\n$$\nwhere $H_{\\mathbf{0}, \\boldsymbol{\\delta}} = \\langle \\phi_{\\mathbf{0}} | H | \\phi_{\\boldsymbol{\\delta}} \\rangle$ are the Hamiltonian matrix elements connecting the origin site to sites at $\\boldsymbol{\\delta}$. This expression is the discrete Fourier transform of the real-space Hamiltonian matrix elements and represents the general method for constructing the Bloch Hamiltonian.\n\n**One-Dimensional ($1$D) Chain**\n\nFor a $1$D chain with lattice constant $a$, the lattice sites are at positions $R_n = na$ for integer $n$. The crystal momentum is a scalar $k$. The nearest neighbors of a site at $na$ are at $(n \\pm 1)a$. The displacement vectors $\\boldsymbol{\\delta}$ from the origin are thus $\\delta = 0$ (the site itself), $\\delta = +a$, and $\\delta = -a$.\nApplying the general formula for $E(k)$:\n- For $\\delta = 0$: The term is $e^{ik \\cdot 0} H_{0,0} = 1 \\cdot \\varepsilon_0 = \\varepsilon_0$.\n- For $\\delta = +a$: The term is $e^{ik a} H_{0,a} = e^{ika} t$.\n- For $\\delta = -a$: The term is $e^{ik (-a)} H_{0,-a} = e^{-ika} t$.\n\nSumming these contributions gives the energy dispersion for the $1$D chain:\n$$\nE(k) = \\varepsilon_0 + t(e^{ika} + e^{-ika})\n$$\nUsing Euler's formula, $e^{ix} + e^{-ix} = 2\\cos(x)$, we obtain the final analytic expression:\n$$\nE(k) = \\varepsilon_0 + 2t \\cos(ka)\n$$\n\n**Two-Dimensional ($2$D) Square Lattice**\n\nFor a $2$D square lattice with lattice constant $a$, the sites are at positions $\\mathbf{R} = (n_x a, n_y a)$. The crystal momentum is a vector $\\mathbf{k} = (k_x, k_y)$. The nearest neighbors of a site are at displacements $\\boldsymbol{\\delta} \\in \\{ (a, 0), (-a, 0), (0, a), (0, -a) \\}$.\nWe again apply the sum over displacement vectors $\\boldsymbol{\\delta}$:\n- For $\\boldsymbol{\\delta} = (0, 0)$: The term is $e^{i\\mathbf{k} \\cdot \\mathbf{0}} H_{\\mathbf{0},\\mathbf{0}} = 1 \\cdot \\varepsilon_0 = \\varepsilon_0$.\n- For $\\boldsymbol{\\delta} = (a, 0)$: The term is $e^{i\\mathbf{k} \\cdot (a,0)} H_{\\mathbf{0},(a,0)} = e^{ik_xa} t$.\n- For $\\boldsymbol{\\delta} = (-a, 0)$: The term is $e^{i\\mathbf{k} \\cdot (-a,0)} H_{\\mathbf{0},(-a,0)} = e^{-ik_xa} t$.\n- For $\\boldsymbol{\\delta} = (0, a)$: The term is $e^{i\\mathbf{k} \\cdot (0,a)} H_{\\mathbf{0},(0,a)} = e^{ik_ya} t$.\n- For $\\boldsymbol{\\delta} = (0, -a)$: The term is $e^{i\\mathbf{k} \\cdot (0,-a)} H_{\\mathbf{0},(0,-a)} = e^{-ik_ya} t$.\n\nSumming all contributions:\n$$\nE(\\mathbf{k}) = \\varepsilon_0 + t(e^{ik_xa} + e^{-ik_xa}) + t(e^{ik_ya} + e^{-ik_ya})\n$$\nUsing Euler's formula for both the $x$ and $y$ components, we get the final analytic expression for the $2$D square lattice:\n$$\nE(k_x, k_y) = \\varepsilon_0 + 2t (\\cos(k_x a) + \\cos(k_y a))\n$$\n\n**Numerical Validation and Error Analysis**\n\nThe problem requires a program to perform a self-consistent validation. This involves $2$ calculations of the energy dispersion over a grid of $\\mathbf{k}$-points in the first Brillouin Zone.\n1.  **Numerical Energy ($E_{\\text{num}}$)**: This is computed by directly implementing the discrete Fourier transform $E(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} H_{\\mathbf{0}, \\boldsymbol{\\delta}}$. For the single-orbital case, this sum gives the $1 \\times 1$ Bloch Hamiltonian, which is the energy itself. In the code, this corresponds to summing complex exponential terms.\n2.  **Analytical Energy ($E_{\\text{ana}}$)**: This is computed using the simplified real-valued expressions derived above, which involve cosine functions.\n\nThe difference between these $2$ methods should theoretically be zero. In practice, due to finite-precision floating-point arithmetic, there might be minuscule differences on the order of machine epsilon. The purpose of the calculation is to verify that these $2$ computational paths yield identical results to within this precision, thus validating the implementation of the general numerical scheme against the specific analytical solution.\n\nTwo error norms are calculated over the set of $M$ sampled $\\mathbf{k}$-points:\n- The uniform norm or $L_\\infty$ norm, which measures the maximum absolute deviation:\n$$\nL_\\infty = \\max_{i=1 \\dots M} |E_{\\text{num}}(\\mathbf{k}_i) - E_{\\text{ana}}(\\mathbf{k}_i)|\n$$\n- The root-mean-square (RMS) norm, or $L_2$ norm, which measures the average deviation:\n$$\nL_2 = \\sqrt{\\frac{1}{M} \\sum_{i=1}^{M} (E_{\\text{num}}(\\mathbf{k}_i) - E_{\\text{ana}}(\\mathbf{k}_i))^2}\n$$\nGiven the mathematical equivalence of the $2$ energy expressions, both norms are expected to be close to $0$. The required rounding to $12$ decimal places should result in exactly $0.0$ for all test cases. This confirms the correctness of the physics implementation and the derivations. The provided code implements this validation procedure for the specified test cases.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_norms(case):\n    \"\"\"\n    Calculates numerical and analytical energies and their error norms for a given test case.\n    \"\"\"\n    dim, a, eps0, t, Nk_x, Nk_y = case['dim'], case['a'], case['eps0'], case['t'], case['Nk_x'], case.get('Nk_y')\n\n    if dim == 1:\n        # Generate 1D k-point grid\n        if Nk_x == 1:\n            k_vals = np.array([0.0])\n        else:\n            k_vals = np.linspace(-np.pi / a, np.pi / a, Nk_x)\n        \n        # \"Numerical\" E_num from summing complex exponentials (Fourier transform of H_ij)\n        # For a single orbital model, the 1x1 Bloch Hamiltonian is the energy.\n        # H(k) = sum_{delta} exp(i*k*delta) * H_{0,delta}\n        # H_{0,0} = eps0, H_{0,a} = t, H_{0,-a} = t\n        H_k = eps0 + t * (np.exp(1j * k_vals * a) + np.exp(-1j * k_vals * a))\n        # Energy must be real since Hamiltonian is Hermitian.\n        E_num = np.real(H_k)\n\n        # \"Analytical\" E_ana from the derived simplified formula\n        E_ana = eps0 + 2 * t * np.cos(k_vals * a)\n        \n        diff = E_num - E_ana\n        \n    elif dim == 2:\n        # Generate 2D k-point grid\n        if Nk_x == 1:\n            kx_vals = np.array([0.0])\n        else:\n            kx_vals = np.linspace(-np.pi / a, np.pi / a, Nk_x)\n        \n        if Nk_y == 1:\n            ky_vals = np.array([0.0])\n        else:\n            ky_vals = np.linspace(-np.pi / a, np.pi / a, Nk_y)\n        \n        kx_grid, ky_grid = np.meshgrid(kx_vals, ky_vals)\n        \n        # \"Numerical\" E_num from summing complex exponentials\n        # H(k) = eps0 + t*exp(i*kx*a) + t*exp(-i*kx*a) + t*exp(i*ky*a) + t*exp(-i*ky*a)\n        term_x = t * (np.exp(1j * kx_grid * a) + np.exp(-1j * kx_grid * a))\n        term_y = t * (np.exp(1j * ky_grid * a) + np.exp(-1j * ky_grid * a))\n        H_k = eps0 + term_x + term_y\n        E_num = np.real(H_k)\n\n        # \"Analytical\" E_ana from the derived simplified formula\n        E_ana = eps0 + 2 * t * (np.cos(kx_grid * a) + np.cos(ky_grid * a))\n        \n        diff = E_num - E_ana\n\n    else:\n        raise ValueError(\"Dimension must be 1 or 2.\")\n        \n    # Calculate norms\n    l_inf_norm = np.max(np.abs(diff))\n    rms_norm = np.sqrt(np.mean(diff**2))\n    \n    # Round to 12 decimal places as required\n    return [round(l_inf_norm, 12), round(rms_norm, 12)]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Test Case 1 (1D general)\n        {'dim': 1, 'a': 0.246e-9, 'eps0': 0.3, 't': -2.7, 'Nk_x': 257},\n        # Test Case 2 (1D boundary)\n        {'dim': 1, 'a': 0.5e-9, 'eps0': 1.0, 't': 0.0, 'Nk_x': 1},\n        # Test Case 3 (2D general)\n        {'dim': 2, 'a': 0.35e-9, 'eps0': -0.2, 't': 1.1, 'Nk_x': 129, 'Nk_y': 127},\n        # Test Case 4 (2D symmetry/sign check)\n        {'dim': 2, 'a': 0.3e-9, 'eps0': 0.0, 't': -3.33, 'Nk_x': 31, 'Nk_y': 31},\n    ]\n\n    results = []\n    for case in test_cases:\n        norms = calculate_norms(case)\n        results.append(norms)\n\n    # Format the final output string to be exactly as requested, with no extra spaces.\n    # The str() representation of a list of lists has spaces after commas.\n    # str(results) -> '[[0.0, 0.0], [0.0, 0.0], ...]'\n    # We remove these spaces for exact formatting compliance.\n    output_str = str(results).replace(' ', '')\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}