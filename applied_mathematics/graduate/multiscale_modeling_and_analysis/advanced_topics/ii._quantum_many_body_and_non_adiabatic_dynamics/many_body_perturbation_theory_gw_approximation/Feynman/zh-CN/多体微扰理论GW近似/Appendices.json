{
    "hands_on_practices": [
        {
            "introduction": "在多体系统中，电子不再是孤立的“裸”粒子，而是被周围的相互作用“缀饰”起来，形成所谓的准粒子。本练习将探讨准粒子权重（或称重整化因子）$Z_{\\mathbf{k}}$ 的概念，它量化了裸电子态在多体准粒子态中所占的比重。通过推导准粒子权重 $Z_{\\mathbf{k}}$ 与自能 $\\Sigma(\\mathbf{k},\\omega)$ 频率导数之间的关系 ，你将深刻理解谱权重如何从相干的准粒子峰转移到非相干的卫星峰结构上，这是理解光电子能谱实验的关键一步。",
            "id": "3777285",
            "problem": "考虑一个零温下的均匀金属电子系统，该系统在格林函数乘以屏蔽库仑相互作用（GW）近似下进行建模。缀饰格林函数由 Dyson 方程定义，其中格林函数的逆由 $G^{-1}(\\mathbf{k},\\omega)=\\omega-\\varepsilon_{\\mathbf{k}}-\\Sigma(\\mathbf{k},\\omega)$ 给出，其中 $\\varepsilon_{\\mathbf{k}}$ 是无相互作用的能带能量，$\\Sigma(\\mathbf{k},\\omega)$ 是由电子与库仑相互作用的动态屏蔽模式耦合产生的电子自能。在一个屏蔽主要由频率为 $\\omega_{\\mathrm{p}}$ 的明确定义的等离激元模式主导的系统中，$\\Sigma(\\mathbf{k},\\omega)$ 的频率依赖性反映了电子-等离激元耦合，并在谱函数中产生卫星峰结构。\n\n从 Dyson 方程和准粒子极点的定义出发，推导准粒子权重 $Z_{\\mathbf{k}}$ 的一般表达式，该表达式用在准粒子能量 $E_{\\mathbf{k}}$ 处求值的自能实部的频率导数来表示。然后引入一个无量纲耦合常数 $\\lambda$，通过定义 $\\lambda\\equiv-\\left.\\partial_{\\omega}\\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)\\right|_{\\omega=E_{\\mathrm{F}}}$ 来量化由电子-等离激元耦合引起的费米面上自能实部的斜率，其中 $E_{\\mathrm{F}}$ 是费米能。使用这个定义，用 $\\lambda$ 表示 $Z_{\\mathbf{k}}$。你的最终答案必须是关于 $Z_{\\mathbf{k}}$ 的一个用 $\\lambda$ 表示的单一闭合形式的解析表达式。不需要进行数值计算，最终答案中也不应包含任何单位。简要解释为什么与等离激元的耦合会使准粒子权重降低到小于1，解释时需引用因果响应和谱权重重新分布的基本性质，但不要直接插入任何 $Z_{\\mathbf{k}}$ 的简化公式。",
            "solution": "该问题要求推导准粒子权重 $Z_{\\mathbf{k}}$ 及其用定义的耦合常数 $\\lambda$ 表示的表达式。推导从单粒子格林函数 $G(\\mathbf{k},\\omega)$ 的 Dyson 方程开始。\n\n缀饰格林函数的逆给出如下：\n$$G^{-1}(\\mathbf{k},\\omega)=\\omega-\\varepsilon_{\\mathbf{k}}-\\Sigma(\\mathbf{k},\\omega)$$\n其中 $\\omega$ 是能量，$\\mathbf{k}$ 是波矢，$\\varepsilon_{\\mathbf{k}}$ 是无相互作用的能带能量，$\\Sigma(\\mathbf{k},\\omega)$ 是复数值的电子自能。因此，格林函数为：\n$$G(\\mathbf{k},\\omega) = \\frac{1}{\\omega-\\varepsilon_{\\mathbf{k}}-\\Sigma(\\mathbf{k},\\omega)}$$\n准粒子激发对应于格林函数的一个极点。由于自能的复数性质，$\\Sigma(\\mathbf{k},\\omega) = \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega) + i\\,\\mathrm{Im}\\,\\Sigma(\\mathbf{k},\\omega)$，该极点不在实轴上。一个明确定义的准粒子对应于谱函数中的一个尖锐峰，这发生在自能的虚部很小时。准粒子能量 $E_{\\mathbf{k}}$ 通常定义为使格林函数逆的实部为零的能量：\n$$E_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}} - \\mathrm{Re}\\,\\Sigma(\\mathbf{k}, E_{\\mathbf{k}}) = 0$$\n该方程定义了相互作用系统的重整化能带结构 $E_{\\mathbf{k}}$。\n\n为了求出准粒子权重 $Z_{\\mathbf{k}}$，我们分析 $G(\\mathbf{k},\\omega)$ 在准粒子能量 $E_{\\mathbf{k}}$ 附近的能量 $\\omega$ 处的行为。我们对格林函数的逆 $G^{-1}(\\mathbf{k},\\omega)$ 在 $\\omega = E_{\\mathbf{k}}$ 附近进行泰勒展开：\n$$G^{-1}(\\mathbf{k},\\omega) \\approx G^{-1}(\\mathbf{k}, E_{\\mathbf{k}}) + (\\omega - E_{\\mathbf{k}}) \\left. \\frac{\\partial G^{-1}(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}}$$\n第一项在 $\\omega=E_{\\mathbf{k}}$ 处求值：\n$$G^{-1}(\\mathbf{k}, E_{\\mathbf{k}}) = E_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}} - \\Sigma(\\mathbf{k}, E_{\\mathbf{k}})$$\n使用 $E_{\\mathbf{k}}$ 的定义，我们可以代入 $E_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}} = \\mathrm{Re}\\,\\Sigma(\\mathbf{k}, E_{\\mathbf{k}})$：\n$$G^{-1}(\\mathbf{k}, E_{\\mathbf{k}}) = \\mathrm{Re}\\,\\Sigma(\\mathbf{k}, E_{\\mathbf{k}}) - \\Sigma(\\mathbf{k}, E_{\\mathbf{k}}) = -i\\,\\mathrm{Im}\\,\\Sigma(\\mathbf{k}, E_{\\mathbf{k}})$$\n第二项涉及 $G^{-1}(\\mathbf{k},\\omega)$ 的导数：\n$$\\frac{\\partial G^{-1}(\\mathbf{k},\\omega)}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} (\\omega-\\varepsilon_{\\mathbf{k}}-\\Sigma(\\mathbf{k},\\omega)) = 1 - \\frac{\\partial \\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega}$$\n在 $\\omega=E_{\\mathbf{k}}$ 处对此求值，并只保留自能导数的实部，这与准粒子近似一致，在准粒子近似中，虚部及其导数被认为是小微扰，我们得到：\n$$\\left. \\frac{\\partial G^{-1}(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}} \\approx 1 - \\left. \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}}$$\n将这些结果代回 $G^{-1}(\\mathbf{k},\\omega)$ 的展开式中：\n$$G^{-1}(\\mathbf{k},\\omega) \\approx (\\omega - E_{\\mathbf{k}}) \\left( 1 - \\left. \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}} \\right) - i\\,\\mathrm{Im}\\,\\Sigma(\\mathbf{k}, E_{\\mathbf{k}})$$\n对该表达式求逆，得到准粒子极点附近的格林函数：\n$$G(\\mathbf{k},\\omega) \\approx \\frac{1}{(\\omega - E_{\\mathbf{k}}) \\left( 1 - \\left. \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}} \\right) - i\\,\\mathrm{Im}\\,\\Sigma(\\mathbf{k}, E_{\\mathbf{k}})}$$\n准粒子极点附近格林函数的标准形式为 $G(\\mathbf{k},\\omega) \\approx \\frac{Z_{\\mathbf{k}}}{\\omega - E_{\\mathbf{k}} + i\\Gamma_{\\mathbf{k}}}$，其中 $Z_{\\mathbf{k}}$ 是准粒子权重（极点的留数），$\\Gamma_{\\mathbf{k}}$ 与衰减率有关。为了将我们推导的形式与此标准形式匹配，我们从分母中提出 $(\\omega - E_{\\mathbf{k}})$ 的系数：\n$$G(\\mathbf{k},\\omega) \\approx \\frac{\\left( 1 - \\left. \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}} \\right)^{-1}}{(\\omega - E_{\\mathbf{k}}) - i\\,\\mathrm{Im}\\,\\Sigma(\\mathbf{k}, E_{\\mathbf{k}}) \\left( 1 - \\left. \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}} \\right)^{-1}}$$\n通过比较分子，我们确定了准粒子权重 $Z_{\\mathbf{k}}$ 的一般表达式：\n$$Z_{\\mathbf{k}} = \\left( 1 - \\left. \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathbf{k}}} \\right)^{-1}$$\n然后，问题为费米面上的激发定义了一个无量纲耦合常数 $\\lambda$：\n$$\\lambda \\equiv -\\left. \\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\right|_{\\omega=E_{\\mathrm{F}}}$$\n其中 $E_{\\mathrm{F}}$ 是费米能。对于费米面上的准粒子（$|\\mathbf{k}| = k_F$），其能量即为费米能，因此 $E_{\\mathbf{k}} = E_{\\mathrm{F}}$。因此，我们可以将 $\\lambda$ 的定义代入在费米面上求值的 $Z_{\\mathbf{k}}$ 表达式中：\n$$Z_{\\mathbf{k_F}} = \\left( 1 - \\left( -\\lambda \\right) \\right)^{-1} = (1+\\lambda)^{-1}$$\n由于问题要求用 $\\lambda$ 表示 $Z_{\\mathbf{k}}$，而 $\\lambda$ 是在费米面上特别定义的，因此得到的 $Z_{\\mathbf{k}}$ 表达式被理解为适用于这些决定金属系统性质的低能准粒子。\n$$Z_{\\mathbf{k}} = \\frac{1}{1+\\lambda}$$\n\n最后，我们解释为什么与等离激元（或任何其他玻色子）的耦合会使准粒子权重降低到小于1。自能 $\\Sigma(\\mathbf{k},\\omega)$ 是一个因果响应函数。因果性要求它必须满足 Kramers-Kronig 关系。连接实部导数与虚部的关系是：\n$$\\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} = \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{d\\omega'}{\\pi} \\frac{\\mathrm{Im}\\,\\Sigma(\\mathbf{k},\\omega')}{(\\omega'-\\omega)^2}$$\n其中 $\\mathcal{P}$ 表示 Cauchy 主值。推迟自能的一个基本性质是其虚部在所有能量下都是非正的，即 $\\mathrm{Im}\\,\\Sigma(\\mathbf{k},\\omega) \\le 0$。这是为了确保谱函数 $A(\\mathbf{k},\\omega) = -\\frac{1}{\\pi}\\mathrm{Im}\\,G(\\mathbf{k},\\omega) \\propto -\\mathrm{Im}\\,\\Sigma(\\mathbf{k},\\omega)$ 是一个非负量。由于 $(\\omega' - \\omega)^2$ 总是非负的，被积函数 $\\mathrm{Im}\\,\\Sigma(\\mathbf{k},\\omega') / (\\omega' - \\omega)^2$ 处处非正。一个非正函数的积分必定是非正的。因此，对于任何相互作用系统：\n$$\\frac{\\partial \\mathrm{Re}\\,\\Sigma(\\mathbf{k},\\omega)}{\\partial \\omega} \\le 0$$\n对于一个相互作用系统，其中 $\\mathrm{Im}\\,\\Sigma$ 不恒为零，这个不等式是严格的。这意味着耦合常数 $\\lambda = -\\left.\\partial_{\\omega}\\mathrm{Re}\\,\\Sigma\\right|_{\\omega=E_{\\mathrm{F}}}$ 必须为正，即 $\\lambda > 0$。因此，准粒子权重 $Z_{\\mathbf{k}} = (1+\\lambda)^{-1}$ 必须小于1。物理上，这种减小反映了谱权重的重新分布。相互作用“缀饰”了裸电子，形成了一个复合准粒子。单个尖锐的无相互作用峰的谱权重被分配给新的相干准粒子峰（权重为 $Z_{\\mathbf{k}}$）和一个由其他激发（如等离激元卫星峰）组成的非相干背景，后者占据了剩余的 $1-Z_{\\mathbf{k}}$ 的权重。",
            "answer": "$$\\boxed{\\frac{1}{1+\\lambda}}$$"
        },
        {
            "introduction": "理解了准粒子（由格林函数 $G$ 描述）之后，我们转向构成 GW 近似中自能 $\\Sigma = iGW$ 的另一核心要素：屏蔽库仑相互作用 $W$。此练习将深入探讨屏蔽效应的核心，即计算无相互作用极化函数 $P^0$，它是随机相位近似（RPA）介电函数的基石。我们将以二维电子气（2DEG）为模型，这对于理解现代层状材料至关重要。",
            "id": "3777295",
            "problem": "考虑一个均匀、各向同性的二维电子气，其处于零温下，具有抛物线色散关系 $\\epsilon_{\\mathbf{k}} = \\hbar^{2} k^{2} / (2 m)$ 和自旋简并度 $g_{s}$。设费米波矢为 $k_{F}$，费米速度为 $v_{F} = \\hbar k_{F} / m$。在多体微扰理论和 $GW$ 近似的框架下，屏蔽库仑相互作用 $W(\\mathbf{q}, \\omega)$ 是通过随机相近似 (RPA) 介电函数来定义的，而该介电函数由无相互作用（不可约）极化率 $P^{0}(\\mathbf{q}, \\omega)$ 构建。\n\n从密度-密度响应和无相互作用单粒子格林函数的基本定义出发，推导二维电子气在零温静态极限下的无相互作用极化率。具体来说，计算无量纲静态极化率\n$$\\widetilde{P}^{0}(q, 0) \\equiv \\frac{P^{0}(q, 0)}{N_{0}},$$\n其中 $q = |\\mathbf{q}|$ 且 $N_{0} \\equiv \\frac{g_{s} m}{2 \\pi \\hbar^{2}}$ 是包含自旋简并度的费米能级处的二维态密度。将最终结果表示为关于 $q$ 和 $k_{F}$ 的单个闭合形式解析表达式，并使用亥维赛阶跃函数 $\\Theta(x)$ 来描述与费米面相关的任何非解析结构。无需进行数值计算。\n\n然后，利用裸二维库仑相互作用 $v(q) = \\frac{2 \\pi e^{2}}{\\varepsilon q}$（其中 $\\varepsilon$ 为背景介电常数），用文字讨论所推导的 $\\widetilde{P}^{0}(q, 0)$ 如何控制层状（准二维）材料中的静态屏蔽以及 $W(q, 0)$ 的定性行为，并着重说明长波极限和层间耦合的作用。\n\n请将 $\\widetilde{P}^{0}(q, 0)$ 的最终答案以单个解析表达式的形式给出。无需四舍五入。该表达式是无量纲的，因此不要附加单位。",
            "solution": "我们的目标是从多体微扰理论的第一性原理出发，推导二维电子气在静态、零温条件下的无相互作用极化率。无相互作用（不可约）极化率 $P^{0}(\\mathbf{q}, \\omega)$ 由无相互作用单粒子格林函数构成的气泡图给出。在实频（推迟）形式下，且在零温时，可以从标准的线性响应/Kubo 公式出发，或者等价地从时间序气泡图出发进行解析延拓。经过充分检验的基础表达式为\n$$\nP^{0}(\\mathbf{q}, \\omega) = 2 \\int \\frac{d^{2}k}{(2\\pi)^{2}} \\frac{f(\\epsilon_{\\mathbf{k}}) - f(\\epsilon_{\\mathbf{k} + \\mathbf{q}})}{\\hbar \\omega + \\epsilon_{\\mathbf{k}} - \\epsilon_{\\mathbf{k} + \\mathbf{q}} + i 0^{+}},\n$$\n其中 $f(\\epsilon)$ 是零温下的费米-狄拉克占据数，因子 $2$ 考虑了自旋简并度 $g_{s}$（更一般地，可以直接写出 $g_{s}$；下文中我们保留与 $N_{0}$ 相关的传统因子）。在静态极限下，我们令 $\\omega = 0$ 并关注积分的主值：\n$$\nP^{0}(\\mathbf{q}, 0) = 2 \\int \\frac{d^{2}k}{(2\\pi)^{2}} \\frac{f(\\epsilon_{\\mathbf{k}}) - f(\\epsilon_{\\mathbf{k} + \\mathbf{q}})}{\\epsilon_{\\mathbf{k}} - \\epsilon_{\\mathbf{k} + \\mathbf{q}}}.\n$$\n\n对于抛物线能带 $\\epsilon_{\\mathbf{k}} = \\hbar^{2} k^{2}/(2m)$，有\n$$\n\\epsilon_{\\mathbf{k} + \\mathbf{q}} - \\epsilon_{\\mathbf{k}} = \\frac{\\hbar^{2}}{2m} \\left( (\\mathbf{k} + \\mathbf{q})^{2} - \\mathbf{k}^{2} \\right) = \\frac{\\hbar^{2}}{2m} \\left( 2 \\mathbf{k} \\cdot \\mathbf{q} + q^{2} \\right).\n$$\n因此，\n$$\n\\epsilon_{\\mathbf{k}} - \\epsilon_{\\mathbf{k} + \\mathbf{q}} = - \\frac{\\hbar^{2}}{2m} \\left( 2 \\mathbf{k} \\cdot \\mathbf{q} + q^{2} \\right).\n$$\n\n在 $T=0$ 时，分子 $f(\\epsilon_{\\mathbf{k}}) - f(\\epsilon_{\\mathbf{k} + \\mathbf{q}})$ 将积分限制在费米面附近的态。该积分可以通过变量代换来计算，即令 $\\mathbf{q}$ 沿 x 轴，并为 $\\mathbf{k}$ 引入极坐标，此时 $\\mathbf{k} \\cdot \\mathbf{q} = k q \\cos\\theta$。于是，\n$$\nP^{0}(q, 0) = 2 \\int \\frac{d^{2}k}{(2\\pi)^{2}} \\frac{f(\\epsilon_{\\mathbf{k}}) - f(\\epsilon_{\\mathbf{k} + \\mathbf{q}})}{- \\frac{\\hbar^{2}}{2m} (2 k q \\cos\\theta + q^{2})}.\n$$\n\n占据数之差所选取的区域是：$\\mathbf{k}$ 和 $\\mathbf{k} + \\mathbf{q}$ 中一个在费米圆盘内，另一个在费米圆盘外。从几何上看，这对应于 $\\mathbf{k}$ 空间中两个半径为 $k_{F}$ 的圆盘的交叠区域之差，这两个圆盘分别以 $\\mathbf{0}$ 和 $-\\mathbf{q}$ 为中心。分母线性依赖于 $\\cos\\theta$ 并包含一个位移 $q^{2}$；角积分可以使用恒等式\n$$\n\\int_{0}^{2\\pi} \\frac{d\\theta}{a + b \\cos\\theta} = \\frac{2\\pi}{\\sqrt{a^{2} - b^{2}}}\n$$\n来处理（对 $|a| > |b|$ 成立），必要时可通过主值进行扩展。在进行角积分并仔细施加费米函数带来的运动学限制后，可以发现二维静态极化率是关于 $q$ 的分段函数，在 $q = 2 k_{F}$ 处有一个非解析点。这种非解析性源于零温下尖锐的费米面以及粒子-空穴激发可用的相空间。\n\n该结果通常归因于 Stern 的分析，可以通过对费米能级处的二维态密度进行归一化来紧凑地表示，\n$$\nN_{0} \\equiv \\frac{g_{s} m}{2 \\pi \\hbar^{2}}.\n$$\n定义无量纲静态极化率\n$$\n\\widetilde{P}^{0}(q, 0) \\equiv \\frac{P^{0}(q, 0)}{N_{0}},\n$$\n其零温下的闭合形式表达式为\n$$\n\\widetilde{P}^{0}(q, 0) = - \\left[ 1 - \\Theta(q - 2 k_{F}) \\sqrt{1 - \\left( \\frac{2 k_{F}}{q} \\right)^{2}} \\right].\n$$\n等价地，我们可以读出其分段结构：当 $q \\leq 2 k_{F}$ 时，$\\widetilde{P}^{0}(q, 0) = -1$；当 $q > 2 k_{F}$ 时，$\\widetilde{P}^{0}(q, 0) = - \\left[ 1 - \\sqrt{1 - (2 k_{F}/q)^{2}} \\right]$。这种使用亥维赛阶跃函数 $\\Theta$ 的紧凑形式将两种情况囊括在一个表达式中。\n\n对层状材料中屏蔽和 $W(q, 0)$ 的影响：在随机相近似中，屏蔽相互作用满足\n$$\nW(q, 0) = \\frac{v(q)}{1 - v(q) P^{0}(q, 0)},\n$$\n其中二维裸库仑相互作用为\n$$\nv(q) = \\frac{2 \\pi e^{2}}{\\varepsilon q}.\n$$\n在长波极限 $q \\ll 2 k_{F}$ 下，静态极化率饱和到 $P^{0}(q, 0) \\approx - N_{0}$，因此\n$$\nW(q, 0) \\approx \\frac{\\frac{2 \\pi e^{2}}{\\varepsilon q}}{1 + \\frac{2 \\pi e^{2}}{\\varepsilon q} N_{0}} = \\frac{2 \\pi e^{2}}{\\varepsilon (q + q_{s})},\n$$\n其中二维托马斯-费米波矢为\n$$\nq_{s} \\equiv \\frac{2 \\pi e^{2}}{\\varepsilon} N_{0}.\n$$\n这表明面内的长波相互作用被强烈屏蔽，其衰减形式如同库仑核从 $q^{-1}$ 软化为 $(q + q_{s})^{-1}$。因此，在层状（准二维）材料中，对于小 $q$ 值，面内屏蔽是高效的，这减小了 $W(q, 0)$，从而也减小了长波过程的 $GW$ 自能修正的大小。然而，有限的层间距和各向异性使得面外屏蔽变弱；有效介电环境 $\\varepsilon$ 和可能的层间库仑耦合会修正 $v(q)$ 和屏蔽长度标度 $q_{s}$，导致面外场的屏蔽减弱，并增强了 $W$ 对层状结构的敏感性。在 $q = 2 k_{F}$ 处的非解析特征意味着静态响应中存在一个扭折，这会影响弗里德尔振荡以及与 $2 k_{F}$ 散射相关的 $GW$ 级别的准粒子重整化，这是层状金属和掺杂半导体中普遍存在的一种特征。\n\n因此，推导出的 $\\widetilde{P}^{0}(q, 0)$ 概括了在层状材料的 $GW$ 近似中输入到 $W(q, \\omega)$ 的关键二维屏蔽物理：当 $q \\leq 2 k_{F}$ 时，存在强的、与 q 无关的屏蔽；当 $q > 2 k_{F}$ 时，屏蔽减弱；并且当嵌入层状介电环境中时，会产生各向异性的影响。",
            "answer": "$$\\boxed{-\\left[1-\\Theta\\!\\left(q-2k_{F}\\right)\\sqrt{1-\\left(\\frac{2k_{F}}{q}\\right)^{2}}\\right]}$$"
        },
        {
            "introduction": "我们已经从理论上探讨了准粒子（$G$）和屏蔽（$W$）的定义，现在是时候将这些概念应用于一个实际的计算问题了。这个最终的练习将指导你完成一个简化的 $G_0W_0$ 计算，以修正半导体的带隙——这是 GW 近似最主要的应用之一。你将亲手实现静态库仑空穴与屏蔽交换（COHSEX）近似下的自能修正。",
            "id": "3777310",
            "problem": "你的任务是推导并实现一种在$G_{0}W_{0}$框架内的最小化、自洽的多体微扰理论（MBPT）计算，以估算半导体的带隙。从基本定义出发，推导出一个简化但物理意义明确的模型，该模型能分离出在半导体中显著且在金属中问题较少的长程屏蔽贡献。\n\n起点和核心定义：\n- $G_{0}W_{0}$中的准粒子自能定义为无相互作用单粒子格林函数与屏蔽库仑相互作用的卷积：$$\\Sigma(\\mathbf{r},\\mathbf{r}';\\omega) = i \\int \\frac{d\\omega'}{2\\pi} G_{0}(\\mathbf{r},\\mathbf{r}';\\omega+\\omega') W_{0}(\\mathbf{r},\\mathbf{r}';\\omega').$$\n- 屏蔽库仑相互作用由下式给出：$$W_{0}(\\mathbf{q},\\omega) = \\epsilon^{-1}(\\mathbf{q},\\omega) v(\\mathbf{q}),$$ 其中裸库仑相互作用为 $$v(\\mathbf{q}) = \\frac{4\\pi e^{2}}{q^{2}}.$$ 使用原子单位制，其中$e^{2} = 1$，并在最后将最终能量转换为电子伏特。\n- 在静态极限（零频率）下，对于能带态$n$，自能的库仑空穴分量（静态库仑空穴和屏蔽交换近似中的“COH”部分）由倒易空间表达式定义：$$\\Sigma_{\\mathrm{COH}}^{(n)} = \\frac{1}{2} \\int \\frac{d^{3}q}{(2\\pi)^{3}} \\left[W_{0}(\\mathbf{q},0) - v(\\mathbf{q})\\right] \\left|\\rho_{n}(\\mathbf{q})\\right|^{2},$$ 其中 $\\left|\\rho_{n}(\\mathbf{q})\\right|^{2}$ 是一个描述态$n$在倒易空间中空间延展的模型形状因子。\n\n为使问题良定且可数值实现，作出以下模型假设：\n- 假设各向同性，因此所有量仅依赖于模长 $q = |\\mathbf{q}|$。\n- 对倒易空间中的能带态形状因子使用高斯模型，$$\\left|\\rho_{n}(\\mathbf{q})\\right|^{2} = \\exp\\!\\left(- (q a_{n})^{2}\\right),$$ 其中 $a_{n}$ 是一个以玻尔半径为单位的特征长度，量化了态在实空间中的空间延展（较大的$a_{n}$对应于更离域的态）。\n- 使用一个简单的静态、非局域介电模型，$$\\epsilon(q) = \\epsilon_{\\infty} + \\left(\\frac{q}{q_{0}}\\right)^{2},$$ 其中 $\\epsilon_{\\infty}$ 是高频（光学）介电常数，$q_{0}$ 是一个以逆玻尔为单位的屏蔽波矢尺度。\n- 在有限的截止波矢$q_{\\mathrm{cut}}$（以逆玻尔为单位）处截断积分，并执行数值径向积分。\n\n任务：\n1. 从上述定义出发，推导一个适用于数值计算的一维径向积分，以获得由长度参数$a_{n}$表征的能带态的$$\\Sigma_{\\mathrm{COH}}^{(n)}$$。仔细处理角度积分、倒易空间中的测度以及$W_{0} - v$对$q$的依赖关系。\n2. 使用推导出的表达式，在上述高斯形状因子模型下，计算导带底和价带顶之间的库仑空穴校正差值，$$\\Delta_{\\mathrm{COH}} = \\Sigma_{\\mathrm{COH}}^{(\\mathrm{c})} - \\Sigma_{\\mathrm{COH}}^{(\\mathrm{v})}.$$\n3. 将准粒子带隙估算为$$E_{g}^{GW} \\approx E_{g}^{KS} + \\Delta_{\\mathrm{COH}},$$ 其中 $E_{g}^{KS}$ 是给定的以电子伏特为单位的Kohn-Sham带隙。你必须使用 $1\\,\\mathrm{Hartree} = 27.2114\\,\\mathrm{eV}$ 将计算出的$\\Delta_{\\mathrm{COH}}$从哈特里转换为电子伏特。\n4. 在你的算法设计和附带的推理中，讨论为什么$q \\to 0$（长波）贡献的数值收敛对于半导体来说具有挑战性，以及由于强长程屏蔽，这一挑战在金属中是如何被缓解的。\n\n物理和数值单位：\n- 所有长度$a_{n}$均以玻尔半径为单位。\n- 所有波矢$q$、$q_{0}$和$q_{\\mathrm{cut}}$均以逆玻尔为单位。\n- 最终带隙必须以电子伏特为单位的小数报告。\n- 不出现角度；不需要角度单位。\n\n测试套件和要求的输出：\n在一个单一程序中实现你的推导，以评估以下四个测试用例。每个用例是一个参数元组，顺序为\n$$\\left(E_{g}^{KS}\\,\\mathrm{(eV)},\\,\\epsilon_{\\infty},\\,a_{\\mathrm{v}}\\,\\mathrm{(Bohr)},\\,a_{\\mathrm{c}}\\,\\mathrm{(Bohr)},\\,q_{0}\\,\\mathrm{(1/Bohr)},\\,q_{\\mathrm{cut}}\\,\\mathrm{(1/Bohr)},\\,N_{q}\\right),$$\n其中 $N_{q}$ 是在数值求积中，用于$0$和$q_{\\mathrm{cut}}$之间的均匀径向网格点的数量。\n\n提供以下测试套件：\n- 用例1（一般半导体）：$(1.5,\\,12.0,\\,1.0,\\,1.5,\\,0.5,\\,5.0,\\,2000)$\n- 用例2（宽带隙绝缘体，更强的长程效应）：$(6.0,\\,4.0,\\,0.8,\\,1.2,\\,0.3,\\,8.0,\\,3000)$\n- 用例3（近金属屏蔽，最小校正；相同的态延展）：$(0.7,\\,50.0,\\,1.0,\\,1.0,\\,1.0,\\,6.0,\\,2000)$\n- 用例4（欠收敛的截止和网格以说明敏感性）：$(1.5,\\,12.0,\\,1.0,\\,1.5,\\,0.5,\\,1.0,\\,200)$\n\n最终输出格式：\n你的程序应生成单行输出，包含四个用例计算出的四个$E_{g}^{GW}$值，格式为逗号分隔的列表，并用方括号括起来（例如，“[1.23,2.34,3.45,4.56]”）。所有值必须是以电子伏特为单位的小数。",
            "solution": "用户提供的问题被评估为**有效**。这是一个在简化但标准的物理模型内，定义良好且具有科学依据的问题。问题陈述是自包含的，提供了所有必要的定义、常数和参数。它是客观的，其要求可以算法化形式化。\n\n### 1. $\\Sigma_{\\mathrm{COH}}^{(n)}$的径向积分推导\n\n起点是能带态$n$的静态库仑空穴（COH）自能分量的定义：\n$$\n\\Sigma_{\\mathrm{COH}}^{(n)} = \\frac{1}{2} \\int \\frac{d^{3}q}{(2\\pi)^{3}} \\left[W_{0}(\\mathbf{q},0) - v(\\mathbf{q})\\right] \\left|\\rho_{n}(\\mathbf{q})\\right|^{2}\n$$\n在原子单位制中，基本电荷$e=1$，裸库仑相互作用为 $v(\\mathbf{q}) = \\frac{4\\pi}{|\\mathbf{q}|^2}$。问题假设各向同性，因此所有矢量$\\mathbf{q}$都可以用其标量模长$q = |\\mathbf{q}|$代替。三维倒易空间上的积分因此可以通过切换到球坐标来简化。微分体积元变为$d^{3}q \\to 4\\pi q^2 dq$。积分测度则为：\n$$\n\\int \\frac{d^{3}q}{(2\\pi)^{3}} (\\dots) \\rightarrow \\int_{0}^{\\infty} \\frac{4\\pi q^2 dq}{(2\\pi)^3} (\\dots) = \\int_{0}^{\\infty} \\frac{q^2 dq}{2\\pi^2} (\\dots)\n$$\n自能表达式在有限截止波矢$q_{\\mathrm{cut}}$处截断后，变为：\n$$\n\\Sigma_{\\mathrm{COH}}^{(n)} = \\frac{1}{2} \\int_0^{q_{\\mathrm{cut}}} \\frac{q^2 dq}{2\\pi^2} \\left[W_{0}(q,0) - v(q)\\right] \\left|\\rho_{n}(q)\\right|^{2}\n$$\n屏蔽相互作用$W_{0}(q,0)$通过静态介电函数$\\epsilon(q)$与裸相互作用$v(q)$相关联：\n$$\nW_{0}(q,0) = \\epsilon(q)^{-1} v(q)\n$$\n将此定义代入$[W_{0}(q,0) - v(q)]$项中，可以在数值评估前进行解析简化：\n$$\nW_{0}(q,0) - v(q) = \\epsilon(q)^{-1} v(q) - v(q) = \\left[\\epsilon(q)^{-1} - 1\\right] v(q)\n$$\n将此结果代回$\\Sigma_{\\mathrm{COH}}^{(n)}$的积分中：\n$$\n\\Sigma_{\\mathrm{COH}}^{(n)} = \\frac{1}{2} \\int_0^{q_{\\mathrm{cut}}} \\frac{q^2 dq}{2\\pi^2} \\left[\\epsilon(q)^{-1} - 1\\right] v(q) \\left|\\rho_{n}(q)\\right|^{2}\n$$\n现在，代入$v(q) = 4\\pi/q^2$的显式形式：\n$$\n\\Sigma_{\\mathrm{COH}}^{(n)} = \\frac{1}{2} \\int_0^{q_{\\mathrm{cut}}} \\frac{q^2 dq}{2\\pi^2} \\left[\\epsilon(q)^{-1} - 1\\right] \\frac{4\\pi}{q^2} \\left|\\rho_{n}(q)\\right|^{2}\n$$\n积分测度中的$q^2$项和库仑势中的$1/q^2$项相互抵消。这一步至关重要，因为它消除了在$q=0$处的数值奇异性。\n$$\n\\Sigma_{\\mathrm{COH}}^{(n)} = \\frac{1}{2} \\frac{4\\pi}{2\\pi^2} \\int_0^{q_{\\mathrm{cut}}} \\left[\\epsilon(q)^{-1} - 1\\right] \\left|\\rho_{n}(q)\\right|^{2} dq = \\frac{1}{\\pi} \\int_0^{q_{\\mathrm{cut}}} \\left[\\epsilon(q)^{-1} - 1\\right] \\left|\\rho_{n}(q)\\right|^{2} dq\n$$\n这个最终表达式就是所要求的一维径向积分，其形式良好，适合进行数值求积。\n\n### 2. 带隙校正$\\Delta_{\\mathrm{COH}}$的计算\n\n模型指定了介电函数和形状因子为：\n$$\n\\epsilon(q) = \\epsilon_{\\infty} + \\left(\\frac{q}{q_{0}}\\right)^{2}\n$$\n$$\n\\left|\\rho_{n}(q)\\right|^{2} = \\exp\\!\\left(- (q a_{n})^{2}\\right)\n$$\n准粒子带隙校正$\\Delta_{\\mathrm{COH}}$是导带底（$n=\\mathrm{c}$）和价带顶（$n=\\mathrm{v}$）自能之差：\n$$\n\\Delta_{\\mathrm{COH}} = \\Sigma_{\\mathrm{COH}}^{(\\mathrm{c})} - \\Sigma_{\\mathrm{COH}}^{(\\mathrm{v})}\n$$\n$$\n\\Delta_{\\mathrm{COH}} = \\frac{1}{\\pi} \\int_0^{q_{\\mathrm{cut}}} \\left[\\epsilon(q)^{-1} - 1\\right] \\left|\\rho_{c}(q)\\right|^{2} dq - \\frac{1}{\\pi} \\int_0^{q_{\\mathrm{cut}}} \\left[\\epsilon(q)^{-1} - 1\\right] \\left|\\rho_{v}(q)\\right|^{2} dq\n$$\n为了提高数值计算效率，将它们合并为单个积分：\n$$\n\\Delta_{\\mathrm{COH}} = \\frac{1}{\\pi} \\int_0^{q_{\\mathrm{cut}}} \\left[\\epsilon(q)^{-1} - 1\\right] \\left( \\left|\\rho_{c}(q)\\right|^{2} - \\left|\\rho_{v}(q)\\right|^{2} \\right) dq\n$$\n代入给定的模型形式，得到最终需要实现的表达式：\n$$\n\\Delta_{\\mathrm{COH}} = \\frac{1}{\\pi} \\int_0^{q_{\\mathrm{cut}}} \\left[ \\frac{1}{\\epsilon_{\\infty} + (q/q_0)^2} - 1 \\right] \\left( e^{-(q a_c)^2} - e^{-(q a_v)^2} \\right) dq\n$$\n此积分的结果以哈特里（原子单位能量）为单位。\n\n### 3. 准粒子带隙估算\n\n准粒子带隙$E_{g}^{GW}$通过将COH校正加到Kohn-Sham带隙$E_{g}^{KS}$上来近似：\n$$\nE_{g}^{GW} \\approx E_{g}^{KS} + \\Delta_{\\mathrm{COH}}\n$$\n由于$E_{g}^{KS}$以电子伏特（eV）为单位，因此必须使用转换因子$C = 27.2114\\,\\mathrm{eV/Hartree}$将$\\Delta_{\\mathrm{COH}}$从哈特里转换为eV。\n$$\nE_{g}^{GW} (\\mathrm{eV}) = E_{g}^{KS} (\\mathrm{eV}) + \\Delta_{\\mathrm{COH}} (\\mathrm{Hartree}) \\times C\n$$\n\n### 4. 算法设计与数值收敛性讨论\n\n该算法实现了对推导出的$\\Delta_{\\mathrm{COH}}$一维积分的数值求积。\n1.  为波矢模长$q$在区间$[0, q_{\\mathrm{cut}}]$上生成一个包含$N_q$个点的均匀网格。\n2.  在每个网格点上计算被积函数的值。\n3.  使用梯形法则计算定积分，如`numpy.trapz`所实现的，它非常适合对在规则间隔上采样的函数进行积分。\n4.  将结果$\\Delta_{\\mathrm{COH}}$从哈特里转换为eV，并加到初始的Kohn-Sham带隙$E_g^{KS}$上。\n\n此问题的一个核心概念点是对小$q$处被积函数的数值处理。裸库仑相互作用$v(q)$和屏蔽相互作用$W_0(q,0)$在$q \\to 0$时都以$1/q^2$的形式发散。一种简单的数值方法是分别计算这两个量然后相减，但这会由于灾难性抵消误差（一个“$\\infty - \\infty$”问题）而失败。上述推导通过首先进行解析减法来规避了这个问题：\n$$\nW_{0}(q,0) - v(q) = (\\epsilon(q)^{-1} - 1) v(q)\n$$\n当它与径向积分测度中的$q^2$因子结合时，整个被积函数中与$q$相关的部分变为：\n$$\nq^2 \\left[W_0(q,0) - v(q)\\right] = q^2 \\left( \\frac{1}{\\epsilon_{\\infty} + (q/q_0)^2} - 1 \\right) \\frac{4\\pi}{q^2} = 4\\pi \\left( \\frac{1 - \\epsilon_\\infty - (q/q_0)^2}{\\epsilon_\\infty + (q/q_0)^2} \\right)\n$$\n该表达式在$q=0$时显然是有限的，其值为$4\\pi (1-\\epsilon_{\\infty})/\\epsilon_{\\infty}$。这个被称为“奇异点处理”的解析步骤，对于获得数值稳定的解至关重要。\n\n数值收敛的挑战与半导体和金属中屏蔽的物理学有关。\n-   **半导体：** 屏蔽是不完全的。静态介电常数$\\epsilon(q\\to 0)$是一个有限值（在此模型中，$\\epsilon_\\infty > 1$）。屏蔽相互作用$W_0(q)$仍然有一个长程的$1/(\\epsilon_\\infty q^2)$尾部。在离散$\\mathbf{q}$点网格上的实际三维计算中，这需要在$\\mathbf{q}=0$附近有非常高密度的网格点才能准确捕捉该区域对积分的巨大贡献，从而导致数值收敛缓慢。\n-   **金属：** 屏蔽效果要有效得多。金属的实际介电函数在$q \\to 0$时发散（例如，$\\epsilon(q) \\sim 1/q^2$）。这种“完美屏蔽”使得屏蔽相互作用$W_0(q,0) = v(q)/\\epsilon(q)$在$q\\to 0$时趋于零。差值项变为$W_0(q,0) - v(q) \\to -v(q)$。不存在两个独立发散项的相减。金属中$W_0$的短程性质意味着涉及它的积分相对于$\\mathbf{q}$点网格的密度收敛得更快。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the GW band gap problem for the given test cases.\n    \"\"\"\n\n    # Conversion factor from Hartree to electron-volts.\n    HARTREE_TO_EV = 27.2114\n\n    # Test cases as tuples of parameters:\n    # (E_g_KS (eV), epsilon_inf, a_v (Bohr), a_c (Bohr), q0 (1/Bohr), q_cut (1/Bohr), N_q)\n    test_cases = [\n        (1.5, 12.0, 1.0, 1.5, 0.5, 5.0, 2000),\n        (6.0, 4.0, 0.8, 1.2, 0.3, 8.0, 3000),\n        (0.7, 50.0, 1.0, 1.0, 1.0, 6.0, 2000),\n        (1.5, 12.0, 1.0, 1.5, 0.5, 1.0, 200)\n    ]\n\n    def calculate_Eg_GW(params):\n        \"\"\"\n        Calculates the G0W0 quasiparticle band gap for a single parameter set.\n        \n        The function computes the Coulomb-hole self-energy correction Delta_COH by\n        numerically integrating the derived radial integral using the trapezoidal rule.\n        \"\"\"\n        E_g_KS, epsilon_inf, a_v, a_c, q0, q_cut, N_q = params\n\n        # 1. Set up the uniform grid for numerical integration in reciprocal space.\n        # q is the magnitude of the wavevector, in inverse Bohr units.\n        q = np.linspace(0, q_cut, N_q)\n\n        # 2. Evaluate the components of the integrand at each grid point.\n        # The equation for Delta_COH is:\n        # Delta_COH = (1/pi) * integral_0^q_cut [ (1/epsilon(q)) - 1 ] * [ exp(-(q*ac)^2) - exp(-(q*av)^2) ] dq\n        \n        # Avoid division by zero if q0 is close to zero, although valid inputs should have q0 > 0.\n        # This term is safe for q=0 since it adds to epsilon_inf.\n        q_over_q0_sq = (q / q0)**2\n        \n        # Dielectric function term: [ epsilon(q)^-1 - 1 ]\n        epsilon_q = epsilon_inf + q_over_q0_sq\n        dielectric_term = (1.0 / epsilon_q) - 1.0\n        \n        # Form factor term: [ |rho_c(q)|^2 - |rho_v(q)|^2 ]\n        # The exponentials are well-behaved.\n        q_ac_sq = (q * a_c)**2\n        q_av_sq = (q * a_v)**2\n        form_factor_term = np.exp(-q_ac_sq) - np.exp(-q_av_sq)\n        \n        # 3. Combine terms to form the full integrand.\n        integrand = (1.0 / np.pi) * dielectric_term * form_factor_term\n        \n        # 4. Perform the numerical integration using the trapezoidal rule.\n        # The result delta_coh is in Hartrees (atomic units of energy).\n        delta_coh_hartree = np.trapz(integrand, q)\n        \n        # 5. Convert the correction from Hartrees to eV.\n        delta_coh_ev = delta_coh_hartree * HARTREE_TO_EV\n        \n        # 6. Calculate the final quasiparticle band gap.\n        E_g_GW = E_g_KS + delta_coh_ev\n        \n        return E_g_GW\n\n    results = []\n    for case in test_cases:\n        result = calculate_Eg_GW(case)\n        results.append(result)\n\n    # Format the results into the required string format \"[r1,r2,r3,r4]\".\n    # Using str() provides default float formatting.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}