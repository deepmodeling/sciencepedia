{"hands_on_practices": [{"introduction": "我们从一个基础但重要的练习开始，它将帮助你掌握单随机变量变换的核心方法。这个练习探讨了如何从一个均匀分布的角度（在物理学中常用于模拟散射或相位）推导出另一个相关变量的分布 [@problem_id:1347059]。通过这个实践，你将学会应用变量替换公式，这是从已知分布推导新分布的一项基本技能。", "problem": "在一个模拟波散射的物理实验中，散射角 $\\Theta$ 是一个在区间 $(0, \\pi)$ 上均匀分布的随机变量。一个测量设备被设计用来记录一个变换后的值 $Y$，该值通过函数 $Y = \\tan(\\Theta)$ 与散射角相关联。求随机变量 $Y$ 的概率密度函数 (PDF)，记作 $f_Y(y)$。", "solution": "设 $\\Theta$ 在 $(0,\\pi)$ 上均匀分布，所以其概率密度函数为\n$$\nf_{\\Theta}(\\theta)=\\frac{1}{\\pi}, \\quad 0  \\theta  \\pi.\n$$\n定义 $Y=\\tan(\\Theta)$。对于每个 $y\\in\\mathbb{R}$，方程 $\\tan(\\theta)=y$ 在 $(0,\\pi)$ 内有且仅有一个解：\n- 如果 $y>0$，那么 $\\theta(y)=\\arctan(y)\\in(0,\\frac{\\pi}{2})$。\n- 如果 $y0$，那么 $\\theta(y)=\\arctan(y)+\\pi\\in(\\frac{\\pi}{2},\\pi)$。\n点 $y=0$ 对应于 $\\theta=0$ 或 $\\theta=\\pi$，它们在开区间之外，因此概率为零；故该映射几乎处处是一一对应的。\n\n对于一个可微的一一变换，使用变量替换公式，\n$$\nf_{Y}(y)=f_{\\Theta}(\\theta(y))\\left|\\frac{d\\theta}{dy}\\right|.\n$$\n对 $y=\\tan(\\theta)$ 求导，得到\n$$\n\\frac{dy}{d\\theta}=\\sec^{2}(\\theta)=1+\\tan^{2}(\\theta)=1+y^{2},\n$$\n所以\n$$\n\\frac{d\\theta}{dy}=\\frac{1}{1+y^{2}}.\n$$\n因此，\n$$\nf_{Y}(y)=\\frac{1}{\\pi}\\cdot\\frac{1}{1+y^{2}}, \\quad y\\in\\mathbb{R}.\n$$\n对其积分结果为 $1$，因为\n$$\n\\int_{-\\infty}^{\\infty}\\frac{1}{\\pi(1+y^{2})}\\,dy=\\frac{1}{\\pi}\\left[\\arctan(y)\\right]_{-\\infty}^{\\infty}=1,\n$$\n这证实了它是一个有效的概率密度函数。", "answer": "$$\\boxed{f_{Y}(y)=\\frac{1}{\\pi\\left(1+y^{2}\\right)}\\text{ 对于 }y\\in\\mathbb{R}}$$", "id": "1347059"}, {"introduction": "在许多科学和工程问题中，我们感兴趣的量是多个随机因素的函数，例如两个独立测量值的比率。这个练习将我们的技能从单变量扩展到多变量变换，通过一个流体动力学的场景来引入问题 [@problem_id:1407993]。你将应用雅可比行列式方法来推导两个独立标准正态随机变量之比的分布，这是一个在统计理论中具有重要地位的经典结果。", "problem": "在一个简化的二维湍流模型中，我们追踪一个微小示踪粒子的运动。在某一特定时刻，该粒子沿x轴和y轴的速度分量（分别表示为$V_x$和$V_y$）被建模为独立的随机变量。$V_x$和$V_y$均被假定服从标准正态分布，即均值为0、方差为1的正态分布。\n\n一位实验者对粒子速度矢量相对于x轴的斜率的统计特性感兴趣。该斜率由随机变量$S = \\frac{V_y}{V_x}$定义。\n\n求随机变量$S$的概率密度函数（PDF）。你的最终答案应为一个关于$S$的单一、封闭形式的解析表达式。", "solution": "设速度分量的随机变量为$X$和$Y$，因此$S = Y/X$。$X$和$Y$相互独立，且都服从标准正态分布$\\mathcal{N}(0,1)$。它们的概率密度函数（PDF）由下式给出：\n$$f_X(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right)$$\n$$f_Y(y) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{y^2}{2}\\right)$$\n由于$X$和$Y$相互独立，它们的联合概率密度函数是各自概率密度函数的乘积：\n$$f_{X,Y}(x,y) = f_X(x)f_Y(y) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{x^2+y^2}{2}\\right)$$\n我们要求$S = Y/X$的概率密度函数。我们可以使用双随机变量的变量替换法。我们引入一个辅助随机变量，例如$W = X$。这就定义了一个从$(X, Y)$到$(S, W)$的变换。\n\n该变换为：\n$S = Y/X$\n$W = X$\n\n接下来，我们求逆变换，将$X$和$Y$用$S$和$W$表示：\n$X = W$\n$Y = SW$\n\n现在，我们需要计算这个逆变换的雅可比行列式。雅可比行列式$J$由下式给出：\n$$J = \\det \\begin{pmatrix} \\frac{\\partial x}{\\partial s}  \\frac{\\partial x}{\\partial w} \\\\ \\frac{\\partial y}{\\partial s}  \\frac{\\partial y}{\\partial w} \\end{pmatrix} = \\det \\begin{pmatrix} 0  1 \\\\ w  s \\end{pmatrix} = (0)(s) - (1)(w) = -w$$\n雅可比行列式的绝对值为$|J| = |-w| = |w|$。\n\n新变量$S$和$W$的联合概率密度函数，记为$f_{S,W}(s,w)$，由以下公式给出：\n$$f_{S,W}(s,w) = f_{X,Y}(x(s,w), y(s,w)) |J|$$\n将$x=w$和$y=sw$代入联合概率密度函数$f_{X,Y}(x,y)$：\n$$f_{S,W}(s,w) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{w^2 + (sw)^2}{2}\\right) |w|$$\n$$f_{S,W}(s,w) = \\frac{|w|}{2\\pi} \\exp\\left(-\\frac{w^2(1+s^2)}{2}\\right)$$\n该联合概率密度函数定义在$s \\in (-\\infty, \\infty)$和$w \\in (-\\infty, \\infty)$，且$w \\neq 0$的区间上。\n\n为了求出$S$的边缘概率密度函数$f_S(s)$，我们将联合概率密度函数$f_{S,W}(s,w)$对$w$在其整个取值范围上进行积分。\n$$f_S(s) = \\int_{-\\infty}^{\\infty} f_{S,W}(s,w) \\, dw = \\int_{-\\infty}^{\\infty} \\frac{|w|}{2\\pi} \\exp\\left(-\\frac{w^2(1+s^2)}{2}\\right) \\, dw$$\n被积函数是关于$w$的偶函数，因为$|-w| = |w|$且$(-w)^2 = w^2$。因此，我们可以简化积分为：\n$$f_S(s) = 2 \\int_{0}^{\\infty} \\frac{w}{2\\pi} \\exp\\left(-\\frac{w^2(1+s^2)}{2}\\right) \\, dw$$\n$$f_S(s) = \\frac{1}{\\pi} \\int_{0}^{\\infty} w \\exp\\left(-\\frac{w^2(1+s^2)}{2}\\right) \\, dw$$\n为了求解这个积分，我们使用u换元法。令$u = \\frac{w^2(1+s^2)}{2}$。\n则其微分为$du = \\frac{2w(1+s^2)}{2} dw = w(1+s^2) dw$。\n可以整理为$w \\, dw = \\frac{du}{1+s^2}$。\n我们检查积分限。当$w=0$时，$u=0$。当$w \\to \\infty$时，$u \\to \\infty$。积分限仍为$(0, \\infty)$。\n\n将这些代入$f_S(s)$的积分中：\n$$f_S(s) = \\frac{1}{\\pi} \\int_{0}^{\\infty} \\exp(-u) \\left(\\frac{du}{1+s^2}\\right)$$\n项$\\frac{1}{1+s^2}$相对于$u$是常数，因此可以将其从积分中提出：\n$$f_S(s) = \\frac{1}{\\pi(1+s^2)} \\int_{0}^{\\infty} \\exp(-u) \\, du$$\n剩下的积分是一个标准积分：\n$$\\int_{0}^{\\infty} \\exp(-u) \\, du = [-\\exp(-u)]_{0}^{\\infty} = (-\\exp(-\\infty)) - (-\\exp(0)) = 0 - (-1) = 1$$\n因此，$S$的概率密度函数为：\n$$f_S(s) = \\frac{1}{\\pi(1+s^2)}$$\n这是标准柯西分布的概率密度函数，定义域为$s \\in (-\\infty, \\infty)$。根据题目要求，将变量$s$替换为$S$，得到最终的函数形式。", "answer": "$$\\boxed{\\frac{1}{\\pi(1+S^2)}}$$", "id": "1407993"}, {"introduction": "并非所有的变换都是一对一的。当多个输入值映射到同一个输出值时，我们需要一种不同的方法。这个练习通过一个可靠性工程中的假设场景——只记录设备寿命的小数部分——来介绍如何处理“多对一”变换 [@problem_id:1347107]。你将学习通过对所有相关的输入值对应的概率密度进行求和，来推导输出变量的分布，这项技术对于处理周期性或循环性现象至关重要。", "problem": "在可靠性工程中，某些电子元件的寿命通常用指数分布来建模。考虑一个元件，其寿命 $X$（以千小时为单位）是一个服从标准指数分布的随机变量。$X$ 的概率密度函数 (PDF) 为 $f_X(x) = \\exp(-x)$ (当 $x \\ge 0$ 时)，以及 $f_X(x) = 0$ (当 $x  0$ 时)。\n\n一项检查规程被设计用于记录的不是总寿命，而只是寿命的小数部分。设 $Y$ 是代表该元件寿命小数部分的随机变量，定义为 $Y = X - \\lfloor X \\rfloor$，其中 $\\lfloor X \\rfloor$ 是向下取整函数，代表在失效前已完成的完整千小时区间的数量。\n\n求随机变量 $Y$ 的概率密度函数 $f_Y(y)$。你的最终表达式应对区间 $[0, 1)$ 内的 $y$ 有效。", "solution": "设 $X$ 的标准指数密度函数为 $f_{X}(x)=\\exp(-x)$ (当 $x\\ge 0$) 且 $f_{X}(x)=0$ (当 $x0$)。定义 $Y=X-\\lfloor X\\rfloor$，即 $X$ 的小数部分。对于任意固定的 $y\\in[0,1)$，在映射 $x\\mapsto x-\\lfloor x\\rfloor$ 下，$y$ 的原像是可数集 $\\{y+k: k=0,1,2,\\dots\\}$。由于 $X\\ge 0$，只有 $k\\ge 0$ 的项才有贡献。\n\n根据在每个分支上雅可比行列式为1的多对一变换下的密度全概率法则，$Y$ 的密度为\n$$\nf_{Y}(y)=\\sum_{k=0}^{\\infty} f_{X}(y+k), \\quad 0\\le y  1.\n$$\n代入 $f_{X}(x)=\\exp(-x)$ 得\n$$\nf_{Y}(y)=\\sum_{k=0}^{\\infty} \\exp\\big(-(y+k)\\big)=\\exp(-y)\\sum_{k=0}^{\\infty} \\exp(-k).\n$$\n使用几何级数 $\\sum_{k=0}^{\\infty} r^{k}=\\frac{1}{1-r}$ (对于 $|r|1$)，并令 $r=\\exp(-1)$，我们得到\n$$\nf_{Y}(y)=\\frac{\\exp(-y)}{1-\\exp(-1)}, \\quad 0\\le y  1.\n$$\n为验证其在 $[0,1)$ 上的归一性，\n$$\n\\int_{0}^{1} f_{Y}(y)\\,dy=\\frac{1}{1-\\exp(-1)}\\int_{0}^{1}\\exp(-y)\\,dy=\\frac{1-\\exp(-1)}{1-\\exp(-1)}=1,\n$$\n所以这是一个在 $[0,1)$ 上的有效概率密度。", "answer": "$$\\boxed{\\frac{\\exp(-y)}{1-\\exp(-1)}}$$", "id": "1347107"}]}