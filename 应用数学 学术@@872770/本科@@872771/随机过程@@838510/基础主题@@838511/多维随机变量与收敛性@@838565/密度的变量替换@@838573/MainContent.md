## 引言
在科学与工程的广阔天地中，我们常常面对的不是孤立的随机量，而是这些随机量经过各种系统或[函数变换](@entry_id:141095)后的结果。例如，一个随机的输入电压经过电子线路后会产生怎样的输出电压[分布](@entry_id:182848)？一个随机速度的粒子，其动能的[分布](@entry_id:182848)又是什么？解答这些问题的核心在于掌握[随机变量](@entry_id:195330)的“变量变换”方法：给定一个[随机变量](@entry_id:195330)及其[概率分布](@entry_id:146404)，如何求出它的某个函数的[概率分布](@entry_id:146404)。这一技能是连接抽象[概率模型](@entry_id:265150)与现实世界[可观测量](@entry_id:267133)的关键桥梁，也是深入理解不确定性如何在系统中传播和演化的基石。

本文旨在系统性地介绍求解变换后[随机变量](@entry_id:195330)密度函数的原理、机制与应用。我们将从最基础的工具出发，逐步构建一个解决此类问题的完整框架。
- 在“原理与机制”一章中，我们将详细探讨从单变量到多维变量的变换法则。您将学习到普适的[累积分布函数](@entry_id:143135)（CDF）法、针对单调和非[单调函数](@entry_id:145115)的直接公式，以及处理多维变换时至关重要的雅可比行列式。
- 在“应用与跨学科联系”一章中，我们将把这些理论工具应用于物理学、[通信工程](@entry_id:272129)、机器学习和金融学等多个领域，展示变量变换法则如何帮助我们理解从[粒子速度](@entry_id:196946)到资产价格等各种现象的统计特性。
- 最后，在“动手实践”部分，您将通过解决一系列精心挑选的具体问题，来巩固和检验您对这些核心概念的理解。

通过本文的学习，您将不仅掌握一项强大的数学技术，更能洞悉不确定性在不同系统和模型中演化的普遍规律。让我们一同开始这段探索之旅。

## 原理与机制

在[随机过程](@entry_id:159502)和概率论的研究中，我们经常需要分析已知[随机变量的函数](@entry_id:271583)。例如，我们可能知道一个系统中某个输入信号的[概率分布](@entry_id:146404)，并希望确定经过某个物理或数学变换后输出信号的[分布](@entry_id:182848)。这一过程被称为变量变换，而我们的核心任务是，给定原始[随机变量](@entry_id:195330) $X$ 的[概率密度函数](@entry_id:140610)（PDF）$f_X(x)$ 以及一个变换函数 $g$，求出新[随机变量](@entry_id:195330) $Y=g(X)$ 的概率密度函数 $f_Y(y)$。本章将系统地阐述解决此类问题的基本原理和核心机制，从单变量变换逐步推广到多维变换，并探讨其在不同科学与工程领域中的应用。

### 一维[随机变量的变换](@entry_id:267283)

我们首先从最简单的情形入手：一个连续型[随机变量](@entry_id:195330)经过某个[函数变换](@entry_id:141095)。根据变换函数的性质，我们可以采用不同的方法来求解新变量的密度函数。

#### 累积分布函数（CDF）法

最基本且普适的方法是利用累积分布函数（CDF）。无论变换函数 $g$ 的形式如何，该方法都提供了一个可靠的求[解路径](@entry_id:755046)。其核心步骤如下：

1.  **写出 $Y$ 的 CDF 定义**：$F_Y(y) = P(Y \le y)$。
2.  **用 $X$ 替代 $Y$**：将 $Y = g(X)$ 代入，得到 $F_Y(y) = P(g(X) \le y)$。
3.  **求解不等式**：求解不等式 $g(X) \le y$，将其转化为关于 $X$ 的一个或多个区间的条件。然后利用 $X$ 的已知 PDF $f_X(x)$ 对这些区间进行积分，从而得到 $F_Y(y)$ 的表达式。
4.  **求导**：对 $F_Y(y)$ 求导，即可得到 $Y$ 的 PDF：$f_Y(y) = \frac{d}{dy}F_Y(y)$。

让我们通过一个例子来理解这个过程。假设一个[随机变量](@entry_id:195330) $X$ 服从标准[拉普拉斯分布](@entry_id:266437)，其 PDF 为 $f_X(x) = \frac{1}{2} \exp(-|x|)$。我们感兴趣的是新[随机变量](@entry_id:195330) $Y = |X|$ 的[分布](@entry_id:182848) [@problem_id:1287723]。由于 $Y$ 必然非负，我们只考虑 $y \ge 0$ 的情况。

首先，我们写出 $Y$ 的 CDF：
$F_Y(y) = P(Y \le y) = P(|X| \le y)$

由于 $y \ge 0$，不等式 $|X| \le y$ 等价于 $-y \le X \le y$。因此，
$F_Y(y) = P(-y \le X \le y) = \int_{-y}^{y} f_X(x) \,dx = \int_{-y}^{y} \frac{1}{2} \exp(-|x|) \,dx$

利用被积函数的偶对称性，我们可以将积分简化：
$F_Y(y) = 2 \int_{0}^{y} \frac{1}{2} \exp(-x) \,dx = \int_{0}^{y} \exp(-x) \,dx = [-\exp(-x)]_{0}^{y} = 1 - \exp(-y)$

最后，对 CDF 求导得到 PDF：
$f_Y(y) = \frac{d}{dy} (1 - \exp(-y)) = \exp(-y)$，对于 $y \ge 0$。

这表明，标准拉普拉斯[随机变量](@entry_id:195330)的[绝对值](@entry_id:147688)服从参数为 1 的指数分布。CDF 法的优点在于其逻辑的普适性，它能处理各种复杂的变换，包括那些将产生混合型[分布](@entry_id:182848)的变换，我们将在稍后讨论。

#### [单调函数](@entry_id:145115)的变换公式

当变换函数 $g(x)$ 是严格单调（即严格递增或严格递减）时，我们可以使用一个更直接的公式，避免了积分步骤。对于一个严格单调的函数 $g$，其反函数 $x = g^{-1}(y)$ 是唯一确定的。

我们可以从 CDF 法出发推导出这个公式。假设 $g$ 是严格递增的，那么 $g(X) \le y$ 等价于 $X \le g^{-1}(y)$。因此，
$F_Y(y) = P(X \le g^{-1}(y)) = F_X(g^{-1}(y))$

利用链式法则对上式求导，得到：
$f_Y(y) = \frac{d}{dy}F_X(g^{-1}(y)) = f_X(g^{-1}(y)) \cdot \frac{d}{dy}g^{-1}(y)$

如果 $g$ 是严格递减的，那么 $g(X) \le y$ 等价于 $X \ge g^{-1}(y)$。因此，
$F_Y(y) = P(X \ge g^{-1}(y)) = 1 - F_X(g^{-1}(y))$

对其求导得到：
$f_Y(y) = -\frac{d}{dy}F_X(g^{-1}(y)) = -f_X(g^{-1}(y)) \cdot \frac{d}{dy}g^{-1}(y)$

注意到对于递减函数，$ \frac{d}{dy}g^{-1}(y)$ 是负的。因此，我们可以将这两种情况统一为一个包含[绝对值](@entry_id:147688)的公式：

$f_Y(y) = f_X(g^{-1}(y)) \left| \frac{d}{dy}g^{-1}(y) \right|$

这个公式提供了一个求解单调变换问题的“机械”方法：求[反函数](@entry_id:141256)、计算其导数、代入原始密度函数。

**示例 1：线性变换**
考虑一个[标准布朗运动](@entry_id:197332) $W_t$，在任意固定时刻 $t \gt 0$，$W_t$ 是一个均值为 0、[方差](@entry_id:200758)为 $t$ 的正态[随机变量](@entry_id:195330)，其 PDF 为 $f_{W_t}(x) = \frac{1}{\sqrt{2\pi t}} \exp(-\frac{x^2}{2t})$。如果我们对这个过程进行线性的放大和平移，得到 $Y_t = aW_t + b$（其中 $a \neq 0$）[@problem_id:1287712]，该如何求 $Y_t$ 的密度？
这里的变换函数 $g(w) = aw+b$ 是严格单调的。其反函数为 $w = g^{-1}(y) = \frac{y-b}{a}$。[反函数的导数](@entry_id:158287)为 $\frac{d}{dy}g^{-1}(y) = \frac{1}{a}$。
应用变换公式，我们得到：
$f_{Y_t}(y) = f_{W_t}\left(\frac{y-b}{a}\right) \left|\frac{1}{a}\right| = \frac{1}{\sqrt{2\pi t}} \exp\left(-\frac{(\frac{y-b}{a})^2}{2t}\right) \cdot \frac{1}{|a|} = \frac{1}{|a|\sqrt{2\pi t}} \exp\left(-\frac{(y-b)^2}{2a^2t}\right)$
这正是均值为 $b$、[方差](@entry_id:200758)为 $a^2t$ 的[正态分布](@entry_id:154414)的 PDF。这个结果符合我们对[正态分布](@entry_id:154414)[线性变换](@entry_id:149133)性质的直觉。

**示例 2：[非线性变换](@entry_id:636115)**
考虑一个在单位半圆上运动的粒子，其位置由角度 $\Theta$ 决定，$\Theta$ 在 $[-\pi/2, \pi/2]$ 上[均匀分布](@entry_id:194597)，即 $f_\Theta(\theta) = 1/\pi$。我们想知道其垂直坐标 $Y = \sin(\Theta)$ 的[分布](@entry_id:182848) [@problem_id:1287741]。
在区间 $[-\pi/2, \pi/2]$ 上，$g(\theta)=\sin(\theta)$ 是严格递增函数，其值域为 $[-1, 1]$。[反函数](@entry_id:141256)为 $\theta = g^{-1}(y) = \arcsin(y)$。其导数为 $\frac{d\theta}{dy} = \frac{1}{\sqrt{1-y^2}}$。
应用公式：
$f_Y(y) = f_\Theta(\arcsin(y)) \left| \frac{1}{\sqrt{1-y^2}} \right| = \frac{1}{\pi} \cdot \frac{1}{\sqrt{1-y^2}}$，对于 $y \in (-1, 1)$。
这个结果被称为反正弦[分布](@entry_id:182848)，它描述了当角度均匀变化时，其在坐标轴上的投影的[分布](@entry_id:182848)情况，这种[分布](@entry_id:182848)在两端点处密度趋于无穷，反映了粒子在最高点和最低点附近“逗留”时间更长的现象。

**示例 3：[对数变换](@entry_id:267035)**
在金融学中，资产价格 $V$ 常被建模为对数正态分布。根据定义，若 $\ln(V)$ 服从均值为 $\mu$、[方差](@entry_id:200758)为 $\sigma^2$ 的正态分布，则 $V$ 服从[对数正态分布](@entry_id:261888)。现在反过来思考，如果已知 $V$ 的对数正态 PDF，我们能否通过变量变换推导出其对数效用 $U = \ln(V)$ 的[分布](@entry_id:182848) [@problem_id:1287732]？
$V$ 的 PDF 为 $f_V(v) = \frac{1}{v\sigma\sqrt{2\pi}} \exp\left(-\frac{(\ln(v)-\mu)^2}{2\sigma^2}\right)$，对于 $v \gt 0$。
变换 $u = g(v) = \ln(v)$ 是严格递增的。其反函数为 $v = g^{-1}(u) = \exp(u)$，导数为 $\frac{dv}{du} = \exp(u)$。
应用公式：
$f_U(u) = f_V(\exp(u)) \left| \frac{dv}{du} \right| = \frac{1}{\exp(u)\sigma\sqrt{2\pi}} \exp\left(-\frac{(\ln(\exp(u))-\mu)^2}{2\sigma^2}\right) \cdot \exp(u)$
化简后，$\exp(u)$ 项相互抵消：
$f_U(u) = \frac{1}{\sigma\sqrt{2\pi}} \exp\left(-\frac{(u-\mu)^2}{2\sigma^2}\right)$
这正是均值为 $\mu$、[方差](@entry_id:200758)为 $\sigma^2$ 的正态分布的 PDF。这个结果验证了对数正态分布定义的[自洽性](@entry_id:160889)，并展示了变换公式的威力。

#### 非单调函数的变换

如果函数 $g(x)$ 不是单调的，例如 $y = x^2$，那么对于一个给定的 $y$ 值，可能存在多个 $x$ 值与之对应。在这种情况下，我们不能直接使用单一的[反函数](@entry_id:141256)。其思想是，落在区间 $[y, y+dy]$ 内的概率，是所有能够映射到此区间的源区间 $[x_i, x_i+dx_i]$ 概率之和。这引出了一个更广义的公式：

$f_Y(y) = \sum_{i} \frac{f_X(x_i)}{|g'(x_i)|}$

其中，$x_i$ 是方程 $g(x) = y$ 的所有实数解，求和遍历所有这些解。分母中的 $|g'(x_i)|$ 是变换在每个解 $x_i$ 处的局部“拉伸因子”的倒数。

**示例 1：二次变换**
在一个简化的气体模型中，粒子的一维速度 $V$ 服从[标准正态分布](@entry_id:184509) $f_V(v) = \frac{1}{\sqrt{2\pi}}\exp(-\frac{v^2}{2})$。其动能由 $E = \frac{1}{2}mV^2$ 给出，其中 $m$ 是质量 [@problem_id:1287746]。
这里的变换是 $g(v) = \frac{1}{2}mv^2$。对于任意给定的能量 $e \gt 0$，方程 $\frac{1}{2}mv^2 = e$ 有两个解：$v_1 = \sqrt{\frac{2e}{m}}$ 和 $v_2 = -\sqrt{\frac{2e}{m}}$。
[变换的导数](@entry_id:164838)是 $g'(v) = mv$。在两个解处，导数的[绝对值](@entry_id:147688)是 $|g'(v_{1,2})| = m|\pm\sqrt{\frac{2e}{m}}| = \sqrt{2me}$。
现在，应用[非单调变换](@entry_id:271768)公式：
$f_E(e) = \frac{f_V(v_1)}{|g'(v_1)|} + \frac{f_V(v_2)}{|g'(v_2)|}$
$f_E(e) = \frac{1}{\sqrt{2me}} \left[ \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}\left(\sqrt{\frac{2e}{m}}\right)^2\right) + \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}\left(-\sqrt{\frac{2e}{m}}\right)^2\right) \right]$
$f_E(e) = \frac{1}{\sqrt{2me}} \left[ 2 \cdot \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{e}{m}\right) \right] = \frac{1}{\sqrt{\pi me}} \exp\left(-\frac{e}{m}\right)$
这个结果是伽马[分布](@entry_id:182848)的一个特例，它与物理学中的麦克斯韦-玻尔兹曼分布密切相关。

**示例 2：模运算变换**
在[放射性衰变](@entry_id:142155)研究中，两次衰变之间的时间间隔 $T$ 服从均值为 $\tau$ 的[指数分布](@entry_id:273894)，$f_T(t) = \frac{1}{\tau}\exp(-t/\tau)$。如果一个计时器每隔 $L$ 秒重置一次，那么观测到的时间将是 $Y = T \pmod L$ [@problem_id:1287715]。
这是一个“无限对一”的变换。对于任意一个观测值 $y \in [0, L)$，真实的衰变时间 $T$ 可能是 $y, y+L, y+2L, \dots$。也就是说，方程 $t \pmod L = y$ 的解是 $t_k = y+kL$，其中 $k = 0, 1, 2, \dots$。
在这个分段线性的变换中，$g'(t)=1$（在每个长度为 $L$ 的区间内）。因此，应用求和公式：
$f_Y(y) = \sum_{k=0}^{\infty} \frac{f_T(y+kL)}{|1|} = \sum_{k=0}^{\infty} \frac{1}{\tau} \exp\left(-\frac{y+kL}{\tau}\right)$
$f_Y(y) = \frac{1}{\tau}\exp\left(-\frac{y}{\tau}\right) \sum_{k=0}^{\infty} \left(\exp\left(-\frac{L}{\tau}\right)\right)^k$
这是一个[等比级数](@entry_id:158490)，其和为 $\frac{1}{1-\exp(-L/\tau)}$。所以，在 $[0, L)$ 上的 PDF 为：
$f_Y(y) = \frac{1}{\tau(1-\exp(-L/\tau))} \exp\left(-\frac{y}{\tau}\right)$
这是一个截断的[指数分布](@entry_id:273894)，经过重新归一化以确保在 $[0, L)$ 上的积分为 1。这个例子展示了该公式如何优雅地处理无限对一的周期性变换。

### 产生[混合分布](@entry_id:276506)的变换

前面的讨论都假设变换后的[随机变量](@entry_id:195330)仍然是纯连续的。然而，某些变换可以将原始连续变量的一个非零概率[区间映射](@entry_id:194829)到单一一个点上。这会在该点产生一个**概率质量**，使得新的[随机变量](@entry_id:195330)的[分布](@entry_id:182848)变为**混合型**（既有连续部分，又有离散部分）。

在这种情况下，直接套用为连续分布设计的 PDF 公式是行不通的。CDF 法再次显示出其稳健性，因为 CDF 可以自然地处理[分布](@entry_id:182848)中的跳跃（对应于离散的概率质量点）。

考虑一个[半波整流](@entry_id:263423)电路，其输入电压 $V_{in}$ 在 $[-1, 1]$ 上[均匀分布](@entry_id:194597)，$f_{V_{in}}(v) = 1/2$。输出电压为 $V_{out} = \max(0, V_{in})$ [@problem_id:1287714]。
当 $V_{in}$ 在 $[-1, 0]$ 区间取值时，$V_{out}$ 恒为 0。这个事件的概率是 $P(-1 \le V_{in} \le 0) = \int_{-1}^{0} \frac{1}{2} dv = \frac{1}{2}$。这意味着，输出电压 $V_{out}$ 在 $v=0$ 这一点上有 $1/2$ 的概率质量。
当 $V_{in}$ 在 $(0, 1]$ 区间取值时，$V_{out} = V_{in}$。
我们使用 CDF 法来形式化地描述它。设 $X=V_{in}, Y=V_{out}$。
对于 $y \lt 0$，$F_Y(y) = P(\max(0,X) \le y) = 0$。
对于 $y \ge 0$，
$F_Y(y) = P(\max(0,X) \le y) = P(X \le y)$
由于 $X$ 的定义域是 $[-1,1]$，我们需要分情况讨论：
-   如果 $0 \le y \lt 1$，$F_Y(y) = P(X \le y) = \int_{-1}^{y} \frac{1}{2} dx = \frac{1}{2}(y - (-1)) = \frac{y+1}{2}$。
-   如果 $y \ge 1$，$F_Y(y) = P(X \le y) = P(X \le 1) = 1$。
综合起来，CDF 为：
$F_Y(y) = \begin{cases} 0,  & y \lt 0 \\ \frac{1}{2}(y+1),  & 0 \le y \lt 1 \\ 1,  & y \ge 1 \end{cases}$
观察这个 CDF，它在 $y=0$ 处有一个从 $F_Y(0^-)=0$ 到 $F_Y(0) = 1/2$ 的跳跃，跳跃高度为 $1/2$。这个跳跃对应于 $v=0$ 处的概率质量。在 $(0, 1)$ 区间上，CDF 是连续且可微的。
为了得到 PDF，我们对 CDF 求（[分布](@entry_id:182848)意义下的）导数。跳跃点产生一个**[狄拉克δ函数](@entry_id:153299)**，其系数等于跳跃高度。连续部分则按常规求导。
$f_Y(y) = \frac{1}{2}\delta(y) + \begin{cases} \frac{1}{2},  & 0 \lt y \lt 1 \\ 0,  & \text{其他} \end{cases}$
这个 PDF 精确地描述了[混合分布](@entry_id:276506)：一个在 $v=0$ 处权重为 $1/2$ 的点质量，加上一个在 $(0, 1)$ 区间上密度为 $1/2$ 的连续部分。

### 多维[随机变量的变换](@entry_id:267283)

当我们将问题扩展到多个[随机变量](@entry_id:195330)时，例如从 $(X_1, X_2)$ 变换到 $(Y_1, Y_2)$，单变量变换中的导数被一个矩阵的行列式所取代，这个[行列式](@entry_id:142978)就是**[雅可比行列式](@entry_id:137120)**（Jacobian determinant）。

假设我们有一个变换 $\mathbf{Y} = g(\mathbf{X})$，其中 $\mathbf{X}=(X_1, \dots, X_n)$ 和 $\mathbf{Y}=(Y_1, \dots, Y_n)$ 都是 $n$ 维随机向量。设该变换是可逆的，反变换为 $\mathbf{X} = h(\mathbf{Y})$。则联合 PDF 的变换公式为：
$f_{\mathbf{Y}}(\mathbf{y}) = f_{\mathbf{X}}(h(\mathbf{y})) |J|$
其中 $|J|$ 是雅可比行列式 $J = \det\left(\frac{\partial \mathbf{x}}{\partial \mathbf{y}}\right)$ 的[绝对值](@entry_id:147688)。[雅可比行列式](@entry_id:137120)代表了从 $\mathbf{y}$ 空间到 $\mathbf{x}$ 空间的一个微小[体积元](@entry_id:267802)的缩放因子，即 $d\mathbf{x} = |J| d\mathbf{y}$。这个公式是单变量公式 $f_Y(y) = f_X(x(y))|dx/dy|$ 的直接推广。

#### [独立随机变量](@entry_id:273896)之和：卷积

一个非常常见的多维变换问题是求两个[独立随机变量](@entry_id:273896)之和的[分布](@entry_id:182848)。设 $Z = X+Y$，其中 $X$ 和 $Y$ 是独立的，PDF 分别为 $f_X(x)$ 和 $f_Y(y)$。
这是一个从二维 $(X,Y)$到一维 $Z$ 的变换，维度降低了。为了使用[雅可比方法](@entry_id:270947)，我们需要引入一个辅助变量，例如 $W=X$，来保持维度不变。变换为：
$Z = X+Y$
$W = X$
反变换为：
$X = W$
$Y = Z-W$
这个变换的雅可比矩阵为：
$\frac{\partial(x,y)}{\partial(z,w)} = \begin{pmatrix} \frac{\partial x}{\partial z}  \frac{\partial x}{\partial w} \\ \frac{\partial y}{\partial z}  \frac{\partial y}{\partial w} \end{pmatrix} = \begin{pmatrix} 0  & 1 \\ 1  & -1 \end{pmatrix}$
其[行列式](@entry_id:142978) $J = 0 \cdot (-1) - 1 \cdot 1 = -1$，所以 $|J|=1$。
根据变换公式，$(Z, W)$ 的联合密度为：
$f_{Z,W}(z,w) = f_{X,Y}(x(z,w), y(z,w))|J| = f_{X,Y}(w, z-w)$
由于 $X, Y$ 独立，$f_{X,Y}(x,y) = f_X(x)f_Y(y)$，因此：
$f_{Z,W}(z,w) = f_X(w)f_Y(z-w)$
我们关心的是 $Z$ 的[边际密度](@entry_id:276750) $f_Z(z)$，这可以通过对联合密度中的辅助变量 $w$ 进行积分得到：
$f_Z(z) = \int_{-\infty}^{\infty} f_{Z,W}(z,w) \,dw = \int_{-\infty}^{\infty} f_X(w)f_Y(z-w) \,dw$
这个积分被称为 $f_X$ 和 $f_Y$ 的**卷积**，记为 $(f_X * f_Y)(z)$。

例如，若两个独立的机器人操作步骤所需时间 $T_1, T_2$ 均服从 $[0, 1]$ 上的[均匀分布](@entry_id:194597) [@problem_id:1287734]，总时间 $T = T_1 + T_2$ 的 PDF 就是两个矩形函数（[均匀分布](@entry_id:194597)的 PDF）的卷积。计算这个[卷积积分](@entry_id:155865)会得到一个三角形的 PDF，即 $f_T(t) = t$ for $t \in [0,1)$ 和 $f_T(t) = 2-t$ for $t \in [1,2]$，这被称为三[角分布](@entry_id:193827)。

#### 通用多维变换：[雅可比行列式](@entry_id:137120)

[雅可比方法](@entry_id:270947)是处理多维变量变换的通用工具，其应用远不止于求和。

**示例 1：笛卡尔坐标到极坐标**
考虑一个粒子在二维平面上的位置由两个独立的标准正态[随机变量](@entry_id:195330) $(X, Y)$ 描述。我们想要求它到原点的距离 $R = \sqrt{X^2+Y^2}$ 的[分布](@entry_id:182848) [@problem_id:1287711]。
这是一个从 $(X,Y)$ 到 $R$ 的变换。与卷积类似，我们引入一个辅助变量，最自然的选择是极角 $\Theta = \arctan(Y/X)$。我们进行从[笛卡尔坐标](@entry_id:167698) $(X,Y)$到极坐标 $(R, \Theta)$ 的变换。
反变换是 $X=R\cos\Theta$ 和 $Y=R\sin\Theta$。
[雅可比行列式](@entry_id:137120)为：
$J = \det \begin{pmatrix} \frac{\partial x}{\partial r}  \frac{\partial x}{\partial \theta} \\ \frac{\partial y}{\partial r}  \frac{\partial y}{\partial \theta} \end{pmatrix} = \det \begin{pmatrix} \cos\theta  & -r\sin\theta \\ \sin\theta  & r\cos\theta \end{pmatrix} = r\cos^2\theta - (-r\sin^2\theta) = r$
由于 $R \ge 0$，$|J| = r$。
原始的联合 PDF 为 $f_{X,Y}(x,y) = f_X(x)f_Y(y) = \frac{1}{2\pi}\exp\left(-\frac{x^2+y^2}{2}\right)$。
变换后的联合 PDF 为：
$f_{R,\Theta}(r,\theta) = f_{X,Y}(r\cos\theta, r\sin\theta) |J| = \frac{1}{2\pi}\exp\left(-\frac{(r\cos\theta)^2+(r\sin\theta)^2}{2}\right) \cdot r = \frac{r}{2\pi}\exp\left(-\frac{r^2}{2}\right)$
其中 $r \ge 0$，$ \theta \in [0, 2\pi)$。
为了得到 $R$ 的[边际密度](@entry_id:276750)，我们对 $\theta$ 进行积分：
$f_R(r) = \int_0^{2\pi} f_{R,\Theta}(r,\theta) \,d\theta = \int_0^{2\pi} \frac{r}{2\pi}\exp\left(-\frac{r^2}{2}\right) \,d\theta = \frac{r}{2\pi}\exp\left(-\frac{r^2}{2}\right) \cdot 2\pi = r\exp\left(-\frac{r^2}{2}\right)$
这个结果是**[瑞利分布](@entry_id:184867)**的 PDF，它在[雷达信号](@entry_id:190382)处理、通信和物理学中有广泛应用。

**示例 2：高级[几何变换](@entry_id:150649)**
变量变换方法的强大之处在于其普适性。考虑一个更复杂的几何问题：一个点在单位球面上均匀随机选取，然后从北极 $(0,0,1)$ 球极投影到赤道平面 $z=0$ 上，得到点 $(U,V)$。我们想要求 $(U,V)$ 的联合 PDF [@problem_id:1287716]。
这里的基本原理是**[概率守恒](@entry_id:149166)**：球面上一个微小区域 $dS$ 的概率等于其投影在平面上的对应区域 $dA=du\,dv$ 的概率。由于球面上的[分布](@entry_id:182848)是均匀的，其[面密度](@entry_id:161889)为 $f_S = 1/(4\pi)$。因此：
$f_{U,V}(u,v) \,du\,dv = f_S \,dS \implies f_{U,V}(u,v) = \frac{1}{4\pi} \frac{dS}{dA}$
这里的 $\frac{dS}{dA}$ 就是从平面坐标 $(u,v)$ 到球面坐标参数化的[雅可比因子](@entry_id:186289)。通过建立投影的几何关系，可以得到反变换，即球面坐标 $(x,y,z)$ 如何用平面坐标 $(u,v)$ 表示：
$x = \frac{2u}{u^2+v^2+1}, \quad y = \frac{2v}{u^2+v^2+1}, \quad z = \frac{u^2+v^2-1}{u^2+v^2+1}$
计算这个从 $\mathbb{R}^2$ 到 $\mathbb{R}^3$ 中[曲面](@entry_id:267450)的[参数化](@entry_id:272587)的雅可比（即曲[面法向量](@entry_id:749211)的模长），我们得到 $\frac{dS}{dA} = \frac{4}{(u^2+v^2+1)^2}$。
代入[概率守恒](@entry_id:149166)关系，得到：
$f_{U,V}(u,v) = \frac{1}{4\pi} \cdot \frac{4}{(u^2+v^2+1)^2} = \frac{1}{\pi(u^2+v^2+1)^2}$
这是一个二维柯西分布的变体。这个例子说明，变量变换的原理可以推广到不同维度和[几何流](@entry_id:195216)形之间的映射。

**示例 3：高级代数变换**
变量变换也适用于更抽象的[代数结构](@entry_id:137052)，例如随机矩阵。考虑一个 $2 \times 2$ 的实对称[随机矩阵](@entry_id:269622) $M = \begin{pmatrix} X  & Y \\ Y  & Z \end{pmatrix}$，其元素 $X,Y,Z$ 是独立的、中心化的正态[随机变量](@entry_id:195330)。我们想求其两个[特征值](@entry_id:154894) $\Lambda_1, \Lambda_2$ 的[联合分布](@entry_id:263960) [@problem_id:1287743]。
这是一个从[矩阵元](@entry_id:186505)素空间 $(X,Y,Z)$ 到[特征值](@entry_id:154894)空间 $(\Lambda_1, \Lambda_2)$ 的变换。这是一个复杂的[非线性变换](@entry_id:636115)，需要通过一系列巧妙的中间变量代换（例如，变换到[矩阵的迹](@entry_id:139694)、[行列式](@entry_id:142978)或者相关的[旋转不变量](@entry_id:170459)）来计算[雅可比行列式](@entry_id:137120)。经过复杂的推导，可以得到有序[特征值](@entry_id:154894) $(\lambda_1 \ge \lambda_2)$ 的联合 PDF：
$f_{\Lambda_1, \Lambda_2}(\lambda_1, \lambda_2) \propto |\lambda_1 - \lambda_2| \exp\left(-\frac{\lambda_1^2 + \lambda_2^2}{2\sigma^2}\right)$
这个结果揭示了一个深刻的现象：**[特征值排斥](@entry_id:136686)**。因子 $|\lambda_1 - \lambda_2|$ 表明两个[特征值](@entry_id:154894)靠得很近的概率密度趋向于零，它们仿佛相互“推开”。这是[随机矩阵理论](@entry_id:142253)中的一个基本结论，在[核物理](@entry_id:136661)、[量子混沌](@entry_id:139638)和[复杂网络](@entry_id:261695)等领域有重要意义。

### 结论

本章系统地介绍了求解[随机变量](@entry_id:195330)函数[分布](@entry_id:182848)的核心技术——变量变换法。我们从最基本的[累积分布函数](@entry_id:143135)（CDF）法开始，它虽然有时计算繁琐，但普适性最强，尤其能够处理产生[混合分布](@entry_id:276506)的变换。对于更规则的变换，我们发展出了一套直接的公式：
-   对于**单变量单调变换**，使用 $f_Y(y) = f_X(g^{-1}(y)) |\frac{d}{dy}g^{-1}(y)|$。
-   对于**单变量[非单调变换](@entry_id:271768)**，使用求和公式 $f_Y(y) = \sum_i f_X(x_i)/|g'(x_i)|$。
-   对于**多维变换**，使用[雅可比公式](@entry_id:142453) $f_{\mathbf{Y}}(\mathbf{y}) = f_{\mathbf{X}}(h(\mathbf{y})) |J|$。

这些方法共同构成了一个强大的分析工具箱。通过本章的例子，我们看到，无论是分析电子线路的信号、计算粒子的动能[分布](@entry_id:182848)，还是探索[随机矩阵](@entry_id:269622)的谱特性，变量变换都是连接理论模型与可观测量的关键桥梁。熟练掌握这些原理与机制，是深入理解和应用[随机过程](@entry_id:159502)的基石。