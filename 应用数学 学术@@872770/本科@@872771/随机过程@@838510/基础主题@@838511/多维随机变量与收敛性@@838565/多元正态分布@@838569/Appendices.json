{"hands_on_practices": [{"introduction": "多元正态分布的一个最基本也最强大的特性是其线性组合的闭合性：一组联合正态分布的随机变量的任何线性组合本身也服从正态分布。这个练习将通过一个贴近现实的生物医学场景来实践这一概念。我们将分析收缩压和舒张压这两个相关变量，并推导它们的差值——脉压——的分布，从而解决一个实际的概率问题[@problem_id:1939198]。", "problem": "在一项大规模的流行病学研究中，个体的收缩压（SBP）和舒张压（DBP）之间的关系通过二元正态分布进行建模。设随机变量 $X$ 代表收缩压，随机变量 $Y$ 代表舒张压，两者均以毫米汞柱（mmHg）为单位。对于特定人群，该分布的参数如下：\n\n- 平均收缩压为 $\\mu_X = 125$ mmHg。\n- 平均舒张压为 $\\mu_Y = 80$ mmHg。\n- 收缩压的标准差为 $\\sigma_X = 15$ mmHg。\n- 舒张压的标准差为 $\\sigma_Y = 10$ mmHg。\n- 收缩压和舒张压之间的相关系数为 $\\rho = 0.6$。\n\n心血管健康的一个关键临床指标是脉压，其定义为收缩压与舒张压之差。对于从该人群中随机选择的个体，计算其脉压大于 55 mmHg 的概率。将最终答案表示为四舍五入到四位有效数字的小数。", "solution": "设 $X$ 和 $Y$ 联合服从正态分布，其均值分别为 $\\mu_{X}$ 和 $\\mu_{Y}$，标准差分别为 $\\sigma_{X}$ 和 $\\sigma_{Y}$，相关系数为 $\\rho$。对于任何线性组合 $Z = aX + bY$，$Z$ 服从正态分布，其参数为\n$$\n\\mu_{Z} = a\\mu_{X} + b\\mu_{Y}, \\quad \\sigma_{Z}^{2} = a^{2}\\sigma_{X}^{2} + b^{2}\\sigma_{Y}^{2} + 2ab\\,\\rho\\,\\sigma_{X}\\sigma_{Y}.\n$$\n将脉压定义为 $Z = X - Y$（因此 $a=1, b=-1$）。那么\n$$\n\\mu_{Z} = \\mu_{X} - \\mu_{Y}, \\quad \\sigma_{Z}^{2} = \\sigma_{X}^{2} + \\sigma_{Y}^{2} - 2\\rho\\,\\sigma_{X}\\sigma_{Y}.\n$$\n代入给定参数，\n$$\n\\mu_{Z} = 125 - 80 = 45, \\quad \\sigma_{Z}^{2} = 15^{2} + 10^{2} - 2(0.6)(15)(10) = 225 + 100 - 180 = 145.\n$$\n因此 $Z \\sim \\mathcal{N}(45, 145)$。我们感兴趣的概率是\n$$\n\\mathbb{P}(Z  55) = \\mathbb{P}\\!\\left(\\frac{Z - \\mu_{Z}}{\\sigma_{Z}}  \\frac{55 - 45}{\\sqrt{145}}\\right) = 1 - \\Phi\\!\\left(\\frac{10}{\\sqrt{145}}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。数值上，$\\frac{10}{\\sqrt{145}} \\approx 0.8304548$，得出\n$$\n\\mathbb{P}(Z  55) \\approx 1 - \\Phi(0.8304548) \\approx 0.2031,\n$$\n四舍五入到四位有效数字。", "answer": "$$\\boxed{0.2031}$$", "id": "1939198"}, {"introduction": "在蒙特卡洛模拟、金融建模和工程领域，从独立随机源生成相关的随机变量是一项核心技能。这个练习将指导你如何通过线性变换，使用两个独立的标准正态变量来构建一个具有特定均值和协方差的二元正态随机向量。这个过程不仅具有重要的实践价值，而且揭示了协方差矩阵如何决定多元正态分布的几何结构和相关性[@problem_id:1320489]。", "problem": "在许多计算模拟中，例如量化金融或信号处理中的模拟，需要从一个相关的多元分布中生成随机变量。一个常见的任务是使用独立的标准正态变量作为源，从一个二元正态分布中生成一个随机向量。\n\n考虑一个二维随机向量 $\\mathbf{X} = \\begin{pmatrix} X \\\\ Y \\end{pmatrix}$，它服从二元正态分布，其均值向量为 $\\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_X \\\\ \\mu_Y \\end{pmatrix}$，协方差矩阵为 $\\boldsymbol{\\Sigma} = \\begin{pmatrix} \\sigma_X^2  \\rho \\sigma_X \\sigma_Y \\\\ \\rho \\sigma_X \\sigma_Y  \\sigma_Y^2 \\end{pmatrix}$。此处，$\\mu_X$ 和 $\\mu_Y$ 分别是各自的均值，$\\sigma_X  0$ 和 $\\sigma_Y  0$ 分别是各自的标准差，而 $\\rho$ 是 $X$ 和 $Y$ 之间的相关系数，满足 $|\\rho|  1$。\n\n假设你有一个随机数生成器，它可以产生两个独立的随机变量 $Z_1$ 和 $Z_2$，两者都服从标准正态分布（即均值为 0，方差为 1）。\n\n你的任务是找到一个线性变换，该变换能够从独立标准正态变量的向量 $\\mathbf{Z} = \\begin{pmatrix} Z_1 \\\\ Z_2 \\end{pmatrix}$ 生成随机向量 $\\mathbf{X}$。确定 $X$ 和 $Y$ 关于参数 $\\mu_X, \\mu_Y, \\sigma_X, \\sigma_Y, \\rho$ 以及随机变量 $Z_1, Z_2$ 的表达式。将你的最终答案表示为一个 $2 \\times 1$ 的列向量，其中包含 $X$ 的表达式以及下一行中 $Y$ 的表达式。", "solution": "我们需要一个线性变换，将 $\\mathbf{Z} = \\begin{pmatrix} Z_{1} \\\\ Z_{2} \\end{pmatrix}$（其中 $Z_{1}$ 和 $Z_{2}$ 是独立的 $N(0,1)$ 变量）映射到 $\\mathbf{X} = \\begin{pmatrix} X \\\\ Y \\end{pmatrix}$，其均值为 $\\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_{X} \\\\ \\mu_{Y} \\end{pmatrix}$，协方差为 $\\boldsymbol{\\Sigma} = \\begin{pmatrix} \\sigma_{X}^{2}  \\rho \\sigma_{X} \\sigma_{Y} \\\\ \\rho \\sigma_{X} \\sigma_{Y}  \\sigma_{Y}^{2} \\end{pmatrix}$。\n\n一般的方法是找到一个矩阵 $\\mathbf{L}$，使得 $\\boldsymbol{\\Sigma} = \\mathbf{L}\\mathbf{L}^{\\top}$ (Cholesky分解)，然后设\n$$\n\\mathbf{X} = \\boldsymbol{\\mu} + \\mathbf{L}\\mathbf{Z}.\n$$\n因为 $\\mathbb{E}[\\mathbf{Z}] = \\mathbf{0}$ 且 $\\operatorname{Cov}(\\mathbf{Z}) = \\mathbf{I}$，我们得到 $\\mathbb{E}[\\mathbf{X}] = \\boldsymbol{\\mu}$ 和 $\\operatorname{Cov}(\\mathbf{X}) = \\mathbf{L}\\mathbf{I}\\mathbf{L}^{\\top} = \\mathbf{L}\\mathbf{L}^{\\top} = \\boldsymbol{\\Sigma}$，这符合要求。\n\n设 $\\mathbf{L}$ 为下三角矩阵：\n$$\n\\mathbf{L} = \\begin{pmatrix} a  0 \\\\ b  c \\end{pmatrix}.\n$$\n那么\n$$\n\\mathbf{L}\\mathbf{L}^{\\top} = \\begin{pmatrix} a^{2}  ab \\\\ ab  b^{2} + c^{2} \\end{pmatrix}.\n$$\n将其元素与 $\\boldsymbol{\\Sigma}$ 的元素对应，得到方程组\n$$\na^{2} = \\sigma_{X}^{2}, \\quad ab = \\rho \\sigma_{X} \\sigma_{Y}, \\quad b^{2} + c^{2} = \\sigma_{Y}^{2}.\n$$\n由于 $a  0$，我们取 $a = \\sigma_{X}$。于是 $ab = \\rho \\sigma_{X} \\sigma_{Y}$ 意味着 $b = \\rho \\sigma_{Y}$。最后，\n$$\nc^{2} = \\sigma_{Y}^{2} - b^{2} = \\sigma_{Y}^{2} - \\rho^{2} \\sigma_{Y}^{2} = \\sigma_{Y}^{2}(1 - \\rho^{2}),\n$$\n且由于 $c  0$，我们取 $c = \\sigma_{Y} \\sqrt{1 - \\rho^{2}}$ (这是有效的，因为 $|\\rho|  1$ 且 $\\sigma_{Y}  0$）。\n\n因此，\n$$\n\\mathbf{L} = \\begin{pmatrix} \\sigma_{X}  0 \\\\ \\rho \\sigma_{Y}  \\sigma_{Y} \\sqrt{1 - \\rho^{2}} \\end{pmatrix},\n$$\n所求的变换为\n$$\n\\mathbf{X} = \\boldsymbol{\\mu} + \\mathbf{L}\\mathbf{Z}\n= \\begin{pmatrix} \\mu_{X} \\\\ \\mu_{Y} \\end{pmatrix}\n+ \\begin{pmatrix} \\sigma_{X}  0 \\\\ \\rho \\sigma_{Y}  \\sigma_{Y} \\sqrt{1 - \\rho^{2}} \\end{pmatrix}\n\\begin{pmatrix} Z_{1} \\\\ Z_{2} \\end{pmatrix}.\n$$\n读出各个分量可得\n$$\nX = \\mu_{X} + \\sigma_{X} Z_{1}, \\qquad\nY = \\mu_{Y} + \\rho \\sigma_{Y} Z_{1} + \\sigma_{Y} \\sqrt{1 - \\rho^{2}}\\, Z_{2}.\n$$\n这就产生了一个具有指定均值向量和协方差矩阵的二元正态分布。", "answer": "$$\\boxed{\\begin{pmatrix}\\mu_{X}+\\sigma_{X}Z_{1}\\\\ \\mu_{Y}+\\rho\\sigma_{Y}Z_{1}+\\sigma_{Y}\\sqrt{1-\\rho^{2}}\\,Z_{2}\\end{pmatrix}}$$", "id": "1320489"}, {"introduction": "在处理多元数据时，一个关键任务是量化和可视化数据点集中的区域，例如定义一个包含特定概率（如 $0.95$）的置信区域。这个练习介绍了一个核心统计工具：马氏距离的平方。你将学习到，对于一个服从 $p$ 维正态分布的随机向量 $\\mathbf{X}$，其二次型 $(\\mathbf{x}-\\boldsymbol{\\mu})^T\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})$ 服从卡方分布，这为构建置信椭圆提供了理论基础[@problem_id:1939248]。", "problem": "一家科技公司正在开发一种新型的微机电系统（MEMS）陀螺仪。该陀螺仪的性能关键取决于其谐振结构的两个耦合物理参数：谐振频率 $F$ 和品质因数 $Q$。由于制造差异，这两个参数可以被建模为一个随机向量 $\\mathbf{X} = [F, Q]^T$，该向量服从均值向量为 $\\mu$、协方差矩阵为 $\\Sigma$ 的二元正态分布。\n\n如果一个陀螺仪的参数 $(f, q)$ 满足以下不等式，则认为其符合规格：\n$$ (\\mathbf{x}-\\mu)^T\\Sigma^{-1}(\\mathbf{x}-\\mu) \\le k $$\n其中 $\\mathbf{x} = [f, q]^T$。这个不等式在 $F-Q$ 参数空间中定义了一个椭圆区域。\n\n该公司希望设定阈值常数 $k$，使得该区域恰好包含总产量的 95%。换句话说，一个随机选择的陀螺仪符合规格的概率为 0.95。\n\n为帮助您计算，以下是卡方分布 $\\chi^2_{\\nu}$ 在几个不同自由度 $\\nu$ 下的 0.95 分位数（第95百分位数）：\n- 当 $\\nu=1$ 时，0.95 分位数为 3.841。\n- 当 $\\nu=2$ 时，0.95 分位数为 5.991。\n- 当 $\\nu=3$ 时，0.95 分位数为 7.815。\n- 当 $\\nu=4$ 时，0.95 分位数为 9.488。\n\n确定常数 $k$ 的数值。请将您的答案表示为一个四舍五入到四位有效数字的实数。", "solution": "设 $\\mathbf{X} \\sim \\mathcal{N}_{2}(\\mu,\\Sigma)$。二次型\n$$\n(\\mathbf{X}-\\mu)^{T}\\Sigma^{-1}(\\mathbf{X}-\\mu)\n$$\n是马氏距离的平方，并且根据多元正态分布的标准结果，它服从一个自由度等于其维度的卡方分布：\n$$\n(\\mathbf{X}-\\mu)^{T}\\Sigma^{-1}(\\mathbf{X}-\\mu) \\sim \\chi^{2}_{2}.\n$$\n符合规格的区域由以下不等式定义：\n$$\n(\\mathbf{x}-\\mu)^{T}\\Sigma^{-1}(\\mathbf{x}-\\mu) \\le k,\n$$\n因此，一个随机选择的设备落入此区域的概率是\n$$\n\\mathbb{P}\\!\\left((\\mathbf{X}-\\mu)^{T}\\Sigma^{-1}(\\mathbf{X}-\\mu) \\le k\\right) \\;=\\; F_{\\chi^{2}_{2}}(k),\n$$\n其中 $F_{\\chi^{2}_{2}}$ 是 $\\chi^{2}_{2}$ 的累积分布函数。要求此概率等于 $0.95$ 意味着\n$$\nF_{\\chi^{2}_{2}}(k) = 0.95 \\;\\;\\Longrightarrow\\;\\; k = F_{\\chi^{2}_{2}}^{-1}(0.95).\n$$\n根据所提供的分位数，对于 $\\nu=2$，0.95 分位数为 $5.991$。四舍五入到四位有效数字仍为 $5.991$。", "answer": "$$\\boxed{5.991}$$", "id": "1939248"}]}