{"hands_on_practices": [{"introduction": "这个经典练习是理解贝叶斯定理的绝佳起点。通过一个关于硬币的简单思想实验，我们将学习如何在新证据（观察到人头朝上）出现后，更新我们对初始情况（选中了哪种硬币）的信念。这个过程完美地体现了贝叶斯推理的核心：结合先验知识和新数据来形成更精确的后验判断 [@problem_id:376]。", "problem": "一个不透明的袋子里装着大量的硬币。硬币有两种类型：公平硬币和两头硬币。一枚公平硬币一面是“正面”，另一面是“反面”，抛掷时两面朝上的概率相等。一枚两头硬币两面都是“正面”。\n\n袋中公平硬币的比例由参数 $p$ 给出，其中 $0 < p < 1$。因此，两头硬币的比例是 $1-p$。\n\n某人从袋中随机抽取一枚硬币并抛掷一次。观察到抛掷的结果是“正面”。\n\n根据这一观察结果，推导所选硬币是两头硬币的概率的符号表达式。", "solution": "设 $TH$ 为选中的硬币是两头硬币的事件，设 $F$ 为选中的硬币是公平硬币的事件。设 $H$ 为抛掷硬币结果为正面的事件。我们需要求条件概率 $P(TH | H)$。\n\n根据题目描述，我们已知选择每种硬币的先验概率：\n$$\nP(F) = p\n$$\n$$\nP(TH) = 1 - p\n$$\n\n接下来，我们确定在给定所选硬币类型的情况下，观察到正面的条件概率。\n如果硬币是公平的，抛出正面的概率是：\n$$\nP(H | F) = \\frac{1}{2}\n$$\n如果硬币是两头的，抛出正面的概率是确定的：\n$$\nP(H | TH) = 1\n$$\n\n我们将使用贝叶斯定理来求解 $P(TH | H)$：\n$$\nP(TH | H) = \\frac{P(H | TH) P(TH)}{P(H)}\n$$\n\n为了使用这个公式，我们首先需要计算观察到正面的总概率 $P(H)$。我们可以使用全概率公式来计算，对所有可能的硬币类型求和：\n$$\nP(H) = P(H | F)P(F) + P(H | TH)P(TH)\n$$\n\n将已知值代入此表达式：\n$$\nP(H) = \\left(\\frac{1}{2}\\right) (p) + (1) (1-p)\n$$\n$$\nP(H) = \\frac{p}{2} + 1 - p\n$$\n$$\nP(H) = 1 - \\frac{p}{2}\n$$\n$$\nP(H) = \\frac{2-p}{2}\n$$\n\n现在我们有了贝叶斯定理所需的所有部分。我们将 $P(H | TH)$、$P(TH)$ 和 $P(H)$ 的表达式代入：\n$$\nP(TH | H) = \\frac{(1)(1 - p)}{\\frac{2-p}{2}}\n$$\n\n简化表达式得到最终结果：\n$$\nP(TH | H) = \\frac{2(1 - p)}{2 - p}\n$$", "answer": "$$\n\\boxed{\\frac{2(1 - p)}{2 - p}}\n$$", "id": "376"}, {"introduction": "现实世界中的推理往往涉及处理多条不完美的信息。这个基于著名出租车问题的场景，将向我们展示如何整合来自多个独立证人的证据，以更准确地判断事件发生的真实情况。该练习强调了贝叶斯定理在处理具有不确定性的复合证据时的强大能力，这是其在法律、情报分析和医学诊断等领域广泛应用的基础 [@problem_id:691263]。", "problem": "在一个城市中，有三家出租车公司在运营：Azure Autos、Crimson Cabs 和 Garnet Group。一名夜间肇事逃逸事故的目击者报告了涉事出租车的情况。由于光线条件不佳，目击者的证词并非完全可靠。该城市的出租车队由 Azure Autos 公司的出租车占 $p_A$ 的比例，Crimson Cabs 公司的占 $p_C$，Garnet Group 公司的占 $p_G$，其中 $p_A + p_C + p_G = 1$。\n\nAzure Autos 公司的出租车是独特的蓝色，而 Crimson Cabs 和 Garnet Group 公司的出租车是两种不同但容易混淆的红色。一项在类似条件下对目击者可靠性的调查确定了单个目击者报告的以下条件概率。设 $E$ 为目击者报告看到 Azure Autos 公司出租车的事件。\n\n- 当出租车确实来自 Azure Autos 公司时，目击者正确报告为 Azure Autos 公司出租车的概率为 $P(E | \\text{Azure}) = \\alpha$。\n- 当出租车实际上来自 Crimson Cabs 公司时，目击者错误地报告为 Azure Autos 公司出租车的概率为 $P(E | \\text{Crimson}) = \\delta$。\n- 当出租车实际上来自 Garnet Group 公司时，目击者错误地报告为 Azure Autos 公司出租车的概率为 $P(E | \\text{Garnet}) = \\delta$。\n\n在所讨论的特定事件中，有两名独立的目击者在场，他们都报告说出租车来自 Azure Autos 公司。\n\n请根据这两名独立目击者相同的证词，推导事故中涉事出租车来自 Azure Autos 公司的后验概率的符号表达式。你的最终表达式应以参数 $p_A$、$\\alpha$ 和 $\\delta$ 表示。", "solution": "1. 根据贝叶斯定理，对于两名独立目击者报告看到 Azure Autos ($E_1,E_2$) 的情况：\n$$\nP(\\text{Azure}\\mid E_1,E_2)\n=\\frac{P(E_1,E_2\\mid \\text{Azure})\\,p_A}\n{P(E_1,E_2\\mid \\text{Azure})\\,p_A\n+P(E_1,E_2\\mid \\text{Crimson})\\,p_C\n+P(E_1,E_2\\mid \\text{Garnet})\\,p_G}\\,.\n$$\n2. 根据独立性可得\n$$P(E_1,E_2\\mid \\text{Azure})=\\alpha^2,\\quad\nP(E_1,E_2\\mid \\text{Crimson})=\\delta^2,\\quad\nP(E_1,E_2\\mid \\text{Garnet})=\\delta^2.\n$$\n3. 代入并使用 $p_C+p_G=1-p_A$：\n$$\nP(\\text{Azure}\\mid E_1,E_2)\n=\\frac{\\alpha^2\\,p_A}\n{\\alpha^2\\,p_A+\\delta^2\\,p_C+\\delta^2\\,p_G}\n=\\frac{\\alpha^2\\,p_A}{\\alpha^2\\,p_A+\\delta^2(1-p_A)}.\n$$", "answer": "$$\\boxed{\\frac{p_A \\alpha^2}{p_A \\alpha^2 + (1-p_A)\\delta^2}}$$", "id": "691263"}, {"introduction": "贝叶斯推理不仅能更新概率，还能用于比较不同的科学假说。在这个练习中，我们将探索如何使用一个称为“贝叶斯因子”的强大工具，来量化数据支持一个假说（骰子是作弊的）相对于另一个假说（骰子是公平的）的证据强度。这种方法是现代科学和统计学中进行模型选择的核心，它提供了一个严谨的框架来评估竞争性假说 [@problem_id:691425]。", "problem": "一位研究者正在分析一个六面骰子，以确定它是公平的还是有偏差的。提出了两种相互竞争的假设：\n\n1.  **假设 $H_F$ (公平骰子)**：骰子是公平的。掷出任何一面 $i \\in \\{1, 2, 3, 4, 5, 6\\}$ 的概率是恒定且相等的，$P(\\text{roll}=i|H_F) = 1/6$。\n\n2.  **假设 $H_L$ (有偏骰子)**：骰子以一种特定的方式被加载（有偏差）。掷出“6”的概率是 $p$，而掷出其他五个面中任意一个的概率是均匀分布的，即 $P(\\text{roll}=6|H_L, p) = p$ 且对于 $i \\in \\{1, 2, 3, 4, 5\\}$ 有 $P(\\text{roll}=i|H_L, p) = (1-p)/5$。代表偏差的参数 $p$ 是未知的。关于 $p$ 的先验信念由一个贝塔分布建模，$p \\sim \\text{Beta}(\\alpha_0, \\beta_0)$，其概率密度函数为：\n    $$f(p; \\alpha_0, \\beta_0) = \\frac{p^{\\alpha_0-1}(1-p)^{\\beta_0-1}}{B(\\alpha_0, \\beta_0)}$$\n    其中 $p \\in [0, 1]$。$B(x, y)$ 项是贝塔函数，定义为 $B(x, y) = \\frac{\\Gamma(x)\\Gamma(y)}{\\Gamma(x+y)}$，其中 $\\Gamma(\\cdot)$ 是伽马函数。\n\n观察到了一系列 $N$ 次独立的骰子投掷。设该数据集为 $D$。数据摘要显示，“6”这个面出现了 $n_6$ 次，而除“6”之外的任何面总共出现了 $N - n_6$ 次。\n\n推导贝叶斯因子 $K = \\frac{P(D|H_L)}{P(D|H_F)}$ 的封闭形式表达式。该因子量化了数据支持有偏骰子假设相对于公平骰子假设的证据。请用 $N$、$n_6$、$\\alpha_0$、$\\beta_0$ 和伽马函数 $\\Gamma(\\cdot)$ 来表示你的最终答案。", "solution": "我们比较每个假设下的边际似然。\n\n1. 在假设 $H_F$ 下，\n$$\nP(D\\mid H_F)\n=\\Bigl(\\tfrac{1}{6}\\Bigr)^N.\n$$\n\n2. 在假设 $H_L$ 下，先验为 $p\\sim \\mathrm{Beta}(\\alpha_0,\\beta_0)$，\n\n$$\nP(D\\mid p,H_L)\n= p^{\\,n_6}\\Bigl(\\tfrac{1-p}{5}\\Bigr)^{\\,N-n_6},\n\\quad\nf(p)=\\frac{p^{\\alpha_0-1}(1-p)^{\\beta_0-1}}{B(\\alpha_0,\\beta_0)}.\n$$\n\n因此\n\n$$\nP(D\\mid H_L)\n=\\int_0^1 p^{n_6}\\Bigl(\\tfrac{1-p}{5}\\Bigr)^{N-n_6}\n\\frac{p^{\\alpha_0-1}(1-p)^{\\beta_0-1}}{B(\\alpha_0,\\beta_0)}\\,dp\n= \\frac{5^{-(N-n_6)}}{B(\\alpha_0,\\beta_0)}\n\\int_0^1 p^{n_6+\\alpha_0-1}(1-p)^{\\,N-n_6+\\beta_0-1}dp.\n$$\n\n剩下的积分是一个贝塔函数：\n$$\nP(D\\mid H_L)\n=\\frac{5^{-(N-n_6)}}{B(\\alpha_0,\\beta_0)}\\,\nB\\bigl(n_6+\\alpha_0,\\;N-n_6+\\beta_0\\bigr).\n$$\n\n3. 贝叶斯因子 $K=\\dfrac{P(D\\mid H_L)}{P(D\\mid H_F)}$ 为\n$$\nK\n=\\frac{5^{-(N-n_6)}\\,B(n_6+\\alpha_0,N-n_6+\\beta_0)}\n     {B(\\alpha_0,\\beta_0)}\\Big/\\Bigl(\\tfrac{1}{6}\\Bigr)^N\n=6^N\\,5^{\\,n_6-N}\\,\n\\frac{B(n_6+\\alpha_0,\\;N-n_6+\\beta_0)}{B(\\alpha_0,\\beta_0)}.\n$$\n\n4. 将 $B(x,y)=\\dfrac{\\Gamma(x)\\,\\Gamma(y)}{\\Gamma(x+y)}$ 代入可得\n$$\nK\n=6^N\\,5^{\\,n_6-N}\\,\n\\frac{\\Gamma(n_6+\\alpha_0)\\,\\Gamma(N-n_6+\\beta_0)}\n     {\\Gamma(N+\\alpha_0+\\beta_0)}\n\\;\\frac{\\Gamma(\\alpha_0+\\beta_0)}\n     {\\Gamma(\\alpha_0)\\,\\Gamma(\\beta_0)}.\n$$", "answer": "$$\\boxed{6^N\\,5^{\\,n_6-N}\\;\\frac{\\Gamma(n_6+\\alpha_0)\\,\\Gamma(N-n_6+\\beta_0)}{\\Gamma(N+\\alpha_0+\\beta_0)}\\;\\frac{\\Gamma(\\alpha_0+\\beta_0)}{\\Gamma(\\alpha_0)\\,\\Gamma(\\beta_0)}}$$", "id": "691425"}]}