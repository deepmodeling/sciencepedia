{"hands_on_practices": [{"introduction": "本节的第一个练习将带你进入一个熟悉的场景：在繁忙的咖啡店排队。这个练习旨在帮助你掌握M/M/1模型中最核心的性能指标之一——顾客在系统中的平均逗留时间（$W$）。通过计算从到达至服务完成的全部时长，你将学会如何运用基本公式将到达率（$\\lambda$）和服务率（$\\mu$）这两个关键参数转化为一个有形的、可感知的服务质量度量 [@problem_id:1334433]。", "problem": "市中心一家很受欢迎的咖啡店只有一名咖啡师，负责点单和制作饮品。在一个典型的工作日上午，顾客的到达遵循泊松过程，平均到达率为每小时45位顾客。咖啡师服务一位顾客所需的时间（从点单到交付饮品）服从指数分布，平均值为70秒。假设系统处于稳态运行，并且有足够的等待空间容纳所有到达的顾客。\n\n计算一位顾客在咖啡店所花费的平均总时间，即从他们到达的那一刻起，直到他们收到饮品并离开的那一刻。答案以分钟为单位，并四舍五入到三位有效数字。", "solution": "将此系统建模为稳态下的M/M/1排队模型，其到达率为 $\\lambda$，服务率为 $\\mu$。对于M/M/1排队模型，系统中的平均总时间（等待时间加服务时间）为\n$$\nW=\\frac{1}{\\mu-\\lambda},\n$$\n条件是 $\\lambda  \\mu$。\n\n到达率为 $\\lambda=45$ 顾客/小时。服务时间服从指数分布，平均值为 $70$ 秒，因此以小时为单位的服务率为\n$$\n\\mu=\\frac{1}{70\\ \\text{s}}\\times 3600\\ \\text{s/h}=\\frac{3600}{70}=\\frac{360}{7}\\ \\text{每小时}。\n$$\n检验稳定性：\n$$\n\\rho=\\frac{\\lambda}{\\mu}=\\frac{45}{360/7}=\\frac{315}{360}=0.875  1,\n$$\n因此稳态条件成立。\n\n计算 $W$：\n$$\n\\mu-\\lambda=\\frac{360}{7}-45=\\frac{360-315}{7}=\\frac{45}{7}\\ \\text{每小时}，\n$$\n$$\nW=\\frac{1}{\\mu-\\lambda}=\\frac{1}{45/7}=\\frac{7}{45}\\ \\text{小时}。\n$$\n转换为分钟：\n$$\nW=\\frac{7}{45}\\times 60=\\frac{420}{45}=\\frac{28}{3}\\ \\text{分钟}\\approx 9.333\\ldots\\ \\text{分钟}。\n$$\n四舍五入到三位有效数字，结果为 $9.33$ 分钟。", "answer": "$$\\boxed{9.33}$$", "id": "1334433"}, {"introduction": "在掌握了基础计算之后，我们将视角转换一下，从“分析者”变为“设计者”。现实世界中的工程问题往往不是简单地计算现有系统的性能，而是要设计系统以满足特定的服务质量（QoS）目标。在这个练习中，你将面对一个逆向问题：给定一个可接受的最大平均排队等待时间，你需要反推出系统必须达到的最低服务速率（$\\mu$），这不仅加深了你对公式的理解，更锻炼了你在约束条件下解决实际问题的能力 [@problem_id:1334404]。", "problem": "一家小型初创公司运营着一台高性能计算服务器，用于处理其客户提交的数据分析任务。任务以泊松过程的形式到达服务器的处理队列，平均到达率为每小时144个任务。已知处理单个任务所需的时间服从指数分布。公司希望保证服务质量，确保一个任务在开始处理前在队列中等待的平均时间不超过45秒。\n\n为实现这一目标，公司需要配置服务器的处理能力。假设服务器连续运行且一次只处理一个任务，那么服务器必须维持的最低服务率是多少（以“任务/分钟”为单位）？\n\n以“任务/分钟”为单位给出答案，并四舍五入到三位有效数字。", "solution": "所描述的物理场景可以建模为一个M/M/1排队系统。“M”代表马尔可夫（或无记忆性），表示到达间隔时间和服务时间都服从指数分布。“1”表示只有一个服务器。\n\n首先，我们需要为速率和时间建立一致的单位。题目给出了以“任务/小时”为单位的到达率和以“秒”为单位的最大等待时间，但要求最终的服务率以“任务/分钟”为单位。让我们将所有单位都转换为分钟。\n\n到达率（用 $\\lambda$ 表示）为每小时144个任务。\n$$ \\lambda = \\frac{144 \\text{ jobs}}{1 \\text{ hour}} \\times \\frac{1 \\text{ hour}}{60 \\text{ minutes}} = 2.4 \\text{ jobs/minute} $$\n\n队列中允许的最大平均等待时间（我们称之为 $W_{q, \\text{max}}$）是45秒。\n$$ W_{q, \\text{max}} = 45 \\text{ seconds} \\times \\frac{1 \\text{ minute}}{60 \\text{ seconds}} = 0.75 \\text{ minutes} $$\n\n设 $\\mu$ 是以“任务/分钟”为单位的服务率，这是我们需要求解的量。对于一个稳态的M/M/1队列，队列中的平均等待时间 $W_q$ 由以下公式给出：\n$$ W_q = \\frac{\\lambda}{\\mu(\\mu - \\lambda)} $$\n此公式仅对稳定系统有效，这要求服务率大于到达率，即 $\\mu  \\lambda$。\n\n我们得到的条件是平均等待时间不能超过 $W_{q, \\text{max}}$。这可以转化为不等式：\n$$ W_q \\le W_{q, \\text{max}} $$\n代入 $W_q$ 的公式：\n$$ \\frac{\\lambda}{\\mu(\\mu - \\lambda)} \\le W_{q, \\text{max}} $$\n\n现在，代入 $\\lambda$ 和 $W_{q, \\text{max}}$ 的数值：\n$$ \\frac{2.4}{\\mu(\\mu - 2.4)} \\le 0.75 $$\n\n为了解这个关于 $\\mu$ 的不等式，我们首先考虑稳定性条件 $\\mu  \\lambda = 2.4$。在这种情况下，$\\mu$ 和 $(\\mu - 2.4)$ 都是正数，所以它们的乘积 $\\mu(\\mu - 2.4)$ 也是正数。我们可以在不等式两边同乘以这个乘积，而不用改变不等号的方向：\n$$ 2.4 \\le 0.75 \\mu (\\mu - 2.4) $$\n$$ 2.4 \\le 0.75 \\mu^2 - (0.75)(2.4) \\mu $$\n$$ 2.4 \\le 0.75 \\mu^2 - 1.8 \\mu $$\n\n为简化起见，我们可以将整个不等式除以0.75（或乘以4/3）：\n$$ \\frac{2.4}{0.75} \\le \\mu^2 - \\frac{1.8}{0.75} \\mu $$\n$$ 3.2 \\le \\mu^2 - 2.4 \\mu $$\n\n将其整理成标准的一元二次不等式形式：\n$$ \\mu^2 - 2.4 \\mu - 3.2 \\ge 0 $$\n\n为了找到这个不等式成立的条件，我们首先使用二次公式 $\\mu = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求出相应的一元二次方程 $\\mu^2 - 2.4 \\mu - 3.2 = 0$ 的根：\n$$ \\mu = \\frac{-(-2.4) \\pm \\sqrt{(-2.4)^2 - 4(1)(-3.2)}}{2(1)} $$\n$$ \\mu = \\frac{2.4 \\pm \\sqrt{5.76 + 12.8}}{2} $$\n$$ \\mu = \\frac{2.4 \\pm \\sqrt{18.56}}{2} $$\n\n现在，我们计算两个根：\n$$ \\mu_1 = \\frac{2.4 - \\sqrt{18.56}}{2} \\approx \\frac{2.4 - 4.3081}{2} \\approx -0.95405 $$\n$$ \\mu_2 = \\frac{2.4 + \\sqrt{18.56}}{2} \\approx \\frac{2.4 + 4.3081}{2} \\approx 3.35405 $$\n\n二次函数 $f(\\mu) = \\mu^2 - 2.4 \\mu - 3.2$ 表示一个开口向上的抛物线。因此，不等式 $f(\\mu) \\ge 0$ 在 $\\mu \\le \\mu_1$ 或 $\\mu \\ge \\mu_2$ 时成立。\n所以，$\\mu \\le -0.95405$ 或 $\\mu \\ge 3.35405$。\n\n我们还必须满足队列的稳定性条件，即 $\\mu  \\lambda = 2.4$。\n结合这两个条件：\n1.  $(\\mu \\le -0.95405 \\text{ 或 } \\mu \\ge 3.35405)$\n2.  $\\mu  2.4$\n\n唯一同时满足这两个条件的区域是 $\\mu \\ge 3.35405$。\n题目要求的是满足要求的最低服务率。这对应于 $\\mu$ 的有效范围的下界。\n因此，所需的最低服务率为 $\\mu_{\\text{min}} = 3.35405$ 任务/分钟。\n\n题目要求将最终答案四舍五入到三位有效数字。\n3.35405 的前三位有效数字是 3、3 和 5。后一位数字是 4，小于 5，因此向下舍入。\n最低服务率为 3.35 任务/分钟。", "answer": "$$\\boxed{3.35}$$", "id": "1334404"}, {"introduction": "平均值虽然重要，但有时可能会掩盖真相；一个较低的平均等待时间可能隐藏着偶尔出现的极端长队。为了更全面地评估系统性能，我们需要超越平均值，去理解整个系统的状态分布。本练习将引导你计算系统中任务数的百分位数，这要求你运用M/M/1队列稳态下系统人数的几何分布特性。通过这个练习，你将学会如何从概率分布的角度来设定服务水平预期，从而更精确地管理用户体验 [@problem_id:1334418]。", "problem": "一所大学的数字制造实验室为学生项目运行着一台高需求的3D打印机。该实验室全年无休（24/7）开放，系统可以被认为处于稳态运行。打印作业的请求遵循泊松过程，平均到达率为每小时 $\\lambda = 0.5$ 个作业。完成任何给定打印作业所需的时间可以很好地用指数分布来近似，打印机平均每小时能完成 $\\mu = 0.8$ 个作业。\n\n实验室管理员希望为学生设定一个服务水平预期。为此，他们需要确定系统中打印作业总数的第95百分位数。这个数字包括当前正在打印的作业以及在队列中等待的任何作业。求这个值。请注意，作业数量必须是整数。", "solution": "这个问题可以被建模为一个 M/M/1 排队系统。其中的'M'表示到达间隔时间和服务时间都服从指数分布（这等价于泊松到达）。'1'表示单个服务器，在本例中即为这台3D打印机。\n\n给定的参数是：\n- 到达率，$\\lambda = 0.5$ 作业/小时。\n- 服务率，$\\mu = 0.8$ 作业/小时。\n\n首先，我们计算系统的流量强度或利用率因子，$\\rho$。这个值代表了服务器处于繁忙状态的时间比例。\n$$\n\\rho = \\frac{\\lambda}{\\mu} = \\frac{0.5}{0.8} = \\frac{5}{8} = 0.625\n$$\n由于 $\\rho  1$，队列是稳定的，并将达到稳态，正如问题中所述。\n\n在 M/M/1 队列的稳态下，系统中恰好有 $n$ 个作业（包括正在服务的作业）的概率由几何分布给出：\n$$\nP(N=n) = (1-\\rho)\\rho^n, \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\n我们需要求解系统中作业数量的第95百分位数。设这个值为 $k$。根据定义，第95百分位数是满足系统中作业数量小于或等于 $k$ 的概率至少为 0.95 的最小整数 $k$。用数学语言表达，我们需要找到满足以下条件的最小整数 $k$：\n$$\nP(N \\le k) \\ge 0.95\n$$\n累积分布函数（CDF），$P(N \\le k)$，是从 $n=0$ 到 $n=k$ 的概率之和：\n$$\nP(N \\le k) = \\sum_{n=0}^{k} P(N=n) = \\sum_{n=0}^{k} (1-\\rho)\\rho^n\n$$\n这是一个有限几何级数。我们可以提出常数项 $(1-\\rho)$，并使用几何级数求和公式 $\\sum_{i=0}^{m} r^i = \\frac{1-r^{m+1}}{1-r}$：\n$$\nP(N \\le k) = (1-\\rho) \\sum_{n=0}^{k} \\rho^n = (1-\\rho) \\left( \\frac{1-\\rho^{k+1}}{1-\\rho} \\right) = 1 - \\rho^{k+1}\n$$\n现在，我们可以使用这个简化的累积分布函数表达式来解关于 $k$ 的不等式：\n$$\n1 - \\rho^{k+1} \\ge 0.95\n$$\n整理不等式：\n$$\n0.05 \\ge \\rho^{k+1}\n$$\n或者\n$$\n\\rho^{k+1} \\le 0.05\n$$\n为了求解 $k$，我们对两边取自然对数。\n$$\n\\ln(\\rho^{k+1}) \\le \\ln(0.05)\n$$\n$$\n(k+1)\\ln(\\rho) \\le \\ln(0.05)\n$$\n现在我们代入 $\\rho = 0.625$ 的值。一个介于0和1之间的数的自然对数是负数。具体来说，$\\ln(0.625)  0$。因此，当我们除以 $\\ln(\\rho)$ 时，必须反转不等号：\n$$\nk+1 \\ge \\frac{\\ln(0.05)}{\\ln(0.625)}\n$$\n现在我们计算数值：\n$$\nk+1 \\ge \\frac{-2.99573227}{-0.47000362} \\approx 6.37384\n$$\n两边减1：\n$$\nk \\ge 6.37384 - 1\n$$\n$$\nk \\ge 5.37384\n$$\n因为作业数量 $k$ 必须是整数，所以满足此不等式的最小整数 $k$ 是 $6$。\n\n因此，系统中作业总数的第95百分位数是6。这意味着在95%的时间里，到达的学生会发现系统中总共有6个或更少的作业（正在打印或等待中）。", "answer": "$$\\boxed{6}$$", "id": "1334418"}]}