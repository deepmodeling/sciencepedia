{"hands_on_practices": [{"introduction": "鞅理论的一个经典应用是解决随机游走中的停时问题。通过构造一个合适的鞅并应用可选停止定理，我们可以简洁地计算出过程首次到达某个边界所需的平均时间。这个练习 [@problem_id:1317066] 将引导你应用这些思想来解决一个关于粒子在一维晶格上运动的物理情景，从而深化对鞅在计算期望值方面强大作用的理解。", "problem": "一个亚原子粒子的位置在一维整数格上被追踪。其在离散时间步 $n$ 的位置由随机变量 $S_n$ 给出。该粒子初始位于原点，因此 $S_0 = 0$。\n\n在每个时间步 $n=1, 2, 3, \\dots$，粒子以相等的概率向右移动一个单位（例如，从位置 $k$ 到 $k+1$）或向左移动一个单位（从 $k$ 到 $k-1$）。每次移动都与之前的所有移动无关。\n\n粒子的运动受到两个吸收壁的限制。一个位于位置 $x=b$，另一个位于 $x=-a$，其中 $a$ 和 $b$ 是给定的正整数。如果粒子的位置到达 $b$ 或 $-a$，它会立即被吸收壁吸收，其运动停止。\n\n设 $\\tau$ 为粒子首次被其中一个吸收壁吸收的离散时间步。请确定该停止时间的期望值 $E[\\tau]$ 的一个闭式解析表达式，用正整数 $a$ 和 $b$ 表示。", "solution": "令 $T(i) = \\mathbb{E}[\\tau \\mid S_{0}=i]$，其中 $i \\in \\{-a, -a+1, \\dots, b-1, b\\}$。根据全期望定律和马尔可夫性质，对于所有内部位置 $-a  i  b$，\n$$\nT(i) = 1 + \\frac{1}{2}T(i+1) + \\frac{1}{2}T(i-1),\n$$\n其吸收边界条件为\n$$\nT(-a) = 0, \\quad T(b) = 0.\n$$\n重写内部递推关系，得到二阶差分方程\n$$\nT(i+1) - 2T(i) + T(i-1) = -2.\n$$\n一个特解是 $T_{p}(i) = -i^{2}$，因为 $(i+1)^{2} - 2i^{2} + (i-1)^{2} = 2$。因此，通解为\n$$\nT(i) = -i^{2} + A i + C,\n$$\n其中 $A$ 和 $C$ 为常数。施加边界条件可得\n$$\nT(-a) = -a^{2} - A a + C = 0, \\quad T(b) = -b^{2} + A b + C = 0.\n$$\n将这两个方程相减可得\n$$\na^{2} - b^{2} + A(a+b) = 0 \\quad \\Rightarrow \\quad A = b - a.\n$$\n代入 $T(b)=0$ 可得\n$$\n0 = -b^{2} + (b-a)b + C \\quad \\Rightarrow \\quad C = ab.\n$$\n因此\n$$\nT(i) = -i^{2} + (b-a)i + ab,\n$$\n并且特别地，由于 $S_{0}=0$，\n$$\n\\mathbb{E}[\\tau] = T(0) = ab.\n$$", "answer": "$$\\boxed{ab}$$", "id": "1317066"}, {"introduction": "许多随机过程，尤其是在金融和生物学中，都表现为乘法形式。判断这类过程的长期走向——是最终趋于零而消亡，还是收敛到一个正值——至关重要。这个练习 [@problem_id:1317075] 介绍了一个关于乘法鞅收敛性的深刻结果，并要求你确定一个决定一个假设的投资策略成败的关键参数。通过这个练习，你将学会如何分析乘法过程的渐进行为。", "problem": "一家自动化投资基金的资本被建模为一个离散时间随机过程。初始资本被归一化为 $M_0 = 1$。$n$ 天后的资本 $M_n$ 是每日回报因子的乘积，即 $M_n = \\prod_{k=1}^{n} Y_k$。每日回报因子 $Y_k$ 是独立的非负随机变量。\n\n对于每一天 $k \\ge 1$，回报因子 $Y_k$ 由一个简化的市场模型确定。它可以取两个值之一：高回报 $h_k = 1 + (k+1)^{-1/4}$ 或低回报 $l_k = 1 - (k+1)^{-1/\\alpha}$。此处，$\\alpha > 0$ 是投资策略的一个可调节参数。对于任意给定的 $\\alpha$，我们只考虑使 $l_k > 0$ 的 $k$ 值。第 $k$ 天高回报的概率被设定为使得预期回报因子是公平的，即 $E[Y_k] = 1$。\n\n该策略的长期成功与否取决于资本 $M_n$ 在 $n \\to \\infty$ 时是收敛到一个严格为正的值，还是消失为零。鞅论中的一个关键结果表明，如果级数 $\\sum_{k=1}^{\\infty} (1 - E[\\sqrt{Y_k}])$ 收敛，则 $\\lim_{n \\to \\infty} M_n > 0$ 的概率不为零。反之，如果该级数发散，则 $\\lim_{n \\to \\infty} M_n = 0$ 几乎必然成立。\n\n存在一个策略参数的临界值 $\\alpha_c$，它将这两种结果分开。对于 $\\alpha > \\alpha_c$，该策略长期来看必然失败（资本收敛到零）。对于 $0  \\alpha  \\alpha_c$，该策略有成功的机会（资本可能收敛到一个正值）。\n\n确定这个临界值 $\\alpha_c$。", "solution": "令 $a_{k} \\equiv (k+1)^{-1/4}$ 和 $b_{k} \\equiv (k+1)^{-1/\\alpha}$，因此 $h_{k} = 1 + a_{k}$ 且 $l_{k} = 1 - b_{k}$。公平性条件 $E[Y_{k}] = 1$ 通过以下方式确定了高回报概率 $p_{k}$：\n$$\np_{k} h_{k} + (1 - p_{k}) l_{k} = 1 \\quad \\Longrightarrow \\quad p_{k} (a_{k} + b_{k}) = b_{k} \\quad \\Longrightarrow \\quad p_{k} = \\frac{b_{k}}{a_{k} + b_{k}}, \\quad 1 - p_{k} = \\frac{a_{k}}{a_{k} + b_{k}}.\n$$\n因此\n$$\nE[\\sqrt{Y_{k}}] = p_{k} \\sqrt{1 + a_{k}} + (1 - p_{k}) \\sqrt{1 - b_{k}} = \\frac{b_{k} \\sqrt{1 + a_{k}} + a_{k} \\sqrt{1 - b_{k}}}{a_{k} + b_{k}}.\n$$\n对小的 $x$ 使用泰勒展开式，\n$$\n\\sqrt{1 + x} = 1 + \\frac{1}{2} x - \\frac{1}{8} x^{2} + O(x^{3}), \\qquad \\sqrt{1 - x} = 1 - \\frac{1}{2} x - \\frac{1}{8} x^{2} + O(x^{3}),\n$$\n我们得到\n$$\nb_{k} \\sqrt{1 + a_{k}} + a_{k} \\sqrt{1 - b_{k}} = b_{k} \\left(1 + \\frac{1}{2} a_{k} - \\frac{1}{8} a_{k}^{2} + O(a_{k}^{3}) \\right) + a_{k} \\left(1 - \\frac{1}{2} b_{k} - \\frac{1}{8} b_{k}^{2} + O(b_{k}^{3}) \\right).\n$$\n合并项，\n$$\nb_{k} \\sqrt{1 + a_{k}} + a_{k} \\sqrt{1 - b_{k}} = (a_{k} + b_{k}) - \\frac{1}{8} \\left( b_{k} a_{k}^{2} + a_{k} b_{k}^{2} \\right) + O\\left(b_{k} a_{k}^{3} + a_{k} b_{k}^{3}\\right).\n$$\n两边同时除以 $a_{k} + b_{k}$ 得到\n$$\nE[\\sqrt{Y_{k}}] = 1 - \\frac{1}{8} \\frac{b_{k} a_{k}^{2} + a_{k} b_{k}^{2}}{a_{k} + b_{k}} + O\\left(\\frac{b_{k} a_{k}^{3} + a_{k} b_{k}^{3}}{a_{k} + b_{k}}\\right).\n$$\n由于 $b_{k} a_{k}^{2} + a_{k} b_{k}^{2} = a_{k} b_{k} (a_{k} + b_{k})$，主项可以精确地简化为\n$$\nE[\\sqrt{Y_{k}}] = 1 - \\frac{1}{8} a_{k} b_{k} + O\\left(a_{k} b_{k} (a_{k} + b_{k})\\right),\n$$\n所以\n$$\n1 - E[\\sqrt{Y_{k}}] = \\frac{1}{8} a_{k} b_{k} + O\\left(a_{k} b_{k} (a_{k} + b_{k})\\right).\n$$\n因为 $a_{k} \\to 0$ 且 $b_{k} \\to 0$，存在常数 $C_{1}, C_{2} > 0$ 和 $K$，使得对于所有 $k \\ge K$，\n$$\nC_{1} a_{k} b_{k} \\le 1 - E[\\sqrt{Y_{k}}] \\le C_{2} a_{k} b_{k}.\n$$\n因此 $\\sum_{k=1}^{\\infty} \\left(1 - E[\\sqrt{Y_{k}}]\\right)$ 的收敛性等价于以下级数的收敛性：\n$$\n\\sum_{k=1}^{\\infty} a_{k} b_{k} = \\sum_{k=1}^{\\infty} (k+1)^{-\\left(\\frac{1}{4} + \\frac{1}{\\alpha}\\right)}.\n$$\n根据 $p$-级数判别法，此级数收敛当且仅当 $\\frac{1}{4} + \\frac{1}{\\alpha} > 1$，并在 $\\frac{1}{4} + \\frac{1}{\\alpha} \\le 1$ 时发散。临界值 $\\alpha_{c}$ 由等式定义：\n$$\n\\frac{1}{4} + \\frac{1}{\\alpha_{c}} = 1 \\quad \\Longrightarrow \\quad \\frac{1}{\\alpha_{c}} = \\frac{3}{4} \\quad \\Longrightarrow \\quad \\alpha_{c} = \\frac{4}{3}.\n$$\n因此，对于 $0  \\alpha  \\frac{4}{3}$，级数收敛，且 $\\lim_{n \\to \\infty} M_{n} > 0$ 的概率为正；而对于 $\\alpha \\ge \\frac{4}{3}$，级数发散，且 $\\lim_{n \\to \\infty} M_{n} = 0$ 几乎必然成立。相变发生在 $\\alpha_{c} = \\frac{4}{3}$。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "1317075"}, {"introduction": "并非所有随机过程本身都是鞅，但我们常常可以在其中发现“隐藏”的鞅结构。Ehrenfest 瓮模型是统计物理学中一个著名的例子，它本身是一个马尔可夫链，而非鞅。这个练习 [@problem_id:1317068] 展示了如何通过对原始过程进行适当的缩放和平移，构造出一个鞅。计算这个构造出的鞅的二阶矩，对于理解其在 $L^2$ 空间中的有界性和收敛性至关重要。", "problem": "Ehrenfest模型描述了两个物体之间热交换的过程。在一个简化版本中，我们考虑两个标记为1和2的罐子，总共包含$N$个可区分的粒子。在每个离散时间步，从总共$N$个粒子中均匀随机地选择一个粒子，并将其移动到另一个罐子中。令$X_n$为时刻$n$时罐子1中的粒子数，其中$n=0, 1, 2, \\dots$。$X_n$的状态空间为$\\{0, 1, \\dots, N\\}$。\n\n令$Y_n = X_n - N/2$为中心化的粒子数。可以证明，$Y_n$的条件期望满足关系式 $\\mathbb{E}[Y_{n+1} | \\mathcal{F}_n] = (1 - 2/N)Y_n$，其中$\\mathcal{F}_n = \\sigma(X_0, X_1, \\dots, X_n)$是该过程的自然滤。该关系式意味着由\n$$M_n = \\left(1 - \\frac{2}{N}\\right)^{-n} \\left(X_n - \\frac{N}{2}\\right)$$\n定义的过程$M_n$是关于$\\mathcal{F}_n$的一个鞅。\n\n假设过程开始时罐子1中有固定数量的粒子$k$，即$X_0 = k$，求此鞅的二阶矩$\\mathbb{E}[M_n^2]$关于$n$、$N$和$k$的精确表达式。", "solution": "定义 $Y_{n}=X_{n}-\\frac{N}{2}$。单步动态为\n$$\nY_{n+1}=\n\\begin{cases}\nY_{n}+1  \\text{概率为 } \\frac{N-X_{n}}{N}=\\frac{1}{2}-\\frac{Y_{n}}{N},\\\\\nY_{n}-1  \\text{概率为 } \\frac{X_{n}}{N}=\\frac{1}{2}+\\frac{Y_{n}}{N}.\n\\end{cases}\n$$\n令 $\\Delta_{n}=Y_{n+1}-Y_{n}\\in\\{-1,+1\\}$。那么，以$\\mathcal{F}_{n}$为条件，\n$$\n\\mathbb{E}[\\Delta_{n}\\mid \\mathcal{F}_{n}]=\\left(\\frac{1}{2}-\\frac{Y_{n}}{N}\\right)-\\left(\\frac{1}{2}+\\frac{Y_{n}}{N}\\right)=-\\frac{2}{N}Y_{n},\n$$\n$$\n\\mathbb{E}[\\Delta_{n}^{2}\\mid \\mathcal{F}_{n}]=1,\n$$\n所以\n$$\n\\operatorname{Var}(\\Delta_{n}\\mid \\mathcal{F}_{n})=1-\\left(\\frac{2}{N}Y_{n}\\right)^{2}=1-\\frac{4}{N^{2}}Y_{n}^{2}.\n$$\n使用 $\\mathbb{E}[Y_{n+1}\\mid \\mathcal{F}_{n}]=\\left(1-\\frac{2}{N}\\right)Y_{n}$ 以及恒等式 $\\mathbb{E}[Z^{2}]=\\operatorname{Var}(Z)+(\\mathbb{E}Z)^{2}$，\n$$\n\\mathbb{E}[Y_{n+1}^{2}\\mid \\mathcal{F}_{n}]=\\operatorname{Var}(Y_{n+1}\\mid \\mathcal{F}_{n})+\\left(\\mathbb{E}[Y_{n+1}\\mid \\mathcal{F}_{n}]\\right)^{2}\n= \\left(1-\\frac{4}{N^{2}}Y_{n}^{2}\\right)+\\left(1-\\frac{2}{N}\\right)^{2}Y_{n}^{2}\n=1+\\left(1-\\frac{4}{N}\\right)Y_{n}^{2}.\n$$\n取期望，并令 $s_{n}=\\mathbb{E}[Y_{n}^{2}]$，\n$$\ns_{n+1}=1+\\left(1-\\frac{4}{N}\\right)s_{n},\\qquad s_{0}=\\left(k-\\frac{N}{2}\\right)^{2}.\n$$\n令 $b=1-\\frac{4}{N}$。解此线性递推关系，\n$$\ns_{n}=b^{n}s_{0}+\\sum_{j=0}^{n-1}b^{j}=b^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{1-b^{n}}{1-b}\n=b^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-b^{n}\\right),\n$$\n即\n$$\n\\mathbb{E}[Y_{n}^{2}]=\\left(1-\\frac{4}{N}\\right)^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-\\left(1-\\frac{4}{N}\\right)^{n}\\right).\n$$\n由于 $M_{n}=\\left(1-\\frac{2}{N}\\right)^{-n}Y_{n}$，我们得到\n$$\n\\mathbb{E}[M_{n}^{2}]=\\left(1-\\frac{2}{N}\\right)^{-2n}\\mathbb{E}[Y_{n}^{2}]\n=\\left(1-\\frac{2}{N}\\right)^{-2n}\\left[\\left(1-\\frac{4}{N}\\right)^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-\\left(1-\\frac{4}{N}\\right)^{n}\\right)\\right].\n$$\n这就是关于$n$、$N$和$k$的二阶矩的精确表达式。", "answer": "$$\\boxed{\\left(1-\\frac{2}{N}\\right)^{-2n}\\left[\\left(1-\\frac{4}{N}\\right)^{n}\\left(k-\\frac{N}{2}\\right)^{2}+\\frac{N}{4}\\left(1-\\left(1-\\frac{4}{N}\\right)^{n}\\right)\\right]}$$", "id": "1317068"}]}