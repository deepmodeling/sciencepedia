{"hands_on_practices": [{"introduction": "这个练习是 Doob 鞅不等式的一个经典应用，特别是针对非负鞅的维尔不等式（Ville's inequality）。通过一个动态广告策略的场景，你将学会如何为一个代表信念或概率的随机过程设定一个上界，计算它达到某个不期望的高值的概率上限。这个练习能够帮助你直观地理解，如何利用鞅的初始值来约束其未来的最大值 [@problem_id:1298735]。", "problem": "一位名叫 Priya 的数据科学家正在为客户开发一种动态广告策略。该策略可以是两种类型之一：“定向”(Targeted)或“广泛”(Broad)。在每一天 $n$（$n=0, 1, 2, \\dots$）开始时，Priya 的策略是一种混合策略，由选择“定向”方法的概率 $X_n$ 定义。Priya 从初始策略 $X_0 = 0.4$ 开始，这代表了她在收集任何每日数据之前的初始信念。\n\nPriya 使用一种学习算法，该算法根据前一天的市场表现每日更新策略 $X_n$。该算法的设计使得概率序列 $\\{X_n\\}_{n\\geq 0}$ 相对于每日信息更新序列构成一个鞅过程 (martingale process)。\n\n客户担心过度专业化，并将一种策略定义为“不合意地聚焦”，即如果使用“定向”广告的概率曾达到或超过 $0.95$。假设此过程无限期地持续下去，求广告策略曾变为“不合意地聚焦”的最大可能概率。将你的答案计算为小数，并四舍五入到三位有效数字。", "solution": "设 $\\{X_{n}\\}_{n\\geq 0}$ 是一个鞅，其中 $X_{0}=0.4$ 且对所有 $n$ 都有 $0\\leq X_{n}\\leq 1$，并设 $a=0.95$。定义事件 $A=\\{\\sup_{n\\geq 0}X_{n}\\geq a\\}$。\n\n由于 $\\{X_{n}\\}$ 是一个非负鞅，它也是一个非负上鞅 (supermartingale)。根据非负上鞅的 Ville 不等式，\n$$\n\\mathbb{P}(A)\\leq \\frac{\\mathbb{E}[X_{0}]}{a}=\\frac{0.4}{0.95}.\n$$\n因此，\n$$\n\\mathbb{P}\\left(\\sup_{n\\geq 0}X_{n}\\geq 0.95\\right)\\leq \\frac{0.4}{0.95}=\\frac{8}{19}.\n$$\n\n为了证明这个界是可达的，我们如下构造一个鞅：设\n$$\nX_{1}=\\begin{cases}\na  \\text{以概率 } p,\\\\\n0  \\text{以概率 } 1-p,\n\\end{cases}\n$$\n其中 $p$ 的选择满足鞅条件 $\\mathbb{E}[X_{1}\\mid X_{0}]=X_{0}$，即，\n$$\npa+(1-p)\\cdot 0 = X_{0}\\quad\\Rightarrow\\quad p=\\frac{X_{0}}{a}=\\frac{0.4}{0.95}=\\frac{8}{19}.\n$$\n对于 $n\\geq 1$，设 $X_{n}=X_{1}$。这个过程是一个有界鞅，其中 $X_{0}=0.4$，并且它满足\n$$\n\\mathbb{P}\\left(\\sup_{n\\geq 0}X_{n}\\geq a\\right)=\\mathbb{P}(X_{1}=a)=\\frac{X_{0}}{a}=\\frac{8}{19}.\n$$\n因此，该过程曾达到或超过 $0.95$ 的最大可能概率等于 $\\frac{8}{19}$，其小数形式四舍五入到三位有效数字为 $0.421$。", "answer": "$$\\boxed{0.421}$$", "id": "1298735"}, {"introduction": "现在让我们进入一个更普遍的场景，应用 Doob 的 $L^2$ 极大不等式。本问题将鞅理论与工程实践中的一个重要算法——递归最小二乘法（RLS）联系起来。你的任务是为一个动态更新的估计误差序列找到其最大值的概率界限，这在保证算法稳定性和性能方面至关重要 [@problem_id:1298765]。", "problem": "一位工程师正在实现一种递归最小二乘 (RLS) 算法，用于估计一个静态的未知标量参数 $\\theta$。该系统由线性模型 $y_k = x_k \\theta + v_k$ 描述，其中时间步为离散的 $k = 1, 2, \\ldots, N$。输入 $x_k$ 是确定性的，由工程师选择为 $x_k = \\frac{1}{\\sqrt{k}}$。测量噪声项 $v_k$ 是独立同分布的随机变量，其均值为零，$\\mathbb{E}[v_k] = 0$，方差为有限值，$\\operatorname{Var}(v_k) = \\sigma^2$。\n\nRLS 估计值 $\\hat{\\theta}_n$ 是使累积平方误差 $\\sum_{k=1}^n (y_k - x_k \\hat{\\theta}_n)^2$ 最小化的值。第 $n$ 步的估计误差定义为 $\\tilde{\\theta}_n = \\hat{\\theta}_n - \\theta$。分析该算法性能的一个关键量是比例误差，定义为 $M_n = \\left(\\sum_{k=1}^n x_k^2\\right) \\tilde{\\theta}_n$。对于此系统，序列 $\\{M_n\\}_{n=1}^N$ 是一个零均值鞅。\n\n为确保系统稳定性和性能，该比例误差的幅度必须保持在一定的操作范围内。你的任务是，对截至第 $N$ 步的任意时刻，比例误差的幅度超过给定常数容差 $c  0$ 的概率，求一个紧上界。具体来说，通过应用一个利用鞅的二阶矩的标准鞅不等式，求出 $\\mathbb{P}(\\max_{1 \\le n \\le N} |M_n| \\ge c)$ 的一个上界。\n\n你的答案应表示为关于总步数 $N$、噪声方差 $\\sigma^2$ 和容差 $c$ 的解析表达式。你应该使用记号 $H_N$ 来表示第 $N$ 个调和数，其定义为 $H_N = \\sum_{k=1}^N \\frac{1}{k}$。", "solution": "使 $\\sum_{k=1}^{n}(y_{k}-x_{k}\\hat{\\theta}_{n})^{2}$ 最小化的最小二乘估计量为\n$$\n\\hat{\\theta}_{n}=\\left(\\sum_{k=1}^{n}x_{k}^{2}\\right)^{-1}\\sum_{k=1}^{n}x_{k}y_{k}.\n$$\n代入 $y_{k}=x_{k}\\theta+v_{k}$ 可得\n$$\n\\tilde{\\theta}_{n}=\\hat{\\theta}_{n}-\\theta=\\left(\\sum_{k=1}^{n}x_{k}^{2}\\right)^{-1}\\sum_{k=1}^{n}x_{k}v_{k}.\n$$\n因此，比例误差为\n$$\nM_{n}=\\left(\\sum_{k=1}^{n}x_{k}^{2}\\right)\\tilde{\\theta}_{n}=\\sum_{k=1}^{n}x_{k}v_{k}.\n$$\n当 $x_{k}=\\frac{1}{\\sqrt{k}}$ 且 $v_{k}$ 是独立的零均值、方差为 $\\sigma^{2}$ 的随机变量时，$\\{M_{n}\\}$ 是一个关于由 $\\{v_{k}\\}$ 生成的滤子的零均值鞅。对于一个平方可积的鞅，$M_{n}^{2}$ 是一个非负下鞅。对于非负下鞅的 Doob 最大不等式表明，对于任意 $c0$，\n$$\n\\mathbb{P}\\left(\\max_{1\\leq n\\leq N}M_{n}^{2}\\geq c^{2}\\right)\\leq \\frac{\\mathbb{E}[M_{N}^{2}]}{c^{2}}.\n$$\n等价地，\n$$\n\\mathbb{P}\\left(\\max_{1\\leq n\\leq N}|M_{n}|\\geq c\\right)\\leq \\frac{\\mathbb{E}[M_{N}^{2}]}{c^{2}}.\n$$\n计算二阶矩：\n$$\n\\mathbb{E}[M_{N}^{2}]=\\operatorname{Var}\\left(\\sum_{k=1}^{N}x_{k}v_{k}\\right)=\\sum_{k=1}^{N}x_{k}^{2}\\operatorname{Var}(v_{k})=\\sigma^{2}\\sum_{k=1}^{N}\\frac{1}{k}=\\sigma^{2}H_{N}.\n$$\n因此，\n$$\n\\mathbb{P}\\left(\\max_{1\\leq n\\leq N}|M_{n}|\\geq c\\right)\\leq \\frac{\\sigma^{2}H_{N}}{c^{2}}.\n$$\n此界是通过使用二阶矩的 Doob 最大不等式得到的，并且在该不等式的最优常数意义下是紧的。", "answer": "$$\\boxed{\\frac{\\sigma^{2} H_{N}}{c^{2}}}$$", "id": "1298765"}, {"introduction": "这个练习从一个新颖的角度展示了鞅不等式的威力，我们的关注点从过程的最大值转移到了其增量（或“跳跃”）的最大值。在一个天气预报模型中，预测的剧烈波动会影响其可信度。通过这个练习，你将学习如何利用鞅增量的正交性来约束预测在相邻两天之间的最大变化幅度，从而评估预测模型的稳定性 [@problem_id:1298773]。", "problem": "一家气象机构开发了一个复杂的模型来预测未来某个重要事件的降雨概率。设 $p_n$ 为第 $n$ 天发布的降雨概率预测，其中 $n=0$ 代表初始预测，$n=N$ 代表事件发生当天。预测序列 $\\{p_n\\}_{n=0}^N$ 随着每天获得的新信息（例如，卫星数据、大气压力读数）而演变。该模型的设计使得这个序列 $\\{p_n\\}_{n=0}^N$ 相对于每日的信息流构成一个鞅。\n\n今天的初始预测（第 $n=0$ 天）是 $p_0 = 0.2$。在事件发生当天，即 $n=N$ 时，所有不确定性都将消除，$p_N$ 的值如果下雨则为 1，如果不下雨则为 0。\n\n该预测用户的一个主要担忧是其稳定性。每日的大幅变化会削弱人们对模型的信心。请确定在任意一天 $n \\in \\{1, 2, \\dots, N\\}$，任何单日修正的幅度 $|p_n - p_{n-1}|$ 超过或等于阈值 $\\alpha = 0.5$ 的概率的数值上界。\n\n将您的答案表示为一个保留三位有效数字的实数。", "solution": "设 $\\{p_{n}\\}_{n=0}^{N}$ 是一个相对于每日信息流的鞅，其中 $p_{0}\\in[0,1]$ 且 $p_{N}\\in\\{0,1\\}$。定义鞅差 $d_{n}=p_{n}-p_{n-1}$，对于 $n\\geq 1$。\n\n因为 $\\{p_{n}\\}$ 是一个 $L^{2}$-鞅，我们有增量正交性恒等式\n$$\n\\mathbb{E}\\big[p_{N}^{2}\\big]=\\mathbb{E}\\big[p_{0}^{2}\\big]+\\sum_{n=1}^{N}\\mathbb{E}\\big[d_{n}^{2}\\big].\n$$\n因此，\n$$\n\\sum_{n=1}^{N}\\mathbb{E}\\big[d_{n}^{2}\\big]=\\mathbb{E}\\big[p_{N}^{2}\\big]-p_{0}^{2}.\n$$\n在事件发生当天，$p_{N}\\in\\{0,1\\}$ 等于下雨的指示函数，所以 $p_{N}^{2}=p_{N}$，因此 $\\mathbb{E}[p_{N}^{2}]=\\mathbb{E}[p_{N}]$。根据鞅的性质，$\\mathbb{E}[p_{N}]=\\mathbb{E}[p_{0}]=p_{0}$。于是，\n$$\n\\sum_{n=1}^{N}\\mathbb{E}\\big[d_{n}^{2}\\big]=p_{0}-p_{0}^{2}=p_{0}(1-p_{0}).\n$$\n\n设 $A=\\{\\max_{1\\leq n\\leq N}|d_{n}|\\geq \\alpha\\}$。由于 $d_{n}^{2}\\geq 0$，我们有以下确定性不等式\n$$\n\\mathbf{1}_{A}\\leq \\frac{1}{\\alpha^{2}}\\sum_{n=1}^{N}d_{n}^{2},\n$$\n因为在事件 $A$ 上，至少有一个 $d_{n}^{2}$ 不小于 $\\alpha^{2}$，使得总和不小于 $\\alpha^{2}$，而在 $A$ 之外，不等式两边都为零或非负。取期望值得\n$$\n\\mathbb{P}(A)=\\mathbb{E}[\\mathbf{1}_{A}]\\leq \\frac{1}{\\alpha^{2}}\\sum_{n=1}^{N}\\mathbb{E}[d_{n}^{2}]=\\frac{p_{0}(1-p_{0})}{\\alpha^{2}}.\n$$\n\n代入 $p_{0}=0.2$ 和 $\\alpha=0.5$ 得\n$$\n\\mathbb{P}\\!\\left(\\max_{1\\leq n\\leq N}|p_{n}-p_{n-1}|\\geq 0.5\\right)\\leq \\frac{0.2\\times 0.8}{(0.5)^{2}}=\\frac{0.16}{0.25}=0.64.\n$$\n保留三位有效数字，上界为 $0.640$。", "answer": "$$\\boxed{0.640}$$", "id": "1298773"}]}