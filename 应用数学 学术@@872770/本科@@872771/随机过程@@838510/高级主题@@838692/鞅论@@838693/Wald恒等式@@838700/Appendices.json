{"hands_on_practices": [{"introduction": "第一个练习探讨了一个基本问题：一个随机游走需要多长时间才能偏离其起点一定距离？我们将构建一个称为鞅的特殊过程，并应用可选停止定理——一个与瓦尔德等式密切相关的强大工具——来求解期望的退出时间。这个练习展示了分析随机过程中停时的核心技术。[@problem_id:871105]", "problem": "考虑一个从原点 $S_0 = 0$ 开始的一维随机游走 $S_n$。该游走由和 $S_n = \\sum_{i=1}^n X_i$ 定义，其中增量 $X_i$ 是独立同分布 (i.i.d.) 的随机变量。这些增量的均值为零，$\\mathbb{E}[X_i] = 0$，且方差有限且非零，$\\text{Var}(X_i) = \\mathbb{E}[X_i^2] = \\sigma^2$。\n\n令 $T$ 为随机游走首次离开开放对称区间 $(-a, a)$ 的时间，其中 $a$ 是一个正常数。该停时形式上定义为 $T = \\inf\\{n \\ge 1 : |S_n| \\ge a \\}$。\n\n为了简化分析，我们做出一个关键假设：**无超调**。这意味着当游走停止时，其位置恰好在边界上，即 $S_T = a$ 或 $S_T = -a$。我们还假设停时 $T$ 以概率 1 是有限的。\n\n使用与鞅和可选停止定理（通常与 Wald 恒等式相关）相关的原理，推导期望停时 $\\mathbb{E}[T]$ 关于边界参数 $a$ 和增量方差 $\\sigma^2$ 的表达式。", "solution": "1. 定义过程\n$$M_n = S_n^2 - n\\,\\sigma^2.$$\n由于 $\\{X_i\\}$ 是独立同分布的，且 $\\mathbb{E}[X_i]=0$ 和 $\\text{Var}(X_i)=\\sigma^2$，我们有\n$$\\mathbb{E}[S_{n+1}^2\\mid\\mathcal{F}_n]\n=\\mathbb{E}[(S_n+X_{n+1})^2\\mid\\mathcal{F}_n]\n=S_n^2+2S_n\\mathbb{E}[X_{n+1}]+\\mathbb{E}[X_{n+1}^2]\n=S_n^2+\\sigma^2.$$\n因此\n$$\\mathbb{E}[M_{n+1}\\mid\\mathcal{F}_n]\n=\\mathbb{E}[S_{n+1}^2\\mid\\mathcal{F}_n]-(n+1)\\sigma^2\n=S_n^2+\\sigma^2-(n+1)\\sigma^2\n=M_n,$$\n所以 $M_n$ 是一个鞅。\n\n2. 根据可选停止定理，在有限停时 $T$ 处，\n$$\\mathbb{E}[M_T]=\\mathbb{E}[M_0].$$\n由于 $M_0=S_0^2-0\\cdot\\sigma^2=0$，我们得到\n$$\\mathbb{E}[S_T^2 - T\\,\\sigma^2]=0.$$\n\n3. 在无超调假设下， $|S_T|=a$，所以 $S_T^2=a^2$。因此\n$$a^2 - \\sigma^2\\,\\mathbb{E}[T]=0\n\\quad\\Longrightarrow\\quad\n\\mathbb{E}[T]=\\frac{a^2}{\\sigma^2}.$$", "answer": "$$\\boxed{\\frac{a^2}{\\sigma^2}}$$", "id": "871105"}, {"introduction": "在我们对停时的理解基础上，本问题将瓦尔德等式直接应用于一个关于元件失效的实际场景。与前一个理想化的情况不同，我们现在必须考虑“超调量”——即过程超过阈值的量。这个练习将提升你在实际情况中应用瓦尔德等式的能力，并处理跨越边界事件的细微差别。[@problem_id:871116]", "problem": "一个敏感的电子元件受到一系列电涌的冲击。每次电涌造成的损害是量化的，第 $i$ 次电涌的强度由一个随机变量 $X_i$ 表示。这些强度是独立同分布 (i.i.d.) 的随机变量。\n\n每个 $X_i$ 服从成功参数为 $p \\in (0, 1]$ 的几何分布，其概率质量函数描述为：\n$$\nP(X = k) = (1-p)^{k-1}p, \\quad \\text{for } k \\in \\{1, 2, 3, \\dots\\}\n$$\n该分布模拟了在一系列独立的伯努利试验中，为取得首次成功所需的试验次数。\n\n当累积损害 $S_n = \\sum_{i=1}^n X_i$ 首次达到或超过一个临界阈值 $K$ 时，该元件会发生灾难性故障，其中 $K$ 是一个正整数。设 $N$ 是导致元件故障的电涌次数。在数学上，$N$ 是一个停时，定义为：\n$$\nN = \\min\\{n \\in \\{1, 2, \\dots\\} : S_n \\ge K\\}\n$$\n\n使用序贯分析的原理，特别是 Wald 等式，推导该元件在失效前能承受的预期电涌次数 $\\mathbb{E}[N]$。用 $p$ 和 $K$ 表示你的答案。", "solution": "1. 相关方程  \n对于停时 $N$ 和具有有限均值的独立同分布增量 $X_i$，Wald 等式为：\n$$\\mathbb{E}[S_N]=\\mathbb{E}[N]\\,\\mathbb{E}[X],\\quad S_N=\\sum_{i=1}^N X_i.$$\n首次穿越总和满足\n$$S_N=K+R,$$\n其中 $R=S_N-K$ 是超调量。\n\n2. 计算 $\\mathbb{E}[X]$ 和 $\\mathbb{E}[R]$  \n对于在 $\\{1,2,\\dots\\}$ 上的 $X\\sim\\mathrm{Geom}(p)$，\n$$\\mathbb{E}[X]=\\frac1p.$$\n根据无记忆性，在最后一次跳跃超过到 $K$ 的间隙的条件下，超调量 $R$ 服从在 $\\{0,1,2,\\dots\\}$ 上参数为 $p$ 的几何分布，因此\n$$\\mathbb{E}[R]=\\frac{1-p}{p}.$$\n\n3. 通过 Wald 等式组合  \n$$\\mathbb{E}[S_N]=\\mathbb{E}[K+R]=K+\\frac{1-p}{p},$$\n所以\n$$\\mathbb{E}[N]\n=\\frac{\\mathbb{E}[S_N]}{\\mathbb{E}[X]}\n=\\biggl(K+\\frac{1-p}{p}\\biggr)\\,p\n=pK+1-p.$$", "answer": "$$\\boxed{pK+1-p}$$", "id": "871116"}, {"introduction": "我们的最后一个练习将颠倒分析的方向，展示这些概率工具的诊断能力。我们将不再从已知参数预测结果，而是利用一个已知的期望结果——游走的最终位置——来推断系统的一个未知基本参数。本问题利用了植根于鞅论的赌徒破产框架来进行参数推断。[@problem_id:871112]", "problem": "考虑一个从 $S_0=0$ 开始的一维简单随机游走 $S_n = \\sum_{i=1}^n X_i$。步长 $X_i$ 是独立同分布的随机变量，其概率质量函数为 $P(X_i = +1) = p$ 和 $P(X_i = -1) = 1-p$，其中 $p \\in (0,1)$ 是偏差参数。\n\n当游走首次到达下边界 $-a$ 或上边界 $a$ 时停止，其中 $a$ 是一个正整数。因此，停时定义为 $T = \\inf\\{n \\ge 1 : S_n = -a \\text{ or } S_n = a\\}$。我们假设偏差 $p$ 不等于 $1/2$。\n\n游走在该停时的期望位置由 $E[S_T] = \\mathcal{E}$ 给出。请注意，为使这样的系统在物理上可实现，必须满足 $|\\mathcal{E}|  a$。\n\n请推导用边界参数 $a$ 和期望停止位置 $\\mathcal{E}$ 表示偏差参数 $p$ 的闭式表达式。", "solution": "1. 赌徒破产概率。令 $r=\\frac{1-p}{p}$。从 0 出发，在到达 $-a$ 之前先到达 $+a$ 的概率为\n$$\nP_{+a}\n=\\frac{1-r^a}{1-r^{2a}}。\n$$\n\n2. 期望停止位置。由于 $S_T=\\pm a$，我们有\n$$\n\\mathbb{E}[S_T]\n=a\\,P_{+a}-a\\,(1-P_{+a})\n=a\\bigl(2P_{+a}-1\\bigr)\n=a\\,\\frac{1-r^a}{1+r^a}。\n$$\n\n3. 求解 $r$。设 $\\mathcal{E}=\\mathbb{E}[S_T]$ 并定义 $X=\\mathcal{E}/a$。则\n$$\nX=\\frac{1-r^a}{1+r^a}\n\\;\\Longrightarrow\\;\nr^a=\\frac{1-X}{1+X}\n\\;\\Longrightarrow\\;\nr=\\Bigl(\\tfrac{1-X}{1+X}\\Bigr)^{\\!1/a}。\n$$\n\n4. 表示 $p$。由于 $r=(1-p)/p$，我们得到\n$$\np=\\frac{1}{1+r}\n=\\frac{1}{1+\\bigl(\\tfrac{1-X}{1+X}\\bigr)^{1/a}}\n=\\frac{1}{1+\\left(\\frac{1-\\mathcal{E}/a}{1+\\mathcal{E}/a}\\right)^{1/a}}。\n$$", "answer": "$$\\boxed{\\frac{1}{1+\\left(\\frac{1-\\mathcal{E}/a}{1+\\mathcal{E}/a}\\right)^{1/a}}}$$", "id": "871112"}]}