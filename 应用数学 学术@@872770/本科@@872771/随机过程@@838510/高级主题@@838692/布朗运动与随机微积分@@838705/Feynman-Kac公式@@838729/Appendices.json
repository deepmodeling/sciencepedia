{"hands_on_practices": [{"introduction": "理论通过实践才能更好地理解。本节提供了一系列动手实践问题，旨在帮助你建立应用费曼-卡茨公式的直观感觉和技能。我们从一个基础问题开始，它将在计算随机现金流的期望现值与求解一个常微分方程之间建立起桥梁。这个问题 [@problem_id:1337995] 完美地展示了费曼-卡茨公式的核心思想：将一个涉及无数随机路径的概率期望问题，转化为一个单一且可解的微分方程问题。", "problem": "一个资产的价格，在时间 $s$ 时表示为 $X_s$，被建模为一个标准的一维布朗运动。其演化由随机微分方程 $dX_s = dW_s$ 描述，其中 $W_s$ 是一个标准的维纳过程。该资产的初始价格为 $X_0 = x$。\n\n该资产产生一个连续的支付流。在任何时间 $s \\ge 0$，瞬时支付率由资产价格的平方给出，即支付率为 $f(X_s) = X_s^2$。\n\n一位投资者希望计算该资产在无限时间范围内的所有未来支付的总现值。未来的支付以一个恒定的无风险利率 $r > 0$ 进行连续贴现。\n\n确定这个无限支付流的预期总贴现值，作为初始价格 $x$ 和贴现率 $r$ 的函数。", "solution": "令 $X_{s}$ 为一个从 $X_{0}=x$ 开始的标准布朗运动，因此 $dX_{s}=dW_{s}$ 且 $X_{s}=x+W_{s}$。运行收益 $f(X_{s})=X_{s}^{2}$ 的总贴现值为\n$$\nV(x)=\\mathbb{E}_{x}\\left[\\int_{0}^{\\infty} \\exp(-r s)\\,X_{s}^{2}\\,ds\\right], \\quad r>0.\n$$\n由于 $X_{s}^{2}\\ge 0$，根据托内利定理（Tonelli's theorem），可以交换期望和积分的顺序：\n$$\nV(x)=\\int_{0}^{\\infty} \\exp(-r s)\\,\\mathbb{E}_{x}[X_{s}^{2}]\\,ds.\n$$\n因为 $X_{s}=x+W_{s}$，且 $\\mathbb{E}[W_{s}]=0$ 和 $\\mathbb{V}\\mathrm{ar}(W_{s})=s$，我们有\n$$\n\\mathbb{E}_{x}[X_{s}^{2}]=\\mathbb{V}\\mathrm{ar}(X_{s})+\\left(\\mathbb{E}_{x}[X_{s}]\\right)^{2}=s+x^{2}.\n$$\n因此\n$$\nV(x)=\\int_{0}^{\\infty} \\exp(-r s)\\,(x^{2}+s)\\,ds\n= x^{2}\\int_{0}^{\\infty} \\exp(-r s)\\,ds + \\int_{0}^{\\infty} s\\,\\exp(-r s)\\,ds.\n$$\n对于 $r>0$，\n$$\n\\int_{0}^{\\infty} \\exp(-r s)\\,ds=\\frac{1}{r}.\n$$\n对于第二个积分，使用分部积分法，令 $u=s$ 和 $dv=\\exp(-r s)\\,ds$，则 $du=ds$ 且 $v=-(1/r)\\exp(-r s)$：\n$$\n\\int_{0}^{\\infty} s\\,\\exp(-r s)\\,ds=\\left.-\\frac{s}{r}\\exp(-r s)\\right|_{0}^{\\infty}+\\frac{1}{r}\\int_{0}^{\\infty}\\exp(-r s)\\,ds\n=0+\\frac{1}{r}\\cdot\\frac{1}{r}=\\frac{1}{r^{2}}.\n$$\n因此，\n$$\nV(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}.\n$$\n作为通过费曼-卡茨公式（Feynman–Kac formula）的一致性检验，$v(x)=V(x)$ 求解带有生成元 $\\mathcal{L}=\\frac{1}{2}\\frac{d^{2}}{dx^{2}}$ 的常微分方程（ODE） $(r-\\mathcal{L})v=x^{2}$，即\n$$\nr v(x)-\\frac{1}{2}v''(x)=x^{2}.\n$$\n一个特解 $v_{p}(x)=a x^{2}+b$ 得到 $v_{p}''(x)=2a$ 并且代入方程得到 $r(ax^2+b) - \\frac{1}{2}(2a) = x^2$。通过比较系数，我们得到 $ra=1$ 和 $rb-a=0$，解出 $a=\\frac{1}{r}$ 和 $b=\\frac{1}{r^{2}}$。齐次解 $\\exp(\\pm\\sqrt{2r}\\,x)$ 因至多为多项式增长的要求而被排除，这证实了 $v(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}$。", "answer": "$$\\boxed{\\frac{x^{2}}{r}+\\frac{1}{r^{2}}}$$", "id": "1337995"}, {"introduction": "接下来，我们将探讨一个源于物理学或材料科学的扩散问题。这个问题 [@problem_id:1338001] 虽然本质上是一个概率问题（“粒子在撞击内边界之前先撞击外边界的概率是多少？”），但其最优雅的解决方案来自于将其转化为一个偏微分方程——在本例中为拉普拉斯方程。这个练习展示了费曼-卡茨框架在解决涉及几何边界和命中概率问题时的强大威力，而这些问题若使用纯概率方法可能会非常棘手。", "problem": "一个金吸附原子在完全平坦的银表面上扩散。使用先进的操纵技术，构建了两个同心圆形势垒，形成一个环形区域，该吸附原子被暂时限制在该区域内。内势垒的半径为 $R_1$，外势垒的半径为 $R_2$，且 $R_1  R_2$。该吸附原子在表面上的运动可以很好地用标准的二维布朗运动来描述。\n\n这些势垒并非完美；它们可以被穿过。一旦吸附原子的路径与内圆形势垒或外圆形势垒相交，该过程即停止。假设吸附原子最初被放置在距离圆心径向距离为 $r_0$ 的位置，使得 $R_1  r_0  R_2$。由于问题的对称性，我们感兴趣的概率将不依赖于具体的角位置，而仅依赖于初始径向距离 $r_0$。\n\n确定吸附原子在穿过半径为 $R_1$ 的内势垒之前，先穿过半径为 $R_2$ 的外势垒的概率，我们将其记为 $P(r_0)$。你的最终答案应该是一个用 $r_0$、$R_1$ 和 $R_2$ 表示的闭式解析表达式。", "solution": "令 $P(r)$ 为从径向距离 $r$ 出发的吸附原子在到达半径为 $R_1$ 的内边界之前先到达半径为 $R_2$ 的外边界的概率。根据费曼-卡茨公式，这个概率是一个调和函数，即它满足拉普拉斯方程 $\\Delta P = 0$。由于问题的径向对称性，$P$ 仅依赖于径向坐标 $r$，而拉普拉斯算子在极坐标下为 $\\Delta = \\frac{\\partial^2}{\\partial r^2} + \\frac{1}{r}\\frac{\\partial}{\\partial r}$。\n因此，$P(r)$ 满足常微分方程：\n$$ P''(r) + \\frac{1}{r} P'(r) = 0 $$\n这是一个可分离变量或欧拉型方程。令 $Q(r) = P'(r)$，我们有 $Q' = -Q/r$，积分得到 $\\ln Q = -\\ln r + C$，或 $Q(r) = P'(r) = C_1/r$。\n再次积分，我们得到 $P(r)$ 的通解：\n$$ P(r) = C_1 \\ln(r) + C_2 $$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的常数。\n边界条件是：\n1.  如果吸附原子从内边界 $R_1$ 开始，它立即到达了内边界，所以它先到达外边界的概率为0。因此，$P(R_1) = 0$。\n2.  如果吸附原子从外边界 $R_2$ 开始，它立即到达了外边界，所以它先到达外边界的概率为1。因此，$P(R_2) = 1$。\n应用这些条件：\n$$\n\\begin{cases}\nC_1 \\ln(R_1) + C_2 = 0 \\\\\nC_1 \\ln(R_2) + C_2 = 1\n\\end{cases}\n$$\n从第二个方程减去第一个方程，我们得到：\n$$ C_1 (\\ln(R_2) - \\ln(R_1)) = 1 \\implies C_1 = \\frac{1}{\\ln(R_2/R_1)} $$\n将 $C_1$ 代入第一个方程，我们得到 $C_2$：\n$$ C_2 = -C_1 \\ln(R_1) = -\\frac{\\ln(R_1)}{\\ln(R_2/R_1)} $$\n将 $C_1$ 和 $C_2$ 代回 $P(r)$ 的表达式中，对于初始半径为 $r_0$ 的情况，我们有：\n$$ P(r_0) = \\frac{1}{\\ln(R_2/R_1)} \\ln(r_0) - \\frac{\\ln(R_1)}{\\ln(R_2/R_1)} = \\frac{\\ln(r_0) - \\ln(R_1)}{\\ln(R_2/R_1)} = \\frac{\\ln(r_0/R_1)}{\\ln(R_2/R_1)} $$\n这就是所求的概率。", "answer": "$$\\boxed{\\frac{\\ln\\!\\left(\\frac{r_{0}}{R_{1}}\\right)}{\\ln\\!\\left(\\frac{R_{2}}{R_{1}}\\right)}}$$", "id": "1338001"}, {"introduction": "最后，我们来处理一个引入了新元素的挑战：反射过程。在现实世界中，许多量都受到非负等约束，例如资产价格，而反射布朗运动是模拟此类现象的常用模型。这个问题 [@problem_id:1338002] 揭示了费曼-卡茨关联更深层次的对应关系：随机过程在边界上的行为（如反射）如何直接转化为其对应微分方程的一种特定边界条件（诺伊曼条件）。通过这个练习，你将更深刻地理解随机过程的路径行为与其分析描述之间的精妙联系。", "problem": "一个金融资产状态的简化模型由一维反射布朗运动 $X_t$ 给出，它从一个初始正值 $X_0 = x$ 开始。过程 $X_t$ 作为一个标准布朗运动演化，但当它试图穿过原点时会瞬时反射，以确保其值保持非负。\n\n一家公司持有该资产，并在持有期间以每单位时间 $c$ 的恒定速率产生运营成本。该公司有一个预定策略，即一旦资产价值达到目标水平 $a$，就立即清算该资产。初始值 $x$ 严格介于0和$a$之間，即 $0  x  a$。\n\n假设参数 $x$、$a$ 和 $c$ 均为正常数，求出公司在资产被清算前所产生的总期望运营成本的闭式解析表达式。", "solution": "令 $T_{a}=\\inf\\{t\\geq 0: X_{t}=a\\}$ 为清算时间。到清算时累积的总运营成本为 $\\int_{0}^{T_{a}} c\\,dt$，因此根据期望的线性性质，期望总成本为 $c\\,\\mathbb{E}_{x}[T_{a}]$。因此，我们只需计算 $u(x)=\\mathbb{E}_{x}[T_{a}]$，其中过程为在 $[0,\\infty)$ 上的反射布朗運動，从 $x\\in(0,a)$ 出发，在0处反射，在$a$处吸收。\n\n在 $[0,\\infty)$ 上的标准反射布朗运动的生成元在 $(0,a)$ 上为 $L=\\frac{1}{2}\\frac{d^{2}}{dx^{2}}$，在0处有诺伊曼边界条件（反射），在$a$处有狄利克雷边界条件（吸收）。根据 Dynkin 公式，$u$ 求解泊松问题\n$$\n\\frac{1}{2}u''(x)=-1,\\quad x\\in(0,a),\n$$\n边界条件为\n$$\nu'(0)=0,\\qquad u(a)=0.\n$$\n求解该问题，我们对 $u''(x)=-2$ 积分得到 $u'(x)=-2x+C_{1}$。诺伊曼条件 $u'(0)=0$ 意味着 $C_{1}=0$，因此 $u'(x)=-2x$。再次积分得到 $u(x)=-x^{2}+C_{2}$。狄利克雷条件 $u(a)=0$ 给出 $C_{2}=a^{2}$，因此\n$$\nu(x)=a^{2}-x^{2}.\n$$\n所以，期望总运营成本为\n$$\nc\\,u(x)=c\\left(a^{2}-x^{2}\\right).\n$$", "answer": "$$\\boxed{c\\left(a^{2}-x^{2}\\right)}$$", "id": "1338002"}]}