{"hands_on_practices": [{"introduction": "我们从反射原理最直接的应用开始。这个练习将抽象的概念应用到一个具体的计算中：在给定时间内，布朗运动超过某一阈值的概率。这对于评估物理、金融等不同领域的风险至关重要，是理解布朗运动极值的基本功。[@problem_id:1344184]", "problem": "在一个高精度物理实验中，我们正在监测一个关键部件沿单一轴线位置的热涨落。该部件偏离其平衡位置的位移 $X(t)$（以微米 μm 为单位）被建模为标准一维布朗运动，其中时间 $t$ 以秒为单位。标准布朗运动 $W(t)$ 的特征是 $W(0)=0$，具有连续路径，并且对于任何 $0 \\le s  t$，增量 $W(t) - W(s)$ 是一个均值为0、方差为 $t-s$ 的正态分布随机变量。\n\n如果在最初的16秒观测周期内的任何时刻，该位移的绝对值 $|X(t)|$ 达到了4 μm 的阈值，则实验将受损，必须重置。然而，监测设备只能记录16秒区间结束时的位移值，而不能记录此区间内的最大值。假设模型是准确的，我们希望计算一次未被记录的实验受损的概率，具体来说，就是最大位移 $M_{16} = \\max_{0 \\le t \\le 16} X(t)$ 大于或等于 4 μm 的事件的概率。\n\n计算这个概率。将您的最终答案四舍五入到四位有效数字。", "solution": "令 $\\{X(t): t \\ge 0\\}$ 为一个标准一维布朗运动，且 $X(0)=0$。对于 $t > 0$ 和 $a > 0$，定义游程最大值 $M_{t}=\\max_{0 \\le s \\le t} X(s)$。根据标准布朗运动的反射原理，在时间 $t$ 内，游程最大值超过一个正水平 $a$ 的概率为\n$$\n\\mathbb{P}(M_{t} \\ge a)=2\\,\\mathbb{P}(X(t) \\ge a).\n$$\n由于 $X(t) \\sim \\mathcal{N}(0,t)$，我们有\n$$\n\\mathbb{P}(X(t) \\ge a)=1-\\Phi\\!\\left(\\frac{a}{\\sqrt{t}}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。因此，\n$$\n\\mathbb{P}(M_{t} \\ge a)=2\\left[1-\\Phi\\!\\left(\\frac{a}{\\sqrt{t}}\\right)\\right].\n$$\n对于给定的值 $a=4$ 和 $t=16$，我们得到\n$$\n\\mathbb{P}(M_{16} \\ge 4)=2\\left[1-\\Phi\\!\\left(\\frac{4}{\\sqrt{16}}\\right)\\right]=2\\left[1-\\Phi(1)\\right].\n$$\n使用标准值 $\\Phi(1)\\approx 0.841344746$，可以得出\n$$\n\\mathbb{P}(M_{16} \\ge 4)\\approx 2\\left(1-0.841344746\\right)\\approx 0.317310508.\n$$\n四舍五入到四位有效数字，该概率为 $0.3173$。", "answer": "$$\\boxed{0.3173}$$", "id": "1344184"}, {"introduction": "在掌握了如何计算特定事件的概率后，我们现在更进一步，从计算单一概率转向确定一个平均行为。这个问题要求计算布朗运动在一段时间内的最大值的期望，这是评估系统可靠性和性能的关键指标。解决这个问题需要先利用反射原理推导出最大值的概率分布。[@problem_id:1344178]", "problem": "一位工程师正在分析一个敏感电子元件中的电压波动。随时间变化的积分噪声电压，记为 $V(t)$，被建模为一个标准的一维布朗运动 $\\{B_t\\}_{t \\ge 0}$。标准布朗运动是一个连续时间随机过程，具有以下性质：\n1.  $B_0 = 0$。\n2.  该过程具有独立增量。\n3.  对于任何 $0 \\le s  t$，增量 $B_t - B_s$ 是一个均值为 0、方差为 $t-s$ 的正态分布随机变量。\n\n该元件的一个关键失效模式是暴露在大的正电压下。为了评估这一风险，工程师需要确定在长度为 $T > 0$ 的时间区间内的预期峰值正电压。令 $M_T = \\max_{0 \\le t \\le T} B_t$ 表示此最大电压。\n\n你的任务是计算这个游程最大值的期望值 $E[M_T]$。用时间范围 $T$ 和数学常数 $\\pi$ 的符号表达式表示你的最终答案。", "solution": "设 $\\{B_{t}\\}_{t \\ge 0}$ 是一个标准布朗运动，且 $M_{T} = \\max_{0 \\le t \\le T} B_{t}$。我们使用反射原理：对于任何 $a > 0$，\n$$\n\\mathbb{P}(M_{T} \\ge a) = 2\\,\\mathbb{P}(B_{T} \\ge a).\n$$\n这是因为，在时间 $T$ 之前达到水平 $a$ 的路径，可以通过在首次到达时间 $a$ 之后进行反射，与终点 $B_T$ 至少为 $a$ 的路径建立一一对应关系。因为 $B_{T} \\sim \\mathcal{N}(0, T)$，我们有\n$$\n\\mathbb{P}(B_{T} \\ge a) = \\int_{a}^{\\infty} \\frac{1}{\\sqrt{2\\pi T}} \\exp\\!\\left(-\\frac{x^{2}}{2T}\\right) \\, dx.\n$$\n因此，对于 $a \\ge 0$，\n$$\n\\mathbb{P}(M_{T} \\le a) = 1 - \\mathbb{P}(M_{T} > a) = 1 - 2 \\int_{a}^{\\infty} \\frac{1}{\\sqrt{2\\pi T}} \\exp\\!\\left(-\\frac{x^{2}}{2T}\\right) \\, dx.\n$$\n等价地，记 $\\Phi$ 为标准正态分布函数，\n$$\n\\mathbb{P}(M_{T} \\le a) = 2\\,\\Phi\\!\\left(\\frac{a}{\\sqrt{T}}\\right) - 1 \\quad \\text{for } a \\ge 0,\n$$\n且当 $a  0$ 时 $\\mathbb{P}(M_{T} \\le a) = 0$。对 $a > 0$ 求导，得到密度函数\n$$\nf_{M_{T}}(a) = \\frac{d}{da}\\left[2\\,\\Phi\\!\\left(\\frac{a}{\\sqrt{T}}\\right) - 1\\right]\n= 2 \\cdot \\frac{1}{\\sqrt{T}} \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{a^{2}}{2T}\\right)\n= \\sqrt{\\frac{2}{\\pi T}} \\exp\\!\\left(-\\frac{a^{2}}{2T}\\right).\n$$\n因此，\n$$\n\\mathbb{E}[M_{T}] = \\int_{0}^{\\infty} a \\, f_{M_{T}}(a) \\, da\n= \\int_{0}^{\\infty} a \\, \\sqrt{\\frac{2}{\\pi T}} \\exp\\!\\left(-\\frac{a^{2}}{2T}\\right) da.\n$$\n通过换元法 $u = \\frac{a^{2}}{2T}$ 来计算积分，因此 $du = \\frac{a}{T} \\, da$ 且 $a \\, da = T \\, du$。这得到\n$$\n\\mathbb{E}[M_{T}] = \\sqrt{\\frac{2}{\\pi T}} \\, T \\int_{0}^{\\infty} \\exp(-u) \\, du\n= \\sqrt{\\frac{2}{\\pi T}} \\, T \\cdot 1\n= \\sqrt{\\frac{2T}{\\pi}}.\n$$\n作为一致性检验，布朗标度性给出 $M_{T} \\overset{d}{=} \\sqrt{T}\\, M_{1}$，所以 $\\mathbb{E}[M_{T}] = \\sqrt{T}\\, \\mathbb{E}[M_{1}]$；因为 $\\mathbb{E}[M_{1}] = \\sqrt{\\frac{2}{\\pi}}$，结果与 $\\sqrt{\\frac{2T}{\\pi}}$ 相符。", "answer": "$$\\boxed{\\sqrt{\\frac{2T}{\\pi}}}$$", "id": "1344178"}, {"introduction": "最后的这个练习展示了反射原理几何直觉的精妙与力量。我们将探讨一个更微妙的问题：在已知粒子终点位置的条件下，它曾经越过某个障碍的概率是多少？这种“事后”分析在许多科学和金融情景中很常见，其解答优美地揭示了布朗运动路径背后隐藏的对称性。[@problem_id:1344197]", "problem": "一位材料科学家正在研究一种纳米粒子在特殊基底上的一维扩散。粒子在时刻 $t$ 的位置，记为 $B_t$，被建模为从原点开始的标准布朗运动，因此 $B_0=0$。时间 $t$ 的单位是秒，位置的单位是纳米。\n\n在位置 $a > 0$ 处，基底上有一条反应带。如果纳米粒子的轨迹到达此位置，粒子会发生永久且不可逆的化学变化。在之后的某个时刻，可以检测这种变化是否已经发生。\n\n在特定的时刻 $t_f > 0$，进行了一项实验来测量粒子的当前位置，而不干扰其状态。测量结果显示，粒子位于位置 $x_f$，而已知 $x_f  a$。\n\n给定这一测量结果，粒子在时间区间 $[0, t_f]$ 内的某个时刻 $s$ 已经发生化学变化的概率是多少？请用给定的参数 $a$、$t_f$ 和 $x_f$ 将你的答案表示为一个闭式解析表达式。", "solution": "设 $\\{B_s\\}_{s \\ge 0}$ 是表示粒子位置的标准布朗运动。该过程从 $B_0=0$ 开始。如果粒子的路径达到或超过水平线 $a > 0$，它就会发生化学变化。粒子在时刻 $t_f$ 之前已经发生这种变化的事件可以用数学形式表示为 $\\{ \\sup_{0 \\le s \\le t_f} B_s \\ge a \\}$。我们把在时刻 $t_f$ 之前达到的最大位置记为 $M_{t_f} = \\sup_{0 \\le s \\le t_f} B_s$。\n\n我们已知在时刻 $t_f$，粒子的位置是 $B_{t_f} = x_f$，其中 $x_f  a$。我们需要计算条件概率 $P(M_{t_f} \\ge a | B_{t_f} = x_f)$。\n\n根据连续随机变量的条件概率定义，这可以表示为概率密度函数 (PDF) 的比值。非正式地，我们可以写成：\n$$ P(M_{t_f} \\ge a | B_{t_f} = x_f) = \\frac{f_{\\text{joint}}(M_{t_f} \\ge a, B_{t_f} = x_f)}{f_{B_{t_f}}(x_f)} $$\n其中 $f_{B_{t_f}}(x_f)$ 是布朗运动在时刻 $t_f$ 并在 $x_f$ 处取值的概率密度函数，而 $f_{\\text{joint}}(M_{t_f} \\ge a, B_{t_f} = x_f)$ 表示最大值至少为 $a$ 且终点位置为 $x_f$ 的联合事件的概率密度。\n\n为了求出分子，我们使用布朗运动的反射原理。反射原理在达到某一水平线的路径与终点在“反射”位置的路径之间建立了一种对应关系。\n具体来说，对于 $x_f  a$，任何从 $(0, 0)$ 到 $(t_f, x_f)$ 且触及或穿过直线 $y=a$ 的路径，都可以唯一地映射到一条从 $(0, 0)$ 到 $(t_f, 2a - x_f)$ 的路径。这个映射是通过反射路径在首次到达水平线 $a$ 之后的部分来构造的。反之，任何从 $(0, 0)$ 到 $(t_f, 2a - x_f)$ 的路径都必须穿过水平线 $a$（因为 $a > 0$ 且 $2a-x_f > a$），而将其首次到达 $a$ 之后的部分进行反射，会得到一条从 $(0,0)$ 到 $(t_f, x_f)$ 且已经触及水平线 $a$ 的唯一路径。\n\n这种一一对应关系意味着两种事件的路径“数量”以及它们的概率密度是相同的。因此，联合事件 $\\{M_{t_f} \\ge a, B_{t_f} = x_f\\}$ 的密度等于事件 $\\{B_{t_f} = 2a - x_f\\}$ 的密度。\n$$ f_{\\text{joint}}(M_{t_f} \\ge a, B_{t_f} = x_f) = f_{B_{t_f}}(2a - x_f) $$\n\n标准布朗运动在时刻 $t$ 的位置 $B_t$ 服从均值为 0、方差为 $t$ 的正态分布。其概率密度函数为：\n$$ f_{B_t}(z) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{z^2}{2t}\\right) $$\n\n现在我们可以计算条件概率：\n$$ P(M_{t_f} \\ge a | B_{t_f} = x_f) = \\frac{f_{B_{t_f}}(2a - x_f)}{f_{B_{t_f}}(x_f)} $$\n代入概率密度函数的表达式：\n$$ P(M_{t_f} \\ge a | B_{t_f} = x_f) = \\frac{\\frac{1}{\\sqrt{2\\pi t_f}} \\exp\\left(-\\frac{(2a - x_f)^2}{2t_f}\\right)}{\\frac{1}{\\sqrt{2\\pi t_f}} \\exp\\left(-\\frac{x_f^2}{2t_f}\\right)} $$\n项 $\\frac{1}{\\sqrt{2\\pi t_f}}$ 被约掉了。剩下的部分是指数函数之比，可以通过指数相减来简化：\n$$ P(M_{t_f} \\ge a | B_{t_f} = x_f) = \\exp\\left(-\\frac{(2a - x_f)^2}{2t_f} - \\left(-\\frac{x_f^2}{2t_f}\\right)\\right) = \\exp\\left(\\frac{x_f^2 - (2a - x_f)^2}{2t_f}\\right) $$\n我们来简化指数的分子部分：\n$$ x_f^2 - (2a - x_f)^2 = x_f^2 - (4a^2 - 4ax_f + x_f^2) = x_f^2 - 4a^2 + 4ax_f - x_f^2 = 4ax_f - 4a^2 $$\n我们可以提出因子 $-4a$：\n$$ 4ax_f - 4a^2 = -4a(a - x_f) $$\n将此结果代回指数函数：\n$$ P(M_{t_f} \\ge a | B_{t_f} = x_f) = \\exp\\left(\\frac{-4a(a - x_f)}{2t_f}\\right) = \\exp\\left(-\\frac{2a(a - x_f)}{t_f}\\right) $$\n这就是所求概率的最终表达式。", "answer": "$$\\boxed{\\exp\\left(-\\frac{2a(a-x_f)}{t_f}\\right)}$$", "id": "1344197"}]}