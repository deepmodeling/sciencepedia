{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是动手实践。让我们从一个基础练习开始，将伊藤引理应用于一个标准维纳过程的函数。这个练习 [@problem_id:1312702] 将揭示一个反直觉但至关重要的结果：即使是一个没有漂移的纯随机过程，经过非线性变换后也会产生一个确定的漂移项，这正是伊藤引理的核心所在。", "problem": "令 $W_t$ 为一个标准一维维纳过程，代表一个随机波动的量。这样一个过程的动态特性由一个简单的随机微分方程 (SDE) 描述：$dW_t = 0 \\cdot dt + 1 \\cdot dW_t$。\n\n考虑一个点 $P_t$ 在二维笛卡尔平面上移动，其坐标为 $(1, W_t)$。设一个新的随机过程 $Y_t$ 定义为从原点到点 $P_t$ 的向量与 x 轴正半轴所成的角度（以弧度为单位）。$Y_t$ 的演化可以用以下一般形式的 SDE 来描述：\n$$dY_t = \\mu(t, W_t) dt + \\sigma(t, W_t) dW_t$$\n确定过程 $Y_t$ 的漂移系数 $\\mu(t, W_t)$ 和扩散系数 $\\sigma(t, W_t)$。将你的两个结果以行向量 $(\\mu, \\sigma)$ 的形式表示。", "solution": "问题要求解随机过程 $Y_t$ 的漂移系数和扩散系数，该过程定义为到点 $(1, W_t)$ 的向量与 x 轴正半轴所成的角度。这个角度可以表示为 $W_t$ 的函数。在由原点、$(1, 0)$ 和 $(1, W_t)$ 构成的直角三角形中，利用三角学，角度 $Y_t$ 由下式给出：\n$$Y_t = \\arctan\\left(\\frac{W_t}{1}\\right) = \\arctan(W_t)$$\n因此我们有一个过程 $Y_t = f(W_t)$，其中 $f(x) = \\arctan(x)$。为了找到 $Y_t$ 的 SDE，我们使用伊藤引理。对于一个由 $dX_t = a(t, X_t) dt + b(t, X_t) dW_t$ 定义的一般过程 $X_t$，以及一个二阶可微函数 $f(t,x)$，过程 $f(t,X_t)$ 服从以下 SDE：\n$$df(t,X_t) = \\left( \\frac{\\partial f}{\\partial t} + a \\frac{\\partial f}{\\partial x} + \\frac{1}{2} b^2 \\frac{\\partial^2 f}{\\partial x^2} \\right) dt + b \\frac{\\partial f}{\\partial x} dW_t$$\n在我们的具体情况中，过程是 $W_t$，所以 $X_t = W_t$。从其 SDE $dW_t = 0 \\cdot dt + 1 \\cdot dW_t$ 可知，我们有系数 $a=0$ 和 $b=1$。函数 $f(x) = \\arctan(x)$ 没有显式的时间依赖性，所以 $f(t,x)=f(x)$ 且 $\\frac{\\partial f}{\\partial t} = 0$。\n\n将这些代入一般的伊藤公式，我们得到：\n$$dY_t = d(\\arctan(W_t)) = \\left( 0 + 0 \\cdot f'(W_t) + \\frac{1}{2} \\cdot 1^2 \\cdot f''(W_t) \\right) dt + 1 \\cdot f'(W_t) dW_t$$\n$$dY_t = \\frac{1}{2} f''(W_t) dt + f'(W_t) dW_t$$\n将此与一般形式 $dY_t = \\mu(t, W_t) dt + \\sigma(t, W_t) dW_t$ 进行比较，我们可以确定漂移和扩散系数：\n$$\\mu(t, W_t) = \\frac{1}{2} f''(W_t)$$\n$$\\sigma(t, W_t) = f'(W_t)$$\n现在，我们需要计算 $f(x) = \\arctan(x)$ 的一阶和二阶导数。\n\n一阶导数是：\n$$f'(x) = \\frac{d}{dx}(\\arctan(x)) = \\frac{1}{1+x^2}$$\n二阶导数是 $f'(x)$ 的导数：\n$$f''(x) = \\frac{d}{dx}\\left(\\frac{1}{1+x^2}\\right) = \\frac{d}{dx}\\left((1+x^2)^{-1}\\right)$$\n使用链式法则：\n$$f''(x) = -1 \\cdot (1+x^2)^{-2} \\cdot \\frac{d}{dx}(1+x^2) = -(1+x^2)^{-2} \\cdot (2x) = -\\frac{2x}{(1+x^2)^2}$$\n现在我们将 $x=W_t$ 代入这些导数中以求得系数。\n\n漂移系数 $\\mu(t, W_t)$ 是：\n$$\\mu(t, W_t) = \\frac{1}{2} f''(W_t) = \\frac{1}{2} \\left(-\\frac{2W_t}{(1+W_t^2)^2}\\right) = -\\frac{W_t}{(1+W_t^2)^2}$$\n扩散系数 $\\sigma(t, W_t)$ 是：\n$$\\sigma(t, W_t) = f'(W_t) = \\frac{1}{1+W_t^2}$$\n因此，漂移系数和扩散系数分别为 $-\\frac{W_t}{(1+W_t^2)^2}$ 和 $\\frac{1}{1+W_t^2}$。", "answer": "$$\\boxed{\\begin{pmatrix} -\\frac{W_t}{(1+W_t^2)^2}  \\frac{1}{1+W_t^2} \\end{pmatrix}}$$", "id": "1312702"}, {"introduction": "接下来，我们将伊藤引理应用于一个在金融领域无处不在的模型：几何布朗运动（GBM），它常被用来模拟股票价格。这个练习 [@problem_id:1312731] 要求我们推导股价平方根过程的动态，这种变换是构建更复杂模型（如利率模型或波动率模型）的基础。通过这个例子，你将学到如何处理一个本身就包含漂移项和扩散项的随机过程的函数。", "problem": "在量化金融中，一只不支付股息的股票的价格（记为 $S_t$）通常用几何布朗运动（Geometric Brownian Motion, GBM）来建模。该模型由以下随机微分方程（Stochastic Differential Equation, SDE）描述：\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n此处，$\\mu$ 表示恒定的预期收益率（漂移），$\\sigma$ 是恒定的波动率，而 $W_t$ 是一个标准维纳过程（或标准布朗运动）。\n\n考虑一个新的随机过程 $Y_t$，其定义为股票价格的平方根，即 $Y_t = \\sqrt{S_t}$。控制 $Y_t$ 的随机微分方程可以表示为以下一般形式：\n$$dY_t = \\alpha(Y_t) dt + \\beta(Y_t) dW_t$$\n其中 $\\alpha(Y_t)$ 是过程 $Y_t$ 的漂移系数，$\\beta(Y_t)$ 是其扩散系数。\n\n请确定 $\\alpha(Y_t)$ 和 $\\beta(Y_t)$ 的显式表达式，用 $Y_t$、$\\mu$ 和 $\\sigma$ 来表示。请按顺序以一对表达式的形式给出 $\\alpha(Y_t)$ 和 $\\beta(Y_t)$ 的答案。", "solution": "我们对变换 $Y_t=f(S_t)$（其中 $f(s)=s^{1/2}$）应用伊藤引理（Itô's lemma）。伊藤引理表明：\n$$\ndY_t=f'(S_t)\\,dS_t+\\frac{1}{2}f''(S_t)\\,(dS_t)^{2},\n$$\n其中 $(dW_t)^{2}=dt$，$dt\\,dW_t=0$ 且 $(dt)^{2}=0$。对于 $f(s)=s^{1/2}$，我们有：\n$$\nf'(s)=\\frac{1}{2}s^{-1/2},\\qquad f''(s)=-\\frac{1}{4}s^{-3/2}.\n$$\n已知 $dS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t$，我们有：\n$$\n(dS_t)^{2}=(\\sigma S_t\\,dW_t)^{2}=\\sigma^{2}S_t^{2}\\,dt.\n$$\n代入伊藤公式，\n$$\ndY_t=\\frac{1}{2}S_t^{-1/2}\\left(\\mu S_t\\,dt+\\sigma S_t\\,dW_t\\right)+\\frac{1}{2}\\left(-\\frac{1}{4}S_t^{-3/2}\\right)\\left(\\sigma^{2}S_t^{2}\\,dt\\right).\n$$\n使用 $Y_t=S_t^{1/2}$（因此 $S_t=Y_t^{2}$）来简化每一项：\n$$\n\\frac{1}{2}S_t^{-1/2}\\mu S_t\\,dt=\\frac{\\mu}{2}Y_t\\,dt,\\qquad\n\\frac{1}{2}S_t^{-1/2}\\sigma S_t\\,dW_t=\\frac{\\sigma}{2}Y_t\\,dW_t,\n$$\n以及\n$$\n\\frac{1}{2}\\left(-\\frac{1}{4}S_t^{-3/2}\\right)\\sigma^{2}S_t^{2}\\,dt=-\\frac{1}{8}\\sigma^{2}Y_t\\,dt.\n$$\n因此，\n$$\ndY_t=\\left(\\frac{\\mu}{2}-\\frac{\\sigma^{2}}{8}\\right)Y_t\\,dt+\\frac{\\sigma}{2}Y_t\\,dW_t.\n$$\n识别系数可得：\n$$\n\\alpha(Y_t)=\\left(\\frac{\\mu}{2}-\\frac{\\sigma^{2}}{8}\\right)Y_t,\\qquad \\beta(Y_t)=\\frac{\\sigma}{2}Y_t.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\left(\\frac{\\mu}{2}-\\frac{\\sigma^{2}}{8}\\right)Y_{t}  \\frac{\\sigma}{2}Y_{t}\\end{pmatrix}}$$", "id": "1312731"}, {"introduction": "最后，让我们挑战一个更具综合性的问题，它展示了伊藤引理在金融工程中的构造性作用。鞅过程（martingale）在数学上代表一种“公平的博弈”，其漂移项为零，在衍生品定价中至关重要。这个练习 [@problem_id:1312679] 不再是简单地计算一个新过程的随机微分方程（SDE），而是要求我们反向设计一个过程，通过精心选择其系数，使其成为一个鞅，从而深入理解如何运用伊藤引理来达成特定的建模目标。", "problem": "一个 Ornstein-Uhlenbeck (OU) 过程 $X_t$ 是随机微分方程 (SDE) 的解\n$$ dX_t = \\theta(\\mu - X_t)dt + \\sigma dW_t, \\quad X_0=x_0 $$\n其中 $W_t$ 是一个标准维纳过程，$\\theta, \\mu, \\sigma$ 是正常数，分别代表均值回归速率、长期均值和波动率。\n\n考虑一个新过程 $Y_t$，它被定义为 $X_t$ 的一个二次多项式，其系数随时间变化：\n$$ Y_t = A(t)X_t^2 + B(t)X_t + C(t) $$\n如果一个过程（相对于 $W_t$ 的自然滤子）其主导 SDE 中的漂移项恒等于零，则该过程被认为是鞅。\n\n确定系数 $A(t)$, $B(t)$ 和 $C(t)$ 的具体函数形式，使得过程 $Y_t$ 成为一个鞅，并满足初始条件 $Y_0 = X_0^2$。你的最终答案应为 $A(t)$, $B(t)$ 和 $C(t)$ 的一组三个表达式，按此顺序排列。", "solution": "为了找到使 $Y_t$ 成为鞅的系数 $A(t)$, $B(t)$ 和 $C(t)$，我们必须首先求出 $Y_t$ 的随机微分方程（SDE），然后将其漂移项设为零。\n\n设函数为 $f(t, x) = A(t)x^2 + B(t)x + C(t)$。该过程为 $Y_t = f(t, X_t)$。我们应用 Itô 引理来求微分 $dY_t$：\n$$ dY_t = \\frac{\\partial f}{\\partial t} dt + \\frac{\\partial f}{\\partial x} dX_t + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2} (dX_t)^2 $$\n首先，我们计算 $f(t, x)$ 所需的偏导数：\n$$ \\frac{\\partial f}{\\partial t} = A'(t)x^2 + B'(t)x + C'(t) $$\n$$ \\frac{\\partial f}{\\partial x} = 2A(t)x + B(t) $$\n$$ \\frac{\\partial^2 f}{\\partial x^2} = 2A(t) $$\nOrnstein-Uhlenbeck 过程 $X_t$ 的 SDE 给出为 $dX_t = \\theta(\\mu - X_t)dt + \\sigma dW_t$。二次变分项 $(dX_t)^2$ 使用 Itô 微积分的规则（$dt^2 = 0$, $dW_t dt = 0$, $dW_t^2 = dt$）求得：\n$$ (dX_t)^2 = (\\theta(\\mu - X_t)dt + \\sigma dW_t)^2 = \\sigma^2 (dW_t)^2 = \\sigma^2 dt $$\n现在，我们将这些代入 Itô 引理，并将 $x$ 替换为 $X_t$：\n$$ dY_t = \\left( A'(t)X_t^2 + B'(t)X_t + C'(t) \\right) dt + \\left( 2A(t)X_t + B(t) \\right) dX_t + \\frac{1}{2} (2A(t)) (\\sigma^2 dt) $$\n代入 $dX_t$ 的表达式：\n$$ dY_t = \\left( A'(t)X_t^2 + B'(t)X_t + C'(t) + \\sigma^2 A(t) \\right) dt + \\left( 2A(t)X_t + B(t) \\right) (\\theta(\\mu - X_t)dt + \\sigma dW_t) $$\n我们分离 $dt$（漂移）和 $dW_t$（扩散）项：\n$$ dY_t = \\left[ A'(t)X_t^2 + B'(t)X_t + C'(t) + \\sigma^2 A(t) + \\theta(\\mu - X_t)(2A(t)X_t + B(t)) \\right] dt + \\sigma(2A(t)X_t + B(t)) dW_t $$\n为使 $Y_t$ 成为一个鞅，其漂移项（$dt$ 的系数）必须对所有 $t \\geq 0$ 和所有 $X_t$ 的值都为零。让我们展开漂移项：\n$$ \\text{Drift} = A'(t)X_t^2 + B'(t)X_t + C'(t) + \\sigma^2 A(t) + 2\\theta\\mu A(t)X_t - 2\\theta A(t)X_t^2 + \\theta\\mu B(t) - \\theta B(t)X_t $$\n按 $X_t$ 的幂次对各项进行分组：\n$$ \\text{Drift} = (A'(t) - 2\\theta A(t))X_t^2 + (B'(t) + 2\\theta\\mu A(t) - \\theta B(t))X_t + (C'(t) + \\sigma^2 A(t) + \\theta\\mu B(t)) $$\n为了使这个关于 $X_t$ 的多项式对所有 $X_t$ 都为零，它的每个系数都必须为零。这给了我们一个常微分方程组（ODEs）：\n1.  $A'(t) - 2\\theta A(t) = 0$\n2.  $B'(t) - \\theta B(t) + 2\\theta\\mu A(t) = 0$\n3.  $C'(t) + \\theta\\mu B(t) + \\sigma^2 A(t) = 0$\n\n我们还需要 $A(t)$, $B(t)$ 和 $C(t)$ 的初始条件。条件 $Y_0 = X_0^2$ 意味着 $A(0)X_0^2 + B(0)X_0 + C(0) = X_0^2$。为了使此式对任何初始值 $X_0=x_0$ 都成立，我们必须有：\n$$ A(0) = 1, \\quad B(0) = 0, \\quad C(0) = 0 $$\n现在我们依次求解这些常微分方程。\n\n1.  求解 $A(t)$：\n    $A'(t) = 2\\theta A(t)$ 是一个可分离的常微分方程。\n    $\\frac{dA}{A} = 2\\theta dt \\implies \\ln A(t) = 2\\theta t + K_A \\implies A(t) = C_A \\exp(2\\theta t)$。\n    使用 $A(0)=1$，我们得到 $1 = C_A \\exp(0)$，所以 $C_A = 1$。\n    $$ A(t) = \\exp(2\\theta t) $$\n\n2.  求解 $B(t)$：\n    将 $A(t)$ 代入第二个常微分方程：$B'(t) - \\theta B(t) = -2\\theta\\mu A(t) = -2\\theta\\mu \\exp(2\\theta t)$。\n    这是一个一阶线性常微分方程。积分因子是 $I(t) = \\exp(\\int -\\theta dt) = \\exp(-\\theta t)$。\n    乘以 $I(t)$：$(\\exp(-\\theta t) B(t))' = -2\\theta\\mu \\exp(2\\theta t) \\exp(-\\theta t) = -2\\theta\\mu \\exp(\\theta t)$。\n    两边对 $t$ 积分：$\\exp(-\\theta t) B(t) = \\int -2\\theta\\mu \\exp(\\theta t) dt = -2\\mu \\exp(\\theta t) + C_B$。\n    因此，$B(t) = -2\\mu \\exp(2\\theta t) + C_B \\exp(\\theta t)$。\n    使用 $B(0)=0$：$0 = -2\\mu \\exp(0) + C_B \\exp(0) \\implies 0 = -2\\mu + C_B \\implies C_B = 2\\mu$。\n    $$ B(t) = -2\\mu \\exp(2\\theta t) + 2\\mu \\exp(\\theta t) = 2\\mu(\\exp(\\theta t) - \\exp(2\\theta t)) $$\n\n3.  求解 $C(t)$：\n    将 $A(t)$ 和 $B(t)$ 代入第三个常微分方程：$C'(t) = -\\theta\\mu B(t) - \\sigma^2 A(t)$。\n    $C'(t) = -\\theta\\mu [2\\mu(\\exp(\\theta t) - \\exp(2\\theta t))] - \\sigma^2 \\exp(2\\theta t)$\n    $C'(t) = -2\\theta\\mu^2 \\exp(\\theta t) + 2\\theta\\mu^2 \\exp(2\\theta t) - \\sigma^2 \\exp(2\\theta t)$\n    $C'(t) = -2\\theta\\mu^2 \\exp(\\theta t) + (2\\theta\\mu^2 - \\sigma^2)\\exp(2\\theta t)$\n    对 $t$ 积分：\n    $C(t) = \\int \\left(-2\\theta\\mu^2 \\exp(\\theta t) + (2\\theta\\mu^2 - \\sigma^2)\\exp(2\\theta t)\\right) dt$\n    $C(t) = -2\\mu^2 \\exp(\\theta t) + \\frac{2\\theta\\mu^2 - \\sigma^2}{2\\theta} \\exp(2\\theta t) + C_C$\n    $C(t) = -2\\mu^2 \\exp(\\theta t) + (\\mu^2 - \\frac{\\sigma^2}{2\\theta}) \\exp(2\\theta t) + C_C$\n    使用 $C(0)=0$：$0 = -2\\mu^2 + (\\mu^2 - \\frac{\\sigma^2}{2\\theta}) + C_C \\implies C_C = 2\\mu^2 - \\mu^2 + \\frac{\\sigma^2}{2\\theta} = \\mu^2 + \\frac{\\sigma^2}{2\\theta}$。\n    所以，$C(t) = -2\\mu^2 \\exp(\\theta t) + (\\mu^2 - \\frac{\\sigma^2}{2\\theta}) \\exp(2\\theta t) + \\mu^2 + \\frac{\\sigma^2}{2\\theta}$。\n    我们可以重新整理这个表达式：\n    $C(t) = \\mu^2(1 - 2\\exp(\\theta t) + \\exp(2\\theta t)) - \\frac{\\sigma^2}{2\\theta}(\\exp(2\\theta t) - 1)$\n    注意到 $1 - 2\\exp(\\theta t) + \\exp(2\\theta t) = (1-\\exp(\\theta t))^2$, 我们得到：\n    $$ C(t) = \\mu^2(1-\\exp(\\theta t))^2 + \\frac{\\sigma^2}{2\\theta}(1-\\exp(2\\theta t)) $$\n\n所求的系数为：\n$A(t) = \\exp(2\\theta t)$\n$B(t) = 2\\mu(\\exp(\\theta t) - \\exp(2\\theta t))$\n$C(t) = \\mu^2(1-\\exp(\\theta t))^2 + \\frac{\\sigma^2}{2\\theta}(1-\\exp(2\\theta t))$", "answer": "$$ \\boxed{ \\begin{pmatrix} \\exp(2\\theta t)  2\\mu(\\exp(\\theta t) - \\exp(2\\theta t))  \\mu^2(1-\\exp(\\theta t))^2 + \\frac{\\sigma^2}{2\\theta}(1-\\exp(2\\theta t)) \\end{pmatrix} } $$", "id": "1312679"}]}