{"hands_on_practices": [{"introduction": "几何布朗运动的两个核心参数——漂移率 $\\mu$ 和波动率 $\\sigma$——直接决定了资产价格的长期行为和风险水平。这个练习将帮助你掌握一项基本技能：如何从可观测的统计量（如期望值和方差）反推出这些关键的模型参数。通过这个过程，你将更深刻地理解 $\\mu$ 和 $\\sigma$ 的实际意义。 [@problem_id:1304943]", "problem": "一支不派发股息的股票的价格演变由一个连续时间随机过程——几何布朗运动（GBM）——来建模。股票价格 $S_t$ 由以下随机微分方程描述：\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n其中 $t$ 是以年为单位的时间，$\\mu$ 是恒定的年化漂移系数，$\\sigma$ 是恒定的年化波动率系数，而 $W_t$ 是一个标准维纳过程。\n\n假设股票的初始价格为 $S_0 = 100$。经过 $t=2$ 年后，观测到该股票价格的期望值为 $E[S_2] = 110$，其方差为 $Var(S_2) = 484$。\n\n根据这些信息，确定年化漂移系数 $\\mu$ 和年化波动率系数 $\\sigma$ 的精确解析表达式。", "solution": "该问题要求我们在给定几何布朗运动（GBM）过程的初始值、以及未来某个时间的期望值和方差的情况下，求出其参数 $\\mu$ 和 $\\sigma$。\n\nGBM 的随机微分方程（SDE）为 $dS_t = \\mu S_t dt + \\sigma S_t dW_t$。\n该随机微分方程的解由下式给出：\n$$S_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)$$\n其中 $W_t$ 是一个标准维纳过程，意味着 $W_t$ 服从均值为 0、方差为 $t$ 的正态分布，即 $W_t \\sim N(0, t)$。\n\n设指数部分为一个随机变量 $X_t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t$。\n由于 $W_t \\sim N(0, t)$，随机变量 $X_t$ 也服从正态分布。其均值为：\n$$E[X_t] = E\\left[ \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right] = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma E[W_t] = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t$$\n其方差为：\n$$Var(X_t) = Var\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right) = \\sigma^2 Var(W_t) = \\sigma^2 t$$\n因此，$X_t \\sim N\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t, \\sigma^2 t \\right)$。\n\n股票价格 $S_t = S_0 \\exp(X_t)$ 服从对数正态分布。我们可以利用对数正态分布的性质来求其期望值 $E[S_t]$ 和方差 $Var(S_t)$。对于一个服从正态分布的变量 $Y \\sim N(\\alpha, \\beta^2)$，$\\exp(Y)$ 的期望值为 $E[\\exp(Y)] = \\exp(\\alpha + \\frac{1}{2}\\beta^2)$。\n\n应用此性质来求 $E[S_t]$：\n$E[S_t] = E[S_0 \\exp(X_t)] = S_0 E[\\exp(X_t)]$。\n这里，$\\alpha = E[X_t] = (\\mu - \\frac{1}{2}\\sigma^2)t$ 且 $\\beta^2 = Var(X_t) = \\sigma^2 t$。\n$$E[S_t] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\frac{1}{2}(\\sigma^2 t) \\right) = S_0 \\exp\\left(\\mu t - \\frac{1}{2}\\sigma^2 t + \\frac{1}{2}\\sigma^2 t\\right)$$\n$$E[S_t] = S_0 \\exp(\\mu t)$$\n\n为了求方差，我们首先求其二阶矩 $E[S_t^2]$。\n$E[S_t^2] = E[(S_0 \\exp(X_t))^2] = S_0^2 E[\\exp(2X_t)]$。\n使用性质 $E[\\exp(kY)] = \\exp(k\\alpha + \\frac{1}{2}k^2 \\beta^2)$ 并令 $k=2$：\n$$E[S_t^2] = S_0^2 \\exp\\left( 2\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\frac{1}{2}(2^2)(\\sigma^2 t) \\right) = S_0^2 \\exp\\left( 2\\mu t - \\sigma^2 t + 2\\sigma^2 t \\right)$$\n$$E[S_t^2] = S_0^2 \\exp(2\\mu t + \\sigma^2 t)$$\n方差为 $Var(S_t) = E[S_t^2] - (E[S_t])^2$。\n$$Var(S_t) = S_0^2 \\exp(2\\mu t + \\sigma^2 t) - (S_0 \\exp(\\mu t))^2 = S_0^2 \\exp(2\\mu t + \\sigma^2 t) - S_0^2 \\exp(2\\mu t)$$\n$$Var(S_t) = S_0^2 \\exp(2\\mu t) (\\exp(\\sigma^2 t) - 1)$$\n注意到 $S_0 \\exp(\\mu t) = E[S_t]$，所以我们可以将其写为：\n$$Var(S_t) = (E[S_t])^2 (\\exp(\\sigma^2 t) - 1)$$\n\n现在我们使用给定的数值：$S_0 = 100$，$t=2$，$E[S_2] = 110$ 以及 $Var(S_2) = 484$。\n\n首先，我们使用期望值的公式来解出 $\\mu$：\n$$E[S_2] = S_0 \\exp(2\\mu)$$\n$$110 = 100 \\exp(2\\mu)$$\n$$\\exp(2\\mu) = \\frac{110}{100} = \\frac{11}{10}$$\n对两边取自然对数：\n$$2\\mu = \\ln\\left(\\frac{11}{10}\\right)$$\n$$\\mu = \\frac{1}{2}\\ln\\left(\\frac{11}{10}\\right)$$\n\n接下来，我们使用方差的公式来解出 $\\sigma$：\n$$Var(S_2) = (E[S_2])^2 (\\exp(2\\sigma^2) - 1)$$\n$$484 = (110)^2 (\\exp(2\\sigma^2) - 1)$$\n$$484 = 12100 (\\exp(2\\sigma^2) - 1)$$\n$$\\exp(2\\sigma^2) - 1 = \\frac{484}{12100} = \\frac{4 \\times 121}{100 \\times 121} = \\frac{4}{100} = \\frac{1}{25}$$\n$$\\exp(2\\sigma^2) = 1 + \\frac{1}{25} = \\frac{26}{25}$$\n对两边取自然对数：\n$$2\\sigma^2 = \\ln\\left(\\frac{26}{25}\\right)$$\n$$\\sigma^2 = \\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)$$\n由于波动率 $\\sigma$ 必须为非负数，我们取其正平方根：\n$$\\sigma = \\sqrt{\\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)}$$\n\n参数的精确解析表达式为 $\\mu = \\frac{1}{2}\\ln\\left(\\frac{11}{10}\\right)$ 和 $\\sigma = \\sqrt{\\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}\\ln\\left(\\frac{11}{10}\\right)  \\sqrt{\\frac{1}{2}\\ln\\left(\\frac{26}{25}\\right)} \\end{pmatrix}}$$", "id": "1304943"}, {"introduction": "在掌握了模型参数的意义之后，下一步就是利用模型进行预测。本练习要求你计算在给定漂移率和波动率的情况下，资产价格在未来某一时刻低于其初始值的概率。这项实践不仅是风险评估的基本功，还能让你直观地感受到波动率如何影响资产价格的概率分布，尤其是在对数正态世界中的非对称效应。 [@problem_id:1304937]", "problem": "一位金融分析师使用几何布朗运动 (GBM) 模型来模拟一种波动性大的数字资产的价格 $S_t$。在时间 $t$（以年为单位）的价格由以下公式给出：\n$$S_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)$$\n其中 $S_0$ 是初始价格，$\\mu$ 是恒定的预期年化收益率（漂移），$\\sigma$ 是恒定的年化波动率，$W_t$ 是一个标准维纳过程。对于一个标准维纳过程，在时间 $t$ 的值 $W_t$ 服从均值为 0、方差为 $t$ 的正态分布。\n\n该资产的特征是预期年化收益率为 $\\mu = 0.20$，年化波动率为 $\\sigma = 0.40$。\n\n在 $T = 1.5$ 年后，该资产的价格 $S_T$ 低于其初始价格 $S_0$ 的概率是多少？将此概率计算为小数。将最终答案四舍五入到四位有效数字。", "solution": "我们要求解在时间 $T$ 时资产价格 $S_T$ 低于其初始价格 $S_0$ 的概率，即 $P(S_T  S_0)$。\n\n根据几何布朗运动 (GBM) 的解，我们有：\n$$S_T = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)T + \\sigma W_T \\right)$$\n其中 $W_T$ 是一个服从均值为 0、方差为 $T$ 的正态分布的随机变量，即 $W_T \\sim \\mathcal{N}(0, T)$。\n\n不等式 $S_T  S_0$ 可以写成：\n$$S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)T + \\sigma W_T \\right)  S_0$$\n由于 $S_0 > 0$，我们可以将两边同除以 $S_0$：\n$$\\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)T + \\sigma W_T \\right)  1$$\n对不等式两边取自然对数：\n$$\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)T + \\sigma W_T  0$$\n现在，我们整理这个关于 $W_T$ 的不等式：\n$$\\sigma W_T  -\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)T$$\n为了计算概率，我们将随机变量 $W_T$ 标准化。令 $Z = \\frac{W_T}{\\sqrt{T}}$，其中 $Z$ 是一个标准正态随机变量，即 $Z \\sim \\mathcal{N}(0, 1)$。因此，$W_T = Z\\sqrt{T}$。代入不等式中：\n$$\\sigma Z\\sqrt{T}  -\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)T$$\n由于 $\\sigma > 0$ 且 $T > 0$，我们可以将两边同除以 $\\sigma\\sqrt{T}$ 而不改变不等号的方向：\n$$Z  -\\frac{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)T}{\\sigma\\sqrt{T}} = -\\frac{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)\\sqrt{T}}{\\sigma}$$\n我们所求的概率就是标准正态变量 $Z$ 小于这个值的概率，可以用标准正态累积分布函数 $\\Phi(\\cdot)$ 表示：\n$$P(S_T  S_0) = \\Phi\\left(-\\frac{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)\\sqrt{T}}{\\sigma}\\right)$$\n现在，代入给定的数值：$\\mu = 0.20$，$\\sigma = 0.40$，$T = 1.5$ 年。\n首先计算指数部分：\n$$\\mu - \\frac{1}{2}\\sigma^2 = 0.20 - \\frac{1}{2}(0.40)^2 = 0.20 - \\frac{1}{2}(0.16) = 0.20 - 0.08 = 0.12$$\n然后计算 $\\Phi$ 函数的参数：\n$$-\\frac{(0.12)\\sqrt{1.5}}{0.40} = -0.3 \\times \\sqrt{1.5} \\approx -0.3 \\times 1.22474 \\approx -0.36742$$\n所以，我们需要计算 $P(Z  -0.36742) = \\Phi(-0.36742)$。\n使用标准正态分布表或计算器，我们可以得到：\n$$\\Phi(-0.36742) \\approx 0.35665$$\n根据题目要求，将答案四舍五入到四位有效数字，我们得到 $0.3567$。\n\n因此，在 $T=1.5$ 年后，该资产价格低于其初始价格的概率约为 0.3567。", "answer": "$$\\boxed{0.3567}$$", "id": "1304937"}, {"introduction": "理论模型与现实世界的桥梁在于数据。在实际应用中，我们无法预知确切的漂移率 $\\mu$ 和波动率 $\\sigma$，而必须从历史价格数据中估计它们。这个练习将指导你使用一种强大而通用的统计方法——最大似然估计（Maximum Likelihood Estimation, MLE），从离散的观测价格中推导出 $\\mu$ 和 $\\sigma$ 的估计量，这是任何量化分析师必备的核心技能。 [@problem_id:1304938]", "problem": "一位量化分析师正在对股票价格进行建模，该价格在时间 $t$ 表示为 $S_t$。该分析师假设股价遵循几何布朗运动（GBM），其由以下随机微分方程描述：\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n其中 $\\mu$ 是恒定的漂移率，$\\sigma$ 是恒定的波动率，$W_t$ 是一个标准的维纳过程。\n\n该分析师收集了一系列 $n+1$ 个价格观测值 $S_0, S_1, \\ldots, S_n$，这些观测值是在离散的、等间隔的时间区间 $\\Delta t$ 记录的。因此，观测值 $S_i$ 对应于时间 $t_i = i\\Delta t$ 时的价格。\n\nGBM模型的一个关键特性是，在这些区间上的对数回报是独立同分布的。具体来说，如果我们将对数回报定义为 $X_i = \\ln(S_i / S_{i-1})$（对于 $i = 1, 2, \\ldots, n$），那么每个 $X_i$ 都是一个从正态分布中抽取的随机变量，其均值为 $\\nu = (\\mu - \\frac{1}{2}\\sigma^2)\\Delta t$，方差为 $\\tau^2 = \\sigma^2 \\Delta t$。\n\n你的任务是推导漂移率 $\\mu$ 和波动率 $\\sigma$ 的最大似然估计量（MLE），记作 $\\hat{\\mu}$ 和 $\\hat{\\sigma}$。用观测到的价格 $S_0, S_1, \\ldots, S_n$、对数回报的总数 $n$ 以及时间步长 $\\Delta t$ 来表示这些估计量。将你的最终答案表示为一个行矩阵，其中包含按顺序排列的估计量 $(\\hat{\\mu}, \\hat{\\sigma})$。", "solution": "在GBM模型下，定义对数回报 $X_{i}=\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)$，其中 $i=1,\\ldots,n$。那么 $X_{1},\\ldots,X_{n}$ 是独立同分布的正态随机变量，其均值为 $\\nu=(\\mu-\\frac{1}{2}\\sigma^{2})\\Delta t$，方差为 $\\tau^{2}=\\sigma^{2}\\Delta t$。\n\n给定 $x_{1},\\ldots,x_{n}$，$(\\nu,\\tau^{2})$ 的似然函数为\n$$\nL(\\nu,\\tau^{2})=\\prod_{i=1}^{n}\\frac{1}{\\sqrt{2\\pi\\tau^{2}}}\\exp\\!\\left(-\\frac{(x_{i}-\\nu)^{2}}{2\\tau^{2}}\\right).\n$$\n对数似然函数为\n$$\n\\ell(\\nu,\\tau^{2})=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln(\\tau^{2})-\\frac{1}{2\\tau^{2}}\\sum_{i=1}^{n}(x_{i}-\\nu)^{2}.\n$$\n对 $\\nu$ 求导并令其等于零：\n$$\n\\frac{\\partial \\ell}{\\partial \\nu}=\\frac{1}{\\tau^{2}}\\sum_{i=1}^{n}(x_{i}-\\nu)=0\n\\;\\;\\Longrightarrow\\;\\; \\hat{\\nu}=\\bar{X},\\quad \\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n对 $\\tau^{2}$ 求导并令其等于零：\n$$\n\\frac{\\partial \\ell}{\\partial \\tau^{2}}=-\\frac{n}{2}\\frac{1}{\\tau^{2}}+\\frac{1}{2}\\frac{1}{(\\tau^{2})^{2}}\\sum_{i=1}^{n}(x_{i}-\\nu)^{2}=0\n\\;\\;\\Longrightarrow\\;\\; \\hat{\\tau}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(x_{i}-\\hat{\\nu})^{2}.\n$$\n使用参数关系 $\\nu=(\\mu-\\frac{1}{2}\\sigma^{2})\\Delta t$ 和 $\\tau^{2}=\\sigma^{2}\\Delta t$，通过代入法得到 $(\\mu,\\sigma)$ 的最大似然估计量：\n$$\n\\hat{\\sigma}^{2}=\\frac{\\hat{\\tau}^{2}}{\\Delta t}=\\frac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2},\n\\quad\n\\hat{\\mu}=\\frac{\\hat{\\nu}}{\\Delta t}+\\frac{1}{2}\\hat{\\sigma}^{2}=\\frac{\\bar{X}}{\\Delta t}+\\frac{1}{2}\\hat{\\sigma}^{2},\n$$\n其中 $\\hat{\\sigma}$ 取正平方根。用价格显式地写出，\n$$\n\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right),\\quad\n\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}=\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)-\\frac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\frac{S_{j}}{S_{j-1}}\\right)\\right)^{2}.\n$$\n因此，\n$$\n\\hat{\\mu}=\\frac{1}{\\Delta t}\\left(\\frac{1}{n}\\sum_{i=1}^{n}\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)\\right)+\\frac{1}{2}\\left(\\frac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)-\\frac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\frac{S_{j}}{S_{j-1}}\\right)\\right)^{2}\\right),\n$$\n$$\n\\hat{\\sigma}=\\sqrt{\\frac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\frac{S_{i}}{S_{i-1}}\\right)-\\frac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\frac{S_{j}}{S_{j-1}}\\right)\\right)^{2}}.\n$$\n等价地，使用伸缩恒等式 $\\sum_{i=1}^{n}\\ln(S_{i}/S_{i-1})=\\ln(S_{n}/S_{0})$，可以将 $\\hat{\\mu}$ 写为 $\\hat{\\mu}=\\frac{1}{n\\Delta t}\\ln(S_{n}/S_{0})+\\frac{1}{2}\\hat{\\sigma}^{2}$，其中 $\\hat{\\sigma}$ 与上面相同。", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{1}{\\Delta t}\\left(\\dfrac{1}{n}\\sum_{i=1}^{n}\\ln\\!\\left(\\dfrac{S_{i}}{S_{i-1}}\\right)\\right)+\\dfrac{1}{2}\\left(\\dfrac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\dfrac{S_{i}}{S_{i-1}}\\right)-\\dfrac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\dfrac{S_{j}}{S_{j-1}}\\right)\\right)^{2}\\right)  \\sqrt{\\dfrac{1}{n\\Delta t}\\sum_{i=1}^{n}\\left(\\ln\\!\\left(\\dfrac{S_{i}}{S_{i-1}}\\right)-\\dfrac{1}{n}\\sum_{j=1}^{n}\\ln\\!\\left(\\dfrac{S_{j}}{S_{j-1}}\\right)\\right)^{2}}\\end{pmatrix}}$$", "id": "1304938"}]}