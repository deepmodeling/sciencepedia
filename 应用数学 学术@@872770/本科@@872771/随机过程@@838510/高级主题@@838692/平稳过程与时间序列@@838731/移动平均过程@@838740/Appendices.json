{"hands_on_practices": [{"introduction": "要真正理解一个时间序列模型，我们首先要从其基本统计特性入手。第一个练习将聚焦于计算一个简单的一阶移动平均（MA(1)）过程的方差，这是衡量其波动性的核心指标。通过这个练习，你将巩固对移动平均过程如何由白噪声构建的理解，并掌握其基本性质的计算方法 [@problem_id:1320203]。", "problem": "在时间序列数据分析中，一个基本模型是移动平均（MA）过程。考虑一种特定的一阶MA过程，称为MA(1)过程，它通常用于对经过简单滤波器处理后的信号进行建模。\n\n令随机变量序列 $\\{\\varepsilon_t\\}$ 表示一个白噪声过程。这意味着对于任何整数时间索引 $t$，该随机变量的均值为零（$E[\\varepsilon_t] = 0$）且方差为常数 $\\text{Var}(\\varepsilon_t) = \\sigma^2$。此外，这些随机变量在时间上是不相关的，意味着任意两个不同元素之间的协方差为零（$\\text{Cov}(\\varepsilon_t, \\varepsilon_s) = 0$ for $t \\neq s$）。\n\n通过对白噪声过程应用一阶差分滤波器，生成了一个新的时间序列 $\\{X_t\\}$。由此得到的过程由以下方程定义：\n$$X_t = \\varepsilon_t - \\varepsilon_{t-1}$$\n已知白噪声过程的方差为 $\\sigma^2 = 4$，计算过程 $X_t$ 的方差。", "solution": "我们给定一个白噪声过程 $\\{\\varepsilon_{t}\\}$，其满足 $E[\\varepsilon_{t}] = 0$，$\\text{Var}(\\varepsilon_{t}) = \\sigma^{2}$，以及当 $t \\neq s$ 时 $\\text{Cov}(\\varepsilon_{t}, \\varepsilon_{s}) = 0$。过程 $X_{t}$ 由 $X_{t} = \\varepsilon_{t} - \\varepsilon_{t-1}$ 定义。\n\n首先，利用期望的线性性质计算 $X_{t}$ 的均值：\n$$\nE[X_{t}] = E[\\varepsilon_{t}] - E[\\varepsilon_{t-1}] = 0 - 0 = 0.\n$$\n\n接下来，使用随机变量线性组合的方差公式：\n$$\n\\text{Var}(aY + bZ) = a^{2}\\text{Var}(Y) + b^{2}\\text{Var}(Z) + 2ab\\,\\text{Cov}(Y,Z).\n$$\n令 $a = 1$，$b = -1$，$Y = \\varepsilon_{t}$，$Z = \\varepsilon_{t-1}$，得到\n$$\n\\text{Var}(X_{t}) = \\text{Var}(\\varepsilon_{t} - \\varepsilon_{t-1}) = \\text{Var}(\\varepsilon_{t}) + \\text{Var}(\\varepsilon_{t-1}) - 2\\,\\text{Cov}(\\varepsilon_{t}, \\varepsilon_{t-1}).\n$$\n利用白噪声方差的平稳性以及时间上的不相关性，\n$$\n\\text{Var}(\\varepsilon_{t}) = \\text{Var}(\\varepsilon_{t-1}) = \\sigma^{2}, \\quad \\text{Cov}(\\varepsilon_{t}, \\varepsilon_{t-1}) = 0,\n$$\n所以\n$$\n\\text{Var}(X_{t}) = \\sigma^{2} + \\sigma^{2} - 0 = 2\\sigma^{2}.\n$$\n根据给定的 $\\sigma^{2} = 4$，我们得出结论\n$$\n\\text{Var}(X_{t}) = 2 \\times 4 = 8.\n$$", "answer": "$$\\boxed{8}$$", "id": "1320203"}, {"introduction": "理论模型通常具有已知的阶数，但在现实世界的数据分析中，我们必须从观测数据中识别出这个阶数。这个练习让你扮演数据分析师的角色，运用样本自相关函数（ACF）这一关键诊断工具来推断MA过程的可能阶数 $q$。这项技能是时间序列建模实际应用的基础 [@problem_id:1320202]。", "problem": "一位电气工程师正在分析一种新型传感器所测量信号的噪声分量。该工程师假设，噪声在减去其均值进行中心化处理后，可以由一个平稳的移动平均（MA）过程来描述。为确定此过程的阶数，收集了一个包含 $n=225$ 个观测值的时间序列。根据这些数据计算样本自相关函数（ACF），其在滞后 $k$ 处的值记为 $\\hat{\\rho}(k)$。计算出的前几个值如下：\n\n$\\hat{\\rho}(1) = 0.52$\n$\\hat{\\rho}(2) = -0.31$\n$\\hat{\\rho}(3) = 0.08$\n$\\hat{\\rho}(4) = -0.05$\n\n确定 MA($q$) 过程阶数 $q$ 的一种标准方法是，找到样本自相关系数在此之后不再具有统计显著性的滞后阶。一个常见的经验法则是，若样本自相关系数 $\\hat{\\rho}(k)$ 的绝对值小于 $2/\\sqrt{n}$，则认为其在统计上不显著。基于此信息和统计标准，用于描述传感器噪声的 MA 模型最合适的阶数 $q$ 是多少？\n\nA. $q=0$\n\nB. $q=1$\n\nC. $q=2$\n\nD. $q=3$\n\nE. $q=4$", "solution": "我们使用 MA 模型的识别规则：MA($q$) 过程的理论自相关函数（ACF）对于所有滞后 $kq$ 的情况，其值都精确为零。在有限样本中，如题所设，如果样本自相关系数 $|\\hat{\\rho}(k)|  \\frac{2}{\\sqrt{n}}$，则我们判定其在统计上不显著。\n\n给定 $n=225$，显著性阈值为\n$$\n\\frac{2}{\\sqrt{n}}=\\frac{2}{\\sqrt{225}}=\\frac{2}{15}。\n$$\n我们使用精确的有理数形式将 $|\\hat{\\rho}(k)|$ 与 $\\frac{2}{15}$ 进行比较：\n- 对于 $k=1$：$|\\hat{\\rho}(1)|=0.52=\\frac{52}{100}=\\frac{13}{25}$。将 $\\frac{13}{25}$ 与 $\\frac{2}{15}$ 进行比较：\n$$\n\\frac{13}{25}\\frac{2}{15}\\quad\\text{因为}\\quad 13\\cdot 15=1952\\cdot 25=50.\n$$\n因此，滞后阶 1 是显著的。\n\n- 对于 $k=2$：$|\\hat{\\rho}(2)|=0.31=\\frac{31}{100}$。将 $\\frac{31}{100}$ 与 $\\frac{2}{15}$ 进行比较：\n$$\n\\frac{31}{100}\\frac{2}{15}\\quad\\text{因为}\\quad 31\\cdot 15=4652\\cdot 100=200.\n$$\n因此，滞后阶 2 是显著的。\n\n- 对于 $k=3$：$|\\hat{\\rho}(3)|=0.08=\\frac{8}{100}=\\frac{2}{25}$。将 $\\frac{2}{25}$ 与 $\\frac{2}{15}$ 进行比较：\n$$\n\\frac{2}{25}  \\frac{2}{15}\\quad\\text{因为}\\quad 2\\cdot 15=30  2\\cdot 25=50.\n$$\n因此，滞后阶 3 是不显著的。\n\n- 对于 $k=4$：$|\\hat{\\rho}(4)|=0.05=\\frac{5}{100}=\\frac{1}{20}$。将 $\\frac{1}{20}$ 与 $\\frac{2}{15}$ 进行比较：\n$$\n\\frac{1}{20}  \\frac{2}{15}\\quad\\text{因为}\\quad 1\\cdot 15=15  2\\cdot 20=40.\n$$\n因此，滞后阶 4 是不显著的。\n\n因此，样本 ACF 在滞后阶 1 和 2 处是显著的，而从滞后阶 3 开始变得不显著，这表明在滞后阶 2 之后存在截尾（cutoff）。这种模式是 $q=2$ 的 MA($q$) 过程的典型特征。因此，最合适的阶数是 $q=2$，对应选项 C。", "answer": "$$\\boxed{C}$$", "id": "1320202"}, {"introduction": "在模型识别之后，我们来探讨一个更精妙但至关重要的特性：可逆性。这个问题揭示了，一个给定的自相关结构可能对应着不同的MA模型参数。你将通过此练习理解可逆性为何是选择唯一、有意义模型以进行预测和分析的必要条件 [@problem_id:1320207]。", "problem": "一个单变量时间序列使用一阶移动平均(MA)过程（记为 MA(1)）进行建模。该模型由以下方程给出：\n$$X_t = \\mu + \\epsilon_t + \\theta_1 \\epsilon_{t-1}$$\n其中 $\\mu$ 是过程的常数均值，$\\theta_1$ 是模型的单个实值参数，而 $\\{\\epsilon_t\\}$ 代表一个白噪声过程。白噪声项的均值为零，具有恒定的方差 $\\sigma^2_\\epsilon$，并且在不同时间点上不相关（即，当 $t \\neq s$ 时，$\\text{Cov}(\\epsilon_t, \\epsilon_s)=0$）。\n\n该过程在滞后 $k$ 阶的理论自相关函数 $\\rho(k)$ 定义为 $X_t$ 和 $X_{t-k}$ 之间的相关性。对于所考虑的特定过程，发现滞后1阶的自相关为 $\\rho(1) = 0.4$。\n\n已知参数 $\\theta_1$ 的两个不同实数值可以产生相同的自相关值。MA(1)过程的一个重要性质是可逆性，它要求参数满足条件 $|\\theta_1|  1$。\n\n确定参数 $\\theta_1$ 的两个可能值。令对应于可逆过程的值为 $\\theta_{\\text{inv}}$，对应于不可逆过程的值为 $\\theta_{\\text{non-inv}}$。以有序数对 $(\\theta_{\\text{inv}}, \\theta_{\\text{non-inv}})$ 的形式给出你的答案。", "solution": "为了解决这个问题，我们必须首先推导 MA(1) 过程在滞后1阶的自相关函数(ACF) $\\rho(1)$ 的一般表达式。ACF 定义为滞后 $k$ 阶的自协方差 $\\gamma(k)$ 与过程的方差 $\\gamma(0)$ 之比。\n\n首先，我们计算过程的方差，$\\gamma(0) = \\text{Var}(X_t)$。\n$$ \\gamma(0) = \\text{Var}(\\mu + \\epsilon_t + \\theta_1 \\epsilon_{t-1}) $$\n由于 $\\mu$ 是一个常数，它对方差没有贡献。白噪声项 $\\epsilon_t$ 和 $\\epsilon_{t-1}$ 是不相关的，所以它们的方差相加。\n$$ \\gamma(0) = \\text{Var}(\\epsilon_t) + \\text{Var}(\\theta_1 \\epsilon_{t-1}) = \\text{Var}(\\epsilon_t) + \\theta_1^2 \\text{Var}(\\epsilon_{t-1}) $$\n已知对于所有 $t$，$\\text{Var}(\\epsilon_t) = \\sigma^2_\\epsilon$，我们有：\n$$ \\gamma(0) = \\sigma^2_\\epsilon + \\theta_1^2 \\sigma^2_\\epsilon = \\sigma^2_\\epsilon (1 + \\theta_1^2) $$\n\n接下来，我们计算滞后1阶的自协方差，$\\gamma(1) = \\text{Cov}(X_t, X_{t-1})$。\n$$ \\gamma(1) = \\text{Cov}(\\mu + \\epsilon_t + \\theta_1 \\epsilon_{t-1}, \\mu + \\epsilon_{t-1} + \\theta_1 \\epsilon_{t-2}) $$\n利用协方差的双线性和均值 $\\mu$ 不影响协方差这一事实：\n$$ \\gamma(1) = \\text{Cov}(\\epsilon_t + \\theta_1 \\epsilon_{t-1}, \\epsilon_{t-1} + \\theta_1 \\epsilon_{t-2}) $$\n$$ \\gamma(1) = \\text{Cov}(\\epsilon_t, \\epsilon_{t-1}) + \\text{Cov}(\\epsilon_t, \\theta_1 \\epsilon_{t-2}) + \\text{Cov}(\\theta_1 \\epsilon_{t-1}, \\epsilon_{t-1}) + \\text{Cov}(\\theta_1 \\epsilon_{t-1}, \\theta_1 \\epsilon_{t-2}) $$\n由于白噪声项在不同时间索引上是不相关的，所以唯一的非零项是 $\\text{Cov}(\\theta_1 \\epsilon_{t-1}, \\epsilon_{t-1})$。\n$$ \\gamma(1) = \\theta_1 \\text{Cov}(\\epsilon_{t-1}, \\epsilon_{t-1}) = \\theta_1 \\text{Var}(\\epsilon_{t-1}) = \\theta_1 \\sigma^2_\\epsilon $$\n\n现在我们可以求出滞后1阶的自相关 $\\rho(1)$。\n$$ \\rho(1) = \\frac{\\gamma(1)}{\\gamma(0)} = \\frac{\\theta_1 \\sigma^2_\\epsilon}{\\sigma^2_\\epsilon (1 + \\theta_1^2)} = \\frac{\\theta_1}{1 + \\theta_1^2} $$\n注意，对于滞后 $k  1$ 的所有自协方差 $\\gamma(k)$ 都将为零，因为 $X_t$ 和 $X_{t-k}$ 的表达式中没有共同的白噪声项。\n\n我们已知 $\\rho(1) = 0.4$。我们可以建立一个方程来求解 $\\theta_1$：\n$$ \\frac{\\theta_1}{1 + \\theta_1^2} = 0.4 $$\n我们将 $0.4$ 重写为分数 $\\frac{2}{5}$：\n$$ \\frac{\\theta_1}{1 + \\theta_1^2} = \\frac{2}{5} $$\n交叉相乘得到：\n$$ 5\\theta_1 = 2(1 + \\theta_1^2) $$\n$$ 5\\theta_1 = 2 + 2\\theta_1^2 $$\n将其整理成标准的二次方程形式（$ax^2 + bx + c = 0$）：\n$$ 2\\theta_1^2 - 5\\theta_1 + 2 = 0 $$\n我们可以使用二次公式 $\\theta_1 = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来解这个关于 $\\theta_1$ 的二次方程，其中 $a=2$, $b=-5$, $c=2$。\n$$ \\theta_1 = \\frac{-(-5) \\pm \\sqrt{(-5)^2 - 4(2)(2)}}{2(2)} $$\n$$ \\theta_1 = \\frac{5 \\pm \\sqrt{25 - 16}}{4} $$\n$$ \\theta_1 = \\frac{5 \\pm \\sqrt{9}}{4} $$\n$$ \\theta_1 = \\frac{5 \\pm 3}{4} $$\n这给了我们 $\\theta_1$ 的两个可能解：\n$$ \\theta_{1,1} = \\frac{5 + 3}{4} = \\frac{8}{4} = 2 $$\n$$ \\theta_{1,2} = \\frac{5 - 3}{4} = \\frac{2}{4} = \\frac{1}{2} = 0.5 $$\n\n问题要求我们确定这些值中哪一个对应于可逆过程。MA(1)过程的可逆性条件是 $|\\theta_1|  1$。\n我们来检查这两个值：\n对于 $\\theta_1 = 2$，我们有 $|2| = 2$，不小于1。因此，这个值对应于一个不可逆过程。所以，$\\theta_{\\text{non-inv}} = 2$。\n对于 $\\theta_1 = 0.5$，我们有 $|0.5| = 0.5$，小于1。因此，这个值对应于一个可逆过程。所以，$\\theta_{\\text{inv}} = 0.5$。\n\n问题要求以有序数对 $(\\theta_{\\text{inv}}, \\theta_{\\text{non-inv}})$ 的形式给出答案。\n最终答案是 $(0.5, 2)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.5  2 \\end{pmatrix}}$$", "id": "1320207"}]}