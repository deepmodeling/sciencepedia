{"hands_on_practices": [{"introduction": "蒙特卡洛方法的核心在于使用随机数来模拟概率性结果。本练习将通过一个质量控制的场景，向您展示如何使用均匀分布的随机数来模拟一系列独立的伯努利试验，这是构建更复杂随机过程模拟的基础。通过这个实践，您将掌握利用计算机生成的结果来估计离散事件发生次数的基本技巧。[@problem_id:1332035]", "problem": "一位质量控制工程师正在进行单次测试运行的蒙特卡罗模拟，以模拟电子元件的制造过程。在完整的生产过程中，每个元件有独立的次品概率，$p=0.05$。该模拟对一批元件的检验过程进行建模。\n\n模拟算法工作如下：对于批次中的每个元件 $i$，从区间 $[0, 1)$ 上的均匀分布中抽取一个随机数 $u_i$。如果 $u_i  p$，则该元件被标记为“次品”，否则标记为“非次品”。\n\n对于一个 $N=12$ 个元件的小样本的一次特定测试运行，生成了以下随机数序列：\n$0.341, 0.025, 0.789, 0.991, 0.157, 0.450, 0.048, 0.823, 0.616, 0.009, 0.202, 0.533$\n\n根据这个特定的随机数序列和给定的次品概率，确定在这次模拟运行中识别出的次品元件总数。", "solution": "在这个蒙特卡罗检验模型中，每个元件 $i$ 被标记为次品当且仅当 $u_{i}  p$，其中给定的次品概率为 $p=0.05$。定义指示变量 $X_{i}$ 为\n$$\nX_{i}=\\begin{cases}\n1,   \\text{if } u_{i}  p,\\\\\n0,   \\text{if } u_{i} \\geq p,\n\\end{cases}\n$$\n运行中次品的总数为\n$$\nD=\\sum_{i=1}^{N} X_{i}.\n$$\n当 $N=12$ 且给定序列时，将每个 $u_{i}$ 与 $p=0.05$ 进行比较：\n- 对于 $i=1$：$u_{1}=0.341 \\geq 0.05 \\Rightarrow X_{1}=0$。\n- 对于 $i=2$：$u_{2}=0.025  0.05 \\Rightarrow X_{2}=1$。\n- 对于 $i=3$：$u_{3}=0.789 \\geq 0.05 \\Rightarrow X_{3}=0$。\n- 对于 $i=4$：$u_{4}=0.991 \\geq 0.05 \\Rightarrow X_{4}=0$。\n- 对于 $i=5$：$u_{5}=0.157 \\geq 0.05 \\Rightarrow X_{5}=0$。\n- 对于 $i=6$：$u_{6}=0.450 \\geq 0.05 \\Rightarrow X_{6}=0$。\n- 对于 $i=7$：$u_{7}=0.048  0.05 \\Rightarrow X_{7}=1$。\n- 对于 $i=8$：$u_{8}=0.823 \\geq 0.05 \\Rightarrow X_{8}=0$。\n- 对于 $i=9$：$u_{9}=0.616 \\geq 0.05 \\Rightarrow X_{9}=0$。\n- 对于 $i=10$：$u_{10}=0.009  0.05 \\Rightarrow X_{10}=1$。\n- 对于 $i=11$：$u_{11}=0.202 \\geq 0.05 \\Rightarrow X_{11}=0$。\n- 对于 $i=12$：$u_{12}=0.533 \\geq 0.05 \\Rightarrow X_{12}=0$。\n\n求和可得，$D=X_{2}+X_{7}+X_{10}=1+1+1=3$。", "answer": "$$\\boxed{3}$$", "id": "1332035"}, {"introduction": "布朗运动是模拟金融市场价格波动、微观粒子扩散等现象的关键模型。本次实践不仅指导您如何通过离散时间步进法来模拟标准布朗运动的路径，更重要的是，它引导您通过比较过程的终点位置 $W(T)$ 和其路径上的最大值 $M(T)$ 的统计特性，来经验性地验证著名的反射原理。这个练习将展示模拟如何为随机过程中深刻的理论结果提供直观的理解和验证。[@problem_id:1332040]", "problem": "一个标准的一维布朗运动，记为 $W(t)$，是一个随机过程，从 $W(0) = 0$ 开始，具有独立的、服从正态分布的增量。具体来说，对于任何 $t_2 > t_1 \\ge 0$，增量 $W(t_2) - W(t_1)$ 是一个随机变量，服从均值为 0、方差为 $t_2 - t_1$ 的正态分布。\n\n此过程在区间 $[0, T]$ 上的离散时间路径可以通过将区间划分为 $N$ 个时长为 $\\Delta t = T/N$ 的小步长来模拟。在时间 $t_{i+1} = (i+1)\\Delta t$ 的位置由 $W(t_{i+1}) = W(t_i) + \\sqrt{\\Delta t} Z_i$ 给出，其中 $Z_i$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的独立随机变量。\n\n考虑该过程的运行最大值，定义为 $M(T) = \\max_{0 \\le t \\le T} W(t)$。对于离散模拟，这对应于该过程在从 $t_0=0$ 到 $t_N=T$ 的任何时间步上所达到的最大值。\n\n你需要执行一个数值模拟来研究 $W(T)$ 和 $M(T)$ 的统计特性。在时间区间 $[0, T]$ 上模拟 $K = 500,000$ 条独立的标准布朗运动路径，其中 $T=5.0$，每条路径使用 $N=1000$ 个时间步。\n\n根据你的模拟结果，估计以下两个概率：\n1.  $\\hat{P}_1$：运行最大值大于或等于阈值 $a$ 的经验概率，即 $M(T) \\ge a$。\n2.  $\\hat{P}_2$：最终位置大于或等于同一阈值 $a$ 的经验概率，即 $W(T) \\ge a$。\n\n使用阈值 $a=1.5$，计算比率 $R = \\hat{P}_1 / \\hat{P}_2$。\n\n将你对比率 $R$ 的最终答案四舍五入到三位有效数字。", "solution": "将标准布朗运动的离散时间近似定义为 $S_{0}=0$ 和 $S_{k}=\\sum_{i=1}^{k}X_{i}$（对于 $k=1,\\ldots,N$），其中 $X_{i}\\sim \\mathcal{N}(0,\\Delta t)$ 是独立的，且 $\\Delta t=T/N$。那么 $S_{N}\\sim \\mathcal{N}(0,N\\Delta t)=\\mathcal{N}(0,T)$。令 $M_{N}=\\max_{0\\leq k\\leq N}S_{k}$ 表示网格上的运行最大值。目标概率是 $P_{1}=P(M_{N}\\geq a)$ 和 $P_{2}=P(S_{N}\\geq a)$，而模拟产生的经验估计值 $\\hat{P}_{1}$ 和 $\\hat{P}_{2}$ 会根据大数定律在 $K\\to\\infty$ 时收敛到这些概率值。\n\n我们对具有独立同分布、对称、连续增量的随机游走使用反射原理。令 $a0$ 并定义首次穿越时间 $T_{a}=\\min\\{k\\geq 1:S_{k}\\geq a\\}$。\n事件 $\\{M_N \\ge a\\}$ 可以被分解为两个互斥事件的和：$\\{M_N \\ge a \\text{ and } S_N \\ge a\\}$ 和 $\\{M_N \\ge a \\text{ and } S_N  a\\}$。\n第一个事件 $\\{M_N \\ge a \\text{ and } S_N \\ge a\\}$ 等价于 $\\{S_N \\ge a\\}$，因为如果路径在 $T$ 结束时高于 $a$，那么它的最大值也必然至少是 $a$。\n因此，$P(M_N \\ge a \\text{ and } S_N \\ge a) = P(S_N \\ge a)$。\n\n对于第二个事件 $\\{M_N \\ge a \\text{ and } S_N  a\\}$，反射原理表明，它的概率等于路径最终在 $a$ 上方结束的概率。具体来说，$P(M_N \\ge a \\text{ and } S_N  a) = P(S_N  a)$。这是因为任何到达或超过 $a$ 然后又回落到 $a$ 以下的路径，都可以通过在首次达到 $a$ 的时刻之后的所有增量上乘以-1，来一对一地映射到一条最终停在 $a$ 上方的路径。由于增量是对称分布的，这两个事件的概率相等。\n\n将两部分结合起来：\n$$\nP(M_N \\ge a) = P(S_N \\ge a) + P(S_N  a)\n$$\n由于 $S_N$ 是一个连续随机变量（服从正态分布），因此 $P(S_N  a) = P(S_N \\ge a)$。\n所以，我们得到：\n$$\nP(M_N \\ge a) = P(S_N \\ge a) + P(S_N \\ge a) = 2 P(S_N \\ge a)\n$$\n这就建立了关系 $P_1 = 2 P_2$。因此，理论比率 $R = P_1 / P_2 = 2$。\n一个运行良好的数值模拟，在有大量样本（$K=500,000$）的情况下，其经验比率 $\\hat{R} = \\hat{P}_1 / \\hat{P}_2$ 应该非常接近理论值 $2$。因此，预期的答案是 $2.00$。", "answer": "$$\\boxed{2.00}$$", "id": "1332040"}, {"introduction": "在物理学和化学中，诸如高分子链这样的复杂系统往往缺乏精确的解析解，此时计算机模拟便成为研究其性质的主要工具。本练习以自回避随机游走（SAW）模型为例，展示了如何利用模拟产生的数据来揭示系统宏观尺度下的标度律。您将学习如何分析模拟输出结果，估计关键的物理指数（如Flory指数），并利用该模型进行预测，这是计算科学研究中的一项核心技能。[@problem_id:1332029]", "problem": "一位计算物理学家正在研究良溶剂中聚合物链的简化模型。该模型将聚合物表示为在单位边长的三维立方晶格上的自回避随机游走（SAW）。SAW 是晶格上的一条路径，从原点 $(0,0,0)$ 开始，且不会重复访问同一个晶格点。一次游走的“端到端距离” $R_N$ 是其经过 $N$ 步后起点和终点之间的欧几里得距离。\n\n该物理学家对两种不同的聚合物长度 $N_1$ 和 $N_2$ 进行了大量的模拟。使用一种能够从给定长度的所有可能 SAW 的均匀分布中正确采样的复杂算法，模拟得出了以下均方端到端距离的值：\n- 对于长度为 $N_1 = 25$ 步的游走，均方端到端距离为 $\\langle R_{N_1}^2 \\rangle = 44.51$。\n- 对于长度为 $N_2 = 50$ 步的游走，均方端到端距离为 $\\langle R_{N_2}^2 \\rangle = 95.83$。\n\n在大 $N$ 极限下，理论预测 SAW 的均方端到端距离遵循普适标度律 $\\langle R_N^2 \\rangle = A N^{2\\nu}$，其中 $A$ 是一个依赖于模型的振幅，$\\nu$ 是一个被称为 Flory 指数的普适值。\n\n假设此标度律对于所研究的 $N$ 范围是一个有效的近似，首先使用提供的模拟数据来确定指数 $2\\nu$ 的数值。然后，使用这个确定的指数和 $N_2=50$ 步的数据来预测一个更长的聚合物（$N_3 = 500$ 步）的均方端到端距离 $\\langle R_{N_3}^2 \\rangle$。\n\n将您关于 $\\langle R_{N_3}^2 \\rangle$ 的最终答案表示为一个四舍五入到三位有效数字的数。", "solution": "我们使用自回避随机游走的均方端到端距离的标度律：\n$$\n\\langle R_{N}^{2} \\rangle = A N^{2\\nu},\n$$\n其中 $A$ 是一个振幅，$\\nu$ 是 Flory 指数。对于两个长度 $N_{1}$ 和 $N_{2}$，其比值可以消去 $A$：\n$$\n\\frac{\\langle R_{N_{2}}^{2} \\rangle}{\\langle R_{N_{1}}^{2} \\rangle} = \\left(\\frac{N_{2}}{N_{1}}\\right)^{2\\nu}.\n$$\n两边取自然对数可得\n$$\n2\\nu = \\frac{\\ln\\!\\left(\\frac{\\langle R_{N_{2}}^{2} \\rangle}{\\langle R_{N_{1}}^{2} \\rangle}\\right)}{\\ln\\!\\left(\\frac{N_{2}}{N_{1}}\\right)}.\n$$\n根据给定数据 $N_{1}=25$, $N_{2}=50$, $\\langle R_{N_{1}}^{2} \\rangle=44.51$ 和 $\\langle R_{N_{2}}^{2} \\rangle=95.83$，我们首先计算比值\n$$\nr \\equiv \\frac{\\langle R_{N_{2}}^{2} \\rangle}{\\langle R_{N_{1}}^{2} \\rangle} = \\frac{95.83}{44.51} \\approx 2.15300,\n$$\n并注意到 $\\frac{N_{2}}{N_{1}}=2$。因此，\n$$\n2\\nu = \\frac{\\ln(r)}{\\ln(2)} \\approx \\frac{\\ln(2.15300)}{\\ln(2)} \\approx 1.10635.\n$$\n为了预测 $N_{3}=500$ 时的 $\\langle R_{N_{3}}^{2} \\rangle$，我们使用\n$$\n\\langle R_{N_{3}}^{2} \\rangle = \\langle R_{N_{2}}^{2} \\rangle \\left(\\frac{N_{3}}{N_{2}}\\right)^{2\\nu} = 95.83 \\left(\\frac{500}{50}\\right)^{2\\nu} = 95.83 \\cdot 10^{2\\nu}.\n$$\n使用 $2\\nu \\approx 1.10635$，\n$$\n\\langle R_{500}^{2} \\rangle \\approx 95.83 \\times 10^{1.10635} \\approx 95.83 \\times 12.775 \\approx 1.224 \\times 10^{3}.\n$$\n四舍五入到三位有效数字，可得\n$$\n\\langle R_{500}^{2} \\rangle \\approx 1.22 \\times 10^{3}.\n$$", "answer": "$$\\boxed{1.22 \\times 10^{3}}$$", "id": "1332029"}]}