{"hands_on_practices": [{"introduction": "掌握了高尔顿-沃森过程的基本定义后，首要任务便是预测其未来。一个群体在未来几代中预期会有多大？其规模的波动性又如何？这个练习将引导你计算后代群体规模的期望值和标准差，这是分析任何分支过程的基础。通过一个社交媒体趋势的假想场景[@problem_id:1303363]，我们将把这些核心统计量的计算方法付诸实践。", "problem": "一项新的社交媒体挑战由一个人发起，此人被视为第0代。挑战中任何一代的每位参与者都会独立地鼓励其一定数量的关注者加入。这些新加入者构成了下一代参与者。任何一个个体招募的新参与者数量是一个随机变量，服从均值为 $\\lambda = 2.0$ 的泊松分布。\n\n设 $Z_n$ 表示第 $n$ 代的参与者数量，其中 $Z_0=1$。计算第3代参与者数量的标准差与第3代参与者数量的期望值之比。换句话说，计算 $\\frac{\\sqrt{\\text{Var}(Z_3)}}{E[Z_3]}$ 的值。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "将参与者数量建模为一个高尔顿-沃森分支过程，其后代分布为均值参数为 $\\lambda$ 的泊松分布。设 $m$ 表示后代数量的均值，$\\sigma^{2}$ 表示后代分布的方差。对于泊松分布Poisson$(\\lambda)$，我们有 $m=\\lambda$ 和 $\\sigma^{2}=\\lambda$。\n\n对于一个 $Z_{0}=1$ 的高尔顿-沃森过程，给定 $Z_{n}$ 的条件矩为\n$$\n\\mathbb{E}[Z_{n+1}\\mid Z_{n}] = m Z_{n}, \\qquad \\mathrm{Var}(Z_{n+1}\\mid Z_{n}) = \\sigma^{2} Z_{n}.\n$$\n使用全期望公式和全方差公式，\n$$\n\\mathbb{E}[Z_{n+1}] = \\mathbb{E}[\\mathbb{E}[Z_{n+1}\\mid Z_{n}]] = m\\,\\mathbb{E}[Z_{n}],\n$$\n通过归纳法可得\n$$\n\\mathbb{E}[Z_{n}] = m^{n}.\n$$\n对于方差，\n$$\n\\mathrm{Var}(Z_{n+1}) = \\mathbb{E}[\\mathrm{Var}(Z_{n+1}\\mid Z_{n})] + \\mathrm{Var}(\\mathbb{E}[Z_{n+1}\\mid Z_{n}]) = \\sigma^{2}\\mathbb{E}[Z_{n}] + m^{2}\\mathrm{Var}(Z_{n}).\n$$\n设 $V_{n}=\\mathrm{Var}(Z_{n})$。当 $V_{0}=0$ 且 $\\mathbb{E}[Z_{n}] = m^{n}$ 时，递推关系为\n$$\nV_{n+1} = \\sigma^{2} m^{n} + m^{2} V_{n}.\n$$\n解此非齐次线性递推关系，当 $m \\neq 1$ 时，可得\n$$\nV_{n} = \\sigma^{2} m^{n-1} \\frac{m^{n}-1}{m-1}.\n$$\n当 $\\lambda=2$ 时，我们有 $m=2$ 和 $\\sigma^{2}=2$。对于 $n=3$，\n$$\n\\mathbb{E}[Z_{3}] = m^{3} = 2^{3} = 8,\n$$\n$$\n\\mathrm{Var}(Z_{3}) = \\sigma^{2} m^{2} \\frac{m^{3}-1}{m-1} = 2 \\cdot 2^{2} \\cdot \\frac{2^{3}-1}{2-1} = 2 \\cdot 4 \\cdot 7 = 56.\n$$\n因此，\n$$\n\\frac{\\sqrt{\\mathrm{Var}(Z_{3})}}{\\mathbb{E}[Z_{3}]} = \\frac{\\sqrt{56}}{8} = \\frac{2\\sqrt{14}}{8} = \\frac{\\sqrt{14}}{4}.\n$$\n数值上，四舍五入到四位有效数字，\n$$\n\\frac{\\sqrt{14}}{4} \\approx 0.9354.\n$$", "answer": "$$\\boxed{0.9354}$$", "id": "1303363"}, {"introduction": "在了解了如何预测群体规模的增长后，一个更深层次的问题自然浮现：这个过程会无限持续下去，还是最终会消亡？这个问题引出了高尔顿-沃森过程的核心概念之一——灭绝概率。本练习[@problem_id:1303394]将教你如何运用概率母函数（PGF）这一强大工具，通过求解一个不动点方程来确定一个谱系的最终命运。", "problem": "一场新的病毒式营销活动由一位经理发起。该活动的结构要求每位现有参与者尝试招募两名新参与者。对于任何一次招募尝试，成功的概率为 $p=0.6$，且每次尝试都与其他尝试相互独立。如果活动能够无限期地增长，则被认为是成功的。相反，如果在某个时刻，某一代的参与者未能产生任何新的招募，从而导致招募链中断，则该活动被认为已经崩溃。\n\n假设最初的经理成功招募了两名新参与者，他们构成了活动的第一代。这次活动最终崩溃的概率是多少？\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "将此活动建模为一个高尔顿-沃森分支过程，其中每个参与者独立产生的后代数量服从参数为2和$p$的二项分布。因此，后代生成函数为\n$$\nf(s)=\\sum_{k=0}^{2} \\binom{2}{k} p^{k} (1-p)^{2-k} s^{k} = \\left( (1-p) + p s \\right)^{2}.\n$$\n设 $r$ 为从单个参与者开始的灭绝概率。它是区间 $[0,1]$ 内满足不动点方程的最小解\n$$\nr = f(r) = \\left( (1-p) + p r \\right)^{2}.\n$$\n展开并整理得到一个关于 $r$ 的二次方程：\n$$\nr = (1-p)^{2} + 2p(1-p) r + p^{2} r^{2}\n\\quad \\Longrightarrow \\quad\np^{2} r^{2} + \\left( 2p(1-p) - 1 \\right) r + (1-p)^{2} = 0.\n$$\n根据二次方程求根公式，\n$$\nr = \\frac{1 - 2p(1-p) \\pm \\sqrt{\\left( 1 - 2p(1-p) \\right)^{2} - 4 p^{2} (1-p)^{2}}}{2 p^{2}}.\n$$\n判别式可简化为\n$$\n\\left( 1 - 2p(1-p) \\right)^{2} - 4 p^{2} (1-p)^{2}\n= 1 - 4p(1-p) = \\left( 1 - 2p \\right)^{2}.\n$$\n因此，两个根为\n$$\nr = \\frac{1 - 2p(1-p) \\pm |1 - 2p|}{2 p^{2}}.\n$$\n当 $p  \\frac{1}{2}$ (本题中 $p=0.6$) 时，我们有 $|1-2p| = 2p - 1$，得到的根为 $r=1$ 和\n$$\nr = \\left( \\frac{1-p}{p} \\right)^{2}.\n$$\n由于每个参与者平均招募的人数是 $2p  1$，所以从一个祖先开始的灭绝概率是较小的根 $r = \\left( \\frac{1-p}{p} \\right)^{2}$。\n\n鉴于最初的经理已经在第一代中产生了恰好两名参与者，这两条后代线是独立演化的。因此，最终崩溃的概率是这两条独立线的灭绝概率的乘积：\n$$\nr_{\\text{total}} = r^{2} = \\left( \\frac{1-p}{p} \\right)^{4}.\n$$\n代入 $p=0.6$ 得\n$$\nr_{\\text{total}} = \\left( \\frac{1-0.6}{0.6} \\right)^{4}\n= \\left( \\frac{0.4}{0.6} \\right)^{4}\n= \\left( \\frac{2}{3} \\right)^{4}\n= \\frac{16}{81} \\approx 0.197530864\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.198$。", "answer": "$$\\boxed{0.198}$$", "id": "1303394"}, {"introduction": "我们已经知道如何判断一个谱系是否会最终灭绝。然而，我们能否更精确地描述其灭绝的时间点？这个练习[@problem_id:1303348]将深化我们对灭绝动态的理解，要求我们计算过程在“恰好”第三代灭绝的概率。这需要我们区分“在第$n$代或之前灭绝”与“恰好在第$n$代灭绝”这两个概念，从而更精细地运用概率母函数的迭代特性。", "problem": "考虑一个网络中自我复制数字实体传播的简化模型。该过程始于单个实体，其演化以离散的代际进行追踪。在每一代中，每个现存实体都被独立处理，并被一定数量的“后代”实体所取代。\n\n任何单个实体产生的后代数量遵循一个特定的概率分布：一个实体要么不复存在（产生0个后代），概率为 $p_0 = 0.5$；要么分化为两个新实体（产生2个后代），概率为 $p_2 = 0.5$。\n\n设 $Z_n$ 表示第 $n$ 代的种群中实体的总数，初始条件为 $Z_0 = 1$。如果种群大小变为零，则认为该种群已经灭绝。\n\n计算种群恰好在第三代灭绝的概率。这意味着种群在第一代和第二代之后非零，但在第三代变为零。将你的答案表示为精确分数。", "solution": "我们将此过程建模为一个高尔顿-沃森分支过程，其后代生成函数为\n$$\nf(s)=p_{0}+p_{2}s^{2}=\\frac{1}{2}+\\frac{1}{2}s^{2}.\n$$\n对于单个初始实体，种群在第 $n$ 代或之前灭绝的概率由 $f$ 在 $0$ 处的 $n$ 次函数迭代给出：\n$$\na_{n}=f^{\\circ n}(0).\n$$\n显式计算前三个值：\n$$\na_{1}=f(0)=\\frac{1}{2},\n$$\n$$\na_{2}=f(a_{1})=\\frac{1}{2}+\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{2}+\\frac{1}{8}=\\frac{5}{8},\n$$\n$$\na_{3}=f(a_{2})=\\frac{1}{2}+\\frac{1}{2}\\left(\\frac{5}{8}\\right)^{2}=\\frac{1}{2}+\\frac{25}{128}=\\frac{89}{128}.\n$$\n种群恰好在第三代灭绝的概率（即种群数量首次在第三代变为零）是到第三代时已灭绝的概率减去到第二代时已灭绝的概率：\n$$\n\\mathbb{P}(Z_{3}=0,\\ Z_{2}0)=a_{3}-a_{2}=\\frac{89}{128}-\\frac{5}{8}=\\frac{89}{128}-\\frac{80}{128}=\\frac{9}{128}.\n$$\n通过直接分支进行验证：要存活过第一代，需要 $Z_{1}=2$，其概率为 $\\frac{1}{2}$。给定 $Z_{1}=2$，$Z_{2}$ 的分布为：$0$ 的概率为 $\\frac{1}{4}$，$2$ 的概率为 $\\frac{1}{2}$，以及 $4$ 的概率为 $\\frac{1}{4}$。若 $Z_{2}=2$，要在第三代灭绝，需要两个个体都产生 $0$ 个后代，概率为 $\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{4}$；若 $Z_{2}=4$，概率为 $\\left(\\frac{1}{2}\\right)^{4}=\\frac{1}{16}$。因此\n$$\n\\mathbb{P}(\\text{extinct at }3)=\\frac{1}{2}\\cdot\\frac{1}{2}\\cdot\\frac{1}{4}+\\frac{1}{2}\\cdot\\frac{1}{4}\\cdot\\frac{1}{16}=\\frac{1}{16}+\\frac{1}{128}=\\frac{9}{128},\n$$\n这与之前的结果相符。", "answer": "$$\\boxed{\\frac{9}{128}}$$", "id": "1303348"}]}