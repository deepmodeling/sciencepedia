{"hands_on_practices": [{"introduction": "计算分支过程最终灭绝的概率是该领域的核心问题之一。本练习提供了一个基础场景，其中后代的数量是有限且离散的，旨在引导你完成使用后代数生成函数 $G(s)$ 求解灭绝概率 $q$ 的基本步骤。通过解决方程 $q = G(q)$，你将掌握分析这类随机过程长期行为的关键技术 [@problem_id:1304392]。", "problem": "一个描述病毒式模因在社交网络上传播的简化模型，可以用一个离散时间分支过程来描述。该过程从第0代开始，只有一个用户发布了该模因。在第 $n$ 代拥有该模因的每个用户，都会独立地将其分享给一定数量的新用户，这些新用户构成了第 $n+1$ 代。任何一个用户分享该模因的新用户数量是一个随机变量。具体来说，任何一个给定的用户会把该模因分享给：\n- 0个新用户，概率为 $p_0 = 0.2$。\n- 1个新用户，概率为 $p_1 = 0.5$。\n- 2个新用户，概率为 $p_2 = 0.3$。\n- 用户不可能将该模因分享给超过2个新用户。\n\n如果某一代的用户数量为零，则认为该过程已经灭绝。假设过程从单个初始用户开始，计算该模因的传播最终停止的长期概率。", "solution": "设 $Z_{n}$ 为 Galton–Watson 分支过程中第 $n$ 代的用户数量，其后代分布的支撑集为 $\\{0,1,2\\}$，其中一个用户分享给0、1、2个新用户的概率分别为 $p_{0}=\\frac{1}{5}$、$p_{1}=\\frac{1}{2}$ 和 $p_{2}=\\frac{3}{10}$。灭绝概率 $q$（从一个初始用户开始）是不动点方程 $q=f(q)$ 在 $[0,1]$ 区间内的最小解，其中后代生成函数为\n$$\nf(s)=\\sum_{k=0}^{2}p_{k}s^{k}=\\frac{1}{5}+\\frac{1}{2}s+\\frac{3}{10}s^{2}.\n$$\n首先，检验新用户的平均数量：\n$$\nm=f'(1)=\\frac{1}{2}+2\\cdot\\frac{3}{10}=\\frac{1}{2}+\\frac{3}{5}=\\frac{11}{10}1,\n$$\n因此该过程是超临界的，灭绝概率满足 $q1$。求解 $q=f(q)$：\n$$\ns=\\frac{1}{5}+\\frac{1}{2}s+\\frac{3}{10}s^{2}\n\\;\\Longleftrightarrow\\;\n\\frac{3}{10}s^{2}-\\frac{1}{2}s+\\frac{1}{5}=0\n\\;\\Longleftrightarrow\\;\n3s^{2}-5s+2=0.\n$$\n根据二次方程求根公式，\n$$\ns=\\frac{5\\pm\\sqrt{25-24}}{6}=\\frac{5\\pm 1}{6}\\in\\left\\{1,\\;\\frac{2}{3}\\right\\}.\n$$\n灭绝概率是 $[0,1]$ 区间内较小的根，因此 $q=\\frac{2}{3}$。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1304392"}, {"introduction": "在掌握了计算无条件灭绝概率的基本方法后，一个自然而然的进阶问题是：在过程存活了第一代的情况下，它最终灭绝的概率是多少？这个练习 [@problem_id:1304391] 将挑战你运用概率生成函数进行更深入的分析推理，推导出一个关于条件灭绝概率的普适表达式。这有助于加深对分支过程逐代演化结构的理解。", "problem": "考虑一个 Galton-Watson 分支过程 $\\{Z_n\\}_{n \\ge 0}$，其中 $Z_n$ 是第 $n$ 代的种群大小。该过程从单个祖先开始，因此 $Z_0 = 1$。种群中的每个个体根据一个固定的概率分布独立地产生随机数量的后代。\n\n设该后代分布的概率生成函数 (PGF) 为 $G(s) = \\sum_{k=0}^{\\infty} p_k s^k$，其中 $p_k$ 是一个个体拥有 $k$ 个后代的概率。假设平均后代数大于 1，即 $G'(1) > 1$。令 $E$ 为最终灭绝事件，即种群最终消亡。\n\n求条件概率 $P(E | Z_1 > 0)$ 的表达式。你的最终答案应为一个关于 PGF $G(s)$ 和无条件灭绝概率（我们记为 $q$）的解析表达式。", "solution": "令 $q$ 表示从单个祖先开始的无条件灭绝概率。根据分支特性，在 $Z_{1}=k$ 的条件下，后续过程是 $k$ 个独立同分布的原始过程之和，因此在给定 $Z_{1}=k$ 的情况下，最终灭绝的概率为\n$$\nP(E \\mid Z_{1}=k)=q^{k}.\n$$\n因此，\n$$\nP(E \\mid Z_{1}>0)=\\sum_{k=1}^{\\infty}P(E \\mid Z_{1}=k)\\,P(Z_{1}=k \\mid Z_{1}>0)=\\sum_{k=1}^{\\infty}q^{k}\\,\\frac{p_{k}}{1-p_{0}}=\\frac{\\sum_{k=1}^{\\infty}p_{k}q^{k}}{1-p_{0}}.\n$$\n使用概率生成函数 $G(s)=\\sum_{k=0}^{\\infty}p_{k}s^{k}$，我们可得 $\\sum_{k=1}^{\\infty}p_{k}q^{k}=G(q)-p_{0}$ 且 $p_{0}=G(0)$。因此，\n$$\nP(E \\mid Z_{1}>0)=\\frac{G(q)-G(0)}{1-G(0)}.\n$$\n由于 $q$ 是 $G$ 在 $[0,1]$ 上的最小不动点，我们有 $G(q)=q$，所以一个等价形式是\n$$\nP(E \\mid Z_{1}>0)=\\frac{q-G(0)}{1-G(0)}.\n$$\n这两个表达式都是关于 $G$ 和 $q$ 的解析式。", "answer": "$$\\boxed{\\frac{q - G(0)}{1 - G(0)}}$$", "id": "1304391"}, {"introduction": "除了过程是否会灭绝，另一个重要特征是其总规模，即在整个存续期间出现过的个体总数。这个练习 [@problem_id:1304403] 引入了“总后代”这一随机变量，并演示了如何通过一个巧妙的递归关系 $H(s) = sG(H(s))$ 来推导其概率生成函数 $H(s)$。这不仅扩展了生成函数的应用范围，也为分析过程的总资源消耗或影响提供了工具。", "problem": "Galton-Watson分支过程是一种用于描述种群增长的随机模型，其演化以离散的代际进行。该过程始于第 $n=0$ 代的单个祖先。这个祖先产生随机数量的后代，构成第 $n=1$ 代。然后，第 $n$ 代中的每个个体都根据相同的概率分布，独立地产生随机数量的后代，从而形成第 $n+1$ 代。\n\n考虑一个特定的分支过程，其中任何给定个体的后代数量 $X$ 是一个取整数值 $k \\geq 0$ 的随机变量。$X$ 的概率质量函数由下式给出\n$$\nP(X=k) = \\left(\\frac{1}{2}\\right)^{k+1}, \\quad \\text{for } k = 0, 1, 2, \\ldots\n$$\n离散随机变量 $X$ 的概率生成函数 (PGF) 定义为 $G(s) = E[s^X]$。\n\n设 $Y$ 为代表该过程总后代数的随机变量，定义为曾经存在过的个体总数，包括初始祖先。求 $H(s) = E[s^Y]$（即总后代数 $Y$ 的概率生成函数）的闭式表达式。", "solution": "我们首先计算后代概率生成函数。对于给定的后代分布，\n$$\nG(s) \\equiv \\mathbb{E}[s^{X}] = \\sum_{k=0}^{\\infty} s^{k} \\left(\\frac{1}{2}\\right)^{k+1} = \\frac{1}{2} \\sum_{k=0}^{\\infty} \\left(\\frac{s}{2}\\right)^{k}.\n$$\n使用几何级数恒等式 $\\sum_{k=0}^{\\infty} r^{k} = \\frac{1}{1-r}$ (对于 $|r|1$)，我们得到\n$$\nG(s) = \\frac{1}{2} \\cdot \\frac{1}{1 - \\frac{s}{2}} = \\frac{1}{2 - s}.\n$$\n\n设 $Y$ 表示总后代数（包括祖先）。在一个从单个祖先开始的Galton–Watson过程中，$Y$ 满足以下分解式\n$$\nY = 1 + \\sum_{i=1}^{X} Y_{i},\n$$\n其中，在给定 $X$ 的条件下，$Y_{i}$ 是 $Y$ 的独立副本，且与 $X$ 相互独立。取概率生成函数并利用独立性，\n$$\nH(s) \\equiv \\mathbb{E}[s^{Y}] = \\mathbb{E}\\!\\left[s^{1 + \\sum_{i=1}^{X} Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}} \\,\\bigg|\\, X\\right]\\right].\n$$\n给定 $X=k$ 时，我们有 $\\prod_{i=1}^{k} s^{Y_{i}} = \\left(\\mathbb{E}[s^{Y}]\\right)^{k} = \\left(H(s)\\right)^{k}$。因此，\n$$\nH(s) = s\\, \\mathbb{E}\\!\\left[(H(s))^{X}\\right] = s\\, G\\!\\left(H(s)\\right).\n$$\n将 $u = H(s)$ 代入 $G(u) = \\frac{1}{2 - u}$ 得到函数方程\n$$\nH(s) = \\frac{s}{2 - H(s)}.\n$$\n整理后得到一个关于 $H(s)$ 的二次方程：\n$$\nH(s)\\left(2 - H(s)\\right) = s \\quad \\Longleftrightarrow \\quad H(s)^{2} - 2 H(s) + s = 0.\n$$\n解这个二次方程，\n$$\nH(s) = 1 \\pm \\sqrt{1 - s}.\n$$\n为了选择正确的分支，我们使用 PGF 的边界条件 $H(0) = \\mathbb{E}[0^{Y}] = 0$，因为 $Y \\geq 1$。在 $s=0$ 处求值得到 $H(0) = 1 \\pm 1$，因此有效的选择是\n$$\nH(s) = 1 - \\sqrt{1 - s}.\n$$\n这也满足 $H(1) = 1$，符合 PGF 的要求。", "answer": "$$\\boxed{1 - \\sqrt{1 - s}}$$", "id": "1304403"}]}