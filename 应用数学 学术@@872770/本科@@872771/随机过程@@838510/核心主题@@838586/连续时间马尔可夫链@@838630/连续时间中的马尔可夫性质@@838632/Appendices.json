{"hands_on_practices": [{"introduction": "我们将从连续时间马尔可夫链的核心——生成元矩阵（generator matrix）——开始。这个练习将挑战你思考其元素的物理和数学意义，以及为何某些属性（如非对角元素的非负性）不仅仅是惯例，而是基本要求。通过分析一个有缺陷的生成元矩阵 [@problem_id:1342651]，你将深刻理解其如何直接违反概率论的基本公理。", "problem": "一位系统分析师正在为一个关键服务器的运行状态开发一个模型，该服务器可以处于三种状态之一：$S = \\{1, 2, 3\\}$，分别对应“在线”、“降级”和“离线”。分析师将该系统建模为一个由生成元矩阵 $Q = (q_{ij})$ 控制的连续时间马尔可夫链（CTMC）。在时间间隔 $t$ 内从状态 $i$ 转移到状态 $j$ 的转移概率记为 $P_{ij}(t) = \\mathbb{P}(X(t+s)=j | X(s)=i)$。\n\n所提出的生成元矩阵 $Q$ 被构建为满足两个标准属性：\n1. 对角线元素为非正数：对于所有 $i \\in S$，$q_{ii} \\le 0$。\n2. 每行元素之和为零：对于所有 $i \\in S$，$\\sum_{j=1}^{3} q_{ij} = 0$。\n\n然而，在审查时发现该矩阵包含一个错误的条目：从状态1（“在线”）到状态2（“降级”）的转移率为负，即 $q_{12}  0$。所有其他非对角线元素均为非负。\n\n当考虑系统在无穷小时间间隔 $\\Delta t > 0$ 内的演化时，以下哪个陈述描述了由这一个有缺陷的条目所引起的最直接和最基本的数学不一致性？\n\nA. 如果该过程的平稳分布存在，它不能被归一化为总和为一。\n\nB. 该过程的查普曼-科尔莫戈罗夫方程（它关联了不同时间间隔的转移概率）被违反。\n\nC. 从状态1到状态2的特定转移的近似概率 $P_{12}(\\Delta t)$ 变为负数，违反了概率论的一个基本公理。\n\nD. 全概率定律被违反，因为从状态1出发的所有可能转移的概率之和 $\\sum_{j=1}^{3} P_{1j}(\\Delta t)$ 偏离了1。\n\nE. 该过程变为爆炸性的，意味着在有限时间内发生无限多次状态转移的概率不为零。", "solution": "对于连续时间马尔可夫链（CTMC），生成元矩阵 $Q$ 和转移概率矩阵 $P(t)$ 之间的关系由矩阵指数给出：$P(t) = \\exp(Qt)$。对于一个非常小的正时间间隔 $\\Delta t$，我们可以使用指数函数的一阶泰勒展开来近似这个关系：\n$$ P(\\Delta t) \\approx I + Q\\Delta t $$\n其中 $I$ 是单位矩阵。\n\n让我们分析这个矩阵方程的各个分量。在时间间隔 $\\Delta t$ 内从状态 $i$ 转移到状态 $j$ 的概率 $P_{ij}(\\Delta t)$ 可以近似为：\n$$ P_{ij}(\\Delta t) \\approx \\delta_{ij} + q_{ij}\\Delta t $$\n其中 $\\delta_{ij}$ 是克罗内克δ函数，当 $i=j$ 时为1，当 $i \\neq j$ 时为0。\n\n我们已知所提出的生成元矩阵有一个条目 $q_{12}  0$。让我们检查这对每个选项的影响。\n\n**选项 C：**\n让我们计算从状态1转移到状态2的近似概率。在这种情况下，$i=1$ 且 $j=2$，所以 $i \\neq j$ 且 $\\delta_{12}=0$。近似变为：\n$$ P_{12}(\\Delta t) \\approx q_{12}\\Delta t $$\n由于问题陈述 $q_{12}  0$ 并且我们考虑的是一个时间间隔 $\\Delta t > 0$，所以乘积 $q_{12}\\Delta t$ 严格为负。这意味着从状态1转移到状态2的概率将为负。根据概率论公理中的定义，概率必须是一个非负数。因此，生成元矩阵中存在负的非对角线元素会导致一个在物理上和数学上都不可能的负转移概率结果。这是一个直接且基本的违反。\n\n**选项 D：**\n让我们检查从状态1到任何状态的转移概率之和。\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) = P_{11}(\\Delta t) + P_{12}(\\Delta t) + P_{13}(\\Delta t) $$\n对每一项使用一阶近似：\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx (\\delta_{11} + q_{11}\\Delta t) + (\\delta_{12} + q_{12}\\Delta t) + (\\delta_{13} + q_{13}\\Delta t) $$\n代入克罗内克δ函数的值：\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx (1 + q_{11}\\Delta t) + (0 + q_{12}\\Delta t) + (0 + q_{13}\\Delta t) $$\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx 1 + (q_{11} + q_{12} + q_{13})\\Delta t $$\n问题明确指出所提出的矩阵的行和为零，所以 $q_{11} + q_{12} + q_{13} = 0$。将此代入我们的近似中：\n$$ \\sum_{j=1}^{3} P_{1j}(\\Delta t) \\approx 1 + (0)\\Delta t = 1 $$\n在一阶 $\\Delta t$ 近似下，全概率定律是守恒的；概率之和保持为1。因此，选项D是错误的。这是一个常见的误解，因为行和为零的属性正确地保持了总概率，即使个别的转移率/概率是无意义的。\n\n**选项 A：**\n平稳分布与马尔可夫链的长期行为（当 $t \\to \\infty$ 时）有关。虽然一个有缺陷的生成元矩阵确实会阻止存在一个对应于真实世界过程的有效平稳分布，但最*直接*和*无穷小*的后果与平稳分布无关，而是与短期转移概率有关。因此，A不是最佳答案。\n\n**选项 B：**\n查普曼-科尔莫戈罗夫方程是底层随机过程具有马尔可夫性的宏观结果。负概率的存在是一个微观的、公理性的失败。因为基本的概率 $P_{ij}(\\Delta t)$ 是不合理的，建立在其上的整个理论结构，包括查普曼-科尔莫戈罗夫方程，将不可避免地崩溃。然而，负概率是原因，而违反查普曼-科尔莫戈罗夫方程是结果。因此，C描述了一个更直接和更基本的不一致性。\n\n**选项 E：**\nCTMC中的爆炸过程是指在有限时间内可能发生无限次跳跃的过程。这种现象与状态的离开率有关。对于有限状态空间，这种情况不会发生，因为所有的离开率 $-q_{ii} = \\sum_{j \\neq i} q_{ij}$ 都是有限的。对于无限状态空间，这是一个需要考虑的问题，但它与非对角线元素的符号无关。因此，E是错误的。\n\n结论：最直接和最基本的缺陷是特定转移的近似概率变为负数，这违反了概率论的基本公理。", "answer": "$$\\boxed{C}$$", "id": "1342651"}, {"introduction": "在理解了转移速率的基础上，本练习将探讨它们的直接结果：状态的“停留时间”（holding time）分布。一个过程要具有马尔可夫性，它在每一步都必须“重置记忆”，这意味着在任何状态的停留时间都必须服从指数分布。此问题 [@problem_id:1342681] 要求你在一个假设场景中强制施加此条件，以揭示潜在的恒定转移速率。", "problem": "一家公司正在对城市中三个热门站点之间的共享电动自行车的流动进行建模：中央车站（S）、大学园区（U）和科技园区（P）。令 $X(t)$ 为某辆特定自行车在时刻 $t$ 所在的站点。自行车归还到某个站点后，会等待下一位用户。这段持续时间被称为“停留时间”。\n\n分析师为大学园区（U）的停留时间提出了一个复杂的模型。他们假设停留时间的统计特性取决于自行车刚刚到达的始发站点，该站点可以是中央车站（S）或科技园区（P）。根据他们的模型，在自行车从站点 $j \\in \\{S, P\\}$ 到达的条件下，其在站点 U 的停留时间的风险率 $h_{U|j}(t)$ 由以下函数描述：\n$$ h_{U|j}(t) = \\frac{\\alpha_j + \\beta_j t}{1 + \\gamma_j t} $$\n此处，$t$ 表示自行车到达站点 U 后经过的时间。参数 $\\alpha_j, \\beta_j,$ 和 $\\gamma_j$ 是取决于始发站点 $j$ 的正常数。\n\n为了使由过程 $X(t)$ 表示的自行车移动能被正确地描述为连续时间马尔可夫链（CTMC），任何给定站点的停留时间分布必须是指数分布，并且其率参数必须仅取决于当前站点，而不取决于自行车到达的始发站点。\n\n此外，一项独立的系统范围分析提供了模型参数之间的以下关系：\n1.  $\\beta_S + \\beta_P = 30$\n2.  $\\gamma_S + \\gamma_P = 5$\n3.  $\\beta_S = \\frac{2}{3} \\beta_P$\n4.  $\\alpha_S = \\frac{\\beta_S}{2}$\n\n假设自行车移动是CTMC的条件得到满足，计算一辆自行车离开大学园区站点的恒定转移率。请以单个数值的形式给出你的答案。", "solution": "给定的站点U的条件风险率为 $h_{U|j}(t) = \\dfrac{\\alpha_{j} + \\beta_{j} t}{1 + \\gamma_{j} t}$，其中 $j \\in \\{S, P\\}$。要使 $X(t)$ 成为一个连续时间马尔可夫链，站点 U 的停留时间必须是指数分布的，其率仅取决于 U 而不取决于始发站点。因此，必须存在一个常数 $\\lambda_{U}$，使得对于 $j \\in \\{S, P\\}$ 和所有 $t \\geq 0$，都有\n$$\n\\frac{\\alpha_{j} + \\beta_{j} t}{1 + \\gamma_{j} t} = \\lambda_{U}.\n$$\n在恒等式\n$$\n\\alpha_{j} + \\beta_{j} t = \\lambda_{U} \\left(1 + \\gamma_{j} t\\right),\n$$\n中，比较 $1$ 和 $t$ 的系数，我们得到，对于每个 $j$，\n$$\n\\alpha_{j} = \\lambda_{U}, \\quad \\beta_{j} = \\lambda_{U} \\gamma_{j}.\n$$\n因此 $\\alpha_{S} = \\alpha_{P} = \\lambda_{U}$ 且 $\\beta_{j}/\\gamma_{j} = \\lambda_{U}$。\n\n从给定的关系式中，\n$$\n\\beta_{S} + \\beta_{P} = 30, \\quad \\beta_{S} = \\frac{2}{3}\\beta_{P}.\n$$\n代入可得\n$$\n\\frac{2}{3}\\beta_{P} + \\beta_{P} = \\frac{5}{3}\\beta_{P} = 30 \\;\\Rightarrow\\; \\beta_{P} = 18, \\quad \\beta_{S} = 12.\n$$\n并且，\n$$\n\\alpha_{S} = \\frac{\\beta_{S}}{2} = \\frac{12}{2} = 6.\n$$\n根据CTMC的要求，$\\alpha_{S} = \\lambda_{U}$，因此\n$$\n\\lambda_{U} = 6.\n$$\n这与 $\\beta_{j} = \\lambda_{U}\\gamma_{j}$ 以及 $\\gamma_{S} + \\gamma_{P} = 5$ 是一致的，因为\n$$\n\\gamma_{S} = \\frac{\\beta_{S}}{\\lambda_{U}} = \\frac{12}{6} = 2, \\quad \\gamma_{P} = \\frac{\\beta_{P}}{\\lambda_{U}} = \\frac{18}{6} = 3, \\quad \\gamma_{S} + \\gamma_{P} = 5.\n$$\n因此，离开大学园区站点的恒定转移率为 $\\lambda_{U} = 6$。", "answer": "$$\\boxed{6}$$", "id": "1342681"}, {"introduction": "马尔可夫性质虽然强大，但并非所有随机过程都具备。本练习介绍了一个经典案例——电报过程（telegraph process），其中粒子的位置本身并不构成马尔可夫过程。通过分析其不满足马尔可夫性的原因以及如何通过“状态增广”（state augmentation）来修复它，你将更深入地理解“状态”的真正含义，并掌握这一重要的建模技巧 [@problem_id:1342716]。", "problem": "一个粒子进行一维随机游走，通常称为电报过程。其速度，记为随机过程 $V(t)$，只能取两个值：一个恒定的正速度 $+v_0$ 或一个恒定的负速度 $-v_0$。粒子在时间 $t=0$ 时以一个特定的、非随机的初始速度 $V(0)$ 开始运动。速度过程 $V(t)$ 在随机时刻在 $+v_0$ 和 $-v_0$ 之间切换。连续切换之间的时间间隔是独立同分布的指数随机变量，其均值为 $1/\\lambda$。这意味着在任何微小时间间隔 $dt$ 内，发生切换的概率为 $\\lambda dt$。\n\n粒子在时间 $t$ 的位置，记为 $X(t)$，定义为其速度从开始的积分，初始条件为 $X(0) = 0$。即，$X(t) = \\int_0^t V(s) ds$。\n\n如果对于任意时间 $t$ 和任意过去的时刻 $t_{past}  t$，未来状态 $\\{Z(s), s > t\\}$ 在给定过程直到时间 $t$ 的历史 $\\{Z(u), u \\le t\\}$ 的条件概率分布仅依赖于当前状态 $Z(t)$，那么随机过程 $\\{Z(t), t \\ge 0\\}$ 被称为马尔可夫过程。\n\n考虑以下关于电报过程及其相关量的陈述：\n\n陈述 A：速度过程 $\\{V(t), t \\ge 0\\}$ 是一个马尔可夫过程。\n\n陈述 B：位置过程 $\\{X(t), t \\ge 0\\}$ 是一个马尔可夫过程。\n\n陈述 C：二维向量过程 $\\{(X(t), V(t)), t \\ge 0\\}$ 是一个马尔可夫过程。\n\n陈述 D：位置的期望值 $E[X(t)]$，对于 $t > 0$ 总是为零，无论初始速度 $V(0)$ 是多少。\n\n以下哪个选项正确地指出了所有正确的陈述？\n\nA. 仅陈述 A\n\nB. 仅陈述 A 和 B\n\nC. 仅陈述 A 和 C\n\nD. 仅陈述 B 和 D\n\nE. 仅陈述 A、C 和 D", "solution": "我们利用电报过程的定义性质来分析每个陈述。\n\n对于陈述A：过程 $V(t)$ 在集合 $\\{+v_{0},-v_{0}\\}$ 中取值，并以速率 $\\lambda$ 切换，等待时间呈指数分布。根据指数分布的无记忆性，给定 $V(t)$，在下一个微小区间 $[t,t+dt]$ 内发生切换的概率为 $\\lambda\\,dt+o(dt)$，不发生切换的概率为 $1-\\lambda\\,dt+o(dt)$，这与 $t$ 之前的历史无关。因此，对于 $s>t$，$V(s)$ 的条件分布仅依赖于 $V(t)$，而不依赖于完整的历史。因此 $\\{V(t),t\\ge 0\\}$ 是一个连续时间马尔可夫链，其生成元为\n$$\nQ=\\begin{pmatrix}\n-\\lambda  \\lambda\\\\\n\\lambda  -\\lambda\n\\end{pmatrix}.\n$$\n因此陈述A是正确的。\n\n对于陈述B：为了检验 $\\{X(t)\\}$ 的马尔可夫性，考虑一个小的增量 $h>0$。以 $V(t)$ 为条件，在 $[t,t+h]$ 上不发生切换的概率为 $1-\\lambda h+o(h)$，在这种情况下\n$$\nX(t+h)-X(t)=V(t)\\,h+o(h).\n$$\n因此\n$$\n\\Pr\\big(X(t+h)>X(t)\\,\\big|\\,\\mathcal{F}_{t}\\big)=\\begin{cases}\n1-\\lambda h+o(h),  \\text{若 }V(t)=+v_{0},\\\\\no(h),  \\text{若 }V(t)=-v_{0},\n\\end{cases}\n$$\n其中 $\\mathcal{F}_{t}$ 是直到时间 $t$ 的历史。然而，仅以 $X(t)=x$ 为条件并不能确定 $V(t)$；存在两种可行的历史，它们产生相同的 $X(t)=x$，但分别对应 $V(t)=+v_{0}$ 和 $V(t)=-v_{0}$，而这两者为即刻的未来给出了不同的条件概率。因此，仅给定 $X(t)$ 的情况下，未来的条件概率分布所依赖的信息超过了 $X(t)$ 本身，所以 $\\{X(t)\\}$ 不是马尔可夫过程。因此陈述B是错误的。\n\n对于陈述C：考虑二维过程 $(X(t),V(t))$。在切换之间，$X(t)$ 根据 $\\dot{X}(t)=V(t)$ 确定性地演化，且 $V(t)$ 是常数；在速率为 $\\lambda$ 的随机跳跃时刻，$V(t)$ 改变符号，而 $X(t)$ 是连续的。这是一个分段确定性马尔可夫过程，其生成元 $\\mathcal{L}$ 作用于光滑函数 $f(x,v)$ 的方式为\n$$\n\\mathcal{L}f(x,v)=v\\,\\partial_{x}f(x,v)+\\lambda\\big(f(x,-v)-f(x,v)\\big).\n$$\n未来的演化仅依赖于当前状态 $(X(t),V(t))$，而不依赖于过去。因此 $\\{(X(t),V(t))\\}$ 是马尔可夫过程。因此陈述C是正确的。\n\n对于陈述D：令 $S(t)\\in\\{+1,-1\\}$ 表示符号过程，其中 $V(t)=v_{0}S(t)$。对于翻转速率为 $\\lambda$ 的对称两状态链，期望 $m(t)=\\mathbb{E}[S(t)]$ 满足\n$$\n\\frac{d}{dt}m(t)=-2\\lambda\\,m(t),\\qquad m(0)=S(0),\n$$\n所以\n$$\n\\mathbb{E}[V(t)]=v_{0}\\,m(t)=v_{0}\\,S(0)\\,\\exp(-2\\lambda t).\n$$\n使用 $X(t)=\\int_{0}^{t}V(s)\\,ds$ 和 Fubini 定理，\n$$\n\\mathbb{E}[X(t)]=\\int_{0}^{t}\\mathbb{E}[V(s)]\\,ds\n=\\int_{0}^{t}v_{0}\\,S(0)\\,\\exp(-2\\lambda s)\\,ds\n=\\frac{v_{0}\\,S(0)}{2\\lambda}\\big(1-\\exp(-2\\lambda t)\\big).\n$$\n对于一个特定的非随机初始速度 $V(0)=\\pm v_{0}$，我们有 $S(0)=\\pm 1$，所以对于 $t>0$ 时 $\\mathbb{E}[X(t)]$ 通常不为零，除非初始速度被对称地随机化以使其均值为零。因此陈述D是错误的。\n\n综合以上分析，陈述A和C是正确的；陈述B和D是错误的。", "answer": "$$\\boxed{C}$$", "id": "1342716"}]}