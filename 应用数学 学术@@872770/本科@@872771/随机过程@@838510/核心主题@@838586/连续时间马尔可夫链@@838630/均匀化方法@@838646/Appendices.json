{"hands_on_practices": [{"introduction": "均匀化方法的第一步是将连续时间马尔可夫链（CTMC）转化为一个等价的离散时间马尔可夫链（DTMC）。这个练习将通过一个简化的基因表达模型，指导你如何确定最小的均匀化率 $\\lambda$ 和相应的单步转移概率矩阵 $P$。掌握这一核心步骤是应用均匀化方法解决更复杂问题的基础。[@problem_id:1348096]", "problem": "基因表达的一个简化模型考虑了一个可以存在于两种状态之一的单个基因：一种是它正在被转录的“活性”状态（状态1），另一种是它处于沉默状态的“非活性”状态（状态2）。在这些状态之间切换的过程可以被建模为一个连续时间马尔可夫链。\n\n基因在切换到非活性状态之前在活性状态下停留的时间是一个速率参数为 $\\alpha$ 的指数随机变量。相反地，它在切换回活性状态之前在非活性状态下停留的时间是一个速率参数为 $\\beta$ 的指数随机变量。参数 $\\alpha$ 和 $\\beta$ 是正常数，分别表示失活率和激活率。给定失活率大于激活率，即 $\\alpha > \\beta$。\n\n对于这个系统，可以通过使用均匀化方法构造一个在相同状态空间上演化的等效离san时间马尔可夫链。确定最小均匀化率 $\\lambda$，以及相应的一步转移概率矩阵 $P = \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{21} & P_{22} \\end{pmatrix}$ 的四个条目。\n\n将您的答案表示为一个单行矩阵，其中按顺序包含五个值 $\\lambda, P_{11}, P_{12}, P_{21}, P_{22}$。", "solution": "我们将该基因建模为一个状态空间为 $\\{1,2\\}$ 的两状态连续时间马尔可夫链，其中状态1（活性）以速率 $\\alpha$ 转换到状态2（非活性），状态2以速率 $\\beta$ 转换到状态1。因此，无穷小生成元矩阵 $Q$ 为\n$$\nQ=\\begin{pmatrix}\n-\\alpha & \\alpha \\\\\n\\beta & -\\beta\n\\end{pmatrix}.\n$$\n在均匀化中，我们选择一个满足 $\\lambda \\geq \\max_{i} q_{i}$ 的速率 $\\lambda$，其中 $q_{i}=-q_{ii}$ 是从状态 $i$ 的总离开率。此处，$q_{1}=\\alpha$ 且 $q_{2}=\\beta$。给定 $\\alpha>\\beta$，最小均匀化率为\n$$\n\\lambda=\\alpha.\n$$\n均匀化离散时间链的一步转移矩阵为\n$$\nP=I+\\frac{Q}{\\lambda}.\n$$\n将 $\\lambda=\\alpha$ 和上述 $Q$ 代入，得到\n$$\nP=\\begin{pmatrix}\n1+\\frac{-\\alpha}{\\alpha} & \\frac{\\alpha}{\\alpha} \\\\\n\\frac{\\beta}{\\alpha} & 1+\\frac{-\\beta}{\\alpha}\n\\end{pmatrix}\n=\\begin{pmatrix}\n0 & 1 \\\\\n\\frac{\\beta}{\\alpha} & 1-\\frac{\\beta}{\\alpha}\n\\end{pmatrix}.\n$$\n因此，按顺序 $\\lambda, P_{11}, P_{12}, P_{21}, P_{22}$ 排列的所需量为 $\\alpha, 0, 1, \\frac{\\beta}{\\alpha}, 1-\\frac{\\beta}{\\alpha}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\alpha & 0 & 1 & \\frac{\\beta}{\\alpha} & 1-\\frac{\\beta}{\\alpha}\\end{pmatrix}}$$", "id": "1348096"}, {"introduction": "在确定了单步转移矩阵 $P$ 之后，我们便可以分析系统在多个“虚拟”时间步后的状态。这个练习以一个简单的天气模型为例，要求你计算两步转移矩阵 $P^{(2)}$。这不仅能加深你对嵌入式离散时间链演化过程的理解，也为后续使用完整的均匀化公式计算连续时间概率做好了准备。[@problem_id:1348076]", "problem": "考虑一个城市的简单气象模型，该模型可用一个具有两个状态的连续时间马尔可夫过程来描述：状态1（“晴天”）和状态2（“雨天”）。从“晴天”到“雨天”的转移以每天 $\\lambda = 2$ 的恒定速率发生。从“雨天”到“晴天”的转移以每天 $\\mu = 3$ 的恒定速率发生。\n\n为了分析此系统，应用了均匀化方法。这涉及到创建一个相关的离散时间马尔可夫链，其转移可以被认为以一个恒定的速率 $\\Lambda$ 发生。对于本问题，速率 $\\Lambda$ 被选为最小可能的均匀速率，即 $\\Lambda = \\max_{i} |q_{ii}|$，其中 $q_{ii}$ 是连续时间过程的生成元矩阵 $Q$ 的对角元。\n\n令 $P$ 为由此产生的离散时间链的一步转移概率矩阵。你的任务是计算两步转移概率矩阵 $P^{(2)}$。将你的答案表示为一个 2x2 矩阵，其行和列索引对应于状态编号。", "solution": "一个从状态1到状态2的转移速率为 $\\lambda$、从状态2到状态1的转移速率为 $\\mu$ 的两状态连续时间马尔可夫链，其生成元矩阵为\n$$\nQ=\\begin{pmatrix}\n-\\lambda & \\lambda \\\\\n\\mu & -\\mu\n\\end{pmatrix}.\n$$\n当 $\\lambda=2$ 且 $\\mu=3$ 时，矩阵变为\n$$\nQ=\\begin{pmatrix}\n-2 & 2 \\\\\n3 & -3\n\\end{pmatrix}.\n$$\n均匀化选择速率 $\\Lambda=\\max_{i}|q_{ii}|=\\max\\{\\lambda,\\mu\\}=\\mu=3$。嵌入的离散时间转移矩阵为\n$$\nP=I+\\frac{1}{\\Lambda}Q=I+\\frac{1}{3}\\begin{pmatrix}\n-2 & 2 \\\\\n3 & -3\n\\end{pmatrix}\n=\\begin{pmatrix}\n1-\\frac{2}{3} & \\frac{2}{3} \\\\\n1 & 1-1\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{1}{3} & \\frac{2}{3} \\\\\n1 & 0\n\\end{pmatrix}.\n$$\n两步转移概率矩阵为 $P^{(2)}=P^{2}$。计算\n$$\nP^{2}=\\begin{pmatrix}\n\\frac{1}{3} & \\frac{2}{3} \\\\\n1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{3} & \\frac{2}{3} \\\\\n1 & 0\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{1}{9}+\\frac{2}{3} & \\frac{2}{9}+0 \\\\\n\\frac{1}{3}+0 & \\frac{2}{3}+0\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{7}{9} & \\frac{2}{9} \\\\\n\\frac{1}{3} & \\frac{2}{3}\n\\end{pmatrix}.\n$$\n因此，两步转移概率矩阵如上所示。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{7}{9} & \\frac{2}{9} \\\\ \\frac{1}{3} & \\frac{2}{3}\\end{pmatrix}}$$", "id": "1348076"}, {"introduction": "均匀化方法的最终目标是计算原始连续时间过程中的转移概率 $p_{ij}(t)$。这个练习将通过一个网站用户导航模型，让你实践使用完整的均匀化级数公式来近似计算一个随时间变化的概率。它完美地展示了如何将泊松过程的“事件”与离散时间链的“转移”相结合，从而将离散的步骤重新映射回连续的时间轴上。[@problem_id:1348067]", "problem": "一个用户在某热门电子商务网站上的导航行为可以被建模为一个连续时间马尔可夫链 (CTMC)。该用户可能处于以下三个页面之一：“主页”（状态1）、“产品页”（状态2）或“联系我们页”（状态3）。在时间 $t=0$ 时，用户从“主页”开始。\n\n用户根据以下恒定速率在页面之间转移：\n- 从“主页”到“产品页”：速率 $\\lambda_{12} = 3.0 \\text{ min}^{-1}$。\n- 从“主页”到“联系我们页”：速率 $\\lambda_{13} = 1.0 \\text{ min}^{-1}$。\n- 从“产品页”到“主页”：速率 $\\lambda_{21} = 2.0 \\text{ min}^{-1}$。\n- 从“联系我们页”到“主页”：速率 $\\lambda_{31} = 4.0 \\text{ min}^{-1}$。\n所有其他不同状态之间的转移速率均为零。\n\nCTMC 的转移概率 $p_{ij}(t)$ 可以使用均匀化方法计算，其精确表达式为：\n$$p_{ij}(t) = \\sum_{n=0}^{\\infty} e^{-\\Lambda t} \\frac{(\\Lambda t)^n}{n!} (R^{n})_{ij}$$\n这里，$\\Lambda$ 是一个均匀化速率，其选择需满足 $\\Lambda \\ge \\max_{k} |q_{kk}|$，其中 $q_{kk}$ 是生成元矩阵 $Q$ 的对角线元素。矩阵 $R$ 是一个关联的离散时间马尔可夫链的转移矩阵，由 $R = I + \\frac{1}{\\Lambda}Q$ 给出，其中 $I$ 是单位矩阵。项 $(R^n)_{ij}$ 表示矩阵 $R^n$ 的第 $(i, j)$ 个元素。\n\n通过截断这个无穷级数，我们可以得到一个近似值。计算用户在时间 $t$ 处于“产品页”的概率的近似表达式，已知他们从“主页”开始。你的近似值应通过仅对均匀化级数的前两项（即 $n=0$ 和 $n=1$ 的项）求和来确定。使用均匀化速率 $\\Lambda$ 的最小可能值。将你的最终答案表示为时间 $t$ 的解析函数，其中 $t$ 的单位是分钟。", "solution": "我们将该导航行为建模为一个具有生成元矩阵 $Q$ 的连续时间马尔可夫链。根据给定的速率，非零的非对角线元素为 $q_{12}=3$，$q_{13}=1$，$q_{21}=2$ 和 $q_{31}=4$。对角线元素由 $q_{ii}=-\\sum_{j\\neq i}q_{ij}$ 确定，得出 $q_{11}=-(3+1)=-4$，$q_{22}=-2$ 和 $q_{33}=-4$。因此，\n$$\nQ=\\begin{pmatrix}\n-4 & 3 & 1\\\\\n2 & -2 & 0\\\\\n4 & 0 & -4\n\\end{pmatrix}.\n$$\n均匀化速率必须满足 $\\Lambda\\ge\\max_{k}|q_{kk}|$，因此最小的可能选择是 $\\Lambda=4$。定义 $R=I+\\frac{1}{\\Lambda}Q=I+\\frac{1}{4}Q$。代入 $Q$ 并化简可得\n$$\nR=\\begin{pmatrix}\n1+\\frac{1}{4}(-4) & \\frac{1}{4}\\cdot 3 & \\frac{1}{4}\\cdot 1\\\\\n\\frac{1}{4}\\cdot 2 & 1+\\frac{1}{4}(-2) & 0\\\\\n\\frac{1}{4}\\cdot 4 & 0 & 1+\\frac{1}{4}(-4)\n\\end{pmatrix}\n=\\begin{pmatrix}\n0 & \\frac{3}{4} & \\frac{1}{4}\\\\\n\\frac{1}{2} & \\frac{1}{2} & 0\\\\\n1 & 0 & 0\n\\end{pmatrix}.\n$$\n转移概率的均匀化公式为\n$$\np_{ij}(t)=\\sum_{n=0}^{\\infty}\\exp(-\\Lambda t)\\,\\frac{(\\Lambda t)^{n}}{n!}\\,(R^{n})_{ij}.\n$$\n截取前两项（$n=0$ 和 $n=1$）可得近似值\n$$\np_{12}(t)\\approx \\exp(-\\Lambda t)\\left[\\frac{(\\Lambda t)^{0}}{0!}(R^{0})_{12}+\\frac{(\\Lambda t)^{1}}{1!}(R^{1})_{12}\\right].\n$$\n由于 $R^{0}=I$，我们有 $(R^{0})_{12}=0$，且 $(R^{1})_{12}=R_{12}=\\frac{3}{4}$。使用 $\\Lambda=4$，我们得到\n$$\np_{12}(t)\\approx \\exp(-4 t)\\left[0+4 t\\cdot \\frac{3}{4}\\right]=3 t\\,\\exp(-4 t).\n$$\n这就是所要求的，从主页开始，在时间 $t$ 处于产品页的概率的解析近似值，该近似值使用了均匀化级数的前两项和最小的均匀化速率。", "answer": "$$\\boxed{3 t \\exp(-4 t)}$$", "id": "1348067"}]}