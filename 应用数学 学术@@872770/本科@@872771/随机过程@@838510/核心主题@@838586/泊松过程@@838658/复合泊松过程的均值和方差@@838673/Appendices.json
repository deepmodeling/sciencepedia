{"hands_on_practices": [{"introduction": "复合泊松过程在质量控制和制造业等领域有着广泛的应用。这个练习提供了一个具体的场景：光纤电缆的生产。通过计算因缺陷而丢弃的总长度的期望和方差，我们可以练习如何将理论公式应用于实际问题，特别是当事件的影响（即“跳跃”的大小）遵循连续均匀分布时。[@problem_id:1317648]", "problem": "在一家光纤电缆制造工厂，发现缺陷会沿着电缆的长度随机出现。这些缺陷的出现可以被建模为一个泊松过程，其速率恒为每公里 $\\lambda$ 个缺陷。每当检测到一个缺陷时，包含该缺陷的一段电缆就会被切除并丢弃。每个被丢弃段的长度是一个独立的随机变量，在区间 $[a, b]$ 上服从均匀分布，其中 $a$ 和 $b$ 是表示公里长度的正数常量。\n\n考虑一根新制造的总长度为 $L$ 公里的电缆。设 $S$ 为因缺陷而从这段电缆中丢弃的总长度。确定总丢弃长度 $S$ 的期望值和方差。你的答案应以给定参数 $\\lambda, L, a$ 和 $b$ 表示。", "solution": "设 $N$ 表示在长度为 $L$ 的电缆上出现的缺陷数量。因为缺陷遵循一个速率恒为每公里 $\\lambda$ 个缺陷的泊松过程，所以在长度 $L$ 上的缺陷数量 $N$ 服从参数为 $\\lambda L$ 的泊松分布，即 $N \\sim \\text{Poisson}(\\lambda L)$。每个缺陷导致丢弃一个独立的段，其长度为 $X$，其中 $X \\sim \\text{Uniform}[a,b]$，并且与 $N$ 及其他的 $X_i$ 独立。总丢弃长度是随机和 $S=\\sum_{i=1}^{N} X_{i}$。\n\n首先计算 $X$ 的前两阶矩。对于 $X \\sim \\text{Uniform}[a,b]$，其在 $[a,b]$ 上的密度函数为 $f(x)=\\frac{1}{b-a}$，\n$$\n\\mathbb{E}[X]=\\int_{a}^{b} x \\frac{1}{b-a} \\, dx=\\frac{b^{2}-a^{2}}{2(b-a)}=\\frac{a+b}{2},\n$$\n$$\n\\mathbb{E}[X^{2}]=\\int_{a}^{b} x^{2} \\frac{1}{b-a} \\, dx=\\frac{b^{3}-a^{3}}{3(b-a)}=\\frac{a^{2}+ab+b^{2}}{3}.\n$$\n因此\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{a^{2}+ab+b^{2}}{3}-\\left(\\frac{a+b}{2}\\right)^{2}=\\frac{(b-a)^{2}}{12}.\n$$\n\n以 $N=n$ 为条件。因为 $X_{i}$ 是独立同分布的且与 $N$ 独立，\n$$\n\\mathbb{E}[S \\mid N=n]=n\\,\\mathbb{E}[X]=n\\,\\frac{a+b}{2}, \\quad \\operatorname{Var}(S \\mid N=n)=n\\,\\operatorname{Var}(X)=n\\,\\frac{(b-a)^{2}}{12}.\n$$\n使用全期望定律和全方差定律，以及对于泊松随机变量 $\\mathbb{E}[N]=\\operatorname{Var}(N)=\\lambda L$ 这个事实，\n$$\n\\mathbb{E}[S]=\\mathbb{E}[\\mathbb{E}[S \\mid N]]=\\mathbb{E}[N]\\,\\mathbb{E}[X]=\\lambda L \\cdot \\frac{a+b}{2},\n$$\n$$\n\\operatorname{Var}(S)=\\mathbb{E}[\\operatorname{Var}(S \\mid N)]+\\operatorname{Var}(\\mathbb{E}[S \\mid N])=\\mathbb{E}[N]\\operatorname{Var}(X)+\\operatorname{Var}(N)\\left(\\mathbb{E}[X]\\right)^{2}.\n$$\n代入 $\\mathbb{E}[N]=\\operatorname{Var}(N)=\\lambda L$、$\\operatorname{Var}(X)=\\frac{(b-a)^{2}}{12}$ 和 $\\mathbb{E}[X]=\\frac{a+b}{2}$ 可得\n$$\n\\operatorname{Var}(S)=\\lambda L\\left(\\frac{(b-a)^{2}}{12}+\\left(\\frac{a+b}{2}\\right)^{2}\\right)=\\lambda L \\cdot \\frac{a^{2}+ab+b^{2}}{3}.\n$$\n因此，\n$$\n\\mathbb{E}[S]=\\lambda L \\cdot \\frac{a+b}{2}, \\quad \\operatorname{Var}(S)=\\lambda L \\cdot \\frac{a^{2}+ab+b^{2}}{3}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\lambda L \\frac{a+b}{2} \\\\ \\lambda L \\frac{a^{2}+ab+b^{2}}{3} \\end{pmatrix}}$$", "id": "1317648"}, {"introduction": "从工程学转向生物学，我们看到复合泊松过程同样是模拟基因突变等自然现象的有力工具。本练习探讨了DNA链上突变的总效应，其中每次突变影响的碱基对数量是离散的几何随机变量。这有助于我们熟练处理离散跳跃分布的情况，并加深对模型普适性的理解。[@problem_id:1317642]", "problem": "在一个简化的基因组学模型中，自发突变沿着DNA链发生，该过程服从一个泊松过程，其速率为常数 $\\lambda$ 个事件/单位时间。每个突变事件会影响一定数量的碱基对。单个突变所影响的碱基对数量，我们称之为 $Y$，是一个随机变量。我们假设不同突变所影响的片段长度是独立同分布的。$Y$ 的分布是参数为 $p \\in (0, 1)$ 的几何分布，其概率质量函数为 $P(Y=k) = (1-p)^{k-1}p$，其中 $k = 1, 2, 3, \\dots$。\n\n设 $S(t)$ 为截至时间 $t$ 已发生的所有突变所影响的碱基对总数。求出该总数的均值 $\\mathbb{E}[S(t)]$ 和方差 $\\operatorname{Var}(S(t))$。", "solution": "设 $N(t)$ 表示截至时间 $t$ 的突变事件数。根据假设，$N(t)$ 是一个速率为 $\\lambda$ 的泊松过程，因此 $N(t) \\sim \\text{Poisson}(\\lambda t)$。设 $\\{Y_{i}\\}_{i \\geq 1}$ 是 $Y$ 的独立同分布副本，与 $N(t)$ 独立，且 $P(Y=k)=(1-p)^{k-1}p$，其中 $k \\in \\{1,2,\\dots\\}$。截至时间 $t$ 受影响的碱基对总数为\n$$\nS(t)=\\sum_{i=1}^{N(t)} Y_{i},\n$$\n约定当 $N(t)=0$ 时空和为零。这是一个复合泊松模型。\n\n首先计算 $Y$ 的矩。对 $|r|1$ 使用幂级数 $\\sum_{k=1}^{\\infty} k r^{k-1}=\\frac{1}{(1-r)^{2}}$，并令 $r=1-p$，我们得到\n$$\n\\mathbb{E}[Y]=\\sum_{k=1}^{\\infty} k (1-p)^{k-1} p = p \\sum_{k=1}^{\\infty} k r^{k-1} = p \\cdot \\frac{1}{(1-r)^{2}}=\\frac{1}{p}.\n$$\n对于二阶矩，使用 $\\sum_{k=2}^{\\infty} k(k-1) r^{k-2}=\\frac{2}{(1-r)^{3}}$，因此 $\\sum_{k=2}^{\\infty} k(k-1) r^{k-1}=\\frac{2r}{(1-r)^{3}}$。所以\n$$\n\\mathbb{E}[Y(Y-1)]=\\sum_{k=2}^{\\infty} k(k-1) (1-p)^{k-1} p = p \\cdot \\frac{2r}{(1-r)^{3}}=\\frac{2(1-p)}{p^{2}},\n$$\n于是\n$$\n\\mathbb{E}[Y^{2}]=\\mathbb{E}[Y(Y-1)]+\\mathbb{E}[Y]=\\frac{2(1-p)}{p^{2}}+\\frac{1}{p}=\\frac{2-p}{p^{2}},\n$$\n从而\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-(\\mathbb{E}[Y])^{2}=\\frac{2-p}{p^{2}}-\\frac{1}{p^{2}}=\\frac{1-p}{p^{2}}.\n$$\n\n对 $S(t)$ 使用全期望定律：\n$$\n\\mathbb{E}[S(t)]=\\mathbb{E}\\big[\\mathbb{E}[S(t)\\mid N(t)]\\big].\n$$\n给定 $N(t)=n$，$S(t)$ 是 $n$ 个独立同分布的 $Y_{i}$ 之和，所以 $\\mathbb{E}[S(t)\\mid N(t)=n]=n\\,\\mathbb{E}[Y]$。因此\n$$\n\\mathbb{E}[S(t)]=\\mathbb{E}[N(t)]\\,\\mathbb{E}[Y]=(\\lambda t)\\cdot \\frac{1}{p}=\\frac{\\lambda t}{p}.\n$$\n\n使用全方差定律：\n$$\n\\operatorname{Var}(S(t))=\\mathbb{E}\\big[\\operatorname{Var}(S(t)\\mid N(t))\\big]+\\operatorname{Var}\\big(\\mathbb{E}[S(t)\\mid N(t)]\\big).\n$$\n给定 $N(t)=n$，$\\operatorname{Var}(S(t)\\mid N(t)=n)=n\\,\\operatorname{Var}(Y)$。因此\n$$\n\\mathbb{E}\\big[\\operatorname{Var}(S(t)\\mid N(t))\\big]=\\mathbb{E}[N(t)]\\,\\operatorname{Var}(Y)=\\lambda t \\cdot \\frac{1-p}{p^{2}}.\n$$\n此外，\n$$\n\\operatorname{Var}\\big(\\mathbb{E}[S(t)\\mid N(t)]\\big)=\\operatorname{Var}\\big(N(t)\\,\\mathbb{E}[Y]\\big)=(\\mathbb{E}[Y])^{2}\\operatorname{Var}(N(t))=\\left(\\frac{1}{p}\\right)^{2}\\cdot \\lambda t=\\frac{\\lambda t}{p^{2}}.\n$$\n将这两部分贡献相加得到\n$$\n\\operatorname{Var}(S(t))=\\lambda t \\cdot \\frac{1-p}{p^{2}}+\\frac{\\lambda t}{p^{2}}=\\lambda t \\cdot \\frac{2-p}{p^{2}}.\n$$\n\n等价地，使用复合泊松恒等式 $\\operatorname{Var}(S(t))=\\lambda t\\,\\mathbb{E}[Y^{2}]$ 以及 $\\mathbb{E}[Y^{2}]=\\frac{2-p}{p^{2}}$ 会得到相同的结果。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\lambda t}{p} \\\\ \\frac{\\lambda t(2 - p)}{p^{2}} \\end{pmatrix}}$$", "id": "1317642"}, {"introduction": "在掌握了如何计算任意时刻的总量的均值和方差后，一个更深入的问题是：过程在不同时间点的状态之间有何关联？这个问题将我们的分析从单个时间点扩展到过程的时间演化，通过计算两个不同时刻累计利润的相关系数，来探索复合泊松过程的内在结构。解决这个问题需要运用该过程的独立增量特性，这是一个核心且深刻的概念。[@problem_id:1290820]", "problem": "一家金融科技公司使用随机过程对其一种高频交易算法产生的累计利润进行建模。到时间 $t$ 为止的总利润，记为 $X(t)$，由一个复合泊松过程描述。该过程定义为 $X(t) = \\sum_{i=1}^{N(t)} Y_i$，其中 $N(t)$ 是一个泊松过程，用于计算已执行的交易数量，而 $Y_i$ 是每笔独立交易的利润。\n\n交易数量 $N(t)$ 以每单位时间 $\\lambda  0$ 次交易的恒定平均速率发生。利润 $\\{Y_i\\}_{i\\geq1}$ 是一个独立同分布 (i.i.d.) 的随机变量序列，它们也独立于过程 $N(t)$。每笔交易的平均利润为 $\\mathbb{E}[Y_i] = \\mu_Y$，每笔交易利润的方差为 $\\operatorname{Var}(Y_i) = \\sigma_Y^2$。为确保该过程不是平凡的，假设跳跃分布是非退化的，这意味着 $\\mathbb{E}[Y_i^2] > 0$。\n\n考虑两个时间点 $t_1$ 和 $t_2$，满足 $0  t_1  t_2$。您的任务是确定在时间 $t_1$ 的累计利润和时间 $t_2$ 的累计利润之间的相关系数 $\\rho(X(t_1), X(t_2))$。\n\n请用一个关于 $t_1$ 和 $t_2$ 的封闭形式解析表达式给出您的答案。", "solution": "令 $X(t)=\\sum_{i=1}^{N(t)}Y_{i}$ 为一个复合泊松过程，其速率为 $\\lambda>0$，其中 $\\{Y_{i}\\}$ 是独立同分布的，独立于 $N(t)$，且 $\\mathbb{E}[Y_{i}]=\\mu_{Y}$ 和 $\\operatorname{Var}(Y_{i})=\\sigma_{Y}^{2}$。对于 $0  t_1  t_2$，我们要计算相关系数 $\\rho(X(t_1), X(t_2)) = \\frac{\\operatorname{Cov}(X(t_1), X(t_2))}{\\sqrt{\\operatorname{Var}(X(t_1))\\operatorname{Var}(X(t_2))}}$。\n\n首先，我们计算协方差 $\\operatorname{Cov}(X(t_1), X(t_2))$。我们可以将 $X(t_2)$ 分解为 $X(t_1)$ 和在时间间隔 $(t_1, t_2]$ 内的增量之和：\n$$\nX(t_2) = X(t_1) + \\left(X(t_2) - X(t_1)\\right)\n$$\n复合泊松过程具有独立增量特性，这意味着在不相交的时间间隔内的过程增量是相互独立的。因此，$X(t_1)$ 与增量 $X(t_2) - X(t_1)$ 是独立的。\n\n利用协方差的双线性性质：\n$$\n\\operatorname{Cov}(X(t_1), X(t_2)) = \\operatorname{Cov}(X(t_1), X(t_1) + X(t_2) - X(t_1))\n$$\n$$\n= \\operatorname{Cov}(X(t_1), X(t_1)) + \\operatorname{Cov}(X(t_1), X(t_2) - X(t_1))\n$$\n因为 $X(t_1)$ 和 $X(t_2) - X(t_1)$ 独立，它们的协方差为零。所以：\n$$\n\\operatorname{Cov}(X(t_1), X(t_2)) = \\operatorname{Var}(X(t_1)) + 0 = \\operatorname{Var}(X(t_1))\n$$\n\n接下来，我们使用复合泊松过程的方差公式 $\\operatorname{Var}(X(t)) = \\lambda t \\mathbb{E}[Y^2]$。\n$$\n\\operatorname{Var}(X(t_1)) = \\lambda t_1 \\mathbb{E}[Y^2]\n$$\n$$\n\\operatorname{Var}(X(t_2)) = \\lambda t_2 \\mathbb{E}[Y^2]\n$$\n将这些代入相关系数的定义中：\n$$\n\\rho(X(t_1), X(t_2)) = \\frac{\\operatorname{Var}(X(t_1))}{\\sqrt{\\operatorname{Var}(X(t_1))\\operatorname{Var}(X(t_2))}} = \\frac{\\lambda t_1 \\mathbb{E}[Y^2]}{\\sqrt{(\\lambda t_1 \\mathbb{E}[Y^2])(\\lambda t_2 \\mathbb{E}[Y^2])}}\n$$\n由于假设 $\\mathbb{E}[Y_i^2] > 0$ 且 $\\lambda > 0$，所以 $\\lambda \\mathbb{E}[Y^2]$ 是一个正的常数，可以从分子和分母中约去：\n$$\n\\rho(X(t_1), X(t_2)) = \\frac{t_1 \\lambda \\mathbb{E}[Y^2]}{\\sqrt{t_1 t_2} \\lambda \\mathbb{E}[Y^2]} = \\frac{t_1}{\\sqrt{t_1 t_2}} = \\sqrt{\\frac{t_1^2}{t_1 t_2}} = \\sqrt{\\frac{t_1}{t_2}}\n$$\n因此，相关系数是 $\\sqrt{\\frac{t_1}{t_2}}$。", "answer": "$$\\boxed{\\sqrt{\\frac{t_{1}}{t_{2}}}}$$", "id": "1290820"}]}