{"hands_on_practices": [{"introduction": "本练习使用一个简单直观的场景——谣言在朋友圈中传播——来帮助您将可达性和互通性的概念形象化。通过分析这个封闭系统，您将对“不可约”系统（即可以从任何状态到达任何其他状态）的含义有基本的了解。", "problem": "四个个体，标记为1、2、3和4，排成一个圆形。这种排列方式使得个体1与个体2和4相邻；个体2与个体1和3相邻；个体3与个体2和4相邻；个体4与个体3和1相邻。\n\n一个谣言在这四个人之间传递。这个过程被建模为一个离散时间马尔可夫链，其中系统在任何时间步的状态是当前拥有谣言的个体的标签。在每个时间步，持有谣言的人以相等的概率将其传递给他们的两个直接邻居中的一个。传递谣言的人不再拥有它。\n\n我们定义状态关系如下：\n- 如果可以以非零概率在有限步内从状态$i$转换到状态$j$，则称状态$j$可从状态$i$**到达**（accessible）。\n- 如果状态$j$可从状态$i$到达，并且状态$i$可从状态$j$到达，则两个状态$i$和$j$**互通**（communicate）。\n- 一个**互通类**（communication class）是一个状态集合，其中集合内的每一对状态都相互互通，并且集合中的任何状态都不与集合外的任何状态互通。\n\n基于这个模型，以下哪个陈述是正确的？\n\nA. 状态3可从状态1到达，但状态1不可从状态3到达。\n\nB. 系统是可约的（reducible），有两个不同的互通类：{1, 3}和{2, 4}。\n\nC. 状态4不可从状态2到达。\n\nD. 系统中的所有状态都属于同一个互通类。\n\nE. 系统有三个或更多不同的互通类。", "solution": "设马尔可夫链的状态空间为 $S = \\{1, 2, 3, 4\\}$，其中状态表示拥有谣言的人。我们需要分析这些状态之间的可达性和互通性。\n\n首先，我们来确定一步转移概率。在每一步中，一个人以 $1/2$ 的概率将谣言传递给他们的两个邻居中的一个。\n- 从状态1，系统可以转移到状态2或状态4。所以，$P(X_{n+1}=2 | X_n=1) = 1/2$ 且 $P(X_{n+1}=4 | X_n=1) = 1/2$。\n- 从状态2，系统可以转移到状态1或状态3。所以，$P(X_{n+1}=1 | X_n=2) = 1/2$ 且 $P(X_{n+1}=3 | X_n=2) = 1/2$。\n- 从状态3，系统可以转移到状态2或状态4。所以，$P(X_{n+1}=2 | X_n=3) = 1/2$ 且 $P(X_{n+1}=4 | X_n=3) = 1/2$。\n- 从状态4，系统可以转移到状态3或状态1。所以，$P(X_{n+1}=3 | X_n=4) = 1/2$ 且 $P(X_{n+1}=1 | X_n=4) = 1/2$。\n所有其他的一步转移概率均为零。\n\n现在，我们评估所有状态对之间的可达性和互通性。如果状态$i$可从状态$j$到达（$j \\to i$）且状态$j$可从状态$i$到达（$i \\to j$），则两个状态$i$和$j$互通，记作 $i \\leftrightarrow j$。\n\n让我们先检查相邻状态的互通性。\n- $1 \\to 2$ 可以在一步内以 $1/2$ 的概率实现。\n- $2 \\to 1$ 可以在一步内以 $1/2$ 的概率实现。\n因为它们可以相互到达，所以状态1和2互通：$1 \\leftrightarrow 2$。\n根据同样的逻辑，对于圆上的所有相邻对：\n- $2 \\leftrightarrow 3$（因为 $2 \\to 3$ 和 $3 \\to 2$ 是一步转移）。\n- $3 \\leftrightarrow 4$（因为 $3 \\to 4$ 和 $4 \\to 3$ 是一步转移）。\n- $4 \\leftrightarrow 1$（因为 $4 \\to 1$ 和 $1 \\to 4$ 是一步转移）。\n\n互通关系是一种等价关系。这意味着它是自反的（$i \\leftrightarrow i$）、对称的（如果 $i \\leftrightarrow j$，那么 $j \\leftrightarrow i$）和传递的（如果 $i \\leftrightarrow j$ 且 $j \\leftrightarrow k$，那么 $i \\leftrightarrow k$）。\n使用传递性：\n- 我们有 $1 \\leftrightarrow 2$ 和 $2 \\leftrightarrow 3$。因此，$1 \\leftrightarrow 3$。\n- 我们有 $1 \\leftrightarrow 3$ 和 $3 \\leftrightarrow 4$。因此，$1 \\leftrightarrow 4$。\n\n由于集合 $\\{1, 2, 3, 4\\}$ 中的每个状态都与集合中的其他每个状态互通，所以它们都属于同一个互通类。只有一个互通类的马尔可夫链称为不可约的（irreducible）。\n\n现在我们来评估给定的选项：\nA. 状态3可从状态1到达，但状态1不可从状态3到达。这是错误的。我们证明了 $1 \\leftrightarrow 3$。可达性是双向的。例如，从1到3的一条路径是 $1 \\to 2 \\to 3$，其非零概率为 $(1/2) \\times (1/2) = 1/4$。从3到1的一条路径是 $3 \\to 2 \\to 1$，其概率为 $(1/2) \\times (1/2) = 1/4$。\n\nB. 系统是可约的，有两个不同的互通类：{1, 3} 和 {2, 4}。这是错误的。从状态1（在{1, 3}中）到状态2（在{2, 4}中）的转移可以在一步内发生。如果它们是独立的互通类，这种转移是不可能的。\n\nC. 状态4不可从状态2到达。这是错误的。从2到4的一条可能路径是 $2 \\to 1 \\to 4$。这个两步转移的概率是 $(1/2) \\times (1/2) = 1/4$，是非零的。因此，状态4可从状态2到达。\n\nD. 系统中的所有状态都属于同一个互通类。这是正确的。如上所示，系统中的每个状态都与所有其他状态互通。\n\nE. 系统有三个或更多不同的互通类。这是错误的。因为只有4个状态，并且我们已经证明它们都构成一个类，所以这是不可能的。\n\n因此，唯一正确的陈述是D。", "answer": "$$\\boxed{D}$$", "id": "1280486"}, {"introduction": "现实世界中的系统通常包含单向路径；本练习模拟用户浏览网站的过程来探讨这种情况 [@problem_id:1280491]。您将分析缺少返回路径如何影响状态之间的互通性，并由此识别瞬时状态和吸收状态。这个问题对于理解可约链至关重要，在可约链中，状态空间被划分为多个类。", "problem": "一个用户正在浏览一个由三个页面组成的简单网站：主页、关于页面和联系页面。该网站上的导航被建模为一个离散时间随机过程，其中页面是状态。\n\n用户的导航受到页面上链接的限制：\n- 从主页，有一个指向关于页面的链接。在每个时间步，主页上的用户要么点击此链接，要么停留在主页。\n- 从关于页面，有一个指向联系页面的链接。在每个时间步，关于页面上的用户要么点击此链接，要么停留在关于页面。\n- 联系页面不包含任何出站链接，因此到达该页面的用户将无限期地停留在那里。\n\n用户点击可用链接的概率被认为是非零的。设状态由 H (主页)、A (关于) 和 C (联系) 表示。如果可以在有限步内从状态 $i$ 到达状态 $j$，则称状态 $j$ 是从状态 $i$ *可达的*。如果状态 $i$ 从状态 $j$ 可达，并且状态 $j$ 从状态 $i$ 可达，则两个状态 $i$ 和 $j$ 是*互通的*。互通是一种等价关系，它将状态空间划分为称为*互通类*的不相交集合。\n\n关于该系统状态的以下陈述中，哪些是正确的？选择所有有效选项。\n\nA. 所有三个状态 (H, A, C) 相互互通。\n\nB. 状态空间构成一个单一的互通类。\n\nC. 互通类是 {H}、{A} 和 {C}。\n\nD. 状态 C 从状态 H 可达，但状态 H 从状态 C 不可达。\n\nE. 状态 H 和 A 相互互通，但与状态 C 不互通。", "solution": "我们将导航建模为具有状态 $H$、$A$ 和 $C$ 的离散时间马尔可夫链。允许的转移（在有链接存在的情况下，每个转移的概率都非零）如下：\n- 从 $H$：$H \\to H$ (停留) 和 $H \\to A$ (点击链接)。\n- 从 $A$：$A \\to A$ (停留) 和 $A \\to C$ (点击链接)。\n- 从 $C$：仅 $C \\to C$ (吸收态，无出站链接)。\n\n可达性：如果存在一个从 $i$ 到 $j$ 的具有正概率的有限允许转移序列，则状态 $j$ 从 $i$ 可达。\n- $A$ 从 $H$ 可达，通过一步路径 $H \\to A$。\n- $C$ 从 $A$ 可达，通过一步路径 $A \\to C$。\n- $C$ 从 $H$ 可达，通过两步路径 $H \\to A \\to C$。\n- $H$ 从 $A$ 不可达：从 $A$ 只能移动到 $A$ 或 $C$，没有 $A \\to H$ 的转移；一旦到达 $C$，就无法离开 $C$。\n- $H$ 和 $A$ 都从 $C$ 不可达，因为 $C$ 只转移到自身。\n- 每个状态都从自身可达：$H \\to H$，$A \\to A$ 具有正概率，而 $C \\to C$ 的概率为 $1$。\n\n互通性：如果状态 $i$ 和 $j$ 相互可达，则它们互通。\n- $H$ 和 $A$ 不互通：$A$ 从 $H$ 可达，但 $H$ 从 $A$ 不可达。\n- $H$ 和 $C$ 不互通：$C$ 从 $H$ 可达，但 $H$ 从 $C$ 不可达。\n- $A$ 和 $C$ 不互通：$C$ 从 $A$ 可达，但 $A$ 从 $C$ 不可达。\n\n因此，互通类是单元素集 $\\{H\\}$、$\\{A\\}$ 和 $\\{C\\}$。\n\n验证选项：\n- A 是错误的 (不同状态之间没有一对是互通的)。\n- B 是错误的 (有三个不同的互通类，而不是一个)。\n- C 是正确的 (互通类是 $\\{H\\}$、$\\{A\\}$ 和 $\\{C\\}$)。\n- D 是正确的 ($C$ 从 $H$ 可达，但反之不然)。\n- E 是错误的 ($H$ 和 $A$ 不互通)。", "answer": "$$\\boxed{CD}$$", "id": "1280491"}, {"introduction": "本练习要求您将一个真实的商业场景转化为一个正式的马尔可夫链模型，这对任何实践者来说都是一项关键技能 [@problem_id:1280482]。通过根据补货政策确定转移概率，您将把状态分为瞬时或常返（吸收）状态，从而揭示面包店蛋糕库存的长期结局。这个练习巩固了您分析给定系统以及根据描述构建模型的能力。", "problem": "一家小型特色面包店出售一种特定类型的蛋糕。他们在任何一天开始时可以拥有的最大蛋糕库存数量为2。系统的状态是每天开始时的蛋糕库存数量，可以是0、1或2。\n\n蛋糕的每日需求是随机的。需求为零的概率是0.2，需求为一个蛋糕的概率是0.5，需求为两个或更多蛋糕的概率是0.3。任何超过库存量的需求都会导致所有可用蛋糕售出。\n\n面包店在每天结束时遵循特定的补货策略：\n1. 如果日终库存为零，面包店将永久停止销售该类型的蛋糕，未来所有日子的库存都将为0。\n2. 如果日终库存大于零，面包店将在第二天开始时补货至最大容量2个蛋糕。\n\n设状态 $i$ 对应于一天开始时有 $i$ 个蛋糕的库存。根据这个模型，以下哪个陈述是正确的？\n\nA. 状态1是一个常返状态。\n\nB. 从状态2开始，库存不可能达到0。\n\nC. 状态1和状态2是互通的（即，可以从状态1到状态2，也可以从状态2到状态1）。\n\nD. 状态0是一个瞬时状态。\n\nE. 状态1和状态2都是瞬时状态。", "solution": "将每日开始时的库存建模为具有状态空间 $\\{0,1,2\\}$ 的马尔可夫链。设需求 $D$ 的分布为 $\\Pr(D=0)=0.2$，$\\Pr(D=1)=0.5$，$\\Pr(D\\ge 2)=0.3$。在一天结束时，如果日终库存为 $0$，则该过程将永久停止，所有未来的起始库存都为 $0$；如果日终库存为正，则面包店为第二天补货至 $2$。\n\n从状态 $0$ 开始，该过程是吸收的：\n$$P_{00}=1,\\quad P_{01}=0,\\quad P_{02}=0.$$\n\n从状态 $1$ 开始，如果 $D=0$（概率 $0.2$），日终库存为 $1>0$，则下一个起始库存为 $2$；如果 $D\\ge 1$（概率 $0.8$），所有库存售出，下一个起始库存为 $0$。因此\n$$P_{10}=0.8,\\quad P_{11}=0,\\quad P_{12}=0.2.$$\n\n从状态 $2$ 开始，如果 $D\\ge 2$（概率 $0.3$），所有库存售出，下一个起始库存为 $0$；如果 $D=0$ 或 $1$（合并概率 $0.7$），日终库存为正，下一个起始库存为 $2$。因此\n$$P_{20}=0.3,\\quad P_{21}=0,\\quad P_{22}=0.7.$$\n\n因此\n$$P=\\begin{pmatrix}\n1   0  0\\\\\n0.8  0  0.2\\\\\n0.3  0  0.7\n\\end{pmatrix}.$$\n\n对状态进行分类并评估陈述：\n\n- 状态 $0$ 是吸收状态，自身形成一个闭类，因此它是常返的。所以陈述 D（状态 0 是瞬时的）是错误的。\n\n- 从状态 $2$ 开始，$\\Pr(2\\to 0)=0.3>0$，因此可以达到 $0$。所以陈述 B 是错误的。\n\n- 状态 $1$ 和 $2$ 不互通：$1\\to 2$ 在一步内是可能的，概率为 $0.2$，但 $2\\to 1$ 是不可能的，因为 $P_{21}=0$，并且从 $2$ 开始，唯一可能的下一个状态是 $2$ 和 $0$，其中 $0$ 是吸收状态。所以陈述 C 是错误的。\n\n- 状态 $1$ 不是常返的：从 $1$ 开始，下一个状态要么是 $2$ 要么是 $0$；从任何状态都没有回到 $1$ 的路径，所以返回到 $1$ 的概率是 $0$。因此陈述 A（状态 1 是常返的）是错误的。\n\n- 状态 $2$ 是瞬时的：从 $2$ 开始，在未来某个时间返回到 $2$ 的唯一方法是在下一步保持在 $2$，这发生的概率为 $0.7$；如果它转到 $0$（概率 $0.3$），它将被吸收并且永远无法返回。因此，由于存在通往吸收态$0$的逃逸路径，状态 $2$ 是瞬时的。加上状态 $1$ 的瞬时性，陈述 E 是正确的。\n\n因此，正确选项是 E。", "answer": "$$\\boxed{E}$$", "id": "1280482"}]}