{"hands_on_practices": [{"introduction": "让我们从一个直观的例子开始，追踪一本图书馆书籍的生命周期。这个练习将向您介绍“首步分析法”，这是一种计算随机过程最终结果的强大工具。通过只关注下一步的可能性，我们可以建立一个简单的代数方程来求解一个状态是否最终会被访问的概率 [@problem_id:1326112]。", "problem": "一所大学图书馆使用离散时间随机过程来模拟一本书的生命周期。每天观察一本书的状态，可分为四种状态之一：“在架”(S)、“已借出”(C)、“在途”(T，指正在归还和处理中的书籍)和“丢失”(L)。\n\n从一天到下一天的转移概率如下：\n- 一本“在架”的书在第二天被“借出”的概率为1.0。\n- 一本“已借出”的书有0.2的概率续借（保持“已借出”状态），有0.75的概率被归还（变为“在途”），有0.05的概率被宣布“丢失”。\n- 一本“在途”的书有0.8的概率被成功地放回“在架”，有0.15的概率因需进一步处理而保持“在途”状态，有0.05的概率变为“丢失”。\n- 一本“丢失”的书将无限期地保持“丢失”状态。\n\n一本新书被捐赠给图书馆，其初始状态为“在途”。这本书最终能到达“在架”状态的概率是多少？请用精确分数表示你的答案。", "solution": "将每日的状态建模为一个马尔可夫链，其状态为 $S$ (在架)、$C$ (已借出)、$T$ (在途)和 $L$ (丢失)。我们需要求的是从 $T$ 状态开始，该链至少访问一次 $S$ 状态的概率。\n\n设 $x_{T}$ 表示从 $T$ 开始最终能到达 $S$ 的概率。从状态 $T$ 开始使用首步分析法：\n- 以概率 $0.8$ 进入下一个状态 $S$，这算作成功，贡献为 $1$。\n- 以概率 $0.15$ 再次进入状态 $T$，之后成功的概率仍然是 $x_{T}$。\n- 以概率 $0.05$ 进入下一个状态 $L$，从该状态永远无法到达 $S$，贡献为 $0$。\n\n因此，\n$$\nx_{T} = 0.8 \\cdot 1 + 0.15 \\cdot x_{T} + 0.05 \\cdot 0.\n$$\n求解，\n$$\nx_{T} - 0.15 x_{T} = 0.8 \\quad \\Longrightarrow \\quad 0.85 x_{T} = 0.8 \\quad \\Longrightarrow \\quad x_{T} = \\frac{0.8}{0.85} = \\frac{80}{85} = \\frac{16}{17}.\n$$\n因此，这本捐赠的书最终能到达“在架”状态的概率是 $\\frac{16}{17}$。", "answer": "$$\\boxed{\\frac{16}{17}}$$", "id": "1326112"}, {"introduction": "许多现实世界系统涉及多个相互作用的状态和竞争性的结果。这个关于天气模式的练习将首步分析法扩展到一个更复杂的场景，您需要建立并求解一个线性方程组。通过这个过程，您将学会如何计算在一个吸收态（“风暴”）出现之前，到达目标态（另一个“晴天”）的概率 [@problem_id:1326137]。", "problem": "一个偏远岛屿的简化气象模型描述了每日的天气模式。任何一天的天气可以是四种类型之一：'晴天' (Sunny)、'多云' (Cloudy)、'雨天' (Rainy) 或 '风暴' (Storm)。该模型由以下每日转移概率控制：\n\n-   如果是晴天，则第二天的天气为晴天、多云或雨天的概率分别为 $0.5$、$0.4$ 和 $0.1$。\n-   如果是多云，则第二天的天气为晴天、多云、雨天或风暴的概率分别为 $0.3$、$0.4$、$0.2$ 和 $0.1$。\n-   如果是雨天，则第二天的天气为晴天、多云、雨天或风暴的概率分别为 $0.1$、$0.3$、$0.2$ 和 $0.4$。\n-   一旦发生风暴，天气将永久保持为'风暴'。\n\n假设今天是晴天。在未来发生风暴之前，至少还会有一个晴天的概率是多少？\n\n请用一个单一的封闭形式解析表达式给出你的答案。", "solution": "设状态为 $S$ (晴天)、$C$ (多云)、$R$ (雨天) 和 $T$ (风暴，吸收态)。定义 $p_{X}$ 为从状态 $X$ 出发，在到达 $T$ 之前先到达 $S$ 的概率。我们的目标是 $p_{S}$，它被解释为在发生 $T$ 之前，至少再次访问一次 $S$ (即在时间 $\\geq 1$ 时) 的概率。\n\n根据首步分析法：\n- 从 $S$ 出发：$p_{S} = \\frac{1}{2}\\cdot 1 + \\frac{2}{5} p_{C} + \\frac{1}{10} p_{R}$，因为从 $S$ 转移到 $S$ 的概率为 $\\frac{1}{2}$ (立即成功)，转移到 $C$ 的概率为 $\\frac{2}{5}$，转移到 $R$ 的概率为 $\\frac{1}{10}$，没有直接转移到 $T$。\n- 从 $C$ 出发：$p_{C} = \\frac{3}{10}\\cdot 1 + \\frac{2}{5} p_{C} + \\frac{1}{5} p_{R} + \\frac{1}{10}\\cdot 0$，因为从 $C$ 转移到 $S$ 的概率为 $\\frac{3}{10}$ (成功)，转移到 $C$ 的概率为 $\\frac{2}{5}$，转移到 $R$ 的概率为 $\\frac{1}{5}$，转移到 $T$ 的概率为 $\\frac{1}{10}$ (失败)。\n- 从 $R$ 出发：$p_{R} = \\frac{1}{10}\\cdot 1 + \\frac{3}{10} p_{C} + \\frac{1}{5} p_{R} + \\frac{2}{5}\\cdot 0$，因为从 $R$ 转移到 $S$ 的概率为 $\\frac{1}{10}$ (成功)，转移到 $C$ 的概率为 $\\frac{3}{10}$，转移到 $R$ 的概率为 $\\frac{1}{5}$，转移到 $T$ 的概率为 $\\frac{2}{5}$ (失败)。\n\n重写关于 $p_{C}$ 和 $p_{R}$ 的线性方程组：\n$$\n\\begin{aligned}\np_{C} - \\frac{2}{5} p_{C} - \\frac{1}{5} p_{R} = \\frac{3}{10} \\quad \\Rightarrow \\quad \\frac{3}{5} p_{C} - \\frac{1}{5} p_{R} = \\frac{3}{10}, \\\\\np_{R} - \\frac{1}{5} p_{R} - \\frac{3}{10} p_{C} = \\frac{1}{10} \\quad \\Rightarrow \\quad \\frac{4}{5} p_{R} - \\frac{3}{10} p_{C} = \\frac{1}{10}.\n\\end{aligned}\n$$\n将第一个方程乘以 $10$，第二个方程乘以 $10$ 得到：\n$$\n6 p_{C} - 2 p_{R} = 3, \\qquad -3 p_{C} + 8 p_{R} = 1.\n$$\n将第二个方程乘以 $2$ 加到第一个方程上（或直接求解）得到\n$$\np_{C} = \\frac{13}{21}, \\qquad p_{R} = \\frac{5}{14}.\n$$\n因此，\n$$\np_{S} = \\frac{1}{2} + \\frac{2}{5}\\cdot \\frac{13}{21} + \\frac{1}{10}\\cdot \\frac{5}{14}\n= \\frac{1}{2} + \\frac{26}{105} + \\frac{1}{28}\n= \\frac{30}{60} + \\frac{17}{60}\n= \\frac{47}{60}.\n$$\n因此，在今天是晴天的情况下，未来在发生任何风暴之前至少还会有一个晴天的概率是 $\\frac{47}{60}$。", "answer": "$$\\boxed{\\frac{47}{60}}$$", "id": "1326137"}, {"introduction": "当状态空间变得非常大时，逐个求解每个状态的概率变得不切实际。这个练习介绍了一种更高级的技巧：利用过程的结构来推断概率的函数形式。通过将晶格分段并应用特殊转移规则和边界条件，您可以解决看似复杂的问题，这种方法在物理和金融等领域非常常见 [@problem_id:1326090]。", "problem": "一个亚原子粒子被限制在一维整数格点上运动。其运动遵循以下规则：\n\n1.  粒子从位置 $i_0 = 0$ 开始。\n2.  在除特殊位置 $k$ 之外的任何整数位置 $j$，粒子在一个时间步内以 $0.5$ 的概率移动到 $j+1$，并以 $0.5$ 的概率移动到 $j-1$。\n3.  位置 $N$（一个正整数）作为一个捕获区。如果粒子到达位置 $N$，它将被吸收，过程终止。\n4.  位置 $-1$ 作为一个陷阱。如果粒子到达位置 $-1$，它也会被吸收，过程终止。\n5.  位置 $k$（其中 $0  k  N$）有一个故障的传送器。当粒子位于位置 $k$ 时，它以概率 $q$（其中 $0  q  1$）移动到位置 $k+1$。以剩余的概率 $1-q$，传送器会激活，并立即将粒子重新定位到位置 $0$。\n\n确定粒子最终在位置 $N$ 被捕获，而不是在位置 $-1$ 的陷阱中被捕获的概率。请用符号参数 $N$、$k$ 和 $q$ 将你的答案表示为一个闭式解析表达式。", "solution": "设 $u_{j}$ 表示从位置 $j$ 出发，随机游走最终在 $N$ 而不是在 $-1$ 被吸收的概率。我们需要求 $u_{0}$。\n\n对于所有满足 $j \\notin \\{-1,N,k\\}$ 的 $j \\in \\mathbb{Z}$，该游走是一个无偏的最近邻随机游走，因此根据第一步分析，\n$$\nu_{j}=\\frac{1}{2}u_{j-1}+\\frac{1}{2}u_{j+1},\n$$\n等价地，\n$$\nu_{j+1}-2u_{j}+u_{j-1}=0.\n$$\n因此，在这个关系式成立的任何区间上，$u_{j}$ 是 $j$ 的一个仿射函数。我们因此设定\n$$\nu_{j}=a j+b \\quad \\text{对于 } -1 \\leq j \\leq k,\n$$\n以及\n$$\nu_{j}=c j+d \\quad \\text{对于 } k \\leq j \\leq N,\n$$\n其中 $u_{k}$ 是单值的，必须从两侧匹配。\n\n边界条件为 $u_{-1}=0$ 和 $u_{N}=1$，得到\n$$\n-a+b=0 \\quad \\Rightarrow \\quad b=a,\n$$\n$$\ncN+d=1.\n$$\n在 $j=k$ 处的连续性给出\n$$\nak+b=ck+d.\n$$\n在 $j=k$ 处，特殊的转移规则得到\n$$\nu_{k}=q\\,u_{k+1}+(1-q)\\,u_{0}.\n$$\n使用 $b=a$ 和仿射形式，我们计算\n$$\nu_{0}=a,\\quad u_{k}=ak+b=a(k+1),\\quad u_{k+1}=c(k+1)+d.\n$$\n根据在 $k$ 处的连续性，$ck+d=ak+b=a(k+1)$，因此\n$$\nc(k+1)+d=(ck+d)+c=a(k+1)+c.\n$$\n代入到 $k$ 处的特殊关系式中，\n$$\na(k+1)=q\\bigl[a(k+1)+c\\bigr]+(1-q)a.\n$$\n整理得，\n$$\na(1-q)k=qc,\n$$\n所以\n$$\nc=\\frac{a(1-q)k}{q}.\n$$\n根据右边界条件和在 $k$ 处的连续性，\n$$\ncN+d=1,\\qquad ck+d=a(k+1),\n$$\n所以\n$$\nc(N-k)=1-a(k+1)\\quad \\Rightarrow \\quad c=\\frac{1-a(k+1)}{N-k}.\n$$\n令两个关于 $c$ 的表达式相等，\n$$\n\\frac{a(1-q)k}{q}=\\frac{1-a(k+1)}{N-k}.\n$$\n交叉相乘并解出 $a$，\n$$\na(1-q)k(N-k)=q\\bigl[1-a(k+1)\\bigr],\n$$\n$$\na\\bigl[(1-q)k(N-k)+q(k+1)\\bigr]=q,\n$$\n$$\na=\\frac{q}{(1-q)k(N-k)+q(k+1)}.\n$$\n由于 $u_{0}=a$，所求的捕获概率为\n$$\nu_{0}=\\frac{q}{(1-q)k(N-k)+q(k+1)}.\n$$\n这是一个用 $N$、$k$ 和 $q$ 表示的闭式解析表达式。", "answer": "$$\\boxed{\\frac{q}{(1-q)k(N-k)+q(k+1)}}$$", "id": "1326090"}]}