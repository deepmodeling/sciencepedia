{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是实践。本节的第一个练习是一个关于受限随机游走的基础问题。通过将问题分解为“下一步”可能发生的几种情况，我们可以运用一步分析法（first-step analysis）建立方程组，进而求解期望返回时间。这个问题 [@problem_id:1301617] 将在一个清晰、有限的设定中，帮助你掌握计算期望返回时间的核心逻辑。", "problem": "一个粒子在整数位置集合 $S = \\{1, 2, 3, 4\\}$ 上进行离散时间随机游走。该粒子的运动遵循以下规则：\n- 如果粒子处于内部位置 $i \\in \\{2, 3\\}$，则在下一个时间步，它以 $0.5$ 的概率移动到位置 $i-1$，或以 $0.5$ 的概率移动到位置 $i+1$。\n- 位置 1 和 4 作为反射边界。如果粒子在位置 1，它必须在下一个时间步移动到位置 2。如果粒子在位置 4，它必须在下一个时间步移动到位置 3。\n\n假设粒子从位置 2 出发，计算粒子首次返回位置 2 所需的期望时间步数。", "solution": "我们将此过程建模为一个在状态 $\\{1,2,3,4\\}$ 上的马尔可夫链，其转移概率为：$P_{1,2}=1$，$P_{2,1}=P_{2,3}=\\frac{1}{2}$，$P_{3,2}=P_{3,4}=\\frac{1}{2}$，以及 $P_{4,3}=1$。令 $f_{i}$ 表示从状态 $i$ 出发首次到达状态 2 的期望步数，其中 $f_{2}=0$。根据首步分析法（马尔可夫链的全期望定律），对于 $i \\neq 2$，我们有\n$$\nf_{i}=1+\\sum_{j}P_{i,j}f_{j}.\n$$\n因此，\n$$\nf_{1}=1+P_{1,2}f_{2}=1,\n$$\n$$\nf_{3}=1+P_{3,2}f_{2}+P_{3,4}f_{4}=1+\\frac{1}{2}f_{4},\n$$\n$$\nf_{4}=1+P_{4,3}f_{3}=1+f_{3}.\n$$\n求解，将 $f_{4}=1+f_{3}$ 代入关于 $f_{3}$ 的方程：\n$$\nf_{3}=1+\\frac{1}{2}(1+f_{3})=1+\\frac{1}{2}+\\frac{1}{2}f_{3},\n$$\n$$\nf_{3}-\\frac{1}{2}f_{3}=\\frac{3}{2} \\quad \\Rightarrow \\quad \\frac{1}{2}f_{3}=\\frac{3}{2} \\quad \\Rightarrow \\quad f_{3}=3,\n$$\n因此 $f_{4}=1+f_{3}=4$，而如上所述 $f_{1}=1$。\n\n令 $r$ 为从状态 2 出发首次返回状态 2 的期望步数。根据首步分析法，\n$$\nr=1+\\sum_{j}P_{2,j}f_{j}=1+\\frac{1}{2}f_{1}+\\frac{1}{2}f_{3}=1+\\frac{1}{2}\\cdot 1+\\frac{1}{2}\\cdot 3=1+\\frac{1}{2}+\\frac{3}{2}=3.\n$$\n因此，粒子首次返回位置 2 所需的期望时间步数为 $3$。", "answer": "$$\\boxed{3}$$", "id": "1301617"}, {"introduction": "除了步步为营的一步分析法，我们还可以从更宏观的视角来解决问题。对于遍历马尔可夫链，一个状态的平均再生时间（mean recurrence time）与其平稳概率之间存在一个非常优美的倒数关系。这个练习 [@problem_id:1301645] 介绍了一种更巧妙、更强大的方法：通过计算平稳分布来直接求得平均再生时间，这种方法在处理更复杂的系统时尤其高效。", "problem": "一个用于科学模拟的专用计算服务器可以处于三种状态之一：在线（ONLINE）、降级（DEGRADED）或离线（OFFLINE）。服务器的状态以恰好一小时的离散时间间隔进行监控。状态之间的转换被建模为一个离散时间马尔可夫链。\n\n- 如果服务器处于在线（ONLINE）状态，在下一小时内，有概率 $p$ 会因小故障转换到降级（DEGRADED）状态。否则，它保持在线状态。\n- 如果服务器处于降级（DEGRADED）状态，它无法自我修复到在线（ONLINE）状态。在下一小时内，有概率 $q$ 会发生严重故障，导致其转换到离线（OFFLINE）状态。否则，它保持降级状态。\n- 如果服务器处于离线（OFFLINE）状态，将启动一个自动恢复协议。该协议保证服务器在下一小时内回到在线（ONLINE）状态。\n\n概率 $p$ 和 $q$ 是常数，满足 $0  p  1$ 和 $0  q  1$。\n\n计算在线（ONLINE）状态的平均返回时间。用 $p$ 和 $q$ 的符号表达式表示你的答案，单位为小时。", "solution": "让我们将服务器的行为建模为一个具有三种状态的离散时间马尔可夫链。我们可以如下标记这些状态：\n- 状态 0：在线 (ONLINE)\n- 状态 1：降级 (DEGRADED)\n- 状态 2：离线 (OFFLINE)\n\n问题描述了这些状态在一小时的间隔内的转移概率。我们可以将这些概率总结在一个转移矩阵 $P$ 中，其中元素 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。\n\n转移情况如下：\n- 从状态 0 (ONLINE):\n  - 以概率 $p$ 转移到状态 1 (DEGRADED)。所以，$P_{01} = p$。\n  - 以概率 $1-p$ 保持在状态 0 (ONLINE)。所以，$P_{00} = 1-p$。\n  - 不能直接转移到状态 2 (OFFLINE)。所以，$P_{02} = 0$。\n- 从状态 1 (DEGRADED):\n  - 以概率 $q$ 转移到状态 2 (OFFLINE)。所以，$P_{12} = q$。\n  - 以概率 $1-q$ 保持在状态 1 (DEGRADED)。所以，$P_{11} = 1-q$。\n  - 不能返回到状态 0 (ONLINE)。所以，$P_{10} = 0$。\n- 从状态 2 (OFFLINE):\n  - 以概率 1 转移到状态 0 (ONLINE)。所以，$P_{20} = 1$。\n  - 不能转移到状态 1 或停留在状态 2。所以，$P_{21} = 0$ 且 $P_{22} = 0$。\n\n转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\n1-p  p  0 \\\\\n0  1-q  q \\\\\n1  0  0\n\\end{pmatrix}\n$$\n\n问题要求计算在线状态（状态 0）的平均返回时间。对于一个不可约、正常返的马尔可夫链，状态 $i$ 的平均返回时间 $\\mu_i$ 是其平稳概率 $\\pi_i$ 的倒数。\n$$\n\\mu_i = \\frac{1}{\\pi_i}\n$$\n所以，我们的目标是找到平稳分布向量 $\\pi = (\\pi_0, \\pi_1, \\pi_2)$，它是满足方程 $\\pi P = \\pi$ 且满足条件 $\\pi_0 + \\pi_1 + \\pi_2 = 1$ 的唯一概率向量。\n\n方程 $\\pi P = \\pi$ 给了我们一个线性方程组：\n1. $\\pi_0 = \\pi_0(1-p) + \\pi_1(0) + \\pi_2(1) \\implies \\pi_0 = \\pi_0 - p\\pi_0 + \\pi_2 \\implies p\\pi_0 = \\pi_2$\n2. $\\pi_1 = \\pi_0(p) + \\pi_1(1-q) + \\pi_2(0) \\implies \\pi_1 = p\\pi_0 + \\pi_1 - q\\pi_1 \\implies q\\pi_1 = p\\pi_0$\n3. $\\pi_2 = \\pi_0(0) + \\pi_1(q) + \\pi_2(0) \\implies \\pi_2 = q\\pi_1$\n\n注意到如果我们使用前两个方程，第三个方程是冗余的。从 (2) 我们得到 $\\pi_1 = \\frac{p}{q}\\pi_0$。将此代入 (3) 得到 $\\pi_2 = q\\left(\\frac{p}{q}\\pi_0\\right) = p\\pi_0$，这与方程 (1) 相同。\n\n所以，我们得到了用 $\\pi_0$ 表示 $\\pi_1$ 和 $\\pi_2$ 的表达式：\n- $\\pi_1 = \\frac{p}{q}\\pi_0$\n- $\\pi_2 = p\\pi_0$\n\n现在，我们使用归一化条件 $\\pi_0 + \\pi_1 + \\pi_2 = 1$：\n$$\n\\pi_0 + \\frac{p}{q}\\pi_0 + p\\pi_0 = 1\n$$\n提取公因子 $\\pi_0$：\n$$\n\\pi_0 \\left(1 + \\frac{p}{q} + p\\right) = 1\n$$\n为了简化括号中的表达式，我们通分：\n$$\n\\pi_0 \\left(\\frac{q + p + pq}{q}\\right) = 1\n$$\n现在，解出 $\\pi_0$：\n$$\n\\pi_0 = \\frac{q}{q + p + pq}\n$$\n在线状态（状态 0）的平均返回时间，记为 $\\mu_0$，是 $\\pi_0$ 的倒数：\n$$\n\\mu_0 = \\frac{1}{\\pi_0} = \\frac{q + p + pq}{q}\n$$\n我们可以通过将分子中的每一项除以分母来简化此表达式：\n$$\n\\mu_0 = \\frac{q}{q} + \\frac{p}{q} + \\frac{pq}{q} = 1 + p + \\frac{p}{q}\n$$\n单位是小时，因为马尔可夫链的时间步长是一小时。", "answer": "$$\\boxed{1 + p + \\frac{p}{q}}$$", "id": "1301645"}, {"introduction": "最后，我们将把所学知识应用于一个经典的物理模型——埃伦费斯特模型（Ehrenfest model）。这个问题 [@problem_id:1301629] 模拟了气体分子在两个容器间的扩散过程，虽然我们依然可以使用一步分析法，但其状态转移概率的构建比简单的随机游走更具挑战性。通过解决这个问题，你将体会到随机过程理论在真实科学情境中的应用价值和建模的灵活性。", "problem": "考虑一个简化的气体在两个腔室之间扩散的模型，称为 Ehrenfest 模型。在这个模型中，总共有 $N=3$ 个相同的分子分布在腔室 A 和腔室 B 之间。在每个离散的时间步，从三个分子中均匀随机地选择一个分子，并将其移动到另一个腔室。\n\n系统的状态由腔室 A 中的分子数量来描述。假设系统初始时处于腔室 A 中恰好有一个分子的状态。\n\n计算系统首次返回到腔室 A 中恰好有一个分子的状态所需的时间步数的期望值。请以精确分数形式给出您的答案。", "solution": "令状态为腔室 A 中的分子数，因此状态空间为 $\\{0,1,2,3\\}$。我们要求的是从状态 $1$ 出发，首次返回到状态 $1$ 的期望时间，记为 $m_1$。\n\n根据马尔可夫性质和首步分析法，我们首先计算从状态 $i$ 出发首次到达状态 $1$ 所需的期望步数，记为 $h_i$，其中根据定义 $h_1=0$。在每一步中，如果当前状态是 $i$，则系统以概率 $\\frac{i}{3}$ 转移到状态 $i-1$，并以概率 $\\frac{3-i}{3}$ 转移到状态 $i+1$。\n我们为 $h_i$ ($i\\neq 1$) 建立方程组：\n- 从状态 0 开始：链以概率 1 移动到状态 1，因此\n$$\nh_{0}=1+h_{1}=1.\n$$\n- 从状态 3 开始：链以概率 1 移动到状态 2，因此\n$$\nh_{3}=1+h_{2}.\n$$\n- 从状态 2 开始：以概率 $\\frac{2}{3}$ 转移到状态 1（到达目标状态），并以概率 $\\frac{1}{3}$ 转移到状态 3，因此\n$$\nh_{2}=1+\\frac{2}{3}h_{1}+\\frac{1}{3}h_{3}=1+\\frac{1}{3}h_{3}.\n$$\n\n求解 $h_{2}$ 和 $h_{3}$。将 $h_{3}=1+h_{2}$ 代入关于 $h_{2}$ 的方程中，得到\n$$\nh_{2}=1+\\frac{1}{3}(1+h_{2})=1+\\frac{1}{3}+\\frac{1}{3}h_{2}.\n$$\n因此\n$$\nh_{2}-\\frac{1}{3}h_{2}=\\frac{4}{3}\\quad\\Longrightarrow\\quad \\frac{2}{3}h_{2}=\\frac{4}{3}\\quad\\Longrightarrow\\quad h_{2}=2,\n$$\n然后\n$$\nh_{3}=1+h_{2}=3.\n$$\n现在我们可以计算期望返回时间 $m_1$。从状态 1 出发，系统以概率 $\\frac{1}{3}$ 转移到状态 0，并以概率 $\\frac{2}{3}$ 转移到状态 2。因此\n$$\nm_1=1+\\frac{1}{3}h_{0}+\\frac{2}{3}h_{2}.\n$$\n代入 $h_{0}=1$ 和 $h_{2}=2$，计算可得\n$$\nm_1=1+\\frac{1}{3}\\cdot 1+\\frac{2}{3}\\cdot 2=1+\\frac{1}{3}+\\frac{4}{3}=\\frac{8}{3}.\n$$\n\n因此，系统首次返回到腔室 A 中恰好有一个分子的状态所需的期望时间步数是 $\\frac{8}{3}$。", "answer": "$$\\boxed{\\frac{8}{3}}$$", "id": "1301629"}]}