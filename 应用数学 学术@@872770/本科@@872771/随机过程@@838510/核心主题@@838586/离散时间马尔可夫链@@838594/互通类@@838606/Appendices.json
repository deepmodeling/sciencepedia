{"hands_on_practices": [{"introduction": "理解互通类最直观的方法之一就是将其可视化。本练习通过一个图上的随机游走问题，将“互通”这一抽象概念与图中两点之间是否存在往返路径直接联系起来。[@problem_id:1329629] 通过分析图的结构，我们可以轻松地划分状态空间，这是建立对互通类基本直觉的绝佳起点。", "problem": "考虑一个由在有限无向图 $G$ 上的随机游走定义的离散时间马尔可夫链。图 $G$ 有一个包含六个顶点的集合，标记为 $V = \\{1, 2, 3, 4, 5, 6\\}$。该图的边构成了两个完全分离的3顶点环（三角形）。第一个三角形连接顶点 $\\{1, 2, 3\\}$，第二个三角形连接顶点 $\\{4, 5, 6\\}$。图中没有其他边。\n\n该过程从 $V$ 中的某个顶点开始。在每个时间步，如果游走位于某个顶点，它会移动到其一个相邻的邻居顶点。每个邻居被选择的概率相等。马尔可夫链的状态空间是顶点集合 $V$。\n\n下列哪个选项正确描述了状态空间 $V$ 到互通类的划分？\n\nA. $\\{\\{1, 2, 3, 4, 5, 6\\}\\}$\n\nB. $\\{\\{1, 2\\}, \\{3, 4\\}, \\{5, 6\\}\\}$\n\nC. $\\{\\{1, 2, 3\\}, \\{4, 5, 6\\}\\}$\n\nD. $\\{\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$\n\nE. $\\{\\{1, 4\\}, \\{2, 5\\}, \\{3, 6\\}\\}$", "solution": "问题要求我们识别在图上定义的马尔可夫链的互通类。链的状态空间是顶点集合 $S = V = \\{1, 2, 3, 4, 5, 6\\}$。\n\n首先，我们回顾一下与互通类相关的定义。\n马尔可夫链中的两个状态 $i$ 和 $j$ 被称为互通，记作 $i \\leftrightarrow j$，如果可以在有限步内从状态 $i$ 到达状态 $j$，并且也可以在有限步内从状态 $j$ 到达状态 $i$。\n数学上，$i \\leftrightarrow j$ 当且仅当状态 $j$ 可从状态 $i$ 到达（$i \\to j$），并且状态 $i$ 可从状态 $j$ 到达（$j \\to i$）。\n如果从 $i$ 出发，在某个步数 $n \\ge 1$ 内到达 $j$ 的概率大于零，则称状态 $j$ 可从 $i$ 到达。对于无权图上的随机游走，这等价于存在一条从顶点 $i$ 到顶点 $j$ 的由顶点和边组成的路径。\n\n互通是一种等价关系，这意味着它是自反的（$i \\leftrightarrow i$），对称的（如果 $i \\leftrightarrow j$ 则 $j \\leftrightarrow i$），和传递的（如果 $i \\leftrightarrow j$ 且 $j \\leftrightarrow k$ 则 $i \\leftrightarrow k$）。这种关系将状态空间划分为不相交的等价类，这些等价类被称为互通类。\n\n让我们分析图 $G$ 的结构。它由两个不连通的分量组成。\n分量1：一个由顶点 $\\{1, 2, 3\\}$ 组成的三角形。边为 $(1, 2)$、$(2, 3)$ 和 $(3, 1)$。\n分量2：一个由顶点 $\\{4, 5, 6\\}$ 组成的三角形。边为 $(4, 5)$、$(5, 6)$ 和 $(6, 4)$。\n在 $\\{1, 2, 3\\}$ 中的任何顶点与 $\\{4, 5, 6\\}$ 中的任何顶点之间没有边相连。\n\n随机游走只能在相邻顶点之间移动。因此，要使状态 $j$ 能从状态 $i$ 到达，图中必须有一条连接顶点 $i$ 和顶点 $j$ 的路径。\n\n我们来考虑第一个分量，顶点 $\\{1, 2, 3\\}$。\n- 状态2是否可从状态1到达（$1 \\to 2$）？是的，从1到2有一条边。转移概率 $p_{12} > 0$。\n- 状态1是否可从状态2到达（$2 \\to 1$）？是的，从2到1有一条边。转移概率 $p_{21} > 0$。\n由于 $1 \\to 2$ 且 $2 \\to 1$，我们有 $1 \\leftrightarrow 2$。\n- 类似地，对于状态2和3，存在一条边 $(2, 3)$，所以 $2 \\to 3$ 且 $3 \\to 2$。因此，$2 \\leftrightarrow 3$。\n- 对于状态1和3，存在一条边 $(1, 3)$，所以 $1 \\to 3$ 且 $3 \\to 1$。因此，$1 \\leftrightarrow 3$。\n根据互通关系的传递性（因为 $1 \\leftrightarrow 2$ 且 $2 \\leftrightarrow 3$，则 $1 \\leftrightarrow 3$），集合 $\\{1, 2, 3\\}$ 中的所有顶点都相互互通。因此，$\\{1, 2, 3\\}$ 构成一个单独的互通类。\n\n现在，我们来考虑第二个分量，顶点 $\\{4, 5, 6\\}$。\n- 使用与上面相同的逻辑，边 $(4, 5)$、$(5, 6)$ 和 $(6, 4)$ 的存在意味着该集合内的所有顶点都是相互可达的。\n- $4 \\leftrightarrow 5$，$5 \\leftrightarrow 6$，以及 $6 \\leftrightarrow 4$。\n- 因此，集合 $\\{4, 5, 6\\}$ 中的所有顶点都相互互通，构成另一个单独的互通类。\n\n最后，我们考虑一个来自第一个分量的状态和一个来自第二个分量的状态，例如，状态1和状态4。\n- 状态4是否可从状态1到达（$1 \\to 4$）？要让游走从顶点1到顶点4，图中必须有一条连接它们的边路径。根据问题描述，这两个三角形是不相交的，意味着集合 $\\{1, 2, 3\\}$ 和集合 $\\{4, 5, 6\\}$ 之间没有边。\n- 因此，从1到4没有路径。从状态1开始到达状态4的概率为零。所以，$1 \\not\\to 4$。\n- 由于从状态1到状态4是不可达的，所以状态1和4不互通。同样的逻辑适用于任何顶点对 $(i, j)$，其中 $i \\in \\{1, 2, 3\\}$ 且 $j \\in \\{4, 5, 6\\}$。\n\n总之，状态空间 $S = \\{1, 2, 3, 4, 5, 6\\}$ 被划分为两个互通类：$C_1 = \\{1, 2, 3\\}$ 和 $C_2 = \\{4, 5, 6\\}$。所有互通类的集合是 $\\{\\{1, 2, 3\\}, \\{4, 5, 6\\}\\}$。\n\n将此结果与给定选项进行比较：\nA. $\\{\\{1, 2, 3, 4, 5, 6\\}\\}$ - 不正确。这意味着图是连通的。\nB. $\\{\\{1, 2\\}, \\{3, 4\\}, \\{5, 6\\}\\}$ - 不正确。\nC. $\\{\\{1, 2, 3\\}, \\{4, 5, 6\\}\\}$ - 正确。\nD. $\\{\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$ - 不正确。这意味着没有状态与任何其他状态互通，这是错误的。\nE. $\\{\\{1, 4\\}, \\{2, 5\\}, \\{3, 6\\}\\}$ - 不正确。这混合了来自两个不连通分量的顶点。", "answer": "$$\\boxed{C}$$", "id": "1329629"}, {"introduction": "许多现实世界系统的状态转移并不总是对称的。这个电梯问题超越了简单的图连通性，引入了有方向的转移规则，使得状态之间的可达性变得不再理所当然。[@problem_id:1289775] 它要求我们仔细追踪状态转移图中的路径，以确定在受限的移动规则下，状态空间是如何被划分为不同部分的，从而加深对有向转移如何塑造互通类的理解。", "problem": "一部四层楼建筑里的电梯根据一个固定的概率程序运行。系统的状态是电梯当前停留的离散楼层数，状态空间为 $S = \\{1, 2, 3, 4\\}$。电梯下一站的转移规则定义如下：\n\n- 如果电梯在1楼，它的下一站总是3楼。\n- 如果电梯在2楼，它的下一站有0.5的概率是1楼，有0.5的概率是4楼。\n- 如果电梯在3楼，它的下一站总是1楼。\n- 如果电梯在4楼，它的下一站总是2楼。\n\n这个系统可以被建模为一个马尔可夫链，其中状态是楼层数。找出这个马尔可夫链的所有互通类。\n\nA. $\\{1, 2, 3, 4\\}$\n\nB. $\\{1, 3\\}$ 和 $\\{2, 4\\}$\n\nC. $\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}$\n\nD. $\\{1, 2\\}$ 和 $\\{3, 4\\}$\n\nE. $\\{1, 2, 3\\}$ 和 $\\{4\\}$", "solution": "我们将该系统建模为状态空间 $S=\\{1,2,3,4\\}$ 上的一个马尔可夫链。两个状态 $i,j$ 互通（记作 $i \\leftrightarrow j$）当且仅当存在步数 $m, n \\ge 1$ 使得从 $i$ 到 $j$ 的 $m$ 步转移概率 $P^m(i,j)>0$ 且从 $j$ 到 $i$ 的 $n$ 步转移概率 $P^n(j,i)>0$。\n\n让我们分析状态之间的可达性路径：\n- **状态 1 和 3**：\n  - 从状态1出发，唯一可能的转移是 $1 \\to 3$。\n  - 从状态3出发，唯一可能的转移是 $3 \\to 1$。\n  - 因为 $1 \\to 3$ 且 $3 \\to 1$，所以状态1和3互通：$1 \\leftrightarrow 3$。\n  - 从状态1或3出发，无法直接或间接到达状态2或4。因此，$\\{1, 3\\}$ 形成一个互通类。\n\n- **状态 2 和 4**：\n  - 从状态2出发，可以转移到状态4（$2 \\to 4$）。\n  - 从状态4出发，唯一可能的转移是 $4 \\to 2$。\n  - 因为 $2 \\to 4$ 且 $4 \\to 2$，所以状态2和4互通：$2 \\leftrightarrow 4$。\n  - 因此，$\\{2, 4\\}$ 形成一个互通类。\n\n- **类之间的关系**：\n  - 我们已经确定 $\\{1, 3\\}$ 是一个互通类，$\\{2, 4\\}$ 是另一个。现在需要确认它们之间是否互通。\n  - 从状态2出发，可以转移到状态1（$2 \\to 1$）。这意味着可以从类 $\\{2, 4\\}$ 到达类 $\\{1, 3\\}$。\n  - 但是，从类 $\\{1, 3\\}$ 出发，无法到达类 $\\{2, 4\\}$ 中的任何状态。\n  - 因为可达性不是双向的（例如，$2 \\to 1$ 但 $1 \\not\\to 2$），所以这两个类是不互通的。\n\n综上所述，状态空间被划分为两个互通类：$\\{1, 3\\}$ 和 $\\{2, 4\\}$。\n\n这可以从转移矩阵中更正式地看出：\n$$\nP=\\begin{pmatrix}\n0  & 0 & 1 & 0\\\\\n\\frac{1}{2} & 0 & 0 & \\frac{1}{2}\\\\\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\n\\end{pmatrix}\n$$\n- $P(1,3)=1$ 和 $P(3,1)=1 \\implies 1 \\leftrightarrow 3$。\n- $P(2,4)=1/2$ 和 $P(4,2)=1 \\implies 2 \\leftrightarrow 4$。\n- $P(2,1)=1/2 > 0$ 但对所有 $n \\ge 1$，$P^n(1,2)=0$。所以 $1$ 和 $2$ 不互通。\n- 同样地，其他跨类状态对也不互通。\n\n因此，互通类是 $\\{1,3\\}$ 和 $\\{2,4\\}$，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1289775"}, {"introduction": "这个更具挑战性的问题揭示了某些马尔可夫链背后优美的数学结构。我们不再仅仅依赖于追踪路径，而是可以运用抽象代数（特别是群论）中的工具来对状态进行分类。[@problem_id:712313] 该练习展示了如何通过理解在模算术系统 $\\mathbb{Z}_N$ 中的生成元（即转移规则 $+a$ 和 $+b$），来推导出一个预测互通类数量的通用公式，体现了数学理论在解决复杂概率问题中的力量。", "problem": "考虑一个定义在状态空间 $S = \\{0, 1, \\dots, N-1\\}$ 上的马尔可夫链，其中 $N$ 是一个正整数。这些状态可以与模 $N$ 整数群的元素等同，该群记为 $\\mathbb{Z}_N$。\n\n该马尔可夫链的转移由两个正整数 $a$ 和 $b$ 以及一个概率 $p \\in (0, 1)$ 决定。从任意状态 $i \\in S$ 出发，链以概率 $p$ 转移到状态 $(i+a) \\pmod N$，以概率 $1-p$ 转移到状态 $(i+b) \\pmod N$。所有其他转移的概率均为零。\n\n如果状态 $j$ 可从状态 $i$ 到达，且状态 $i$ 也可从状态 $j$ 到达，则称两个状态 $i$ 和 $j$ 是互通的，记作 $i \\leftrightarrow j$。一个互通类是一个极大的状态集合，其中集合内的任意一对状态都是互通的。状态空间 $S$ 可以被划分为一系列不相交的互通类。\n\n推导一个通用的闭式表达式，用参数 $N$、$a$ 和 $b$ 来表示该马尔可夫链的互通类数量。", "solution": "我们将状态建模为加法群 $\\mathbb{Z}_N$ 的元素。从任意状态 $i \\in \\mathbb{Z}_N$ 出发，一步转移将状态变为 $(i+a) \\pmod N$ 或 $(i+b) \\pmod N$。\n\n由于这是一个在有限群上的随机游走，其结构非常规则。两个状态 $i$ 和 $j$ 互通当且仅当它们的差 $j-i$ 属于由转移增量 $\\{a, b\\}$ 在群 $\\mathbb{Z}_N$ 中生成的子群 $H$。这个子群由所有形如 $xa+yb \\pmod N$（其中 $x, y$ 为任意整数）的元素构成。\n\n互通类因此恰好是子群 $H$ 在 $\\mathbb{Z}_N$ 中的陪集。因此，互通类的数量等于 $H$ 在 $\\mathbb{Z}_N$ 中的指数，记为 $[\\mathbb{Z}_N : H]$。\n\n根据群论，由 $\\{a, b\\}$ 在循环群 $\\mathbb{Z}_N$ 中生成的子群 $H$ 本身也是一个循环群，其生成元为 $g = \\gcd(a, b, N)$。\n\n该子群 $H$ 的阶（大小）为 $|H| = N/g$。\n\n因此，互通类的数量（即指数）为：\n$$[\\mathbb{Z}_N : H] = \\frac{|\\mathbb{Z}_N|}{|H|} = \\frac{N}{N/g} = g$$\n所以，互通类的数量由下式给出：\n$$\\gcd(a, b, N)$$", "answer": "$$\\boxed{\\gcd(a,b,N)}$$", "id": "712313"}]}