## 引言
马尔可夫链是描述随机动态系统的强大数学工具，从天气变化到用户行为，其应用无处不在。然而，仅仅定义了状态转移的规则，我们对系统的未来仍然知之甚少：系统能否从一个状态演化到另一个？它会永远在几个状态间徘徊，还是最终会趋于稳定或被某个状态“吸收”？这些关于系统长期命运的问题，是理解和预测其行为的核心。

为了回答这些问题，本文系统地探讨了[马尔可夫链](@entry_id:150828)中“状态间的互通性”这一关键概念。文章将引导读者深入理解状态的[分类理论](@entry_id:153976)及其深远影响。在**“原则与机理”**一章中，我们将建立[状态分类](@entry_id:276397)的理论基础，定义[可达性](@entry_id:271693)、[互通类](@entry_id:267280)、暂态与[常返态](@entry_id:276969)等核心术语。接着，在**“应用与跨学科联系”**一章中，我们将展示这些抽象概念如何在工程、生态学、数据科学等领域中揭示系统的内在结构和[演化趋势](@entry_id:173460)。最后，通过**“动手实践”**部分，读者将有机会通过解决具体问题来巩固所学知识。

通过这一结构化的学习路径，你将不仅掌握[状态分类](@entry_id:276397)的数学定义，更能将其作为一套分析工具，洞察复杂系统背后的动态规律。让我们首先从构建这套分析工具的基石——[状态分类](@entry_id:276397)的原则与机理——开始。

## 原则与机理

在理解了马尔可夫链的基本定义之后，我们自然会提出一系列关于系统动态行为的问题。如果系统当前处于某个状态，它能否在未来到达另一个指定的状态？如果可以，它能否再返回？反复访问一个状态的频率如何？对这些问题的探索，引出了[马尔可夫链](@entry_id:150828)理论中关于[状态分类](@entry_id:276397)的核心概念，这对于分析链的长期行为至关重要。本章将系统地介绍状态之间的**[可达性](@entry_id:271693)**、**互通性**，并在此基础上，将[状态空间](@entry_id:177074)划分为**[互通类](@entry_id:267280)**，进而区分**暂态**与**[常返态](@entry_id:276969)**，以及探讨**周期性**。

### [可达性](@entry_id:271693)与互通性

研究马尔可夫链的结构，首要任务是确定状态之间是否存在转移的路径。

#### [可达性](@entry_id:271693)

我们称状态 $j$ 从状态 $i$ **可达** (accessible)，记作 $i \to j$，如果从状态 $i$ 出发，系统有大于零的概率在有限步内到达状态 $j$。从数学上讲，这意味着存在某个整数 $n \ge 0$，使得 $n$ 步转移概率 $P_{ij}^{(n)} > 0$。这里的 $P_{ij}^{(n)}$ 是转移[概率矩阵](@entry_id:274812) $P$ 的 $n$ 次幂 $P^n$ 的第 $(i, j)$ 个元素。当 $n=0$ 时，我们定义 $P^0$ 为[单位矩阵](@entry_id:156724)，因此任何状态从自身出发在0步内可达，即 $i \to i$。

需要强调的是，可达性并不要求一步之内就能到达。即使[一步转移概率](@entry_id:272678) $P_{ij}$ 为零，只要存在一条由正概率转移构成的中间路径，状态 $j$ 依然可以从 $i$ 可达。

例如，考虑一个简化的天气模型，[状态空间](@entry_id:177074)为 {1: 晴天, 2: 多云, 3: 雨天}，其[转移矩阵](@entry_id:145510)为 [@problem_id:1290028]：
$$
P = \begin{pmatrix}
0.5  0.5  0 \\
0.2  0.5  0.3 \\
0  0.6  0.4
\end{pmatrix}
$$
这里，从“晴天”到“雨天”的[一步转移概率](@entry_id:272678) $P_{13} = 0$，似乎晴天之后不会直接下雨。然而，我们可以计算两步转移概率：
$$
P_{13}^{(2)} = \sum_{k=1}^{3} P_{1k}P_{k3} = P_{11}P_{13} + P_{12}P_{23} + P_{13}P_{33} = (0.5)(0) + (0.5)(0.3) + (0)(0.4) = 0.15 > 0
$$
这表明，系统可以通过“晴天” $\to$ “多云” $\to$ “雨天”的路径实现状态的转移。因此，状态“雨天”是从“晴天”可达的，即 $1 \to 3$。

#### 互通性

[可达性](@entry_id:271693)是一种单向关系。如果状态 $i$ 从 $j$ 可达，但 $j$ 不一定能从 $i$ 可达。当两个状态可以相互到达时，我们称它们**互通** (communicate)，记作 $i \leftrightarrow j$。形式上，$i \leftrightarrow j$ 当且仅当 $i \to j$ 且 $j \to i$。

互通性是理解[马尔可夫链](@entry_id:150828)结构的关键，因为它建立了一种对等关系。
- **[自反性](@entry_id:137262)**: $i \leftrightarrow i$ (因为 $i \to i$ 总是成立)。
- **对称性**: 如果 $i \leftrightarrow j$，那么 $j \leftrightarrow i$ (由定义直接得出)。
- **传递性**: 如果 $i \leftrightarrow j$ 且 $j \leftrightarrow k$，那么 $i \leftrightarrow k$。这是因为从 $i$ 到 $k$ 的路径可以通过先到 $j$ 再到 $k$ 来构造，反之亦然。

由于互通性是一种等价关系，它可以将[马尔可夫链](@entry_id:150828)的整个状态空间 $S$ 分割成若干个不相交的[子集](@entry_id:261956)，这些[子集](@entry_id:261956)被称为**[互通类](@entry_id:267280) (communicating classes)**。

### [互通类](@entry_id:267280)与不可约性

[互通类](@entry_id:267280)是状态空间的一个划分，其中每个类中的所有状态都相互互通，而不同类之间的状态则不互通（至少在一个方向上不通）。

例如，在一个模拟基因状态的模型中，[状态空间](@entry_id:177074)为 {D: 健康显性, S: 受压显性, r: 突变隐性} [@problem_id:1290020]。其转移规则为：$D \leftrightarrow S$ (健康与受压状态可相互转化)，$S \to r$ (受压可突变为隐性)，但状态 $r$ 是稳定的，无法变回 $D$ 或 $S$。
- $D \leftrightarrow S$：因为 $D \to S$ 和 $S \to D$ 都被允许，所以 $D$ 和 $S$ 互通，它们属于同一个[互通类](@entry_id:267280)。
- $D \not\leftrightarrow r$ 且 $S \not\leftrightarrow r$：虽然可以从 $D$ (经由 $S$) 或 $S$ 到达 $r$，但无法从 $r$ 返回。因此，$r$ 与 $D, S$ 不互通。
- $r \leftrightarrow r$：$r$ 自身构成一个[互通类](@entry_id:267280)。
因此，该马尔可夫链的状态空间被划分为两个[互通类](@entry_id:267280)：$\{D, S\}$ 和 $\{r\}$。

另一个例子是模拟AI游戏策略的模型，状态为 {1: 攻击性, 2: 防御性, 3: 中立} [@problem_id:1290014]。规则是：攻击性和防御性策略可以相互切换，但都不能切换到中立；中立策略只能保持中立。
- $1 \leftrightarrow 2$：因为 $1 \to 2$ 和 $2 \to 1$ 都是可能的。
- $1 \not\leftrightarrow 3$ 且 $2 \not\leftrightarrow 3$：因为无法从状态1或2到达3，也无法从3到达1或2。
所以，这里的[互通类](@entry_id:267280)是 $\{1, 2\}$ 和 $\{3\}$。

当一个马尔可夫链只包含一个[互通类](@entry_id:267280)，即所有状态都相互互通时，我们称这个链是**不可约的 (irreducible)**。在一个不可约的链中，无论从哪个状态出发，都有可能在有限步内到达任何其他状态。许多现实世界的模型都是不可约的。例如，在一个模拟选民立场变化的系统中，状态为 {支持A党, 支持B党, 摇摆不定} [@problem_id:1290005]。如果规则允许支持者变为摇摆者，摇摆者可以变为任一党的支持者，那么即使A、B两党的支持者不能直接相互转化，他们也可以通过“摇摆不定”这一中间状态实现互通：$A \to \text{摇摆} \to B$ 和 $B \to \text{摇摆} \to A$。因此，所有三个状态构成一个单一的[互通类](@entry_id:267280)，该[马尔可夫链](@entry_id:150828)是不可约的。

### 类的性质：暂态与[常返态](@entry_id:276969)

一旦我们将状态空间划分为[互通类](@entry_id:267280)，下一步就是分析这些类的性质。一个核心问题是：当过程离开一个状态后，它最终会返回吗？

一个关键的定理是：**同一[互通类](@entry_id:267280)中的所有状态具有相同的类型**。也就是说，如果一个状态是常返的，那么它所在[互通类](@entry_id:267280)中的所有其他状态也都是常返的。如果一个是暂态的，那么所有其他状态也都是暂态的。这使得我们可以直接讨论一个“类”是常返的还是暂态的。

#### 暂态与[常返态](@entry_id:276969)的定义

从状态 $i$ 出发，令 $f_i$ 为过程在未来某个时刻**首次**返回状态 $i$ 的概率。
- 如果 $f_i = 1$，则称状态 $i$ 是**常返的 (recurrent)**。这意味着一旦处于状态 $i$，几乎必然会再次返回。
- 如果 $f_i  1$，则称状态 $i$ 是**暂态的 (transient)**。这意味着从状态 $i$ 出发，有正的概率永远不再返回。过程最终会“漂移”出去。

#### 判断暂态与常返的关键

一个[互通类](@entry_id:267280)是常返的还是暂态的，取决于它是否“封闭”。一个[互通类](@entry_id:267280) $C$ 被称为**封闭的 (closed)**，如果从 $C$ 中的任何状态出发，都不可能转移到 $C$ 之外的任何状态。

- **一个封闭的[互通类](@entry_id:267280)必然是[常返类](@entry_id:273689)**。因为过程一旦进入该类，就永远无法离开，它不得不在有限的几个状态中持续运动，从而保证了对每个状态的无限次访问。
- **一个非封闭的[互通类](@entry_id:267280)必然是暂态类**。如果一个类不是封闭的，就意味着至少存在一个状态 $i \in C$ 和一个状态 $j \notin C$，使得 $P_{ij} > 0$。由于 $j$ 不在 $i$ 的[互通类](@entry_id:267280)中，必然有 $j \not\to i$。这意味着，一旦过程从 $i$ “泄漏”到 $j$，就再也没有机会返回到类 $C$。这种“泄漏”的可能性，无论多么小，都导致了从 $i$ 出发后永不返回的概率为正，因此类 $C$ 中的所有状态都是暂态的。

考虑一个用户在线状态的模型，状态为 {在线, 离开, 离线} [@problem_id:1289988]。规则是“在线”和“离开”可以相互转化，但两者都有一定概率变为“离线”。一旦“离线”，状态就不会再改变。
- 状态 {离线} 自身构成一个[互通类](@entry_id:267280)。由于 $P_{\text{离线},\text{离线}} = 1$，不可能转移到其他状态，所以这是一个封闭类，因此“离线”是[常返态](@entry_id:276969)。
- 状态 {在线, 离开} 构成另一个[互通类](@entry_id:267280)。然而，这个类不是封闭的，因为从“在线”或“离开”都有可能转移到“离线”状态。由于存在这种“泄漏”到“离线”状态的可能性，并且一旦进入“离线”就无法返回，所以过程最终会被“离线”状态“吸收”。因此，“在线”和“离开”这两个状态都是暂态的。

这个例子中的“离线”状态是一个极端情况，称为**[吸收态](@entry_id:161036) (absorbing state)**。一个状态 $i$ 如果满足 $P_{ii}=1$，它就是吸收态。吸收态自身构成一个封闭的[常返类](@entry_id:273689)。例如，在模拟疾病发展的S-I-R模型（易感-感染-康复）中 [@problem_id:1290030]，康复状态 $R$ 是永久性的，因此 $P_{RR}=1$，状态 $R$ 是一个吸收态。而易感态 $S$ 和感染态 $I$ 都有可能最终进入 $R$ 状态且无法返回，所以 $S$ 和 $I$ 都是暂态的。

### 周期性

对于[常返类](@entry_id:273689)，我们还可以进一步描述其内部的结构性行为，这就是**周期性 (periodicity)**。

状态 $i$ 的**周期** $d(i)$ 定义为所有可能从 $i$ 出发返回到 $i$ 的步数 $n \ge 1$ 的[最大公约数](@entry_id:142947)（GCD）。即：
$$
d(i) = \text{gcd}\{n \ge 1 : P_{ii}^{(n)} > 0\}
$$
- 如果 $d(i) = 1$，我们称状态 $i$ 是**非周期的 (aperiodic)**。
- 如果 $d(i) > 1$，我们称状态 $i$ 是**周期的 (periodic)**。

与暂态/常返性类似，**同一[互通类](@entry_id:267280)中的所有状态具有相同的周期**。

周期性描述了链返回一个状态所必须遵循的步数规律。例如，一个简单的交通灯系统，状态按顺序循环：绿 $\to$ 黄 $\to$ 红 $\to$ 绿。从“绿”灯状态出发，必须经过3步才能第一次返回“绿”，之后是6步，9步，...。返回步数的集合是 $\{3, 6, 9, ...\}$，其最大公约数是3。因此，“绿”灯[状态的周期](@entry_id:276903)是3。

然而，周期的计算可能比直观感觉更微妙。考虑一个无人机在仓库中执行任务的模型，其状态为 {C:充电, F:取货, D:送货} [@problem_id:1290016]。其转移规则是：
1. C $\to$ F (概率为1)
2. F $\to$ D (概率为1)
3. D $\to$ C (概率为 $p$) 或 D $\to$ F (概率为 $1-p$)

我们来计算状态 C 的周期。从 C 出发，可能的返回路径有哪些？
- 最短的路径是 C $\to$ F $\to$ D $\to$ C。这条路径需要3步。所以3是可能的返回步数之一。
- 如果在 D 状态时，无人机没有返回 C，而是去了 F，那么路径就变成了 C $\to$ F $\to$ D $\to$ F $\to$ D $\to$ C。这条路径需要5步。所以5也是可能的返回步数之一。

由于返回 C 的步数集合中包含了3和5，而 $\text{gcd}(3, 5) = 1$，因此状态 C 的周期 $d(C) = 1$。这个状态是**非周期的**。这个例子说明，即使系统中存在明显的[循环结构](@entry_id:147026)，只要有一条“捷径”或“旁路”打破了步数的固定倍数关系，状态就可能是非周期的。

一个既是常返又是非周期的状态被称为**遍历的 (ergodic)**。遍历性是马尔可夫链达到[统计平衡](@entry_id:186577)（即存在唯一的[稳态分布](@entry_id:149079)）的重要条件之一，我们将在后续章节中深入探讨。

通过对状态进行分类，我们揭示了马尔可夫链的深层结构，为预测其[长期行为](@entry_id:192358)和[稳态](@entry_id:182458)特性奠定了坚实的基础。