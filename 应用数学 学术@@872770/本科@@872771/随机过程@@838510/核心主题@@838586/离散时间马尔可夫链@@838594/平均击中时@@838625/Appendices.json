{"hands_on_practices": [{"introduction": "许多涉及在对称结构上进行随机游走的问题都可以被极大地简化。本练习探讨了在立方体顶点上的随机游走 [@problem_id:1318153]。通过利用立方体的对称性，我们可以将顶点分为几个不同的组，这极大地降低了计算平均到达时间的复杂性，并展示了首步分析法的威力。", "problem": "一只蜘蛛位于一个立方体线框的一个顶点上，该立方体由8个顶点和12条等长的边组成。蜘蛛开始沿着立方体的边移动。在每个顶点，蜘蛛会随机且等概率地选择三条相连的边中的一条走到下一个顶点。在随后的每个顶点，这个过程都会重复。\n\n蜘蛛的目标是到达与其起始顶点成对角线相对的顶点。计算蜘蛛首次到达目的地需要走的期望步数（即经过的边数）。", "solution": "将蜘蛛的运动建模为在三维超立方体图上的一个简单随机游走。根据对称性，到达目标的期望时间仅取决于与目标顶点的图距离。设 $E_{d}$ 为从距离目标为 $d$ 的顶点出发，首次到达目标所需的期望步数，其中 $d \\in \\{0,1,2,3\\}$。显然，$E_{0}=0$。\n\n在超立方体上，每一步恰好翻转一个坐标，因此每一步距离目标的变化量为 $\\pm 1$。从一个距离为 $d$ 的顶点出发，有 $d$ 个邻居的距离为 $d-1$（翻转 $d$ 个不同坐标中的一个），有 $3-d$ 个邻居的距离为 $d+1$（翻转 $3-d$ 个相同坐标中的一个）。由于3条边中的每一条被选择的概率都是 $\\frac{1}{3}$，对于 $d=1,2,3$ 的第一步递推关系是\n$$\nE_{d} \\;=\\; 1 \\;+\\; \\frac{d}{3}\\,E_{d-1} \\;+\\; \\frac{3-d}{3}\\,E_{d+1},\n$$\n边界条件为 $E_{0}=0$，且当 $d=3$ 时 $\\frac{3-d}{3}=0$，因此不需要 $E_{4}$ 项。\n\n将这些方程明确写出：\n$$\nE_{1} \\;=\\; 1 \\;+\\; \\frac{1}{3}E_{0} \\;+\\; \\frac{2}{3}E_{2} \\;=\\; 1 \\;+\\; \\frac{2}{3}E_{2},\n$$\n$$\nE_{2} \\;=\\; 1 \\;+\\; \\frac{2}{3}E_{1} \\;+\\; \\frac{1}{3}E_{3},\n$$\n$$\nE_{3} \\;=\\; 1 \\;+\\; E_{2}.\n$$\n\n将 $E_{3}=1+E_{2}$ 代入 $E_{2}$ 的方程中：\n$$\nE_{2} \\;=\\; 1 \\;+\\; \\frac{2}{3}E_{1} \\;+\\; \\frac{1}{3}(1+E_{2})\n\\;=\\; \\frac{4}{3} \\;+\\; \\frac{2}{3}E_{1} \\;+\\; \\frac{1}{3}E_{2}.\n$$\n整理得：\n$$\nE_{2} - \\frac{1}{3}E_{2} \\;=\\; \\frac{4}{3} \\;+\\; \\frac{2}{3}E_{1}\n\\;\\;\\Rightarrow\\;\\; \\frac{2}{3}E_{2} \\;=\\; \\frac{4}{3} \\;+\\; \\frac{2}{3}E_{1}\n\\;\\;\\Rightarrow\\;\\; E_{2} \\;=\\; 2 + E_{1}.\n$$\n将上式代入 $E_{1}$ 的方程中：\n$$\nE_{1} \\;=\\; 1 \\;+\\; \\frac{2}{3}E_{2}\n\\;=\\; 1 \\;+\\; \\frac{2}{3}(2 + E_{1})\n\\;=\\; 1 \\;+\\; \\frac{4}{3} \\;+\\; \\frac{2}{3}E_{1}\n\\;=\\; \\frac{7}{3} \\;+\\; \\frac{2}{3}E_{1}.\n$$\n因此\n$$\nE_{1} - \\frac{2}{3}E_{1} \\;=\\; \\frac{7}{3}\n\\;\\;\\Rightarrow\\;\\; \\frac{1}{3}E_{1} \\;=\\; \\frac{7}{3}\n\\;\\;\\Rightarrow\\;\\; E_{1} \\;=\\; 7.\n$$\n于是\n$$\nE_{2} \\;=\\; 2 + E_{1} \\;=\\; 9,\n\\qquad\nE_{3} \\;=\\; 1 + E_{2} \\;=\\; 10.\n$$\n\n蜘蛛从距离目标为3的顶点（相对顶点）出发，所以期望步数为 $E_{3}=10$。", "answer": "$$\\boxed{10}$$", "id": "1318153"}, {"introduction": "在随机过程中，“状态”不一定总是物理位置；它也可以是系统的一个抽象属性。本练习模拟了一个校验和计算过程，要求计算累加和首次能被5整除的期望时间 [@problem_id:1318167]。它提供了一个绝佳的机会来处理由模运算定义的状态空间，并介绍了马尔可夫链的平稳分布与其平均返回时间之间的优美关系。", "problem": "在一个简化的数据传输协议模型中，一个数据包流被顺序发送。每个数据包包含一个数值。协议维持一个动态校验和，它是到目前为止接收到的所有数据包数值的累积和。该协议要求，一次传输被视为完成的条件是，最终的校验和必须是5的倍数。\n\n假设生成一个测试数据流，其中每个数据包的数值是从集合 $\\{1, 2, 3, 4, 5, 6\\}$ 中均匀随机抽取的整数。在接收任何数据包之前，该过程以0的校验和开始。\n\n直到动态校验和首次成为一个非零的5的倍数，需要接收的数据包的期望数量是多少？请将答案表示为一个精确的数值。", "solution": "设 $X_{1}, X_{2}, \\ldots$ 是独立同分布 (i.i.d.) 的随机变量，对于 $j \\in \\{1,2,3,4,5,6\\}$，有 $\\mathbb{P}(X_{k}=j)=\\frac{1}{6}$。设动态校验和为 $S_{n}=\\sum_{k=1}^{n} X_{k}$。定义模 $5$ 的过程为 $Y_{n}=S_{n} \\bmod 5 \\in \\{0,1,2,3,4\\}$，且 $Y_{0}=0$。我们要求的是首达时间的期望值\n$$\nT=\\min\\{n \\ge 1 : Y_{n}=0\\}.\n$$\n模 $5$ 的步长分布由下式给出：\n$$\n\\mathbb{P}(X \\equiv 0 \\bmod 5)=\\frac{1}{6},\\quad \\mathbb{P}(X \\equiv 1 \\bmod 5)=\\frac{2}{6},\\quad \\mathbb{P}(X \\equiv 2 \\bmod 5)=\\frac{1}{6},\\quad \\mathbb{P}(X \\equiv 3 \\bmod 5)=\\frac{1}{6},\\quad \\mathbb{P}(X \\equiv 4 \\bmod 5)=\\frac{1}{6}.\n$$\n因此，$\\{Y_{n}\\}$ 是在 $\\{0,1,2,3,4\\}$ 上的一个马尔可夫链，其转移概率为\n$$\nP_{r,s}=\\mathbb{P}(Y_{n+1}=s \\mid Y_{n}=r)=p_{(s-r)\\bmod 5},\n$$\n其中 $(p_{0},p_{1},p_{2},p_{3},p_{4})=\\left(\\frac{1}{6},\\frac{1}{3},\\frac{1}{6},\\frac{1}{6},\\frac{1}{6}\\right)$。这个转移矩阵是循环矩阵，且每一列的和都等于 $1$，因为对于固定的 $s$，有\n$$\n\\sum_{r=0}^{4} P_{r,s}=\\sum_{r=0}^{4} p_{(s-r)\\bmod 5}=\\sum_{k=0}^{4} p_{k}=1.\n$$\n因此，$\\pi_{r}=\\frac{1}{5}$ 的均匀分布 $\\pi$ 是平稳分布：\n$$\n\\sum_{r=0}^{4} \\pi_{r} P_{r,s}=\\frac{1}{5} \\sum_{r=0}^{4} P_{r,s}=\\frac{1}{5}.\n$$\n该链是不可约的，因为 $p_{1}0$ 意味着任何状态都可以通过重复的模 $5$ 加 $1$ 步从任何其他状态到达。由于状态空间是有限的，它也是正常返的。根据标准的马尔可夫链返回定理（Kac公式），从状态 $i$ 出发返回到状态 $i$ 的期望时间是\n$$\n\\mathbb{E}_{i}[T_{i}^{+}]=\\frac{1}{\\pi_{i}}.\n$$\n取 $i=0$ 得到\n$$\n\\mathbb{E}[T]=\\frac{1}{\\pi_{0}}=\\frac{1}{1/5}=5.\n$$\n这个 $T$ 正是直到校验和首次成为一个非零的5的倍数（时间至少为 $1$）时所需的数据包数量，而抽取到 $X=5$ 的可能性对应于一步立即返回，这已正确地包含在此公式中。", "answer": "$$\\boxed{5}$$", "id": "1318167"}, {"introduction": "计算首次出现特定结果序列的期望时间是一个经典问题，其应用范围从金融到生物信息学。本练习要求我们计算为了首次得到“正-反-正”模式所需的期望投掷次数 [@problem_id:1318139]。解决这类问题的关键是巧妙地定义状态，以表示朝向目标模式的部分进展，这是分析序列过程的一项基本技巧。", "problem": "一枚有偏的硬币被重复抛掷。正面 (H) 朝上的概率为 $p$，其中 $0  p  1$。因此，反面 (T) 朝上的概率为 $1-p$。每次抛掷都是独立事件。计算首次观察到序列“正-反-正”（HTH）所需的期望抛掷次数。你的答案应该是一个以 $p$ 表示的封闭形式解析表达式。", "solution": "设目标模式为 HTH，并根据已观察序列的最长后缀与 HTH 的前缀匹配的长度来定义状态：\n- 状态 $0$：不匹配，\n- 状态 $1$：后缀为 $H$，\n- 状态 $2$：后缀为 $HT$，\n- 状态 $3$：吸收态（观察到模式 HTH）。\n\n设 $E_{i}$ 为从状态 $i$ 开始达到状态 $3$ 所需的期望额外抛掷次数。我们要求解 $E_{0}$。\n\n状态转移：\n- 从状态 $0$ 开始：以概率 $p$ 转移到状态 $1$（抛出 $H$），以概率 $1-p$ 停留在状态 $0$（抛出 $T$）。因此\n$$\nE_{0} = 1 + p E_{1} + (1-p) E_{0}.\n$$\n- 从状态 $1$ 开始：以概率 $p$ 停留在状态 $1$（抛出 $H$，后缀仍为 $H$），以概率 $1-p$ 转移到状态 $2$（抛出 $T$，后缀为 $HT$）。因此\n$$\nE_{1} = 1 + p E_{1} + (1-p) E_{2}.\n$$\n- 从状态 $2$ 开始：以概率 $p$ 转移到状态 $3$（抛出 $H$，模式完成），以概率 $1-p$ 转移到状态 $0$（抛出 $T$，无匹配前缀）。因此\n$$\nE_{2} = 1 + p \\cdot 0 + (1-p) E_{0} = 1 + (1-p) E_{0}.\n$$\n\n求解该方程组。由第一个方程，\n$$\nE_{0} - (1-p) E_{0} = 1 + p E_{1} \\quad \\Rightarrow \\quad p E_{0} = 1 + p E_{1} \\quad \\Rightarrow \\quad E_{0} = \\frac{1}{p} + E_{1}.\n$$\n由第二个方程，\n$$\nE_{1} - p E_{1} = 1 + (1-p) E_{2} \\quad \\Rightarrow \\quad (1-p) E_{1} = 1 + (1-p) E_{2} \\quad \\Rightarrow \\quad E_{1} = \\frac{1}{1-p} + E_{2}.\n$$\n将 $E_{2} = 1 + (1-p) E_{0}$ 代入 $E_{1}$ 的表达式得到\n$$\nE_{1} = \\frac{1}{1-p} + 1 + (1-p) E_{0}.\n$$\n将此式代入 $E_{0} = \\frac{1}{p} + E_{1}$：\n$$\nE_{0} = \\frac{1}{p} + \\frac{1}{1-p} + 1 + (1-p) E_{0}.\n$$\n整理以求解 $E_{0}$：\n$$\nE_{0} - (1-p) E_{0} = \\frac{1}{p} + \\frac{1}{1-p} + 1 \\quad \\Rightarrow \\quad p E_{0} = \\frac{1}{p} + \\frac{1}{1-p} + 1,\n$$\n$$\nE_{0} = \\frac{1}{p^{2}} + \\frac{1}{p(1-p)} + \\frac{1}{p} = \\frac{1 + p - p^{2}}{p^{2} (1-p)}.\n$$\n因此，首次观察到 HTH 所需的期望抛掷次数为 $\\frac{1 + p - p^{2}}{p^{2} (1-p)}$。", "answer": "$$\\boxed{\\frac{1+p-p^{2}}{p^{2}\\left(1-p\\right)}}$$", "id": "1318139"}]}