{"hands_on_practices": [{"introduction": "理解常返态最直接的方法是在一个具体的例子中计算它的性质。这个问题模拟了一个简单的数字系统，其状态由一个计数器的奇偶性决定。通过将这个系统构建成一个双状态马尔可夫链，我们将计算一个关键指标：平均返回时间。这个练习将帮助我们巩固平稳分布与常返态的期望返回时间之间的重要联系 [@problem_id:1329896]。", "problem": "一个自适应数字系统的简化模型涉及一个计数器，其奇偶性（偶数或奇数）决定了系统的运行模式。系统的状态由一个从0开始的内部计数器跟踪。在每个时间步，一个特定的伪随机数生成器（PRNG）生成一个随机整数，并加到计数器上。PRNG模式的选择取决于计数器当前的奇偶性。\n\n- 如果计数器的当前值为偶数，系统使用PRNG模式E。在此模式下，生成一个奇数的概率为 $q_E = 1/3$。\n- 如果计数器的当前值为奇数，系统使用PRNG模式O。在此模式下，生成一个奇数的概率为 $q_O = 3/4$。\n\n如果计数器的值为偶数，则认为系统处于状态“E”；如果值为奇数，则处于状态“O”。关于状态“E”及其平均返回时间（即系统从状态“E”出发，首次返回状态“E”的期望步数），以下哪个陈述是正确的？\n\nA. 状态“E”是暂留的。\n\nB. 状态“E”是常返的，并且返回的期望步数是 $13/9$。\n\nC. 状态“E”是常返的，并且返回的期望步数是 $13/4$。\n\nD. 状态“E”是常返的，并且返回的期望步数是 $9/13$。\n\nE. 状态“E”是常返的，并且返回的期望步数是 $2$。", "solution": "将计数器的奇偶性解释为一个具有两个状态E（偶数）和O（奇数）的时间齐次马尔可夫链。加上一个奇数会改变奇偶性；加上一个偶数会保持奇偶性。\n\n根据题意：\n- 在状态E中，生成一个奇数的概率为 $q_{E} = \\frac{1}{3}$，因此\n$$\nP(E \\to O) = \\frac{1}{3}, \\quad P(E \\to E) = 1 - \\frac{1}{3} = \\frac{2}{3}.\n$$\n- 在状态O中，生成一个奇数的概率为 $q_{O} = \\frac{3}{4}$，因此\n$$\nP(O \\to E) = \\frac{3}{4}, \\quad P(O \\to O) = 1 - \\frac{3}{4} = \\frac{1}{4}.\n$$\n\n两个状态之间的所有转移概率都严格为正，因此该链是不可约的。由于 $P(E \\to E) = \\frac{2}{3}  0$ 且 $P(O \\to O) = \\frac{1}{4}  0$，该链是非周期的。任何不可约的有限马尔可夫链都是正常返的；因此状态E是常返的。\n\n设平稳分布为 $(\\pi_{E}, \\pi_{O})$，其中 $\\pi_{E} + \\pi_{O} = 1$ 且 $\\pi = \\pi P$。使用 $\\pi = \\pi P$ 的E分量，\n$$\n\\pi_{E} = \\pi_{E}\\left(\\frac{2}{3}\\right) + \\pi_{O}\\left(\\frac{3}{4}\\right).\n$$\n整理得到\n$$\n\\pi_{E} - \\frac{2}{3}\\pi_{E} = \\frac{3}{4}\\pi_{O} \\quad \\Longrightarrow \\quad \\frac{1}{3}\\pi_{E} = \\frac{3}{4}\\pi_{O}.\n$$\n两边同乘以12以消去分母：\n$$\n4\\pi_{E} = 9\\pi_{O}.\n$$\n使用 $\\pi_{E} + \\pi_{O} = 1$，代入 $\\pi_{O} = 1 - \\pi_{E}$：\n$$\n4\\pi_{E} = 9(1 - \\pi_{E}) \\quad \\Longrightarrow \\quad 4\\pi_{E} = 9 - 9\\pi_{E} \\quad \\Longrightarrow \\quad 13\\pi_{E} = 9,\n$$\n因此\n$$\n\\pi_{E} = \\frac{9}{13}.\n$$\n\n对于一个不可约的正常返马尔可夫链，到状态E的平均返回时间等于 $1/\\pi_{E}$。因此，\n$$\n\\text{到E的平均返回时间} = \\frac{1}{\\pi_{E}} = \\frac{13}{9}.\n$$\n因此，E是常返的，其期望返回时间为 $\\frac{13}{9}$，这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1329896"}, {"introduction": "在熟悉了常返态之后，理解它的对立概念——暂留态——也同样至关重要。这个问题提出了一个基于数论的有趣随机过程。通过分析这个过程，我们可以清晰地看到为什么某些状态一旦离开就永远无法返回，这为常返态的概念提供了一个鲜明的对比，从而加深我们对其形式化定义的理解 [@problem_id:1329898]。", "problem": "考虑一个定义在整数状态空间 $S = \\{k \\in \\mathbb{Z} \\mid k > 1\\}$ 上的随机过程 $\\{X_t\\}_{t=0,1,2,\\dots}$。该过程演变如下：\n给定当前状态为 $X_t = k$，从 $k$ 的所有不同质因数的集合中等概率地随机选择一个质因数。这个被选中的质因数成为下一个状态 $X_{t+1}$。\n\n例如，如果当前状态是 $X_t = 12$，其质因数分解为 $2^2 \\cdot 3^1$。不同质因数的集合是 $\\{2, 3\\}$。下一个状态 $X_{t+1}$ 将以 $1/2$ 的概率为 $2$ 或以 $1/2$ 的概率为 $3$。\n\n如果从状态 $i$ 出发，过程必然最终返回到状态 $i$，则称状态 $i \\in S$ 为**常返状态**。形式上，如果 $P(\\exists t \\ge 1 \\text{ such that } X_t = i \\mid X_0 = i) = 1$，则 $i$ 是常返的。如果这个概率小于 1，则该状态被称为暂留状态。\n\n关于这个过程的状态，下列哪个陈述是正确的？\n\nA. 所有合数都是常返状态。\n\nB. 没有合数是常返状态。\n\nC. 一个合数 $c$ 是常返状态当且仅当 $c$ 是一个完全平方数。\n\nD. 一个合数 $c$ 是常返状态当且仅当 $c$ 恰好有两个不同的质因数。\n\nE. 一个合数是否是常返的，取决于在 $t=0$ 时选择的初始状态。", "solution": "令 $S=\\{k\\in \\mathbb{Z}:k1\\}$，转移规则为：给定 $X_{t}=k$，从 $k$ 的不同质因数的集合中等概率地随机选择一个元素，并将 $X_{t+1}$ 设为该质数。\n\n对于任何合数 $c\\in S$，令 $\\mathcal{P}(c)$ 表示 $c$ 的不同质因数的集合，并令 $r(c)=|\\mathcal{P}(c)|$。根据定义，\n$$\n\\forall p\\in \\mathcal{P}(c):\\quad \\mathbb{P}(X_{t+1}=p\\mid X_{t}=c)=\\frac{1}{r(c)}.\n$$\n特别地，只要 $X_t$ 是合数，那么 $X_{t+1}$ 是质数的概率为 $1$。如果 $p$ 是一个质数，那么它唯一不同的质因数就是它本身，所以\n$$\n\\mathbb{P}(X_{t+1}=p\\mid X_{t}=p)=1,\n$$\n这意味着每个质数状态都是吸收态：\n$$\nX_{0}=p\\implies X_{t}=p\\text{ for all }t\\geq 0.\n$$\n\n考虑任何合数状态 $c$。从 $X_{0}=c$ 开始，我们有\n$$\n\\mathbb{P}(X_{1}\\text{ is prime}\\mid X_{0}=c)=1,\n$$\n并且一旦在时刻 $1$ 到达一个质数，该链将永远停留在那个质数上：\n$$\nX_{1}=p\\ \\text{prime}\\ \\implies\\ X_{t}=p\\ \\text{for all }t\\geq 1.\n$$\n因此，从 $X_{0}=c$ 出发，事件 $\\{\\exists t\\geq 1:\\ X_{t}=c\\}$ 是不可能发生的，所以\n$$\n\\mathbb{P}\\big(\\exists t\\geq 1:\\ X_{t}=c\\mid X_{0}=c\\big)=0.\n$$\n根据常返的定义，这表明每个合数状态都是暂留的。因此，没有一个合数是常返的。\n\n在给出的陈述中，这个结论与选项 B 完全对应。所有其他选项都是错误的：A 与上述结论相矛盾；C 对完全平方数（例如 $c=4$）不成立，它会转移到 $2$ 并且永不返回；D 对 $c=pq$（其中 $p,q$ 是不同的质数）不成立，它会转移到 $p$ 或 $q$ 中的一个并且永不返回；E 是错误的，因为一个状态的常返分类是一个内在属性，并且如上所示，无论初始分布如何（除了从状态本身开始），合数都是暂留的。", "answer": "$$\\boxed{B}$$", "id": "1329898"}, {"introduction": "一个状态是常返的还是暂留的，并不仅仅取决于系统的转换规则，有时它还深刻地依赖于状态空间的几何结构。这个关于晶格上相互作用粒子的思想实验就探讨了这一深刻思想。通过研究粒子间的相对运动，我们将把碰撞是否重现的问题与随机游走的经典常返问题联系起来，并揭示其对空间维度的惊人依赖性 [@problem_id:1329934]。", "problem": "考虑一个假设的物理系统，其中包含两个相互作用的粒子，一个“zeton”和一个“anti-zeton”，它们位于一个由整数坐标 $\\mathbb{Z}^d$ 表示的无穷$d$维立方晶格上。设它们在离散时间步 $n$ 的位置由向量 $X_n \\in \\mathbb{Z}^d$ 和 $Y_n \\in \\mathbb{Z}^d$ 表示。粒子在“碰撞态”下被创造，这意味着它们从同一位置开始。它们的后续演化遵循以下规则：\n\n1.  **独立随机游走**：只要粒子位于不同位置（$X_n \\neq Y_n$），它们各自进行独立的、简单的对称随机游走。在 $\\mathbb{Z}^d$ 上的简单对称随机游走中，位于位置 $\\vec{v}$ 的粒子会移动到其 $2d$ 个最近邻位置之一 $\\vec{v} \\pm \\vec{e_i}$（其中 $\\{\\vec{e_1}, \\dots, \\vec{e_d}\\}$ 是标准基），$2d$ 种可能的移动中的每一种都以相等的概率 $1/(2d)$ 被选择。\n\n2.  **湮灭-再生成相互作用**：如果粒子在同一位置相遇（$X_n = Y_n$），则称它们“湮灭”。该事件会触发下一步的特殊再生成规则。如果 $X_n = Y_n = \\vec{k}$，则它们在时间 $n+1$ 的位置被设置为 $X_{n+1} = \\vec{k} + \\vec{\\zeta}$ 和 $Y_{n+1} = \\vec{k} - \\vec{\\zeta}$。步长向量 $\\vec{\\zeta}$ 是从 $2d$ 个可能的最近邻步长向量 $\\{\\pm \\vec{e_1}, \\dots, \\pm \\vec{e_d}\\}$ 中均匀随机选择的。此相互作用规则取代了紧随碰撞之后的标准随机游走动力学。\n\n“碰撞态”是系统中任何满足 $X_n = Y_n$ 的构型。如果一个马尔可夫过程从某个状态集出发，最终返回该状态集的概率为1，则称该过程对于此状态集是常返的。在此背景下，如果一次碰撞后，后续碰撞必然会在某个稍后时刻发生，我们就定义碰撞态是常返的。如果此概率小于1，则碰撞态是暂留的。\n\n对于哪些整数维度 $d \\ge 1$，碰撞态是常返的？\n\nA. 仅当 $d = 1$。\n\nB. 仅当 $d = 2$。\n\nC. 当 $d = 1$ 和 $d = 2$。\n\nD. 仅当 $d \\ge 3$。\n\nE. 对于所有维度 $d \\ge 1$。", "solution": "定义差分过程 $D_{n}=X_{n}-Y_{n}\\in \\mathbb{Z}^{d}$。在时间 $n$ 的一次碰撞等价于 $D_{n}=0$。我们分析 $D_{n}$ 以确定从一次碰撞开始，该过程是否以概率1返回到 $D=0$。\n\n当 $D_{n}\\neq 0$ 时，粒子通过简单的对称最近邻步长独立移动。设 $U_{n}$ 和 $V_{n}$ 表示它们在时间 $n$ 的步长，其中 $U_{n}$ 和 $V_{n}$ 均在 $\\{\\pm \\vec{e}_{1},\\dots,\\pm \\vec{e}_{d}\\}$ 上均匀分布且相互独立。那么\n$$\nD_{n+1}-D_{n}=U_{n}-V_{n}.\n$$\n因此\n$$\n\\mathbb{E}[D_{n+1}-D_{n}]=\\mathbb{E}[U_{n}]-\\mathbb{E}[V_{n}]=0,\n$$\n并且，利用独立性，\n$$\n\\operatorname{Cov}(D_{n+1}-D_{n})=\\operatorname{Cov}(U_{n})+\\operatorname{Cov}(V_{n}),\n$$\n这是一个有限的正定矩阵，因为每个 $U_{n}$（和 $V_{n}$）都以相等的概率取 $2d$ 个单位向量之一。因此，在远离 $0$ 的地方，$D_{n}$ 是一个在 $\\mathbb{Z}^{d}$ 上的对称、空间均匀的随机游走，其均值为零且具有有限二阶矩。增量分布允许 $D_{n+1}-D_{n}=0$ 具有正概率（当 $U_{n}=V_{n}$ 时），这使得该游走是惰性的；惰性不影响常返性与暂留性。\n\n在碰撞时间 $n$ 且 $D_{n}=0$ 时，特殊规则规定\n$$\nX_{n+1}= \\vec{k}+\\vec{\\zeta},\\quad Y_{n+1}= \\vec{k}-\\vec{\\zeta}\\quad \\text{其中 }\\vec{\\zeta}\\text{ 在 }\\{\\pm \\vec{e}_{1},\\dots,\\pm \\vec{e}_{d}\\}\\text{ 上均匀分布},\n$$\n所以\n$$\nD_{n+1}=X_{n+1}-Y_{n+1}=2\\vec{\\zeta}.\n$$\n因此，从一次碰撞开始，差分过程的碰撞后状态是 $D_{1}=2\\vec{\\zeta}$，它在 $2d$ 个向量 $\\{\\pm 2\\vec{e}_{1},\\dots,\\pm 2\\vec{e}_{d}\\}$ 中均匀分布。从时间 $1$ 开始，直到下一次可能的碰撞，$D_{n}$ 按照上述的独立游走规则演化，即增量为 $U_{n}-V_{n}$。\n\n因此，存在后续碰撞的事件，恰好等价于对称随机游走 $D_{n}$ 从一个固定的非零位置（具体来说是 $\\pm 2\\vec{e}_{i}$ 中的一个）出发，最终能击中 $0$ 的事件。根据 Chung–Fuchs 常返性判据（Pólya 定理的推广），任何在 $\\mathbb{Z}^{d}$ 上均值为零且具有有限二阶矩的对称随机游走，当且仅当 $d\\leq 2$ 时是常返的，当 $d\\geq 3$ 时是暂留的。特别地，对于 $d=1$ 和 $d=2$，从任何起始点到达原点的击中概率为 $1$，而对于 $d\\geq 3$，该概率严格小于 $1$。\n\n因此，从一次碰撞开始，发生后续碰撞的概率为 $1$ 当且仅当 $d=1$ 或 $d=2$，而对于 $d\\geq 3$，该概率小于 $1$。因此，碰撞态仅在维度 $d=1$ 和 $d=2$ 时是常返的。", "answer": "$$\\boxed{C}$$", "id": "1329934"}]}