{"hands_on_practices": [{"introduction": "这第一个练习提供了一个计算简单三状态系统稳态分布的具体例子。通过为一个假设的Web服务器工作负载建立转移矩阵，你将直接应用稳态分布的核心定义：$\\pi = \\pi P$ 以及 $\\sum_i \\pi_i = 1$。这个练习是掌握求解定义马尔可夫链长期行为的线性方程组所需代数步骤的基础。[@problem_id:1334120]", "problem": "一个描述单个 Web 服务器工作负载的简化模型由一个具有三个状态的离散时间马尔可夫链表示：低 (L)、中 (M) 和高 (H)。服务器的状态在固定的时间间隔被观测。状态之间的转移规则如下：\n\n*   如果服务器处于低状态，在下一个时间步它将以概率 $p_{LM} = 1/2$ 转移到中状态。否则，它保持在低状态。\n*   如果服务器处于中状态，它将以概率 $p_{MH} = 1/3$ 转移到高状态，并以概率 $p_{ML} = 1/3$ 转移到低状态。否则，它保持在中状态。\n*   如果服务器处于高状态，它将以概率 $p_{HM} = 3/4$ 转移到中状态。否则，它保持在高状态。\n\n假设服务器已经运行了很长时间并达到了稳态，计算服务器处于高负载状态的长期时间比例。将你的答案表示为最简精确分数。", "solution": "我们将该系统建模为状态为 $L, M, H$ 的离散时间马尔可夫链，其转移矩阵为 $P$（行和列按 $L, M, H$ 排序）：\n$$\nP=\\begin{pmatrix}\n\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n\\frac{1}{3}  \\frac{1}{3}  \\frac{1}{3} \\\\\n0  \\frac{3}{4}  \\frac{1}{4}\n\\end{pmatrix}.\n$$\n该链是不可约的（每个状态都可以通过给定的转移与其他状态互通）且非周期的（每个状态都有一个正的自循环），因此它有一个唯一的平稳分布。\n\n设平稳分布为 $\\pi=(x,y,z)$，对应于 $(L,M,H)$，其中 $x,y,z \\ge 0$ 且 $x+y+z=1$。平稳性条件 $\\pi=\\pi P$ 产生了以下分量方程：\n$$\nx = \\frac{1}{2}x + \\frac{1}{3}y + 0\\cdot z,\n$$\n$$\ny = \\frac{1}{2}x + \\frac{1}{3}y + \\frac{3}{4}z,\n$$\n$$\nz = 0\\cdot x + \\frac{1}{3}y + \\frac{1}{4}z,\n$$\n以及归一化条件 $x+y+z=1$。\n\n从 $L$ 分量方程，\n$$\nx - \\frac{1}{2}x = \\frac{1}{3}y \\quad \\Longrightarrow \\quad \\frac{1}{2}x = \\frac{1}{3}y \\quad \\Longrightarrow \\quad y = \\frac{3}{2}x.\n$$\n从 $H$ 分量方程，\n$$\nz - \\frac{1}{4}z = \\frac{1}{3}y \\quad \\Longrightarrow \\quad \\frac{3}{4}z = \\frac{1}{3}y \\quad \\Longrightarrow \\quad z = \\frac{4}{9}y.\n$$\n将 $y=\\frac{3}{2}x$ 代入 $z=\\frac{4}{9}y$ 得\n$$\nz = \\frac{4}{9}\\cdot \\frac{3}{2}x = \\frac{2}{3}x.\n$$\n使用归一化条件：\n$$\nx + y + z = x + \\frac{3}{2}x + \\frac{2}{3}x = \\left(1 + \\frac{3}{2} + \\frac{2}{3}\\right)x = \\frac{19}{6}x = 1,\n$$\n所以\n$$\nx = \\frac{6}{19}, \\quad y = \\frac{3}{2}x = \\frac{9}{19}, \\quad z = \\frac{2}{3}x = \\frac{4}{19}.\n$$\n因此，处于高状态的长期时间比例是 $z=\\frac{4}{19}$。", "answer": "$$\\boxed{\\frac{4}{19}}$$", "id": "1334120"}, {"introduction": "当状态空间变大时，直接求解线性方程组会变得非常繁琐。这个练习将挑战你为一个规模可变的系统寻找一个通用解，并在此过程中引入一个更巧妙、更强大的方法：细致平衡原理（detailed balance）。通过将这一概念应用于一个基因调控模型（一种生灭过程），你将学会如何推导稳态分布的解析表达式，这是分析可扩展随机模型的关键技能。[@problem_id:1334119]", "problem": "考虑一个调控单个基因的简化模型。基因的活性水平由其启动子区域决定，我们将其建模为一个系统，该系统具有 $N$ 个不同的结合位点，用于结合某种类型的调控分子。系统的状态由整数 $k$ 描述，表示被占据的结合位点的数量，其中 $k$ 的取值范围为从 $0$ 到 $N$。因此，系统可以处于 $N+1$ 个可能的状态之一 $\\{0, 1, \\dots, N\\}$。\n\n状态之间的转换以离散的时间步长发生。在每个时间步，从 $N$ 个位点中均匀随机地选择一个。如果选中的位点被占据，它就变为空置。如果它未被占据，它就被占据。这个过程可以更形式化地描述如下：\n假设系统处于状态 $k$，意味着有 $k$ 个位点被占据，有 $N-k$ 个位点未被占据。\n- 如果 $0  k  N$，当选择到 $k$ 个被占据位点中的一个时，系统会转换到状态 $k-1$；当选择到 $N-k$ 个未被占据位点中的一个时，系统会转换到状态 $k+1$。\n- 如果系统处于状态 $k=0$（所有位点均为空置），任何被选中的位点都将是未被占据的，因此它会变为被占据。所以系统必须转换到状态 $k=1$。\n- 如果系统处于状态 $k=N$（所有位点均被占据），任何被选中的位点都将是被占据的，因此它会变为空置。所以系统必须转换到状态 $k=N-1$。\n\n这个过程在状态空间 $\\{0, 1, \\dots, N\\}$ 上定义了一个马尔可夫链。经过很长一段时间后，系统预期会达到一个由平稳分布 $\\pi_k$ 描述的统计平衡状态，$\\pi_k$ 表示系统处于状态 $k$ 的长期概率。\n\n对于任意状态 $k$（其中 $0 \\le k \\le N$），确定其平稳分布 $\\pi_k$。你的答案应该是一个关于 $k$ 和 $N$ 的解析表达式。", "solution": "该过程定义了一个在状态空间 $\\{0, 1, \\dots, N\\}$ 上的生灭过程（birth-death process）。我们首先确定转移概率。\n对于一个处于状态 $k$ 的系统（其中 $0  k  N$），有 $k$ 个被占据的位点和 $N-k$ 个未被占据的位点。在总共 $N$ 个位点中选择一个。\n- 转移到状态 $k+1$ 的概率是选择一个未被占据的位点，即 $P_{k,k+1} = \\frac{N-k}{N}$。\n- 转移到状态 $k-1$ 的概率是选择一个被占据的位点，即 $P_{k,k-1} = \\frac{k}{N}$。\n\n对于边界状态：\n- 如果系统处于状态 $k=0$，所有 $N$ 个位点都是未被占据的，所以系统必定转移到状态 $1$。因此，$P_{0,1} = 1$。\n- 如果系统处于状态 $k=N$，所有 $N$ 个位点都是被占据的，所以系统必定转移到状态 $N-1$。因此，$P_{N,N-1} = 1$。\n\n这条马尔可夫链是不可约的，因此存在唯一的平稳分布 $\\pi = (\\pi_0, \\pi_1, \\dots, \\pi_N)$。我们可以使用细致平衡条件来求解：\n$$ \\pi_k P_{k, k+1} = \\pi_{k+1} P_{k+1, k} \\quad \\text{for } k = 0, 1, \\dots, N-1 $$\n将我们导出的转移概率代入（对于 $0  k  N-1$）：\n$$ \\pi_k \\left(\\frac{N-k}{N}\\right) = \\pi_{k+1} \\left(\\frac{k+1}{N}\\right) $$\n两边乘以 $N$ 后，我们得到一个递归关系：\n$$ \\pi_{k+1} = \\pi_k \\frac{N-k}{k+1} $$\n这个关系对于边界 $k=0$ 和 $k=N-1$ 也成立。我们可以用 $\\pi_0$ 来表示所有的 $\\pi_k$：\n$\\pi_1 = \\pi_0 \\frac{N-0}{0+1} = \\pi_0 \\binom{N}{1}$\n$\\pi_2 = \\pi_1 \\frac{N-1}{1+1} = \\left(\\pi_0 \\binom{N}{1}\\right) \\frac{N-1}{2} = \\pi_0 \\frac{N(N-1)}{2} = \\pi_0 \\binom{N}{2}$\n通过归纳法，我们可以推广得到：\n$$ \\pi_k = \\pi_0 \\binom{N}{k} $$\n最后，我们使用归一化条件 $\\sum_{k=0}^N \\pi_k = 1$ 来确定 $\\pi_0$：\n$$ \\sum_{k=0}^N \\pi_0 \\binom{N}{k} = \\pi_0 \\sum_{k=0}^N \\binom{N}{k} = 1 $$\n根据二项式定理，我们知道 $\\sum_{k=0}^N \\binom{N}{k} = 2^N$。因此：\n$$ \\pi_0 \\cdot 2^N = 1 \\quad \\implies \\quad \\pi_0 = 2^{-N} $$\n将 $\\pi_0$ 的值代回，我们得到平稳分布的最终表达式：\n$$ \\pi_k = 2^{-N} \\binom{N}{k} $$\n这表明，在稳态下，被占据位点的数量服从一个参数为 $(N, 1/2)$ 的二项分布。", "answer": "$$\\boxed{2^{-N}\\binom{N}{k}}$$", "id": "1334119"}, {"introduction": "随机过程的结果有时可能与我们的直觉相悖。这个问题探讨了一个系统的底层结构对称性如何以令人惊讶的方式决定其长期行为。尽管模型中的分子马达具有定向运动偏好（即 $\\alpha \\neq 0.5$），但你会发现其稳态分布是均匀的。这个练习旨在强调严谨分析超越原始直觉的重要性，并展示了通过猜测并验证一个由对称性启发的解，可以极大地简化问题求解过程。[@problem_id:1334104]", "problem": "一个分子马达的生物物理模型描述了其沿着一个环形丝状物的运动。该丝状物由 $N$ 个离散的结合位点组成，依次标记为 $0, 1, 2, \\dots, N-1$，形成一个闭环，其中位点 $N-1$ 与位点 $0$ 相邻。马达的位置被建模为一个离散时间随机过程。在每个时间步，如果马达位于位点 $i$，它将以概率 $\\alpha$ 跳到序列中的下一个位点 $(i+1) \\pmod N$。相应地，它将以概率 $1-\\alpha$ 跳到前一个位点 $(i-1) \\pmod N$。参数 $\\alpha$ 是一个常数，满足 $0  \\alpha  1$，表示马达运动中的方向性偏差。\n\n当系统演化了很长时间后，它会达到一个稳态。确定在稳态下，在任意位点 $k$ 找到该马达的概率，其中 $k$ 是从 $0$ 到 $N-1$ 的整数。请用 $N$ 的封闭形式解析表达式来表示你的答案。", "solution": "将马达建模为在有限状态空间 $\\{0,1,\\dots,N-1\\}$ 上的时齐马尔可夫链，其转移概率为\n$$\nP(i, (i+1) \\bmod N)=\\alpha,\\qquad P(i, (i-1) \\bmod N)=1-\\alpha,\n$$\n所有其他转移的概率为 $0$。对于一个平稳分布 $\\pi=(\\pi_{0},\\dots,\\pi_{N-1})$，平稳性方程要求，对于每个 $k$（下标对 $N$ 取模），\n$$\n\\pi_{k}=\\sum_{j=0}^{N-1}\\pi_{j}P(j,k)=\\pi_{k-1}\\alpha+\\pi_{k+1}(1-\\alpha).\n$$\n根据转移结构的平移不变性，考虑一个常数解 $\\pi_{k}=c$ 对所有 $k$ 成立。代入平稳性方程，得到\n$$\nc=c\\alpha+c(1-\\alpha)=c,\n$$\n这对任意常数 $c$ 都成立。施加归一化条件，\n$$\n\\sum_{k=0}^{N-1}\\pi_{k}=\\sum_{k=0}^{N-1}c=Nc=1,\n$$\n得出 $c=\\frac{1}{N}$。因为 $0  \\alpha  1$，该链在有限状态空间上是不可约的，所以平稳分布是唯一的。因此，在稳态下，在任意位点 $k$ 找到该马达的概率是\n$$\n\\pi_{k}=\\frac{1}{N}.\n$$", "answer": "$$\\boxed{\\frac{1}{N}}$$", "id": "1334104"}]}