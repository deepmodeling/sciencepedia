{"hands_on_practices": [{"introduction": "本练习旨在通过一个日常生活的简单场景，帮助你掌握计算n步转移概率的基本方法。我们将运用马尔可夫链的核心工具——转移概率矩阵，通过矩阵乘法来预测一个系统在未来某个特定时间点所处的状态。这个问题直接考察了你对查普曼-科尔莫戈罗夫方程基本原理的理解和应用 [@problem_id:1320922]。", "problem": "某大学生的每日学习地点可以被建模为一个离散时间马尔可夫链。该学生每天会从三个地点中选择一个：宿舍、学校图书馆或附近的咖啡馆。在分析了该学生的习惯后，确定了这些地点之间的一日转移概率。\n\n定义状态如下：\n状态 1：宿舍\n状态 2：图书馆\n状态 3：咖啡馆\n\n转移概率矩阵 $P$，其中元素 $P_{ij}$ 表示在一天内从状态 $i$ 移动到状态 $j$ 的概率，由下式给出：\n$$\nP = \\begin{pmatrix}\n0.3  0.5  0.2 \\\\\n0.4  0.1  0.5 \\\\\n0.6  0.3  0.1\n\\end{pmatrix}\n$$\n如果该学生周一在宿舍学习，那么他在接下来的周四在图书馆学习的概率是多少？将您的最终答案四舍五入到三位有效数字。", "solution": "我们将每日在不同地点之间的移动建模为一个离散时间马尔可夫链，其转移矩阵为\n$$\nP=\\begin{pmatrix}\n0.3  0.5  0.2 \\\\\n0.4  0.1  0.5 \\\\\n0.6  0.3  0.1\n\\end{pmatrix}.\n$$\n周一从宿舍开始，求周四在图书馆的概率，这对应于一个三步转移（周一到周二，周二到周三，周三到周四）。根据马尔可夫性质，三步转移概率由 $P^{3}$ 的元素给出。因此，所求概率为 $(P^{3})_{1,2}$。\n\n计算 $P^{2}=P\\cdot P$：\n$$\nP^{2}=\\begin{pmatrix}\n0.3  0.5  0.2 \\\\\n0.4  0.1  0.5 \\\\\n0.6  0.3  0.1\n\\end{pmatrix}\n\\begin{pmatrix}\n0.3  0.5  0.2 \\\\\n0.4  0.1  0.5 \\\\\n0.6  0.3  0.1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.41  0.26  0.33 \\\\\n0.46  0.36  0.18 \\\\\n0.36  0.36  0.28\n\\end{pmatrix}.\n$$\n然后\n$$\n(P^{3})_{1,2}=\\sum_{k=1}^{3}(P^{2})_{1,k}P_{k,2}=0.41\\cdot 0.5+0.26\\cdot 0.1+0.33\\cdot 0.3=0.330.\n$$\n四舍五入到三位有效数字，得到 $0.330$。", "answer": "$$\\boxed{0.330}$$", "id": "1320922"}, {"introduction": "在许多实际应用中，我们更关心的是系统在n步之后处于各个状态的概率分布，而非完整的n步转移矩阵。此练习以一个简化的疾病传播模型为例，介绍了一种更高效的计算方法：通过迭代更新状态概率向量来追踪系统随时间演变的过程 [@problem_id:1320929]。这种方法对于分析动态系统的长期行为至关重要。", "problem": "一个简化的医疗模型以离散的周为时间步长，描述了一个人相对于某种特定病毒的健康状况。一个人可能的状态有：易感 (S)、感染 (I) 或康复 (R)。这些状态之间的转换由以下的周概率决定：\n\n- 在给定的一周内处于易感 (S) 状态的个体，在下一周有 80% 的概率保持易感状态，有 20% 的概率变为感染 (I) 状态。\n- 处于感染 (I) 状态的个体，在下一周有 10% 的概率再次变为易感状态（例如，由于免疫力减弱），有 60% 的概率保持感染状态，有 30% 的概率变为康复 (R) 状态。\n- 处于康复 (R) 状态的个体被假定拥有永久免疫力，并将无限期地保持在康复状态。\n\n某一个个体目前处于感染状态。该个体在整整 4 周后处于易感状态的概率是多少？请将答案以保留四位有效数字的小数形式给出。", "solution": "将每周的健康状况建模为一个马尔可夫链，其状态为 $S$、$I$ 和 $R$。设 $(s_{k}, i_{k}, r_{k})$ 分别表示在 $k$ 周后处于状态 $S$、$I$ 和 $R$ 的概率。因为该个体目前处于感染状态，所以初始条件为 $s_{0}=0$, $i_{0}=1$, $r_{0}=0$。\n\n使用给定的转移概率，演化方程为\n$$\ns_{k+1} = 0.8\\,s_{k} + 0.1\\,i_{k}, \\quad\ni_{k+1} = 0.2\\,s_{k} + 0.6\\,i_{k}, \\quad\nr_{k+1} = r_{k} + 0.3\\,i_{k}.\n$$\n\n迭代计算：\n从 $k=0$ 到 $k=1$：\n$$\ns_{1} = 0.8\\cdot 0 + 0.1\\cdot 1 = 0.1, \\quad\ni_{1} = 0.2\\cdot 0 + 0.6\\cdot 1 = 0.6, \\quad\nr_{1} = 0 + 0.3\\cdot 1 = 0.3.\n$$\n\n从 $k=1$ 到 $k=2$：\n$$\ns_{2} = 0.8\\cdot 0.1 + 0.1\\cdot 0.6 = 0.14, \\quad\ni_{2} = 0.2\\cdot 0.1 + 0.6\\cdot 0.6 = 0.38, \\quad\nr_{2} = 0.3 + 0.3\\cdot 0.6 = 0.48.\n$$\n\n从 $k=2$ 到 $k=3$：\n$$\ns_{3} = 0.8\\cdot 0.14 + 0.1\\cdot 0.38 = 0.15, \\quad\ni_{3} = 0.2\\cdot 0.14 + 0.6\\cdot 0.38 = 0.256, \\quad\nr_{3} = 0.48 + 0.3\\cdot 0.38 = 0.594.\n$$\n\n从 $k=3$ 到 $k=4$：\n$$\ns_{4} = 0.8\\cdot 0.15 + 0.1\\cdot 0.256 = 0.1456, \\quad\ni_{4} = 0.2\\cdot 0.15 + 0.6\\cdot 0.256 = 0.1836, \\quad\nr_{4} = 0.594 + 0.3\\cdot 0.256 = 0.6708.\n$$\n\n因此，该个体在整整 4 周后处于易感状态的概率是 $s_{4} = 0.1456$，这已经按要求四舍五入到四位有效数字。", "answer": "$$\\boxed{0.1456}$$", "id": "1320929"}, {"introduction": "这个练习将前一个问题中介绍的迭代计算方法，应用到一个更具现实意义的工程问题上。通过模拟桥梁结构状况随时间的退化过程，你将学会如何运用马尔可夫链进行长期预测和风险评估 [@problem_id:1320892]。这个问题展示了n步转移概率在评估基础设施可靠性和制定维护策略方面的实用价值。", "problem": "桥梁段的结构完整性每年进行评估，并分为四个状态之一：优 (E)、良 (G)、中 (F) 或差 (P)。桥梁的状况逐年演变，这是一个随机过程。根据历史数据，已经为这些年度转变建立了一个模型。一个桥梁段的状况可以保持不变、改善或恶化。然而，在一年内发生大幅变化的可能性极小。具体来说，评为“优”的桥梁段在一年内不会恶化到“中”或“差”，评为“良”的桥梁段在一年内不会恶化到“差”。同样地，改善也是渐进的：评为“差”的桥梁段在一年内不能变为“良”或“优”，评为“中”的桥梁段在一年内不能变为“优”。\n\n一步转移概率由矩阵 $P$ 给出，其中状态按 (E, G, F, P) 的顺序排列：\n$$\nP = \\begin{pmatrix}\n0.70  0.30  0.00  0.00 \\\\\n0.10  0.70  0.20  0.00 \\\\\n0.00  0.15  0.60  0.25 \\\\\n0.00  0.00  0.10  0.90\n\\end{pmatrix}\n$$\n元素 $P_{ij}$ 表示在一年内从状态 $i$ 转移到状态 $j$ 的概率。例如，一个评为“良”的桥梁段在一年内恶化为“中”的概率是 $P_{23} = 0.20$。\n\n如果一个桥梁段目前被评为“优”，那么该桥梁段在整整五年后被评为“中”的概率是多少？将最终答案四舍五入到四位有效数字。", "solution": "我们将年度评级建模为一个时间齐次的马尔可夫链，其转移矩阵为 $P$（状态按 $(E,G,F,P)$ 排序）。如果一个桥梁段目前处于状态 $E$，则 $n$ 年后的分布为 $e_{1}P^{n}$，其中 $e_{1}=(1,0,0,0)$。因此，在整整五年后处于状态 $F$ 的概率是 $P^{5}$ 的第 $(1,3)$ 个元素。\n\n为了计算这个，令 $r_{n}$ 表示 $P^{n}$ 的第一行。那么 $r_{1}$ 是 $P$ 的第一行，并且 $r_{n+1}=r_{n}P$。我们迭代计算：\n\n$r_{1} = [0.70,\\,0.30,\\,0.00,\\,0.00]$。\n\n$r_{2} = r_{1}P$，其分量为\n$$\n\\begin{aligned}\nr_{2,1} = 0.70\\cdot 0.70 + 0.30\\cdot 0.10 = 0.52,\\\\\nr_{2,2} = 0.70\\cdot 0.30 + 0.30\\cdot 0.70 = 0.42,\\\\\nr_{2,3} = 0.70\\cdot 0.00 + 0.30\\cdot 0.20 = 0.06,\\\\\nr_{2,4} = 0.00,\n\\end{aligned}\n$$\n所以 $r_{2}=[0.52,\\,0.42,\\,0.06,\\,0.00]$。\n\n$r_{3} = r_{2}P$，其分量为\n$$\n\\begin{aligned}\nr_{3,1} = 0.52\\cdot 0.70 + 0.42\\cdot 0.10 = 0.406,\\\\\nr_{3,2} = 0.52\\cdot 0.30 + 0.42\\cdot 0.70 + 0.06\\cdot 0.15 = 0.459,\\\\\nr_{3,3} = 0.42\\cdot 0.20 + 0.06\\cdot 0.60 = 0.120,\\\\\nr_{3,4} = 0.06\\cdot 0.25 = 0.015,\n\\end{aligned}\n$$\n所以 $r_{3}=[0.406,\\,0.459,\\,0.120,\\,0.015]$。\n\n$r_{4} = r_{3}P$，其分量为\n$$\n\\begin{aligned}\nr_{4,1} = 0.406\\cdot 0.70 + 0.459\\cdot 0.10 = 0.3301,\\\\\nr_{4,2} = 0.406\\cdot 0.30 + 0.459\\cdot 0.70 + 0.120\\cdot 0.15 = 0.4611,\\\\\nr_{4,3} = 0.459\\cdot 0.20 + 0.120\\cdot 0.60 + 0.015\\cdot 0.10 = 0.1653,\\\\\nr_{4,4} = 0.120\\cdot 0.25 + 0.015\\cdot 0.90 = 0.0435,\n\\end{aligned}\n$$\n所以 $r_{4}=[0.3301,\\,0.4611,\\,0.1653,\\,0.0435]$。\n\n$r_{5} = r_{4}P$，其分量为\n$$\n\\begin{aligned}\nr_{5,1} = 0.3301\\cdot 0.70 + 0.4611\\cdot 0.10 = 0.27718,\\\\\nr_{5,2} = 0.3301\\cdot 0.30 + 0.4611\\cdot 0.70 + 0.1653\\cdot 0.15 = 0.446595,\\\\\nr_{5,3} = 0.4611\\cdot 0.20 + 0.1653\\cdot 0.60 + 0.0435\\cdot 0.10 = 0.19575,\\\\\nr_{5,4} = 0.1653\\cdot 0.25 + 0.0435\\cdot 0.90 = 0.080475.\n\\end{aligned}\n$$\n\n因此，所求概率为 $(P^{5})_{1,3}=r_{5,3}=0.19575$，四舍五入到四位有效数字后为 $0.1958$。", "answer": "$$\\boxed{0.1958}$$", "id": "1320892"}]}