{"hands_on_practices": [{"introduction": "马尔可夫链的图形表示是将抽象随机过程形象化的第一步。本练习通过一个在 2x2 网格中移动的机器人的简单场景，引导你构建状态转移图并计算多步转移概率。掌握这一基本技能是应用马尔可夫链解决更复杂问题的基础。[@problem_id:1305824]", "problem": "一个小型自动清洁机器人在一个方形房间里工作，该房间被划分为一个2x2的网格，包含四个相等的象限。这些象限用坐标标记：(1,1)代表左上角，(1,2)代表右上角，(2,1)代表左下角，(2,2)代表右下角。\n\n机器人的运动被建模为一个离散时间过程。在每个时间步，机器人从其当前象限移动到其相邻的一个象限。如果两个象限共享一条公共边（即，不仅仅是一个角），则它们被定义为“相邻”的。机器人以相等的概率移动到其任何可用的相邻象限。例如，从象限(1,1)出发，机器人只能移动到(1,2)或(2,1)。\n\n如果机器人从左上象限(1,1)开始，它在恰好两个时间步后回到左上象限的概率是多少？请将您的答案表示为保留两位有效数字的小数。", "solution": "设系统的状态为机器人所在的象限。状态空间为 $S = \\{(1,1), (1,2), (2,1), (2,2)\\}$。我们可以将机器人的运动建模为该状态空间上的一个马尔可夫链 (Markov chain)。为了方便表示，我们为这些状态分配数字标签：$1 \\leftrightarrow (1,1)$，$2 \\leftrightarrow (1,2)$，$3 \\leftrightarrow (2,1)$ 和 $4 \\leftrightarrow (2,2)$。\n\n问题要求计算从状态1开始，经过两步后回到状态1的概率。这是两步转移概率矩阵 $P^{(2)}$ 的第 $(1,1)$ 项，即 $(P^2)_{11}$，该矩阵是一步转移矩阵 $P$ 的平方。\n\n首先，我们构建一步转移矩阵 $P$，其中项 $P_{ij}$ 是从状态 $i$ 移动到状态 $j$ 的一步概率。移动规则是在相邻象限中进行均匀随机选择。\n\n从状态 1 (1,1) 出发：相邻象限是 (1,2) 和 (2,1)。因此，机器人以 $1/2$ 的概率移动到状态 2 或状态 3。$P$ 的第一行是 $(0, 1/2, 1/2, 0)$。\n$P_{11}=0, P_{12}=1/2, P_{13}=1/2, P_{14}=0$。\n\n从状态 2 (1,2) 出发：相邻象限是 (1,1) 和 (2,2)。因此，机器人以 $1/2$ 的概率移动到状态 1 或状态 4。$P$ 的第二行是 $(1/2, 0, 0, 1/2)$。\n$P_{21}=1/2, P_{22}=0, P_{23}=0, P_{24}=1/2$。\n\n从状态 3 (2,1) 出发：相邻象限是 (1,1) 和 (2,2)。因此，机器人以 $1/2$ 的概率移动到状态 1 或状态 4。$P$ 的第三行是 $(1/2, 0, 0, 1/2)$。\n$P_{31}=1/2, P_{32}=0, P_{33}=0, P_{34}=1/2$。\n\n从状态 4 (2,2) 出发：相邻象限是 (1,2) 和 (2,1)。因此，机器人以 $1/2$ 的概率移动到状态 2 或状态 3。$P$ 的第四行是 $(0, 1/2, 1/2, 0)$。\n$P_{41}=0, P_{42}=1/2, P_{43}=1/2, P_{44}=0$。\n\n完整的一步转移矩阵 $P$ 是：\n$$\nP = \\begin{pmatrix}\n0  \\frac{1}{2}  \\frac{1}{2}  0 \\\\\n\\frac{1}{2}  0  0  \\frac{1}{2} \\\\\n\\frac{1}{2}  0  0  \\frac{1}{2} \\\\\n0  \\frac{1}{2}  \\frac{1}{2}  0\n\\end{pmatrix}\n$$\n\n两步转移概率是矩阵 $P^2 = P \\times P$ 的项。我们关心的是从状态1开始，经过两步后回到状态1的概率。这是元素 $(P^2)_{11}$。这可以使用矩阵乘法的定义来计算：\n$$\n(P^2)_{11} = \\sum_{k=1}^{4} P_{1k} P_{k1}\n$$\n使用矩阵 $P$ 中的值：\n$$\n(P^2)_{11} = P_{11} P_{11} + P_{12} P_{21} + P_{13} P_{31} + P_{14} P_{41}\n$$\n代入我们找到的概率：\n$$\n(P^2)_{11} = (0)(0) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + (0)(0)\n$$\n$$\n(P^2)_{11} = 0 + \\frac{1}{4} + \\frac{1}{4} + 0 = \\frac{2}{4} = \\frac{1}{2}\n$$\n或者，可以从路径的角度来推理。要从 (1,1) 开始并在两步后返回 (1,1)，机器人必须移动到一个相邻象限，然后立即移回。可能的路径有：\n1. (1,1) $\\rightarrow$ (1,2) $\\rightarrow$ (1,1)。这条路径的概率是 $P((1,1)\\rightarrow(1,2)) \\times P((1,2)\\rightarrow(1,1)) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n2. (1,1) $\\rightarrow$ (2,1) $\\rightarrow$ (1,1)。这条路径的概率是 $P((1,1)\\rightarrow(2,1)) \\times P((2,1)\\rightarrow(1,1)) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n这两条路径是互斥的，所以总概率是它们的概率之和：$\\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$。\n\n概率是 $1/2 = 0.5$。问题要求答案保留两位有效数字，即 $0.50$。", "answer": "$$\\boxed{0.50}$$", "id": "1305824"}, {"introduction": "在构建了马尔可夫链模型之后，下一步是分析其长期行为。本练习 [@problem_id:1305826] 使用一个“哑铃形”图，帮助你理解如何通过分析状态之间的连通性来划分通信类，并判断它们是常返的还是暂留的。这种分类对于预测系统是否会陷入某个子集或最终稳定至关重要。", "problem": "一个粒子在一组六个状态上进行随机游走，标记为 $S = \\{1, 2, 3, 4, 5, 6\\}$。状态之间的连接定义了粒子可能的转移。这些连接的拓扑结构形成一个“有向哑铃”结构，描述如下：\n\n-   **第一簇：** 状态 $\\{1, 2, 3\\}$ 形成一个三角形。沿边存在双向连接，意味着粒子可以在状态1和2之间、状态2和3之间、以及状态3和1之间双向移动。\n-   **第二簇：** 状态 $\\{4, 5, 6\\}$ 形成第二个独立的三角形。与第一簇类似，沿边存在双向连接，允许粒子在状态4和5之间、状态5和6之间、以及状态6和4之间双向移动。\n-   **桥：** 一条单向的桥连接着这两个簇。从状态3到状态4的转移是可能的，但从状态4返回状态3的转移是不可能的。\n\n在每个离散时间步，如果一个粒子处于状态 $i$，它将以相等的概率移动到其可达的邻近状态之一。如果存在从 $i$ 到 $j$ 的有向路径，则状态 $j$ 是 $i$ 的一个可达邻居。\n\n基于此系统，识别所有互通类，并将每个类分类为常返或暂留。选择正确描述这些类的选项。\n\nA. 一个暂留类 $\\{1, 2, 3\\}$ 和一个常返类 $\\{4, 5, 6\\}$。\n\nB. 一个常返类 $\\{1, 2, 3\\}$ 和一个暂留类 $\\{4, 5, 6\\}$。\n\nC. 一个互通类 $\\{1, 2, 3, 4, 5, 6\\}$，该类是常返的。\n\nD. 两个常返类，$\\{1, 2, 3\\}$ 和 $\\{4, 5, 6\\}$。\n\nE. 两个暂留类，$\\{1, 2, 3\\}$ 和 $\\{4, 5, 6\\}$。\n\nF. 六个互通类，$\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}$，所有这些类都是暂留的。", "solution": "我们将该系统建模为状态空间 $S=\\{1,2,3,4,5,6\\}$ 上的离散时间马尔可夫链。如果从状态 $i$ 可以到达状态 $j$（记为 $i \\to j$），并且从状态 $j$ 也可以到达状态 $i$（记为 $j \\to i$），我们就说这两个状态是**互通**的（记为 $i \\leftrightarrow j$）。“互通”关系将所有状态划分为若干个**互通类**。\n\n一个互通类被称为**封闭的**，如果一旦进入这个类，就无法离开。在有限马尔可夫链中，一个封闭互通类中的所有状态都是**常返**的，而一个非封闭互通类中的所有状态都是**暂留**的。\n\n步骤1：识别互通类。\n- 在 $\\{1,2,3\\}$ 内部：由于状态 1、2、3 两两之间都有双向连接，它们可以相互到达。因此，$\\{1,2,3\\}$ 是一个互通类。\n- 在 $\\{4,5,6\\}$ 内部：同样，状态 4、5、6 两两之间可以相互到达。因此，$\\{4,5,6\\}$ 是另一个互通类。\n- 簇之间：存在一个从状态 3 到状态 4 的单向“桥”。这意味着可以从 $\\{1,2,3\\}$ 类中的任何状态到达 $\\{4,5,6\\}$ 类中的任何状态。然而，由于没有从 $\\{4,5,6\\}$ 返回 $\\{1,2,3\\}$ 的路径，所以这两个类中的状态不互通。因此，系统的互通类恰好是 $\\{1,2,3\\}$ 和 $\\{4,5,6\\}$。\n\n步骤2：分类常返性与暂留性。\n- 对于 $\\{4,5,6\\}$ 类：一旦粒子进入这个类（例如，通过 3 $\\to$ 4 的转移），它只能在状态 4、5、6 之间移动，无法离开。因此，$\\{4,5,6\\}$ 是一个封闭的互通类。所以，这个类中的所有状态都是常返的。\n- 对于 $\\{1,2,3\\}$ 类：当粒子处于状态 3 时，它有可能转移到状态 4，从而离开这个类。因为存在离开该类的路径，所以 $\\{1,2,3\\}$ 不是一个封闭的互通类。因此，这个类中的所有状态都是暂留的。\n\n综上所述，存在两个互通类：$\\{1, 2, 3\\}$ 是暂留的，而 $\\{4, 5, 6\\}$ 是常返的。这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1305826"}, {"introduction": "除了定性地对状态进行分类，我们还常常需要定量地回答“平均需要多长时间才能到达某个状态？”这类问题。本练习 [@problem_id:1305793] 介绍了一种强大的技术——首步分析法，通过在一个星形网络中建立关于期望时间的线性方程组来求解。这种方法在性能分析、可靠性工程和许多其他领域都有着广泛的应用。", "problem": "考虑一个建模为节点网络的分布式计算系统。该系统由一个中心路由器 $R_0$ 和 $N$ 个相同的边缘计算节点 $C_1, C_2, \\ldots, C_N$ 组成，其中 $N \\ge 2$。一个数据包（或称为“令牌”）根据特定的路由协议在这些节点之间以离散时间步移动，形成一个离散时间马尔可夫链。\n\n转移规则定义如下：\n- 从中心路由器 $R_0$ 出发，令牌以相等的概率被转发到 $N$ 个计算节点中的任意一个。\n- 从任意计算节点 $C_i$（其中 $i \\in \\{1, 2, \\ldots, N\\}$）出发，令牌以概率 $p$ 被送回中心路由器 $R_0$，其中 $0  p \\le 1$。\n- 以剩余的概率 $1-p$，令牌从计算节点 $C_i$ 被转发到另一个不同的计算节点 $C_j$（其中 $j \\neq i$）。目标节点 $C_j$ 是从所有其他 $N-1$ 个计算节点集合中均匀随机选择的。\n\n假设令牌从计算节点 $C_1$ 开始。确定令牌首次到达计算节点 $C_2$ 所需的期望时间步数。请用 $N$ 和 $p$ 的闭式解析表达式给出你的答案。", "solution": "设 $E_1$ 表示从 $C_1$ 出发首次到达 $C_2$ 的期望步数，$E_0$ 表示从 $R_0$ 出发首次到达 $C_2$ 的期望步数。根据对称性，从任何其他计算节点 $C_k$（其中 $k \\notin \\{1,2\\}$）出发首次到达 $C_2$ 的期望步数与 $E_1$ 相同。为简化起见，我们用 $E_o$ 表示从任何非起始、非目标的计算节点 $C_k$（$k \\notin \\{1,2\\}$）出发到达 $C_2$ 的期望步数。根据对称性，我们有 $E_o = E_1$。根据定义，到达目标状态的期望时间为 0，即 $E_2=0$。\n\n我们使用首步分析法建立方程组。期望时间等于 1（第一步）加上从下一步位置到达目标的期望时间，并对所有可能性加权平均。\n$E_i = 1 + \\sum_j P_{ij} E_j$\n\n- 从 $R_0$ 出发：\n$$E_0 = 1 + \\frac{1}{N} E_1 + \\frac{1}{N} E_2 + \\frac{N-2}{N} E_o = 1 + \\frac{1}{N} E_1 + \\frac{N-2}{N} E_1 = 1 + \\frac{N-1}{N} E_1$$\n\n- 从 $C_1$ 出发：\n$$E_1 = 1 + p E_0 + \\frac{1-p}{N-1} E_2 + \\frac{(N-2)(1-p)}{N-1} E_o = 1 + p E_0 + \\frac{(N-2)(1-p)}{N-1} E_1$$\n\n现在我们有两个方程和两个未知数 ($E_0, E_1$)。将第一个方程代入第二个方程：\n$$E_1 = 1 + p \\left(1 + \\frac{N-1}{N} E_1\\right) + \\frac{(N-2)(1-p)}{N-1} E_1$$\n展开并整理关于 $E_1$ 的项：\n$$E_1 = 1 + p + p\\frac{N-1}{N} E_1 + \\frac{(N-2)(1-p)}{N-1} E_1$$\n$$E_1 \\left(1 - p\\frac{N-1}{N} - \\frac{(N-2)(1-p)}{N-1}\\right) = 1+p$$\n化简括号中的系数：\n$$1 - \\frac{p(N-1)}{N} - \\frac{(N-2)(1-p)}{N-1} = \\frac{N(N-1) - p(N-1)^2 - N(N-2)(1-p)}{N(N-1)}$$\n$$= \\frac{(N^2-N) - p(N^2-2N+1) - (N^2-2N-pN^2+2pN)}{N(N-1)}$$\n$$= \\frac{N^2-N - pN^2+2pN-p - N^2+2N+pN^2-2pN}{N(N-1)}$$\n$$= \\frac{N-p}{N(N-1)}$$\n将此结果代回方程：\n$$E_1 \\left(\\frac{N-p}{N(N-1)}\\right) = 1+p$$\n最后，解出 $E_1$：\n$$E_1 = \\frac{N(N-1)(1+p)}{N-p}$$\n\n因此，从 $C_1$ 到 $C_2$ 的期望步数是 $\\frac{N(N-1)(1+p)}{N-p}$。", "answer": "$$\\boxed{\\frac{N(N-1)(1+p)}{N-p}}$$", "id": "1305793"}]}