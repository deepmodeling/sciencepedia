## 引言
马尔可夫链是描述[随机系统](@entry_id:187663)状态演化的强大数学工具。在分析其[长期行为](@entry_id:192358)时，一个核心概念是状态的“常返性”——即系统从一个状态出发后，是否必然会再次返回。然而，仅仅知道系统会返回是不够的。一个更深刻的问题是：系统返回的频率如何？两次返回之间平均需要多长时间？对这一问题的回答，揭示了系统稳定性的本质差异，并引出了本文的核心主题：对[常返态](@entry_id:276969)进行更精细的划分，即**[正常返](@entry_id:195139)**与**[零常返](@entry_id:276939)**。

本文旨在系统地阐述[正常返](@entry_id:195139)与[零常返的](@entry_id:201833)理论及其应用。我们将从基本原理出发，逐步深入，帮助你建立对[马尔可夫链](@entry_id:150828)[长期行为](@entry_id:192358)的深刻理解。
- 在“**原理与机制**”一章中，我们将通过平均返回时间来精确定义[正常返](@entry_id:195139)与[零常返](@entry_id:276939)，并揭示它们与平稳分布之间最核心的联系。你将学习如何利用这一联系以及Foster-Lyapunov等强大工具来判别一个给定的[马尔可夫链](@entry_id:150828)的类型。
- 接着，在“**应用与跨学科联系**”一章中，我们将跨出纯理论的范畴，探讨这些概念在[排队论](@entry_id:274141)、系统工程、生物种群动态和金融建模等多个领域的实际应用，理解[正常返](@entry_id:195139)如何对应系统的稳定性，而[零常返](@entry_id:276939)又为何常代表一种不稳定的临界状态。
- 最后，通过“**动手实践**”部分提供的精选习题，你将有机会亲手应用所学知识，巩固对关键判别技巧的掌握。

通过这三个部分的学习，你将不仅掌握[正常返](@entry_id:195139)与[零常返的](@entry_id:201833)数学定义，更能理解它们在预测和分析真实世界随机现象中的关键作用。让我们首先深入其核心的原理与机制。

## 原理与机制

在之前的章节中，我们已经了解了马尔可夫链中状态的分类，特别是瞬时态和[常返态](@entry_id:276969)之间的区别。一个状态 $i$ 如果从它出发，返回自身的概率为1，则被称为**[常返态](@entry_id:276969)**（recurrent state）。这意味着，一旦系统进入一个[常返态](@entry_id:276969)，它将确定无疑地、一次又一次地返回到这个状态。然而，这一描述引出了一个更深层次的问题：系统返回的频率如何？两次返回之间平均需要多长时间？对这一问题的探究，将我们引向对[常返态](@entry_id:276969)进行更精细的划分，即**[正常返](@entry_id:195139)**（positive recurrence）与**[零常返](@entry_id:276939)**（null recurrence）。

### 常返性的精细划分：平均返回时间

为了量化返回的频率，我们定义一个关键的量：**平均返回时间**。对于马尔可夫链中的一个状态 $i$，假设链从状态 $i$ 出发，我们定义首次返回状态 $i$ 的时间为一个[随机变量](@entry_id:195330) $T_i^+ = \inf\{n \ge 1 : X_n = i\}$。那么，平均返回时间就是这个[随机变量的期望](@entry_id:262086)值，记作 $\mu_i = \mathbb{E}_i[T_i^+]$。

基于平均返回时间是有限还是无限，我们可以将[常返态](@entry_id:276969)分为两类：

1.  **[正常返](@entry_id:195139)态 (Positive Recurrent State)**：一个[常返态](@entry_id:276969) $i$ 如果其平均返回时间是有限的（$\mu_i  \infty$），则称其为[正常返](@entry_id:195139)态。这表明，系统不仅会一次又一次地返回该状态，而且两次返回之间的平均时间间隔是有限的。

2.  **[零常返](@entry_id:276939)态 (Null Recurrent State)**：一个[常返态](@entry_id:276969) $i$ 如果其平均返回时间是无限的（$\mu_i = \infty$），则称其为[零常返](@entry_id:276939)态。这是一个相当微妙的概念：系统确定会返回该状态（返回概率为1），但平均等待时间却是无限的。这意味着返回虽然必然发生，但可能会经历极其漫长的游荡。

正如常返性是不可约[马尔可夫链](@entry_id:150828)的一个类性质（即所有状态同为常返或同为瞬时），[正常返](@entry_id:195139)和[零常返](@entry_id:276939)同样是**类性质**。对于一个不可约[马尔可夫链](@entry_id:150828)，其所有状态要么全部是[正常返](@entry_id:195139)的，要么全部是[零常返的](@entry_id:201833)，要么全部是瞬时的。因此，我们通常直接谈论整个链是[正常返](@entry_id:195139)还是[零常返的](@entry_id:201833)。[@problem_id:2993144]

让我们通过一个具体的例子来直观地理解[零常返](@entry_id:276939)。考虑一个模拟深空探测器中关键部件更换过程的模型 [@problem_id:1288876]。系统状态是部件的年龄（以周期计），状态0表示刚刚安装了新部件。一个部件的寿命 $T$（以周期为单位）是一个[随机变量](@entry_id:195330)，其[概率质量函数](@entry_id:265484)为 $P(T=k) = \frac{1}{k(k+1)}$，其中 $k=1, 2, \dots$。当部件失效时，系统立即返回状态0。

首先，我们需要确认状态0是常返的。从状态0出发，系统必然会返回，只要部件的寿命是有限的。返回状态0的总概率是部件在某个有限时间内失效的概率，即 $\sum_{k=1}^{\infty} P(T=k)$。这是一个伸缩级数：
$$
\sum_{k=1}^{\infty} \frac{1}{k(k+1)} = \sum_{k=1}^{\infty} \left(\frac{1}{k} - \frac{1}{k+1}\right) = \left(1 - \frac{1}{2}\right) + \left(\frac{1}{2} - \frac{1}{3}\right) + \dots = 1
$$
由于返回概率为1，状态0是常返的。

接下来，我们计算平均返回时间 $\mu_0$。从状态0开始，返回0所需的时间恰好是新部件的寿命 $T$。因此，$\mu_0 = \mathbb{E}[T]$。
$$
\mu_0 = \mathbb{E}[T] = \sum_{k=1}^{\infty} k \cdot P(T=k) = \sum_{k=1}^{\infty} k \cdot \frac{1}{k(k+1)} = \sum_{k=1}^{\infty} \frac{1}{k+1}
$$
这个级数 $\frac{1}{2} + \frac{1}{3} + \frac{1}{4} + \dots$ 是发散的[调和级数](@entry_id:147787)的一部分，其和为无穷大。因此，$\mu_0 = \infty$。尽管返回是必然的，但平均等待时间是无限的。这正是[零常返的](@entry_id:201833)定义，所以状态0是[零常返](@entry_id:276939)态。

### 核心联系：[正常返](@entry_id:195139)与[平稳分布](@entry_id:194199)

[正常返](@entry_id:195139)与[零常返](@entry_id:276939)之间最深刻、最有用的区别在于它们与**平稳分布**（stationary distribution）的联系。平稳分布 $\pi$ 是一个[概率分布](@entry_id:146404)，它描述了[马尔可夫链](@entry_id:150828)在长时间运行后处于各个状态的概率，并且这个[概率分布](@entry_id:146404)不随时间的推移而改变。

一个不可约[马尔可夫链](@entry_id:150828)是**[正常返](@entry_id:195139)的**，当且仅当它**存在一个[平稳分布](@entry_id:194199)** $\pi$。[@problem_id:2993144]

这个定理是[马尔可夫链](@entry_id:150828)理论的基石。它不仅提供了一个判断[正常返](@entry_id:195139)的强大准则，还通过**[Kac公式](@entry_id:273544)**将微观的平均返回时间与宏观的[平稳分布](@entry_id:194199)联系起来：
$$
\mu_i = \frac{1}{\pi_i}
$$
其中 $\pi_i$ 是状态 $i$ 的平稳概率。这个公式直观地解释了两者关系：如果系统长期来看有 $\pi_i$ 的概率处于状态 $i$，那么从状态 $i$ 出发，平均需要 $1/\pi_i$ 步才能返回。如果 $\pi_i  0$，则平均返回时间 $\mu_i$ 是有限的。如果不存在[平稳分布](@entry_id:194199)，或者对于某个状态 $\pi_i=0$（在不[可约链](@entry_id:200553)中不可能），那么链就不是[正常返](@entry_id:195139)的。

这一基本定理有一个直接而重要的推论：任何具有**有限状态空间**的不可约[马尔可夫链](@entry_id:150828)必然是**[正常返](@entry_id:195139)的**。[@problem_id:1288858] 理由很简单：对于[有限马尔可夫链](@entry_id:264809)，数学上（例如通过[Perron-Frobenius定理](@entry_id:138708)）可以保证至少存在一个平稳分布。由于状态空间有限且链不可约，这个平稳分布中的每个分量 $\pi_i$ 都必须大于零。根据[Kac公式](@entry_id:273544)，$\mu_i = 1/\pi_i$ 必然是有限的。因此，有限不[可约链](@entry_id:200553)中不可能出现[零常返](@entry_id:276939)或瞬时状态。

### 无限[状态空间](@entry_id:177074)下的[零常返](@entry_id:276939)：[随机游走](@entry_id:142620)

当状态空间是无限的时，情况就变得复杂了。[平稳分布](@entry_id:194199)可能不存在，这为[零常返的](@entry_id:201833)出现打开了大门。最典型的例子是整数格点 $\mathbb{Z}^d$ 上的[随机游走](@entry_id:142620)。

考虑一个在 $\mathbb{Z}^d$ 上不可约的[随机游走](@entry_id:142620)，其转移概率具有平移不变性，即 $p(x, y) = p(0, y-x)$。如果这样的链存在一个[平稳分布](@entry_id:194199) $\pi$，那么由于平移不变性，所有状态的平稳概率必须相等，即 $\pi(x) = c$ 对于所有 $x \in \mathbb{Z}^d$。然而，$\mathbb{Z}^d$ 是一个[无限集](@entry_id:137163)。为了使 $\pi$ 成为一个[概率分布](@entry_id:146404)，其所有分量之和必须为1，即 $\sum_{x \in \mathbb{Z}^d} \pi(x) = 1$。如果 $c0$，这个和将是无穷大；如果 $c=0$，和为零。在任何情况下，它都不可能等于1。[@problem_id:2993144]

因此，$\mathbb{Z}^d$ 上的任何不可约[随机游走](@entry_id:142620)都**不存在平稳分布**。根据我们之前的定理，这意味着它们**绝不可能是[正常返](@entry_id:195139)的**。它们要么是瞬时的（如在 $d \ge 3$ 维的简单[对称随机游走](@entry_id:273558)），要么是[零常返的](@entry_id:201833)（如在 $d=1, 2$ 维的简单[对称随机游走](@entry_id:273558)）。

一个具体的例子可以加深理解。假设一个粒子在二维格点 $\mathbb{Z}^2$ 上进行有偏的[随机游走](@entry_id:142620)，其向正方向移动的概率是向负方向的两倍 [@problem_id:1323964]。虽然这个二维过程看起来很复杂，但我们可以通过考察一个新的[随机过程](@entry_id:159502) $Z_n = X_n - Y_n$ 来简化分析。可以计算出，$Z_n$ 的转移概率为 $P(Z_{n+1} - Z_n = 1) = \frac{1}{2}$ 和 $P(Z_{n+1} - Z_n = -1) = \frac{1}{2}$。这表明，$Z_n$ 恰好是一个一维简单[对称随机游走](@entry_id:273558)。我们知道一维简单[对称随机游走](@entry_id:273558)是常返的，但由于它是在无限[状态空间](@entry_id:177074) $\mathbb{Z}$ 上的[随机游走](@entry_id:142620)，它没有[平稳分布](@entry_id:194199)，因此必然是[零常返的](@entry_id:201833)。

另一个直接计算的例子是这样一个马尔可夫链：粒子在非负整数上移动，从状态 $i \ge 1$ 以概率 $\frac{i}{i+1}$ 移动到 $i+1$，以概率 $\frac{1}{i+1}$ 重置到状态0 [@problem_id:1300515]。可以证明，返回状态0的概率是1，因此链是常返的。但返回0的期望时间为 $1 + \sum_{i=1}^{\infty} \frac{1}{i+1}$，这个和是发散的。因此，该链是[零常返的](@entry_id:201833)。

### 分类技术：从[平衡方程](@entry_id:172166)到[Lyapunov函数](@entry_id:273986)

除了基本定义和与平稳分布的联系外，我们还需要更具体的数学工具来对给定的马尔可夫链进行分类。

#### [生灭过程](@entry_id:168595)

对于一类称为**[生灭过程](@entry_id:168595)**（birth-death process）的马尔可夫链，其中状态转移只发生在相邻状态之间，我们有非常系统的方法。其核心思想是尝试求解**[细致平衡方程](@entry_id:265021)**（detailed balance equations）来构造一个（可能未归一化的）不变测度 $\pi$：
$$
\pi_i p_{i, i+1} = \pi_{i+1} p_{i+1, i}
$$
这个方程给出了相邻状态[不变测度](@entry_id:202044)值的比率，从而允许我们递推地计算出所有 $\pi_n$（相对于某个基准值，如 $\pi_0=1$）。

链是否为[正常返](@entry_id:195139)，取决于这个构造出的测度是否可以被归一化，即其总和是否有限：
*   如果 $\sum_n \pi_n  \infty$，则链是**[正常返](@entry_id:195139)的**。我们可以通过除以总和得到一个真正的[平稳分布](@entry_id:194199)。
*   如果 $\sum_n \pi_n = \infty$，但链是常返的，则链是**[零常返的](@entry_id:201833)**。

例如，考虑一个模拟民意调查中候选人领先优势的模型 [@problem_id:1323991]。状态 $i0$ 表示领先优势的大小，转移概率为 $p_{i, i+1} = \frac{1}{2} + \frac{1}{4i}$，体现了“[马太效应](@entry_id:273799)”。通过[细致平衡方程](@entry_id:265021)求解，可以发现不变测度 $\pi_n$ 渐近于 $\pi_n \propto n$。由于 $\sum n$ 发散，该链不存在[平稳分布](@entry_id:194199)，因此是[零常返的](@entry_id:201833)。另一个在整数集 $\mathbb{Z}$ 上的[生灭过程](@entry_id:168595)例子 [@problem_id:1300522]，通过类似的分析，其不变测度 $\pi_k$ 渐近于 $C/|k|$，其在整个 $\mathbb{Z}$ 上的和也发散，因此也是[零常返的](@entry_id:201833)。

相反，考虑一个[模拟优化](@entry_id:754883)算法状态的模型 [@problem_id:1324007]。状态 $i$ 是解与最优解的距离，向更优状态 $i-1$ 移动的概率为 $1-1/i^{3/2}$，向更差状态 $i+1$ 移动的概率为 $1/i^{3/2}$。这里的转移概率强烈地将链拉向状态1。求解[细致平衡方程](@entry_id:265021)后，可以发现不变测度 $\pi_n$ 的项快速衰减，使得 $\sum \pi_n$ 收敛。因此，该链是[正常返](@entry_id:195139)的。

#### Foster-Lyapunov准则

对于更一般的[马尔可夫链](@entry_id:150828)，直接求解[平衡方程](@entry_id:172166)可能很困难。此时，一个强大的工具是**Foster-Lyapunov准则**。其核心思想是定义一个“能量函数”或**[Lyapunov函数](@entry_id:273986)** $V(s)$，它在状态空间“远离中心”时取值较大。如果当链处于远离中心区域时，能量的期望变化为负（即存在向中心的“漂移”），那么链就是[正常返](@entry_id:195139)的。

更形式化地，如果存在一个函数 $V(s) \ge 0$，一个[有限集](@entry_id:145527) $C$，和一个常数 $\epsilon  0$，使得对于所有不在 $C$ 中的状态 $s$，都满足：
$$
\mathbb{E}[V(X_{n+1}) - V(X_n) \mid X_n = s] \le -\epsilon
$$
则该不可约[马尔可夫链](@entry_id:150828)是[正常返](@entry_id:195139)的。

考虑一个粒子运动模型 [@problem_id:1324009]，它以概率 $p$ 进行具有长程跳跃的自由[扩散](@entry_id:141445)，以概率 $1-p$ 被一个力拉向原点。尽管跳跃可以是任意大的，但这个朝向原点的“恢复力”起到了稳定作用。我们可以选择 $V(s) = |s|$ 作为Lyapunov函数。可以证明，当 $|s|$ 足够大时，恢复力带来的负漂移 $-(1-p)$ 会主导自由[扩散](@entry_id:141445)带来的正漂移，使得总的期望漂移为负。根据Foster-Lyapunov准则，该链是[正常返](@entry_id:195139)的。

#### 复杂结构中的常返性

最后，[零常返](@entry_id:276939)现象也可以在具有复杂几何结构的图上出现。考虑一个在“无限梳[子图](@entry_id:273342)”上进行简单[随机游走](@entry_id:142620)的模型 [@problem_id:1323974]。这个图由一条无限长的“梳背”（整数轴）和每个整数点上附加的一条无限长的“梳齿”组成。虽然粒子在梳背上的移动类似于一维[随机游走](@entry_id:142620)，但它随时可能进入一条无限长的梳齿。在梳齿上的游走本身就是一个[零常返的](@entry_id:201833)过程（类似于一维半无限直线上的[随机游走](@entry_id:142620)），回到梳背的平均时间是无限的。因此，尽管粒子最终总会回到梳背并继续在上面游走，但这些在梳齿中的“无限长时间”的旅行，导致了整个链的平均返回时间是无限的。因此，这个在梳子[图上的[随机游](@entry_id:273686)走](@entry_id:142620)是[零常返的](@entry_id:201833)。

总之，[正常返](@entry_id:195139)与[零常返的](@entry_id:201833)区分是对马尔可夫链[长期行为](@entry_id:192358)的深刻洞察。[正常返](@entry_id:195139)与[平稳分布的存在性](@entry_id:272084)等价，意味着系统会稳定在一个[统计平衡](@entry_id:186577)态。而[零常返](@entry_id:276939)则描述了一种更为奇特的行为：系统虽然保证会反复访问某个状态，但它在两次访问之间可能会“迷失”在广阔的[状态空间](@entry_id:177074)中，导致[平均等待时间](@entry_id:275427)无限长。理解这种差异对于准确建模和预测从物理系统到经济模型等众多领域的[随机过程](@entry_id:159502)至关重要。