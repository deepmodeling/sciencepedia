## 引言
马尔可夫链是描述[随机系统](@entry_id:187663)演化的强大数学工具，但要真正洞察其未来，我们必须理解其[长期行为](@entry_id:192358)的本质。一个核心问题是：当时间趋于无穷时，系统会停留在哪里？是会稳定在某个状态，还是在不同状态间无休止地游走？这个问题的答案并非一概而论，因为它完全取决于链中每个状态的内在属性。本文旨在填补这一认知空白，系统地介绍“[状态分类](@entry_id:276397)”这一基本而关键的理论框架。

在接下来的内容中，我们将分三步深入探索这一主题。首先，在“原理与机制”一章中，我们将建立[状态分类](@entry_id:276397)的理论基石，精确定义[可达性](@entry_id:271693)、[互通类](@entry_id:267280)、常返性、暂留性以及周期性等核心概念。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将跨越学科界限，展示这些抽象理论如何在物理、生物、计算机科学和经济学等领域的具体模型（如[随机游走](@entry_id:142620)、种群遗传和[排队系统](@entry_id:273952)）中发挥强大的解释力。最后，通过一系列“动手实践”练习，您将有机会亲手应用所学知识，解决具体的[分类问题](@entry_id:637153)。让我们从[状态分类](@entry_id:276397)最基本的原理开始，揭示[马尔可夫链](@entry_id:150828)动态行为的内在结构。

## 原理与机制

在理解[马尔可夫链的长期行为](@entry_id:272323)时，对其状态进行分类是至关重要的一步。并非所有状态都具有相同的性质。有些状态可能只是短暂的驿站，而另一些则可能是系统反复回归的终点。本章将系统地介绍[状态分类](@entry_id:276397)的核心原理，包括可达性、[互通类](@entry_id:267280)、常返性、暂留性、周期性以及[正常返](@entry_id:195139)与[零常返的](@entry_id:201833)区分。

### [可达性](@entry_id:271693)与互通性

[状态分类](@entry_id:276397)的起点是理解状态之间的[可达关系](@entry_id:149013)。我们说状态 $i$ **可达** (reaches) 状态 $j$，记作 $i \to j$，如果从状态 $i$ 出发，经过有限步（可以是一步或多步）后，有大于零的概率到达状态 $j$。形式上，这意味着存在某个整数 $n \ge 1$，使得 $n$ 步转移概率 $P_{ij}^{(n)} > 0$。

如果状态 $i$ [可达状态](@entry_id:265999) $j$，并且状态 $j$ 也[可达状态](@entry_id:265999) $i$，我们就说状态 $i$ 与状态 $j$ **互通** (communicate)，记作 $i \leftrightarrow j$。不难验证，互通是一种[等价关系](@entry_id:138275)，它满足：
1.  **[自反性](@entry_id:137262)**: $i \leftrightarrow i$ (对于任何非[吸收态](@entry_id:161036)，总能找到路径返回自身)。
2.  **对称性**: 若 $i \leftrightarrow j$，则 $j \leftrightarrow i$。
3.  **[传递性](@entry_id:141148)**: 若 $i \leftrightarrow j$ 且 $j \leftrightarrow k$，则 $i \leftrightarrow k$。

由于互通是一种等价关系，它可以将整个状态空间 $S$ 划分为若干个互不相交的[子集](@entry_id:261956)，这些[子集](@entry_id:261956)被称为**[互通类](@entry_id:267280) (communicating classes)**。同一个[互通类](@entry_id:267280)中的所有状态都是相互互通的。

为了具体理解这一点，我们考虑一个具有[状态空间](@entry_id:177074) $S = \{1, 2, 3\}$ 的[马尔可夫链](@entry_id:150828)，其[转移矩阵](@entry_id:145510)为 [@problem_id:1288884]：
$$
P = \begin{pmatrix} 0.5  & 0.5 & 0 \\ 0 & 0.5 & 0.5 \\ 0 & 0.5 & 0.5 \end{pmatrix}
$$
我们来分析状态间的可达性：
-   从状态 1 出发：$P_{12} = 0.5 > 0$，所以 $1 \to 2$。进一步，$P_{13}^{(2)} = P_{12}P_{23} = 0.5 \times 0.5 = 0.25 > 0$，所以 $1 \to 3$。
-   从状态 2 和 3 出发：$P_{21}=0$ 且 $P_{31}=0$。更重要的是，一旦链进入了集合 $\{2, 3\}$，它将永远无法离开，因为从 2 或 3 出发的转移只会到达 2 或 3。这意味着对于任何 $n \ge 1$，$P_{21}^{(n)}=0$ 且 $P_{31}^{(n)}=0$。因此，$2 \not\to 1$ 且 $3 \not\to 1$。
-   状态 2 和 3 之间：$P_{23} = 0.5 > 0$ 且 $P_{32} = 0.5 > 0$，所以 $2 \leftrightarrow 3$。

基于以上分析，状态 1 无法与 2 或 3 互通，而状态 2 和 3 相互互通。因此，该[马尔可夫链](@entry_id:150828)的[状态空间](@entry_id:177074)被划分为两个[互通类](@entry_id:267280)：$\{1\}$ 和 $\{2, 3\}$。这个例子清晰地表明，[状态空间](@entry_id:177074)的分解是理解链动态结构的第一步。

### 常返性与暂留性

一旦我们将状态划分为[互通类](@entry_id:267280)，下一个关键问题是：如果从某个状态出发，链最终会返回这个状态吗？这个问题引出了常返和暂留的分类，这是一个[互通类](@entry_id:267280)中所有状态共享的属性。

#### 首次到达时间与返回概率

为了形式化定义，我们引入两个重要概念。对于状态 $j$，其**首次到达时间** (first passage time) $T_j$ 是指链首次访问状态 $j$ 的时刻。如果链从状态 $i$ 出发，那么其**首次返回时间** (first return time) $T_i^+$ 是指链在第1步或之后首次返回状态 $i$ 的时刻。

一个状态 $i$ 被称为**常返的 (recurrent)**，如果从状态 $i$ 出发，链最终必然会返回状态 $i$。用概率语言来说，这意味着首次返回的概率为1：
$$
\mathbb{P}_i(T_i^+  \infty) = 1
$$
相反，如果从状态 $i$ 出发，存在一个正的概率使得链永远不再返回，那么状态 $i$ 被称为**暂留的 (transient)**。这意味着：
$$
\mathbb{P}_i(T_i^+  \infty)  1
$$
暂留性的一个关键特征是，从该状态出发，存在一条“不归路”。考虑一个状态 $i$，它能够以正概率到达另一个状态 $j$，但从 $j$ 出发返回 $i$ 的概率为零 ($i \to j$ 但 $j \not\to i$) [@problem_id:1288860]。这种单向的可达性保证了从 $i$ 出发后，链有大于零的概率进入一个无法返回的区域。一旦进入该区域，返回 $i$ 就成为不可能事件。这直接导致首次返回时间 $T_i^+$ 有正概率为无穷大，即 $\mathbb{P}_i(T_i^+ = \infty) > 0$。这直接导致 $\mathbb{P}_i(T_i^+  \infty)  1$，因此状态 $i$ 必须是暂留的。

#### 期望访问次数判据

[常返与暂留](@entry_id:265162)还有另一个等价且非常有用的判据。令 $N_i$ 为[马尔可夫链](@entry_id:150828)在其整个生命周期中访问状态 $i$ 的总次数。
-   如果从状态 $i$ 出发，访问状态 $i$ 的期望次数是无限的，即 $E_i[N_i] = \infty$，则状态 $i$ 是**常返的**。
-   如果从状态 $i$ 出发，访问状态 $i$ 的期望次数是有限的，即 $E_i[N_i]  \infty$，则状态 $i$ 是**暂留的**。

直观上，如果一个状态是暂留的，链每次访问它之后，都有可能永远离开。这些“逃逸”概率的累积效应使得总的访问次数在期望意义下是有限的。反之，如果返回是必然的，链会一次又一次地回到该状态，使得期望访问次数趋于无穷。

这个判据提供了一种强大的计算工具。例如，假设一个网络交换机的运行状态由一个马尔可夫链描述，我们关心其默认协议状态 $A$ 的稳定性 [@problem_id:1288862]。通过分析不同状态下访问 $A$ 的期望次数之间的关系，我们可能得到一个线性方程组。假设解出该[方程组](@entry_id:193238)后，我们发现从状态 $A$ 出发，访问 $A$ 的期望总次数为 $E_A[N_A] = \frac{7}{5}$。因为这个[期望值](@entry_id:153208)是一个有限数，我们可以立即断定状态 $A$ 是暂留的，这可能意味着该默认协议不够稳定，系统会倾向于转移到其他状态中。

#### 闭类及其性质

可达性结构与常返/暂留分类之间存在深刻的联系。一个[互通类](@entry_id:267280) $C$ 被称为是**闭的 (closed)**，如果一旦链进入 $C$，它就永远不能离开。换句话说，对于任何 $i \in C$ 和 $j \notin C$，都有 $P_{ij} = 0$。

对于**有限状态马尔可夫链**，我们有以下基本定理：
1.  一个[互通类](@entry_id:267280)中的所有状态要么都是常返的，要么都是暂留的。
2.  一个有限的[闭互通类](@entry_id:273537)中的所有状态都是**常返的**。
3.  一个非闭的[互通类](@entry_id:267280)中的所有状态都是**暂留的**。

一个模拟网络服务器运行状态的模型 [@problem_id:128907] 清晰地展示了这一点。该服务器有四种状态：空闲(I)、处理(P)、更新(U)和验证(V)。状态转移规则导致形成了两个[互通类](@entry_id:267280)：$\{I, P\}$ 和 $\{U, V\}$。从状态 P 有可能转移到 U，但从 U 或 V 无法返回 I 或 P。因此，[互通类](@entry_id:267280) $\{U, V\}$ 是一个闭类，其中的状态 U 和 V 是常返的。相反，[互通类](@entry_id:267280) $\{I, P\}$ 不是闭类，链可以从这里“泄漏”到 $\{U, V\}$ 并且永不返回，这使得状态 I 和 P 必然是暂留的。

闭类的一个极端但重要的例子是**[吸收态](@entry_id:161036) (absorbing state)**，它本身构成一个大小为1的[闭互通类](@entry_id:273537)。吸收态 $i$ 的定义是 $P_{ii}=1$。在一个电子元件库存模型中 [@problem_id:1288885]，一旦库存降为0，由于供应商关系终止，库存将永远保持为0。因此，状态0就是一个吸收态。任何能够到达[吸收态](@entry_id:161036)但本身非吸收态的状态，都必然是暂留的，因为一旦进入吸收态，就再也无法返回。

### [常返态](@entry_id:276969)的深层分类

对于[常返态](@entry_id:276969)，我们还可以根据其返回的模式进行更精细的分类。

#### 周期性

一个状态的**周期 (period)** 描述了返回该状态所允许的步数结构。状态 $i$ 的周期 $d(i)$ 定义为所有可能从 $i$ 出发返回 $i$ 的步数 $n \ge 1$（即满足 $P_{ii}^{(n)} > 0$ 的 $n$）的[最大公约数 (GCD)](@entry_id:149942)。
$$
d(i) = \gcd\{n \ge 1 : P_{ii}^{(n)} > 0\}
$$
-   如果 $d(i) > 1$，状态 $i$ 被称为是**周期性的 (periodic)**。
-   如果 $d(i) = 1$，状态 $i$ 被称为是**非周期性的 (aperiodic)**。

与常返/暂留属性一样，周期性是同一[互通类](@entry_id:267280)中所有状态共享的属性。

周期性的概念可以通过一个在六边形顶点上进行[随机游走](@entry_id:142620)的微型机器人模型来直观理解 [@problem_id:1288881]。顶点可以被交替地“着色”，例如，将 $V_0, V_2, V_4$ 视为“偶数”顶点，将 $V_1, V_3, V_5$ 视为“奇数”顶点。机器人从一个顶点出发，每一步都移动到相邻顶点，这意味着它总是在偶数顶点和奇数顶点之间切换。因此，如果机器人从偶数顶点 $V_0$ 出发，它只有在经过偶数步之后才可能回到 $V_0$ 或其他任何偶数顶点。返回起始点 $V_0$ 所需的步数 $n$ 必须是偶数。因此，满足 $P_{00}^{(n)} > 0$ 的步数集合为 $\{2, 4, 6, \dots\}$，这个集合的[最大公约数](@entry_id:142947)是2。因此，该链中每个[状态的周期](@entry_id:276903)都是2。

一个简单的判断[非周期性](@entry_id:275873)的方法是检查是否存在[自环](@entry_id:274670)。如果一个状态 $i$ 有正的概率停留在原地（即 $P_{ii} > 0$），那么1就在返回步数的集合中，这立即导致周期的[最大公约数](@entry_id:142947)为1。因此，任何有[自环](@entry_id:274670)的状态都是非周期性的。在之前的库存模型 [@problem_id:1288885] 和聚合物缺陷模型 [@problem_id:128903] 中，状态都存在自环，因此它们都是[非周期性](@entry_id:275873)的。

#### [正常返](@entry_id:195139)与[零常返](@entry_id:276939)

即使我们知道一个状态是常返的（即返回是必然的），我们可能还想知道平均需要多长时间才能返回。这引出了[正常返](@entry_id:195139)和[零常返的](@entry_id:201833)区别。

对于一个[常返态](@entry_id:276969) $i$，其**平均返回时间 (mean recurrence time)** $\mu_i$ 定义为首次返回时间的[期望值](@entry_id:153208)：
$$
\mu_i = E_i[T_i^+]
$$
-   如果 $\mu_i  \infty$，即平均返回时间是有限的，则状态 $i$ 是**[正常返](@entry_id:195139)的 (positive recurrent)**。
-   如果 $\mu_i = \infty$，即平均返回时间是无限的，则状态 $i$ 是**[零常返的](@entry_id:201833) (null recurrent)**。

区分[正常返](@entry_id:195139)和[零常返的](@entry_id:201833)关键在于返回的“频率”。[正常返](@entry_id:195139)态意味着链会“频繁”地返回，而[零常返](@entry_id:276939)态虽然保证返回，但返回之间的间隔时间在期望意义上是无限长的。

这个看似微妙的区别在无限状态空间中尤为重要。考虑一个深空探测器中的关键部件模型，其状态是部件的年龄（以“周期”为单位）[@problem_id:1288876]。当部件失效时，它被立即更换，状态重置为0（新部件）。假设部件在第 $k$ 个周期失效的概率为 $P(T=k) = \frac{1}{k(k+1)}$。我们通过计算发现，部件最终失效的概率（即系统从状态0出发后最终返回状态0的概率）是 $\sum_{k=1}^{\infty} P(T=k) = 1$。因此状态0是常返的。然而，当我们计算[期望寿命](@entry_id:274924)（即首次返回状态0的期望时间）时，我们得到：
$$
\mu_0 = E[T] = \sum_{k=1}^{\infty} k \cdot P(T=k) = \sum_{k=1}^{\infty} \frac{k}{k(k+1)} = \sum_{k=1}^{\infty} \frac{1}{k+1}
$$
这是一个发散的级数（[调和级数](@entry_id:147787)的一部分）。这意味着平均返回时间是无限的，$\mu_0 = \infty$。因此，状态0是一个**[零常返](@entry_id:276939)态 (null recurrent)**。

### 重要定理与特例

最后，我们总结一些关于[状态分类](@entry_id:276397)的重要定理和经典案例，它们揭示了[状态空间](@entry_id:177074)结构（有限或无限）与状态性质之间的深刻联系。

#### 有限不[可约链](@entry_id:200553)

对于[状态空间](@entry_id:177074)有限的[马尔可夫链](@entry_id:150828)，其状态的分类有着非常优美的性质。一个核心定理指出 [@problem_id:1288858]：
 **任何有限、不可约的马尔可夫链，其所有状态都必须是[正常返](@entry_id:195139)的。**

“不可约”意味着整个[状态空间](@entry_id:177074)是一个单一的[互通类](@entry_id:267280)。首先，由于链是有限且不可约的，整个[状态空间](@entry_id:177074)构成一个[闭互通类](@entry_id:273537)，因此不存在暂留态，所有状态都是常返的。其次，对于任何有限不[可约链](@entry_id:200553)，存在一个唯一的**稳态分布 (stationary distribution)** $\pi = (\pi_i)$，其中 $\pi_i > 0$。状态的平均返回时间与稳态分布之间有一个精确的关系，称为卡兹公式 (Kac's formula)：$\mu_i = 1/\pi_i$。由于 $\pi_i$ 是一个严格为正的有限数，所以 $\mu_i$也必须是有限的。因此，所有状态都是[正常返](@entry_id:195139)的。这意味着在有限、不可约的系统中，[零常返](@entry_id:276939)现象不会发生。

#### 整数[格点上的随机游走](@entry_id:636731)

当状态空间变为无限时，情况变得复杂得多，状态的分类依赖于模型的更多细节，如维度和转移偏置。

考虑一个在一维聚合物链上移动的缺陷，其运动由一个[随机游走](@entry_id:142620)描述 [@problem_id:128903]。如果向右移动的概率 $p_R$ 与向左移动的概率 $p_L$ 不相等，例如 $p_R > p_L$，该[随机游走](@entry_id:142620)就具有一个正的**漂移 (drift)**。根据大数定律，粒子的位置会随着时间的推移而趋向于漂向正无穷。这意味着它几乎必然会离开任何有限区域并且永不返回。因此，它访问任何给定状态的次数都是有限的，所有状态都是暂留的。

当[随机游走](@entry_id:142620)没有偏置时（即[对称随机游走](@entry_id:273558)），情况变得更加微妙，并且与空间的维度密切相关。一个由数学家波利亚 (Pólya) 发现的著名结果是，二维平面 $\mathbb{Z}^2$ 上的简单[对称随机游走](@entry_id:273558)是**常返的**。我们可以通过更高等的数学工具（如[生成函数](@entry_id:146702)或傅里叶分析）证明，从原点出发的粒子最终返回原点的概率恰好为1 [@problem_id:1288868]。这一结果与一维[对称随机游走](@entry_id:273558)（也是常返的）性质相同，但与三维及更高维度的[对称随机游走](@entry_id:273558)（它们是暂留的）形成了鲜明对比。这揭示了对于无限[状态空间](@entry_id:177074)，状态的分类可能深刻地取决于[状态空间](@entry_id:177074)的全局拓扑结构和维度。