{"hands_on_practices": [{"introduction": "在分析马尔可夫链时，第一步通常是将其状态空间分解为相互连通的组。这个练习 [@problem_id:1288879] 使用一个简化的无人机操作状态模型，来演示如何识别这些被称为“互通类”的基本构造块。理解互通类是掌握马尔可夫链结构的关键。", "problem": "一个自主送货无人机的运行状态简化模型由状态空间 $S = \\{1, 2, 3, 4, 5\\}$ 上的离散时间马尔可夫链描述。这些状态代表以下模式：\n- 状态 1: `Standby`\n- 状态 2: `Surveying Area`\n- 状态 3: `Returning to Base`\n- 状态 4: `Landing Sequence`\n- 状态 5: `Safe Shutdown`\n\n从任何给定状态，无人机只能转移到一组特定的后续状态。允许的一步转移如下：\n- 从 `Standby` (1)，它只能转移到 `Surveying Area` (2)。\n- 从 `Surveying Area` (2)，它只能转移到 `Standby` (1)。\n- 从 `Returning to Base` (3)，它只能转移到 `Landing Sequence` (4)。\n- 从 `Landing Sequence` (4)，它只能转移到 `Safe Shutdown` (5)。\n- 从 `Safe Shutdown` (5)，它保持在 `Safe Shutdown` (5)。\n\n没有其他可能的一步转移。如果从状态 $i$ 开始可以到达状态 $j$，并且从状态 $j$ 开始也可以到达状态 $i$，则称两个状态 $i$ 和 $j$ 是互通的。一个互通类是一个极大状态集合，其中集合内的每一对状态都相互互通。\n\n确定此马尔可夫链的互通类。\n\nA. {{1, 2, 3, 4, 5}}\n\nB. {{1}, {2}, {3}, {4}, {5}}\n\nC. {{1, 2}, {3, 4, 5}}\n\nD. {{1, 2}, {3}, {4}, {5}}\n\nE. {{1, 2}, {3, 4}, {5}}", "solution": "我们使用由一步转移导出的有向图来对互通性进行建模。对于状态 $i$ 和 $j$，如果存在整数 $m \\geq 1$ 和 $n \\geq 1$，使得存在从 $i$ 到 $j$ 的长度为 $m$ 的路径和从 $j$ 到 $i$ 的长度为 $n$ 的路径，则 $i$ 与 $j$ 互通。等价地，在马尔可夫链中，$i$ 能在若干步内以正概率到达 $j$，且 $j$ 也能在若干步内以正概率到达 $i$。\n\n根据允许的转移：\n- 从状态 1，唯一的转移是 $1 \\to 2$；从状态 2，唯一的转移是 $2 \\to 1$。因此 $1 \\to 2$ 且 $2 \\to 1$，所以 $1$ 和 $2$ 互通。没有从 $\\{1,2\\}$ 到 $\\{3,4,5\\}$ 的转移，反之亦然，因此没有其他状态与 $1$ 或 $2$ 互通。因此 $\\{1,2\\}$ 是一个互通类。\n\n- 从状态 3，唯一的转移是 $3 \\to 4$，从 4 的唯一转移是 $4 \\to 5$，从 5 的唯一转移是 $5 \\to 5$。因此 $3 \\to 4 \\to 5$，但没有从 4 或 5 返回到 3 的路径，所以 3 不与任何其他状态互通。因此 $\\{3\\}$ 是一个互通类。\n\n- 从状态 4，唯一的转移是 $4 \\to 5$。因为从状态 5 无法返回状态 4，所以 4 和 5 不互通。因为状态 4 无法到达状态 1, 2, 3，所以它也不与它们互通。因此 $\\{4\\}$ 是一个互通类。\n\n- 从状态 5，唯一的转移是 $5 \\to 5$。由于没有从 5 到任何其他状态的路径，所以 5 无法与任何其他状态互通。因此 $\\{5\\}$ 是一个互通类。\n\n综合这些，互通类是 $\\{1,2\\}$、$\\{3\\}$、$\\{4\\}$ 和 $\\{5\\}$，这与选项 D 相匹配。", "answer": "$$\\boxed{D}$$", "id": "1288879"}, {"introduction": "将状态分组到类中之后，下一个问题是它们的长期行为。这个练习 [@problem_id:1288866] 使用一个街机游戏场景，来探索瞬时状态和常返状态之间的关键区别。通过这个例子，你将了解到在有限马尔可夫链中，能够“逃逸”到一个吸收类中的状态必然是瞬时的。", "problem": "一个简单的街机游戏包含玩家闯过四个标记为1、2、3和4的关卡。玩家的闯关过程被建模为状态空间 $S = \\{1, 2, 3, 4\\}$ 上的一个离散时间马尔可夫链，其中状态表示玩家当前的关卡。关卡之间的转移概率如下：\n- 从关卡1，玩家有 $p_{11} > 0$ 的概率重玩此关卡，有 $p_{12} > 0$ 的概率前进到关卡2，且 $p_{11} + p_{12} = 1$。\n- 从关卡2，玩家有 $p_{21} > 0$ 的概率被送回关卡1，有 $p_{23} > 0$ 的概率前进到关卡3，且 $p_{21} + p_{23} = 1$。\n- 从关卡3，玩家有 $p_{32} > 0$ 的概率被送回关卡2，有 $p_{34} > 0$ 的概率前进到关卡4，且 $p_{32} + p_{34} = 1$。\n- 关卡4是最终的“游戏结束”关卡。一旦玩家到达这个关卡，他们将永远停留在那里。\n\n根据这个马尔可夫链的性质，对与关卡1、2和3相对应的状态进行分类。\n\nA. 状态1是常返的，而状态2和3是暂留的。\n\nB. 状态1和2是常返的，而状态3是暂留的。\n\nC. 所有三个状态（1、2和3）都是常返的。\n\nD. 所有三个状态（1、2和3）都是暂留的。\n\nE. 状态3是常返的，而状态1和2是暂留的。", "solution": "我们考虑在 $S=\\{1,2,3,4\\}$ 上的离散时间马尔可夫链，其转移概率如题所述。根据假设，关卡 $4$ 是吸收的，因此 $p_{44}=1$ 且对于所有 $j \\neq 4$ 都有 $p_{4j}=0$。一个状态 $i$ 是常返的，如果从 $i$ 出发，最终能返回到 $i$ 的概率等于1；如果该概率严格小于1，则它是暂留的。在一个有限马尔可夫链中，常返状态必然属于闭的互通类；此外，每个非闭的互通类完全由暂留状态组成。\n\n首先，我们建立关卡 $1,2,3$ 之间的互通关系：\n- 从关卡1，$p_{12}>0$，所以 $1 \\to 2$。\n- 从关卡2，$p_{21}>0$ 且 $p_{23}>0$，所以 $2 \\to 1$ 且 $2 \\to 3$。\n- 从关卡3，$p_{32}>0$ 且 $p_{34}>0$，所以 $3 \\to 2$ 且 $3 \\to 4$。\n\n因此，在 $\\{1,2,3\\}$ 内部，我们有 $1 \\leftrightarrow 2$ （因为 $1 \\to 2$ 且 $2 \\to 1$）以及 $2 \\leftrightarrow 3$ （因为 $2 \\to 3$ 且 $3 \\to 2$），因此 $1,2,3$ 彼此互通；即 $\\{1,2,3\\}$ 是一个单一的互通类。然而，这个类不是闭的，因为从状态3有正概率 $p_{34}>0$ 转移到状态 $4 \\notin \\{1,2,3\\}$。因此，根据有限状态分类定理，非闭互通类 $\\{1,2,3\\}$ 中的每个状态都是暂留的。\n\n等价地，因为唯一的闭类是 $\\{4\\}$ 且它是吸收的，又因为从任意 $i \\in \\{1,2,3\\}$ 都存在一条具有正概率的路径到达4（例如，$1 \\to 2 \\to 3 \\to 4$ 的乘积概率为 $p_{12} p_{23} p_{34} > 0$），所以从1、2、3中任意一个状态出发，被4吸收的概率为1。因此，无限次返回到1、2、3中任何一个状态的概率为零，这证实了1、2、3是暂留的。\n\n因此，所有三个状态1、2、3都是暂留的，对应于选项D。", "answer": "$$\\boxed{D}$$", "id": "1288866"}, {"introduction": "除了常返性，一些状态还表现出周期性的模式。这个练习 [@problem_id:1288894] 介绍了周期性的概念，它捕捉了这种循环特性。通过一个假设的股票交易算法，你将通过计算所有可能返回时间的最大公约数（$d(i) = \\text{gcd}\\{n \\geq 1 : P_{ii}^{(n)} > 0\\}$）来确定一个状态的周期。", "problem": "在随机过程的研究中，离散时间马尔可夫链中的一个状态可以通过其周期进行分类。状态 $i$ 的周期，记为 $d(i)$，定义为所有使得在 $n$ 步后可能返回状态 $i$ 的整数 $n \\geq 1$ 的集合的最大公约数（GCD）（即，从状态 $i$ 经过 $n$ 步转移到状态 $i$ 的概率 $P_{ii}^{(n)}$ 大于零）。\n\n考虑一个自动化股票交易算法的简化模型，其在特定市场条件下的行为由一个离散时间马尔可夫链描述。该链的状态对应于不同的市场情绪（例如，“牛市”、“熊市”、“稳定”）。对于一个被定义为“稳定”状态的特定状态，对该算法的状态转移图的分析揭示了以下可能的返回时间：从“稳定”状态出发，系统有可能在 4 个时间步后返回到同一状态。也有可能在 6 个时间步后发生返回。最后，一条更长的循环路径允许在 8 个时间步后返回。\n\n根据这些关于可能返回时间的信息，计算“稳定”状态的周期。", "solution": "根据定义，离散时间马尔可夫链中状态 $i$ 的周期为\n$$\nd(i) = \\gcd\\{n \\geq 1 : P_{ii}^{(n)} > 0\\}。\n$$\n题中告知我们，从“稳定”状态 $i$ 出发，可能在 $n=4$、$n=6$ 和 $n=8$ 步后返回，因此定义中的集合包含这些值。所以，周期的计算必须满足它能整除所有已知的返回时间。我们计算这些已知时间的最大公约数：\n$$\nd(i) = \\gcd(4,6,8)。\n$$\n使用最大公约数的性质：\n$$\n\\gcd(4,6) = 2 \\quad \\text{since } 4 = 2 \\cdot 2,\\; 6 = 2 \\cdot 3,\n$$\n接着\n$$\n\\gcd(2,8) = 2 \\quad \\text{since } 8 = 2 \\cdot 4.\n$$\n因此，所有已知返回时间的最大公约数是 $2$。由于周期 $d(i)$ 必须是这个集合 $\\{4, 6, 8, \\dots\\}$ 中所有元素的最大公约数，它必定整除 $\\gcd(4,6,8)=2$。假设没有其他返回时间会改变这个结果，周期就是 $2$。\n$$\nd(i) = 2.\n$$\n这与任何周期都必须整除所有可行的返回时间这一事实是一致的；能同时整除 $4$、$6$ 和 $8$ 的最大整数是 $2$。", "answer": "$$\\boxed{2}$$", "id": "1288894"}]}