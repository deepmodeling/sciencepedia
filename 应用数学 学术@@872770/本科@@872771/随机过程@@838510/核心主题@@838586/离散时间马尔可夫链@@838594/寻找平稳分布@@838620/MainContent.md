## 引言
在[随机过程](@entry_id:159502)的世界中，马尔可夫链为我们提供了一个描述系统状态如何随时间演化的强大框架。许多系统在长时间运行后会趋于一种稳定的平衡状态，这种状态下的[概率分布](@entry_id:146404)不再变化，被称为“[平稳分布](@entry_id:194199)”。理解并计算平稳分布至关重要，因为它揭示了系统的长期平均行为，使我们能够对从[网页排名](@entry_id:139603)到基因突变的各种现象做出精确的长期预测。

然而，从理论概念到实际计算，我们如何才能准确地找到这个关键的[分布](@entry_id:182848)呢？本文将系统地引导你解决这一问题。在“原理与机制”一章中，我们将从核心的平衡方程出发，掌握通用的求解方法和针对特殊结构的捷径。接着，在“应用与跨学科联系”一章中，我们将探索平稳分布在计算机科学、生物学、物理学等领域的广泛应用，展示其强大的解释力。最后，通过“动手实践”部分的精选问题，你将有机会亲手应用所学知识，将理论转化为解决实际问题的能力。

让我们首先深入其核心，揭示[平稳分布](@entry_id:194199)背后的数学原理和计算机制。

## 原理与机制

在上一章中，我们介绍了马尔可夫链的基本概念，它为描述状态随时间随机演化的系统提供了一个强大的数学框架。许多这样的系统，如果长时间运行，会表现出一种显著的稳定行为：处于各个状态的概率不再随时间变化，而是达到一个平衡。这种平衡状态的[概率分布](@entry_id:146404)被称为**平稳分布**（Stationary Distribution）。平稳分布是[随机过程](@entry_id:159502)理论中的核心概念之一，因为它揭示了系统的长期平均行为，使我们能够预测系统在未来任意时刻的统计特性，而无需关心其初始状态。

本章旨在深入探讨平稳分布的原理与计算机制。我们将从定义[平稳分布](@entry_id:194199)的核心方程——**[平衡方程](@entry_id:172166)**出发，介绍求解该[分布](@entry_id:182848)的通用方法。随后，我们将探索一些重要的特殊结构，如双随机矩阵和可逆链，它们可以极大地简化计算过程。最后，我们将讨论一些高级建模技巧，以处理更复杂的现实世界问题，例如状态依赖于过去多个时刻或转移规则本身随时间周期性变化的情形。

### 平稳分布的基本原理：平衡方程

想象一个由多个状态组成的系统。在任意时刻，系统中的“概率质量”会根据转移概率在不同状态之间流动。如果系统[达到平衡](@entry_id:170346)，那么在每个时间步之后，流入任一状态 $j$ 的总概率恰好等于从该状态流出的总概率。这种“收支平衡”的思想正是[平稳分布](@entry_id:194199)的精髓。

形式上，对于一个具有状态空间 $S$ 和转移[概率矩阵](@entry_id:274812) $P$ 的[离散时间马尔可夫链](@entry_id:263188)，一个[概率分布](@entry_id:146404) $\pi = (\pi_i)_{i \in S}$ 被称为**平稳分布**，如果它满足以下两个条件：

1.  **平衡方程**：$\pi = \pi P$
2.  **[归一化条件](@entry_id:156486)**：$\sum_{i \in S} \pi_i = 1$，并且所有 $\pi_i \ge 0$。

[平衡方程](@entry_id:172166) $\pi = \pi P$ 是一个向量方程，可以展开为针对每个状态 $j$ 的分量形式：
$$
\pi_j = \sum_{i \in S} \pi_i P_{ij}
$$
这个方程的直观解释是：在平稳状态下，系统在下一时刻处于状态 $j$ 的概率（方程左侧），等于从所有可能的状态 $i$（包括 $j$ 本身）转移到状态 $j$ 的概率之和（方程右侧）。换言之，如果系统的初始状态是按照 $\pi$ [分布](@entry_id:182848)的，那么在一步转移之后，系统的状态[分布](@entry_id:182848)仍然是 $\pi$。这个[分布](@entry_id:182848)一旦达成，就会永远保持下去。

在[遍历马尔可夫链](@entry_id:266539)（即不可约且非周期的链）中，[平稳分布](@entry_id:194199)不仅存在而且是唯一的。更重要的是，无论马尔可夫链从哪个初始状态开始，其状态[分布](@entry_id:182848)在经过足够长的时间后都会收敛到这个唯一的平稳分布。这意味着 $\pi_j$ 代表了系统在长期运行中处于状态 $j$ 的时间比例或概率。

### 通用求解方法：建立并[求解线性方程组](@entry_id:169069)

从定义出发，寻找平稳分布最直接的方法就是求解由[平衡方程](@entry_id:172166)和[归一化条件](@entry_id:156486)构成的[线性方程组](@entry_id:148943)。让我们通过一个具体的例子来演示这个过程。

考虑一个模拟选民对某位候选人意见变化过程的模型 [@problem_id:1302600]。选民的意见分为三种状态：“支持”（For）、“反对”（Against）和“未定”（Undecided）。根据每周的新闻周期，意见变化的概率如下：

*   从“支持”转移至“支持”、“反对”、“未定”的概率分别为 $0.70, 0.10, 0.20$。
*   从“反对”转移至“支持”、“反对”、“未定”的概率分别为 $0.05, 0.80, 0.15$。
*   从“未定”转移至“支持”、“反对”、“未定”的概率分别为 $0.30, 0.40, 0.30$。

我们可以将这些概率整理成一个[转移矩阵](@entry_id:145510) $P$，状态顺序为（支持, 反对, 未定）：
$$
P = \begin{pmatrix} 0.70 & 0.10 & 0.20 \\ 0.05 & 0.80 & 0.15 \\ 0.30 & 0.40 & 0.30 \end{pmatrix}
$$
我们要寻找[平稳分布](@entry_id:194199) $\pi = (\pi_1, \pi_2, \pi_3)$，其中 $\pi_1, \pi_2, \pi_3$ 分别代表长期来看人群中处于“支持”、“反对”和“未定”状态的比例。根据平衡方程 $\pi P = \pi$，我们得到：
$$
\begin{cases}
0.70\pi_1 + 0.05\pi_2 + 0.30\pi_3 = \pi_1 \\
0.10\pi_1 + 0.80\pi_2 + 0.40\pi_3 = \pi_2 \\
0.20\pi_1 + 0.15\pi_2 + 0.30\pi_3 = \pi_3
\end{cases}
$$
再加上[归一化条件](@entry_id:156486) $\pi_1 + \pi_2 + \pi_3 = 1$。

整理上述[方程组](@entry_id:193238)，我们得到：
$$
\begin{cases}
-0.30\pi_1 + 0.05\pi_2 + 0.30\pi_3 = 0 \\
0.10\pi_1 - 0.20\pi_2 + 0.40\pi_3 = 0 \\
\pi_1 + \pi_2 + \pi_3 = 1
\end{cases}
$$
值得注意的是，对于任意马尔可夫链，平衡方程组中的一个方程总是冗余的（可以通过其他方程导出），因此我们只需选择其中任意两个，并结合[归一化条件](@entry_id:156486)来求解。通过代数运算，我们可以解得这个[方程组](@entry_id:193238)的唯一解。例如，将 $\pi_3$ 用 $\pi_1$ 和 $\pi_2$ 表示并代入，最终可以求得：
$$
\pi_1 = \frac{16}{57}, \quad \pi_2 = \frac{30}{57} = \frac{10}{19}, \quad \pi_3 = \frac{11}{57}
$$
这意味着，经过长时间的舆论演变，大约 $28.1\%$ 的选民会支持该候选人，大约 $52.6\%$ 会反对，而剩下的 $19.3\%$ 则处于未定状态。

这种直接[求解线性方程组](@entry_id:169069)的方法是普适的，适用于任何有限状态的不可约马尔可夫链。在更复杂的系统中，例如一个由四个房间组成的迷宫模型 [@problem_id:1302619]，尽管状态更多，导致[方程组](@entry_id:193238)也更庞大，但其求解的基本逻辑是完全相同的。

### 利用对称性：双随机矩阵的特殊情况

虽然通用方法总是有效的，但在某些特殊情况下，我们可以利用[转移矩阵](@entry_id:145510)的结构特性来更快地找到平稳分布。其中一种最简单也最重要的情况是**双随机矩阵**（Doubly Stochastic Matrix）。

一个方阵如果其所有元素非负，并且每行之和与每列之和都等于 $1$，则称之为双[随机矩阵](@entry_id:269622)。对于一个具有双随机[转移矩阵](@entry_id:145510)的不可约马尔可夫链，其唯一的平稳分布是**[均匀分布](@entry_id:194597)**。也就是说，如果[状态空间](@entry_id:177074)有 $N$ 个状态，那么每个状态的平稳概率都是 $\pi_i = \frac{1}{N}$。

让我们来验证这一点。假设 $\pi_i = \frac{1}{N}$ 对所有 $i$ 都成立。那么平衡方程的第 $j$ 个分量是：
$$
\sum_{i \in S} \pi_i P_{ij} = \sum_{i \in S} \frac{1}{N} P_{ij} = \frac{1}{N} \sum_{i \in S} P_{ij}
$$
由于 $P$ 是双随机的，其每一列的元素之和为 $1$，即 $\sum_{i \in S} P_{ij} = 1$。因此，上式变为：
$$
\frac{1}{N} \times 1 = \frac{1}{N} = \pi_j
$$
这表明 $\pi_j = \sum_{i \in S} \pi_i P_{ij}$ 成立，[均匀分布](@entry_id:194597)确实是平稳分布。

考虑一个粒子在三角形的三个顶点A、B、C上进行[随机游走](@entry_id:142620)的问题 [@problem_id:1302639]。粒子以概率 $p$ 顺时针移动到相邻顶点，以概率 $1-p$ 逆时针移动。其[转移矩阵](@entry_id:145510)（状态序A, B, C）为：
$$
P = \begin{pmatrix} 0 & p & 1-p \\ 1-p & 0 & p \\ p & 1-p & 0 \end{pmatrix}
$$
我们检查其列和：
*   第一列：$0 + (1-p) + p = 1$
*   第二列：$p + 0 + (1-p) = 1$
*   第三列：$(1-p) + p + 0 = 1$
每行之和显然也为 $1$。因此，$P$ 是一个双随机矩阵。由于该链是不可约的，我们可以立即得出结论：其[平稳分布](@entry_id:194199)是[均匀分布](@entry_id:194597) $\pi = (\frac{1}{3}, \frac{1}{3}, \frac{1}{3})$。这意味着无论初始位置和移动偏好 $p$ 的值是多少（只要 $0 < p < 1$），长期来看，粒子在每个顶点花费的时间都是相同的。

另一个例子是安保人员在两个岗位 A 和 B 之间巡逻的模型 [@problem_id:1302598]。安保人员以概率 $p$ 停留在当前岗位，以概率 $1-p$ 移动到另一岗位。其转移矩阵为：
$$
P = \begin{pmatrix} p & 1-p \\ 1-p & p \end{pmatrix}
$$
这个矩阵的列和也是 $p + (1-p) = 1$，所以它也是双随机的。因此，平稳分布必然是 $(\frac{1}{2}, \frac{1}{2})$。安保人员长期来看在两个岗位的时间各占一半。在遇到具有对称性的问题时，检查矩阵是否为双随机的是一种非常有效的解题策略。

### [细致平衡原理](@entry_id:200508)：[可逆马尔可夫链](@entry_id:198392)

除了双[随机矩阵](@entry_id:269622)，另一个能够极大简化计算的强大工具是**[细致平衡原理](@entry_id:200508)**（Principle of Detailed Balance）。这个原理适用于一类被称为**[可逆马尔可夫链](@entry_id:198392)**（Reversible Markov Chains）的特殊过程。

在平稳状态下，[全局平衡方程](@entry_id:272290) $\pi_j = \sum_i \pi_i P_{ij}$ 描述了流入和流出每个状态 $j$ 的总概率相等。而细致平衡是一个更强的条件，它要求对于任意两个状态 $i$ 和 $j$，从 $i$ 流向 $j$ 的概率流与从 $j$ 流向 $i$ 的概率流完全相等：
$$
\pi_i P_{ij} = \pi_j P_{ji}
$$
这组方程被称为**[细致平衡方程](@entry_id:265021)**。满足[细致平衡](@entry_id:145988)的马尔可夫链被称为可逆的，因为在统计意义上，这个过程向前看和向后看是无法区分的。

[细致平衡](@entry_id:145988)的重要性在于：任何满足[细致平衡方程](@entry_id:265021)且归一化的[分布](@entry_id:182848) $\pi$ 必然是该马尔可夫链的平稳分布。这是因为将[细致平衡方程](@entry_id:265021)对所有状态 $i$求和，我们得到：
$$
\sum_i \pi_i P_{ij} = \sum_i \pi_j P_{ji} = \pi_j \sum_i P_{ji} = \pi_j \cdot 1 = \pi_j
$$
这恰好就是[全局平衡方程](@entry_id:272290)。因此，如果我们可以找到满足[细致平衡](@entry_id:145988)的解，我们也就找到了[平稳分布](@entry_id:194199)。对于许多物理和生物系统模型（特别是那些没有明显“方向”或循环的系统），[细致平衡方程](@entry_id:265021)通常比[全局平衡方程](@entry_id:272290)更容易求解。

考虑一个简化的聚合物分[子模](@entry_id:148922)型，它可以在三个线性[排列](@entry_id:136432)的状态 A、B、C 之间转换 [@problem_id:1302616]。转移只在相邻状态间发生：$A \leftrightarrow B$ 和 $B \leftrightarrow C$。其转移概率为 $p_{AB}=\alpha, p_{BA}=\beta, p_{BC}=\gamma, p_{CB}=\delta$。
这种“出生-死亡过程”是可逆链的典型例子。我们不必写出完整的[全局平衡方程](@entry_id:272290)，而是可以直接应用[细致平衡方程](@entry_id:265021)：
*   对于 A 和 B 之间的转换： $\pi_A p_{AB} = \pi_B p_{BA} \implies \pi_A \alpha = \pi_B \beta$
*   对于 B 和 C 之间的转换： $\pi_B p_{BC} = \pi_C p_{CB} \implies \pi_B \gamma = \pi_C \delta$
*   对于 A 和 C 之间，由于 $p_{AC}=p_{CA}=0$，方程 $0=0$ 自动满足。

从这两个简单的方程中，我们可以将 $\pi_B$ 和 $\pi_C$ 用 $\pi_A$ 表示：
$$
\pi_B = \pi_A \frac{\alpha}{\beta} \quad \text{and} \quad \pi_C = \pi_B \frac{\gamma}{\delta} = \pi_A \frac{\alpha\gamma}{\beta\delta}
$$
最后，利用[归一化条件](@entry_id:156486) $\pi_A + \pi_B + \pi_C = 1$ 来求解 $\pi_A$：
$$
\pi_A \left(1 + \frac{\alpha}{\beta} + \frac{\alpha\gamma}{\beta\delta}\right) = 1 \implies \pi_A = \frac{\beta\delta}{\beta\delta + \alpha\delta + \alpha\gamma}
$$
由此可以得到所有三个状态的平稳概率。这个过程比求解三元一次[方程组](@entry_id:193238)要简洁得多。

同样，在一个粒子在一维[轨道](@entry_id:137151)上的四个位置移动的模型中 [@problem_id:1302617]，我们也可以利用细致平衡来求解。即使端点处的转移规则不同（确定性转移），[细致平衡方程](@entry_id:265021) $\pi_i P_{ij} = \pi_j P_{ji}$ 仍然适用，并能迅速给出各状态概率之间的比例关系。

对于简单的[循环过程](@entry_id:146195)，细致平衡的思想可以表现为“[流量守恒](@entry_id:273629)”。在一个三态循环机器模型中 [@problem_id:1302602]，状态为 $S_1 \to S_2 \to S_3 \to S_1$。在[稳态](@entry_id:182458)下，从 $S_1$ 净流向 $S_2$ 的概率量，必须等于从 $S_2$ 净流向 $S_3$ 的量，也等于从 $S_3$ 净流向 $S_1$ 的量。这导致了方程 $\pi_1(1-\epsilon_1) = \pi_2(1-\epsilon_2) = \pi_3(1-\epsilon_3)$，从而可以轻松求解。

### 高级建模技巧

现实世界中的许多过程不能直接用简单的[马尔可夫链](@entry_id:150828)来描述。幸运的是，通过一些巧妙的建模技巧，我们可以将更复杂的问题转化为能够求解[平稳分布](@entry_id:194199)的标准形式。

#### 处理高阶依赖性：状态空间的扩展

标准的马尔可夫链具有**马尔可夫性**，即下一状态的概率仅取决于当前状态，而与过去的状态无关。然而，在许多系统中，未来可能依赖于过去多个时刻的状态。例如，天气预测可能不仅取决于昨天的天气，还取决于前天的天气。

我们可以通过**扩展状态空间**来处理这种高阶依赖性。如果系统的下一状态 $X_{t+1}$ 依赖于前 $k$ 个状态 $(X_t, X_{t-1}, \dots, X_{t-k+1})$，我们可以定义一个新的[状态向量](@entry_id:154607) $Y_t = (X_t, X_{t-1}, \dots, X_{t-k+1})$。这个新的过程 $Y_t$ 就具有马尔可夫性，因为 $Y_{t+1} = (X_{t+1}, X_t, \dots, X_{t-k+2})$ 的[分布](@entry_id:182848)完全由 $Y_t$ 决定。

考虑一个天气模型，其中某天的天气（晴或雨）取决于前两天的天气 [@problem_id:1302597]。这是一个二阶马尔可夫链。为了分析它，我们定义一个新的状态为过去两天的天气组合，例如 (昨天天气, 今天天气)。这样，我们就有四个状态：(晴, 晴), (雨, 晴), (晴, 雨), (雨, 雨)。从一个状态，例如 (雨, 晴)，转移到下一个状态，例如 (晴, 晴) 的概率，就是已知前两天是“雨”和“晴”时，今天将是“晴”的概率，这在问题中是给定的。通过这种方式，我们将一个二阶的、双状态的过程转化为了一个一阶的、四状态的马尔可夫链。然后我们就可以使用标准方法为这个新的四状态链求解其[平稳分布](@entry_id:194199) $\pi = (\pi_{SS}, \pi_{RS}, \pi_{SR}, \pi_{RR})$。最终，我们关心的长期晴天概率就是处于状态 (晴, 晴) 和 (雨, 晴) 的概率之和，即 $\pi_{sunny} = \pi_{SS} + \pi_{RS}$。

#### 处理周期性变化：复合[转移矩阵](@entry_id:145510)

另一个复杂情况是转移概率本身不是固定的，而是随时间周期性变化。例如，一个学习模型可能在“学习日”和“休息日”有不同的记忆遗忘和巩固概率。

如果[转移矩阵](@entry_id:145510)以周期 $k$ 变化，即 $P_1, P_2, \dots, P_k, P_1, \dots$，我们不能直接为任何一个 $P_i$ 求解[平稳分布](@entry_id:194199)。但是，我们可以考察系统在每个完整周期结束时的行为。一个完整周期内的总转移矩阵是这些周期性矩阵的乘积：
$$
T = P_1 P_2 \cdots P_k
$$
现在，我们可以将系统视为一个时间同质的马尔可夫链，但其时间步长为一个完整的周期，[转移矩阵](@entry_id:145510)为 $T$。我们可以为这个“复合链”求解其[平稳分布](@entry_id:194199) $\pi$，满足 $\pi = \pi T$。这个 $\pi$ 描述了系统在每个周期*结束时*的长期[概率分布](@entry_id:146404)。

在一个学生记忆模型中 [@problem_id:1302647]，学生经历一个为期两天的学习周期：学习日（转移矩阵为 $A$）和休息日（[转移矩阵](@entry_id:145510)为 $B$）。要找到在每个周期结束时（即休息日结束时）的[长期记忆](@entry_id:169849)状态，我们首先计算两日周期的复合转移矩阵 $T = AB$。然后，我们求解这个新[马尔可夫链](@entry_id:150828)的平稳分布 $\pi$，即解方程 $\pi = \pi(AB)$。这个解 $\pi$ 就给出了在周期性观察点上的稳定概率。

### 理论探讨：存在性、唯一性与时间反演

我们已经看到如何计算[平稳分布](@entry_id:194199)，但值得再次强调其存在的理论基础。对于一个具有**有限**[状态空间](@entry_id:177074)的马尔可夫链，**不可约性**（Irreducibility，即从任何状态出发都有可能到达任何其他状态）是保证至少存在一个平稳分布的关键。如果链还是**非周期性**的（Aperiodicity，即从任何状态返回自身的步数不局限于某个大于1的整数的倍数），那么这个平稳分布就是**唯一**的，并且它也是**[极限分布](@entry_id:174797)**（Limiting Distribution），即无论初始状态如何，长期来看系统处于状态 $i$ 的概率都会收敛到 $\pi_i$。本章讨论的所有例子都满足这些条件。

最后，让我们简要回顾一个深刻的理论概念：**时间反演**（Time Reversal）。对于一个已经达到平稳状态的不可约[马尔可夫链](@entry_id:150828)，如果我们观察其状态序列并倒序播放，我们得到的仍然是一个[马尔可夫链](@entry_id:150828)，称为**时间反演链**。其转移概率 $\hat{p}_{ij}$（即在反演过程中从 $i$ 转移到 $j$ 的概率）与原链的转移概率 $p_{ji}$ 和平稳分布 $\pi$ 有如下关系：
$$
\hat{p}_{ij} = \frac{\pi_j p_{ji}}{\pi_i}
$$
一个非常优美的理论结果是，原链的[平稳分布](@entry_id:194199) $\pi$ *同样也是其时间反演链的平稳分布* [@problem_id:1300455]。我们可以通过将 $\pi$ 代入反演链的平衡方程来验证这一点：
$$
\sum_i \pi_i \hat{p}_{ij} = \sum_i \pi_i \left( \frac{\pi_j p_{ji}}{\pi_i} \right) = \pi_j \sum_i p_{ji} = \pi_j \cdot 1 = \pi_j
$$
这个结论揭示了平稳分布与系统动力学之间深刻的对称性。此外，它也重新联结到我们之前讨论的细致平衡。当一个链满足[细致平衡条件](@entry_id:265158) $\pi_i p_{ij} = \pi_j p_{ji}$ 时，我们有 $\hat{p}_{ij} = p_{ij}$，这意味着正向过程和反向过程的转移矩阵是完全相同的。这正是“可逆”一词的数学含义。

通过本章的学习，我们不仅掌握了计算平稳分布的多种实用技术——从通用的线性代数方法到针对特定结构的巧妙捷径——还深入理解了其背后的理论原理。[平稳分布](@entry_id:194199)是连接马尔可夫链理论与实际应用的关键桥梁，使我们能够对从物理、生物到社会科学的各种复杂[随机系统](@entry_id:187663)做出有意义的长期预测。