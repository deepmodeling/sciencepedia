{"hands_on_practices": [{"introduction": "理解一个状态的周期是掌握马尔可夫链行为的基础。一个状态的周期被定义为其所有可能的返回步数的最大公约数（$ \\gcd $）。本练习 [@problem_id:1281681] 提供了一个粒子在圆形轨道上运动的直观模型，让你能够通过分析可能的移动组合，从第一性原理出发计算周期的值，从而巩固核心定义。", "problem": "一个简单分子马达的概念模型涉及一个在圆形轨道上运动的粒子。考虑一个离散时间随机过程，该过程描述一个粒子在具有6个格子的圆形板上的位置，这些格子按顺序标记为0到5。在每个离散时间步，当前位于格子 $i$ 的粒子根据以下规则移动到一个新格子：\n- 它以概率 $p$ 顺时针移动1格到位置 $(i+1) \\pmod 6$。\n- 它以概率 $1-p$ 顺时针移动4格到位置 $(i+4) \\pmod 6$。\n\n常数 $p$ 是一个满足 $0 < p < 1$ 的固定参数。\n\n马尔可夫链中一个状态的周期定义为：从该状态出发，返回到该状态所有可能步数的最大公约数。鉴于此马尔可夫链是不可约的（即，可以从任何状态到达任何其他状态），所有状态都具有相同的周期。\n\n确定此马尔可夫链中任何状态的周期。", "solution": "我们将位置建模为6阶循环群的元素。从任何状态出发，在每个离散步骤中，该链以模6的方式移动 $+1$（概率为 $p$）或 $+4$（概率为 $1-p$）。由于 $0 < p < 1$，这两种移动都是可能的。为了求周期，我们寻找所有可能的返回步数 $n$ 的最大公约数。由于该链是不可约的，我们可以只考虑从0状态出发返回0状态。\n\n假设在 $n$ 步中，有 $k$ 次移动了1格，有 $n-k$ 次移动了4格，其中 $k$ 是一个整数，满足 $0 \\le k \\le n$。总位移为：\n$$\nk \\cdot 1 + (n-k) \\cdot 4 = k + 4n - 4k = 4n - 3k.\n$$\n要返回到0，总位移必须是6的倍数：\n$$\n4n - 3k \\equiv 0 \\pmod 6.\n$$\n这个同余方程等价于 $4n \\equiv 3k \\pmod 6$。我们正在寻找所有 $n \\ge 1$ 的值，使得存在一个整数 $k$ ($0 \\le k \\le n$) 满足此方程。\n\n我们可以分析这个方程的右边和左边：\n- 右边 $3k \\pmod 6$ 的值只能是 $0$（当 $k$ 是偶数）或 $3$（当 $k$ 是奇数）。\n- 左边 $4n \\pmod 6$ 的值序列为 $4, 2, 0, 4, 2, 0, \\dots$。它只能是 $0, 2, 4$。\n\n为了使方程成立，两边必须相等。这意味着 $4n \\pmod 6$ 必须等于 $0$ 或 $3$。由于 $4n \\pmod 6$ 永远不可能是 $3$，所以唯一可能的情况是：\n$$\n4n \\equiv 3k \\pmod 6 \\implies 4n \\equiv 0 \\pmod 3 \\quad \\text{and} \\quad 3k \\equiv 0 \\pmod 2.\n$$\n从 $4n \\equiv 0 \\pmod 3$ 可得 $n \\equiv 0 \\pmod 3$。这意味着任何可能的返回步数 $n$ 都必须是3的倍数。\n这已经告诉我们周期 $d$ 必须是3的倍数。\n\n现在我们需要确认是否存在一个长度为3的返回路径。令 $n=3$。我们寻找一个 $k \\in \\{0, 1, 2, 3\\}$ 使得 $4(3) - 3k = 12 - 3k \\equiv 0 \\pmod 6$。\n这个方程简化为 $-3k \\equiv 0 \\pmod 6$，或者 $3k \\equiv 0 \\pmod 6$。当 $k=0$ 或 $k=2$ 时，这个条件成立。\n- 如果 $k=0$，则所有3次移动都是+4格。总位移为 $3 \\times 4 = 12 \\equiv 0 \\pmod 6$。这是一个有效的3步返回路径。\n- 如果 $k=2$，则有2次移动+1格和1次移动+4格。总位移为 $2 \\times 1 + 1 \\times 4 = 6 \\equiv 0 \\pmod 6$。这也是一个有效的3步返回路径。\n\n由于所有返回步数都必须是3的倍数，并且3本身就是一个可能的返回步数，所以所有返回步数的最大公约数是3。因此，此马尔可夫链的周期是3。", "answer": "$$\\boxed{3}$$", "id": "1281681"}, {"introduction": "在确定了如何计算周期之后，下一个关键问题是：是什么样的系统结构导致了非周期性？非周期性（周期为1）通常在系统允许的转变具有“不兼容”的循环结构时出现，例如组合了长度为2和长度为3的返回路径。本练习 [@problem_id:1281646] 探索了一个基于排列组合的抽象马尔可夫链，通过分析不同的操作组合如何影响系统返回初始状态的能力，你将对导致非周期性的条件建立更深刻的理解。", "problem": "考虑一个离散时间马尔可ov链，其系统状态为三个不同物品（标记为 $I_1, I_2, I_3$）的某个排列。总共有 $3! = 6$ 个状态。在每个时间步，状态根据以下两种操作之一进行转移，这些操作应用于当前排列 $(x_1, x_2, x_3)$：\n\n1.  **交换操作**：以概率 $p$ 交换序列中的前两个物品。新状态变为 $(x_2, x_1, x_3)$。\n2.  **循环移位操作**：以概率 $1-p$ 对所有三个物品进行循环移位。\n    *   此移位是以概率 $q$ 进行的**左循环移位**，变为 $(x_2, x_3, x_1)$。\n    *   此移位是以概率 $1-q$ 进行的**右循环移位**，变为 $(x_3, x_1, x_2)$。\n\n参数 $p$ 和 $q$ 是在 $[0, 1]$ 范围内的常数。马尔可夫链中的一个状态，如果其周期为1，则被定义为非周期的。一个状态的周期是所有从该状态开始并返回到该状态的可能路径长度的最大公约数。如果一个马尔可夫链是不可约的，则其所有状态都具有相同的周期。如果一个链是可约的，则此性质在任何给定的互通类中的所有状态上都成立。\n\n对于下列哪几组参数 $(p, q)$，马尔可夫链的所有状态都是非周期的？选择所有适用的选项。\n\nA. $(p, q) = (1, 0.5)$\n\nB. $(p, q) = (0, 1)$\n\nC. $(p, q) = (0.5, 0)$\n\nD. $(p, q) = (0, 0.5)$\n\nE. $(p, q) = (0, 0)$\n\nF. $(p, q) = (0.5, 1)$", "solution": "设状态空间为三个物品的六种排列。将这三种操作（应用于位置）定义为三个符号上的对称群中的置换：\n- 交换前两个位置：$s=(1\\ 2)$。\n- 左循环移位：$r=(1\\ 2\\ 3)$。\n- 右循环移位：$r^{-1}=(1\\ 3\\ 2)$。\n\n在每一步，链将当前状态在右侧乘以 $s$、$r$ 或 $r^{-1}$ 之一，其概率分别为 $p$、$(1-p)q$ 和 $(1-p)(1-q)$。对于任何状态 $x$，$P^{n}(x,x) > 0$ 当且仅当在给定的 $(p,q)$ 下，存在一个长度为 $n$ 的、由可用生成元组成的词，其乘积等于单位元 $e$，且具有正概率。因此，状态 $x$ 的周期为\n$$\n\\gcd\\{\\,n \\geq 1 : \\exists \\text{ word of length } n \\text{ in allowed generators with product } e\\,\\}.\n$$\n如果链是不可约的，所有状态共享相同的周期。如果可约，则周期在每个互通类内部是共同的。\n\n我们使用以下关系式\n$$\ns^{2}=e,\\quad r^{3}=e,\\quad r^{-1}=r^{2},\\quad rr^{-1}=r^{-1}r=e,\\quad srs=r^{-1}.\n$$\n\n对给定的参数对进行情况分析：\n\nA. $(p,q)=(1,0.5)$。只使用 $s$（因为 $p=1$）。那么返回到 $e$ 的可能乘积恰好是 $s$ 的偶数次幂，得到返回长度 $n \\in \\{2,4,6,\\dots\\}$。因此周期为 $\\gcd\\{2,4,6,\\dots\\}=2$，所以状态不是非周期的。\n\nB. $(p,q)=(0,1)$。只使用 $r$。那么 $r^{n}=e$ 当且仅当 $n$ 是 $3$ 的倍数，所以返回长度为 $\\{3,6,9,\\dots\\}$，周期为 $3$。该链是可约的，分为两个大小为 $3$ 的类，在每个类中周期都是 $3$，所以状态不是非周期的。\n\nC. $(p,q)=(0.5,0)$。$s$ 和 $r^{-1}$ 均以正概率可用。那么：\n- $s^{2}=e$ 给出 $2$ 步返回，概率为正 $p^{2}>0$。\n- $(r^{-1})^{3}=e$ 给出 $3$ 步返回，概率为正 $(1-p)^{3}(1-q)^{3}>0$。\n因此 $2$ 和 $3$ 都是返回长度，周期为 $\\gcd(2,3)=1$。该链是不可约的，所有状态都是非周期的。\n\nD. $(p,q)=(0,0.5)$。只有 $r$ 和 $r^{-1}$ 可用，两者概率均为正。该链可约化为两个大小为 $3$ 的互通类（$\\{e,r,r^{2}\\}$ 的陪集）。在每个类中：\n- $rr^{-1}=e$ 产生 $2$ 步返回，概率为正 $q(1-q)>0$。\n- $r^{3}=e$（或 $(r^{-1})^{3}=e$）产生 $3$ 步返回，概率为正 $q^{3}>0$（或 $(1-q)^{3}>0$）。\n因此每个类内的周期是 $\\gcd(2,3)=1$，所以每个状态都是非周期的。\n\nE. $(p,q)=(0,0)$。只使用 $r^{-1}$。与情况 B 类似（用 $r^{-1}$ 代替 $r$），返回只在 $3$ 的倍数步发生，所以周期是 $3$。状态不是非周期的。\n\nF. $(p,q)=(0.5,1)$。$s$ 和 $r$ 均以正概率可用。那么：\n- $s^{2}=e$ 给出 $2$ 步返回，概率为 $p^{2}>0$。\n- $r^{3}=e$ 给出 $3$ 步返回，概率为 $(1-p)^{3}q^{3}>0$。\n因此周期为 $\\gcd(2,3)=1$，该链是不可约的，所有状态都是非周期的。\n\n综合所有非周期的情况，正确的选项是 C、D 和 F。", "answer": "$$\\boxed{CDF}$$", "id": "1281646"}, {"introduction": "非周期性为何如此重要？因为它是一个马尔可夫链拥有可预测的长期行为的关键条件，即收敛到一个唯一的稳态分布。本练习 [@problem_id:1281689] 模拟了一个在通信网络中移动的数据包，它清晰地展示了非周期性的实际应用。你将看到，通过引入“懒惰”移动（即有一定概率停留在原地），一个原本具有周期性的二分图上的随机游走会变得非周期性，从而确保了系统存在一个我们可以计算的稳定长期分布。", "problem": "一个通信网络被建模为一组节点 (顶点) 和链路 (边)。这五个节点的集合被划分为两个不相交的子集，一个服务器中心 $U = \\{u_1, u_2\\}$ 和一个客户端组 $V = \\{v_1, v_2, v_3\\}$。服务器中心的每个节点与客户端组的每个节点之间都存在一条链路。同一子集内的节点之间不存在链路。\n\n一个数据包在该网络上进行随机游走。在每个离散时间步，该数据包位于五个节点之一。数据包在其当前节点有 $p$ 的概率在下一个时间步停留在同一节点。有 $1-p$ 的概率，数据包被传输到一个相邻节点。如果发生传输，目标节点将从所有连接的 (相邻的) 节点中均匀随机选择。常数 $p$ 满足 $0 < p < 1$。\n\n假设此过程运行很长时间，数据包位于客户端组 $V$ 中任意单个特定节点 (例如，节点 $v_1$) 的长期时间比例是多少？请用一个单一的闭式解析表达式表示你的答案。", "solution": "我们将该网络建模为具有二分 $U=\\{u_{1},u_{2}\\}$ 和 $V=\\{v_{1},v_{2},v_{3}\\}$ 的无向图 $K_{2,3}$。该随机游走是惰性的：从节点 $i$ 出发，它以概率 $p$ 停留在 $i$，并以概率 $1-p$ 移动到一个均匀选择的邻居。\n\n定义节点 $i$ 和 $j$ 的转移概率：\n$$\nP_{ii}=p,\\quad\nP_{ij}=\\begin{cases}\n\\frac{1-p}{\\deg(i)},  \\text{若 $i$ 和 $j$ 相邻},\\\\\n0,  \\text{其他情况}。\n\\end{cases}\n$$\n因为 $0 < p < 1$，所以每个状态都有一个自循环 ($P_{ii}=p>0$)。图是连通的，所以马尔可夫链是不可约的。由于存在自循环，所有状态都是非周期的。因此，该链是遍历的，存在唯一的稳态分布 $\\boldsymbol{\\pi}$，其中 $\\lim_{n\\to\\infty}P^n_{ij} = \\pi_j$。\n\n对于不可约马尔可夫链，如果满足详细平衡条件 $\\pi_i P_{ij} = \\pi_j P_{ji}$，则 $\\boldsymbol{\\pi}$ 是一个平稳分布。对于在连通无向图上的惰性随机游走，众所周知，平稳分布与节点的度成正比，即 $\\pi_i \\propto \\deg(i)$。我们来验证这一点：\n假设 $i,j$ 相邻。\n$$\n\\pi_i P_{ij} = c \\cdot \\deg(i) \\cdot \\frac{1-p}{\\deg(i)} = c(1-p)\n$$\n$$\n\\pi_j P_{ji} = c \\cdot \\deg(j) \\cdot \\frac{1-p}{\\deg(j)} = c(1-p)\n$$\n详细平衡条件成立。因此，稳态概率由下式给出：\n$$\n\\pi_i = \\frac{\\deg(i)}{\\sum_{j \\in U \\cup V} \\deg(j)}\n$$\n我们需要计算图中所有节点的度。\n对于服务器中心的节点 $u \\in U$，$u$ 与 $V$ 中的所有3个节点相连，所以 $\\deg(u)=3$。\n对于客户端组的节点 $v \\in V$，$v$ 与 $U$ 中的所有2个节点相连，所以 $\\deg(v)=2$。\n所有度的总和为：\n$$\n\\sum_{j} \\deg(j) = \\sum_{u \\in U} \\deg(u) + \\sum_{v \\in V} \\deg(v) = (2 \\times 3) + (3 \\times 2) = 6 + 6 = 12.\n$$\n我们要求的是数据包位于客户端组 $V$ 中任意单个特定节点（例如 $v_1$）的长期时间比例。这个比例就是 $\\pi_{v_1}$。由于 $v_1 \\in V$，其度为 $\\deg(v_1) = 2$。\n因此，长期概率为：\n$$\n\\pi_{v_1} = \\frac{\\deg(v_1)}{\\sum_{j} \\deg(j)} = \\frac{2}{12} = \\frac{1}{6}.\n$$\n这个结果对于 $V$ 中的任何节点 ($v_1, v_2, v_3$) 都是相同的，因为它们都具有相同的度。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1281689"}]}