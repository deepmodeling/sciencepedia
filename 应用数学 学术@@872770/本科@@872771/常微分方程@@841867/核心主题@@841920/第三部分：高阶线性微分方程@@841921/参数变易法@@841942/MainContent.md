## 引言
在[常微分方程](@entry_id:147024)的宏伟画卷中，求解非[齐次线性方程](@entry_id:153751)是连接理论与应用的关键一环。我们熟知的[待定系数法](@entry_id:166225)在处理特定形式的[驱动函数](@entry_id:268893)时表现出色，但当面对形式更复杂、更贴近物理现实的外部输入时，该方法便显得力不从心。这一局限性促使我们寻找一种更具普适性与威力的工具，这便是**[参数变易法](@entry_id:756435)（Method of Variation of Parameters）**。它不仅仅是一种解题技巧，更是一种深刻的数学思想，其影响力贯穿了从基础[振动分析](@entry_id:146266)到前沿[量子理论](@entry_id:145435)的广阔领域。

本文旨在为读者系统性地构建对[参数变易法](@entry_id:756435)的全面理解。我们将分为三个循序渐进的章节：

*   在**原理与机制**一章中，我们将从二阶方程入手，详细推导[参数变易法](@entry_id:756435)的核心公式，理解朗斯基行列式在其中的关键作用，并从[微分算子](@entry_id:140145)的角度揭示其内在的[代数结构](@entry_id:137052)。我们还会将其推广至高阶方程与线性方程组，展示其系统性的美感。
*   在**应用与交叉学科联系**一章中，我们将跳出纯数学的范畴，探索该方法在[机械振动](@entry_id:167420)、[电路分析](@entry_id:261116)、[偏微分方程](@entry_id:141332)求解、[量子力学微扰](@entry_id:265613)论以及现代控制理论中的具体应用，领略其作为连接不同学科桥梁的强大功能。
*   最后，在**动手实践**部分，我们提供了一系列精心挑选的练习题，帮助您巩固理论知识，并将所学转化为解决实际问题的能力。

现在，让我们启程，首先深入其核心，探究[参数变易法](@entry_id:756435)的基本原理与精妙机制。

## 原理与机制

在对非齐次[线性常微分方程](@entry_id:276013)求解的探索中，我们已经掌握了[待定系数法](@entry_id:166225)。该方法对于特定形式的[驱动函数](@entry_id:268893)，如多项式、指数函数、正弦和余弦函数及其乘积和，表现得非常高效。然而，当[驱动函数](@entry_id:268893)的形式更为复杂时，待"定"系数就变得无从"定"起。例如，对于形如 $y'' + 4y = \sec(2t)$ [@problem_id:2177606] 的方程，或是 $y'' + y = \frac{1}{1+e^x}$ [@problem_id:2207287] 的方程，[驱动函数](@entry_id:268893) $\sec(2t)$ 和 $\frac{1}{1+e^x}$ 并不属于[待定系数法](@entry_id:166225)所能处理的函数类别。其根本原因在于，这些函数以及它们的所有阶导数所张成的[线性空间](@entry_id:151108)是无限维的，因此它们不能作为任何[常系数](@entry_id:269842)齐次[线性微分方程](@entry_id:150365)的解。这就意味着，我们无法找到一个[常系数](@entry_id:269842)微分算子（即所谓的“湮灭算子”）来“湮灭”这些[驱动函数](@entry_id:268893)。

为了克服这一局限，我们需要一个更具普适性的方法。这个方法就是**[参数变易法](@entry_id:756435) (method of variation of parameters)**。它的核心思想极具创造性：既然我们知道对应的[齐次方程](@entry_id:163650)的通解，何不在此基础上进行“改造”，使其满足非齐次方程呢？

### 二阶方程的[参数变易法](@entry_id:756435)

我们从一个标准的二阶线性非[齐次微分方程](@entry_id:166017)入手：
$$
y''(x) + p(x)y'(x) + q(x)y(x) = g(x)
$$
假设我们已经求得其对应的[齐次方程](@entry_id:163650) $y'' + p(x)y'(x) + q(x)y(x) = 0$ 的一个[基本解组](@entry_id:177810) $\{y_1(x), y_2(x)\}$。那么，[齐次方程](@entry_id:163650)的通解为 $y_h(x) = c_1 y_1(x) + c_2 y_2(x)$，其中 $c_1$ 和 $c_2$ 是任意常数。

[参数变易法](@entry_id:756435)的精髓在于，我们猜想非[齐次方程](@entry_id:163650)的一个[特解](@entry_id:149080) $y_p(x)$ 具有与 $y_h(x)$ 相似的形式，但将“常数”$c_1, c_2$ 替换为待求的“变量”——函数 $u_1(x)$ 和 $u_2(x)$。这就是“参数变易”一词的由来。我们令：
$$
y_p(x) = u_1(x)y_1(x) + u_2(x)y_2(x)
$$
我们的目标是确定 $u_1(x)$ 和 $u_2(x)$。为此，我们需要将 $y_p(x)$ 代入原非齐次方程。首先求其一阶导数：
$$
y_p'(x) = [u_1'(x)y_1(x) + u_2'(x)y_2(x)] + [u_1(x)y_1'(x) + u_2(x)y_2'(x)]
$$
这个表达式看起来有些复杂。如果我们继续求[二阶导数](@entry_id:144508)，将会出现 $u_1''$ 和 $u_2''$，这会使问题变得更加棘手。为了简化计算，我们在此引入一个关键的**简化假设**。我们有两个未知函数 $u_1$ 和 $u_2$ 需要求解，但目前只有一个方程（即原[微分方程](@entry_id:264184)）的约束。这给了我们引入一个额外约束条件的自由。我们明智地选择这个条件来消除上式中包含 $u_1', u_2'$ 的项，即令：
$$
u_1'(x)y_1(x) + u_2'(x)y_2(x) = 0
$$
这个假设极大地简化了 $y_p'$ 的表达式：
$$
y_p'(x) = u_1(x)y_1'(x) + u_2(x)y_2'(x)
$$
现在，我们继续求[二阶导数](@entry_id:144508)：
$$
y_p''(x) = [u_1'(x)y_1'(x) + u_2'(x)y_2'(x)] + [u_1(x)y_1''(x) + u_2(x)y_2''(x)]
$$
接下来，我们将 $y_p, y_p', y_p''$ 的表达式代入原非[齐次方程](@entry_id:163650)：
$$
[u_1'y_1' + u_2'y_2'] + [u_1y_1'' + u_2y_2''] + p(x)[u_1y_1' + u_2y_2'] + q(x)[u_1y_1 + u_2y_2] = g(x)
$$
重新整理各项，将含有 $u_1$ 和 $u_2$ 的项归并在一起：
$$
u_1(x)[y_1''(x) + p(x)y_1'(x) + q(x)y_1(x)] + u_2(x)[y_2''(x) + p(x)y_2'(x) + q(x)y_2(x)] + [u_1'(x)y_1'(x) + u_2'(x)y_2'(x)] = g(x)
$$
由于 $y_1$ 和 $y_2$ 是[齐次方程](@entry_id:163650)的解，因此两个方括号内的表达式均为零。这样，方程就奇迹般地简化为：
$$
u_1'(x)y_1'(x) + u_2'(x)y_2'(x) = g(x)
$$
现在，我们得到了一个关于未知函数导数 $u_1'(x)$ 和 $u_2'(x)$ 的线性方程组：
$$
\begin{cases}
y_1(x)u_1'(x) + y_2(x)u_2'(x)  = 0 \\
y_1'(x)u_1'(x) + y_2'(x)u_2'(x)  = g(x)
\end{cases}
$$
该[方程组](@entry_id:193238)的系数[行列式](@entry_id:142978)正是 $y_1$ 和 $y_2$ 的**[朗斯基行列式](@entry_id:149814) (Wronskian)**，记为 $W(y_1, y_2)(x)$ 或简称 $W(x)$：
$$
W(x) = \begin{vmatrix} y_1(x)  y_2(x) \\ y_1'(x)  y_2'(x) \end{vmatrix} = y_1(x)y_2'(x) - y_2(x)y_1'(x)
$$
因为 $\{y_1, y_2\}$ 是一个[基本解组](@entry_id:177810)，它们[线性无关](@entry_id:148207)，所以 $W(x)$ 恒不为零。利用[克莱姆法则](@entry_id:151802) (Cramer's rule)，我们可以轻松解出 $u_1'(x)$ 和 $u_2'(x)$：
$$
u_1'(x) = \frac{\begin{vmatrix} 0  y_2(x) \\ g(x)  y_2'(x) \end{vmatrix}}{W(x)} = -\frac{y_2(x)g(x)}{W(x)}
$$
$$
u_2'(x) = \frac{\begin{vmatrix} y_1(x)  0 \\ y_1'(x)  g(x) \end{vmatrix}}{W(x)} = \frac{y_1(x)g(x)}{W(x)}
$$
对上述两式积分，即可得到 $u_1(x)$ 和 $u_2(x)$（在求[特解](@entry_id:149080)时，可忽略积分常数）：
$$
u_1(x) = -\int \frac{y_2(x)g(x)}{W(x)} dx, \quad u_2(x) = \int \frac{y_1(x)g(x)}{W(x)} dx
$$
最后，将 $u_1(x)$ 和 $u_2(x)$ 代回 $y_p(x) = u_1(x)y_1(x) + u_2(x)y_2(x)$，便得到了非[齐次方程](@entry_id:163650)的一个[特解](@entry_id:149080)。

这个推导过程也揭示了各部分之间的内在联系。例如，如果我们已知齐次解 $y_1(t)=\cos(t)$ 和 $y_2(t)=\sin(t)$，并且通过某种方式记录了参数的导数为 $u_1'(t) = -\sin^2(t)$，我们就能反向推导出原始的[驱动函数](@entry_id:268893) $g(t)$。首先计算[朗斯基行列式](@entry_id:149814) $W(t) = \cos(t)\cos(t) - (-\sin(t))\sin(t) = 1$。根据公式 $u_1'(t) = -y_2(t)g(t)/W(t)$，我们有 $-\sin^2(t) = -\sin(t)g(t)/1$，从而轻易解得 $g(t)=\sin(t)$ [@problem_id:2177588]。

#### 案例分析

让我们通过一个具体的例子来应用[参数变易法](@entry_id:756435)。考虑方程 [@problem_id:21174]：
$$
y''(t) - 3y'(t) + 2y(t) = \frac{e^{3t}}{1+e^t}
$$
1.  **[求解齐次方程](@entry_id:184715)**：对应的齐次方程为 $y''-3y'+2y=0$。其特征方程为 $r^2-3r+2=(r-1)(r-2)=0$，解得 $r_1=1, r_2=2$。因此，[基本解组](@entry_id:177810)为 $y_1(t)=e^t, y_2(t)=e^{2t}$。

2.  **计算[朗斯基行列式](@entry_id:149814)**：
    $$
    W(t) = \begin{vmatrix} e^t  e^{2t} \\ e^t  2e^{2t} \end{vmatrix} = e^t(2e^{2t}) - e^{2t}(e^t) = e^{3t}
    $$

3.  **求解 $u_1'(t)$ 和 $u_2'(t)$**：[驱动函数](@entry_id:268893)为 $g(t) = \frac{e^{3t}}{1+e^t}$。
    $$
    u_1'(t) = -\frac{y_2(t)g(t)}{W(t)} = -\frac{e^{2t} \cdot \frac{e^{3t}}{1+e^t}}{e^{3t}} = -\frac{e^{2t}}{1+e^t}
    $$
    $$
    u_2'(t) = \frac{y_1(t)g(t)}{W(t)} = \frac{e^t \cdot \frac{e^{3t}}{1+e^t}}{e^{3t}} = \frac{e^t}{1+e^t}
    $$

4.  **积分求 $u_1(t)$ 和 $u_2(t)$**：
    对于 $u_1'(t)$，我们可以做一个代换 $u=e^t$，或者使用技巧 $e^{2t} = e^t(1+e^t) - e^t$：
    $$
    u_1(t) = -\int \frac{e^{2t}}{1+e^t} dt = -\int \frac{e^t(e^t+1)-e^t}{1+e^t} dt = -\int \left(e^t - \frac{e^t}{1+e^t}\right) dt = -e^t + \ln(1+e^t)
    $$
    对于 $u_2'(t)$ 的积分则很简单：
    $$
    u_2(t) = \int \frac{e^t}{1+e^t} dt = \ln(1+e^t)
    $$

5.  **构建特解**：
    $$
    y_p(t) = u_1(t)y_1(t) + u_2(t)y_2(t) = [-e^t + \ln(1+e^t)]e^t + [\ln(1+e^t)]e^{2t}
    $$
    $$
    y_p(t) = -e^{2t} + e^t\ln(1+e^t) + e^{2t}\ln(1+e^t) = -e^{2t} + (e^t+e^{2t})\ln(1+e^t)
    $$
    这便是该非齐次方程的一个[特解](@entry_id:149080)。

另一个典型例子是求解一个由外力驱动的无[阻尼振子](@entry_id:173004)模型 [@problem_id:2177606]：$y''(t) + 4y(t) = F_0 \sec(2t)$。[齐次解](@entry_id:274365)为 $y_1(t) = \cos(2t)$ 和 $y_2(t) = \sin(2t)$。[朗斯基行列式](@entry_id:149814) $W(t)=2$。应用[参数变易法](@entry_id:756435)公式可得 $u_1'(t) = -\frac{F_0}{2}\tan(2t)$ 和 $u_2'(t) = \frac{F_0}{2}$。积分后得到 $u_1(t) = \frac{F_0}{4}\ln|\cos(2t)|$ 和 $u_2(t) = \frac{F_0}{2}t$。因此，[特解](@entry_id:149080)为 $y_p(t) = \frac{F_0}{4}\cos(2t)\ln|\cos(2t)| + \frac{F_0}{2}t\sin(2t)$。此解中出现的 $t\sin(2t)$ 项预示了共振现象的发生，而对数项则反映了驱动力 $\sec(2t)$ 的复杂特性。

### 更深层的理解：[算子分解](@entry_id:154443)法

[参数变易法](@entry_id:756435)公式看起来像是“从天而降”的巧妙构造。然而，对于[常系数微分方程](@entry_id:172755)，我们可以从一个更根本的视角——微分算子分解——来理解其必然性。考虑一个二阶[常系数](@entry_id:269842)方程 [@problem_id:2209023]：
$$
y'' - (r_1 + r_2)y' + r_1 r_2 y = g(t)
$$
其中 $r_1 \neq r_2$。利用微分算子 $D = d/dt$，该方程可以写作：
$$
(D - r_1)(D - r_2)y = g(t)
$$
我们可以通过“逐次积分”来求解。令 $u(t) = (D - r_2)y = y' - r_2 y$。原方程变为一个关于 $u(t)$ 的一阶线性方程：
$$
(D - r_1)u = g(t) \quad \implies \quad u' - r_1 u = g(t)
$$
利用[积分因子](@entry_id:177812) $e^{-r_1 t}$，我们可以解得 $u(t)$。若考虑满足 $y_p(t_0)=y_p'(t_0)=0$ 的[特解](@entry_id:149080)，则 $u(t_0)=0$，解为：
$$
u(t) = e^{r_1 t} \int_{t_0}^{t} e^{-r_1 s} g(s) ds
$$
接下来，我们求解第二个一阶方程 $(D - r_2)y = u(t)$，即 $y' - r_2 y = u(t)$。同样使用[积分因子](@entry_id:177812) $e^{-r_2 t}$ 和[初始条件](@entry_id:152863) $y_p(t_0)=0$，解得：
$$
y_p(t) = e^{r_2 t} \int_{t_0}^{t} e^{-r_2 s} u(s) ds = e^{r_2 t} \int_{t_0}^{t} e^{-r_2 s} \left( e^{r_1 s} \int_{t_0}^{s} e^{-r_1 \tau} g(\tau) d\tau \right) ds
$$
这个[二重积分](@entry_id:198869)表达式看起来相当复杂。但通过[交换积分次序](@entry_id:200463)，我们可以揭示其与[参数变易法](@entry_id:756435)的联系。积分区域为 $t_0 \le \tau \le s \le t$。交换次序后得到：
$$
y_p(t) = e^{r_2 t} \int_{t_0}^{t} e^{-r_1 \tau} g(\tau) \left( \int_{\tau}^{t} e^{(r_1 - r_2)s} ds \right) d\tau
$$
计算内层关于 $s$ 的积分：
$$
\int_{\tau}^{t} e^{(r_1 - r_2)s} ds = \frac{e^{(r_1 - r_2)t} - e^{(r_1 - r_2)\tau}}{r_1 - r_2}
$$
代回 $y_p(t)$ 并整理：
$$
y_p(t) = \frac{1}{r_1 - r_2} \left[ e^{r_1 t} \int_{t_0}^{t} e^{-r_1 \tau} g(\tau) d\tau - e^{r_2 t} \int_{t_0}^{t} e^{-r_2 \tau} g(\tau) d\tau \right]
$$
令 $y_1(t) = e^{r_1 t}$ 和 $y_2(t) = e^{r_2 t}$。[朗斯基行列式](@entry_id:149814)为 $W = e^{r_1 t} (r_2 e^{r_2 t}) - e^{r_2 t} (r_1 e^{r_1 t}) = (r_2 - r_1)e^{(r_1+r_2)t}$。注意这里的推导中我们使用的是 $y_1, y_2$ 而不是它们的具体表达式，因此最终结果中的分母是 $r_1 - r_2$。将表达式改写，并用 $s$ 替换积分变量 $\tau$：
$$
y_p(t) = e^{r_1 t} \int_{t_0}^{t} \frac{e^{-r_1 s} g(s)}{r_1 - r_2} ds + e^{r_2 t} \int_{t_0}^{t} \frac{e^{-r_2 s} g(s)}{r_2 - r_1} ds
$$
这正是[参数变易法](@entry_id:756435)给出的[特解](@entry_id:149080)形式 $y_p(t) = y_1(t)\int u_1'(t)dt + y_2(t)\int u_2'(t)dt$。比较可知：
$$
u_2'(s) = \frac{e^{-r_2 s} g(s)}{r_2 - r_1} = \frac{y_1(s)g(s)}{W(s)}
$$
这里 $W(s) = (r_2-r_1)e^{(r_1+r_2)s}$，而 $y_1(s)=e^{r_1 s}$。所以 $y_1(s)/W(s) = e^{r_1 s}/((r_2-r_1)e^{(r_1+r_2)s}) = e^{-r_2 s}/(r_2-r_1)$。这与我们推导出的表达式完全吻合。这证明了两种方法是等价的，[参数变易法](@entry_id:756435)并非凭空构造，而是深植于微分算子的[代数结构](@entry_id:137052)之中。

### 向高阶和系统推广

[参数变易法](@entry_id:756435)的强大之处在于其系统性，可以直接推广到任意 $n$ 阶[线性微分方程](@entry_id:150365)和[线性方程组](@entry_id:148943)。

#### $n$ 阶[线性微分方程](@entry_id:150365)

考虑一个 $n$ 阶线性非齐次方程 [@problem_id:2212677]：
$$
y^{(n)} + p_{n-1}(x) y^{(n-1)} + \dots + p_1(x) y' + p_0(x) y = g(x)
$$
设其[齐次解](@entry_id:274365)的[基本解组](@entry_id:177810)为 $\{y_1(x), \dots, y_n(x)\}$。我们构造特解：
$$
y_p(x) = \sum_{i=1}^{n} u_i(x) y_i(x)
$$
与二阶情况类似，我们在求导过程中引入 $n-1$ 个简化假设：
$$
\sum_{i=1}^{n} u_i'(x) y_i^{(k)}(x) = 0, \quad \text{for } k = 0, 1, \dots, n-2
$$
这些假设使得 $y_p$ 的直到 $n-1$ 阶的导数都具有简单的形式 $y_p^{(k)}(x) = \sum_{i=1}^{n} u_i(x) y_i^{(k)}(x)$。对 $y_p^{(n-1)}$ 再求一次导，并将所有导数代入原方程，利用 $y_i$ 是[齐次解](@entry_id:274365)的性质，最终会得到第 $n$ 个方程：
$$
\sum_{i=1}^{n} u_i'(x) y_i^{(n-1)}(x) = g(x)
$$
这样，我们得到了一个关于 $u_1', \dots, u_n'$ 的 $n \times n$ [线性方程组](@entry_id:148943)：
$$
\mathbf{W}(x) \begin{pmatrix} u_1'(x) \\ \vdots \\ u_n'(x) \end{pmatrix} = \begin{pmatrix} 0 \\ \vdots \\ 0 \\ g(x) \end{pmatrix}
$$
其中 $\mathbf{W}(x)$ 是由[基本解组](@entry_id:177810)及其导数构成的**朗斯基矩阵**，其第 $i$ 行第 $j$ 列的元素为 $y_j^{(i-1)}(x)$。其[行列式](@entry_id:142978) $W(x) = \det(\mathbf{W}(x))$ 正是 $n$ 阶的[朗斯基行列式](@entry_id:149814)。

根据[克莱姆法则](@entry_id:151802)，该[方程组](@entry_id:193238)的解为：
$$
u_k'(x) = \frac{\det(\mathbf{W}_k^g(x))}{W(x)}
$$
其中 $\mathbf{W}_k^g(x)$ 是将 $\mathbf{W}(x)$ 的第 $k$ 列替换为列向量 $[0, \dots, 0, g(x)]^T$ 后得到的矩阵。由于[行列式](@entry_id:142978)对列是线性的，我们可以将 $g(x)$ 因子提出，得到通用公式：
$$
u_k'(x) = \frac{g(x) W_k(x)}{W(x)}
$$
其中 $W_k(x)$ 是将朗斯基矩阵 $\mathbf{W}(x)$ 的第 $k$ 列替换为 $[0, \dots, 0, 1]^T$ 后得到的[矩阵的行列式](@entry_id:148198)。

例如，对于三阶方程 $y''' - y' = x$ [@problem_id:2212680]，其齐次解为 $y_1=1, y_2=e^x, y_3=e^{-x}$。我们可以建立关于 $u_1', u_2', u_3'$ 的[方程组](@entry_id:193238)：
$$
\begin{cases}
1 \cdot u_1' + e^x u_2' + e^{-x} u_3'  = 0 \\
0 \cdot u_1' + e^x u_2' - e^{-x} u_3'  = 0 \\
0 \cdot u_1' + e^x u_2' + e^{-x} u_3'  = x
\end{cases}
$$
解这个简单的代数方程组得到 $u_1' = -x$, $u_2' = \frac{x}{2}e^{-x}$, $u_3' = \frac{x}{2}e^{x}$。积分后得到 $u_1 = -x^2/2$, $u_2 = -\frac{1}{2}(x+1)e^{-x}$, $u_3 = \frac{1}{2}(x-1)e^{x}$。最终的[特解](@entry_id:149080)为 $y_p = u_1 y_1 + u_2 y_2 + u_3 y_3 = -\frac{1}{2}x^2 - 1$。

#### 线性方程组

[参数变易法](@entry_id:756435)同样优雅地适用于一阶[线性方程组](@entry_id:148943) $\mathbf{x}'(t) = A\mathbf{x}(t) + \mathbf{f}(t)$。
假设 $\Phi(t)$ 是对应[齐次系统](@entry_id:150411) $\mathbf{x}' = A\mathbf{x}$ 的一个**[基本矩阵](@entry_id:275638)**（其列向量是[齐次系统](@entry_id:150411)的一组线性无关的解）。齐次通解为 $\mathbf{x}_h(t) = \Phi(t)\mathbf{c}$，其中 $\mathbf{c}$ 是一个常数向量。

我们同样变易“参数” $\mathbf{c}$ 为一个向量函数 $\mathbf{u}(t)$，构造[特解](@entry_id:149080)：
$$
\mathbf{x}_p(t) = \Phi(t)\mathbf{u}(t)
$$
对其求导：
$$
\mathbf{x}_p'(t) = \Phi'(t)\mathbf{u}(t) + \Phi(t)\mathbf{u}'(t)
$$
由于 $\Phi(t)$ 是[基本矩阵](@entry_id:275638)，它满足 $\Phi'(t) = A\Phi(t)$。代入上式：
$$
\mathbf{x}_p'(t) = A\Phi(t)\mathbf{u}(t) + \Phi(t)\mathbf{u}'(t) = A\mathbf{x}_p(t) + \Phi(t)\mathbf{u}'(t)
$$
将此表达式与原非[齐次方程](@entry_id:163650) $\mathbf{x}_p' = A\mathbf{x}_p + \mathbf{f}(t)$ 对比，我们立即得到一个非常简洁的条件：
$$
\Phi(t)\mathbf{u}'(t) = \mathbf{f}(t)
$$
由于 $\Phi(t)$ 是[基本矩阵](@entry_id:275638)，它在任何点都是可逆的。因此，我们可以解出 $\mathbf{u}'(t)$：
$$
\mathbf{u}'(t) = \Phi(t)^{-1}\mathbf{f}(t)
$$
积分即可得到 $\mathbf{u}(t) = \int \Phi(t)^{-1}\mathbf{f}(t) dt$。最终的特解为：
$$
\mathbf{x}_p(t) = \Phi(t) \int \Phi(t)^{-1}\mathbf{f}(t) dt
$$
考虑系统 [@problem_id:2175621]，给定[基本矩阵](@entry_id:275638) $\Phi(t) = e^t \begin{pmatrix} \cos(t)  -\sin(t) \\ \sin(t)  \cos(t) \end{pmatrix}$ 和非齐次项 $F(t) = e^t \begin{pmatrix} \tan(t) \\ 1 \end{pmatrix}$。我们首先求 $\Phi(t)^{-1}$。注意到 $\Phi(t)$ 是 $e^t$ 与一个标准[旋转矩阵](@entry_id:140302)的乘积，其[逆矩阵](@entry_id:140380)为 $\Phi(t)^{-1} = e^{-t} \begin{pmatrix} \cos(t)  \sin(t) \\ -\sin(t)  \cos(t) \end{pmatrix}$。
根据公式，我们计算 $V'(t) = \mathbf{u}'(t)$：
$$
V'(t) = \Phi(t)^{-1}F(t) = e^{-t}\begin{pmatrix}\cos(t)  \sin(t)\\ -\sin(t)  \cos(t)\end{pmatrix} e^t\begin{pmatrix}\tan(t)\\ 1\end{pmatrix} = \begin{pmatrix}\cos(t)\tan(t)+\sin(t)\\ -\sin(t)\tan(t)+\cos(t)\end{pmatrix} = \begin{pmatrix}2\sin(t)\\ \frac{\cos(2t)}{\cos(t)}\end{pmatrix}
$$
只需再对这个向量函数积分，就能得到参数 $\mathbf{u}(t)$，从而写出系统的特解。

### 高级话题：与格林函数的关系

[参数变易法](@entry_id:756435)与物理和工程中一个极为强大的工具——**[格林函数](@entry_id:147802) (Green's function)**——有着深刻的联系。[格林函数](@entry_id:147802)描述了系统对一个瞬时脉冲输入的响应。

考虑一个初始状态为静止的系统，在 $t_0$ 时刻受到一个[单位脉冲](@entry_id:272155)冲击，其方程为 [@problem_id:2209012]：
$$
y'' + py' + qy = \delta(t-t_0)
$$
其中 $\delta(t-t_0)$ 是狄拉克 $\delta$ 函数。我们可以形式上将 $g(t) = \delta(t-t_0)$ 代入[参数变易法](@entry_id:756435)的积分公式中。设 $y_1(t), y_2(t)$ 是齐次解，则对 $t > t_0$ 的响应为：
$$
y(t) = y_1(t) \int_0^t -\frac{y_2(s)\delta(s-t_0)}{W(s)} ds + y_2(t) \int_0^t \frac{y_1(s)\delta(s-t_0)}{W(s)} ds
$$
利用 $\delta$ 函数的[筛选性质](@entry_id:265662) $\int f(s)\delta(s-t_0)ds = f(t_0)$，积分立刻得出结果：
$$
y(t) = -y_1(t)\frac{y_2(t_0)}{W(t_0)} + y_2(t)\frac{y_1(t_0)}{W(t_0)}
$$
整理后得到一个非常优美的形式：
$$
y(t) \equiv G(t, t_0) = \frac{y_1(t_0)y_2(t) - y_2(t_0)y_1(t)}{W(t_0)}
$$
这个函数 $G(t, t_0)$ 就是该系统的**脉冲响应**或**因果[格林函数](@entry_id:147802)**。它给出了在 $t_0$ 时刻施加[单位脉冲](@entry_id:272155)后，系统在 $t$ 时刻的响应。物理上，通过对[微分方程](@entry_id:264184)在 $t_0$ 附近积分，可以证明 $\delta$ 函数的效应是在 $t_0$ 时刻使系统的速度 $y'$ 产生一个大小为 1 的跳变，而位移 $y$ 保持连续。上述解正是满足[初始条件](@entry_id:152863) $y(t_0)=0, y'(t_0)=1$ 的齐次方程的解，这与脉冲的物理效应完全一致。

格林函数的强大之处在于，一旦求出，任何连续[驱动函数](@entry_id:268893) $g(t)$ 所引起的响应都可以通过一个[卷积积分](@entry_id:155865)得到：
$$
y_p(t) = \int_{t_0}^t G(t, s) g(s) ds
$$
这体现了[线性系统](@entry_id:147850)的[叠加原理](@entry_id:144649)：任意的驱动力可以看作是无穷多个连续脉冲的叠加，而总响应就是对所有这些脉冲响应的叠加（积分）。[参数变易法](@entry_id:756435)为我们提供了一条构造格林函数的系统性途径，从而揭示了[求解线性微分方程](@entry_id:190661)的深刻结构。