{"hands_on_practices": [{"introduction": "这个练习通过一个药代动力学中相关的场景，对该主题进行了温和的介绍。我们将对输液速率突然改变时药物在血液中的浓度进行建模 [@problem_id:2200526]。这个问题将巩固你对如何分段求解一阶常微分方程的理解，并确保解在变化点上是连续的。", "problem": "一位患者正在接受一种通过静脉(IV)滴注给药的新药物治疗。药物在患者血液中的浓度 $C(t)$（单位为毫克/升, mg/L）可以用以下一阶线性微分方程来建模：\n$$ \\frac{dC}{dt} + kC = f(t). $$\n其中，$t$ 是自输注开始以来的时间（单位为小时），$k$ 是药物从体内消除的恒定速率（单位为 hr$^{-1}$），$f(t)$ 代表因输注而导致药物浓度增加的有效速率。最初，患者体内没有该药物。\n\n输注在第一个小时内以 $r_0$（单位为 mg/L/hr）的恒定有效速率进行。第一个小时后，为了增强治疗效果，输注速率立即加倍。因此，有效速率函数 $f(t)$ 是一个分段函数，定义如下：\n$$ f(t) = \\begin{cases} r_0,  \\text{当 } 0 \\le t \\le 1 \\\\ 2r_0,  \\text{当 } t > 1 \\end{cases} $$\n假设药物浓度 $C(t)$ 是时间的连续函数，请确定对于所有 $t \\ge 0$，$C(t)$ 关于 $r_0$ 和 $k$ 的解析表达式。", "solution": "我们已知一阶线性常微分方程\n$$\n\\frac{dC}{dt} + k C = f(t),\n$$\n初始条件为 $C(0)=0$，其中\n$$\nf(t) = \\begin{cases}\nr_0,  \\text{当 } 0 \\le t \\le 1, \\\\\n2 r_0,  \\text{当 } t > 1.\n\\end{cases}\n$$\n我们使用积分因子法在每个区间上求解。积分因子为 $\\mu(t)=\\exp\\!\\left(\\int k\\,dt\\right)=\\exp(k t)$，这得到\n$$\n\\frac{d}{dt}\\big(C(t)\\exp(k t)\\big)=f(t)\\exp(k t).\n$$\n\n对于 $0 \\le t \\le 1$，我们有 $f(t)=r_0$。从 $0$ 到 $t$ 积分并使用 $C(0)=0$ 可得\n$$\nC(t)\\exp(k t)-C(0)=r_0\\int_{0}^{t}\\exp(k s)\\,ds=\\frac{r_0}{k}\\big(\\exp(k t)-1\\big),\n$$\n所以\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-k t)\\big), \\quad 0 \\le t \\le 1.\n$$\n\n对于 $t>1$，我们有 $f(t)=2 r_0$。为了保证在 $t=1$ 处的连续性，我们从 $1$ 到 $t$ 积分：\n$$\nC(t)\\exp(k t)-C(1)\\exp(k\\cdot 1)=2 r_0\\int_{1}^{t}\\exp(k s)\\,ds=\\frac{2 r_0}{k}\\big(\\exp(k t)-\\exp(k)\\big).\n$$\n解出 $C(t)$ 可得\n$$\nC(t)=C(1)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t>1.\n$$\n使用第一个区间得到的值，\n$$\nC(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big),\n$$\n我们得到\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t>1.\n$$\n此表达式在 $t=1$ 处是连续的，因为代入 $t=1$ 会从两边都得到 $C(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)$。\n\n因此，对于所有 $t \\ge 0$ 的分段解如上所推导。", "answer": "$$\\boxed{C(t)=\\begin{cases}\\frac{r_0}{k}\\left(1-\\exp(-k t)\\right),  \\text{当 } 0\\le t\\le 1 \\\\ \\frac{r_0}{k}\\left(1-\\exp(-k)\\right)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\left(1-\\exp(-k(t-1))\\right),  \\text{当 } t>1\\end{cases}}$$", "id": "2200526"}, {"introduction": "在第一个练习的基础上，这个问题探讨了电气工程中一个涉及RC电路的常见场景 [@problem_id:2200506]。这里的驱动函数是一个三角电压脉冲，定义为两个线性函数的最小值，这要求你首先确定函数定义发生改变的点。这个练习将增强你解释和处理更复杂的分段定义输入的能力。", "problem": "考虑一个由电阻 $R = 100.0 \\, \\Omega$ 和电容 $C = 10.0 \\, \\text{mF}$ 组成的简单串联电路。该电路由一个时变电压源 $V(t)$ 驱动。电容器上的电荷 $Q(t)$ 由以下一阶线性常微分方程决定：\n$$R\\frac{dQ}{dt} + \\frac{1}{C}Q = V(t)$$\n对于时间 $t \\ge 0$，电压源由函数 $V(t) = \\min(4t, 12-2t)$ 定义，其中 $V$ 的单位是伏特， $t$ 的单位是秒。电容器初始未充电，即 $Q(0) = 0$。\n\n计算在时间 $t = 3.0$ 秒时电容器上的电荷。答案以库仑（C）为单位，并四舍五入到四位有效数字。", "solution": "控制方程是一个一阶线性常微分方程：\n$$R \\frac{dQ}{dt} + \\frac{1}{C} Q = V(t).$$\n已知 $R = 100.0\\,\\Omega$ 且 $C = 10.0\\,\\text{mF} = 10.0 \\times 10^{-3}\\,\\text{F}$，我们得到 $RC = 1$。将常微分方程两边同除以 $R$ 可得\n$$\\frac{dQ}{dt} + \\frac{1}{RC} Q = \\frac{V(t)}{R},$$\n简化为\n$$\\frac{dQ}{dt} + Q = \\frac{V(t)}{R}.$$\n对于 $t \\ge 0$，$V(t) = \\min(4t,\\,12 - 2t)$。切换点发生在 $4t = 12 - 2t$，即 $t = 2$。因此，\n- 对于 $0 \\le t \\le 2$：$V(t) = 4t$，所以 $\\frac{V(t)}{R} = \\frac{4t}{100} = 0.04\\,t$。\n- 对于 $t \\ge 2$：$V(t) = 12 - 2t$，所以 $\\frac{V(t)}{R} = \\frac{12 - 2t}{100} = 0.12 - 0.02\\,t$。\n\n在 $[0,2]$ 上求解，初始条件为 $Q(0) = 0$。使用积分因子 $\\mu(t) = \\exp\\!\\left(\\int 1\\,dt\\right) = \\exp(t)$，\n$$(Q \\exp(t))' = 0.04\\,t\\,\\exp(t).$$\n从 $0$ 到 $t \\in [0,2]$ 积分，并使用 $Q(0) = 0$，\n$$Q(t) \\exp(t) = \\int_{0}^{t} 0.04\\,s\\,\\exp(s)\\,ds.$$\n使用 $\\int s \\exp(s)\\,ds = (s - 1)\\exp(s)$，我们得到\n$$Q(t) \\exp(t) = 0.04\\left[(t - 1)\\exp(t) + 1\\right],$$\n所以\n$$Q(t) = 0.04\\left[(t - 1) + \\exp(-t)\\right], \\quad 0 \\le t \\le 2.$$\n因此，\n$$Q(2) = 0.04\\left[1 + \\exp(-2)\\right].$$\n\n在 $[2,3]$ 上，求解 $\\frac{dQ}{dt} + Q = 0.12 - 0.02\\,t$，初始条件为上面得到的 $Q(2)$。使用相同的积分因子，\n$$(Q \\exp(t))' = \\left(0.12 - 0.02\\,t\\right)\\exp(t).$$\n从 $2$ 到 $t \\in [2,3]$ 积分：\n$$Q(t) \\exp(t) - Q(2)\\exp(2) = \\int_{2}^{t} \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds.$$\n计算积分：\n$$\\int \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds = \\exp(s)\\left(0.14 - 0.02\\,s\\right),$$\n因此\n$$\\int_{2}^{t} \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds = \\exp(t)\\left(0.14 - 0.02\\,t\\right) - \\exp(2)\\left(0.10\\right).$$\n所以，\n$$Q(t) = \\exp(-t)\\left[Q(2)\\exp(2) - 0.10\\,\\exp(2)\\right] + \\left(0.14 - 0.02\\,t\\right).$$\n代入 $Q(2) = 0.04\\left[1 + \\exp(-2)\\right]$：\n$$Q(t) = \\exp(2 - t)\\left[-0.06 + 0.04\\,\\exp(-2)\\right] + \\left(0.14 - 0.02\\,t\\right).$$\n当 $t = 3$ 时，\n$$Q(3) = 0.08 - 0.06\\,\\exp(-1) + 0.04\\,\\exp(-3).$$\n数值计算得，\n$$Q(3) \\approx 0.08 - 0.06 \\times 0.3678794412 + 0.04 \\times 0.04978706837 \\approx 0.05991871626.$$\n四舍五入到四位有效数字，电荷为 $0.05992$ 库仑。", "answer": "$$\\boxed{0.05992}$$", "id": "2200506"}, {"introduction": "我们的最后一个练习将挑战升级到一个二阶系统，模拟一个机械臂的运动 [@problem_id:2200500]。这里的驱动函数是一个二次样条函数，其设计旨在保证平滑以防止急动——这是工程学中的一个关键概念。这个问题展示了如何处理高阶方程，并介绍了用于寻找特解的强大卷积方法。", "problem": "一个机器人手臂执行器角位置的简化模型由一个二阶线性常微分方程描述。该手臂最初静止于其平衡位置，因此其初始角度和角速度均为零。执行器施加一个时变转矩，该转矩作为系统运动的强迫函数。该转矩曲线被设计为平滑的，实现为一个二次样条函数 $g(t)$，该函数是连续的且具有连续的一阶导数。\n\n手臂角度 $y(t)$（单位为弧度）的运动方程由以下初值问题给出：\n$$y'' + 4y = g(t), \\quad y(0) = 0, \\quad y'(0) = 0$$\n其中 $t$ 是时间，单位为秒。强迫函数 $g(t)$ 分段定义如下：\n$$ g(t) = \\begin{cases} t^2,  \\text{当 } 0 \\le t \\le \\pi \\\\ -t^2 + 4\\pi t - 2\\pi^2,  \\text{当 } t > \\pi \\end{cases} $$\n计算在时间 $t = 2\\pi$ 时手臂的角度。请用含 $\\pi$ 的符号表达式表示您的最终答案。", "solution": "我们通过与冲激响应进行卷积来求解具有零初始条件的线性时不变二阶常微分方程。对于 $y''+4y=g(t)$ 且 $y(0)=0$，$y'(0)=0$，解为\n$$\ny(t)=\\int_{0}^{t} \\frac{\\sin\\!\\left(2(t-\\tau)\\right)}{2}\\,g(\\tau)\\,d\\tau.\n$$\n在 $t=2\\pi$ 时，这变为\n$$\ny(2\\pi)=\\frac{1}{2}\\int_{0}^{2\\pi}\\sin\\!\\left(2(2\\pi-\\tau)\\right)g(\\tau)\\,d\\tau.\n$$\n使用 $\\sin(4\\pi-2\\tau)=-\\sin(2\\tau)$，我们得到\n$$\ny(2\\pi)=-\\frac{1}{2}\\int_{0}^{2\\pi}g(\\tau)\\sin(2\\tau)\\,d\\tau.\n$$\n对于分段函数 $g$，我们将积分拆分：\n$$\ny(2\\pi)=-\\frac{1}{2}\\left[\\int_{0}^{\\pi}\\tau^{2}\\sin(2\\tau)\\,d\\tau+\\int_{\\pi}^{2\\pi}\\left(-\\tau^{2}+4\\pi\\tau-2\\pi^{2}\\right)\\sin(2\\tau)\\,d\\tau\\right].\n$$\n计算所需的积分。首先，通过两次分部积分法推导 $\\int x^{2}\\sin(2x)\\,dx$ 的一个原函数。令 $u=x^{2}$，$dv=\\sin(2x)\\,dx$，则 $du=2x\\,dx$，$v=-\\cos(2x)/2$，所以\n$$\n\\int x^{2}\\sin(2x)\\,dx=-\\frac{1}{2}x^{2}\\cos(2x)+\\frac{2}{2}\\int x\\cos(2x)\\,dx.\n$$\n对于 $K=\\int x\\cos(2x)\\,dx$，令 $u_{1}=x$，$dv_{1}=\\cos(2x)\\,dx$，因此 $du_{1}=dx$，$v_{1}=\\sin(2x)/2$，得到\n$$\nK=\\frac{x\\sin(2x)}{2}+\\frac{\\cos(2x)}{4}.\n$$\n因此，\n$$\n\\int x^{2}\\sin(2x)\\,dx=-\\frac{1}{2}x^{2}\\cos(2x)+\\frac{1}{2}x\\sin(2x)+\\frac{1}{4}\\cos(2x).\n$$\n因此\n$$\nI_{1}:=\\int_{0}^{\\pi}\\tau^{2}\\sin(2\\tau)\\,d\\tau=\\left[-\\frac{1}{2}\\tau^{2}\\cos(2\\tau)+\\frac{1}{2}\\tau\\sin(2\\tau)+\\frac{1}{4}\\cos(2\\tau)\\right]_{0}^{\\pi}=-\\frac{\\pi^{2}}{2}.\n$$\n接下来，\n$$\nI_{2}:=\\int_{\\pi}^{2\\pi}\\left(-\\tau^{2}+4\\pi\\tau-2\\pi^{2}\\right)\\sin(2\\tau)\\,d\\tau=-A+4\\pi B-2\\pi^{2}C,\n$$\n其中\n$$\nA=\\int_{\\pi}^{2\\pi}\\tau^{2}\\sin(2\\tau)\\,d\\tau,\\quad B=\\int_{\\pi}^{2\\pi}\\tau\\sin(2\\tau)\\,d\\tau,\\quad C=\\int_{\\pi}^{2\\pi}\\sin(2\\tau)\\,d\\tau.\n$$\n我们已经有了 $A$ 的原函数：\n$$\nA=\\left[-\\frac{1}{2}\\tau^{2}\\cos(2\\tau)+\\frac{1}{2}\\tau\\sin(2\\tau)+\\frac{1}{4}\\cos(2\\tau)\\right]_{\\pi}^{2\\pi}=-\\frac{3}{2}\\pi^{2}.\n$$\n对于 $B$，进行一次分部积分：\n$$\n\\int \\tau\\sin(2\\tau)\\,d\\tau=-\\frac{1}{2}\\tau\\cos(2\\tau)+\\frac{1}{4}\\sin(2\\tau),\n$$\n所以\n$$\nB=\\left[-\\frac{1}{2}\\tau\\cos(2\\tau)+\\frac{1}{4}\\sin(2\\tau)\\right]_{\\pi}^{2\\pi}=-\\frac{\\pi}{2}.\n$$\n最后，\n$$\nC=\\int_{\\pi}^{2\\pi}\\sin(2\\tau)\\,d\\tau=\\left[-\\frac{\\cos(2\\tau)}{2}\\right]_{\\pi}^{2\\pi}=0.\n$$\n因此\n$$\nI_{2}=-\\left(-\\frac{3}{2}\\pi^{2}\\right)+4\\pi\\left(-\\frac{\\pi}{2}\\right)-2\\pi^{2}\\cdot 0=\\frac{3}{2}\\pi^{2}-2\\pi^{2}=-\\frac{1}{2}\\pi^{2}.\n$$\n合并 $I_{1}$ 和 $I_{2}$：\n$$\nI_{1}+I_{2}=-\\frac{1}{2}\\pi^{2}-\\frac{1}{2}\\pi^{2}=-\\pi^{2}.\n$$\n因此，\n$$\ny(2\\pi)=-\\frac{1}{2}\\left(I_{1}+I_{2}\\right)=\\frac{\\pi^{2}}{2}.\n$$", "answer": "$$\\boxed{\\frac{\\pi^{2}}{2}}$$", "id": "2200500"}]}