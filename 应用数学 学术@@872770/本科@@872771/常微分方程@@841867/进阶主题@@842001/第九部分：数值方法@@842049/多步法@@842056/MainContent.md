## 引言
在[数值分析](@entry_id:142637)领域，[求解常微分方程](@entry_id:635033)（ODEs）是模拟从[行星运动](@entry_id:170895)到[化学反应](@entry_id:146973)等各种动态系统的核心。虽然[单步法](@entry_id:164989)（如[欧拉法](@entry_id:749108)和[龙格-库塔法](@entry_id:140014)）为我们提供了坚实的基础，但当追求更高的计算效率和精度时，它们并非总是最佳选择。由此引出了一个更为强大和广泛的方法类别：[线性多步法](@entry_id:139528)（Linear Multistep Methods, LMMs）。与[单步法](@entry_id:164989)在每一步“重新开始”不同，多步法巧妙地利用过去数步积累的信息来预测未来，从而在许多情况下以更少的计算量达到所需的精度。

本文旨在系统地阐述[线性多步法](@entry_id:139528)的理论、实践与应用。我们将从基础出发，逐步揭示这些方法的设计精髓及其背后的深刻数学原理。
在“原理与机制”一章中，您将学习多步法的通用形式，理解[显式与隐式方法](@entry_id:168763)的核心区别，并探索如何通过数值积分的思想构建出著名的Adams方法族。我们还将深入探讨保证其数值解可靠性的两大支柱：一致性与[零稳定性](@entry_id:178549)。
接下来，在“应用与跨学科联系”一章中，我们将理论付诸实践，展示多步法如何被用来模拟复杂的物理和[生物系统](@entry_id:272986)，如[范德波尔振荡器](@entry_id:264796)和[捕食者-猎物模型](@entry_id:268721)。您将看到隐式方法在应对“刚性”问题时的不可或缺性，以及[自适应步长控制](@entry_id:142684)等高级技巧如何提升计算效率。
最后，“动手实践”部分将提供一系列练习，让您有机会亲自应用这些概念，从检验方法的稳定性到执行一步迭代计算，从而巩固您对多步法的理解。

通过本次学习，您将不仅掌握一类重要的ODE数值求解技术，更将领会到数值方法设计中精度、稳定性与效率之间精妙的权衡艺术。让我们一同开始探索多步法的世界。

## 原理与机制

在上一章介绍[单步法](@entry_id:164989)的基础上，本章将深入探讨一类更广泛且在许多应用中效率更高的方法：**[线性多步法](@entry_id:139528) (Linear Multistep Methods, LMMs)**。与[单步法](@entry_id:164989)（如[龙格-库塔法](@entry_id:140014)）在每一步中仅使用前一个点 $(t_n, y_n)$ 的信息来计算下一个点 $y_{n+1}$ 不同，多步法利用了之前多个步长点上的信息来提高精度和效率。本章将系统地阐述这些方法的构建原理、实际应用中的关键考量以及保证其数值解收敛的深刻理论。

### [线性多步法](@entry_id:139528)的一般形式与分类

我们考虑求解[一阶常微分方程](@entry_id:264241)[初值问题](@entry_id:144620) (IVP)：
$$ y'(t) = f(t, y(t)), \quad y(t_0) = y_0 $$
在等距时间网格 $t_n = t_0 + nh$ 上，$h$ 为步长。

一个通用的 **$k$-步[线性多步法](@entry_id:139528)** 由以下[差分方程](@entry_id:262177)定义：
$$ \sum_{j=0}^{k} \alpha_j y_{n+j} = h \sum_{j=0}^{k} \beta_j f_{n+j} $$
其中，$y_{m}$ 是对真解 $y(t_m)$ 的[数值近似](@entry_id:161970)，$f_m = f(t_m, y_m)$。系数 $\alpha_j$ 和 $\beta_j$ 是定义特定方法的实常数。按照惯例，我们进行归一化，令 $\alpha_k = 1$，并要求 $|\alpha_0| + |\beta_0| \gt 0$ 以确保该方法是一个真正的 $k$-步方法。

这个公式优雅地统一了众多方法，但其结构也带来了重要的分类。我们可以通过将 $j=k$ 的项分离出来，更清晰地看到这一点：
$$ \alpha_k y_{n+k} + \sum_{j=0}^{k-1} \alpha_j y_{n+j} = h \beta_k f_{n+k} + h \sum_{j=0}^{k-1} \beta_j f_{n+j} $$
由于我们设定了 $\alpha_k = 1$，我们可以将上式整理为求解 $y_{n+k}$ 的形式：
$$ y_{n+k} = -\sum_{j=0}^{k-1} \alpha_j y_{n+j} + h \sum_{j=0}^{k-1} \beta_j f_{n+j} + h \beta_k f_{n+k} $$
这个表达式揭示了一个核心区别。等式右侧的项，除了最后一项，都只依赖于已知的历史信息（$y_{n}, y_{n+1}, \dots, y_{n+k-1}$ 及其对应的 $f$ 值）。然而，最后一项 $h \beta_k f_{n+k}$ 涉及 $f_{n+k} = f(t_{n+k}, y_{n+k})$，它依赖于我们正在求解的未知值 $y_{n+k}$。

这引出了两种基本的方法类型：

1.  **显式方法 (Explicit Methods)**：如果 $\beta_k = 0$，则 $y_{n+k}$ 不会出现在等式右侧。这意味着 $y_{n+k}$ 可以通过一个简单的、直接的计算从已知值中求出。这类方法计算上非常直接。

2.  **[隐式方法](@entry_id:137073) (Implicit Methods)**：如果 $\beta_k \neq 0$，则未知量 $y_{n+k}$ 同时出现在等式的左右两边。这构成了一个关于 $y_{n+k}$ 的（通常是[非线性](@entry_id:637147)的）代数方程。在每一步计算中，我们都必须求解这个方程才能得到 $y_{n+k}$，这通常需要借助[求根算法](@entry_id:146357)（如[不动点迭代](@entry_id:749443)或牛顿法），从而增加了每一步的计算成本 [@problem_id:2187822]。例如，**[Adams-Moulton](@entry_id:164339)** 方法族就是隐式方法的典型代表，其通用公式中包含 $f(t_{n+1}, y_{n+1})$ 这一项，使其天然具有隐式性 [@problem_id:2187837]。

尽管隐式方法计算成本更高，但我们将在后续章节看到，它们通常拥有更优的稳定性和精度特性，这使得它们在特定问题（尤其是[刚性问题](@entry_id:142143)）中不可或缺。

### 多步法的构建：源于积分的思想

几乎所有[线性多步法](@entry_id:139528)的构建都源于对[微分方程](@entry_id:264184) $y'(t) = f(t, y(t))$ 的一个基本积分形式的近似。将该方程从 $t_n$ 到 $t_{n+1}$ 进行积分，我们得到其精确关系：
$$ y(t_{n+1}) = y(t_n) + \int_{t_n}^{t_{n+1}} f(t, y(t)) dt $$
数值方法的核心思想在于，用一个易于积分的函数——通常是一个多项式 $P(t)$——来近似积分区间内的被积函数 $f(t, y(t))$。不同的多项式选择导致了不同的方法族。

一个重要的家族是 **Adams 方法族**。这类方法的特点是它们在 LMM 通式中取 $\alpha_k=1, \alpha_{k-1}=-1$，且所有其他的 $\alpha_j=0$。它们可以进一步分为显式的 **[Adams-Bashforth](@entry_id:168783) (AB)** 方法和隐式的 **[Adams-Moulton](@entry_id:164339) (AM)** 方法。

#### [Adams-Bashforth](@entry_id:168783) (AB) 方法

AB 方法通过利用**过去**的数据点 $\{ (t_{n-j}, f_{n-j}) \}_{j=0}^{k-1}$ 构造一个 $(k-1)$ 次[插值多项式](@entry_id:750764) $P_{k-1}(t)$，然后用该多项式近似 $f(t, y(t))$ 并计算积分。

- **一阶 AB 方法 (AB1)**：最简单的情况是使用一个 0 次多项式（一个常数）来近似 $f$。我们取 $P_0(t) = f_n = f(t_n, y_n)$。将此近似代入积分公式：
$$ y_{n+1} = y_n + \int_{t_n}^{t_{n+1}} f_n dt = y_n + f_n [t]_{t_n}^{t_{n+1}} = y_n + h f_n $$
这正是我们熟知的**[前向欧拉法](@entry_id:141238)**。这个推导揭示了[前向欧拉法](@entry_id:141238)可以被视为最简单的[线性多步法](@entry_id:139528)。通过[泰勒展开](@entry_id:145057)分析，可以证明该方法的**[局部截断误差](@entry_id:147703)**（即假设 $y_n = y(t_n)$ 时，单步产生的误差）的主项为 $\frac{h^2}{2} y''(t_n)$，这表明它是一个一阶方法 [@problem_id:2187863]。

- **二阶 AB 方法 (AB2)**：为了获得更高的精度，我们可以使用更高次的插值多项式。AB2 方法使用一个穿过 $(t_{n-1}, f_{n-1})$ 和 $(t_n, f_n)$ 两点的线性[插值多项式](@entry_id:750764) $P_1(t)$。利用[拉格朗日插值](@entry_id:167052)公式，该多项式为：
$$ P_1(t) = f_{n-1} \frac{t - t_n}{t_{n-1} - t_n} + f_n \frac{t - t_{n-1}}{t_n - t_{n-1}} = f_{n-1} \frac{t_n - t}{h} + f_n \frac{t - t_{n-1}}{h} $$
将其在 $[t_n, t_{n+1}]$ 上积分，经过计算可得：
$$ \int_{t_n}^{t_{n+1}} P_1(t) dt = h \left( \frac{3}{2} f_n - \frac{1}{2} f_{n-1} \right) $$
因此，二阶 [Adams-Bashforth](@entry_id:168783) 方法的更新公式为：
$$ y_{n+1} = y_n + h \left( \frac{3}{2} f_n - \frac{1}{2} f_{n-1} \right) $$
这个推导过程清晰地展示了 Adams 方法系数的由来 [@problem_id:2187847]。通过增加插值点的数量，可以系统地推导出更高阶的 [Adams-Bashforth](@entry_id:168783) 方法。

#### [Adams-Moulton](@entry_id:164339) (AM) 方法

AM 方法与 AB 方法的思路类似，但它在构造[插值多项式](@entry_id:750764)时，额[外包](@entry_id:262441)含了**未来**的未知点 $(t_{n+1}, f_{n+1})$。例如，二阶 AM 方法（即**梯形法则**）使用穿过 $(t_n, f_n)$ 和 $(t_{n+1}, f_{n+1})$ 的线性插值多项式。由于 $f_{n+1}$ 依赖于未知的 $y_{n+1}$，这就导致了方法的隐式性。通常，包含未来点可以构建出给定阶数下更精确或更稳定的方法。

### 实际应用中的考量

#### 方法的启动问题

多步法的一个固有挑战是其“自启动”问题。一个 $k$-步方法需要 $k$ 个历史数据点 $(y_n, y_{n-1}, \dots, y_{n-k+1})$ 来计算下一个点 $y_{n+1}$。然而，一个[初值问题](@entry_id:144620)仅提供一个初始点 $(t_0, y_0)$。那么，所需的 $y_1, y_2, \dots, y_{k-1}$ 从何而来呢？

例如，三步 [Adams-Bashforth](@entry_id:168783) 方法的公式为：
$$ y_{n+1} = y_n + \frac{h}{12} (23 f_n - 16 f_{n-1} + 5 f_{n-2}) $$
要计算 $y_1$ (令 $n=0$)，我们需要 $y_0, y_{-1}, y_{-2}$，但我们只有 $y_0$。即使从 $n=2$开始计算 $y_3$，我们也需要 $y_2, y_1, y_0$。因此，仅靠[初始条件](@entry_id:152863)是无法启动该方法的。

这个问题的标准解决方案是，使用一个同阶或更高阶的**[单步法](@entry_id:164989)**（如[四阶龙格-库塔法](@entry_id:138005)）来计算前 $k-1$ 个点 $(y_1, \dots, y_{k-1})$。一旦获得了足够的“历史”数据，就可以切换到计算上更经济的多步法进行后续的积分。因此，多步法通常需要一个单步的“伴侣”来启动计算 [@problem_id:2187851]。

#### [预测-校正方法](@entry_id:147382)

隐式方法虽然性质优越，但[求解非线性方程](@entry_id:177343)的计算开销可能很大。**预测-校正 (Predictor-Corrector)** 方案是一种巧妙的回避此问题的方法。它将一个显式方法和一个[隐式方法](@entry_id:137073)配对使用：

1.  **预测 (Predictor)**：首先，使用一个显式方法（如 [Adams-Bashforth](@entry_id:168783) 法）计算 $y_{n+1}$ 的一个初步估计，记为 $y_{n+1}^*$。这是一个廉价的计算。
$$ y_{n+1}^* = \text{ExplicitUpdate}(y_n, y_{n-1}, \dots) $$

2.  **校正 (Corrector)**：然后，使用这个预测值 $y_{n+1}^*$ 来近似[隐式方法](@entry_id:137073)右侧的未知项。例如，对于一个依赖于 $f(t_{n+1}, y_{n+1})$ 的[隐式方法](@entry_id:137073)，我们计算 $f(t_{n+1}, y_{n+1}^*)$。这个值随后被代入隐式公式的右侧，从而将原本需要迭代求解的步骤转化为一次直接计算。
$$ y_{n+1} = \text{ImplicitUpdateWith}(y_{n+1}^*) $$
例如，在一个 PECE (Predict-Evaluate-Correct-Evaluate) 方案中，我们：
- **P (预测)**: 计算 $y_{n+1}^*$。
- **E (求值)**: 计算 $f(t_{n+1}, y_{n+1}^*)$。
- **C (校正)**: 使用 $f(t_{n+1}, y_{n+1}^*)$ 在隐式公式中计算最终的 $y_{n+1}$。
- **E (求值)**: 计算 $f(t_{n+1}, y_{n+1})$ 以备下一步使用。

这种策略的核心作用在于，预测值 $y_{n+1}^*$ 提供了一个评估未来函数值 $f$ 的途径，从而将隐式校正器的计算复杂度降低到与显式方法相当的水平，同时保留了[隐式方法](@entry_id:137073)的部分优良特性 [@problem_id:2187846]。

### 收敛性理论：[一致性与稳定性](@entry_id:178217)

一个数值方法只有在步长 $h \to 0$ 时，其数值解收敛到真实解，才是有用的。对于[线性多步法](@entry_id:139528)，其收敛性由两个核心概念——**一致性**和**[零稳定性](@entry_id:178549)**——共同决定。这一深刻的结论被称为 **Dahlquist 等价定理**：

> 一个[线性多步法](@entry_id:139528)是收敛的，当且仅当它既是一致的又是零稳定的。

#### 一致性 (Consistency)

一致性衡量的是[差分方程](@entry_id:262177)在多大程度上逼近了[微分方程](@entry_id:264184)。直观地说，如果我们将真实解 $y(t)$代入 LMM 的公式，其残差（即**[局部截断误差](@entry_id:147703)**）应随着 $h \to 0$ 而趋于零。

为了形式化地检验一致性，我们引入两个**特征多项式**：
$$ \rho(z) = \sum_{j=0}^{k} \alpha_j z^j \quad \text{和} \quad \sigma(z) = \sum_{j=0}^{k} \beta_j z^j $$
一个 LMM 是一致的，当且仅当以下两个条件成立：
1.  $\rho(1) = 0$
2.  $\rho'(1) = \sigma(1)$

第一个条件确保了方法能正确处理 $y' = 0$ 的情况（即常数解）。第二个条件确保了方法在 $h$ 很小时能正确逼近导数。

例如，考虑**[显式中点法](@entry_id:137018) (leapfrog method)**：$y_{n+1} = y_{n-1} + 2h f_n$。为了与[标准形式](@entry_id:153058)对应，我们重写为 $y_{n+2} - y_n = 2h f_{n+1}$。
其系数为 $\alpha_2=1, \alpha_1=0, \alpha_0=-1$ 和 $\beta_1=2, \beta_0=\beta_2=0$。
特征多项式为 $\rho(z) = z^2 - 1$ 和 $\sigma(z) = 2z$。
- **条件 1**: $\rho(1) = 1^2 - 1 = 0$。满足。
- **条件 2**: $\rho'(z) = 2z$，所以 $\rho'(1) = 2$。$\sigma(1) = 2 \cdot 1 = 2$。因此 $\rho'(1) = \sigma(1)$。满足。
由于两个条件都满足，[显式中点法](@entry_id:137018)是一致的 [@problem_id:2187864]。

#### [零稳定性](@entry_id:178549) (Zero-Stability)

[零稳定性](@entry_id:178549)，又称**根条件 (root condition)**，关注的是当 $h \to 0$ 时，LMM 差分方程本身的稳定性。它要求 LMM 在应用于 $y'=0$ (即 $h=0$) 时，其解不会无界增长。此时 LMM 简化为 $\sum_{j=0}^{k} \alpha_j y_{n+j} = 0$，这是一个[齐次线性差分方程](@entry_id:193106)。其解的行为由[特征多项式](@entry_id:150909) $\rho(z)$ 的根决定。

**根条件**规定：
> 一个 LMM 是零稳定的，当且仅当其第一个[特征多项式](@entry_id:150909) $\rho(z)$ 的所有根 $z_i$ 都位于[单位圆盘](@entry_id:172324)内（$|z_i| \le 1$），且任何位于[单位圆](@entry_id:267290)上的根（$|z_i|=1$）都必须是**单根**。

单位圆上的[重根](@entry_id:151486)会导致数值解中出现诸如 $n \cdot c^n$（其中 $|c|=1$）之类的项，当 $n \to \infty$ 时会无界增长，从而破坏稳定性。

例如，考虑方法 $y_{n+2} - \frac{3}{2} y_{n+1} + \frac{1}{2} y_n = h(\dots)$。其第一个[特征多项式](@entry_id:150909)为 $\rho(z) = z^2 - \frac{3}{2}z + \frac{1}{2}$。求解 $\rho(z)=0$ 得到根为 $z=1$ 和 $z=\frac{1}{2}$ [@problem_id:2187834]。这两个根都满足根条件（一个在单位圆上且是单根，另一个在单位圆内），因此该方法是零稳定的。

Dahlquist 等价定理的伟大之处在于它将方法的设计（体现在系数 $\alpha_j, \beta_j$ 中）与其实际的收敛行为联系起来，为设计可靠的数值方法提供了坚实的理论基石 [@problem_id:2187842]。

### [刚性问题](@entry_id:142143)与[稳定性理论](@entry_id:149957)

在许多科学与工程领域，如[化学动力学](@entry_id:144961)和电路模拟，常会遇到**刚性 (stiff)** [微分方程](@entry_id:264184)系统。这类系统的特点是其解的各个分量包含变化速度迥异的时间尺度。对于显式方法，为了保持数值稳定，步长 $h$ 必须由最快的时间尺度决定，即使我们关心的解分量变化非常缓慢。这导致了极小的步长和高昂的计算成本。

为了分析方法对[刚性问题](@entry_id:142143)的适应性，我们使用 **Dahlquist 测试方程** $y' = \lambda y$，其中 $\lambda$ 是一个具有大负实部的复数。我们将方法应用于此方程，并研究数值解 $y_n$ 随 $n$ 增大的行为。方法的**[绝对稳定域](@entry_id:171484)**是复平面上所有 $z = h\lambda$ 值的集合，对于这些 $z$，数值解 $y_n$ 保持有界。

- **显式方法**，如 [Adams-Bashforth](@entry_id:168783) (AB) 方法，其[绝对稳定域](@entry_id:171484)是复平面中的一个**有界**区域。这意味着为了保持稳定，$|h\lambda|$ 必须被限制在一个小范围内。对于[刚性问题](@entry_id:142143)（$|\lambda|$ 很大），这迫使步长 $h$ 必须非常小，从而使其不切实际。

- **[隐式方法](@entry_id:137073)**，如**向后[微分](@entry_id:158718)公式 (Backward Differentiation Formulas, BDF)**，通常具有**无界**的[绝对稳定域](@entry_id:171484)。例如，二阶 BDF (BDF2) 方法的稳定域包含了整个左半复平面。这意味着对于任意具有负实部的 $\lambda$，无论其[绝对值](@entry_id:147688)多大，只要 $h>0$，方法都是稳定的。这使得 BDF 方法能够使用远大于显式方法所允许的步长来求解刚性问题，极大地提高了效率 [@problem_id:2187838]。

#### [A-稳定性](@entry_id:144367)与 Dahlquist 障碍

最理想的稳定性是 **[A-稳定性](@entry_id:144367)**，即方法的[绝对稳定域](@entry_id:171484)包含整个左半复平面 $\text{Re}(z) \le 0$。这保证了对于任何稳定的线性系统，数值方法都是稳定的，无论步长如何。

然而，[A-稳定性](@entry_id:144367)与方法精度之间存在深刻的内在冲突，这由著名的 **Dahlquist 第二稳定性障碍**所揭示：
> 一个 A-稳定的[线性多步法](@entry_id:139528)，其精度阶数 $p$ 不能超过 2 ($p \le 2$)。

[精度阶](@entry_id:145189)数最高的 A-稳定 LMM 是二阶的[梯形法则](@entry_id:145375)。这意味着，任何声称阶数高于 2 的 A-稳定[线性多步法](@entry_id:139528)都是理论上不可能的。例如，一个宣称是 A-稳定且阶数为 5 的三步 LMM 的提议，从根本上违反了这一理论限制，因此是不可信的 [@problem_id:2187853]。

这一障碍促使研究者们寻求折衷方案。BDF 方法就是一个成功的例子。虽然只有一阶和二阶 BDF 是 A-稳定的，但更高阶的 BDF 方法（最高到六阶）拥有虽然不是整个左半平面、但依然非常广阔的稳定域，覆盖了负实轴附近的大片区域。这种被称为**A($\alpha$)-稳定**的性质，使得高阶 BDF 方法成为求解[刚性问题](@entry_id:142143)的标准工具，完美地平衡了精度和稳定性的需求。