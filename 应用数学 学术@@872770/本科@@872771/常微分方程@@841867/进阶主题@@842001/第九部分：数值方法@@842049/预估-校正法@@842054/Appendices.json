{"hands_on_practices": [{"introduction": "第一个练习将引导你完成一个完整的预测-校正方法周期。通过应用欧拉预测子和梯形校正子，你将看到一个粗略的初始估计是如何被精炼以获得更精确的近似值的。这个两步过程是许多高级常微分方程数值求解技术背后的基本概念[@problem_id:2194236]。", "problem": "考虑由常微分方程定义的初值问题：\n$$ y' = x^2 - y^2 $$\n初始条件为 $y(0) = 1$。\n\n您的任务是使用步长 $h=0.1$，通过执行一步欧拉预估-梯形校正法来近似 $y(0.1)$ 的值。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "我们将微分方程定义为 $y' = f(x,y)$，其中 $f(x,y) = x^2 - y^2$，初始条件为 $y(0) = 1$。设 $h = 0.1$，$x_0 = 0$，以及 $x_1 = x_0 + h = 0.1$。\n\n欧拉预估公式为\n$$\ny_{1}^{(p)} = y_0 + h\\,f(x_0,y_0).\n$$\n计算\n$$\nf(x_0,y_0) = f(0,1) = 0^2 - 1^2 = -1,\n$$\n所以\n$$\ny_{1}^{(p)} = 1 + 0.1(-1) = 0.9.\n$$\n\n梯形校正公式（使用预估值进行一次校正）为\n$$\ny_1 = y_0 + \\frac{h}{2}\\left[f(x_0,y_0) + f(x_1,y_{1}^{(p)})\\right].\n$$\n计算\n$$\nf(x_1,y_{1}^{(p)}) = f(0.1,0.9) = (0.1)^2 - (0.9)^2 = 0.01 - 0.81 = -0.8.\n$$\n因此\n$$\ny_1 = 1 + \\frac{0.1}{2}\\left[(-1) + (-0.8)\\right] = 1 + 0.05(-1.8) = 1 - 0.09 = 0.91.\n$$\n\n四舍五入到四位有效数字得到 $0.9100$。", "answer": "$$\\boxed{0.9100}$$", "id": "2194236"}, {"introduction": "尽管预测-校正方法提高了精度，但它们并非在所有情况下都能随意使用。本练习探讨了数值稳定性的关键概念，尤其是在处理“刚性”微分方程时。你将确定保证该方法保持稳定所需的最大步长，从而揭示显式方法的一个关键局限性[@problem_id:2194666]。", "problem": "数值分析中的一个常见问题是求解刚性微分方程，其解包含以截然不同速率衰减的分量。显式数值方法通常难以处理此类问题，需要极小的步长来维持稳定性，即使解本身变化缓慢。\n\n考虑以下模型刚性初值问题：\n$$y'(t) = -75 y(t), \\quad y(0) = 1$$\n\n我们希望使用一种简单的显式预估-校正方法来求解这个方程，该方法通常被称为 Heun 法或改进的欧拉法。对于具有步长 $h$ 的一般常微分方程 (ODE) $y'(t) = f(t, y(t))$，该方法由以下两个步骤定义：\n\n1.  **预估步骤：** 使用前向欧拉法计算预估值 $p_{n+1}$：\n    $p_{n+1} = y_n + h f(t_n, y_n)$\n2.  **校正步骤：** 使用梯形法则，利用预估值来找到下一个近似值 $y_{n+1}$：\n    $y_{n+1} = y_n + \\frac{h}{2} [f(t_n, y_n) + f(t_{n+1}, p_{n+1})]$\n\n当应用于测试方程 $y' = \\lambda y$ 时，单步法的稳定性由其放大因子 $G(z)$ 决定，其中 $z = h\\lambda$ 且数值近似值由 $y_{n+1} = G(z) y_n$ 关联。为使数值解绝对稳定，该因子的大小不得超过 1，即 $|G(z)| \\leq 1$。\n\n确定当此预估-校正方法应用于给定的刚性常微分方程时，为使其绝对稳定所允许的最大步长 $h_{\\max}$。将您的答案表示为一个四舍五入到三位有效数字的实数。", "solution": "我们将该方法应用于线性测试方程 $y'=\\lambda y$，其中 $\\lambda=-75$。对于 Heun 法（显式预估-校正），预估步骤为\n$$\np_{n+1}=y_{n}+h f(t_{n},y_{n})=y_{n}+h\\lambda y_{n}=(1+z)y_{n},\\quad z=h\\lambda.\n$$\n然后校正步骤给出\n$$\ny_{n+1}=y_{n}+\\frac{h}{2}\\left[f(t_{n},y_{n})+f(t_{n+1},p_{n+1})\\right]\n=y_{n}+\\frac{h}{2}\\left[\\lambda y_{n}+\\lambda p_{n+1}\\right]\n=y_{n}+\\frac{z}{2}\\left[y_{n}+p_{n+1}\\right].\n$$\n代入 $p_{n+1}=(1+z)y_{n}$ 可得\n$$\ny_{n+1}=y_{n}+\\frac{z}{2}\\left[1+(1+z)\\right]y_{n}\n=\\left(1+z+\\frac{z^{2}}{2}\\right)y_{n}.\n$$\n因此，放大因子为\n$$\nG(z)=1+z+\\frac{z^{2}}{2}.\n$$\n绝对稳定性要求 $|G(z)|\\leq 1$。对于实数 $z$，配方法：\n$$\nG(z)=1+z+\\frac{z^{2}}{2}=\\frac{1}{2}+\\frac{1}{2}(z+1)^{2}\\geq \\frac{1}{2},\n$$\n因此在实轴上 $G(z)\\geq 0$，且 $|G(z)|\\leq 1$ 等价于 $G(z)\\leq 1$。因此，\n$$\n1+z+\\frac{z^{2}}{2}\\leq 1\n\\;\\Longleftrightarrow\\;\nz+\\frac{z^{2}}{2}\\leq 0\n\\;\\Longleftrightarrow\\;\nz\\left(1+\\frac{z}{2}\\right)\\leq 0,\n$$\n此不等式对于 $z\\in[-2,0]$ 成立。对于给定的问题，$\\lambda=-75$ 且 $z=h\\lambda=-75h$ 是实数且非正，因此绝对稳定性要求\n$$\n-2\\leq -75h\\leq 0\n\\;\\Longleftrightarrow\\;\n0\\leq 75h\\leq 2\n\\;\\Longleftrightarrow\\;\n0\\leq h\\leq \\frac{2}{75}.\n$$\n因此，允许的最大步长为 $h_{\\max}=\\frac{2}{75}$，其小数形式四舍五入到三位有效数字是 $0.0267$。", "answer": "$$\\boxed{0.0267}$$", "id": "2194666"}, {"introduction": "数值方法的一个关键理论性质是其收敛阶，它描述了当步长减小时误差减小的速度。这个练习将让你扮演一位数值侦探，任务是通过实验验证休恩（Heun）方法的这一性质。通过比较不同步长产生的误差，你将估算出该方法的收敛阶，从而连接起理论分析与实际应用之间的桥梁[@problem_id:2194700]。", "problem": "在数值分析中，一个常见的任务是通过观察误差如何随步长变化来验证数值方法的理论收敛阶。考虑由常微分方程 $y'(t) = -y(t)$ 和初始条件 $y(0) = 1$ 给出的初值问题（IVP）。\n\n你的任务是研究一种单步预测-校正方法，该方法通常被称为Heun方法或改进的欧拉方法。对于从 $t_i$ 到 $t_{i+1} = t_i + h$ 的每个时间步，该方法分两个阶段进行，其中 $f(t,y) = -y$ 是微分方程的右端项：\n1.  **预测（欧拉方法）**：使用公式 $p_{i+1} = y_i + h f(t_i, y_i)$ 计算初始估计值 $p_{i+1}$。\n2.  **校正（梯形法则）**：使用预测值通过公式 $y_{i+1} = y_i + \\frac{h}{2} [f(t_i, y_i) + f(t_{i+1}, p_{i+1})]$ 来找到该步的校正值 $y_{i+1}$。\n\n你的目标是数值地估计该方法的收敛阶 $p$。为此，首先计算 $y(0.5)$ 的两个近似值：一个使用大小为 $h_1 = 0.5$ 的单步，另一个使用大小为 $h_2 = 0.25$ 的两步。让这些近似值分别为 $y_{approx}(0.5, h_1)$ 和 $y_{approx}(0.5, h_2)$。\n\n此IVP的精确解为 $y_{exact}(t) = \\exp(-t)$。使用 $y_{exact}(0.5) \\approx 0.60653$ 的值来计算绝对误差 $E_1 = |y_{exact}(0.5) - y_{approx}(0.5, h_1)|$ 和 $E_2 = |y_{exact}(0.5) - y_{approx}(0.5, h_2)|$。\n\n收敛阶 $p$ 可以从全局误差与步长的阶数次幂成正比的关系中估算，即 $E_h \\propto h^p$。对于两个步长 $h_1$ 和 $h_2$，这意味着关系式 $\\frac{E_1}{E_2} \\approx \\left(\\frac{h_1}{h_2}\\right)^p$。使用此关系式求出 $p$ 的值。\n\n计算估计的收敛阶 $p$。将你的最终答案四舍五入到三位有效数字。", "solution": "我们使用指定的预测-校正（Heun）方法求解IVP $y'(t)=-y(t)$, $y(0)=1$。右端项为 $f(t,y)=-y$。精确解为 $y_{\\text{exact}}(t)=\\exp(-t)$，我们使用给定的 $y_{\\text{exact}}(0.5)\\approx 0.60653$。\n\n对于从 $t_{0}=0$ 到 $t_{1}=0.5$ 的单步，步长 $h_{1}=0.5$，从 $y_{0}=1$ 开始。\n预测步：\n$$\np_{1}=y_{0}+h_{1}f(t_{0},y_{0})=1+0.5(-1)=0.5.\n$$\n校正步：\n$$\ny_{1}=y_{0}+\\frac{h_{1}}{2}\\big[f(t_{0},y_{0})+f(t_{1},p_{1})\\big]\n=1+\\frac{0.5}{2}\\big[(-1)+(-0.5)\\big]\n=1+0.25(-1.5)=0.625.\n$$\n因此 $y_{\\text{approx}}(0.5,h_{1})=0.625$，绝对误差为\n$$\nE_{1}=|0.60653-0.625|=0.01847.\n$$\n\n对于从 $t_{0}=0$ 到 $t_{2}=0.5$ 的两步，步长 $h_{2}=0.25$，从 $y_{0}=1$ 开始。\n\n第一步到 $t_{1}=0.25$：\n预测步：\n$$\np_{1}=y_{0}+h_{2}f(t_{0},y_{0})=1+0.25(-1)=0.75.\n$$\n校正步：\n$$\ny_{1}=y_{0}+\\frac{h_{2}}{2}\\big[f(t_{0},y_{0})+f(t_{1},p_{1})\\big]\n=1+0.125\\big[(-1)+(-0.75)\\big]\n=1+0.125(-1.75)=0.78125.\n$$\n\n第二步到 $t_{2}=0.5$：\n预测步：\n$$\np_{2}=y_{1}+h_{2}f(t_{1},y_{1})=0.78125+0.25(-0.78125)=0.5859375.\n$$\n校正步：\n$$\ny_{2}=y_{1}+\\frac{h_{2}}{2}\\big[f(t_{1},y_{1})+f(t_{2},p_{2})\\big]\n=0.78125+0.125\\big[(-0.78125)+(-0.5859375)\\big]\n=0.78125+0.125(-1.3671875)=0.6103515625.\n$$\n因此 $y_{\\text{approx}}(0.5,h_{2})=0.6103515625$，绝对误差为\n$$\nE_{2}=|0.60653-0.6103515625|=0.0038215625.\n$$\n\n假设 $E_{h}\\propto h^{p}$，我们使用\n$$\n\\frac{E_{1}}{E_{2}}\\approx \\left(\\frac{h_{1}}{h_{2}}\\right)^{p}\n\\quad\\Longrightarrow\\quad\np\\approx \\frac{\\ln(E_{1}/E_{2})}{\\ln(h_{1}/h_{2})}.\n$$\n当 $h_{1}/h_{2}=2$ 且 $E_{1}/E_{2}=0.01847/0.0038215625\\approx 4.8331016$ 时，我们得到\n$$\np\\approx \\frac{\\ln(4.8331016)}{\\ln(2)}\\approx 2.27,\n$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{2.27}$$", "id": "2194700"}]}