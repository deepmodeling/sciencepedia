{"hands_on_practices": [{"introduction": "我们如何能在不进行过多计算的情况下提高数值解的精度？理查森外推法 (Richardson extrapolation) 提供了一个巧妙的答案。本练习将演示如何结合简单的向前欧拉法产生的两个低精度近似值，来构造一个精度显著更高的结果，揭示了一种强大而通用的误差消除原理 [@problem_id:2158966]。", "problem": "考虑由微分方程 $y'(t) = y(t)$ 和初始条件 $y(0) = 1$ 定义的初值问题。我们希望对于某个小步长 $h>0$，找到解在时间 $t=h$ 处的值的高精度近似。\n\n令 $A_1$ 是使用步长为 $h$ 的向前欧拉法进行一步计算所得到的 $y(h)$ 的数值近似。\n\n令 $A_2$ 是使用步长为 $h/2$ 的向前欧拉法连续进行两步计算所得到的 $y(h)$ 的数值近似。\n\n已知向前欧拉法是一种一阶精度方法。然而，通过适当地组合两个近似值 $A_1$ 和 $A_2$，可以消去主误差项，从而得到一个 $y(h)$ 的新的二阶精度近似值。\n\n推导这个用步长 $h$ 表示的改进的二阶精度近似值的表达式。", "solution": "我们使用向前欧拉法 $y_{n+1}=y_{n}+h f(t_{n},y_{n})$，其中 $f(t,y)=y$ 且 $y(0)=1$。\n\n使用步长 $h$ 进行一步计算得到\n$$\nA_{1}=y(h)\\ \\text{(approx)}=y_{0}+h f(t_{0},y_{0})=1+h.\n$$\n使用步长 $h/2$ 连续进行两步计算得到\n$$\ny\\left(\\tfrac{h}{2}\\right)\\ \\text{(approx)}=1+\\tfrac{h}{2},\\qquad\nA_{2}=y(h)\\ \\text{(approx)}=y\\left(\\tfrac{h}{2}\\right)+\\tfrac{h}{2} f\\!\\left(\\tfrac{h}{2},y\\left(\\tfrac{h}{2}\\right)\\right)=\\left(1+\\tfrac{h}{2}\\right)+\\tfrac{h}{2}\\left(1+\\tfrac{h}{2}\\right)=1+h+\\tfrac{h^{2}}{4}.\n$$\n由于向前欧拉法是一阶精度的，在固定的最终时间点，全局误差表现为\n$$\nA_{1}=y(h)+C h+O(h^{2}),\\qquad A_{2}=y(h)+C \\tfrac{h}{2}+O(h^{2}),\n$$\n其中 $C$ 为某个与 $h$ 无关的常数。通过 Richardson 外推法消去 $Ch$ 项，得到\n$$\ny(h)=2A_{2}-A_{1}+O(h^{2}).\n$$\n代入计算出的 $A_{1}$ 和 $A_{2}$，\n$$\n2A_{2}-A_{1}=2\\left(1+h+\\tfrac{h^{2}}{4}\\right)-(1+h)=1+h+\\tfrac{h^{2}}{2}.\n$$\n这与精确解 $y(h)=\\exp(h)=1+h+\\tfrac{h^{2}}{2}+O(h^{3})$ 的泰勒展开式到 $h^{2}$ 项相符，证实了其二阶精度。因此，用 $h$ 表示的改进的二阶精度近似值为 $1+h+\\tfrac{h^{2}}{2}$。", "answer": "$$\\boxed{1+h+\\frac{h^{2}}{2}}$$", "id": "2158966"}, {"introduction": "一个好的数值模拟不仅应近似计算数值，还应尊重系统背后的物理原理。对于许多物理问题，如简谐振子，总能量必须是守恒的。本练习邀请您研究经典的四阶龙格-库塔 (RK4) 方法在多大程度上保持了这一关键物理量，从而深入了解数值方案的长期稳定性和定性准确性 [@problem_id:2158985]。", "problem": "一个粒子的一维运动由一个简化的无量纲模型描述，该模型由以下一阶常微分方程组表示：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\n其中 $x$ 是粒子的位置，$v$ 是其速度。系统的总能量由表达式 $E = \\frac{1}{2}(x^2 + v^2)$ 定义。\n\n在时间 $t=0$ 时，系统具有初始条件 $x(0) = 0$ 和 $v(0) = 1$。\n\n使用步长 $h = 0.2$ 执行单步经典四阶龙格-库塔 (RK4) 方法，近似系统在时间 $t=0.2$ 时的状态 $(x(t), v(t))$。\n\n使用 $x(0.2)$ 和 $v(0.2)$ 的近似值，计算这一步之后总能量的相对误差。相对误差定义为 $\\frac{|E_1 - E_0|}{E_0}$，其中 $E_0$ 是 $t=0$ 时的初始能量，$E_1$ 是根据您在 $t=0.2$ 时的数值近似计算出的能量。\n\n将您的最终答案四舍五入到四位有效数字。", "solution": "我们有自治系统 $x' = v$，$v' = -x$，初始值为 $x(0) = 0$，$v(0) = 1$，步长为 $h = 0.2$。对于系统 $y' = f(y)$，其中 $y = \\begin{pmatrix} x \\\\ v \\end{pmatrix}$ 且 $f(y) = \\begin{pmatrix} v \\\\ -x \\end{pmatrix}$，经典的 RK4 方法计算\n$$\nk_{1} = f(y_{0}),\\quad\nk_{2} = f\\left(y_{0} + \\frac{h}{2}k_{1}\\right),\\quad\nk_{3} = f\\left(y_{0} + \\frac{h}{2}k_{2}\\right),\\quad\nk_{4} = f\\left(y_{0} + h\\,k_{3}\\right),\n$$\n并更新 $y_{1} = y_{0} + \\frac{h}{6}\\left(k_{1} + 2k_{2} + 2k_{3} + k_{4}\\right)$。\n\n当 $y_{0} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 时：\n- $k_{1} = f\\left(\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\right) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- $y_{0} + \\frac{h}{2}k_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.1\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}$，因此 $k_{2} = f\\left(\\begin{pmatrix} 0.1 \\\\ 1 \\end{pmatrix}\\right) = \\begin{pmatrix} 1 \\\\ -0.1 \\end{pmatrix}$。\n- $y_{0} + \\frac{h}{2}k_{2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.1\\begin{pmatrix} 1 \\\\ -0.1 \\end{pmatrix} = \\begin{pmatrix} 0.1 \\\\ 0.99 \\end{pmatrix}$，因此 $k_{3} = f\\left(\\begin{pmatrix} 0.1 \\\\ 0.99 \\end{pmatrix}\\right) = \\begin{pmatrix} 0.99 \\\\ -0.1 \\end{pmatrix}$。\n- $y_{0} + h\\,k_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.2\\begin{pmatrix} 0.99 \\\\ -0.1 \\end{pmatrix} = \\begin{pmatrix} 0.198 \\\\ 0.98 \\end{pmatrix}$，因此 $k_{4} = f\\left(\\begin{pmatrix} 0.198 \\\\ 0.98 \\end{pmatrix}\\right) = \\begin{pmatrix} 0.98 \\\\ -0.198 \\end{pmatrix}$。\n\n合并得到\n$$\nx(0.2) \\approx x_{1} = 0 + \\frac{0.2}{6}\\left(1 + 2\\cdot 1 + 2\\cdot 0.99 + 0.98\\right) = \\frac{1}{30}\\cdot 5.96 = \\frac{149}{750},\n$$\n$$\nv(0.2) \\approx v_{1} = 1 + \\frac{0.2}{6}\\left(0 + 2\\cdot(-0.1) + 2\\cdot(-0.1) + (-0.198)\\right) = 1 + \\frac{1}{30}\\cdot(-0.598) = \\frac{14701}{15000}.\n$$\n\n能量为 $E = \\frac{1}{2}(x^{2} + v^{2})$。初始时，\n$$\nE_{0} = \\frac{1}{2}(0^{2} + 1^{2}) = \\frac{1}{2}.\n$$\n经过一个 RK4 步后，\n$$\nx_{1}^{2} = \\frac{22201}{562500} = \\frac{8880400}{225000000},\\quad v_{1}^{2} = \\frac{216119401}{225000000},\n$$\n所以\n$$\nE_{1} = \\frac{1}{2}\\left(x_{1}^{2} + v_{1}^{2}\\right) = \\frac{1}{2}\\cdot\\frac{224999801}{225000000} = \\frac{224999801}{450000000}.\n$$\n因此，\n$$\n|E_{1} - E_{0}| = \\left|\\frac{224999801}{450000000} - \\frac{1}{2}\\right| = \\frac{199}{450000000},\n$$\n且相对误差为\n$$\n\\frac{|E_{1} - E_{0}|}{E_{0}} = \\frac{\\frac{199}{450000000}}{\\frac{1}{2}} = \\frac{199}{225000000} \\approx 8.844444\\ldots \\times 10^{-7}.\n$$\n四舍五入到四位有效数字，得到 $8.844 \\times 10^{-7}$。", "answer": "$$\\boxed{8.844 \\times 10^{-7}}$$", "id": "2158985"}, {"introduction": "现实世界的问题常常涉及行为剧烈变化的解，可能从缓慢变化到急剧变化甚至出现奇异点。在这种情况下，使用固定的步长是低效的。本问题深入探讨了自适应步长控制背后的理论，探索像龙格-库塔-费尔贝格 (RKF45) 这样的方法在接近已知奇异点时如何智能地调整其步长以保持精度，展示了现代高效常微分方程求解器的核心原理 [@problem_id:2158951]。", "problem": "一种自适应步长的数值方法被用于求解如下给出的常微分方程（ODE）初值问题：\n$$y'(t) = 1 + [y(t)]^2, \\quad y(0) = 0$$\n已知该问题的解析解为 $y(t) = \\tan(t)$，它在 $t_s = \\pi/2$ 处表现出有限时间奇异性（爆破）。\n\n该数值求解器基于 Runge-Kutta-Fehlberg 4(5) (RKF45) 方法。此方法同时计算解的两种近似，一种具有四阶精度，另一种具有五阶精度。这两种近似之差为四阶方法的局部截断误差提供了一个估计。对于步长 $h$，已知该误差估计与 $h^5 |y^{(5)}(t)|$ 成正比，其中 $y^{(5)}(t)$ 是精确解的五阶导数。求解器的步长控制算法在每一步调整 $h$，以使该估计误差大致保持恒定，并等于一个预定义的容差。\n\n当数值积分接近 $t_s$ 处的奇点时，步长 $h$ 必须急剧减小以维持所需的精度。据推测，对于接近 $t_s$ 的时间 $t$，在时间 $t$ 采取的步长 $h$ 与到奇点的距离 $(t_s - t)$ 遵循以下幂律关系进行缩放：\n$$h \\approx C (t_s - t)^k$$\n其中 $C$ 为某个常数，$k$ 为缩放指数。\n\n假设此缩放模型是准确的，确定指数 $k$ 的理论值。请将您的答案表示为保留三位有效数字的小数。", "solution": "RKF45 控制器使四阶解的估计局部误差约等于一个规定的容差。如题所述，在时间 $t$ 处，步长为 $h$ 的误差估计的缩放关系如下\n$$\nE(t,h) \\sim K\\, h^{5}\\, |y^{(5)}(t)|,\n$$\n其中 $K0$ 为某个常数。强制 $E(t,h)\\approx \\text{tol}$ 可得\n$$\nh^{5}\\, |y^{(5)}(t)| \\sim \\text{const} \\quad \\Longrightarrow \\quad h \\sim \\left(\\text{const}\\right)^{1/5}\\, |y^{(5)}(t)|^{-1/5}.\n$$\n因此，步长的缩放由 $t \\to t_{s}^{-}$ 时 $|y^{(5)}(t)|$ 的渐近行为决定。\n\n对于精确解 $y(t)=\\tan t$ 和 $t_{s}=\\frac{\\pi}{2}$，设 $\\delta=t_{s}-t$。使用三角展开，\n$$\n\\cos t=\\cos(t_{s}-\\delta)=\\sin \\delta \\sim \\delta, \\qquad \\sin t=\\sin(t_{s}-\\delta)=\\cos \\delta \\sim 1,\n$$\n所以\n$$\ny(t)=\\tan t=\\frac{\\sin t}{\\cos t} \\sim \\frac{1}{\\delta}=\\frac{1}{t_{s}-t}.\n$$\n对 $\\delta^{-1}$ 重复求导，通过归纳法可得\n$$\n\\frac{d^{n}}{dt^{n}}\\left(\\delta^{-1}\\right)=n!\\,\\delta^{-(n+1)},\n$$\n结果相差一个整体符号，但在绝对值下无关紧要。因此，\n$$\n|y^{(5)}(t)| \\sim 5!\\, (t_{s}-t)^{-6}.\n$$\n将此代入步长关系式可得\n$$\nh \\sim \\left(\\text{const}\\right)^{1/5}\\, \\left[(t_{s}-t)^{-6}\\right]^{-1/5} = C\\,(t_{s}-t)^{6/5},\n$$\n其中 $C0$ 为某个常数。因此，缩放指数为\n$$\nk=\\frac{6}{5}=1.20.\n$$", "answer": "$$\\boxed{1.20}$$", "id": "2158951"}]}