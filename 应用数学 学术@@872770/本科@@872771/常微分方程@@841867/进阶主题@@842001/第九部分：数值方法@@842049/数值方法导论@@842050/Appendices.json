{"hands_on_practices": [{"introduction": "数值方法的核心思想是用一系列离散的步骤来近似微分方程的连续解。最基础的方法是欧拉法，它分为前向（显式）和后向（隐式）两种形式。这个练习将带你亲手计算并比较这两种方法在同一步长下产生的差异，从而直观地理解显式和隐式方法在求解策略上的根本不同。[@problem_id:2181217]", "problem": "某个物理过程的简化模型由一阶常微分方程 $\\frac{dy}{dx} = -2y$ 描述，初始条件为 $y(0) = 1$。我们进行数值分析以近似计算在 $x=0.1$ 处 $y$ 的值。使用了两种不同的方法，每种方法均采用步长为 $h=0.1$ 的单步计算。\n\n第一个近似值，记为 $y_{F}$，是使用前向（显式）Euler方法计算的。\n第二个近似值，记为 $y_{B}$，是使用后向（隐式）Euler方法计算的。\n\n计算这两个数值近似值之间的绝对差 $|y_{F} - y_{B}|$。将最终答案四舍五入到三位有效数字。", "solution": "我们给定的初值问题为 $y^{\\prime}=-2y$，初始条件为 $y(0)=1$，步长为 $h=0.1$。定义 $f(x,y)=-2y$。我们通过前向和后向Euler方法寻求 $y(0.1)$ 的单步近似值，然后计算其绝对差。\n\n根据定义，单步前向（显式）Euler方法为\n$$\ny_{1}=y_{0}+h\\,f(x_{0},y_{0}).\n$$\n代入 $f(x,y)=-2y$ 可得\n$$\ny_{F}=y_{1}=y_{0}+h(-2y_{0})=y_{0}(1-2h).\n$$\n当 $y_{0}=1$ 且 $h=0.1=\\frac{1}{10}$ 时，\n$$\ny_{F}=1\\cdot\\left(1-2\\cdot\\frac{1}{10}\\right)=1-\\frac{1}{5}=\\frac{4}{5}=0.8.\n$$\n\n根据定义，单步后向（隐式）Euler方法为\n$$\ny_{1}=y_{0}+h\\,f(x_{1},y_{1}).\n$$\n代入 $f(x,y)=-2y$ 可得\n$$\ny_{1}=y_{0}-2h\\,y_{1}\\quad\\Rightarrow\\quad (1+2h)y_{1}=y_{0}\\quad\\Rightarrow\\quad y_{B}=y_{1}=\\frac{y_{0}}{1+2h}.\n$$\n当 $y_{0}=1$ 且 $h=0.1=\\frac{1}{10}$ 时，\n$$\ny_{B}=\\frac{1}{1+2\\cdot\\frac{1}{10}}=\\frac{1}{1+\\frac{1}{5}}=\\frac{1}{\\frac{6}{5}}=\\frac{5}{6}\\approx 0.833\\overline{3}.\n$$\n\n绝对差为\n$$\n|y_{F}-y_{B}|=\\left|\\frac{4}{5}-\\frac{5}{6}\\right|=\\left|\\frac{24-25}{30}\\right|=\\frac{1}{30}=0.0333\\overline{3}.\n$$\n四舍五入到三位有效数字，得到 $0.0333$。", "answer": "$$\\boxed{0.0333}$$", "id": "2181217"}, {"introduction": "虽然欧拉法简单易懂，但其精度有限。为了获得更准确的结果，我们通常采用更高阶的方法，其中四阶龙格-库塔法（RK4）是最常用和最可靠的方法之一。通过在一个化学反应模型中应用RK4，你将体验到该方法如何通过在步长内部进行多次“探测”来显著提高单步计算的精度。[@problem_id:2181234]", "problem": "在间歇式反应器中，化学反应物浓度（用 $C(t)$ 表示）会随着时间 $t$ 的推移而减少。该减少速率由一个二阶反应动力学模型控制。此过程可由以下微分方程描述：\n$$\n\\frac{dC}{dt} = -k C^{2}\n$$\n其中 $C$ 是浓度，单位为摩尔/升 (mol/L)，$t$ 是时间，单位为秒 (s)。该反应的速率常数已知为 $k = 0.5 \\text{ L mol}^{-1}\\text{s}^{-1}$。在反应开始时，即 $t=0$ 时，测得反应物的初始浓度为 $C(0) = 1.0 \\text{ mol/L}$。\n\n您的任务是使用数值方法估算稍后某一时刻反应物的浓度。具体来说，请应用经典的四阶龙格-库塔(RK4)方法，在单个时间步长后近似计算浓度 $C(t)$。使用大小为 $h = 0.2$ s 的时间步长。\n\n计算近似浓度 $C(0.2)$。以 mol/L 为单位表示您的答案，并四舍五入到四位有效数字。", "solution": "我们已知以下初值问题\n$$\n\\frac{dC}{dt}=f(t,C)=-k C^{2}, \\quad C(0)=C_{0}, \\quad k=0.5, \\quad C_{0}=1.0,\n$$\n并且我们要使用步长 $h=0.2$ 的经典龙格-库塔(RK4)方法，通过一个步骤来近似计算 $C(0.2)$。\n\nRK4 的更新公式为\n$$\nC_{1}=C_{0}+\\frac{h}{6}\\left(K_{1}+2K_{2}+2K_{3}+K_{4}\\right),\n$$\n其中\n$$\nK_{1}=f(t_{0},C_{0}), \\quad K_{2}=f\\left(t_{0}+\\frac{h}{2},\\,C_{0}+\\frac{h}{2}K_{1}\\right),\n$$\n$$\nK_{3}=f\\left(t_{0}+\\frac{h}{2},\\,C_{0}+\\frac{h}{2}K_{2}\\right), \\quad K_{4}=f\\left(t_{0}+h,\\,C_{0}+h K_{3}\\right).\n$$\n\n当 $f(t,C)=-k C^{2}$ 且 $t_{0}=0$, $C_{0}=1$, $h=0.2$, $k=0.5$ 时：\n\n1) 计算 $K_{1}$：\n$$\nK_{1}=-k C_{0}^{2}=-0.5\\cdot(1)^{2}=-0.5.\n$$\n\n2) 使用 $C_{0}+\\frac{h}{2}K_{1}=1+\\frac{0.2}{2}(-0.5)=1-0.05=0.95$ 计算 $K_{2}$：\n$$\nK_{2}=-k\\,(0.95)^{2}=-0.5\\cdot 0.9025=-0.45125.\n$$\n\n3) 使用 $C_{0}+\\frac{h}{2}K_{2}=1+\\frac{0.2}{2}(-0.45125)=1-0.045125=0.954875$ 计算 $K_{3}$：\n$$\nK_{3}=-k\\,(0.954875)^{2}=-0.5\\cdot 0.911786265625=-0.4558931328125.\n$$\n\n4) 使用 $C_{0}+h K_{3}=1+0.2(-0.4558931328125)=1-0.0911786265625=0.9088213734375$ 计算 $K_{4}$：\n$$\nK_{4}=-k\\,(0.9088213734375)^{2}=-0.5\\cdot 0.8259562888168238=-0.4129781444084119.\n$$\n\n合并增量：\n$$\nK_{1}+2K_{2}+2K_{3}+K_{4}=-0.5-0.9025-0.911786265625-0.4129781444084119=-2.727264410033412.\n$$\n当 $\\frac{h}{6}=\\frac{0.2}{6}=\\frac{1}{30}$ 时，更新值为\n$$\nC_{1}=1+\\frac{1}{30}\\left(-2.727264410033412\\right)=1-0.0909088136677804=0.9090911863322196.\n$$\n\n四舍五入到四位有效数字，RK4 近似值为 $0.9091$ mol/L。", "answer": "$$\\boxed{0.9091}$$", "id": "2181234"}, {"introduction": "在模拟物理系统时，仅仅追求数值上的准确性有时是不够的；我们还希望数值解能够保持系统固有的物理性质，例如能量守恒。这个问题将通过一个简谐振子模型，揭示标准欧拉法和一种称为辛欧拉法（或半隐式欧拉法）的特殊方法在长期能量保持上的巨大差异。这将让你领会到，选择合适的数值积分器对于保证模拟的物理真实性至关重要。[@problem_id:2181225]", "problem": "一个质量为 $m=1.0$ kg 的质点与一根弹簧常数为 $k=1.0$ N/m 的理想弹簧相连。该质点被约束在 x 轴上进行一维运动。这个系统表现为简谐振子，其在任意时刻 $t$ 的状态可以用其位置 $x(t)$ 和速度 $v(t)$ 来描述。运动方程构成一个一阶常微分方程组：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\frac{k}{m}x\n$$\n我们希望使用一个固定的时间步长 $h$ 来数值近似该质点的轨迹。我们将比较两种不同的数值积分方案：标准的前向欧拉法和辛欧拉（或半隐式欧拉）法。\n\n设 $(x_n, v_n)$ 为系统在时间 $t_n = n \\cdot h$ 的状态。\n\nA. **前向欧拉（FE）法：** 下一个时间步的状态 $(x_{n+1}, v_{n+1})$ 计算如下：\n$$\nx_{n+1} = x_n + h v_n\n$$\n$$\nv_{n+1} = v_n - h \\frac{k}{m} x_n\n$$\n\nB. **辛欧拉（SE）法：** 下一个时间步的状态 $(x_{n+1}, v_{n+1})$ 按顺序计算如下：\n$$\nv_{n+1} = v_n - h \\frac{k}{m} x_n\n$$\n$$\nx_{n+1} = x_n + h v_{n+1}\n$$\n\n系统的总机械能由 $E = \\frac{1}{2}mv^2 + \\frac{1}{2}kx^2$ 给出。对于理想振子，该能量应该是守恒的。\n\n假设系统从初始位置 $x(0) = 1.0$ m 和 $v(0) = 0$ m/s 静止开始。使用时间步长 $h=0.1$ s，对前向欧拉法和辛欧拉法都执行两个完整的积分步骤（以求得在 $t_2=0.2$ s 时的状态）。\n\n计算两种方法的最终能量与初始能量之比 $E_2/E_0$。设这些比值分别为 $R_{FE}$ 和 $R_{SE}$。在你的答案中提供这两个值 $(R_{FE}, R_{SE})$。将你的最终答案四舍五入到四位有效数字。", "solution": "首先，我们确定给定的参数和初始条件。\n质点质量，$m = 1.0$ kg。\n弹簧常数，$k = 1.0$ N/m。\n初始位置，$x_0 = 1.0$ m。\n初始速度，$v_0 = 0$ m/s。\n时间步长，$h = 0.1$ s。\n\n角频率的平方为 $\\omega^2 = \\frac{k}{m} = \\frac{1.0}{1.0} = 1.0 \\text{ s}^{-2}$。\n系统的总能量为 $E = \\frac{1}{2}mv^2 + \\frac{1}{2}kx^2$。\n\n我们首先计算在时间 $t=0$ 时的初始能量 $E_0$。\n$$\nE_0 = \\frac{1}{2}m v_0^2 + \\frac{1}{2}k x_0^2 = \\frac{1}{2}(1.0)(0)^2 + \\frac{1}{2}(1.0)(1.0)^2 = 0.5 \\text{ J}\n$$\n\n现在，我们对每种方法执行两个积分步骤。\n\n**第一部分：前向欧拉（FE）法**\n\n更新规则是 $x_{n+1} = x_n + h v_n$ 和 $v_{n+1} = v_n - h \\omega^2 x_n$。\n\n*   **第 1 步（从 n=0 到 n=1）：**\n    我们从 $(x_0, v_0) = (1.0, 0)$ 计算 $(x_1, v_1)$。\n    $$\n    x_1 = x_0 + h v_0 = 1.0 + (0.1)(0) = 1.0 \\text{ m}\n    $$\n    $$\n    v_1 = v_0 - h \\omega^2 x_0 = 0 - (0.1)(1.0)(1.0) = -0.1 \\text{ m/s}\n    $$\n\n*   **第 2 步（从 n=1 到 n=2）：**\n    我们从 $(x_1, v_1) = (1.0, -0.1)$ 计算 $(x_2, v_2)$。\n    $$\n    x_2 = x_1 + h v_1 = 1.0 + (0.1)(-0.1) = 1.0 - 0.01 = 0.99 \\text{ m}\n    $$\n    $$\n    v_2 = v_1 - h \\omega^2 x_1 = -0.1 - (0.1)(1.0)(1.0) = -0.1 - 0.1 = -0.2 \\text{ m/s}\n    $$\n\n现在，我们使用状态 $(x_2, v_2) = (0.99, -0.2)$ 计算在 $t_2 = 0.2$ s 时的能量 $E_{FE, 2}$。\n$$\nE_{FE, 2} = \\frac{1}{2}m v_2^2 + \\frac{1}{2}k x_2^2 = \\frac{1}{2}(1.0)(-0.2)^2 + \\frac{1}{2}(1.0)(0.99)^2\n$$\n$$\nE_{FE, 2} = \\frac{1}{2}(0.04) + \\frac{1}{2}(0.9801) = 0.02 + 0.49005 = 0.51005 \\text{ J}\n$$\n前向欧拉法的能量比为：\n$$\nR_{FE} = \\frac{E_{FE, 2}}{E_0} = \\frac{0.51005}{0.5} = 1.0201\n$$\n\n**第二部分：辛欧拉（SE）法**\n\n更新规则是 $v_{n+1} = v_n - h \\omega^2 x_n$ 和 $x_{n+1} = x_n + h v_{n+1}$。\n\n*   **第 1 步（从 n=0 到 n=1）：**\n    我们从 $(x_0, v_0) = (1.0, 0)$ 计算 $(x_1, v_1)$。\n    $$\n    v_1 = v_0 - h \\omega^2 x_0 = 0 - (0.1)(1.0)(1.0) = -0.1 \\text{ m/s}\n    $$\n    $$\n    x_1 = x_0 + h v_1 = 1.0 + (0.1)(-0.1) = 1.0 - 0.01 = 0.99 \\text{ m}\n    $$\n\n*   **第 2 步（从 n=1 到 n=2）：**\n    我们从 $(x_1, v_1) = (0.99, -0.1)$ 计算 $(x_2, v_2)$。\n    $$\n    v_2 = v_1 - h \\omega^2 x_1 = -0.1 - (0.1)(1.0)(0.99) = -0.1 - 0.099 = -0.199 \\text{ m/s}\n    $$\n    $$\n    x_2 = x_1 + h v_2 = 0.99 + (0.1)(-0.199) = 0.99 - 0.0199 = 0.9701 \\text{ m}\n    $$\n\n现在，我们使用状态 $(x_2, v_2) = (0.9701, -0.199)$ 计算在 $t_2 = 0.2$ s 时的能量 $E_{SE, 2}$。\n$$\nE_{SE, 2} = \\frac{1}{2}m v_2^2 + \\frac{1}{2}k x_2^2 = \\frac{1}{2}(1.0)(-0.199)^2 + \\frac{1}{2}(1.0)(0.9701)^2\n$$\n$$\nE_{SE, 2} = \\frac{1}{2}(0.039601) + \\frac{1}{2}(0.94109401) = \\frac{1}{2}(0.039601 + 0.94109401) = \\frac{1}{2}(0.98069501) = 0.490347505 \\text{ J}\n$$\n辛欧拉法的能量比为：\n$$\nR_{SE} = \\frac{E_{SE, 2}}{E_0} = \\frac{0.490347505}{0.5} = 0.98069501\n$$\n\n**最后一步：四舍五入**\n\n题目要求将最终答案四舍五入到四位有效数字。\n$R_{FE} = 1.0201 \\approx 1.020$\n$R_{SE} = 0.98069501 \\approx 0.9807$\n\n最终答案是数对 $(R_{FE}, R_{SE})$。", "answer": "$$\\boxed{(1.020, 0.9807)}$$", "id": "2181225"}]}