{"hands_on_practices": [{"introduction": "我们实践的第一步是直接构造影响函数。这个练习将指导你为一个简单的一维系统（一端固定、另一端自由的弦）推导格林函数。通过分段求解常微分方程并应用边界和连接条件，你将掌握构建影响函数的核心技术 [@problem_id:2144325]。", "problem": "考虑定义在区间 $[0, L]$ 上的函数的线性微分算子 $\\mathcal{L} = \\frac{d^2}{dx^2}$。对于此算子和一组边界条件，其影响函数（也称为格林函数）$G(x, \\xi)$ 定义为以下微分方程的解：\n$$\n\\mathcal{L}[G(x, \\xi)] = \\delta(x-\\xi)\n$$\n其中 $x, \\xi \\in (0, L)$，$\\delta(x-\\xi)$ 表示狄拉克δ函数，即在位置 $\\xi$ 处的一个单位脉冲。\n\n从物理上看，影响函数描述了系统在位置 $x$ 对施加在位置 $\\xi$ 的单位点源的响应。对于任何给定的系统，影响函数必须满足系统的齐次边界条件。\n\n您的任务是确定在区间 $[0, L]$ 上，算子 $\\mathcal{L} = \\frac{d^2}{dx^2}$ 的影响函数 $G(x, \\xi)$。作为 $x$ 的函数，$G(x, \\xi)$ 必须满足对应于一端固定、另一端自由的系统的边界条件：\n1.  $x=0$ 处为固定端：$G(0, \\xi) = 0$\n2.  $x=L$ 处为自由端：$\\frac{\\partial G}{\\partial x}(L, \\xi) = 0$\n\n请以分段函数的形式给出您的最终答案，分别定义在 $0 \\le x  \\xi$ 和 $\\xi  x \\le L$ 两种情况下的表达式。", "solution": "问题是求解满足微分方程 $\\frac{d^2G}{dx^2} = \\delta(x-\\xi)$ 以及边界条件 $G(0, \\xi) = 0$ 和 $\\frac{\\partial G}{\\partial x}(L, \\xi) = 0$ 的函数 $G(x, \\xi)$。\n\n首先，我们在 $x \\neq \\xi$ 的区域求解齐次方程 $\\frac{d^2G}{dx^2} = 0$。其通解是关于 $x$ 的线性函数。我们必须为由点源 $\\xi$ 分隔开的两个区域分段定义解。\n设解为\n$$\nG(x, \\xi) = \\begin{cases} G_1(x, \\xi) = A_1 x + B_1  0 \\le x  \\xi \\\\ G_2(x, \\xi) = A_2 x + B_2  \\xi  x \\le L \\end{cases}\n$$\n这里，系数 $A_1, B_1, A_2, B_2$ 相对于 $x$ 是常数，但可能依赖于 $\\xi$。\n\n接下来，我们应用两个边界条件。\n第一个边界条件在 $x=0$ 处，$G(0, \\xi) = 0$。这适用于第一段解 $G_1(x, \\xi)$。\n$$\nG_1(0, \\xi) = A_1(0) + B_1 = 0 \\implies B_1 = 0\n$$\n因此，解的第一部分简化为 $G_1(x, \\xi) = A_1 x$。\n\n第二个边界条件在 $x=L$ 处，$\\frac{\\partial G}{\\partial x}(L, \\xi) = 0$。这适用于第二段解 $G_2(x, \\xi)$。首先，我们求导数：$\\frac{dG_2}{dx} = A_2$。\n$$\n\\frac{dG_2}{dx}(L, \\xi) = A_2 = 0\n$$\n因此，解的第二部分简化为 $G_2(x, \\xi) = B_2$。\n\n我们的解现在的形式是：\n$$\nG(x, \\xi) = \\begin{cases} A_1 x  0 \\le x  \\xi \\\\ B_2  \\xi  x \\le L \\end{cases}\n$$\n我们需要另外两个条件来确定剩下的两个系数 $A_1(\\xi)$ 和 $B_2(\\xi)$。这些条件施加在 $x=\\xi$ 处。\n\n在 $x=\\xi$ 处的第一个条件是影响函数必须是连续的：\n$$\nG_1(\\xi, \\xi) = G_2(\\xi, \\xi)\n$$\n$$\nA_1 \\xi = B_2\n$$\n这使我们能够用 $A_1$ 表示 $B_2$，从而减少未知数的数量。解变为：\n$$\nG(x, \\xi) = \\begin{cases} A_1 x  0 \\le x  \\xi \\\\ A_1 \\xi  \\xi  x \\le L \\end{cases}\n$$\n在 $x=\\xi$ 处的第二个条件描述了 $G(x, \\xi)$ 导数的跳跃，这可以通过对原始微分方程在δ函数周围积分得到：\n$$\n\\int_{\\xi-\\epsilon}^{\\xi+\\epsilon} \\frac{d^2G}{dx^2} \\, dx = \\int_{\\xi-\\epsilon}^{\\xi+\\epsilon} \\delta(x-\\xi) \\, dx\n$$\nδ函数的积分为1。二阶导数的积分给出了一阶导数的跳跃：\n$$\n\\left[ \\frac{dG}{dx} \\right]_{x=\\xi-\\epsilon}^{x=\\xi+\\epsilon} = \\frac{dG}{dx}\\bigg|_{x=\\xi^+} - \\frac{dG}{dx}\\bigg|_{x=\\xi^-} = 1\n$$\n我们为我们的解的形式计算导数：\n对于 $x > \\xi$，$\\frac{dG}{dx} = \\frac{dG_2}{dx} = \\frac{d}{dx}(A_1 \\xi) = 0$。\n对于 $x  \\xi$，$\\frac{dG}{dx} = \\frac{dG_1}{dx} = \\frac{d}{dx}(A_1 x) = A_1$。\n将这些代入跳跃条件：\n$$\n0 - A_1 = 1 \\implies A_1 = -1\n$$\n现在我们找到了 $A_1$ 的值。利用连续性条件，我们也可以求出 $B_2$：\n$$\nB_2 = A_1 \\xi = (-1)\\xi = -\\xi\n$$\n最后，我们将确定的系数代回到 $G(x, \\xi)$ 的分段表达式中：\n$$\nG(x, \\xi) = \\begin{cases} -x  0 \\le x \\le \\xi \\\\ -\\xi  \\xi \\le x \\le L \\end{cases}\n$$\n这就是影响函数的完整表达式。这也可以紧凑地写成 $G(x, \\xi) = -\\min(x, \\xi)$。", "answer": "$$\n\\boxed{\\begin{cases} -x  0 \\le x \\le \\xi \\\\ -\\xi  \\xi \\le x \\le L \\end{cases}}\n$$", "id": "2144325"}, {"introduction": "除了直接构造，我们还可以利用微分算子的谱特性（即其特征函数）来表示影响函数。这个练习将向你展示如何使用特征函数展开法，为两端固定的弦找到影响函数。这种方法不仅优雅，而且深刻地揭示了影响函数与傅里叶分析及Sturm-Liouville理论之间的联系 [@problem_id:2144332]。", "problem": "考虑一个一维边值问题，该问题模拟了长度为 $L$、两端固定的弦在分布式横向载荷 $f(x)$ 作用下的静态偏转 $u(x)$。其控制微分方程由下式给出：\n$$-\\frac{d^2u}{dx^2} = f(x), \\quad \\text{for } x \\in (0, L)$$\n边界条件为齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(L) = 0$。\n该问题的解可以写成积分形式：\n$$u(x) = \\int_{0}^{L} G(x, \\xi) f(\\xi) \\, d\\xi$$\n这个核函数 $G(x, \\xi)$ 是该系统的影响函数。它描述了在位置 $x$ 处对位于位置 $\\xi$ 的单位点载荷的响应。\n\n请确定影响函数 $G(x, \\xi)$，并将其表示为包含三角函数的无穷级数。", "solution": "我们寻求满足以下条件的格林函数 $G(x,\\xi)$：\n$$-\\,\\frac{d^{2}}{dx^{2}}G(x,\\xi)=\\delta(x-\\xi),\\quad G(0,\\xi)=0,\\quad G(L,\\xi)=0.$$\n考虑在 $(0,L)$ 上具有齐次狄利克雷边界条件的自伴斯图姆-刘维尔算子 $L[u]= -u''$。其特征值问题\n$$-\\,\\phi_{n}''(x)=\\lambda_{n}\\phi_{n}(x),\\quad \\phi_{n}(0)=0,\\quad \\phi_{n}(L)=0$$\n其特征对为\n$$\\phi_{n}(x)=\\sin\\!\\left(\\frac{n\\pi x}{L}\\right),\\quad \\lambda_{n}=\\left(\\frac{n\\pi}{L}\\right)^{2},\\quad n\\in\\mathbb{N}.$$\n将特征函数归一化，以获得 $L^{2}(0,L)$ 中的一个标准正交基：\n$$\\varphi_{n}(x)=\\sqrt{\\frac{2}{L}}\\,\\sin\\!\\left(\\frac{n\\pi x}{L}\\right),\\quad \\int_{0}^{L}\\varphi_{n}(x)\\varphi_{m}(x)\\,dx=\\delta_{nm}.$$\n对于具有此完备标准正交集的自伴算子，格林函数具有谱表示\n$$G(x,\\xi)=\\sum_{n=1}^{\\infty}\\frac{\\varphi_{n}(x)\\varphi_{n}(\\xi)}{\\lambda_{n}}.$$\n代入 $\\varphi_{n}$ 和 $\\lambda_{n}$ 可得\n$$G(x,\\xi)=\\sum_{n=1}^{\\infty}\\frac{\\left(\\frac{2}{L}\\right)\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)\\sin\\!\\left(\\frac{n\\pi \\xi}{L}\\right)}{\\left(\\frac{n\\pi}{L}\\right)^{2}}=\\sum_{n=1}^{\\infty}\\frac{2L}{n^{2}\\pi^{2}}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)\\sin\\!\\left(\\frac{n\\pi \\xi}{L}\\right).$$\n此级数满足边界条件，因为每个正弦项在 $x=0$ 和 $x=L$ 处均为零，并且通过谱表示的构造，在应用 $-d^{2}/dx^{2}$ 后，它会产生所需的 $\\delta$ 源。", "answer": "$$\\boxed{\\sum_{n=1}^{\\infty}\\frac{2L}{n^{2}\\pi^{2}}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)\\sin\\!\\left(\\frac{n\\pi \\xi}{L}\\right)}$$", "id": "2144332"}, {"introduction": "理论概念最终需要在计算中得以实现。这个练习将连续的影响函数与离散的数值世界联系起来。通过对微分算子进行有限差分近似，你将发现，描述系统响应的离散影响函数（或格林矩阵）正是离散算子矩阵的逆 [@problem_id:2144302]。", "problem": "考虑一维线性微分算子 $L = -\\frac{d^2}{dx^2}$，其定义域为 $x \\in [0, 1]$，服从齐次狄利克雷边界条件，使得对于任何合适的函数 $u(x)$，都有 $u(0) = 0$ 和 $u(1) = 0$。\n\n我们可以用一个离散的线性方程组来近似连续问题 $Lu = f$。为此，我们将区间 $[0, 1]$ 离散化为一个均匀的网格，其点为 $x_i = ih$，其中 $i=0, 1, \\dots, N+1$，$N$ 是内部网格点的数量，$h = 1/(N+1)$ 是恒定的网格间距。令 $u_i = u(x_i)$ 且 $f_i = f(x_i)$。\n\n在每个内部网格点 $x_i$ (对于 $i=1, \\dots, N$) 处，算子 $L$ 作用于函数 $u$ 的行为可以用二阶中心有限差分公式来近似：\n$$ (Lu)_i \\approx \\frac{-u_{i-1} + 2u_i - u_{i+1}}{h^2} $$\n边界条件意味着 $u_0 = 0$ 和 $u_{N+1} = 0$。\n\n这种离散化将微分方程 $Lu=f$ 转换为一个 $N \\times N$ 的矩阵方程，形式为 $K\\mathbf{u} = \\mathbf{f}$，其中 $\\mathbf{u} = (u_1, u_2, \\dots, u_N)^T$ 且 $\\mathbf{f} = (f_1, f_2, \\dots, f_N)^T$。矩阵 $K$ 是算子 $L$ 的离散表示。\n\n这个线性系统的解可以形式上写为 $\\mathbf{u} = K^{-1}\\mathbf{f}$。矩阵 $G = K^{-1}$ 被称为该算子的离散影响函数（或离散格林函数）。\n\n求出元素 $G_{ij} = (K^{-1})_{ij}$ (其中 $1 \\le i, j \\le N$) 的闭式表达式。最终表达式应以索引 $i$、$j$ 和内部网格点数 $N$ 来表示。", "solution": "我们在内部节点 $i=1,\\dots,N$ 上，以间距 $h=\\frac{1}{N+1}$ 离散化 $L = -\\frac{d^{2}}{dx^{2}}$，得到线性系统 $K\\mathbf{u}=\\mathbf{f}$，其中\n$$\nK=\\frac{1}{h^{2}}A,\\qquad A=\\begin{pmatrix}\n2  -1  0  \\cdots  0\\\\\n-1  2  -1  \\ddots  \\vdots\\\\\n0  -1  \\ddots  \\ddots  0\\\\\n\\vdots  \\ddots  \\ddots  2  -1\\\\\n0  \\cdots  0  -1  2\n\\end{pmatrix}.\n$$\n离散格林矩阵为 $G=K^{-1}=h^{2}A^{-1}$。令 $g^{(j)}$ 表示 $G$ 的第 $j$ 列。它满足 $K g^{(j)}=e^{(j)}$，因此 $A g^{(j)}=h^{2}e^{(j)}$。等价地，令 $y^{(j)}=\\frac{1}{h^{2}}g^{(j)}$，它满足\n$$\n- y^{(j)}_{k-1} + 2 y^{(j)}_{k} - y^{(j)}_{k+1} = \\delta_{kj},\\qquad y^{(j)}_{0}=0,\\quad y^{(j)}_{N+1}=0.\n$$\n对于 $k\\neq j$，齐次递推关系 $-y_{k-1}+2y_{k}-y_{k+1}=0$ 意味着 $y_{k}$ 是 $k$ 的线性函数。因此，对于 $k\\leq j$ 令 $y_{k}=a k$ (利用 $y_{0}=0$)，对于 $k\\geq j$ 令 $y_{k}=b(N+1-k)$ (利用 $y_{N+1}=0$)。在 $k=j$ 处的连续性给出\n$$\na j = b (N+1 - j).\n$$\n在 $k=j$ 处的跳跃条件由下式得出\n$$\n- y_{j-1} + 2 y_{j} - y_{j+1} = 1 \\;\\;\\Longleftrightarrow\\;\\; (y_{j}-y_{j-1}) - (y_{j+1}-y_{j}) = 1,\n$$\n这得到 $(a) - (-b) = 1$，因此 $a+b=1$。解这两个方程得到\n$$\na = \\frac{N+1-j}{N+1},\\qquad b=\\frac{j}{N+1}.\n$$\n因此，\n$$\ny_{k}^{(j)} = \\begin{cases}\n\\dfrac{N+1-j}{N+1}\\,k,  k\\leq j\\\\\n\\dfrac{j}{N+1}\\,(N+1-k),  k\\geq j.\n\\end{cases}\n$$\n由于 $G=K^{-1}$ 的矩阵元素 $G_{kj}$ 与 $y_k^{(j)}$ 的关系为 $G_{kj} = h^2 y_k^{(j)}$，其中 $h=\\frac{1}{N+1}$，我们将已求得的 $y_k^{(j)}$ 代入：\n$$\nG_{kj} = \\frac{1}{(N+1)^2} \\times \\begin{cases} \\frac{k(N+1-j)}{N+1}  \\text{for } k \\le j \\\\ \\frac{j(N+1-k)}{N+1}  \\text{for } k \\ge j \\end{cases}\n$$\n这可以合并并化简为：\n$$\nG_{kj} = \\frac{\\min(k,j)(N+1-\\max(k,j))}{(N+1)^3}\n$$\n将索引换为 $i,j$ 即可得到最终答案。这就是对于 $1\\leq i,j\\leq N$ 的离散格林函数元素的闭式解。", "answer": "$$\\boxed{\\frac{\\min(i,j)\\left(N+1-\\max(i,j)\\right)}{(N+1)^{3}}}$$", "id": "2144302"}]}