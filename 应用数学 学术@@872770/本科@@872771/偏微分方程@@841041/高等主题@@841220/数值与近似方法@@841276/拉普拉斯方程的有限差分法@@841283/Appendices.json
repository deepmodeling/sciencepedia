{"hands_on_practices": [{"introduction": "将偏微分方程转化为代数方程组是有限差分法的核心。本练习将引导你处理一个带有狄利克雷边界条件的拉普拉斯方程，重点在于构建线性系统 $AU=b$ 中的向量 $b$，该向量体现了边界值对内部点的影响，这是建立数值模拟的第一步 ([@problem_id:2102015])。", "problem": "考虑一个方形板上的稳态热分布，由二维拉普拉斯方程 $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$ 描述。该板由单位正方形域 $\\Omega = [0, 1] \\times [0, 1]$ 表示。域边界上的温度 $u(x,y)$ 由以下狄利克雷条件给定：\n- $u(x, 0) = x$，$0 \\le x \\le 1$（下边界）\n- $u(x, 1) = 1$，$0 \\le x \\le 1$（上边界）\n- $u(0, y) = y$，$0 \\le y \\le 1$（左边界）\n- $u(1, y) = 0$，$0 \\le y \\le 1$（右边界）\n\n为了求解域内部 $u(x,y)$ 的近似解，我们采用有限差分法。该域在 $x$ 和 $y$ 方向上使用步长为 $h = 1/3$ 的均匀网格进行离散化。该离散化产生了一个包含四个内部点的 $2 \\times 2$ 网格。\n\n设网格点 $(x_i, y_j) = (ih, jh)$ 处温度 $u(x_i, y_j)$ 的近似值记为 $u_{i,j}$。对四个内部网格点中的每一个应用拉普拉斯算子的标准五点差分格式，得到一个形式为 $AU = b$ 的线性方程组。未知数向量 $U$ 包含四个内部点的温度近似值。未知数按字典序（从下到上，逐行）排列。如果网格点由 $(i,j)$ 索引，其中 $i \\in \\{0, 1, 2, 3\\}$ 是列索引，$j \\in \\{0, 1, 2, 3\\}$ 是行索引，那么内部点对应 $i,j \\in \\{1, 2\\}$。未知数向量的顺序为 $U = [u_{11}, u_{21}, u_{12}, u_{22}]^T$。\n\n确定该线性方程组的右端向量 $b$。请用列向量表示你的答案。", "solution": "我们使用标准的五点差分格式在内部节点求解离散拉普拉斯方程。对于每个内部点 $(i,j)$，其中 $i,j \\in \\{1,2\\}$，离散化形式为\n$$\n\\frac{u_{i-1,j} + u_{i+1,j} + u_{i,j-1} + u_{i,j+1} - 4u_{i,j}}{h^{2}} = 0.\n$$\n两边乘以 $h^{2}$（由于右侧为零，这不会改变右端项），并重新整理，将来自已知边界值的贡献分离到右侧，\n$$\n4u_{i,j} - \\sum_{\\text{interior neighbors}} u - \\sum_{\\text{boundary neighbors}} u = 0\n\\quad \\Longrightarrow \\quad\n4u_{i,j} - \\sum_{\\text{interior neighbors}} u = \\sum_{\\text{boundary neighbors}} u.\n$$\n因此，对于线性系统 $AU=b$，每个内部节点的右端项 $b$ 等于其相邻边界值之和。\n\n当 $h=1/3$ 时，网格点为 $x,y \\in \\{0, \\frac{1}{3}, \\frac{2}{3}, 1\\}$。内部节点及其邻点如下：\n\n1) 对于点 $(x,y)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的 $u_{11}$，其邻点为：\n- 左边界点 $(0,\\frac{1}{3})$: $u(0,\\frac{1}{3}) = \\frac{1}{3}$，\n- 右侧内部点 $u_{21}$，\n- 下边界点 $(\\frac{1}{3},0)$: $u(\\frac{1}{3},0) = \\frac{1}{3}$，\n- 上侧内部点 $u_{12}$。\n因此，\n$$\nb_{1} = u\\!\\left(0,\\tfrac{1}{3}\\right) + u\\!\\left(\\tfrac{1}{3},0\\right) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}.\n$$\n\n2) 对于点 $(x,y)=\\left(\\frac{2}{3},\\frac{1}{3}\\right)$ 处的 $u_{21}$，其邻点为：\n- 左侧内部点 $u_{11}$，\n- 右边界点 $(1,\\frac{1}{3})$: $u(1,\\frac{1}{3}) = 0$，\n- 下边界点 $(\\frac{2}{3},0)$: $u(\\frac{2}{3},0) = \\frac{2}{3}$，\n- 上侧内部点 $u_{22}$。\n因此，\n$$\nb_{2} = u\\!\\left(1,\\tfrac{1}{3}\\right) + u\\!\\left(\\tfrac{2}{3},0\\right) = 0 + \\frac{2}{3} = \\frac{2}{3}.\n$$\n\n3) 对于点 $(x,y)=\\left(\\frac{1}{3},\\frac{2}{3}\\right)$ 处的 $u_{12}$，其邻点为：\n- 左边界点 $(0,\\frac{2}{3})$: $u(0,\\frac{2}{3}) = \\frac{2}{3}$，\n- 右侧内部点 $u_{22}$，\n- 下侧内部点 $u_{11}$，\n- 上边界点 $(\\frac{1}{3},1)$: $u(\\frac{1}{3},1) = 1$。\n因此，\n$$\nb_{3} = u\\!\\left(0,\\tfrac{2}{3}\\right) + u\\!\\left(\\tfrac{1}{3},1\\right) = \\frac{2}{3} + 1 = \\frac{5}{3}.\n$$\n\n4) 对于点 $(x,y)=\\left(\\frac{2}{3},\\frac{2}{3}\\right)$ 处的 $u_{22}$，其邻点为：\n- 左侧内部点 $u_{12}$，\n- 右边界点 $(1,\\frac{2}{3})$: $u(1,\\frac{2}{3}) = 0$，\n- 下侧内部点 $u_{21}$，\n- 上边界点 $(\\frac{2}{3},1)$: $u(\\frac{2}{3},1) = 1$。\n因此，\n$$\nb_{4} = u\\!\\left(1,\\tfrac{2}{3}\\right) + u\\!\\left(\\tfrac{2}{3},1\\right) = 0 + 1 = 1.\n$$\n\n将未知数按 $U = [u_{11}, u_{21}, u_{12}, u_{22}]^{T}$ 排序，右端向量为\n$$\nb = \\begin{pmatrix}\n\\frac{2}{3} \\\\\n\\frac{2}{3} \\\\\n\\frac{5}{3} \\\\\n1\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{3}\\\\\\frac{2}{3}\\\\\\frac{5}{3}\\\\1\\end{pmatrix}}$$", "id": "2102015"}, {"introduction": "现实世界的问题常常涉及对边界上变化率的约束，例如热通量或绝缘边界，这被称为诺伊曼边界条件。本练习介绍一种处理这类导数边界条件的强大技巧——“镜像点法”，它通过在求解域外部引入虚拟点，巧妙地将边界条件融入离散格式中 ([@problem_id:2102030])。掌握这种方法将大大扩展你解决物理和工程问题的能力。", "problem": "一块薄的方形金属板被建模为热管理系统中的一个组件。对于稳态热分析，板上的温度分布 $T(x, y)$ 由二维拉普拉斯方程 $\\nabla^2 T = 0$ 控制。\n\n为了数值求解，该板被离散化为一个在 $x$ 和 $y$ 方向上间距均为 $h$ 的均匀网格。网格点 $(x_i, y_j) = (ih, jh)$ 处的温度用 $T_{i,j}$ 表示。我们关心的是 $i \\ge 0$ 和 $j \\ge 0$ 的区域。\n\n该板的边界条件如下：\n- 左边界，对应于直线 $x=0$（或网格索引 $i=0$），是热绝缘的。这意味着垂直于该边界的温度梯度为零。\n- 下边界，对应于直线 $y=0$（或网格索引 $j=0$），是均匀加热的。这导致垂直于该边界的温度梯度为一个非零常数，由关系式 $\\frac{\\partial T}{\\partial y} = -G$ 给出，其中 $G$ 是一个表示加热强度的正常数。\n\n您的任务是分析位于 $(i,j)=(0,0)$ 的角点。使用拉普拉斯算子的标准五点有限差分近似和边界导数的中心差分，推导温度 $T_{0,0}$ 的表达式。用区域内相邻节点 $T_{1,0}$ 和 $T_{0,1}$ 的温度、网格间距 $h$ 以及加热常数 $G$ 来表示您的答案。", "solution": "该问题要求在给定边界条件下，推导板角点处温度 $T_{0,0}$ 的表达式。我们将使用有限差分法。\n\n稳态温度分布由拉普拉斯方程控制：\n$$ \\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 0 $$\n\n我们使用五点中心差分格式在节点 $(i,j)=(0,0)$ 处近似这个偏微分方程。该近似为：\n$$ \\frac{T_{i+1,j} - 2T_{i,j} + T_{i-1,j}}{h^2} + \\frac{T_{i,j+1} - 2T_{i,j} + T_{i,j-1}}{h^2} = 0 $$\n在节点 $(0,0)$ 处，这变为：\n$$ \\frac{T_{1,0} - 2T_{0,0} + T_{-1,0}}{h^2} + \\frac{T_{0,1} - 2T_{0,0} + T_{0,-1}}{h^2} = 0 $$\n乘以 $h^2$，我们得到模板方程：\n$$ T_{1,0} + T_{-1,0} + T_{0,1} + T_{0,-1} - 4T_{0,0} = 0 $$\n该方程涉及两个“虚拟”节点 $T_{-1,0}$ 和 $T_{0,-1}$，它们位于物理域之外。我们必须使用边界条件来消除它们。\n\n首先，考虑在 $x=0$（或 $i=0$）处的热绝缘左边界。边界条件是 $\\frac{\\partial T}{\\partial x} = 0$。我们使用中心差分在节点 $(0,0)$ 处近似这个导数：\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{(0,0)} \\approx \\frac{T(h, 0) - T(-h, 0)}{2h} = \\frac{T_{1,0} - T_{-1,0}}{2h} = 0 $$\n这意味着 $T_{-1,0} = T_{1,0}$。\n\n接下来，考虑在 $y=0$（或 $j=0$）处的受热下边界。边界条件是 $\\frac{\\partial T}{\\partial y} = -G$。我们使用中心差分在节点 $(0,0)$ 处近似这个导数：\n$$ \\frac{\\partial T}{\\partial y}\\bigg|_{(0,0)} \\approx \\frac{T(0, h) - T(0, -h)}{2h} = \\frac{T_{0,1} - T_{0,-1}}{2h} = -G $$\n求解虚拟节点 $T_{0,-1}$，我们得到：\n$$ T_{0,1} - T_{0,-1} = -2hG $$\n$$ T_{0,-1} = T_{0,1} + 2hG $$\n\n现在，我们将虚拟节点 $T_{-1,0}$ 和 $T_{0,-1}$ 的表达式代回到模板方程中：\n$$ T_{1,0} + (T_{1,0}) + T_{0,1} + (T_{0,1} + 2hG) - 4T_{0,0} = 0 $$\n\n合并同类项以简化表达式：\n$$ 2T_{1,0} + 2T_{0,1} + 2hG - 4T_{0,0} = 0 $$\n\n问题要求 $T_{0,0}$ 的表达式。我们重新整理方程以求解 $T_{0,0}$：\n$$ 4T_{0,0} = 2T_{1,0} + 2T_{0,1} + 2hG $$\n\n最后，两边除以4，我们得到所需的 $T_{0,0}$ 表达式：\n$$ T_{0,0} = \\frac{2T_{1,0} + 2T_{0,1} + 2hG}{4} $$\n$$ T_{0,0} = \\frac{1}{2}(T_{1,0} + T_{0,1} + hG) $$\n该表达式给出了角点处的温度，用其在域内的相邻节点、网格间距和加热常数表示。", "answer": "$$\\boxed{\\frac{1}{2}(T_{1,0} + T_{0,1} + hG)}$$", "id": "2102030"}, {"introduction": "在建立线性方程组 $AU=b$ 后，下一步便是求解它。对于大规模网格，直接求解矩阵的逆在计算上非常昂贵，因此迭代法成为关键。本练习将让你体验雅可比方法，这是一种经典的迭代算法，它从一个初始猜测值开始，通过简单的计算步骤逐步逼近真实解 ([@problem_id:2102023])。这个实践将让你初步了解科学计算中用于求解大型线性系统的实用技术。", "problem": "考虑一个寻找薄方形金属板上稳态温度分布的问题。温度 $u$ 满足拉普拉斯方程。该金属板由一个方形区域表示，该区域被离散化为一个均匀网格，其整数索引为 $(i, j)$，其中 $i, j \\in \\{0, 1, 2, 3\\}$。其中 $i, j \\in \\{1, 2\\}$ 的点是网格的内部点，而边界上的点是那些满足 $i \\in \\{0, 3\\}$ 或 $j \\in \\{0, 3\\}$ 的点。\n\n每个内部点 $(i, j)$ 的温度使用五点有限差分格式进行近似，该格式表明该点的温度是其四个最近邻点温度的平均值。这将偏微分方程离散化为一个线性方程组。\n\n边界点上的温度（单位为摄氏度，尽管单位与计算无关）被固定如下（狄利克雷边界条件）：\n- 底边：$u_{i,0} = 20$，对于 $i = 1, 2$。\n- 顶边：$u_{i,3} = 60$，对于 $i = 1, 2$。\n- 左边：$u_{0,j} = 40$，对于 $j = 1, 2$。\n- 右边：$u_{3,j} = 0$，对于 $j = 1, 2$。\n\n你的任务是近似计算四个内部点 $u_{1,1}, u_{1,2}, u_{2,1}, u_{2,2}$ 的温度。你将使用雅可比方法来求解该线性方程组。从所有内部点的初始猜测为零开始，即 $u_{i,j}^{(0)} = 0$ 对于 $i,j \\in \\{1, 2\\}$，执行一次迭代以求得温度的第一次近似值。\n\n计算 $u_{1,1}^{(1)}, u_{1,2}^{(1)}, u_{2,1}^{(1)}$ 和 $u_{2,2}^{(1)}$ 的值。按此特定顺序将你的最终答案表示为一组四个数。", "solution": "均匀网格上内部节点 $(i,j)$ 处的离散拉普拉斯方程，采用五点格式为\n$$\nu_{i,j}=\\frac{1}{4}\\left(u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}\\right).\n$$\n使用雅可比方法，对所有内部点取初始猜测 $u_{i,j}^{(0)}=0$，并使用固定的狄利克雷边界值，雅可比迭代更新式为\n$$\nu_{i,j}^{(k+1)}=\\frac{1}{4}\\left(u_{i+1,j}^{(k)}+u_{i-1,j}^{(k)}+u_{i,j+1}^{(k)}+u_{i,j-1}^{(k)}\\right),\n$$\n其中边界值按给定值代入。\n\n计算一次迭代后每个内部点的值：\n\n对于 $(1,1)$：\n$$\nu_{1,1}^{(1)}=\\frac{1}{4}\\left(u_{2,1}^{(0)}+u_{0,1}+u_{1,2}^{(0)}+u_{1,0}\\right)=\\frac{1}{4}\\left(0+40+0+20\\right)=15.\n$$\n\n对于 $(1,2)$：\n$$\nu_{1,2}^{(1)}=\\frac{1}{4}\\left(u_{2,2}^{(0)}+u_{0,2}+u_{1,3}+u_{1,1}^{(0)}\\right)=\\frac{1}{4}\\left(0+40+60+0\\right)=25.\n$$\n\n对于 $(2,1)$：\n$$\nu_{2,1}^{(1)}=\\frac{1}{4}\\left(u_{3,1}+u_{1,1}^{(0)}+u_{2,2}^{(0)}+u_{2,0}\\right)=\\frac{1}{4}\\left(0+0+0+20\\right)=5.\n$$\n\n对于 $(2,2)$：\n$$\nu_{2,2}^{(1)}=\\frac{1}{4}\\left(u_{3,2}+u_{1,2}^{(0)}+u_{2,3}+u_{2,1}^{(0)}\\right)=\\frac{1}{4}\\left(0+0+60+0\\right)=15.\n$$\n\n因此，按 $(u_{1,1}^{(1)},u_{1,2}^{(1)},u_{2,1}^{(1)},u_{2,2}^{(1)})$ 的顺序，这些值为 $(15,25,5,15)$。", "answer": "$$\\boxed{\\begin{pmatrix} 15  25  5  15 \\end{pmatrix}}$$", "id": "2102023"}]}