{"hands_on_practices": [{"introduction": "Crank-Nicolson方法的核心在于将一个偏微分方程转化为在每个时间步长求解的一系列线性代数方程。这个练习将指导你完成最基本的一步：对于标准的一维热传导方程，如何构建其离散化后的矩阵系统 $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$。通过显式地写出系数矩阵 $A$ 和 $B$，你将对该方法的结构有更深入的理解。", "problem": "考虑一维热传导方程 $u_t = \\alpha u_{xx}$，其中函数 $u(x, t)$ 定义在空间域 $x \\in [0, L]$ 和时间 $t \\geq 0$ 上。该方程满足齐次狄利克雷边界条件 $u(0, t) = u(L, t) = 0$。\n\n我们希望使用 Crank-Nicolson 方法对该方程进行数值求解。空间域被离散化为一个间距为 $\\Delta x$ 的均匀网格，使得恰好有三个内部网格点。设 $\\Delta t$ 为时间步长。该方法得到一个形如 $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$ 的矩阵系统，其中 $\\mathbf{u}^{k}$ 是在时间步 $k$ 时三个内部网格点上数值解的列向量。\n\n设参数 $\\lambda$ 定义为 $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。\n\n以下哪个选项正确地标识了 $3 \\times 3$ 矩阵 $A$ 和 $B$？\n\nA. $A = \\begin{pmatrix} 1+\\lambda  & -\\frac{\\lambda}{2}  & 0 \\\\ -\\frac{\\lambda}{2}  & 1+\\lambda  & -\\frac{\\lambda}{2} \\\\ 0  & -\\frac{\\lambda}{2}  & 1+\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1-\\lambda  & \\frac{\\lambda}{2}  & 0 \\\\ \\frac{\\lambda}{2}  & 1-\\lambda  & \\frac{\\lambda}{2} \\\\ 0  & \\frac{\\lambda}{2}  & 1-\\lambda \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 1-\\lambda  & \\frac{\\lambda}{2}  & 0 \\\\ \\frac{\\lambda}{2}  & 1-\\lambda  & \\frac{\\lambda}{2} \\\\ 0  & \\frac{\\lambda}{2}  & 1-\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1+\\lambda  & -\\frac{\\lambda}{2}  & 0 \\\\ -\\frac{\\lambda}{2}  & 1+\\lambda  & -\\frac{\\lambda}{2} \\\\ 0  & -\\frac{\\lambda}{2}  & 1+\\lambda \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1  & 0  & 0 \\\\ 0  & 1  & 0 \\\\ 0  & 0  & 1 \\end{pmatrix}$, $B = \\begin{pmatrix} 1-2\\lambda  & \\lambda  & 0 \\\\ \\lambda  & 1-2\\lambda  & \\lambda \\\\ 0  & \\lambda  & 1-2\\lambda \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1+2\\lambda  & -\\lambda  & 0 \\\\ -\\lambda  & 1+2\\lambda  & -\\lambda \\\\ 0  & -\\lambda  & 1+2\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1  & 0  & 0 \\\\ 0  & 1  & 0 \\\\ 0  & 0  & 1 \\end{pmatrix}$", "solution": "我们用均匀间距 $\\Delta x$ 离散化空间区间，并用 $i=1,2,3$ 表示内部索引。齐次狄利克雷边界条件要求对所有 $n$ 都有 $u_{0}^{n}=0$ 和 $u_{4}^{n}=0$。\n\n设 $u_{i}^{n}$ 近似于 $u(x_{i}, t^{n})$。在内部点 $i$ 处，$u_{t}=\\alpha u_{xx}$ 的 Crank-Nicolson 离散化形式为\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}\n=\\frac{\\alpha}{2}\\left(\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{(\\Delta x)^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{(\\Delta x)^{2}}\\right).\n$$\n设 $\\lambda=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$，两边同乘以 $\\Delta t$ 得到\n$$\nu_{i}^{n+1}-u_{i}^{n}\n=\\frac{\\lambda}{2}\\left[(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n})+(u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1})\\right].\n$$\n重新整理，将未知的时间层 $n+1$ 的项收集到左边，时间层 $n$ 的项收集到右边，得到\n$$\n\\left(1+\\lambda\\right)u_{i}^{n+1}-\\frac{\\lambda}{2}u_{i+1}^{n+1}-\\frac{\\lambda}{2}u_{i-1}^{n+1}\n=\\left(1-\\lambda\\right)u_{i}^{n}+\\frac{\\lambda}{2}u_{i+1}^{n}+\\frac{\\lambda}{2}u_{i-1}^{n}.\n$$\n由于边界值为零，没有出现额外的边界项。将这个关于 $i=1,2,3$ 的系统写成矩阵形式 $A\\mathbf{u}^{n+1}=B\\mathbf{u}^{n}$，其中 $\\mathbf{u}^{k}=(u_{1}^{k},u_{2}^{k},u_{3}^{k})^{T}$，矩阵为\n$$\nA=\\begin{pmatrix}\n1+\\lambda  & -\\frac{\\lambda}{2}  & 0 \\\\\n-\\frac{\\lambda}{2}  & 1+\\lambda  & -\\frac{\\lambda}{2} \\\\\n0  & -\\frac{\\lambda}{2}  & 1+\\lambda\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1-\\lambda  & \\frac{\\lambda}{2}  & 0 \\\\\n\\frac{\\lambda}{2}  & 1-\\lambda  & \\frac{\\lambda}{2} \\\\\n0  & \\frac{\\lambda}{2}  & 1-\\lambda\n\\end{pmatrix}.\n$$\n这与选项 A 相符。", "answer": "$$\\boxed{A}$$", "id": "2139888"}, {"introduction": "实际物理问题往往比理想化的热传导方程更复杂，例如可能包含与环境的热交换。这个练习将带你将Crank-Nicolson方法应用于一个包含线性反应项（或热汇项）的反应-扩散方程。通过学习如何将这个额外的物理项整合到离散格式中，你将掌握将该方法推广到更广泛应用中的关键技能。", "problem": "考虑如下一维反应-扩散方程：\n$$ \\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - \\beta u $$\n该方程模拟了诸如杆中的热扩散过程，其中 $u(x,t)$ 是温度，$D$ 是热扩散系数，而项 $-\\beta u$（其中 $\\beta > 0$ 为常数）表示与局部温度成正比的向周围环境的热量损失。\n\n我们希望在空间域 $x \\in [0, L]$ 和时间 $t > 0$ 上，对该方程进行数值求解，其狄利克雷边界条件为 $u(0, t) = u(L, t) = 0$。该域使用均匀的空间步长 $\\Delta x$ 进行离散化，从而有 $M$ 个内部网格点 $x_j = j \\Delta x$，其中 $j = 1, 2, \\ldots, M$。时间使用均匀的步长 $\\Delta t$ 进行离散化，其中 $t_n = n \\Delta t$。在网格点 $j$ 和时间步 $n$ 处的温度的数值近似值记为 $u_j^n$。\n\n我们采用 Crank-Nicolson 方法来求解该方程。这种隐式时间步进格式是通过将有限差分近似中心化在半个时间步长 $t_{n+1/2} = t_n + \\Delta t / 2$ 处来构建的。由此得到的关于下一个时间步的未知温度 $\\mathbf{u}^{n+1} = [u_1^{n+1}, u_2^{n+1}, \\ldots, u_M^{n+1}]^T$ 的线性方程组可以写成矩阵形式：\n$$ A \\mathbf{u}^{n+1} = B \\mathbf{u}^{n} $$\n其中 $A$ 和 $B$ 是依赖于离散化参数的 $M \\times M$ 矩阵。\n\n设无量纲扩散数为 $r = \\frac{D \\Delta t}{(\\Delta x)^2}$。确定矩阵 $A$ 对于内部网格点 $j$（其中 $1  j  M$）的对角元素 $A_{j,j}$ 的值。请用 $r$ 和乘积 $\\beta \\Delta t$ 的解析表达式来表示你的答案。", "solution": "我们从反应-扩散方程 $u_{t} = D u_{xx} - \\beta u$ 开始，并在内部网格点 $j$ 处应用 Crank-Nicolson 方法：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n= \\frac{D}{2}\\left(\\frac{u_{j-1}^{n+1} - 2 u_{j}^{n+1} + u_{j+1}^{n+1}}{(\\Delta x)^{2}} + \\frac{u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}}{(\\Delta x)^{2}}\\right) - \\frac{\\beta}{2}\\left(u_{j}^{n+1} + u_{j}^{n}\\right).\n$$\n两边乘以 $\\Delta t$ 并引入 $r = \\frac{D \\Delta t}{(\\Delta x)^{2}}$，得到\n$$\nu_{j}^{n+1} - u_{j}^{n}\n= \\frac{r}{2}\\left(u_{j-1}^{n+1} - 2 u_{j}^{n+1} + u_{j+1}^{n+1} + u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}\\right) - \\frac{\\beta \\Delta t}{2}\\left(u_{j}^{n+1} + u_{j}^{n}\\right).\n$$\n将所有 $n+1$ 时刻的项收集到左边，得到\n$$\n\\left[1 + r + \\frac{\\beta \\Delta t}{2}\\right] u_{j}^{n+1} - \\frac{r}{2} u_{j-1}^{n+1} - \\frac{r}{2} u_{j+1}^{n+1}\n= \\frac{r}{2}\\left(u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}\\right) + \\left(1 - \\frac{\\beta \\Delta t}{2}\\right) u_{j}^{n} + u_j^n.\n$$\n在整理上式时，右侧的项应该是：\n$$\nu_j^n + \\frac{r}{2}(u_{j-1}^n - 2u_j^n + u_{j+1}^n) - \\frac{\\beta \\Delta t}{2}u_j^n = (1 - r - \\frac{\\beta \\Delta t}{2})u_j^n + \\frac{r}{2}u_{j-1}^n + \\frac{r}{2}u_{j+1}^n\n$$\n左侧的项是：\n$$\nu_j^{n+1} - \\frac{r}{2}(u_{j-1}^{n+1} - 2u_j^{n+1} + u_{j+1}^{n+1}) + \\frac{\\beta \\Delta t}{2}u_j^{n+1} = (1 + r + \\frac{\\beta \\Delta t}{2})u_j^{n+1} - \\frac{r}{2}u_{j-1}^{n+1} - \\frac{r}{2}u_{j+1}^{n+1}\n$$\n在矩阵形式 $A \\mathbf{u}^{n+1} = B \\mathbf{u}^{n}$ 中，系数 $A_{j,j}$ 是左侧乘以 $u_{j}^{n+1}$ 的系数。因此，对于一个内部点 $j$，\n$$\nA_{j,j} = 1 + r + \\frac{\\beta \\Delta t}{2}.\n$$\n这完全由 $r$ 和 $\\beta \\Delta t$ 表示，符合题目要求。", "answer": "$$\\boxed{1 + r + \\frac{\\beta \\Delta t}{2}}$$", "id": "2139830"}, {"introduction": "要真正掌握一个数值方法，不仅要了解其优点，更要认识其局限性。当初始条件存在阶跃等不连续性时，Crank-Nicolson方法的数值解中经常会出现非物理的振荡，这是一个常见的陷阱。这个练习将深入探讨这种现象的根本原因，帮助你理解数值阻尼的概念以及该方法对高频分量的处理方式，从而学会在实践中辨别和解释这些数值伪影。", "problem": "一名工程专业的学生正在模拟一根长绝热棒中的一维传热过程。该过程由热方程 $\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2}$ 控制，其中 $u(x,t)$ 是在位置 $x$ 和时间 $t$ 的温度，$D$ 是材料的热扩散系数。该棒的长度为 $L$。初始温度分布是一个急剧的阶跃函数：在 $t=0$ 时，棒的左半部分（$0 \\le x \\le L/2$）的温度为 $u(x,0) = U_0$，右半部分（$L/2  x \\le L$）的温度为 $u(x,0) = 0$。边界保持恒定温度：对于所有 $t > 0$，$u(0,t) = U_0$ 且 $u(L,t) = 0$。\n\n为了数值求解该方程，该学生采用了广泛使用的Crank-Nicolson方法，用空间步长 $\\Delta x$ 对区域进行离散化，并以时间步长 $\\Delta t$ 向前推进。在运行了几个时间步长的模拟后，该学生观察到温度分布的数值解在初始不连续点 $x=L/2$ 附近的区域表现出非物理的振荡或“摆动”。\n\n当将Crank-Nicolson方法应用于具有急剧不连续性的初始条件时，下列哪个陈述为该方法产生这些虚假振荡提供了最准确和最根本的解释？\n\nA. Crank-Nicolson方法只是有条件稳定的，急剧的初始条件与所选参数 $\\Delta t$ 和 $\\Delta x$ 的组合违反了Courant-Friedrichs-Lewy (CFL) 条件，从而导致了一个不稳定的振荡解。\n\nB. 这种振荡是Gibbs现象的直接数值表现。任何基于有限网格点表示的数值方法在逼近不连续函数时都不可避免地会产生这种过冲，而无论使用何种具体的时间步进格式。\n\nC. Crank-Nicolson格式的隐式性质要求在每个时间步长求解一个三对角线性方程组。初始数据向量中的急剧不连续性产生了一个病态矩阵，线性求解器的数值误差是振荡行为的来源。\n\nD. 该方法存在显著的数值色散误差，这意味着数值解的不同傅里叶分量以不正确的、依赖于频率的相速度传播。对于表示不连续性至关重要的高频分量会散开并相互干涉，从而产生观察到的“摆动”。\n\nE. 精确表示一个急剧的不连续性需要一个宽谱的空间傅里叶模式。对于数值网格所能支持的最高频率模式，Crank-Nicolson方法的放大因子接近-1。因此，这些高频分量阻尼很差，并且在每个时间步长都会反转其相位，导致它们以振荡的形式持续存在。", "solution": "我们使用冯·诺伊曼傅里叶模式分析法来分析热方程 $u_{t} = D u_{xx}$ 的Crank-Nicolson (CN) 格式，以确定其在处理不连续初始数据时产生振荡的机理。设空间网格为 $x_{j} = j \\Delta x$，时间层级为 $t^{n} = n \\Delta t$。在内部点 $j$ 处的CN离散格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n= \\frac{D}{2} \\left( \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^{2}}\n+ \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}} \\right).\n$$\n引入无量纲参数 $r = \\frac{D \\Delta t}{(\\Delta x)^{2}}$。整理后得到线性系统\n$$\n-\\frac{r}{2} u_{j-1}^{n+1} + (1 + r) u_{j}^{n+1} - \\frac{r}{2} u_{j+1}^{n+1}\n= \\frac{r}{2} u_{j-1}^{n} + (1 - r) u_{j}^{n} + \\frac{r}{2} u_{j+1}^{n}.\n$$\n对于冯·诺伊曼分析，假设一个傅里叶模式为 $u_{j}^{n} = G^{n} \\exp(i j \\theta)$，其中 $\\theta = k \\Delta x \\in [-\\pi,\\pi]$。代入 $u_{j\\pm 1}^{n} = G^{n} \\exp(i (j \\pm 1)\\theta)$ 以及类似的 $n+1$ 层的表达式，我们得到\n$$\nG \\left( -\\frac{r}{2} \\exp(-i \\theta) + (1 + r) - \\frac{r}{2} \\exp(i \\theta) \\right)\n= \\frac{r}{2} \\exp(-i \\theta) + (1 - r) + \\frac{r}{2} \\exp(i \\theta).\n$$\n使用 $\\exp(i \\theta) + \\exp(-i \\theta) = 2 \\cos \\theta$，上式简化为\n$$\nG \\left( 1 + r - r \\cos \\theta \\right) = 1 - r + r \\cos \\theta,\n$$\n因此，CN的放大因子为\n$$\nG(\\theta) = \\frac{1 - r + r \\cos \\theta}{1 + r - r \\cos \\theta}.\n$$\n等价地，使用 $1 - \\cos \\theta = 2 \\sin^{2}(\\theta/2)$，\n$$\nG(\\theta) = \\frac{1 - 2 r \\sin^{2}(\\theta/2)}{1 + 2 r \\sin^{2}(\\theta/2)}.\n$$\n网格上支持的最高频率模式是奈奎斯特（Nyquist）模式，其 $\\theta = \\pi$，此时 $\\sin^{2}(\\pi/2) = 1$，得到\n$$\nG(\\pi) = \\frac{1 - 2 r}{1 + 2 r}.\n$$\n由此得出两个关键性质：\n- 幅值：$| G(\\pi) | = | \\frac{1 - 2 r}{1 + 2 r} | \\le 1$，所以CN格式是无条件稳定的（排除了陈述A）。然而，随着 $r$ 的增大，$| G(\\pi) | \\to 1$，意味着最高频率分量的阻尼非常差（CN是A-稳定的，但不是L-稳定的）。\n- 符号：对于 $r > 1/2$，$G(\\pi)  0$，所以奈奎斯特分量在每个时间步长都会反号，即经历一次相位反转。即使对于 $\\theta$ 接近 $\\pi$ 的模式，当 $r$ 不是非常小时，$G(\\theta)$ 也接近 -1，因此这些高频分量表现出弱阻尼和时间上的符号交替。\n\n从物理上看，一个急剧的不连续性需要一个宽谱的高空间频率。精确的热方程在一个时间步长内以因子 $\\exp(-D k^{2} \\Delta t)$ 强烈地阻尼这些模式。相比之下，对于离散的最高频率，CN放大因子接近-1而不是0，因此这些分量没有被强烈衰减，并且可能在步与步之间反转相位。这导致在不连续点附近出现持续的、非物理的振荡（空间“摆动”），且衰减得非常慢。\n\n这个机理本身不是Gibbs现象（陈述B），Gibbs现象关心的是与时间步进无关的傅里叶截断过冲。它不是由于三对角系统的病态性（陈述C），因为对于 $r > 0$，该系统仍然是良态的并且是主对角占优的。它也不是数值色散（陈述D），数值色散与具有相速度误差的波传播有关；热方程是扩散性的，这里的问题是高频模式的阻尼不足和符号反转。\n\n因此，最准确和最根本的解释是，对于最高频率模式，CN放大因子接近-1，导致表示不连续性所必需的关键高频内容阻尼不良和相位反转，从而产生了观察到的振荡。这对应于陈述E。", "answer": "$$\\boxed{E}$$", "id": "2211533"}]}