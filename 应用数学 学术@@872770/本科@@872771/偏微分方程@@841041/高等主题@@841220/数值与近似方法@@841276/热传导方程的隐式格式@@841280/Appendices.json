{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是亲手实践。这个练习将指导你为一个经典的一维热传导问题建立并求解一个隐式格式。通过处理一个带有不连续初始条件的物理场景，你将学会如何将偏微分方程离散化，构建相应的线性方程组，并通过求解该方程组来预测未来的温度分布。这是一个将抽象的隐式方法应用于具体计算的核心实践。[@problem_id:2112821]", "problem": "一根长度为 $L=1.0 \\text{ m}$ 的薄绝热杆沿x轴放置，范围从 $x=0$ 到 $x=1.0 \\text{ m}$。杆中的温度分布 $u(x,t)$ 由一维热方程 $u_t = \\alpha u_{xx}$ 控制，其中热扩散系数为 $\\alpha = 0.01 \\text{ m}^2/\\text{s}$。在时间 $t=0$ 时，杆具有不连续的温度分布：左半部分被加热到恒定温度 $T_1 = 100.0^\\circ\\text{C}$，右半部分温度为 $T_0 = 0.0^\\circ\\text{C}$。具体来说，初始条件为：对于 $x \\in [0, 0.5 \\text{ m})$，有 $u(x,0) = 100.0^\\circ\\text{C}$；对于 $x \\in [0.5 \\text{ m}, 1.0 \\text{ m}]$，有 $u(x,0) = 0.0^\\circ\\text{C}$。对于所有后续时间 $t>0$，杆的两端保持恒定温度，与两端的初始温度相对应：$u(0,t) = 100.0^\\circ\\text{C}$ 和 $u(1.0 \\text{ m}, t) = 0.0^\\circ\\text{C}$。\n\n你需要使用数值近似方法，计算经过一小段时间后杆中点的温度。使用后向时间中心空间（BTCS）隐式有限差分法，空间步长为 $\\Delta x = 0.25 \\text{ m}$，时间步长为 $\\Delta t = 2.5 \\text{ s}$。\n\n计算在时间 $t=2.5 \\text{ s}$ 时 $x=0.5 \\text{ m}$ 处的温度。你的答案应以摄氏度表示，并四舍五入到三位有效数字。", "solution": "我们求解在 $x\\in[0,1]$ 上的一维热方程 $u_{t}=\\alpha u_{xx}$，其 Dirichlet 边界条件为 $u(0,t)=100$ 和 $u(1,t)=0$，初始条件为当 $x\\in[0,0.5)$ 时 $u(x,0)=100$ 以及当 $x\\in[0.5,1]$ 时 $u(x,0)=0$。我们应用后向时间中心空间（BTCS）方法，其中 $\\Delta x=0.25$，$\\Delta t=2.5$，热扩散系数 $\\alpha=0.01$。\n\n定义网格点 $x_{i}=i\\Delta x$ (其中 $i=0,1,2,3,4$)，得到 $x_{0}=0$, $x_{1}=0.25$, $x_{2}=0.5$, $x_{3}=0.75$, $x_{4}=1$。内部节点为 $i=1,2,3$。内部节点的 BTCS 离散化形式为\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}=\\alpha\\,\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}.\n$$\n令 $r=\\alpha\\Delta t/\\Delta x^{2}$。则关于 $u_{i}^{n+1}$ 的线性系统为\n$$\n-r\\,u_{i-1}^{n+1}+(1+2r)\\,u_{i}^{n+1}-r\\,u_{i+1}^{n+1}=u_{i}^{n},\\quad i=1,2,3,\n$$\n在时间层 $n+1$ 上施加边界值：$u_{0}^{n+1}=100$ 和 $u_{4}^{n+1}=0$。\n\n计算 $r$：\n$$\nr=\\frac{\\alpha\\Delta t}{\\Delta x^{2}}=\\frac{0.01\\times 2.5}{(0.25)^{2}}=\\frac{0.025}{0.0625}=0.4=\\frac{2}{5}.\n$$\n与不连续性及其在 $x=0.5$ 处的取值一致的初始节点值为\n$$\nu_{0}^{0}=100,\\quad u_{1}^{0}=100,\\quad u_{2}^{0}=0,\\quad u_{3}^{0}=0,\\quad u_{4}^{0}=0.\n$$\n在第一个时间步长 ($n=0\\to 1$)，对于 $i=1,2,3$ 的方程，在将已知的边界项移到右侧后，变为\n$$\n(1+2r)u_{1}^{1}-r\\,u_{2}^{1}=u_{1}^{0}+r\\,u_{0}^{1},\\qquad -r\\,u_{1}^{1}+(1+2r)u_{2}^{1}-r\\,u_{3}^{1}=u_{2}^{0},\\qquad -r\\,u_{2}^{1}+(1+2r)u_{3}^{1}=u_{3}^{0}+r\\,u_{4}^{1}.\n$$\n使用 $r=\\frac{2}{5}$，$u_{0}^{1}=100$，$u_{4}^{1}=0$，以及 $u_{1}^{0}=100$，$u_{2}^{0}=0$，$u_{3}^{0}=0$，该方程组为\n$$\n\\frac{9}{5}u_{1}^{1}-\\frac{2}{5}u_{2}^{1}=100+\\frac{2}{5}\\cdot 100=140,\n$$\n$$\n-\\frac{2}{5}u_{1}^{1}+\\frac{9}{5}u_{2}^{1}-\\frac{2}{5}u_{3}^{1}=0,\n$$\n$$\n-\\frac{2}{5}u_{2}^{1}+\\frac{9}{5}u_{3}^{1}=0.\n$$\n由第三个方程可得，\n$$\n\\frac{9}{5}u_{3}^{1}=\\frac{2}{5}u_{2}^{1}\\quad\\Rightarrow\\quad u_{3}^{1}=\\frac{2}{9}u_{2}^{1}.\n$$\n代入第二个方程：\n$$\n-\\frac{2}{5}u_{1}^{1}+\\frac{9}{5}u_{2}^{1}-\\frac{2}{5}\\cdot\\frac{2}{9}u_{2}^{1}=0\n\\;\\Rightarrow\\;\n-\\frac{2}{5}u_{1}^{1}+\\left(\\frac{9}{5}-\\frac{4}{45}\\right)u_{2}^{1}=0\n\\;\\Rightarrow\\;\n-\\frac{2}{5}u_{1}^{1}+\\frac{77}{45}u_{2}^{1}=0.\n$$\n因此\n$$\n\\frac{77}{45}u_{2}^{1}=\\frac{2}{5}u_{1}^{1}\\quad\\Rightarrow\\quad u_{2}^{1}=\\frac{2}{5}\\cdot\\frac{45}{77}u_{1}^{1}=\\frac{18}{77}u_{1}^{1}.\n$$\n将此代入第一个方程：\n$$\n\\frac{9}{5}u_{1}^{1}-\\frac{2}{5}\\cdot\\frac{18}{77}u_{1}^{1}=140\n\\;\\Rightarrow\\;\n\\left(\\frac{9}{5}-\\frac{36}{385}\\right)u_{1}^{1}=140\n\\;\\Rightarrow\\;\n\\frac{657}{385}u_{1}^{1}=140\n\\;\\Rightarrow\\;\nu_{1}^{1}=140\\cdot\\frac{385}{657}=\\frac{53900}{657}.\n$$\n所以，\n$$\nu_{2}^{1}=\\frac{18}{77}u_{1}^{1}=\\frac{18}{77}\\cdot\\frac{53900}{657}.\n$$\n通过约去公因数来精确简化：由于 $657=9\\cdot 73$，\n$$\nu_{2}^{1}=\\frac{18}{657}\\cdot\\frac{53900}{77}=\\frac{2}{73}\\cdot\\frac{53900}{77}.\n$$\n因为 $53900=11\\cdot 4900$ 且 $77=7\\cdot 11$，我们得到\n$$\nu_{2}^{1}=\\frac{2}{73}\\cdot\\frac{4900}{7}=\\frac{1400}{73}.\n$$\n因此，在 $t=2.5$ 时 $x=0.5$ 处的温度是\n$$\nu(0.5,2.5)=u_{2}^{1}=\\frac{1400}{73}\\approx 19.178082\\ldots\n$$\n四舍五入到三位有效数字，结果是 $19.2$ 摄氏度。", "answer": "$$\\boxed{19.2}$$", "id": "2112821"}, {"introduction": "在每个时间步，隐式格式都需要求解一个形如 $A \\mathbf{u}^{n+1} = \\mathbf{u}^n$ 的线性方程组。矩阵 $A$ 的性质直接影响求解过程的稳定性和效率。这个练习将带你深入探索这个核心问题，通过分析矩阵 $A$ 的条件数与扩散数 $r$ 之间的关系，揭示离散化参数（如时间步长 $\\Delta t$ 和空间步长 $\\Delta x$）如何影响我们所求解的线性系统的数值特性。这有助于你更深刻地理解隐式格式的内在机制，而不仅仅是将其作为一个黑箱工具。[@problem_id:2112811]", "problem": "考虑一维热传导方程 $u_t = \\alpha u_{xx}$，该方程模拟了长度为 $L$ 的细长均匀杆中的温度分布 $u(x,t)$。材料的热扩散系数为 $\\alpha$。杆身是绝热的，其两端在所有时间 $t \\ge 0$ 内都保持恒定的零温度，这对应于狄利克雷边界条件 $u(0,t) = 0$ 和 $u(L,t) = 0$。\n\n为对此方程进行数值求解，我们采用后向欧拉有限差分法。空间域 $[0, L]$ 被离散为4个相等的子区间，从而产生3个内部网格点，记为 $x_i = i\\Delta x$，$i=1, 2, 3$。时间域使用恒定的时间步长 $\\Delta t$ 进行离散。在每个内部网格点 $(x_i, t_{n+1})$ 处，控制偏微分方程由以下有限差分方程近似：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\alpha \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n其中 $u_i^n$ 近似于 $u(x_i, t_n)$。该格式在每个时间步都会导出一个线性方程组，可以表示为矩阵形式 $A \\mathbf{u}^{n+1} = \\mathbf{u}^n$，其中 $\\mathbf{u}^n = [u_1^n, u_2^n, u_3^n]^T$。求解该系统的稳定性和准确性受矩阵 $A$ 的性质影响。\n\n定义扩散数为无量纲参数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。对于这种具有3个内部网格点的特定离散化，确定矩阵 $A$ 的2-范数条件数 $\\kappa_2(A)$。对称正定矩阵的2-范数条件数定义为其最大特征值与最小特征值的比值。将您的答案表示为扩散数 $r$ 的函数。", "solution": "热传导方程的后向欧拉有限差分格式如下：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\alpha \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n我们的目标是求出系统 $A \\mathbf{u}^{n+1} = \\mathbf{u}^n$ 中的矩阵 $A$。我们首先重新整理方程，将新时间步 $n+1$ 的所有项都归到左侧，而将当前时间步 $n$ 的所有项都归到右侧。\n\n$$\nu_i^{n+1} - u_i^n = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1})\n$$\n\n我们引入扩散数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。将 $r$ 代入方程得到：\n$$\nu_i^{n+1} - u_i^n = r (u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1})\n$$\n\n整理各项：\n$$\n-r u_{i-1}^{n+1} + (1 + 2r) u_i^{n+1} - r u_{i+1}^{n+1} = u_i^n\n$$\n\n该方程对每个内部网格点 $i=1, 2, 3$ 都成立。我们还使用狄利克雷边界条件，这意味着对所有 $n$ 都有 $u_0^{n+1} = 0$ 和 $u_4^{n+1} = 0$。\n\n对于 $i=1$：\n$$\n-r u_0^{n+1} + (1 + 2r) u_1^{n+1} - r u_2^{n+1} = u_1^n \\implies (1 + 2r) u_1^{n+1} - r u_2^{n+1} = u_1^n\n$$\n\n对于 $i=2$：\n$$\n-r u_1^{n+1} + (1 + 2r) u_2^{n+1} - r u_3^{n+1} = u_2^n\n$$\n\n对于 $i=3$：\n$$\n-r u_2^{n+1} + (1 + 2r) u_3^{n+1} - r u_4^{n+1} = u_3^n \\implies -r u_2^{n+1} + (1 + 2r) u_3^{n+1} = u_3^n\n$$\n\n这三个线性方程可以写成矩阵形式 $A \\mathbf{u}^{n+1} = \\mathbf{u}^n$：\n$$\n\\begin{pmatrix}\n1+2r  & -r  & 0 \\\\\n-r  & 1+2r  & -r \\\\\n0  & -r  & 1+2r\n\\end{pmatrix}\n\\begin{pmatrix}\nu_1^{n+1} \\\\\nu_2^{n+1} \\\\\nu_3^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nu_1^n \\\\\nu_2^n \\\\\nu_3^n\n\\end{pmatrix}\n$$\n\n因此，矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n1+2r  & -r  & 0 \\\\\n-r  & 1+2r  & -r \\\\\n0  & -r  & 1+2r\n\\end{pmatrix}\n$$\n问题要求计算 2-范数条件数 $\\kappa_2(A)$。由于 $A$ 是一个实对称矩阵，其特征值均为实数。当 $r>0$ 时，它也是正定的。条件数由 $\\kappa_2(A) = \\frac{|\\lambda_{\\max}|}{|\\lambda_{\\min}|}$ 给出。对于正定矩阵，这简化为 $\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$。\n\n为了求出特征值 $\\lambda$，我们求解特征方程 $\\det(A - \\lambda I) = 0$。\n令 $X = 1+2r-\\lambda$。特征方程为：\n$$\n\\det \\begin{pmatrix}\nX  & -r  & 0 \\\\\n-r  & X  & -r \\\\\n0  & -r  & X\n\\end{pmatrix} = 0\n$$\n\n沿第一行展开行列式：\n$$\nX(X \\cdot X - (-r)(-r)) - (-r)((-r)X - 0) = 0\n$$\n$$\nX(X^2 - r^2) - r^2 X = 0\n$$\n$$\nX(X^2 - r^2 - r^2) = 0\n$$\n$$\nX(X^2 - 2r^2) = 0\n$$\n\n这个方程给出了 $X$ 的三个可能的解：\n1. $X = 0$\n2. $X = \\sqrt{2}r$\n3. $X = -\\sqrt{2}r$\n\n现在，我们将 $X = 1+2r-\\lambda$ 代回，在每种情况下求解 $\\lambda$：\n1. $1+2r-\\lambda = 0 \\implies \\lambda_1 = 1+2r$\n2. $1+2r-\\lambda = \\sqrt{2}r \\implies \\lambda_2 = 1+2r - \\sqrt{2}r = 1 + r(2-\\sqrt{2})$\n3. $1+2r-\\lambda = -\\sqrt{2}r \\implies \\lambda_3 = 1+2r + \\sqrt{2}r = 1 + r(2+\\sqrt{2})$\n\n矩阵 $A$ 的三个特征值是 $\\lambda_1 = 1+2r$, $\\lambda_2 = 1 + r(2-\\sqrt{2})$ 和 $\\lambda_3 = 1 + r(2+\\sqrt{2})$。\n为了找到 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$，我们比较 $r$ 的系数。由于 $r > 0$，我们只需要比较 $2$、$2-\\sqrt{2}$ 和 $2+\\sqrt{2}$ 这几个值。\n我们知道 $\\sqrt{2} \\approx 1.414$。\n所以，$2-\\sqrt{2} \\approx 0.586$ 且 $2+\\sqrt{2} \\approx 3.414$。\n显然，$2-\\sqrt{2}  2  2+\\sqrt{2}$。\n因此，最小和最大特征值分别为：\n$$\n\\lambda_{\\min} = \\lambda_2 = 1 + r(2-\\sqrt{2})\n$$\n$$\n\\lambda_{\\max} = \\lambda_3 = 1 + r(2+\\sqrt{2})\n$$\n\n2-范数条件数是最大特征值与最小特征值的比值：\n$$\n\\kappa_2(A) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{1 + r(2+\\sqrt{2})}{1 + r(2-\\sqrt{2})}\n$$\n这就是条件数作为 $r$ 的函数的最终表达式。", "answer": "$$\\boxed{\\frac{1 + r(2+\\sqrt{2})}{1 + r(2-\\sqrt{2})}}$$", "id": "2112811"}, {"introduction": "真实世界的物理问题很少局限于简单的一维线段。这个练习旨在将你从一维问题提升到更实际的二维场景，特别是在一个非矩形的L型区域上。通过处理这种具有“凹角”的复杂几何形状，你将被迫仔细考虑网格点之间的连接关系，以及如何根据特定的几何边界和节点排序来正确构建系统矩阵。这项实践是掌握将数值方法应用于复杂工程和物理仿真的关键一步。[@problem_id:2112783]", "problem": "考虑二维热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)$，它描述了区域 $\\Omega$ 上的温度分布 $u(x,y,t)$，其中 $\\alpha$ 是常数热扩散系数。该区域是一个 L 形区域，由单位正方形移除其右上象限而定义：$\\Omega = \\left( (0,1) \\times (0,1) \\right) \\setminus \\left[ [1/2, 1] \\times [1/2, 1] \\right]$。在所有时间 $t>0$ 内，边界 $\\partial\\Omega$ 上的温度都固定为零。\n\n我们旨在使用后向欧拉法对此问题进行数值求解。空间域在 $x$ 和 $y$ 方向上均使用间距为 $h=1/4$ 的均匀网格进行离散化，时间域使用步长 $k$ 进行离散化。每个时间步的有限差分近似会得到一个线性方程组，可以写成 $A\\mathbf{U}^{n+1} = \\mathbf{U}^{n}$ 的形式，其中 $\\mathbf{U}^{n}$ 是一个列向量，包含在时间 $t_n = nk$ 时所有内部网格点的温度。\n\n内部网格点按字典序排序（首先按其 $x$ 坐标排序，然后按其 $y$ 坐标排序）。该排序明确给出如下：\n$P_1=(1/4, 1/4)$, $P_2=(1/4, 1/2)$, $P_3=(1/4, 3/4)$, $P_4=(1/2, 1/4)$, $P_5=(3/4, 1/4)$。\n相应的未知温度向量为 $\\mathbf{U}^n = [u(P_1, t_n), u(P_2, t_n), u(P_3, t_n), u(P_4, t_n), u(P_5, t_n)]^T$。\n\n确定矩阵 $A$ 第二行的元素。用无量纲参数 $s = \\frac{\\alpha k}{h^2}$ 将你的答案表示为一个行向量。", "solution": "我们使用后向欧拉法对热方程 $u_{t}=\\alpha(u_{xx}+u_{yy})$ 进行时间离散化，并在两个方向上网格宽度均为 $h$ 的均匀网格上使用标准的五点拉普拉斯算子进行空间离散化。令 $s=\\alpha k/h^{2}$。对于任何内部网格点 $(x_{i},y_{j})$，后向欧拉法得到\n$$\n\\frac{u_{i,j}^{n+1}-u_{i,j}^{n}}{k}=\\alpha\\frac{u_{i+1,j}^{n+1}-2u_{i,j}^{n+1}+u_{i-1,j}^{n+1}+u_{i,j+1}^{n+1}-2u_{i,j}^{n+1}+u_{i,j-1}^{n+1}}{h^{2}},\n$$\n整理后可得\n$$\n(1+4s)u_{i,j}^{n+1}-s\\big(u_{i+1,j}^{n+1}+u_{i-1,j}^{n+1}+u_{i,j+1}^{n+1}+u_{i,j-1}^{n+1}\\big)=u_{i,j}^{n}.\n$$\n在 $\\partial\\Omega$ 上的狄利克雷边界条件 $u=0$ 意味着任何位于边界上的邻点贡献一个已知的零值，因此不会作为未知量出现在线性系统 $A\\mathbf{U}^{n+1}=\\mathbf{U}^{n}$ 中。\n\n我们关注第二个未知点 $P_{2}=(1/4,1/2)$。其距离为 $h$ 的四个网格邻点是：\n- 左侧：$(0,1/2)$，位于边界上，因此贡献一个已知的零值。\n- 右侧：$(1/2,1/2)$，位于被移除象限的边界上，因此也贡献一个已知的零值。\n- 下方：$(1/4,1/4)=P_{1}$，一个内部未知点。\n- 上方：$(1/4,3/4)=P_{3}$，一个内部未知点。\n\n因此，对于 $P_{2}$，离散方程变为\n$$\n(1+4s)u(P_{2})^{n+1}-s\\,u(P_{1})^{n+1}-s\\,u(P_{3})^{n+1}=u(P_{2})^{n},\n$$\n其中没有来自左侧或右侧邻点的贡献，因为它们是边界上的零值点。因此，在排序 $\\{P_{1},P_{2},P_{3},P_{4},P_{5}\\}$ 下，矩阵 $A$ 的第二行具有以下元素\n$$\n\\big(-s,\\;1+4s,\\;-s,\\;0,\\;0\\big).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-s   1+4s   -s   0   0\\end{pmatrix}}$$", "id": "2112783"}]}