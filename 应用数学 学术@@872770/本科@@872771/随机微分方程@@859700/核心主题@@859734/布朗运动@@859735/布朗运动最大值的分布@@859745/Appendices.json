{"hands_on_practices": [{"introduction": "本练习是理解布朗运动最大值分布的基石。我们将运用反射原理这一强大工具，推导布朗运动在任意时间段内的最大值 $M_t$ 的概率分布。这个过程不仅展示了如何从布朗运动的基本对称性出发，得到一个路径依赖量（如最大值）的精确分布，而且通过计算其期望值，我们还能初步刻画这个新随机变量的特征。[@problem_id:3049950]", "problem": "设 $\\{B_{s}\\}_{s \\ge 0}$ 为一个标准布朗运动，即一个满足 $B_{0}=0$、具有独立平稳增量、且对每个 $t>0$ 有 $B_{t} \\sim \\mathcal{N}(0,t)$ 的连续时间随机过程，其中 $\\mathcal{N}(0,t)$ 表示均值为 $0$、方差为 $t$ 的正态分布。对于一个固定的 $t>0$，定义游程最大值\n$$\nM_{t} := \\sup_{0 \\le s \\le t} B_{s}.\n$$\n仅使用标准布朗运动的核心性质（包括增量的对称性、$B_{t}$ 的正态分布以及由反射原理得到的路径论证），推导 $M_{t}$ 在 $m \\ge 0$ 时的累积分布函数和概率密度函数。然后计算期望\n$$\nE[M_{t}] = \\int_{0}^{\\infty} m \\, f_{M_{t}}(m) \\, dm,\n$$\n其中 $f_{M_{t}}$ 是 $M_{t}$ 的概率密度函数。最后，利用布朗标度性质来证明关系式 $M_{t} \\stackrel{d}{=} \\sqrt{t}\\,M_{1}$，并从 $E[M_{1}]$ 推导出 $E[M_{t}]$。将你的最终答案表示为关于 $t$ 的单个闭式表达式。无需进行数值近似。", "solution": "该问题陈述是随机过程理论中的一个标准的、良定的问题。它在科学上是合理的，自洽的，并且没有任何缺陷。我们可以开始求解。\n\n设 $\\{B_s\\}_{s \\ge 0}$ 为一个 $B_0=0$ 的一维标准布朗运动。到时间 $t > 0$ 为止的游程最大值定义为 $M_t := \\sup_{0 \\le s \\le t} B_s$。我们的任务是求出 $M_t$ 的累积分布函数 (CDF) 和概率密度函数 (PDF)，然后计算其期望 $E[M_t]$。\n\n首先，我们推导 $M_t$ 的累积分布函数，即对于任意实数 $m$，有 $F_{M_t}(m) = \\mathbb{P}(M_t \\le m)$。由于 $B_0 = 0$ 且布朗运动的路径是连续的，最大值 $M_t$ 必须是非负的，即 $M_t \\ge B_0 = 0$。因此，对于任意 $m  0$，有 $\\mathbb{P}(M_t \\le m) = 0$。我们现在考虑 $m \\ge 0$ 的情况。\n\n此推导的核心工具是布朗运动的反射原理。该原理指出，对于任意水平 $m>0$，最大值 $M_t$ 超过 $m$ 的概率是过程值 $B_t$ 大于 $m$ 的概率的两倍。\n我们来分析事件 $\\{M_t \\ge m\\}$。这等价于说布朗路径在某个时间 $s \\in [0, t]$ 达到或超过水平 $m$。令 $\\tau_m = \\inf\\{s \\ge 0 : B_s = m\\}$ 为首次到达水平 $m$ 的时间。那么事件 $\\{M_t \\ge m\\}$ 与事件 $\\{\\tau_m \\le t\\}$ 是相同的。\n我们可以根据最终位置 $B_t$ 来分解这个事件：\n$$\n\\mathbb{P}(M_t \\ge m) = \\mathbb{P}(M_t \\ge m, B_t \\ge m) + \\mathbb{P}(M_t \\ge m, B_t  m)\n$$\n如果 $B_t \\ge m$，那么可以肯定最大值 $M_t$ 也至少为 $m$，因此 $M_t \\ge B_t \\ge m$。所以，事件 $\\{M_t \\ge m, B_t \\ge m\\}$ 就是事件 $\\{B_t \\ge m\\}$。\n因此，方程变为：\n$$\n\\mathbb{P}(M_t \\ge m) = \\mathbb{P}(B_t \\ge m) + \\mathbb{P}(M_t \\ge m, B_t  m)\n$$\n反射原理指出 $\\mathbb{P}(M_t \\ge m, B_t  m) = \\mathbb{P}(B_t > m)$。简而言之，这是因为任何到达 $m$ 并最终低于 $m$ 的路径，都可以在其首次到达时间 $\\tau_m$ 之后关于直线 $y=m$ 进行“反射”。从 $\\tau_m$ 开始的反射路径对应于一条到达 $m$ 并最终高于 $m$ 的路径。根据布朗运动的强马尔可夫性，这两组路径具有相等的概率。\n由于 $B_t$ 的分布是连续的（正态分布），我们有 $\\mathbb{P}(B_t \\ge m) = \\mathbb{P}(B_t > m)$。\n将此代入 $\\mathbb{P}(M_t \\ge m)$ 的方程，我们得到：\n$$\n\\mathbb{P}(M_t \\ge m) = \\mathbb{P}(B_t > m) + \\mathbb{P}(B_t > m) = 2 \\mathbb{P}(B_t > m)\n$$\n随机变量 $B_t$ 服从均值为 $0$、方差为 $t$ 的正态分布，即 $B_t \\sim \\mathcal{N}(0, t)$。我们可以用标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$ 将其表示为 $B_t \\stackrel{d}{=} \\sqrt{t}Z$。\n$$\n\\mathbb{P}(B_t > m) = \\mathbb{P}(\\sqrt{t}Z > m) = \\mathbb{P}(Z > \\frac{m}{\\sqrt{t}}) = 1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n因此，对于 $m \\ge 0$：\n$$\n\\mathbb{P}(M_t \\ge m) = 2 \\left(1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\\right)\n$$\n$M_t$ 的累积分布函数为 $F_{M_t}(m) = \\mathbb{P}(M_t \\le m) = 1 - \\mathbb{P}(M_t > m)$。由于 $M_t$ 具有连续分布，所以 $\\mathbb{P}(M_t > m) = \\mathbb{P}(M_t \\ge m)$。\n$$\nF_{M_t}(m) = 1 - 2 \\left(1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\\right) = 2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1, \\quad \\text{对于 } m \\ge 0\n$$\n并且对于 $m0$，$F_{M_t}(m) = 0$。\n\n接下来，我们通过对 $m \\ge 0$ 的累积分布函数求导，来求 $M_t$ 的概率密度函数 (PDF) $f_{M_t}(m)$：\n$$\nf_{M_t}(m) = \\frac{d}{dm} F_{M_t}(m) = \\frac{d}{dm} \\left(2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1\\right)\n$$\n令 $\\phi(x) = \\frac{d}{dx}\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-x^2/2)$ 为标准正态分布的概率密度函数。使用链式法则：\n$$\nf_{M_t}(m) = 2 \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{d}{dm}\\left(\\frac{m}{\\sqrt{t}}\\right) = 2 \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{1}{\\sqrt{t}}\n$$\n代入 $\\phi(\\cdot)$ 的表达式：\n$$\nf_{M_t}(m) = \\frac{2}{\\sqrt{t}} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{m}{\\sqrt{t}}\\right)^2\\right) = \\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) = \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)\n$$\n这是 $m \\ge 0$ 时的概率密度函数。对于 $m  0$，$f_{M_t}(m) = 0$。该分布被称为折叠正态分布。值得注意的是，$M_t$ 的分布与 $|B_t|$ 的分布相同。\n\n现在我们计算期望 $E[M_t]$：\n$$\nE[M_t] = \\int_{-\\infty}^{\\infty} m f_{M_t}(m) dm = \\int_{0}^{\\infty} m f_{M_t}(m) dm\n$$\n$$\nE[M_t] = \\int_{0}^{\\infty} m \\left(\\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)\\right) dm = \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} m \\exp\\left(-\\frac{m^2}{2t}\\right) dm\n$$\n为了计算该积分，我们使用换元法，令 $u = \\frac{m^2}{2t}$。这得到 $du = \\frac{2m}{2t} dm = \\frac{m}{t} dm$，所以 $m \\, dm = t \\, du$。积分上下限仍为从 $0$ 到 $\\infty$。\n$$\nE[M_t] = \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} \\exp(-u) (t \\, du) = t \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} e^{-u} du\n$$\n积分 $\\int_{0}^{\\infty} e^{-u} du = [-e^{-u}]_0^\\infty = 0 - (-1) = 1$。\n$$\nE[M_t] = t \\sqrt{\\frac{2}{\\pi t}} \\cdot 1 = \\sqrt{t^2 \\cdot \\frac{2}{\\pi t}} = \\sqrt{\\frac{2t}{\\pi}}\n$$\n\n最后，我们使用布朗标度性质来验证这个结果。标度性质指出，对于任意常数 $c>0$，过程 $W_s = \\frac{1}{\\sqrt{c}}B_{cs}$ 也是一个标准布朗运动。我们选择 $c=t$。那么对于 $s \\ge 0$ 定义的过程 $W_s = \\frac{1}{\\sqrt{t}} B_{ts}$ 是一个标准布朗运动。\n我们可以用这个新过程 $W_s$ 来表示 $M_t$。注意 $B_{ts} = \\sqrt{t} W_s$。\n$$\nM_t = \\sup_{0 \\le u \\le t} B_u\n$$\n我们将上确界中的变量换为 $s = u/t$。当 $u$ 的范围是 $0$ 到 $t$ 时，$s$ 的范围是 $0$ 到 $1$。\n$$\nM_t = \\sup_{0 \\le s \\le 1} B_{ts} = \\sup_{0 \\le s \\le 1} (\\sqrt{t} W_s) = \\sqrt{t} \\sup_{0 \\le s \\le 1} W_s\n$$\n项 $\\sup_{0 \\le s \\le 1} W_s$ 是标准布朗运动 $W$ 在时间区间 $[0,1]$ 上的最大值。我们将其记为 $M_{W,1}$。由于 $W$ 是一个标准布朗运动，其在 $[0,1]$ 上的最大值的分布与原始布朗运动 $B$ 在 $[0,1]$ 上的最大值（即 $M_1$）的分布相同。因此，$M_{W,1} \\stackrel{d}{=} M_1$。\n这导出了分布上的相等关系：\n$$\nM_t \\stackrel{d}{=} \\sqrt{t} M_1\n$$\n对两边取期望：\n$$\nE[M_t] = E[\\sqrt{t} M_1] = \\sqrt{t} E[M_1]\n$$\n我们可以通过设置 $t=1$ 从前面的一般计算中得到 $E[M_1]$：\n$$\nE[M_1] = \\sqrt{\\frac{2(1)}{\\pi}} = \\sqrt{\\frac{2}{\\pi}}\n$$\n将此值代回，我们得到：\n$$\nE[M_t] = \\sqrt{t} \\cdot \\sqrt{\\frac{2}{\\pi}} = \\sqrt{\\frac{2t}{\\pi}}\n$$\n这证实了我们的直接计算，并展示了标度性质的效用。", "answer": "$$\\boxed{\\sqrt{\\frac{2t}{\\pi}}}$$", "id": "3049950"}, {"introduction": "在计算了最大值的期望之后，一个自然的问题是它的离散程度如何，也就是方差。本练习将引导我们计算 $M_t$ 的方差，从而更全面地理解其分布特性。这个计算过程不仅巩固了我们对最大值概率密度的运用，还揭示了一个巧妙的等价关系：$M_t$ 的分布与 $|B_t|$ 的分布相同，这为计算其二阶矩提供了一条捷径。[@problem_id:3049921]", "problem": "设 $\\{B_{s}\\}_{s \\ge 0}$ 是一个标准布朗运动，且 $B_{0} = 0$。定义截至时间 $t>0$ 的过程最大值为 $M_{t} := \\sup_{0 \\le s \\le t} B_{s}$。从布朗运动的基本性质（平稳独立增量和 $B_{t} \\sim \\mathcal{N}(0,t)$）以及反射原理出发，推导 $M_{t}$ 在 $m \\ge 0$ 时的累积分布函数，求出其概率密度函数，然后计算其一阶矩 $E[M_{t}]$ 和二阶矩 $E[M_{t}^{2}]$。利用这些结果确定方差 $\\operatorname{Var}(M_{t})$。将最终答案表示为单个闭式解析表达式。无需四舍五入。", "solution": "设 $\\{B_{s}\\}_{s \\ge 0}$ 是一个标准布朗运动，且 $B_{0} = 0$。我们的任务是求其在固定时间 $t > 0$ 的过程最大值 $M_{t} = \\sup_{0 \\le s \\le t} B_{s}$ 的方差。推导过程将分步进行：首先，我们利用反射原理求出 $M_t$ 的累积分布函数（CDF）；其次，我们推导其概率密度函数（PDF）；第三，我们计算 $M_t$ 的一阶矩和二阶矩；最后，我们计算方差。\n\n**1. $M_t$ 的累积分布函数 (CDF)**\n\n对于任意水平 $m \\ge 0$，$M_t$ 的累积分布函数为 $F_{M_t}(m) = \\mathbb{P}(M_{t} \\le m)$。通常，首先计算其互补累积分布函数 $\\mathbb{P}(M_{t} > m)$ 会更直接。事件 $\\{M_{t} > m\\}$ 意味着布朗路径在截至时间 $t$ 的某个时刻已经越过了水平 $m$。令 $\\tau_{m} = \\inf\\{s \\ge 0 : B_{s} = m\\}$ 为首次到达水平 $m$ 的时间（首中时）。那么事件 $\\{M_{t} > m\\}$ 与事件 $\\{\\tau_{m} \\le t\\}$ 等同。\n\n我们可以根据 $B_t$ 的值将事件 $\\{\\tau_m \\le t\\}$ 划分为：\n$$\\mathbb{P}(M_t > m) = \\mathbb{P}(\\tau_{m} \\le t) = \\mathbb{P}(\\tau_m \\le t, B_t > m) + \\mathbb{P}(\\tau_m \\le t, B_t = m) + \\mathbb{P}(\\tau_m \\le t, B_t  m)$$\n由于 $B_t$ 是一个连续型随机变量，其恰好等于水平 $m$ 的概率为零，即 $\\mathbb{P}(B_t = m) = 0$。\n如果 $B_t > m$，那么根据布朗路径的连续性和起点 $B_0=0$ 的性质，路径必然在某个时刻 $\\tau_m \\le t$ 越过了水平 $m$。因此，事件 $\\{B_t > m\\}$ 是事件 $\\{\\tau_m \\le t\\}$ 的子集，这意味着 $\\mathbb{P}(\\tau_m \\le t, B_t > m) = \\mathbb{P}(B_t > m)$。\n该表达式化简为：\n$$\\mathbb{P}(M_t > m) = \\mathbb{P}(B_t > m) + \\mathbb{P}(\\tau_m \\le t, B_t  m)$$\n为了计算最后一项，我们使用反射原理，这是布朗运动强马尔可夫性的一个推论。在事件 $\\{\\tau_m \\le t\\}$ 发生时，过程在时刻 $\\tau_m$ 对其状态进行反射。对于 $s > \\tau_m$，过程 $B_s - m$ 的行为关于 0 是对称的。这意味着，在路径于时间 $t$ 之前已到达 $m$ 的条件下，其最终位于 $m$ 上方或下方的可能性是相等的。更正式地：\n$$\\mathbb{P}(\\tau_m \\le t, B_t  m) = \\mathbb{P}(\\tau_m \\le t, B_t > m)$$\n由于 $\\mathbb{P}(\\tau_m \\le t, B_t > m) = \\mathbb{P}(B_t > m)$，我们有 $\\mathbb{P}(\\tau_m \\le t, B_t  m) = \\mathbb{P}(B_t > m)$。\n将此结果代入我们关于 $\\mathbb{P}(M_t > m)$ 的方程中：\n$$\\mathbb{P}(M_t > m) = \\mathbb{P}(B_t > m) + \\mathbb{P}(B_t > m) = 2\\mathbb{P}(B_t > m)$$\n由于 $M_t$ 是一个连续型随机变量，所以 $\\mathbb{P}(M_t > m) = \\mathbb{P}(M_t \\ge m)$，因此对于 $m \\ge 0$：\n$$\\mathbb{P}(M_t \\ge m) = 2\\mathbb{P}(B_t \\ge m)$$\n标准布朗运动服从分布 $B_t \\sim \\mathcal{N}(0, t)$。设 $Z \\sim \\mathcal{N}(0, 1)$ 是一个标准正态随机变量。那么 $B_t$ 与 $\\sqrt{t}Z$ 同分布。\n$$\\mathbb{P}(B_t \\ge m) = \\mathbb{P}(\\sqrt{t}Z \\ge m) = \\mathbb{P}\\left(Z \\ge \\frac{m}{\\sqrt{t}}\\right) = 1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n于是 $M_t$ 的累积分布函数为：\n$$F_{M_t}(m) = \\mathbb{P}(M_t \\le m) = 1 - \\mathbb{P}(M_t > m) = 1 - 2\\mathbb{P}(B_t > m) = 1 - 2\\left(1 - \\Phi\\left(\\frac{m}{\\sqrt{t}}\\right)\\right) = 2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1$$\n此公式对 $m \\ge 0$ 有效。由于 $M_t \\ge B_0 = 0$，对于 $m  0$，$F_{M_t}(m) = 0$。\n\n**2. $M_t$ 的概率密度函数 (PDF)**\n\n概率密度函数 $f_{M_t}(m)$ 是累积分布函数关于 $m$ 的导数（对于 $m \\ge 0$）。\n$$f_{M_t}(m) = \\frac{d}{dm} \\left[2\\Phi\\left(\\frac{m}{\\sqrt{t}}\\right) - 1\\right]$$\n设 $\\phi(x) = \\frac{d}{dx}\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-x^2/2)$ 为标准正态分布的概率密度函数。使用链式法则：\n$$f_{M_t}(m) = 2 \\cdot \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{d}{dm}\\left(\\frac{m}{\\sqrt{t}}\\right) = 2 \\cdot \\phi\\left(\\frac{m}{\\sqrt{t}}\\right) \\cdot \\frac{1}{\\sqrt{t}}$$\n代入 $\\phi(\\cdot)$ 的表达式：\n$$f_{M_t}(m) = 2 \\left( \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{m}{\\sqrt{t}}\\right)^2\\right) \\right) \\frac{1}{\\sqrt{t}} = \\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) = \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)$$\n该概率密度函数适用于 $m \\ge 0$，而当 $m  0$ 时 $f_{M_t}(m) = 0$。这是一个尺度参数为 $\\sigma = \\sqrt{t}$ 的半正态分布的概率密度函数。一个显著的推论是，$M_t$ 与 $|B_t|$ 同分布。\n\n**3. 一阶矩 $E[M_{t}]$**\n\n$M_t$ 的期望值可以通过在其支集 $[0, \\infty)$ 上对 $m \\cdot f_{M_t}(m)$ 进行积分得到：\n$$E[M_{t}] = \\int_{0}^{\\infty} m f_{M_t}(m) dm = \\int_{0}^{\\infty} m \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) dm$$\n$$E[M_t] = \\sqrt{\\frac{2}{\\pi t}} \\int_0^\\infty m \\exp\\left(-\\frac{m^2}{2t}\\right) dm$$\n我们进行换元，令 $u = \\frac{m^2}{2t}$，则 $du = \\frac{m}{t} dm$，或 $m \\, dm = t \\, du$。积分上下限仍为 $0$ 到 $\\infty$。\n$$E[M_t] = \\sqrt{\\frac{2}{\\pi t}} \\int_0^\\infty \\exp(-u) (t \\, du) = t \\sqrt{\\frac{2}{\\pi t}} \\int_0^\\infty \\exp(-u) du$$\n积分 $\\int_0^\\infty \\exp(-u) du = 1$。\n$$E[M_t] = t \\sqrt{\\frac{2}{\\pi t}} = \\sqrt{\\frac{2t^2}{\\pi t}} = \\sqrt{\\frac{2t}{\\pi}}$$\n\n**4. 二阶矩 $E[M_{t}^{2}]$**\n\n二阶矩 $E[M_{t}^{2}]$ 可以通过两种方式计算。第一种是直接积分：\n$$E[M_t^2] = \\int_{0}^{\\infty} m^2 f_{M_t}(m) dm = \\sqrt{\\frac{2}{\\pi t}} \\int_{0}^{\\infty} m^2 \\exp\\left(-\\frac{m^2}{2t}\\right) dm$$\n一个更直接的方法是利用 $M_t$ 与 $|B_t|$ 同分布这一事实。这意味着 $M_t^2$ 与 $|B_t|^2 = B_t^2$ 同分布。因此：\n$$E[M_t^2] = E[B_t^2]$$\n对于标准布朗运动 $B_t \\sim \\mathcal{N}(0, t)$，其方差为 $\\operatorname{Var}(B_t) = E[B_t^2] - (E[B_t])^2$。\n我们知道 $E[B_t] = 0$ 且 $\\operatorname{Var}(B_t) = t$。\n代入这些值：$t = E[B_t^2] - 0^2$，得出 $E[B_t^2] = t$。\n因此，过程最大值的二阶矩为：\n$$E[M_t^2] = t$$\n\n**5. 方差 $\\operatorname{Var}(M_{t})$**\n\n最后，使用标准公式 $\\operatorname{Var}(M_t) = E[M_t^2] - (E[M_t])^2$ 计算方差。\n使用我们推导出的矩：\n$$\\operatorname{Var}(M_t) = t - \\left(\\sqrt{\\frac{2t}{\\pi}}\\right)^2 = t - \\frac{2t}{\\pi}$$\n提取因子 $t$ 得到方差的最终闭式表达式：\n$$\\operatorname{Var}(M_t) = t\\left(1 - \\frac{2}{\\pi}\\right)$$", "answer": "$$\\boxed{t \\left( 1 - \\frac{2}{\\pi} \\right)}$$", "id": "3049921"}, {"introduction": "本练习将布朗运动最大值的概念与另一个核心概念——首次到达时间（first hitting time）——联系起来。我们将看到，一个过程的最大值超过某个水平的事件，等价于该过程首次到达该水平的时间早于当前时刻。通过利用这一深刻联系 [@problem_id:3049951]，我们可以推导出首次到达时间 $\\tau_a$ 的分布，并进而探索其期望值，最终得出一个关于随机游走本质的、令人惊讶且重要的结论。", "problem": "设 $\\{B_{t}\\}_{t \\ge 0}$ 为一维标准布朗运动，且 $B_{0} = 0$。对于一个固定的水平 $a > 0$，定义首次到达时间 $\\tau_{a} := \\inf\\{t \\ge 0 : B_{t} = a\\}$ 和游程最大值 $M_{t} := \\sup_{0 \\le s \\le t} B_{s}$。假设布朗运动的基本性质：对于每个 $t > 0$，$B_{t}$ 是均值为 $0$、方差为 $t$ 的高斯分布，该过程具有平稳且独立的增量，并且路径是连续的。仅使用这些基本性质和反射原理，按以下步骤进行：\n- 对于每个 $t > 0$ 和 $a > 0$，证明 $\\mathbb{P}(M_{t} \\ge a)$ 可以用 $\\mathbb{P}(B_{t} \\ge a)$ 表示，从而建立游程最大值与 $B_{t}$ 边际分布之间的关系。\n- 根据这个关系，推导出首次到达时间 $\\tau_{a}$ 的累积分布函数（CDF）$F_{\\tau_{a}}(t) := \\mathbb{P}(\\tau_{a} \\le t)$（对于 $t > 0$），然后通过微分求出其概率密度函数（PDF）$f_{\\tau_{a}}(t)$。\n- 计算积分 $\\int_{0}^{\\infty} t \\, f_{\\tau_{a}}(t) \\, dt$，并判断其收敛还是发散，要求从第一性原理出发证明你的结论，而不是借助于任何已有的快捷公式。最后得出 $\\mathbb{E}[\\tau_{a}]$ 的值。\n\n你的最终答案必须是 $\\mathbb{E}[\\tau_{a}]$ 的值，表示为一个单一的封闭形式数学表达式。不需要四舍五入，也不涉及物理单位。", "solution": "本题要求对从 $B_0=0$ 开始的一维标准布朗运动 $\\{B_t\\}_{t \\ge 0}$ 进行多步推导。我们首先被要求将游程最大值 $M_t = \\sup_{0 \\le s \\le t} B_s$ 超过水平 $a > 0$ 的概率与 $B_t$ 超过该水平的边际概率联系起来。然后，我们需要找到首次到达时间 $\\tau_a = \\inf\\{t \\ge 0: B_t = a\\}$ 的分布，并最终计算其期望 $\\mathbb{E}[\\tau_a]$。解题过程将按要求分为三个部分。\n\n### 第一部分：游程最大值的分布\n\n我们的目标是找到对于任意固定的 $t>0$ 和 $a>0$，$\\mathbb{P}(M_t \\ge a)$ 与 $\\mathbb{P}(B_t \\ge a)$ 之间的关系。事件 $\\{M_t \\ge a\\}$ 意味着布朗路径在某个时间 $s \\in [0, t]$ 达到或超过了水平 $a$。\n\n我们可以根据 $B_t$ 的值对样本空间进行划分。根据全概率定律，我们可以写出：\n$$\n\\mathbb{P}(M_t \\ge a) = \\mathbb{P}(M_t \\ge a, B_t \\ge a) + \\mathbb{P}(M_t \\ge a, B_t  a)\n$$\n我们来分析第一项。如果过程在时间 $t$ 处于或高于水平 $a$，即 $B_t \\ge a$，那么它在区间 $[0, t]$ 上的最大值也必定处于或高于 $a$，即 $M_t \\ge a$。这是因为 $M_t = \\sup_{0 \\le s \\le t} B_s \\ge B_t$。因此，事件 $\\{B_t \\ge a\\}$ 是事件 $\\{M_t \\ge a\\}$ 的一个子集。这意味着这两个事件的交集就是事件 $\\{B_t \\ge a\\}$ 本身。所以，\n$$\n\\mathbb{P}(M_t \\ge a, B_t \\ge a) = \\mathbb{P}(B_t \\ge a)\n$$\n现在我们分析第二项，$\\mathbb{P}(M_t \\ge a, B_t  a)$。这是路径在某个时刻达到或超过水平 $a$，但在时间 $t$ 最终低于 $a$ 的概率。要发生这种情况，路径必须在某个时间 $\\tau_a \\le t$ 穿过水平 $a$。这就是应用布朗运动反射原理的地方。\n\n反射原理指出，对于任何 $a > 0$，一条从 $0$ 开始的路径在时间 $t$ 之前达到水平 $a$ 并且在时间 $t$ 结束时 $B_t  a$ 的概率，等于一条从 $0$ 开始的路径在时间 $t$ 结束时 $B_t > a$ 的概率。为了说明这一点，考虑一条路径 $\\omega$，满足 $M_t(\\omega) \\ge a$ 和 $B_t(\\omega)  a$。设 $\\tau_a(\\omega)$ 是该路径首次到达 $a$ 的时间。我们通过在时间 $\\tau_a(\\omega)$ 后反射原始路径来定义一条新路径 $\\tilde{\\omega}$：\n$$\n\\tilde{B}_s(\\omega) = \\begin{cases} B_s(\\omega)  \\text{若 } s \\le \\tau_a(\\omega) \\\\ a - (B_s(\\omega) - a) = 2a - B_s(\\omega)  \\text{若 } s > \\tau_a(\\omega) \\end{cases}\n$$\n根据构造，由于 $B_t(\\omega)  a$，反射路径在时间 $t$ 的值为 $\\tilde{B}_t(\\omega) = 2a - B_t(\\omega) > 2a - a = a$。从 $\\omega$到 $\\tilde{\\omega}$ 的映射是满足 $\\{M_t \\ge a, B_t  a\\}$ 的路径集合与满足 $\\{B_t > a\\}$ 的路径集合之间的一个双射。布朗运动的强马尔可夫性和其增量的对称性意味着这个映射保持概率不变。因此，\n$$\n\\mathbb{P}(M_t \\ge a, B_t  a) = \\mathbb{P}(B_t > a)\n$$\n由于 $B_t$ 服从正态分布，这是一个连续分布，因此它恰好等于任何特定值的概率为 $0$。所以，$\\mathbb{P}(B_t > a) = \\mathbb{P}(B_t \\ge a)$。\n\n将这些结果代回我们最初的方程：\n$$\n\\mathbb{P}(M_t \\ge a) = \\mathbb{P}(B_t \\ge a) + \\mathbb{P}(B_t > a) = \\mathbb{P}(B_t \\ge a) + \\mathbb{P}(B_t \\ge a)\n$$\n这得到了基本关系式：\n$$\n\\mathbb{P}(M_t \\ge a) = 2 \\, \\mathbb{P}(B_t \\ge a)\n$$\n\n### 第二部分：首次到达时间 $\\tau_a$ 的累积分布函数（CDF）和概率密度函数（PDF）\n\n$\\tau_a$ 的累积分布函数（CDF）定义为 $F_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\le t)$。首次到达时间 $\\tau_a$ 小于或等于 $t$ 的事件等价于游程最大值 $M_t$ 大于或等于 $a$ 的事件。这是因为 $B_0=0$ 且布朗运动的路径是连续的。如果 $M_t \\ge a$，路径必定在时间 $t$ 或之前访问过 $a$。反之，如果 $\\tau_a \\le t$，则 $B_{\\tau_a} = a$，所以 $M_t \\ge a$。因此，$\\{\\tau_a \\le t\\} = \\{M_t \\ge a\\}$。\n\n使用第一部分的结果，我们可以将 $\\tau_a$ 的 CDF 写为：\n$$\nF_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(M_t \\ge a) = 2 \\, \\mathbb{P}(B_t \\ge a)\n$$\n在固定时间 $t$，标准布朗运动 $B_t$ 是一个均值为 $0$、方差为 $t$ 的正态分布随机变量，即 $B_t \\sim \\mathcal{N}(0, t)$。我们可以用一个标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$ 来表示它，即 $B_t = \\sqrt{t} Z$。\n$$\n\\mathbb{P}(B_t \\ge a) = \\mathbb{P}(\\sqrt{t} Z \\ge a) = \\mathbb{P}\\left(Z \\ge \\frac{a}{\\sqrt{t}}\\right)\n$$\n概率 $\\mathbb{P}(Z \\ge z)$ 可以写成标准正态 PDF $\\phi(u) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{u^2}{2}\\right)$ 的积分形式：\n$$\n\\mathbb{P}\\left(Z \\ge \\frac{a}{\\sqrt{t}}\\right) = \\int_{a/\\sqrt{t}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du\n$$\n所以，$\\tau_a$ 的 CDF 是：\n$$\nF_{\\tau_a}(t) = 2 \\int_{a/\\sqrt{t}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du\n$$\n为了求概率密度函数（PDF）$f_{\\tau_a}(t)$，我们将 CDF 对 $t$ 求导。使用莱布尼茨积分法则（$\\frac{d}{dx} \\int_{g(x)}^{h(x)} f(u) du = f(h(x))h'(x) - f(g(x))g'(x)$），我们有：\n$$\nf_{\\tau_a}(t) = \\frac{d}{dt} F_{\\tau_a}(t) = \\frac{d}{dt} \\left( 2 \\int_{a/\\sqrt{t}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du \\right)\n$$\n积分上限是一个常数，所以其导数为 $0$。积分下限是 $g(t) = a t^{-1/2}$，其导数为 $g'(t) = a(-\\frac{1}{2})t^{-3/2} = -\\frac{a}{2t^{3/2}}$。\n$$\nf_{\\tau_a}(t) = 2 \\left( 0 - \\left[ \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{a}{\\sqrt{t}}\\right)^2\\right) \\right] \\cdot \\left( -\\frac{a}{2t^{3/2}} \\right) \\right)\n$$\n$$\nf_{\\tau_a}(t) = 2 \\left( \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{a^2}{2t}\\right) \\frac{a}{2t^{3/2}} \\right)\n$$\n化简此表达式，得到首次到达时间 $\\tau_a$ 的 PDF：\n$$\nf_{\\tau_a}(t) = \\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right) \\quad \\text{对于 } t > 0\n$$\n\n### 第三部分：首次到达时间的期望 $\\mathbb{E}[\\tau_a]$\n\n$\\tau_a$ 的期望由 $t$ 乘以其 PDF 在其支撑集 $(0, \\infty)$ 上的积分给出：\n$$\n\\mathbb{E}[\\tau_a] = \\int_{0}^{\\infty} t \\, f_{\\tau_a}(t) \\, dt\n$$\n代入求得的 PDF：\n$$\n\\mathbb{E}[\\tau_a] = \\int_{0}^{\\infty} t \\left( \\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right) \\right) dt\n$$\n我们可以化简被积函数：\n$$\n\\mathbb{E}[\\tau_a] = \\frac{a}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} t \\cdot t^{-3/2} \\exp\\left(-\\frac{a^2}{2t}\\right) dt = \\frac{a}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} t^{-1/2} \\exp\\left(-\\frac{a^2}{2t}\\right) dt\n$$\n我们现在必须计算这个反常积分并判断其是否收敛。必须分析积分在极限 $t \\to 0^+$ 和 $t \\to \\infty$ 处的行为。\n\n1.  当 $t \\to 0^+$ 时的行为：令 $y = 1/t$。当 $t \\to 0^+$ 时，$y \\to \\infty$。被积函数变为 $y^{1/2} \\exp(-a^2 y/2)$。多次使用洛必达法则可以表明 $\\lim_{y\\to\\infty} y^{1/2} \\exp(-a^2 y/2) = 0$。在积分下限处，被积函数趋近于 $0$，因此对于任何有限的 $K > 0$，积分在形如 $[0, K]$ 的任何区间上收敛。\n\n2.  当 $t \\to \\infty$ 时的行为：当 $t \\to \\infty$ 时，项 $a^2/(2t) \\to 0$，因此 $\\exp(-a^2/(2t)) \\to \\exp(0) = 1$。\n    对于大的 $t$，被积函数的渐近行为类似于 $t^{-1/2}$：\n    $$\n    t^{-1/2} \\exp\\left(-\\frac{a^2}{2t}\\right) \\sim t^{-1/2} \\quad \\text{as } t \\to \\infty\n    $$\n    我们可以使用反常积分的极限比较判别法。考虑积分 $\\int_{1}^{\\infty} t^{-p} dt$。该积分收敛当且仅当 $p > 1$。在我们的例子中，幂是 $p = 1/2$。由于 $p = 1/2 \\le 1$，积分 $\\int_{1}^{\\infty} t^{-1/2} dt$ 发散。\n    形式上，令 $g(t) = t^{-1/2} \\exp(-a^2/(2t))$ 和 $h(t) = t^{-1/2}$。\n    $$\n    \\lim_{t\\to\\infty} \\frac{g(t)}{h(t)} = \\lim_{t\\to\\infty} \\frac{t^{-1/2} \\exp(-a^2/(2t))}{t^{-1/2}} = \\lim_{t\\to\\infty} \\exp\\left(-\\frac{a^2}{2t}\\right) = 1\n    $$\n    由于这个极限是一个有限的正数，并且积分 $\\int_{1}^{\\infty} h(t) dt = \\int_{1}^{\\infty} t^{-1/2} dt$ 发散，所以积分 $\\int_{1}^{\\infty} g(t) dt$ 也必定发散。期望值的积分可以分解为 $\\int_{0}^{1} g(t) dt + \\int_{1}^{\\infty} g(t) dt$。第一部分是有限的，但第二部分发散到无穷大。\n\n因此，计算 $\\mathbb{E}[\\tau_a]$ 的积分发散到 $+\\infty$。\n\n结论：标准布朗运动首次到达任何水平 $a > 0$ 的期望时间是无穷大。\n$$\n\\mathbb{E}[\\tau_a] = \\infty\n$$", "answer": "$$\\boxed{\\infty}$$", "id": "3049951"}]}