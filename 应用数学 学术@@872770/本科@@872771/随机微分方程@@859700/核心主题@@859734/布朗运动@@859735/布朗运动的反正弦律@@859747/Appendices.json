{"hands_on_practices": [{"introduction": "“反正弦定律”这个名称并非空穴来风，它直接源于其累积分布函数（CDF）的数学形式。第一个练习将提供一个动手实践的机会，通过直接对概率密度函数进行积分来推导这个著名的CDF [@problem_id:3039600]。完成这个计算不仅能巩固你对密度函数和分布函数之间关系的理解，还能揭示该定律名称的数学起源。", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 为一个标准布朗运动，即一个连续时间随机过程，满足 $B_{0} = 0$，具有独立增量，并且对于每个 $t  s \\geq 0$，增量 $B_{t} - B_{s}$ 服从均值为 $0$、方差为 $t-s$ 的高斯分布。考虑单位区间上的占位时间比例，定义为\n$$\nX \\equiv \\int_{0}^{1} \\mathbf{1}_{\\{B_{t}  0\\}} \\, dt,\n$$\n它表示标准布朗运动在 $[0,1]$ 上停留于 $0$ 以上的时间分数。一个经过充分验证的事实是，$X$ 在 $[0,1]$ 上服从反正弦律，其概率密度函数由下式给出\n$$\nf_{X}(x) = \\begin{cases}\n\\displaystyle \\frac{1}{\\pi \\sqrt{x(1-x)}},  x \\in (0,1), \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n以此密度函数为起点，通过对 $f_{X}(x)$ 进行直接积分，计算 $x \\in [0,1]$ 的累积分布函数 (CDF) $F_{X}(x) \\equiv \\mathbb{P}(X \\leq x)$。你的推导必须证明任何变量替换的合理性，并仔细处理端点行为。然后检验边界条件 $F_{X}(0) = 0$ 和 $F_{X}(1) = 1$。将最终的累积分布函数表示为单个闭式解析表达式。无需进行数值取整。", "solution": "问题陈述已经过验证，被认为是有效的。这是一个基于成熟的随机过程理论的适定数学问题。所有提供的信息都是准确且自洽的。\n\n我们的任务是计算一个随机变量 $X$ 的累积分布函数 (CDF) $F_{X}(x)$，该随机变量的概率密度函数 (PDF) 由区间 $(0,1)$ 上的反正弦分布给出。其概率密度函数为：\n$$f_{X}(x) = \\frac{1}{\\pi \\sqrt{x(1-x)}}, \\quad x \\in (0,1)$$\n累积分布函数定义为 $F_{X}(x) = \\mathbb{P}(X \\leq x)$。对于任意 $x \\in [0,1]$，它由概率密度函数从 $0$ 到 $x$ 的积分给出：\n$$F_{X}(x) = \\int_{0}^{x} f_{X}(u) \\, du = \\int_{0}^{x} \\frac{1}{\\pi \\sqrt{u(1-u)}} \\, du$$\n这个积分在下限 $u=0$ 处（如果 $x0$）以及在上限 $u=x$ 处（如果 $x=1$）是瑕积分，但它是收敛的。我们着手计算它。\n\n被积函数的形式，特别是项 $\\sqrt{u(1-u)}$，提示我们使用三角换元法。我们引入变量替换 $u = \\sin^2(\\theta)$。选择这个代换是因为它可以通过勾股恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$ 简化平方根下的表达式。\n\n微分 $du$ 通过对 $u$ 关于 $\\theta$ 求导得到：\n$$du = \\frac{d}{d\\theta}(\\sin^2(\\theta)) \\, d\\theta = 2 \\sin(\\theta) \\cos(\\theta) \\, d\\theta$$\n\n接下来，我们必须将积分限从变量 $u$ 转换到新变量 $\\theta$。\n积分下限是 $u=0$。代入我们的变换式，得到 $0 = \\sin^2(\\theta)$，这意味着 $\\sin(\\theta)=0$。我们选择 $\\theta=0$。\n积分上限是 $u=x$。这得到 $x = \\sin^2(\\theta)$，这意味着 $\\sin(\\theta) = \\sqrt{x}$。我们选择主值，因此 $\\theta = \\arcsin(\\sqrt{x})$。\n当 $u$ 在 $0$ 到 $x \\in [0,1]$ 范围内变化时，我们选择的变量 $\\theta$ 在 $0$ 到 $\\arcsin(\\sqrt{x})$ 范围内变化。因为 $x \\in [0,1]$，所以 $\\sqrt{x} \\in [0,1]$，因此 $\\arcsin(\\sqrt{x})$ 位于区间 $[0, \\pi/2]$ 内。在这个区间内，$\\sin(\\theta)$ 和 $\\cos(\\theta)$ 都是非负的。\n\n现在，我们将 $u = \\sin^2(\\theta)$ 代入项 $\\sqrt{u(1-u)}$ 中：\n$$\\sqrt{u(1-u)} = \\sqrt{\\sin^2(\\theta)(1 - \\sin^2(\\theta))} = \\sqrt{\\sin^2(\\theta)\\cos^2(\\theta)} = |\\sin(\\theta)\\cos(\\theta)|$$\n如前所述，对于 $\\theta \\in [0, \\pi/2]$，$\\sin(\\theta) \\ge 0$ 且 $\\cos(\\theta) \\ge 0$，所以 $|\\sin(\\theta)\\cos(\\theta)| = \\sin(\\theta)\\cos(\\theta)$。\n\n现在我们可以将所有部分代回到 $F_X(x)$ 的积分中：\n$$F_{X}(x) = \\int_{u=0}^{u=x} \\frac{1}{\\pi \\sqrt{u(1-u)}} \\, du = \\int_{\\theta=0}^{\\theta=\\arcsin(\\sqrt{x})} \\frac{1}{\\pi \\sin(\\theta)\\cos(\\theta)} (2 \\sin(\\theta)\\cos(\\theta) \\, d\\theta)$$\n分子和分母中的项 $\\sin(\\theta)\\cos(\\theta)$ 可以消去，前提是 $\\sin(\\theta)\\cos(\\theta) \\neq 0$。这种情况发生在积分区间的端点，而瑕积分的定义能正确处理这种情况。表达式得到显著简化：\n$$F_{X}(x) = \\frac{1}{\\pi} \\int_{0}^{\\arcsin(\\sqrt{x})} 2 \\, d\\theta$$\n这个积分现在可以直接计算：\n$$F_{X}(x) = \\frac{2}{\\pi} [\\theta]_{0}^{\\arcsin(\\sqrt{x})} = \\frac{2}{\\pi} (\\arcsin(\\sqrt{x}) - 0)$$\n因此，对于 $x \\in [0,1]$，累积分布函数为：\n$$F_{X}(x) = \\frac{2}{\\pi} \\arcsin(\\sqrt{x})$$\n\n最后，我们按要求检验边界条件。\n对于 $x=0$：\n$$F_{X}(0) = \\frac{2}{\\pi} \\arcsin(\\sqrt{0}) = \\frac{2}{\\pi} \\arcsin(0) = \\frac{2}{\\pi} \\cdot 0 = 0$$\n这与累积分布函数的定义是一致的，因为随机变量小于或等于其支撑集最小值的概率必须为 $0$。\n\n对于 $x=1$：\n$$F_{X}(1) = \\frac{2}{\\pi} \\arcsin(\\sqrt{1}) = \\frac{2}{\\pi} \\arcsin(1)$$\n$\\arcsin(1)$ 的主值是 $\\pi/2$。\n$$F_{X}(1) = \\frac{2}{\\pi} \\cdot \\frac{\\pi}{2} = 1$$\n这也与定义一致，因为随机变量小于或等于其支撑集最大值的概率必须为 $1$。\n\n推导出的表达式是区间 $[0,1]$ 上累积分布函数的一个有效的闭式解析表达式。", "answer": "$$\\boxed{\\frac{2}{\\pi} \\arcsin(\\sqrt{x})}$$", "id": "3039600"}, {"introduction": "虽然直接积分很有启发性，但它未能完全解释反正弦定律出人意料的特性。一个更深刻的直觉来自于一个巧妙的变量代换。这个练习 [@problem_id:3039568] 将引导你证明，复杂的反正弦分布实际上是一个均匀分布的角度 $\\Theta$ 经过 $\\sin^2(\\Theta)$ 变换后的结果，这不仅提供了一个强大的几何解释，也为计算相关概率提供了一种更简洁的方法。", "problem": "考虑一个标准的一维布朗运动 $B_{t}$，其中 $B_{0}=0$。定义随机变量 $T^{+}=\\int_{0}^{1}\\mathbf{1}_{\\{B_{t}0\\}}\\,dt$，表示该过程在单位区间上处于零以上的时间比例。在随机过程理论中，一个经过充分验证的事实是，$T^{+}$ 与一个 $\\mathrm{Beta}(1/2,1/2)$ 随机变量 $X$ 具有相同的分布，这被称为反正弦律表示。在本问题中，您将证明此表示背后的角度参数化的合理性，然后用它来计算一个感兴趣的概率。本问题中所有角度均以弧度为单位。\n\n从 $\\mathrm{Unif}(0,\\pi/2)$ 分布的概率密度函数（PDF）的基本定义和随机变量变换的变量替换公式出发，并仅使用 $\\mathrm{Beta}(a,b)$ 分布的标准定义，完成以下任务：\n\n1. 设 $\\Theta\\sim\\mathrm{Unif}(0,\\pi/2)$ 并定义变换 $X=\\sin^{2}\\Theta$。使用变量替换公式，推导 $X$ 的概率密度函数，并证明它与 $(0,1)$ 上的 $\\mathrm{Beta}(1/2,1/2)$ 概率密度函数一致。\n\n2. 将角度参数化 $X=\\sin^{2}\\Theta$ 解释为 $T^{+}$ 的反正弦律表示，并用它来计算概率 $\\mathbb{P}\\!\\left(T^{+}\\leq \\frac{1}{4}\\right)$，结果为一个精确的数值。不需要四舍五入。\n\n您的最终答案必须是一个实数。", "solution": "用户提供的问题是有效的。它在科学上基于随机过程理论和概率论，问题陈述清晰，有唯一且有意义的解，并且是客观陈述的。其前提，包括占位时间 $T^{+}$ 和一个 $\\mathrm{Beta}(1/2, 1/2)$ 随机变量的分布等价性，是布朗运动研究中的标准结果，通常被称为 Lévy 反正弦律。这些任务是标准的数学练习，涉及变量替换和概率计算。因此，我们可以着手求解。\n\n按照问题陈述的要求，解答分为两部分。\n\n### 第1部分：$X = \\sin^{2}\\Theta$ 的概率密度函数推导\n\n设 $\\Theta$ 是一个在区间 $(0, \\pi/2)$ 上服从均匀分布的随机变量。其概率密度函数（PDF），记为 $f_{\\Theta}(\\theta)$，由下式给出：\n$$\nf_{\\Theta}(\\theta) = \\begin{cases} \\frac{1}{\\pi/2 - 0} = \\frac{2}{\\pi}  \\text{for } \\theta \\in (0, \\pi/2) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n我们给定变换 $X = g(\\Theta) = \\sin^{2}\\Theta$。$\\Theta$ 的支集是区间 $(0, \\pi/2)$。在此区间上，函数 $g(\\theta) = \\sin^{2}\\theta$ 是严格递增的。该变换的值域从 $g(0) = \\sin^{2}(0) = 0$ 到 $g(\\pi/2) = \\sin^{2}(\\pi/2) = 1$。因此，随机变量 $X$ 的支集是区间 $(0, 1)$。\n\n为了求出 $X$ 的概率密度函数，我们使用变量替换公式。首先，我们求逆变换。对于 $x \\in (0, 1)$，我们求解 $x = \\sin^{2}\\theta$ 以得到 $\\theta$：\n$$\n\\sin\\theta = \\sqrt{x}\n$$\n我们取正平方根，因为当 $\\theta \\in (0, \\pi/2)$ 时，$\\sin\\theta$ 是正的。这给出了逆函数 $h(x)$：\n$$\n\\theta = h(x) = \\arcsin(\\sqrt{x})\n$$\n接下来，我们计算 $h(x)$ 关于 $x$ 的导数：\n$$\n\\frac{dh}{dx} = \\frac{d}{dx}\\arcsin(\\sqrt{x}) = \\frac{1}{\\sqrt{1 - (\\sqrt{x})^{2}}} \\cdot \\frac{d}{dx}(\\sqrt{x})\n$$\n$\\sqrt{x} = x^{1/2}$ 的导数是 $\\frac{1}{2}x^{-1/2} = \\frac{1}{2\\sqrt{x}}$。代入后，我们得到：\n$$\n\\frac{dh}{dx} = \\frac{1}{\\sqrt{1-x}} \\cdot \\frac{1}{2\\sqrt{x}} = \\frac{1}{2\\sqrt{x(1-x)}}\n$$\n对于 $x \\in (0, 1)$，该导数为正，所以其绝对值就是导数本身。\n\n变量替换公式给出的 $X$ 的概率密度函数，记为 $f_{X}(x)$，是：\n$$\nf_{X}(x) = f_{\\Theta}(h(x)) \\left| \\frac{dh}{dx} \\right|\n$$\n对于 $x \\in (0, 1)$，我们有 $\\theta = h(x) = \\arcsin(\\sqrt{x}) \\in (0, \\pi/2)$，所以 $f_{\\Theta}(h(x)) = 2/\\pi$。代入各个部分，我们求得 $X$ 的概率密度函数：\n$$\nf_{X}(x) = \\frac{2}{\\pi} \\cdot \\frac{1}{2\\sqrt{x(1-x)}} = \\frac{1}{\\pi\\sqrt{x(1-x)}} \\quad \\text{for } x \\in (0, 1)\n$$\n现在，我们将此结果与标准的 $\\mathrm{Beta}(a,b)$ 分布的概率密度函数进行比较，后者由下式给出：\n$$\nf(x; a, b) = \\frac{x^{a-1}(1-x)^{b-1}}{B(a, b)} \\quad \\text{for } x \\in (0, 1)\n$$\n其中 $B(a,b)$ 是贝塔函数，$B(a,b) = \\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}$，而 $\\Gamma(z)$ 是伽马函数。\n\n对于一个 $\\mathrm{Beta}(1/2, 1/2)$ 分布，我们设 $a=1/2$ 和 $b=1/2$。分子项变为：\n$$\nx^{1/2 - 1}(1-x)^{1/2 - 1} = x^{-1/2}(1-x)^{-1/2} = \\frac{1}{\\sqrt{x}\\sqrt{1-x}} = \\frac{1}{\\sqrt{x(1-x)}}\n$$\n贝塔函数的计算结果为：\n$$\nB(1/2, 1/2) = \\frac{\\Gamma(1/2)\\Gamma(1/2)}{\\Gamma(1/2 + 1/2)} = \\frac{(\\sqrt{\\pi})(\\sqrt{\\pi})}{\\Gamma(1)} = \\frac{\\pi}{1} = \\pi\n$$\n这里我们使用了已知的值 $\\Gamma(1/2) = \\sqrt{\\pi}$ 和 $\\Gamma(1) = 0! = 1$。\n\n整合 $\\mathrm{Beta}(1/2, 1/2)$ 的概率密度函数，我们得到：\n$$\nf(x; 1/2, 1/2) = \\frac{1}{\\pi\\sqrt{x(1-x)}} \\quad \\text{for } x \\in (0, 1)\n$$\n这与我们推导出的概率密度函数 $f_{X}(x)$ 完全相同。这完成了问题的第一部分，验证了当 $\\Theta \\sim \\mathrm{Unif}(0, \\pi/2)$ 时，$X = \\sin^{2}\\Theta$ 服从 $\\mathrm{Beta}(1/2, 1/2)$ 分布。\n\n### 第2部分：$\\mathbb{P}\\!\\left(T^{+}\\leq \\frac{1}{4}\\right)$ 的计算\n\n问题陈述，随机变量 $T^{+}$（表示标准布朗运动在单位时间区间上处于零以上的时间比例）与一个 $\\mathrm{Beta}(1/2, 1/2)$ 随机变量具有相同的分布。我们用 $T^{+} \\stackrel{d}{=} X$ 来表示这种分布等价性，其中 $X \\sim \\mathrm{Beta}(1/2, 1/2)$。\n\n我们被要求计算概率 $\\mathbb{P}\\!\\left(T^{+}\\leq \\frac{1}{4}\\right)$。由于分布等价，这等同于计算 $\\mathbb{P}\\!\\left(X\\leq \\frac{1}{4}\\right)$。\n\n从第1部分我们知道，如果 $X \\sim \\mathrm{Beta}(1/2, 1/2)$，我们可以将其表示为 $X = \\sin^{2}\\Theta$，其中 $\\Theta \\sim \\mathrm{Unif}(0, \\pi/2)$。这就是问题中提到的角度参数化。使用此表示，我们可以将关于 $X$ 的不等式转化为关于 $\\Theta$ 的不等式：\n$$\nX \\leq \\frac{1}{4} \\quad \\implies \\quad \\sin^{2}\\Theta \\leq \\frac{1}{4}\n$$\n由于 $\\Theta$ 在区间 $(0, \\pi/2)$ 内，$\\sin\\Theta$ 是正的。我们可以在不等式两边开平方根，且不等号方向不变：\n$$\n\\sin\\Theta \\leq \\sqrt{\\frac{1}{4}} = \\frac{1}{2}\n$$\n正弦函数在 $(0, \\pi/2)$ 上是严格递增的。因此，我们可以对两边应用反正弦函数 $\\arcsin$：\n$$\n\\Theta \\leq \\arcsin\\left(\\frac{1}{2}\\right)\n$$\n角度是以弧度为单位度量的，我们知道 $\\arcsin(1/2) = \\pi/6$。所以，对 $\\Theta$ 的条件是 $0  \\Theta \\leq \\pi/6$。\n\n我们现在需要计算概率 $\\mathbb{P}(0  \\Theta \\leq \\pi/6)$。因为 $\\Theta$ 在 $(0, \\pi/2)$ 上是均匀分布的，它落入一个子区间的概率是该子区间的长度与总支集区间长度的比值：\n$$\n\\mathbb{P}(0  \\Theta \\leq \\pi/6) = \\frac{\\text{length of } (0, \\pi/6]}{\\text{length of } (0, \\pi/2)} = \\frac{\\pi/6 - 0}{\\pi/2 - 0} = \\frac{\\pi/6}{\\pi/2}\n$$\n$$\n\\mathbb{P}(0  \\Theta \\leq \\pi/6) = \\frac{\\pi}{6} \\cdot \\frac{2}{\\pi} = \\frac{2}{6} = \\frac{1}{3}\n$$\n因此，所求概率为 $\\frac{1}{3}$。\n$$\n\\mathbb{P}\\!\\left(T^{+}\\leq \\frac{1}{4}\\right) = \\mathbb{P}\\!\\left(X\\leq \\frac{1}{4}\\right) = \\mathbb{P}(\\sin^{2}\\Theta \\leq \\frac{1}{4}) = \\mathbb{P}(0  \\Theta \\leq \\pi/6) = \\frac{1}{3}\n$$", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "3039568"}, {"introduction": "当理论定律与经验观察相符时，它们才最具说服力。最后的这个练习通过模拟数据来验证反正弦定律，从而将理论与计算联系起来 [@problem_id:3039578]。通过使用反正弦CDF进行概率积分变换，你将开发一个强大的诊断工具，用于检验计算机生成的布朗运动路径是否符合理论预测，这是现代量化金融和物理学中的一项核心技能。", "problem": "您将实现并应用一种基于反正弦累积分布函数的原则性诊断方法，以检验从离散化布朗运动中模拟出的时间比例是否表现得像从参数为 $\\tfrac{1}{2}$ 和 $\\tfrac{1}{2}$ 的贝塔分布中抽取的样本。您的程序必须是完全确定性的。\n\n起点与核心事实：\n- 设 $\\{B_t\\}_{t \\in [0,1]}$ 为一个标准布朗运动，满足 $B_0 = 0$，其特征是具有均值为 $0$、方差等于时间增量的独立高斯增量。同时考虑一个带漂移 $\\mu \\in \\mathbb{R}$ 的布朗运动，定义为 $X_t = \\mu t + B_t$。\n- 反正弦定律指出，对于标准布朗运动（即 $\\mu = 0$），在 $[0,1]$ 区间内过程处于零以上的时间比例服从参数为 $(\\tfrac{1}{2}, \\tfrac{1}{2})$ 的贝塔分布。请使用此作为模拟比例的零模型。\n- 参数为 $(\\tfrac{1}{2}, \\tfrac{1}{2})$ 的贝塔分布在 $x \\in (0,1)$ 上的密度函数为 $f(x) = \\dfrac{1}{\\pi \\sqrt{x(1-x)}}$，在 $x \\in [0,1]$ 上的累积分布函数为 $F(x) = \\dfrac{2}{\\pi} \\arcsin(\\sqrt{x})$。\n- 概率积分变换指出，如果 $X$ 有一个连续的累积分布函数 $F$，那么 $U = F(X)$ 在 $[0,1]$ 上均匀分布。\n- 用于 $[0,1]$ 上均匀分布的单样本拟合优度检验的柯尔莫哥洛夫-斯米尔诺夫（KS）统计量定义为\n$$\nD_n = \\sup_{u \\in [0,1]} \\left| F_n(u) - u \\right|,\n$$\n其中 $F_n$ 是一个独立同分布样本 $\\{U_i\\}_{i=1}^{n}$ 的经验累积分布函数。\n\n需要实现的任务：\n1. 样本路径的模拟。对于给定的整数 $N \\ge 1$ 和 $M \\ge 1$ 以及漂移 $\\mu \\in \\mathbb{R}$，使用具有 $M$ 个步长和时间步长 $\\Delta t = 1/M$ 的等间距网格，在 $[0,1]$ 上模拟 $N$ 条独立的带漂移布朗运动的离散时间路径。对每条路径：\n   - 生成增量 $\\Delta X_k = \\mu \\Delta t + \\sqrt{\\Delta t} Z_k$，其中 $k = 1, \\dots, M$，$Z_k$ 是独立的标准正态随机变量。\n   - 计算部分和 $X_{t_k} = \\sum_{j=1}^{k} \\Delta X_j$，其中 $k = 1, \\dots, M$。\n   - 计算 $X_{t_k}  0$ 的网格时间的样本比例 $P$，即 $P = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\{X_{t_k}  0\\}$。\n   - 重复此过程以获得 $N$ 个比例 $\\{P_i\\}_{i=1}^{N}$。使用下面指定的固定随机种子以确保确定性。\n2. 反正弦变换诊断。使用反正弦累积分布函数 $F(x) = \\dfrac{2}{\\pi} \\arcsin(\\sqrt{x})$，通过 $U_i = F(P_i)$，$i = 1, \\dots, N$ 对比例进行变换。在比例服从参数为 $(\\tfrac{1}{2}, \\tfrac{1}{2})$ 的贝塔分布的零假设下，变换后的值 $\\{U_i\\}$ 应近似于在 $[0,1]$ 上独立同分布的均匀分布。\n3. 拟合优度度量。计算单样本柯尔莫哥洛夫-斯米尔诺夫统计量 $D_n$，比较 $\\{U_i\\}_{i=1}^{N}$ 的经验累积分布函数与 $[0,1]$ 上的均匀累积分布函数 $u \\mapsto u$。\n4. 确定性要求。使用基础随机种子 $314159$，并且对于索引为 $j = 0, 1, 2, \\dots$ 的每个测试用例，使用派生种子 $314159 + 1000 \\cdot j$ 来初始化该测试用例的随机数生成器，以使结果可复现且与执行顺序无关。\n\n测试套件：\n您必须对以下五个参数集 $(N, M, \\mu)$ 中的每一个进行评估并报告柯尔莫哥洛夫-斯米尔诺夫统计量 $D_n$：\n- 用例 1（理想路径，零模型，中等大样本）：$(N, M, \\mu) = (4000, 1024, 0.0)$。\n- 用例 2（边界条件：粗糙时间网格，较小样本）：$(N, M, \\mu) = (800, 32, 0.0)$。\n- 用例 3（边界条件：非2次幂网格，零模型）：$(N, M, \\mu) = (1500, 127, 0.0)$。\n- 用例 4（备择模型，正漂移）：$(N, M, \\mu) = (4000, 1024, 0.25)$。\n- 用例 5（备择模型，负漂移）：$(N, M, \\mu) = (4000, 1024, -0.25)$。\n\n实现约束与输出规范：\n- 您的程序必须模拟这些过程，通过反正弦累积分布函数计算变换后的值 $\\{U_i\\}$，为每个测试用例计算柯尔莫哥洛夫-斯米尔诺夫统计量 $D_n$，并按顺序返回五个用例的结果。\n- 您的程序不得要求任何用户输入，也不得访问任何外部文件或网络。\n- 为避免过多的内存使用，您可以分批模拟，但对于给定的种子，最终结果必须完全相同。\n- 最终输出格式：打印一行，包含一个列表，其中有五个结果，这些结果是保留小数点后六位的小数，用逗号分隔并用方括号括起，例如，“[0.012345,0.067890,0.000123,0.045678,0.098765]”。", "solution": "问题陈述已经过仔细验证，并被确定为有效。它在科学上基于随机过程和统计学理论，问题设定适定，所有必要的参数和方法都已明确指定，并且其表述是客观的。任务是实现一个数值实验来检验布朗运动的反正弦定律。\n\n解决方案通过为每个指定的测试用例实现一个四步诊断程序来推进。理论基础和算法实现详述如下。\n\n**1. 理论框架**\n\n该问题涉及在时间区间 $[0, 1]$ 上的带漂移 $\\mu \\in \\mathbb{R}$ 的布朗运动，由随机微分方程 $dX_t = \\mu dt + dB_t$ 定义，初始条件为 $X_0 = 0$。其中，$\\{B_t\\}_{t \\in [0,1]}$ 是一个标准布朗运动。\n\n此问题的基石是 Lévy 的反正弦定律。对于标准布朗运动（即 $\\mu=0$），该定律指出，过程在零以上所花费的时间比例，记为 $P = \\text{Leb}\\{t \\in [0,1] : B_t  0\\}$，是一个服从反正弦分布的随机变量。该分布等价于形状参数为 $(\\frac{1}{2}, \\frac{1}{2})$ 的贝塔分布。在 $x \\in (0,1)$ 上的概率密度函数为 $f(x) = \\frac{1}{\\pi\\sqrt{x(1-x)}}$，其在 $x \\in [0,1]$ 上的累积分布函数（CDF）为 $F(x) = \\frac{2}{\\pi} \\arcsin(\\sqrt{x})$。\n\n该诊断检验建立在概率积分变换（PIT）之上。PIT 指出，如果一个随机变量 $X$ 具有连续的 CDF $F_X$，则变换后的随机变量 $U = F_X(X)$ 在 $[0,1]$ 上均匀分布。因此，如果模拟的比例 $\\{P_i\\}$ 确实是从反正弦分布中抽取的样本，那么变换后的值 $\\{U_i = F(P_i)\\}$ 应该构成一个来自标准均匀分布 $U(0,1)$ 的样本。\n\n为了量化变换后样本 $\\{U_i\\}$ 与均匀分布的一致性，使用了单样本柯尔莫哥洛夫-斯米尔诺夫（KS）检验。KS 统计量 $D_n$ 衡量样本的经验累积分布函数（ECDF）$F_n(u)$ 与参考分布的 CDF（在此情况下为 $G(u) = u$）之间的最大绝对差。该统计量正式定义为：\n$$D_n = \\sup_{u \\in [0,1]} |F_n(u) - u|$$\n$D_n$ 的值较小表示与参考分布拟合良好，而值较大则表明样本并非从此分布中抽取。\n\n**2. 算法实现**\n\n整体算法模拟过程的路径，计算相关统计量，并执行拟合优度检验。这对五个参数集 $(N, M, \\mu)$ 中的每一个都进行操作。\n\n**步骤 2.1：样本路径的模拟**\n对于每个具有参数 $N$、$M$ 和 $\\mu$ 的测试用例，我们在一个离散化的时间网格上模拟 $N$ 条独立的过程 $X_t$ 路径。时间区间 $[0,1]$ 被划分为 $M$ 个大小为 $\\Delta t = 1/M$ 的步长。路径使用 Euler-Maruyama 格式进行近似。在时间 $t_k = k\\Delta t$ 的位置由其增量之和给出：\n$$X_{t_k} = \\sum_{j=1}^{k} \\Delta X_j$$\n其中增量 $\\Delta X_j$ 作为独立随机变量生成：\n$$\\Delta X_j = \\mu \\Delta t + \\sqrt{\\Delta t} Z_j$$\n这里，$\\{Z_j\\}_{j=1}^M$ 是来自标准正态分布 $Z_j \\sim \\mathcal{N}(0,1)$ 的独立抽样。为确保可复现性，对于第 $j$ 个测试用例（0-索引），随机数生成器被设定种子为 $314159 + 1000 \\cdot j$。\n\n**步骤 2.2：正值时间占比的计算**\n对于 $N$ 条模拟路径中的每一条，我们计算路径值为正的时间步数的比例。对于第 $i$ 条路径，此比例 $P_i$ 计算如下：\n$$P_i = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\{X_{t_k}^{(i)}  0\\}$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。此过程产生一个包含 $N$ 个比例的样本 $\\{P_i\\}_{i=1}^N$。\n\n**步骤 2.3：反正弦变换诊断**\n样本中的每个比例 $P_i$ 都使用反正弦 CDF 进行变换：\n$$U_i = F(P_i) = \\frac{2}{\\pi} \\arcsin(\\sqrt{P_i})$$\n在零假设（即 $\\mu=0$ 且离散化足够精细）下，得到的样本 $\\{U_i\\}_{i=1}^N$ 应近似为在 $[0,1]$ 上独立同分布的均匀分布。\n\n**步骤 2.4：拟合优度度量计算**\n最后一步是计算变换后样本 $\\{U_i\\}_{i=1}^N$ 相对于标准均匀分布的 KS 统计量 $D_N$。这是通过 `scipy.stats.kstest` 函数完成的，该函数为计算 $D_N$ 提供了一个稳健和标准的实现。\n\n对于五个测试用例中的每一个，都重复这整个过程。用例 1、2 和 3 使用 $\\mu=0$，预期会产生较小的 KS 统计量，这与反正弦定律（零模型）一致。用例 4 和 5 使用非零漂移（分别为 $\\mu=0.25$ 和 $\\mu=-0.25$），对于这些情况，反正弦定律不成立。因此，对于这些备择模型，$P_i$ 的分布将是偏斜的，变换后的 $U_i$ 值将不是均匀的，我们预期会得到显著更大的 KS 统计量，表明拒绝零模型。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import kstest\n\ndef compute_ks_for_case(N, M, mu, seed):\n    \"\"\"\n    Simulates Brownian motion paths and computes the KS statistic.\n\n    Args:\n        N (int): Number of independent paths to simulate.\n        M (int): Number of time steps for discretization.\n        mu (float): The drift of the Brownian motion.\n        seed (int): The seed for the random number generator.\n\n    Returns:\n        float: The calculated Kolmogorov-Smirnov statistic.\n    \"\"\"\n    # Initialize the random number generator for reproducibility.\n    # The default_rng is the modern, recommended approach in NumPy.\n    rng = np.random.default_rng(seed)\n\n    # Define the time step for the discretization.\n    dt = 1.0 / M\n\n    # Step 1: Simulate N paths with M steps each.\n    # We generate all random numbers at once for efficiency.\n    # Z is an N x M array of standard normal random variables.\n    Z = rng.standard_normal(size=(N, M))\n    \n    # Calculate the increments for each step of each path.\n    # dX = mu*dt + sqrt(dt)*Z\n    dX = mu * dt + np.sqrt(dt) * Z\n\n    # Form the paths by taking the cumulative sum of increments along the time axis.\n    # X is an N x M array where each row represents a full path.\n    X = np.cumsum(dX, axis=1)\n\n    # Step 2: Compute the proportion of time each path is positive.\n    # Count the number of time points k where X_{t_k}  0 for each path.\n    positive_counts = np.sum(X  0, axis=1)\n    \n    # The proportion P is the count divided by the total number of steps.\n    P = positive_counts / M\n\n    # Step 3: Apply the arcsine transform (Probability Integral Transform).\n    # The CDF of the Beta(1/2, 1/2) distribution is F(x) = (2/pi) * arcsin(sqrt(x)).\n    # We transform the proportions P into a sample U, which should be uniform on [0,1]\n    # under the null hypothesis (mu=0).\n    # The input to np.sqrt is guaranteed to be in [0, 1].\n    U = (2.0 / np.pi) * np.arcsin(np.sqrt(P))\n\n    # Step 4: Compute the one-sample Kolmogorov-Smirnov statistic.\n    # We test the sample U against a standard uniform distribution ('uniform').\n    # kstest returns a tuple (statistic, pvalue); we only need the statistic.\n    ks_statistic, _ = kstest(U, 'uniform')\n    \n    return ks_statistic\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement as a list of tuples.\n    # Each tuple is (N, M, mu).\n    test_cases = [\n        (4000, 1024, 0.0),   # Case 1: Null model, large sample\n        (800, 32, 0.0),      # Case 2: Null model, coarse grid\n        (1500, 127, 0.0),    # Case 3: Null model, non-power-of-two grid\n        (4000, 1024, 0.25),  # Case 4: Alternative model, positive drift\n        (4000, 1024, -0.25), # Case 5: Alternative model, negative drift\n    ]\n\n    base_seed = 314159\n    results = []\n\n    # Iterate through the test cases, computing the KS statistic for each.\n    for j, (N, M, mu) in enumerate(test_cases):\n        # The seed for each case is derived deterministically as specified.\n        seed = base_seed + 1000 * j\n        result = compute_ks_for_case(N, M, mu, seed)\n        results.append(result)\n\n    # Format the results to six decimal places and print in the required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function.\nsolve()\n\n```", "id": "3039578"}]}