{"hands_on_practices": [{"introduction": "理解Doob分解的最佳方式是将其应用于一个简单直观的过程。第一个练习将引导你分析一个带有恒定漂移的离散时间随机游走。通过运用核心定义，你将能够手动将过程中的可预测趋势从随机波动中分离出来，从而以最纯粹的形式揭示其鞅部分和可预测部分。[@problem_id:3050559]", "problem": "考虑一个带滤概率空间 $(\\Omega, \\mathcal{F}, (\\mathcal{F}_n)_{n \\geq 0}, \\mathbb{P})$ 和一个适应的可积序列 $(\\xi_n)_{n \\geq 1}$，该序列对所有 $n \\geq 1$ 满足 $E[\\xi_n \\mid \\mathcal{F}_{n-1}] = 0$。定义鞅差和 $S_n = \\sum_{k=1}^{n} \\xi_k$，其中 $S_0 = 0$，并固定一个常数漂移 $\\mu \\geq 0$。考虑过程 $X_n = S_n + \\mu n$，其中 $n \\geq 0$。\n\n仅使用鞅、下鞅和离散时间 Doob 分解（离散时间 Doob-Meyer 分解）的核心定义，确定下鞅 $(X_n)$ 到和式 $X_n = M_n + A_n$ 的分解，其中 $(M_n)$ 是一个鞅，$(A_n)$ 是一个可预测的增过程且 $A_0 = 0$。找出用 $S_n$ 和 $\\mu$ 表示的 $M_n$ 和 $A_n$ 的显式表达式。\n\n您的最终答案必须是一个单一的解析表达式，使用 $\\mathrm{pmatrix}$ 环境将 $M_n$ 和 $A_n$ 列为一个行向量。无需四舍五入。", "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 一个带滤概率空间 $(\\Omega, \\mathcal{F}, (\\mathcal{F}_n)_{n \\geq 0}, \\mathbb{P})$。\n- 一个适应的可积随机变量序列 $(\\xi_n)_{n \\geq 1}$。\n- 序列的一个条件：对所有 $n \\geq 1$，$E[\\xi_n \\mid \\mathcal{F}_{n-1}] = 0$。这表明 $(\\xi_n)$ 是一个鞅差序列。\n- 一个过程 $S_n = \\sum_{k=1}^{n} \\xi_k$（$n \\geq 1$），初始条件为 $S_0 = 0$。\n- 一个常数漂移 $\\mu \\geq 0$。\n- 一个过程 $X_n = S_n + \\mu n$（$n \\geq 0$）。\n- 任务是找到 $(X_n)$ 的 Doob 分解，该过程被声明为一个下鞅，分解为 $X_n = M_n + A_n$。\n- $(M_n)$ 必须是相对于 $(\\mathcal{F}_n)_{n \\geq 0}$ 的鞅。\n- $(A_n)$ 必须是一个可预测的增过程，且 $A_0 = 0$。\n- 最终答案应为 $M_n$ 和 $A_n$ 的显式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在离散时间随机过程的数学框架内是定义良好的。\n- **科学基础**：所有概念——带滤概率空间、适应过程、鞅差序列、鞅、下鞅和 Doob 分解——都是现代概率论中的标准和基本概念。其设置在逻辑上和数学上都是合理的。\n- **适定性**：Doob 分解定理保证了任何下鞅分解的存在性和唯一性。该问题提供了应用此定理并找到唯一分量 $M_n$ 和 $A_n$ 所需的所有信息。\n- **客观性**：该问题使用形式化、精确的数学语言陈述，没有歧义或主观因素。\n- **完整性与一致性**：该问题提供了一套完整的定义和条件。我们可以根据已知条件验证 $(X_n)$ 是一个下鞅的前提。条件 $\\mu \\geq 0$ 至关重要，并且与下鞅的性质一致。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供一个完整的解答。\n\n### 解题推导\n目标是找到过程 $X_n = S_n + \\mu n$ 的 Doob 分解。此分解将一个下鞅 $(X_n)$ 表示为一个鞅 $(M_n)$ 和一个可预测的增过程 $(A_n)$ 的和，且 $A_0 = 0$。\n\n首先，我们必须确认 $(X_n)_{n \\geq 0}$ 确实是关于滤子 $(\\mathcal{F}_n)_{n \\geq 0}$ 的一个下鞅。如果一个过程是适应的、可积的，并且对所有 $n \\geq 1$ 满足 $\\mathbb{E}[X_n \\mid \\mathcal{F}_{n-1}] \\geq X_{n-1}$，那么它就是一个下鞅。\n\n1.  **适应性**：序列 $(\\xi_k)_{k \\geq 1}$ 是适应的，意味着每个 $\\xi_k$ 都是 $\\mathcal{F}_k$-可测的。因此，$S_n = \\sum_{k=1}^{n} \\xi_k$ 是 $\\mathcal{F}_n$-可测的，因为它是 $\\mathcal{F}_n$-可测的随机变量之和。项 $\\mu n$ 对每个 $n$ 都是一个确定性常数，所以它对于任何 $\\sigma$-代数（包括 $\\mathcal{F}_n$）都是可测的。因此，$X_n = S_n + \\mu n$ 是 $\\mathcal{F}_n$-适应的。\n\n2.  **可积性**：我们已知 $(\\xi_n)$ 是一个可积序列，所以对所有 $n \\geq 1$，$\\mathbb{E}[|\\xi_n|]  \\infty$。根据期望的三角不等式，$\\mathbb{E}[|S_n|] = \\mathbb{E}\\left[\\left|\\sum_{k=1}^{n} \\xi_k\\right|\\right] \\leq \\sum_{k=1}^{n} \\mathbb{E}[|\\xi_k|]$。由于这是有限个有限数的和，所以 $\\mathbb{E}[|S_n|]  \\infty$。因此，$\\mathbb{E}[|X_n|] = \\mathbb{E}[|S_n + \\mu n|] \\leq \\mathbb{E}[|S_n|] + |\\mu n|  \\infty$。于是，$(X_n)$ 是一个可积过程。\n\n3.  **下鞅性质**：我们计算 $X_n$ 在给定 $\\mathcal{F}_{n-1}$ 下的条件期望（对于 $n \\geq 1$）：\n    $$\\mathbb{E}[X_n \\mid \\mathcal{F}_{n-1}] = \\mathbb{E}[S_n + \\mu n \\mid \\mathcal{F}_{n-1}]$$\n    使用定义 $S_n = S_{n-1} + \\xi_n$ 和条件期望的线性性：\n    $$\\mathbb{E}[X_n \\mid \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n-1} + \\xi_n + \\mu n \\mid \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n-1} \\mid \\mathcal{F}_{n-1}] + \\mathbb{E}[\\xi_n \\mid \\mathcal{F}_{n-1}] + \\mathbb{E}[\\mu n \\mid \\mathcal{F}_{n-1}]$$\n    - 由于 $S_{n-1}$ 是 $\\mathcal{F}_{n-1}$-可测的，所以 $\\mathbb{E}[S_{n-1} \\mid \\mathcal{F}_{n-1}] = S_{n-1}$。\n    - 根据问题陈述，$E[\\xi_n \\mid \\mathcal{F}_{n-1}] = 0$。\n    - 由于 $\\mu n$ 是一个常数，它是 $\\mathcal{F}_{n-1}$-可测的，所以 $\\mathbb{E}[\\mu n \\mid \\mathcal{F}_{n-1}] = \\mu n$。\n    结合这些结果：\n    $\\mathbb{E}[X_n \\mid \\mathcal{F}_{n-1}] = S_{n-1} + 0 + \\mu n = S_{n-1} + \\mu n$\n    我们将其与 $X_{n-1} = S_{n-1} + \\mu(n-1)$ 进行比较：\n    $\\mathbb{E}[X_n \\mid \\mathcal{F}_{n-1}] = (S_{n-1} + \\mu(n-1)) + \\mu = X_{n-1} + \\mu$\n    由于已知 $\\mu \\geq 0$，我们有 $\\mathbb{E}[X_n \\mid \\mathcal{F}_{n-1}] \\geq X_{n-1}$。这证实了 $(X_n)$ 是一个下鞅。\n\n现在我们应用离散时间 Doob 分解定理。唯一的分解 $X_n = M_n + A_n$ 由以下公式给出：\n- $A_0 = 0$\n- 对 $n \\geq 1$，$A_n = \\sum_{k=1}^{n} (\\mathbb{E}[X_k \\mid \\mathcal{F}_{k-1}] - X_{k-1})$\n- 对 $n \\geq 0$，$M_n = X_n - A_n$\n\n我们来计算可预测的增过程 $(A_n)$。使用我们之前的结果 $\\mathbb{E}[X_k \\mid \\mathcal{F}_{k-1}] = X_{k-1} + \\mu$：\n$\\mathbb{E}[X_k \\mid \\mathcal{F}_{k-1}] - X_{k-1} = \\mu$\n因此，对于 $n \\geq 1$：\n$$A_n = \\sum_{k=1}^{n} \\mu = \\mu n$$\n对于 $n=0$，$A_0 = \\mu \\cdot 0 = 0$。这符合要求。\n我们来检查 $A_n = \\mu n$ 的性质：\n- **可预测性**：对于任何 $n \\geq 1$，$A_n = \\mu n$ 是一个确定性常数。任何常数对于任何 $\\sigma$-代数（包括 $\\mathcal{F}_{n-1}$）都是可测的。因此，$(A_n)$ 是一个可预测过程。\n- **递增性**：对于任何 $n \\geq 1$，$A_n - A_{n-1} = \\mu n - \\mu(n-1) = \\mu$。由于 $\\mu \\geq 0$，序列 $(A_n)$ 是非递减（递增）的。\n\n现在，我们求鞅分量 $(M_n)$：\n$M_n = X_n - A_n = (S_n + \\mu n) - (\\mu n) = S_n$\n所以，对所有 $n \\geq 0$，$M_n = S_n$。我们必须验证 $(M_n) = (S_n)$ 是一个鞅。\n- **适应性和可积性**：我们已经证明了 $(S_n)$ 是适应且可积的。\n- **鞅性质**：对于 $n \\geq 1$，我们需要检验是否 $\\mathbb{E}[M_n \\mid \\mathcal{F}_{n-1}] = M_{n-1}$。\n$$\\mathbb{E}[S_n \\mid \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n-1} + \\xi_n \\mid \\mathcal{F}_{n-1}] = \\mathbb{E}[S_{n-1} \\mid \\mathcal{F}_{n-1}] + \\mathbb{E}[\\xi_n \\mid \\mathcal{F}_{n-1}]$$\n由于 $S_{n-1}$ 是 $\\mathcal{F}_{n-1}$-可测的，且 $\\mathbb{E}[\\xi_n \\mid \\mathcal{F}_{n-1}] = 0$：\n$$\\mathbb{E}[S_n \\mid \\mathcal{F}_{n-1}] = S_{n-1} + 0 = S_{n-1}$$\n由于 $M_n = S_n$ 且 $M_{n-1} = S_{n-1}$，条件 $\\mathbb{E}[M_n \\mid \\mathcal{F}_{n-1}] = M_{n-1}$ 得到满足。因此，$(M_n)$ 是一个鞅。\n\n$X_n$ 的 Doob 分解是 $X_n = S_n + \\mu n$，其中鞅部分是 $M_n = S_n$，可预测的增过程部分是 $A_n = \\mu n$。\n\n显式表达式为：\n- $M_n = S_n$\n- $A_n = \\mu n$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nS_n  \\mu n\n\\end{pmatrix}\n}\n$$", "id": "3050559"}, {"introduction": "理论通过应用才能焕发生机。在这个计算练习中，你将通过模拟一个常见的随机模型——AR(1)过程，从抽象公式走向具体代码。你的任务是为一个模拟路径数值计算其Doob-Meyer分解，这将巩固你对可预测部分如何根据过去信息一步步计算的理解。[@problem_id:2388954]", "problem": "给定一个由一阶自回归 (AR(1)) 模型定义的离散时间、实值、适应过程。对于每个测试用例，该过程由参数 $\\mu$、$\\phi$、$\\sigma$、初始值 $X_0$ 和时间范围 $T$ 指定。其动态过程如下：\n$$\nX_t \\;=\\; \\mu \\;+\\; \\phi\\,X_{t-1} \\;+\\; \\varepsilon_t,\\quad t=1,2,\\dots,T,\n$$\n其中 $\\{\\varepsilon_t\\}_{t\\ge 1}$ 是独立同分布的高斯新息，满足 $\\varepsilon_t \\sim \\mathcal{N}(0,\\sigma^2)$，且滤子为自然滤子 $\\mathcal{F}_t=\\sigma(X_0,\\varepsilon_1,\\dots,\\varepsilon_t)$。\n\n对于每个测试用例：\n- 使用指定的参数和给定的随机种子初始化伪随机数生成器，模拟一条样本路径 $\\{X_t\\}_{t=0}^T$。将 $\\varepsilon_t$ 作为均值为 $0$、标准差为 $\\sigma$ 的独立高斯随机变量进行抽取。\n- 数值计算 $\\{X_t\\}$ 的离散时间 Doob–Meyer (Doob) 分解，得到过程 $\\{M_t\\}$ 和 $\\{A_t\\}$，使得\n$$\nX_t \\;=\\; X_0 \\;+\\; M_t \\;+\\; A_t,\\quad M_0=0,\\;A_0=0,\n$$\n其中 $\\{M_t\\}$ 是关于 $\\{\\mathcal{F}_t\\}$ 的鞅，而 $\\{A_t\\}$ 是关于 $\\{\\mathcal{F}_t\\}$ 的可预测过程。\n- 报告该测试用例的终值对 $[A_T, M_T]$。\n\n测试套件：\n- 用例 1 (一般非鞅)：$\\mu=0.5$, $\\phi=0.8$, $\\sigma=1.0$, $X_0=0.7$, $T=12$, seed $=314159$。\n- 用例 2 (鞅边界)：$\\mu=0.0$, $\\phi=1.0$, $\\sigma=0.8$, $X_0=1.2$, $T=10$, seed $=271828$。\n- 用例 3 (确定性边缘情况)：$\\mu=0.1$, $\\phi=0.9$, $\\sigma=0.0$, $X_0=-0.3$, $T=15$, seed $=42$。\n- 用例 4 (带漂移的单位根)：$\\mu=-0.2$, $\\phi=1.0$, $\\sigma=0.5$, $X_0=0.0$, $T=8$, seed $=7$。\n\n您的程序必须：\n- 对每个用例，使用提供的种子精确模拟一条路径。\n- 计算与关于自然滤子的离散时间 Doob 分解定义一致的终值 $A_T$ 和 $M_T$。\n- 将报告的每个数字四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的列表。每个元素必须是对应测试用例的双元素列表 $[A_T, M_T]$，顺序与上文相同。例如，总体输出应如下所示：\n`[ [a1,m1],[a2,m2],[a3,m3],[a4,m4] ]`\n但每个 $a_i$ 和 $m_i$ 都应替换为相应的四舍五入后的数值。", "solution": "在尝试给出解决方案之前，需对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **过程动态**：一个离散时间一阶自回归模型 (AR(1)) 由 $X_t = \\mu + \\phi X_{t-1} + \\varepsilon_t$ 给出，其中 $t=1, 2, \\dots, T$。\n- **初始值**：过程从给定的值 $X_0$ 开始。\n- **新息**：$\\{\\varepsilon_t\\}_{t \\ge 1}$ 是一个独立同分布 (i.i.d.) 的随机变量序列，其中 $\\varepsilon_t \\sim \\mathcal{N}(0, \\sigma^2)$。\n- **滤子**：自然滤子为 $\\mathcal{F}_t = \\sigma(X_0, \\varepsilon_1, \\dots, \\varepsilon_t)$。\n- **分解**：过程 $\\{X_t\\}$ 将被分解为 $X_t = X_0 + M_t + A_t$，其中 $\\{M_t\\}$ 是鞅，$\\{A_t\\}$ 是关于 $\\{\\mathcal{F}_t\\}$ 的可预测过程，且 $M_0 = A_0 = 0$。\n- **任务**：对于给定的样本路径，找出终值 $[A_T, M_T]$。\n- **测试用例**：\n    - 用例 1: $\\mu=0.5$, $\\phi=0.8$, $\\sigma=1.0$, $X_0=0.7$, $T=12$, seed $=314159$。\n    - 用例 2: $\\mu=0.0$, $\\phi=1.0$, $\\sigma=0.8$, $X_0=1.2$, $T=10$, seed $=271828$。\n    - 用例 3: $\\mu=0.1$, $\\phi=0.9$, $\\sigma=0.0$, $X_0=-0.3$, $T=15$, seed $=42$。\n    - 用例 4: $\\mu=-0.2$, $\\phi=1.0$, $\\sigma=0.5$, $X_0=0.0$, $T=8$, seed $=7$。\n- **输出要求**：报告每个用例的 $[A_T, M_T]$，数值四舍五入到六位小数，并按指定的列表的列表格式输出。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题建立在离散时间随机过程的基本概念之上。AR(1) 模型是线性随机过程的典型例子，而 Doob-Meyer 分解是鞅论中的一个基石定理。该问题在科学和数学上是合理的。\n- **良态性**：该问题是良态的。对于任何适应过程，Doob-Meyer 分解是唯一的。所有参数，包括每次模拟的随机种子，都已指定，确保所需的计算能够得到一个单一、可验证的结果。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n\n### 步骤 3：结论与行动\n该问题有效。这是一个基于既定数学原理的、定义明确的计算任务。将提供解决方案。\n\n### 基于原理的解决方案设计\n\n离散时间适应过程 $\\{X_t\\}_{t \\ge 0}$ 的 Doob-Meyer 分解指出，它可以唯一地写为 $X_t = X_0 + M_t + A_t$，其中 $\\{M_t\\}_{t \\ge 0}$ 是一个鞅，$\\{A_t\\}_{t \\ge 0}$ 是一个可预测过程，且 $M_0 = A_0 = 0$。\n\n该分解由过程增量 $\\Delta X_t = X_t - X_{t-1}$ 构建。每个增量被分解为其可预测部分和一个鞅差：\n$$\n\\Delta X_t = \\Delta A_t + \\Delta M_t\n$$\n其中 $\\Delta A_t = A_t - A_{t-1}$ 且 $\\Delta M_t = M_t - M_{t-1}$。\n\n根据定义，可预测过程的增量 $\\Delta A_t$ 是过程增量在给定前一时间步可用信息下的条件期望：\n$$\n\\Delta A_t = \\mathbb{E}[\\Delta X_t | \\mathcal{F}_{t-1}] = \\mathbb{E}[X_t - X_{t-1} | \\mathcal{F}_{t-1}]\n$$\n鞅分量的增量 $\\Delta M_t$ 是增量中的新息或“意外”部分：\n$$\n\\Delta M_t = \\Delta X_t - \\Delta A_t = (X_t - X_{t-1}) - \\mathbb{E}[X_t - X_{t-1} | \\mathcal{F}_{t-1}]\n$$\n根据构造，$\\mathbb{E}[\\Delta M_t | \\mathcal{F}_{t-1}] = 0$，这是鞅差序列的定义属性。\n\n对于给定的 AR(1) 过程，$X_t = \\mu + \\phi X_{t-1} + \\varepsilon_t$，其增量为：\n$$\n\\Delta X_t = X_t - X_{t-1} = (\\mu + \\phi X_{t-1} + \\varepsilon_t) - X_{t-1} = \\mu + (\\phi - 1)X_{t-1} + \\varepsilon_t\n$$\n我们现在计算条件期望以找到 $\\Delta A_t$：\n$$\n\\Delta A_t = \\mathbb{E}[\\mu + (\\phi - 1)X_{t-1} + \\varepsilon_t | \\mathcal{F}_{t-1}]\n$$\n利用期望的线性和条件期望的性质：\n1.  $\\mu$ 是一个常数，所以 $\\mathbb{E}[\\mu | \\mathcal{F}_{t-1}] = \\mu$。\n2.  $X_{t-1}$ 在时间 $t-1$ 时是已知的，因此它是 $\\mathcal{F}_{t-1}$-可测的。所以，$\\mathbb{E}[(\\phi - 1)X_{t-1} | \\mathcal{F}_{t-1}] = (\\phi - 1)X_{t-1}$。\n3.  新息 $\\varepsilon_t$ 独立于过去的滤子 $\\mathcal{F}_{t-1} = \\sigma(X_0, \\varepsilon_1, \\dots, \\varepsilon_{t-1})$ 并且均值为零。因此，$\\mathbb{E}[\\varepsilon_t | \\mathcal{F}_{t-1}] = \\mathbb{E}[\\varepsilon_t] = 0$。\n\n结合这些结果，得到可预测过程的增量：\n$$\n\\Delta A_t = \\mu + (\\phi - 1)X_{t-1}\n$$\n于是，鞅的增量为：\n$$\n\\Delta M_t = \\Delta X_t - \\Delta A_t = (\\mu + (\\phi - 1)X_{t-1} + \\varepsilon_t) - (\\mu + (\\phi - 1)X_{t-1}) = \\varepsilon_t\n$$\n终值 $A_T$ 和 $M_T$ 分别是其各自增量从 $t=1$ 到 $T$ 的和，因为 $A_0 = M_0 = 0$：\n$$\nA_T = \\sum_{t=1}^T \\Delta A_t = \\sum_{t=1}^T (\\mu + (\\phi - 1)X_{t-1})\n$$\n$$\nM_T = \\sum_{t=1}^T \\Delta M_t = \\sum_{t=1}^T \\varepsilon_t\n$$\n\n### 算法步骤\n对于每个测试用例，数值解法包括以下步骤：\n1.  初始化参数：$\\mu, \\phi, \\sigma, X_0, T,$ 以及随机种子。\n2.  使用种子初始化伪随机数生成器。从分布 $\\mathcal{N}(0, \\sigma^2)$ 生成完整的 $T$ 个新息序列 $\\{\\varepsilon_t\\}_{t=1}^T$。\n3.  初始化一个大小为 $T+1$ 的数组用于路径 $\\{X_t\\}$，并设 $X[0] = X_0$。初始化终值 $A_T = 0.0$ 和 $M_T = 0.0$ 的累加器。\n4.  从 $t=1$ 迭代到 $T$：\n    a. 获取当前步骤的新息 $\\varepsilon_t$。\n    b. 计算 $X_t = \\mu + \\phi X_{t-1} + \\varepsilon_t$。\n    c. 计算可预测增量 $\\Delta A_t = \\mu + (\\phi - 1)X_{t-1}$。\n    d. 将此增量加到累加器中：$A_T \\leftarrow A_T + \\Delta A_t$。\n    e. 将鞅增量 $\\varepsilon_t$ 加到其累加器中：$M_T \\leftarrow M_T + \\varepsilon_t$。注意，这也可以在循环结束后通过对所有新息求和一次性计算。\n5.  循环结束后，将 $A_T$ 和 $M_T$ 的最终值四舍五入到六位小数。\n6.  存储值对 $[A_T, M_T]$ 并按指定格式收集结果。\n此过程正确地实现了推导出的分解并产生所需的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates AR(1) processes and computes the terminal values of their\n    Doob-Meyer decomposition components.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'mu': 0.5, 'phi': 0.8, 'sigma': 1.0, 'X0': 0.7, 'T': 12, 'seed': 314159},\n        {'mu': 0.0, 'phi': 1.0, 'sigma': 0.8, 'X0': 1.2, 'T': 10, 'seed': 271828},\n        {'mu': 0.1, 'phi': 0.9, 'sigma': 0.0, 'X0': -0.3, 'T': 15, 'seed': 42},\n        {'mu': -0.2, 'phi': 1.0, 'sigma': 0.5, 'X0': 0.0, 'T': 8, 'seed': 7},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        mu = case['mu']\n        phi = case['phi']\n        sigma = case['sigma']\n        X0 = case['X0']\n        T = case['T']\n        seed = case['seed']\n\n        # 1. Initialize RNG and generate all innovations\n        rng = np.random.default_rng(seed)\n        epsilons = rng.normal(loc=0.0, scale=sigma, size=T)\n\n        # 2. Initialize path array and terminal value accumulators\n        x_path = np.zeros(T + 1)\n        x_path[0] = X0\n        \n        A_T = 0.0\n\n        # 3. Simulate the path and compute the predictable component A_T\n        # The martingale component M_T is simply the sum of all innovations.\n        for t in range(1, T + 1):\n            # The t-th innovation corresponds to index t-1 in the epsilons array\n            epsilon_t = epsilons[t - 1]\n            x_prev = x_path[t - 1]\n            \n            # Update the process\n            x_path[t] = mu + phi * x_prev + epsilon_t\n            \n            # Increment for the predictable part A_t\n            # delta_A_t = E[X_t - X_{t-1} | F_{t-1}] = mu + (phi - 1) * X_{t-1}\n            delta_A_t = mu + (phi - 1) * x_prev\n            A_T += delta_A_t\n\n        # The martingale part M_T is the sum of innovations\n        M_T = np.sum(epsilons)\n        \n        # 4. Round to six decimal places as required\n        A_T_rounded = round(A_T, 6)\n        M_T_rounded = round(M_T, 6)\n        \n        results.append([A_T_rounded, M_T_rounded])\n\n    # 5. Format the final output string as a compact list of lists\n    # Each sublist [a, m] is formatted to ensure fixed precision and no spaces\n    string_parts = []\n    for res_pair in results:\n        a_str = f\"{res_pair[0]:.6f}\"\n        m_str = f\"{res_pair[1]:.6f}\"\n        string_parts.append(f\"[{a_str},{m_str}]\")\n        \n    final_output = f\"[[{','.join(string_parts)}]]\"\n\n    # Per the problem spec \"[ [a1,m1],[a2,m2],... ]\"\n    # My previous implementation was adding an extra pair of brackets.\n    final_output_corrected = f\"[{','.join(string_parts)}]\"\n\n    print(final_output_corrected)\n\nsolve()\n```", "id": "2388954"}, {"introduction": "分解原理可以优雅地扩展到连续时间过程的世界。这个问题挑战你分解一个类似Ornstein-Uhlenbeck过程的平方，$X_t = (B_t - \\mu t)^2$。在这里，你的主要工具将是强大的Itô公式，它能自然地将过程的动态分为一个局部鞅部分（$dB_t$积分）和一个可预测的有限变差部分（$dt$积分）。[@problem_id:3050549]", "problem": "考虑一个支撑标准布朗运动 $B_t$（其中 $B_0=0$）的过滤概率空间及其通常的增广滤子。固定一个实常数 $\\mu \\in \\mathbb{R}$，并定义连续适应过程 $X_t$ 为 $X_t = (B_t - \\mu t)^2$。仅从布朗运动的核心性质（独立增量、平稳性以及二次变差 $\\langle B \\rangle_t = t$）和针对伊藤过程的二次连续可微函数的伊藤公式出发，计算 $X_t$ 相对于 $B_t$ 的滤子的典范分解，即分解为一个连续局部鞅和一个可预测有限变差过程。特别地，在分解 $X_t = X_0 + M_t + A_t$ 中，确定其补偿子（即可预测有限变差部分）$A_t$，并将其明确地表示为 $t$、$\\mu$ 和 $B$ 的路径的函数。\n\n您的最终答案必须只包含 $A_t$ 的闭式解析表达式。在推导过程中，请解释这个补偿子如何能被解释为 $t$ 加上一个依赖于漂移的项。不需要进行数值近似。", "solution": "首先验证问题，以确保其是适定的、有科学依据的和客观的。\n\n### 步骤 1：提取已知条件\n-   一个过滤概率空间上的标准布朗运动 $B_t$，其中 $B_0 = 0$。\n-   该滤子是由 $B_t$ 生成的通常的增广滤子。\n-   一个常数 $\\mu \\in \\mathbb{R}$。\n-   一个由 $X_t = (B_t - \\mu t)^2$ 定义的连续适应过程 $X_t$。\n-   所需工具：布朗运动的核心性质（独立增量、平稳性、二次变差 $\\langle B \\rangle_t = t$）和伊藤公式。\n-   目标：计算 $X_t$ 的典范分解，即分解为一个连续局部鞅 $M_t$ 和一个可预测有限变差过程 $A_t$，使得 $X_t = X_0 + M_t + A_t$。\n-   具体任务：求出补偿子 $A_t$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数学上是严谨的，并且完全属于随机微积分的范畴。过程 $X_t$ 的定义、底层的布朗运动以及所要求的分解都是标准概念。问题是自洽的，提供了所有必要的信息。该问题是适定的，因为一个连续半鞅的典范（Doob-Meyer）分解是已知存在且唯一的。问题是客观的，并且没有任何科学或逻辑上的缺陷。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。我们继续进行求解。\n\n过程 $X_t$ 由 $X_t = (B_t - \\mu t)^2$ 给出。我们可以将其表示为 $X_t = f(t, B_t)$，其中函数为 $f(t, x) = (x - \\mu t)^2$。函数 $f(t,x)$ 关于 $x$ 是二次连续可微的，关于 $t$ 是一次连续可微的。我们可以对一个关于时间和随机过程的函数应用伊藤公式。\n\n对于一个过程 $Y_t = f(t, W_t)$，其中 $W_t$ 是一个伊藤过程，伊藤公式的一般形式为：\n$$dY_t = \\frac{\\partial f}{\\partial t}(t, W_t) dt + \\frac{\\partial f}{\\partial x}(t, W_t) dW_t + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2}(t, W_t) d\\langle W \\rangle_t$$\n在我们的情况下，过程是标准布朗运动 $W_t = B_t$。其二次变差由 $\\langle B \\rangle_t = t$ 给出，其微分形式为 $d\\langle B \\rangle_t = dt$。\n\n首先，我们计算 $f(t, x) = (x - \\mu t)^2$ 的必要偏导数：\n1.  关于时间 $t$ 的偏导数：\n    $$\\frac{\\partial f}{\\partial t} = \\frac{\\partial}{\\partial t} (x^2 - 2\\mu tx + \\mu^2 t^2) = -2\\mu x + 2\\mu^2 t$$\n2.  关于空间变量 $x$ 的偏导数：\n    $$\\frac{\\partial f}{\\partial x} = \\frac{\\partial}{\\partial x} (x - \\mu t)^2 = 2(x - \\mu t)$$\n3.  关于 $x$ 的二阶偏导数：\n    $$\\frac{\\partial^2 f}{\\partial x^2} = \\frac{\\partial}{\\partial x} (2(x - \\mu t)) = 2$$\n\n现在，我们将这些在 $(t, B_t)$ 处求得的导数代入 $X_t = f(t, B_t)$ 的伊藤公式中：\n$$dX_t = \\left(-2\\mu B_t + 2\\mu^2 t\\right) dt + 2(B_t - \\mu t) dB_t + \\frac{1}{2}(2) d\\langle B \\rangle_t$$\n使用 $d\\langle B \\rangle_t = dt$，表达式变为：\n$$dX_t = \\left(-2\\mu B_t + 2\\mu^2 t\\right) dt + 2(B_t - \\mu t) dB_t + dt$$\n我们可以合并乘以 $dt$ 的项：\n$$dX_t = (1 - 2\\mu B_t + 2\\mu^2 t) dt + 2(B_t - \\mu t) dB_t$$\n这是过程 $X_t$ 的随机微分方程（SDE）。为了找到 $X_t$ 的分解，我们将此 SDE 从 $0$ 积分到 $t$：\n$$X_t - X_0 = \\int_0^t (1 - 2\\mu B_s + 2\\mu^2 s) ds + \\int_0^t 2(B_s - \\mu s) dB_s$$\n过程的初始值为 $X_0 = (B_0 - \\mu \\cdot 0)^2 = (0 - 0)^2 = 0$。\n因此，我们得到分解：\n$$X_t = \\int_0^t (1 - 2\\mu B_s + 2\\mu^2 s) ds + \\int_0^t 2(B_s - \\mu s) dB_s$$\n如果 $A_t$ 是一个可预测的有限变差过程，$M_t$ 是一个连续局部鞅，且 $A_0 = M_0 = 0$，则此分解具有 $X_t = A_t + M_t$ 的形式，这是连续半鞅的典范分解。\n\n让我们识别这两个部分：\n1.  鞅部分 $M_t$：\n    $$M_t = \\int_0^t 2(B_s - \\mu s) dB_s$$\n    这是一个伊藤积分。被积函数 $2(B_s - \\mu s)$ 是一个连续适应过程。因此，$M_t$ 是一个连续局部鞅，且 $M_0 = 0$。\n\n2.  有限变差部分 $A_t$（补偿子）：\n    $$A_t = \\int_0^t (1 - 2\\mu B_s + 2\\mu^2 s) ds$$\n    这是一个关于时间的黎曼积分。被积函数 $(1 - 2\\mu B_s + 2\\mu^2 s)$ 是一个连续适应过程，这意味着它是一个可预测过程。可预测过程关于时间的积分产生一个可预测过程。此外，由于被积函数在任何有限时间区间 $[0, T]$ 上几乎必然连续，其积分在 $[0, T]$ 上几乎必然是有限变差的。我们还有 $A_0 = 0$。因此，$A_t$ 是 $X_t$ 典范分解中唯一的那个可预测有限变差过程。\n\n问题要求给出补偿子 $A_t$ 的显式表达式。我们可以显式计算积分中依赖于 $s$ 的部分：\n$$A_t = \\int_0^t (1 - 2\\mu B_s) ds + \\int_0^t 2\\mu^2 s ds$$\n$$A_t = \\int_0^t ds - 2\\mu \\int_0^t B_s ds + 2\\mu^2 \\left[\\frac{s^2}{2}\\right]_0^t$$\n$$A_t = t - 2\\mu \\int_0^t B_s ds + \\mu^2 t^2$$\n此表达式将 $A_t$ 表示为 $t$、$\\mu$ 以及布朗运动 $B$ 的路径（通过积分 $\\int_0^t B_s ds$）的函数。\n\n按照要求，我们可以将这个补偿子解释为 $t$ 加上一个依赖于漂移的项。项 $t$ 源于伊藤修正项，该项解释了布朗运动的非零二次变差。它是项 $\\frac{1}{2} \\int_0^t \\frac{\\partial^2 f}{\\partial x^2} d\\langle B \\rangle_s = \\frac{1}{2} \\int_0^t 2 ds = t$。剩余部分 $\\mu^2 t^2 - 2\\mu \\int_0^t B_s ds$ 源于经典链式法则项 $\\int_0^t \\frac{\\partial f}{\\partial s}(s, B_s) ds$，并且显然依赖于漂移参数 $\\mu$。", "answer": "$$\\boxed{t + \\mu^2 t^2 - 2\\mu \\int_0^t B_s ds}$$", "id": "3050549"}]}