{"hands_on_practices": [{"introduction": "常数变易法的第一步是理解齐次方程基本解的倒数所满足的动力学。这个练习将引导你使用伊藤公式（Itô's formula）来推导 $U_t^{-1}$ 的随机微分方程（SDE），并揭示随机微积分区别于普通微积分的关键——漂移项修正 [@problem_id:3083194]。这个计算是后续求解非齐次线性SDEs的基础。", "problem": "设 $\\{W_t^{(1)},\\dots,W_t^{(m)}\\}_{t \\ge 0}$ 是 $m$ 个独立的标准布朗运动，适应于一个满足通常条件的带滤概率空间。考虑标量 Itô 随机微分方程\n$$\ndU_t \\;=\\; a_t\\,U_t\\,dt \\;+\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t\\,dW_t^{(j)}, \\qquad U_0 \\neq 0,\n$$\n其中 $\\{a_t\\}_{t \\ge 0}$ 和 $\\{c_t^{(j)}\\}_{t \\ge 0}$ (对于 $j \\in \\{1,\\dots,m\\}$) 是有界的渐进可测过程。假设对所有 $t \\ge 0$，$U_t \\neq 0$ 几乎必然成立，因此 $U_t^{-1}$ 是良定的。\n\n仅使用 Itô 公式和独立布朗运动的基本二次变差规则 $dW_t^{(i)}\\,dW_t^{(j)} = \\delta_{ij}\\,dt$，计算逆过程 $U_t^{-1}$ 的随机微分，并验证由二次变差之和 $\\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^{2}$ 引起的漂移修正项的存在。请用 $U_t^{-1}$、$a_t$、$c_t^{(j)}$、$dt$ 和 $dW_t^{(j)}$ 表示 $d(U_t^{-1})$ 的右侧作为你的最终答案。\n\n你的最终答案必须是一个单一的闭式解析表达式。不应包含等号。无需进行舍入。[@problem_id:483]", "solution": "本问题要求计算过程 $Y_t = U_t^{-1}$ 的随机微分，其中过程 $U_t$ 由以下标量 Itô 随机微分方程 (SDE) 决定：\n$$\ndU_t \\;=\\; a_t\\,U_t\\,dt \\;+\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t\\,dW_t^{(j)}\n$$\n初始条件为 $U_0 \\neq 0$，并且假设对所有 $t \\ge 0$，$U_t \\neq 0$ 几乎必然成立。系数 $\\{a_t\\}_{t \\ge 0}$ 和 $\\{c_t^{(j)}\\}_{t \\ge 0}$ 是有界的渐进可测过程，而 $\\{W_t^{(j)}\\}_{j=1,\\dots,m}$ 是独立的标准布朗运动。\n\n本任务将通过使用 Itô 过程函数的 Itô 公式来完成。设 $Y_t = f(U_t)$，其中函数 $f(u)$ 定义为 $f(u) = u^{-1}$。我们必须首先计算 $f(u)$ 关于 $u$ 的一阶和二阶导数：\n$$\nf'(u) = \\frac{df}{du} = -u^{-2}\n$$\n$$\nf''(u) = \\frac{d^2f}{du^2} = 2u^{-3}\n$$\n问题陈述了 $U_t \\neq 0$ 几乎必然成立，这确保了当 $u = U_t$ 时这些导数是良定的。\n\n对于一个过程 $Y_t = f(U_t)$，其中 $U_t$ 是一个 Itô 过程，其 Itô 公式由下式给出：\n$$\ndY_t \\;=\\; f'(U_t)\\,dU_t \\;+\\; \\frac{1}{2}f''(U_t)\\,(dU_t)^2\n$$\n此处，$(dU_t)^2$ 表示过程 $U_t$ 的二次变差。\n\n接下来，我们计算二次变差项 $(dU_t)^2$。我们使用符号化的 Itô 乘法规则：$dt \\cdot dt = 0$, $dt \\cdot dW_t^{(j)} = 0$ 和 $dW_t^{(i)} \\cdot dW_t^{(j)} = \\delta_{ij}\\,dt$，其中 $\\delta_{ij}$ 是克罗内克（Kronecker）δ 函数。\n$$\n(dU_t)^2 = \\left( a_t\\,U_t\\,dt \\;+\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t\\,dW_t^{(j)} \\right) \\left( a_t\\,U_t\\,dt \\;+\\; \\sum_{k=1}^{m} c_t^{(k)}\\,U_t\\,dW_t^{(k)} \\right)\n$$\n展开这个乘积并仅保留 $dt$ 阶的项，我们得到：\n$$\n(dU_t)^2 = \\sum_{j=1}^{m} \\sum_{k=1}^{m} \\left(c_t^{(j)}\\,U_t\\right) \\left(c_t^{(k)}\\,U_t\\right) dW_t^{(j)}\\,dW_t^{(k)}\n$$\n$$\n(dU_t)^2 = U_t^2 \\sum_{j=1}^{m} \\sum_{k=1}^{m} c_t^{(j)} c_t^{(k)} \\delta_{jk}\\,dt\n$$\n由于克罗内克 δ 函数，双重求和简化为 $j=k$ 时的单个求和：\n$$\n(dU_t)^2 = U_t^2 \\left( \\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2 \\right) dt\n$$\n现在我们可以将 $f$ 的导数以及 $dU_t$ 和 $(dU_t)^2$ 的表达式代入 Itô 公式中。\n\nItô 公式中的第一项是 $f'(U_t)\\,dU_t$：\n$$\nf'(U_t)\\,dU_t = (-U_t^{-2}) \\left( a_t\\,U_t\\,dt \\;+\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t\\,dW_t^{(j)} \\right)\n$$\n$$\nf'(U_t)\\,dU_t = -a_t\\,U_t^{-1}\\,dt \\;-\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t^{-1}\\,dW_t^{(j)}\n$$\n这一项对应于普通微积分中链式法则所得到的结果。\n\n第二项 $\\frac{1}{2}f''(U_t)\\,(dU_t)^2$ 是 Itô 修正项：\n$$\n\\frac{1}{2}f''(U_t)\\,(dU_t)^2 = \\frac{1}{2} (2U_t^{-3}) \\left( U_t^2 \\left( \\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2 \\right) dt \\right)\n$$\n$$\n\\frac{1}{2}f''(U_t)\\,(dU_t)^2 = U_t^{-3} U_t^2 \\left( \\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2 \\right) dt\n$$\n$$\n\\frac{1}{2}f''(U_t)\\,(dU_t)^2 = U_t^{-1} \\left( \\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2 \\right) dt\n$$\n这一项的出现是因为过程 $U_t$ 由于其随机分量而具有非零的二次变差。这一项修正了所得过程 $U_t^{-1}$ 的漂移项。\n\n最后，我们将这两部分相加得到随机微分 $d(U_t^{-1})$：\n$$\nd(U_t^{-1}) = \\left( -a_t\\,U_t^{-1}\\,dt \\;-\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t^{-1}\\,dW_t^{(j)} \\right) \\;+\\; \\left( U_t^{-1} \\left( \\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2 \\right) dt \\right)\n$$\n我们将 $dt$ 项（漂移项）和 $dW_t^{(j)}$ 项（扩散项）组合在一起：\n$$\nd(U_t^{-1}) = \\left( U_t^{-1} \\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2 - a_t\\,U_t^{-1} \\right) dt \\;-\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t^{-1}\\,dW_t^{(j)}\n$$\n从漂移项中提出因子 $U_t^{-1}$，我们得到 $U_t^{-1}$ 的 SDE 的最终表达式：\n$$\nd(U_t^{-1}) = \\left( \\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2 - a_t \\right) U_t^{-1} dt \\;-\\; \\sum_{j=1}^{m} c_t^{(j)}\\,U_t^{-1}\\,dW_t^{(j)}\n$$\n按照要求，我们验证了漂移修正项的存在。来自经典微积分的朴素漂移项应为 $-a_t U_t^{-1}$。Itô 公式增加了项 $\\left(\\sum_{j=1}^{m} \\big(c_t^{(j)}\\big)^2\\right) U_t^{-1}$，这正是由 $U_t$ 扩散分量的二次变差之和所引起的漂移修正项。最终方程的右侧构成了答案。", "answer": "$$\n\\boxed{\\left( \\sum_{j=1}^{m} \\left(c_t^{(j)}\\right)^{2} - a_t \\right) U_t^{-1} dt - \\sum_{j=1}^{m} c_t^{(j)} U_t^{-1} dW_t^{(j)}}\n$$", "id": "3083194"}, {"introduction": "在许多实际应用中，系统参数可能会在某个时刻发生突变，例如金融市场中的政策变更或系统中的机制转换。本练习将探讨如何处理这种系数为分段常数的线性SDE [@problem_id:3083186]。通过分段应用常数变易法，你将不仅能构建出完整的解，还能验证伊藤过程的一个基本性质：即使驱动其的参数发生跳跃，其路径本身依然是连续的。", "problem": "考虑一个带滤概率空间，其上支撑一个在一维标准布朗运动 $W_t$，时间区间为固定的 $[0,T]$，其中 $T0$。令 $\\tau \\in (0,T)$ 为一个确定性切换时间。对于给定的实常数 $a_1$, $a_2$, $c_1$, $c_2$, $f_1$, $f_2$, $g_1$, $g_2$ 和初始条件 $X_0 = x_0 \\in \\mathbb{R}$，考虑以下线性随机微分方程 (SDE)\n$$\n\\mathrm{d}X_t \\;=\\; a_t X_t \\,\\mathrm{d}t \\;+\\; c_t X_t \\,\\mathrm{d}W_t \\;+\\; f_t \\,\\mathrm{d}t \\;+\\; g_t \\,\\mathrm{d}W_t,\\qquad X_0=x_0,\n$$\n其中系数是时间上的分段常数函数或阶梯函数，由下式给出\n$$\na_t \\;=\\; a_1 \\,\\mathbf{1}_{[0,\\tau)}(t) \\;+\\; a_2 \\,\\mathbf{1}_{[\\tau,T]}(t),\\qquad\nc_t \\;=\\; c_1 \\,\\mathbf{1}_{[0,\\tau)}(t) \\;+\\; c_2 \\,\\mathbf{1}_{[\\tau,T]}(t),\n$$\n$$\nf_t \\;=\\; f_1 \\,\\mathbf{1}_{[0,\\tau)}(t) \\;+\\; f_2 \\,\\mathbf{1}_{[\\tau,T]}(t),\\qquad\ng_t \\;=\\; g_1 \\,\\mathbf{1}_{[0,\\tau)}(t) \\;+\\; g_2 \\,\\mathbf{1}_{[\\tau,T]}(t),\n$$\n其中 $\\mathbf{1}_{A}$ 表示集合 $A$ 的指示函数。从 Itô 积分的基本事实出发，即 Itô 乘积法则以及解齐次线性 SDE 的随机指数的存在性与形式，完成以下步骤：\n\n1. 求解齐次线性 SDE $\\mathrm{d}\\Phi_t = a_t \\Phi_t \\,\\mathrm{d}t + c_t \\Phi_t \\,\\mathrm{d}W_t$，其中 $\\Phi_0=1$，并在上述 $a_t$ 和 $c_t$ 的分段定义下，明确写出对于 $t\\in[0,T]$ 的 $\\Phi_t$。\n\n2. 对 $\\Phi_t^{-1} X_t$ 使用 Itô 乘积法则，推导出一个对所有 $t\\in[0,T]$ 都有效的 $X_t$ 的常数变易表示法。\n\n3. 使用你的表示法计算在切换时间的跳跃幅度，\n$$\nJ \\;:=\\; X_{\\tau^{+}} - X_{\\tau^{-}},\n$$\n其中 $X_{\\tau^{-}}:=\\lim_{t\\uparrow \\tau}X_t$ 且 $X_{\\tau^{+}}:=\\lim_{t\\downarrow \\tau}X_t$。将 $J$ 的最终答案表示为单个精确值。无需四舍五入，也无需单位。\n\n你的最终答案必须是一个单一的实数或一个单一的封闭形式解析表达式。", "solution": "问题陈述需经过验证。\n\n### 步骤1：提取已知条件\n- 一个带滤概率空间 $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, P)$，其上有一个一维标准布朗运动 $W_t$。\n- 时间区间 $[0,T]$，其中 $T0$。\n- 确定性切换时间 $\\tau \\in (0,T)$。\n- 实常数：$a_1, a_2, c_1, c_2, f_1, f_2, g_1, g_2$。\n- 初始条件 $X_0 = x_0 \\in \\mathbb{R}$。\n- 随机微分方程 (SDE)：\n$$\n\\mathrm{d}X_t = a_t X_t \\,\\mathrm{d}t + c_t X_t \\,\\mathrm{d}W_t + f_t \\,\\mathrm{d}t + g_t \\,\\mathrm{d}W_t\n$$\n- 系数是分段常数：\n$$\na_t = a_1 \\,\\mathbf{1}_{[0,\\tau)}(t) + a_2 \\,\\mathbf{1}_{[\\tau,T]}(t) \\\\\nc_t = c_1 \\,\\mathbf{1}_{[0,\\tau)}(t) + c_2 \\,\\mathbf{1}_{[\\tau,T]}(t) \\\\\nf_t = f_1 \\,\\mathbf{1}_{[0,\\tau)}(t) + f_2 \\,\\mathbf{1}_{[\\tau,T]}(t) \\\\\ng_t = g_1 \\,\\mathbf{1}_{[0,\\tau)}(t) + g_2 \\,\\mathbf{1}_{[\\tau,T]}(t)\n$$\n- 任务是：\n  1. 求解 $\\mathrm{d}\\Phi_t = a_t \\Phi_t \\,\\mathrm{d}t + c_t \\Phi_t \\,\\mathrm{d}W_t$，其中 $\\Phi_0=1$。\n  2. 推导 $X_t$ 的常数变易表示法。\n  3. 计算跳跃幅度 $J = X_{\\tau^{+}} - X_{\\tau^{-}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上是有根据的、适定的和客观的。这是随机微分方程理论中的一个标准问题，特别是关于具有时变系数的线性 SDE。系数 $a_t, c_t, f_t, g_t$ 是分段常数函数，这使得它们有界且可测，满足 SDE 强解存在唯一性的标准条件。解 $X_t$ 是一个 Itô 过程。该问题是自洽的，没有矛盾或歧义。未发现任何缺陷。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答\n\n按要求分三部分解答此问题。\n\n**第1部分：齐次 SDE 的解**\n\n我们被要求解齐次线性 SDE：\n$$\n\\mathrm{d}\\Phi_t = a_t \\Phi_t \\,\\mathrm{d}t + c_t \\Phi_t \\,\\mathrm{d}W_t, \\quad \\Phi_0=1\n$$\n这个 SDE 的解是随机指数，记为 $\\Phi_t = \\mathcal{E}(Y)_t$，其中 $Y_t$ 是指数中的过程。明确地，它由下式给出：\n$$\n\\Phi_t = \\exp\\left( \\int_0^t c_s \\,\\mathrm{d}W_s + \\int_0^t a_s \\,\\mathrm{d}s - \\frac{1}{2} \\int_0^t c_s^2 \\,\\mathrm{d}s \\right)\n$$\n我们使用 $a_t$ 和 $c_t$ 的分段定义来计算这些积分。\n\n情况1：$t \\in [0, \\tau)$\n在此区间内，$a_s = a_1$ 且 $c_s = c_1$。积分为：\n$$\n\\int_0^t a_s \\,\\mathrm{d}s = \\int_0^t a_1 \\,\\mathrm{d}s = a_1 t\n$$\n$$\n\\int_0^t c_s^2 \\,\\mathrm{d}s = \\int_0^t c_1^2 \\,\\mathrm{d}s = c_1^2 t\n$$\n$$\n\\int_0^t c_s \\,\\mathrm{d}W_s = \\int_0^t c_1 \\,\\mathrm{d}W_s = c_1 W_t\n$$\n因此，对于 $t \\in [0, \\tau)$，解为：\n$$\n\\Phi_t = \\exp\\left( \\left(a_1 - \\frac{1}{2}c_1^2\\right)t + c_1 W_t \\right)\n$$\n\n情况2：$t \\in [\\tau, T]$\n积分在切换时间 $\\tau$ 处分开：\n$$\n\\int_0^t a_s \\,\\mathrm{d}s = \\int_0^\\tau a_1 \\,\\mathrm{d}s + \\int_\\tau^t a_2 \\,\\mathrm{d}s = a_1 \\tau + a_2(t-\\tau)\n$$\n$$\n\\int_0^t c_s^2 \\,\\mathrm{d}s = \\int_0^\\tau c_1^2 \\,\\mathrm{d}s + \\int_\\tau^t c_2^2 \\,\\mathrm{d}s = c_1^2 \\tau + c_2^2(t-\\tau)\n$$\n$$\n\\int_0^t c_s \\,\\mathrm{d}W_s = \\int_0^\\tau c_1 \\,\\mathrm{d}W_s + \\int_\\tau^t c_2 \\,\\mathrm{d}W_s = c_1 W_\\tau + c_2 (W_t - W_\\tau)\n$$\n将这些代入 $\\Phi_t$ 的表达式中：\n$$\n\\Phi_t = \\exp\\left( a_1 \\tau + a_2(t-\\tau) - \\frac{1}{2}(c_1^2 \\tau + c_2^2(t-\\tau)) + c_1 W_\\tau + c_2 (W_t - W_\\tau) \\right)\n$$\n这可以被分解为：\n$$\n\\Phi_t = \\exp\\left( \\left(a_1 - \\frac{1}{2}c_1^2\\right)\\tau + c_1 W_\\tau \\right) \\exp\\left( \\left(a_2 - \\frac{1}{2}c_2^2\\right)(t-\\tau) + c_2 (W_t - W_\\tau) \\right)\n$$\n识别出第一项为 $\\Phi_\\tau$，我们有 $\\Phi_t = \\Phi_\\tau \\mathcal{E}\\left(\\int_\\tau^t c_2 \\mathrm{d}W_s + \\int_\\tau^t a_2 \\mathrm{d}s\\right)$。\n\n综合两种情况，$\\Phi_t$ 的显式表达式为：\n$$\n\\Phi_t =\n\\begin{cases}\n\\exp\\left( \\left(a_1 - \\frac{1}{2}c_1^2\\right)t + c_1 W_t \\right)  \\text{若 } t \\in [0, \\tau) \\\\\n\\exp\\left( \\left(a_1 - \\frac{1}{2}c_1^2\\right)\\tau + c_1 W_\\tau \\right) \\exp\\left( \\left(a_2 - \\frac{1}{2}c_2^2\\right)(t-\\tau) + c_2 (W_t - W_\\tau) \\right)  \\text{若 } t \\in [\\tau, T]\n\\end{cases}\n$$\n注意 $\\Phi_t$ 是一个连续过程，这可以通过取极限 $t \\downarrow \\tau$ 来验证。\n\n**第2部分：常数变易表示法**\n\n我们通过考虑过程 $Y_t = \\Phi_t^{-1} X_t$ 来使用常数变易法。我们应用 Itô 乘积法则：\n$$\n\\mathrm{d}(\\Phi_t^{-1} X_t) = \\Phi_t^{-1} \\mathrm{d}X_t + X_t \\mathrm{d}(\\Phi_t^{-1}) + \\mathrm{d}\\langle \\Phi^{-1}, X \\rangle_t\n$$\n首先，我们求 $\\Phi_t^{-1}$ 的微分。对于一个随机指数 $\\Phi_t = \\mathcal{E}(\\int a_s \\mathrm{d}s + \\int c_s \\mathrm{d}W_s)_t$，其逆满足 $\\mathrm{d}(\\Phi_t^{-1}) = (c_t^2 - a_t)\\Phi_t^{-1}\\mathrm{d}t - c_t \\Phi_t^{-1}\\mathrm{d}W_t$。\n原始 SDE 可以写为 $\\mathrm{d}X_t = (a_t X_t + f_t)\\mathrm{d}t + (c_t X_t + g_t)\\mathrm{d}W_t$。\n二次协变项是：\n$$\n\\mathrm{d}\\langle \\Phi^{-1}, X \\rangle_t = (-c_t \\Phi_t^{-1}) (c_t X_t + g_t) \\mathrm{d}t = (-c_t^2 \\Phi_t^{-1} X_t - c_t g_t \\Phi_t^{-1}) \\mathrm{d}t\n$$\n将这些代入乘积法则中：\n$$\n\\mathrm{d}Y_t = \\Phi_t^{-1} \\left( (a_t X_t + f_t)\\mathrm{d}t + (c_t X_t + g_t)\\mathrm{d}W_t \\right) + X_t \\left( (c_t^2 - a_t)\\Phi_t^{-1}\\mathrm{d}t - c_t \\Phi_t^{-1}\\mathrm{d}W_t \\right) + (-c_t^2 \\Phi_t^{-1} X_t - c_t g_t \\Phi_t^{-1}) \\mathrm{d}t\n$$\n我们收集乘以 $\\mathrm{d}t$ 和 $\\mathrm{d}W_t$ 的项。\n$\\mathrm{d}t$ 的项：\n$$\n\\Phi_t^{-1} \\left( a_t X_t + f_t + X_t(c_t^2 - a_t) - c_t^2 X_t - c_t g_t \\right) = \\Phi_t^{-1} \\left( (a_t - a_t + c_t^2 - c_t^2)X_t + f_t - c_t g_t \\right) = \\Phi_t^{-1} (f_t - c_t g_t)\n$$\n$\\mathrm{d}W_t$ 的项：\n$$\n\\Phi_t^{-1} \\left( c_t X_t + g_t - c_t X_t \\right) = \\Phi_t^{-1} g_t\n$$\n因此，$Y_t$ 的微分简化为：\n$$\n\\mathrm{d}(\\Phi_t^{-1} X_t) = \\Phi_t^{-1} (f_t - c_t g_t) \\mathrm{d}t + \\Phi_t^{-1} g_t \\mathrm{d}W_t\n$$\n从 $0$ 到 $t$ 积分：\n$$\n\\Phi_t^{-1} X_t - \\Phi_0^{-1} X_0 = \\int_0^t \\Phi_s^{-1} (f_s - c_s g_s) \\mathrm{d}s + \\int_0^t \\Phi_s^{-1} g_s \\mathrm{d}W_s\n$$\n使用 $\\Phi_0=1$ 和 $X_0=x_0$，我们得到：\n$$\n\\Phi_t^{-1} X_t = x_0 + \\int_0^t \\Phi_s^{-1} (f_s - c_s g_s) \\mathrm{d}s + \\int_0^t \\Phi_s^{-1} g_s \\mathrm{d}W_s\n$$\n乘以 $\\Phi_t$ 得到 $X_t$ 的常数变易表示法：\n$$\nX_t = \\Phi_t \\left( x_0 + \\int_0^t \\Phi_s^{-1} (f_s - c_s g_s) \\mathrm{d}s + \\int_0^t \\Phi_s^{-1} g_s \\mathrm{d}W_s \\right)\n$$\n此公式对所有 $t \\in [0,T]$ 均有效。\n\n**第3部分：跳跃幅度的计算**\n\n我们想要计算 $J = X_{\\tau^{+}} - X_{\\tau^{-}}$，定义为 $\\lim_{t\\downarrow \\tau}X_t - \\lim_{t\\uparrow \\tau}X_t$。\n\n解 $X_t$ 是一个 Itô 过程，其积分形式由下式给出：\n$$\nX_t = x_0 + \\int_0^t (a_s X_s + f_s) \\,\\mathrm{d}s + \\int_0^t (c_s X_s + g_s) \\,\\mathrm{d}W_s\n$$\n第一项 $x_0$ 是一个常数。\n第二项 $I_t = \\int_0^t (a_s X_s + f_s) \\,\\mathrm{d}s$ 是关于时间的勒贝格积分。被积函数是一个可测过程，对于任何这样的过程，积分 $I_t$ 是积分上限 $t$ 的一个连续函数（实际上是绝对连续函数）。\n第三项 $M_t = \\int_0^t (c_s X_s + g_s) \\,\\mathrm{d}W_s$ 是一个 Itô 积分。Itô 积分的一个基本性质是，只要被积函数满足必要的平方可积条件，其样本路径几乎必然是时间 $t$ 的连续函数。我们的 SDE 的系数在 $X_t$ 中是仿射的，且具有有界的时变部分，这保证了这些条件得到满足。\n\n因此，$X_t$ 是一个常数和两个连续过程 $I_t$ 和 $M_t$ 的和。连续函数的和是连续的。因此，过程 $X_t$ 的样本路径几乎必然在整个区间 $[0,T]$ 上是连续的。\n\n系数 $a_t, c_t, f_t, g_t$ 在时间 $\\tau$ 处的不连续性导致过程 $X_t$ 的动态（漂移和波动率）发生变化，但它不会在状态 $X_t$ 本身引起跳跃不连续性。\n\n对于一个连续函数 $X_t$，在任何点 $\\tau$ 的左极限和右极限都等于该点处的函数值。也就是说，几乎必然：\n$$\nX_{\\tau^{-}} = \\lim_{t\\uparrow \\tau} X_t = X_\\tau\n$$\n$$\nX_{\\tau^{+}} = \\lim_{t\\downarrow \\tau} X_t = X_\\tau\n$$\n因此，跳跃幅度 $J$ 是：\n$$\nJ = X_{\\tau^{+}} - X_{\\tau^{-}} = X_\\tau - X_\\tau = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "3083186"}, {"introduction": "除了伊藤积分，Stratonovich 积分提供了另一种定义和求解随机微分方程的框架，其主要优点是其链式法则与经典微积分完全相同。本练习 [@problem_id:3083173] 旨在展示在 Stratonovich 框架下，常数变易法如何变得异常简洁。通过解决这个问题，你将能更深刻地理解线性SDE的结构，以及为何伊藤公式中需要一个额外的修正项。", "problem": "考虑由标准布朗运动（维纳过程）$W_t$ 驱动的，在 Stratonovich 意义下解释的一维随机微分方程 (SDE)：\n$$\n\\mathrm{d}X_t = a\\,t\\,X_t\\,\\mathrm{d}t + b\\,X_t \\circ \\mathrm{d}W_t + \\gamma\\,t\\,\\exp\\!\\left(\\tfrac{1}{2}a t^{2} + b W_t\\right)\\mathrm{d}t + \\delta\\,\\exp\\!\\left(\\tfrac{1}{2}a t^{2} + b W_t\\right)\\circ \\mathrm{d}W_t,\\qquad X_0 = x_0,\n$$\n其中 $a$、$b$、$\\gamma$、$\\delta$ 和 $x_0$ 是实常数，$\\circ$ 表示 Stratonovich 积分。你的任务是，从 Stratonovich 微分学的基本原理以及针对含乘性噪声的线性 SDE 的常数变易法出发，推导相关齐次方程的基本解 $U_t$ 的显式闭式表达式，进而推导出解 $X_t$。\n\n具体来说：\n- 识别并求解齐次方程，以获得基本解 $U_t$。\n- 使用常数变易变换，以获得用 $t$、$W_t$、$a$、$b$、$\\gamma$、$\\delta$ 和 $x_0$ 表示的 $X_t$ 的显式表达式。\n\n将 $X_t$ 的最终答案表示为单个解析表达式。本问题无需进行数值取整，也不涉及物理单位；请将所有量视为无量纲量。", "solution": "问题给出了一个线性一维 Stratonovich 随机微分方程 (SDE)，并要求使用常数变易法求解。该问题是适定的，并且在数学上是合理的。\n\nSDE 由下式给出：\n$$\n\\mathrm{d}X_t = a\\,t\\,X_t\\,\\mathrm{d}t + b\\,X_t \\circ \\mathrm{d}W_t + \\gamma\\,t\\,\\exp\\!\\left(\\tfrac{1}{2}a t^{2} + b W_t\\right)\\mathrm{d}t + \\delta\\,\\exp\\!\\left(\\tfrac{1}{2}a t^{2} + b W_t\\right)\\circ \\mathrm{d}W_t\n$$\n初始条件为 $X_0 = x_0$。其中，$a$、$b$、$\\gamma$、$\\delta$ 和 $x_0$ 是实常数，$W_t$ 是一个标准维纳过程。\n\n该过程包括两个主要步骤：首先，求解相关的齐次方程以找到基本解；其次，使用常数变易法找到完整的非齐次方程的解。\n\n**第一步：齐次方程与基本解**\n\nSDE 的齐次部分对应于 $X_t$ 的线性项。设 $U_t$ 为基本解，它满足初始条件为 $U_0 = 1$ 的齐次 SDE。\n$$\n\\mathrm{d}U_t = a\\,t\\,U_t\\,\\mathrm{d}t + b\\,U_t \\circ \\mathrm{d}W_t, \\qquad U_0 = 1\n$$\n这是一个带乘性噪声的线性 SDE。为求解该方程，我们可以使用变量替换。设 $Y_t = \\ln(U_t)$。根据 Stratonovich 链式法则（其形式与普通微积分的链式法则相同），我们有：\n$$\n\\mathrm{d}Y_t = \\mathrm{d}(\\ln(U_t)) = \\frac{1}{U_t} \\circ \\mathrm{d}U_t\n$$\n代入 $\\mathrm{d}U_t$ 的表达式：\n$$\n\\mathrm{d}Y_t = \\frac{1}{U_t} \\circ \\left( a\\,t\\,U_t\\,\\mathrm{d}t + b\\,U_t \\circ \\mathrm{d}W_t \\right)\n$$\n利用 Stratonovich 积分的性质，我们可以提出 $U_t$：\n$$\n\\mathrm{d}Y_t = a\\,t\\,\\mathrm{d}t + b \\circ \\mathrm{d}W_t\n$$\n由于 $b$ 是一个常数，$b \\circ \\mathrm{d}W_t$ 等价于 $b\\,\\mathrm{d}W_t$。因此，$Y_t$ 的 SDE 是：\n$$\n\\mathrm{d}Y_t = a\\,t\\,\\mathrm{d}t + b\\,\\mathrm{d}W_t\n$$\n我们可以将此方程从 $0$ 积分到 $t$：\n$$\n\\int_0^t \\mathrm{d}Y_s = \\int_0^t a\\,s\\,\\mathrm{d}s + \\int_0^t b\\,\\mathrm{d}W_s\n$$\n$$\nY_t - Y_0 = \\frac{1}{2} a t^2 + b (W_t - W_0)\n$$\n按照惯例，$W_0=0$。初始条件 $U_0 = 1$ 意味着 $Y_0 = \\ln(U_0) = \\ln(1) = 0$。因此，\n$$\nY_t = \\frac{1}{2} a t^2 + b W_t\n$$\n基本解 $U_t$ 通过对 $Y_t$ 取指数得到：\n$$\nU_t = \\exp(Y_t) = \\exp\\left(\\frac{1}{2} a t^2 + b W_t\\right)\n$$\n我们注意到，原始 SDE 中的非齐次项包含这个基本解。让我们使用 $U_t$ 重写原始 SDE：\n$$\n\\mathrm{d}X_t = (a\\,t\\,X_t + \\gamma\\,t\\,U_t)\\,\\mathrm{d}t + (b\\,X_t + \\delta\\,U_t) \\circ \\mathrm{d}W_t\n$$\n\n**第二步：常数变易法**\n\n现在，我们为非齐次 SDE 提出一个形式为 $X_t = C_t U_t$ 的解，其中 $C_t$ 是一个待定的随机过程。我们使用 Stratonovich 乘法法则 $\\mathrm{d}(C_t U_t) = C_t \\circ \\mathrm{d}U_t + U_t \\circ \\mathrm{d}C_t$。由于 $C_t$ 是一个标量过程，所以 $C_t \\circ \\mathrm{d}U_t = C_t\\,\\mathrm{d}U_t$。\n$$\n\\mathrm{d}X_t = C_t\\,\\mathrm{d}U_t + U_t \\circ \\mathrm{d}C_t\n$$\n代入 $\\mathrm{d}U_t$ 的表达式：\n$$\n\\mathrm{d}X_t = C_t \\left( a\\,t\\,U_t\\,\\mathrm{d}t + b\\,U_t \\circ \\mathrm{d}W_t \\right) + U_t \\circ \\mathrm{d}C_t\n$$\n整理并使用 $X_t = C_t U_t$：\n$$\n\\mathrm{d}X_t = a\\,t\\,(C_t U_t)\\,\\mathrm{d}t + b\\,(C_t U_t) \\circ \\mathrm{d}W_t + U_t \\circ \\mathrm{d}C_t = a\\,t\\,X_t\\,\\mathrm{d}t + b\\,X_t \\circ \\mathrm{d}W_t + U_t \\circ \\mathrm{d}C_t\n$$\n现在，我们将其与 $X_t$ 的原始 SDE 相等：\n$$\na\\,t\\,X_t\\,\\mathrm{d}t + b\\,X_t \\circ \\mathrm{d}W_t + U_t \\circ \\mathrm{d}C_t = (a\\,t\\,X_t + \\gamma\\,t\\,U_t)\\,\\mathrm{d}t + (b\\,X_t + \\delta\\,U_t) \\circ \\mathrm{d}W_t\n$$\n包含 $X_t$ 的项相互抵消，剩下：\n$$\nU_t \\circ \\mathrm{d}C_t = \\gamma\\,t\\,U_t\\,\\mathrm{d}t + \\delta\\,U_t \\circ \\mathrm{d}W_t\n$$\n由于 $U_t  0$，我们可以用它来除。在 Stratonovich 微分学中，这个操作是直接的：\n$$\n\\mathrm{d}C_t = \\gamma\\,t\\,\\mathrm{d}t + \\delta \\circ \\mathrm{d}W_t\n$$\n由于 $\\delta$ 是常数，$\\delta \\circ \\mathrm{d}W_t = \\delta\\,\\mathrm{d}W_t$。$C_t$ 的 SDE 简化为一个普通积分问题：\n$$\n\\mathrm{d}C_t = \\gamma\\,t\\,\\mathrm{d}t + \\delta\\,\\mathrm{d}W_t\n$$\n从 $0$ 积分到 $t$：\n$$\n\\int_0^t \\mathrm{d}C_s = \\int_0^t \\gamma\\,s\\,\\mathrm{d}s + \\int_0^t \\delta\\,\\mathrm{d}W_s\n$$\n$$\nC_t - C_0 = \\frac{1}{2} \\gamma t^2 + \\delta (W_t - W_0)\n$$\n再次使用 $W_0=0$，我们得到 $C_t = C_0 + \\frac{1}{2} \\gamma t^2 + \\delta W_t$。\n\n为了找到常数 $C_0$，我们使用 $t=0$ 时的初始条件：$X_0 = C_0 U_0$。\n已知 $X_0 = x_0$，并且我们已经求得 $U_0 = 1$。\n所以，$x_0 = C_0 \\cdot 1$，这意味着 $C_0 = x_0$。\n将 $C_0$ 代回 $C_t$ 的表达式：\n$$\nC_t = x_0 + \\frac{1}{2} \\gamma t^2 + \\delta W_t\n$$\n\n**第三步：最终解**\n\n最后，我们将 $C_t$ 和 $U_t$ 的表达式代入 $X_t = C_t U_t$ 来构建解 $X_t$。\n$$\nX_t = \\left( x_0 + \\frac{1}{2} \\gamma t^2 + \\delta W_t \\right) \\left( \\exp\\left(\\frac{1}{2} a t^2 + b W_t\\right) \\right)\n$$\n这就是给定 Stratonovich SDE 的显式闭式解。", "answer": "$$\n\\boxed{\\left( x_0 + \\frac{1}{2} \\gamma t^2 + \\delta W_t \\right) \\exp\\left(\\frac{1}{2} a t^2 + b W_t\\right)}\n$$", "id": "3083173"}]}