{"hands_on_practices": [{"introduction": "在求解随机微分方程之前，我们必须首先精确地理解什么才是一个“解”。这个练习旨在挑战你对形式化定义的批判性思维。它重点关注一个候选过程必须满足的条件——例如路径连续性和积分方程必须成立的特定方式——才能被视为随机微分方程的真正解 [@problem_id:3048330]。", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 是一个满足通常条件的带滤概率空间，其上定义了一个标准的一维维纳过程 $W=(W_t)_{t\\in[0,T]}$。考虑如下的随机微分方程（在Itô意义下）\n$$\ndX_t = b(t,X_t)\\,dt + \\sigma(t,X_t)\\,dW_t,\\quad t\\in[0,T],\\qquad X_0=\\xi,\n$$\n其中 $b:[0,T]\\times\\mathbb{R}\\to\\mathbb{R}$ 和 $\\sigma:[0,T]\\times\\mathbb{R}\\to\\mathbb{R}$ 是Borel可测函数，$\\xi$ 是 $\\mathcal{F}_0$-可测的。给定一个取值于 $\\mathbb{R}$ 的候选过程 $X=(X_t)_{t\\in[0,T]}$。\n\n你的任务是，仅使用积分形式，识别出哪些验证程序能正确地确定 $X$ 解上述随机微分方程。请选择所有基于Itô解的定义和相关积分的适定性，有效且充分的程序选项。\n\nA. 验证 $X$ 是 $(\\mathcal{F}_t)$-适应的，其样本轨道几乎必然连续，验证 $b(\\cdot,X_{\\cdot})$ 在 $[0,T]$ 上几乎必然Lebesgue可积，且 $\\sigma(\\cdot,X_{\\cdot})$ 是循序可测的并且在 $[0,T]$ 上几乎必然平方可积，从而积分\n$$\n\\int_0^t b(s,X_s)\\,ds \\quad\\text{和}\\quad \\int_0^t \\sigma(s,X_s)\\,dW_s\n$$\n对所有 $t\\in[0,T]$ 都是适定的，并且，存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $t\\in[0,T]$，\n$$\nX_t(\\omega) = X_0(\\omega) + \\int_0^t b(s,X_s(\\omega))\\,ds + \\int_0^t \\sigma(s,X_s(\\omega))\\,dW_s(\\omega).\n$$\n\nB. 对于每个固定的 $t\\in[0,T]$，验证存在一个零测集 $N_t$（可能依赖于 $t$），使得\n$$\nX_t = X_0 + \\int_0^t b(s,X_s)\\,ds + \\int_0^t \\sigma(s,X_s)\\,dW_s\n$$\n几乎必然成立（即在 $N_t$ 之外成立）。不必确保对于不同的时间 $t$，例外集是相同的，也无需验证被积函数的任何可测性或可积性性质。\n\nC. 将随机积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$ 替换为逐轨道的Riemann–Stieltjes积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$，该积分定义为沿精化的确定性分割的黎曼和的极限，并对所有 $\\omega\\in\\Omega$ 逐轨道地检验该积分方程。\n\nD. 在可数稠密子集 $\\mathbb{Q}\\cap[0,T]$ 上验证该积分方程，方法如下：证明存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $q\\in\\mathbb{Q}\\cap[0,T]$，\n$$\nX_q(\\omega) = X_0(\\omega) + \\int_0^q b(s,X_s(\\omega))\\,ds + \\int_0^q \\sigma(s,X_s(\\omega))\\,dW_s(\\omega),\n$$\n并额外验证 $X$ 具有几乎必然连续的样本轨道，且两个积分定义了关于 $t$ 的几乎必然连续的过程。从连续性得出结论，该等式对于 $\\omega\\in N^{c}$ 的所有 $t\\in[0,T]$ 都成立。\n\nE. 只需验证对于每个 $t\\in[0,T]$，\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}[X_0] + \\int_0^t \\mathbb{E}[b(s,X_s)]\\,ds,\n$$\n和\n$$\n\\operatorname{Var}(X_t) = \\int_0^t \\mathbb{E}[\\sigma(s,X_s)^2]\\,ds,\n$$\n即可，因为这些条件意味着积分方程几乎必然成立。", "solution": "问题要求找出有效且充分的步骤，以验证给定过程 $X = (X_t)_{t\\in[0,T]}$ 是否是Itô随机微分方程（SDE）\n$$\ndX_t = b(t,X_t)\\,dt + \\sigma(t,X_t)\\,dW_t, \\quad t\\in[0,T], \\quad X_0=\\xi.\n$$\n的解。此分析的出发点是该SDE强解的正式定义，该定义以其积分形式给出。\n\n一个过程 $X = (X_t)_{t\\in[0,T]}$ 是该SDE的强解，如果它满足以下三个条件：\n1.  $X$ 是 $(\\mathcal{F}_t)$-适应的，并且其样本轨道几乎必然是连续的。\n2.  系数过程满足可积性条件：\n    $$\n    \\mathbb{P}\\left(\\int_0^T |b(s,X_s)|\\,ds  \\infty\\right) = 1\n    $$\n    和\n    $$\n    \\mathbb{P}\\left(\\int_0^T \\sigma(s,X_s)^2\\,ds  \\infty\\right) = 1.\n    $$\n    这些条件分别确保了Lebesgue积分和Itô积分是适定的。\n3.  积分方程\n    $$\n    X_t = X_0 + \\int_0^t b(s,X_s)\\,ds + \\int_0^t \\sigma(s,X_s)\\,dW_s\n    $$\n    对所有 $t\\in[0,T]$ 几乎必然成立。这意味着存在一个单一的零测集 $N \\subset \\Omega$，使得对于每个 $\\omega \\in N^c$，该等式对所有 $t \\in [0,T]$ 都成立。\n\n以这个定义为基准，我们评估每个选项。\n\n**A. 验证 $X$ 是 $(\\mathcal{F}_t)$-适应的，其样本轨道几乎必然连续，验证 $b(\\cdot,X_{\\cdot})$ 在 $[0,T]$ 上几乎必然Lebesgue可积，且 $\\sigma(\\cdot,X_{\\cdot})$ 是循序可测的并且在 $[0,T]$ 上几乎必然平方可积，从而积分是适定的，并且，存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $t\\in[0,T]$，积分方程成立。**\n\n该选项是对强解正式定义的一个审慎重述。\n- 它正确地要求 $X$ 是适应的且具有几乎必然连续的轨道。\n- 它正确地要求系数 $b$ 和 $\\sigma$ 满足可积性条件以确保积分的适定性。要求 $\\sigma(\\cdot, X_\\cdot)$ 是循序可测的是Itô积分适定的一个标准充分条件。\n- 关键在于，它抓住了积分方程必须在单个零测集 $N$ 之外对所有 $t \\in [0,T]$ 同时成立这一强要求。这就是“作为过程几乎必然成立”的含义。\n\n这个程序既有效又充分。\n结论：**正确**。\n\n**B. 对于每个固定的 $t\\in[0,T]$，验证存在一个零测集 $N_t$（可能依赖于 $t$），使得积分方程几乎必然成立（即在 $N_t$ 之外成立）。不必确保对于不同的时间 $t$，例外集是相同的，也无需验证被积函数的任何可测性或可积性性质。**\n\n这个程序有两个根本性的缺陷。\n1.  它未能验证积分的适定性。如果不检查 $b(\\cdot, X_\\cdot)$ 和 $\\sigma(\\cdot, X_\\cdot)$ 的可积性条件，表达式 $\\int_0^t b(s,X_s)\\,ds$ 和 $\\int_0^t \\sigma(s,X_s)\\,dW_s$ 可能没有定义。一个验证程序不能忽略其自身各项的先决条件。\n2.  对于每个 $t$，等式在 $\\Omega \\setminus N_t$ 上成立的条件比定义所要求的弱得多。无数个零测集的并集 $\\cup_{t \\in [0,T]} N_t$ 通常不是一个零测集。因此，该条件不能保证存在哪怕一条样本轨道 $\\omega$，使得等式 $X_t(\\omega) = \\dots$ 对所有 $t \\in [0,T]$ 都成立。这种较弱的性质有时被称为“宽感觉”解，但它不是标准Itô意义下SDE解的含义。\n\n结论：**错误**。\n\n**C. 将随机积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$ 替换为逐轨道的Riemann–Stieltjes积分 $\\int_0^t \\sigma(s,X_s)\\,dW_s$，该积分定义为沿精化的确定性分割的黎曼和的极限，并对所有 $\\omega\\in\\Omega$ 逐轨道地检验该积分方程。**\n\n这个程序从根本上误解了Itô积分的性质。Itô积分是一种随机积分，而不是逐轨道的Stieltjes型积分。维纳过程 $W_t$ 的一个关键性质是其样本轨道在任何区间上几乎必然是无界变差的。对于无界变差的函数，逐轨道的Riemann–Stieltjes积分通常没有定义。随机积分理论（Itô微积分）正是为了定义关于像维纳过程这类过程的积分而发展的。试图使用Riemann-Stieltjes框架是一个范畴性错误。\n\n结论：**错误**。\n\n**D. 在可数稠密子集 $\\mathbb{Q}\\cap[0,T]$ 上验证该积分方程，方法如下：证明存在一个零测集 $N\\in\\mathcal{F}$，$\\mathbb{P}(N)=0$，使得对于所有 $\\omega\\in N^{c}$ 和所有 $q\\in\\mathbb{Q}\\cap[0,T]$，积分方程成立，并额外验证 $X$ 具有几乎必然连续的样本轨道，且两个积分定义了关于 $t$ 的几乎必然连续的过程。从连续性得出结论，该等式对于 $\\omega\\in N^{c}$ 的所有 $t\\in[0,T]$ 都成立。**\n\n这描述了一种有效且常用的验证过程相等性的技巧。该论证依赖于实数分析中的一个标准结果：如果两个闭区间上的连续函数在一个稠密子集上相等，那么它们在整个区间上必定相同。\n该程序需要验证：\n1.  方程左边 $L_t(\\omega) = X_t(\\omega)$ 和右边 $R_t(\\omega) = X_0(\\omega) + \\int_0^t b(s,X_s(\\omega))\\,ds + \\int_0^t \\sigma(s,X_s(\\omega))\\,dW_s(\\omega)$ 对于几乎所有 $\\omega$ 都是关于 $t$ 的连续函数。$X_t$ 的连续性是一个直接的假设。$R_t$ 的连续性源于 L$^1$ 函数的Lebesgue积分对其上限是连续的，以及Itô积分的一个基本性质是它是一个具有连续样本轨道的过程（如果被积函数几乎必然平方可积，这便成立，而这必须被验证以保证积分适定）。\n2.  等式 $L_t(\\omega) = R_t(\\omega)$ 对于所有 $t \\in \\mathbb{Q}\\cap[0,T]$ 和几乎所有 $\\omega$ 成立（即在一个概率为1的集合上成立）。\n\n由于 $\\mathbb{Q}\\cap[0,T]$ 在 $[0,T]$ 中是稠密的，对于任何一个 $\\omega$，只要两个过程都是连续的并且在这个稠密集上相等，那么它们在所有 $t \\in [0,T]$ 上都必须相等。由于前提几乎必然成立，结论（对所有 $t$ 相等）也几乎必然成立。这就确定了存在一个单一的零测集，在此之外等式对所有 $t$ 成立，这与正式定义的要求相符。\n\n结论：**正确**。\n\n**E. 只需验证对于每个 $t\\in[0,T]$，$\\mathbb{E}[X_t] = \\mathbb{E}[X_0] + \\int_0^t \\mathbb{E}[b(s,X_s)]\\,ds$，和 $\\operatorname{Var}(X_t) = \\int_0^t \\mathbb{E}[\\sigma(s,X_s)^2]\\,ds$，即可，因为这些条件意味着积分方程几乎必然成立。**\n\n这是错误的。SDE定义了样本轨道之间的关系，这是一个比矩匹配强得多的条件。\n- 第一个关于均值的方程是SDE成立的一个*推论*（在允许交换期望和积分且假设Itô积分为零均值的条件下），但它不是充分条件。许多不同的随机过程可以有相同的均值函数。\n- 第二个关于方差的方程甚至通常都不正确。对于一个一般的Itô过程 $X_t$，其方差的演化更为复杂。即使它是正确的，它也只涉及一个二阶矩。\n- 根本性的错误在于，矩的相等（即使是所有矩）通常并不意味着过程的几乎必然逐轨道相等。SDE解是一个逐轨道的陈述，而这个程序只检查了 $X_t$ 在每个时间 $t$ 的边际分布的性质。\n\n结论：**错误**。", "answer": "$$\\boxed{AD}$$", "id": "3048330"}, {"introduction": "掌握了定义之后，我们来动手求解一个在金融和物理学中无处不在的重要随机微分方程。这个练习将指导你使用伊藤引理（Itô's formula），这是随机分析中用于求解随机微分方程最强大的工具之一。通过这个实践，你将学会如何通过变换简化一个复杂的随机微分方程，并最终确定其解的分布和关键统计特性 [@problem_id:3048360]。", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t \\in [0,T]},\\mathbb{P})$ 是一个带域流的概率空间，其上支撑一个标准的一维布朗运动 $W$。设 $a:[0,T]\\to\\mathbb{R}$ 和 $b:[0,T]\\to\\mathbb{R}$ 是满足 $\\int_{0}^{T}\\big(|a(s)|+b(s)^{2}\\big)\\,ds  \\infty$ 的确定性波莱尔函数。考虑齐次线性随机微分方程 (SDE)\n$$\ndX_t \\;=\\; a(t)\\,X_t\\,dt \\;+\\; b(t)\\,X_t\\,dW_t,\\qquad X_0 = x_00,\\quad t\\in[0,T].\n$$\n从该 SDE 的积分形式出发，仅使用伊藤积分和伊藤公式的核心定义和性质，推导在固定的 $t\\in(0,T]$ 时 $X_t$ 的分布，证明 $X_t$ 是对数正态的，并用 $a$ 和 $b$ 显式计算 $\\mathbb{E}[X_t]$ 和 $\\operatorname{Var}(X_t)$。将你的最终答案表示为一个 $1\\times 2$ 的行向量，其第一个元素是 $\\mathbb{E}[X_t]$，第二个元素是 $\\operatorname{Var}(X_t)$。无需四舍五入。", "solution": "该问题陈述是一个适定的随机微分方程练习。它提供了所有必要的信息：一个有效的 SDE、一个初始条件，以及对系数和基础布朗运动的标准假设。该问题具有科学依据，是客观的，并且不包含任何矛盾或歧义。因此，该问题是有效的，我们可以继续求解。\n\n随机微分方程 (SDE) 由下式给出\n$$\ndX_t = a(t)X_t dt + b(t)X_t dW_t\n$$\n初始条件为 $X_0 = x_0  0$，其中 $t \\in [0, T]$。函数 $a(t)$ 和 $b(t)$ 是确定性的。该 SDE 的积分形式为\n$$\nX_t = X_0 + \\int_0^t a(s)X_s ds + \\int_0^t b(s)X_s dW_s.\n$$\n为了解这个 SDE，我们通过变换 $Y_t = f(X_t) = \\ln(X_t)$ 引入一个新过程 $Y_t$。这个变换是良定义的，因为对于正的初始条件 $x_0  0$，该 SDE 的解 $X_t$ 对所有 $t \\ge 0$ 几乎必然保持为正。我们对 $Y_t$ 应用伊藤公式。对于一个二次可微函数 $f(x)$，关于过程 $X_t$ 的伊藤引理表明\n$$\nd f(X_t) = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) (dX_t)^2.\n$$\n在我们的例子中，$f(x) = \\ln(x)$，所以我们有导数 $f'(x) = \\frac{1}{x}$ 和 $f''(x) = -\\frac{1}{x^2}$。二次变分项 $(dX_t)^2$ 使用伊藤微积分的规则计算，即 $(dt)^2=0$，$dt dW_t = 0$，以及 $(dW_t)^2=dt$：\n$$\n(dX_t)^2 = (a(t)X_t dt + b(t)X_t dW_t)^2 = b(t)^2 X_t^2 (dW_t)^2 = b(t)^2 X_t^2 dt.\n$$\n将这些代入 $Y_t = \\ln(X_t)$ 的伊藤公式中：\n$$\ndY_t = \\frac{1}{X_t} dX_t + \\frac{1}{2} \\left( -\\frac{1}{X_t^2} \\right) (dX_t)^2\n$$\n$$\ndY_t = \\frac{1}{X_t} (a(t)X_t dt + b(t)X_t dW_t) - \\frac{1}{2X_t^2} (b(t)^2 X_t^2 dt)\n$$\n$$\ndY_t = (a(t) dt + b(t) dW_t) - \\frac{1}{2} b(t)^2 dt\n$$\n$$\ndY_t = \\left( a(t) - \\frac{1}{2} b(t)^2 \\right) dt + b(t) dW_t.\n$$\n这是一个关于 $Y_t$ 的带有加性噪声项的简单 SDE。我们可以通过从 $0$到 $t$直接积分来求解 $Y_t$：\n$$\nY_t - Y_0 = \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds + \\int_0^t b(s) dW_s.\n$$\n初始条件为 $Y_0 = \\ln(X_0) = \\ln(x_0)$。因此，\n$$\nY_t = \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds + \\int_0^t b(s) dW_s.\n$$\n现在我们可以确定 $Y_t$ 的分布。$Y_t$ 的表达式包含两部分：一个确定性部分和一个随机积分。\n对于固定的 $t$，前两项是确定性的：\n$$\n\\mu_Y(t) = \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds.\n$$\n第三项是一个被积函数为确定性函数 $b(s)$ 的伊藤积分。伊藤积分的一个基本性质是，对于一个确定性的、平方可积的函数 $g(s)$，随机变量 $Z_t = \\int_0^t g(s) dW_s$ 是服从均值为 $0$、方差为 $\\int_0^t g(s)^2 ds$ 的正态分布。在我们的例子中，$g(s) = b(s)$，所以随机积分 $\\int_0^t b(s) dW_s$ 是一个正态随机变量，其均值为 $\\mathbb{E}[\\int_0^t b(s) dW_s] = 0$，方差为 $\\operatorname{Var}(\\int_0^t b(s) dW_s) = \\int_0^t b(s)^2 ds$。\n\n因此，$Y_t$ 是一个常数与一个正态随机变量之和，这意味着 $Y_t$ 本身是一个正态随机变量。其分布为\n$$\nY_t \\sim \\mathcal{N}\\left( \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2} b(s)^2 \\right) ds, \\int_0^t b(s)^2 ds \\right).\n$$\n由于 $X_t = \\exp(Y_t)$ 且 $Y_t$ 服从正态分布，根据定义，随机变量 $X_t$ 服从对数正态分布。这证明了问题的第一部分。\n\n为了计算 $X_t$ 的期望和方差，我们使用对数正态分布的性质。如果 $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$，那么对于任意实数 $k$，$X = \\exp(Y)$ 的 $k$ 阶矩由下式给出\n$$\n\\mathbb{E}[X^k] = \\mathbb{E}[\\exp(kY)] = \\exp\\left( k\\mu + \\frac{1}{2}k^2\\sigma^2 \\right).\n$$\n对于我们的过程 $X_t = \\exp(Y_t)$，我们有：\n$$\n\\mu_t = \\mathbb{E}[Y_t] = \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2}b(s)^2 \\right) ds\n$$\n$$\n\\sigma_t^2 = \\operatorname{Var}(Y_t) = \\int_0^t b(s)^2 ds\n$$\n$X_t$ 的期望对应于一阶矩 ($k=1$)：\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\mu_t + \\frac{1}{2}\\sigma_t^2 \\right)\n$$\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\left[ \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2}b(s)^2 \\right) ds \\right] + \\frac{1}{2} \\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\ln(x_0) + \\int_0^t a(s) ds - \\frac{1}{2}\\int_0^t b(s)^2 ds + \\frac{1}{2}\\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t] = \\exp\\left( \\ln(x_0) + \\int_0^t a(s) ds \\right) = x_0 \\exp\\left( \\int_0^t a(s) ds \\right).\n$$\n为了求方差，我们首先计算二阶矩 $\\mathbb{E}[X_t^2]$ (使用 $k=2$)：\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\mu_t + \\frac{1}{2}(2^2)\\sigma_t^2 \\right) = \\exp\\left( 2\\mu_t + 2\\sigma_t^2 \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\left[ \\ln(x_0) + \\int_0^t \\left( a(s) - \\frac{1}{2}b(s)^2 \\right) ds \\right] + 2 \\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\ln(x_0) + 2\\int_0^t a(s) ds - \\int_0^t b(s)^2 ds + 2\\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left( 2\\ln(x_0) + 2\\int_0^t a(s) ds + \\int_0^t b(s)^2 ds \\right)\n$$\n$$\n\\mathbb{E}[X_t^2] = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds + \\int_0^t b(s)^2 ds \\right).\n$$\n方差由 $\\operatorname{Var}(X_t) = \\mathbb{E}[X_t^2] - (\\mathbb{E}[X_t])^2$ 给出：\n$$\n\\operatorname{Var}(X_t) = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds + \\int_0^t b(s)^2 ds \\right) - \\left( x_0 \\exp\\left( \\int_0^t a(s) ds \\right) \\right)^2\n$$\n$$\n\\operatorname{Var}(X_t) = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right) \\exp\\left( \\int_0^t b(s)^2 ds \\right) - x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right)\n$$\n提出公因式 $x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right)$，我们得到：\n$$\n\\operatorname{Var}(X_t) = x_0^2 \\exp\\left( 2\\int_0^t a(s) ds \\right) \\left[ \\exp\\left( \\int_0^t b(s)^2 ds \\right) - 1 \\right].\n$$\n所需的两个量是期望 $\\mathbb{E}[X_t]$ 和方差 $\\operatorname{Var}(X_t)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} x_0 \\exp\\left( \\int_0^t a(s) \\, ds \\right)  x_0^2 \\exp\\left( 2\\int_0^t a(s) \\, ds \\right) \\left[ \\exp\\left( \\int_0^t b(s)^2 \\, ds \\right) - 1 \\right] \\end{pmatrix}}\n$$", "id": "3048360"}, {"introduction": "在随机过程的文献中，你可能会遇到两种主要的随机积分：伊藤（Itô）积分和斯特拉托诺维奇（Stratonovich）积分。这项练习将引导你推导两者之间的转换关系，即所谓的伊藤-斯特拉托诺维奇修正项。理解这一转换对于在不同理论框架之间切换和正确应用随机模型至关重要 [@problem_id:3048335]。", "problem": "考虑一个过程 $X_{t} \\in \\mathbb{R}^{n}$ 的 $n$ 维 Stratonovich 意义下的随机微分方程 (SDE)，该过程由一个 $m$ 维标准布朗运动 (BM) $W_{t} \\in \\mathbb{R}^{m}$ 驱动：\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\alpha\\!\\left(X_{s}\\right)\\,\\mathrm{d}s + \\int_{0}^{t} b\\!\\left(X_{s}\\right) \\circ \\mathrm{d}W_{s},\n$$\n其中 $\\alpha : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ 是连续可微的，而 $b : \\mathbb{R}^{n} \\to \\mathbb{R}^{n \\times m}$ 的列向量为 $b^{(k)}(x) \\in \\mathbb{R}^{n}$，$k = 1,\\dots,m$，每个列向量都是二次连续可微的，并满足适当的增长条件和 Lipschitz 条件，以确保解的存在唯一性以及随机积分的良定义性。积分 $\\int_{0}^{t} b(X_{s}) \\circ \\mathrm{d}W_{s}$ 应通过中点黎曼和理解为 Stratonovich 积分，而 $\\int_{0}^{t} b(X_{s})\\,\\mathrm{d}W_{s}$ 是通过左点黎曼和定义的 Itô 积分。\n\n仅从半鞅被积函数的 Itô 和 Stratonovich 积分的定义以及布朗运动的二次变差性质出发，推导必须加到 Stratonovich 漂移 $\\alpha(x)$ 上的漂移修正向量 $\\Delta(x)$，使得相应的 Itô 形式的 SDE，\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\big(\\alpha\\!\\left(X_{s}\\right) + \\Delta\\!\\left(X_{s}\\right)\\big)\\,\\mathrm{d}s + \\int_{0}^{t} b\\!\\left(X_{s}\\right)\\,\\mathrm{d}W_{s},\n$$\n具有相同的解过程 $\\{X_{t}\\}_{t \\ge 0}$。\n\n请用扩散矩阵 $b(x)$ 及其列向量的雅可比矩阵，将您的最终答案 $\\Delta(x)$ 表示为单个闭式解析表达式。令 $J_{b^{(k)}}(x) \\in \\mathbb{R}^{n \\times n}$ 表示向量场 $b^{(k)}(x)$ 的雅可比矩阵。您的最终答案必须是单个表达式，而不是一个方程。无需进行数值近似或四舍五入。", "solution": "目标是推导漂移修正向量 $\\Delta(x)$，该向量连接了给定随机微分方程 (SDE) 的 Stratonovich 和 Itô 表示。给定 Stratonovich SDE：\n$$\n\\mathrm{d}X_{t} = \\alpha(X_{t})\\,\\mathrm{d}t + b(X_{t}) \\circ \\mathrm{d}W_{t}\n\\tag{1}\n$$\n及其等价的 Itô 形式：\n$$\n\\mathrm{d}X_{t} = \\left(\\alpha(X_{t}) + \\Delta(X_{t})\\right)\\,\\mathrm{d}t + b(X_{t})\\,\\mathrm{d}W_{t}\n\\tag{2}\n$$\n其中 $X_t \\in \\mathbb{R}^n$，$W_t \\in \\mathbb{R}^m$，$\\alpha: \\mathbb{R}^n \\to \\mathbb{R}^n$ 且 $b: \\mathbb{R}^n \\to \\mathbb{R}^{n \\times m}$。矩阵 $b(x)$ 的列向量记为 $b^{(k)}(x)$，$k=1, \\dots, m$。\n\nItô 积分和 Stratonovich 积分的根本区别在于它们作为黎曼和极限的定义。Itô 积分使用时间区间的左端点来计算被积函数，而 Stratonovich 积分使用中点。\n\n让我们将 Stratonovich 随机项表示为布朗运动 $W_t$ 各分量的和：\n$$\n\\int_{0}^{t} b(X_{s}) \\circ \\mathrm{d}W_{s} = \\sum_{k=1}^{m} \\int_{0}^{t} b^{(k)}(X_{s}) \\circ \\mathrm{d}W_{s}^{(k)}\n$$\n我们将分析单项 $\\int_{0}^{t} b^{(k)}(X_{s}) \\circ \\mathrm{d}W_{s}^{(k)}$。考虑区间 $[0, t]$ 的一个划分 $0 = t_0  t_1  \\dots  t_N = t$。Stratonovich 积分是以下和的极限：\n$$\nS_N^{(k)} = \\sum_{i=0}^{N-1} b^{(k)}\\left(\\frac{X_{t_{i+1}} + X_{t_i}}{2}\\right) (W_{t_{i+1}}^{(k)} - W_{t_i}^{(k)})\n$$\n我们可以将 $b^{(k)}$ 的求值点重写为 $X_{t_i} + \\frac{1}{2}(X_{t_{i+1}} - X_{t_i})$。令 $\\Delta X_{t_i} = X_{t_{i+1}} - X_{t_i}$ 和 $\\Delta W_{t_i}^{(k)} = W_{t_{i+1}}^{(k)} - W_{t_i}^{(k)}$。\n\n假设 $b^{(k)}$ 是二次连续可微的，我们可以在 $X_{t_i}$ 附近对 $b^{(k)}(x)$ 进行泰勒展开：\n$$\nb^{(k)}\\left(X_{t_i} + \\frac{1}{2}\\Delta X_{t_i}\\right) = b^{(k)}(X_{t_i}) + \\frac{1}{2} J_{b^{(k)}}(X_{t_i}) \\Delta X_{t_i} + O\\left(\\|\\Delta X_{t_i}\\|^2\\right)\n$$\n其中 $J_{b^{(k)}}(x)$ 是向量场 $b^{(k)}(x)$ 的 $n \\times n$ 雅可比矩阵，其 $(p,q)$ 项为 $\\frac{\\partial b_{p}^{(k)}}{\\partial x_q}(x) = \\frac{\\partial b_{pk}}{\\partial x_q}(x)$。\n\n将此展开式代入和 $S_N^{(k)}$ 中：\n$$\nS_N^{(k)} = \\sum_{i=0}^{N-1} \\left( b^{(k)}(X_{t_i}) + \\frac{1}{2} J_{b^{(k)}}(X_{t_i}) \\Delta X_{t_i} \\right) \\Delta W_{t_i}^{(k)} + \\sum_{i=0}^{N-1} O\\left(\\|\\Delta X_{t_i}\\|^2\\right) \\Delta W_{t_i}^{(k)}\n$$\n括号中的第一项 $\\sum_{i=0}^{N-1} b^{(k)}(X_{t_i}) \\Delta W_{t_i}^{(k)}$ 对应于定义 Itô 积分 $\\int_{0}^{t} b^{(k)}(X_{s}) \\mathrm{d}W_{s}^{(k)}$ 的黎曼和。\n\n对于第二项，我们需要近似 $\\Delta X_{t_i}$。根据 SDE 的 Itô 形式（方程 2），在小区间 $\\Delta t_i = t_{i+1}-t_i$ 上，增量 $\\Delta X_{t_i}$ 的最低阶近似由随机部分决定，因为 $\\mathrm{d}t$ 的阶数低于 $\\sqrt{\\mathrm{d}t}$：\n$$\n\\Delta X_{t_i} \\approx b(X_{t_i}) \\Delta W_{t_i} = \\sum_{l=1}^{m} b^{(l)}(X_{t_i}) \\Delta W_{t_i}^{(l)}\n$$\n我们将 $\\Delta X_{t_i}$ 的这个近似代入和的第二部分：\n$$\n\\frac{1}{2} \\sum_{i=0}^{N-1} J_{b^{(k)}}(X_{t_i}) \\left( \\sum_{l=1}^{m} b^{(l)}(X_{t_i}) \\Delta W_{t_i}^{(l)} \\right) \\Delta W_{t_i}^{(k)} = \\frac{1}{2} \\sum_{l=1}^{m} \\sum_{i=0}^{N-1} J_{b^{(k)}}(X_{t_i}) b^{(l)}(X_{t_i}) \\Delta W_{t_i}^{(l)} \\Delta W_{t_i}^{(k)}\n$$\n当划分变得更精细时（即 $\\max_i \\Delta t_i \\to 0$），我们使用独立标准布朗运动的二次协变差性质：\n$$\n\\sum_{i=0}^{N-1} \\Delta W_{t_i}^{(l)} \\Delta W_{t_i}^{(k)} \\longrightarrow [W^{(l)}, W^{(k)}]_t = \\delta_{kl} t\n$$\n其中 $\\delta_{kl}$ 是克罗内克 δ。在微分形式下，这写作 $\\mathrm{d}W_{t}^{(l)} \\mathrm{d}W_{t}^{(k)} = \\delta_{kl} \\mathrm{d}t$。\n因此，该和收敛于一个关于时间的标准黎曼积分：\n$$\n\\frac{1}{2} \\sum_{l=1}^{m} \\int_{0}^{t} J_{b^{(k)}}(X_{s}) b^{(l)}(X_{s}) \\delta_{kl} \\mathrm{d}s = \\frac{1}{2} \\int_{0}^{t} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n包含 $O(\\|\\Delta X_{t_i}\\|^2)$ 的高阶项在极限中消失。\n\n综合这些结果，我们得到第 $k$ 个分量的 Stratonovich 积分和 Itô 积分之间的关系：\n$$\n\\int_{0}^{t} b^{(k)}(X_{s}) \\circ \\mathrm{d}W_{s}^{(k)} = \\int_{0}^{t} b^{(k)}(X_{s}) \\mathrm{d}W_{s}^{(k)} + \\frac{1}{2} \\int_{0}^{t} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n对所有分量 $k=1, \\dots, m$求和：\n$$\n\\int_{0}^{t} b(X_{s}) \\circ \\mathrm{d}W_{s} = \\int_{0}^{t} b(X_{s}) \\mathrm{d}W_{s} + \\frac{1}{2} \\int_{0}^{t} \\sum_{k=1}^{m} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n现在我们将此表达式代回 Stratonovich SDE（方程 1）：\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\alpha(X_{s})\\,\\mathrm{d}s + \\int_{0}^{t} b(X_{s})\\,\\mathrm{d}W_{s} + \\frac{1}{2} \\int_{0}^{t} \\sum_{k=1}^{m} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\mathrm{d}s\n$$\n将 $\\mathrm{d}s$ 项组合在一起：\n$$\nX_{t} = X_{0} + \\int_{0}^{t} \\left( \\alpha(X_{s}) + \\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(X_{s}) b^{(k)}(X_{s}) \\right)\\,\\mathrm{d}s + \\int_{0}^{t} b(X_{s})\\,\\mathrm{d}W_{s}\n$$\n通过与 Itô SDE 形式（方程 2）进行比较，我们可以确定漂移修正项 $\\Delta(x)$：\n$$\n\\alpha(x) + \\Delta(x) = \\alpha(x) + \\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(x) b^{(k)}(x)\n$$\n因此，漂移修正向量为：\n$$\n\\Delta(x) = \\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(x) b^{(k)}(x)\n$$\n这个向量 $\\Delta(x)$ 通常被称为 Itô-Stratonovich 修正项。以分量形式表示，$\\Delta(x)$ 的第 $j$ 个分量由 $\\Delta_j(x) = \\frac{1}{2} \\sum_{k=1}^{m} \\sum_{i=1}^{n} b_{ik}(x) \\frac{\\partial b_{jk}}{\\partial x_i}(x)$ 给出。", "answer": "$$\\boxed{\\frac{1}{2} \\sum_{k=1}^{m} J_{b^{(k)}}(x) b^{(k)}(x)}$$", "id": "3048335"}]}