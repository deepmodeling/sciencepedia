{"hands_on_practices": [{"introduction": "一维扩散过程在其边界处的行为是其特征描述的基础。为了确定像原点这样的边界对CIR过程是否可达，我们使用一个称为标度函数的数学工具。本练习侧重于计算标度函数的导数——标度密度，并将其表示为一种能揭示其在原点附近行为的形式。掌握这一计算是严谨分析边界性质的第一步。[@problem_id:3080478]", "problem": "考虑在 $\\mathbb{R}_{+}$ 上的 Cox–Ingersoll–Ross (CIR) 扩散，它由随机微分方程定义\n$$\ndX_{t}=\\kappa\\left(\\theta - X_{t}\\right)\\,dt+\\sigma \\sqrt{X_{t}}\\,dW_{t},\n$$\n其中参数 $\\kappa > 0$、$\\theta > 0$ 和 $\\sigma > 0$，$W_{t}$ 是一个标准布朗运动。对于此扩散，考虑其尺度密度导数，定义为\n$$\ns'(x)=\\exp\\left\\{-\\int^{x}\\frac{2\\kappa(\\theta - y)}{\\sigma^{2} y}\\,dy\\right\\},\\quad x > 0.\n$$\n计算此积分，并将 $s'(x)$ 简化为幂指数形式，以分离出其在 $x=0$ 附近的行为。具体而言，请将其表示为以下形式\n$$\ns'(x)=C\\,x^{\\alpha}\\,\\exp(\\beta x),\n$$\n其中指数 $\\alpha$ 和 $\\beta$ 为显式表达式，而 $C>0$ 是一个任意的归一化常数。请用 $\\kappa$、$\\theta$、$\\sigma$ 和 $x$ 将您的最终答案表示为 $s'(x)$ 的单个闭式表达式。无需四舍五入，也不涉及任何单位。", "solution": "用户希望找到 Cox–Ingersoll–Ross (CIR) 过程的尺度密度导数的简化表达式。\n\n### 第 1 步：提取已知条件\n- CIR 过程的随机微分方程 (SDE) 是 $dX_{t}=\\kappa\\left(\\theta - X_{t}\\right)\\,dt+\\sigma \\sqrt{X_{t}}\\,dW_{t}$。\n- 参数为 $\\kappa > 0$、$\\theta > 0$、$\\sigma > 0$。\n- 过程的定义域是 $\\mathbb{R}_{+}$ ($x > 0$)。\n- 尺度密度导数由 $s'(x)=\\exp\\left\\{-\\int^{x}\\frac{2\\kappa(\\theta - y)}{\\sigma^{2} y}\\,dy\\right\\}$ 给出，其中 $x > 0$。\n- 简化表达式的目标形式是 $s'(x)=C\\,x^{\\alpha}\\,\\exp(\\beta x)$，其中 $C>0$ 是一个任意的归一化常数。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题是随机微分方程理论中的一个标准数学计算。所有定义和参数都是标准的且陈述清晰。所要求的计算是良定义的，并导向一个唯一的函数形式。不存在科学上的不一致、矛盾或含糊不清之处。\n\n### 第 3 步：结论与行动\n问题是**有效的**。将推导求解。\n\n### 推导过程\n我们的任务是计算并简化 CIR 过程的尺度密度导数 $s'(x)$ 的表达式。给定公式为\n$$\ns'(x)=\\exp\\left\\{-\\int^{x}\\frac{2\\kappa(\\theta - y)}{\\sigma^{2} y}\\,dy\\right\\}\n$$\n其中 $\\kappa$、$\\theta$ 和 $\\sigma$ 是正常数，且 $x$ 的定义域为 $x > 0$。\n\n我们的第一步是计算指数中的不定积分。将该积分记为 $I(x)$：\n$$\nI(x) = \\int^{x}\\frac{2\\kappa(\\theta - y)}{\\sigma^{2} y}\\,dy\n$$\n我们可以通过拆分分数来简化被积函数：\n$$\n\\frac{2\\kappa(\\theta - y)}{\\sigma^{2} y} = \\frac{2\\kappa\\theta}{\\sigma^{2}y} - \\frac{2\\kappa y}{\\sigma^{2}y} = \\frac{2\\kappa\\theta}{\\sigma^{2}y} - \\frac{2\\kappa}{\\sigma^{2}}\n$$\n现在，我们可以对该表达式逐项对 $y$ 进行积分。参数 $\\kappa$、$\\theta$ 和 $\\sigma$ 是常数。\n$$\nI(x) = \\int^{x} \\left( \\frac{2\\kappa\\theta}{\\sigma^{2}y} - \\frac{2\\kappa}{\\sigma^{2}} \\right) dy\n$$\n$$\nI(x) = \\frac{2\\kappa\\theta}{\\sigma^{2}} \\int^{x} \\frac{1}{y}\\,dy - \\frac{2\\kappa}{\\sigma^{2}} \\int^{x} 1\\,dy\n$$\n由于该过程的定义域为 $x > 0$，积分变量 $y$ 也为正。因此，$1/y$ 的积分是 $\\ln(y)$。\n$$\nI(x) = \\frac{2\\kappa\\theta}{\\sigma^{2}} \\ln(x) - \\frac{2\\kappa}{\\sigma^{2}} x + K_{1}\n$$\n这里，$K_{1}$ 是积分常数。不定积分的记法 $\\int^x$ 意味着积分下限是一个任意点，该点的选择被包含在这个常数中。\n\n现在，我们将此结果代回到 $s'(x)$ 的表达式中：\n$$\ns'(x) = \\exp\\left\\{ - \\left( \\frac{2\\kappa\\theta}{\\sigma^{2}} \\ln(x) - \\frac{2\\kappa}{\\sigma^{2}} x + K_{1} \\right) \\right\\}\n$$\n将指数中的负号分配进去，得到：\n$$\ns'(x) = \\exp\\left\\{ -\\frac{2\\kappa\\theta}{\\sigma^{2}} \\ln(x) + \\frac{2\\kappa}{\\sigma^{2}} x - K_{1} \\right\\}\n$$\n利用指数函数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将其分解为三项的乘积：\n$$\ns'(x) = \\exp\\left(-\\frac{2\\kappa\\theta}{\\sigma^{2}} \\ln(x)\\right) \\cdot \\exp\\left(\\frac{2\\kappa}{\\sigma^{2}} x\\right) \\cdot \\exp(-K_{1})\n$$\n我们使用恒等式 $a \\ln(b) = \\ln(b^a)$ 来简化第一项，这意味着 $\\exp(a \\ln(b)) = b^a$：\n$$\n\\exp\\left(-\\frac{2\\kappa\\theta}{\\sigma^{2}} \\ln(x)\\right) = x^{-\\frac{2\\kappa\\theta}{\\sigma^{2}}}\n$$\n常数项 $\\exp(-K_{1})$ 是一个任意正常数，正如问题陈述中所述。我们将其记为 $C$：\n$$\nC = \\exp(-K_1)\n$$\n将这些简化后的部分代回到 $s'(x)$ 的表达式中，我们得到：\n$$\ns'(x) = C \\, x^{-\\frac{2\\kappa\\theta}{\\sigma^{2}}} \\, \\exp\\left(\\frac{2\\kappa}{\\sigma^{2}} x\\right)\n$$\n该表达式符合所要求的幂指数形式 $s'(x)=C\\,x^{\\alpha}\\,\\exp(\\beta x)$，其中的指数可确定为：\n$$\n\\alpha = -\\frac{2\\kappa\\theta}{\\sigma^{2}}\n$$\n$$\n\\beta = \\frac{2\\kappa}{\\sigma^{2}}\n$$\n问题要求给出 $s'(x)$ 的单个闭式表达式。这就是我们的最终结果。", "answer": "$$\n\\boxed{C x^{-\\frac{2\\kappa\\theta}{\\sigma^{2}}} \\exp\\left(\\frac{2\\kappa}{\\sigma^{2}} x\\right)}\n$$", "id": "3080478"}, {"introduction": "费勒条件为CIR过程能否达到零点提供了一个明確的判据。本实践问题将理论付诸实践，要求您在费勒条件不被满足时，直接计算过程触及零的概率。通过使用标度函数并分析其极限行为，您将从第一性原理出发，证明在此参数设定下，原点确实是一个可达边界。[@problem_id:3080493]", "problem": "考虑在 $(0,\\infty)$ 上由以下随机微分方程定义的 Cox–Ingersoll–Ross (CIR) 平方根扩散\n$$\n\\mathrm{d}X_t \\;=\\; \\kappa\\big(\\theta - X_t\\big)\\,\\mathrm{d}t \\;+\\; \\sigma \\sqrt{X_t}\\,\\mathrm{d}W_t,\\qquad X_0=x > 0,\n$$\n其中 $\\kappa > 0$、$\\theta > 0$ 和 $\\sigma > 0$ 是常数，$W_t$ 是标准布朗运动。令 $\\tau_0 := \\inf\\{t\\ge 0 : X_t = 0\\}$ 表示首次到达边界 $0$ 的时间。假设 Feller 条件不成立，即 $2\\kappa\\theta  \\sigma^2$。\n\n仅使用一维扩散的无穷小生成元和标度函数的定义，按如下步骤进行：\n\n1) 令 $L$ 为作用于二次连续可微的检验函数 $f$ 上的生成元，其定义为\n$$\nL f(x) \\;=\\; \\kappa\\big(\\theta - x\\big) f'(x) \\;+\\; \\tfrac{1}{2}\\sigma^2 x\\, f''(x).\n$$\n对于一个固定的 $b > x$，定义 $p_b(x):=\\mathbb{P}_x(\\tau_0  \\tau_b)$，其中 $\\tau_b := \\inf\\{t\\ge 0 : X_t = b\\}$。证明 $p_b$ 是以下边值问题的解\n$$\nL p_b(x) \\;=\\; 0 \\quad \\text{on } (0,b), \\qquad p_b(0)=1,\\quad p_b(b)=0,\n$$\n并且 $p_b$ 可以用该扩散过程的标度函数 $s$ 来表示，其中 $s$ 是 $L s=0$ 在 $(0,\\infty)$ 上的任意严格递增解，在仿射变换下归一化。\n\n2) 通过求解 $L s=0$ 推导标度函数 $s$ 的显式表达式（相差一个仿射变换）。使用该表达式将 $p_b(x)$ 仅用 $s$ 表示。\n\n3) 在参数限制 $2\\kappa\\theta  \\sigma^2$ 下，分析极限 $s(0+)$ 和 $s(\\infty)$，然后计算\n$$\n\\lim_{b\\to\\infty} p_b(x) \\;=\\; \\mathbb{P}_x(\\tau_0  \\infty).\n$$\n得出 $\\mathbb{P}_x(\\tau_0  \\infty)$ 的闭式解，特别是，证明对于所有 $x > 0$，它都是严格为正的。\n\n你的最终答案必须是一个精确的数值或一个单一的闭式解析表达式。无需四舍五入。", "solution": "问题要求计算在条件 $2\\kappa\\theta  \\sigma^2$ 下，一个从 $X_0 = x > 0$ 出发的 Cox-Ingersoll-Ross (CIR) 过程在有限时间内到达边界 $0$ 的概率 $\\mathbb{P}_x(\\tau_0  \\infty)$。推导过程需分三步，使用该过程的无穷小生成元和标度函数。\n\nCIR 过程由以下随机微分方程描述：\n$$\n\\mathrm{d}X_t = \\kappa(\\theta - X_t)\\,\\mathrm{d}t + \\sigma \\sqrt{X_t}\\,\\mathrm{d}W_t\n$$\n参数为 $\\kappa > 0$，$\\theta > 0$，$\\sigma > 0$。该扩散过程的无穷小生成元 $L$ 由下式给出：\n$$\nL f(x) = \\kappa(\\theta - x) f'(x) + \\frac{1}{2}\\sigma^2 x f''(x)\n$$\n\n### 第 1 部分：到达概率的边值问题\n\n令 $\\tau_a = \\inf\\{t \\ge 0 : X_t = a\\}$ 为首次到达水平 $a$ 的时间。我们关心的是概率 $p_b(x) = \\mathbb{P}_x(\\tau_0  \\tau_b)$，这是指从 $x \\in (0, b)$ 出发的过程在到达边界 $b$ 之前先到达边界 $0$ 的概率。\n\n对于一般的一维 Itô 扩散，一个基本结果表明，到达概率 $p_b(x)$ 是区间 $(0,b)$ 上以下边值问题 (BVP) 的解：\n$$\nL p_b(x) = 0, \\quad x \\in (0,b)\n$$\n其边界条件由边界上的吸收性决定：\n$$\np_b(0) = 1 \\quad (\\text{过程到达 0}) \\\\\np_b(b) = 0 \\quad (\\text{过程到達 b})\n$$\n问题陈述正确地指出了这个边值问题。\n\n扩散过程的标度函数 $s(x)$ 被定义为常微分方程 $L s(x) = 0$ 的任意非常数解。这个二阶线性齐次常微分方程的通解是两个线性无关解的线性组合。其中一个解是常数，比如说 $f_1(x) = 1$，另一个是非常数标度函数 $s(x)$。因此，$p_b(x)$ 的通解可以写成 $s(x)$ 的仿射变换：\n$$\np_b(x) = C_1 s(x) + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的常数。\n应用边界条件：\n\\begin{align*}\np_b(0) = C_1 s(0) + C_2 = 1 \\\\\np_b(b) = C_1 s(b) + C_2 = 0\n\\end{align*}\n从第二个方程，我们得到 $C_2 = -C_1 s(b)$。将其代入第一个方程得到：\n$$\nC_1 s(0) - C_1 s(b) = 1 \\implies C_1 = \\frac{1}{s(0) - s(b)}\n$$\n于是，$C_2 = -\\frac{s(b)}{s(0) - s(b)} = \\frac{s(b)}{s(b) - s(0)}$。\n将这些常数代回到 $p_b(x)$ 的表达式中：\n$$\np_b(x) = \\frac{1}{s(0) - s(b)} s(x) + \\frac{s(b)}{s(b) - s(0)} = \\frac{-s(x) + s(b)}{s(b) - s(0)} = \\frac{s(b) - s(x)}{s(b) - s(0)}\n$$\n这个表达式给出了用标度函数 $s(x)$ 表示的概率 $p_b(x)$。注意，这个表达式在 $s(x)$ 的仿射变换下是不变的，即，如果我们用 $a s(x) + d$ 替换 $s(x)$（其中 $a \\neq 0$ 和 $d$ 是常数），$p_b(x)$ 的值保持不变。\n\n### 第 2 部分：标度函数的推导\n\n为了找到标度函数的显式形式，我们必须求解常微分方程 $L s(x) = 0$：\n$$\n\\kappa(\\theta - x)s'(x) + \\frac{1}{2}\\sigma^2 x s''(x) = 0\n$$\n令 $u(x) = s'(x)$。关于 $u(x)$ 的方程是一个一阶线性常微分方程：\n$$\n\\frac{1}{2}\\sigma^2 x u'(x) = -\\kappa(\\theta - x)u(x)\n$$\n这是一个关于 $u(x)$ 的可分离变量方程：\n$$\n\\frac{u'(x)}{u(x)} = -\\frac{2\\kappa(\\theta - x)}{\\sigma^2 x} = \\frac{2\\kappa x - 2\\kappa\\theta}{\\sigma^2 x} = \\frac{2\\kappa}{\\sigma^2} - \\frac{2\\kappa\\theta}{\\sigma^2 x}\n$$\n对两边关于 $x$ 积分：\n$$\n\\ln|u(x)| = \\int \\left(\\frac{2\\kappa}{\\sigma^2} - \\frac{2\\kappa\\theta}{\\sigma^2 x}\\right) dx = \\frac{2\\kappa}{\\sigma^2} x - \\frac{2\\kappa\\theta}{\\sigma^2} \\ln(x) + C\n$$\n因为定义域是 $(0,\\infty)$，我们使用 $\\ln(x)$。对两边取指数得到：\n$$\nu(x) = \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x - \\frac{2\\kappa\\theta}{\\sigma^2} \\ln(x) + C\\right) = A \\, x^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x\\right)\n$$\n其中 $A = e^C$ 是一个任意常数。这个函数 $u(x)$ 被称为标度密度。由于最终概率 $p_b(x)$ 与 $s(x)$ 的任何缩放无关，我们可以选择 $A=1$。\n因此，标度密度为：\n$$\ns'(x) = x^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x\\right)\n$$\n通过对标度密度积分可以得到标度函数 $s(x)$：\n$$\ns(x) = \\int s'(t) dt = \\int x^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} x\\right) dx\n$$\n我们可以通过选择特定的积分限来定义一个特定的标度函数，例如，$s(x) = \\int_c^x s'(t) dt$，对于某个 $c > 0$。使用这个定义，$p_b(x)$ 的概率可以明确地写成积分的比值：\n$$\np_b(x) = \\frac{s(b) - s(x)}{s(b) - s(0)} = \\frac{\\int_c^b s'(t)dt - \\int_c^x s'(t)dt}{\\int_c^b s'(t)dt - \\int_c^0 s'(t)dt} = \\frac{\\int_x^b s'(t)dt}{\\int_0^b s'(t)dt}\n$$\n因此，\n$$\np_b(x) = \\frac{\\int_x^b t^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} t\\right) dt}{\\int_0^b t^{-2\\kappa\\theta/\\sigma^2} \\exp\\left(\\frac{2\\kappa}{\\sigma^2} t\\right) dt}\n$$\n\n### 第 3 部分：极限分析与最终概率\n\n我们需要计算 $\\mathbb{P}_x(\\tau_0  \\infty)$，它由极限 $\\lim_{b\\to\\infty} p_b(x)$ 给出。\n让我们在给定条件 $2\\kappa\\theta  \\sigma^2$ 下分析 $p_b(x)$ 表达式中的积分。\n令 $\\alpha = \\frac{2\\kappa}{\\sigma^2}$ 和 $\\beta = \\frac{2\\kappa\\theta}{\\sigma^2}$。条件变为 $\\beta  1$。另外，由于 $\\kappa, \\theta, \\sigma > 0$，我们有 $\\alpha > 0$ 和 $\\beta > 0$。被积函数是 $t^{-\\beta}e^{\\alpha t}$。\n\n首先，考虑分母中的积分：$\\int_0^b t^{-\\beta}e^{\\alpha t} dt$。\n我们必须检查积分在下限 $t=0$ 处是否收敛。在 $t=0$ 附近，项 $e^{\\alpha t} \\approx 1$，所以被积函数的行为类似于 $t^{-\\beta}$。积分 $\\int_0^c t^{-\\beta} dt$ 收敛当且仅当 $-\\beta > -1$，这意味着 $\\beta  1$。这恰好是问题中给出的条件。因此，对于任何有限的 $b > 0$，积分 $\\int_0^b t^{-\\beta}e^{\\alpha t} dt$ 是一个有限的正数。\n\n现在我们分析当 $b\\to\\infty$ 时的极限。让我们考虑分母 $D(b) = \\int_0^b t^{-\\beta}e^{\\alpha t} dt$。当 $b\\to\\infty$ 时，我们考察被积函数 $t^{-\\beta}e^{\\alpha t}$ 的行为。由于 $\\alpha = 2\\kappa/\\sigma^2 > 0$，指数项 $e^{\\alpha t}$ 增长到无穷大并且主导多项式项 $t^{-\\beta}$。因此，积分发散：\n$$\n\\lim_{b\\to\\infty} D(b) = \\int_0^\\infty t^{-\\beta}e^{\\alpha t} dt = \\infty\n$$\n类似地，对于分子 $N(b) = \\int_x^b t^{-\\beta}e^{\\alpha t} dt$（其中 $x > 0$ 固定），当 $b\\to\\infty$ 时的极限也发散：\n$$\n\\lim_{b\\to\\infty} N(b) = \\int_x^\\infty t^{-\\beta}e^{\\alpha t} dt = \\infty\n$$\n我们得到了一个 $\\frac{\\infty}{\\infty}$ 形式的极限，可以使用 L'Hôpital's Rule 来解决。我们对分子和分母关于 $b$求导：\n$$\n\\frac{d}{db}N(b) = \\frac{d}{db}\\int_x^b t^{-\\beta}e^{\\alpha t} dt = b^{-\\beta}e^{\\alpha b}\n$$\n$$\n\\frac{d}{db}D(b) = \\frac{d}{db}\\int_0^b t^{-\\beta}e^{\\alpha t} dt = b^{-\\beta}e^{\\alpha b}\n$$\n应用 L'Hôpital's Rule：\n$$\n\\mathbb{P}_x(\\tau_0  \\infty) = \\lim_{b\\to\\infty} p_b(x) = \\lim_{b\\to\\infty} \\frac{N(b)}{D(b)} = \\lim_{b\\to\\infty} \\frac{N'(b)}{D'(b)} = \\lim_{b\\to\\infty} \\frac{b^{-\\beta}e^{\\alpha b}}{b^{-\\beta}e^{\\alpha b}} = \\lim_{b\\to\\infty} 1 = 1\n$$\n当 Feller 条件不成立（$2\\kappa\\theta  \\sigma^2$）时，从任意 $x > 0$ 出发的 CIR 过程在有限时间内到达零的概率是 $1$。这个结果证实了在此参数体系下，原点是一个可达边界。所得概率 $1$ 对所有 $x > 0$ 都是严格为正的。", "answer": "$$\\boxed{1}$$", "id": "3080493"}, {"introduction": "将理论与应用相结合是量化金融中的一项关键技能。虽然CIR过程在连续时间内是非负的，但要确保此特性在数值模拟中得以保持，需要精心的格式设计。本练习要求您构建并分析一个能够内在地保持非负性的漂移隐式格式，并将其行为与费勒条件的理论预测进行比较。[@problem_id:3080496]", "problem": "考虑 Cox–Ingersoll–Ross (CIR) 短期利率模型，其由以下随机微分方程 (SDE) 定义\n$$\ndX_t \\;=\\; \\kappa\\,(\\theta - X_t)\\,dt \\;+\\; \\sigma\\,\\sqrt{X_t}\\,dW_t,\\qquad X_0 \\ge 0,\n$$\n其中 $\\kappa > 0$、$\\theta \\ge 0$ 和 $\\sigma \\ge 0$ 是参数，$(W_t)_{t\\ge 0}$ 是标准布朗运动。已知所谓的 Feller 条件 $2\\,\\kappa\\,\\theta \\ge \\sigma^2$ 能确保在 $X_0 > 0$ 时，对于所有 $t > 0$，精确解都严格为正。\n\n您的任务是构建一个单步漂移隐式格式，该格式通过在下一个时间步以隐式方式处理均值回归漂移项和平方根扩散项来保持非负性。在一个步长为 $\\Delta t > 0$ 的均匀时间网格上进行，并将布朗增量表示为 $\\Delta W_n := W_{t_{n+1}}-W_{t_n}$，其中 $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ 在各步之间独立。从 SDE 和基本的时间离散化原理（随机积分的左点和右点近似，以及求解标量二次方程的链式法则）出发，推导该漂移隐式平方根格式的精确闭式单步更新映射 $\\varphi$，使得 $X_{n+1}=\\varphi(X_n,\\Delta W_n)$。\n\n然后，使用您推导出的表达式，从第一性原理出发，评估单步更新在何种条件下严格为正，并解释这与 Feller 条件 $2\\,\\kappa\\,\\theta \\ge \\sigma^2$ 下精确过程的严格正性相比有何不同。在您的讨论中，请将其与完全截断显式格式在非负性与严格正性方面的行为进行对比。\n\n重要提示：作为最终答案，请提供映射 $\\varphi(x,\\Delta W)$ 的单一闭式解析表达式，用 $\\kappa$、$\\theta$、$\\sigma$、$\\Delta t$、$x$ 和 $\\Delta W$ 表示。最终答案中不应包含任何不等式或其他评论。请勿对表达式进行取整。", "solution": "该问题要求推导和分析一个用于 Cox–Ingersoll–Ross (CIR) 过程的单步漂移隐式数值格式，该格式也对扩散项进行隐式处理。CIR 过程由以下随机微分方程 (SDE) 描述：\n$$\ndX_t = \\kappa(\\theta - X_t)dt + \\sigma\\sqrt{X_t}dW_t\n$$\n参数为 $\\kappa > 0$、$\\theta \\ge 0$、$\\sigma \\ge 0$，初始条件为 $X_0 \\ge 0$。\n\n首先，我们在均匀时间网格 $t_n = n\\Delta t$ 上推导映射 $\\varphi$，使得 $X_{n+1} = \\varphi(X_n, \\Delta W_n)$。SDE 在区间 $[t_n, t_{n+1}]$ 上的积分形式为：\n$$\nX_{t_{n+1}} - X_{t_n} = \\int_{t_n}^{t_{n+1}} \\kappa(\\theta - X_s)ds + \\int_{t_n}^{t_{n+1}} \\sigma\\sqrt{X_s}dW_s\n$$\n设 $X_n$ 是 $X_{t_n}$ 的数值近似。一个同时隐式处理扩散项的漂移隐式格式意味着我们使用被积函数在区间右端点 $t_{n+1}$ 的值来近似它们。这是一种后向欧拉类型的近似。\n漂移积分近似为：\n$$\n\\int_{t_n}^{t_{n+1}} \\kappa(\\theta - X_s)ds \\approx \\kappa(\\theta - X_{n+1})\\Delta t\n$$\n随机积分近似为：\n$$\n\\int_{t_n}^{t_{n+1}} \\sigma\\sqrt{X_s}dW_s \\approx \\sigma\\sqrt{X_{n+1}}\\int_{t_n}^{t_{n+1}}dW_s = \\sigma\\sqrt{X_{n+1}}\\Delta W_n\n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$。将这些近似代入 SDE 的积分形式，得到 $X_{n+1}$ 的离散更新方程：\n$$\nX_{n+1} - X_n = \\kappa(\\theta - X_{n+1})\\Delta t + \\sigma\\sqrt{X_{n+1}}\\Delta W_n\n$$\n这是一个关于 $X_{n+1}$ 的隐式方程。为了求解 $X_{n+1}$，我们重新整理各项：\n$$\nX_{n+1} + \\kappa X_{n+1}\\Delta t - \\sigma\\sqrt{X_{n+1}}\\Delta W_n - (X_n + \\kappa\\theta\\Delta t) = 0\n$$\n$$\n(1 + \\kappa\\Delta t)X_{n+1} - (\\sigma\\Delta W_n)\\sqrt{X_{n+1}} - (X_n + \\kappa\\theta\\Delta t) = 0\n$$\n这是一个关于变量 $\\sqrt{X_{n+1}}$ 的二次方程。令 $Y = \\sqrt{X_{n+1}}$。由于 $X_{n+1}$ 必须为非负量，我们必须有 $Y \\ge 0$。方程变为：\n$$\n(1 + \\kappa\\Delta t)Y^2 - (\\sigma\\Delta W_n)Y - (X_n + \\kappa\\theta\\Delta t) = 0\n$$\n这是一个形如 $aY^2 + bY + c = 0$ 的二次方程，其系数为：\n$a = 1 + \\kappa\\Delta t$\n$b = -\\sigma\\Delta W_n$\n$c = -(X_n + \\kappa\\theta\\Delta t)$\n\n$Y$ 的解由二次求根公式 $Y = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 给出。\n判别式为 $D = b^2 - 4ac = (-\\sigma\\Delta W_n)^2 - 4(1 + \\kappa\\Delta t)(- (X_n + \\kappa\\theta\\Delta t))$：\n$$\nD = \\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)\n$$\n考虑到参数约束 $\\kappa > 0$、$\\theta \\ge 0$ 以及 $X_n \\ge 0$ 和 $\\Delta t > 0$ 的事实，项 $(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)$ 始终为非负。因此，判别式 $D$ 始终为非负，保证了 $Y$ 有实数根。解为：\n$$\nY = \\frac{\\sigma\\Delta W_n \\pm \\sqrt{\\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)}}{2(1 + \\kappa\\Delta t)}\n$$\n我们需要 $Y = \\sqrt{X_{n+1}} \\ge 0$。分母 $2(1 + \\kappa\\Delta t)$ 是严格为正的。我们来分析两个根的分子符号。平方根项满足 $\\sqrt{D} \\ge \\sqrt{\\sigma^2(\\Delta W_n)^2} = |\\sigma\\Delta W_n|$。\n带有负号的根给出的分子 $\\sigma\\Delta W_n - \\sqrt{D} \\le \\sigma\\Delta W_n - |\\sigma\\Delta W_n|$ 始终为非正。这将导致 $Y \\le 0$。\n带有正号的根给出的分子 $\\sigma\\Delta W_n + \\sqrt{D} \\ge \\sigma\\Delta W_n + |\\sigma\\Delta W_n|$ 始终为非负。这将导致 $Y \\ge 0$。\n因此，为确保非负性，我们必须选择正根：\n$$\n\\sqrt{X_{n+1}} = \\frac{\\sigma\\Delta W_n + \\sqrt{\\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)}}{2(1 + \\kappa\\Delta t)}\n$$\n将两边平方，得到 $X_{n+1}$ 的表达式。表示为所要求的映射 $\\varphi(x, \\Delta W)$，其中 $x$ 代表步初的状态，$\\Delta W$ 是布朗增量，我们有：\n$$\nX_{n+1} = \\varphi(x, \\Delta W) = \\left( \\frac{\\sigma\\Delta W + \\sqrt{\\sigma^2(\\Delta W)^2 + 4(1 + \\kappa\\Delta t)(x + \\kappa\\theta\\Delta t)}}{2(1 + \\kappa\\Delta t)} \\right)^2\n$$\n\n接下来，我们分析该格式的严格正性。由于 $X_{n+1}$ 是一个平方项，只要 $X_n \\ge 0$，通过构造就保证了非负性 ($X_{n+1} \\ge 0$）。该格式是严格为正的，$X_{n+1} > 0$，当且仅当平方内的项不为零。分母不为零。分子为零当且仅当：\n$$\n\\sigma\\Delta W_n + \\sqrt{\\sigma^2(\\Delta W_n)^2 + 4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t)} = 0\n$$\n这要求 $\\sigma\\Delta W_n \\le 0$，并且在平方和重新整理后，有 $4(1 + \\kappa\\Delta t)(X_n + \\kappa\\theta\\Delta t) = 0$。由于 $1 + \\kappa\\Delta t > 0$，这意味着 $X_n + \\kappa\\theta\\Delta t = 0$。考虑到所有项的非负性，这只可能在 $X_n=0$ 且 $\\theta=0$ 时发生。\n因此，如果 $X_n > 0$，则项 $X_n + \\kappa\\theta\\Delta t$ 严格为正，意味着分子严格为正，因此 $X_{n+1} > 0$。该格式无条件地保持严格正性。如果 $X_n=0$，只要 $\\theta > 0$，$X_{n+1}$ 将严格为正。如果 $\\theta>0$，过程会在一步内脱离零边界。\n\n这种行为比连续时间 CIR 过程的行为更强。只有在满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 时，才能保证精确解 $X_t$ 在所有 $t > 0$（如果 $X_0 > 0$）时都严格为正。如果 $2\\kappa\\theta  \\sigma^2$，过程可能以正概率触及零。相比之下，所推导的数值格式对于任何参数集 $\\kappa > 0, \\theta \\ge 0, \\sigma \\ge 0$ 和任何时间步长 $\\Delta t > 0$ 都保持严格正性。对扩散项的隐式处理是这一稳健特性的原因，因为它有效地防止了随机项将过程驱动至零或零以下。\n\n最后，我们将其与完全截断显式格式进行对比，后者通常定义为：\n$$\nX_{n+1} = \\max\\left(0, X_n + \\kappa(\\theta - X_n)\\Delta t + \\sigma\\sqrt{X_n}\\Delta W_n\\right)\n$$\n这种显式格式通过直接截断来保证非负性。然而，每当 $\\max$ 函数的参数为负时，该格式会将 $X_{n+1}$ 精确地设置为 $0$。这会产生一个人工的“粘性”边界，过程可能会在此处被吸附在零值一个或多个时间步，而这种行为在真实过程中可能不存在，尤其是在 Feller 条件成立时。相比之下，隐式格式通过其代数结构自然地保证了非负性，并且只在特定和有限的条件下（$X_n=0, \\theta=0$）允许过程触及零，从而更忠实地表示了过程在边界附近的动态。", "answer": "$$\\boxed{\\left( \\frac{\\sigma \\Delta W + \\sqrt{\\sigma^2 (\\Delta W)^2 + 4(1 + \\kappa \\Delta t)(x + \\kappa \\theta \\Delta t)}}{2(1 + \\kappa \\Delta t)} \\right)^2}$$", "id": "3080496"}]}