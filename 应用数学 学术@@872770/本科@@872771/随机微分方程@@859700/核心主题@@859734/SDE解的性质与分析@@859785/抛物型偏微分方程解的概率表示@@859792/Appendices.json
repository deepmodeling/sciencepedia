{"hands_on_practices": [{"introduction": "费曼-卡兹公式（Feynman-Kac formula）建立了抛物型偏微分方程（PDE）与随机过程期望之间的深刻联系。这个练习提供了一个直接的动手验证机会：通过为一个简单的伊藤扩散（Itô diffusion）及其对应的后向科尔莫戈罗夫方程（Kolmogorov backward equation）计算期望解，并直接微分，您将亲眼见证随机过程的结构如何精确地转化为PDE中的微分算子。[@problem_id:3070563]", "problem": "设 $W_{t}$ 为标准布朗运动 (BM)，考虑由以下随机微分方程 (SDE) 给出的一维伊藤扩散：\n$$\n\\mathrm{d}X_{t} \\;=\\; \\mu\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_{t}, \\qquad X_{0}=x,\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma0$ 是常数。设该扩散的无穷小生成元 $\\mathcal{L}$ 作用于二次连续可微函数 $\\varphi$ 的方式为：\n$$\n\\mathcal{L}\\varphi(x) \\;=\\; \\mu\\,\\varphi'(x) \\;+\\; \\frac{1}{2}\\,\\sigma^{2}\\,\\varphi''(x).\n$$\n固定 $\\alpha \\in \\mathbb{R}$ 并定义 $f(y)=\\exp(\\alpha y)$。对于 $t\\geq 0$ 和 $x\\in\\mathbb{R}$，定义\n$$\nu(t,x) \\;=\\; \\mathbb{E}^{x}\\!\\left[f\\!\\left(X_{t}\\right)\\right],\n$$\n其中 $\\mathbb{E}^{x}$ 表示从 $X_{0}=x$ 开始的过程的期望。\n\n仅使用适用于此情景的基础工具（特别是伊藤扩散的生成元的定义、布朗运动的分布性质、伊藤公式，以及在此 $f$ 选择下由控制收敛定理证明的期望下的标准微分法则），完成以下任务：\n\n- 显式计算 $u(t,x)$。\n- 计算 $u_{t}(t,x)$ 和 $\\mathcal{L}u(t,x)$。\n- 直接验证对于所有 $t0$ 和 $x\\in\\mathbb{R}$，有 $u_{t}(t,x)=\\mathcal{L}u(t,x)$，并且 $u(0,x)=f(x)$。\n\n你的最终答案必须是你得到的 $u(t,x)$ 的封闭形式表达式。不需要进行数值四舍五入。", "solution": "该问题已经过验证。\n\n### 步骤 1：提取已知条件\n- 随机过程 $X_t$ 是一个伊藤扩散，由随机微分方程 (SDE) 描述：\n$$\n\\mathrm{d}X_{t} \\;=\\; \\mu\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_{t}\n$$\n- 初始条件为 $X_{0}=x$。\n- $W_{t}$ 是一个标准的一维布朗运动。\n- $\\mu \\in \\mathbb{R}$ 和 $\\sigma0$ 是常数参数。\n- 对于函数 $\\varphi \\in C^2(\\mathbb{R})$，无穷小生成元 $\\mathcal{L}$ 定义为：\n$$\n\\mathcal{L}\\varphi(x) \\;=\\; \\mu\\,\\varphi'(x) \\;+\\; \\frac{1}{2}\\,\\sigma^{2}\\,\\varphi''(x)\n$$\n- 函数 $f: \\mathbb{R} \\to \\mathbb{R}$ 由 $f(y)=\\exp(\\alpha y)$ 定义，其中 $\\alpha \\in \\mathbb{R}$ 为固定常数。\n- 函数 $u(t,x)$ 定义为 $f(X_t)$ 在过程从 $x$ 开始的条件下的期望：\n$$\nu(t,x) \\;=\\; \\mathbb{E}^{x}\\!\\left[f\\!\\left(X_{t}\\right)\\right]\n$$\n- 任务是：\n    1. 显式计算 $u(t,x)$。\n    2. 计算偏导数 $u_{t}(t,x)$ 以及生成元 $\\mathcal{L}u(t,x)$ 的作用。\n    3. 验证偏微分方程 (PDE) $u_{t}(t,x)=\\mathcal{L}u(t,x)$ 和初始条件 $u(0,x)=f(x)$ 得到满足。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性：** 该问题是随机微积分中的一个标准练习，阐明了随机微分方程（SDE）和抛物型偏微分方程（PDE）之间的联系，这一概念由费曼-卡茨公式（Feynman-Kac formula）形式化。所有定义（SDE、生成元、期望）都是标准的，并且在数学上是严谨的。\n- **适定性：** 该问题提供了所有必要的信息，并要求求解一个特定的函数并进行验证。存在唯一、稳定且有意义的解。\n- **客观性：** 该问题以精确的数学语言陈述，没有任何主观性或歧义。\n\n### 步骤 3：结论与行动\n该问题有效。将提供详细的解答。\n\n### 解答\n\n解题过程首先显式求解SDE，然后计算期望以求得 $u(t,x)$，最后通过直接微分验证PDE和初始条件。\n\n**1. 显式计算 $u(t,x)$。**\n\n$X_t$ 的SDE由下式给出：\n$$\n\\mathrm{d}X_{t} = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}, \\quad X_{0}=x.\n$$\n这是一个具有常系数的线性SDE。我们可以直接从 $0$ 到 $t$ 进行积分：\n$$\n\\int_{0}^{t} \\mathrm{d}X_{s} = \\int_{0}^{t} \\mu\\,\\mathrm{d}s + \\int_{0}^{t} \\sigma\\,\\mathrm{d}W_{s}\n$$\n$$\nX_{t} - X_{0} = \\mu t + \\sigma (W_{t} - W_{0})\n$$\n考虑到对于标准布朗运动，$X_{0}=x$ 且 $W_{0}=0$ 几乎必然成立，过程 $X_t$ 的显式解为：\n$$\nX_{t} = x + \\mu t + \\sigma W_{t}\n$$\n标准布朗运动 $W_t$ 是一个高斯过程。对于任意固定的 $t0$，随机变量 $W_t$ 服从均值为 $0$、方差为 $t$ 的正态分布，即 $W_t \\sim \\mathcal{N}(0, t)$。由于 $X_t$ 是正态分布随机变量 $W_t$ 的线性变换，因此 $X_t$ 也服从正态分布。我们计算其均值和方差：\n$X_t$ 的均值为\n$$\n\\mathbb{E}^{x}[X_t] = \\mathbb{E}[x + \\mu t + \\sigma W_{t}] = x + \\mu t + \\sigma\\mathbb{E}[W_t] = x + \\mu t + \\sigma \\cdot 0 = x + \\mu t.\n$$\n$X_t$ 的方差为\n$$\n\\mathrm{Var}^{x}(X_t) = \\mathrm{Var}(x + \\mu t + \\sigma W_{t}) = \\mathrm{Var}(\\sigma W_{t}) = \\sigma^2 \\mathrm{Var}(W_{t}) = \\sigma^2 t.\n$$\n因此，对于给定的起点 $x$，随机变量 $X_t$ 服从正态分布 $X_t \\sim \\mathcal{N}(x + \\mu t, \\sigma^2 t)$。\n\n现在，我们计算 $u(t,x)$：\n$$\nu(t,x) = \\mathbb{E}^{x}[f(X_t)] = \\mathbb{E}^{x}[\\exp(\\alpha X_t)].\n$$\n这正是正态随机变量 $X_t$ 的矩生成函数 (MGF) 在 $\\alpha$ 处的值。一个服从 $Y \\sim \\mathcal{N}(m, s^2)$ 的随机变量 $Y$ 的 MGF 由 $M_Y(a) = \\mathbb{E}[\\exp(a Y)] = \\exp(am + \\frac{1}{2}a^2s^2)$ 给出。\n在我们的例子中，$Y=X_t$，$a=\\alpha$，均值为 $m = x + \\mu t$，方差为 $s^2 = \\sigma^2 t$。将这些代入MGF公式，我们得到 $u(t,x)$ 的显式形式：\n$$\nu(t,x) = \\exp\\left(\\alpha(x + \\mu t) + \\frac{1}{2}\\alpha^2(\\sigma^2 t)\\right) = \\exp\\left(\\alpha x + \\alpha \\mu t + \\frac{1}{2}\\alpha^2 \\sigma^2 t\\right).\n$$\n\n**2. 计算 $u_t(t,x)$ 和 $\\mathcal{L}u(t,x)$。**\n\n我们首先计算 $u(t,x)$ 关于 $t$ 的偏导数。为清晰起见，我们可以将 $u(t,x)$ 写为：\n$$\nu(t,x) = \\exp(\\alpha x) \\exp\\left(\\left(\\alpha \\mu + \\frac{1}{2}\\alpha^2 \\sigma^2\\right)t\\right).\n$$\n对 $t$ 求导：\n$$\nu_{t}(t,x) = \\frac{\\partial}{\\partial t}u(t,x) = \\exp(\\alpha x) \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[\\exp\\left(\\left(\\alpha \\mu + \\frac{1}{2}\\alpha^2 \\sigma^2\\right)t\\right)\\right]\n$$\n$$\nu_{t}(t,x) = \\exp(\\alpha x) \\cdot \\exp\\left(\\left(\\alpha \\mu + \\frac{1}{2}\\alpha^2 \\sigma^2\\right)t\\right) \\cdot \\left(\\alpha \\mu + \\frac{1}{2}\\alpha^2 \\sigma^2\\right)\n$$\n$$\nu_{t}(t,x) = \\left(\\alpha \\mu + \\frac{1}{2}\\alpha^2 \\sigma^2\\right) u(t,x).\n$$\n\n接下来，我们计算 $\\mathcal{L}u(t,x)$。算子 $\\mathcal{L}$ 作用于空间变量 $x$。我们需要 $u(t,x)$ 关于 $x$ 的一阶和二阶偏导数：\n$$\nu(t,x) = \\exp\\left(\\alpha x + \\alpha \\mu t + \\frac{1}{2}\\alpha^2 \\sigma^2 t\\right).\n$$\n关于 $x$ 的一阶导数是：\n$$\n\\frac{\\partial}{\\partial x}u(t,x) = u_x(t,x) = \\alpha \\cdot \\exp\\left(\\alpha x + \\alpha \\mu t + \\frac{1}{2}\\alpha^2 \\sigma^2 t\\right) = \\alpha u(t,x).\n$$\n关于 $x$ 的二阶导数是：\n$$\n\\frac{\\partial^2}{\\partial x^2}u(t,x) = u_{xx}(t,x) = \\alpha \\cdot \\frac{\\partial}{\\partial x}u(t,x) = \\alpha (\\alpha u(t,x)) = \\alpha^2 u(t,x).\n$$\n现在我们应用无穷小生成元 $\\mathcal{L}$：\n$$\n\\mathcal{L}u(t,x) = \\mu u_x(t,x) + \\frac{1}{2}\\sigma^2 u_{xx}(t,x)\n$$\n代入我们求得的导数：\n$$\n\\mathcal{L}u(t,x) = \\mu (\\alpha u(t,x)) + \\frac{1}{2}\\sigma^2 (\\alpha^2 u(t,x))\n$$\n$$\n\\mathcal{L}u(t,x) = \\left(\\mu \\alpha + \\frac{1}{2}\\sigma^2 \\alpha^2\\right) u(t,x).\n$$\n这些计算中所需的期望符号下的微分运算是由控制收敛定理保证的，因为对于任何有限时间区间，所得的被积函数都是适当有界的。\n\n**3. 验证PDE和初始条件。**\n\n通过比较步骤2中导出的表达式，我们可以直接验证该PDE：\n$$\nu_{t}(t,x) = \\left(\\alpha \\mu + \\frac{1}{2}\\alpha^2 \\sigma^2\\right) u(t,x)\n$$\n$$\n\\mathcal{L}u(t,x) = \\left(\\mu \\alpha + \\frac{1}{2}\\sigma^2 \\alpha^2\\right) u(t,x)\n$$\n显然，对于所有 $t0$ 和 $x\\in\\mathbb{R}$，\n$$\nu_{t}(t,x) = \\mathcal{L}u(t,x).\n$$\n这个方程是该扩散过程的柯尔莫哥洛夫后向方程。\n\n最后，我们验证在 $t=0$ 时的初始条件：\n$$\nu(0,x) = \\exp\\left(\\alpha x + \\alpha \\mu (0) + \\frac{1}{2}\\alpha^2 \\sigma^2 (0)\\right) = \\exp(\\alpha x).\n$$\n根据定义，$f(x) = \\exp(\\alpha x)$。因此，我们验证了\n$$\nu(0,x) = f(x).\n$$\n因此，函数 $u(t,x)$ 是偏微分方程 $\\frac{\\partial u}{\\partial t} = \\mathcal{L}u$ 带有初始条件 $u(0,x)=f(x)$ 的柯西问题的解。\n\n最终答案是 $u(t,x)$ 的显式形式。", "answer": "$$\\boxed{\\exp\\left(\\alpha x + \\alpha \\mu t + \\frac{1}{2}\\alpha^2 \\sigma^2 t\\right)}$$", "id": "3070563"}, {"introduction": "我们可以从多个角度审视随机微分方程（SDE）与偏微分方程之间的关联。这个实践将引导您通过傅里叶分析的视角来探索这一联系，傅里叶分析是求解线性偏微分方程的强大工具。通过将一个基本的傅里叶模（Fourier mode）作为初始条件，您将发现概率期望的计算等价于求解布朗运动的特征函数，从而揭示了随机过程与傅里叶乘子之间的深层关系。[@problem_id:3070549]", "problem": "令 $d \\in \\mathbb{N}$，并设 $\\{W_{t}\\}_{t \\geq 0}$ 为一个标准的 $d$ 维布朗运动，其中 $W_{0} = 0$，其增量是独立且平稳的，并且对于每个 $t \\geq 0$，$W_{t}$ 是均值为 $0$、协方差为 $t I_{d}$ 的高斯分布，其中 $I_{d}$ 是 $d \\times d$ 的单位矩阵。考虑热传导偏微分方程（PDE）的柯西问题\n$$\n\\partial_{t} u(t,x) = \\frac{1}{2} \\Delta u(t,x), \\quad t  0, \\; x \\in \\mathbb{R}^{d},\n$$\n其初始条件为\n$$\nu(0,x) = f(x) = \\exp(i\\, k \\cdot x),\n$$\n其中 $k \\in \\mathbb{R}^{d}$ 是一个固定向量，$k \\cdot x$ 表示欧几里得内积，而 $|k|$ 是 $k$ 的欧几里得范数。从布朗运动的无穷小生成元是 $\\frac{1}{2}\\Delta$ 以及其相关的马尔可夫半群源于 $W_{t}$ 的分布性质这些基本事实出发，推导解 $u(t,x)$ 的概率表示，并显式计算 $u(t,x)$。在你的推理中，请指明该半群对傅里叶模 $\\exp(i\\, k \\cdot x)$ 的作用如何对应于一个傅里叶乘子，并将此乘子与 $W_{t}$ 的特征函数联系起来。请将你的最终答案表示为 $u(t,x)$ 的单个闭式解析表达式。无需四舍五入。[@problem_id:543]", "solution": "用户要求对一个数学问题进行验证和求解。\n\n### 步骤1：提取已知条件\n-   维度是一个自然数，$d \\in \\mathbb{N}$。\n-   $\\{W_{t}\\}_{t \\geq 0}$ 是一个标准的 $d$ 维布朗运动，且 $W_{0} = 0$。其增量是独立且平稳的。对于任意 $t \\geq 0$，随机变量 $W_{t}$ 服从均值为 $0$、协方差矩阵为 $t I_{d}$ 的高斯分布，其中 $I_{d}$ 是 $d \\times d$ 的单位矩阵。\n-   偏微分方程（PDE）是热传导方程：$\\partial_{t} u(t,x) = \\frac{1}{2} \\Delta u(t,x)$，其中 $t  0$ 且 $x \\in \\mathbb{R}^{d}$。这里，$\\Delta$ 是拉普拉斯算子。\n-   初始条件是 $u(0,x) = f(x) = \\exp(i\\, k \\cdot x)$，其中 $k \\in \\mathbb{R}^{d}$ 是一个固定向量。符号 $k \\cdot x$ 代表欧几里得内积。\n-   问题要求使用布朗运动 $\\{W_t\\}_{t \\geq 0}$ 的无穷小生成元是算子 $\\frac{1}{2}\\Delta$ 这一事实。\n-   任务是推导解 $u(t,x)$ 的概率表示，显式地计算它，并将结果与傅里叶乘子和 $W_t$ 的特征函数联系起来。\n\n### 步骤2：使用已知条件进行验证\n对问题陈述的有效性进行检验。\n\n-   **科学依据**：该问题深深植根于随机微分方程和偏微分方程的数学理论中。布朗运动、其生成元和热传导方程之间的联系是一个基本的、经过严格建立的结果，即 Feynman-Kac 公式。所有前提都是标准的且数学上正确的。\n-   **适定性**：对于具有有界、光滑初始条件（如 $f(x) = \\exp(i\\, k \\cdot x)$）的热传导方程柯西问题，是适定问题的经典例子。它存在唯一、稳定的解。\n-   **客观性**：问题以精确、无歧义的数学语言陈述。\n-   **完备性与一致性**：问题提供了所有必要的信息：偏微分方程、初始条件以及底层随机过程的性质。没有矛盾之处。\n\n### 步骤3：结论与行动\n该问题是**有效的**。这是一个将随机过程与偏微分方程联系起来的标准练习。我们可以继续进行求解。\n\n### 求解推导\n\n该问题涉及带有初始条件 $u(0,x) = f(x)$ 的热传导方程 $\\partial_{t} u(t,x) = \\frac{1}{2} \\Delta u(t,x)$。这个偏微分方程可以重写为 $\\partial_{t} u(t,x) - \\mathcal{L} u(t,x) = 0$，其中 $\\mathcal{L} = \\frac{1}{2}\\Delta$ 是指定的标准 $d$ 维布朗运动 $\\{W_t\\}_{t \\geq 0}$ 的无穷小生成元。\n\n该偏微分方程与随机过程之间的联系由 Feynman-Kac 公式给出。对于一个从 $x$ 开始（即 $X_0 = x$）且生成元为 $\\mathcal{L}$ 的随机过程 $X_s$，具有终端条件 $u(T,x) = f(x)$ 的后向 Kolmogorov 方程 $\\partial_t u + \\mathcal{L}u = 0$ 的解是 $u(t,x) = \\mathbb{E}[f(X_{T-t}^x)]$。通过变量替换，具有初始条件 $u(0,x) = f(x)$ 的前向方程（热传导方程）$\\partial_t u - \\mathcal{L}u = 0$ 的解可以通过考虑过程 $X_s = x + W_s$ 得到。解 $u(t,x)$ 便是初始函数 $f$ 在该过程于时间 $t$ 的位置上的值的期望。这就给出了该解的概率表示：\n$$\nu(t,x) = \\mathbb{E}[f(x + W_t)]\n$$\n此处，期望 $\\mathbb{E}[\\cdot]$ 是关于布朗运动的概率测度来计算的。\n\n初始条件作为傅里叶模给出，$f(x) = \\exp(i\\, k \\cdot x)$。将其代入概率表示中，我们得到：\n$$\nu(t,x) = \\mathbb{E}[\\exp(i\\, k \\cdot (x + W_t))]\n$$\n利用指数函数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将期望内的项分开：\n$$\nu(t,x) = \\mathbb{E}[\\exp(i\\, k \\cdot x) \\exp(i\\, k \\cdot W_t)]\n$$\n项 $\\exp(i\\, k \\cdot x)$ 相对于关于布朗运动 $W_t$ 路径的期望是确定性的。因此，它可以从期望中提出来：\n$$\nu(t,x) = \\exp(i\\, k \\cdot x) \\, \\mathbb{E}[\\exp(i\\, k \\cdot W_t)]\n$$\n剩下的项 $\\mathbb{E}[\\exp(i\\, k \\cdot W_t)]$ 根据定义是随机变量 $W_t$ 的特征函数，在向量 $k \\in \\mathbb{R}^d$ 处求值。我们将其记为 $\\phi_{W_t}(k)$。\n\n我们已知 $W_t$ 是一个 $d$ 维高斯随机变量，其均值向量为 $\\mu = 0$，协方差矩阵为 $\\Sigma = t I_d$。一个一般多元正态随机变量 $Y \\sim \\mathcal{N}(\\mu, \\Sigma)$ 的特征函数由公式 $\\phi_Y(v) = \\exp(i\\, v \\cdot \\mu - \\frac{1}{2} v^T \\Sigma v)$ 给出。对于我们的具体情况，$Y = W_t$，$\\mu = 0$，$\\Sigma = tI_d$，向量是 $k$。将这些代入公式得到：\n$$\n\\phi_{W_t}(k) = \\exp\\left(i\\, k \\cdot 0 - \\frac{1}{2} k^{T} (tI_d) k\\right)\n$$\n指数中的第一项是 $0$。第二项是：\n$$\n-\\frac{1}{2} k^{T} (tI_d) k = -\\frac{t}{2} (k^{T} k) = -\\frac{t}{2} |k|^2\n$$\n其中 $|k|^2 = k \\cdot k$ 是向量 $k$ 的欧几里得范数的平方。\n因此，$W_t$ 的特征函数是：\n$$\n\\phi_{W_t}(k) = \\exp\\left(-\\frac{t}{2} |k|^2\\right)\n$$\n将此结果代回到我们关于 $u(t,x)$ 的表达式中：\n$$\nu(t,x) = \\exp(i\\, k \\cdot x) \\exp\\left(-\\frac{t}{2} |k|^2\\right)\n$$\n合并指数项，得到最终的显式解：\n$$\nu(t,x) = \\exp\\left(i\\, k \\cdot x - \\frac{t}{2} |k|^2\\right)\n$$\n这个表达式是给定初始条件的热传导方程的解。\n\n问题还要求我们在相关的马尔可夫半群的背景下分析这个结果。解算子 $P_t$ 将初始数据 $f$ 映射到解 $u(t, \\cdot)$，它是一个由 $(P_t f)(x) = \\mathbb{E}[f(x+W_t)]$ 定义的半群。我们的计算表明，该半群对傅里叶模 $f(x) = \\exp(i\\, k \\cdot x)$ 的作用是：\n$$\n(P_t \\exp(i k \\cdot x))(x) = \\exp\\left(-\\frac{t}{2} |k|^2\\right) \\exp(i\\, k \\cdot x)\n$$\n这表明傅里叶模 $\\exp(i\\, k \\cdot x)$ 是热半群算子 $P_t$ 的特征函数。对于波矢为 $k$ 的模，相应的特征值是 $\\lambda_k(t) = \\exp(-\\frac{t}{2} |k|^2)$。\n\n这个特征值恰好是与热传导方程相关的傅里叶乘子。如果使用傅里叶变换来求解该偏微分方程，我们会发现解的傅里叶变换 $\\hat{u}(t,\\xi)$ 与初始数据的傅里叶变换 $\\hat{f}(\\xi)$ 通过 $\\hat{u}(t,\\xi) = \\hat{f}(\\xi) \\exp(-\\frac{t}{2}|\\xi|^2)$ 相关联。因子 $\\exp(-\\frac{t}{2}|\\xi|^2)$ 就是傅里叶乘子。\n\n我们的概率推导表明，这个傅里愈乘子与底层布朗运动增量 $W_t$ 在频率向量 $\\xi=k$ 处求值的特征函数是相同的。这建立了所要求的深刻联系：半群对傅里叶模的作用是乘以一个标量，而这个标量（傅里叶乘子）就是相关随机过程的随机增量的特征函数。", "answer": "$$\n\\boxed{\\exp\\left(i k \\cdot x - \\frac{t|k|^2}{2}\\right)}\n$$", "id": "3070549"}, {"introduction": "为了建立对概率方法的信心，验证其与经典技术的一致性是至关重要的一步。本练习要求您用两种截然不同的方法求解热方程：首先是使用经典的PDE方法，将初始数据与热核（heat kernel）进行卷积；其次是通过计算在布朗路径上求值的初始数据的期望。确认两种方法得到完全相同的结果，不仅有力地验证了费曼-卡兹表示的正确性，也加深了您对为何随机过程的转移密度函数正是其对应PDE的基本解（或核）的理解。[@problem_id:3070547]", "problem": "考虑一维标准布朗运动 $B_{t}$ 和从 $X_{0} = x \\in \\mathbb{R}$ 开始的简单扩散 $X_{t} = x + B_{t}$。设 $u(t,x)$ 是抛物型偏微分方程 (PDE) 初值问题的解\n$$\n\\frac{\\partial}{\\partial t} u(t,x) = \\frac{1}{2} \\frac{\\partial^{2}}{\\partial x^{2}} u(t,x), \\quad u(0,x) = f(x),\n$$\n其中初始数据为\n$$\nf(y) = \\exp\\!\\big(-\\alpha y^{2} + \\beta y\\big),\n$$\n其中 $\\alpha  0$ 且 $\\beta \\in \\mathbb{R}$。$X_{t}$ 的转移概率密度 $p(t,x,y)$ 为\n$$\np(t,x,y) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\!\\left(-\\frac{(y-x)^{2}}{2t}\\right), \\quad t0.\n$$\n\n从关于布朗运动和热核的基本事实出发，并且不使用任何关于 $u$ 的预先给出的解公式，完成以下任务：\n\n1. 对于 $t0$ 和 $x \\in \\mathbb{R}$，通过将初始数据 $f$ 对转移密度 $p$ 进行积分来计算 $u(t,x)$，即：\n$$\nu(t,x) = \\int_{\\mathbb{R}} f(y)\\, p(t,x,y)\\, \\mathrm{d}y.\n$$\n将您的最终结果表示为关于 $t$、$x$、$\\alpha$ 和 $\\beta$ 的单一闭式解析表达式。\n\n2. 使用抛物型偏微分方程的概率表示，验证相同的 $u(t,x)$ 可以写为期望\n$$\nu(t,x) = \\mathbb{E}\\!\\left[f(X_{t})\\right],\n$$\n并直接计算该期望，以获得与第1部分中找到的相同的闭式表达式。\n\n你的最终答案必须是 $u(t,x)$ 的一个单一解析表达式，不带单位。不需要进行数值舍入。", "solution": "该问题被验证为自洽的，科学上基于随机微分方程和抛物型偏微分方程理论，并且是适定的。初始数据是一个光滑函数，确保了热方程解的存在性和唯一性。这些任务在数学上是严谨的，不包含任何不一致或模糊之处。\n\n解将按照问题陈述的要求分两部分推导。\n\n第1部分：通过卷积分计算\n\n初值问题的解 $u(t,x)$ 由初始数据 $f(x)$ 与热核的卷积给出，热核是潜在随机过程 $X_t = x+B_t$ 的转移概率密度 $p(t,x,y)$。公式为：\n$$\nu(t,x) = \\int_{-\\infty}^{\\infty} f(y)\\, p(t,x,y)\\, \\mathrm{d}y\n$$\n代入给定的 $f(y)$ 和 $p(t,x,y)$ 表达式：\n$$\nf(y) = \\exp(-\\alpha y^{2} + \\beta y)\n$$\n$$\np(t,x,y) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(y-x)^{2}}{2t}\\right)\n$$\n$u(t,x)$ 的积分变为：\n$$\nu(t,x) = \\int_{-\\infty}^{\\infty} \\exp(-\\alpha y^{2} + \\beta y) \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(y-x)^{2}}{2t}\\right) \\mathrm{d}y\n$$\n我们可以合并指数函数的自变量：\n$$\n-\\alpha y^{2} + \\beta y - \\frac{(y-x)^{2}}{2t} = -\\alpha y^{2} + \\beta y - \\frac{y^2 - 2xy + x^2}{2t}\n$$\n按 $y$ 的幂次对各项进行分组：\n$$\n= -\\left(\\alpha + \\frac{1}{2t}\\right)y^2 + \\left(\\beta + \\frac{2x}{2t}\\right)y - \\frac{x^2}{2t}\n$$\n$$\n= -\\left(\\frac{2t\\alpha + 1}{2t}\\right)y^2 + \\left(\\frac{t\\beta + x}{t}\\right)y - \\frac{x^2}{2t}\n$$\n为了计算该积分，我们对包含 $y$ 的项进行配方。设指数写为 $-A y^2 + B y + C$，其中：\n$$\nA = \\frac{2t\\alpha + 1}{2t}, \\quad B = \\frac{t\\beta + x}{t}, \\quad C = -\\frac{x^2}{2t}\n$$\n表达式 $-A y^2 + B y$ 可以重写为：\n$$\n-A\\left(y^2 - \\frac{B}{A}y\\right) = -A\\left(\\left(y - \\frac{B}{2A}\\right)^2 - \\frac{B^2}{4A^2}\\right) = -A\\left(y - \\frac{B}{2A}\\right)^2 + \\frac{B^2}{4A}\n$$\n所以完整的指数是 $-A\\left(y - \\frac{B}{2A}\\right)^2 + \\frac{B^2}{4A} + C$。积分变为：\n$$\nu(t,x) = \\frac{1}{\\sqrt{2\\pi t}} \\int_{-\\infty}^{\\infty} \\exp\\left(-A\\left(y - \\frac{B}{2A}\\right)^2 + \\frac{B^2}{4A} + C\\right) \\mathrm{d}y\n$$\n项 $\\exp\\left(\\frac{B^2}{4A} + C\\right)$ 关于 $y$ 是常数，可以移到积分符号外：\n$$\nu(t,x) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(\\frac{B^2}{4A} + C\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-A\\left(y - \\frac{B}{2A}\\right)^2\\right) \\mathrm{d}y\n$$\n该积分为标准高斯积分形式 $\\int_{-\\infty}^{\\infty} \\exp(-A z^2) \\mathrm{d}z = \\sqrt{\\frac{\\pi}{A}}$，其中 $A  0$。此处 $A = \\frac{1+2t\\alpha}{2t}  0$ 因为 $t0$ 且 $\\alpha0$。\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-A\\left(y - \\frac{B}{2A}\\right)^2\\right) \\mathrm{d}y = \\sqrt{\\frac{\\pi}{A}}\n$$\n将此结果代回 $u(t,x)$ 的表达式中：\n$$\nu(t,x) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(\\frac{B^2}{4A} + C\\right) \\sqrt{\\frac{\\pi}{A}} = \\frac{1}{\\sqrt{2tA}} \\exp\\left(\\frac{B^2}{4A} + C\\right)\n$$\n现在，我们代入 $A$、$B$ 和 $C$ 的表达式。\n首先，是前置因子：\n$$\n\\frac{1}{\\sqrt{2tA}} = \\frac{1}{\\sqrt{2t \\left(\\frac{1+2t\\alpha}{2t}\\right)}} = \\frac{1}{\\sqrt{1+2t\\alpha}}\n$$\n接下来，是指数的自变量 $\\frac{B^2}{4A} + C$：\n$$\nB^2 = \\left(\\frac{t\\beta + x}{t}\\right)^2 = \\frac{t^2\\beta^2 + 2t\\beta x + x^2}{t^2}\n$$\n$$\n4A = 4\\left(\\frac{1+2t\\alpha}{2t}\\right) = \\frac{2(1+2t\\alpha)}{t}\n$$\n$$\n\\frac{B^2}{4A} = \\frac{t^2\\beta^2 + 2t\\beta x + x^2}{t^2} \\cdot \\frac{t}{2(1+2t\\alpha)} = \\frac{t^2\\beta^2 + 2t\\beta x + x^2}{2t(1+2t\\alpha)}\n$$\n现在加上 $C = -\\frac{x^2}{2t}$：\n$$\n\\frac{B^2}{4A} + C = \\frac{t^2\\beta^2 + 2t\\beta x + x^2}{2t(1+2t\\alpha)} - \\frac{x^2}{2t} = \\frac{t^2\\beta^2 + 2t\\beta x + x^2 - x^2(1+2t\\alpha)}{2t(1+2t\\alpha)}\n$$\n$$\n= \\frac{t^2\\beta^2 + 2t\\beta x + x^2 - x^2 - 2t\\alpha x^2}{2t(1+2t\\alpha)} = \\frac{t^2\\beta^2 + 2t\\beta x - 2t\\alpha x^2}{2t(1+2t\\alpha)}\n$$\n分子分母同除以 $t$（因为 $t0$）：\n$$\n= \\frac{t\\beta^2 + 2\\beta x - 2\\alpha x^2}{2(1+2t\\alpha)}\n$$\n结合前置因子和指数部分，我们得到解：\n$$\nu(t,x) = \\frac{1}{\\sqrt{1+2t\\alpha}} \\exp\\left(\\frac{t\\beta^2 + 2\\beta x - 2\\alpha x^2}{2(1+2t\\alpha)}\\right)\n$$\n\n第2部分：通过概率表示法计算\n\nFeynman-Kac 公式为该抛物型偏微分方程的解提供了一个概率表示：\n$$\nu(t,x) = \\mathbb{E}\\left[f(X_t) \\mid X_0 = x\\right]\n$$\n给定 $X_t = x + B_t$，其中 $B_t$ 是一维标准布朗运动，我们有 $X_t \\sim N(x, t)$。我们需要计算：\n$$\nu(t,x) = \\mathbb{E}\\left[ \\exp(-\\alpha X_t^2 + \\beta X_t) \\right]\n$$\n代入 $X_t = x + B_t$：\n$$\nu(t,x) = \\mathbb{E}\\left[ \\exp(-\\alpha (x+B_t)^2 + \\beta (x+B_t)) \\right]\n$$\n让我们展开指数的自变量：\n$$\n-\\alpha(x^2 + 2xB_t + B_t^2) + \\beta(x+B_t) = -\\alpha x^2 - 2\\alpha x B_t - \\alpha B_t^2 + \\beta x + \\beta B_t\n$$\n$$\n= (-\\alpha x^2 + \\beta x) + (\\beta - 2\\alpha x)B_t - \\alpha B_t^2\n$$\n项 $(-\\alpha x^2 + \\beta x)$ 是确定性的，可以从期望中提出：\n$$\nu(t,x) = \\exp(-\\alpha x^2 + \\beta x) \\, \\mathbb{E}\\left[ \\exp((\\beta - 2\\alpha x)B_t - \\alpha B_t^2) \\right]\n$$\n我们来计算这个期望。随机变量 $B_t$ 服从均值为 0、方差为 $t$ 的正态分布，因此其概率密度函数为 $\\phi(z; t) = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{z^2}{2t}\\right)$。该期望由以下积分给出：\n$$\n\\mathbb{E}[\\dots] = \\int_{-\\infty}^{\\infty} \\exp((\\beta - 2\\alpha x)z - \\alpha z^2) \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{z^2}{2t}\\right) \\mathrm{d}z\n$$\n我们合并指数部分：\n$$\n(\\beta - 2\\alpha x)z - \\alpha z^2 - \\frac{z^2}{2t} = - \\left(\\alpha + \\frac{1}{2t}\\right)z^2 + (\\beta - 2\\alpha x)z\n$$\n这又是另一个高斯积分。设指数为 $-A'z^2 + B'z$，其中：\n$$\nA' = \\alpha + \\frac{1}{2t} = \\frac{1+2t\\alpha}{2t}, \\quad B' = \\beta - 2\\alpha x\n$$\n配方：$-A'(z^2 - \\frac{B'}{A'}z) = -A'\\left(z - \\frac{B'}{2A'}\\right)^2 + \\frac{(B')^2}{4A'}$。\n期望的积分变为：\n$$\n\\frac{1}{\\sqrt{2\\pi t}} \\int_{-\\infty}^{\\infty} \\exp\\left(-A'\\left(z - \\frac{B'}{2A'}\\right)^2 + \\frac{(B')^2}{4A'}\\right) \\mathrm{d}z\n$$\n$$\n= \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(\\frac{(B')^2}{4A'}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-A'\\left(z - \\frac{B'}{2A'}\\right)^2\\right) \\mathrm{d}z\n$$\n该积分的值为 $\\sqrt{\\pi/A'}$。因此，期望为：\n$$\n\\mathbb{E}[\\dots] = \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(\\frac{(B')^2}{4A'}\\right) \\sqrt{\\frac{\\pi}{A'}} = \\frac{1}{\\sqrt{2tA'}} \\exp\\left(\\frac{(B')^2}{4A'}\\right)\n$$\n代回 $A'$ 和 $B'$。前置因子是：\n$$\n\\frac{1}{\\sqrt{2tA'}} = \\frac{1}{\\sqrt{2t\\left(\\frac{1+2t\\alpha}{2t}\\right)}} = \\frac{1}{\\sqrt{1+2t\\alpha}}\n$$\n指数的自变量是：\n$$\n\\frac{(B')^2}{4A'} = \\frac{(\\beta-2\\alpha x)^2}{4\\left(\\frac{1+2t\\alpha}{2t}\\right)} = \\frac{t(\\beta-2\\alpha x)^2}{2(1+2t\\alpha)} = \\frac{t(\\beta^2 - 4\\alpha\\beta x + 4\\alpha^2 x^2)}{2(1+2t\\alpha)}\n$$\n所以期望是：\n$$\n\\mathbb{E}[\\dots] = \\frac{1}{\\sqrt{1+2t\\alpha}} \\exp\\left(\\frac{t\\beta^2 - 4t\\alpha\\beta x + 4t\\alpha^2 x^2}{2(1+2t\\alpha)}\\right)\n$$\n最后，我们乘以之前提出的确定性项：\n$$\nu(t,x) = \\exp(-\\alpha x^2 + \\beta x) \\cdot \\frac{1}{\\sqrt{1+2t\\alpha}} \\exp\\left(\\frac{t\\beta^2 - 4t\\alpha\\beta x + 4t\\alpha^2 x^2}{2(1+2t\\alpha)}\\right)\n$$\n$$\nu(t,x) = \\frac{1}{\\sqrt{1+2t\\alpha}} \\exp\\left(-\\alpha x^2 + \\beta x + \\frac{t\\beta^2 - 4t\\alpha\\beta x + 4t\\alpha^2 x^2}{2(1+2t\\alpha)}\\right)\n$$\n我们通过找到公分母 $2(1+2t\\alpha)$ 来合并指数：\n$$\n\\text{Exponent} = \\frac{(-\\alpha x^2 + \\beta x) \\cdot 2(1+2t\\alpha) + t\\beta^2 - 4t\\alpha\\beta x + 4t\\alpha^2 x^2}{2(1+2t\\alpha)}\n$$\n$$\n= \\frac{-2\\alpha x^2 - 4t\\alpha^2 x^2 + 2\\beta x + 4t\\alpha\\beta x + t\\beta^2 - 4t\\alpha\\beta x + 4t\\alpha^2 x^2}{2(1+2t\\alpha)}\n$$\n$$\n= \\frac{-2\\alpha x^2 + 2\\beta x + t\\beta^2}{2(1+2t\\alpha)}\n$$\n$u(t,x)$ 的最终表达式是：\n$$\nu(t,x) = \\frac{1}{\\sqrt{1+2t\\alpha}} \\exp\\left(\\frac{t\\beta^2 + 2\\beta x - 2\\alpha x^2}{2(1+2t\\alpha)}\\right)\n$$\n此结果与第1部分中获得的结果完全相同，验证了两种方法的一致性。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{1+2t\\alpha}}\\exp\\left(\\frac{t\\beta^2 + 2\\beta x - 2\\alpha x^2}{2(1+2t\\alpha)}\\right)}$$", "id": "3070547"}]}