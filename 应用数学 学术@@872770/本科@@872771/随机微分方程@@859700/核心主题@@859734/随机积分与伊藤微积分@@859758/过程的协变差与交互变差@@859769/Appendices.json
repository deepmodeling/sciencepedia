{"hands_on_practices": [{"introduction": "在伊藤微积分中，一个核心的计算法则是关于随机积分的二次变分。本练习将引导你推导一个由伊藤积分定义的连续鞅的二次变分公式 [@problem_id:3047526]。通过证明 $M_t^2 - [M]_t$ 是一个鞅，并巧妙运用伊藤等距定理，你将深入理解二次变分作为“补偿项”的本质，并掌握将抽象定义转化为具体计算的关键技巧。", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\geq 0},\\mathbb{P})$ 是一个支撑标准布朗运动 $W=(W_t)_{t\\geq 0}$ 的过滤概率空间。设 $\\phi=(\\phi_t)_{t\\in[0,T]}$ 是一个 $(\\mathcal{F}_t)$-循序可测过程，满足对于某个固定的 $T>0$，有 $\\mathbb{E}\\!\\left[\\int_0^T \\phi_s^2\\,ds\\right]  \\infty$。定义连续局部鞅 $M=(M_t)_{t\\in[0,T]}$ 为\n$$\nM_t \\;=\\; \\int_0^t \\phi_s\\,dW_s,\\qquad t\\in[0,T].\n$$\n从连续局部鞅的二次变差的定义出发，即二次变差是唯一的适应递增过程 $[M]=( [M]_t )_{t\\in[0,T]}$，满足 $[M]_0=0$ 且 $M_t^2 - [M]_t$ 是一个鞅，并且只使用关于 Itô 积分的基础性结论，推导 $[M]_t$ 关于 $\\phi$ 和 $t$ 的显式表达式。在推导过程中，解释 Itô 等距定理在识别和验证你的表达式时所起的作用。将你的最终结果以 $\\phi$ 和 $t$ 的单一闭式解析表达式形式给出。无需进行数值舍入。", "solution": "该问题要求推导由 Itô 积分 $M_t = \\int_0^t \\phi_s\\,dW_s$ 定义的连续局部鞅 $M_t$ 的二次变差 $[M]_t$。推导必须基于二次变差的定义，即 $[M]_t$ 是唯一的、可预测的、递增的过程，满足 $[M]_0=0$ 且 $M_t^2 - [M]_t$ 是一个局部鞅。\n\n首先，我们分析过程 $M_t$ 的性质。问题陈述 $\\phi_t$ 是一个循序可测过程，满足条件 $\\mathbb{E}\\left[\\int_0^T \\phi_s^2\\,ds\\right]  \\infty$。此条件意味着 Itô 积分 $M_t = \\int_0^t \\phi_s\\,dW_s$ 不仅是一个连续局部鞅，而且是区间 $[0,T]$ 上的一个真正的平方可积鞅。这简化了我们的分析，因为我们不需要使用停时进行局部化论证。因此，我们需要找到唯一的适应递增过程 $[M]_t$，满足 $[M]_0=0$ 且 $M_t^2 - [M]_t$ 是一个真鞅。\n\n让我们为二次变差过程提出了一个候选。Itô 微积分的一个基础性结论表明，$M_t$ 的二次变差与被积函数 $\\phi_s$ 平方的积分有关。因此，我们推测二次变差由过程 $A_t$ 给出，定义为：\n$$\nA_t = \\int_0^t \\phi_s^2\\,ds\n$$\n为验证此推测，我们必须检验 $A_t$ 是否满足 $[M]_t$ 定义中规定的所有性质。\n\n1.  **初始条件：** 当 $t=0$ 时，我们有 $A_0 = \\int_0^0 \\phi_s^2\\,ds = 0$。此条件满足。\n\n2.  **适应性和递增性：** 过程 $\\phi_s$ 被给定为循序可测的，这意味着它对过滤 $(\\mathcal{F}_s)$ 是适应的。因此，过程 $\\phi_s^2$ 也是适应的。积分 $A_t = \\int_0^t \\phi_s^2\\,ds$ 是一个在时间 $t$ 的值依赖于 $\\phi$ 直到时间 $t$ 的路径的过程，因此是适应的。此外，由于对所有 $s$ 都有 $\\phi_s^2 \\ge 0$，积分 $A_t$ 对于任何样本路径都是 $t$ 的一个非减函数。用随机过程的语言来说，它是一个递增过程。\n\n3.  **鞅性质：** 核心任务是证明过程 $X_t = M_t^2 - A_t$ 是一个鞅。为此，我们必须证明对于任何 $s  t$ 且 $s,t \\in [0,T]$，我们有 $\\mathbb{E}[X_t | \\mathcal{F}_s] = X_s$。\n\n让我们计算 $X_t$ 的条件期望：\n$$\n\\mathbb{E}[X_t | \\mathcal{F}_s] = \\mathbb{E}[M_t^2 - A_t | \\mathcal{F}_s] = \\mathbb{E}[M_t^2 | \\mathcal{F}_s] - \\mathbb{E}[A_t | \\mathcal{F}_s]\n$$\n我们分别分析每一项。对于第一项，我们将 $M_t$ 表示为 $M_s$ 和从 $s$ 到 $t$ 的增量的形式：\n$$\nM_t = M_s + (M_t - M_s) = M_s + \\int_s^t \\phi_u\\,dW_u\n$$\n将此表达式平方可得：\n$$\nM_t^2 = M_s^2 + 2M_s(M_t - M_s) + (M_t - M_s)^2\n$$\n现在，我们取关于 $\\mathcal{F}_s$ 的条件期望：\n$$\n\\mathbb{E}[M_t^2 | \\mathcal{F}_s] = \\mathbb{E}[M_s^2 | \\mathcal{F}_s] + 2\\mathbb{E}[M_s(M_t - M_s) | \\mathcal{F}_s] + \\mathbb{E}[(M_t - M_s)^2 | \\mathcal{F}_s]\n$$\n由于 $M_s$ 是 $\\mathcal{F}_s$-可测的，我们可以将其从条件期望中提出：\n- $\\mathbb{E}[M_s^2 | \\mathcal{F}_s] = M_s^2$。\n- $2\\mathbb{E}[M_s(M_t - M_s) | \\mathcal{F}_s] = 2M_s \\mathbb{E}[M_t - M_s | \\mathcal{F}_s]$。由于 $M_t$ 是一个鞅，$\\mathbb{E}[M_t | \\mathcal{F}_s] = M_s$，这意味着 $\\mathbb{E}[M_t - M_s | \\mathcal{F}_s] = 0$。因此，这一项为零。\n\n第三项需要计算一个随机积分的条件二阶矩。这正是 **Itô 等距定理** 发挥其关键作用的地方。Itô 等距定理的条件形式陈述为，对于一个适应的被积函数 $\\phi_u$：\n$$\n\\mathbb{E}\\left[ \\left(\\int_s^t \\phi_u\\,dW_u\\right)^2 \\bigg| \\mathcal{F}_s \\right] = \\mathbb{E}\\left[ \\int_s^t \\phi_u^2\\,du \\bigg| \\mathcal{F}_s \\right]\n$$\n将此应用于我们的项 $(M_t - M_s)^2 = (\\int_s^t \\phi_u\\,dW_u)^2$，我们得到：\n$$\n\\mathbb{E}[(M_t - M_s)^2 | \\mathcal{F}_s] = \\mathbb{E}\\left[ \\int_s^t \\phi_u^2\\,du \\bigg| \\mathcal{F}_s \\right]\n$$\n结合这些结果，$M_t^2$ 的条件期望变为：\n$$\n\\mathbb{E}[M_t^2 | \\mathcal{F}_s] = M_s^2 + \\mathbb{E}\\left[ \\int_s^t \\phi_u^2\\,du \\bigg| \\mathcal{F}_s \\right]\n$$\n现在我们分析原始表达式的第二部分，$\\mathbb{E}[A_t | \\mathcal{F}_s]$。我们将 $A_t$ 的积分拆分：\n$$\nA_t = \\int_0^t \\phi_u^2\\,du = \\int_0^s \\phi_u^2\\,du + \\int_s^t \\phi_u^2\\,du = A_s + \\int_s^t \\phi_u^2\\,du\n$$\n取条件期望：\n$$\n\\mathbb{E}[A_t | \\mathcal{F}_s] = \\mathbb{E}[A_s | \\mathcal{F}_s] + \\mathbb{E}\\left[ \\int_s^t \\phi_u^2\\,du \\bigg| \\mathcal{F}_s \\right]\n$$\n由于 $A_s = \\int_0^s \\phi_u^2\\,du$ 由过程 $\\phi$ 直到时间 $s$ 的历史所决定，它是 $\\mathcal{F}_s$-可测的。因此，$\\mathbb{E}[A_s | \\mathcal{F}_s] = A_s$。这给出：\n$$\n\\mathbb{E}[A_t | \\mathcal{F}_s] = A_s + \\mathbb{E}\\left[ \\int_s^t \\phi_u^2\\,du \\bigg| \\mathcal{F}_s \\right]\n$$\n最后，我们将关于 $\\mathbb{E}[M_t^2 | \\mathcal{F}_s]$ 和 $\\mathbb{E}[A_t | \\mathcal{F}_s]$ 的结果代回到 $\\mathbb{E}[X_t | \\mathcal{F}_s]$ 的表达式中：\n$$\n\\mathbb{E}[X_t | \\mathcal{F}_s] = \\left( M_s^2 + \\mathbb{E}\\left[ \\int_s^t \\phi_u^2\\,du \\bigg| \\mathcal{F}_s \\right] \\right) - \\left( A_s + \\mathbb{E}\\left[ \\int_s^t \\phi_u^2\\,du \\bigg| \\mathcal{F}_s \\right] \\right)\n$$\n条件期望项相互抵消，剩下：\n$$\n\\mathbb{E}[X_t | \\mathcal{F}_s] = M_s^2 - A_s = X_s\n$$\n这证实了 $X_t = M_t^2 - A_t$ 是一个鞅。\n\n由于我们的候选过程 $A_t = \\int_0^t \\phi_s^2\\,ds$ 满足所有要求的性质——它是适应的、递增的、从零开始，并使 $M_t^2 - A_t$ 成为一个鞅——根据问题中陈述的唯一性，它必定是 $M_t$ 的二次变差。\n\nItô 等距定理在此推导中起着核心且不可或缺的作用。它提供了鞅增量的方差与被积函数平方的积分之间的定量联系。具体来说，条件等距定理使我们能够精确计算 $\\mathbb{E}[(M_t-M_s)^2|\\mathcal{F}_s]$，并证明它在期望意义上被过程 $\\int_0^t \\phi_s^2\\,ds$ 的增量所补偿。这证实了 $\\int_0^t \\phi_s^2\\,ds$ 是使 $M_t^2$ 成为鞅所需的正确补偿过程，从而将其确定为二次变差。\n\n因此，$[M]_t$ 的显式表达式为：\n$$\n[M]_t = \\int_0^t \\phi_s^2\\,ds\n$$", "answer": "$$\\boxed{\\int_0^t \\phi_s^2\\,ds}$$", "id": "3047526"}, {"introduction": "在掌握了单个过程的二次变分后，我们自然会想知道两个随机过程如何协同变化。这个练习 [@problem_id:3047541] 探讨了协变分的概念，它是衡量两个过程同步波动性的关键。你将通过计算两个由共同和独立噪声驱动的半鞅的变分，并利用极化恒等式来推导它们的协变分，这不仅加深了对二次变分双线性的理解，也为处理多维随机系统奠定了基础。", "problem": "设 $W_t$ 和 $\\widetilde{W}_t$ 为在满足一般条件的带滤概率空间上的两个独立标准布朗运动，并设 $X_t$ 和 $Y_t$ 为定义为以下常系数随机微分方程（SDE）解的连续半鞅：\n$$\n\\mathrm{d}X_t = \\alpha\\,\\mathrm{d}t + \\sigma_1\\,\\mathrm{d}W_t + \\sigma_2\\,\\mathrm{d}\\widetilde{W}_t,\\qquad X_0 = 0,\n$$\n$$\n\\mathrm{d}Y_t = \\beta\\,\\mathrm{d}t + \\tau_1\\,\\mathrm{d}W_t + \\tau_2\\,\\mathrm{d}\\widetilde{W}_t,\\qquad Y_0 = 0,\n$$\n其中 $\\alpha,\\beta,\\sigma_1,\\sigma_2,\\tau_1,\\tau_2 \\in \\mathbb{R}$ 是固定常数。仅使用连续半鞅的二次变差和协变差的基本定义（作为分割和的极限），完成以下任务：\n\n1. 从基于分割的定义出发，证明为何有限变差项对二次变差没有贡献，并计算 $[X]_t$ 和 $[Y]_t$。\n\n2. 再次使用基于分割的定义，根据 $X_t$ 和 $Y_t$ 的动态特性直接计算 $[X+Y]_t$ 和 $[X-Y]_t$。\n\n3. 依据定义和您的计算，验证恒等式 $[X,X]_t = [X]_t$。\n\n4. 仅使用对上述所求量的代数运算以及步骤3中的恒等式，推导协变差 $[X,Y]_t$ 的两个不同表达式（用和与差的二次变差表示），并检查它们是否一致。\n\n最后，对于一个固定的时间 $T0$，提供用 $\\sigma_1,\\sigma_2,\\tau_1,\\tau_2$ 和 $T$ 表示的 $[X,Y]_T$ 的闭式表达式。您的最终答案必须是单一的解析表达式。无需四舍五入，不涉及单位。", "solution": "该问题定义明确，科学上合理，并提供了所有必要信息。我们将基于连续半鞅的二次变差和协变差的基本定义，给出一个严谨的解。\n\n对于一个连续半鞅 $Z_t$，其在区间 $[0,t]$ 上的二次变差 $[Z]_t$ 定义为，当分割 $\\Pi = \\{0 = t_0  t_1  \\dots  t_n = t\\}$ 的网格 $|\\Pi| = \\max_i(t_{i+1}-t_i)$ 趋于零时，增量平方和的依概率极限：\n$$[Z]_t = \\lim_{|\\Pi| \\to 0} \\sum_{i=0}^{n-1} (Z_{t_{i+1}} - Z_{t_i})^2$$\n对于两个连续半鞅 $X_t$ 和 $Y_t$，它们的协变差 $[X,Y]_t$ 定义为：\n$$[X,Y]_t = \\lim_{|\\Pi| \\to 0} \\sum_{i=0}^{n-1} (X_{t_{i+1}} - X_{t_i})(Y_{t_{i+1}} - Y_{t_i})$$\n\n过程 $X_t$ 和 $Y_t$ 以积分形式给出：\n$$X_t = X_0 + \\int_0^t \\alpha\\,\\mathrm{d}s + \\int_0^t \\sigma_1\\,\\mathrm{d}W_s + \\int_0^t \\sigma_2\\,\\mathrm{d}\\widetilde{W}_s = \\alpha t + \\sigma_1 W_t + \\sigma_2 \\widetilde{W}_t$$\n$$Y_t = Y_0 + \\int_0^t \\beta\\,\\mathrm{d}s + \\int_0^t \\tau_1\\,\\mathrm{d}W_s + \\int_0^t \\tau_2\\,\\mathrm{d}\\widetilde{W}_s = \\beta t + \\tau_1 W_t + \\tau_2 \\widetilde{W}_t$$\n我们可以将 $X_t$ 分解为一个有限变差过程 $A_t = \\alpha t$ 和一个连续鞅 $M_t = \\sigma_1 W_t + \\sigma_2 \\widetilde{W}_t$。因此，$X_t = A_t + M_t$。类似地，$Y_t = B_t + N_t$，其中 $B_t = \\beta t$，$N_t = \\tau_1 W_t + \\tau_2 \\widetilde{W}_t$。\n\n1. 我们首先证明为何有限变差项对二次变差没有贡献，然后计算 $[X]_t$ 和 $[Y]_t$。\n$X_t$ 在子区间 $[t_i, t_{i+1}]$ 上的增量为 $\\Delta X_{t_i} = X_{t_{i+1}} - X_{t_i} = \\Delta A_{t_i} + \\Delta M_{t_i}$。增量的平方和为：\n$$\\sum_{i=0}^{n-1} (\\Delta X_{t_i})^2 = \\sum_{i=0}^{n-1} (\\Delta A_{t_i} + \\Delta M_{t_i})^2 = \\sum_{i=0}^{n-1} (\\Delta A_{t_i})^2 + 2\\sum_{i=0}^{n-1} \\Delta A_{t_i} \\Delta M_{t_i} + \\sum_{i=0}^{n-1} (\\Delta M_{t_i})^2$$\n让我们分析在极限 $|\\Pi| \\to 0$ 下的每一项。\n第一项涉及有限变差部分 $A_t = \\alpha t$。其增量为 $\\Delta A_{t_i} = \\alpha (t_{i+1}-t_i)$。平方和为：\n$$\\sum_{i=0}^{n-1} (\\Delta A_{t_i})^2 = \\sum_{i=0}^{n-1} \\alpha^2 (t_{i+1}-t_i)^2 \\leq \\alpha^2 \\max_i(t_{i+1}-t_i) \\sum_{i=0}^{n-1} (t_{i+1}-t_i) = \\alpha^2 t |\\Pi|$$\n当 $|\\Pi| \\to 0$ 时，此项收敛到 $0$。一个二次变差为零的过程是一个有限变差过程。这表明作为有限变差过程的漂移项，对二次变差没有贡献。\n\n第二项是交叉项。它依概率收敛于 $2[A,M]_t$。由于 $A_t$ 是有限变差的连续过程，而 $M_t$ 是连续鞅，它们的协变差 $[A,M]_t$ 为零。这可以通过检验和 $S_n = \\sum_{i=0}^{n-1} \\Delta A_{t_i} \\Delta M_{t_i}$ 的 $L^2$-极限来严格证明。期望为 $E[S_n]=0$，其方差为 $E[S_n^2] = \\alpha^2 E\\left[\\left(\\sum_{i=0}^{n-1} (t_{i+1}-t_i) \\Delta M_{t_i}\\right)^2\\right] = \\alpha^2 \\sum_{i=0}^{n-1} (t_{i+1}-t_i)^2 E[(\\Delta M_{t_i})^2]$。我们有 $E[(\\Delta M_{t_i})^2] = (\\sigma_1^2 + \\sigma_2^2)(t_{i+1}-t_i)$。因此，$E[S_n^2] = \\alpha^2(\\sigma_1^2+\\sigma_2^2) \\sum (t_{i+1}-t_i)^3 \\leq \\alpha^2(\\sigma_1^2+\\sigma_2^2) |\\Pi| \\sum (t_{i+1}-t_i)^2 \\leq \\alpha^2(\\sigma_1^2+\\sigma_2^2) |\\Pi|^2 t \\to 0$。由于 $S_n$ 在 $L^2$ 中收敛于 $0$，它也依概率收敛于 $0$。\n\n因此，$[X]_t = \\lim_{|\\Pi| \\to 0} \\sum_{i=0}^{n-1} (\\Delta M_{t_i})^2 = [M]_t$。我们现在来计算它。\n$\\Delta M_{t_i} = \\sigma_1 \\Delta W_{t_i} + \\sigma_2 \\Delta \\widetilde{W}_{t_i}$，其中 $\\Delta W_{t_i} = W_{t_{i+1}} - W_{t_i}$ 且 $\\Delta \\widetilde{W}_{t_i} = \\widetilde{W}_{t_{i+1}} - \\widetilde{W}_{t_i}$。\n$$[M]_t = \\lim_{|\\Pi|\\to 0} \\sum_{i=0}^{n-1} (\\sigma_1 \\Delta W_{t_i} + \\sigma_2 \\Delta \\widetilde{W}_{t_i})^2$$\n$$= \\lim_{|\\Pi|\\to 0} \\sum_{i=0}^{n-1} \\left( \\sigma_1^2 (\\Delta W_{t_i})^2 + \\sigma_2^2 (\\Delta \\widetilde{W}_{t_i})^2 + 2\\sigma_1\\sigma_2 \\Delta W_{t_i} \\Delta \\widetilde{W}_{t_i} \\right)$$\n根据极限的线性性质，我们可以将各项分开：\n$$[M]_t = \\sigma_1^2 \\lim_{|\\Pi|\\to 0} \\sum (\\Delta W_{t_i})^2 + \\sigma_2^2 \\lim_{|\\Pi|\\to 0} \\sum (\\Delta \\widetilde W_{t_i})^2 + 2\\sigma_1\\sigma_2 \\lim_{|\\Pi|\\to 0} \\sum \\Delta W_{t_i} \\Delta \\widetilde W_{t_i}$$\n根据二次变差的定义，$\\lim \\sum (\\Delta W_{t_i})^2 = [W]_t = t$ 且 $\\lim \\sum (\\Delta \\widetilde{W}_{t_i})^2 = [\\widetilde{W}]_t = t$。交叉项的和收敛于协变差 $[W, \\widetilde{W}]_t$。由于 $W_t$ 和 $\\widetilde{W}_t$ 是独立的布朗运动，它们的协变差为零，即 $[W, \\widetilde{W}]_t=0$。\n因此，我们得到 $[X]_t = [M]_t = \\sigma_1^2 t + \\sigma_2^2 t + 0 = (\\sigma_1^2 + \\sigma_2^2)t$。\n对 $Y_t$ 进行完全相同的论证，其有限变差部分 $B_t=\\beta t$ 没有贡献，其二次变差由其鞅部分 $N_t = \\tau_1 W_t + \\tau_2 \\widetilde{W}_t$ 决定。\n$$[Y]_t = [N]_t = (\\tau_1^2 + \\tau_2^2)t$$\n\n2. 我们根据其动态特性计算 $[X+Y]_t$ 和 $[X-Y]_t$。\n$Z_t = X_t+Y_t$ 的SDE为：\n$$\\mathrm{d}Z_t = \\mathrm{d}X_t + \\mathrm{d}Y_t = (\\alpha+\\beta)\\mathrm{d}t + (\\sigma_1+\\tau_1)\\mathrm{d}W_t + (\\sigma_2+\\tau_2)\\mathrm{d}\\widetilde{W}_t$$\n这是一个形式相同的过程。漂移项 $(\\alpha+\\beta)t$ 是有限变差的，对 $[Z]_t$ 没有贡献。其鞅部分是 $(\\sigma_1+\\tau_1)W_t + (\\sigma_2+\\tau_2)\\widetilde{W}_t$。应用第1部分的结果，我们将 $\\sigma_1$ 替换为 $(\\sigma_1+\\tau_1)$，将 $\\sigma_2$ 替换为 $(\\sigma_2+\\tau_2)$：\n$$[X+Y]_t = [Z]_t = ((\\sigma_1+\\tau_1)^2 + (\\sigma_2+\\tau_2)^2)t$$\n类似地，对于 $U_t = X_t - Y_t$，其SDE为：\n$$\\mathrm{d}U_t = \\mathrm{d}X_t - \\mathrm{d}Y_t = (\\alpha-\\beta)\\mathrm{d}t + (\\sigma_1-\\tau_1)\\mathrm{d}W_t + (\\sigma_2-\\tau_2)\\mathrm{d}\\widetilde{W}_t$$\n有限变差项 $(\\alpha-\\beta)t$ 没有贡献。其鞅部分是 $(\\sigma_1-\\tau_1)W_t + (\\sigma_2-\\tau_2)\\widetilde{W}_t$。二次变差为：\n$$[X-Y]_t = [U]_t = ((\\sigma_1-\\tau_1)^2 + (\\sigma_2-\\tau_2)^2)t$$\n\n3. 我们验证恒等式 $[X,X]_t = [X]_t$。\n根据协变差的定义，令 $Y_t = X_t$：\n$$[X,X]_t = \\lim_{|\\Pi| \\to 0} \\sum_{i=0}^{n-1} (X_{t_{i+1}} - X_{t_i})(X_{t_{i+1}} - X_{t_i}) = \\lim_{|\\Pi| \\to 0} \\sum_{i=0}^{n-1} (X_{t_{i+1}} - X_{t_i})^2$$\n这正是二次变差 $[X]_t$ 的定义。因此，恒等式 $[X,X]_t = [X]_t$ 根据定义成立。我们在第1部分中对 $[X]_t$ 的计算也是对 $[X,X]_t$ 的计算，这证实了它们的相等性。\n\n4. 我们推导协变差 $[X,Y]_t$ 的两个不同表达式，并检查它们的一致性。\n协变差的定义是一个双线性形式。这个性质直接源于被加数的代数展开。对于 $[X+Y]_t$，我们有：\n$$[X+Y]_t = [X+Y, X+Y]_t = \\lim_{|\\Pi|\\to 0} \\sum_{i=0}^{n-1} (\\Delta X_{t_i} + \\Delta Y_{t_i})^2$$\n$$= \\lim_{|\\Pi|\\to 0} \\left( \\sum (\\Delta X_{t_i})^2 + \\sum (\\Delta Y_{t_i})^2 + 2\\sum \\Delta X_{t_i} \\Delta Y_{t_i} \\right)$$\n$$= [X]_t + [Y]_t + 2[X,Y]_t$$\n整理此方程得到协变差的第一个表达式：\n$$[X,Y]_t = \\frac{1}{2}\\left([X+Y]_t - [X]_t - [Y]_t\\right) \\quad (\\text{表达式 1})$$\n类似地，对于 $[X-Y]_t$：\n$$[X-Y]_t = [X-Y, X-Y]_t = [X]_t + [Y]_t - 2[X,Y]_t$$\n整理得到第二个表达式：\n$$[X,Y]_t = \\frac{1}{2}\\left([X]_t + [Y]_t - [X-Y]_t\\right) \\quad (\\text{表达式 2})$$\n这是 $[X,Y]_t$ 的两个不同表达式。我们现在通过代入第1和第2部分的结果来检查它们的一致性。\n\n使用表达式1：\n$$[X,Y]_t = \\frac{1}{2} \\left[ ((\\sigma_1+\\tau_1)^2 + (\\sigma_2+\\tau_2)^2)t - (\\sigma_1^2 + \\sigma_2^2)t - (\\tau_1^2 + \\tau_2^2)t \\right]$$\n$$= \\frac{t}{2} \\left[ (\\sigma_1^2+2\\sigma_1\\tau_1+\\tau_1^2 + \\sigma_2^2+2\\sigma_2\\tau_2+\\tau_2^2) - \\sigma_1^2 - \\sigma_2^2 - \\tau_1^2 - \\tau_2^2 \\right]$$\n$$= \\frac{t}{2} [2\\sigma_1\\tau_1 + 2\\sigma_2\\tau_2] = (\\sigma_1\\tau_1 + \\sigma_2\\tau_2)t$$\n\n使用表达式2：\n$$[X,Y]_t = \\frac{1}{2} \\left[ (\\sigma_1^2 + \\sigma_2^2)t + (\\tau_1^2 + \\tau_2^2)t - ((\\sigma_1-\\tau_1)^2 + (\\sigma_2-\\tau_2)^2)t \\right]$$\n$$= \\frac{t}{2} \\left[ \\sigma_1^2 + \\sigma_2^2 + \\tau_1^2 + \\tau_2^2 - (\\sigma_1^2-2\\sigma_1\\tau_1+\\tau_1^2 + \\sigma_2^2-2\\sigma_2\\tau_2+\\tau_2^2) \\right]$$\n$$= \\frac{t}{2} [2\\sigma_1\\tau_1 + 2\\sigma_2\\tau_2] = (\\sigma_1\\tau_1 + \\sigma_2\\tau_2)t$$\n两个表达式都得出相同的结果，证实了它们的一致性。这就是所求的极化恒等式。直接从其定义计算 $[X,Y]_t$ 也会得到这个结果。\n最后，我们提供在固定时间 $T>0$ 时 $[X,Y]_T$ 的闭式表达式。\n根据我们的推导，$[X,Y]_t = (\\sigma_1\\tau_1 + \\sigma_2\\tau_2)t$。令 $t=T$：\n$$[X,Y]_T = (\\sigma_1\\tau_1 + \\sigma_2\\tau_2)T$$", "answer": "$$\n\\boxed{(\\sigma_1\\tau_1 + \\sigma_2\\tau_2)T}\n$$", "id": "3047541"}, {"introduction": "理论概念只有在能够与实际数据联系起来时才显示出其全部力量。本练习将理论上的二次变分与实践中的“已实现方差”估计量联系起来 [@problem_id:3047531]。你将从布朗运动的基本性质出发，分析这个基于离散观测的估计量的统计特性，如期望和均方根误差，从而理解我们是如何从离散数据中估计连续时间模型的参数，并量化这种估计的收敛速度。", "problem": "设 $\\{W_{s}: s \\geq 0\\}$ 为一个标准布朗运动，其中 $W_{0} = 0$，具有独立增量，且对于 $0 \\leq s  u$，增量 $W_{u} - W_{s}$ 服从均值为 $0$、方差为 $u - s$ 的高斯分布。固定 $t > 0$，考虑 $[0,t]$ 上的一个有限分割 $\\Pi$，给定为 $0 = t_{0}  t_{1}  \\cdots  t_{n} = t$，其网格尺寸为 $|\\Pi| := \\max_{0 \\leq k \\leq n-1} (t_{k+1} - t_{k})$。定义已实现方差估计量\n$$\n\\operatorname{RV}(\\Pi) := \\sum_{k=0}^{n-1} \\big(W_{t_{k+1}} - W_{t_{k}}\\big)^{2}.\n$$\n仅从布朗运动的定义性质和高斯随机变量的基本矩恒等式出发，推导期望 $\\mathbb{E}[\\operatorname{RV}(\\Pi)]$ 和均方根误差 (Root Mean Squared Error, RMSE) $\\sqrt{\\mathbb{E}\\big[(\\operatorname{RV}(\\Pi) - t)^{2}\\big]}$，并用分割长度 $h_{k} := t_{k+1} - t_{k}$ 表示。利用这些结果确定当 $|\\Pi| \\to 0$ 时，$\\operatorname{RV}(\\Pi)$ 对 $t$ 的均方收敛速度，并给出一个以 $t$ 和 $|\\Pi|$ 表示的 RMSE 的显式上界。\n\n最后，将问题特化到 $[0,t]$ 上的一个包含 $n$ 个区间的等距分割，使得对所有 $k$ 都有 $h_{k} = \\Delta := t/n$，并确定作为 $\\Delta$ 的闭式函数的精确 RMSE。你的最终答案必须是这个关于 $t$ 和 $\\Delta$ 的符号表达式形式的精确 RMSE。", "solution": "问题陈述是随机微积分中的一个标准练习，涉及标准布朗运动的已实现方差的性质。所有定义和条件都是标准的且自洽的。该问题在数学上是适定的，在科学上基于随机过程理论，并且是客观陈述的。因此，该问题是有效的，我们可以进行求解。\n\n设 $\\{W_{s}: s \\geq 0\\}$ 为一个标准一维布朗运动。给定区间 $[0,t]$ 的一个分割 $0 = t_{0}  t_{1}  \\cdots  t_{n} = t$。令 $h_{k} := t_{k+1} - t_{k}$，其中 $k = 0, 1, \\ldots, n-1$。已实现方差估计量定义为：\n$$\n\\operatorname{RV}(\\Pi) := \\sum_{k=0}^{n-1} \\big(W_{t_{k+1}} - W_{t_{k}}\\big)^{2}\n$$\n我们记增量为 $\\Delta W_{k} := W_{t_{k+1}} - W_{t_{k}}$。根据标准布朗运动的定义，在区间 $[t_k, t_{k+1}]$ 上的增量 $\\Delta W_{k}$ 是一个高斯随机变量，其均值为 $0$，方差为 $t_{k+1} - t_{k} = h_k$。即 $\\Delta W_{k} \\sim \\mathcal{N}(0, h_{k})$。\n\n首先，我们计算已实现方差的期望 $\\mathbb{E}[\\operatorname{RV}(\\Pi)]$。\n根据期望的线性性，我们有：\n$$\n\\mathbb{E}[\\operatorname{RV}(\\Pi)] = \\mathbb{E}\\left[\\sum_{k=0}^{n-1} (\\Delta W_{k})^{2}\\right] = \\sum_{k=0}^{n-1} \\mathbb{E}\\left[(\\Delta W_{k})^{2}\\right]\n$$\n量 $\\mathbb{E}[(\\Delta W_{k})^{2}]$ 是随机变量 $\\Delta W_{k}$ 的二阶矩。对于任何均值为 $\\mathbb{E}[X]$、方差为 $\\operatorname{Var}(X)$ 的随机变量 $X$，其二阶矩由 $\\mathbb{E}[X^2] = \\operatorname{Var}(X) + (\\mathbb{E}[X])^2$ 给出。\n对于 $\\Delta W_{k} \\sim \\mathcal{N}(0, h_{k})$，我们有 $\\mathbb{E}[\\Delta W_{k}] = 0$ 和 $\\operatorname{Var}(\\Delta W_{k}) = h_{k}$。\n因此，二阶矩为：\n$$\n\\mathbb{E}\\left[(\\Delta W_{k})^{2}\\right] = h_{k} + (0)^2 = h_{k}\n$$\n将此结果代回 $\\operatorname{RV}(\\Pi)$ 的期望表达式中：\n$$\n\\mathbb{E}[\\operatorname{RV}(\\Pi)] = \\sum_{k=0}^{n-1} h_{k} = \\sum_{k=0}^{n-1} (t_{k+1} - t_{k}) = t_{n} - t_{0} = t - 0 = t\n$$\n这表明 $\\operatorname{RV}(\\Pi)$ 是 $t$ 的一个无偏估计量。\n\n接下来，我们计算均方根误差 (RMSE)，其定义为 $\\sqrt{\\mathbb{E}\\big[(\\operatorname{RV}(\\Pi) - t)^{2}\\big]}$。平方根内的项是均方误差 (MSE)。由于我们已经证明 $\\mathbb{E}[\\operatorname{RV}(\\Pi)] = t$，所以 MSE 等于 $\\operatorname{RV}(\\Pi)$ 的方差：\n$$\n\\text{MSE} = \\mathbb{E}\\big[(\\operatorname{RV}(\\Pi) - \\mathbb{E}[\\operatorname{RV}(\\Pi)])^{2}\\big] = \\operatorname{Var}(\\operatorname{RV}(\\Pi))\n$$\n$$\n\\operatorname{Var}(\\operatorname{RV}(\\Pi)) = \\operatorname{Var}\\left(\\sum_{k=0}^{n-1} (\\Delta W_{k})^{2}\\right)\n$$\n布朗运动的一个基本性质是其在不重叠时间区间上的增量是独立的。区间 $[t_k, t_{k+1}]$ (其中 $k=0, 1, \\ldots, n-1$) 是不重叠的。因此，随机变量 $\\Delta W_{0}, \\Delta W_{1}, \\ldots, \\Delta W_{n-1}$ 是相互独立的。因此，这些增量的任何函数，例如 $(\\Delta W_{k})^{2}$，也都是相互独立的。\n独立随机变量之和的方差等于它们各自方差之和：\n$$\n\\operatorname{Var}(\\operatorname{RV}(\\Pi)) = \\sum_{k=0}^{n-1} \\operatorname{Var}\\left((\\Delta W_{k})^{2}\\right)\n$$\n为了计算 $\\operatorname{Var}((\\Delta W_{k})^{2})$，我们使用公式 $\\operatorname{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$，其中 $Y = (\\Delta W_{k})^{2}$。\n$$\n\\operatorname{Var}\\left((\\Delta W_{k})^{2}\\right) = \\mathbb{E}\\left[\\left((\\Delta W_{k})^{2}\\right)^{2}\\right] - \\left(\\mathbb{E}\\left[(\\Delta W_{k})^{2}\\right]\\right)^{2} = \\mathbb{E}\\left[(\\Delta W_{k})^{4}\\right] - (h_{k})^2\n$$\n我们需要 $\\Delta W_{k} \\sim \\mathcal{N}(0, h_{k})$ 的四阶矩。一个一般的中心化高斯随机变量 $X \\sim \\mathcal{N}(0, \\sigma^2)$可以写成 $X = \\sigma Z$ 的形式，其中 $Z \\sim \\mathcal{N}(0, 1)$ 是一个标准正态变量。$X$ 的矩为 $\\mathbb{E}[X^p] = \\sigma^p \\mathbb{E}[Z^p]$。对于标准正态变量，其四阶矩为 $\\mathbb{E}[Z^4] = 3$。\n因此，对于 $\\Delta W_k \\sim \\mathcal{N}(0, h_k)$，我们有 $\\sigma^2 = h_k$，所以：\n$$\n\\mathbb{E}\\left[(\\Delta W_{k})^{4}\\right] = (h_k)^2 \\mathbb{E}[Z^4] = 3h_k^2\n$$\n现在，我们可以计算 $(\\Delta W_{k})^{2}$ 的方差：\n$$\n\\operatorname{Var}\\left((\\Delta W_{k})^{2}\\right) = 3h_k^2 - (h_k)^2 = 2h_k^2\n$$\n将此结果代回 MSE 的表达式中：\n$$\n\\text{MSE} = \\mathbb{E}\\big[(\\operatorname{RV}(\\Pi) - t)^{2}\\big] = \\sum_{k=0}^{n-1} 2h_k^2 = 2 \\sum_{k=0}^{n-1} h_k^2\n$$\nRMSE 是 MSE 的平方根：\n$$\n\\text{RMSE} = \\sqrt{2 \\sum_{k=0}^{n-1} h_k^2}\n$$\n为了分析收敛性，令 $|\\Pi| = \\max_{k} h_k$ 为分割的网格尺寸。我们可以对求和进行放缩：\n$$\n\\sum_{k=0}^{n-1} h_k^2 \\leq \\sum_{k=0}^{n-1} \\left(h_k \\cdot \\max_{j} h_j\\right) = |\\Pi| \\sum_{k=0}^{n-1} h_k = |\\Pi| \\cdot t\n$$\n因此，MSE 的上界为：\n$$\n\\mathbb{E}\\big[(\\operatorname{RV}(\\Pi) - t)^{2}\\big] \\leq 2t|\\Pi|\n$$\n当 $|\\Pi| \\to 0$ 时，MSE 趋近于 $0$，这证明了 $\\operatorname{RV}(\\Pi)$ 在均方意义下收敛到 $t$。MSE 的收敛速度是 $O(|\\Pi|)$ 阶的。RMSE 的一个显式上界是：\n$$\n\\text{RMSE} \\leq \\sqrt{2t|\\Pi|}\n$$\n这表明 RMSE 以 $O(\\sqrt{|\\Pi|})$ 的速度收敛到 $0$。\n\n最后，我们特化到一个等距分割，其中对所有 $k=0, \\ldots, n-1$，都有 $h_k = \\Delta$，且 $\\Delta = t/n$。\n我们使用 MSE 的精确表达式：\n$$\n\\text{MSE} = 2 \\sum_{k=0}^{n-1} h_k^2 = 2 \\sum_{k=0}^{n-1} \\Delta^2\n$$\n该求和中有 $n$ 个相同的项，所以：\n$$\n\\text{MSE} = 2 n \\Delta^2\n$$\n由于 $\\Delta = t/n$，我们有 $n = t/\\Delta$。代入 $n$：\n$$\n\\text{MSE} = 2 \\left(\\frac{t}{\\Delta}\\right) \\Delta^2 = 2t\\Delta\n$$\n在这种特定情况下，精确的 RMSE 是此 MSE 的平方根：\n$$\n\\text{RMSE} = \\sqrt{2t\\Delta}\n$$\n这就是所求的关于 $t$ 和 $\\Delta$ 的闭式表达式。", "answer": "$$\n\\boxed{\\sqrt{2t\\Delta}}\n$$", "id": "3047531"}]}