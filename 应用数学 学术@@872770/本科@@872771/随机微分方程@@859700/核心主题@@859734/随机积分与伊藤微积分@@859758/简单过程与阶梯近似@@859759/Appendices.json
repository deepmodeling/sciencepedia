{"hands_on_practices": [{"introduction": "这项练习将介绍求解随机微分方程（SDE）最基本的数值方法——欧拉-丸山格式。通过将其应用于金融数学的基石模型——几何布朗运动，我们将学习如何将一个连续时间的SDE转化为离散时间的近似 ([@problem_id:3074485])。此练习旨在计算单步近似的条件期望和方差，它揭示了离散近似的统计特性与原始SDE的漂移项和扩散项系数之间的直接联系。", "problem": "考虑由随机微分方程 (SDE) $dX_t=\\mu X_t\\,dt+\\sigma X_t\\,dW_t$ 定义的几何布朗运动 (GBM)，其中 $W_t$ 是标准布朗运动，$\\mu, \\sigma$ 是实常数。设 $\\{t_k\\}_{k\\ge 0}$ 是一个步长为 $\\Delta t>0$ 的均匀时间网格，因此有 $t_{k+1}-t_k=\\Delta t$，并定义布朗增量 $\\Delta W_k:=W_{t_{k+1}}-W_{t_k}$。使用欧拉-丸山时间步进格式，写出 $X_{k+1}$ 关于 $X_k$、$\\Delta t$ 和 $\\Delta W_k$ 的单步近似表达式，然后显式计算条件期望 $\\mathbb{E}[X_{k+1}\\mid X_k]$ 和条件方差 $\\operatorname{Var}(X_{k+1}\\mid X_k)$。你可以使用以下事实：布朗运动具有独立增量，且 $\\Delta W_k\\sim \\mathcal{N}(0,\\Delta t)$（一个均值为零、方差为 $\\Delta t$ 的正态随机变量），它独立于截至时间 $t_k$ 的滤子 $\\mathcal{F}_{t_k}$。最终答案应以两个闭式解析表达式的形式给出。无需四舍五入。[@problem_id:458]", "solution": "用户提供了一个需要分析几何布朗运动过程的欧拉-丸山离散化的问题。\n\n首先根据所需标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 几何布朗运动 (GBM) 的随机微分方程 (SDE) 为 $dX_t=\\mu X_t\\,dt+\\sigma X_t\\,dW_t$。\n- $W_t$ 是一个标准布朗运动。\n- $\\mu$ 和 $\\sigma$ 是实常数。\n- $\\{t_k\\}_{k\\ge 0}$ 是一个步长为 $\\Delta t > 0$ 的均匀时间网格，其中 $t_{k+1}-t_k=\\Delta t$。\n- 布朗增量定义为 $\\Delta W_k:=W_{t_{k+1}}-W_{t_k}$。\n- 要使用的数值方法是欧拉-丸山时间步进格式。\n- 目标是计算条件期望 $\\mathbb{E}[X_{k+1}\\mid X_k]$ 和条件方差 $\\operatorname{Var}(X_{k+1}\\mid X_k)$。\n- 已知布朗运动具有独立增量。\n- 已知 $\\Delta W_k$ 服从均值为 $0$、方差为 $\\Delta t$ 的正态分布，记为 $\\Delta W_k\\sim \\mathcal{N}(0,\\Delta t)$。\n- 已知 $\\Delta W_k$ 独立于滤子 $\\mathcal{F}_{t_k}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于几何布朗运动的标准模型和欧拉-丸山方法，这两者都是随机微分方程和量化金融领域基本且成熟的概念。引用的布朗运动性质是正确的。该问题是科学合理的。\n- **适定的**：问题陈述清晰，并提供了所有必要信息。任务是根据给定信息推导出两个具体的、定义明确的量。可以确定唯一的解析解。\n- **客观性**：问题以精确、形式化的数学语言陈述，没有任何主观或模糊的术语。\n\n### 第 3 步：结论与行动\n该问题是有效的。这是研究随机微分方程数值解的一个标准练习。可以开始求解过程。\n\n### 解题推导\n\n几何布朗运动的 SDE 由下式给出：\n$$dX_t = \\mu X_t dt + \\sigma X_t dW_t$$\n对于一个 SDE $dY_t = a(t, Y_t)dt + b(t, Y_t)dW_t$，在时间步长 $\\Delta t = t_{k+1} - t_k$ 上的欧拉-丸山近似的一般形式为：\n$$Y_{k+1} = Y_k + a(t_k, Y_k)\\Delta t + b(t_k, Y_k) \\Delta W_k$$\n其中 $Y_k \\approx Y_{t_k}$ 且 $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$。\n\n对于给定的 GBM，漂移系数为 $a(t, X_t) = \\mu X_t$，扩散系数为 $b(t, X_t) = \\sigma X_t$。应用欧拉-丸山格式，我们将这些系数代入通用公式，得到 $X_{k+1}$ 的单步近似：\n$$X_{k+1} = X_k + (\\mu X_k)\\Delta t + (\\sigma X_k)\\Delta W_k$$\n从右侧提出 $X_k$ 得到所需的 $X_{k+1}$ 关于 $X_k$、$\\Delta t$ 和 $\\Delta W_k$ 的表达式：\n$$X_{k+1} = X_k(1 + \\mu \\Delta t + \\sigma \\Delta W_k)$$\n\n接下来，我们计算条件期望 $\\mathbb{E}[X_{k+1} \\mid X_k]$。符号 $\\mathbb{E}[\\cdot \\mid X_k]$ 意味着以过程在时间 $t_k$ 的值为条件。由于 $X_k$ 在时间 $t_k$ 是已知的（即，它是 $\\mathcal{F}_{t_k}$-可测的），因此在条件期望中可以将其视为常数。\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = \\mathbb{E}[X_k(1 + \\mu \\Delta t + \\sigma \\Delta W_k) \\mid X_k]$$\n利用期望的线性和对于已知值 $A$ 的属性 $\\mathbb{E}[A Y \\mid A] = A \\mathbb{E}[Y \\mid A]$：\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k \\mathbb{E}[1 + \\mu \\Delta t + \\sigma \\Delta W_k \\mid X_k]$$\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k ( \\mathbb{E}[1 \\mid X_k] + \\mathbb{E}[\\mu \\Delta t \\mid X_k] + \\mathbb{E}[\\sigma \\Delta W_k \\mid X_k] )$$\n项 $1$、$\\mu$ 和 $\\Delta t$ 是确定性常数。项 $\\sigma$ 也是一个常数。\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k (1 + \\mu \\Delta t + \\sigma \\mathbb{E}[\\Delta W_k \\mid X_k])$$\n我们已知增量 $\\Delta W_k$ 独立于滤子 $\\mathcal{F}_{t_k}$，并且由于 $X_k$ 是 $\\mathcal{F}_{t_k}$-可测的，所以 $\\Delta W_k$ 独立于 $X_k$。因此，$\\Delta W_k$ 的条件期望等于其无条件期望：\n$$\\mathbb{E}[\\Delta W_k \\mid X_k] = \\mathbb{E}[\\Delta W_k]$$\n我们已知 $\\Delta W_k \\sim \\mathcal{N}(0, \\Delta t)$，这意味着其均值为 $0$。\n$$\\mathbb{E}[\\Delta W_k] = 0$$\n将此结果代回 $X_{k+1}$ 的条件期望表达式中：\n$$\\mathbb{E}[X_{k+1} \\mid X_k] = X_k(1 + \\mu \\Delta t + \\sigma \\cdot 0) = X_k(1 + \\mu \\Delta t)$$\n\n最后，我们计算条件方差 $\\operatorname{Var}(X_{k+1} \\mid X_k)$。条件方差的定义是：\n$$\\operatorname{Var}(Y \\mid Z) = \\mathbb{E}[(Y - \\mathbb{E}[Y \\mid Z])^2 \\mid Z]$$\n在我们的例子中，$Y = X_{k+1}$ 且 $Z = X_k$。\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = \\mathbb{E}[(X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k])^2 \\mid X_k]$$\n我们先求平方内的项：\n$$X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k] = X_k(1 + \\mu \\Delta t + \\sigma \\Delta W_k) - X_k(1 + \\mu \\Delta t)$$\n$$X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k] = X_k + X_k \\mu \\Delta t + X_k \\sigma \\Delta W_k - X_k - X_k \\mu \\Delta t$$\n$$X_{k+1} - \\mathbb{E}[X_{k+1} \\mid X_k] = X_k \\sigma \\Delta W_k$$\n现在，将其代回方差公式：\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = \\mathbb{E}[(X_k \\sigma \\Delta W_k)^2 \\mid X_k] = \\mathbb{E}[X_k^2 \\sigma^2 (\\Delta W_k)^2 \\mid X_k]$$\n由于在给定条件下 $X_k$ 和 $\\sigma$ 是已知的，我们可以将它们从期望中提出来：\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = X_k^2 \\sigma^2 \\mathbb{E}[(\\Delta W_k)^2 \\mid X_k]$$\n由于 $\\Delta W_k$ 和 $X_k$ 的独立性：\n$$\\mathbb{E}[(\\Delta W_k)^2 \\mid X_k] = \\mathbb{E}[(\\Delta W_k)^2]$$\n任何随机变量 $Z$ 的方差由 $\\operatorname{Var}(Z) = \\mathbb{E}[Z^2] - (\\mathbb{E}[Z])^2$ 给出。对于 $Z = \\Delta W_k$，我们知道 $\\operatorname{Var}(\\Delta W_k) = \\Delta t$ 且 $\\mathbb{E}[\\Delta W_k] = 0$。\n$$\\Delta t = \\mathbb{E}[(\\Delta W_k)^2] - (0)^2 \\implies \\mathbb{E}[(\\Delta W_k)^2] = \\Delta t$$\n将此结果代入条件方差的表达式中：\n$$\\operatorname{Var}(X_{k+1} \\mid X_k) = X_k^2 \\sigma^2 \\Delta t$$\n为了清晰起见，使用标准惯例重写，方差为 $\\sigma^2 X_k^2 \\Delta t$。\n\n所求的两个表达式是条件期望 $\\mathbb{E}[X_{k+1}\\mid X_k] = X_k(1 + \\mu \\Delta t)$ 和条件方差 $\\operatorname{Var}(X_{k+1}\\mid X_k) = \\sigma^2 X_k^2 \\Delta t$。", "answer": "$$\n\\boxed{\\mathbb{E}[X_{k+1}\\mid X_k] = X_k(1 + \\mu \\Delta t), \\quad \\operatorname{Var}(X_{k+1}\\mid X_k) = \\sigma^2 X_k^2 \\Delta t}\n$$", "id": "3074485"}, {"introduction": "虽然像欧拉-丸山这样的数值格式是强大的工具，但理解它们的局限性也至关重要。这项练习探讨了一个关键问题：数值近似是否总能保持真实解的定性属性，例如正性？通过分析像Cox-Ingersoll-Ross（CIR）模型这样的特定SDE ([@problem_id:3074530])，我们将揭示为何布朗增量的无界性会导致离散模拟违反基本约束，即便精确的连续解并不会如此。", "problem": "考虑标量伊藤随机微分方程 (SDE)\n$$\ndX_t \\;=\\; a\\!\\left(X_t\\right)\\,dt \\;+\\; b\\!\\left(X_t\\right)\\,dW_t,\\qquad X_0 \\ge 0,\n$$\n由标准布朗运动 $W_t$ 驱动。假设在关于 $a(\\cdot)$ 和 $b(\\cdot)$ 的适当条件下，当 $X_0>0$ 时，对于所有 $t>0$，精确解 $(X_t)_{t\\ge 0}$ 幾乎必然是严格为正的。\n\n步长为 $\\Delta t>0$ 的欧拉-丸山时间离散化方法通过以下方式构造了对 $(X_{t_n})$（其中 $t_n = n\\,\\Delta t$）的步进近似 $(X_n)_{n\\in\\mathbb{N}}$：\n$$\nX_{n+1} \\;=\\; X_n \\;+\\; a\\!\\left(X_n\\right)\\,\\Delta t \\;+\\; b\\!\\left(X_n\\right)\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n := W_{t_{n+1}} - W_{t_n} \\sim \\mathcal{N}(0,\\Delta t)$ 在不同的 $n$ 之间是独立的。\n\n关于欧拉-丸山方法对 $X_n$ 的正性保持，以下哪些陈述是正确的？选择所有适用项。\n\nA. 对于几何布朗运动 SDE $dX_t = \\mu\\,X_t\\,dt + \\sigma\\,X_t\\,dW_t$ 且 $X_0>0$，欧拉-丸山方法对于任何 $\\Delta t>0$ 和任何实数参数 $\\mu$ 和 $\\sigma$ 幾乎必然保持正性。\n\nB. 如果对于所有 $x \\ge 0$ 都有 $b(x) = 0$ 且 $a(x) \\ge 0$，那么从任何 $X_0 \\ge 0$ 开始，对于任何 $\\Delta t>0$，欧拉-丸山迭代值幾乎必然满足对所有 $n$ 都有 $X_n \\ge 0$。\n\nC. 对于 Cox–Ingersoll–Ross SDE $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma\\sqrt{X_t}\\,dW_t$，其参数满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 且 $X_0>0$，精确解对于所有 $t>0$ 都是严格为正的，但欧拉-丸山方法对于任何固定的 $\\Delta t>0$ 都会以正概率产生负值。\n\nD. 存在一个足够小的步长 $\\Delta t_0>0$（仅取决于系数），使得对于所有 $\\Delta t \\in (0,\\Delta t_0)$，欧拉-丸山方法对每个其精确解在 $t>0$ 时幾乎必然为正的伊藤 SDE 都能幾乎必然地保持正性。\n\n基于欧拉-丸山构造的第一性原理和布朗增量的分布特性，为每个选项提供简要的理由，并找出一个具体的反例，说明即使 SDE 具有严格为正的解，欧拉-丸山方法也未能保持正性。", "solution": "在进行求解之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取已知条件\n-   给出了标量伊藤随机微分方程 (SDE)：\n    $$\n    dX_t \\;=\\; a\\!\\left(X_t\\right)\\,dt \\;+\\; b\\!\\left(X_t\\right)\\,dW_t,\\qquad X_0 \\ge 0\n    $$\n-   $W_t$ 是一个标准布朗运动。\n-   假设：当 $X_0>0$ 时，对于所有 $t>0$，精确解 $(X_t)_{t\\ge 0}$ 幾乎必然是严格为正的。\n-   欧拉-丸山 (EM) 时间离散化是：\n    $$\n    X_{n+1} \\;=\\; X_n \\;+\\; a\\!\\left(X_n\\right)\\,\\Delta t \\;+\\; b\\!\\left(X_n\\right)\\,\\Delta W_n\n    $$\n-   时间步长为 $\\Delta t>0$，且 $t_n = n\\,\\Delta t$。\n-   布朗增量 $\\Delta W_n := W_{t_{n+1}} - W_{t_n}$ 是独立同分布的，服从 $\\mathcal{N}(0,\\Delta t)$。\n-   问题要求识别关于 EM 迭代值 $(X_n)_{n\\in\\mathbb{N}}$ 正性保持的正确陈述。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题是在随机微积分和 SDE 数值分析的标准数学框架内提出的。伊藤 SDE、布朗运动和欧拉-丸山方法是基本且定义明确的概念。提到的特定 SDE 模型（几何布朗运动、Cox–Ingersoll–Ross）是该领域的标准模型。前提在事实上和科学上都是合理的。\n2.  **良态性：** 问题要求评估关于一个数值方案行为的四个不同数学陈述的真伪。这是一个良态的任务。\n3.  **客观性：** 语言正式、精确且客观。没有主观或模糊的术语。\n4.  **不完整或矛盾的设定：** 问题为通用 SDE 和 EM 方案提供了所有必要的定义。每个选项都提供了待评估的特定背景或主张。整个设定是自洽且一致的。\n5.  **病态或结构不良：** 问题结构清晰，可以对每个选项得出可验证的答案。\n6.  **琐碎或同义反复：** 这个问题并非琐碎。它需要理解 EM 方案中高斯增量的分布特性，以及这些特性如何导致数值近似与真实解之间的质的差异（例如，失去正性）。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。这是随机微分方程数值分析中的一个标准且良态的问题。将推导出一个完整的解。\n\n### 解题推导\n\n问题的核心在于欧拉-丸山更新步骤的结构：\n$$\nX_{n+1} \\;=\\; X_n \\;+\\; a\\!\\left(X_n\\right)\\,\\Delta t \\;+\\; b\\!\\left(X_n\\right)\\,\\Delta W_n\n$$\n给定 $X_n > 0$，我们关心 $X_{n+1}$ 的符号。增量 $\\Delta W_n$ 是一个服从正态分布的随机变量，$\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$。正态分布的一个关键性质是其支撑集是整个实数轴 $(-\\infty, \\infty)$。这意味着对于任何固定的非零方差 $\\Delta t > 0$，$\\Delta W_n$ 可以以非零的概率密度取任何实数值。\n\n具体来说，对于任何有限值 $c \\in \\mathbb{R}$，$P(\\Delta W_n  c) > 0$。如果扩散系数 $b(X_n)$ 非零，则项 $b(X_n)\\,\\Delta W_n$ 是一个零均值的高斯随机变量。它的随机性可能导致 $X_{n+1}$ 变为负数。$X_{n+1}$ 变为负数的条件是\n$$\nb(X_n)\\,\\Delta W_n  -X_n - a(X_n)\\,\\Delta t\n$$\n或者，假设 $b(X_n) \\neq 0$，\n$$\n\\text{如果 } b(X_n) > 0: \\quad \\Delta W_n  -\\frac{X_n + a(X_n)\\,\\Delta t}{b(X_n)}\n$$\n$$\n\\text{如果 } b(X_n)  0: \\quad \\Delta W_n > -\\frac{X_n + a(X_n)\\,\\Delta t}{b(X_n)}\n$$\n无论哪种情况，由于右侧是一个有限值，且 $\\Delta W_n$ 的支撑集是 $(-\\infty, \\infty)$，这个事件发生的概率是严格为正的。这一洞察是评估选项的关键。\n\n**选项 A: 对于几何布朗运动 SDE $dX_t = \\mu\\,X_t\\,dt + \\sigma\\,X_t\\,dW_t$ 且 $X_0>0$，欧拉-丸山方法对于任何 $\\Delta t>0$ 和任何实数参数 $\\mu$ 和 $\\sigma$ 幾乎必然保持正性。**\n\n几何布朗运动 (GBM) 的 SDE 系数为 $a(x) = \\mu x$ 和 $b(x) = \\sigma x$。EM 方案是：\n$$\nX_{n+1} = X_n + \\mu X_n \\Delta t + \\sigma X_n \\Delta W_n = X_n(1 + \\mu \\Delta t + \\sigma \\Delta W_n)\n$$\n为使 $X_{n+1}$ 为正，给定 $X_n > 0$，我们必须有 $1 + \\mu \\Delta t + \\sigma \\Delta W_n > 0$。我们假设 $\\sigma \\neq 0$。这个不等式等价于：\n$$\n\\sigma \\Delta W_n > - (1 + \\mu \\Delta t)\n$$\n随机变量 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$ 具有无界支撑集。因此，对于任何 $\\Delta t > 0$，$\\Delta W_n$ 都有正概率取到一个违反此不等式的值。例如，如果 $\\sigma > 0$，事件 $\\Delta W_n  -(1 + \\mu \\Delta t)/\\sigma$ 发生的概率 $P(\\Delta W_n  -(1 + \\mu \\Delta t)/\\sigma) > 0$。在这种事件中，$X_{n+1} \\le 0$。由于单步失败的概率为正，因此在所有步骤中正性并非“幾乎必然”保持。\n\n选项 A 的结论：**不正确**。\n\n**选项 B: 如果对于所有 $x \\ge 0$ 都有 $b(x) = 0$ 且 $a(x) \\ge 0$，那么从任何 $X_0 \\ge 0$ 开始，对于任何 $\\Delta t>0$，欧拉-丸山迭代值幾乎必然满足对所有 $n$ 都有 $X_n \\ge 0$。**\n\n如果 $b(x)=0$，SDE 变成一个确定性的常微分方程 $dX_t = a(X_t)dt$。EM 方案简化为：\n$$\nX_{n+1} = X_n + a(X_n)\\,\\Delta t\n$$\n这是一个确定性的递推关系。我们可以通过归纳法证明其正性。\n-   基础情况：给定 $X_0 \\ge 0$。\n-   归纳步骤：假设对于某个 $n \\ge 0$ 有 $X_n \\ge 0$。根据问题条件，由于 $X_n \\ge 0$，我们有 $a(X_n) \\ge 0$。又因为 $\\Delta t > 0$，所以乘积 $a(X_n)\\,\\Delta t \\ge 0$。\n-   因此，$X_{n+1} = X_n + a(X_n)\\,\\Delta t \\ge 0 + 0 = 0$。\n通过归纳法，对于所有 $n \\in \\mathbb{N}$，$X_n \\ge 0$。由于演化是确定性的，这以概率 $1$ 成立（即幾乎必然）。\n\n选项 B 的结论：**正确**。\n\n**选项 C: 对于 Cox–Ingersoll–Ross SDE $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma\\sqrt{X_t}\\,dW_t$，其参数满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 且 $X_0>0$，精确解对于所有 $t>0$ 都是严格为正的，但欧拉-丸山方法对于任何固定的 $\\Delta t>0$ 都会以正概率产生负值。**\n\n该 SDE 是 Cox-Ingersoll-Ross (CIR) 模型，其中 $a(x) = \\kappa(\\theta - x)$，$b(x) = \\sigma\\sqrt{x}$。已知 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 足以确保在 $X_0 > 0$ 的情况下精确解 $X_t$ 幾乎必然保持严格为正。问题陈述正确地断言了这一点。\nEM 方案是：\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma\\sqrt{X_n}\\,\\Delta W_n\n$$\n我们来分析从某个 $X_n > 0$ 开始，$X_{n+1}  0$ 的可能性。这种情况发生的条件是：\n$$\n\\sigma\\sqrt{X_n}\\,\\Delta W_n  -X_n - \\kappa(\\theta - X_n)\\,\\Delta t\n$$\n由于 $X_n > 0$，我们可以不失一般性地假设 $\\sigma > 0$（如果 $\\sigma=0$，且 $a(x)\\ge 0$，则属于选项 B 的情况）。变为负值的条件成为：\n$$\n\\Delta W_n  -\\frac{X_n + \\kappa(\\theta - X_n)\\,\\Delta t}{\\sigma\\sqrt{X_n}}\n$$\n右边是一个有限的实数。由于 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$ 的支撑集是 $(-\\infty, \\infty)$，对于任何固定的 $\\Delta t > 0$，事件 $\\Delta W_n$ 小于这个有限阈值的概率严格大于零。因此，尽管真实解是严格为正的，EM 方法仍能以正概率产生负值。这是标准 EM 方案应用于 CIR 模型时一个众所周知的缺陷。\n\n选项 C 的结论：**正确**。\n\n**选项 D: 存在一个足够小的步长 $\\Delta t_0>0$（仅取决于系数），使得对于所有 $\\Delta t \\in (0,\\Delta t_0)$，欧拉-丸山方法对每个其精确解在 $t>0$ 时幾乎必然为正的伊藤 SDE 都能幾乎必然地保持正性。**\n\n这个陈述提出了一个非常强的、普遍性的主张。我们用一个反例来证伪它。考虑选项 A 中的 GBM：$dX_t = \\mu X_t dt + \\sigma X_t dW_t$。我们已经证明，对于*任何* $\\Delta t > 0$，过程在单步内变为负值的概率都是正的。\n$$\nP(X_{n+1}  0 | X_n>0) = P\\left( \\Delta W_n  -\\frac{1+\\mu \\Delta t}{\\sigma} \\right) > 0\n$$\n由于这个单步转移概率为正，整个路径 $(X_n)_{n\\in\\mathbb{N}}$ 保持为正的概率小于 $1$。因此，正性并非“幾乎必然”保持。该陈述声称，对于*每个*这样的 SDE，只需选择足够小的 $\\Delta t$ 即可解决此问题。这是错误的。对于任何具有非零扩散项 $b(x)$ 的 SDE，如果 $b(x)$ 在 $x \\to 0$ 时消失得不够“快”，高斯噪声项 $b(X_n)\\Delta W_n$ 总会有非零的概率足够小，从而使 $X_{n+1}$ 变为负值。无论 $\\Delta t>0$有多小，$\\Delta W_n$ 的支撑集仍然是 $(-\\infty, \\infty)$，因此出现大幅度负向波动的可能性（尽管可能很小）永远不会被消除。\n\n选项 D 的结论：**不正确**。\n\n**寻找反例**\n问题要求提供一个具体的反例，其中欧拉-丸山方法对于一个具有严格正解的 SDE 未能保持正性。对选项 C 的分析恰好提供了这样一个例子。Cox–Ingersoll–Ross 模型 $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma\\sqrt{X_t}\\,dW_t$ 在 $2\\kappa\\theta \\ge \\sigma^2$ 和 $X_0>0$ 的条件下具有严格正解。然而，如前所示，应用于它的标准欧拉-丸山方案对于任何步长 $\\Delta t > 0$ 都会以正概率生成负值。选项 A 中的几何布朗运动是另一个这样的例子。", "answer": "$$\\boxed{BC}$$", "id": "3074530"}, {"introduction": "分步近似不仅用于数值模拟，它们也是构建整个随机积分理论的概念基础。这最后一项练习旨在连接离散求和与连续的伊藤积分 ([@problem_id:3074507])。通过从离散的乘积法则出发并取极限，你将推导出著名的伊藤分部积分公式，并揭示非经典“修正项”——二次协变差——的来源，它从根本上将随机微积分与普通微积分区分开来。", "problem": "考虑一个带滤概率空间，其上支撑一个标准布朗运动（Wiener过程）$W=\\{W_t\\}_{t\\in[0,T]}$及其自然滤子，其中$T0$是固定的。令$X=\\{X_t\\}_{t\\in[0,T]}$为一个连续的、适应的半鞅。随机积分$\\int_{0}^{T} X_t\\,dW_t$被定义为左点Riemann和依概率收敛的极限\n$$\nS^{(n)}(X,W):=\\sum_{i=0}^{n-1} X_{t_i}\\bigl(W_{t_{i+1}}-W_{t_i}\\bigr),\n$$\n其中$\\{t_i\\}_{i=0}^{n}$是$[0,T]$的一个分割，当$n\\to\\infty$时，其网格尺寸趋于$0$。二次协变差$[X,W]_T$被定义为下式依概率收敛的极限\n$$\nC^{(n)}(X,W):=\\sum_{i=0}^{n-1}\\bigl(X_{t_{i+1}}-X_{t_i}\\bigr)\\bigl(W_{t_{i+1}}-W_{t_i}\\bigr).\n$$\n从这些定义和逐路径乘积$X_t W_t$的增量乘积法则出发，为$S^{(n)}(X,W)$推导一个离散分部积分表示，该表示将$\\int_{0}^{T} X_t\\,dW_t$用$\\int_{0}^{T} W_t\\,dX_t$和一个修正项表示，在网格尺寸趋于$0$的极限下，您必须将该修正项识别为二次协变差$[X,W]_T$。然后，将情况特殊化为$X_t=W_t$，并显式地以$W_T$和$T$的函数形式计算随机积分$\\int_{0}^{T} W_t\\,dW_t$的闭合形式。\n\n您的最终答案必须是单一闭合形式的解析表达式。无需四舍五入，也不涉及单位。", "solution": "问题陈述是有效的，因为它在科学上基于随机微积分的既定理论，是适定的，具有明确的目标，并使用精确、客观的数学语言进行表述。我们可以开始求解。\n\n该问题要求从离散和近似出发，推导随机积分的分部积分公式，然后应用该公式计算$\\int_{0}^{T} W_t\\,dW_t$。\n\n令$\\{t_i\\}_{i=0}^{n}$为区间$[0,T]$的一个分割，使得$0=t_0  t_1  \\dots  t_n = T$。令$\\Delta X_i = X_{t_{i+1}} - X_{t_i}$和$\\Delta W_i = W_{t_{i+1}} - W_{t_i}$为过程$X$和$W$在区间$[t_i, t_{i+1}]$上的增量。\n\n我们首先考虑乘积$X_t W_t$在子区间$[t_i, t_{i+1}]$上的增量：\n$$ X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i} $$\n由于$X_{t_{i+1}} = X_{t_i} + \\Delta X_i$和$W_{t_{i+1}} = W_{t_i} + \\Delta W_i$，我们可以将乘积$X_{t_{i+1}}W_{t_{i+1}}$展开为：\n$$ X_{t_{i+1}}W_{t_{i+1}} = (X_{t_i} + \\Delta X_i)(W_{t_i} + \\Delta W_i) = X_{t_i}W_{t_i} + X_{t_i}\\Delta W_i + W_{t_i}\\Delta X_i + \\Delta X_i \\Delta W_i $$\n整理这个方程，我们得到乘积增量的精确恒等式：\n$$ X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i} = X_{t_i}\\Delta W_i + W_{t_i}\\Delta X_i + \\Delta X_i \\Delta W_i $$\n对于任何两个函数，无论是随机的还是确定性的，这个恒等式都逐路径成立。\n\n接下来，我们将这个恒等式在分割的所有子区间上求和，从$i=0$到$n-1$：\n$$ \\sum_{i=0}^{n-1} (X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i}) = \\sum_{i=0}^{n-1} X_{t_i}\\Delta W_i + \\sum_{i=0}^{n-1} W_{t_i}\\Delta X_i + \\sum_{i=0}^{n-1} \\Delta X_i \\Delta W_i $$\n左边是一个伸缩和：\n$$ \\sum_{i=0}^{n-1} (X_{t_{i+1}}W_{t_{i+1}} - X_{t_i}W_{t_i}) = (X_{t_1}W_{t_1} - X_{t_0}W_{t_0}) + (X_{t_2}W_{t_2} - X_{t_1}W_{t_1}) + \\dots + (X_{t_n}W_{t_n} - X_{t_{n-1}}W_{t_{n-1}}) = X_{t_n}W_{t_n} - X_{t_0}W_{t_0} = X_T W_T - X_0 W_0 $$\n右边的项对应于问题陈述中给出的离散近似。第一项是$X$对$W$积分的左点Riemann和：\n$$ S^{(n)}(X,W) = \\sum_{i=0}^{n-1} X_{t_i}\\Delta W_i = \\sum_{i=0}^{n-1} X_{t_i}(W_{t_{i+1}}-W_{t_i}) $$\n第二项是$W$对$X$积分的左点Riemann和：\n$$ S^{(n)}(W,X) = \\sum_{i=0}^{n-1} W_{t_i}\\Delta X_i = \\sum_{i=0}^{n-1} W_{t_i}(X_{t_{i+1}}-X_{t_i}) $$\n第三项是二次协变差的离散近似：\n$$ C^{(n)}(X,W) = \\sum_{i=0}^{n-1} \\Delta X_i \\Delta W_i = \\sum_{i=0}^{n-1} (X_{t_{i+1}}-X_{t_i})(W_{t_{i+1}}-W_{t_i}) $$\n将这些代入求和后的恒等式，我们得到：\n$$ X_T W_T - X_0 W_0 = S^{(n)}(X,W) + S^{(n)}(W,X) + C^{(n)}(X,W) $$\n问题要求$S^{(n)}(X,W)$的离散表示。整理上述方程得到：\n$$ S^{(n)}(X,W) = (X_T W_T - X_0 W_0) - S^{(n)}(W,X) - C^{(n)}(X,W) $$\n现在，我们取分割的网格尺寸$\\|P_n\\| = \\max_i(t_{i+1}-t_i)$趋于$0$的极限。根据所提供的定义和半鞅的性质，这些和依概率收敛到它们对应的连续时间对象：\n$$ \\lim_{\\|P_n\\|\\to 0} S^{(n)}(X,W) = \\int_{0}^{T} X_t\\,dW_t $$\n$$ \\lim_{\\|P_n\\|\\to 0} S^{(n)}(W,X) = \\int_{0}^{T} W_t\\,dX_t $$\n$$ \\lim_{\\|P_n\\|\\to 0} C^{(n)}(X,W) = [X,W]_T $$\n对$S^{(n)}(X,W)$的离散表示取极限，得到连续分部积分公式：\n$$ \\int_{0}^{T} X_t\\,dW_t = X_T W_T - X_0 W_0 - \\int_{0}^{T} W_t\\,dX_t - [X,W]_T $$\n这个公式将$\\int_{0}^{T} X_t\\,dW_t$表示为$\\int_{0}^{T} W_t\\,dX_t$和其他项。项$[X,W]_T$是二次协变差，它是区分随机微积分与经典Riemann-Stieltjes积分（其中对于有限变差函数，该项为零）的必要修正项。\n\n现在，我们将情况特殊化为$X_t = W_t$。分部积分公式变为：\n$$ \\int_{0}^{T} W_t\\,dW_t = W_T W_T - W_0 W_0 - \\int_{0}^{T} W_t\\,dW_t - [W,W]_T $$\n按照惯例，标准布朗运动从原点开始，所以$W_0 = 0$。方程简化为：\n$$ \\int_{0}^{T} W_t\\,dW_t = W_T^2 - \\int_{0}^{T} W_t\\,dW_t - [W,W]_T $$\n整理以求解该积分：\n$$ 2\\int_{0}^{T} W_t\\,dW_t = W_T^2 - [W,W]_T $$\n项$[W,W]_T$是布朗运动$W$在$[0,T]$上的二次变差。一个标准结果是$[W,W]_T = T$。这可以从所提供的定义中得出。和$C^{(n)}(W,W) = \\sum_{i=0}^{n-1} (W_{t_{i+1}}-W_{t_i})^2$的期望为$E[\\sum_{i=0}^{n-1} (W_{t_{i+1}}-W_{t_i})^2] = \\sum_{i=0}^{n-1} E[(W_{t_{i+1}}-W_{t_i})^2] = \\sum_{i=0}^{n-1} (t_{i+1}-t_i) = T$。可以证明，当网格尺寸趋于$0$时，这个和的方差趋于$0$，这意味着该和依概率收敛于其期望值$T$。\n将$[W,W]_T = T$代入我们的方程：\n$$ 2\\int_{0}^{T} W_t\\,dW_t = W_T^2 - T $$\n最后，解出该随机积分，我们得到闭合形式表达式：\n$$ \\int_{0}^{T} W_t\\,dW_t = \\frac{1}{2}(W_T^2 - T) $$\n这个结果是Itô公式应用于函数$f(x) = x^2/2$的一个特例，但在这里是按照问题的要求，从离散和近似的第一性原理推导出来的。", "answer": "$$\\boxed{\\frac{1}{2}(W_T^2 - T)}$$", "id": "3074507"}]}