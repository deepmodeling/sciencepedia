{"hands_on_practices": [{"introduction": "多层蒙特卡洛方法的有效性取决于一种名为“耦合”的巧妙技术，它将不同精度水平上的模拟关联起来。本练习将通过比较正确的耦合策略与朴素的非耦合方法，精确展示方差减少的程度，从而揭示使多层蒙特卡洛方法如此强大的基本机制。", "problem": "考虑标量随机微分方程 (SDE) $dX_t = \\sigma\\, dW_t$，在时间区间 $[0,T]$ 上，初值为 $X_0 = 0$，其中 $W_t$ 是标准维纳过程，$\\sigma > 0$ 是一个常数。令 $P_\\ell$ 表示在层级 $\\ell$ 上，使用 $N_\\ell$ 个步长为 $h_\\ell = T/N_\\ell$ 的步计算出的 $X_T$ 的 Euler–Maruyama 终端近似值，并令 $P_{\\ell-1}$ 表示在层级 $\\ell-1$ 上，使用 $N_{\\ell-1} = N_\\ell/2$ 个步长为 $h_{\\ell-1} = 2 h_\\ell$ 的步计算出的相应近似值。在这两种情况下，Euler–Maruyama 格式定义为 $X_{n+1} = X_n + \\sigma\\, \\Delta W_n$，其中每个布朗增量 $\\Delta W_n$ 服从分布 $\\mathcal{N}(0,h)$，$h$ 为相应步长。定义 $P_\\ell = \\sum_{n=1}^{N_\\ell} \\sigma\\, \\Delta W^{(\\ell)}_n$ 和 $P_{\\ell-1} = \\sum_{m=1}^{N_{\\ell-1}} \\sigma\\, \\Delta W^{(\\ell-1)}_m$。在多层蒙特卡洛 (MLMC) 方法中，使用跨层耦合来减小层级差异的方差。\n\n考虑两种耦合策略：\n- 正确耦合：对于每个 $m \\in \\{1,\\dots,N_{\\ell-1}\\}$，设置 $\\Delta W^{(\\ell-1)}_m = \\Delta W^{(\\ell)}_{2m-1} + \\Delta W^{(\\ell)}_{2m}$，其中细层增量 $\\{\\Delta W^{(\\ell)}_n\\}_{n=1}^{N_\\ell}$ 独立同分布，服从 $\\mathcal{N}(0,h_\\ell)$ 分布。\n- 不正确耦合：生成 $\\{\\Delta W^{(\\ell-1)}_m\\}_{m=1}^{N_{\\ell-1}}$ 作为独立同分布的 $\\mathcal{N}(0,h_{\\ell-1})$ 增量，且这些增量独立于细层增量 $\\{\\Delta W^{(\\ell)}_n\\}_{n=1}^{N_\\ell}$。\n\n仅从布朗运动的独立高斯增量性质以及独立随机变量的方差可加性出发，推导在每种耦合策略下的 $\\mathrm{Var}(P_\\ell - P_{\\ell-1})$。然后，将不正确耦合方差 $\\mathrm{Var}(P_\\ell - P_{\\ell-1})$ 表示为以 $\\sigma$ 和 $T$ 表示的简化闭式解析表达式。你的最终答案必须是这个表达式。无需进行四舍五入。", "solution": "该问题要求对于随机微分方程 (SDE) $dX_t = \\sigma\\, dW_t$，$X_0=0$，在两种不同的耦合策略下，推导细层和粗层 Euler-Maruyama 近似值之差的方差 $\\mathrm{Var}(P_\\ell - P_{\\ell-1})$。最终答案是在不正确耦合策略下该方差的具体表达式。\n\n令 $P_\\ell$ 和 $P_{\\ell-1}$ 分别为表示在层级 $\\ell$ (细层) 和层级 $\\ell-1$ (粗层) 上终端时间 $T$ 的数值近似的随机变量。两个随机变量之差的方差的一般公式为：\n$$\n\\mathrm{Var}(P_\\ell - P_{\\ell-1}) = \\mathrm{Var}(P_\\ell) + \\mathrm{Var}(P_{\\ell-1}) - 2 \\mathrm{Cov}(P_\\ell, P_{\\ell-1})\n$$\n我们通过首先计算各自的方差 $\\mathrm{Var}(P_\\ell)$ 和 $\\mathrm{Var}(P_{\\ell-1})$，然后评估协方差项来分析每种耦合策略。\n\n细层近似由 $P_\\ell = \\sum_{n=1}^{N_\\ell} \\sigma\\, \\Delta W^{(\\ell)}_n$ 给出，其中 $\\{\\Delta W^{(\\ell)}_n\\}_{n=1}^{N_\\ell}$ 是独立同分布 (i.i.d.) 的随机变量，服从分布 $\\mathcal{N}(0,h_\\ell)$。$P_\\ell$ 的方差使用独立随机变量的方差可加性以及缩放性质 $\\mathrm{Var}(aZ) = a^2 \\mathrm{Var}(Z)$ 来计算：\n$$\n\\mathrm{Var}(P_\\ell) = \\mathrm{Var}\\left(\\sigma \\sum_{n=1}^{N_\\ell} \\Delta W^{(\\ell)}_n\\right) = \\sigma^2 \\mathrm{Var}\\left(\\sum_{n=1}^{N_\\ell} \\Delta W^{(\\ell)}_n\\right)\n$$\n由于增量 $\\Delta W^{(\\ell)}_n$ 是独立的，它们的和的方差是它们方差的和：\n$$\n\\mathrm{Var}(P_\\ell) = \\sigma^2 \\sum_{n=1}^{N_\\ell} \\mathrm{Var}(\\Delta W^{(\\ell)}_n) = \\sigma^2 \\sum_{n=1}^{N_\\ell} h_\\ell = \\sigma^2 N_\\ell h_\\ell\n$$\n已知步长为 $h_\\ell = T/N_\\ell$，我们有 $N_\\ell h_\\ell = T$。因此，细层近似的方差是：\n$$\n\\mathrm{Var}(P_\\ell) = \\sigma^2 T\n$$\n类似地，粗层近似由 $P_{\\ell-1} = \\sum_{m=1}^{N_{\\ell-1}} \\sigma\\, \\Delta W^{(\\ell-1)}_m$ 给出，其中增量 $\\Delta W^{(\\ell-1)}_m$ 是独立同分布的 $\\mathcal{N}(0,h_{\\ell-1})$。遵循同样的逻辑：\n$$\n\\mathrm{Var}(P_{\\ell-1}) = \\sigma^2 \\sum_{m=1}^{N_{\\ell-1}} \\mathrm{Var}(\\Delta W^{(\\ell-1)}_m) = \\sigma^2 \\sum_{m=1}^{N_{\\ell-1}} h_{\\ell-1} = \\sigma^2 N_{\\ell-1} h_{\\ell-1}\n$$\n已知 $h_{\\ell-1} = T/N_{\\ell-1}$，我们有 $N_{\\ell-1} h_{\\ell-1} = T$。因此，粗层近似的方差是：\n$$\n\\mathrm{Var}(P_{\\ell-1}) = \\sigma^2 T\n$$\n我们现在开始评估在每种耦合策略下的 $\\mathrm{Var}(P_\\ell - P_{\\ell-1})$。\n\n**1. 不正确耦合策略**\n\n在此策略下，粗层增量集合 $\\{\\Delta W^{(\\ell-1)}_m\\}_{m=1}^{N_{\\ell-1}}$ 的生成独立于细层增量集合 $\\{\\Delta W^{(\\ell)}_n\\}_{n=1}^{N_\\ell}$。由于 $P_\\ell$ 仅是细层增量的函数，而 $P_{\\ell-1}$ 仅是粗层增量的函数，因此随机变量 $P_\\ell$ 和 $P_{\\ell-1}$ 是独立的。对于独立随机变量，协方差为零：\n$$\n\\mathrm{Cov}(P_\\ell, P_{\\ell-1}) = 0\n$$\n将此代入一般方差公式，得到：\n$$\n\\mathrm{Var}(P_\\ell - P_{\\ell-1}) = \\mathrm{Var}(P_\\ell) + \\mathrm{Var}(P_{\\ell-1})\n$$\n使用先前为 $P_\\ell$ 和 $P_{\\ell-1}$ 推导出的方差：\n$$\n\\mathrm{Var}(P_\\ell - P_{\\ell-1}) = \\sigma^2 T + \\sigma^2 T = 2 \\sigma^2 T\n$$\n这就是不正确耦合下的方差。\n\n**2. 正确耦合策略**\n\n在此策略下，粗层增量由细层增量构造：$\\Delta W^{(\\ell-1)}_m = \\Delta W^{(\\ell)}_{2m-1} + \\Delta W^{(\\ell)}_{2m}$。我们直接计算差值 $P_\\ell - P_{\\ell-1}$：\n$$\nP_\\ell - P_{\\ell-1} = \\sum_{n=1}^{N_\\ell} \\sigma\\, \\Delta W^{(\\ell)}_n - \\sum_{m=1}^{N_{\\ell-1}} \\sigma\\, \\Delta W^{(\\ell-1)}_m\n$$\n将耦合定义代入第二项：\n$$\n\\sum_{m=1}^{N_{\\ell-1}} \\sigma\\, \\Delta W^{(\\ell-1)}_m = \\sigma \\sum_{m=1}^{N_{\\ell-1}} \\left( \\Delta W^{(\\ell)}_{2m-1} + \\Delta W^{(\\ell)}_{2m} \\right)\n$$\n这个和涵盖了从 $n=1$ 到 $n=2N_{\\ell-1}$ 的所有细层增量。由于 $N_\\ell = 2N_{\\ell-1}$，这个和恰好是所有细层增量的和：\n$$\n\\sigma \\sum_{m=1}^{N_{\\ell-1}} \\left( \\Delta W^{(\\ell)}_{2m-1} + \\Delta W^{(\\ell)}_{2m} \\right) = \\sigma \\sum_{n=1}^{N_\\ell} \\Delta W^{(\\ell)}_n = P_\\ell\n$$\n因此，对于这个特定的 SDE，当使用正确耦合时，粗层近似 $P_{\\ell-1}$ 与细层近似 $P_\\ell$ 完全相同。差值为：\n$$\nP_\\ell - P_{\\ell-1} = P_\\ell - P_\\ell = 0\n$$\n常数的方差为零：\n$$\n\\mathrm{Var}(P_\\ell - P_{\\ell-1}) = \\mathrm{Var}(0) = 0\n$$\n这个结果凸显了通过正确耦合实现的先验方差减小，这是多层蒙特卡洛方法的基本原理。对于这个简单的 SDE，方差减小是最大的。\n\n问题要求给出用 $\\sigma$ 和 $T$ 表示的不正确耦合方差的简化闭式解析表达式。如上所推导，这个表达式是 $2 \\sigma^2 T$。", "answer": "$$\n\\boxed{2 \\sigma^{2} T}\n$$", "id": "3068034"}, {"introduction": "在 [@problem_id:3068034] 中我们看到，耦合是降低层级间方差的关键。那么，我们应如何在不同层级间分配计算资源（即样本数量）以达到最高效率呢？本练习将解决多层蒙特卡洛方法的核心优化问题，你将推导出每个层级的最优样本数，这是以最小计算成本达到预定精度的关键。", "problem": "考虑一个形式为 $dX_{t}=a(X_{t})\\,dt+b(X_{t})\\,dW_{t}$ 的标量随机微分方程 (SDE)，其中 $a$ 和 $b$ 足够正则以保证强存在性和唯一性，且 $W_{t}$ 是一个标准布朗运动。目标是使用多层蒙特卡洛 (MLMC) 方法来近似计算 $\\mathbb{E}[\\varphi(X_{T})]$，其中 $\\varphi$ 是一个 Lipschitz 收益函数。设层级由 $\\ell\\in\\{0,1,\\dots,L\\}$ 索引，时间步长为 $h_{\\ell}=h_{0}\\,2^{-\\ell}$，其中 $h_{0}>0$ 且 $L\\in\\mathbb{N}$ 的选择是为了控制偏差。假设相邻层级采用 Euler–Maruyama 耦合，并且层级差估计量的方差和每个耦合样本的期望成本按如下方式缩放：\n$$V_{\\ell}=k_{v}\\,h_{\\ell}\\quad\\text{以及}\\quad C_{\\ell}=k_{c}\\,h_{\\ell}^{-1},$$\n对于所有 $\\ell\\in\\{0,1,\\dots,L\\}$，其中 $k_{v}>0$ 和 $k_{c}>0$ 与 $\\ell$ 无关。假设均方误差 (MSE) 容差为 $\\varepsilon>0$，并且已经选择了层级 $L$ 以使偏差平方至多为 $\\varepsilon^{2}/2$。您需要选择每层的样本数 $N_{\\ell}\\in\\mathbb{R}_{>0}$，以最小化总期望成本，约束条件为方差预算等于 MSE 容差的剩余一半：\n$$\\text{最小化 }\\sum_{\\ell=0}^{L} C_{\\ell}\\,N_{\\ell}\\quad\\text{约束于}\\quad \\sum_{\\ell=0}^{L} \\frac{V_{\\ell}}{N_{\\ell}}=\\frac{\\varepsilon^{2}}{2}。$$\n仅从这些假设和优化原语出发，推导以下各项的精确闭式表达式：\n- 最优的 $N_{\\ell}$，作为 $\\varepsilon$、$L$、$h_{\\ell}$、$k_{v}$ 和 $k_{c}$ 的函数，\n- 由此产生的 $\\ell$ 层期望成本贡献，即 $C_{\\ell}\\,N_{\\ell}$，\n- 由此产生的 $\\ell$ 层估计量方差贡献，即 $V_{\\ell}/N_{\\ell}$。\n\n将您的最终结果表示为三个闭式表达式，它们依赖于 $\\ell$，并用 $\\varepsilon$、$L$、$h_{\\ell}$、$k_{v}$ 和 $k_{c}$ 表示。您的最终答案必须是包含三个条目的单行，每个条目是这些表达式之一。不要引入任何未定义的符号。不要从最终表达式中消除 $L$ 或 $h_{\\ell}$。不需要进行数值取整。", "solution": "该优化问题是在总方差约束 $\\sum_{\\ell=0}^{L} V_{\\ell}/N_{\\ell} = \\varepsilon^{2}/2$ 下，最小化总成本 $J = \\sum_{\\ell=0}^{L} C_{\\ell} N_{\\ell}$。我们可以使用拉格朗日乘子法来解决。拉格朗日函数 $\\mathcal{L}$ 是：\n$$ \\mathcal{L}(N_0, \\dots, N_L, \\lambda) = \\sum_{\\ell=0}^{L} C_{\\ell} N_{\\ell} + \\lambda \\left( \\sum_{\\ell=0}^{L} \\frac{V_{\\ell}}{N_{\\ell}} - \\frac{\\varepsilon^{2}}{2} \\right) $$\n其中 $\\lambda$ 是拉格朗日乘子。为了找到最优的 $N_{k}$，我们对 $\\mathcal{L}$ 关于每个 $N_{k}$（其中 $k \\in \\{0, \\dots, L\\}$）求偏导数，并令其为零：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial N_{k}} = C_{k} - \\lambda \\frac{V_{k}}{N_{k}^{2}} = 0 $$\n解出 $N_{k}$，我们得到 $N_{k} = \\sqrt{\\lambda} \\sqrt{\\frac{V_{k}}{C_{k}}}$。\n\n现在，我们将这个 $N_{\\ell}$ 的表达式代入方差约束中，以确定 $\\lambda$ 的值。首先，我们找到乘积 $\\sqrt{V_{\\ell} C_{\\ell}}$。代入给定的缩放关系 $V_{\\ell} = k_{v} h_{\\ell}$ 和 $C_{\\ell} = k_{c} h_{\\ell}^{-1}$：\n$$ \\sqrt{V_{\\ell} C_{\\ell}} = \\sqrt{(k_{v} h_{\\ell}) (k_{c} h_{\\ell}^{-1})} = \\sqrt{k_{v} k_{c}} $$\n这一项与层级 $\\ell$ 无关。方差约束变为：\n$$ \\sum_{\\ell=0}^{L} \\frac{V_{\\ell}}{N_{\\ell}} = \\sum_{\\ell=0}^{L} \\frac{\\sqrt{V_{\\ell} C_{\\ell}}}{\\sqrt{\\lambda}} = \\frac{1}{\\sqrt{\\lambda}}\\sum_{\\ell=0}^{L} \\sqrt{k_v k_c} = \\frac{(L+1)\\sqrt{k_v k_c}}{\\sqrt{\\lambda}} = \\frac{\\varepsilon^{2}}{2} $$\n解出 $\\sqrt{\\lambda}$：\n$$ \\sqrt{\\lambda} = \\frac{2 (L+1) \\sqrt{k_{v} k_{c}}}{\\varepsilon^{2}} $$\n现在我们已经确定了拉格朗日乘子，可以找到所需量的显式表达式。\n\n**最优样本数 $N_{\\ell}$**:\n将 $\\sqrt{\\lambda}$ 的表达式代入 $N_{\\ell}$ 的方程中：\n$$ N_{\\ell} = \\sqrt{\\lambda} \\sqrt{\\frac{V_{\\ell}}{C_{\\ell}}} = \\left( \\frac{2 (L+1) \\sqrt{k_{v} k_{c}}}{\\varepsilon^{2}} \\right) \\sqrt{\\frac{k_{v} h_{\\ell}}{k_{c} h_{\\ell}^{-1}}} = \\frac{2 (L+1)}{\\varepsilon^{2}} \\left( \\sqrt{k_{v}k_{c}} \\sqrt{\\frac{k_{v}}{k_{c}}} \\right) h_{\\ell} = \\frac{2 (L+1) k_{v}}{\\varepsilon^{2}} h_{\\ell} $$\n\n**$\\ell$ 层的成本贡献 $C_{\\ell} N_{\\ell}$**:\n$$ C_{\\ell} N_{\\ell} = (k_{c} h_{\\ell}^{-1}) \\left( \\frac{2 (L+1) k_{v}}{\\varepsilon^{2}} h_{\\ell} \\right) = \\frac{2 (L+1) k_{c} k_{v}}{\\varepsilon^{2}} $$\n\n**来自 $\\ell$ 层的方差贡献 $V_{\\ell}/N_{\\ell}$**:\n$$ \\frac{V_{\\ell}}{N_{\\ell}} = \\frac{k_{v} h_{\\ell}}{\\frac{2 (L+1) k_{v}}{\\varepsilon^{2}} h_{\\ell}} = \\frac{\\varepsilon^{2}}{2 (L+1)} $$\n作为一致性检验，总方差为 $\\sum_{\\ell=0}^{L} V_{\\ell}/N_{\\ell} = (L+1) \\frac{\\varepsilon^{2}}{2(L+1)} = \\frac{\\varepsilon^{2}}{2}$，满足约束条件。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{2 (L+1) k_{v}}{\\varepsilon^{2}} h_{\\ell}  \\frac{2 (L+1) k_{c} k_{v}}{\\varepsilon^{2}}  \\frac{\\varepsilon^{2}}{2(L+1)} \\end{pmatrix} } $$", "id": "3067970"}, {"introduction": "理论在应用于具体案例时才能真正焕发生机。本练习将你在 [@problem_id:3067970] 中推导出的抽象优化原理应用于一个具有确定方差和成本参数的数值示例中。你将计算每个层级所需的实际样本数量并确定总计算功，从而巩固你对多层蒙特卡洛工作流程的理解。", "problem": "考虑在 $\\,t\\in[0,1]\\,$ 上的几何布朗运动随机微分方程 (SDE) $\\,\\mathrm{d}X_t=\\mu X_t\\,\\mathrm{d}t+\\sigma X_t\\,\\mathrm{d}W_t\\,$，其初始条件为 $\\,X_0=1\\,$，参数为 $\\,\\mu,\\sigma\\in\\mathbb{R}\\,$. 设目标是使用多层蒙特卡洛 (MLMC) 方法近似计算 Lipschitz 偿付 $\\,P=g(X_1)\\,$ 的期望值 $\\,\\mathbb{E}[P]\\,$. 一个关于 $\\,\\ell=0,1,2,3,4\\,$ 的欧拉-丸山时间步长层级 $\\,h_\\ell=2^{-\\ell}\\,$ 已通过独立的偏差分析确定，确保在目标精度 $\\,\\epsilon=10^{-2}\\,$ 下，偏差平方的贡献至多为 $\\,\\epsilon^2/2\\,$. 通过预备模拟，估计出层间差分方差为 $\\,V_\\ell=\\operatorname{Var}(Y_\\ell)=2^{-\\ell}\\,$，层 $\\ell$ 上每样本的成本为 $\\,C_\\ell=2^{\\ell}\\,$，其中 $\\,\\ell=0,1,2,3,4\\,$，且 $\\,Y_0=P_0\\,$，对于 $\\,\\ell\\ge 1\\,$ 有 $\\,Y_\\ell=P_\\ell-P_{\\ell-1}\\,$.\n\n确定整数样本数量 $\\,N_\\ell\\in\\mathbb{N}\\,$（对于 $\\,\\ell=0,1,2,3,4\\,$），在方差约束 $\\,\\sum_{\\ell=0}^{4}\\frac{V_\\ell}{N_\\ell}\\le \\epsilon^2/2\\,$ 下，最小化总计算功. 仅使用约束优化的第一性原理来推导分配方案。使用您得到的整数 $\\,N_\\ell\\,$ 计算得到的总功 $\\,W=\\sum_{\\ell=0}^{4}N_\\ell\\,C_\\ell\\,$. 仅报告总功作为您的最终答案。最终数字无需四舍五入；请提供精确的整数。", "solution": "首先，我们将优化问题形式化。设 $\\,L=4\\,$ 为最大层数。我们旨在最小化的总计算功是目标函数：\n$$W = \\sum_{\\ell=0}^{L} N_\\ell C_\\ell$$\n此处，$\\,N_\\ell\\,$ 是层 $\\,\\ell\\,$ 上的样本数量，$\\,C_\\ell\\,$ 是层 $\\,\\ell\\,$ 上每个样本的计算成本。\n\nMLMC 估计量的方差由 $\\,\\sum_{\\ell=0}^{L} \\frac{V_\\ell}{N_\\ell}\\,$ 给出，其中 $\\,V_\\ell\\,$ 是层差估计量 $\\,Y_\\ell\\,$ 的方差。问题对此方差指定了一个约束条件：\n$$\\sum_{\\ell=0}^{L} \\frac{V_\\ell}{N_\\ell} \\le \\frac{\\epsilon^2}{2}$$\n其中 $\\,\\epsilon\\,$ 是目标精度。对于层 $\\,\\ell = 0, 1, 2, 3, 4\\,$，我们有以下特定于问题的数据：\n- 目标精度：$\\,\\epsilon = 10^{-2}\\,$，因此方差约束为 $\\,\\frac{\\epsilon^2}{2} = \\frac{(10^{-2})^2}{2} = \\frac{10^{-4}}{2} = 5 \\times 10^{-5}\\,$.\n- 层间差分方差：$\\,V_\\ell = 2^{-\\ell}\\,$.\n- 每样本成本：$\\,C_\\ell = 2^{\\ell}\\,$.\n- 层数为 $\\,L+1 = 5\\,$.\n\n为了在约束条件下找到 $\\,W\\,$ 的最小值，我们使用拉格朗日乘子法。我们首先将 $\\,N_\\ell\\,$ 视为连续实变量。最小功将在方差约束取等号时出现，即：\n$$\\sum_{\\ell=0}^{L} \\frac{V_\\ell}{N_\\ell} = \\frac{\\epsilon^2}{2}$$\n\n拉格朗日函数 $\\,\\mathcal{L}\\,$ 为：\n$$\\mathcal{L}(N_0, \\dots, N_L, \\lambda) = \\sum_{\\ell=0}^{L} N_\\ell C_\\ell + \\lambda \\left( \\sum_{\\ell=0}^{L} \\frac{V_\\ell}{N_\\ell} - \\frac{\\epsilon^2}{2} \\right)$$\n其中 $\\,\\lambda\\,$ 是拉格朗日乘子。将 $\\,\\mathcal{L}\\,$ 对每个 $\\,N_k\\,$ 的偏导数设为零，解出 $\\,N_k\\,$，得到：\n$$N_k = \\sqrt{\\lambda} \\sqrt{\\frac{V_k}{C_k}}$$\n这表明最优样本数量 $\\,N_k\\,$ 与 $\\,\\sqrt{V_k/C_k}\\,$ 成正比。\n\n接下来，我们将 $\\,N_k\\,$ 的表达式代回到激活的方差约束中，以确定 $\\,\\sqrt{\\lambda}\\,$ 的值：\n$$\\sum_{\\ell=0}^{L} \\frac{V_\\ell}{\\sqrt{\\lambda} \\sqrt{V_\\ell/C_\\ell}} = \\frac{1}{\\sqrt{\\lambda}} \\sum_{\\ell=0}^{L} \\sqrt{V_\\ell C_\\ell} = \\frac{\\epsilon^2}{2}$$\n解出 $\\,\\sqrt{\\lambda}\\,$：\n$$\\sqrt{\\lambda} = \\frac{2}{\\epsilon^2} \\sum_{\\ell=0}^{L} \\sqrt{V_\\ell C_\\ell}$$\n将 $\\,\\sqrt{\\lambda}\\,$ 的表达式代回到 $\\,N_k\\,$ 的方程中：\n$$N_k = \\left( \\frac{2}{\\epsilon^2} \\sum_{\\ell=0}^{L} \\sqrt{V_\\ell C_\\ell} \\right) \\sqrt{\\frac{V_k}{C_k}}$$\n在此问题中，$\\sqrt{V_\\ell C_\\ell} = \\sqrt{2^{-\\ell} \\cdot 2^{\\ell}} = 1$，因此 $\\sum_{\\ell=0}^{4} \\sqrt{V_\\ell C_\\ell} = 5$。另外，$\\sqrt{V_k/C_k} = \\sqrt{2^{-k}/2^k} = 2^{-k}$。\n代入这些值，我们可以计算最优（实值）$\\,N_k\\,$：\n$$N_k = \\left( \\frac{2}{(10^{-2})^2} \\cdot 5 \\right) \\cdot 2^{-k} = (10 \\cdot 10^4) \\cdot 2^{-k} = 10^5 \\cdot 2^{-k}$$\n问题要求整数样本数量。计算每一层的值：\n- 对于 $\\,\\ell=0\\,$: $\\,N_0 = 10^5 \\cdot 2^{-0} = 100000\\,$\n- 对于 $\\,\\ell=1\\,$: $\\,N_1 = 10^5 \\cdot 2^{-1} = 50000\\,$\n- 对于 $\\,\\ell=2\\,$: $\\,N_2 = 10^5 \\cdot 2^{-2} = 25000\\,$\n- 对于 $\\,\\ell=3\\,$: $\\,N_3 = 10^5 \\cdot 2^{-3} = 12500\\,$\n- 对于 $\\,\\ell=4\\,$: $\\,N_4 = 10^5 \\cdot 2^{-4} = 6250\\,$\n\n由于所有计算出的最优 $\\,N_\\ell\\,$ 值都是整数，我们不需要进行任何四舍五入。\n最后，我们使用这些最优样本数量计算总功 $\\,W\\,$：\n$$W = \\sum_{\\ell=0}^{4} N_\\ell C_\\ell = \\sum_{\\ell=0}^{4} (10^5 \\cdot 2^{-\\ell}) \\cdot (2^{\\ell}) = \\sum_{\\ell=0}^{4} 10^5 = 5 \\cdot 10^5 = 500000$$\n最小总计算功是 $\\,500000\\,$.", "answer": "$$\\boxed{500000}$$", "id": "3067966"}]}