{"hands_on_practices": [{"introduction": "理解数值方法行为的第一步是分析随机微分方程（SDE）本身的性质。这个练习将探讨一个典型的超线性漂移函数 $b(x)=-x^3$ 的关键特性，揭示为何它不满足全局Lipschitz连续性——这是标准显式方法收敛性理论的一个关键假设，但它却满足更为宽松的单边Lipschitz条件，这保证了SDE本身解的良好性质。[@problem_id:3079385]", "problem": "考虑由 $b(x)=-x^{3}$ 定义的标量漂移函数 $b:\\mathbb{R}\\to\\mathbb{R}$。该函数作为随机微分方程 (SDE) $dX_{t}=b(X_{t})\\,dt+\\sigma\\,dW_{t}$ 中超线性漂移的一个原型出现，其中 $W_{t}$ 是标准布朗运动，$\\sigma\\in\\mathbb{R}$ 是一个常数。在分析用于处理具有超线性漂移的SDE的数值方法（如驯服欧拉格式）时，单边利普希茨（单调性）条件起着核心作用。仅从单边利普希茨连续性和全局利普希茨连续性的定义，以及诸如中值定理等标准微积分事实出发，完成以下任务：\n\n- 使用单边利普希茨连续性的定义，确定最小常数 $L^{\\star}\\in\\mathbb{R}$，使得对于所有 $x,y\\in\\mathbb{R}$，都有\n$$\n(x-y)\\big(b(x)-b(y)\\big)\\leq L^{\\star}\\,|x-y|^{2}\n$$。\n\n- 使用全局利普希茨连续性的定义，论证 $b$ 在 $\\mathbb{R}$ 上是否是全局利普希茨的。\n\n你的最终答案必须是最小单边利普希茨常数 $L^{\\star}$ 的单一值。无需四舍五入。", "solution": "问题要求我们分析函数 $b(x) = -x^{3}$ 的两个性质：单边利普希茨连续性和全局利普希茨连续性。我们将从形式化定义出发，并使用标准微积分，依次处理每个部分。\n\n首先，我们确定最小的单边利普希茨常数 $L^{\\star} \\in \\mathbb{R}$。单边利普希茨条件由以下不等式给出：\n$$\n(x-y)\\big(b(x)-b(y)\\big) \\leq L^{\\star}\\,|x-y|^{2}\n$$\n对所有 $x,y \\in \\mathbb{R}$ 均成立。我们的目标是找到使此不等式普遍成立的 $L^{\\star}$ 的最小可能值。\n\n让我们将函数 $b(x)=-x^{3}$ 的定义代入不等式的左侧：\n$$\n(x-y)\\big(b(x)-b(y)\\big) = (x-y)\\big((-x^{3}) - (-y^{3})\\big) = (x-y)(y^{3}-x^{3}).\n$$\n我们使用立方差的代数恒等式 $a^{3}-b^{3} = (a-b)(a^{2}+ab+b^{2})$ 来对项 $(x^{3}-y^{3})$ 进行因式分解：\n$$\ny^{3}-x^{3} = -(x^{3}-y^{3}) = -(x-y)(x^{2}+xy+y^{2}).\n$$\n将此代回，我们得到：\n$$\n(x-y)(y^{3}-x^{3}) = (x-y)\\big(-(x-y)(x^{2}+xy+y^{2})\\big) = -(x-y)^{2}(x^{2}+xy+y^{2}).\n$$\n单边利普希茨不等式现在变为：\n$$\n-(x-y)^{2}(x^{2}+xy+y^{2}) \\leq L^{\\star}\\,|x-y|^{2}.\n$$\n由于 $|x-y|^{2} = (x-y)^{2}$，该不等式等价于：\n$$\n-(x-y)^{2}(x^{2}+xy+y^{2}) \\leq L^{\\star}\\,(x-y)^{2}.\n$$\n对于任何 $x \\neq y$，项 $(x-y)^{2}$ 是严格为正的，所以我们可以用它除以不等式两边而不改变不等号的方向：\n$$\n-(x^{2}+xy+y^{2}) \\leq L^{\\star}.\n$$\n这个不等式必须对所有 $x,y \\in \\mathbb{R}$ 成立，包括当 $y \\to x$ 时的极限情况。为了找到最小常数 $L^{\\star}$，我们必须找到左侧表达式在所有 $x,y \\in \\mathbb{R}$ 上的上确界。令 $Q(x,y) = x^{2}+xy+y^{2}$。我们寻求 $\\sup_{x,y \\in \\mathbb{R}} \\{-Q(x,y)\\}$，这等价于寻找 $-\\inf_{x,y \\in \\mathbb{R}} \\{Q(x,y)\\}$。\n\n我们可以通过对其中一个变量（比如 $x$）进行配方来找到二次型 $Q(x,y)$ 的下确界：\n$$\nQ(x,y) = x^{2}+xy+y^{2} = \\left(x^{2} + xy + \\frac{1}{4}y^{2}\\right) - \\frac{1}{4}y^{2} + y^{2} = \\left(x+\\frac{1}{2}y\\right)^{2} + \\frac{3}{4}y^{2}.\n$$\n表达式 $\\left(x+\\frac{1}{2}y\\right)^{2} + \\frac{3}{4}y^{2}$ 是两个实数平方项的和。任何实数的平方都是非负的，所以 $\\left(x+\\frac{1}{2}y\\right)^{2} \\geq 0$ 且 $\\frac{3}{4}y^{2} \\geq 0$。因此，它们的和总是非负的：\n$$\nQ(x,y) = x^{2}+xy+y^{2} \\geq 0.\n$$\n$Q(x,y)$ 的最小值在两项同时为零时取得。项 $\\frac{3}{4}y^{2}$ 为零当且仅当 $y=0$。将 $y=0$ 代入第一项，我们得到 $(x+0)^{2} = x^{2}$，它为零当且仅当 $x=0$。因此，$Q(x,y)$ 的下确界是 $0$，并且在点 $(x,y)=(0,0)$ 处取得。\n$$\n\\inf_{x,y \\in \\mathbb{R}} \\{x^{2}+xy+y^{2}\\} = 0.\n$$\n因此，我们不等式左侧的上确界是：\n$$\n\\sup_{x,y \\in \\mathbb{R}} \\{-(x^{2}+xy+y^{2})\\} = -\\inf_{x,y \\in \\mathbb{R}} \\{x^{2}+xy+y^{2}\\} = -0 = 0.\n$$\n最小常数 $L^{\\star}$ 必须大于或等于这个上确界。因此，最小的单边利普希茨常数是 $L^{\\star}=0$。\n\n接下来，我们讨论函数 $b(x)=-x^{3}$ 在 $\\mathbb{R}$ 上是否是全局利普希茨的。如果存在一个非负常数 $K \\in \\mathbb{R}$，使得对所有 $x,y \\in \\mathbb{R}$，以下不等式成立，则函数 $b$ 是全局利普希茨连续的：\n$$\n|b(x)-b(y)| \\leq K\\,|x-y|.\n$$\n对于像 $b(x)$ 这样的可微函数，其成为全局利普希茨的一个必要条件是其导数必须有界。这可以由中值定理得出，该定理指出对于任何 $x \\neq y$，在 $x$ 和 $y$ 之间存在一个点 $c$ 使得：\n$$\n\\frac{b(x)-b(y)}{x-y} = b'(c).\n$$\n如果 $b$ 是具有常数 $K$ 的全局利普希茨函数，我们会有：\n$$\n\\left|\\frac{b(x)-b(y)}{x-y}\\right| \\leq K \\quad \\text{for all } x \\neq y.\n$$\n这意味着对于 $c \\in \\mathbb{R}$ 的所有可能值，都有 $|b'(c)| \\leq K$，即导数 $b'(x)$ 必须是 $\\mathbb{R}$ 上的一个有界函数。\n\n让我们计算 $b(x)=-x^{3}$ 的导数：\n$$\nb'(x) = \\frac{d}{dx}(-x^{3}) = -3x^{2}.\n$$\n我们现在来检验这个导数在 $\\mathbb{R}$上是否有界。导数的绝对值为 $|b'(x)| = |-3x^{2}| = 3x^{2}$。当 $x$ 趋向于无穷大时，$3x^{2}$ 也趋向于无穷大：\n$$\n\\lim_{x \\to \\infty} |b'(x)| = \\lim_{x \\to \\infty} 3x^{2} = \\infty.\n$$\n由于导数的绝对值 $|b'(x)|$ 在 $\\mathbb{R}$ 上是无界的，因此不存在有限常数 $K$ 能满足对所有 $x \\in \\mathbb{R}$ 都有 $|b'(x)| \\leq K$。所以，函数 $b(x)=-x^{3}$ 在 $\\mathbb{R}$ 上不是全局利普希茨连续的。这个结论与其漂移是“超线性”的事实相符，这也是为什么相应的SDE需要像驯服欧拉格式这样的特殊数值方法的原因。\n\n首要任务是报告最小单边利普希茨常数 $L^{\\star}$，我们已确定其值为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3079385"}, {"introduction": "了解了漂移函数的特性后，让我们来看看它对标准数值方法——Euler-Maruyama方法的具体影响。这个练习将引导你从第一性原理出发，推导出该方法在超线性漂移下面临的均方爆炸风险，并让你亲自“驯服”这个方法，通过寻找最小的驯服指数 $p$ 来恢复其稳定性。[@problem_id:3079328]", "problem": "考虑由标准维纳过程（布朗运动）$W_t$ 驱动的一维随机微分方程（SDE），\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t,\\quad b(x) = -x^{3},\\quad \\sigma  0,\n$$\n并固定一个均匀时间步长 $h0$，离散时间为 $t_n = n h$。令 $\\Delta W_n := W_{t_{n+1}} - W_{t_n}$ 表示维纳增量，它满足 $\\mathbb{E}[\\Delta W_n] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^2] = h$。\n\n1. 推导此 SDE 的 Euler–Maruyama 更新式 $X_{n+1} = X_n + h\\,b(X_n) + \\sigma\\,\\Delta W_n$，并从第一性原理出发，得到以 $X_n$、$h$ 和 $\\sigma$ 表示的条件单步均方 $\\mathbb{E}[\\,|X_{n+1}|^{2}\\mid X_n\\,]$ 的表达式。仅使用此表达式和基于 $b(x)$ 多项式增长的渐近推理，解释为何对于固定的 $h0$，当天真的 Euler–Maruyama 方法在 $n\\to\\infty$ 时可能导致 $\\mathbb{E}[\\,|X_{n}|^{2}\\,]$ 无界增长。\n\n2. 为减轻这种超线性漂移效应，考虑由下式定义的驯服欧拉方法（tamed Euler method）：\n$$\nX_{n+1}^{(p)} = X_n + h\\,\\frac{b(X_n)}{1 + h\\,|X_n|^{p}} + \\sigma\\,\\Delta W_n,\n$$\n其中 $p\\in\\mathbb{N}$ 是一个驯服指数。从 $\\Delta W_n$ 的基本性质和更新式的结构出发，确定最小的整数驯服指数 $p$，以确保对于足够大的 $|X_n|$，条件均方按以下意义减小：\n$$\n\\mathbb{E}\\big[\\,|X_{n+1}^{(p)}|^{2}\\,\\big|\\,X_n\\,\\big]  |X_n|^{2},\n$$\n从而使该格式能抵消超线性漂移带来的正贡献，并防止均方爆炸。给出你的最终答案，即 $p$ 的值（一个整数）。", "solution": "我们按顺序解决问题的两个部分。\n\n## 第 1 部分：Euler–Maruyama 方法\n\n一维随机微分方程（SDE）由下式给出\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\n其漂移项为 $b(x) = -x^{3}$，扩散项为 $\\sigma  0$。时间步长为 $h0$ 的 Euler–Maruyama 离散化是 SDE 的直接转写，其中无穷小增量 $\\mathrm{d}X_t$、$\\mathrm{d}t$ 和 $\\mathrm{d}W_t$ 分别被其有限步长对应项 $\\Delta X_n = X_{n+1} - X_n$、$h$ 和 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 替代。\n\n这得到了更新规则：\n$$\nX_{n+1} - X_n = b(X_n)h + \\sigma \\Delta W_n\n$$\n代入 $b(X_n) = -X_n^{3}$，该特定 SDE 的 Euler–Maruyama 更新式为：\n$$\nX_{n+1} = X_n - hX_n^{3} + \\sigma\\Delta W_n\n$$\n为了分析该方法的稳定性，我们计算条件单步均方 $\\mathbb{E}[\\,|X_{n+1}|^{2}\\mid X_n\\,]$。由于 $X_t$ 是一个实值过程，这等价于 $\\mathbb{E}[X_{n+1}^{2}\\mid X_n]$。我们将 $X_n$ 视为一个固定值，因为它属于我们作为条件的信息集 $\\mathcal{F}_{t_n}$。\n\n我们将更新表达式平方：\n$$\nX_{n+1}^{2} = (X_n - hX_n^{3} + \\sigma\\Delta W_n)^{2} = \\big((X_n - hX_n^{3}) + \\sigma\\Delta W_n\\big)^{2}\n$$\n展开平方项得到：\n$$\nX_{n+1}^{2} = (X_n - hX_n^{3})^{2} + 2\\sigma(X_n - hX_n^{3})\\Delta W_n + \\sigma^{2}(\\Delta W_n)^{2}\n$$\n现在，我们对 $X_n$ 取条件期望。我们使用维纳增量 $\\Delta W_n$ 的基本性质：它独立于过去的信息（包括 $X_n$），其均值为零，方差为时间步长 $h$。\n$$\n\\mathbb{E}[\\Delta W_n \\mid X_n] = \\mathbb{E}[\\Delta W_n] = 0\n$$\n$$\n\\mathbb{E}[(\\Delta W_n)^{2} \\mid X_n] = \\mathbb{E}[(\\Delta W_n)^{2}] = h\n$$\n将此应用于 $X_{n+1}^{2}$ 的展开式：\n$$\n\\mathbb{E}[X_{n+1}^{2}\\mid X_n] = \\mathbb{E}\\big[(X_n - hX_n^{3})^{2} \\mid X_n\\big] + 2\\sigma(X_n - hX_n^{3})\\mathbb{E}[\\Delta W_n \\mid X_n] + \\sigma^{2}\\mathbb{E}[(\\Delta W_n)^{2} \\mid X_n]\n$$\n由于在此条件下 $X_n$ 是固定的，表达式简化为：\n$$\n\\mathbb{E}[X_{n+1}^{2}\\mid X_n] = (X_n - hX_n^{3})^{2} + 2\\sigma(X_n - hX_n^{3}) \\cdot 0 + \\sigma^{2}h\n$$\n展开剩余的平方项，我们得到条件单步均方的表达式：\n$$\n\\mathbb{E}[X_{n+1}^{2}\\mid X_n] = X_n^{2} - 2hX_n^{4} + h^{2}X_n^{6} + \\sigma^{2}h\n$$\n为了理解为什么这种格式可能导致数值爆炸，我们考察条件均方从一步到下一步的变化：\n$$\n\\mathbb{E}[X_{n+1}^{2}\\mid X_n] - X_n^{2} = h^{2}X_n^{6} - 2hX_n^{4} + \\sigma^{2}h\n$$\n连续 SDE 有一个漂移项 $-x^3$，它是强均值回归的，将过程拉向原点。在离散化版本中，$-2hX_n^4$ 项代表了这种稳定效应。然而，离散化引入了一个新项 $h^2X_n^6$，它来自于对离散漂移更新 $h b(X_n)$ 的平方。这一项是数值方法的产物。\n\n对于较小的 $|X_n|$ 值，动力学是稳定的。然而，对于大的 $|X_n|$，项 $h^{2}X_n^{6}$ 在表达式中占主导地位。具体来说，它作为 $X_n^6$ 的增长阶数高于稳定项 $-2hX_n^4$。当 $|X_n|$ 变得足够大，以至于 $h^{2}X_n^{6}  2hX_n^{4}$ 时，单步均方中漂移项的净效应变为正且迅速增加。这发生在 $h X_n^2  2$ 时，即 $|X_n|  \\sqrt{2/h}$。一旦过程进入这个区域，其下一个平方值的条件期望会更大，从而形成一个正反馈循环。这导致二阶矩 $\\mathbb{E}[|X_n|^2]$ 对于任何固定的步长 $h0$ 都会在 $n \\to \\infty$ 时无界增长（爆炸）。\n\n## 第 2 部分：驯服欧拉方法\n\n驯服欧拉方法旨在通过修改漂移项来控制这种人为的增长。更新规则是：\n$$\nX_{n+1}^{(p)} = X_n + h\\,\\frac{b(X_n)}{1 + h\\,|X_n|^{p}} + \\sigma\\,\\Delta W_n = X_n - h\\,\\frac{X_n^{3}}{1 + h\\,|X_n|^{p}} + \\sigma\\,\\Delta W_n\n$$\n其中 $p \\in \\mathbb{N}$ 是驯服指数。分母 $1 + h\\,|X_n|^{p}$ “驯服”了对于大 $|X_n|$ 的漂移项。\n\n我们寻求最小的整数 $p$，以确保对于足够大的 $|X_n|$，条件均方减小，即 $\\mathbb{E}\\big[\\,|X_{n+1}^{(p)}|^{2}\\,\\big|\\,X_n\\,\\big]  |X_n|^{2}$。\n\n遵循第 1 部分中的相同步骤，我们找到驯服格式的条件均方：\n$$\n\\mathbb{E}\\big[\\,(X_{n+1}^{(p)})^{2}\\,\\big|\\,X_n\\,\\big] = \\left(X_n - h\\,\\frac{X_n^{3}}{1 + h\\,|X_n|^{p}}\\right)^{2} + \\sigma^{2}h\n$$\n减小的条件变为：\n$$\n\\left(X_n - h\\,\\frac{X_n^{3}}{1 + h\\,|X_n|^{p}}\\right)^{2} + \\sigma^{2}h  X_n^{2}\n$$\n展开平方项并从两侧减去 $X_n^2$，我们得到：\n$$\n-2h\\,\\frac{X_n^{4}}{1 + h\\,|X_n|^{p}} + h^{2}\\,\\frac{X_n^{6}}{\\left(1 + h\\,|X_n|^{p}\\right)^{2}} + \\sigma^{2}h  0\n$$\n为了确定使这个不等式对“足够大的 $|X_n|$”成立的最小整数 $p$，我们在 $|X_n| \\to \\infty$ 时进行渐近分析。令 $x = |X_n|$。由于 $X_n^4 = x^4$ 和 $X_n^6 = x^6$，不等式为：\n$$\n-2h\\,\\frac{x^{4}}{1 + hx^{p}} + h^{2}\\,\\frac{x^{6}}{(1 + hx^{p})^{2}} + \\sigma^{2}h  0\n$$\n对于大的 $x$，我们可以近似分母：$1 + hx^{p} \\sim hx^{p}$。该不等式渐近等价于：\n$$\n-2h\\,\\frac{x^{4}}{hx^{p}} + h^{2}\\,\\frac{x^{6}}{(hx^{p})^{2}} + \\sigma^{2}h \\lesssim 0\n$$\n$$\n-2x^{4-p} + x^{6-2p} + \\sigma^{2}h \\lesssim 0\n$$\n我们需要找到最小的整数 $p \\ge 1$，使得对于大的 $x$，左侧为负。这要求主导项（$x$ 的最高次幂项）为负。我们来考察指数 $4-p$ 和 $6-2p$。\n\n情况 $p=1$：指数为 $4-1=3$ 和 $6-2(1)=4$。主导项是 $x^{4}$，其系数为正 1。表达式趋向于 $+\\infty$。因此，$p=1$ 不足。\n\n情况 $p=2$：指数为 $4-2=2$ 和 $6-2(2)=2$。幂次相等。我们必须将首项系数相加。渐近表达式为 $-2x^{2} + x^{2} = -x^{2}$。此项为负，并且当 $x$ 很大时趋向于 $-\\infty$。因此，对于足够大的 $x$，不等式成立。$p=2$ 是一个有效的解。\n\n让我们对 $p=2$ 的情况进行更严谨的验证：\n$$\n\\lim_{x\\to\\infty} \\left( -2h\\,\\frac{x^{4}}{1 + hx^{2}} + h^{2}\\,\\frac{x^{6}}{(1 + hx^{2})^{2}} + \\sigma^{2}h \\right)\n$$\n分子分母同除以 $x$ 的最高次幂：\n$$\n= \\lim_{x\\to\\infty} \\left( -2h\\,\\frac{x^{2}}{1/x^2 + h} + h^{2}\\,\\frac{x^{2}}{(1/x^2 + h)^{2}} + \\sigma^{2}h \\right)\n$$\n$$\n= \\lim_{x\\to\\infty} \\left( -2h\\,\\frac{x^{2}}{h} + h^{2}\\,\\frac{x^{2}}{h^{2}} \\right) = \\lim_{x\\to\\infty} (-2x^2 + x^2) = \\lim_{x\\to\\infty} (-x^2) = -\\infty\n$$\n由于极限是 $-\\infty$，对于足够大的 $x$，该表达式保证为负。所以 $p=2$ 可行。\n\n情况 $p=3$：指数为 $4-3=1$ 和 $6-2(3)=0$。主导项是 $-2x^{1}$，对于 $x0$ 其为负。表达式趋向于 $-\\infty$。因此，$p=3$ 也可行。\n\n情况 $p \\ge 4$：指数 $4-p$ 小于或等于 $0$，而 $6-2p$ 为负。\n对于 $p=4$，渐近表达式为 $-2x^0 + x^{-2} + \\sigma^2h \\to -2+\\sigma^2h$。这并不能保证对于所有 $h, \\sigma  0$ 都为负。\n对于 $p4$， $4-p$ 和 $6-2p$ 均为负，所以当 $x \\to \\infty$ 时前两项消失。表达式的极限是 $\\sigma^2h  0$。\n因此，只有 $p=2$ 和 $p=3$ 满足条件。\n\n问题要求最小的整数驯服指数 $p$。比较有效的解 $p=2$ 和 $p=3$，最小值为 $p=2$。", "answer": "$$\\boxed{2}$$", "id": "3079328"}, {"introduction": "为了更清晰地量化标准方法与驯服方法之间的差异，本练习引入了一个强大的分析工具：条件二阶矩放大因子。通过为Euler–Maruyama方法和驯服Euler方法分别计算该因子，你将能直接看到数值爆炸的根源，并从数学上精确理解驯服机制是如何控制这种不稳定性的。[@problem_id:3079369]", "problem": "考虑标量随机微分方程 $dX_{t} = a\\,X_{t}^{3}\\,dt + b\\,X_{t}\\,dW_{t}$，其定义在 $[0,T]$ 上，初始条件为 $X_{0}=x_{0}$，其中 $a0$，$b\\neq 0$，$W_{t}$ 是标准布朗运动。令 $\\{t_{n}\\}_{n=0}^{N}$ 为步长 $h=T/N$ 的均匀网格。定义两种时间离散化方法：\n\n1. Euler–Maruyama (EM) 方法：对于 $n=0,1,\\dots,N-1$，\n$$\nY^{\\mathrm{em}}_{n+1} = Y^{\\mathrm{em}}_{n} + a\\,(Y^{\\mathrm{em}}_{n})^{3}\\,h + b\\,Y^{\\mathrm{em}}_{n}\\,\\Delta W_{n}, \\quad \\Delta W_{n} := W_{t_{n+1}} - W_{t_{n}}.\n$$\n\n2. 驯服欧拉方法，即通过有理因子驯服漂移项：\n$$\nY^{\\mathrm{te}}_{n+1} = Y^{\\mathrm{te}}_{n} + \\frac{a\\,(Y^{\\mathrm{te}}_{n})^{3}\\,h}{1 + h\\,|a\\,(Y^{\\mathrm{te}}_{n})^{3}|} + b\\,Y^{\\mathrm{te}}_{n}\\,\\Delta W_{n}.\n$$\n\n在固定的时间步长 $h0$ 和单步 $n\\mapsto n+1$ 的情况下进行分析。仅使用布朗运动增量的定义性质（即 $\\Delta W_{n}\\sim \\mathcal{N}(0,h)$，独立于过去，且 $\\mathbb{E}[\\Delta W_{n}]=0$ 和 $\\mathbb{E}[(\\Delta W_{n})^{2}]=h$），执行以下操作：\n\n- 通过推导当期状态为 $x\\neq 0$ 时 EM 更新的条件二阶矩放大因子，为 Euler–Maruyama 方法的矩有界性构建一个具体反例，\n$$\nR_{\\mathrm{em}}(x,h) := \\frac{\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{em}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{em}}_{n}=x\\,\\right]}{x^{2}}.\n$$\n\n- 通过推导大状态极限条件二阶矩放大因子，将其与驯服欧拉方法进行对比\n$$\nR_{\\mathrm{te}}^{\\infty}(h) := \\lim_{|x|\\to\\infty}\\frac{\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{te}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{te}}_{n}=x\\,\\right]}{x^{2}}.\n$$\n\n解释这两个表达式如何共同为超线性漂移下的 Euler–Maruyama 方法的矩有界性提供了一个反例，并说明为什么驯服方法能够恢复有界放大。你的最终答案必须是一个双元行矩阵，其第一个元素是 $R_{\\mathrm{em}}(x,h)$ 的精确表达式，第二个元素是 $R_{\\mathrm{te}}^{\\infty}(h)$ 的精确表达式。无需数值近似；请提供以 $a$、$b$、$h$ 和 $x$ 表示的闭式表达式。", "solution": "我们首先分析 Euler–Maruyama (EM) 方法。任务是计算条件二阶矩放大因子，其定义为：\n$$\nR_{\\mathrm{em}}(x,h) := \\frac{\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{em}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{em}}_{n}=x\\,\\right]}{x^{2}}\n$$\n给定更新规则 $Y^{\\mathrm{em}}_{n+1} = Y^{\\mathrm{em}}_{n} + a\\,(Y^{\\mathrm{em}}_{n})^{3}\\,h + b\\,Y^{\\mathrm{em}}_{n}\\,\\Delta W_{n}$ 并在 $Y^{\\mathrm{em}}_{n}=x$ 的条件下，我们有：\n$$\nY^{\\mathrm{em}}_{n+1} = x + a\\,x^{3}\\,h + b\\,x\\,\\Delta W_{n}\n$$\n我们计算其平方的条件期望。由于状态空间是实数线，因此 $|z|^{2} = z^{2}$。\n$$\n\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{em}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{em}}_{n}=x\\,\\right] = \\mathbb{E}\\!\\left[\\,\\left( (x + a\\,x^{3}\\,h) + b\\,x\\,\\Delta W_{n} \\right)^{2}\\,\\right]\n$$\n展开平方得到三项：\n$$\n\\mathbb{E}\\!\\left[\\, (x + a\\,x^{3}\\,h)^{2} + 2\\,(x + a\\,x^{3}\\,h)\\,(b\\,x\\,\\Delta W_{n}) + (b\\,x\\,\\Delta W_{n})^{2} \\,\\right]\n$$\n利用期望的线性性质，我们可以计算每一项。项 $(x + a\\,x^{3}\\,h)^{2}$ 相对于条件是确定性的。增量 $\\Delta W_{n}$ 独立于过去（因此也独立于 $x=Y^{\\mathrm{em}}_{n}$），且有 $\\mathbb{E}[\\Delta W_{n}]=0$ 和 $\\mathbb{E}[(\\Delta W_{n})^{2}]=h$。\n$$\n\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{em}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{em}}_{n}=x\\,\\right] = (x + a\\,x^{3}\\,h)^{2} + 0 + b^{2}\\,x^{2}\\,h\n$$\n现在，我们展开第一项，$(x + a\\,x^{3}\\,h)^{2} = x^{2}\\,(1 + a\\,x^{2}\\,h)^{2} = x^{2}\\,(1 + 2\\,a\\,x^{2}\\,h + a^{2}\\,x^{4}\\,h^{2})$。\n因此，条件二阶矩为：\n$$\n\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{em}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{em}}_{n}=x\\,\\right] = x^{2}\\,(1 + 2\\,a\\,x^{2}\\,h + a^{2}\\,x^{4}\\,h^{2}) + b^{2}\\,x^{2}\\,h\n$$\n为了求出放大因子 $R_{\\mathrm{em}}(x,h)$，我们将其除以 $x^{2}$（因为 $x \\neq 0$）：\n$$\nR_{\\mathrm{em}}(x,h) = (1 + 2\\,a\\,x^{2}\\,h + a^{2}\\,x^{4}\\,h^{2}) + b^{2}\\,h = 1 + b^{2}\\,h + 2\\,a\\,h\\,x^{2} + a^{2}\\,h^{2}\\,x^{4}\n$$\n该表达式表明，EM 方法的放大因子以状态 $x$ 的多项式形式增长，具体为 $O(x^{4})$。对于任何固定的步长 $h0$，当 $|x| \\to \\infty$ 时，$R_{\\mathrm{em}}(x,h) \\to \\infty$。这种无界放大导致了将 EM 方法应用于具有超线性漂移的 SDE 时特有的数值不稳定性和矩爆炸现象。\n\n接下来，我们分析驯服欧拉（TE）方法。任务是计算大状态极限放大因子：\n$$\nR_{\\mathrm{te}}^{\\infty}(h) := \\lim_{|x|\\to\\infty}\\frac{\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{te}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{te}}_{n}=x\\,\\right]}{x^{2}}\n$$\n在 $Y^{\\mathrm{te}}_{n}=x$ 的条件下，TE 更新规则为：\n$$\nY^{\\mathrm{te}}_{n+1} = x + \\frac{a\\,x^{3}\\,h}{1 + h\\,|a\\,x^{3}|} + b\\,x\\,\\Delta W_{n}\n$$\n我们遵循相同的过程来计算条件二阶矩。令漂移分量为 $D_{\\mathrm{te}}(x) = x + \\frac{a\\,x^{3}\\,h}{1 + h\\,|a\\,x^{3}|}$。计算在结构上与 EM 情况相同：\n$$\n\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{te}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{te}}_{n}=x\\,\\right] = \\mathbb{E}\\!\\left[\\, (D_{\\mathrm{te}}(x) + b\\,x\\,\\Delta W_{n})^{2} \\,\\right] = (D_{\\mathrm{te}}(x))^{2} + b^{2}\\,x^{2}\\,h\n$$\n代入 $D_{\\mathrm{te}}(x)$ 的表达式：\n$$\n\\mathbb{E}\\!\\left[\\,|Y^{\\mathrm{te}}_{n+1}|^{2}\\,\\big|\\,Y^{\\mathrm{te}}_{n}=x\\,\\right] = \\left(x + \\frac{a\\,x^{3}\\,h}{1 + h\\,|a\\,x^{3}|}\\right)^{2} + b^{2}\\,x^{2}\\,h\n$$\n相应的放大因子 $R_{\\mathrm{te}}(x,h)$ 可通过除以 $x^{2}$ 得到：\n$$\nR_{\\mathrm{te}}(x,h) = \\frac{1}{x^{2}}\\left(x + \\frac{a\\,x^{3}\\,h}{1 + h\\,|a\\,x^{3}|}\\right)^{2} + b^{2}\\,h = \\left(1 + \\frac{a\\,x^{2}\\,h}{1 + h\\,|a\\,x^{3}|}\\right)^{2} + b^{2}\\,h\n$$\n因为 $a0$，我们有 $|a\\,x^{3}| = a\\,|x|^{3}$。表达式变为：\n$$\nR_{\\mathrm{te}}(x,h) = \\left(1 + \\frac{a\\,x^{2}\\,h}{1 + a\\,h\\,|x|^{3}}\\right)^{2} + b^{2}\\,h\n$$\n我们现在取 $|x|\\to\\infty$ 的极限：\n$$\nR_{\\mathrm{te}}^{\\infty}(h) = \\lim_{|x|\\to\\infty} \\left[ \\left(1 + \\frac{a\\,x^{2}\\,h}{1 + a\\,h\\,|x|^{3}}\\right)^{2} + b^{2}\\,h \\right]\n$$\n关键项是括号内的分数。当 $|x|\\to\\infty$ 时，阶数为 $O(|x|^{3})$ 的分母比阶数为 $O(x^{2})$ 的分子增长得更快。因此：\n$$\n\\lim_{|x|\\to\\infty} \\frac{a\\,x^{2}\\,h}{1 + a\\,h\\,|x|^{3}} = 0\n$$\n将此极限代入 $R_{\\mathrm{te}}^{\\infty}(h)$ 的表达式中：\n$$\nR_{\\mathrm{te}}^{\\infty}(h) = (1 + 0)^{2} + b^{2}\\,h = 1 + b^{2}\\,h\n$$\n结果 $R_{\\mathrm{em}}(x,h) = 1 + b^{2}\\,h + 2\\,a\\,h\\,x^{2} + a^{2}\\,h^{2}\\,x^{4}$ 为 EM 方法的矩有界性提供了反例。对于任何 $h0$，二阶矩的放大作为状态 $x$ 的函数是无界的。如果模拟达到一个大状态，下一个状态的期望平方值将灾难性地变得更大，从而导致发散。相比之下，结果 $R_{\\mathrm{te}}^{\\infty}(h) = 1 + b^{2}\\,h$ 表明，对于驯服欧拉方法，放大因子对所有状态 $x$ 都是有界的，并在 $|x|$ 很大时趋于一个常数。这种有界放大是恢复对数值解的矩的控制、防止爆炸行为并允许证明矩有界性的关键属性。驯服方法通过用一个有界函数替换无界漂移函数来实现；驯服漂移增量 $\\frac{a\\,(Y^{\\mathrm{te}}_{n})^{3}\\,h}{1 + h\\,|a\\,(Y^{\\mathrm{te}}_{n})^{3}|}$ 的大小以 $1/h$ 为界，这消除了不稳定的根源。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 + b^{2}h + 2ahx^{2} + a^{2}h^{2}x^{4}  1 + b^{2}h\n\\end{pmatrix}\n}\n$$", "id": "3079369"}]}