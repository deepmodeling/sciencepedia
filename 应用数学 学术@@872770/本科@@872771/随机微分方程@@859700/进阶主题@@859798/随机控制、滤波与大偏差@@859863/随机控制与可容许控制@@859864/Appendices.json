{"hands_on_practices": [{"introduction": "在控制理论中，我们对于最优解存在的直觉有时会失效。本练习通过一个看似简单的确定性系统，揭示了一个深刻的问题：最优策略有时可能是一种“无穷快”的切换行为，而这种行为无法用普通函数来描述。这个例子启发我们思考“容许控制”的局限性，并引出了松弛控制（relaxed controls）这一重要概念，它扩展了我们对可行解的理解。[@problem_id:3077006]", "problem": "考虑受控随机微分方程（本例中，由于没有扩散项，该方程是确定性的）\n$$\ndX_t \\;=\\; u_t\\,dt,\\qquad X_0 \\;=\\; 0,\\qquad t \\in [0,T],\n$$\n其中 $T0$ 是一个固定的时间。普通容许控制集由所有在控制集 $U=\\{-1,1\\}$ 中取值的可测过程 $u_t$ 组成。性能指标为\n$$\nJ(u) \\;=\\; \\mathbb{E}\\!\\left[\\int_0^T |X_t|\\,dt\\right],\n$$\n其中期望是关于底层概率空间的（由于没有噪声，此处是退化的）。松弛控制是一个在 $U$ 上的概率测度集中取值的循序可测过程 $\\mu_t$，其松弛状态动力学为\n$$\ndX_t \\;=\\; \\int_U u\\,\\mu_t(du)\\,dt,\\qquad X_0 \\;=\\; 0.\n$$\n你的任务是：\n- 仅使用上述定义和积分的基本性质，证明在普通容许控制中，不存在使 $J(u)$ 最小化的最优控制，尽管 $J(u)$ 在普通容许控制上的下确界是存在的。\n- 给出一个达到下确界的容许松弛控制 $\\mu_t$，从而提供一个最优松弛控制。\n- 计算在松弛控制下性能指标的最小值。你的最终答案必须是一个实数或一个闭式解析表达式，无需单位。", "solution": "该问题要求对一个最优控制问题进行分析，证明在普通容许控制类中不存在最优控制，而在松弛控制类中存在最优控制。\n\n状态动力学由以下常微分方程给出：\n$$\ndX_t = u_t dt, \\quad X_0 = 0, \\quad t \\in [0,T]\n$$\n对于一个固定的终端时刻 $T0$。因此，在时刻 $t$ 的状态是 $X_t = \\int_0^t u_s ds$。\n\n要最小化的性能指标是：\n$$\nJ(u) = \\mathbb{E}\\left[\\int_0^T |X_t|\\,dt\\right]\n$$\n由于系统动力学是确定性的（没有扩散项），对于给定的控制 $u_t$，轨迹 $X_t$ 是一条确定性路径。因此，期望算子是多余的，代价泛函简化为：\n$$\nJ(u) = \\int_0^T |X_t|\\,dt = \\int_0^T \\left|\\int_0^t u_s ds\\right| dt\n$$\n普通容许控制集 $\\mathcal{U}_{ord}$ 由所有在离散集 $U = \\{-1, 1\\}$ 中取值的可测过程 $u_t$ 组成。\n\n### 第一部分：普通最优控制的不存在性\n\n首先，我们确定代价 $J(u)$ 在普通容许控制集 $\\mathcal{U}_{ord}$ 上的下确界。被积函数 $|X_t|$ 总是非负的，所以对于任何控制 $u$，都有 $J(u) \\ge 0$。因此，下确界也是非负的。\n\n为了找到下确界的值，我们构造一个“抖振”控制序列 $\\{u_n\\}_{n \\in \\mathbb{N}}$，它使状态 $X_t$ 在 $0$ 附近快速振荡。对于每个整数 $n \\ge 1$，定义控制 $u_n(t)$ 在长度为 $\\epsilon_n = \\frac{T}{2n}$ 的区间上交替取值 $+1$ 和 $-1$：\n$$\nu_n(t) = \\begin{cases} +1  \\text{if } t \\in [k \\cdot 2\\epsilon_n, (k \\cdot 2 + 1)\\epsilon_n) \\\\ -1  \\text{if } t \\in [(k \\cdot 2 + 1)\\epsilon_n, (k \\cdot 2 + 2)\\epsilon_n) \\end{cases}\n$$\n对于 $k = 0, 1, \\dots, n-1$，最后一个区间在 $T$ 处闭合。\n\n我们来分析对应于 $u_n(t)$ 的轨迹 $X_t^{(n)}$。\n对于 $t \\in [0, \\epsilon_n]$，$X_t^{(n)} = \\int_0^t 1 ds = t$。最大值为 $X_{\\epsilon_n}^{(n)} = \\epsilon_n$。\n对于 $t \\in [\\epsilon_n, 2\\epsilon_n]$，$X_t^{(n)} = X_{\\epsilon_n}^{(n)} + \\int_{\\epsilon_n}^t (-1) ds = \\epsilon_n - (t - \\epsilon_n) = 2\\epsilon_n - t$。在 $t=2\\epsilon_n$ 时，$X_{2\\epsilon_n}^{(n)} = 0$。\n从 $t=0$ 到 $t=2\\epsilon_n$ 的轨迹形成一个高为 $\\epsilon_n$、底为 $2\\epsilon_n$ 的三角脉冲。这个模式在区间 $[0, T]$ 上重复 $n$ 次。$|X_t^{(n)}|$ 在 $[0,T]$ 上的最大值是 $\\epsilon_n = \\frac{T}{2n}$。\n\n控制 $u_n(t)$ 的代价是这 $n$ 个三角形的面积之和：\n$$\nJ(u_n) = \\int_0^T |X_t^{(n)}|\\,dt = n \\times \\left(\\text{Area of one triangle}\\right)\n$$\n一个三角形的面积是 $\\int_0^{2\\epsilon_n} |X_t^{(n)}|\\,dt = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} (2\\epsilon_n)(\\epsilon_n) = \\epsilon_n^2$。\n所以，总代价是：\n$$\nJ(u_n) = n \\cdot \\epsilon_n^2 = n \\left(\\frac{T}{2n}\\right)^2 = n \\frac{T^2}{4n^2} = \\frac{T^2}{4n}\n$$\n当我们令 $n \\to \\infty$ 时，代价趋近于零：\n$$\n\\lim_{n \\to \\infty} J(u_n) = \\lim_{n \\to \\infty} \\frac{T^2}{4n} = 0\n$$\n由于我们找到了一个容许控制序列，其代价趋近于 $0$，并且我们知道 $J(u) \\ge 0$，因此可以断定下确界为 $0$：\n$$\n\\inf_{u \\in \\mathcal{U}_{ord}} J(u) = 0\n$$\n现在，我们必须证明没有普通容许控制能真正达到这个值。要使代价为 $0$，我们必须有 $J(u) = \\int_0^T |X_t| dt = 0$。\n状态 $X_t = \\int_0^t u_s ds$ 是一个关于 $t$ 的绝对连续函数，因此是连续的。因此，函数 $t \\mapsto |X_t|$ 也是连续且非负的。对于一个非负连续函数的积分为零，该函数本身必须恒等于零。即：\n$$\n|X_t| = 0 \\quad \\implies \\quad X_t = 0 \\quad \\text{for all } t \\in [0, T]\n$$\n如果对于所有 $t \\in [0,T]$ 都有 $X_t = \\int_0^t u_s ds = 0$，那么它关于 $t$ 的导数必须为零。根据勒贝格积分的基本定理，这意味着对于几乎所有的 $t \\in [0,T]$，都有 $\\dot{X}_t = u_t = 0$。\n然而，普通容许控制集被定义为 $u_t$ 必须在 $U = \\{-1, 1\\}$ 中取值。值 $0$ 不在这个集合中。一个可测函数 $u_t: [0, T] \\to \\{-1, 1\\}$ 不可能在一个正测度集上等于 $0$，更不用说几乎处处等于 $0$ 了。\n这产生了一个矛盾。因此，不存在能使 $X_t$ 恒等于零的普通容许控制 $u_t$，从而没有普通控制可以达到 $0$ 这个下确界代价。我们得出结论，在普通容许控制空间中不存在最优控制。\n\n### 第二部分：最优松弛控制的存在性\n\n松弛控制是一个在 $U$ 上的概率测度集中取值的过程 $\\mu_t$。松弛状态动力学由以下公式给出：\n$$\ndX_t = \\left(\\int_U u\\,\\mu_t(du)\\right) dt, \\quad X_0 = 0\n$$\n我们将有效控制记为 $v_t = \\int_U u\\,\\mu_t(du)$。在 $U=\\{-1,1\\}$ 上的概率测度 $\\mu_t$ 可以写成 $\\mu_t = \\alpha_t \\delta_{1} + (1-\\alpha_t)\\delta_{-1}$ 的形式，其中 $\\alpha_t \\in [0,1]$ 是某个可测过程，$\\delta_c$ 是在点 $c$ 处的狄拉克测度。那么有效控制是：\n$$\nv_t = (+1)\\alpha_t + (-1)(1-\\alpha_t) = 2\\alpha_t - 1\n$$\n当 $\\alpha_t$ 在 $[0,1]$ 上取值时，$v_t$ 在区间 $[-1,1]$ 上取值。这个区间是原始控制集 $U$ 的凸包，即 $v_t \\in \\text{conv}(U) = [-1,1]$。因此，松弛控制问题等价于寻找一个可测控制函数 $v_t: [0,T] \\to [-1,1]$，使得 $J(v) = \\int_0^T |X_t| dt$ 最小化，其中 $X_t = \\int_0^t v_s ds$。\n\n代价的下确界仍然是 $0$。我们寻求一个达到该值的松弛控制。如前所述，代价为 $0$ 要求对于所有 $t$ 都有 $X_t = 0$，这反过来要求有效控制对于几乎所有的 $t \\in [0,T]$ 都是 $v_t = 0$。\n控制 $v_t = 0$ 是一个容许的松弛控制，因为 $0 \\in [-1,1]$。使用这个控制，状态轨迹对于所有 $t$ 都是 $X_t = \\int_0^t 0 \\,ds = 0$。代价是 $J(v) = \\int_0^T |0| dt = 0$。\n由于该控制达到了下确界值 $0$，它是一个最优松弛控制。\n\n为了展示最优松弛控制 $\\mu_t$，我们必须找到 $\\alpha_t$ 使得 $v_t = 2\\alpha_t - 1 = 0$。这得到 $\\alpha_t = 1/2$。$\\alpha_t$ 的最优选择是常数函数 $\\alpha_t = 1/2$，适用于所有 $t \\in [0,T]$。\n这对应于在时间上恒定的松弛控制过程 $\\mu_t^*$：\n$$\n\\mu_t^* = \\frac{1}{2}\\delta_{1} + \\frac{1}{2}\\delta_{-1}, \\quad \\text{for all } t \\in [0,T]\n$$\n该控制是循序可测的（因为它是常数），并在 $U$ 上的概率测度集中取值。因此，它是一个最优松弛控制。这个控制代表了在值 $-1$ 和 $1$ 之间无限快的抖振，在每个值上花费相等的时间。\n\n### 第三部分：性能指标的最小值\n\n最优松弛控制策略 $v_t = 0$ (对于 $t \\in [0,T]$) 产生的状态轨迹为 $X_t = 0$ (对于所有 $t \\in [0,T]$)。\n性能指标的最小值是针对此最优策略评估的 $J(u)$ 的值：\n$$\n\\min J = J(\\mu_t^*) = \\int_0^T |X_t^*|\\,dt = \\int_0^T |0|\\,dt = 0\n$$\n性能指标的最小值为 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3077006"}, {"introduction": "在最优化问题中，寻找最小值之前，我们必须首先确保最小值是存在的且是有限的。本练习探讨了一个违反标准假设的线性二次（LQ）调节器问题，它是一个重要的警示案例。通过展示问题設定中的一个微小改动（将控制成本权重变为负数）如何导致一个无下界的最优值，它强调了检查理论假设的重要性，并帮助我们理解“适定”（well-posed）问题在控制理论中的核心地位。[@problem_id:3077858]", "problem": "考虑一个在有限时间域 $[0,1]$ 上由标准布朗运动驱动的标量随机微分方程 (SDE)。设状态过程 $(x_t)_{t \\in [0,1]}$ 满足\n$$\n\\mathrm{d}x_t = u_t \\,\\mathrm{d}t + \\mathrm{d}W_t, \\qquad x_0 = 0,\n$$\n其中 $(u_t)_{t \\in [0,1]}$ 是一个控制过程。一个容许控制是任何满足如下条件的实值循序可测过程 $(u_t)_{t \\in [0,1]}$：\n$$\n\\mathbb{E}\\!\\left[\\int_0^1 |u_t|^2 \\,\\mathrm{d}t\\right]  \\infty.\n$$\n考虑一个随机线性二次调节问题，其运行成本矩阵系数为 $Q=0$ 和 $R=-1$，且无终端成本，因此性能指标为\n$$\nJ(u) = \\mathbb{E}\\!\\left[\\int_0^1 \\left(0 \\cdot x_t^2 + (-1)\\, u_t^2\\right)\\mathrm{d}t\\right] = -\\,\\mathbb{E}\\!\\left[\\int_0^1 u_t^2\\,\\mathrm{d}t\\right].\n$$\n仅使用上述容许控制和性能指标的基本定义，构造一个显式的容许控制序列，以证明当 $R$ 不是正定时，成本可以变得任意负。然后确定在所有容许控制上的下确界\n$$\nJ^{\\star} := \\inf_{u} J(u)\n$$\n。将你的最终答案表示为 $J^{\\star}$ 的单个符号表达式，无需单位。", "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 状态动态：$\\mathrm{d}x_t = u_t \\,\\mathrm{d}t + \\mathrm{d}W_t$\n- 时间域：$t \\in [0,1]$\n- 初始条件：$x_0 = 0$\n- 驱动过程：$(W_t)_{t \\in [0,1]}$ 是一个标准布朗运动。\n- 控制过程：$(u_t)_{t \\in [0,1]}$\n- 容许性条件：$(u_t)$ 是一个实值循序可测过程，满足 $\\mathbb{E}\\!\\left[\\int_0^1 |u_t|^2 \\,\\mathrm{d}t\\right]  \\infty$。\n- 性能指标 (成本泛函)：$J(u) = \\mathbb{E}\\!\\left[\\int_0^1 \\left(0 \\cdot x_t^2 + (-1)\\, u_t^2\\right)\\mathrm{d}t\\right] = -\\,\\mathbb{E}\\!\\left[\\int_0^1 u_t^2\\,\\mathrm{d}t\\right]$。\n- 目标：构造一个容许控制序列以证明成本可以任意负，并确定下确界 $J^{\\star} := \\inf_{u} J(u)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题描述了一个随机线性二次 (LQ) 调节问题。状态动态是线性的，成本泛函是关于控制的二次函数。关键特征是控制加权矩阵，这里是一个标量 $R$，被给出为 $R=-1$。标准的 LQ 理论要求 $R$ 是正定的 ($R0$)，以构成一个适定的最小化问题，从而通过 Riccati 方程得到一个有限的最小成本和一个唯一的最优控制。所陈述的问题，由于 $R=-1$，违反了这一标准假设。然而，这并非问题表述的缺陷。相反，它定义了一个特定的、非典型的情景，并要求推导其逻辑结果。问题是确定成本的下确界，而不是找到一个能达到该下确界的最优控制。该问题在控制理论中有科学依据，其对下确界的要求是适定的、客观的且内部一致的。这是一个有效的数学问题，旨在探讨 LQ 理论的边界条件。\n\n**步骤 3：结论与行动**\n问题被判定为有效。将构造一个解。\n\n目标是确定性能指标 $J(u)$ 在所有容许控制 $u$ 上的下确界。性能指标由下式给出：\n$$\nJ(u) = -\\,\\mathbb{E}\\!\\left[\\int_0^1 u_t^2\\,\\mathrm{d}t\\right].\n$$\n容许控制的集合包含所有满足以下条件的实值循序可测过程 $(u_t)_{t \\in [0,1]}$：\n$$\n\\mathbb{E}\\!\\left[\\int_0^1 u_t^2 \\,\\mathrm{d}t\\right]  \\infty.\n$$\n提供状态方程 $\\mathrm{d}x_t = u_t \\,\\mathrm{d}t + \\mathrm{d}W_t$ 和 $x_0 = 0$ 是为了将问题置于随机控制问题的背景下。然而，由于状态加权矩阵 $Q=0$，状态过程 $(x_t)$ 并未出现在成本泛函中。因此，问题简化为仅在 $u_t$ 的容许性条件下分析成本泛函 $J(u)$。\n\n找到 $J^{\\star} = \\inf_u J(u)$ 的任务等价于找到 $-\\,\\mathbb{E}\\!\\left[\\int_0^1 u_t^2\\,\\mathrm{d}t\\right]$ 的下确界。这又等价于求解 $-\\sup_u \\mathbb{E}\\!\\left[\\int_0^1 u_t^2\\,\\mathrm{d}t\\right]$，其中上确界是在所有容许控制的集合上取得的。\n\n为了证明成本可以变得任意负，我们将构造一个容许控制序列，记为 $\\{u^{(n)}\\}_{n=1}^{\\infty}$，使得 $\\lim_{n \\to \\infty} J(u^{(n)}) = -\\infty$。\n\n考虑为每个整数 $n \\ge 1$ 定义的确定性控制策略序列：\n$$\nu^{(n)}_t = n \\quad \\text{for all } t \\in [0,1].\n$$\n我们必须首先验证每个 $u^{(n)}$ 都是一个容许控制。\n1. 一个时间的确定性函数，例如一个常数，对于任何信息流（filtration），包括由布朗运动 $(W_t)$ 生成的信息流，都是循序可测的。\n2. 我们检查可积性条件：\n$$\n\\mathbb{E}\\!\\left[\\int_0^1 \\left(u^{(n)}_t\\right)^2 \\,\\mathrm{d}t\\right] = \\mathbb{E}\\!\\left[\\int_0^1 n^2 \\,\\mathrm{d}t\\right] = \\mathbb{E}[n^2] = n^2.\n$$\n由于 $n$ 是一个有限整数，$n^2$ 是一个有限实数。因此，对于每个 $n$，条件 $\\mathbb{E}\\!\\left[\\int_0^1 u_t^2 \\,\\mathrm{d}t\\right]  \\infty$ 都得到满足。\n因此，对于每个 $n \\in \\{1, 2, 3, \\dots\\}$，$u^{(n)}_t = n$ 都是一个容许控制。\n\n接下来，我们为这个控制序列计算成本泛函 $J(u^{(n)})$：\n$$\nJ(u^{(n)}) = -\\,\\mathbb{E}\\!\\left[\\int_0^1 \\left(u^{(n)}_t\\right)^2 \\,\\mathrm{d}t\\right] = -n^2.\n$$\n我们构造了一个容许控制序列 $\\{u^{(n)}\\}$，其相应的成本为 $J(u^{(n)}) = -n^2$。\n当 $n$ 趋向于无穷大时，成本的绝对值变得任意大且符号为负：\n$$\n\\lim_{n \\to \\infty} J(u^{(n)}) = \\lim_{n \\to \\infty} (-n^2) = -\\infty.\n$$\n这证明了对于任何实数 $M  0$，我们都可以找到一个容许控制 $u$ 使得 $J(u)  M$。具体来说，我们可以选择一个整数 $n > \\sqrt{-M}$，那么控制 $u^{(n)}_t = n$ 将产生一个成本 $J(u^{(n)}) = -n^2  M$。\n\n一个没有下界的实数集合的下确界，根据定义，是 $-\\infty$。由于可能的成本值集合 $\\{ J(u) \\mid u \\text{ 是容许的} \\}$ 没有下界，其下确界为 $-\\infty$。\n\n因此，性能指标的下确界是\n$$\nJ^{\\star} = \\inf_{u} J(u) = -\\infty.\n$$\n这个结果突显了为什么在标准 LQ 理论中，条件 $R0$ 对于确保一个具有有限值解的适定最小化问题至关重要。当这个条件被违反时，如此处的 $R=-1$ 的情况，控制器会被激励使用无限大的控制作用，以将成本驱动至 $-\\infty$。", "answer": "$$\n\\boxed{-\\infty}\n$$", "id": "3077858"}, {"introduction": "一旦确定了一个适定的随机控制问题，哈密顿-雅可比-贝尔曼（HJB）方程就成为了求解最优策略的强大工具。本练习将动态规划方法应用于一个经典的随机线性二次问题，并通过对比“风险中性”与“风险敏感”两种不同的目标函数，展示了该框架的威力与灵活性。通过求解相应的代数Riccati方程，你将亲身体会风险态度如何从数学上改变最优反馈策略，从而加深对随机最优控制核心思想的理解。[@problem_id:3077001]", "problem": "考虑标量受控 Itô 随机微分方程 (SDE)\n$$\n\\mathrm{d}x_{t} = a\\, x_{t}\\, \\mathrm{d}t + b\\, u_{t}\\, \\mathrm{d}t + \\sigma\\, \\mathrm{d}W_{t},\n$$\n其中 $W_{t}$ 是标准维纳过程，$a$、$b$ 和 $\\sigma$ 是固定的实常数。要求控制 $u_{t}$ 在以下意义上是容许的：它关于由 $W_{t}$ 生成的 σ-代数族是循序可测的，并且满足\n$$\n\\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\exp(-\\gamma t)\\, u_{t}^{2}\\, \\mathrm{d}t\\right]  \\infty\n$$\n对于固定的折扣率 $\\gamma  0$。取 $a = 1$、$b = 1$、$ \\sigma = 1$ 和 $\\gamma = 1$。\n\n在 $q=1$ 和 $r=1$ 的情况下，比较该系统在以下两种无限时域折扣性能准则下的风险中性和风险敏感最优状态反馈：\n\n1. 风险中性准则：\n$$\nJ_{0}(u) = \\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\exp(-\\gamma t)\\, \\big(q\\, x_{t}^{2} + r\\, u_{t}^{2}\\big)\\, \\mathrm{d}t\\right].\n$$\n\n2. 风险敏感准则，参数 $\\theta  0$：\n$$\nJ_{\\theta}(u) = \\frac{1}{\\theta}\\, \\ln\\, \\mathbb{E}\\!\\left[\\exp\\!\\left(\\theta \\int_{0}^{\\infty} \\exp(-\\gamma t)\\, \\big(q\\, x_{t}^{2} + r\\, u_{t}^{2}\\big)\\, \\mathrm{d}t\\right)\\right],\n$$\n其中 $\\theta = \\frac{1}{4}$。\n\n从容许控制的定义和受控扩散过程的动态规划原理出发，写出在静态马尔可夫反馈 $u_{t} = -K x_{t}$ 下值函数对应的 Hamilton–Jacobi–Bellman (HJB) 方程。然后，使用形式为 $V(x) = P x^{2} + C$（其中常数 $P  0$ 且 $C \\in \\mathbb{R}$）的值函数二次拟设，推导在风险中性和风险敏感情况下确定 $P$ 的代数方程，并显式求解。推导出每种情况下的最优增益 $K_{0}$ 和 $K_{\\theta}$。\n\n假设 $K$ 必须使闭环漂移 $a - bK$ 使得过程均方稳定，从而保证控制是容许的。将你的最终答案以包含两个增益 $\\big(K_{0}, K_{\\theta}\\big)$ 的行矩阵形式给出，要求是精确的解析形式。不需要数值取整，也不涉及单位。", "solution": "我们考虑标量受控 Itô SDE\n$$\n\\mathrm{d}x_{t} = a\\, x_{t}\\, \\mathrm{d}t + b\\, u_{t}\\, \\mathrm{d}t + \\sigma\\, \\mathrm{d}W_{t},\n$$\n其中 $a=1$，$b=1$ 和 $\\sigma=1$。容许控制是关于由 $W_{t}$ 生成的 σ-代数族的循序可测过程 $u_{t}$，且满足\n$$\n\\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\exp(-\\gamma t)\\, u_{t}^{2}\\, \\mathrm{d}t\\right]  \\infty,\n$$\n其中 $\\gamma=1$。我们分析形式为 $u_{t} = -K x_{t}$ 的静态马尔可夫反馈，并在两种准则下寻求最优的 $K$。\n\n对于受控扩散过程，动态规划原理给出了值函数的 Hamilton–Jacobi–Bellman (HJB) 方程。对于风险中性折扣二次成本\n$$\nJ_{0}(u) = \\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\exp(-\\gamma t)\\, \\big(q\\, x_{t}^{2} + r\\, u_{t}^{2}\\big)\\, \\mathrm{d}t\\right],\n$$\n当 $q=r=1$ 和 $\\gamma=1$ 时，值函数 $V(x)$ 的 HJB 方程为\n$$\n0 = \\min_{u}\\left\\{q x^{2} + r u^{2} + (a x + b u) V'(x) + \\frac{1}{2}\\sigma^{2} V''(x) - \\gamma V(x)\\right\\}。\n$$\n该方程由作用于 $V$ 的受控扩散生成元加上运行成本，并由折扣项 $-\\gamma V(x)$ 平衡而来。\n\n对于风险敏感折扣成本\n$$\nJ_{\\theta}(u) = \\frac{1}{\\theta}\\, \\ln\\, \\mathbb{E}\\!\\left[\\exp\\!\\left(\\theta \\int_{0}^{\\infty} \\exp(-\\gamma t)\\, \\big(q\\, x_{t}^{2} + r\\, u_{t}^{2}\\big)\\, \\mathrm{d}t\\right)\\right],\n$$\n当 $\\theta = \\frac{1}{4}$ 时，相应的风险敏感 HJB 方程由于指数成本变换引入了一个额外的二次梯度项。一个经过充分检验的受控扩散过程风险敏感 HJB 方程形式是\n$$\n0 = \\min_{u}\\left\\{q x^{2} + r u^{2} + (a x + b u) V'(x) + \\frac{1}{2}\\sigma^{2} V''(x) + \\frac{\\theta}{2} \\sigma^{2} \\big(V'(x)\\big)^{2} - \\gamma V(x)\\right\\}。\n$$\n\n我们现在采用二次拟设\n$$\nV(x) = P x^{2} + C,\n$$\n其中常数 $P0$ 和 $C \\in \\mathbb{R}$。那么\n$$\nV'(x) = 2 P x, \\qquad V''(x) = 2 P.\n$$\n将该拟设代入风险中性 HJB 方程：\n$$\n0 = \\min_{u}\\left\\{x^{2} + u^{2} + (a x + b u) (2 P x) + \\frac{1}{2}\\sigma^{2} (2 P) - \\gamma (P x^{2} + C)\\right\\}。\n$$\n使用 $a=b=\\sigma=\\gamma=1$，方程变为\n$$\n0 = \\min_{u}\\left\\{x^{2} + u^{2} + 2 P a x^{2} + 2 P b u x + \\sigma^{2} P - \\gamma P x^{2} - \\gamma C\\right\\}\n= \\min_{u}\\left\\{\\big(1 + 2 P - \\gamma P\\big) x^{2} + u^{2} + 2 P u x + \\sigma^{2} P - \\gamma C\\right\\}。\n$$\n为了对 $u$ 进行最小化，将 $x$ 视为参数。关于 $u$ 的函数是二次的，其最小化子满足\n$$\n\\frac{\\partial}{\\partial u}\\left(u^{2} + 2 P u x\\right) = 2 u + 2 P x = 0 \\quad \\Rightarrow \\quad u^{*}(x) = - P x.\n$$\n因此，在风险中性情况下，最优控制为 $u_{t}^{*} = -K_{0} x_{t}$，其中 $K_{0} = P$。将 $u^{*}$ 代回可得\n$$\nu^{2} + 2 P u x = P^{2} x^{2} - 2 P^{2} x^{2} = - P^{2} x^{2}.\n$$\n因此，HJB 方程简化为\n$$\n0 = \\left(1 + 2 P - \\gamma P - P^{2}\\right) x^{2} + \\sigma^{2} P - \\gamma C.\n$$\n为了使等式对所有 $x$ 成立，$x^{2}$ 的系数必须为零，常数项也必须为零：\n$$\n1 + 2 P - \\gamma P - P^{2} = 0, \\qquad \\sigma^{2} P - \\gamma C = 0.\n$$\n当 $\\gamma=\\sigma=1$ 时，关于 $P$ 的代数 Riccati 方程为\n$$\n1 + 2 P - P - P^{2} = 0 \\quad \\Rightarrow \\quad 1 + P - P^{2} = 0 \\quad \\Rightarrow \\quad P^{2} - P - 1 = 0.\n$$\n正的稳定解是\n$$\nP = \\frac{1 + \\sqrt{1 + 4}}{2} = \\frac{1 + \\sqrt{5}}{2}.\n$$\n因此，风险中性最优增益为\n$$\nK_{0} = P = \\frac{1 + \\sqrt{5}}{2}.\n$$\n常数 $C$ 由 $C = \\sigma^{2} P / \\gamma = P$ 给出，但它不影响增益。\n\n接下来，考虑 $\\theta = \\frac{1}{4}$ 时的风险敏感 HJB 方程：\n$$\n0 = \\min_{u}\\left\\{x^{2} + u^{2} + (a x + b u) (2 P x) + \\frac{1}{2}\\sigma^{2} (2 P) + \\frac{\\theta}{2} \\sigma^{2} (2 P x)^{2} - \\gamma (P x^{2} + C)\\right\\}。\n$$\n使用 $a=b=\\sigma=\\gamma=1$ 并化简，\n$$\n0 = \\min_{u}\\left\\{\\big(1 + 2 P - \\gamma P\\big) x^{2} + u^{2} + 2 P u x + \\sigma^{2} P + 2 \\theta \\sigma^{2} P^{2} x^{2} - \\gamma C\\right\\}。\n$$\n对 $u$ 的最小化过程是相同的，得到 $u^{*}(x) = - P x$，因此反馈结构相同，增益为 $K_{\\theta} = P$，但由于附加的梯度项，求解 $P$ 的代数方程有所改变。将 $u^{*}$ 代回可得\n$$\n0 = \\left(1 + 2 P - \\gamma P - P^{2} + 2 \\theta \\sigma^{2} P^{2}\\right) x^{2} + \\sigma^{2} P - \\gamma C.\n$$\n因此\n$$\n1 + 2 P - \\gamma P - P^{2} + 2 \\theta \\sigma^{2} P^{2} = 0, \\qquad \\sigma^{2} P - \\gamma C = 0.\n$$\n当 $\\gamma=\\sigma=1$ 且 $\\theta = \\frac{1}{4}$ 时，Riccati 方程变为\n$$\n1 + 2 P - P - P^{2} + 2 \\cdot \\frac{1}{4} \\cdot 1 \\cdot P^{2} = 0 \\quad \\Rightarrow \\quad 1 + P + \\left(-1 + \\frac{1}{2}\\right) P^{2} = 0,\n$$\n即\n$$\n1 + P - \\frac{1}{2} P^{2} = 0 \\quad \\Rightarrow \\quad -\\frac{1}{2} P^{2} + P + 1 = 0.\n$$\n两边乘以 $-2$，\n$$\nP^{2} - 2 P - 2 = 0.\n$$\n求解得，\n$$\nP = \\frac{2 \\pm \\sqrt{4 + 8}}{2} = \\frac{2 \\pm \\sqrt{12}}{2} = \\frac{2 \\pm 2 \\sqrt{3}}{2} = 1 \\pm \\sqrt{3}.\n$$\n我们选择正的稳定解 $P = 1 + \\sqrt{3}$，这样闭环漂移 $a - b K_{\\theta} = 1 - P$ 为负，从而确保系统的稳定性和控制的容许性。因此，\n$$\nK_{\\theta} = P = 1 + \\sqrt{3}.\n$$\n\n容许性验证：在 $u_{t} = -K x_{t}$ 下，闭环 SDE 成为一个 Ornstein–Uhlenbeck 过程\n$$\n\\mathrm{d}x_{t} = (a - b K)\\, x_{t}\\, \\mathrm{d}t + \\sigma\\, \\mathrm{d}W_{t}.\n$$\n当 $a=1$，$b=1$ 时，计算出的增益 $K_{0} = \\frac{1 + \\sqrt{5}}{2}$ 和 $K_{\\theta} = 1 + \\sqrt{3}$ 均满足 $a - b K  0$，因此过程是均方稳定的。因此，\n$$\n\\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\exp(-\\gamma t)\\, u_{t}^{2}\\, \\mathrm{d}t\\right]  \\infty\n$$\n成立，控制是容许的。\n\n综上所述，两个最优增益为\n$$\nK_{0} = \\frac{1 + \\sqrt{5}}{2}, \\qquad K_{\\theta} = 1 + \\sqrt{3}.\n$$\n正如预期的那样，在此示例中，风险敏感增益大于风险中性增益，这反映了在优化积分指数准则时，面对过程噪声表现出更强的谨慎性。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1 + \\sqrt{5}}{2}  1 + \\sqrt{3}\\end{pmatrix}}$$", "id": "3077001"}]}