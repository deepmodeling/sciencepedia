{"hands_on_practices": [{"introduction": "卡尔曼滤波的威力在于其递归特性，即每个新的测量值都会优化我们对系统状态的认知。第一个练习将带你深入该过程的核心：测量更新步骤 [@problem_id:3053885]。通过从第一性原理出发解决一个具体的数值例子，你将看到先验信念（由均值和方差表示）如何与新的观测值在数学上结合，从而产生一个更新的、更精确的后验信念。", "problem": "考虑离散时间线性高斯状态空间模型\n$$x_{k+1} = A x_k + w_k,\\qquad y_k = C x_k + v_k,$$\n其中 $w_k \\sim \\mathcal{N}(0,Q)$ 和 $v_k \\sim \\mathcal{N}(0,R)$ 相互独立，且与初始状态无关。在时间 $k=0$ 时，给定状态的先验（预测）为 $x_0 \\sim \\mathcal{N}(m_0, P_0)$，然后您观测到单个测量值 $y_0$。模型参数为\n$$A = 0.7,\\quad C = 1.2,\\quad Q = 0.09,\\quad R = 0.16,$$\n且在时间 $k=0$ 时的先验为\n$$m_0 = 1.5,\\quad P_0 = 0.5,$$\n观测值为\n$$y_0 = 2.0.$$\n使用联合高斯变量条件估计的基本原理以及模型所蕴含的最优线性最小均方误差 (LMMSE) 更新，计算观测到 $y_0$ 后 $x_0$ 的后验均值 $m_0^{+}$ 和后验方差 $P_0^{+}$。以精确形式（无四舍五入）将您的最终数值答案表示为单行矩阵 $\\big[m_0^{+},\\,P_0^{+}\\big]$。", "solution": "对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- **模型方程**：\n  - 状态动力学：$x_{k+1} = A x_k + w_k$\n  - 测量模型：$y_k = C x_k + v_k$\n- **噪声分布**：\n  - 过程噪声：$w_k \\sim \\mathcal{N}(0,Q)$\n  - 测量噪声：$v_k \\sim \\mathcal{N}(0,R)$\n  - 噪声序列 $\\{w_k\\}$ 和 $\\{v_k\\}$ 相互独立，且与初始状态 $x_0$ 无关。\n- **模型参数**：\n  - $A = 0.7$\n  - $C = 1.2$\n  - $Q = 0.09$\n  - $R = 0.16$\n- **时间 $k=0$ 时的先验信息**：\n  - 状态 $x_0$ 具有先验分布 $x_0 \\sim \\mathcal{N}(m_0, P_0)$。\n  - 先验均值：$m_0 = 1.5$\n  - 先验方差：$P_0 = 0.5$\n- **时间 $k=0$ 时的观测值**：\n  - $y_0 = 2.0$\n- **目标**：\n  - 计算观测到 $y_0$ 后 $x_0$ 的后验均值 $m_0^{+}$ 和后验方差 $P_0^{+}$。计算必须基于联合高斯变量条件估计的基本原理。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是线性高斯状态空间模型的贝叶斯推断的标准应用。这是滤波理论和随机控制中的一个基本课题，具体代表了 Kalman 滤波器中的测量更新步骤。该模型在数学上和科学上都是合理的。\n2.  **适定性**：该问题是适定的。状态的先验分布和似然函数（由测量模型蕴含）都已完全指定且为高斯分布。这确保了后验分布也是高斯的，其参数（均值和方差）是唯一确定的。为求解提供了所有必要的数值 ($m_0, P_0, C, R, y_0$)。参数 $A$ 和 $Q$ 描述了完整滤波问题的动力学，但对于在给定测量值 $y_0$ 的情况下更新时间 $k=0$ 时的估计这一特定任务而言，并非必需。它们的存在不会产生矛盾。\n3.  **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观断言。\n\n### 第 3 步：结论与行动\n该问题被判定为**有效**。将提供解答。\n\n该问题要求我们计算在时间 $k=0$ 观测到单个测量值 $y_0$ 后的条件均值 $E[x_0 | y_0]$ 和条件方差 $\\text{Var}(x_0 | y_0)$。这些分别是后验均值 $m_0^{+}$ 和后验方差 $P_0^{+}$。由于 $x_0$ 的先验分布是高斯的，且观测值 $y_0$ 是 $x_0$ 的线性函数加上高斯噪声，因此状态 $x_0$ 和观测值 $y_0$ 是联合高斯的。\n\n我们定义随机向量 $\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix}$。我们首先求出其均值和协方差矩阵。\n\n$x_0$ 的均值给定为 $E[x_0] = m_0$。\n$y_0$ 的均值从测量方程导出：\n$$E[y_0] = E[C x_0 + v_0] = C E[x_0] + E[v_0]$$\n由于 $v_0 \\sim \\mathcal{N}(0,R)$，我们有 $E[v_0] = 0$。因此，\n$$E[y_0] = C m_0$$\n$\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix}$ 的均值向量为：\n$$\\mu = E\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix} = \\begin{pmatrix} m_0 \\\\ C m_0 \\end{pmatrix}$$\n\n接下来，我们计算协方差矩阵 $\\Sigma = \\text{Cov}\\left(\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix}\\right) = \\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix}$。\n各分量为：\n- $\\Sigma_{11} = \\text{Var}(x_0) = P_0$。\n- $\\Sigma_{12} = \\text{Cov}(x_0, y_0) = E[(x_0 - m_0)(y_0 - C m_0)] = E[(x_0 - m_0)(C x_0 + v_0 - C m_0)] = E[(x_0 - m_0)(C(x_0 - m_0) + v_0)]$。\n展开此式得到 $C E[(x_0 - m_0)^2] + E[(x_0 - m_0)v_0] = C \\text{Var}(x_0) + 0$，因为 $x_0$ 和 $v_0$ 是独立的。所以，$\\Sigma_{12} = C P_0$。\n- $\\Sigma_{21} = \\text{Cov}(y_0, x_0) = \\Sigma_{12}^T$。由于这些都是标量，$\\Sigma_{21} = C P_0$。\n- $\\Sigma_{22} = \\text{Var}(y_0) = \\text{Var}(C x_0 + v_0)$。由于 $x_0$ 和 $v_0$ 是独立的，方差相加：$\\text{Var}(C x_0) + \\text{Var}(v_0) = C^2 \\text{Var}(x_0) + R = C^2 P_0 + R$。\n\n因此联合分布为：\n$$\\begin{pmatrix} x_0 \\\\ y_0 \\end{pmatrix} \\sim \\mathcal{N}\\left( \\begin{pmatrix} m_0 \\\\ C m_0 \\end{pmatrix}, \\begin{pmatrix} P_0  C P_0 \\\\ C P_0  C^2 P_0 + R \\end{pmatrix} \\right)$$\n\n对于一个一般的联合高斯向量 $\\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix} \\sim \\mathcal{N}\\left(\\begin{pmatrix} \\mu_1 \\\\ \\mu_2 \\end{pmatrix}, \\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix}\\right)$，给定 $X_2=x_2$ 时 $X_1$ 的条件分布是高斯分布，其均值和方差为：\n$$\\mu_{1|2} = \\mu_1 + \\Sigma_{12} \\Sigma_{22}^{-1} (x_2 - \\mu_2)$$\n$$\\Sigma_{11|2} = \\Sigma_{11} - \\Sigma_{12} \\Sigma_{22}^{-1} \\Sigma_{21}$$\n\n将此应用于我们的问题，我们认定 $X_1 \\to x_0$，$X_2 \\to y_0$ 和 $x_2 \\to y_0$。后验均值 $m_0^{+}$ 和方差 $P_0^{+}$ 为：\n$$m_0^{+} = E[x_0|y_0] = m_0 + (C P_0) (C^2 P_0 + R)^{-1} (y_0 - C m_0)$$\n$$P_0^{+} = \\text{Var}(x_0|y_0) = P_0 - (C P_0) (C^2 P_0 + R)^{-1} (C P_0)$$\n这些是 Kalman 滤波器的标准测量更新方程。\n\n我们现在代入给定的数值，使用精确的分数形式以避免舍入误差。\n$C = 1.2 = \\frac{12}{10} = \\frac{6}{5}$\n$R = 0.16 = \\frac{16}{100} = \\frac{4}{25}$\n$m_0 = 1.5 = \\frac{3}{2}$\n$P_0 = 0.5 = \\frac{1}{2}$\n$y_0 = 2.0 = 2$\n\n首先，我们计算项 $(C^2 P_0 + R)$，即新息协方差，通常表示为 $S_0$。\n$$S_0 = C^2 P_0 + R = \\left(\\frac{6}{5}\\right)^2 \\left(\\frac{1}{2}\\right) + \\frac{4}{25} = \\frac{36}{25} \\cdot \\frac{1}{2} + \\frac{4}{25} = \\frac{18}{25} + \\frac{4}{25} = \\frac{22}{25}$$\n\n现在，我们可以计算后验方差 $P_0^{+}$：\n$$P_0^{+} = P_0 - (C P_0) S_0^{-1} (C P_0) = P_0 - \\frac{(C P_0)^2}{S_0}$$\n$$C P_0 = \\frac{6}{5} \\cdot \\frac{1}{2} = \\frac{3}{5}$$\n$$P_0^{+} = \\frac{1}{2} - \\frac{(\\frac{3}{5})^2}{\\frac{22}{25}} = \\frac{1}{2} - \\frac{\\frac{9}{25}}{\\frac{22}{25}} = \\frac{1}{2} - \\frac{9}{22} = \\frac{11}{22} - \\frac{9}{22} = \\frac{2}{22} = \\frac{1}{11}$$\n\n接下来，我们计算后验均值 $m_0^{+}$。\n项 $(y_0 - C m_0)$ 是新息或测量残差。\n$$C m_0 = \\frac{6}{5} \\cdot \\frac{3}{2} = \\frac{9}{5}$$\n$$y_0 - C m_0 = 2 - \\frac{9}{5} = \\frac{10}{5} - \\frac{9}{5} = \\frac{1}{5}$$\n现在我们可以计算 $m_0^{+}$：\n$$m_0^{+} = m_0 + (C P_0) S_0^{-1} (y_0 - C m_0)$$\n$$m_0^{+} = \\frac{3}{2} + \\left(\\frac{3}{5}\\right) \\left(\\frac{22}{25}\\right)^{-1} \\left(\\frac{1}{5}\\right) = \\frac{3}{2} + \\left(\\frac{3}{5}\\right) \\left(\\frac{25}{22}\\right) \\left(\\frac{1}{5}\\right)$$\n$$m_0^{+} = \\frac{3}{2} + \\frac{3 \\cdot 25 \\cdot 1}{5 \\cdot 22 \\cdot 5} = \\frac{3}{2} + \\frac{3 \\cdot (5 \\cdot 5)}{(5 \\cdot 5) \\cdot 22} = \\frac{3}{2} + \\frac{3}{22}$$\n$$m_0^{+} = \\frac{3 \\cdot 11}{2 \\cdot 11} + \\frac{3}{22} = \\frac{33}{22} + \\frac{3}{22} = \\frac{36}{22} = \\frac{18}{11}$$\n\n后验均值为 $m_0^{+} = \\frac{18}{11}$，后验方差为 $P_0^{+} = \\frac{1}{11}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{18}{11}  \\frac{1}{11}\n\\end{pmatrix}\n}\n$$", "id": "3053885"}, {"introduction": "掌握了单步更新之后，一个自然而然的问题是：滤波器的性能在长时间运行后会如何表现？对于许多系统，估计误差的方差会收敛到一个稳定的常数值。这个练习 [@problem_id:3053897] 要求你通过求解著名的代数Riccati方程，来推导连续时间系统下的稳态解，从而让你对卡尔曼-布西滤波器的长期稳定性和性能有更深刻的理解。", "problem": "考虑一个标量连续时间线性系统，该系统被建模为带有过程噪声和测量噪声的随机微分方程 (SDE)：\n$$\ndx_t = A\\,x_t\\,dt + \\sqrt{Q}\\,dW_t,\\qquad dy_t = C\\,x_t\\,dt + \\sqrt{R}\\,dV_t,\n$$\n其中 $A$、$Q$、$C$ 和 $R$ 是常数标量，$W_t$ 和 $V_t$ 是独立的标准维纳过程，$x_t$ 和 $y_t$ 分别是状态和测量。假设 $A  0$，$Q > 0$，$C\\neq 0$ 且 $R > 0$。令 $\\hat{x}_t$ 表示由新息过程驱动的 Kalman-Bucy 滤波器 (KBF) 估计值，令 $P_t = \\mathbb{E}\\big[(x_t - \\hat{x}_t)^2\\big]$ 表示估计误差方差。\n\n从此设置中估计误差 $e_t = x_t - \\hat{x}_t$ 的定义以及 $de_t$ 和 $d(e_t^2)$ 的 Itô 微分法则出发，推导 $P_t$ 的稳态条件，然后计算能产生物理上有意义的非负协方差和稳定误差动态的稳态解 $P_{\\infty}$。用 $A$、$Q$、$C$ 和 $R$ 将你的最终答案表示为一个闭式解析表达式。不需要进行数值舍入。", "solution": "用户要求推导标量 Kalman-Bucy 滤波器的稳态误差协方差。\n\n### 第 1 步：问题验证\n\n根据所需标准对问题陈述进行验证。\n\n**提取的已知条件：**\n- 过程模型：$dx_t = A\\,x_t\\,dt + \\sqrt{Q}\\,dW_t$\n- 测量模型：$dy_t = C\\,x_t\\,dt + \\sqrt{R}\\,dV_t$\n- 参数：$A$、$Q$、$C$、$R$ 是常数标量。\n- 条件：$A  0$，$Q > 0$，$C\\neq 0$ 且 $R > 0$。\n- 噪声过程：$W_t$ 和 $V_t$ 是独立的标准维纳过程。\n- 定义：\n    - $\\hat{x}_t$ 是 Kalman-Bucy 滤波器估计值。\n    - $P_t = \\mathbb{E}\\big[(x_t - \\hat{x}_t)^2\\big]$ 是估计误差方差。\n    - $e_t = x_t - \\hat{x}_t$ 是估计误差。\n- 任务：从第一性原理出发，推导 $P_t$ 的稳态解 $P_{\\infty}$，确保它是一个物理上有意义的非负协方差，并能产生稳定的误差动态。\n\n**使用提取的已知条件进行验证：**\n- **科学依据：** 该问题是随机滤波理论中的一个标准、典型的问题。系统和测量的模型是线性二次高斯 (LQG) 控制与估计框架的基础。推导相关 Riccati 方程的稳态解是一项基本练习。\n- **适定性：** 问题提供了所有必要的参数和条件（$A  0$，$Q > 0$，$C\\neq 0$ 且 $R > 0$），以保证误差协方差存在唯一的、正的、稳定的稳态解。系统是随机可控的（因为 $Q>0$）和可观测的（因为 $C\\neq 0$）。开环过程是稳定的（$A  0$）。这些条件确保了问题的适定性。\n- **客观性：** 问题使用精确的数学语言陈述，没有任何歧义或主观因素。\n\n**结论：**\n该问题是有效的。它是随机微分方程和滤波理论领域中一个定义明确、科学上合理的的问题。\n\n### 第 2 步：求解推导\n\n我们从系统方程开始：\n$$\ndx_t = A\\,x_t\\,dt + \\sqrt{Q}\\,dW_t\n$$\n$$\ndy_t = C\\,x_t\\,dt + \\sqrt{R}\\,dV_t\n$$\n\n此系统的 Kalman-Bucy 滤波器提供了状态 $x_t$ 的最优估计 $\\hat{x}_t$。该估计的动态由下式给出：\n$$\nd\\hat{x}_t = A\\,\\hat{x}_t\\,dt + K_t\\,dI_t\n$$\n其中 $dI_t = dy_t - C\\,\\hat{x}_t\\,dt$ 是新息过程，$K_t$ 是卡尔曼增益。增益由 $K_t = P_t C R^{-1}$ 给出，其中 $P_t = \\mathbb{E}[e_t^2]$ 且 $e_t = x_t - \\hat{x}_t$ 是估计误差。\n\n第一步是推导估计误差 $e_t$ 的动态。\n$$\nde_t = d(x_t - \\hat{x}_t) = dx_t - d\\hat{x}_t\n$$\n代入 $dx_t$ 和 $d\\hat{x}_t$ 的表达式：\n$$\nde_t = (A\\,x_t\\,dt + \\sqrt{Q}\\,dW_t) - (A\\,\\hat{x}_t\\,dt + K_t\\,dI_t)\n$$\n$$\nde_t = A(x_t - \\hat{x}_t)dt + \\sqrt{Q}\\,dW_t - K_t\\,dI_t\n$$\n现在，代入新息过程 $dI_t$ 的定义：\n$$\ndI_t = (C\\,x_t\\,dt + \\sqrt{R}\\,dV_t) - C\\,\\hat{x}_t\\,dt = C(x_t - \\hat{x}_t)dt + \\sqrt{R}\\,dV_t = C\\,e_t\\,dt + \\sqrt{R}\\,dV_t\n$$\n将此代入 $de_t$ 的方程中：\n$$\nde_t = A\\,e_t\\,dt + \\sqrt{Q}\\,dW_t - K_t(C\\,e_t\\,dt + \\sqrt{R}\\,dV_t)\n$$\n将 $dt$ 项和随机项分组，我们得到误差的 SDE：\n$$\nde_t = (A - K_t C)e_t\\,dt + \\sqrt{Q}\\,dW_t - K_t \\sqrt{R}\\,dV_t\n$$\n\n接下来，我们推导误差平方 $e_t^2$ 的动态。我们对函数 $f(e_t) = e_t^2$ 应用 Itô 引理，即 $d(f(e_t)) = f'(e_t)de_t + \\frac{1}{2}f''(e_t)(de_t)^2$。这里，$f'(e_t) = 2e_t$ 且 $f''(e_t) = 2$。\n$$\nd(e_t^2) = 2e_t\\,de_t + (de_t)^2\n$$\n二次变分项 $(de_t)^2$ 使用 Itô 乘法规则（$dt^2=0$，$dt\\,dW_t=0$，$dW_t\\,dV_t=0$，$dW_t^2=dt$，$dV_t^2=dt$）计算，只考虑 $de_t$ 的鞅部分：\n$$\n(de_t)^2 = (\\sqrt{Q}\\,dW_t - K_t \\sqrt{R}\\,dV_t)^2 = (\\sqrt{Q}\\,dW_t)^2 + (K_t \\sqrt{R}\\,dV_t)^2 - 2\\sqrt{Q}K_t\\sqrt{R}\\,dW_t\\,dV_t\n$$\n$$\n(de_t)^2 = Q\\,dt + K_t^2 R\\,dt = (Q + K_t^2 R)\\,dt\n$$\n将 $de_t$ 和 $(de_t)^2$ 的表达式代入 $d(e_t^2)$ 的方程：\n$$\nd(e_t^2) = 2e_t \\left( (A - K_t C)e_t\\,dt + \\sqrt{Q}\\,dW_t - K_t \\sqrt{R}\\,dV_t \\right) + (Q + K_t^2 R)dt\n$$\n$$\nd(e_t^2) = 2(A - K_t C)e_t^2\\,dt + (Q + K_t^2 R)dt + 2e_t\\sqrt{Q}\\,dW_t - 2e_t K_t\\sqrt{R}\\,dV_t\n$$\n误差方差为 $P_t = \\mathbb{E}[e_t^2]$。其微分为 $dP_t = d(\\mathbb{E}[e_t^2]) = \\mathbb{E}[d(e_t^2)]$。对 $d(e_t^2)$ 的表达式取期望：\n$$\ndP_t = \\mathbb{E}[2(A - K_t C)e_t^2\\,dt + (Q + K_t^2 R)dt + 2e_t\\sqrt{Q}\\,dW_t - 2e_t K_t\\sqrt{R}\\,dV_t]\n$$\nItô 积分项的期望为零，即 $\\mathbb{E}[\\int \\dots dW_t] = 0$ 和 $\\mathbb{E}[\\int \\dots dV_t] = 0$。由于 $A$、$K_t$、$C$、$Q$ 和 $R$ 是确定性的，我们有：\n$$\ndP_t = (2(A - K_t C)\\mathbb{E}[e_t^2] + Q + K_t^2 R)dt\n$$\n$$\n\\frac{dP_t}{dt} = 2(A - K_t C)P_t + Q + K_t^2 R\n$$\n这是误差方差的微分 Riccati 方程 (DRE) 的一般形式。现在，我们代入最优卡尔曼增益 $K_t = P_t C R^{-1}$：\n$$\n\\frac{dP_t}{dt} = 2(A - (P_t C R^{-1}) C)P_t + Q + (P_t C R^{-1})^2 R\n$$\n$$\n\\frac{dP_t}{dt} = 2AP_t - 2P_t^2 C^2 R^{-1} + Q + P_t^2 C^2 R^{-2} R\n$$\n$$\n\\frac{dP_t}{dt} = 2AP_t - 2P_t^2 C^2 R^{-1} + Q + P_t^2 C^2 R^{-1}\n$$\n$$\n\\frac{dP_t}{dt} = 2AP_t - P_t^2 C^2 R^{-1} + Q\n$$\n对于稳态解 $P_{\\infty}$，我们设 $\\frac{dP_t}{dt} = 0$ 并用 $P_{\\infty}$ 替换 $P_t$：\n$$\n0 = 2AP_{\\infty} - P_{\\infty}^2 C^2 R^{-1} + Q\n$$\n这就是代数 Riccati 方程 (ARE)。将其重新排列为标准二次型 $ax^2+bx+c=0$，其中 $x=P_{\\infty}$：\n$$\n(C^2 R^{-1})P_{\\infty}^2 - 2AP_{\\infty} - Q = 0\n$$\n我们使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $P_{\\infty}$：\n$$\nP_{\\infty} = \\frac{-(-2A) \\pm \\sqrt{(-2A)^2 - 4(C^2 R^{-1})(-Q)}}{2(C^2 R^{-1})}\n$$\n$$\nP_{\\infty} = \\frac{2A \\pm \\sqrt{4A^2 + 4C^2 Q R^{-1}}}{2C^2 R^{-1}}\n$$\n$$\nP_{\\infty} = \\frac{2A \\pm 2\\sqrt{A^2 + C^2 Q R^{-1}}}{2C^2 R^{-1}}\n$$\n$$\nP_{\\infty} = \\frac{R}{C^2} \\left( A \\pm \\sqrt{A^2 + \\frac{C^2 Q}{R}} \\right)\n$$\n我们有两个可能的解。我们必须选择满足问题条件的那个。\n\n1.  **物理上有意义的非负协方差：** 方差 $P_{\\infty}$ 必须是非负的。我们已知 $A  0$，$C\\neq 0$，$Q > 0$ 且 $R > 0$。平方根内的项是 $A^2 + \\frac{C^2 Q}{R} > A^2$，所以 $\\sqrt{A^2 + \\frac{C^2 Q}{R}} > \\sqrt{A^2} = |A|$。由于 $A  0$，所以 $|A| = -A$。因此，$\\sqrt{A^2 + \\frac{C^2 Q}{R}} > -A$。\n    -   带有减号的解 $P_{\\infty,-} = \\frac{R}{C^2} \\left( A - \\sqrt{A^2 + \\frac{C^2 Q}{R}} \\right)$ 会导致 $P_{\\infty,-}  0$，因为 $A$ 是负数，而我们减去了一个在量级上大于 $-A$ 的正项。这不是一个有效的方差。\n    -   带有加号的解 $P_{\\infty,+} = \\frac{R}{C^2} \\left( A + \\sqrt{A^2 + \\frac{C^2 Q}{R}} \\right)$ 会导致 $P_{\\infty,+} > 0$，因为 $A + \\sqrt{\\dots} > A - A = 0$。这是物理上有意义的解。\n\n2.  **稳定的误差动态：** 误差动态由极点 $(A - K_{\\infty} C)$ 决定，其中 $K_{\\infty}=P_{\\infty}CR^{-1}$。为了保证稳定性，该极点必须为负。让我们为我们选择的解验证这一点。\n    $$\n    A - K_{\\infty} C = A - (P_{\\infty} C R^{-1}) C = A - P_{\\infty} C^2 R^{-1}\n    $$\n    代入我们的 $P_{\\infty}$ 表达式：\n    $$\n    A - \\left[ \\frac{R}{C^2} \\left( A + \\sqrt{A^2 + \\frac{C^2 Q}{R}} \\right) \\right] C^2 R^{-1} = A - \\left( A + \\sqrt{A^2 + \\frac{C^2 Q}{R}} \\right)\n    $$\n    $$\n    = -\\sqrt{A^2 + \\frac{C^2 Q}{R}}\n    $$\n    由于 $A^2 > 0$ 且 $\\frac{C^2 Q}{R} > 0$，根号下的项是严格为正的。它的平方根是一个正实数。因此，极点是严格为负的，从而确保了误差动态的稳定性。\n\nARE 的正根满足这两个条件。最终的稳态解是：\n$$\nP_{\\infty} = \\frac{R}{C^2} \\left( A + \\sqrt{A^2 + \\frac{C^2 Q}{R}} \\right)\n$$\n这个表达式可以展开和重写，但这种形式更紧凑且是直接推导出来的。\n$$\nP_{\\infty} = \\frac{AR}{C^2} + \\frac{R}{C^2} \\sqrt{A^2 + \\frac{Q C^2}{R}} = \\frac{AR}{C^2} + \\sqrt{\\frac{A^2 R^2}{C^4} + \\frac{Q R}{C^2}}\n$$\n我们将使用更紧凑的形式。", "answer": "$$\\boxed{\\frac{R}{C^2} \\left( A + \\sqrt{A^2 + \\frac{C^2 Q}{R}} \\right)}$$", "id": "3053897"}, {"introduction": "理论为我们提供了理想的滤波器，但在实践中我们如何判断滤波器是否正常工作呢？一个强大的诊断工具是分析新息序列——即我们预期的测量值与实际得到的测量值之差。对于一个最优滤波器，这个序列应该是一个“白噪声”。最后一个练习 [@problem_id:3053906] 是一个动手编程实践，你将实现一个统计检验来验证这一白噪声特性，这是在实际应用中验证和调整滤波器性能的一项关键技能。", "problem": "给定一个具有隐状态和可观测输出的标量线性高斯状态空间模型。该模型由以下随机差分方程指定\n- 状态动力学：$x_{k+1} = A x_k + w_k$\n- 测量：$y_k = C x_k + v_k$\n其中 $\\{w_k\\}$ 是独立的、服从 $w_k \\sim \\mathcal{N}(0,Q)$ 的高斯随机变量序列，$\\{v_k\\}$ 是独立的、服从 $v_k \\sim \\mathcal{N}(0,R)$ 的高斯随机变量序列。序列 $\\{w_k\\}$ 和 $\\{v_k\\}$ 彼此独立，且与初始状态 $x_0$ 无关。初始状态 $x_0$ 是高斯分布的，其均值为 $\\mu_0$，方差为 $P_0$。此设定是为滤波而离散化的随机微分方程意义下的线性高斯系统的一个标准标量实例。\n\n您的任务是：\n- 使用卡尔曼滤波器的一步预测器，根据给定的观测数据 $\\{y_k\\}_{k=0}^{N-1}$ 构建经验新息序列。\n- 使用中心化有偏估计量，从此新息序列中估计正延迟下的样本自相关函数 (ACF)。\n- 基于样本自相关的大样本界限，对新息进行白噪声检验。\n\n仅使用以下基本定义和广为接受的结果作为您推导和实现的基础：\n- 线性高斯状态空间模型的卡尔曼滤波器一步预测器和新息定义：\n  - 预测：$x_{k\\mid k-1} = A x_{k-1\\mid k-1}$ 和 $P_{k\\mid k-1} = A P_{k-1\\mid k-1} A + Q$。\n  - 新息：$e_k = y_k - C x_{k\\mid k-1}$ 和新息方差 $S_k = C P_{k\\mid k-1} C + R$。\n  - 卡尔曼增益：$K_k = \\dfrac{P_{k\\mid k-1} C}{S_k}$。\n  - 更新：$x_{k\\mid k} = x_{k\\mid k-1} + K_k e_k$ 和 $P_{k\\mid k} = (1 - K_k C) P_{k\\mid k-1}$。\n- 对于序列 $\\{e_k\\}_{k=0}^{N-1}$，在延迟 $\\ell \\ge 1$ 处的中心化有偏样本自相关估计为：\n  - 令 $\\bar{e} = \\dfrac{1}{N}\\sum_{k=0}^{N-1} e_k$ 且 $d = \\sum_{k=0}^{N-1} (e_k - \\bar{e})^2$。\n  - 则对于 $\\ell = 1,2,\\dots,L'$，$r_\\ell = \\dfrac{\\sum_{k=\\ell}^{N-1} (e_k - \\bar{e})(e_{k-\\ell} - \\bar{e})}{d}$，其中 $L' = \\min(L, N-2)$ 且 $L$ 是用户指定的最大延迟。\n- 关于新息白噪声的大样本决策规则：在原假设（即 $\\{e_k\\}$ 是均值为零的独立序列（白噪声））下，一个广泛使用的近似是，对于每个固定的 $\\ell \\ge 1$，$r_\\ell$ 近似服从均值为 $0$、方差为 $1/N$ 的高斯分布。因此，一个双边 $95\\%$ 置信界为 $\\pm \\dfrac{1.96}{\\sqrt{N}}$。如果对于所有 $\\ell = 1,\\dots,L'$，$\\lvert r_\\ell \\rvert \\le \\dfrac{1.96}{\\sqrt{N}}$ 均成立，则断定新息是白噪声。如果 $L' \\le 0$（即当 $N \\le 2$ 时），则按惯例接受白噪声假设，因为无法计算正延迟的自相关。\n\n为下述特定模型和测试套件实现以上步骤。在所有情况下，系统参数为\n- $A = 0$, $C = 1$, $Q = 0$, $R = 1$, $\\mu_0 = 0$, $P_0 = 1$，\n且最大延迟为 $L = 3$。请注意，这些参数意味着对于所有 $k \\ge 0$，$x_{k\\mid k-1} = 0$，因此 $e_k = y_k$。\n\n测试套件（三个案例）：\n- 案例 A（正常路径，长度 $N = 12$）：$y = [0, 2.0, 0, 0, 0, 0, 0, 0, 0, 0, -2.0, 0]$。\n- 案例 B（强序列相关，长度 $N = 20$）：$y = [1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]$。\n- 案例 C（短序列边界情况，长度 $N = 3$）：$y = [1.0, -1.0, 1.0]$。\n\n您的程序必须：\n- 对于每个案例，通过卡尔曼一步预测器计算新息 $\\{e_k\\}$，并计算 $\\ell = 1,\\dots,L'$ 的中心化有偏样本自相关 $r_\\ell$，其中 $L' = \\min(L,N-2)$ 且 $L=3$。\n- 对于每个案例，使用应用于所有延迟 $\\ell = 1,\\dots,L'$ 的双边界限 $\\pm \\dfrac{1.96}{\\sqrt{N}}$ 来判断是否为白噪声。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[{\\tt True},{\\tt False},{\\tt True}]$。每个案例的结果必须是一个布尔值，表示是否接受白噪声假设。\n\n最终输出格式：\n- 单行输出，包含一个Python风格的列表，内含三个布尔值，按顺序对应案例A、B、C，例如 $[True, False, True]$。", "solution": "该问题要求基于线性高斯状态空间模型理论和白噪声假设检验对时间序列进行分析。分析过程分为两个主要阶段：首先，在给定参数下简化卡尔曼滤波器方程；其次，对得到的新息序列应用统计检验。\n\n**1. 卡尔曼滤波器简化**\n\n状态空间模型由以下标量方程给出：\n状态动力学：$x_{k+1} = A x_k + w_k$，其中 $w_k \\sim \\mathcal{N}(0,Q)$\n测量：$y_k = C x_k + v_k$，其中 $v_k \\sim \\mathcal{N}(0,R)$\n\n指定的参数为 $A = 0$，$C = 1$，$Q = 0$，$R = 1$。初始状态为 $x_0 \\sim \\mathcal{N}(\\mu_0, P_0)$，其中 $\\mu_0=0$ 且 $P_0=1$。任务是计算新息序列 $e_k = y_k - C x_{k\\mid k-1}$，其中 $x_{k\\mid k-1}$ 是状态的一步预测值。\n\n卡尔曼滤波器对状态的预测由 $x_{k\\mid k-1} = A x_{k-1\\mid k-1}$ 给出。\n我们来分析这个递归。过程始于对 $x_0$ 的先验估计，即 $x_{0\\mid -1} = \\mu_0$。给定 $\\mu_0 = 0$，我们有 $x_{0\\mid -1} = 0$。\n\n对于 $k=0$，新息为 $e_0 = y_0 - C x_{0\\mid -1} = y_0 - (1)(0) = y_0$。\n更新后的状态估计为 $x_{0\\mid 0} = x_{0\\mid-1} + K_0 e_0 = 0 + K_0 y_0$。\n\n对于 $k=1$，预测为 $x_{1\\mid 0} = A x_{0\\mid 0}$。由于 $A=0$，我们有 $x_{1\\mid 0} = 0 \\cdot x_{0\\mid 0} = 0$。\n新息为 $e_1 = y_1 - C x_{1\\mid 0} = y_1 - (1)(0) = y_1$。\n\n通过归纳法，我们假设 $x_{k-1\\mid k-2} = 0$。第 $k$ 步的预测为 $x_{k\\mid k-1} = A x_{k-1\\mid k-1}$。由于 $A=0$，无论 $x_{k-1\\mid k-1}$ 的值是多少，这都导致 $x_{k\\mid k-1}=0$。因此，对于所有时间步 $k \\ge 0$，状态的一步预测值恒等于零。\n\n$x_{k\\mid k-1} = 0$ 对于所有 $k \\ge 0$。\n\n因此，新息序列 $\\{e_k\\}$ 简化为观测序列 $\\{y_k\\}$：\n$$e_k = y_k - C x_{k\\mid k-1} = y_k - (1)(0) = y_k$$\n这一简化将问题从一个滤波问题简化为对给定数据 $\\{y_k\\}$ 的直接时间序列分析。\n\n**2. 白噪声检验方法**\n\n新息序列 $\\{e_k\\}_{k=0}^{N-1}$ 的白噪声特性通过其样本自相关函数 (ACF) 进行检验。\n\n在延迟 $\\ell \\ge 1$ 处的中心化有偏样本 ACF 估计定义为：\n$$r_\\ell = \\frac{\\sum_{k=\\ell}^{N-1} (e_k - \\bar{e})(e_{k-\\ell} - \\bar{e})}{\\sum_{k=0}^{N-1} (e_k - \\bar{e})^2}$$\n其中 $\\bar{e} = \\frac{1}{N}\\sum_{k=0}^{N-1} e_k$ 是样本均值。ACF 的计算延迟为 $\\ell = 1, 2, \\dots, L'$，其中 $L' = \\min(L, N-2)$ 且指定的最大延迟为 $L=3$。\n\n白噪声检验基于大样本近似，即在白噪声的原假设下，每个 $r_\\ell$ 近似服从 $\\mathcal{N}(0, 1/N)$ 分布。因此，$r_\\ell$ 的一个双边 $95\\%$ 置信区间为 $\\pm 1.96/\\sqrt{N}$。如果所有计算出的样本自相关都落在此界限内，则认为序列 $\\{e_k\\}$ 是白噪声：\n$$|r_\\ell| \\le \\frac{1.96}{\\sqrt{N}} \\quad \\text{对于所有 } \\ell = 1, \\dots, L'$$\n如果 $L' \\le 0$（即对于 $N \\le 2$），则按惯例接受白噪声假设。\n\n**3. 逐案分析**\n\n现在我们将此方法应用于所提供的三个测试案例。\n\n**案例 A：**\n- 数据：$y = [0, 2.0, 0, 0, 0, 0, 0, 0, 0, 0, -2.0, 0]$\n- 长度：$N=12$。\n- 新息：$e = y$。\n- 待测试的最大延迟：$L' = \\min(3, 12-2) = \\min(3, 10) = 3$。我们必须计算 $r_1, r_2, r_3$。\n- 样本均值：$\\bar{e} = \\frac{1}{12}(2.0 - 2.0) = 0$。\n- 分母：$d = \\sum_{k=0}^{11} (e_k - 0)^2 = (2.0)^2 + (-2.0)^2 = 4 + 4 = 8$。\n- $\\ell=1, 2, 3$ 的 ACF 分子：\n  - $\\ell=1$: $\\sum_{k=1}^{11} e_k e_{k-1} = e_1 e_0 + \\dots + e_{11}e_{10} = (2.0)(0) + \\dots + (0)(-2.0) = 0$。\n  - $\\ell=2$: $\\sum_{k=2}^{11} e_k e_{k-2} = 0$。\n  - $\\ell=3$: $\\sum_{k=3}^{11} e_k e_{k-3} = 0$。\n- 样本 ACF：$r_1 = r_2 = r_3 = 0/8 = 0$。\n- 白噪声检验阈值：$T = \\frac{1.96}{\\sqrt{12}} \\approx 0.5657$。\n- 决策：对于 $\\ell=1, 2, 3$，我们有 $|r_\\ell|=0 \\le 0.5657$。条件成立。\n- 案例 A 结论：**接受白噪声假设 (True)**。\n\n**案例 B：**\n- 数据：$y = [1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]$\n- 长度：$N=20$。\n- 新息：$e = y$。\n- 待测试的最大延迟：$L' = \\min(3, 20-2) = \\min(3, 18) = 3$。我们必须计算 $r_1, r_2, r_3$。\n- 样本均值：$\\bar{e} = \\frac{1}{20}(10 \\times 1 + 10 \\times (-1)) = 0$。\n- 分母：$d = \\sum_{k=0}^{19} (e_k - 0)^2 = 10 \\times (1)^2 + 10 \\times (-1)^2 = 20$。\n- $\\ell=1$ 的 ACF 分子：$\\sum_{k=1}^{19} e_k e_{k-1} = (9 \\times (1)(1)) + (( -1)(1)) + (9 \\times (-1)(-1)) = 9 - 1 + 9 = 17$。\n- $\\ell=1$ 的样本 ACF：$r_1 = 17/20 = 0.85$。\n- 白噪声检验阈值：$T = \\frac{1.96}{\\sqrt{20}} \\approx 0.4382$。\n- 决策：对于 $\\ell=1$，我们有 $|r_1|=0.85  0.4382$。条件不满足。检验在第一个延迟处失败。\n- 案例 B 结论：**拒绝白噪声假设 (False)**。\n\n**案例 C：**\n- 数据：$y = [1.0, -1.0, 1.0]$\n- 长度：$N=3$。\n- 新息：$e = y$。\n- 待测试的最大延迟：$L' = \\min(3, 3-2) = \\min(3, 1) = 1$。我们必须计算 $r_1$。\n- 样本均值：$\\bar{e} = \\frac{1}{3}(1.0 - 1.0 + 1.0) = 1/3$。\n- 分母：$d = \\sum_{k=0}^{2} (e_k - \\bar{e})^2 = (1 - 1/3)^2 + (-1 - 1/3)^2 + (1 - 1/3)^2 = (2/3)^2 + (-4/3)^2 + (2/3)^2 = 4/9 + 16/9 + 4/9 = 24/9 = 8/3$。\n- $\\ell=1$ 的 ACF 分子：$\\sum_{k=1}^{2} (e_k - \\bar{e})(e_{k-1} - \\bar{e}) = (e_1-\\bar{e})(e_0-\\bar{e}) + (e_2-\\bar{e})(e_1-\\bar{e}) = (-1-1/3)(1-1/3) + (1-1/3)(-1-1/3) = (-4/3)(2/3) + (2/3)(-4/3) = -8/9 - 8/9 = -16/9$。\n- $\\ell=1$ 的样本 ACF：$r_1 = \\frac{-16/9}{24/9} = -16/24 = -2/3 \\approx -0.6667$。\n- 白噪声检验阈值：$T = \\frac{1.96}{\\sqrt{3}} \\approx 1.1315$。\n- 决策：对于 $\\ell=1$，我们有 $|r_1| = |-2/3| \\approx 0.6667 \\le 1.1315$。条件成立。\n- 案例 C 结论：**接受白噪声假设 (True)**。\n\n**结果总结**\n三个案例的白噪声检验结果如下：\n- 案例 A: True\n- 案例 B: False\n- 案例 C: True\n最终输出将是这些布尔值的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a whiteness test on three time series based on their sample autocorrelation function.\n    \"\"\"\n    \n    # Test cases as defined in the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\"y\": [0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0]},\n        # Case B (strong serial correlation)\n        {\"y\": [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]},\n        # Case C (short sequence edge case)\n        {\"y\": [1.0, -1.0, 1.0]},\n    ]\n\n    L = 3  # Maximum lag specified in the problem\n\n    results = []\n    \n    for case in test_cases:\n        y = case[\"y\"]\n        N = len(y)\n\n        # The problem states that for the given parameters, the innovations e_k are equal to the observations y_k.\n        e = np.array(y)\n        \n        # Calculate the effective maximum lag L'\n        L_prime = min(L, N - 2)\n        \n        # If L' is = 0 (i.e., N = 2), accept whiteness by convention.\n        if L_prime = 0:\n            results.append(True)\n            continue\n            \n        # Calculate the sample mean of the innovations\n        e_mean = np.mean(e)\n        \n        # Calculate the denominator for the ACF: sum of squared deviations\n        d = np.sum((e - e_mean)**2)\n        \n        # Initialize whiteness assumption\n        is_white = True\n        \n        # Calculate the 95% confidence threshold\n        threshold = 1.96 / np.sqrt(N)\n        \n        # Check ACF for lags from 1 to L'\n        for lag in range(1, L_prime + 1):\n            # The denominator d could be zero if all e_k are the same.\n            if d == 0:\n                # A constant signal is not white noise if N > 1.\n                # The ACF is ill-defined (0/0). We treat this as non-white.\n                is_white = False\n                break\n\n            # Calculate the numerator of the ACF\n            # (e_k - e_mean) for k from lag to N-1\n            term1 = e[lag:] - e_mean\n            # (e_{k-lag} - e_mean) for k from lag to N-1\n            term2 = e[:-lag] - e_mean\n            \n            numerator = np.sum(term1 * term2)\n            \n            r_lag = numerator / d\n            \n            # Check if the absolute value of the ACF exceeds the threshold\n            if abs(r_lag) > threshold:\n                is_white = False\n                break\n        \n        results.append(is_white)\n\n    # Format the final output as specified\n    print(f\"[{', '.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3053906"}]}