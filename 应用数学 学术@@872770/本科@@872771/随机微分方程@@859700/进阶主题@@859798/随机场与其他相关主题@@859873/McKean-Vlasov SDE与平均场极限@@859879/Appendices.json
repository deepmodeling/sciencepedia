{"hands_on_practices": [{"introduction": "这个练习是理解麦基恩-弗拉索夫随机微分方程（McKean-Vlasov SDE）的基石。要分析一个依赖其自身分布的随机过程，关键的第一步通常是为其统计矩（如均值和方差）推导出确定的演化方程。通过这个具体的练习，你将掌握如何将一个抽象的随机微分方程转化为一组可解的常微分方程，这是该领域的一项核心技能。", "problem": "考虑一个 McKean–Vlasov 随机微分方程 (SDE)，其漂移项取决于状态的当前分布。设漂移项为 $b(x,\\mu)=-x+\\int y\\,\\mu(dy)$，扩散系数为常数 $ \\sigma>0 $。设 $\\{W_t\\}_{t\\geq 0}$ 为标准布朗运动，初始条件 $X_0$ 的分布为 $\\mu_0$，具有有限二阶矩、均值 $m_0=\\int y\\,\\mu_0(dy)$ 和方差 $v_0=\\int (y-m_0)^2\\,\\mu_0(dy)$。\n\n从 McKean–Vlasov SDE 的定义以及期望、布朗运动和伊藤积分的基本性质出发，完成以下任务：\n- 明确地写出以 $X_t$ 和 $\\mathbb{E}[X_t]$ 表示的 SDE。\n- 推导均值 $m_t=\\mathbb{E}[X_t]$ 的演化方程。\n- 通过考虑中心化过程并对中心化过程的平方应用伊藤公式，推导方差 $v_t=\\mathrm{Var}(X_t)$ 的演化方程。\n\n基于这些推导，确定方差的长时间极限 $\\lim_{t\\to\\infty}\\mathrm{Var}(X_t)$，将其表示为仅含 $\\sigma$ 的闭式符号表达式。将你的最终答案表示为单个解析表达式。无需四舍五入。", "solution": "该问题描述了一个 McKean-Vlasov 随机微分方程 (SDE)，其一般形式为 $dX_t = b(X_t, \\mu_t)dt + \\sigma(X_t, \\mu_t)dW_t$，其中 $\\mu_t$ 是状态 $X_t$ 在时间 $t$ 的概率分布（或称“律”）。\n\n给定的漂移系数为 $b(x,\\mu)=-x+\\int y\\,\\mu(dy)$。对于分布为 $\\mu_t$ 的过程 $X_t$，积分项 $\\int y\\,\\mu_t(dy)$ 是 $X_t$ 期望的定义。我们将这个随时间变化的均值记为 $m_t = \\mathbb{E}[X_t]$。\n扩散系数为常数 $\\sigma > 0$。\n\n首先，我们用 $X_t$ 及其期望 $\\mathbb{E}[X_t]$ 明确地写出 SDE。将 $m_t$ 代入漂移项的表达式，得到：\n$b(X_t, \\mu_t) = -X_t + \\mathbb{E}[X_t] = -X_t + m_t$。\n得到的 SDE 是：\n$$dX_t = (-X_t + m_t) dt + \\sigma dW_t$$\n\n接下来，我们推导均值 $m_t = \\mathbb{E}[X_t]$ 的演化方程。我们对 SDE 两边取期望。假设我们可以交换期望和微分算子（在 SDE 的标准假设下这是合理的），我们有 $d\\mathbb{E}[X_t] = \\mathbb{E}[dX_t]$。\n$$dm_t = \\mathbb{E}[(-X_t + m_t) dt + \\sigma dW_t]$$\n根据期望的线性性质：\n$$dm_t = \\mathbb{E}[-X_t + m_t] dt + \\mathbb{E}[\\sigma dW_t]$$\n对于一个固定的时间 $t$，$m_t$ 是一个确定性值。因此，$\\mathbb{E}[-X_t + m_t] = -\\mathbb{E}[X_t] + \\mathbb{E}[m_t] = -m_t + m_t = 0$。随机微分项的期望 $\\mathbb{E}[\\sigma dW_t]$ 也为 $0$。\n这将 $m_t$ 的方程简化为：\n$$dm_t = 0 \\cdot dt + 0$$\n$$\\frac{dm_t}{dt} = 0$$\n这是一个常微分方程，其解为 $m_t$ 是一个常数。因此，对于所有 $t \\ge 0$，$m_t = m_0$，其中 $m_0 = \\mathbb{E}[X_0]$ 是初始均值。\n\n现在，我们推导方差 $v_t = \\mathrm{Var}(X_t)$ 的演化方程。方差定义为 $v_t = \\mathbb{E}[(X_t - m_t)^2]$。因为我们发现 $m_t = m_0$ 是一个常数，所以方差为 $v_t = \\mathbb{E}[(X_t - m_0)^2]$。\n我们定义一个中心化过程 $Y_t = X_t - m_0$。由于 $m_0$ 是常数，$Y_t$ 的微分为 $dY_t = dX_t - d(m_0) = dX_t$。\n$X_t$ 的 SDE 可以写为 $dX_t = (-X_t + m_0) dt + \\sigma dW_t$。我们将 $X_t = Y_t + m_0$ 代入此方程，以求得 $Y_t$ 的 SDE：\n$$dY_t = (-(Y_t + m_0) + m_0) dt + \\sigma dW_t$$\n$$dY_t = -Y_t dt + \\sigma dW_t$$\n过程 $Y_t$ 是一个标准的 Ornstein-Uhlenbeck 过程。$X_t$ 的方差是 $v_t = \\mathbb{E}[(X_t - m_0)^2] = \\mathbb{E}[Y_t^2]$。\n为了求 $v_t$ 的演化，我们对函数 $f(y) = y^2$ 应用伊藤公式。其导数为 $f'(y) = 2y$ 和 $f''(y) = 2$。\n伊藤公式给出：\n$$d(Y_t^2) = f'(Y_t)dY_t + \\frac{1}{2}f''(Y_t)d\\langle Y, Y \\rangle_t$$\n$Y_t$ 的二次变分为 $d\\langle Y, Y \\rangle_t = (\\sigma)^2 dt = \\sigma^2 dt$。代入各项：\n$$d(Y_t^2) = 2Y_t(-Y_t dt + \\sigma dW_t) + \\frac{1}{2}(2)(\\sigma^2 dt)$$\n$$d(Y_t^2) = (-2Y_t^2 + \\sigma^2)dt + 2\\sigma Y_t dW_t$$\n为了找到 $v_t = \\mathbb{E}[Y_t^2]$ 的演化方程，我们对此表达式取期望：\n$$d v_t = d\\mathbb{E}[Y_t^2] = \\mathbb{E}[d(Y_t^2)]$$\n$$d v_t = \\mathbb{E}[(-2Y_t^2 + \\sigma^2)dt + 2\\sigma Y_t dW_t]$$\n$$d v_t = (-2\\mathbb{E}[Y_t^2] + \\sigma^2)dt + \\mathbb{E}[2\\sigma Y_t dW_t]$$\n认识到 $\\mathbb{E}[Y_t^2] = v_t$ 且伊藤积分项的期望为零（$\\mathbb{E}[\\int_0^t 2\\sigma Y_s dW_s] = 0$），我们得到方差的常微分方程：\n$$\\frac{dv_t}{dt} = -2v_t + \\sigma^2$$\n\n最后，我们确定方差的长时间极限 $\\lim_{t\\to\\infty} v_t$。如果该极限存在，它对应于常微分方程的稳态解，此时方差为常数，即 $\\frac{dv_t}{dt} = 0$。设 $v_\\infty = \\lim_{t\\to\\infty} v_t$。在演化方程中令时间导数为零，得到：\n$$0 = -2v_\\infty + \\sigma^2$$\n解出 $v_\\infty$：\n$$2v_\\infty = \\sigma^2$$\n$$v_\\infty = \\frac{\\sigma^2}{2}$$\n这就是方差的长时间极限，它只取决于扩散系数 $\\sigma$。该常微分方程的解为 $v_t = \\frac{\\sigma^2}{2} + (v_0 - \\frac{\\sigma^2}{2})\\exp(-2t)$，这证实了当 $t \\to \\infty$ 时，无论初始方差 $v_0$ 是多少，$v_t$ 都收敛于这个值。", "answer": "$$\\boxed{\\frac{\\sigma^2}{2}}$$", "id": "3065754"}, {"introduction": "掌握了基本技巧后，我们可以探索平均场模型最引人入胜的应用之一：解释集体现象。从鸟群飞行到神经元同步放电，平均场理论为理解个体互动如何涌现出宏观有序提供了强大的框架。这个练习将引导你分析著名的仓本模型（Kuramoto model），通过求解一个自洽方程，你将亲眼见证系统如何从无序状态转变为同步状态，即经历一个相变。", "problem": "考虑一个单位圆上相同粒子的 McKean–Vlasov 随机微分方程 (SDE)，其状态为 $\\theta_t \\in [0,2\\pi)$：\n$$\n\\mathrm{d}\\theta_t \\;=\\; - K\\, r_t \\,\\sin\\!\\big(\\theta_t - \\psi_t\\big)\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\n其中 $K>0$ 是耦合强度，$D>0$ 是扩散系数，$W_t$ 是标准维纳过程，平均场序参量的定义为\n$$\nr_t\\,e^{\\mathrm{i}\\psi_t} \\;=\\; \\mathbb{E}\\!\\left[e^{\\mathrm{i}\\theta_t}\\right],\\quad r_t \\in [0,1],\\;\\psi_t \\in [0,2\\pi).\n$$\n假设在相关的 Fokker–Planck 方程和平均场定律下，存在具有静态密度 $f(\\theta)$ 的不随时变的平衡态。从 McKean–Vlasov SDE 的定义和梯度漂移的静态 Fokker–Planck 平衡出发，推导平衡序参量 $r$ 的自洽条件，并根据无量纲参数 $\\alpha = K/D$ 分析其不动点及其稳定性。基于该分析，选择下面所有正确的陈述。\n\nA. 存在一个临界值 $\\alpha_{\\mathrm{c}} = 2$，使得当 $\\alpha  2$ 时不存在非零不动点，而当 $\\alpha > 2$ 时出现一个非零不动点 $r^\\star > 0$。\n\nB. 当 $\\alpha  2$ 时，不动点 $r=0$ 在平均场动力学下是线性稳定的；而当 $\\alpha > 2$ 时，不动点 $r=0$ 是线性不稳定的。\n\nC. 当 $\\alpha > 2$ 时，存在一个非零不动点 $r^\\star > 0$，该不动点是线性稳定的（在相位 $\\psi$ 的旋转对称性下）。\n\nD. 在 $\\alpha = 2$ 处的相变是不连续的（一级相变）：序参量 $r$ 在 $\\alpha=2$ 处跳跃到一个正值。\n\nE. 当 $\\alpha > 2$ 时，存在无穷多个不同的正值量级 $r^\\star$ 解自洽方程。\n\nF. 当 $\\alpha \\downarrow 2^+$ 时，非零解满足 $r^\\star \\sim C\\,\\sqrt{\\alpha - 2}$（其中 $C>0$ 为某个常数），这表明这是一个连续的（二级）相变。", "solution": "该问题要求分析在平均场极限下含噪声的仓本（Kuramoto）模型的平衡性质。我们将推导序参量的自洽方程，并分析其不动点的存在性与稳定性，以确定相变的临界条件。\n\n**静态平衡分布**\n\n首先，我们寻找对应 McKean-Vlasov SDE 的 Fokker-Planck 方程的静态解。SDE 的漂移项为 $b(\\theta, \\mu_t) = -K r_t \\sin(\\theta - \\psi_t)$，扩散系数为 $D$（噪声强度为 $\\sigma = \\sqrt{2D}$）。静态平衡时，概率密度 $p(\\theta, t)$ 变为不依赖于时间的 $f(\\theta)$，序参量 $(r_t, \\psi_t)$ 也变为常数 $(r, \\psi)$。此时，Fokker-Planck 方程的稳态条件要求概率流为零，这给出了：\n$$D \\frac{\\mathrm{d}f}{\\mathrm{d}\\theta} = - K r \\sin(\\theta - \\psi) f(\\theta)$$\n这是一个可分离变量的一阶常微分方程。求解并归一化后，得到静态分布为 von Mises 分布：\n$$f(\\theta) = \\frac{\\exp(\\alpha r \\cos(\\theta - \\psi))}{2\\pi I_0(\\alpha r)}$$\n其中 $\\alpha = K/D$ 是无量纲耦合强度，而 $I_0(x)$ 是零阶第一类修正贝塞尔函数。\n\n**自洽方程**\n\n序参量 $r$ 和 $\\psi$ 由其定义 $r e^{\\mathrm{i}\\psi} = \\mathbb{E}[e^{\\mathrm{i}\\theta}] = \\int_0^{2\\pi} e^{\\mathrm{i}\\theta} f(\\theta) \\mathrm{d}\\theta$ 决定。利用旋转对称性，我们可以设平均相位 $\\psi=0$。将 $f(\\theta)$ 的表达式代入，我们得到：\n$$r = \\int_0^{2\\pi} \\cos(\\theta) f(\\theta) \\mathrm{d}\\theta = \\frac{1}{2\\pi I_0(\\alpha r)} \\int_0^{2\\pi} \\cos\\theta \\exp(\\alpha r \\cos\\theta) \\mathrm{d}\\theta$$\n根据修正贝塞尔函数的积分定义，该积分等于 $2\\pi I_1(\\alpha r)$，其中 $I_1(x)$ 是一阶第一类修正贝塞尔函数。因此，我们得到了序参量 $r$ 必须满足的自洽方程：\n$$r = \\frac{I_1(\\alpha r)}{I_0(\\alpha r)}$$\n\n**不动点与稳定性分析**\n\n我们需要求解方程 $r = F(r)$，其中 $F(r) = \\frac{I_1(\\alpha r)}{I_0(\\alpha r)}$。\n1.  **平凡解**：$r=0$ 始终是一个解，因为 $F(0) = 0$。这对应于所有振子相位随机分布的非相干（无序）状态。\n2.  **非平凡解**：为了寻找 $r>0$ 的解，我们考察函数 $F(r)$ 在原点附近的泰勒展开：$F(r) \\approx \\frac{\\alpha}{2}r - \\frac{\\alpha^3}{16}r^3 + O(r^5)$。要使 $r > 0$ 的解存在，直线 $y=r$ 和曲线 $y=F(r)$ 必须在原点之外有交点。这要求 $F(r)$ 在原点的斜率大于 1，即 $F'(0) > 1$。由于 $F'(0) = \\alpha/2$，临界条件为 $\\alpha/2 > 1$，即 $\\alpha > 2$。因此，在 $\\alpha_c = 2$ 处发生分岔，当且仅当 $\\alpha > 2$ 时，出现一个非零的同步解 $r^\\star > 0$。\n3.  **稳定性**：不动点的稳定性由导数决定。\n    -   对于 $r=0$：其稳定性由 $F'(0) = \\alpha/2$ 决定。当 $\\alpha  2$ 时，$F'(0)  1$，因此 $r=0$ 是稳定不动点（系统保持无序）。当 $\\alpha > 2$ 时，$F'(0) > 1$，因此 $r=0$ 变为不稳定不动点（任何微小扰动都会使系统趋向同步）。\n    -   对于 $r^\\star > 0$（当 $\\alpha > 2$ 时存在）：函数 $F(r)$ 是凹函数，从斜率大于1的位置出发，最终趋于1。因此，在非零交点 $r^\\star$ 处，其斜率必然小于1，即 $0  F'(r^\\star)  1$。这意味着非零解 $r^\\star$ 是稳定的。\n4.  **相变类型**：当 $\\alpha$ 略大于 2 时，非零解满足 $r^{\\star 2} \\approx \\frac{8(\\alpha - 2)}{\\alpha^3}$，这意味着 $r^\\star \\propto \\sqrt{\\alpha - 2}$。序参量从零连续增长，这表明在 $\\alpha_c=2$ 处发生的是一个连续的（二级）相变。\n\n**结论**\n基于以上分析：\n- A, B, C 是正确的，它们准确描述了临界点、不动点的存在性以及它们的稳定性。\n- D 是不正确的，相变是连续的（二级），而非不连续的（一级）。\n- E 是不正确的，对于 $\\alpha > 2$，只有一个正的稳定解。\n- F 是正确的，它给出了相变点附近的正确标度行为，并将其识别为连续相变。", "answer": "$$\\boxed{ABCF}$$", "id": "3065766"}, {"introduction": "理论分析为我们提供了深刻的洞见，而数值模拟则是连接理论与实践的桥梁，对于验证预测和探索复杂模型至关重要。这个练习将指导你从零开始编写一个粒子系统模拟器，用以逼近麦基恩-弗拉索夫方程的解。通过亲手实现欧拉-丸山（Euler-Maruyama）格式，你将直观地观察到粒子云如何演化，并验证其宏观统计量是否与理论预测相符，从而真正“看到”平均场极限的发生。", "problem": "考虑一个由标准布朗运动 $W_t$ 驱动的过程 $X_t$ 的一维 McKean–Vlasov 随机微分方程 (SDE)，\n$$\ndX_t = b\\big(X_t,\\mu_t\\big)\\,dt + \\sigma\\big(X_t,\\mu_t\\big)\\,dW_t,\n$$\n其中 $\\mu_t$ 表示 $X_t$ 的分布，$b$ 和 $\\sigma$ 是可测函数。具有 $N$ 个粒子的平均场粒子近似将 $\\mu_t$ 替换为经验测度 $\\mu_t^N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{X_t^{i,N}}$，并根据以下方程演化粒子系统 $\\{X_t^{i,N}\\}_{i=1}^N$\n$$\ndX_t^{i,N} = b\\big(X_t^{i,N},\\mu_t^N\\big)\\,dt + \\sigma\\big(X_t^{i,N},\\mu_t^N\\big)\\,dW_t^i,\n$$\n其中 $\\{W_t^i\\}_{i=1}^N$ 是相互独立的标准布朗运动。使用 Euler–Maruyama 格式，在时间步长为 $\\Delta t$ 且 $K = \\lfloor T/\\Delta t \\rfloor$ 的均匀网格上的离散时间近似 $\\{X_k^{i,N}\\}_{k=0}^{K}$ 由独立的服从正态分布的增量 $\\Delta W_k^i \\sim \\mathcal{N}(0,\\Delta t)$ 和以下更新规则定义\n$$\nX_{k+1}^{i,N} = X_k^{i,N} + b\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta t + \\sigma\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta W_k^i,\n$$\n其中 $\\mu_k^N = \\frac{1}{N}\\sum_{j=1}^N \\delta_{X_k^{j,N}}$。\n\n您的任务是为以下三种模型类别实现此 Euler–Maruyama 格式（每种模型由函数 $b$ 和 $\\sigma$ 指定），并在时间 $T$ 将经验均值和方差与解析推导的预测值进行比较：\n\n1. 中心化 Ornstein–Uhlenbeck 平均场模型：\n   - 漂移项：$b(x,\\mu) = -\\alpha\\,(x - m)$，其中 $m = \\int y\\,\\mu(dy)$。\n   - 扩散项：$\\sigma(x,\\mu) = \\beta$，一个常数。\n   - 解析预测：对于 $m_0 = \\mathbb{E}[X_0]$ 和 $s_0^2 = \\mathrm{Var}(X_0)$，均值保持不变，$m_T = m_0$。定义 $Y_t = X_t - m_t$，$Y_t$ 满足 Ornstein–Uhlenbeck 动力学，得到\n     $$\n     \\mathrm{Var}(X_T) =\n     \\begin{cases}\n     s_0^2\\,e^{-2\\alpha T} + \\frac{\\beta^2}{2\\alpha}\\big(1 - e^{-2\\alpha T}\\big),  \\alpha > 0 \\\\\n     s_0^2 + \\beta^2 T,  \\alpha = 0\n     \\end{cases}\n     $$\n\n2. 确定性共识（无扩散）：\n   - 漂移项：$b(x,\\mu) = -\\alpha\\,(x - m)$，其中 $m = \\int y\\,\\mu(dy)$。\n   - 扩散项：$\\sigma(x,\\mu) = 0$。\n   - 解析预测：$m_T = m_0$ 且 $\\mathrm{Var}(X_T) = s_0^2\\,e^{-2\\alpha T}$。\n\n3. 仿射均值驱动模型：\n   - 漂移项：$b(x,\\mu) = -\\alpha\\,x + \\gamma\\,m$，其中 $m = \\int y\\,\\mu(dy)$。\n   - 扩散项：$\\sigma(x,\\mu) = \\beta$，一个常数。\n   - 解析预测：均值满足方程 $dm_t = (\\gamma - \\alpha)\\,m_t\\,dt$，因此 $m_T = m_0\\,e^{(\\gamma - \\alpha)T}$。对于 $Y_t = X_t - m_t$，有 $dY_t = -\\alpha\\,Y_t\\,dt + \\beta\\,dW_t$，因此\n     $$\n     \\mathrm{Var}(X_T) =\n     \\begin{cases}\n     s_0^2\\,e^{-2\\alpha T} + \\frac{\\beta^2}{2\\alpha}\\big(1 - e^{-2\\alpha T}\\big),  \\alpha > 0 \\\\\n     s_0^2 + \\beta^2 T,  \\alpha = 0\n     \\end{cases}\n     $$\n\n使用以下测试套件。在所有测试中，从正态分布 $\\mathcal{N}(m_0,s_0^2)$ 中独立地初始化 $X_0^{i,N}$，并使用独立的服从正态分布的增量 $\\Delta W_k^i \\sim \\mathcal{N}(0,\\Delta t)$。整数 $K$ 必须是 $K = \\lfloor T/\\Delta t \\rfloor$，并且模拟应进行 $K$ 步，因此模拟的最终时间为 $K\\,\\Delta t$。\n\n- 测试用例 A (中心化 Ornstein–Uhlenbeck，正常路径)：\n  - $N=2000$，$T=1.0$，$\\Delta t=0.001$，$\\alpha=3.0$，$\\beta=0.8$，$m_0=1.25$，$s_0=2.0$，随机种子 $12345$。\n\n- 测试用例 B (确定性共识，零扩散边界情况)：\n  - $N=2000$，$T=0.8$，$\\Delta t=0.001$，$\\alpha=2.0$，$\\beta=0.0$，$m_0=-0.5$，$s_0=1.0$，随机种子 $34567$。\n\n- 测试用例 C (仿射均值驱动，非平凡的均值增长/衰减)：\n  - $N=2000$，$T=1.2$，$\\Delta t=0.001$，$\\alpha=1.0$，$\\beta=0.7$，$\\gamma=0.4$，$m_0=0.75$，$s_0=0.5$，随机种子 $98765$。\n\n- 测试用例 D (中心化 Ornstein–Uhlenbeck，$\\alpha=0$ 边界情况)：\n  - $N=2000$，$T=0.7$，$\\Delta t=0.001$，$\\alpha=0.0$，$\\beta=0.65$，$m_0=0.0$，$s_0=0.9$，随机种子 $24680$。\n\n为每个测试用例实现 Euler–Maruyama 粒子模拟，在最终时间 $K\\,\\Delta t$ 计算经验均值 $\\widehat{m}_T^N$ 和经验方差 $\\widehat{v}_T^N$，并通过报告绝对误差将它们与上述解析预测进行比较：\n$$\n\\varepsilon_{\\mathrm{mean}} = \\big|\\widehat{m}_T^N - m_T\\big|,\\qquad\n\\varepsilon_{\\mathrm{var}} = \\big|\\widehat{v}_T^N - \\mathrm{Var}(X_T)\\big|.\n$$\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序如下\n$$\n\\big[\\varepsilon_{\\mathrm{mean}}^{\\mathrm{A}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{A}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{B}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{B}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{C}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{C}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{D}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{D}}\\big],\n$$\n每个条目都打印为浮点数。此问题不涉及物理单位。程序必须是完整的，并且无需任何外部输入即可运行，并且必须使用指定的随机种子以保证可复现性。", "solution": "该问题要求为三种不同类型的平均场相互作用粒子系统实现欧拉-丸山（Euler-Maruyama）模拟，并将模拟结果与理论预测进行比较。下面是实现该模拟并计算所需误差的详细方法。\n\n**方法论**\n\n解决方案的核心是对一个 N 粒子系统进行数值积分，该系统旨在近似一个 McKean-Vlasov 随机微分方程 (SDE)。对于每个测试用例，我们遵循以下步骤：\n\n1.  **初始化**：在时间 $t=0$，我们创建一个包含 $N$ 个粒子的系统。每个粒子 $i$ 的初始位置 $X_0^{i,N}$ 是从指定均值 $m_0$ 和方差 $s_0^2$ 的正态分布 $\\mathcal{N}(m_0, s_0^2)$ 中独立抽取的。为了保证结果的可复现性，我们使用问题中为每个案例指定的随机种子。\n\n2.  **时间演化**：我们将时间区间 $[0, T]$ 划分为 $K = \\lfloor T/\\Delta t \\rfloor$ 个长度为 $\\Delta t$ 的离散时间步。然后，我们通过迭代 $K$ 次来模拟系统的演化，直到最终时间 $T$。\n\n3.  **欧拉-丸山更新**：在每个时间步 $k$，我们使用欧拉-丸山格式更新所有粒子的位置。对于第 $i$ 个粒子，更新规则为：\n    $$X_{k+1}^{i,N} = X_k^{i,N} + b(X_k^{i,N},\\mu_k^N)\\,\\Delta t + \\sigma(X_k^{i,N},\\mu_k^N)\\,\\Delta W_k^i$$\n    - 漂移项 $b$ 和扩散项 $\\sigma$ 对粒子群体分布 $\\mu_k^N$ 的依赖性通过经验测度来近似。具体来说，在时刻 $k$ 的平均场均值 $m$ 被替换为所有粒子位置的样本均值：$m_k^N = \\frac{1}{N}\\sum_{j=1}^N X_k^{j,N}$。\n    - 随机项 $\\Delta W_k^i$ 是独立的维纳过程增量，通过从正态分布 $\\mathcal{N}(0, \\Delta t)$ 中抽取独立样本来模拟。\n\n4.  **模型实现**：根据问题中指定的三个模型，我们实现相应的漂移和扩散函数。例如，对于中心化 Ornstein–Uhlenbeck 模型，漂移项为 $b(X_k^{i,N}, \\mu_k^N) = -\\alpha(X_k^{i,N} - m_k^N)$，扩散项为常数 $\\beta$。\n\n5.  **误差计算**：在模拟结束时（时刻 $T$），我们计算最终粒子位置 $\\{X_K^{i,N}\\}$ 的经验均值 $\\widehat{m}_T^N$ 和经验方差 $\\widehat{v}_T^N$。然后，我们将这些经验值与问题中提供的精确解析解 $m_T$ 和 $\\mathrm{Var}(X_T)$ 进行比较，计算它们之间的绝对误差 $\\varepsilon_{\\mathrm{mean}}$ 和 $\\varepsilon_{\\mathrm{var}}$。\n\n将此过程应用于所有四个测试用例，我们就可以得到所需的八个误差值。具体的实现通过 Python 的 `numpy` 库来高效地处理向量化计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_analytic_solution(model_type, T, params, m0, s0):\n    \"\"\"\n    Calculates the analytical mean and variance at time T.\n    \"\"\"\n    alpha = params.get('alpha', 0.0)\n    beta = params.get('beta', 0.0)\n    s0_sq = s0**2\n\n    if model_type == 'OU':\n        # This covers Centered-OU and Deterministic Consensus (beta=0)\n        m_T = m0\n        if alpha == 0.0:\n            var_T = s0_sq + beta**2 * T\n        else: # alpha > 0\n            exp_term = np.exp(-2 * alpha * T)\n            var_T = s0_sq * exp_term + (beta**2 / (2 * alpha)) * (1 - exp_term)\n            \n    elif model_type == 'Affine':\n        gamma = params['gamma']\n        m_T = m0 * np.exp((gamma - alpha) * T)\n        if alpha == 0.0:\n            var_T = s0_sq + beta**2 * T\n        else: # alpha > 0\n            exp_term = np.exp(-2 * alpha * T)\n            var_T = s0_sq * exp_term + (beta**2 / (2 * alpha)) * (1 - exp_term)\n    else:\n        raise ValueError(f\"Unknown model type: {model_type}\")\n    \n    return m_T, var_T\n\n\ndef run_simulation_case(model_type, N, T, dt, params, m0, s0, seed):\n    \"\"\"\n    Runs the Euler-Maruyama simulation for a single test case.\n    \"\"\"\n    # 1. Initialization\n    rng = np.random.default_rng(seed)\n    # Initial particle positions from N(m0, s0^2)\n    X = rng.normal(loc=m0, scale=s0, size=N)\n\n    # 2. Time Discretization\n    K = int(T / dt)\n    sqrt_dt = np.sqrt(dt)\n\n    # 3. Euler-Maruyama Iteration\n    for _ in range(K):\n        # Compute empirical mean for interaction term\n        m_k_N = np.mean(X)\n        \n        # Generate Wiener increments\n        dW = rng.normal(loc=0.0, scale=sqrt_dt, size=N)\n        \n        # 4. Model-Specific Dynamics\n        if model_type == 'OU':\n            alpha = params['alpha']\n            beta = params['beta']\n            drift = -alpha * (X - m_k_N)\n            diffusion = beta\n            \n        elif model_type == 'Affine':\n            alpha = params['alpha']\n            beta = params['beta']\n            gamma = params['gamma']\n            drift = -alpha * X + gamma * m_k_N\n            diffusion = beta\n        else:\n             raise ValueError(f\"Unknown model type: {model_type}\")\n\n        # Update particle positions\n        X = X + drift * dt + diffusion * dW\n\n    # 5. Final Statistics and Error Calculation\n    # Empirical stats at final time T = K * dt\n    m_hat_T = np.mean(X)\n    v_hat_T = np.var(X) # ddof=0 is default, corresponding to 1/N\n\n    # Analytical stats\n    T_final = K * dt\n    m_T, var_T = calculate_analytic_solution(model_type, T_final, params, m0, s0)\n    \n    # Absolute errors\n    err_mean = np.abs(m_hat_T - m_T)\n    err_var = np.abs(v_hat_T - var_T)\n\n    return err_mean, err_var\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A (centered Ornstein–Uhlenbeck)\n        { 'model_type': 'OU', 'N': 2000, 'T': 1.0, 'dt': 0.001,\n          'params': {'alpha': 3.0, 'beta': 0.8}, 'm0': 1.25, 's0': 2.0, 'seed': 12345 },\n        \n        # Test case B (deterministic consensus, handled as OU with beta=0)\n        { 'model_type': 'OU', 'N': 2000, 'T': 0.8, 'dt': 0.001,\n          'params': {'alpha': 2.0, 'beta': 0.0}, 'm0': -0.5, 's0': 1.0, 'seed': 34567 },\n        \n        # Test case C (affine mean-driven)\n        { 'model_type': 'Affine', 'N': 2000, 'T': 1.2, 'dt': 0.001,\n          'params': {'alpha': 1.0, 'beta': 0.7, 'gamma': 0.4}, 'm0': 0.75, 's0': 0.5, 'seed': 98765 },\n\n        # Test case D (centered Ornstein–Uhlenbeck, alpha=0)\n        { 'model_type': 'OU', 'N': 2000, 'T': 0.7, 'dt': 0.001,\n          'params': {'alpha': 0.0, 'beta': 0.65}, 'm0': 0.0, 's0': 0.9, 'seed': 24680 }\n    ]\n\n    results = []\n    for case in test_cases:\n        err_mean, err_var = run_simulation_case(**case)\n        results.extend([err_mean, err_var])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3065755"}]}