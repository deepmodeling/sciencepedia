{"hands_on_practices": [{"introduction": "我们从一个最典型的模型——几何布朗运动（Geometric Brownian Motion）开始。这个模型常用于描述受随机波动影响的指数增长过程，例如股票价格。通过计算其李雅普诺夫指数，你将练习使用伊藤引理（Itô's lemma）这一核心工具来分析随机系统的长期平均增长率。([@problem_id:3064458])", "problem": "考虑在一个带流概率空间 $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\geq 0}, \\mathbb{P})$ 上的标量随机微分方程 (SDE) $dX_t = a X_t \\, dt + \\sigma X_t \\, dW_t$，其中 $W_t$ 是一个标准布朗运动（也称为维纳过程），$a \\in \\mathbb{R}$ 和 $\\sigma \\in \\mathbb{R}$ 是常数，且 $X_0 \\in \\mathbb{R} \\setminus \\{0\\}$ 是确定的。仅使用如伊藤引理和基本鞅性质等基础工具，计算 $\\mathbb{P}$-几乎必然 (a.s.) 极限 $\\lim_{t \\to \\infty} \\frac{1}{t} \\ln |X_t|$。您的最终答案必须是单个用 $a$ 和 $\\sigma$ 表示的闭式解析表达式。", "solution": "该问题要求计算几乎必然极限 $\\lim_{t \\to \\infty} \\frac{1}{t} \\ln |X_t|$，其中 $X_t$ 是标量随机微分方程 (SDE) 的解：\n$$dX_t = a X_t \\, dt + \\sigma X_t \\, dW_t$$\n初始条件为 $X_0 \\in \\mathbb{R} \\setminus \\{0\\}$，一个确定性常数。参数 $a$ 和 $\\sigma$ 是实常数，$W_t$ 是标准一维布朗运动。这个 SDE 是几何布朗运动的一个经典例子。\n\n为了找到 $\\ln|X_t|$ 的表达式，我们对函数 $f(x) = \\ln|x|$ 应用伊藤引理。对于 $x \\neq 0$， $f(x)$ 的一阶和二阶导数分别为 $f'(x) = \\frac{1}{x}$ 和 $f''(x) = -\\frac{1}{x^2}$。给定 SDE 从非零值 $X_0$ 出发的解，在 $t  0$ 时几乎必然永远不会达到 $0$，因此 $f(X_t)$ 是良定的。\n\n令 $Y_t = f(X_t) = \\ln|X_t|$。根据伊藤引理，微分 $dY_t$ 由下式给出：\n$$dY_t = f'(X_t) \\, dX_t + \\frac{1}{2} f''(X_t) \\, (dX_t)^2$$\n我们代入 $dX_t$、$f'(X_t)$ 和 $f''(X_t)$ 的表达式：\n$$dY_t = \\frac{1}{X_t} (a X_t \\, dt + \\sigma X_t \\, dW_t) + \\frac{1}{2} \\left(-\\frac{1}{X_t^2}\\right) (dX_t)^2$$\n二次变差项 $(dX_t)^2$ 使用伊藤微积分的规则计算：$(dt)^2 = 0$，$dt \\, dW_t = 0$ 以及 $(dW_t)^2 = dt$。\n$$(dX_t)^2 = (a X_t \\, dt + \\sigma X_t \\, dW_t)^2 = (\\sigma X_t)^2 (dW_t)^2 = \\sigma^2 X_t^2 \\, dt$$\n我们将此代回到 $dY_t$ 的表达式中：\n$$dY_t = \\frac{1}{X_t} (a X_t \\, dt + \\sigma X_t \\, dW_t) - \\frac{1}{2} \\frac{1}{X_t^2} (\\sigma^2 X_t^2 \\, dt)$$\n化简这些项，我们得到：\n$$dY_t = (a \\, dt + \\sigma \\, dW_t) - \\frac{1}{2} \\sigma^2 \\, dt$$\n$$dY_t = \\left(a - \\frac{1}{2} \\sigma^2\\right) dt + \\sigma \\, dW_t$$\n这是关于 $Y_t = \\ln|X_t|$ 的一个 SDE。我们可以通过从 $s=0$ 到 $s=t$ 积分来解出 $Y_t$：\n$$\\int_0^t dY_s = \\int_0^t \\left(a - \\frac{1}{2} \\sigma^2\\right) ds + \\int_0^t \\sigma \\, dW_s$$\n这得出：\n$$Y_t - Y_0 = \\left(a - \\frac{1}{2} \\sigma^2\\right) t + \\sigma (W_t - W_0)$$\n已知 $Y_t = \\ln|X_t|$ 并且按照惯例 $W_0=0$，我们有：\n$$\\ln|X_t| - \\ln|X_0| = \\left(a - \\frac{1}{2} \\sigma^2\\right) t + \\sigma W_t$$\n整理这些项，得到 $\\ln|X_t|$ 的显式解：\n$$\\ln|X_t| = \\ln|X_0| + \\left(a - \\frac{1}{2} \\sigma^2\\right) t + \\sigma W_t$$\n现在我们可以计算所求的极限。我们将整个表达式除以 $t$：\n$$\\frac{1}{t} \\ln|X_t| = \\frac{\\ln|X_0|}{t} + a - \\frac{1}{2} \\sigma^2 + \\sigma \\frac{W_t}{t}$$\n我们取 $t \\to \\infty$ 时的极限：\n$$\\lim_{t \\to \\infty} \\frac{1}{t} \\ln|X_t| = \\lim_{t \\to \\infty} \\left( \\frac{\\ln|X_0|}{t} + a - \\frac{1}{2} \\sigma^2 + \\sigma \\frac{W_t}{t} \\right)$$\n我们分别计算每一项的极限。极限运算是在 $\\mathbb{P}$-几乎必然的基础上进行的。\n1. 项 $\\frac{\\ln|X_0|}{t}$：由于 $X_0$ 是一个非零的确定性常数，$\\ln|X_0|$ 是一个有限常数。因此，$\\lim_{t \\to \\infty} \\frac{\\ln|X_0|}{t} = 0$。\n2. 项 $a - \\frac{1}{2} \\sigma^2$：这是一个常数，所以它的极限是其本身。\n3. 项 $\\sigma \\frac{W_t}{t}$：关键部分是标准布朗运动 $W_t$ 的渐近行为。布朗运动的强大数定律表明 $\\lim_{t \\to \\infty} \\frac{W_t}{t} = 0$ 几乎必然成立。由于 $\\sigma$ 是一个常数，我们有 $\\lim_{t \\to \\infty} \\sigma \\frac{W_t}{t} = \\sigma \\cdot 0 = 0$ 几乎必然成立。\n\n综合这些结果，我们得到几乎必然极限：\n$$\\lim_{t \\to \\infty} \\frac{1}{t} \\ln|X_t| = 0 + \\left(a - \\frac{1}{2} \\sigma^2\\right) + 0 = a - \\frac{1}{2} \\sigma^2$$\n这个极限被称为由该 SDE 定义的随机动力系统的顶李雅普诺夫指数。它刻画了解的长期平均指数增长或衰减率。", "answer": "$$\\boxed{a - \\frac{1}{2}\\sigma^2}$$", "id": "3064458"}, {"introduction": "在分析了乘性噪声后，一个自然的问题是：加性噪声会如何影响系统的稳定性？本练习将探讨奥恩斯坦-乌伦贝克（Ornstein–Uhlenbeck）过程，这是一个经典的均值回归模型。通过计算其李雅普诺夫指数，你将发现一个关键结论：对于线性系统，加性噪声本身并不影响两条轨迹之间的分离率，这与乘性噪声的情况形成了鲜明对比。([@problem_id:3064437])", "problem": "考虑由以下随机微分方程（SDE）描述的一维Ornstein–Uhlenbeck过程：\n$$\ndX_t = -\\gamma X_t\\,dt + \\sigma\\,dW_t,\n$$\n其中 $\\gamma0$ 和 $\\sigma\\ge 0$ 为常数，$(W_t)_{t\\ge 0}$ 是标准维纳过程（布朗运动）。两个解 $X_t^{(1)}$ 和 $X_t^{(2)}$ 由同一布朗运动实现驱动，但初始条件不同，$X_0^{(1)}\\neq X_0^{(2)}$。此随机动力系统的最大李雅普诺夫指数 $\\lambda$ 定义为长时间分离率\n$$\n\\lambda \\equiv \\lim_{t\\to\\infty}\\frac{1}{t}\\ln\\left(\\frac{|X_t^{(1)}-X_t^{(2)}|}{|X_0^{(1)}-X_0^{(2)}|}\\right),\n$$\n当该极限几乎必然存在时。\n\n从随机微积分的核心定义和经过检验的结果出发，计算该系统的李雅普诺夫指数 $\\lambda$，并从第一性原理证明为什么加性噪声不改变 $\\lambda$ 的值。将最终答案表示为关于 $\\gamma$ 和 $\\sigma$ 的单个闭式解析表达式。无需四舍五入，不涉及物理单位。", "solution": "问题要求计算一维Ornstein-Uhlenbeck过程的最大李雅普诺夫指数 $\\lambda$，并证明加性噪声为何不影响其值。\n\n其控制随机微分方程（SDE）为：\n$$\ndX_t = -\\gamma X_t\\,dt + \\sigma\\,dW_t\n$$\n其中 $\\gamma  0$ 和 $\\sigma \\ge 0$ 为常数，$(W_t)_{t \\ge 0}$ 是标准维纳过程。\n\n我们考虑两个从不同初始条件 $X_0^{(1)} \\neq X_0^{(2)}$ 出发的解 $X_t^{(1)}$ 和 $X_t^{(2)}$。关键在于，两个解都由同一维纳过程 $W_t$ 的实现驱动。各自的SDE为：\n$$\ndX_t^{(1)} = -\\gamma X_t^{(1)}\\,dt + \\sigma\\,dW_t\n$$\n$$\ndX_t^{(2)} = -\\gamma X_t^{(2)}\\,dt + \\sigma\\,dW_t\n$$\n为了分析这两条轨迹的分离情况，我们定义一个新过程 $\\Delta X_t$，代表它们之间的差值：\n$$\n\\Delta X_t \\equiv X_t^{(1)} - X_t^{(2)}\n$$\n初始差值为 $\\Delta X_0 = X_0^{(1)} - X_0^{(2)}$，根据题设，该值非零。\n\n我们通过将第二个SDE从第一个SDE中减去，来推导 $\\Delta X_t$ 的微分方程。利用微分算子 $d$ 的线性性质，我们有：\n$$\nd(\\Delta X_t) = d(X_t^{(1)} - X_t^{(2)}) = dX_t^{(1)} - dX_t^{(2)}\n$$\n代入 $dX_t^{(1)}$ 和 $dX_t^{(2)}$ 的表达式，得到：\n$$\nd(\\Delta X_t) = (-\\gamma X_t^{(1)}\\,dt + \\sigma\\,dW_t) - (-\\gamma X_t^{(2)}\\,dt + \\sigma\\,dW_t)\n$$\n我们可以将各项重新整理如下：\n$$\nd(\\Delta X_t) = (-\\gamma X_t^{(1)} + \\gamma X_t^{(2)})\\,dt + (\\sigma - \\sigma)\\,dW_t\n$$\n$$\nd(\\Delta X_t) = -\\gamma (X_t^{(1)} - X_t^{(2)})\\,dt + 0 \\cdot dW_t\n$$\n通过代入定义 $\\Delta X_t = X_t^{(1)} - X_t^{(2)}$，我们得到分离量的控制方程：\n$$\nd(\\Delta X_t) = -\\gamma \\Delta X_t\\,dt\n$$\n此方程是一个确定性线性常微分方程（ODE）。随机项已完全消失。这为加性噪声（由项 $\\sigma\\,dW_t$ 表示）不影响轨迹之间差值的演化提供了第一性原理的证明。噪声项与状态 $X_t$ 无关，这意味着它在每一时刻都对两条轨迹施加相同的随机冲量。因此，虽然轨迹本身是随机的，但它们的差值 $\\Delta X_t$ 的演化是确定性的。\n\n我们可以用分离变量法求解此ODE：\n$$\n\\frac{d(\\Delta X_t)}{\\Delta X_t} = -\\gamma\\,dt\n$$\n对两边从初始时间 $t=0$ 到稍后时间 $t$ 进行积分，得到：\n$$\n\\int_{\\Delta X_0}^{\\Delta X_t} \\frac{1}{u}\\,du = \\int_0^t -\\gamma\\,ds\n$$\n$$\n\\ln|\\Delta X_t| - \\ln|\\Delta X_0| = -\\gamma t\n$$\n整理各项，我们得到分离量大小的显式解：\n$$\n\\ln\\left(\\frac{|\\Delta X_t|}{|\\Delta X_0|}\\right) = -\\gamma t\n$$\n对两边取指数，得到分离量本身的解：\n$$\n|\\Delta X_t| = |\\Delta X_0| \\exp(-\\gamma t)\n$$\n现在，我们可以根据其定义计算李雅普诺夫指数 $\\lambda$：\n$$\n\\lambda \\equiv \\lim_{t\\to\\infty}\\frac{1}{t}\\ln\\left(\\frac{|X_t^{(1)}-X_t^{(2)}|}{|X_0^{(1)}-X_0^{(2)}|}\\right)\n$$\n代入 $|\\Delta X_t|$ 和 $|\\Delta X_0|$：\n$$\n\\lambda = \\lim_{t\\to\\infty}\\frac{1}{t}\\ln\\left(\\frac{|\\Delta X_t|}{|\\Delta X_0|}\\right)\n$$\n使用我们得到的分离量演化解，我们有：\n$$\n\\lambda = \\lim_{t\\to\\infty}\\frac{1}{t}\\ln\\left(\\frac{|\\Delta X_0| \\exp(-\\gamma t)}{|\\Delta X_0|}\\right)\n$$\n由于 $\\Delta X_0 \\neq 0$，我们可以消去项 $|\\Delta X_0|$：\n$$\n\\lambda = \\lim_{t\\to\\infty}\\frac{1}{t}\\ln(\\exp(-\\gamma t))\n$$\n自然对数和指数函数互为反函数，所以：\n$$\n\\lambda = \\lim_{t\\to\\infty}\\frac{1}{t}(-\\gamma t)\n$$\n$$\n\\lambda = \\lim_{t\\to\\infty}(-\\gamma)\n$$\n常数的极限就是其本身。因此，李雅普诺夫指数为：\n$$\n\\lambda = -\\gamma\n$$\n此结果与 $\\sigma$ 无关，这正式证实了加性噪声的大小不改变此线性系统的李雅普诺夫指数。该指数完全由确定性的恢复漂移项 $-\\gamma X_t$ 决定。条件 $\\gamma  0$ 确保了 $\\lambda$ 为负，这对应于一个随机稳定系统，其中初始分离的轨迹随时间指数收敛。$\\lambda$ 定义中的“几乎必然”条件在此被轻易满足，因为分离量的演化是完全确定性的。", "answer": "$$\n\\boxed{-\\gamma}\n$$", "id": "3064437"}, {"introduction": "解析解通常只适用于简单的低维系统。对于科学和工程中更真实、更复杂的高维模型，我们必须依赖数值方法。本练习将指导你实现一个强大而标准的方法——基于QR分解的算法——来估计高维线性随机系统的最大李雅普诺夫指数，从而将理论知识应用于实践，解决无法手动计算的问题。([@problem_id:3064480])", "problem": "考虑$\\mathbb{R}^d$中的具有乘性噪声的线性随机微分方程，\n$$\ndY_t \\;=\\; A\\,Y_t\\,dt \\;+\\; \\sum_{i=1}^{m} B_i\\,Y_t\\,dW_t^{(i)},\n$$\n其中$A \\in \\mathbb{R}^{d\\times d}$是一个常数漂移矩阵，每个$B_i \\in \\mathbb{R}^{d\\times d}$是一个常数扩散（噪声）矩阵，而$W_t^{(i)}$是独立的标准布朗运动（维纳过程）。此随机线性流的顶李雅普诺夫指数$\\lambda_1$由以下极限定义：\n$$\n\\lambda_1 \\;=\\; \\lim_{t\\to\\infty} \\frac{1}{t}\\,\\log \\,\\frac{\\|Y_t\\|}{\\|Y_0\\|},\n$$\n对于典型的初始条件$Y_0 \\neq 0$，其中$\\|\\cdot\\|$表示$\\mathbb{R}^d$上的欧几里得范数。\n\n编写一个完整、可运行的程序，使用一种演化多个切向量并通过正交-三角（QR）分解进行周期性再正交化的数值算法来估计$\\lambda_1$。您的程序必须：\n- 以步长$\\Delta t$离散化时间，并对线性系统使用欧拉-丸山（Euler–Maruyama）更新。对于每个时间步，通过独立的高斯随机变量$\\Delta W^{(i)} \\sim \\mathcal{N}(0,\\Delta t)$来近似布朗增量，并用以下矩阵更新流：\n$$\nM_k \\;=\\; I_d \\;+\\; A\\,\\Delta t \\;+\\; \\sum_{i=1}^{m} B_i\\,\\Delta W_k^{(i)},\n$$\n其中$I_d$是$d\\times d$单位矩阵，$k$是时间步索引。\n- 同时演化$d$个切向量，这些向量排列为一个矩阵$Q_k \\in \\mathbb{R}^{d\\times d}$的列，从一个正交归一基开始（例如，$Q_0 = I_d$）。在一个包含$p$个时间步的块上，累积乘积$V = M_{k+p-1}\\cdots M_{k} Q_k$。\n- 每$p$个时间步，执行QR分解$V = Q\\,R$，其中$Q \\in \\mathbb{R}^{d\\times d}$是正交矩阵，$R \\in \\mathbb{R}^{d\\times d}$是上三角矩阵。记录第一个对角元素绝对值的对数$\\log|R_{11}|$。用$Q$替换$Q_k$并继续。如果模拟在再正交化点之间结束，则执行最后一次QR步骤以记录剩余的增长。\n- 通过将所有QR步骤中$\\log|R_{11}|$的累积总和除以总模拟时间$T$来估计顶李雅普诺夫指数。\n\n您的程序必须实现此算法，并为以下测试套件生成结果。在有噪声的情况下，使用给定的随机种子以保证可复现性。在所有情况下，将初始正交归一矩阵设置为$Q_0 = I_d$。\n\n测试套件：\n1. 一维解析基准：\n   - 维度：$d=1$。\n   - 噪声分量数量：$m=1$。\n   - 漂移：$A = [0.3]$。\n   - 扩散矩阵：$B_1 = [0.8]$。\n   - 总时间：$T = 50.0$。\n   - 时间步长：$\\Delta t = 10^{-3}$。\n   - 再正交化周期（步数）：$p = 10$。\n   - 随机种子：$42$。\n\n2. 二维确定性基准：\n   - 维度：$d=2$。\n   - 噪声分量数量：$m=0$。\n   - 漂移：$A = \\mathrm{diag}(0.1,\\,-0.5)$。\n   - 扩散矩阵：无。\n   - 总时间：$T = 50.0$。\n   - 时间步长：$\\Delta t = 10^{-3}$。\n   - 再正交化周期（步数）：$p = 10$。\n   - 随机种子：$123$（未使用，但为保持接口一致性而包含）。\n\n3. 二维具有各向同性乘性噪声的稳定漂移：\n   - 维度：$d=2$。\n   - 噪声分量数量：$m=1$。\n   - 漂移：$A = \\mathrm{diag}(-0.2,\\,-0.3)$。\n   - 扩散矩阵：$B_1 = \\mathrm{diag}(0.7,\\,0.7)$。\n   - 总时间：$T = 50.0$。\n   - 时间步长：$\\Delta t = 10^{-3}$。\n   - 再正交化周期（步数）：$p = 10$。\n   - 随机种子：$2023$。\n\n4. 三维中的非对易漂移和噪声：\n   - 维度：$d=3$。\n   - 噪声分量数量：$m=2$。\n   - 漂移：\n     $$\n     A \\;=\\; \\begin{bmatrix}\n     0.0  1.0  0.0 \\\\\n     -2.0  -0.1  0.0 \\\\\n     0.0  0.0  -0.2\n     \\end{bmatrix}.\n     $$\n   - 扩散矩阵：\n     $$\n     B_1 \\;=\\; \\begin{bmatrix}\n     0.3  0.0  0.0 \\\\\n     0.0  0.3  0.0 \\\\\n     0.0  0.0  0.0\n     \\end{bmatrix}, \\quad\n     B_2 \\;=\\; \\begin{bmatrix}\n     0.0  0.5  0.0 \\\\\n     -0.5  0.0  0.0 \\\\\n     0.0  0.0  0.0\n     \\end{bmatrix}.\n     $$\n   - 总时间：$T = 50.0$。\n   - 时间步长：$\\Delta t = 10^{-3}$。\n   - 再正交化周期（步数）：$p = 5$。\n   - 随机种子：$7$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[r_1,r_2,r_3,r_4]$），其中$r_j$是测试用例$j$的估计顶李雅普诺夫指数。不应打印其他任何文本。由于不涉及物理单位，请以普通数值形式报告每个$r_j$的浮点数。", "solution": "问题陈述已经过分析并被确定为有效。它在科学上是合理的，问题提法是适定的，并且包含了实现用于估计线性随机微分方程（SDE）顶李雅普诺夫指数的指定数值算法所需的所有信息。\n\n### 方法原理\n\n该问题要求对线性随机系统的顶李雅普诺夫指数$\\lambda_1$进行数值估计。动力学系统的李雅普诺夫指数量化了状态空间中邻近轨迹发散或收敛的平均指数速率。对于线性系统$dY_t = F(Y_t) dt + G(Y_t) dW_t$，无穷小扰动向量$\\delta Y_t$的演化由线性化方程控制，在这种情况下，它就是原始的SDE本身，因为系统已经是线性的：\n$$\nd(\\delta Y_t) \\;=\\; A\\,(\\delta Y_t)\\,dt \\;+\\; \\sum_{i=1}^{m} B_i\\,(\\delta Y_t)\\,dW_t^{(i)}\n$$\n顶李雅普诺夫指数$\\lambda_1$对应于解向量范数$\\|\\delta Y_t\\|$的最大平均指数增长率。\n\n对单个向量直接进行此方程的数值模拟将导致其方向迅速与最大增长方向对齐，从而无法解析其他较小的指数。此外，其大小会要么爆炸要么消失，导致数值上溢或下溢。\n\n为克服此问题所采用的标准算法，也是问题中指定的算法，是基于追踪一个完整的$d$维切向量正交归一基的演化。该基被周期性地再正交化，以保持方向信息和数值稳定性。\n\n### 算法步骤\n\n1.  **离散化：** 使用欧拉-丸山（Euler-Maruyama）格式，将连续时间SDE近似为离散时间映射。在一个小的时间间隔$\\Delta t$内，$Y_t$的变化近似为：\n    $$\n    \\Delta Y_t \\;\\approx\\; A\\,Y_t\\,\\Delta t \\;+\\; \\sum_{i=1}^{m} B_i\\,Y_t\\,\\Delta W_t^{(i)}\n    $$\n    其中，连续布朗运动增量$dW_t^{(i)}$被离散随机变量$\\Delta W_k^{(i)} \\sim \\mathcal{N}(0, \\Delta t)$所替代。这给出了更新规则$Y_{k+1} = Y_k + \\Delta Y_k$，可以写成$Y_{k+1} = M_k Y_k$，其中$M_k$是随机更新矩阵：\n    $$\n    M_k \\;=\\; I_d \\;+\\; A\\,\\Delta t \\;+\\; \\sum_{i=1}^{m} B_i\\,\\Delta W_k^{(i)}\n    $$\n    这里，$I_d$是$d \\times d$单位矩阵。\n\n2.  **切向量演化与再正交化：** 我们不演化单个向量，而是演化一组$d$个正交归一向量，它们构成一个正交矩阵$Q_k \\in \\mathbb{R}^{d\\times d}$的列。我们从一个正交归一基开始，通常是$Q_0 = I_d$。\n    算法以$p$步为块进行。\n    - 在一个块的开始，我们有一个正交归一矩阵$Q_{\\text{start}}$。\n    - 我们计算接下来$p$个随机更新矩阵与$Q_{\\text{start}}$的乘积：\n      $$\n      V \\;=\\; (M_{k+p-1} \\cdots M_{k+1} M_k) \\, Q_{\\text{start}}\n      $$\n    - $V$的列代表演化后的（现在通常非正交归一的）基向量。为了提取它们的增长和新方向，我们执行QR分解：$V = QR$。\n    - 矩阵$Q \\in \\mathbb{R}^{d\\times d}$是正交的，其列构成了下一个块的新的正交归一基。\n    - 矩阵$R \\in \\mathbb{R}^{d\\times d}$是上三角矩阵。其对角元素$R_{ii}$表示框架中相应向量的膨胀或收缩因子。具体来说，$R_{11}$度量了第一个向量的增长，该向量在该块上与最大增长方向对齐。\n\n3.  **李雅普诺夫指数估计：** 顶李雅普诺夫指数是增长最快方向的对数增长的平均速率。在一个包含$p$步（时间长度为$p\\,\\Delta t$）的块中，第一个向量的对数增长为$\\log|R_{11}|$。为了找到总时间$T$内的平均速率，我们将所有再正交化步骤中的这些对数增长相加，然后除以$T$。\n    $$\n    \\lambda_1 \\;\\approx\\; \\frac{1}{T} \\sum_{j=1}^{N_{\\text{blocks}}} \\log|R_{11}^{(j)}|\n    $$\n    其中$R^{(j)}$是第$j$次QR分解得到的R矩阵。这个过程是稳健的，并且当$T \\to \\infty$时收敛到真实指数。实现将通过对剩余步骤累积的乘积执行最后一次QR分解来处理最后的、不完整的块。\n\n### 实现细节\n\n单个函数将为给定的参数集（$d, m, A, \\{B_i\\}, T, \\Delta t, p$和一个随机种子）实现所述算法。\n- 使用现代的随机数生成器（`numpy.random.default_rng`）以保证可复现性。\n- 总步数计算为$N = \\text{round}(T/\\Delta t)$。\n- 使用一个`while`循环遍历时间步，以最多$p$步为块进行处理。这种结构自然地处理了任何最后的、不完整的块。\n- 在每个块内，计算乘积$V = M_{k+\\text{steps\\_in\\_block}-1}\\cdots M_k Q_{start}$。\n- 使用`numpy.linalg.qr`执行QR分解。\n- 累积$\\log|R_{11}|$的总和。\n- 通过将此总和除以总时间$T$来计算$\\lambda_1$的最终估计值。\n- 对问题陈述中提供的每个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_top_lyapunov_exponent(d, m, A, B_list, T, dt, p, seed):\n    \"\"\"\n    Estimates the top Lyapunov exponent for a linear SDE using QR reorthonormalization.\n\n    Args:\n        d (int): Dimension of the system.\n        m (int): Number of noise components.\n        A (np.ndarray): Drift matrix (d x d).\n        B_list (list of np.ndarray): List of diffusion matrices (each d x d).\n        T (float): Total simulation time.\n        dt (float): Time step for discretization.\n        p (int): Number of steps between reorthonormalizations.\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        float: The estimated top Lyapunov exponent.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    \n    n_steps = int(round(T / dt))\n    \n    # Initialize the orthonormal basis Q and the sum of log-growths.\n    Q = np.identity(d)\n    log_growth_sum = 0.0\n\n    step_idx = 0\n    while step_idx  n_steps:\n        # Determine the number of steps for the current block.\n        # This handles the final partial block automatically.\n        steps_in_block = min(p, n_steps - step_idx)\n        \n        # Start the accumulation with the current orthonormal basis.\n        V = np.copy(Q)\n        \n        # Evolve over the steps in the block.\n        for _ in range(steps_in_block):\n            # Generate Brownian increments for this time step.\n            # dW ~ N(0, dt), so standard normal scaled by sqrt(dt).\n            dW = rng.normal(0.0, np.sqrt(dt), size=m)\n\n            # Construct the Euler-Maruyama update matrix M_k.\n            M = np.identity(d) + A * dt\n            if m > 0:\n                noise_term = sum(B * dW_i for B, dW_i in zip(B_list, dW))\n                M += noise_term\n            \n            # Apply the update matrix.\n            V = M @ V\n        \n        # Perform QR decomposition on the evolved matrix V.\n        # V = Q_new * R\n        Q, R = np.linalg.qr(V)\n        \n        # Accumulate the log of the growth factor for the first vector.\n        # The problem asks for log|R_11|.\n        log_growth_sum += np.log(np.abs(R[0, 0]))\n\n        # Increment step_idx by the number of steps processed.\n        step_idx += steps_in_block\n\n    # The Lyapunov exponent is the time-average of the log-growth.\n    lambda_1_estimate = log_growth_sum / T\n    \n    return lambda_1_estimate\n\ndef solve():\n    \"\"\"\n    Runs the test suite and prints the results in the required format.\n    \"\"\"\n    test_cases = [\n        # 1. Analytic baseline in one dimension\n        {\n            \"d\": 1, \"m\": 1,\n            \"A\": np.array([[0.3]]),\n            \"B_list\": [np.array([[0.8]])],\n            \"T\": 50.0, \"dt\": 1e-3, \"p\": 10, \"seed\": 42\n        },\n        # 2. Deterministic baseline in two dimensions\n        {\n            \"d\": 2, \"m\": 0,\n            \"A\": np.diag([0.1, -0.5]),\n            \"B_list\": [],\n            \"T\": 50.0, \"dt\": 1e-3, \"p\": 10, \"seed\": 123\n        },\n        # 3. Stable drift with isotropic multiplicative noise in two dimensions\n        {\n            \"d\": 2, \"m\": 1,\n            \"A\": np.diag([-0.2, -0.3]),\n            \"B_list\": [np.diag([0.7, 0.7])],\n            \"T\": 50.0, \"dt\": 1e-3, \"p\": 10, \"seed\": 2023\n        },\n        # 4. Non-commuting drift and noise in three dimensions\n        {\n            \"d\": 3, \"m\": 2,\n            \"A\": np.array([\n                [0.0, 1.0, 0.0],\n                [-2.0, -0.1, 0.0],\n                [0.0, 0.0, -0.2]\n            ]),\n            \"B_list\": [\n                np.array([\n                    [0.3, 0.0, 0.0],\n                    [0.0, 0.3, 0.0],\n                    [0.0, 0.0, 0.0]\n                ]),\n                np.array([\n                    [0.0, 0.5, 0.0],\n                    [-0.5, 0.0, 0.0],\n                    [0.0, 0.0, 0.0]\n                ])\n            ],\n            \"T\": 50.0, \"dt\": 1e-3, \"p\": 5, \"seed\": 7\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = calculate_top_lyapunov_exponent(**case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3064480"}]}