{"hands_on_practices": [{"introduction": "在深入研究 Black-Scholes-Merton (BSM) 偏微分方程之前，我们必须首先掌握其基础：标的资产价格的随机微分方程 (SDE) 模型。本练习将引导你应用随机微积分中的核心工具——伊藤引理 (Itô's Lemma)，来推导几何布朗运动的显式解 [@problem_id:3079825]。这不仅是理解 BSM 模型背后资产动态的关键一步，也是一项基本的定量金融技能。", "problem": "考虑一个不支付股息的股票价格过程，在布莱克-斯科尔斯-默顿 (BSM) 框架下，其模型由随机微分方程 (SDE) $dS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t$ (其中 $t\\geq 0$) 描述。这里，$S_00$，$\\mu\\in\\mathbb{R}$ 和 $\\sigma0$ 是常数，而 $(W_t)_{t\\geq 0}$ 是在一个满足通常条件的带域概率空间上的标准布朗运动。此股票动态是推导衍生品价格的布莱克-斯科尔斯-默顿偏微分方程 (PDE) 的基础。仅使用伊藤过程和伊藤引理的定义与性质，并假设 $S_t0$ 以确保对数有定义，通过使用变换 $Y_t=\\ln S_t$ 推导出该 SDE 的显式解。具体步骤包括：确定 $Y_t$ 的漂移项和扩散项，对时间进行积分，然后进行逆变换以获得 $S_t$ 的闭式解。请提供 $S_t$ 作为 $S_0$、$t$、$W_t$、$\\mu$ 和 $\\sigma$ 的函数的最终表达式。你的最终答案必须是一个不含期望或极限的单一闭式解析表达式。", "solution": "我们从布莱克-斯科尔斯-默顿 (BSM) 模型中给定的股票价格过程的随机微分方程 (SDE) 开始：\n$$\ndS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t,\\quad S_00,\n$$\n其中 $(W_t)_{t\\geq 0}$ 是一个标准布朗运动，$\\mu\\in\\mathbb{R}$ 和 $\\sigma0$ 是常数。我们需要通过考虑对数变换 $Y_t=\\ln S_t$ 并使用伊藤引理来推导显式解。关键的基础工具是伊藤引理。对于一个满足 $dX_t=a_t\\,dt+b_t\\,dW_t$ 的伊藤过程 $X_t$ 和一个二阶连续可微函数 $f:\\mathbb{R}_{+}\\to\\mathbb{R}$，伊藤引理表述为：\n$$\ndf(X_t)=f^{\\prime}(X_t)\\,dX_t+\\frac{1}{2}f^{\\prime\\prime}(X_t)\\,b_t^{2}\\,dt.\n$$\n\n在这里，我们取 $X_t=S_t$ 和 $f(x)=\\ln x$。我们计算其导数：\n$$\nf^{\\prime}(x)=\\frac{1}{x},\\qquad f^{\\prime\\prime}(x)=-\\frac{1}{x^{2}}.\n$$\n由于 $dS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t$，我们有 $a_t=\\mu S_t$ 和 $b_t=\\sigma S_t$。将伊藤引理应用于 $Y_t=\\ln S_t$ 得到\n$$\ndY_t=f^{\\prime}(S_t)\\,dS_t+\\frac{1}{2}f^{\\prime\\prime}(S_t)\\,b_t^{2}\\,dt\n=\\frac{1}{S_t}\\left(\\mu S_t\\,dt+\\sigma S_t\\,dW_t\\right)+\\frac{1}{2}\\left(-\\frac{1}{S_t^{2}}\\right)\\left(\\sigma^{2}S_t^{2}\\right)dt.\n$$\n化简该表达式可得\n$$\ndY_t=\\mu\\,dt+\\sigma\\,dW_t-\\frac{1}{2}\\sigma^{2}\\,dt=(\\mu-\\tfrac{1}{2}\\sigma^{2})\\,dt+\\sigma\\,dW_t.\n$$\n\n现在我们对两边从 $0$ 到 $t$ 进行积分。利用 $Y_0=\\ln S_0$ 以及 $W_0=0$ 这一事实，我们得到\n$$\nY_t-Y_0=\\int_{0}^{t}\\left(\\mu-\\tfrac{1}{2}\\sigma^{2}\\right)\\,ds+\\int_{0}^{t}\\sigma\\,dW_s.\n$$\n第一个积分是确定性的，等于 $(\\mu-\\tfrac{1}{2}\\sigma^{2})t$。第二个积分是关于布朗运动的随机积分，等于 $\\sigma W_t$，因为 $\\int_{0}^{t}dW_s=W_t-W_0=W_t$。因此，\n$$\n\\ln S_t-\\ln S_0=(\\mu-\\tfrac{1}{2}\\sigma^{2})t+\\sigma W_t.\n$$\n对两边取指数，得到显式解：\n$$\nS_t=S_0\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})t+\\sigma W_t\\right).\n$$\n\n这个闭式表达式表明，在给定 $S_00$ 的情况下，$S_t$ 恒为正，并且 $\\ln S_t$ 服从正态分布，其均值为 $\\ln S_0+(\\mu-\\tfrac{1}{2}\\sigma^{2})t$，方差为 $\\sigma^{2}t$。在布莱克-斯科尔斯-默顿框架下，如果在风险中性测度下将 $\\mu$ 替换为无风险利率 $r$，那么这个显式解通过确保与无套利定价一致的对数正态动态，为布莱克-斯科尔斯-默顿偏微分方程 (PDE) 的推导提供了基础。所要求的 $S_t$ 的最终表达式如上所述。", "answer": "$$\\boxed{S_0\\,\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})\\,t+\\sigma\\,W_t\\right)}$$", "id": "3079825"}, {"introduction": "BSM 偏微分方程拥有一个著名的封闭解，即 Black-Scholes 期权定价公式。这个练习的目标是通过直接计算来验证该公式确实是 PDE 的一个解 [@problem_id:3079802]。你需要计算期权价格关于资产价格和时间的偏导数（即金融中常说的 “Greeks”），并将它们代入 PDE，从而加深对 PDE 与其解之间内在联系的理解。", "problem": "考虑一个基础资产价格过程 $\\{S_t\\}_{t \\ge 0}$，其在风险中性测度下由随机微分方程 (SDE) $dS_t = (r - q) S_t \\, dt + \\sigma S_t \\, dW_t$ 建模，其中 $r  0$ 是恒定的无风险利率，$q \\ge 0$ 是恒定的连续股息率，$\\sigma  0$ 是恒定的波动率，$\\{W_t\\}_{t \\ge 0}$ 是标准布朗运动。设 $K  0$ 为行权价，$T  0$ 为到期日。定义剩余到期时间 $\\tau = T - t$ 和标准的 Black–Scholes–Merton (BSM) 看涨期权价格\n$$\nC(S,t) = S \\exp(-q \\tau) \\, \\Phi(d_1) - K \\exp(-r \\tau) \\, \\Phi(d_2),\n$$\n其中\n$$\nd_1 = \\frac{\\ln\\!\\left(\\frac{S}{K}\\right) + \\left(r - q + \\frac{1}{2} \\sigma^2\\right) \\tau}{\\sigma \\sqrt{\\tau}}, \n\\qquad\nd_2 = d_1 - \\sigma \\sqrt{\\tau},\n$$\n并且其中 $\\Phi(x)$ 是标准正态分布的累积分布函数，$\\varphi(x) = \\frac{1}{\\sqrt{2 \\pi}} \\exp\\!\\left(-\\frac{x^2}{2}\\right)$ 是其概率密度函数。应用于价格函数 $C(S,t)$ 的 Black–Scholes–Merton 偏微分方程 (BSM PDE) 算子为\n$$\n\\mathcal{L}[C] := C_t + \\frac{1}{2} \\sigma^2 S^2 C_{SS} + (r - q) S C_S - r C,\n$$\n其中下标表示偏导数。\n\n从上述定义出发，仅使用标准微积分（乘积法则、链式法则）以及 $\\Phi$ 和 $\\varphi$ 的性质，计算并简化将给定的 $C(S,t)$ 代入 BSM PDE 算子得到的残差\n$$\nR(S,t) := \\mathcal{L}[C]\n$$\n将您的最终答案表示为单个闭式解析表达式。不需要数值近似。", "solution": "目标是通过将 Black-Scholes-Merton (BSM) 看涨期权价格公式 $C(S,t)$ 代入 BSM 偏微分方程 (PDE) 算子来计算残差 $R(S,t) = \\mathcal{L}[C]$：\n$$\n\\mathcal{L}[C] = C_t + \\frac{1}{2} \\sigma^2 S^2 C_{SS} + (r - q) S C_S - r C\n$$\n其中下标表示偏导数。计算需要求出偏导数 $C_S$、$C_{SS}$ 和 $C_t$。令 $\\tau = T-t$，因此 $\\frac{\\partial \\tau}{\\partial t} = -1$。\n\n首先，我们计算 $d_1$ 和 $d_2$ 关于 $S$ 和 $t$ 的偏导数。\n$$\nd_1 = \\frac{\\ln(S) - \\ln(K) + (r - q + \\frac{1}{2} \\sigma^2) \\tau}{\\sigma \\sqrt{\\tau}}\n$$\n$$\nd_2 = d_1 - \\sigma \\sqrt{\\tau} = \\frac{\\ln(S) - \\ln(K) + (r - q - \\frac{1}{2} \\sigma^2) \\tau}{\\sigma \\sqrt{\\tau}}\n$$\n关于 $S$ 的导数是：\n$$\n\\frac{\\partial d_1}{\\partial S} = \\frac{1}{S \\sigma \\sqrt{\\tau}}, \\qquad \\frac{\\partial d_2}{\\partial S} = \\frac{1}{S \\sigma \\sqrt{\\tau}}\n$$\n关于 $t$ 的导数使用链式法则求得：$\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = - \\frac{\\partial}{\\partial \\tau}$。\n$$\n\\frac{\\partial d_1}{\\partial \\tau} = \\frac{\\partial}{\\partial \\tau} \\left( \\frac{\\ln(S/K)}{\\sigma} \\tau^{-1/2} + \\frac{r-q+\\frac{1}{2}\\sigma^2}{\\sigma} \\tau^{1/2} \\right) = \\frac{\\ln(S/K)}{\\sigma} \\left(-\\frac{1}{2}\\tau^{-3/2}\\right) + \\frac{r-q+\\frac{1}{2}\\sigma^2}{\\sigma} \\left(\\frac{1}{2}\\tau^{-1/2}\\right)\n$$\n$$\n\\frac{\\partial d_1}{\\partial t} = - \\frac{\\partial d_1}{\\partial \\tau} = \\frac{\\ln(S/K)}{2\\sigma\\tau^{3/2}} - \\frac{r-q+\\frac{1}{2}\\sigma^2}{2\\sigma\\sqrt{\\tau}}\n$$\n对于 $d_2$：\n$$\n\\frac{\\partial d_2}{\\partial t} = \\frac{\\partial d_1}{\\partial t} - \\sigma \\frac{\\partial \\sqrt{\\tau}}{\\partial t} = \\frac{\\partial d_1}{\\partial t} - \\sigma \\left(\\frac{1}{2\\sqrt{\\tau}}\\right)(-1) = \\frac{\\partial d_1}{\\partial t} + \\frac{\\sigma}{2\\sqrt{\\tau}}\n$$\n这意味着一个关键关系：\n$$\n\\frac{\\partial d_1}{\\partial t} - \\frac{\\partial d_2}{\\partial t} = -\\frac{\\sigma}{2\\sqrt{\\tau}}\n$$\n接下来，我们建立一个联系 $\\varphi(d_1)$ 和 $\\varphi(d_2)$ 的关键恒等式。\n$$\nd_2 = d_1 - \\sigma\\sqrt{\\tau} \\implies d_2^2 = d_1^2 - 2d_1\\sigma\\sqrt{\\tau} + \\sigma^2\\tau\n$$\n代入 $d_1\\sigma\\sqrt{\\tau}$：\n$$\nd_1\\sigma\\sqrt{\\tau} = \\ln(S/K) + (r-q)\\tau + \\frac{1}{2}\\sigma^2\\tau\n$$\n于是，\n$$\n-\\frac{d_2^2}{2} = -\\frac{d_1^2}{2} + d_1\\sigma\\sqrt{\\tau} - \\frac{1}{2}\\sigma^2\\tau = -\\frac{d_1^2}{2} + \\ln(S/K) + (r-q)\\tau\n$$\n对此取指数，得到概率密度函数之间的关系：\n$$\n\\varphi(d_2) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{d_2^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{d_1^2}{2}\\right) \\exp(\\ln(S/K) + (r-q)\\tau) = \\varphi(d_1) \\frac{S}{K} \\exp((r-q)\\tau)\n$$\n整理后得到恒等式：\n$$\nK \\exp(-r\\tau) \\varphi(d_2) = K \\exp(-r\\tau) \\left( \\varphi(d_1) \\frac{S}{K} \\exp(r\\tau-q\\tau) \\right) = S \\exp(-q\\tau) \\varphi(d_1)\n$$\n这个恒等式在接下来的推导中至关重要。\n\n让我们计算 $C(S,t)$ 的偏导数。\n\n1.  **Delta ($C_S$)：**\n    $$\n    C_S = \\frac{\\partial}{\\partial S} \\left( S \\exp(-q \\tau) \\Phi(d_1) - K \\exp(-r \\tau) \\Phi(d_2) \\right)\n    $$\n    使用乘积法则和链式法则，其中 $\\frac{\\partial \\Phi(x)}{\\partial S} = \\varphi(x) \\frac{\\partial x}{\\partial S}$：\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1) + S \\exp(-q \\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial S} - K \\exp(-r \\tau) \\varphi(d_2) \\frac{\\partial d_2}{\\partial S}\n    $$\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1) + S \\exp(-q \\tau) \\varphi(d_1) \\frac{1}{S \\sigma \\sqrt{\\tau}} - K \\exp(-r \\tau) \\varphi(d_2) \\frac{1}{S \\sigma \\sqrt{\\tau}}\n    $$\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1) + \\frac{1}{S \\sigma \\sqrt{\\tau}} \\left( S \\exp(-q \\tau) \\varphi(d_1) - K \\exp(-r \\tau) \\varphi(d_2) \\right)\n    $$\n    由于我们推导出的恒等式，括号中的项为零。因此，期权的 Delta 是：\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1)\n    $$\n\n2.  **Gamma ($C_{SS}$)：**\n    我们对 $C_S$ 关于 $S$ 求导：\n    $$\n    C_{SS} = \\frac{\\partial C_S}{\\partial S} = \\frac{\\partial}{\\partial S} \\left( \\exp(-q \\tau) \\Phi(d_1) \\right) = \\exp(-q \\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial S}\n    $$\n    $$\n    C_{SS} = \\exp(-q \\tau) \\varphi(d_1) \\frac{1}{S \\sigma \\sqrt{\\tau}} = \\frac{\\exp(-q \\tau) \\varphi(d_1)}{S \\sigma \\sqrt{\\tau}}\n    $$\n    \n3.  **Theta ($C_t$)：**\n    我们对 $C(S,t)$ 关于 $t$ 求导：\n    $$\n    C_t = \\frac{\\partial}{\\partial t} \\left( S \\exp(-q \\tau) \\Phi(d_1) - K \\exp(-r \\tau) \\Phi(d_2) \\right)\n    $$\n    让我们逐项求导。对于第一项：\n    $$\n    \\frac{\\partial}{\\partial t} (S \\exp(-q\\tau) \\Phi(d_1)) = S \\left( \\exp(-q\\tau)(-q)(-1)\\Phi(d_1) + \\exp(-q\\tau)\\varphi(d_1)\\frac{\\partial d_1}{\\partial t} \\right)\n    $$\n    $$\n    = q S \\exp(-q\\tau) \\Phi(d_1) + S \\exp(-q\\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial t}\n    $$\n    对于第二项：\n    $$\n    \\frac{\\partial}{\\partial t} (K \\exp(-r\\tau) \\Phi(d_2)) = K \\left( \\exp(-r\\tau)(-r)(-1)\\Phi(d_2) + \\exp(-r\\tau)\\varphi(d_2)\\frac{\\partial d_2}{\\partial t} \\right)\n    $$\n    $$\n    = r K \\exp(-r\\tau) \\Phi(d_2) + K \\exp(-r\\tau) \\varphi(d_2) \\frac{\\partial d_2}{\\partial t}\n    $$\n    将它们组合起来得到 $C_t$：\n    $$\n    C_t = q S \\exp(-q\\tau) \\Phi(d_1) - r K \\exp(-r\\tau) \\Phi(d_2) + S \\exp(-q\\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial t} - K \\exp(-r\\tau) \\varphi(d_2) \\frac{\\partial d_2}{\\partial t}\n    $$\n    使用恒等式 $S \\exp(-q\\tau) \\varphi(d_1) = K \\exp(-r\\tau) \\varphi(d_2)$，我们可以对最后两项进行因式分解：\n    $$\n    C_t = q S \\exp(-q\\tau) \\Phi(d_1) - r K \\exp(-r\\tau) \\Phi(d_2) + S \\exp(-q\\tau) \\varphi(d_1) \\left( \\frac{\\partial d_1}{\\partial t} - \\frac{\\partial d_2}{\\partial t} \\right)\n    $$\n    代入 $\\frac{\\partial d_1}{\\partial t} - \\frac{\\partial d_2}{\\partial t} = -\\frac{\\sigma}{2\\sqrt{\\tau}}$：\n    $$\n    C_t = q S \\exp(-q\\tau) \\Phi(d_1) - r K \\exp(-r\\tau) \\Phi(d_2) - \\frac{S \\sigma \\exp(-q\\tau) \\varphi(d_1)}{2\\sqrt{\\tau}}\n    $$\n\n最后，我们将这些导数代入 BSM PDE 算子 $\\mathcal{L}[C]$。\n$$\n\\mathcal{L}[C] = C_t + \\frac{1}{2} \\sigma^2 S^2 C_{SS} + (r - q) S C_S - r C\n$$\n让我们组合这些项：\n- $C_t = q S e^{-q\\tau} \\Phi(d_1) - r K e^{-r\\tau} \\Phi(d_2) - \\frac{S \\sigma e^{-q\\tau} \\varphi(d_1)}{2\\sqrt{\\tau}}$\n- $\\frac{1}{2} \\sigma^2 S^2 C_{SS} = \\frac{1}{2} \\sigma^2 S^2 \\left(\\frac{e^{-q \\tau} \\varphi(d_1)}{S \\sigma \\sqrt{\\tau}}\\right) = \\frac{S \\sigma e^{-q \\tau} \\varphi(d_1)}{2\\sqrt{\\tau}}$\n- $(r - q) S C_S = (r - q) S \\left(e^{-q\\tau} \\Phi(d_1)\\right) = r S e^{-q\\tau} \\Phi(d_1) - q S e^{-q\\tau} \\Phi(d_1)$\n- $-r C = -r \\left(S e^{-q\\tau} \\Phi(d_1) - K e^{-r\\tau} \\Phi(d_2)\\right) = -r S e^{-q\\tau} \\Phi(d_1) + r K e^{-r\\tau} \\Phi(d_2)$\n\n将所有分量相加：\n$$\n\\mathcal{L}[C] = \\left( q S e^{-q\\tau} \\Phi(d_1) - r K e^{-r\\tau} \\Phi(d_2) - \\frac{S \\sigma e^{-q\\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} \\right)\n+ \\left( \\frac{S \\sigma e^{-q \\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} \\right)\n$$\n$$\n+ \\left( r S e^{-q\\tau} \\Phi(d_1) - q S e^{-q\\tau} \\Phi(d_1) \\right)\n+ \\left( -r S e^{-q\\tau} \\Phi(d_1) + r K e^{-r\\tau} \\Phi(d_2) \\right)\n$$\n我们按其函数分量对各项进行分组：\n- 涉及 $\\varphi(d_1)$ 的项：\n  $$\n  -\\frac{S \\sigma e^{-q\\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} + \\frac{S \\sigma e^{-q \\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} = 0\n  $$\n- 涉及 $\\Phi(d_1)$ 的项：\n  $$\n  (q S e^{-q\\tau}) \\Phi(d_1) + (r S e^{-q\\tau}) \\Phi(d_1) - (q S e^{-q\\tau}) \\Phi(d_1) - (r S e^{-q\\tau}) \\Phi(d_1) = (q+r-q-r) S e^{-q\\tau} \\Phi(d_1) = 0\n  $$\n- 涉及 $\\Phi(d_2)$ 的项：\n  $$\n  (-r K e^{-r\\tau}) \\Phi(d_2) + (r K e^{-r\\tau}) \\Phi(d_2) = 0\n  $$\n所有项都抵消了。\n因此，残差为零。\n$$\nR(S,t) = \\mathcal{L}[C] = 0 + 0 + 0 = 0\n$$\n这证明了欧式看涨期权价格的 BSM 公式确实是 BSM 偏微分方程的一个解。", "answer": "$$\n\\boxed{0}\n$$", "id": "3079802"}, {"introduction": "虽然标准欧式期权有精确的解析解，但许多奇异期权的定价并无此便利，必须依赖数值方法。本练习模拟了这一过程，首先将 BSM 方程转换为更简洁的热传导方程，然后对一个常用的显式有限差分格式进行稳定性分析 [@problem_id:3079816]。通过这个实践，你将学会如何推导保证数值解可靠性的稳定性条件（CFL 条件），这是计算金融领域的一项重要技能。", "problem": "考虑一支不支付股息的股票，其价格过程 $\\{S_{t}\\}_{t \\ge 0}$ 服从风险中性几何布朗运动\n$$\n\\mathrm{d}S_{t} \\;=\\; r\\,S_{t}\\,\\mathrm{d}t \\;+\\; \\sigma\\,S_{t}\\,\\mathrm{d}W_{t},\n$$\n其中 $r0$ 是恒定的无风险利率，$\\sigma0$ 是恒定的波动率，$\\{W_{t}\\ge 0\\}$ 是一个标准布朗运动。令 $V(S,t)$ 表示一个到期日为 $T$ 的欧式或有债权的无套利价格。从上述随机微分方程和自融资复制论证出发，按以下步骤进行：\n\n1. 在风险中性测度下，推导 $V(S,t)$ 的主导偏微分方程。引入对数价格变量 $x=\\ln S$ 和距离到期日的时间变量 $\\tau=T-t$，并定义 $U(x,\\tau)=V(S,t)$，其中 $S=\\exp(x)$。推导 $U(x,\\tau)$ 的变换后方程。\n\n2. 通过贴现消除零阶项，定义 $u(x,\\tau)=\\exp(r\\tau)\\,U(x,\\tau)$，然后通过形式为 $w(x,\\tau)=u(x+c\\,\\tau,\\tau)$ 的变量替换（对于一个合适的常数 $c\\in\\mathbb{R}$）来消除一阶空间导数。确定 $c$，使得 $w(x,\\tau)$ 满足形式为\n$$\nw_{\\tau} \\;=\\; a\\,w_{xx},\n$$\n的常系数热传导方程，并用 $\\sigma$ 表示 $a$。\n\n3. 在均匀网格 $x_{j}=x_{0}+j\\,\\Delta x$ 和 $\\tau_{n}=n\\,\\Delta t$ 上，使用前向时间、中心空间显式格式对此热传导方程进行离散化：\n$$\nw_{j}^{n+1} \\;=\\; w_{j}^{n} \\;+\\; \\mu\\left(w_{j+1}^{n} - 2\\,w_{j}^{n} + w_{j-1}^{n}\\right),\n\\qquad \\text{with} \\quad \\mu \\equiv \\frac{a\\,\\Delta t}{(\\Delta x)^{2}}.\n$$\n\n4. 使用 von Neumann 傅里叶模态分析，推导关于 $\\mu$ 的稳定性条件，从而对此变换后的显式格式，得到一个关于时间步长 $\\Delta t$ 相对于空间步长 $\\Delta x$ 的 Courant–Friedrichs–Lewy (CFL) 型限制条件。\n\n你的最终任务：将稳定性限制条件写成\n$$\n\\Delta t \\;\\le\\; C\\,(\\Delta x)^{2}.\n$$\n的形式，求出最大常数 $C$ 的闭式表达式（仅作为 $\\sigma$ 的函数）。\n只需报告此常数 $C$ 作为你的最终答案。无需数值近似或四舍五入。", "solution": "题目要求推导应用于变换后的 Black-Scholes-Merton (BSM) 偏微分方程 (PDE) 的有限差分格式的稳定性条件，并从该条件中确定一个特定的常数 $C$。我们按照问题陈述中列出的步骤进行。\n\n**步骤 1：BSM PDE 的推导及其变换**\n\n我们从股价 $S_t$ 的风险中性随机微分方程 (SDE) 开始：\n$$ \\mathrm{d}S_{t} = r S_{t} \\mathrm{d}t + \\sigma S_{t} \\mathrm{d}W_{t} $$\n令 $V(S,t)$ 为欧式或有债权的无套利价格。根据风险中性测度下的套利理论，贴现后的价格过程 $\\exp(-rt)V(S_t, t)$ 必须是一个鞅。为求得 $V$ 必须满足的 PDE，我们对 $V(S,t)$ 应用 Itô 引理：\n$$ \\mathrm{d}V = \\frac{\\partial V}{\\partial t}\\mathrm{d}t + \\frac{\\partial V}{\\partial S}\\mathrm{d}S + \\frac{1}{2}\\frac{\\partial^2 V}{\\partial S^2}(\\mathrm{d}S)^2 $$\n二次变分项是 $(\\mathrm{d}S)^2 = (\\sigma S \\mathrm{d}W_t)^2 = \\sigma^2 S^2 \\mathrm{d}t$。代入 $\\mathrm{d}S$ 的 SDE 给出：\n$$ \\mathrm{d}V = \\left( \\frac{\\partial V}{\\partial t} + rS\\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S^2 \\frac{\\partial^2 V}{\\partial S^2} \\right)\\mathrm{d}t + \\sigma S \\frac{\\partial V}{\\partial S} \\mathrm{d}W_t $$\n为使贴现过程 $\\exp(-rt)V(S_t,t)$ 成为鞅，其漂移项必须为零。$\\mathrm{d}(\\exp(-rt)V)$ 的漂移项是 $\\exp(-rt)(\\mathrm{d}V - rV\\mathrm{d}t)$。令总漂移系数为零，得到 BSM PDE：\n$$ \\frac{\\partial V}{\\partial t} + rS\\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S^2 \\frac{\\partial^2 V}{\\partial S^2} - rV = 0 $$\n接下来，我们进行变量替换 $x=\\ln S$ 和 $\\tau=T-t$，并定义 $U(x,\\tau) = V(S,t)$。我们用 $U$ 来计算 $V$ 的偏导数：\n- $\\frac{\\partial V}{\\partial t} = \\frac{\\partial U}{\\partial \\tau} \\frac{\\partial \\tau}{\\partial t} = -\\frac{\\partial U}{\\partial \\tau}$\n- $\\frac{\\partial V}{\\partial S} = \\frac{\\partial U}{\\partial x} \\frac{\\partial x}{\\partial S} = \\frac{1}{S} \\frac{\\partial U}{\\partial x}$\n- $\\frac{\\partial^2 V}{\\partial S^2} = \\frac{\\partial}{\\partial S}\\left( \\frac{1}{S} \\frac{\\partial U}{\\partial x} \\right) = -\\frac{1}{S^2}\\frac{\\partial U}{\\partial x} + \\frac{1}{S}\\frac{\\partial}{\\partial S}\\left(\\frac{\\partial U}{\\partial x}\\right) = -\\frac{1}{S^2}\\frac{\\partial U}{\\partial x} + \\frac{1}{S}\\left(\\frac{\\partial^2 U}{\\partial x^2}\\frac{\\partial x}{\\partial S}\\right) = \\frac{1}{S^2}\\left(\\frac{\\partial^2 U}{\\partial x^2} - \\frac{\\partial U}{\\partial x}\\right)$\n将这些代入 BSM PDE：\n$$ -\\frac{\\partial U}{\\partial \\tau} + rS\\left(\\frac{1}{S}\\frac{\\partial U}{\\partial x}\\right) + \\frac{1}{2}\\sigma^2 S^2 \\left(\\frac{1}{S^2}\\left(\\frac{\\partial^2 U}{\\partial x^2} - \\frac{\\partial U}{\\partial x}\\right)\\right) - rU = 0 $$\n简化并整理各项，得到 $U(x, \\tau)$ 的 PDE：\n$$ \\frac{\\partial U}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 U}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial U}{\\partial x} - rU $$\n\n**步骤 2：化为常系数热传导方程**\n\n首先，我们通过贴现变换 $u(x, \\tau) = \\exp(r\\tau)U(x, \\tau)$ 来消除零阶项 $-rU$，这意味着 $U(x, \\tau) = \\exp(-r\\tau)u(x, \\tau)$。$U$ 的偏导数为：\n- $\\frac{\\partial U}{\\partial \\tau} = -r\\exp(-r\\tau)u + \\exp(-r\\tau)\\frac{\\partial u}{\\partial \\tau}$\n- $\\frac{\\partial U}{\\partial x} = \\exp(-r\\tau)\\frac{\\partial u}{\\partial x}$\n- $\\frac{\\partial^2 U}{\\partial x^2} = \\exp(-r\\tau)\\frac{\\partial^2 u}{\\partial x^2}$\n将这些代入 $U$ 的 PDE，并给整个方程乘以 $\\exp(r\\tau)$：\n$$ -ru + \\frac{\\partial u}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial u}{\\partial x} - ru $$\n$-ru$ 项抵消，留下一个没有零阶项的 PDE：\n$$ \\frac{\\partial u}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial u}{\\partial x} $$\n接下来，我们使用变换 $w(x,\\tau) = u(x+c\\tau, \\tau)$ 来消除一阶空间导数。使用链式法则，我们求出 $w$ 的导数（在 $(x+c\\tau, \\tau)$ 处求值）如何用 $u$ 的导数表示：\n- $\\frac{\\partial w}{\\partial \\tau} = c \\frac{\\partial u}{\\partial x} + \\frac{\\partial u}{\\partial \\tau}$\n- $\\frac{\\partial w}{\\partial x} = \\frac{\\partial u}{\\partial x}$\n- $\\frac{\\partial^2 w}{\\partial x^2} = \\frac{\\partial^2 u}{\\partial x^2}$\n我们从第一个关系式中表示出 $\\frac{\\partial u}{\\partial \\tau}$，并将其代入 $u$ 的 PDE：\n$$ \\frac{\\partial w}{\\partial \\tau} - c \\frac{\\partial u}{\\partial x} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial u}{\\partial x} $$\n用 $w$ 的导数替换 $u$ 的导数：\n$$ \\frac{\\partial w}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 w}{\\partial x^2} + \\left(c + r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial w}{\\partial x} $$\n为消除一阶项，我们将其系数设为零：\n$$ c + r - \\frac{1}{2}\\sigma^2 = 0 \\implies c = \\frac{1}{2}\\sigma^2 - r $$\n对于常数 $c$ 的这个选择，$w(x,\\tau)$ 的 PDE 简化为热传导方程：\n$$ \\frac{\\partial w}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 w}{\\partial x^2} $$\n将其与所期望的形式 $w_{\\tau} = a w_{xx}$ 相比较，我们确定常数 $a$ 为：\n$$ a = \\frac{1}{2}\\sigma^2 $$\n\n**步骤 3 和 4：离散化与稳定性分析**\n\n问题给出了热传导方程 $w_{\\tau} = a w_{xx}$ 的前向时间、中心空间 (FTCS) 显式格式：\n$$ w_{j}^{n+1} = w_{j}^{n} + \\mu\\left(w_{j+1}^{n} - 2w_{j}^{n} + w_{j-1}^{n}\\right), \\quad \\text{with} \\quad \\mu \\equiv \\frac{a \\Delta t}{(\\Delta x)^{2}} $$\n为分析该格式的稳定性，我们使用 von Neumann 方法。我们考虑在时间步 $n$ 的解的一个傅里叶模态：\n$$ w_j^n = G(k)^n e^{i k x_j} $$\n其中 $G(k)$ 是单个时间步长 $\\Delta t$ 的放大因子，$k$ 是波数。将此代入差分方程：\n$$ G^{n+1} e^{i k x_j} = G^n e^{i k x_j} + \\mu \\left( G^n e^{i k x_{j+1}} - 2G^n e^{i k x_j} + G^n e^{i k x_{j-1}} \\right) $$\n两边除以 $G^n e^{i k x_j}$ 并注意到 $x_{j\\pm 1} = x_j \\pm \\Delta x$：\n$$ G = 1 + \\mu \\left( e^{i k \\Delta x} - 2 + e^{-i k \\Delta x} \\right) $$\n使用欧拉恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$，我们得到：\n$$ G = 1 + \\mu (2\\cos(k\\Delta x) - 2) = 1 - 2\\mu(1-\\cos(k\\Delta x)) $$\n使用半角公式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$ G = 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\n为保证数值稳定性，对于所有波数 $k$，放大因子的模必须不大于 1：$|G| \\le 1$，这等价于 $-1 \\le G \\le 1$。\n条件 $G \\le 1$ 意味着 $1 - 4\\mu \\sin^2(\\frac{k\\Delta x}{2}) \\le 1$，简化为 $-4\\mu \\sin^2(\\frac{k\\Delta x}{2}) \\le 0$。由于 $\\mu = \\frac{a \\Delta t}{(\\Delta x)^2}$ 是非负的（$a0$, $\\Delta t0$），此条件总是满足。\n关键条件是 $G \\ge -1$：\n$$ 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\ge -1 $$\n$$ 2 \\ge 4\\mu \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\n这个不等式必须对所有 $k$ 都成立。最严格的情况发生在 $\\sin^2(\\frac{k\\Delta x}{2})$ 达到其最大值 1 时：\n$$ 2 \\ge 4\\mu \\implies \\mu \\le \\frac{1}{2} $$\n这是 FTCS 格式的稳定性条件。现在，我们代入 $\\mu$ 和 $a$ 的表达式：\n$$ \\mu = \\frac{a \\Delta t}{(\\Delta x)^2} = \\frac{(\\frac{1}{2}\\sigma^2) \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2} $$\n求解时间步长 $\\Delta t$：\n$$ \\frac{\\sigma^2 \\Delta t}{(\\Delta x)^2} \\le 1 $$\n$$ \\Delta t \\le \\frac{1}{\\sigma^2} (\\Delta x)^2 $$\n这是该格式的 Courant-Friedrichs-Lewy (CFL) 稳定性限制。题目要求将此限制写成 $\\Delta t \\le C (\\Delta x)^2$ 的形式。通过比较这两个表达式，我们确定常数 $C$。\n$$ C = \\frac{1}{\\sigma^2} $$", "answer": "$$\n\\boxed{\\frac{1}{\\sigma^2}}\n$$", "id": "3079816"}]}