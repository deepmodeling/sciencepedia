## 引言
[资产定价](@entry_id:144427)基本定理（Fundamental Theorems of Asset Pricing, FTAP）是现代金融理论的基石，它在经济直觉与严谨的数学定价之间架起了一座坚实的桥梁。这些定理深刻地回答了一个核心问题：在一个理性的市场中，资产的价格是如何形成的？它们揭示了市场的“[无套利](@entry_id:634322)”特性如何蕴含着一个强大的数学结构，即“[风险中性世界](@entry_id:147519)”，从而彻底改变了我们对[衍生品定价](@entry_id:144008)和[风险管理](@entry_id:141282)的理解。本文旨在系统性地梳理这一核心理论及其广泛应用。

在“**原理与机制**”一章中，我们将从[无套利原则](@entry_id:143960)的精确数学定义出发，逐步引入[等价鞅测度](@entry_id:636675)（EMM）和[随机贴现因子](@entry_id:141338)（SDF）等核心概念，并详细阐述第一和第二基本定理的内容及其证明逻辑。随后，在“**应用与跨学科联系**”一章中，我们将展示这些抽象理论如何在从经典的[Black-Scholes-Merton模型](@entry_id:145042)到复杂的固定收益和不完备市场的各类实际问题中发挥威力，揭示其作为统一分析框架的价值。最后，在“**动手实践**”部分，我们将通过一系列精选的计算练习，引导您亲手应用[Girsanov定理](@entry_id:147068)构建[风险中性测度](@entry_id:147013)，并在不同市场环境下计算衍生品价格，将理论知识转化为解决实际问题的能力。

## 原理与机制

本章旨在深入阐述[资产定价](@entry_id:144427)基本定理的理论核心。我们将从[无套利原则](@entry_id:143960)这一金融学的基石出发，逐步建立起一套严谨的数学框架。通过这个框架，我们将揭示金融市场中的“公平游戏”概念如何与[等价鞅测度](@entry_id:636675)这一强大的数学工具联系起来。本章内容将系统性地介绍第一和第二基本定理，并阐明它们在[衍生品定价](@entry_id:144008)、[风险管理](@entry_id:141282)和[市场完备性](@entry_id:637624)分析中的深刻含义。

### [无套利原则](@entry_id:143960)

金融理论的一个核心假设是市场中不存在无风险的获利机会，即**套利（arbitrage）**机会。这个原则不仅是理论建[模的基](@entry_id:156416)石，也符合我们对有效市场的直观理解。

#### 套利的严格定义

为了在数学上精确地使用这一概念，我们必须给出一个严格的定义。在一个金融市场模型中，一个[套利机会](@entry_id:634365)被定义为一个**可接纳的（admissible）**、**自融资的（self-financing）**交易策略，其对应的财富过程 $V_t$ 满足以下三个条件 [@problem_id:3055818]：

1.  **零成本投入**：初始投资为零，即 $V_0 = 0$。
2.  **无亏损风险**：在策略终点 $T$ 时，最终财富为非负的概率为 1，即 $\mathbb{P}(V_T \ge 0) = 1$。
3.  **存在盈利可能**：在策略终点 $T$ 时，最终财富为严格正的概率大于零，即 $\mathbb{P}(V_T > 0) > 0$。

这三点共同刻画了一种“空手套白狼”的情形：无需任何初始资本，没有任何亏损的可能，却有机会获得正收益。

#### 可接纳性与加倍策略

上述定义中，“可接纳性”是一个至关重要的技术性约束。一个策略是**可接纳的**，意味着其财富过程 $V_t$ 在整个生命周期内有一个确定的下界，即存在某个正常数 $a$，使得对所有 $t \in [0,T]$，有 $V_t \ge -a$ 几乎必然成立 [@problem_id:3055760] [@problem_id:3055816]。

为什么要引入这个看似复杂的要求呢？这是为了排除在现实经济中不可行的病态策略，例如经典的**“加倍策略”（doubling strategies）**。考虑一个公平的赌博游戏（例如，价格过程是一个[鞅](@entry_id:267779)），如果允许无限负债，交易者可以设计一个策略：每次亏损后，将赌注加倍。由于价格过程的波动性，这种策略最终几乎必然会盈利。然而，在盈利之前，该策略可能导致巨大且无界的亏损。可接纳性条件排除了这类依赖无限信贷的策略，使得我们的模型更贴近经济现实。如果没有可接纳性约束，即使在数学上“公平”的市场中，也可能构造出满足上述套利定义前三点的策略。因此，可接纳性是确保[无套利原则](@entry_id:143960)具有经济意义的守护者。

#### 从“[无套利](@entry_id:634322)”到“无风险消逝的无本逐利”

经典的[无套利](@entry_id:634322)（No Arbitrage, NA）条件虽然直观，但在处理连续时间模型时，其强度略显不足。为了建立更普适的理论，数学家们引入了一个更强的条件，称为**无风险消逝的无本逐利（No Free Lunch with Vanishing Risk, NFLVR）** [@problem_id:3055781] [@problem_id:3055842]。

NFLVR不仅排除了严格的[套利机会](@entry_id:634365)，还排除了“近似套利”或“极限套利”的情形。直观地说，它禁止存在一序列的交易策略，其最大可能损失趋向于零，而获得确定性收益的概率却趋向于一。从拓扑学角度看，NFLVR条件可以被精确地描述为：由所有可接纳策略产生的期末收益所构成的集合 $K$，其在 $L^\infty$ 范数下的闭包 $\overline{K}^{\| \cdot \|_\infty}$，与非负且非零的[随机变量](@entry_id:195330)集合 $L_+^\infty \setminus \{0\}$ 的交集为空集 [@problem_id:3055842]。即：
$$
\overline{K}^{\| \cdot \|_\infty} \cap (L_+^\infty \setminus \{0\}) = \emptyset
$$
引入闭包的概念至关重要，因为它确保了即使一个[套利机会](@entry_id:634365)本身无法通过单个策略实现，但可以通过一列策略无限逼近，这种情况也被排除在外。NFLVR正是现代[资产定价理论](@entry_id:139100)所依赖的、更稳健的无套利形式。

### 计价单位、贴现与[等价鞅测度](@entry_id:636675)

为了在不同时间点之间对资产价值进行有意义的比较，我们需要一个共同的“价值尺度”，这就是**计价单位（numeraire）**。通过将所有资产的价格都用同一个计价单位资产来表示，我们实际上是在进行**贴现（discounting）**，从而消除计价单位自身的时间价值增长，专注于资产的相对表现 [@problem_id:3055795]。

最常用的计价单位是**货币市场账户（money market account）**，其价格 $B_t$ 以无风险利率 $r_t$ 连续增长，即 $dB_t = r_t B_t dt$。假设我们有一个风险资产，其价格 $S_t$ 在真实世界测度 $\mathbb{P}$ 下遵循如下[随机微分方程](@entry_id:146618)（SDE）：
$$
dS_t = \mu_t S_t dt + \sigma_t S_t dW_t^\mathbb{P}
$$
其中 $\mu_t$ 是资产的期望收益率（或漂移项），$\sigma_t$ 是其波动率。

当我们用 $B_t$ 作为计价单位对 $S_t$ 进行[贴现](@entry_id:139170)时，得到贴现后的价格过程 $\tilde{S}_t = S_t / B_t$。使用[伊藤引理](@entry_id:138912)可以计算出 $\tilde{S}_t$ 在测度 $\mathbb{P}$ 下的动态：
$$
d\tilde{S}_t = \tilde{S}_t (\mu_t - r_t) dt + \tilde{S}_t \sigma_t dW_t^\mathbb{P}
$$
我们发现，贴现过程并没有消除漂移项，而是将其从 $\mu_t$ 变成了 $\mu_t - r_t$。这个量被称为**[风险溢价](@entry_id:137124)（risk premium）**，它代表了投资者因承担额外风险而获得的超额回报 [@problem_id:3055784] [@problem_id:3055795]。

一个没有漂移项的[随机过程](@entry_id:159502)在数学上被称为**鞅（martingale）**，它代表了一种“公平游戏”——未来的[期望值](@entry_id:153208)等于现在的观测值。显然，在真实世界测度 $\mathbb{P}$ 下，由于[风险溢价](@entry_id:137124)的存在，[贴现](@entry_id:139170)后的资产价格通常不是一个鞅。

这引出了[资产定价理论](@entry_id:139100)中最核心的概念之一：**[等价鞅测度](@entry_id:636675)（Equivalent Martingale Measure, EMM）**，通常记为 $\mathbb{Q}$。这是一个与真实世界测度 $\mathbb{P}$ 等价的概率测度（即它们拥有相同的[零测集](@entry_id:157694)，$\mathbb{Q} \sim \mathbb{P}$），并且在该测度下，所有经过计价单位[贴现](@entry_id:139170)后的资产价格过程都成为（局部）[鞅](@entry_id:267779) [@problem_id:3055770]。$\mathbb{Q}$ 也被称为**[风险中性测度](@entry_id:147013)（risk-neutral measure）**。它的存在，意味着我们可以通过数学变换，进入一个“风险中性”的虚拟世界，在这个世界里，所有资产的期望收益率都等于无风险利率。

### 第一[资产定价](@entry_id:144427)基本定理（FTAP）：EMM的存在性

第一基本定理在[无套利原则](@entry_id:143960)和[等价鞅测度](@entry_id:636675)之间建立了一座桥梁。

**定理 (FTAP)**：在一个金融市场模型中，NFLVR条件成立，当且仅当存在一个与真实测度 $\mathbb{P}$ 等价的[概率测度](@entry_id:190821) $\mathbb{Q}$，使得所有以某个计价单位[贴现](@entry_id:139170)后的资产价格过程都是 $\mathbb{Q}$-[局部鞅](@entry_id:186755)。[@problem_id:3055781]

这个定理包含两个方面：
1.  如果市场是[无套利](@entry_id:634322)的（满足NFLVR），那么至少存在一个等价（局部）[鞅测度](@entry_id:183262) $\mathbb{Q}$。
2.  如果存在一个等价（局部）[鞅测度](@entry_id:183262) $\mathbb{Q}$，那么市场必定是无套利的。

这个定理的意义是革命性的。它将一个经济学概念（无套利）转化为一个数学对象（EMM）。一旦我们找到了这个 $\mathbb{Q}$ 测度，我们就可以在一个期望计算变得异常简单的世界里为[衍生品定价](@entry_id:144008)。

#### 从 $\mathbb{P}$ 到 $\mathbb{Q}$：[Girsanov定理](@entry_id:147068)与风险价格

从真实世界测度 $\mathbb{P}$ 转换到[风险中性测度](@entry_id:147013) $\mathbb{Q}$ 的数学工具是**[Girsanov定理](@entry_id:147068)**。该定理指出，我们可以通过改变一个布朗运动的漂移项来定义一个新的[等价测度](@entry_id:634447)。具体来说，如果我们定义一个新的过程 $W_t^\mathbb{Q}$：
$$
dW_t^\mathbb{Q} = dW_t^\mathbb{P} + \lambda_t dt
$$
那么在满足一定技术条件（如[Novikov条件](@entry_id:634732)）下，存在一个由 $\lambda_t$ 决定的新测度 $\mathbb{Q}$，使得 $W_t^\mathbb{Q}$ 在 $\mathbb{Q}$ 下是一个[标准布朗运动](@entry_id:197332) [@problem_id:3055828]。这里的过程 $\lambda_t$ 被称为**Girsanov核**。

现在，我们来寻找这个关键的 $\lambda_t$。我们希望在 $\mathbb{Q}$ 测度下，[贴现](@entry_id:139170)价格 $\tilde{S}_t$ 的漂移项为零。回顾 $\tilde{S}_t$ 在 $\mathbb{P}$ 下的动态：
$$
d\tilde{S}_t = \tilde{S}_t (\mu_t - r_t) dt + \tilde{S}_t \sigma_t dW_t^\mathbb{P}
$$
将 $dW_t^\mathbb{P} = dW_t^\mathbb{Q} - \lambda_t dt$ 代入上式：
$$
d\tilde{S}_t = \tilde{S}_t (\mu_t - r_t) dt + \tilde{S}_t \sigma_t (dW_t^\mathbb{Q} - \lambda_t dt) = \tilde{S}_t [(\mu_t - r_t) - \sigma_t \lambda_t] dt + \tilde{S}_t \sigma_t dW_t^\mathbb{Q}
$$
为了使 $\tilde{S}_t$ 成为 $\mathbb{Q}$-[鞅](@entry_id:267779)，其漂移项必须为零。因此，我们必须选择 $\lambda_t$ 使得：
$$
(\mu_t - r_t) - \sigma_t \lambda_t = 0
$$
假设 $\sigma_t \ne 0$，我们可以解出 $\lambda_t$：
$$
\lambda_t = \frac{\mu_t - r_t}{\sigma_t}
$$
这个 $\lambda_t$ 就是大名鼎鼎的**市场风险价格（market price of risk）**。它衡量了每一单位风险（由 $\sigma_t$ 度量）所对应的超额回报（[风险溢价](@entry_id:137124) $\mu_t - r_t$）。

通过将Girsanov核设定为市场风险价格，我们成功地构建了[风险中性测度](@entry_id:147013) $\mathbb{Q}$。在这个测度下，[贴现](@entry_id:139170)资产价格 $\tilde{S}_t$ 成为一个鞅。更有趣的是，我们还可以考察未[贴现](@entry_id:139170)的原始资产价格 $S_t$ 在 $\mathbb{Q}$ 下的动态。将 $dW_t^\mathbb{P} = dW_t^\mathbb{Q} - \lambda_t dt$ 代入 $S_t$ 的原始SDE：
$$
dS_t = \mu_t S_t dt + \sigma_t S_t (dW_t^\mathbb{Q} - \lambda_t dt) = S_t (\mu_t - \sigma_t \lambda_t) dt + S_t \sigma_t dW_t^\mathbb{Q}
$$
代入 $\lambda_t$ 的表达式，漂移项变为：
$$
\mu_t - \sigma_t \left( \frac{\mu_t - r_t}{\sigma_t} \right) = \mu_t - (\mu_t - r_t) = r_t
$$
因此，在[风险中性测度](@entry_id:147013) $\mathbb{Q}$ 下，资产价格 $S_t$ 的动态方程为：
$$
dS_t = r_t S_t dt + \sigma_t S_t dW_t^\mathbb{Q}
$$
这是一个深刻而优美的结果：在[风险中性世界](@entry_id:147519)里，所有风险资产的期望收益率都恰好等于无风险利率 $r_t$ [@problem_id:3055784]。

### 理论的深化：[局部鞅](@entry_id:186755)与[随机贴现因子](@entry_id:141338)

#### [局部鞅](@entry_id:186755)与可接纳性的再思考

在严格的FTAP表述中，我们说的是**[局部鞅](@entry_id:186755)（local martingale）**，而非真正的[鞅](@entry_id:267779)。一个[局部鞅](@entry_id:186755)在局部上表现得像鞅，但可能不是一个真正的鞅（例如，其[期望值](@entry_id:153208)可能不是常数）。NFLVR这一经济条件在数学上只能保证[等价鞅测度](@entry_id:636675)是一个等价**局部**[鞅测度](@entry_id:183262)（ELMM）[@problem_id:3055816]。

如果[贴现](@entry_id:139170)财富过程只是一个[局部鞅](@entry_id:186755)，为什么套利仍然被排除了呢？这又回到了**可接纳性**的重要性。一个被下方有界的[局部鞅](@entry_id:186755)是一个**[超鞅](@entry_id:271504)（supermartingale）**。对于一个可接纳策略的贴现财富过程 $X_t$，由于其下方有界，它在 $\mathbb{Q}$ 测度下必然是一个[超鞅](@entry_id:271504)。[超鞅](@entry_id:271504)的性质是其期望不增，即 $\mathbb{E}^\mathbb{Q}[X_T] \le X_0$。对于一个初始投资为零（$X_0=0$）的套利策略，其期末财富必须满足 $X_T \ge 0$ 且 $\mathbb{P}(X_T > 0) > 0$，这意味着 $\mathbb{E}^\mathbb{Q}[X_T] > 0$。这与超[鞅性质](@entry_id:261270) $\mathbb{E}^\mathbb{Q}[X_T] \le 0$ 直接矛盾。因此，可接纳性与[局部鞅](@entry_id:186755)性质的结合，共同杜绝了[套利机会](@entry_id:634365)的存在 [@problem_id:3055816]。

#### [随机贴现因子](@entry_id:141338)（SDF）

[等价鞅测度](@entry_id:636675)方法并非唯一的理论视角。另一种完全等价的方法是**[随机贴现因子](@entry_id:141338)（Stochastic Discount Factor, SDF）**方法，也称为**[定价核](@entry_id:145713)（pricing kernel）**方法。

一个SDF（记为 $Y_t$）是一个严格为正的[随机过程](@entry_id:159502)，其特性是：当任何可交易资产的价格 $S_t$ 乘以 $Y_t$ 后，得到的乘积过程 $Y_t S_t$ 在**真实世界测度 $\mathbb{P}$** 下是一个[鞅](@entry_id:267779) [@problem_id:3055852]。

SDF方法与EMM方法是紧密相连的。SDF $Y_t$ 与[风险中性测度](@entry_id:147013) $\mathbb{Q}$ 的Radon-Nikodym密度过程 $Z_t = d\mathbb{Q}/d\mathbb{P}|_{\mathcal{F}_t}$ 以及货币市场账户 $B_t$ 之间存在如下关系：
$$
Y_t = \frac{Z_t}{B_t}
$$
我们可以验证这个关系。一个资产的[贴现](@entry_id:139170)价格 $\tilde{S}_t = S_t/B_t$ 在 $\mathbb{Q}$ 下是鞅，等价于 $\mathbb{E}^\mathbb{Q}[\tilde{S}_T | \mathcal{F}_t] = \tilde{S}_t$。通过[测度变换](@entry_id:157887)公式，这又等价于 $\mathbb{E}^\mathbb{P}[Z_T \tilde{S}_T | \mathcal{F}_t] = Z_t \tilde{S}_t$。将 $Y_t = Z_t/B_t$ 代入，这正好说明了 $Y_t S_t = (Z_t/B_t) (B_t \tilde{S}_t) = Z_t \tilde{S}_t$ 是一个 $\mathbb{P}$-[鞅](@entry_id:267779)。

SDF的视角提供了一个统一的定价公式：任何资产在 $t$ 时刻的价格 $S_t$ 等于其未来所有现金流 $C_u$ 经过SDF贴现后在真实测度 $\mathbb{P}$下的[期望值](@entry_id:153208)：
$$
S_t = \mathbb{E}^\mathbb{P} \left[ \int_t^T \frac{Y_u}{Y_t} C_u du \bigg| \mathcal{F}_t \right]
$$
在一个特殊情况中，如果市场中所有风险资产的期望收益率都恰好等于无风险利率（即 $\mu_t = r_t$），那么市场风险价格为零，$\mathbb{P}$ 与 $\mathbb{Q}$ 测度相同，$Z_t \equiv 1$。此时，SDF就退化为普通的无风险[贴现](@entry_id:139170)因子 $Y_t = 1/B_t$ [@problem_id:3055852]。

### 第二[资产定价](@entry_id:144427)基本定理（SFTAP）：EMM的唯一性

第一基本定理解决了EMM的存在性问题，而第二基本定理则关注其唯一性，并将其与市场的**完备性（completeness）**联系起来。

**定义 ([市场完备性](@entry_id:637624))**：一个市场被称为**完备的**，如果任何一个在期末 $T$ 时刻支付的、结果依赖于市场状态的“合理”或有支付（contingent claim）$X_T$，都可以通过一个自融资的交易策略完美复制。这意味着存在一个初始资本 $V_0$ 和一个交易策略，使得其在 $T$ 时刻的财富恰好等于 $X_T$ [@problem_id:3055766]。

**定理 (SFTAP)**：在一个满足NFLVR的市场中，该市场是完备的，当且仅当[等价鞅测度](@entry_id:636675) $\mathbb{Q}$ 是唯一的。

这个定理的含义是：
1.  如果市场是完备的，那么[风险中性测度](@entry_id:147013) $\mathbb{Q}$ 是唯一的。这意味着任何或有支付都有一个唯一的、[无套利](@entry_id:634322)的价格，即其在唯一的 $\mathbb{Q}$ 测度下[贴现](@entry_id:139170)后的[期望值](@entry_id:153208)。
2.  如果[风险中性测度](@entry_id:147013) $\mathbb{Q}$ 是唯一的，那么市场是完备的。这意味着所有“合理”的风险都可以通过交易基础资产来完全[对冲](@entry_id:635975)掉。

#### 完备性、唯一性与风险来源

在由布朗运动驱动的模型中，市场的完备性与EMM的唯一性最终取决于市场中**可交易的风险资产数量**与**独立的风险来源数量**之间的关系 [@problem_id:3055766]。

假设市场中有 $d$ 个风险资产，而风险由一个 $m$ 维的布朗运动驱动。风险价格方程为 $\sigma_t \lambda_t = \mu_t - r_t \mathbf{1}$，其中 $\sigma_t$ 是一个 $d \times m$ 的波动率矩阵。
-   **EMM的唯一性**取决于该方程的解 $\lambda_t$ 是否唯一。如果波动率矩阵 $\sigma_t$ 的列是[线性无关](@entry_id:148207)的（即 $\text{rank}(\sigma_t)=m$），那么解 $\lambda_t$ 就是唯一的。这要求 $d \ge m$。
-   **市场的完备性**取决于我们是否能复制任何风险。这要求我们能够通过组合 $d$ 个资产来对冲 $m$ 个维度的风险。在数学上，这同样要求 $\text{rank}(\sigma_t)=m$。

因此，在布朗运动框架下，EMM的唯一性与市场的完备性都等价于波动率矩阵的秩等于风险来源的维度，即 $\text{rank}(\sigma_t)=m$。

-   **完备市场**：最典型的情况是资产数量等于风险源数量（$d=m$），且波动率矩阵 $\sigma_t$ 可逆。此时EMM唯一，市场完备。所有衍生品都有唯一的[无套利](@entry_id:634322)价格，并且可以被完美复制 [@problem_id:3055766]。
-   **不完备市场**：如果风险源数量多于资产数量（$m>d$），市场通常是不完备的。此时，方程 $\sigma_t \lambda_t = \mu_t - r_t \mathbf{1}$ 有无穷多组解，对应无穷多个EMM。不可复制的衍生品没有唯一的价格，其价格会落在一个区间内，具体取决于定价者对不可[对冲](@entry_id:635975)风险的偏好（即选择哪个EMM）。

综上所述，[资产定价](@entry_id:144427)基本定理为我们提供了一个从经济直觉到严谨数学的完整逻辑链条。它不仅是理论上的巨大成就，更为现代[金融工程](@entry_id:136943)中[衍生品定价](@entry_id:144008)和风险管理的实践提供了坚实的理论基础。