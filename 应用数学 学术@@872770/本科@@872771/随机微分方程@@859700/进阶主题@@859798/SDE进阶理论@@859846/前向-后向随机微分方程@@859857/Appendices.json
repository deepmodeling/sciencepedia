{"hands_on_practices": [{"introduction": "虽然大多数正向-反向随机微分方程 (FBSDE) 需要数值方法求解，但研究一个可解析求解的案例对于理解其核心结构非常有价值。这个练习将引导你使用变量代换（吉尔萨诺夫定理）和积分因子等关键技巧，为一个重要的线性FBSDE类别推导出精确的闭式解。通过这个过程，你将为处理更复杂的耦合系统和数值方法打下坚实的基础。[@problem_id:3054739]", "problem": "考虑一个带域概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$，其上定义了一个一维标准布朗运动 $W=(W_t)_{t\\in[0,T]}$，具有固定的时间界限 $T>0$。一个解耦的前向-后向随机微分方程（FBSDE，Forward-Backward Stochastic Differential Equation）的前向部分由以下随机微分方程给出：\n$$\ndX_t=\\mu\\,dt+\\sigma\\,dW_t,\\qquad X_0=x_0,\n$$\n其中 $\\mu\\in\\mathbb{R}$ 和 $\\sigma>0$ 是常数，而 $x_0\\in\\mathbb{R}$ 是确定的。后向部分 $(Y,Z)$ 满足\n$$\ndY_t=-f(t,X_t,Y_t,Z_t)\\,dt+Z_t\\,dW_t,\\qquad Y_T=g(X_T),\n$$\n其驱动函数和终端函数由下式指定：\n$$\nf(t,x,y,z)=\\alpha\\,y+\\beta\\,z+\\gamma,\\qquad g(x)=\\lambda\\,x+\\delta,\n$$\n其中 $\\alpha\\in\\mathbb{R}\\setminus\\{0\\}$，$\\beta,\\gamma,\\lambda,\\delta\\in\\mathbb{R}$ 是常数。假设满足所有通常条件（包括可积性和关于常数 $\\beta$ 的 Novikov 条件），以确保平方可积解 $(Y,Z)$ 的存在性和唯一性。\n\n从 Itô 过程和后向随机微分方程的基本定义出发，推导 $Y_0$ 关于 $x_0$、$T$ 以及常数 $\\mu$、$\\sigma$、$\\alpha$、$\\beta$、$\\gamma$、$\\lambda$ 和 $\\delta$ 的显式闭式表达式。你的最终答案必须是单一的闭式解析表达式。不需要四舍五入，也不涉及任何物理单位。", "solution": "该问题提供了一个解耦的前向-后向随机微分方程 (FBSDE) 系统，并要求计算后向过程在时间 $t=0$ 时的值，记为 $Y_0$。该系统定义在一个带域概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 上，其中 $W_t$ 是一个标准的一维布朗运动。\n\n前向过程 $X_t$ 是一个算术布朗运动，由以下随机微分方程 (SDE) 给出：\n$$dX_t = \\mu\\,dt + \\sigma\\,dW_t, \\quad X_0 = x_0$$\n其中 $\\mu \\in \\mathbb{R}$，$\\sigma > 0$，以及 $x_0 \\in \\mathbb{R}$ 是常数。\n\n后向过程 $(Y_t, Z_t)$ 由后向随机微分方程 (BSDE) 定义：\n$$dY_t = -f(t,X_t,Y_t,Z_t)\\,dt + Z_t\\,dW_t, \\quad Y_T = g(X_T)$$\n驱动函数 $f$ 和终端函数 $g$ 是线性的：\n$$f(t,x,y,z) = \\alpha y + \\beta z + \\gamma$$\n$$g(x) = \\lambda x + \\delta$$\n其中 $\\alpha \\in \\mathbb{R}\\setminus\\{0\\}$，以及 $\\beta, \\gamma, \\lambda, \\delta \\in \\mathbb{R}$ 是常数。该问题假设了保证唯一平方可积解对 $(Y_t, Z_t)$ 存在的条件。\n\n将驱动函数 $f$ 的具体形式代入 BSDE，得到：\n$$dY_t = -(\\alpha Y_t + \\beta Z_t + \\gamma)\\,dt + Z_t\\,dW_t$$\n这是一个线性 BSDE。解决该方程的一个标准方法是使用测度变换来消除漂移项中包含 $Z_t$ 的项。我们定义一个与 $\\mathbb{P}$ 等价的新概率测度 $\\mathbb{Q}$。令 $M_t = \\int_0^t \\beta \\, dW_s = \\beta W_t$。$M_t$ 的 Doléans-Dade 指数是 $\\mathcal{E}(M)_t = \\exp(\\beta W_t - \\frac{1}{2}\\beta^2 t)$。我们将 Radon-Nikodym 导数定义为 $\\frac{d\\mathbb{Q}}{d\\mathbb{P}}|_{\\mathcal{F}_T} = \\mathcal{E}(M)_T$。Novikov 条件被满足的假设确保了 $\\mathcal{E}(M)_t$ 是一个鞅，并且 $\\mathbb{E}[\\mathcal{E}(M)_T] = 1$。\n\n根据 Girsanov 定理，由\n$$\\widetilde{W}_t = W_t - \\int_0^t \\beta \\, ds = W_t - \\beta t$$\n定义的过程 $\\widetilde{W}_t$ 在测度 $\\mathbb{Q}$ 下是一个标准布朗运动。我们可以将 $dW_t$ 表示为 $dW_t = d\\widetilde{W}_t + \\beta \\, dt$。\n\n现在，我们在测度 $\\mathbb{Q}$ 下重写这两个 SDE。\n$X_t$ 的前向 SDE 变为：\n$$dX_t = \\mu\\,dt + \\sigma(d\\widetilde{W}_t + \\beta\\,dt) = (\\mu + \\sigma\\beta)\\,dt + \\sigma\\,d\\widetilde{W}_t$$\n$Y_t$ 的后向 SDE 变为：\n$$dY_t = -(\\alpha Y_t + \\beta Z_t + \\gamma)\\,dt + Z_t(d\\widetilde{W}_t + \\beta\\,dt)$$\n$$dY_t = -(\\alpha Y_t + \\gamma)\\,dt - \\beta Z_t\\,dt + Z_t\\,\\beta\\,dt + Z_t\\,d\\widetilde{W}_t$$\n$$dY_t = -(\\alpha Y_t + \\gamma)\\,dt + Z_t\\,d\\widetilde{W}_t$$\n在 $\\mathbb{Q}$ 下，这个 BSDE 更简单，因为它的漂移项不依赖于 $Z_t$。为了求解它，我们使用积分因子。考虑过程 $e^{\\alpha t}Y_t$。应用 Itô 乘积法则：\n$$d(e^{\\alpha t}Y_t) = (\\alpha e^{\\alpha t}Y_t)\\,dt + e^{\\alpha t}\\,dY_t$$\n代入 $dY_t$ 的表达式：\n$$d(e^{\\alpha t}Y_t) = \\alpha e^{\\alpha t}Y_t\\,dt + e^{\\alpha t}(-(\\alpha Y_t + \\gamma)\\,dt + Z_t\\,d\\widetilde{W}_t)$$\n$$d(e^{\\alpha t}Y_t) = \\alpha e^{\\alpha t}Y_t\\,dt - \\alpha e^{\\alpha t}Y_t\\,dt - \\gamma e^{\\alpha t}\\,dt + e^{\\alpha t}Z_t\\,d\\widetilde{W}_t$$\n$$d(e^{\\alpha t}Y_t) = -\\gamma e^{\\alpha t}\\,dt + e^{\\alpha t}Z_t\\,d\\widetilde{W}_t$$\n将此方程从任意时间 $t \\in [0,T]$ 积分到 $T$：\n$$e^{\\alpha T}Y_T - e^{\\alpha t}Y_t = \\int_t^T -\\gamma e^{\\alpha s}\\,ds + \\int_t^T e^{\\alpha s}Z_s\\,d\\widetilde{W}_s$$\n我们可以解出 $e^{\\alpha t}Y_t$：\n$$e^{\\alpha t}Y_t = e^{\\alpha T}Y_T + \\gamma \\int_t^T e^{\\alpha s}\\,ds - \\int_t^T e^{\\alpha s}Z_s\\,d\\widetilde{W}_s$$\n在测度 $\\mathbb{Q}$ 下，对域流 $\\mathcal{F}_t$ 取条件期望：\n$$\\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha t}Y_t | \\mathcal{F}_t] = \\mathbb{E}_{\\mathbb{Q}}\\left[e^{\\alpha T}Y_T + \\gamma \\int_t^T e^{\\alpha s}\\,ds - \\int_t^T e^{\\alpha s}Z_s\\,d\\widetilde{W}_s \\bigg| \\mathcal{F}_t\\right]$$\n由于 $Y_t$ 是 $\\mathcal{F}_t$-可测的，所以 $\\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha t}Y_t | \\mathcal{F}_t] = e^{\\alpha t}Y_t$。随机积分 $\\int_t^T e^{\\alpha s}Z_s\\,d\\widetilde{W}_s$ 是一个从时间 $t$ 开始值为 $0$ 的 $\\mathbb{Q}$-鞅，所以其条件期望为零。包含 $\\gamma e^{\\alpha s}$ 积分的项是确定的。\n$$e^{\\alpha t}Y_t = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T | \\mathcal{F}_t] + \\gamma \\int_t^T e^{\\alpha s}\\,ds$$\n让我们计算这个确定性积分：\n$$\\int_t^T e^{\\alpha s}\\,ds = \\left[\\frac{e^{\\alpha s}}{\\alpha}\\right]_t^T = \\frac{1}{\\alpha}(e^{\\alpha T} - e^{\\alpha t})$$\n将其代回并求解 $Y_t$：\n$$Y_t = e^{-\\alpha t} \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T | \\mathcal{F}_t] + \\frac{\\gamma}{\\alpha}e^{-\\alpha t}(e^{\\alpha T} - e^{\\alpha t})$$\n$$Y_t = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha(T-t)}Y_T | \\mathcal{F}_t] + \\frac{\\gamma}{\\alpha}(e^{\\alpha(T-t)} - 1)$$\n题目要求我们求 $Y_0$。令 $t=0$：\n$$Y_0 = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T | \\mathcal{F}_0] + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n由于 $X_0=x_0$ 是确定的，域流 $\\mathcal{F}_0$ 是平凡的。因此，条件期望就是 $\\mathbb{Q}$ 下的无条件期望：\n$$Y_0 = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}Y_T] + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n现在代入终端条件 $Y_T = g(X_T) = \\lambda X_T + \\delta$：\n$$Y_0 = \\mathbb{E}_{\\mathbb{Q}}[e^{\\alpha T}(\\lambda X_T + \\delta)] + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n$$Y_0 = \\lambda e^{\\alpha T}\\mathbb{E}_{\\mathbb{Q}}[X_T] + \\delta e^{\\alpha T} + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n最后一步是计算 $\\mathbb{E}_{\\mathbb{Q}}[X_T]$。在 $\\mathbb{Q}$ 下，$X_t$ 的动态过程是 $dX_t = (\\mu + \\sigma\\beta)\\,dt + \\sigma\\,d\\widetilde{W}_t$。从 $0$ 积分到 $T$：\n$$X_T = X_0 + \\int_0^T (\\mu + \\sigma\\beta)\\,ds + \\int_0^T \\sigma\\,d\\widetilde{W}_s = x_0 + (\\mu + \\sigma\\beta)T + \\sigma\\widetilde{W}_T$$\n在 $\\mathbb{Q}$ 下取期望，并利用 $\\mathbb{E}_{\\mathbb{Q}}[\\widetilde{W}_T]=0$：\n$$\\mathbb{E}_{\\mathbb{Q}}[X_T] = x_0 + (\\mu + \\sigma\\beta)T$$\n最后，我们将此结果代入 $Y_0$ 的表达式中：\n$$Y_0 = \\lambda e^{\\alpha T}(x_0 + (\\mu + \\sigma\\beta)T) + \\delta e^{\\alpha T} + \\frac{\\gamma}{\\alpha}(e^{\\alpha T} - 1)$$\n可以将其重新整理，以提供最终的闭式表达式：\n$$Y_0 = \\exp(\\alpha T)\\left(\\lambda x_0 + \\lambda(\\mu + \\sigma\\beta)T + \\delta\\right) + \\frac{\\gamma}{\\alpha}(\\exp(\\alpha T) - 1)$$", "answer": "$$\\boxed{\\exp(\\alpha T)\\left( \\lambda x_0 + \\lambda(\\mu + \\sigma\\beta)T + \\delta \\right) + \\frac{\\gamma}{\\alpha}(\\exp(\\alpha T) - 1)}$$", "id": "3054739"}, {"introduction": "在前一个练习的基础上，我们知道后向递推中的一个核心挑战是估计$Z$过程。本练习将深入探讨一种强大的蒙特卡洛方法背后的理论依据：使用最小二乘回归来估计$Z$。它揭示了抽象的伊藤等距定理与具体计算步骤之间的深刻联系，帮助你理解为什么这种方法在数值上是合理且有效的。[@problem_id:3054590]", "problem": "考虑一个在带有标准布朗运动 $W$ 的带域概率空间上的马尔可夫前向后向随机微分方程 (FBSDE)，其中前向分量 $X$ 求解随机微分方程\n$$\n\\mathrm{d}X_t = b(t,X_t)\\,\\mathrm{d}t + \\sigma(t,X_t)\\,\\mathrm{d}W_t,\\quad X_0 = x,\n$$\n并且后向分量 $(Y,Z)$ 求解\n$$\nY_t = g(X_T) + \\int_t^T f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_t^T Z_s\\,\\mathrm{d}W_s,\\quad t\\in[0,T].\n$$\n固定一个均匀网格 $0=t_0  t_1  \\dots  t_N=T$。在后向时间步进算法中，估计过程 $Z$ 是一个关键挑战。在马尔可夫框架下，我们知道 $Z_{t_i} = z(t_i, X_{t_i})$。一种常用的方法是使用最小二乘蒙特卡洛。该方法基于一个近似关系，该关系通过在 $[t_i, t_{i+1}]$ 上离散化 BSDE 并利用伊藤等距性质的离散版本推导得出。以下哪个关系是这种估计方法的核心？\n\nA. $Z_{t_i} \\approx \\frac{1}{\\Delta t} \\mathbb{E}[Y_{t_{i+1}}\\Delta W_i \\mid \\mathcal{F}_{t_i}]$\n\nB. $Z_{t_i} \\approx \\frac{1}{\\Delta t} \\mathbb{E}[Y_{t_i}\\Delta W_i \\mid \\mathcal{F}_{t_i}]$\n\nC. $Z_{t_i} \\approx \\frac{1}{\\Delta t} \\mathbb{E}[Y_{t_{i+1}} \\mid \\mathcal{F}_{t_i}]$\n\nD. $Z_{t_i} \\approx \\mathbb{E}[Y_{t_{i+1}}\\Delta W_i \\mid \\mathcal{F}_{t_i}]$", "solution": "该问题要求我们确定一种基于最小二乘蒙特卡洛方法的数值方案中，用于估计后向过程 $Z$ 的核心关系。\n\n首先，我们从后向随机微分方程（BSDE）的积分形式出发：\n$$ Y_t = Y_{t_{i+1}} + \\int_t^{t_{i+1}} f(s,X_s,Y_s,Z_s)\\,\\mathrm{d}s - \\int_t^{t_{i+1}} Z_s\\,\\mathrm{d}W_s $$\n我们在时间区间 $[t_i, t_{i+1}]$ 上离散化这个方程，其中 $\\Delta t = t_{i+1} - t_i$ 并且 $\\Delta W_i = W_{t_{i+1}} - W_{t_i}$。使用欧拉-丸山（Euler-Maruyama）近似，我们可以将积分近似为：\n$$ Y_{t_i} \\approx Y_{t_{i+1}} + f(t_i, X_{t_i}, Y_{t_i}, Z_{t_i})\\Delta t - Z_{t_i}\\Delta W_i $$\n我们的目标是求解 $Z_{t_i}$。为了分离 $Z_{t_i}$，我们将上式两边同时乘以 $\\Delta W_i$：\n$$ Y_{t_i}\\Delta W_i \\approx Y_{t_{i+1}}\\Delta W_i + f_i\\Delta t \\Delta W_i - Z_{t_i}(\\Delta W_i)^2 $$\n其中 $f_i = f(t_i, X_{t_i}, Y_{t_i}, Z_{t_i})$。\n\n现在，我们对上式两边取关于 $\\mathcal{F}_{t_i}$ 的条件期望 $\\mathbb{E}[\\cdot \\mid \\mathcal{F}_{t_i}]$。我们利用以下条件期望的关键性质：\n1.  对于任何在 $\\mathcal{F}_{t_i}$ 上可测的随机变量 $A$，有 $\\mathbb{E}[A \\mid \\mathcal{F}_{t_i}] = A$。由于 $Y_{t_i}$、 $X_{t_i}$（以及因此的 $f_i$ 和 $Z_{t_i}$）都是 $\\mathcal{F}_{t_i}$-可测的，它们在条件期望中可以被视为常数。\n2.  布朗运动的增量 $\\Delta W_i$ 独立于 $\\mathcal{F}_{t_i}$，且其期望为零：$\\mathbb{E}[\\Delta W_i \\mid \\mathcal{F}_{t_i}] = \\mathbb{E}[\\Delta W_i] = 0$。\n3.  布朗运动增量的二阶矩是时间增量：$\\mathbb{E}[(\\Delta W_i)^2 \\mid \\mathcal{F}_{t_i}] = \\mathbb{E}[(\\Delta W_i)^2] = \\Delta t$。这本质上是伊藤等距性质（Itô isometry）的离散形式。\n\n应用这些性质，我们得到：\n$$ \\mathbb{E}[Y_{t_i}\\Delta W_i \\mid \\mathcal{F}_{t_i}] \\approx \\mathbb{E}[Y_{t_{i+1}}\\Delta W_i \\mid \\mathcal{F}_{t_i}] + \\mathbb{E}[f_i\\Delta t \\Delta W_i \\mid \\mathcal{F}_{t_i}] - \\mathbb{E}[Z_{t_i}(\\Delta W_i)^2 \\mid \\mathcal{F}_{t_i}] $$\n$$ Y_{t_i}\\mathbb{E}[\\Delta W_i \\mid \\mathcal{F}_{t_i}] \\approx \\mathbb{E}[Y_{t_{i+1}}\\Delta W_i \\mid \\mathcal{F}_{t_i}] + f_i\\Delta t \\mathbb{E}[\\Delta W_i \\mid \\mathcal{F}_{t_i}] - Z_{t_i}\\mathbb{E}[(\\Delta W_i)^2 \\mid \\mathcal{F}_{t_i}] $$\n由于 $\\mathbb{E}[\\Delta W_i \\mid \\mathcal{F}_{t_i}] = 0$，上式简化为：\n$$ 0 \\approx \\mathbb{E}[Y_{t_{i+1}}\\Delta W_i \\mid \\mathcal{F}_{t_i}] - Z_{t_i}\\Delta t $$\n重新整理，我们得到 $Z_{t_i}$ 的估计：\n$$ Z_{t_i} \\approx \\frac{1}{\\Delta t} \\mathbb{E}[Y_{t_{i+1}}\\Delta W_i \\mid \\mathcal{F}_{t_i}] $$\n这个关系是最小二乘蒙特卡洛方法估计 $Z_{t_i}$ 的理论基础。在实践中，条件期望通过对 $X_{t_i}$ 的一组基函数进行回归来近似。\n\n-   **选项A** 正确地陈述了这一核心关系。\n-   **选项B** 使用 $Y_{t_i}$ 而不是 $Y_{t_{i+1}}$，这在数学上是不正确的，它会导致 $Z_{t_i} \\approx 0$。\n-   **选项C** 遗漏了关键的 $\\Delta W_i$ 项，这没有利用到 $Z$ 与随机项的关联。\n-   **选项D** 遗漏了 $\\frac{1}{\\Delta t}$ 因子，这违反了伊藤等距的缩放性质。\n\n因此，选项A是正确的。", "answer": "$$\\boxed{A}$$", "id": "3054590"}]}