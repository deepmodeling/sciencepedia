{"hands_on_practices": [{"introduction": "我们从最经典的情景开始：在一场公平的赌局中，赌徒获胜的概率是多少？这个问题构建了一个简单对称随机游走模型，其中向上或向下移动的概率相等。通过求解这个问题，你将练习使用“一步分析法”来推导并求解一个边界值问题，这是计算随机过程中首次到达时间的基石。[@problem_id:3056065]", "problem": "考虑一个在状态空间 $\\{0,1,\\dots,N\\}$ 上的简单对称随机游走 (SSRW) $\\{X_n\\}_{n \\ge 0}$，其中 $N \\in \\mathbb{N}$ 且 $N \\ge 2$。该过程从某个 $i \\in \\{1,\\dots,N-1\\}$ 的 $X_0=i$ 开始，并在每一步以概率 $1/2$ 移动到 $X_{n+1}=X_n+1$，或以概率 $1/2$ 移动到 $X_{n+1}=X_n-1$，且每一步都与过去无关。边界状态 $0$ 和 $N$ 是吸收态。定义击中时间 $T_0=\\inf\\{n \\ge 0: X_n=0\\}$ 和 $T_N=\\inf\\{n \\ge 0: X_n=N\\}$，以及击中概率\n$$\nh(i) = \\mathbb{P}_i\\left(T_N  T_0\\right),\n$$\n其中 $\\mathbb{P}_i$ 表示在 $X_0=i$ 条件下的概率。\n\n仅使用马尔可夫性质和对第一步进行条件化，按以下步骤进行：\n1. 导出内部状态 $i \\in \\{1,\\dots,N-1\\}$ 的 $h(i)$ 所满足的线性差分方程，以及在 $i=0$ 和 $i=N$ 处的边界条件。\n2. 求解所得的边值问题，以获得 $h(i)$ 关于 $i$ 和 $N$ 的显式表达式。\n3. 使用适用于有限图上调和函数的离散最大值原理，证明在所有满足相同差分方程和边界条件的函数 $u:\\{0,1,\\dots,N\\}\\to\\mathbb{R}$ 中，解的唯一性。\n\n请提供 $h(i)$ 关于 $i$ 和 $N$ 的单一闭式表达式作为最终答案。", "solution": "该问题是有效的，因为它是随机过程理论中一个适定、有科学依据且客观的问题。这是一个关于有限区间上简单对称随机游走击中概率的经典问题。我们按照问题陈述中指定的三个步骤进行求解。\n\n待确定的量是概率 $h(i) = \\mathbb{P}_i(T_N  T_0)$，即从状态 $i$ 开始的随机游走在击中状态 $0$ 之前击中状态 $N$ 的概率。这里，状态空间为 $\\{0, 1, \\dots, N\\}$，其中 $0$ 和 $N$ 是吸收边界，起始状态 $i$ 在内部，即 $i \\in \\{1, \\dots, N-1\\}$。\n\n1. 线性差分方程和边界条件的推导。\n\n我们通过对随机游走的第一步进行条件化，利用全概率公式和马尔可夫性质来推导 $h(i)$ 的方程。从状态 $i \\in \\{1, \\dots, N-1\\}$ 开始，过程以概率 $1/2$ 移动到状态 $i+1$，或以概率 $1/2$ 移动到状态 $i-1$。设 $X_n$ 表示在时间 $n$ 的位置。\n$$h(i) = \\mathbb{P}(T_N  T_0 | X_0=i)$$\n对 $X_1$ 进行条件化：\n$$h(i) = \\mathbb{P}(T_N  T_0 | X_1=i+1)\\mathbb{P}(X_1=i+1|X_0=i) + \\mathbb{P}(T_N  T_0 | X_1=i-1)\\mathbb{P}(X_1=i-1|X_0=i)$$\n根据马尔可夫性质，从 $X_1=j$ 开始的过程在击中 $0$ 之前击中 $N$ 的概率，与过程从 $X_0=j$ 开始的概率相同。因此，$\\mathbb{P}(T_N  T_0 | X_1=j) = h(j)$。转移概率给定为 $1/2$。将这些代入方程可得：\n$$h(i) = h(i+1) \\cdot \\frac{1}{2} + h(i-1) \\cdot \\frac{1}{2}$$\n该方程对所有内部状态 $i \\in \\{1, \\dots, N-1\\}$ 成立。整理后，我们得到二阶线性齐次差分方程：\n$$h(i+1) - 2h(i) + h(i-1) = 0$$\n接下来，我们建立 $h(i)$ 在 $i=0$ 和 $i=N$ 处的边界条件。\n如果游走从 $i=0$ 开始，那么 $X_0=0$。由于 $0$ 是一个吸收态，过程将永远停留在 $0$。击中 $0$ 的时间是 $T_0 = \\inf\\{n \\ge 0: X_n=0\\} = 0$。由于 $N \\ge 2$，所以 $N \\ne 0$，因此过程在时间 $0$ 不在 $N$ 处，这意味着 $T_N > 0$。因此，事件 $T_N  T_0$ 是不可能的。其概率为零：\n$$h(0) = 0$$\n如果游走从 $i=N$ 开始，那么 $X_0=N$。由于 $N$ 是一个吸收态，过程将停留在 $N$。击中 $N$ 的时间是 $T_N=0$。由于 $i=N \\ne 0$，击中 $0$ 的时间必然是 $T_0 > 0$。事件 $T_N  T_0$ 是必然发生的。其概率为一：\n$$h(N) = 1$$\n因此，我们得到了一个边值问题，它由 $i \\in \\{1, \\dots, N-1\\}$ 的差分方程和两个边界条件组成。\n\n2. 求解边值问题。\n\n差分方程 $h(i+1) - 2h(i) + h(i-1) = 0$ 可以改写为 $h(i+1) - h(i) = h(i) - h(i-1)$。这表明 $h(i)$ 的连续值之差是恒定的。这是等差数列的定义性质。因此，$h(i)$ 的通解必须是 $i$ 的线性函数：\n$$h(i) = Ai + B$$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n使用在 $i=0$ 处的条件：\n$$h(0) = A \\cdot 0 + B = 0 \\implies B=0$$\n使用在 $i=N$ 处的条件：\n$$h(N) = A \\cdot N + B = 1$$\n将 $B=0$ 代入第二个方程得到：\n$$A \\cdot N = 1 \\implies A = \\frac{1}{N}$$\n因此，$h(i)$ 的显式表达式为：\n$$h(i) = \\frac{i}{N}$$\n\n3. 唯一性的证明。\n\n为了证明 $h(i) = i/N$ 是该边值问题的唯一解，我们采用离散最大值原理的论证。方程 $h(i) = \\frac{1}{2}h(i+1) + \\frac{1}{2}h(i-1)$ 意味着 $h$ 是在内部点集 $\\{1, \\dots, N-1\\}$ 上的离散调和函数。\n设 $u(i)$ 是在 $\\{0, 1, \\dots, N\\}$ 上满足相同边值问题的任意函数：\n$$u(i) = \\frac{1}{2}u(i+1) + \\frac{1}{2}u(i-1) \\quad \\text{for } i \\in \\{1, \\dots, N-1\\}$$\n$$u(0) = 0, \\quad u(N) = 1$$\n定义差函数 $v(i) = h(i) - u(i) = \\frac{i}{N} - u(i)$。我们将证明对所有 $i$，$v(i) = 0$。\n函数 $v(i)$ 在内部点上也是调和的，因为它是两个调和函数的线性组合：\n$$v(i) = h(i) - u(i) = \\frac{1}{2}(h(i+1)+h(i-1)) - \\frac{1}{2}(u(i+1)+u(i-1)) = \\frac{1}{2}(v(i+1)+v(i-1))$$\n$v(i)$ 的边界值为：\n$$v(0) = h(0) - u(0) = 0 - 0 = 0$$\n$$v(N) = h(N) - u(N) = 1 - 1 = 0$$\n根据有限域上调和函数的离散最大值原理，$v(i)$ 的最大值必须在定义域的边界，即集合 $\\{0, N\\}$ 上达到。设 $M = \\max_{i \\in \\{0, \\dots, N\\}} v(i)$。那么：\n$$M = \\max\\{v(0), v(N)\\} = \\max\\{0, 0\\} = 0$$\n这意味着对所有 $i \\in \\{0, \\dots, N\\}$，$v(i) \\le 0$。\n类似地，离散最小值原理指出 $v(i)$ 的最小值也必须在边界上达到。设 $m = \\min_{i \\in \\{0, \\dots, N\\}} v(i)$。那么：\n$$m = \\min\\{v(0), v(N)\\} = \\min\\{0, 0\\} = 0$$\n这意味着对所有 $i \\in \\{0, \\dots, N\\}$，$v(i) \\ge 0$。\n由于对所有 $i$ 我们都有 $v(i) \\le 0$ 和 $v(i) \\ge 0$，那么必然有对所有 $i$，$v(i)=0$。因此，$h(i) - u(i) = 0$，这意味着对所有 $i \\in \\{0, \\dots, N\\}$，$u(i)=h(i)$。这证明了解 $h(i) = i/N$ 是唯一的。", "answer": "$$\\boxed{\\frac{i}{N}}$$", "id": "3056065"}, {"introduction": "知道了获胜的概率后，一个自然而然的问题是：这场赌局预期会持续多久？这个问题将引导你计算在任一方被吸收（即赌局结束）之前，随机游走所花费的平均时间。你会发现，虽然求解方法与前一个练习类似，但它会引出一个非齐次差分方程，让你掌握处理这类问题的技巧。[@problem_id:3056089]", "problem": "考虑在有限状态空间 $\\{0,1,\\dots,N\\}$ 上的一个简单对称随机游走，其在 $0$ 和 $N$ 处有吸收壁。设 $\\{X_{n}\\}_{n\\geq 0}$ 表示赌徒在第 $n$ 步的资本，初始资本为 $X_{0}=i$，其中 $i\\in\\{1,2,\\dots,N-1\\}$。在每一步，赌徒的资本以相等的概率 $1/2$ 增加 $+1$ 或减少 $-1$，且每一步都与过去独立。定义停时 $\\tau=\\inf\\{n\\geq 0: X_{n}\\in\\{0,N\\}\\}$，即首次到达吸收集 $\\{0,N\\}$ 的时间。\n\n仅使用离散时间马尔可夫链的基本原理和首步分析法，推导函数 $u(i)=\\mathbb{E}_{i}[\\tau]$（其中 $i\\in\\{0,1,\\dots,N\\}$）所满足的边值问题，并求解该问题以获得 $u(i)$ 关于 $i$ 和 $N$ 的闭式表达式。将最终答案表示为单个无单位的解析表达式。无需四舍五入。", "solution": "所述问题是有效的。这是一个来自随机过程领域的适定的、有科学依据的问题，具体涉及离散时间马尔可夫链。所有必要信息均已提供，没有矛盾或歧义。我们可以开始求解。\n\n设 $u(i) = \\mathbb{E}_{i}[\\tau]$ 为从状态 $i \\in \\{0, 1, \\dots, N\\}$ 开始，到达吸收态的期望时间。该过程从 $X_0 = i$ 开始。停时为 $\\tau = \\inf\\{n \\geq 0: X_n \\in \\{0, N\\}\\}$。\n\n首先，我们确定函数 $u(i)$ 的边界条件。\n如果过程从 $i=0$ 开始，它已经处于一个吸收态。吸收时间为 $\\tau=0$。因此，期望时间为 $u(0) = \\mathbb{E}_{0}[\\tau] = 0$。\n类似地，如果过程从 $i=N$ 开始，它也处于一个吸收态，所以吸收时间为 $\\tau=0$。期望时间为 $u(N) = \\mathbb{E}_{N}[\\tau] = 0$。\n\n接下来，对于任意内部状态 $i \\in \\{1, 2, \\dots, N-1\\}$，我们应用首步分析原理，也称为对第一步进行条件化。期望时间 $u(i)$ 可以表示为一步的时间，加上从该步之后达到的状态开始的未来期望时间。\n经过一步（耗时 $1$ 个单位时间），过程从状态 $i$ 以概率 $p=1/2$ 移动到状态 $i+1$，或以概率 $q=1/2$ 移动到状态 $i-1$。\n根据全期望公式，我们可以写出：\n$$u(i) = 1 + \\mathbb{E}[\\text{time from next state } | X_0=i]$$\n$$u(i) = 1 + \\frac{1}{2} u(i+1) + \\frac{1}{2} u(i-1)$$\n该方程对所有 $i \\in \\{1, 2, \\dots, N-1\\}$ 成立。\n\n现在我们已经建立了一个边值问题，它由一个二阶线性非齐次差分方程及其相关的边界条件组成：\n$$u(i+1) + u(i-1) - 2u(i) = -2, \\quad \\text{for } i \\in \\{1, 2, \\dots, N-1\\}$$\n$$u(0) = 0$$\n$$u(N) = 0$$\n通解 $u(i)$ 是齐次方程的解 $u_h(i)$ 和一个特解 $u_p(i)$ 的和。\n\n齐次方程为：\n$$u_h(i+1) - 2u_h(i) + u_h(i-1) = 0$$\n我们寻找形如 $u_h(i) = r^i$ 的解。将其代入方程得到特征方程：\n$$r^{i+1} - 2r^i + r^{i-1} = 0$$\n假设 $r \\neq 0$，我们可以除以 $r^{i-1}$ 得到：\n$$r^2 - 2r + 1 = 0$$\n$$(r-1)^2 = 0$$\n该方程有一个重根 $r_1 = r_2 = 1$。对于重根，两个线性无关的解是 $r^i = 1^i = 1$ 和 $i \\cdot r^i = i \\cdot 1^i = i$。因此，齐次方程的通解是这两个解的线性组合：\n$$u_h(i) = A \\cdot 1 + B \\cdot i = A + Bi$$\n其中 $A$ 和 $B$ 是常数。\n\n接下来，我们求非齐次方程 $u(i+1) - 2u(i) + u(i-1) = -2$ 的一个特解 $u_p(i)$。由于非齐次项是一个常数，我们通常会猜测一个关于 $i$ 的多项式。因为常数项和线性项（$A$ 和 $Bi$）是齐次方程的解，我们必须尝试一个更高阶的多项式。我们假设一个二次形式 $u_p(i) = Ci^2$。\n将其代入非齐次方程：\n$$C(i+1)^2 - 2C(i)^2 + C(i-1)^2 = -2$$\n$$C(i^2 + 2i + 1) - 2Ci^2 + C(i^2 - 2i + 1) = -2$$\n$$C(i^2 + 2i + 1 - 2i^2 + i^2 - 2i + 1) = -2$$\n合并同类项：\n$$C[(i^2 - 2i^2 + i^2) + (2i - 2i) + (1 + 1)] = -2$$\n$$C[0 + 0 + 2] = -2$$\n$$2C = -2 \\implies C = -1$$\n因此，一个特解是 $u_p(i) = -i^2$。\n\n通解是齐次解与特解之和：\n$$u(i) = u_h(i) + u_p(i) = A + Bi - i^2$$\n\n最后，我们使用边界条件来确定常数 $A$ 和 $B$。\n使用 $u(0) = 0$：\n$$u(0) = A + B(0) - (0)^2 = 0 \\implies A = 0$$\n解简化为 $u(i) = Bi - i^2$。\n现在，使用 $u(N) = 0$：\n$$u(N) = BN - N^2 = 0$$\n假设 $N \\neq 0$（这是非平凡状态空间的要求），我们有：\n$$BN = N^2 \\implies B = N$$\n\n将 $A=0$ 和 $B=N$ 的值代入通解，得到期望到达时间的唯一解：\n$$u(i) = Ni - i^2$$\n这可以因式分解为：\n$$u(i) = i(N-i)$$\n该表达式给出了从状态 $i$ 开始，到达状态 $0$ 或状态 $N$ 所需的期望步数。", "answer": "$$\n\\boxed{i(N-i)}\n$$", "id": "3056089"}, {"introduction": "现实世界中的过程很少是完全“公平”的。这个练习将我们的分析从对称随机游走（$p = \\frac{1}{2}$）扩展到更普遍的非对称情况（$p \\neq \\frac{1}{2}$）。通过一个关于初创公司融资的生动案例，你将定量地分析一个微小的市场偏好如何显著地改变一家公司的破产风险，从而深刻理解“不公平”游戏中的动态。[@problem_id:1398204]", "problem": "两家相互竞争的科技初创公司 Alpha 和 Beta 正在寻求获得融资。这个过程可以被建模为一系列离散的回合。在每一回合中，一家初创公司的资本要么增加要么减少一个固定的金额，$\\Delta C = \\$100,000$。两家公司都以 $C_0 = \\$200,000$ 的初始资本开始，并旨在达到 $C_f = \\$1,000,000$ 的目标融资水平。如果一家公司的资本降至零，它就被视为破产并退出市场。\n\n初创公司 Alpha 在一个“中性”市场环境中运营，其在任何一回合中获得 $\\Delta C$ 的概率为 $p_A = 1/2$。然而，初创公司 Beta 面临一个更具“挑战性”的市场，其在一回合中获得 $\\Delta C$ 的概率仅为 $p_B = 1/3$。\n\n计算初创公司 Beta 的破产概率与初创公司 Alpha 的破产概率之比。将您的答案表示为最简精确分数形式。", "solution": "设一回合使资本变化 $\\Delta C$。定义步长 $s=\\Delta C$ 并以 $s$ 为单位来衡量资本。那么，吸收边界位于 $0$ 和 $N$ 处，其中\n$$\nN=\\frac{C_{f}}{s}=\\frac{1{,}000{,}000}{100{,}000}=10,\n$$\n初始状态为\n$$\ni=\\frac{C_{0}}{s}=\\frac{200{,}000}{100{,}000}=2.\n$$\n\n对于一个在 $0$ 和 $N$ 处有吸收态的一维随机游走，设 $u_{i}$ 为从状态 $i$ 开始的破产概率（在到达 $N$ 之前到达 $0$）。其标准差分方程为\n$$\nu_{i}=q\\,u_{i-1}+p\\,u_{i+1}, \\quad 1\\leq i\\leq N-1,\n$$\n边界条件为 $u_{0}=1$ 和 $u_{N}=0$，其中 $p$ 是向上一步的概率，而 $q=1-p$ 是向下移动一步的概率。\n\n初创公司 Alpha（中性市场）有 $p_{A}=\\frac{1}{2}$ 和 $q_{A}=\\frac{1}{2}$。差分方程变为\n$$\nu_{i}=\\frac{1}{2}u_{i-1}+\\frac{1}{2}u_{i+1},\n$$\n整理后得到 $u_{i+1}-2u_{i}+u_{i-1}=0$。通解是线性的，$u_{i}=A+Bi$。应用 $u_{0}=1$ 得到 $A=1$，而 $u_{N}=0$ 得到 $1+BN=0$，所以 $B=-\\frac{1}{N}$。因此，\n$$\nu_{i}^{(A)}=1-\\frac{i}{N}.\n$$\n代入 $i=2$ 和 $N=10$，\n$$\nu_{2}^{(A)}=1-\\frac{2}{10}=\\frac{8}{10}=\\frac{4}{5}.\n$$\n\n初创公司 Beta（挑战性市场）有 $p_{B}=\\frac{1}{3}$ 和 $q_{B}=\\frac{2}{3}$。差分方程为\n$$\nu_{i}=q_{B}\\,u_{i-1}+p_{B}\\,u_{i+1},\n$$\n或者等价地 $p_{B}u_{i+1}-u_{i}+q_{B}u_{i-1}=0$。寻求 $u_{i}=r^{i}$ 形式的解，可得到特征方程\n$$\np_{B}r^{2}-r+q_{B}=0.\n$$\n其根为 $r=1$ 和 $r=\\frac{q_{B}}{p_{B}}$。因此通解为\n$$\nu_{i}=A+B\\left(\\frac{q_{B}}{p_{B}}\\right)^{i}.\n$$\n应用 $u_{0}=1$ 和 $u_{N}=0$：\n$$\nA+B=1,\\quad A+B\\left(\\frac{q_{B}}{p_{B}}\\right)^{N}=0.\n$$\n解出 $A,B$ 可得\n$$\nu_{i}^{(B)}=\\frac{\\left(\\frac{q_{B}}{p_{B}}\\right)^{i}-\\left(\\frac{q_{B}}{p_{B}}\\right)^{N}}{1-\\left(\\frac{q_{B}}{p_{B}}\\right)^{N}}.\n$$\n当 $p_{B}=\\frac{1}{3}$，$q_{B}=\\frac{2}{3}$ 时，我们有 $\\frac{q_{B}}{p_{B}}=2$，因此对于 $i=2$，$N=10$，\n$$\nu_{2}^{(B)}=\\frac{2^{2}-2^{10}}{1-2^{10}}=\\frac{4-1024}{1-1024}=\\frac{-1020}{-1023}=\\frac{1020}{1023}=\\frac{340}{341}.\n$$\n\n所求的破产概率之比为\n$$\n\\frac{u_{2}^{(B)}}{u_{2}^{(A)}}=\\frac{\\frac{340}{341}}{\\frac{4}{5}}=\\frac{340}{341}\\cdot\\frac{5}{4}=\\frac{1700}{1364}=\\frac{425}{341}.\n$$", "answer": "$$\\boxed{\\frac{425}{341}}$$", "id": "1398204"}]}