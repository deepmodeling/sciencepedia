{"hands_on_practices": [{"introduction": "要真正理解一个算法的精髓，最好的方法之一就是将其与其他算法进行比较。这个练习通过一个具体的例子，将 Borůvka 算法的“局部并行”选择与 Kruskal 算法的“全局最优”选择进行对比 [@problem_id:1484776]。通过分析在特定的平局决胜规则下两个算法的第一步操作，你将能清晰地看到它们在决策机制上的根本差异，从而更好地把握 Borůvka 算法的核心思想。", "problem": "一家科技初创公司正计划建立一个小型专用网络，以连接其四个主要服务器，标记为 A、B、C 和 D。在任意两个服务器之间建立直接高速链路的成本已经计算出来。该网络必须是连通的，即任意两个服务器之间都存在路径，并且链路的总成本必须最小化。这是一个经典的最小生成树（MST）问题。由服务器（顶点）和可能的链路（带权边）组成的图定义如下：\n\n-   顶点：`{A, B, C, D}`\n-   边和成本：\n    -   (A, C)，成本为 10 单位。\n    -   (B, D)，成本为 10 单位。\n    -   (C, D)，成本为 10 单位。\n    -   (A, B)，成本为 20 单位。\n\n为了构建最小生成树，考虑了两种算法：Kruskal 算法和 Borůvka 算法。为了确保每种算法都能得到唯一的解，规定了以下确定性的平局打破规则：\n\n1.  **Kruskal 算法的平局打破规则：** 当多条边具有相同的最小成本时，算法必须处理其规范表示 `(U, V)`（其中标签 `U` 的字典序小于 `V`）在字典序（字母顺序）中排在**最后**的边。\n2.  **Borůvka 算法的平局打破规则：** 在一次迭代中，如果一个连通分量有多条连接到外部连通分量的成本最低的边，算法必须选择连接到字典序**最小**的顶点的边。\n\n以下哪个选项正确地指出了 Kruskal 算法选择的第一条边，以及 Borůvka 算法第一次迭代中选择的所有唯一边的集合？\n\nA. Kruskal 算法选择的第一条边：`(A, C)`；Borůvka 算法第一次迭代选择的边集：`{ (A, C), (B, D), (C, D) }`\n\nB. Kruskal 算法选择的第一条边：`(C, D)`；Borůvka 算法第一次迭代选择的边集：`{ (A, C), (B, D) }`\n\nC. Kruskal 算法选择的第一条边：`(A, C)`；Borůvka 算法第一次迭代选择的边集：`{ (A, C), (B, D) }`\n\nD. Kruskal 算法选择的第一条边：`(C, D)`；Borůvka 算法第一次迭代选择的边集：`{ (C, A), (D, B), (C, D) }`\n\nE. Kruskal 算法选择的第一条边：`(B, D)`；Borůvka 算法第一次迭代选择的边集：`{ (A, C), (B, D) }`", "solution": "我们将该网络建模为一个带权无向图，其顶点集为 $\\{A,B,C,D\\}$，边的成本如下：$(A,C)$、$(B,D)$、$(C,D)$ 的成本均为 $10$，$(A,B)$ 的成本为 $20$。我们的目标是找到一个最小生成树（MST）。\n\n**分析 Kruskal 算法：**\nKruskal 算法首先对所有边按权重升序排序。成本最低的边是 $(A, C)$, $(B, D)$, 和 $(C, D)$，它们的成本都是 10。\n为了打破平局，算法必须处理其规范表示 `(U, V)`（其中标签 `U` 的字典序小于 `V`）在字典序中排在**最后**的边。\n规范表示为：`(A, C)`, `(B, D)`, `(C, D)`。\n按字典序排列为：`(A, C)`  `(B, D)`  `(C, D)`。\n排在最后的是 `(C, D)`。因此，Kruskal 算法选择的第一条边是 **(C, D)**。\n\n**分析 Borůvka 算法（第一次迭代）：**\n算法开始时，每个顶点 `{A}`, `{B}`, `{C}`, `{D}` 都是一个独立的连通分量。算法为每个分量寻找权重最小的出口边。\n-   对于分量 `{A}`：权重最小的边是 `(A, C)`，成本为 10。\n-   对于分量 `{B}`：权重最小的边是 `(B, D)`，成本为 10。\n-   对于分量 `{C}`：有两条成本最低的边 `(C, A)` 和 `(C, D)`，成本都为 10。平局打破规则要求选择连接到字典序**最小**的顶点的边。比较 'A' 和 'D'，'A' 字典序更小。因此，分量 `{C}` 选择边 `(C, A)`。\n-   对于分量 `{D}`：有两条成本最低的边 `(D, B)` 和 `(D, C)`，成本都为 10。比较 'B' 和 'C'，'B' 字典序更小。因此，分量 `{D}` 选择边 `(D, B)`。\n\n在第一次迭代中，所有被选中的边是 `{ (A, C), (B, D), (C, A), (D, B) }`。\n取唯一的边集合，我们得到 **`{ (A, C), (B, D) }`**。\n\n**结论：**\nKruskal 算法选择的第一条边是 `(C, D)`，Borůvka 算法第一次迭代选择的边集是 `{ (A, C), (B, D) }`。这与选项 B 相符。", "answer": "$$\\boxed{B}$$", "id": "1484776"}, {"introduction": "在理解了 Borůvka 算法的基本步骤之后，下一步是完整地追踪其从头到尾的执行过程。这个问题 [@problem_id:1484797] 提供了一个精心设计的假设图结构，旨在系统地展示连通分量是如何在多轮迭代中逐步合并的。通过追踪这些合并过程并累加所选边的权重，你将能对该算法的迭代机制及其如何最终构建出最小生成树获得一个深入的、程序性的理解。", "problem": "考虑一个特殊的无向加权图，我们称之为“层次化连接星形图”（Hierarchically Connected Star Graph）。该图由一个参数 $n$ 定义，其中 $n = 2^k + 1$，对于某个正整数 $k$。该图有 $n$ 个顶点，标记为 $v_0, v_1, \\ldots, v_{n-1}$。\n\n边及其对应的权重定义如下：\n\n1.  **中心连接：**对于每个 $i \\in \\{1, 2, \\ldots, n-1\\}$，有一条连接中心顶点 $v_0$ 与外围顶点 $v_i$ 的边。这些边的权重均为 $W = n-1$。\n\n2.  **外围连接：**对于每个 $i \\in \\{1, 2, \\ldots, n-2\\}$，有一条连接顶点 $v_i$ 与 $v_{i+1}$ 的边。边 $(v_i, v_{i+1})$ 的权重由公式 $w(v_i, v_{i+1}) = 2^p$ 给出，其中 $p$ 是使得 $i$ 能被 $2^p$ 整除的最大非负整数。\n\n假设在该图上执行 Borůvka 算法以找到一个最小生成树（MST）。在有多条边具有相同最小权重的情况下，算法通过选择连接到最小索引顶点的边来打破平局。\n\n确定最终得到的最小生成树的总权重。请用一个关于 $n$ 的封闭形式解析表达式来表示你的答案。", "solution": "问题要求计算在一个特定图上通过 Borůvka 算法找到的最小生成树（MST）的总权重。该图有 $n$ 个顶点，$v_0, v_1, \\ldots, v_{n-1}$，其中 $n = 2^k + 1$，$k \\ge 1$ 为某个整数。令 $N = n-1 = 2^k$。\n\n权重如下：\n-   $w(v_0, v_i) = N$，对于 $i=1, \\ldots, N$。\n-   $w(v_i, v_{i+1}) = 2^p$，对于 $i=1, \\ldots, N-1$，其中 $p$ 是使得 $i$ 能被 $2^p$ 整除的最大整数。\n\nBorůvka 算法是迭代进行的。在每次迭代中，每个连通分量找到其权重最小的出边，所有这些边都被添加到最小生成树森林中。\n\n**初始状态：**\n算法开始时有 $n$ 个连通分量，每个顶点自成一个分量：$C_0=\\{v_0\\}, C_1=\\{v_1\\}, \\ldots, C_{N}=\\{v_{n-1}\\}$。\n\n**第 1 次迭代：**\n我们为每个连通分量找到权重最小的出边。\n-   对于分量 $C_0=\\{v_0\\}$：出边为 $(v_0, v_i)$，$i=1, \\ldots, N$，所有边的权重均为 $N=2^k$。根据打破平局的规则，选择 $(v_0, v_1)$。\n-   对于任意外围分量 $C_i=\\{v_i\\}$，$i \\in \\{1, \\ldots, N\\}$：出边是 $(v_i, v_0)$（权重为 $N$）以及可能的 $(v_i, v_{i-1})$ 和 $(v_i, v_{i+1})$。这些外围连接边的权重为 $w(v_{i-1},v_i) = 2^{p(i-1)}$ 和 $w(v_i,v_{i+1}) = 2^{p(i)}$。外围边的最小可能权重对应于 $p=0$，此时权重为 $2^0=1$。这种情况发生在索引 $i$ 或 $i-1$ 为奇数时。由于 $k \\ge 1$，$N=2^k \\ge 2$，所以任何权重为 1 的外围边都比任何中心连接边更便宜。\n-   我们来分析权重为 1 的外围边。这些是 $(v_i, v_{i+1})$，其中 $p(i)=0$，即 $i$ 是奇数。因此，边 $(v_1, v_2), (v_3, v_4), \\ldots, (v_{N-1}, v_N)$ 的权重都为 1。\n-   对于一个奇数索引的分量 $C_i$：其最便宜的边是 $(v_i, v_{i+1})$，权重为 1。\n-   对于一个偶数索引的分量 $C_i$：其最便宜的边是 $(v_i, v_{i-1})$，权重为 1。\n-   结果是，通过添加权重为 1 的边，形成了分量 $\\{v_1, v_2\\}$, $\\{v_3, v_4\\}$, ..., $\\{v_{N-1}, v_N\\}$。这样的边有 $N/2$ 条。中心分量 $C_0$ 保持独立，因为它选择的边 $(v_0,v_1)$ 权重为 $N$，而 $C_1$ 找到了更便宜的边，所以 $(v_0,v_1)$ 尚未被添加。\n-   第 1 次迭代后，我们有 $N/2$ 个大小为 2 的分量，以及孤立的分量 $C_0$。总分量数：$N/2+1$。\n-   第 1 次迭代增加的权重：$\\frac{N}{2} \\times 1 = \\frac{N}{2}$。\n\n**第 2 次迭代：**\n-   现在的分量形式为 $C'_{j} = \\{v_{2j-1}, v_{2j}\\}$，$j=1, \\ldots, N/2$。\n-   这样一个分量的最便宜出边将把它连接到相邻的分量 $C'_{j-1}$ 或 $C'_{j+1}$。连接边是 $(v_{2j-2}, v_{2j-1})$ 和 $(v_{2j}, v_{2j+1})$。\n-   边 $(v_{2j}, v_{2j+1})$ 的索引为 $i=2j$，因此 $p(2j) \\ge 1$。最小的非零 $p(i)$ 是 1，所以下一级的边权重是 $2^1=2$。这种情况发生在边 $(v_2, v_3), (v_6, v_7), \\ldots$ 上。然而，连接我们两个新分量的边，例如 $(v_2, v_3)$，它连接了 $\\{v_1,v_2\\}$ 和 $\\{v_3,v_4\\}$。其索引为 $i=2$，所以 $p(2)=1$，权重为 $2^1=2$。\n-   一般来说，离开分量 $\\{v_{2j-1}, v_{2j}\\}$ 的最便宜的边将是 $(v_{2j-2}, v_{2j-1})$ 或 $(v_{2j}, v_{2j+1})$。索引 $2j-2$ 和 $2j$ 都是偶数。权重最低的将被选中。权重分别是 $w(v_{2j-2}, v_{2j-1}) = 2^{p(2j-2)}$ 和 $w(v_{2j}, v_{2j+1}) = 2^{p(2j)}$。其中一个的 $p$ 将为 1，得到权重 2。只要 $k \\ge 2$，这个权重就比任何中心连接（权重 $N=2^k$）都要便宜。\n-   大小为 2 的分量合并成大小为 4 的分量。例如，$\\{v_1, v_2\\}$ 和 $\\{v_3, v_4\\}$ 通过权重为 $2^{p(2)}=2$ 的边 $(v_2, v_3)$ 合并。这样的合并边有 $N/4$ 条。\n-   第 2 次迭代后，我们有 $N/4$ 个大小为 4 的分量，以及 $C_0$。总分量数：$N/4+1$。\n-   第 2 次迭代增加的权重：$\\frac{N}{4} \\times 2 = \\frac{N}{2}$。\n\n**第 $m$ 次迭代（$1 \\le m \\le k$）：**\n-   在第 $m$ 次迭代开始时，我们有 $N/2^{m-1}$ 个大小为 $2^{m-1}$ 的分量（以及 $C_0$）。\n-   连接两个这样的分量（例如 $\\{v_1, \\ldots, v_{2^{m-1}}\\}$ 和 $\\{v_{2^{m-1}+1}, \\ldots, v_{2^m}\\}$）的最便宜的边是 $(v_{2^{m-1}}, v_{2^{m-1}+1})$。\n-   索引是 $i=2^{m-1}$，所以 $p(i) = m-1$。这条边的权重是 $2^{m-1}$。\n-   对于 $m-1  k$（即 $m \\le k$），这个权重小于中心连接权重 $N=2^k$。\n-   大小为 $2^{m-1}$ 的分量合并成大小为 $2^m$ 的分量。这样的合并有 $\\frac{N/2^{m-1}}{2} = N/2^m$ 次。\n-   第 $m$ 次迭代增加的权重：$\\frac{N}{2^m} \\times 2^{m-1} = \\frac{N}{2}$。\n\n**第 $k$ 次迭代后：**\n-   所有外围顶点 $v_1, \\ldots, v_N$ 都已合并成一个大的连通分量 $C_{path} = \\{v_1, \\ldots, v_N\\}$。\n-   现在的总分量数是 2：$C_0$ 和 $C_{path}$。\n-   从第 1 次到第 $k$ 次迭代目前为止增加的总权重是 $\\sum_{m=1}^{k} \\frac{N}{2} = k \\times \\frac{N}{2}$。\n\n**最后一次迭代（$k+1$）：**\n-   剩下的两个分量 $C_0=\\{v_0\\}$ 和 $C_{path}=\\{v_1, \\ldots, v_N\\}$ 现在必须连接起来。\n-   从 $C_{path}$ 出发的最便宜的出边是其中一条中心连接边 $(v_i, v_0)$，它们的权重都是 $N$。\n-   类似地，从 $C_0$ 出发的最便宜的出边也是一条中心连接边，权重为 $N$。\n-   算法会添加其中一条边（例如，根据打破平局的规则选择 $(v_0, v_1)$）来连接这两个分量。\n-   第 $k+1$ 次迭代增加的权重：$N$。\n-   算法终止，因为只剩下一个连通分量。\n\n**总权重计算：**\nMST 的总权重是所有迭代中增加的权重之和。\n总权重 = (第 1 到 k 次迭代的权重) + (第 k+1 次迭代的权重)\n总权重 = $\\left(k \\times \\frac{N}{2}\\right) + N$\n\n现在，我们代入 $N = n-1$ 和 $k = \\log_2(N) = \\log_2(n-1)$。\n总权重 = $\\log_2(n-1) \\times \\frac{n-1}{2} + (n-1)$\n\n这可以被因式分解：\n总权重 = $(n-1) \\left(\\frac{\\log_2(n-1)}{2} + 1\\right)$", "answer": "$$\\boxed{(n-1) \\left(\\frac{\\log_{2}(n-1)}{2} + 1\\right)}$$", "id": "1484797"}, {"introduction": "对一个算法的深入理解不仅包括“它如何工作”，还包括“它工作得有多好”。这个练习将你的关注点从算法的执行过程转移到其性能分析上 [@problem_id:1484805]。通过在一个轮图上设计一种“最坏情况”的权重分配方案来最大化 Borůvka 算法的迭代次数，你将能亲手揭示该算法迭代次数的对数级复杂度。这不仅是一个有趣的理论挑战，更能让你领会到 Borůvka 算法在并行计算中为何如此高效的根本原因。", "problem": "Borůvka 算法是在一个具有不同边权重的连通无向图中寻找最小生成树 (MST) 的一种方法。该算法迭代进行。它开始时将图的每个顶点视为一个独立的连通分量，形成一个连通分量森林。在每次迭代中，每个连通分量会找出连接其某个顶点到*另一个不同*连通分量中某个顶点的最小权重边。所有这些最小权重边随后被添加到 MST 森林中。随着边的添加，连通分量会合并。当只剩下一个连通分量，即 MST 本身时，算法终止。\n\n考虑一个轮图，记为 $W_n$，其中 $n \\ge 3$。该图由一个中心“毂”顶点（我们称之为 $v_0$）和一组 $n-1$ 个“轮辐”顶点 $v_1, v_2, \\ldots, v_{n-1}$ 组成。轮辐顶点连接形成一个环图 $C_{n-1}$，意味着对于 $i=1, \\ldots, n-2$，$v_i$ 和 $v_{i+1}$ 之间存在边，并且 $v_{n-1}$ 和 $v_1$ 之间也存在边。此外，中心毂顶点 $v_0$ 通过“辐条”边连接到每个轮辐顶点 $v_i$（其中 $i=1, \\ldots, n-1$）。\n\n你的任务是分析 Borůvka 算法在这种图上的最坏情况性能。设计一个为 $W_n$ 的边分配唯一正整数权重的通用策略，以最大化 Borůvka 算法必须执行的迭代次数。\n\nBorůvka 算法寻找轮图 $W_n$ 的 MST 所需的最大可能迭代次数是多少，表示为 $n$ 的函数？", "solution": "设 $W_n$ 有一个中心毂顶点 $v_0$ 和 $n-1$ 个轮辐顶点 $v_1, \\ldots, v_{n-1}$ 连接成一个环。Borůvka 算法分阶段进行；在一个有 $c$ 个连通分量的阶段开始时，每个连通分量选择其最轻的出边，所有这些边都被加入，然后将形成的连通部分进行收缩。\n\n关键的一般事实（用于上界）：在任何阶段，如果当前的连通分量数为 $c$，则该阶段后的连通分量数最多为\n$$\n\\left\\lfloor \\frac{c}{2} \\right\\rfloor\n$$\n原因：将每个连通分量选择的边定向向外。在该有向图中，每个弱连通分量至少包含两个原始连通分量（因为每个节点出度为1，且没有选择的边是自环），因此生成的连通分量数量最多为 $\\lfloor c/2 \\rfloor$。\n\n因此，经过 $t$ 个阶段后，\n$$\nc_{t} \\le \\left\\lfloor \\frac{n}{2^{t}} \\right\\rfloor\n$$\n为了在达到单个连通分量之前强制实现最大可能的阶段数，我们希望每一步都取等号，即 $c_{i+1}=\\lfloor c_{i}/2 \\rfloor$。如果从 $c_0=n$ 开始的所有阶段都能实现这一点，那么算法在\n$$\n\\left\\lfloor \\frac{n}{2^{t}} \\right\\rfloor = 1\n$$\n时终止，这等价于 $1 \\le \\frac{n}{2^{t}}  2$，即 $2^{t} \\le n  2^{t+1}$。因此，最大可能的阶段数是\n$$\nt = \\left\\lfloor \\log_{2} n \\right\\rfloor\n$$\n\n我们现在给出一个 $W_n$ 的权重分配策略，该策略在每个阶段都能实现 $c_{i+1}=\\lfloor c_{i}/2 \\rfloor$。\n\n权重分配策略（唯一的正整数，每个阶段严格分离成“权重带”）：\n1) 将初始环上的轮辐边划分为两个沿环交替的集合。给其中一个集合（称之为“第1级边”）分配严格递增的小整数权重，这些权重都小于任何其他边的权重。给所有辐条边和其他轮辐边分配严格更大的整数权重，使得对于每个轮辐顶点，其权重最小的关联边是其指定的第1级轮辐边（而不是辐条边）。同时，选择中心毂顶点最轻的辐条边，使其权重大于所有第1级边（这样不会干扰轮辐顶点的选择），但轻于其他辐条边，从而中心毂顶点恰好选择一条辐条边。\n\n步骤1的结果：沿着轮辐，每条被选中的第1级轮辐边都被其两个端点选中，形成不相交的轮辐顶点对；如果轮辐的顶点数为奇数，则恰好有一个轮辐顶点未被匹配。中心毂顶点选择一条辐条边。计算此阶段后的连通分量数：\n- 如果当前连通分量数 $c$ 是偶数（轮辐顶点数为奇数），中心毂顶点选择的唯一辐条边会连接到那个唯一的未匹配轮辐连通分量，因此 $c$ 减半：$c_{1} = c/2$。\n- 如果 $c$ 是奇数（轮辐顶点数为偶数），中心毂顶点的辐条边会连接到一个新形成的轮辐对上，形成一个大小为3的连通分量，而其余的轮辐对是独立的；同样有 $c_{1} = (c-1)/2 = \\lfloor c/2 \\rfloor$。\n\n因此，在这两种情况下都有 $c_{1}=\\lfloor \\frac{n}{2} \\rfloor$。\n\n2) 归纳延续：收缩后，连通分量图再次成为一个轮图：一个中心毂连通分量和一个由 $c_1-1$ 个连通分量组成的轮辐环。预先分配剩余的（尚未选择的）轮辐边的权重，使得在“第2级”上，一个交替的轮辐边子集的权重严格大于所有第1级权重，但严格小于任何其他与轮辐连通分量关联的剩余边的权重。确保每个轮辐连通分量的两条辐条边（连接到中心毂连通分量）比其指定的第2级轮辐边更重，而在中心毂的辐条边中，有一条是该权重带中最小的，以便中心毂恰好选择一条辐条边。这迫使第2级的轮辐连通分量表现出相同的配对行为，得到\n$$\nc_{2}=\\left\\lfloor \\frac{c_{1}}{2} \\right\\rfloor\n$$\n\n3) 对第 $3, 4, \\ldots$ 级重复这种分层分配，使得在第 $j$ 级，指定的轮辐边的权重都在一个权重带内，该权重带严格高于所有先前级别的权重，并严格低于在该级别必须避免的任何边的权重。通过在每个权重带内选择不同的整数来保证权重的唯一性。这确保了在每个阶段 $i$，选择模式完全相同：轮辐连通分量沿环配对；中心毂连通分量恰好选择一条辐条边；并且连通分量数量满足等式\n$$\nc_{i+1}=\\left\\lfloor \\frac{c_{i}}{2} \\right\\rfloor\n$$\n\n根据归纳法，经过 $t$ 个阶段后，我们有 $c_{t}=\\lfloor \\frac{n}{2^{t}} \\rfloor$，因此直到只剩下一个连通分量为止，Borůvka 算法的最大可能迭代次数是满足 $2^{t} \\le n  2^{t+1}$ 的唯一整数 $t$，即\n$$\n\\left\\lfloor \\log_{2} n \\right\\rfloor\n$$\n\n因此，在轮图 $W_n$ 上，Borůvka 算法的最坏情况（在所有不同正整数权重分配下最大化）迭代次数恰好是 $\\lfloor \\log_{2} n \\rfloor$。", "answer": "$$\\boxed{\\left\\lfloor \\log_{2} n \\right\\rfloor}$$", "id": "1484805"}]}