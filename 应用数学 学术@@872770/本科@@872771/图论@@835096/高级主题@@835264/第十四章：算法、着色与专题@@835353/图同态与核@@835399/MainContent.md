## 引言
在掌握了[图论](@entry_id:140799)的基本构成元素——顶点和边之后，我们自然会进一步探索图与图之间更深层次的关系。仅仅比较顶点数或边数是不够的，我们如何才能形式化地描述一个图在结构上是另一个图的“简化版”或“映像”？[图同态](@entry_id:272314) (Graph Homomorphisms) 和图核 (Graph Cores) 为回答这一问题提供了强大的代数框架。它们使我们能够超越简单的[图同构](@entry_id:143072)，通过结构保持的映射来比较、分类并揭示图的内在本质。

本文旨在系统地介绍[图同态](@entry_id:272314)与图核这一迷人领域。我们将从基本定义出发，逐步揭示其深刻的理论内涵和广泛的应用价值。读者将通过三个精心组织的章节来掌握这些概念：
- 在第一章“原理与机制”中，我们将深入探讨[图同态](@entry_id:272314)和图核的定义、基本性质，以及它们与[图着色](@entry_id:158061)、圈等[基本图](@entry_id:160617)论概念的内在联系，为你构建坚实的理论基础。
- 随后的“应用与交叉学科联系”章节将展示这些抽象概念如何作为一种通用语言，在[约束满足问题](@entry_id:267971)、计算机科学、生物信息学等多个领域中找到实际应用，让你领略其强大的建模能力。
- 最后，通过“动手实践”部分，你将有机会运用所学知识解决一系列引导性问题，从而将理论与实践紧密结合。

让我们一同开始这段探索之旅，去发现隐藏在图的邻接关系背后的代数之美。

## 原理与机制

在介绍图论的基本概念之后，我们现在转向一个更深层次的主题：研究图与图之间的结构保持映射。这些映射，称为**[图同态](@entry_id:272314) (graph homomorphisms)**，使我们能够以一种代数的方式比较和分类图，并揭示其内在的结构属性。通过研究同态，我们将引出**图核 (graph cores)** 的概念，即图在同态意义下的不可约本质。本章将系统地阐述[图同态](@entry_id:272314)和图核的定义、关键性质及其在[图论](@entry_id:140799)问题中的应用。

### [图同态](@entry_id:272314)：结构保持的映射

#### 定义与直观理解

从最根本的层面来说，数学是研究结构及其相互关系的学科。在[图论](@entry_id:140799)中，最自然的结构就是顶点之间的邻接关系。[图同态](@entry_id:272314)正是一种捕捉和保持这种邻接关系的映射。

形式上，对于两个[简单图](@entry_id:274882) $G=(V_G, E_G)$ 和 $H=(V_H, E_H)$，一个从 $G$ 到 $H$ 的**[图同态](@entry_id:272314)**是一个函数 $f: V_G \to V_H$，它将 $G$ 的顶点映射到 $H$ 的顶点，并满足以下条件：对于 $G$ 中的任意一条边 $\{u, v\} \in E_G$，其顶点的像在 $H$ 中也必须是邻接的，即 $\{f(u), f(v)\} \in E_H$。

我们可以直观地将同态想象为将图 $G$ “折叠”或“包裹”到图 $H$ 上的过程。在这个过程中， $G$ 的顶点被放置在 $H$ 的顶点上，并且 $G$ 的每条边都必须落在 $H$ 的一条边上。值得注意的是，如果 $u$ 和 $v$ 是 $G$ 中不同的顶点，它们的像 $f(u)$ 和 $f(v)$ 可以是 $H$ 中相同的顶点。然而，由于我们处理的是简单图（没有环），如果 $\{u,v\}$ 是一条边，那么 $u \ne v$，并且 $\{f(u), f(v)\}$ 必须是 $H$ 中的一条边，这意味着 $f(u) \ne f(v)$。因此，对于简单图之间的同态，**任意一条边都不能被“压扁”成一个顶点**。

#### 同态的基本属性

**复合性 (Composition)**

与数学中许多结构保持映射（如[群同态](@entry_id:140603)、[线性变换](@entry_id:149133)）一样，[图同态](@entry_id:272314)也具有复合性。如果 $f: G \to H$ 和 $g: H \to K$ 都是[图同态](@entry_id:272314)，那么它们的复合函数 $h = g \circ f: G \to K$ 也是一个[图同态](@entry_id:272314)。我们可以验证这一点：任取 $G$ 中的一条边 $\{u, v\}$。因为 $f$ 是同态，所以 $\{f(u), f(v)\}$ 是 $H$ 中的一条边。又因为 $g$ 是同态，所以 $\{g(f(u)), g(f(v))\}$ 是 $K$ 中的一条边。根据[复合函数](@entry_id:147347)的定义，这正是 $\{h(u), h(v)\}$。因此，复合函数 $h$ 保持了邻接性。

例如，考虑从四元环 $C_4$ 到三顶点路径 $P_3$，再到二顶点完全图 $K_2$ 的同态复合。我们可以定义一个从 $C_4$ (顶点为 $v_1, v_2, v_3, v_4$) 到 $P_3$ (顶点为 $a, b, c$，边为 $\{a,b\},\{b,c\}$) 的同态 $f$，通过映射 $v_1 \to a, v_2 \to b, v_3 \to a, v_4 \to b$。同时，定义一个从 $P_3$ 到 $K_2$ (顶点为 $x,y$) 的同态 $g$，通过映射 $a \to x, b \to y, c \to x$。复合映射 $h = g \circ f$ 会将 $C_4$ 的顶点交替地映射到 $x$ 和 $y$ 上，这本身就是一个有效的同态 [@problem_id:1507379]。这个例子表明，同态关系具有[传递性](@entry_id:141148)，这使得我们可以构建一个以图为对象、同态为态射的范畴。

**同态与[图着色](@entry_id:158061) (Homomorphisms and Graph Coloring)**

[图同态](@entry_id:272314)与图着色之间存在着深刻而优美的联系。一个对图 $G$ 的**正常 $k$-着色**可以被视为一个从 $G$ 到 $k$-完全图 $K_k$ 的同态。回忆一下，$k$-着色是将 $G$ 的每个顶点分配到 $k$ 种颜色中的一种，使得相邻顶点颜色不同。如果我们将这 $k$ 种颜色看作 $K_k$ 的 $k$ 个顶点，由于 $K_k$ 中任意两个不同的顶点都是邻接的，那么“相邻顶点颜色不同”的条件恰好等价于“相邻顶点的像在 $K_k$ 中是邻接的”——这正是同态的定义。

这个联系极其有用。例如，我们可以用它来回答是否存在从 $K_n$ 到 $K_m$ 的同态。这样的同态 $f: K_n \to K_m$ 相当于对 $K_n$ 进行 $m$-着色。然而，在 $K_n$ 中，任意两个不同的顶点都相邻，因此任何正常着色都必须为这 $n$ 个顶点分配 $n$ 种不同的颜色。这意味着 $f$ 必须是一个[单射函数](@entry_id:141802)。从一个 $n$ 元集到 $m$ 元集的单射存在的充要条件是 $n \le m$。因此，从 $K_n$ 到 $K_m$ 的同态存在当且仅当 $n \le m$ [@problem_id:1507345]。

这个观点最重要的推论是关于[二分图](@entry_id:262451)的判定。一个图 $G$ 是二分的，当且仅当它可以被2-着色。根据我们刚刚建立的联系，这等价于存在一个从 $G$ 到 $K_2$ 的同态 [@problem_id:1507349]。$K_2$ 是最简单的非平凡图，它只有两个顶点和一条连接它们的边。一个图能同态到 $K_2$，意味着它的顶点集可以被划分为两部分，所有边都跨越这两部分——这正是二分图的定义。因此，像路径图 $P_n$、偶圈 $C_{2k}$ 和[超立方体图](@entry_id:268710) $Q_n$ 这样的二分图都存在到 $K_2$ 的同态。相反，像[奇圈](@entry_id:271287) $C_{2k+1}$ 或著名的 Petersen 图这样包含奇数长度环路的图，则不是二分的，因此不存在到 $K_2$ 的同态。

**同态与圈 (Homomorphisms and Cycles)**

同态如何与图的[圈结构](@entry_id:147026)相互作用，揭示了更深层的约束。一个同态将图 $G$ 中的一条路（walk）映射为图 $H$ 中的一条路。因此，如果存在一个从圈 $C_m$ 到图 $H$ 的同态，那么在 $H$ 中必定存在一个长度为 $m$ 的闭路（closed walk）。

这个简单的观察引出了一个强大的结论：不存在从[奇圈](@entry_id:271287)到二分图的同态。因为[二分图](@entry_id:262451)中的任何闭路长度都必须是偶数。如果存在一个从[奇圈](@entry_id:271287) $C_{2k+1}$ 到二分图 $H$ 的同态，它将把 $C_{2k+1}$ 这个长度为奇数的圈映射成 $H$ 中一个长度为奇数的闭路，而这是不可能的。这个事实解释了为什么我们无法将 $C_5$ 同态映射到 $P_4$（一个二分图）[@problem_id:1507330]，也无法将 $C_7$ 映射到 $C_4$ [@problem_id:1507370]。

更一般地，对于圈之间的同态 $f: C_m \to C_n$，其存在的条件与 $m$ 和 $n$ 的奇偶性密切相关。
- 如果 $m$ 是偶数，那么 $C_m$ 是二分的，总可以将其2-着色，并将这两个颜色类映射到 $C_n$ 中任意一对相邻的顶点上。因此，从任意偶圈到任意圈的同态都存在。
- 如果 $m$ 是奇数，而 $n$ 是偶数，如上所述，同态不存在。
- 如果 $m$ 和 $n$ 都是奇数，当且仅当 $m \ge n$ 时，同态存在 [@problem_id:1507370]。

### 图核：不可约的精髓

#### 核的动机与定义

一些图可能包含“冗余”部分，这些部分可以通过同态“折叠”到图的更小的部分。例如，一个[路径图](@entry_id:274599) $P_4$（顶点 $v_1-v_2-v_3-v_4$）可以同态到其自身的真[子图](@entry_id:273342) $P_3$（$v_1-v_2-v_3$），例如通过映射 $v_4 \to v_2$ 同时保持其他顶点不变。这启发我们去寻找一个图在同态意义下的“最小”或“最紧凑”的版本，这个版本无法再被同态到其任何更小的部分。这个不可约的本质，我们称之为**图核 (graph core)**。

为了精确定义，我们首先需要**自同态 (endomorphism)** 的概念，即从一个图到其自身的同态。

- **核图 (Core Graph):** 一个图 $C$ 被称为**核**，如果它的所有自同态都是**[自同构](@entry_id:155390) (automorphisms)**（即[双射](@entry_id:138092)的同态）。换句话说，一个核图不能同态到其任何一个真子图。
- **图 $G$ 的核 (Core of a Graph $G$):** 对于任意图 $G$，其**核** $\text{core}(G)$ 是 $G$ 的一个同态像（homomorphic image），并且这个像本身是一个核图。可以证明，对于任何给定的图 $G$，它的核在同构意义下是唯一的，并且是 $G$ 的所有同态像中顶点数最少的。

#### 寻找核与收缩

如何找到一个图的核？一个重要的工具是**收缩 (retraction)** 的概念。一个图 $G$ 的子图 $H$ 被称为 $G$ 的一个**[收缩核](@entry_id:154338) (retract)**，如果存在一个同态 $r: G \to H$（称为**收缩映射**），使得 $r$ 在 $H$ 的顶点上是[恒等映射](@entry_id:634191)（即对于所有 $v \in V(H)$，有 $r(v) = v$）。

收缩是一个比普通同态更强的概念。如果一个图 $G$ 可以收缩到其[子图](@entry_id:273342) $H$ 上，这意味着 $G$ 的结构在某种程度上是以 $H$ 为“骨架”构建的。在这种情况下， $G$ 的核就等于 $H$ 的核。这为寻找复杂图的核提供了一条捷径。

例如，考虑一个由四元环 $v_1-v_2-v_3-v_4$ 和另一个顶点 $v_5$ 组成，其中 $v_5$ 与 $v_1, v_2$ 相连的图 $G$ [@problem_id:1507353]。这个图包含一个由 $\{v_1, v_2, v_5\}$ 构成的三角形（即 $K_3$）子图。我们可以定义一个收缩映射 $r: G \to K_3$，将 $v_3$ 映射到 $v_1$，将 $v_4$ 映射到 $v_2$，同时保持 $v_1, v_2, v_5$ 不变。可以验证这是一个有效的同态。由于 $G$ 收缩到了其 $K_3$ 子图上，$\text{core}(G) = \text{core}(K_3)$。我们很快会看到 $K_3$ 本身是一个核，因此 $G$ 的核就是 $K_3$。

需要强调的是，一个图的**导出[子图](@entry_id:273342) (induced subgraph)** 不一定是一个[收缩核](@entry_id:154338)，甚至不一定是一个同态像。导出子图只保留了顶点[子集](@entry_id:261956)内的所有原始边，而同态则可能引入新的邻接关系（通过将非邻接顶点映射到邻接顶点）。前面提到的 $G=C_5$ 和 $H=P_4$ 就是一个很好的反例：$P_4$ 是 $C_5$ 的一个导出[子图](@entry_id:273342)，但从 $C_5$ 到 $P_4$ 的同态并不存在 [@problem_id:1507330]。

#### 核的典型例子

- **完全图 (Complete Graphs):** 对任意 $n \ge 1$，完全图 $K_n$ 都是一个核。任何从 $K_n$ 到自身的同态都必须是单射的，否则会将一条边压缩成一个不存在的自环。在一个[有限集](@entry_id:145527)上，单射等价于双射，因此任何自同态都是自同构 [@problem_id:1507353]。

- **[奇圈](@entry_id:271287) (Odd Cycles):** 对任意 $k \ge 1$，[奇圈](@entry_id:271287) $C_{2k+1}$ 都是一个核。其证明相当精妙，涉及到初等数论。可以证明，任何从 $C_{2k+1}$ 到自身的同态，最终都必然是圈的一个旋转或反射，即一个自同构。其关键在于，在一个长度为奇数 $n$ 的圈上，代数关系 $2x \equiv 0 \pmod n$ 蕴含了 $x \equiv 0 \pmod n$ [@problem_id:1507327]。

- **树 (Trees):** 任何至少有一条边的树 $T$ 的核都是 $K_2$。这是因为所有树都是二分图，因此都存在到 $K_2$ 的同态。而 $K_2$ 本身是一个核，因为它无法同态到其唯一的真子图（孤立顶点）。因此，所有非平凡树的不可约本质都是这最简单的一条边 [@problem_id:1507322]。

- **核与对称性 (Cores and Symmetry):** 一个常见的误解是认为核必须是高度对称的图。虽然所有[顶点传递图](@entry_id:139202)（vertex-transitive graphs，即从任何一个顶点的视角看，图的结构都是一样的）都是核，但反之不成立。存在许多不是[顶点传递图](@entry_id:139202)的核。一个典型的例子是[轮图](@entry_id:271886) $W_{2k+2}$，它由一个[中心顶点](@entry_id:264579)和与其相连的一个[奇圈](@entry_id:271287) $C_{2k+1}$ 构成。例如，当 $k=2$ 时的[轮图](@entry_id:271886) $W_6$（一个中心点加一个 $C_5$ 轮辋），[中心顶点](@entry_id:264579)的度为5，而轮辋上顶点的度为3，因此它不是顶点传递的。然而，可以证明任何到自身的同态都必须将[中心点](@entry_id:636820)映射到[中心点](@entry_id:636820)，并将轮辋映射到轮辋，最终形成一个自同构。因此，$W_6$ 是一个核，但它并不对称 [@problem_id:1507359]。

### 同态作为证明工具

除了作为研究图结构的工具，同态本身也为证明图的性质提供了强大的方法，尤其是在判定同态存在性方面。

#### 色数[不变量](@entry_id:148850)

同态的一个最基本的性质是它不会增加图的[色数](@entry_id:274073)。

**定理：** 如果存在一个从图 $G$ 到图 $H$ 的同态，那么 $G$ 的[色数](@entry_id:274073)不大于 $H$ 的[色数](@entry_id:274073)，即 $\chi(G) \le \chi(H)$。

证明思路非常直接：假设 $\chi(H)=k$，这意味着存在一个从 $H$ 到 $K_k$ 的同态（即一个 $k$-着色）$c: H \to K_k$。如果存在同态 $f: G \to H$，那么我们可以复合这两个映射得到 $c \circ f: G \to K_k$。这个复合映射是一个从 $G$ 到 $K_k$ 的同态，也就是说，它为 $G$ 提供了一个 $k$-着色。因此， $G$ 最少需要的颜色数（即 $\chi(G)$）必然不大于 $k$ [@problem_id:1507361]。

这个定理为证明**不存在**同态提供了一个强有力的“必要条件检验”。要证明从 $G$ 到 $H$ 的同态不存在，我们只需计算它们的[色数](@entry_id:274073)，如果发现 $\chi(G) > \chi(H)$，就可以立即得出结论。例如，通过 Mycielski 构造可以生成一个色数为4的图 $G_4$，而八面体图 $H$ 的[色数](@entry_id:274073)为3。由于 $4 > 3$，从 $G_4$ 到 $H$ 的同态绝不可能存在 [@problem_id:1507361]。

#### 收缩与[色数](@entry_id:274073)

当同态关系是一个收缩时，上述色数不等式可以被加强为等式。假设 $H$ 是 $G$ 的一个[收缩核](@entry_id:154338)。

1.  由于 $H$ 是 $G$ 的[子图](@entry_id:273342)，包含映射 $i: H \to G$ 是一个同态，因此 $\chi(H) \le \chi(G)$。
2.  由于 $H$ 是 $G$ 的[收缩核](@entry_id:154338)，存在收缩映射 $r: G \to H$，它也是一个同态，因此 $\chi(G) \le \chi(H)$。

结合这两个不等式，我们得到 $\chi(G) = \chi(H)$ [@problem_id:1507352]。这个结论非常有用：如果我们想计算一个复杂大图 $G$ 的[色数](@entry_id:274073)，而我们知道它可以收缩到一个更小、更简单的子图 $H$ 上，那么我们只需要计算 $H$ 的色数即可。例如，如果一个大图 $G$ 包含一个以 $C_7$ 为轮辋的[轮图](@entry_id:271886) $H$ 作为其[收缩核](@entry_id:154338)，我们可以计算出 $\chi(H)=4$，从而直接推断出 $\chi(G)=4$ [@problem_id:1507352]。

总而言之，[图同态](@entry_id:272314)和图核为我们提供了一套丰富的语言和工具，用以探索图的结构和分类。从与图着色的基本联系，到作为证明不存在性的[不变量](@entry_id:148850)，再到寻找图的不可约本质，这些概念构成了现代图论中一个活跃而深刻的研究领域。