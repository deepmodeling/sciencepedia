## 引言
在组合数学的广阔领域中，一个基本而深刻的问题是：一个系统的复杂性（如连接数）达到何种程度时，必然会涌现出某种特定的局部结构？扎兰凯维奇问题 (Zarankiewicz problem) 正是这个问题在[图论](@entry_id:140799)中的经典体现，它被誉为[极值图论](@entry_id:275134)的基石之一。该问题探讨的是，一个图在不包含特定的完全二部子图 $K_{s,t}$ 的前提下，最多能拥有多少条边。这不仅是一个理论上的智力挑战，其背后蕴含的原理也为我们理解[网络结构](@entry_id:265673)、几何[关联和](@entry_id:269099)代数构造的内在约束提供了强大的分析工具。

本文旨在系统性地剖析扎兰凯维奇问题。我们将从其基本定义出发，逐步揭示其核心的数学机制，并展示其思想如何跨越学科边界，在不同领域中产生深远影响。

在接下来的内容中，读者将首先在“原理与机制”一章中学习扎兰凯维奇问题的形式化定义、核心证明技巧——[双重计数法](@entry_id:152987)，以及 Kővári–Sós–Turán 定理的推导过程。随后，在“应用与跨学科联系”一章中，我们将探索该问题与[图兰定理](@entry_id:271028)、组合几何、代数构造、[谱图论](@entry_id:150398)乃至[拓扑图论](@entry_id:272963)的深刻联系。最后，“动手实践”部分将通过一系列精心设计的问题，帮助读者巩固所学知识，将理论应用于具体情境。

现在，让我们一同深入扎兰凯维奇问题的核心，从理解其基本原理与机制开始。

## 原理与机制

在介绍章节之后，我们现在深入探讨扎兰凯维奇问题 (Zarankiewicz problem) 的核心原理与机制。这个问题是[极值图论](@entry_id:275134)（extremal graph theory）中的一个基石，它探讨了一个基本问题：一个图中最多可以有多少条边，而不包含某个特定结构的子图。具体来说，扎兰凯维奇问题关注的是不包含完全二部子图 $K_{s,t}$ 的图。

### 问题的定义：禁止的完全二部[子图](@entry_id:273342)

扎兰凯维奇问题的核心是量化稀疏性。一个图如果不包含某个特定的[子图](@entry_id:273342) $H$，我们称之为 **$H$-无子图**（$H$-free）。扎兰凯维奇问题专门研究当 $H$ 是一个**完全[二部图](@entry_id:262451)** $K_{s,t}$ 时的情形。$K_{s,t}$ 是一个[二部图](@entry_id:262451)，其顶点集可以划分为两个不相交的集合 $S$ 和 $T$，其中 $|S|=s$ 且 $|T|=t$，图中所有的边都连接着 $S$ 中的一个顶点和 $T$ 中的一个顶点，且所有这样的边都存在。

**扎兰凯维奇数**，记为 $z(m, n; s, t)$，定义为在一个具有 $m$ 个和 $n$ 个顶点的两个部（partition）的二部图中，不包含一个以 $s$ 个顶点在大小为 $m$ 的部中、以 $t$ 个顶点在大小为 $n$ 的部中的 $K_{s,t}$ [子图](@entry_id:273342)时，该图所能拥有的最大边数。

将这个问题转化为集合语言，可以提供一个非常有力的视角。考虑一个[二部图](@entry_id:262451) $G=(U \cup V, E)$，其中 $|U|=m$，$|V|=n$。对于 $U$ 中的每个顶点 $u_i$，我们可以定义其邻居集 $N(u_i) \subseteq V$。这样，我们就得到了一个由 $m$ 个 $V$ 的[子集](@entry_id:261956)构成的集族 $\mathcal{F} = \{N(u_1), \dots, N(u_m)\}$。图中的总边数就是这些[子集](@entry_id:261956)大小的总和，即 $|E| = \sum_{i=1}^m |N(u_i)|$。

图 $G$ 包含一个 $K_{s,t}$ 子图（$s$ 个顶点在 $U$ 中，$t$ 个顶点在 $V$ 中）的条件，等价于存在 $U$ 的一个 $s$ 元[子集](@entry_id:261956) $\{u_{i_1}, \dots, u_{i_s}\}$ 和 $V$ 的一个 $t$ 元[子集](@entry_id:261956) $\{v_{j_1}, \dots, v_{j_t}\}$，使得所有 $s \times t$ 条可能的边都存在。在集合语言中，这意味着这 $s$ 个顶点的邻居集之交集至少包含 $t$ 个公共元素。也就是说，存在 $s$ 个不同的集合 $N(u_{i_1}), \dots, N(u_{i_s})$，使得 $|\bigcap_{k=1}^s N(u_{i_k})| \ge t$。因此，$G$ 是 $K_{s,t}$-无子图的条件等价于，对于集族 $\mathcal{F}$ 中任意 $s$ 个不同的集合，其交集的大小都严格小于 $t$ [@problem_id:1548502]。

值得注意的是，禁止一个图作为**[子图](@entry_id:273342)**（subgraph）与禁止它作为**导出子图**（induced subgraph）有本质区别。如果一个图 $G$ 是 $K_{s,t}$-无[子图](@entry_id:273342)，它必然也是导出 $K_{s,t}$-无子图。但反之不成立。例如，对于 $s, t \ge 2$，完全图 $K_n$ 不包含任何导出 $K_{s,t}$，因为它的任意导出[子图](@entry_id:273342)都是[完全图](@entry_id:266483)，而不是二部图。然而，$K_n$ 只要 $n$ 足够大，就必然包含 $K_{s,t}$ 作为子图。因此，禁止[子图](@entry_id:273342)是一个更强的约束，通常导致边数的上界远低于禁止导出子图的情况 [@problem_id:1548466]。我们在此关注的是更严格的“[子图](@entry_id:273342)”版本。

### 核心证明技巧：双重计数

推导扎兰凯维奇数[上界](@entry_id:274738)的主要工具是一种被称为**双重计数**（double counting）的强大组合技巧。其思想是选择一个相关的组合对象集合，并用两种不同的方式来计算其大小，从而建立一个不等式。

我们来推导 $z(m,n;s,t)$ 的一个通用[上界](@entry_id:274738)。考虑一个 $K_{s,t}$-无子图的二部图 $G=(U \cup V, E)$，其中 $|U|=m$，$|V|=n$。我们要计数的对象是这样一种“星状”结构：由 $U$ 中一个顶点 $u$ 和其在 $V$ 中的 $t$ 个邻居组成的集合。形式上，我们考虑所有[有序对](@entry_id:269702) $(u, T)$，其中 $u \in U$，$T \subseteq N(u)$ 且 $|T|=t$。令 $\mathcal{S}$ 为所有这类[有序对](@entry_id:269702)的集合。

**第一种计数方式**：对 $U$ 中的每个顶点求和。对于每个顶点 $u \in U$，其度为 $d(u)$，它可以形成 $\binom{d(u)}{t}$ 个不同的 $t$ 元邻居[子集](@entry_id:261956)。因此，集合 $\mathcal{S}$ 的总大小为：
$$ |\mathcal{S}| = \sum_{u \in U} \binom{d(u)}{t} $$

**第二种计数方式**：对 $V$ 的所有 $t$ 元[子集](@entry_id:261956)求和。考虑 $V$ 的任意一个 $t$ 元[子集](@entry_id:261956) $T$。由于图 $G$ 是 $K_{s,t}$-无子图，所以至多有 $s-1$ 个 $U$ 中的顶点同时与 $T$ 中的所有 $t$ 个顶点相邻。否则，我们就会找到一个 $K_{s,t}$ 子图。因此，对于每个 $T \subseteq V$ 且 $|T|=t$，最多有 $s-1$ 个 $u \in U$ 满足 $T \subseteq N(u)$。$V$ 中总共有 $\binom{n}{t}$ 个这样的[子集](@entry_id:261956) $T$。所以，我们得到 $|\mathcal{S}|$ 的一个[上界](@entry_id:274738)：
$$ |\mathcal{S}| \le (s-1) \binom{n}{t} $$

将这两种计数方式结合起来，我们得到了一个至关重要的不等式，它构成了 Kővári–Sós–Turán 定理的基础：
$$ \sum_{u \in U} \binom{d(u)}{t} \le (s-1) \binom{n}{t} $$
这个不等式将图中局部的度[分布](@entry_id:182848)（左侧）与全局的[极值](@entry_id:145933)约束（右侧）联系了起来 [@problem_id:1548495]。

### 使用凸性推导[渐近界](@entry_id:267221)

上述不等式的左侧是一个关于顶点度的和，而我们最终关心的是总边数 $|E| = \sum_{u \in U} d(u)$。为了建立两者之间的联系，我们需要借助**[凸性](@entry_id:138568)**和**[詹森不等式](@entry_id:144269)**（Jensen's inequality）。

函数 $f(x) = \binom{x}{t}$ 对于 $x \ge t-1$ 是一个凸函数。[詹森不等式](@entry_id:144269)指出，对于一个凸函数 $f$ 和一组数 $x_1, \dots, x_m$，有 $\frac{1}{m} \sum_{i=1}^m f(x_i) \ge f(\bar{x})$，其中 $\bar{x} = \frac{1}{m} \sum_{i=1}^m x_i$ 是这组数的平均值。

将[詹森不等式](@entry_id:144269)应用于我们的度序列 $\{d(u)\}_{u \in U}$，其中[平均度](@entry_id:261638)为 $\bar{d} = |E|/m$，我们得到：
$$ \sum_{u \in U} \binom{d(u)}{t} \ge m \binom{\bar{d}}{t} = m \binom{|E|/m}{t} $$
这个关系在诸如分析社交网络连接模式等场景中非常有用 [@problem_id:1548513]。

现在，我们可以将这个下界与我们之前通过双重计数得到的上界结合起来：
$$ m \binom{|E|/m}{t} \le (s-1) \binom{n}{t} $$
这个不等式给出了总边数 $|E|$ 的一个隐式[上界](@entry_id:274738)。为了得到一个更明确的渐近形式，我们可以使用近似 $\binom{x}{k} \approx \frac{x^k}{k!}$，这个近似在 $x \gg k$ 时成立。假设[平均度](@entry_id:261638) $\bar{d}$ 和 $n$ 都远大于 $t$，不等式变为：
$$ m \frac{(|E|/m)^t}{t!} \lesssim (s-1) \frac{n^t}{t!} $$
整理后可得：
$$ |E|^t \cdot m^{1-t} \lesssim (s-1) n^t $$
$$ |E| \lesssim (s-1)^{1/t} n m^{1 - 1/t} $$
这表明 $z(m, n; s, t)$ 的阶是 $O(n m^{1-1/t})$。这个结果是[极值图论](@entry_id:275134)中的一个里程碑，显示了禁止一个二部[子图](@entry_id:273342)会强制图变得“稀疏”，即边数远少于 $O(mn)$。

### 一个特例：无 $K_{2,2}$ 图的边数界

$s=t=2$ 的情况，即禁止 $K_{2,2}$（也称为 4-圈，$C_4$），是最著名且研究最充分的特例。在这种情况下，我们可以通过一个更直接的论证得到一个非常精确的界。

考虑一个不含 $K_{2,2}$ 的[二部图](@entry_id:262451) $G=(U \cup V, E)$，其中 $|U|=m, |V|=n$。我们再次使用双重计数，但这次我们计数的是“2-路径”，即形如 $(u_1, v, u_2)$ 的路径，其中 $u_1, u_2 \in U$ 且 $v \in V$。

对 $V$ 中的每个顶点 $v$，其度为 $d(v)$，它形成了 $\binom{d(v)}{2}$ 对 $U$ 中的邻居。对所有 $v \in V$ 求和，得到 2-路径的总数为 $\sum_{v \in V} \binom{d(v)}{2}$。另一方面，由于图是 $K_{2,2}$-无子图，任何一对 $U$ 中的顶点 $\{u_i, u_j\}$ 最多只有一个公共邻居。$U$ 中共有 $\binom{m}{2}$ 对顶点。因此，2-路径的总数不能超过这个值。我们得到：
$$ \sum_{v \in V} \binom{d(v)}{2} \le \binom{m}{2} $$
展开左侧的二项式系数，我们有 $\sum_{v \in V} \frac{d(v)(d(v)-1)}{2} = \frac{1}{2} (\sum d(v)^2 - \sum d(v))$。令 $|E|$ 为总边数，则 $|E| = \sum d(v)$。不等式变为 $\sum d(v)^2 - |E| \le m(m-1)$。

根据柯西-施瓦茨不等式，我们有 $(\sum d(v))^2 \le n \sum d(v)^2$，即 $|E|^2 \le n \sum d(v)^2$。代入上式，可得 $\frac{|E|^2}{n} - |E| \le m(m-1)$。这是一个关于 $|E|$ 的二次不等式，解得：
$$ |E| \le \frac{n + \sqrt{n^2 + 4n m(m-1)}}{2} \approx \frac{n}{2} + \sqrt{n m^2} = \frac{n}{2} + m\sqrt{n} $$
对于平衡二部图（$m=n=N$）的特殊情况，这个界变为 $E \le \frac{N}{2}(1 + \sqrt{4N-3})$ [@problem_id:1548486]。

这个界在某些情况下是紧的。例如，当 $N=q^2+q+1$（其中 $q$ 是一个[素数幂](@entry_id:636094)）时，可以利用有限[射影平面](@entry_id:266501)的关联结构来构造一个恰好有 $N(q+1)$ 条边的 $K_{2,2}$-无子图。对于 $N=13$（对应 $q=3$ 的[射影平面](@entry_id:266501)），这个[上界](@entry_id:274738)是 $\frac{13}{2}(1+\sqrt{4 \cdot 13 - 3}) = 52$，这可以通过一个具体的几何构造达到 [@problem_id:1357667]。

从几何直观上看，如果我们将二部图的两个部分别画在两条平行的直线上，并将边画成直线段，那么一个 $K_{2,2}$ [子图](@entry_id:273342)恰好对应于两条边的交叉。因此，一个[二部图](@entry_id:262451)在这种画法下没有交叉，当且仅当它不含 $K_{2,2}$ 子图 [@problem_id:1548486]。

### [双重计数法](@entry_id:152987)的应用

[双重计数法](@entry_id:152987)的威力不仅在于推导边数的[上界](@entry_id:274738)，它同样可以用来证明，一旦一个图足够“稠密”，它就必然包含大量的特定[子图](@entry_id:273342)。我们可以用它来得到[子图](@entry_id:273342)数量的**下界**。

考虑一个二部图 $G=(U \cup V, E)$。我们已经知道 $\sum_{v \in V} \binom{d(v)}{s}$ 计算了所有形如 $(S, v)$ 的对的数量，其中 $S$ 是 $v$ 的一个 $s$ 元邻居[子集](@entry_id:261956)。这个和也可以写成 $\sum_{S \subseteq U, |S|=s} c(S)$，其中 $c(S)$ 表示 $U$ 中顶点集 $S$ 的公共邻居数。

一个 $U$ 中的 $s$ 元集 $S$ 与其 $c(S)$ 个公共邻居可以形成 $\binom{c(S)}{t}$ 个 $K_{s,t}$ [子图](@entry_id:273342)。因此，图中 $K_{s,t}$ [子图](@entry_id:273342)的总数为 $\sum_{S \subseteq U, |S|=s} \binom{c(S)}{t}$。

通过[凸性](@entry_id:138568)，我们可以为这个总数找到一个下界。例如，对于 $K_{2,2}$ 的情况，我们想要求 $\sum_{\{u_i, u_j\} \subseteq U} \binom{c(\{u_i, u_j\})}{2}$ 的下界。利用简单的不等式 $\binom{x}{2} \ge x-1$ (对 $x \ge 2$ 成立)，我们可以得到：
$$ \text{Number of } K_{2,2} \ge \sum_{\{u_i, u_j\}} (c(\{u_i, u_j\}) - 1) = \left(\sum c(\{u_i, u_j\})\right) - \binom{m}{2} $$
而我们知道 $\sum c(\{u_i, u_j\}) = \sum_{v \in V} \binom{d(v)}{2}$。因此，如果给定图中各顶点的度，我们就可以计算出 $K_{2,2}$ [子图](@entry_id:273342)数量的保证存在的最小值 [@problem_id:1548505]。这个原理可以推广到 $K_{s,t}$，并用于在各种网络（如社交网络或合作网络）中识别必然存在的“兴趣簇”或“合作小组” [@problem_id:1548462]。

### [极值图论](@entry_id:275134)中的更广阔背景

扎兰凯维奇问题及其解法是理解更广泛的[极值图论](@entry_id:275134)领域的一个窗口。

首先，让我们区分[二部图](@entry_id:262451)和一般图的极值问题。对于一般图上的 $K_{s,t}$-无[子图](@entry_id:273342)问题，其[极值](@entry_id:145933)数记为 $ex(n, K_{s,t})$。通过类似的双重计数论证（在所有 $n$ 个顶点上应用），可以证明 $ex(n, K_{s,t}) = O(n^{2-1/s})$ (假设 $s \le t$)。这是一个非平凡的结果，称为 **Kővári–Sós–Turán (KST) 定理**。值得注意的是，试图通过将一般图任意划分为两部分并应用二部图的结果来证明这个定理是错误的。这种天真的方法会忽略划分内部的边，从而低估了上界，其结果与正确的 KST 界相差一个 $2^{1-1/s}$ 的因子 [@problem_id:1548512]。

其次，一个深刻的观察是，禁止**[二部图](@entry_id:262451)**作为[子图](@entry_id:273342)与禁止**非[二部图](@entry_id:262451)**（如 $K_3$，三角形）有根本性的区别。**[图兰定理](@entry_id:271028) (Turán's Theorem)** 指出，不含 $K_r$ [子图](@entry_id:273342)的 $n$ 顶点图的最大边数 $ex(n, K_r)$ 约为 $(1-\frac{1}{r-1})\frac{n^2}{2}$。这是一个 $\Theta(n^2)$ 级别的边数。然而，正如我们所见，KST 定理表明 $ex(n, K_{s,t}) = o(n^2)$。这意味着，要使得一个图的边数达到二次级别，它必须在局部看起来像一个稠密的二部图；任何非[二部图](@entry_id:262451)的出现都会被图兰类型的[稠密图](@entry_id:634853)所包含。因此，禁止任何[二部图](@entry_id:262451)都会迫使边数下降到次二次级别。比较 $ex(n, K_3) = \lfloor n^2/4 \rfloor = \Theta(n^2)$ 和 $ex(n, K_{2,2}) \sim \frac{1}{2}n^{3/2} = o(n^2)$ 就清晰地展示了这种二分性 [@problem_id:1548504]。这一发现是现代[极值图论](@entry_id:275134)的基石之一。