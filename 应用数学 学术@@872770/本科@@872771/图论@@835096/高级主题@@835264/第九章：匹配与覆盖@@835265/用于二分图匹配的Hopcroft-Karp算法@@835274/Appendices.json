{"hands_on_practices": [{"introduction": "理解 Hopcroft-Karp 算法的第一步是掌握其核心的“阶段”操作。这个练习将带你分析算法在一种理想化的图（完全二分图 $K_{n,n}$）上从零开始的第一个完整阶段，让你清晰地看到广度优先搜索（BFS）如何确定最短增广路径的长度，以及深度优先搜索（DFS）如何找到一个顶点不相交的最短增广路径集。通过这个练习 [@problem_id:1512374]，你将对算法的基础构建模块有更深刻的认识。", "problem": "一位算法设计者正在分析 Hopcroft-Karp 算法在二分图中寻找最大基数匹配的性能。所考虑的具体图是完全二分图，记为 $K_{n,n}$，其中 $n$ 是一个正整数。该图由两个不相交的顶点集 $U = \\{u_1, u_2, \\dots, u_n\\}$ 和 $V = \\{v_1, v_2, \\dots, v_n\\}$ 组成，$U$ 中的每个顶点都与 $V$ 中的每个顶点有一条边相连。\n\nHopcroft-Karp 算法通过分阶段工作来增广一个匹配 $M$。单个阶段由以下操作序列定义：\n1.  从划分 $U$ 中所有未匹配的顶点同时发起一次广度优先搜索（BFS）。这次搜索会构建一个分层图，并确定相对于当前匹配 $M$ 的最短增广路径的长度 $k$。如果搜索没有找到增广路径，则算法终止，因为当前匹配已是最大匹配。\n2.  在 BFS 之后，使用深度优先搜索（DFS）来寻找一个顶点不相交的增广路径的极大集合 $\\mathcal{P} = \\{P_1, P_2, \\dots, P_m\\}$，其中集合中的每条路径长度均为上一步中找到的 $k$。\n3.  然后通过与所有找到的路径取对称差来增广匹配：$M_{\\text{new}} = M \\oplus P_1 \\oplus P_2 \\oplus \\dots \\oplus P_m$。\n\n分析从一个空匹配 $M_0 = \\emptyset$ 开始。请确定在图 $K_{n,n}$ 上完整执行一个 Hopcroft-Karp 算法阶段后，匹配的基数（即边的数量）。请将你的答案表示为 $n$ 的函数。", "solution": "我们分析在 $K_{n,n}$ 上从空匹配 $M_{0}=\\emptyset$ 开始的一个 Hopcroft-Karp 阶段。\n\n根据 Hopcroft-Karp 算法中 BFS 步骤的定义，我们从 $U$ 中所有自由顶点同时开始。在 $M_{0}=\\emptyset$ 的情况下，$U$ 和 $V$ 中的每个顶点都是自由的。BFS 通过遍历从 $U$ 到 $V$ 的未匹配边和从 $V$ 到 $U$ 的匹配边来构建分层。由于初始时没有匹配边，从 $U$ 通过未匹配边进行的第一次扩展会到达 $V$ 中的所有顶点。因为 $V$ 中的所有顶点都是自由的，BFS 在距离为 1 的地方发现了 $V$ 中的自由顶点，所以最短增广路径的长度是\n$$\nk=1.\n$$\n\n因此，每条最短增广路径都是一条单独的边 $\\{u,v\\}$，其中 $u\\in U$ 是自由的且 $v\\in V$ 是自由的。在 DFS 步骤中，算法会找到一个长度为 $k=1$ 的顶点不相交的增广路径的极大集合 $\\mathcal{P}$，即 $U$ 和 $V$ 中自由顶点之间不相交边的极大集合。令 $m=|\\mathcal{P}|$。\n\n因为该图是完全二分图，所以任何自由的 $u\\in U$ 都与任何自由的 $v\\in V$ 相邻。用反证法，假设 $m  n$。那么在匹配了 $m$ 条边后，$U$ 中至少有一个自由顶点 $u'$，$V$ 中也至少有一个自由顶点 $v'$。因为图是 $K_{n,n}$，边 $(u', v')$ 一定存在。这条边本身就是一条长度为 1 的增广路径，且它与集合 $\\mathcal{P}$ 中的所有边都顶点不相交（因为它的端点都是自由的）。这与 $\\mathcal{P}$ 是一个极大集合的假设相矛盾。因此，$m$ 必须等于 $n$。", "answer": "$$\\boxed{n}$$", "id": "1512374"}, {"introduction": "Hopcroft-Karp 算法的精髓在于其卓越的效率，它优于许多更简单的增广路径算法。这个练习 [@problem_id:1512380] 通过一个精心设计的例子，将 Hopcroft-Karp 算法与每次只寻找一条增广路径的朴素方法进行直接对比。亲手推演这个过程，你将直观地理解为何按长度分阶段批量处理增广路径是一种更高效的策略。", "problem": "考虑一个由参数 $k$ 定义的二分图 $G = (U \\cup V, E)$。顶点的两个划分是 $U = \\{u_1, u_2, \\dots, u_{k+1}\\}$ 和 $V = \\{v_1, v_2, \\dots, v_{k+1}\\}$。对于此特定问题，设参数为 $k=5$。\n\n边集 $E$ 由三个边子集的并集构成：\n1.  一组“直连”边：$E_1 = \\{ (u_i, v_i) \\mid 1 \\le i \\le k \\}$\n2.  一组“交叉”边：$E_2 = \\{ (u_i, v_{i+1}) \\mid 1 \\le i  k \\}$\n3.  一组“端点”边：$E_3 = \\{ (u_{k+1}, v_1), (u_k, v_{k+1}) \\}$\n\n总边集为 $E = E_1 \\cup E_2 \\cup E_3$。图中的匹配初始为空。\n\n我们想要比较两种从空匹配开始寻找最大匹配的算法的性能。\n\n**算法 A (简单增广路径):** 该算法迭代地寻找增广路径。在每次迭代中，它从 $U$ 中可用的自由顶点（按其索引升序考虑，例如 $u_1, u_2, \\dots, u_{k+1}$）开始执行一次深度优先搜索 (DFS)，以找到第一条可用的增广路径。从任何顶点进行探索时，其邻居按索引升序访问（例如，从 $u_i$ 出发，如果 $j  l$，则邻居 $v_j$ 在 $v_l$ 之前探索）。一旦找到一条增广路径，就对匹配进行增广，然后该次迭代结束。重复此过程，直到找不到更多增广路径为止。\n\n**算法 B (Hopcroft-Karp):** 该算法分阶段（我们将称之为迭代）进行。在每次迭代中，它首先使用广度优先搜索 (BFS) 来确定最短增广路径的长度。然后，它使用深度优先搜索 (DFS) 来寻找一个该特定长度的顶点不交增广路径的极大集。然后用在此集合中找到的所有路径来增广匹配。该次迭代结束，并重复此过程。\n\n计算比值 $\\frac{N_A}{N_B}$，其中 $N_A$ 是算法 A 找到最大匹配所需的总迭代次数，而 $N_B$ 是算法 B 所需的总迭代次数。", "solution": "我们为 $k=5$ 实例化该图：\n- $U=\\{u_{1},u_{2},u_{3},u_{4},u_{5},u_{6}\\}$ 和 $V=\\{v_{1},v_{2},v_{3},v_{4},v_{5},v_{6}\\}$。\n- $E_{1}=\\{(u_{i},v_{i}) \\mid 1 \\leq i \\leq 5\\}$，$E_{2}=\\{(u_{i},v_{i+1}) \\mid 1 \\leq i \\leq 4\\}$，$E_{3}=\\{(u_{6},v_{1}),(u_{5},v_{6})\\}$，以及 $E=E_{1}\\cup E_{2}\\cup E_{3}$。\n\n首先，最大匹配的大小等于 $6$，因为存在完美匹配\n$$\\{(u_{6},v_{1}),(u_{1},v_{2}),(u_{2},v_{3}),(u_{3},v_{4}),(u_{4},v_{5}),(u_{5},v_{6})\\}$$。\n\n算法 A（简单增广路径，DFS，每次迭代一条路径，从未匹配的 $u$ 按升序开始，并按升序访问邻居）：\n- 从空匹配开始。迭代 1：从 $u_{1}$ 出发，访问的第一个邻居是 $v_{1}$，该顶点是自由的，所以我们用 $(u_{1},v_{1})$ 进行增广。\n- 迭代 2：从下一个自由的 $u$（即 $u_{2}$）出发，访问的第一个邻居是 $v_{2}$（自由的），所以用 $(u_{2},v_{2})$ 进行增广。\n- 迭代 3：从 $u_{3}$ 出发，用 $(u_{3},v_{3})$ 进行增广。\n- 迭代 4：从 $u_{4}$ 出发，用 $(u_{4},v_{4})$ 进行增广。\n- 迭代 5：从 $u_{5}$ 出发，邻居是 $v_{5}$ 然后是 $v_{6}$；$v_{5}$ 是自由的，所以用 $(u_{5},v_{5})$ 进行增广。\n\n经过这 $5$ 次迭代后，匹配为 $M=\\{(u_{1},v_{1}),(u_{2},v_{2}),(u_{3},v_{3}),(u_{4},v_{4}),(u_{5},v_{5})\\}$；自由顶点是 $u_{6}$ 和 $v_{6}$。迭代 6：从 $u_{6}$ 开始，DFS 遵循唯一的交错链（交错使用从 U 到 V 的未匹配边和从 V 到 U 的匹配边）到达自由顶点 $v_{6}$：\n$$u_{6}-v_{1}-u_{1}-v_{2}-u_{2}-v_{3}-u_{3}-v_{4}-u_{4}-v_{5}-u_{5}-v_{6}.$$\n这是一条长度为 $11$ 条边的增广路径。沿此路径增广会产生完美匹配 $\\{(u_{6},v_{1}),(u_{1},v_{2}),(u_{2},v_{3}),(u_{3},v_{4}),(u_{4},v_{5}),(u_{5},v_{6})\\}$。因此算法 A 使用了\n$$N_{A}=6 \\text{ 次迭代。}$$\n\n算法 B（Hopcroft–Karp，其阶段包括一次 BFS 寻找最短增g广路径，以及一次 DFS 寻找该长度下顶点不交增广路径的极大集）：\n- 阶段 1 BFS：所有 $u \\in U$ 都是自由的；$V$ 中的每个邻居都可以在距离 1 处到达，因此最短增广路径的长度为 1。寻找顶点不交最短增广路径极大集的 DFS，在按升序处理自由顶点 $u$ 和按升序处理邻居时，会选择\n$$\\{(u_{1},v_{1}),(u_{2},v_{2}),(u_{3},v_{3}),(u_{4},v_{4}),(u_{5},v_{5})\\} \\text{，}$$\n留下 $u_{6}$ 未匹配，因为它的唯一邻居 $v_{1}$ 在此集合中已被使用。这个集合在长度为 1 的路径中是极大的。增广后，匹配为 $M=\\{(u_{1},v_{1}),\\dots,(u_{5},v_{5})\\}$。\n- 阶段 2 BFS：唯一的自由顶点是 $u_{6}$ 和 $v_{6}$。BFS 分层揭示了唯一的最短增广路径\n$$u_{6}-v_{1}-u_{1}-v_{2}-u_{2}-v_{3}-u_{3}-v_{4}-u_{4}-v_{5}-u_{5}-v_{6} \\text{，}$$\n长度为 $11$ 条边。DFS 找到这条唯一的路径，增广后得到完美匹配。\n\n因此，\n$$N_{B}=2 \\text{。}$$\n\n所求的比值为\n$$\\frac{N_{A}}{N_{B}}=\\frac{6}{2}=3 \\text{。}$$", "answer": "$$\\boxed{3}$$", "id": "1512380"}, {"introduction": "现实世界中的网络和系统常常是动态变化的。这个问题 [@problem_id:1512347] 探讨了当图增加一条新边时，如何高效地更新已知的最大匹配，而无需从头重新运行整个算法。这个场景突显了增广路径理论的实际应用价值——只需寻找一条新的增广路径，就有可能增加匹配的大小，这比完全重新计算要快得多。", "problem": "考虑一个二分图 $G = (U \\cup V, E)$，其中两个顶点划分是 $U = \\{u_1, u_2, u_3, u_4, u_5\\}$ 和 $V = \\{v_1, v_2, v_3, v_4, v_5\\}$。边集为 $E = \\{(u_1, v_2), (u_2, v_3), (u_4, v_5), (u_2, v_2), (u_3, v_3), (u_4, v_4)\\}$。\n\n已知集合 $M = \\{(u_2, v_2), (u_3, v_3), (u_4, v_4)\\}$ 是图 $G$ 的一个最大匹配。\n\n现在，向图中添加一条新边 $e' = (u_3, v_4)$，形成一个新图 $G' = (U \\cup V, E \\cup \\{e'\\})$。\n\n新图 $G'$ 中最大匹配的大小是多少？\n\nA) 2\n\nB) 3\n\nC) 4\n\nD) 5\n\nE) 6", "solution": "给定一个二分图 $G=(U\\cup V,E)$，其中 $U=\\{u_{1},u_{2},u_{3},u_{4},u_{5}\\}$，$V=\\{v_{1},v_{2},v_{3},v_{4},v_{5}\\}$，以及\n$$E=\\{(u_{1},v_{2}),(u_{2},v_{3}),(u_{4},v_{5}),(u_{2},v_{2}),(u_{3},v_{3}),(u_{4},v_{4})\\}。$$\n匹配 $M=\\{(u_{2},v_{2}),(u_{3},v_{3}),(u_{4},v_{4})\\}$ 在 $G$ 中是最大的，所以 $|M|=3$。在 $M$ 中，$U$ 中的未匹配顶点是 $u_{1},u_{5}$，$V$ 中的未匹配顶点是 $v_{1},v_{5}$。\n\n添加一条新边 $e'=(u_{3},v_{4})$，形成图 $G'$。为了确定最大匹配的大小是否增加，我们在 $G'$ 中寻找一条 $M$-增广路径。根据定义（Berge 定理），如果存在一条 $M$-增广路径，那么就存在一个比 $M$ 更大的匹配。\n\n考虑路径\n$$u_{1}-v_{2}-u_{2}-v_{3}-u_{3}-v_{4}-u_{4}-v_{5}。$$\n沿着这条路径，相对于 $M$，边在非匹配边和匹配边之间交替出现：\n- $(u_{1},v_{2})\\notin M$,\n- $(u_{2},v_{2})\\in M$,\n- $(u_{2},v_{3})\\notin M$,\n- $(u_{3},v_{3})\\in M$,\n- $(u_{3},v_{4})=e'\\notin M$,\n- $(u_{4},v_{4})\\in M$,\n- $(u_{4},v_{5})\\notin M$.\n\n这条路径起始于未匹配的顶点 $u_{1}$，终止于未匹配的顶点 $v_{5}$，因此它是 $G'$ 中的一条 $M$-增广路径。沿着这条路径对 $M$ 进行增广（取 $M$ 与路径中边的对称差），得到一个新的匹配\n$$M'=\\{(u_{1},v_{2}),(u_{2},v_{3}),(u_{3},v_{4}),(u_{4},v_{5})\\}，$$\n其大小为 $|M'|=4$。\n\n为了说明不存在大小为 $5$ 的匹配，我们观察到在 $G'$ 中，$u_{5}$ 没有任何关联边，$v_{1}$ 也没有任何关联边，所以这两个顶点都不能被匹配。因此，任何匹配最多只能包含 $4$ 条边。因此，$G'$ 中最大匹配的大小恰好是 $4$。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1512347"}]}