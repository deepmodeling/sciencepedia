## 引言
在许多领域，从[电路设计](@entry_id:261622)到[网络可视化](@entry_id:272365)，一个图能否在平面上无[交叉](@entry_id:147634)地绘制出来（即其“平面性”）是一个至关重要的问题。然而，对于复杂的图，仅凭直观的尝试和绘制来判断其平面性既不可靠也不高效。这就引出了一个根本性的问题：是否存在一个精确的、通用的准则来判定任何图的平面性？本文将深入探讨由数学家 Kazimierz Kuratowski 提出的里程碑式定理，它为这一问题提供了优雅而完备的解答。通过学习本文，您将首先在“原理与机制”一章中掌握平面性的核心理论，理解[非平面图](@entry_id:268333)的两个基本障碍 $K_5$ 和 $K_{3,3}$，并学会如何运用[库拉托夫斯基定理](@entry_id:276059)进行判定。接着，在“应用与跨学科联系”一章中，您将探索该定理在工程、计算机科学和数学其他分支中的深远影响。最后，通过“动手实践”中的练习，您将巩固并应用所学知识来解决具体问题。

## 原理与机制

在上一章中，我们对[平面图](@entry_id:269787)（planar graph）的概念有了初步的认识，即可以在平面上绘制而没有任何边相交的图。这个属性在从[电路设计](@entry_id:261622)到[网络可视化](@entry_id:272365)的许多应用中都至关重要。然而，仅凭直觉或尝试绘制来判断一个图是否是平面的，对于复杂的图来说既不可靠也不高效。本章将深入探讨平面性的核心理论，揭示一个图之所以非平面的根本原因。我们将介绍由波兰数学家 Kazimierz Kuratowski 提出的一个里程碑式的定理，它为[平面性](@entry_id:274781)提供了一个精确而优雅的判定准则。

### 非平面性的基本障碍：$K_5$ 和 $K_{3,3}$

在图论的广阔天地中，有两个特殊的图在平面性研究中扮演着核心角色。它们是所有[非平面图](@entry_id:268333)结构的“基本构件”。

第一个是**[完全图](@entry_id:266483)** $K_5$，即拥有 5 个顶点且每对不同的顶点之间都有一条边的图。它有 5 个顶点和 $\binom{5}{2} = 10$ 条边。无论你如何尝试在纸上画出 $K_5$，总会发现至少有一条边无法避免地与另一条边交叉。

第二个是**完全[二部图](@entry_id:262451)** $K_{3,3}$。它的顶点集可以被划分为两个不相交的[子集](@entry_id:261956)，每个[子集](@entry_id:261956)包含 3 个顶点（我们称之为部）。图中的边只存在于不同部的顶点之间，每个部的顶点都与另一个部的所有 3 个顶点相连。因此，$K_{3,3}$ 共有 6 个顶点和 $3 \times 3 = 9$ 条边。这个图通常被称为“三间小屋问题”（three utilities problem）的图论形式，即能否将三座小屋分别连接到三个公共设施（如水、电、气）而不让任何管线交叉。答案是否定的，这正说明了 $K_{3,3}$ 的非[平面性](@entry_id:274781)。

这两个图，$K_5$ 和 $K_{3,3}$，是理解非平面性的关键，因为 Kuratowski 证明了，任何[非平面图](@entry_id:268333)都必然在某种意义上“包含”了这两个结构中的一个。为了精确描述这种“包含”关系，我们需要引入一个重要的概念：图的细分。

### 图的细分：拓扑等价

想象一下，你有一根橡皮筋，代表图中的一条边。你可以在这根橡皮筋的任何位置捏出一个点，从而将它变成两段相连的橡皮筋。在[图论](@entry_id:140799)中，这个操作被称为**边的细分**（edge subdivision）。

形式上，对一条边 $(u,v)$ 进行细分，是指移除这条边，并引入一个新的顶点 $w$，然后添加两条新边 $(u,w)$ 和 $(w,v)$。这个过程可以在同一条边上重复多次，也可以在图的多条不同边上进行。

如果一个图 $H$ 可以通过对另一个图 $G$ 进行一系列（零次或多次）边的细分操作得到，我们就称 $H$ 是 $G$ 的一个**细分**（subdivision）。从拓扑学的角度看，$G$ 和它的任何细分 $H$ 都是同胚的，它们拥有相同的基本连接结构。

在细分图 $H$ 中，我们可以将顶点分为两类 [@problem_id:1517552]：
1.  **分支顶点 (branch vertices)**：这些是对应于[原始图](@entry_id:262918) $G$ 的顶点。
2.  **细分顶点 (subdivision vertices)**：这些是在细分过程中新引入的顶点。

一个至关重要的观察是：在细分过程中，新引入的细分顶点的度数恰好为 2。它们仅仅是作为路径上的“中继站”。而原始的分支[顶点的度](@entry_id:264944)数在细分图中保持不变。例如，在 $K_{3,3}$ 中，每个顶点的度数都是 3。在其任何细分图中，6 个分支顶点的度数仍然是 3，而所有其他（细分）顶点的度数都将是 2 [@problem_id:1517525]。

例如，假设我们对 $K_{3,3}$ 的三条边进行细分：将一条边替换为长度为 2 的路径（增加 1 个细分顶点），另一条替换为长度为 3 的路径（增加 2 个细分顶点），第三条替换为长度为 4 的路径（增加 3 个细分顶点）。最终得到的图将包含原始的 6 个分支顶点和 $1+2+3=6$ 个细分顶点 [@problem_id:1517552]。

值得注意的是，对同一个图进行细分可以产生不同的结果。例如，从 $K_5$ 出发，如果我们先细分一条边，再细分新产生的两条边之一，会得到一个 7 顶点的图。另外，如果我们选择 $K_5$ 中共享一个顶点的两条边，并分别将它们细分一次，也会得到一个 7 顶点的图。这两个生成的图虽然都是 $K_5$ 的细分且顶点数相同，但它们并不构，例如，它们新引入的两个细分顶点之间的最短路径长度是不同的（一个为 1，一个为 2）[@problem_id:1517533]。这强调了细分的概念关注的是底层的拓扑结构，而非细分后图的精确形态。

### [库拉托夫斯基定理](@entry_id:276059)：平面性的最终判据

有了细分的概念，我们现在可以精确地陈述图论中最著名的定理之一。

**[库拉托夫斯基定理](@entry_id:276059) (Kuratowski's Theorem)**: 一个有限图是平面的，当且仅当它不包含任何是 $K_5$ 或 $K_{3,3}$ 的细分的子图。

这里的“是 $K_5$ 或 $K_{3,3}$ 的细分的[子图](@entry_id:273342)”通常被简称为**库拉托夫斯基子图**（Kuratowski subgraph）。这个定理的强大之处在于它的“当且仅当”性质，它为平面性提供了一个完备的、代数化的特征。

-   **（$\Rightarrow$）** 如果一个图是平面的，那么它一定不含库拉托夫斯基子图。
-   **（$\Leftarrow$）** 如果一个图不含任何库拉托夫斯基子图，那么它一定是平面的。

这意味着，要证明一个图是**非平面**的，我们只需要在其中**找到**一个 $K_5$ 或 $K_{3,3}$ 的细分。反之，要证明一个图是**平面**的，我们必须论证它**不可能**包含任何这样的细分。

### 应用[库拉托夫斯基定理](@entry_id:276059)：证明非平面性

寻找库拉托夫斯基子图就像是在一张复杂的地图中寻找一个特定的道路网络模式。这通常需要系统性的方法。一个有效的策略是首先识别出图中潜在的分支顶点。由于 $K_5$ 的细分需要 5 个度数至少为 4 的分支顶点，而 $K_{3,3}$ 的细分需要 6 个度数至少为 3 的分支顶点，因此图中度数较高的顶点是天然的候选对象。

让我们看一个具体的例子。考虑一个有 10 个顶点的图，其中一些顶点的度数为 3，另一些为 2。一个初步的检查可能会发现图中没有长度为 3 或 4 的短环路，这可能会诱导我们错误地猜测该图是平面的。然而，这并不能作为可靠的依据 [@problem_id:1517508]。

要进行严格的判断，我们需要寻找库拉托夫斯基[子图](@entry_id:273342)。假设我们怀疑图中存在一个 $K_{3,3}$ 的细分。我们首先需要找出两组不相交的、各含 3 个顶点的集合，作为潜在的分支顶点集，称之为 $A'$ 和 $B'$。然后，我们必须验证，对于 $A'$ 中的每个顶点 $a$ 和 $B'$ 中的每个顶点 $b$，是否存在一条连接它们的路径。最关键的是，这 9 条路径必须是**内部顶点不交**的，即除了在端点（$A'$ 和 $B'$ 中的分支顶点）外，它们不能共享任何顶点。

在问题 [@problem_id:1517508] 的图中，我们可以选定两组度数为 3 的顶点作为 $A' = \{v_1, v_2, v_3\}$ 和 $B' = \{v_4, v_5, v_6\}$。通过仔细检查，可以发现连接这两组顶点之间的所有 9 对顶点都存在路径。其中一些是直连的边（长度为 1 的路径），另一些则通过图中度数为 2 的顶点作为中继（长度为 2 的路径）。由于所有这些路径的内部顶点（即那些度数为 2 的顶点）互不相同，我们成功地找到了一个 $K_{3,3}$ 的细分。根据[库拉托夫斯基定理](@entry_id:276059)，该图是**非平面**的。

### 应用[库拉托夫斯基定理](@entry_id:276059)：证明平面性

证明一个图是平面的挑战更大，因为它要求我们证明某种结构**不存在**。幸运的是，我们可以利用一些强大的排除法。

#### 基于顶点数量的论证

最简单的论证是基于顶点数量。一个 $K_5$ 的细分至少需要 5 个顶点（当没有边被细分时），而一个 $K_{3,3}$ 的细分至少需要 6 个顶点。因此，任何顶点数小于 5 的图，都不可能包含 $K_5$ 或 $K_{3,3}$ 的细分。由此我们得出一个直接的推论：任何顶点数不多于 4 的简单图都必然是平面的 [@problem_id:1517517]。这也解释了为什么从 $K_5$ 中移除任意一个顶点后，得到的图（即 $K_4$）是平面的 [@problem_id:1517494]。

更进一步，一个[非平面图](@entry_id:268333)若不包含 $K_5$ 的细分，根据[库拉托夫斯基定理](@entry_id:276059)，它必须包含一个 $K_{3,3}$ 的细分。由于 $K_{3,3}$ 的细分至少需要 6 个顶点，这意味着该图的顶点数至少为 6。而 $K_{3,3}$ 本身就是一个满足这些条件的例子，它有 6 个顶点，是非平面的，且不包含 $K_5$ 的细分。因此，一个不含 $K_5$ 细分的[非平面图](@entry_id:268333)，其最小顶点数就是 6 [@problem_id:1517543]。

#### 基于顶点度的论证

一个更精细的工具是分析顶点的度数。
-   $K_5$ 的细分需要 5 个分支顶点。在细分图中，这些分支顶点各自的度数均为 4。因此，任何包含 $K_5$ 细分的图，必须至少有 5 个度数不小于 4 的顶点。
-   $K_{3,3}$ 的细分需要 6 个分支顶点，每个分支顶点的度数均为 3。因此，任何包含 $K_{3,3}$ 细分的图，必须至少有 6 个度数不小于 3 的顶点。

这个性质是证明[平面性](@entry_id:274781)的有力武器。例如，考虑从 $K_{3,3}$ 中移除任意一条边 $e$ 得到的图 $G = K_{3,3} - e$。在 $K_{3,3}$ 中，所有 6 个[顶点的度](@entry_id:264944)数都是 3。删除一条边后，该边两个端点的度数降为 2，其余 4 个顶点的度数仍为 3。因此，图 $G$ 中只有 4 个度数不小于 3 的顶点。这个数量不足以构成一个 $K_{3,3}$ 细分所需的 6 个分支顶点。同时，图 $G$ 的[最大度](@entry_id:265573)数为 3，也显然无法满足 $K_5$ 细分对度数的要求。因此，根据[库拉托夫斯基定理](@entry_id:276059)，$G$ 必定是平面的 [@problem_id:1517524]。这个例子也说明 $K_{3,3}$ 是一个**边临界[非平面图](@entry_id:268333)**，即它本身非平面，但移除任何一条边都会使其变为[平面图](@entry_id:269787)。

同样地，对于一个给定的图，我们可以先计算其所有顶点的度数。如果度数不小于 4 的顶点少于 5 个，并且度数不小于 3 的顶点少于 6 个，那么我们就可以断定该图不可能包含任何库拉托夫斯基[子图](@entry_id:273342)，从而证明它是平面的 [@problem_id:1517531]。

### 细分与图的收缩：一个重要的区别

在图论中，除了细分，还有一个相关的概念叫**图的收缩**（graph minor）。通过一系列的删点、删边和**[边收缩](@entry_id:265581)**（edge contraction，即合并一条边的两个端点为一个新顶点）操作从图 $G$ 得到的图 $H$，称为 $G$ 的一个收缩。

一个图的细分是其收缩的一种特殊情况（也称为拓扑收缩），但反之不成立。这意味着，一个图可能包含 $K_5$ 作为收缩，但不包含 $K_5$ 的细分。

考虑一个由 6 个顶点组成的图 $G$。其中四个顶点 $v_1, v_2, v_3, v_4$ 构成一个 $K_4$。另外两个顶点 $v_5, v_6$ 相连，且 $v_5$ 连接到 $v_1, v_2$，$v_6$ 连接到 $v_3, v_4$。如果我们收缩边 $(v_5, v_6)$，将它们合并成一个新顶点 $x$，那么 $x$ 将会连接到 $v_1, v_2, v_3, v_4$。这样，新图就包含了由 $x, v_1, v_2, v_3, v_4$ 组成的 $K_5$。所以，$G$ 包含一个 $K_5$ 收缩。

然而，我们来分析 $G$ 是否包含 $K_5$ 的细分。首先计算 $G$ 中各[顶点的度](@entry_id:264944)数，可以发现只有 $v_1, v_2, v_3, v_4$ 的度数是 4，而 $v_5, v_6$ 的度数是 3。如前所述，$K_5$ 的细分需要 5 个度数至少为 4 的分支顶点。由于 $G$ 中只有 4 个这样的顶点，它不可能包含 $K_5$ 的细分 [@problem_id:1517538]。

这个例子清晰地揭示了“包含一个 $K_5$ 细分”和“包含一个 $K_5$ 收缩”是两个不同的条件。[库拉托夫斯基定理](@entry_id:276059)使用的是细分，而另一个与之相关的[瓦格纳定理](@entry_id:267584)（Wagner's Theorem）则使用收缩来刻画[平面性](@entry_id:274781)。

### 库拉托夫斯基[子图](@entry_id:273342)与其他平面性判据

在学习平面图的初期，我们通常会接触到一个关于边数的必要条件：对于任何顶点数 $V \ge 3$ 的简单[平面图](@entry_id:269787)，其边数 $E$ 必须满足 $E \le 3V - 6$。这个不等式非常有用，因为违反它的图（例如 $K_5$，其中 $E=10, V=5$，而 $3V-6=9$）可以立即被判定为非平面。

然而，满足这个不等式并**不能**保证图是平面的。换言之，它是[平面性](@entry_id:274781)的**必要条件**，但**非充分条件**。$K_{3,3}$ 就是一个绝佳的反例。对于 $K_{3,3}$，$V=6, E=9$。代入不等式，我们得到 $9 \le 3(6) - 6 = 12$。不等式成立，但我们已经知道 $K_{3,3}$ 是非平面的 [@problem_id:1517530]。这表明，仅靠计算顶点和边的数量不足以完全判定[平面性](@entry_id:274781)，而必须依赖于像[库拉托夫斯基定理](@entry_id:276059)这样更深刻的结构性判据。

总之，[库拉托夫斯基定理](@entry_id:276059)通过“禁止的子结构”——$K_5$ 和 $K_{3,3}$ 的细分——为我们提供了一个关于[平面性](@entry_id:274781)的完整理论框架。掌握如何识别这些结构，以及如何论证它们的不存在，是深入理解图的[平面性](@entry_id:274781)及其在各类应用中重要性的关键。