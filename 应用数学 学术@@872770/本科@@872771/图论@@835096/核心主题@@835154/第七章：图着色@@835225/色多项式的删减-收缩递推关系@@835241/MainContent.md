## 引言
图着色是[图论](@entry_id:140799)中最基本也最引人入胜的问题之一，其核心在于探究用一组给定的颜色为图的[顶点着色](@entry_id:267488)，使得任意两个相邻顶点颜色均不相同的方法。描述这一过程的数学对象是[色多项式](@entry_id:267269) $\chi_G(k)$，它表示用 $k$ 种颜色对图 $G$ 进行正常着色的总方法数。然而，随着图的规模和复杂性增加，直接通过[组合计数](@entry_id:141086)来确定[色多项式](@entry_id:267269)变得极其困难甚至不切实际，这形成了一个关键的知识缺口。

为了系统性地解决这一计算难题，数学家们发展出了[删减-收缩递推](@entry_id:272213)关系（Deletion-Contraction Recurrence）。这一强大的工具通过将一个复杂图的[色多项式](@entry_id:267269)与两个边数更少的、结构更简单的图的[色多项式](@entry_id:267269)联系起来，从而提供了一种优雅的[递归算法](@entry_id:636816)。本文将围绕这一核心递推关系展开，带领读者全面掌握其理论与实践。

在“原理与机制”一章中，我们将详细推导[删减-收缩公式](@entry_id:261883)，阐明其背后的组合逻辑，并展示如何利用它进行递归计算，同时揭示其蕴含的深刻代数性质。接下来，在“应用与跨学科联系”一章，我们将探索该递推关系如何成为一座桥梁，连接[图论](@entry_id:140799)内部的其他分支以及代数组合学、统计物理等领域，展示其广泛的适用性。最后，在“动手实践”部分，你将通过一系列精心设计的练习，亲手应用所学知识，巩固对这一关键方法的理解。

## 原理与机制

继引言部分对[图着色问题](@entry_id:263322)与[色多项式](@entry_id:267269)进行了初步介绍之后，本章将深入探讨计算[色多项式](@entry_id:267269)的核心工具——[删减-收缩递推](@entry_id:272213)关系。[色多项式](@entry_id:267269) $\chi_G(k)$ 定义为对一个图 $G$ 进行正常 $k$-着色的方法数。尽管对于一些简单的图，我们可以通过直接计数来确定其[色多项式](@entry_id:267269)，但随着图的结构日趋复杂，这种方法很快会变得不切实际。[删减-收缩递推](@entry_id:272213)关系提供了一种系统性的、基于递归的强大算法，它通过将一个[图分解](@entry_id:270506)为结构上更简单的图，从而使[色多项式](@entry_id:267269)的计算成为可能。本章不仅将推导并阐释这一基本关系，还将展示如何运用它来计算具体的[色多项式](@entry_id:267269)，并揭示[色多项式](@entry_id:267269)本身所蕴含的一系列深刻的代数性质。

### [删减-收缩递推](@entry_id:272213)关系式

[删减-收缩递推](@entry_id:272213)关系的核心思想是建立一个图的[色多项式](@entry_id:267269)与其两个简化版本之间的联系。这两个简化版本是通过对原图的一条边进行“删除”或“收缩”操作得到的。这个关系式的推导过程本身就是一个优美的[组合论证](@entry_id:266316)。

考虑一个简单图 $G=(V, E)$ 和其中的任意一条边 $e = \{u, v\}$。我们的目标是建立 $\chi_G(k)$、$\chi_{G-e}(k)$ 和 $\chi_{G \cdot e}(k)$ 之间的关系。

首先，我们定义这两个新图：
1.  **删边图 (Edge Deletion)** $G-e$：这个图是通过从图 $G$ 中简单地移除边 $e$ 得到的。它的顶点集与 $G$ 相同，[边集](@entry_id:267160)为 $E \setminus \{e\}$。
2.  **缩边图 (Edge Contraction)** $G \cdot e$：这个图是通过将边 $e$ 的两个端点 $u$ 和 $v$ “合并”成一个单一的新顶点 $w$ 而形成的。所有曾经连接到 $u$ 或 $v$ 的边现在都连接到这个新顶点 $w$。如果这个过程产生了[多重边](@entry_id:273920)，通常我们将它们合并为一条单边（因为我们主要处理简单图的着色问题）。

推导的关键在于考察图 $G-e$ 的所有正常 $k$-着色。根据定义，这样的着色总数是 $\chi_{G-e}(k)$。我们可以将这些着色划分为两个互不相交的集合 [@problem_id:1495903]：

**集合 1：对 $u$ 和 $v$ 使用不同颜色的着色。**
一个对 $G-e$ 的正常 $k$-着色，如果为顶点 $u$ 和 $v$ 分配了不同的颜色，那么这个着色方案对于原图 $G$ 也是一个正常的 $k$-着色。这是因为在 $G-e$ 中，除了 $u$ 和 $v$ 之外，所有相邻顶点都具有不同颜色。而由于 $u$ 和 $v$ 的颜色也不同，当我们将边 $e$ 添加回去形成 $G$ 时，邻接关系 $e=\{u, v\}$ 的约束也被满足了。反之，任何一个 $G$ 的正常 $k$-着色，必然满足 $u$ 和 $v$ 的颜色不同，因此它也是 $G-e$ 的一个正常 $k$-着色。由此可见，这类着色的数量恰好等于 $G$ 的正常 $k$-着[色数](@entry_id:274073)，即 $\chi_G(k)$。

**集合 2：对 $u$ 和 $v$ 使用相同颜色的着色。**
一个对 $G-e$ 的正常 $k$-着色，如果为顶点 $u$ 和 $v$ 分配了相同的颜色，那么这个着色方案与缩边图 $G \cdot e$ 的正常 $k$-着色之间存在一一对应的关系。我们可以将 $u$ 和 $v$ 的共同颜色赋给 $G \cdot e$ 中的合并顶点 $w$，而所有其他顶点的颜色保持不变。由于在 $G-e$ 的着色中，任何与 $u$ 或 $v$ 相邻的顶点的颜色都不同于 $u$ 和 $v$ 的共同颜色，因此在 $G \cdot e$ 中，任何与 $w$ 相邻的顶点的颜色也都不同于 $w$ 的颜色。这个对应关系是双向的。因此，这类着色的数量等于 $G \cdot e$ 的正常 $k$-着[色数](@entry_id:274073)，即 $\chi_{G \cdot e}(k)$。

由于这两个集合构成了对 $G-e$ 所有正常 $k$-着色的一个划分，我们可以得到：
$$
\chi_{G-e}(k) = \chi_G(k) + \chi_{G \cdot e}(k)
$$

通过移项，我们便得到了**[删减-收缩递推](@entry_id:272213)公式 (deletion-contraction recurrence)** 的[标准形式](@entry_id:153058)：
$$
\chi_G(k) = \chi_{G-e}(k) - \chi_{G \cdot e}(k)
$$

这个公式是计算色[多项式的基](@entry_id:148579)石。它表明，任何图的[色多项式](@entry_id:267269)都可以表示为两个在结构上更简单的图（具体来说，是边数更少的图）的[色多项式](@entry_id:267269)的差。当然，这个公式也可以写成另一种形式 $\chi_{G-e}(k) = \chi_G(k) + \chi_{G \cdot e}(k)$ [@problem_id:1495951]，这在某些理论推导或已知部分多项式求解未知多项式时非常有用。

### 递推计算的应用

[删减-收缩递推](@entry_id:272213)公式的强大之处在于它为计算任意图的[色多项式](@entry_id:267269)提供了一个[递归算法](@entry_id:636816)。该算法的流程如下：

1.  如果图 $G$ 有边，选择其中任意一条边 $e$。
2.  应用[递推公式](@entry_id:149465) $\chi_G(k) = \chi_{G-e}(k) - \chi_{G \cdot e}(k)$。
3.  对新产生的图 $G-e$ 和 $G \cdot e$ 重复此过程。
4.  继续递归分解，直到所有图都成为没有边的图。

这个过程必然会终止，因为每次应用递推，我们都会得到边数更少的图。那么，递归的**基准情形 (base case)** 是什么呢？当一个图不再含有任何边时，我们称之为[空图](@entry_id:275064)（或无边图）。对于一个拥有 $n$ 个顶点但没有边的[空图](@entry_id:275064) $N_n$，着色时没有任何邻接约束。因此，它的 $n$ 个顶点中的每一个都可以独立地从 $k$ 种颜色中任意选择一种。根据[乘法原理](@entry_id:273377)，总的着色方法数为 $k \times k \times \dots \times k$（共 $n$ 次），即 [@problem_id:1495915]：
$$
\chi_{N_n}(k) = k^n
$$
这就是递归的终点。整个计算过程就是将一个复杂的图不断分解，最终表示为一系列[空图](@entry_id:275064)[色多项式](@entry_id:267269)的[线性组合](@entry_id:154743)。

我们通过一个具体的例子来演示这个过程。考虑一个4个顶点的[路径图](@entry_id:274599) $P_4$，其顶点为 $v_1, v_2, v_3, v_4$，边为 $e_1=\{v_1, v_2\}, e_2=\{v_2, v_3\}, e_3=\{v_3, v_4\}$。我们可以选择任意一条边开始递推，例如中间的边 $e_2$ [@problem_id:1495943]。
$$
\chi_{P_4}(k) = \chi_{P_4 - e_2}(k) - \chi_{P_4 \cdot e_2}(k)
$$
现在我们分别分析右侧的两项：
- **$P_4 - e_2$**: 删除边 $e_2$ 后，图断开为两个不相连的部分，每部分都是一个只有一条边的图（即 $P_2$）。对于不相交[图的并](@entry_id:267788)，其[色多项式](@entry_id:267269)是各部分[色多项式](@entry_id:267269)的乘积。一个 $P_2$ 的[色多项式](@entry_id:267269)是 $k(k-1)$。因此，$\chi_{P_4 - e_2}(k) = \chi_{P_2}(k) \times \chi_{P_2}(k) = [k(k-1)]^2 = k^2(k-1)^2$。
- **$P_4 \cdot e_2$**: 收缩边 $e_2$ 会将 $v_2$ 和 $v_3$ 合并成一个新顶点。结果图的结构是一个3顶点的路径图 $P_3$。$P_3$ 的[色多项式](@entry_id:267269)可以通过直接计数得到：为端点选色有 $k$ 种方式，中间点有 $k-1$ 种，另一个端点也有 $k-1$ 种，所以 $\chi_{P_3}(k) = k(k-1)^2$。

将这两部分代回原式：
$$
\chi_{P_4}(k) = k^2(k-1)^2 - k(k-1)^2 = (k^2 - k)(k-1)^2 = k(k-1)(k-1)^2 = k(k-1)^3
$$
展开后得到 $\chi_{P_4}(k) = k(k^3 - 3k^2 + 3k - 1) = k^4 - 3k^3 + 3k^2 - k$。值得强调的是，无论我们最初选择哪条边进行递推，最终得到的[色多项式](@entry_id:267269)都是相同的。这是[色多项式](@entry_id:267269)作为[图不变量](@entry_id:262729)的一个基本性质。

在实践中，除了严格的递推，我们也可以结合使用其他图的性质来简化计算。例如，如果图 $G$ 有一个叶顶点 $u$（度为1的顶点），且它仅与顶点 $w$ 相连，那么在为 $G-u$ 进行任意一种正常着色后，顶点 $u$ 都有 $k-1$ 种颜色选择（任何不同于 $w$ 颜色的颜色）。因此，我们有快捷公式 $\chi_G(k) = (k-1)\chi_{G-u}(k)$ [@problem_id:1495926]。

### 揭示[色多项式的性质](@entry_id:271514)

[删减-收缩递推](@entry_id:272213)不仅是一种计算工具，更是一种强大的理论武器，能够用来证明关于[色多项式](@entry_id:267269)的一系列普适性质。这些性质揭示了[色多项式](@entry_id:267269)在[代数结构](@entry_id:137052)上的深刻规律。

**度数与首项系数**
对于任何具有 $n$ 个顶点和 $m$ 条边的[简单图](@entry_id:274882) $G$，其[色多项式](@entry_id:267269) $\chi_G(k)$ 是一个关于 $k$ 的 $n$ 次多项式，且其首项系数（$k^n$ 的系数）总是1。我们可以通过对边数 $m$ 进行归纳来证明这一点 [@problem_id:1495957]。
- **基准情形 ($m=0$)**: 图是[空图](@entry_id:275064) $N_n$，$\chi_{N_n}(k) = k^n$。结论成立。
- **[归纳步骤](@entry_id:144594)**: 假设对于任何边数小于 $m$ 的 $n$ 顶点图，结论成立。考虑一个有 $m$ 条边的图 $G$。根据递推式 $\chi_G(k) = \chi_{G-e}(k) - \chi_{G \cdot e}(k)$，图 $G-e$ 有 $n$ 个顶点和 $m-1$ 条边，根据[归纳假设](@entry_id:139767)，$\chi_{G-e}(k)$ 的最高次项是 $k^n$。而图 $G \cdot e$ 只有 $n-1$ 个顶点，因此其[色多项式](@entry_id:267269) $\chi_{G \cdot e}(k)$ 的次数最多为 $n-1$。这意味着 $\chi_G(k)$ 的 $k^n$ 项完全由 $\chi_{G-e}(k)$ 决定，因此其系数为1。

**次高项系数**
对于一个有 $n$ 个顶点和 $m$ 条边的简单图 $G$，其[色多项式](@entry_id:267269)中 $k^{n-1}$ 项的系数等于 $-m$。这个性质同样可以用[删减-收缩递推](@entry_id:272213)进行归纳证明 [@problem_id:1495925]。
- **基准情形 ($m=0$)**: $\chi_{N_n}(k)=k^n$，$k^{n-1}$ 的系数为0，等于 $-m$。结论成立。
- **[归纳步骤](@entry_id:144594)**: 设 $a_{n-1}(H)$ 表示图 $H$ 的[色多项式](@entry_id:267269)中 $k^{|V(H)|-1}$ 的系数。我们有 $a_n(G) = 1$ 且 $\chi_G(k) = k^n + a_{n-1}(G)k^{n-1} + \dots$。根据递推式，$\chi_G(k) = \chi_{G-e}(k) - \chi_{G \cdot e}(k)$。比较 $k^{n-1}$ 的系数：
$$
a_{n-1}(G) = a_{n-1}(G-e) - (\chi_{G \cdot e}(k) \text{ 中 } k^{n-1} \text{ 的系数})
$$
根据[归纳假设](@entry_id:139767)，$a_{n-1}(G-e) = -(m-1)$。对于 $G \cdot e$，它有 $n-1$ 个顶点，其[色多项式](@entry_id:267269)的最高次项是 $k^{n-1}$，且首项系数为1。因此，$\chi_{G \cdot e}(k)$ 中 $k^{n-1}$ 的系数为1。代入上式，得到 $a_{n-1}(G) = -(m-1) - 1 = -m$。例如，一个由 $K_4$ 和 $P_3$ 通过一条边连接成的图，其顶点数 $n=7$，边数 $m = \binom{4}{2} + 2 + 1 = 9$。其[色多项式](@entry_id:267269)中 $k^6$ 的系数必为 $-9$。

**常数项**
对于任何非[空图](@entry_id:275064) $G$（即至少有一个顶点的图），其[色多项式](@entry_id:267269) $\chi_G(k)$ 的常数项为0。这意味着 $\chi_G(0) = 0$。从组合意义上讲，这是显而易见的：用0种颜色无法对一个非[空图](@entry_id:275064)进行正常着色。这个性质也可以通过对边数 $m$ 的归纳和递推关系轻松证明 [@problem_id:1495949]。
- **基准情形**: 对于有一个或多个顶点但没有边的图 $N_n$ ($n \ge 1$)，$\chi_{N_n}(k) = k^n$，因此 $\chi_{N_n}(0)=0$。
- **[归纳步骤](@entry_id:144594)**: 假设所有边数小于 $m$ 的非[空图](@entry_id:275064)的[色多项式](@entry_id:267269)在 $k=0$ 时取值为0。对于一个有 $m$ 条边的图 $G$，我们有 $\chi_G(0) = \chi_{G-e}(0) - \chi_{G \cdot e}(0)$。由于 $G-e$ 和 $G \cdot e$ 都是边数小于 $m$ 的非[空图](@entry_id:275064)，根据[归纳假设](@entry_id:139767)，$\chi_{G-e}(0)=0$ 和 $\chi_{G \cdot e}(0)=0$。因此，$\chi_G(0) = 0 - 0 = 0$。

**系数的符号交错**
[色多项式](@entry_id:267269)的系数具有一个显著的模式：它们正负交替出现。如果 $\chi_G(k) = \sum_{i=0}^{n} a_i k^i$，那么系数序列 $a_n, a_{n-1}, a_{n-2}, \dots, a_1$ 的符号为 $+,-,+, \dots$。也就是说，$(-1)^{n-i}a_i \ge 0$ 对于 $i=1, \dots, n$ 成立。这个性质同样可以通过对边数 $m$ 的归纳来证明。在递推式 $\chi_G(k) = \chi_{G-e}(k) - \chi_{G \cdot e}(k)$ 中，如果 $\chi_{G-e}(k)$ 和 $\chi_{G \cdot e}(k)$ 都满足符号交错性质，那么由于 $\chi_{G \cdot e}(k)$ 的次数较低，它在与 $\chi_{G-e}(k)$ 相减时不会破坏高次项的符号模式，并且可以被证明会维持整个多项式的符号交错规律。例如，一个由两个三角形通过一条边连接构成的图，其[色多项式](@entry_id:267269)为 $\chi_G(k) = k^6 - 7k^5 + 19k^4 - 25k^3 + 16k^2 - 4k$，系数符号完美地呈现了 $+,-,+,-,+, -$ 的交错模式 [@problem_id:1495921]。

**[色数](@entry_id:274073)**
[色多项式](@entry_id:267269)与图论中的一个核心概念——**[色数](@entry_id:274073) (chromatic number)** $\chi(G)$ 密切相关。[色数](@entry_id:274073)定义为对图 $G$ 进行正常着色所需的最少颜色数。从[色多项式](@entry_id:267269)的定义来看，$\chi_G(k)$ 是一个计数函数，当 $k$ 小于 $\chi(G)$ 时，无法完成正常着色，此时 $\chi_G(k)=0$。当 $k \ge \chi(G)$ 时，至少存在一种正常着色方案，因此 $\chi_G(k) > 0$。所以，一个图的色数可以从其[色多项式](@entry_id:267269)中确定 [@problem_id:1495897]：
$$
\chi(G) = \min \{ k \in \mathbb{Z}^+ \mid \chi_G(k) > 0 \}
$$
这等价于找到大于0的最小整数根。例如，对于从完全图 $K_5$ 中移除一条边得到的图 $G = K_5 - e$，其[色多项式](@entry_id:267269)可以通过 $\chi_G(k) = \chi_{K_5-e}(k) = \chi_{K_5}(k) + \chi_{K_4}(k)$ 计算得出，结果为 $\chi_G(k) = k(k-1)(k-2)(k-3)^2$。这个多项式的正整数根为1, 2, 3。因此，当 $k=1, 2, 3$ 时，$\chi_G(k)=0$。第一个使得 $\chi_G(k)>0$ 的正整数是 $k=4$。因此，该图的色数 $\chi(G)=4$。

综上所述，[删减-收缩递推](@entry_id:272213)关系不仅是计算[色多项式](@entry_id:267269)的算法基础，更是理解其[代数结构](@entry_id:137052)和组合意义的钥匙。它将一个复杂的计数问题转化为一个递归过程，并在此过程中揭示了[多项式系数](@entry_id:262287)与图的基本参数（如顶点数和边数）之间的深刻联系。这一思想也为更广义的[图不变量](@entry_id:262729)（如图特多项式 Tutte polynomial）的研究奠定了基础。