{"hands_on_practices": [{"introduction": "要让计算机处理图，我们首先需要一种形式化的方式来描述它。邻接表是一种基础且高效的图表示方法，它为每个顶点列出了其所有邻居。这个练习 [@problem_id:1509949] 将帮助你将网格图的直观几何概念转化为严谨的数据结构，这是进行任何算法分析的第一步。", "problem": "在图论中，一个 $m \\times n$ 网格图，记为 $G_{m,n}$，是一个图，其顶点集 $V$ 可以由整数坐标对 $(i,j)$ 的集合来表示，其中 $1 \\le i \\le m$ 且 $1 \\le j \\le n$。两个顶点 $(i,j)$ 和 $(i',j')$ 之间存在一条边，当且仅当它们在网格中相邻，这意味着它们的曼哈顿距离为 1，即 $|i - i'| + |j - j'| = 1$。\n\n邻接表是表示图的一种常用方法。对于每个顶点，它存储一个其相邻顶点的列表。\n\n你的任务是确定网格图 $G_{2,4}$ 的正确邻接表表示。该表示必须遵循以下特定的格式规则：\n1.  表示形式为单个文本字符串。\n2.  每个顶点的邻接表格式为 `(i,j):[neighbor1, neighbor2, ...]`。\n3.  8个顶点的条目按顶点坐标的字典序排列。例如，$(1,2)$ 的条目在 $(1,1)$ 之后，但在 $(2,1)$ 之前。\n4.  条目之间用分号后跟一个空格（`; `）分隔。\n5.  在每个列表中，相邻顶点也必须按字典序排序。\n\n以下哪个选项代表了 $G_{2,4}$ 的正确邻接表？\n\nA. `(1,1):[(1,2),(2,1)]; (1,2):[(1,1),(1,3),(2,2)]; (1,3):[(1,2),(1,4),(2,3)]; (1,4):[(1,3),(2,4)]; (2,1):[(1,1),(2,2)]; (2,2):[(1,2),(2,1),(2,3)]; (2,3):[(1,3),(2,2),(2,4)]; (2,4):[(1,4),(2,3)]`\n\nB. `(1,1):[(1,2),(2,1)]; (1,2):[(1,1),(1,3)]; (1,3):[(1,2),(1,4),(2,3)]; (1,4):[(1,3),(2,4)]; (2,1):[(1,1),(2,2)]; (2,2):[(1,2),(2,3)]; (2,3):[(1,3),(2,2),(2,4)]; (2,4):[(1,4),(2,3)]`\n\nC. `(1,1):[(1,2),(2,1),(2,2)]; (1,2):[(1,1),(1,3),(2,2)]; (1,3):[(1,2),(1,4),(2,3)]; (1,4):[(1,3),(2,4)]; (2,1):[(1,1),(2,2)]; (2,2):[(1,1),(1,2),(2,1),(2,3)]; (2,3):[(1,3),(2,2),(2,4)]; (2,4):[(1,4),(2,3)]`\n\nD. `(1,1):[(1,2),(2,1)]; (1,2):[(1,1),(2,2)]; (2,1):[(1,1),(2,2),(3,1)]; (2,2):[(1,2),(2,1),(3,2)]; (3,1):[(2,1),(3,2),(4,1)]; (3,2):[(2,2),(3,1),(4,2)]; (4,1):[(3,1),(4,2)]; (4,2):[(3,2),(4,1)]`\n\nE. `(1,1):[(1,2),(1,4),(2,1)]; (1,2):[(1,1),(1,3),(2,2)]; (1,3):[(1,2),(1,4),(2,3)]; (1,4):[(1,1),(1,3),(2,4)]; (2,1):[(1,1),(2,2)]; (2,2):[(1,2),(2,1),(2,3)]; (2,3):[(1,3),(2,2),(2,4)]; (2,4):[(1,4),(2,3)]`", "solution": "根据定义，$G_{2,4}$ 的顶点集为 $V=\\{(i,j)\\,:\\,1\\leq i\\leq 2,\\ 1\\leq j\\leq 4\\}$，即 $\\{(1,1),(1,2),(1,3),(1,4),(2,1),(2,2),(2,3),(2,4)\\}$（按字典序排列）。两个顶点 $(i,j)$ 和 $(i',j')$ 相邻，当且仅当它们的曼哈顿距离为 $|i-i'|+|j-j'|=1$。\n\n我们为每个顶点确定其邻居：\n- 对于 $(1,1)$：邻居是 $(1,2)$ 和 $(2,1)$。\n- 对于 $(1,2)$：邻居是 $(1,1)$, $(1,3)$ 和 $(2,2)$。\n- 对于 $(1,3)$：邻居是 $(1,2)$, $(1,4)$ 和 $(2,3)$。\n- 对于 $(1,4)$：邻居是 $(1,3)$ 和 $(2,4)$。\n- 对于 $(2,1)$：邻居是 $(1,1)$ 和 $(2,2)$。\n- 对于 $(2,2)$：邻居是 $(1,2)$, $(2,1)$ 和 $(2,3)$。\n- 对于 $(2,3)$：邻居是 $(1,3)$, $(2,2)$ 和 $(2,4)$。\n- 对于 $(2,4)$：邻居是 $(1,4)$ 和 $(2,3)$。\n\n将邻接表条目按顶点字典序排列，并且每个邻居列表也按字典序排序，我们得到：\n(1,1):[(1,2),(2,1)]; (1,2):[(1,1),(1,3),(2,2)]; (1,3):[(1,2),(1,4),(2,3)]; (1,4):[(1,3),(2,4)]; (2,1):[(1,1),(2,2)]; (2,2):[(1,2),(2,1),(2,3)]; (2,3):[(1,3),(2,2),(2,4)]; (2,4):[(1,4),(2,3)]。\n\n这与选项 A 完全匹配。\n- 选项 B 错误，因为它遗漏了边，例如，顶点 $(1,2)$ 的邻居列表缺少 $(2,2)$。\n- 选项 C 错误，因为它包含了非法的对角线边，例如，顶点 $(1,1)$ 的邻居列表包含了不相邻的 $(2,2)$。\n- 选项 D 错误，因为它描述的是一个 $G_{4,2}$ 网格，而不是 $G_{2,4}$。\n- 选项 E 错误，因为它包含了环绕边（形成环面网格），例如，顶点 $(1,1)$ 的邻居列表包含了不相邻的 $(1,4)$。\n\n因此，选项 A 是唯一正确的表示。", "answer": "$$\\boxed{A}$$", "id": "1509949"}, {"introduction": "从表示转向分析，我们来探讨网格图的一个核心遍历问题。这个问题 [@problem_id:1509922] 以一个生动的机器人巡逻场景为背景，引导我们思考一个经典图论概念：欧拉路径。通过解决这个问题，你将学会如何将网格的几何特性（如角落、边界和内部顶点）与其顶点的度数联系起来，这是判断图是否可以一次性走完所有路径的关键。", "problem": "一个机器人保安被设计用于在一个现代化的单层研究设施的走廊网络中巡逻。走廊的布局形成一个完美的矩形网格。这个网格可以被建模为一个图 $G_{m,n}$，其中走廊的交叉口是顶点，走廊本身是边。该网格有 $m$ 行和 $n$ 列交叉口，其中 $m$ 和 $n$ 是正整数。\n\n为了完成一次完整的安全巡查，机器人必须沿着每一条走廊恰好走一次。机器人可以从任何一个交叉口开始，并在任何一个交叉口结束（不一定是同一个）。你的任务是确定网格的尺寸 $m$ 和 $n$ 在什么条件下，这样的巡逻是可能的。\n\n以下关于正整数 $m$ 和 $n$ 的条件中，哪一个正确且完整地描述了网格图 $G_{m,n}$ 允许进行这样巡逻的所有情况？\n\nA. 尺寸的乘积 $mn$ 是一个偶数。\nB. 尺寸 $m$ 和 $n$ 都是偶数。\nC. 至少有一个尺寸 $m$ 或 $n$ 小于或等于 2。\nD. 尺寸 $m$ 和 $n$ 都是奇数。\nE. 要么至少有一个尺寸是 1，要么尺寸对 $\\{m, n\\}$ 是 $\\{2, 2\\}$ 或 $\\{2, 3\\}$ 中的一个。", "solution": "我们将走廊网络建模为无向网格图 $G_{m,n}$，它有 $m$ 行和 $n$ 列顶点，水平和垂直相邻的顶点之间有边。一次恰好遍历每条边一次的路径称为欧拉路径（Euler path）或欧拉迹（Euler trail）。对于一个连通的无向图，存在欧拉路径的充要条件是图中奇数度顶点的数量恰好为 0 或 2。\n\n首先，分析 $G_{m,n}$ 中顶点的度数：\n- 内部顶点（坐标 $(i,j)$ 满足 $1<i<m, 1<j<n$）的度数为 4（偶数）。\n- 角顶点（例如 $(1,1)$）的度数为 2（偶数），前提是 $m,n>1$。\n- 非角的边界顶点（例如 $(1,j)$ 其中 $1<j<n$）的度数为 3（奇数）。\n\n我们需要计算奇数度顶点的数量。\n- 如果 $m=1, n=1$，图只有一个顶点，度为0。奇数度顶点数量为 0。存在欧拉路径（平凡情况）。\n- 如果 $m=1, n>1$（或 $n=1, m>1$），图是一条路径。它有两个度为 1 的端点（奇数度）和 $n-2$ 个度为 2 的内部顶点（偶数度）。奇数度顶点数量为 2。存在欧拉路径。\n- 如果 $m,n \\ge 2$，奇数度顶点的数量就等于非角边界顶点的数量。总共有 $2(m-2) + 2(n-2) = 2(m+n-4)$ 个这样的顶点。\n\n为了存在欧拉路径，我们需要奇数度顶点的数量为 0 或 2。\n- 奇数度顶点数量 = 0：$2(m+n-4) = 0 \\implies m+n=4$。由于 $m,n \\ge 2$，唯一的整数解是 $(m,n)=(2,2)$。\n- 奇数度顶点数量 = 2：$2(m+n-4) = 2 \\implies m+n-4=1 \\implies m+n=5$。由于 $m,n \\ge 2$，整数解为 $(m,n)=(2,3)$ 和 $(m,n)=(3,2)$。\n- 如果 $m,n \\ge 3$，那么 $m+n \\ge 6$，奇数度顶点数量 $2(m+n-4) \\ge 2(6-4)=4$。在这种情况下，至少有4个奇数度顶点，不存在欧拉路径。\n\n综合所有情况，欧拉路径存在的充要条件是：\n1. 至少有一个维度等于 1 (即 $m=1$ 或 $n=1$)。\n2. 尺寸对 $\\{m, n\\}$ 是 $\\{2, 2\\}$ 或 $\\{2, 3\\}$。\n\n这个条件与选项 E 完全相符。", "answer": "$$\\boxed{E}$$", "id": "1509922"}, {"introduction": "路径计数是网络路由、机器人导航和游戏设计等领域的一个基本问题。在网格图中，最短路径的数量与著名的“曼哈顿距离”密切相关。这个练习 [@problem_id:1509946] 增加了一个障碍物，将简单的计数问题提升为一个更复杂的挑战，你需要运用容斥原理来找到解决方案。这展示了如何通过将复杂问题分解为更简单的子问题来系统地解决它。", "problem": "设网格图 $G_{m,n}$ 定义在顶点集 $V = \\{(i,j) \\in \\mathbb{Z}^2 \\mid 1 \\le i \\le m, 1 \\le j \\le n\\}$ 上。两个顶点 $(i_1, j_1)$ 和 $(i_2, j_2)$ 之间有边相连，当且仅当 $|i_1 - i_2| + |j_1 - j_2| = 1$。\n\n考虑一个特定的网格图 $G_{10,12}$。从这个图中移除坐标为 $(4,5)$ 的一个内部顶点，得到一个新图 $G'$。一个顶点 $(i,j)$ 被定义为内部顶点，如果 $1 < i < 10$ 且 $1 < j < 12$。\n\n确定在修改后的图 $G'$ 中，从顶点 $(1,1)$ 到顶点 $(10,12)$ 的最短路径的不同数量。", "solution": "该问题要求计算在一个移除了一个顶点的网格中，从一个角到对角的的最短路径数量。我们采用容斥原理来解决。\n\n1.  **计算完整网格中的总最短路径数**：\n    在完整的 $G_{10,12}$ 网格中，从 $(1,1)$ 到 $(10,12)$ 的任何最短路径都只包含“向右”（增加j坐标）或“向下”（增加i坐标）的移动。\n    总的水平移动步数是 $12 - 1 = 11$ 步。\n    总的垂直移动步数是 $10 - 1 = 9$ 步。\n    因此，最短路径的总长度是 $11 + 9 = 20$ 步。\n    这相当于在一个长度为 20 的序列中，选择 9 个位置作为“向下”移动（其余 11 个为“向右”移动）。所以，总路径数由二项式系数给出：\n    $$ N_{\\text{total}} = \\binom{20}{9} $$\n\n2.  **计算经过被移除顶点的最短路径数**：\n    被移除的顶点是 $P = (4,5)$。任何经过 $P$ 的最短路径都可以被看作是从起点 $(1,1)$ 到 $P$ 的一条最短路径，然后是从 $P$ 到终点 $(10,12)$ 的一条最短路径的拼接。\n    -   从 $(1,1)$ 到 $(4,5)$ 的最短路径数：需要 $5 - 1 = 4$ 步水平移动和 $4 - 1 = 3$ 步垂直移动，总共 $4+3=7$ 步。路径数为：\n        $$ N_1 = \\binom{7}{3} $$\n    -   从 $(4,5)$ 到 $(10,12)$ 的最短路径数：需要 $12 - 5 = 7$ 步水平移动和 $10 - 4 = 6$ 步垂直移动，总共 $7+6=13$ 步。路径数为：\n        $$ N_2 = \\binom{13}{6} $$\n    经过点 $P$ 的总路径数是这两部分的乘积：\n    $$ N_{\\text{forbidden}} = N_1 \\times N_2 = \\binom{7}{3} \\binom{13}{6} $$\n\n3.  **最终计算**：\n    在修改后的图 $G'$ 中的最短路径数，就是总路径数减去经过被移除顶点的路径数：\n    $$ N_{G'} = N_{\\text{total}} - N_{\\text{forbidden}} = \\binom{20}{9} - \\binom{7}{3}\\binom{13}{6} $$\n    现在计算这些值：\n    $$ \\binom{20}{9} = \\frac{20 \\times 19 \\times \\dots \\times 12}{9!} = 167960 $$\n    $$ \\binom{7}{3} = \\frac{7 \\times 6 \\times 5}{3 \\times 2 \\times 1} = 35 $$\n    $$ \\binom{13}{6} = \\frac{13 \\times 12 \\times 11 \\times 10 \\times 9 \\times 8}{6 \\times 5 \\times 4 \\times 3 \\times 2 \\times 1} = 1716 $$\n    因此，\n    $$ N_{G'} = 167960 - 35 \\times 1716 = 167960 - 60060 = 107900 $$\n    所以，在移除了顶点 $(4,5)$ 后，从 $(1,1)$ 到 $(10,12)$ 的最短路径有 107900 条。", "answer": "$$\\boxed{107900}$$", "id": "1509946"}]}