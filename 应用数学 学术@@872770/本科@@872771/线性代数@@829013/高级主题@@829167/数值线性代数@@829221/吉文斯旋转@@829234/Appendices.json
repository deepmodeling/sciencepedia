{"hands_on_practices": [{"introduction": "Givens 旋转在数值方法中的主要优势在于它能够精确地在向量中引入零元素。这第一个练习是一个基础实践，你将构造一个 $2 \\times 2$ 的 Givens 矩阵来实现这一目标。通过解决这个问题 ([@problem_id:2176490])，你将亲手体验 Givens 旋转的核心机制，并理解如何计算其旋转参数 $c$ 和 $s$。", "problem": "在数值线性代数中，Givens 旋转是一种在二维平面中旋转向量的运算，常用于在 QR 分解等算法中将向量或矩阵中的元素置为零。一个 $2 \\times 2$ 的 Givens 矩阵是一个形为\n$$\nG = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}\n$$\n的正交矩阵，其中 $c$ 和 $s$ 是满足条件 $c^2 + s^2 = 1$ 的实数。\n\n考虑向量 $x = \\begin{pmatrix} 7 \\\\ -4 \\end{pmatrix}$。请确定一个具体的 Givens 矩阵 $G$，它将向量 $x$ 变换为一个新向量 $y = Gx$，该新向量具有形式 $\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$，并满足附加约束条件：所得分量 $r$ 必须为正。\n\n请以一个包含精确数值项的 2x2 矩阵形式给出你的答案。", "solution": "设 $G=\\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}$，其中 $c^{2}+s^{2}=1$，且 $x=\\begin{pmatrix} a \\\\ b \\end{pmatrix}$。则\n$$\nGx=\\begin{pmatrix} ca+sb \\\\ -sa+cb \\end{pmatrix}.\n$$\n为得到 $Gx=\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$，需令第二个分量为零：\n$$\n-sa+cb=0 \\quad \\Longleftrightarrow \\quad cb=sa.\n$$\n同时满足此条件和 $c^{2}+s^{2}=1$ 的一个标准选择是\n$$\nr=\\sqrt{a^{2}+b^{2}}, \\quad c=\\frac{a}{r}, \\quad s=\\frac{b}{r}.\n$$\n如此选择，\n$$\n-sa+cb=-\\frac{b}{r}a+\\frac{a}{r}b=0, \\quad ca+sb=\\frac{a^{2}+b^{2}}{r}=r,\n$$\n且由于 $r=\\sqrt{a^{2}+b^{2}}$ 为正，因此满足 $r0$ 的要求。\n\n对于 $x=\\begin{pmatrix} 7 \\\\ -4 \\end{pmatrix}$，我们有 $a=7$，$b=-4$，因此\n$$\nr=\\sqrt{7^{2}+(-4)^{2}}=\\sqrt{65}, \\quad c=\\frac{7}{\\sqrt{65}}, \\quad s=\\frac{-4}{\\sqrt{65}}.\n$$\n所以，\n$$\nG=\\begin{pmatrix} \\frac{7}{\\sqrt{65}}  \\frac{-4}{\\sqrt{65}} \\\\ \\frac{4}{\\sqrt{65}}  \\frac{7}{\\sqrt{65}} \\end{pmatrix}.\n$$\n这个 $G$ 矩阵得出 $Gx=\\begin{pmatrix} \\sqrt{65} \\\\ 0 \\end{pmatrix}$，其第一个分量为正，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{7}{\\sqrt{65}}  \\frac{-4}{\\sqrt{65}} \\\\ \\frac{4}{\\sqrt{65}}  \\frac{7}{\\sqrt{65}} \\end{pmatrix}}$$", "id": "2176490"}, {"introduction": "理解特殊情况是掌握任何工具的关键。这个练习 ([@problem_id:2176468]) 提出了一个特殊情景：一个旨在将向量某元素清零的 Givens 旋转，其结果却是单位矩阵。通过反向分析这种情况，你将深化对输入向量的几何形态与所需旋转参数之间关系的理解。", "problem": "在数值线性代数领域，Givens 旋转用于选择性地在向量和矩阵中引入零元素。一名学生正在分析一个数值程序，该程序接受一个非零的二维列向量 $\\mathbf{v} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$，并计算一个由下式给出的 Givens 旋转矩阵 $G$ 的参数 $c$ 和 $s$：\n$$\nG = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}\n$$\n此旋转的目的是将 $\\mathbf{v}$ 变换为一个其第二分量为零的向量。也就是说，选择参数 $c$ 和 $s$ 以满足以下条件：\n$$\nG \\mathbf{v} = \\begin{pmatrix} r \\\\ 0 \\end{pmatrix}\n$$\n其中 $r = \\sqrt{a^2 + b^2}$，并且参数还必须满足 $c^2 + s^2 = 1$。\n\n在用一个特定的非零输入向量 $\\mathbf{v}$ 测试该程序时，学生观察到计算出的参数恰好是 $c=1$ 和 $s=0$。\n\n以下哪个陈述完全且准确地描述了会导致这一特定结果的原始向量 $\\mathbf{v} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$？\n\nA. 向量必须形如 $\\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$，其中 $a$ 是任意非零实数。\n\nB. 向量必须形如 $\\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$，其中 $a$ 是任意正实数。\n\nC. 向量必须是零向量 $\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\nD. 向量必须形如 $\\begin{pmatrix} 0 \\\\ b \\end{pmatrix}$，其中 $b$ 是任意非零实数。\n\nE. 向量可以是任何满足 $a=-b$ 的向量。", "solution": "我们给定一个非零向量 $\\mathbf{v} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$、一个满足 $c^{2} + s^{2} = 1$ 的 Givens 矩阵 $G = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}$，以及条件\n$$\nG \\mathbf{v} = \\begin{pmatrix} r \\\\ 0 \\end{pmatrix}, \\quad r = \\sqrt{a^{2} + b^{2}}.\n$$\n观察到的参数是 $c = 1$ 和 $s = 0$。将这些值代入 $G$ 得到\n$$\nG = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n因此，\n$$\nG \\mathbf{v} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}.\n$$\n由于这必须等于 $\\begin{pmatrix} r \\\\ 0 \\end{pmatrix}$，我们得到方程组\n$$\na = r, \\quad b = 0.\n$$\n当 $b = 0$ 时，$r$ 的定义简化为\n$$\nr = \\sqrt{a^{2} + 0} = |a|.\n$$\n由 $a = r$ 和 $r = |a|$，可得\n$$\na = |a| \\quad \\Rightarrow \\quad a \\geq 0.\n$$\n因为输入向量是非零的，所以当 $b = 0$ 时，我们不能有 $a = 0$。因此\n$$\na  0, \\quad b = 0.\n$$\n因此，原始向量必须形如 $\\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$ 且 $a  0$。这与选项 B 完全对应。选项 A、C、D 和 E 在 $c = 1$ 和 $s = 0$、$r = \\sqrt{a^{2} + b^{2}}$ 以及输入向量为非零的条件下，并不满足所有推导出的条件。", "answer": "$$\\boxed{B}$$", "id": "2176468"}, {"introduction": "虽然单个 Givens 旋转在二维平面上操作，但它们的真正威力在于通过顺序应用来变换高维向量。这个最后的练习 ([@problem_id:1365884]) 挑战你从算法层面思考这个过程。你将需要设计出最高效的方法，将一个 $n$ 维向量转换为更简单的形式，这是诸如 QR 分解等高级算法中的关键一步。", "problem": "设 $x$ 是 $\\mathbb{R}^n$ 中的一个非零向量，其中 $n \\ge 2$ 是一个整数。我们希望将 $x$ 变换为一个向量 $y$，该向量是第一个标准基向量 $e_1 = (1, 0, \\dots, 0)^T$ 的标量倍。这个变换将通过应用一系列吉文斯旋转来完成。\n\n在 $\\mathbb{R}^n$ 中的一个吉文斯旋转由一个矩阵 $G(i, j, \\theta)$ 定义，其中 $1 \\le i  j \\le n$。这个矩阵与 $n \\times n$ 的单位矩阵相同，除了四个元素：\n$G_{ii} = \\cos(\\theta)$\n$G_{jj} = \\cos(\\theta)$\n$G_{ij} = -\\sin(\\theta)$\n$G_{ji} = \\sin(\\theta)$\n对于某个角度 $\\theta \\in [0, 2\\pi)$。将这个矩阵应用于一个向量，相当于在由基向量 $e_i$ 和 $e_j$ 张成的平面中进行旋转。\n\n一个包含 $k$ 次旋转的序列将 $x$ 变换为 $y$，如下所示：\n$$y = G_k G_{k-1} \\cdots G_1 x$$\n其中每个 $G_m$ 是形如 $G(i_m, j_m, \\theta_m)$ 的吉文斯旋转矩阵。\n\n考虑一个任意的非零向量 $x \\in \\mathbb{R}^n$，要保证得到的向量 $y$ 与 $e_1$ 平行，所需的最少吉文斯旋转次数是多少？在每一步中，选择在哪个平面中旋转以及旋转多大的角度都由您决定。请用 $n$ 的函数表示您的答案。", "solution": "问题要求将任意非零向量 $x \\in \\mathbb{R}^n$ 变换为与 $e_1$ 平行的向量所需的最少吉文斯旋转次数。与 $e_1$ 平行的向量必须具有 $(\\alpha, 0, 0, \\dots, 0)^T$ 的形式，其中 $\\alpha$ 是某个标量。这意味着我们需要将向量的最后 $n-1$ 个分量置零。\n\n解答包含两部分：首先，证明该变换可以使用一定数量的旋转来实现（最小值的上界），其次，论证不可能用更少的旋转次数来完成（下界）。\n\n**第一部分：构造性方法（上界）**\n\n设初始向量为 $x = (x_1, x_2, \\dots, x_n)^T$。我们希望应用一系列吉文斯旋转，使得分量 $x_2, x_3, \\dots, x_n$ 等于零。我们可以通过逐个消除分量来系统地做到这一点。一种策略是使用涉及第一个分量的平面旋转，从后往前（即 $x_n, x_{n-1}, \\dots, x_2$）将分量置零。\n\n1.  **将第 $n$ 个分量置零：**\n    让我们在 $(1, n)$ 平面中使用一个吉文斯旋转，$G_1 = G(1, n, \\theta_1)$。设 $x^{(1)} = G_1 x$。这次旋转只影响 $x$ 的第 1 个和第 $n$ 个分量。其他分量保持不变。新的第 1 和第 $n$ 个分量与旧分量的关系如下：\n    $$\n    \\begin{pmatrix} x^{(1)}_1 \\\\ x^{(1)}_n \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta_1  -\\sin\\theta_1 \\\\ \\sin\\theta_1  \\cos\\theta_1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_n \\end{pmatrix}\n    $$\n    我们希望选择 $\\theta_1$ 使得 $x^{(1)}_n = 0$。这要求 $x_1 \\sin\\theta_1 + x_n \\cos\\theta_1 = 0$。\n    如果 $x_1$ 和 $x_n$ 不都为零，我们总能找到这样的 $\\theta_1$。例如，我们可以设 $\\cos\\theta_1 = \\frac{x_1}{r}$ 和 $\\sin\\theta_1 = -\\frac{x_n}{r}$，其中 $r = \\sqrt{x_1^2 + x_n^2}$。如果 $r=0$，则 $x_1=x_n=0$，第 $n$ 个分量已经为零，因此不需要旋转（或者我们可以使用 $\\theta_1=0$）。通过这样选择 $\\theta_1$，我们得到 $x^{(1)}_n = 0$。\n    所以，经过一次旋转，我们得到向量 $x^{(1)} = (x_1', x_2, x_3, \\dots, x_{n-1}, 0)^T$。\n\n2.  **将第 $(n-1)$ 个分量置零：**\n    现在，我们对向量 $x^{(1)}$ 应用第二次吉文斯旋转，$G_2 = G(1, n-1, \\theta_2)$。设 $x^{(2)} = G_2 x^{(1)}$。这次旋转只影响 $x^{(1)}$ 的第 1 和第 $(n-1)$ 个分量。关键是，它不影响已经为零的第 $n$ 个分量。我们选择 $\\theta_2$ 使得 $x^{(2)}$ 的新第 $(n-1)$ 个分量为零。\n    经过这第二次旋转后，向量的形式为 $x^{(2)} = (x_1'', x_2, \\dots, x_{n-2}, 0, 0)^T$。\n\n3.  **一般步骤：**\n    我们继续这个过程。要将第 $j$ 个分量（对于 $j = n, n-1, \\dots, 2$）置零，我们对当前向量应用一个吉文斯旋转 $G(1, j, \\theta)$。每次这样的旋转都被选择用来将第 $j$ 个分量置零，并且它只修改第 1 和第 $j$ 个分量，而保持所有其他分量（包括那些已经被置零的分量）不变。\n\n要将从索引 2 到 $n$ 的分量置零，我们需要对 $j = n, n-1, \\dots, 2$ 执行此操作。这总共是 $n-1$ 个分量。因此，一个包含 $n-1$ 次吉文斯旋转的序列足以将任何向量 $x$ 变换为所需的形式。这证明了最少次数至多为 $n-1$。\n\n**第二部分：最小性论证（下界）**\n\n现在我们必须论证不可能用少于 $n-1$ 次旋转来保证完成该变换。让我们考虑一个 $\\mathbb{R}^n$ 中的一般向量 $x$，其所有分量 $x_i$ 都不为零。目标向量 $y = (\\alpha, 0, \\dots, 0)^T$ 有 $n-1$ 个零分量。我们的起始向量没有零分量。所以我们需要引入 $n-1$ 个零。\n\n让我们分析单次吉文斯旋转 $G(i, j, \\theta)$ 对向量 $v$ 的影响。设 $w = G(i, j, \\theta)v$。\n$w$ 的分量为 $w_k = v_k$（对于 $k \\notin \\{i, j\\}$）。这意味着如果对于这样的 $k$，$v_k \\neq 0$，那么 $w_k$ 也非零。除了位置 $i$ 和 $j$ 之外，不能在其他位置上产生新的零。\n\n分量 $w_i$ 和 $w_j$ 由以下公式给出：\n$$\nw_i = v_i \\cos\\theta - v_j \\sin\\theta\n$$\n$$\nw_j = v_i \\sin\\theta + v_j \\cos\\theta\n$$\n我们能一次产生两个零吗，即 $w_i = w_j = 0$ 是否可能？以矩阵形式表示，这是 $\\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} v_i \\\\ v_j \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。因为旋转矩阵是可逆的（其行列式为 1），该方程成立的充要条件是 $v_i = 0$ 和 $v_j = 0$。然而，我们考虑的是从非零分量开始的情况。因此，如果 $v_i, v_j$ 中至少有一个非零，我们不能使 $w_i$ 和 $w_j$ 都为零。\n\n这意味着一次吉文斯旋转最多能使向量中零分量的数量增加一。\n要将一个没有零分量的一般向量变换为一个有 $n-1$ 个零分量的向量，我们需要将零的数量从 0 增加到 $n-1$。由于每次旋转最多能使这个计数增加一，我们至少需要 $n-1$ 次旋转。\n\n这个下界适用于“最坏情况”，即向量在位置 $2, \\dots, n$ 上没有预先存在的零分量。由于问题要求的是*保证*对*任意*向量完成变换所需的最少旋转次数，我们必须为这种最坏情况做准备。\n\n**结论**\n\n我们已经证明了 $n-1$ 次旋转是足够的（第一部分），并且对于一个一般向量，至少需要 $n-1$ 次旋转是必要的（第二部分）。因此，所需的最少吉文斯旋转次数恰好是 $n-1$。", "answer": "$$\\boxed{n-1}$$", "id": "1365884"}]}