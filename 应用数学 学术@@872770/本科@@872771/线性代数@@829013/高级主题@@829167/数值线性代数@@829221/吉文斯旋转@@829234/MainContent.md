## 引言
在[数值线性代数](@entry_id:144418)领域，开发稳定且精确的算法以处理矩阵是核心挑战之一。吉文斯旋转（Givens Rotations）正是应对这一挑战的优雅而强大的工具，它通过在特定平面内进行旋转，提供了一种“外科手术式”的方法来精确改造矩阵结构，同时保持数值的稳定性。本文将系统地引导读者掌握这一工具。在“原则与机制”一章中，我们将深入其数学构造、几何本质以及选择性置零的核心工作原理。接下来的“应用与[交叉](@entry_id:147634)学科联系”一章将展示其在[QR分解](@entry_id:139154)、[特征值计算](@entry_id:145559)乃至[量子化学](@entry_id:140193)中的强大威力。最后，“动手实践”部分将通过具体问题引导您将理论付诸实践，从而将抽象概念转化为具体的计算能力。

## 原则与机制

在本章中，我们将深入探讨吉文斯旋转（Givens Rotations）的数学原理和核心机制。吉文斯旋转是数值线性代数中一种基础而强大的工具，它通过在特定坐标平面内执行旋转，为[矩阵分解](@entry_id:139760)和[特征值计算](@entry_id:145559)等算法提供了精确而稳定的操作手段。我们将从其基本定义出发，系统地阐述其几何与代数属性，并详细解析其在高维空间中选择性地将向量分量置零的关键机制。

### 吉文斯旋转的结构

从根本上说，吉文斯旋转是在一个高维空间中，选取一个由两个[标准基向量](@entry_id:152417)张成的二维[子空间](@entry_id:150286)（即一个坐标平面），并在此平面内进行旋转，而保持所有与之正交的维度不变。

#### 二维平面旋转

理解吉文斯旋转最直观的方式始于二维欧几里得平面 $\mathbb{R}^2$。一个标准的二维[旋转变换](@entry_id:200017)将任意向量 $v = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}$ 绕原点逆时针旋转角度 $\theta$，其[变换矩阵](@entry_id:151616)形式如下：

$$
G(\theta) = \begin{pmatrix} \cos(\theta) & -\sin(\theta) \\ \sin(\theta) & \cos(\theta) \end{pmatrix}
$$

这个矩阵 $G(\theta)$ 就是一个二维的吉文斯旋转矩阵。矩阵的元素由旋转角 $\theta$ 的余弦和正弦值决定。一个重要的性质是，连续进行两次旋转等价于一次旋转角度相加的旋转。例如，先后应用旋转 $G(\beta)$ 和 $G(\alpha)$，其复合效应等同于一次旋转角度为 $\alpha+\beta$ 的旋转 [@problem_id:2176525]。这可以通过矩阵乘法和[三角函数](@entry_id:178918)的和角公式验证：

$$
G(\alpha)G(\beta) = \begin{pmatrix} \cos(\alpha) & -\sin(\alpha) \\ \sin(\alpha) & \cos(\alpha) \end{pmatrix} \begin{pmatrix} \cos(\beta) & -\sin(\beta) \\ \sin(\beta) & \cos(\beta) \end{pmatrix} = \begin{pmatrix} \cos(\alpha+\beta) & -\sin(\alpha+\beta) \\ \sin(\alpha+\beta) & \cos(\alpha+\beta) \end{pmatrix} = G(\alpha+\beta)
$$

这个性质揭示了二维旋转构成一个阿贝尔群。这也直接导出了[旋转矩阵](@entry_id:140302)的逆：旋转 $-\theta$ 角即可抵消旋转 $\theta$ 角的效果，因此 $G(\theta)^{-1} = G(-\theta)$。

#### 推广至[N维空间](@entry_id:152297)

吉文斯旋转的真正威力在于它能被嵌入到任意 $n$ 维空间中。一个作用于第 $i$ 和第 $j$ 个坐标轴所张成的平面（即 $(x_i, x_j)$ 平面）的 $n \times n$ 吉文斯旋转矩阵，记作 $G(i, j, \theta)$（其中 $i  j$），其形式是一个[单位矩阵](@entry_id:156724)，仅在四个位置上有所不同。令 $c = \cos(\theta)$ 及 $s = \sin(\theta)$，则矩阵的非单位元素为：

$$
\begin{align*}
G_{ii} = c \\
G_{jj} = c \\
G_{ij} = -s \\
G_{ji} = s
\end{align*}
$$

所有其他对角线元素为 $1$，其他非对角[线元](@entry_id:196833)素为 $0$。例如，在四维空间 $\mathbb{R}^4$ 中，一个作用于第 2 和第 4 坐标平面的吉文斯旋转矩阵 $G(2, 4, \theta)$ 的具体形式为 [@problem_id:2176492]：

$$
G(2, 4, \theta) = \begin{pmatrix}
1  0  0  0 \\
0  c  0  -s \\
0  0  1  0 \\
0  s  0  c
\end{pmatrix}
$$

当这个矩阵左乘一个向量 $v \in \mathbb{R}^n$ 时，其作用是**局部化**的。只有向量的第 $i$ 和第 $j$ 个分量会发生改变，而所有其他分量都保持不变 [@problem_id:1365893]。这种精确“靶向”特定分量的能力，使得吉文斯旋转在需要逐步、精细地改造矩阵或向量结构的算法中，比其他变换（如[豪斯霍尔德变换](@entry_id:168808)）更具优势。

### 基本几何与代数性质

吉文斯旋转矩阵拥有一系列优良的性质，这些性质是其在数值计算中稳定和可靠的根本保证。

#### 正交性

吉文斯旋转矩阵是**[正交矩阵](@entry_id:169220)**。一个实方阵 $Q$ 如果满足 $Q^T Q = I$（其中 $Q^T$ 是 $Q$ 的转置，$I$ 是[单位矩阵](@entry_id:156724)），则称其为正交矩阵。对于吉文斯矩阵 $G = G(i, j, \theta)$，其非平凡部分是一个 $2 \times 2$ 旋转块 $R = \begin{pmatrix} c  -s \\ s  c \end{pmatrix}$。由于 $c^2 + s^2 = 1$，我们可以轻易验证 $R^T R = \begin{pmatrix} c  s \\ -s  c \end{pmatrix} \begin{pmatrix} c  -s \\ s  c \end{pmatrix} = \begin{pmatrix} c^2+s^2  0 \\ 0  s^2+c^2 \end{pmatrix} = \begin{pmatrix} 1  0 \\ 0  1 \end{pmatrix} = I_2$。由于 $G$ 的其余部分与单位矩阵相同，因此整个矩阵也满足 $G^T G = I$。

正交性意味着变换是“纯粹的”旋转，不包含任何缩放或剪切。这对于保持问题的几何结构至关重要 [@problem_id:2176491]。一个直接的推论是，吉文斯旋转的[逆矩阵](@entry_id:140380)就是其[转置](@entry_id:142115)矩阵，$G^{-1} = G^T$。注意到 $G(i,j,\theta)^T$ 只是将 $s$ 替换为 $-s$，这与 $G(i,j,-\theta)$ 的形式一致，再次印证了逆旋转即反向旋转的几何直觉。

#### 范数保持性

作为[正交变换](@entry_id:155650)的直接结果，吉文斯旋转保持向量的欧几里得范数（即长度）不变。对于任意向量 $x \in \mathbb{R}^n$，变换后的向量 $y = Gx$ 的范数与原[向量范数](@entry_id:140649)相同，即 $\|Gx\|_2 = \|x\|_2$。这可以从代数上证明 [@problem_id:2176533]：

$$
\|Gx\|_2^2 = (Gx)^T(Gx) = x^T G^T G x = x^T I x = x^T x = \|x\|_2^2
$$

这个性质保证了在应用一系列吉文斯旋转时，向量的“大小”不会发生数值上的膨胀或衰减，这是维持[数值稳定性](@entry_id:146550)的关键。

#### [行列式](@entry_id:142978)为1

任何吉文斯旋转矩阵的[行列式](@entry_id:142978)都恒为 $1$。这一点可以通过对矩阵进行[拉普拉斯展开](@entry_id:148225)，或通过[相似变换](@entry_id:152935)将其变为块[对角形式](@entry_id:264850)来证明。其核心在于，整个矩阵的行列式值由其 $2 \times 2$ 旋转子块的[行列式](@entry_id:142978)决定 [@problem_id:2176536]：

$$
\det \begin{pmatrix} \cos(\theta)  -\sin(\theta) \\ \sin(\theta)  \cos(\theta) \end{pmatrix} = \cos^2(\theta) - (-\sin(\theta))(\sin(\theta)) = \cos^2(\theta) + \sin^2(\theta) = 1
$$

[行列式](@entry_id:142978)为 $+1$ 表明吉文斯变换是一种保持空间定向的[刚性变换](@entry_id:140326)（即纯旋转），区别于[行列式](@entry_id:142978)为 $-1$ 的[反射变换](@entry_id:175518)。

#### 几何诠释

在三维空间中，吉文斯旋转的几何意义尤为清晰。例如，一个 $G(1, 3, \theta)$ 矩阵作用于 $(x_1, x_3)$ 平面。由于第 2 个坐标轴（$x_2$ 轴）的[基向量](@entry_id:199546) $e_2$ 在变换下保持不变（$G e_2 = e_2$），因此该变换的几何实体是绕 $x_2$ 轴进行的一次旋转 [@problem_id:2176526]。从 $x_2$ 轴正方向看去，这是一个逆时针旋转 $\theta$ 角的操作。同理，$G(1, 2, \theta)$ 是绕 $x_3$ 轴的旋转，$G(2, 3, \theta)$ 是绕 $x_1$ 轴的旋转。

### 核心机制：向量分量的选择性湮灭

吉文斯旋转在[数值算法](@entry_id:752770)中最核心的应用是精确地将向量或矩阵中的某个特定元素置为零。这个过程被称为“湮灭”（annihilation）。

假设我们有一个向量 $x \in \mathbb{R}^n$，并希望通过一次吉文斯旋转将它的第 $j$ 个分量 $x_j$ 置零，利用的分量是第 $i$ 个分量 $x_i$。这意味着我们需要构建一个 $G = G(i, j, c, s)$ 矩阵（这里我们直接用 $c, s$ [参数化](@entry_id:272587)），使得变换后的向量 $y = Gx$ 满足 $y_j = 0$。

让我们聚焦于第 $i$ 和第 $j$ 个分量。变换关系为：

$$
\begin{pmatrix} y_i \\ y_j \end{pmatrix} = \begin{pmatrix} c  s \\ -s  c \end{pmatrix} \begin{pmatrix} x_i \\ x_j \end{pmatrix} = \begin{pmatrix} cx_i + sx_j \\ -sx_i + cx_j \end{pmatrix}
$$

注意：这里的 $2 \times 2$ 旋转矩阵形式为 $\begin{pmatrix} c  s \\ -s  c \end{pmatrix}$，而不是前面定义的 $\begin{pmatrix} c  -s \\ s  c \end{pmatrix}$。这两种形式都是有效的旋转矩阵（一个是另一个的[转置](@entry_id:142115)），并且在文献中都有使用。选择哪一种形式会影响 $c$ 和 $s$ 的具体表达式，但最终都能达到置零的目的。我们将遵循使 $y_j=0$ 的形式进行推导。

为了使 $y_j = 0$，我们必须满足条件：

$$
-s x_i + c x_j = 0
$$

同时，$c$ 和 $s$ 必须满足旋转的约束条件 $c^2 + s^2 = 1$。假设 $x_i$ 和 $x_j$ 不全为零，令 $r = \sqrt{x_i^2 + x_j^2}$。一个满足上述两个条件的、数值上稳定的解是 [@problem_id:2176507] [@problem_id:2176469]：

$$
c = \frac{x_i}{r}, \quad s = \frac{x_j}{r}
$$

将这组 $c$ 和 $s$ 代入，我们验证 $y_j = -(\frac{x_j}{r})x_i + (\frac{x_i}{r})x_j = 0$，目标达成。同时，新的第 $i$ 个分量变为：

$$
y_i = c x_i + s x_j = \frac{x_i}{r}x_i + \frac{x_j}{r}x_j = \frac{x_i^2 + x_j^2}{r} = \frac{r^2}{r} = r
$$

这个选择有一个很好的特性：新的分量 $y_i$ 的值等于两个原始分量所在[子空间](@entry_id:150286)的范数 $r$，并且是非负的。这种确定性选择避免了符号模糊，是算法实现中的标准做法。

**示例：** 考虑四维向量 $x = \begin{pmatrix} 5, 3, 7, 4 \end{pmatrix}^T$。我们的目标是构造一个吉文斯旋转 $G$ 来湮灭其第四个分量 $x_4=4$，利用第二个分量 $x_2=3$ [@problem_id:2176492]。
这里，$i=2, j=4$，$x_i=3, x_j=4$。
1. 计算 $r = \sqrt{3^2 + 4^2} = 5$。
2. 计算 $c = x_i/r = 3/5$ 和 $s = x_j/r = 4/5$。
3. 构建 $4 \times 4$ 矩阵 $G(2, 4, c, s)$，将 $2 \times 2$ 旋转块嵌入到第 2 和第 4 行/列：

$$
G = \begin{pmatrix}
1  0  0  0 \\
0  c  0  s \\
0  0  1  0 \\
0  -s  0  c
\end{pmatrix} = \begin{pmatrix}
1  0  0  0 \\
0  3/5  0  4/5 \\
0  0  1  0 \\
0  -4/5  0  3/5
\end{pmatrix}
$$

应用此变换后，新的向量 $y=Gx$ 的第 2 和第 4 分量为：
$y_2 = (3/5)x_2 + (4/5)x_4 = (3/5)(3) + (4/5)(4) = 9/5 + 16/5 = 25/5 = 5 = r$
$y_4 = (-4/5)x_2 + (3/5)x_4 = (-4/5)(3) + (3/5)(4) = -12/5 + 12/5 = 0$
如预期一样，第四个分量被成功置零。

### 旋转的复合与交换性

在许多算法中，需要连续应用多个吉文斯旋转。这些操作的最终结果是否与它们的执行顺序有关？这引出了[矩阵的交换性](@entry_id:263178)问题。

考虑两个吉文斯旋转 $G_1 = G(i, j, \theta_1)$ 和 $G_2 = G(k, l, \theta_2)$。它们是否满足 $G_1 G_2 = G_2 G_1$？答案取决于它们作用的坐标平面之间的关系 [@problem_id:2176470]。令 $I = \{i, j\}$ 和 $K = \{k, l\}$ 为它们作用的坐标索引集。

1.  **相同平面 ($I = K$)**: 如果两个旋转作用于同一个平面，如前所述，它们是可交换的。这等同于二维旋转的复合，$G(i, j, \theta_1)G(i, j, \theta_2) = G(i, j, \theta_1+\theta_2)$。

2.  **不相交平面 ($I \cap K = \emptyset$)**: 如果两个旋转作用于完全不相干的坐标平面（例如，$\mathbb{R}^4$ 中的 $(x_1, x_2)$ 平面和 $(x_3, x_4)$ 平面），它们也是可交换的。直观上，一个旋转操作的坐标[子空间](@entry_id:150286)在另一个旋转看来是固定不变的，因此它们的顺序无关紧要。

3.  **共享一个坐标轴 ($|I \cap K| = 1$)**: 这是最微妙的情况。如果两个旋转平面共享一个坐标轴（例如，$\mathbb{R}^3$ 中的 $(x_1, x_2)$ 平面和 $(x_1, x_3)$ 平面），则它们**通常不可交换**。我们可以通过考察它们对[基向量](@entry_id:199546)的作用来验证这一点。例如，作用于[基向量](@entry_id:199546) $e_j$ 上，$G_1 G_2 e_j$ 和 $G_2 G_1 e_j$ 的结果通常是不同的。这种不可交换性源于三维空间中绕不同轴的旋转通常是不可交换的这一事实。

综上所述，两个不同的吉文斯旋转 $G(i, j, \theta_1)$ 和 $G(k, l, \theta_2)$ （假设旋转角不为 $\pi$ 的整数倍）可交换的充要条件是，它们的旋转平面要么完全相同，要么完全不相交，即索引集的交集大小 $|I \cap K| \neq 1$。这一性质对于设计[并行算法](@entry_id:271337)或优化一系列旋转操作的[计算顺序](@entry_id:749112)具有重要的指导意义。