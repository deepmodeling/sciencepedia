{"hands_on_practices": [{"introduction": "Householder变换在几何上对应于关于一个超平面的镜像反射。这个练习将通过一个计算机图形学中的具体例子，让你直观地理解这一过程。我们将计算一个点如何通过一个由法向量定义的平面进行反射，这有助于建立向量分解和反射变换的几何直觉 [@problem_id:1366953]。", "problem": "在一个三维计算机图形模拟中，一个平坦的无限大镜子由一个过原点的平面表示。该镜子的方向由其法向量定义，给定为 $n = [2, -1, 2]^T$。一个点状物体位于位置 $P$，其位置向量为 $p = [3, 6, 9]^T$。\n\n对点 $P$ 应用关于该镜面的反射变换，得到新点 $P'$，其位置向量为 $p'$。确定向量 $p'$ 的分量 $(p'_x, p'_y, p'_z)$。", "solution": "一个向量关于一个过原点且法向量为 $n$ 的平面的反射，是通过反转该向量沿 $n$ 的分量，同时保持平行于平面的分量不变来获得的。对于任意 $p$，将其分解为 $p = p_{\\parallel} + p_{\\perp}$，其中 $p_{\\perp} = \\dfrac{p \\cdot n}{n \\cdot n}\\,n$。反射会翻转 $p_{\\perp}$，得到\n$$\np' = p - 2 p_{\\perp} = p - 2 \\frac{p \\cdot n}{n \\cdot n}\\,n.\n$$\n给定 $n = \\begin{pmatrix}2\\\\-1\\\\2\\end{pmatrix}$ 和 $p = \\begin{pmatrix}3\\\\6\\\\9\\end{pmatrix}$，计算点积：\n$$\np \\cdot n = 3\\cdot 2 + 6\\cdot(-1) + 9\\cdot 2 = 6 - 6 + 18 = 18,\\qquad n \\cdot n = 2^{2} + (-1)^{2} + 2^{2} = 4 + 1 + 4 = 9.\n$$\n因此，\n$$\np' = p - 2 \\frac{18}{9} n = p - 4 n.\n$$\n计算 $p - 4n$：\n$$\np - 4n = \\begin{pmatrix}3\\\\6\\\\9\\end{pmatrix} - \\begin{pmatrix}8\\\\-4\\\\8\\end{pmatrix} = \\begin{pmatrix}-5\\\\10\\\\1\\end{pmatrix}.\n$$\n因此，$p'$ 的分量为 $(-5, 10, 1)$。", "answer": "$$\\boxed{\\begin{pmatrix}-5 \\\\ 10 \\\\ 1\\end{pmatrix}}$$", "id": "1366953"}, {"introduction": "在理解了反射如何作用于垂直于反射面的分量后，我们来探究其核心代数性质。这个练习要求你证明，任何位于反射超平面内的向量在经过Householder变换后都保持不变。这个性质揭示了为何Householder变换是一种正交变换，并巩固了我们对反射几何意义的理解 [@problem_id:18015]。", "problem": "豪斯霍尔德变换是一种描述关于一个超平面的反射的线性变换。对于一个给定的非零向量 $v \\in \\mathbb{R}^n$，豪斯霍尔德矩阵 $H_v$ 定义为：\n$$H_v = I - 2 \\frac{v v^T}{v^T v}$$\n其中 $I$ 是 $n \\times n$ 单位矩阵，$v^T$ 是列向量 $v$ 的转置，乘积 $v v^T$ 是一个外积，其结果是一个 $n \\times n$ 矩阵。项 $v^T v$ 是 $v$ 与自身的点积，它是一个标量。\n\n考虑另一个与 $v$ 正交的向量 $u \\in \\mathbb{R}^n$。正交的条件是它们的点积为零，即 $v^T u = 0$。\n\n你的任务是，对向量 $u$ 应用豪斯霍尔德变换 $H_v$，并推导出结果向量 $w$ 的简化表达式。", "solution": "我们有豪斯霍尔德变换定义为\n$$H_v = I - 2\\,\\frac{v\\,v^T}{v^T v}\\,. $$\n将 $H_v$ 应用于向量 $u$ 得到\n$$w = H_v\\,u = \\Bigl(I - 2\\,\\frac{v\\,v^T}{v^T v}\\Bigr)\\,u = u - 2\\,\\frac{v\\,(v^T u)}{v^T v}\\,. $$\n因为 $u$ 与 $v$ 正交，我们有 $v^T u = 0$。 因此\n$$w = u - 2\\,\\frac{v\\cdot 0}{v^T v} = u\\,. $$", "answer": "$$\\boxed{u}$$", "id": "18015"}, {"introduction": "现在，我们将概念付诸实践，看看Householder变换在数值线性代数中的强大应用。本练习将引导你完成QR分解的第一个关键步骤：构造一个特定的Householder矩阵，将矩阵的第一列向量转换为一个只在第一个分量上非零的向量。通过这个计算，你将掌握将向量特定分量“零化”这一核心技巧，它是许多高级算法的基石 [@problem_id:17992]。", "problem": "### 问题描述\n\n矩阵 $A$ 的 QR 分解是一种将矩阵分解为 $A=QR$ 的方法，其中 $Q$ 是一个正交矩阵，$R$ 是一个上三角矩阵。实现这种分解的一种方法是通过一系列 Householder 反射。\n\nHouseholder 反射是由矩阵 $H = I - 2 \\frac{\\mathbf{v}\\mathbf{v}^T}{\\mathbf{v}^T\\mathbf{v}}$ 定义的一种线性变换，其中 $\\mathbf{v}$ 是某个非零向量，$I$ 是单位矩阵。该变换将任意向量关于与 $\\mathbf{v}$ 正交的超平面进行反射。\n\n要开始对一个 $m \\times n$ 矩阵 $A$ 进行 QR 分解，第一步是应用一个 Householder 变换 $H_1$，它将 $A$ 的第一列（记作 $\\mathbf{a}_1$）映射到一个与标准基向量 $\\mathbf{e}_1 = (1, 0, \\dots, 0)^T$ 成比例的向量。这会将第一列中第一个元素下方的所有元素都变为零。\n\n所需的 Householder 矩阵是 $H_1 = I - 2 \\frac{\\mathbf{v}_1\\mathbf{v}_1^T}{\\mathbf{v}_1^T\\mathbf{v}_1}$，其中 Householder 向量 $\\mathbf{v}_1$ 的构造如下：\n$$\n\\mathbf{v}_1 = \\mathbf{a}_1 - \\alpha \\mathbf{e}_1\n$$\n标量 $\\alpha$ 由下式给出：\n$$\n\\alpha = -\\text{sgn}(a_{11})\\|\\mathbf{a}_1\\|_2\n$$\n这里，$a_{11}$ 是 $\\mathbf{a}_1$ 的第一个元素，$\\|\\cdot\\|_2$ 表示欧几里得范数，符号函数 $\\text{sgn}(x)$ 在 $x \\ge 0$ 时为 $1$，在 $x  0$ 时为 $-1$。完成这第一步后，变换后的矩阵为 $A' = H_1 A$。\n\n给定矩阵：\n$$\nA = \\begin{pmatrix} 1  1  1 \\\\ 1  2  4 \\\\ 1  3  9 \\end{pmatrix}\n$$\n计算矩阵 $A' = H_1 A$ 的元素 $(A')_{2,2}$。", "solution": "我们有 $A\\in\\mathbb{R}^{3\\times3}$，其第一列为 $\\mathbf{a}_1=(1,1,1)^T$。我们寻求 $H_1=I-2\\frac{\\mathbf{v}_1\\mathbf{v}_1^T}{\\mathbf{v}_1^T\\mathbf{v}_1}$，其中\n$$\n\\alpha=-\\sgn(a_{11})\\|\\mathbf{a}_1\\|_2=-1\\cdot\\sqrt{1^2+1^2+1^2}=-\\sqrt{3},\n$$\n$$\n\\mathbf{v}_1=\\mathbf{a}_1-\\alpha\\mathbf{e}_1\n=\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}-(-\\sqrt{3})\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}\n=\\begin{pmatrix}1+\\sqrt{3}\\\\1\\\\1\\end{pmatrix}.\n$$\n\n接下来，令 $\\mathbf{a}_2=(1,2,3)^T$ 为 $A$ 的第二列。则\n$$\n\\mathbf{v}_1^T\\mathbf{v}_1=(1+\\sqrt{3})^2+1^2+1^2\n=1+2\\sqrt{3}+3+1+1=6+2\\sqrt{3},\n$$\n$$\n\\mathbf{v}_1^T\\mathbf{a}_2=(1+\\sqrt{3})\\cdot1+1\\cdot2+1\\cdot3\n=6+\\sqrt{3}.\n$$\n因此\n$$\nH_1\\mathbf{a}_2\n=\\mathbf{a}_2-2\\,\\frac{\\mathbf{v}_1(\\mathbf{v}_1^T\\mathbf{a}_2)}{\\mathbf{v}_1^T\\mathbf{v}_1}\n=\\begin{pmatrix}1\\\\2\\\\3\\end{pmatrix}\n-2\\,\\frac{6+\\sqrt{3}}{6+2\\sqrt{3}}\\begin{pmatrix}1+\\sqrt{3}\\\\1\\\\1\\end{pmatrix}.\n$$\n化简该标量：\n$$\n2\\,\\frac{6+\\sqrt{3}}{6+2\\sqrt{3}}\n=\\frac{12+2\\sqrt{3}}{6+2\\sqrt{3}}\n=\\frac{6+\\sqrt{3}}{3+\\sqrt{3}}\n=\\frac{(6+\\sqrt{3})(3-\\sqrt{3})}{6}\n=\\frac{15-3\\sqrt{3}}{6}\n=\\frac{5-\\sqrt{3}}{2}.\n$$\n因此\n$$\n(H_1\\mathbf{a}_2)_2\n=2-\\frac{5-\\sqrt{3}}{2}\\cdot1\n=\\frac{4-(5-\\sqrt{3})}{2}\n=\\frac{\\sqrt{3}-1}{2}.\n$$\n所以，矩阵 $A'=H_1A$ 的 $(2,2)$ 元素是 $\\displaystyle\\frac{\\sqrt{3}-1}{2}$。", "answer": "$$\\boxed{\\frac{\\sqrt{3}-1}{2}}$$", "id": "17992"}]}