{"hands_on_practices": [{"introduction": "Arnoldi 迭代的核心在于其逐步构建克雷洛夫子空间标准正交基的过程。要完全掌握该算法，第一步是熟悉其基本计算单元。本练习将带你完成 Arnoldi 迭代的第一步，这包括向量归一化、矩阵向量乘法以及 Gram-Schmidt 正交化，这些都是理解整个迭代过程的基础。", "problem": "Arnoldi迭代是一种用于构建由矩阵 $A$ 和向量 $b$ 生成的克雷洛夫子空间（Krylov subspace）的标准正交基的算法。该过程在数值线性代数中至关重要，尤其适用于逼近大型非对称矩阵的特征值。\n\n考虑如下给定的非对称矩阵 $A$ 和向量 $b$：\n$$\nA = \\begin{pmatrix} 1  4 \\\\ 2  3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}\n$$\nArnoldi迭代的第一步始于归一化向量 $q_1 = \\frac{b}{\\|b\\|_2}$，其中 $\\| \\cdot \\|_2$ 表示欧几里得范数。\n\n您的任务是执行一步完整的Arnoldi迭代，以计算第二个Arnoldi向量 $q_2$ 以及相关的上Hessenberg矩阵 $H$ 的第一列。该列的元素记为 $h_{11}$ 和 $h_{21}$。\n\n设所得向量的分量为 $q_2 = \\begin{pmatrix} q_{2,1} \\\\ q_{2,2} \\end{pmatrix}$。请以单行矩阵的形式给出您的答案，其中按此确切顺序包含四个值 $[q_{2,1}, q_{2,2}, h_{11}, h_{21}]$。所有元素均需表示为最简精确分数形式。", "solution": "Arnoldi迭代从 $q_{1}=\\dfrac{b}{\\|b\\|_{2}}$ 开始。对于 $b=\\begin{pmatrix}3 \\\\ 4\\end{pmatrix}$，欧几里得范数为 $\\|b\\|_{2}=\\sqrt{3^{2}+4^{2}}=5$，因此\n$$\nq_{1}=\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}.\n$$\n计算 $v=Aq_{1}$：\n$$\nv=\\begin{pmatrix}1  4 \\\\ 2  3\\end{pmatrix}\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{3}{5}+ \\dfrac{16}{5} \\\\ \\dfrac{6}{5}+ \\dfrac{12}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}.\n$$\n第一个Hessenberg矩阵的元素是 $h_{11}=q_{1}^{\\top}v$：\n$$\nh_{11}=\\begin{pmatrix}\\dfrac{3}{5}  \\dfrac{4}{5}\\end{pmatrix}\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}\n=\\dfrac{57}{25}+\\dfrac{72}{25}\n=\\dfrac{129}{25}.\n$$\n构造残差 $r=v-h_{11}q_{1}$：\n$$\nh_{11}q_{1}=\\dfrac{129}{25}\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{387}{125} \\\\ \\dfrac{516}{125}\\end{pmatrix},\\quad\nr=\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}-\\begin{pmatrix}\\dfrac{387}{125} \\\\ \\dfrac{516}{125}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{88}{125} \\\\ -\\dfrac{66}{125}\\end{pmatrix}.\n$$\n次对角线上的Hessenberg矩阵元素是 $h_{21}=\\|r\\|_{2}$：\n$$\nh_{21}=\\sqrt{\\left(\\dfrac{88}{125}\\right)^{2}+\\left(-\\dfrac{66}{125}\\right)^{2}}\n=\\dfrac{1}{125}\\sqrt{7744+4356}\n=\\dfrac{1}{125}\\sqrt{12100}\n=\\dfrac{110}{125}\n=\\dfrac{22}{25}.\n$$\n归一化以得到 $q_{2}=r/h_{21}$：\n$$\nq_{2}=\\dfrac{1}{\\frac{22}{25}}\\begin{pmatrix}\\dfrac{88}{125} \\\\ -\\dfrac{66}{125}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{88}{125}\\cdot \\dfrac{25}{22} \\\\ -\\dfrac{66}{125}\\cdot \\dfrac{25}{22}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{4}{5} \\\\ -\\dfrac{3}{5}\\end{pmatrix}.\n$$\n因此，所求的元素为 $q_{2,1}=\\dfrac{4}{5}$，$q_{2,2}=-\\dfrac{3}{5}$，$h_{11}=\\dfrac{129}{25}$ 和 $h_{21}=\\dfrac{22}{25}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4}{5}  -\\frac{3}{5}  \\frac{129}{25}  \\frac{22}{25}\\end{pmatrix}}$$", "id": "1349109"}, {"introduction": "Arnoldi 迭代在某些特殊情况下会提前终止，这种情况被称为“幸运中断”(lucky breakdown)。本练习旨在通过一个思想实验，让你探索这种情况发生的根本原因。通过判断哪个初始向量会导致迭代仅一步就停止，你将深刻理解当初始向量恰好是矩阵的特征向量时，克雷洛夫子空间为何会“坍缩”，这对于理论理解和算法的实际应用都至关重要。", "problem": "Arnoldi 迭代是一种为克雷洛夫子空间 $\\mathcal{K}_m(A, q_1) = \\text{span}\\{q_1, Aq_1, \\ldots, A^{m-1}q_1\\}$ 构建标准正交基 $\\{q_1, q_2, \\ldots, q_m\\}$ 的算法，其中 $A$ 是一个 $n \\times n$ 矩阵，$q_1$ 是一个单位范数（即 $\\|q_1\\|_2 = 1$）的起始向量。\n\n该过程如下进行。对于 $k=1, 2, \\ldots$：\n1. 计算新的候选向量 $v = A q_k$。\n2. 将 $v$ 与先前找到的基向量 $\\{q_1, \\ldots, q_k\\}$ 进行正交化，得到向量 $w$：\n   $$w = v - \\sum_{j=1}^{k} (q_j^T v) q_j$$\n3. 如果 $w$ 是零向量，则算法在第 $k$ 步终止。否则，通过将 $w$ 单位化得到下一个基向量：$q_{k+1} = w / \\|w\\|_2$。\n\n考虑一个 $2 \\times 2$ 的非对称矩阵 $A$。Arnoldi 迭代从一个特定的向量 $q_1$ 开始。对于下列哪对矩阵 $A$ 和初始向量 $q_1$，Arnoldi 迭代将在恰好一步后（即在 $k=1$ 时）终止？\n\nA. $A = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 5  -3 \\\\ 2  0 \\end{pmatrix}$, $q_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1  3 \\\\ 1  -1 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$", "solution": "在 Arnoldi 迭代的第 $k=1$ 步，我们有一个单位范数的基向量 $q_{1}$，我们构建 $v=Aq_{1}$ 并将其与 $q_{1}$ 正交化：\n$$\nw \\;=\\; v - (q_{1}^{T}v)\\,q_{1} \\;=\\; Aq_{1} - \\big(q_{1}^{T}Aq_{1}\\big)\\,q_{1}.\n$$\n当且仅当 $w=0$ 时，迭代在 $k=1$ 步终止，这当且仅当 $Aq_{1}$ 位于 $q_{1}$ 的张成空间中，即存在一个标量 $\\lambda$ 使得 $Aq_{1}=\\lambda q_{1}$。这等价于，$q_{1}$ 必须是 $A$ 的一个特征向量。\n\n我们通过计算 $Aq_{1}$ 并检查其与 $q_{1}$ 的共线性来测试每个选项。\n\nA. $A=\\begin{pmatrix}0  -1 \\\\ 1  0\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$。则\n$$\nv=Aq_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}1  0\\end{pmatrix}\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}=0,\n$$\n所以\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\neq 0.\n$$\n不终止。\n\nB. $A=\\begin{pmatrix}5  -3 \\\\ 2  0\\end{pmatrix}$, $q_{1}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$。则\n$$\nv=Aq_{1}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}5-3 \\\\ 2+0\\end{pmatrix}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}2 \\\\ 2\\end{pmatrix}=2\\,\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=2q_{1},\n$$\n因此\n$$\nq_{1}^{T}v=2\\,q_{1}^{T}q_{1}=2,\\quad w=v-(q_{1}^{T}v)q_{1}=2q_{1}-2q_{1}=0.\n$$\n在 $k=1$ 时终止。\n\nC. $A=\\begin{pmatrix}1  1 \\\\ 0  1\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。则\n$$\nv=Aq_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}0  1\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=1,\n$$\n所以\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}-\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\neq 0.\n$$\n不终止。\n\nD. $A=\\begin{pmatrix}1  3 \\\\ 1  -1\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$。则\n$$\nv=Aq_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}1  0\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=1,\n$$\n所以\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}-\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\neq 0.\n$$\n不终止。\n\n因此，Arnoldi 迭代仅在选项 B 的情况下恰好在一步后终止。", "answer": "$$\\boxed{B}$$", "id": "1349095"}, {"introduction": "理解 Arnoldi 迭代的最终目的，不仅仅是执行算法步骤，更要明白它所揭示的矩阵结构。本练习提供了一个独特的“逆向工程”视角。我们不再从矩阵 $A$ 出发计算其 Arnoldi 分解，而是利用已知的分解结果（Hessenberg 矩阵 $H_2$ 和正交基 $Q_2$）来重构原始矩阵 $A$。这个过程将巩固你对核心关系式 $A = Q H Q^T$ 的理解，并清晰地展示 Arnoldi 迭代如何将一个复杂的非对称矩阵转化为一个结构更简单的 Hessenberg 矩阵。", "problem": "Arnoldi迭代是数值线性代数中用于寻找大型矩阵特征值近似值的一种算法。对于一个给定的 $n \\times n$ 矩阵 $A$ 和一个单位范数的初始向量 $q_1$（$\\|q_1\\|=1$），该迭代为 $k$ 阶克雷洛夫子空间构建一个标准正交基 $\\{q_1, q_2, \\dots, q_k\\}$。当迭代运行一个完整的 $n$ 步循环时，它会得到矩阵 $A$ 的Arnoldi分解，由方程 $A = Q_n H_n Q_n^T$ 给出。在此分解中，$Q_n = [q_1, q_2, \\dots, q_n]$ 是一个 $n \\times n$ 的正交矩阵，其列是生成的标准正交向量，而 $H_n$ 是一个 $n \\times n$ 的上Hessenberg矩阵。根据标准算法的约定，$H_n$ 的次对角线元素（记为 $h_{j+1, j}$）被构造成实数且为正，这个条件使得对于给定的 $q_1$，基 $\\{q_1, ..., q_n\\}$ 是唯一的。\n\n假设此过程应用于一个 $2 \\times 2$ 的实非对称矩阵 $A$。迭代从初始向量 $q_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 开始。经过两步后，过程终止，得到 $2 \\times 2$ 的上Hessenberg矩阵 $H_2 = \\begin{pmatrix} 2  5 \\\\ 3  4 \\end{pmatrix}$。\n\n确定矩阵 $A$。", "solution": "对于一个二阶实矩阵的完整Arnoldi循环，其Arnoldi分解为\n$$\nA = Q_{2} H_{2} Q_{2}^{T},\n$$\n其中 $Q_{2} = [q_{1}, q_{2}]$ 是正交矩阵，而 $H_{2}$ 是上Hessenberg矩阵。这里\n$$\nq_{1} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ -1\\end{pmatrix}, \\qquad\nH_{2} = \\begin{pmatrix}2  5 \\\\ 3  4\\end{pmatrix}.\n$$\n因为 $q_{2}$ 必须是与 $q_{1}$ 正交的单位向量，并且标准的Arnoldi约定强制 $h_{2,1}>0$，所以在 $\\mathbb{R}^{2}$ 中，与 $q_{1}$ 正交的单位向量只有 $\\pm \\frac{1}{\\sqrt{2}}(1,1)^{T}$。符号由Arnoldi约定固定，因此我们取\n$$\nq_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}.\n$$\n因此\n$$\nQ_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1  1 \\\\ -1  1\\end{pmatrix}, \\qquad\nQ_{2}^{T} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1  -1 \\\\ 1  1\\end{pmatrix}.\n$$\n计算 $Q_{2}H_{2}$：\n$$\nQ_{2}H_{2}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1  1 \\\\ -1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n2  5 \\\\ 3  4\n\\end{pmatrix}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1\\cdot 2 + 1\\cdot 3  1\\cdot 5 + 1\\cdot 4 \\\\\n-1\\cdot 2 + 1\\cdot 3  -1\\cdot 5 + 1\\cdot 4\n\\end{pmatrix}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n5  9 \\\\ 1  -1\n\\end{pmatrix}.\n$$\n接着\n$$\nA = (Q_{2}H_{2})Q_{2}^{T}\n= \\frac{1}{2}\n\\begin{pmatrix}\n5  9 \\\\ 1  -1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  -1 \\\\ 1  1\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n5\\cdot 1 + 9\\cdot 1  5\\cdot (-1) + 9\\cdot 1 \\\\\n1\\cdot 1 + (-1)\\cdot 1  1\\cdot (-1) + (-1)\\cdot 1\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n14  4 \\\\ 0  -2\n\\end{pmatrix}\n= \\begin{pmatrix}\n7  2 \\\\ 0  -1\n\\end{pmatrix}.\n$$\n直接检验表明 $Q_{2}^{T}AQ_{2} = H_{2}$，从而证实了结果。", "answer": "$$\\boxed{\\begin{pmatrix}7  2 \\\\ 0  -1\\end{pmatrix}}$$", "id": "1349130"}]}