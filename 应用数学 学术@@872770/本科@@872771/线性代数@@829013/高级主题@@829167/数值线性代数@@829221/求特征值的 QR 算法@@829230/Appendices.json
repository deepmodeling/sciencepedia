{"hands_on_practices": [{"introduction": "要真正掌握 QR 算法，第一步是亲手实践其核心迭代过程。这个练习将引导你对一个简单的 2x2 矩阵执行一次完整的“无位移”QR 迭代。通过这个过程，你不仅能练习 QR分解的计算，还能通过验证矩阵的迹和行列式在迭代前后保持不变，来加深对 QR 迭代是一种相似变换这一基本性质的理解。[@problem_id:1397703]", "problem": "QR 算法是数值线性代数中用于求解矩阵特征值的一种迭代方法。“非移位”版本的算法从一个初始矩阵 $A$ 开始，生成一个矩阵序列 $A_0, A_1, A_2, \\dots$。从当前矩阵 $A_k$ 生成序列中下一个矩阵 $A_{k+1}$ 的过程如下：\n1. 对当前矩阵进行 QR 分解：$A_k = Q_k R_k$，其中 $Q_k$ 是一个正交矩阵，$R_k$ 是一个上三角矩阵。\n2. 通过反转乘法顺序计算下一个矩阵：$A_{k+1} = R_k Q_k$。\n\n考虑初始矩阵 $A_0 = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$。\n\n执行一次完整的 QR 算法迭代来计算矩阵 $A_1$。然后，计算矩阵 $A_0$ 和 $A_1$ 的迹和行列式。\n\n将您的答案以一个 $1 \\times 4$ 行矩阵的形式给出，按顺序包含以下四个值：$A_0$ 的迹、$A_0$ 的行列式、$A_1$ 的迹和 $A_1$ 的行列式。", "solution": "我们对 $A_{0} = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$ 应用一次非移位 QR 迭代。\n\n首先，通过对 $A_0$ 的列 $a_{1}$ 和 $a_{2}$ 进行 Gram–Schmidt 正交化来计算 QR 分解 $A_{0} = Q R$：\n$$\na_{1} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}, \\quad \\|a_{1}\\| = \\sqrt{2^{2} + (-1)^{2}} = \\sqrt{5}, \\quad q_{1} = \\frac{a_{1}}{\\|a_{1}\\|} = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}, \\quad r_{11} = \\sqrt{5}.\n$$\n令 $a_{2} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$。那么\n$$\nr_{12} = q_{1}^{T} a_{2} = \\frac{1}{\\sqrt{5}}(2\\cdot(-1) + (-1)\\cdot 2) = -\\frac{4}{\\sqrt{5}}.\n$$\n计算\n$$\nu_{2} = a_{2} - r_{12} q_{1} = a_{2} + \\frac{4}{\\sqrt{5}} q_{1} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} + \\frac{4}{\\sqrt{5}} \\cdot \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} + \\frac{4}{5} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{5} \\\\ \\frac{6}{5} \\end{pmatrix}.\n$$\n因此\n$$\nr_{22} = \\|u_{2}\\| = \\sqrt{\\left(\\frac{3}{5}\\right)^{2} + \\left(\\frac{6}{5}\\right)^{2}} = \\sqrt{\\frac{45}{25}} = \\frac{3}{\\sqrt{5}}, \\quad q_{2} = \\frac{u_{2}}{r_{22}} = \\begin{pmatrix} \\frac{1}{\\sqrt{5}} \\\\ \\frac{2}{\\sqrt{5}} \\end{pmatrix}.\n$$\n因此\n$$\nQ = \\begin{pmatrix} \\frac{2}{\\sqrt{5}} & \\frac{1}{\\sqrt{5}} \\\\ -\\frac{1}{\\sqrt{5}} & \\frac{2}{\\sqrt{5}} \\end{pmatrix}, \\quad\nR = \\begin{pmatrix} \\sqrt{5} & -\\frac{4}{\\sqrt{5}} \\\\ 0 & \\frac{3}{\\sqrt{5}} \\end{pmatrix}.\n$$\n\n计算 $A_{1} = R Q$：\n$$\nR Q = \\begin{pmatrix} \\sqrt{5} & -\\frac{4}{\\sqrt{5}} \\\\ 0 & \\frac{3}{\\sqrt{5}} \\end{pmatrix}\n\\begin{pmatrix} \\frac{2}{\\sqrt{5}} & \\frac{1}{\\sqrt{5}} \\\\ -\\frac{1}{\\sqrt{5}} & \\frac{2}{\\sqrt{5}} \\end{pmatrix}\n= \\begin{pmatrix}\n\\frac{14}{5}  & -\\frac{3}{5} \\\\\n-\\frac{3}{5}  & \\frac{6}{5}\n\\end{pmatrix}.\n$$\n\n现在计算迹和行列式。\n对于 $A_{0}$：\n$$\n\\operatorname{tr}(A_{0}) = 2 + 2 = 4, \\quad \\det(A_{0}) = 2\\cdot 2 - (-1)\\cdot(-1) = 4 - 1 = 3.\n$$\n对于 $A_{1}$：\n$$\n\\operatorname{tr}(A_{1}) = \\frac{14}{5} + \\frac{6}{5} = \\frac{20}{5} = 4, \\quad\n\\det(A_{1}) = \\frac{14}{5}\\cdot \\frac{6}{5} - \\left(-\\frac{3}{5}\\right)^{2} = \\frac{84}{25} - \\frac{9}{25} = \\frac{75}{25} = 3.\n$$\n作为一致性检验，由于对于正交矩阵 $Q$ 有 $A_{1} = Q^{T} A_{0} Q$，迹和行列式是不变量，因此必须与 $A_{0}$ 的值相匹配，事实也确实如此。因此，所求的 $1 \\times 4$ 行矩阵是 $\\begin{pmatrix} 4 & 3 & 4 & 3 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 4  3  4  3 \\end{pmatrix}}$$", "id": "1397703"}, {"introduction": "虽然基础的 QR 算法在理论上很优雅，但在实践中其收敛速度可能很慢。为了解决这个问题，我们引入了“位移”策略，这是一种极大地加速算法收敛性的关键增强技术。这个练习将带你体验带有位移的 QR 算法，通过手动计算一个位移 QR 迭代步骤，你将直观地感受到这个简单修改如何使算法变得更加强大和高效。[@problem_id:1397701]", "problem": "带位移的QR算法是一种用于求解矩阵特征值的迭代方法。从矩阵 $A_k$ 开始的单次迭代由以下一系列操作定义：\n1. 根据 $A_k$ 的元素选择一个位移量 $\\sigma_k$。\n2. 对位移后的矩阵 $A_k - \\sigma_k I$ 进行QR分解，得到 $A_k - \\sigma_k I = Q_k R_k$。其中，$I$ 是单位矩阵，$Q_k$ 是一个正交矩阵，$R_k$ 是一个对角线元素非负的上三角矩阵。\n3. 序列中的下一个矩阵 $A_{k+1}$ 按如下方式计算：$A_{k+1} = R_k Q_k + \\sigma_k I$。\n\n此过程生成一个与 $A_0$ 相似的矩阵序列 $A_0, A_1, A_2, \\dots$，在特定条件下，该序列收敛于一个上三角形式，其对角线上的元素即为特征值。\n\n考虑初始矩阵：\n$$\nA_0 = \\begin{pmatrix} 5  -2 \\\\ 4  -1 \\end{pmatrix}\n$$\n对于算法的第一步，我们将使用简单的瑞利商位移，它被定义为当前矩阵的右下角元素。因此，位移量为 $\\sigma_0 = (A_0)_{22}$。\n\n按照所描述的步骤，确定第一个带位移的迭代结果，即矩阵 $A_1$。", "solution": "题目要求计算带位移的QR算法应用于矩阵 $A_0 = \\begin{pmatrix} 5  -2 \\\\ 4  -1 \\end{pmatrix}$ 后的第一个迭代结果 $A_1$。\n\n第一步：确定位移量 $\\sigma_0$。\n位移量被指定为 $A_0$ 的右下角元素。\n$$\n\\sigma_0 = (A_0)_{22} = -1\n$$\n\n第二步：构建位移后的矩阵 $A_0 - \\sigma_0 I$。\n$$\nA_0 - \\sigma_0 I = \\begin{pmatrix} 5  -2 \\\\ 4  -1 \\end{pmatrix} - (-1)\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 5  -2 \\\\ 4  -1 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 6  -2 \\\\ 4  0 \\end{pmatrix}\n$$\n\n第三步：对位移后的矩阵进行QR分解，$A_0 - \\sigma_0 I = Q_0 R_0$。\n令 $B = A_0 - \\sigma_0 I = \\begin{pmatrix} 6  -2 \\\\ 4  0 \\end{pmatrix}$。我们将对其列向量 $b_1 = \\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix}$ 和 $b_2 = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}$ 使用格拉姆-施密特过程来求 $B$ 的QR分解。$Q_0$ 的列将是一个标准正交基 $\\{q_1, q_2\\}$。\n\n首先，我们求 $q_1$。正交基的第一个向量是 $u_1 = b_1 = \\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix}$。\n其范数为 $\\|u_1\\| = \\sqrt{6^2 + 4^2} = \\sqrt{36 + 16} = \\sqrt{52} = 2\\sqrt{13}$。\n第一个标准正交向量是 $q_1$：\n$$\nq_1 = \\frac{u_1}{\\|u_1\\|} = \\frac{1}{2\\sqrt{13}}\\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix}\n$$\n\n接下来，我们求 $q_2$。我们首先通过减去 $b_2$ 在 $q_1$ 上的投影来找到一个与 $q_1$ 正交的向量 $u_2$：\n$$\nu_2 = b_2 - (q_1^T b_2)q_1\n$$\n投影项为：\n$$\nq_1^T b_2 = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3  2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} = \\frac{-6}{\\sqrt{13}}\n$$\n所以，$u_2$ 为：\n$$\nu_2 = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} - \\left(\\frac{-6}{\\sqrt{13}}\\right) \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} + \\frac{6}{13}\\begin{pmatrix} 3 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 + \\frac{18}{13} \\\\ \\frac{12}{13} \\end{pmatrix} = \\begin{pmatrix} -\\frac{8}{13} \\\\ \\frac{12}{13} \\end{pmatrix}\n$$\n$u_2$ 的范数为 $\\|u_2\\| = \\sqrt{\\left(-\\frac{8}{13}\\right)^2 + \\left(\\frac{12}{13}\\right)^2} = \\frac{1}{13}\\sqrt{64 + 144} = \\frac{\\sqrt{208}}{13} = \\frac{\\sqrt{16 \\times 13}}{13} = \\frac{4\\sqrt{13}}{13}$。\n第二个标准正交向量是 $q_2$：\n$$\nq_2 = \\frac{u_2}{\\|u_2\\|} = \\frac{13}{4\\sqrt{13}}\\begin{pmatrix} -\\frac{8}{13} \\\\ \\frac{12}{13} \\end{pmatrix} = \\frac{1}{4\\sqrt{13}}\\begin{pmatrix} -8 \\\\ 12 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} -2 \\\\ 3 \\end{pmatrix}\n$$\n正交矩阵 $Q_0$ 由列向量 $q_1$ 和 $q_2$ 构成：\n$$\nQ_0 = \\begin{pmatrix} q_1  q_2 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3  -2 \\\\ 2  3 \\end{pmatrix}\n$$\n上三角矩阵 $R_0$ 可以通过 $R_0 = Q_0^T (A_0 - \\sigma_0 I)$ 计算得出：\n$$\nQ_0^T = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3  2 \\\\ -2  3 \\end{pmatrix}\n$$\n$$\nR_0 = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3  2 \\\\ -2  3 \\end{pmatrix} \\begin{pmatrix} 6  -2 \\\\ 4  0 \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3(6)+2(4)  3(-2)+2(0) \\\\ -2(6)+3(4)  -2(-2)+3(0) \\end{pmatrix} = \\frac{1}{\\sqrt{13}}\\begin{pmatrix} 26  -6 \\\\ 0  4 \\end{pmatrix}\n$$\n对角线元素 $26/\\sqrt{13}$ 和 $4/\\sqrt{13}$ 均为非负，符合要求。\n\n第四步：计算下一个迭代矩阵 $A_1 = R_0 Q_0 + \\sigma_0 I$。\n首先，我们计算乘积 $R_0 Q_0$：\n$$\nR_0 Q_0 = \\left(\\frac{1}{\\sqrt{13}}\\begin{pmatrix} 26  -6 \\\\ 0  4 \\end{pmatrix}\\right) \\left(\\frac{1}{\\sqrt{13}}\\begin{pmatrix} 3  -2 \\\\ 2  3 \\end{pmatrix}\\right) = \\frac{1}{13}\\begin{pmatrix} 26(3)+(-6)(2)  26(-2)+(-6)(3) \\\\ 0(3)+4(2)  0(-2)+4(3) \\end{pmatrix}\n$$\n$$\nR_0 Q_0 = \\frac{1}{13}\\begin{pmatrix} 78-12  -52-18 \\\\ 8  12 \\end{pmatrix} = \\frac{1}{13}\\begin{pmatrix} 66  -70 \\\\ 8  12 \\end{pmatrix}\n$$\n现在，我们加回位移项 $\\sigma_0 I$：\n$$\nA_1 = R_0 Q_0 + \\sigma_0 I = \\frac{1}{13}\\begin{pmatrix} 66  -70 \\\\ 8  12 \\end{pmatrix} + (-1)\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\nA_1 = \\begin{pmatrix} \\frac{66}{13}  -\\frac{70}{13} \\\\ \\frac{8}{13}  \\frac{12}{13} \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{66}{13} - 1  -\\frac{70}{13} \\\\ \\frac{8}{13}  \\frac{12}{13} - 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{53}{13}  -\\frac{70}{13} \\\\ \\frac{8}{13}  -\\frac{1}{13} \\end{pmatrix}\n$$\n因此，第一个带位移的迭代结果是矩阵 $A_1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{53}{13}  -\\frac{70}{13} \\\\ \\frac{8}{13}  -\\frac{1}{13} \\end{pmatrix}}\n$$", "id": "1397701"}, {"introduction": "将理论算法应用于现实世界的计算时，我们必须面对有限精度和效率的挑战。QR 算法不会无限迭代下去，而是在次对角线元素变得“足够小”时停止，这个过程称为“放缩”（deflation）。这个练习要求你像一位数值分析师一样思考，从多个选项中选出最稳健的停止准则，这对于保证算法的效率和数值稳定性至关重要。[@problem_id:1397748]", "problem": "在数值线性代数领域，QR算法是计算一般方阵 $A$ 特征值的一种基本迭代方法。该过程首先设置 $A^{(0)} = A$。然后，在每一步 $k=0, 1, 2, \\dots$ 中，对当前矩阵进行QR分解，$A^{(k)} = Q^{(k)}R^{(k)}$，其中 $Q^{(k)}$ 是一个正交矩阵，$R^{(k)}$ 是一个上三角矩阵。序列中的下一个矩阵通过反转乘法顺序形成：$A^{(k+1)} = R^{(k)}Q^{(k)}$。这个新矩阵 $A^{(k+1)}$ 与 $A^{(k)}$ 正交相似，因此具有相同的特征值。\n\n对于一般的非对称矩阵，序列 $\\{A^{(k)}\\}$ 会收敛到一个上三角（或拟三角）形式，其特征值出现在对角线上。然而，这种收敛是无限的。在实际实现中，该算法通过一个称为“降阶”的过程来加速。当一个次对角线元素 $a_{i, i-1}^{(k)}$ 变得足够小时，它被视为零。这有效地将矩阵解耦为两个更小的、独立的子问题，从而显著降低了计算成本。\n\n选择一个停止准则来判断 $a_{i, i-1}^{(k)}$ 何时“足够小”，对于算法的稳定性和效率至关重要。令 $\\epsilon_{\\text{mach}}$ 为机器ε，它是满足 $1.0 + \\epsilon_{\\text{mach}}$ 在计算上与 $1.0$ 有区别的最小正浮点数。对于一个一般的 $n \\times n$ 矩阵 $A$，在高质量的数值软件中，以下哪种将次对角线元素 $a_{i, i-1}^{(k)}$ 置零的准则是最鲁棒且被广泛接受的？\n\nA. $|a_{i, i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} (|a_{i,i}^{(k)}| + |a_{i-1, i-1}^{(k)}|)$\n\nB. $|a_{i, i-1}^{(k)}| \\le \\epsilon_{\\text{mach}}$\n\nC. $|a_{i, i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\cdot \\|A^{(0)}\\|_F$，其中 $\\| \\cdot \\|_F$ 是初始矩阵的弗罗贝尼乌斯范数。\n\nD. $|a_{i, i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\cdot |a_{i-1, i-1}^{(k)}|$\n\nE. $|a_{i, i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\cdot \\max_{j,l} |a_{jl}^{(k)}|$", "solution": "我们考虑应用于一般非对称矩阵的QR算法，其中迭代矩阵 $A^{(k)}$（隐式地）保持为上Hessenberg形式，当一个次对角线元素 $a_{i,i-1}^{(k)}$ 相对于其耦合的 $2 \\times 2$ 对角块的局部尺度被认为可以忽略不计时，就会发生降阶。一个鲁棒的降阶测试应满足以下原则：\n\n1) 尺度不变性：如果 $A$ 被一个非零标量 $\\alpha$ 缩放，降阶的决定应保持不变。形式上，用 $\\alpha A^{(k)}$ 替换 $A^{(k)}$ 会使 $a_{i,i-1}^{(k)}$ 以及对角元素 $a_{i-1,i-1}^{(k)}$ 和 $a_{i,i}^{(k)}$ 都乘以 $|\\alpha|$。因此，一个合理的测试应该将 $|a_{i,i-1}^{(k)}|$ 与一个按相同因子 $|\\alpha|$ 缩放的量进行比较，以确保齐次性。\n\n2) 局部性：耦合项 $a_{i,i-1}^{(k)}$ 连接了局部的 $2 \\times 2$ 对角块。因此，阈值应由 $|a_{i-1,i-1}^{(k)}|$ 和 $|a_{i,i}^{(k)}|$ 设定的局部尺度决定，而不是由其他地方不相关的元素或初始矩阵决定。\n\n3) 后向稳定性与通用实践：高质量的实现采用相对测试，如果 $a_{i,i-1}^{(k)}$ 的数量级是机器舍入误差乘以相邻对角元素的局部尺度，则将其视为可忽略。符号上，其形式为\n$$\n|a_{i,i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\big(|a_{i-1,i-1}^{(k)}| + |a_{i,i}^{(k)}|\\big).\n$$\n\n现在我们根据这些原则来检查每个选项：\n\n- 选项A：$|a_{i,i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\big(|a_{i,i}^{(k)}| + |a_{i-1,i-1}^{(k)}|\\big)$。这是尺度不变的：在 $A^{(k)} \\mapsto \\alpha A^{(k)}$ 的变换下，不等式两边都按 $|\\alpha|$ 缩放。它是局部的：它只使用定义相关 $2 \\times 2$ 尺度的相邻对角元素的大小。这是高质量软件中使用的标准准则，通常带有一些针对下溢的次要保护措施。\n\n- 选项B：$|a_{i,i-1}^{(k)}| \\le \\epsilon_{\\text{mach}}$。这不是尺度不变的。在大尺度缩放时，左边会缩放而右边不会，导致测试出现虚假失败；在小尺度缩放时，它可能会过早地降阶。因此它不鲁棒。\n\n- 选项C：$|a_{i,i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\cdot \\|A^{(0)}\\|_{F}$。这使用了来自初始矩阵的固定全局尺度，没有反映 $A^{(k)}$ 中的局部和当前尺度。它既不是严格局部的，也不能适应迭代过程中的变化，可能导致不稳定或效率低下。\n\n- 选项D：$|a_{i,i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\cdot |a_{i-1,i-1}^{(k)}|$。这是尺度不变的，但对于两个耦合的对角元素而言不是对称的。当 $|a_{i,i}^{(k)}|$ 远大于或远小于 $|a_{i-1,i-1}^{(k)}|$ 时，该测试可能过于严格或过于宽松。选项A中的对称和是更可取的。\n\n- 选项E：$|a_{i,i-1}^{(k)}| \\le \\epsilon_{\\text{mach}} \\cdot \\max_{j,l} |a_{jl}^{(k)}|$。这是尺度不变的，但不是局部的；它取决于 $A^{(k)}$ 的全局最大元素，该元素可能由矩阵不相关的部分主导，导致延迟或过早的降阶。\n\n根据尺度不变性、局部性以及与广泛接受的实现的一致性等标准，选项A是最鲁棒和标准的降阶测试。", "answer": "$$\\boxed{A}$$", "id": "1397748"}]}