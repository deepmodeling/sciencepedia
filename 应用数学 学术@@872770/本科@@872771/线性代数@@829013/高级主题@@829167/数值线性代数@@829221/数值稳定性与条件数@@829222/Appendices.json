{"hands_on_practices": [{"introduction": "一个线性系统的求解“难度”会因为我们使用的单位（例如，米或英寸）而改变吗？这个练习探讨了条件数的一个基本性质：它对于简单的标量乘法是不变的。通过一个在不同单位系统下工作的工程团队的实际场景 [@problem_id:1379478]，你将证明条件数捕捉的是一个问题的内在敏感性，这个性质独立于我们描述该问题所选择的单位。", "problem": "两个工程团队正在分析一个小型机械结构的振动模式。该系统的行为由一个线性方程组 $M\\mathbf{x} = \\mathbf{b}$ 建模，其中 $M$ 是表示该结构物理特性（刚度矩阵）的矩阵。\n\n第一个团队在美国工作，使用英制单位。他们测量的所有物理量使得最终得到的矩阵（记为 $M_{US}$）的元素单位为磅力每英寸 (lbf/in)。\n\n第二个团队在欧洲，使用国际单位制 (SI)。他们相应的矩阵（记为 $M_{EU}$）的元素单位为牛顿每米 (N/m)。所建模的基础物理系统是相同的。\n\n给定以下转换因子：\n- 1 英寸 = 0.0254 米\n- 1 磅力 (lbf) = 4.44822 牛顿\n\n可逆矩阵 $A$ 的条件数，记为 $\\kappa(A)$，用于衡量线性方程组的解对数据误差的敏感性。其定义为 $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$，其中 $\\|\\cdot\\|$ 是一个次乘法矩阵范数。\n\n假设两个团队在分析中使用相同的矩阵范数，并且他们的矩阵都是可逆的，那么比值 $\\frac{\\kappa(M_{EU})}{\\kappa(M_{US})}$ 的精确值是多少？", "solution": "设 $K$ 表示将位移映射到力的基础物理刚度算子。两个团队用不同的单位写出相同的物理关系：\n$$\n\\mathbf{b}_{US} = M_{US}\\,\\mathbf{x}_{US}, \\qquad \\mathbf{b}_{EU} = M_{EU}\\,\\mathbf{x}_{EU}.\n$$\n设 $\\eta$ 是将磅力转换为牛顿的标量，$\\zeta$ 是将英寸转换为米的标量。对于相同的物理位移和力，数值向量满足\n$$\n\\mathbf{b}_{EU} = \\eta\\,\\mathbf{b}_{US}, \\qquad \\mathbf{x}_{EU} = \\zeta\\,\\mathbf{x}_{US}.\n$$\n将 $\\mathbf{b}_{US} = M_{US}\\mathbf{x}_{US}$ 代入第一个关系式，并使用第二个关系式，得到\n$$\n\\eta\\,M_{US}\\,\\mathbf{x}_{US} = M_{EU}\\,\\mathbf{x}_{EU} = M_{EU}\\,\\zeta\\,\\mathbf{x}_{US}.\n$$\n由于这对所有 $\\mathbf{x}_{US}$ 都成立，因此可以得出\n$$\nM_{EU}\\,\\zeta = \\eta\\,M_{US} \\quad \\Longrightarrow \\quad M_{EU} = c\\,M_{US}, \\quad \\text{其中 } c := \\frac{\\eta}{\\zeta}.\n$$\n因此 $M_{EU}$ 是 $M_{US}$ 的一个正标量倍。对于任何矩阵范数 $\\|\\cdot\\|$（它是绝对齐次的）和任何可逆矩阵 $A$，\n$$\n\\kappa(cA) = \\|cA\\|\\,\\|(cA)^{-1}\\| = |c|\\,\\|A\\| \\cdot \\left\\|\\frac{1}{c}A^{-1}\\right\\| = |c|\\,\\|A\\| \\cdot \\frac{1}{|c|}\\,\\|A^{-1}\\| = \\|A\\|\\,\\|A^{-1}\\|.\n$$\n因此 $\\kappa(M_{EU}) = \\kappa(M_{US})$，比值为\n$$\n\\frac{\\kappa(M_{EU})}{\\kappa(M_{US})} = 1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1379478"}, {"introduction": "我们已经理解了条件数是什么，现在让我们来探究一个问题是如何变得“病态的”。这个练习 [@problem_id:1379479] 演示了线性系统中方程之间糟糕的缩放（scaling）会如何急剧增大条件数，使得解对误差变得高度敏感。通过这个例子，你将亲眼看到一个看似微小的改动——将一个方程乘以一个极小的数——如何能使一个系统在数值上变得极其脆弱。", "problem": "在计算线性代数中，系统解对其输入数据的微小变化的敏感性是一个关键问题。这种敏感性由条件数量化。考虑一个场景，其中一个线性方程组由矩阵 $A$ 建模，其形式如下\n$$ A = \\begin{pmatrix} 1  & 2 \\\\ 3  & 4 \\end{pmatrix} $$\n由于一个测量缩放误差，第二个方程中的系数（对应于矩阵的第二行）被无意中乘以一个非常小的因子。这导致了一个新的扰动矩阵 $A_{\\epsilon}$，其中 $A$ 的第二行被乘以常数 $\\epsilon = 1.0 \\times 10^{-6}$。\n\n一个非奇异方阵 $M$ 关于无穷范数的条件数，记作 $\\text{cond}_{\\infty}(M)$，定义为 $\\text{cond}_{\\infty}(M) = \\|M\\|_{\\infty} \\|M^{-1}\\|_{\\infty}$，其中 $\\|M\\|_{\\infty}$ 是 $M$ 的最大绝对行和。\n\n计算条件数 $\\text{cond}_{\\infty}(A_{\\epsilon})$。将最终答案四舍五入到四位有效数字。", "solution": "给定 $A=\\begin{pmatrix}1  & 2 \\\\ 3  & 4\\end{pmatrix}$ 以及通过将第二行乘以 $\\epsilon=1.0 \\times 10^{-6}$ 得到的扰动矩阵 $A_{\\epsilon}$：\n$$\nA_{\\epsilon}=\\begin{pmatrix}1  & 2 \\\\ 3\\epsilon  & 4\\epsilon\\end{pmatrix}.\n$$\n无穷范数条件数定义为 $\\text{cond}_{\\infty}(M)=\\|M\\|_{\\infty}\\|M^{-1}\\|_{\\infty}$，其中 $\\|M\\|_{\\infty}$ 是最大绝对行和。\n\n首先，计算 $\\|A_{\\epsilon}\\|_{\\infty}$。绝对行和为\n$$\n|1|+|2|=3,\\qquad |3\\epsilon|+|4\\epsilon|=7\\epsilon.\n$$\n因此，\n$$\n\\|A_{\\epsilon}\\|_{\\infty}=\\max\\{3,7\\epsilon\\}.\n$$\n由于 $\\epsilon=1.0\\times 10^{-6}$ 且 $7\\epsilon \\ll 3$，我们有 $\\|A_{\\epsilon}\\|_{\\infty}=3$。\n\n接下来，计算 $A_{\\epsilon}^{-1}$。对于一个 $2\\times 2$ 矩阵 $\\begin{pmatrix}a  & b \\\\ c  & d\\end{pmatrix}$，其逆矩阵是 $\\frac{1}{ad-bc}\\begin{pmatrix}d  & -b \\\\ -c  & a\\end{pmatrix}$。这里 $a=1$，$b=2$，$c=3\\epsilon$，$d=4\\epsilon$，所以\n$$\n\\det(A_{\\epsilon})=ad-bc=4\\epsilon-6\\epsilon=-2\\epsilon,\n$$\n且\n$$\nA_{\\epsilon}^{-1}=\\frac{1}{-2\\epsilon}\\begin{pmatrix}4\\epsilon  & -2 \\\\ -3\\epsilon  & 1\\end{pmatrix}\n=\\begin{pmatrix}-2  & \\frac{1}{\\epsilon} \\\\ \\frac{3}{2}  & -\\frac{1}{2\\epsilon}\\end{pmatrix}.\n$$\n通过行和计算 $\\|A_{\\epsilon}^{-1}\\|_{\\infty}$：\n$$\n|-2|+\\left|\\frac{1}{\\epsilon}\\right|=2+\\frac{1}{\\epsilon},\\qquad \\left|\\frac{3}{2}\\right|+\\left|-\\frac{1}{2\\epsilon}\\right|=\\frac{3}{2}+\\frac{1}{2\\epsilon}.\n$$\n对于 $\\epsilon>0$，$2+\\frac{1}{\\epsilon}\\geq \\frac{3}{2}+\\frac{1}{2\\epsilon}$，因此\n$$\n\\|A_{\\epsilon}^{-1}\\|_{\\infty}=2+\\frac{1}{\\epsilon}.\n$$\n于是，\n$$\n\\text{cond}_{\\infty}(A_{\\epsilon})=\\|A_{\\epsilon}\\|_{\\infty}\\,\\|A_{\\epsilon}^{-1}\\|_{\\infty}=3\\left(2+\\frac{1}{\\epsilon}\\right).\n$$\n代入 $\\epsilon=1.0\\times 10^{-6}$ 得到\n$$\n\\text{cond}_{\\infty}(A_{\\epsilon})=3\\left(2+1.0\\times 10^{6}\\right)=3{,}000{,}006.\n$$\n四舍五入到四位有效数字，得到 $3.000\\times 10^{6}$。", "answer": "$$\\boxed{3.000 \\times 10^{6}}$$", "id": "1379479"}, {"introduction": "到目前为止，我们关注的是问题本身的“条件”。然而，我们如何“解决”这个问题也同样至关重要。这个练习 [@problem_id:1379519] 强调了一个数值不稳定算法（朴素高斯消元法）和一个稳定算法（带部分主元的高斯消元法）之间的差异。它展示了即使在处理一个具有数值挑战性的矩阵时，一个稳定的算法也能产生可靠的答案。通过在有限精度算术下的动手模拟，这个练习将舍入误差的抽象概念变得具体，并有力地说明了为何像主元选择这样的算法策略在数值计算中是必不可少的。", "problem": "一位数值分析师正在研究有限精度算术在求解线性方程组时的影响。该分析师考虑系统 $A\\mathbf{x} = \\mathbf{b}$，其中：\n$$\nA = \\begin{pmatrix} \\epsilon  & 1.00 \\\\ 1.00  & 1.00 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1.01 \\\\ 3.00 \\end{pmatrix}\n$$\n参数 $\\epsilon$ 是一个小数，给定为 $\\epsilon = 1.00 \\times 10^{-4}$。\n\n该分析师使用一个简化的计算机模型，该模型使用**三位有效数字的浮点算术并进行舍入**来执行所有算术运算（加、减、乘、除）。这意味着每次运算后，结果都会被舍入到三位有效数字。例如，计算结果为 $2.458$ 将被存储为 $2.46$，而结果为 $0.07891$ 将被存储为 $0.0789$。\n\n你的任务是在这些算术约束下，比较两种求解该系统的方法。\n\n首先，使用**不带部分主元选择**的高斯消去法求解该系统。设计算出的解向量为 $\\mathbf{x}_{\\text{no-pivot}} = (x_{1, \\text{np}}, x_{2, \\text{np}})^T$。\n\n其次，使用**带部分主元选择**的高斯消去法求解同一系统。在这种方法中，每次消元步骤之前，都会交换行以确保主元（用于消元的对角元素）在其所在列的尚未处理的行中具有最大绝对值。设这个计算出的解向量为 $\\mathbf{x}_{\\text{pivot}} = (x_{1, \\text{p}}, x_{2, \\text{p}})^T$。\n\n最后，计算两个计算解之差的欧几里得范数（$L_2$ 范数）：$\\|\\mathbf{x}_{\\text{pivot}} - \\mathbf{x}_{\\text{no-pivot}}\\|_2$。\n\n将你的最终答案舍入到三位有效数字。", "solution": "我们被要求使用三位有效数字的浮点算术以两种方式求解线性系统 $A\\mathbf{x} = \\mathbf{b}$，然后求两个解之间差值的欧几里得范数。系统由 $\\epsilon = 1.00 \\times 10^{-4}$ 定义：\n$$\n\\begin{pmatrix} 1.00 \\times 10^{-4}  & 1.00 \\\\ 1.00  & 1.00 \\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}\n=\n\\begin{pmatrix} 1.01 \\\\ 3.00 \\end{pmatrix}\n$$\n\n**第一部分：使用不带部分主元选择的高斯消去法求解**\n\n我们从增广矩阵 $[A|\\mathbf{b}]$ 开始：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 \\times 10^{-4}  & 1.00  & 1.01 \\\\\n1.00  & 1.00  & 3.00\n\\end{array}\n\\right]\n$$\n目标是消去第二行第一列的元素。主元是 $a_{11} = 1.00 \\times 10^{-4}$。我们计算第二行的乘数：\n$$\nm_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1.00}{1.00 \\times 10^{-4}} = 1.00 \\times 10^{4}\n$$\n这个计算在我们的三位有效数字算术中是精确的。现在我们执行行操作 $R_2 \\leftarrow R_2 - m_{21} R_1$。我们必须将第二行中的每个新元素舍入到三位有效数字。\n\n新元素 $a'_{22}$ 是：\n$$\na'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - (1.00 \\times 10^{4}) \\times 1.00 = 1.00 - 10000 = -9999\n$$\n舍入到三位有效数字，我们得到 $a'_{22} = -1.00 \\times 10^{4}$。\n\n新元素 $b'_{2}$ 是：\n$$\nb'_{2} = b_2 - m_{21} \\times b_1 = 3.00 - (1.00 \\times 10^{4}) \\times 1.01 = 3.00 - 10100 = -10097\n$$\n舍入到三位有效数字，我们得到 $b'_{2} = -1.01 \\times 10^{4}$。\n\n增广矩阵变为：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 \\times 10^{-4}  & 1.00  & 1.01 \\\\\n0  & -1.00 \\times 10^{4}  & -1.01 \\times 10^{4}\n\\end{array}\n\\right]\n$$\n现在我们执行回代。从第二行：\n$$\n(-1.00 \\times 10^{4}) x_{2, \\text{np}} = -1.01 \\times 10^{4}\n$$\n$$\nx_{2, \\text{np}} = \\frac{-1.01 \\times 10^{4}}{-1.00 \\times 10^{4}} = 1.01\n$$\n这在三位有效数字算术中是精确的。现在，使用第一行：\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} + 1.00 \\times x_{2, \\text{np}} = 1.01\n$$\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} + 1.00 \\times 1.01 = 1.01\n$$\n项 $1.00 \\times 1.01$ 是 $1.01$（在三位有效数字算术中是精确的）。\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} + 1.01 = 1.01\n$$\n$$\n(1.00 \\times 10^{-4}) x_{1, \\text{np}} = 1.01 - 1.01 = 0\n$$\n因此，$x_{1, \\text{np}} = 0$。不带主元选择的解是 $\\mathbf{x}_{\\text{no-pivot}} = \\begin{pmatrix} 0 \\\\ 1.01 \\end{pmatrix}$。\n\n**第二部分：使用带部分主元选择的高斯消去法求解**\n\n我们再次从增广矩阵开始：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00 \\times 10^{-4}  & 1.00  & 1.01 \\\\\n1.00  & 1.00  & 3.00\n\\end{array}\n\\right]\n$$\n对于部分主元选择，我们比较第一列元素的绝对值：$|a_{11}| = 1.00 \\times 10^{-4}$ 和 $|a_{21}| = 1.00$。因为 $|a_{21}| > |a_{11}|$，我们交换第1行和第2行。\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00  & 1.00  & 3.00 \\\\\n1.00 \\times 10^{-4}  & 1.00  & 1.01\n\\end{array}\n\\right]\n$$\n现在主元是 $a_{11} = 1.00$。我们计算乘数：\n$$\nm_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1.00 \\times 10^{-4}}{1.00} = 1.00 \\times 10^{-4}\n$$\n我们执行行操作 $R_2 \\leftarrow R_2 - m_{21} R_1$。\n新元素 $a'_{22}$ 是：\n$$\na'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - (1.00 \\times 10^{-4}) \\times 1.00 = 1.00 - 0.0001 = 0.9999\n$$\n舍入到三位有效数字，我们得到 $a'_{22} = 1.00$。\n\n新元素 $b'_{2}$ 是：\n$$\nb'_{2} = b_2 - m_{21} \\times b_1 = 1.01 - (1.00 \\times 10^{-4}) \\times 3.00 = 1.01 - 0.0003 = 1.0097\n$$\n舍入到三位有效数字，我们得到 $b'_{2} = 1.01$。\n\n增广矩阵变为：\n$$\n\\left[\n\\begin{array}{cc|c}\n1.00  & 1.00  & 3.00 \\\\\n0  & 1.00  & 1.01\n\\end{array}\n\\right]\n$$\n现在我们执行回代。从第二行：\n$$\n1.00 \\times x_{2, \\text{p}} = 1.01 \\implies x_{2, \\text{p}} = 1.01\n$$\n从第一行：\n$$\n1.00 \\times x_{1, \\text{p}} + 1.00 \\times x_{2, \\text{p}} = 3.00\n$$\n$$\n1.00 \\times x_{1, \\text{p}} + 1.00 \\times 1.01 = 3.00\n$$\n$$\n1.00 \\times x_{1, \\text{p}} + 1.01 = 3.00\n$$\n$$\n1.00 \\times x_{1, \\text{p}} = 3.00 - 1.01 = 1.99\n$$\n因此，$x_{1, \\text{p}} = 1.99$。带主元选择的解是 $\\mathbf{x}_{\\text{pivot}} = \\begin{pmatrix} 1.99 \\\\ 1.01 \\end{pmatrix}$。\n\n**第三部分：差值的欧几里得范数**\n\n我们需要计算 $\\|\\mathbf{x}_{\\text{pivot}} - \\mathbf{x}_{\\text{no-pivot}}\\|_2$。\n首先，求差向量：\n$$\n\\mathbf{d} = \\mathbf{x}_{\\text{pivot}} - \\mathbf{x}_{\\text{no-pivot}} = \\begin{pmatrix} 1.99 \\\\ 1.01 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1.01 \\end{pmatrix} = \\begin{pmatrix} 1.99 - 0 \\\\ 1.01 - 1.01 \\end{pmatrix} = \\begin{pmatrix} 1.99 \\\\ 0 \\end{pmatrix}\n$$\n现在，计算 $\\mathbf{d}$ 的欧几里得范数：\n$$\n\\|\\mathbf{d}\\|_2 = \\sqrt{(1.99)^2 + (0)^2} = \\sqrt{(1.99)^2} = 1.99\n$$\n结果 $1.99$ 已经是三位有效数字。", "answer": "$$\\boxed{1.99}$$", "id": "1379519"}]}