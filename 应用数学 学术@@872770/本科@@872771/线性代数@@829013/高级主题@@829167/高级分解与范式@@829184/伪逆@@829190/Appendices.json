{"hands_on_practices": [{"introduction": "这个练习为计算伪逆提供了一个平缓的入门。通过一个代表投影和缩放的简单对角矩阵，你可以直接应用摩尔-彭若斯四个条件，观察伪逆是如何“逆转”空间中有效部分的缩放，同时正确处理被投影掉的部分。这为理解更复杂的情况建立了直觉。[@problem_id:1397327]", "problem": "考虑一个线性变换 $T: \\mathbb{R}^2 \\to \\mathbb{R}^2$。该变换对任意向量 $\\mathbf{v} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ 按顺序执行以下两个操作：\n1. 将向量 $\\mathbf{v}$ 正交投影到 $x$ 轴上。\n2. 将得到的投影向量乘以一个非零实常数 $\\alpha$。\n\n设 $A$ 是此线性变换 $T$ 关于 $\\mathbb{R}^2$ 中标准基的表示矩阵。\n\n在线性代数中，一个矩阵 $M$ 的 Moore-Penrose 伪逆（记作 $M^+$）是矩阵逆的一种推广。它在求解没有唯一解的线性方程组的“最佳拟合”（最小二乘）解时特别有用。\n\n你的任务是求矩阵 $A$ 的 Moore-Penrose 伪逆 $A^+$。你的答案应该用常数 $\\alpha$ 来表示。", "solution": "到 $x$ 轴的正交投影将 $\\begin{pmatrix} x \\\\ y \\end{pmatrix}$ 映射到 $\\begin{pmatrix} x \\\\ 0 \\end{pmatrix}$。其在标准基下的矩阵为\n$$\nP=\\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n乘以一个非零实常数 $\\alpha$ 得到的线性变换矩阵为\n$$\nA=\\alpha P=\\begin{pmatrix} \\alpha  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n为求 Moore-Penrose 伪逆 $A^{+}$，令\n$$\nX=\\begin{pmatrix} x_{11}  x_{12} \\\\ x_{21}  x_{22} \\end{pmatrix}\n$$\n并施加 Moore-Penrose 条件：\n$$\n\\text{(i) } A X A = A, \\quad \\text{(ii) } X A X = X, \\quad \\text{(iii) } (A X)^{T} = A X, \\quad \\text{(iv) } (X A)^{T} = X A.\n$$\n计算\n$$\nA X = \\begin{pmatrix} \\alpha x_{11}  \\alpha x_{12} \\\\ 0  0 \\end{pmatrix}, \\quad\nA X A = \\begin{pmatrix} \\alpha^{2} x_{11}  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n条件 (i) 给出 $\\alpha^{2} x_{11} = \\alpha$，因此 $x_{11} = \\frac{1}{\\alpha}$。\n\n接下来，\n$$\nX A = \\begin{pmatrix} x_{11} \\alpha  0 \\\\ x_{21} \\alpha  0 \\end{pmatrix}, \\quad\nX A X = \\begin{pmatrix} \\alpha x_{11}^{2}  \\alpha x_{11} x_{12} \\\\ \\alpha x_{21} x_{11}  \\alpha x_{21} x_{12} \\end{pmatrix}.\n$$\n条件 (ii) 给出 $\\alpha x_{11}^{2} = x_{11}$（由 $x_{11}=\\frac{1}{\\alpha}$ 满足），$\\alpha x_{11} x_{12} = x_{12}$，$\\alpha x_{21} x_{11} = x_{21}$，以及 $x_{22} = \\alpha x_{21} x_{12}$。\n\n条件 (iii) 要求 $A X$ 是对称的：\n$$\nA X = \\begin{pmatrix} \\alpha x_{11}  \\alpha x_{12} \\\\ 0  0 \\end{pmatrix} \\quad \\Rightarrow \\quad \\alpha x_{12} = 0 \\ \\Rightarrow \\ x_{12} = 0\n$$\n因为 $\\alpha \\neq 0$。\n\n条件 (iv) 要求 $X A$ 是对称的：\n$$\nX A = \\begin{pmatrix} x_{11} \\alpha  0 \\\\ x_{21} \\alpha  0 \\end{pmatrix} \\quad \\Rightarrow \\quad x_{21} \\alpha = 0 \\ \\Rightarrow \\ x_{21} = 0.\n$$\n由于 $x_{12}=x_{21}=0$，关系式 $x_{22}=\\alpha x_{21} x_{12}$ 给出 $x_{22}=0$。因此，\n$$\nA^{+}=X=\\begin{pmatrix} \\frac{1}{\\alpha}  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n等价地，由于 $A=\\alpha P$，其中 $P$ 是一个满足 $P^{+}=P$ 的正交投影，我们有 $(\\alpha P)^{+}=\\frac{1}{\\alpha} P$，这得到了相同的结果。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{\\alpha}  0 \\\\ 0  0\\end{pmatrix}}$$", "id": "1397327"}, {"introduction": "数据科学和工程中的许多复杂矩阵可以由秩为1的矩阵近似或构建。这个练习要求你为任何表示为外积 $uv^T$ 的秩一矩阵推导出一个伪逆的通用公式。掌握它能让你高效地处理矩阵的基本构成模块，并加深你对伪逆与奇异值分解（SVD）之间联系的理解。[@problem_id:1397317]", "problem": "设 $u$ 是 $\\mathbb{R}^m$ 中的一个非零列向量，$v$ 是 $\\mathbb{R}^n$ 中的一个非零列向量。考虑由这些向量的外积构成的 $m \\times n$ 矩阵 $A$，其形式为 $A = uv^T$。\n\n矩阵 $A$ 的摩尔-彭若斯伪逆（Moore-Penrose pseudoinverse），记作 $A^+$，是满足以下四个准则的唯一矩阵：\n1. $A A^+ A = A$\n2. $A^+ A A^+ = A^+$\n3. $(A A^+)^T = A A^+$\n4. $(A^+ A)^T = A^+ A$\n\n你的任务是求出伪逆 $A^+$ 的一个闭式表达式。你的答案需要用向量 $u$ 和 $v$ 及其转置来表示。向量 $x$ 的欧几里得范数的平方定义为 $\\|x\\|^2 = x^T x$，你可以在最终表达式中使用它。", "solution": "问题要求秩为1的矩阵 $A = uv^T$ 的摩尔-彭若斯伪逆 $A^+$。计算伪逆的一个系统性方法是首先求出矩阵 $A$ 的奇异值分解（Singular Value Decomposition, SVD）。\n\n如果一个 $m \\times n$ 矩阵 $A$ 的SVD为 $A = U\\Sigma V^T$，其中 $U$ 是一个 $m \\times m$ 的正交矩阵，$V$ 是一个 $n \\times n$ 的正交矩阵，$\\Sigma$ 是一个包含奇异值的 $m \\times n$ 对角矩阵，那么伪逆 $A^+$ 由 $A^+ = V\\Sigma^+ U^T$ 给出。这里，$\\Sigma^+$ 是一个 $n \\times m$ 矩阵，通过将 $\\Sigma$ 转置，然后取每个非零元素的倒数得到。\n\n让我们来求 $A = uv^T$ 的SVD。首先，我们对向量 $u$ 和 $v$ 进行归一化。设 $\\hat{u} = \\frac{u}{\\|u\\|}$ 和 $\\hat{v} = \\frac{v}{\\|v\\|}$。注意，$\\hat{u}$ 和 $\\hat{v}$ 是单位向量，其范数分别为 $\\|u\\| = \\sqrt{u^T u}$ 和 $\\|v\\| = \\sqrt{v^T v}$。\n\n我们可以用这些单位向量重写矩阵 $A$：\n$A = uv^T = (\\|u\\|\\hat{u})(\\|v\\|\\hat{v})^T = (\\|u\\| \\|v\\|) \\hat{u} \\hat{v}^T$\n\n这个表达式已经是奇异值分解的形式了。对于一个秩为1的矩阵，只有一个非零的奇异值，$\\sigma_1$。与秩为1矩阵的一般SVD形式 $A = \\sigma_1 u_1 v_1^T$ 比较，我们可以确定：\n- 单个非零奇异值为：$\\sigma_1 = \\|u\\| \\|v\\|$。\n- $U$ 的第一列：$u_1 = \\hat{u}$。\n- $V$ 的第一列：$v_1 = \\hat{v}$。\n\n矩阵 $\\Sigma$ 是一个 $m \\times n$ 矩阵，其左上角元素为 $\\sigma_1$，其他元素均为零：\n$$\n\\Sigma = \\begin{pmatrix}\n\\sigma_1  0  \\dots  0 \\\\\n0  0  \\dots  0 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n0  0  \\dots  0\n\\end{pmatrix}\n$$\n为了构造 $A^+$，我们首先需要 $\\Sigma^+$。这是一个 $n \\times m$ 矩阵，其中唯一的非零元素位于左上角，其值为 $\\sigma_1$ 的倒数：\n$$\n\\Sigma^+ = \\begin{pmatrix}\n1/\\sigma_1  0  \\dots  0 \\\\\n0  0  \\dots  0 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n0  0  \\dots  0\n\\end{pmatrix}\n$$\n完整的矩阵 $U$ 和 $V$ 可以通过补全标准正交基来构成。设 $U = [u_1 \\ u_2 \\dots u_m]$ 和 $V = [v_1 \\ v_2 \\dots v_n]$。伪逆则可计算为 $A^+ = V\\Sigma^+ U^T$。\n\n$A^+ = V \\Sigma^+ U^T = \\begin{pmatrix} v_1  v_2  \\dots  v_n \\end{pmatrix} \\begin{pmatrix}\n1/\\sigma_1  0  \\dots \\\\\n0  0  \\dots \\\\\n\\vdots  \\vdots  \\ddots\n\\end{pmatrix} \\begin{pmatrix} u_1^T \\\\ u_2^T \\\\ \\vdots \\\\ u_m^T \\end{pmatrix}$\n\n执行矩阵乘法，乘积 $\\Sigma^+ U^T$ 得到一个 $n \\times m$ 矩阵，其第一行为 $(1/\\sigma_1)u_1^T$，其余所有行均为零。然后，从左侧乘以 $V$ 会选出 $V$ 的第一列 $v_1$，并用 $\\Sigma^+ U^T$ 的第一行对其进行缩放。结果为：\n$A^+ = v_1 \\left( \\frac{1}{\\sigma_1} u_1^T \\right) = \\frac{1}{\\sigma_1} v_1 u_1^T$。\n\n现在，我们将 $\\sigma_1$、$u_1$ 和 $v_1$ 的表达式代回：\n$\\sigma_1 = \\|u\\| \\|v\\|$\n$u_1 = \\hat{u} = \\frac{u}{\\|u\\|}$\n$v_1 = \\hat{v} = \\frac{v}{\\|v\\|}$\n\n所以，\n$A^+ = \\frac{1}{\\|u\\| \\|v\\|} \\left( \\frac{v}{\\|v\\|} \\right) \\left( \\frac{u}{\\|u\\|} \\right)^T = \\frac{1}{\\|u\\|^2 \\|v\\|^2} v u^T$。\n\n最后，使用所提供的范数平方的定义 $\\|x\\|^2 = x^T x$，我们可以将最终表达式写为：\n$A^+ = \\frac{1}{(u^T u)(v^T v)} v u^T$。", "answer": "$$\\boxed{\\frac{1}{(u^T u)(v^T v)} v u^T}$$", "id": "1397317"}, {"introduction": "真实世界的数据经常包含冗余信息，导致矩阵出现线性相关的列——这种情况被称为多重共线性。这个问题就展示了这样一个案例，并要求你计算其伪逆，为你之前探索的秩一矩阵公式提供了一个具体应用。这个练习展示了即使在标准方法失效时，伪逆如何为线性模型提供一个寻找最佳可能解的稳健工具。[@problem_id:1397263]", "problem": "在一个简化的数据分析场景中，一个线性模型由矩阵方程 $Ax = b$ 表示。设计矩阵 $A$ 将模型参数映射到观测值，其列被发现是线性相关的，这是一个被称为多重共线性的常见问题。具体的矩阵由下式给出：\n$$A = \\begin{pmatrix} 1  1 \\\\ 2  2 \\end{pmatrix}$$\n这种线性相关性意味着矩阵 $A^T A$ 是奇异的，因此标准的正规方程组不能通过简单的求逆来求解。为了找到对于任意向量 $b$ 的唯一最小范数最小二乘解，我们必须计算 $A$ 的摩尔-彭若斯伪逆，记作 $A^+$。\n\n计算给定矩阵 $A$ 的摩尔-彭若斯伪逆 $A^+$。", "solution": "我们注意到 $A$ 的列是线性相关的，且秩为 $1$。它可以写成一个外积\n$$\nA = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1  1 \\end{pmatrix} = u v^{T},\n$$\n其中 $u = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 且 $v = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n对于一个非零的秩一矩阵 $A = u v^{T}$，其奇异值分解为 $A = \\sigma \\hat{u} \\hat{v}^{T}$，其中 $\\hat{u} = u / \\|u\\|$，$\\hat{v} = v / \\|v\\|$，以及 $\\sigma = \\|u\\| \\|v\\|$。那么摩尔-彭若斯伪逆是\n$$\nA^{+} = \\sigma^{-1} \\hat{v} \\hat{u}^{T} = \\frac{1}{\\|u\\| \\|v\\|} \\cdot \\frac{v}{\\|v\\|} \\cdot \\frac{u^{T}}{\\|u\\|} = \\frac{v u^{T}}{\\|u\\|^{2} \\|v\\|^{2}} = \\frac{v u^{T}}{(u^{T} u)(v^{T} v)}.\n$$\n计算所需的标量：\n$$\nu^{T} u = 1^{2} + 2^{2} = 5, \\qquad v^{T} v = 1^{2} + 1^{2} = 2.\n$$\n因此，\n$$\nA^{+} = \\frac{1}{5 \\cdot 2} \\, v u^{T} = \\frac{1}{10} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  2 \\end{pmatrix} = \\frac{1}{10} \\begin{pmatrix} 1  2 \\\\ 1  2 \\end{pmatrix}.\n$$\n快速验证一个摩尔-彭若斯条件：\n$$\nA A^{+} A = \\begin{pmatrix} 1  1 \\\\ 2  2 \\end{pmatrix} \\left( \\frac{1}{10} \\begin{pmatrix} 1  2 \\\\ 1  2 \\end{pmatrix} \\right) \\begin{pmatrix} 1  1 \\\\ 2  2 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 2  2 \\end{pmatrix} = A,\n$$\n并且 $A A^{+}$ 是对称的，符合要求。因此该表达式就是摩尔-彭若斯伪逆。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{10}  \\frac{1}{5} \\\\ \\frac{1}{10}  \\frac{1}{5} \\end{pmatrix}}$$", "id": "1397263"}]}