{"hands_on_practices": [{"introduction": "在数值计算中，一个看似无害的微小主元（pivot）可能引发灾难性的精度损失，这就是所谓的数值不稳定性。这个练习将通过一个具体的例子，让你直观地感受到部分主元法（partial pivoting）的重要性。通过对比对同一个矩阵进行标准 LU 分解和带主元选择的 LU 分解，你将清晰地看到为何主元策略是确保数值稳定性的关键。[@problem_id:1383205]", "problem": "考虑矩阵 $A$ 定义如下：\n$$\nA = \\begin{pmatrix} \\epsilon  2 \\\\ 1  3 \\end{pmatrix}\n$$\n其中 $\\epsilon = 10^{-8}$ 是一个很小的正常数。\n\n我们将对矩阵 $A$ 执行两种类型的 LU 分解。\n\n首先，求 $A$ 的标准 LU 分解，使得 $A = LU$。在此分解中，$L$ 是一个单位下三角矩阵（主对角线上元素为1），$U$ 是一个上三角矩阵。设矩阵 $U$ 的第二行第二列的元素记为 $u_{22}$。\n\n其次，使用部分主元策略求 $A$ 的 LU 分解。该策略得到一个形式为 $PA = L'U'$ 的分解，其中 $P$ 是一个排列矩阵，其选择是为了最大化每列主元的绝对值，$L'$ 是一个单位下三角矩阵，$U'$ 是一个上三角矩阵。设矩阵 $U'$ 的第二行第二列的元素记为 $u'_{22}$。\n\n计算和 $u_{22} + u'_{22}$ 的数值。", "solution": "我们使用不带主元选择的 Doolittle LU 分解，然后再使用带部分主元选择的分解。\n\n无主元选择时，记 $A=LU$，其中\n$$\nL=\\begin{pmatrix}1  0\\\\ \\ell_{21}  1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}  u_{12}\\\\ 0  u_{22}\\end{pmatrix}.\n$$\n匹配 $A=\\begin{pmatrix}\\epsilon  2\\\\ 1  3\\end{pmatrix}$ 可得标准关系：\n$$\nu_{11}=a_{11}=\\epsilon,\\quad u_{12}=a_{12}=2,\\quad \\ell_{21}=\\frac{a_{21}}{u_{11}}=\\frac{1}{\\epsilon},\n$$\n以及\n$$\nu_{22}=a_{22}-\\ell_{21}u_{12}=3-\\frac{1}{\\epsilon}\\cdot 2=3-\\frac{2}{\\epsilon}.\n$$\n\n采用部分主元选择时，由于 $|1||\\epsilon|$，我们首先交换行，得到\n$$\nPA=\\begin{pmatrix}1  3\\\\ \\epsilon  2\\end{pmatrix}.\n$$\n将 $PA$ 分解为 $PA=L'U'$，其中\n$$\nL'=\\begin{pmatrix}1  0\\\\ \\ell'_{21}  1\\end{pmatrix},\\quad\nU'=\\begin{pmatrix}u'_{11}  u'_{12}\\\\ 0  u'_{22}\\end{pmatrix}.\n$$\n于是\n$$\nu'_{11}=1,\\quad u'_{12}=3,\\quad \\ell'_{21}=\\frac{\\epsilon}{u'_{11}}=\\epsilon,\n$$\n以及\n$$\nu'_{22}=2-\\ell'_{21}u'_{12}=2-3\\epsilon.\n$$\n\n因此，\n$$\nu_{22}+u'_{22}=\\left(3-\\frac{2}{\\epsilon}\\right)+(2-3\\epsilon)=5-\\frac{2}{\\epsilon}-3\\epsilon.\n$$\n代入 $\\epsilon=10^{-8}$：\n$$\n\\frac{2}{\\epsilon}=2\\times 10^{8},\\qquad 3\\epsilon=3\\times 10^{-8},\n$$\n所以\n$$\nu_{22}+u'_{22}=5-2\\times 10^{8}-3\\times 10^{-8}=-199999995.00000003.\n$$", "answer": "$$\\boxed{-199999995.00000003}$$", "id": "1383205"}, {"introduction": "理解了为何需要主元选择后，下一步是掌握*何时*进行主元操作。部分主元法的核心规则是在当前主元列的下方（包括主元自身）寻找绝对值最大的元素，并将其交换至主元位置。这个练习将帮助你巩固这一判断准则，通过确定一个矩阵元素在何种取值范围内会触发一次行交换，从而让你对主元法的执行条件有更深刻的理解。[@problem_id:1383208]", "problem": "在数值线性代数中，当执行高斯消元法以求矩阵的LU分解（下三角-上三角分解）时，采用主元策略来增强数值稳定性并避免除以零通常至关重要。一种常见的方法是部分主元策略。在此策略中，对于每一列 k（从 k=1 开始），我们在该列中对角线上或其下方的元素中（即行 i ≥ k）找到绝对值最大的元素。如果这个元素不是对角元素 $a_{kk}$，则执行行交换，将绝对值最大的元素移动到主元位置。\n\n考虑矩阵 $A$：\n$$\nA = \\begin{pmatrix} x  5 \\\\ 10  2 \\end{pmatrix}\n$$\n其中 $x$ 是一个实数。\n\n当使用部分主元策略时，下列哪个选项描述了在高斯消元法的第一步中需要进行行交换的 $x$ 的完整取值范围？\n\nA. $x > 10$\n\nB. $x  -10$\n\nC. $-10  x  10$\n\nD. $x  -10$ 或 $x > 10$\n\nE. $x = 10$ 或 $x = -10$", "solution": "在部分主元策略的步骤 $k=1$ 中，主元选为第 1 列中行 $i \\geq 1$ 的元素里绝对值最大的那一个。对于\n$$\nA=\\begin{pmatrix} x  5 \\\\ 10  2 \\end{pmatrix},\n$$\n候选元素是 $|a_{11}|=|x|$ 和 $|a_{21}|=|10|=10$。当且仅当最大绝对值出现在非当前主元行时，才需要进行行交换，即当 $|x|  10$ 时。如果 $|x| > 10$，对角元素已经是最大的，不需要交换。如果 $|x| = 10$，则存在相等的情况；由于对角元素是最大值之一，因此不必进行交换。因此，恰好当 $-10  x  10$ 时才需要行交换。", "answer": "$$\\boxed{C}$$", "id": "1383208"}, {"introduction": "现在，让我们将所有知识融会贯通，在一个更复杂的场景中完整地执行部分主元法。对于一个 $3 \\times 3$ 矩阵，高斯消元法需要两个步骤，而每一步都可能需要进行一次行交换。这个练习要求你追踪整个过程，在每一步消元后，根据更新后的矩阵重新判断是否需要进行主元操作，这能有效地检验你对完整部分主元算法的掌握程度。[@problem_id:1383199]", "problem": "在数值线性代数中，矩阵 $A$ 的下三角-上三角 (LU) 分解通常使用高斯消元法进行。为了增强数值稳定性，会采用主元策略。一种常见的方法是部分主元法。\n\n部分主元策略在消元过程的第 $k$ 步（目标是在第 $k$ 列主对角线下方制造零元素）涉及以下步骤：\n1.  在第 $k$ 列中，从第 $k$ 行到最后一行，找到绝对值最大的元素。\n2.  如果这个元素不在主元位置（第 $k$ 行，第 $k$ 列），则进行一次行交换，将包含该元素的行移动到第 $k$ 行。\n\n对于一个 $3 \\times 3$ 矩阵，这个过程涉及两个消元步骤：第一步，在第 1 列的主元下方制造零元素；第二步，在第 2 列的主元下方制造一个零元素。\n\n在使用部分主元策略进行 LU 分解时，下列哪个非奇异 $3 \\times 3$ 矩阵在**每**一个消元步骤（即第一列和第二列）都需要进行一次行交换？\n\nA. $A = \\begin{pmatrix} 4  1  1 \\\\ 2  3  1 \\\\ 1  1  2 \\end{pmatrix}$\n\nB. $B = \\begin{pmatrix} 1  1  1 \\\\ 2  3  1 \\\\ 4  4  1 \\end{pmatrix}$\n\nC. $C = \\begin{pmatrix} 1  3  1 \\\\ 2  2  1 \\\\ 4  4  1 \\end{pmatrix}$\n\nD. $D = \\begin{pmatrix} 4  4  1 \\\\ 2  2  1 \\\\ 1  3  1 \\end{pmatrix}$", "solution": "在第 $k$ 步采用部分主元法时，主元选为第 $k$ 列中，从第 $k$ 行到第 $n$ 行里绝对值最大的元素。如果该最大值元素不在第 $k$ 行，则进行一次行交换。对于一个 $3\\times 3$ 的系统，我们检查 $k=1$ 和 $k=2$ 两个步骤。\n\n矩阵 A: $A=\\begin{pmatrix}4  1  1\\\\2  3  1\\\\1  1  2\\end{pmatrix}$。在第 $1$ 列中，元素的绝对值是 $|4|,|2|,|1|$，最大值 $4$ 已在第 $1$ 行，所以在第 $1$ 步无需行交换。因此，A 不需要每一步都进行交换。\n\n矩阵 B: $B=\\begin{pmatrix}1  1  1\\\\2  3  1\\\\4  4  1\\end{pmatrix}$。第 $1$ 步：第 $1$ 列的绝对值为 $|1|,|2|,|4|$；最大值 $4$ 位于第 $3$ 行，所以交换第 $1$ 行和第 $3$ 行得到\n$$\n\\begin{pmatrix}\n4  4  1\\\\\n2  3  1\\\\\n1  1  1\n\\end{pmatrix}.\n$$\n使用乘子 $m_{21}=\\frac{2}{4}=\\frac{1}{2}$ 和 $m_{31}=\\frac{1}{4}$ 在主元下方进行消元：\n$$\n\\text{Row}_{2}\\leftarrow \\text{Row}_{2}-\\tfrac{1}{2}\\text{Row}_{1}:\\ (0, 1, \\tfrac{1}{2}),\n\\quad\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-\\tfrac{1}{4}\\text{Row}_{1}:\\ (0, 0, \\tfrac{3}{4}),\n$$\n所以第 $1$ 步后矩阵为\n$$\n\\begin{pmatrix}\n4  4  1\\\\\n0  1  \\tfrac{1}{2}\\\\\n0  0  \\tfrac{3}{4}\n\\end{pmatrix}.\n$$\n第 $2$ 步：在第 $2$ 列（第 $2$ 行和第 $3$ 行），元素的绝对值是 $|1|$ 和 $|0|$，所以最大值已在第 $2$ 行；第 $2$ 步无需行交换。因此，B 不需要每一步都进行交换。\n\n矩阵 C: $C=\\begin{pmatrix}1  3  1\\\\2  2  1\\\\4  4  1\\end{pmatrix}$。第 $1$ 步：第 $1$ 列的绝对值为 $|1|,|2|,|4|$；最大值 $4$ 位于第 $3$ 行，所以交换第 $1$ 行和第 $3$ 行：\n$$\n\\begin{pmatrix}\n4  4  1\\\\\n2  2  1\\\\\n1  3  1\n\\end{pmatrix}.\n$$\n使用乘子 $m_{21}=\\frac{2}{4}=\\frac{1}{2}$ 和 $m_{31}=\\frac{1}{4}$ 在下方进行消元：\n$$\n\\text{Row}_{2}\\leftarrow \\text{Row}_{2}-\\tfrac{1}{2}\\text{Row}_{1}:\\ (0, 0, \\tfrac{1}{2}),\n\\quad\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-\\tfrac{1}{4}\\text{Row}_{1}:\\ (0, 2, \\tfrac{3}{4}),\n$$\n所以第 $1$ 步后矩阵为\n$$\n\\begin{pmatrix}\n4  4  1\\\\\n0  0  \\tfrac{1}{2}\\\\\n0  2  \\tfrac{3}{4}\n\\end{pmatrix}.\n$$\n第 $2$ 步：在第 $2$ 列（第 $2$ 行和第 $3$ 行），元素的绝对值是 $|0|$ 和 $|2|$；最大值位于第 $3$ 行，而不是第 $2$ 行，所以在第 $2$ 步需要进行一次行交换。因此，C 在两个步骤中都需要进行交换。\n\n矩阵 D: $D=\\begin{pmatrix}4  4  1\\\\2  2  1\\\\1  3  1\\end{pmatrix}$。在第 $1$ 列中，元素的绝对值是 $|4|,|2|,|1|$，最大值 $4$ 已在第 $1$ 行，所以在第 $1$ 步无需行交换。因此，D 不需要每一步都进行交换。\n\n因此，只有矩阵 C 在使用部分主元法时，在两个消元步骤中都需要进行行交换。", "answer": "$$\\boxed{C}$$", "id": "1383199"}]}