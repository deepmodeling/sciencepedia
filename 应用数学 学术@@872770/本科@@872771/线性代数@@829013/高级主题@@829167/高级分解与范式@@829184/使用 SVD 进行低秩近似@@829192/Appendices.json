{"hands_on_practices": [{"introduction": "首先，让我们通过一个直接应用理论的例子来练习。这个练习将引导你完成计算给定矩阵的最佳秩-1近似的关键步骤，从寻找奇异值到构建最终的近似矩阵。掌握这个过程是在实践中应用低秩近似的第一步。[@problem_id:1374759]", "problem": "在许多应用中，例如图像压缩和数据分析，用另一个较低秩的矩阵来近似一个给定矩阵是很有用的。对于一个给定的矩阵 $A$，其“最佳”秩-$k$近似是一个秩为 $k$ 的矩阵 $A_k$，它最小化了误差的弗罗贝尼乌斯范数 $\\|A - A_k\\|_F$。其中，一个矩阵 $M$（其元素为 $m_{ij}$）的弗罗贝尼乌斯范数定义为 $\\|M\\|_F = \\sqrt{\\sum_{i,j} |m_{ij}|^2}$。\n\n考虑如下给定的矩阵 $A$：\n$$A = \\begin{pmatrix} 1  1  2 \\\\ 1  1  2 \\\\ 1  -1  0 \\end{pmatrix}$$\n该矩阵的秩为 2。你的任务是找到矩阵 $A$ 的最佳秩-1 近似矩阵 $A_1$。", "solution": "为了在弗罗贝尼乌斯范数下找到最佳的秩-1 近似，我们使用截断奇异值分解：如果 $A = \\sum_{i=1}^{r} \\sigma_{i} u_{i} v_{i}^{T}$，其中奇异值 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots$，那么最佳的秩-1 近似就是 $A_{1} = \\sigma_{1} u_{1} v_{1}^{T}$。\n\n计算 $A A^{T}$ 以获得奇异值的平方：\n$$\nA = \\begin{pmatrix} 1  1  2 \\\\ 1  1  2 \\\\ 1  -1  0 \\end{pmatrix}, \\quad\nA A^{T} = \\begin{pmatrix} 6  6  0 \\\\ 6  6  0 \\\\ 0  0  2 \\end{pmatrix}.\n$$\n$A A^{T}$ 的特征值为 $12$、$2$ 和 $0$。因此，奇异值为 $\\sigma_{1} = 2\\sqrt{3}$，$\\sigma_{2} = \\sqrt{2}$ 和 $\\sigma_{3} = 0$。\n\n$A A^{T}$ 对应于特征值 $12$ 的一个特征向量与 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 成比例。将其单位化得到\n$$\nu_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n通过以下公式计算相应的右奇异向量\n$$\nv_{1} = \\frac{1}{\\sigma_{1}} A^{T} u_{1}.\n$$\n首先得到\n$$\nA^{T} u_{1} = \\begin{pmatrix} 1  1  1 \\\\ 1  1  -1 \\\\ 2  2  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 2 \\\\ 4 \\end{pmatrix} = \\sqrt{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix},\n$$\n所以\n$$\nv_{1} = \\frac{1}{2\\sqrt{3}} \\sqrt{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix} = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix}.\n$$\n因此，\n$$\nA_{1} = \\sigma_{1} u_{1} v_{1}^{T}\n= \\left(2\\sqrt{3}\\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1  1  2 \\end{pmatrix} \\right)\n= \\begin{pmatrix} 1  1  2 \\\\ 1  1  2 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n这个矩阵的秩为 $1$，并且是 $A$ 在弗罗贝尼乌斯范数下的最佳秩-1 近似。", "answer": "$$\\boxed{\\begin{pmatrix} 1  1  2 \\\\ 1  1  2 \\\\ 0  0  0 \\end{pmatrix}}$$", "id": "1374759"}, {"introduction": "接下来，我们来处理一个更复杂的案例，它涉及一个幂零矩阵。虽然这个矩阵本身结构简单，但其最佳秩-1近似揭示了更复杂的性质，需要仔细的代数处理。这个问题表明，SVD的威力在于揭示那些不那么直观的重要数据结构。[@problem_id:1374797]", "problem": "在数据压缩和机器学习等多个领域，一个常见的任务是用一个更简单的低秩矩阵来近似一个复杂的矩阵。根据 Eckart-Young-Mirsky 定理，一个矩阵的最佳秩$k$近似可以通过其奇异值分解 (SVD) 找到。\n\n考虑如下定义的幂零 $3 \\times 3$ 矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n0  1  1 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n你的任务是找到一个秩为1的矩阵 $B$，使其最接近 $A$。这里矩阵之间的“接近度”使用弗罗贝尼乌斯范数来衡量。对于两个相同维度的矩阵 $M$ 和 $N$，弗罗贝尼乌斯距离的平方为 $\\|M-N\\|_F^2 = \\sum_{i,j} |M_{ij} - N_{ij}|^2$。找到最小化此距离的矩阵 $B$ 等价于找到最佳秩1近似。\n\n请给出结果矩阵 $B$。矩阵的元素应表示为精确值，而非小数值。", "solution": "根据 Eckart-Young-Mirsky 定理，矩阵 $A$ 在弗罗贝尼乌斯范数下的最佳秩1近似由 $B=\\sigma_{1}u_{1}v_{1}^{T}$ 给出，其中 $\\sigma_{1}$ 是 $A$ 的最大奇异值，而 $u_{1},v_{1}$ 是对应的左、右奇异向量。奇异值是 $A^{T}A$ 的特征值的平方根。\n\n计算 $A^{T}A$：\n$$\nA^{T}A=\\begin{pmatrix}\n0  0  0 \\\\\n0  1  1 \\\\\n0  1  2\n\\end{pmatrix}.\n$$\n其非零部分是 $2\\times 2$ 分块 $\\begin{pmatrix}1  1 \\\\ 1  2\\end{pmatrix}$，其特征多项式为\n$$\n\\det\\begin{pmatrix}1-\\lambda  1 \\\\ 1  2-\\lambda\\end{pmatrix}=(1-\\lambda)(2-\\lambda)-1=\\lambda^{2}-3\\lambda+1.\n$$\n因此 $A^{T}A$ 的特征值为 $\\lambda_{1}=\\frac{3+\\sqrt{5}}{2}$、$\\lambda_{2}=\\frac{3-\\sqrt{5}}{2}$ 和 $0$。最大奇异值为 $\\sigma_{1}=\\sqrt{\\lambda_{1}}$。\n\n对于 $\\lambda_{1}$，$A^{T}A$ 的一个特征向量 $v$ 的第一个分量为零（因为 $\\lambda_{1}\\neq 0$ 且 $A^{T}A$ 的第一行为零），因此可设 $v=[0,x,y]^{T}$，并求解\n$$\n\\begin{pmatrix}1  1 \\\\ 1  2\\end{pmatrix}\\begin{pmatrix}x \\\\ y\\end{pmatrix}=\\lambda_{1}\\begin{pmatrix}x \\\\ y\\end{pmatrix}.\n$$\n从 $(1-\\lambda_{1})x+y=0$ 我们得到 $y=(\\lambda_{1}-1)x$。选择 $x=1$ 得到一个特征向量 $v_{1,\\text{unnorm}}=[0,1,\\lambda_{1}-1]^{T}$。其范数的平方为\n$$\n\\|v_{1,\\text{unnorm}}\\|^{2}=1+(\\lambda_{1}-1)^{2}.\n$$\n利用 $\\lambda_{1}^{2}-3\\lambda_{1}+1=0$，我们有 $(\\lambda_{1}-1)^{2}=\\lambda_{1}$，因此 $\\|v_{1,\\text{unnorm}}\\|^{2}=\\lambda_{1}+1$。所以，单位右奇异向量为\n$$\nv_{1}=\\frac{1}{\\sqrt{\\lambda_{1}+1}}\\begin{pmatrix}0 \\\\ 1 \\\\ \\lambda_{1}-1\\end{pmatrix}.\n$$\n接下来计算 $A v_{1}$：\n$$\nA\\begin{pmatrix}0 \\\\ 1 \\\\ \\lambda_{1}-1\\end{pmatrix}=\\begin{pmatrix}1+(\\lambda_{1}-1) \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}\\lambda_{1} \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix},\n$$\n所以\n$$\nA v_{1}=\\frac{1}{\\sqrt{\\lambda_{1}+1}}\\begin{pmatrix}\\lambda_{1} \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix}.\n$$\n由于 $\\|A v_{1}\\|=\\sigma_{1}$，左奇异向量为 $u_{1}=(A v_{1})/\\sigma_{1}$。最佳秩1近似为 $B=\\sigma_{1}u_{1}v_{1}^{T}=(A v_{1})v_{1}^{T}$。因此\n$$\nB=\\frac{1}{\\lambda_{1}+1}\\begin{pmatrix}\\lambda_{1} \\\\ \\lambda_{1}-1 \\\\ 0\\end{pmatrix}\\begin{pmatrix}0  1  \\lambda_{1}-1\\end{pmatrix}.\n$$\n进行外积运算得到\n$$\nB=\\frac{1}{\\lambda_{1}+1}\\begin{pmatrix}\n0  \\lambda_{1}  \\lambda_{1}(\\lambda_{1}-1) \\\\\n0  \\lambda_{1}-1  (\\lambda_{1}-1)^{2} \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n使用 $\\lambda_{1}^{2}=3\\lambda_{1}-1$ 和 $(\\lambda_{1}-1)^{2}=\\lambda_{1}$，我们化简矩阵元素：\n$$\nB=\\frac{1}{\\lambda_{1}+1}\\begin{pmatrix}\n0  \\lambda_{1}  2\\lambda_{1}-1 \\\\\n0  \\lambda_{1}-1  \\lambda_{1} \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n代入 $\\lambda_{1}=\\frac{3+\\sqrt{5}}{2}$ 并将每个分数有理化：\n- $\\frac{\\lambda_{1}}{\\lambda_{1}+1}=\\frac{\\frac{3+\\sqrt{5}}{2}}{\\frac{5+\\sqrt{5}}{2}}=\\frac{3+\\sqrt{5}}{5+\\sqrt{5}}=\\frac{5+\\sqrt{5}}{10}$,\n- $\\frac{\\lambda_{1}-1}{\\lambda_{1}+1}=\\frac{\\frac{1+\\sqrt{5}}{2}}{\\frac{5+\\sqrt{5}}{2}}=\\frac{1+\\sqrt{5}}{5+\\sqrt{5}}=\\frac{\\sqrt{5}}{5}$,\n- $\\frac{2\\lambda_{1}-1}{\\lambda_{1}+1}=\\frac{2+\\sqrt{5}}{\\frac{5+\\sqrt{5}}{2}}=\\frac{5+3\\sqrt{5}}{10}$.\n\n因此，最佳秩1近似为\n$$\nB=\\begin{pmatrix}\n0  \\frac{5+\\sqrt{5}}{10}  \\frac{5+3\\sqrt{5}}{10} \\\\\n0  \\frac{\\sqrt{5}}{5}  \\frac{5+\\sqrt{5}}{10} \\\\\n0  0  0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n0  \\frac{5+\\sqrt{5}}{10}  \\frac{5+3\\sqrt{5}}{10} \\\\\n0  \\frac{\\sqrt{5}}{5}  \\frac{5+\\sqrt{5}}{10} \\\\\n0  0  0\n\\end{pmatrix}}$$", "id": "1374797"}, {"introduction": "最后一个实践问题将我们的重点从计算转向概念理解。通过预先提供SVD的各个组成部分，这个练习挑战你思考连续近似的属性以及SVD的层次结构。它检验你对Eckart-Young-Mirsky定理的掌握是否超越了简单的公式应用。[@problem_id:1374757]", "problem": "考虑一个大小为 $3 \\times 4$ 的实数矩阵 $A$。矩阵 $A$ 的奇异值分解（SVD）由乘积 $A = U\\Sigma V^T$ 给出，其中各分量矩阵如下：\n$$\nU = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n\\Sigma = \\begin{pmatrix} 10  0  0  0 \\\\ 0  5  0  0 \\\\ 0  0  2  0 \\end{pmatrix}\n$$\n$$\nV^T = \\begin{pmatrix} 1/2  1/2  1/2  1/2 \\\\ 1/2  -1/2  1/2  -1/2 \\\\ 1/2  1/2  -1/2  -1/2 \\\\ 1/2  -1/2  -1/2  1/2 \\end{pmatrix}\n$$\n令 $A_2$ 是矩阵 $A$ 的最佳2阶近似。接着，令 $B$ 是矩阵 $A_2$ 的最佳1阶近似。“最佳”近似定义为在目标阶数的矩阵中，使得与原矩阵之差的弗罗贝尼乌斯范数最小的矩阵。\n\n求矩阵 $B$ 第一行第三列的元素值。", "solution": "我们使用奇异值分解 $A=U\\Sigma V^{T}$，其中 $U\\in\\mathbb{R}^{3\\times 3}$ 是正交矩阵，$V\\in\\mathbb{R}^{4\\times 4}$ 是正交矩阵，而 $\\Sigma\\in\\mathbb{R}^{3\\times 4}$ 的主对角线上有奇异值 $\\sigma_{1}\\geq\\sigma_{2}\\geq\\sigma_{3}\\geq 0$。在弗罗贝尼乌斯范数下的最佳 $k$ 阶近似由截断SVD（Eckart–Young 定理）给出：\n$$\nA_{k}=\\sum_{i=1}^{k}\\sigma_{i}u_{i}v_{i}^{T},\n$$\n其中 $u_{i}$ 和 $v_{i}$ 分别是 $U$ 和 $V$ 的第 $i$ 列。\n\n根据所给数据，$U=I_{3}$，所以 $u_{1}=\\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}$，$u_{2}=\\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix}$，$u_{3}=\\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix}$。从 $\\Sigma$ 中可以读出奇异值为 $\\sigma_{1}=10$，$\\sigma_{2}=5$，$\\sigma_{3}=2$。矩阵 $V^{T}$ 已知，所以 $v_{1}$ 是 $V$ 的第一列，它等于 $V^{T}$ 第一行的转置：\n$$\nv_{1}=\\begin{pmatrix}\\frac{1}{2}\\\\ \\frac{1}{2}\\\\ \\frac{1}{2}\\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n\n首先，$A$ 的最佳2阶近似 $A_{2}$ 是\n$$\nA_{2}=\\sigma_{1}u_{1}v_{1}^{T}+\\sigma_{2}u_{2}v_{2}^{T}.\n$$\n它的奇异值是 $\\sigma_{1}$ 和 $\\sigma_{2}$，对应的奇异向量与 $u_{1},v_{1}$ 和 $u_{2},v_{2}$ 相同。\n\n接下来，$B$ 是 $A_2$ 的最佳1阶近似。根据同样的截断SVD原理，这只保留了最大的奇异值三元组：\n$$\nB=\\sigma_{1}u_{1}v_{1}^{T}.\n$$\n\n要提取 $B$ 的第一行第三列的元素，我们使用外积形式。对于 $B=\\sigma_{1}u_{1}v_{1}^{T}$，其 $(i,j)$ 项为\n$$\nB_{ij}=\\sigma_{1}\\,u_{1,i}\\,v_{1,j}.\n$$\n具体来说，$u_{1,1}=1$ 并且 $v_{1,3}=\\frac{1}{2}$。因此，\n$$\nB_{1,3}=\\sigma_{1}\\cdot 1\\cdot \\frac{1}{2}=10\\cdot\\frac{1}{2}=5.\n$$", "answer": "$$\\boxed{5}$$", "id": "1374757"}]}