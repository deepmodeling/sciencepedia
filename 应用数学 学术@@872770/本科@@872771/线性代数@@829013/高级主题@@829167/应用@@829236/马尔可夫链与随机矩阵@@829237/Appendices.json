{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方式就是实践。让我们从一个基础练习开始，将一个具体场景转化为马尔可夫链模型。这个练习将帮助你掌握如何根据问题描述构建转移矩阵，并利用它来预测系统在未来几个时间步后的状态。通过计算两步转移概率，你将直观地理解即使两点之间无法一步直达，也可以通过中间状态实现转移。[@problem_id:1375578]", "problem": "一个用于描述新社交媒体平台用户导航的简化模型，考虑了用户在任何一分钟内可能处于的三种状态：\n1.  **状态1：浏览动态**\n2.  **状态2：创建帖子**\n3.  **状态3：发送私信**\n\n这些状态之间的转换遵循马尔可夫链模型。一分钟间隔内的一步转移概率如下：\n\n*   一个正在**浏览动态**的用户，有0.7的概率继续浏览，0.2的概率开始创建帖子，0.1的概率切换到发送私信。\n*   一个正在**创建帖子**的用户，有0.4的概率继续创建，0.6的概率返回浏览动态。他们不可能在一分钟内直接切换到发送私信。\n*   一个正在**发送私信**的用户，有0.5的概率继续发送私信，0.5的概率返回浏览动态。他们不可能在一分钟内直接切换到创建帖子。\n\n假设一个用户当前处于**‘创建帖子’**状态。那么该用户在恰好两分钟后处于**‘发送私信’**状态的概率是多少？请用小数表示你的答案。", "solution": "设状态1为浏览动态，状态2为创建帖子，状态3为发送私信。一步转移矩阵 $P$ 的元素 $P_{i,j}$ 等于在一分钟内从状态 $i$ 转移到状态 $j$ 的概率。根据题意：\n$$\nP=\\begin{pmatrix}\n0.7 & 0.2 & 0.1 \\\\\n0.6 & 0.4 & 0 \\\\\n0.5 & 0 & 0.5\n\\end{pmatrix}.\n$$\n我们要求的是从状态2开始，用户在恰好两分钟后处于状态3的概率。这等于 $P^{2}$ 的第 $(2,3)$ 个元素：\n$$\n(P^{2})_{2,3}=\\sum_{k=1}^{3} P_{2,k}P_{k,3}=P_{2,1}P_{1,3}+P_{2,2}P_{2,3}+P_{2,3}P_{3,3}.\n$$\n根据转移概率，我们有 $P_{2,1}=0.6$，$P_{1,3}=0.1$，$P_{2,2}=0.4$，$P_{2,3}=0$ 以及 $P_{3,3}=0.5$。代入得，\n$$\n(P^{2})_{2,3}=0.6 \\cdot 0.1+0.4 \\cdot 0+0 \\cdot 0.5=0.06.\n$$\n等价地，从状态2到状态3唯一可能的两步路径是 $2 \\to 1 \\to 3$，其发生的概率为 $0.6 \\cdot 0.1=0.06$。", "answer": "$$\\boxed{0.06}$$", "id": "1375578"}, {"introduction": "在掌握了短期预测后，一个自然而然的问题是：随着时间的推移，系统最终会达到一种稳定状态吗？这个练习将引导你探索马尔可夫链的长期行为，即稳态分布。你将为一个更复杂的四状态系统建立转移矩阵，并通过求解特征向量方程 $P\\pi = \\pi$ 来确定其最终的平衡状态。这个问题还隐藏着一个有趣的结果，它揭示了双随机矩阵（doubly stochastic matrices）与均匀分布之间的深刻联系。[@problem_id:1375543]", "problem": "一个粒子在一个正方形的四个顶点上移动，这些顶点按逆时针顺序标记为 $V_1, V_2, V_3, V_4$。在每个离散时间步，粒子必须从其当前顶点移动到其两个相邻顶点之一。移动规则是有偏的：从任何一个顶点出发，向逆时针方向的相邻顶点移动的概率是向顺时针方向的相邻顶点移动的概率的两倍。在任何一步中，粒子都不能停留在其当前顶点。确定粒子位置的长期稳态概率分布。将您的答案表示为一个行向量 $[p_1, p_2, p_3, p_4]$，其中 $p_i$ 是在顶点 $V_i$ 找到该粒子的概率。", "solution": "设系统的状态为粒子的位置。状态空间为 $S = \\{V_1, V_2, V_3, V_4\\}$。我们正在寻找稳态概率分布，可以将其表示为一个向量 $\\pi = [p_1, p_2, p_3, p_4]^T$，其中 $p_i$ 是长期在顶点 $V_i$ 找到该粒子的概率。这些概率的总和必须为1，即 $p_1 + p_2 + p_3 + p_4 = 1$。\n\n首先，我们确定转移概率。从任何一个顶点出发，粒子可以移动到其逆时针（ccw）方向的邻居或顺时针（cw）方向的邻居。设 $p_{ccw}$ 和 $p_{cw}$ 分别为这些移动的概率。问题陈述了 $p_{ccw} = 2 p_{cw}$。由于粒子必须移动到相邻顶点，这些概率的和必须为1：$p_{ccw} + p_{cw} = 1$。\n将第一个关系式代入第二个，得到 $2 p_{cw} + p_{cw} = 1$，化简为 $3 p_{cw} = 1$，所以 $p_{cw} = \\frac{1}{3}$。因此，$p_{ccw} = 2 \\times \\frac{1}{3} = \\frac{2}{3}$。\n停留在同一顶点的概率为 0。\n\n接下来，我们构建转移矩阵 $P$。我们使用状态向量为列向量 $\\mathbf{x}$ 的约定，其演化由 $\\mathbf{x}_{k+1} = P \\mathbf{x}_k$ 描述。在此约定中，矩阵的元素 $P_{ij}$ 是从状态 $j$ 转移到状态 $i$ 的概率。矩阵的各列之和必须为1。\n\n让我们确定 $P$ 的各列：\n- 第1列（从 $V_1$ 出发）：粒子可以移动到 $V_2$（逆时针，概率 $\\frac{2}{3}$）或 $V_4$（顺时针，概率 $\\frac{1}{3}$）。所以，$P_{21} = \\frac{2}{3}$ 且 $P_{41} = \\frac{1}{3}$。\n- 第2列（从 $V_2$ 出发）：粒子可以移动到 $V_3$（逆时针，概率 $\\frac{2}{3}$）或 $V_1$（顺时针，概率 $\\frac{1}{3}$）。所以，$P_{32} = \\frac{2}{3}$ 且 $P_{12} = \\frac{1}{3}$。\n- 第3列（从 $V_3$ 出发）：粒子可以移动到 $V_4$（逆时针，概率 $\\frac{2}{3}$）或 $V_2$（顺时针，概率 $\\frac{1}{3}$）。所以，$P_{43} = \\frac{2}{3}$ 且 $P_{23} = \\frac{1}{3}$。\n- 第4列（从 $V_4$ 出发）：粒子可以移动到 $V_1$（逆时针，概率 $\\frac{2}{3}$）或 $V_3$（顺时针，概率 $\\frac{1}{3}$）。所以，$P_{14} = \\frac{2}{3}$ 且 $P_{34} = \\frac{1}{3}$。\n\n所有其他元素均为零。转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\n0 & \\frac{1}{3} & 0 & \\frac{2}{3} \\\\\n\\frac{2}{3} & 0 & \\frac{1}{3} & 0 \\\\\n0 & \\frac{2}{3} & 0 & \\frac{1}{3} \\\\\n\\frac{1}{3} & 0 & \\frac{2}{3} & 0\n\\end{pmatrix}\n$$\n稳态分布向量 $\\pi$ 是 $P$ 对应于特征值 $\\lambda=1$ 的特征向量。因此，它必须满足方程 $P\\pi = \\pi$，该方程可以重写为 $(P-I)\\pi = \\mathbf{0}$，其中 $I$ 是单位矩阵，$\\mathbf{0}$ 是零向量。\n$$\n\\begin{pmatrix}\n-1 & \\frac{1}{3} & 0 & \\frac{2}{3} \\\\\n\\frac{2}{3} & -1 & \\frac{1}{3} & 0 \\\\\n0 & \\frac{2}{3} & -1 & \\frac{1}{3} \\\\\n\\frac{1}{3} & 0 & \\frac{2}{3} & -1\n\\end{pmatrix}\n\\begin{pmatrix} p_1 \\\\ p_2 \\\\ p_3 \\\\ p_4 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给了我们一个线性方程组：\n1. $-p_1 + \\frac{1}{3}p_2 + \\frac{2}{3}p_4 = 0 \\implies 3p_1 = p_2 + 2p_4$\n2. $\\frac{2}{3}p_1 - p_2 + \\frac{1}{3}p_3 = 0 \\implies 3p_2 = 2p_1 + p_3$\n3. $\\frac{2}{3}p_2 - p_3 + \\frac{1}{3}p_4 = 0 \\implies 3p_3 = 2p_2 + p_4$\n4. $\\frac{1}{3}p_1 + \\frac{2}{3}p_3 - p_4 = 0 \\implies 3p_4 = p_1 + 2p_3$\n\n我们来解这个方程组。由方程(2)得，$p_3 = 3p_2 - 2p_1$。将此代入方程(4)：\n$3p_4 = p_1 + 2(3p_2 - 2p_1) = p_1 + 6p_2 - 4p_1 = 6p_2 - 3p_1$。\n所以，$p_4 = 2p_2 - p_1$。\n\n现在，将 $p_3$ 和 $p_4$ 的表达式代入方程(3)：\n$3(3p_2 - 2p_1) = 2p_2 + (2p_2 - p_1)$\n$9p_2 - 6p_1 = 4p_2 - p_1$\n$5p_2 = 5p_1 \\implies p_1 = p_2$。\n\n既然我们知道了 $p_1 = p_2$，我们可以用 $p_1$ 来表示其他概率：\n$p_4 = 2p_2 - p_1 = 2p_1 - p_1 = p_1$。\n$p_3 = 3p_2 - 2p_1 = 3p_1 - 2p_1 = p_1$。\n这表明所有四个概率都相等：$p_1 = p_2 = p_3 = p_4$。\n\n最后，我们使用归一化条件：$p_1 + p_2 + p_3 + p_4 = 1$。\n代入我们的发现：$p_1 + p_1 + p_1 + p_1 = 1 \\implies 4p_1 = 1 \\implies p_1 = \\frac{1}{4}$。\n因此，稳态概率分布为 $p_1=p_2=p_3=p_4=\\frac{1}{4}$。\n\n稳态分布是均匀分布。考虑到有偏的移动，这似乎有悖直觉。然而，我们可以观察到转移矩阵 $P$ 是双随机的（其行和与列和均为1）。对于任何有限、不可约的马尔可夫链，如果转移矩阵是双随机的，那么其唯一的平稳分布就是均匀分布。我们的链是有限且不可约的，因此该定理适用，并证实了我们的结果。\n\n最终答案，表示为行向量，是 $[\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}]$。", "answer": "$$\\boxed{\\begin{bmatrix} \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} \\end{bmatrix}}$$", "id": "1375543"}, {"introduction": "我们现在从分析转向设计，这是更高层次的应用。如果你是一个系统的设计者，你如何设定规则（即转移概率）来实现特定的长期目标？这个练习挑战你进行“逆向工程”：根据期望的长期用户活跃度（稳态分布）和系统达到稳定的速度（由第二特征值决定），来反推出模型中的关键参数。通过解决这个问题，你将深化对转移矩阵结构与其所描述的动态行为之间关系的理解。[@problem_id:1375555]", "problem": "一个软件开发团队正在分析一款新应用功能的用户参与度。他们将用户的行为建模为一个具有两个状态的马尔可夫链：状态1（“活跃”）和状态2（“不活跃”）。从一周到下一周的转换由一个 $2 \\times 2$ 的转移矩阵 $P$ 描述，其中条目 $P_{ij}$ 是用户从状态 $j$ 转换到状态 $i$ 的概率。\n\n矩阵 $P$ 的形式如下：\n$$\nP = \\begin{pmatrix} 1-a & b \\\\ a & 1-b \\end{pmatrix}\n$$\n此处，$a$ 是一个活跃用户变为不活跃的概率，而 $b$ 是一个不活跃用户变为活跃的概率。模型要求这些概率严格介于0和1之间（即 $0  a  1$ 且 $0  b  1$）。\n\n该团队有两个设计标准。首先，该功能应进行调整，使得从长远来看，用户处于“活跃”状态的概率稳定在恰好 $1/3$。其次，收敛到这个长期分布的速度与矩阵的第二个特征值有关；这个特征值（不等于1的那个）被要求为 $5/8$。\n\n确定满足这两个条件的具体转移矩阵 $P$。答案应该是一个具有精确分数条目的 $2 \\times 2$ 矩阵。", "solution": "给定一个双状态马尔可夫链，其列随机转移矩阵为\n$$\nP=\\begin{pmatrix}1-a  b \\\\ a  1-b\\end{pmatrix},\n$$\n其中 $P_{ij}$ 是从状态 $j$ 转移到状态 $i$ 的概率，因此每列的和为 $1$。设平稳分布为 $\\pi=\\begin{pmatrix}\\pi_{1} \\\\ \\pi_{2}\\end{pmatrix}$，其中 $\\pi_{1}$ 是长期处于活跃状态的概率，$\\pi_{2}$ 是长期处于不活跃状态的概率。平稳条件是 $P\\pi=\\pi$ 以及 $\\pi_{1}+\\pi_{2}=1$。\n\n展开 $P\\pi=\\pi$ 得到\n$$\n\\begin{cases}\n(1-a)\\pi_{1}+b\\pi_{2}=\\pi_{1},\\\\\na\\pi_{1}+(1-b)\\pi_{2}=\\pi_{2}.\n\\end{cases}\n$$\n第一个方程简化为\n$$\n-a\\pi_{1}+b\\pi_{2}=0 \\quad\\Longrightarrow\\quad b\\pi_{2}=a\\pi_{1}\\quad\\Longrightarrow\\quad \\frac{\\pi_{1}}{\\pi_{2}}=\\frac{b}{a}.\n$$\n使用 $\\pi_{1}+\\pi_{2}=1$，我们得到\n$$\n\\pi_{1}=\\frac{b}{a+b},\\qquad \\pi_{2}=\\frac{a}{a+b}.\n$$\n设计要求长期活跃概率等于 $\\frac{1}{3}$，这要求\n$$\n\\pi_{1}=\\frac{b}{a+b}=\\frac{1}{3}\\quad\\Longrightarrow\\quad 3b=a+b\\quad\\Longrightarrow\\quad a=2b.\n$$\n\n接下来，我们应用特征值条件。$P$ 的特征值是特征多项式的根\n$$\n\\det(P-\\lambda I)=\\det\\begin{pmatrix}1-a-\\lambda  b \\\\ a  1-b-\\lambda\\end{pmatrix}\n=(1-a-\\lambda)(1-b-\\lambda)-ab.\n$$\n展开并化简，\n$$\n\\det(P-\\lambda I)=\\lambda^{2}-\\lambda\\big(2-(a+b)\\big)+(1-a-b).\n$$\n由于 $P$ 是一个随机矩阵，$\\lambda=1$ 是一个特征值，另一个特征值是\n$$\n\\lambda_{2}=1-(a+b).\n$$\n第二个特征值等于 $\\frac{5}{8}$ 的要求给出\n$$\n1-(a+b)=\\frac{5}{8}\\quad\\Longrightarrow\\quad a+b=\\frac{3}{8}.\n$$\n结合 $a=2b$，我们求解\n$$\n2b+b=\\frac{3}{8}\\quad\\Longrightarrow\\quad b=\\frac{1}{8},\\qquad a=2b=\\frac{1}{4}.\n$$\n\n因此，转移矩阵为\n$$\nP=\\begin{pmatrix}1-a  b \\\\ a  1-b\\end{pmatrix}\n=\\begin{pmatrix}\\frac{3}{4}  \\frac{1}{8} \\\\ \\frac{1}{4}  \\frac{7}{8}\\end{pmatrix},\n$$\n它满足 $\\pi_{1}=\\frac{1}{3}$ 且第二个特征值为 $1-a-b=\\frac{5}{8}$，同时 $0  a  1$ 且 $0  b  1$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3}{4}  \\frac{1}{8} \\\\ \\frac{1}{4}  \\frac{7}{8}\\end{pmatrix}}$$", "id": "1375555"}]}