{"hands_on_practices": [{"introduction": "LU分解是求解线性方程组的一种高效且系统的方法，它本质上是高斯消元法的矩阵形式。通过这个练习，你将亲手将一个矩阵$A$分解为一个下三角矩阵$L$和一个上三角矩阵$U$，然后利用前向替换和后向替换法求解方程组$A\\mathbf{x} = \\mathbf{b}$。这个基础练习旨在巩固LU分解的核心计算流程和其在求解线性系统中的直接应用。[@problem_id:12944]", "problem": "线性方程组可以用矩阵形式表示为 $A\\mathbf{x} = \\mathbf{b}$。求解此类方程组的一个有效方法是 LU 分解，即将矩阵 $A$ 分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A = LU$。\n\n原始方程组 $A\\mathbf{x} = \\mathbf{b}$ 于是可以改写为 $LU\\mathbf{x} = \\mathbf{b}$。该方程可以通过以下两个步骤求解：\n1.  定义一个中间向量 $\\mathbf{y} = U\\mathbf{x}$。\n2.  首先，使用前向替换法求解方程组 $L\\mathbf{y} = \\mathbf{b}$ 得到 $\\mathbf{y}$。\n3.  然后，使用后向替换法求解方程组 $U\\mathbf{x} = \\mathbf{y}$ 得到 $\\mathbf{x}$。\n\n考虑以下线性方程组：\n$$\n\\begin{align*}\n2x_1 + x_2 + x_3 = 5 \\\\\n4x_1 - 6x_2 = -2 \\\\\n-2x_1 + 7x_2 + 2x_3 = 9\n\\end{align*}\n$$\n该方程组可以写作 $A\\mathbf{x} = \\mathbf{b}$，其中：\n$$\nA = \\begin{pmatrix} 2 & 1 & 1 \\\\ 4 & -6 & 0 \\\\ -2 & 7 & 2 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ -2 \\\\ 9 \\end{pmatrix}\n$$\n首先，求出矩阵 $A$ 的 LU 分解，其中 $L$ 是一个对角线上元素为1的下三角矩阵（Doolittle 分解），$U$ 是一个上三角矩阵。然后，利用此分解求解向量 $\\mathbf{x}$。\n\n你的任务是推导表达式 $x_1 + 2x_2 + 3x_3$ 的值。", "solution": "我们寻求满足 $A=LU$ 的 $L,U$，其中\n$$L=\\begin{pmatrix} 1 & 0 & 0 \\\\ l_{21} & 1 & 0 \\\\ l_{31} & l_{32} & 1 \\end{pmatrix},\\quad\nU=\\begin{pmatrix} u_{11} & u_{12} & u_{13} \\\\ 0 & u_{22} & u_{23} \\\\ 0 & 0 & u_{33} \\end{pmatrix}.$$\n\n匹配 $A=\\begin{pmatrix} 2 & 1 & 1 \\\\ 4 & -6 & 0 \\\\ -2 & 7 & 2 \\end{pmatrix}$：\n\n1. $U$ 的第一行：\n$$u_{11}=2,\\quad u_{12}=1,\\quad u_{13}=1.$$\n\n2. $L$ 的第一列：\n$$l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{2}=2,\\quad\nl_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-2}{2}=-1.$$\n\n3. 第二行/列：\n$$u_{22}=a_{22}-l_{21}u_{12}=-6-2\\cdot1=-8,\\quad\nu_{23}=a_{23}-l_{21}u_{13}=0-2\\cdot1=-2.$$\n$$l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{7-(-1)\\cdot1}{-8}=\\frac{8}{-8}=-1.$$\n\n4. 最后一个对角元素：\n$$u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}\n=2-(-1)\\cdot1-(-1)\\cdot(-2)=2+1-2=1.$$\n\n因此\n$$L=\\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & -1 & 1 \\end{pmatrix},\\quad\nU=\\begin{pmatrix} 2 & 1 & 1 \\\\ 0 & -8 & -2 \\\\ 0 & 0 & 1 \\end{pmatrix}.$$\n\n接下来，通过前向替换法求解 $L\\mathbf y=\\mathbf b$，其中 $\\mathbf b=(5,-2,9)^T$：\n$$y_1=5,\\quad\ny_2=-2-2\\,y_1=-2-10=-12,\\quad\ny_3=9-(-1)\\,y_1-(-1)\\,y_2=9+5-12=2.$$\n\n然后通过后向替换法求解 $U\\mathbf x=\\mathbf y$：\n$$x_3=2,\\quad\n-8x_2-2x_3=-12\\implies-8x_2-4=-12\\implies x_2=1,$$\n$$2x_1+x_2+x_3=5\\implies2x_1+1+2=5\\implies x_1=1.$$\n\n最后，\n$$x_1+2x_2+3x_3=1+2\\cdot1+3\\cdot2=9.$$", "answer": "$$\\boxed{9}$$", "id": "12944"}, {"introduction": "标准的LU分解算法在遇到主元（pivot）为零时会中断。为了使该方法更加通用和数值稳定，我们需要引入部分主元法（partial pivoting），即通过行交换来选择一个非零的、绝对值最大的元素作为主元。本练习将通过一个简单的$2 \\times 2$矩阵向你展示如何处理这种情况，并引入置换矩阵$P$，构建更具鲁棒性的$PA=LU$分解。[@problem_id:2186343]", "problem": "考虑矩阵 $A$ 如下：\n$$A = \\begin{pmatrix} 0 & -3 \\\\ 2 & 6 \\end{pmatrix}$$\n矩阵分解的基本方法之一是带部分主元法的LU分解。该过程旨在寻找一个置换矩阵 $P$、一个单位下三角矩阵 $L$（对角线上元素为1）和一个上三角矩阵 $U$，使得它们满足方程 $PA = LU$。\n\n对于给定的矩阵 $A$，以下哪个选项正确地给出了矩阵三元组 $(P, L, U)$？\n\nA. $P = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$， $L = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix}$， $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nB. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$， $L = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$， $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nC. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$， $L = \\begin{pmatrix} 1 & 0 \\\\ 3 & 1 \\end{pmatrix}$， $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nD. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$， $L = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$， $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & 3 \\end{pmatrix}$", "solution": "我们对矩阵进行带部分主元法的LU分解\n$$\nA=\\begin{pmatrix}0 & -3 \\\\ 2 & 6\\end{pmatrix}.\n$$\n部分主元法在第一列中选择绝对值最大的元素所在行为主元行。第一列的元素为 $|0|$ 和 $|2|$，因此主元在第2行。因此，我们交换第1行和第2行，得到 $PA$，其中置换矩阵为\n$$\nP=\\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}, \\quad PA = \\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\n现在我们将 $PA$ 分解为 $LU$，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，此步不再进行主元交换。对于一个 $2\\times 2$ 的矩阵，乘数为\n$$\n\\ell_{21}=\\frac{(PA)_{21}}{(PA)_{11}}=\\frac{0}{2}=0.\n$$\n因此\n$$\nL=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}, \\quad U=\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\n它们满足 $PA=LU$：\n$$\n\\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}\\begin{pmatrix}0 & -3 \\\\ 2 & 6\\end{pmatrix}\n=\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}\n=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\n与选项比较，这对应于选项B。选项A和C中列出的 $P$, $L$, $U$ 不满足 $PA=LU$，而选项D中 $U$ 矩阵的 $(2,2)$ 元素的符号不正确。", "answer": "$$\\boxed{B}$$", "id": "2186343"}, {"introduction": "在理论计算之外，我们更关心LU分解在计算机中如何被高效实现。显式地存储置换矩阵$P$、下三角矩阵$L$和上三角矩阵$U$会占用大量内存，因此实际应用中通常采用“原地”（in-place）算法。这个练习将引导你了解这种实用技巧，即如何将$L$和$U$的元素紧凑地存储在原矩阵$A$的内存空间中，并用一个简单的主元向量来记录行交换操作。[@problem_id:2186356]", "problem": "在许多数值模拟中，求解形如 $Ax = b$ 的大型线性方程组是一个关键且计算成本高昂的步骤。求解此类系统的一个标准有效方法是首先找到矩阵 $A$ 的下三角-上三角 (LU) 分解。为了处理分解过程中对角线上可能出现零的矩阵并提高数值稳定性，通常采用部分主元法来完成此操作。\n\n考虑一个对 $n \\times n$ 的非奇异方阵 $A$ 进行的带部分主元法的“就地”LU 分解算法。该算法计算出一个分解 $PA = LU$，其中 $P$ 是一个置换矩阵，$L$ 是一个单位下三角矩阵（对角线上元素为1），$U$ 是一个上三角矩阵。“就地”策略将计算出的 $L$ 和 $U$ 的元素存储在最初为 $A$ 分配的同一内存块中。具体来说，最终矩阵的上三角部分（包括对角线）包含 $U$，而严格下三角部分包含 $L$ 的相应元素。$L$ 的单位对角线不被存储。\n\n置换矩阵 $P$ 不会被显式构造。取而代之的是，行交换的序列被记录在一个大小为 $n$ 的一维整数数组 $p$ 中，我们称之为主元向量。该数组的索引从 $0$ 到 $n-1$，并初始化为 $p = [0, 1, 2, \\dots, n-1]$。在算法的第 $k$ 步（对于 $k = 0, 1, \\dots, n-2$），如果在第 $k$ 列中（对角线上或其下方）具有最大绝对值的行是第 $j$ 行（其中 $j \\ge k$），则交换矩阵的第 $k$ 行和第 $j$ 行。相应地，主元向量的元素 $p_k$ 和 $p_j$ 也被交换。\n\n给定下面的初始矩阵 $A$，请按照所述方法执行带部分主元法的就地 LU 分解。\n\n$$\nA = \\begin{pmatrix} 1 & 1 & 1 \\\\ 4 & 3 & -1 \\\\ 3 & 5 & 3 \\end{pmatrix}\n$$\n\n主元向量 $p$ 的最终状态是什么？请使用 `pmatrix` 环境将您的答案表示为一个行向量。", "solution": "我们对以下矩阵进行带部分主元法的就地 LU 分解：\n$$\nA=\\begin{pmatrix} 1 & 1 & 1 \\\\ 4 & 3 & -1 \\\\ 3 & 5 & 3 \\end{pmatrix}, \\quad p=\\begin{pmatrix} 0 & 1 & 2 \\end{pmatrix}.\n$$\n步骤 k=0：在第 0 列中，绝对值为\n$$\n|A_{00}|=|1|, \\quad |A_{10}|=|4|, \\quad |A_{20}|=|3|.\n$$\n最大值在第 $j=1$ 行。交换 $A$ 的第 $0$ 行和第 $1$ 行，并交换 $p_{0}$ 和 $p_{1}$：\n$$\nA\\leftarrow\\begin{pmatrix} 4 & 3 & -1 \\\\ 1 & 1 & 1 \\\\ 3 & 5 & 3 \\end{pmatrix}, \\quad p\\leftarrow\\begin{pmatrix} 1 & 0 & 2 \\end{pmatrix}.\n$$\n计算主元 $A_{00}=4$ 下方消元所需的乘数：\n$$\nL_{10}=\\frac{A_{10}}{A_{00}}=\\frac{1}{4}, \\quad L_{20}=\\frac{A_{20}}{A_{00}}=\\frac{3}{4}.\n$$\n将它们存储在严格下三角部分，并更新第 $1$ 行和第 $2$ 行的第 $1$ 到第 $2$ 列：\n$$\n\\text{Row }1: \\ (1,1)-\\frac{1}{4}(3,-1)=\\left(\\frac{1}{4},\\frac{5}{4}\\right), \\quad\n\\text{Row }2: \\ (5,3)-\\frac{3}{4}(3,-1)=\\left(\\frac{11}{4},\\frac{15}{4}\\right).\n$$\n因此，在 k=0 消元后，\n$$\nA=\\begin{pmatrix}\n4 & 3 & -1 \\\\\n\\frac{1}{4} & \\frac{1}{4} & \\frac{5}{4} \\\\\n\\frac{3}{4} & \\frac{11}{4} & \\frac{15}{4}\n\\end{pmatrix}.\n$$\n步骤 k=1：在第 1 列的第 $1$ 行和第 $2$ 行中，绝对值为\n$$\n\\left|A_{11}\\right|=\\left|\\frac{1}{4}\\right|, \\quad \\left|A_{21}\\right|=\\left|\\frac{11}{4}\\right|.\n$$\n最大值在第 $j=2$ 行。交换 $A$ 的第 $1$ 行和第 $2$ 行，并交换 $p_{1}$ 和 $p_{2}$：\n$$\nA\\leftarrow\\begin{pmatrix}\n4 & 3 & -1 \\\\\n\\frac{3}{4} & \\frac{11}{4} & \\frac{15}{4} \\\\\n\\frac{1}{4} & \\frac{1}{4} & \\frac{5}{4}\n\\end{pmatrix}, \\quad\np\\leftarrow\\begin{pmatrix} 1 & 2 & 0 \\end{pmatrix}.\n$$\n计算乘数\n$$\nL_{21}=\\frac{A_{21}}{A_{11}}=\\frac{\\frac{1}{4}}{\\frac{11}{4}}=\\frac{1}{11},\n$$\n并更新 $A_{22}$：\n$$\nA_{22}\\leftarrow A_{22}-L_{21}A_{12}=\\frac{5}{4}-\\frac{1}{11}\\cdot\\frac{15}{4}=\\frac{10}{11}.\n$$\n对于 $n=3$，算法在 $k=1$ 处停止。最终的主元向量是\n$$\np=\\begin{pmatrix} 1 & 2 & 0 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2 & 0 \\end{pmatrix}}$$", "id": "2186356"}]}