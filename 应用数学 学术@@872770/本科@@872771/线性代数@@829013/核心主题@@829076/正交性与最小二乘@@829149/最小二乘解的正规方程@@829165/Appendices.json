{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方式就是将其应用于实际问题。这个练习将带你体验如何将一个典型的数据拟合问题转化为一个线性代数问题。通过构建并求解正规方程，你将为一组实验数据找到最佳的二次函数模型，这正是最小二乘法在科学研究中最常见的应用之一。[@problem_id:1378919]", "problem": "一位实验物理学家正在研究一个亚原子粒子在对称势场影响下的行为。一个理论模型表明，粒子的能量 $E$ 与一个可调的实验参数 $q$ 之间应满足方程 $E(q) = c_1 + c_2 q^2$，其中 $c_1$ 和 $c_2$ 是与粒子内禀属性及其与场相互作用相关的常数。为了确定这些常数，该物理学家进行了一项实验并记录了四对数据 $(q, E)$：\n$(-2, 5)$、$(-1, 2)$、$(1, 1)$ 和 $(2, 4)$。\n\n由于不可避免的实验噪声，这些数据点并不完全落在形式为 $E(q) = c_1 + c_2 q^2$ 的单条曲线上。你的任务是找到能够最好地表示所收集数据的模型参数值。“最佳”模型定义为使测量能量值与模型预测能量值之间纵轴差异的平方和最小化的模型。\n\n确定定义此最佳拟合模型的系数序对 $(c_1, c_2)$。", "solution": "问题要求我们找到模型 $E(q) = c_1 + c_2 q^2$ 的系数 $c_1$ 和 $c_2$，使得该模型在最小二乘意义上能最佳地拟合给定的数据点。这等价于求解一个超定线性方程组的最小二乘解。\n\n首先，我们通过将每个数据点 $(q_i, E_i)$ 代入模型方程来建立线性方程组。对于未知系数向量 $\\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$，我们想要求解方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{b}$ 是观测到的能量值向量。\n\n对于点 $(-2, 5)$：$c_1 + c_2(-2)^2 = c_1 + 4c_2 = 5$\n对于点 $(-1, 2)$：$c_1 + c_2(-1)^2 = c_1 + c_2 = 2$\n对于点 $(1, 1)$：$c_1 + c_2(1)^2 = c_1 + c_2 = 1$\n对于点 $(2, 4)$：$c_1 + c_2(2)^2 = c_1 + 4c_2 = 4$\n\n该方程组可以写成矩阵形式 $A\\mathbf{x} = \\mathbf{b}$：\n$$\n\\begin{pmatrix}\n1  4 \\\\\n1  1 \\\\\n1  1 \\\\\n1  4\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\nc_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n5 \\\\\n2 \\\\\n1 \\\\\n4\n\\end{pmatrix}\n$$\n这里，矩阵 $A$ 是设计矩阵，$\\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ 是参数向量，而 $\\mathbf{b}$ 是观测值向量。\n$$\nA = \\begin{pmatrix}\n1  4 \\\\\n1  1 \\\\\n1  1 \\\\\n1  4\n\\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ 2 \\\\ 1 \\\\ 4 \\end{pmatrix}\n$$\n正如问题所述，这个方程组是不相容的。使误差平方和 $\\|A\\hat{\\mathbf{x}} - \\mathbf{b}\\|^2$ 最小的最小二乘解 $\\hat{\\mathbf{x}}$，可以通过求解法方程得到：\n$$ A^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b} $$\n首先，我们计算矩阵 $A^T A$：\n$$\nA^T A = \\begin{pmatrix}\n1  1  1  1 \\\\\n4  1  1  4\n\\end{pmatrix}\n\\begin{pmatrix}\n1  4 \\\\\n1  1 \\\\\n1  1 \\\\\n1  4\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1  1 \\cdot 4 + 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 4 \\\\\n4 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 + 4 \\cdot 1  4 \\cdot 4 + 1 \\cdot 1 + 1 \\cdot 1 + 4 \\cdot 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n4  10 \\\\\n10  34\n\\end{pmatrix}\n$$\n接下来，我们计算向量 $A^T \\mathbf{b}$：\n$$\nA^T \\mathbf{b} = \\begin{pmatrix}\n1  1  1  1 \\\\\n4  1  1  4\n\\end{pmatrix}\n\\begin{pmatrix}\n5 \\\\\n2 \\\\\n1 \\\\\n4\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\cdot 5 + 1 \\cdot 2 + 1 \\cdot 1 + 1 \\cdot 4 \\\\\n4 \\cdot 5 + 1 \\cdot 2 + 1 \\cdot 1 + 4 \\cdot 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n12 \\\\\n39\n\\end{pmatrix}\n$$\n现在我们求解方程组 $A^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b}$：\n$$\n\\begin{pmatrix}\n4  10 \\\\\n10  34\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\nc_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n12 \\\\\n39\n\\end{pmatrix}\n$$\n这对应于以下二元线性方程组：\n1) $4c_1 + 10c_2 = 12$\n2) $10c_1 + 34c_2 = 39$\n\n我们可以将第一个方程两边除以 2 来进行简化：\n$2c_1 + 5c_2 = 6$\n由此，我们可以用 $c_2$ 表示 $c_1$：\n$2c_1 = 6 - 5c_2 \\implies c_1 = 3 - \\frac{5}{2}c_2$\n\n将这个 $c_1$ 的表达式代入第二个方程：\n$10(3 - \\frac{5}{2}c_2) + 34c_2 = 39$\n$30 - 25c_2 + 34c_2 = 39$\n$9c_2 = 9$\n$c_2 = 1$\n\n现在，将 $c_2$ 的值代回 $c_1$ 的表达式中：\n$c_1 = 3 - \\frac{5}{2}(1) = 3 - \\frac{5}{2} = \\frac{6}{2} - \\frac{5}{2} = \\frac{1}{2}$\n\n或者，我们可以对增广矩阵使用高斯消元法：\n$$\n\\left[ \\begin{array}{cc|c} 4  10  12 \\\\ 10  34  39 \\end{array} \\right]\n$$\n将第一行除以 2：\n$$\n\\left[ \\begin{array}{cc|c} 2  5  6 \\\\ 10  34  39 \\end{array} \\right]\n$$\n将第二行替换为 $R_2 - 5R_1$：\n$$\n\\left[ \\begin{array}{cc|c} 2  5  6 \\\\ 10 - 5(2)  34 - 5(5)  39 - 5(6) \\end{array} \\right] = \\left[ \\begin{array}{cc|c} 2  5  6 \\\\ 0  9  9 \\end{array} \\right]\n$$\n从第二行，我们得到 $9c_2 = 9$，解得 $c_2 = 1$。\n将 $c_2 = 1$ 代入第一行的方程 $2c_1 + 5c_2 = 6$：\n$2c_1 + 5(1) = 6 \\implies 2c_1 = 1 \\implies c_1 = \\frac{1}{2}$。\n\n最佳拟合模型的系数是 $c_1 = 1/2$ 和 $c_2 = 1$。该序对是 $(1/2, 1)$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  1 \\end{pmatrix}}$$", "id": "1378919"}, {"introduction": "掌握了基本流程后，让我们来处理一个更复杂的系统，以巩固你的计算技能。在这个问题中，你将为一个包含三个未知参数的超定系统寻找最小二乘解。此练习强调了使用高斯-若尔当消元法系统地求解正规方程的重要性，这是解决此类问题的强大而可靠的工具。[@problem_id:1362678]", "problem": "在一个简化的遥感系统模型中，三个未知环境参数被编码在一个向量 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$ 中。测量过程由一个矩阵 $A$ 表示的线性变换所描述，该变换将参数映射到一组传感器读数。由于为进行误差检验而加入了一个冗余传感器，该系统成为超定系统。理论上的传感器读数由向量 $\\mathbf{b} = A\\mathbf{x}$ 给出。\n\n然而，在实践中，环境噪声和测量不准确性导致了一个观测读数向量（同样表示为 $\\mathbf{b}$），使得线性方程组 $A\\mathbf{x} = \\mathbf{b}$ 是不相容的。为了找到原始参数的最佳近似，工程师们必须确定最小二乘解，记为 $\\hat{\\mathbf{x}}$，它使得平方误差 $\\|A\\mathbf{x} - \\mathbf{b}\\|^2$ 最小化。\n\n给定测量矩阵 $A$ 和观测读数向量 $\\mathbf{b}$ 如下：\n$$\nA = \\begin{pmatrix} 1  1  0 \\\\ 1  1  0 \\\\ 1  0  1 \\\\ 0  1  1 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 4 \\end{pmatrix}\n$$\n确定最小二乘解向量 $\\hat{\\mathbf{x}} = \\begin{pmatrix} \\hat{x}_1 \\\\ \\hat{x}_2 \\\\ \\hat{x}_3 \\end{pmatrix}$ 的分量。$\\hat{\\mathbf{x}}$ 的解是通过使用高斯-若尔当消元法求解正规方程组 $A^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b}$ 来找到的。", "solution": "我们寻求最小化 $\\|A\\mathbf{x}-\\mathbf{b}\\|^{2}$ 的最小二乘解 $\\hat{\\mathbf{x}}$。根据正规方程组，它满足 $A^{T}A\\,\\hat{\\mathbf{x}}=A^{T}\\mathbf{b}$。\n\n计算 $A^{T}A$ 和 $A^{T}\\mathbf{b}$。$A$ 的列向量为：\n$$\n\\mathbf{c}_{1}=\\begin{pmatrix}1\\\\1\\\\1\\\\0\\end{pmatrix},\\quad\n\\mathbf{c}_{2}=\\begin{pmatrix}1\\\\1\\\\0\\\\1\\end{pmatrix},\\quad\n\\mathbf{c}_{3}=\\begin{pmatrix}0\\\\0\\\\1\\\\1\\end{pmatrix}.\n$$\n因此\n$$\nA^{T}A=\n\\begin{pmatrix}\n\\mathbf{c}_{1}\\cdot\\mathbf{c}_{1}  \\mathbf{c}_{1}\\cdot\\mathbf{c}_{2}  \\mathbf{c}_{1}\\cdot\\mathbf{c}_{3}\\\\\n\\mathbf{c}_{2}\\cdot\\mathbf{c}_{1}  \\mathbf{c}_{2}\\cdot\\mathbf{c}_{2}  \\mathbf{c}_{2}\\cdot\\mathbf{c}_{3}\\\\\n\\mathbf{c}_{3}\\cdot\\mathbf{c}_{1}  \\mathbf{c}_{3}\\cdot\\mathbf{c}_{2}  \\mathbf{c}_{3}\\cdot\\mathbf{c}_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3  2  1\\\\\n2  3  1\\\\\n1  1  2\n\\end{pmatrix},\n$$\n并且对于 $\\mathbf{b}=\\begin{pmatrix}1\\\\2\\\\3\\\\4\\end{pmatrix}$，\n$$\nA^{T}\\mathbf{b}=\n\\begin{pmatrix}\n\\mathbf{c}_{1}\\cdot\\mathbf{b}\\\\\n\\mathbf{c}_{2}\\cdot\\mathbf{b}\\\\\n\\mathbf{c}_{3}\\cdot\\mathbf{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n6\\\\\n7\\\\\n7\n\\end{pmatrix}。\n$$\n因此正规方程组为：\n$$\n\\begin{pmatrix}\n3  2  1\\\\\n2  3  1\\\\\n1  1  2\n\\end{pmatrix}\n\\hat{\\mathbf{x}}=\n\\begin{pmatrix}\n6\\\\\n7\\\\\n7\n\\end{pmatrix}。\n$$\n\n使用高斯-若尔当消元法求解该方程组。构建增广矩阵并进行消元：\n$$\n\\left[\n\\begin{array}{ccc|c}\n3  2  1  6\\\\\n2  3  1  7\\\\\n1  1  2  7\n\\end{array}\n\\right]\n\\to\n\\left[\n\\begin{array}{ccc|c}\n3  2  1  6\\\\\n0  \\frac{5}{3}  \\frac{1}{3}  3\\\\\n0  \\frac{1}{3}  \\frac{5}{3}  5\n\\end{array}\n\\right]\n\\to\n\\left[\n\\begin{array}{ccc|c}\n3  2  1  6\\\\\n0  \\frac{5}{3}  \\frac{1}{3}  3\\\\\n0  0  \\frac{8}{5}  \\frac{22}{5}\n\\end{array}\n\\right]。\n$$\n对第三行进行缩放，使其主元为一：\n$$\n\\left[\n\\begin{array}{ccc|c}\n3  2  1  6\\\\\n0  \\frac{5}{3}  \\frac{1}{3}  3\\\\\n0  0  1  \\frac{11}{4}\n\\end{array}\n\\right]。\n$$\n消除第二行第三列的元素，并对第二行进行缩放：\n$$\n\\left[\n\\begin{array}{ccc|c}\n3  2  1  6\\\\\n0  \\frac{5}{3}  0  \\frac{25}{12}\\\\\n0  0  1  \\frac{11}{4}\n\\end{array}\n\\right]\n\\to\n\\left[\n\\begin{array}{ccc|c}\n3  2  1  6\\\\\n0  1  0  \\frac{5}{4}\\\\\n0  0  1  \\frac{11}{4}\n\\end{array}\n\\right]。\n$$\n消除第一行第二列和第三列的元素，并对第一行进行缩放：\n$$\n\\left[\n\\begin{array}{ccc|c}\n3  0  1  \\frac{7}{2}\\\\\n0  1  0  \\frac{5}{4}\\\\\n0  0  1  \\frac{11}{4}\n\\end{array}\n\\right]\n\\to\n\\left[\n\\begin{array}{ccc|c}\n3  0  0  \\frac{3}{4}\\\\\n0  1  0  \\frac{5}{4}\\\\\n0  0  1  \\frac{11}{4}\n\\end{array}\n\\right]\n\\to\n\\left[\n\\begin{array}{ccc|c}\n1  0  0  \\frac{1}{4}\\\\\n0  1  0  \\frac{5}{4}\\\\\n0  0  1  \\frac{11}{4}\n\\end{array}\n\\right]。\n$$\n因此，\n$$\n\\hat{x}_{1}=\\frac{1}{4}，\\quad \\hat{x}_{2}=\\frac{5}{4}，\\quad \\hat{x}_{3}=\\frac{11}{4}。\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{5}{4}  \\frac{11}{4} \\end{pmatrix}}$$", "id": "1362678"}, {"introduction": "除了计算，理解最小二乘法背后的结构也至关重要。如果设计矩阵 $A$ 的列是标准正交的，情况会发生什么变化？这个练习将引导你探索这种理想情况，推导出投影向量 $\\hat{\\mathbf{b}}$ 的一个极其简洁的表达式，从而揭示正交性如何极大地简化最小二乘问题。[@problem_id:1378910]", "problem": "考虑一个标准的最小二乘问题，其目标是求一个不相容线性系统 $A\\mathbf{x} = \\mathbf{b}$ 的近似解。设 $A$ 是一个 $m \\times n$ 的实矩阵，其中 $m > n$，且 $\\mathbf{b}$ 是 $\\mathbb{R}^m$ 中的一个向量。矩阵 $A$ 的列向量，我们记为 $\\mathbf{u}_1, \\mathbf{u}_2, \\dots, \\mathbf{u}_n$，已知它们构成一个标准正交集。最小二乘解，记为 $\\hat{\\mathbf{x}}$，是 $\\mathbb{R}^n$ 中使欧几里得范数 $\\|A\\mathbf{x} - \\mathbf{b}\\|$ 最小化的向量。向量 $\\hat{\\mathbf{b}} = A\\hat{\\mathbf{x}}$ 表示 $\\mathbf{b}$ 在 $A$ 的列空间上的正交投影。\n\n你的任务是在 $A$ 的列向量是标准正交的特定条件下，推导投影向量 $\\hat{\\mathbf{b}}$ 关于矩阵 $A$ 和向量 $\\mathbf{b}$ 的简化闭式表达式。", "solution": "我们考虑一个不相容系统 $A\\mathbf{x}=\\mathbf{b}$ 的最小二乘问题，其中 $A\\in\\mathbb{R}^{m\\times n}$，$m>n$，且其列向量 $\\mathbf{u}_{1},\\dots,\\mathbf{u}_{n}$ 是标准正交的。标准正交性意味着：\n$$\nA^{T}A=I_{n}。\n$$\n最小二乘解 $\\hat{\\mathbf{x}}$ 满足正规方程：\n$$\nA^{T}A\\,\\hat{\\mathbf{x}}=A^{T}\\mathbf{b}。\n$$\n使用 $A^{T}A=I_{n}$，我们得到：\n$$\n\\hat{\\mathbf{x}}=(A^{T}A)^{-1}A^{T}\\mathbf{b}=I_{n}^{-1}A^{T}\\mathbf{b}=A^{T}\\mathbf{b}。\n$$\n$\\mathbf{b}$ 在 $A$ 的列空间上的投影是：\n$$\n\\hat{\\mathbf{b}}=A\\hat{\\mathbf{x}}=A\\left(A^{T}\\mathbf{b}\\right)=AA^{T}\\mathbf{b}。\n$$\n等价地，由于 $A$ 的列构成一个标准正交集，到 $\\operatorname{col}(A)$ 上的投影算子是 $P=AA^{T}$，这会得到相同的表达式。", "answer": "$$\\boxed{AA^{T}\\mathbf{b}}$$", "id": "1378910"}]}