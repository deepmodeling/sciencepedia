{"hands_on_practices": [{"introduction": "我们通常在方程组 $A\\mathbf{x} = \\mathbf{b}$ 无解（即不相容）时诉诸最小二乘法。但如果这个系统恰好有解呢？这个练习 [@problem_id:1363836] 将最小二乘法的一般理论与求解 $A\\mathbf{x} = \\mathbf{b}$ 的经典情况联系起来，揭示了当一个完美解存在时，“最佳”近似解实际上就是这个完美解本身，从而为我们的几何直觉建立了一个重要的基准。", "problem": "设 $A$ 是一个 $m \\times n$ 的实矩阵，设 $\\mathbf{b}$ 是 $\\mathbb{R}^m$ 中的一个向量。所有 $A$ 的列向量的线性组合构成 $\\mathbb{R}^m$ 的一个子空间，称为 $A$ 的列空间，记作 $\\text{Col}(A)$。线性系统 $A\\mathbf{x} = \\mathbf{b}$ 的一个最小二乘解是 $\\mathbb{R}^n$ 中的一个向量 $\\hat{\\mathbf{x}}$，它使得欧几里得范数 $||A\\mathbf{x} - \\mathbf{b}||$ 最小。从几何上看，向量 $A\\hat{\\mathbf{x}}$ 是 $\\mathbf{b}$ 在 $\\text{Col}(A)$ 上的正交投影。值 $||A\\hat{\\mathbf{x}} - \\mathbf{b}||$ 是最小二乘误差。\n\n考虑一个特殊情况，其中向量 $\\mathbf{b}$ 已知位于 $A$ 的列空间内，即 $\\mathbf{b} \\in \\text{Col}(A)$。\n\n对于此特定场景，以下哪个陈述为最小二乘解及其相关误差提供了最准确的几何和代数描述？\n\nA. 最小二乘误差为零，且所有最小二乘解的集合与 $A\\mathbf{x} = \\mathbf{b}$ 的所有精确解的集合相同。\n\nB. 存在唯一的最小二乘解 $\\hat{\\mathbf{x}}$，它由 $\\mathbf{b}$ 在 $A^T$ 的零空间上的投影给出。最小二乘误差为零。\n\nC. 最小二乘误差非零，因为最小二乘法总是找到一个近似值。误差向量 $\\mathbf{b} - A\\hat{\\mathbf{x}}$ 是 $\\mathbf{b}$ 在 $A$ 的零空间上的投影。\n\nD. 任何最小二乘解向量 $\\hat{\\mathbf{x}}$ 都必须与 $A$ 的零空间正交，但误差 $||A\\hat{\\mathbf{x}} - \\mathbf{b}||$ 可能非零。\n\nE. 向量 $A\\hat{\\mathbf{x}}$ 与向量 $\\mathbf{b}$ 正交，导致一个最小范数但非零的误差。", "solution": "根据定义，最小二乘解 $\\hat{\\mathbf{x}}$ 最小化 $||A\\mathbf{x} - \\mathbf{b}||$。投影定理指出，对于任意 $\\mathbf{b} \\in \\mathbb{R}^{m}$，\n$$\n\\mathbf{b} = \\mathbf{p} + \\mathbf{r}, \\quad \\mathbf{p} \\in \\text{Col}(A), \\quad \\mathbf{r} \\in \\text{Col}(A)^{\\perp},\n$$\n并且对于任意 $\\mathbf{x}$，\n$$\n||A\\mathbf{x} - \\mathbf{b}||^{2} = ||A\\mathbf{x} - \\mathbf{p} - \\mathbf{r}||^{2} = ||(A\\mathbf{x} - \\mathbf{p})||^{2} + ||\\mathbf{r}||^{2},\n$$\n其中当 $A\\mathbf{x} = \\mathbf{p}$ 时达到最小值，即当 $A\\mathbf{x}$ 是 $\\mathbf{b}$ 在 $\\text{Col}(A)$ 上的正交投影时。\n\n在最小二乘法中，$A\\hat{\\mathbf{x}}$ 是 $\\mathbf{b}$ 在 $\\text{Col}(A)$ 上的正交投影，且 $\\hat{\\mathbf{x}}$ 满足正规方程组\n$$\nA^{T}(A\\hat{\\mathbf{x}} - \\mathbf{b}) = 0.\n$$\n等价地，残差 $\\mathbf{r} = \\mathbf{b} - A\\hat{\\mathbf{x}}$ 位于 $\\text{Col}(A)^{\\perp}$ 中。\n\n现在假设 $\\mathbf{b} \\in \\text{Col}(A)$。那么 $\\mathbf{b}$ 在 $\\text{Col}(A)$ 上的正交投影就是 $\\mathbf{b}$ 本身。因此，存在 $\\mathbf{x}_{0}$ 使得\n$$\nA\\mathbf{x}_{0} = \\mathbf{b},\n$$\n并且最小二乘残差达到\n$$\n||A \\mathbf{x}_{0} - \\mathbf{b}|| = 0,\n$$\n这是最小值。因此最小二乘误差为零。\n\n此外，任何满足 $A\\mathbf{x} = \\mathbf{b}$ 的 $\\mathbf{x}$ 都会产生相同的最小残差零，因此每个精确解都是一个最小二乘解。反之，任何最小二乘解 $\\hat{\\mathbf{x}}$ 都必须满足 $A\\hat{\\mathbf{x}}$ 等于 $\\mathbf{b}$ 在 $\\text{Col}(A)$ 上的投影，这里即为 $\\mathbf{b}$，所以 $A\\hat{\\mathbf{x}} = \\mathbf{b}$。因此，最小二乘解的集合与 $A\\mathbf{x} = \\mathbf{b}$ 的解集完全一致：\n$$\n\\{\\hat{\\mathbf{x}} : \\hat{\\mathbf{x}} \\text{ is LS for } A\\mathbf{x}=\\mathbf{b}\\} = \\{\\mathbf{x} : A\\mathbf{x}=\\mathbf{b}\\}.\n$$\n从代数上讲，这也可以从正规方程组得出：如果 $A\\mathbf{x}=\\mathbf{b}$ 是相容的，那么 $A\\mathbf{x}=\\mathbf{b}$ 的任何解都满足 $A^{T}(A \\mathbf{x} - \\mathbf{b})=0$，并且残差的最小范数为 $0$。\n\n因此：\n- 最小二乘误差为零。\n- 最小二乘解的集合等于 $A\\mathbf{x} = \\mathbf{b}$ 的精确解的集合。\n- 除非 $\\text{Null}(A) = \\{\\mathbf{0}\\}$，否则不保证唯一性。\n\n选项 A 精确地陈述了这些事实。选项 B、C、D 和 E 以各种方式与这些结论相矛盾（B 错误地断言唯一性并错误地描述了解的特性；C 和 E 断言非零误差；D 在此场景下允许非零误差）。", "answer": "$$\\boxed{A}$$", "id": "1363836"}, {"introduction": "最小二乘法的几何核心在于将向量 $\\mathbf{b}$ 分解为一个在子空间内部的分量 $\\mathbf{p}$ 和一个与之正交的分量 $\\mathbf{e}$。那么，当向量 $\\mathbf{b}$ 本身发生变化时，这个分解会如何响应呢？这个思想实验 [@problem_id:1363790] 探索了投影的一个深刻性质，揭示了当我们沿着一个已经存在于子空间 $C(A)$ 内的向量 $\\mathbf{w}$ 来移动目标向量 $\\mathbf{b}$ 时，误差向量 $\\mathbf{e}$ 竟然保持不变。这完美地说明了误差代表了到子空间的真实正交距离，而这个距离在平行于子空间的移动下是不变的。", "problem": "设 $A$ 是一个具有线性无关列的 $m \\times n$ 实矩阵，设 $\\mathbf{b}$ 是 $\\mathbb{R}^m$ 中的一个向量。在最小二乘问题的背景下，向量 $\\hat{\\mathbf{x}}$ 是 $\\mathbb{R}^n$ 中唯一的向量，它最小化了欧几里得范数的平方 $||A\\mathbf{x} - \\mathbf{b}||^2$。向量 $\\mathbf{p} = A\\hat{\\mathbf{x}}$ 是 $\\mathbf{b}$ 在 $A$ 的列空间中的分量，而向量 $\\mathbf{e} = \\mathbf{b} - \\mathbf{p}$ 是误差分量。\n\n现在，假设我们定义一个新的目标向量 $\\mathbf{b}' = \\mathbf{b} + \\mathbf{w}$，其中 $\\mathbf{w}$ 是一个非零向量，且也位于 $A$ 的列空间中。设 $\\hat{\\mathbf{x}}'$ 是最小化新的范数平方 $||A\\mathbf{x} - \\mathbf{b}'||^2$ 的唯一向量。新的对应向量是 $\\mathbf{p}' = A\\hat{\\mathbf{x}}'$ 和 $\\mathbf{e}' = \\mathbf{b}' - \\mathbf{p}'$。\n\n下列哪个陈述正确地用原始向量描述了新向量 $\\mathbf{p}'$ 和 $\\mathbf{e}'$？\n\nA. $\\mathbf{p}' = \\mathbf{p}$ 且 $\\mathbf{e}' = \\mathbf{e} + \\mathbf{w}$\n\nB. $\\mathbf{p}' = \\mathbf{p} + \\mathbf{w}$ 且 $\\mathbf{e}' = \\mathbf{e}$\n\nC. $\\mathbf{p}' = \\mathbf{p} + \\mathbf{w}$ 且 $\\mathbf{e}' = \\mathbf{e} + \\mathbf{w}$\n\nD. $\\mathbf{p}' = \\mathbf{p}$ 且 $\\mathbf{e}' = \\mathbf{e}$\n\nE. 在不知道具体矩阵 $A$ 的情况下，无法确定这种关系。", "solution": "该问题要求解在目标向量 $\\mathbf{b}'$ 被修改后的最小二乘问题中，新的投影向量 $\\mathbf{p}'$ 和新的误差向量 $\\mathbf{e}'$。\n\n设 $C(A)$ 表示矩阵 $A$ 的列空间。根据定义，最小二乘解 $A\\hat{\\mathbf{x}}$ 是向量 $\\mathbf{b}$ 在子空间 $C(A)$ 上的正交投影。我们用 $\\text{proj}_{C(A)}$ 表示到 $C(A)$ 上的投影算子。\n\n原始的投影向量是 $\\mathbf{p} = A\\hat{\\mathbf{x}} = \\text{proj}_{C(A)}(\\mathbf{b})$。\n原始的误差向量是 $\\mathbf{e} = \\mathbf{b} - \\mathbf{p} = \\mathbf{b} - \\text{proj}_{C(A)}(\\mathbf{b})$。这种分解的一个关键性质是误差向量 $\\mathbf{e}$ 与子空间 $C(A)$ 正交。\n\n我们给定一个新的目标向量 $\\mathbf{b}' = \\mathbf{b} + \\mathbf{w}$。我们还被告知向量 $\\mathbf{w}$ 位于 $A$ 的列空间中，即 $\\mathbf{w} \\in C(A)$。\n\n新的投影向量 $\\mathbf{p}'$ 是 $\\mathbf{b}'$ 在列空间 $C(A)$ 上的正交投影。\n$$\\mathbf{p}' = \\text{proj}_{C(A)}(\\mathbf{b}')$$\n代入 $\\mathbf{b}'$ 的表达式，我们得到：\n$$\\mathbf{p}' = \\text{proj}_{C(A)}(\\mathbf{b} + \\mathbf{w})$$\n投影算子是线性变换。因此，我们可以将其分配到和上：\n$$\\mathbf{p}' = \\text{proj}_{C(A)}(\\mathbf{b}) + \\text{proj}_{C(A)}(\\mathbf{w})$$\n我们知道 $\\text{proj}_{C(A)}(\\mathbf{b})$ 就是原始的投影向量 $\\mathbf{p}$。\n现在考虑 $\\text{proj}_{C(A)}(\\mathbf{w})$。由于向量 $\\mathbf{w}$ 已经存在于子空间 $C(A)$ 中，它在 $C(A)$ 上的投影就是向量 $\\mathbf{w}$ 本身。\n$$\\text{proj}_{C(A)}(\\mathbf{w}) = \\mathbf{w}$$\n将这些代回到 $\\mathbf{p}'$ 的表达式中，我们发现：\n$$\\mathbf{p}' = \\mathbf{p} + \\mathbf{w}$$\n所以，新的投影向量是原始投影向量和扰动向量 $\\mathbf{w}$ 的和。\n\n接下来，我们来求新的误差向量 $\\mathbf{e}'$。根据定义，$\\mathbf{e}'$ 是新目标向量 $\\mathbf{b}'$ 和新投影向量 $\\mathbf{p}'$ 之间的差。\n$$\\mathbf{e}' = \\mathbf{b}' - \\mathbf{p}'$$\n我们可以代入我们已有的 $\\mathbf{b}'$ 和 $\\mathbf{p}'$ 的表达式：\n$$\\mathbf{e}' = (\\mathbf{b} + \\mathbf{w}) - (\\mathbf{p} + \\mathbf{w})$$\n简化表达式，我们得到：\n$$\\mathbf{e}' = \\mathbf{b} + \\mathbf{w} - \\mathbf{p} - \\mathbf{w} = \\mathbf{b} - \\mathbf{p}$$\n表达式 $\\mathbf{b} - \\mathbf{p}$ 是原始误差向量 $\\mathbf{e}$ 的定义。\n因此，我们有：\n$$\\mathbf{e}' = \\mathbf{e}$$\n这意味着当目标向量 $\\mathbf{b}$ 被一个已经存在于 $A$ 的列空间中的向量 $\\mathbf{w}$ 平移时，误差向量不会改变。从几何上看，加上一个来自子空间的向量只会使目标向量平行于该子空间移动，因此它到该子空间的正交距离保持不变。\n\n总而言之，新向量是 $\\mathbf{p}' = \\mathbf{p} + \\mathbf{w}$ 和 $\\mathbf{e}' = \\mathbf{e}$。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1363790"}, {"introduction": "我们已经探讨了误差为零的情形，现在让我们思考另一个极端：如果投影本身为零，这意味着什么？这个练习 [@problem_id:1363842] 迫使我们直面最小二乘法中正交性的核心意义。如果向量 $\\mathbf{b}$ 在子空间 $C(A)$ 上的“影子”仅仅是原点处的一个点，那么这对于 $\\mathbf{b}$ 相对于该子空间的方向给出了一个强有力的几何结论。理解这个极端情况有助于我们巩固对线性代数基本定理的掌握，即一个向量正交于列空间，当且仅当它位于左零空间中。", "problem": "设 $A$ 是一个 $m \\times n$ 的实矩阵，$\\mathbf{b}$ 是 $\\mathbb{R}^m$ 中的一个向量。考虑线性系统 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x}$ 是 $\\mathbb{R}^n$ 中的一个向量。最小二乘问题旨在找到一个向量 $\\hat{\\mathbf{x}}$，使得残差的欧几里得范数 $||A\\mathbf{x} - \\mathbf{b}||$ 最小。向量 $\\mathbf{p} = A\\hat{\\mathbf{x}}$ 被定义为向量 $\\mathbf{b}$ 在 $A$ 的列空间 $C(A)$ 上的正交投影。\n\n假设对于一个特定的矩阵 $A$ 和一个非零向量 $\\mathbf{b}$，其正交投影 $\\mathbf{p}$ 为零向量，即 $\\mathbf{p} = \\mathbf{0}$。下列哪个陈述最准确、最普遍地描述了向量 $\\mathbf{b}$ 与列空间 $C(A)$ 之间的几何关系？\n\nA. 向量 $\\mathbf{b}$ 必须是 $A$ 的某一列的标量倍数。\n\nB. 向量 $\\mathbf{b}$ 位于 $A$ 的零空间中。\n\nC. 向量 $\\mathbf{b}$ 是 $A$ 的列的线性组合。\n\nD. 向量 $\\mathbf{b}$ 与 $A$ 的列空间中的每个向量都正交。\n\nE. 矩阵 $A$ 必须是零矩阵。", "solution": "我们考虑将 $\\mathbf{b} \\in \\mathbb{R}^{m}$ 到列空间 $C(A) \\subseteq \\mathbb{R}^{m}$ 的最小二乘投影。根据投影定理，$\\mathbf{b}$ 在 $C(A)$ 上的正交投影 $\\mathbf{p}$ 的特征是 $\\mathbf{p} \\in C(A)$ 以及正交条件\n$$\n\\mathbf{b} - \\mathbf{p} \\perp C(A).\n$$\n等价地，由于 $C(A)$ 是由 $A$ 的列向量张成的，这个正交条件可以写成\n$$\nA^{T}(\\mathbf{b} - \\mathbf{p}) = \\mathbf{0}.\n$$\n在最小二乘法中，投影满足 $\\mathbf{p} = A\\hat{\\mathbf{x}}$（对于某个 $\\hat{\\mathbf{x}} \\in \\mathbb{R}^{n}$），且正规方程组为\n$$\nA^{T}A\\hat{\\mathbf{x}} = A^{T}\\mathbf{b}, \\quad \\text{with} \\quad \\mathbf{p} = A\\hat{\\mathbf{x}}.\n$$\n现在假设 $\\mathbf{p} = \\mathbf{0}$。那么正交条件简化为\n$$\nA^{T}\\mathbf{b} = \\mathbf{0}.\n$$\n这意味着对于 $A$ 的每一列 $\\mathbf{a}_{j}$，都有 $\\mathbf{a}_{j}^{T}\\mathbf{b} = 0$。因此，$\\mathbf{b}$ 与 $A$ 的每一列都正交，从而与 $A$ 的列的任意线性组合都正交，即与整个 $C(A)$ 正交。因此，正确的几何描述是 $\\mathbf{b}$ 与整个列空间 $C(A)$ 正交。\n\n我们简要排除其他选项：\n- A 是错误的，因为 $\\mathbf{p} = \\mathbf{0}$ 意味着与每一列正交，而不是与某一列对齐（除非该列是零向量）。\n- B 在维度上是不正确的：$A$ 的零空间是 $\\mathbb{R}^{n}$ 的子空间，而 $\\mathbf{b} \\in \\mathbb{R}^{m}$。\n- C 是错误的，因为如果 $\\mathbf{b} \\in C(A)$ 且 $\\mathbf{b} \\neq \\mathbf{0}$，那么投影将是 $\\mathbf{p} = \\mathbf{b} \\neq \\mathbf{0}$。\n- E 是错误的，因为可以有一个非零矩阵 $A$ 及其非平凡的列空间 $C(A)$，并选择一个与 $C(A)$ 正交的向量 $\\mathbf{b}$；这样 $\\mathbf{p} = \\mathbf{0}$，而 $A$ 并非零矩阵。\n\n因此，最准确、最普遍的陈述是 $\\mathbf{b}$ 与 $C(A)$ 中的每个向量都正交。", "answer": "$$\\boxed{D}$$", "id": "1363842"}]}