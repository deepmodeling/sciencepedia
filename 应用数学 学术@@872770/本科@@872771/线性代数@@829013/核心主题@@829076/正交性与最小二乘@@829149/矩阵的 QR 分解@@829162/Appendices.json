{"hands_on_practices": [{"introduction": "QR 分解最经典和基础的构造方法之一是 Gram-Schmidt 正交化过程。这个练习提供了一个绝佳的实践机会，通过按部就班地应用该算法，你将亲手将一组线性无关的列向量转化为一个标准正交基，并由此得到 QR 分解中的 $Q$ 和 $R$ 矩阵。掌握这一计算是理解和应用 QR 分解的第一步。[@problem_id:1385295]", "problem": "考虑矩阵 $A$ 如下所示：\n$$A = \\begin{pmatrix} 1 & 1 \\\\ 2 & 0 \\\\ 2 & -1 \\end{pmatrix}$$\n矩阵 $A$ 的 QR 分解是形如 $A = QR$ 的分解，其中 $Q$ 是一个具有标准正交列的矩阵，而 $R$ 是一个上三角矩阵。求通过对矩阵 $A$ 的列向量（按从左到右的给定顺序）应用 Gram-Schmidt 过程得到的 QR 分解中的矩阵 $R$。该过程必须进行规范化，以使矩阵 $R$ 的对角线元素为正。", "solution": "设 $A$ 的列向量为 $\\mathbf{a}_1$ 和 $\\mathbf{a}_2$，其中\n$$\\mathbf{a}_1=\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix}, \\quad \\mathbf{a}_2=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}.$$\n经典的 Gram-Schmidt 过程如下。\n\n首先，计算 $r_{11}=\\|\\mathbf{a}_1\\|$ 和 $\\mathbf{q}_1=\\mathbf{a}_1/r_{11}$：\n$$\\|\\mathbf{a}_1\\|=\\sqrt{1^{2}+2^{2}+2^{2}}=\\sqrt{9}=3,$$\n$$\\mathbf{q}_1=\\frac{1}{3}\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix}=\\begin{pmatrix}\\frac{1}{3}\\\\\\frac{2}{3}\\\\\\frac{2}{3}\\end{pmatrix}.$$\n\n接下来，计算 $r_{12}=\\mathbf{q}_1^T \\mathbf{a}_2$：\n$$r_{12}=\\begin{pmatrix}\\frac{1}{3} & \\frac{2}{3} & \\frac{2}{3}\\end{pmatrix}\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}=\\frac{1}{3}-\\frac{2}{3}=-\\frac{1}{3}.$$\n\n构造 $\\mathbf{u}_2=\\mathbf{a}_2-r_{12}\\mathbf{q}_1$，然后计算 $r_{22}=\\|\\mathbf{u}_2\\|$：\n$$\\mathbf{u}_2=\\mathbf{a}_2-\\left(-\\frac{1}{3}\\right)\\mathbf{q}_1=\\mathbf{a}_2+\\frac{1}{3}\\mathbf{q}_1=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}+\\begin{pmatrix}\\frac{1}{9}\\\\\\frac{2}{9}\\\\\\frac{2}{9}\\end{pmatrix}=\\begin{pmatrix}\\frac{10}{9}\\\\\\frac{2}{9}\\\\-\\frac{7}{9}\\end{pmatrix},$$\n$$\\|\\mathbf{u}_2\\|=\\sqrt{\\left(\\frac{10}{9}\\right)^{2}+\\left(\\frac{2}{9}\\right)^{2}+\\left(-\\frac{7}{9}\\right)^{2}}=\\sqrt{\\frac{100+4+49}{81}}=\\sqrt{\\frac{153}{81}}=\\frac{\\sqrt{17}}{3}.$$\n\n根据对角线元素为正的约定，我们取\n$$r_{11}=3,\\quad r_{12}=-\\frac{1}{3},\\quad r_{22}=\\frac{\\sqrt{17}}{3}.$$\n因此，上三角矩阵 $R$ 为\n$$R=\\begin{pmatrix}3 & -\\frac{1}{3}\\\\ 0 & \\frac{\\sqrt{17}}{3}\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}3 & -\\frac{1}{3}\\\\ 0 & \\frac{\\sqrt{17}}{3}\\end{pmatrix}}$$", "id": "1385295"}, {"introduction": "学习如何计算 QR 分解之后，一个自然的问题是“我们为什么需要它？”。这个练习将展示 QR 分解不仅仅是一个抽象的数学概念，更是一个解决实际问题的强大工具。它演示了如何利用 QR 分解来求解超定线性系统的最小二乘解，这在数据拟合、信号处理和许多科学与工程领域中都至关重要。[@problem_id:1057223]", "problem": "考虑超定线性系统 $A\\mathbf{x} = \\mathbf{b}$，其中\n$$  \nA = \\begin{bmatrix}  \n\\cos \\theta & -\\sin \\theta \\\\  \n\\sin \\theta & \\cos \\theta \\\\  \n1 & 0  \n\\end{bmatrix}, \\quad \\mathbf{b} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}.  \n$$  \n使用 QR 分解，在最小二乘意义下求解该系统，其中特定角度为 $\\theta = \\frac{\\pi}{2}$。报告解向量 $\\mathbf{x}$ 的第一个分量 $x_1$ 的值。", "solution": "对于 $\\theta=\\frac{\\pi}{2}$，我们有\n$$A=\\begin{bmatrix}0 & -1\\\\1 & 0\\\\1 & 0\\end{bmatrix},\\quad \\mathbf{b}=\\begin{bmatrix}0\\\\0\\\\1\\end{bmatrix}.$$  \n将 A 的列向量记为 $\\mathbf{a}_1, \\mathbf{a}_2$。\n1. Gram–Schmidt 正交化：\n   $\\mathbf{u}_1=\\mathbf{a}_1=(0,1,1)^T$，$\\|\\mathbf{u}_1\\|=\\sqrt{2}$，$\\mathbf{q}_1=\\frac{\\mathbf{u}_1}{\\sqrt{2}}.$  \n   因为 $\\mathbf{a}_1$ 和 $\\mathbf{a}_2$ 正交，所以 $\\mathbf{u}_2=\\mathbf{a}_2 - (\\mathbf{q}_1^T \\mathbf{a}_2)\\mathbf{q}_1 = \\mathbf{a}_2$。$\\|\\mathbf{u}_2\\|=1$，所以 $\\mathbf{q}_2=\\mathbf{a}_2$。\n2. 因此\n$$Q=\\begin{bmatrix}0 & -1\\\\\\frac{1}{\\sqrt{2}} & 0\\\\\\frac{1}{\\sqrt{2}} & 0\\end{bmatrix},\\quad\nR=\\begin{pmatrix}\\sqrt{2} & 0\\\\0 & 1\\end{pmatrix}.$$  \n3. 计算 $Q^T\\mathbf{b}$：\n$$Q^T\\mathbf{b}=\\begin{pmatrix}\\mathbf{q}_1^T\\mathbf{b}\\\\\\mathbf{q}_2^T\\mathbf{b}\\end{pmatrix}\n=\\begin{pmatrix}\\frac{1}{\\sqrt{2}}\\\\0\\end{pmatrix}.$$  \n4. 求解 $R\\mathbf{x}=Q^T\\mathbf{b}$：\n$\\sqrt{2}\\,x_1=\\frac{1}{\\sqrt{2}} \\implies x_1=\\frac{1}{2}$，以及 $x_2=0$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1057223"}, {"introduction": "在掌握了标准情况下的计算和应用之后，让我们来探索一个特殊但极具启发性的场景：如果原始矩阵的列向量是线性相关的，会发生什么？这个练习揭示了矩阵的线性相关性与 QR 分解结果之间的深刻联系。通过这个过程，你会发现 Gram-Schmidt 算法能够自然地“侦测”到这种相关性，并直接体现在 $R$ 矩阵的结构中。[@problem_id:17522]", "problem": "### 问题陈述\n\n矩阵 $A$ 的 QR 分解是将其分解为一个正交矩阵 $Q$ 和一个上三角矩阵 $R$ 的过程，使得 $A=QR$。对于一个具有列向量 $[a_1, a_2, \\dots, a_n]$ 的矩阵 $A$，求此分解的一种常用方法是 Gram-Schmidt 过程。\n\n该过程如下构造一组正交向量 $[u_1, u_2, \\dots, u_n]$：\n$$u_1 = a_1$$\n$$u_k = a_k - \\sum_{j=1}^{k-1} \\text{proj}_{u_j}(a_k)$$\n其中向量 $v$ 在向量 $u$ 上的投影由下式给出：\n$$\\text{proj}_{u}(v) = \\frac{\\langle v, u \\rangle}{\\langle u, u \\rangle} u$$\n此处，$\\langle v, u \\rangle$ 表示标准欧几里得内积（点积）。\n\n正交矩阵 $Q$ 的列，记为 $q_k$，是单位化向量 $q_k = \\frac{u_k}{||u_k||}$。上三角矩阵 $R$ 的元素则与这些向量相关。具体来说，$R$ 的对角元素由正交向量的模给出：\n$$R_{kk} = ||u_k||$$\n\n考虑以下 $2 \\times 2$ 矩阵 $A$，其列向量是线性相关的：\n$$A = \\begin{pmatrix} c_1 & k c_1 \\\\ c_2 & k c_2 \\end{pmatrix}$$\n其中 $c_1$ 和 $c_2$ 为非零实常数，$k$ 为非零实标量。\n\n推导在矩阵 $A$ 的 QR 分解中，上三角矩阵 $R$ 的元素 $R_{22}$ 的值。", "solution": "我们有 $A=[\\mathbf{a}_1, \\mathbf{a}_2]$，其中 $\\mathbf{a}_1=(c_1,c_2)^T$ 且 $\\mathbf{a}_2=k \\mathbf{a}_1$。应用 Gram–Schmidt 过程：\n\n$\\mathbf{u}_1=\\mathbf{a}_1$。\n\n计算投影系数\n$$\\langle \\mathbf{a}_2, \\mathbf{u}_1\\rangle=\\langle k \\mathbf{a}_1, \\mathbf{a}_1\\rangle=k\\langle \\mathbf{a}_1, \\mathbf{a}_1\\rangle\n=k(c_1^2+c_2^2),$$ \n以及范数\n$$\\langle \\mathbf{u}_1, \\mathbf{u}_1\\rangle=c_1^2+c_2^2.$$ \n因此\n$$\\text{proj}_{\\mathbf{u}_1}(\\mathbf{a}_2)\n=\\frac{\\langle \\mathbf{a}_2,\\mathbf{u}_1\\rangle}{\\langle \\mathbf{u}_1,\\mathbf{u}_1\\rangle}\\mathbf{u}_1\n=\\frac{k(c_1^2+c_2^2)}{c_1^2+c_2^2}\\,\\mathbf{u}_1\n=k\\,\\mathbf{u}_1.$$\n\n所以\n$$\\mathbf{u}_2=\\mathbf{a}_2-\\text{proj}_{\\mathbf{u}_1}(\\mathbf{a}_2)=k \\mathbf{u}_1-k \\mathbf{u}_1=\\mathbf{0}.$$\n\n根据 $R$ 的定义，\n$$R_{22}=\\|\\mathbf{u}_2\\|=0.$$", "answer": "$$\\boxed{0}$$", "id": "17522"}]}