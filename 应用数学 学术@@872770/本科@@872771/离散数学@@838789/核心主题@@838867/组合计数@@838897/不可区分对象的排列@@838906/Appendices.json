{"hands_on_practices": [{"introduction": "我们将从一个在生物信息学中常见的场景开始。这个练习旨在帮助你掌握处理不可区分对象排列的基础知识。当你面对一个由不同类型但同类型内完全相同的元素组成的集合时，关键在于如何应用多项式系数公式来计算所有独特的线性序列数量。[@problem_id:1390984]", "problem": "一位生物信息学家正在研究病毒核糖核酸（RNA）链的一个特定短片段。通过测序分析，确定该片段正好由14个核苷酸组成。已知其组成为：5个腺嘌呤（A）核苷酸，3个胞嘧啶（C）核苷酸，4个鸟嘌呤（G）核苷酸和2个尿嘧啶（U）核苷酸。假设所有相同类型的核苷酸彼此之间是无法区分的，那么使用这组确切的14个核苷酸可以形成多少种独特的线性序列（排列）？", "solution": "我们正在排列一个由$14$个元素组成的多重集，其中包括$5$个A，$3$个C，$4$个G和$2$个U，其中相同类型的元素是无法区分的。不同的线性序列的数量由这些计数的多项式系数给出：\n$$\nN=\\frac{14!}{5!\\,3!\\,4!\\,2!}.\n$$\n这也可以通过依次选择位置来推导：从$14$个位置中为A选择$5$个，然后从剩下的$9$个位置中为C选择$3$个，再从剩下的$6$个位置中为G选择$4$个，最后从剩下的$2$个位置中为U选择$2$个：\n$$\nN=\\binom{14}{5}\\binom{9}{3}\\binom{6}{4}\\binom{2}{2}\n=\\frac{14!}{5!\\,9!}\\cdot\\frac{9!}{3!\\,6!}\\cdot\\frac{6!}{4!\\,2!}\\cdot\\frac{2!}{2!\\,0!}\n=\\frac{14!}{5!\\,3!\\,4!\\,2!},\n$$\n使用$0!=1$。\n\n计算确切的整数值：\n$$\n14!=87178291200,\\quad 5!=120,\\quad 3!=6,\\quad 4!=24,\\quad 2!=2,\n$$\n所以分母是\n$$\n5!\\,3!\\,4!\\,2!=120\\cdot 6\\cdot 24\\cdot 2=34560,\n$$\n且\n$$\nN=\\frac{87178291200}{34560}.\n$$\n逐步相除：首先除以$64$得到$\\frac{1362160800}{540}$，然后除以$10$得到$\\frac{136216080}{54}$，再除以$6$得到$\\frac{22702680}{9}$，最后除以$9$得到\n$$\nN=2522520.\n$$\n因此，独特的线性序列的数量为$2522520$。", "answer": "$$\\boxed{2522520}$$", "id": "1390984"}, {"introduction": "现实世界的问题往往带有额外的约束条件，这使得直接套用公式变得不再可行。这个关于物流包裹排序的练习引入了一个常见的挑战：特定类型的对象必须按特定相对顺序排列。通过将具有固定相对顺序的元素视为一个“组合”单元，我们可以巧妙地将复杂问题转化为一个更简单的排列问题，这是一种非常强大的解题策略。[@problem_id:1391271]", "problem": "在一个自动化物流设施中，一个分拣算法正在被编程用来安排最终发货传送带上的包裹。有三种类型的包裹需要分拣：\n- 5个相同的“优先”包裹。\n- 3个相同的“标准”包裹。\n- 4个相同的“区域”包裹。\n\n这总共有12个包裹需要排成一个线性序列。分拣系统受到一个关键的操作限制：所有“优先”包裹必须在序列中出现在任何“标准”包裹之前。“区域”包裹可以放置在序列中的任何位置，不受相对于其他类型包裹的限制。\n\n计算满足给定约束条件的这12个包裹的不同线性排列的总数。提供确切的整数值。", "solution": "设$n_P=5$为“优先”包裹的数量，$n_S=3$为“标准”包裹的数量，$n_R=4$为“区域”包裹的数量。需要排列的总包裹数为 $N = n_P + n_S + n_R = 5 + 3 + 4 = 12$。\n\n问题要求计算在这个多重集合中，满足所有“优先”包裹必须出现在任何“标准”包裹之前的不同排列数。\n\n让我们考虑线性序列中的12个位置。问题的核心在于如何处理对“优先”(P)和“标准”(S)包裹的约束。该约束固定了P和S包裹的相对顺序。对于P和S包裹所占用的任何位置选择，它们的排列是唯一确定的：这些位置中的前$n_P$个必须填充P，剩下的$n_S$个位置必须填充S。\n\n为了简化计数过程，我们可以将“优先”和“标准”包裹视为一组暂时无法区分的物品。我们称这种新物品类型为“组合”(C)。这样的“组合”包裹有 $n_C' = n_P + n_S = 5 + 3 = 8$ 个。\n\n问题现在转化为寻找一个新多重集合的不同排列数，该集合包含：\n- $n_C' = 8$ 个“组合”包裹。\n- $n_R = 4$ 个“区域”包裹。\n\n在这个新排列中，物品总数仍然是 $N = n_C' + n_R = 8 + 4 = 12$。\n\n多重集合的不同排列数由以下公式给出：\n$$ \\frac{N!}{k_1! k_2! \\dots k_m!} $$\n其中 $N$ 是物品总数，$k_1, k_2, \\dots, k_m$ 是每种不同物品类型的重数。\n\n在我们的简化问题中，我们有 $N=12$，$k_1 = n_C' = 8$ 和 $k_2 = n_R = 4$。因此，不同排列的数量是：\n$$ \\frac{12!}{8! \\cdot 4!} $$\n\n这个表达式也是二项式系数 $\\binom{12}{8}$ 或 $\\binom{12}{4}$ 的定义。我们来计算它的值：\n$$ \\binom{12}{4} = \\frac{12 \\cdot 11 \\cdot 10 \\cdot 9}{4 \\cdot 3 \\cdot 2 \\cdot 1} $$\n\n我们可以通过约分来简化表达式：\n$$ \\binom{12}{4} = \\frac{12}{4 \\cdot 3} \\cdot \\frac{10}{2} \\cdot 11 \\cdot 9 $$\n$$ \\binom{12}{4} = 1 \\cdot 5 \\cdot 11 \\cdot 9 $$\n$$ \\binom{12}{4} = 55 \\cdot 9 $$\n$$ \\binom{12}{4} = 495 $$\n\n这495个排列中的每一个都由8个“组合”包裹和4个“区域”包裹的序列组成。对于任何给定的排列，我们可以通过替换“组合”包裹来形成一个唯一的、有效的原始包裹序列。由于所有“优先”包裹必须在所有“标准”包裹之前，我们将序列中的前5个“组合”包裹替换为“优先”包裹，将其余3个“组合”包裹替换为“标准”包裹。对于每个排列，这种替换是唯一的。\n\n因此，简化集合的排列数等于原始集合的有效排列数。不同的线性排列总数为495。", "answer": "$$\\boxed{495}$$", "id": "1391271"}, {"introduction": "这个练习将挑战你将所学知识提升到新的抽象层次。与前述问题中每种对象的数量都已固定的情况不同，这里我们面对的是一个更普遍的约束条件——两类对象的数量必须相等，而它们的具体数量是可变的。解决这个问题的关键在于，你需要识别所有满足条件的可能情况，分别计算每种情况下的排列数，然后将它们相加，这体现了组合数学中“分类讨论”和“求和”的核心思想。[@problem_id:1391001]", "problem": "在制造先进光纤的质量控制过程中，需要扫描一根长光纤，并在每个单位长度上将其传输特性分为三类之一：“最佳”（O）、“增益误差”（G）或“损耗误差”（L）。在长度为 $N$ 的一段光纤上，获取了这些测量值的一个任意序列。\n\n如果“增益误差”（G）读数的总数与“损耗误差”（L）读数的总数完全相等，则该段的测量序列被定义为“频谱均衡的”。\n\n假设用于构成序列的每种类型的测量结果供应量实际上是无限的，请确定长度为 $N$ 的不同频谱均衡测量序列的总数。你的答案应该是一个用 $N$ 表示的封闭形式的解析表达式。", "solution": "我们将每个单位长度的测量建模为三个符号之一：O、G 或 L。如果一个长度为 $N$ 的序列中 G 符号的数量等于 L 符号的数量，则该序列是频谱均衡的。\n\n设 $k$ 为序列中 G 和 L 读数的共同数量。那么我们必须有 $2k \\leq N$，所以 $k$ 的取值范围是从 $0$ 到 $\\lfloor N/2 \\rfloor$。对于一个固定的 $k$，恰好有 $k$ 个 G、 $k$ 个 L 和 $N-2k$ 个 O 的序列数量由多项式系数给出：\n$$\n\\frac{N!}{k!\\,k!\\,(N-2k)!}.\n$$\n等价地，我们可以分两步计数：首先从 $N$ 个位置中选择 $2k$ 个非 O 的位置，这有 $\\binom{N}{2k}$ 种方法；然后在这些 $2k$ 个位置中选择哪 $k$ 个是 G（剩下的 $k$ 个将是 L），这有 $\\binom{2k}{k}$ 种方法。这会得到相同的计数结果：\n$$\n\\binom{N}{2k}\\binom{2k}{k}=\\frac{N!}{k!\\,k!\\,(N-2k)!}.\n$$\n对所有允许的 $k$ 求和，即可得到频谱均衡序列的总数：\n$$\n\\sum_{k=0}^{\\lfloor N/2 \\rfloor} \\binom{N}{2k}\\binom{2k}{k}.\n$$\n这是中心三项式系数，在对应关系 $G \\mapsto 1$, $L \\mapsto -1$, $O \\mapsto 0$ 下，它也等于在集合 $\\{-1,0,1\\}$ 上，总和为零的长度为 $N$ 的序列的数量。", "answer": "$$\\boxed{\\sum_{k=0}^{\\lfloor N/2 \\rfloor} \\binom{N}{2k}\\binom{2k}{k}}$$", "id": "1391001"}]}