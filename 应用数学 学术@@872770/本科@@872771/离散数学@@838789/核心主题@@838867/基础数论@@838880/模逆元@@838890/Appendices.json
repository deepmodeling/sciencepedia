{"hands_on_practices": [{"introduction": "我们首先从一个基本问题入手，探索扩展欧几里得算法的输出与模逆元之间的直接联系。这个练习 [@problem_id:1385681] 旨在阐明，一旦你得到了贝祖等式，识别模逆元就只是一个简单的观察步骤。理解这一联系是掌握更复杂计算的基础。", "problem": "在一个密码学协议中，一个关键步骤是计算模逆元。一位程序员使用扩展欧几里得算法来寻找满足 $ax + by = \\gcd(a, b)$ 形式方程的整数 $x$ 和 $y$。对于整数 $a=34$ 和 $b=89$ 的具体情况，该算法输出了以下恒等式：\n\n$$1 = 26 \\cdot 34 - 10 \\cdot 89$$\n\n使用这个恒等式，求出 $34$ 模 $89$ 的乘法逆元。你的答案必须是一个满足 $0 \\le k  89$ 的整数 $k$。", "solution": "我们寻求一个满足 $0 \\leq k  89$ 且 $34k \\equiv 1 \\pmod{89}$ 的 $k$。根据定义，$34$ 模 $89$ 的乘法逆元是满足此同余式的整数 $k$。\n\n给定的扩展欧几里得算法恒等式是\n$$1 = 26 \\cdot 34 - 10 \\cdot 89.$$\n将等式两边模 $89$。由于 $89$ 能整除 $10 \\cdot 89$，我们有 $-10 \\cdot 89 \\equiv 0 \\pmod{89}$。因此，\n$$1 \\equiv 26 \\cdot 34 \\pmod{89}.$$\n等价地，\n$$34 \\cdot 26 \\equiv 1 \\pmod{89}.$$\n因此 $k \\equiv 26 \\pmod{89}$，在要求的范围内选择代表元，得到 $k=26$。", "answer": "$$\\boxed{26}$$", "id": "1385681"}, {"introduction": "在模算术中，我们不能直接进行除法，但我们可以通过乘以模逆元来达到同样的效果。这个练习 [@problem_id:1385645] 将带你完整地走一遍求解线性同余方程的过程：首先使用扩展欧几里得算法计算所需的模逆元，然后用它来“除”以一个数，从而解出未知数。这个问题展示了模逆元在解决实际问题中的核心作用。", "problem": "一个密码学团队正在设计一个用于共享秘密整数 `S` 的简单协议。该协议依赖于模算术。根据他们的设计，秘密 `S` 是集合 $\\{0, 1, 2, ..., p-1\\}$ 中线性同余方程\n$$a \\cdot S \\equiv b \\pmod{p}$$\n的唯一整数解，其中 `a`、`b` 和 `p` 是公开参数。\n\n对于该协议的一个具体实例，参数设置如下：\n- `a = 7`\n- `b = 3`\n- `p = 19`\n\n您的任务是根据给定的参数确定秘密整数 `S` 的值。", "solution": "我们需要求解满足线性同余方程 $a \\cdot S \\equiv b \\pmod{p}$ 的 $S \\in \\{0,1,2,\\ldots,p-1\\}$。模算术中的一个标准结论指出，如果 $\\gcd(a,p)=1$，则 `a` 存在一个模 `p` 的乘法逆元，记作 $a^{-1}$，并且唯一的模 `p` 解为 $S \\equiv a^{-1} b \\pmod{p}$。在此例中，$a=7$，$b=3$，$p=19$。由于 `p` 是素数且 $a \\not\\equiv 0 \\pmod{p}$，因此 $\\gcd(7,19)=1$，这保证了唯一解的存在。\n\n为了求出 $7^{-1} \\pmod{19}$，我们应用扩展欧几里得算法将 1 表示为 7 和 19 的 $\\mathbb{Z}$-线性组合：\n$$\n19 = 2 \\cdot 7 + 5, \\quad 7 = 1 \\cdot 5 + 2, \\quad 5 = 2 \\cdot 2 + 1.\n$$\n回代以表示 1：\n$$\n1 = 5 - 2 \\cdot 2,\n$$\n$$\n2 = 7 - 1 \\cdot 5 \\;\\Rightarrow\\; 1 = 5 - 2(7 - 1 \\cdot 5) = 3 \\cdot 5 - 2 \\cdot 7,\n$$\n$$\n5 = 19 - 2 \\cdot 7 \\;\\Rightarrow\\; 1 = 3(19 - 2 \\cdot 7) - 2 \\cdot 7 = 3 \\cdot 19 - 8 \\cdot 7.\n$$\n因此 $-8 \\cdot 7 + 3 \\cdot 19 = 1$，这意味着 $7^{-1} \\equiv -8 \\equiv 11 \\pmod{19}$。所以，\n$$\nS \\equiv 7^{-1} \\cdot b \\equiv 11 \\cdot 3 \\equiv 33 \\equiv 14 \\pmod{19}.\n$$\n因为 $14 \\in \\{0,1,2,\\ldots,18\\}$，所以所求的秘密是 $S=14$。快速验证：$7 \\cdot 14 = 98 \\equiv 98 - 5 \\cdot 19 = 3 \\pmod{19}$，确认结果正确。", "answer": "$$\\boxed{14}$$", "id": "1385645"}, {"introduction": "一个数在某个模下是否总有逆元？答案是否定的。这个练习 [@problem_id:1385647] 将引导你探索模逆元存在的条件。通过识别在一个特定模数下哪些数*没有*逆元，你将加深对 $\\gcd(a, M)=1$ 这一关键条件的理解，并认识到它在密码学等应用中的重要性。", "problem": "一位计算机科学家正在开发一种简单的乘法编码方案。在这个方案中，一个数字消息 `x` 使用一个秘密整数密钥 `a` 和一个固定的模 `M` 被转换为一个编码消息 `y`。该转换由同余式 `y \\equiv ax \\pmod{M}` 定义。\n\n为确保任何编码消息都能被唯一解码，必须存在一个解码密钥 `b`。解码密钥 `b` 必须是一个能逆转编码过程的整数，这意味着对于任何消息 `x`，它必须满足同余式 `by \\equiv x \\pmod{M}`。这等价于要求存在一个整数 `b` 使得 `ba \\equiv 1 \\pmod{M}`。如果对于给定的密钥 `a` 不存在这样的 `b`，则该密钥在此方案中被视为无效。\n\n对于一个模为 `M = 42` 的系统，请从集合 `{1, 2, ..., 41}` 中确定所有无效的整数密钥 `a`。请将这些无效密钥以升序排列的整数列表形式给出。", "solution": "编码为 $y \\equiv ax \\pmod{M}$。一个解码密钥 $b$ 必须对所有 $x$ 满足 $by \\equiv x \\pmod{M}$，这等价于要求 $ba \\equiv 1 \\pmod{M}$。该同余式成立当且仅当存在整数 $b$ 和 $k$ 使得\n$$\nab - 1 = Mk \\quad \\Longleftrightarrow \\quad ab + M(-k) = 1,\n$$\n这表明 $1$ 是 $a$ 和 $M$ 的一个整数线性组合，因此 $\\gcd(a,M)=1$。反之，如果 $\\gcd(a,M)=1$，那么根据贝祖定理（Bézout's identity），存在整数 $s$ 和 $t$ 使得\n$$\nas + Mt = 1,\n$$\n这个等式在模 $M$ 下简化为 $as \\equiv 1 \\pmod{M}$，所以 $b=s$ 是一个有效的解码密钥。因此，密钥 $a$ 无效当且仅当 $\\gcd(a,M) \\neq 1$。\n\n当 $M=42$ 时，分解 $42=2 \\cdot 3 \\cdot 7$。因此 $\\gcd(a,42) \\neq 1$ 当且仅当 $a$ 能被 $2$、$3$ 或 $7$ 整除。从集合 $\\{1,2,\\ldots,41\\}$ 中，无效密钥正是那些能被 $2$、$3$ 或 $7$ 整除的整数。按升序排列这些数得到\n$$\n2,\\,3,\\,4,\\,6,\\,7,\\,8,\\,9,\\,10,\\,12,\\,14,\\,15,\\,16,\\,18,\\,20,\\,21,\\,22,\\,24,\\,26,\\,27,\\,28,\\,30,\\,32,\\,33,\\,34,\\,35,\\,36,\\,38,\\,39,\\,40.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 2 3 4 6 7 8 9 10 12 14 15 16 18 20 21 22 24 26 27 28 30 32 33 34 35 36 38 39 40 \\end{pmatrix}}$$", "id": "1385647"}]}