{"hands_on_practices": [{"introduction": "第一个练习将引导您完成算法的完整一轮迭代。通过从初始距离矩阵 $D^{(0)}$ 计算出整个 $D^{(1)}$ 矩阵，您将巩固对算法核心思想的理解：如何利用一个中间顶点来尝试缩短所有其他顶点对之间的路径。这是掌握整个算法的基础。", "problem": "一个小型数据中心由四台服务器组成，标记为 1、2、3 和 4。网络管理员测量了某些服务器对之间的直接通信延迟（单位为毫秒）。这些延迟由一个加权有向图表示，其中从服务器 $i$ 到服务器 $j$ 的边的权重等于延迟。直接延迟的初始矩阵 $D^{(0)}$ 如下所示。条目 $\\infty$ 表示服务器之间没有直接连接。\n\n$$\nD^{(0)} = \\begin{pmatrix}\n0   8  \\infty  1 \\\\\n\\infty  0  1  \\infty \\\\\n4  \\infty  0  \\infty \\\\\n\\infty  2  9  0\n\\end{pmatrix}\n$$\n\n为了找到所有服务器对之间的最短通信时间，管理员使用 Floyd-Warshall 算法。该算法迭代计算一系列矩阵 $D^{(k)}$，其中条目 $D^{(k)}_{ij}$ 表示从服务器 $i$ 到服务器 $j$ 只使用集合 $\\{1, 2, \\dots, k\\}$ 中的中间服务器的最短路径。\n\n确定 Floyd-Warshall 算法第一次完整迭代（即 $k=1$）后得到的矩阵 $D^{(1)}$。你的答案应该是一个完整的 $4 \\times 4$ 矩阵。", "solution": "我们应用 Floyd–Warshall 算法对 $k=1$ 进行更新。递推关系式为\n$$\nD^{(1)}_{ij}=\\min\\!\\left(D^{(0)}_{ij},\\,D^{(0)}_{i1}+D^{(0)}_{1j}\\right).\n$$\n- 对于 $i=1$，由于 $D^{(0)}_{11}=0$，我们有对所有 $j$ 都有 $D^{(0)}_{11}+D^{(0)}_{1j}=D^{(0)}_{1j}$，因此 $D^{(1)}_{1j}=D^{(0)}_{1j}$。所以第 1 行保持为 $\\big(0,\\,8,\\,\\infty,\\,1\\big)$。\n- 对于 $i=2$，$D^{(0)}_{21}=\\infty$，所以对所有 $j$ 都有 $D^{(0)}_{21}+D^{(0)}_{1j}=\\infty$，因此 $D^{(1)}_{2j}=D^{(0)}_{2j}$。所以第 2 行保持为 $\\big(\\infty,\\,0,\\,1,\\,\\infty\\big)$。\n- 对于 $i=3$，$D^{(0)}_{31}=4$ 是有限的，所以对每个 $j$ 进行计算：\n$$\n\\begin{aligned}\nD^{(1)}_{31}=\\min\\!\\big(4,\\,4+0\\big)=4,\\\\\nD^{(1)}_{32}=\\min\\!\\big(\\infty,\\,4+8\\big)=12,\\\\\nD^{(1)}_{33}=\\min\\!\\big(0,\\,4+\\infty\\big)=0,\\\\\nD^{(1)}_{34}=\\min\\!\\big(\\infty,\\,4+1\\big)=5.\n\\end{aligned}\n$$\n所以第 3 行变为 $\\big(4,\\,12,\\,0,\\,5\\big)$。\n- 对于 $i=4$，$D^{(0)}_{41}=\\infty$，所以 $D^{(1)}_{4j}=D^{(0)}_{4j}$。所以第 4 行保持为 $\\big(\\infty,\\,2,\\,9,\\,0\\big)$。\n\n因此，\n$$\nD^{(1)}=\\begin{pmatrix}\n0  8  \\infty  1\\\\\n\\infty  0  1  \\infty\\\\\n4  12  0  5\\\\\n\\infty  2  9  0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n0  8  \\infty  1\\\\\n\\infty  0  1  \\infty\\\\\n4  12  0  5\\\\\n\\infty  2  9  0\n\\end{pmatrix}}$$", "id": "1370977"}, {"introduction": "Floyd-Warshall 算法的精髓在于其迭代过程，即最短路径是逐步构建和优化的。本练习要求您精确找出某条特定路径在哪一轮迭代中首次被更新，这能帮助您深入理解早期迭代中找到的路径是如何在后续迭代中作为子路径构成更优解的，从而揭示算法的动态规划本质。[@problem_id:1370958]", "problem": "考虑一个有5个顶点的有向图，顶点标记为 {1, 2, 3, 4, 5}。这些顶点之间最短路径的初始权重矩阵，记为 $D^{(0)}$，如下所示。矩阵中值为 $\\infty$ 的项表示对应顶点之间没有直接路径。\n\n$$\nD^{(0)} = \\begin{pmatrix}\n0   \\infty   \\infty   \\infty   5 \\\\\n3   0   1   \\infty   \\infty \\\\\n\\infty   \\infty   0   2   \\infty \\\\\n\\infty   6   \\infty   0   \\infty \\\\\n\\infty   \\infty   \\infty   4   0\n\\end{pmatrix}\n$$\n\nFloyd-Warshall 算法通过迭代改进路径估计来找到所有顶点对之间的最短路径。它生成一个矩阵序列 $D^{(0)}, D^{(1)}, D^{(2)}, \\dots, D^{(5)}$。矩阵中的一个元素，用其行 $i$ 和列 $j$ 表示为 $(i,j)$ 项，如果它在矩阵 $D^{(k)}$ 中的值小于其在 $D^{(k-1)}$ 中的值，并且在之前的任何迭代中其值都未曾改变（即，对于所有 $1 \\le m  k$，其在 $D^{(m)}$ 中的值与在 $D^{(m-1)}$ 中的值相同），则称其在第 $k$ 次迭代（其中 $k \\ge 1$）时首次被更新。\n\n以下哪个元素是在算法的第 $k=3$ 次迭代期间首次被更新的？\n\nA. $(2,5)$ 项\n\nB. $(4,1)$ 项\n\nC. $(4,3)$ 项\n\nD. $(2,4)$ 项\n\nE. $(1,2)$ 项", "solution": "Floyd–Warshall 的递推关系是\n$$\nD^{(k)}_{ij}=\\min\\left(D^{(k-1)}_{ij},\\,D^{(k-1)}_{i k}+D^{(k-1)}_{k j}\\right),\n$$\n意味着在第 $k$ 次迭代中，我们只允许使用来自集合 $\\{1,\\dots,k\\}$ 中的顶点作为中间顶点。\n\n从给定的 $D^{(0)}$ 开始，考虑 $k=1$（中间顶点为1）。我们使用 $D^{(0)}$ 的第1列和第1行：\n- 对于 $i=2$，$D^{(0)}_{21}=3$ 且 $D^{(0)}_{1 5}=5$，所以\n$$\nD^{(1)}_{25}=\\min\\left(D^{(0)}_{25},\\,D^{(0)}_{21}+D^{(0)}_{15}\\right)=\\min\\left(\\infty,\\,3+5\\right)=8,\n$$\n这是一次首次更新。所有其他经过顶点1的路径对都保持不变，因为 $D^{(0)}_{i1}=\\infty$ 或 $D^{(0)}_{1j}=\\infty$。\n\n因此在 $k=1$ 之后，\n$$\nD^{(1)}=\\begin{pmatrix}\n0   \\infty   \\infty   \\infty   5\\\\\n3   0   1   \\infty   8\\\\\n\\infty   \\infty   0   2   \\infty\\\\\n\\infty   6   \\infty   0   \\infty\\\\\n\\infty   \\infty   \\infty   4   0\n\\end{pmatrix}.\n$$\n\n对于 $k=2$（中间顶点为2），使用 $D^{(1)}$ 的第2列和第2行。由于 $D^{(1)}_{42}=6$ 且第2行为 $(3,0,1,\\infty,8)$，我们得到\n$$\nD^{(2)}_{41}=\\min\\left(\\infty,\\,6+3\\right)=9,\\quad\nD^{(2)}_{43}=\\min\\left(\\infty,\\,6+1\\right)=7,\\quad\nD^{(2)}_{45}=\\min\\left(\\infty,\\,6+8\\right)=14,\n$$\n均为首次更新。没有其他路径对通过顶点2得到改善。因此\n$$\nD^{(2)}=\\begin{pmatrix}\n0   \\infty   \\infty   \\infty   5\\\\\n3   0   1   \\infty   8\\\\\n\\infty   \\infty   0   2   \\infty\\\\\n9   6   7   0   14\\\\\n\\infty   \\infty   \\infty   4   0\n\\end{pmatrix}.\n$$\n\n对于 $k=3$（中间顶点为3），使用 $D^{(2)}$ 的第3列和第3行。我们有 $D^{(2)}_{23}=1$ 且第3行为 $(\\infty,\\infty,0,2,\\infty)$。那么\n$$\nD^{(3)}_{24}=\\min\\left(D^{(2)}_{24},\\,D^{(2)}_{23}+D^{(2)}_{34}\\right)=\\min\\left(\\infty,\\,1+2\\right)=3,\n$$\n这是一次首次更新。对于所有其他列出的候选项，在 $k=3$ 时没有发生改善：$(2,5)$ 项已在 $k=1$ 时更新，$(4,1)$ 和 $(4,3)$ 项在 $k=2$ 时更新，而 $(1,2)$ 项没有通过顶点3改善，因为 $D^{(2)}_{13}=\\infty$ 或 $D^{(2)}_{32}=\\infty$。\n\n因此，唯一一个在第 $k=3$ 次迭代时首次更新的所列元素是 $(2,4)$ 项。", "answer": "$$\\boxed{D}$$", "id": "1370958"}, {"introduction": "计算所有顶点对之间的最短路径后，其结果矩阵蕴含了关于图结构的丰富信息。这个更进一步的练习将要求您利用最终的距离矩阵来判断一个图是否为二分图。通过解决这个问题，您将把算法计算与图的理论性质联系起来，展示所学工具的强大应用潜力。[@problem_id:1370948]", "problem": "考虑一个包含 $n$ 个顶点的无向、无权、连通图 $G$，顶点标记为 $v_1, v_2, \\dots, v_n$。在该图上执行 Floyd-Warshall 算法，以计算所有顶点对之间的最短路径距离矩阵，记为 $D$。该矩阵中的元素 $D_{ij}$ 表示顶点 $v_i$ 和顶点 $v_j$ 之间的最短路径长度。根据定义，对于所有 $i$，$D_{ii} = 0$，且对于所有顶点对 $(i, j)$，$D_{ij} = D_{ji}$。\n\n一个图被称为二分图，如果它的顶点可以被划分为两个不相交且独立的集合 $U$ 和 $V$，使得图中的每条边都连接 $U$ 中的一个顶点和 $V$ 中的一个顶点。一个等价的性质是，一个图是二分图当且仅当它不包含奇数长度的环。\n\n根据最终的距离矩阵 $D$，以下哪个条件是图 $G$ 为二分图的充要条件？\n\nA. 对于任意三个顶点 $(v_i, v_j, v_k)$，最短距离 $D_{ij}$ 的奇偶性与距离之和 $D_{ik} + D_{kj}$ 的奇偶性相同。即，$D_{ij} \\equiv (D_{ik} + D_{kj}) \\pmod 2$。\n\nB. 对于任意一对不同的顶点 $(v_i, v_j)$，最短距离 $D_{ij}$ 是一个偶数。\n\nC. 存在一个顶点 $v_k$，使得对于任何其他顶点 $v_i$，最短距离 $D_{ki}$ 是一个偶数。\n\nD. 对于任意三个顶点 $(v_i, v_j, v_k)$，三角不等式对奇偶性成立：$D_{ij} \\pmod 2 \\le (D_{ik} \\pmod 2) + (D_{kj} \\pmod 2)$。\n\nE. 对于任意选定的顶点 $v_i$，其在距离矩阵中对应行的最大值 $\\max_{j} D_{ij}$ 是奇数。", "solution": "我们通过一个二着色函数来形式化二分性。一个图 $G$ 是二分图，当且仅当存在一个映射 $c: V(G) \\to \\{0,1\\}$，使得每条边的端点颜色都不同。在这样的图中，任何路径在每一步都会交替划分，因此对于任意顶点 $v_{i},v_{j}$，从 $v_{i}$ 到 $v_{j}$ 的任何路径的长度的奇偶性是固定的，并且等于 $c(v_{i})+c(v_{j}) \\pmod 2$。特别地，最短路径长度的奇偶性满足\n$$\nD_{ij} \\equiv c(v_{i})+c(v_{j}) \\pmod 2.\n$$\n\n我们现在分析每个选项。\n\n首先，证明条件 A 是必要的。假设 $G$ 是一个具有着色 $c$ 的二分图。对于任意三个顶点 $(v_{i},v_{j},v_{k})$，\n$$\nD_{ij} \\equiv c(v_{i})+c(v_{j}) \\pmod 2,\\quad\nD_{ik} \\equiv c(v_{i})+c(v_{k}) \\pmod 2,\\quad\nD_{kj} \\equiv c(v_{k})+c(v_{j}) \\pmod 2.\n$$\n将最后两个同余式相加并使用模2加法，得到\n$$\nD_{ik}+D_{kj} \\equiv \\big(c(v_{i})+c(v_{k})\\big)+\\big(c(v_{k})+c(v_{j})\\big) \\equiv c(v_{i})+c(v_{j}) \\equiv D_{ij} \\pmod 2,\n$$\n所以 $D_{ij} \\equiv D_{ik}+D_{kj} \\pmod 2$ 对所有三元组都成立，即 A 成立。\n\n接下来，证明条件 A 是充分的。假设对于所有三元组 $(v_{i},v_{j},v_{k})$，我们有 $D_{ij} \\equiv D_{ik}+D_{kj} \\pmod 2$。固定一个任意的根节点 $v_{r}$ 并定义\n$$\nc(v_{i}) \\equiv D_{ri} \\pmod 2.\n$$\n设 $(v_{u},v_{v})$ 为任意一条边。那么 $D_{uv}=1$。使用假设的条件，并令 $(i,j,k)=(u,v,r)$，\n$$\nD_{uv} \\equiv D_{ur}+D_{rv} \\pmod 2 \\;\\Longrightarrow\\; 1 \\equiv D_{ru}+D_{rv} \\pmod 2,\n$$\n所以 $D_{ru}$ 和 $D_{rv}$ 的奇偶性相反，即 $c(v_{u}) \\neq c(v_{v})$。因此，每条边都连接着不同颜色的顶点，集合 $\\{v: c(v)=0\\}$ 和 $\\{v: c(v)=1\\}$ 构成一个二分划分。因此 A 是充分的。\n\n因此，A 是充要条件。\n\n我们现在反驳其余选项：\n\nB. 在任何至少有两个顶点的连通无权图中，都存在一条边 $(v_{u},v_{v})$，其 $D_{uv}=1$，是奇数。因此，对于 $i \\neq j$ 的所有 $D_{ij}$ 都是偶数是不可能的。所以 B 既不是必要的也不是充分的。\n\nC. 如果存在一个顶点 $v_{k}$，使得所有 $D_{ki}$ 都是偶数，那么对于 $v_{k}$ 的任何邻居 $v_{u}$，我们会有 $D_{ku}=1$，这是一个奇数，产生矛盾。因此，C 在任何非平凡的连通图中都不能成立，既不是必要的也不是充分的。\n\nD. 这个条件不充分：在一个三角形图中，$D_{ij}=1$ (当 $i \\neq j$ 时)，对于任意三元组 $(v_{i},v_{j},v_{k})$ 且 $k \\notin \\{i,j\\}$，我们有 $D_{ij} \\pmod 2 = 1 \\le 1+1 = (D_{ik} \\pmod 2)+(D_{kj} \\pmod 2)$，所以该条件成立，但图不是二分图。因此 D 不能作为特征描述。\n\nE. 这个条件在一般的二分图中是错误的。例如，在一个包含三个顶点的路径图中，一个端点的最大距离是 $2$，是偶数。因此 E 不是必要的。\n\n因此，唯一既必要又充分的条件是 A。", "answer": "$$\\boxed{A}$$", "id": "1370948"}]}