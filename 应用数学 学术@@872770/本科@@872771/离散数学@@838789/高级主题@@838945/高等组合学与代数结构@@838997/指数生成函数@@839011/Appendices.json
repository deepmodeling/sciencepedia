{"hands_on_practices": [{"introduction": "首先，我们来探讨一个融合了选择与排列的问题。这个关于排列彩色书籍的练习 [@problem_id:1369393] 为我们搭建了一座从直接的组合推理通往更抽象、更强大的指数生成函数框架的桥梁。通过这个练习，我们将学会如何处理排列中对象属性的约束条件。", "problem": "一位图书管理员的任务是将一套 $n$ 本不同的新书排放在一个长书架上。在放置之前，每本书都必须贴上一张贴纸，贴纸可以是红色或蓝色。图书管理员必须对所有 $n$ 本书进行排列，使得贴有红色贴纸的书的数量为奇数。请找出一个关于正整数 $n$ 的封闭形式表达式，表示所有可能的不同排列的总数。", "solution": "我们必须计算不同结果的总数，这些结果既要指定 $n$ 本不同书籍的线性排列顺序，又要为每本书指定贴纸颜色（红色或蓝色），同时满足红色贴纸数量为奇数的约束条件。\n\n首先，对于排列顺序：由于书籍是不同的，共有 $n!$ 种可能的排列。\n\n其次，对于贴纸的分配：每本书可以独立地被分配为红色或蓝色，总共有 $2^{n}$ 种着色方案。令 $E$ 为红色贴纸数量为偶数的着色方案数， $O$ 为红色贴纸数量为奇数的着色方案数。根据二项式定理，\n$$\n(1+1)^{n}=\\sum_{k=0}^{n}\\binom{n}{k}=2^{n},\n$$\n以及通过计算 $(1-1)^{n}$，\n$$\n(1-1)^{n}=\\sum_{k=0}^{n}(-1)^{k}\\binom{n}{k}=0.\n$$\n记 $E=\\sum_{k\\ \\text{even}}\\binom{n}{k}$ 和 $O=\\sum_{k\\ \\text{odd}}\\binom{n}{k}$，这两个恒等式给出了方程组\n$$\nE+O=2^{n},\\qquad E-O=0.\n$$\n求解该方程组，我们得到 $E=O=2^{n-1}$。因此，有效的着色方案（即红色贴纸数量为奇数）的数量为 $2^{n-1}$。\n\n由于着色方案的选择和排列顺序的选择是相互独立的，所以不同排列的总数是两者的乘积\n$$\nn!\\cdot 2^{n-1}.\n$$", "answer": "$$\\boxed{2^{n-1}n!}$$", "id": "1369393"}, {"introduction": "接下来，让我们解决一个完美展示指数生成函数乘法法则核心威力的经典问题 [@problem_id:1369372]。通过构造一个其数字具有特定奇偶性约束的序列，你将学会如何为每种类型的元素（在此为数字 '0', '1', '2'）构建相应的指数生成函数。将这些函数相乘，我们就能得到一个统一的生成函数，其系数直接给出了满足所有约束的序列总数。", "problem": "考虑由集合 $\\{0, 1, 2\\}$ 中的数字构成的长度为 $n$ 的序列。我们希望构造满足以下两个特定条件的序列：\n1. 数字 '0' 必须出现偶数次。\n2. 数字 '1' 必须出现奇数次。\n对数字 '2' 出现的次数没有限制。\n\n求长度为 $n$ 的这种序列的总数的封闭形式表达式，其中 $n$ 是一个正整数。", "solution": "设长度为 $n$ 的序列（由 $\\{0,1,2\\}$ 中的元素构成）中零的个数为 $a$，一的个数为 $b$。我们要求的是 $a$ 为偶数且 $b$ 为奇数的序列数量 $N$。\n\n使用奇偶性指示函数\n$$\n\\mathbf{1}_{\\text{$a$ even}}=\\frac{1+(-1)^{a}}{2},\\qquad \\mathbf{1}_{\\text{$b$ odd}}=\\frac{1-(-1)^{b}}{2}.\n$$\n因此\n$$\nN=\\sum_{\\text{all sequences}}\\frac{1+(-1)^{a}}{2}\\cdot\\frac{1-(-1)^{b}}{2}\n=\\frac{1}{4}\\sum_{\\text{all sequences}}\\bigl(1-(-1)^{b}+(-1)^{a}-(-1)^{a+b}\\bigr).\n$$\n将这四个和记为\n$$\nS_{0}=\\sum 1,\\quad S_{b}=\\sum (-1)^{b},\\quad S_{a}=\\sum (-1)^{a},\\quad S_{a+b}=\\sum (-1)^{a+b}.\n$$\n由于每个位置独立地从 $\\{0,1,2\\}$ 中取一个值，每个和都可以通过逐个位置的权重和独立性来计算：\n- 对于 $S_{0}$，每个位置的贡献是 $1+1+1=3$，所以 $S_{0}=3^{n}$。\n- 对于 $S_{b}$，分配权重 $w(0)=1$, $w(1)=-1$, $w(2)=1$。那么每个位置的总权重是 $1+(-1)+1=1$，因此 $S_{b}=1^{n}=1$。\n- 对于 $S_{a}$，分配权重 $w(0)=-1$, $w(1)=1$, $w(2)=1$。那么每个位置的总权重是 $(-1)+1+1=1$，因此 $S_{a}=1^{n}=1$。\n- 对于 $S_{a+b}$，分配权重 $w(0)=-1$, $w(1)=-1$, $w(2)=1$。那么每个位置的总权重是 $(-1)+(-1)+1=-1$，因此 $S_{a+b}=(-1)^{n}$。\n\n因此，\n$$\nN=\\frac{1}{4}\\bigl(S_{0}-S_{b}+S_{a}-S_{a+b}\\bigr)\n=\\frac{1}{4}\\bigl(3^{n}-1+1-(-1)^{n}\\bigr)\n=\\frac{3^{n}-(-1)^{n}}{4}.\n$$\n这就是对于所有正整数 $n$ 所求的封闭形式表达式。", "answer": "$$\\boxed{\\frac{3^{n}-(-1)^{n}}{4}}$$", "id": "1369372"}, {"introduction": "在之前的基础上，这最后一个练习 [@problem_id:1369365] 将处理“至少一个”的约束，这是组合计数问题中的一个常见挑战。确定将不同挑战分到几个类别中并确保每个类别都非空的方法数，这在数学上等价于对满射函数进行计数。你将看到，对于这类通常使用容斥原理解决的问题，指数生成函数提供了一种更为结构化和优雅的替代方案。", "problem": "一位视频游戏设计师正在创建一个新关卡，该关卡包含 $n$ 个不同的挑战。这些挑战中的每一个都必须被归类为三种类型中的一种：解谜、战斗或陷阱。为确保玩家获得平衡且引人入胜的体验，关卡的设计蓝图规定，三种类型的挑战每种至少要有一个。\n\n您的任务是根据这些规则，确定设计师可以对这 $n$ 个挑战进行分类的总共有多少种不同的方式。请提供一个关于 $n$ 的该数量的闭式解析表达式。", "solution": "我们将分类问题建模为一个从包含 $n$ 个不同挑战的集合到包含三种标记类型 $\\{P, C, T\\}$（解谜、战斗、陷阱）的集合的函数。要求每种类型至少出现一次，意味着该函数必须是满射的。\n\n从一个 $n$ 元集到一个 $3$ 元集的函数总数是 $3^{n}$。我们减去那些缺少至少一种类型的分配方式。设 $A_{P}$ 为不包含解谜的分配集合，$A_{C}$ 为不包含战斗的分配集合，$A_{T}$ 为不包含陷阱的分配集合。那么\n$$\n|A_{P}| = |A_{C}| = |A_{T}| = 2^{n},\n$$\n因为此时每个挑战只有两种选择。\n\n根据容斥原理，\n$$\n|A_{P} \\cup A_{C} \\cup A_{T}| = \\sum |A_{i}| - \\sum |A_{i} \\cap A_{j}| + |A_{P} \\cap A_{C} \\cap A_{T}|.\n$$\n对于不同的 $i,j$，有 $|A_{i} \\cap A_{j}| = 1^{n}$，因为只剩下一种类型，每个挑战都必须被分配到那唯一的类型；这样的交集有 $\\binom{3}{2} = 3$ 个。三集合的交集为空，所以 $|A_{P} \\cap A_{C} \\cap A_{T}| = 0$。因此，\n$$\n|A_{P} \\cup A_{C} \\cup A_{T}| = 3 \\cdot 2^{n} - 3 \\cdot 1^{n} + 0 = 3 \\cdot 2^{n} - 3.\n$$\n因此，有效分配（满射）的数量是\n$$\n3^{n} - |A_{P} \\cup A_{C} \\cup A_{T}| = 3^{n} - \\left(3 \\cdot 2^{n} - 3\\right) = 3^{n} - 3 \\cdot 2^{n} + 3.\n$$\n这个结果也等于 $3! \\, S(n,3)$，其中 $S(n,3)$ 是第二类斯特林数，其闭式形式可简化为相同的表达式。", "answer": "$$\\boxed{3^{n} - 3 \\cdot 2^{n} + 3}$$", "id": "1369365"}]}