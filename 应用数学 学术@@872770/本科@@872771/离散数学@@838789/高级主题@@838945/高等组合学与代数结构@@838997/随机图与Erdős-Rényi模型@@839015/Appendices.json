{"hands_on_practices": [{"introduction": "任何随机模型的分析都始于对其基本统计量的理解。在 Erdős-Rényi 随机图 $G(n,p)$ 模型中，最核心的随机变量之一是图中边的总数。通过计算边数的方差，我们可以量化网络连接性的变化程度，这对于理解一个典型随机图的结构会在多大程度上偏离其平均状态至关重要，也是评估网络稳定性和可预测性的关键第一步。[@problem_id:1540412]", "problem": "一个用于描述去中心化网络（例如点对点系统）中连接形成的简化模型是 Erdős-Rényi 随机图，记作 $G(n,p)$。在此模型中，网络由 $n$ 个节点（顶点）组成。任意一对不同节点之间，都以一个固定的概率 $p$ 独立地形成一条边，这条边代表一个直接连接。\n\n令 $N_E$ 为表示 $G(n,p)$ 图的特定实现中总边数的随机变量。你的任务是分析网络连接性的可变性。推导总边数方差 $\\text{Var}(N_E)$ 的一个闭式解析表达式，用节点数 $n$ 和连接概率 $p$ 来表示。", "solution": "令 $n$ 为节点数。没有自环的可能无向边的数量为 $m=\\binom{n}{2}$。对于每个满足 $1 \\leq i  j \\leq n$ 的无序对 $\\{i,j\\}$，定义指示随机变量 $X_{ij}$ 如下：\n$$\nX_{ij}=\\begin{cases}\n1,  \\text{如果边 } \\{i,j\\} \\text{ 存在，}\\\\\n0,  \\text{否则。}\n\\end{cases}\n$$\n在 $G(n,p)$ 模型中，每条边都以概率 $p$ 独立地被包含，因此 $X_{ij}$ 是独立同分布的伯努利随机变量，其\n$$\n\\mathbb{E}[X_{ij}]=p, \\quad \\text{和} \\quad \\operatorname{Var}(X_{ij})=p(1-p).\n$$\n总边数是这些指示变量的和：\n$$\nN_{E}=\\sum_{1 \\leq i  j \\leq n} X_{ij}.\n$$\n利用和的方差以及独立性，\n$$\n\\operatorname{Var}(N_{E})=\\operatorname{Var}\\left(\\sum_{1 \\leq i  j \\leq n} X_{ij}\\right)=\\sum_{1 \\leq i  j \\leq n} \\operatorname{Var}(X_{ij}) + 2\\sum_{\\substack{(i,j)  (k,\\ell) \\\\ \\{i,j\\} \\neq \\{k,\\ell\\}}} \\operatorname{Cov}(X_{ij},X_{k\\ell}).\n$$\n由于边是独立包含的，当 $\\{i,j\\} \\neq \\{k,\\ell\\}$ 时，协方差 $\\operatorname{Cov}(X_{ij},X_{k\\ell})=0$，因此\n$$\n\\operatorname{Var}(N_{E})=\\sum_{1 \\leq i  j \\leq n} \\operatorname{Var}(X_{ij})=\\sum_{1 \\leq i  j \\leq n} p(1-p).\n$$\n和式中有 $m=\\binom{n}{2}$ 项，所以\n$$\n\\operatorname{Var}(N_{E})=\\binom{n}{2}\\,p(1-p).\n$$\n等价地，注意到 $N_{E}\\sim \\operatorname{Binomial}\\!\\left(\\binom{n}{2},\\,p\\right)$，这就是标准的二项分布方差。", "answer": "$$\\boxed{\\binom{n}{2}\\,p\\left(1-p\\right)}$$", "id": "1540412"}, {"introduction": "在掌握了边的总数这类全局属性之后，一个自然的问题是：特定的、有意义的局部结构出现的可能性有多大？这个问题引导我们从宏观统计走向微观模式的分析。通过计算一个简单的四原子链状聚合物（即图论中的路径图 $P_4$）在 $G(4,p)$ 模型中形成的概率，我们可以学习如何将组合计数与概率论结合，用以预测特定网络“基序”（motifs）出现的频率。[@problem_id:1394761]", "problem": "在一个理论化学模型中，四个相同的原子被放置在溶液中。任意一对原子之间可以形成一个稳定的化学键，其概率为 $p$，且每对原子之间形成键的事件是独立的。为了形成一种特定类型的线性聚合物，这四个原子必须以单条无支链的形式连接，该链包含所有四个原子，并且不能存在其他化学键。例如，如果我们将原子标记为 1、2、3 和 4，一种可能的构型是仅在 (1,2)、(2,3) 和 (3,4) 这几对原子之间存在化学键。\n\n这个由原子和潜在化学键组成的系统可以被建模为 Erdős–Rényi 模型中的一个随机图 $G(n,p)$，其中 $n=4$ 个顶点代表原子，边代表化学键。\n\n求解这四个原子形成这样一个线性聚合物结构的概率，该概率是 $p$ 的函数。", "solution": "将化学键建模为 Erdős–Rényi 随机图 $G(4,p)$ 中的边，该图有 $n=4$ 个带标签的顶点。共有 $\\binom{4}{2}=6$ 条可能的边，每条边存在的概率为 $p$，不存在的概率为 $1-p$，且各边是否出现是独立的。\n\n一个包含所有四个原子的有效线性聚合物恰好对应于路径图 $P_{4}$：一个恰好有三条边、排列成单条无支链形式的生成树，且不存在其他边。对于任何一个特定的带标签的 $P_{4}$ 实例，必须恰好有 3 条边存在，3 条边不存在，因此该特定边集出现的概率为\n$$\np^{3}(1-p)^{3}.\n$$\n\n剩下的问题是计算能形成 $P_{4}$ 的带标签的边集的数量。一种方法是：\n- 4个带标签的顶点沿一条链的线性排列数量为 $4!$。\n- 反转顺序会得到相同的边集，所以我们除以 2。\n因此有\n$$\n\\frac{4!}{2}=12\n$$\n个不同的带标签的 $P_{4}$ 图。\n\n等价地，根据 Cayley 公式，在 4 个顶点上有 $4^{4-2}=16$ 个带标签的树；其中，有 4 个是星形图 $K_{1,3}$（通过选择中心点），剩下 $16-4=12$ 个是路径图 $P_{4}$。\n\n因此，对所有这些带标签的构型求和，所求概率为\n$$\n12\\,p^{3}(1-p)^{3}.\n$$", "answer": "$$\\boxed{12\\,p^{3}\\left(1-p\\right)^{3}}$$", "id": "1394761"}, {"introduction": "现在，让我们来解决一个更深入的问题，它展示了期望的线性性质在处理复杂图属性时的强大威力。该问题定义了一个基于每个顶点局部邻域结构的“得分”函数，其计算方式巧妙地依赖于图中每个顶点的连接情况。计算这个得分的期望值，是分析随机图上的贪心算法等高级主题时所需的一项核心技能，它要求我们灵活运用关于二项分布的知识来解决看似棘手的问题。[@problem_id:1394813]", "problem": "在网络算法的研究中，分析依赖于局部连通性的量通常很有用。考虑一个包含 $n$ 个顶点的随机图 $G$，它从 Erdős-Rényi 模型 $G(n,p)$ 中抽取。在这个模型中，$\\binom{n}{2}$ 条可能的边中的每一条都以概率 $p$ 独立地包含在图中。\n\n设顶点按一个固定的、预先确定的顺序 $v_1, v_2, \\dots, v_n$ 进行标记。对于每个顶点 $v_i$，令 $K_i$ 为一个随机变量，表示 $v_i$ 的邻居中索引小于 $i$ 的数量。即，$K_i = |\\{v_j \\mid j  i \\text{ 且边 } (v_i, v_j) \\text{ 存在}\\}|$。\n\n根据这种局部连通性结构，为图 $G$ 赋予一个得分 $S(G)$，定义为：\n$$S(G) = \\sum_{i=1}^{n} \\frac{1}{1+K_i}$$\n确定该得分的期望值 $\\mathbb{E}[S(G)]$。将您的答案表示为关于 $n$ 和 $p$ 的闭式解析表达式。", "solution": "在 Erdős-Rényi 模型 $G(n,p)$ 中，对于每个 $i \\in \\{1,\\dots,n\\}$，顶点 $v_{i}$ 在 $\\{v_{1},\\dots,v_{i-1}\\}$ 中的邻居数量为\n$$\nK_{i} \\sim \\text{Binomial}(i-1, p),\n$$\n因为与较早顶点的 $i-1$ 条潜在边中的每一条都以概率 $p$ 独立存在。\n\n根据期望的线性性，\n$$\n\\mathbb{E}[S(G)] = \\sum_{i=1}^{n} \\mathbb{E}\\!\\left[\\frac{1}{1+K_{i}}\\right].\n$$\n\n固定 $m \\in \\mathbb{N}_{0}$ 并令 $X \\sim \\text{Binomial}(m,p)$。那么\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1+X}\\right] = \\sum_{k=0}^{m} \\frac{1}{k+1} \\binom{m}{k} p^{k} (1-p)^{m-k}.\n$$\n使用组合恒等式 $\\frac{1}{k+1}\\binom{m}{k} = \\frac{1}{m+1}\\binom{m+1}{k+1}$ 来重写\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1+X}\\right] = \\frac{1}{m+1} \\sum_{k=0}^{m} \\binom{m+1}{k+1} p^{k} (1-p)^{m-k}.\n$$\n令 $j=k+1$ 可得\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1+X}\\right] = \\frac{1}{(m+1)p} \\sum_{j=1}^{m+1} \\binom{m+1}{j} p^{j} (1-p)^{(m+1)-j}.\n$$\n加上并减去 $j=0$ 的项以使用二项式定理：\n$$\n\\sum_{j=0}^{m+1} \\binom{m+1}{j} p^{j} (1-p)^{(m+1)-j} = 1, \\quad \\text{且 } j=0 \\text{ 的项是 } (1-p)^{m+1}.\n$$\n因此，\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1+X}\\right] = \\frac{1 - (1-p)^{m+1}}{(m+1)p}.\n$$\n\n对于 $K_{i} \\sim \\text{Binomial}(i-1,p)$，令 $m=i-1$ 可得\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1+K_{i}}\\right] = \\frac{1 - (1-p)^{i}}{i p}.\n$$\n因此，\n$$\n\\mathbb{E}[S(G)] = \\sum_{i=1}^{n} \\frac{1 - (1-p)^{i}}{i p} = \\frac{1}{p} \\sum_{i=1}^{n} \\frac{1 - (1-p)^{i}}{i}.\n$$\n这个表达式对所有 $p \\in [0,1]$ 都有效，其中 $p=0$ 的情况可以通过连续性来理解。", "answer": "$$\\boxed{\\frac{1}{p}\\sum_{i=1}^{n}\\frac{1-(1-p)^{i}}{i}}$$", "id": "1394813"}]}