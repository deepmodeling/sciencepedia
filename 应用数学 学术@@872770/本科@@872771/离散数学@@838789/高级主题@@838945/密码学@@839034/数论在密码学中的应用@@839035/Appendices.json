{"hands_on_practices": [{"introduction": "RSA 密码系统的构建始于密钥的生成，这是保障其安全性的第一步，也是至关重要的一步。整个系统的安全性都建立在正确选择参数的基础之上。本练习 [@problem_id:1349562] 将引导你探究一个在选择公钥指数 $e$ 时常见的错误，并揭示其背后制约该选择的基本数论原理。", "problem": "一名本科生正在学习 Rivest-Shamir-Adleman (RSA) 公钥密码系统。在一项实践练习中，他们选择了两个小素数 $p=5$ 和 $q=11$。他们正确地计算了模数 $n = pq$ 和欧拉函数 $\\phi(n) = (p-1)(q-1)$。\n\n按照 RSA 密钥生成流程，该学生需要选择一个公钥指数 $e$。他们选择了 $e=20$。然而，当他们尝试计算对应的私钥指数 $d$（它应该是 $e$ 模 $\\phi(n)$ 的乘法逆元）时，他们发现不存在这样的整数 $d$。\n\n下列哪个陈述正确地指出了导致此失败的根本数学原因？\n\nA. 所选的素数 $q=11$ 不够大，无法保证能生成有效的密钥对。\n\nB. 公钥指数 $e$ 必须是素数，但所选的值 $e=20$ 是合数。\n\nC. 公钥指数 $e$ 和 $\\phi(n)$ 必须互素，但它们共享一个大于 1 的公因数。\n\nD. 公钥指数 $e$ 必须小于模数 $n$。\n\nE. 初始数字之一 $p=5$ 太小，导致 $\\phi(n)$ 成为一个偶数。", "solution": "给定素数 $p=5$ 和 $q=11$，RSA 模数和欧拉函数为\n$$n=pq=5\\cdot 11=55,$$\n$$\\phi(n)=(p-1)(q-1)=(5-1)(11-1)=4\\cdot 10=40.$$\n在 RSA 中，私钥指数 $d$ 被定义为满足同余式\n$$ed\\equiv 1 \\pmod{\\phi(n)}.$$\n一个基本的数论事实是，整数 $a$ 存在模 $m$ 的乘法逆元，当且仅当 $\\gcd(a,m)=1$。因此，$d$ 存在的充分必要条件是\n$$\\gcd(e,\\phi(n))=1.$$\n对于所选的 $e=20$ 和 $\\phi(n)=40$，我们计算\n$$\\gcd(20,40)=201.$$\n等价地，$20$ 整除 $40$，所以 $20$ 在模 $40$ 下不可逆。因此，不存在满足 $20d\\equiv 1 \\pmod{40}$ 的整数 $d$，这就解释了失败的原因。\n\n评估各个选项：\n- A 是错误的：$q$ 的大小不决定可逆性；只有 $\\gcd(e,\\phi(n))$ 才重要。\n- B 是错误的：$e$ 无需是素数；它只需要与 $\\phi(n)$ 互素（例如，当 $\\gcd(9,40)=1$ 时，$e=9$ 就是有效的）。\n- C 是正确的：这里 $e$ 和 $\\phi(n)$ 共享一个公因数 $20$，因此逆元不存在。\n- D 是错误的：此条件 ($e  n$) 已满足，但这与 $e$ 的可逆性无关。\n- E 是错误的：虽然 $p=5$ 太小，并且 $\\phi(n)$ 是偶数，但这在所有实际的RSA实现中都是常态，并非失败原因。", "answer": "$$\\boxed{C}$$", "id": "1349562"}, {"introduction": "密钥生成后，我们便可以开始加密消息。然而，并非所有消息在加密后都会如预期般变化。本练习 [@problem_id:1349536] 将研究“不动点”——那些经过加密函数处理后仍保持不变的消息，旨在揭示一个潜在的系统弱点，并通过中国剩余定理的应用加深你对模运算的理解。", "problem": "在 Rivest-Shamir-Adleman (RSA) 公钥密码系统中，一条消息 $M$ 使用公钥 $(n, e)$ 通过关系式 $C \\equiv M^e \\pmod{n}$ 被加密成密文 $C$。如果一条消息是加密函数的“不动点”，即加密过程返回原始消息（$C = M$），则会出现一个显著的密码学弱点。\n\n考虑一个简化的 RSA 系统，其公钥为 $(n, e) = (33, 3)$。你的任务是找出在范围 $1  M  32$ 内该加密函数的所有不动点消息值 $M$。\n\n下列哪个集合包含了所有这样的不动点 $M$？\n\nA. $\\{10, 11, 22, 23\\}$\n\nB. $\\{10, 11, 12, 21, 22, 23\\}$\n\nC. $\\{11, 22\\}$\n\nD. $\\{1, 32\\}$\n\nE. $\\{3, 11\\}$\n\nF. $\\{16, 25\\}$", "solution": "一个不动点满足 $M^{e} \\equiv M \\pmod{n}$。当 $(n,e)=(33,3)$ 时，该条件为\n$$\nM^{3} \\equiv M \\pmod{33}.\n$$\n这等价于\n$$\nM^{3}-M \\equiv 0 \\pmod{33} \\quad \\Longleftrightarrow \\quad M(M-1)(M+1) \\equiv 0 \\pmod{33}.\n$$\n分解 $33=3 \\cdot 11$，其中 $\\gcd(3,11)=1$。根据中国剩余定理，同余式 $M^{3} \\equiv M \\pmod{33}$ 成立，当且仅当它同时对模 3 和模 11 成立。\n\n1) 对模 $3$：对于任意素数 $p$ 和任意整数 $a$，根据费马小定理有 $a^{p} \\equiv a \\pmod{p}$。当 $p=3$ 时，每个 $M$ 都满足 $M^{3} \\equiv M \\pmod{3}$。因此，对模 3 没有限制。\n\n2) 对模 $11$：在模 11 的域上，分解\n$$\nM^{3}-M = M(M-1)(M+1).\n$$\n在特征不等于 2 或 3 的情况下，这些因子给出了全部根，因此解满足\n$$\nM \\equiv 0, \\; 1, \\; -1 \\pmod{11},\n$$\n即\n$$\nM \\equiv 0, \\; 1, \\; 10 \\pmod{11}.\n$$\n\n结合对模 3 没有限制的条件，模 33 的解正是那些对模 11 同余于 $0,1,10$ 的 $M$。在范围 $1  M  32$ 内列出这些解：\n- $M \\equiv 0 \\pmod{11}$ 得到 $M \\in \\{11,22\\}$，\n- $M \\equiv 1 \\pmod{11}$ 得到 $M \\in \\{12,23\\}$ (不包括 $M=1$)，\n- $M \\equiv 10 \\pmod{11}$ 得到 $M \\in \\{10,21\\}$ (不包括 $M=32$)。\n\n因此，该集合为 $\\{10,11,12,21,22,23\\}$，对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1349536"}, {"introduction": "RSA 密码系统的安全性最终依赖于分解其公共模数 $n$ 的计算难度。最后的这个练习 [@problem_id:1349546] 将让你扮演攻击者的角色，使用一个简化版的 Pollard p-1 算法。通过亲手执行攻击步骤，你将具体地体会到为何模数 $n$ 的素因数性质对于整个系统的安全至关重要。", "problem": "在一个简化的密码学攻击模型中，攻击者试图找出一个合数 $n$ 的一个非平凡因子。该方法按如下方式进行：选择一个整数底数 $a  1$，并对连续的正整数 $k=1, 2, 3, \\dots$，计算一个值 $g_k = \\gcd(a^{k!} - 1, n)$。第一个使得 $g_k$ 大于1且小于 $n$ 的 $k$ 值，就给出了 $n$ 的一个非平凡因子。\n\n考虑合数 $n = 1333$ 和底数 $a = 2$。\n\n找出使得该方法成功找到一个非平凡因子的最小正整数 $k$。同时，写出对于此 $k$ 值找到的非平凡因子。\n\n以一对整数的形式提供您的答案，其中最小的成功 $k$ 值在前，其后是相应的非平凡因子。", "solution": "我们有 $n=1333$ 和 $a=2$，以及 $g_{k}=\\gcd(2^{k!}-1,n)$。对 $n$ 进行因数分解可得\n$$1333=31\\cdot 43,$$\n因此 $g_{k}$ 的任何非平凡值都必须在 $\\{31,43\\}$ 中，而 $g_{k}=1333$ 则意味着两个素数都能整除 $2^{k!}-1$。\n\n对于一个与2互素的素数 $p$（即 $\\gcd(2,p)=1$），令 $\\operatorname{ord}_{p}(2)$ 表示 2 模 $p$ 的乘法阶。那么\n$$2^{m}\\equiv 1 \\pmod{p}\\quad \\Longleftrightarrow\\quad \\operatorname{ord}_{p}(2)\\mid m.$$\n\n计算这些素因子的阶：\n- 模 $31$：因为 $2^{5}=32\\equiv 1 \\pmod{31}$ 且 $2\\not\\equiv 1 \\pmod{31}$，所以我们有 $\\operatorname{ord}_{31}(2)=5$。\n- 模 $43$：计算 $2^{5}=32$，$2^{6}=64\\equiv 21 \\pmod{43}$，因此 $2^{7}\\equiv 2\\cdot 21=42\\equiv -1 \\pmod{43}$，所以 $2^{14}\\equiv 1 \\pmod{43}$ 且 $\\operatorname{ord}_{43}(2)=14$（因为 $2^{1}\\not\\equiv 1$ 且 $2^{7}\\not\\equiv 1$）。\n\n因此，\n- $31\\mid 2^{k!}-1$ 当且仅当 $5\\mid k!$，\n- $43\\mid 2^{k!}-1$ 当且仅当 $14\\mid k!$。\n\n检查 $k=1,2,3,4$：\n$$1!=1,\\quad 2!=2,\\quad 3!=6,\\quad 4!=24,$$\n它们都不能被 $5$ 或 $14$ 整除，所以对于 $k\\in\\{1,2,3,4\\}$，$g_{k}=1$。\n\n对于 $k=5$，我们有 $5!=120$。那么 $5\\mid 120$ 但是 $14\\nmid 120$。因此 $31\\mid 2^{120}-1$ 而 $43\\nmid 2^{120}-1$，所以\n$$g_{5}=\\gcd(2^{120}-1,1333)=31,$$\n这是一个非平凡因子，并且是第一次成功。\n\n因此，最小的成功 $k$ 值为 $5$，找到的因子为 $31$。", "answer": "$$\\boxed{(5, 31)}$$", "id": "1349546"}]}