{"hands_on_practices": [{"introduction": "掌握Ford-Fulkerson方法的第一步是理解其核心操作：增广。这个练习将带你亲手执行单次迭代，你需要在一个给定的流网络中，根据当前的流量构建残留网络，然后找到一条增广路径并用它来增加总流量。通过这个基础实践([@problem_id:1387823])，你将熟悉算法的基本构件。", "problem": "一家物流公司管理着一个由有向图表示的分销网络。节点包括一个源仓库 (S)、一个目的地城市 (T) 和四个中间转运中心 (U, V, W, X)。这些节点之间的有向链接代表单向道路，每条道路都有一个以每小时货物单位计量的最大容量。\n\n网络的结构和容量（对于从节点 $i$ 到节点 $j$ 的链接，容量用 $c(i, j)$ 表示）如下：\n- $c(S, U) = 10$\n- $c(S, V) = 8$\n- $c(U, V) = 4$\n- $c(U, W) = 7$\n- $c(V, W) = 3$\n- $c(V, X) = 6$\n- $c(W, T) = 9$\n- $c(X, T) = 5$\n任何未列出的链接的容量均为零。\n\n一项交通分析揭示了某些链接上的当前流量 $f(i, j)$：\n- $f(S, U) = 6$\n- $f(U, W) = 6$\n- $f(W, T) = 6$\n- $f(S, V) = 4$\n- $f(V, X) = 4$\n- $f(X, T) = 4$\n所有其他链接上的流量均为零。当前从源点 S 到汇点 T 的总流量为每小时10个货物单位。\n\n为了增加吞吐量，你必须执行一次 Ford-Fulkerson 算法的迭代。你的任务是在残差图中找到一条从 S 到 T 的增广路径。为确保路径唯一，你必须使用广度优先搜索 (BFS)，并按字母顺序探索任何给定节点的邻居。基于这条特定的增广路径，从 S 到 T 的新总流量值是多少？\n\n以单个整数形式表示你的答案，代表以每小时货物单位计量的总流量。", "solution": "我们为当前流量构建残差图。对于每条容量为 $c(i,j)$ 且当前流量为 $f(i,j)$ 的有向链接，正向残差容量为 $r(i,j)=c(i,j)-f(i,j)$，反向残差容量为 $r(j,i)=f(i,j)$。使用给定的数据：\n- 在 $S \\to U$ 上：$r(S,U)=10-6=4$ 且 $r(U,S)=6$。\n- 在 $S \\to V$ 上：$r(S,V)=8-4=4$ 且 $r(V,S)=4$。\n- 在 $U \\to V$ 上：$r(U,V)=4-0=4$ 且 $r(V,U)=0$。\n- 在 $U \\to W$ 上：$r(U,W)=7-6=1$ 且 $r(W,U)=6$。\n- 在 $V \\to W$ 上：$r(V,W)=3-0=3$ 且 $r(W,V)=0$。\n- 在 $V \\to X$ 上：$r(V,X)=6-4=2$ 且 $r(X,V)=4$。\n- 在 $W \\to T$ 上：$r(W,T)=9-6=3$ 且 $r(T,W)=6$。\n- 在 $X \\to T$ 上：$r(X,T)=5-4=1$ 且 $r(T,X)=4$。\n\n我们在残差图中从 S 开始运行一次广度优先搜索 (BFS)，按字母顺序探索每个节点的邻居。从 S 开始，其残差为正的邻居是 U 和 V，按 U 然后 V 的顺序入队。接下来处理 U，并按字母顺序探索其邻居，我们通过 $U \\to W$ 遇到 W，因为 $r(U,W)=1>0$，所以我们将 W 入队。接下来处理 V，我们通过 $V \\to X$ 将 X 入队，因为 $r(V,X)=2>0$。接下来处理 W，我们通过 $W \\to T$ 发现 T，因为 $r(W,T)=3>0$。因此，BFS 找到的增广路径是 $S \\to U \\to W \\to T$。\n\n这条路径上的瓶颈残差容量是其路径上各边残差容量的最小值：\n$$\\Delta=\\min\\{r(S,U),\\,r(U,W),\\,r(W,T)\\}=\\min\\{4,\\,1,\\,3\\}=1.$$\n通过增加 $\\Delta$ 的流量，总流量增加了 1，因此新的总流量值为\n$$|f'|=|f|+\\Delta=10+1=11.$$", "answer": "$$\\boxed{11}$$", "id": "1387823"}, {"introduction": "在掌握了单步增广后，下一步是将这个过程迭代直至找到最大流。这个练习要求你完整地运行Ford-Fulkerson算法，直到网络中再也找不到任何增广路径。此外，这个问题还引导你找到一个最小割，从而亲手验证网络流理论中的基石——最大流最小割定理([@problem_id:1408993])。", "problem": "考虑一个由有向图表示的小型数据传输网络。该网络有一个源节点 `S`，一个汇点 `T`，以及四个中间路由节点 `A`、`B`、`C` 和 `D`。有向链接及其对应的最大数据承载容量（以任意流量单位计）如下所示：\n- 从 `S` 到 `A`，容量为 10。\n- 从 `S` 到 `C`，容量为 12。\n- 从 `A` 到 `B`，容量为 7。\n- 从 `A` 到 `D`，容量为 4。\n- 从 `B` 到 `T`，容量为 10。\n- 从 `C` 到 `D`，容量为 9。\n- 从 `D` 到 `B`，容量为 3。\n- 从 `D` 到 `T`，容量为 8。\n\n所有链接均为指定的单向链接。网络中没有其他链接。目标是确定该网络的吞吐量。\n\n计算从源点 `S`到汇点 `T` 的最大流量值，并计算最小 `S-T` 割的容量。按指定顺序提供这两个整数值：首先是最大流量值，然后是最小割容量。", "solution": "设 $G=(V,E)$ 是一个有向图，其中 $S$ 是源点， $T$ 是汇点，$A,B,C,D$ 是中间节点。对于每条有向边 $(u,v)\\in E$，设其容量为 $c_{uv}$，流量为 $f_{uv}$，满足 $0\\leq f_{uv}\\leq c_{uv}$。中间节点满足流量守恒：对于每个 $v\\in\\{A,B,C,D\\}$，\n$$\n\\sum_{u:(u,v)\\in E} f_{uv}=\\sum_{w:(v,w)\\in E} f_{vw}.\n$$\n容量如下：\n$$\nc_{S,A}=10,\\quad c_{S,C}=12,\\quad c_{A,B}=7,\\quad c_{A,D}=4,\\quad c_{B,T}=10,\\quad c_{C,D}=9,\\quad c_{D,B}=3,\\quad c_{D,T}=8.\n$$\n\n应用 Ford–Fulkerson 方法，使用增广路径和残余容量进行计算。\n\n1) 沿路径 $S\\to A\\to B\\to T$ 进行增广。瓶颈是\n$$\n\\min\\{c_{S,A},c_{A,B},c_{B,T}\\}=\\min\\{10,7,10\\}=7.\n$$\n发送 $7$ 个单位的流量：设置 $f_{S,A}=7$，$f_{A,B}=7$，$f_{B,T}=7$。\n\n2) 沿路径 $S\\to C\\to D\\to T$ 进行增广。瓶颈是\n$$\n\\min\\{c_{S,C},c_{C,D},c_{D,T}\\}=\\min\\{12,9,8\\}=8.\n$$\n发送 $8$ 个单位的流量：设置 $f_{S,C}=8$，$f_{C,D}=8$，$f_{D,T}=8$。\n\n3) 在残余网络中考虑路径 $S\\to A\\to D\\to B\\to T$。这些弧上的当前正向残余容量是\n$$\nr_{S,A}=c_{S,A}-f_{S,A}=10-7=3,\\quad r_{A,D}=c_{A,D}-f_{A,D}=4-0=4,\n$$\n$$\nr_{D,B}=c_{D,B}-f_{D,B}=3-0=3,\\quad r_{B,T}=c_{B,T}-f_{B,T}=10-7=3.\n$$\n瓶颈是 $\\min\\{3,4,3,3\\}=3$。沿此路径增广 $3$ 个单位的流量：更新\n$$\nf_{S,A}=7+3=10,\\quad f_{A,D}=0+3=3,\\quad f_{D,B}=0+3=3,\\quad f_{B,T}=7+3=10.\n$$\n\n计算这些增广后的总流量值。在汇点处，\n$$\n|f|=f_{B,T}+f_{D,T}=10+8=18.\n$$\n或者，在源点处，\n$$\n|f|=f_{S,A}+f_{S,C}=10+8=18.\n$$\n\n验证不存在更多的增广路径。在残余图中，到 $T$ 的正向残余容量为 $r_{B,T}=10-10=0$ 和 $r_{D,T}=8-8=0$。从 $S$ 出发，通过残余边可达的节点有 $S\\to C$（残余容量 $r_{S,C}=12-8=4$），然后 $C\\to D$（残余容量 $r_{C,D}=9-8=1$），以及通过 $A\\to D$ 的反向边从 $D\\to A$（残余容量 $f_{A,D}=3$），因此 $A$ 是可达的。节点 $B$ 是不可达的，因为 $r_{A,B}=7-7=0$ 且 $r_{D,B}=3-3=0$；节点 $T$ 也是不可达的，因为 $r_{B,T}=0$ 且 $r_{D,T}=0$。因此，可达集为 $R=\\{S,A,C,D\\}$。\n\n割 $(R,\\overline{R})$ 的容量是从 $R$ 到 $\\overline{R}=\\{B,T\\}$ 的边的容量之和：\n$$\nc(R,\\overline{R})=c_{A,B}+c_{D,B}+c_{D,T}=7+3+8=18.\n$$\n根据最大流最小割定理，最大流量等于最小割容量，这与我们构造的流量值相符。因此，最大 $S$–$T$ 流量为 $18$，最小割容量为 $18$。", "answer": "$$\\boxed{\\begin{pmatrix} 18  18 \\end{pmatrix}}$$", "id": "1408993"}, {"introduction": "Ford-Fulkerson算法的正确性是毋庸置疑的，但它的效率又如何呢？这个练习通过一个精心设计的场景([@problem_id:1541549])，揭示了增广路径的选择对算法性能的巨大影响。你将被要求遵循一个特定的“坏”策略来选择路径，从而体验算法在最坏情况下的迭代次数，深刻理解为何像Edmonds-Karp这样更优的路径选择策略至关重要。", "problem": "考虑一个流网络，其顶点集为 $V = \\{s, a, b, t\\}$，其中 $s$ 是源点，$t$ 是汇点。该网络有一组带有关联整数容量的有向边。从顶点 $u$ 到顶点 $v$ 的边的容量记为 $c(u, v)$。这些边及其容量定义如下：\n- $c(s, a) = C$\n- $c(s, b) = C$\n- $c(a, t) = C$\n- $c(b, t) = C$\n- $c(a, b) = 1$\n所有未列出的其他边的容量为 0。对于本问题，设常数 $C = 500$。\n\n你需要使用 Ford-Fulkerson 算法找出从 $s$ 到 $t$ 的最大流。但是，在每次迭代中选择增广路径时，你必须遵循一个特定的规则：如果当前残留图中存在多条增广路径，你必须总是选择瓶颈容量最小的路径。如果最小瓶颈容量存在并列，你可以选择其中任意一条路径。\n\n计算在该特定路径选择策略下，Ford-Fulkerson 算法为找到最大流将执行的总增广次数（即迭代次数）。", "solution": "设 $G=(V,E)$ 是一个有向网络，其源点为 $s$，汇点为 $t$，容量为给定的 $c(u,v)$，初始流为 $f\\equiv 0$。设 $c_{f}(u,v)$ 表示在流 $f$ 下的残留容量。对于当前残留图中的任何 $s$–$t$ 路径 $P$，其瓶颈为 $\\beta(P)=\\min_{(u,v)\\in P}c_{f}(u,v)$。Ford–Fulkerson 算法沿着路径 $P$ 增广 $\\delta=\\beta(P)$，并通过以下方式更新残留量：\n$$\nc_{f}^{\\text{new}}(u,v)=c_{f}(u,v)-\\delta\\quad\\text{对于 }P\\text{ 上的正向边},\\quad\nc_{f}^{\\text{new}}(v,u)=c_{f}(v,u)+\\delta\\quad\\text{对于其反向边},\n$$\n并且流值增加 $\\delta$。\n\n最初，残留边为 $s\\to a$、$s\\to b$、$a\\to t$、$b\\to t$（容量为 $C$）以及 $a\\to b$（容量为 $1$）。可用的 $s$–$t$ 残留路径包括：\n- $P_{1}: s\\to a\\to b\\to t$，其瓶颈 $\\beta(P_{1})=\\min\\{C,1,C\\}=1$，\n- $P_{2}: s\\to a\\to t$，其瓶颈 $\\beta(P_{2})=C$，\n- $P_{3}: s\\to b\\to t$，其瓶颈 $\\beta(P_{3})=C$。\n根据规则，算法必须选择瓶颈最小的路径，因此它选择 $P_{1}$ 并增广 $\\delta=1$。\n\n沿着 $P_{1}$ 增广后，残留容量变为\n$$\nc_{f}(s,a)=C-1,\\quad c_{f}(a,s)=1,\\quad c_{f}(a,b)=0,\\quad c_{f}(b,a)=1,\\quad c_{f}(b,t)=C-1,\\quad c_{f}(t,b)=1,\n$$\n其中 $c_{f}(s,b)=C$ 和 $c_{f}(a,t)=C$ 保持不变。现在，瓶颈最小的 $s$–$t$ 路径是\n$$\nP_{4}: s\\to b\\to a\\to t\\quad\\text{其瓶颈为}\\quad\\beta(P_{4})=\\min\\{C,1,C\\}=1,\n$$\n因此算法再次沿着 $P_{4}$ 增广 $\\delta=1$。\n\n归纳不变量。经过 $2m$ 次增广（对于某个整数 $m\\geq 0$）后，残留容量满足\n$$\nc_{f}(s,a)=c_{f}(s,b)=c_{f}(a,t)=c_{f}(b,t)=C-m,\\quad c_{f}(a,b)=1,\\quad c_{f}(b,a)=0,\n$$\n并且所有其他残留边都是相应的反向边，其容量由流量守恒确定。这在 $m=0$ 时初始成立。假定它对 $m$ 成立，下一次增广必须选择 $P_{1}: s\\to a\\to b\\to t$，其瓶颈为\n$$\n\\beta(P_{1})=\\min\\{c_{f}(s,a),c_{f}(a,b),c_{f}(b,t)\\}=\\min\\{C-m,1,C-m\\}=1,\n$$\n前提是 $C-m>0$。增广 $1$ 之后，经过 $2m+1$ 次增广，得到\n$$\nc_{f}(s,a)=C-m-1,\\quad c_{f}(b,t)=C-m-1,\\quad c_{f}(s,b)=C-m,\\quad c_{f}(a,t)=C-m,\\quad c_{f}(a,b)=0,\\quad c_{f}(b,a)=1.\n$$\n然后，最小瓶颈路径是 $P_{4}: s\\to b\\to a\\to t$，其瓶颈为\n$$\n\\beta(P_{4})=\\min\\{c_{f}(s,b),c_{f}(b,a),c_{f}(a,t)\\}=\\min\\{C-m,1,C-m\\}=1,\n$$\n再次假设 $C-m>0$。沿着 $P_{4}$ 增广 $1$ 会恢复偶数索引的形式，其中 $m$ 被替换为 $m+1$，从而证明了该不变量。\n\n终止与计数。只要 $C-m>0$，$P_{1}$ 和 $P_{4}$ 之间的交替就会继续。在阶段 $m$ 可以进行两次增广的最大 $m$ 是 $m=C-1$。执行完这两次增广后，我们达到 $m=C$，此时\n$$\nc_{f}(s,a)=c_{f}(s,b)=c_{f}(a,t)=c_{f}(b,t)=0,\n$$\n因此不存在从 $s$ 到 $t$ 的残留路径，算法终止。因此，执行的总增广次数为\n$$\n2C.\n$$\n根据最大流最小割定理，最大流值为 $\\min\\{c(s,a)+c(s,b),\\,c(a,t)+c(b,t)\\}=2C$，并且由于每次增广恰好增加 $1$ 单位的流量（所选的瓶颈），因此恰好需要 $2C$ 次增广，这也是充分的。\n\n代入 $C=500$，总共得到 $2\\cdot 500=1000$ 次增广。", "answer": "$$\\boxed{1000}$$", "id": "1541549"}]}