{"hands_on_practices": [{"introduction": "理解自由变量和约束变量的区别，始于对逻辑公式结构的仔细剖析。第一个练习 [@problem_id:1353831] 要求你解析一个逻辑表达式，判断其中每个变量出现的具体状态。你需要特别注意量词的作用域是如何跨越不同逻辑联结词的，掌握这项技能是正确解读和操作逻辑表达式的基石。", "problem": "考虑以下一阶逻辑中的合式公式，其中 $P$、$Q$ 和 $R$ 是谓词：\n$$\n(\\forall x \\, P(x, y)) \\rightarrow (\\exists y \\, (Q(y, z) \\land R(x)))\n$$\n如果一个变量的*出现*位于量化它的量词（$\\forall$ 或 $\\exists$）的作用域内，则称该出现是**约束的**。如果一个变量的*出现*不是约束的，则称它是**自由的**。\n\n下列哪个陈述正确描述了给定逻辑公式中变量的状态？\n\nA. 变量 $x$ 的所有出现都是约束的，而 $y$ 的所有出现都是自由的。\n\nB. 变量 $y$ 的所有出现都是约束的，而 $z$ 的唯一出现是自由的。\n\nC. 变量 $x$ 和 $y$ 既有自由的出现也有约束的出现，而 $z$ 只有自由的出现。\n\nD. $x$ 和 $y$ 的所有出现都是约束的，$z$ 的唯一出现是自由的。\n\nE. 整个公式的自由变量集合是 $\\{z\\}$。", "solution": "设该公式为\n$$\n(\\forall x\\, P(x,y)) \\rightarrow (\\exists y\\, (Q(y,z) \\land R(x))).\n$$\n根据定义，如果一个变量的出现位于量化该变量的量词的作用域内，则该出现是约束的；否则它是自由的。\n\n将公式分解为前件和后件：\n- 前件：$A \\equiv \\forall x\\, P(x,y)$，其中 $\\forall x$ 的作用域恰好是 $P(x,y)$。\n- 后件：$B \\equiv \\exists y\\, (Q(y,z) \\land R(x))$，其中 $\\exists y$ 的作用域恰好是 $(Q(y,z) \\land R(x))$。\n\n分析每个变量的出现：\n- 变量 $x$：\n  - 在 $A$ 中：$P(x,y)$ 中 $x$ 的出现位于 $\\forall x$ 的作用域内，因此是约束的。\n  - 在 $B$ 中：$R(x)$ 中 $x$ 的出现不在 $\\forall x$ 的作用域内（其作用域不跨越蕴含符号），且 $B$ 中没有其他关于 $x$ 的量词，因此是自由的。\n  因此，$x$ 既有约束的出现（在 $A$ 中），也有自由的出现（在 $B$ 中）。\n\n- 变量 $y$：\n  - 在 $A$ 中：$P(x,y)$ 中 $y$ 的出现不在任何关于 $y$ 的量词的作用域内，因此是自由的。\n  - 在 $B$ 中：$Q(y,z)$ 中 $y$ 的出现位于 $\\exists y$ 的作用域内，因此是约束的。\n  因此，$y$ 既有自由的出现（在 $A$ 中），也有约束的出现（在 $B$ 中）。\n\n- 变量 $z$：\n  - 在 $B$ 中：$Q(y,z)$ 中 $z$ 的出现不在任何关于 $z$ 的量词的作用域内（因为没有），因此是自由的。\n  因此，$z$ 只有一个自由的出现。\n\n因此：\n- $x$ 和 $y$ 都既有自由的出现也有约束的出现。\n- $z$ 的唯一出现是自由的。\n\n因此，正确选项是 C。（注意：整个公式的自由变量集合是 $\\{x,y,z\\}$，所以选项 E 是错误的。）", "answer": "$$\\boxed{C}$$", "id": "1353831"}, {"introduction": "除了识别单个变量的出现状态，确定整个公式的自由变量集合也至关重要，因为它定义了评估公式真值所需的外部信息。这个练习 [@problem_id:1353789] 要求你为一个更复杂的公式找出其自由变量的完整集合，这会让你更加熟悉运算符的优先级规则以及变量作用域的相互作用。这个过程类似于在编程中确定一个函数所需要的输入参数。", "problem": "在软件工程领域，形式化方法使用谓词逻辑来规约和验证系统属性。逻辑公式可以描述所需的状态或行为，其变量对应于系统参数或状态变量。如果一个变量位于某个指向它的量词（例如全称量词 $\\forall$，“对于所有”，或存在量词 $\\exists$，“存在”）的作用域内，则该变量被认为是“约束”的。如果一个变量不是约束的，则它是“自由”的。自由变量代表外部参数，必须为这些参数定义具体值，公式才能有确定的真/假值。\n\n考虑以下逻辑公式，该公式旨在规约一个具有谓词 $P$、$Q$、$R$ 和 $S$ 的系统的复杂属性：\n$$\n(\\forall x (P(x) \\rightarrow Q(y))) \\land (\\exists y R(y)) \\rightarrow S(y, z)\n$$\n假设按标准运算符优先级，其中 $\\rightarrow$ 是主联结词，请确定此公式中自由变量的完整集合。\n\nA. $\\{z\\}$\n\nB. $\\{y, z\\}$\n\nC. $\\{x, y, z\\}$\n\nD. $\\emptyset$ (空集)\n\nE. $\\{y\\}$", "solution": "我们首先确定主联结词。根据给定的优先级，该公式的结构为\n$$\n\\bigl[(\\forall x\\,(P(x)\\rightarrow Q(y))) \\land (\\exists y\\,R(y))\\bigr] \\rightarrow S(y,z).\n$$\n令前件为\n$$\nA \\equiv (\\forall x\\,(P(x)\\rightarrow Q(y))) \\land (\\exists y\\,R(y)).\n$$\n我们确定每个部分的自由变量。\n\n1) 在 $\\forall x\\,(P(x)\\rightarrow Q(y))$ 中，量词 $\\forall x$ 约束了 $(P(x)\\rightarrow Q(y))$ 中所有出现的 $x$。在 $Q(y)$ 中出现的 $y$ 不在该子公式中任何 $y$-量词的作用域内，因此这里的 $y$ 是自由的。\n\n2) 在 $\\exists y\\,R(y)$ 中，量词 $\\exists y$ 约束了 $R(y)$ 中所有出现的 $y$。这里没有任何变量是自由出现的。\n\n3) 对于合取式 $A = \\phi \\land \\psi$，合取运算不约束变量，$A$ 的自由变量集合是其合取项自由变量的并集。根据(1)和(2)，$A$ 有一个自由变量 $y$，没有其他自由变量。因此 $A$ 的自由变量是 $\\{y\\}$。\n\n4) 在后件 $S(y,z)$ 中，没有量词；因此 $y$ 和 $z$ 在这个子公式中都是自由出现的。\n\n5) 对于蕴涵式 $A \\rightarrow S(y,z)$，蕴涵运算不约束变量，所以整个公式的自由变量是 $A$ 的自由变量和 $S(y,z)$ 的自由变量的并集，即 $\\{y\\} \\cup \\{y,z\\} = \\{y,z\\}$。\n\n因此，自由变量的完整集合是 $\\{y,z\\}$，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1353789"}, {"introduction": "在形式逻辑和程序语言理论中，一个最佳实践是避免让同一个变量在同一公式中既作为自由变量又作为约束变量出现，因为这可能导致混淆和错误。最后的这个练习 [@problem_id:1353838] 将从分析转向综合，要求你重写一个公式以消除这种歧义。这个过程会让你接触到一种被称为“换名”或“α-变换”的强大技巧，即通过重命名约束变量来在保持逻辑等价的同时提高公式的清晰度。", "problem": "在一阶逻辑的研究中，一个变量在公式中的出现被分为*约束的*或*自由的*。如果一次出现位于命名该变量的量词（例如 $\\forall$ 或 $\\exists$）的辖域内，那么它就是约束的。如果一次出现不是约束的，那么它就是自由的。例如，在公式 $\\forall x P(x, y)$ 中，$x$ 的出现是约束的，而 $y$ 的出现是自由的。\n\n在形式逻辑中，一种好的做法是，所写的公式中任何给定的变量要么总是约束的，要么总是自由的，但绝不同时兼具两种身份。这可以避免在逻辑代换过程中的歧义和潜在错误。\n\n考虑以下合式公式：\n$$(\\forall x \\, \\exists y \\, P(x, y)) \\land Q(y)$$\n在这个公式中，子公式 $P(x, y)$ 中的变量 $y$ 被存在量词 $\\exists y$ 所约束。然而，子公式 $Q(y)$ 中的变量 $y$ 是自由的，因为它在量词的辖域之外。\n\n你的任务是从下面的选项中选择一个与给定公式逻辑等价的公式，但它经过重写，解决了变量 $y$ 的这种双重角色问题。\n\nA. $(\\forall x \\, \\exists z \\, P(x, z)) \\land Q(y)$\n\nB. $\\forall x \\, \\exists y \\, (P(x, y) \\land Q(y))$\n\nC. $(\\forall x \\, \\exists y \\, P(x, y)) \\land Q(z)$\n\nD. $\\forall x \\, ((\\exists y \\, P(x, y)) \\land Q(y))$\n\nE. $(\\forall x \\, \\exists y \\, P(x, y)) \\land (\\exists y \\, Q(y))$", "solution": "我们从给定的合式公式开始：\n$$(\\forall x \\, \\exists y \\, P(x,y)) \\land Q(y).$$\n在此公式中，$P(x,y)$ 内部的 $y$ 的出现被量词 $\\exists y$ 约束，而 $Q(y)$ 内部的 $y$ 的出现是自由的。任务是找到一个逻辑等价的公式，以避免 $y$ 的这种双重角色。\n\n一个标准的逻辑法则是约束变量的α-转换：如果 $z$ 的出现方式不会导致变量捕获，那么用一个新变量替换一个约束变量将使公式保持逻辑等价。形式上，对于任何公式 $\\varphi(y)$，其中 $z$ 不会作为一个自由变量出现在一个会被捕获的位置上，我们有：\n$$\\exists y \\, \\varphi(y) \\equiv \\exists z \\, \\varphi(z), \\quad \\forall x \\, \\psi(x) \\equiv \\forall u \\, \\psi(u).$$\n将此法则应用于子公式 $\\forall x \\, \\exists y \\, P(x,y)$，我们可以将约束变量 $y$ 重命名为一个新变量 $z$ 而不改变其逻辑内容：\n$$\\forall x \\, \\exists y \\, P(x,y) \\equiv \\forall x \\, \\exists z \\, P(x,z).$$\n因此，\n$$(\\forall x \\, \\exists y \\, P(x,y)) \\land Q(y) \\equiv (\\forall x \\, \\exists z \\, P(x,z)) \\land Q(y).$$\n这就解决了 $y$ 的双重角色问题，因为现在 $y$ 只是自由的（在 $Q(y)$ 中），而 $z$ 只是约束的（在 $P(x,z)$ 中）。这对应于选项 A。\n\n现在我们验证其他选项不是既逻辑等价又解决了角色问题：\n- 选项 B：$\\forall x \\, \\exists y \\, (P(x,y) \\land Q(y))$ 与原公式不等价，因为它将 $Q(y)$ 置于存在量词之下，改变了其依赖关系：原始的合取项 $Q(y)$ 是对赋值中 $y$ 的值的一个自由条件，而在 B 中，对于每个 $x$ 所选择的 $y$ 的存在见证，都要求 $Q(y)$ 为真。\n- 选项 C：$(\\forall x \\, \\exists y \\, P(x,y)) \\land Q(z)$ 将自由变量 $y$ 替换为 $z$。开放公式的逻辑等价性是相对于相同的赋值来评估的；左边依赖于赋值中 $y$ 的值，而右边依赖于 $z$ 的值，因此通常情况下这不等价。\n- 选项 D：$\\forall x \\, ((\\exists y \\, P(x,y)) \\land Q(y))$ 与原公式等价，因为 $x$ 在 $Q(y)$ 中不是自由的，并且当 $x$ 在 $B$ 中不是自由时，我们有等价关系 $\\forall x \\, (A(x) \\land B) \\equiv (\\forall x \\, A(x)) \\land B$。然而，它没有解决双重角色问题，因为 $y$ 在 $P$ 中仍然是约束的，在 $Q$ 中仍然是自由的。\n- 选项 E：$(\\forall x \\, \\exists y \\, P(x,y)) \\land (\\exists y \\, Q(y))$ 在第二个合取项中约束了 $y$，将整体的真值条件从依赖于一个自由的 $y$ 改变为断言存在某个满足 $Q$ 的 $y$，因此它与原公式不等价。\n\n因此，唯一既与给定公式逻辑等价又解决了 $y$ 的双重角色问题的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1353838"}]}