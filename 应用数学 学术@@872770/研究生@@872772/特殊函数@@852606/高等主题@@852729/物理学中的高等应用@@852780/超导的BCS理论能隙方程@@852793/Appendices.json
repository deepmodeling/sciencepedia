{"hands_on_practices": [{"introduction": "标准的BCS理论通常假设费米能级附近的电子态密度（DOS）为常数，这是一个有效的简化。本练习旨在探讨态密度的能量依赖性如何影响超导能隙，这在许多真实材料中是一个更贴近现实的特征。通过求解具有二次方能量依赖的态密度模型的能隙方程，您将更深入地理解材料电子结构与其超导特性之间的相互作用 [@problem_id:40039]。", "problem": "在巴丁-库珀-施里弗（BCS）超导理论中，零温（$T=0$）下的能隙 $\\Delta$ 由以下积分方程确定：\n$$\n1 = \\frac{V}{2} \\int_{-\\hbar\\omega_D}^{\\hbar\\omega_D} \\frac{N(E_F+\\xi)}{\\sqrt{\\xi^2 + \\Delta^2}} d\\xi\n$$\n此处，$V$ 是电子间的有效吸引相互作用势，$\\xi$ 是相对于费米能 $E_F$ 的电子能量，$\\hbar\\omega_D$ 是德拜能量，它作为电子-声子相互作用的截断。函数 $N(E_F+\\xi)$ 是能量为 $E_F+\\xi$ 处包含两种自旋方向的电子态密度。\n\n在最简单的模型中，$N(E_F+\\xi)$ 被假定为常数，等于其在费米能级的值 $N_0$。考虑一种假设的金属，其费米能级附近的态密度不是常数，而是具有二次方的能量依赖关系。具体来说，在相互作用窗口 $|\\xi| \\le \\hbar\\omega_D$ 内的能量范围内，态密度由下式给出：\n$$\nN(E_F+\\xi) = N_0(1 + \\gamma\\xi^2)\n$$\n其中 $N_0$ 是费米能级（$E_F$）处的态密度，$\\gamma$ 是一个表征态密度（DOS）曲率的常数。为了使态密度具有物理意义（即为正值），参数必须满足 $1 + \\gamma(\\hbar\\omega_D)^2 > 0$。\n\n假设在弱耦合极限下，能隙 $\\Delta$ 远小于德拜能量（$\\Delta \\ll \\hbar\\omega_D$），求出超导能隙 $\\Delta$ 的近似解析表达式。请用 $N_0$、$V$、$\\hbar\\omega_D$ 和 $\\gamma$ 来表示你的答案。", "solution": "零温 $T=0$ 时能隙 $\\Delta$ 的积分方程为：\n$$\n1 = \\frac{V}{2} \\int_{-\\hbar\\omega_D}^{\\hbar\\omega_D} \\frac{N(E_F+\\xi)}{\\sqrt{\\xi^2 + \\Delta^2}} d\\xi\n$$\n代入 $N(E_F+\\xi) = N_0(1 + \\gamma\\xi^2)$ 并利用被积函数的偶对称性（$\\xi \\to -\\xi$）：\n$$\n\\frac{1}{V N_0} = \\int_0^{\\hbar\\omega_D} \\frac{1 + \\gamma\\xi^2}{\\sqrt{\\xi^2 + \\Delta^2}} d\\xi\n$$\n将积分分成两部分：\n$$\n\\frac{1}{V N_0} = \\int_0^{\\hbar\\omega_D} \\frac{1}{\\sqrt{\\xi^2 + \\Delta^2}} d\\xi + \\gamma \\int_0^{\\hbar\\omega_D} \\frac{\\xi^2}{\\sqrt{\\xi^2 + \\Delta^2}} d\\xi\n$$\n对于第一个积分，其精确解为 $\\text{arcsinh}(\\hbar\\omega_D/\\Delta)$。在弱耦合极限 $\\Delta \\ll \\hbar\\omega_D$ 下，我们有近似：\n$$\n\\int_0^{\\hbar\\omega_D} \\frac{1}{\\sqrt{\\xi^2 + \\Delta^2}} d\\xi \\approx \\ln\\left(\\frac{2\\hbar\\omega_D}{\\Delta}\\right)\n$$\n对于第二个积分，在弱耦合极限下，被积函数在大部分积分区间内 ($\\xi \\gg \\Delta$) 近似于 $\\xi^2/\\xi = \\xi$。因此，我们可以近似计算该积分：\n$$\n\\int_0^{\\hbar\\omega_D} \\frac{\\xi^2}{\\sqrt{\\xi^2 + \\Delta^2}} d\\xi \\approx \\int_0^{\\hbar\\omega_D} \\xi \\, d\\xi = \\frac{(\\hbar\\omega_D)^2}{2}\n$$\n将两个近似结果代入方程：\n$$\n\\frac{1}{V N_0} \\approx \\ln\\left(\\frac{2\\hbar\\omega_D}{\\Delta}\\right) + \\frac{\\gamma (\\hbar\\omega_D)^2}{2}\n$$\n求解 $\\ln(2\\hbar\\omega_D / \\Delta)$：\n$$\n\\ln\\left(\\frac{2\\hbar\\omega_D}{\\Delta}\\right) = \\frac{1}{V N_0} - \\frac{\\gamma (\\hbar\\omega_D)^2}{2}\n$$\n对两边取指数：\n$$\n\\frac{2\\hbar\\omega_D}{\\Delta} = \\exp\\left( \\frac{1}{V N_0} - \\frac{\\gamma (\\hbar\\omega_D)^2}{2} \\right)\n$$\n重新整理以分离出 $\\Delta$：\n$$\n\\Delta = 2\\hbar\\omega_D \\exp\\left( - \\left( \\frac{1}{V N_0} - \\frac{\\gamma (\\hbar\\omega_D)^2}{2} \\right) \\right) = 2\\hbar\\omega_D \\exp\\left( \\frac{\\gamma (\\hbar\\omega_D)^2}{2} - \\frac{1}{V N_0} \\right)\n$$", "answer": "$$\\boxed{2\\hbar\\omega_D \\exp\\left( \\frac{\\gamma (\\hbar\\omega_D)^2}{2} - \\frac{1}{V N_0} \\right)}$$", "id": "40039"}, {"introduction": "除了电子结构，配对相互作用本身的性质也至关重要，教科书中简化的“方势阱”模型虽具启发性，但较为粗糙。本练习引入一个更符合物理实际的、能量依赖的洛伦兹型相互作用核，以反映配对相互作用的玻色子媒介起源。通过求解该模型的能隙方程，您将加深对配对相互作用动力学如何决定超导能隙大小的理解 [@problem_id:632124]。", "problem": "在巴丁-库珀-施里弗 (Bardeen-Cooper-Schrieffer, BCS) 超导理论中，对于一个简单的 s-波超导体，在零温（$T=0$）下的能隙 $\\Delta$ 由以下积分方程确定：\n$$ 1 = \\frac{1}{2} \\int_{-\\infty}^{\\infty} d\\xi' \\frac{g(\\xi')}{\\sqrt{\\xi'^2 + \\Delta^2}} $$\n此处，$\\xi'$ 是相对于费米能测量的单粒子能量，$g(\\xi') = N(0)V(\\xi')$ 是无量纲的有效配对相互作用，其中 $N(0)$ 是费米能级处的（常数）电子态密度，$V(\\xi')$ 是依赖于能量的配对势。\n\n在标准教科书模型中，假定 $g(\\xi')$ 在费米能级周围的一个有限能量壳层 $(-\\hbar\\omega_D, \\hbar\\omega_D)$ 内为常数 $g$，而在其他地方为零。考虑一个更现实的模型，其中由玻色子（例如声子）介导的相互作用具有更缓和的能量依赖性。具体来说，假设相互作用由一个以零能量转移为中心的洛伦兹函数描述：\n$$ g(\\xi') = g_0 \\frac{(\\hbar\\omega_0)^2}{\\xi'^2 + (\\hbar\\omega_0)^2} $$\n其中 $g_0$ 是零能量转移时的无量纲耦合常数，$\\hbar\\omega_0$ 代表介导玻色子的特征能标。\n\n您的任务是求解此洛伦兹相互作用模型的能隙方程。在由 $g_0 \\ll 1$ 定义的弱耦合极限下，确定超导能隙 $\\Delta$ 作为 $g_0$、$\\hbar$ 和 $\\omega_0$ 的函数的主导阶表达式。", "solution": "1.  将洛伦兹型相互作用代入能隙方程，并利用被积函数的偶性，得到：\n$$ 1 = g_0 (\\hbar\\omega_0)^2 \\int_{0}^{\\infty} \\frac{d\\xi'}{(\\xi'^2 + (\\hbar\\omega_0)^2)\\sqrt{\\xi'^2 + \\Delta^2}} $$\n2.  这个积分有一个已知的解析形式。令 $J = \\int_{0}^{\\infty} \\frac{d\\xi'}{(\\xi'^2 + a^2)\\sqrt{\\xi'^2 + b^2}}$，其中 $a=\\hbar\\omega_0, b=\\Delta$。当 $a > b$ 时，其解为 $J = \\frac{1}{a\\sqrt{a^2-b^2}} \\text{arccosh}(\\frac{a}{b})$。\n3.  将此结果代入能隙方程：\n$$ 1 = g_0 (\\hbar\\omega_0)^2 \\left[ \\frac{1}{\\hbar\\omega_0\\sqrt{(\\hbar\\omega_0)^2-\\Delta^2}} \\text{arccosh}\\left(\\frac{\\hbar\\omega_0}{\\Delta}\\right) \\right] $$\n4.  在弱耦合极限下，$g_0 \\ll 1$，我们预期 $\\Delta \\ll \\hbar\\omega_0$。因此，我们可以进行近似：\n- $\\sqrt{(\\hbar\\omega_0)^2-\\Delta^2} \\approx \\hbar\\omega_0$\n- 对于大的宗量 $x \\gg 1$，$\\text{arccosh}(x) \\approx \\ln(2x)$。因此，$\\text{arccosh}(\\frac{\\hbar\\omega_0}{\\Delta}) \\approx \\ln(\\frac{2\\hbar\\omega_0}{\\Delta})$。\n5.  将这些近似代入方程，得到：\n$$ 1 \\approx g_0 (\\hbar\\omega_0)^2 \\left[ \\frac{1}{(\\hbar\\omega_0)^2} \\ln\\left(\\frac{2\\hbar\\omega_0}{\\Delta}\\right) \\right] = g_0 \\ln\\left(\\frac{2\\hbar\\omega_0}{\\Delta}\\right) $$\n6.  求解 $\\Delta$，我们得到最终的表达式：\n$$ \\ln\\left(\\frac{2\\hbar\\omega_0}{\\Delta}\\right) = \\frac{1}{g_0} \\quad \\implies \\quad \\Delta = 2\\hbar\\omega_0 \\exp\\left(-\\frac{1}{g_0}\\right) $$", "answer": "$$\\boxed{2\\hbar\\omega_0\\exp\\!\\Bigl(-\\frac{1}{g_0}\\Bigr)}$$", "id": "632124"}, {"introduction": "解析解虽然强大，但通常局限于零温及其他简化假设之下。现实世界中的超导体存在于有限温度，此时热激发扮演着关键角色。本练习要求您求解关于能隙和化学势的完全耦合的有限温度BCS方程组，这是对理论应用的终极考验。通过编写数值求解程序，您将实践凝聚态物理研究中不可或缺的计算技能，并亲眼观察能隙随温度的变化，直至超导态到正常态的相变 [@problem_id:2415410]。", "problem": "考虑一种被称为 Bardeen–Cooper–Schrieffer (BCS) 理论的有限温度弱耦合超导平均场理论。在一个简化的模型中，该模型具有一个宽度有限且态密度恒定的无特征电子能带，超导能隙的自洽条件和粒子数守恒可以简化为两个关于未知数（超导能隙 $\\Delta$ 和化学势 $\\mu$）的耦合非线性积分方程。您的任务是使用多维求根算法同时求解这两个方程，以得到 $\\Delta$ 和 $\\mu$，并报告在指定参数集下 $\\Delta$ 的值。\n\n假设以下物理上标准且经过充分检验的基本要素：\n- 准粒子激发能为 $E(\\varepsilon) = \\sqrt{(\\varepsilon - \\mu)^2 + \\Delta^2}$，其中 $\\varepsilon$ 是能带内的单粒子能量。\n- 费米-狄拉克分布为 $f(E) = \\left(1 + e^{E/(k_{\\mathrm{B}} T)}\\right)^{-1}$，并且组合项 $\\tanh\\!\\left(E/(2 k_{\\mathrm{B}} T)\\right)$ 出现在热学期望值中。使用以能量单位表示的玻尔兹曼常数 $k_{\\mathrm{B}} = 0.08617333262145\\,\\mathrm{meV/K}$。\n- 电子能带是平坦的，在以零能量为中心、宽度为 $W$ 的有限带宽（即 $\\varepsilon \\in [-W/2, W/2]$）内具有恒定的总（包括自旋）态密度 $N_0$，并且 $N_0 = 1/W$，因此能带内每个格点的单粒子态总数为 1。\n- 吸引配对相互作用仅在围绕 $\\mu$ 的半宽为 $\\omega_{\\mathrm{D}}$（德拜截止）的对称能量窗口内非零，并由无量纲耦合 $\\lambda = g N_0$ 表征，其中 $g$ 是配对相互作用强度。在恒定态密度模型中，耦合仅通过 $\\lambda$ 进入方程。\n\n从这些定义出发，并使用单重态超导体的标准平均场退耦，需要在温度 $T$ 下求解的关于 $\\Delta$ 和 $\\mu$ 的耦合方程为：\n- 能隙自洽方程，其形式允许正常态解 $\\Delta = 0$：\n$$\nF_{\\Delta}(\\Delta,\\mu;T,\\lambda,\\omega_{\\mathrm{D}},W) \\equiv \\Delta - \\lambda \\int_{\\mathcal{I}_{\\mathrm{D}}} \\frac{\\Delta}{2 E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\, \\mathrm{d}\\varepsilon = 0,\n$$\n其中德拜积分窗口为 $\\mathcal{I}_{\\mathrm{D}} = \\{\\varepsilon \\in [-W/2, W/2] : |\\varepsilon - \\mu| \\le \\omega_{\\mathrm{D}}\\}$。\n- 确定填充分数 $\\nu \\in [0,1]$ 的粒子数守恒方程：\n$$\nF_{n}(\\Delta,\\mu;T,\\nu,W) \\equiv \\nu - \\int_{-W/2}^{W/2} N_0 \\left[ 1 - \\frac{\\varepsilon - \\mu}{E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\right] \\mathrm{d}\\varepsilon = 0,\n$$\n其中 $N_0 = 1/W$。\n\n注意：\n- 在高于临界温度的正常态下，由于 $F_{\\Delta}$ 中存在 $\\Delta$ 的显式因子，解 $\\Delta = 0$ 和一个合适的 $\\mu$ 必须同时满足 $F_{\\Delta} = 0$ 和 $F_{n} = 0$。\n- 本问题中所有能量，包括 $\\Delta$、$\\mu$、$W$ 和 $\\omega_{\\mathrm{D}}$，都必须以 $\\mathrm{meV}$ 表示，温度以 $\\mathrm{K}$ 表示。问题不涉及角度，因此不需要角度单位。\n\n您的程序必须实现一个稳健的多维求根方法来求解以下系统：\n$$\n\\mathbf{F}(\\Delta,\\mu) = \\begin{bmatrix} F_{\\Delta}(\\Delta,\\mu;T,\\lambda,\\omega_{\\mathrm{D}},W) \\\\ F_{n}(\\Delta,\\mu;T,\\nu,W) \\end{bmatrix} = \\mathbf{0}\n$$\n并对每个测试案例求解。需要对积分进行数值计算；请使用一种能够在 $\\Delta$ 较小以及温度接近超导转变点时实现稳定收敛的方法。\n\n测试套件：\n使用以下参数集，以元组 $(W\\,\\mathrm{[meV]}, \\omega_{\\mathrm{D}}\\,\\mathrm{[meV]}, \\lambda, \\nu, T\\,\\mathrm{[K]})$ 的形式指定。\n\n- 案例 $\\mathrm{A}$（典型成功路径，低于临界温度）：$(200, 20, 0.3, 0.5, 5)$。\n- 案例 $\\mathrm{B}$（正常态，高于临界温度）：$(200, 20, 0.3, 0.5, 12)$。\n- 案例 $\\mathrm{C}$（接近临界温度）：$(200, 20, 0.3, 0.5, 9.5)$。\n- 案例 $\\mathrm{D}$（偏离半填充，低于临界温度）：$(200, 20, 0.3, 0.3, 5)$。\n\n所需输出：\n- 对于每个测试案例，返回超导能隙 $\\Delta$（单位为 $\\mathrm{meV}$），形式为一个浮点数，四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，结果顺序与测试套件相同：例如 $[\\Delta_{\\mathrm{A}},\\Delta_{\\mathrm{B}},\\Delta_{\\mathrm{C}},\\Delta_{\\mathrm{D}}]$。\n\n约束和指南：\n- 针对每个案例，实现一个真正的多维求根策略来同时求解 $\\Delta$ 和 $\\mu$；不要将系统简化为单个方程。\n- 通过设计积分和函数求值以避免伪发散，确保在 $\\Delta \\rightarrow 0$ 时的数值稳定性。\n- 所有计算必须是自包含的，无需用户输入。仅使用标准库和指定的数值库。", "solution": "所提出的问题是计算凝聚态物理学中一个标准的、适定的问题。它要求同时数值求解两个耦合的非线性积分方程，这两个方程在 Bardeen–Cooper–Schrieffer (BCS) 平均场理论框架内确定了一个简单超导模型的物态。所有给定的方程、定义和参数在科学上都是合理且自洽的。该问题有效。\n\n任务是找到超导能隙 $\\Delta$ 和化学势 $\\mu$ 的值，使其满足方程组 $\\mathbf{F}(\\Delta, \\mu) = \\mathbf{0}$，其中向量函数 $\\mathbf{F}$ 由下式给出：\n$$\n\\mathbf{F}(\\Delta,\\mu) = \\begin{bmatrix} F_{\\Delta}(\\Delta,\\mu) \\\\ F_{n}(\\Delta,\\mu) \\end{bmatrix} = \\mathbf{0}\n$$\n该向量函数的分量定义为：\n$$\nF_{\\Delta}(\\Delta,\\mu) = \\Delta - \\lambda \\int_{\\mathcal{I}_{\\mathrm{D}}} \\frac{\\Delta}{2 E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\, \\mathrm{d}\\varepsilon\n$$\n$$\nF_{n}(\\Delta,\\mu) = \\nu - \\int_{-W/2}^{W/2} N_0 \\left[ 1 - \\frac{\\varepsilon - \\mu}{E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\right] \\mathrm{d}\\varepsilon\n$$\n其中 $E(\\varepsilon) = \\sqrt{(\\varepsilon - \\mu)^2 + \\Delta^2}$，$N_0 = 1/W$，并且能隙方程的积分域为 $\\mathcal{I}_{\\mathrm{D}} = \\{\\varepsilon \\in [-W/2, W/2] : |\\varepsilon - \\mu| \\le \\omega_{\\mathrm{D}}\\}$。每个案例的参数 $\\{W, \\omega_{\\mathrm{D}}, \\lambda, \\nu, T\\}$ 均已提供，玻尔兹曼常数为 $k_{\\mathrm{B}} = 0.08617333262145\\,\\mathrm{meV/K}$。\n\n该系统构成一个多维求根问题。我们将采用一种数值算法来求解它。一个合适的选择是准牛顿法，例如 Powell 混合法，它通过近似雅可比矩阵来迭代寻找根。SciPy 库中的 `scipy.optimize.root` 函数及其 `hybr` 方法，为此算法提供了一个稳健的实现。\n\n解决方案的核心在于实现向量函数 $\\mathbf{F}(\\Delta, \\mu)$，这需要对定积分进行数值计算。我们使用 `scipy.integrate.quad` 函数来完成此任务。为获得稳定且准确的解，有几个数值方面的考虑至关重要：\n\n1. **$F_{\\Delta}$ 的计算**：能隙方程的积分上下限依赖于变量 $\\mu$。它们必须动态地计算为 $[\\max(-W/2, \\mu - \\omega_{\\mathrm{D}}), \\min(W/2, \\mu + \\omega_{\\mathrm{D}})]$。被积函数包含项 $\\Delta/E(\\varepsilon)$。当 $\\Delta > 0$ 时，该项是良态的。如果 $\\Delta = 0$，被积函数恒为零，因此对于任何 $\\mu$，$F_{\\Delta}(0, \\mu) = 0$。这正确地将正常态捕捉为能隙方程的一个平凡解。该方程关于 $\\Delta$ 是奇函数；如果 $(\\Delta_s, \\mu_s)$ 是一个解，那么 $(-\\Delta_s, \\mu_s)$ 也是一个解。按照惯例，物理能隙是非负的，对应于正根。\n\n2. **$F_{n}$ 的计算**：粒子数守恒方程的被积函数包含项 $(\\varepsilon-\\mu)/E(\\varepsilon)$。在极限 $\\Delta \\to 0$ 时，$E(\\varepsilon) \\to |\\varepsilon - \\mu|$，该项趋近于 $\\mathrm{sgn}(\\varepsilon - \\mu)$，在 $\\varepsilon=\\mu$ 处是不连续的。为确保数值精度，必须让 `quad` 积分器知晓这一潜在的奇点。这可以通过将位置 $\\mu$ 传递给 `quad` 函数的 `points` 参数来实现。粒子数方程仅依赖于 $\\Delta^2$，使其成为 $\\Delta$ 的偶函数。\n\n3. **初始猜测值**：迭代求根算法的收敛性高度依赖于解向量 $(\\Delta_0, \\mu_0)$ 的初始猜测值。一个具有物理动机的选择至关重要：\n-   对于化学势 $\\mu_0$，在半填充（$\\nu=0.5$）时，粒子-空穴对称性决定了 $\\mu \\approx 0$。偏离半填充时，一个合理的初始猜测是零温下非相互作用系统的化学势，由 $\\mu_0 = W(\\nu - 0.5)$ 给出。\n-   对于能隙 $\\Delta_0$，我们使用弱耦合近似来估计 BCS 临界温度：$k_B T_c \\approx 1.13 \\omega_D e^{-1/\\lambda}$。对于给定的参数 $\\lambda=0.3$ 和 $\\omega_D=20\\,\\mathrm{meV}$，我们发现 $T_c \\approx 9.35\\,\\mathrm{K}$。如果系统温度 $T$ 低于 $T_c$，预计会存在一个 $\\Delta > 0$ 的超导态，此时一个非零的初始猜测值（例如 $\\Delta_0 = 1.0\\,\\mathrm{meV}$）是合适的。如果 $T > T_c$，系统处于正常态，因此我们期望 $\\Delta = 0$。一个接近于零的初始猜测值 $\\Delta_0 \\approx 0$ 将引导求解器找到这个解。\n\n总体步骤如下：对于每个测试案例，我们使用指定的参数构建向量函数 $\\mathbf{F}$。然后，我们将该函数以及一个精心选择的初始猜测值 $(\\Delta_0, \\mu_0)$ 提供给 `scipy.optimize.root` 求解器。求解器返回解向量 $(\\Delta^*, \\mu^*)$。我们报告每个案例的物理能隙，即非负值 $|\\Delta^*|$。对于那些 $|\\Delta^*|$ 在数值上与零无法区分的结果（例如，小于 $10^{-9}$），我们将其精确地设置为 $0.0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.integrate import quad\n\n# Define constants\nK_B = 0.08617333262145  # Boltzmann constant in meV/K\n\ndef system_equations(x, W, omega_D, lambda_, nu, T):\n    \"\"\"\n    Defines the system of nonlinear equations F(x) = 0 for the BCS problem.\n    x: array-like, x[0] = Delta (gap), x[1] = mu (chemical potential)\n    W, omega_D, lambda_, nu, T: parameters of the model.\n    \"\"\"\n    delta, mu = x\n    N0 = 1.0 / W\n\n    # --- F_delta equation ---\n    # F_delta = delta - lambda * integral_delta\n    # Integrand for the gap equation.\n    def integrand_delta(eps, d, m):\n        # The equation from the problem is F_delta = delta - lambda * integral(delta/E * ...).\n        # It is odd in delta. We must use the 'd' from the solver, not abs(d).\n        # We handle d=0 as a special case to avoid division by zero in the term delta/E.\n        if d == 0.0:\n            return 0.0\n        \n        # The argument of sqrt is delta^2, so it's always non-negative.\n        E_eps = np.sqrt((eps - m)**2 + d**2)\n        if E_eps == 0.0: # Should not happen if d != 0\n            return 0.0\n        \n        tanh_term = np.tanh(E_eps / (2.0 * K_B * T))\n        return (d / (2.0 * E_eps)) * tanh_term\n\n    # Integration bounds for the gap equation.\n    lower_d = max(-W / 2.0, mu - omega_D)\n    upper_d = min(W / 2.0, mu + omega_D)\n    \n    integral_delta = 0.0\n    # Perform integration only if the interval is valid.\n    if lower_d  upper_d:\n        integral_delta, _ = quad(integrand_delta, lower_d, upper_d, args=(delta, mu), epsabs=1e-11, epsrel=1e-11)\n    \n    f_delta = delta - lambda_ * integral_delta\n\n    # --- F_n equation ---\n    # F_n = nu - integral_n\n    # The number equation depends on delta^2, so using abs(delta) is robust.\n    delta_abs = abs(delta)\n    \n    # Integrand for the number equation.\n    def integrand_n(eps, d_abs, m):\n        E_eps = np.sqrt((eps - m)**2 + d_abs**2)\n        \n        if E_eps == 0.0:  # Occurs only if d_abs=0 and eps=m\n            # The limit of the term ((eps-m)/E_eps) * tanh(E_eps/...) is 0 as eps->m.\n            frac_term = 0.0\n        else:\n            tanh_term = np.tanh(E_eps / (2.0 * K_B * T))\n            frac_term = ((eps - m) / E_eps) * tanh_term\n            \n        return N0 * (1.0 - frac_term)\n    \n    # Integration for number equation over the full band.\n    # We specify mu as a point of potential discontinuity for the integrator.\n    points_of_interest = [mu] if -W / 2.0  mu  W / 2.0 else None\n    integral_n, _ = quad(integrand_n, -W / 2.0, W / 2.0, args=(delta_abs, mu), points=points_of_interest, epsabs=1e-11, epsrel=1e-11)\n    \n    f_n = nu - integral_n\n    \n    return [f_delta, f_n]\n\ndef solve():\n    \"\"\"\n    Solves the BCS equations for each test case and prints the results.\n    \"\"\"\n    test_cases = [\n        # (W [meV], omega_D [meV], lambda, nu, T [K])\n        (200.0, 20.0, 0.3, 0.5, 5.0),    # Case A\n        (200.0, 20.0, 0.3, 0.5, 12.0),   # Case B\n        (200.0, 20.0, 0.3, 0.5, 9.5),    # Case C\n        (200.0, 20.0, 0.3, 0.3, 5.0),    # Case D\n    ]\n\n    # Initial guesses (Delta_0, mu_0) based on physical considerations.\n    initial_guesses = [\n        # T_c is approx 9.35 K. W(nu-0.5) gives mu_0 for non-half-filled cases.\n        (1.0, 0.0),      # A: T  T_c, nu=0.5 -> expect Delta > 0, mu=0\n        (0.01, 0.0),     # B: T > T_c, nu=0.5 -> expect Delta = 0, mu=0\n        (0.1, 0.0),      # C: T ~ T_c, nu=0.5 -> expect Delta small or 0, mu=0\n        (1.0, -40.0),    # D: T  T_c, nu=0.3 -> expect Delta > 0, mu=200(0.3-0.5)=-40\n    ]\n\n    results = []\n    for i, params in enumerate(test_cases):\n        x0 = initial_guesses[i]\n        \n        # Use a robust root-finding algorithm.\n        solution = root(system_equations, x0, args=params, method='hybr', tol=1e-9)\n        \n        if solution.success:\n            delta_sol = solution.x[0]\n            \n            # The physical gap parameter is non-negative.\n            # If the solver returns a small negative value, it is numerically zero.\n            if abs(delta_sol)  1e-9:\n                delta_sol = 0.0\n            \n            # Report the magnitude of the gap.\n            results.append(abs(delta_sol))\n        else:\n            # Append NaN or handle error if solver fails, for robustness.\n            results.append(np.nan)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each value rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2415410"}]}