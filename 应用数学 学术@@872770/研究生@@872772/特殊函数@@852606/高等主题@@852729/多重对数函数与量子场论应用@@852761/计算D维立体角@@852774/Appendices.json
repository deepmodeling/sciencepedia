{"hands_on_practices": [{"introduction": "在计算复杂区域的大小时，一个最强大的策略是计算其*未包含*的部分的大小。这个练习将应用补集计数的思想来寻找一个由混合符号分量定义的区域所张的立体角，这种情况在数据分析中很常见。通过计算整个空间并减去只包含正分量或只包含负分量的区域，我们可以轻易地得到答案 [@problem_id:660174]。", "problem": "在一个 $D$ 维欧几里得空间 $\\mathbb{R}^D$ 中，空间中一个区域在原点所对的立体角，定义为其在单位 $(D-1)$ 维球面 $S^{D-1} = \\{\\mathbf{x} \\in \\mathbb{R}^D \\mid ||\\mathbf{x}||=1\\}$ 上的径向投影的表面积。$\\mathbb{R}^D$ 中的总立体角对应于这个超球面的全部表面积，由以下公式给出\n$$\nS_{D-1} = \\frac{2\\pi^{D/2}}{\\Gamma(D/2)}\n$$\n其中 $\\Gamma(z)$ 是欧拉伽马函数。\n\n考虑一个向量 $\\mathbf{x} = (x_1, x_2, \\ldots, x_D) \\in \\mathbb{R}^D$。令 $x_{\\max} = \\max\\{x_1, \\ldots, x_D\\}$ 和 $x_{\\min} = \\min\\{x_1, \\ldots, x_D\\}$ 分别表示向量 $\\mathbf{x}$ 的最大分量和最小分量。\n\n我们感兴趣的区域是 $\\mathcal{R} \\subset \\mathbb{R}^D$，它包含所有至少有一个正分量和至少一个负分量的向量（不含原点）。这个条件可以表述为所有满足 $x_{\\max} > 0$ 和 $x_{\\min}  0$ 的点 $\\mathbf{x} \\in \\mathbb{R}^D \\setminus \\{\\mathbf{0}\\}$ 的集合。\n\n计算该区域 $\\mathcal{R}$ 所对的立体角 $\\Omega_D(\\mathcal{R})$。请用维度 $D$ 表示你的答案。", "solution": "1. $\\mathbb{R}^D$ 中的总立体角（即 $S^{D-1}$ 的表面积）是\n$$\nS_{D-1} \\;=\\;\\frac{2\\pi^{D/2}}{\\Gamma\\!\\bigl(D/2\\bigr)}.\n$$\n\n2. 单位球面（由 $(x_1,\\dots,x_D)$ 的符号）被划分为 $2^D$ 个卦限。根据对称性，每个卦限所对的立体角相同，为\n$$\n\\frac{S_{D-1}}{2^D}.\n$$\n\n3. 区域 $\\mathcal{R}$ 包含所有至少有一个正分量和一个负分量的点。*不*在 $\\mathcal{R}$ 中的仅有两个卦限是“全正”卦限和“全负”卦限。因此\n$$\n\\Omega_D(\\mathcal{R})\n= S_{D-1}\n-2\\;\\frac{S_{D-1}}{2^D}\n= S_{D-1}\\Bigl(1 - \\frac{2}{2^D}\\Bigr)\n= S_{D-1}\\bigl(1 - 2^{1-D}\\bigr).\n$$\n\n4. 代入 $S_{D-1}=\\frac{2\\pi^{D/2}}{\\Gamma(D/2)}$ 可得\n$$\n\\Omega_D(\\mathcal{R})\n= \\frac{2\\pi^{D/2}}{\\Gamma\\!\\bigl(D/2\\bigr)}\\Bigl(1 - 2^{1-D}\\Bigr).\n$$", "answer": "$$\n\\boxed{\\frac{2\\pi^{D/2}}{\\Gamma\\!\\bigl(\\frac{D}{2}\\bigr)}\\bigl(1 - 2^{1-D}\\bigr)}\n$$", "id": "660174"}, {"introduction": "在将空间划分为基本单元（如卦限）的基础上，本练习将探讨由向量分量的代数性质定义的区域。我们将计算其分量符号之和为定值的向量集合所张的立体角 [@problem_id:660290]。这项任务巧妙地将几何学与组合数学结合起来，要求我们使用二项式系数来计算满足条件的卦限数量。", "problem": "在$D$维欧几里得空间$\\mathbb{R}^D$中，一个区域相对原点所张的立体角是衡量该区域对原点处的观察者来说看起来有多大的量度。它是该区域在以原点为中心的单位$(D-1)$维球面上的投影面积。$\\mathbb{R}^D$中的总立体角是该单位球面的表面积，由$S_{D-1} = \\frac{2\\pi^{D/2}}{\\Gamma(D/2)}$给出，其中$\\Gamma(z)$是欧拉伽马函数。\n\n考虑符号函数$\\operatorname{sgn}(x)$，其定义如下：\n$$\n\\operatorname{sgn}(x) = \\begin{cases}\n+1  \\text{若 } x > 0 \\\\\n-1  \\text{若 } x  0 \\\\\n\\phantom{+}0  \\text{若 } x = 0\n\\end{cases}\n$$\n设$\\mathbf{x} = (x_1, x_2, \\dots, x_D)$是$\\mathbb{R}^D$中的一个向量。我们将区域$\\mathcal{R}_S$定义为所有满足其各分量符号之和等于一个特定整数$S$的向量$\\mathbf{x}$的集合：\n$$\n\\mathcal{R}_S = \\left\\{ \\mathbf{x} \\in \\mathbb{R}^D \\mid \\sum_{i=1}^D \\operatorname{sgn}(x_i) = S \\right\\}\n$$\n给定维度$D$为整数且$D \\geq 2$，以及整数$S$满足$|S| \\leq D$且$D+S$为非负偶数，求区域$\\mathcal{R}_S$所张的立体角$\\Omega(\\mathcal{R}_S)$。请用$D$、$S$、$\\pi$和伽马函数将您的答案表示为一个闭式解析表达式。", "solution": "1. $\\mathbb{R}^D$中的总立体角为\n$$\nS_{D-1}=\\frac{2\\pi^{D/2}}{\\Gamma\\!\\bigl(\\tfrac{D}{2}\\bigr)}.\n$$\n2. 任何向量$\\mathbf x\\in\\mathbb R^D$的每个分量$x_i\\neq0$（零点构成一个零测集），因此$\\operatorname{sgn}(x_i)=\\pm1$。如果恰好有$k$个分量为$+1$，$D-k$个分量为$-1$，那么\n$$\n\\sum_{i=1}^D\\operatorname{sgn}(x_i)=k-(D-k)=2k-D=S,\n$$\n因此\n$$\nk=\\frac{D+S}{2}.\n$$\n3. 共有$\\displaystyle\\binom{D}{k}=\\binom{D}{\\frac{D+S}{2}}$个这样的象限，每个象限所张的立体角均为$S_{D-1}/2^D$。  \n4. 因此\n$$\n\\Omega(\\mathcal R_S)\n=\\binom{D}{\\frac{D+S}{2}}\\;\\frac{S_{D-1}}{2^D}\n=\\binom{D}{\\frac{D+S}{2}}\\;\\frac{2\\pi^{\\frac{D}{2}}}{2^D\\,\\Gamma\\!\\bigl(\\tfrac{D}{2}\\bigr)}.\n$$", "answer": "$$\n\\boxed{\\frac{\\displaystyle\\binom{D}{\\frac{D+S}{2}}2\\pi^{\\frac{D}{2}}}{2^D\\Gamma\\!\\bigl(\\tfrac{D}{2}\\bigr)}}.\n$$", "id": "660290"}, {"introduction": "有些区域很难用简单的符号组合来描述，而是通过分量之间的不等式来定义，从而形成一个“有序”锥。本练习将引入一种强大的概率方法来计算立体角，将其构建为随机高斯向量落入该锥体的概率 [@problem_id:660169]。这种技术在排序统计学和高维推断等领域至关重要。", "problem": "在$D$维欧几里得空间$\\mathbb{R}^D$中，一个锥体的立体角是从其位于原点的顶点看其开口的视觉尺寸的度量。它是二维中的角和三维中的立体角的推广。分数立体角是指，锥体在以原点为中心的单位$(D-1)$维球面上所对的表面积与该球面的总表面积 $S_{D-1} = \\frac{2\\pi^{D/2}}{\\Gamma(D/2)}$ 之比。这提供了一个无量纲的立体角量度，对于整个空间，其值被归一化为1。\n\n考虑在$\\mathbb{R}^D$中的一个锥体$C$，其中维度$D \\ge 2$为整数。该锥体由满足一组特定线性不等式的点集 $\\mathbf{x} = (x_1, x_2, \\dots, x_D)$ 定义：\n$$\nC = \\{\\mathbf{x} \\in \\mathbb{R}^D \\mid x_1 > x_2 > \\dots > x_D \\text{ and } x_1 > 0 \\}\n$$\n您的任务是计算此锥体 $C$ 所对的分数立体角，记为 $\\Omega(C, D)$。结果应为一个用维度 $D$ 表示的闭式表达式。", "solution": "在$\\mathbb{R}^D$中以原点为顶点的锥体$C$的分数立体角$\\Omega(C, D)$，可以使用一种涉及高斯积分的强大方法来计算。分数立体角等于一个随机向量$\\mathbf{X}$落入锥体$C$的概率，该向量的分量是$D$个独立同分布 (i.i.d.) 的标准正态随机变量。\n\n设$\\mathbf{X} = (X_1, X_2, \\dots, X_D)$，其中每个$X_i \\sim N(0, 1)$是独立同分布的。联合概率密度函数 (PDF) 由下式给出：\n$$\nf(\\mathbf{x}) = \\frac{1}{(2\\pi)^{D/2}} e^{-|\\mathbf{x}|^2/2}\n$$\n概率$P(\\mathbf{X} \\in C)$是此PDF在锥体$C$上的积分：\n$$\nP(\\mathbf{X} \\in C) = \\int_C f(\\mathbf{x}) d^D\\mathbf{x}\n$$\n我们切换到超球坐标，其中$d^D\\mathbf{x} = r^{D-1} dr dS_{D-1}$，$r=|\\mathbf{x}|$是径向距离，$dS_{D-1}$是单位$(D-1)$维球面上的面积元。锥体$C$在该球面上定义了一个区域，我们称之为$A_C = C \\cap S^{D-1}$。立体角（单位为球面度）是该区域的面积，我们记为Area($A_C$)。\n\\begin{align*}\nP(\\mathbf{X} \\in C) = \\frac{1}{(2\\pi)^{D/2}} \\int_{A_C} \\left( \\int_0^\\infty r^{D-1} e^{-r^2/2} dr \\right) dS_{D-1} \\\\\n= \\frac{\\text{Area}(A_C)}{(2\\pi)^{D/2}} \\int_0^\\infty r^{D-1} e^{-r^2/2} dr\n\\end{align*}\n径向积分可以使用伽马函数来计算。令 $u = r^2/2$，则 $r = \\sqrt{2u}$ 且 $dr = \\frac{du}{\\sqrt{2u}}$。\n$$\n\\int_0^\\infty r^{D-1} e^{-r^2/2} dr = \\int_0^\\infty (2u)^{(D-1)/2} e^{-u} \\frac{du}{\\sqrt{2u}} = 2^{D/2-1} \\int_0^\\infty u^{D/2-1} e^{-u} du = 2^{D/2-1} \\Gamma(D/2)\n$$\n将此代回，我们得到：\n$$\nP(\\mathbf{X} \\in C) = \\frac{\\text{Area}(A_C)}{(2\\pi)^{D/2}} \\cdot 2^{D/2-1} \\Gamma(D/2) = \\text{Area}(A_C) \\frac{2^{D/2-1} \\Gamma(D/2)}{2^{D/2} \\pi^{D/2}} = \\frac{\\text{Area}(A_C)}{2\\pi^{D/2}/\\Gamma(D/2)}\n$$\n分母恰好是单位$(D-1)$维球面的总表面积 $S_{D-1}$。因此，\n$$\n\\Omega(C, D) = \\frac{\\text{Area}(A_C)}{S_{D-1}} = P(\\mathbf{X} \\in C)\n$$\n因此，问题简化为计算概率 $P(X_1 > X_2 > \\dots > X_D \\text{ and } X_1 > 0)$。\n\n让我们来分解这个问题。变量 $X_1, \\dots, X_D$ 是独立同分布的，并且从一个连续分布（标准正态分布）中抽取。对于$\\{1, 2, \\dots, D\\}$的任何排列$\\sigma$，由于变量的可交换性，特定顺序$X_{\\sigma(1)} > X_{\\sigma(2)} > \\dots > X_{\\sigma(D)}$的概率是相同的。因为有$D!$种可能的严格排序（出现$X_i=X_j$这样相等情况的概率为零），并且这些排序划分了整个样本空间，所以任何单一特定排序的概率都是$1/D!$。\n设$\\mathcal{O}$为事件$X_1 > X_2 > \\dots > X_D$。那么，\n$$\nP(\\mathcal{O}) = \\frac{1}{D!}\n$$\n问题要求的是联合事件$\\mathcal{O} \\cap \\{X_1 > 0\\}$的概率。我们可以将其写为：\n$$\nP(\\mathcal{O} \\cap \\{X_1 > 0\\}) = P(X_1 > 0 \\mid \\mathcal{O}) P(\\mathcal{O})\n$$\n事件$\\mathcal{O}$意味着$X_1$是所有变量中最大的。设$X_{(1)}$为最大顺序统计量，即$X_{(1)} = \\max\\{X_1, \\dots, X_D\\}$。条件$\\mathcal{O}$等价于事件$\\{X_1 = X_{(1)}\\}$发生，同时其余变量满足一个特定的排序。因此，在事件$\\mathcal{O}$下，条件$X_1 > 0$等价于条件$X_{(1)} > 0$。因此，\n$$\nP(X_1 > 0 \\mid \\mathcal{O}) = P(X_{(1)} > 0 \\mid \\mathcal{O}) = P(X_{(1)} > 0)\n$$\n最后一个等式成立，因为最大值$X_{(1)}$的分布与哪个特定变量$X_i$恰好成为最大值是无关的。\n\n现在我们计算$P(X_{(1)} > 0)$。先计算其互补概率$P(X_{(1)} \\le 0)$会更简单。\n一组数的最大值小于或等于零，当且仅当这组数中的所有数都小于或等于零。\n$$\nP(X_{(1)} \\le 0) = P(X_1 \\le 0 \\text{ and } X_2 \\le 0 \\text{ and } \\dots \\text{ and } X_D \\le 0)\n$$\n由于变量$X_i$是独立同分布的，联合概率是各个概率的乘积：\n$$\nP(X_{(1)} \\le 0) = \\prod_{i=1}^D P(X_i \\le 0)\n$$\n对于标准正态分布（其关于0对称），$P(X_i \\le 0) = 1/2$。\n$$\nP(X_{(1)} \\le 0) = \\left(\\frac{1}{2}\\right)^D = 2^{-D}\n$$\n因此，最大值为正的概率是：\n$$\nP(X_{(1)} > 0) = 1 - P(X_{(1)} \\le 0) = 1 - 2^{-D}\n$$\n最后，我们可以计算所求的分数立体角：\n$$\n\\Omega(C, D) = P(\\mathcal{O} \\cap \\{X_1 > 0\\}) = P(X_{(1)} > 0) \\times P(\\mathcal{O}) = (1 - 2^{-D}) \\times \\frac{1}{D!}\n$$\n所以分数立体角是：\n$$\n\\Omega(C, D) = \\frac{1-2^{-D}}{D!}\n$$", "answer": "$$\n\\boxed{\\frac{1-2^{-D}}{D!}}\n$$", "id": "660169"}]}