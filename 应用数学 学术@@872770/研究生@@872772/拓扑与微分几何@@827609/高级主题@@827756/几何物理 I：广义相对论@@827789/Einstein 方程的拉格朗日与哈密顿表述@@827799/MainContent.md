## 引言
广义相对论以其优美的几何语言描述了[引力](@entry_id:175476)，但其核心方程——爱因斯坦场方程——在标准形式下隐藏了动力学演化的细节，使其难以作为一个标准的[初值问题](@entry_id:144620)来处理，也为量子化带来了巨大挑战。为了克服这些困难，物理学家发展了爱因斯坦方程的[拉格朗日与哈密顿表述](@entry_id:158937)，这一框架不仅揭示了[时空动力学](@entry_id:201628)的深刻结构，也为数值求解和量子引力研究铺平了道路。本文旨在系统性地引导读者深入理解这一强大的理论工具。

在接下来的内容中，我们将分三步展开。首先，在“原理与机制”一章中，我们将从变分原理和时空分解出发，详细构建[引力](@entry_id:175476)理论的ADM形式，并阐明[哈密顿约束](@entry_id:161058)与[动量约束](@entry_id:160112)的起源和物理意义。接着，在“应用与跨学科联系”一章中，我们将展示这一理论框架如何在宇宙学、[黑洞](@entry_id:158571)物理、[数值相对论](@entry_id:140327)乃至量子引力等前沿领域中发挥关键作用。最后，通过“动手实践”部分，读者将有机会亲手应用这些概念解决具体问题，从而加深理解。让我们首先进入第一章，探索这一理论体系的基石。

## 原理与机制

在理解广义相对论的动力学结构时，爱因斯坦场方程的拉格朗日和[哈密顿表述](@entry_id:276227)提供了极为深刻的见解。这些表述不仅为解析和数值求解[引力](@entry_id:175476)问题奠定了基础，也为[引力](@entry_id:175476)的量子化开辟了道路。本章旨在系统地阐述这些表述的核心原理与机制，从时空的分解开始，逐步构建起[引力](@entry_id:175476)动力学的哈密顿图景。

### 变分原理与边界项

广义相对论的核心[动力学方程](@entry_id:751029)源于一个作用量的[变分原理](@entry_id:198028)。这个作用量即为著名的**爱因斯坦-[希尔伯特作用量](@entry_id:204075) (Einstein-Hilbert action)**，其在真空中的形式为：

$$ S_{EH} = \frac{1}{16\pi G} \int_{\mathcal{M}} R \sqrt{-g} \, d^4x $$

其中 $R$ 是[里奇标量](@entry_id:158934)曲率，$g$ 是四维时空度规 $g_{\mu\nu}$ 的[行列式](@entry_id:142978)，$\mathcal{M}$ 是一个四维[时空流形](@entry_id:262092)，而 $G$ 是引力常数（本文采用自然单位制 $c=1$）。通过对度规 $g_{\mu\nu}$ 进行变分并要求作用量取驻值（$\delta S_{EH} = 0$），我们便可以得到真空中的爱因斯坦场方程 $R_{\mu\nu} - \frac{1}{2} g_{\mu\nu} R = 0$。

然而，要使这个[变分问题](@entry_id:756445)是**良定的 (well-posed)**，我们需要仔细处理边界上的行为。当我们对作用量进行变分时，通过[分部积分](@entry_id:136350)，除了得到爱因斯坦场方程的项之外，还会产生一个边界项。如果我们假定时空区域 $\mathcal{M}$ 的边界 $\partial\mathcal{M}$ 上度规的变分 $\delta g_{\mu\nu}$ 为零，这个边界项会自动消失。但在许多物理情境中，例如在研究[黑洞热力学](@entry_id:136383)或[引力](@entry_id:175476)的量子化时，我们不能强制要求边界上度规的变分消失。在这种更一般的情况下，爱因斯坦-[希尔伯特作用量](@entry_id:204075)的变分会留下一个非零的边界积分：

$$ \delta S_{EH, bdy} = \frac{1}{16\pi G} \int_{\partial\mathcal{M}} d^3y \sqrt{|h|} \, n_\alpha (g^{\mu\nu}\delta\Gamma^\alpha_{\mu\nu} - g^{\mu\alpha}\delta\Gamma^\beta_{\mu\beta}) $$

这里 $h_{\mu\nu}$ 是在边界 $\partial\mathcal{M}$ 上诱导的度规，$h$ 是其[行列式](@entry_id:142978)，$n^\alpha$ 是边界的[单位法向量](@entry_id:178851)。为了更清晰地理解这个边界项的结构，我们可以考虑在一个类时边界附近建立高斯标准[坐标系](@entry_id:156346) (Gaussian Normal Coordinate system)。在这个[坐标系](@entry_id:156346)下，度规可以写成 $ds^2 = dy^2 + h_{ij}(y, x^k)dx^i dx^j$，其中 $y$ 是沿垂直于边界的[测地线](@entry_id:269969)的[固有距离](@entry_id:162052)。如果我们只考虑那些保持此[坐标系](@entry_id:156346)形式的度规变分（即 $\delta g_{ij} = \delta h_{ij}$），那么上述复杂的边界项可以被证明与边界的**外曲率 (extrinsic curvature)** $K_{ij}$ 及其变分 $\delta K$ 直接相关。具体来说，边界上的被积函数可以表示为 $-2(\delta K - K_{ij}\delta h^{ij})$，其中 $K$ 是外曲率的迹 [@problem_id:983242]。

这个非零的边界项意味着，仅仅使用爱因斯坦-[希尔伯特作用量](@entry_id:204075)，我们无法在固定边界度规（即狄利克雷边界条件）的情况下得到一个驻值问题。为了修正这一点，Gibbons、Hawking 和 York 提出，需要在作用量中额外加入一个边界项，即**吉本斯-霍金-约克 (Gibbons-Hawking-York, GHY) 项**：

$$ S_{GHY} = \frac{1}{8\pi G} \int_{\partial\mathcal{M}} K \sqrt{|h|} \, d^3y $$

其中 $K$ 是边界的外曲率的迹。这个项的巧妙之处在于，它的变分恰好能抵消掉爱因斯坦-[希尔伯特作用量](@entry_id:204075)变分产生的那个多余的边界项。因此，完整的[引力](@entry_id:175476)作用量应为 $S = S_{EH} + S_{GHY}$。

加入GHY项后，完整的[引力](@entry_id:175476)作用量 $S$ 在变[分时](@entry_id:274419)，如果边界上的[诱导度规](@entry_id:160616) $h_{\alpha\beta}$ 本身发生变分 $\delta h_{\alpha\beta}$，则会产生一个新的边界项。例如，考虑一个四维反德西特 (AdS$_4$) 时空，其度规为 $ds^2 = \frac{L^2}{z^2}(-dt^2 + dx^2 + dy^2 + dz^2)$。如果我们选择 $z=z_0$ （一个常数）作为时空边界，并考虑一个特定的变分，比如只有 $\delta h_{tt}$ 分量不为零，那么由GHY项主导的边界作用量变分是可以被精确计算的。这个计算展示了边界动力学是如何通过GHY项与体作用量联系在一起的 [@problem_id:983316]。

### 时空的[3+1分解](@entry_id:140329) (ADM形式)

为了构建[引力](@entry_id:175476)理论的[哈密顿表述](@entry_id:276227)，我们必须将时空分解为“空间”加“时间”的结构。这就是**Arnowitt-Deser-Misner (ADM) 形式**的核心思想，也称为**[3+1分解](@entry_id:140329)**。它将四维[时空流形](@entry_id:262092) $\mathcal{M}$ **叶状化 (foliate)** 为一系列被时间坐标 $t$ 参数化的三维类空超曲面 $\Sigma_t$。

在这种分解下，四维时空[线元](@entry_id:196833) $ds^2$ 可以用三个基本几何量来描述：

1.  **直递函数 (Lapse Function) $N$**：一个标量场，它描述了两个相邻超曲面 $\Sigma_t$ 和 $\Sigma_{t+dt}$ 之间的[固有时](@entry_id:192124)间间隔。
2.  **[移位](@entry_id:145848)矢量 (Shift Vector) $N^i$**：一个定义在每个 $\Sigma_t$ 上的矢量场，它描述了从一个[超曲面](@entry_id:159491)到下一个[超曲面](@entry_id:159491)时，空间[坐标系](@entry_id:156346)是如何“漂移”或“移动”的。其协变分量为 $N_i = \gamma_{ij}N^j$。
3.  **三维空间度规 (Spatial Metric) $\gamma_{ij}$**：在每个类空超曲面 $\Sigma_t$ 上诱导的黎曼度规。

利用这些量，四维时空[线元](@entry_id:196833)可以写成如下形式：

$$ ds^2 = g_{\mu\nu} dx^\mu dx^\nu = -N^2 dt^2 + \gamma_{ij} (dx^i + N^i dt)(dx^j + N^j dt) $$

展开上式，我们可以得到四维时空度规 $g_{\mu\nu}$ 的分量与 ADM 变量之间的关系：

$$ g_{00} = -N^2 + N_k N^k, \quad g_{0i} = N_i, \quad g_{ij} = \gamma_{ij} $$

其中 $N_k N^k = N_i \gamma^{ij} N_j$。这个分解是完全普适的，任何一个满足广义相对论要求的时空度规都可以进行这样的分解。例如，考虑一个描述匀[加速[参考](@entry_id:168026)系](@entry_id:169232)的Rindler时空，其[线元](@entry_id:196833)为 $ds^2 = -(a\rho)^2 d\eta^2 + d\rho^2 + dy^2 + dz^2$。如果我们引入一个新的时间坐标 $t = \eta - k\rho$，就可以将此时空按照 $t=\text{const}$ 的[超曲面](@entry_id:159491)进行叶状化，并显式地计算出相应的直递函数 $N$、移位矢量 $N^i$ 和空间度规 $\gamma_{ij}$ [@problem_id:983300]。这个练习清晰地展示了如何从一个给定的四维[时空度规](@entry_id:202650)中提取出[3+1分解](@entry_id:140329)的各个组分。

ADM变量具有清晰的物理和几何意义。特别是直递函数 $N$ 的意义尤为重要。考虑一个世界线处处垂直于这些类空超曲面 $\Sigma_t$ 的观测者，这类观测者被称为**“欧拉”观测者 (Eulerian observer)** 或**“正规”观测者 (normal observer)**。他们的四维速度 $u^\mu$ 与超[曲面的法向量](@entry_id:274852) $n^\mu$ 对齐。对于这样一个观测者，其经历的[固有时](@entry_id:192124)间间隔 $d\tau$ 与[坐标时](@entry_id:263720)间间隔 $dt$ 之间的关系由直递函数 $N$ 决定：

$$ d\tau = N dt $$

这个关系可以通过将正规观测者的运动条件（即 $dx^i + N^i dt = 0$）代入ADM线元中直接导出 [@problem_id:983318]。因此，直递函数 $N$ 衡量了[坐标时](@entry_id:263720)间的流逝速率与观测者自身感受到的物理时间（即[固有时](@entry_id:192124)间）的流逝速率之间的局域比例关系。如果 $N1$，则意味着该处的物理时间流逝得比[坐标时](@entry_id:263720)钟慢。移位矢量 $N^i$ 则描述了“空间”本身的运动，体现了广义相对论中时间和空间不可分割的本质。

### ADM作用量与[哈密顿约束](@entry_id:161058)

将[3+1分解](@entry_id:140329)应用于完整的[引力](@entry_id:175476)作用量 $S = S_{EH} + S_{GHY}$，经过一番代数运算后，可以将其重写为所谓的**ADM作用量**：

$$ S_{ADM} = \frac{1}{16\pi G} \int dt d^3x \, N \sqrt{\gamma} \left( K_{ij}K^{ij} - K^2 + {}^{(3)}R \right) $$

这里，$\gamma$ 是三维空间度规 $\gamma_{ij}$ 的[行列式](@entry_id:142978)，${}^{(3)}R$ 是由 $\gamma_{ij}$ 计算出的三维[里奇标量](@entry_id:158934)曲率，而 $K_{ij}$ 是描述超曲面 $\Sigma_t$ 如何嵌入四维时空中的**外[曲率张量](@entry_id:181383) (extrinsic curvature tensor)**。它被定义为：

$$ K_{ij} = \frac{1}{2N} \left( \dot{\gamma}_{ij} - D_i N_j - D_j N_i \right) $$

其中，点号表示对时间坐标 $t$ 的[偏导数](@entry_id:146280) $\frac{\partial}{\partial t}$，$D_i$ 是与空间度规 $\gamma_{ij}$ 相容的协变导数。外曲率 $K_{ij}$ 衡量了空间切片的“弯曲”程度，它描述了空间度规随时间的演化。

ADM作用量的形式揭示了广义[相对论动力学](@entry_id:264218)的一个深刻特征：[拉格朗日量密度](@entry_id:156695)中不包含直递函数 $N$ 和[移位](@entry_id:145848)矢量 $N^i$ 的时间导数（$\dot{N}$ 和 $\dot{N}^i$）。在经典力学中，这意味着 $N$ 和 $N^i$ 不是真正的动力学自由度，而是**[拉格朗日乘子](@entry_id:142696) (Lagrange multipliers)**。它们的作用是施加约束。

对ADM作用量进行变分，我们可以得到[引力场](@entry_id:169425)的[演化方程](@entry_id:268137)和[约束方程](@entry_id:138140)：

*   对空间度规 $\gamma_{ij}$ 进行变分，得到的是关于 $\gamma_{ij}$ 的二阶（in time）**演化方程**。
*   对移位矢量 $N^i$ 进行变分并要求作用量取驻值，我们得到的是**[动量约束](@entry_id:160112)方程 (momentum constraint equation)**。这个变分过程最终导出一个守恒律形式的方程 $D_j (K^{ij} - \gamma^{ij} K) = 0$ [@problem_id:983346]。
*   对直递函数 $N$ 进行变分，我们得到的是**[哈密顿约束](@entry_id:161058)方程 (Hamiltonian constraint equation)**，也称为能量约束方程：$K_{ij}K^{ij} - K^2 + {}^{(3)}R = 0$。

这两个[约束方程](@entry_id:138140)是爱因斯坦场方程在[3+1分解](@entry_id:140329)下的[子集](@entry_id:261956)。它们不是[演化方程](@entry_id:268137)，而是在每一个时间切片 $\Sigma_t$ 上都必须满足的条件，限制了初始数据的选取。

### 正则[哈密顿表述](@entry_id:276227)

从[拉格朗日形式](@entry_id:145697)到哈密顿形式的转变通过勒让德变换完成。我们首先需要定义与动力学变量 $\gamma_{ij}$ 共轭的**[正则动量](@entry_id:155151) (canonical momentum)** $\pi^{ij}$：

$$ \pi^{ij} = \frac{\delta \mathcal{L}_{ADM}}{\delta \dot{\gamma}_{ij}} = \frac{\sqrt{\gamma}}{16\pi G} (K^{ij} - \gamma^{ij} K) $$

注意到，$\pi^{ij}$ 是一个[张量密度](@entry_id:191194)。由于[拉格朗日量](@entry_id:174593)不依赖于 $\dot{N}$ 和 $\dot{N}^i$，它们对应的[正则动量](@entry_id:155151) $\pi_N$ 和 $\pi^i$ 恒为零。这在狄拉克[约束系统](@entry_id:164587)理论中被称为**主约束 (primary constraints)**：

$$ \pi_N \approx 0, \quad \pi^i \approx 0 $$

这里的“$\approx$”符号表示此等式是在相空间中成立的弱等式。一个值得注意的细节是，[正则动量](@entry_id:155151)的定义依赖于[拉格朗日量](@entry_id:174593)的具体形式。如果在ADM[拉格朗日量](@entry_id:174593)上增加一个全时间导数项，例如 $\frac{\partial}{\partial t}(\sqrt{\gamma} \gamma_{ij} N^i N^j)$，虽然系统的运动方程不变，但移位矢量对应的[正则动量](@entry_id:155151)将不再为零 [@problem_id:983370]。然而，在标准的ADM表述中，我们处理的是主约束为零的情况。

根据狄拉克的[约束哈密顿系统](@entry_id:169165)理论，主约束必须在时间演化中保持不变。这一要求，即 $\dot{\pi}_N \approx 0$ 和 $\dot{\pi}^i \approx 0$，会导出所谓的**[次级约束](@entry_id:165897) (secondary constraints)**。

系统的正则[哈密顿量](@entry_id:172864) $H_c$ 可以通过勒让德变换得到，$H_c = \int d^3x (\pi^{ij}\dot{\gamma}_{ij} - \mathcal{L}_{ADM})$。计算结果表明，它可以写成直递函数和移位矢量与两个函数 $\mathcal{H}$ 和 $\mathcal{H}_i$ 的[线性组合](@entry_id:154743)：

$$ H_c = \int d^3x (N\mathcal{H} + N^i\mathcal{H}_i) $$

函数 $\mathcal{H}$ 和 $\mathcal{H}_i$ 是正则变量 $(\gamma_{ij}, \pi^{kl})$ 的函数。时间演化由泊松括号给出。约束的保持条件 $\dot{\pi}_N(x) = \{\pi_N(x), H_c\} \approx 0$ 直接导致了[次级约束](@entry_id:165897) $\mathcal{H} \approx 0$。这个 $\mathcal{H}$ 正是[哈密顿约束](@entry_id:161058)密度，其表达式为：

$$ \mathcal{H} = \frac{16\pi G}{\sqrt{\gamma}} \left( \pi_{ij}\pi^{ij} - \frac{1}{2}(\gamma_{kl}\pi^{kl})^2 \right) - \sqrt{\gamma} {}^{(3)}R \approx 0 $$

类似地，约束的保持条件 $\dot{\pi}^i(x) = \{\pi^i(x), H_c\} \approx 0$ 导致了[动量约束](@entry_id:160112) $\mathcal{H}_i \approx 0$，其中 [@problem_id:983251]：

$$ \mathcal{H}_i = -2 D_j \pi_i^j \approx 0 $$

其中 $\pi_i^j = \gamma_{ik}\pi^{kj}$。

$\mathcal{H}_i = 0$ 和 $\mathcal{H} = 0$ 正是我们在[拉格朗日形式](@entry_id:145697)下通过对 $N^i$ 和 $N$ 变分得到的[动量约束](@entry_id:160112)和[哈密顿约束](@entry_id:161058)的哈密顿版本。这个结果揭示了一个深刻的结构：在[广义相对论的哈密顿表述](@entry_id:187063)中，全部动力学都包含在约束之中。[哈密顿量](@entry_id:172864)本身就是约束的[线性组合](@entry_id:154743)。这也从另一个角度解释了广义相对论的“[时间问题](@entry_id:202825)”：由于[哈密顿量](@entry_id:172864)在约束壳上为零，系统的演化显得十分特殊。

我们也可以从四维的角度直接窥见[哈密顿约束](@entry_id:161058)的起源。考虑一个[静态时空](@entry_id:184720)，$g_{0i}=0$。爱因斯坦-[希尔伯特作用量](@entry_id:204075)中包含一项 $\sqrt{-g} g^{ij}\Gamma^0_{i0}\Gamma^0_{j0}$，它与 $g_{00}$ 的空间导数平方有关。通过对这一项关于 $g_{00}$ 进行变分，我们会得到一个包含 $g_{00}$ 的空间[拉普拉斯算子](@entry_id:146319)的项，这正是静态[弱场极限](@entry_id:199592)下牛顿引力势所满足的泊松方程的先兆，也构成了[哈密顿约束](@entry_id:161058)方程的一部分 [@problem_id:983416]。

### 替代表述与应用

除了标准的[度规表述](@entry_id:273097)，广义相对论及其推广还存在其他有趣的表述形式。其中之一是**[帕拉蒂尼表述](@entry_id:195687) (Palatini formalism)**。在此表述中，度规 $g_{\mu\nu}$ 和[仿射联络](@entry_id:160152) $\Gamma^\lambda_{\mu\nu}$ 被视为两个独立的场。作用量同时是这两个场的泛函。例如，对于一个[标量-张量理论](@entry_id:161861)，作用量可以写为 $S = \int d^4 x \sqrt{-g} ( \phi R(\Gamma) + \mathcal{L}_{matter}(\phi, g) )$。对联络 $\Gamma$ 进行变分会得到一个方程，该方程将 $\Gamma$ 与度规和[标量场](@entry_id:151443)联系起来。在特定情况下，例如对于 $\phi R$ 型[引力](@entry_id:175476)，[变分方程](@entry_id:635018) $\nabla^\Gamma_\lambda (\sqrt{-g} \phi g^{\mu\nu}) = 0$ 的解是，$\Gamma$ 必须是与共形变换后的度规 $\tilde{g}_{\mu\nu} = \phi g_{\mu\nu}$ 相容的[列维-奇维塔联络](@entry_id:161107)。这意味着，即使我们从一个更基本的层面出发，认为度规和联络是独立的，[动力学方程](@entry_id:751029)也会强制联络成为我们所熟知的黎曼几何中的形式 [@problem_id:983423]。

[哈密顿表述](@entry_id:276227)最深远的应用之一是在**正则量子引力 (Canonical Quantum Gravity)** 领域。其基本思想是将经典理论中的正则变量（如 $\gamma_{ij}$ 和 $\pi^{kl}$）提升为[量子算符](@entry_id:137703)，并满足相应的对易关系。经典理论中的约束方程则变为作用在宇宙[波函数](@entry_id:147440) $\Psi$ 上的算符方程。

特别地，[哈密顿约束](@entry_id:161058) $\hat{\mathcal{H}}\Psi = 0$ 成为了量子引力理论的中心方程，被称为**[惠勒-德威特方程](@entry_id:160159) (Wheeler-DeWitt equation)**。[动量约束](@entry_id:160112) $\hat{\mathcal{H}}_i\Psi = 0$ 则保证了[波函数](@entry_id:147440)在空间坐标变换下的[不变性](@entry_id:140168)。

为了理解[惠勒-德威特方程](@entry_id:160159)的含义，我们可以考虑一个简化的**“迷你[超空间](@entry_id:155405)” (minisuperspace)** 模型，例如一个真空、空间平坦的对角 Bianchi I 型宇宙。其度规由三个方向的尺度因子 $a_i(t)$ 描述。这个系统的自由度可以被[参数化](@entry_id:272587)为描述宇宙体积的变量 $\alpha$ 和描述各向异性的变量 $\beta_+, \beta_-$。在这种情况下，[哈密顿约束](@entry_id:161058)算符的动能部分简化为一个在 $(\alpha, \beta_+, \beta_-)$ 构成的迷你[超空间](@entry_id:155405)上的三维波算符：$\hat{H}_{kin} = \frac{\partial^2}{\partial \alpha^2} - \frac{\partial^2}{\partial \beta_+^2} - \frac{\partial^2}{\partial \beta_-^2}$。[惠勒-德威特方程](@entry_id:160159) $\hat{H}\Psi = 0$ 就变成了一个关于宇宙[波函数](@entry_id:147440) $\Psi(\alpha, \beta_+, \beta_-)$ 的[偏微分方程](@entry_id:141332)。通过求解这个方程，我们可以探讨宇宙在量子层面的行为，例如宇宙的创生和早期演化 [@problem_id:983254]。这展示了[哈密顿表述](@entry_id:276227)如何为我们提供一个探索时空量子本质的强大框架。