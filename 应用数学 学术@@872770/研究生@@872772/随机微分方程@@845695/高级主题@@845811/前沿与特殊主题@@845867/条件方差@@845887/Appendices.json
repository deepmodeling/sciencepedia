{"hands_on_practices": [{"introduction": "掌握条件方差的第一步是能够根据其基本定义直接进行计算。这个练习提供了一个清晰、具体的场景，帮助我们理解当获得额外信息时（例如，知道两个随机变量的和），一个随机变量的概率分布和方差会如何改变。通过解决这个问题 [@problem_id:1351945]，你将练习在给定条件下，如何为离散随机变量计算新的概率质量函数，并进而计算其期望和方差。", "problem": "一位质量控制工程师正在分析来自两条独立生产线（Alpha 和 Beta）的微芯片缺陷。设 $X$ 为从 Alpha 生产线随机抽取的一批产品中的微小缺陷数量的随机变量，设 $Y$ 为从 Beta 生产线随机抽取的一批产品中的微小缺陷数量的随机变量。两条生产线是相互独立的。\n\n$X$ 的概率质量函数由下式给出：\n$P(X=1) = 0.1$, $P(X=2) = 0.2$, $P(X=3) = 0.3$, and $P(X=4) = 0.4$.\n\n$Y$ 的概率质量函数由下式给出：\n$P(Y=1) = 0.4$, $P(Y=2) = 0.3$, $P(Y=3) = 0.2$, and $P(Y=4) = 0.1$.\n\n对于两条生产线，这些是缺陷数量唯一可能的结果。\n在一次检查中，从 Alpha 生产线取出一批产品，从 Beta 生产线取出一批产品。观察到这两批产品的总缺陷数恰好为 5。\n\n根据这一观察结果，计算来自 Alpha 生产线批次的缺陷数量的方差。请用精确分数表示你的答案。", "solution": "设 $X$ 和 $Y$ 相互独立，其支撑集为 $\\{1,2,3,4\\}$ 且\n$$P(X=1)=\\frac{1}{10},\\quad P(X=2)=\\frac{1}{5},\\quad P(X=3)=\\frac{3}{10},\\quad P(X=4)=\\frac{2}{5},$$\n$$P(Y=1)=\\frac{2}{5},\\quad P(Y=2)=\\frac{3}{10},\\quad P(Y=3)=\\frac{1}{5},\\quad P(Y=4)=\\frac{1}{10}.$$\n设 $S=X+Y$，并以事件 $S=5$ 为条件。根据独立性，\n$$P(X=x\\mid S=5)=\\frac{P(X=x,Y=5-x)}{P(S=5)}=\\frac{P(X=x)P(Y=5-x)}{\\sum_{k=1}^{4}P(X=k)P(Y=5-k)},$$\n其中 $x\\in\\{1,2,3,4\\}$。\n\n计算 $S=5$ 的联合概率项：\n$$P(X=1,Y=4)=\\frac{1}{10}\\cdot\\frac{1}{10}=\\frac{1}{100},$$\n$$P(X=2,Y=3)=\\frac{1}{5}\\cdot\\frac{1}{5}=\\frac{1}{25}=\\frac{4}{100},$$\n$$P(X=3,Y=2)=\\frac{3}{10}\\cdot\\frac{3}{10}=\\frac{9}{100},$$\n$$P(X=4,Y=1)=\\frac{2}{5}\\cdot\\frac{2}{5}=\\frac{4}{25}=\\frac{16}{100}.$$\n因此\n$$P(S=5)=\\frac{1}{100}+\\frac{4}{100}+\\frac{9}{100}+\\frac{16}{100}=\\frac{30}{100}=\\frac{3}{10}.$$\n所以，\n$$P(X=1\\mid S=5)=\\frac{\\frac{1}{100}}{\\frac{3}{10}}=\\frac{1}{30},\\quad P(X=2\\mid S=5)=\\frac{\\frac{4}{100}}{\\frac{3}{10}}=\\frac{2}{15},$$\n$$P(X=3\\mid S=5)=\\frac{\\frac{9}{100}}{\\frac{3}{10}}=\\frac{3}{10},\\quad P(X=4\\mid S=5)=\\frac{\\frac{16}{100}}{\\frac{3}{10}}=\\frac{8}{15}.$$\n\n计算条件期望：\n$$\\mathbb{E}[X\\mid S=5]=1\\cdot\\frac{1}{30}+2\\cdot\\frac{2}{15}+3\\cdot\\frac{3}{10}+4\\cdot\\frac{8}{15}.$$\n通分到分母 $30$，可得\n$$\\mathbb{E}[X\\mid S=5]=\\frac{1}{30}+\\frac{8}{30}+\\frac{27}{30}+\\frac{64}{30}=\\frac{100}{30}=\\frac{10}{3}.$$\n\n计算二阶矩：\n$$\\mathbb{E}[X^{2}\\mid S=5]=1^{2}\\cdot\\frac{1}{30}+2^{2}\\cdot\\frac{2}{15}+3^{2}\\cdot\\frac{3}{10}+4^{2}\\cdot\\frac{8}{15}.$$\n再次通分到分母 $30$，\n$$\\mathbb{E}[X^{2}\\mid S=5]=\\frac{1}{30}+\\frac{16}{30}+\\frac{81}{30}+\\frac{256}{30}=\\frac{354}{30}=\\frac{59}{5}.$$\n\n使用方差恒等式 $\\operatorname{Var}(X\\mid S=5)=\\mathbb{E}[X^{2}\\mid S=5]-\\left(\\mathbb{E}[X\\mid S=5]\\right)^{2}$ 得到\n$$\\operatorname{Var}(X\\mid S=5)=\\frac{59}{5}-\\left(\\frac{10}{3}\\right)^{2}=\\frac{59}{5}-\\frac{100}{9}=\\frac{531-500}{45}=\\frac{31}{45}.$$", "answer": "$$\\boxed{\\frac{31}{45}}$$", "id": "1351945"}, {"introduction": "在许多科学和工程模型中，不确定性来自多个阶段或多个来源。总方差定律是一个极其有用的工具，它能帮助我们将一个变量的总方差分解为不同部分。这个练习 [@problem_id:1292256] 引导我们应用总方差定律 $\\text{Var}(Y) = \\mathbb{E}[\\text{Var}(Y|X)] + \\text{Var}(\\mathbb{E}[Y|X])$，在一个两阶段的随机实验中，这使我们能够清晰地区分由第二阶段内在随机性产生的方差和由第一阶段不确定性引入的方差。", "problem": "考虑一个两阶段的随机实验。在第一阶段，一个随机变量 $X$ 从区间 $[-1, 1]$ 上的连续均匀分布中生成。在第二阶段，以 $X=x$ 为条件，第二个随机变量 $Y$ 从均值为 $x$、方差为 $x^2 + 1$ 的正态分布中生成。\n\n确定随机变量 $Y$ 的总方差，记为 $\\text{Var}(Y)$。\n\n将您的答案表示为单个闭式解析表达式，该表达式可以是一个分数。", "solution": "设 $X \\sim \\text{Uniform}([-1,1])$，因此其密度函数为 $f_{X}(x) = \\frac{1}{2}$，其中 $x \\in [-1,1]$。计算其前两阶矩：\n$$\n\\mathbb{E}[X] = \\int_{-1}^{1} x \\cdot \\frac{1}{2} \\, dx = 0,\n$$\n$$\n\\mathbb{E}[X^{2}] = \\int_{-1}^{1} x^{2} \\cdot \\frac{1}{2} \\, dx = \\frac{1}{2} \\left[ \\frac{x^{3}}{3} \\right]_{-1}^{1} = \\frac{1}{2} \\cdot \\frac{2}{3} = \\frac{1}{3}.\n$$\n因此，\n$$\n\\mathrm{Var}(X) = \\mathbb{E}[X^{2}] - (\\mathbb{E}[X])^{2} = \\frac{1}{3}.\n$$\n在给定 $X=x$ 的条件下，我们有 $Y|X=x \\sim \\mathcal{N}(x, x^{2}+1)$，所以\n$$\n\\mathbb{E}[Y \\mid X] = X, \\qquad \\mathrm{Var}(Y \\mid X) = X^{2} + 1.\n$$\n根据全方差公式，\n$$\n\\mathrm{Var}(Y) = \\mathbb{E}[\\mathrm{Var}(Y \\mid X)] + \\mathrm{Var}(\\mathbb{E}[Y \\mid X]).\n$$\n计算每一项：\n$$\n\\mathbb{E}[\\mathrm{Var}(Y \\mid X)] = \\mathbb{E}[X^{2} + 1] = \\mathbb{E}[X^{2}] + 1 = \\frac{1}{3} + 1 = \\frac{4}{3},\n$$\n$$\n\\mathrm{Var}(\\mathbb{E}[Y \\mid X]) = \\mathrm{Var}(X) = \\frac{1}{3}.\n$$\n因此，\n$$\n\\mathrm{Var}(Y) = \\frac{4}{3} + \\frac{1}{3} = \\frac{5}{3}.\n$$", "answer": "$$\\boxed{\\frac{5}{3}}$$", "id": "1292256"}, {"introduction": "条件方差在统计推断和信号处理等领域有着广泛的应用，它通常被用作衡量在获得数据后参数不确定性的一种度量。这个问题 [@problem_id:1351903] 模拟了一个经典的通信场景：从一个被噪声污染的观测信号中推断原始发送的信号。通过计算条件方差 $\\text{Var}(\\mu | X = x)$，我们可以量化在观测到具体数值 $x$ 后，关于原始信号 $\\mu$ 的剩余不确定性，深刻体会贝叶斯推断中“数据更新信念”的核心思想。", "problem": "在一个二进制通信系统中，发射机发送一个信号电平 $\\mu$，该电平从集合 $\\{-1, 1\\}$ 中随机选择。这两个电平是等概率的，即 $P(\\mu = 1) = P(\\mu = -1) = 1/2$。信号被加性噪声所干扰，该噪声被建模为一个随机变量 $N$，服从均值为 0、方差为 1 的标准正态分布。接收机测量到最终信号 $X = \\mu + N$。一位工程师在接收机处观察到一个具体值 $X=x$。基于这个观测值，该工程师想要量化他们对于最初发送的信号电平 $\\mu$ 是哪一个的剩余不确定性。\n\n作为这种不确定性的度量，计算原始信号 $\\mu$ 在观测到 $X=x$ 条件下的方差。也就是说，求出 $\\text{Var}(\\mu | X = x)$ 的表达式。\n\n您的答案应该是一个关于 $x$ 的闭式解析表达式。", "solution": "给定一个二进制输入 $\\mu \\in \\{-1,1\\}$，其概率为 $P(\\mu=1)=P(\\mu=-1)=\\frac{1}{2}$，加性噪声 $N \\sim \\mathcal{N}(0,1)$ 且与 $\\mu$ 独立，观测值为 $X=\\mu+N$。对于一个实现的观测值 $X=x$，我们要求 $\\text{Var}(\\mu \\mid X=x)$。\n\n根据贝叶斯法则，\n$$\nP(\\mu=1 \\mid X=x)=\\frac{f_{X \\mid \\mu}(x \\mid 1) P(\\mu=1)}{f_{X \\mid \\mu}(x \\mid 1) P(\\mu=1)+f_{X \\mid \\mu}(x \\mid -1) P(\\mu=-1)}.\n$$\n由于 $X \\mid \\mu=m$ 是均值为 $m$、方差为 1 的高斯分布，其密度函数为\n$$\nf_{X \\mid \\mu}(x \\mid m)=\\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(x-m)^{2}}{2}\\right).\n$$\n使用 $P(\\mu=1)=P(\\mu=-1)=\\frac{1}{2}$ 并消去公因数，我们得到\n$$\nP(\\mu=1 \\mid X=x)=\\frac{\\exp\\!\\left(-\\frac{(x-1)^{2}}{2}\\right)}{\\exp\\!\\left(-\\frac{(x-1)^{2}}{2}\\right)+\\exp\\!\\left(-\\frac{(x+1)^{2}}{2}\\right)}.\n$$\n化简指数部分：\n$$\n-\\frac{(x-1)^{2}}{2}=-\\frac{x^{2}}{2}+x-\\frac{1}{2}, \n\\quad\n-\\frac{(x+1)^{2}}{2}=-\\frac{x^{2}}{2}-x-\\frac{1}{2}.\n$$\n分子和分母同乘以 $\\exp\\!\\left(\\frac{x^{2}}{2}+\\frac{1}{2}\\right)$ 得到\n$$\nP(\\mu=1 \\mid X=x)=\\frac{\\exp(x)}{\\exp(x)+\\exp(-x)}=\\frac{1}{1+\\exp(-2x)}.\n$$\n因此，\n$$\nP(\\mu=-1 \\mid X=x)=1-P(\\mu=1 \\mid X=x)=\\frac{1}{1+\\exp(2x)}.\n$$\n条件均值为\n$$\n\\mathbb{E}[\\mu \\mid X=x]=(+1)P(\\mu=1 \\mid X=x)+(-1)P(\\mu=-1 \\mid X=x)\n=2P(\\mu=1 \\mid X=x)-1=\\tanh(x),\n$$\n因为\n$$\n2\\left(\\frac{1}{1+\\exp(-2x)}\\right)-1=\\frac{1-\\exp(-2x)}{1+\\exp(-2x)}=\\tanh(x).\n$$\n接下来，使用 $\\text{Var}(\\mu \\mid X=x)=\\mathbb{E}[\\mu^{2} \\mid X=x]-\\big(\\mathbb{E}[\\mu \\mid X=x]\\big)^{2}$。因为 $\\mu \\in \\{-1,1\\}$，我们有 $\\mu^{2}=1$ 是确定性的，因此 $\\mathbb{E}[\\mu^{2} \\mid X=x]=1$。所以，\n$$\n\\text{Var}(\\mu \\mid X=x)=1-\\tanh^{2}(x)=\\frac{1}{\\cosh^{2}(x)}.\n$$\n两种形式都是关于 $x$ 的等价闭式表达式。", "answer": "$$\\boxed{1-\\tanh^{2}(x)}$$", "id": "1351903"}]}