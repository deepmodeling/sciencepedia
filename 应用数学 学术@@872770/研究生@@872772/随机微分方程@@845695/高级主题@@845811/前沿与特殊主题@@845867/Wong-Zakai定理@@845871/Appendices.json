{"hands_on_practices": [{"introduction": "为了真正理解Wong-Zakai定理，我们必须首先探究其核心动机：为什么由平滑噪声驱动的常微分方程（ODE）的极限会产生一个随机微分方程（SDE），并且需要一种特殊的微积分？这个练习将通过分析布朗运动的分段线性近似来揭示答案。通过计算其二次变差的极限 [@problem_id:3004534]，你将亲手验证布朗运动路径的内在“粗糙度”，这正是随机微积分与经典微积分分道扬镳的根本原因。", "problem": "设 $\\{W_{t}\\}_{t \\in [0,T]}$ 是一个定义在带滤概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\ge 0},\\mathbb{P})$ 上的标准一维布朗运动，且 $W_{0}=0$。对于 $\\delta>0$，考虑均匀划分 $\\mathcal{P}_{\\delta}=\\{t_{k}=k\\delta: k=0,1,\\dots,N_{\\delta}\\}$，其中 $N_{\\delta}=\\lfloor T/\\delta \\rfloor$，并定义多边形（分段线性）插值 $W^{\\delta}$ 为\n$$\nW^{\\delta}_{t} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big), \\quad t \\in [t_{k},t_{k+1}), \\quad k=0,1,\\dots,N_{\\delta}-1.\n$$\n对于 $t \\in [0,T]$，定义 $W^{\\delta}$ 沿其构造划分的基于网格的二次变差为\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} \\Big(W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}\\Big)^{2}, \\quad \\text{其中} \\quad N_{t}^{\\delta}=\\left\\lfloor \\frac{t}{\\delta} \\right\\rfloor.\n$$\n仅从布朗运动的定义性质（平稳独立高斯增量，且 $\\mathbb{E}[W_{t}]=0$ 和 $\\operatorname{Var}(W_{t})=t$）以及上述定义出发，完成以下任务：\n\n1) 用布朗增量 $\\Delta W_{k}=W_{t_{k+1}}-W_{t_{k}}$ 表示 $[W^{\\delta}]_{t}$。\n\n2) 证明当 $\\delta \\to 0$ 时，$[W^{\\delta}]_{t}$ 依概率收敛到 $t$，并且沿二进序列 $\\delta_{n}=2^{-n}$，有几乎必然收敛 $[W^{\\delta_{n}}]_{t} \\to t$。\n\n3) 仅使用基本定义，简要解释在 Wong–Zakai 设定下，当 $\\delta \\to 0$ 时，此极限如何确定由 $W^{\\delta}$ 驱动的常微分方程解的有效极限微积分。\n\n请给出当 $\\delta \\to 0$ 时 $[W^{\\delta}]_{t}$ 极限的精确封闭形式表达式（无单位）。最终答案必须是单一的解析表达式。", "solution": "这是一个随机分析中有效且适定的练习题。它要求通过分析布朗运动的多边形近似来展示其一个基本性质——非零的二次变差。所有定义都是标准的，任务在数学上是合理的。\n\n解答按要求分为三个部分进行。\n\n第1部分：$[W^{\\delta}]_{t}$ 的表达式\n\n问题将多边形近似 $W^{\\delta}$ 的基于网格的二次变差定义为\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} \\Big(W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}\\Big)^{2}\n$$\n其中 $t_k = k\\delta$ 是划分 $\\mathcal{P}_{\\delta}$ 的点，且 $N_{t}^{\\delta}=\\lfloor t/\\delta \\rfloor$。这部分的核心是计算增量 $W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}$。\n\n多边形插值 $W^{\\delta}_{t}$ 在区间 $t \\in [t_{k}, t_{k+1})$ 上的定义为\n$$\nW^{\\delta}_{t} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big)\n$$\n根据构造，该插值在划分点 $t_k$ 处与原始布朗运动 $W_{t}$ 的值相匹配。为了验证这一点，我们计算 $W^{\\delta}_{t}$ 在 $t=t_k$ 处的值：\n$$\nW^{\\delta}_{t_{k}} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t_{k}-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big) \\;=\\; W_{t_{k}} \\;+\\; 0 \\cdot \\Big(W_{t_{k+1}}-W_{t_{k}}\\Big) \\;=\\; W_{t_{k}}\n$$\n为了找到在 $t_{k+1}$ 处的值，我们考虑划分中的下一个区间，该区间从 $t_{k+1}$ 开始。应用相同的公式，只是索引加一。将 $t=t_{k+1}$ 代入区间 $[t_{k+1}, t_{k+2})$ 的定义中可得：\n$$\nW^{\\delta}_{t_{k+1}} \\;=\\; W_{t_{k+1}} \\;+\\; \\frac{t_{k+1}-t_{k+1}}{t_{k+2}-t_{k+1}}\\Big(W_{t_{k+2}}-W_{t_{k+1}}\\Big) \\;=\\; W_{t_{k+1}}\n$$\n因此，多边形近似在两个连续划分点之间的增量与布朗运动本身的增量相同：\n$$\nW^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}} \\;=\\; W_{t_{k+1}}-W_{t_{k}}\n$$\n问题将此增量记为 $\\Delta W_{k}$。将其代入 $[W^{\\delta}]_{t}$ 的定义中，我们得到：\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (W_{t_{k+1}}-W_{t_{k}})^{2} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\Delta W_{k})^{2}\n$$\n\n第2部分：收敛性证明\n\n令 $S_{t}^{\\delta} = [W^{\\delta}]_{t} = \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\Delta W_{k})^{2}$。已知布朗运动具有平稳、独立的高斯增量。增量 $\\Delta W_{k} = W_{t_{k+1}}-W_{t_{k}}$ 在时长为 $t_{k+1}-t_k = \\delta$ 的时间区间上是一个均值为 $0$、方差为 $\\delta$ 的正态随机变量，即 $\\Delta W_k \\sim \\mathcal{N}(0, \\delta)$。\n我们可以用一个标准正态变量 $Z_k \\sim \\mathcal{N}(0, 1)$ 来表示 $\\Delta W_k$，即 $\\Delta W_k = \\sqrt{\\delta}Z_k$，其中 $\\{Z_k\\}$ 是一个独立同分布（i.i.d.）的随机变量序列。\n因此，$S_{t}^{\\delta}$ 可以改写为：\n$$\nS_{t}^{\\delta} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\sqrt{\\delta} Z_k)^2 \\;=\\; \\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\n$$\n为了证明收敛性，我们首先计算 $S_{t}^{\\delta}$ 的期望。$Z_k^2$ 的期望是 $\\mathbb{E}[Z_k^2] = \\operatorname{Var}(Z_k) + (\\mathbb{E}[Z_k])^2 = 1 + 0^2 = 1$。\n$$\n\\mathbb{E}[S_{t}^{\\delta}] \\;=\\; \\mathbb{E}\\left[\\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\\right] \\;=\\; \\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} \\mathbb{E}[Z_k^2] \\;=\\; \\delta \\cdot N_{t}^{\\delta} \\cdot 1 \\;=\\; \\delta N_{t}^{\\delta}\n$$\n由于 $N_{t}^{\\delta} = \\lfloor t/\\delta \\rfloor$，我们有不等式 $t/\\delta - 1  N_{t}^{\\delta} \\le t/\\delta$，这意味着 $t-\\delta  \\delta N_{t}^{\\delta} \\le t$。当 $\\delta \\to 0$ 时，我们得出结论 $\\lim_{\\delta \\to 0} \\mathbb{E}[S_{t}^{\\delta}] = t$。\n\n为了证明依概率收敛，我们证明 $L^2$ 收敛，这是一种更强的收敛模式。这需要证明 $\\mathbb{E}[(S_{t}^{\\delta} - t)^2] \\to 0$。我们分解均方误差：\n$$\n\\mathbb{E}[(S_{t}^{\\delta} - t)^2] = \\operatorname{Var}(S_{t}^{\\delta}) + (\\mathbb{E}[S_{t}^{\\delta}]-t)^2\n$$\n我们已经确定 $(\\mathbb{E}[S_{t}^{\\delta}]-t)^2 \\to 0$。现在我们计算方差。由于 $Z_k$ 是独立的，所以 $Z_k^2$ 也是独立的。\n$$\n\\operatorname{Var}(S_{t}^{\\delta}) \\;=\\; \\operatorname{Var}\\left(\\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\\right) \\;=\\; \\delta^2 \\sum_{k=0}^{N_{t}^{\\delta}-1} \\operatorname{Var}(Z_k^2)\n$$\n$Z_k^2$ 的方差是 $\\operatorname{Var}(Z_k^2) = \\mathbb{E}[Z_k^4] - (\\mathbb{E}[Z_k^2])^2$。对于标准正态变量，四阶矩是 $\\mathbb{E}[Z_k^4] = 3$。因此，$\\operatorname{Var}(Z_k^2) = 3 - 1^2 = 2$。\n$$\n\\operatorname{Var}(S_{t}^{\\delta}) \\;=\\; \\delta^2 \\sum_{k=0}^{N_{t}^{\\delta}-1} 2 \\;=\\; 2\\delta^2 N_{t}^{\\delta}\n$$\n使用界 $N_{t}^{\\delta} \\le t/\\delta$，我们得到 $\\operatorname{Var}(S_{t}^{\\delta}) \\le 2\\delta^2 (t/\\delta) = 2t\\delta$。当 $\\delta \\to 0$ 时，$\\operatorname{Var}(S_{t}^{\\delta}) \\to 0$。\n由于均方误差中的两项都趋于零，所以 $\\mathbb{E}[(S_{t}^{\\delta} - t)^2] \\to 0$。这意味着 $S_{t}^{\\delta}$ 在 $L^2$ 中收敛到 $t$，因此也依概率收敛。\n\n对于沿二进序列 $\\delta_n = 2^{-n}$ 的几乎必然收敛，我们令 $S_n = S_t^{\\delta_n}$。我们应用切比雪夫不等式和 Borel-Cantelli 引理。对于任何 $\\epsilon > 0$：\n$$\n\\mathbb{P}(|S_n - \\mathbb{E}[S_n]| > \\epsilon) \\le \\frac{\\operatorname{Var}(S_n)}{\\epsilon^2}\n$$\n方差为 $\\operatorname{Var}(S_n) = 2\\delta_n^2 N_{t}^{\\delta_n} \\le 2t\\delta_n = 2t \\cdot 2^{-n}$。所以，\n$$\n\\sum_{n=1}^{\\infty} \\mathbb{P}(|S_n - \\mathbb{E}[S_n]| > \\epsilon) \\le \\sum_{n=1}^{\\infty} \\frac{2t \\cdot 2^{-n}}{\\epsilon^2} = \\frac{2t}{\\epsilon^2} \\sum_{n=1}^{\\infty} \\left(\\frac{1}{2}\\right)^n\n$$\n这是一个收敛的几何级数。根据第一 Borel-Cantelli 引理，$S_n - \\mathbb{E}[S_n] \\to 0$ 几乎必然。因为我们也知道 $\\mathbb{E}[S_n] \\to t$，我们可以得出结论 $S_n \\to t$ 几乎必然。\n\n第3部分：与 Wong-Zakai 定理的联系\n\nWong-Zakai 定理处理的是由随机过程（如白噪声）的平滑近似驱动的常微分方程（ODE）解的极限问题。在我们的问题中，方程是 $dy^{\\delta}_{t} = f(y^{\\delta}_{t}) dW^{\\delta}_{t}$，其中 $W^{\\delta}_{t}$ 是一个分段可微函数。对于任何有限的 $\\delta > 0$，这是一个标准的 ODE，其解遵循普通微积分的法则，包括经典的链式法则：$d(g(y^{\\delta}_{t})) = g'(y^{\\delta}_{t}) dy^{\\delta}_{t}$。\n\n当 $\\delta \\to 0$ 时，近似 $W^{\\delta}_{t}$ 收敛于布朗运动 $W_t$，而解 $y^{\\delta}_{t}$ 收敛于某个随机微分方程（SDE）的解 $Y_t$。核心问题是确定极限 SDE 的正确“微积分”类型（Itō 或 Stratonovich）。\n\n微积分类型的选择取决于二次变差的行为。在普通微积分中，任何平滑函数的二次变差都为零。例如，对于一个 $C^1$ 函数 $\\phi(t)$，增量的平方和为 $\\sum (\\phi(t_{k+1})-\\phi(t_k))^2 \\approx \\sum (\\phi'(t_k)\\delta)^2 = \\delta \\sum (\\phi'(t_k))^2\\delta \\to 0$（当 $\\delta \\to 0$ 时）。普通微积分的法则依赖于此性质。\n\n然而，正如我们在第2部分中证明的，布朗近似的二次变差在极限中不为零：$[W^{\\delta}]_t \\to t$。极限过程 $W_t$ 具有非零的二次变差，$[W]_t = t$。正是这个定义性特征使得一种特殊的随机微积分成为必要。\n\nStratonovich 积分的定义方式保留了经典的链式法则，就像用于 $y^{\\delta}_{t}$ 的 ODE 一样。因此，ODE 解 $y^{\\delta}_{t}$ 收敛于 Stratonovich SDE $dY_t = f(Y_t) \\circ dW_t$ 的解是自然的。支配近似的微积分结构在极限中得以保持。\n\n相比之下，Itō 积分是使用非预见性被积函数定义的，这导致了一个不同的链式法则（Itō 引理），其中包含一个二阶项：对于 Itō SDE $dY_t=f(Y_t)dW_t$，有 $d(g(Y_t)) = g'(Y_t)f(Y_t)dW_t + \\frac{1}{2}g''(Y_t)f(Y_t)^2 dt$。这个修正项是规则 $(dW_t)^2 = dt$ 的直接结果，即布朗运动的非零二次变差。\n\n总而言之，结果 $[W^{\\delta}]_t \\to t$ 表明，平滑近似 $W^{\\delta}_t$ 将布朗运动的非零二次变差“带入”了极限。因为极限前的 ODE 遵循普通微积分法则，所以极限 SDE 必须是同样能保留这些法则的类型，而这恰恰是 Stratonovich SDE。", "answer": "$$\\boxed{t}$$", "id": "3004534"}, {"introduction": "在理解了非零二次变差是随机微积分的基石之后，我们接下来将探讨这一特性在实践中如何体现。这个练习 [@problem_id:3004514] 要求你分析一个常用于数值求解SDE的梯形法则格式。通过推导其在噪声项上的极限行为，你将直接导出从Stratonovich积分转换到Itô积分时出现的著名修正项，即Wong-Zakai修正，从而将前一个练习的抽象概念与具体的计算结果联系起来。", "problem": "考虑一个由标准布朗运动的光滑近似驱动的一维常微分方程 (ODE)，其定义如下。设 $W$ 为标准布朗运动，对于每个 $\\delta>0$，设 $W^{\\delta}$ 是通过将 $W$ 与对称的磨光核 $\\rho_{\\delta}$ 进行卷积得到的光滑近似，因此 $W^{\\delta}$ 具有经典时间导数 $\\dot{W}^{\\delta}$。设 $f:\\mathbb{R}\\to\\mathbb{R}$ 和 $g:\\mathbb{R}\\to\\mathbb{R}$ 是具有有界一阶和二阶导数的二次连续可微函数。对于一个固定的 $\\delta>0$，考虑路径常微分方程\n$$\n\\frac{dX_{t}^{\\delta}}{dt} \\;=\\; f\\!\\big(X_{t}^{\\delta}\\big) \\;+\\; g\\!\\big(X_{t}^{\\delta}\\big)\\,\\dot{W}_{t}^{\\delta}, \n\\qquad X_{0}^{\\delta}=x_{0}.\n$$\n设 $0=t_{0}  t_1  \\dots  t_n = T$ 为一个时间分割，网格尺寸为 $h=t_{k+1}-t_k$。考虑以下基于梯形法则的时间步进格式：\n$$\nX_{k+1}^{\\delta} = X_{k}^{\\delta} + \\frac{1}{2}\\Big(f\\big(X_{k}^{\\delta}\\big)+f\\big(X_{k+1}^{\\delta}\\big)\\Big) h + \\frac{1}{2}\\Big(g\\big(X_{k}^{\\delta}\\big)+g\\big(X_{k+1}^{\\delta}\\big)\\Big)\\,\\Delta W_{k}^{\\delta}\n$$\n其中 $X_k^\\delta \\approx X_{t_k}^\\delta$ 且 $\\Delta W_k^\\delta = W_{t_{k+1}}^\\delta - W_{t_k}^\\delta$。假设该格式在 $h \\to 0$ 时收敛于 ODE 解，并且当 $\\delta \\to 0$ 时，我们有收敛性 $W^\\delta \\to W$ 和 $X^\\delta \\to X$。请分析当 $\\delta, h \\to 0$ 时该格式的极限行为，以确定极限过程 $X_t$ 所满足的等价 Itô SDE 的漂移项。具体来说，如果 Itô SDE 的形式为 $dX_t = (f(X_t) + C(X_t))dt + g(X_t)dW_t$，请求出漂移修正函数 $C(x)$。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 过程 $X_t^\\delta$ 由一个固定 $\\delta > 0$ 的常微分方程 (ODE) 控制：\n$$ \\frac{dX_{t}^{\\delta}}{dt} = f\\big(X_{t}^{\\delta}\\big) + g\\big(X_{t}^{\\delta}\\big)\\dot{W}_{t}^{\\delta}, \\quad X_{0}^{\\delta}=x_{0} $$\n- $W$ 是标准布朗运动。$W^\\delta$ 是其光滑近似，具有经典导数 $\\dot{W}^\\delta$。\n- 函数 $f, g: \\mathbb{R} \\to \\mathbb{R}$ 是二次连续可微 ($C^2$) 的，且其一阶和二阶导数有界。\n- 为分割 $0=t_0  t_1  \\dots  t_n = T$ (网格尺寸为 $h$) 提供了一个基于梯形法则的隐式时间步进格式：\n$$ X_{k+1}^{\\delta} = X_{k}^{\\delta} + \\frac{1}{2}\\Big(f\\big(X_{k}^{\\delta}\\big)+f\\big(X_{k+1}^{\\delta}\\big)\\Big) h + \\frac{1}{2}\\Big(g\\big(X_{k}^{\\delta}\\big)+g\\big(X_{k+1}^{\\delta}\\big)\\Big)\\,\\Delta W_{k}^{\\delta} $$\n其中 $X_k^\\delta = X_{t_k}^\\delta$ 且 $\\Delta W_k^\\delta = W_{t_{k+1}}^\\delta - W_{t_k}^\\delta$。\n- 假设当 $h \\to 0$ 时，该格式收敛于常微分方程解，且当 $\\delta \\to 0$ 时，$W^\\delta \\to W$ 且解 $X^\\delta$ 收敛于一个极限过程 $X$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行严格审查。\n- **科学基础：** 该问题是随机分析中的一个基石性课题，探讨了由光滑噪声驱动的常微分方程 (ODE) 与随机微分方程 (SDE) 之间的关系，这一概念由 Wong-Zakai 定理形式化。所提出的方法（分析一个数值格式）是推导 Stratonovich 积分和 Itō 积分之间联系的标准技术。数学对象（布朗运动、磨光核、泰勒展开）和假设（$f$ 和 $g$ 的光滑性及其导数的有界性）在此背景下是标准且恰当的。该问题在根本上是合理的。\n- **适定性：** 问题陈述清晰，要求一个特定且唯一定义的量：将极限 Stratonovich SDE 表达为 Itō 形式所需的漂移修正项。给定的条件和假设足以确定此项。该问题是适定的。\n- **客观性：** 问题使用精确、形式化的数学语言表述，没有任何主观性或歧义。\n\n该问题没有表现出验证标准中列出的任何缺陷。它是一个形式化的、自洽的、科学上有效的问题。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n目标是确定当极限过程由一个 Itō SDE 描述时所需的漂移修正项。所提供的数值格式是基础过程的一个离散化。根据 Wong-Zakai 定理，由光滑噪声驱动的常微分方程的极限对应于一个 Stratonovich SDE。梯形法是一种已知的收敛于 Stratonovich 积分的数值方法。我们的方法是分析当 $h \\to 0$ 和 $\\delta \\to 0$ 时格式的极限行为。在极限情况下，上标 $\\delta$ 可以省略。我们将分析格式的各项，以确定解 $X$ 所满足的 Itō SDE。\n\n设 $\\Delta X_k = X_{k+1} - X_k$ 和 $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$。该格式为：\n$$ \\Delta X_k = \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) + \\frac{1}{2}\\left(g(X_k)+g(X_{k+1})\\right)\\,\\Delta W_k $$\n我们分析当 $h \\to 0$ 时，和 $\\sum_k \\Delta X_k$ 的每个部分的贡献。\n\n首先，考虑格式中的漂移项：\n$$ \\sum_{k=0}^{n-1} \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) $$\n由于样本路径的连续性，当 $h \\to 0$ 时，$X_{k+1} \\to X_k$。因此，$f(X_{k+1}) \\to f(X_k)$。该和式变成一个黎曼和，收敛于漂移项的标准积分：\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) = \\lim_{h\\to 0} \\sum_{k=0}^{n-1} f(X_k)h = \\int_0^T f(X_t) dt $$\n\n接下来，我们分析噪声项，它是一个随机积分的离散近似：\n$$ S_n = \\sum_{k=0}^{n-1} \\frac{1}{2}\\left(g(X_k)+g(X_{k+1})\\right)\\,\\Delta W_k $$\n为了理解其极限，我们使用泰勒级数将 $g(X_{k+1})$ 在 $X_k$ 附近展开。由于 $g \\in C^2$，我们有：\n$$ g(X_{k+1}) = g(X_k + \\Delta X_k) = g(X_k) + g'(X_k)\\Delta X_k + O((\\Delta X_k)^2) $$\n其中 $g'(x) = \\frac{dg}{dx}(x)$。\n将此代入 $S_n$ 的表达式中：\n$$ S_n = \\sum_{k=0}^{n-1} \\frac{1}{2}\\left(g(X_k) + g(X_k) + g'(X_k)\\Delta X_k + O((\\Delta X_k)^2)\\right)\\,\\Delta W_k $$\n$$ S_n = \\sum_{k=0}^{n-1} g(X_k)\\Delta W_k + \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k)\\Delta X_k \\Delta W_k + \\sum_{k=0}^{n-1} O((\\Delta X_k)^2)\\Delta W_k $$\n第一项 $\\sum g(X_k)\\Delta W_k$ 是在极限 $h \\to 0$ 时定义 Itō 积分的标准离散和：\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} g(X_k)\\Delta W_k = \\int_0^T g(X_t) dW_t $$\n对于第二项，我们需要 $\\Delta X_k$ 的表达式。对于小的 $h$，$\\Delta X_k$ 的主导部分由 Euler-Maruyama 近似给出，该近似源于 SDE 本身的主导项：\n$$ \\Delta X_k = f(X_k)h + g(X_k)\\Delta W_k + O(h) $$\n我们将此代入 $S_n$ 的第二项：\n$$ \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k)\\Delta X_k \\Delta W_k \\approx \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k) \\left( f(X_k)h + g(X_k)\\Delta W_k \\right) \\Delta W_k $$\n$$ = \\sum_{k=0}^{n-1} \\frac{1}{2} g(X_k)g'(X_k)(\\Delta W_k)^2 + \\sum_{k=0}^{n-1} \\frac{1}{2}f(X_k)g'(X_k)h \\Delta W_k $$\n我们现在分析这两个和的极限。\n第一个和包含 $(\\Delta W_k)^2$。布朗运动的一个基本性质是其二次变差，即 $\\lim_{h \\to 0} \\sum_k (\\Delta W_k)^2 = T$。这个和是一个黎曼型和，收敛于一个关于时间的标准积分：\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} \\frac{1}{2} g(X_k)g'(X_k)(\\Delta W_k)^2 = \\int_0^T \\frac{1}{2} g(X_t)g'(X_t) dt $$\n这个积分是漂移修正项的来源。\n第二个和 $\\sum \\frac{1}{2}f(X_k)g'(X_k)h \\Delta W_k$ 依概率收敛于零。这个和的方差与 $\\sum h^2 (\\Delta W_k)^2 \\approx \\sum h^2 h = h T$ 成正比，当 $h \\to 0$ 时趋于 $0$。\n$S_n$ 中的最后一项 $\\sum O((\\Delta X_k)^2)\\Delta W_k$ 在极限中也消失，因为它包含 $h$ 和 $\\Delta W_k$ 的更高次幂。\n\n结合所有极限贡献，完整过程 $X_T - X_0 = \\sum \\Delta X_k$ 满足：\n$$ X_T - X_0 = \\int_0^T f(X_t)dt + \\int_0^T g(X_t)dW_t + \\int_0^T \\frac{1}{2}g(X_t)g'(X_t)dt $$\n将其写成微分形式，得到极限过程 $X_t$ 的 Itō SDE：\n$$ dX_t = f(X_t)dt + g(X_t)dW_t + \\frac{1}{2}g(X_t)g'(X_t)dt $$\n我们可以将 $dt$ 项组合起来，以确定 Itō 方程的总漂移项：\n$$ dX_t = \\left(f(X_t) + \\frac{1}{2}g(X_t)g'(X_t)\\right)dt + g(X_t)dW_t $$\n问题陈述中的原始漂移是 $f(x)$。得到的 Itō SDE 有一个修正后的漂移。问题要求的是加到 $f(x)$ 上的漂移修正函数 $C(x)$。通过比较漂移项，我们确定这个修正。\n修正项是加到原始漂移 $f(x)$ 上的部分。因此，漂移修正函数 $C(x)$ 是：\n$$ C(x) = \\frac{1}{2}g(x)g'(x) $$\n这个结果是众所周知的 Itō-Stratonovich 修正项（或 Wong-Zakai 修正项）。", "answer": "$$\\boxed{\\frac{1}{2} g(x) g'(x)}$$", "id": "3004514"}, {"introduction": "标准的Wong-Zakai定理建立在“中性”噪声近似之上，这些近似在小尺度上保持了布朗运动的协方差结构。然而，如果近似过程本身带有某种系统性偏差会发生什么？这个高级练习 [@problem_id:3004492] 探讨了这一深刻问题，通过在一个二维布朗运动的近似中引入微小的、确定性的“面积环”，你将发现极限SDE中出现了一个与向量场的李括号（Lie bracket）成正比的额外漂移项，这揭示了随机分析与微分几何之间深刻的内在联系。", "problem": "考虑以下构造，该构造修改了系统驱动信号中的小尺度协方差，并导致了一个有偏的 Wong-Zakai 极限。\n\n设 $\\{W_t=(W^1_t,W^2_t)\\}_{t \\in [0,T]}$ 为一个标准的二维布朗运动。对于 $\\varepsilon>0$，定义 $[0,T]$ 的一个分割 $\\Pi_{\\varepsilon}$，其网格尺寸为 $\\max_k (t_{k+1}-t_k)=\\varepsilon$。通过在每个子区间 $[t_k,t_{k+1}]$ 上对 $W$ 进行如下修改，构造一条分段 $C^1$ 路径 $W^{\\varepsilon}=(W^{1,\\varepsilon},W^{2,\\varepsilon})$：\n- 端点匹配：$W^{\\varepsilon}_{t_k}=W_{t_k}$ 且 $W^{\\varepsilon}_{t_{k+1}}=W_{t_{k+1}}$。\n- 在每个 $[t_k,t_{k+1}]$ 上，路径由端点之间的线性插值和一个叠加在 $(W^1,W^2)$ 平面上的微小光滑闭环给出，其有向面积为 $+\\alpha (t_{k+1}-t_k)$，其中 $\\alpha \\in \\mathbb{R}$ 是一个固定常数，并且在每个子区间上都具有相同的（正）方向。选择的闭环使其振幅为 $O((t_{k+1}-t_k)^{1/2})$，持续时间为 $O(t_{k+1}-t_k)$。\n\n设 $X^{\\varepsilon}_t \\in \\mathbb{R}^3$ 在逐路径 Riemann-Stieltjes 意义下解以下常微分方程（ODE），\n$$\n\\mathrm{d}X^{\\varepsilon}_t \\;=\\; V_1\\!\\left(X^{\\varepsilon}_t\\right)\\,\\mathrm{d}W^{1,\\varepsilon}_t \\;+\\; V_2\\!\\left(X^{\\varepsilon}_t\\right)\\,\\mathrm{d}W^{2,\\varepsilon}_t,\\qquad X^{\\varepsilon}_0=(0,0,0),\n$$\n其中向量场为光滑的\n$$\nV_1(x,y,z) \\;=\\; (1,0,0),\\qquad V_2(x,y,z) \\;=\\; (0,x,0).\n$$\n\n从关于由光滑信号驱动的常微分方程流的 Stratonovich-Taylor 展开以及迭代积分作用的基本原理出发，分析 $X^{\\varepsilon}$ 在 $\\varepsilon$ 趋于零时的极限。具体而言：\n- 证明驱动序列 $W^{\\varepsilon}$ 在 Wong-Zakai 定理所需的意义下收敛，但由于插入的闭环，存在一个非零的确定性反对称二级反常项。\n- 证明 $X^{\\varepsilon}$ 的极限解一个 Stratonovich 意义下的随机微分方程（SDE），该方程带有一个与李括号 $[V_1,V_2]$ 成正比的额外漂移项。\n- 计算极限 SDE 的 $y$ 分量中乘以 $\\mathrm{d}t$ 的标量偏差系数 $b(\\alpha)$，并将其表示为 $\\alpha$ 的闭式函数。\n\n你的最终答案必须是 $b(\\alpha)$ 的单一闭式表达式，不带单位。无需数值取整。", "solution": "该问题要求分析由二维布朗运动的光滑近似驱动的一系列常微分方程（ODE）的极限。问题的核心在于 Wong-Zakai 定理及其推广，这些定理将此类极限与随机微分方程（SDE）联系起来。\n\n该系统由以下 ODE 描述：\n$$\n\\mathrm{d}X^{\\varepsilon}_t \\;=\\; V_1\\!\\left(X^{\\varepsilon}_t\\right)\\,\\mathrm{d}W^{1,\\varepsilon}_t \\;+\\; V_2\\!\\left(X^{\\varepsilon}_t\\right)\\,\\mathrm{d}W^{2,\\varepsilon}_t\n$$\n其中积分是 Riemann-Stieltjes 意义下的。驱动路径 $W^{\\varepsilon}_t$ 是标准二维布朗运动 $W_t = (W^1_t, W^2_t)$ 的分段 $C^1$ 近似。\n\n根据粗糙路径理论和广义 Wong-Zakai 定理（例如，由 Kurtz、Protter 和 Pardoux 提出），如果驱动序列 $W^{\\varepsilon}$ 在 $[0,T]$ 上依概率一致收敛于 $W$，即 $\\sup_{t \\in [0,T]} |W^{\\varepsilon}_t - W_t| \\to 0$（依概率），那么解 $X^{\\varepsilon}_t$ 会依概率收敛于某个随机微分方程的解 $X_t$。极限 SDE 的确切形式取决于 $W^{\\varepsilon}$ 的迭代积分的极限行为。\n\n路径 $W^{\\varepsilon}$ 的构造使其在分割点 $\\{t_k\\}$ 处与 $W$ 相匹配，并在每个子区间 $[t_k, t_{k+1}]$ 上由一个线性插值和一个叠加的闭环组成。该闭环的振幅是 $O((t_{k+1}-t_k)^{1/2})$ 阶的，这确保了 $W^{\\varepsilon}$ 与 $W$ 的分段线性插值之间的最大偏差在 $\\varepsilon \\to 0$ 时趋于零。由于分段线性插值本身依概率一致收敛于 $W$，因此 $W^{\\varepsilon}$ 也依概率一致收敛于 $W$。这满足了收敛的第一个条件。\n\n这个问题的关键在于“非零的确定性反对称二级反常项”。这个反常项指的是二阶迭代积分的极限行为，特别是面积元。ODE 的解可以用 Stratonovich-Taylor 展开进行形式上的展开。对于一个微小的时间步长 $\\Delta t = t_{k+1}-t_k$，$X^{\\varepsilon}$ 的变化近似为：\n\\begin{align*}\n\\Delta X^{\\varepsilon}_k \\approx  V_1 \\int_{t_k}^{t_{k+1}} \\mathrm{d}W^{1,\\varepsilon}_s + V_2 \\int_{t_k}^{t_{k+1}} \\mathrm{d}W^{2,\\varepsilon}_s \\\\\n + \\nabla V_1 V_1 \\int_{t_k}^{t_{k+1}} (W^{1,\\varepsilon}_s - W^{1,\\varepsilon}_{t_k}) \\mathrm{d}W^{1,\\varepsilon}_s + \\nabla V_1 V_2 \\int_{t_k}^{t_{k+1}} (W^{2,\\varepsilon}_s - W^{2,\\varepsilon}_{t_k}) \\mathrm{d}W^{1,\\varepsilon}_s \\\\\n + \\nabla V_2 V_1 \\int_{t_k}^{t_{k+1}} (W^{1,\\varepsilon}_s - W^{1,\\varepsilon}_{t_k}) \\mathrm{d}W^{2,\\varepsilon}_s + \\nabla V_2 V_2 \\int_{t_k}^{t_{k+1}} (W^{2,\\varepsilon}_s - W^{2,\\varepsilon}_{t_k}) \\mathrm{d}W^{2,\\varepsilon}_s\n\\end{align*}\n其中向量场在 $X^{\\varepsilon}_{t_k}$ 处取值。\n\n极限 SDE 由这些增量的总和决定。这些项可以分为对称部分和反对称部分。二阶项的对称部分求和后，贡献于 Itô-Stratonovich 修正项，对于标准的分段线性近似，这导致极限情况下得到一个 Stratonovich SDE。二阶项的反对称部分与李括号 $[V_1, V_2] = \\nabla V_2 V_1 - \\nabla V_1 V_2$ 相关。李括号项的系数是：\n$$\n\\frac{1}{2} \\left( \\int_{t_k}^{t_{k+1}} (W^{1,\\varepsilon}_s - W^{1,\\varepsilon}_{t_k}) \\mathrm{d}W^{2,\\varepsilon}_s - \\int_{t_k}^{t_{k+1}} (W^{2,\\varepsilon}_s - W^{2,\\varepsilon}_{t_k}) \\mathrm{d}W^{1,\\varepsilon}_s \\right)\n$$\n根据格林定理，这个表达式恰好是路径段 $(W^{1,\\varepsilon}_s, W^{2,\\varepsilon}_s)$（其中 $s \\in [t_k, t_{k+1}]$）平移至原点后所围成的有向面积。该区间上的路径是一个线段（其自身围成的面积为零）和附加闭环的和。因此，这个面积完全由该闭环产生。题目说明这个面积是 $+\\alpha(t_{k+1}-t_k)$。\n\n将这些面积贡献在截至时间 $t$ 的所有分割区间上求和，我们发现 $W^{\\varepsilon}$ 的总面积过程有一个确定性分量，它收敛于 $\\alpha t$。这就是那个反常项。一个标准的分段线性近似的面积过程会收敛于随机的 Lévy 面积，其期望值为零。而添加的闭环在面积中引入了一个系统的、确定性的漂移。\n\n一般结果是，极限过程 $X_t$ 满足以下 SDE：\n$$\n\\mathrm{d}X_t = V_1(X_t) \\circ \\mathrm{d}W^1_t + V_2(X_t) \\circ \\mathrm{d}W^2_t + \\alpha [V_1, V_2](X_t) \\mathrm{d}t\n$$\n其中‘$\\circ$’表示 Stratonovich 积分，而额外的漂移项 $\\alpha [V_1, V_2](X_t) \\mathrm{d}t$ 是确定性面积反常项的直接后果。这证实了极限解一个带与李括号成比例的漂移项的 SDE。\n\n为了找到具体的系数 $b(\\alpha)$，我们必须计算给定向量场的李括号：\n$$\nV_1(x,y,z) = (1,0,0) \\qquad V_2(x,y,z) = (0,x,0)\n$$\n李括号定义为 $[V_1, V_2] = (\\nabla V_2)V_1 - (\\nabla V_1)V_2$，其中 $\\nabla V_i$ 是 $V_i$ 的雅可比矩阵。\n\n向量场 $V_1$ 是常数，所以其雅可比矩阵是零矩阵：\n$$\n\\nabla V_1 = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n因此，项 $(\\nabla V_1)V_2$ 是一个零向量。\n\n$V_2$ 的雅可比矩阵是：\n$$\n\\nabla V_2 = \\begin{pmatrix} \\frac{\\partial(0)}{\\partial x}  \\frac{\\partial(0)}{\\partial y}  \\frac{\\partial(0)}{\\partial z} \\\\ \\frac{\\partial(x)}{\\partial x}  \\frac{\\partial(x)}{\\partial y}  \\frac{\\partial(x)}{\\partial z} \\\\ \\frac{\\partial(0)}{\\partial x}  \\frac{\\partial(0)}{\\partial y}  \\frac{\\partial(0)}{\\partial z} \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n现在我们计算项 $(\\nabla V_2)V_1$：\n$$\n(\\nabla V_2)V_1 = \\begin{pmatrix} 0  0  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n结合这些结果，李括号是：\n$$\n[V_1, V_2] = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n李括号是常向量场 $(0,1,0)$。\n\n极限 SDE 中的额外漂移项是 $\\alpha [V_1, V_2] \\mathrm{d}t = \\alpha (0,1,0) \\mathrm{d}t = (0, \\alpha, 0) \\mathrm{d}t$。\n极限过程各分量 $(X_t, Y_t, Z_t)$ 的 SDE 是：\n$$\n\\mathrm{d} \\begin{pmatrix} X_t \\\\ Y_t \\\\ Z_t \\end{pmatrix} = V_1 \\circ \\mathrm{d}W^1_t + V_2 \\circ \\mathrm{d}W^2_t + \\begin{pmatrix} 0 \\\\ \\alpha \\\\ 0 \\end{pmatrix} \\mathrm{d}t\n$$\n$$\n\\mathrm{d} \\begin{pmatrix} X_t \\\\ Y_t \\\\ Z_t \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\circ \\mathrm{d}W^1_t + \\begin{pmatrix} 0 \\\\ X_t \\\\ 0 \\end{pmatrix} \\circ \\mathrm{d}W^2_t + \\begin{pmatrix} 0 \\\\ \\alpha \\\\ 0 \\end{pmatrix} \\mathrm{d}t\n$$\n对于 $y$ 分量 $Y_t$ 的 SDE 是：\n$$\n\\mathrm{d}Y_t = X_t \\circ \\mathrm{d}W^2_t + \\alpha \\mathrm{d}t\n$$\n问题要求的是这个极限 SDE 的 $y$ 分量中乘以 $\\mathrm{d}t$ 的标量偏差系数 $b(\\alpha)$。从 $\\mathrm{d}Y_t$ 的方程中可以清楚地看到，这个系数是 $\\alpha$。\n因此，$b(\\alpha) = \\alpha$。", "answer": "$$\\boxed{\\alpha}$$", "id": "3004492"}]}