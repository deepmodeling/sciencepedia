{"hands_on_practices": [{"introduction": "这项练习将从第一性原理出发，推导卡尔曼滤波器的核心更新步骤，从而揭开其神秘面纱。通过考察一个联合高斯分布的状态和测量变量，我们将看到最优估计是观测值的线性函数。这项练习将基础概率论与滤波的实际操作直接联系起来，揭示了构成更新规则的先验信念、新息和增益的直观结构。[@problem_id:2996462]", "problem": "考虑一个单步离散时间线性高斯估计设定，其中潜状态 $X$ 和测量 $Y$ 服从联合高斯分布。设 $(X,Y)$ 的联合分布为一个二元正态分布，其均值向量 $m$ 和协方差矩阵 $\\Sigma$ 如下所示：\n$$\nm = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}, \\qquad \\Sigma = \\begin{pmatrix} 7  3 \\\\ 3  5 \\end{pmatrix}.\n$$\n仅从多元正态密度的定义和条件期望的定义出发，推导条件期望 $\\mathbb{E}[X \\mid Y]$ 作为随机变量 $Y$ 的函数的闭式解析表达式。然后，将此表达式解释为离散设定下的单步线性滤波器更新，并在您推导的表达式中识别出先验均值、测量新息和滤波器增益。将您的最终答案仅表示为关于 $Y$ 的解析表达式。无需四舍五入，且无单位。", "solution": "本题要求从基本原理出发，为两个联合高斯随机变量 $X$ 和 $Y$ 推导条件期望 $\\mathbb{E}[X \\mid Y]$，然后在线性滤波的背景下解释该结果。\n\n随机向量 $\\begin{pmatrix} X \\\\ Y \\end{pmatrix}$ 的联合分布为二元正态分布，其均值向量 $m$ 和协方差矩阵 $\\Sigma$ 如下：\n$$ m = \\begin{pmatrix} \\mu_X \\\\ \\mu_Y \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} $$\n$$ \\Sigma = \\begin{pmatrix} \\Sigma_{XX}  \\Sigma_{XY} \\\\ \\Sigma_{YX}  \\Sigma_{YY} \\end{pmatrix} = \\begin{pmatrix} 7  3 \\\\ 3  5 \\end{pmatrix} $$\n由此，我们确定边缘均值、方差和协方差：\n$\\mu_X = \\mathbb{E}[X] = 2$，$\\mu_Y = \\mathbb{E}[Y] = -1$，$\\Sigma_{XX} = \\text{Var}(X) = 7$，$\\Sigma_{YY} = \\text{Var}(Y) = 5$，以及 $\\Sigma_{XY} = \\Sigma_{YX} = \\text{Cov}(X,Y) = 3$。\n\n条件期望 $\\mathbb{E}[X \\mid Y=y]$ 由以下积分定义：\n$$ \\mathbb{E}[X \\mid Y=y] = \\int_{-\\infty}^{\\infty} x \\cdot p_{X|Y}(x|y) \\, dx $$\n其中 $p_{X|Y}(x|y)$ 是在 $Y=y$ 的条件下 $X$ 的条件概率密度函数 (PDF)。该条件PDF由联合PDF与 $Y$ 的边缘PDF之比给出：\n$$ p_{X|Y}(x|y) = \\frac{p_{X,Y}(x,y)}{p_Y(y)} $$\n二元正态分布的联合PDF $p_{X,Y}(x,y)$ 为：\n$$ p_{X,Y}(x,y) = \\frac{1}{2\\pi \\sqrt{\\det(\\Sigma)}} \\exp\\left( -\\frac{1}{2} ( (x,y) - m )^T \\Sigma^{-1} ( (x,y) - m ) \\right) $$\n首先，我们计算 $\\Sigma$ 的行列式和逆矩阵：\n$$ \\det(\\Sigma) = (7)(5) - (3)(3) = 35 - 9 = 26 $$\n$$ \\Sigma^{-1} = \\frac{1}{26} \\begin{pmatrix} 5  -3 \\\\ -3  7 \\end{pmatrix} $$\n指数中的二次型为 $Q(x,y) = ( (x-\\mu_X, y-\\mu_Y) ) \\Sigma^{-1} ( (x-\\mu_X, y-\\mu_Y) )^T$：\n$$ Q(x,y) = \\frac{1}{26} \\left[ 5(x-\\mu_X)^2 - 6(x-\\mu_X)(y-\\mu_Y) + 7(y-\\mu_Y)^2 \\right] $$\n为求得在 $Y=y$ 条件下 $X$ 的条件分布，我们必须通过对 $x$ 配方来重排此表达式。我们将 $y$ 视为一个固定参数。\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left[ (x-\\mu_X)^2 - \\frac{6}{5}(x-\\mu_X)(y-\\mu_Y) \\right] + 7(y-\\mu_Y)^2 \\right\\} $$\n对含 $x$ 的项进行配方：\n$$ (x-\\mu_X)^2 - \\frac{6}{5}(x-\\mu_X)(y-\\mu_Y) = \\left( (x-\\mu_X) - \\frac{3}{5}(y-\\mu_Y) \\right)^2 - \\left( \\frac{3}{5}(y-\\mu_Y) \\right)^2 $$\n$$ = \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 - \\frac{9}{25}(y-\\mu_Y)^2 $$\n将此代回 $Q(x,y)$ 的表达式中：\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left[ \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 - \\frac{9}{25}(y-\\mu_Y)^2 \\right] + 7(y-\\mu_Y)^2 \\right\\} $$\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 - \\frac{9}{5}(y-\\mu_Y)^2 + 7(y-\\mu_Y)^2 \\right\\} $$\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 + \\left( 7 - \\frac{9}{5} \\right)(y-\\mu_Y)^2 \\right\\} $$\n$$ Q(x,y) = \\frac{1}{26} \\left\\{ 5 \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 + \\frac{26}{5}(y-\\mu_Y)^2 \\right\\} $$\n分配 $\\frac{1}{26}$ 这一项：\n$$ Q(x,y) = \\frac{5}{26} \\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2 + \\frac{1}{5}(y-\\mu_Y)^2 $$\n$$ Q(x,y) = \\frac{\\left( x - \\left( \\mu_X + \\frac{3}{5}(y-\\mu_Y) \\right) \\right)^2}{26/5} + \\frac{(y-\\mu_Y)^2}{5} $$\n联合PDF的指数是 $-\\frac{1}{2}Q(x,y)$。现在可以将联合PDF写成两项的乘积：\n$$ p_{X,Y}(x,y) = \\frac{1}{2\\pi\\sqrt{26}} \\exp\\left( -\\frac{1}{2} \\left[ \\frac{\\left(x - \\left(\\mu_X + \\frac{3}{5}(y-\\mu_Y)\\right)\\right)^2}{26/5} + \\frac{(y-\\mu_Y)^2}{5} \\right] \\right) $$\n使用 $\\sqrt{26} = \\sqrt{5 \\cdot (26/5)}$，我们可以分离该表达式：\n$$ p_{X,Y}(x,y) = \\left[ \\frac{1}{\\sqrt{2\\pi \\cdot 5}} \\exp\\left(-\\frac{(y-\\mu_Y)^2}{2 \\cdot 5}\\right) \\right] \\cdot \\left[ \\frac{1}{\\sqrt{2\\pi \\cdot (26/5)}} \\exp\\left(-\\frac{\\left(x - \\left(\\mu_X + \\frac{3}{5}(y-\\mu_Y)\\right)\\right)^2}{2 \\cdot (26/5)}\\right) \\right] $$\n第一个方括号中的项是均值为 $\\mu_Y$、方差为 $\\Sigma_{YY}=5$ 的正态分布的PDF，这正是边缘PDF $p_Y(y)$。因此，第二个方括号中的项必须是条件PDF $p_{X|Y}(x|y)$。\n通过观察第二项，我们发现给定 $Y=y$ 时 $X$ 的条件分布是一个正态分布，其：\n- 条件均值：$\\mu_{X|Y} = \\mu_X + \\frac{3}{5}(y-\\mu_Y)$\n- 条件方差：$\\sigma^2_{X|Y} = \\frac{26}{5}$\n\n条件期望 $\\mathbb{E}[X \\mid Y=y]$ 是这个条件分布的均值。\n$$ \\mathbb{E}[X \\mid Y=y] = \\mu_X + \\frac{3}{5}(y-\\mu_Y) $$\n代入给定的数值 $\\mu_X = 2$ 和 $\\mu_Y=-1$：\n$$ \\mathbb{E}[X \\mid Y=y] = 2 + \\frac{3}{5}(y - (-1)) = 2 + \\frac{3}{5}(y+1) $$\n$$ \\mathbb{E}[X \\mid Y=y] = 2 + \\frac{3}{5}y + \\frac{3}{5} = \\frac{13}{5} + \\frac{3}{5}y $$\n将特定值 $y$ 替换为随机变量 $Y$，我们得到条件期望作为 $Y$ 的函数的最终表达式：\n$$ \\mathbb{E}[X \\mid Y] = \\frac{13}{5} + \\frac{3}{5}Y $$\n\n现在，我们将此表达式解释为单步线性滤波器更新。此类更新的一般形式是：\n$$ \\text{后验估计} = \\text{先验估计} + \\text{增益} \\times (\\text{新息}) $$\n在此背景下：\n- 在观测到测量 $Y$ 之后，状态 $X$ 的后验估计是条件期望 $\\mathbb{E}[X \\mid Y]$。\n- 在观测到 $Y$ 之前，状态 $X$ 的先验估计是其无条件均值 $\\mathbb{E}[X] = \\mu_X$。\n- 测量新息是实际测量 $Y$ 与其期望值（预测测量）之差，即 $Y - \\mathbb{E}[Y] = Y - \\mu_Y$。\n\n让我们将推导出的 $\\mathbb{E}[X \\mid Y]$ 表达式改写成这种形式：\n$$ \\mathbb{E}[X \\mid Y] = \\mu_X + \\frac{3}{5}(Y - \\mu_Y) $$\n将其与滤波器结构进行比较，我们可以识别出以下几个部分：\n- **先验均值：** $\\mathbb{E}[X] = \\mu_X = 2$。这是在没有来自 $Y$ 的信息的情况下对 $X$ 的最佳估计。\n- **测量新息：** $Y - \\mu_Y = Y - (-1) = Y+1$。该项代表了由测量 $Y$ 提供的新信息。\n- **滤波器增益：** 乘以新息的系数是滤波器增益，即 $K = \\frac{3}{5}$。一般而言，该增益为 $K = \\Sigma_{XY}\\Sigma_{YY}^{-1} = 3 \\cdot 5^{-1} = \\frac{3}{5}$。增益决定了在更新先验估计时给予新息的权重。\n\n表达式 $\\mathbb{E}[X \\mid Y] = 2 + \\frac{3}{5}(Y+1)$ 是线性估计中的一个经典结果，代表了在均方误差意义下给定 $Y$ 时 $X$ 的最优线性估计。", "answer": "$$ \\boxed{\\frac{13}{5} + \\frac{3}{5}Y} $$", "id": "2996462"}, {"introduction": "如果一个系统的内在特性使其难以估计，那么即使是“最优”的滤波器也无法保证良好性能。这项练习将探讨可探测性这一关键概念，它是滤波器稳定性分析的基石。通过分析一个不稳定模式无法被观测到的系统，我们将定量地看到估计误差如何无界增长，从而对这种滤波器的关键失效模式建立起几何直觉。[@problem_id:2996460]", "problem": "考虑$\\mathbb{R}^{2}$中的连续时间线性时不变（LTI）状态空间模型，由以下随机微分方程（SDE）给出\n$$\n\\mathrm{d}X(t) = A\\,X(t)\\,\\mathrm{d}t + G\\,\\mathrm{d}W(t),\n$$\n其中 $X(t) \\in \\mathbb{R}^{2}$，$W(t)$ 是标量标准维纳过程，$A = \\begin{pmatrix} \\alpha  0 \\\\ 0  -\\beta \\end{pmatrix}$ 且 $\\alpha  0$ 和 $\\beta  0$，以及 $G = \\begin{pmatrix} \\sqrt{q} \\\\ 0 \\end{pmatrix}$ 且 $q  0$。观测过程为\n$$\n\\mathrm{d}Y(t) = C\\,X(t)\\,\\mathrm{d}t + \\sqrt{r}\\,\\mathrm{d}V(t),\n$$\n其中 $Y(t) \\in \\mathbb{R}$，$V(t)$ 是一个独立于 $W(t)$ 的标量标准维纳过程，$r  0$，且 $C = \\begin{pmatrix} 0  1 \\end{pmatrix}$。假设最优滤波器的初始估计误差协方差为 $P(0) = \\begin{pmatrix} p_{0}  0 \\\\ 0  s_{0} \\end{pmatrix}$ 且 $p_{0}  0$ 和 $s_{0}  0$。\n\n该模型表现出不可检测性，因为与特征值 $\\alpha$ 相关的不稳定模式是不可观测的。从随机滤波和状态空间建模的基本原理出发，推导估计误差协方差的演化过程，并计算沿不可检测的不稳定方向的估计误差方差的闭式表达式，即对所有 $t \\ge 0$ 的 $(1,1)$-项 $P_{11}(t)$。解释由于缺乏可检测性，该方差随时间变得无界的几何直觉。\n\n将 $P_{11}(t)$ 的最终答案表示为包含符号 $\\alpha$、$q$ 和 $p_{0}$ 的闭式解析表达式。无需四舍五入。", "solution": "最优滤波器的估计误差协方差矩阵 $P(t) = \\mathbb{E}[(X(t) - \\hat{X}(t))(X(t) - \\hat{X}(t))^T]$ 的演化由连续时间Riccati微分方程控制：\n$$\n\\frac{\\mathrm{d}P(t)}{\\mathrm{d}t} = A P(t) + P(t) A^T + G Q G^T - P(t) C^T R^{-1} C P(t)\n$$\n根据问题陈述，系统矩阵为 $A = \\begin{pmatrix} \\alpha  0 \\\\ 0  -\\beta \\end{pmatrix}$，$G = \\begin{pmatrix} \\sqrt{q} \\\\ 0 \\end{pmatrix}$，以及 $C = \\begin{pmatrix} 0  1 \\end{pmatrix}$。过程噪声 $W(t)$ 是一个标量标准维纳过程，因此其相关的协方差为 $Q=1$。观测噪声方差给定为 $r$，因此 $R=r$。将这些代入Riccati方程可得：\n$$\n\\frac{\\mathrm{d}P(t)}{\\mathrm{d}t} = A P(t) + P(t) A^T + G G^T - \\frac{1}{r} P(t) C^T C P(t)\n$$\n我们计算矩阵乘积：\n$$ G G^T = \\begin{pmatrix} \\sqrt{q} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} \\sqrt{q}  0 \\end{pmatrix} = \\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix} $$\n$$ C^T C = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} $$\n令 $P(t)$ 由其分量表示：$P(t) = \\begin{pmatrix} P_{11}(t)  P_{12}(t) \\\\ P_{21}(t)  P_{22}(t) \\end{pmatrix}$。由于协方差矩阵的对称性，$P_{12}(t) = P_{21}(t)$。\nRiccati方程中的各项为：\n$$ A P(t) + P(t) A^T = \\begin{pmatrix} \\alpha  0 \\\\ 0  -\\beta \\end{pmatrix} \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{12}  P_{22} \\end{pmatrix} + \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{12}  P_{22} \\end{pmatrix} \\begin{pmatrix} \\alpha  0 \\\\ 0  -\\beta \\end{pmatrix} = \\begin{pmatrix} 2\\alpha P_{11}  (\\alpha - \\beta) P_{12} \\\\ (\\alpha - \\beta) P_{12}  -2\\beta P_{22} \\end{pmatrix} $$\n$$ P(t) C^T C P(t) = \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{12}  P_{22} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{12}  P_{22} \\end{pmatrix} = \\begin{pmatrix} P_{12}^2  P_{12}P_{22} \\\\ P_{12}P_{22}  P_{22}^2 \\end{pmatrix} $$\n将这些代入Riccati方程，得到关于 $P(t)$ 各分量的常微分方程（ODE）组：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{12}  P_{22} \\end{pmatrix} = \\begin{pmatrix} 2\\alpha P_{11} + q - \\frac{1}{r}P_{12}^2  (\\alpha - \\beta)P_{12} - \\frac{1}{r}P_{12}P_{22} \\\\ (\\alpha - \\beta)P_{12} - \\frac{1}{r}P_{12}P_{22}  -2\\beta P_{22} - \\frac{1}{r}P_{22}^2 \\end{pmatrix}\n$$\n这给出了三个唯一的标量ODE：\n1. $\\dot{P}_{11}(t) = 2\\alpha P_{11}(t) + q - \\frac{1}{r} P_{12}(t)^2$\n2. $\\dot{P}_{12}(t) = (\\alpha - \\beta) P_{12}(t) - \\frac{1}{r} P_{12}(t) P_{22}(t) = \\left( \\alpha - \\beta - \\frac{1}{r} P_{22}(t) \\right) P_{12}(t)$\n3. $\\dot{P}_{22}(t) = -2\\beta P_{22}(t) - \\frac{1}{r} P_{22}(t)^2$\n\n初始条件为 $P(0) = \\begin{pmatrix} p_0  0 \\\\ 0  s_0 \\end{pmatrix}$，这意味着 $P_{11}(0) = p_0$，$P_{12}(0) = 0$，以及 $P_{22}(0) = s_0$。\n考虑关于 $P_{12}(t)$ 的ODE。它是一个形式为 $\\dot{x}(t) = f(t)x(t)$ 的关于 $P_{12}$ 的一阶线性齐次方程，初始条件为 $x(0) = 0$。此类初值问题的唯一解是对所有 $t \\ge 0$ 都有 $x(t) = 0$。因此，对所有 $t \\ge 0$ 都有 $P_{12}(t) = 0$。\n\n这通过消除非线性项，显著简化了关于 $P_{11}(t)$ 的ODE：\n$$ \\dot{P}_{11}(t) = 2\\alpha P_{11}(t) + q $$\n这是一个一阶线性非齐次ODE，初始条件为 $P_{11}(0) = p_0$。我们可以将其重写为 $\\dot{P}_{11} - 2\\alpha P_{11} = q$。\n我们使用积分因子 $\\mu(t) = \\exp\\left(\\int -2\\alpha \\,\\mathrm{d}t\\right) = \\exp(-2\\alpha t)$ 来求解。\n将ODE乘以 $\\mu(t)$：\n$$ \\exp(-2\\alpha t) \\dot{P}_{11}(t) - 2\\alpha \\exp(-2\\alpha t) P_{11}(t) = q \\exp(-2\\alpha t) $$\n左边是一个乘积的导数：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( P_{11}(t) \\exp(-2\\alpha t) \\right) = q \\exp(-2\\alpha t) $$\n对两边从 $\\tau=0$ 到 $\\tau=t$ 进行积分：\n$$ \\int_{0}^{t} \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} \\left( P_{11}(\\tau) \\exp(-2\\alpha \\tau) \\right) \\mathrm{d}\\tau = \\int_{0}^{t} q \\exp(-2\\alpha \\tau) \\mathrm{d}\\tau $$\n$$ P_{11}(t) \\exp(-2\\alpha t) - P_{11}(0) \\exp(0) = q \\left[ \\frac{\\exp(-2\\alpha \\tau)}{-2\\alpha} \\right]_{0}^{t} $$\n代入 $P_{11}(0) = p_0$：\n$$ P_{11}(t) \\exp(-2\\alpha t) - p_0 = q \\left( \\frac{\\exp(-2\\alpha t)}{-2\\alpha} - \\frac{1}{-2\\alpha} \\right) = \\frac{q}{2\\alpha} (1 - \\exp(-2\\alpha t)) $$\n求解 $P_{11}(t)$：\n$$ P_{11}(t) \\exp(-2\\alpha t) = p_0 + \\frac{q}{2\\alpha} - \\frac{q}{2\\alpha}\\exp(-2\\alpha t) $$\n$$ P_{11}(t) = p_0 \\exp(2\\alpha t) + \\frac{q}{2\\alpha} \\exp(2\\alpha t) - \\frac{q}{2\\alpha} $$\n这是误差协方差矩阵 $(1,1)$-项的闭式表达式。它可以写成：\n$$ P_{11}(t) = p_0 \\exp(2\\alpha t) + \\frac{q}{2\\alpha} (\\exp(2\\alpha t) - 1) $$\n$P_{11}(t)$ 无界增长的几何直觉在于稳定性和可观测性的概念。状态空间是 $\\mathbb{R}^2$，由标准基向量 $e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $e_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 张成。\n状态动力学是解耦的：\n$$ \\mathrm{d}X_1(t) = \\alpha X_1(t) \\mathrm{d}t + \\sqrt{q} \\mathrm{d}W(t) $$\n$$ \\mathrm{d}X_2(t) = -\\beta X_2(t) \\mathrm{d}t $$\n观测为 $\\mathrm{d}Y(t) = X_2(t) \\mathrm{d}t + \\sqrt{r} \\mathrm{d}V(t)$。\n特征向量 $e_1$ 对应于特征值 $\\alpha > 0$，代表一个不稳定模式。特征向量 $e_2$ 对应于特征值 $-\\beta  0$，一个稳定模式。观测矩阵 $C = \\begin{pmatrix} 0  1 \\end{pmatrix}$ 的零空间由 $e_1$ 张成。这意味着沿 $X_1$ 轴的不稳定模式是完全不可观测的。\n滤波器仅接收关于状态分量 $X_2$ 的测量信息，而没有关于 $X_1$ 的信息。卡尔曼增益为 $K(t) = \\frac{1}{r} P(t) C^T = \\frac{1}{r} \\begin{pmatrix} P_{12}(t) \\\\ P_{22}(t) \\end{pmatrix}$。由于 $P_{12}(t)=0$，增益的第一个分量始终为零。这在数学上证实了滤波器对 $X_1$ 的估计，即 $\\hat{X}_1$，没有从测量中接收到任何修正反馈。\n第一个状态的估计误差 $e_1(t) = X_1(t) - \\hat{X}_1(t)$，随后根据其开环动力学演化，并由过程噪声驱动：\n$$ \\mathrm{d}e_1(t) = \\alpha e_1(t) \\mathrm{d}t + \\sqrt{q} \\mathrm{d}W(t) $$\n这描述了一个不稳定的过程。这个过程的方差，$P_{11}(t) = \\mathbb{E}[e_1(t)^2]$，必须随时间增长。我们为 $P_{11}(t)$ 求解的ODE就是这个不稳定误差过程的方差传播方程。由于 $\\alpha > 0$，解中包含项 $\\exp(2\\alpha t)$，导致无界的指数增长。滤波器在一个不稳定、有噪声的方向上“盲目飞行”，因此它在该方向上的不确定性必须无限增加。这是一个系统不可检测的标志。", "answer": "$$\n\\boxed{p_{0} \\exp(2\\alpha t) + \\frac{q}{2\\alpha} (\\exp(2\\alpha t) - 1)}\n$$", "id": "2996460"}, {"introduction": "虽然卡尔曼滤波器为线性高斯系统提供了精确的解析解，但大多数现实世界的问题都是非线性的。这项练习将介绍粒子滤波器，这是一种功能强大且灵活的数值方法，适用于这些更复杂的场景。通过为一个线性模型实现一个简单的粒子滤波器，并将其结果与精确的卡尔曼解进行比较，我们将亲身实践序贯蒙特卡洛方法的机理，并理解解析方法与计算方法在滤波问题中的权衡。[@problem_id:2996563]", "problem": "考虑一个为单个时间步指定的标量线性高斯状态空间模型，其潜状态为 $x_t \\in \\mathbb{R}$，观测值为 $y_t \\in \\mathbb{R}$。潜状态根据\n$$\nx_t = a\\,x_{t-1} + w_t,\n$$\n演化，其中 $w_t \\sim \\mathcal{N}(0,q)$ 且 $q \\ge 0$。观测模型为\n$$\ny_t = c\\,x_t + v_t,\n$$\n其中 $v_t \\sim \\mathcal{N}(0,r)$ 且 $r  0$。假设前一状态的高斯先验为\n$$\nx_{t-1} \\sim \\mathcal{N}(m_{t-1}, P_{t-1}),\n$$\n其中 $P_{t-1} \\ge 0$。所有随机变量 $x_{t-1}$、$w_t$ 和 $v_t$ 相互独立。\n\n您的任务是：\n- 根据贝叶斯推断的基本定义和高斯分布的性质（不使用任何预先给出的滤波器公式），推导出该模型的精确后验均值 $\\mathbb{E}[x_t \\mid y_t]$，用 $a$、$q$、$c$、$r$、$m_{t-1}$、$P_{t-1}$ 和已实现的观测值 $y_t$ 表示。\n- 实现一个单步序列重要性重采样（SIR）粒子滤波估计器来估计 $\\mathbb{E}[x_t \\mid y_t]$，该估计器使用状态转移作为提议分布。具体步骤如下：\n  1. 对 $i \\in \\{1,\\dots,N\\}$，从 $\\mathcal{N}(m_{t-1}, P_{t-1})$ 中抽取 $N$ 个独立样本 $x_{t-1}^{(i)}$（如果 $P_{t-1} = 0$，则将其确定性地解释为 $x_{t-1}^{(i)} = m_{t-1}$）。\n  2. 通过状态动态传播每个样本：$x_t^{(i)} = a\\,x_{t-1}^{(i)} + w_t^{(i)}$，其中 $w_t^{(i)} \\sim \\mathcal{N}(0,q)$（如果 $q = 0$，则将其确定性地解释为 $w_t^{(i)} = 0$）。\n  3. 计算与似然 $p(y_t \\mid x_t^{(i)})$ 成正比的重要性权重，即 $w^{(i)} \\propto \\exp\\!\\left(-\\tfrac{1}{2}\\tfrac{(y_t - c\\,x_t^{(i)})^2}{r}\\right)$，并将它们归一化，使其总和为 1。\n  4. 形成粒子加权均值 $\\hat{m}_t^{\\text{PF}} = \\sum_{i=1}^N w^{(i)} x_t^{(i)}$。\n- 计算绝对偏差 $|\\hat{m}_t^{\\text{PF}} - \\mathbb{E}[x_t \\mid y_t]|$。\n\n使用以下参数集测试套件，每个集合代表一次独立运行。对于每种情况，都提供了 $a$、$q$、$c$、$r$、$m_{t-1}$、$P_{t-1}$、$y_t$ 和 $N$：\n\n1. 情况 A（一般情况，中等噪声）：$a=0.9$, $q=0.5$, $c=1.2$, $r=0.7$, $m_{t-1}=0.3$, $P_{t-1}=1.1$, $y_t=0.8$, $N=5$。\n2. 情况 B（边界情况：确定性先验和动态，单个粒子）：$a=1.0$, $q=0.0$, $c=1.0$, $r=0.1$, $m_{t-1}=-0.2$, $P_{t-1}=0.0$, $y_t=-0.15$, $N=1$。\n3. 情况 C（系数符号翻转，中等过程噪声）：$a=-0.5$, $q=0.2$, $c=-2.0$, $r=0.5$, $m_{t-1}=1.0$, $P_{t-1}=2.0$, $y_t=-0.7$, $N=10$。\n4. 情况 D（大观测噪声，极小粒子集）：$a=1.2$, $q=0.1$, $c=0.8$, $r=5.0$, $m_{t-1}=0.0$, $P_{t-1}=0.5$, $y_t=1.5$, $N=2$。\n5. 情况 E（近乎确定性的动态）：$a=0.7$, $q=10^{-6}$, $c=1.0$, $r=0.2$, $m_{t-1}=2.0$, $P_{t-1}=0.3$, $y_t=2.1$, $N=4$。\n\n为确保可复现性，使用基础种子 $s = 1729$ 初始化一个伪随机数生成器，并对于上述顺序中的第 $i$ 个情况（从零开始的索引 $i \\in \\{0,1,2,3,4\\}$），使用种子 $s+i$ 进行采样。\n\n您的程序必须：\n- 对于每种情况，计算绝对偏差 $|\\hat{m}_t^{\\text{PF}} - \\mathbb{E}[x_t \\mid y_t]|$，结果为浮点数。\n- 生成一行输出，其中包含按顺序排列的所有 5 个偏差，形式为用方括号括起来的逗号分隔列表。每个数字必须四舍五入到 10 位小数。例如，输出行必须看起来像 $[d_1,d_2,d_3,d_4,d_5]$，其中每个 $d_j$ 都四舍五入到 10 位小数。\n\n此问题不涉及物理单位或角度单位；按上述规定报告普通实数。", "solution": "该问题是有效的，因为它在已建立的随机滤波理论中有科学依据，是适定的、客观的，并为得出唯一的、可复现的解提供了所有必要信息。\n\n主要目标是推导标量线性高斯状态空间模型的精确后验均值 $\\mathbb{E}[x_t \\mid y_t]$，并将其与粒子滤波估计值进行比较。推导过程源于贝叶斯推断的基本原理。\n\n根据贝叶斯定理，给定观测值 $y_t$ 的状态 $x_t$ 的后验概率密度函数 (PDF) 与似然和先验的乘积成正比：\n$$\np(x_t \\mid y_t) \\propto p(y_t \\mid x_t) p(x_t)\n$$\n我们必须确定右侧的两个密度函数，$p(x_t)$ 和 $p(y_t \\mid x_t)$。\n\n首先，我们推导在时间 $t$ 的状态的先验分布 $p(x_t)$。这也被称为预测分布，因为它代表了我们在融合测量值 $y_t$ 之前对 $x_t$ 的信念。状态根据\n$$\nx_t = a\\,x_{t-1} + w_t\n$$\n演化。我们已知前一状态的分布是高斯的，$x_{t-1} \\sim \\mathcal{N}(m_{t-1}, P_{t-1})$，并且过程噪声也是高斯的，$w_t \\sim \\mathcal{N}(0, q)$。由于 $x_{t-1}$ 和 $w_t$ 是独立的，状态 $x_t$ 是两个独立高斯随机变量的线性组合。因此，$x_t$ 本身是高斯的。其均值和方差为：\n$$\n\\mathbb{E}[x_t] = \\mathbb{E}[a\\,x_{t-1} + w_t] = a\\,\\mathbb{E}[x_{t-1}] + \\mathbb{E}[w_t] = a\\,m_{t-1} + 0 = a\\,m_{t-1}\n$$\n$$\n\\text{Var}(x_t) = \\text{Var}(a\\,x_{t-1} + w_t) = \\text{Var}(a\\,x_{t-1}) + \\text{Var}(w_t) = a^2\\,\\text{Var}(x_{t-1}) + \\text{Var}(w_t) = a^2 P_{t-1} + q\n$$\n我们将预测均值表示为 $m_{t|t-1} = a\\,m_{t-1}$，预测方差表示为 $P_{t|t-1} = a^2 P_{t-1} + q$。因此，$x_t$ 的先验分布为：\n$$\np(x_t) = \\mathcal{N}(x_t; m_{t|t-1}, P_{t|t-1}) = \\frac{1}{\\sqrt{2\\pi P_{t|t-1}}} \\exp\\left(-\\frac{(x_t - m_{t|t-1})^2}{2P_{t|t-1}}\\right)\n$$\n\n其次，我们确定似然函数 $p(y_t \\mid x_t)$。观测模型为\n$$\ny_t = c\\,x_t + v_t\n$$\n其中测量噪声 $v_t \\sim \\mathcal{N}(0, r)$。对于给定的状态 $x_t$，观测值 $y_t$ 是一个高斯随机变量，其均值为 $\\mathbb{E}[y_t \\mid x_t] = \\mathbb{E}[c\\,x_t + v_t] = c\\,x_t$，方差为 $\\text{Var}(y_t \\mid x_t) = \\text{Var}(c\\,x_t + v_t) = \\text{Var}(v_t) = r$。因此，似然函数为：\n$$\np(y_t \\mid x_t) = \\mathcal{N}(y_t; c\\,x_t, r) = \\frac{1}{\\sqrt{2\\pi r}} \\exp\\left(-\\frac{(y_t - c\\,x_t)^2}{2r}\\right)\n$$\n\n现在，我们结合先验和似然。后验 $p(x_t \\mid y_t)$ 与它们的乘积成正比。由于两个高斯 PDF（作为 $x_t$ 的函数）的乘积是另一个（未归一化的）高斯 PDF，因此后验也将是高斯的。设其均值为 $m_t$，方差为 $P_t$。\n$$\np(x_t \\mid y_t) \\propto \\exp\\left(-\\frac{(x_t - m_{t|t-1})^2}{2P_{t|t-1}}\\right) \\exp\\left(-\\frac{(y_t - c\\,x_t)^2}{2r}\\right)\n$$\n为了找到后验分布 $\\mathcal{N}(x_t; m_t, P_t)$ 的参数 $m_t$ 和 $P_t$，我们分析乘积的指数部分，并省略不依赖于 $x_t$ 的项：\n$$\nL(x_t) = -\\frac{1}{2P_{t|t-1}}(x_t^2 - 2 m_{t|t-1} x_t + \\dots) - \\frac{1}{2r}(c^2 x_t^2 - 2c y_t x_t + \\dots)\n$$\n$$\nL(x_t) = -\\frac{1}{2} \\left[ \\left(\\frac{1}{P_{t|t-1}} + \\frac{c^2}{r}\\right)x_t^2 - 2\\left(\\frac{m_{t|t-1}}{P_{t|t-1}} + \\frac{c y_t}{r}\\right)x_t \\right] + \\text{const.}\n$$\n高斯 PDF $\\mathcal{N}(x_t; m_t, P_t)$ 的指数是 $-\\frac{1}{2P_t}(x_t - m_t)^2 + \\text{const.} = -\\frac{1}{2}\\left(\\frac{1}{P_t}x_t^2 - \\frac{2m_t}{P_t}x_t\\right) + \\text{const.}$。通过比较 $x_t^2$ 和 $x_t$ 的系数，我们可以确定 $m_t$ 和 $P_t$。\n\n匹配 $x_t^2$ 的系数：\n$$\n\\frac{1}{P_t} = \\frac{1}{P_{t|t-1}} + \\frac{c^2}{r} \\implies P_t = \\left(\\frac{1}{P_{t|t-1}} + \\frac{c^2}{r}\\right)^{-1} = \\frac{P_{t|t-1} r}{r + c^2 P_{t|t-1}}\n$$\n这就是后验方差。\n\n匹配 $x_t$ 的系数：\n$$\n\\frac{m_t}{P_t} = \\frac{m_{t|t-1}}{P_{t|t-1}} + \\frac{c y_t}{r}\n$$\n$$\nm_t = P_t \\left( \\frac{m_{t|t-1}}{P_{t|t-1}} + \\frac{c y_t}{r} \\right) = \\frac{P_{t|t-1} r}{r + c^2 P_{t|t-1}} \\left( \\frac{m_{t|t-1}}{P_{t|t-1}} + \\frac{c y_t}{r} \\right)\n$$\n$$\nm_t = \\frac{r m_{t|t-1} + P_{t|t-1} c y_t}{r + c^2 P_{t|t-1}}\n$$\n这个公式给出了后验均值 $m_t = \\mathbb{E}[x_t \\mid y_t]$。为了与标准卡尔曼滤波器公式保持一致，我们可以定义卡尔曼增益 $K_t$：\n$$\nK_t = \\frac{P_{t|t-1} c}{c^2 P_{t|t-1} + r}\n$$\n然后，后验均值可以重写为：\n$$\nm_t = m_{t|t-1} + K_t (y_t - c m_{t|t-1})\n$$\n\n总而言之，精确后验均值 $\\mathbb{E}[x_t \\mid y_t]$ 是通过以下两步过程计算的，该过程构成了标量卡尔曼滤波器：\n1.  **预测：**\n    $m_{t|t-1} = a\\,m_{t-1}$\n    $P_{t|t-1} = a^2 P_{t-1} + q$\n2.  **更新：**\n    $m_t = m_{t|t-1} + \\frac{P_{t|t-1} c}{c^2 P_{t|t-1} + r} (y_t - c m_{t|t-1})$\n\n序列重要性重采样（SIR）粒子滤波器为该后验均值提供了一个数值近似。它使用一组 $N$ 个加权粒子 $\\{x_t^{(i)}, w^{(i)}\\}_{i=1}^N$ 来表示后验分布。均值的估计是粒子位置的加权平均：$\\hat{m}_t^{\\text{PF}} = \\sum_{i=1}^N w^{(i)} x_t^{(i)}$。问题指定使用状态转移先验作为提议分布。这简化了权重计算，使得权重与给定粒子状态下观测值的似然成正比，$w^{(i)} \\propto p(y_t \\mid x_t^{(i)})$。实现将遵循指定的采样、传播、加权和估计步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by computing the absolute deviation between the exact\n    Kalman filter posterior mean and a particle filter estimate for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (a, q, c, r, m_tm1, P_tm1, y_t, N)\n        (0.9, 0.5, 1.2, 0.7, 0.3, 1.1, 0.8, 5),\n        # Case B\n        (1.0, 0.0, 1.0, 0.1, -0.2, 0.0, -0.15, 1),\n        # Case C\n        (-0.5, 0.2, -2.0, 0.5, 1.0, 2.0, -0.7, 10),\n        # Case D\n        (1.2, 0.1, 0.8, 5.0, 0.0, 0.5, 1.5, 2),\n        # Case E\n        (0.7, 1e-6, 1.0, 0.2, 2.0, 0.3, 2.1, 4),\n    ]\n\n    base_seed = 1729\n    deviations = []\n\n    for i, case in enumerate(test_cases):\n        a, q, c, r, m_tm1, P_tm1, y_t, N = case\n        \n        # --- 1. Exact Posterior Mean (Kalman Filter) ---\n        \n        # Prediction step\n        m_pred = a * m_tm1\n        P_pred = a**2 * P_tm1 + q\n        \n        # Update step\n        # Denominator of Kalman gain: c^2*P_pred + r. This is > 0 since r > 0.\n        # Handle P_pred = 0 case\n        if P_pred == 0:\n            kalman_gain = 0\n        else:\n            kalman_gain = (c * P_pred) / (c**2 * P_pred + r)\n        exact_mean = m_pred + kalman_gain * (y_t - c * m_pred)\n\n        # --- 2. Particle Filter Estimator ---\n        \n        # Set seed for reproducibility for this case\n        rng = np.random.default_rng(base_seed + i)\n        \n        # Step 1: Draw N samples from the prior N(m_{t-1}, P_{t-1})\n        # If P_tm1 is 0, scale=0 correctly produces deterministic samples m_tm1.\n        x_tm1_samples = rng.normal(loc=m_tm1, scale=np.sqrt(P_tm1), size=N)\n        \n        # Step 2: Propagate samples through state dynamics\n        # If q is 0, scale=0 correctly produces zero noise.\n        w_t_samples = rng.normal(loc=0, scale=np.sqrt(q), size=N)\n        x_t_samples = a * x_tm1_samples + w_t_samples\n\n        # Step 3: Compute and normalize importance weights\n        # Weights are proportional to the likelihood p(y_t | x_t^(i))\n        # Log-weights to avoid numerical underflow\n        log_weights = -0.5 * ((y_t - c * x_t_samples)**2) / r\n        \n        # Exponentiate safely by subtracting the max log-weight\n        if N > 0:\n            max_log_weight = np.max(log_weights)\n            unnorm_weights = np.exp(log_weights - max_log_weight)\n            sum_weights = np.sum(unnorm_weights)\n            \n            # Normalize weights\n            if sum_weights > 0:\n                norm_weights = unnorm_weights / sum_weights\n            else:\n                # Should not happen with non-zero r, but as a safeguard.\n                # Assign uniform weights if all are zero.\n                norm_weights = np.full(N, 1.0/N)\n        else: # Case with N=0 particles, not in test suite\n            norm_weights = np.array([])\n            \n        # Step 4: Form the particle-weighted mean\n        if N > 0:\n            pf_mean = np.sum(norm_weights * x_t_samples)\n        else:\n            pf_mean = 0.0 # Define for empty case\n\n        # --- 3. Compute Absolute Deviation ---\n        deviation = np.abs(pf_mean - exact_mean)\n        deviations.append(deviation)\n\n    # Format the final output string\n    formatted_results = [f\"{d:.10f}\" for d in deviations]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2996563"}]}