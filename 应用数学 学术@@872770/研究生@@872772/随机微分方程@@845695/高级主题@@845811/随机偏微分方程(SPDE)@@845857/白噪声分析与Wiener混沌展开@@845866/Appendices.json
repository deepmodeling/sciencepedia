{"hands_on_practices": [{"introduction": "掌握维纳混沌展开的第一步是能够将布朗运动的泛函分解为其正交分量。此练习 [@problem_id:3006136] 提供了一个经典示例，引导您找出积分平方布朗运动 $F = \\int_{0}^{1} W(t)^{2} dt$ 的混沌展开。通过从第一性原理应用伊藤等距性质 (Itō isometry)，您将计算出 $F$ 的方差，这是一项基本技能，它巩固了抽象核函数与具体统计属性之间的联系。", "problem": "设 $\\{W(t)\\}_{t \\in [0,1]}$ 为一个在具有其自然滤子的完备概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 上的标准一维布朗运动。在白噪声分析中，布朗运动可以通过多重 Wiener-Itō 积分来表示，并且 $W$ 的每个平方可积泛函都可以唯一地分解为称为 Wiener 混沌的正交分量。考虑平方可积布朗泛函\n$$\nF \\equiv \\int_{0}^{1} W(t)^{2} \\, dt.\n$$\n从 Itō 积分和 Wiener 混沌分解的基本定义出发（不使用任何现成的简化公式），运用第一性原理，通过确定 $F$ 的第二混沌分量并利用多重 Wiener-Itō 积分的正交性和等距性，求出 $F$ 的方差的精确值。请以精确形式（无舍入）给出您的最终答案。", "solution": "该问题是有效的，因为它具有科学依据、良定且客观。它提出了一个随机分析中的标准问题，可以使用指定的第一性原理 Wiener 混沌分解方法来解决。\n\n设 $\\{W(t)\\}_{t \\in [0,1]}$ 是一个标准一维布朗运动。我们需要计算随机变量 $F = \\int_{0}^{1} W(t)^{2} \\, dt$ 的方差。方差定义为 $\\text{Var}(F) = \\mathbb{E}[F^2] - (\\mathbb{E}[F])^2$。我们将使用 $F$ 的 Wiener 混沌展开来确定这个值。\n\n布朗运动的任何平方可积泛函 $F$ 都有一个唯一的正交分解，称为 Wiener 混沌展开：\n$$\nF = \\sum_{n=0}^{\\infty} I_n(f_n)\n$$\n其中 $I_n(f_n)$ 是一个对称的确定性核 $f_n \\in L^2([0,1]^n)$（即 $[0,1]^n$ 上的平方可积函数空间）的第 $n$ 重 Wiener-Itō 积分。项 $I_n(f_n)$ 称为 $F$ 的第 $n$ 混沌分量。\n\n这种展开的关键性质是：\n1.  第零混沌分量是 $F$ 的期望：$I_0(f_0) = \\mathbb{E}[F]$。\n2.  混沌分量在 $L^2(\\Omega)$ 中是正交的，即对于 $n \\neq m$ 有 $\\mathbb{E}[I_n(f_n) I_m(g_m)] = 0$。\n3.  Itō 等距性将 $L^2(\\Omega)$ 中的范数与 $L^2([0,1]^n)$ 中的范数联系起来：\n    $$\n    \\mathbb{E}[I_n(f_n)^2] = n! \\|f_n\\|_{L^2([0,1]^n)}^2 = n! \\int_{[0,1]^n} f_n(t_1, \\dots, t_n)^2 \\, dt_1 \\dots dt_n.\n    $$\n\n根据这些性质，$F$ 的方差可以表示为：\n$$\n\\text{Var}(F) = \\mathbb{E}[(F - \\mathbb{E}[F])^2] = \\mathbb{E}\\left[\\left(\\sum_{n=1}^{\\infty} I_n(f_n)\\right)^2\\right] = \\sum_{n=1}^{\\infty} \\mathbb{E}[I_n(f_n)^2] = \\sum_{n=1}^{\\infty} n! \\|f_n\\|_{L^2([0,1]^n)}^2.\n$$\n\n我们的策略是为特定的泛函 $F = \\int_{0}^{1} W(t)^{2} \\, dt$ 找到核 $f_n$。\n\n首先，我们将布朗运动 $W(t)$ 本身表示为一阶 Wiener-Itō 积分。对于一个固定的 $t \\in [0,1]$，$W(t)$ 由下式给出：\n$$\nW(t) = \\int_{0}^{t} 1 \\, dW(s) = \\int_{0}^{1} \\mathbf{1}_{[0,t]}(s) \\, dW(s)\n$$\n其中 $\\mathbf{1}_{[0,t]}(s)$ 是指示函数，当 $s \\in [0,t]$ 时为 $1$，否则为 $0$。这表明对于每个 $t$，$W(t)$ 都在第一 Wiener 混沌中，$W(t) = I_1(g_t)$，其核为 $g_t(s) = \\mathbf{1}_{[0,t]}(s)$。\n\n接下来，我们求 $W(t)^2$ 的混沌展开。两个一阶 Wiener 积分 $I_1(g)$ 和 $I_1(h)$ 的乘积由乘积公式给出：$I_1(g)I_1(h) = I_2(g \\otimes h) + \\langle g, h \\rangle_{L^2([0,1])}$。对于 $g=h=g_t$，我们有：\n$$\nW(t)^2 = I_1(g_t)^2 = I_2(g_t \\otimes g_t) + \\langle g_t, g_t \\rangle_{L^2([0,1])}\n$$\n内积项为：\n$$\n\\langle g_t, g_t \\rangle_{L^2([0,1])} = \\int_{0}^{1} (\\mathbf{1}_{[0,t]}(s))^2 \\, ds = \\int_{0}^{t} 1 \\, ds = t.\n$$\n二阶积分的核是 $(g_t \\otimes g_t)(s_1, s_2) = g_t(s_1)g_t(s_2) = \\mathbf{1}_{[0,t]}(s_1)\\mathbf{1}_{[0,t]}(s_2)$。这个核在 $s_1$ 和 $s_2$ 上已经是对称的。因此，我们得到 $W(t)^2$ 的混沌分解：\n$$\nW(t)^2 = t + I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}).\n$$\n项 $t$ 是第零混沌分量（期望 $\\mathbb{E}[W(t)^2]=t$），而 $I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]})$ 是第二混沌分量。\n\n现在，我们可以通过将 $W(t)^2$ 的表达式对 $t$ 从 $0$ 到 $1$ 积分来找到 $F$ 的分解：\n$$\nF = \\int_{0}^{1} W(t)^2 \\, dt = \\int_{0}^{1} \\left( t + I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\right) \\, dt = \\int_{0}^{1} t \\, dt + \\int_{0}^{1} I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt.\n$$\n第一项是一个确定性常数：\n$$\n\\int_{0}^{1} t \\, dt = \\left[\\frac{t^2}{2}\\right]_{0}^{1} = \\frac{1}{2}.\n$$\n这是 $F$ 的第零混沌分量，所以 $I_0(f_0) = \\frac{1}{2}$，这意味着 $\\mathbb{E}[F] = \\frac{1}{2}$。\n\n对于第二项，我们可以交换时间积分和随机积分（根据随机 Fubini 定理）：\n$$\n\\int_{0}^{1} I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt = I_2\\left(\\int_{0}^{1} (\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt\\right).\n$$\n这就得到了 $F$ 的第二混沌分量，我们记为 $F_2 = I_2(f_2)$。核 $f_2$ 是：\n$$\nf_2(s_1, s_2) = \\int_{0}^{1} (\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]})(s_1, s_2) \\, dt = \\int_{0}^{1} \\mathbf{1}_{[0,t]}(s_1) \\mathbf{1}_{[0,t]}(s_2) \\, dt.\n$$\n指示函数的乘积 $\\mathbf{1}_{[0,t]}(s_1) \\mathbf{1}_{[0,t]}(s_2)$ 为 $1$ 当且仅当 $s_1 \\le t$ 且 $s_2 \\le t$，这等价于 $\\max(s_1, s_2) \\le t$。因此，核是：\n$$\nf_2(s_1, s_2) = \\int_{0}^{1} \\mathbf{1}_{[\\max(s_1, s_2), 1]}(t) \\, dt = \\int_{\\max(s_1, s_2)}^{1} 1 \\, dt = 1 - \\max(s_1, s_2).\n$$\n这个核对于 $(s_1, s_2) \\in [0,1]^2$ 是良定的并且是对称的。\n\n因此，$F$ 的完整混沌展开是：\n$$\nF = \\frac{1}{2} + I_2(1 - \\max(s_1, s_2)).\n$$\n这表明 $F$ 仅在第零和第二混沌中有分量。第一混沌分量以及所有更高阶（$n \\geq 3$）的分量都为零。$F$ 的第二混沌分量是 $F_2 = I_2(1 - \\max(s_1, s_2))$。\n\n$F$ 的方差是其 $n \\ge 1$ 的混沌分量的方差之和。由于只有第二分量非零，方差就是这个分量的方差：\n$$\n\\text{Var}(F) = \\text{Var}(F_2) = \\mathbb{E}[(I_2(f_2))^2].\n$$\n使用 Itō 等距性，我们有：\n$$\n\\text{Var}(F) = 2! \\|f_2\\|_{L^2([0,1]^2)}^2 = 2 \\int_{0}^{1}\\int_{0}^{1} (f_2(s_1, s_2))^2 \\, ds_1 ds_2.\n$$\n我们现在必须计算这个积分：\n$$\n\\|f_2\\|^2 = \\int_{0}^{1}\\int_{0}^{1} (1 - \\max(s_1, s_2))^2 \\, ds_1 ds_2.\n$$\n由于被积函数的对称性，我们可以将定义域 $[0,1]^2$ 分成 $s_1 \\le s_2$ 和 $s_2 \\le s_1$ 的两个三角形区域，并在其中一个区域上计算积分，然后乘以 $2$。\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} \\left( \\int_{0}^{s_2} (1 - \\max(s_1, s_2))^2 \\, ds_1 \\right) ds_2.\n$$\n在积分区域 $0 \\le s_1 \\le s_2 \\le 1$ 中，我们有 $\\max(s_1, s_2) = s_2$。积分变为：\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} \\left( \\int_{0}^{s_2} (1 - s_2)^2 \\, ds_1 \\right) ds_2.\n$$\n内层积分为：\n$$\n\\int_{0}^{s_2} (1 - s_2)^2 \\, ds_1 = (1 - s_2)^2 \\int_{0}^{s_2} 1 \\, ds_1 = s_2(1 - s_2)^2.\n$$\n将此代入外层积分：\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} s_2(1 - s_2)^2 \\, ds_2 = 2 \\int_{0}^{1} s_2(1 - 2s_2 + s_2^2) \\, ds_2 = 2 \\int_{0}^{1} (s_2 - 2s_2^2 + s_2^3) \\, ds_2.\n$$\n计算该积分：\n$$\n\\|f_2\\|^2 = 2 \\left[ \\frac{s_2^2}{2} - \\frac{2s_2^3}{3} + \\frac{s_2^4}{4} \\right]_{0}^{1} = 2 \\left( \\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4} \\right) = 2 \\left( \\frac{6 - 8 + 3}{12} \\right) = 2 \\left( \\frac{1}{12} \\right) = \\frac{1}{6}.\n$$\n最后，我们计算 $F$ 的方差：\n$$\n\\text{Var}(F) = 2! \\|f_2\\|^2 = 2 \\times \\frac{1}{6} = \\frac{1}{3}.\n$$\n泛函 $F = \\int_{0}^{1} W(t)^{2} \\, dt$ 的方差为 $\\frac{1}{3}$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "3006136"}, {"introduction": "一旦我们理解了如何分解单个泛函，下一步就是分析它们之间的相互作用，例如它们的乘积。此问题 [@problem_id:3006137] 聚焦于多重维纳-伊东积分的强大乘积公式，该公式将两个混沌元素的乘积表示为一个新的混沌展开。通过计算两个二阶混沌变量乘积的展开式，您将获得关于核收缩 (kernel contraction) 的实践经验，这是白噪声分析中的一个核心代数工具。", "problem": "考虑一个完备概率空间上的标准布朗运动 $\\{B_{t}\\}_{t \\geq 0}$ 以及在 $L^{2}(\\mathbb{R}_{+})$ 上的相关等距正态高斯过程 $W$，其定义为 $W(h) = \\int_{0}^{\\infty} h(t) \\,\\mathrm{d}B_{t}$，其中 $h \\in L^{2}(\\mathbb{R}_{+})$。对于一个对称核 $f \\in L^{2}(\\mathbb{R}_{+}^{n})$，将多重维纳-伊藤积分 $I_{n}(f)$ 定义为满足等距性质 $\\mathbb{E}[I_{n}(f) I_{m}(g)] = \\delta_{n,m} \\, n! \\, \\langle f, g \\rangle_{L^{2}(\\mathbb{R}_{+}^{n})}$ 的n阶齐次混沌元，其中 $g \\in L^{2}(\\mathbb{R}_{+}^{m})$。在白噪声分析 (WNA) 中，多重积分的乘积具有一个维纳混沌展开 (WCE)，该展开式使用核的收缩来表示。令 $f \\in L^{2}(\\mathbb{R}_{+}^{p})$ 和 $g \\in L^{2}(\\mathbb{R}_{+}^{q})$ 之间的r阶收缩为映射 $f \\otimes_{r} g \\in L^{2}(\\mathbb{R}_{+}^{p+q-2r})$，它是通过对r个坐标进行相互积分得到的，并令 $\\widetilde{\\otimes}$ 表示对称化。\n\n固定参数 $\\alpha  0$ 和 $\\beta  0$，并定义 $h(t) = \\exp(-\\alpha t)$ 和 $k(t) = \\exp(-\\beta t)$，其中 $t \\geq 0$。考虑二阶混沌随机变量 $X = I_{2}(h^{\\otimes 2})$ 和 $Y = I_{2}(k^{\\otimes 2})$。从上述核心定义和收缩的组合结构出发，推导乘积 $XY$ 的维纳混沌展开（表示为4阶、2阶和0阶多重维纳-伊藤积分的和，其核是通过 $h$ 和 $k$ 的收缩构造的）。然后，将确定性系数（零阶混沌项）明确地表示为 $\\alpha$ 和 $\\beta$ 的函数。\n\n您的最终答案必须是 $XY$ 的维纳混沌展开中常数项的单一闭式解析表达式，以 $\\alpha$ 和 $\\beta$ 表示。无需进行四舍五入。", "solution": "问题要求的是两个二阶混沌随机变量 $X = I_{2}(h^{\\otimes 2})$ 和 $Y = I_{2}(k^{\\otimes 2})$ 乘积的维纳混沌展开中的确定性系数，即零阶项。\n\n解决此问题的基石是多重维纳-伊藤积分的乘法公式。设 $f \\in L^2(\\mathbb{R}_{+}^p)$ 和 $g \\in L^2(\\mathbb{R}_{+}^q)$ 为对称核。相应的多重积分 $I_p(f)$ 和 $I_q(g)$ 的乘积可以表示为一系列较低阶多重积分的和：\n$$ I_p(f) I_q(g) = \\sum_{r=0}^{\\min(p,q)} r! \\binom{p}{r} \\binom{q}{r} I_{p+q-2r}(f \\widetilde{\\otimes}_r g) $$\n其中 $f \\widetilde{\\otimes}_r g$ 表示核 $f$ 和 $g$ 的r阶收缩的对称化。收缩 $f \\otimes_r g$ 是一个 $L^2(\\mathbb{R}_{+}^{p+q-2r})$ 中的函数，通过对r个共享变量进行积分得到。\n\n在我们的具体问题中，我们有随机变量 $X = I_{2}(f)$ 和 $Y = I_{2}(g)$，其中核的阶数分别为 $p=2$ 和 $q=2$。核由函数 $h(t) = \\exp(-\\alpha t)$ 和 $k(t) = \\exp(-\\beta t)$ 的张量积给出：\n$$ f(t_1, t_2) = h(t_1)h(t_2) = \\exp(-\\alpha t_1 - \\alpha t_2) $$\n$$ g(s_1, s_2) = k(s_1)k(s_2) = \\exp(-\\beta s_1 - \\beta s_2) $$\n由于 $\\alpha  0$ 和 $\\beta  0$，确保了 $h, k \\in L^2(\\mathbb{R}_{+})$，因此这些核是 $L^2(\\mathbb{R}_{+}^2)$ 中的元素。根据其构造，它们也是对称的。\n\n应用 $p=2$ 和 $q=2$ 的乘法公式，我们有 $\\min(p,q)=2$。$XY$ 的展开式为：\n$$ XY = \\sum_{r=0}^{2} r! \\binom{2}{r} \\binom{2}{r} I_{4-2r}(f \\widetilde{\\otimes}_r g) $$\n让我们逐项展开这个和：\n对于 $r=0$：$0! \\binom{2}{0} \\binom{2}{0} I_4(f \\widetilde{\\otimes}_0 g) = I_4(f \\widetilde{\\otimes} g)$。这是四阶混沌分量。\n对于 $r=1$：$1! \\binom{2}{1} \\binom{2}{1} I_2(f \\widetilde{\\otimes}_1 g) = 4 I_2(f \\widetilde{\\otimes}_1 g)$。这是二阶混沌分量。\n对于 $r=2$：$2! \\binom{2}{2} \\binom{2}{2} I_0(f \\widetilde{\\otimes}_2 g) = 2 I_0(f \\otimes_2 g)$。这是零阶混沌分量。由于收缩 $f \\otimes_2 g$ 的结果是一个标量，其对称化就是它本身。\n\n问题要求我们找到确定性系数，这正是零阶混沌项。一个在0阶混沌中的随机变量 $I_0(c)$ 就是常数 $c \\in \\mathbb{R}$ 本身。该项也对应于随机变量的期望 $\\mathbb{E}[XY]$。\n\n因此，所求的系数是 $2 (f \\otimes_2 g)$。我们必须计算二阶收缩 $f \\otimes_2 g$。对于两个核 $f, g \\in L^2(\\mathbb{R}_{+}^2)$，这个收缩被定义为它们在 $L^2(\\mathbb{R}_{+}^2)$ 中的内积：\n$$ f \\otimes_2 g = \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} = \\int_{\\mathbb{R}_{+}^2} f(t_1, t_2) g(t_1, t_2) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\n代入 $f$ 和 $g$ 的显式形式：\n$$ f \\otimes_2 g = \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\left( \\exp(-\\alpha t_1 - \\alpha t_2) \\right) \\left( \\exp(-\\beta t_1 - \\beta t_2) \\right) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\n我们可以合并指数部分：\n$$ f \\otimes_2 g = \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t_1 - (\\alpha+\\beta)t_2) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\n该积分可分离为两个相同积分的乘积：\n$$ f \\otimes_2 g = \\left( \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t \\right) \\left( \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t \\right) $$\n我们来计算这个单积分。由于参数 $\\alpha$ 和 $\\beta$ 严格为正，它们的和 $\\alpha+\\beta$ 也严格为正，这确保了该广义积分的收敛性：\n$$ \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t = \\left[ -\\frac{1}{\\alpha+\\beta} \\exp(-(\\alpha+\\beta)t) \\right]_{t=0}^{t \\to \\infty} $$\n$$ = \\lim_{T \\to \\infty} \\left( -\\frac{1}{\\alpha+\\beta} \\exp(-(\\alpha+\\beta)T) \\right) - \\left( -\\frac{1}{\\alpha+\\beta} \\exp(0) \\right) $$\n$$ = 0 - \\left( -\\frac{1}{\\alpha+\\beta} \\right) = \\frac{1}{\\alpha+\\beta} $$\n将此结果代回收缩的表达式中：\n$$ f \\otimes_2 g = \\left( \\frac{1}{\\alpha+\\beta} \\right) \\left( \\frac{1}{\\alpha+\\beta} \\right) = \\frac{1}{(\\alpha+\\beta)^2} $$\n最后，零阶混沌项是 $2 (f \\otimes_2 g)$。\n$$ \\text{零阶项} = 2 \\times \\frac{1}{(\\alpha+\\beta)^2} = \\frac{2}{(\\alpha+\\beta)^2} $$\n这个结果可以通过使用维纳-伊藤等距性质直接计算期望 $\\mathbb{E}[XY]$ 来验证：\n$$ \\mathbb{E}[XY] = \\mathbb{E}[I_2(f) I_2(g)] = 2! \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} = 2 \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} $$\n这证实了我们的计算，因为 $\\mathbb{E}[XY]$ 正是 $XY$ 的维纳混沌展开中的零阶项。计算出的值为 $\\frac{2}{(\\alpha+\\beta)^2}$。", "answer": "$$\\boxed{\\frac{2}{(\\alpha+\\beta)^2}}$$", "id": "3006137"}, {"introduction": "维纳混沌的抽象框架通过正交多项式，特别是针对高斯过程的埃尔米特多项式 (Hermite polynomials)，找到了具体且可计算的表示。这个编程练习 [@problem_id:3006134] 使用威克指数 (Wick exponential)——白噪声分析的基石之一——来探索这种联系。通过实现截断展开式及其均方误差的计算，您将把理论公式转化为实用的数值算法，从而深入了解随机分析中的近似理论。", "problem": "考虑一个定义在带滤概率空间上的实值标准布朗运动 $W = \\{W_t\\}_{t \\ge 0}$，白噪声分析将其形式导数解释为高斯白噪声。对于固定的时间 $t  0$ 和参数 $\\lambda \\in \\mathbb{R}$，定义随机变量 $X_t$ 为 $X_t = \\exp\\left(\\lambda W_t - \\tfrac{1}{2}\\lambda^2 t\\right)$。这个随机变量是 $\\lambda W_t$ 的 Wick 指数，并且可以根据概率论学家的 Hermite 多项式进行 Wiener 混沌展开。Wiener 混沌展开基于 $L^2(\\Omega)$ 到齐次混沌的正交分解，其中第 n 阶混沌由 n 重 Wiener 积分张成，等价地，由 $H_n(Z)$ 张成，其中 $Z$ 是标准正态随机变量，$H_n$ 是概率论学家的 Hermite 多项式。概率论学家的 Hermite 多项式在标准正态定律下满足正交性，并用于刻画 Wiener 混沌展开。使用白噪声分析和 Wiener 混沌展开的这些基本定义，推导 $X_t$ 的 N 阶部分和近似的截断性质，并计算其导致的误差。\n\n你的程序必须为每个给定的测试用例 $(t,\\lambda,N)$ 实现以下计算：\n\n1. 计算 $X_t$ 的 N 阶截断 Wiener 混沌近似的二阶矩，记为 $S_N(t,\\lambda)$。该量是混沌系数的平方乘以由正交性导出的相应混沌范数之和，并且需要使用 Wiener 混沌基和概率论学家的 Hermite 多项式性质从第一性原理确定。\n\n2. 计算 $X_t$ 的 N 阶部分和近似的均方截断误差（即 $L^2(\\Omega)$ 误差的平方）$R_N(t,\\lambda)$。这是被忽略的混沌系数的平方乘以混沌范数之和，并应从正交性推导得出。\n\n3. 使用高斯矩生成函数和 $X_t$ 的定义计算精确二阶矩 $\\mathbb{E}[X_t^2]$。\n\n你的程序必须为每个测试用例按顺序 $[S_N(t,\\lambda), R_N(t,\\lambda), \\mathbb{E}[X_t^2]]$ 生成这三个量。计算中不涉及物理单位。\n\n测试套件：\n- 用例 A：$(t,\\lambda,N) = (1.0, 0.5, 5)$\n- 用例 B：$(t,\\lambda,N) = (0.0, 1.234, 3)$\n- 用例 C：$(t,\\lambda,N) = (2.0, 0.0, 10)$\n- 用例 D：$(t,\\lambda,N) = (1.5, 1.2, 0)$\n- 用例 E：$(t,\\lambda,N) = (3.0, 0.8, 20)$\n\n覆盖性设计：\n- 用例 B 测试边界 $t=0$，此时 $X_t$ 变为确定性的，截断是精确的。\n- 用例 C 测试边界 $\\lambda=0$，此时 $X_t$ 变为确定性的，截断是精确的。\n- 用例 D 测试边缘情况 $N=0$，此时仅捕获零阶混沌。\n- 用例 A 和 E 测试具有中等和较大截断阶数的一般非平凡情况。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例贡献一个包含三个浮点数的子列表，顺序为 $[S_N, R_N, \\mathbb{E}[X_t^2]]$。例如，输出形式应为 $[[S_N^{(A)}, R_N^{(A)}, E^{(A)}],[S_N^{(B)}, R_N^{(B)}, E^{(B)}],\\dots]$，不含任何附加文本。", "solution": "我们从布朗运动、白噪声分析和 Wiener 混沌展开的基本定义开始。设 $W = \\{W_t\\}_{t \\ge 0}$ 是一个标准布朗运动，考虑对于固定的 $t  0$ 和 $\\lambda \\in \\mathbb{R}$ 的随机变量 $X_t = \\exp\\left(\\lambda W_t - \\tfrac{1}{2}\\lambda^2 t\\right)$。定义 $Z = W_t / \\sqrt{t}$，这是一个标准正态随机变量。概率论学家的 Hermite 多项式 $H_n$ 为 $Z$ 的 $L^2$ 泛函提供了一个正交基，并生成了 Wiener 混沌分解。推导基于两个关键且经过充分检验的事实：\n\n1. 概率论学家的 Hermite 多项式满足正交关系 $\\mathbb{E}[H_n(Z)H_m(Z)] = n! \\,\\delta_{nm}$，其中 $\\delta_{nm}$ 是克罗内克 δ。\n\n2. 高斯生成函数恒等式成立：对于 $\\theta \\in \\mathbb{R}$ 和标准正态随机变量 $Z$，有 $\\exp\\left(\\theta Z - \\tfrac{1}{2}\\theta^2\\right) = \\sum_{n=0}^{\\infty} \\frac{\\theta^n}{n!} H_n(Z)$。该恒等式可由高斯分布的矩生成函数以及通过 Rodrigues 公式定义的 $H_n$ 推导得出。这是一个标准的、经过充分检验的公式，用于获得归一化高斯指数的 Hermite 展开。\n\n将此应用于 $\\theta = \\lambda \\sqrt{t}$ 和 $Z = W_t/\\sqrt{t}$，我们得到 Wiener 混沌展开\n$$\nX_t = \\sum_{n=0}^{\\infty} a_n(t,\\lambda) \\, H_n(Z), \\quad a_n(t,\\lambda) = \\frac{(\\lambda \\sqrt{t})^n}{n!}.\n$$\n这是将 $\\theta = \\lambda \\sqrt{t}$ 直接代入生成函数得到的。\n\n设 N 阶截断 Wiener 混沌近似为\n$$\nX_t^{(N)} = \\sum_{n=0}^{N} a_n(t,\\lambda) \\, H_n(Z).\n$$\n使用正交性，$X_t^{(N)}$ 的 $L^2(\\Omega)$ 范数的平方等于\n$$\n\\mathbb{E}\\left[(X_t^{(N)})^2\\right] = \\sum_{n=0}^{N} a_n(t,\\lambda)^2 \\, \\mathbb{E}[H_n(Z)^2] = \\sum_{n=0}^{N} \\left(\\frac{(\\lambda \\sqrt{t})^n}{n!}\\right)^2 n! = \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n定义 $S_N(t,\\lambda) := \\mathbb{E}\\left[(X_t^{(N)})^2\\right]$；则\n$$\nS_N(t,\\lambda) = \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n\n$X_t$ 和 $X_t^{(N)}$ 之间的均方截断误差（$L^2(\\Omega)$ 误差的平方）由尾部项的范数平方给出：\n$$\nR_N(t,\\lambda) := \\mathbb{E}\\left[\\left(X_t - X_t^{(N)}\\right)^2\\right] = \\sum_{n=N+1}^{\\infty} a_n(t,\\lambda)^2 \\, \\mathbb{E}[H_n(Z)^2] = \\sum_{n=N+1}^{\\infty} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n这里利用了正交性来消除交叉项，以及混沌分量在 $L^2(\\Omega)$ 中是正交的这一事实。\n\n为确定 $X_t$ 的精确二阶矩，注意到对于任意 $p \\in \\mathbb{R}$，有\n$$\nX_t^p = \\exp\\left(p \\lambda W_t - \\tfrac{1}{2} p \\lambda^2 t\\right).\n$$\n使用高斯矩生成函数 $\\mathbb{E}[\\exp(\\theta W_t)] = \\exp\\left(\\tfrac{1}{2}\\theta^2 t\\right)$，并令 $\\theta = p \\lambda$，我们得到\n$$\n\\mathbb{E}[X_t^p] = \\exp\\left(\\tfrac{1}{2} (p \\lambda)^2 t - \\tfrac{1}{2} p \\lambda^2 t\\right) = \\exp\\left(\\tfrac{1}{2}\\lambda^2 t (p^2 - p)\\right).\n$$\n令 $p=2$ 可得\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left(\\lambda^2 t\\right).\n$$\n结合 $S_N(t,\\lambda)$ 和 $R_N(t,\\lambda)$ 的表达式与 $\\mathbb{E}[X_t^2]$，注意到 $\\mathbb{E}[X_t^2] = S_N(t,\\lambda) + R_N(t,\\lambda)$，因此\n$$\nR_N(t,\\lambda) = \\exp\\left(\\lambda^2 t\\right) - \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n\n算法设计：\n- 对于每个测试用例，计算 $\\beta := \\lambda^2 t$。\n- 通过级数 $\\sum_{n=0}^N \\beta^n / n!$ 的迭代求和来计算 $S_N(t,\\lambda)$，使用项的递推关系 $T_0 = 1$ 和 $T_{n} = T_{n-1} \\cdot \\beta / n$ 来确保数值稳定性和效率。\n- 计算精确二阶矩 $E_{\\text{exact}} = \\exp(\\beta)$。\n- 计算截断误差 $R_N(t,\\lambda) = E_{\\text{exact}} - S_N(t,\\lambda)$。\n- 为每个测试用例汇总三个值 $[S_N, R_N, E_{\\text{exact}}]$。\n\n边缘情况与正确性：\n- 如果 $t=0$，则 $\\beta=0$ 且 $X_t=1$ 几乎必然成立。因此，$S_N=1$，$E_{\\text{exact}}=1$，且 $R_N=0$。\n- 如果 $\\lambda=0$，则 $\\beta=0$ 且 $X_t=1$ 几乎必然成立。所得值与上述情况相同。\n- 如果 $N=0$，则 $S_0=1$，$R_0 = \\exp(\\beta) - 1$，这只匹配了零阶混沌的贡献。\n- 对于一般的 $t  0$ 和 $\\lambda \\ne 0$，$S_N$ 是指数级数在 $\\beta$ 处的 N 阶部分和，$R_N$ 是对应的尾部；通过稳定的递推关系进行数值评估可确保对所提供用例的精确计算。\n\n最终程序为指定的测试套件计算这些量，并按要求的精确格式打印一行包含各用例结果的列表。", "answer": "```python\nimport numpy as np\n\ndef partial_sum_exp_series(beta: float, N: int) - float:\n    \"\"\"\n    Compute S_N = sum_{n=0}^N beta^n / n! using a stable recurrence.\n    \"\"\"\n    term = 1.0  # beta^0 / 0! = 1\n    s = term\n    for n in range(1, N + 1):\n        term *= beta / n\n        s += term\n    return s\n\ndef compute_case(t: float, lam: float, N: int):\n    \"\"\"\n    For given (t, lam, N), compute:\n    - S_N: second moment of the truncated chaos approximation\n    - R_N: mean-square truncation error\n    - E_exact: exact second moment E[X_t^2]\n    \"\"\"\n    beta = (lam ** 2) * t\n    S_N = partial_sum_exp_series(beta, N)\n    E_exact = float(np.exp(beta))\n    R_N = E_exact - S_N\n    return [S_N, R_N, E_exact]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.5, 5),   # Case A\n        (0.0, 1.234, 3), # Case B: t=0 boundary\n        (2.0, 0.0, 10),  # Case C: lambda=0 boundary\n        (1.5, 1.2, 0),   # Case D: N=0 edge\n        (3.0, 0.8, 20),  # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        t, lam, N = case\n        result = compute_case(t, lam, N)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Single line output: list of per-case lists.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3006134"}]}