{"hands_on_practices": [{"introduction": "Skorohod 积分将随机积分的概念推广到了预知（anticipating）被积过程，这些过程可能依赖于布朗运动的整个路径。本练习旨在通过与 Malliavin 导数的对偶关系，直接计算此类积分，从而提供基础性实践。通过为预知过程 $u_t = B_T$ 显式计算 $\\delta(u)$ [@problem_id:2986329]，您将巩固对该算子的理解，并明晰其与其他形式随机积分（如前向积分）的联系。", "problem": "固定一个时间范围 $T>0$，并考虑经典的 Wiener 空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$，该空间赋有由标准布朗运动 $(B_t)_{t\\in[0,T]}$（其中 $B_0=0$）生成的标准滤子。令 $H:=L^2([0,T])$ 为 Cameron–Martin 空间，并将确定性函数 $h\\in H$ 的 Wiener 积分记为 $W(h):=\\int_0^T h(t)\\,dB_t$。对于一个光滑柱状泛函 $F=f\\big(W(h_1),\\dots,W(h_n)\\big)$，其中 $f\\in C_b^\\infty(\\mathbb{R}^n)$ 且 $h_i\\in H$，其 Malliavin 导数 $D F$ 是一个取值于 $H$ 的随机变量，定义为 $D_t F=\\sum_{i=1}^n \\partial_i f\\big(W(h_1),\\dots,W(h_n)\\big)\\,h_i(t)$。对于一个过程 $u\\in L^2(\\Omega;H)$，其 Skorohod 积分 $\\delta(u)$（当其存在时）由对偶关系 $\\mathbb{E}[F\\,\\delta(u)]=\\mathbb{E}[\\langle D F,u\\rangle_H]$ 定义，此关系对所有这样的 $F$ 成立，其中 $\\langle \\cdot,\\cdot\\rangle_H$ 表示 $H$ 中的内积。一个标准的事实是，对于确定性函数 $h\\in H$，有 $\\delta(h)=W(h)$。\n  \n定义预测被积函数 $u=(u_t)_{t\\in[0,T]}$ 为 $u_t:=B_T$，对所有 $t\\in[0,T]$ 成立。仅从上述定义以及 $B_T$ 的基本高斯矩恒等式出发，完成以下任务：\n  \n1. 证明 $u\\in\\mathrm{Dom}(\\delta)$，即 Skorohod 积分的定义域。\n2. 将 $\\delta(u)$ 作为 $L^2(\\Omega)$ 中的一个元素进行显式计算。\n3. 计算 $\\mathbb{E}[\\delta(u)]$ 和 $\\mathrm{Var}(\\delta(u))$。\n4. 使用 Russo–Vallois 前向积分 $\\int_0^T u_t\\,d^{-}B_t$ 的定义，即前向黎曼和 $\\sum_{k} u_{t_k}\\big(B_{t_{k+1}}-B_{t_k}\\big)$ 在 $[0,T]$ 的划分网格趋于 $0$ 时的依概率极限，计算此 $u$ 对应的 $\\int_0^T u_t\\,d^{-}B_t$，并通过 Malliavin 导数 $D_t u_t$ 将其与 $\\delta(u)$ 联系起来。\n  \n请给出 $\\delta(u)$ 关于 $B_T$ 和 $T$ 的闭式解析表达式作为最终答案。无需四舍五入，也不涉及单位。", "solution": "该问题是适定的，并且在 Malliavin 微积分的框架内具有坚实的科学基础。我们开始进行解答。\n\n被积过程定义为 $u_t := B_T$，对所有 $t \\in [0,T]$ 成立。这可以写作 $u = B_T \\cdot \\mathbf{1}$，其中 $\\mathbf{1}$ 是在 $[0,T]$ 上恒等于 $1$ 的函数。由于 $\\mathbf{1} \\in L^2([0,T]) = H$，因此 $u$ 是一个取值于 $H$ 的随机变量。\n\n1. 证明 $u \\in \\mathrm{Dom}(\\delta)$。\n为了证明 $u$ 属于 Skorohod 积分的定义域 $\\mathrm{Dom}(\\delta)$，我们必须验证两个条件：\n(a) $u \\in L^2(\\Omega; H)$。\n(b) 映射 $F \\mapsto \\mathbb{E}[\\langle DF, u \\rangle_H]$ 在光滑柱状泛函空间上关于 $L^2(\\Omega)$ 范数是连续的。\n\n对于条件 (a)，我们计算 $u$ 在 $L^2(\\Omega; H)$ 中的范数的平方：\n$$ \\mathbb{E}\\left[ \\|u\\|_H^2 \\right] = \\mathbb{E}\\left[ \\int_0^T u_t^2 \\, dt \\right] = \\mathbb{E}\\left[ \\int_0^T B_T^2 \\, dt \\right] $$\n根据 Fubini 定理，我们可以交换期望和积分的顺序：\n$$ \\int_0^T \\mathbb{E}\\left[ B_T^2 \\right] \\, dt = \\int_0^T T \\, dt = T^2 $$\n由于 $T^2  \\infty$，我们证明了 $u \\in L^2(\\Omega; H)$。\n\n对于条件 (b)，我们分析光滑柱状泛函 $F$ 的表达式 $\\mathbb{E}[\\langle DF, u \\rangle_H]$。\n$$ \\mathbb{E}[\\langle DF, u \\rangle_H] = \\mathbb{E}\\left[ \\int_0^T (D_t F) u_t \\, dt \\right] = \\mathbb{E}\\left[ B_T \\int_0^T D_t F \\, dt \\right] $$\n我们使用分部积分法。考虑乘积 $B_T F$。其 Malliavin 导数由乘法法则给出：\n$$ D_t(B_T F) = F (D_t B_T) + B_T (D_t F) $$\n时刻 $T$ 的布朗运动可以写成 Wiener 积分 $B_T = \\int_0^T 1 \\, dB_s$。这样一个积分的 Malliavin 导数是 $D_t B_T = D_t \\left(\\int_0^T \\mathbf{1}(s) \\, dB_s\\right) = \\mathbf{1}(t) = 1$，对 $t \\in [0,T]$ 成立。所以，\n$$ D_t(B_T F) = F + B_T D_t F $$\n现在，考虑导数 $D$ 和 Wiener 积分 $W(h) = \\int_0^T h(s) \\, dB_s$ 之间的对偶关系。对于一个一般的光滑泛函 $G$ 和 $h \\in H$，我们有 $\\mathbb{E}[\\langle DG, h \\rangle_H] = \\mathbb{E}[G W(h)]$。令 $G = B_T F$ 且 $h = \\mathbf{1}$。那么 $W(\\mathbf{1}) = B_T$。\n$$ \\mathbb{E}[\\langle D(B_T F), \\mathbf{1} \\rangle_H] = \\mathbb{E}[(B_T F) W(\\mathbf{1})] = \\mathbb{E}[B_T^2 F] $$\n另一方面，我们可以直接计算内积：\n$$ \\mathbb{E}[\\langle D(B_T F), \\mathbf{1} \\rangle_H] = \\mathbb{E}\\left[ \\int_0^T D_t(B_T F) \\cdot 1 \\, dt \\right] = \\mathbb{E}\\left[ \\int_0^T (F + B_T D_t F) \\, dt \\right] $$\n$$ = \\mathbb{E}\\left[ F \\int_0^T 1 \\, dt + B_T \\int_0^T D_t F \\, dt \\right] = \\mathbb{E}[T F] + \\mathbb{E}\\left[ B_T \\int_0^T D_t F \\, dt \\right] $$\n将 $\\mathbb{E}[\\langle D(B_T F), \\mathbf{1} \\rangle_H]$ 的两个表达式相等，我们得到：\n$$ \\mathbb{E}[B_T^2 F] = T \\mathbb{E}[F] + \\mathbb{E}\\left[ B_T \\int_0^T D_t F \\, dt \\right] $$\n整理后得到我们寻求的表达式：\n$$ \\mathbb{E}[\\langle DF, u \\rangle_H] = \\mathbb{E}\\left[ B_T \\int_0^T D_t F \\, dt \\right] = \\mathbb{E}[B_T^2 F] - T \\mathbb{E}[F] = \\mathbb{E}[(B_T^2 - T)F] $$\n现在连续性条件就很明显了。根据 Cauchy-Schwarz 不等式：\n$$ |\\mathbb{E}[(B_T^2 - T)F]| \\le \\| B_T^2 - T \\|_{L^2(\\Omega)} \\| F \\|_{L^2(\\Omega)} $$\n由于 $B_T \\sim N(0,T)$，其所有矩都是有限的，这意味着 $\\| B_T^2 - T \\|_{L^2(\\Omega)}$ 是一个有限常数。因此，映射 $F \\mapsto \\mathbb{E}[\\langle DF, u \\rangle_H]$ 是连续的，这就完成了对 $u \\in \\mathrm{Dom}(\\delta)$ 的证明。\n\n2. 显式计算 $\\delta(u)$。\nSkorohod 积分 $\\delta(u)$ 被定义为 $L^2(\\Omega)$ 中满足以下对偶关系的唯一元素：\n$$ \\mathbb{E}[F \\delta(u)] = \\mathbb{E}[\\langle DF, u \\rangle_H] $$\n此关系对所有光滑柱状泛函 $F$ 成立。从第 1 部分的工作中，我们发现：\n$$ \\mathbb{E}[\\langle DF, u \\rangle_H] = \\mathbb{E}[(B_T^2 - T)F] $$\n因此，我们必有：\n$$ \\mathbb{E}[F \\delta(u)] = \\mathbb{E}[(B_T^2 - T)F] $$\n由于光滑柱状泛函空间在 $L^2(\\Omega)$ 中是稠密的，这个等式意味着随机变量本身必须几乎必然相等。\n$$ \\delta(u) = B_T^2 - T $$\n\n3. 计算 $\\mathbb{E}[\\delta(u)]$ 和 $\\mathrm{Var}(\\delta(u))$。\n使用 $\\delta(u)$ 的表达式，我们计算其期望：\n$$ \\mathbb{E}[\\delta(u)] = \\mathbb{E}[B_T^2 - T] = \\mathbb{E}[B_T^2] - T $$\n由于 $B_T$ 是一个均值为 0、方差为 $T$ 的正态随机变量，其二阶矩为 $\\mathbb{E}[B_T^2] = T$。\n$$ \\mathbb{E}[\\delta(u)] = T - T = 0 $$\n接下来，我们计算方差：\n$$ \\mathrm{Var}(\\delta(u)) = \\mathrm{Var}(B_T^2 - T) = \\mathrm{Var}(B_T^2) $$\n方差由 $\\mathrm{Var}(B_T^2) = \\mathbb{E}[(B_T^2)^2] - (\\mathbb{E}[B_T^2])^2 = \\mathbb{E}[B_T^4] - T^2$ 给出。\n对于一个中心正态随机变量 $X \\sim N(0, \\sigma^2)$，其四阶矩为 $\\mathbb{E}[X^4] = 3\\sigma^4$。对于 $B_T$，我们有 $\\sigma^2 = T$，所以 $\\mathbb{E}[B_T^4] = 3T^2$。\n$$ \\mathrm{Var}(\\delta(u)) = 3T^2 - T^2 = 2T^2 $$\n\n4. 计算 Russo-Vallois 前向积分并将其与 $\\delta(u)$ 联系起来。\nRusso-Vallois 前向积分由前向黎曼和的依概率极限定义：\n$$ \\int_0^T u_t \\, d^-B_t = \\lim_{\\|\\pi_n\\| \\to 0} \\sum_{k=0}^{n-1} u_{t_k} (B_{t_{k+1}} - B_{t_k}) $$\n其中 $\\pi_n = \\{0=t_0  t_1  \\dots  t_n = T\\}$ 是 $[0,T]$ 的一个划分。对于我们的被积函数 $u_t = B_T$，对于任意划分 $\\pi_n$，其和为：\n$$ \\sum_{k=0}^{n-1} B_T (B_{t_{k+1}} - B_{t_k}) = B_T \\sum_{k=0}^{n-1} (B_{t_{k+1}} - B_{t_k}) $$\n这是一个裂项求和：\n$$ B_T ( (B_{t_1} - B_{t_0}) + (B_{t_2} - B_{t_1}) + \\dots + (B_{t_n} - B_{t_{n-1}}) ) = B_T (B_{t_n} - B_{t_0}) = B_T (B_T - B_0) $$\n由于 $B_0=0$，无论划分如何，该和都恰好是 $B_T^2$。因此，极限是平凡的：\n$$ \\int_0^T u_t \\, d^-B_t = B_T^2 $$\n为了将其与 $\\delta(u)$ 联系起来，我们使用一般恒等式（Hitsuda-Skorohod 恒等式），该恒等式将 Skorohod 积分与此前向积分联系起来：\n$$ \\int_0^T u_t \\, d^-B_t = \\delta(u) + \\int_0^T D_t u_t \\, dt $$\n项 $\\int_0^T D_t u_t \\, dt$ 是过程 $u$ 的 Malliavin 导数的迹。我们来计算它。过程为 $u_t = B_T$。其在时刻 $s$ 的 Malliavin 导数为 $D_s u_t = D_s B_T = 1$，对所有 $s,t \\in [0,T]$ 成立。\n迹要求在与过程相同的时间指标上（即 $s=t$）计算导数。所以，$D_t u_t = 1$。\n那么迹的积分是：\n$$ \\int_0^T D_t u_t \\, dt = \\int_0^T 1 \\, dt = T $$\n将我们的结果代回恒等式中，我们验证其正确性：\n$$ \\int_0^T u_t \\, d^-B_t = B_T^2 $$\n$$ \\delta(u) + \\int_0^T D_t u_t \\, dt = (B_T^2 - T) + T = B_T^2 $$\n该恒等式成立，建立了 $u$ 的 Skorohod 积分与其 Russo-Vallois 前向积分之间的关系，这个关系是通过其 Malliavin 导数的迹建立的。所要求的最终答案是 $\\delta(u)$ 的表达式。", "answer": "$$\n\\boxed{B_T^2 - T}\n$$", "id": "2986329"}, {"introduction": "Malliavin 算子的一个强大应用在于判断一个随机变量的概率分布是否拥有密度函数。Malliavin 协方差矩阵是进行此项分析的核心工具。本实践问题 [@problem_id:2986307] 通过一个清晰的退化随机向量案例阐释了这一原理，其中协方差矩阵的行列式为零，直接导致其概率测度是奇异的。", "problem": "设 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 是承载标准布朗运动 $(B_t)_{t\\in[0,1]}$ 的经典维纳空间。考虑由 $h(t)=\\mathbf{1}_{[0,1/2]}(t)$ 和 $k(t)=2\\,\\mathbf{1}_{[0,1/2]}(t)$ 定义的确定性函数 $h:[0,1]\\to\\mathbb{R}$ 和 $k:[0,1]\\to\\mathbb{R}$。定义 $\\mathbb{R}^2$ 值的随机变量 $F=(F_1,F_2)$ 如下\n$$\nF_1=\\int_0^1 h(t)\\,\\mathrm{d}B_t,\\qquad F_2=\\int_0^1 k(t)\\,\\mathrm{d}B_t.\n$$\n你可以使用以下基本事实：(i) 对于一个确定性的 $h\\in L^2([0,1])$, 维纳积分 $\\int_0^1 h(t)\\,\\mathrm{d}B_t$ 是一个中心高斯随机变量，其方差为 $\\int_0^1 h(t)^2\\,\\mathrm{d}t$, (ii) Malliavin导数 $D_t\\!\\left(\\int_0^1 h(s)\\,\\mathrm{d}B_s\\right)=h(t)$ 对于几乎所有的 $t\\in[0,1]$ 成立，以及 (iii) 对于分量在Malliavin导数定义域内的有限维随机向量 $F=(F_1,\\dots,F_n)$，其Malliavin协方差矩阵是 $n\\times n$ 矩阵 $\\Gamma_F=\\left(\\int_0^1 D_t F_i\\,D_t F_j\\,\\mathrm{d}t\\right)_{1\\le i,j\\le n}$。\n\n请根据第一性原理执行以下步骤：\n- 计算Malliavin导数 $D_t F$，并用 $h$ 和 $k$ 表示Malliavin协方差矩阵 $\\Gamma_F$。\n- 显式计算 $\\Gamma_F$ 的行列式。\n- 仅使用高斯测度的基本性质以及关于 $\\mathbb{R}^2$ 上勒贝格测度的绝对连续性定义，解释 $F$ 的定律是绝对连续的还是奇异的。\n\n请仅提供 $\\det(\\Gamma_F)$ 的精确值作为最终答案，无需近似。不涉及单位。", "solution": "问题陈述已经过验证，被认为是有效的。它内容自洽，科学上基于随机分析理论，并且提法明确。我们可以开始解答。\n\n该问题要求我们分析由关于标准一维布朗运动 $(B_t)_{t\\in[0,1]}$ 的维纳积分定义的随机向量 $F=(F_1,F_2)$。$F$ 的分量由下式给出：\n$$\nF_1=\\int_0^1 h(t)\\,\\mathrm{d}B_t,\\qquad F_2=\\int_0^1 k(t)\\,\\mathrm{d}B_t\n$$\n其中确定性被积函数为 $h(t)=\\mathbf{1}_{[0,1/2]}(t)$ 和 $k(t)=2\\,\\mathbf{1}_{[0,1/2]}(t)$。这里，$\\mathbf{1}_A(t)$ 是集合 $A$ 的指示函数。\n\n第一步是计算向量 $F$ 的Malliavin导数。Malliavin导数 $D_t F$ 是一个过程向量，$(D_t F_1, D_t F_2)$。使用给定的性质(ii)，对于一个确定性被积函数 $g \\in L^2([0,1])$，维纳积分 $\\int_0^1 g(s)\\,\\mathrm{d}B_s$ 的Malliavin导数由 $D_t\\left(\\int_0^1 g(s)\\,\\mathrm{d}B_s\\right) = g(t)$ 给出，对于几乎所有的 $t \\in [0,1]$ 成立。\n\n将此应用于 $F_1$ 和 $F_2$，我们得到：\n$$\nD_t F_1 = h(t) = \\mathbf{1}_{[0,1/2]}(t)\n$$\n$$\nD_t F_2 = k(t) = 2\\,\\mathbf{1}_{[0,1/2]}(t)\n$$\n对于几乎所有的 $t \\in [0,1]$。\n\n第二步是计算Malliavin协方差矩阵 $\\Gamma_F$。根据性质(iii)，这是一个 $2 \\times 2$ 矩阵，其元素是Malliavin导数在希尔伯特空间 $L^2([0,1])$ 中的内积。元素 $(\\Gamma_F)_{ij}$ 由 $\\int_0^1 D_t F_i\\,D_t F_j\\,\\mathrm{d}t$ 给出。\n\n我们来计算 $\\Gamma_F$ 的四个元素：\n第 $(1,1)$ 个元素是：\n$$\n(\\Gamma_F)_{11} = \\int_0^1 (D_t F_1)^2\\,\\mathrm{d}t = \\int_0^1 h(t)^2\\,\\mathrm{d}t = \\int_0^1 \\left(\\mathbf{1}_{[0,1/2]}(t)\\right)^2\\,\\mathrm{d}t = \\int_0^{1/2} 1^2\\,\\mathrm{d}t = \\frac{1}{2}\n$$\n第 $(1,2)$ 个元素是：\n$$\n(\\Gamma_F)_{12} = \\int_0^1 (D_t F_1)(D_t F_2)\\,\\mathrm{d}t = \\int_0^1 h(t)k(t)\\,\\mathrm{d}t = \\int_0^1 \\left(\\mathbf{1}_{[0,1/2]}(t)\\right)\\left(2\\,\\mathbf{1}_{[0,1/2]}(t)\\right)\\,\\mathrm{d}t = \\int_0^{1/2} 2\\,\\mathrm{d}t = 2 \\times \\frac{1}{2} = 1\n$$\n第 $(2,1)$ 个元素等于第 $(1,2)$ 个元素，因为该矩阵是对称的：\n$$\n(\\Gamma_F)_{21} = \\int_0^1 (D_t F_2)(D_t F_1)\\,\\mathrm{d}t = (\\Gamma_F)_{12} = 1\n$$\n第 $(2,2)$ 个元素是：\n$$\n(\\Gamma_F)_{22} = \\int_0^1 (D_t F_2)^2\\,\\mathrm{d}t = \\int_0^1 k(t)^2\\,\\mathrm{d}t = \\int_0^1 \\left(2\\,\\mathbf{1}_{[0,1/2]}(t)\\right)^2\\,\\mathrm{d}t = \\int_0^{1/2} 4\\,\\mathrm{d}t = 4 \\times \\frac{1}{2} = 2\n$$\n所以，Malliavin协方差矩阵是：\n$$\n\\Gamma_F = \\begin{pmatrix} 1/2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n\n第三步是计算 $\\Gamma_F$ 的行列式。\n$$\n\\det(\\Gamma_F) = \\left(\\frac{1}{2}\\right) \\times 2 - 1 \\times 1 = 1 - 1 = 0\n$$\n\n问题的最后一部分要求我们确定 $F$ 的定律是相对于 $\\mathbb{R}^2$ 上的勒贝格测度是绝对连续的还是奇异的。\n\n随机分析中的一个基本结果指出，对于一个分量在Malliavin导数定义域内的随机向量 $F$，$F$ 的定律相对于勒贝格测度是绝对连续的，当且仅当其Malliavin协方差矩阵 $\\Gamma_F$ 是可逆的，即 $\\det(\\Gamma_F) \\neq 0$。\n\n在我们的例子中，我们发现 $\\det(\\Gamma_F)=0$。这表明 $F$ 的定律不是绝对连续的；它是奇异的。让我们按要求从第一性原理来解释这一点。\n\n向量 $F = (F_1, F_2)$ 是一个中心高斯向量，因为它的分量是确定性函数的维纳积分。对于一个高斯向量，Malliavin协方差矩阵 $\\Gamma_F$ 与通常的协方差矩阵 $C_F = (\\mathbb{E}[F_i F_j])_{i,j}$ 一致。$\\det(C_F) = 0$ 这一事实意味着高斯分布是退化的。在 $\\mathbb{R}^2$ 中的退化高斯分布相对于二维勒贝格测度 $\\lambda_2$ 没有概率密度函数。其概率质量集中在一个低维仿射子空间上，在本例中是一条过原点的直线。\n\n我们来更明确地说明。概率测度 $\\mu_F$（$F$ 的定律）相对于勒贝格测度 $\\lambda_2$ 的绝对连续性定义是：对于任何Borel集 $A \\subset \\mathbb{R}^2$，如果 $\\lambda_2(A)=0$，则 $\\mu_F(A) = \\mathbb{P}(F \\in A) = 0$。\n为了证明该定律是奇异的，我们必须找到一个集合 $A_0$，使得 $\\lambda_2(A_0)=0$ 但 $\\mathbb{P}(F \\in A_0)  0$。\n\n考虑被积函数 $h(t)$ 和 $k(t)$ 之间的关系：\n$$\nk(t) = 2\\,\\mathbf{1}_{[0,1/2]}(t) = 2\\,h(t)\n$$\n利用维纳积分的线性性质，我们可以将 $F_2$ 与 $F_1$ 联系起来：\n$$\nF_2 = \\int_0^1 k(t)\\,\\mathrm{d}B_t = \\int_0^1 2\\,h(t)\\,\\mathrm{d}B_t = 2 \\int_0^1 h(t)\\,\\mathrm{d}B_t = 2F_1\n$$\n这个关系 $F_2 = 2F_1$ 几乎必然成立。这意味着随机向量 $F=(F_1, F_2)$ 被限制在直线 $L = \\{(x,y) \\in \\mathbb{R}^2 \\mid y=2x\\}$ 上。$F$ 分布的全部概率质量都支撑在这条直线上。\n\n直线 $L$ 的二维勒贝格测度为 $\\lambda_2(L)=0$。然而，$F$ 位于这条直线上的概率是：\n$$\n\\mathbb{P}(F \\in L) = \\mathbb{P}(F_2 = 2F_1) = 1\n$$\n因为我们找到了一个集合 $L$，它满足 $\\lambda_2(L)=0$ 且 $\\mathbb{P}(F \\in L) = 1  0$，所以绝对连续性的条件被违反了。因此，$F$ 的定律相对于 $\\mathbb{R}^2$ 上的勒贝格测度是奇异的。这证实了 $\\det(\\Gamma_F)=0$ 的推论。", "answer": "$$\\boxed{0}$$", "id": "2986307"}, {"introduction": "Clark-Ocone 公式是随机分析的一块基石，它为布朗运动泛函的鞅表示定理中的被积过程提供了一个显式表达式。本练习 [@problem_id:3000571] 将引导您为金融领域中一个重要的例子——欧式看涨期权的回报——推导其鞅表示。同时，它还引入了一项关键技巧：光滑近似法，这对于将 Malliavin 算子应用于实践中常见的不可微函数至关重要。", "problem": "设 $\\{W_{t}\\}_{t \\in [0,T]}$ 为一个在满足通常条件的带滤概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\in [0,T]},\\mathbb{P})$ 上的标准布朗运动。考虑终端泛函 $F = \\max(W_{T},0)$。\n\n1. 构造一个光滑函数族 $\\{f_{\\epsilon}\\}_{\\epsilon0}$，$f_{\\epsilon}:\\mathbb{R}\\to\\mathbb{R}$，使得当 $\\epsilon \\to 0$ 时，$f_{\\epsilon}(x) \\to x^{+}$ 逐点收敛，并且对于每个固定的 $\\epsilon0$，$f_{\\epsilon}$ 具有有界且连续的一阶导数。证明当 $\\epsilon \\to 0$ 时，$f_{\\epsilon}(W_{T}) \\to F$ 在 $L^{2}(\\Omega)$ 中收敛。\n\n2. 使用 Wiener 空间上 Malliavin 积分学的基本定义（特别是 $W_{T}$ 的泛函的 Malliavin 导数和链式法则），计算 Malliavin 导数 $D_{t}\\big(f_{\\epsilon}(W_{T})\\big)$，其中 $t \\in [0,T]$。\n\n3. 使用布朗增量的独立性和条件期望的标准性质，将 $\\mathbb{E}\\big[D_{t}\\big(f_{\\epsilon}(W_{T})\\big)\\,|\\,\\mathcal{F}_{t}\\big]$ 用 $W_{t}$ 和 $W_{T}-W_{t}$ 的分布来表示。然后分析当 $\\epsilon \\to 0$ 时的极限，以获得在 $F$ 关于 $\\{W_{t}\\}$ 的鞅表示中出现的可预测被积函数 $g_{t}$。\n\n你的最终任务是报告在步骤 3 中获得的 $g_{t}$ 的极限解析表达式（对 $t \\in [0,T)$ 有效）。最终答案必须是单一的封闭形式表达式。", "solution": "该问题要求在泛函 $F = \\max(W_{T},0) = W_{T}^{+}$ 的 Clark-Ocone 鞅表示中找到可预测被积函数 $g_{t}$。Clark-Ocone 公式指出，对于一个合适的泛函 $F$，其 Itô 表示由 $F = \\mathbb{E}[F] + \\int_{0}^{T} g_{t} dW_{t}$ 给出，其中被积函数为 $g_{t} = \\mathbb{E}[D_{t}F | \\mathcal{F}_{t}]$。该问题引导我们通过一个涉及 $F$ 的光滑近似的三步过程。\n\n函数 $x \\mapsto \\max(x,0)$ 是不可微的，因此我们不能直接应用 Malliavin 积分学的链式法则。我们按照指示进行。\n\n1.  光滑近似的构造与 $L^{2}$ 收敛。\n需要近似的函数是 $x^{+} = \\max(x,0)$。我们可以将其表示为 $x^{+} = \\frac{1}{2}(x + |x|)$。非光滑性来自于绝对值函数 $|x| = \\sqrt{x^{2}}$。一种标准的光滑化方法是引入一个小的正常数 $\\epsilon$。\n我们定义函数族 $\\{f_{\\epsilon}\\}_{\\epsilon0}$ 如下：\n$$f_{\\epsilon}(x) = \\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}})$$\n对于任意固定的 $\\epsilon  0$，平方根下的项是严格为正的，所以 $f_{\\epsilon}$ 在 $\\mathbb{R}$ 上是无限可微的（$C^{\\infty}$）。当 $\\epsilon \\to 0$ 时，我们有 $\\sqrt{x^{2} + \\epsilon^{2}} \\to \\sqrt{x^{2}} = |x|$，因此对于每个 $x \\in \\mathbb{R}$，$f_{\\epsilon}(x) \\to \\frac{1}{2}(x + |x|) = x^{+}$。这表明了逐点收敛。\n$f_{\\epsilon}$ 的一阶导数是：\n$$f_{\\epsilon}'(x) = \\frac{d}{dx} \\left[ \\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}}) \\right] = \\frac{1}{2}\\left(1 + \\frac{2x}{2\\sqrt{x^{2} + \\epsilon^{2}}}\\right) = \\frac{1}{2}\\left(1 + \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}\\right)$$\n对于 $\\epsilon  0$，$f_{\\epsilon}'(x)$ 是一个关于 $x$ 的连续函数。为了检查它是否有界，我们分析项 $\\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}$。其绝对值为 $\\left|\\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}\\right| = \\frac{|x|}{\\sqrt{x^{2} + \\epsilon^{2}}} \\le \\frac{|x|}{\\sqrt{x^{2}}} = 1$（对于 $x \\ne 0$）。对于所有 $x$，该不等式都是严格的。因此，$-1  \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}  1$，这意味着 $0  1 + \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}  2$。所以，$0  f_{\\epsilon}'(x)  1$。对于每个 $\\epsilon > 0$，该导数是连续且有界的。\n\n为了证明 $f_{\\epsilon}(W_{T}) \\to F$ 在 $L^{2}(\\Omega)$ 中收敛，我们必须证明当 $\\epsilon \\to 0$ 时 $\\mathbb{E}\\left[|f_{\\epsilon}(W_{T}) - W_{T}^{+}|^{2}\\right] \\to 0$。我们来考察差值 $|f_{\\epsilon}(x) - x^{+}|$：\n$$|f_{\\epsilon}(x) - x^{+}| = \\left|\\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}}) - \\frac{1}{2}(x + |x|)\\right| = \\frac{1}{2}|\\sqrt{x^{2} + \\epsilon^{2}} - |x||$$\n乘以共轭项，我们得到：\n$$\\frac{1}{2} \\left| \\frac{(\\sqrt{x^{2} + \\epsilon^{2}} - |x|)(\\sqrt{x^{2} + \\epsilon^{2}} + |x|)}{\\sqrt{x^{2} + \\epsilon^{2}} + |x|} \\right| = \\frac{1}{2} \\frac{|x^{2} + \\epsilon^{2} - x^{2}|}{\\sqrt{x^{2} + \\epsilon^{2}} + |x|} = \\frac{\\epsilon^{2}}{2(\\sqrt{x^{2} + \\epsilon^{2}} + |x|)}$$\n由于 $\\sqrt{x^{2} + \\epsilon^{2}} \\ge \\sqrt{\\epsilon^{2}} = \\epsilon$ 且 $|x| \\ge 0$，分母至少为 $\\epsilon$。\n$$|f_{\\epsilon}(x) - x^{+}| \\le \\frac{\\epsilon^{2}}{2\\epsilon} = \\frac{\\epsilon}{2}$$\n这个界对 $x$ 是一致的。因此，应用于 $W_{T}$，我们有 $|f_{\\epsilon}(W_{T}) - W_{T}^{+}| \\le \\frac{\\epsilon}{2}$ 对所有 $\\omega \\in \\Omega$ 成立。\n差的 $L^{2}$ 范数则有界：\n$$\\mathbb{E}\\left[|f_{\\epsilon}(W_{T}) - W_{T}^{+}|^{2}\\right] \\le \\mathbb{E}\\left[\\left(\\frac{\\epsilon}{2}\\right)^{2}\\right] = \\frac{\\epsilon^{2}}{4}$$\n当 $\\epsilon \\to 0$ 时，$\\frac{\\epsilon^{2}}{4} \\to 0$，这证明了 $f_{\\epsilon}(W_{T}) \\to W_{T}^{+}$ 在 $L^{2}(\\Omega)$ 中收敛。\n\n2.  Malliavin 导数的计算。\n形如 $f(W_{T})$ 的泛函的 Malliavin 导数（其中 $f$ 是具有有界导数的连续可微函数）由链式法则给出：$D_{t}(f(W_{T})) = f'(W_{T}) D_{t}W_{T}$。$W_{T} = \\int_{0}^{T} 1 \\, dW_{s}$ 的 Malliavin 导数是 $D_{t}W_{T} = 1$（对于 $t \\in [0,T]$）。\n将此应用于我们的近似 $F_{\\epsilon} = f_{\\epsilon}(W_{T})$，我们得到：\n$$D_{t}(f_{\\epsilon}(W_{T})) = f_{\\epsilon}'(W_{T})$$\n对于 $t \\in [0,T]$。代入步骤 1 中 $f_{\\epsilon}'(x)$ 的表达式：\n$$D_{t}(f_{\\epsilon}(W_{T})) = \\frac{1}{2}\\left(1 + \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}\\right)$$\n\n3.  条件期望和极限表达式。\n$F$ 的 Clark-Ocone 表示中的被积函数是 $g_{t} = \\lim_{\\epsilon \\to 0} \\mathbb{E}[D_{t}(f_{\\epsilon}(W_{T})) | \\mathcal{F}_{t}]$。我们首先计算固定 $\\epsilon$ 时的条件期望：\n$$g_{t}^{\\epsilon} = \\mathbb{E}[D_{t}(f_{\\epsilon}(W_{T})) | \\mathcal{F}_{t}] = \\mathbb{E}\\left[\\frac{1}{2}\\left(1 + \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}\\right) \\bigg| \\mathcal{F}_{t}\\right]$$\n根据条件期望的线性性：\n$$g_{t}^{\\epsilon} = \\frac{1}{2} + \\frac{1}{2}\\mathbb{E}\\left[\\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}} \\bigg| \\mathcal{F}_{t}\\right]$$\n期望内的随机变量 $h_{\\epsilon}(W_{T}) = \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}$ 的绝对值有界为 1。当 $\\epsilon \\to 0$ 时，对于 $x \\ne 0$，$h_{\\epsilon}(x) \\to \\text{sgn}(x)$。由于 $\\mathbb{P}(W_{T}=0)=0$，这种收敛几乎必然发生。根据条件期望的有界收敛定理，我们可以交换极限和期望：\n$$g_{t} = \\lim_{\\epsilon \\to 0} g_{t}^{\\epsilon} = \\frac{1}{2} + \\frac{1}{2}\\mathbb{E}\\left[\\lim_{\\epsilon \\to 0} \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}} \\bigg| \\mathcal{F}_{t}\\right] = \\frac{1}{2}\\left(1 + \\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}]\\right)$$\n现在我们计算 $\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}]$。注意 $\\text{sgn}(x) = \\mathbf{1}_{x>0} - \\mathbf{1}_{x0}$。\n$$\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}] = \\mathbb{E}[\\mathbf{1}_{W_{T}>0} | \\mathcal{F}_{t}] - \\mathbb{E}[\\mathbf{1}_{W_{T}0} | \\mathcal{F}_{t}] = \\mathbb{P}(W_{T}>0 | \\mathcal{F}_{t}) - \\mathbb{P}(W_{T}0 | \\mathcal{F}_{t})$$\n我们将 $W_{T}$ 分解为 $W_{T} = W_{t} + (W_{T} - W_{t})$。给定 $\\mathcal{F}_{t}$，$W_{t}$ 是一个已知值，而增量 $W_{T} - W_{t}$ 独立于 $\\mathcal{F}_{t}$ 且服从均值为 0、方差为 $T-t$ 的正态分布。所以，$W_{T} - W_{t} \\sim N(0, T-t)$。\n对于 $t  T$，我们有：\n$$\\mathbb{P}(W_{T} > 0 | \\mathcal{F}_{t}) = \\mathbb{P}(W_{t} + (W_{T} - W_{t}) > 0 | \\mathcal{F}_{t}) = \\mathbb{P}(W_{T} - W_{t} > -W_{t})$$\n设 $Z \\sim N(0,1)$ 为一个标准正态变量。那么 $W_{T} - W_{t}$ 与 $\\sqrt{T-t} Z$ 具有相同的分布。\n$$\\mathbb{P}(\\sqrt{T-t}Z > -W_{t}) = \\mathbb{P}\\left(Z > -\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n设 $\\Phi(\\cdot)$ 为标准正态分布的累积分布函数（CDF），$\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{x} \\exp(-\\frac{y^{2}}{2}) dy$。\n该概率为 $1 - \\Phi\\left(-\\frac{W_{t}}{\\sqrt{T-t}}\\right)$。利用对称性质 $\\Phi(-z) = 1 - \\Phi(z)$，我们得到：\n$$\\mathbb{P}(W_{T} > 0 | \\mathcal{F}_{t}) = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n类似地，$\\mathbb{P}(W_{T}  0 | \\mathcal{F}_{t}) = \\mathbb{P}(Z  -\\frac{W_{t}}{\\sqrt{T-t}}) = \\Phi(-\\frac{W_{t}}{\\sqrt{T-t}}) = 1 - \\Phi(\\frac{W_{t}}{\\sqrt{T-t}})$。\n因此，\n$$\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}] = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - \\left(1 - \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)\\right) = 2\\Phi\\left(\\frac{W_{t}}{\\sqrtT-t}}\\right) - 1$$\n将此代回 $g_{t}$ 的表达式中：\n$$g_{t} = \\frac{1}{2}\\left(1 + \\left(2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - 1\\right)\\right) = \\frac{1}{2}\\left(2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)\\right) = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n该表达式对 $t \\in [0,T)$ 有效。\n\n可预测被積函数的最终结果是标准正态分布的累积分布函数在 $\\frac{W_{t}}{\\sqrt{T-t}}$ 处的值。", "answer": "$$\\boxed{\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)}$$", "id": "3000571"}]}