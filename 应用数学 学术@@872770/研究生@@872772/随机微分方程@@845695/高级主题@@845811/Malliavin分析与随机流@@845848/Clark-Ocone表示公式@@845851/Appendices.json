{"hands_on_practices": [{"introduction": "为了广泛应用 Clark-Ocone 公式，我们需要有能力计算复杂泛函的 Malliavin 导数。这个练习旨在确立一个关键的理论工具——链式法则。通过证明 $D_t(g(F)) = g'(F)D_tF$ 这一结论，我们将掌握类似于普通微积分中链式法则的方法，从而能够处理复合随机变量的微分问题，为后续更复杂的应用奠定基础。[@problem_id:3000575]", "problem": "考虑一个完备概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$，其上赋予了由标准一维布朗运动 $W=(W_t)_{t\\in[0,T]}$ 生成的自然滤子 $(\\mathcal{F}_t)_{t\\in[0,T]}$。令 $\\mathcal{S}$ 表示形如 $F=f(W(h_1),\\dots,W(h_n))$ 的光滑柱泛函类，其中 $n\\in\\mathbb{N}$，$h_i\\in L^2([0,T])$, $W(h_i)=\\int_0^T h_i(t)\\,\\mathrm{d}W_t$，并且 $f\\in C_b^{\\infty}(\\mathbb{R}^n)$ 是有界的，且其所有阶导数都有界。Malliavin 导数 $D=(D_t)_{t\\in[0,T]}$ 在 $\\mathcal{S}$ 上由法则 $D_t F=\\sum_{i=1}^n \\partial_i f(W(h_1),\\dots,W(h_n))\\,h_i(t)$ 定义，而 Malliavin 可微随机变量的 Sobolev 空间 $\\mathbb{D}^{1,2}$ 是 $\\mathcal{S}$ 关于范数 $\\|F\\|_{1,2}^2=\\mathbb{E}[F^2]+\\mathbb{E}\\!\\left[\\int_0^T |D_t F|^2\\,\\mathrm{d}t\\right]$ 的完备化。假设 Malliavin 导数算子 $D$ 是从 $L^2(\\Omega)$ 到 $L^2(\\Omega\\times[0,T])$ 的可闭算子，并且 $\\mathbb{D}^{1,2}$ 如上良定义。\n\n设 $F\\in\\mathbb{D}^{1,2}$ 且 $g\\in C_b^1(\\mathbb{R})$，即 $\\mathbb{R}$ 上函数有界且导数有界的连续可微函数空间。请从光滑柱泛函上 Malliavin 导数的基本定义出发，仅利用其可闭性以及 $\\mathcal{S}$ 在 $\\mathbb{D}^{1,2}$ 中的稠密性，推导出 $g(F)\\in\\mathbb{D}^{1,2}$。然后，用 $F$、$g$ 和 $D_t F$ 表示出 Malliavin 导数 $D_t(g(F))$ 的显式闭式表达式，并验证所需的可积性以确保 $g(F)\\in\\mathbb{D}^{1,2}$。最后，简要解释确定 $D_t(g(F))$ 的过程如何使得 Clark–Ocone 表示公式能够应用于 $g(F)$，而无需写出该表示本身。\n\n你的最终答案必须是 $D_t(g(F))$ 的一个单一解析表达式，无单位，并以其最简闭式形式给出。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 一个完备概率空间 $(\\Omega,\\mathcal{F},\\mathbb{P})$，其上有一个由标准一维布朗运动 $W=(W_t)_{t\\in[0,T]}$ 生成的滤子 $(\\mathcal{F}_t)_{t\\in[0,T]}$。\n- 光滑柱泛函类 $\\mathcal{S}$ 定义为 $F=f(W(h_1),\\dots,W(h_n))$，其中 $n\\in\\mathbb{N}$，$h_i\\in L^2([0,T])$, $W(h_i)=\\int_0^T h_i(t)\\,\\mathrm{d}W_t$，并且 $f\\in C_b^{\\infty}(\\mathbb{R}^n)$。\n- $\\mathcal{S}$ 上的 Malliavin 导数 $D=(D_t)_{t\\in[0,T]}$ 由 $D_t F=\\sum_{i=1}^n \\partial_i f(W(h_1),\\dots,W(h_n))\\,h_i(t)$ 给出。\n- Sobolev 空间 $\\mathbb{D}^{1,2}$ 是 $\\mathcal{S}$ 关于范数 $\\|F\\|_{1,2}^2=\\mathbb{E}[F^2]+\\mathbb{E}\\!\\left[\\int_0^T |D_t F|^2\\,\\mathrm{d}t\\right]$ 的完备化。\n- 算子 $D$ 是从 $L^2(\\Omega)$ 到 $L^2(\\Omega\\times[0,T])$ 的可闭算子。\n- 给定一个随机变量 $F\\in\\mathbb{D}^{1,2}$。\n- 给定一个函数 $g\\in C_b^1(\\mathbb{R})$，该函数连续可微且导数有界。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题设置在 Malliavin 微积分的严谨数学框架内，这是随机分析中一个标准且成熟的理论。所有定义和概念在该领域都是标准的。\n- **适定性：** 该问题要求使用标准的稠密性论证来证明一个已知结果（Malliavin 导数的链式法则）。给定的条件和假设足以推导出一个唯一且有意义的解。\n- **客观性：** 该问题以精确、形式化的数学语言陈述，没有任何主观性或歧义。\n- 该问题不违反任何其他有效性标准（例如，它不是不完整的、矛盾的、不现实的或微不足道的）。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供解答。\n\n### 解答\n目标是证明对于 $F \\in \\mathbb{D}^{1,2}$ 和 $g \\in C_b^1(\\mathbb{R})$，复合随机变量 $g(F)$ 也是 $\\mathbb{D}^{1,2}$ 中的一个元素，并确定其 Malliavin 导数 $D_t(g(F))$。证明将依赖于光滑柱泛函集 $\\mathcal{S}$ 在 $\\mathbb{D}^{1,2}$ 中的稠密性以及 Malliavin 导数算子 $D$ 的可闭性。\n\n设 $F \\in \\mathbb{D}^{1,2}$。根据 $\\mathbb{D}^{1,2}$ 作为 $\\mathcal{S}$ 的完备化的定义，存在一个光滑柱泛函序列 $(F_n)_{n\\in\\mathbb{N}}$，其中对每个 $n$ 都有 $F_n \\in \\mathcal{S}$，使得 $F_n \\to F$ 在 $\\mathbb{D}^{1,2}$ 范数下成立。这意味着：\n$$ \\lim_{n\\to\\infty} \\|F_n - F\\|_{1,2}^2 = \\lim_{n\\to\\infty} \\left( \\mathbb{E}[(F_n - F)^2] + \\mathbb{E}\\left[\\int_0^T |D_t F_n - D_t F|^2 \\, \\mathrm{d}t\\right] \\right) = 0 $$\n因此，$(F_n)_{n\\in\\mathbb{N}}$ 是 $\\mathbb{D}^{1,2}$ 中的一个柯西序列。\n\n我们现在将证明序列 $(g(F_n))_{n\\in\\mathbb{N}}$ 是 $\\mathbb{D}^{1,2}$ 中的一个柯西序列。设 $F_n \\in \\mathcal{S}$。我们可以写出 $F_n = f_n(W(h_{n,1}), \\dots, W(h_{n,d_n}))$，其中 $f_n \\in C_b^{\\infty}(\\mathbb{R}^{d_n})$。那么 $g(F_n) = (g \\circ f_n)(W(h_{n,1}), \\dots, W(h_{n,d_n}))$。虽然 $g \\circ f_n$ 不一定在 $C_b^{\\infty}$ 中，但它在 $C_b^1$ 中，并且 Malliavin 导数的链式法则适用，得到：\n$$ D_t(g(F_n)) = g'(F_n) D_t F_n $$\n这是 Malliavin 导数在此类泛函上的一个基本性质。\n\n为证明 $(g(F_n))$ 在 $\\mathbb{D}^{1,2}$ 中是柯西序列，我们必须证明当 $n,m \\to \\infty$ 时 $\\|g(F_n) - g(F_m)\\|_{1,2}^2 \\to 0$。范数的平方是：\n$$ \\|g(F_n) - g(F_m)\\|_{1,2}^2 = \\mathbb{E}[(g(F_n) - g(F_m))^2] + \\mathbb{E}\\left[\\int_0^T |D_t(g(F_n)) - D_t(g(F_m))|^2 \\, \\mathrm{d}t\\right] $$\n\n让我们分析每一项。\n对于第一项，由于 $g \\in C_b^1(\\mathbb{R})$，其导数 $g'$ 有界。设 $M_{g'} = \\sup_{x \\in \\mathbb{R}} |g'(x)|  \\infty$。根据中值定理，$g$ 是 Lipschitz 连续的，Lipschitz 常数为 $M_{g'}$。\n$$ \\mathbb{E}[(g(F_n) - g(F_m))^2] \\le \\mathbb{E}[(M_{g'} |F_n - F_m|)^2] = M_{g'}^2 \\mathbb{E}[(F_n - F_m)^2] $$\n由于 $(F_n)$ 在 $L^2(\\Omega)$ 中是柯西序列，当 $n, m \\to \\infty$ 时 $\\mathbb{E}[(F_n - F_m)^2] \\to 0$。因此，第一项趋于零。\n\n对于第二项，我们使用链式法则 $D_t(g(F_k)) = g'(F_k)D_t F_k$：\n$$ \\mathbb{E}\\left[\\int_0^T |g'(F_n)D_t F_n - g'(F_m)D_t F_m|^2 \\, \\mathrm{d}t\\right] $$\n我们使用恒等式 $a-b = (a-c) + (c-b)$ 和不等式 $(x+y)^2 \\le 2x^2 + 2y^2$：\n$$ |g'(F_n)D_t F_n - g'(F_m)D_t F_m|^2 = |g'(F_n)(D_t F_n - D_t F_m) + (g'(F_n) - g'(F_m))D_t F_m|^2 $$\n$$ \\le 2|g'(F_n)|^2 |D_t F_n - D_t F_m|^2 + 2|g'(F_n) - g'(F_m)|^2 |D_t F_m|^2 $$\n积分并取期望：\n$$ \\mathbb{E}\\left[\\int_0^T |D_t(g(F_n)) - D_t(g(F_m))|^2 \\, \\mathrm{d}t\\right] \\le 2\\mathbb{E}\\left[\\int_0^T |g'(F_n)|^2 |D_t F_n - D_t F_m|^2 \\, \\mathrm{d}t\\right] + 2\\mathbb{E}\\left[\\int_0^T |g'(F_n) - g'(F_m)|^2 |D_t F_m|^2 \\, \\mathrm{d}t\\right] $$\n让我们对这两个新项进行定界。\n对于第一项，使用 $|g'(F_n)| \\le M_{g'}$：\n$$ 2\\mathbb{E}\\left[\\int_0^T |g'(F_n)|^2 |D_t F_n - D_t F_m|^2 \\, \\mathrm{d}t\\right] \\le 2M_{g'}^2 \\mathbb{E}\\left[\\int_0^T |D_t F_n - D_t F_m|^2 \\, \\mathrm{d}t\\right] $$\n该项当 $n,m \\to \\infty$ 时趋于 $0$，因为 $(F_n)$ 是关于 $\\mathbb{D}^{1,2}$ 范数导数部分的柯西序列。\n\n对于第二项，$2\\mathbb{E}\\left[\\int_0^T |g'(F_n) - g'(F_m)|^2 |D_t F_m|^2 \\, \\mathrm{d}t\\right]$，注意到由于 $(F_k)_{k \\in \\mathbb{N}}$ 是 $\\mathbb{D}^{1,2}$ 中的柯西序列，它是一个有界序列，因此对于某个常数 $C  \\infty$ 有 $\\sup_m \\|F_m\\|_{1,2} \\le C$。这意味着 $\\sup_m \\mathbb{E}[\\int_0^T |D_t F_m|^2 \\mathrm{d}t]  \\infty$。此外，由于在 $L^2(\\Omega)$ 中 $F_n \\to F$ 和 $F_m \\to F$，我们有 $F_n - F_m \\to 0$ 在 $L^2(\\Omega)$ 中。根据 $g'$ 的连续性，可以得出 $g'(F_n) - g'(F_m)$ 依概率收敛于 $0$。项 $|g'(F_n)-g'(F_m)|^2$ 被 $(2M_{g'})^2$ 界定。随机变量序列 $\\int_0^T |D_t F_m|^2 \\, \\mathrm{d}t$是一致可积的。根据控制收敛定理的一个变体（或 Vitali 收敛定理），期望收敛于 $0$。因此，当 $n,m\\to\\infty$ 时，第二项趋于零。\n\n$\\mathbb{D}^{1,2}$ 范数差的两项都趋于零，所以 $(g(F_n))$ 是 $\\mathbb{D}^{1,2}$ 中的柯西序列。由于 $\\mathbb{D}^{1,2}$ 是一个完备空间（一个 Hilbert 空间），序列 $(g(F_n))$ 在 $\\mathbb{D}^{1,2}$ 中收敛到一个极限。我们来确定这个极限。在 $\\mathbb{D}^{1,2}$ 中的收敛意味着在 $L^2(\\Omega)$ 中的收敛。由于 $F_n \\to F$ in $L^2(\\Omega)$ 且 $g$ 是 Lipschitz 连续的，所以 $g(F_n) \\to g(F)$ in $L^2(\\Omega)$。根据 $L^2(\\Omega)$ 中极限的唯一性，$(g(F_n))$ 的极限必须是 $g(F)$。因此，$g(F) \\in \\mathbb{D}^{1,2}$。\n\n现在我们来确定导数 $D_t(g(F))$。算子 $D$ 是可闭的。这意味着如果 $\\mathbb{D}^{1,2}$ 中的序列 $(Y_n)$ 在 $L^2(\\Omega)$ 中收敛于 $Y$，并且导数序列 $(D Y_n)$ 在 $L^2(\\Omega \\times [0,T])$ 中收敛于一个极限 $Z$，那么 $Y \\in \\mathbb{D}^{1,2}$ 且 $D Y = Z$。我们有 $g(F_n) \\to g(F)$ 在 $\\mathbb{D}^{1,2}$ 中，这意味着 $g(F_n) \\to g(F)$ 在 $L^2(\\Omega)$ 中，并且 $D(g(F_n)) \\to D(g(F))$ 在 $L^2(\\Omega \\times [0,T])$ 中。我们还知道 $D_t(g(F_n)) = g'(F_n) D_t F_n$。我们需要找到这个序列在 $L^2(\\Omega \\times [0,T])$ 中的极限。让我们证明它收敛于 $g'(F)D_t F$。\n考虑差的范数：\n$$ \\mathbb{E}\\left[\\int_0^T |g'(F_n)D_t F_n - g'(F)D_t F|^2 \\, \\mathrm{d}t\\right] $$\n使用与之前相同的技巧：\n$$ \\le 2\\mathbb{E}\\left[\\int_0^T |g'(F_n)|^2|D_t F_n - D_t F|^2 \\, \\mathrm{d}t\\right] + 2\\mathbb{E}\\left[\\int_0^T |g'(F_n) - g'(F)|^2|D_t F|^2 \\, \\mathrm{d}t\\right] $$\n第一项被 $2M_{g'}^2 \\mathbb{E}[\\int_0^T |D_t F_n - D_t F|^2 \\, \\mathrm{d}t]$ 界定，当 $n\\to\\infty$ 时收敛到 $0$，因为 $F_n \\to F$ in $\\mathbb{D}^{1,2}$。\n对于第二项 $2\\mathbb{E}[\\int_0^T |g'(F_n) - g'(F)|^2|D_t F|^2 \\, \\mathrm{d}t]$，我们知道 $F_n \\to F$ in $L^2(\\Omega)$，所以存在一个几乎必然收敛的子序列。根据 $g'$ 的连续性，$g'(F_n) \\to g'(F)$ 依概率收敛。被积函数被 $(2M_{g'})^2|D_t F|^2$ 控制，该函数在 $\\Omega \\times [0,T]$ 上是可积的，因为 $F \\in \\mathbb{D}^{1,2}$。根据控制收敛定理，此项也收敛到 $0$。\n因此，$g'(F_n) D F_n \\to g'(F) D F$ 在 $L^2(\\Omega \\times [0,T])$ 中。根据 $D$ 的可闭性，我们有：\n$$ D_t(g(F)) = g'(F) D_t F $$\n这就是所求的 Malliavin 导数的表达式。\n\n为了验证 $g(F)$ 确实在 $\\mathbb{D}^{1,2}$ 中，我们必须检查范数 $\\|g(F)\\|_{1,2}^2$ 的有限性。\n1. $\\mathbb{E}[g(F)^2]$: 由于 $g \\in C_b^1(\\mathbb{R})$，$g$ 是有界的。设 $|g(x)| \\le M_g  \\infty$。那么 $\\mathbb{E}[g(F)^2] \\le M_g^2  \\infty$。\n2. $\\mathbb{E}[\\int_0^T |D_t(g(F))|^2 \\mathrm{d}t]$: 使用我们推导的公式，这是 $\\mathbb{E}[\\int_0^T |g'(F) D_t F|^2 \\mathrm{d}t]$。由于 $g \\in C_b^1(\\mathbb{R})$，$g'$ 被 $M_{g'}$ 界定。\n$$ \\mathbb{E}\\left[\\int_0^T |g'(F)|^2 |D_t F|^2 \\mathrm{d}t\\right] \\le M_{g'}^2 \\mathbb{E}\\left[\\int_0^T |D_t F|^2 \\mathrm{d}t\\right] $$\n由于 $F \\in \\mathbb{D}^{1,2}$，项 $\\mathbb{E}[\\int_0^T |D_t F|^2 \\mathrm{d}t]$ 是有限的。因此，范数的第二部分也是有限的。两个条件都满足，从而确认了 $g(F) \\in \\mathbb{D}^{1,2}$。\n\n最后，Clark-Ocone 表示公式将一个 $\\mathcal{F}_T$-可测的随机变量 $Y \\in \\mathbb{D}^{1,2}$ 表示为一个随机积分：$Y = \\mathbb{E}[Y] + \\int_0^T \\mathbb{E}[D_s Y | \\mathcal{F}_s] \\mathrm{d}W_s$。该公式的应用需要知道 Malliavin 导数 $D_s Y$。通过证明 $g(F) \\in \\mathbb{D}^{1,2}$ 并明确地将其 Malliavin 导数确定为 $D_t(g(F)) = g'(F)D_t F$，我们获得了构建 $g(F)$ 的 Clark-Ocone 表示中被积函数 $\\mathbb{E}[g'(F)D_t F | \\mathcal{F}_t]$ 的必要组成部分。因此，这个结果，即 Malliavin 导数的链式法则，是将 Clark-Ocone 公式的应用范围扩展到 Malliavin 可微随机变量的非线性函数的关键工具。", "answer": "$$\n\\boxed{g'(F) D_t F}\n$$", "id": "3000575"}, {"introduction": "本练习将引导我们完成 Clark-Ocone 公式的首次具体应用。通过计算一个关于布朗运动终端值的平滑泛函 $F=\\varphi(W_T)$ 的 Clark-Ocone 被积函数，我们将揭示随机分析与偏微分方程理论之间一个深刻而优美的联系。这个联系是通过热半群 (heat semigroup) 建立的，它为理解被积函数的结构提供了新的视角。[@problem_id:2986763]", "problem": "设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\ge 0},\\mathbb{P})$ 是一个完备概率空间，其上支撑着一个一维标准布朗运动 $(W_t)_{t\\ge 0}$，该布朗运动适应于其通常的增广滤子 $(\\mathcal{F}_t)_{t\\ge 0}$。固定 $T0$，并令 $F=\\varphi(W_T)$，其中 $\\varphi\\in C_b^1(\\mathbb{R})$，$C_b^1(\\mathbb{R})$ 表示函数本身及其导数均有界的一次连续可微函数的空间。记 $D_tF$ 为 $F$ 在时刻 $t$ 的 Malliavin 导数。对于 $s\\ge 0$ 和一个有界可测函数 $f:\\mathbb{R}\\to\\mathbb{R}$，定义作用于 $f$ 上的热半群 $(P_s)_{s\\ge 0}$ 为\n$$\n(P_s f)(x):=\\mathbb{E}\\big[f(x+W_s)\\big]=\\frac{1}{\\sqrt{2\\pi s}}\\int_{\\mathbb{R}} f(x+y)\\,\\exp\\!\\Big(-\\frac{y^2}{2s}\\Big)\\,\\mathrm{d}y.\n$$\n仅使用布朗运动的定义性质、经典 Wiener 空间中 Malliavin 导数的链式法则，以及增量的独立性和高斯定律，计算 Clark–Ocone 被积函数\n$$\n\\phi_t:=\\mathbb{E}\\big[D_tF\\,\\big|\\,\\mathcal{F}_t\\big],\\qquad t\\in[0,T],\n$$\n并将其用作用于 $\\varphi'$ 上的热半群来表示。您的最终答案必须是 $\\phi_t$ 作为 $t$ 和 $W_t$ 的函数的单一闭式解析表达式。", "solution": "用户要求我解决一个问题，该问题需要找到一个布朗运动特定泛函的 Clark-Ocone 被积函数。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**第1步：提取已知条件**\n- 概率空间和滤子：一个完备概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\ge 0},\\mathbb{P})$，其中 $(\\mathcal{F}_t)_{t\\ge 0}$ 为一维标准布朗运动 $(W_t)_{t\\ge 0}$ 的通常增广滤子。\n- 时间范围：一个固定常数 $T0$。\n- 随机变量：$F=\\varphi(W_T)$，其中 $\\varphi\\in C_b^1(\\mathbb{R})$（函数本身及其导数均有界的一次连续可微函数的空间）。\n- F 在时刻 t 的 Malliavin 导数：$D_tF$。\n- 热半群：对于一个有界可测函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 和 $s\\ge 0$，$(P_s f)(x):=\\mathbb{E}\\big[f(x+W_s)\\big]=\\frac{1}{\\sqrt{2\\pi s}}\\int_{\\mathbb{R}} f(x+y)\\,\\exp\\!\\Big(-\\frac{y^2}{2s}\\Big)\\,\\mathrm{d}y$。\n- 目标量：Clark–Ocone 被积函数 $\\phi_t:=\\mathbb{E}\\big[D_tF\\,\\big|\\,\\mathcal{F}_t\\big]$，其中 $t\\in[0,T]$。\n- 答案的所需形式：一个用作用于 $\\varphi'$ 上的热半群 $(P_s)_{s\\ge 0}$ 表示的 $\\phi_t$ 的表达式，该表达式是 $t$ 和 $W_t$ 的函数。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于随机分析的数学理论，特别是 Malliavin 微积分及其在鞅表示定理（Clark-Ocone 公式）中的应用。所有概念（布朗运动、Malliavin 导数、热半群）都是标准的且定义良好。\n- **良定性：** 该问题是良定的。条件 $\\varphi\\in C_b^1(\\mathbb{R})$ 确保了随机变量 $F = \\varphi(W_T)$ 属于 Malliavin 导数算子的定义域，并且所有期望都是良定义的。Clark–Ocone 定理保证了被积过程 $\\phi_t$ 的存在性和唯一性。\n- **目标：** 该问题使用精确、无歧义的数学语言陈述。\n- **其他缺陷：** 该问题没有表现出任何其他缺陷。它是完整的、一致的，并且需要一个非平凡但标准的推导。\n\n**第3步：结论与行动**\n问题有效。我将继续进行解答。\n\n### 解答推导\n\n目标是计算 Clark–Ocone 被积函数 $\\phi_t = \\mathbb{E}[D_t F | \\mathcal{F}_t]$，其中 $t \\in [0, T]$ 且 $F = \\varphi(W_T)$。求解过程包括两个主要步骤：首先，计算 Malliavin 导数 $D_t F$；其次，计算其关于滤子 $\\mathcal{F}_t$ 的条件期望。\n\n**第1步：计算 Malliavin 导数 $D_t F$**\n\n随机变量由 $F = \\varphi(W_T)$ 给出。我们应用 Malliavin 导数的链式法则。对于一个函数 $g \\in C^1(\\mathbb{R})$ 和一个在 Malliavin 导数定义域内的随机变量 $G$，链式法则表明 $D_t(g(G)) = g'(G) D_t G$。在我们的例子中，$g = \\varphi$ 且 $G = W_T$。函数 $\\varphi$ 属于 $C_b^1(\\mathbb{R})$，满足所需的光滑性。随机变量 $W_T$ 在 Malliavin 导数的定义域内。\n\n应用链式法则，我们得到：\n$$\nD_t F = D_t(\\varphi(W_T)) = \\varphi'(W_T) \\cdot D_t W_T\n$$\n布朗运动 $W_s$ 在时刻 $t$ 的 Malliavin 导数由指示函数 $D_t W_s = \\mathbb{I}_{[0,s]}(t)$ 给出。对于我们的特定情况 $s=T$，这意味着：\n$$\nD_t W_T = \\mathbb{I}_{[0,T]}(t) = \\begin{cases} 1  \\text{若 } 0 \\le t \\le T \\\\ 0  \\text{若 } t  T \\end{cases}\n$$\n问题指定我们关心的是 $t \\in [0, T]$。对于这样的 $t$，我们有 $D_t W_T = 1$。因此，$F$ 的 Malliavin 导数是：\n$$\nD_t F = \\varphi'(W_T) \\quad \\text{对于 } t \\in [0, T]\n$$\n\n**第2步：计算条件期望 $\\mathbb{E}[D_t F | \\mathcal{F}_t]$**\n\n现在我们必须计算此结果关于滤子 $\\mathcal{F}_t$ 的条件期望。\n$$\n\\phi_t = \\mathbb{E}[D_t F | \\mathcal{F}_t] = \\mathbb{E}[\\varphi'(W_T) | \\mathcal{F}_t]\n$$\n为了在 $t \\in [0,T]$ 上计算这个条件期望，我们使用条件期望的塔性质和布朗运动的性质。我们将时刻 $T$ 的布朗路径分解为它在时刻 $t$ 的值与后续增量之和：\n$$\nW_T = W_t + (W_T - W_t)\n$$\n将此代入表达式，我们得到：\n$$\n\\phi_t = \\mathbb{E}[\\varphi'(W_t + (W_T - W_t)) | \\mathcal{F}_t]\n$$\n现在我们利用布朗运动的两个基本性质：\n1.  布朗运动在时刻 $t$ 的值 $W_t$ 是 $\\mathcal{F}_t$-可测的。\n2.  对于 $t \\le T$，增量 $(W_T - W_t)$ 独立于滤子 $\\mathcal{F}_t$。\n\n利用这些性质，我们可以从条件期望中“提取已知部分”。这意味着我们可以在期望内部将 $W_t$ 视为一个常数值，然后期望是针对随机变量 $(W_T - W_t)$ 取的，而该随机变量与条件作用的 sigma-代数 $\\mathcal{F}_t$ 无关。\n设 $x$ 为 $W_t$ 的值的占位符。我们可以定义一个辅助函数 $G(x)$：\n$$\nG(x) := \\mathbb{E}[\\varphi'(x + (W_T - W_t))]\n$$\n那么，$\\phi_t = G(W_t)$。\n\n增量 $(W_T - W_t)$ 是一个均值为 $0$、方差为 $T-t$ 的高斯随机变量。其分布与 $W_{T-t}$ 相同。令 $s = T-t$。我们可以写出：\n$$\nG(x) = \\mathbb{E}[\\varphi'(x + W_{T-t})] = \\mathbb{E}[\\varphi'(x + W_s)]\n$$\n这个表达式与问题陈述中给出的热半群 $(P_s f)(x)$ 的定义相匹配，其中我们将函数 $f$ 识别为 $\\varphi'$，时间参数 $s$ 识别为 $T-t$。\n$$\n(P_s \\varphi')(x) = \\mathbb{E}[\\varphi'(x + W_s)]\n$$\n因此，我们有：\n$$\nG(x) = (P_{T-t} \\varphi')(x)\n$$\n最后，将 $x = W_t$ 代回到 $\\phi_t$ 的表达式中，我们得到 Clark–Ocone 被积函数：\n$$\n\\phi_t = G(W_t) = (P_{T-t} \\varphi')(W_t)\n$$\n这是被积函数的最终表达式，以 $t$ 和 $W_t$ 的函数形式给出，并用作用于 $\\varphi$ 的导数上的热半群表示，符合要求。条件 $\\varphi \\in C_b^1(\\mathbb{R})$ 至关重要，因为它确保了 $\\varphi'$ 有界且连续，因此定义热半群的期望是良定义的。\n对于 $t=T$，表达式变为 $(P_0 \\varphi')(W_T)$。由于 $(P_0 f)(x) = f(x)$，这给出 $\\phi_T = \\varphi'(W_T)$，这是一致的，因为 $W_T$ 是 $\\mathcal{F}_T$-可测的，所以 $\\mathbb{E}[\\varphi'(W_T) | \\mathcal{F}_T] = \\varphi'(W_T)$。\n对于 $t \\in [0, T)$，使用热半群的积分形式，表达式为：\n$$\n\\phi_t = \\frac{1}{\\sqrt{2\\pi(T-t)}} \\int_{\\mathbb{R}} \\varphi'(W_t+y) \\exp\\left(-\\frac{y^2}{2(T-t)}\\right)\\mathrm{d}y\n$$\n问题要求答案用算子 $P_s$ 表示，所以紧凑形式是所期望的。", "answer": "$$\\boxed{(P_{T-t}\\varphi')(W_t)}$$", "id": "2986763"}, {"introduction": "在金融等诸多领域中，许多重要的泛函并非光滑函数，例如欧式看涨期权的收益函数 $F = \\max(W_T, 0)$。本练习将演示一种处理这类问题的强大技巧——光滑逼近 (smooth approximation)。我们将学习如何运用此方法将 Clark-Ocone 公式的应用范围拓展到这些不可微的情形，这充分展示了 Malliavin 积分的稳健性与分析威力。[@problem_id:3000571]", "problem": "设 $\\{W_{t}\\}_{t \\in [0,T]}$ 是一个在满足通常条件的带域流概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\in [0,T]},\\mathbb{P})$ 上的标准布朗运动。考虑终端泛函 $F = \\max(W_{T},0)$。\n\n1. 构造一族光滑函数 $\\{f_{\\epsilon}\\}_{\\epsilon0}$，$f_{\\epsilon}:\\mathbb{R}\\to\\mathbb{R}$，使得当 $\\epsilon \\to 0$ 时，$f_{\\epsilon}(x)$ 逐点收敛于 $x^{+}$，并且对于每个固定的 $\\epsilon0$，$f_{\\epsilon}$ 具有有界且连续的一阶导数。证明当 $\\epsilon \\to 0$ 时，$f_{\\epsilon}(W_{T})$ 在 $L^{2}(\\Omega)$ 中收敛于 $F$。\n\n2. 使用 Wiener 空间上 Malliavin 计算的基本定义（特别是 $W_{T}$ 的泛函的 Malliavin 导数和链式法则），计算 $t \\in [0,T]$ 时的 Malliavin 导数 $D_{t}\\big(f_{\\epsilon}(W_{T})\\big)$。\n\n3. 利用布朗增量的独立性和条件期望的标准性质，用 $W_{t}$ 和 $W_{T}-W_{t}$ 的分布来表示 $\\mathbb{E}\\big[D_{t}\\big(f_{\\epsilon}(W_{T})\\big)\\,|\\,\\mathcal{F}_{t}\\big]$。然后分析当 $\\epsilon \\to 0$ 时的极限，以获得在 $F$ 相对于 $\\{W_{t}\\}$ 的鞅表示中出现的可料被积函数 $g_{t}$。\n\n您的最终任务是报告在步骤 3 中获得的 $g_{t}$ 的极限解析表达式（对 $t \\in [0,T)$ 有效）。最终答案必须是单个闭式表达式。", "solution": "该问题要求找到泛函 $F = \\max(W_{T},0) = W_{T}^{+}$ 的 Clark-Ocone 鞅表示中的可料被积函数 $g_{t}$。Clark-Ocone 公式指出，对于一个合适的泛函 $F$，其 Itô 表示为 $F = \\mathbb{E}[F] + \\int_{0}^{T} g_{t} dW_{t}$，其中被积函数为 $g_{t} = \\mathbb{E}[D_{t}F | \\mathcal{F}_{t}]$。该问题引导我们通过一个三步过程，该过程涉及对 $F$ 进行光滑逼近。\n\n函数 $x \\mapsto \\max(x,0)$ 是不可微的，因此我们不能直接应用 Malliavin 计算的链式法则。我们按照指示进行。\n\n1.  光滑逼近的构造和 $L^{2}$ 收敛。\n待逼近的函数是 $x^{+} = \\max(x,0)$。我们可以将其表示为 $x^{+} = \\frac{1}{2}(x + |x|)$。其非光滑性来自于绝对值函数 $|x| = \\sqrt{x^{2}}$。一种标准的光滑化方法是引入一个小的正常数参数 $\\epsilon$。\n我们定义函数族 $\\{f_{\\epsilon}\\}_{\\epsilon0}$ 如下\n$$f_{\\epsilon}(x) = \\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}})$$\n对于任何固定的 $\\epsilon  0$，平方根下的项是严格为正的，因此 $f_{\\epsilon}$ 在 $\\mathbb{R}$ 上是无穷可微的（$C^{\\infty}$）。当 $\\epsilon \\to 0$ 时，我们有 $\\sqrt{x^{2} + \\epsilon^{2}} \\to \\sqrt{x^{2}} = |x|$，所以对于每个 $x \\in \\mathbb{R}$，$f_{\\epsilon}(x) \\to \\frac{1}{2}(x + |x|) = x^{+}$。这表明了逐点收敛。\n$f_{\\epsilon}$ 的一阶导数是：\n$$f_{\\epsilon}'(x) = \\frac{d}{dx} \\left[ \\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}}) \\right] = \\frac{1}{2}\\left(1 + \\frac{2x}{2\\sqrt{x^{2} + \\epsilon^{2}}}\\right) = \\frac{1}{2}\\left(1 + \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}\\right)$$\n对于 $\\epsilon  0$，$f_{\\epsilon}'(x)$ 是一个关于 $x$ 的连续函数。为了检查它是否有界，我们分析项 $\\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}$。其绝对值为 $\\left|\\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}\\right| = \\frac{|x|}{\\sqrt{x^{2} + \\epsilon^{2}}} \\le \\frac{|x|}{\\sqrt{x^{2}}} = 1$（对于 $x \\ne 0$）。对于所有 $x$，该不等式是严格的。因此，$-1  \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}  1$，这意味着 $0  1 + \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}  2$。所以，$0  f_{\\epsilon}'(x)  1$。对于每个 $\\epsilon  0$，该导数是连续且有界的。\n\n要证明当 $\\epsilon \\to 0$ 时 $f_{\\epsilon}(W_{T})$ 在 $L^{2}(\\Omega)$ 中收敛于 $F$，我们必须证明 $\\mathbb{E}\\left[|f_{\\epsilon}(W_{T}) - W_{T}^{+}|^{2}\\right] \\to 0$。我们来考察差值 $|f_{\\epsilon}(x) - x^{+}|$：\n$$|f_{\\epsilon}(x) - x^{+}| = \\left|\\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}}) - \\frac{1}{2}(x + |x|)\\right| = \\frac{1}{2}|\\sqrt{x^{2} + \\epsilon^{2}} - |x||$$\n乘以共轭项，我们得到：\n$$\\frac{1}{2} \\left| \\frac{(\\sqrt{x^{2} + \\epsilon^{2}} - |x|)(\\sqrt{x^{2} + \\epsilon^{2}} + |x|)}{\\sqrt{x^{2} + \\epsilon^{2}} + |x|} \\right| = \\frac{1}{2} \\frac{|x^{2} + \\epsilon^{2} - x^{2}|}{\\sqrt{x^{2} + \\epsilon^{2}} + |x|} = \\frac{\\epsilon^{2}}{2(\\sqrt{x^{2} + \\epsilon^{2}} + |x|)}$$\n因为 $\\sqrt{x^{2} + \\epsilon^{2}} \\ge \\sqrt{\\epsilon^{2}} = \\epsilon$ 且 $|x| \\ge 0$，分母至少为 $\\epsilon$。\n$$|f_{\\epsilon}(x) - x^{+}| \\le \\frac{\\epsilon^{2}}{2\\epsilon} = \\frac{\\epsilon}{2}$$\n这个界限是关于 $x$ 一致的。因此，应用于 $W_{T}$，我们有 $|f_{\\epsilon}(W_{T}) - W_{T}^{+}| \\le \\frac{\\epsilon}{2}$ 对于所有 $\\omega \\in \\Omega$。\n差值的 $L^{2}$ 范数则有界于：\n$$\\mathbb{E}\\left[|f_{\\epsilon}(W_{T}) - W_{T}^{+}|^{2}\\right] \\le \\mathbb{E}\\left[\\left(\\frac{\\epsilon}{2}\\right)^{2}\\right] = \\frac{\\epsilon^{2}}{4}$$\n当 $\\epsilon \\to 0$ 时，$\\frac{\\epsilon^{2}}{4} \\to 0$，这证明了 $f_{\\epsilon}(W_{T})$ 在 $L^{2}(\\Omega)$ 中收敛于 $W_{T}^{+}$。\n\n2.  Malliavin 导数的计算。\n对于形如 $f(W_{T})$ 的泛函，其中 $f$ 是连续可微且导数有界，其 Malliavin 导数由链式法则给出：$D_{t}(f(W_{T})) = f'(W_{T}) D_{t}W_{T}$。$W_{T} = \\int_{0}^{T} 1 \\, dW_{s}$ 的 Malliavin 导数是 $D_{t}W_{T} = 1$（对于 $t \\in [0,T]$）。\n将此应用于我们的逼近 $F_{\\epsilon} = f_{\\epsilon}(W_{T})$，我们得到：\n$$D_{t}(f_{\\epsilon}(W_{T})) = f_{\\epsilon}'(W_{T})$$\n对于 $t \\in [0,T]$。代入步骤 1 中 $f_{\\epsilon}'(x)$ 的表达式：\n$$D_{t}(f_{\\epsilon}(W_{T})) = \\frac{1}{2}\\left(1 + \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}\\right)$$\n\n3.  条件期望和极限表达式。\n$F$ 的 Clark-Ocone 表示中的被积函数是 $g_{t} = \\lim_{\\epsilon \\to 0} \\mathbb{E}[D_{t}(f_{\\epsilon}(W_{T})) | \\mathcal{F}_{t}]$。我们首先计算固定 $\\epsilon$ 时的条件期望：\n$$g_{t}^{\\epsilon} = \\mathbb{E}[D_{t}(f_{\\epsilon}(W_{T})) | \\mathcal{F}_{t}] = \\mathbb{E}\\left[\\frac{1}{2}\\left(1 + \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}\\right) \\bigg| \\mathcal{F}_{t}\\right]$$\n根据条件期望的线性性：\n$$g_{t}^{\\epsilon} = \\frac{1}{2} + \\frac{1}{2}\\mathbb{E}\\left[\\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}} \\bigg| \\mathcal{F}_{t}\\right]$$\n期望内的随机变量 $h_{\\epsilon}(W_{T}) = \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}$ 的绝对值有界于 1。当 $\\epsilon \\to 0$ 时，对于 $x \\ne 0$，$h_{\\epsilon}(x) \\to \\text{sgn}(x)$。由于 $\\mathbb{P}(W_{T}=0)=0$，这种收敛是几乎必然发生的。根据条件期望的有界收敛定理，我们可以交换极限和期望的顺序：\n$$g_{t} = \\lim_{\\epsilon \\to 0} g_{t}^{\\epsilon} = \\frac{1}{2} + \\frac{1}{2}\\mathbb{E}\\left[\\lim_{\\epsilon \\to 0} \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}} \\bigg| \\mathcal{F}_{t}\\right] = \\frac{1}{2}\\left(1 + \\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}]\\right)$$\n现在我们计算 $\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}]$。注意 $\\text{sgn}(x) = \\mathbf{1}_{x>0} - \\mathbf{1}_{x0}$。\n$$\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}] = \\mathbb{E}[\\mathbf{1}_{W_{T}>0} | \\mathcal{F}_{t}] - \\mathbb{E}[\\mathbf{1}_{W_{T}0} | \\mathcal{F}_{t}] = \\mathbb{P}(W_{T}>0 | \\mathcal{F}_{t}) - \\mathbb{P}(W_{T}0 | \\mathcal{F}_{t})$$\n我们将 $W_{T}$ 分解为 $W_{T} = W_{t} + (W_{T} - W_{t})$。给定 $\\mathcal{F}_{t}$，$W_{t}$ 是一个已知值，而增量 $W_{T} - W_{t}$ 独立于 $\\mathcal{F}_{t}$ 并且服从均值为 0、方差为 $T-t$ 的正态分布。所以，$W_{T} - W_{t} \\sim N(0, T-t)$。\n对于 $t  T$，我们有：\n$$\\mathbb{P}(W_{T} > 0 | \\mathcal{F}_{t}) = \\mathbb{P}(W_{t} + (W_{T} - W_{t}) > 0 | \\mathcal{F}_{t}) = \\mathbb{P}(W_{T} - W_{t} > -W_{t})$$\n设 $Z \\sim N(0,1)$ 是一个标准正态变量。那么 $W_{T} - W_{t}$ 与 $\\sqrt{T-t} Z$ 具有相同的分布。\n$$\\mathbb{P}(\\sqrt{T-t}Z > -W_{t}) = \\mathbb{P}\\left(Z > -\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n设 $\\Phi(\\cdot)$ 为标准正态分布的累积分布函数 (CDF)，$\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{x} \\exp(-\\frac{y^{2}}{2}) dy$。\n该概率为 $1 - \\Phi\\left(-\\frac{W_{t}}{\\sqrt{T-t}}\\right)$。利用对称性质 $\\Phi(-z) = 1 - \\Phi(z)$，我们得到：\n$$\\mathbb{P}(W_{T} > 0 | \\mathcal{F}_{t}) = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n类似地，$\\mathbb{P}(W_{T}  0 | \\mathcal{F}_{t}) = \\mathbb{P}(Z  -\\frac{W_{t}}{\\sqrt{T-t}}) = \\Phi(-\\frac{W_{t}}{\\sqrt{T-t}}) = 1 - \\Phi(\\frac{W_{t}}{\\sqrt{T-t}})$。\n因此，\n$$\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}] = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - \\left(1 - \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)\\right) = 2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - 1$$\n将此代回 $g_{t}$ 的表达式：\n$$g_{t} = \\frac{1}{2}\\left(1 + \\left(2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - 1\\right)\\right) = \\frac{1}{2}\\left(2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)\\right) = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n该表达式对 $t \\in [0,T)$ 有效。\n\n可料被积函数的最终结果是标准正态分布的累积分布函数在 $\\frac{W_{t}}{\\sqrt{T-t}}$ 处的值。", "answer": "$$\\boxed{\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)}$$", "id": "3000571"}]}