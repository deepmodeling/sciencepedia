{"hands_on_practices": [{"introduction": "反射原理是理解布朗运动极值的基石。这个练习旨在通过一个巧妙的视角，将反射原理与鞅论中的另一基本工具——可选停止定理联系起来。通过完成这个练习[@problem_id:2993858]，你不仅能加深对这两个核心概念的理解，还能体会到不同理论工具如何殊途同归，共同揭示了关于布朗运动首达时间的深刻结论。", "problem": "设 $\\{B_t\\}_{t\\ge 0}$ 是一个标准布朗运动（也称为维纳过程），且 $B_0=0$。固定 $a0$，定义首次到达时间 $T_a:=\\inf\\{s\\ge 0:\\, B_s=a\\}$ 和游程最大值 $M_t:=\\sup_{0\\le s\\le t} B_s$。对给定的 $t0$，考虑有界停时 $\\tau:=T_a\\wedge t$。利用 $\\{B_t\\}_{t\\ge 0}$ 是一个鞅和在 $\\tau$ 处的任意停止定理（OST），结合 (i) 将 $B_{\\tau}$ 分解到不交事件 $\\{T_a\\le t\\}$ 和 $\\{T_at\\}$ 上，以及 (ii) 将事件 $\\{M_t\\ge a\\}$ 与 $B_t$ 的一维高斯尾部联系起来的布朗运动反射原理。基于这些要素，下列哪个陈述必然成立？此处 $\\Phi$ 表示标准正态随机变量的累积分布函数。\n\nA. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_at\\}}\\big]\\,=\\,-a\\,\\mathbb{P}(T_a\\le t)$。\n\nB. $\\mathbb{P}(T_a\\le t)\\,=\\,\\mathbb{P}(B_t\\ge a)$。\n\nC. $\\mathbb{P}(T_a\\le t)\\,=\\,2\\big(1-\\Phi(a/\\sqrt{t})\\big)$。\n\nD. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_at\\}}\\big]\\,=\\,-\\,\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{B_t\\ge a\\}}\\big]$。\n\nE. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_at\\}}\\big]\\,=\\,-\\,2a\\,\\mathbb{P}(B_t\\ge a)$。\n\nF. $\\mathbb{E}\\big[B_{T_a\\wedge t}\\big]\\,=\\,a\\,\\mathbb{P}(T_a\\le t)$。\n\n选择所有适用的选项，并从第一性原理出发证明你的选择，不要使用任何未经证明的快捷公式。", "solution": "问题陈述在科学上是合理的且提法得当。我们将首先推导给定原理的结论，然后评估每个陈述。\n\n设 $\\{B_t\\}_{t \\ge 0}$ 是一个从 $B_0 = 0$ 开始的标准一维布朗运动。对于一个固定的常数 $a  0$，首次到达时间为 $T_a = \\inf\\{s \\ge 0: B_s = a\\}$。我们考虑对于给定的 $t  0$ 的停时 $\\tau = T_a \\wedge t = \\min(T_a, t)$。\n\n首先，我们应用任意停止定理（OST）。过程 $\\{B_t\\}_{t \\ge 0}$ 是关于其自然信息流的鞅。停时 $\\tau$ 被固定时间 $t$ 上界约束，因此 $\\tau \\le t$。因此，满足任意停止定理的条件，我们有：\n$$\n\\mathbb{E}[B_{\\tau}] = \\mathbb{E}[B_0]\n$$\n因为 $B_0 = 0$，这蕴含着：\n$$\n\\mathbb{E}[B_{T_a \\wedge t}] = 0\n$$\n\n接下来，我们将此期望分解到不交事件 $\\{T_a \\le t\\}$ 和 $\\{T_a  t\\}$ 上。这些事件的并集是整个样本空间。\n$$\n\\mathbb{E}[B_{T_a \\wedge t}] = \\mathbb{E}[B_{T_a \\wedge t} \\cdot \\mathbf{1}_{\\{T_a \\le t\\}}] + \\mathbb{E}[B_{T_a \\wedge t} \\cdot \\mathbf{1}_{\\{T_a  t\\}}] = 0\n$$\n我们来分析每一项：\n1.  在事件 $\\{T_a \\le t\\}$ 上，停时为 $\\tau = T_a$。根据 $T_a$ 的定义和布朗运动路径的连续性，$B_{\\tau} = B_{T_a} = a$。因此，第一项是：\n    $$\n    \\mathbb{E}[B_{T_a} \\cdot \\mathbf{1}_{\\{T_a \\le t\\}}] = \\mathbb{E}[a \\cdot \\mathbf{1}_{\\{T_a \\le t\\}}] = a\\,\\mathbb{P}(T_a \\le t)\n    $$\n2.  在事件 $\\{T_a  t\\}$ 上，停时为 $\\tau = t$。因此，$B_{\\tau} = B_t$。第二项是：\n    $$\n    \\mathbb{E}[B_t \\cdot \\mathbf{1}_{\\{T_a  t\\}}]\n    $$\n\n将这些代回到分解后的期望方程中，得到：\n$$\na\\,\\mathbb{P}(T_a \\le t) + \\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a  t\\}}] = 0\n$$\n这直接蕴含了以下关系：\n$$\n\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a  t\\}}] = -a\\,\\mathbb{P}(T_a \\le t)\n$$\n\n现在，我们引入反射原理。游程最大值 $M_t = \\sup_{0 \\le s \\le t} B_s$ 大于或等于 $a$ 的事件与在时间 $t$ 前水平 $a$ 被达到的事件是相同的。也就是说，$\\{M_t \\ge a\\} = \\{T_a \\le t\\}$。反射原理指出，对于任何 $a  0$：\n$$\n\\mathbb{P}(M_t \\ge a) = 2\\,\\mathbb{P}(B_t \\ge a)\n$$\n因此，我们有：\n$$\n\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a)\n$$\n我们知道 $B_t$ 是一个均值为 $0$、方差为 $t$ 的正态分布随机变量，即 $B_t \\sim \\mathcal{N}(0, t)$。令 $Z = B_t/\\sqrt{t}$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。$Z$ 的累积分布函数（CDF）用 $\\Phi$ 表示。\n$$\n\\mathbb{P}(B_t \\ge a) = \\mathbb{P}\\left(\\frac{B_t}{\\sqrt{t}} \\ge \\frac{a}{\\sqrt{t}}\\right) = \\mathbb{P}\\left(Z \\ge \\frac{a}{\\sqrt{t}}\\right) = 1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\n$$\n将此与反射原理结合，得到：\n$$\n\\mathbb{P}(T_a \\le t) = 2\\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right)\n$$\n\n在建立了这些基本结果之后，我们现在可以评估每个选项。\n\n**A. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_at\\}}\\big]\\,=\\,-a\\,\\mathbb{P}(T_a\\le t)$**\n正如上面从应用于 $B_{T_a \\wedge t}$ 的任意停止定理所推导的，我们发现 $a\\,\\mathbb{P}(T_a \\le t) + \\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a  t\\}}] = 0$。整理此式恰好得到本选项中的陈述。\n结论：**正确**。\n\n**B. $\\mathbb{P}(T_a\\le t)\\,=\\,\\mathbb{P}(B_t\\ge a)$**\n反射原理指出 $\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a)$。由于 $a  0$ 且 $t  0$，我们有 $\\mathbb{P}(B_t \\ge a)  0$。因此，缺少了一个因子 $2$。\n结论：**不正确**。\n\n**C. $\\mathbb{P}(T_a\\le t)\\,=\\,2\\big(1-\\Phi(a/\\sqrt{t})\\big)$**\n这是将反射原理与 $B_t$ 的分布相结合的直接结果。如我们的初步推导所示：$\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a) = 2\\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right)$。\n结论：**正确**。\n\n**D. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_at\\}}\\big]\\,=\\,-\\,\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{B_t\\ge a\\}}\\big]$**\n从选项 A，我们有 $\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_at\\}}] = -a\\,\\mathbb{P}(T_a \\le t)$。使用反射原理，这变成 $\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_at\\}}] = -2a\\,\\mathbb{P}(B_t \\ge a)$。所以该陈述等价于询问是否 $2a\\,\\mathbb{P}(B_t \\ge a) = \\mathbb{E}[B_t\\,\\mathbf{1}_{\\{B_t \\ge a\\}}]$。\n我们来计算右边。$B_t$ 的概率密度函数是 $f(x) = \\frac{1}{\\sqrt{2\\pi t}} e^{-x^2/(2t)}$。\n$$\n\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{B_t \\ge a\\}}] = \\int_a^\\infty x \\frac{1}{\\sqrt{2\\pi t}} e^{-x^2/(2t)} dx\n$$\n使用换元法 $u = x^2/(2t)$，我们得到 $du = (x/t)dx$，所以 $xdx=tdu$。\n$$\n\\int_a^\\infty x f(x) dx = \\frac{1}{\\sqrt{2\\pi t}} \\int_{a^2/(2t)}^\\infty e^{-u} (t\\,du) = \\frac{t}{\\sqrt{2\\pi t}} \\left[-e^{-u}\\right]_{a^2/(2t)}^\\infty = \\sqrt{\\frac{t}{2\\pi}} e^{-a^2/(2t)}\n$$\n所以要验证的恒等式是 $2a\\,\\mathbb{P}(B_t \\ge a) = \\sqrt{\\frac{t}{2\\pi}} e^{-a^2/(2t)}$。令 $z=a/\\sqrt{t}$。该恒等式为 $2z\\sqrt{t}\\,(1-\\Phi(z)) = \\sqrt{\\frac{t}{2\\pi}} e^{-z^2/2}$。\n这简化为 $2z(1-\\Phi(z)) = \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} = \\phi(z)$，其中 $\\phi$ 是标准正态概率密度函数。这个等式通常不成立。\n结论：**不正确**。\n\n**E. $\\mathbb{E}\\big[B_t\\,\\mathbf{1}_{\\{T_at\\}}\\big]\\,=\\,-\\,2a\\,\\mathbb{P}(B_t\\ge a)$**\n这来自于结合我们之前的结果。从选项 A，我们知道 $\\mathbb{E}[B_t\\,\\mathbf{1}_{\\{T_a  t\\}}] = -a\\,\\mathbb{P}(T_a \\le t)$。从反射原理，$\\mathbb{P}(T_a \\le t) = 2\\,\\mathbb{P}(B_t \\ge a)$。将第二个恒等式代入第一个，就得到了所要的陈述。\n结论：**正确**。\n\n**F. $\\mathbb{E}\\big[B_{T_a\\wedge t}\\big]\\,=\\,a\\,\\mathbb{P}(T_a\\le t)$**\n根据任意停止定理，我们已经确定 $\\mathbb{E}[B_{T_a \\wedge t}] = \\mathbb{E}[B_0] = 0$。右侧的 $a\\,\\mathbb{P}(T_a \\le t)$ 是严格正的，因为对于 $t  0$，$a  0$ 且 $\\mathbb{P}(T_a \\le t)  0$。因此，$0 \\ne a\\,\\mathbb{P}(T_a \\le t)$。量 $a\\,\\mathbb{P}(T_a \\le t)$ 是 $B_{T_a \\wedge t}$ 期望分解中的一项，而不是期望本身。\n结论：**不正确**。", "answer": "$$\\boxed{ACE}$$", "id": "2993858"}, {"introduction": "在建立了首达时间的基本概率关系后，一个自然而然的进阶问题是理解过程本身与其最大值的联合行为。这个练习[@problem_id:2993824]将引导你完成一个经典推导，即利用反射原理巧妙地处理累积分布函数，从而获得布朗运动的游走最大值 $M_t$ 与终点位置 $B_t$ 的联合概率密度函数。掌握此推导过程将为你提供一个强大的分析工具，它本身就是随机分析中许多其他计算（如求解条件分布）的基石。", "problem": "设 $\\{B_{s}\\}_{0 \\leq s \\leq t}$ 是一个从 $B_{0}=0$ 开始的标准布朗运动，并令 $M_{t} := \\sup_{0 \\leq s \\leq t} B_{s}$ 表示其到时间 $t0$ 为止的游程最大值。仅使用布朗运动的定义性质（独立、平稳增量和高斯转移核）以及布朗路径的反射原理，推导 $(M_{t}, B_{t})$ 的联合概率密度函数 (PDF)。然后，通过计算联合 PDF 与 $M_{t}$ 的边际 PDF 的适当比率，证明在给定 $M_{t}=m$ 的条件下，$B_{t}$ 的条件分布的支撑集为 $(-\\infty, m]$，并且其表达式为一个可以解释为高斯分布的简单指数倾斜的显式表达式。你的最终答案应该是条件密度 $f_{B_{t}\\,|\\,M_{t}=m}(x)$ 作为 $x$、$m$ 和 $t$ 的函数的封闭形式表达式，并写成其最简形式。不需要数值近似；请提供精确的解析表达式。确保支撑集的限制直接体现在你的表达式中（例如，使用示性函数）。", "solution": "题目要求推导标准布朗运动 $B_t$ 在时间 $t$ 的位置的条件概率密度函数 (PDF)，条件是其到时间 $t$ 为止的游程最大值 $M_t = \\sup_{0 \\leq s \\leq t} B_s$ 等于某个值 $m$。\n\n设 $\\{B_s\\}_{s \\ge 0}$ 是一个从 $B_0=0$ 开始的一维标准布朗运动。其定义性质包括具有平稳和独立的增量，并且 $B_t \\sim N(0, t)$，意味着它在时间 $t$ 的位置服从均值为 $0$、方差为 $t$ 的正态分布。$B_t$ 的 PDF 由 $f_{B_t}(x) = \\frac{1}{\\sqrt{2\\pi t}} \\exp(-\\frac{x^2}{2t})$ 给出。\n\n游程最大值为 $M_t = \\sup_{0 \\leq s \\leq t} B_s$。我们需要求条件 PDF $f_{B_t | M_t=m}(x)$。求条件密度的标准方法是通过公式 $f_{Y|X=x}(y) = \\frac{f_{X,Y}(x,y)}{f_X(x)}$。因此，我们将首先推导 $(M_t, B_t)$ 的联合 PDF（记为 $f_{M_t, B_t}(m,x)$）和 $M_t$ 的边际 PDF（记为 $f_{M_t}(m)$）。\n\n此推导的关键工具是布朗运动的反射原理。对于任意水平 $a0$，反射原理指出，布朗路径在时间 $t$ 前达到水平 $a$ 并最终停在值 $x \\le a$ 的概率，等于路径最终停在反射值 $2a-x$ 的概率。形式上，对于 $a0$ 和 $x \\le a$：\n$$P(M_t \\ge a, B_t \\le x) = P(B_t \\ge 2a-x)$$\n注意，由于布朗路径是连续的，事件 $\\{M_t  a\\}$ 与 $\\{M_t \\ge a\\}$ 在一个概率为零的集合上是相同的。\n\n首先，我们求联合累积分布函数 (CDF) $F_{M_t, B_t}(m,x) = P(M_t \\le m, B_t \\le x)$。根据定义，$B_t \\le M_t$，所以如果 $x  m$，这个概率为零。因此我们考虑 $x \\le m$ 和 $m \\ge 0$ 的情况。\n使用全概率公式，我们可以写出：\n$$P(B_t \\le x) = P(M_t \\le m, B_t \\le x) + P(M_t  m, B_t \\le x)$$\n重新整理得到：\n$$P(M_t \\le m, B_t \\le x) = P(B_t \\le x) - P(M_t  m, B_t \\le x)$$\n对第二项应用反射原理（令 $a=m$）：\n$$P(M_t \\le m, B_t \\le x) = P(B_t \\le x) - P(B_t \\ge 2m-x)$$\n设 $\\Phi$ 是标准正态分布 $N(0,1)$ 的 CDF。由于 $B_t/\\sqrt{t} \\sim N(0,1)$，我们有 $P(B_t \\le z) = \\Phi(z/\\sqrt{t})$。对于 $x \\le m$，联合 CDF 为：\n$$F_{M_t, B_t}(m,x) = \\Phi\\left(\\frac{x}{\\sqrt{t}}\\right) - \\left(1 - \\Phi\\left(\\frac{2m-x}{\\sqrt{t}}\\right)\\right)$$\n\n为了求出联合 PDF $f_{M_t, B_t}(m,x)$，我们对 CDF 先对 $x$ 求导，然后再对 $m$ 求导。\n$$f_{M_t, B_t}(m,x) = \\frac{\\partial^2}{\\partial m \\partial x} F_{M_t, B_t}(m,x)$$\n首先，对 $x$ 求导，并令 $\\phi(z) = \\Phi'(z)$ 为标准正态 PDF：\n\\begin{align*}\n\\frac{\\partial}{\\partial x} F_{M_t, B_t}(m,x) = \\frac{\\partial}{\\partial x} \\left[ \\Phi\\left(\\frac{x}{\\sqrt{t}}\\right) - 1 + \\Phi\\left(\\frac{2m-x}{\\sqrt{t}}\\right) \\right] \\\\\n= \\frac{1}{\\sqrt{t}}\\phi\\left(\\frac{x}{\\sqrt{t}}\\right) + \\frac{1}{\\sqrt{t}}\\phi\\left(\\frac{2m-x}{\\sqrt{t}}\\right) \\cdot (-1) \\\\\n= f_{B_t}(x) - f_{B_t}(2m-x)\n\\end{align*}\n现在，我们对这个表达式关于 $m$ 求导：\n\\begin{align*}\nf_{M_t, B_t}(m,x) = \\frac{\\partial}{\\partial m} \\left( f_{B_t}(x) - f_{B_t}(2m-x) \\right) \\\\\n= 0 - \\frac{d}{du}f_{B_t}(u)\\bigg|_{u=2m-x} \\cdot \\frac{\\partial(2m-x)}{\\partial m} \\\\\n= -f'_{B_t}(2m-x) \\cdot 2\n\\end{align*}\n高斯 PDF $f_{B_t}(u) = \\frac{1}{\\sqrt{2\\pi t}} \\exp(-u^2/2t)$ 的导数是 $f'_{B_t}(u) = -\\frac{u}{t} f_{B_t}(u)$。\n代入后，我们得到：\n$$f_{M_t, B_t}(m,x) = -2 \\left(-\\frac{2m-x}{t} f_{B_t}(2m-x)\\right) = \\frac{2(2m-x)}{t} f_{B_t}(2m-x)$$\n代入 $f_{B_t}$ 的表达式：\n$$f_{M_t, B_t}(m,x) = \\frac{2(2m-x)}{t} \\frac{1}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right) = \\frac{2(2m-x)}{\\sqrt{2\\pi t^3}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right)$$\n该密度适用于 $m \\ge 0$ 和 $x \\le m$。在其他情况下为零。\n\n接下来，我们通过对联合 PDF 在所有可能的 $x$ 值（即 $x \\in (-\\infty, m]$）上积分，来求最大值的边际 PDF $f_{M_t}(m)$。对于 $m \\ge 0$：\n$$f_{M_t}(m) = \\int_{-\\infty}^{m} f_{M_t, B_t}(m,x) \\,dx = \\int_{-\\infty}^{m} \\frac{2(2m-x)}{t\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right) \\,dx$$\n令 $u = \\frac{(2m-x)^2}{2t}$。则 $du = \\frac{2(2m-x)(-1)}{2t} \\,dx = -\\frac{2m-x}{t} \\,dx$。\n积分上下限从 $x \\to -\\infty$ 变为 $u \\to \\infty$，从 $x=m$ 变为 $u = \\frac{(2m-m)^2}{2t} = \\frac{m^2}{2t}$。\n$$f_{M_t}(m) = \\frac{2}{\\sqrt{2\\pi t}} \\int_{\\infty}^{m^2/(2t)} \\exp(-u) (-du) = \\frac{2}{\\sqrt{2\\pi t}} \\int_{m^2/(2t)}^{\\infty} \\exp(-u) \\,du$$\n$$f_{M_t}(m) = \\frac{2}{\\sqrt{2\\pi t}} [-\\exp(-u)]_{m^2/(2t)}^{\\infty} = \\frac{2}{\\sqrt{2\\pi t}} \\left(0 - \\left(-\\exp\\left(-\\frac{m^2}{2t}\\right)\\right)\\right)$$\n$$f_{M_t}(m) = \\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right) = \\sqrt{\\frac{2}{\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)$$\n这是布朗运动游程最大值的著名 PDF，对 $m \\ge 0$ 有效。\n\n最后，我们计算 $m0$ 和 $x \\le m$ 时的条件 PDF $f_{B_t|M_t=m}(x)$：\n$$f_{B_{t}\\,|\\,M_{t}=m}(x) = \\frac{f_{M_t, B_t}(m,x)}{f_{M_t}(m)} = \\frac{\\frac{2(2m-x)}{t\\sqrt{2\\pi t}} \\exp\\left(-\\frac{(2m-x)^2}{2t}\\right)}{\\frac{2}{\\sqrt{2\\pi t}} \\exp\\left(-\\frac{m^2}{2t}\\right)}$$\n$$f_{B_{t}\\,|\\,M_{t}=m}(x) = \\frac{2m-x}{t} \\exp\\left(-\\frac{(2m-x)^2}{2t} + \\frac{m^2}{2t}\\right)$$\n我们来化简指数中的项：\n$$\\frac{m^2 - (2m-x)^2}{2t} = \\frac{m^2 - (4m^2 - 4mx + x^2)}{2t} = \\frac{-x^2 + 4mx - 3m^2}{2t}$$\n分子中的二次式可以因式分解：$-x^2+4mx-3m^2 = -(x^2-4mx+3m^2) = -(x-m)(x-3m)$。\n所以条件密度是：\n$$f_{B_{t}\\,|\\,M_{t}=m}(x) = \\frac{2m-x}{t} \\exp\\left(\\frac{-(x-m)(x-3m)}{2t}\\right)$$\n此表达式对 $x \\le m$ 有效。对于 $xm$，密度为 $0$。我们使用示性函数 $\\mathbf{1}_{x \\le m}$ 来表示这一点。题目中关于“高斯分布的指数倾斜”的提示可以通过将指数重写为 $\\frac{-(x-m)^2+2m(x-m)}{2t}$ 来理解，它可以分解为一个以 $m$ 为中心的高斯类项和一个指数倾斜项。前置因子 $(2m-x)/t$ 是为了归一化所必需的。这个表达式是完整且精确的条件密度。", "answer": "$$\n\\boxed{\\frac{2m-x}{t} \\exp\\left(\\frac{-(x-m)(x-3m)}{2t}\\right) \\mathbf{1}_{x \\le m}}\n$$", "id": "2993824"}, {"introduction": "掌握了 $(M_t, B_t)$ 的联合密度函数之后，我们便可以着手解决关于路径历史的更精细的问题，例如最大值是在何时达到的。这项高级练习[@problem_id:2993800]运用了在最大值时刻进行路径分解的技巧，将被积函数分解为最大值时刻之前和之后的两部分，巧妙地将先前推导的联合密度与布朗运动的强马尔可夫性相结合。最终，你将推导出关于最大值出现时间 $\\tau_t$ 分布的著名反正弦定律，它揭示了随机游走和布朗运动一个惊人且违反直觉的普适性质。", "problem": "设 $\\{B_{u}\\}_{u \\ge 0}$ 是一个标准一维布朗运动，且 $B_{0} = 0$。对于一个固定的 $t  0$，定义游程最大值 $M_{t} := \\sup_{0 \\le u \\le t} B_{u}$ 和（几乎必然唯一的）最大值时刻 $\\tau_{t} := \\inf\\{u \\in [0,t] : B_{u} = M_{t}\\}$。设 $\\varphi_{t}(y) := (2\\pi t)^{-1/2} \\exp(-y^{2}/(2t))$ 表示在时刻 $t$ 的高斯概率密度函数。\n\n仅使用布朗运动的基本性质（独立平稳增量、对称性和反射原理），回答以下问题：\n\n- 从第一性原理推导对于 $m  0$ 和 $x \\le m$ 的联合密度 $f_{M_{t},B_{t}}(m,x)$ 的显式公式。\n\n- 建立在最大值时刻的路径分解，证明存在一个确定性函数 $c(\\cdot)$，使得对于 $s \\in (0,t)$ 和 $m  0$，\n$$\nf_{M_{t},\\tau_{t}}(m,s) \\;=\\; f_{M_{s},B_{s}}(m,m)\\, c(t-s).\n$$\n解释为什么 $c(\\cdot)$ 只依赖于达到最大值后时间区间的长度，而不依赖于 $m$ 或 $s$，并通过一致性确定 $c(\\cdot)$。\n\n- 使用此分解以及推导出的联合密度 $f_{M_{t},B_{t}}$，求得在 $(0,t)$ 上 $\\tau_{t}$ 的边际密度的闭式解析表达式。\n\n你的最终答案应为 $s \\in (0,t)$ 时边际密度 $f_{\\tau_{t}}(s)$ 的闭式表达式。不需要四舍五入，也不涉及物理单位。将最终答案表示为单个解析表达式。", "solution": "我们从标准布朗运动的基本性质开始：独立平稳增量、对称性和反射原理。固定 $t  0$。定义 $M_{t} := \\sup_{0 \\le u \\le t} B_{u}$ 并考虑对于 $m  0$ 和 $x \\le m$ 的 $f_{M_{t},B_{t}}(m,x)$。\n\n步骤 1：通过反射原理得到联合密度 $f_{M_{t},B_{t}}(m,x)$。对于 $x \\le m$，反射原理断言\n$$\n\\mathbb{P}(M_{t} \\ge m,\\, B_{t} \\in \\mathrm{d}x) \\;=\\; \\mathbb{P}(B_{t} \\in \\mathrm{d}(2m - x)),\n$$\n因为每条在时刻 $t$ 之前穿过 $m$ 并结束于 $x$ 的路径，通过在首次到达 $m$ 的时刻进行反射，可以双射地映射到一条结束于 $2m - x$ 的路径。因此，\n$$\n\\mathbb{P}(M_{t} \\ge m,\\, B_{t} \\in \\mathrm{d}x) \\;=\\; \\varphi_{t}(2m - x)\\,\\mathrm{d}x, \\qquad x \\le m,\\; m  0.\n$$\n对 $m$ 求导，得到 $(M_{t},B_{t})$ 的联合密度：\n\\begin{align*}\nf_{M_{t},B_{t}}(m,x)\n= -\\frac{\\partial}{\\partial m}\\Big[\\varphi_{t}(2m - x)\\Big] \\\\\n= -\\Big(2\\cdot \\frac{\\partial}{\\partial y}\\varphi_{t}(y)\\Big)\\Big|_{y = 2m - x} \\\\\n= -2\\Big(-\\frac{(2m - x)}{t}\\Big)\\varphi_{t}(2m - x) \\\\\n= \\frac{2(2m - x)}{t}\\,\\varphi_{t}(2m - x), \\qquad m  0,\\; x \\le m.\n\\end{align*}\n等价地，\n$$\nf_{M_{t},B_{t}}(m,x) \\;=\\; \\frac{2(2m - x)}{\\sqrt{2\\pi}\\, t^{3/2}} \\exp\\!\\Big(-\\frac{(2m - x)^{2}}{2t}\\Big), \\qquad m  0,\\; x \\le m.\n$$\n作为一致性检验，对 $x \\le m$ 积分可恢复 $M_{t}$ 的边际密度：\n\\begin{align*}\n\\int_{-\\infty}^{m} f_{M_{t},B_{t}}(m,x)\\,\\mathrm{d}x\n= \\int_{u=m}^{\\infty} \\frac{2u}{t}\\,\\varphi_{t}(u)\\,\\mathrm{d}u \\quad (u = 2m - x) \\\\\n= \\Big[-2\\,\\varphi_{t}(u)\\Big]_{u=m}^{\\infty}\n= 2\\,\\varphi_{t}(m),\n\\end{align*}\n这是反射原理的著名推论 $\\mathbb{P}(M_{t} \\in \\mathrm{d}m) = 2\\,\\varphi_{t}(m)\\,\\mathbf{1}_{\\{m0\\}}\\,\\mathrm{d}m$。\n\n步骤 2：在最大值时刻的路径分解以及 $f_{M_{t},\\tau_{t}}$ 的因式分解。定义 $\\tau_{t} := \\inf\\{u \\in [0,t] : B_{u} = M_{t}\\}$，即达到全局最大值的（几乎必然唯一的）时刻。考虑 $s \\in (0,t)$ 和 $m  0$。在事件 $\\{\\tau_{t} = s,\\; M_{t} = m\\}$ 上，我们有 $B_{s} = m$ 和 $M_{s} = m$，并且达到最大值前的路径 $\\{B_{u}\\}_{0 \\le u \\le s}$ 的终点等于其游程上确界。根据在时刻 $s$ 的强马尔可夫性和平稳增量性质， $s$ 时刻后的过程 $\\{B_{s+u} - B_{s}\\}_{0 \\le u \\le t-s}$ 是一个从 0 开始的独立标准布朗运动。全局最大值出现在时刻 $s$ 的条件意味着 $s$ 时刻后的路径段的上确界（相对于 $B_s$）不超过 0，即其上确界在 $u=0$ 处达到。从密度角度来看，在 0 处存在一个边界效应，且达到最大值后路径段的贡献仅取决于其长度 $t-s$。因此，存在一个确定性函数 $c(\\cdot)$，使得\n$$\nf_{M_{t},\\tau_{t}}(m,s) \\;=\\; f_{M_{s},B_{s}}(m,m)\\, c(t-s), \\qquad s \\in (0,t),\\; m  0,\n$$\n其中\n$$\nf_{M_{s},B_{s}}(m,m) \\;=\\; \\frac{2m}{s}\\,\\varphi_{s}(m) \\;=\\; \\frac{2m}{\\sqrt{2\\pi}\\, s^{3/2}} \\exp\\!\\Big(-\\frac{m^{2}}{2s}\\Big).\n$$\n因子 $c(t-s)$ 捕捉了达到最大值后路径段的贡献，并且根据独立性和标度性，它只依赖于时间长度 $t-s$。\n\n为了确定 $c(\\cdot)$，我们匹配通过两种独立方式得到的边际分布。\n\n步骤 3：利用不相交区间上最大值的独立性计算 $\\tau_t$ 的边际分布。对于 $s \\in (0,t)$，事件 $\\{\\tau_{t} \\le s\\}$ 等价于（在一个零测集上除外）到时刻 $s$ 为止达到的游程最大值大于或等于在剩余区间 $(s,t]$ 上相对于水平 $B_s$ 可能达到的额外最大值。根据独立增量和时间反演对称性， $s$ 时刻前和 $s$ 时刻后的最大值是独立的，并且分别与 $M_{s}$ 和 $M_{t-s}$ 具有相同的边际分布。因此\n$$\n\\mathbb{P}(\\tau_{t} \\le s)\n\\;=\\; \\mathbb{P}\\big(M_{s} \\ge \\widetilde{M}_{t-s}\\big),\n$$\n其中 $\\widetilde{M}_{t-s}$ 是 $M_{t-s}$ 的一个独立副本。利用布朗运动标度不变性，$M_u \\stackrel{d}{=} \\sqrt{u}|Z|$，其中 $Z$ 是标准正态随机变量。因此，我们需要计算的概率是：\n$$\n\\mathbb{P}(\\tau_{t} \\le s) = \\mathbb{P}(\\sqrt{s}|Z_1| \\ge \\sqrt{t-s}|Z_2|)\n$$\n其中 $Z_1, Z_2$ 是独立的标准正态随机变量。该不等式等价于 $\\frac{|Z_1|}{|Z_2|} \\ge \\sqrt{\\frac{t-s}{s}}$，或 $\\frac{Z_1^2}{Z_2^2} \\ge \\frac{t-s}{s}$。比率 $F = Z_1^2/Z_2^2$ 服从自由度为 $(1,1)$ 的F分布。其累积分布函数 (CDF) 为 $F_F(x) = \\frac{2}{\\pi}\\arctan(\\sqrt{x})$。因此：\n\\begin{align*}\n\\mathbb{P}(\\tau_t \\le s) = \\mathbb{P}\\left(F \\ge \\frac{t-s}{s}\\right) = 1 - F_F\\left(\\frac{t-s}{s}\\right) \\\\\n= 1 - \\frac{2}{\\pi}\\arctan\\left(\\sqrt{\\frac{t-s}{s}}\\right) \\\\\n= \\frac{2}{\\pi}\\arctan\\left(\\sqrt{\\frac{s}{t-s}}\\right) \\\\\n= \\frac{2}{\\pi}\\arcsin\\left(\\sqrt{\\frac{s}{t}}\\right)\n\\end{align*}\n最后两步使用了恒等式 $\\arctan(x)+\\arctan(1/x)=\\pi/2$ 和 $\\arctan(y)=\\arcsin(y/\\sqrt{1+y^2})$。\n\n对 $s$ 求导得到 $\\tau_t$ 的边际密度：\n\\begin{align*}\nf_{\\tau_{t}}(s)\n= \\frac{\\mathrm{d}}{\\mathrm{d}s}\\left[\\frac{2}{\\pi}\\,\\arcsin\\!\\left(\\sqrt{\\frac{s}{t}}\\right)\\right]\n= \\frac{2}{\\pi} \\cdot \\frac{1}{\\sqrt{1 - \\frac{s}{t}}} \\cdot \\frac{d}{ds}\\left(\\frac{\\sqrt{s}}{\\sqrt{t}}\\right) \\\\\n= \\frac{2}{\\pi} \\cdot \\frac{\\sqrt{t}}{\\sqrt{t-s}} \\cdot \\frac{1}{2\\sqrt{s}\\sqrt{t}} = \\frac{1}{\\pi \\sqrt{s(t-s)}}, \\qquad s \\in (0,t).\n\\end{align*}\n这就是最大值时刻的反正弦律。\n\n步骤 4：确定 $c(\\cdot)$ 和联合分布 $f_{M_{t},\\tau_{t}}$。从分解式\n$$\nf_{M_{t},\\tau_{t}}(m,s) \\;=\\; f_{M_{s},B_{s}}(m,m)\\, c(t-s),\n$$\n我们对 $m  0$ 积分以获得 $f_{\\tau_{t}}(s)$：\n\\begin{align*}\nf_{\\tau_{t}}(s)\n= \\int_{0}^{\\infty} f_{M_{s},B_{s}}(m,m)\\, c(t-s)\\,\\mathrm{d}m\n= c(t-s) \\int_{0}^{\\infty} \\frac{2m}{s}\\,\\varphi_{s}(m)\\,\\mathrm{d}m.\n\\end{align*}\n计算该积分：\n\\begin{align*}\n\\int_{0}^{\\infty} \\frac{2m}{s}\\,\\varphi_{s}(m)\\,\\mathrm{d}m\n= \\frac{2}{s} \\cdot \\frac{1}{\\sqrt{2\\pi s}} \\int_{0}^{\\infty} m \\exp\\!\\Big(-\\frac{m^{2}}{2s}\\Big)\\,\\mathrm{d}m \\\\\n= \\frac{2}{s \\sqrt{2\\pi s}} \\left[ -s \\exp\\!\\Big(-\\frac{m^2}{2s}\\Big) \\right]_0^\\infty = \\frac{2}{\\sqrt{2\\pi s}}.\n\\end{align*}\n与 $f_{\\tau_{t}}(s) = \\frac{1}{\\pi \\sqrt{s(t-s)}}$ 匹配可得\n$$\nc(t-s)\\cdot \\frac{\\sqrt{2}}{\\sqrt{\\pi s}} \\;=\\; \\frac{1}{\\pi \\sqrt{s(t-s)}}\n\\quad\\Longrightarrow\\quad\nc(T) \\;=\\; \\frac{1}{\\sqrt{2\\pi T}}, \\quad T = t - s.\n$$\n因此，$(M_{t},\\tau_{t})$ 的联合密度为\n$$\nf_{M_{t},\\tau_{t}}(m,s)\n\\;=\\;\n\\frac{2m}{s}\\,\\varphi_{s}(m)\\cdot \\frac{1}{\\sqrt{2\\pi (t-s)}}\n\\;=\\;\n\\frac{m}{\\pi\\, s^{3/2}\\, \\sqrt{t-s}} \\exp\\!\\Big(-\\frac{m^{2}}{2s}\\Big),\n\\qquad m  0,\\; s \\in (0,t),\n$$\n其关于 $s$ 的边际密度是上面求得的反正弦密度：\n$$\nf_{\\tau_{t}}(s) \\;=\\; \\frac{1}{\\pi \\sqrt{s(t-s)}}, \\qquad s \\in (0,t).\n$$\n\n这完成了基于反射原理、$(M_{t},B_{t})$ 的联合密度以及在最大值时刻的路径分解的推导。", "answer": "$$\\boxed{\\frac{1}{\\pi \\sqrt{s(t-s)}}}$$", "id": "2993800"}]}