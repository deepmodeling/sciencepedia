{"hands_on_practices": [{"introduction": "理论学习之后，最深刻的理解来自于亲手计算。我们的第一个实践任务是直接量化数值方法的误差。对于一个可解的多维线性随机微分方程模型，我们将为广泛使用的欧拉-丸山格式推导其强收敛和弱收敛的误差主项系数 ([@problem_id:2998588])。这个练习将揭示误差是如何在时间上累积的，以及它如何依赖于模型的漂移、扩散、初始条件和维度等具体参数。", "problem": "考虑 $d$ 维 Itô 随机微分方程 (SDE)\n$$\n\\mathrm{d}X_t = M\\,X_t\\,\\mathrm{d}t + D\\,X_t\\,\\mathrm{d}W_t,\\qquad X_0 = x_0\\in\\mathbb{R}^d,\n$$\n其中 $W_t$ 是一个具有独立分量的 $d$ 维标准布朗运动，$M\\in\\mathbb{R}^{d\\times d}$ 和 $D\\in\\mathbb{R}^{d\\times d}$ 是可交换且可同时对角化的确定性矩阵。在共同的特征基中，\n$$\nM = \\mathrm{diag}(\\mu_1,\\dots,\\mu_d),\\qquad D = \\mathrm{diag}(\\sigma_1,\\dots,\\sigma_d),\n$$\n其中对于 $i=1,\\dots,d$，有 $\\mu_i\\in\\mathbb{R}$ 和 $\\sigma_i\\in\\mathbb{R}$。设 $T0$ 为固定值，并设 $\\{t_n\\}_{n=0}^N$ 是 $[0,T]$ 的一个均匀剖分，步长为 $h = T/N$ 且 $N\\in\\mathbb{N}$。\n\n定义 Euler—Maruyama (EM) 格式如下\n$$\nX_{n+1}^h = X_n^h + M\\,X_n^h\\,h + D\\,X_n^h\\,\\Delta W_n,\\qquad \\Delta W_n := W_{t_{n+1}}-W_{t_n},\n$$\n并将终端 EM 近似值记为 $X_T^h := X_N^h$。对于强误差，通过以下渐近展开定义领先的强均方误差常数 $K_{\\mathrm{s}}$\n$$\n\\mathbb{E}\\big[\\,\\|X_T - X_T^h\\|^2\\,\\big] = K_{\\mathrm{s}}\\,h + o(h)\\quad\\text{当}\\quad h\\to 0 \\text{ 时},\n$$\n其中 $\\|\\cdot\\|$ 是 $\\mathbb{R}^d$ 上的欧几里得范数。对于弱误差，固定一个确定性向量 $u\\in\\mathbb{R}^d$ 和线性泛函 $\\varphi(x) = u^{\\top}x$，并通过以下公式定义领先的弱误差常数 $K_{\\mathrm{w}}$\n$$\n\\mathbb{E}\\big[\\,\\varphi(X_T^h)\\,\\big] - \\mathbb{E}\\big[\\,\\varphi(X_T)\\,\\big] = K_{\\mathrm{w}}\\,h + o(h)\\quad\\text{当}\\quad h\\to 0 \\text{ 时}。\n$$\n\n仅从 Itô SDE、Euler—Maruyama 格式的核心定义以及独立高斯增量（包括其矩生成函数）的基本性质出发，推导 $K_{\\mathrm{s}}$ 和 $K_{\\mathrm{w}}$ 关于 $T$、对角线元素 $\\mu_i$、$\\sigma_i$、$x_0$ 的初始坐标 $x_{0,i}$ 以及 $u$ 的分量 $u_i$ 的闭式解析表达式。明确验证维度 $d$ 如何进入这些常数。你的最终答案必须是作为单个闭式解析表达式给出的数对 $(K_{\\mathrm{s}},K_{\\mathrm{w}})$。无需四舍五入。", "solution": "该问题是适定的且具有科学依据。假设矩阵 $M$ 和 $D$ 可同时对角化，这使我们能够在一个基中工作，在该基中两者都是对角矩阵。这将 $d$ 维随机微分方程 (SDE) 解耦为 $d$ 个独立的标量 SDE。设 $X_t = (X_t^{(1)}, \\dots, X_t^{(d)})^{\\top}$ 和 $x_0 = (x_{0,1}, \\dots, x_{0,d})^{\\top}$ 是在这个共同特征基中的向量表示。对于每个分量 $i \\in \\{1, \\dots, d\\}$，该 SDE 是一个几何布朗运动：\n$$\n\\mathrm{d}X_t^{(i)} = \\mu_i X_t^{(i)} \\mathrm{d}t + \\sigma_i X_t^{(i)} \\mathrm{d}W_t^{(i)}, \\qquad X_0^{(i)} = x_{0,i}\n$$\n其中 $W_t^{(i)}$ 是独立的一维标准布朗运动。\n\n这个标量 SDE 的精确解可以通过对 $f(x) = \\ln(x)$ 应用 Itô 引理得到。这得出：\n$$\nX_t^{(i)} = x_{0,i} \\exp\\left( (\\mu_i - \\frac{1}{2}\\sigma_i^2)t + \\sigma_i W_t^{(i)} \\right)\n$$\n类似地，Euler-Maruyama (EM) 格式按分量解耦：\n$$\nX_{n+1}^{h,(i)} = X_n^{h,(i)} (1 + \\mu_i h + \\sigma_i \\Delta W_n^{(i)})\n$$\n其中 $X_0^{h,(i)} = x_{0,i}$ 且 $\\Delta W_n^{(i)} = W_{t_{n+1}}^{(i)} - W_{t_n}^{(i)} \\sim \\mathcal{N}(0,h)$。EM 近似的终端值通过将此关系迭代 $N$ 次给出：\n$$\nX_T^{h,(i)} = X_N^{h,(i)} = x_{0,i} \\prod_{n=0}^{N-1} (1 + \\mu_i h + \\sigma_i \\Delta W_n^{(i)})\n$$\n\n### 强误差常数 $K_{\\mathrm{s}}$ 的推导\n\n均方强误差定义为 $\\mathbb{E}\\big[\\,\\|X_T - X_T^h\\|^2\\,\\big]$。由于问题是在一个标准正交特征基中提出的，欧几里得范数的平方是各分量平方之和。根据期望的线性性质和分量的独立性：\n$$\n\\mathbb{E}\\big[\\,\\|X_T - X_T^h\\|^2\\,\\big] = \\mathbb{E}\\left[\\,\\sum_{i=1}^d (X_T^{(i)} - X_T^{h,(i)})^2\\,\\right] = \\sum_{i=1}^d \\mathbb{E}\\big[\\,(X_T^{(i)} - X_T^{h,(i)})^2\\,\\big]\n$$\n全局均方误差约等于时间网格上局部均方误差的总和。局部误差在区间 $[0,T]$ 上累积。SDE 数值分析的一个标准结果表明，EM 格式的全局均方误差是 $h$ 阶的，对于区间 $[0,T]$，它可以通过对局部误差的贡献进行积分来近似：\n$$\n\\mathbb{E}\\big[\\,(X_T^{(i)} - X_T^{h,(i)})^2\\,\\big] \\approx \\frac{1}{h} \\int_0^T \\mathbb{E}\\left[\\,\\left(X_{t+h}^{(i)} - \\tilde{X}_{t+h}^{(i)}\\right)^2\\,\\right] \\mathrm{d}t\n$$\n其中 $\\tilde{X}_{t+h}^{(i)} = X_t^{(i)} (1 + \\mu_i h + \\sigma_i \\Delta W_t^{(i)})$ 是从精确解 $X_t^{(i)}$ 开始的单步 EM 近似。项 $\\mathbb{E}[\\dots]/h$ 表示单位时间的局部误差贡献。EM 格式的局部强误差中的主导项来自于缺少与 $\\int \\int \\mathrm{d}W \\mathrm{d}W$ 相关的 Itô-Taylor 展开项。对于第 $i$ 个分量，这对应于 Milstein 项。局部误差是 $\\rho_t^{(i)} = X_{t+h}^{(i)} - \\tilde{X}_{t+h}^{(i)}$。使用 Itô-Taylor 展开将精确解 $X_{t+h}^{(i)}$ 在 $X_t^{(i)}$ 周围展开得到：\n$$\nX_{t+h}^{(i)} - X_t^{(i)} = \\mu_i X_t^{(i)} h + \\sigma_i X_t^{(i)} \\Delta W_t^{(i)} + \\frac{1}{2}\\sigma_i^2 X_t^{(i)} ((\\Delta W_t^{(i)})^2-h) + \\text{高阶项}\n$$\n单步 EM 增量是 $\\tilde{X}_{t+h}^{(i)} - X_t^{(i)} = \\mu_i X_t^{(i)} h + \\sigma_i X_t^{(i)} \\Delta W_t^{(i)}$。因此，局部误差的主导项是：\n$$\n\\rho_t^{(i)} \\approx \\frac{1}{2}\\sigma_i^2 X_t^{(i)} \\left( (\\Delta W_t^{(i)})^2 - h \\right)\n$$\n其平方的条件期望是：\n$$\n\\mathbb{E}\\big[\\,(\\rho_t^{(i)})^2 \\,|\\, \\mathcal{F}_t\\,\\big] \\approx \\frac{1}{4}\\sigma_i^4 (X_t^{(i)})^2 \\mathbb{E}\\big[\\,((\\Delta W_t^{(i)})^2-h)^2\\,\\big]\n$$\n对于随机变量 $\\Delta W \\sim \\mathcal{N}(0,h)$，我们有 $\\mathbb{E}[(\\Delta W)^2]=h$ 和 $\\mathbb{E}[(\\Delta W)^4]=3h^2$。因此，\n$$\n\\mathbb{E}\\big[\\,((\\Delta W)^2-h)^2\\,\\big] = \\mathbb{E}[(\\Delta W)^4] - 2h\\mathbb{E}[(\\Delta W)^2] + h^2 = 3h^2 - 2h(h) + h^2 = 2h^2\n$$\n所以，$\\mathbb{E}\\big[\\,(\\rho_t^{(i)})^2 \\,|\\, \\mathcal{F}_t\\,\\big] \\approx \\frac{1}{4}\\sigma_i^4 (X_t^{(i)})^2 (2h^2) = \\frac{1}{2}\\sigma_i^4 (X_t^{(i)})^2 h^2$。\n全局误差常数累积了这些局部误差。对 $N=T/h$ 个步骤求和，得到总误差与 $N \\times h^2 = (T/h)h^2 = Th$ 成正比。常数 $K_s$ 可以通过在 $[0,T]$ 上对领先的局部误差系数积分得到：\n$$\nK_{\\mathrm{s}} = \\sum_{i=1}^d \\int_0^T \\frac{1}{2}\\sigma_i^4 \\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big] \\mathrm{d}t\n$$\n我们计算 $\\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big]$。设 $Z_t = (\\mu_i - \\frac{1}{2}\\sigma_i^2)t + \\sigma_i W_t^{(i)}$，它服从正态分布 $Z_t \\sim \\mathcal{N}\\left((\\mu_i - \\frac{1}{2}\\sigma_i^2)t, \\sigma_i^2 t\\right)$。\n$$\n\\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big] = \\mathbb{E}\\big[\\,x_{0,i}^2 \\exp(2Z_t)\\,\\big] = x_{0,i}^2 \\mathbb{E}\\big[\\,\\exp(2Z_t)\\,\\big]\n$$\n这是 $x_{0,i}^2$ 乘以在 $2$ 处求值的 $Z_t$ 的矩生成函数。对于一个正态变量 $Y \\sim \\mathcal{N}(m, s^2)$，有 $\\mathbb{E}[\\exp(kY)] = \\exp(km + \\frac{1}{2}k^2s^2)$。\n$$\n\\mathbb{E}\\big[\\,\\exp(2Z_t)\\,\\big] = \\exp\\left(2(\\mu_i - \\frac{1}{2}\\sigma_i^2)t + \\frac{1}{2}(2^2)(\\sigma_i^2 t)\\right) = \\exp\\left((2\\mu_i - \\sigma_i^2)t + 2\\sigma_i^2 t\\right) = \\exp((2\\mu_i+\\sigma_i^2)t)\n$$\n因此，$\\mathbb{E}\\big[\\,(X_t^{(i)})^2\\,\\big] = x_{0,i}^2 \\exp((2\\mu_i+\\sigma_i^2)t)$。将此代入 $K_{\\mathrm{s}}$ 的积分中：\n$$\nK_{\\mathrm{s}} = \\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\int_0^T \\exp((2\\mu_i+\\sigma_i^2)t) \\mathrm{d}t\n$$\n如果 $2\\mu_i+\\sigma_i^2 \\neq 0$，积分为 $\\frac{\\exp((2\\mu_i+\\sigma_i^2)T)-1}{2\\mu_i+\\sigma_i^2}$。如果 $2\\mu_i+\\sigma_i^2=0$，积分值为 $T$。当 $a \\to 0$ 时，表达式 $\\frac{\\exp(aT)-1}{a} \\to T$，所以该公式是通用的。\n$$\nK_{\\mathrm{s}} = \\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\frac{\\exp((2\\mu_i+\\sigma_i^2)T) - 1}{2\\mu_i+\\sigma_i^2}\n$$\n\n### 弱误差常数 $K_{\\mathrm{w}}$ 的推导\n\n弱误差是为线性泛函 $\\varphi(x) = u^\\top x$ 定义的。根据期望的线性性质：\n$$\n\\mathbb{E}[\\varphi(X_T^h)] - \\mathbb{E}[\\varphi(X_T)] = \\sum_{i=1}^d u_i \\left( \\mathbb{E}[X_T^{h,(i)}] - \\mathbb{E}[X_T^{(i)}] \\right)\n$$\n首先，我们求精确均值 $\\mathbb{E}[X_T^{(i)}]$。从 SDE 出发，取期望得到 $\\mathrm{d}\\mathbb{E}[X_t^{(i)}] = \\mu_i \\mathbb{E}[X_t^{(i)}] \\mathrm{d}t$，从而得出 $\\mathbb{E}[X_T^{(i)}] = x_{0,i} \\exp(\\mu_i T)$。\n\n接下来，我们求 EM 近似的均值 $\\mathbb{E}[X_T^{h,(i)}]$。取 EM 格式的条件期望：\n$$\n\\mathbb{E}\\big[\\,X_{n+1}^{h,(i)}\\,\\big|\\,\\mathcal{F}_{t_n}\\big] = \\mathbb{E}\\big[\\,X_n^{h,(i)} (1 + \\mu_i h + \\sigma_i \\Delta W_n^{(i)})\\,\\big|\\,\\mathcal{F}_{t_n}\\big] = X_n^{h,(i)} (1+\\mu_i h)\n$$\n因为 $\\mathbb{E}[\\Delta W_n^{(i)}] = 0$。取完全期望并从 $n=0$ 开始迭代：\n$$\n\\mathbb{E}[X_N^{h,(i)}] = (1+\\mu_i h)^N x_{0,i}\n$$\n由于 $N = T/h$，我们有 $\\mathbb{E}[X_T^{h,(i)}] = x_{0,i} (1+\\mu_i h)^{T/h}$。我们关心当 $h \\to 0$ 时的领先误差项。我们将 $(1+\\mu_i h)^{T/h}$ 按 $h$ 的幂次展开：\n$$\n(1+\\mu_i h)^{T/h} = \\exp\\left(\\frac{T}{h}\\ln(1+\\mu_i h)\\right)\n$$\n使用泰勒级数 $\\ln(1+x) = x - \\frac{x^2}{2} + O(x^3)$：\n$$\n\\frac{T}{h} \\ln(1+\\mu_i h) = \\frac{T}{h} \\left(\\mu_i h - \\frac{1}{2}\\mu_i^2 h^2 + O(h^3)\\right) = \\mu_i T - \\frac{1}{2}\\mu_i^2 T h + O(h^2)\n$$\n现在，将此代回指数函数中，使用 $\\exp(a+b) = \\exp(a)\\exp(b)$ 和 $\\exp(x)=1+x+O(x^2)$：\n$$\n\\exp\\left(\\mu_i T - \\frac{1}{2}\\mu_i^2 T h + O(h^2)\\right) = \\exp(\\mu_i T) \\exp\\left(-\\frac{1}{2}\\mu_i^2 T h + O(h^2)\\right) = \\exp(\\mu_i T)\\left(1 - \\frac{1}{2}\\mu_i^2 T h + O(h^2)\\right)\n$$\n第 $i$ 个分量的期望之差为：\n$$\n\\mathbb{E}[X_T^{h,(i)}] - \\mathbb{E}[X_T^{(i)}] = x_{0,i} \\left(\\exp(\\mu_i T)\\left(1 - \\frac{1}{2}\\mu_i^2 T h\\right) - \\exp(\\mu_i T) + O(h^2)\\right) = -\\frac{1}{2} x_{0,i} \\mu_i^2 T \\exp(\\mu_i T) h + O(h^2)\n$$\n对所有分量求和以得到总的弱误差：\n$$\n\\mathbb{E}[\\varphi(X_T^h)] - \\mathbb{E}[\\varphi(X_T)] = \\sum_{i=1}^d u_i \\left( -\\frac{1}{2} x_{0,i} \\mu_i^2 T \\exp(\\mu_i T) h + O(h^2) \\right)\n$$\n$h$ 的系数即为弱误差常数 $K_{\\mathrm{w}}$：\n$$\nK_{\\mathrm{w}} = -\\frac{T}{2} \\sum_{i=1}^d u_i x_{0,i} \\mu_i^2 \\exp(\\mu_i T)\n$$\n\n### 结论\n\n推导出的常数为：\n$K_{\\mathrm{s}} = \\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\frac{\\exp((2\\mu_i+\\sigma_i^2)T) - 1}{2\\mu_i+\\sigma_i^2}$\n$K_{\\mathrm{w}} = -\\frac{T}{2} \\sum_{i=1}^d u_i x_{0,i} \\mu_i^2 \\exp(\\mu_i T)$\n\n维度 $d$ 仅作为求和项数进入这两个常数。这是 SDE 系统解耦为 $d$ 个独立的标量 SDE 的直接结果。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\displaystyle\\sum_{i=1}^d \\frac{1}{2}\\sigma_i^4 x_{0,i}^2 \\frac{\\exp((2\\mu_i+\\sigma_i^2)T) - 1}{2\\mu_i+\\sigma_i^2} \\\\ -\\frac{T}{2} \\displaystyle\\sum_{i=1}^d u_i x_{0,i} \\mu_i^2 \\exp(\\mu_i T) \\end{pmatrix}}\n$$", "id": "2998588"}, {"introduction": "在计算了特定模型的误差常数之后，我们转向更普适的理论。虽然误差常数依赖于问题的细节，但收敛的*阶数*是数值格式更本质的属性。这个实践要求在标准假设下，证明欧拉-丸山格式的强收敛阶为 $1/2$，并且这个阶数与我们选择用于衡量误差的 $L^p$ 范数无关 ([@problem_id:2998635])。这个推导将加深我们对强收敛理论及其背后分析工具（如Burkholder-Davis-Gundy不等式）的理解。", "problem": "考虑一维随机微分方程（SDE）\n$$\n\\mathrm{d}X_t = f(X_t)\\,\\mathrm{d}t + g(X_t)\\,\\mathrm{d}W_t,\\quad X_0\\in L^p,\\quad t\\in[0,T],\n$$\n其中 $W_t$ 是标准布朗运动，$f:\\mathbb{R}\\to\\mathbb{R}$ 和 $g:\\mathbb{R}\\to\\mathbb{R}$ 满足全局利普希茨条件和线性增长条件，且 $p\\geq 2$ 是一个固定的数。设 $N\\in\\mathbb{N}$，$h = T/N$，$t_n = nh$。用于时间离散的欧拉-丸山（EM）格式定义为\n$$\nX_{n+1} = X_n + f(X_n)\\,h + g(X_n)\\,\\Delta W_n,\\quad \\Delta W_n := W_{t_{n+1}} - W_{t_n}.\n$$\n定义网格点 $t_n$ 上的强误差为 $e_n := X(t_n) - X_n$，强收敛阶 $r(p)$ 由以下条件定义：存在与 $h$ 和 $N$ 无关的常数 $K_p0$，使得\n$$\n\\max_{0\\leq n\\leq N}\\|e_n\\|_{L^p} \\leq K_p\\, h^{r(p)}\\quad\\text{对所有足够小的 }h\\text{ 成立}.\n$$\n从强误差的核心定义和假定条件下SDE解的标准矩界出发，推导一个对所有 $p\\geq 2$ 都有效的上述形式的界。明确指出 $p$ 的选择如何影响常数 $K_p$，同时保持收敛阶指数 $r(p)$ 不变。你的最终答案必须是强收敛阶指数 $r(p)$ 的精确值，以单个数字或闭式解析表达式的形式给出。不需要进行数值舍入。", "solution": "目标是推导应用于随机微分方程（SDE）的欧拉-丸山（EM）格式的强收敛阶 $r(p)$\n$$\n\\mathrm{d}X_t = f(X_t)\\,\\mathrm{d}t + g(X_t)\\,\\mathrm{d}W_t, \\quad X_0\\in L^p, \\quad t\\in[0,T].\n$$\n假设系数 $f$ 和 $g$ 满足全局利普希茨条件和线性增长条件。设 $L$ 为利普希茨常数，$C$ 为线性增长常数。步长为 $h=T/N$ 的EM格式在时间点 $t_n=nh$ 产生近似值 $X_n$。\n\n为了分析强误差 $e_n = X(t_n) - X_n$，引入EM近似的连续时间版本会很方便。令 $\\kappa(t) = t_n$ 当 $t \\in [t_n, t_{n+1})$。连续时间EM近似 $\\bar{X}_t$ 由积分方程定义：\n$$\n\\bar{X}_t = X_0 + \\int_0^t f(\\bar{X}_{\\kappa(s)})\\,\\mathrm{d}s + \\int_0^t g(\\bar{X}_{\\kappa(s)})\\,\\mathrm{d}W_s.\n$$\n根据此定义，可得 $\\bar{X}_{t_n} = X_n$。精确解 $X_t$ 由下式给出\n$$\nX_t = X_0 + \\int_0^t f(X_s)\\,\\mathrm{d}s + \\int_0^t g(X_s)\\,\\mathrm{d}W_s.\n$$\n误差过程为 $e_t := X_t - \\bar{X}_t$。在网格点上，$e_{t_n} = X_{t_n} - X_n$。将两个积分方程相减得到\n$$\ne_t = \\int_0^t (f(X_s) - f(\\bar{X}_{\\kappa(s)}))\\,\\mathrm{d}s + \\int_0^t (g(X_s) - g(\\bar{X}_{\\kappa(s)}))\\,\\mathrm{d}W_s.\n$$\n我们希望找到 $\\|e_{t_n}\\|_{L^p} = (\\mathbb{E}[|e_{t_n}|^p])^{1/p}$ 的一个界。我们通过对 $p$ 阶矩 $\\mathbb{E}[|e_t|^p]$ 进行放缩来着手。使用不等式 $|a+b|^p \\leq 2^{p-1}(|a|^p + |b|^p)$（对 $p \\geq 1$），我们有\n$$\n\\mathbb{E}[|e_t|^p] \\leq 2^{p-1} \\mathbb{E}\\left[\\left|\\int_0^t (f(X_s) - f(\\bar{X}_{\\kappa(s)}))\\,\\mathrm{d}s\\right|^p\\right] + 2^{p-1} \\mathbb{E}\\left[\\left|\\int_0^t (g(X_s) - g(\\bar{X}_{\\kappa(s)}))\\,\\mathrm{d}W_s\\right|^p\\right].\n$$\n对于第一项（漂移项），我们应用积分形式的詹森不等式：\n$$\n\\mathbb{E}\\left[\\left|\\int_0^t \\dots \\mathrm{d}s\\right|^p\\right] \\leq t^{p-1} \\int_0^t \\mathbb{E}\\left[|f(X_s) - f(\\bar{X}_{\\kappa(s)})|^p\\right]\\,\\mathrm{d}s.\n$$\n对于第二项（扩散项），我们使用Burkholder-Davis-Gundy (BDG) 不等式，该不等式指出，对于一个伊藤过程 $M_t = \\int_0^t H_s dW_s$，存在一个仅依赖于 $p$ 的常数 $C_p$，使得 $\\mathbb{E}[|M_t|^p] \\leq C_p \\mathbb{E}[(\\int_0^t |H_s|^2 ds)^{p/2}]$。应用此不等式，然后再应用詹森不等式：\n$$\n\\mathbb{E}\\left[\\left|\\int_0^t \\dots \\mathrm{d}W_s\\right|^p\\right] \\leq C_p \\mathbb{E}\\left[\\left(\\int_0^t |g(X_s) - g(\\bar{X}_{\\kappa(s)})|^2\\,\\mathrm{d}s\\right)^{p/2}\\right] \\leq C_p t^{p/2-1} \\int_0^t \\mathbb{E}\\left[|g(X_s) - g(\\bar{X}_{\\kappa(s)})|^p\\right]\\,\\mathrm{d}s.\n$$\n接下来，我们对被积函数进行放缩。使用常数为 $L$ 的全局利普希茨条件以及不等式 $|a+b|^p \\leq 2^{p-1}(|a|^p+|b|^p)$：\n\\begin{align*}\n\\mathbb{E}[|f(X_s) - f(\\bar{X}_{\\kappa(s)})|^p] \\leq L^p \\mathbb{E}[|X_s - \\bar{X}_{\\kappa(s)}|^p] \\\\\n= L^p \\mathbb{E}[|(X_s - \\bar{X}_s) + (\\bar{X}_s - \\bar{X}_{\\kappa(s)})|^p] \\\\\n\\leq L^p 2^{p-1} (\\mathbb{E}[|e_s|^p] + \\mathbb{E}[|\\bar{X}_s - \\bar{X}_{\\kappa(s)}|^p]).\n\\end{align*}\n包含 $g$ 的项也成立相同的界。令 $\\phi(t) = \\mathbb{E}[|e_t|^p]$。将这些界代回，我们得到关于 $\\phi(t)$ 的一个不等式：\n$$\n\\phi(t) \\leq K_1(p) \\int_0^t \\phi(s)\\,\\mathrm{d}s + K_1(p) \\int_0^t \\mathbb{E}[|\\bar{X}_s - \\bar{X}_{\\kappa(s)}|^p]\\,\\mathrm{d}s,\n$$\n其中常数 $K_1(p) = 2^{2p-2} L^p (T^{p-1} + C_p T^{p/2-1})$ 依赖于 $p$、$T$、$L$ 和BDG常数 $C_p$。\n\n下一个关键步骤是为局部误差项 $\\mathbb{E}[|\\bar{X}_s - \\bar{X}_{\\kappa(s)}|^p]$ 找到一个界。对于 $s \\in [t_n, t_{n+1})$，我们有 $\\kappa(s)=t_n$。根据 $\\bar{X}_t$ 的定义，我们有：\n$$\n\\bar{X}_s - \\bar{X}_{t_n} = f(X_n)(s-t_n) + g(X_n)(W_s - W_{t_n}).\n$$\n取 $p$ 阶矩：\n$$\n\\mathbb{E}[|\\bar{X}_s - \\bar{X}_{t_n}|^p] \\leq 2^{p-1} \\left( \\mathbb{E}[|f(X_n)|^p](s-t_n)^p + \\mathbb{E}[|g(X_n)|^p|W_s - W_{t_n}|^p] \\right).\n$$\n在给定假设下，离散EM解的矩是有界的，即对任意 $q \\ge 2$ 都有 $\\sup_n \\mathbb{E}[|X_n|^q]  \\infty$。根据线性增长条件，$\\mathbb{E}[|f(X_n)|^p]$ 和 $\\mathbb{E}[|g(X_n)|^p]$ 被某个常数 $M_p$ 一致有界。增量 $W_s - W_{t_n}$ 是一个均值为0、方差为 $s-t_n$ 的高斯随机变量。因此，$W_s - W_{t_n} \\stackrel{d}{=} \\sqrt{s-t_n} Z$，其中 $Z \\sim N(0,1)$。其 $p$ 阶矩为 $\\mathbb{E}[|W_s-W_{t_n}|^p] = (s-t_n)^{p/2} \\mathbb{E}[|Z|^p]$。令 $m_p = \\mathbb{E}[|Z|^p]$，对于任意 $p$ 这都是一个有限常数。所以，\n$$\n\\mathbb{E}[|\\bar{X}_s - \\bar{X}_{t_n}|^p] \\leq 2^{p-1} M_p \\left( (s-t_n)^p + m_p (s-t_n)^{p/2} \\right).\n$$\n由于 $s-t_n  h$ 并且我们考虑 $h \\to 0$ 的情况，我们有 $s-t_n  1$。因为 $p \\geq 2$，可得 $p  p/2$，因此 $(s-t_n)^p \\leq (s-t_n)^{p/2}$。起主导作用的项是 $(s-t_n)^{p/2}$。因此，存在一个常数 $K_2(p)$，使得对于 $s \\in [t_n, t_{n+1})$：\n$$\n\\mathbb{E}[|\\bar{X}_s - \\bar{X}_{\\kappa(s)}|^p] \\leq K_2(p)(s-\\kappa(s))^{p/2}.\n$$\n$p$ 的选择会影响常数 $K_1(p)$ 和 $K_2(p)$。具体来说，由于 $2^{2p-2}$、BDG常数 $C_p$ 和高斯矩 $m_p$ 等因子的存在，它们随 $p$ 的增大而增大。\n\n现在，我们计算这个局部误差项的积分：\n$$\n\\int_0^T \\mathbb{E}[|\\bar{X}_s - \\bar{X}_{\\kappa(s)}|^p]\\,\\mathrm{d}s = \\sum_{n=0}^{N-1} \\int_{t_n}^{t_{n+1}} \\mathbb{E}[|\\bar{X}_s - \\bar{X}_{t_n}|^p]\\,\\mathrm{d}s \\leq \\sum_{n=0}^{N-1} \\int_{t_n}^{t_{n+1}} K_2(p)(s-t_n)^{p/2}\\,\\mathrm{d}s.\n$$\n在一个步长上的积分为\n$$\n\\int_{t_n}^{t_{n+1}} (s-t_n)^{p/2}\\,\\mathrm{d}s = \\frac{(s-t_n)^{p/2+1}}{p/2+1}\\bigg|_{t_n}^{t_{n+1}} = \\frac{h^{p/2+1}}{p/2+1}.\n$$\n对所有 $N$ 个区间求和：\n$$\n\\int_0^T \\mathbb{E}[|\\bar{X}_s - \\bar{X}_{\\kappa(s)}|^p]\\,\\mathrm{d}s \\leq N \\frac{K_2(p) h^{p/2+1}}{p/2+1} = \\frac{T}{h} \\frac{K_2(p) h^{p/2+1}}{p/2+1} = K_3(p) h^{p/2},\n$$\n其中 $K_3(p) = T K_2(p) / (p/2+1)$。\n\n我们将此结果代入关于 $\\phi(t)$ 的不等式中：\n$$\n\\phi(t) \\leq K_1(p) \\int_0^t \\phi(s)\\,\\mathrm{d}s + K_1(p)K_3(p)h^{p/2}.\n$$\n应用积分形式的格朗沃尔引理，该引理指出如果 $\\phi(t) \\leq A \\int_0^t \\phi(s)ds + B$，那么 $\\phi(t) \\leq B \\exp(At)$，我们得到：\n$$\n\\phi(t) = \\mathbb{E}[|e_t|^p] \\leq K_1(p)K_3(p)h^{p/2} \\exp(K_1(p)t).\n$$\n令 $K_4(p) = K_1(p)K_3(p)\\exp(K_1(p)T)$。由于这个界对所有 $t \\in [0,T]$ 都成立，它也对网格点 $t_n$ 成立：\n$$\n\\max_{0\\le n \\le N} \\mathbb{E}[|e_n|^p] \\leq K_4(p) h^{p/2}.\n$$\n为了求得强收敛阶，我们取 $p$ 次根：\n$$\n\\max_{0\\le n \\le N} \\|e_n\\|_{L^p} = \\max_{0\\le n \\le N} (\\mathbb{E}[|e_n|^p])^{1/p} \\leq (K_4(p) h^{p/2})^{1/p} = (K_4(p))^{1/p} h^{(p/2)/p} = K_p h^{1/2}.\n$$\n这里，$K_p = (K_4(p))^{1/p}$ 是一个依赖于 $p$ 但不依赖于 $h$ 的常数。\n\n分析表明，对于任意 $p \\geq 2$，强收敛阶 $r(p)$ 均为 $1/2$。$p$ 的选择显著影响误差常数 $K_p$ 的大小，但 $h$ 的指数保持不变。这个收敛阶是由局部误差中的随机项决定的，该项的尺度为 $h^{1/2}$。\n\n因此，强收敛阶指数为 $r(p) = 1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2998635"}, {"introduction": "最后，我们从分析现有格式转向设计更高效的新格式。在许多应用中（如金融衍生品定价），弱收敛比强收敛更重要，因此开发高阶弱收敛格式至关重要。这项练习要求我们构建一个能达到二阶弱收敛的龙格-库塔（Runge-Kutta）型格式，并理解实现这一目标的关键机制——在每一步中使用额外的独立随机数 ([@problem_id:2998607])。这不仅是一次计算练习，更是一次深入数值格式设计思想的探索。", "problem": "考虑由$d$维布朗运动驱动的$\\mathbb{R}^{n}$中的 Itô 随机微分方程，\n$$\n\\mathrm{d}X_{t} \\;=\\; a(X_{t})\\,\\mathrm{d}t \\;+\\; \\sum_{k=1}^{d} b_{k}(X_{t})\\,\\mathrm{d}W_{t}^{k},\n$$\n其中 $a:\\mathbb{R}^{n}\\to\\mathbb{R}^{n}$ 和 $b_{k}:\\mathbb{R}^{n}\\to\\mathbb{R}^{n}$ 是直到4阶导数都有界的充分光滑函数，并且扩散向量场是可交换的，即李括号满足 $[b_{i},b_{j}](x) \\equiv \\nabla b_{j}(x)\\,b_{i}(x) - \\nabla b_{i}(x)\\,b_{j}(x) = 0$ 对所有 $x\\in\\mathbb{R}^{n}$ 和所有 $i,j\\in\\{1,\\dots,d\\}$ 成立。令 $h0$ 表示一个固定的时间步长。单步法 $\\Psi_{h}$ 的弱阶定义为：对每个检验函数 $\\varphi\\in C_{b}^{4}(\\mathbb{R}^{n},\\mathbb{R})$，存在一个与 $h$ 无关的常数 $C(\\varphi)$，使得\n$$\n\\left| \\mathbb{E}\\big[\\varphi\\big(\\Psi_{h}(x,\\omega)\\big)\\big] \\;-\\; \\mathbb{E}\\big[\\varphi\\big(X_{t+h}\\big)\\,\\big|\\,X_{t}=x\\big] \\right| \\;\\le\\; C(\\varphi)\\, h^{p+1} \\quad \\text{对于某个 } p\\ge 1.\n$$\n要求您在可交换噪声假设下，从弱流的 Itô–Taylor 展开和 Kolmogorov 向后算子出发，设计一个达到弱2阶的两阶段随机 Runge–Kutta 方法\n$$\nL^{0}\\varphi(x) \\;=\\; a(x)\\cdot\\nabla\\varphi(x) \\;+\\; \\tfrac{1}{2}\\sum_{k=1}^{d}\\big(b_{k}(x)b_{k}(x)^{\\top}\\big):\\nabla^{2}\\varphi(x), \n\\qquad\nL^{k}\\varphi(x) \\;=\\; b_{k}(x)\\cdot\\nabla\\varphi(x),\n$$\n并通过匹配可交换情况下 $h$ 的直到4阶所需矩。特别地，您必须解释为什么每步使用多个独立高斯样本对于满足弱2阶条件是必要的，并且您必须构建一个具体的格式，其阶段值使用与布朗增量具有相同方差且保持独立的独立高斯扰动。\n\n最后，根据您的设计，确定为满足可交换噪声假设下的弱2阶矩条件，每个时间步长必须抽取的独立标准正态标量样本的最小数量 $m(d)$，作为布朗维度 $d$ 的函数。您的最终答案必须是 $m(d)$ 的闭式解析表达式。不要提供不等式或方程。不需要四舍五入。", "solution": "为了在可交换噪声假设下为给定的 SDE 设计一个弱2阶的两阶段随机 Runge-Kutta (SRK) 方法，我们必须将数值近似的矩与真实解的矩匹配到足够高的阶。\n\n首先，我们确立目标。对于一个足够光滑的检验函数 $\\varphi$，在 $X_t=x$ 的条件下，$\\varphi(X_{t+h})$ 的期望值有如下关于时间步长 $h$ 的展开式：\n$$\n\\mathbb{E}[\\varphi(X_{t+h})|X_{t}=x] = \\varphi(x) + h L^0\\varphi(x) + \\frac{h^2}{2}\\left( (L^0)^2 + \\sum_{k=1}^d (L^k)^2 \\right)\\varphi(x) + O(h^3).\n$$\n该展开利用了可交换性假设 $[b_i, b_j]=0$，这意味着算子 $[L^i, L^j]=0$。目标是构建一个从 $x$ 开始的数值近似 $Y_1$，使得 $\\mathbb{E}[\\varphi(Y_1)]$ 与此展开式匹配到 $h^2$ 阶项。\n\n我们提出以下两阶段 SRK 方法，这是该问题类别中一个成熟的设计，通常归功于 Platen 和 Rößler：\n$$\n\\begin{align*}\nK_1 = x \\\\\nK_2 = x + h\\,a(K_1) + \\sum_{k=1}^d b_k(K_1) \\tilde{I}_{(k)} \\\\\nY_1 = x + \\frac{h}{2}\\left(a(K_1) + a(K_2)\\right) + \\sum_{k=1}^d b_k(K_1) I_{(k)}\n\\end{align*}\n$$\n这里，$I_{(k)}$ 和 $\\tilde{I}_{(k)}$ 是代表随机增量的随机变量。为了使该方法达到弱2阶，这些随机变量必须满足一组矩条件。具体来说，它们的联合矩必须与两个独立的 $d$ 维维纳过程增量的联合矩相匹配。\n\n令 $\\Delta W_h$ 和 $\\Delta \\tilde{W}_h$ 为区间 $[t, t+h]$ 上的两个独立的 $d$ 维维纳过程增量，因此对 $k=1,\\dots,d$，$\\Delta W_h^k \\sim N(0,h)$ 和 $\\Delta \\tilde{W}_h^k \\sim N(0,h)$ 都是相互独立的。如果我们设 $I_{(k)} = \\Delta W_h^k$ 且 $\\tilde{I}_{(k)} = \\Delta \\tilde{W}_h^k$，则该格式达到弱2阶。\n\n我们来分析为什么这个选择是有效的，以及为什么需要两组独立的随机变量。分析过程涉及展开 $\\mathbb{E}[\\varphi(Y_1)]$ 并与目标展开式进行项匹配。\n令 $\\Delta Y = Y_1 - x$。我们有\n$$\n\\mathbb{E}[\\varphi(Y_1)] = \\varphi(x) + \\mathbb{E}[\\Delta Y \\cdot \\nabla\\varphi(x)] + \\frac{1}{2}\\mathbb{E}[(\\Delta Y \\Delta Y^\\top):\\nabla^2\\varphi(x)] + \\dots\n$$\n数值格式期望的展开依赖于 $I_{(k)}$ 和 $\\tilde{I}_{(k)}$ 的矩。从完整的弱收敛性分析中得出的所需矩条件是：\n1. $I_{(k)}$ 和 $\\tilde{I}_{(k)}$ 必须相互独立。\n2. $\\{I_{(k)}\\}_{k=1}^d$ 的矩必须与 $\\{\\Delta W_h^k\\}_{k=1}^d$ 的矩匹配到4阶。\n3. $\\{\\tilde{I}_{(k)}\\}_{k=1}^d$ 的矩必须与 $\\{\\Delta \\tilde{W}_h^k\\}_{k=1}^d$ 的矩匹配到4阶。\n\n具体来说，我们要求对所有的 $j,k,l,m \\in \\{1,\\dots,d\\}$：\n- $\\mathbb{E}[I_{(k)}] = 0$, $\\mathbb{E}[\\tilde{I}_{(k)}] = 0$\n- $\\mathbb{E}[I_{(j)} I_{(k)}] = h\\,\\delta_{jk}$, $\\mathbb{E}[\\tilde{I}_{(j)} \\tilde{I}_{(k)}] = h\\,\\delta_{jk}$\n- $\\mathbb{E}[I_{(j)} \\tilde{I}_{(k)}] = 0$（这强制要求独立性/不相关性）\n- 所有三阶矩都为零。\n- 四阶矩与高斯变量的矩匹配，例如，当 $j \\neq k$ 时，$\\mathbb{E}[I_{(k)}^4] = 3h^2$, $\\mathbb{E}[I_{(j)}^2 I_{(k)}^2] = h^2$，对 $\\tilde{I}$ 也类似。\n\n在考察弱 Itô-Taylor 展开的结构时，两组独立随机变量的必要性就变得清晰了。在 $\\mathbb{E}[\\varphi(Y_1)]$ 的展开式中，会出现涉及阶段值中的扰动与最终增量之积的交叉项。例如，一个项来自于\n$$\n\\mathbb{E}\\left[ \\left(\\frac{h}{2}(a(K_2) - a(x))\\right) \\cdot \\left(\\sum_{k=1}^d b_k(x) I_{(k)}\\right) \\right].\n$$\n项 $a(K_2)-a(x)$ 依赖于 $\\tilde{I}_{(j)}$。如果 $I_{(k)}$ 和 $\\tilde{I}_{(j)}$ 不是独立的（或至少是不相关的），这个期望值将不为零，并且其阶数会污染最终的展开式，从而阻止格式达到弱2阶。例如，$a(K_2)-a(x)$ 中的主导项是 $\\sum_j \\nabla a(x) b_j(x) \\tilde{I}_{(j)}$。此时，期望值就涉及到 $\\mathbb{E}[\\tilde{I}_{(j)} I_{(k)}]$。将此设为零可以简化分析，并允许系数的正确匹配。如果我们选择 $I_{(k)}$ 和 $\\tilde{I}_{(k)}$ 是独立的，这个期望值就会消失。\n\n此外，在第二阶段 $K_2$ 中对漂移函数 $a$ 的自变量进行扰动，对于捕捉 $(L^k)^2\\varphi(x)$ 项至关重要。在 $\\mathbb{E}[Y_1]$ 的展开中，项 $\\mathbb{E}[a(K_2)]$ 贡献了 $h(L^0a)(x)$，这导致了 $(L^0)^2\\varphi(x)$ 项。真实解展开中漂移项和扩散项之间的相互作用，被 SRK 格式的结构所模仿，其中漂移函数的阶段值受到基于扩散部分的随机项的扰动。使用具有高斯矩的随机变量 $\\tilde{I}_{(k)}$ 确保了这些修正项具有正确的大小。\n\n现在，我们确定此设计每个时间步所需的独立标准正态标量样本的最小数量 $m(d)$。\n我们的格式需要两组随机向量：\n1. $I = (I_{(1)}, \\dots, I_{(d)})^\\top$。我们设 $I_{(k)} = \\Delta W_h^k = \\sqrt{h}\\,\\zeta_k$，其中对 $k=1, \\dots, d$，$\\zeta_k \\sim N(0,1)$ 是独立的。这需要 $d$ 个独立的标准正态样本。\n2. $\\tilde{I} = (\\tilde{I}_{(1)}, \\dots, \\tilde{I}_{(d)})^\\top$。我们设 $\\tilde{I}_{(k)} = \\Delta \\tilde{W}_h^k = \\sqrt{h}\\,\\eta_k$，其中对 $k=1, \\dots, d$，$\\eta_k \\sim N(0,1)$ 是独立的。关键的是，集合 $\\{\\eta_k\\}$ 必须独立于集合 $\\{\\zeta_k\\}$。\n\n令所需的 $2d$ 个标准正态变量的总集合为 $Z = (\\zeta_1, \\dots, \\zeta_d, \\eta_1, \\dots, \\eta_d)^\\top$。我们需要生成 $Z$，使其协方差矩阵为单位矩阵，即 $\\mathrm{Cov}(Z) = I_{2d}$。\n假设我们通过线性变换 $Z = M \\xi$ 从 $m$ 个底层的独立标准正态标量样本 $\\xi = (\\xi_1, \\dots, \\xi_m)^\\top$ 生成 $Z$，其中 $M$ 是一个 $(2d) \\times m$ 矩阵。\n$Z$ 的协方差为\n$$\n\\mathrm{Cov}(Z) = \\mathbb{E}[Z Z^\\top] = \\mathbb{E}[(M\\xi)(M\\xi)^\\top] = M \\mathbb{E}[\\xi\\xi^\\top] M^\\top = M I_m M^\\top = M M^\\top.\n$$\n为了使我们的格式有效，我们需要 $\\mathrm{Cov}(Z) = I_{2d}$。这给出了条件 $M M^\\top = I_{2d}$。\n矩阵乘积的秩最多是各因子秩的最小值。$(2d) \\times m$ 矩阵 $M$ 的秩最多为 $m$。因此，$M M^\\top$ 的秩最多为 $m$。单位矩阵 $I_{2d}$ 的秩是 $2d$。\n这导出了不等式：\n$$\n\\mathrm{rank}(I_{2d}) \\le \\mathrm{rank}(M M^\\top) \\le m \\implies 2d \\le m.\n$$\n因此，所需的独立标准正态样本的最小数量为 $m(d) = 2d$。通过简单地抽取 $2d$ 个独立的标准正态样本，并将它们划分为所需的两个集合 $\\{\\zeta_k\\}_{k=1}^d$ 和 $\\{\\eta_k\\}_{k=1}^d$，就可以达到这个最小值。\n\n虽然更高级的格式或对随机变量的不同选择（例如，离散变量）可能会减少其他设计的这个数量，但对于依赖于两个独立类高斯增量的指定两阶段 SRK 设计而言，这是最小数量。", "answer": "$$\n\\boxed{2d}\n$$", "id": "2998607"}]}