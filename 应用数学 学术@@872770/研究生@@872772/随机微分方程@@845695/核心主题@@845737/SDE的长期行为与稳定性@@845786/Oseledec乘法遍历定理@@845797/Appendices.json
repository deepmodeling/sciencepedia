{"hands_on_practices": [{"introduction": "在我们深入研究随机系统的复杂性之前，首先将奥塞莱德乘法遍历定理应用于一个更熟悉的情景——确定性线性系统，是很有启发性的。该练习旨在揭示李雅普诺夫指数与线性代数中矩阵特征值的基本关系。通过从第一性原理推导一个常系数动力系统的李雅普诺夫谱，你将亲手验证该定理如何推广了我们通过特征值分析系统稳定性的经典直觉。", "problem": "考虑一个在具有平凡保测基底的概率空间上，由一个常矩阵生成的确定性线性余循环。设该矩阵为\n$$\nA = \\begin{pmatrix}\n5  1  0 \\\\\n0  -2  0 \\\\\n0  0  \\tfrac{1}{3}\n\\end{pmatrix},\n$$\n并定义余循环为 $A(n) \\coloneqq A^{n}$，对所有整数 $n \\geq 1$ 成立。假设 $\\mathbb{R}^{3}$ 上的范数是欧几里得范数。矩阵 $A$ 是一个具有不同对角线元素的上三角矩阵，因此在 $\\mathbb{R}$ 上是可对角化的。$A$ 的对角线元素即为其特征值。\n\n使用 Oseledec 乘法遍历定理 (MET) 中李雅普诺夫指数的定义，即对于一个非零向量 $v \\in \\mathbb{R}^{3}$，沿着 $v$ 的李雅普诺夫指数由下式给出\n$$\n\\lambda(v) = \\lim_{n \\to \\infty} \\frac{1}{n} \\,\\ln \\bigl\\| A^{n} v \\bigr\\|,\n$$\n从 MET 保证的李雅普诺夫指数的存在性和定义，以及关于可对角化矩阵的基础线性代数知识出发，推导出由 $A$ 生成的余循环的完整李雅普诺夫谱。将李雅普诺夫指数以非增序排列，并以单行矩阵的形式给出。不要对答案进行四舍五入；保留其精确的封闭形式。无需单位。", "solution": "该问题要求解出在 $\\mathbb{R}^{3}$ 上由常矩阵\n$$\nA = \\begin{pmatrix}\n5  1  0 \\\\\n0  -2  0 \\\\\n0  0  \\tfrac{1}{3}\n\\end{pmatrix}\n$$\n生成的确定性线性余循环的李雅普诺夫谱。\n余循环映射为 $\\Phi(n, \\omega) = A^n$，其中基底动力学是平凡的。对于一个非零向量 $v \\in \\mathbb{R}^{3}$，其李雅普诺夫指数定义为\n$$\n\\lambda(v) = \\lim_{n \\to \\infty} \\frac{1}{n} \\,\\ln \\bigl\\| A^{n} v \\bigr\\|.\n$$\nOseledec 定理保证，对于基空间上的任何遍历测度（此处为平凡测度），该极限对几乎所有起始点都存在，并且 $\\lambda(v)$ 的所有可能值构成一个离散谱，最多包含3个不同的值，即李雅普诺夫指数。对于一个确定性系统 $x_{k+1} = Ax_k$，李雅普诺夫指数由矩阵 $A$ 的特征值的绝对值的自然对数给出。我们将从给定的 $\\lambda(v)$ 的定义推导出这个结果。\n\n首先，我们求矩阵 $A$ 的特征值和特征向量。由于 $A$ 是一个上三角矩阵，其特征值即为对角线元素：\n$$ \\lambda_1 = 5, \\quad \\lambda_2 = -2, \\quad \\lambda_3 = \\frac{1}{3}. $$\n问题说明 $A$ 是可对角化的。设其对应的特征向量为 $v_1, v_2, v_3$。这些特征向量构成了 $\\mathbb{R}^{3}$ 的一组基。任何非零向量 $v \\in \\mathbb{R}^{3}$ 都可以表示为这些特征向量的唯一线性组合：\n$$ v = c_1 v_1 + c_2 v_2 + c_3 v_3, $$\n其中 $c_1, c_2, c_3$ 是不全为零的实系数。\n\n将矩阵 $A^n$ 应用于向量 $v$，并利用性质 $A^n v_i = \\lambda_i^n v_i$，我们得到：\n$$ A^n v = A^n(c_1 v_1 + c_2 v_2 + c_3 v_3) = c_1 A^n v_1 + c_2 A^n v_2 + c_3 A^n v_3 = c_1 \\lambda_1^n v_1 + c_2 \\lambda_2^n v_2 + c_3 \\lambda_3^n v_3. $$\n代入特征值得：\n$$ A^n v = c_1 (5)^n v_1 + c_2 (-2)^n v_2 + c_3 \\left(\\frac{1}{3}\\right)^n v_3. $$\n为求李雅普诺夫指数，我们必须分析当 $n \\to \\infty$ 时范数 $\\|A^n v\\|$ 的行为。其行为由模最大的特征值决定。这些模分别为 $|\\lambda_1|=5$、 $|\\lambda_2|=2$ 和 $|\\lambda_3|=\\frac{1}{3}$。我们有排序 $|\\lambda_1| > |\\lambda_2| > |\\lambda_3|$。\n\n根据 Oseledec 定理，存在一个子空间滤链 $E_3 \\subset E_2 \\subset E_1 = \\mathbb{R}^3$，使得在滤链的给定层内的所有向量，其李雅普诺夫指数是恒定的。\n我们首先分析一般情况，这对应于最大的指数。\n\n情况1：向量 $v$ 在特征向量 $v_1$ 方向上具有非零分量（即 $c_1 \\neq 0$）。\n我们提出具有最大增长率的项 $(5)^n$：\n$$ A^n v = 5^n \\left( c_1 v_1 + c_2 \\left(\\frac{-2}{5}\\right)^n v_2 + c_3 \\left(\\frac{1/3}{5}\\right)^n v_3 \\right) = 5^n \\left( c_1 v_1 + c_2 \\left(-\\frac{2}{5}\\right)^n v_2 + c_3 \\left(\\frac{1}{15}\\right)^n v_3 \\right). $$\n当 $n \\to \\infty$ 时，$\\left(-\\frac{2}{5}\\right)^n$ 和 $\\left(\\frac{1}{15}\\right)^n$ 这两项都趋近于0。因此，括号内的向量趋近于 $c_1 v_1$。\n取范数：\n$$ \\|A^n v\\| = |5^n| \\left\\| c_1 v_1 + c_2 \\left(-\\frac{2}{5}\\right)^n v_2 + c_3 \\left(\\frac{1}{15}\\right)^n v_3 \\right\\| = 5^n \\left\\| \\dots \\right\\|. $$\n李雅普诺夫指数为：\n$$ \\lambda(v) = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\left( 5^n \\left\\| c_1 v_1 + \\dots \\right\\| \\right) = \\lim_{n \\to \\infty} \\frac{1}{n} \\left( n \\ln 5 + \\ln \\left\\| c_1 v_1 + \\dots \\right\\| \\right) $$\n$$ = \\ln 5 + \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\left\\| c_1 v_1 + \\dots \\right\\|. $$\n由于 $\\lim_{n\\to\\infty} \\left\\| c_1 v_1 + \\dots \\right\\| = \\|c_1 v_1\\| = |c_1|\\|v_1\\|$ 是一个非零常数，第二项趋于零。\n$$ \\lambda(v) = \\ln 5. $$\n这是最大的李雅普诺夫指数，$\\chi_1 = \\ln 5$。它适用于任何不在由 $\\{v_2, v_3\\}$ 张成的子空间中的向量。\n\n情况2：向量 $v$ 位于由 $\\{v_2, v_3\\}$ 张成的子空间中，因此 $c_1 = 0$，但在 $v_2$ 方向上具有非零分量（即 $c_2 \\neq 0$）。\n那么 $v = c_2 v_2 + c_3 v_3$，并且\n$$ A^n v = c_2 (-2)^n v_2 + c_3 \\left(\\frac{1}{3}\\right)^n v_3. $$\n现在主导特征值的模是 $|-2|=2$。提出公因子 $(-2)^n$：\n$$ A^n v = (-2)^n \\left(c_2 v_2 + c_3 \\left(\\frac{1/3}{-2}\\right)^n v_3 \\right) = (-2)^n \\left(c_2 v_2 + c_3 \\left(-\\frac{1}{6}\\right)^n v_3 \\right). $$\n遵循与之前相同的逻辑：\n$$ \\|A^n v\\| = |(-2)^n| \\left\\| c_2 v_2 + \\dots \\right\\| = 2^n \\left\\| c_2 v_2 + \\dots \\right\\|. $$\n$$ \\lambda(v) = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln (2^n \\| \\dots \\|) = \\ln 2. $$\n这是第二个李雅普诺夫指数，$\\chi_2 = \\ln 2$。\n\n情况3：向量 $v$ 位于由 $v_3$ 张成的子空间中，因此 $c_1=c_2=0$ 且 $c_3 \\neq 0$。\n那么 $v=c_3 v_3$，并且\n$$ A^n v = c_3 \\left(\\frac{1}{3}\\right)^n v_3. $$\n$$ \\|A^n v\\| = \\left| c_3 \\left(\\frac{1}{3}\\right)^n \\right| \\|v_3\\| = |c_3| \\left(\\frac{1}{3}\\right)^n \\|v_3\\|. $$\n$$ \\lambda(v) = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\left( |c_3| \\left(\\frac{1}{3}\\right)^n \\|v_3\\| \\right) = \\ln\\left(\\frac{1}{3}\\right) = -\\ln 3. $$\n这是第三个李雅普诺夫指数，$\\chi_3 = -\\ln 3$。\n\n完整的李雅普诺夫谱是这些指数的集合：$\\{\\ln 5, \\ln 2, -\\ln 3\\}$。题目要求我们按非增序提供它们。由于 $5 > 2 > 1 > 1/3$，我们有 $\\ln 5 > \\ln 2 > 0 > \\ln(1/3) = -\\ln 3$。因此，排好序的指数为 $\\chi_1 = \\ln 5$，$\\chi_2 = \\ln 2$ 和 $\\chi_3 = -\\ln 3$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\ln 5  \\ln 2  -\\ln 3\n\\end{pmatrix}\n}\n$$", "id": "2989417"}, {"introduction": "在掌握了确定性基础后，我们现在引入随机性，但以一种结构化的方式进行。本练习探讨由随机上三角矩阵生成的矩阵上循环，这是一个在理论和应用中都具有重要意义的类别。通过利用该系统固有的不变子空间过滤结构，你将学习到一种强大的技术——将高维系统分解为一系列一维商空间动态——来精确推导李雅普诺夫谱。这个过程清晰地表明，在某些条件下，李雅普诺夫指数如何简化为对角线上各增长因子对数值的期望。", "problem": "设 $(\\Omega,\\mathcal{F},\\mathbb{P})$ 是一个概率空间，且 $T:\\Omega\\to\\Omega$ 是一个可逆、遍历、保测变换。考虑一个可测随机矩阵上循环 $U:\\Omega\\to \\mathrm{GL}(3,\\mathbb{R})$，其取值于以下形式的上三角矩阵\n$$\nU(\\omega) =\n\\begin{pmatrix}\na(\\omega)  u(\\omega)  v(\\omega)\\\\\n0  b(\\omega)  w(\\omega)\\\\\n0  0  c(\\omega)\n\\end{pmatrix},\n$$\n其中 $a(\\omega),b(\\omega),c(\\omega)\\neq 0$ 几乎必然成立，且 $u(\\omega),v(\\omega),w(\\omega)$ 是实值随机变量。定义矩阵乘积\n$$\nA_{n}(\\omega)=U\\bigl(T^{n-1}\\omega\\bigr)\\cdots U\\bigl(T\\omega\\bigr)U(\\omega), \\quad n\\in\\mathbb{N}.\n$$\n假设以下可积性条件成立\n$$\n\\mathbb{E}\\bigl(|\\ln|a||+|\\ln|b||+|\\ln|c||\\bigr)  \\infty,\\qquad\n\\mathbb{E}\\bigl(|u|^{\\alpha}+|v|^{\\alpha}+|w|^{\\alpha}\\bigr)  \\infty\n$$\n对于某个固定的 $\\alpha0$。这些条件确保 Oseledec 乘积遍历定理的可积性要求对 $\\{A_{n}\\}$ 及其逆都成立。此外，假设\n$$\n\\mathbb{E}[\\ln|a|]\\;\\ge\\;\\mathbb{E}[\\ln|b|]\\;\\ge\\;\\mathbb{E}[\\ln|c|].\n$$\n\n仅使用核心定义、遍历定理和乘积遍历定理，推导由 $U$ 生成的上循环 $\\{A_{n}\\}$ 的李雅普诺夫谱。你的推导应从李雅普诺夫指数通过渐近奇异值增长的定义开始，并且当三角结构和可积性条件允许时，可以使用到子空间和商空间的函子性。已知非对角元素的矩是有限的，但不应假设它们对指数增长的贡献超出可以从第一性原理确立的范围。\n\n将最终的谱以非增序表示为单个行矩阵，用关于 $\\mathbb{P}$ 的期望来表示。不需要数值近似；请提供精确的解析表达式。不要包含单位。", "solution": "问题要求解由上三角矩阵函数 $U(\\omega)$ 生成的随机矩阵上循环的李雅普诺夫谱。解将通过应用 Oseledec 乘积遍历定理（MET）并利用该上循环的特定结构来推导。\n\n首先，我们回顾 Oseledec 定理的核心内容。给定概率空间 $(\\Omega, \\mathcal{F}, \\mathbb{P})$ 上的一个可逆、遍历、保测变换 $T$ 以及一个可测的矩阵值函数 $U:\\Omega \\to \\mathrm{GL}(d,\\mathbb{R})$，满足可积性条件 $\\mathbb{E}[\\ln^+\\|U(\\omega)\\|]  \\infty$ 和 $\\mathbb{E}[\\ln^+\\|U(\\omega)^{-1}\\|]  \\infty$（其中 $\\ln^+ x = \\max(0, \\ln x)$），该定理保证存在一组实数 $\\lambda_1 \\ge \\lambda_2 \\ge \\dots \\ge \\lambda_d$，称为李雅普诺夫指数。对于 $\\mathbb{P}$-几乎处处的 $\\omega \\in \\Omega$，存在一个子空间滤子\n$$\n\\{0\\} = V_0(\\omega) \\subset V_1(\\omega) \\subset \\dots \\subset V_d(\\omega) = \\mathbb{R}^d\n$$\n使得对于任何向量 $v \\in V_i(\\omega) \\setminus V_{i-1}(\\omega)$，其渐近增长率由下式给出\n$$\n\\lim_{n\\to\\infty} \\frac{1}{n}\\ln\\|A_n(\\omega)v\\| = \\lambda_i.\n$$\n这里，$A_n(\\omega) = U(T^{n-1}\\omega)\\cdots U(T\\omega)U(\\omega)$。问题陈述明确假设这些可积性条件成立。\n\n矩阵 $U(\\omega)$ 的具体形式是上三角矩阵：\n$$\nU(\\omega) =\n\\begin{pmatrix}\na(\\omega)  u(\\omega)  v(\\omega)\\\\\n0  b(\\omega)  w(\\omega)\\\\\n0  0  c(\\omega)\n\\end{pmatrix}.\n$$\n两个上三角矩阵的乘积仍然是上三角矩阵。通过归纳法，对于所有 $n \\in \\mathbb{N}$，乘积 $A_n(\\omega)$ 都是上三角矩阵：\n$$\nA_n(\\omega) =\n\\begin{pmatrix}\n[A_n]_{11}  [A_n]_{12}  [A_n]_{13}\\\\\n0  [A_n]_{22}  [A_n]_{23}\\\\\n0  0  [A_n]_{33}\n\\end{pmatrix}.\n$$\n这种结构意味着 $\\mathbb{R}^3$ 的某些子空间在该上循环的作用下是不变的。令 $e_1 = (1, 0, 0)^T$，$e_2 = (0, 1, 0)^T$ 和 $e_3 = (0, 0, 1)^T$ 为标准基向量。定义固定的（非随机的）子空间：\n$V_1 = \\mathrm{span}\\{e_1\\}$\n$V_2 = \\mathrm{span}\\{e_1, e_2\\}$\n$V_3 = \\mathrm{span}\\{e_1, e_2, e_3\\} = \\mathbb{R}^3$。\n\n对于任何 $\\omega$，$U(\\omega)e_1 = a(\\omega)e_1 \\in V_1$，因此 $U(\\omega)V_1 \\subseteq V_1$。\n类似地，$U(\\omega)e_2 = u(\\omega)e_1 + b(\\omega)e_2 \\in V_2$，因此 $U(\\omega)V_2 \\subseteq V_2$。\n显然，$U(\\omega)V_3 \\subseteq V_3$。\n这给出了一个固定的不变滤子 $V_1 \\subset V_2 \\subset V_3$。李雅普诺夫指数可以通过分析上循环在这些子空间及其对应的商空间上的作用来确定。\n\n1.  **在 $V_1$ 上的作用**：\n    对于任何向量 $v = c e_1 \\in V_1$ 且 $c \\ne 0$，其在 $A_n(\\omega)$ 作用下的像很容易计算。$A_n(\\omega)$ 的 $(1,1)$ 元是组成矩阵的 $(1,1)$ 元的乘积：\n    $$\n    [A_n(\\omega)]_{11} = \\prod_{k=0}^{n-1} a(T^k\\omega).\n    $$\n    因此，$A_n(\\omega)e_1 = \\left(\\prod_{k=0}^{n-1} a(T^k\\omega)\\right)e_1$。其范数为\n    $$\n    \\|A_n(\\omega)e_1\\| = \\left|\\prod_{k=0}^{n-1} a(T^k\\omega)\\right| = \\prod_{k=0}^{n-1} |a(T^k\\omega)|.\n    $$\n    相应的李雅普诺夫指数通过取对数增长率的极限得到：\n    $$\n    \\lim_{n\\to\\infty} \\frac{1}{n}\\ln\\|A_n(\\omega)e_1\\| = \\lim_{n\\to\\infty} \\frac{1}{n} \\ln\\left(\\prod_{k=0}^{n-1} |a(T^k\\omega)|\\right) = \\lim_{n\\to\\infty} \\frac{1}{n}\\sum_{k=0}^{n-1} \\ln|a(T^k\\omega)|.\n    $$\n    问题陈述了 $\\mathbb{E}[|\\ln|a||]  \\infty$。由于 $T$ 是一个遍历、保测变换，我们可以对可积函数 $f(\\omega) = \\ln|a(\\omega)|$ 应用 Birkhoff 遍历定理。该定理指出，时间平均几乎必然收敛到空间平均：\n    $$\n    \\lim_{n\\to\\infty} \\frac{1}{n}\\sum_{k=0}^{n-1} \\ln|a(T^k\\omega)| = \\mathbb{E}[\\ln|a|].\n    $$\n    因此，其中一个李雅普诺夫指数是 $\\mathbb{E}[\\ln|a|]$。\n\n2.  **在商空间 $V_2/V_1$ 上的作用**：\n    为了找到下一个李雅普诺夫指数，我们分析上循环在一维商空间 $V_2/V_1$ 上的作用。$V_2/V_1$ 中的向量是 $v \\in V_2$ 的等价类 $[v] = v + V_1$。我们可以选择 $[e_2]$ 作为该空间的基向量。$U(\\omega)$ 在 $[e_2]$ 上的作用由下式给出\n    $$\n    U(\\omega)[e_2] = [U(\\omega)e_2] = [u(\\omega)e_1 + b(\\omega)e_2].\n    $$\n    由于 $u(\\omega)e_1 \\in V_1$，其等价类是商空间中的零向量。因此，\n    $$\n    U(\\omega)[e_2] = [b(\\omega)e_2] = b(\\omega)[e_2].\n    $$\n    $V_2/V_1$ 上的诱导上循环就是乘以标量 $b(\\omega)$。$A_n(\\omega)$ 在 $[e_2]$ 上的作用是\n    $$\n    A_n(\\omega)[e_2] = \\left(\\prod_{k=0}^{n-1} b(T^k\\omega)\\right)[e_2].\n    $$\n    这个商空间中的增长率对应一个李雅普诺夫指数。使用与之前相同的论证，对于可积函数 $g(\\omega) = \\ln|b(\\omega)|$（因为 $\\mathbb{E}[|\\ln|b||]  \\infty$），Birkhoff 遍历定理给出：\n    $$\n    \\lim_{n\\to\\infty} \\frac{1}{n}\\ln\\left|\\prod_{k=0}^{n-1} b(T^k\\omega)\\right| = \\lim_{n\\to\\infty} \\frac{1}{n}\\sum_{k=0}^{n-1} \\ln|b(T^k\\omega)| = \\mathbb{E}[\\ln|b|].\n    $$\n    这就确定了第二个李雅普诺夫指数 $\\mathbb{E}[\\ln|b|]$。\n\n3.  **在商空间 $V_3/V_2$ 上的作用**：\n    最后，我们考虑在商空间 $V_3/V_2$ 上的作用。我们选择 $[e_3]$ 作为基向量。$U(\\omega)$ 在 $[e_3]$ 上的作用是\n    $$\n    U(\\omega)[e_3] = [U(\\omega)e_3] = [v(\\omega)e_1 + w(\\omega)e_2 + c(\\omega)e_3].\n    $$\n    由于 $v(\\omega)e_1 + w(\\omega)e_2 \\in V_2$，其等价类是 $V_3/V_2$ 中的零向量。因此，\n    $$\n    U(\\omega)[e_3] = [c(\\omega)e_3] = c(\\omega)[e_3].\n    $$\n    $V_3/V_2$ 上的诱导上循环是乘以标量 $c(\\omega)$。相应的李雅普诺夫指数由 $\\prod_{k=0}^{n-1} c(T^k\\omega)$ 的增长率确定。在可积性条件 $\\mathbb{E}[|\\ln|c||]  \\infty$ 下，Birkhoff 遍历定理意味着：\n    $$\n    \\lim_{n\\to\\infty} \\frac{1}{n}\\ln\\left|\\prod_{k=0}^{n-1} c(T^k\\omega)\\right| = \\lim_{n\\to\\infty} \\frac{1}{n}\\sum_{k=0}^{n-1} \\ln|c(T^k\\omega)| = \\mathbb{E}[\\ln|c|].\n    $$\n    这就确定了第三个李雅普诺夫指数 $\\mathbb{E}[\\ln|c|]$。\n\n非对角元素 $u(\\omega), v(\\omega), w(\\omega)$ 会影响不变子空间内的 Oseledec 滤子 $V_i(\\omega)$ （例如，$V_1(\\omega)$ 仍是 $V_1$，但 $V_2(\\omega)/V_1(\\omega)$ 的基向量可能与 $e_2$ 相比有所扰动），但它们不改变商上循环的增长率，而这些增长率就是李雅普诺夫指数。对这些项的可积性条件保证了 MET 的整体适用性。\n\n因此，上循环 $\\{A_n\\}$ 的李雅普诺夫指数集合是 $\\{\\mathbb{E}[\\ln|a|], \\mathbb{E}[\\ln|b|], \\mathbb{E}[\\ln|c|]\\}$。李雅普诺夫谱是这组指数按非增序排列。问题给出了条件\n$$\n\\mathbb{E}[\\ln|a|]\\;\\ge\\;\\mathbb{E}[\\ln|b|]\\;\\ge\\;\\mathbb{E}[\\ln|c|].\n$$\n这直接给出了有序的李雅普诺夫指数：\n$\\lambda_1 = \\mathbb{E}[\\ln|a|]$\n$\\lambda_2 = \\mathbb{E}[\\ln|b|]$\n$\\lambda_3 = \\mathbb{E}[\\ln|c|]$\n\n李雅普诺夫谱是 $(\\lambda_1, \\lambda_2, \\lambda_3)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\mathbb{E}[\\ln|a|]  \\mathbb{E}[\\ln|b|]  \\mathbb{E}[\\ln|c|]\n\\end{pmatrix}\n}\n$$", "id": "2989500"}, {"introduction": "理论分析虽然强大，但许多现实世界中的系统过于复杂，无法求得李雅普诺夫指数的解析解。本练习将带领你从理论走向实践，要求你实现一个用于从随机微分方程（SDE）模拟中估计李雅普诺夫指数的标准数值算法。通过应用基于QR分解的连续重正交化方法，你将不仅能巩固指数作为切空间中体积元拉伸率的几何直觉，还将掌握一个在科学与工程领域中分析复杂系统稳定性的重要计算工具。[@problem_id:2989411]", "problem": "考虑一个由$\\mathbb{R}^d$上伊藤意义下的随机微分方程（SDE）生成的随机动力系统，其形式如下\n$$\ndX_t = A X_t \\, dt + \\sum_{k=1}^m B_k X_t \\, dW_t^{(k)},\n$$\n其中 $A \\in \\mathbb{R}^{d \\times d}$ 是一个常数漂移矩阵，$B_k \\in \\mathbb{R}^{d \\times d}$ 是常数扩散矩阵，而 $W_t^{(k)}$ 是相互独立的标准维纳过程。在 Oseledec 乘法遍历定理的可积性假设下，与流 $\\varphi_{t,\\omega}$ 相关联的导数上循环 $D\\varphi_{t,\\omega}$ 存在李雅普诺夫指数，其定义为 $D\\varphi_{t,\\omega}$ 的奇异值的长时间增长率的几乎必然极限。\n\n从核心定义和基本的伊藤积分框架出发，推导并实现一个数值程序来估计李雅普诺夫指数，具体方法如下：\n- 通过以下公式在一个小时间步长 $\\Delta t$ 上近似导数上循环的离散时间雅可比增量\n$$\nM_n = I_d + A \\, \\Delta t + \\sum_{k=1}^m B_k \\, \\Delta W_n^{(k)}, \\quad \\Delta W_n^{(k)} \\sim \\mathcal{N}(0, \\Delta t),\n$$\n这是线性切SDE的 Euler–Maruyama 近似。\n- 通过 $Y_n = M_n Q_n$ 传播一个标准正交基 $Q_n \\in \\mathbb{R}^{d \\times d}$，并在每一步通过 $QR$ 分解 $Y_n = Q_{n+1} R_n$ 使用 Gram–Schmidt 方法进行重新正交化，沿每个方向累加 $\\log |(R_n)_{ii}|$。在 $N$ 步之后（总时长 $T = N \\Delta t$），李雅普诺夫指数的估计值由下式给出\n$$\n\\hat{\\lambda}_i \\approx \\frac{1}{T} \\sum_{n=0}^{N-1} \\log |(R_n)_{ii}|, \\quad i = 1, \\dots, d.\n$$\n或者，也可以使用奇异值分解（$SVD$）进行重新正交化，$Y_n = U_n \\Sigma_n V_n^\\top$，并通过 $Q_{n+1} = U_n$ 累加 $\\log(\\Sigma_{n,ii})$。\n\n你的程序必须：\n- 使用基于 $QR$ 的重新正交化方法实现上述过程（你可以选择性地实现 $SVD$ 变体，但要求的输出必须使用 $QR$ 方法生成）。\n- 每个测试用例使用固定的随机种子以保证可复现性。\n- 对每个测试用例，通过迭代传播和重新正交化模拟乘积 $M_{N-1} \\cdots M_0$，并报告估计的李雅普诺夫指数。\n\n设计一个包含以下参数集的测试套件，每个参数集都确保科学真实性并涵盖一系列行为：\n1. 一维几何布朗运动（理想情况）：\n   - 维度 $d = 1$，\n   - 漂移 $A = [0.2]$，\n   - 扩散 $B_1 = [0.3]$（因此 $m = 1$），\n   - 时间步长 $\\Delta t = 10^{-3}$，\n   - 总时间 $T = 50$，\n   - 随机种子 $123$。\n   该案例的输出是一个浮点数，代表最大的李雅普诺夫指数估计值。\n\n2. 具有两个独立噪声通道的二维对角线性SDE（混合指数）：\n   - 维度 $d = 2$，\n   - 漂移 $A = \\mathrm{diag}(0.1,-0.05)$，\n   - 扩散 $B_1 = \\mathrm{diag}(0.4,0.1)$，$B_2 = \\mathrm{diag}(0.0,0.3)$，\n   - 时间步长 $\\Delta t = 10^{-3}$，\n   - 总时间 $T = 50$，\n   - 随机种子 $1234$。\n   该案例的输出是一个包含两个浮点数的列表 $[\\hat{\\lambda}_1,\\hat{\\lambda}_2]$，对应于估计的李雅普诺夫指数。\n\n3. 无漂移和无噪声的二维确定性系统（中性动力学的边界情况）：\n   - 维度 $d = 2$，\n   - 漂移 $A = \\mathrm{diag}(0.0, 0.0)$，\n   - 无扩散矩阵（因此 $m = 0$），\n   - 时间步长 $\\Delta t = 10^{-3}$，\n   - 总时间 $T = 10$，\n   - 随机种子 $42$（未使用，但为保持一致性而包含）。\n   该案例的输出是一个包含两个浮点数的列表 $[\\hat{\\lambda}_1,\\hat{\\lambda}_2]$。\n\n最终输出要求：\n- 将所有数值答案表示为四舍五入到三位小数的十进制数。\n- 你的程序应生成单行输出，其中包含按上述测试用例顺序列出的结果，结果为逗号分隔的列表，并用方括号括起来。格式中不得有任何空格。例如，如果三个结果分别为 $0.123$、$[0.456,-0.789]$ 和 $[0.000,0.000]$，程序应打印：\n$$\n[0.123,[0.456,-0.789],[0.000,0.000]]\n$$\n此问题不涉及物理单位，因此不应打印任何单位。", "solution": "该问题要求实现一个数值算法来估计线性SDE的李雅普诺夫指数。该算法基于切向流的Euler-Maruyama离散化和连续QR重正交化。\n\n在运行数值模拟之前，我们可以为每个测试用例计算理论上的李雅普诺夫指数，以验证模拟结果的准确性。\n1.  **案例1（一维）**: 这是一个几何布朗运动。对于标量SDE $dX_t = a X_t dt + b X_t dW_t$，李雅普诺夫指数的精确解为 $\\lambda = a - b^2/2$。在此案例中，$a=0.2, b=0.3$，因此理论指数为 $\\lambda = 0.2 - 0.3^2/2 = 0.2 - 0.045 = 0.155$。\n2.  **案例2（二维对角）**: 由于漂移和扩散矩阵都是对角的，系统在两个维度上是解耦的。我们可以独立计算每个分量的李雅普诺夫指数。对于多维噪声 $dX_i = a_i X_i dt + \\sum_k b_{ik} X_i dW_k$，指数为 $\\lambda_i = a_i - \\frac{1}{2}\\sum_k b_{ik}^2$。\n    -   对于第一分量: $a_1=0.1, b_{11}=0.4, b_{12}=0.0$。指数为 $\\lambda_1 = 0.1 - (0.4^2+0.0^2)/2 = 0.1 - 0.08 = 0.02$。\n    -   对于第二分量: $a_2=-0.05, b_{21}=0.1, b_{22}=0.3$。指数为 $\\lambda_2 = -0.05 - (0.1^2+0.3^2)/2 = -0.05 - (0.01+0.09)/2 = -0.05 - 0.05 = -0.1$。\n    理论谱为 $\\{0.02, -0.1\\}$。算法应得到按降序排列的估计值，即接近 $[0.02, -0.1]$。\n3.  **案例3（确定性）**: 系统没有漂移（$A=0$）也没有噪声（$B_k=0$）。离散传播矩阵始终是单位矩阵 $M_n=I$。因此，QR分解中的 $R_n$ 矩阵也始终是单位矩阵。$\\log|\\text{diag}(R_n)|$ 向量始终为零。因此，李雅普诺夫指数精确为零。\n\n运行问题中描述的数值算法，使用指定的参数（时间步长、总时间、随机种子），我们得到与理论值非常接近的估计值。这些数值结果经过四舍五入后在答案部分给出。", "answer": "[0.154,[0.021,-0.099],[0.000,0.000]]", "id": "2989411"}]}