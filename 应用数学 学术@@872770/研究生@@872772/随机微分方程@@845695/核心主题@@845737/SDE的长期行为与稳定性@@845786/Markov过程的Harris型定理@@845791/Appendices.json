{"hands_on_practices": [{"introduction": "朗之万随机微分方程（Langevin SDE）是分子动力学和统计力学中的基石模型。遍历理论的一个核心目标是识别并证明过程会收敛到一个唯一的平稳分布，该分布描述了系统的长期平衡状态。本练习提供了一种直接的动手方法，来验证一个给定的候选测度——吉布斯-玻尔兹曼分布 $\\pi(dx) \\propto \\exp(-U(x))\\,dx$——是否确实是平稳的。通过应用伴随生成元（即福克-普朗克算子）的定义，你将证明该测度的密度函数位于其算子的零空间中，从而证实其不变性 [@problem_id:2978611]。", "problem": "考虑在$\\mathbb{R}^{d}$上的过阻尼朗之万随机微分方程（SDE），由下式给出\n$$\ndX_{t}=-\\nabla U(X_{t})\\,dt+\\sqrt{2}\\,dW_{t},\n$$\n其中$W_{t}$是一个标准的$d$维布朗运动，$U:\\mathbb{R}^{d}\\to\\mathbb{R}$是一个二次连续可微函数。假设$U$是限制的，即存在$p>1$和$c>0$使得对于所有足够大的$|x|$都有$U(x)\\geq c|x|^{p}$，并且$U$的所有直到2阶的导数至多具有多项式增长。这些假设确保$\\int_{\\mathbb{R}^{d}}\\exp(-U(x))\\,dx  \\infty$并证明了在$\\mathbb{R}^{d}$上进行分部积分时无需考虑边界项是合理的。定义该SDE在$C_{c}^{\\infty}(\\mathbb{R}^{d})$上的无穷小生成元$\\mathcal{L}$为\n$$\n\\mathcal{L}f(x)=-\\nabla U(x)\\cdot\\nabla f(x)+\\Delta f(x),\n$$\n并令$\\mathcal{L}^{\\ast}$表示$\\mathcal{L}$关于勒贝格测度的伴随算子，使得对于光滑紧支集函数$f$和光滑可积函数$\\rho$，有\n$$\n\\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx=\\int_{\\mathbb{R}^{d}}f(x)\\,(\\mathcal{L}^{\\ast}\\rho)(x)\\,dx.\n$$\n$X_{t}$的分布律的柯尔莫哥洛夫前向方程（KFE，也称为福克-普朗克方程）是$\\partial_{t}\\rho_{t}=\\mathcal{L}^{\\ast}\\rho_{t}$。考虑概率测度\n$$\n\\pi(dx)=Z^{-1}\\exp(-U(x))\\,dx,\\qquad Z=\\int_{\\mathbb{R}^{d}}\\exp(-U(x))\\,dx.\n$$\n仅使用上述定义和第一性原理（分部积分和微分法则），计算当$\\rho(x)=Z^{-1}\\exp(-U(x))$时$(\\mathcal{L}^{\\ast}\\rho)(x)$的显式简化表达式，并报告最终的简化值。你的最终答案必须是一个实数或一个封闭形式的解析表达式。无需四舍五入。", "solution": "目标是计算$(\\mathcal{L}^{\\ast}\\rho)(x)$的显式简化表达式，其中$\\rho(x) = Z^{-1}\\exp(-U(x))$，$\\mathcal{L}^{\\ast}$是无穷小生成元$\\mathcal{L}$关于$\\mathbb{R}^d$上勒贝格测度的形式伴随算子。\n\n算子$\\mathcal{L}$对函数$f \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$定义如下：\n$$\n\\mathcal{L}f(x) = -\\nabla U(x)\\cdot\\nabla f(x)+\\Delta f(x)\n$$\n伴随算子$\\mathcal{L}^{\\ast}$由以下关系定义：\n$$\n\\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx=\\int_{\\mathbb{R}^{d}}f(x)\\,(\\mathcal{L}^{\\ast}\\rho)(x)\\,dx\n$$\n对于任意光滑紧支集函数$f$和合适的函数$\\rho$。问题要求计算对于特定的概率密度$\\rho(x) = Z^{-1}\\exp(-U(x))$（其中$Z = \\int_{\\mathbb{R}^{d}}\\exp(-U(x))\\,dx$）的$(\\mathcal{L}^{\\ast}\\rho)(x)$的值。\n\n为了找到$(\\mathcal{L}^{\\ast}\\rho)(x)$，我们将计算伴随算子定义式的左侧$\\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx$，并使用分部积分来处理该表达式，将所有对$f$的导数移到其他项上。这将揭示$(\\mathcal{L}^{\\ast}\\rho)(x)$的形式。\n\n我们将$\\mathcal{L}f(x)$的表达式代入积分中：\n$$\n\\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx = \\int_{\\mathbb{R}^{d}} \\left[-\\nabla U(x)\\cdot\\nabla f(x)+\\Delta f(x)\\right] \\rho(x)\\,dx\n$$\n我们可以将此积分分成两部分：\n$$\n\\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx = \\underbrace{\\int_{\\mathbb{R}^{d}} \\Delta f(x) \\rho(x)\\,dx}_{I_1} - \\underbrace{\\int_{\\mathbb{R}^{d}} (\\nabla U(x)\\cdot\\nabla f(x)) \\rho(x)\\,dx}_{I_2}\n$$\n我们来分析第一个积分$I_1$。项$\\Delta f(x)$是$f(x)$梯度的散度，即$\\Delta f(x) = \\nabla \\cdot (\\nabla f(x))$。我们使用分部积分，这在多维情况下是散度定理的一个推论。对于向量场$\\mathbf{F}$和标量函数$\\phi$，我们有$\\int_{V} \\phi (\\nabla \\cdot \\mathbf{F}) dV = -\\int_{V} \\mathbf{F} \\cdot (\\nabla \\phi) dV$加上边界项。由于$f \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$，$f$及其导数在紧集之外为零，这意味着所有无穷远处的边界项都为零。\n将此应用于$\\phi = \\rho(x)$和$\\mathbf{F} = \\nabla f(x)$：\n$$\nI_1 = \\int_{\\mathbb{R}^{d}} \\rho(x) (\\nabla \\cdot (\\nabla f(x)))\\,dx = - \\int_{\\mathbb{R}^{d}} \\nabla f(x) \\cdot \\nabla \\rho(x)\\,dx\n$$\n现在，我们必须计算我们特定的$\\rho(x) = Z^{-1}\\exp(-U(x))$的梯度。使用链式法则：\n$$\n\\nabla \\rho(x) = \\nabla \\left(Z^{-1}\\exp(-U(x))\\right) = Z^{-1}\\exp(-U(x)) \\cdot (-\\nabla U(x)) = -\\rho(x) \\nabla U(x)\n$$\n将此结果代回$I_1$的表达式中：\n$$\nI_1 = - \\int_{\\mathbb{R}^{d}} \\nabla f(x) \\cdot (-\\rho(x) \\nabla U(x))\\,dx = \\int_{\\mathbb{R}^{d}} \\rho(x) (\\nabla U(x) \\cdot \\nabla f(x))\\,dx\n$$\n现在我们来看第二个积分，$I_2$：\n$$\nI_2 = \\int_{\\mathbb{R}^{d}} (\\nabla U(x)\\cdot\\nabla f(x)) \\rho(x)\\,dx\n$$\n比较我们对$I_1$和$I_2$的结果，我们发现它们是相同的：\n$$\nI_1 = I_2\n$$\n将此代回完整积分的表达式中：\n$$\n\\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx = I_1 - I_2 = I_1 - I_1 = 0\n$$\n因此我们证明了，对于我们特定的$\\rho(x) = Z^{-1}\\exp(-U(x))$选择，以下等式对于任意测试函数$f \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$都成立：\n$$\n\\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx = 0\n$$\n根据伴随算子的定义，我们还有：\n$$\n\\int_{\\mathbb{R}^{d}}f(x)\\,(\\mathcal{L}^{\\ast}\\rho)(x)\\,dx = \\int_{\\mathbb{R}^{d}}(\\mathcal{L}f)(x)\\,\\rho(x)\\,dx\n$$\n因此，我们必有：\n$$\n\\int_{\\mathbb{R}^{d}}f(x)\\,(\\mathcal{L}^{\\ast}\\rho)(x)\\,dx = 0\n$$\n由于此等式对稠密集合$C_{c}^{\\infty}(\\mathbb{R}^{d})$中的所有函数$f$都成立，这意味着函数$(\\mathcal{L}^{\\ast}\\rho)(x)$对所有$x \\in \\mathbb{R}^{d}$必为零（根据变分法基本引理）。\n\n因此，$(\\mathcal{L}^{\\ast}\\rho)(x)$的显式简化表达式为$0$。这个结果在随机过程理论中是基础性的，因为它表明吉布斯测度$\\pi(dx) = \\rho(x)dx$是朗之万动力学的平稳（或不变）分布，因为其密度$\\rho(x)$位于前向算子$\\mathcal{L}^{\\ast}$的零空间中。\n最终的简化值为数字$0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "2978611"}, {"introduction": "小化条件（minorization condition）是哈里斯理论的核心，因为它确保了过程具有一个允许使用耦合论证的“再生”结构。然而，要求在单个时间步上存在一致的小化（即“小集”的定义）对于许多系统而言可能过于严苛，特别是那些包含确定性或周期性成分的系统。本练习通过一个分段确定性马尔可夫过程来深入探讨这一关键点，展示了如何通过对转移核进行时间平均来平滑其奇异性并揭示潜在的混合性质，这正是更通用、更强大的“小巧集”（petite set）概念的精髓所在 [@problem_id:2978589]。", "problem": "考虑一个在圆 $S^{1} = [0, 2\\pi)$ 上的分段确定性马尔可夫过程（PDMP），其角度状态 $\\theta_{t} \\in S^{1}$ 的演化如下。在跳跃之间，系统以角速度 $\\omega > 0$ 进行确定性旋转，即 $\\mathrm{d}\\theta_{t} = \\omega \\,\\mathrm{d}t$ (模 $2\\pi$) 。跳跃以依赖于状态的速率 $\\lambda(\\theta)$ 发生，在跳跃时刻，跳跃后的角度从 $S^{1}$ 上的一个固定概率测度 $\\mu$ 中抽样得到，该测度关于 $S^{1}$ 上的勒贝格测度具有一个严格为正且连续的密度 $m(\\theta)$。\n\n跳跃速率由以下公式给出：对于一个固定的弧 $I = [0, \\ell] \\subset S^{1}$，其中 $0  \\ell  2\\pi$，\n$$\n\\lambda(\\theta) = \n\\begin{cases}\n0,  \\theta \\in I,\\\\\n\\lambda_{0},  \\theta \\in S^{1} \\setminus I,\n\\end{cases}\n$$\n其中 $\\lambda_{0} > 0$ 是一个常数。令 $P_{t}$ 表示该PDMP的马尔可夫半群。对于一个固定的采样周期 $\\Delta \\in (0, \\ell/\\omega)$，定义离散时间骨架链 $X_{n} := \\theta_{n\\Delta}$。\n\n使用马尔可夫过程的哈里斯型遍历定理的基础框架，以及以下定义：一个集合 $C$ 是小集 (small set)，如果存在 $n \\in \\mathbb{N}$，$\\varepsilon > 0$ 和一个非平凡测度 $\\nu$，使得对于所有 $x \\in C$ 和可测集 $A$，有 $P^{n}(x, A) \\geq \\varepsilon \\nu(A)$；一个集合 $C$ 是 petite 集，如果存在一个在 $\\mathbb{N}$ 上（对于链）或在 $\\mathbb{R}_{+}$ 上（对于连续时间过程）的概率测度 $a$ 和一个非平凡测度 $\\nu$，使得对于所有 $x \\in C$ 和可测集 $A$，有 $\\sum_{n\\geq 0} a(n) P^{n}(x, A) \\geq \\varepsilon \\nu(A)$ (或 $\\int_{0}^{\\infty} a(\\mathrm{d}t) P_{t}(x, A) \\geq \\varepsilon \\nu(A)$)：\n\n1. 从第一性原理出发，解释为什么当 $\\Delta \\in (0, \\ell/\\omega)$ 时，对于离散时间骨架链 $\\{\\theta_{n\\Delta}\\}_{n\\geq 0}$，全圆 $C = S^{1}$ 不是一个小集。请通过分析路径行为和在每个固定步数下产生依赖于状态的转移核奇异分量的诱导周期性来解释。\n\n2. 证明对于连续时间PDMP，全圆 $C = S^{1}$ 是一个 petite 集。请使用概率测度 $a(\\mathrm{d}t) = \\frac{1}{T} \\mathbf{1}_{[0, T]}(t) \\,\\mathrm{d}t$ 将半群在时间窗口 $[0, T]$（其中 $T > \\ell/\\omega$）上平均，并利用在弧 $I$ 之外的跳跃所引入的绝对连续性。\n\n3. 对于平均次控制条件\n$$\n\\frac{1}{T} \\int_{0}^{T} P_{t}(\\theta_{0}, A) \\,\\mathrm{d}t \\;\\geq\\; \\varepsilon(T) \\,\\mu(A)\n$$\n对所有可测子集 $A \\subseteq S^{1}$ 成立，推导在初始条件 $\\theta_{0} \\in S^{1}$ 下可以一致保证的最大下界 $\\varepsilon(T)$ 的精确解析表达式。您的答案必须是关于 $\\omega$, $\\lambda_{0}$, $\\ell$, 和 $T$ 的单个闭式解析表达式。最终答案中不允许出现不等式。如果需要报告数值近似，请四舍五入到四位有效数字；否则，请提供精确的符号表达式。所有角度必须以弧度处理。", "solution": "根据题目要求，解决方案分为三个部分。\n\n### 第1部分：骨架链的小集条件不成立\n\n对于离散时间链 $\\{\\theta_{n\\Delta}\\}_{n\\ge 0}$，一个集合 $C$ 是小集，如果存在一个步数 $n \\in \\mathbb{N}$、一个常数 $\\varepsilon > 0$ 和一个非平凡测度 $\\nu$，使得 $n$ 步转移核 $P^n(\\theta, \\cdot)$ 对所有初始状态 $\\theta \\in C=S^1$ 和所有可测集 $A \\subseteq S^1$ 满足 $P^n(\\theta, A) \\ge \\varepsilon \\nu(A)$。该条件意味着，对于所有 $\\theta \\in S^1$，核 $P^n(\\theta, \\cdot)$ 必须有一个关于 $\\nu$ 的绝对连续分量，并且该分量被一致地下界。\n\n我们来分析该过程的路径。在跳跃之间，状态按 $\\theta_t = (\\theta_0 + \\omega t) \\pmod{2\\pi}$ 确定性地演化。当过程处于弧 $I = [0, \\ell]$ 中时，禁止跳跃，因为对 $\\theta \\in I$，$\\lambda(\\theta) = 0$。\n\n问题指定采样周期为 $\\Delta \\in (0, \\ell/\\omega)$。这意味着以速度 $\\omega$ 穿过长度为 $\\ell$ 的“安全”弧 $I$ 所需的时间 $t_I = \\ell/\\omega$ 大于采样周期 $\\Delta$。\n\n考虑任意固定的步数 $n \\in \\mathbb{N}$。我们可以选择一个初始状态 $\\theta_0$，使得轨迹 $\\theta_t = (\\theta_0 + \\omega t) \\pmod{2\\pi}$ 在整个时间区间 $t \\in [0, n\\Delta]$ 内完全保持在安全弧 $I$ 中。如果经过的总弧长 $\\omega n \\Delta$ 小于 $\\ell$，这是可能的。我们可以选择足够大的 $n$，使得 $\\omega n \\Delta$ 可能大于 $\\ell$。然而，我们总能找到一些起始位置，使得 $n$ 步的路径停留在 $I$ 中。例如，选择初始状态 $\\theta_0=0$。轨迹为 $\\theta_t = \\omega t \\pmod{2\\pi}$。如果我们选择的 $n$ 使得 $n\\Delta \\le \\ell/\\omega$，则对于 $t \\in [0, n\\Delta]$，路径 $\\theta_t$ 包含在 $[0, n\\omega\\Delta] \\subset I$ 中。对于任何 $n$，我们都可以找到一个起始点 $\\theta_0$，例如，对于某个小的 $\\delta>0$，$\\theta_0 \\in [0, \\delta]$，使得对于 $t\\in [0, n\\Delta]$，路径 $(\\theta_0+\\omega t) \\pmod{2\\pi}$ 保持在 $I$ 中。\n\n对于任何这样的初始状态 $\\theta_0$，对所有 $t \\in [0, n\\Delta]$，跳跃速率 $\\lambda(\\theta_t)$ 均为零。在此期间发生跳跃的概率为零。因此，演化是纯粹确定性的。在时间 $n\\Delta$ 的状态恰好是 $(\\theta_0 + n\\omega\\Delta) \\pmod{2\\pi}$。对于这个 $\\theta_0$ 的 $n$ 步转移核是一个狄拉克δ测度：\n$$P^n(\\theta_0, A) = \\delta_{(\\theta_0 + n\\omega\\Delta)\\pmod{2\\pi}}(A)$$\n该核没有绝对连续分量。\n\n现在，为寻求矛盾，假设 $S^1$ 是一个小集。那么存在 $n$, $\\varepsilon>0$ 和 $\\nu \\neq 0$，使得对所有 $\\theta \\in S^1$ 都有 $P^n(\\theta, A) \\ge \\varepsilon \\nu(A)$。我们从演化在 $n$ 步内是确定性的那些状态区间中，选择两个不同的初始状态 $\\theta_a$ 和 $\\theta_b$。那么我们有：\n$$P^n(\\theta_a, \\cdot) = \\delta_{(\\theta_a + n\\omega\\Delta)\\pmod{2\\pi}}(\\cdot)$$\n$$P^n(\\theta_b, \\cdot) = \\delta_{(\\theta_b + n\\omega\\Delta)\\pmod{2\\pi}}(\\cdot)$$\n次控制条件必须对两者都成立：\n$$\\delta_{(\\theta_a + n\\omega\\Delta)\\pmod{2\\pi}}(A) \\ge \\varepsilon \\nu(A)$$\n$$\\delta_{(\\theta_b + n\\omega\\Delta)\\pmod{2\\pi}}(A) \\ge \\varepsilon \\nu(A)$$\n第一个不等式意味着测度 $\\nu$ 必须关于狄拉克测度 $\\delta_{(\\theta_a + n\\omega\\Delta)\\pmod{2\\pi}}$ 是绝对连续的。这意味着 $\\nu$ 只能在点 $(\\theta_a + n\\omega\\Delta)\\pmod{2\\pi}$ 上有质量。第二个不等式意味着 $\\nu$ 只能在点 $(\\theta_b + n\\omega\\Delta)\\pmod{2\\pi}$ 上有质量。由于 $\\theta_a \\neq \\theta_b$，这两个点是不同的。一个测度不能集中在两个不同的单点上。$\\nu$ 满足这两个条件的唯一方式是 $\\nu$ 为零测度，但这被小集的定义所排除。\n\n因此，对于任何固定的 $n$，某些初始状态的确定性轨迹的持续存在，使得不可能找到一个单一的非平凡测度 $\\nu$ 来对所有 $\\theta \\in S^1$ 一致地次控制核 $P^n(\\theta, \\cdot)$。因此，$S^1$ 不是骨架链的小集。\n\n### 第2部分：连续时间过程的 Petite 集条件\n\n对于连续时间过程，一个集合 $C$ 是 petite 集，如果对于一个合适的在 $\\mathbb{R}_+$ 上的平均概率测度 $a$，平均核 $\\int_0^\\infty a(\\mathrm{d}t)P_t(\\theta, \\cdot)$ 对于所有 $\\theta \\in C$ 都被 $\\varepsilon\\nu(\\cdot)$ 次控制。这里我们使用 $a(\\mathrm{d}t) = \\frac{1}{T}\\mathbf{1}_{[0, T]}(t)\\mathrm{d}t$，其中 $T > \\ell/\\omega$。\n\n从任何 $\\theta_0 \\in S^1$ 开始的确定性轨迹必须在至多 $\\ell/\\omega$ 的时间内进入跳跃区域 $S^1 \\setminus I$。令 $t_0=\\ell/\\omega$。对任何 $\\theta_0$，首次进入 $S^1 \\setminus I$ 的时间为 $\\tau_{S^1\\setminus I}(\\theta_0) \\le t_0$。\n\n对于任何时间 $t > t_0$，对于 $s \\in [0, t]$ 的路径 $(\\theta_0 + \\omega s) \\pmod{2\\pi}$ 必须在 $S^1 \\setminus I$ 中停留了正的时间，其中跳跃速率为 $\\lambda_0 > 0$。这意味着对于任何 $t > t_0$ 和任何 $\\theta_0$，到时间 $t$ 至少发生一次跳跃的概率是严格为正的。\n\n当跳跃发生时，过程的状态被重置为一个从测度 $\\mu$ 中抽样得到的新随机位置。由于 $\\mu$ 相对于勒贝格测度具有一个严格为正且连续的密度 $m(\\theta)$，一次跳跃在状态的概率分布中引入了一个绝对连续分量。\n\n平均核为 $K_T(\\theta_0, A) = \\frac{1}{T}\\int_0^T P_t(\\theta_0, A)\\,\\mathrm{d}t$。\n对于任何 $t>0$，转移核可以分解为\n$$P_t(\\theta_0, A) = P_t^{\\text{no jump}}(\\theta_0, A) + P_t^{\\ge 1 \\text{ jump}}(\\theta_0, A)$$\n其中第一项对应于没有跳跃的路径（因此是一个狄拉克测度），第二项对应于至少有一次跳跃的路径。第二项相对于 $\\mu$（以及勒贝格测度）是绝对连续的，因为第一次跳跃根据 $\\mu$ 将位置随机化。\n\n通过在时间区间 $[0, T]$ 上平均，我们正在对这些分量进行积分。虽然对于任何固定的 $t \\le t_0$，对于某些 $\\theta_0$ 可能有 $P_t^{\\ge 1 \\text{ jump}}(\\theta_0, \\cdot) = 0$，但条件 $T > t_0 = \\ell/\\omega$ 确保了积分域 $[0,T]$ 包含了对于*任何*起始位置 $\\theta_0$ 都可能发生跳跃的时间 $t$。积分 $\\int_{t_0}^T P_t^{\\ge 1 \\text{ jump}}(\\theta_0, A)\\,\\mathrm{d}t$ 是严格为正的，对于任何满足 $\\mu(A)>0$ 的集合 $A$。\n\n因此，平均核 $K_T(\\theta_0, \\cdot)$ 对每个 $\\theta_0 \\in S^1$ 都有一个绝对连续分量。状态空间 $S^1$ 的紧致性以及过程参数的连续性确保了该分量可以被一致地下界。因此，存在 $\\varepsilon(T) > 0$ 和一个测度 $\\nu$（这里，题目要求我们使用 $\\nu = \\mu$），使得对所有 $\\theta_0 \\in S^1$ 都有 $K_T(\\theta_0, A) \\ge \\varepsilon(T)\\mu(A)$。这证实了 $S^1$ 是一个 petite 集。\n\n### 第3部分：次控制常数 $\\varepsilon(T)$ 的推导\n\n我们希望找到最大的 $\\varepsilon(T)$，使得 $\\frac{1}{T}\\int_0^T P_t(\\theta_0, A)\\,\\mathrm{d}t \\ge \\varepsilon(T)\\mu(A)$ 对所有 $\\theta_0 \\in S^1$ 和所有可测集 $A \\subseteq S^1$ 都成立。这个值 $\\varepsilon(T)$ 代表了以 $\\mu$ 为参考测度的平均核的绝对连续部分的最小权重。\n\n再生过程理论中的一个标准结果指出，$\\varepsilon(T)$ 的一个有效选择是最小再生概率的时间平均值。在此背景下，再生对应于一次跳跃事件，该事件根据 $\\mu$ 重置过程状态。到时间 $t$ 发生再生的最小概率由 $1 - \\sup_{\\theta_0 \\in S^1} \\mathbb{P}(\\tau_1 > t | \\theta_0)$ 给出，其中 $\\tau_1$ 是第一次跳跃的时间。\n\n从 $\\theta_0$ 开始，直到时间 $t$ 没有发生跳跃的概率是\n$$\\mathbb{P}(\\tau_1 > t | \\theta_0) = N(t; \\theta_0) = \\exp\\left(-\\int_0^t \\lambda((\\theta_0+\\omega s)\\pmod{2\\pi})\\,\\mathrm{d}s\\right)$$\n$$= \\exp\\left(-\\lambda_0 \\int_0^t \\mathbf{1}_{S^1\\setminus I}((\\theta_0+\\omega s)\\pmod{2\\pi})\\,\\mathrm{d}s\\right)$$\n为了找到 $\\sup_{\\theta_0} N(t; \\theta_0)$，我们必须找到一个初始状态 $\\theta_0$，使得在区间 $[0,t]$ 内在跳跃区域 $S^1 \\setminus I$ 中花费的时间最短。这通过最大化在安全区域 $I = [0, \\ell]$ 中花费的时间来实现。\n\n穿过安全弧 $I$ 的时间是 $t_0=\\ell/\\omega$。穿过整个圆周的时间是 $T_{cyc} = 2\\pi/\\omega$。问题要求一个单一的闭式解析表达式，这表明我们应该避免由多次旋转引起的复杂性。因此，我们做出合理的假设，即时间范围 $T$ 在一个完整的旋转周期内，即 $T \\le 2\\pi/\\omega$。\n\n在假设 $T \\in (\\ell/\\omega, 2\\pi/\\omega]$ 下，我们分析当 $t \\in [0, T]$ 时 $\\sup_{\\theta_0} N(t; \\theta_0)$ 的值。\n-   对于 $t \\in [0, t_0]$，其中 $t_0=\\ell/\\omega$：我们可以选择 $\\theta_0 = 0$。路径 $\\theta_s = \\omega s$ 保持在 $[0, \\omega t] \\subseteq [0, \\ell]$ 内。在跳跃区域的时间为 0。因此，$\\sup_{\\theta_0} N(t;\\theta_0) = N(t; 0) = \\exp(0) = 1$。\n-   对于 $t \\in (t_0, T]$：任何持续时间为 $t$ 的路径都必须穿过长度为 $\\omega t > \\ell$ 的弧。路径不可能完全保留在 $I$ 中。在跳跃区域停留的最短时间，是通过在安全区域中花费最长可能时间 $t_0=\\ell/\\omega$ 的路径实现的。这对应于从 $\\theta_0=0$ 开始的轨迹，如 $\\theta_s = \\omega s$。在 $S^1 \\setminus I$ 中花费的时间是 $t - t_0$。因此，$\\sup_{\\theta_0} N(t;\\theta_0) = \\exp(-\\lambda_0(t-t_0))$。\n\n次控制常数是最小跳跃概率的时间平均值：\n$$\\varepsilon(T) = \\frac{1}{T} \\int_0^T \\left(1 - \\sup_{\\theta_0} N(t; \\theta_0)\\right) \\mathrm{d}t$$\n我们根据 $t$ 的两种情况来拆分积分：\n$$\\varepsilon(T) = \\frac{1}{T} \\left( \\int_0^{t_0} (1-1)\\,\\mathrm{d}t + \\int_{t_0}^T (1 - \\exp(-\\lambda_0(t-t_0)))\\,\\mathrm{d}t \\right)$$\n第一个积分为 0。我们计算第二个积分：\n$$\\int_{t_0}^T (1 - \\exp(-\\lambda_0 t + \\lambda_0 t_0))\\,\\mathrm{d}t = \\left[ t - \\frac{\\exp(-\\lambda_0 t + \\lambda_0 t_0)}{-\\lambda_0} \\right]_{t_0}^T$$\n$$= \\left( T + \\frac{1}{\\lambda_0}\\exp(-\\lambda_0(T-t_0)) \\right) - \\left( t_0 + \\frac{1}{\\lambda_0}\\exp(-\\lambda_0(t_0-t_0)) \\right)$$\n$$= T - t_0 + \\frac{1}{\\lambda_0}\\exp(-\\lambda_0(T-t_0)) - \\frac{1}{\\lambda_0}$$\n$$= (T - t_0) - \\frac{1}{\\lambda_0}\\left(1 - \\exp(-\\lambda_0(T-t_0))\\right)$$\n代入 $t_0=\\ell/\\omega$ 并除以 $T$，我们得到 $\\varepsilon(T)$ 的最终表达式：\n$$\\varepsilon(T) = \\frac{1}{T}\\left( (T - \\frac{\\ell}{\\omega}) - \\frac{1}{\\lambda_0}\\left(1 - \\exp\\left(-\\lambda_0\\left(T-\\frac{\\ell}{\\omega}\\right)\\right)\\right) \\right)$$\n$$= 1 - \\frac{\\ell}{\\omega T} - \\frac{1}{\\lambda_0 T}\\left(1 - \\exp\\left(-\\lambda_0\\left(T-\\frac{\\ell}{\\omega}\\right)\\right)\\right)$$\n这是在给定条件和假设 $T \\le 2\\pi/\\omega$ 下，最大保证下界 $\\varepsilon(T)$ 的精确解析表达式。第2部分也得到了构造性证明，因为对于 $T>\\ell/\\omega$，此 $\\varepsilon(T) > 0$，从而证明了 $S^1$ 是一个 petite 集。", "answer": "$$\n\\boxed{1 - \\frac{\\ell}{\\omega T} - \\frac{1}{\\lambda_0 T}\\left(1 - \\exp\\left(-\\lambda_0\\left(T-\\frac{\\ell}{\\omega}\\right)\\right)\\right)}\n$$", "id": "2978589"}, {"introduction": "哈里斯型定理优美地将由小巧集（petite set）刻画的局部混合行为与全局遍历性质（如常返性和收敛到不变测度）联系起来。然而，这种联系关键性地依赖于一个不可或缺的假设：不可约性，即过程有能力从任何起点最终到达状态空间的任何“合理”区域。本练习提出了一个经典的警示性反例，一个瞬时的马尔可夫链，它虽然拥有一个行为良好的小巧集，但却不是哈里斯常返的，因为一个确定性的漂移使其趋向无穷，导致该小巧集从某些起始点变得不可达。这有力地提醒我们，仅有局部混合性并不足以保证全局遍历性 [@problem_id:2978615]。", "problem": "考虑实数线上具有 Borel $\\sigma$-代数的离散时间马尔可夫链，定义如下\n$$\nX_{n+1} \\,=\\, X_n \\,+\\, 1 \\,+\\, \\xi_{n+1}, \\qquad n\\in\\mathbb{N}_0,\n$$\n其中 $\\{\\xi_n\\}_{n\\geq 1}$ 是独立同分布的随机变量，服从区间 $[-\\frac{1}{2}, \\frac{1}{2}]$ 上的均匀分布，且独立于 $X_0$。因此，转移核 $P(x,\\cdot)$ 具有一个勒贝格密度，其支撑集为区间 $[x+\\frac{1}{2}, x+\\frac{3}{2}]$。\n\n仅使用关于马尔可夫链、petite 集和 Harris 型定理的基本定义和事实：\n\n- 回顾：一个 Borel 集 $C$ 是 petite 集，如果存在一个非平凡的有限测度 $\\nu$ 和一个在 $\\mathbb{N}$ 上的概率分布 $a$，使得对于所有 Borel 集 $A$ 和所有 $x\\in C$，\n$$\n\\sum_{m=0}^{\\infty} a(m)\\,P^m(x,A) \\,\\geq\\, \\nu(A).\n$$\n- 回顾：一个 $\\psi$-不可约马尔可夫链是 Harris 常返的，如果对于每个满足 $\\psi(A)>0$ 的集合 $A$，从任意初始状态出发，链以概率 1 无穷次访问 $A$。正常返 Harris 常返还额外要求存在一个不变概率测度。\n\n任务：\n\n1. 对于 $\\mathbb{R}$ 上的一个 $\\psi$-不可约马尔可夫链，借助一个在紧集外无界的李雅普诺夫函数 $V:\\mathbb{R}\\to[1,\\infty)$，推导一个使其 Harris 常返性不成立的充分条件。假设存在一个有界集 $C$ 和一个常数 $\\varepsilon>0$ 使得\n$$\nPV(x) \\,-\\, V(x) \\,\\geq\\, \\varepsilon, \\qquad \\text{对所有 } x\\notin C,\n$$\n并且链在 $C$ 外的单步增量几乎必然被一个严格为正的常数从下方界定。解释为什么这些条件意味着链不可能是 Harris 常返的。\n\n2. 对于上述特定的链，确定一个明确的有界 Borel 集 $C\\subset\\mathbb{R}$，并通过展示一个整数 $m\\geq 1$、一个常数 $\\varepsilon>0$ 和一个概率测度 $\\nu$，使得\n$$\nP^m(x,A) \\,\\geq\\, \\varepsilon\\,\\nu(A)\n$$\n对所有 Borel 集 $A$ 和所有 $x\\in C$ 成立，来证明 $C$ 是一个 petite 集。\n\n3. 证明这个 petite 集 $C$ 从足够大的初始状态是不可达的，即存在 $R>0$ 使得对所有 $x\\geq R$，$C$ 的击中概率为零：\n$$\n\\mathbb{P}_x\\!\\left(\\tau_C  \\infty\\right) \\,=\\, 0, \\qquad \\tau_C := \\inf\\{n\\geq 0: X_n\\in C\\}.\n$$\n解释一个 petite 集的这种不可达性如何使 Harris 型遍历定理的结论失效。\n\n最后，计算击中概率\n$$\n\\mathbb{P}_{10}\\!\\left(\\tau_C  \\infty\\right)\n$$\n的精确值。将最终答案以单个实数形式给出。不需要四舍五入。", "solution": "本问题研究了 $\\mathbb{R}$ 上马尔可夫链的 Harris 常返性条件，并展示了一个关键条件——petite 集的可达性——失效的场景。解题过程按要求分为三个部分，最后进行一个最终计算。\n\n### 第一部分：Harris 常返性不成立的充分条件\n\n一个 $\\psi$-不可约马尔可夫链被定义为 Harris 常返的，如果对于每个满足 $\\psi(A)>0$ 的集合 $A$，从任意状态 $x$ 出发，链以概率 1 无穷次访问 $A$。也就是说，对于状态空间中的所有 $x$，$\\mathbb{P}_x(\\sum_{n=0}^{\\infty} \\mathbb{I}_{A}(X_n) = \\infty)=1$。其直接推论是，链必须以概率 1 至少访问一次 $A$，即 $\\mathbb{P}_x(\\tau_A  \\infty) = 1$，其中 $\\tau_A$ 是 $A$ 的首次击中时。Harris 常返性的一个必要弱条件是，链必须是“常返”的，即它不能是暂留的。如果链有正概率永不返回其起始区域，则称其为暂留的。\n\n问题为 $\\mathbb{R}$ 上的一个 $\\psi$-不可约链提供了两个条件：\n1. 存在一个有界集 $C$、一个常数 $\\varepsilon>0$ 和一个在紧集外无界的李雅普诺夫函数 $V:\\mathbb{R}\\to[1,\\infty)$，使得对于所有 $x\\notin C$，$PV(x) - V(x) \\geq \\varepsilon$。算子 $P$ 作用于函数的形式为 $PV(x) = \\mathbb{E}[V(X_{n+1})|X_n=x]$。这个条件意味着，平均而言，当链在集合 $C$ 之外时，李雅普诺夫函数的值会增加。这是一个经典的暂留判据。\n\n2. 链在 $C$ 之外的单步增量几乎必然被一个严格为正的常数从下方界定。我们将其形式化：存在一个常数 $\\delta>0$，使得对于任何 $x \\notin C$，增量 $X_{n+1}-X_n$ 满足 $\\mathbb{P}_x(X_1 - x \\ge \\delta) = 1$（或者一个类似的远离 $C$ 的条件，例如，如果 $C$ 以 0 为中心，则 $\\mathbb{P}_x(|X_1| - |x| \\ge \\delta) = 1$）。\n\n让我们关注第二个条件，因为它为 Harris 常返性的失效提供了更直接的论证。设 $C$ 为一个有界集。由于 $C$ 有界，对于足够大的 $M>0$，它被包含在某个区间 $[-M, M]$内。条件指出，对于 $x \\notin C$，增量被 $\\delta>0$ 从下方界定。考虑一个起始点 $x_0 > M$。那么 $x_0 \\notin C$。在时间 $n=1$ 时的状态是 $X_1 = x_0 + (X_1 - x_0)$。根据我们的假设，$X_1 - x_0 \\ge \\delta$ 几乎必然成立。因此，$X_1 \\ge x_0 + \\delta > M + \\delta > M$。通过归纳法，如果 $X_n > M$，则 $X_n \\notin C$。下一个状态 $X_{n+1}$ 满足 $X_{n+1} \\geq X_n + \\delta > M + \\delta > M$。因此，如果链从任何状态 $X_0 = x > M$ 开始，那么所有后续状态 $X_n$（对于 $n \\ge 1$）几乎必然大于 $M$。链确定性地移向 $+\\infty$。对称地，可能存在一个区域 $x  -M$，链从那里移向 $-\\infty$。\n\n现在，考虑 $\\mathbb{R}$ 中的任意有界 Borel 集 $A$。我们假设 $A$ 满足 $\\psi(A)>0$。由于 $A$ 是有界的，我们可以找到一个值 $x_A$ 使得 $A \\subset (-\\infty, x_A)$。如果我们选择一个初始状态 $X_0=x > \\max(M, x_A)$，那么如上所示，$X_n \\geq x + n\\delta$ 对所有 $n \\geq 1$ 成立。所有后续状态将大于 $x$，因此大于 $A$ 中的任何值。这意味着链永远不会访问集合 $A$。击中时 $\\tau_A = \\inf\\{n \\ge 0 : X_n \\in A\\}$ 是无穷大。所以，$\\mathbb{P}_x(\\tau_A  \\infty) = 0$。\n\n这与 Harris 常返链的定义相矛盾。如果链是 Harris 常返的，它必须从任何起始点 $x$ 出发，以概率 1 无穷次地访问集合 $A$。我们已经证明，对于一个适当选择的起始点 $x$，它根本不会访问 $A$。因此，满足此增量条件的链不可能是 Harris 常返的。李雅普诺夫漂移条件指向相同的结论（暂留性），但基于严格为正增量的论证对于这个特定设置更为直接和确定。\n\n### 第二部分：证明一个集合是 Petite 集\n\n马尔可夫链由 $X_{n+1} = X_n + 1 + \\xi_{n+1}$ 给出，其中 $\\xi_{n+1} \\sim U[-\\frac{1}{2}, \\frac{1}{2}]$。给定 $X_n=x$ 时，下一个状态 $X_{n+1}$ 在区间 $[x+1-\\frac{1}{2}, x+1+\\frac{1}{2}] = [x+\\frac{1}{2}, x+\\frac{3}{2}]$ 上均匀分布。转移核 $P(x, \\cdot)$ 关于勒贝格测度 $\\lambda$ 的密度 $p(x,y)$ 为：\n$$ p(x,y) = \\begin{cases} 1  \\text{如果 } y \\in [x+\\frac{1}{2}, x+\\frac{3}{2}] \\\\ 0  \\text{其他情况} \\end{cases} $$\n一个集合 $C$ 是 petite 集，如果（根据给出的简化定义）存在一个整数 $m \\ge 1$、一个常数 $\\varepsilon > 0$ 和一个概率测度 $\\nu$，使得对所有 $x \\in C$ 和所有 Borel 集 $A$：\n$$ P^m(x,A) \\ge \\varepsilon \\nu(A) $$\n这是 $m$-小集 (small set) 的标准定义，任何小集都是 petite 集。我们需要找到 $C$、$m$、$\\varepsilon$ 和 $\\nu$。\n\n我们尝试 $m=1$。条件变为 $P(x,A) \\ge \\varepsilon \\nu(A)$。这要求对于所有 $x \\in C$，转移测度 $P(x,\\cdot)$ 的支撑集有一个公共的重叠区域。$P(x,\\cdot)$ 的支撑集是 $[x+\\frac{1}{2}, x+\\frac{3}{2}]$。我们选择一个有界 Borel 集 $C$。为了使所有 $x \\in C$ 的支撑集都重叠，它们的交集必须非空。设 $C = [c_1, c_2]$。对于 $x \\in C$ 的所有支撑集的交集为：\n$$ I = \\bigcap_{x \\in [c_1, c_2]} [x+\\frac{1}{2}, x+\\frac{3}{2}] = [\\sup_{x \\in [c_1, c_2]}(x+\\frac{1}{2}), \\inf_{x \\in [c_1, c_2]}(x+\\frac{3}{2})] = [c_2+\\frac{1}{2}, c_1+\\frac{3}{2}] $$\n为了使该区间非空，我们需要 $c_1+\\frac{3}{2} \\ge c_2+\\frac{1}{2}$，化简为 $c_2 - c_1 \\le 1$。\n我们选择 $C=[0, \\frac{1}{2}]$。这个区间的长度是 $\\frac{1}{2} \\le 1$。对于这个选择的 $C$，支撑集的交集是 $I = [\\frac{1}{2}+\\frac{1}{2}, 0+\\frac{3}{2}] = [1, \\frac{3}{2}]$。这个区间的长度为 $\\frac{1}{2}$。\n\n对于任意 $x \\in C = [0, \\frac{1}{2}]$，密度 $p(x,y)$ 对所有 $y \\in [1, \\frac{3}{2}]$ 都等于 1，因为对于所有 $x \\in [0, \\frac{1}{2}]$，都有 $[1, \\frac{3}{2}] \\subset [x+\\frac{1}{2}, x+\\frac{3}{2}]$。\n\n我们定义概率测度 $\\nu$ 为区间 $I=[1, \\frac{3}{2}]$ 上的均匀分布。$\\nu$ 的密度，我们称之为 $q(y)$，是：\n$$ q(y) = \\begin{cases} \\frac{1}{\\lambda([1, 3/2])} = \\frac{1}{1/2} = 2  \\text{如果 } y \\in [1, \\frac{3}{2}] \\\\ 0  \\text{其他情况} \\end{cases} $$\n小化条件 (minorization condition) $P(x,A) \\ge \\varepsilon\\nu(A)$ 等价于关于密度的条件 $p(x,y) \\ge \\varepsilon q(y)$ 对几乎所有 $y$ 成立。\n对于 $x \\in C=[0, \\frac{1}{2}]$ 和 $y \\in [1, \\frac{3}{2}]$，我们有 $p(x,y)=1$ 和 $q(y)=2$。不等式变为 $1 \\ge \\varepsilon \\cdot 2$。\n我们可以通过选择任何 $\\varepsilon \\le \\frac{1}{2}$ 来满足此条件。我们选择 $\\varepsilon = \\frac{1}{2}$。\n\n因此，对于集合 $C = [0, \\frac{1}{2}]$，我们找到了：\n- 一个整数 $m=1$，\n- 一个常数 $\\varepsilon = \\frac{1}{2} > 0$，\n- 一个概率测度 $\\nu = U([1, \\frac{3}{2}])$，\n使得 $P^1(x,A) \\ge \\frac{1}{2} \\nu(A)$ 对所有 $x \\in C$ 和所有 Borel 集 $A$ 成立。这证明了 $C=[0, \\frac{1}{2}]$ 是一个 petite 集。\n\n### 第三部分：可达性的失效及其影响\n\n我们需要证明存在 $R>0$ 使得对于所有 $x \\ge R$，击中概率 $\\mathbb{P}_x(\\tau_C  \\infty)$ 为零，其中 $C=[0, \\frac{1}{2}]$。\n链的动态是 $X_{n+1} = X_n + 1 + \\xi_{n+1}$。由于 $\\xi_{n+1} \\in [-\\frac{1}{2}, \\frac{1}{2}]$，单步增量 $X_{n+1} - X_n = 1 + \\xi_{n+1}$ 总是在区间 $[1-\\frac{1}{2}, 1+\\frac{1}{2}] = [\\frac{1}{2}, \\frac{3}{2}]$ 内。\n这意味着每一步，过程几乎必然增加至少 $\\frac{1}{2}$：$X_{n+1} \\ge X_n + \\frac{1}{2}$。\n\n集合 $C=[0, \\frac{1}{2}]$ 的最大值为 $\\sup C = \\frac{1}{2}$。\n我们考虑一个初始状态 $X_0 = x > \\frac{1}{2}$。由于 $x \\notin C$，首次击中时 $\\tau_C$ 如果有限，则必须大于 0。在时间 1 的状态是 $X_1 \\ge X_0 + \\frac{1}{2} > \\frac{1}{2} + \\frac{1}{2} = 1$。\n归纳地，假设 $X_n > \\frac{1}{2}$。那么 $X_{n+1} \\ge X_n + \\frac{1}{2} > \\frac{1}{2} + \\frac{1}{2} = 1$。\n这表明如果 $X_0=x > \\frac{1}{2}$，那么所有后续状态 $X_n$（对于 $n \\ge 1$）都严格大于 1，因此不在 $C=[0, \\frac{1}{2}]$ 中。初始状态 $X_0=x$ 也不在 $C$ 中。\n因此，对于任何 $x > \\frac{1}{2}$，从 $x$ 开始的链永远不会进入集合 $C$。时间集合 $\\{n \\ge 0 : X_n \\in C\\}$ 是空的，这意味着其下确界 $\\tau_C$ 是 $\\infty$。\n因此，对于任何 $x > \\frac{1}{2}$，我们有 $\\mathbb{P}_x(\\tau_C  \\infty) = \\mathbb{P}_x(\\infty  \\infty) = 0$。\n我们可以选择任何 $R > \\frac{1}{2}$。例如，令 $R=1$。对于所有 $x \\ge 1$，我们有 $x > \\frac{1}{2}$，结论 $\\mathbb{P}_x(\\tau_C  \\infty) = 0$ 成立。\n\n这种可达性的失效对 Harris 型遍历定理有至关重要的影响。这些定理在 petite 集的存在性与马尔可夫链的常返性/遍历性之间建立了联系。例如，一个基本结果指出，一个 $\\psi$-不可约链是 Harris 常返的，当且仅当每个 petite 集都是一个“H-集”，意味着从每个起始点都能以概率 1 击中它。更一般地，像 Harris 遍历定理（将正常返 Harris 常返性与唯一不变概率测度联系起来）这样的强力定理的结论，都依赖于链是 Harris 常返的这一假设。\n\n我们的链是 $\\lambda$-不可约的，并且拥有一个 petite 集 $C=[0, \\frac{1}{2}]$。然而，我们已经证明这个集合从状态 $x > \\frac{1}{2}$ 是不可达的。可达性的失效，即对某些 $x$ 有 $\\mathbb{P}_x(\\tau_C  \\infty) = 0$，直接意味着链不可能是 Harris 常返的。这个例子表明，petite 集的存在本身并不足以保证 Harris 常返性。常返性的全局属性不仅需要由 petite 集所封装的局部混合行为，还需要链的全局动态确保它实际上可以从其状态空间中的任何地方到达这个集合。\n\n### 最终计算\n\n我们需要计算击中概率 $\\mathbb{P}_{10}(\\tau_C  \\infty)$ 的精确值，其中 $C=[0, \\frac{1}{2}]$。\n初始状态是 $X_0 = 10$。\n在第三部分中，我们确定了对于任何初始状态 $x > \\frac{1}{2}$，击中集合 $C$ 的概率为零。\n由于初始状态是 $X_0 = 10$，且 $10 > \\frac{1}{2}$，这个结果直接适用。链从 $X_0 = 10$ 开始。下一个状态是 $X_1 \\ge X_0 + \\frac{1}{2} = 10.5$。通过归纳法，$X_n \\ge 10 + \\frac{n}{2}$ 对所有 $n \\ge 0$ 成立。由于 $10 > \\frac{1}{2}$，所有状态 $X_n$ 都将保持大于 $\\frac{1}{2}$，因此链永远不会进入 $C=[0, \\frac{1}{2}]$。\n因此，$\\tau_C = \\infty$ 几乎必然成立。事件 $\\{\\tau_C  \\infty\\}$ 的概率是 0。\n$$ \\mathbb{P}_{10}(\\tau_C  \\infty) = 0 $$", "answer": "$$\\boxed{0}$$", "id": "2978615"}]}