{"hands_on_practices": [{"introduction": "几何布朗运动 (GBM) 是金融数学中的一个基石模型，但我们通常更关心的是对其进行某种变换后得到的过程。一个核心问题是，何种变换能使 GBM 过程转变为一个鞅？因为鞅在衍生品定价和测度变换中扮演着至关重要的角色。本练习将伊藤公式的强大功能与局部鞅的定义（即漂移项为零的过程）相结合，旨在训练你识别这些重要的变换。掌握这一技能将使你能够分析相关随机过程的鞅性质，这是量化金融领域的一项基本功 [@problem_id:3001451]。", "problem": "设 $\\{W_{t}\\}_{t \\geq 0}$ 是一个标准布朗运动，并考虑一个几何布朗运动 (GBM) $S_{t}$，它被定义为随机微分方程 (SDE) 的强解\n$$\ndS_{t} = \\mu S_{t}\\, dt + \\sigma S_{t}\\, dW_{t}, \\quad S_{0} > 0,\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma > 0$ 是常数。对于一个固定的 $p \\in \\mathbb{R}$，定义过程 $X_{t} := S_{t}^{p}$。\n\n从 $S_{t}$ 的随机微分方程出发，使用伊藤公式（Itô's formula），推导 $X_{t}$ 在半鞅分解 $dX_{t} = \\text{(drift)}\\, dt + \\text{(diffusion)}\\, dW_{t}$ 中的漂移系数。然后，确定使 $X_{t}$ 成为一个局部鞅的 $p$ 的值。\n\n请将您的最终答案表示为漂移系数关于 $\\mu$、$\\sigma$、$p$ 和 $S_{t}$ 的封闭形式解析表达式，并给出所有使 $X_{t}$ 成为局部鞅的 $p$ 值的集合。无需四舍五入，不涉及单位。", "solution": "问题陈述已经过验证，被认为是有效的。这是一个在随机微分方程领域内提法得当、有科学依据的问题。\n\n该问题要求两个结果：过程 $X_{t} := S_{t}^{p}$ 的漂移系数，以及使 $X_{t}$ 成为局部鞅的常数 $p$ 的值。我们将使用伊藤公式按顺序解决这些问题。\n\n过程 $S_{t}$ 服从几何布朗运动 (GBM)，由以下随机微分方程 (SDE) 描述：\n$$\ndS_{t} = \\mu S_{t}\\, dt + \\sigma S_{t}\\, dW_{t}\n$$\n其中 $\\{W_{t}\\}_{t \\geq 0}$ 是标准布朗运动，$S_{0} > 0$，$\\mu \\in \\mathbb{R}$ 且 $\\sigma > 0$。\n\n我们关心的是过程 $X_{t} = S_{t}^{p}$。这可以表示为 $S_{t}$ 的函数，即 $X_{t} = f(S_{t})$，其中 $f(s) = s^{p}$。为了找到 $X_{t}$ 的随机微分方程，我们对一个伊藤过程的函数应用伊藤公式。对于一个过程 $Y_{t} = f(Z_{t})$，其中 $dZ_{t} = a_{t} dt + b_{t} dW_{t}$，伊藤公式表述为：\n$$\ndY_{t} = f'(Z_{t}) dZ_{t} + \\frac{1}{2} f''(Z_{t}) (dZ_{t})^{2}\n$$\n在我们的情况下，$Z_{t} = S_{t}$，所以 $a_{t} = \\mu S_{t}$ 且 $b_{t} = \\sigma S_{t}$。\n首先，我们计算 $f(s) = s^{p}$ 关于 $s$ 的必要导数：\n$$\nf'(s) = \\frac{df}{ds} = p s^{p-1}\n$$\n$$\nf''(s) = \\frac{d^{2}f}{ds^{2}} = p(p-1) s^{p-2}\n$$\n接下来，我们计算二次变差项 $(dS_{t})^{2}$。使用伊藤乘法规则 ($dt \\cdot dt = 0$, $dt \\cdot dW_{t} = 0$, $dW_{t} \\cdot dW_{t} = dt$)：\n$$\n(dS_{t})^{2} = (\\mu S_{t}\\, dt + \\sigma S_{t}\\, dW_{t})^{2} = (\\mu S_{t})^{2} (dt)^{2} + 2 \\mu \\sigma S_{t}^{2} dt\\,dW_{t} + (\\sigma S_{t})^{2} (dW_{t})^{2} = \\sigma^{2} S_{t}^{2}\\, dt\n$$\n现在，我们将这些部分代入 $dX_{t} = df(S_{t})$ 的伊藤公式中：\n$$\ndX_{t} = f'(S_{t}) dS_{t} + \\frac{1}{2} f''(S_{t}) (dS_{t})^{2}\n$$\n$$\ndX_{t} = (p S_{t}^{p-1}) (\\mu S_{t}\\, dt + \\sigma S_{t}\\, dW_{t}) + \\frac{1}{2} (p(p-1) S_{t}^{p-2}) (\\sigma^{2} S_{t}^{2}\\, dt)\n$$\n我们展开各项，并合并 $dt$ (漂移) 和 $dW_{t}$ (扩散) 的部分。\n$$\ndX_{t} = (p S_{t}^{p-1})(\\mu S_{t})\\, dt + (p S_{t}^{p-1})(\\sigma S_{t})\\, dW_{t} + \\frac{1}{2} p(p-1) \\sigma^{2} S_{t}^{p-2} S_{t}^{2}\\, dt\n$$\n$$\ndX_{t} = p \\mu S_{t}^{p}\\, dt + p \\sigma S_{t}^{p}\\, dW_{t} + \\frac{1}{2} p(p-1) \\sigma^{2} S_{t}^{p}\\, dt\n$$\n合并含有 $dt$ 的项：\n$$\ndX_{t} = \\left( p \\mu + \\frac{1}{2} p(p-1) \\sigma^{2} \\right) S_{t}^{p}\\, dt + p \\sigma S_{t}^{p}\\, dW_{t}\n$$\n这是 $X_{t}$ 的半鞅分解。漂移系数是乘以 $dt$ 的项。\n\n因此，$X_{t}$ 的漂移系数是：\n$$\n\\left( p \\mu + \\frac{1}{2} p(p-1) \\sigma^{2} \\right) S_{t}^{p}\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须确定使过程 $X_{t}$ 成为局部鞅的 $p$ 的值。一个伊藤过程是局部鞅，当且仅当其漂移系数为零。因此，我们必须有：\n$$\n\\left( p \\mu + \\frac{1}{2} p(p-1) \\sigma^{2} \\right) S_{t}^{p} = 0\n$$\n几何布朗运动随机微分方程的解是 $S_{t} = S_{0} \\exp\\left((\\mu - \\frac{1}{2}\\sigma^{2})t + \\sigma W_{t}\\right)$。由于初始条件是 $S_{0} > 0$ 并且指数函数总是正的，因此对于所有 $t \\geq 0$ 都有 $S_{t} > 0$。因此，对于任何有限的 $p \\in \\mathbb{R}$，$S_{t}^{p}$ 都是非零的。所以，要使漂移项为零，括号中的项必须为零：\n$$\np \\mu + \\frac{1}{2} p(p-1) \\sigma^{2} = 0\n$$\n我们可以从这个方程中提出因子 $p$：\n$$\np \\left( \\mu + \\frac{1}{2} (p-1) \\sigma^{2} \\right) = 0\n$$\n此方程成立的条件是 $p=0$ 或者括号中的项为零。这给出了 $p$ 的两个可能解。\n\n情况1：$p=0$。\n如果 $p=0$，条件得到满足。在这种情况下，$X_{t} = S_{t}^{0} = 1$ 对所有 $t$ 成立，这是一个常数过程。常数过程的漂移为零，是一个鞅（因此也是一个局部鞅）。\n\n情况2：$\\mu + \\frac{1}{2} (p-1) \\sigma^{2} = 0$。\n我们求解 $p$。由于给定 $\\sigma > 0$，我们知道 $\\sigma^{2} > 0$。\n$$\n\\frac{1}{2} (p-1) \\sigma^{2} = -\\mu\n$$\n$$\n(p-1) \\sigma^{2} = -2\\mu\n$$\n$$\np-1 = -\\frac{2\\mu}{\\sigma^{2}}\n$$\n$$\np = 1 - \\frac{2\\mu}{\\sigma^{2}}\n$$\n这提供了 $p$ 的第二个值。\n\n总结来说，过程 $X_{t} = S_{t}^{p}$ 在两个特定的 $p$ 值时是局部鞅：$p=0$ 和 $p=1 - \\frac{2\\mu}{\\sigma^{2}}$。\n\n最终答案包括推导出的漂移系数和这两个 $p$ 值的集合。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\left( p\\mu + \\frac{1}{2}p(p-1)\\sigma^{2} \\right) S_{t}^{p}  \\left\\{ 0, 1 - \\frac{2\\mu}{\\sigma^{2}} \\right\\} \\end{pmatrix}}\n$$", "id": "3001451"}, {"introduction": "一旦我们识别出一个鞅，就可以运用鞅论中的强大工具。可选停止定理 (Optional Stopping Theorem) 是其中之一，它将鞅在某个随机“停时”的期望值与其初始值联系起来。本练习将引导你使用一个从 GBM 导出的关键鞅，构造一个有效的有界停时，并应用可选停止定理来计算一个否则难以处理的期望值。通过这个练习，你将亲身体验随机分析中最重要定理之一的应用，并了解如何利用抽象理论获得具体的计算结果 [@problem_id:3001441]。", "problem": "考虑一个随机微分方程(SDE)，用于描述在一个带滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t \\geq 0},\\mathbb{P})$ 上，由标准布朗运动 $W_{t}$ 驱动的严格为正的过程 $S_{t}$：\n$$\n\\mathrm{d}S_{t} \\;=\\; \\mu\\,S_{t}\\,\\mathrm{d}t \\;+\\; \\sigma\\,S_{t}\\,\\mathrm{d}W_{t}, \\quad S_{0} > 0,\n$$\n其中常数 $\\mu \\in \\mathbb{R}$ 且 $\\sigma > 0$。从第一性原理（伊藤微积分和布朗运动的性质）出发，推导 $S_{t}$ 的显式形式，并用它来证明过程\n$$\nM_{t} \\;=\\; S_{t}\\,\\exp(-\\mu t)\n$$\n是一个鞅。接下来，构造一个非平凡有界停时 $\\tau$，使得可选停止定理(OST)能以一种科学合理且不依赖于首达时间的方式，适用于该鞅 $M_{t}$。具体来说，通过在时间 $t=0$ 引入一个独立的、在区间 $[0,T]$ 上均匀分布的随机变量 $U$（其中 $T>0$ 为固定值），来对滤流进行初始扩张，并定义 $\\tau := U$。证明 $\\tau$ 是关于扩张后滤流的有界停时，并且 $M_{t}$ 在这次扩张后仍然是一个鞅。最后，假设 $\\mu \\neq 0$，计算 $\\mathbb{E}[S_{\\tau}]$ 的闭式解析表达式，用 $S_{0}$、$\\mu$ 和 $T$ 表示。你的最终答案必须是单一的闭式表达式。不要提供任何数值近似。", "solution": "该问题要求推导几何布朗运动(GBM)随机微分方程(SDE)的显式解，证明一个相关过程是鞅，构造一个特定的有界停时，并计算一个涉及此停时的期望值。我们将从第一性原理出发，按顺序解决每个部分。\n\n首先，我们推导由以下SDE所支配的过程 $S_t$ 的显式解：\n$$\n\\mathrm{d}S_{t} \\;=\\; \\mu\\,S_{t}\\,\\mathrm{d}t \\;+\\; \\sigma\\,S_{t}\\,\\mathrm{d}W_{t}, \\quad S_{0} > 0\n$$\n我们考虑过程 $Y_t = f(S_t)$，其中 $f(x) = \\ln(x)$。$f(x)$ 的导数为 $f'(x) = 1/x$ 和 $f''(x) = -1/x^2$。根据伊藤引理，$Y_t$ 的微分由下式给出：\n$$\n\\mathrm{d}Y_t = f'(S_t)\\mathrm{d}S_t + \\frac{1}{2} f''(S_t) (\\mathrm{d}S_t)^2\n$$\n二次变差项 $(\\mathrm{d}S_t)^2$ 使用伊藤乘法规则（$\\mathrm{d}t^2 = 0$, $\\mathrm{d}t \\mathrm{d}W_t = 0$, $\\mathrm{d}W_t^2 = \\mathrm{d}t$）计算：\n$$\n(\\mathrm{d}S_t)^2 = (\\mu S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}W_t)^2 = \\sigma^2 S_t^2 (\\mathrm{d}W_t)^2 = \\sigma^2 S_t^2 \\mathrm{d}t\n$$\n将 $\\mathrm{d}S_t$ 和 $(\\mathrm{d}S_t)^2$ 代入 $\\mathrm{d}Y_t$ 的表达式中：\n$$\n\\mathrm{d}Y_t = \\frac{1}{S_t} (\\mu S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}W_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right) (\\sigma^2 S_t^2 \\mathrm{d}t)\n$$\n$$\n\\mathrm{d}Y_t = \\mu \\mathrm{d}t + \\sigma \\mathrm{d}W_t - \\frac{1}{2} \\sigma^2 \\mathrm{d}t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)\\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\n将此式从 $0$ 积分到 $t$：\n$$\n\\int_0^t \\mathrm{d}Y_s = \\int_0^t \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)\\mathrm{d}s + \\int_0^t \\sigma \\mathrm{d}W_s\n$$\n$$\nY_t - Y_0 = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t\n$$\n代回 $Y_t = \\ln(S_t)$：\n$$\n\\ln(S_t) - \\ln(S_0) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t\n$$\n对两边取指数，得到 $S_t$ 的显式解：\n$$\nS_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)\n$$\n\n第二，我们证明过程 $M_t = S_t \\exp(-\\mu t)$ 是关于滤流 $(\\mathcal{F}_t)_{t \\ge 0}$ 的一个鞅。代入 $S_t$ 的表达式：\n$$\nM_t = \\left( S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right) \\right) \\exp(-\\mu t) = S_0 \\exp\\left( \\sigma W_t - \\frac{1}{2}\\sigma^2 t \\right)\n$$\n这是一个随机指数，也称为Doléans-Dade指数。要证明它是一个鞅，我们必须证明对于任何 $s  t$，都有 $\\mathbb{E}[M_t | \\mathcal{F}_s] = M_s$。\n$$\n\\mathbb{E}[M_t | \\mathcal{F}_s] = \\mathbb{E}\\left[ S_0 \\exp\\left( \\sigma W_t - \\frac{1}{2}\\sigma^2 t \\right) | \\mathcal{F}_s \\right]\n$$\n我们可以将指数的参数重写为 $\\sigma (W_t - W_s) + \\sigma W_s - \\frac{1}{2}\\sigma^2 (t-s) - \\frac{1}{2}\\sigma^2 s$。\n$$\n\\mathbb{E}[M_t | \\mathcal{F}_s] = \\mathbb{E}\\left[ S_0 \\exp\\left( \\sigma W_s - \\frac{1}{2}\\sigma^2 s \\right) \\exp\\left( \\sigma (W_t - W_s) - \\frac{1}{2}\\sigma^2 (t-s) \\right) | \\mathcal{F}_s \\right]\n$$\n项 $M_s = S_0 \\exp(\\sigma W_s - \\frac{1}{2}\\sigma^2 s)$ 是 $\\mathcal{F}_s$-可测的，所以可以从条件期望中提出。增量 $W_t - W_s$ 独立于 $\\sigma$-代数 $\\mathcal{F}_s$。\n$$\n\\mathbb{E}[M_t | \\mathcal{F}_s] = M_s \\, \\mathbb{E}\\left[ \\exp\\left( \\sigma (W_t - W_s) - \\frac{1}{2}\\sigma^2 (t-s) \\right) | \\mathcal{F}_s \\right] = M_s \\, \\mathbb{E}\\left[ \\exp\\left( \\sigma (W_t - W_s) - \\frac{1}{2}\\sigma^2 (t-s) \\right) \\right]\n$$\n随机变量 $W_t - W_s$ 服从均值为 $0$、方差为 $t-s$ 的正态分布。令 $Z = W_t-W_s \\sim N(0, t-s)$。正态随机变量 $X \\sim N(\\nu, \\zeta^2)$ 的矩母函数为 $\\mathbb{E}[\\exp(kX)] = \\exp(k\\nu + \\frac{1}{2}k^2\\zeta^2)$。对于 $Z$，当 $k=\\sigma$, $\\nu=0$ 且 $\\zeta^2=t-s$ 时：\n$$\n\\mathbb{E}[\\exp(\\sigma Z)] = \\exp\\left(\\sigma \\cdot 0 + \\frac{1}{2}\\sigma^2 (t-s)\\right) = \\exp\\left(\\frac{1}{2}\\sigma^2(t-s)\\right)\n$$\n该期望变为：\n$$\n\\mathbb{E}\\left[ \\dots \\right] = \\exp\\left( -\\frac{1}{2}\\sigma^2 (t-s) \\right) \\mathbb{E}[\\exp(\\sigma(W_t-W_s))] = \\exp\\left( -\\frac{1}{2}\\sigma^2 (t-s) \\right) \\exp\\left( \\frac{1}{2}\\sigma^2 (t-s) \\right) = 1\n$$\n因此，$\\mathbb{E}[M_t | \\mathcal{F}_s] = M_s$，这证明了 $M_t$ 是一个鞅。\n\n第三，我们构造停时。引入一个在 $[0, T]$ 上均匀分布且独立于滤流 $(\\mathcal{F}_t)_{t \\geq 0}$ 的随机变量 $U$。将滤流扩张为 $\\mathcal{G}_t = \\mathcal{F}_t \\vee \\sigma(U)$，其中 $\\sigma(U)$ 是由 $U$ 生成的 $\\sigma$-代数。我们定义停时 $\\tau := U$。要成为一个 $(\\mathcal{G}_t)$-停时，事件 $\\{\\tau \\le t\\}$ 必须对所有 $t \\ge 0$ 都属于 $\\mathcal{G}_t$。根据定义，事件 $\\{\\tau \\le t\\} = \\{U \\le t\\}$ 属于 $\\sigma(U)$。因为对所有 $t \\ge 0$ 都有 $\\sigma(U) \\subset \\mathcal{G}_t$，所以该条件得到满足。此外，由于 $U$ 的取值在 $[0, T]$ 内，$\\tau$ 是一个有界停时，$0 \\le \\tau \\le T$。\n\n第四，我们证明 $M_t$ 相对于 $(\\mathcal{G}_t)_{t \\ge 0}$ 仍然是一个鞅，并且可选停止定理(OST)适用。对于 $s  t$，我们计算 $\\mathbb{E}[M_t | \\mathcal{G}_s] = \\mathbb{E}[M_t | \\mathcal{F}_s \\vee \\sigma(U)]$。由于 $M_t$ 是 $\\mathcal{F}_t$-可测的，并且过程 $W_t$（生成 $\\mathcal{F}_t$）独立于 $U$（生成 $\\sigma(U)$），因此 $M_t$ 在给定 $\\mathcal{F}_s \\vee \\sigma(U)$ 下的条件期望与其在给定 $\\mathcal{F}_s$ 下的条件期望相同。\n$$\n\\mathbb{E}[M_t | \\mathcal{G}_s] = \\mathbb{E}[M_t | \\mathcal{F}_s] = M_s\n$$\n因此，$M_t$ 也是一个 $(\\mathcal{G}_t)$-鞅。由于 $M_t$ 是一个连续路径鞅，且 $\\tau$ 是一个有界停时，可选停止定理的条件得到满足，这意味着 $\\mathbb{E}[M_{\\tau}] = \\mathbb{E}[M_0] = S_0$。\n\n最后，我们计算 $\\mathbb{E}[S_{\\tau}]$ 的闭式表达式。我们使用全期望定律，以 $\\tau$ 的值为条件。\n$$\n\\mathbb{E}[S_{\\tau}] = \\mathbb{E}[\\mathbb{E}[S_{\\tau} | \\tau]]\n$$\n内部的条件期望是 $\\mathbb{E}[S_{\\tau} | \\tau=u] = \\mathbb{E}[S_u | U=u]$。由于过程 $(S_t)_{t\\ge 0}$ 独立于随机变量 $U$，这等于 $\\mathbb{E}[S_u]$。\n我们首先求出固定时间 $t$ 的无条件期望 $\\mathbb{E}[S_t]$：\n$$\n\\mathbb{E}[S_t] = \\mathbb{E}\\left[S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)\\right] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right) \\mathbb{E}\\left[\\exp(\\sigma W_t)\\right]\n$$\n像之前一样，使用 $W_t \\sim N(0,t)$ 的矩母函数，我们有 $\\mathbb{E}[\\exp(\\sigma W_t)] = \\exp(\\frac{1}{2}\\sigma^2 t)$。\n$$\n\\mathbb{E}[S_t] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right) \\exp\\left(\\frac{1}{2}\\sigma^2 t\\right) = S_0 \\exp(\\mu t)\n$$\n因此，$\\mathbb{E}[S_{\\tau} | \\tau] = S_0 \\exp(\\mu \\tau)$。现在我们计算外部期望，其中 $\\tau=U$ 在 $[0,T]$ 上均匀分布。其概率密度函数为 $f_U(u) = 1/T$，$u \\in [0,T]$。\n$$\n\\mathbb{E}[S_{\\tau}] = \\mathbb{E}[S_0 \\exp(\\mu \\tau)] = S_0 \\mathbb{E}[\\exp(\\mu U)] = S_0 \\int_0^T \\exp(\\mu u) \\frac{1}{T} \\mathrm{d}u\n$$\n由于给定 $\\mu \\neq 0$，我们可以计算该积分：\n$$\n\\int_0^T \\exp(\\mu u) \\frac{1}{T} \\mathrm{d}u = \\frac{1}{T} \\left[\\frac{\\exp(\\mu u)}{\\mu}\\right]_0^T = \\frac{1}{\\mu T} (\\exp(\\mu T) - \\exp(0)) = \\frac{\\exp(\\mu T) - 1}{\\mu T}\n$$\n结合这些结果，得到 $\\mathbb{E}[S_{\\tau}]$ 的最终表达式：\n$$\n\\mathbb{E}[S_{\\tau}] = S_0 \\frac{\\exp(\\mu T) - 1}{\\mu T}\n$$", "answer": "$$\n\\boxed{S_{0} \\frac{\\exp(\\mu T) - 1}{\\mu T}}\n$$", "id": "3001441"}, {"introduction": "虽然解析解非常强大，但许多现实世界的问题需要依赖数值模拟。对于像几何布朗运动这样的随机微分方程 (SDE)，离散化方法的选择对结果的准确性和稳定性有深远影响。本练习将指导你推导并比较两种数值模拟方案：标准的欧拉-丸山 (Euler-Maruyama) 格式和“对数欧拉”(log-Euler) 格式，后者巧妙地利用了 GBM 的对数是一个算术布朗运动的特性。通过分析这两种方法的偏差和方差，你将对为何利用 SDE 的特定结构可以得到性能优越得多的数值方法有一个深刻而实用的理解，这对任何需要模拟随机过程的从业者来说都是至关重要的一课 [@problem_id:3001420]。", "problem": "考虑由随机微分方程 (SDE) $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$ 控制的几何布朗运动 (GBM)，其中常数 $\\mu \\in \\mathbb{R}$，$\\sigma > 0$，时间范围 $T > 0$，以及确定性初始条件 $S_0 > 0$。设 $0 = t_0  t_1  \\cdots  t_N = T$ 为一个均匀划分，步长为 $h = T/N$，布朗运动增量为 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$。\n\n从 GBM SDE 的基本定义和应用于 $X_t = \\ln S_t$ 的伊藤公式出发，完成以下任务：\n\n1. 推导 $X_t$ 满足的 SDE。\n2. 在对数坐标 $X_t$ 中提出一种欧拉离散化（即对数欧拉格式），然后将其映射回去，以获得在网格点 $\\{t_n\\}$ 上近似 $S_T$ 的时间步进格式。\n3. 利用布朗运动增量的性质以及由推导出的 $X_t$ 的 SDE 所蕴含的精确解结构，分析对数欧拉格式是否能再现 $S_t$ 的精确网格点分布。由此，推导出对数欧拉近似相对于精确解 $S_T$ 的偏差和方差（在终端时刻 $T$）。\n4. 对于直接应用于 $S_t$ 的标准欧拉格式，其定义为 $S_{n+1}^{\\mathrm{E}} = S_n^{\\mathrm{E}} + \\mu S_n^{\\mathrm{E}} \\, h + \\sigma S_n^{\\mathrm{E}} \\, \\Delta W_n$，推导 $\\mathbb{E}[S_N^{\\mathrm{E}}]$ 和 $\\mathbb{E}[(S_N^{\\mathrm{E}})^2]$ 的精确公式。然后计算偏差 $\\mathbb{E}[S_N^{\\mathrm{E}}] - \\mathbb{E}[S_T]$ 和方差差异 $\\mathrm{Var}(S_N^{\\mathrm{E}}) - \\mathrm{Var}(S_T)$ 关于 $h$ 的主阶渐近式。\n5. 通过提供标准欧拉格式与对数欧拉格式在终端时刻 $T$ 的偏差和方差差异的关于 $h$ 的主阶表达式，来比较这两种格式。将您的最终答案表示为单个有序对 $(\\text{偏差差异}, \\text{方差差异})$，其中“差异”指“标准欧拉减去对数欧拉”，并以 $S_0$、$\\mu$、$\\sigma$、$T$ 和 $h$ 的闭式函数形式给出。\n\n您的最终答案必须是该有序对的单个解析表达式。不需要进行数值舍入。", "solution": "用户需要对几何布朗运动 (GBM) 随机微分方程 (SDE) 的标准欧拉-丸山格式和对数欧拉格式进行比较分析。这涉及到推导这两种格式，分析它们的性质，并计算它们在终端偏差和方差上的主阶差异。\n\n**问题验证**\n\n给定条件：\n-   SDE：$dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$\n-   常数：$\\mu \\in \\mathbb{R}$，$\\sigma > 0$\n-   时间范围：$T > 0$\n-   初始条件：$S_0 > 0$（确定性）\n-   划分：$0 = t_0  t_1  \\cdots  t_N = T$，均匀划分，步长 $h = T/N$\n-   布朗增量：$\\Delta W_n = W_{t_{n+1}} - W_{t_n}$\n-   对数坐标变换：$X_t = \\ln S_t$\n\n该问题在随机微积分和量化金融领域具有科学依据。它是一个适定的问题，具有清晰、客观的任务集，可以导出一个唯一的解析解。所有必要的信息都已提供，且没有矛盾之处。该问题是 SDE 数值方法分析中的一个标准练习。因此，该问题被认为是**有效的**。\n\n**第一部分：推导 $X_t$ 的 SDE**\n\n给定 $X_t = \\ln S_t$。我们将伊藤公式应用于函数 $f(s) = \\ln s$。其导数为 $f'(s) = 1/s$ 和 $f''(s) = -1/s^2$。$dX_t = df(S_t)$ 的一般伊藤公式为：\n$$dX_t = f'(S_t) dS_t + \\frac{1}{2} f''(S_t) (dS_t)^2$$\n二次变分项 $(dS_t)^2$ 使用伊藤乘法规则（$dt^2 = 0$, $dt dW_t = 0$, $dW_t^2 = dt$）计算：\n$$(dS_t)^2 = (\\mu S_t \\, dt + \\sigma S_t \\, dW_t)^2 = \\mu^2 S_t^2 \\, dt^2 + 2\\mu\\sigma S_t^2 \\, dt \\, dW_t + \\sigma^2 S_t^2 \\, dW_t^2 = \\sigma^2 S_t^2 \\, dt$$\n将 $dS_t$ 和 $(dS_t)^2$ 代入 $dX_t$ 的公式中：\n$$dX_t = \\frac{1}{S_t}(\\mu S_t \\, dt + \\sigma S_t \\, dW_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right)(\\sigma^2 S_t^2 \\, dt)$$\n$$dX_t = (\\mu \\, dt + \\sigma \\, dW_t) - \\frac{1}{2} \\sigma^2 \\, dt$$\n$$dX_t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) dt + \\sigma \\, dW_t$$\n这就是 $X_t$ 的 SDE，它描述了一个漂移项为常数 $\\mu - \\frac{1}{2}\\sigma^2$、波动率为常数 $\\sigma$ 的算术布朗运动。\n\n**第二部分：对数欧拉格式**\n\n对数欧拉格式是通过将标准欧拉-丸山离散化应用于过程对数 $X_t$ 的 SDE 而得到的。设 $\\hat{X}_n$ 为 $X_{t_n}$ 的数值近似。\n$$\\hat{X}_{n+1} = \\hat{X}_n + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) h + \\sigma \\, \\Delta W_n$$\n为了获得 $S_t$ 的格式，我们使用变换 $S_t = \\exp(X_t)$ 将其映射回去。设 $S_n^{\\mathrm{LE}}$ 表示对数欧拉近似。\n$$S_{n+1}^{\\mathrm{LE}} = \\exp(\\hat{X}_{n+1}) = \\exp\\left(\\hat{X}_n + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) h + \\sigma \\, \\Delta W_n\\right)$$\n$$S_{n+1}^{\\mathrm{LE}} = \\exp(\\hat{X}_n) \\exp\\left(\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) h + \\sigma \\, \\Delta W_n\\right)$$\n$$S_{n+1}^{\\mathrm{LE}} = S_n^{\\mathrm{LE}} \\exp\\left(\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) h + \\sigma \\, \\Delta W_n\\right)$$\n这就是对数欧拉近似的时间步进格式。\n\n**第三部分：对数欧拉格式的分析**\n\n$X_t$ 的 SDE 具有常系数，这允许我们直接从 $t_n$ 到 $t_{n+1}$ 进行积分：\n$$X_{t_{n+1}} = X_{t_n} + \\int_{t_n}^{t_{n+1}} \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) ds + \\int_{t_n}^{t_{n+1}} \\sigma \\, dW_s$$\n$$X_{t_{n+1}} = X_{t_n} + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) h + \\sigma (W_{t_{n+1}} - W_{t_n})$$\n$$X_{t_{n+1}} = X_{t_n} + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) h + \\sigma \\, \\Delta W_n$$\n这个在网格点上的精确过程 $X_t$ 的递推关系与 $\\hat{X}_n$ 的对数欧拉格式完全相同。由于 $\\hat{X}_0 = X_0 = \\ln S_0$，可以得出对于所有 $n=0, 1, \\dots, N$，都有 $\\hat{X}_n = X_{t_n}$。\n因此，对数欧拉近似 $S_n^{\\mathrm{LE}} = \\exp(\\hat{X}_n)$ 在每个网格点上都等于精确解 $S_{t_n} = \\exp(X_{t_n})$。该格式能够再现精确的网格点分布。\n因此，在终端时刻 $T=t_N$，对数欧拉格式的偏差和方差误差均为零。\n-   偏差：$\\mathbb{E}[S_N^{\\mathrm{LE}}] - \\mathbb{E}[S_T] = \\mathbb{E}[S_T] - \\mathbb{E}[S_T] = 0$。\n-   方差差异：$\\mathrm{Var}(S_N^{\\mathrm{LE}}) - \\mathrm{Var}(S_T) = \\mathrm{Var}(S_T) - \\mathrm{Var}(S_T) = 0$。\n\n**第四部分：标准欧拉格式的分析**\n\n直接应用于 $S_t$ 的标准欧拉-丸山格式由下式给出：\n$$S_{n+1}^{\\mathrm{E}} = S_n^{\\mathrm{E}} + \\mu S_n^{\\mathrm{E}} h + \\sigma S_n^{\\mathrm{E}} \\Delta W_n = S_n^{\\mathrm{E}}(1 + \\mu h + \\sigma \\Delta W_n)$$\n\n首先，我们推导该格式的精确矩。\n对于期望：\n$\\mathbb{E}[S_{n+1}^{\\mathrm{E}}] = \\mathbb{E}[\\mathbb{E}[S_n^{\\mathrm{E}}(1 + \\mu h + \\sigma \\Delta W_n) | \\mathcal{F}_{t_n}]] = \\mathbb{E}[S_n^{\\mathrm{E}}(1 + \\mu h)] = (1+\\mu h) \\mathbb{E}[S_n^{\\mathrm{E}}]$。\n由于 $\\mathbb{E}[S_0^{\\mathrm{E}}] = S_0$，我们有 $\\mathbb{E}[S_N^{\\mathrm{E}}] = S_0(1+\\mu h)^N$。\n\n对于二阶矩：\n$\\mathbb{E}[(S_{n+1}^{\\mathrm{E}})^2] = \\mathbb{E}[\\mathbb{E}[(S_n^{\\mathrm{E}})^2(1 + \\mu h + \\sigma \\Delta W_n)^2 | \\mathcal{F}_{t_n}]]$.\n内层期望为 $(S_n^{\\mathrm{E}})^2 \\mathbb{E}[1 + 2\\mu h + \\mu^2 h^2 + 2\\sigma(1+\\mu h)\\Delta W_n + \\sigma^2(\\Delta W_n)^2] = (S_n^{\\mathrm{E}})^2(1+2\\mu h + \\mu^2 h^2 + \\sigma^2 h)$。\n所以，$\\mathbb{E}[(S_N^{\\mathrm{E}})^2] = S_0^2(1 + (2\\mu+\\sigma^2)h + \\mu^2 h^2)^N$。\n\n接下来，我们推导精确解 $S_T = S_0 \\exp((\\mu-\\frac{1}{2}\\sigma^2)T + \\sigma W_T)$ 的矩。这是一个对数正态分布。\n$\\mathbb{E}[S_T] = S_0 \\exp((\\mu-\\frac{1}{2}\\sigma^2)T + \\frac{1}{2}\\sigma^2 T) = S_0 \\exp(\\mu T)$.\n$\\mathbb{E}[S_T^2] = S_0^2 \\exp(2(\\mu-\\frac{1}{2}\\sigma^2)T + \\frac{1}{2}(2\\sigma)^2 T) = S_0^2 \\exp((2\\mu-\\sigma^2)T + 2\\sigma^2 T) = S_0^2 \\exp((2\\mu+\\sigma^2)T)$.\n$\\mathrm{Var}(S_T) = \\mathbb{E}[S_T^2] - (\\mathbb{E}[S_T])^2 = S_0^2(\\exp((2\\mu+\\sigma^2)T) - \\exp(2\\mu T))$.\n\n现在我们求出关于 $h=T/N$ 的主阶渐近式。\n对于偏差 $\\mathbb{E}[S_N^{\\mathrm{E}}] - \\mathbb{E}[S_T]$：\n$\\mathbb{E}[S_N^{\\mathrm{E}}] = S_0 (1+\\mu h)^N = S_0 (1+\\mu T/N)^N = S_0 \\exp(\\mu T)\\left(1 - \\frac{\\mu^2 T^2}{2N} + O(N^{-2})\\right) = S_0 \\exp(\\mu T)\\left(1 - \\frac{\\mu^2 T h}{2} + O(h^2)\\right)$.\n偏差 $= \\mathbb{E}[S_N^{\\mathrm{E}}] - \\mathbb{E}[S_T] = S_0 \\exp(\\mu T)\\left(1 - \\frac{\\mu^2 T h}{2}\\right) - S_0 \\exp(\\mu T) + O(h^2) = -S_0 \\frac{\\mu^2 T h}{2} \\exp(\\mu T) + O(h^2)$。\n\n对于方差差异 $\\mathrm{Var}(S_N^{\\mathrm{E}}) - \\mathrm{Var}(S_T) = (\\mathbb{E}[(S_N^{\\mathrm{E}})^2] - \\mathbb{E}[S_T^2]) - ((\\mathbb{E}[S_N^{\\mathrm{E}}])^2 - (\\mathbb{E}[S_T])^2)$。\n第一项：$\\mathbb{E}[(S_N^{\\mathrm{E}})^2] - \\mathbb{E}[S_T^2]$。令 $A=2\\mu+\\sigma^2, B=\\mu^2$。\n$\\mathbb{E}[(S_N^{\\mathrm{E}})^2] = S_0^2(1+Ah+Bh^2)^N = S_0^2 \\exp(\\frac{T}{h}\\ln(1+Ah+Bh^2))$.\n$\\ln(1+Ah+Bh^2) = Ah + (B-\\frac{A^2}{2})h^2+O(h^3)$，所以 $\\frac{T}{h}\\ln(\\dots) = AT + T(B-\\frac{A^2}{2})h+O(h^2)$。\n$\\mathbb{E}[(S_N^{\\mathrm{E}})^2] = S_0^2 \\exp(AT)\\left(1+T(B-\\frac{A^2}{2})h\\right) + O(h^2)$.\n$B-\\frac{A^2}{2} = \\mu^2 - \\frac{(2\\mu+\\sigma^2)^2}{2} = -\\mu^2 - 2\\mu\\sigma^2 - \\frac{1}{2}\\sigma^4$.\n$\\mathbb{E}[(S_N^{\\mathrm{E}})^2] - \\mathbb{E}[S_T^2] = S_0^2 \\exp(AT) T(B-\\frac{A^2}{2})h + O(h^2) = -S_0^2 T h (\\mu^2+2\\mu\\sigma^2+\\frac{1}{2}\\sigma^4)\\exp((2\\mu+\\sigma^2)T) + O(h^2)$。\n\n第二项：$(\\mathbb{E}[S_N^{\\mathrm{E}}])^2 - (\\mathbb{E}[S_T])^2$。\n$(\\mathbb{E}[S_N^{\\mathrm{E}}])^2 = \\left(S_0 \\exp(\\mu T)(1 - \\frac{\\mu^2 T h}{2})\\right)^2 + O(h^2) = S_0^2 \\exp(2\\mu T)(1 - \\mu^2 T h) + O(h^2)$.\n$(\\mathbb{E}[S_N^{\\mathrm{E}}])^2 - (\\mathbb{E}[S_T])^2 = -S_0^2 \\mu^2 T h \\exp(2\\mu T) + O(h^2)$。\n\n方差差异：\n$\\mathrm{Var}(S_N^{\\mathrm{E}}) - \\mathrm{Var}(S_T) = \\left[-S_0^2 T h \\left(\\mu^2+2\\mu\\sigma^2+\\frac{1}{2}\\sigma^4\\right)\\exp((2\\mu+\\sigma^2)T)\\right] - \\left[-S_0^2 \\mu^2 T h \\exp(2\\mu T)\\right] + O(h^2)$\n$= S_0^2 T h \\left[\\mu^2 \\exp(2\\mu T) - \\left(\\mu^2+2\\mu\\sigma^2+\\frac{1}{2}\\sigma^4\\right)\\exp((2\\mu+\\sigma^2)T)\\right] + O(h^2)$。\n\n**第五部分：格式比较**\n\n问题要求的是“标准欧拉减去对数欧拉”在终端偏差和方差方面的差异。一个格式的偏差是 $\\mathbb{E}[\\text{近似值}] - \\mathbb{E}[\\text{精确值}]$。终端方差就是 $\\mathrm{Var}(\\text{近似值})$。问题的措辞暗示了误差的差异。我们将误差定义为（近似量）-（精确量）。\n\n偏差差异 = $(\\mathbb{E}[S_N^{\\mathrm{E}}] - \\mathbb{E}[S_T]) - (\\mathbb{E}[S_N^{\\mathrm{LE}}] - \\mathbb{E}[S_T])$。\n根据第三部分，第二项为 $0$。所以偏差差异就是标准欧拉格式的偏差。\n主阶偏差差异：$-S_0 \\frac{\\mu^2 T h}{2} \\exp(\\mu T)$。\n\n方差差异 = $(\\mathrm{Var}(S_N^{\\mathrm{E}}) - \\mathrm{Var}(S_T)) - (\\mathrm{Var}(S_N^{\\mathrm{LE}}) - \\mathrm{Var}(S_T))$。\n根据第三部分，第二项为 $0$。所以方差差异就是标准欧拉格式的方差误差。\n主阶方差差异：$S_0^2 T h \\left[\\mu^2 \\exp(2\\mu T) - \\left(\\mu^2+2\\mu\\sigma^2+\\frac{1}{2}\\sigma^4\\right)\\exp((2\\mu+\\sigma^2)T)\\right]$。\n这可以写成 $S_0^2 T h \\exp(2\\mu T) \\left[\\mu^2 - \\left(\\mu^2+2\\mu\\sigma^2+\\frac{1}{2}\\sigma^4\\right)\\exp(\\sigma^2 T)\\right]$。\n\n最终答案是这两个主阶表达式组成的有序对。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{2} S_0 \\mu^2 T h \\exp(\\mu T)  S_0^2 T h \\exp(2\\mu T) \\left[ \\mu^2 - \\left(\\mu^2 + 2\\mu\\sigma^2 + \\frac{1}{2}\\sigma^4\\right) \\exp(\\sigma^2 T) \\right]\n\\end{pmatrix}\n}\n$$", "id": "3001420"}]}