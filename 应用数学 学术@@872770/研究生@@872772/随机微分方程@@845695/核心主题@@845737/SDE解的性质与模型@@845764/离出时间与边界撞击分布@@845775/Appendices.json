{"hands_on_practices": [{"introduction": "本练习是理解出界现象的绝佳起点。通过分析一个带漂移的一维布朗运动，您将实践一项核心技能：将一个关于随机过程的概率问题——先到达哪个边界——转化为一个确定性的边值问题[@problem_id:2974721]。这个练习具体地应用了过程的无穷小生成元，并介绍了标度函数和速度测度这两个强大的分析工具。", "problem": "设 $\\{W_t\\}_{t \\ge 0}$ 是一个标准一维布朗运动，$\\{X_t\\}_{t \\ge 0}$ 是解为随机微分方程 $dX_t = \\mu \\, dt + dW_t$ 的过程，其中漂移参数 $\\mu \\in \\mathbb{R}$ 为常数。固定实数 $a  x  b$，定义首次击中时间 $\\tau_a := \\inf\\{t \\ge 0 : X_t = a\\}$ 和 $\\tau_b := \\inf\\{t \\ge 0 : X_t = b\\}$，以及首次离开开区间 $(a,b)$ 的时间 $\\tau_{(a,b)} := \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}$。用 $\\mathbb{P}_x$ 和 $\\mathbb{E}_x$ 分别表示过程从 $X_0 = x$ 开始的概率和期望。\n\n从扩散的生成元和 Dynkin 公式出发，推导刻画边界击中概率 $h(x) := \\mathbb{P}_x(\\tau_b  \\tau_a)$ 和期望离开时间 $u(x) := \\mathbb{E}_x[\\tau_{(a,b)}]$ 的边值问题，并在适当的边界条件下显式求解它们。在你的推导中，使用与此扩散相关的标度函数 $s(x) = \\int^{x} \\exp(-2 \\mu y) \\, dy$ 和速度测度 $m(dx) = 2 \\exp(2 \\mu x) \\, dx$ 来联系一维扩散的 Green 函数表示。将你的最终答案表示为 $\\mu$、$a$、$b$ 和 $x$ 的闭式函数。\n\n你的最终答案必须是单一的闭式解析表达式；不要提供不等式或方程。无需四舍五入，也不涉及物理单位。", "solution": "该问题是有效的，因为它是随机微分方程理论中一个标准的、适定的问题，基于已建立的数学原理。所有必要信息均已提供，且术语精确无歧义。\n\n设 $\\{X_t\\}_{t \\ge 0}$ 是由 SDE $dX_t = \\mu \\, dt + dW_t$ 定义的随机过程，其中 $X_0 = x$ 且 $a  x  b$。这是一个具有常数漂移 $\\mu(x) = \\mu$ 和常数扩散系数 $\\sigma(x)=1$ 的一维扩散过程。\n\n此扩散过程的无穷小生成元 $\\mathcal{L}$ 应用于一个二次可微函数 $f(x)$ 时，由下式给出：\n$$\n\\mathcal{L}f(x) = \\mu(x) \\frac{df}{dx} + \\frac{1}{2}\\sigma(x)^2 \\frac{d^2f}{dx^2} = \\mu f'(x) + \\frac{1}{2}f''(x)\n$$\n问题要求将解与标度函数 $s(x)$ 和速度测度 $m(dx)$ 联系起来。标度函数 $s(x)$ 由性质 $\\mathcal{L}s(x)=0$ 定义。对于此过程，标度函数导数的一个选择是 $s'(x) = \\exp\\left(-\\int \\frac{2\\mu}{\\sigma^2} dy\\right) = \\exp(-2\\mu x)$，这在相差一个乘法常数的情况下与问题陈述相符。速度测度密度由 $m(x) = \\frac{2}{\\sigma(x)^2 s'(x)} = \\frac{2}{1^2 \\cdot \\exp(-2\\mu x)} = 2\\exp(2\\mu x)$ 给出，这也与问题陈述相符。用 $s(x)$ 和 $m(x)$ 表示，生成元可以写为：\n$$\n\\mathcal{L}f(x) = \\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)\n$$\n我们将使用这种形式来推导解。\n\n**1. 击中概率 $h(x) = \\mathbb{P}_x(\\tau_b  \\tau_a)$ 的推导**\n\n击中概率 $h(x)$ 是由 $\\mathcal{L}h(x) = 0$ (对于 $x \\in (a,b)$) 定义的边值问题 (BVP) 的解，其边界条件为 $h(a)=0$ 和 $h(b)=1$。边界条件的来源是：如果过程从 $x=a$ 开始，它已经击中 $a$，因此首先击中 $b$ 的概率是 $0$。如果它从 $x=b$ 开始，它已经击中 $b$，因此首先击中 $b$ 的概率是 $1$。\n\n使用以标度函数表示的生成元，常微分方程 (ODE) 是：\n$$\n\\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{h'(x)}{s'(x)}\\right) = 0 \\implies \\frac{d}{dx}\\left(\\frac{h'(x)}{s'(x)}\\right) = 0\n$$\n对 $x$ 积分一次得到：\n$$\n\\frac{h'(x)}{s'(x)} = C_1 \\implies h'(x) = C_1 s'(x)\n$$\n其中 $C_1$ 是一个积分常数。再次积分得到：\n$$\nh(x) = C_1 s(x) + C_2\n$$\n我们应用边界条件来求解 $C_1$ 和 $C_2$：\n1. $h(a) = C_1 s(a) + C_2 = 0$\n2. $h(b) = C_1 s(b) + C_2 = 1$\n\n用第二个方程减去第一个方程得到 $C_1(s(b)-s(a)) = 1$，所以 $C_1 = \\frac{1}{s(b)-s(a)}$。\n由第一个方程， $C_2 = -C_1 s(a) = -\\frac{s(a)}{s(b)-s(a)}$。\n将常数代回 $h(x)$ 的解中：\n$$\nh(x) = \\frac{s(x)}{s(b)-s(a)} - \\frac{s(a)}{s(b)-s(a)} = \\frac{s(x)-s(a)}{s(b)-s(a)}\n$$\n现在，我们从其导数 $s'(x) = \\exp(-2\\mu x)$ 得到 $s(x)$ 的显式形式：\n- 如果 $\\mu \\neq 0$，$s(x) = \\int \\exp(-2\\mu x) dx = -\\frac{1}{2\\mu}\\exp(-2\\mu x)$。我们可以忽略积分常数，因为它在 $h(x)$ 的公式中会被消掉。\n  $$\n  h(x) = \\frac{-\\frac{1}{2\\mu}\\exp(-2\\mu x) - (-\\frac{1}{2\\mu}\\exp(-2\\mu a))}{-\\frac{1}{2\\mu}\\exp(-2\\mu b) - (-\\frac{1}{2\\mu}\\exp(-2\\mu a))} = \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\n  $$\n- 如果 $\\mu = 0$，$s'(x) = 1$，所以 $s(x) = x$。\n  $$\n  h(x) = \\frac{x-a}{b-a}\n  $$\n当 $\\mu \\to 0$ 时，通过洛必达法则，$\\mu \\neq 0$ 的表达式收敛于 $\\mu=0$ 的表达式。\n\n**2. 期望离开时间 $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$ 的推导**\n\n期望离开时间 $u(x)$ 是由 $\\mathcal{L}u(x) = -1$ (对于 $x \\in (a,b)$) 定义的泊松型边值问题 (BVP) 的解，其边界条件为 $u(a)=0$ 和 $u(b)=0$。边界条件的来源是：如果过程从边界点开始，离开时间为 $0$。\n\n使用以标度函数和速度测度表示的生成元，常微分方程 (ODE) 是：\n$$\n\\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{u'(x)}{s'(x)}\\right) = -1 \\implies \\frac{d}{dx}\\left(\\frac{u'(x)}{s'(x)}\\right) = -m(x)\n$$\n代入 $m(x) = 2\\exp(2\\mu x)$ 并对 $x$ 积分得到：\n- 如果 $\\mu \\neq 0$:\n  $$\n  \\frac{u'(x)}{s'(x)} = \\int -2\\exp(2\\mu y) dy = -\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\n  $$\n  $u'(x) = s'(x) \\left(-\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\\right) = \\exp(-2\\mu x) \\left(-\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\\right) = -\\frac{1}{\\mu} + C_1\\exp(-2\\mu x)$。\n  再次积分：\n  $$\n  u(x) = \\int \\left(-\\frac{1}{\\mu} + C_1\\exp(-2\\mu x)\\right) dx = -\\frac{x}{\\mu} - \\frac{C_1}{2\\mu}\\exp(-2\\mu x) + C_2\n  $$\n  令 $K_1 = -\\frac{C_1}{2\\mu}$ 和 $K_2=C_2$。通解为 $u(x) = -\\frac{x}{\\mu} + K_1\\exp(-2\\mu x) + K_2$。\n  我们应用边界条件 $u(a)=0$ 和 $u(b)=0$：\n  1. $-\\frac{a}{\\mu} + K_1\\exp(-2\\mu a) + K_2 = 0 \\implies K_1\\exp(-2\\mu a) + K_2 = \\frac{a}{\\mu}$\n  2. $-\\frac{b}{\\mu} + K_1\\exp(-2\\mu b) + K_2 = 0 \\implies K_1\\exp(-2\\mu b) + K_2 = \\frac{b}{\\mu}$\n  相减得到 $K_1(\\exp(-2\\mu a) - \\exp(-2\\mu b)) = \\frac{a-b}{\\mu}$，所以 $K_1 = \\frac{a-b}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))}$。\n  $K_2 = \\frac{a}{\\mu} - K_1\\exp(-2\\mu a) = \\frac{a}{\\mu} - \\frac{(a-b)\\exp(-2\\mu a)}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))} = \\frac{b\\exp(-2\\mu a) - a\\exp(-2\\mu b)}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))}$。\n  代回后，我们得到一个复杂的表达式。一个更结构化的形式是：\n  $$\n  u(x) = \\frac{1}{\\mu}\\left( a-x + (b-a)h(x) \\right) = \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right)\n  $$\n- 如果 $\\mu = 0$，常微分方程是 $\\frac{1}{2}u''(x) = -1$，或 $u''(x) = -2$。\n  积分两次得到 $u(x) = -x^2 + C_1 x + C_2$。\n  应用边界条件 $u(a)=0, u(b)=0$：\n  1. $-a^2 + C_1 a + C_2 = 0$\n  2. $-b^2 + C_1 b + C_2 = 0$\n  解此方程组得到 $C_1 = a+b$ 和 $C_2 = -ab$。\n  解为 $u(x) = -x^2 + (a+b)x - ab = (x-a)(b-x)$。\n同样，当 $\\mu \\to 0$ 时，$\\mu \\neq 0$ 的表达式收敛于 $\\mu=0$ 的表达式。我们提供对于 $\\mu \\neq 0$ 有效的一般表达式，并理解 $\\mu = 0$ 的情况可以通过取极限得到。\n\n最终表达式：\n对于击中概率 $h(x) = \\mathbb{P}_x(\\tau_b  \\tau_a)$：\n$$\nh(x) = \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\n$$\n对于期望离开时间 $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$：\n$$\nu(x) = \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right)\n$$", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}  \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right) \\end{pmatrix} } $$", "id": "2974721"}, {"introduction": "从一维走向多维，本练习探讨了空间的几何结构如何影响粒子的随机游走。通过计算一个$d$维布朗运动从环形区域的内边界出界的概率，您将学会如何利用对称性将一个多维偏微分方程简化为一个可解的常微分方程[@problem_id:2974725]。这项实践尤为深刻，因为它揭示了二维过程与更高维过程在行为上的本质差异。", "problem": "考虑在 $\\mathbb{R}^d$（$d \\ge 2$）上的标准 $d$ 维布朗运动 $B_t$，其始于一点 $x \\in \\mathbb{R}^d$，范数 $r = \\|x\\| \\in (r_1, r_2)$，其中 $0  r_1  r_2$。令 $A = \\{ x \\in \\mathbb{R}^d : r_1  \\|x\\|  r_2 \\}$ 表示环形域，并令 $\\tau = \\inf\\{ t \\ge 0 : B_t \\notin A \\}$ 为首次离开 $A$ 的时间。定义事件 $H_{\\text{in}} = \\{ \\|B_\\tau\\| = r_1 \\}$ 为过程首次碰到内球面，事件 $H_{\\text{out}} = \\{ \\|B_\\tau\\| = r_2 \\}$ 为过程首次碰到外球面，因此 $H_{\\text{in}} \\cup H_{\\text{out}}$ 几乎必然发生，且 $H_{\\text{in}} \\cap H_{\\text{out}} = \\varnothing$。\n\n仅从布朗运动的生成元刻画（无穷小生成元为 $(1/2)\\Delta$，其中 $\\Delta$ 是拉普拉斯算子）出发，结合强马尔可夫性和在 $\\partial A$ 上设定的边界数据，从第一性原理推导函数 $u(x) = \\mathbb{P}_x(H_{\\text{in}})$ 的边值问题，利用对称性将其简化为关于径向坐标 $r = \\|x\\|$ 的径向常微分方程，并在 $r = r_1$ 和 $r = r_2$ 处施加适当的边界条件来求解。你的推导必须阐明为何所得函数在 $A$ 内部是调和的，以及边界条件如何编码事件 $H_{\\text{in}}$。\n\n将内碰概率 $u(r) = \\mathbb{P}(\\|B_\\tau\\| = r_1 \\mid \\|B_0\\| = r)$ 明确表示为 $r$、$r_1$、$r_2$ 和 $d$ 的闭式函数，展示其对 $d$ 的依赖性，并显示当 $d \\ne 2$（用半径的幂表示）和 $d = 2$（用半径的对数表示）时的不同形式。你可以假定函数具有足够的平滑性和正则性，以证明你推导步骤的合理性。外碰概率由 $1 - u(r)$ 给出，无需报告。\n\n请以单个闭式表达式的形式提供 $u(r)$ 的最终答案，该表达式对所有 $d \\ge 2$ 均有效，并以分段函数的形式写出 $d \\ne 2$ 和 $d = 2$ 两种情况。不需要进行数值计算，也不涉及单位。", "solution": "用户希望求出从环形域内出发的 $d$ 维布朗运动在碰到外边界之前先碰到内边界的概率。推导必须从该过程的无穷小生成元开始。\n\n令 $B_t$ 为一个标准 $d$ 维布朗运动，其中 $d \\ge 2$。起始位置为 $x \\in \\mathbb{R}^d$，其范数 $r = \\|x\\|$ 满足 $r_1  r  r_2$，其中 $0  r_1  r_2$。该过程在环形域 $A = \\{ y \\in \\mathbb{R}^d : r_1  \\|y\\|  r_2 \\}$ 中演化。首次离开此环形域的时间为 $\\tau = \\inf\\{ t \\ge 0 : B_t \\notin A \\}$。我们关心的是事件 $H_{\\text{in}} = \\{ \\|B_\\tau\\| = r_1 \\}$ 的概率，即过程首次碰到内球面 $\\partial A_{\\text{in}} = \\{ y \\in \\mathbb{R}^d : \\|y\\| = r_1 \\}$ 的概率。\n\n令 $u(x) = \\mathbb{P}_x(H_{\\text{in}}) = \\mathbb{P}(H_{\\text{in}} \\mid B_0 = x)$。我们的任务是求出 $u(x)$。\n\n标准 $d$ 维布朗运动的无穷小生成元是算子 $\\mathcal{L} = \\frac{1}{2}\\Delta$，其中 $\\Delta = \\sum_{i=1}^d \\frac{\\partial^2}{\\partial x_i^2}$ 是拉普拉斯算子。\n\n随机微分方程理论中的一个基本结果，即 Dynkin 公式，将过程与其生成元联系起来。对于一个具有足够正则性的函数 $f$ 和一个停时 $T$，过程 $M_t = f(B_{t \\wedge T}) - \\int_0^{t \\wedge T} \\mathcal{L}f(B_s) ds$ 是一个鞅。一个关键性质是，触碰概率函数 $u(x)$ 在定义域内部对所有 $x$ 满足 $\\mathcal{L}u(x) = 0$。在我们的问题中，这意味着对所有 $x \\in A$ 都有 $\\frac{1}{2}\\Delta u(x) = 0$。这表明 $u(x)$ 在环形域 $A$ 中是一个调和函数。\n\n为了更严谨地说明这一点，考虑过程 $U_t = u(B_{t \\wedge \\tau})$。根据强马尔可夫性，对于任意停时 $S  \\tau$，有 $u(B_S) = \\mathbb{P}_{B_S}(H_{\\text{in}}) = \\mathbb{E}[ \\mathbf{1}_{H_{\\text{in}}} \\mid \\mathcal{F}_S ]$，其中 $\\mathbf{1}_{H_{\\text{in}}}$ 是该事件的指示函数。过程 $U_t$ 是一个有界鞅。根据 Itô 公式，对于 $C^2$ 函数 $u$，当 $t  \\tau$ 时 $U_t$ 的鞅性质要求其漂移项为零。漂移项为 $\\mathcal{L}u(B_t) = \\frac{1}{2}\\Delta u(B_t)$。因此，对所有 $x \\in A$ 必须有 $\\Delta u(x) = 0$。\n\n接下来，我们在 $\\partial A = \\partial A_{\\text{in}} \\cup \\partial A_{\\text{out}}$ 上建立 $u(x)$ 的边界条件。\n如果过程从内球面上的点 $x$（即 $\\|x\\|=r_1$）出发，那么其起点已在边界上。首次出时为 $\\tau=0$，且 $B_\\tau = B_0 = x$。因此，$\\|B_\\tau\\| = r_1$，这意味着事件 $H_{\\text{in}}$ 以概率 $1$ 发生。所以，当 $\\|x\\| = r_1$ 时，边界条件为 $u(x) = 1$。\n\n如果过程从外球面上的点 $x$（即 $\\|x\\|=r_2$）出发，首次出时同样为 $\\tau=0$，且 $B_\\tau=x$。因此，$\\|B_\\tau\\| = r_2$。事件 $H_{\\text{in}}$ 不可能发生，因此其概率为 $0$。所以，当 $\\|x\\| = r_2$ 时，边界条件为 $u(x) = 0$。\n\n我们现在为函数 $u(x)$ 建立了一个 Dirichlet 问题：\n$$\n\\begin{cases}\n\\Delta u(x) = 0  \\text{for } x \\in A = \\{x \\in \\mathbb{R}^d : r_1  \\|x\\|  r_2\\} \\\\\nu(x) = 1  \\text{for } \\|x\\| = r_1 \\\\\nu(x) = 0  \\text{for } \\|x\\| = r_2\n\\end{cases}\n$$\n\n拉普拉斯算子 $\\Delta$、区域 $A$ 以及边界条件在 $\\mathbb{R}^d$ 围绕原点的旋转下都是不变的。这种球对称性意味着唯一解 $u(x)$ 必须仅依赖于到原点的径向距离 $r = \\|x\\|$。因此，我们可以对某个函数 $v$ 写出 $u(x) = v(r)$。\n\n为了解决这个问题，我们在 $d$ 维球坐标中表示拉普拉斯算子。对于一个只依赖于半径 $r$ 的函数 $v(r)$，拉普拉斯算子由下式给出：\n$$ \\Delta v(r) = \\frac{d^2 v}{dr^2} + \\frac{d-1}{r} \\frac{dv}{dr} $$\n偏微分方程 $\\Delta u = 0$ 简化为常微分方程 (ODE)：\n$$ v''(r) + \\frac{d-1}{r} v'(r) = 0 $$\n边界条件变为 $v(r_1) = 1$ 和 $v(r_2) = 0$。\n\n这是一个二阶线性常微分方程，可以通过先降阶来求解。令 $w(r) = v'(r)$。关于 $w$ 的方程是：\n$$ w'(r) + \\frac{d-1}{r} w(r) = 0 $$\n这是一个可分离的一阶常微分方程：\n$$ \\frac{w'(r)}{w(r)} = -\\frac{d-1}{r} $$\n对 $r$ 积分得到 $\\ln(w(r)) = -(d-1)\\ln(r) + C_0$，这给出 $w(r) = C_1 r^{-(d-1)} = C_1 r^{1-d}$，其中 $C_1$ 是某个常数。\n现在我们有 $v'(r) = C_1 r^{1-d}$。为了求得 $v(r)$，我们对 $v'(r)$ 进行积分。我们必须根据指数 $1-d$ 分两种情况讨论。\n\n情况1：$d \\ne 2$。\n在这种情况下，$1-d \\ne -1$。积分为：\n$$ v(r) = \\int C_1 r^{1-d} dr = C_1 \\frac{r^{2-d}}{2-d} + C_2 $$\n通解的形式为 $v(r) = A r^{2-d} + B$，其中 $A$ 和 $B$ 是常数。我们应用边界条件来确定它们：\n$$ v(r_1) = A r_1^{2-d} + B = 1 $$\n$$ v(r_2) = A r_2^{2-d} + B = 0 $$\n从第二个方程，我们得到 $B = -A r_2^{2-d}$。将其代入第一个方程：\n$$ A r_1^{2-d} - A r_2^{2-d} = 1 \\implies A(r_1^{2-d} - r_2^{2-d}) = 1 $$\n$$ A = \\frac{1}{r_1^{2-d} - r_2^{2-d}} $$\n然后，$B$ 由下式给出：\n$$ B = - \\frac{r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} $$\n将 $A$ 和 $B$ 代回到 $v(r)$ 的解中：\n$$ v(r) = \\frac{r^{2-d}}{r_1^{2-d} - r_2^{2-d}} - \\frac{r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} = \\frac{r^{2-d} - r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} $$\n\n情况2：$d=2$。\n在这种情况下，指数为 $1-d = -1$。\n$$ v'(r) = C_1 r^{-1} = \\frac{C_1}{r} $$\n对 $r$ 积分得到：\n$$ v(r) = \\int \\frac{C_1}{r} dr = C_1 \\ln(r) + C_2 $$\n通解的形式为 $v(r) = A \\ln(r) + B$。应用边界条件：\n$$ v(r_1) = A \\ln(r_1) + B = 1 $$\n$$ v(r_2) = A \\ln(r_2) + B = 0 $$\n从第二个方程，我们得到 $B = -A \\ln(r_2)$。将其代入第一个方程：\n$$ A \\ln(r_1) - A \\ln(r_2) = 1 \\implies A(\\ln(r_1) - \\ln(r_2)) = 1 $$\n$$ A = \\frac{1}{\\ln(r_1) - \\ln(r_2)} = \\frac{1}{\\ln(r_1/r_2)} $$\n然后，$B$ 由下式给出：\n$$ B = - \\frac{\\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} $$\n将 $A$ 和 $B$ 代回到 $v(r)$ 的解中：\n$$ v(r) = \\frac{\\ln(r)}{\\ln(r_1) - \\ln(r_2)} - \\frac{\\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} = \\frac{\\ln(r) - \\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} $$\n这也可以写成 $v(r) = \\frac{\\ln(r/r_2)}{\\ln(r_1/r_2)}$ 或 $v(r) = \\frac{\\ln(r_2/r)}{\\ln(r_2/r_1)}$。\n\n结合这些结果，概率 $u(r) = \\mathbb{P}(\\|B_\\tau\\| = r_1 \\mid \\|B_0\\|=r)$ 由以下关于 $r$、$r_1$、$r_2$ 和维度 $d$ 的分段函数给出。", "answer": "$$\n\\boxed{\nu(r) = \\begin{cases} \\frac{r^{2-d} - r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}}  \\text{if } d \\neq 2 \\\\ \\frac{\\ln(r) - \\ln(r_2)}{\\ln(r_1) - \\ln(r_2)}  \\text{if } d = 2 \\end{cases}\n}\n$$", "id": "2974725"}, {"introduction": "这项进阶练习深入探讨了更复杂随机过程的边界行为的精妙之处。通过研究贝塞尔过程（Bessel process），您将应用 Feller 的边界分类理论来判断一个边界点对该过程是否可达[@problem_id:2974762]。这种分析并非纯粹的理论探讨，它对于正确地构建问题以计算平均出界时间至关重要，展示了对边界类型的深刻理解是解决实际问题的关键。", "problem": "考虑状态空间 $(0,\\infty)$ 上维数为 $\\delta0$ 的贝塞尔扩散（记作 $\\operatorname{BES}(\\delta)$），它从 $X_{0}=x\\in(0,\\infty)$ 出发，定义为以下随机微分方程的唯一强解：\n$$\ndX_{t} \\;=\\; dB_{t} \\;+\\; \\frac{\\delta-1}{2\\,X_{t}}\\,dt,\n$$\n其中 $B_{t}$ 是一维标准布朗运动。固定一个半径 $R0$，定义首次离开有界区间 $(0,R)$ 的时间为\n$$\n\\tau_{(0,R)} \\;=\\; \\inf\\{ t\\ge 0 : X_{t}\\notin(0,R)\\}.\n$$\n使用 Feller 基于标度函数和速度测度的边界分类法，分析端点 $0$ 在 $\\delta2$、$\\delta=2$ 和 $\\delta\\in(0,2)$ 这三种参数情形下的性质。对于每种情形，在 $R$ 处为吸收边界条件、在 $0$ 处的边界行为由分类决定的约定下，定性地预测当 $x\\in(0,R)$ 时，平均离开时间 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 是有限、无穷还是零。然后，对于 $\\delta2$ 的特定情形，仅使用无穷小生成元、Dynkin 公式和边界类型的标度-速度刻画这些基础工具，从第一性原理出发，推导 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 作为 $x$、$R$ 和 $\\delta$ 的函数的精确表达式。你的最终答案必须是关于 $x$、$R$ 和 $\\delta$ 的单个闭式表达式。不需要四舍五入，也不涉及物理单位。", "solution": "该问题要求分析贝塞尔过程从区间 $(0,R)$ 离开的时间。过程 $X_t$ 由随机微分方程 (SDE) 定义：\n$$\ndX_{t} \\;=\\; dB_{t} \\;+\\; \\frac{\\delta-1}{2\\,X_{t}}\\,dt\n$$\n其中 $\\delta  0$ 是维数，$X_0 = x \\in (0,R)$，而 $B_t$ 是一维标准布朗运动。\n\n解答过程分为三部分。首先，我们使用 Feller 的边界分类法对 $0$ 处的边界进行分类。其次，我们利用此分类来定性判断平均离开时间 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 是有限还是无穷。第三，我们推导在 $\\delta2$ 情形下该平均离开时间的精确表达式。\n\n该 SDE 具有 $dX_t = \\mu(X_t)dt + \\sigma(X_t)dB_t$ 的形式，其中漂移系数为 $\\mu(x) = \\frac{\\delta-1}{2x}$，扩散系数为 $\\sigma(x)=1$。\n\n**第一部分：Feller 边界分类**\n\n对一个边界点的 Feller 分类取决于该点附近标度函数密度和速度测度密度的可积性。\n标度函数密度 $s(x)$ 由下式给出：\n$$\ns(x) = \\exp\\left(-\\int \\frac{2\\mu(y)}{\\sigma^2(y)} dy\\right) = \\exp\\left(-\\int \\frac{2(\\delta-1)/(2y)}{1^2} dy\\right) = \\exp\\left(-(\\delta-1)\\ln x\\right) = x^{1-\\delta}\n$$\n速度测度密度 $m(x)$ 由下式给出：\n$$\nm(x) = \\frac{2}{\\sigma^2(x)s(x)} = \\frac{2}{1 \\cdot x^{1-\\delta}} = 2x^{\\delta-1}\n$$\n为了对 $0$ 处的边界进行分类，我们考察 $s(x)$ 和 $m(x)$ 在某个区间 $(0,c]$ (其中 $c0$) 上的积分的收敛性。我们取 $c=1$。\n\n标度密度的积分为：\n$$\n\\int_0^1 s(x)\\,dx = \\int_0^1 x^{1-\\delta}\\,dx\n$$\n该积分收敛，如果指数 $1-\\delta$ 大于 $-1$，即 $\\delta  2$。如果 $\\delta \\ge 2$，则该积分发散。\n\n速度测度密度的积分为：\n$$\n\\int_0^1 m(x)\\,dx = \\int_0^1 2x^{\\delta-1}\\,dx\n$$\n该积分收敛，如果指数 $\\delta-1$ 大于 $-1$，即 $\\delta > 0$。由于问题陈述中 $\\delta0$，该积分总是收敛的。\n\n使用标准的分类方案（例如 Karatzas 和 Shreve 的方案），根据 $s(x)$ 的积分（记为 $I_s$）和 $m(x)$ 的积分（记为 $I_m$）的收敛性，边界分类如下：\n- 正则边界：$I_s  \\infty$ 且 $I_m  \\infty$。\n- 进入边界：$I_s = \\infty$ 且 $I_m  \\infty$。\n- 离开边界：$I_s  \\infty$ 且 $I_m = \\infty$。\n- 自然边界：$I_s = \\infty$ 且 $I_m = \\infty$。\n\n将此应用于贝塞尔过程在 $0$ 处的边界：\n1.  **情形 $\\delta \\in (0, 2)$**：$I_s = \\int_0^1 x^{1-\\delta}\\,dx  \\infty$ 且 $I_m = \\int_0^1 2x^{\\delta-1}\\,dx  \\infty$。$0$ 处的边界是**正则边界**。正则边界是可达的，意味着过程可以在有限时间内以正概率到达它。\n2.  **情形 $\\delta = 2$**：$I_s = \\int_0^1 x^{-1}\\,dx = \\infty$ 且 $I_m = \\int_0^1 2x\\,dx  \\infty$。$0$ 处的边界是**进入边界**。\n3.  **情形 $\\delta > 2$**：$I_s = \\int_0^1 x^{1-\\delta}\\,dx = \\infty$ 且 $I_m = \\int_0^1 2x^{\\delta-1}\\,dx  \\infty$。$0$ 处的边界是**进入边界**。\n\n进入边界从状态空间的内部是不可达的。这意味着对于 $\\delta \\ge 2$，从 $x>0$ 出发的过程 $X_t$ 几乎必然永远不会到达 $0$。\n\n**第二部分：对平均离开时间的定性预测**\n\n令 $u(x) = \\mathbb{E}_{x}[\\tau_{(0,R)}]$，其中 $\\tau_{(0,R)} = \\inf\\{ t\\ge 0 : X_{t}\\notin(0,R)\\}$。在 $R$ 处的边界是吸收的。在 $0$ 处的行为“由分类决定”。\n- 对于 $\\delta \\in (0, 2)$，$0$ 处的边界是正则的，因此是可达的。离开 $(0,R)$ 意味着过程在碰到 $0$ 或 $R$ 时停止。这对应于在两端施加吸收边界条件。对于一个在有限区间上、具有两个可达吸收边界的扩散过程，其平均离开时间是有限的。\n- 对于 $\\delta \\ge 2$，$0$ 处的边界是进入边界，因此是不可达的。过程永远不能从 $0$ 处离开。因此，离开区间 $(0,R)$ 等价于到达边界 $R$。所以，$\\tau_{(0,R)} = \\tau_R = \\inf\\{t \\ge 0 : X_t=R\\}$。\n    - 对于 $\\delta > 2$，漂移 $\\mu(x) = (\\delta-1)/(2x)$ 是正的，将过程从 $0$ 推向 $R$。\n    - 对于 $\\delta = 2$，漂移 $\\mu(x)=1/(2x)$ 也是正的，将过程从 $0$ 推开。\n在 $\\delta \\ge 2$ 的两种子情形下，过程被推向 $R$ 处的出口，并且不会在不可达的边界 $0$ 处卡住。这表明到达 $R$ 的平均时间是有限的。\n\n因此，对于所有三种情形，定性预测是平均离开时间 $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ 是**有限的**。值为 $0$ 是不可能的，因为 $x \\in (0,R)$，并且我们的分析表明不期望是“无穷”。\n\n**第三部分：$\\delta > 2$ 情形的推导**\n\n对于 $\\delta > 2$ 的情形，我们寻求 $u(x) = \\mathbb{E}_{x}[\\tau_{(0,R)}]$ 的精确表达式。如前所述，$0$ 处的边界是不可达的，所以 $\\tau_{(0,R)} = \\tau_R$。函数 $u(x)$ 满足由 Dynkin 公式给出的常微分方程：\n$$\n\\mathcal{L}u(x) = -1\n$$\n其中 $\\mathcal{L}$ 是过程的无穷小生成元：\n$$\n\\mathcal{L} = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma^2(x)\\frac{d^2}{dx^2} = \\frac{\\delta-1}{2x}\\frac{d}{dx} + \\frac{1}{2}\\frac{d^2}{dx^2}\n$$\n所以常微分方程 (ODE) 是：\n$$\n\\frac{1}{2}u''(x) + \\frac{\\delta-1}{2x}u'(x) = -1\n$$\n边界条件是：\n1.  在 $R$ 处的吸收边界：$u(R) = 0$。\n2.  在 $0$ 处的不可达边界：当 $x \\to 0^{+}$ 时，解 $u(x)$ 必须是正则的（例如，有界的）。\n\n让我们求解这个 ODE。令 $v(x) = u'(x)$。该方程变成了一个关于 $v(x)$ 的一阶线性 ODE：\n$$\nv'(x) + \\frac{\\delta-1}{x}v(x) = -2\n$$\n积分因子是 $I(x) = \\exp\\left(\\int \\frac{\\delta-1}{x} dx\\right) = \\exp((\\delta-1)\\ln x) = x^{\\delta-1}$。将 ODE 两边乘以 $I(x)$：\n$$\n\\left(x^{\\delta-1}v(x)\\right)' = -2x^{\\delta-1}\n$$\n对 $x$ 积分：\n$$\nx^{\\delta-1}v(x) = \\int -2x^{\\delta-1} dx = -2\\frac{x^\\delta}{\\delta} + C_1\n$$\n其中 $C_1$ 是一个积分常数。求解 $v(x) = u'(x)$:\n$$\nu'(x) = -\\frac{2x}{\\delta} + C_1 x^{1-\\delta}\n$$\n再次积分以求得 $u(x)$:\n$$\nu(x) = \\int\\left(-\\frac{2x}{\\delta} + C_1 x^{1-\\delta}\\right) dx\n$$\n由于 $\\delta > 2$，我们有 $\\delta \\ne 2$，所以我们可以对第二项进行积分：\n$$\nu(x) = -\\frac{x^2}{\\delta} + C_1 \\frac{x^{2-\\delta}}{2-\\delta} + C_2\n$$\n其中 $C_2$ 是另一个积分常数。现在我们应用边界条件。\n首先，考虑在 $x=0$ 处的正则性条件。由于 $\\delta > 2$，指数 $2-\\delta$ 是负的。当 $x \\to 0^{+}$ 时，$x^{2-\\delta}$ 项发散到无穷大。为了使 $u(x)$ 保持有界，以满足不可达边界处的正则性要求，这个发散项的系数必须为零。因此，我们必须有 $C_1=0$。\n\n当 $C_1=0$ 时，解简化为：\n$$\nu(x) = -\\frac{x^2}{\\delta} + C_2\n$$\n现在，我们在 $x=R$ 处应用吸收边界条件：\n$$\nu(R) = 0 \\implies -\\frac{R^2}{\\delta} + C_2 = 0 \\implies C_2 = \\frac{R^2}{\\delta}\n$$\n将 $C_2$ 代回到 $u(x)$ 的解中，得到平均离开时间的最终表达式：\n$$\nu(x) = \\frac{R^2}{\\delta} - \\frac{x^2}{\\delta} = \\frac{R^2 - x^2}{\\delta}\n$$\n这个函数对于所有 $x \\in (0,R)$ 都是正且有限的，这与我们的定性预测一致。", "answer": "$$\n\\boxed{\\frac{R^2 - x^2}{\\delta}}\n$$", "id": "2974762"}]}