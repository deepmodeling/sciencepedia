{"hands_on_practices": [{"introduction": "$\\theta$方法是求解偏微分方程的强大框架，它通过一个参数$\\theta$统一了从完全显式到完全隐式的一系列格式。本练习将指导你使用冯·诺依曼稳定性分析，推导一维线性平流方程的$\\theta$方法的稳定性条件。通过这个过程，你将揭示参数$\\theta$如何控制格式的稳定性边界，并理解显式和隐式方法之间的根本差异。", "problem": "考虑一维线性平流方程，它描述了标量 $u(x,t)$ 以恒定正速度 $c > 0$ 的输运过程：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n\n该偏微分方程可以被离散化并进行数值求解。一种常见的有限差分方法族是$\\theta$方法。由于 $c > 0$，我们将对空间导数使用一阶迎风格式（具体来说，是后向差分）。由此得到的关于 $u_j^n \\approx u(j\\Delta x, n\\Delta t)$ 的有限差分方程为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left[ (1-\\theta) \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\theta \\left( \\frac{u_j^{n+1} - u_{j-1}^{n+1}}{\\Delta x} \\right) \\right] = 0\n$$\n其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是网格间距，而 $\\theta \\in [0, 1]$ 是一个参数，它混合了显式时间步进格式（$\\theta=0$，前向欧拉法）和隐式格式（$\\theta=1$，后向欧拉法）。\n\n该数值格式的稳定性可以通过冯·诺依曼稳定性分析来研究。我们寻求形如 $u_j^n = g^n e^{i k j \\Delta x}$ 的解，其中 $k$ 是波数，$g = g(k)$ 是放大因子。该格式是稳定的，当且仅当对于所有可能的波数 $k$，都有 $|g| \\le 1$。\n\n一个已知的结论是，对于 $\\theta \\in [1/2, 1]$，此格式对任意正库朗数 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 都是无条件稳定的。然而，对于 $\\theta \\in [0, 1/2)$，该格式仅是条件稳定的。\n\n你的任务是推导在 $\\theta \\in [0, 1/2)$ 范围内，保证该格式稳定性的最大允许库朗数 $\\sigma_{\\text{max}}$ 作为参数 $\\theta$ 的函数表达式。", "solution": "我们将冯·诺依曼分析应用于$\\theta$方法迎风格式。设 $\\sigma=c\\Delta t/\\Delta x$ 和试探解 $u_j^n=g^n e^{i\\xi j}$，其中 $\\xi = k\\Delta x$。代入格式后，放大因子 $g$ 满足：\n$$g\\bigl[(1+\\theta\\sigma)- \\theta\\sigma e^{-i\\xi}\\bigr]=(1-\\sigma+\\theta\\sigma)+(\\sigma-\\theta\\sigma)e^{-i\\xi}$$\n为了分析方便，我们定义 $A=1-\\sigma+\\theta\\sigma$, $B=\\sigma(1-\\theta)$, $C=1+\\theta\\sigma$, $D=\\theta\\sigma$，从而：\n$$g=\\frac{A+Be^{-i\\xi}}{C-De^{-i\\xi}}$$\n因此，其模的平方为：\n$$|g|^2=\\frac{A^2+B^2+2AB\\cos \\xi}{C^2+D^2-2CD\\cos \\xi}$$\n稳定性要求 $|g|^2 \\le 1$ 对所有 $\\xi$ 成立，即 $A^2+B^2+2AB\\cos \\xi\\le C^2+D^2-2CD\\cos \\xi$。\n整理得 $(A^2+B^2-C^2-D^2) + 2(AB+CD)\\cos \\xi \\le 0$。\n我们已经计算出 $E=A^2+B^2-C^2-D^2=-2\\sigma+2\\sigma^2(1-2\\theta)$ 和 $AB+CD=\\sigma\\bigl[1-\\sigma(1-2\\theta)\\bigr]$。\n最坏情况发生在 $\\cos \\xi=-1$ 时，此时不等式为 $E-2(AB+CD)\\le0$。代入表达式并化简得到：\n$$(-2\\sigma+2\\sigma^2(1-2\\theta)) - 2\\sigma(1-\\sigma(1-2\\theta)) \\le 0$$\n$$-4\\sigma + 4\\sigma^2(1-2\\theta) \\le 0$$\n$$4\\sigma[\\sigma(1-2\\theta)-1] \\le 0$$\n由于 $\\sigma>0$，上式等价于 $\\sigma(1-2\\theta)-1 \\le 0$。对于 $\\theta \\in [0, 1/2)$，$1-2\\theta > 0$，因此稳定性条件为：\n$$\\sigma \\le \\frac{1}{1-2\\theta}$$\n所以，对于 $\\theta\\in[0,1/2)$，稳定性极限为：\n$$\\sigma_{\\max}=\\frac{1}{1-2\\theta}$$", "answer": "$$\\boxed{\\frac{1}{1-2\\theta}}$$", "id": "1128167"}, {"introduction": "将稳定性分析从一维推广到多维是数值模拟中的关键一步。本练习将你在之前问题中学到的冯·诺依曼分析方法应用于二维线性平流方程[@problem_id:1128167]。你的任务是推导二维情况下的 Courant-Friedrichs-Lewy (CFL) 条件，理解来自不同空间维度的库朗数如何共同约束时间步长。", "problem": "考虑标量场 $u(x, y, t)$ 的二维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + c_x \\frac{\\partial u}{\\partial x} + c_y \\frac{\\partial u}{\\partial y} = 0\n$$\n其中 $c_x$ 和 $c_y$ 分别是 $x$ 和 $y$ 方向上恒为正的平流速度。\n\n该方程在均匀方形网格上进行离散化，两个方向上的空间步长均为 $h$（$\\Delta x = \\Delta y = h$），时间步长为 $\\Delta t$。在网格点 $(x_i, y_j)$ 和时间 $t^n$ 处的数值近似值用 $u_{i,j}^n$ 表示。该格式对时间导数使用前向欧拉法，对空间导数使用一阶迎风格式。假定 $c_x > 0$ 且 $c_y > 0$，此迎风格式由下式给出：\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i-1,j}^n}{h} \\quad \\text{和} \\quad \\frac{\\partial u}{\\partial y}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i,j-1}^n}{h}\n$$\n此数值格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定，该条件对库朗数 $\\lambda_x = \\frac{c_x \\Delta t}{h}$ 和 $\\lambda_y = \\frac{c_y \\Delta t}{h}$ 施加上限。具体而言，为使格式对所有可能的初始条件都稳定，库朗数之和 $S = \\lambda_x + \\lambda_y$ 必须满足不等式 $S \\le S_{max}$，其中 $S_{max}$ 为某个常数。\n\n使用 Von Neumann 稳定性分析，推导库朗数之和的最大允许值 $S_{max}$。", "solution": "1.  **离散方程**：迎风格式的更新方程为\n    $$\n    u_{i,j}^{n+1}\n    = u_{i,j}^n - \\lambda_x\\bigl(u_{i,j}^n - u_{i-1,j}^n\\bigr)\n                - \\lambda_y\\bigl(u_{i,j}^n - u_{i,j-1}^n\\bigr)\n    $$\n    其中 $\\lambda_x = \\frac{c_x\\Delta t}{h}$ 和 $\\lambda_y = \\frac{c_y\\Delta t}{h}$ 是库朗数，$S=\\lambda_x+\\lambda_y$ 是它们的和。\n\n2.  **冯·诺依曼分析**：假设一个傅里叶模式解 $u_{i,j}^n = G^n e^{i(k_x x_i + k_y y_j)}$。将其代入离散方程，可以得到放大因子 $G$ 的表达式：\n    $$\n    G = 1 - \\lambda_x\\bigl(1 - e^{-i\\theta_x}\\bigr)\n          - \\lambda_y\\bigl(1 - e^{-i\\theta_y}\\bigr)\n    $$\n    其中 $\\theta_x = k_x h$ 和 $\\theta_y = k_y h$ 是无量纲波数。\n\n3.  **稳定性条件**：为保证稳定性，我们要求对于所有的 $\\theta_x, \\theta_y$ 都有 $|G|\\le1$。放大因子 $G$ 在复平面上形成一个区域。我们需要找到该区域中最远离原点的点，并确保它在单位圆内。最极端的情况发生在 $G$ 的值落在负实轴上且离原点最远时，这对应于 $\\theta_x=\\pi$ 和 $\\theta_y=\\pi$。此时 $e^{-i\\pi}=-1$，所以：\n    $$\n    G = 1 - \\lambda_x(1-(-1)) - \\lambda_y(1-(-1))\n    = 1 - 2\\lambda_x - 2\\lambda_y = 1 - 2S\n    $$\n    稳定性条件 $|G| \\le 1$ 在此点变为：\n    $$\n    |1 - 2S|\\le1\n    $$\n    这可以分解为两个不等式：\n    $$\n    -1 \\le 1-2S \\le 1\n    $$\n    右半部分 $1-2S \\le 1$ 给出 $-2S \\le 0$，即 $S \\ge 0$，由于 $\\lambda_x, \\lambda_y \\ge 0$，这个条件总是满足的。\n    左半部分 $-1 \\le 1-2S$ 给出 $2S \\le 2$，即 $S \\le 1$。\n\n    因此，库朗数之和的最大允许值为：\n    $$\n    S_{\\max} = 1\n    $$", "answer": "$$\\boxed{1}$$", "id": "1128038"}, {"introduction": "当处理带有特定边界条件的有限域问题时，矩阵法提供了冯·诺依曼分析之外的另一种有力工具。本练习将探讨波动方程的前向时间中心空间（FTCS）格式，这是一个经典的无条件不稳定格式。通过构建并分析其放大矩阵，你将量化这种不稳定性，并理解为何某些看似合理的离散化方法在实践中是不可行的。", "problem": "一维波动方程由以下公式给出：\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n对于函数 $u(x,t)$，其空间域为 $x \\in [0, L]$，时间为 $t \\ge 0$。参数 $c$ 是恒定的波速。该方程满足狄利克雷边界条件，$u(0,t) = u(L,t) = 0$。\n\n为了数值求解该方程，首先通过引入一个辅助函数 $v(x,t) = \\frac{\\partial u}{\\partial t}$，将其转换为一个一阶偏微分方程组：\n$$\n\\frac{\\partial u}{\\partial t} = v \\\\\n\\frac{\\partial v}{\\partial t} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n通过将空间域离散化为 $N$ 个等宽区间 $\\Delta x = L/N$ 来构建数值格式，网格点为 $x_j = j\\Delta x$，其中 $j=0, 1, \\dots, N$。令 $u_j^n \\approx u(x_j, n\\Delta t)$ 且 $v_j^n \\approx v(x_j, n\\Delta t)$，其中 $\\Delta t$ 是时间步长。\n\n“时间向前，空间居中”(FTCS) 格式应用于该系统：对两个方程均使用时间上的向前差分，对空间导数使用二阶中心差分。\n$$\n\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = v_j^n \\\\\n\\frac{v_j^{n+1}-v_j^n}{\\Delta t} = c^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n已知该格式是无条件不稳定的。你的任务是量化这种不稳定性。通过考虑内部网格点向量 $\\mathbf{W}^n = [\\mathbf{U}^n, \\mathbf{V}^n]^T$ 的演化，其中 $\\mathbf{U}^n = [u_1^n, \\dots, u_{N-1}^n]^T$ 且 $\\mathbf{V}^n = [v_1^n, \\dots, v_{N-1}^n]^T$，该格式可以写成矩阵形式 $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$。\n\n使用稳定性分析的矩阵方法，推导放大矩阵 $M$ 的谱半径 $\\rho(M)$ 的表达式。用库朗数 $\\lambda = \\frac{c\\Delta t}{\\Delta x}$ 和空间区间数 $N$ 来表示你的最终答案。", "solution": "给定的数值格式是：\n$$\nu_j^{n+1} = u_j^n + \\Delta t \\, v_j^n\n$$\n$$\nv_j^{n+1} = v_j^n + c^2 \\frac{\\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n我们使用狄利克雷边界条件 $u_0^n = u_N^n = 0$，在内部网格点 $j=1, 2, \\dots, N-1$ 上分析该格式。\n\n令 $\\mathbf{U}^n = [u_1^n, u_2^n, \\dots, u_{N-1}^n]^T$ 且 $\\mathbf{V}^n = [v_1^n, v_2^n, \\dots, v_{N-1}^n]^T$。该方程组可以写成矩阵形式。空间二阶导数由 $(N-1) \\times (N-1)$ 的三对角矩阵 $A$ 表示：\n$$\nA = \\begin{pmatrix}\n-2 & 1 & 0 & \\cdots & 0 \\\\\n1 & -2 & 1 & \\cdots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & & 1 & -2 & 1 \\\\\n0 & \\cdots & 0 & 1 & -2\n\\end{pmatrix}\n$$\n令库朗数为 $\\lambda = \\frac{c\\Delta t}{\\Delta x}$，差分方程组变为：\n$$\n\\mathbf{U}^{n+1} = I \\mathbf{U}^n + (\\Delta t) I \\mathbf{V}^n\n$$\n$$\n\\mathbf{V}^{n+1} = \\frac{\\lambda^2}{\\Delta t} A \\mathbf{U}^n + I \\mathbf{V}^n\n$$\n其中 $I$ 是 $(N-1) \\times (N-1)$ 的单位矩阵。\n\n我们构建一个状态向量 $\\mathbf{W}^n = \\begin{pmatrix} \\mathbf{U}^n \\\\ \\mathbf{V}^n \\end{pmatrix}$。于是该格式为 $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$，其中放大矩阵 $M$ 是一个 $2(N-1) \\times 2(N-1)$ 的分块矩阵：\n$$\nM = \\begin{pmatrix}\nI & (\\Delta t) I \\\\\n\\frac{\\lambda^2}{\\Delta t} A & I\n\\end{pmatrix}\n$$\n为了求谱半径 $\\rho(M)$，我们需要矩阵 $M$ 的特征值。令 $\\mu$ 为 $M$ 的一个特征值，$\\mathbf{w} = \\begin{pmatrix} \\mathbf{w}_1 \\\\ \\mathbf{w}_2 \\end{pmatrix}$ 为对应的特征向量，其中 $\\mathbf{w}_1, \\mathbf{w}_2$ 是 $(N-1)$ 维向量。特征值问题 $M\\mathbf{w} = \\mu\\mathbf{w}$ 得到一个包含两个方程的方程组：\n$$\n(1-\\mu) \\mathbf{w}_1 + (\\Delta t) \\mathbf{w}_2 = \\mathbf{0}\n$$\n$$\n\\frac{\\lambda^2}{\\Delta t} A \\mathbf{w}_1 + (1-\\mu) \\mathbf{w}_2 = \\mathbf{0}\n$$\n为了使该系统有非平凡解，$\\mathbf{w}_1$ 和 $\\mathbf{w}_2$ 必须与 $A$ 的一个特征向量 $\\mathbf{v}_k$ 成比例，其对应的特征值为 $\\alpha_k$。这使得问题简化为一个标量系统的行列式必须为零：\n$$\n\\det \\begin{pmatrix}\n1-\\mu & \\Delta t \\\\\n\\frac{\\lambda^2 \\alpha_k}{\\Delta t} & 1-\\mu\n\\end{pmatrix} = 0\n$$\n$$\n(1-\\mu)^2 - \\lambda^2 \\alpha_k = 0\n$$\n矩阵 $A$ 的特征值是众所周知的：\n$$\n\\alpha_k = -4 \\sin^2\\left(\\frac{k\\pi}{2N}\\right), \\quad k=1, 2, \\dots, N-1\n$$\n将 $\\alpha_k$ 代入关于 $\\mu$ 的方程：\n$$\n(1-\\mu)^2 = -4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)\n$$\n对两边取平方根：\n$$\n1-\\mu = \\pm \\sqrt{-4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)} = \\pm 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\n因此，放大矩阵 $M$ 的特征值 $\\mu_k$ 为：\n$$\n\\mu_k = 1 \\mp 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\n这些复特征值的模为：\n$$\n|\\mu_k| = \\sqrt{1^2 + \\left( \\pm 2\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right) \\right)^2} = \\sqrt{1 + 4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)}\n$$\n谱半径 $\\rho(M)$ 是这些模在所有可能的 $k$ 值上的最大值：\n$$\n\\rho(M) = \\max_{k=1, \\dots, N-1} |\\mu_k| = \\max_{k=1, \\dots, N-1} \\sqrt{1 + 4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)}\n$$\n为了找到最大值，我们需要最大化 $\\sin^2\\left(\\frac{k\\pi}{2N}\\right)$。当 $k$ 的取值范围为 $1$ 到 $N-1$ 时，参数 $\\frac{k\\pi}{2N}$ 位于区间 $(0, \\pi/2)$ 内。由于 $\\sin(x)$ 在 $[0, \\pi/2]$ 上是递增函数，其最大值在 $k$ 取最大值时达到，即 $k=N-1$。\n正弦项的最大值是 $\\sin\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2N}\\right) = \\cos\\left(\\frac{\\pi}{2N}\\right)$。\n将此代入谱半径的表达式：\n$$\n\\rho(M) = \\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}\n$$\n对于任何 $\\lambda > 0$ 和任何有限的 $N \\ge 2$，$\\cos(\\frac{\\pi}{2N}) > 0$，因此 $\\rho(M) > 1$。这证实了该格式是无条件不稳定的，因为无论如何选择 $\\Delta t$ 和 $\\Delta x$，至少有一个特征值的模总是大于1。", "answer": "$$\n\\boxed{\\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}}\n$$", "id": "1128196"}]}