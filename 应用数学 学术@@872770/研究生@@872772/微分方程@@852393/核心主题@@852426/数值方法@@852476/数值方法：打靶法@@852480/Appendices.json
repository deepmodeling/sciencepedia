{"hands_on_practices": [{"introduction": "要真正掌握打靶法，最好的起点是将其应用于线性问题，因为在线性问题中，其内在结构最为清晰。对于线性常微分方程，叠加原理允许我们通过代数方法精确求解正确的初始“发射”斜率，而无需进行猜测或迭代。这个练习 [@problem_id:1127615] 将引导你为一个受迫谐振子推导出所需的精确初始斜率，从而巩固你对叠加原理的理解。", "problem": "一个物理系统由一个描述受迫谐振子的非齐次线性常微分方程 (ODE) 描述：\n$$y''(x) + k^2 y(x) = f(x)$$\n其中 $k$ 是一个代表振子固有频率的正常数。该系统定义在域 $x \\in [0, L]$ 上，并服从边界条件 $y(0) = \\alpha$ 和 $y(L) = \\beta$。外部驱动函数是线性的，由 $f(x) = Cx$ 给出，其中 $C$ 是一个常数。\n\n为了求解这个边值问题 (BVP)，可以使用打靶法。这种数值技术通过为初始斜率 $s = y'(0)$ 选择一个试探值，将 BVP 转换为一个初值问题 (IVP)。IVP 的解（记为 $y(x; s)$）取决于 $s$ 的选择。正确的斜率 $s$ 是能使解满足第二个边界条件的值，即 $y(L; s) = \\beta$。\n\n对于线性 ODE，这个过程可以解析地进行。解 $y(x; s)$ 可以表示为两个更简单的 IVP 解的线性组合。令 $u(x)$ 为以下 IVP 的解：\n$$u'' + k^2 u = Cx, \\quad u(0) = \\alpha, \\quad u'(0) = 0$$\n并令 $v(x)$ 为以下齐次 IVP 的解：\n$$v'' + k^2 v = 0, \\quad v(0) = 0, \\quad v'(0) = 1$$\n具有初始斜率 $s$ 的 BVP 对应 IVP 的解则由叠加原理 $y(x; s) = u(x) + s \\cdot v(x)$ 给出。\n\n使用打靶法的这种解析形式，推导所需初始斜率 $s = y'(0)$ 关于参数 $k、L、C、\\alpha$ 和 $\\beta$ 的闭式表达式。假设对任意整数 $n$ 都有 $kL \\neq n\\pi$，这确保了唯一解的存在。", "solution": "目标是找到初始斜率 $s = y'(0)$，使得初值问题的解 $y(x; s)$ 满足在 $x=L$ 处的边界条件。解由线性叠加给出：\n$$y(x; s) = u(x) + s \\cdot v(x)$$\n我们必须施加边界条件 $y(L; s) = \\beta$：\n$$u(L) + s \\cdot v(L) = \\beta$$\n解出未知斜率 $s$ 可得：\n$$s = \\frac{\\beta - u(L)}{v(L)}$$\n为了使用这个公式，我们首先需要求解两个指定的初值问题，得到解 $u(x)$ 和 $v(x)$。\n\n**1. 求解 $u(x)$**\n\n$u(x)$ 的 IVP 为：\n$$u'' + k^2 u = Cx, \\quad u(0) = \\alpha, \\quad u'(0) = 0$$\n通解是齐次解 $u_h(x)$ 和一个特解 $u_p(x)$ 的和。\n齐次方程 $u_h'' + k^2 u_h = 0$ 的解为：\n$$u_h(x) = A \\cos(kx) + B \\sin(kx)$$\n对于特解，我们使用待定系数法。由于驱动项是 $Cx$，我们尝试一个形式为 $u_p(x) = D_1 x + D_0$ 的解。\n将其代入 ODE：\n$$u_p''(x) + k^2 u_p(x) = 0 + k^2(D_1 x + D_0) = k^2 D_1 x + k^2 D_0$$\n与驱动项 $Cx$ 比较，我们得到 $k^2 D_1 = C$ 和 $k^2 D_0 = 0$。这给出 $D_1 = C/k^2$ 和 $D_0 = 0$。\n因此，特解是 $u_p(x) = \\frac{C}{k^2}x$。\n$u(x)$ 的通解是：\n$$u(x) = A \\cos(kx) + B \\sin(kx) + \\frac{C}{k^2}x$$\n现在，我们应用 $u(x)$ 的初始条件。\n$u(0) = A \\cos(0) + B \\sin(0) + 0 = A$。根据 $u(0)=\\alpha$，我们得到 $A = \\alpha$。\n导数是 $u'(x) = -kA \\sin(kx) + kB \\cos(kx) + \\frac{C}{k^2}$。\n$u'(0) = -kA \\sin(0) + kB \\cos(0) + \\frac{C}{k^2} = kB + \\frac{C}{k^2}$。根据 $u'(0)=0$，我们得到 $kB + \\frac{C}{k^2} = 0$，这意味着 $B = -\\frac{C}{k^3}$。\n因此，$u(x)$ 的解是：\n$$u(x) = \\alpha \\cos(kx) - \\frac{C}{k^3} \\sin(kx) + \\frac{C}{k^2}x$$\n\n**2. 求解 $v(x)$**\n\n$v(x)$ 的 IVP 为：\n$$v'' + k^2 v = 0, \\quad v(0) = 0, \\quad v'(0) = 1$$\n这是一个齐次 ODE。其通解是：\n$$v(x) = F \\cos(kx) + G \\sin(kx)$$\n应用 $v(x)$ 的初始条件：\n$v(0) = F \\cos(0) + G \\sin(0) = F$。根据 $v(0)=0$，我们得到 $F=0$。\n导数是 $v'(x) = -kF \\sin(kx) + kG \\cos(kx)$。\n$v'(0) = -kF \\sin(0) + kG \\cos(0) = kG$。根据 $v'(0)=1$，我们得到 $kG=1$，这意味着 $G = \\frac{1}{k}$。\n因此，$v(x)$ 的解是：\n$$v(x) = \\frac{1}{k} \\sin(kx)$$\n\n**3. 计算初始斜率 $s$**\n\n现在我们在 $x=L$ 处计算 $u(x)$ 和 $v(x)$ 的值：\n$$u(L) = \\alpha \\cos(kL) - \\frac{C}{k^3} \\sin(kL) + \\frac{CL}{k^2}$$\n$$v(L) = \\frac{1}{k} \\sin(kL)$$\n注意，条件 $kL \\neq n\\pi$ 确保了 $\\sin(kL) \\neq 0$，因此 $v(L) \\neq 0$。\n最后，我们将这些代入 $s$ 的表达式中：\n$$s = \\frac{\\beta - u(L)}{v(L)} = \\frac{\\beta - \\left(\\alpha \\cos(kL) - \\frac{C}{k^3} \\sin(kL) + \\frac{CL}{k^2}\\right)}{\\frac{1}{k} \\sin(kL)}$$\n整理上式可得：\n$$s = \\frac{k}{\\sin(kL)} \\left( \\beta - \\alpha \\cos(kL) + \\frac{C}{k^3} \\sin(kL) - \\frac{CL}{k^2} \\right)$$\n将项 $\\frac{k}{\\sin(kL)}$ 分配进去：\n$$s = \\frac{k\\beta}{\\sin(kL)} - \\frac{k\\alpha \\cos(kL)}{\\sin(kL)} + \\frac{k}{\\sin(kL)}\\frac{C \\sin(kL)}{k^3} - \\frac{k}{\\sin(kL)}\\frac{CL}{k^2}$$\n简化每一项：\n$$s = k\\beta \\csc(kL) - k\\alpha \\cot(kL) + \\frac{C}{k^2} - \\frac{CL}{k} \\csc(kL)$$\n这个表达式给出了为满足边界条件所需的初始斜率 $s=y'(0)$。", "answer": "$$\\boxed{\\frac{C}{k^2} + k\\beta\\csc(kL) - k\\alpha\\cot(kL) - \\frac{CL}{k}\\csc(kL)}$$", "id": "1127615"}, {"introduction": "接下来，我们来处理一个非线性问题——单摆。在这种情况下，线性叠加原理不再适用，这通常迫使我们采用迭代数值方法。然而，这个问题 [@problem_id:1127651] 展示了一个特殊情况：我们可以利用一个基本的物理原理，即能量守恒定律，来找到一个优雅的、精确的初始速度解。这凸显了将数学模型与其物理根源联系起来的重要性。", "problem": "考虑一个简单非线性摆的无量纲运动方程：\n$$\n\\frac{d^2y}{dx^2} + \\sin(y) = 0\n$$\n其中 $y(x)$ 是作为无量纲时间 $x$ 的函数的、偏离垂直稳定平衡点的角位移。\n\n我们希望求解一个边值问题（BVP），其中摆锤从底部静止开始，即 $y(0) = 0$，并被赋予一个初始角速度，使其达到一个预设的最大振幅 $A$，其中 $0  A  \\pi$。在最大振幅处的条件意味着在某个时间 $x_f > 0$ 时，我们有 $y(x_f) = A$ 且角速度为零，即 $y'(x_f) = 0$。\n\n为了使用打靶法求解此 BVP，我们将其重新表述为一个初值问题（IVP）：\n$$\ny''(x) + \\sin(y) = 0, \\quad y(0) = 0, \\quad y'(0) = \\alpha\n$$\n参数 $\\alpha$ 是角速度的初始“发射”值。目标是找到 $\\alpha$ 的值，使得得到的轨迹 $y(x; \\alpha)$ 满足另一边界上的条件，即其最大值恰好为 $A$。\n\n无需进行数值迭代，请推导所需初始斜率 $\\alpha$ 作为目标最大振幅 $A$ 的函数的精确解析表达式。", "solution": "1. 将运动方程乘以 $y'$ 并积分，可以将其写成守恒形式：\n$y''+\\sin y=0 \\implies y'y''+y'\\sin y=0 \\implies \\frac{d}{dx}\\left(\\frac{1}{2}(y')^2-\\cos y\\right)=0$.\n2. 因此能量 $E=\\frac{1}{2}(y')^2-\\cos y$ 是恒定的。在 $x=0$ 时，$y(0)=0$，$y'(0)=\\alpha$，所以\n$E=\\frac{\\alpha^2}{2} - \\cos(0) = \\frac{\\alpha^2}{2}-1$.\n3. 在转折点 $x_f$ 处，$y(x_f)=A$，$y'(x_f)=0$，所以\n$E=0-\\cos A=-\\cos A$.\n4. 令能量相等，\n$$ \\frac{\\alpha^2}{2}-1 = -\\cos A \\implies \\frac{\\alpha^2}{2}=1-\\cos A \\implies \\alpha^2=2(1-\\cos A) = 4\\sin^2\\left(\\frac{A}{2}\\right) \\implies \\alpha=2\\sin\\left(\\frac{A}{2}\\right) $$", "answer": "$$\\boxed{2\\sin\\frac{A}{2}}$$", "id": "1127651"}, {"introduction": "在探索了分析解之后，让我们将注意力转向打靶法在处理数值数据时的实际应用。这个练习 [@problem_id:1127848] 模拟了一个常见的情景：辅助方程已经通过数值方法求解。你的任务是利用这些预先计算好的结果来构建最终解。这旨在检验你对打靶法实施步骤的理解，特别是如何运用叠加原理将数值输出组合成原始边值问题的正确答案。", "problem": "一个线性、非齐次的二阶边值问题 (BVP) 在区间 $[a, b]$ 上由以下微分方程定义\n$$y''(x) - p(x) y'(x) - q(x) y(x) = r(x)$$\n其边界条件为 $y(a) = \\alpha$ 和 $y(b) = \\beta$。\n\n打靶法是求解此类边值问题的一种数值技术。它依赖于线性叠加原理。解 $y(x)$ 可以由两个辅助初值问题 (IVP) 的解 $u(x)$ 和 $v(x)$ 构造得出。解由 $y(x) = u(x) + s \\cdot v(x)$ 给出，其中 $s$ 是初始未知的斜率 $y'(a)$，必须选择 $s$ 以满足在 $x=b$ 处的边界条件。\n\n第一个辅助问题，针对函数 $u(x)$，由原始的非齐次方程和特定的初始条件定义：\n$$u''(x) - p(x) u'(x) - q(x) u(x) = r(x), \\quad u(a) = \\alpha, \\quad u'(a) = 0$$\n\n第二个辅助问题，针对函数 $v(x)$，由相关的齐次方程和特定的初始条件定义：\n$$v''(x) - p(x) v'(x) - q(x) v(x) = 0, \\quad v(a) = 0, \\quad v'(a) = 1$$\n\n考虑一个在区间 $[a, b] = [0, 1]$ 上的特定边值问题，其边界条件为 $y(0) = 1$ 和 $y(1) = e+1$，其中 $e$ 是自然对数的底。对两个相应的辅助初值问题进行高精度数值积分，得到了 $u(x)$ 和 $v(x)$ 在中点 $x=0.5$ 和端点 $x=1$ 处的以下值：\n- $u(0.5) = \\sqrt{e} - \\frac{1}{2}$\n- $u(1) = e - 1$\n- $v(0.5) = \\sqrt{e} - 1$\n- $v(1) = e - 1$\n\n利用这些信息，确定该边值问题在中点 $x=0.5$ 处的解 $y(0.5)$ 的值。", "solution": "我们应用打靶法的表示形式\n$$y(x)=u(x)+s \\cdot v(x), \\quad s=\\frac{y(b)-u(b)}{v(b)}$$\n这里 $b=1$, $y(1)=e+1$, $u(1)=e-1$, $v(1)=e-1$，所以\n$$ s=\\frac{(e+1)-(e-1)}{e-1}=\\frac{2}{e-1} $$\n因此\n$$ y(x)=u(x)+\\frac{2}{e-1}v(x) $$\n在 $x=\\frac{1}{2}$ 处，我们有 $u\\left(\\frac{1}{2}\\right)=\\sqrt{e}-\\frac{1}{2}$，$v\\left(\\frac{1}{2}\\right)=\\sqrt{e}-1$，因此\n$$ y\\left(\\frac{1}{2}\\right) = \\left(\\sqrt{e}-\\frac{1}{2}\\right) + \\frac{2}{e-1}\\left(\\sqrt{e}-1\\right) $$\n注意到 $e-1=(\\sqrt{e}-1)(\\sqrt{e}+1)$，可得 $\\frac{\\sqrt{e}-1}{e-1}=\\frac{1}{\\sqrt{e}+1}$，因此\n$$ y\\left(\\frac{1}{2}\\right) = \\sqrt{e}-\\frac{1}{2}+\\frac{2}{\\sqrt{e}+1} $$", "answer": "$$\\boxed{\\sqrt{e} - \\frac12 + \\frac{2}{\\sqrt{e}+1}}$$", "id": "1127848"}]}