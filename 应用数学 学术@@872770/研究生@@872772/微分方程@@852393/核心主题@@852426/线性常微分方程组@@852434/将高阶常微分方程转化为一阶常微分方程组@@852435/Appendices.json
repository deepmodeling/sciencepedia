{"hands_on_practices": [{"introduction": "分析非线性动力学系统的第一步，通常是将其高阶微分方程转化为一阶方程组，以便在相空间中进行研究。这个练习 [@problem_id:1089504] 以一个广义的Duffing振子为例，其质量依赖于速度，这是一个在相对论动力学或流固耦合中可能遇到的情况。通过将其二阶非线性常微分方程转换为一阶系统，我们可以构建出描述系统在相空间中演化的向量场，为后续的数值求解和稳定性分析奠定基础。", "problem": "标准杜芬振子是研究非线性动力学和混沌的一个基本模型。在某些物理系统中，例如包含相对论运动学的系统或特定的流固耦合相互作用中，有效质量或惯性可能依赖于速度。\n\n考虑一个广义的、受迫的、阻尼的杜芬振子，其运动 $x(t)$ 由以下二阶非线性常微分方程描述：\n$$\nm_0 \\frac{d^2 x}{dt^2} \\left(1 - \\frac{1}{c^2}\\left(\\frac{dx}{dt}\\right)^2\\right)^{-3/2} + \\delta \\frac{dx}{dt} + \\alpha x + \\beta x^3 = \\gamma \\cos(\\omega t)\n$$\n此处，$m_0$ 是静止质量，$c$ 是一个特征速度参数，$\\delta$ 是阻尼系数，$\\alpha$ 和 $\\beta$ 是非线性恢复力的参数，而 $\\gamma$ 和 $\\omega$ 分别是正弦驱动力的振幅和角频率。所有这些参数都是正常数。我们感兴趣的是振子速度 $|\\frac{dx}{dt}|$ 保持小于 $c$ 的物理情景。\n\n为了在相空间中分析该系统的动力学，通常将这个二阶常微分方程转换为一个由两个一阶常微分方程组成的方程组。设系统状态由向量 $\\mathbf{y}(t) = \\begin{pmatrix} y_1(t) \\\\ y_2(t) \\end{pmatrix}$ 描述，其中 $y_1(t) = x(t)$ 且 $y_2(t) = \\frac{dx}{dt}$。那么系统的演化由形式为 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}, t)$ 的方程决定。\n\n确定该动力系统的非自治向量场 $\\mathbf{F}(\\mathbf{y}, t)$。", "solution": "我们令 $y_1=x$ 和 $y_2=\\dot x$，从而\n$$\\dot y_1=y_2\\,. $$\n原方程为\n$$\nm_0\\bigl(1-\\frac{y_2^2}{c^2}\\bigr)^{-3/2}\\ddot x+\\delta y_2+\\alpha y_1+\\beta y_1^3=\\gamma\\cos(\\omega t)\\,.\n$$\n解出 $\\ddot x$ 得\n$$\n\\ddot x\n=\\frac{\\bigl(1-\\frac{y_2^2}{c^2}\\bigr)^{3/2}}{m_0}\\bigl[\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr].\n$$\n因此\n$$\n\\dot y_2\n=\\frac{(1-\\frac{y_2^2}{c^2})^{3/2}}{m_0}\\bigl(\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr).\n$$\n因此，非自治向量场为\n$$\n\\mathbf F(y,t)\n=\\begin{pmatrix}\ny_2\\\\\n\\displaystyle\\frac{\\bigl(1-\\frac{y_2^2}{c^2}\\bigr)^{3/2}}{m_0}\\bigl(\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr)\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\ny_2\\\\\n\\displaystyle\\frac{(1-\\tfrac{y_2^2}{c^2})^{3/2}}{m_0}\\bigl(\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr)\n\\end{pmatrix}}$$", "id": "1089504"}, {"introduction": "将高阶系统转化为一阶状态空间形式是现代控制理论的基石，它使得我们能够运用线性代数的强大工具来分析和设计复杂的控制系统。这个练习 [@problem_id:1089737] 来源于一个经典的控制工程问题：使用PID控制器来调节一个二阶物理系统。你的任务是将在个包含微分和积分项的闭环控制系统，转化为一个三维的一阶常微分方程组，并确定其状态空间矩阵$A$，这对于分析系统的稳定性至关重要。", "problem": "在控制工程中，使用微分方程对物理系统的行为进行建模是标准做法。考虑一个二阶线性时不变系统，通常称为“被控对象”，其动态由以下方程描述：\n$$ m \\frac{d^2y(t)}{dt^2} + c \\frac{dy(t)}{dt} + k y(t) = u(t) $$\n此处，$y(t)$ 是系统输出（例如位置），$u(t)$ 是控制输入（例如施加的力），而 $m, c, k$ 是代表系统固有物理特性（例如质量、阻尼系数和弹簧常数）的正实数常数。\n\n为确保输出 $y(t)$ 跟随期望的设定点 $r(t)$，使用比例-积分-微分（PID）控制器。控制器计算误差 $e(t) = r(t) - y(t)$，并根据以下定律生成控制输入：\n$$ u(t) = K_p e(t) + K_i \\int_0^t e(\\tau) d\\tau + K_d \\frac{de(t)}{dt} $$\n其中 $K_p, K_i, K_d$ 分别是比例、积分和微分增益。\n\n对于此问题，考虑常见的调节任务，其中设定点是常数零，即 $r(t)=0$。闭环系统，即被控对象和控制器的组合，可以用形如 $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t)$ 的一阶常微分方程组来描述，这被称为状态空间表示。\n\n将闭环系统的状态向量 $\\mathbf{x}(t)$ 定义为：\n$$ \\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\\\ x_3(t) \\end{pmatrix} = \\begin{pmatrix} y(t) \\\\ \\dot{y}(t) \\\\ \\int_0^t e(\\tau) d\\tau \\end{pmatrix} $$\n你的任务是推导状态空间矩阵 $A$。最终答案应为用参数 $m, c, k, K_p, K_i, K_d$ 表示的矩阵 $A$。", "solution": "我们有被控对象的动态方程和PID控制律：\n$$m\\ddot y + c\\dot y + k y = u,$$\n$$u = K_p e + K_i\\int_0^t e(\\tau)\\,d\\tau + K_d\\dot e,$$\n其中 $e = r - y$，且此处 $r=0$，因此 $e = -y$ 且 $\\dot e = -\\dot y$。\n\n定义状态向量\n$$x_1 = y,\\quad x_2 = \\dot y,\\quad x_3 = \\int_0^t e(\\tau)\\,d\\tau = \\int_0^t(-y(\\tau))\\,d\\tau.$$\n\n1. 计算 $\\dot x_1$：\n$$\\dot x_1 = \\dot y = x_2.$$\n\n2. 使用被控对象方程计算 $\\dot x_2$：\n$$m\\ddot y = -c\\dot y - k y + u\n= -c x_2 - k x_1 +\\bigl(K_p(-x_1) + K_i x_3 + K_d(-x_2)\\bigr).$$\n两边除以 $m$ 得到\n$$\\dot x_2 = \\ddot y\n= -\\frac{c+K_d}{m}\\,x_2 - \\frac{k+K_p}{m}\\,x_1 + \\frac{K_i}{m}\\,x_3.$$\n\n3. 计算 $\\dot x_3$：\n$$\\dot x_3 = e = -y = -x_1.$$\n\n综合这些，状态空间形式 $\\dot{\\mathbf x}=A\\mathbf x$ 为\n$$\n\\begin{pmatrix}\\dot x_1\\\\\\dot x_2\\\\\\dot x_3\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & 1 & 0\\\\\n-\\frac{k+K_p}{m} & -\\frac{c+K_d}{m} & \\frac{K_i}{m}\\\\\n-1 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix}x_1\\\\x_2\\\\x_3\\end{pmatrix}.\n$$\n因此矩阵 $A$ 如上所示。", "answer": "$$\\boxed{\\begin{pmatrix}\n0 & 1 & 0\\\\\n-\\dfrac{k+K_p}{m} & -\\dfrac{c+K_d}{m} & \\dfrac{K_i}{m}\\\\\n-1 & 0 & 0\n\\end{pmatrix}}$$", "id": "1089737"}, {"introduction": "物理世界中许多系统的行为并非由单个方程描述，而是由一组相互耦合的微分方程决定。这个练习 [@problem_id:1089556] 展示了如何将状态空间方法推广到这类耦合系统，以一个量子力学中的双通道散射问题为例。通过将两个耦合的二阶薛定谔方程转化为一个四维的一阶系统，我们可以将其写成一个统一的矩阵形式，这极大地简化了数值求解过程。", "problem": "在量子力学中，粒子从一个具有内部结构的目标散射的过程可以使用耦合通道方法进行建模。这会得到一个耦合的薛定谔方程组。考虑一个简化的双通道散射问题，其总能量为 $E$，轨道角动量量子数为 $\\ell$。其径向运动由波函数 $\\psi_1(r)$ 和 $\\psi_2(r)$ 描述，分别对应于通道1和通道2。这些波函数满足以下耦合二阶常微分方程组：\n\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi_1}{dr^2} + \\left(V_{11}(r) + \\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}\\right)\\psi_1(r) + V_{12}(r)\\psi_2(r) = E\\psi_1(r)\n$$\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi_2}{dr^2} + \\left(V_{22}(r) + \\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}\\right)\\psi_2(r) + V_{21}(r)\\psi_1(r) = E\\psi_2(r)\n$$\n\n在此，$r$ 是径向坐标，$m$ 是系统的约化质量，$\\hbar$ 是约化普朗克常数。函数 $V_{11}(r)$ 和 $V_{22}(r)$ 是每个通道内的势能，而 $V_{12}(r)$ 代表了通道间的耦合。由于哈密顿量的厄米性，我们有 $V_{21}(r) = V_{12}(r)$。\n\n为了数值求解该方程组，通常的做法是将其转换为 $\\frac{d\\mathbf{y}}{dr} = \\mathbf{A}(r)\\mathbf{y}(r)$ 形式的一阶常微分方程组。将状态向量定义为 $\\mathbf{y}(r) = [\\psi_1(r), \\frac{d\\psi_1}{dr}, \\psi_2(r), \\frac{d\\psi_2}{dr}]^T$。\n\n推导 $4 \\times 4$ 状态空间矩阵 $\\mathbf{A}(r)$ 的显式形式。", "solution": "我们定义状态向量\n$$\n\\mathbf y(r)=\\bigl(\\psi_1,\\psi_1',\\psi_2,\\psi_2'\\bigr)^T.\n$$\n那么\n$$\n\\dot y_1=\\psi_1'=y_2,\\quad \\dot y_3=\\psi_2'=y_4.\n$$\n\n根据第一个通道的方程\n$$\n-\\frac{\\hbar^2}{2m}\\psi_1''+\\Bigl(V_{11}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}\\Bigr)\\psi_1+V_{12}(r)\\,\\psi_2=E\\psi_1\n$$\n我们得到\n$$\n\\psi_1''=\\frac{2m}{\\hbar^2}\\Bigl(V_{11}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}-E\\Bigr)\\psi_1+\\frac{2m}{\\hbar^2}V_{12}(r)\\,\\psi_2,\n$$\n所以\n$$\n\\dot y_2=\\frac{2m}{\\hbar^2}\\Bigl(V_{11}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}-E\\Bigr)y_1+\\frac{2m}{\\hbar^2}V_{12}(r)\\,y_3.\n$$\n\n类似地，第二个通道给出\n$$\n\\dot y_4=\\frac{2m}{\\hbar^2}V_{12}(r)\\,y_1+\\frac{2m}{\\hbar^2}\\Bigl(V_{22}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}-E\\Bigr)y_3.\n$$\n\n将这些结果整理成 $\\dot{\\mathbf y}=\\mathbf A(r)\\,\\mathbf y$ 的形式，得到\n$$\n\\mathbf A(r)\n=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n\\frac{2m}{\\hbar^2}\\bigl(V_{11}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}-E\\bigr) & 0 &\n\\frac{2m}{\\hbar^2}V_{12}(r) & 0\\\\\n0 & 0 & 0 & 1\\\\\n\\frac{2m}{\\hbar^2}V_{12}(r) & 0 &\n\\frac{2m}{\\hbar^2}\\bigl(V_{22}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}-E\\bigr) & 0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n\\frac{2m}{\\hbar^2}\\bigl(V_{11}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}-E\\bigr) & 0 & \\frac{2m}{\\hbar^2}V_{12}(r) & 0\\\\\n0 & 0 & 0 & 1\\\\\n\\frac{2m}{\\hbar^2}V_{12}(r) & 0 & \\frac{2m}{\\hbar^2}\\bigl(V_{22}(r)+\\frac{\\hbar^2\\ell(\\ell+1)}{2mr^2}-E\\bigr) & 0\n\\end{pmatrix}}$$", "id": "1089556"}]}