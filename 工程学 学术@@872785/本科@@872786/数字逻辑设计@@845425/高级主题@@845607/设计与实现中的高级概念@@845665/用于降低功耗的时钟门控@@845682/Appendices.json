{"hands_on_practices": [{"introduction": "动手实践的第一步是精确定义何时需要时钟。这个练习将引导你把一系列功能需求转化为一个布尔逻辑表达式，这个表达式将控制门控时钟的使能信号，这是设计任何时钟门控电路的基础。通过这个练习，你将学会如何从系统规范中提炼出核心的逻辑关系。[@problem_id:1920641]", "problem": "微处理器执行单元内部的一个特殊寄存器 `R_X` 可以从两个来源之一加载操作数：主内存总线或本地数据缓存。该加载操作由一个使能信号 `E` 控制，该信号是一个时钟门控电路的一部分，旨在通过仅在有有效写操作待处理时激活寄存器来降低功耗。\n\n使能信号的行为由四个输入信号决定：\n- `B_R`：一个逻辑信号，当主内存总线请求向 `R_X` 写入数据时，该信号为高电平（逻辑 1）。\n- `B_G`：一个逻辑信号，当总线仲裁器批准主内存总线的写请求时，该信号为高电平（逻辑 1）。\n- `C_R`：一个逻辑信号，当本地数据缓存请求向 `R_X` 写入数据时，该信号为高电平（逻辑 1）。\n- `C_B`：一个逻辑信号，当本地数据缓存因内部操作而繁忙且无法满足写请求时，该信号为高电平（逻辑 1）。\n\n为了加载寄存器 `R_X`，如果以下任一组条件被完全满足，使能信号 `E` 必须被置为有效（设为高电平）：\n1. 主内存总线请求写入，并且该请求同时被仲裁器批准。\n2. 本地数据缓存请求写入，并且缓存不繁忙。\n\n根据输入信号 `B_R`、`B_G`、`C_R` 和 `C_B`，确定使能信号 `E` 的最简布尔逻辑表达式。你的最终答案应为一个积之和形式的布尔表达式。使用 `\\cdot` 表示与操作，`+` 表示或操作，上划线表示非操作（例如 `\\overline{X}`）。", "solution": "当主内存总线请求写入并被批准时，或者当本地缓存请求写入且不繁忙时，使能信号必须被置为有效。将每个条件转换为布尔项：\n- 当 $B_{R}$ 为高电平且 $B_{G}$ 同时为高电平时，满足主内存总线的条件，得到乘积项 $B_{R} \\cdot B_{G}$。\n- 当 $C_{R}$ 为高电平且 $C_{B}$ 为低电平时，满足本地缓存的条件，得到乘积项 $C_{R} \\cdot \\overline{C_{B}}$。\n\n因为任一条件都足以触发，所以使能信号是这两个乘积项的逻辑或：\n$$E = B_{R} \\cdot B_{G} + C_{R} \\cdot \\overline{C_{B}}.$$\n\n这已经是积之和形式。该表达式是最简的，因为每一项都对应其来源的一个必要且充分的双文字合取式，并且 $B_{R} \\cdot B_{G}$ 与 $C_{R} \\cdot \\overline{C_{B}}$ 之间没有共享的变量或其补元，因此无法通过吸收律或冗余律进行化简。", "answer": "$$\\boxed{B_{R}\\cdot B_{G} + C_{R}\\cdot \\overline{C_{B}}}$$", "id": "1920641"}, {"introduction": "直接使用简单的逻辑门实现时钟门控看似直接，但隐藏着巨大的风险。本练习将通过一个具体场景，揭示当使能信号与时钟异步时，如何产生毛刺或缩短的时钟脉冲，从而可能导致功能错误。理解这种风险是掌握正确设计方法的关键，也是时钟门控设计中必须避免的陷阱。[@problem_id:1920603]", "problem": "一位初级数字设计工程师正在通过使用一个简单的时钟门控电路，在一个片上系统中实现一种节能功能。该电路由一个双输入与门组成。该门的一个输入是主系统时钟`CLK`，另一个是高电平有效的`ENABLE`信号。与门的输出`GATED_CLK`驱动一个同步逻辑模块。\n\n系统时钟`CLK`是一个周期为$T_{clk}$、占空比为50%的周期性信号。单个周期可描述如下：`CLK`信号在时间区间$0 \\le t  T_{clk}/2$为高电平，在$T_{clk}/2 \\le t  T_{clk}$为低电平。\n\n`ENABLE`信号由一个与`CLK`信号不同步的控制器置为有效。在从$t=0$开始的某个我们感兴趣的周期内，`ENABLE`信号初始为低电平，并在$t_{en}$时刻发生一次从低到高的干净跳变，其中给定$0  t_{en}  T_{clk}/2$。在这次跳变之后，`ENABLE`信号在时钟周期的剩余时间以及之后都保持高电平。\n\n与门对于所有跳变都有一个均匀的传播延迟$t_{pd}$。这意味着任何导致输出变化的输入变化，将在延迟$t_{pd}$后反映在输出端。\n\n由于`ENABLE`信号在`CLK`已经是高电平时被置为有效，`GATED_CLK`线上的第一个脉冲是不完整的。确定`GATED_CLK`输出上这个第一个被缩短的脉冲的总持续时间（即宽度）。请用$T_{clk}$、$t_{en}$和$t_{pd}$的符号表达式给出你的答案。", "solution": "双输入与门输出其两个输入的逻辑与，对于任何引起输出变化的输入跳变，输出会延迟传播延迟$t_{pd}$。\n\n给定50%占空比的时钟，在区间$0 \\le t  \\frac{T_{clk}}{2}$内，我们有$\\mathrm{CLK}=1$，而在区间$\\frac{T_{clk}}{2} \\le t  T_{clk}$内，我们有$\\mathrm{CLK}=0$。最初，$\\mathrm{ENABLE}=0$，并在$t=t_{en}$（其中$0  t_{en}  \\frac{T_{clk}}{2}$）时变为高电平。输出$\\mathrm{GATED\\_CLK}$是$\\mathrm{CLK}$和$\\mathrm{ENABLE}$的与运算结果，并延迟$t_{pd}$。\n\n输出$\\mathrm{GATED\\_CLK}$将在$t = t_{en} + t_{pd}$时变为高电平，因为此时$\\mathrm{ENABLE}$的上升沿（发生在$t=t_{en}$）传播通过了与门，而$\\mathrm{CLK}$输入仍为高电平。时钟$\\mathrm{CLK}$在$t = \\frac{T_{clk}}{2}$时下降。这个跳变传播到输出，导致$\\mathrm{GATED\\_CLK}$在$t = \\frac{T_{clk}}{2} + t_{pd}$时下降。\n\n缩短脉冲的持续时间是这两个时间之差：\n$$ \\left(\\frac{T_{clk}}{2} + t_{pd}\\right) - (t_{en} + t_{pd}) = \\frac{T_{clk}}{2} - t_{en} $$\n传播延迟$t_{pd}$从两个时间点中减去，因此它不会影响最终脉冲的宽度。", "answer": "$$\\boxed{\\frac{T_{clk}}{2}-t_{en}}$$", "id": "1920603"}, {"introduction": "为避免简单门控带来的风险，业界通常采用基于锁存器的时钟门控单元（Integrated Clock Gating, ICG Cell）。这个练习将带你分析这种安全设计的时序约束，通过计算使能逻辑的最大允许延迟，来确保电路在所有条件下都能稳定、可靠地工作。这是通往高级数字设计和时序收敛的必经之路。[@problem_id:1920633]", "problem": "在低功耗数字信号处理器的设计中，使用了一种基于锁存器的时钟门控技术来禁用空闲浮点单元 (FPU) 的时钟。该时钟门控电路由一个负电平敏感的透明锁存器和一个与门构成。控制信号 `ENABLE` 被送入锁存器的数据输入端。锁存器的输出与系统时钟 `CLK` 进行“与”运算，以生成供给 FPU 的门控时钟。该锁存器仅在 `CLK` 为低电平时是透明的（即其输出跟随其输入），并在 `CLK` 的上升沿捕获 `ENABLE` 信号的状态。\n\n`ENABLE` 信号本身由一个组合逻辑块生成，该逻辑块的输入来自一组控制寄存器。这些控制寄存器在同一系统时钟 `CLK` 的**下降沿**进行更新。\n\n给定以下用于最坏情况分析的时序参数：\n- 时钟低电平相位的最小保证持续时间为 $T_{\\text{low}} = 600$ ps。\n- 下降沿触发的控制寄存器的时钟到Q延迟为 $T_{\\text{c2q}} = 45$ ps。\n- 时钟门控锁存器数据输入的建立时间要求为 $T_{\\text{su,latch}} = 35$ ps。\n- 为确保稳健运行，必须包含一个 $T_{\\text{margin}} = 50$ ps 的强制性安全时序裕量。\n\n计算生成 `ENABLE` 信号的组合逻辑块的最大允许传播延迟 $T_{\\text{prop,max}}$。请以皮秒 (ps) 为单位表示你的答案。", "solution": "用于时钟门控的负电平敏感锁存器仅在 $CLK$ 为低电平时是透明的，并在 $CLK$ 的上升沿关闭。锁存器的数据输入 $ENABLE$ 必须在 $CLK$ 上升沿之前至少 $T_{\\text{su,latch}}$ 的时间内保持稳定，并且还必须包含一个额外的安全裕量 $T_{\\text{margin}}$。\n\n驱动组合逻辑的控制寄存器在 $CLK$ 的下降沿触发，其输出在经过一个时钟到Q延迟 $T_{\\text{c2q}}$ 后变为有效。然后，组合逻辑产生一个传播延迟 $T_{\\text{prop}}$，以在锁存器输入端生成 $ENABLE$。\n\n考虑到最小低电平持续时间 $T_{\\text{low}}$，从下降沿到锁存器输入端允许的最晚稳定到达的总可用时间是 $T_{\\text{low}} - T_{\\text{su,latch}} - T_{\\text{margin}}$。因此，安全操作的时序不等式为\n$$\nT_{\\text{c2q}} + T_{\\text{prop}} \\leq T_{\\text{low}} - T_{\\text{su,latch}} - T_{\\text{margin}}.\n$$\n求解最大允许传播延迟，\n$$\nT_{\\text{prop,max}} = T_{\\text{low}} - T_{\\text{c2q}} - T_{\\text{su,latch}} - T_{\\text{margin}}.\n$$\n代入给定值 $T_{\\text{low}} = 600\\ \\text{ps}$，$T_{\\text{c2q}} = 45\\ \\text{ps}$，$T_{\\text{su,latch}} = 35\\ \\text{ps}$ 和 $T_{\\text{margin}} = 50\\ \\text{ps}$，\n$$\nT_{\\text{prop,max}} = 600 - 45 - 35 - 50 = 470\\ \\text{ps}.\n$$\n因此，组合逻辑的最大允许传播延迟为 $470\\ \\text{ps}$。", "answer": "$$\\boxed{470}$$", "id": "1920633"}]}