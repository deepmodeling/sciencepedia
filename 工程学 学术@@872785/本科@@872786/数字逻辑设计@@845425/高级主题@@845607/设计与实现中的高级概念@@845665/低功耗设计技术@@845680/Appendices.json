{"hands_on_practices": [{"introduction": "动态功耗是CMOS电路中的主要功耗来源，而电源电压（$V_{DD}$）是影响动态功耗的最关键因素之一。本练习旨在通过一个实际的降压场景，帮助你直观地理解和量化电压调整对功耗的巨大影响。通过计算动态功耗的变化百分比，你将深刻体会到电压缩放（voltage scaling）作为一种基础且高效的低功耗设计技术，其背后依赖于功耗与电压之间的平方关系。[@problem_id:1945207]", "problem": "一个设计团队正在为一款电池供电设备开发一种新型低功耗处理器。该处理器采用互补金属氧化物半导体（CMOS）技术构建。在这类电路中，功耗的一个主要组成部分是动态功耗，它在逻辑门切换状态时耗散。动态功耗 $P_{dyn}$ 可以通过关系式 $P_{dyn} = \\alpha C V_{DD}^2 f_{clk}$ 精确建模，其中 $\\alpha$ 是每个时钟周期电容性负载切换的平均次数（开关活动因子），$C$ 是电路的总负载电容，$V_{DD}$ 是电源电压，$f_{clk}$ 是时钟频率。\n\n为了显著延长设备的电池寿命，该团队实现了一种省电模式。当此模式被激活时，处理器的电源电压 $V_{DD}$ 会从其标称工作值降低20%。在此分析中，假设开关活动因子（$\\alpha$）、总负载电容（$C$）和时钟频率（$f_{clk}$）在进入此省电模式时保持不变。\n\n计算动态功耗产生的百分比变化。将您的答案表示为小数。例如，15%的增加应写为0.15，25%的减少应写为-0.25。", "solution": "CMOS中的动态功耗建模为 $P_{dyn}=\\alpha C V_{DD}^{2} f_{clk}$。设标称电源电压为 $V_{0}$，相应的动态功耗为\n$$\nP_{0}=\\alpha C V_{0}^{2} f_{clk}.\n$$\n电源电压降低20%意味着新的电源电压为\n$$\nV_{1}=(1-0.20)V_{0}=0.80\\,V_{0}.\n$$\n在 $\\alpha$、$C$ 和 $f_{clk}$ 不变的情况下，新的动态功耗为\n$$\nP_{1}=\\alpha C V_{1}^{2} f_{clk}=\\alpha C (0.80 V_{0})^{2} f_{clk}=0.64\\,\\alpha C V_{0}^{2} f_{clk}=0.64\\,P_{0}.\n$$\n以小数表示的百分比变化是相对变化\n$$\n\\frac{P_{1}-P_{0}}{P_{0}}=0.64-1=-0.36.\n$$\n因此，动态功耗以小数形式减少了0.36。", "answer": "$$\\boxed{-0.36}$$", "id": "1945207"}, {"introduction": "在掌握了电压对功耗的宏观影响后，我们将深入到门级层面，探究另一个关键参数——开关活动（switching activity）。逻辑门的选择并非无关重要，不同的逻辑功能会产生不同的输出翻转概率，从而直接影响动态功耗。本练习通过比较一个双输入与门（AND）和一个双输入异或门（XOR）的开关活动，清晰地展示了逻辑设计决策如何影响功耗。[@problem_id:1945215]", "problem": "在现代超大规模集成电路（VLSI）的设计中，最小化功耗是一个关键目标。动态功耗的一个主要组成部分是由于逻辑门的开关活动。假设一位数字设计师正在为一个小型逻辑块评估两种替代实现方案。一种实现方案使用一个双输入与门，而另一种方案使用一个双输入异或门。与门的输出是 `Y = A \\cdot B`，异或门的输出是 `Z = A \\oplus B`。\n\n两个输入 `A` 和 `B` 被假定为电路块的主输入。统计分析表明，这些输入彼此完全不相关，并且它们的信号概率是均匀的。这意味着输入为高电平（逻辑'1'）的概率是 `0.5`，这对输入 `A` 和 `B` 都成立。\n\n一个输出信号（例如 `F`）的开关活动定义为该信号在时刻 `t` 的值与前一时刻 `t-1` 的值不同的概率。假设输入信号 `A` 和 `B` 在时间上不相关（即，它们在一个时间步长的值与前一个时间步长的值无关），则输出 `F` 的开关活动 `\\alpha_F` 可以使用其信号概率 `P(F=1)` 通过公式 `\\alpha_F = 2 \\times P(F=1) \\times (1 - P(F=1))` 来计算。\n\n为了根据功耗做出明智的设计选择，设计师希望比较这两个门的开关活动。计算比率 `R = \\alpha_{Z} / \\alpha_{Y}`，其中 `\\alpha_{Z}` 是异或门输出的开关活动，`\\alpha_{Y}` 是与门输出的开关活动。\n\n将比率 `R` 的最终答案表示为保留三位有效数字的小数。", "solution": "设主输入满足 $P(A=1)=P(B=1)=\\frac{1}{2}$，其中 $A$ 和 $B$ 相互独立且在时间上不相关。对于双输入与门 $Y=A \\cdot B$，其信号概率为\n$$\nP(Y=1)=P(A=1,B=1)=P(A=1)P(B=1)=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4}.\n$$\n对于双输入异或门 $Z=A\\oplus B$，其信号概率为\n$$\nP(Z=1)=P(A\\neq B)=P(A=1,B=0)+P(A=0,B=1)=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2}.\n$$\n根据时间不相关信号的开关活动公式 $\\alpha_{F}=2\\,P(F=1)\\left(1-P(F=1)\\right)$，计算\n$$\n\\alpha_{Y}=2\\cdot\\frac{1}{4}\\left(1-\\frac{1}{4}\\right)=2\\cdot\\frac{1}{4}\\cdot\\frac{3}{4}=\\frac{3}{8},\n$$\n$$\n\\alpha_{Z}=2\\cdot\\frac{1}{2}\\left(1-\\frac{1}{2}\\right)=2\\cdot\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2}.\n$$\n因此，比率为\n$$\nR=\\frac{\\alpha_{Z}}{\\alpha_{Y}}=\\frac{\\frac{1}{2}}{\\frac{3}{8}}=\\frac{4}{3}=1.333\\ldots\n$$\n保留三位有效数字， $R=1.33$。", "answer": "$$\\boxed{1.33}$$", "id": "1945215"}, {"introduction": "低功耗设计不仅仅是局部优化，更需要在系统层面进行权衡（trade-off）。本练习将我们从单个逻辑门提升到有限状态机（FSM）这一常用设计模块的层面。你将探索两种不同的状态编码方案——二进制编码（binary encoding）和独热码编码（one-hot encoding）——在功耗上的优劣。这个过程将揭示在状态寄存器（触发器）的功耗与次态逻辑（combinational logic）的功耗之间的经典权衡，这是做出明智架构决策的关键。[@problem_id:1945189]", "problem": "一位数字系统工程师正在设计一个低功耗控制器，需要评估用于有限状态机（FSM）的两种不同状态编码方案。该有限状态机有 16 个不同的状态，$S_0, S_1, \\ldots, S_{15}$。在每个有效的时钟沿，该机器从当前状态 $S_i$ 顺序转换到下一个状态 $S_{i+1}$，序列从 $S_{15}$ 回绕到 $S_0$。这个循环无限重复。\n\n正在考虑的两种编码方案是：\n1.  **二进制编码**：使用所需的最少位数来表示状态。\n2.  **独热编码**：每个状态由一个唯一的位为逻辑'1'表示，而所有其他位为逻辑'0'。\n\n该有限状态机的平均功耗 $P$ 与每个时钟周期消耗的平均能量 $E_{cycle}$ 成正比。该能量由两个主要部分组成：组合下一状态逻辑消耗的能量 $E_{logic}$，以及状态寄存器的触发器消耗的能量 $E_{ff}$。\n\n触发器消耗的能量 $E_{ff}$，是通过将每个时钟周期内状态改变（从0到1或从1到0）的触发器平均数量乘以每次转换的恒定能量成本 $E_{tran}$ 来计算的。下一状态逻辑消耗的平均能量 $E_{logic}$，对于每种实现方式都是一个给定的值，反映了其门级复杂度。\n\n假设以下能量常数：\n-   每个触发器转换的能量：$E_{tran} = 1.0$ 任意能量单位。\n-   二进制编码的平均逻辑能量：$E_{logic, bin} = 12.0$ 任意能量单位/周期。\n-   独热编码的平均逻辑能量：$E_{logic, oh} = 0.5$ 任意能量单位/周期。\n\n计算独热编码实现的总平均功耗与二进制编码实现的总平均功耗之比，$\\frac{P_{oh}}{P_{bin}}$。将你的答案以实数形式报告，并四舍五入到三位有效数字。", "solution": "设 $P$ 为平均功耗，$E_{cycle}$ 为每个周期的平均能量。由于 $P$ 与 $E_{cycle}$ 成正比，并且两种实现方式的时钟条件相同，因此存在一个与编码无关的常数 $k$，使得 $P = k E_{cycle}$。因此，\n$$\n\\frac{P_{oh}}{P_{bin}}=\\frac{E_{cycle,oh}}{E_{cycle,bin}}.\n$$\n\n周期能量是逻辑能量和触发器转换能量的总和：\n$$\nE_{cycle} = E_{logic} + E_{ff}.\n$$\n\n触发器能量为 $E_{ff} = (\\text{每个周期触发器转换的平均次数}) \\cdot E_{tran}$。\n\n二进制编码：\n- 对于 16 个状态，所需的最小位数是 $\\lceil \\log_{2}(16) \\rceil = 4$。\n- 在从 $S_{i}$ 到 $S_{i+1}$ 的 4 位二进制计数中，每次增量操作的预期比特翻转数等于每个比特翻转概率的总和。比特 $k$（最低有效位 LSB 是 $k=0$）在顺序计数中，每 $2^k$ 个周期翻转一次，因此其翻转概率为 $1/2^k$。每次转换的平均翻转次数为\n$$\n\\sum_{k=0}^{3}\\frac{1}{2^k} = 1 + \\frac{1}{2} + \\frac{1}{4} + \\frac{1}{8} = \\frac{15}{8}.\n$$\n因此，\n$$\nE_{ff,bin} = \\frac{15}{8} E_{tran}.\n$$\n包括逻辑能量，\n$$\nE_{cycle,bin} = E_{logic,bin} + \\frac{15}{8} E_{tran}.\n$$\n\n独热编码：\n- 使用 16 个触发器，每次转换恰好有两个触发器改变状态（当前状态的触发器从 $1$ 变为 $0$，下一个状态的触发器从 $0$ 变为 $1$），所以\n$$\nE_{ff,oh} = 2 E_{tran}.\n$$\n包括逻辑能量，\n$$\nE_{cycle,oh} = E_{logic,oh} + 2 E_{tran}.\n$$\n\n代入给定的数值 $E_{tran} = 1.0$，$E_{logic,bin} = 12.0$ 和 $E_{logic,oh} = 0.5$：\n$$\nE_{cycle,bin} = 12.0 + \\frac{15}{8} \\cdot 1.0 = 12.0 + 1.875 = 13.875,\n$$\n$$\nE_{cycle,oh} = 0.5 + 2 \\cdot 1.0 = 2.5.\n$$\n因此，\n$$\n\\frac{P_{oh}}{P_{bin}} = \\frac{E_{cycle,oh}}{E_{cycle,bin}} = \\frac{2.5}{13.875} = \\frac{20}{111} \\approx 0.180180\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.180$。", "answer": "$$\\boxed{0.180}$$", "id": "1945189"}]}