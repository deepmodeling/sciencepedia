{"hands_on_practices": [{"introduction": "这个基础练习将引导你分析同步电路中的两个基本时序约束：建立时间 ($T_{setup}$) 和保持时间 ($T_{hold}$)。通过分析时钟偏斜如何同时影响这两个约束，你将学习推导出一个安全的时钟偏斜 ($T_{skew}$) 工作范围。这个练习突显了在时序设计中，必须同时满足上下限约束以确保电路稳定运行的基本原则。[@problem_id:1921187]", "problem": "在一个同步数字电路中，一个源触发器 (FF1) 和一个目标触发器 (FF2) 都由同一时钟信号的上升沿触发。FF1的输出通过一个组合逻辑模块连接到FF2的输入。\n\n电路元件的时序参数如下：\n- 时钟周期，$T_{period}$: 1000 ps\n- FF1的时钟到Q输出延迟，$T_{c \\to q}$: 60 ps\n- FF2的建立时间，$T_{setup}$: 70 ps\n- FF2的保持时间，$T_{hold}$: 50 ps\n- 组合逻辑模块的传播延迟，$T_{logic}$，其最小值为 $T_{logic,min} = 200$ ps，最大值为 $T_{logic,max} = 800$ ps。\n\n时钟偏斜 $T_{skew}$ 定义为时钟到达 FF2 的时间减去时钟到达 FF1 的时间 ($T_{skew} = t_{clk2} - t_{clk1}$)。为使电路正常工作，必须同时满足 FF2 的建立时间和保持时间约束。请计算时钟偏斜 $T_{skew}$ 的最大允许值。答案以皮秒 (ps) 为单位表示。", "solution": "假设时钟上升沿在时间 $t_{clk1}=0$ 到达FF1。根据偏斜的定义 $T_{skew}=t_{clk2}-t_{clk1}$，上升沿在时间 $t_{clk2}=T_{skew}$ 到达FF2，而下一个上升沿在 $T_{period}+T_{skew}$ 到达FF2。\n\n建立时间约束（在下一个时钟沿捕获）：在 $t=0$ 时由 FF1 发出的数据到达 FF2 输入端的时间为\n$$\nt_{arr,setup}=T_{c \\to q}+T_{logic,max}.\n$$\n对于建立时间，数据到达时间必须不晚于 $T_{period}+T_{skew}-T_{setup}$：\n$$\nT_{c \\to q}+T_{logic,max} \\leq T_{period}+T_{skew}-T_{setup}.\n$$\n重新整理可得偏斜的下限：\n$$\nT_{skew} \\geq T_{c \\to q}+T_{logic,max}+T_{setup}-T_{period}.\n$$\n代入给定值，\n$$\nT_{skew} \\geq 60+800+70-1000=-70 \\text{ ps}.\n$$\n\n保持时间约束（在同一时钟沿）：新数据最早到达FF2输入端的时间是\n$$\nt_{arr,hold}=T_{c \\to q}+T_{logic,min}.\n$$\n对于保持时间，这必须满足FF2的输入在 $T_{skew}+T_{hold}$ 之前保持稳定的要求：\n$$\nT_{c \\to q}+T_{logic,min} \\geq T_{skew}+T_{hold}.\n$$\n重新整理可得偏斜的上限：\n$$\nT_{skew} \\leq T_{c \\to q}+T_{logic,min}-T_{hold}.\n$$\n代入给定值，\n$$\nT_{skew} \\leq 60+200-50=210 \\text{ ps}.\n$$\n\n两个约束必须同时满足，因此允许的偏斜范围是\n$$\n-70 \\text{ ps} \\leq T_{skew} \\leq 210 \\text{ ps}.\n$$\n因此，$T_{skew}$ 的最大允许值为 $210$ ps。", "answer": "$$\\boxed{210}$$", "id": "1921187"}, {"introduction": "时钟偏斜的影响并非总是对称的。本练习专注于一个关键场景：正偏斜（时钟较晚到达目标触发器）如何威胁到保持时间要求。通过计算路径能容忍的最大正偏斜，你将更深刻地理解为什么管理“短路径”和污染延迟 ($T_{cd}$) 对于防止保持时间违例至关重要。[@problem_id:1921203]", "problem": "一位数字设计工程师正在分析两个串行流水线寄存器 `R1` 和 `R2` 之间关键数据路径的时序。这两个寄存器由同一个时钟源驱动，但由于芯片物理布局中的布线差异，时钟信号到达寄存器 `R2` 的时间与到达寄存器 `R1` 的时间不同。这种时序差异被称为时钟偏斜（clock skew）。正偏斜 $T_{skew}$ 意味着时钟沿到达 `R2` 的时间晚于其到达 `R1` 的时间。\n\n连接 `R1` 输出和 `R2` 输入的组合逻辑电路具有最小传播延迟（或称为污染延迟）$T_{cd} = 0.954$ ns。这是 `R1` 输出端的变化影响到 `R2` 输入端所需的最短时间。寄存器本身具有指定的保持时间 $T_{hold} = 0.221$ ns，这是在有效时钟沿*之后*，寄存器输入端的数据必须保持稳定的最短时间。\n\n为防止保持时间违例并确保可靠操作，这条特定的数据路径能够容忍的最大正时钟偏斜 $T_{skew}$ 是多少？答案以纳秒（ns）为单位，并四舍五入至三位有效数字。", "solution": "为避免在从寄存器R1（发送端）到寄存器R2（捕获端）的路径上因正时钟偏斜而发生保持时间违例，新数据到达R2输入端的最早时间不得早于捕获时钟沿之后的所需保持窗口。假设R1处的发送时钟沿发生在时间零点。新数据出现在R2输入端的最早时间是在发送沿之后的 $t_{ccq,\\min} + T_{cd}$，其中 $t_{ccq,\\min}$ 是源寄存器的最小clock-to-Q延迟，而 $T_{cd}$ 是从R1输出到R2输入的组合逻辑污染延迟。捕获时钟在时间 $T_{skew}$（正偏斜）到达R2。保持时间要求新数据相对于捕获时钟的到达时间满足\n$$t_{ccq,\\min} + T_{cd} \\ge T_{skew} + T_{hold}.$$\n重新整理得到允许的偏斜范围\n$$T_{skew} \\le t_{ccq,\\min} + T_{cd} - T_{hold}.$$\n题目没有提供 $t_{ccq,\\min}$，并且将 $T_{cd}$ 定义为从R1输出变化到R2输入变化的时间，因此我们对该路径采用标准的简化假设，即对于保持时间检查，$t_{ccq,\\min}$ 可以忽略不计。因此，\n$$T_{skew,\\max} = T_{cd} - T_{hold}.$$\n代入给定的数值（单位为纳秒）并计算，\n$$T_{skew,\\max} = 0.954 - 0.221 = 0.733.$$\n四舍五入到三位有效数字，最大可容忍的正时钟偏斜为 $0.733$（使用指定单位）。", "answer": "$$\\boxed{0.733}$$", "id": "1921203"}, {"introduction": "最后的练习将介绍一种更高级、甚至有些反直觉的设计技巧。有时，电路存在固有的保持时间违例，即使降低时钟频率也无法解决。我们将探讨一个场景，通过有意引入*负偏斜*（使时钟*更早*到达目标触发器）来解决这个问题，这表明时钟偏斜不仅是需要消除的问题，更可以成为实现时序收敛的有力工具。[@problem_id:1921176]", "problem": "正在设计一个数字同步流水线。考虑两个连续级之间的一条路径，该路径由一个启动触发器（FF1）、一个组合逻辑块和一个捕获触发器（FF2）组成。相同的时钟信号被分配到这两个触发器。\n\n触发器和逻辑电路的时序特性如下：\n- 触发器的时钟到Q端延迟，$t_{cq} = 0.3$ ns。\n- 触发器的建立时间要求，$t_{setup} = 0.5$ ns。\n- 触发器的保持时间要求，$t_{hold} = 0.6$ ns。\n- 组合逻辑的最大传播延迟（长路径），$t_{logic\\_max} = 3.0$ ns。\n- 组合逻辑的最小污染延迟（短路径），$t_{logic\\_min} = 0.2$ ns。\n\n时钟偏斜 $t_{skew}$ 定义为两个触发器之间时钟信号到达时间的差异：$t_{skew} = t_{clk2} - t_{clk1}$，其中 $t_{clk1}$ 和 $t_{clk2}$ 分别是时钟信号到达FF1和FF2的时间。初始设计假设时钟分配是理想的，偏斜为零（$t_{skew} = 0$）。\n\n初步的时序分析显示，无论选择何种时钟频率，该设计都存在一个时序违例，导致其无法正常工作。为了解决这个问题，设计者必须调整时钟路径布线，以引入一个非零偏斜。假设所有其他时序参数都不能改变，为确保电路无此违例地运行，时钟偏斜 $t_{skew}$ 的最大允许值是多少？\n\n最终答案以纳秒（ns）为单位表示。将最终答案四舍五入到两位有效数字。", "solution": "设FF1处的上升时钟沿发生在时间 $t=0$，而FF2处对应的时钟沿发生在 $t=t_{skew}$，其中 $t_{skew}=t_{clk2}-t_{clk1}$。\n\n启动的数据能够到达FF2输入端的最早时间是\n$$\nt_{\\text{arrive, min}}=t_{cq}+t_{logic\\_min}。\n$$\n为了满足FF2的保持时间要求，新数据不能在FF2时钟沿之后的保持窗口结束前到达。因此，保持时间约束为\n$$\nt_{cq}+t_{logic\\_min} \\ge t_{skew}+t_{hold},\n$$\n整理后得到\n$$\nt_{skew} \\le t_{cq}+t_{logic\\_min}-t_{hold}。\n$$\n代入给定值，\n$$\nt_{skew} \\le 0.3+0.2-0.6=-0.1 \\text{ ns}。\n$$\n因此，对于初始设计 $t_{skew}=0$，该不等式被违反（因为 $0>-0.1$），产生了一个保持时间违例，该违例无法通过改变时钟周期来修复。为了消除这个违例，设计者必须引入负偏斜，使得仍然满足保持时间约束的 $t_{skew}$ 的最大允许值为\n$$\nt_{skew,\\max}=-0.1 \\text{ ns}。\n$$\n为完整起见，建立时间约束为\n$$\nT \\ge t_{cq}+t_{logic\\_max}+t_{setup}-t_{skew},\n$$\n当 $t_{skew}=-0.1 \\text{ ns}$ 时，对于足够大的 $T$ 该约束仍然可以被满足。因此，可行性的限制条件是上述的保持时间约束，所要求的最大偏斜值为 $-0.1 \\text{ ns}$。\n\n四舍五入到两位有效数字得到 $-0.10$ ns。", "answer": "$$\\boxed{-0.10}$$", "id": "1921176"}]}