{"hands_on_practices": [{"introduction": "要理解复杂的数字电路，我们必须首先掌握其最基本的构建模块。进位保留加法器的核心是单比特全加器，它将三个输入比特相加，高效地生成一个两比特的和。通过这个练习，你将巩固对这一基础但至关重要的操作的理解，即一个全加器如何同时计算和（sum）与进位（carry）[@problem_id:1918736]。", "problem": "进位保留加法器的一位是一个基本的数字逻辑电路。它接受三个比特作为输入，记为 $a_i$、$b_i$ 和 $c_i$，并产生两个输出比特：一个和比特 $s_i$ 和一个进位输出比特 $c'_{i}$。该电路的功能是计算三个输入比特的算术和。这个和随后被表示为一个两位二进制数 $(c'_{i}s_i)_2$，其中 $c'_{i}$ 是最高有效位，$s_i$ 是最低有效位。例如，如果输入为 $a_i=1, b_i=1, c_i=0$，它们的算术和为 $1+1+0=2$，其二进制表示为 $10_2$。因此，电路的输出将是 $c'_{i}=1$ 和 $s_i=0$。\n\n下列哪组以 `(a_i, b_i, c_i) -> (s_i, c'_i)` 格式呈现的输入到输出的映射，正确描述了该电路在给定输入下的行为？\n\nA.\n集合 1: `(0, 1, 1) -> (0, 1)`\n集合 2: `(1, 1, 1) -> (1, 1)`\n集合 3: `(1, 0, 0) -> (1, 0)`\n\nB.\n集合 1: `(0, 1, 1) -> (1, 0)`\n集合 2: `(1, 1, 1) -> (1, 1)`\n集合 3: `(1, 0, 0) -> (1, 0)`\n\nC.\n集合 1: `(0, 1, 1) -> (0, 1)`\n集合 2: `(1, 1, 1) -> (1, 0)`\n集合 3: `(1, 0, 0) -> (1, 0)`\n\nD.\n集合 1: `(0, 1, 1) -> (0, 1)`\n集合 2: `(1, 1, 1) -> (0, 1)`\n集合 3: `(1, 0, 0) -> (0, 0)`", "solution": "一位进位保留加法器级计算三个输入比特 $a_{i}$、$b_{i}$ 和 $c_{i}$ 的算术和。令 $S = a_{i} + b_{i} + c_{i}$，其中加法是普通整数加法，且 $a_{i}, b_{i}, c_{i} \\in \\{0,1\\}$。两位输出 $(c'_{i}s_{i})_{2}$ 必须满足\n$$\ns_{i} = S \\bmod 2, \\qquad c'_{i} = \\left\\lfloor \\frac{S}{2} \\right\\rfloor.\n$$\n在布尔代数中，等价于\n$$\ns_{i} = a_{i} \\oplus b_{i} \\oplus c_{i}, \\qquad c'_{i} = (a_{i} \\land b_{i}) \\lor (b_{i} \\land c_{i}) \\lor (a_{i} \\land c_{i}).\n$$\n对每个给定的输入三元组进行求值：\n\n- 对于 $(a_{i}, b_{i}, c_{i}) = (0,1,1)$: \n$$\nS = 0 + 1 + 1 = 2, \\quad s_{i} = 2 \\bmod 2 = 0, \\quad c'_{i} = \\left\\lfloor \\frac{2}{2} \\right\\rfloor = 1,\n$$\n所以 $(s_{i}, c'_{i}) = (0,1)$。\n\n- 对于 $(a_{i}, b_{i}, c_{i}) = (1,1,1)$:\n$$\nS = 1 + 1 + 1 = 3, \\quad s_{i} = 3 \\bmod 2 = 1, \\quad c'_{i} = \\left\\lfloor \\frac{3}{2} \\right\\rfloor = 1,\n$$\n所以 $(s_{i}, c'_{i}) = (1,1)$。\n\n- 对于 $(a_{i}, b_{i}, c_{i}) = (1,0,0)$:\n$$\nS = 1 + 0 + 0 = 1, \\quad s_{i} = 1 \\bmod 2 = 1, \\quad c'_{i} = \\left\\lfloor \\frac{1}{2} \\right\\rfloor = 0,\n$$\n所以 $(s_{i}, c'_{i}) = (1,0)$。\n\n与选项比较，只有选项 A 正确地列出了所有三个映射。", "answer": "$$\\boxed{A}$$", "id": "1918736"}, {"introduction": "在掌握了单比特全加器的基础上，我们可以通过并行排列这些单元来构建多比特的进位保留加法器（CSA）。这个实践将展示 CSA 的一个关键特性：它能同时处理多个操作数，生成一个中间和向量与一个进位向量，而无需等待进位逐位传播。通过亲手计算这些向量，你将直观地体验到“保留进位”这一核心思想的实际运作方式[@problem_id:1918731]。", "problem": "一个专门的数字信号处理器（DSP）核心被设计用于执行快速的有限脉冲响应（FIR）滤波，这是音频处理中的一个常见操作。该核心的一个关键组成部分是一个必须同时将三个4位无符号二进制数相加的电路。为了达到所需的速度，采用了进位保存加法器（CSA）。CSA是一种数字加法器，它从三个或更多个数中生成一个部分和以及一个进位位序列。它将最终的进位传播推迟到后面的阶段，从而避免了传统行波进位加法器的延迟。\n\n考虑一个4位CSA处理三个输入操作数的第一阶段：$X = 1010_2$，$Y = 0101_2$，以及 $Z = 1100_2$。这个阶段由四个并行的全加器组成，每个比特位一个。位于比特位 $i$ 的全加器接收输入位 $X_i$、$Y_i$ 和 $Z_i$，并产生一个和位 $S_i$ 和一个进位输出位 $c_{i+1}$。\n\n确定此CSA阶段输出的4位部分和向量 $S = S_3S_2S_1S_0$ 和4位进位向量 $C_{vec} = c_4c_3c_2c_1$。\n\n将您的答案表示为一个行矩阵，其中包含这两个4位二进制字符串。矩阵的第一个元素应为和向量 $S$，第二个元素应为进位向量 $C_{vec}$。", "solution": "位于比特位 $i$ 的一个进位保存全加器接收三个输入位 $(X_{i},Y_{i},Z_{i})$ 并产生：\n$$S_{i}=X_{i}\\oplus Y_{i}\\oplus Z_{i},\\qquad c_{i+1}=(X_{i} \\land Y_{i}) \\lor (Y_{i} \\land Z_{i}) \\lor (Z_{i} \\land X_{i}).$$\n对于 $X=1010_{2}$、$Y=0101_{2}$、$Z=1100_{2}$，各位的分配如下：\n$$(X_{3},X_{2},X_{1},X_{0})=(1,0,1,0),\\quad (Y_{3},Y_{2},Y_{1},Y_{0})=(0,1,0,1),\\quad (Z_{3},Z_{2},Z_{1},Z_{0})=(1,1,0,0).$$\n按位计算：\n- 对于 $i=0$：$(X_{0},Y_{0},Z_{0})=(0,1,0)$，所以 $S_{0}=0\\oplus 1\\oplus 0=1$，且 $c_{1}=(0 \\land 1) \\lor (1 \\land 0) \\lor (0 \\land 0)=0$。\n- 对于 $i=1$：$(X_{1},Y_{1},Z_{1})=(1,0,0)$，所以 $S_{1}=1\\oplus 0\\oplus 0=1$，且 $c_{2}=(1 \\land 0) \\lor (0 \\land 0) \\lor (1 \\land 0)=0$。\n- 对于 $i=2$：$(X_{2},Y_{2},Z_{2})=(0,1,1)$，所以 $S_{2}=0\\oplus 1\\oplus 1=0$，且 $c_{3}=(0 \\land 1) \\lor (1 \\land 1) \\lor (0 \\land 1)=1$。\n- 对于 $i=3$：$(X_{3},Y_{3},Z_{3})=(1,0,1)$，所以 $S_{3}=1\\oplus 0\\oplus 1=0$，且 $c_{4}=(1 \\land 0) \\lor (0 \\land 1) \\lor (1 \\land 1)=1$。\n因此，部分和向量为 $S=S_{3}S_{2}S_{1}S_{0}=0011$，进位向量为 $C_{vec}=c_{4}c_{3}c_{2}c_{1}=1100$。", "answer": "$$\\boxed{\\begin{pmatrix} 0011  1100 \\end{pmatrix}}$$", "id": "1918731"}, {"introduction": "进位保留加法器的真正威力不仅限于三个数的相加，更在于它能加速多个操作数的求和，这在乘法器和数字信号处理等领域至关重要。这个问题挑战你使用全加器作为基本单元，设计一个更复杂的电路——一个7输入计数器。这不仅需要你从分层压缩的角度来思考电路结构，还要分析其性能，计算关键路径延迟，从而揭示这种架构为何能实现高速运算[@problem_id:1918758]。", "problem": "在一个专用数据采集单元的设计中，需要构建一个电路来计算七条并行输入线 $\\{x_0, x_1, x_2, x_3, x_4, x_5, x_6\\}$ 组成的总线上出现的‘1’的数量。该电路必须产生一个3位二进制加权数 $\\{y_2, y_1, y_0\\}$ 来表示这个计数。唯一可用的构建模块是标准全加器（FA）单元。\n\n一个全加器单元有三个输入 $A$、$B$ 和 $C_{in}$，以及两个输出，一个和位 $S$ 和一个进位输出位 $C_{out}$。它们的关系是 $S = A \\oplus B \\oplus C_{in}$ 和 $C_{out} = (A \\land B) \\lor (B \\land C_{in}) \\lor (A \\land C_{in})$。为了进行时序分析，假设从三个输入（$A, B, C_{in}$）中的任意一个到两个输出（$S, C_{out}$）中的任意一个的传播延迟是一个恒定值 $T_{FA}$。互连线的延迟可以忽略不计。\n\n您的任务是确定这个仅由全加器单元构成的7输入计数器的最优实现的关键路径延迟。请用 $T_{FA}$ 的整数倍来表示您的最终答案。", "solution": "我们将全加器（FA）建模为一个按比特位（列）操作的3:2压缩器：对于任何列，每个FA接收该列的三个输入位，并产生一个位于同一列的和位和一个位于下一更高列的进位位。根据时序模型，从任何FA输入到任一输出的传播延迟为 $T_{FA}$；因此，一条穿过 $n$ 个级联FA的路径的延迟为 $nT_{FA}$。\n\n我们从七个主输入 $\\{x_{0},\\dots,x_{6}\\}$ 开始，它们都位于第0列（权重为1）。令 $h_{k}$ 表示在给定阶段第 $k$ 列的可用比特数。初始时，\n$$\nh_{0}=7,\\quad h_{1}=0,\\quad h_{2}=0.\n$$\n\n阶段1（在 $T_{FA}$ 之后）：在第0列并行使用 $\\lfloor 7/3\\rfloor=2$ 个FA。每个FA消耗第0列的3个比特，在第0列产生一个和位，在第1列产生一个进位位。更新后的高度为\n$$\nh_{0}= (7-2\\cdot 3)+2=3,\\quad h_{1}=0+2=2,\\quad h_{2}=0.\n$$\n具体来说，如果FA1接收 $(x_{0},x_{1},x_{2})$，FA2接收 $(x_{3},x_{4},x_{5})$，它们的和 $s_{1},s_{2}$ 留在第0列，而它们的进位 $c_{1},c_{2}$ 进入第1列。剩余的比特 $x_{6}$ 留在第0列。\n\n阶段2（在 $2T_{FA}$ 之后）：使用一个在第0列的FA来压缩具有 $h_{0}=3$ 的第0列。这将在第0列产生一个和位，并向第1列产生一个进位位。第1列原本有2个比特，再接收一个进位后，变为3个比特。因此，\n$$\nh_{0}=1,\\quad h_{1}=3,\\quad h_{2}=0.\n$$\n此时，第0列有一个单独的比特，即最终的 $y_{0}$（最低有效位），在 $2T_{FA}$ 之后可用。\n\n阶段3（在 $3T_{FA}$ 之后）：使用一个在第1列的FA来压缩具有 $h_{1}=3$ 的第1列。这将在第1列产生一个和位，并向第2列产生一个进位位：\n$$\nh_{0}=1,\\quad h_{1}=1,\\quad h_{2}=1.\n$$\n这些在第1列和第2列的单个比特是最终的 $y_{1}$ 和 $y_{2}$，两者都在 $3T_{FA}$ 之后可用。\n\n现在确定关键路径。根据构造，$y_{0}$ 在 $2T_{FA}$ 后就绪，而 $y_{1}$ 和 $y_{2}$ 在 $3T_{FA}$ 后就绪。为了说明 $3T_{FA}$ 确实是最长路径，我们可以追踪一个明确的输入到输出的依赖关系：例如，一个输入在阶段1对 $s_{1}$ 或 $s_{2}$ 有贡献，然后在阶段2对第0列的FA的进位 $c_{3}$ 有贡献，最后对阶段3第1列的FA的进位（或和）有贡献（从而产生 $y_{2}$ 或 $y_{1}$），这条路径穿过了三个级联的FA，因此产生 $3T_{FA}$ 的延迟。\n\n为了证明最优性（一个下界），我们观察到，要产生第2列的任何比特，都需要来自第1列FA的一个进位。初始时 $h_{1}=0$。经过一级FA后，从第0列到第1列的最大进位数是 $\\lfloor 7/3\\rfloor=2$，这不足以操作第1列的FA（需要3个输入）。因此，任何第2列的比特都不能在少于三级FA的情况下产生：一级用于向第1列产生最多两个进位，第二级用于向第1列产生至少第三个比特，第三级用于压缩第1列并产生到第2列的进位。因此，任何实现的关键路径延迟至少为 $3T_{FA}$，而上述构造达到了这个下界。\n\n所以，最优实现的关键路径延迟是 $3T_{FA}$。", "answer": "$$\\boxed{3T_{FA}}$$", "id": "1918758"}]}