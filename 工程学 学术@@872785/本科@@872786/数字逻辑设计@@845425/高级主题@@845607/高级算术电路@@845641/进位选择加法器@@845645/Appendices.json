{"hands_on_practices": [{"introduction": "要理解任何数字电路，第一步都是分析其基本结构和资源成本。本练习旨在帮助您将选通进位加法器的并行架构可视化，并量化其硬件组成部分。通过计算构成一个12位加法器所需的4位加法器模块的总数，您将为理解其面积与速度之间的权衡奠定基础。[@problem_id:1919002]", "problem": "在设计一个定制处理器时，为了优化速度，实现了一个12位的进位选择加法器。该加法器由几个较小的4位行波进位加法器（RCA）模块构成。其架构如下：12位的输入被分为三个连续的4位段。第一个模块处理最低有效的4位（第0-3位），它直接计算其和与输出进位，并假设初始输入进位为0。对于随后的两个4位模块（分别处理第4-7位和第8-11位），每个模块都使用两个独立的4位RCA并行计算和与输出进位：一个假设前一级的输入进位为0，另一个则假设输入进位为1。然后，一个多路复用器根据前一级传播过来的实际进位，为每个模块选择正确的结果。为了确定所需的总硬件资源，设计者需要计算基本构建模块的数量。使用这种架构计算一个12位结果，总共执行了多少个独立的4位RCA运算？", "solution": "这个12位进位选择加法器被划分为三个4位段。第一个4位模块（第0–3位）使用一个4位RCA，初始输入进位为0，这构成了一次4位RCA运算。接下来的两个4位模块（第4–7位和第8–11位）每个都并行使用两个4位RCA，一个假设输入进位为0，另一个假设输入进位为1；两个计算都会执行，然后由一个多路复用器选择合适的结果，因此每个模块构成了两次4位RCA运算。因此，执行的4位RCA运算总数为\n$$N_{\\text{RCA}}=1+2+2=5.$$", "answer": "$$\\boxed{5}$$", "id": "1919002"}, {"introduction": "理解了选通进位加法器的结构之后，下一步是分析其性能，这也是选择它而非更简单的行波进位加法器的主要原因。本题侧重于计算电路的关键路径延迟，它决定了加法器的最高运行速度。通过追踪进位信号在不同级之间的传播路径，您将深入理解推测性计算是如何加速加法过程的。[@problem_id:1919043]", "problem": "一位数字系统工程师正在设计一个定制的9位算术逻辑单元，并需要评估一个所提出的加法器设计的性能。该设计是一个9位选通进位加法器（carry-select adder），用于计算和 `S = A + B`，其中 `A = A[8:0]` 和 `B = B[8:0]` 是9位二进制数。\n\n该加法器的架构被划分为三个阶段，每个阶段处理3个比特：\n- **阶段0（比特 2:0）：** 该阶段使用一个单一的3位行波进位加法器（RCA）实现。此阶段的进位输入被硬连接到逻辑'0'。\n- **阶段1（比特 5:3）：** 该阶段采用两个并行的3位RCA。第一个RCA在假定其块级进位输入为'0'的情况下计算和与进位输出。第二个RCA同时在假定其块级进位输入为'1'的情况下计算和与进位输出。然后，一组2对1多路复用器（MUX）根据由阶段0生成的实际进位输出信号，选择正确的3位和以及正确的1位进位输出。\n- **阶段2（比特 8:6）：** 该阶段在结构上与阶段1相同。其选择多路复用器由阶段1产生的最终进位输出信号控制。\n\n用于构建该加法器的基本组件具有以下延迟特性：\n- 每个3位RCA由三个1位全加器（FA）构成。\n- 对于一个1位全加器，从其任何输入（A, B, Cin）到其和（Sum）输出的传播延迟为 `t_FA_sum = 2.4` ns。\n- 从其任何输入（A, B, Cin）到其进位输出（Carry-out）的传播延迟为 `t_FA_carry = 1.8` ns。\n- 一个2对1多路复用器的传播延迟，从其选择输入到其单位输出测量，为 `t_MUX = 0.9` ns。假定从MUX的数据输入端开始的延迟小于此值，并且不在关键路径上。\n\n加法器的所有初始输入，特别是 `A` 和 `B` 的比特，在时间 `t=0` 时可用。计算该加法器为最终的最高有效进位比特（即阶段2的进位输出）生成一个稳定值所需的总时间。请用纳秒（ns）表示你的答案，并四舍五入到两位有效数字。", "solution": "我们将到达最终最高有效进位输出的关键路径确定为控制选通进位多路复用器的块级进位决策链，因为根据假设，MUX的选择到输出的延迟超过了MUX数据输入的延迟。\n\n已知：\n- 每个3位行波进位加法器（RCA）是三个串联的1位全加器。\n- 从任何FA输入到进位输出的延迟是 $t_{\\mathrm{FA,c}}=1.8$ ns。\n- 从MUX选择输入到输出的延迟是 $t_{\\mathrm{MUX}}=0.9$ ns。\n- 假定MUX数据输入的延迟小于 $t_{\\mathrm{MUX}}$ 且不在关键路径上。\n\n阶段0（比特 $[2:0]$）是一个进位输入固定为 $0$ 的3位RCA。从 $A[2:0],B[2:0]$ 到块进位输出的最坏情况延迟是三个FA进位传播延迟之和：\n$$\nt_{C0}=3\\,t_{\\mathrm{FA,c}}.\n$$\n阶段1（比特 $[5:3]$）预先计算了块进位输入的两种可能性，并使用一个由 $C0$ 选择的MUX。由于MUX的数据输入在时间 $3\\,t_{\\mathrm{FA,c}}$ 时就绪，而选择信号在 $t_{C0}$ 到达，因此阶段1的进位输出在选择到输出的MUX延迟之后出现：\n$$\nt_{C1}=t_{C0}+t_{\\mathrm{MUX}}=3\\,t_{\\mathrm{FA,c}}+t_{\\mathrm{MUX}}.\n$$\n阶段2（比特 $[8:6]$）是相同的，其MUX由 $C1$ 选择。它的两个预先计算的进位候选项在 $3\\,t_{\\mathrm{FA,c}}$ 时就绪，这个时间早于或等于选择信号的到达时间。因此，最终的进位输出在又一个MUX选择延迟之后出现：\n$$\nt_{\\mathrm{final}}=t_{C1}+t_{\\mathrm{MUX}}=3\\,t_{\\mathrm{FA,c}}+2\\,t_{\\mathrm{MUX}}.\n$$\n代入给定的数值并简化：\n$$\nt_{\\mathrm{final}}=3\\cdot 1.8+2\\cdot 0.9=5.4+1.8=7.2\\ \\text{ns}.\n$$\n四舍五入到两位有效数字，结果仍然是 $7.2$。", "answer": "$$\\boxed{7.2}$$", "id": "1919043"}, {"introduction": "在掌握了结构和延迟的概念之后，最后的这个练习将带您进入工程设计的一个核心环节：优化。选通进位加法器的性能很大程度上取决于其块大小（block size）的划分。本题将引导您通过数学推导，找到最小化总延迟的最优块大小，从而揭示块内行波进位延迟与块间多路选择器延迟之间的设计权衡。[@problem_id:1919060]", "problem": "您是一名正在设计定制算术逻辑单元 (ALU) 的工程师，任务是优化一个N位进位选择加法器。该加法器通过将N位分成M个大小相等的块来构建，每个块为k位，其中N是k的倍数。\n\n其架构如下：\n- 第一个块（处理第0位到第k-1位）是一个标准的k位行波进位加法器 (RCA)。\n- 随后的每个块（从第2块到第M块）均由两个并行的k位RCA组成。一个RCA在假设输入进位为0的情况下计算和与进位输出，另一个则在假设输入进位为1的情况下进行相同计算。然后，一组2到1多路选择器根据来自前一个块的实际输入进位，为该块选择正确的k个和位以及单个进位输出位。\n\n假设以下均匀的传播延迟：\n- 单个全加器（从任何输入到任何输出）的最坏情况传播延迟为 `t_{FA}`。\n- 设计中使用的任何2到1多路选择器的传播延迟为 `t_{MUX}`。\n- 所有主输入（`A_i`、`B_i` 和初始进位 `C_0`）可用的时间为 `t=0`。\n\n您的目标是找到最佳块大小 `k`，以最小化整个N位加法器的最坏情况传播延迟。为此推导，您应将 `k` 视为一个连续实数变量。请推导出一个用 `N`、`t_{FA}` 和 `t_{MUX}` 表示的最佳块大小 `k` 的封闭形式表达式。", "solution": "设 $N$ 位加法器被划分为 $M$ 个大小为 $k$ 位的相等块，因此 $M = N/k$（其中 $N$ 是 $k$ 的倍数）。所有主输入在 $t=0$ 时均可用。\n\n首先，描述一个块内的延迟特性：\n- 一个 $k$ 位行波进位加法器 (RCA) 从其输入到其进位输出以及最高有效和位的最坏情况延迟为 $k\\,t_{FA}$，因为进位必须行波通过 $k$ 个全加器。\n\n现在追踪整个进位选择结构中的最坏情况路径：\n- 块 $1$ 是一个单独的 $k$ 位RCA。其进位输出（及其最高有效和）在以下时间准备就绪：\n$$\nT_{1} = k\\,t_{FA}.\n$$\n- 对于每个后续块 $j \\geq 2$，两个 $k$ 位RCA会预先计算假设输入进位为 $0$ 和 $1$ 时的结果。它们的输出（包括和的候选项和进位输出的候选项）在时间 $k\\,t_{FA}$ 前准备就绪。块 $j$ 的实际输出由一组受块 $j-1$ 实际输入进位控制的 $2$-到-$1$ 多路选择器选出。因此，块 $j$ 的输出在以下时间准备就绪：\n$$\nT_{j} = \\max\\!\\big(k\\,t_{FA},\\,T_{j-1}\\big) + t_{MUX}.\n$$\n由于 $T_{1} = k\\,t_{FA}$，通过归纳法可得\n$$\nT_{j} = k\\,t_{FA} + (j-1)\\,t_{MUX}, \\quad j = 1,2,\\dots,M.\n$$\n因此，$N$ 位加法器的总最坏情况延迟（即最后一个块 $M$ 的延迟）为\n$$\nT_{\\text{total}}(k) = T_{M} = k\\,t_{FA} + (M-1)\\,t_{MUX}.\n$$\n代入 $M = N/k$ 得\n$$\nT_{\\text{total}}(k) = k\\,t_{FA} + \\left(\\frac{N}{k} - 1\\right)t_{MUX}.\n$$\n\n对 $k>0$（视为连续变量）进行优化。定义\n$$\ng(k) = k\\,t_{FA} + \\frac{N\\,t_{MUX}}{k},\n$$\n该函数与 $T_{\\text{total}}(k)$ 仅相差一个对优化无关的常数偏移量 $-t_{MUX}$。求导并令其为零：\n$$\n\\frac{dg}{dk} = t_{FA} - \\frac{N\\,t_{MUX}}{k^{2}} = 0\n\\quad\\Longrightarrow\\quad\nk^{2} = \\frac{N\\,t_{MUX}}{t_{FA}}.\n$$\n因此驻点为\n$$\nk^{*} = \\left(\\frac{N\\,t_{MUX}}{t_{FA}}\\right)^{\\frac{1}{2}}.\n$$\n二阶导数\n$$\n\\frac{d^{2}g}{dk^{2}} = \\frac{2N\\,t_{MUX}}{k^{3}} > 0\n$$\n证实了这是一个最小值点。因此，最佳块大小（在连续松弛条件下）为\n$$\nk_{\\text{opt}} = \\left(\\frac{N\\,t_{MUX}}{t_{FA}}\\right)^{\\frac{1}{2}}.\n$$", "answer": "$$\\boxed{\\left(\\frac{N\\,t_{MUX}}{t_{FA}}\\right)^{\\frac{1}{2}}}$$", "id": "1919060"}]}