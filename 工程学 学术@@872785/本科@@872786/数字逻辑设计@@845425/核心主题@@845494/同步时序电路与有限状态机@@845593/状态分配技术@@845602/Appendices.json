{"hands_on_practices": [{"introduction": "在我们深入研究选择“最佳”状态分配的策略之前，首先了解设计空间的规模是至关重要的。这个练习将通过一个简单的组合数学问题，量化一个具有五个状态的有限状态机有多少种可能的状态编码方式[@problem_id:1961687]。通过计算，你将直观地感受到为什么随机选择或穷举搜索是不可行的，从而理解系统化状态分配技术的必要性。", "problem": "一位数字系统工程师正在为一台小型自动化实验室机器人设计控制器。该机器人的操作被建模为一个具有五个不同状态的有限状态机 (FSM)：IDLE、FETCH、MIX、TEST 和 CLEAN。为了在硬件中实现这个 FSM，每个状态都必须被分配一个唯一的二进制码。首席工程师决定使用一个3位二进制编码方案来进行状态表示。\n\n您的任务是确定所有可能的、唯一的状态分配总数。如果一个分配与另一个分配相比，至少有一个状态被分配给了不同的二进制码，那么这个分配就被认为是唯一的。计算将五个状态分配给唯一的3位二进制码的不同方式的总数。", "solution": "共有 $2^{3}=8$ 个不同的 $3$ 位二进制码可用。五个状态 (IDLE, FETCH, MIX, TEST, CLEAN) 是不同的，因此分配唯一的编码对应于计算从一个 $5$ 元素集合到一个 $8$ 元素集合的单射数量。\n\n根据乘法法则（不同元素的无重复排列），这种分配的数量是从 $8$ 个项目中取 $5$ 个的排列数：\n$$\nP(8,5)=\\frac{8!}{(8-5)!}=\\frac{8!}{3!}.\n$$\n\n等价地，可以先选择使用哪 $5$ 个编码，然后再将它们分配给 $5$ 个状态：\n$$\n\\binom{8}{5}\\cdot 5!=\\frac{8!}{5!\\,3!}\\cdot 5!=\\frac{8!}{3!}.\n$$\n\n计算结果为，\n$$\n\\frac{8!}{3!}=\\frac{8\\cdot 7\\cdot 6\\cdot 5\\cdot 4\\cdot 3\\cdot 2\\cdot 1}{3\\cdot 2\\cdot 1}=8\\cdot 7\\cdot 6\\cdot 5\\cdot 4=6720.\n$$", "answer": "$$\\boxed{6720}$$", "id": "1961687"}, {"introduction": "状态分配的核心目标之一是优化数字逻辑电路，以实现更高的速度、更低的功耗或更小的面积。此练习聚焦于一项基本且高效的优化启发式规则：为频繁发生状态转换的两个状态分配相邻的二进制代码（即汉明距离为1）。[@problem_id:1961721]。这种“邻接原则”可以显著简化生成下一状态的组合逻辑，本题要求你评估两种不同的分配方案，并判断哪一种更符合这一优化目标。", "problem": "一位数字设计工程师正在为一种特制的机械臂开发控制器。该控制器的行为被建模为一个有限状态机 (FSM)，具有三个不同的操作状态：`IDLE`、`GRASP` 和 `MOVE`。根据操作分析，从 `GRASP` 状态到 `MOVE` 状态的转换发生频率最高，因此是逻辑优化的关键路径。\n\n为了实现这个 FSM，使用了两个状态变量 $Q_1$ 和 $Q_0$。工程师正在评估两种不同的二进制状态分配方案，以确定哪一种更为优化。在此背景下，一个优化的分配方案是指对最频繁的转换（`GRASP` 到 `MOVE`）满足邻接原则的方案，因为这通常会使次态解码器的组合逻辑更简单。\n\n两种提议的状态分配方案如下：\n\n**分配方案 A：**\n- `IDLE`:  $Q_1Q_0 = 00$\n- `GRASP`: $Q_1Q_0 = 10$\n- `MOVE`:  $Q_1Q_0 = 11$\n\n**分配方案 B：**\n- `IDLE`:  $Q_1Q_0 = 00$\n- `GRASP`: $Q_1Q_0 = 01$\n- `MOVE`:  $Q_1Q_0 = 10$\n\n鉴于优化 `GRASP` 到 `MOVE` 转换的目标，以下哪个陈述基于邻接原则正确地评估了这两种分配方案？\n\nA. 分配方案 B 满足 `GRASP` 到 `MOVE` 转换的邻接原则，而分配方案 A 不满足。\n\nB. 分配方案 A 和分配方案 B 都满足 `GRASP` 到 `MOVE` 转换的邻接原则。\n\nC. 邻接原则在此处不适用，因为状态数量（三个）不是 2 的整数次幂。\n\nD. 分配方案 A 满足 `GRASP` 到 `MOVE` 转换的邻接原则，而分配方案 B 不满足。\n\nE. 分配方案 A 和分配方案 B 都不满足 `GRASP` 到 `MOVE` 转换的邻接原则。", "solution": "FSM 中状态分配的邻接原则指出，为了简化次态逻辑（例如，通过卡诺图），最频繁的转换应该发生在二进制编码仅相差一位的状态之间。这对应于所分配的二进制码之间的汉明距离为 1。\n\n令 $d_{H}$ 表示 $\\{0,1\\}^2$ 上的汉明距离，定义为两个二进制向量在不同位的数量。我们关注的转换是从 GRASP 到 MOVE。\n\n对于分配方案 A：GRASP 的状态为 $Q_{1}Q_{0}=10$，MOVE 的状态为 $Q_{1}Q_{0}=11$。将它们写成向量形式，GRASP 是 $(1,0)$，MOVE 是 $(1,1)$。这两个编码仅在 $Q_{0}$ 位上不同，因此\n$$\nd_{H}\\big((1,0),(1,1)\\big)=1,\n$$\n所以满足邻接原则。\n\n对于分配方案 B：GRASP 的状态为 $Q_{1}Q_{0}=01$，MOVE 的状态为 $Q_{1}Q_{0}=10$。作为向量，GRASP 是 $(0,1)$，MOVE 是 $(1,0)$。这两个编码在 $Q_{1}$ 和 $Q_{0}$ 位上都不同，因此\n$$\nd_{H}\\big((0,1),(1,0)\\big)=2,\n$$\n所以不满足邻接原则。\n\n因此，只有分配方案 A 满足从 GRASP 到 MOVE 转换的邻接原则。", "answer": "$$\\boxed{D}$$", "id": "1961721"}, {"introduction": "掌握了从状态表到逻辑方程的设计流程后，一个更具挑战性的任务是逆向工程：从最终的电路实现反推出最初的设计选择。这个练习将让你扮演一名数字电路侦探，根据已简化的下一状态逻辑方程和原始的状态转换表，推导出唯一能够连接这两者的状态分配方案[@problem_id:1961707]。完成这项任务不仅能巩固你对整个设计流程的理解，更能加深你对抽象状态、二进制编码和硬件实现三者之间内在联系的认识。", "problem": "一名工程师的任务是对一个旧式控制单元进行逆向工程。已知该单元是一个四状态米利（Mealy）有限状态机（FSM），其状态在历史上被标记为 A、B、C 和 D，并且它接收单个输入 $X$。原始文档包含了状态转换表，但具体的二进制状态分配和输出逻辑设计已经丢失。\n\n该实现使用了两个 D 型触发器，其状态变量表示为 $Q_1$ 和 $Q_0$。通过电路分析，该工程师成功推导出了简化的次态逻辑方程，如下所示：\n$$Q_{1,\\text{next}} = Q_0$$\n$$Q_{0,\\text{next}} = \\overline{Q_1} + X$$\n其中 $\\overline{Q_1}$ 表示 $Q_1$ 的逻辑非，而 $+$ 表示逻辑或运算。\n\n记录的状态转换表如下：\n\n| 当前状态 | 下一状态 (若 X=0) | 下一状态 (若 X=1) |\n|:-------------:|:---------------------:|:---------------------:|\n|       A       |           B           |           B           |\n|       B       |           D           |           D           |\n|       C       |           A           |           B           |\n|       D       |           C           |           D           |\n\n根据这些信息，确定必须为每个符号状态使用的二进制状态分配码（$Q_1Q_0$）。从以下选项中选择正确的一组分配。\n\nA. A = `00`, B = `01`, C = `10`, D = `11`\n\nB. A = `00`, B = `01`, C = `11`, D = `10`\n\nC. A = `11`, B = `10`, C = `01`, D = `00`\n\nD. A = `10`, B = `00`, C = `01`, D = `11`\n\nE. A = `01`, B = `11`, C = `00`, D = `10`", "solution": "给定一个用两个 D 型触发器实现的四状态 Mealy FSM，其状态变量为 $Q_1$ 和 $Q_0$，次态方程为\n$$\nQ_{1,\\text{next}}=Q_0,\\qquad Q_{0,\\text{next}}=\\overline{Q_1}+X,\n$$\n其中 $+$ 表示逻辑或。二进制状态为 $Q_1Q_0 \\in \\{00, 01, 10, 11\\}$。我们推导每个当前状态和输入 $X$ 的状态转换。\n\n1) 对于 $Q_1Q_0=00$：$Q_{1,\\text{next}}=Q_0=0$ 且 $Q_{0,\\text{next}}=\\overline{Q_1}+X=1+X=1$ (对于 $X=0$ 和 $X=1$ 均成立)。因此，\n$00 \\to 01 \\text{ for } X \\in \\{0, 1\\}.$\n\n2) 对于 $Q_1Q_0=01$：$Q_{1,\\text{next}}=Q_0=1$ 且 $Q_{0,\\text{next}}=\\overline{Q_1}+X=1+X=1$ (对于 $X=0$ 和 $X=1$ 均成立)。因此，\n$01 \\to 11 \\text{ for } X \\in \\{0, 1\\}.$\n\n3) 对于 $Q_1Q_0=10$：$Q_{1,\\text{next}}=Q_0=0$ 且 $Q_{0,\\text{next}}=\\overline{Q_1}+X=0+X=X$。因此，\n$10 \\to 00 \\text{ if } X=0,\\qquad 10 \\to 01 \\text{ if } X=1.$\n\n4) 对于 $Q_1Q_0=11$：$Q_{1,\\text{next}}=Q_0=1$ 且 $Q_{0,\\text{next}}=\\overline{Q_1}+X=0+X=X$。因此，\n$11 \\to 10 \\text{ if } X=0,\\qquad 11 \\to 11 \\text{ if } X=1.$\n\n现在将这些与记录的符号转换进行匹配：\n- A: 对于 $X=0$ 和 $X=1$，下一状态都是 B。\n- B: 对于 $X=0$ 和 $X=1$，下一状态都是 D。\n- C: 若 $X=0$，下一状态是 A；若 $X=1$，下一状态是 B。\n- D: 若 $X=0$，下一状态是 C；若 $X=1$，下一状态是 D。\n\n从推导出的二进制转换中，其下一状态与 $X$ 无关的状态仅有 $00$ 和 $01$。因此，A 和 B 必须是 $00$ 和 $01$（顺序待定）。\n\n如果我们设 $A=00$，那么从 $00$ 开始，对于两个输入，下一状态都是 $01$，所以 $B=01$。从 $01$ 开始，对于两个输入，下一状态都是 $11$，所以 $D=11$。从 $11$ 开始，若 $X=0$ 则下一状态是 $10$，若 $X=1$ 则下一状态是 $11$，这与 D 在 $X=0$ 时转换为 C、在 $X=1$ 时转换为 D 的情况相匹配，因此 $C=10$。最后，检查 $C=10$：若 $X=0$ 则它转换为 $00$，若 $X=1$ 则转换为 $01$，这与 $C \\to A$ (当 $X=0$) 和 $C \\to B$ (当 $X=1$) 相匹配。因此，一致的分配是\n$$A=00, \\quad B=01, \\quad C=10, \\quad D=11,$$\n这对应于选项 A。\n\n没有其他分配可以满足要求，因为如果 $A=01$，那么其与 $X$ 无关的后继状态将是 $11$，但 $11$ 的转换并非与 $X$ 无关，这与“B 的转换与 $X$ 无关”这一要求相矛盾。因此，该映射是唯一的。", "answer": "$$\\boxed{A}$$", "id": "1961707"}]}