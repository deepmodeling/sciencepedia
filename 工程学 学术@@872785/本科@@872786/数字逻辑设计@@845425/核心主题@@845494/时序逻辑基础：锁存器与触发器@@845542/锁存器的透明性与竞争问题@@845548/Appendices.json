{"hands_on_practices": [{"introduction": "理论知识最有效的检验方式是将其应用于实践。让我们从一个基础练习开始，探索电平敏感锁存器透明性的一个直接后果。通过将一个 D 锁存器的反相输出（$\\bar{Q}$）反馈到其数据输入（$D$），我们可以构建一个简单的振荡器，这个练习将帮助我们计算其振荡频率，从而直观地理解传播延迟如何决定电路的动态行为。[@problem_id:1943993]", "problem": "一位数字电路设计者需要使用芯片上的一个闲置元件来生成一个简单的时钟信号。该元件是一个电平敏感的 D 锁存器。D 锁存器是一种数字逻辑电路，它有一个数据输入端（$D$）、一个使能输入端（$EN$）、一个主输出端（$Q$）和一个反相输出端（$\\bar{Q}$）。当使能输入端 $EN$ 保持在高电平时，锁存器被称为“透明”的，其输出 $Q$ 会持续跟随数据输入 $D$ 的状态。当 $EN$ 为低电平时，锁存器会保持其最后一个状态，忽略 $D$ 输入。\n\n为了创建一个振荡器，设计者将反相输出 $\\bar{Q}$ 直接接回到数据输入 $D$。使能输入端 $EN$ 被永久连接到一个高电平电压源，以确保锁存器始终处于透明状态。锁存器的传输延迟，定义为 $D$ 输入端的变化引起 $Q$ 和 $\\bar{Q}$ 输出端相应变化所需的时间，为 $t_{pd} = 8.0$ 纳秒。\n\n假设电路通电并开始振荡，计算输出端 $Q$ 上产生的方波信号的频率。将答案以兆赫兹（MHz）为单位表示，并四舍五入到三位有效数字。", "solution": "在使能端保持高电平时，D 锁存器是透明的，其行为类似于一个具有传输延迟的非反相缓冲器。这可以用以下关系式来建模：\n$$\nQ(t) = D(t - t_{pd}).\n$$\n在给定的接线方式中，数据输入由反相输出驱动，因此\n$$\nD(t) = \\overline{Q(t)}.\n$$\n代入延迟关系式，得到延迟-反相方程\n$$\nQ(t) = \\overline{Q(t - t_{pd})}.\n$$\n将此关系式应用两次，可得\n$$\nQ(t) = \\overline{Q(t - t_{pd})} = \\overline{\\overline{Q(t - 2 t_{pd})}} = Q(t - 2 t_{pd}),\n$$\n这表明波形是周期性的，周期为\n$$\nT = 2 t_{pd}.\n$$\n因此，振荡频率为\n$$\nf = \\frac{1}{T} = \\frac{1}{2 t_{pd}}.\n$$\n已知 $t_{pd} = 8.0 \\text{ ns} = 8.0 \\times 10^{-9} \\text{ s}$，\n$$\nf = \\frac{1}{2 \\times 8.0 \\times 10^{-9}} = \\frac{1}{16.0 \\times 10^{-9}} = 0.0625 \\times 10^{9} \\text{ Hz} = 62.5 \\times 10^{6} \\text{ Hz}.\n$$\n以兆赫兹为单位表示并四舍五入到三位有效数字，结果为 $62.5$。", "answer": "$$\\boxed{62.5}$$", "id": "1943993"}, {"introduction": "锁存器的透明窗口既是其功能特点，也可能成为一个潜在的弱点。本练习将探讨一种更微妙的情况：锁存器在透明期间捕获到由组合逻辑毛刺引起的瞬态信号。通过分析一个带有静态险象的电路，我们将看到为何时序分析不仅要考虑稳定信号，还必须警惕这些可能被“看”到的短暂不稳定状态。[@problem_id:1944012]", "problem": "一个组合逻辑电路由三个输入 $A$、$B$、$C$ 和一个单一输出 $Y$ 实现。该电路的行为由布尔表达式 $Y = (A \\cdot B) + (A' \\cdot C)$ 描述，其中 $A'$ 表示 $A$ 的逻辑非。该电路使用具有以下传播延迟的特定逻辑门构建：任何非门的延迟为 $t_{inv} = 2 \\text{ ns}$，任何2输入与门的延迟为 $t_{and} = 3 \\text{ ns}$，最终的2输入或门的延迟为 $t_{or} = 4 \\text{ ns}$。\n\n最初，在所有时间 $t  10 \\text{ ns}$ 内，输入稳定保持在 $A=1$，$B=1$ 和 $C=1$。在 $t = 10 \\text{ ns}$ 时刻，输入 $A$ 瞬间从 $1$ 跃迁到 $0$。输入 $B$ 和 $C$ 在所有时间内保持为 $1$ 不变。\n\n该组合逻辑电路的输出 $Y$ 被送入一个电平敏感的D锁存器的 $D$ 输入端。该锁存器的使能信号是一个表示为 $CLK$ 的单脉冲。当 $CLK=1$ 时，锁存器是透明的（其输出 $Q$ 等于其输入 $D$）。锁存器在 $CLK$ 从 $1$ 跃迁到 $0$ 的确切时刻捕获并保持 $D$ 的值。为简单起见，假设锁存器的建立时间和保持时间均为零。$CLK$ 信号在 $t  16 \\text{ ns}$ 时为 $0$，在 $t = 16 \\text{ ns}$ 时跃迁到 $1$，并在 $t = 18 \\text{ ns}$ 时跃迁回 $0$。\n\n确定在所有时间 $t > 18 \\text{ ns}$ 内，存储在D锁存器输出 $Q$ 中的最终稳定逻辑值。你的答案应该是数字0或数字1。", "solution": "布尔函数为 $Y=(A\\cdot B)+(A'\\cdot C)$。在 $B=1$ 和 $C=1$ 保持不变的情况下，理想（零延迟）逻辑简化为\n$$\nY=(A\\cdot 1)+(A'\\cdot 1)=A+A'=1,\n$$\n因此，输出端任何偏离 $1$ 的情况都必定是由于路径延迟不相等（静态1冒险）造成的。\n\n设传播延迟为 $t_{inv}=2 \\text{ ns}$，$t_{and}=3 \\text{ ns}$ 和 $t_{or}=4 \\text{ ns}$。将输入跃迁的时间定义为 $t_{0}=10 \\text{ ns}$，此时 $A$ 从 $1$ 变为 $0$，而 $B=C=1$ 保持不变。\n\n从 $A$ 到或门输入有两条路径：\n- 路径P1（对于 $A\\cdot B$）：延迟 $d_{1}=t_{and}$。\n- 路径P2（对于 $A'\\cdot C$）：延迟 $d_{2}=t_{inv}+t_{and}$。\n\n在 $t_{0}$ 之前，当 $A=1$，$B=1$ 和 $C=1$ 时，或门的输入为 $(A\\cdot B, A'\\cdot C)=(1,0)$。在 $t_{0}$ 时刻 $A$ 下降后，P1项在以下时间发生 $1\\to 0$ 跃迁：\n$$\nt_{1}=t_{0}+d_{1}=t_{0}+t_{and}=10 \\text{ ns}+3 \\text{ ns}=13 \\text{ ns},\n$$\n而在路径P2上，反相器输出 $A'$ 在 $t_{0}+t_{inv}=12 \\text{ ns}$ 时发生 $0\\to 1$ 跃迁，然后与门输出 $A'\\cdot C$ 在以下时间发生 $0\\to 1$ 跃迁：\n$$\nt_{2}=t_{0}+d_{2}=t_{0}+t_{inv}+t_{and}=10 \\text{ ns}+2 \\text{ ns}+3 \\text{ ns}=15 \\text{ ns}.\n$$\n因此，或门输入的变化如下：\n- 对于 $t  13 \\text{ ns}$，或门输入为 $(1,0)$。\n- 对于 $13 \\text{ ns} \\le t  15 \\text{ ns}$，或门输入为 $(0,0)$。\n- 对于 $t \\ge 15 \\text{ ns}$，或门输入为 $(0,1)$。\n\n现在我们分析或门的输出 $Y$，其传播延迟为 $t_{or}=4 \\text{ ns}$：\n- 由于输入在 $t  13 \\text{ ns}$ 时为 $(1,0)$，输出 $Y$ 稳定在 $1$。\n- 在 $t = 13 \\text{ ns}$ 时，输入变为 $(0,0)$。输出 $Y$ 将在 $13 \\text{ ns} + t_{or} = 17 \\text{ ns}$ 时从 $1$ 跃迁到 $0$。\n- 在 $t = 15 \\text{ ns}$ 时，输入变为 $(0,1)$。输出 $Y$ 将在 $15 \\text{ ns} + t_{or} = 19 \\text{ ns}$ 时从 $0$ 跃迁到 $1$。\n\n所以，输出 $Y$ 在 $17 \\text{ ns} \\le t  19 \\text{ ns}$ 期间经历了一个短暂的低电平毛刺。\n\n锁存器在 $t=18 \\text{ ns}$ 的下降沿捕获其输入 $D=Y$ 的值。我们需要确定在 $t=18 \\text{ ns}$ 时 $Y$ 的值。根据我们的分析，毛刺从 $t=17 \\text{ ns}$ 开始，到 $t=19 \\text{ ns}$ 结束。因此，在 $t=18 \\text{ ns}$ 时刻，$Y$ 的值为 $0$。\n\n锁存器将捕获值 $0$。", "answer": "$$\\boxed{0}$$", "id": "1944012"}, {"introduction": "在实际的高性能同步系统中，竞争冒险问题通常表现为保持时间违规，其根本原因是信号传播过快。这个综合性练习模拟了一个真实的流水线场景，其中组合逻辑的延迟并非固定不变，而是依赖于其处理的数据。通过这个练习，我们将学会如何进行数据相关的最短路径分析，以识别出那些可能导致灾难性时序故障的特定输入模式。[@problem_id:1943992]", "problem": "在高性能同步数字系统中，关键路径分析不仅涉及最长路径（建立时间），还涉及最短路径（保持时间）。当信号通过组合逻辑传播过快，导致下游时序元件发生保持时间违规时，就可能出现竞争直通（race-through）情况。\n\n考虑一个电路段，它由一个4位D型透明锁存器 `L` 和一个其后的组合逻辑块 `C` 组成，`C` 的输出馈入一个D型边沿触发触发器 `FF`。`L` 和 `FF` 都由同一个时钟 `CLK` 驱动。当 `CLK` 为高电平时，锁存器 `L` 是透明的；触发器 `FF` 在 `CLK` 的正（上升）沿捕获其输入。\n\n锁存器的4位输出 $Q[3:0]$ 直接连接到组合逻辑块的4位输入 $A[3:0]$，其中 $A[0]$ 是最低有效位。逻辑块 `C` 有一个单比特输出 $Z$，连接到触发器 `FF` 的D输入端。`C` 实现的功能等效于一个4到1多路复用器，其选择线和数据输入由输入向量 $A$ 导出，如下所示：\n\n-   多路复用器选择线：$S_1 = A[3]$ 和 $S_0 = A[2]$。\n-   多路复用器数据输入：\n    -   当 $S_1S_0 = 00$ 时，选择 $Y_0 = A[1] \\text{ 与 } A[0]$。\n    -   当 $S_1S_0 = 01$ 时，选择 $Y_1 = A[1] \\text{ 或 } A[0]$。\n    -   当 $S_1S_0 = 10$ 时，选择 $Y_2 = A[1] \\text{ 异或 } A[0]$。\n    -   当 $S_1S_0 = 11$ 时，选择 $Y_3 = \\text{非 } A[1]$。\n\n对于给定的输入向量 $A$，通过组合逻辑块 `C` 的总传播延迟（记为 $\\tau_{\\text{logic}}$）是生成所选数据输入（$Y_k$）的逻辑门的延迟与一个固定的内部多路复用器路径延迟之和。\n\n电路元件的时序参数如下：\n-   锁存器时钟到Q输出的传播延迟：$\\tau_{c-q} = 55$ ps。\n-   触发器保持时间要求：$\\tau_{\\text{hold}} = 105$ ps。\n-   固定的内部MUX数据到输出延迟：$\\tau_{\\text{mux}} = 35$ ps。\n-   单个逻辑门的传播延迟：\n    -   双输入与门：$\\tau_{\\text{and}} = 22$ ps。\n    -   双输入或门：$\\tau_{\\text{or}} = 26$ ps。\n    -   双输入异或门：$\\tau_{\\text{xor}} = 38$ ps。\n    -   非门（反相器）：$\\tau_{\\text{not}} = 12$ ps。\n\n如果来自锁存器的信号通过组合逻辑传播并比要求的保持时间更快地到达触发器的输入端，则会发生保持时间违规。请确定所有会导致此类违规的4位输入向量 $A[3:0]$。列出所有这些向量的等效十进制整数。如果有多个值，则必须将它们列在单个集合中。", "solution": "在此电路中，当一个新数据值在时钟沿之后从透明锁存器 `L` 传播，并在其所需的保持时间结束之前到达触发器 `FF` 时，就会发生保持时间违规。这种竞争直通条件的路径是从锁存器的输出 `Q`，经过组合逻辑 `C`，到达触发器 `FF` 的D输入端。该路径的总延迟是锁存器的时钟到Q输出延迟（$\\tau_{c-q}$）和组合逻辑的传播延迟（$\\tau_{\\text{logic}}$）之和。\n\n保持时间违规的条件可用数学公式表示为：\n$$\n\\tau_{c-q} + \\tau_{\\text{logic}}  \\tau_{\\text{hold}}\n$$\n\n给定的时序参数如下：\n-   $\\tau_{c-q} = 55$ ps\n-   $\\tau_{\\text{hold}} = 105$ ps\n\n将这些值代入不等式，我们可以确定会导致违规的关键逻辑延迟：\n$$\n55 \\text{ ps} + \\tau_{\\text{logic}}  105 \\text{ ps}\n$$\n$$\n\\tau_{\\text{logic}}  105 \\text{ ps} - 55 \\text{ ps}\n$$\n$$\n\\tau_{\\text{logic}}  50 \\text{ ps}\n$$\n\n对于任何导致组合逻辑延迟 $\\tau_{\\text{logic}}$ 小于 50 ps 的输入向量 $A[3:0]$，都会发生保持时间违规。题中指出，$\\tau_{\\text{logic}}$ 依赖于输入向量 $A$，因为两个最高有效位 $A[3]$ 和 $A[2]$ 作为多路复用器结构的选择线。我们必须计算由 $A[3:2]$ 决定的四种可能情况下的逻辑延迟。\n\n总逻辑延迟等于生成所选MUX数据输入（$Y_k$）的逻辑门延迟与固定的内部MUX延迟（$\\tau_{\\text{mux}} = 35$ ps）之和。\n\n情况1：$A[3:2] = 00_2$\n多路复用器选择数据输入 $Y_0 = A[1] \\text{ 与 } A[0]$。逻辑路径涉及一个双输入与门。\n该路径的延迟为：\n$$\n\\tau_{\\text{logic}} = \\tau_{\\text{and}} + \\tau_{\\text{mux}} = 22 \\text{ ps} + 35 \\text{ ps} = 57 \\text{ ps}\n$$\n由于 $57 \\text{ ps} \\not 50 \\text{ ps}$，此情况下不发生违规。\n\n情况2：$A[3:2] = 01_2$\n多路复用器选择数据输入 $Y_1 = A[1] \\text{ 或 } A[0]$。逻辑路径涉及一个双输入或门。\n该路径的延迟为：\n$$\n\\tau_{\\text{logic}} = \\tau_{\\text{or}} + \\tau_{\\text{mux}} = 26 \\text{ ps} + 35 \\text{ ps} = 61 \\text{ ps}\n$$\n由于 $61 \\text{ ps} \\not 50 \\text{ ps}$，此情况下不发生违规。\n\n情况3：$A[3:2] = 10_2$\n多路复用器选择数据输入 $Y_2 = A[1] \\text{ 异或 } A[0]$。逻辑路径涉及一个双输入异或门。\n该路径的延迟为：\n$$\n\\tau_{\\text{logic}} = \\tau_{\\text{xor}} + \\tau_{\\text{mux}} = 38 \\text{ ps} + 35 \\text{ ps} = 73 \\text{ ps}\n$$\n由于 $73 \\text{ ps} \\not 50 \\text{ ps}$，此情况下不发生违规。\n\n情况4：$A[3:2] = 11_2$\n多路复用器选择数据输入 $Y_3 = \\text{非 } A[1]$。逻辑路径涉及一个非门。\n该路径的延迟为：\n$$\n\\tau_{\\text{logic}} = \\tau_{\\text{not}} + \\tau_{\\text{mux}} = 12 \\text{ ps} + 35 \\text{ ps} = 47 \\text{ ps}\n$$\n由于 $47 \\text{ ps}  50 \\text{ ps}$，此情况下发生保持时间违规。\n\n当输入位 $A[3]$ 和 $A[2]$ 均为1时，就会发生违规。较低的两位 $A[1]$ 和 $A[0]$ 的值不影响此最短路径的传播延迟，因此当 $A[3:2] = 11_2$ 时，$A[1]$ 和 $A[0]$ 的所有组合都会导致违规。导致违规的4位输入向量 $A[3:0]$ 是：\n-   $1100_2$\n-   $1101_2$\n-   $1110_2$\n-   $1111_2$\n\n题目要求的是这些二进制向量的等效十进制整数。\n-   $1100_2 = 1 \\times 2^3 + 1 \\times 2^2 + 0 \\times 2^1 + 0 \\times 2^0 = 8 + 4 + 0 + 0 = 12$\n-   $1101_2 = 1 \\times 2^3 + 1 \\times 2^2 + 0 \\times 2^1 + 1 \\times 2^0 = 8 + 4 + 0 + 1 = 13$\n-   $1110_2 = 1 \\times 2^3 + 1 \\times 2^2 + 1 \\times 2^1 + 0 \\times 2^0 = 8 + 4 + 2 + 0 = 14$\n-   $1111_2 = 1 \\times 2^3 + 1 \\times 2^2 + 1 \\times 2^1 + 1 \\times 2^0 = 8 + 4 + 2 + 1 = 15$\n\n导致保持时间违规的输入向量的十进制等价值是 12、13、14 和 15。", "answer": "$$\\boxed{\\{12, 13, 14, 15\\}}$$", "id": "1943992"}]}