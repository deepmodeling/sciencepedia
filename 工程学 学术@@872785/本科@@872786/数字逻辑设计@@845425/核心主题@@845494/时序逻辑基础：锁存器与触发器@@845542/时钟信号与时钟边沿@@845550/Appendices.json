{"hands_on_practices": [{"introduction": "掌握数字逻辑设计的关键在于将理论应用于实践。在我们深入研究时钟*边沿*如何驱动电路之前，我们必须首先能够精确描述时钟*信号*本身。这项基础练习旨在巩固您对时钟信号基本属性（如频率 $f$、周期 $T$ 和占空比 $D$）的理解，这是进行任何时序分析的必备基础。通过计算一个具体场景下的高电平持续时间，您将把这些抽象概念转化为具体的数值。[@problem_id:1920932]", "problem": "微控制器单元（MCU）根据周期性时钟信号运行，该信号决定了其内部操作的时序。该信号在逻辑“高”电平状态和逻辑“低”电平状态之间交替。该时钟信号的频率指定为 40 MHz。信号的占空比，定义为信号处于逻辑“高”电平状态的时间占总周期的比例，为 30%。\n\n计算在单个时钟周期内，时钟信号保持在逻辑“高”电平状态的总时长。\n\n以纳秒（ns）为单位表示您的最终答案，并四舍五入到两位有效数字。", "solution": "时钟周期 $T$ 是频率 $f$ 的倒数：\n$$\nT=\\frac{1}{f}.\n$$\n给定 $f=40 \\times 10^{6} \\text{ s}^{-1}$，周期为\n$$\nT=\\frac{1}{40 \\times 10^{6}} \\text{ s}.\n$$\n占空比 $D$ 是周期中逻辑高电平所占的比例。当 $D=0.30$ 时，每个周期的高电平持续时间 $t_{\\text{high}}$ 为\n$$\nt_{\\text{high}}=D\\,T=0.30 \\cdot \\frac{1}{40 \\times 10^{6}} \\text{ s}.\n$$\n计算该因子：\n$$\n\\frac{0.30}{40}=0.0075=7.5 \\times 10^{-3},\n$$\n因此\n$$\nt_{\\text{high}}=7.5 \\times 10^{-3} \\times 10^{-6} \\text{ s}=7.5 \\times 10^{-9} \\text{ s}.\n$$\n使用 $1 \\text{ ns}=10^{-9} \\text{ s}$ 将秒转换为纳秒：\n$$\nt_{\\text{high}}=7.5 \\text{ ns}.\n$$\n四舍五入到两位有效数字，结果仍为 $7.5$ 纳秒。", "answer": "$$\\boxed{7.5}$$", "id": "1920932"}, {"introduction": "在理想化的数字世界中，数据可以随时变化。然而在现实中，触发器为了可靠地工作，要求数据在有效时钟边沿前后保持稳定。这项练习介绍了两个至关重要的时序规则——建立时间 ($t_{su}$) 和保持时间 ($t_h$)。您将面临的挑战是，在一个给定的时序场景中，精确地找出一个违反时序约束的数据转换，这是数字电路设计与调试中的一项核心任务。[@problem_id:1920888]", "problem": "一个数字系统使用一个上升沿触发的D触发器来采样数据信号D。为了让该触发器能正确捕获数据，数据输入必须在时钟上升沿之前（建立时间, $t_{su}$）和之后（保持时间, $t_h$）的最小持续时间内保持稳定。\n\n电路中使用的特定D触发器具有以下时序参数：\n- 建立时间, $t_{su} = 2.0$ ns\n- 保持时间, $t_h = 1.0$ ns\n\n时钟信号CLK是一个周期性方波。其上升沿精确地出现在时间 $t = 10 \\text{ ns}, 20 \\text{ ns}, 30 \\text{ ns}, 40 \\text{ ns}, \\dots$。\n\n数据信号D初始处于逻辑低(0)电平状态。它经历了一系列瞬时跳变，如下所列：\n- 信号在 $t = 7.5$ ns 时从低电平跳变到高电平。\n- 信号在 $t = 20.6$ ns 时从高电平跳变到低电平。\n- 信号在 $t = 27.5$ ns 时从低电平跳变到高电平。\n- 信号在 $t = 32.5$ ns 时从高电平跳变到低电平。\n\n如果数据信号的变化时间不满足相对于某个时钟上升沿的建立时间或保持时间要求，就会发生时序违规。以下哪个数据跳变导致了时序违规？\n\nA. 在 $t = 7.5$ ns 时的跳变\n\nB. 在 $t = 20.6$ ns 时的跳变\n\nC. 在 $t = 27.5$ ns 时的跳变\n\nD. 在 $t = 32.5$ ns 时的跳变\n\nE. 没有发生时序违规。", "solution": "对于一个建立时间为 $t_{su}$、保持时间为 $t_{h}$ 的上升沿触发D触发器，若数据在时间 $t$ 发生跳变，而时钟上升沿在时间 $T$ 到来，如果 $0  T - t  t_{su}$，则会发生建立时间违规；如果 $0  t - T  t_{h}$，则会发生保持时间违规。等效地，定义建立窗口为 $W^{su}(T) = (T - t_{su}, T)$，保持窗口为 $W^{h}(T) = (T, T + t_{h})$，如果数据跳变时间 $t$ 落在某个时钟上升沿 $T$ 的 $W^{su}(T) \\cup W^{h}(T)$ 区间内，则发生违规。\n\n给定 $t_{su} = 2.0 \\text{ ns}$ 和 $t_{h} = 1.0 \\text{ ns}$，且时钟上升沿出现在 $T_{k} = 10k \\text{ ns}$（其中 $k \\in \\{1,2,3,\\dots\\}$），我们逐一评估每个跳变：\n\nA. $t = 7.5 \\text{ ns}$。相对于 $T_{1} = 10 \\text{ ns}$，建立窗口是 $(10 - 2, 10) = (8, 10) \\text{ ns}$。由于 $7.5 \\text{ ns}  8 \\text{ ns}$，所以 $t \\notin (8,10)$，没有建立时间违规。$10 \\text{ ns}$ 后的保持窗口是 $(10,11) \\text{ ns}$，而 $t  10 \\text{ ns}$，所以没有保持时间违规。因此，没有违规。\n\nB. $t = 20.6 \\text{ ns}$。相对于 $T_{2} = 20 \\text{ ns}$，建立窗口是 $(18,20) \\text{ ns}$，但 $t > 20 \\text{ ns}$，所以没有建立时间违规。保持窗口是 $(20,21) \\text{ ns}$，由于 $20  20.6  21$，所以 $t \\in (20,21)$，导致了保持时间违规。\n\nC. $t = 27.5 \\text{ ns}$。相对于 $T_{3} = 30 \\text{ ns}$，建立窗口是 $(28,30) \\text{ ns}$；由于 $27.5  28$，所以 $t \\notin (28,30)$，没有建立时间违规。相对于 $T_{2} = 20 \\text{ ns}$，保持窗口是 $(20,21) \\text{ ns}$；由于 $27.5 > 21$，所以 $t \\notin (20,21)$，没有保持时间违规。因此，没有违规。\n\nD. $t = 32.5 \\text{ ns}$。相对于 $T_{3} = 30 \\text{ ns}$，保持窗口是 $(30,31) \\text{ ns}$；由于 $32.5 > 31$，所以 $t \\notin (30,31)$，没有保持时间违规。相对于 $T_{4} = 40 \\text{ ns}$，建立窗口是 $(38,40) \\text{ ns}$；由于 $32.5  38$，所以 $t \\notin (38,40)$，没有建立时间违规。因此，没有违规。\n\n只有在 $t = 20.6 \\text{ ns}$ 时的跳变落入了一个保持窗口内，因此导致了时序违规。", "answer": "$$\\boxed{B}$$", "id": "1920888"}, {"introduction": "现在，我们将分析范围从单个触发器扩展到连接两个触发器的真实数据路径。在物理芯片上，由于布线延迟不同，时钟信号并不会同时到达所有单元，这种现象被称为时钟偏斜 ($t_{skew}$)。这项更深入的练习要求您从基本时序参数出发，推导出为保证电路正常工作所允许的最大时钟偏斜。这个过程将理论参数（如时钟到输出延迟 $t_{CQ}$ 和保持时间 $t_h$）与电路布局的物理现实联系起来，是通往高性能电路设计的关键一步。[@problem_id:1920900]", "problem": "在为机器学习加速器设计一款定制专用集成电路（ASIC）时，一个关键的数据流水线由两个串联的、上升沿触发的D型触发器组成，我们称之为 FF_A（源触发器）和 FF_B（目标触发器）。FF_A 的数据输出（Q）通过一个组合逻辑块连接到 FF_B 的数据输入（D）。\n\n这些组件的时序特性由以下符号参数给出：\n- FF_A 的时钟到Q延迟为 $t_{CQ}$。这是指在触发时钟沿之后，D输入端的变化出现在Q输出端所需的时间。\n- FF_B 的保持时间为 $t_{h}$。这是指为了数据被正确锁存，在触发时钟沿*之后*，D输入端的数据必须保持稳定的最短时间。\n- 通过组合逻辑块的最小污染延迟（即，可能的最短传播时间）表示为 $t_{logic,min}$。\n\n时钟信号分布在整个芯片上，并不会同时到达两个触发器。时钟沿在时间 $t_A$ 到达 FF_A 的时钟引脚，在时间 $t_B$ 到达 FF_B 的时钟引脚。时钟偏斜定义为 $t_{skew} = t_B - t_A$。正偏斜意味着时钟信号到达目标触发器 FF_B 的时间晚于到达源触发器 FF_A 的时间。\n\n为确保功能正确运行，防止在 FF_B 处发生保持时间违例，时钟偏斜 $t_{skew}$ 不得超过某个最大值。请推导这个最大允许时钟偏斜 $t_{skew,max}$ 的闭式解析表达式，用给定的参数 $t_{CQ}$、$t_{h}$ 和 $t_{logic,min}$ 表示。", "solution": "我们分析从发送触发器 FF_A 到捕获触发器 FF_B 的路径的保持时间要求，两者都由时钟上升沿触发。\n\n根据定义，由 FF_A 发送的数据能够出现在 FF_B 的 D 输入端的最早可能时间，由从 FF_A 的发送沿开始的路径上的最小延迟之和决定：\n- 发送沿在时间 $t_{A}$ 到达 FF_A。\n- FF_A 的 Q 输出端最早发生变化的时间是在时钟到Q污染延迟（此处记为 $t_{CQ}$）之后。\n- 通过组合逻辑的最早传播是最小污染延迟 $t_{logic,min}$。\n\n因此，新数据到达 FF_B 的 D 输入端的最早时间是\n$$\nt_{\\text{arrive, early}}=t_{A}+t_{CQ}+t_{logic,min}.\n$$\n\n为了无保持时间违例地正确操作，FF_B 的 D 输入必须在捕获时钟沿（在时间 $t_{B}$ 到达 FF_B）之后，至少保持稳定其保持时间 $t_{h}$。因此，FF_B 的 D 输入端可以安全发生变化的最早时间是\n$$\nt_{\\text{safe}}=t_{B}+t_{h}.\n$$\n\n为了避免保持时间违例，我们需要满足\n$$\nt_{A}+t_{CQ}+t_{logic,min}\\geq t_{B}+t_{h}.\n$$\n使用时钟偏斜的定义 $t_{skew}=t_{B}-t_{A}$，将 $t_{B}$ 改写为 $t_{B}=t_{A}+t_{skew}$ 并代入：\n$$\nt_{A}+t_{CQ}+t_{logic,min}\\geq t_{A}+t_{skew}+t_{h}.\n$$\n从两边消去 $t_{A}$ 得到\n$$\nt_{CQ}+t_{logic,min}\\geq t_{skew}+t_{h}.\n$$\n求解最大允许偏斜可得\n$$\nt_{skew,max}=t_{CQ}+t_{logic,min}-t_{h}.\n$$\n\n该表达式表明，正偏斜不得超过到达目标的最小延迟之和减去保持时间。", "answer": "$$\\boxed{t_{CQ}+t_{logic,min}-t_{h}}$$", "id": "1920900"}]}