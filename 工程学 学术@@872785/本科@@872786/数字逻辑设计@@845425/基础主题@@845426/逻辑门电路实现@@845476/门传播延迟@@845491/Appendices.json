{"hands_on_practices": [{"introduction": "计算信号路径的传播延迟是数字设计中的一项基本技能。本练习 [@problem_id:1939407] 提供了一个直接的场景，用于练习追踪信号在组合逻辑电路中的路径，并累加各个门延迟以得出从输入变化到最终输出的总时间。这是理解和分析电路时序性能的第一步。", "problem": "在一个专用高速数据通路仲裁器的设计中，一个关键控制信号 $F$ 由四个输入 $A$、$B$、$C$ 和 $D$ 生成。其逻辑关系由布尔表达式 $F = (A+B) \\cdot (C+D)$ 定义。该电路由一个标准双输入逻辑门网络实现。根据所使用的工艺库，任何双输入或门的传播延迟为 $t_{p,\\text{OR}} = 1.35$ 纳秒 (ns)，任何双输入与门的传播延迟为 $t_{p,\\text{AND}} = 0.95$ ns。\n\n为了进行正确的时序分析，必须确定输入的变化影响到最终输出所需的时间。计算从输入信号 $B$ 状态改变的时刻到输出 $F$ 保证稳定并反映此变化的总传播延迟，单位为纳秒 (ns)。", "solution": "给定的布尔函数为 $F=(A+B)\\cdot(C+D)$，该函数由双输入门实现。设中间节点定义为 $X=A+B$ (双输入或门) 和 $Y=C+D$ (双输入或门)，最终输出为 $F=X\\cdot Y$ (双输入与门)。\n\n从输入到输出的传播延迟是该输入到输出的敏化路径上所有门延迟的总和。要使输入 $B$ 的变化影响到 $F$，其路径为\n$$B \\rightarrow X=A+B \\rightarrow F=X\\cdot Y.$$\n该路径经过一个或门，然后经过一个与门。\n\n为了使 $B$ 的变化能在 $F$ 上反映出来，与门的另一个输入必须处于非控制值。由于与门的控制值为 $0$，我们需要 $Y=C+D=1$ 在转换期间保持稳定；这会敏化路径，从而使 $X$ 的变化能够传播到 $F$。\n\n因此，从 $B$ 到 $F$ 的总传播延迟是产生 $X$ 的或门和产生 $F$ 的与门的传播延迟之和：\n$$t_{B\\to F}=t_{p,\\text{OR}}+t_{p,\\text{AND}}.$$\n代入给定值，\n$$t_{B\\to F}=1.35+0.95=2.30.$$\n要求的单位是纳秒，因此数值为 $2.30$。", "answer": "$$\\boxed{2.30}$$", "id": "1939407"}, {"introduction": "传播延迟不仅影响电路的速度，还可能通过产生时序冒险来影响其正确性。本练习 [@problem_id:1939414] 探究了一个常见场景，其中来自单个输入的不同路径延迟会导致暂时的错误输出，即“毛刺”，并要求您计算其持续时间。理解这种现象对于设计可靠的数字系统至关重要。", "problem": "一个数字逻辑电路被设计用于实现布尔函数 $F(A, B, C) = AB + \\bar{A}C$。该电路使用标准的两级“积之和”架构构建：补码 $\\bar{A}$ 由输入 $A$ 馈入一个非门生成。两个独立的双输入与门的输出计算乘积项（$AB$ 和 $\\bar{A}C$），然后它们的输出被馈入一个双输入或门以产生最终输出 $F$。\n\n门的传播延迟如下：\n- 非门：$t_{p,\\text{NOT}} = 2.1 \\text{ ns}$\n- 双输入与门：$t_{p,\\text{AND}} = 3.5 \\text{ ns}$\n- 双输入或门：$t_{p,\\text{OR}} = 4.2 \\text{ ns}$\n\n考虑一种情况，其中输入 $B$ 和 $C$ 稳定保持在逻辑“1”。在时间 $t=0$ 时，输入 $A$ 从逻辑“1”转换到逻辑“0”。由于信号路径上的传播延迟不同，一个暂时的、不希望出现的脉冲，称为静态冒险或毛刺，会出现在输出 $F$ 上。\n\n计算这个毛刺的持续时间。用纳秒 (ns) 表示你的最终答案，并四舍五入到两位有效数字。", "solution": "我们分析在 $B=1$ 和 $C=1$ 保持不变的情况下，从输入 $A$ 到或门的两条信号路径。设门的传播延迟用符号 $t_{\\text{NOT}}$、$t_{\\text{AND}}$ 和 $t_{\\text{OR}}$ 表示。\n\n在 $t=0$ 之前，$A=1$，所以 $AB=1$ 且 $\\bar{A}C=0$，因此 $F=1$。在 $t=0$ 时，$A$ 从 $1 \\to 0$ 转换。\n\n路径1（项 $AB$）：输入 $A$ 直接驱动一个与 $B=1$ 相连的双输入与门。在与门延迟之后，乘积 $AB$ 在或门的输入端从 $1 \\to 0$ 转换。\n$$\nt_{AB,\\text{OR-in}}=t_{\\text{AND}}.\n$$\n包括或门在内，输出 $F$ 处相应的下降沿将发生在\n$$\nt_{\\text{fall at }F}=t_{\\text{AND}}+t_{\\text{OR}}.\n$$\n\n路径2（项 $\\bar{A}C$）：输入 $A$ 首先通过非门，所以在 $t_{\\text{NOT}}$ 之后 $\\bar{A}$ 变为 1，然后与 $C=1$ 相连的双输入与门产生 $\\bar{A}C$，在或门的输入端经过额外的 $t_{\\text{AND}}$ 之后从 $0 \\to 1$ 转换：\n$$\nt_{\\bar{A}C,\\text{OR-in}}=t_{\\text{NOT}}+t_{\\text{AND}}.\n$$\n包括或门在内，输出 $F$ 处相应的上升沿将发生在\n$$\nt_{\\text{rise at }F}=t_{\\text{NOT}}+t_{\\text{AND}}+t_{\\text{OR}}.\n$$\n\n在 $t_{\\text{AND}}$ 和 $t_{\\text{NOT}}+t_{\\text{AND}}$ 这段时间之间，或门输入的两个乘积项均为 0，因此其输入端的逻辑或值在此区间内为 0\n$$\n\\Delta t_{\\text{OR-in}}=\\left(t_{\\text{NOT}}+t_{\\text{AND}}\\right)-t_{\\text{AND}}=t_{\\text{NOT}}.\n$$\n或门对下降沿和上升沿都增加了相同的延迟 $t_{\\text{OR}}$，这会在时间上移动毛刺，但不会改变其持续时间。因此，输出 $F$ 处的毛刺宽度为\n$$\n\\Delta t=t_{\\text{NOT}}.\n$$\n\n代入给定的数值 $t_{\\text{NOT}}=2.1\\ \\text{ns}$ 并四舍五入到两位有效数字，得到\n$$\n\\Delta t=2.1\\ \\text{ns}.\n$$", "answer": "$$\\boxed{2.1}$$", "id": "1939414"}, {"introduction": "除了分析现有延迟，工程师的一项关键任务是优化电路以实现最小延迟。这个高级练习 [@problem_id:1939378] 介绍了强大的逻辑努力法，这是一种系统地确定门尺寸以实现最高性能的方法。您需要应用该方法，在一个复杂的分支逻辑路径中权衡利弊，以达到最优设计。", "problem": "一位工程师的任务是优化高性能微处理器中的一个关键逻辑路径。该路径始于一个三输入与非门的输入端，该门的输入电容为 $C_{in} = 9 C_{inv}$，其中 $C_{inv}$ 是一个最小尺寸参考反相器的输入电容。这个与非门（G1）的输出驱动两个独立的逻辑分支 A 和 B。\n\n- 分支 A 由一个二输入或非门（G2）后接一个标准反相器（G3）组成。G3 的输出驱动一个电容为 $C_{L,A} = 50 C_{inv}$ 的负载。\n- 分支 B 由一个二输入与非门（G4）后接一个标准反相器（G5）组成。G5 的输出驱动一个电容为 $C_{L,B} = 150 C_{inv}$ 的负载。\n\n目标是通过调整门（G1, G2, G3, G4, G5）的尺寸，来最小化从 G1 输入到最终负载的整个网络的总传播延迟。网络的延迟由其最慢的路径决定。\n\n为了使用逻辑努力法执行此优化，您需要使用以下参数：\n- 每种门类型的逻辑努力 $g$ 如下：\n  - 反相器：$g_{inv} = 1$\n  - 二输入与非门：$g_{NAND2} = 4/3$\n  - 三输入与非门：$g_{NAND3} = 5/3$\n  - 二输入或非门：$g_{NOR2} = 5/3$\n- 任何门（反相器、与非门或或非门）的寄生延迟 $p$ 均假定与参考反相器的寄生延迟相等，因此 $p_{gate} = p_{inv} = 1.0$。\n\n计算该网络的最小可能延迟。将您的答案表示为一个无量纲的总延迟因子，并四舍五入到三位有效数字。", "solution": "使用带分支的逻辑努力法。设路径起点的输入电容为 $C_{0}=9C_{inv}$。设 $x=C_{in,2}$ 和 $y=C_{in,4}$ 分别表示 G2 和 G4 的输入电容（以 $C_{inv}$ 为单位）。第一级 G1（一个三输入与非门）看到总负载 $x+y$；它在任一路径上的延迟为\n$$\nd_{1} \\;=\\; g_{1}\\,\\frac{x+y}{C_{0}} \\;+\\; p_{1},\n$$\n其中 $g_{1}=g_{NAND3}=\\frac{5}{3}$ 且 $p_{1}=1$。\n\n分支后的每个分支都是一个两级路径。对于分支 A（通过 G2 然后 G3），逻辑努力的乘积是 $G_{23,A}=g_{NOR2}\\cdot g_{inv}=\\frac{5}{3}\\cdot 1=\\frac{5}{3}$，寄生延迟之和是 $P_{23,A}=1+1=2$，子路径的电气努力是 $H_{A,\\text{sub}}=C_{L,A}/x$。具有相等级努力的两级路径的最小延迟是\n$$\nA(x) \\;=\\; 2\\sqrt{G_{23,A}\\,H_{A,\\text{sub}}} \\;+\\; P_{23,A}\n\\;=\\; 2\\sqrt{\\frac{5}{3}\\,\\frac{C_{L,A}}{x}} \\;+\\; 2.\n$$\n类似地，对于分支 B（通过 G4 然后 G5），其中 $G_{23,B}=g_{NAND2}\\cdot g_{inv}=\\frac{4}{3}\\cdot 1=\\frac{4}{3}$ 且 $P_{23,B}=2$，最小的两级延迟是\n$$\nB(y) \\;=\\; 2\\sqrt{G_{23,B}\\,H_{B,\\text{sub}}} \\;+\\; P_{23,B}\n\\;=\\; 2\\sqrt{\\frac{4}{3}\\,\\frac{C_{L,B}}{y}} \\;+\\; 2.\n$$\n\n两条路径的总延迟为\n$$ D_{A}(x,y) \\;=\\; g_{1}\\frac{x+y}{C_{0}} + p_{1} + A(x), \\qquad D_{B}(x,y) \\;=\\; g_{1}\\frac{x+y}{C_{0}} + p_{1} + B(y) $$\n我们必须最小化 $\\max\\{D_{A},D_{B}\\}$。由于共享项 $g_{1}(x+y)/C_{0}+p_{1}$ 是公共的，最优解出现在 $A(x)=B(y)=T$ 时，然后我们最小化\n$$\nD \\;=\\; p_{1} \\;+\\; \\frac{g_{1}}{C_{0}}\\bigl(x+y\\bigr) \\;+\\; T\n$$\n在约束条件 $A(x)=T$ 和 $B(y)=T$ 下。定义\n$$\na_{A} \\;=\\; 2\\sqrt{G_{23,A}\\,C_{L,A}}, \\qquad\na_{B} \\;=\\; 2\\sqrt{G_{23,B}\\,C_{L,B}}.\n$$\n从 $A(x)=T$ 和 $B(y)=T$ 我们可以得到\n$$\nx(T) \\;=\\; \\left(\\frac{a_{A}}{T-2}\\right)^{2}, \n\\qquad\ny(T) \\;=\\; \\left(\\frac{a_{B}}{T-2}\\right)^{2}.\n$$\n因此\n$$\nD(T) \\;=\\; p_{1} \\;+\\; \\frac{g_{1}}{C_{0}}\\,\\frac{a_{A}^{2}+a_{B}^{2}}{(T-2)^{2}} \\;+\\; T.\n$$\n通过设置 $\\frac{dD}{dT}=0$ 来对 $T>2$ 进行最小化：\n$$\n\\frac{dD}{dT} \\;=\\; 1 \\;-\\; 2\\,\\frac{g_{1}}{C_{0}}\\,\\frac{a_{A}^{2}+a_{B}^{2}}{(T-2)^{3}} \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\;\n(T-2)^{3} \\;=\\; \\frac{2g_{1}}{C_{0}}\\,(a_{A}^{2}+a_{B}^{2}).\n$$\n设 $S_{0}=T-2$。使用这个关系式，最小化后的延迟简化为\n$$\nD_{\\min} \\;=\\; p_{1} + 2 + \\frac{3}{2}\\,S_{0},\n\\qquad\n\\text{其中}\\;\\;\nS_{0} \\;=\\; \\left(\\frac{2g_{1}}{C_{0}}\\,(a_{A}^{2}+a_{B}^{2})\\right)^{\\frac{1}{3}}.\n$$\n\n代入给定的数值参数（以 $C_{inv}$ 为单位）：$C_{0}=9$, $C_{L,A}=50$, $C_{L,B}=150$, $g_{1}=\\frac{5}{3}$, $G_{23,A}=\\frac{5}{3}$, $G_{23,B}=\\frac{4}{3}$, $p_{1}=1$。计算\n$$\na_{A}^{2} \\;=\\; 4\\,G_{23,A}\\,C_{L,A} \\;=\\; 4\\cdot \\frac{5}{3}\\cdot 50 \\;=\\; \\frac{1000}{3},\n\\qquad\na_{B}^{2} \\;=\\; 4\\,G_{23,B}\\,C_{L,B} \\;=\\; 4\\cdot \\frac{4}{3}\\cdot 150 \\;=\\; 800,\n$$\n所以\n$$\na_{A}^{2}+a_{B}^{2} \\;=\\; \\frac{3400}{3},\n\\qquad\nS_{0} \\;=\\; \\left(\\frac{2\\cdot \\frac{5}{3}}{9}\\cdot \\frac{3400}{3}\\right)^{\\frac{1}{3}} \\;=\\; \\left(\\frac{34000}{81}\\right)^{\\frac{1}{3}} \\approx 7.487.\n$$\n因此，\n$$\nD_{\\min} \\;=\\; 1 + 2 + \\frac{3}{2}\\cdot 7.487 \\;\\approx\\; 14.231,\n$$\n作为一个无量纲的延迟因子，四舍五入到三位有效数字，结果是 $14.2$。", "answer": "$$\\boxed{14.2}$$", "id": "1939378"}]}