{"hands_on_practices": [{"introduction": "在数字电路中，最基本的时序分析始于理解组合逻辑。输出信号并不会随着输入信号的改变而瞬时改变，这种固有的延迟被称为传播延迟。这个练习 [@problem_id:1929912] 提供了一个计算偶校验位的实际场景，让你通过考虑电路的逻辑功能和给定的传播延迟，来精确预测输出波形的变化时刻，从而建立对真实电路中波形延迟的基本认识。", "problem": "一个数字系统包含一个8位并行数据总线，表示为 $D[7:0]$，其中 $D[7]$ 是最高有效位。该总线由一个组合逻辑电路监控，该电路生成一个单比特输出 $P_{\\text{even}}$，表示8位数据的偶校验位。偶校验方案确保在9位字（8个数据位加上1个校验位）中 '1' 的总数始终为偶数。该校验生成电路具有固定的传播延迟 $t_{pd} = 4.5 \\text{ ns}$，这是指从输入数据总线 $D$ 上的任何变化到输出 $P_{\\text{even}}$ 上相应变化所需的时间。\n\n最初，总线上的数据稳定在十六进制值 $0x55$。在时间 $t = 10.0 \\text{ ns}$ 时，总线上的数据值瞬时变为十六进制值 $0xD5$ 并此后保持稳定。\n\n下列哪个陈述准确地描述了输出信号 $P_{\\text{even}}$ 随时间（单位：纳秒 ns）变化的行为？\n\nA. 信号 $P_{\\text{even}}$ 初始为0，在 $t = 14.5 \\text{ ns}$ 时转换为1，并保持为1。\nB. 信号 $P_{\\text{even}}$ 初始为1，在 $t = 14.5 \\text{ ns}$ 时转换为0，并保持为0。\nC. 信号 $P_{\\text{even}}$ 初始为0，在 $t = 10.0 \\text{ ns}$ 时转换为1，并保持为1。\nD. 信号 $P_{\\text{even}}$ 初始为1，在 $t = 10.0 \\text{ ns}$ 时转换为0，并保持为0。\nE. 信号 $P_{\\text{even}}$ 在所有时间内都稳定保持为0。\nF. 信号 $P_{\\text{even}}$ 在所有时间内都稳定保持为1。", "solution": "将8位字 $D[7:0]$ 的偶校验位 $P_{even}$ 定义为使9位字 $(D[7:0], P_{even})$ 中1的总数为偶数的那个比特。等价地，令 $\\oplus$ 表示异或（XOR），偶校验位是所有数据位的异或结果：\n$$\nP_{even}=\\bigoplus_{i=0}^{7} D_{i}.\n$$\n这是因为，当且仅当 $D[7:0]$ 中1的个数为奇数时，$\\bigoplus_{i=0}^{7} D_{i}=1$，此时 $P_{even}=1$ 使总数变为偶数；如果 $\\bigoplus_{i=0}^{7} D_{i}=0$（1的个数为偶数），则 $P_{even}=0$ 保持总数为偶数。\n\n该电路具有固定的传播延迟 $t_{pd}=4.5 \\text{ ns}$，因此作为时间函数的观测输出，是输入在 $t_{pd}$ 时间之前的校验值：\n$$\nP_{even}(t)=\\bigoplus_{i=0}^{7} D_{i}(t-t_{pd}).\n$$\n\n最初，当 $t  10.0 \\text{ ns}$ 时，总线值为 $0x55=0101\\,0101$。$0101\\,0101$ 中1的个数是4，为偶数，因此\n$$\n\\bigoplus_{i=0}^{7} D_{i}=0 \\quad\\Rightarrow\\quad P_{even}=0.\n$$\n\n在 $t=10.0 \\text{ ns}$ 时，总线瞬时变为 $0xD5=1101\\,0101$。$1101\\,0101$ 中1的个数是5，为奇数，因此对于新数据，\n$$\n\\bigoplus_{i=0}^{7} D_{i}=1 \\quad\\Rightarrow\\quad P_{even}=1\n$$\n\n由于传播延迟， $P_{even}$ 的这一变化在输入变化发生 $t_{pd}=4.5 \\text{ ns}$ 后才出现在输出端。因此，$P_{even}$ 上的转换发生在\n$$\nt=10.0 \\text{ ns}+4.5 \\text{ ns}=14.5 \\text{ ns}.\n$$\n因此，$P_{even}$ 初始为 $0$，在 $t=14.5 \\text{ ns}$ 时转换为 $1$，并此后保持为 $1$。这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1929912"}, {"introduction": "当我们从组合逻辑转向带有反馈环路的序贯逻辑时，时序分析变得更加复杂和微妙。锁存器中的亚稳态或“禁用”状态是一个经典例子，理解电路如何从这些状态中退出至关重要。这个练习 [@problem_id:1929927] 深入探讨了一个由NOR门构成的SR锁存器的经典场景，它展示了门之间微小且不对称的传播延迟如何确定性地解决竞争冒险，最终使电路达到一个可预测的稳定状态。", "problem": "考虑一个由两个交叉耦合的双输入或非门构成的基本置位-复位（SR）锁存器。第一个或非门，我们称之为 `G_Q`，其输出为 Q。它的输入是外部信号 S 和另一个门（Q_bar）的输出。第二个或非门，我们称之为 `G_Q_bar`，其输出为 Q_bar。它的输入是外部信号 R 和输出 Q。或非门的逻辑行为由布尔表达式 `OUT = NOT(A OR B)` 定义。\n\n该电路的物理实现不是完全对称的。`G_Q` 门的传播延迟为 $t_{pd,Q} = 2.0 \\text{ ns}$，而 `G_Q_bar` 门的传播延迟为 $t_{pd,Q\\_bar} = 2.2 \\text{ ns}$。\n\n系统初始处于“禁止”输入状态。在所有时间 $t  0$，输入 S 和 R 均保持高电平（逻辑 1）。在 $t = 0$ 的精确时刻，两个输入同时被撤销，从 1 转换到 0。在所有 $t \\ge 0$ 的时间里，输入保持低电平（S=0, R=0）。\n\n在此转换发生很久之后（即 $t > 10 \\text{ ns}$），输出 Q 的最终稳定逻辑状态是什么？\n\nA. Q 将为 0。\nB. Q 将为 1。\nC. Q 将在 0 和 1 之间无限振荡。\nD. Q 的状态在逻辑上是不确定的，无法根据所提供的信息确定。", "solution": "一个双输入或非门实现 $Y=\\overline{A \\lor B}$。在传播延迟为 $t_{pd}$ 的情况下，在时间 $\\tau$ 发生的、会改变逻辑输出值的输入变化，将导致输出在时间 $\\tau + t_{pd}$ 发生变化（惯性延迟模型）。\n\n定义交叉耦合锁存器：\n$$Q=\\overline{S \\lor Q_{\\text{bar}}}, \\qquad Q_{\\text{bar}}=\\overline{R \\lor Q}.$$\n给定 $G_{Q}$ 的传播延迟 $t_{pd,Q}=2.0\\,\\text{ns}$ 和 $G_{Q_{\\text{bar}}}$ 的传播延迟 $t_{pd,Q_{\\text{bar}}}=2.2\\,\\text{ns}$。\n\n对于 $t0$ 的初始条件：$S=1$, $R=1$。那么\n$$Q=\\overline{1 \\lor Q_{\\text{bar}}}=0, \\qquad Q_{\\text{bar}}=\\overline{1 \\lor Q}=0.$$\n\n在 $t=0^{+}$ 时：$S=0$, $R=0$，并且反馈值在输出响应之前仍然是 $Q=0$, $Q_{\\text{bar}}=0$。\n\n在 $t=0$ 之后立即评估每个门的期望输出：\n- 对于 $G_{Q}$：输入为 $(S,Q_{\\text{bar}})=(0,0)$，因此期望的 $Q=\\overline{0 \\lor 0}=1$。由于 $t_{pd,Q}=2.0\\,\\text{ns}$，这会安排 Q 在 $t=2.0\\,\\text{ns}$ 时从 $0 \\to 1$ 转换，前提是没有中间的输入变化使此评估无效。\n- 对于 $G_{Q_{\\text{bar}}}$：输入为 $(R,Q)=(0,0)$，因此期望的 $Q_{\\text{bar}}=\\overline{0 \\lor 0}=1$。由于 $t_{pd,Q_{\\text{bar}}}=2.2\\,\\text{ns}$，这会安排 $Q_{\\text{bar}}$ 在 $t=2.2\\,\\text{ns}$ 时从 $0 \\to 1$ 转换，同样地，如果输入发生变化导致评估结果不同，此安排将被取消。\n\n在 $t=2.0\\,\\text{ns}$ 时，Q 切换到 1。这个输入变化被 $G_{Q_{\\text{bar}}}$ 看到，其输入变为 $(R,Q)=(0,1)$，得出即时的逻辑评估\n$$Q_{\\text{bar}}=\\overline{0 \\lor 1}=0.$$\n由于 $Q_{\\text{bar}}$ 已经是 0，因此没有需要安排的输出变化，并且先前安排的在 $t=2.2\\,\\text{ns}$ 时从 $0 \\to 1$ 的转换，因 $t=2.0\\,\\text{ns}$ 时新的输入条件而失效。\n\n因此，锁存器已达到稳定状态\n$$Q=1, \\qquad Q_{\\text{bar}}=0,$$\n这满足了 $S=R=0$ 时的稳态方程：\n$$Q=\\overline{Q_{\\text{bar}}}=1, \\qquad Q_{\\text{bar}}=\\overline{Q}=0.$$\n没有进一步的转换发生，因此对于 $t>10\\,\\text{ns}$，输出保持 $Q=1$。\n\n因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1929927"}, {"introduction": "现在，让我们将难度提升到系统级时序问题。在同步系统中，关键不仅在于单个延迟的大小，更在于不同信号到达同一逻辑门的相对时间关系，这被称为时序裕量。这个高级练习 [@problem_id:1929964] 挑战你分析一种常见的低功耗设计技术——时钟门控，及其可能产生的毛刺（glitch）风险。你将需要分析时钟信号和使能信号之间的“竞争”，并确定导致危险毛刺产生的时钟偏斜（$t_{skew}$）范围，这是确保现代数字设计信号完整性的关键技能。", "problem": "在一个数字系统中，为了节省功耗，实现了一个时钟门控电路。该电路由一个简单的双输入与门组成，其输出 `CLK_gated` 用于为下游的寄存器组提供时钟。与门的一个输入是系统的主时钟 `CLK`。另一个输入是门控使能信号 `EN`。\n\n主时钟 `CLK` 是一个占空比为50%的周期信号。使能信号 `EN` 由一个上升沿触发的D型触发器（DFF）的Q输出生成。该DFF本身也由主时钟 `CLK` 驱动。此DFF的时钟到Q的传播延迟规定为 $t_{cq} = 1.3 \\text{ ns}$。\n\n存在一个显著的布线延迟 $t_{route} = 1.1 \\text{ ns}$，这是 `EN` 信号从DFF的输出传播到与门输入所需的时间。此外，在时钟分配网络中存在时钟偏斜 $t_{skew}$。该偏斜导致 `CLK` 的上升沿到达与门输入的时间比同一边沿到达DFF时钟引脚的时间晚 $t_{skew}$。可以通过调整时钟路径中的延迟元件来调节 $t_{skew}$ 的值。\n\n当系统决定关闭到寄存器组的时钟时，`EN` 信号由 `CLK` 的一个上升沿触发，从高电平转换到低电平。此操作可能会在 `CLK_gated` 线上无意中产生一个短暂的、不期望的脉冲，称为毛刺。在该系统中，如果毛刺的持续时间严格大于 $W_{min} = 0.5 \\text{ ns}$，则认为该毛刺是危险的。\n\n如果时钟偏斜 $t_{skew}$ 落在特定范围内，就会发生危险毛刺。以下关于 $t_{skew}$（单位：纳秒）的哪个条件正确定义了在关闭时钟时，会导致 `CLK_gated` 上出现危险毛刺的范围？\n\nA. $t_{skew}  1.9$\nB. $t_{skew} > 1.9$\nC. $t_{skew}  2.4$\nD. $t_{skew} > 2.4$\nE. $t_{skew}  0.2$\nF. $t_{skew} > 0.2$", "solution": "设在DFF时钟引脚处触发关断操作的 `CLK` 上升沿时刻为 $t=0$。\n\n1.  **`EN` 信号的延迟**：`EN` 信号在DFF的Q输出端从高电平变为低电平的时刻为 $t=t_{cq}=1.3 \\text{ ns}$。此信号经过布线延迟 $t_{route}$ 后到达与门输入端，因此在与门处 `EN` 变为低电平的时刻是：\n    $$t_{\\text{EN,fall}} = t_{cq} + t_{route} = 1.3 \\text{ ns} + 1.1 \\text{ ns} = 2.4 \\text{ ns}$$\n\n2.  **`CLK` 信号的延迟**：触发 `EN` 变化的同一个 `CLK` 上升沿，由于时钟偏斜 $t_{skew}$，到达与门输入端的时刻为 $t = t_{skew}$。\n\n3.  **毛刺产生条件**：`CLK_gated` 是 `CLK` 和 `EN` 的与运算结果。当 `EN` 信号旨在关闭时钟时，如果 `CLK` 在与门输入端变为高电平的时刻早于 `EN` 变为低电平的时刻，就会产生一个不期望的高电平脉冲（毛刺）。产生毛刺的条件是 $t_{skew}  t_{\\text{EN,fall}}$，即 $t_{skew}  2.4 \\text{ ns}$。\n\n4.  **毛刺宽度计算**：如果毛刺发生，其宽度 $W$ 等于 `EN` 信号变低与 `CLK` 信号变高之间的时间差：\n    $$W = t_{\\text{EN,fall}} - t_{skew} = 2.4 \\text{ ns} - t_{skew}$$\n\n5.  **危险毛刺条件**：一个毛刺被认为是危险的，如果其宽度 $W$ 严格大于 $W_{min} = 0.5 \\text{ ns}$。\n    $$W > 0.5 \\text{ ns}$$\n    $$2.4 \\text{ ns} - t_{skew} > 0.5 \\text{ ns}$$\n    $$1.9 \\text{ ns} > t_{skew}$$\n\n因此，导致危险毛刺的条件是 $t_{skew}  1.9 \\text{ ns}$。", "answer": "$$\\boxed{A}$$", "id": "1929964"}]}