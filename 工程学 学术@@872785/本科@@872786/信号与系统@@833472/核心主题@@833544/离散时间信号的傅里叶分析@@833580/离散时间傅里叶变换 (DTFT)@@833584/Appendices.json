{"hands_on_practices": [{"introduction": "离散时间傅里叶变换（DTFT）使我们能够将信号看作是其频率分量的总和。这个练习将带你进行逆向操作：从给定的频率分量（以余弦函数的形式给出）出发，重建原始的时间序列信号。这是建立时域和频域关系直觉的绝佳第一步，它直观地展示了如何通过检查频域的表达式来识别时域信号中的关键脉冲。[@problem_id:1760111]", "problem": "一个离散时间信号 $x[n]$ 具有离散时间傅里叶变换 (DTFT)，记为 $X(e^{j\\omega})$，其表达式为：\n$$X(e^{j\\omega}) = 1 + 2\\cos(\\omega) + 2\\cos(2\\omega)$$\n原始信号 $x[n]$ 可以通过其 DTFT 使用 DTFT 逆变换合成方程恢复：\n$$x[n] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} X(e^{j\\omega}) e^{j\\omega n} d\\omega$$\n其中 $n$ 代表整数时间索引。\n求离散时间信号 $x[n]$ 对所有整数值 $n$ 的表达式。", "solution": "我们从给定的 DTFT 开始：\n$$\nX(e^{j\\omega}) = 1 + 2\\cos(\\omega) + 2\\cos(2\\omega)\n$$\n使用恒等式 $2\\cos(\\alpha) = e^{j\\alpha} + e^{-j\\alpha}$，我们将 $X(e^{j\\omega})$ 重写为复指数之和：\n$$\nX(e^{j\\omega}) = 1 + (e^{j\\omega} + e^{-j\\omega}) + (e^{j2\\omega} + e^{-j2\\omega}) = \\sum_{k \\in \\{-2,-1,0,1,2\\}} e^{j\\omega k}\n$$\nDTFT逆变换为\n$$\nx[n] = \\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} X(e^{j\\omega}) e^{j\\omega n} d\\omega\n$$\n代入 $X$ 的展开式得到\n$$\nx[n] = \\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} \\left(\\sum_{k \\in \\{-2,-1,0,1,2\\}} e^{j\\omega k}\\right) e^{j\\omega n} d\\omega = \\frac{1}{2\\pi}\\sum_{k \\in \\{-2,-1,0,1,2\\}} \\int_{-\\pi}^{\\pi} e^{j\\omega(n+k)} d\\omega\n$$\n使用标准正交性积分\n$$\n\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} e^{j\\omega m} d\\omega = \\begin{cases}\n1,  m=0, \\\\\n0,  m\\neq 0,\n\\end{cases}\n$$\n当且仅当 $n+k=0$（即 $n=-k$）时，每一项的值为 $1$，否则为 $0$。因此，对于 $k \\in \\{-2, -1, 0, 1, 2\\}$ 中的每一个值，我们都会在 $n=-k$ 处得到一个冲激。将这些冲激相加，得到：\n$$\nx[n] = \\delta[n-2] + \\delta[n-1] + \\delta[n] + \\delta[n+1] + \\delta[n+2]\n$$\n其中 $\\delta[\\cdot]$ 是克罗内克δ函数。该表达式对所有整数 $n$ 成立。", "answer": "$$\\boxed{\\delta[n-2]+\\delta[n-1]+\\delta[n]+\\delta[n+1]+\\delta[n+2]}$$", "id": "1760111"}, {"introduction": "在我们练习了如何从频域返回时域之后，现在让我们来解决一个基本的正向变换问题。指数序列 $x[n]=a^n u[n]$ 是信号与系统分析中的一个核心构建模块，代表了许多一阶系统的基本响应。通过从第一性原理推导其DTFT，你将加深对变换定义的理解，并掌握等比级数这一在信号处理中至关重要的数学工具。[@problem_id:2912118]", "problem": "考虑由 $x[n]=a^{n} u[n]$ 定义的右边指数序列，其中 $u[n]$ 是单位阶跃序列，且 $a \\in \\mathbb{R}$ 满足 $|a|1$。角频率的单位是弧度/样本。仅从离散时间傅里叶变换（DTFT）的定义\n$$\nX(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} x[n] e^{-j\\omega n},\n$$\n和无穷级数的标准收敛性质出发，完成以下任务：\n\n1) 推导DTFT $X(e^{j\\omega})$ 的闭式表达式，并证明在给定的 $a$ 的条件下，对于所有实数 $\\omega$，该变换都收敛。\n\n2) 将幅值 $|X(e^{j\\omega})|$ 和展开相位 $\\arg\\{X(e^{j\\omega})\\}$ 明确地写成关于 $\\omega$ 和 $a$ 的函数。仔细辨别幅值和相位的定性行为如何依赖于 $a$ 的符号和大小。\n\n3) 确定使幅值最大化的 $\\omega \\in [-\\pi,\\pi)$ 的值（作为 $a$ 的符号的函数），并以闭式形式计算该最大幅值。\n\n为每个步骤提供简要的推理，将结果与初始定义和已知的级数性质联系起来。作为最终答案，仅报告最大幅值 $\\,\\max_{\\omega \\in \\mathbb{R}} |X(e^{j\\omega})|\\,$ 作为 $a$ 的函数的精确闭式表达式（可以使用绝对值运算符）。不要近似或四舍五入；给出精确表达式（最终答案无需单位）。", "solution": "问题要求分析右边指数序列 $x[n]=a^{n} u[n]$ 的离散时间傅里叶变换（DTFT），其中 $a \\in \\mathbb{R}$ 且 $|a|1$。单位阶跃序列 $u[n]$ 定义为：当 $n \\ge 0$ 时 $u[n]=1$，当 $n  0$ 时 $u[n]=0$。DTFT 定义为\n$$\nX(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} x[n] e^{-j\\omega n}\n$$\n\n1) 推导 $X(e^{j\\omega})$ 的闭式表达式。\n我们首先将 $x[n]$ 的定义代入 DTFT 公式。由于单位阶跃序列 $u[n]$ 的存在，求和仅限于索引 $n$ 的非负值：\n$$\nX(e^{j\\omega}) = \\sum_{n=0}^{\\infty} a^{n} e^{-j\\omega n}\n$$\n我们可以将以 $n$ 为幂的项合并：\n$$\nX(e^{j\\omega}) = \\sum_{n=0}^{\\infty} (a e^{-j\\omega})^{n}\n$$\n这是一个形式为 $\\sum_{n=0}^{\\infty} r^n$ 的几何级数，其公比为 $r = a e^{-j\\omega}$。根据无穷级数理论的一个标准结果，该级数收敛到 $\\frac{1}{1-r}$ 的充分必要条件是公比的模严格小于 1，即 $|r|1$。我们必须验证这个条件。\n公比的模为：\n$$\n|r| = |a e^{-j\\omega}| = |a| |e^{-j\\omega}|\n$$\n对于任意实数频率 $\\omega$，根据欧拉公式， $e^{-j\\omega} = \\cos(-\\omega) + j\\sin(-\\omega) = \\cos(\\omega) - j\\sin(\\omega)$。其模为 $|e^{-j\\omega}| = \\sqrt{\\cos^2(\\omega) + (-\\sin(\\omega))^2} = \\sqrt{\\cos^2(\\omega) + \\sin^2(\\omega)} = 1$。\n因此，收敛条件变为 $|r| = |a| \\cdot 1 = |a|  1$。这个条件在问题陈述中已经给出。因此，该级数对所有实数 $\\omega$ 都收敛，我们可以应用收敛几何级数的求和公式：\n$$\nX(e^{j\\omega}) = \\frac{1}{1 - a e^{-j\\omega}}\n$$\n这就是所求的 DTFT 的闭式表达式。\n\n2) 幅值和相位。\n为了求出幅值和相位，我们首先使用 $e^{-j\\omega} = \\cos(\\omega) - j\\sin(\\omega)$ 将复分母表示为笛卡尔形式：\n$$\nX(e^{j\\omega}) = \\frac{1}{1 - a(\\cos(\\omega) - j\\sin(\\omega))} = \\frac{1}{(1 - a\\cos(\\omega)) + j(a\\sin(\\omega))}\n$$\n复数 $z = z_r + j z_i$ 的模为 $|z| = \\sqrt{z_r^2 + z_i^2}$。$X(e^{j\\omega})$ 的幅值是其分母的模的倒数：\n$$\n|X(e^{j\\omega})| = \\frac{1}{\\sqrt{(1 - a\\cos(\\omega))^2 + (a\\sin(\\omega))^2}}\n$$\n展开平方根内的项得到：\n$$\n(1 - 2a\\cos(\\omega) + a^2\\cos^2(\\omega)) + a^2\\sin^2(\\omega) = 1 - 2a\\cos(\\omega) + a^2(\\cos^2(\\omega) + \\sin^2(\\omega)) = 1 - 2a\\cos(\\omega) + a^2\n$$\n因此，幅值为：\n$$\n|X(e^{j\\omega})| = \\frac{1}{\\sqrt{1 - 2a\\cos(\\omega) + a^2}}\n$$\n复数 $z = z_r + j z_i$ 的相位为 $\\arg\\{z\\} = \\arctan(z_i/z_r)$。$X(e^{j\\omega})$ 的相位是其分母相位的相反数，因为分子是 1（一个相位为 0 的正实数）：\n$$\n\\arg\\{X(e^{j\\omega})\\} = -\\arg\\{(1 - a\\cos(\\omega)) + j(a\\sin(\\omega))\\} = -\\arctan\\left(\\frac{a\\sin(\\omega)}{1-a\\cos(\\omega)}\\right)\n$$\n因为 $|a|1$ 意味着 $|a\\cos(\\omega)| \\le |a|  1$，所以项 $1-a\\cos(\\omega)$ 总是正的。这确保了反正切函数定义良好，对于展开相位没有象限模糊性。\n\n定性行为：\n- 幅值：分母中的项 $-2a\\cos(\\omega)$ 决定了其形状。\n  - 如果 $a > 0$，当 $\\cos(\\omega)=1$ 时，即在 $\\omega=0$ 处，该项最小化（变为最负）。这使得分母最小化，从而使幅值最大化。频谱是低通的，其峰值在 $\\omega=0$ 处。\n  - 如果 $a  0$，令 $a = -|a|$。该项变为 $+2|a|\\cos(\\omega)$。当 $\\cos(\\omega)=-1$ 时，即在 $\\omega=\\pi$ 处，该项最小化。这使得分母最小化，从而使幅值最大化。频谱是高通的，其峰值在 $\\omega=\\pi$ 处。\n- 相位：在 $\\omega \\in (0, \\pi)$ 区间内，分子 $a\\sin(\\omega)$ 中 $a$ 的符号决定了相位的符号。\n  - 如果 $a > 0$，在 $\\omega \\in (0, \\pi)$ 区间内相位为负。\n  - 如果 $a  0$，在 $\\omega \\in (0, \\pi)$ 区间内相位为正。\n\n3) 幅值的最大化。\n为了最大化幅值 $|X(e^{j\\omega})|$，我们必须最小化分母中的正函数 $g(\\omega) = 1 - 2a\\cos(\\omega) + a^2$。我们可以通过分析项 $-2a\\cos(\\omega)$ 的行为来找到最小值，因为其他项相对于 $\\omega$ 是常数。\n\n- 情况1：$a > 0$。因子 $-2a$ 为负。因此，要最小化 $-2a\\cos(\\omega)$，我们必须最大化 $\\cos(\\omega)$。$\\cos(\\omega)$ 的最大值为 1，出现在 $\\omega = 2k\\pi$（其中 k 为整数）处。在区间 $[-\\pi, \\pi)$ 中，这对应于 $\\omega = 0$。\n将 $\\omega=0$ 代入幅值表达式，可得到最大幅值：\n$$\n\\max |X(e^{j\\omega})| = \\frac{1}{\\sqrt{1 - 2a\\cos(0) + a^2}} = \\frac{1}{\\sqrt{1 - 2a + a^2}} = \\frac{1}{\\sqrt{(1-a)^2}} = \\frac{1}{|1-a|}\n$$\n由于 $a > 0$ 且 $|a|1$，我们有 $0  a  1$，这意味着 $1-a > 0$。因此， $|1-a|=1-a$。最大幅值为 $\\frac{1}{1-a}$。\n\n- 情况2：$a  0$。因子 $-2a$ 为正。因此，要最小化 $-2a\\cos(\\omega)$，我们必须最小化 $\\cos(\\omega)$。$\\cos(\\omega)$ 的最小值为 -1，出现在 $\\omega = (2k+1)\\pi$（其中 k 为整数）处。在区间 $[-\\pi, \\pi)$ 中，这对应于 $\\omega = \\pi$ 或 $\\omega = -\\pi$。我们选择 $\\omega = \\pi$。\n将 $\\omega=\\pi$ 代入幅值表达式，可得到最大幅值：\n$$\n\\max |X(e^{j\\omega})| = \\frac{1}{\\sqrt{1 - 2a\\cos(\\pi) + a^2}} = \\frac{1}{\\sqrt{1 - 2a(-1) + a^2}} = \\frac{1}{\\sqrt{1 + 2a + a^2}} = \\frac{1}{\\sqrt{(1+a)^2}} = \\frac{1}{|1+a|}\n$$\n由于 $a  0$ 且 $|a|1$，我们有 $-1  a  0$，这意味着 $1+a > 0$。因此， $|1+a|=1+a$。最大幅值为 $\\frac{1}{1+a}$。\n\n- 情况3：$a = 0$。序列为 $x[n]=\\delta[n]$，即单位冲激。其 DTFT 为 $X(e^{j\\omega}) = 1$（对所有 $\\omega$），所以最大幅值为 1。\n\n我们可以将这些结果合并成一个单一的表达式。对于 $a>0$，最大值为 $\\frac{1}{1-a} = \\frac{1}{1-|a|}$。对于 $a0$，最大值为 $\\frac{1}{1+a} = \\frac{1}{1-(-a)} = \\frac{1}{1-|a|}$。对于 $a=0$，$\\frac{1}{1-|0|} = 1$。\n因此，对于任何满足 $|a|1$ 的 $a$，最大幅值由下式给出：\n$$\n\\max_{\\omega \\in \\mathbb{R}} |X(e^{j\\omega})| = \\frac{1}{1-|a|}\n$$\n这就是所求的最终表达式。", "answer": "$$\n\\boxed{\\frac{1}{1-|a|}}\n$$", "id": "2912118"}, {"introduction": "掌握了分析之后，我们便可以进入设计的领域。这个练习将引导你完成一个典型的工程设计任务：根据频域中的特定要求来构建一个时域信号。通过在特定频率（直流和奈奎斯特频率）上设置“零点”，我们可以精确地塑造信号的频谱特性，这在数字滤波器设计中是一个强大而实用的核心思想，它将抽象的代数概念与实际的信号处理效果直接联系起来。[@problem_id:1760144]", "problem": "一个因果、实值的离散时间信号 $x[n]$ 在满足特定频率响应约束的条件下，被设计为具有最小可能长度。该信号的离散时间傅里叶变换（DTFT），记为 $X(e^{j\\omega})$，要求在直流频率（$\\omega = 0$）处有一个二阶零点，并在奈奎斯特频率（$\\omega = \\pi$）处有一个单零点。假设第一个非零样本为 $x[0]=1$，确定信号 $x[n]$ 在 $n \\ge 0$ 时的值序列。请将您的答案表示为一个行矩阵，其中包含按 $n$ 递增顺序排列的信号样本值。", "solution": "一个实值、因果、有限长度序列 $x[n]$ 的DTFT为\n$$\nX(e^{j\\omega}) = \\sum_{n=0}^{N}x[n]e^{-j\\omega n} = \\sum_{n=0}^{N}x[n]z^{-n}, \\quad z=e^{j\\omega},\n$$\n这是一个关于 $z^{-1}$ 的 $N$ 次多项式。频率 $\\omega=\\omega_{0}$ 处的一个零点对应于 $X(z)$ 在 $z=e^{j\\omega_{0}}$ 处的一个根。因此：\n- 在直流（DC），$\\omega=0$，即 $z=1$ 处的一个二阶零点，需要因子 $(1-z^{-1})^{2}$。\n- 在奈奎斯特频率，$\\omega=\\pi$，即 $z=-1$ 处的一个单零点，需要因子 $(1+z^{-1})$。\n\n为了在最小可能长度下仅实现这些零点，$X(z)$ 必须是恰好具有这些因子的最小阶多项式（相差一个非零标量 $K$）：\n$$\nX(z)=K\\,(1-z^{-1})^{2}(1+z^{-1}).\n$$\n展开得\n$$\n(1-z^{-1})^{2}=1-2z^{-1}+z^{-2},\n$$\n$$\n(1-2z^{-1}+z^{-2})(1+z^{-1})=1 - z^{-1} - z^{-2} + z^{-3}.\n$$\n因此\n$$\nX(z)=K\\left(1 - z^{-1} - z^{-2} + z^{-3}\\right).\n$$\n将系数与 $X(z)=\\sum_{n=0}^{3}x[n]z^{-n}$ 进行匹配，得到\n$$\nx[0]=K,\\quad x[1]=-K,\\quad x[2]=-K,\\quad x[3]=K,\n$$\n并且对于 $n \\ge 4$ 和 $n  0$，$x[n]=0$，这是一个长度为 4 的因果序列。零点重数之和为 $3$，所以最小多项式阶数为 $3$，因此最小序列长度为 $4$，这里已达到。\n\n施加第一个非零样本为 $x[0]=1$ 的归一化条件，可设定 $K=1$。因此，按 $n\\geq 0$ 递增顺序排列的序列是\n$$\n\\begin{pmatrix}\n1  -1  -1  1\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1  -1  -1  1\\end{pmatrix}}$$", "id": "1760144"}]}