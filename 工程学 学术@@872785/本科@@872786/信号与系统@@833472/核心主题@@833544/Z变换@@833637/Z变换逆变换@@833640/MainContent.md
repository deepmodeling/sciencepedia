## 引言
Z变换是分析[离散时间信号](@entry_id:272771)与系统的基石，它将时域中复杂的运算（如卷积）转化为Z域中更简单的代数操作。然而，Z域中的分析本身只是手段，最终目标通常是理解信号或系统在时域中的实际行为。将Z域的分析结果转换回时域的这一关键过程，便是通过**[Z反变换](@entry_id:270064)**（Inverse Z-transform）实现的。它是连接[频域](@entry_id:160070)洞察与时域现实的桥梁，对于工程师和科学家而言是不可或缺的工具。

仅仅知道一个信号的Z变换表达式并不足以完整地描述它；我们必须能够系统且准确地执行逆向操作。本文将全面介绍[Z反变换](@entry_id:270064)的理论与实践。我们将在第一章 **“原理与机制”** 中，建立起[Z反变换](@entry_id:270064)的基础方法，从直接的观察法和长除法，到强大的[部分分式展开](@entry_id:265121)技术，并强调收敛域（ROC）的关键作用。接着，在第二章 **“应用与跨学科联系”** 中，我们将展示这一数学工具如何应用于解决[数字信号处理](@entry_id:263660)、控制理论乃至概率论中的实际问题。最后，第三章 **“动手实践”** 部分将提供精选的练习题，以巩固您的理解并建立实践技能。

通过学习这些章节，您不仅将掌握计算[Z反变换](@entry_id:270064)的“方法”，也将深刻理解其广泛重要性背后的“原因”。现在，让我们深入探讨控制这一基本[变换的核](@entry_id:149509)心原理，开始我们的学习之旅。

## 原理与机制

在上一章中，我们介绍了 Z 变换作为分析[离散时间信号](@entry_id:272771)与系统的有力工具。然而，变换本身只是分析过程的一半。最终目标通常是将在 Z 域中进行的操作和分析得出的结果转换回时域，以理解系统的实际行为或信号的结构。这个过程被称为 **Z 变换求逆**（Inverse Z-transform）。从其 Z 变换 $X(z)$ 中恢复离散时间序列 $x[n]$ 的过程，不仅是简单的代数运算，更深刻地涉及到对收敛域（Region of Convergence, ROC）的理解。本章将系统地阐述 Z 变换求逆的核心原理与关键机制。

### 直接求逆法：观察法与长除法

对于特定形式的 Z 变换，我们可以通过简单直接的方法求得其[逆变](@entry_id:192290)换，而无需复杂的数学工具。这些方法对于建立 Z 变换与其对应时域序列之间的直观联系至关重要。

#### 观察法

观察法的基础是 Z 变换的定义式本身：
$$
X(z) = \sum_{n=-\infty}^{\infty} x[n] z^{-n}
$$
这一定义式表明，$X(z)$ 是一个以 $z^{-1}$ 为变量的幂级数，而序列值 $x[n]$ 正是这个级数中 $z^{-n}$ 项的系数。

对于**有限长序列**，其 Z 变换是一个关于 $z^{-1}$ 的多项式。在这种情况下，我们可以通过直接观察多项式各项的系数来确定序列的非零值。

例如，考虑一个 Z 变换为：
$$
X(z) = 6 + 2z^{-1} - 5z^{-3} + 8z^{-4}
$$
通过将此表达式与 Z 变换的定义式逐项对比，我们可以立即识别出序列 $x[n]$ 的值。$z^0$ 的系数对应 $x[0]$，$z^{-1}$ 的系数对应 $x[1]$，以此类推。因此，我们得到：
-   $x[0] = 6$ (常数项，即 $z^0$ 的系数)
-   $x[1] = 2$
-   $x[2] = 0$ (因为 $z^{-2}$ 项缺失)
-   $x[3] = -5$
-   $x[4] = 8$
对于所有 $n > 4$，$x[n]=0$。[@problem_id:1763256]

这种方法同样适用于由[单位冲激](@entry_id:272155)信号 $\delta[n]$ 及其[移位](@entry_id:145848)版本构成的序列。利用基本变换对 $\mathcal{Z}\{\delta[n-k]\} = z^{-k}$ 和 Z 变换的线性性质，我们可以分解 Z 变换并写出相应的时域序列。假设一个数字滤波器的冲激响应的 Z 变换为：
$$
X(z) = \alpha - \beta z^{-N} + \gamma z^{-2N}
$$
其中 $\alpha, \beta, \gamma$ 是实常数，$N$ 是正整数。我们可以将 $X(z)$ 视为三项之和，每一项都对应一个[移位](@entry_id:145848)的[单位冲激](@entry_id:272155)。通过逆变换，我们得到时域序列：
$$
x[n] = \alpha \delta[n] - \beta \delta[n - N] + \gamma \delta[n - 2N]
$$
该序列仅在 $n=0, N, 2N$ 三个时刻有非零值。[@problem_id:1763237]

#### 长除法

当 Z 变换是 $z^{-1}$ 的[有理函数](@entry_id:154279)时，我们可以通过**长除法**将其展开为 $z^{-1}$ 的幂级数，从而求得序列的初始几项。这种方法对于因果序列尤其有用，因为它能以直接的计算方式揭示序列随时间演变的初始行为。

考虑一个因果序列的 Z 变换：
$$
X(z) = \frac{1}{1 - z^{-1} + 0.75 z^{-2}}
$$
为了求得 $x[n]$ 的值，我们将分子（1）除以分母（$1 - z^{-1} + 0.75 z^{-2}$）。由于我们处理的是因果序列（$x[n]=0$ for $n  0$），我们期望得到一个关于 $z^{-1}$ 的升幂[排列](@entry_id:136432)的级数。

```
        1   +   z⁻¹  +  0.25z⁻² + ...
      _________________________________
1-z⁻¹+0.75z⁻² | 1
        -(1 - z⁻¹ + 0.75z⁻²)
        _________________
              z⁻¹ - 0.75z⁻²
            -(z⁻¹ -   z⁻²  + 0.75z⁻³)
            ___________________
                    0.25z⁻² - 0.75z⁻³
                    ...
```

长除法的结果是：
$$
X(z) = 1 + 1z^{-1} + 0.25z^{-2} + \dots = \sum_{n=0}^{\infty} x[n]z^{-n}
$$
通过系数匹配，我们可以确定序列的初始值：
-   $x[0] = 1$
-   $x[1] = 1$
-   $x[2] = 0.25$

长除法提供了一种不求解[闭式](@entry_id:271343)解而直接计算序列值的方法，这在需要[数值模拟](@entry_id:137087)或验证系统初始响应时非常有用。[@problem_id:1586746]

### [部分分式展开](@entry_id:265121)法

对于更一般的有理 Z 变换，**[部分分式展开](@entry_id:265121)（Partial Fraction Expansion, PFE）** 是最常用且最系统化的求逆方法。其核心思想是将一个复杂的[有理函数](@entry_id:154279)分解为一系列简单分式之和，而这些简单分式的逆变换是已知的。

#### 基本变换对与收敛域（ROC）的核心作用

PFE 方法的基石是一对基本的 Z 变换关系，它们源于几何级数求和公式。对于一个简单的单极点函数 $\frac{1}{1-az^{-1}}$，它可能对应两个截然不同的时域序列，具体是哪一个，完全由**[收敛域](@entry_id:269722)（ROC）**决定。

1.  **[右边序列](@entry_id:261542)（因果）**: 若 ROC 为 $|z| > |a|$，即极点圆的外部，则逆变换为因果的几何序列：
    $$
    a^n u[n] \quad \Leftrightarrow \quad \frac{1}{1-az^{-1}}, \quad \text{ROC: } |z| > |a|
    $$
    这里 $u[n]$ 是单位阶跃序列。

2.  **[左边序列](@entry_id:263980)（反因果）**: 若 ROC 为 $|z|  |a|$，即极点圆的内部，则逆变换为反因果序列：
    $$
    -a^n u[-n-1] \quad \Leftrightarrow \quad \frac{1}{1-az^{-1}}, \quad \text{ROC: } |z|  |a|
    $$

这一对关系揭示了一个深刻的原理：**仅有代数表达式 $X(z)$ 是不足以唯一确定一个序列 $x[n]$ 的；必须同时指定[收敛域](@entry_id:269722) ROC**。同一个[有理函数](@entry_id:154279)，根据 ROC 的不同，可以代表一个因果序列、一个反因果序列，或者一个[双边序列](@entry_id:262580)。[@problem_id:2879337]

#### 基于 ROC 的系统化求逆

让我们通过一个具体的例子来阐明 ROC 如何决定最终的序列。考虑 Z 变换：
$$
X(z) = \frac{1}{(1 - \frac{1}{2}z^{-1})(1 - 2z^{-1})}
$$
该函数在 $z = 1/2$ 和 $z = 2$ 处有两个极点。这两个极点将 Z 平面划分为三个可能的 ROC：$|z|  1/2$，$1/2  |z|  2$，以及 $|z| > 2$。首先，我们将 $X(z)$ 进行[部分分式展开](@entry_id:265121)：
$$
X(z) = \frac{-1/3}{1 - \frac{1}{2}z^{-1}} + \frac{4/3}{1 - 2z^{-1}}
$$
现在，我们根据不同的 ROC 来确定 $x[n]$。

- **情况 1：因果序列 (ROC: $|z| > 2$)**
  此 ROC 是最外层极点之外的区域。要使整个 $X(z)$ 在此区域收敛，其每个部分分式项都必须在此区域收敛。
  - 对于第一项（极点在 $1/2$），$|z| > 2$ 满足 $|z| > 1/2$，因此它对应一个[右边序列](@entry_id:261542)。
  - 对于第二项（极点在 $2$），$|z| > 2$ 也满足 $|z| > 2$，因此它也对应一个[右边序列](@entry_id:261542)。
  应用[右边序列](@entry_id:261542)的变换对，我们得到：
  $$
  x[n] = -\frac{1}{3} \left(\frac{1}{2}\right)^n u[n] + \frac{4}{3} (2)^n u[n]
  $$
  这是一个[右边序列](@entry_id:261542)（[因果系统](@entry_id:264914)），但由于包含 $(2)^n u[n]$ 项，它是不稳定的。[@problem_id:2879337]

- **情况 2：反因果序列 (ROC: $|z|  1/2$)**
  此 ROC 是最内层极点之内的区域。要在此区域收敛，每个部分分式项都必须对应一个[左边序列](@entry_id:263980)。
  - 对于第一项（极点在 $1/2$），$|z|  1/2$ 满足 $|z|  1/2$。
  - 对于第二项（极点在 $2$），$|z|  1/2$ 满足 $|z|  2$。
  应用[左边序列](@entry_id:263980)的变换对，我们得到：
  $$
  x[n] = -\frac{1}{3} \left( - \left(\frac{1}{2}\right)^n u[-n-1] \right) + \frac{4}{3} \left( - (2)^n u[-n-1] \right) = \frac{1}{3} \left(\frac{1}{2}\right)^n u[-n-1] - \frac{4}{3} (2)^n u[-n-1]
  $$
  这是一个纯[左边序列](@entry_id:263980)（[反因果系统](@entry_id:275296)）。[@problem_id:2879337] [@problem_id:1763305]

- **情况 3：[双边序列](@entry_id:262580) (ROC: $1/2  |z|  2$)**
  此 ROC 是一个环带。
  - 对于第一项（极点在 $1/2$），环带 $1/2  |z|  2$ 位于极点 $z=1/2$ 的外部，因此它对应一个[右边序列](@entry_id:261542)。
  - 对于第二项（极点在 $2$），[环带](@entry_id:163678) $1/2  |z|  2$ 位于极点 $z=2$ 的内部，因此它对应一个[左边序列](@entry_id:263980)。
  结合两种变换对，我们得到：
  $$
  x[n] = -\frac{1}{3} \left(\frac{1}{2}\right)^n u[n] + \frac{4}{3} \left( - (2)^n u[-n-1] \right) = -\frac{1}{3} \left(\frac{1}{2}\right)^n u[n] - \frac{4}{3} (2)^n u[-n-1]
  $$
  这是一个[双边序列](@entry_id:262580)，它既有因果部分也有反因果部分。值得注意的是，这个 ROC 包含了单位圆 $|z|=1$，这意味着该序列是绝对可和的，对应的 LTI 系统是**稳定的**。[@problem_id:2879337] [@problem_id:1763298]

#### PFE 技术说明：系数计算

计算[部分分式展开](@entry_id:265121)的系数有多种方法，其中“覆盖法”（Cover-up Method）对于简单实极点尤其高效。通常，对于因果序列，将 $X(z)$ 表示为 $z$ 的函数比 $z^{-1}$ 的函数在求逆时更为方便。一种常见的技巧是先计算 $X(z)/z$ 的[部分分式展开](@entry_id:265121)。

例如，给定一个 Z 变换：
$$
Y(z) = \frac{z(z-3)}{(z-\frac{1}{2})(z-\frac{1}{4})}
$$
我们先对 $Y(z)/z$ 进行展开：
$$
\frac{Y(z)}{z} = \frac{z-3}{(z-\frac{1}{2})(z-\frac{1}{4})} = \frac{A}{z-\frac{1}{2}} + \frac{B}{z-\frac{1}{4}}
$$
要计算与极点 $z=1/2$ 相关的系数 $A$，我们用 $(z-1/2)$ 乘以 $\frac{Y(z)}{z}$，然后令 $z=1/2$：
$$
A = \left. (z-\frac{1}{2}) \frac{Y(z)}{z} \right|_{z=\frac{1}{2}} = \left. \frac{z-3}{z-\frac{1}{4}} \right|_{z=\frac{1}{2}} = \frac{\frac{1}{2}-3}{\frac{1}{2}-\frac{1}{4}} = \frac{-5/2}{1/4} = -10
$$
展开式变为：
$$
Y(z) = \frac{Az}{z-\frac{1}{2}} + \frac{Bz}{z-\frac{1}{4}} = \frac{A}{1-\frac{1}{2}z^{-1}} + \frac{B}{1-\frac{1}{4}z^{-1}}
$$
如果系统是因果的，则 ROC 为 $|z| > 1/2$，对应的时域序列为 $y[n] = A(\frac{1}{2})^n u[n] + B(\frac{1}{4})^n u[n]$。因此，与极点 $z=1/2$ 相关的分量的系数就是我们计算出的 $A=-10$。[@problem_id:1763249] [@problem_id:1763260]

### 应用：利用单边 Z 变换[求解差分方程](@entry_id:194120)

Z 变换的一个关键应用是求解带有初始条件的[线性常系数差分方程](@entry_id:260895)。为此，我们通常使用**单边 Z 变换**（Unilateral Z-transform），其定义为：
$$
\mathcal{Z}^{+}\{x[n]\} = X(z) = \sum_{n=0}^{\infty} x[n]z^{-n}
$$
与双边 Z 变换不同，单边 Z 变换只考虑序列的非负时间部分。其最重要的特性是[时移性质](@entry_id:275667)，该性质能够将[初始条件](@entry_id:152863)引入到变换域的代数方程中。对于一个延迟信号 $x[n-1]$，其单边 Z 变换为：
$$
\mathcal{Z}^{+}\{x[n-1]\} = z^{-1}X(z) + x[-1]
$$
注意，初始条件 $x[-1]$ 作为附加项出现在方程中。

考虑一个由以下差分方程描述的因果 LTI 系统，其在 $n \ge 0$ 时成立：
$$
y[n] - \alpha y[n-1] = x[n]
$$
假设输入为 $x[n] = \beta^n u[n]$，且系统有初始状态 $y[-1]$。我们对整个方程应用单边 Z 变换：
$$
\mathcal{Z}^{+}\{y[n]\} - \alpha \mathcal{Z}^{+}\{y[n-1]\} = \mathcal{Z}^{+}\{x[n]\}
$$
将变换对和[时移性质](@entry_id:275667)代入：
$$
Y(z) - \alpha (z^{-1}Y(z) + y[-1]) = X(z)
$$
这是一个关于 $Y(z)$ 的[代数方程](@entry_id:272665)。整理后可解得：
$$
Y(z) = \frac{X(z) + \alpha y[-1]}{1 - \alpha z^{-1}}
$$
在得到 $Y(z)$ 的表达式后，我们可以使用[部分分式展开](@entry_id:265121)等方法求其逆变换，从而得到系统在 $n \ge 0$ 时的完整输出响应 $y[n]$，该响应同时包含了由输入信号引起的**[零状态响应](@entry_id:273280)**和由初始条件引起的**[零输入响应](@entry_id:274925)**。[@problem_id:1763258]

### 理论基础：反演积分

前面讨论的方法主要适用于有理 Z 变换。然而，Z 变换求逆的普适性理论基础来自于复变分析，它通过一个**围[线积分](@entry_id:141417)**（Contour Integral）来定义。这个公式被称为反演积分（Inversion Integral）：
$$
x[n] = \frac{1}{2\pi j} \oint_{\mathcal{C}} X(z) z^{n-1} dz
$$
这个公式的推导基于 Z 变换的定义本质上是一个[洛朗级数](@entry_id:170999)（Laurent series）。函数 $X(z)$ 在其[收敛域](@entry_id:269722)内是解析的，其[洛朗级数展开](@entry_id:176045)的系数正是序列值 $x[n]$。上述积分正是复变分析中提取洛朗级数系数的[柯西积分公式](@entry_id:169692)的应用。

要使这个公式成立，积分围线 $\mathcal{C}$ 必须满足特定条件：
1.  $\mathcal{C}$ 必须是一条简单的闭合路径（不自交）。
2.  $\mathcal{C}$ 必须完全位于 $X(z)$ 的[收敛域](@entry_id:269722)（ROC）之内。这是因为只有在 ROC 内，$X(z)$ 才解析，积分才有良好定义。
3.  $\mathcal{C}$ 必须以逆时针方向环绕原点。

根据柯西的[积分定理](@entry_id:183680)，只要满足以上条件，积分的值与围线 $\mathcal{C}$ 的具体形状无关。对于[有理函数](@entry_id:154279)，这个积分可以通过[留数定理](@entry_id:164878)（Residue Theorem）来计算，其结果与使用[部分分式展开](@entry_id:265121)法得到的结果是完全一致的。因此，反演积分为 Z 变换求逆提供了坚实的理论基础，并统一了我们之前讨论的各种方法。[@problem_id:2879304]