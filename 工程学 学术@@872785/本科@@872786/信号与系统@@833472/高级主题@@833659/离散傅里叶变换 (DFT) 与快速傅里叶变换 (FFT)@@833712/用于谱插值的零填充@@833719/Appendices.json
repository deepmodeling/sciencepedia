{"hands_on_practices": [{"introduction": "在我们深入探讨如何利用补零来提高频谱分辨率之前，首先需要确保我们理解了它对信号基本特性的影响。本练习探讨了信号能量以及一个常见的计算陷阱。它将通过帕塞瓦尔定理（Parseval's theorem）阐明，虽然补零不改变信号的总能量，但若不正确地调整离散傅里叶变换（DFT）的计算方式，则会导致错误的能量估计。[@problem_id:1774276]", "problem": "考虑一个有限长度的复值离散时间信号 $x[n]$，该信号仅在区间 $0 \\leq n \\leq N-1$ 上非零。该信号的总能量在时域中定义为 $E_x = \\sum_{n=0}^{N-1} |x[n]|^2$。\n\n然后对该信号进行补零，以创建一个长度为 $N'$ 的新长信号 $y[n]$，其中 $N'  N$。新信号定义为：\n$$\ny[n] = \\begin{cases} x[n],  0 \\leq n \\leq N-1 \\\\ 0,  N \\leq n \\leq N'-1 \\end{cases}\n$$\n计算该补零信号的 $N'$ 点离散傅里叶变换 (DFT)，得到频域表示 $Y[k] = \\sum_{n=0}^{N'-1} y[n] \\exp(-j\\frac{2\\pi kn}{N'})$，其中 $k=0, 1, \\dots, N'-1$。\n\n一位工程师试图从这个新的DFT频谱中验证信号能量，计算了一个他们标记为 $E_{calc}$ 的量。然而，他们在计算中错误地使用了原始信号长度 $N$ 作为缩放因子，如下所示：\n$$\nE_{calc} = \\frac{1}{N} \\sum_{k=0}^{N'-1} |Y[k]|^2\n$$\n确定比率 $R = \\frac{E_{calc}}{E_x}$，该比率代表工程师能量计算中的分数误差。信号 $x[n]$ 不是平凡的（即其能量 $E_x$ 非零）。将您的答案表示为关于 $N$ 和 $N'$ 的封闭形式解析表达式。", "solution": "给定一个定义在 $0 \\leq n \\leq N-1$ 上的有限长度信号 $x[n]$，其能量为 $E_{x}=\\sum_{n=0}^{N-1}|x[n]|^{2}$。定义长度为 $N'$ 的补零信号 $y[n]$ 为：当 $0 \\leq n \\leq N-1$ 时 $y[n]=x[n]$，当 $N \\leq n \\leq N'-1$ 时 $y[n]=0$。其 $N'$ 点 DFT 为\n$$\nY[k]=\\sum_{n=0}^{N'-1}y[n]\\exp\\!\\left(-j\\frac{2\\pi kn}{N'}\\right),\\quad k=0,1,\\dots,N'-1.\n$$\n在此 DFT 定义下，$N'$ 点 DFT 的帕塞瓦尔定理 (Parseval's relation) 表述为\n$$\n\\sum_{n=0}^{N'-1}|y[n]|^{2}=\\frac{1}{N'}\\sum_{k=0}^{N'-1}|Y[k]|^{2}.\n$$\n因为当 $0 \\leq n \\leq N-1$ 时 $y[n]=x[n]$，而在其他情况下 $y[n]=0$，所以我们有\n$$\n\\sum_{n=0}^{N'-1}|y[n]|^{2}=\\sum_{n=0}^{N-1}|x[n]|^{2}=E_{x}.\n$$\n代入帕塞瓦尔定理可得\n$$\nE_{x}=\\frac{1}{N'}\\sum_{k=0}^{N'-1}|Y[k]|^{2}\\quad\\Longrightarrow\\quad \\sum_{k=0}^{N'-1}|Y[k]|^{2}=N' E_{x}.\n$$\n工程师计算得到\n$$\nE_{\\text{calc}}=\\frac{1}{N}\\sum_{k=0}^{N'-1}|Y[k]|^{2}=\\frac{1}{N}\\left(N' E_{x}\\right)=\\frac{N'}{N}E_{x}.\n$$\n因此，所求的比率为\n$$\nR=\\frac{E_{\\text{calc}}}{E_{x}}=\\frac{N'}{N}.\n$$\n由于 $N'N$ 且 $E_{x}\\neq 0$，这表明工程师高估了能量，其倍数为 $\\frac{N'}{N}$。", "answer": "$$\\boxed{\\frac{N'}{N}}$$", "id": "1774276"}, {"introduction": "现在，我们来解决一个在信号处理中非常实际的问题，这也是使用补零进行频谱插值的主要动机。当一个强信号的旁瓣可能掩盖或被误认为一个邻近的弱信号时，我们如何可靠地区分它们？本练习将指导您计算所需的最小补零数量，以便在频谱上“放大”感兴趣的区域，从而能够清晰地分辨出两个相近的频率成分，凸显了补零在提高频谱视觉分辨率方面的强大作用。[@problem_id:1774273]", "problem": "一位信号处理工程师正在分析一个离散时间信号 $x[n]$，已知该信号是两个实正弦波之和。该信号通过在 $f_s = 8000$ Hz 的采样频率下采集 $N=1000$ 个样本来捕获，持续时间有限。该信号由下式给出：\n$$x[n] = A_1 \\cos(2\\pi \\frac{f_1}{f_s} n) + A_2 \\cos(2\\pi \\frac{f_2}{f_s} n), \\quad \\text{for } n = 0, 1, \\dots, N-1$$\n主要分量的频率为 $f_1 = 1000$ Hz。该频率被特意选择，以使其与一个 $N$ 点离散傅里叶变换 (DFT) 的频率仓（bin）完全重合。怀疑在频率 $f_2 = 1010$ Hz 处存在一个弱得多的次要分量。\n\n在分析有限长度信号的频谱时（这相当于施加了一个矩形窗），由于频谱泄漏，每个正弦分量都会产生一个主峰和一系列旁瓣。工程师担心，在 $f_2$ 处的弱次要分量可能会被误认为或被来自 $f_1$ 处强主要分量的旁瓣所掩盖。\n\n为了更好地可视化频谱，工程师决定在信号 $x[n]$ 后追加 $N_{zero}$ 个零，创建一个总长度为 $N_{tot} = N + N_{zero}$ 的新信号，然后计算一个 $N_{tot}$ 点 DFT。这个过程被称为零填充（zero-padding），它通过提供更密集的频率样本，有效地对底层的连续频谱进行插值。\n\n对于本问题，假设以下两个事实成立：\n1. 对于一个经过 $N$ 点矩形窗加窗的正弦波，其频谱幅度的第一个主旁瓣出现在距离该正弦波真实频率约 $1.4303 \\times (f_s/N)$ 的频率偏移处。\n2. 为了可靠地区分次要分量的峰值与主要分量附近的旁瓣峰值，工程师要求零填充后 DFT 的频率间隔（我们称之为 $\\Delta f_{zp}$）必须不大于次要分量的真实频率 $f_2$ 与主要分量的第一个主旁瓣频率之间的频率差的一半。\n\n确定为满足工程师的分辨率准则，必须在信号后追加的最小整数零点数 $N_{zero}$。", "solution": "零填充后 DFT 的频率间隔为 $\\Delta f_{zp} = \\frac{f_{s}}{N_{tot}}$，其中 $N_{tot} = N + N_{zero}$。对于长度为 $N$ 的矩形窗，频率为 $f_{1}$ 的正弦波的第一个主旁瓣出现在\n$$\nf_{\\text{sl},1} = f_{1} + 1.4303 \\left(\\frac{f_{s}}{N}\\right).\n$$\n疑似次要分量 $f_{2}$ 与该旁瓣之间的频率差为\n$$\nd \\equiv \\left| f_{2} - f_{\\text{sl},1} \\right| = \\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|.\n$$\n工程师的准则要求\n$$\n\\Delta f_{zp} \\leq \\frac{1}{2} d \\quad \\Longrightarrow \\quad \\frac{f_{s}}{N_{tot}} \\leq \\frac{1}{2} \\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|.\n$$\n解出 $N_{tot}$ 得\n$$\nN_{tot} \\geq \\frac{2 f_{s}}{\\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|}.\n$$\n代入 $f_{s} = 8000$，$N = 1000$，$f_{1} = 1000$ 和 $f_{2} = 1010$：\n$$\n\\frac{f_{s}}{N} = \\frac{8000}{1000} = 8,\\quad 1.4303 \\left(\\frac{f_{s}}{N}\\right) = 1.4303 \\times 8 = 11.4424,\n$$\n$$\nd = \\left| 1010 - 1000 - 11.4424 \\right| = \\left| 10 - 11.4424 \\right| = 1.4424,\n$$\n$$\nN_{tot} \\geq \\frac{2 \\times 8000}{1.4424} = \\frac{16000}{1.4424} \\approx 11092.623\\ldots\n$$\n因此，最小整数 $N_{tot}$ 为 $11093$，所以\n$$\nN_{zero} = N_{tot} - N = 11093 - 1000 = 10093.\n$$", "answer": "$$\\boxed{10093}$$", "id": "1774273"}, {"introduction": "最后一个练习将挑战您逆向思考，从而巩固您对补零的深刻理解。我们已经知道补零可以更清晰地揭示信号的频谱结构；现在，我们将反过来利用一个已经补零并计算好的高密度频谱，来推断原始信号的未知属性。通过分析频谱中的精细波纹，您可以确定原始信号的长度，这有力地证明了频谱的底层形态是由原始信号决定的，而补零只是让我们看得更清楚的工具。[@problem_id:1774257]", "problem": "在一个信号处理应用中，采集到了一个瞬态的实值离散时间信号 $x[n]$。已知该信号的长度 $L$ 是有限但未知的。即，当 $n  0$ 和 $n \\ge L$ 时，$x[n] = 0$。为了以高分辨率分析其频谱内容，该序列被补零至总长度 $N = 4096$。然后对这个补零后的序列计算一个 $N$点离散傅里叶变换 (DFT)，记作 $X[k]$。\n\n在检查幅度谱 $|X[k]|$ 时，观察到该频谱由一个对应于原始信号内容的宽阔、缓变的包络和一个调制其上的精细高频波纹图案组成。对该波纹图案的详细分析表明，局部最小值（零点）在 DFT 索引 $k$ 上的平均间隔为 $\\Delta k = 22.76$ 个采样点。\n\n假设这些波纹是原始信号在长度 $L$ 处被急剧截断所产生的效应，请确定信号 $x[n]$ 的原始长度 $L$。将 $L$ 的答案表示为最接近的整数。", "solution": "观察到的幅度谱中的精细波纹源于将 $x[n]$ 急剧截断至长度 $L$，这等效于将原始信号乘以一个长度为 $L$ 的矩形窗 $w[n]$。矩形窗的离散时间傅里叶变换 (DTFT) 是\n$$\nW\\!\\left(\\exp(j\\omega)\\right)=\\exp\\!\\left(-j\\omega\\frac{L-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{\\omega L}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}.\n$$\n幅度 $|W(\\exp(j\\omega))|$ 在以下位置有零点\n$$\n\\frac{\\omega L}{2}=m\\pi \\quad \\Rightarrow \\quad \\omega=\\frac{2\\pi m}{L}, \\quad m\\in\\mathbb{Z}\\setminus\\{0\\}.\n$$\n因此，频率上连续零点之间的间隔为\n$$\n\\Delta\\omega=\\frac{2\\pi}{L}.\n$$\n$N$点DFT在频率 $\\omega_{k}=\\frac{2\\pi k}{N}$ 处对DTFT进行采样，因此连续零点之间的DFT索引间隔是\n$$\n\\Delta k=\\frac{N\\,\\Delta\\omega}{2\\pi}=\\frac{N}{L}.\n$$\n解出 $L$ 可得\n$$\nL=\\frac{N}{\\Delta k}.\n$$\n根据 $N=4096$ 和观察到的 $\\Delta k=22.76$，我们得到\n$$\nL=\\frac{4096}{22.76}\\approx 180.\n$$\n四舍五入到最接近的整数，得到 $L=180$。", "answer": "$$\\boxed{180}$$", "id": "1774257"}]}