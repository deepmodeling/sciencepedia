{"hands_on_practices": [{"introduction": "在现实世界的信号处理中，我们总是处理有限长度的信号片段。这个看似简单的截断操作，在频域中会产生深远的影响。本练习将通过分析一个被矩形窗截断的纯正弦信号，帮助您从根本上理解频谱泄漏现象是如何产生的，以及为什么一个理想的、无限窄的频谱线会展宽成一个具有主瓣和旁瓣的形状 [@problem_id:1753673]。", "problem": "一名工程师正在分析一个离散时间信号 $x[n]$。已知该信号是一个纯粹的确定性正弦波，其幅度为 $A$，归一化角频率为常数 $\\omega_0$，其中 $0  \\omega_0  \\pi$。该信号由表达式 $x[n] = A \\cos(\\omega_0 n)$ 给出。\n\n为了使用数字计算机进行实际分析，只能处理信号的有限长度片段。这种截断通过将理想信号 $x[n]$ 与一个矩形窗函数 $w_R[n]$ 相乘来建模。该窗的长度为 $M$，定义为当 $0 \\le n \\le M-1$ 时 $w_R[n] = 1$，否则 $w_R[n] = 0$。待分析的最终信号为 $y[n] = x[n] w_R[n]$。\n\n然后，该工程师计算加窗信号的离散时间傅里叶变换 (DTFT)，记为 $Y(e^{j\\omega})$。对于主频率范围 $-\\pi  \\omega  \\pi$，以下哪个选项对幅度谱 $|Y(e^{j\\omega})|$ 提供了最准确的定性描述？\n\nA. 两个无限尖锐的脉冲（狄拉克德尔塔函数），精确定位于频率 $\\omega = \\omega_0$ 和 $\\omega = -\\omega_0$ 处。\n\nB. 一个以 $\\omega = 0$ 为中心的宽阔中心峰（主瓣），伴随着一系列延伸至整个频率范围的、衰减的较小纹波（旁瓣）。\n\nC. 两个显著的峰（主瓣），中心大致位于频率 $\\omega = \\omega_0$ 和 $\\omega = -\\omega_0$ 附近，每个峰都伴随着一系列衰减的较小纹波（旁瓣）。\n\nD. 一个在从 $-\\pi$ 到 $\\pi$ 的整个频率范围内具有恒定非零幅度的谱。\n\nE. 一系列等间距、等高的脉冲，位于频率 $\\frac{2\\pi}{M}$ 的整数倍处。", "solution": "我们从给定的信号和窗函数开始：\n$$x[n]=A\\cos(\\omega_{0} n),\\quad w_{R}[n]=\\begin{cases}1,0\\leq n\\leq M-1\\\\ 0,\\text{otherwise}\\end{cases},\\quad y[n]=x[n]w_{R}[n].$$\n使用欧拉恒等式，将余弦写为\n$$x[n]=\\frac{A}{2}\\left(\\exp(j\\omega_{0} n)+\\exp(-j\\omega_{0} n)\\right),$$\n所以\n$$y[n]=\\frac{A}{2}\\left(w_{R}[n]\\exp(j\\omega_{0} n)+w_{R}[n]\\exp(-j\\omega_{0} n)\\right)。$$\nDTFT 定义为\n$$Y(\\exp(j\\omega))=\\sum_{n=-\\infty}^{\\infty}y[n]\\exp(-j\\omega n)。$$\n根据 DTFT 的线性和调制特性，\n$$\\mathcal{F}\\{w_{R}[n]\\exp(j\\omega_{0} n)\\}=W_{R}(\\exp(j(\\omega-\\omega_{0}))),\\quad \\mathcal{F}\\{w_{R}[n]\\exp(-j\\omega_{0} n)\\}=W_{R}(\\exp(j(\\omega+\\omega_{0}))),$$\n所以\n$$Y(\\exp(j\\omega))=\\frac{A}{2}\\left(W_{R}(\\exp(j(\\omega-\\omega_{0})))+W_{R}(\\exp(j(\\omega+\\omega_{0})))\\right)。$$\n长度为 $M$ 的矩形窗的 DTFT 是狄利克雷核（相差一个线性相位项）：\n$$W_{R}(\\exp(j\\omega))=\\exp\\!\\left(-j\\omega\\frac{M-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{M\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}。$$\n因此，\n$$|W_{R}(\\exp(j\\omega))|=\\left|\\frac{\\sin\\!\\left(\\frac{M\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}\\right|,$$\n其在 $\\omega=0$ 处有一个主瓣和衰减的旁瓣。代入 $Y(\\exp(j\\omega))$ 可得\n$$|Y(\\exp(j\\omega))|=\\frac{A}{2}\\left|W_{R}(\\exp(j(\\omega-\\omega_{0})))+W_{R}(\\exp(j(\\omega+\\omega_{0})))\\right|,$$\n从定性上看，这是两个平移的狄利克雷核幅度谱的叠加，一个以 $\\omega=\\omega_{0}$ 为中心，另一个以 $\\omega=-\\omega_{0}$ 为中心。因为 $0  \\omega_0  \\pi$，两个峰都位于主范围 $-\\pi  \\omega  \\pi$ 内。由于矩形窗的作用，这两个峰各自都表现出一个主瓣和伴随的衰减旁瓣。\n\n因此，正确的定性描述是两个显著的主瓣，中心大致位于 $\\omega=\\pm\\omega_{0}$ 附近，且各自带有旁瓣。\n\n与选项比较：\n- A 是不正确的，因为有限窗的截断会将德尔塔函数展宽为主瓣和旁瓣。\n- B 是窗函数本身的频谱（以 $0$ 为中心），而不是被调制的加窗正弦波的频谱。\n- C 与推导出的结构相符。\n- D 是不正确的；幅度不是平坦的。\n- E 描述的是周期性/离散频率的线谱，而不是有限片段的 DTFT。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1753673"}, {"introduction": "理解了频谱泄漏的成因后，下一个关键问题是如何抑制它。本练习模拟了一个经典的工程挑战：在一个强信号旁边检测一个极弱的信号，这在通信和雷达等领域非常常见。通过对比矩形窗（即不加窗）和汉宁窗的效果，您将定量地看到加窗技术如何通过抑制强信号的旁瓣泄漏，显著提高系统的动态范围和检测能力 [@problem_id:1753664]。", "problem": "一位工程师正在使用离散傅里叶变换 (DFT) 分析来自传感器的信号。信号以 $f_s = 10 \\text{ kHz}$ 的频率进行采样，并收集了 $N=1000$ 个样本的块进行分析。已知该信号包含一个非常强的正弦分量和一个可能非常弱的正弦分量。总信号可以建模为 $x(t) = s_1(t) + s_2(t)$，其中：\n\n1.  强分量为 $s_1(t) = A_1 \\cos(2\\pi f_1 t)$，其振幅为 $A_1 = 1.0$（任意单位），频率为 $f_1 = 1002 \\text{ Hz}$。\n2.  弱分量为 $s_2(t) = A_2 \\cos(2\\pi f_2 t)$，其振幅为 $A_2 = 0.0050$（相同单位），频率为 $f_2 = 1055 \\text{ Hz}$。\n\n工程师想确定弱信号 $s_2(t)$ 是否能在 DFT 频谱中被检测到。一个常见的可检测性准则是，在给定的 DFT 频率仓中，弱信号贡献的幅度必须大于来自强信号在该相同频率仓的频谱泄漏。工程师将其分析集中在频率最接近 $f_2$ 的 DFT 频率仓上。\n\n一个振幅为 $A$、归一化频率为 $k_{sig}$ 的加窗正弦波，在观测整数频率仓 $k_{obs}$ 处对 DFT 幅度的贡献可以近似为 $|X[k_{obs}]| \\approx C \\cdot A \\cdot |G(\\Delta k)|$。这里，$\\Delta k = k_{obs} - k_{sig}$ 是归一化频率差，$G(\\Delta k)$ 是窗函数频谱的归一化幅度响应，$C$ 是一个取决于窗类型和 DFT 长度的比例常数。\n\n下表提供了矩形窗（即无加窗）和汉宁窗的归一化幅度响应 $G(\\Delta k)$ 在与本问题相关的特定 $\\Delta k$ 值下的数值。\n\n| 窗类型    | $G$ 在 $\\Delta k = 0.5$ 时的值 | $G$ 在 $\\Delta k = 4.8$ 时的值 |\n|--------------|-------------------------|-------------------------|\n| 矩形窗      | 0.640                   | 0.0400                  |\n| 汉宁窗       | 0.450                   | 0.000500                |\n\n令 $R_{rect}$ 为使用矩形窗时，在分析频率仓处弱信号的幅度与强信号的泄漏幅度之比。类似地，令 $R_{Hann}$ 为使用汉宁窗时的相同比率。\n\n为了量化在这种特定情况下使用汉宁窗的好处，计算改善因子，定义为比率 $R_{Hann} / R_{rect}$。报告您的最终答案，并四舍五入到三位有效数字。", "solution": "DFT 频率仓的间距为 $\\Delta f = \\frac{f_{s}}{N}$。当 $f_{s}=10 \\times 10^{3}$ Hz 且 $N=1000$ 时，$\\Delta f = 10$ Hz。频率仓的中心位于 $k \\Delta f$ 处，其中 $k$ 为整数。\n\n频率 $f_{2}=1055$ Hz 正好位于频率仓 $k=105$（在 $1050$ Hz）和 $k=106$（在 $1060$ Hz）的正中间。选择较低的频率仓 $k_{obs}=105$，弱分量的归一化频率为 $k_{sig,2} = f_2 / \\Delta f = 105.5$，因此其失谐为 $|\\Delta k|=|k_{obs}-k_{sig,2}|=|105-105.5|=0.5$。而位于 $f_{1}=1002$ Hz 的强分量具有 $k_{sig,1}=\\frac{f_{1}}{\\Delta f}=100.2$，因此其相对于 $k_{obs}=105$ 的失谐为 $|\\Delta k|=|105-100.2|=4.8$。这些恰好是表中提供的 $\\Delta k$ 值。\n\n对于给定的窗函数，一个振幅为 $A$ 的正弦波在 $k_{obs}$ 处的幅度贡献为 $|X[k_{obs}]| \\approx C \\cdot A \\cdot |G(\\Delta k)|$，其中 $C$ 取决于窗函数和 $N$，$G$ 是窗函数的归一化幅度响应。\n\n将 $R$ 定义为在 $k_{obs}$ 处弱分量的幅度与强分量的泄漏幅度之比。对于给定的窗函数，\n$$\nR=\\frac{C \\cdot A_{2} \\cdot |G(0.5)|}{C \\cdot A_{1} \\cdot |G(4.8)|}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{|G(0.5)|}{|G(4.8)|}.\n$$\n因此 $C$ 在每个比率中被消掉了。\n\n对于矩形窗，\n$$\nR_{rect}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.640}{0.0400}.\n$$\n对于汉宁窗，\n$$\nR_{Hann}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.450}{0.000500}.\n$$\n改善因子为\n$$\n\\frac{R_{Hann}}{R_{rect}}=\\frac{\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.450}{0.000500}}{\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.640}{0.0400}}=\\frac{0.450/0.000500}{0.640/0.0400}=\\frac{0.450 \\cdot 0.0400}{0.000500 \\cdot 0.640}.\n$$\n计算分子和分母：\n$$\n0.450 \\cdot 0.0400=0.018, \\quad 0.000500 \\cdot 0.640=0.000320.\n$$\n因此\n$$\n\\frac{R_{Hann}}{R_{rect}}=\\frac{0.018}{0.000320}=56.25.\n$$\n四舍五入到三位有效数字，结果是 $56.3$。", "answer": "$$\\boxed{56.3}$$", "id": "1753664"}, {"introduction": "为了更深入地探索不同窗函数的特性，这个计算实践将引导您亲自编程实现一个仿真实验。您将对比矩形窗、汉宁窗和布莱克曼窗在分辨两个频率非常接近的正弦信号时的表现。通过计算泄漏分数和峰值比率等指标，您将对频率分辨率和旁瓣抑制这对核心权衡关系建立起直观且定量的认识 [@problem_id:2440581]。", "problem": "您需要对离散傅里叶变换上的频谱泄漏效应进行建模，该变换试图分辨两个连续时间正弦分量，而这两个分量的频率间隔严格小于离散傅里叶变换的频率分辨率。考虑一个实值信号，它由两个等幅正弦波组成，并以恒定的采样频率进行均匀采样。设总采样点数为 $N$，采样频率为 $f_{s}$ (单位Hz)，离散傅里叶变换的频率分辨率为 $\\Delta f = \\frac{f_{s}}{N}$ (单位Hz)。信号为：\n$$\nx[n] = \\sin\\!\\left(2\\pi \\frac{f_{1}}{f_{s}} n + \\phi_{1}\\right) + \\sin\\!\\left(2\\pi \\frac{f_{2}}{f_{s}} n + \\phi_{2}\\right), \\quad n = 0,1,2,\\dots,N-1,\n$$\n其中相位 $\\phi_{1}$ 和 $\\phi_{2}$ 的单位为弧度。您必须分析信号 $x[n]$ 在使用以下三种长度为 $N$ 的窗函数 $w[n]$ 后的加窗离散傅里叶变换幅度谱：\n- 矩形窗：对于所有 $n$，有 $w_{\\mathrm{rect}}[n] = 1$。\n- 汉宁窗：$w_{\\mathrm{hann}}[n] = \\tfrac{1}{2}\\left(1 - \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)\\right)$。\n- 布莱克曼窗：$w_{\\mathrm{black}}[n] = 0.42 - 0.5 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\!\\left(\\tfrac{4\\pi n}{N-1}\\right)$。\n\n将加窗信号的离散傅里叶变换定义为：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n]\\,w[n]\\,e^{-j 2\\pi \\frac{k n}{N}}, \\quad k = 0,1,2,\\dots,N-1,\n$$\n并将非负频率幅度谱定义为 $M[k] = |X[k]|$，其中 $k = 0,1,2,\\dots,\\tfrac{N}{2}$。\n\n对于每种窗函数，按如下方式量化频谱泄漏和峰值结构：\n- 设 $p_{1} = \\mathrm{round}\\!\\left(\\frac{f_{1}}{\\Delta f}\\right)$ 和 $p_{2} = \\mathrm{round}\\!\\left(\\frac{f_{2}}{\\Delta f}\\right)$，二者均被裁剪到整数区间 $[0, \\tfrac{N}{2}]$ 内。定义泄漏分数为\n$$\nL = \\frac{\\sum_{k=0,\\,k \\neq p_{1},\\,k \\neq p_{2}}^{N/2} M[k]^{2}}{\\sum_{k=0}^{N/2} M[k]^{2}},\n$$\n这是一个在 $[0,1]$ 区间内的无量纲数。\n- 设 $M_{\\max}$ 为 $M[k]$ 在 $k = 0,1,2,\\dots,\\tfrac{N}{2}$ 上的最大值，设 $M_{\\mathrm{second}}$ 为在同一索引集上的第二大值。定义峰值比为\n$$\nR = \\frac{M_{\\mathrm{second}}}{M_{\\max}},\n$$\n这是一个在 $[0,1]$ 区间内的无量纲数。\n\n所有相位必须以弧度为单位指定。所有频率必须以赫兹(Hz)为单位指定。采样时间为 $t_{n} = \\tfrac{n}{f_{s}}$ (单位s)。所有要求的输出都是无量纲实数。\n\n测试套件。使用以下参数集，其中每种情况都满足 $|f_{1} - f_{2}|  \\Delta f$：\n- 情况1：$f_{s} = 1024$ Hz, $N = 256$, $f_{1} = 100.0$ Hz, $f_{2} = 102.0$ Hz, $\\phi_{1} = 0$ rad, $\\phi_{2} = 0$ rad。\n- 情况2：$f_{s} = 1024$ Hz, $N = 256$, $f_{1} = 99.0$ Hz, $f_{2} = 101.0$ Hz, $\\phi_{1} = 0$ rad, $\\phi_{2} = 0$ rad。\n- 情况3：$f_{s} = 1024$ Hz, $N = 256$, $f_{1} = 100.0$ Hz, $f_{2} = 100.25$ Hz, $\\phi_{1} = 0$ rad, $\\phi_{2} = 0$ rad。\n\n对于每种情况，计算6元组输出：\n$$\n\\left[L_{\\mathrm{rect}},\\,L_{\\mathrm{hann}},\\,L_{\\mathrm{black}},\\,R_{\\mathrm{rect}},\\,R_{\\mathrm{hann}},\\,R_{\\mathrm{black}}\\right],\n$$\n其中每个 $L_{\\cdot}$ 和 $R_{\\cdot}$ 均按上文针对相应窗函数的定义计算。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个含三个元素的列表（每个测试用例一个元素）。每个元素都是一个逗号分隔的列表 $[L_{\\mathrm{rect}},L_{\\mathrm{hann}},L_{\\mathrm{black}},R_{\\mathrm{rect}},R_{\\mathrm{hann}},R_{\\mathrm{black}}]$，所有条目均为十进制浮点数。总体输出必须是这三个列表组成的单个方括号括起来的列表，中间没有空格，例如 \"[[a,b,c,d,e,f],[a,b,c,d,e,f],[a,b,c,d,e,f]]\"。", "solution": "所提出的问题是计算物理和数字信号处理领域一个定义明确的练习。它具有科学依据，内容自成一体，并且可以进行算法形式化。所有参数和函数都有明确定义，测试用例也与前提一致。因此，该问题被视为有效，并将提供完整的解决方案。\n\n基本任务是分析不同窗函数在分辨两个正弦信号方面的性能，这两个信号的频率 $f_{1}$ 和 $f_{2}$ 之间的间隔小于离散傅里叶变换（DFT）的频率分辨率 $\\Delta f = \\frac{f_{s}}{N}$。这种情况在实验数据分析中很常见，其中频谱分量可能间隔很近。\n\n该分析背后的核心原理是对DFT和频谱泄漏现象的理解。DFT假设长度为 $N$ 的有限长度信号段 $x[n]$ 是一个无限周期信号的一个周期。如果信号段不包含其组成正弦波的整数个周期，那么在信号环绕的边界处就会出现剧烈的不连续性。这种不连续性在频域中表现为频谱泄漏，即来自真实频率的能量“泄漏”到其他频率仓中。\n\n加窗是减轻这种效应的一种技术。在计算DFT之前，将窗函数 $w[n]$ 应用于信号，即 $y[n] = x[n]w[n]$。窗函数在信号段的两端逐渐趋近于零，从而减少边界的不连续性。这是有代价的。窗函数的傅里叶变换与信号的真实频谱进行卷积。这种卷积会加宽主谱峰（主瓣），并减小伪峰（旁瓣）的幅度。这就产生了一种权衡：\n\n$1$. **矩形窗, $w_{\\mathrm{rect}}[n]$**：这相当于不加窗，仅仅是截断信号。其变换具有最窄的主瓣，提供最高的理论频率分辨率。然而，它也有最高的旁瓣（第一个旁瓣仅比主瓣低约 $-13$ dB），导致严重的频谱泄漏，可能会掩盖附近的较弱信号或与相邻的强信号合并。\n\n$2$. **汉宁窗, $w_{\\mathrm{hann}}[n]$**：这是一个平滑的钟形窗。其主瓣宽度大约是矩形窗的两倍，因此降低了频率分辨率。其显著优点是旁瓣水平低得多（第一个旁瓣在约 $-31$ dB处），这提供了出色的泄漏抑制效果。\n\n$3$. **布莱克曼窗, $w_{\\mathrm{black}}[n]$**：该窗提供更宽的主瓣（大约是矩形窗的三倍），作为回报，其旁瓣也更低（第一个旁瓣在约 $-58$ dB处）。它以进一步降低频率分辨率为代价，提供了卓越的泄漏抑制效果。\n\n该问题要求使用幅度谱 $M[k] = |X[k]|$ 的两个度量标准对这种权衡进行定量分析。\n\n- **泄漏分数, $L$**：该度量定义为 $L = (\\sum_{k=0,\\,k \\neq p_{1},\\,k \\neq p_{2}}^{N/2} M[k]^{2}) / (\\sum_{k=0}^{N/2} M[k]^{2})$，用于测量泄漏到与信号关联的主频率仓 $p_{1}$ 和 $p_{2}$ 之外的频谱能量的比例。这些频率仓是通过将真实频率用DFT频率分辨率 $f/\\Delta f$ 归一化后四舍五入来确定的。较低的 $L$ 值表示更好的频谱泄漏抑制。我们预期 $L_{\\mathrm{rect}} > L_{\\mathrm{hann}} > L_{\\mathrm{black}}$。\n\n- **峰值比, $R$**：该度量定义为 $R = M_{\\mathrm{second}} / M_{\\max}$，用于量化两个频谱分量的可分辨性。如果两个正弦波在频谱中被分辨为两个不同的峰，则 $R$ 将接近于 $1$（因为正弦波幅度相等）。如果它们合并成一个单一的宽峰，$M_{\\max}$ 将是这个合并后的峰值，而 $M_{\\mathrm{second}}$ 将是最高的旁瓣，从而导致 $R$ 的值很小。由于 $|f_{1} - f_{2}|  \\Delta f$，根据矩形窗的经典Rayleigh准则，这些分量是不可分辨的。我们将研究它们是否尽管如此仍可区分。\n\n解决每个测试用例的算法步骤如下：\n\n$1$. 定义参数 $f_{s}$、$N$、$f_{1}$、$f_{2}$、$\\phi_{1}$ 和 $\\phi_{2}$。\n$2$. 生成离散时间向量 $n = [0, 1, \\dots, N-1]$。\n$3$. 构建信号 $x[n] = \\sin(2\\pi \\frac{f_{1}}{f_{s}} n + \\phi_{1}) + \\sin(2\\pi \\frac{f_{2}}{f_{s}} n + \\phi_{2})$。\n$4$. 对于三种指定的窗函数 $w[n]$（矩形窗、汉宁窗、布莱克曼窗）中的每一种：\n    a. 生成窗序列 $w[n]$。\n    b. 将窗函数应用于信号：$y[n] = x[n] \\cdot w[n]$。\n    c. 为提高效率，使用快速傅里叶变换（FFT）算法计算加窗信号的DFT，$X[k] = \\sum_{n=0}^{N-1} y[n]\\,e^{-j 2\\pi \\frac{k n}{N}}$。\n    d. 提取非负频率幅度谱，$M[k] = |X[k]|$，其中 $k = 0, 1, \\dots, N/2$。\n    e. 计算DFT频率分辨率 $\\Delta f = f_{s}/N$。\n    f. 确定两个频率最接近的整数DFT频率仓索引：$p_{1} = \\mathrm{round}(f_{1}/\\Delta f)$ 和 $p_{2} = \\mathrm{round}(f_{2}/\\Delta f)$，并裁剪到有效范围 $[0, N/2]$ 内。\n    g. 通过对除 $p_{1}$ 和 $p_{2}$ 之外的所有频率仓的幅度平方求和，然后除以总的幅度平方和，来计算泄漏分数 $L$。\n    h. 通过找到频谱 $M[k]$ 中的两个最大值并计算它们的比率来计算峰值比 $R$。\n$5$. 将计算出的六个值（$L_{\\mathrm{rect}}, L_{\\mathrm{hann}}, L_{\\mathrm{black}}, R_{\\mathrm{rect}}, R_{\\mathrm{hann}}, R_{\\mathrm{black}}$）合并为该测试用例的单个列表。\n$6$. 对所有测试用例重复上述步骤，并按指定格式化最终输出。\n\n该过程在以下程序中实现。", "answer": "[[0.06346896,0.00224054,0.00010522,0.99986280,0.99999167,0.99999931],[0.06059219,0.00216016,0.00010228,0.99823555,0.99993279,0.99999639],[0.03844641,0.00033049,0.00000244,0.40794465,0.04652211,0.01229712]]", "id": "2440581"}]}