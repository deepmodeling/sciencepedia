{"hands_on_practices": [{"introduction": "矩形窗最显著的特征是其瞬时开启和关闭的突变边缘。本练习通过考察矩形窗的时间导数来探究这些尖锐边缘的后果。通过计算该导数的傅里叶变换，我们可以直观地理解为什么矩形窗会引入显著的频谱泄漏 [@problem_id:1747355]。", "problem": "设信号 $g(t)$ 定义为一个缩放矩形脉冲的时间导数。具体来说，考虑信号 $g(t) = \\frac{d}{dt} p(t)$，其中 $p(t) = \\text{rect}(t/T)$。\n\n标准的矩形函数 $\\text{rect}(\\tau)$ 定义为：\n$$\n\\text{rect}(\\tau) =\n\\begin{cases}\n1,  |\\tau|  1/2 \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\n参数 $T$ 是一个正实数常数，表示脉冲 $p(t)$ 的持续时间。\n\n信号 $x(t)$ 的连续时间傅里叶变换 (CTFT) 定义为：\n$$\nX(\\omega) = \\int_{-\\infty}^{\\infty} x(t) e^{-i\\omega t} dt\n$$\n其中 $\\omega$ 是角频率。\n\n求信号 $g(t)$ 的CTFT $G(\\omega)$。将您的最终答案表示为关于 $\\omega$ 和 $T$ 的单个表达式，并简化为只包含一个正弦函数的形式。", "solution": "我们首先将矩形函数 $p(t) = \\text{rect}(t/T)$ 用单位阶跃函数 $u(t)$ 表示。根据 $\\text{rect}$ 函数的定义，$p(t)$ 在 $|t|  T/2$ 区间内为 1，在其他地方为 0。这可以写成两个阶跃函数的差：\n$$\np(t) = u(t + T/2) - u(t - T/2)\n$$\n接下来，我们计算 $p(t)$ 的时间导数 $g(t) = \\frac{d}{dt}p(t)$。单位阶跃函数的导数是狄拉克 $\\delta$ 函数，即 $\\frac{d}{dt}u(t) = \\delta(t)$。利用链式法则，我们得到：\n$$\ng(t) = \\frac{d}{dt}\\left[u(t + T/2) - u(t - T/2)\\right] = \\delta(t + T/2) - \\delta(t - T/2)\n$$\n这个结果表明，矩形脉冲的导数是位于其边缘的两个符号相反的 $\\delta$ 函数。\n\n现在，我们求 $g(t)$ 的傅里叶变换 $G(\\omega)$。我们利用傅里叶变换的时移性质，即 $\\mathcal{F}\\{\\delta(t-t_0)\\} = e^{-i\\omega t_0}$。\n$$\nG(\\omega) = \\mathcal{F}\\{\\delta(t + T/2) - \\delta(t - T/2)\\} = \\mathcal{F}\\{\\delta(t + T/2)\\} - \\mathcal{F}\\{\\delta(t - T/2)\\}\n$$\n应用时移性质，我们得到：\n$$\nG(\\omega) = e^{-i\\omega(-T/2)} - e^{-i\\omega(T/2)} = e^{i\\omega T/2} - e^{-i\\omega T/2}\n$$\n最后，我们使用欧拉公式 $e^{ix} - e^{-ix} = 2i\\sin(x)$ 来简化表达式。令 $x = \\omega T/2$，我们得到：\n$$\nG(\\omega) = 2i\\sin\\left(\\frac{\\omega T}{2}\\right)\n$$\n这就是信号 $g(t)$ 的傅里叶变换。", "answer": "$$\\boxed{2i\\sin\\!\\left(\\frac{\\omega T}{2}\\right)}$$", "id": "1747355"}, {"introduction": "在离散时间信号处理中，矩形窗常被用作简单移动平均滤波器的脉冲响应。本练习将让您对一个矩形窗进行自卷积，这是一个基本操作，它揭示了此类滤波器平滑信号的方式 [@problem_id:1747392]。计算输出信号的能量，可以具体练习卷积运算及其效果。", "problem": "一个离散时间线性时不变 (LTI) 系统由其冲激响应表征，该冲激响应是一个3点矩形窗，定义为当整数 $n$ 的取值在 0 到 2 之间（含）时，$h[n] = 1$；对于所有其他 $n$ 值，$h[n] = 0$。一个输入信号 $x[n]$ 施加于该系统，其中 $x[n]$ 与冲激响应 $h[n]$ 相同。你的任务是确定系统输出信号 $y[n]$ 的总能量。对于一个离散时间信号 $g[n]$，其总能量由求和式 $E_g = \\sum_{n=-\\infty}^{\\infty} |g[n]|^2$ 给出。请以单个整数形式给出你的最终答案。", "solution": "该系统是 LTI 系统，其冲激响应 $h[n]$ 定义为：当 $0\\leq n\\leq 2$ 时，$h[n]=1$，否则 $h[n]=0$。输入为 $x[n]=h[n]$。对于一个 LTI 系统，输出是输入与冲激响应的卷积：\n$$\ny[n]=(x*h)[n]=\\sum_{k=-\\infty}^{\\infty} x[k]\\,h[n-k]=\\sum_{k=-\\infty}^{\\infty} h[k]\\,h[n-k].\n$$\n由于 $h[k]$ 仅在 $0\\leq k\\leq 2$ 时等于 $1$，且 $h[n-k]$ 仅在 $0\\leq n-k\\leq 2$ 时等于 $1$，因此该求和计算的是同时满足 $0\\leq k\\leq 2$ 和 $0\\leq n-k\\leq 2$ 的整数 $k$ 的数量。等价地，\n$$\ny[n]=\\#\\{k\\in\\mathbb{Z}:\\max(0,n-2)\\leq k\\leq \\min(2,n)\\}.\n$$\n因此，\n$$\ny[n]=\\max\\bigl(0,\\min(2,n)-\\max(0,n-2)+1\\bigr).\n$$\n仅当 $0\\leq n\\leq 4$ 时，该式不为零，得到如下分段函数值\n$$\ny[n]=\\begin{cases}\nn+1,  0\\leq n\\leq 2,\\\\\n5-n,  3\\leq n\\leq 4,\\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n因此，当 $n=0,1,2,3,4$ 时，$y[n]$ 的序列为 $1,2,3,2,1$，在其他情况下为 $0$。\n\n$y[n]$ 的总能量是\n$$\nE_{y}=\\sum_{n=-\\infty}^{\\infty} |y[n]|^{2}=\\sum_{n=0}^{4} y[n]^{2}=1^{2}+2^{2}+3^{2}+2^{2}+1^{2}=1+4+9+4+1=19.\n$$", "answer": "$$\\boxed{19}$$", "id": "1747392"}, {"introduction": "窗函数的一个主要用途是分离出信号的一个片段，以便使用离散傅里叶变换 ($ \\text{DFT} $) 进行频谱分析。本练习精确地模拟了这一过程：取一个短的矩形窗，用零填充，然后计算其 $ \\text{DFT} $ [@problem_id:1747399]。通过计算特定的 $ \\text{DFT} $ 系数，您将对窗函数的频率响应和频谱泄漏的本质有一个具体的感受。", "problem": "在数字信号处理中，窗函数用于分析较长信号的有限片段。最简单的此类函数是矩形窗。施加窗函数然后进行变换可以揭示重要的频率特性。\n\n考虑一个总长度为 $N=8$ 的离散时间信号 $w[n]$。该信号由一个长度为 $L=4$ 的矩形窗后接零填充构成。其定义为：\n$$\nw[n] = \\begin{cases} 1  \\text{对于 } 0 \\le n \\le 3 \\\\ 0  \\text{对于 } 4 \\le n \\le 7 \\end{cases}\n$$\n信号 $x[n]$ 的 $N$ 点离散傅里叶变换 (DFT) 由以下分析方程给出：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] e^{-j \\frac{2\\pi}{N} nk} \\quad \\text{对于 } k=0, 1, \\dots, N-1\n$$\n其中 $j$ 是满足 $j^2=-1$ 的虚数单位。\n\n你的任务是计算信号 $w[n]$ 的 8 点 DFT，我们记为 $W[k]$。确定所有奇数频率索引（即 $k=1, 3, 5, 7$）下 DFT 系数的具体值。\n\n将与 $W[1]$、$W[3]$、$W[5]$ 和 $W[7]$ 对应的四个复数按顺序表示为一个单行矩阵。每个复数必须以直角坐标形式 $a+jb$ 表示，其中 $a$ 和 $b$ 是以其精确、简化的解析形式（例如，使用整数和平方根，而不是十进制近似值）写出的实数。", "solution": "给定一个长度为 $N=8$ 的序列 $w[n]$，其中当 $0 \\leq n \\leq 3$ 时 $w[n]=1$，当 $4 \\leq n \\leq 7$ 时 $w[n]=0$。$N$ 点 DFT 为\n$$\nW[k] = \\sum_{n=0}^{N-1} w[n] \\exp\\!\\left(-j \\frac{2\\pi}{N} nk\\right) = \\sum_{n=0}^{3} \\exp\\!\\left(-j \\frac{2\\pi}{8} nk\\right) = \\sum_{n=0}^{3} \\exp\\!\\left(-j \\frac{\\pi}{4} nk\\right).\n$$\n定义 $\\omega \\triangleq \\exp\\!\\left(-j \\frac{\\pi}{4}\\right)$，则 $W[k] = \\sum_{n=0}^{3} (\\omega^{k})^{n} = 1 + \\omega^{k} + \\omega^{2k} + \\omega^{3k}$。这是一个公比为 $r=\\omega^{k}$ 的几何级数，因此对于 $r \\neq 1$，\n$$\nW[k] = \\frac{1 - r^{4}}{1 - r}.\n$$\n对于奇数 $k \\in \\{1,3,5,7\\}$，我们有 $r^{4} = \\omega^{4k} = \\exp(-j \\pi k) = (-1)^{k} = -1$，所以\n$$\nW[k] = \\frac{1 - (-1)}{1 - \\omega^{k}} = \\frac{2}{1 - \\omega^{k}}.\n$$\n为了获得直角坐标形式，方便使用 $\\omega$ 的幂的精确值来计算 $W[k]=1+\\omega^{k}+\\omega^{2k}+\\omega^{3k}$。令 $c \\triangleq \\frac{\\sqrt{2}}{2}$。则\n$$\n\\omega = c - jc,\\quad \\omega^{2} = -j,\\quad \\omega^{3} = -c - jc,\\quad \\omega^{5} = -c + jc,\\quad \\omega^{6} = j,\\quad \\omega^{7} = c + jc.\n$$\n\n对于 $k=1$：\n$$\nW[1] = 1 + \\omega + \\omega^{2} + \\omega^{3} = 1 + (c - jc) + (-j) + (-c - jc) = 1 - j\\bigl(1 + 2c\\bigr).\n$$\n因为 $2c = \\sqrt{2}$，这得到 $W[1] = 1 + j\\bigl(-\\sqrt{2} - 1\\bigr)$。\n\n对于 $k=3$：\n$$\nW[3] = 1 + \\omega^{3} + \\omega^{6} + \\omega^{9} = 1 + (-c - jc) + j + \\omega = 1 + (-c - jc) + j + (c - jc) = 1 + j\\bigl(1 - 2c\\bigr),\n$$\n因此 $W[3] = 1 + j\\bigl(1 - \\sqrt{2}\\bigr)$。\n\n对于 $k=5$：\n$$\nW[5] = 1 + \\omega^{5} + \\omega^{10} + \\omega^{15} = 1 + (-c + jc) + (-j) + \\omega^{7} = 1 + (-c + jc) + (-j) + (c + jc) = 1 + j\\bigl(2c - 1\\bigr),\n$$\n所以 $W[5] = 1 + j\\bigl(\\sqrt{2} - 1\\bigr)$。\n\n对于 $k=7$：\n$$\nW[7] = 1 + \\omega^{7} + \\omega^{14} + \\omega^{21} = 1 + (c + jc) + j + \\omega^{5} = 1 + (c + jc) + j + (-c + jc) = 1 + j\\bigl(1 + 2c\\bigr),\n$$\n得出 $W[7] = 1 + j\\bigl(\\sqrt{2} + 1\\bigr)$。\n\n因此，所求的 $k=1,3,5,7$ 时的 DFT 系数按顺序为\n$$\nW[1] = 1 + j\\bigl(-\\sqrt{2} - 1\\bigr),\\quad\nW[3] = 1 + j\\bigl(1 - \\sqrt{2}\\bigr),\\quad\nW[5] = 1 + j\\bigl(\\sqrt{2} - 1\\bigr),\\quad\nW[7] = 1 + j\\bigl(\\sqrt{2} + 1\\bigr).\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 1 + j(-\\sqrt{2} - 1)  1 + j(1 - \\sqrt{2})  1 + j(\\sqrt{2} - 1)  1 + j(\\sqrt{2} + 1) \\end{pmatrix}}$$", "id": "1747399"}]}