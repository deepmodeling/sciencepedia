## 引言
在数字信号处理领域，将经过充分发展的[模拟滤波器](@entry_id:269429)理论应用于数字世界是一项基本而重要的任务。[脉冲响应不变法](@entry_id:272647)（Impulse Invariance Method）正是实现这一转换的经典技术之一，它提供了一种直观且数学上严谨的桥梁，用于设计[无限冲激响应](@entry_id:180862)（IIR）[数字滤波器](@entry_id:181052)。然而，这种看似简单的“模仿”过程——让数字滤波器的冲激响应成为模拟响应的采样——背后隐藏着深刻的[频域](@entry_id:160070)后果和设计权衡。本文旨在系统性地解决如何从一个给定的[模拟滤波器](@entry_id:269429)原型，通过[脉冲响应不变法](@entry_id:272647)，推导出一个稳定且性能可预测的数字滤波器，并阐明其适用范围与内在局限。

为了全面掌握这一方法，本文将分为三个核心章节。首先，在**原则与机理**中，我们将深入其数学基础，揭示从[s平面到z平面](@entry_id:265320)的极点映射规则，探讨其如何保证稳定性的传递，并详细分析其最大的挑战——频率[混叠](@entry_id:146322)现象。接着，在**应用与跨学科联系**中，我们将[超越理论](@entry_id:203777)，探索该方法在[数字音频处理](@entry_id:265593)、[系统辨识](@entry_id:201290)和现代控制理论等领域的实际应用，并将其与[双线性变换](@entry_id:267854)等其他主流设计方法进行比较。最后，通过**动手实践**环节，你将有机会通过解决具体问题来巩固所学知识，将理论映射到实际计算中。让我们从理解这一强大设计工具的根本原理开始。

## 原则与机理

在本章中，我们将深入探讨[无限冲激响应](@entry_id:180862)（IIR）滤波器设计中的[脉冲响应不变法](@entry_id:272647)（Impulse Invariance Method）的根本原理与核心机理。此方法旨在通过对一个已知的模拟滤波器原型进行转换，来创建一个具有相似特性的数字滤波器。其核心思想在于确保数字滤波器的冲激响应是模拟滤波器冲激响应的采样版本。我们将系统性地剖析这一方法的数学基础、设计流程及其固有的优势与局限性。

### 核心原理：保持冲激响应不变

[脉冲响应不变法](@entry_id:272647)的出发点是一个简单而直观的概念：我们希望设计的[数字滤波器](@entry_id:181052)能够“模仿”一个给定的模拟滤波器。最直接的模仿方式，就是让数字滤波器的冲激响应 $h[n]$ 直接成为模拟滤波器冲激响应 $h_a(t)$ 在离散时间点上的采样值。若采样周期为 $T_s$，则该关系可以表示为：

$h[n] = h_a(nT_s)$

其中 $n$ 为整数。这个定义确保了数字系统在每个采样时刻的响应与模拟系统在相应时刻的响应完全一致。然而，在实际应用中，通常会引入一个[比例因子](@entry_id:266678) $T_s$，将定义修正为：

$h[n] = T_s \cdot h_a(nT_s)$

这个额外的比例因子 $T_s$ 并非随意添加，它具有重要的物理意义。其主要目的是为了在变换过程中更好地保持模拟滤波器与数字滤波器在低频区域的增益特性一致。具体来说，一个滤波器的直流（零频）增益是其冲激响应的总和（对于离散系统）或总积分（对于连续系统）。数字滤波器的[直流增益](@entry_id:267449)为 $H(e^{j0}) = H(1) = \sum_{n=0}^{\infty} h[n]$。若采用包含 $T_s$ 的定义，则有：

$H(1) = \sum_{n=0}^{\infty} T_s h_a(nT_s) = T_s \sum_{n=0}^{\infty} h_a(nT_s)$

另一方面，模拟滤波器的[直流增益](@entry_id:267449)为 $H_a(j0) = H_a(0) = \int_{0}^{\infty} h_a(t) dt$。我们可以观察到，上述求和表达式 $T_s \sum h_a(nT_s)$ 正是模拟冲激响应积分 $H_a(0)$ 的一个[黎曼和](@entry_id:137667)（Riemann sum）近似。当[采样周期](@entry_id:265475) $T_s$ 足够小时，这个近似会非常精确。因此，通过引入比例因子 $T_s$，我们确保了数字滤波器的[直流增益](@entry_id:267449)能够近似等于原模拟滤波器的[直流增益](@entry_id:267449)，这对于许多应用（尤其是低通滤波器的设计）是至关重要的 [@problem_id:1726532]。在后续的讨论中，我们将主要采用包含 $T_s$ 的定义。

### $s$ 平面到 $z$ 平面的映射：极点映射

为了将模拟滤波器的[传递函数](@entry_id:273897) $H_a(s)$ 转换为数字滤波器的[传递函数](@entry_id:273897) $H(z)$，我们需要理解脉冲响应采样在[频域](@entry_id:160070)（或复[频域](@entry_id:160070)）中意味着什么。对于一个稳定的因果[模拟滤波器](@entry_id:269429)，其[传递函数](@entry_id:273897) $H_a(s)$ 通常可以进行[部分分式展开](@entry_id:265121)，表示为若干一阶项之和：

$H_a(s) = \sum_{k=1}^{N} \frac{R_k}{s - p_k}$

其中 $p_k$ 是 $H_a(s)$ 的极点， $R_k$ 是对应的留数。通过拉普拉斯反变换，其冲激响应 $h_a(t)$ 为：

$h_a(t) = \left( \sum_{k=1}^{N} R_k e^{p_k t} \right) u(t)$

其中 $u(t)$ 是[单位阶跃函数](@entry_id:268807)。现在，我们对 $h_a(t)$ 进行采样得到 $h[n]$：

$h[n] = T_s h_a(nT_s) = T_s \left( \sum_{k=1}^{N} R_k e^{p_k nT_s} \right) u[n] = \sum_{k=1}^{N} (T_s R_k) (e^{p_k T_s})^n u[n]$

对 $h[n]$ 进行 Z 变换，利用 Z 变换的基本性质 $\mathcal{Z}\{a^n u[n]\} = \frac{1}{1-az^{-1}}$，我们得到数字滤波器的[传递函数](@entry_id:273897) $H(z)$：

$H(z) = \sum_{k=1}^{N} \frac{T_s R_k}{1 - e^{p_k T_s} z^{-1}}$

通过比较模拟和数字的[传递函数](@entry_id:273897)形式，我们发现一个深刻的对应关系：模拟滤波器在 $s$ 平面上的每一个极点 $p_k$，都通过 **$z = e^{sT_s}$** 的映射关系，转换为了[数字滤波器](@entry_id:181052)在 $z$ 平面上的一个极点 $z_k = e^{p_k T_s}$ [@problem_id:1726554]。这是一个从 $s$ 平面到 $z$ 平面的多对一映射，它是理解[脉冲响应不变法](@entry_id:272647)的关键。

这个映射具有几个重要的几何特性：

1.  **频率轴的映射**：模拟滤波器的[频率响应](@entry_id:183149)位于 $s$ 平面的虚轴上，即 $s = j\Omega$，其中 $\Omega$ 是模拟[角频率](@entry_id:261565)。在该映射下，这些点变为 $z = e^{j\Omega T_s}$。当 $\Omega$ 从 $-\infty$ 变化到 $+\infty$ 时，其在 $z$ 平面上的轨迹是单位圆。由于[指数函数的周期性](@entry_id:202370)，这个单位圆会被无限次地遍历 [@problem_id:1726555]。这表明整个模拟频率轴被压缩并反复“缠绕”在 $z$ 平面的[单位圆](@entry_id:267290)上。

2.  **左半平面的映射**：考虑 $s$ 平面左半平面中的任意一条[垂直线](@entry_id:174147)，$s = \sigma_0 + j\Omega$，其中 $\sigma_0  0$ 是一个常数。经过映射后，这些点变为 $z = e^{(\sigma_0 + j\Omega)T_s} = e^{\sigma_0 T_s} e^{j\Omega T_s}$。这些点的模长为 $|z| = |e^{\sigma_0 T_s}| = e^{\sigma_0 T_s}$，是一个小于 1 的常数（因为 $\sigma_0  0, T_s  0$）。当 $\Omega$ 遍历[实数轴](@entry_id:147286)时，其相位 $\Omega T_s$ 连续变化。因此，这条[垂直线](@entry_id:174147)被映射为 $z$ 平面内一个以原点为中心、半径为 $e^{\sigma_0 T_s}$ 的圆 [@problem_id:1726589]。

### 稳定性的保持

上述映射关系直接导出了[脉冲响应不变法](@entry_id:272647)的一个极其重要的性质：**稳定性保持**。一个因果模拟 LTI 系统是稳定的，当且仅当其[传递函数](@entry_id:273897) $H_a(s)$ 的所有极点 $p_k$ 都位于 $s$ 平面的左半开平面，即 $\text{Re}\{p_k\}  0$。

在[脉冲响应不变法](@entry_id:272647)中，这些模拟极点 $p_k$ 被映射为数字极点 $z_k = e^{p_k T_s}$。让我们来计算这些数字极点的模：

$|z_k| = |e^{p_k T_s}| = |e^{(\text{Re}\{p_k\} + j\text{Im}\{p_k\}) T_s}| = |e^{\text{Re}\{p_k\} T_s} \cdot e^{j\text{Im}\{p_k\} T_s}| = e^{\text{Re}\{p_k\} T_s}$

由于模拟系统是稳定的，我们有 $\text{Re}\{p_k\}  0$。同时，采样周期 $T_s$ 是一个正数。因此，指数的幂 $\text{Re}\{p_k\} T_s$ 必然是负数，这使得 $|z_k| = e^{\text{Re}\{p_k\} T_s}  1$。

这意味着，所有映射后的数字极点 $z_k$ 都严格位于 $z$ 平面的[单位圆](@entry_id:267290)内部。对于一个因果数字 LTI 系统，所有极点位于[单位圆](@entry_id:267290)内是其稳定的充分必要条件。因此，我们可以得出结论：**如果原始的[模拟滤波器](@entry_id:269429)是稳定的，那么通过[脉冲响应不变法](@entry_id:272647)设计出的[数字滤波器](@entry_id:181052)也必定是稳定的**，这个结论对于任何正的[采样周期](@entry_id:265475) $T_s$ 都成立 [@problem_id:1726531] [@problem_id:1726530]。

### 设计流程实践

掌握了以上原理后，我们可以总结出使用[脉冲响应不变法](@entry_id:272647)设计 IIR 滤波器的具体步骤。假设我们从一个稳定的[模拟滤波器](@entry_id:269429)[传递函数](@entry_id:273897) $H_a(s)$ 和一个选定的[采样周期](@entry_id:265475) $T_s$ 开始。

**步骤 1: [部分分式展开](@entry_id:265121)**
对 $H_a(s)$ 进行[部分分式展开](@entry_id:265121)，将其表示为一阶项的和：
$H_a(s) = \sum_{k=1}^{N} \frac{R_k}{s - p_k}$

**步骤 2: 极点映射**
对展开式中的每一项，应用[脉冲响应不变法](@entry_id:272647)的映射规则。每个模拟项 $\frac{R_k}{s - p_k}$ 对应一个数字项 $\frac{T_s R_k}{1 - e^{p_k T_s} z^{-1}}$。（如果采用无标度定义，则分子为 $R_k$）。

**步骤 3: 合并为单一[传递函数](@entry_id:273897)**
将所有数字项相加，得到最终的[数字滤波器](@entry_id:181052)[传递函数](@entry_id:273897) $H(z)$：
$H(z) = \sum_{k=1}^{N} \frac{T_s R_k}{1 - e^{p_k T_s} z^{-1}}$
然后，将这些分式通分，合并成一个单一的、关于 $z^{-1}$ 的[有理函数](@entry_id:154279)。

**示例：**
让我们以一个[模拟滤波器](@entry_id:269429)为例，其[传递函数](@entry_id:273897)为 $H_a(s) = \frac{1}{(s+2)(s+5)}$，采样周期为 $T_s = 0.2$ 秒 [@problem_id:1726554]。

1.  **[部分分式展开](@entry_id:265121)**：
    $H_a(s) = \frac{1/3}{s+2} - \frac{1/3}{s+5}$
    这里的极点为 $p_1 = -2$ 和 $p_2 = -5$，对应的留数为 $R_1 = 1/3$ 和 $R_2 = -1/3$。

2.  **极点映射**：
    项 $\frac{1/3}{s+2}$ 映射为 $\frac{T_s \cdot (1/3)}{1 - e^{-2T_s} z^{-1}}$。
    项 $\frac{-1/3}{s+5}$ 映射为 $\frac{T_s \cdot (-1/3)}{1 - e^{-5T_s} z^{-1}}$。

3.  **合并**：
    $H(z) = \frac{T_s/3}{1 - e^{-2T_s} z^{-1}} - \frac{T_s/3}{1 - e^{-5T_s} z^{-1}}$
    通分后得到：
    $H(z) = \frac{(T_s/3) \left[ (1 - e^{-5T_s} z^{-1}) - (1 - e^{-2T_s} z^{-1}) \right]}{(1 - e^{-2T_s} z^{-1})(1 - e^{-5T_s} z^{-1})}$
    $H(z) = \frac{(T_s/3) (e^{-2T_s} - e^{-5T_s}) z^{-1}}{1 - (e^{-2T_s} + e^{-5T_s}) z^{-1} + e^{-7T_s} z^{-2}}$
    代入 $T_s = 0.2$，即可得到最终的数值表达式。

在某些情况下，我们可能只关心滤波器的分母系数。利用极点映射关系，可以快速确定分母。数字滤波器的分母多项式 $D(z)$ 的根就是其极点 $z_k = e^{p_k T_s}$。因此，分母可以写为：
$D(z) = \prod_{k=1}^{N} (1 - z_k z^{-1}) = \prod_{k=1}^{N} (1 - e^{p_k T_s} z^{-1})$
例如，对于一个[二阶系统](@entry_id:276555) $H_a(s) = \frac{13}{s^2 + 4s + 13}$ [@problem_id:1726592]，其极点为 $p_{1,2} = -2 \pm j3$。其数字滤波器的分母为：
$D(z) = (1 - e^{p_1 T_s} z^{-1})(1 - e^{p_2 T_s} z^{-1}) = 1 - (e^{p_1 T_s} + e^{p_2 T_s}) z^{-1} + e^{(p_1+p_2)T_s} z^{-2}$
分母中 $z^{-2}$ 的系数 $a_2$ 就是 $e^{(p_1+p_2)T_s}$。由于 $p_1+p_2 = (-2+j3)+(-2-j3)=-4$，当 $T_s = 0.1$ 时， $a_2 = e^{-4 \times 0.1} = e^{-0.4} \approx 0.6703$。这种方法无需计算完整的[传递函数](@entry_id:273897)，便可高效地求出分母系数。

### 混叠的挑战

[脉冲响应不变法](@entry_id:272647)的最大挑战，也是其适用范围受限的根本原因，在于**[频率响应](@entry_id:183149)的混叠（Aliasing）**。虽然该方法在时域中的定义（采样）看似简单，但在[频域](@entry_id:160070)中却引发了复杂的后果。

数字滤波器的[频率响应](@entry_id:183149) $H(e^{j\omega})$ 与模拟滤波器的[频率响应](@entry_id:183149) $H_a(j\Omega)$ 之间的精确关系可以通过泊松求和公式（Poisson Summation Formula）推导得出。对于我们采用的定义 $h[n] = T_s h_a(nT_s)$，该关系为：

$H(e^{j\omega}) = \sum_{k=-\infty}^{\infty} H_a\left(j\frac{\omega + 2\pi k}{T_s}\right)$

这个公式是[脉冲响应不变法](@entry_id:272647)最核心的[频域](@entry_id:160070)表达式 [@problem_id:1726573]。它表明，数字滤波器的[频率响应](@entry_id:183149)并不是模拟滤波器频率响应的简单[线性缩放](@entry_id:197235)版本，而是模拟响应的**无限个、经过频率缩放和平移的副本的叠加**。具体来说，模拟频率响应 $H_a(j\Omega)$ 以 $2\pi/T_s$ 的周期在频率轴上被复制，然后所有这些副本被相加，形成了最终的[数字频率](@entry_id:263681)响应。这个叠加过程就是**混叠**。

这一现象直接决定了[脉冲响应不变法](@entry_id:272647)的适用场景：

*   **对低通滤波器的适用性**：如果原始的[模拟滤波器](@entry_id:269429)是一个低通滤波器，并且其带宽（截止频率 $\Omega_c$）远小于奈奎斯特频率 $\pi/T_s$，那么 $H_a(j\Omega)$ 在 $|\Omega| \ge \pi/T_s$ 的区域其幅值已衰减至接近于零。在这种情况下，上述求和式中 $k \ne 0$ 的项（即来自高频区域的副本）对基带（$|\omega| \le \pi$）的贡献将微乎其微。因此，在基带内，$H(e^{j\omega}) \approx H_a(j\omega/T_s)$，[数字滤波器](@entry_id:181052)的响应能够很好地逼近[模拟滤波器](@entry_id:269429)的响应 [@problem_id:1726578]。

*   **对高通和[带阻滤波器](@entry_id:261721)的不适用性**：与低通滤波器不同，理想的高通或[带阻滤波器](@entry_id:261721)的频率响应不是带限的，它们在高频区域有显著的能量。当使用[脉冲响应不变法](@entry_id:272647)时，这些高频部分的响应副本会发生混叠，折返叠加到数字滤波器的基带频率范围内，从而严重扭曲甚至完全破坏原始的滤波器特性。例如，一个模拟高通滤波器在 $\Omega \to \infty$ 时增益不为零，这会导致无穷多个非零的响应副本叠加在一起，使得最终的[数字滤波器](@entry_id:181052)完全不具备高通特性 [@problem_id:1726547]。

综上所述，[脉冲响应不变法](@entry_id:272647)是一种强大而直观的[IIR滤波器设计](@entry_id:274610)技术，它保证了稳定性的传递，并能精确地映射极点。然而，由于其内在的[混叠](@entry_id:146322)效应，它的应用范围基本上局限于那些[模拟原型](@entry_id:191508)是近似带限的滤波器，最典型的就是低通和[带通滤波器](@entry_id:271673)。对于高通或[带阻滤波器](@entry_id:261721)的设计，必须采用其他能够避免或控制[混叠](@entry_id:146322)效应的方法，如[双线性变换](@entry_id:267854)法。