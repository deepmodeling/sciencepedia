{"hands_on_practices": [{"introduction": "脉冲不变法是设计IIR数字滤波器的核心技术之一，其基础在于将模拟滤波器的极点通过特定映射转换为数字滤波器的极点。这个练习将带你实践最基本的映射规则，即将s平面中的一个极点 $s_p$ 映射到z平面中的 $z_p = \\exp(s_p T)$。掌握这一转换是理解和应用脉冲不变法的第一步。[@problem_id:1726595]", "problem": "一位工程师正在设计一个数字信号处理系统，以取代现有的模拟组件。该模拟组件是一个简单、稳定的一阶低通滤波器，其传递函数在 s-平面上有一个位于 $s = -5$ 的单实极点。为了创建其数字等效系统，该工程师决定使用冲激不变法。在模数转换过程中，使用的采样周期为 $T$。\n\n请确定由此产生的数字无限冲激响应 (IIR) 滤波器在 z-平面上对应极点的位置。请用采样周期 $T$ 的符号表达式来表示您的答案。", "solution": "给定的模拟系统是一个稳定的一阶低通滤波器，在 $s=-5$ 处有一个单实极点。这样一个系统的典型形式为 $H_{a}(s)=\\frac{K}{s+5}$，其中 $K$ 为某个增益，其冲激响应为 $h_{a}(t)=K \\exp(-5 t) u(t)$，这里的 $u(t)$ 是单位阶跃函数。\n\n在冲激不变法下，离散时间冲激响应是通过对连续时间冲激响应以采样周期 $T$ 的整数倍进行采样得到的：\n$$\nh[n]=h_{a}(nT)=K \\exp(-5 n T) u[n].\n$$\n对 $h[n]$ 进行 $z$ 变换，\n$$\nH(z)=\\sum_{n=0}^{\\infty} K \\exp(-5 T n) z^{-n}=K \\sum_{n=0}^{\\infty} \\left(\\exp(-5 T) z^{-1}\\right)^{n}.\n$$\n这是一个公比为 $\\exp(-5 T) z^{-1}$ 的几何级数，当 $|z||\\exp(-5 T)|$ 时收敛，其和为\n$$\nH(z)=\\frac{K}{1-\\exp(-5 T) z^{-1}}.\n$$\n因此，该数字 IIR 滤波器的极点是分母的根，\n$$\n1-\\exp(-5 T) z^{-1}=0 \\quad \\Rightarrow \\quad z=\\exp(-5 T).\n$$\n更一般地，在冲激不变法下，一个位于 $s=s_{0}$ 的连续时间极点会映射到位于 $z=\\exp(s_{0} T)$ 的离散时间极点。代入 $s_{0}=-5$ 即可得到极点位置 $z=\\exp(-5 T)$。", "answer": "$$\\boxed{\\exp(-5 T)}$$", "id": "1726595"}, {"introduction": "掌握了基本的极点映射规则后，我们可以通过一个思想实验来探索其在极限情况下的行为。当采样周期 $T$ 趋近于零（即采样率趋于无穷大）时，数字滤波器的极点会移动到z平面的何处？通过分析这个极限情况，我们可以更深刻地理解s平面与z平面之间的映射关系，以及采样率如何影响最终数字滤波器的特性。[@problem_id:1726569]", "problem": "一个模拟滤波器由传递函数 $H_a(s) = \\frac{1}{s+a}$ 描述，其中 $s$ 是拉普拉斯域中的复频率变量，$a$ 是一个正实数常数。这个模拟滤波器将使用脉冲响应不变法转换为数字无限脉冲响应 (IIR) 滤波器。在这种方法中，s平面中位于 $s_p$ 的极点根据关系式 $z_p = \\exp(s_p T)$ 映射到z平面中位于 $z_p$ 的极点，其中 $T$ 是采样周期。\n\n当采样周期 $T$ 趋近于零时，确定数字极点 $z_p$ 在复z平面中的极限位置。最终答案应该是一个单个实数。", "solution": "目标是求当采样周期 $T$ 趋近于零时，数字滤波器极点 $z_p$ 的极限位置。\n\n首先，我们需要从其传递函数 $H_a(s)$ 中确定模拟滤波器的极点。传递函数由下式给出：\n$$H_a(s) = \\frac{1}{s+a}$$\n极点 $s_p$ 是使传递函数分母为零的 $s$ 的值。\n$$s+a = 0$$\n解出 $s$，我们得到模拟极点的位置：\n$$s_p = -a$$\n\n接下来，我们使用给定的脉冲响应不变法的映射规则来找到z平面中对应极点 $z_p$ 的位置。该规则是：\n$$z_p = \\exp(s_p T)$$\n将模拟极点位置 $s_p = -a$ 代入此方程，我们得到用常数 $a$ 和采样周期 $T$ 表示的数字极点位置的表达式：\n$$z_p = \\exp(-aT)$$\n\n问题要求当采样周期 $T$ 趋近于零时，该数字极点的极限位置。因此，我们需要计算当 $T \\to 0$ 时 $z_p$ 的极限：\n$$\\lim_{T \\to 0} z_p = \\lim_{T \\to 0} \\exp(-aT)$$\n由于指数函数 $\\exp(x)$ 对所有实数 $x$ 都是连续的，我们可以将极限移到函数内部：\n$$\\lim_{T \\to 0} \\exp(-aT) = \\exp\\left(\\lim_{T \\to 0} (-aT)\\right)$$\n现在，我们计算指数的极限。由于 $a$ 是一个常数：\n$$\\lim_{T \\to 0} (-aT) = -a \\times 0 = 0$$\n将此结果代回表达式中，我们得到：\n$$\\exp(0) = 1$$\n\n因此，当采样周期 $T$ 趋近于零时，数字极点 $z_p$ 趋近于 1。", "answer": "$$\\boxed{1}$$", "id": "1726569"}, {"introduction": "之前的练习展示了s平面到z平面的直接映射，但采样过程本身并非完美，它会引入一种称为“混叠”的现象。这个更深入的练习揭示了脉冲不变法中一个令人惊讶的后果：两个特性截然不同的模拟滤波器（例如，一个低通滤波器和一个带通滤波器）在经过采样后，可能产生完全相同的数字滤波器。这个假想场景有力地说明了脉冲不变法的一个关键特性与潜在的陷阱，即频率混叠效应。[@problem_id:1726542]", "problem": "从模拟原型设计无限冲激响应 (IIR) 数字滤波器有时会导致与直觉相悖的结果。冲激不变法就是这样一种设计技术，该方法通过对连续时间模拟滤波器的冲激响应进行采样来创建数字滤波器的冲激响应。\n\n考虑一个稳定的、二阶、具有实值系数的低通模拟滤波器，其传递函数由下式给出：\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{(s - \\sigma_0)^2 + \\omega_0^2}$$\n其中 $\\sigma_0$ 和 $\\omega_0$ 是代表滤波器参数的实常数，并满足约束条件 $\\sigma_0  0$ 和 $\\omega_0  0$。该滤波器的直流增益为 1。\n\n该滤波器被用作原型，通过冲激不变法设计一个采样周期为 $T_s$ 的数字滤波器 $H(z)$。\n\n事实证明，存在另一个稳定的二阶模拟滤波器 $H_2(s)$，它具有截然不同的带通频率响应特性，但当使用相同的冲激不变法设计过程和相同的采样周期 $T_s$ 时，却能产生完全相同的数字滤波器 $H(z)$。\n\n确定一个这样的滤波器 $H_2(s)$ 的传递函数。你的最终答案应该是一个关于 $s$、$\\sigma_0$、$\\omega_0$ 和 $T_s$ 的封闭形式解析表达式。", "solution": "冲激不变法的核心原理是，数字滤波器的冲激响应 $h_d[n]$ 是模拟滤波器冲激响应 $h_a(t)$ 的采样版本。即 $h_d[n] = h_a(nT_s)$，其中 $T_s$ 是采样周期。\n\n要使两个不同的模拟滤波器 $H_1(s)$ 和 $H_2(s)$ 产生相同的数字滤波器 $H(z)$，它们各自的冲激响应 $h_1(t)$ 和 $h_2(t)$ 必须产生相同的采样序列。因此，条件是：\n$$h_1(nT_s) = h_2(nT_s) \\quad \\text{for all integers } n \\ge 0$$\n请注意，这并不意味着 $h_1(t)$ 必须对所有 $t$ 都等于 $h_2(t)$。\n\n首先，我们求出与给定低通滤波器 $H_1(s)$ 相对应的冲激响应 $h_1(t)$。\n其传递函数为：\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{(s - \\sigma_0)^2 + \\omega_0^2}$$\n该形式可以与拉普拉斯变换对 $\\mathcal{L}\\{e^{at}\\sin(bt)u(t)\\} = \\frac{b}{(s-a)^2 + b^2}$ 相关联。\n我们可以将 $H_1(s)$ 重写为：\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\cdot \\frac{\\omega_0}{(s - \\sigma_0)^2 + \\omega_0^2}$$\n应用拉普拉斯逆变换，我们得到冲激响应 $h_1(t)$：\n$$h_1(t) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_0 t) u(t)$$\n其中 $u(t)$ 是 Heaviside 阶跃函数。\n\n接下来，我们以 $T_s$ 为间隔对该冲激响应进行采样：\n$$h_1(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s) \\quad \\text{for } n \\ge 0$$\n\n现在，我们需要找到一个不同的连续时间冲激响应 $h_2(t)$，使得 $h_2(nT_s) = h_1(nT_s)$。关键在于采样正弦函数的周期性。正弦函数具有性质 $\\sin(\\theta) = \\sin(\\theta + 2\\pi k)$，其中 $k$ 为任意整数。\n我们来考虑 $\\sin(\\omega_0 n T_s)$ 这一项。我们可以定义一个新的频率 $\\omega_1$，使得对于所有整数 $n$，都有 $\\sin(\\omega_1 n T_s) = \\sin(\\omega_0 n T_s)$。\n该等式成立的条件是：\n$$\\omega_1 n T_s = \\omega_0 n T_s + 2\\pi k n$$\n其中 $k$ 为某个非零整数。两边同除以 $n T_s$（当 $n \\neq 0$ 时），我们得到：\n$$\\omega_1 = \\omega_0 + \\frac{2\\pi k}{T_s}$$\n为了创建一个与 $H_1(s)$ 不同的滤波器，我们必须选择 $k \\neq 0$。问题指明 $H_2(s)$ 应具有带通特性。与可比的低通滤波器相比，带通滤波器通常在更高的频率处有谐振。这表明应选择一个正整数 $k$ 来增加频率。最简单的选择是 $k=1$。我们定义新的频率为：\n$$\\omega_1 = \\omega_0 + \\frac{2\\pi}{T_s}$$\n\n现在我们可以构造冲激响应 $h_2(t)$。它必须具有与 $h_1(t)$ 相同的指数衰减包络和幅度缩放，以便在采样时刻相匹配，但使用新的正弦频率 $\\omega_1$：\n$$h_2(t) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_1 t) u(t)$$\n我们来验证 $h_2(nT_s) = h_1(nT_s)$：\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_1 n T_s)$$\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin\\left(\\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right) n T_s\\right)$$\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s + 2\\pi n)$$\n由于 $n$ 是整数，$2\\pi n$ 是 $2\\pi$ 的整数倍，所以 $\\sin(\\omega_0 n T_s + 2\\pi n) = \\sin(\\omega_0 n T_s)$。\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s) = h_1(nT_s)$$\n条件得到满足。\n\n最后，我们通过对 $h_2(t)$ 进行拉普拉斯变换来求得传递函数 $H_2(s)$：\n$$H_2(s) = \\mathcal{L}\\{h_2(t)\\} = \\mathcal{L}\\left\\{ \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_1 t) u(t) \\right\\}$$\n使用与之前相同的拉普拉斯变换对：\n$$H_2(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\left[ \\frac{\\omega_1}{(s - \\sigma_0)^2 + \\omega_1^2} \\right]$$\n代入 $\\omega_1$ 的表达式：\n$$H_2(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\frac{\\omega_0 + \\frac{2\\pi}{T_s}}{(s - \\sigma_0)^2 + \\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)^2}$$\n这是一个稳定（$\\sigma_00$）的二阶滤波器的传递函数。其谐振中心位于一个高得多的频率 $\\omega_1 = \\omega_0 + 2\\pi/T_s$ 附近，并且其直流增益 $H_2(0)$ 远小于其峰值增益，这证实了它的带通特性，与在直流处具有最大增益的低通滤波器 $H_1(s)$ 形成对比。", "answer": "$$\\boxed{\\frac{(\\sigma_0^2 + \\omega_0^2)\\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)}{\\omega_0 \\left( (s-\\sigma_0)^2 + \\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)^2 \\right)}}$$", "id": "1726542"}]}