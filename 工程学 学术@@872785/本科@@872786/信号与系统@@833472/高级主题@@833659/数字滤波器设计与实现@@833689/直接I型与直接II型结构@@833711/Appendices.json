{"hands_on_practices": [{"introduction": "分析任何数字滤波器的第一步是理解其实现结构与整体传递函数之间的关系。本练习将指导你如何从直接II型（Direct Form II）滤波器的差分方程中推导出其传递函数，这是一种在数字音频等应用中因其内存效率而常见的结构。通过这个实践，你将巩固定义滤波器结构的差分方程与其频域表示 $H(z)$ 之间的核心联系。[@problem_id:1714613]", "problem": "一个离散时间线性时不变（LTI）系统，例如数字音频均衡器中使用的系统，是使用一种称为直接II型实现的计算结构来实现的。这种结构在内存方面是高效的，因为它最小化了延迟单元的数量。\n\n系统的行为由其输入序列 $x[n]$、输出序列 $y[n]$ 和一个内部中间序列 $w[n]$ 之间的关系来描述。中间序列 $w[n]$ 是根据以下递归差分方程由输入及其自身的过去值生成的：\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\n输出序列 $y[n]$ 则根据以下非递归差分方程由该中间序列的当前值和过去值形成：\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\n对于该系统的一个特定配置，滤波器系数如下：\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\n确定系统的总传递函数 $H(z) = Y(z)/X(z)$。", "solution": "该问题要求解一个由两个差分方程描述其直接II型结构的系统的传递函数 $H(z)$。传递函数是输出的Z变换 $Y(z)$ 与输入的Z变换 $X(z)$ 之比。我们可以通过首先对每个差分方程进行Z变换，然后将它们代数组合来找到这个传递函数。\n\n第一个方程关联了中间信号 $w[n]$ 和输入信号 $x[n]$：\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\n我们对这个方程应用Z变换。使用Z变换的时移特性，即 $\\mathcal{Z}\\{f[n-k]\\} = z^{-k}F(z)$，我们得到：\n$$W(z) = X(z) - a_1 z^{-1} W(z) - a_2 z^{-2} W(z)$$\n现在，我们重新整理这个方程以找到 $W(z)$ 和 $X(z)$ 之间的关系。我们将所有包含 $W(z)$ 的项归到一边：\n$$W(z) + a_1 z^{-1} W(z) + a_2 z^{-2} W(z) = X(z)$$\n提取公因式 $W(z)$，我们得到：\n$$W(z) (1 + a_1 z^{-1} + a_2 z^{-2}) = X(z)$$\n这使得我们可以将 $W(z)$ 与 $X(z)$ 的比率表示为一个传递函数，我们称之为 $H_1(z)$：\n$$H_1(z) = \\frac{W(z)}{X(z)} = \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n\n接下来，我们考虑第二个方程，它关联了输出信号 $y[n]$ 和中间信号 $w[n]$：\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\n再次，我们应用Z变换及其时移特性：\n$$Y(z) = b_0 W(z) + b_1 z^{-1} W(z) + b_2 z^{-2} W(z)$$\n从右侧提取公因式 $W(z)$ 得到：\n$$Y(z) = W(z) (b_0 + b_1 z^{-1} + b_2 z^{-2})$$\n这定义了从中间信号到输出的传递函数，我们称之为 $H_2(z)$：\n$$H_2(z) = \\frac{Y(z)}{W(z)} = b_0 + b_1 z^{-1} + b_2 z^{-2}$$\n\n总传递函数 $H(z) = Y(z)/X(z)$ 是这两个传递函数的乘积，因为该系统是 $H_1(z)$ 后跟 $H_2(z)$ 的级联：\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{Y(z)}{W(z)} \\cdot \\frac{W(z)}{X(z)} = H_2(z) H_1(z)$$\n代入 $H_1(z)$ 和 $H_2(z)$ 的表达式：\n$$H(z) = (b_0 + b_1 z^{-1} + b_2 z^{-2}) \\cdot \\left( \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}} \\right)$$\n$$H(z) = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n这是直接II型二阶IIR滤波器的传递函数的一般形式。\n\n最后，我们代入给定的系数数值：\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\n将这些值代入 $H(z)$ 的一般表达式中：\n$$H(z) = \\frac{2 + (0.5) z^{-1} + (-0.3) z^{-2}}{1 + (-0.7) z^{-1} + (0.1) z^{-2}}$$\n$$H(z) = \\frac{2 + 0.5 z^{-1} - 0.3 z^{-2}}{1 - 0.7 z^{-1} + 0.1 z^{-2}}$$\n这就是该系统传递函数的最终闭式表达式。", "answer": "$$\\boxed{\\frac{2 + 0.5z^{-1} - 0.3z^{-2}}{1 - 0.7z^{-1} + 0.1z^{-2}}}$$", "id": "1714613"}, {"introduction": "在学习了如何从已知结构推导传递函数之后，一个更具实际意义的挑战是反向操作：从滤波器的观测行为中确定其内部参数。本练习模拟了一项常见的工程任务——系统辨识（system identification），即通过分析一个“黑箱”滤波器的脉冲响应来推断其未知的反馈系数。这项实践将加深你对差分方程如何决定滤波器时域输出的理解。[@problem_id:1714591]", "problem": "一位工程师的任务是描述一个未知的因果、二阶线性时不变 (LTI) 数字滤波器。这种类型的滤波器通常使用直接型结构实现，其输入-输出关系可以通过一个通用的有理传递函数 $H(z)$ 来描述：\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n这是二阶无限脉冲响应 (IIR) 滤波器的一般形式。\n\n通过初步分析，工程师确定该滤波器具有一个简单的前馈路径，由系数 $b_0 = 2$、$b_1 = 0$ 和 $b_2 = 0$ 描述。为了确定反馈系数，将一个单位脉冲输入（定义为 $x[n] = \\delta[n]$）施加到滤波器上。测得所得到的输出脉冲响应 $h[n]$ 的前三个样本为：\n$h[0] = 2$\n$h[1] = 1.6$\n$h[2] = 0.48$\n\n根据这些信息，确定反馈系数 $a_1$ 和 $a_2$ 的数值。答案应以有序对 $(a_1, a_2)$ 的形式给出。", "solution": "对于一个传递函数为\n$$H(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}+b_{1}z^{-1}+b_{2}z^{-2}}{1+a_{1}z^{-1}+a_{2}z^{-2}},$$\n的因果二阶 LTI IIR 滤波器，相应的时域差分方程可以通过两边同乘以分母并进行逆 $z$ 变换得到：\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2].$$\n给定 $b_{0}=2$、$b_{1}=0$ 和 $b_{2}=0$，上式简化为\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=2x[n].$$\n在脉冲输入 $x[n]=\\delta[n]$ 和零初始条件下（因果性和初始静止），输出是脉冲响应 $h[n]=y[n]$，它满足\n$$h[n]+a_{1}h[n-1]+a_{2}h[n-2]=2\\delta[n].$$\n使用 $h[-1]=0$ 和 $h[-2]=0$ 对 $n=0,1,2$ 计算这个递推关系：\n- 对于 $n=0$：\n$$h[0]+a_{1}h[-1]+a_{2}h[-2]=2 \\implies h[0]=2,$$\n与测量值一致。\n- 对于 $n=1$：\n$$h[1]+a_{1}h[0]+a_{2}h[-1]=0 \\implies h[1]+a_{1}h[0]=0 \\implies a_{1}=-\\frac{h[1]}{h[0]}.$$\n使用 $h[1]=1.6=\\frac{8}{5}$ 和 $h[0]=2$，\n$$a_{1}=-\\frac{\\frac{8}{5}}{2}=-\\frac{8}{10}=-\\frac{4}{5}.$$\n- 对于 $n=2$：\n$$h[2]+a_{1}h[1]+a_{2}h[0]=0 \\implies a_{2}=-\\frac{h[2]+a_{1}h[1]}{h[0]}.$$\n使用 $h[2]=0.48=\\frac{12}{25}$、$h[1]=\\frac{8}{5}$ 和 $a_{1}=-\\frac{4}{5}$，\n$$h[2]+a_{1}h[1]=\\frac{12}{25}-\\frac{4}{5}\\cdot\\frac{8}{5}=\\frac{12}{25}-\\frac{32}{25}=-\\frac{20}{25}=-\\frac{4}{5},$$\n因此\n$$a_{2}=-\\frac{-\\frac{4}{5}}{2}=\\frac{4}{5}\\cdot\\frac{1}{2}=\\frac{2}{5}.$$\n因此，反馈系数为 $a_{1}=-\\frac{4}{5}$ 和 $a_{2}=\\frac{2}{5}$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{4}{5}  \\frac{2}{5}\\end{pmatrix}}$$", "id": "1714591"}, {"introduction": "除了由传递函数描述的输入-输出关系，滤波器还有一个核心概念，即其内部“状态”——存储在记忆单元（延迟环节）中的值。本练习将探讨零输入响应（zero-input response），揭示即使没有输入信号，滤波器中存储的“能量”也能产生输出。通过计算这种自然响应，你将对系统稳定性以及直接II型结构中延迟环节的物理意义获得关键的洞察。[@problem_id:1714608]", "problem": "数字谐振器是音频合成与滤波中的一个关键组件，它通过一个二阶直接II型结构实现。在此结构中，首先处理输入信号 $x[n]$，根据以下差分方程生成一个中间状态信号 $w[n]$：\n$$w[n] = x[n] + w[n-1] - \\frac{1}{2} w[n-2]$$\n最终的输出信号 $y[n]$ 是通过第二个方程由状态信号合成的：\n$$y[n] = w[n] - w[n-2]$$\n在时间 $n=0$ 时，谐振器的输入被关闭，这意味着对于所有 $n \\ge 0$ 都有 $x[n] = 0$。然而，由于之前的活动，滤波器的存储单元（延迟模块）中保存着非零的初始值。具体来说，对应于状态信号的值为 $w[-1] = 1$ 和 $w[-2] = 2$。\n\n你的任务是确定系统在 $n \\ge 0$ 时的输出。这个输出被称为零输入响应 $y_{zi}[n]$。请找出 $y_{zi}[n]$ 在 $n \\ge 0$ 时的闭式表达式。", "solution": "由于对于所有 $n \\ge 0$ 都有 $x[n]=0$，状态方程化简为齐次线性常系数差分方程\n$$\nw[n] - w[n-1] + \\frac{1}{2} w[n-2] = 0.\n$$\n其特征方程为\n$$\nr^{2} - r + \\frac{1}{2} = 0,\n$$\n其根为\n$$\nr_{1,2} = \\frac{1 \\pm \\mathrm{i}}{2} = \\rho \\exp(\\pm \\mathrm{i}\\theta), \\quad \\rho = 2^{-1/2}, \\quad \\theta = \\frac{\\pi}{4}.\n$$\n因此通解为\n$$\nw[n] = \\alpha r_{1}^{n} + \\beta r_{2}^{n}.\n$$\n使用给定的初始状态值，从递推关系中求出 $w[0]$ 和 $w[1]$：\n$$\nw[0] = x[0] + w[-1] - \\frac{1}{2} w[-2] = 0 + 1 - \\frac{1}{2}\\cdot 2 = 0,\n$$\n$$\nw[1] = x[1] + w[0] - \\frac{1}{2} w[-1] = 0 + 0 - \\frac{1}{2}\\cdot 1 = -\\frac{1}{2}.\n$$\n代入 $w[0]=0$ 可得 $\\alpha + \\beta = 0 \\Rightarrow \\beta = -\\alpha$。于是\n$$\nw[1] = \\alpha r_{1} + \\beta r_{2} = \\alpha(r_{1} - r_{2}) = -\\frac{1}{2}.\n$$\n由于 $r_{1} - r_{2} = \\mathrm{i}$，可得 $\\alpha \\mathrm{i} = -\\frac{1}{2}$，因此 $\\alpha = \\frac{\\mathrm{i}}{2}$ 且 $\\beta = -\\frac{\\mathrm{i}}{2}$。所以，\n$$\nw[n] = \\frac{\\mathrm{i}}{2}\\left(r_{1}^{n} - r_{2}^{n}\\right) = -\\rho^{n} \\sin(n\\theta) = -2^{-n/2} \\sin\\left(\\frac{\\pi}{4} n\\right).\n$$\n输出为 $y[n] = w[n] - w[n-2]$，所以对于 $n \\ge 0$，\n$$\ny_{zi}[n] = -2^{-n/2} \\sin\\left(\\frac{\\pi}{4} n\\right) + 2^{-(n-2)/2} \\sin\\left(\\frac{\\pi}{4} (n-2)\\right).\n$$\n这就是所求的零输入响应的闭式表达式。", "answer": "$$\\boxed{2^{-(n-2)/2}\\sin\\left(\\frac{\\pi}{4}(n-2)\\right)-2^{-n/2}\\sin\\left(\\frac{\\pi}{4}n\\right)}$$", "id": "1714608"}]}