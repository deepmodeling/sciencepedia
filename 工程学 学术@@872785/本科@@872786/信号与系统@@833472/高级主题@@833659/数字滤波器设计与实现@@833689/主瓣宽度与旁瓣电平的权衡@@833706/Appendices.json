{"hands_on_practices": [{"introduction": "要真正理解频谱分析中的核心权衡，最好的方法就是亲自动手计算。这个练习将引导你量化分析两种最基础的窗函数——矩形窗和三角窗——它们在频谱上的表现。通过直接计算主瓣宽度和旁瓣电平，你将具体地看到为了换取更低的旁瓣（即更少的光谱泄漏）而牺牲主瓣宽度（即更低的分辨率）这一经典折衷关系。[@problem_id:1736404]", "problem": "在信号处理中，对一个数据块应用“窗函数”是在进行傅里叶变换之前的一个关键步骤。这样做是为了减轻频谱泄漏，这是一种信号在某一频率的能量“泄漏”到其他频率仓中的效应。不同的窗函数在解析紧密间隔的频率分量和抑制这种泄漏之间提供了不同的权衡。\n\n本问题要求你定量分析两种基本窗函数之间的权衡：矩形窗和三角（或 Bartlett）窗。两者都定义为仅在区间 $|t| \\le \\frac{T}{2}$ 上为非零。\n\n1.  **矩形窗：** 当 $|t| \\le \\frac{T}{2}$ 时，$w_R(t) = 1$，否则 $w_R(t) = 0$。\n2.  **三角窗：** 当 $|t| \\le \\frac{T}{2}$ 时，$w_T(t) = 1 - \\frac{2|t|}{T}$，否则 $w_T(t) = 0$。\n\n这些窗函数的频谱特性由它们的傅里叶变换 $W(f) = \\int_{-\\infty}^{\\infty} w(t) \\exp(-j 2\\pi f t) dt$ 决定。在你的计算中，请使用归一化的 sinc 函数，其定义为 $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$。\n\n我们将使用以下两个指标来评估这些窗函数的性能：\n\n*   **主瓣宽度：** 频谱中中央峰的宽度，定义为 $f=0$ 处主峰两侧前两个零点（zeros）之间的频率距离（单位为赫兹）。\n*   **峰值旁瓣电平 (PSL)：** 衡量最大旁瓣相对于主瓣强度的指标。为解决此问题，我们将通过计算频谱在离中心 ($f=0$) 的第一个和第二个零点之间的频率中点处的幅度 $|W(f)|$ 来近似第一个旁瓣的峰值幅度。PSL 是这个近似的旁瓣峰值幅度与主瓣峰值幅度 $|W(0)|$ 的比值。\n\n你的任务是计算以下两个无量纲比：\n\nA. 三角窗频谱的主瓣宽度与矩形窗频谱的主瓣宽度的比值，$\\frac{\\text{Width}_T}{\\text{Width}_R}$。\nB. 三角窗频谱的峰值旁瓣电平与矩形窗频谱的峰值旁瓣电平的比值，$\\frac{\\text{PSL}_T}{\\text{PSL}_R}$。\n\n请将你的最终答案表示为 $(\\frac{\\text{Width}_T}{\\text{Width}_R}, \\frac{\\text{PSL}_T}{\\text{PSL}_R})$ 的解析表达式有序对。", "solution": "定义傅里叶变换为 $W(f)=\\int_{-\\infty}^{\\infty} w(t)\\exp(-j2\\pi f t)\\,dt$，归一化 sinc 函数为 $\\text{sinc}(x)=\\frac{\\sin(\\pi x)}{\\pi x}$。\n\n对于矩形窗 $w_{R}(t)=1$（当 $|t|\\leq T/2$ 时）及 $0$（其他情况），计算\n$$\nW_{R}(f)=\\int_{-T/2}^{T/2}\\exp(-j2\\pi f t)\\,dt\n=\\left.\\frac{\\exp(-j2\\pi f t)}{-j2\\pi f}\\right|_{-T/2}^{T/2}\n=\\frac{\\exp(-j\\pi f T)-\\exp(j\\pi f T)}{-j2\\pi f}\n=T\\,\\text{sinc}(fT).\n$$\n当 $f\\neq 0$ 时，零点出现在 $\\sin(\\pi fT)=0$ 的位置，即 $f=\\pm\\frac{1}{T},\\pm\\frac{2}{T},\\ldots$。因此，主瓣宽度（$f=0$ 附近前两个零点之间的距离）为\n$$\n\\text{Width}_{R}=\\frac{1}{T}-\\left(-\\frac{1}{T}\\right)=\\frac{2}{T}.\n$$\n主瓣峰值为 $|W_{R}(0)|=\\int_{-T/2}^{T/2}1\\,dt=T$。第一个和第二个零点分别位于 $f=\\frac{1}{T}$ 和 $f=\\frac{2}{T}$，因此它们的中点是 $f=\\frac{3}{2T}$。在此中点处的近似旁瓣幅度为\n$$\n|W_{R}(\\tfrac{3}{2T})|=T\\,\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|,\n$$\n所以矩形窗的 PSL 为\n$$\n\\text{PSL}_{R}=\\frac{|W_{R}(\\tfrac{3}{2T})|}{|W_{R}(0)|}=\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|\n=\\left|\\frac{\\sin(\\tfrac{3}{2}\\pi)}{\\tfrac{3}{2}\\pi}\\right|\n=\\frac{2}{3\\pi}.\n$$\n\n对于三角窗 $w_{T}(t)=1-\\frac{2|t|}{T}$（当 $|t|\\leq T/2$ 时）及 $0$（其他情况），注意到 $w_{T}(t)$ 是一个底宽为 $T$、高为 1 的三角脉冲。其傅里叶变换是两个宽度为 $T/2$ 的矩形脉冲的卷积，再乘以一个尺度因子。更直接地，其傅里叶变换为：\n$$\nW_{T}(f) = \\frac{T}{2} \\text{sinc}^2\\left(\\frac{fT}{2}\\right).\n$$\n当 $\\text{sinc}\\!\\left(\\frac{fT}{2}\\right)=0$ 时出现零点，即 $\\frac{fT}{2}=\\pm 1,\\pm 2,\\ldots$，所以前两个零点位于 $f=\\pm\\frac{2}{T}$。因此主瓣宽度为\n$$\n\\text{Width}_{T}=\\frac{2}{T}-\\left(-\\frac{2}{T}\\right)=\\frac{4}{T}.\n$$\n因此，主瓣宽度之比为\n$$\n\\frac{\\text{Width}_{T}}{\\text{Width}_{R}}=\\frac{\\frac{4}{T}}{\\frac{2}{T}}=2.\n$$\n主瓣峰值为 $|W_{T}(0)|=\\int_{-T/2}^{T/2}\\left(1-\\frac{2|t|}{T}\\right)\\,dt=\\frac{T}{2}$，这也可以从 $W_{T}(0)=\\frac{T}{2}\\,\\text{sinc}^{2}(0)=\\frac{T}{2}$ 推导得出。对于 PSL，前两个零点位于 $f=\\frac{2}{T}$ 和 $f=\\frac{4}{T}$，其中点为 $f=\\frac{3}{T}$。此时近似的旁瓣幅度为\n$$\n|W_{T}(\\tfrac{3}{T})|=\\frac{T}{2}\\,\\left|\\text{sinc}^{2}\\!\\left(\\frac{3T/T}{2}\\right)\\right|=\\frac{T}{2}\\,\\left|\\text{sinc}^{2}\\!\\left(\\frac{3}{2}\\right)\\right|,\n$$\n所以\n$$\n\\text{PSL}_{T}=\\frac{|W_{T}(\\tfrac{3}{T})|}{|W_{T}(0)|}=\\left|\\text{sinc}^{2}\\!\\left(\\tfrac{3}{2}\\right)\\right|\n=\\left(\\frac{2}{3\\pi}\\right)^{2}.\n$$\n因此 PSL 之比为\n$$\n\\frac{\\text{PSL}_{T}}{\\text{PSL}_{R}}=\\frac{\\left(\\frac{2}{3\\pi}\\right)^{2}}{\\frac{2}{3\\pi}}=\\frac{2}{3\\pi}.\n$$\n\n所求的有序对是 $\\left(\\frac{\\text{Width}_{T}}{\\text{Width}_{R}},\\frac{\\text{PSL}_{T}}{\\text{PSL}_{R}}\\right)=\\left(2,\\frac{2}{3\\pi}\\right)$。", "answer": "$$\\boxed{\\left(2, \\frac{2}{3\\pi}\\right)}$$", "id": "1736404"}, {"introduction": "理论概念只有在应用于实际问题时才显示出其真正的力量。上一个练习我们分析了主瓣宽度，现在我们来看看它在工程实践中的直接应用：频率分辨率。这个练习模拟了一个常见的工程场景，你需要确定一个系统能够区分两个相近频率分量的最小间隔。通过这个实践，你将把抽象的光谱特性（主瓣宽度）与雷达、通信和振动分析等领域中的关键性能指标（分辨率）联系起来。[@problem_id:1736446]", "problem": "一个信号处理器用于分析来自一台精密铣床的振动数据。数据是在总观测时间 $T = 400$ 毫秒内收集的。为减少频谱泄漏，在进行傅里叶变换之前，将收集到的数据段乘以一个三角窗函数 $w(t)$。三角窗定义为：当 $|t| \\le T/2$ 时，$w(t) = 1 - \\frac{2|t|}{T}$，否则 $w(t)=0$。如果一个模式的频谱响应峰值与另一个模式的频谱响应的第一个零点（过零点）重合，那么这两个振幅相近的、不同的振动模式被认为是恰好可分辨的。确定该系统可以分辨的这两种模式之间的最小频率间隔。以赫兹（Hz）为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "问题要求计算使用时长为 $T$ 的三角窗的系统的最小可分辨频率间隔 $\\Delta f_{\\text{min}}$。分辨准则为瑞利准则 (Rayleigh criterion)：如果一个谱峰的最大值落在另一个谱峰的第一个最小值上，则认为这两个谱峰是可分辨的。\n\n当包含正弦波的信号乘以窗函数 $w(t)$ 时，其频谱是正弦波频谱（脉冲）与窗函数傅里叶变换 $W(f)$ 的卷积。这意味着每个正弦分量的频谱都将具有 $W(f)$ 的形状。因此，为了找到最小可分辨频率间隔，我们需要找到 $W(f)$ 相对于其在 $f=0$ 处的峰值的第一个零点的频率。\n\n首先，我们计算三角窗函数 $w(t)$ 的傅里叶变换。\n该窗函数定义为：当 $|t| \\le T/2$ 时，$w(t) = 1 - \\frac{2|t|}{T}$，否则为 $0$。\n其傅里叶变换 $W(f)$ 为：\n$$ W(f) = \\frac{T}{2} \\left( \\frac{\\sin(\\pi f T / 2)}{\\pi f T / 2} \\right)^2 = \\frac{T}{2} \\text{sinc}^2\\left(\\frac{fT}{2}\\right) $$\n其中 $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$ 是归一化的sinc函数。\n\n$W(f)$ 的主瓣中心在 $f=0$ 处。当sinc函数的自变量为非零整数时，出现零点。因此，对于第一个零点，我们将自变量设为 $\\pm 1$：\n$$ \\frac{f_{\\text{null}} T}{2} = \\pm 1 $$\n解出 $f_{\\text{null}}$ 得：\n$$ f_{\\text{null}} = \\pm \\frac{2}{T} $$\n从 $f=0$ 处的中心峰值到第一个零点的距离是 $2/T$。根据问题的分辨准则，这个距离就是最小可分辨频率间隔 $\\Delta f_{\\text{min}}$。\n$$ \\Delta f_{\\text{min}} = \\frac{2}{T} $$\n给定 $T = 400$ 毫秒，即 $0.400$ 秒。\n$$ \\Delta f_{\\text{min}} = \\frac{2}{0.400 \\text{ s}} = 5.00 \\text{ Hz} $$\n最小可分辨频率间隔为 5.00 Hz。", "answer": "$$\\boxed{5.00}$$", "id": "1736446"}, {"introduction": "在掌握了分析现有窗函数的方法后，我们可以更进一步，尝试从头开始设计一个满足特定需求的自定义窗函数。这个练习将挑战你从分析转向综合，即通过在Z域的单位圆上策略性地放置零点，来设计一个具有特定频谱零陷（用于抑制干扰）的窗函数。这个过程不仅能加深你对时域系数和频域响应之间深刻联系的理解，也让你一窥真实世界中数字滤波器设计的精髓。[@problem_id:1736389]", "problem": "一位工程师正在为频谱分析应用设计一个自定义窗。该窗是一个5抽头、对称、零相位的有限脉冲响应（FIR）滤波器，其系数表示为 $w[n]$，其中 $n \\in \\{-2, -1, 0, 1, 2\\}$，且满足 $w[n] = w[-n]$。为了实现特定的干扰抑制，该窗的频率响应，即其离散时间傅里叶变换（DTFT）$W(e^{j\\omega})$，必须在归一化角频率 $\\omega_1 = \\frac{\\pi}{2}$ 弧度/样本 和 $\\omega_2 = \\frac{3\\pi}{4}$ 弧度/样本 处有零点。\n\n该窗的频谱特性是，在 $\\omega=0$ 附近有一个中心主瓣，在较高频率处有一系列较小的旁瓣。主瓣被定义为 $\\omega=0$ 附近由第一对零点所界定的区域。峰值主瓣电平是频率响应在 $\\omega=0$ 处的幅度。峰值旁瓣电平被定义为主瓣区域外频率响应的最大绝对值。\n\n计算此自定义窗的峰值旁瓣电平与峰值主瓣电平之比。将您的答案表示为一个数值，并四舍五入到四位有效数字。", "solution": "对于一个5抽头、对称、零相位的FIR滤波器，其系数满足 $w[n]=w[-n]$ 且支撑集为 $n\\in\\{-2,-1,0,1,2\\}$，其离散时间傅里叶变换（DTFT）可以简化为一个实的偶余弦级数：\n$$\nW(e^{j\\omega})=\\sum_{n=-2}^{2}w[n]e^{-j\\omega n}=w[0]+2w[1]\\cos\\omega+2w[2]\\cos 2\\omega.\n$$\n令 $x=\\cos\\omega$。使用 $\\cos 2\\omega=2x^{2}-1$，$W(e^{j\\omega})$ 是一个关于 $x$ 的二次多项式。在 $\\omega_{1}=\\frac{\\pi}{2}$ 和 $\\omega_{2}=\\frac{3\\pi}{4}$ 处施加条件 $W(e^{j\\omega_{1}})=0$ 和 $W(e^{j\\omega_{2}})=0$，其中 $x_{1}=\\cos\\omega_{1}=0$ 且 $x_{2}=\\cos\\omega_{2}=-\\frac{\\sqrt{2}}{2}$，那么具有这两个根的唯一（在非零比例因子 $K$ 的意义下）二次多项式为\n$$\nW(e^{j\\omega})=K\\left(\\cos\\omega-\\cos\\omega_{1}\\right)\\left(\\cos\\omega-\\cos\\omega_{2}\\right)=K\\,\\cos\\omega\\left(\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right).\n$$\n主瓣由 $\\omega=\\pm\\frac{\\pi}{2}$ 处的第一个零点界定。其峰值电平在 $\\omega=0$ 处：\n$$\n|W(e^{j\\cdot 0})|=|K|\\left(\\cos 0\\right)\\left(\\cos 0+\\frac{\\sqrt{2}}{2}\\right)=|K|\\left(1+\\frac{\\sqrt{2}}{2}\\right).\n$$\n在主瓣之外，考虑\n$$\nf(\\omega)=\\cos\\omega\\left(\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right),\n$$\n因此 $W(e^{j\\omega})=K f(\\omega)$。其导数为\n$$\n\\frac{d}{d\\omega}f(\\omega)=-\\sin\\omega\\left(2\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right).\n$$\n在 $\\omega\\in\\left[\\frac{\\pi}{2},\\pi\\right]$ 的区间内寻找最大值。驻点出现在 $\\sin\\omega=0$（即 $\\omega=\\pi$）或 $2\\cos\\omega+\\frac{\\sqrt{2}}{2}=0$（即 $\\cos\\omega=-\\frac{\\sqrt{2}}{4}$）。\n\n在 $\\cos\\omega=-\\frac{\\sqrt{2}}{4}$ 处，\n$$\nf=\\left(-\\frac{\\sqrt{2}}{4}\\right)\\left(-\\frac{\\sqrt{2}}{4}+\\frac{\\sqrt{2}}{2}\\right)=-\\frac{1}{8}.\n$$\n在 $\\omega=\\pi$ 处，\n$$\nf(\\pi)=\\cos\\pi\\left(\\cos\\pi+\\frac{\\sqrt{2}}{2}\\right)=(-1)\\left(-1+\\frac{\\sqrt{2}}{2}\\right)=1-\\frac{\\sqrt{2}}{2}.\n$$\n我们需要比较这两个地方的幅度：$|-\\frac{1}{8}| = \\frac{1}{8} = 0.125$ 和 $|1-\\frac{\\sqrt{2}}{2}| \\approx 1-0.7071 = 0.2929$。显然，$1-\\frac{\\sqrt{2}}{2}$ 更大。因此峰值旁瓣电平为\n$$\n\\text{PSL}=|K|\\left(1-\\frac{\\sqrt{2}}{2}\\right).\n$$\n峰值主瓣电平为\n$$\n\\text{PML}=|K|\\left(1+\\frac{\\sqrt{2}}{2}\\right).\n$$\n因此所求的比率为\n$$\nR=\\frac{\\text{PSL}}{\\text{PML}}=\\frac{1-\\frac{\\sqrt{2}}{2}}{1+\\frac{\\sqrt{2}}{2}}=\\frac{2-\\sqrt{2}}{2+\\sqrt{2}}=\\frac{(2-\\sqrt{2})(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\frac{4-4\\sqrt{2}+2}{4-2} = \\frac{6-4\\sqrt{2}}{2} = 3-2\\sqrt{2}.\n$$\n数值上，$R\\approx 3-2(1.41421356) = 3 - 2.82842712 = 0.17157288\\ldots$，四舍五入到四位有效数字为 $0.1716$。", "answer": "$$\\boxed{0.1716}$$", "id": "1736389"}]}