{"hands_on_practices": [{"introduction": "我们从一个思想实验开始：如果我们在进行双线性变换时，忽略其非线性的频率映射关系，会发生什么？这个练习将量化一个常见但错误的简化操作所带来的误差，从而强调频率预畸变并非一个可选项，而是滤波器设计过程中的关键一步。通过计算，你将清楚地看到期望的滤波器性能与实际结果之间的偏差。[@problem_id:1720719]", "problem": "在数字滤波器设计中，双线性变换是一种将模拟滤波器设计转换为数字滤波器设计的常用方法。该变换将复s平面的整个$j\\Omega$轴映射到z平面的单位圆$z = e^{j\\omega}$上，但这种映射是非线性的。模拟频率$\\Omega$（单位：rad/s）与数字频率$\\omega$（单位：rad/sample）之间的关系由$\\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)$给出，其中$T$是采样周期，单位为秒。为了补偿这种非线性，通常使用一种称为频率预畸变的技术。\n\n一位工程师正在基于一个传递函数为$H_a(s) = \\frac{\\Omega_c}{s + \\Omega_c}$的模拟原型设计一个一阶数字低通滤波器，其中$\\Omega_c$是模拟截止频率。设计规范要求最终的数字滤波器在期望的数字频率$\\omega_d$处具有3-dB截止频率。3-dB截止频率是指滤波器幅度响应为其直流增益的$1/\\sqrt{2}$倍时的频率；对于给定的$H_a(s)$，这恰好发生在频率$\\Omega = \\Omega_c$处。\n\n然而，该工程师忽略了应用频率预畸变。相反，他犯了一个常见的错误，即假设频率值之间存在直接对应关系。他将原型滤波器中的模拟截止频率$\\Omega_c$设置为在数值上等于期望的数字截止频率$\\omega_d$。\n\n给定期望的数字截止频率$\\omega_d = 0.2\\pi$ 弧度/样本和采样周期 $T = 0.5$ 秒，这个错误导致实际的数字截止频率$\\omega_a$与期望的$\\omega_d$不同。计算截止频率的相对误差，定义为$\\epsilon = \\frac{\\omega_a - \\omega_d}{\\omega_d}$。\n\n将相对误差$\\epsilon$的答案以十进制形式表示，并四舍五入到三位有效数字。", "solution": "双线性变换通过以下关系映射模拟频率和数字频率：\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right),\n$$\n因此，给定的模拟频率$\\Omega$对应的数字频率为\n$$\n\\omega=2\\,\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right).\n$$\n对于一阶模拟低通原型$H_{a}(s)=\\frac{\\Omega_{c}}{s+\\Omega_{c}}$，其3-dB截止频率发生在$\\Omega=\\Omega_{c}$处。在没有进行频率预畸变的情况下，工程师设置$\\Omega_{c}=\\omega_{d}$。因此，经过双线性变换后，实际的数字截止频率为\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\Omega_{c}T}{2}\\right)=2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right).\n$$\n相对误差定义为\n$$\n\\epsilon=\\frac{\\omega_{a}-\\omega_{d}}{\\omega_{d}}=\\frac{2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right)-\\omega_{d}}{\\omega_{d}}.\n$$\n当$\\omega_{d}=0.2\\pi=\\frac{\\pi}{5}$且$T=0.5$时，我们有\n$$\n\\frac{\\omega_{d}T}{2}=\\frac{\\left(\\frac{\\pi}{5}\\right)\\left(\\frac{1}{2}\\right)}{2}=\\frac{\\pi}{20},\n$$\n所以\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right),\\quad\n\\epsilon=\\frac{2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-\\frac{\\pi}{5}}{\\frac{\\pi}{5}}=\\frac{10}{\\pi}\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-1.\n$$\n进行数值计算，\n$$\n\\arctan\\!\\left(\\frac{\\pi}{20}\\right)\\approx 0.1558065,\\quad \\omega_{a}\\approx 0.311613,\n$$\n并且$\\omega_{d}=\\frac{\\pi}{5}\\approx 0.628319$，\n$$\n\\epsilon=\\frac{0.311613-0.628319}{0.628319}\\approx -0.504.\n$$\n四舍五入到三位有效数字，相对误差为$-0.504$。", "answer": "$$\\boxed{-0.504}$$", "id": "1720719"}, {"introduction": "现在我们理解了频率预畸变的必要性，让我们来学习其核心计算方法。这个练习将引导你完成一个标准流程：为了在数字滤波器中实现一个精确的截止频率，如何确定其对应的模拟原型滤波器所需具备的频率。这是有效运用双线性变换设计数字滤波器的基本功。[@problem_id:1720731]", "problem": "一位信号处理工程师的任务是为高保真音频系统设计一个数字低通滤波器。设计方法包括使用双线性变换将一个特性良好的连续时间（模拟）滤波器原型转换为离散时间（数字）滤波器。该音频系统的采样频率 $F_s$ 为 $20.0 \\text{ kHz}$。\n\n主要的设计指标是，最终的数字滤波器的截止频率（通常是-3 dB衰减点）必须精确地位于系统奈奎斯特频率的一半。已知双线性变换在从连续时间域映射到离散时间域时，会对频率轴产生非线性压缩或“畸变”。为了抵消这种效应并达到所需的数字截止频率，必须对模拟原型的截止频率进行适当的预调整，这种技术被称为频率预畸变。\n\n计算模拟滤波器原型所需的预畸变截止频率。将您的答案以千赫兹（kHz）为单位表示，并四舍五入到三位有效数字。", "solution": "双线性变换将连续时间角频率 $\\Omega$（单位：弧度/秒）映射到离散时间角频率 $\\omega$（单位：弧度/采样点），其关系式为\n$$\n\\omega=2\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right),\n$$\n其中 $T=\\frac{1}{F_{s}}$ 是采样周期。为了将一个期望的数字截止频率预畸变为一个模拟原型截止频率，求解 $\\Omega$：\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\n设计指标要求数字截止频率为奈奎斯特频率的一半。奈奎斯特频率为 $\\frac{F_{s}}{2}$，因此期望的数字截止频率（以赫兹为单位）是 $f_{d}=\\frac{F_{s}}{4}$。相应的离散时间角频率是\n$$\n\\omega_{c}=\\frac{2\\pi f_{d}}{F_{s}}=\\frac{2\\pi}{F_{s}}\\cdot\\frac{F_{s}}{4}=\\frac{\\pi}{2}.\n$$\n因此，预畸变的模拟角截止频率为\n$$\n\\Omega_{p}=2F_{s}\\tan\\!\\left(\\frac{\\omega_{c}}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\pi}{4}\\right)=2F_{s}.\n$$\n转换为赫兹，$f_{p}=\\frac{\\Omega_{p}}{2\\pi}$，得到\n$$\nf_{p}=\\frac{2F_{s}}{2\\pi}=\\frac{F_{s}}{\\pi}.\n$$\n当 $F_{s}=20.0\\ \\text{kHz}$ 时，这变为\n$$\nf_{p}=\\frac{20.0}{\\pi}\\ \\text{kHz}\\approx 6.366\\ \\text{kHz}.\n$$\n四舍五入到三位有效数字得到 $6.37\\ \\text{kHz}$。", "answer": "$$\\boxed{6.37}$$", "id": "1720731"}, {"introduction": "频率预畸变的原理不仅限于简单的低通或高通滤波器。最后一个练习将此概念应用于一个由两个临界频率定义的带通滤波器。你将发现，不仅单个频率点需要预畸变，整个滤波器的带宽也受到非线性映射的影响，这进一步强调了在设计中对每一个临界频率进行校正的重要性。[@problem_id:1720737]", "problem": "一位音频工程师的任务是设计一个数字无限冲激响应（IIR）滤波器，以分离一段音乐录音中的特定频率范围。该设计将使用双线性变换方法实现，该方法将一个连续时间（模拟）滤波器原型映射到一个离散时间（数字）滤波器。该数字滤波器要求有一个通带，其下限截止频率为 $f_{d1} = 6.00$ kHz，上限截止频率为 $f_{d2} = 12.0$ kHz。音频系统的采样频率为 $f_s = 48.0$ kHz。\n\n为了确保最终数字滤波器的截止频率正确，模拟原型滤波器的相应截止频率必须在设计前进行“预畸变”(prewarped)。计算这个经过预畸变的模拟原型滤波器所需的带宽。答案以千赫兹（kHz）为单位表示，并四舍五入到三位有效数字。", "solution": "对于双线性变换，模拟角频率 $\\Omega$ 和数字角频率 $\\omega$ 之间的关系是\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right), \\quad T=\\frac{1}{f_{s}}.\n$$\n转换为赫兹，$F=\\frac{\\Omega}{2\\pi}$，并使用 $\\omega=2\\pi \\frac{f_{d}}{f_{s}}$，与数字频率 $f_{d}$ 对应的预畸变模拟频率为\n$$\nF=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d}}{f_{s}}\\right).\n$$\n因此，预畸变的模拟通带边缘频率为\n$$\nF_{1}=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d1}}{f_{s}}\\right), \\quad F_{2}=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d2}}{f_{s}}\\right),\n$$\n所需的模拟带宽为\n$$\nB=F_{2}-F_{1}=\\frac{f_{s}}{\\pi}\\left[\\tan\\!\\left(\\pi\\frac{f_{d2}}{f_{s}}\\right)-\\tan\\!\\left(\\pi\\frac{f_{d1}}{f_{s}}\\right)\\right].\n$$\n当 $f_{s}=48.0\\ \\text{kHz}$，$f_{d1}=6.00\\ \\text{kHz}$ 且 $f_{d2}=12.0\\ \\text{kHz}$ 时，\n$$\n\\pi\\frac{f_{d1}}{f_{s}}=\\frac{\\pi}{8}, \\quad \\pi\\frac{f_{d2}}{f_{s}}=\\frac{\\pi}{4},\n$$\n于是 $\\tan(\\pi/4)=1$ 且 $\\tan(\\pi/8)=\\sqrt{2}-1$。因此，\n$$\nB=\\frac{48}{\\pi}\\left[1-(\\sqrt{2}-1)\\right]\\ \\text{kHz}=\\frac{48}{\\pi}(2-\\sqrt{2})\\ \\text{kHz}.\n$$\n数值计算结果为，\n$$\nB\\approx \\frac{48}{\\pi}\\times 0.5857864376\\ \\text{kHz}\\approx 8.95016013\\ \\text{kHz},\n$$\n四舍五入到三位有效数字为 $8.95\\ \\text{kHz}$。", "answer": "$$\\boxed{8.95}$$", "id": "1720737"}]}