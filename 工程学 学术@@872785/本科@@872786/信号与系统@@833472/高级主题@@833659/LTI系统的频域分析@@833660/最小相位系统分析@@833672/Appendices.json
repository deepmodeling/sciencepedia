{"hands_on_practices": [{"introduction": "分析最小相位系统的第一步，是从其数学描述中识别其基本特性。在数字信号处理中，系统通常由差分方程定义。本练习将指导你完成一个核心任务：从一个给定的差分方程出发，推导出系统的传递函数，并通过分析其零点和极点的位置，来判断该系统是否为最小相位系统 [@problem_id:1697748]。这个过程是评估和设计数字滤波器（如此处提到的音频均衡器）的基础。", "problem": "一个用于数字音频均衡滤波器的因果线性时不变 (LTI) 系统，由以下差分方程描述，该方程关联了输入信号 $x[n]$ 与输出信号 $y[n]$：\n\n$$y[n] - y[n-1] + \\frac{1}{2}y[n-2] = x[n] + \\frac{5}{2}x[n-1] + x[n-2]$$\n\n如果一个系统是因果且稳定的，并且其逆系统也是因果且稳定的，则该系统被定义为最小相位系统。此性质等价于系统的传递函数的所有极点和所有零点都严格位于z平面的单位圆内。\n\n下列哪个陈述准确地描述了这个LTI系统？\n\nA. 该系统是最小相位的。\n\nB. 该系统不是最小相位的，因为它有一个极点在单位圆外。\n\nC. 该系统不是最小相位的，因为它有一个零点在单位圆外。\n\nD. 该系统是不稳定的。\n\nE. 该系统是一个全通系统。", "solution": "我们从给定的因果LTI差分方程开始：\n$$y[n] - y[n-1] + \\frac{1}{2}y[n-2] = x[n] + \\frac{5}{2}x[n-1] + x[n-2].$$\n在初始静止条件下，进行单边或双边 $z$ 变换，并利用线性和时移性质，得到\n$$Y(z) - z^{-1}Y(z) + \\frac{1}{2}z^{-2}Y(z) = X(z) + \\frac{5}{2}z^{-1}X(z) + z^{-2}X(z).$$\n整理后得到传递函数\n$$H(z) \\triangleq \\frac{Y(z)}{X(z)} = \\frac{1 + \\frac{5}{2}z^{-1} + z^{-2}}{1 - z^{-1} + \\frac{1}{2}z^{-2}}.$$\n将分子和分母同乘以 $z^{2}$，得到关于 $z$ 的多项式，\n$$H(z) = \\frac{z^{2} + \\frac{5}{2}z + 1}{z^{2} - z + \\frac{1}{2}}.$$\n\n零点是分子 $z^{2} + \\frac{5}{2}z + 1 = 0$ 的根。使用二次求根公式，\n$$\\Delta_{N} = \\left(\\frac{5}{2}\\right)^{2} - 4\\cdot 1 \\cdot 1 = \\frac{25}{4} - 4 = \\frac{9}{4}, \\quad \\sqrt{\\Delta_{N}} = \\frac{3}{2},$$\n$$z = \\frac{-\\frac{5}{2} \\pm \\frac{3}{2}}{2}.$$\n因此零点是\n$$z_{z1} = \\frac{-\\frac{5}{2} + \\frac{3}{2}}{2} = -\\frac{1}{2}, \\qquad z_{z2} = \\frac{-\\frac{5}{2} - \\frac{3}{2}}{2} = -2.$$\n它们的模分别为 $|-\\frac{1}{2}| = \\frac{1}{2}  1$ 和 $|-2| = 2 > 1$，所以有一个零点在单位圆外。\n\n极点是分母 $z^{2} - z + \\frac{1}{2} = 0$ 的根。同样使用二次求根公式，\n$$\\Delta_{D} = (-1)^{2} - 4\\cdot 1 \\cdot \\frac{1}{2} = 1 - 2 = -1,$$\n$$z = \\frac{1 \\pm \\sqrt{-1}}{2} = \\frac{1 \\pm \\mathrm{i}}{2}.$$\n每个极点的模是\n$$\\left|\\frac{1 \\pm \\mathrm{i}}{2}\\right| = \\frac{\\sqrt{1^{2} + 1^{2}}}{2} = \\frac{\\sqrt{2}}{2} = \\frac{1}{\\sqrt{2}}  1,$$\n所以两个极点都严格位于单位圆内，这意味着对于这个因果系统，它是BIBO稳定的。\n\n因此，该系统是因果且稳定的，但它不是最小相位的，因为它有一个零点在单位圆外。它也不是全通系统，因为其分子不是分母的共轭反转版本（在常数因子内），且其幅频响应并非对所有频率都为单位一。因此，正确的陈述是该系统不是最小相位的，因为它有一个零点在单位圆外。", "answer": "$$\\boxed{C}$$", "id": "1697748"}, {"introduction": "在实际应用中，非最小相位系统可能引入不必要的延迟或伪影，例如音频处理中的“前回声”。幸运的是，我们可以为任何一个非最小相位系统构建一个具有完全相同幅度响应的最小相位等效系统。这个练习 [@problem_id:1697806] 是一个建设性的实践，它将教你如何通过“翻转”单位圆外的零点来设计一个全新的最小相位FIR滤波器，从而在保持所需频率特性的同时优化其相位（或延迟）特性。", "problem": "在数字音频处理中，最小相位滤波器通常是首选，因为它在给定幅度响应的情况下表现出最小可能的群延迟，这有助于避免可感知的前回声伪影。一个非最小相位滤波器可以被系统地转换成一个等效的最小相位滤波器，该等效滤波器保留了原滤波器的幅度频率响应。\n\n考虑一个由有限脉冲响应 (FIR) 滤波器描述的因果、线性时不变系统。该滤波器的 z 域传递函数 $H(z)$ 由下式给出：\n$$ H(z) = 1 - 1.75z^{-1} - 0.625z^{-2} + 0.25z^{-3} $$\n你的任务是找到一个新的因果且稳定的最小相位 FIR 滤波器的传递函数 $H_{mp}(z)$，其幅度响应 $|H_{mp}(e^{j\\omega})|$ 与原滤波器的幅度响应 $|H(e^{j\\omega})|$ 相同。\n\n提供这个新的最小相位滤波器的脉冲响应 $h_{mp}[n]$ 的系数序列。系数应以数字列表的形式呈现 $[h_{mp}[0], h_{mp}[1], h_{mp}[2], h_{mp}[3]]$。", "solution": "我们已知 FIR 传递函数为\n$$H(z)=1-1.75z^{-1}-0.625z^{-2}+0.25z^{-3}.$$\n$H(z)$ 的零点可以通过求解 $P(z)=0$ 得到，其中 $P(z)=z^{3}-1.75z^{2}-0.625z+0.25$。两边乘以 $8$ 以消去分数，得到\n$$8P(z)=8z^{3}-14z^{2}-5z+2.$$\n根据有理根定理，测试 $z=2$ 得到 $8\\cdot 8-14\\cdot 4-5\\cdot 2+2=64-56-10+2=0$，所以 $z=2$ 是一个根。多项式除法得到\n$$8z^{3}-14z^{2}-5z+2=(z-2)\\left(8z^{2}+2z-1\\right).$$\n使用二次方程求根公式求解二次因子 $8z^{2}+2z-1=0$ 得到\n$$z=\\frac{-2\\pm\\sqrt{4+32}}{16}=\\frac{-2\\pm 6}{16},$$\n因此剩下的根是 $z=\\frac{1}{4}$ 和 $z=-\\frac{1}{2}$。所以，$H(z)$ 的零点是 $\\{2,\\frac{1}{4},-\\frac{1}{2}\\}$，我们可以将其因式分解为\n$$H(z)=(1-2z^{-1})\\left(1-\\frac{1}{4}z^{-1}\\right)\\left(1+\\frac{1}{2}z^{-1}\\right).$$\n\n为了得到一个具有相同幅度响应的最小相位滤波器，需要将单位圆外的任何零点反射到其位于单位圆内的共轭倒数位置，并通过乘以每个被反射零点的模来缩放增益，以保持 $|H(e^{j\\omega})|$ 不变。具体来说，对于 $|z|=1$ 和一个零点 $z_{0}$，\n$$|1-z_{0}z^{-1}|=|z-z_{0}|,\\quad |1-z_{0}'z^{-1}|=|z-z_{0}'|,\\quad z_{0}'=\\frac{1}{z_{0}^{*}},$$\n我们有\n$$|z-z_{0}'|=\\frac{1}{|z_{0}|}\\,|z-z_{0}|.$$\n因此，用 $z_{0}'$ 替换 $z_{0}$ 会使幅度因子减小 $\\frac{1}{|z_{0}|}$，这可以通过将整个滤波器乘以 $|z_{0}|$ 来补偿。\n\n在这里，只有零点 $z=2$ 位于单位圆外。将其反射到 $z=\\frac{1}{2}$，并乘以增益因子 $2$。其他零点保持不变。因此，\n$$H_{mp}(z)=2\\left(1-\\frac{1}{2}z^{-1}\\right)\\left(1-\\frac{1}{4}z^{-1}\\right)\\left(1+\\frac{1}{2}z^{-1}\\right).$$\n\n现在展开以获得脉冲响应系数。首先将前两个因子相乘：\n$$(1-\\tfrac{1}{2}z^{-1})\\left(1-\\tfrac{1}{4}z^{-1}\\right)=1-\\tfrac{3}{4}z^{-1}+\\tfrac{1}{8}z^{-2}.$$\n然后乘以第三个因子：\n$$(1-\\tfrac{3}{4}z^{-1}+\\tfrac{1}{8}z^{-2})\\left(1+\\tfrac{1}{2}z^{-1}\\right)=1-\\tfrac{1}{4}z^{-1}-\\tfrac{1}{4}z^{-2}+\\tfrac{1}{16}z^{-3}.$$\n最后，应用增益因子 $2$：\n$$H_{mp}(z)=2-\\tfrac{1}{2}z^{-1}-\\tfrac{1}{2}z^{-2}+\\tfrac{1}{8}z^{-3}.$$\n\n因此，最小相位 FIR 脉冲响应为\n$$h_{mp}[0]=2,\\quad h_{mp}[1]=-\\frac{1}{2},\\quad h_{mp}[2]=-\\frac{1}{2},\\quad h_{mp}[3]=\\frac{1}{8}.$$", "answer": "$$\\boxed{\\begin{pmatrix} 2  -\\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{8} \\end{pmatrix}}$$", "id": "1697806"}, {"introduction": "一个给定的幅频响应可以对应多个不同的系统，其中只有一个是最小相位的。这些系统共同构成一个“家族”，它们之间的差异仅在于相位响应。这个深刻的联系可以通过全通滤波器来揭示。本练习 [@problem_id:1697809] 将让你逆向操作，从一个已知的最小相位系统出发，通过乘以一个特定的全通滤波器，来构造一个具有相同幅频响应的非最小相位系统。这有助于你巩固对幅度和相位之间关系的理解，并认识到全通滤波器在塑造系统相位中的关键作用。", "problem": "一个稳定且因果的离散时间线性时不变（LTI）系统，其特征为实数值的脉冲响应，由传递函数 $H_{mp}(z)$ 描述。已知该系统是最小相位系统，其传递函数为：\n$$H_{mp}(z) = \\frac{1 - 0.4z^{-1}}{1 - 0.8z^{-1}}$$\n第二个LTI系统，由传递函数 $H_{nmp}(z)$ 描述，也是稳定且因果的，但为非最小相位系统。构建第二个系统，使其频率响应的幅值与第一个系统相同，即对所有频率 $\\omega$，都有 $|H_{nmp}(e^{j\\omega})| = |H_{mp}(e^{j\\omega})|$。\n\n假设 $H_{nmp}(z)$ 是通过将 $H_{mp}(z)$ 的单个零点反射到单位圆外的共轭倒数位置而形成的唯一系统，求出传递函数 $H_{nmp}(z)$。将您的答案表示为关于 $z^{-1}$ 的有理函数。", "solution": "给定的最小相位传递函数为\n$$H_{mp}(z)=\\frac{1-0.4z^{-1}}{1-0.8z^{-1}}.$$\n它的单个零点位于 $z=0.4$，极点位于 $z=0.8$，两者都在单位圆内，这与最小相位和稳定性是一致的。\n\n为了获得具有相同幅值响应的非最小相位系统，我们将 $H_{mp}(z)$ 乘以一个一阶全通节，该全通节将单位圆内 $z=a$ 处的零点反射到单位圆外的共轭倒数位置 $z=\\frac{1}{a^{*}}$。对于一个实零点 $a$，相应的全通节为\n$$A(z)=\\frac{z^{-1}-a}{1-az^{-1}},$$\n它在 $z=\\frac{1}{a}$ 处有一个零点，在 $z=a$ 处有一个极点。在单位圆上，令 $z=e^{j\\omega}$，因此 $z^{*}=z^{-1}$。那么\n$$|A(e^{j\\omega})|^{2}=\\frac{(z^{-1}-a)(z-a)}{(1-az^{-1})(1-az)}=\\frac{1-az^{-1}-az+a^{2}}{1-az^{-1}-az+a^{2}}=1,$$\n所以对所有 $\\omega$，都有 $|A(e^{j\\omega})|=1$。\n\n因此，定义\n$$H_{nmp}(z)=H_{mp}(z)A(z)$$\n保证了对所有 $\\omega$，都有 $|H_{nmp}(e^{j\\omega})|=|H_{mp}(e^{j\\omega})|$，并且将 $z=a$ 处的零点替换为 $z=\\frac{1}{a}$ 处的零点。取 $a=0.4$ 和 $p=0.8$，我们得到\n$$H_{nmp}(z)=\\frac{1-0.4z^{-1}}{1-0.8z^{-1}}\\cdot\\frac{z^{-1}-0.4}{1-0.4z^{-1}}=\\frac{z^{-1}-0.4}{1-0.8z^{-1}}.$$\n该系统在 $z=0.8$ 处有一个极点（单位圆内），在 $z=\\frac{1}{0.4}=2.5$ 处有一个零点（单位圆外），这使其成为因果、稳定且非最小相位的系统，并具有与 $H_{mp}(z)$ 相同的幅值响应。", "answer": "$$\\boxed{\\frac{z^{-1}-0.4}{1-0.8z^{-1}}}$$", "id": "1697809"}]}