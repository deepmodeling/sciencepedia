{"hands_on_practices": [{"introduction": "插值是数字信号处理中一个核心操作，它能提高信号的采样率。这个过程通常分为两步：首先通过“升采样”在原始信号的采样点之间插入零值，然后用一个低通滤波器平滑信号并抑制频谱中的“镜像”。本练习将带你完整地走一遍这个流程，通过一个简单的移动平均滤波器来具体感受插值是如何“填补”这些零值，从而重建出更平滑的信号的。[@problem_id:1728378]", "problem": "在数字信号处理中，插值是提高信号采样率的过程。对于一个整数插值因子 $L$，这通常分两个阶段实现。首先，通过在原始离散时间信号 $x[n]$ 的每两个连续采样点之间插入 $L-1$ 个零来创建一个中间信号 $w[n]$。这个操作称为上采样。然后将所得信号通过一个冲激响应为 $h[n]$ 的低通抗镜像滤波器，以生成最终的输出信号 $y[n]$。\n\n考虑一个有限长度的输入信号，定义为 $x[0]=2$，$x[1]=4$，$x[2]=0$，$x[3]=-2$，且对于所有其他整数 $n$，$x[n]=0$。该信号将以因子 $L=2$ 进行插值。\n\n抗镜像滤波器是一个简单的两点移动平均滤波器，其冲激响应由 $h[n] = 0.5(\\delta[n] + \\delta[n-1])$ 给出，其中 $\\delta[n]$ 是克罗内克δ函数。\n\n计算最终输出序列 $y[n]$ 中所有采样值的总和。即，求 $S = \\sum_{n=-\\infty}^{\\infty} y[n]$ 的值。", "solution": "题目要求计算插值过程输出信号 $y[n]$ 的所有采样点之和。该过程包括两个步骤：将输入信号 $x[n]$ 以因子 $L=2$ 进行上采样得到中间信号 $w[n]$，然后用抗镜像滤波器 $h[n]$ 对 $w[n]$ 进行滤波得到输出 $y[n]$。\n\n**步骤1：定义输入信号和插值因子。**\n输入信号为一个有限序列：\n$x[n] = \\{..., 0, \\underset{\\uparrow}{2}, 4, 0, -2, 0, ...\\}$\n其中箭头指示 $n=0$ 处的采样点。具体来说，$x[0]=2$，$x[1]=4$，$x[2]=0$，$x[3]=-2$，且对于 $n0$ 和 $n3$，$x[n]=0$。\n插值因子为 $L=2$。\n\n**步骤2：执行上采样操作。**\n上采样操作通过在 $x[n]$ 的每两个采样点之间插入 $L-1 = 2-1 = 1$ 个零来创建中间信号 $w[n]$。关系式为 $w[nL] = x[n]$，且当 $k$ 不是 $L$ 的倍数时 $w[k]=0$。\n对于 $L=2$，$w[2n] = x[n]$ 且 $w[2n+1]=0$。\n\n我们来列出 $w[n]$ 的非零值：\n$w[0] = x[0] = 2$\n$w[2] = x[1] = 4$\n$w[4] = x[2] = 0$\n$w[6] = x[3] = -2$\n\n得到的上采样序列 $w[n]$ 为：\n$w[n] = \\{..., 0, \\underset{\\uparrow}{2}, 0, 4, 0, 0, 0, -2, 0, ...\\}$\n具体的序列是 $w[0]=2, w[1]=0, w[2]=4, w[3]=0, w[4]=0, w[5]=0, w[6]=-2, w[7]=0$，且对于所有其他 $n$，$w[n]=0$。\n\n**步骤3：定义滤波器并执行卷积。**\n输出信号 $y[n]$ 是上采样信号 $w[n]$ 和滤波器冲激响应 $h[n]$ 的卷积。\n$y[n] = w[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} h[k] w[n-k]$\n\n冲激响应由 $h[n] = 0.5\\delta[n] + 0.5\\delta[n-1]$ 给出。这意味着 $h[0]=0.5$，$h[1]=0.5$，且对于所有其他 $n$，$h[n]=0$。\n\n卷积和简化为：\n$y[n] = h[0]w[n-0] + h[1]w[n-1]$\n$y[n] = 0.5w[n] + 0.5w[n-1]$\n\n**步骤4：计算输出序列 $y[n]$ 的采样点。**\n现在我们可以计算在每个 $n$ 值处 $y[n]$ 的值，其中输出可能非零。$w[n]$ 的非零部分是从 $n=0$ 到 $n=7$。$h[n]$ 的非零部分是从 $n=0$ 到 $n=1$。输出卷积序列的长度为 $N_w + N_h - 1 = 8 + 2 - 1 = 9$。因此，我们预计非零值将从 $n=0$ 到 $n=8$。\n\n$y[0] = 0.5w[0] + 0.5w[-1] = 0.5(2) + 0.5(0) = 1$\n$y[1] = 0.5w[1] + 0.5w[0] = 0.5(0) + 0.5(2) = 1$\n$y[2] = 0.5w[2] + 0.5w[1] = 0.5(4) + 0.5(0) = 2$\n$y[3] = 0.5w[3] + 0.5w[2] = 0.5(0) + 0.5(4) = 2$\n$y[4] = 0.5w[4] + 0.5w[3] = 0.5(0) + 0.5(0) = 0$\n$y[5] = 0.5w[5] + 0.5w[4] = 0.5(0) + 0.5(0) = 0$\n$y[6] = 0.5w[6] + 0.5w[5] = 0.5(-2) + 0.5(0) = -1$\n$y[7] = 0.5w[7] + 0.5w[6] = 0.5(0) + 0.5(-2) = -1$\n$y[8] = 0.5w[8] + 0.5w[7] = 0.5(0) + 0.5(0) = 0$\n\n对于 $n  8$，$y[n]$ 也将为零。\n完整的输出序列是 $y[n] = \\{..., 0, \\underset{\\uparrow}{1}, 1, 2, 2, 0, 0, -1, -1, 0, ...\\}$。\n\n**步骤5：计算所有采样点的总和。**\n问题要求计算总和 $S = \\sum_{n=-\\infty}^{\\infty} y[n]$。\n$S = y[0] + y[1] + y[2] + y[3] + y[4] + y[5] + y[6] + y[7]$\n$S = 1 + 1 + 2 + 2 + 0 + 0 + (-1) + (-1) = 4$\n\n**替代方法（使用离散时间傅里叶变换的性质）：**\n一个序列的采样点之和等于其在频率 $\\omega=0$ 处的离散时间傅里叶变换（DTFT）的值。\n$S = \\sum_{n=-\\infty}^{\\infty} y[n] = Y(e^{j0})$，其中 $Y(e^{j\\omega})$ 是 $y[n]$ 的DTFT。\n\n由于 $y[n] = w[n] * h[n]$，它们的DTFT通过 $Y(e^{j\\omega}) = W(e^{j\\omega}) H(e^{j\\omega})$ 相关联。\n因此，$S = W(e^{j0}) H(e^{j0})$。\n\n我们来计算 $H(e^{j0})$ 和 $W(e^{j0})$。\n$H(e^{j\\omega}) = \\sum_n h[n] e^{-j\\omega n} = 0.5 e^{-j\\omega(0)} + 0.5 e^{-j\\omega(1)} = 0.5(1 + e^{-j\\omega})$。\n$H(e^{j0}) = 0.5(1+e^0) = 0.5(1+1) = 1$。\n\n上采样信号 $w[n]$ 的DTFT与原始信号 $x[n]$ 的DTFT之间的关系为 $W(e^{j\\omega}) = X(e^{jL\\omega})$。对于 $L=2$，$W(e^{j\\omega}) = X(e^{j2\\omega})$。\n$W(e^{j0}) = X(e^{j0})$。\n\n$X(e^{j0})$ 的值是原始信号 $x[n]$ 的采样点之和：\n$X(e^{j0}) = \\sum_{n=-\\infty}^{\\infty} x[n] = 2 + 4 + 0 + (-2) = 4$。\n\n所以，$W(e^{j0}) = 4$。\n\n最后，总和 $S$ 是：\n$S = W(e^{j0}) H(e^{j0}) = (4) \\times (1) = 4$。\n\n两种方法得到相同的结果。", "answer": "$$\\boxed{4}$$", "id": "1728378"}, {"introduction": "理论上，理想的插值器使用 sinc 函数，它可以完美地从采样点中重建出带限信号。然而，当原始信号包含跳变等不连续点时，即使是理想插值也会引入被称为吉布斯现象的振铃伪影。本练习通过一个阶跃信号的例子，让你亲手计算这种伪影中最显著的下冲值，从而深刻理解理想滤波器在现实信号面前的局限性。[@problem_id:1728127]", "problem": "一个连续时间信号 $x(t)$ 由一个发生在采样时刻之间的阶跃不连续点定义。具体来说，该信号由 $x(t) = 0$（当 $t  T_s/2$ 时）和 $x(t) = 1$（当 $t \\ge T_s/2$ 时）给出，其中 $T_s$ 是一个代表采样周期的正常数。\n\n该信号在 $T_s$ 的整数倍时刻进行采样，生成一个离散时间序列 $x[n] = x(nT_s)$，其中 $n$ 为所有整数。\n\n然后，使用理想的 Whittaker-Shannon-Kotelnikov 插值公式从这些样本中重建一个新的连续时间信号 $x_r(t)$：\n$$x_r(t) = \\sum_{n=-\\infty}^{\\infty} x[n] \\operatorname{sinc}\\left(\\frac{t - nT_s}{T_s}\\right)$$\nsinc 函数定义为 $\\operatorname{sinc}(u) = \\frac{\\sin(\\pi u)}{\\pi u}$（当 $u \\neq 0$ 时）和 $\\operatorname{sinc}(0) = 1$。\n\n这个重建过程等效于理想低通滤波，它会在不连续点附近引入振铃伪影。计算重建信号最显著的下冲值，该下冲发生在时刻 $t = -T_s/2$。\n\n在计算中，你可以使用已知的 Gregory-Leibniz 级数值：\n$$\\sum_{k=0}^{\\infty} \\frac{(-1)^k}{2k+1} = 1 - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\dots = \\frac{\\pi}{4}$$\n\n将你的答案表示为一个数值，并四舍五入到四位有效数字。", "solution": "问题要求计算重建信号 $x_r(t)$ 在特定时刻 $t = -T_s/2$ 的值。\n\n首先，我们必须确定离散样本 $x[n]$ 的值。原始信号为 $x(t)=1$（当 $t \\ge T_s/2$ 时）和 $x(t)=0$（当 $t  T_s/2$ 时）。样本在 $t=nT_s$ 时刻采集。\n因此，$x[n] = x(nT_s)$。这意味着如果 $nT_s \\ge T_s/2$，$x[n]=1$，这可以简化为 $n \\ge 1/2$。由于 $n$ 必须是整数，该条件变为 $n \\ge 1$。对于所有其他整数，即 $n \\le 0$，我们有 $nT_s \\le 0  T_s/2$，所以 $x[n]=0$。\n总而言之，样本序列为：\n$$x[n] = \\begin{cases} 1  \\text{if } n \\ge 1 \\\\ 0  \\text{if } n \\le 0 \\end{cases}$$\n\n接下来，我们使用给定的插值公式来求 $t = -T_s/2$ 时的 $x_r(t)$。\n$$x_r(-T_s/2) = \\sum_{n=-\\infty}^{\\infty} x[n] \\operatorname{sinc}\\left(\\frac{-T_s/2 - nT_s}{T_s}\\right)$$\n由于当 $n \\le 0$ 时 $x[n]=0$，求和只需对 $n \\ge 1$ 的项进行计算。\n$$x_r(-T_s/2) = \\sum_{n=1}^{\\infty} (1) \\cdot \\operatorname{sinc}\\left(\\frac{-T_s/2 - nT_s}{T_s}\\right) = \\sum_{n=1}^{\\infty} \\operatorname{sinc}\\left(-\\frac{1}{2} - n\\right)$$\n\n现在我们展开 sinc 函数的定义，$\\operatorname{sinc}(u) = \\frac{\\sin(\\pi u)}{\\pi u}$：\n$$x_r(-T_s/2) = \\sum_{n=1}^{\\infty} \\frac{\\sin\\left(\\pi\\left(-\\frac{1}{2} - n\\right)\\right)}{\\pi\\left(-\\frac{1}{2} - n\\right)}$$\n\n我们来简化分子中的正弦项。\n$\\sin\\left(\\pi\\left(-\\frac{1}{2} - n\\right)\\right) = \\sin\\left(-\\frac{\\pi}{2} - n\\pi\\right)$。\n由于 $\\sin(x) = -\\sin(-x)$ 且 $\\sin(n\\pi + \\theta) = (-1)^n \\sin(\\theta)$，我们得到：\n$\\sin\\left(-\\frac{\\pi}{2} - n\\pi\\right) = -\\sin\\left(n\\pi + \\frac{\\pi}{2}\\right) = -(-1)^n \\sin\\left(\\frac{\\pi}{2}\\right) = -(-1)^n \\cdot 1 = -(-1)^n$。\n\n将此结果代回求和式中：\n$$x_r(-T_s/2) = \\sum_{n=1}^{\\infty} \\frac{-(-1)^n}{-\\pi\\left(n + \\frac{1}{2}\\right)} = \\frac{1}{\\pi} \\sum_{n=1}^{\\infty} \\frac{(-1)^n}{n + \\frac{1}{2}}$$\n\n我们写出级数的前几项：\n$$\\sum_{n=1}^{\\infty} \\frac{(-1)^n}{n + \\frac{1}{2}} = \\frac{-1}{1 + \\frac{1}{2}} + \\frac{1}{2 + \\frac{1}{2}} - \\frac{1}{3 + \\frac{1}{2}} + \\dots = \\frac{-1}{3/2} + \\frac{1}{5/2} - \\frac{1}{7/2} + \\dots$$\n$$= -\\frac{2}{3} + \\frac{2}{5} - \\frac{2}{7} + \\dots = -2\\left(\\frac{1}{3} - \\frac{1}{5} + \\frac{1}{7} - \\dots\\right)$$\n\n问题提供了 Gregory-Leibniz 级数：\n$$1 - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\dots = \\frac{\\pi}{4}$$\n我们可以重新整理这个式子，以求出我们需要的级数的值：\n$$\\frac{1}{3} - \\frac{1}{5} + \\frac{1}{7} - \\dots = 1 - \\frac{\\pi}{4}$$\n\n现在，将这个结果代回我们的求和表达式中：\n$$\\sum_{n=1}^{\\infty} \\frac{(-1)^n}{n + \\frac{1}{2}} = -2\\left(1 - \\frac{\\pi}{4}\\right) = -2 + \\frac{\\pi}{2}$$\n\n最后，我们可以计算 $x_r(-T_s/2)$ 的值：\n$$x_r(-T_s/2) = \\frac{1}{\\pi} \\left(-2 + \\frac{\\pi}{2}\\right) = -\\frac{2}{\\pi} + \\frac{1}{2}$$\n\n为了得到最终的数值答案，我们计算这个表达式的值：\n$$x_r(-T_s/2) = 0.5 - \\frac{2}{\\pi} \\approx 0.5 - \\frac{2}{3.14159265...} \\approx 0.5 - 0.63661977...$$\n$$x_r(-T_s/2) \\approx -0.13661977...$$\n\n四舍五入到四位有效数字，我们得到 $-0.1366$。", "answer": "$$\\boxed{-0.1366}$$", "id": "1728127"}, {"introduction": "插值的成功与否根本上取决于采样过程是否满足奈奎斯特采样定理。对于频率随时间变化的信号（例如啁啾信号），这意味着其“瞬时频率”必须始终低于采样率的一半。本练习模拟了一个频率逐渐升高的信号被采样和重建的过程，挑战你计算当信号频率超出奈奎斯特限制时，重建信号中出现的混叠伪影频率。[@problem_id:1728129]", "problem": "一个连续时间信号 $x_c(t)$ 由表达式 $x_c(t) = \\cos\\left(2\\pi \\left(f_0 t + \\frac{1}{2} \\alpha t^2\\right)\\right)$ 定义，其中时间 $t \\ge 0$。信号参数为起始频率 $f_0 = 400$ Hz 和恒定频率扫描率 $\\alpha = 250 \\text{ Hz/s}$。该信号以 $f_s = 1000$ Hz 的速率进行采样，生成一个离散时间序列 $x_d[n] = x_c(nT_s)$，其中 $T_s = 1/f_s$ 是采样周期。\n\n然后，尝试使用理想插值器从其样本中重构连续时间信号。该插值器用作一个理想的低通滤波器，其截止频率等于采样率的一半。设得到的重构信号记为 $\\hat{x}_c(t)$。\n\n由于信号频率内容的时变特性，当原始信号的频率特性违反理想重构条件时，重构信号 $\\hat{x}_c(t)$ 会表现出可听见的失真。确定在精确时刻 $t = 1.3$ s 时，重构信号 $\\hat{x}_c(t)$ 中这种失真的表观瞬时频率。\n\n答案以 Hz 为单位，并四舍五入到三位有效数字。", "solution": "给定的连续时间线性调频信号为\n$$\nx_{c}(t)=\\cos\\left(2\\pi\\left(f_{0}t+\\frac{1}{2}\\alpha t^{2}\\right)\\right),\\quad t\\ge 0.\n$$\n信号的瞬时频率 $f_i(t)$ 是相位对时间导数除以 $2\\pi$：\n$$\nf_i(t) = \\frac{1}{2\\pi} \\frac{d}{dt} \\left(2\\pi \\left(f_0 t + \\frac{1}{2} \\alpha t^2\\right)\\right) = f_0 + \\alpha t.\n$$\n给定参数 $f_0 = 400$ Hz，$\\alpha = 250$ Hz/s，以及采样率 $f_s = 1000$ Hz。奈奎斯特频率为 $f_s/2 = 500$ Hz。\n\n在时刻 $t = 1.3$ s，瞬时频率为：\n$$\nf_i(1.3) = 400 + 250(1.3) = 400 + 325 = 725 \\text{ Hz}.\n$$\n由于 $f_i(1.3) > f_s/2$，采样后的信号在该时刻会发生混叠。理想插值器是一个截止频率为 $f_s/2$ 的低通滤波器，它会将混叠后的频率分量重构出来。\n\n表观瞬时频率 $f_{app}(t)$ 是原始频率 $f_i(t)$ 折叠到基带 $[0, f_s/2]$ 的结果。当 $f_s/2  f_i(t) \\le f_s$ 时，表观频率为 $f_{app}(t) = f_s - f_i(t)$。\n在我们的例子中，$500 \\text{ Hz}  725 \\text{ Hz} \\le 1000 \\text{ Hz}$，所以：\n$$\nf_{app}(1.3) = 1000 - 725 = 275 \\text{ Hz}.\n$$\n这个频率在 $[0, 500]$ Hz 范围内，因此这就是重构信号中出现的失真频率。\n\n答案要求四舍五入到三位有效数字，结果是 275 Hz。", "answer": "$$\\boxed{275}$$", "id": "1728129"}]}