{"hands_on_practices": [{"introduction": "时间缩放，例如快放或慢放一段音频，是信号处理中的一个基本操作。这个练习将探讨这种操作如何影响信号的语谱图，揭示时间与频率之间一个基本的反比关系。理解这一特性对于解读和比较不同速率下信号的时频内容至关重要。[@problem_id:1765762]", "problem": "在信号处理中，频谱图是一种强大的工具，用于可视化信号的频率内容随时间的变化。它是通过计算短时傅里叶变换 (STFT) 生成的。对于一个给定的信号 $x(t)$，其频谱图可以看作是一个二维图，其中水平轴代表时间 ($t$)，垂直轴代表频率 ($f$)，而任何一点 $(t, f)$ 的强度或颜色表示信号在该特定时间和频率上的分量大小。\n\n考虑一个任意的非零信号 $x(t)$。通过对原始信号进行时间压缩，创建一个新信号 $y(t)$，使得 $y(t) = x(3t)$。\n\n与原始信号 $x(t)$ 的频谱图相比，新信号 $y(t)$ 的频谱图在时频平面上是如何进行几何变换的？\n\nA. 沿时间轴压缩3倍，沿频率轴压缩3倍。\n\nB. 沿时间轴拉伸3倍，沿频率轴压缩3倍。\n\nC. 沿时间轴压缩3倍，沿频率轴拉伸3倍。\n\nD. 沿时间轴拉伸3倍，沿频率轴拉伸3倍。\n\nE. 仅沿时间轴压缩3倍，而沿频率轴的特征保持在相同位置。", "solution": "设信号的频谱图定义为其短时傅里叶变换 (STFT) 的幅度的平方。使用窗函数 $w$，信号 $x$ 的STFT为\n$$\n\\mathrm{STFT}_{x}(t,f)=\\int_{-\\infty}^{\\infty} x(\\tau)\\, w(\\tau - t)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi f \\tau\\right)\\, \\mathrm{d}\\tau,\n$$\n频谱图为 $S_{x}(t,f)=|\\mathrm{STFT}_{x}(t,f)|^{2}$。\n\n给定 $y(t)=x(3t)$，计算其 STFT：\n$$\n\\mathrm{STFT}_{y}(t,f)=\\int_{-\\infty}^{\\infty} x(3\\tau)\\, w(\\tau - t)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi f \\tau\\right)\\, \\mathrm{d}\\tau.\n$$\n应用变量替换 $u=3\\tau$，则 $\\tau=u/3$ 且 $\\mathrm{d}\\tau=\\mathrm{d}u/3$：\n$$\n\\mathrm{STFT}_{y}(t,f)=\\frac{1}{3}\\int_{-\\infty}^{\\infty} x(u)\\, w\\!\\left(\\frac{u}{3}-t\\right)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi \\frac{f}{3} u\\right)\\, \\mathrm{d}u.\n$$\n定义一个缩放后的窗函数 $\\tilde{w}(s)=w\\!\\left(\\frac{s}{3}\\right)$。那么 $w\\!\\left(\\frac{u}{3}-t\\right)=\\tilde{w}(u-3t)$，上式变为\n$$\n\\mathrm{STFT}_{y}(t,f)=\\frac{1}{3}\\int_{-\\infty}^{\\infty} x(u)\\, \\tilde{w}(u-3t)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi \\frac{f}{3} u\\right)\\, \\mathrm{d}u\n=\\frac{1}{3}\\,\\mathrm{STFT}_{x}^{(\\tilde{w})}(3t,\\tfrac{f}{3}),\n$$\n其中 $\\mathrm{STFT}_{x}^{(\\tilde{w})}$ 表示用窗函数 $\\tilde{w}$ 计算的 $x$ 的STFT。\n\n取幅度的平方，得到频谱图的关系\n$$\nS_{y}(t,f)=\\left|\\mathrm{STFT}_{y}(t,f)\\right|^{2}\n=\\frac{1}{9}\\, \\left|\\mathrm{STFT}_{x}^{(\\tilde{w})}(3t,\\tfrac{f}{3})\\right|^{2}.\n$$\n因此，除了一个整体的强度因子和窗函数的重新缩放之外，特征的几何映射是\n$$\n(t,f)\\mapsto \\left(\\frac{t}{3},\\, 3f\\right),\n$$\n即，特征沿时间轴被压缩了3倍，并沿频率轴被拉伸了3倍。因此，正确选项是C。", "answer": "$$\\boxed{C}$$", "id": "1765762"}, {"introduction": "语谱图分析的核心在于时频分辨率之间的权衡，这类似于物理学中的不确定性原理。这个练习通过一个假想情景，使用不同长度的分析窗来揭示这一关键概念：短窗能提供精确的时间信息但频率信息模糊，而长窗则反之。掌握这种权衡是有效进行语谱图分析的关键，能让你根据分析目标选择合适的工具。[@problem_id:1765705]", "problem": "考虑一个信号 $x(t)$，它是由一个周期性矩形脉冲序列对一个纯正弦音进行门控（gating）生成的。该正弦音由 $c(t) = \\cos(2\\pi f_c t)$ 描述，其中载波频率为 $f_c = 1000$ Hz。\n\n门控信号 $p(t)$ 是一个周期性矩形脉冲序列，周期为 $T_p = 200$ ms。其占空比为 50%，意味着在每个周期内，脉冲在 $D = 100$ ms 的持续时间内为“高”（值为 1），在剩余的 100 ms 内为“低”（值为 0）。得到的信号为 $x(t) = c(t) \\cdot p(t)$。\n\n需要计算该信号 $x(t)$ 的谱图（spectrogram）。谱图是短时傅里叶变换 (STFT) 的幅值平方，它使用一个滑动窗口来分析信号随时间变化的频率内容。我们将根据分析窗口的长度 $T_w$ 考虑两种不同的情景。\n\n- **情景 1：** 窗口长度为 $T_w = 10$ ms。\n- **情景 2：** 窗口长度为 $T_w = 500$ ms。\n\n以下哪个陈述为两种情景下谱图中的主要特征提供了最准确的定性描述？\n\nA.\n- 情景 1：在频率 $f_c$ 附近有一个显著特征，该特征以 200 ms 的周期出现和消失。该特征出现约 100 ms，然后消失 100 ms。短窗口导致了显著的频率展宽。\n- 情景 2：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组清晰、连续的水平线。这些线的强度随着 $|k|$ 的整数值增大而减小，并且对应于偶数非零值 $k$ 的谱线（例如，在 $1000 \\pm 10$ Hz, $1000 \\pm 20$ Hz 处）缺失。\n\nB.\n- 情景 1：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组清晰、连续的水平线。这些线的强度随着 $|k|$ 的整数值增大而减小，并且对应于偶数非零值 $k$ 的谱线缺失。\n- 情景 2：在频率 $f_c$ 附近有一个显著特征，该特征以 200 ms 的周期出现和消失。该特征出现约 100 ms，然后消失 100 ms。\n\nC.\n- 情景 1：在频率 $f_c$ 附近有一个显著特征，该特征以 200 ms 的周期出现和消失。该特征出现约 100 ms，然后消失 100 ms。短窗口导致了显著的频率展宽。\n- 情景 2：仅在 $k$ 为奇数值时的边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组清晰、连续的水平线。位于载波频率 $f_c=1000$ Hz 的中心谱线缺失。\n\nD.\n- 情景 1：在频率 $f_c = 1000$ Hz 处有一条单一、连续的水平线，被每 100 ms 出现一次的周期性垂直线（宽带脉冲）所切割。\n- 情景 2：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组清晰、连续的水平线。这些线的强度随着 $|k|$ 的整数值增大而减小，并且对应于偶数非零值 $k$ 的谱线缺失。\n\nE.\n- 情景 1：在频率 $f_c$ 附近有一个显著特征，该特征以 200 ms 的周期出现和消失。该特征出现约 100 ms，然后消失 100 ms。短窗口导致了显著的频率展宽。\n- 情景 2：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组清晰、连续的水平线。所有整数值 $k$ 都会产生可见的谱线，其强度随着 $|k|$ 的增大而平滑减小。", "solution": "问题要求预测在两种不同的短时傅里叶变换 (STFT) 窗口长度下，一个门控正弦波的谱图是什么样的。关键原理是时频不确定性原理：短时间窗口提供好的时间分辨率但差的频率分辨率，而长时间窗口提供好的频率分辨率但差的时间分辨率。\n\n信号为 $x(t) = \\cos(2\\pi f_c t) \\cdot p(t)$，其中 $f_c = 1000$ Hz。脉冲序列 $p(t)$ 的周期为 $T_p = 200$ ms，脉冲宽度为 $D = 100$ ms（50% 占空比）。脉冲序列的基频为 $f_p = 1/T_p = 1/0.2 = 5$ Hz。\n\n**情景 1 分析：短窗口 ($T_w = 10$ ms)**\n\n在这种情景下，窗口长度 $T_w=10$ ms 远小于脉冲宽度 ($D=100$ ms) 和周期 ($T_p=200$ ms)。\n- **时间分辨率：** 时间分辨率很高，量级约为 $T_w$。STFT 可以分辨发生在大于 10 ms 时间尺度上的事件。由于信号在 100 ms 内开启，在 100 ms 内关闭，STFT 可以清晰地分辨这些“开启”和“关闭”状态。\n- **频率分辨率：** 频率分辨率很差，量级约为 $\\Delta f \\approx 1/T_w = 1/0.01 = 100$ Hz。STFT 无法分辨频率间隔小于约 100 Hz 的频率分量。\n\n当 STFT 窗口位于“开启”区间之一时，它分析的是一段纯正弦波 $\\cos(2\\pi f_c t)$。变换结果将在 $f_c = 1000$ Hz 处显示一个能量峰值。由于频率分辨率差，这个峰会很宽，展宽到大约 100 Hz 的频率范围内。\n当窗口位于“关闭”区间时，它分析的是一个零信号，所以变换结果将显示接近零的能量。\n\n随着窗口在时间上滑动，谱图将显示一个以 $f_c=1000$ Hz 为中心的特征，它出现 100 ms，然后消失 100 ms，并以 $T_p=200$ ms 的周期重复。这与选项 A、C 和 E 的第一部分相符。\n\n**情景 2 分析：长窗口 ($T_w = 500$ ms)**\n\n在这种情景下，窗口长度 $T_w = 500$ ms 远大于脉冲序列的周期 ($T_p = 200$ ms)。\n- **时间分辨率：** 时间分辨率很差，量级约为 $T_w=500$ ms。STFT 窗口总是覆盖多个“开启”和“关闭”周期（具体来说是 $500/200 = 2.5$ 个周期）。它无法在时间上分辨单个的开启/关闭事件。因此，得到的谱图在时间上将表现为连续的，不会显示周期性的闪烁。\n- **频率分辨率：** 频率分辨率极好，量级约为 $\\Delta f \\approx 1/T_w = 1/0.5 = 2$ Hz。STFT 可以分辨频率间隔大于 2 Hz 的频率分量。这足以分辨由 5 Hz 脉冲序列引起的频谱结构。\n\n为了理解这个结构，我们在频域中分析信号。信号 $x(t)$ 是两个信号的乘积，所以其傅里叶变换 $X(f)$ 是它们各自变换的卷积：\n$X(f) = \\mathcal{F}\\{\\cos(2\\pi f_c t)\\} * \\mathcal{F}\\{p(t)\\}$\n\n正弦波的傅里叶变换是两个狄拉克 δ 函数：\n$\\mathcal{F}\\{\\cos(2\\pi f_c t)\\} = \\frac{1}{2}[\\delta(f-f_c) + \\delta(f+f_c)]$\n\n脉冲序列 $p(t)$ 是周期性的，所以其傅里叶变换是位于基频 $f_p=5$ Hz 整数倍处的一串 δ 函数。这些 δ 函数的权重由 $p(t)$ 的傅里叶级数系数 $c_k$ 给出。\n$\\mathcal{F}\\{p(t)\\} = \\sum_{k=-\\infty}^{\\infty} c_k \\delta(f - k f_p)$\n\n对于一个占空比为 50% ($D=T_p/2$) 的矩形脉冲序列，其系数由以下公式给出：\n$c_k = \\frac{1}{T_p} \\int_{-D/2}^{D/2} (1) \\cdot e^{-j 2\\pi k f_p t} dt = \\frac{1}{T_p} \\int_{-T_p/4}^{T_p/4} e^{-j 2\\pi k t/T_p} dt$\n$c_k = \\frac{1}{T_p} \\left[ \\frac{e^{-j 2\\pi k t/T_p}}{-j 2\\pi k/T_p} \\right]_{-T_p/4}^{T_p/4} = \\frac{1}{-j 2\\pi k} (e^{-j \\pi k/2} - e^{j \\pi k/2}) = \\frac{-2j \\sin(-\\pi k/2)}{-j 2\\pi k} = \\frac{\\sin(\\pi k/2)}{\\pi k}$\n这是一个归一化的 sinc 函数：$c_k = \\frac{1}{2}\\text{sinc}(\\frac{k}{2})$。\n\n我们来计算几个 $k$ 值对应的 $c_k$：\n- $k=0$: $c_0 = \\lim_{k\\to 0} \\frac{\\sin(\\pi k/2)}{\\pi k} = \\frac{\\pi/2}{\\pi} = 1/2$。（直流分量为 0.5，符合 50% 占空比的预期）。\n- $k=\\pm 1$: $c_{\\pm 1} = \\frac{\\sin(\\pm \\pi/2)}{\\pm \\pi} = \\frac{\\pm 1}{\\pm \\pi} = 1/\\pi$。\n- $k=\\pm 2$: $c_{\\pm 2} = \\frac{\\sin(\\pm \\pi)}{\\pm 2\\pi} = 0$。\n- $k=\\pm 3$: $c_{\\pm 3} = \\frac{\\sin(\\pm 3\\pi/2)}{\\pm 3\\pi} = \\frac{\\mp 1}{\\pm 3\\pi} = -1/(3\\pi)$。\n- $k=\\pm 4$: $c_{\\pm 4} = \\frac{\\sin(\\pm 2\\pi)}{\\pm 4\\pi} = 0$。\n总的来说，对于所有偶数非零整数 $k$，$c_k=0$。\n\n现在，将正弦波的频谱与脉冲序列的频谱进行卷积，意味着在 $f=\\pm f_c$ 处放置脉冲序列频谱的缩放副本。得到的频谱 $X(f)$（对于正频率）由位于频率 $f_c + k f_p$ 处的 δ 函数组成：\n$X(f) \\propto \\sum_{k=-\\infty}^{\\infty} c_k \\delta(f - (f_c + k f_p))$\n高分辨率的 STFT 将把这些 δ 函数分辨为尖锐的谱线。因此，谱图将在频率 $f = f_c + k f_p = 1000 + k \\cdot 5$ Hz 处显示连续的水平线。\n\n这些谱线的强度与 $|c_k|^2$ 成正比。\n- 在 $f_c$ 处存在一条强谱线（对应 $k=0$）。\n- 在 $f_c \\pm 5$ Hz 处存在谱线（对应 $k=\\pm 1$）。\n- 在 $f_c \\pm 10$ Hz 处的谱线（对应 $k=\\pm 2$）缺失，因为 $c_{\\pm 2} = 0$。\n- 在 $f_c \\pm 15$ Hz 处存在谱线（对应 $k=\\pm 3$）。\n- 在 $f_c \\pm 20$ Hz 处的谱线（对应 $k=\\pm 4$）缺失，因为 $c_{\\pm 4} = 0$。\n以此类推。这与选项 A 的第二部分相符。\n\n**评估选项：**\n- **A：** 根据以上分析，正确描述了两种情景。\n- **B：** 错误地交换了两种情景的描述。\n- **C：** 错误地声称情景 2 中位于 $f_c$ 的中心谱线缺失。$k=0$ 的分量 ($c_0$) 是非零的。\n- **D：** 错误地描述了情景 1。垂直线意味着脉冲性的宽带事件，而门控产生的是窄带信号的周期性片段。\n- **E：** 错误地描述了情景 2。它没有考虑到频谱中在离载波为 $f_p$ 的偶数倍处的零点，这是 50% 占空比脉冲序列的一个特有属性。\n\n因此，选项 A 是唯一准确描述了两种情况的选项。", "answer": "$$\\boxed{A}$$", "id": "1765705"}, {"introduction": "语谱图不仅用于可视化单个信号，还可用于理解系统如何改变信号。本练习展示了一个线性时不变（LTI）滤波器的频率响应如何直接“塑造”输出信号的语谱图。这为在时频域中预测和分析系统行为提供了一种强有力的方法，该方法基于一个有用的近似关系 $S_y(\\tau, \\omega) = |H(\\omega)|^2 S_x(\\tau, \\omega)$，它在许多实际应用中都非常有效。[@problem_id:1765710]", "problem": "一个用于工业机械的诊断系统通过一个预处理滤波器来分析声学信号 $x(t)$，并产生输出信号 $y(t)$。该滤波器是一个稳定的线性时不变 (LTI) 系统。分析在时频域中使用谱图进行，谱图表示信号在时间和频率上的能量分布。设 $S_x(\\tau, \\omega)$ 为输入信号的谱图，$S_y(\\tau, \\omega)$ 为输出信号的谱图。\n\n输入信号 $x(t)$ 由其谱图表征，该谱图被发现在机器的两个特定工作阶段内才非零。\n- 在时间间隔 $0 \\le \\tau \\le T_0$ 内，输入信号的能量高度集中在单一角频率 $\\omega_1$ 处，此时谱图的振幅为常数 $P_1$。\n- 在时间间隔 $T_0  \\tau \\le 2T_0$ 内，输入信号的能量高度集中在另一个不同的单一角频率 $\\omega_2$ 处，此时谱图的振幅为常数 $P_2$。\n- 谱图 $S_x(\\tau, \\omega)$ 在所有其他时间和频率上均为零。\n\nLTI 预处理滤波器的幅频响应由 $|H(\\omega)| = \\frac{K}{\\sqrt{1 + (\\omega/\\omega_c)^2}}$ 给出，其中 $K$ 和 $\\omega_c$ 是正实数常量，分别代表滤波器的增益和截止频率。对于所采用的分析技术，输出谱图由关系式 $S_y(\\tau, \\omega) = |H(\\omega)|^2 S_x(\\tau, \\omega)$ 建模。\n\n计算输出信号 $y(t)$ 在时间间隔 $[0, T_0]$ 内的总能量与在时间间隔 $(T_0, 2T_0]$ 内的总能量之比。请用 $P_1$、$P_2$、$\\omega_1$、$\\omega_2$ 和 $\\omega_c$ 表示你的答案的符号表达式。", "solution": "信号在时间间隔 $[a,b]$ 内的总能量由其谱图给出：\n$$\nE_{y}[a,b]=\\int_{a}^{b}\\int_{-\\infty}^{\\infty} S_{y}(\\tau,\\omega)\\,d\\omega\\,d\\tau.\n$$\n对于一个稳定的 LTI 系统，输出谱图满足 $S_{y}(\\tau,\\omega)=|H(\\omega)|^{2}S_{x}(\\tau,\\omega)$。\n\n根据题目陈述，在 $0\\le \\tau\\le T_{0}$ 期间，输入谱图集中在 $\\omega_{1}$ 处，振幅为常数 $P_{1}$，我们将其建模为\n$$\nS_{x}(\\tau,\\omega)=P_{1}\\,\\delta(\\omega-\\omega_{1})\\quad \\text{for }0\\le \\tau\\le T_{0},\n$$\n并且在 $T_{0}  \\tau \\le 2T_{0}$ 期间，它集中在 $\\omega_{2}$ 处，振幅为常数 $P_{2}$，\n$$\nS_{x}(\\tau,\\omega)=P_{2}\\,\\delta(\\omega-\\omega_{2})\\quad \\text{for }T_{0}  \\tau \\le 2T_{0},\n$$\n其他情况下 $S_{x}(\\tau,\\omega)=0$。\n\n因此，第一个时间间隔内的输出谱图为\n$$\nS_{y}(\\tau,\\omega)=|H(\\omega)|^{2}P_{1}\\,\\delta(\\omega-\\omega_{1}),\n$$\n所以在 $[0,T_{0}]$ 内的能量为\n$$\nE_{1}=\\int_{0}^{T_{0}}\\int_{-\\infty}^{\\infty}|H(\\omega)|^{2}P_{1}\\,\\delta(\\omega-\\omega_{1})\\,d\\omega\\,d\\tau\n=\\int_{0}^{T_{0}}|H(\\omega_{1})|^{2}P_{1}\\,d\\tau\n=T_{0}\\,|H(\\omega_{1})|^{2}P_{1}.\n$$\n类似地，对于 $(T_{0},2T_{0}]$ 区间，\n$$\nE_{2}=\\int_{T_{0}}^{2T_{0}}\\int_{-\\infty}^{\\infty}|H(\\omega)|^{2}P_{2}\\,\\delta(\\omega-\\omega_{2})\\,d\\omega\\,d\\tau\n=T_{0}\\,|H(\\omega_{2})|^{2}P_{2}.\n$$\n因此，所求的比值为\n$$\n\\frac{E_{1}}{E_{2}}=\\frac{|H(\\omega_{1})|^{2}P_{1}}{|H(\\omega_{2})|^{2}P_{2}}.\n$$\n使用给定的幅频响应 $|H(\\omega)|=\\dfrac{K}{\\sqrt{1+(\\omega/\\omega_{c})^{2}}}$，我们有\n$$\n|H(\\omega)|^{2}=\\frac{K^{2}}{1+(\\omega/\\omega_{c})^{2}}.\n$$\n代入并化简，\n$$\n\\frac{E_{1}}{E_{2}}=\\frac{\\dfrac{K^{2}}{1+(\\omega_{1}/\\omega_{c})^{2}}P_{1}}{\\dfrac{K^{2}}{1+(\\omega_{2}/\\omega_{c})^{2}}P_{2}}\n=\\frac{P_{1}}{P_{2}}\\cdot \\frac{1+(\\omega_{2}/\\omega_{c})^{2}}{1+(\\omega_{1}/\\omega_{c})^{2}}.\n$$", "answer": "$$\\boxed{\\frac{P_{1}}{P_{2}}\\cdot \\frac{1+(\\omega_{2}/\\omega_{c})^{2}}{1+(\\omega_{1}/\\omega_{c})^{2}}}$$", "id": "1765710"}]}