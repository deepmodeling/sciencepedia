{"hands_on_practices": [{"introduction": "本练习聚焦于高效实现多速率系统的核心技术：多相分解。通过将滤波器 $H(z)$ 分解为其多相分量，我们可以重构滤波器组的结构，将下采样操作移到滤波之前，从而显著减少计算量。这个练习 [@problem_id:1729545] 提供了一个直接的、动手的机会，来为一个简单的 FIR 滤波器计算这些分量，为理解高效的滤波器组架构奠定基础。", "problem": "在多速率数字信号处理系统的设计中，例如双通道分析-综合滤波器组，一个基础技术是多相分解。这种方法通过将滤波器分解为称为多相分量的较小子滤波器，从而可以更有效地实现滤波器。\n\n对于一个传递函数为 $H(z)$ 的因果有限脉冲响应（FIR）滤波器，其用于双通道系统的一型多相分解由以下恒等式定义：\n$$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$$\n其中 $E_0(z)$ 和 $E_1(z)$ 是两个多相分量滤波器。\n\n给定一个简单的低通 FIR 滤波器，其传递函数为 $H(z) = 1 + 2z^{-1} + 3z^{-2}$，求其两个一型多相分量 $E_0(z)$ 和 $E_1(z)$ 的传递函数。", "solution": "给定因果 FIR 滤波器的传递函数为 $H(z) = 1 + 2z^{-1} + 3z^{-2}$。将 $H(z)$ 写成一般求和形式 $H(z) = \\sum_{n=0}^{2} h[n] z^{-n}$，可得系数 $h[0]=1$，$h[1]=2$ 和 $h[2]=3$。\n\n对于双通道一型多相分解，其恒等式为\n$$\nH(z) = E_{0}(z^{2}) + z^{-1} E_{1}(z^{2}),\n$$\n其多相分量定义为\n$$\nE_{0}(z) = \\sum_{k=0}^{\\infty} h[2k] z^{-k}, \\quad E_{1}(z) = \\sum_{k=0}^{\\infty} h[2k+1] z^{-k}.\n$$\n\n使用偶数索引的系数计算 $E_{0}(z)$：\n$$\nE_{0}(z) = h[0] + h[2] z^{-1} = 1 + 3 z^{-1}.\n$$\n\n使用奇数索引的系数计算 $E_{1}(z)$：\n$$\nE_{1}(z) = h[1] = 2.\n$$\n\n验证分解：\n$$\nE_{0}(z^{2}) + z^{-1} E_{1}(z^{2}) = \\left(1 + 3 z^{-2}\\right) + z^{-1} \\cdot 2 = 1 + 2 z^{-1} + 3 z^{-2} = H(z),\n$$\n这与给定的 $H(z)$ 相匹配，从而证实了多相分量的正确性。", "answer": "$$\\boxed{\\begin{pmatrix}1 + 3 z^{-1}  2\\end{pmatrix}}$$", "id": "1729545"}, {"introduction": "许多滤波器组系统的最终目标是在分析和合成之后完美地重构原始信号。本练习 [@problem_id:1729528] 将带你从分析单个组件过渡到设计一个能够实现此目标的完整系统。你需要确定必要的合成滤波器，以消除混叠和失真，从而实现完美重构。这个问题对于理解高保真分析-合成系统的设计条件至关重要。", "problem": "考虑一个双通道、临界采样的滤波器组。输入信号 $x[n]$ 通过两个分析滤波器 $H_0(z)$ 和 $H_1(z)$。每个滤波器的输出然后以因子2进行下采样。这两个下采样后的信号然后以因子2进行上采样，并分别通过两个合成滤波器 $F_0(z)$ 和 $F_1(z)$。合成滤波器的输出相加，产生重建信号 $\\hat{x}[n]$。\n\n如果输出是输入的一个缩放和延迟的版本，即 $\\hat{x}[n] = c x[n-d]$，其中 $c$ 是某个非零常数增益，$d$ 是某个非负整数延迟，则称该系统实现了完美重建。\n\n假设分析滤波器由其Z变换 $H_0(z) = 1$ 和 $H_1(z) = z^{-1}$ 给出。请确定因果合成滤波器 $F_0(z)$ 和 $F_1(z)$ 的Z变换，使其能以单位增益（$c=1$）和最小可能非负整数延迟 $d$ 实现完美重建。\n\n请以行矩阵 $\\begin{pmatrix} F_0(z)  F_1(z) \\end{pmatrix}$ 的形式给出您的答案。", "solution": "定义分析滤波器的Z变换为 $H_{0}(z)=1$ 和 $H_{1}(z)=z^{-1}$。在一个双通道、2倍抽取和2倍内插的滤波器组中，z域中的重建信号 $\\hat{X}(z)$ 可以（使用标准的贵族恒等式和混叠分量分解）表示为\n$$\n\\hat{X}(z)=\\frac{1}{2}\\left[F_{0}(z)H_{0}(z)+F_{1}(z)H_{1}(z)\\right]X(z)+\\frac{1}{2}\\left[F_{0}(z)H_{0}(-z)+F_{1}(z)H_{1}(-z)\\right]X(-z).\n$$\n具有单位增益和延迟 $d$ 的完美重建要求混叠项为零，且失真项等于 $z^{-d}$，即\n$$\n\\frac{1}{2}\\left[F_{0}(z)H_{0}(z)+F_{1}(z)H_{1}(z)\\right]=z^{-d},\\qquad \\frac{1}{2}\\left[F_{0}(z)H_{0}(-z)+F_{1}(z)H_{1}(-z)\\right]=0.\n$$\n等价地，\n$$\nF_{0}(z)H_{0}(z)+F_{1}(z)H_{1}(z)=2z^{-d},\\qquad F_{0}(z)H_{0}(-z)+F_{1}(z)H_{1}(-z)=0.\n$$\n代入 $H_{0}(z)=1$ 和 $H_{1}(z)=z^{-1}$，并使用 $H_{0}(-z)=1$，$H_{1}(-z)=(-z)^{-1}=-z^{-1}$，得到以下线性系统\n$$\nF_{0}(z)+z^{-1}F_{1}(z)=2z^{-d},\\qquad F_{0}(z)-z^{-1}F_{1}(z)=0.\n$$\n由第二个方程可知，\n$$\nF_{0}(z)=z^{-1}F_{1}(z).\n$$\n将此式代入第一个方程：\n$$\nz^{-1}F_{1}(z)+z^{-1}F_{1}(z)=2z^{-d}\\quad\\Rightarrow\\quad 2z^{-1}F_{1}(z)=2z^{-d}\\quad\\Rightarrow\\quad F_{1}(z)=z^{-(d-1)}.\n$$\n因此，\n$$\nF_{0}(z)=z^{-1}F_{1}(z)=z^{-1}z^{-(d-1)}=z^{-d}.\n$$\n为保证因果性，$F_{0}(z)$ 和 $F_{1}(z)$ 都必须是具有非负延迟的可实现系统，即它们必须是 $z^{-1}$ 的多项式，不含 $z$ 的正幂次。此处，$F_{0}(z)=z^{-d}$ 对于任何 $d \\ge 0$ 都是因果的，而 $F_{1}(z)=z^{-(d-1)}$ 是因果的当且仅当 $d-1 \\ge 0$，即 $d \\ge 1$。因此，最小非负整数延迟为 $d=1$，由此可得\n$$\nF_{0}(z)=z^{-1},\\qquad F_{1}(z)=1.\n$$\n采用这些选择，混叠项为零，失真项在单位增益下等于 $z^{-1}$，故 $\\hat{x}[n]=x[n-1]$。", "answer": "$$\\boxed{\\begin{pmatrix} z^{-1}  1 \\end{pmatrix}}$$", "id": "1729528"}, {"introduction": "虽然Z变换分析对于理解滤波器组的理论非常强大，但实际应用通常处理的是有限长度的信号或数据块。本练习 [@problem_id:1729533] 展示了如何使用矩阵代数来为整个分析-合成过程建模，这一视角直接适用于软件和硬件实现。通过将卷积、下采样和上采样表示为矩阵运算，你将深入了解这些抽象概念如何转化为具体的计算。", "problem": "考虑一个作用于有限长度信号的双通道、离散时间、分析-综合滤波器组。该系统设计用于处理长度为 $N=4$ 的输入信号 $\\mathbf{x}$，表示为列向量 $\\mathbf{x} = [x[0], x[1], x[2], x[3]]^T$。\n\n分析阶段将信号分成两个子带。\n- 低通分支使用冲激响应为 $h_0 = [1, 2]$ 的有限冲激响应（FIR）滤波器。\n- 高通分支使用冲激响应为 $h_1 = [3, 4]$ 的 FIR 滤波器。\n\n每个分析滤波器的输出随后进行2倍下采样（即，从索引0开始，只保留偶数索引处的样本）。\n\n综合阶段重构信号。\n- 低通子带信号先进行2倍上采样（通过在每个样本之间插入一个零），然后由冲激响应为 $g_0 = [2, -1]$ 的综合滤波器进行滤波。\n- 高通子带信号进行2倍上采样，然后由冲激响应为 $g_1 = [-1, 2]$ 的综合滤波器进行滤波。\n\n两个综合滤波器的输出相加以产生最终输出信号 $\\mathbf{y}$。从 $\\mathbf{x}$ 到 $\\mathbf{y}$ 的整个过程可以用一个单一的矩阵变换 $\\mathbf{y} = \\mathbf{M} \\mathbf{x}$ 来描述。由于滤波操作，最终输出信号 $\\mathbf{y}$ 的长度可能大于输入信号的长度 $N$。长度为 $N=4$ 的重构信号 $\\hat{\\mathbf{x}}$ 是通过从 $\\mathbf{y}$ 中提取一个特定的样本窗口得到的。具体来说，$\\hat{x}[n] = y[n+1]$，其中 $n=0, 1, 2, 3$。\n\n从输入信号 $\\mathbf{x}$ 到重构信号 $\\hat{\\mathbf{x}}$ 的完整变换可以用一个单一的 $4 \\times 4$ 矩阵 $\\mathbf{P}$ 表示，使得 $\\hat{\\mathbf{x}} = \\mathbf{P} \\mathbf{x}$。\n\n计算矩阵 $\\mathbf{P}$ 中所有元素的和的数值。", "solution": "问题要求计算总系统矩阵 $\\mathbf{P}$ 所有元素的和，该矩阵将长度为4的输入向量 $\\mathbf{x}$ 变换为长度为4的重构向量 $\\hat{\\mathbf{x}}$。总体变换为 $\\hat{\\mathbf{x}} = \\mathbf{P}\\mathbf{x}$。我们可以通过使用矩阵运算跟踪信号在滤波器组中的处理过程来找到 $\\mathbf{P}$。\n\n设输入信号为 $\\mathbf{x} = [x_0, x_1, x_2, x_3]^T$。\n\n**步骤1：分析阶段**\n\n第一步是将输入信号 $\\mathbf{x}$（长度 $N=4$）与分析滤波器 $h_0$ 和 $h_1$（长度 $L=2$）进行线性卷积。长度为 $N$ 的信号与长度为 $L$ 的滤波器进行线性卷积的输出信号长度为 $N+L-1 = 4+2-1 = 5$。\n\n*   **分支0（低通）：** 与 $h_0 = [1, 2]$ 进行卷积。设输出为 $\\mathbf{y}_0$。这可以表示为与一个大小为 $5 \\times 4$ 的托普利茨矩阵 $\\mathbf{H}_0$ 相乘。\n    $$\n    \\mathbf{y}_0 = \\mathbf{H}_0 \\mathbf{x} = \\begin{pmatrix} 1  0  0  0 \\\\ 2  1  0  0 \\\\ 0  2  1  0 \\\\ 0  0  2  1 \\\\ 0  0  0  2 \\end{pmatrix} \\begin{pmatrix} x_0 \\\\ x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}\n    $$\n*   **分支1（高通）：** 与 $h_1 = [3, 4]$ 进行卷积。设输出为 $\\mathbf{y}_1$。这由大小为 $5 \\times 4$ 的矩阵 $\\mathbf{H}_1$ 表示。\n    $$\n    \\mathbf{y}_1 = \\mathbf{H}_1 \\mathbf{x} = \\begin{pmatrix} 3  0  0  0 \\\\ 4  3  0  0 \\\\ 0  4  3  0 \\\\ 0  0  4  3 \\\\ 0  0  0  4 \\end{pmatrix} \\begin{pmatrix} x_0 \\\\ x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}\n    $$\n\n**步骤2：下采样**\n\n信号 $\\mathbf{y}_0$ 和 $\\mathbf{y}_1$（长度为5）进行2倍下采样。这意味着保留索引为 0、2、4 的样本。得到的信号 $\\mathbf{v}_0$ 和 $\\mathbf{v}_1$ 的长度将为3。此操作可以用一个大小为 $3 \\times 5$ 的下采样矩阵 $\\mathbf{D}$ 表示。\n$$\n\\mathbf{D} = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  0  1  0  0 \\\\ 0  0  0  0  1 \\end{pmatrix}\n$$\n因此，$\\mathbf{v}_0 = \\mathbf{D} \\mathbf{y}_0 = \\mathbf{D} \\mathbf{H}_0 \\mathbf{x}$ 且 $\\mathbf{v}_1 = \\mathbf{D} \\mathbf{y}_1 = \\mathbf{D} \\mathbf{H}_1 \\mathbf{x}$。我们来计算总分析矩阵 $\\mathbf{A}_0 = \\mathbf{D}\\mathbf{H}_0$ 和 $\\mathbf{A}_1 = \\mathbf{D}\\mathbf{H}_1$。两者都是 $3 \\times 4$ 的矩阵。\n$$\n\\mathbf{A}_0 = \\mathbf{D}\\mathbf{H}_0 = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  0  1  0  0 \\\\ 0  0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\\\ 2  1  0  0 \\\\ 0  2  1  0 \\\\ 0  0  2  1 \\\\ 0  0  0  2 \\end{pmatrix} = \\begin{pmatrix} 1  0  0  0 \\\\ 0  2  1  0 \\\\ 0  0  0  2 \\end{pmatrix}\n$$\n$$\n\\mathbf{A}_1 = \\mathbf{D}\\mathbf{H}_1 = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  0  1  0  0 \\\\ 0  0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 3  0  0  0 \\\\ 4  3  0  0 \\\\ 0  4  3  0 \\\\ 0  0  4  3 \\\\ 0  0  0  4 \\end{pmatrix} = \\begin{pmatrix} 3  0  0  0 \\\\ 0  4  3  0 \\\\ 0  0  0  4 \\end{pmatrix}\n$$\n\n**步骤3：综合阶段**\n\n信号 $\\mathbf{v}_0$ 和 $\\mathbf{v}_1$（长度为3）进行2倍上采样。这意味着在样本之间插入一个零。得到的信号 $\\mathbf{u}_0$ 和 $\\mathbf{u}_1$ 长度为 $2 \\times 3 - 1 = 5$。这可以用一个大小为 $5 \\times 3$ 的上采样矩阵 $\\mathbf{U}$ 表示。\n$$\n\\mathbf{U} = \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n这些上采样后的信号接着与综合滤波器 $g_0$ 和 $g_1$（长度 $K=2$）进行卷积。卷积输出的长度为 $5+2-1=6$。\n\n*   **分支0：** $\\mathbf{u}_0$ 与 $g_0 = [2, -1]$ 进行卷积。设输出为 $\\mathbf{w}_0$。这由一个大小为 $6 \\times 5$ 的托普利茨矩阵 $\\mathbf{G}_0$ 表示。\n    $$\n    \\mathbf{w}_0 = \\mathbf{G}_0 \\mathbf{u}_0 = \\begin{pmatrix} 2  0  0  0  0 \\\\ -1  2  0  0  0 \\\\ 0  -1  2  0  0 \\\\ 0  0  -1  2  0 \\\\ 0  0  0  -1  2 \\\\ 0  0  0  0  -1 \\end{pmatrix} \\mathbf{u}_0\n    $$\n*   **分支1：** $\\mathbf{u}_1$ 与 $g_1 = [-1, 2]$ 进行卷积。设输出为 $\\mathbf{w}_1$。这由一个大小为 $6 \\times 5$ 的托普利茨矩阵 $\\mathbf{G}_1$ 表示。\n    $$\n    \\mathbf{w}_1 = \\mathbf{G}_1 \\mathbf{u}_1 = \\begin{pmatrix} -1  0  0  0  0 \\\\ 2  -1  0  0  0 \\\\ 0  2  -1  0  0 \\\\ 0  0  2  -1  0 \\\\ 0  0  0  2  -1 \\\\ 0  0  0  0  2 \\end{pmatrix} \\mathbf{u}_1\n    $$\n\n**步骤4：求和与最终重构**\n\n截断前的总输出信号为 $\\mathbf{y} = \\mathbf{w}_0 + \\mathbf{w}_1$。问题陈述，最终的重构信号 $\\hat{\\mathbf{x}}$ 是通过从 $\\mathbf{y}$ 中从索引1开始取样得到的：$\\hat{x}[n] = y[n+1]$，其中 $n=0, 1, 2, 3$。这相当于对 $\\mathbf{y}$ 应用一个大小为 $4 \\times 6$ 的截断/选择矩阵 $\\mathbf{T}$。\n$$\n\\mathbf{T} = \\begin{pmatrix} 0  1  0  0  0  0 \\\\ 0  0  1  0  0  0 \\\\ 0  0  0  1  0  0 \\\\ 0  0  0  0  1  0 \\end{pmatrix}\n$$\n所以，$\\hat{\\mathbf{x}} = \\mathbf{T} \\mathbf{y} = \\mathbf{T} (\\mathbf{w}_0 + \\mathbf{w}_1)$。\n\n我们来求每个分支的总综合矩阵，$\\mathbf{S}_0 = \\mathbf{T}\\mathbf{G}_0\\mathbf{U}$ 和 $\\mathbf{S}_1 = \\mathbf{T}\\mathbf{G}_1\\mathbf{U}$。两者都将是 $4 \\times 3$ 矩阵。\n$$\n\\mathbf{G}_0\\mathbf{U} = \\begin{pmatrix} 2  0  0  0  0 \\\\ -1  2  0  0  0 \\\\ 0  -1  2  0  0 \\\\ 0  0  -1  2  0 \\\\ 0  0  0  -1  2 \\\\ 0  0  0  0  -1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 2  0  0 \\\\ -1  0  0 \\\\ 0  2  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\\\ 0  0  -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{S}_0 = \\mathbf{T}(\\mathbf{G}_0\\mathbf{U}) = \\begin{pmatrix} 0  1  0  0  0  0 \\\\ 0  0  1  0  0  0 \\\\ 0  0  0  1  0  0 \\\\ 0  0  0  0  1  0 \\end{pmatrix} \\begin{pmatrix} 2  0  0 \\\\ -1  0  0 \\\\ 0  2  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\\\ 0  0  -1 \\end{pmatrix} = \\begin{pmatrix} -1  0  0 \\\\ 0  2  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\end{pmatrix}\n$$\n对 $\\mathbf{S}_1$ 进行类似计算：\n$$\n\\mathbf{G}_1\\mathbf{U} = \\begin{pmatrix} -1  0  0  0  0 \\\\ 2  -1  0  0  0 \\\\ 0  2  -1  0  0 \\\\ 0  0  2  -1  0 \\\\ 0  0  0  2  -1 \\\\ 0  0  0  0  2 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} -1  0  0 \\\\ 2  0  0 \\\\ 0  -1  0 \\\\ 0  2  0 \\\\ 0  0  -1 \\\\ 0  0  2 \\end{pmatrix}\n$$\n$$\n\\mathbf{S}_1 = \\mathbf{T}(\\mathbf{G}_1\\mathbf{U}) = \\begin{pmatrix} 0  1  0  0  0  0 \\\\ 0  0  1  0  0  0 \\\\ 0  0  0  1  0  0 \\\\ 0  0  0  0  1  0 \\end{pmatrix} \\begin{pmatrix} -1  0  0 \\\\ 2  0  0 \\\\ 0  -1  0 \\\\ 0  2  0 \\\\ 0  0  -1 \\\\ 0  0  2 \\end{pmatrix} = \\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  2  0 \\\\ 0  0  -1 \\end{pmatrix}\n$$\n\n**步骤5：总系统矩阵**\n\n总系统矩阵 $\\mathbf{P}$ 结合了所有这些步骤。\n$\\hat{\\mathbf{x}} = \\mathbf{S}_0 \\mathbf{v}_0 + \\mathbf{S}_1 \\mathbf{v}_1 = \\mathbf{S}_0 (\\mathbf{A}_0 \\mathbf{x}) + \\mathbf{S}_1 (\\mathbf{A}_1 \\mathbf{x}) = (\\mathbf{S}_0 \\mathbf{A}_0 + \\mathbf{S}_1 \\mathbf{A}_1) \\mathbf{x}$。\n所以，$\\mathbf{P} = \\mathbf{S}_0 \\mathbf{A}_0 + \\mathbf{S}_1 \\mathbf{A}_1$。我们来计算每个乘积。\n$$\n\\mathbf{P}_0 = \\mathbf{S}_0 \\mathbf{A}_0 = \\begin{pmatrix} -1  0  0 \\\\ 0  2  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\\\ 0  2  1  0 \\\\ 0  0  0  2 \\end{pmatrix} = \\begin{pmatrix} -1  0  0  0 \\\\ 0  4  2  0 \\\\ 0  -2  -1  0 \\\\ 0  0  0  4 \\end{pmatrix}\n$$\n$$\n\\mathbf{P}_1 = \\mathbf{S}_1 \\mathbf{A}_1 = \\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  2  0 \\\\ 0  0  -1 \\end{pmatrix} \\begin{pmatrix} 3  0  0  0 \\\\ 0  4  3  0 \\\\ 0  0  0  4 \\end{pmatrix} = \\begin{pmatrix} 6  0  0  0 \\\\ 0  -4  -3  0 \\\\ 0  8  6  0 \\\\ 0  0  0  -4 \\end{pmatrix}\n$$\n现在，我们将它们相加得到总系统矩阵 $\\mathbf{P}$。\n$$\n\\mathbf{P} = \\mathbf{P}_0 + \\mathbf{P}_1 = \\begin{pmatrix} -1  0  0  0 \\\\ 0  4  2  0 \\\\ 0  -2  -1  0 \\\\ 0  0  0  4 \\end{pmatrix} + \\begin{pmatrix} 6  0  0  0 \\\\ 0  -4  -3  0 \\\\ 0  8  6  0 \\\\ 0  0  0  -4 \\end{pmatrix} = \\begin{pmatrix} 5  0  0  0 \\\\ 0  0  -1  0 \\\\ 0  6  5  0 \\\\ 0  0  0  0 \\end{pmatrix}\n$$\n\n**步骤6：元素求和**\n\n最后一步是计算矩阵 $\\mathbf{P}$ 的所有元素之和。\n$$\n\\text{和} = 5 + 0 + 0 + 0 + 0 + 0 + (-1) + 0 + 0 + 6 + 5 + 0 + 0 + 0 + 0 + 0 = 5 - 1 + 6 + 5 = 15\n$$", "answer": "$$\\boxed{15}$$", "id": "1729533"}]}