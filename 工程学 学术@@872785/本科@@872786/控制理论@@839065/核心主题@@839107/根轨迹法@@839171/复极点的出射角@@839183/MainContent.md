## 引言
[根轨迹](@entry_id:272958)作为控制理论中分析系统动态性能的强大图形化工具，描绘了[闭环极点](@entry_id:274094)随[控制器增益](@entry_id:262009)的变化轨迹。然而，当面对包含复[共轭极点](@entry_id:166341)的系统时，仅凭渐近线和[实轴](@entry_id:148276)轨迹等基本规则往往无法精确描绘根轨迹的完整形态，特别是在轨迹离开这些[复极点](@entry_id:274945)时的初始方向。本文旨在填补这一知识缺口，深入探讨决定这一初始方向的关键概念——[出射角](@entry_id:264341)。通过本文的学习，您将能够精确预测和塑造系统的动态行为。我们将分三步展开：首先，在“**原理与机制**”一章中，您将学习[出射角](@entry_id:264341)背后的[相角条件](@entry_id:264793)，掌握其标准计算方法，并理解其对[系统稳定性](@entry_id:273248)的直接影响。随后，在“**应用与跨学科联系**”一章，我们将通过[控制器设计](@entry_id:274982)、[系统辨识](@entry_id:201290)等实际案例，展示[出射角](@entry_id:264341)在工程实践中的强大应用价值。最后，“**动手实践**”部分将提供精选问题，巩固您学到的知识并提升解决问题的技能。

## 原理与机制

在上一章中，我们介绍了根轨迹作为一种强大的图形化工具，用于分析[闭环极点](@entry_id:274094)如何随[系统增益](@entry_id:171911) $K$ 的变化而移动。[根轨迹](@entry_id:272958)的构建遵循一套明确的规则，这些规则源于系统的[特征方程](@entry_id:265849)。虽然诸如[实轴](@entry_id:148276)上的轨迹、[渐近线](@entry_id:141820)和分离点等规则为我们描绘了根轨迹的大致轮廓，但为了精确地绘制和理解轨迹，尤其是在其离开开环复[共轭极点](@entry_id:166341)或到达开环复共轭零点时的行为，我们必须掌握两个关键概念：**[出射角](@entry_id:264341)（angle of departure）**和**[到达角](@entry_id:265527)（angle of arrival）**。本章将深入探讨这些概念的原理、计算方法及其在[系统分析](@entry_id:263805)与设计中的重要意义。

### [根轨迹](@entry_id:272958)的[相角条件](@entry_id:264793)

我们首先回顾根轨迹的基本原理。对于一个负反馈系统，其[特征方程](@entry_id:265849)为 $1 + K G(s)H(s) = 0$。当增益 $K$ 为正实数时，该方程等价于两个独立的条件：幅值条件 $|K G(s)H(s)| = 1$ 和[相角条件](@entry_id:264793) $\angle G(s)H(s) = (2k+1)180^\circ$，其中 $k$ 为任意整数。[相角条件](@entry_id:264793)是绘制[根轨迹](@entry_id:272958)几何形状的基石，它规定了复平面上所有可能成为[闭环极点](@entry_id:274094)的点必须满足的几何约束。

如果[开环传递函数](@entry_id:276280) $G(s)H(s)$ 具有 $M$ 个零点 $z_m$ 和 $N_p$ 个极点 $p_n$，则[相角条件](@entry_id:264793)可以表示为：
$$ \sum_{m=1}^{M} \angle(s-z_m) - \sum_{n=1}^{N_p} \angle(s-p_n) = (2k+1)180^\circ $$
这个方程的几何意义是，从所有开环零点指向 $s$ 点的向量[相角](@entry_id:274491)之和，减去从所有[开环极点](@entry_id:272301)指向 $s$ 点的向量[相角](@entry_id:274491)之和，必须等于 $180^\circ$ 的奇数倍。

### [出射角](@entry_id:264341)的推导与计算

当[根轨迹](@entry_id:272958)从一个[开环极点](@entry_id:272301) $p_j$ 出发时（对应于 $K \to 0^+$），轨迹的初始方向由[出射角](@entry_id:264341) $\theta_d$ 定义。对于[实轴上的极点](@entry_id:191960)，出射方向相对简单。然而，对于复[共轭极点](@entry_id:166341)，其初始运动方向可以是复平面上的任意角度。确定这个角度对于准确绘制[根轨迹](@entry_id:272958)和预测系统初始动态行为至关重要。

为了推导[出射角](@entry_id:264341)，我们考虑一个位于根轨迹上、且无限接近于某个单阶[开环极点](@entry_id:272301) $p_j$ 的点 $s$。我们可以将这个点表示为 $s = p_j + \delta s$，其中 $\delta s$ 是一个幅值极小的[复向量](@entry_id:192851)。我们寻求的正是这个向量 $\delta s$ 的[相角](@entry_id:274491)，即 $\theta_d = \angle(\delta s)$。

我们将 $s = p_j + \delta s$ 代入[相角条件](@entry_id:264793)方程。当 $s \to p_j$ 时，从其他零点 $z_m$ 和极点 $p_n$ ($n \neq j$) 指向 $s$ 的向量近似于指向 $p_j$ 的向量。因此，$\angle(s-z_m) \approx \angle(p_j-z_m)$ 且 $\angle(s-p_n) \approx \angle(p_j-p_n)$。然而，项 $\angle(s-p_j)$ 就是我们要求的[出射角](@entry_id:264341) $\theta_d$。

将这些关系代入[相角条件](@entry_id:264793)：
$$ \sum_{m=1}^{M} \angle(p_j-z_m) - \left( \theta_d + \sum_{\substack{n=1 \\ n \neq j}}^{N_p} \angle(p_j-p_n) \right) = (2k+1)180^\circ $$
通过整理上式，我们可以解出[出射角](@entry_id:264341) $\theta_d$。通常，我们取 $k=0$ 来获得[主值](@entry_id:189577)，并进行必要的 $360^\circ$ 调整，从而得到标准的计算公式：
$$ \theta_d = 180^\circ + \sum_{m=1}^{M} \angle(p_j-z_m) - \sum_{\substack{n=1 \\ n \neq j}}^{N_p} \angle(p_j-p_n) $$
这个公式的推导在根本上依赖于柯西的[幅角原理](@entry_id:164349)，即分析特征方程 $F(s) = 1 + K G(s)$ 在极点 $p_j$ 周围一个无穷小圆上的[相角](@entry_id:274491)变化 [@problem_id:1601529]。

**[出射角](@entry_id:264341)的计算步骤**

计算[出射角](@entry_id:264341)的步骤是系统和明确的：
1.  在 s 平面上标出所有的[开环极点和零点](@entry_id:276317)。
2.  选择一个你希望计算[出射角](@entry_id:264341)的[复极点](@entry_id:274945) $p_j$。
3.  从所有其他[开环极点](@entry_id:272301)和所有开环零点，画向量到该极点 $p_j$。
4.  测量这些向量与正实轴之间的夹角。从零点出发的向量角记为 $\angle(p_j - z_m)$，从其他极点出发的向量角记为 $\angle(p_j - p_n)$。
5.  将这些角度代入上述公式计算 $\theta_d$。

**计算实例**

考虑一个[反馈控制系统](@entry_id:274717)，其[开环传递函数](@entry_id:276280)具有位于 $s = -5$ 的[实轴](@entry_id:148276)极点，一对位于 $s = -2 \pm j3$ 的复[共轭极点](@entry_id:166341)，以及一个位于 $s = -1$ 的零点 [@problem_id:1558180]。我们来计算[根轨迹](@entry_id:272958)从[上半平面](@entry_id:199119)的[复极点](@entry_id:274945) $p_1 = -2 + j3$ 出发的[出射角](@entry_id:264341)。

-   **来自零点 $z_1 = -1$ 的[相角](@entry_id:274491)贡献:**
    向量为 $p_1 - z_1 = (-2 + j3) - (-1) = -1 + j3$。该向量位于第二象限，其角度为 $\arctan\left(\frac{3}{-1}\right) + 180^\circ \approx 108.43^\circ$。

-   **来自实轴极点 $p_2 = -5$ 的[相角](@entry_id:274491)贡献:**
    向量为 $p_1 - p_2 = (-2 + j3) - (-5) = 3 + j3$。该向量位于第一象限，其角度为 $\arctan\left(\frac{3}{3}\right) = 45^\circ$。

-   **来自[共轭极点](@entry_id:166341) $p_3 = -2 - j3$ 的[相角](@entry_id:274491)贡献:**
    向量为 $p_1 - p_3 = (-2 + j3) - (-2 - j3) = 6j$。该向量沿正[虚轴](@entry_id:262618)，其角度为 $90^\circ$。

现在，我们将这些角度代入公式：
$$ \theta_d = 180^\circ + (\text{来自零点的角度}) - (\text{来自其他极点的角度之和}) $$
$$ \theta_d = 180^\circ + 108.43^\circ - (45^\circ + 90^\circ) = 180^\circ + 108.43^\circ - 135^\circ = 153.43^\circ $$
因此，[根轨迹](@entry_id:272958)以大约 $153.43^\circ$ 的角度离开极点 $-2 + j3$。这个方向指向左上方，表明随着增益 $K$ 的微小增加，该[闭环极点](@entry_id:274094)的实部会变得更负，虚部会略微减小。

### [出射角](@entry_id:264341)的物理意义：稳定性分析

[出射角](@entry_id:264341)的计算不仅是绘图练习，它还为我们提供了关于系统性能如何随增益 $K$ 变化的宝贵信息，尤其是在**[相对稳定性](@entry_id:262615)**方面。[闭环极点](@entry_id:274094)的实部决定了系统瞬态响应的衰减速率，而虚部决定了[振荡频率](@entry_id:269468)。

-   **[出射角](@entry_id:264341)指向左半平面 ($90^\circ < \theta_d < 270^\circ$)**: 这意味着当增益 $K$ 从零开始增加时，[闭环极点](@entry_id:274094)将向 s 平面的更深处移动。其负实部[绝对值](@entry_id:147688)增大，导致系统瞬态响应的衰减加快。这通常表示**[相对稳定性](@entry_id:262615)的提高**。例如，在一个具有[开环极点](@entry_id:272301)位于 $-2 \pm 3j$ 和 $-5$，以及一个开环零点位于 $s=1$ 的系统中，从极点 $-2+3j$ 出发的[出射角](@entry_id:264341)计算为 $180^\circ$ [@problem_id:1556488]。这意味着轨迹初始时水平向左移动，极点的实部从 $-2$ 开始变得更负，从而增强了系统的稳定性。

-   **[出射角](@entry_id:264341)指向右半平面 ($-90^\circ < \theta_d < 90^\circ$)**: 这表明[闭环极点](@entry_id:274094)将向[虚轴](@entry_id:262618)方向移动，其负实部[绝对值](@entry_id:147688)减小。这会导致瞬态响应衰减变慢，系统的阻尼减小，即**[相对稳定性](@entry_id:262615)下降**。一个特别值得关注的例子是，当[出射角](@entry_id:264341)为 $0^\circ$ 时 [@problem_id:1558215]，轨迹将水平向右离开[复极点](@entry_id:274945)，直接朝[虚轴](@entry_id:262618)前进，这是一种快速降低稳定性的趋势。

-   **[出射角](@entry_id:264341)指向右半平面（从[虚轴](@entry_id:262618)出发）**: 考虑一个在虚轴上有一对极点 $s = \pm j\omega_n$ 和在[实轴](@entry_id:148276)上有一个稳定极点 $s=-\alpha$ 的系统。这种情况常见于带有无阻尼[谐振模式](@entry_id:266261)的系统，如柔性机械臂。从极点 $s = j\omega_n$ 的[出射角](@entry_id:264341)可以被计算为 $\theta_d = 90^\circ - \arctan(\omega_n/\alpha)$。由于 $\alpha$ 和 $\omega_n$ 均为正数，该角度总是在 $0^\circ$ 和 $90^\circ$ 之间。这意味着对于任何大于零的增益 $K$，[闭环极点](@entry_id:274094)将立即进入右半平面，导致系统不稳定。因此，仅使用[比例控制器](@entry_id:271237)永远无法稳定此类系统 [@problem_id:1558187]。这个结论也可以通过[劳斯-赫尔维茨稳定性判据](@entry_id:267259)得到验证，但[出射角](@entry_id:264341)分析提供了一个更直观的几何解释。

### 对称性、对偶性与扩展

#### [根轨迹的对称性](@entry_id:275090)

对于系数为实数的[传递函数](@entry_id:273897)，其所有复数[极点和零点](@entry_id:262457)都必须以共轭对的形式出现。这导致根轨迹总是关于实[轴对称](@entry_id:173333)。这一性质也适用于[出射角](@entry_id:264341)：如果从上半平面极点 $p = -\alpha + j\beta$ 出发的[出射角](@entry_id:264341)为 $\theta_d$，那么从其[共轭极点](@entry_id:166341) $\bar{p} = -\alpha - j\beta$ 出发的[出射角](@entry_id:264341)必然是 $-\theta_d$ [@problem_id:1617849]。这是因为计算 $-\theta_d$ 所涉及的所有向量都是计算 $\theta_d$ 所用向量的[复共轭](@entry_id:174690)，它们的角度因此互为相反数。

#### 对偶概念：[到达角](@entry_id:265527)

与根轨迹从[开环极点](@entry_id:272301)出发（$K \to 0^+$）相对应，当 $K \to \infty$ 时，[根轨迹](@entry_id:272958)的分支将终止于开环零点（或趋向于无穷远）。轨迹接近一个开环零点 $z_j$ 的角度被称为**[到达角](@entry_id:265527)（angle of arrival）**，记为 $\theta_a$。

[到达角](@entry_id:265527)的推导过程与[出射角](@entry_id:264341)非常相似，同样基于[相角条件](@entry_id:264793)。最终得到的公式为：
$$ \theta_a = 180^\circ - \sum_{\substack{m=1 \\ m \neq j}}^{M} \angle(z_j-z_m) + \sum_{n=1}^{N_p} \angle(z_j-p_n) $$
直观地看，[到达角](@entry_id:265527)的计算是 $180^\circ$ 减去（从其他零点到该零点的向量角之和），再加上（从所有极点到该零点的向量角之和）。

例如，考虑一个由比例-[微分](@entry_id:158718)-加速度（PDA）控制器 $G_c(s) = K(s^2 + 6s + 25)$ 控制的系统 $G_p(s) = \frac{1}{s(s+10)}$。[开环传递函数](@entry_id:276280)为 $L(s) = \frac{K(s^2+6s+25)}{s(s+10)}$。其极点为 $p_1=0, p_2=-10$，零点为 $z_{1,2} = -3 \pm j4$ [@problem_id:1558232]。为了找到到达上半平面零点 $z_1 = -3+j4$ 的[到达角](@entry_id:265527) $\theta_a$：

-   来自极点 $p_1=0$ 的[相角](@entry_id:274491): $\angle(z_1-p_1) = \angle(-3+j4) \approx 126.87^\circ$。
-   来自极点 $p_2=-10$ 的[相角](@entry_id:274491): $\angle(z_1-p_2) = \angle(7+j4) \approx 29.74^\circ$。
-   来自另一零点 $z_2=-3-j4$ 的[相角](@entry_id:274491): $\angle(z_1-z_2) = \angle(8j) = 90^\circ$。

代入公式：
$$ \theta_a = 180^\circ - (90^\circ) + (126.87^\circ + 29.74^\circ) = 246.61^\circ $$
这意味着根轨迹从左下方以大约 $246.61^\circ$ 的角度接近零点 $-3+j4$。

#### [互补根轨迹](@entry_id:271295) ($K  0$)

当增益 $K$ 为负数时，我们绘制的是**[互补根轨迹](@entry_id:271295)**。此时，[特征方程](@entry_id:265849) $1+KG(s)H(s)=0$ 的[相角条件](@entry_id:264793)变为：
$$ \angle G(s)H(s) = k \cdot 360^\circ $$
即总[相角](@entry_id:274491)必须是 $0^\circ$ 或 $360^\circ$ 的整数倍。这导致[出射角](@entry_id:264341)的计算公式发生变化，原公式中的 $180^\circ$ 项消失：
$$ \theta_d (K0) = \sum_{m=1}^{M} \angle(p_j-z_m) - \sum_{\substack{n=1 \\ n \neq j}}^{N_p} \angle(p_j-p_n) $$
例如，对于[开环传递函数](@entry_id:276280) $G(s) = K \frac{s + 3}{s^2 + 2s + 5}$，其极点为 $p_{1,2}=-1 \pm j2$，零点为 $z_1=-3$ [@problem_id:1558224]。当 $K0$ 时，从极点 $p_1=-1+j2$ 的[出射角](@entry_id:264341)为：
$$ \theta_d (K0) = \angle(p_1-z_1) - \angle(p_1-p_2) = \angle(2+2j) - \angle(4j) = 45^\circ - 90^\circ = -45^\circ $$
因此，对于负增益，根轨迹将以 $-45^\circ$ 的角度离开极点 $-1+j2$。

总之，[出射角](@entry_id:264341)和[到达角](@entry_id:265527)是根轨迹方法中不可或缺的精确分析工具。它们不仅帮助我们完善[根轨迹图](@entry_id:264447)的细节，更重要的是，它们提供了对系统动态行为随增益变化的深刻洞察，是评估和改进[控制系统稳定性](@entry_id:170483)的关键一步。