{"hands_on_practices": [{"introduction": "理论学习的最终目的是应用于实践。让我们从一个经典力学系统开始，将线性化技术应用于一个在抛物线轨道上运动的珠子。这个练习将直观地展示非线性系统在其稳定平衡点附近的动态如何可以被简化为我们熟悉的简谐振动模型，从而揭示线性化在分析系统稳定性和小范围振荡中的核心作用。[@problem_id:1590137]", "problem": "一个质量为 $m$ 的小珠子穿在一个弯曲成抛物线形状的光滑金属丝上。在二维笛卡尔坐标系中，金属丝的形状由方程 $y = a x^2$ 给出，其中 $a$ 是一个决定抛物线曲率的正常数，y轴垂直向上。小珠子受到一个大小为 $g$ 的恒定向下重力加速度的作用。该系统在原点 $(x=0, y=0)$ 处有一个稳定平衡点。\n\n为了分析围绕该平衡点的小幅振荡，必须对珠子的非线性动力学进行线性化。找出珠子水平位移 $x$ 的线性化运动方程，并将其表示为标准形式 $\\ddot{x} + kx = 0$。您的任务是确定这个线性化模型中的常数 $k$。", "solution": "我们将珠子建模为一个在竖直平面内受约束于曲线 $y=ax^{2}$ 的质点，并受到大小为 $g$ 的向下重力。使用 $x$ 作为广义坐标，约束条件意味着 $\\dot{y}=2ax\\dot{x}$，因此速度的平方为 $v^{2}=\\dot{x}^{2}+\\dot{y}^{2}=\\dot{x}^{2}\\left(1+4a^{2}x^{2}\\right)$。因此，动能和势能分别为\n$$\nT=\\frac{1}{2}m\\dot{x}^{2}\\left(1+4a^{2}x^{2}\\right),\\qquad U=mg\\,y=mg\\,a x^{2},\n$$\n拉格朗日量为 $L=T-U$。\n\n欧拉-拉格朗日方程 $\\,\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{x}}\\right)-\\frac{\\partial L}{\\partial x}=0\\,$ 给出\n$$\n\\frac{\\partial L}{\\partial \\dot{x}}=m\\dot{x}\\left(1+4a^{2}x^{2}\\right),\\quad\n\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{x}}\\right)=m\\left(1+4a^{2}x^{2}\\right)\\ddot{x}+8ma^{2}x\\dot{x}^{2},\n$$\n$$\n\\frac{\\partial L}{\\partial x}=4ma^{2}x\\dot{x}^{2}-2mgax.\n$$\n因此，精确的运动方程为\n$$\nm\\left(1+4a^{2}x^{2}\\right)\\ddot{x}+4ma^{2}x\\dot{x}^{2}+2mgax=0.\n$$\n对于关于 $x=0$ 的小幅振荡，我们通过只保留 $x$ 和 $\\dot{x}$ 的一阶项来进行线性化。$4ma^{2}x\\dot{x}^{2}$ 和 $4a^{2}x^{2}\\ddot{x}$ 项是高阶项，可以忽略，从而得到\n$$\nm\\ddot{x}+2mgax=0.\n$$\n与 $\\ddot{x}+kx=0$ 比较可得\n$$\nk=2ga.\n$$", "answer": "$$\\boxed{2ga}$$", "id": "1590137"}, {"introduction": "线性化在过程控制工程中扮演着至关重要的角色，它使我们能够分析和控制复杂的工业过程。这个练习模拟了一个向刚性容器中充气的常见场景，其气体流入速率与压力差的平方根成正比，这是一个典型的非线性特性。通过这个问题，你将实践从基本物理原理（理想气体定律和质量守恒）出发建立非线性动态模型，然后围绕一个工作点进行线性化，以预测系统对微小扰动的响应，这正是设计反馈控制器的关键一步。[@problem_id:1590119]", "problem": "考虑一个固定体积 $V$ 的刚性容器，通过一个保持在恒定压力 $P_s$ 的供给管线向其中充入理想气体。在整个过程中，容器内的气体保持在恒定的绝对温度 $T$。该气体的摩尔质量为 $M$，其行为遵循理想气体定律，其中 $R$ 是普适气体常数。\n\n进入容器的气体质量流率 $w_{in}$ 由进口阀两端的压力差决定，并由以下非线性方程描述：\n$$w_{in} = C \\sqrt{P_s - P(t)}$$\n其中 $P(t)$ 是容器内的瞬时压力，$C$ 是一个正常数阀门系数。假设在所有时刻都有 $P(t)  P_s$。\n\n系统的动力学将在额定工作压力 $P_0$ 附近进行线性化。所得的压力偏差 $\\delta P(t) = P(t) - P_0$ 的线性化模型表示为以下一阶线性常微分方程：\n$$\\frac{d(\\delta P)}{dt} = -\\alpha (\\delta P)$$\n试确定正常数 $\\alpha$ 的解析表达式，用给定的系统参数 $C, R, T, V, M, P_s$ 和 $P_0$ 表示。", "solution": "目标是找到容器压力动力学线性化模型中的参数 $\\alpha$。\n\n首先，我们必须推导控制容器内压力 $P(t)$ 的非线性微分方程。出发点是理想气体定律：\n$$P(t)V = n(t)RT$$\n其中 $n(t)$ 是时刻 $t$ 容器中气体的摩尔数。由于体积 $V$、温度 $T$ 和气体常数 $R$ 都是常数，我们可以将此方程对时间求导，以关联压力变化率和摩尔数变化率：\n$$V \\frac{dP}{dt} = RT \\frac{dn}{dt}$$\n\n接下来，我们将摩尔数变化率 $\\frac{dn}{dt}$ 与质量流率 $w_{in}$ 联系起来。摩尔数 $n(t)$ 是容器中气体的总质量 $m(t)$ 除以其摩尔质量 $M$：\n$$n(t) = \\frac{m(t)}{M}$$\n对时间求导得到：\n$$\\frac{dn}{dt} = \\frac{1}{M} \\frac{dm}{dt}$$\n根据定义，质量变化率 $\\frac{dm}{dt}$ 是流入容器的净质量流率。在这种情况下，它就是 $w_{in}$。\n$$\\frac{dm}{dt} = w_{in}$$\n因此，我们有：\n$$\\frac{dn}{dt} = \\frac{w_{in}}{M}$$\n\n现在，我们将 $\\frac{dn}{dt}$ 的这个表达式代回到已求导的理想气体定律方程中：\n$$V \\frac{dP}{dt} = RT \\left( \\frac{w_{in}}{M} \\right)$$\n我们已知质量流率的表达式为 $w_{in} = C \\sqrt{P_s - P(t)}$。将其代入我们的方程，得到关于压力 $P(t)$ 的非线性常微分方程：\n$$V \\frac{dP}{dt} = \\frac{RT}{M} C \\sqrt{P_s - P(t)}$$\n对 $\\frac{dP}{dt}$ 进行整理，我们得到形式为 $\\frac{dP}{dt} = f(P(t))$ 的状态方程：\n$$\\frac{dP}{dt} = \\frac{CRT}{VM} \\sqrt{P_s - P(t)} = f(P(t))$$\n\n为了在工作点 $P_0$ 附近将此非线性系统线性化，我们使用函数 $f(P)$ 在 $P = P_0$ 附近的一阶泰勒级数展开：\n$$f(P) \\approx f(P_0) + \\left. \\frac{df}{dP} \\right|_{P=P_0} (P - P_0)$$\n这意味着 $P(t)$ 在 $P_0$ 附近的动力学可以近似为：\n$$\\frac{dP}{dt} \\approx f(P_0) + \\left. \\frac{df}{dP} \\right|_{P=P_0} (P(t) - P_0)$$\n令压力偏差为 $\\delta P(t) = P(t) - P_0$。由于 $P_0$ 是一个常数，偏差的导数为 $\\frac{d(\\delta P)}{dt} = \\frac{dP}{dt}$。将此代入线性化方程：\n$$\\frac{d(\\delta P)}{dt} \\approx f(P_0) + \\left. \\frac{df}{dP} \\right|_{P=P_0} \\delta P(t)$$\n问题陈述给出了偏差的线性化模型形式为 $\\frac{d(\\delta P)}{dt} = -\\alpha (\\delta P)$。这种形式描述了偏离工作点的扰动如何演化，它由系统的雅可比矩阵决定。比较这两种形式，我们可以将 $-\\alpha$ 等同于雅可比项 $\\left. \\frac{df}{dP} \\right|_{P=P_0}$。\n\n让我们计算 $f(P)$ 对 $P$ 的导数：\n$$f(P) = \\frac{CRT}{VM} (P_s - P)^{1/2}$$\n$$\\frac{df}{dP} = \\frac{d}{dP} \\left[ \\frac{CRT}{VM} (P_s - P)^{1/2} \\right]$$\n使用链式法则：\n$$\\frac{df}{dP} = \\frac{CRT}{VM} \\cdot \\frac{1}{2} (P_s - P)^{-1/2} \\cdot (-1)$$\n$$\\frac{df}{dP} = - \\frac{CRT}{2VM \\sqrt{P_s - P}}$$\n\n现在，我们在工作压力 $P = P_0$ 处计算该导数的值：\n$$\\left. \\frac{df}{dP} \\right|_{P=P_0} = - \\frac{CRT}{2VM \\sqrt{P_s - P_0}}$$\n通过将线性化动力学方程 $\\frac{d(\\delta P)}{dt} = \\left. \\frac{df}{dP} \\right|_{P=P_0} \\delta P$ 与给定模型 $\\frac{d(\\delta P)}{dt} = -\\alpha (\\delta P)$ 进行比较，我们可以直接令 $\\delta P$ 的系数相等：\n$$-\\alpha = - \\frac{CRT}{2VM \\sqrt{P_s - P_0}}$$\n因此，正常数 $\\alpha$ 的表达式为：\n$$\\alpha = \\frac{CRT}{2VM \\sqrt{P_s - P_0}}$$", "answer": "$$\\boxed{\\frac{CRT}{2VM \\sqrt{P_s - P_0}}}$$", "id": "1590119"}, {"introduction": "现代控制理论广泛使用状态空间方法来描述和分析复杂系统。本练习将带你进入一个更贴近实际工程应用的场景：一个带有磁饱和效应的直流电机。由于磁饱和现象，电机的磁通量与励磁电流之间呈非线性关系，这使得系统分析变得复杂。你将通过计算雅可比矩阵，系统地为这个包含两个状态变量（角速度和电枢电流）的机电系统构建一个完整的线性化状态空间模型，这是掌握多变量系统控制设计的基础。[@problem_id:1590116]", "problem": "考虑一台计入磁场饱和效应的独立励磁直流（DC）电机。电机的动态特性由以下方程组描述：\n\n1.  机械动态特性：$J \\frac{d\\omega_m}{dt} = T_m - T_L - B \\omega_m$\n2.  电枢电路动态特性：$L_a \\frac{dI_a}{dt} = V_a - R_a I_a - E_b$\n3.  电磁转矩：$T_m = K \\Phi I_a$\n4.  反电动势（EMF）：$E_b = K \\Phi \\omega_m$\n\n电机的参数为：\n- $J$：转子的转动惯量\n- $B$：粘性摩擦系数\n- $L_a$：电枢电感\n- $R_a$：电枢电阻\n- $K$：电机转矩和反电动势常数\n\n系统的输入是电枢电压 $V_a$ 和励磁电流 $I_f$。负载转矩 $T_L$ 被视为一个恒定的外部扰动。\n\n由于饱和效应，磁场磁通量 $\\Phi$ 是励磁电流 $I_f$ 的非线性函数，由双曲正切函数建模：\n$$ \\Phi(I_f) = k_f \\tanh(c I_f) $$\n其中 $k_f$ 和 $c$ 是表征磁特性的正常数。\n\n系统的状态由状态向量 $\\mathbf{x} = \\begin{pmatrix} \\omega_m \\\\ I_a \\end{pmatrix}$ 定义，其中 $\\omega_m$ 是转子的角速度，$I_a$ 是电枢电流。控制输入向量为 $\\mathbf{u} = \\begin{pmatrix} V_a \\\\ I_f \\end{pmatrix}$。\n\n电机在一个稳态工作点 $(\\mathbf{x}_0, \\mathbf{u}_0)$ 运行，该工作点的特点是恒定的输入 $V_a = V_{a0}$ 和 $I_f = I_{f0}$，从而产生恒定的角速度 $\\omega_m = \\omega_{m0}$ 和恒定的电枢电流 $I_a = I_{a0}$。\n\n确定线性化状态空间模型 $\\dot{\\delta\\mathbf{x}} = A \\delta\\mathbf{x} + B \\delta\\mathbf{u}$ 的状态矩阵 $A$，该模型描述了系统在该工作点附近的小偏差动态。将您的答案表示为一个矩阵，其元素用系统参数 $J, B, L_a, R_a, K, k_f, c$ 和稳态工作励磁电流 $I_{f0}$ 表示。", "solution": "我们从非线性状态方程开始，状态为 $\\omega_{m}$ 和 $I_{a}$，输入为 $V_{a}$ 和 $I_{f}$：\n$$\nJ \\frac{d\\omega_{m}}{dt} = K \\Phi(I_{f}) I_{a} - T_{L} - B \\omega_{m}, \\quad\nL_{a} \\frac{d I_{a}}{dt} = V_{a} - R_{a} I_{a} - K \\Phi(I_{f}) \\omega_{m},\n$$\n其中 $\\Phi(I_{f}) = k_{f} \\tanh(c I_{f})$ 且 $E_{b} = K \\Phi(I_{f}) \\omega_{m}$。\n\n定义状态向量 $\\mathbf{x} = \\begin{pmatrix} \\omega_{m} \\\\ I_{a} \\end{pmatrix}$ 和输入向量 $\\mathbf{u} = \\begin{pmatrix} V_{a} \\\\ I_{f} \\end{pmatrix}$。状态动态可以写成\n$$\n\\dot{\\omega}_{m} = \\frac{1}{J}\\left(K \\Phi(I_{f}) I_{a} - B \\omega_{m} - T_{L}\\right), \\quad\n\\dot{I}_{a} = \\frac{1}{L_{a}}\\left(V_{a} - R_{a} I_{a} - K \\Phi(I_{f}) \\omega_{m}\\right).\n$$\n\n对于在稳态点 $(\\mathbf{x}_{0},\\mathbf{u}_{0}) = \\left(\\begin{pmatrix} \\omega_{m0} \\\\ I_{a0} \\end{pmatrix}, \\begin{pmatrix} V_{a0} \\\\ I_{f0} \\end{pmatrix}\\right)$ 附近的线性化，状态矩阵 $A$ 是在 $(\\mathbf{x}_{0},\\mathbf{u}_{0})$ 处求值的雅可比矩阵 $\\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}$。由于 $\\Phi$ 仅依赖于输入 $I_{f}$，在对状态变量求偏导数时，$\\Phi$ 被视为一个常数，等于 $\\Phi_{0} = \\Phi(I_{f0}) = k_{f} \\tanh(c I_{f0})$。\n\n计算偏导数：\n- 对于 $f_{1}(\\omega_{m}, I_{a}; u) = \\frac{1}{J}\\left(K \\Phi I_{a} - B \\omega_{m} - T_{L}\\right)$，\n$$\n\\frac{\\partial f_{1}}{\\partial \\omega_{m}} = -\\frac{B}{J}, \\quad\n\\frac{\\partial f_{1}}{\\partial I_{a}} = \\frac{K \\Phi_{0}}{J}.\n$$\n- 对于 $f_{2}(\\omega_{m}, I_{a}; u) = \\frac{1}{L_{a}}\\left(V_{a} - R_{a} I_{a} - K \\Phi \\omega_{m}\\right)$，\n$$\n\\frac{\\partial f_{2}}{\\partial \\omega_{m}} = -\\frac{K \\Phi_{0}}{L_{a}}, \\quad\n\\frac{\\partial f_{2}}{\\partial I_{a}} = -\\frac{R_{a}}{L_{a}}.\n$$\n\n因此，线性化的状态矩阵为\n$$\nA = \\begin{pmatrix}\n-\\frac{B}{J}  \\frac{K \\Phi_{0}}{J} \\\\\n-\\frac{K \\Phi_{0}}{L_{a}}  -\\frac{R_{a}}{L_{a}}\n\\end{pmatrix}\n= \\begin{pmatrix}\n-\\frac{B}{J}  \\frac{K k_{f} \\tanh(c I_{f0})}{J} \\\\\n-\\frac{K k_{f} \\tanh(c I_{f0})}{L_{a}}  -\\frac{R_{a}}{L_{a}}\n\\end{pmatrix}.", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{B}{J}  \\frac{K k_{f} \\tanh(c I_{f0})}{J} \\\\\n-\\frac{K k_{f} \\tanh(c I_{f0})}{L_{a}}  -\\frac{R_{a}}{L_{a}}\n\\end{pmatrix}}$$", "id": "1590116"}]}