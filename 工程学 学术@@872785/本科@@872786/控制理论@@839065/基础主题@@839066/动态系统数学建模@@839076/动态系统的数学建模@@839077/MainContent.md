## 引言
动态系统无处不在，从飞机的飞行、化工厂的反应过程，到生态系统的演替和经济市场的波动，它们构成了我们所处世界的复杂脉络。要理解、预测乃至控制这些千变万化的过程，我们必须掌握一种通用的语言来精确描述它们的行为。这个语言就是数学。然而，如何将一个具体的物理、生物或社会现象转化为一组可分析的方程？这正是动态系统[数学建模](@entry_id:262517)所要解决的核心问题。

本文将系统性地引导你掌握这一关键技能。我们将分三步深入探索：首先，在“原理与机制”一章中，我们将学习描述动态系统的两种核心语言——[状态空间表示](@entry_id:147149)法和[传递函数](@entry_id:273897)，并掌握处理[非线性](@entry_id:637147)与[数字控制](@entry_id:275588)等复杂问题的关键技术，如线性化和系统离散化。接着，在“应用与跨学科联系”一章中，我们将展示这些理论如何在工程、物理、生物乃至经济学等多个领域中发挥作用，揭示其背后共通的动态规律。最后，通过“动手实践”环节，你将有机会亲手将理论应用于解决实际的建模问题，从而巩固所学知识。让我们一同开启这段将现实世界抽象为优雅数学模型的旅程。

## 原理与机制

在上一章的引言中，我们认识到动态系统无处不在，从工程、物理到生物和经济，它们构成了我们理解和改变世界的基础。为了对这些系统进行分析、预测和控制，我们必须首先学会使用数学语言来描述它们。本章旨在深入探讨动态系统[数学建模](@entry_id:262517)的核心原理与关键机制。我们将从最基本的概念——状态——出发，逐步学习如何构建和分类系统模型，如何从第一性原理推导控制方程，如何处理复杂的[非线性](@entry_id:637147)行为，以及如何连接连续的物理世界与离散的数字控制领域。

### 动态系统的语言：状态空间与[传递函数](@entry_id:273897)

描述一个动态系统，我们首先要捕捉其“记忆”或历史的精髓。这引出了控制理论中最核心的概念之一：**状态 (state)**。

#### 状态：系统的完整快照

想象一下，要预测一个运动中的球的未来轨迹。仅仅知道它当前的位置是不够的，我们还需要知道它当前的速度。位置和速度这两个量共同构成了系统的 **状态**。一旦我们知道了在某个瞬间 $t_0$ 的状态，并且知道了从此刻起施加于其上的任何外力（即 **输入 (input)**），我们就能唯一地确定其未来的所有运动轨迹。

这个思想可以被严格地定义。一个动态系统的**状态**是在时间 $t_0$ 的一组变量的**最小集合**，记为 $x(t_0)$，它的值与 $t \ge t_0$ 时间段内的输入函数 $u(t)$ 一起，足以唯一地确定系统在所有 $t \ge t_0$ 时间的**输出 (output)** 和未来状态 $x(t)$。这里的关键词是“最小集合”，这意味着[状态变量](@entry_id:138790)中不应包含任何冗余信息。

考虑一个由[微分](@entry_id:158718)-代数方程描述的系统 [@problem_id:2723713]。假设系统由三个内部变量 $z_1, z_2, z_3$ 描述，其动态行为如下：
$$
\dot{z}_1(t) = -z_1(t) + u(t) \\
\dot{z}_2(t) = z_1(t) + u(t) \\
0 = z_3(t) - (z_1(t) + 2 z_2(t))
$$
前两个方程是[微分方程](@entry_id:264184)，描述了变量如何随[时间演化](@entry_id:153943)，这通常与系统中的[储能](@entry_id:264866)元件（如电容、电感、质量块的动能或势能）相对应。第三个方程是一个代数约束，它表明 $z_3$ 并非一个独立的动态变量，而是随时由 $z_1$ 和 $z_2$ 决定。

系统的动态“阶数”或复杂性由独立[微分方程](@entry_id:264184)的数量决定，这里是 2。因此，一个最小[状态向量](@entry_id:154607)的维数应该是 2。显然，选择 $x(t) = \begin{pmatrix} z_1(t)  z_2(t) \end{pmatrix}^\top$ 是一个有效的状态，因为一旦 $z_1(t_0)$ 和 $z_2(t_0)$ 给定，这两个[微分方程](@entry_id:264184)的解就唯一确定了，进而 $z_3(t)$ 也随之确定。这个选择是最小的，因为它的维度是 2。

有趣的是，状态的选择并非唯一。例如，我们也可以选择 $x(t) = \begin{pmatrix} z_1(t)  z_3(t) \end{pmatrix}^\top$。为什么这也是一个有效的状态呢？因为在任意时刻 $t_0$，如果我们知道 $z_1(t_0)$ 和 $z_3(t_0)$，我们就可以通过代数约束解出 $z_2(t_0) = \frac{1}{2}(z_3(t_0) - z_1(t_0))$。这样，我们同样获得了确定未来轨迹所需的初始值 $(z_1(t_0), z_2(t_0))$。由于这个[状态向量](@entry_id:154607)的维度也是 2，它同样是最小的。

相反，如果我们只选择 $z_3(t_0)$ 作为状态，这是不够的。因为它只给出了 $z_1(t_0) + 2z_2(t_0)$ 的值，这是一个关于 $z_1(t_0)$ 和 $z_2(t_0)$ 的[线性方程](@entry_id:151487)，有无穷多组解，无法唯一确定初始状态。而选择 $(z_1, z_2, z_3)$ 虽然是有效的（因为它包含了确定轨迹所需的所有信息），但不是最小的，因为它包含了冗余信息。

#### [状态空间表示](@entry_id:147149)法

有了状态的概念，我们就可以引入一种强大而普适的建模框架——**[状态空间表示](@entry_id:147149)法 (state-space representation)**。对于一大类被称为**线性时不变 (LTI)** 系统，其状态空间模型具有标准形式：
$$
\dot{x}(t) = A x(t) + B u(t) \quad (\text{状态方程}) \\
y(t) = C x(t) + D u(t) \quad (\text{输出方程})
$$
其中：
- $x(t) \in \mathbb{R}^n$ 是 $n$ 维的**状态向量**。
- $u(t) \in \mathbb{R}^m$ 是 $m$ 维的**输入向量**。
- $y(t) \in \mathbb{R}^p$ 是 $p$ 维的**输出向量**。
- $A \in \mathbb{R}^{n \times n}$ 是**状态矩阵 (state matrix)**，描述了系统内部状态之间的相互作用，决定了系统在没有输入时的自然演化。
- $B \in \mathbb{R}^{n \times m}$ 是**输入矩阵 (input matrix)**，描述了外部输入如何影响系统状态。
- $C \in \mathbb{R}^{p \times n}$ 是**输出矩阵 (output matrix)**，描述了如何从系统状态中“读取”我们关心的输出量。
- $D \in \mathbb{R}^{p \times m}$ 是**前馈矩阵 (feedthrough matrix)**，描述了输入是否直接、瞬时地影响输出。

#### [传递函数](@entry_id:273897)表示法

虽然状态空间模型非常全面，但在处理单输入单输出 (SISO) 的 LTI 系统时，另一种[频域](@entry_id:160070)表示法——**[传递函数](@entry_id:273897) (transfer function)**——同样非常流行和方便。[传递函数](@entry_id:273897)的定义是，在**零初始条件** ($x(0)=0$) 下，系统输出的拉普拉斯变换 $Y(s)$ 与输入的[拉普拉斯变换](@entry_id:159339) $U(s)$ 之间的比值。
$$
G(s) = \frac{Y(s)}{U(s)}
$$
我们可以从状态空间模型直接推导出[传递函数](@entry_id:273897) [@problem_id:2723715]。首先，对[状态方程](@entry_id:274378)进行[拉普拉斯变换](@entry_id:159339)，利用[微分性质](@entry_id:275298) $\mathcal{L}\{\dot{x}(t)\} = sX(s) - x(0)$：
$$
sX(s) - x(0) = AX(s) + BU(s)
$$
应用零[初始条件](@entry_id:152863) $x(0)=0$，我们得到：
$$
sX(s) = AX(s) + BU(s)
$$
为了解出 $X(s)$，我们将包含 $X(s)$ 的项移到一边。注意 $s$ 是一个标量，为了进行矩阵运算，我们引入[单位矩阵](@entry_id:156724) $I$：
$$
sIX(s) - AX(s) = BU(s) \implies (sI - A)X(s) = BU(s)
$$
要分离出 $X(s)$，我们需要左乘矩阵 $(sI - A)$ 的逆。这一步仅当 $(sI - A)$ 是可逆矩阵时才有效，即当 $\det(sI - A) \neq 0$ 时。满足 $\det(sI - A) = 0$ 的复数 $s$ 的值正是状态矩阵 $A$ 的[特征值](@entry_id:154894)，它们是系统的极点，对系统动态行为至关重要。假设 $s$ 不是 $A$ 的[特征值](@entry_id:154894)，则：
$$
X(s) = (sI - A)^{-1}BU(s)
$$
接着，对输出方程 $y(t) = Cx(t) + Du(t)$ 进行拉普拉斯变换：
$$
Y(s) = CX(s) + DU(s)
$$
将上面得到的 $X(s)$ 的表达式代入：
$$
Y(s) = C\left[(sI - A)^{-1}BU(s)\right] + DU(s)
$$
最后，提出公因子 $U(s)$：
$$
Y(s) = \left[C(sI - A)^{-1}B + D\right]U(s)
$$
根据定义，我们便得到了从[状态空间到传递函数](@entry_id:268082)的转换公式：
$$
G(s) = C(sI - A)^{-1}B + D
$$
这个公式优雅地连接了时域模型（[状态空间](@entry_id:177074)）和[频域](@entry_id:160070)模型（[传递函数](@entry_id:273897)），是现代控制理论的基石之一。

### 系统的基本属性：线性与[时不变性](@entry_id:198838)

在建立和分析模型时，我们会根据系统的两个基本属性对其进行分类：**线性 (linearity)** 和 **[时不变性](@entry_id:198838) (time-invariance)**。这些属性极大地决定了我们可以使用哪些数学工具来分析它们。

我们可以将一个系统抽象地看作一个算子 $T$，它将输入信号 $u(t)$ 映射到输出信号 $y(t)$，即 $y = T(u)$ [@problem_id:2723746]。

- **线性**：一个系统是线性的，如果它满足**[叠加原理](@entry_id:144649) (superposition principle)**。这意味着对于任意两个输入信号 $u_1, u_2$ 和任意标量 $\alpha, \beta$，系统的响应满足：
  $$
  T(\alpha u_1 + \beta u_2) = \alpha T(u_1) + \beta T(u_2)
  $$
  这个性质意味着，多个输入同时作用于系统产生的总输出，等于每个输入单独作用时产生的输出的加权和。[线性系统](@entry_id:147850)的这一特性使其分析大大简化。

- **[时不变性](@entry_id:198838)**：一个系统是时不变的，如果其行为不随时间的推移而改变。换句话说，如果将输入信号在时间轴上平移 $\tau$，那么输出信号也将产生完全相同的平移，而波形本身不发生任何畸变。如果我们用一个[时移算子](@entry_id:182108) $S_\tau$ 来表示[时间平移](@entry_id:261541)，即 $(S_\tau u)(t) = u(t-\tau)$，那么[时不变性](@entry_id:198838)可以用算子交换律来精确描述：
  $$
  T \circ S_\tau = S_\tau \circ T
  $$
  这意味着“先平移输入再通过系统”和“先通过系统再平移输出”的结果是完全一样的。

根据这两个属性，我们可以将系统分为几类：
- **[线性时不变 (LTI) 系统](@entry_id:178866)**：同时满足线性和[时不变性](@entry_id:198838)。这是控制理论中研究最深入、应用最广泛的一类系统。我们之前讨论的[状态空间模型](@entry_id:137993)和[传递函数](@entry_id:273897)主要就是针对这类系统。
- **线性时变 (LTV) 系统**：系统是线性的，但不满足[时不变性](@entry_id:198838)。这意味着系统的参数可能会随时间变化。一个典型的例子是 $y(t) = t u(t)$。我们可以验证它的线性：$T(\alpha u_1 + \beta u_2)(t) = t[\alpha u_1(t) + \beta u_2(t)] = \alpha(t u_1(t)) + \beta(t u_2(t)) = \alpha T(u_1)(t) + \beta T(u_2)(t)$。但是，它不是时不变的：
  - 对平移后的输入 $u(t-\tau)$ 的响应是：$T(S_\tau u)(t) = t u(t-\tau)$。
  - 对原始输出 $y(t) = t u(t)$ 进行平移得到：$(S_\tau T(u))(t) = (t-\tau)u(t-\tau)$。
  - 由于 $t u(t-\tau) \neq (t-\tau)u(t-\tau)$，该系统是时变的。
- **[非线性系统](@entry_id:168347)**：不满足[线性叠加原理](@entry_id:196987)的系统。例如 $y(t) = u(t)^2$。大多数真实世界的系统在更广泛的操作范围内都是[非线性](@entry_id:637147)的。

### 从第一性原理建立模型

理论框架固然重要，但一个模型的生命力源于它与物理现实的联系。最可靠的模型往往是基于**第一性原理 (first principles)**，如牛顿定律、[能量守恒](@entry_id:140514)、质量守恒等基本物理定律推导出来的。

#### 机械系统：四分之一车辆模型

让我们通过一个经典的汽车工程问题来体验这个过程：**四分之一车辆模型 (quarter-car model)** [@problem_id:1591363]。该模型用于研究车辆悬挂系统对路面不平度的垂直响应。模型包含车身质量 $m$（代表四分之一车重），以及连接车轮与车身的悬挂系统，该系统由一个弹簧（劲度系数为 $k$）和一个阻尼器（阻尼系数为 $c$）组成。

我们设车身相对于其平衡位置的垂直位移为 $x(t)$（输出），路面轮廓的高度为 $y(t)$（输入）。根据[牛顿第二定律](@entry_id:274217)，作用在质量 $m$ 上的合力等于其质量乘以加速度 $\ddot{x}(t)$。力来自于弹簧和阻尼器：
- **弹簧力**：与弹簧的相对形变 $x(t) - y(t)$ 成正比。弹簧对车身施加的恢复力是 $F_k = -k(x(t) - y(t))$。
- **[阻尼力](@entry_id:265706)**：与车身和车轮的相对速度 $\dot{x}(t) - \dot{y}(t)$ 成正比。阻尼器对车身施加的力是 $F_c = -c(\dot{x}(t) - \dot{y}(t))$。

应用牛顿第二定律 $\sum F = m\ddot{x}(t)$：
$$
-k(x(t) - y(t)) - c(\dot{x}(t) - \dot{y}(t)) = m\ddot{x}(t)
$$
整理这个方程，将输出 $x(t)$ 相关的项放在左边，输入 $y(t)$ 相关的项放在右边，我们得到描述系统动态的[微分方程](@entry_id:264184)：
$$
m\ddot{x}(t) + c\dot{x}(t) + kx(t) = c\dot{y}(t) + ky(t)
$$
这个[二阶常微分方程](@entry_id:204212)就是该机械系统的数学模型。为了求[传递函数](@entry_id:273897) $G(s) = X(s)/Y(s)$，我们对该方程进行[拉普拉斯变换](@entry_id:159339)（假设零[初始条件](@entry_id:152863)）：
$$
m(s^2 X(s)) + c(s X(s)) + kX(s) = c(s Y(s)) + kY(s)
$$
分解出 $X(s)$ 和 $Y(s)$：
$$
(ms^2 + cs + k)X(s) = (cs + k)Y(s)
$$
因此，[传递函数](@entry_id:273897)为：
$$
G(s) = \frac{X(s)}{Y(s)} = \frac{cs + k}{ms^2 + cs + k}
$$
这个结果不仅是一个数学表达式，它还蕴含了丰富的物理信息，描述了车辆悬挂如何过滤或放大来自路面的不同频率的[振动](@entry_id:267781)。

#### [热力学系统](@entry_id:188734)：咖啡杯的冷却

建模的原理同样适用于其他物理领域。考虑一个装有热咖啡的杯子冷却过程的建模 [@problem_id:1591364]。我们将咖啡和杯子视为一个整体，其温度为均匀的 $T(t)$，总热容为 $C$。系统通过两种方式散热：
1.  **[对流](@entry_id:141806)**：通过暴露的表面（面积 $A_c$）向周围空气（温度 $T_a$）散热，[热损失](@entry_id:165814)速率为 $h_c A_c (T(t) - T_a)$，其中 $h_c$ 是[对流换热系数](@entry_id:151029)。
2.  **传导**：通过杯底（面积 $A_k$，厚度 $d$）向桌面（温度 $T_s$）散热，[热损失](@entry_id:165814)速率为 $\frac{k A_k}{d} (T(t) - T_s)$，其中 $k$ 是杯子材料的导热系数。

根据**[能量守恒](@entry_id:140514)原理**，系统内部热能的变化率等于净热量流[失速](@entry_id:186882)率的负值。系统内部热能为 $C T(t)$，其变化率为 $C \frac{dT}{dt}$。因此：
$$
C \frac{dT}{dt} = -\left[ h_c A_c (T(t) - T_a) + \frac{k A_k}{d} (T(t) - T_s) \right]
$$
这是一个描述温度 $T(t)$ 随时间变化的[一阶常微分方程](@entry_id:264241)。我们可以将其整理成标准形式 $\frac{dT}{dt} + \alpha T(t) = \beta$：
$$
\frac{dT}{dt} + \left( \frac{h_c A_c + \frac{k A_k}{d}}{C} \right) T(t) = \frac{h_c A_c T_a + \frac{k A_k}{d} T_s}{C}
$$
通过这个模型，我们可以预测咖啡的冷却曲线。这里的系数 $\alpha = \frac{h_c A_c + k A_k/d}{C}$ 具有明确的物理意义：它代表了系统的总导热能力与总[热容](@entry_id:137594)之比，决定了冷却的快慢，即[时间常数](@entry_id:267377)的倒数。

#### 其他领域的建模：电池充电

建模思想的应用范围远不止于此。例如，我们可以对智能手机的充电过程进行建模 [@problem_id:1591390]。电池的**荷电状态 (State-of-Charge, SoC)**，记为 $q(t)$（$0$ 表示空，$1$ 表示满），其变化率正比于[充电电流](@entry_id:267426) $I(t)$，反比于电池总容量 $C_{batt}$：
$$
\frac{dq}{dt} = \frac{I(t)}{C_{batt}}
$$
现代充电策略为了保护电池，通常采用与 SoC 相关的可变电流。一个简化的[线性模型](@entry_id:178302)是 $I(q) = I_{max}(1-q)$，即电池越满，[充电电流](@entry_id:267426)越小。将此代入动态方程：
$$
\frac{dq}{dt} = \frac{I_{max}}{C_{batt}}(1-q)
$$
这是一个变量可分离的[一阶微分方程](@entry_id:173139)。通过积分，我们可以精确计算出从初始电量 $q_0$ 充到目标电量 $q_f$ 所需的时间 $T$：
$$
T = \frac{C_{batt}}{I_{max}}\ln\left(\frac{1-q_0}{1-q_f}\right)
$$
这个例子表明，即使在电化学领域，简单的[微分方程](@entry_id:264184)也能捕捉到关键的动态行为并做出有用的预测。

### [非线性系统的线性化](@entry_id:275116)

尽管我们已经看到[线性模型](@entry_id:178302)在许多情况下的有效性，但现实世界中的绝大多数系统，当工作范围较大时，本质上都是**[非线性](@entry_id:637147) (nonlinear)** 的。例如，单摆的[恢复力矩](@entry_id:261280)正比于 $\sin\theta$ 而不是 $\theta$；[流体阻力](@entry_id:262242)可能与速度的平方成正比。对于[非线性系统](@entry_id:168347)，叠加原理不再适用，分析和控制都变得异常复杂。

一个极其强大的应对策略是**线性化 (linearization)**。其核心思想是：在某个特定的工作点（通常是**[平衡点](@entry_id:272705) (equilibrium point)**）附近，任何平滑的[非线性](@entry_id:637147)函数都可以用一个线性函数来近似。这意味着，对于在[平衡点](@entry_id:272705)附近的小范围扰动，非线性系统的行为可以由一个[LTI系统](@entry_id:271946)来很好地描述。

考虑一个由 $\dot{x} = f(x, u)$ 描述的通用[非线性系统](@entry_id:168347)，其中 $f$ 是一个光滑的向量函数 [@problem_id:2723714]。假设 $(x^*, u^*)$ 是系统的一个[平衡点](@entry_id:272705)，满足 $f(x^*, u^*) = 0$。我们研究系统在这一点附近的微小偏离量，定义为 $\delta x = x - x^*$ 和 $\delta u = u - u^*$。
$$
\dot{x} = \dot{x}^* + \delta \dot{x} \implies \delta \dot{x} = \dot{x} - \dot{x}^* = f(x, u) - f(x^*, u^*) = f(x^* + \delta x, u^* + \delta u) - f(x^*, u^*)
$$
利用[多元函数](@entry_id:145643)的泰勒级数展开，我们将 $f$ 在 $(x^*, u^*)$ 点附近展开：
$$
f(x^* + \delta x, u^* + \delta u) \approx f(x^*, u^*) + \frac{\partial f}{\partial x}\bigg|_{(x^*, u^*)} \delta x + \frac{\partial f}{\partial u}\bigg|_{(x^*, u^*)} \delta u
$$
其中，$\frac{\partial f}{\partial x}$ 和 $\frac{\partial f}{\partial u}$ 是 $f$ 对 $x$ 和 $u$ 的**雅可比矩阵 (Jacobian matrices)**。将此近似代入 $\delta\dot{x}$ 的表达式，并注意到 $f(x^*, u^*) = 0$，我们得到：
$$
\delta \dot{x} \approx A \delta x + B \delta u
$$
其中，线性化后的状态矩阵和输入矩阵分别为：
$$
A = \frac{\partial f}{\partial x}\bigg|_{(x^*, u^*)} \quad \text{和} \quad B = \frac{\partial f}{\partial u}\bigg|_{(x^*, u^*)}
$$
这就是在[平衡点](@entry_id:272705) $(x^*, u^*)$ 附近的**线性化模型**。这个模型的误差与偏离量 $(\delta x, \delta u)$ 的范数的平方成正比，因此当偏离量很小时，该模型非常精确。

#### 示例：单摆的线性化

单摆是展示线性化威力的绝佳例子 [@problem_id:2723730]。一个带有阻尼和控制力矩的单摆的[非线性](@entry_id:637147)[运动方程](@entry_id:170720)为：
$$
\ddot{\theta} + \frac{b}{m \ell^2} \dot{\theta} + \frac{g}{\ell} \sin \theta = \frac{1}{m \ell^2} u
$$
我们选择[状态变量](@entry_id:138790)为 $x = \begin{pmatrix} \theta \\ \dot{\theta} \end{pmatrix} = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}$。[非线性](@entry_id:637147)状态方程为：
$$
\dot{x} = f(x, u) = \begin{pmatrix} x_2 \\ -\frac{g}{\ell} \sin x_1 - \frac{b}{m \ell^2} x_2 + \frac{1}{m \ell^2} u \end{pmatrix}
$$
系统有两个重要的[平衡点](@entry_id:272705)（当 $u=0$ 时）：
1.  **向下稳定[平衡点](@entry_id:272705)**：$\theta = 0$，即 $x_e = \begin{pmatrix} 0 \\ 0 \end{pmatrix}$。
2.  **向上[不稳定平衡](@entry_id:174306)点**：$\theta = \pi$，即 $x_e = \begin{pmatrix} \pi \\ 0 \end{pmatrix}$。

我们计算在任意点 $(x_1, x_2)$ 的雅可比矩阵 $A = \frac{\partial f}{\partial x}$：
$$
A = \begin{pmatrix} 0  1 \\ -\frac{g}{\ell} \cos x_1  -\frac{b}{m \ell^2} \end{pmatrix}
$$
现在，我们在两个不同的[平衡点](@entry_id:272705)处评估这个矩阵：
- **在向下[平衡点](@entry_id:272705) ($x_1=0$) 附近**：$\cos(0) = 1$，线性化后的状态矩阵为：
  $$
  A_{\text{down}} = \begin{pmatrix} 0  1 \\ -\frac{g}{\ell}  -\frac{b}{m \ell^2} \end{pmatrix}
  $$
  这是一个稳定系统的矩阵，其[特征值](@entry_id:154894)具有负实部（对于 $b0$），与我们对悬挂在最低点的单摆的直觉相符。这正是我们进行[小角度近似](@entry_id:145423)时得到的标准谐振子模型。

- **在向上[平衡点](@entry_id:272705) ($x_1=\pi$) 附近**：$\cos(\pi) = -1$，线性化后的状态矩阵为：
  $$
  A_{\text{up}} = \begin{pmatrix} 0  1 \\ \frac{g}{\ell}  -\frac{b}{m \ell^2} \end{pmatrix}
  $$
  这个矩阵有一个正[特征值](@entry_id:154894)，表明系统是不稳定的。任何微小的扰动都会导致单摆从其倒立位置倒下。

这个例子清晰地表明，线性化模型是**局部**的。同一个[非线性系统](@entry_id:168347)在不同的工作点可以展现出截然不同的动态特性，而线性化技术能够精确地捕捉到这些局域行为。

### [连续系统](@entry_id:178397)与离散世界的桥梁：系统离散化

控制理论大多基于连续时间的[微分方程](@entry_id:264184)，但[现代控制系统](@entry_id:269478)几乎全部由数字计算机实现。计算机不能连续地处理信号，而是以固定的时间间隔进行采样和计算。这就要求我们将连续时间模型转换为**离散时间模型 (discrete-time model)**。

假设我们的控制器以一个固定的采样周期 $T_s$ 运行。在每个采样时刻 $k T_s$，控制器读取传感器的值（采样），计算出控制指令，然后通过**[零阶保持器](@entry_id:264751) (Zero-Order Hold, ZOH)** 输出。ZOH 的作用是在下一个采样周期到来之前，将控制输出值保持不变。这意味着在时间区间 $[k T_s, (k+1)T_s)$ 内，输入 $u(t)$ 是一个常数，等于在第 $k$ 步计算出的值 $u[k]$。

我们的任务是，给定一个连续LTI模型 $\dot{x}=Ax+Bu$，找到一个等效的离散模型，它能精确地将系统在采样时刻 $t_k = k T_s$ 的状态 $x[k] = x(k T_s)$ 映射到下一个采样时刻 $t_{k+1} = (k+1)T_s$ 的状态 $x[k+1] = x((k+1)T_s)$ [@problem_id:2723696]。

连续[LTI系统](@entry_id:271946)的解（也称为**变参数公式**）为：
$$
x(t) = e^{A(t-t_0)} x(t_0) + \int_{t_0}^{t} e^{A(t-\tau)} B u(\tau) d\tau
$$
我们令 $t_0 = k T_s$ 和 $t = (k+1)T_s$。在此时间段内，$u(\tau) = u[k]$ 是一个常数。代入公式：
$$
x[k+1] = e^{A T_s} x[k] + \int_{k T_s}^{(k+1)T_s} e^{A((k+1)T_s - \tau)} B u[k] d\tau
$$
由于 $u[k]$ 是常数，可以提到积分号外面。积分部分可以通过变量替换（令 $\sigma = \tau - k T_s$）来简化：
$$
x[k+1] = e^{A T_s} x[k] + \left( \int_{0}^{T_s} e^{A(T_s - \sigma)} B d\sigma \right) u[k]
$$
通过再次换元 $\lambda = T_s - \sigma$，积分可以写成更简洁的形式。最终我们得到离散时间[状态方程](@entry_id:274378)：
$$
x[k+1] = A_d x[k] + B_d u[k]
$$
其中，离散状态矩阵 $A_d$ 和输入矩阵 $B_d$ 分别为：
$$
A_d = e^{A T_s}
$$
$$
B_d = \left( \int_{0}^{T_s} e^{A\tau} d\tau \right) B
$$
- $A_d$ 是连续系统的**[状态转移矩阵](@entry_id:269075)**在时间间隔 $T_s$ 上的取值。它描述了在没有输入的情况下，系统状态如何从一个采样点演化到下一个采样点。
- $B_d$ 描述了在一个[采样周期](@entry_id:265475)内保持不变的输入 $u[k]$ 对下一个时刻状态 $x[k+1]$ 的累积效应。

对于输出方程，由于采样发生在时刻 $k T_s$，我们直接在连续输出方程中代入 $t = k T_s$：
$$
y[k] = y(k T_s) = C x(k T_s) + D u(k T_s) = C x[k] + D u[k]
$$
因此，离散输出方程的矩阵 $C_d=C$ 和 $D_d=D$。

这个ZOH等效模型是**精确**的，它准确地描述了采样点之间的系统行为，而不是一种近似。计算[矩阵指数](@entry_id:139347) $e^{A T_s}$ 及其积分是离散化的核心挑战，在实践中有多种数值方法，包括一个巧妙的技巧是利用[增广矩阵](@entry_id:150523)的指数 [@problem_id:2723696]：
$$
e^{\begin{pmatrix} A  B \\ 0  0 \end{pmatrix} T_s} = \begin{pmatrix} A_d  B_d \\ 0  I \end{pmatrix}
$$

### 超越确定性：随机动态系统建模简介

到目前为止，我们讨论的所有模型都是**确定性 (deterministic)** 的：给定初始[状态和](@entry_id:193625)输入，未来是唯一确定的。然而，许多现实系统都受到不可预测的**随机扰动 (stochastic disturbances)** 的影响。例如，电子电路中的[热噪声](@entry_id:139193)，或飞机飞行时遇到的[湍流](@entry_id:151300)。

一个经典的物理例子是悬浮在液体中的微小颗粒的**布朗运动** [@problem_id:1591360]。如果这个颗粒被一个**光学陷阱**（可等效为一个弹簧力 $-kx$）束缚，其运动可以用**[朗之万方程](@entry_id:144277) (Langevin equation)** 来描述。这是一个修正的[牛顿第二定律](@entry_id:274217)，它同时包含了确定性力和随机力：
$$
m\ddot{x}(t) + \gamma \dot{x}(t) + k x(t) = F_{th}(t)
$$
- $m\ddot{x}(t)$：[惯性力](@entry_id:169104)。
- $\gamma \dot{x}(t)$：流体的粘滞阻力（确定性）。
- $kx(t)$：光学陷阱的恢复力（确定性）。
- $F_{th}(t)$：来自流体[分子碰撞](@entry_id:137334)的随机热力（随机性）。

随机力 $F_{th}(t)$ 通常被建模为**[高斯白噪声](@entry_id:749762) (Gaussian white noise)**，其特点是均值为零，且在任何不同时刻的力都是不相关的。其强度由**涨落-耗散定理 (fluctuation-dissipation theorem)** 决定，该定理将随机力的强度与流体的耗散性质（阻尼系数 $\gamma$）和温度 $T$ 联系起来。

对于这类[随机系统](@entry_id:187663)，我们不再能预测确切的轨迹 $x(t)$，而是转而分析其**统计特性**。例如，我们可以计算位置 $x$ 的**[功率谱密度](@entry_id:141002) (power spectral density)** $S_x(f)$。它描述了粒子位置涨落的能量（[方差](@entry_id:200758)）是如何在不同频率上[分布](@entry_id:182848)的。对于上述受困布朗粒子系统，其功率谱密度为：
$$
S_x(f) = \frac{4\gamma k_B T}{(k - m(2\pi f)^2)^2 + (\gamma 2\pi f)^2}
$$
这个结果可以被实验精确验证，它揭示了微观世界中随机性与确定性规律的深刻联系。虽然[随机系统](@entry_id:187663)建模超出了本章入门范畴，但它展示了[数学建模](@entry_id:262517)这一强大工具如何被扩展到更复杂、更接近现实的场景中。

本章我们从系统状态的基本定义出发，系统地介绍了状态空间和[传递函数](@entry_id:273897)两种核心表示方法，探讨了线性和[时不变性](@entry_id:198838)等基本系统属性，并通过一系列来自不同领域的实例，实践了从第一性原理推导模型的过程。我们还学习了处理[非线性系统](@entry_id:168347)的关键技术——线性化，以及连接连续与离散模型的桥梁——ZOH离散化。最后，我们对随机系统建模进行了初步展望。掌握这些原理和机制，是迈向高级[控制系统分析](@entry_id:261228)与设计的第一步。