## 引言
在数字技术无处不在的今天，从智能手机中的信号处理到工业机器人的精确控制，其核心都离不开对[离散时间系统](@entry_id:263935)的深刻理解。正如[传递函数](@entry_id:273897)和[拉普拉斯变换](@entry_id:159339)是分析[连续时间系统](@entry_id:276553)的基石一样，脉冲[传递函数](@entry_id:273897)与 Z 变换则是我们进入[离散时间系统](@entry_id:263935)世界的钥匙。它提供了一个强大的数学框架，使我们能够对[数字控制系统](@entry_id:263415)和数字信号处理算法的行为进行精确的建模、分析和设计。

然而，工程师和科学家们面临的一个核心挑战是：现实世界中的物理过程大多是连续的，而控制它们的计算机却是离散的。如何在这两个领域之间架起一座可靠的桥梁，将连续的物理规律转化为计算机可以理解和执行的离散算法？这正是脉冲[传递函数](@entry_id:273897)所要解决的关键问题。

本文将系统地引导您掌握脉冲[传递函数](@entry_id:273897)这一核心概念。在“原理与机制”一章中，我们将从基本定义出发，探讨它与[差分方程](@entry_id:262177)的紧密联系，并深入学习如何将连续系统模型精确地离散化。接下来的“应用与跨学科联系”一章将视野拓宽，展示脉冲[传递函数](@entry_id:273897)在[数字信号处理](@entry_id:263660)、[现代控制系统](@entry_id:269478)设计、[系统辨识](@entry_id:201290)乃至[模拟电路](@entry_id:274672)等领域的广泛应用，揭示其在解决实际工程问题中的强大威力。最后，在“动手实践”部分，您将通过具体的计算和设计问题，将理论知识转化为解决实际问题的能力。

## 原理与机制

在[数字控制系统](@entry_id:263415)中，对[离散时间信号](@entry_id:272771)和系统的分析是核心。正如[连续时间系统](@entry_id:276553)可以通过[拉普拉斯变换](@entry_id:159339)和[传递函数](@entry_id:273897)在 $s$ 域中进行分析一样，离散时间系统则利用 Z 变换和脉冲[传递函数](@entry_id:273897)在 $z$ 域中进行描述。本章将深入探讨脉冲[传递函数](@entry_id:273897)的定义、推导方法及其在[系统分析](@entry_id:263805)中的核心作用。

### 脉冲[传递函数](@entry_id:273897)的定义与表示

线性时不变（LTI）[离散时间系统](@entry_id:263935)可以通过[线性常系数差分方程](@entry_id:260895)来描述。脉冲[传递函数](@entry_id:273897)（Pulse Transfer Function），记为 $G(z)$，是描述这种系统动态特性的基本数学模型。它被定义为在零初始条件下，系统输出信号的 Z 变换 $Y(z)$ 与输入信号的 Z 变换 $U(z)$ 之比。

$$
G(z) = \frac{Y(z)}{U(z)}
$$

脉冲[传递函数](@entry_id:273897)是 $z$ 的[有理函数](@entry_id:154279)，它完全刻画了系统的输入-输出关系，并且其形式直接揭示了系统的动态特性，如极点、零点和稳定性。

#### 从差分方程到脉冲[传递函数](@entry_id:273897)

从一个描述系统的差分方程出发，我们可以通过对该方程进行 Z 变换来求得其脉冲[传递函数](@entry_id:273897)。Z 变换的一个关键性质是[时移特性](@entry_id:262410)：对于一个序列 $x(k)$，其 Z 变换为 $X(z)$，则其延迟版本 $x(k-n)$ 的 Z 变换为 $z^{-n}X(z)$（假设初始条件为零）。

让我们考虑一个由以下差分方程描述的[数字滤波器](@entry_id:181052)：

$$
y(k) - 0.8y(k-1) = u(k) + 0.5u(k-1)
$$

其中，$u(k)$ 是输入序列，$y(k)$ 是输出序列。为了找到其脉冲[传递函数](@entry_id:273897)，我们对等式两边进行 Z 变换。利用[时移特性](@entry_id:262410)，我们得到：

$$
Y(z) - 0.8z^{-1}Y(z) = U(z) + 0.5z^{-1}U(z)
$$

将 $Y(z)$ 和 $U(z)$ 分别作为公因子提取出来：

$$
(1 - 0.8z^{-1})Y(z) = (1 + 0.5z^{-1})U(z)
$$

根据脉冲[传递函数](@entry_id:273897)的定义 $G(z) = Y(z)/U(z)$，我们得到：

$$
G(z) = \frac{1 + 0.5z^{-1}}{1 - 0.8z^{-1}}
$$

为了以 $z$ 的正幂次形式表示，我们将分子和分母同乘以 $z$：

$$
G(z) = \frac{z(1 + 0.5z^{-1})}{z(1 - 0.8z^{-1})} = \frac{z + 0.5}{z - 0.8}
$$

这个结果即为该数字滤波器的脉冲[传递函数](@entry_id:273897) [@problem_id:1603561]。这个过程展示了如何系统地将一个时域的[差分方程模型](@entry_id:196159)转换为一个[频域](@entry_id:160070)（$z$ 域）的模型。

#### 从脉冲[传递函数](@entry_id:273897)到差分方程

同样地，这个过程也可以反向进行。给定一个脉冲[传递函数](@entry_id:273897)，我们可以推导出其对应的差分方程。这在实现[数字控制](@entry_id:275588)器或滤波器时至关重要，因为[差分方程](@entry_id:262177)是其在计算机程序中执行的基础。

假设一个离散时间 LTI 系统的脉冲[传递函数](@entry_id:273897)为：

$$
G(z) = \frac{z - 1}{z^{2} - 1.5z + 0.5}
$$

我们首先将 $Y(z) = G(z)U(z)$ 展开：

$$
Y(z) = \frac{z - 1}{z^{2} - 1.5z + 0.5} U(z)
$$

为了得到一个包含延迟项的差分方程形式，通常将 $G(z)$ 表示为 $z^{-1}$ 的多项式。为此，我们将分子和分母同除以 $z$ 的最高次幂，即 $z^2$：

$$
G(z) = \frac{z^{-1} - z^{-2}}{1 - 1.5z^{-1} + 0.5z^{-2}}
$$

代入 $Y(z) = G(z)U(z)$ 中，我们有：

$$
\frac{Y(z)}{U(z)} = \frac{z^{-1} - z^{-2}}{1 - 1.5z^{-1} + 0.5z^{-2}}
$$

[交叉](@entry_id:147634)相乘得到：

$$
(1 - 1.5z^{-1} + 0.5z^{-2})Y(z) = (z^{-1} - z^{-2})U(z)
$$

展开后为：

$$
Y(z) - 1.5z^{-1}Y(z) + 0.5z^{-2}Y(z) = z^{-1}U(z) - z^{-2}U(z)
$$

现在，我们对上式进行逆 Z 变换。利用[时移性质](@entry_id:275667)的逆过程，即 $z^{-n}X(z)$ 对应于时域中的 $x(k-n)$，我们得到：

$$
y(k) - 1.5y(k-1) + 0.5y(k-2) = u(k-1) - u(k-2)
$$

整理后，得到描述系统输入输出关系的[差分方程](@entry_id:262177)：

$$
y(k) = 1.5y(k-1) - 0.5y(k-2) + u(k-1) - u(k-2)
$$

这个方程为系统的实时计算提供了算法基础 [@problem_id:1603529]。

### 连续系统的离散化

在[数字控制](@entry_id:275588)中，我们常常需要控制一个本质上是连续的物理系统（或称“被控对象”）。为了实现数字控制，必须将被控对象的连续时间模型转换为一个等效的离散时间模型，即求出其脉冲[传递函数](@entry_id:273897)。这个过程称为**离散化**。

#### [s平面到z平面的映射](@entry_id:261240)

离散化的核心在于理解[连续时间系统](@entry_id:276553)动态特性与[离散时间系统](@entry_id:263935)动态特性之间的关系。[连续时间系统](@entry_id:276553)的动态行为由其在 $s$ 平面上的[极点位置](@entry_id:271565)决定。一个位于 $s = \sigma + j\omega$ 的极点对应于[时域响应](@entry_id:271891)中的一个模式（mode）$e^{st} = e^{\sigma t}e^{j\omega t}$。

当这个连续信号被以[采样周期](@entry_id:265475) $T$ 进行采样时，得到的离散时间序列为：

$$
x(kT) = e^{s(kT)} = (e^{sT})^k
$$

这个离散序列的形式为 $z^k$，其中 $z = e^{sT}$。这揭示了一个深刻而基本的映射关系：一个位于 $s$ 平面的[连续系统](@entry_id:178397)极点，在经过[采样周期](@entry_id:265475)为 $T$ 的采样后，会映射到 $z$ 平面上的一个位置 $z = e^{sT}$。

例如，一个在 $s=-3$ 处有实数极点的连续系统，如果以 $T = \frac{\ln(2)}{3}$ 秒的周期进行采样，其对应的 $z$ 平面[极点位置](@entry_id:271565)为：

$$
z = \exp(sT) = \exp\left(-3 \cdot \frac{\ln(2)}{3}\right) = \exp(-\ln(2)) = \frac{1}{2}
$$

这个简单的计算 [@problem_id:1603533] 展示了如何将一个稳定的连续极点（位于左半 $s$ 平面）映射到一个稳定的离散极点（位于 $z$ 平面的[单位圆](@entry_id:267290)内部）。

采样周期的选择对离散极点的位置有直接影响。考虑一个连续过程 $G(s) = \frac{1}{s+2}$，其极点位于 $s=-2$。
- 如果[采样周期](@entry_id:265475)为 $T_1 = 0.1$ 秒，则 $z$ 平面极点为 $p_1 = \exp(-2 \times 0.1) = \exp(-0.2) \approx 0.8187$。
- 如果采样周期为 $T_2 = 1.0$ 秒，则 $z$ 平面极点为 $p_2 = \exp(-2 \times 1.0) = \exp(-2) \approx 0.1353$。

可以看到，较短的采样周期（$T_1$）将连续极点映射到离 $z=1$ 点更近的位置，而较长的[采样周期](@entry_id:265475)（$T_2$）则将其映射到离原点更近的位置 [@problem_id:1603519]。这个特性对于理解[采样率](@entry_id:264884)对系统动态行为的影响至关重要。

#### [零阶保持器](@entry_id:264751)的作用与精确离散化

在典型的[数字控制系统](@entry_id:263415)中，[数字控制](@entry_id:275588)器计算出的离散[控制信号](@entry_id:747841)序列 $u(k)$，通过**[数模转换器 (DAC)](@entry_id:269050)** 作用于连续被控对象。DAC 通常被建模为**[零阶保持器](@entry_id:264751) (Zero-Order Hold, ZOH)**。ZOH 的功能是接收一个在时刻 $kT$ 的数值 $u(k)$，并将其作为恒定的连续信号 $u(t) = u(k)$ 保持到下一个采样时刻 $(k+1)T$。

因此，被控对象接收到的实际输入是一个阶梯状的信号。为了得到精确的离散模型，我们需要计算被控对象在 ZOH 输出驱动下的响应。对于一个给定的连续[传递函数](@entry_id:273897) $G_p(s)$，其与 ZOH [串联](@entry_id:141009)后的脉冲[传递函数](@entry_id:273897) $G(z)$ 可以通过以下公式计算：

$$
G(z) = (1 - z^{-1}) \mathcal{Z}\left\{ \mathcal{L}^{-1}\left\{ \frac{G_p(s)}{s} \right\} \right\}
$$

其中 $\mathcal{L}^{-1}$ 表示[拉普拉斯逆变换](@entry_id:198541)，$\mathcal{Z}$ 表示 Z 变换。$\mathcal{L}^{-1}\{G_p(s)/s\}$ 实际上是原系统的单位[阶跃响应](@entry_id:148543)。这个公式的本质是计算系统在每个采样间隔内由恒定输入引起的响应。

**一阶系统示例：** 考虑一个由时间常数 $\tau$ 表征的 RC 低通滤波器，其连续[传递函数](@entry_id:273897)为 $G_p(s) = \frac{1}{\tau s + 1}$。将其与 ZOH 结合，我们可以推导出其脉冲[传递函数](@entry_id:273897)。通过求解其[微分方程](@entry_id:264184)或使用上述公式，可以得到 [@problem_id:1603569]：

$$
G(z) = \frac{1 - \exp(-T_{samp}/\tau)}{z - \exp(-T_{samp}/\tau)}
$$

其中 $T_{samp}$ 是采样周期。

**[二阶系统](@entry_id:276555)示例：** 对于更复杂的系统，如一个由 $G_p(s) = \frac{1}{s^2+3s+2}$ 描述的单轮主动悬挂系统模型，离散化过程遵循相同的原理，但计算会更繁琐 [@problem_id:1603514]。首先对 $\frac{G_p(s)}{s}$ 进行[部分分式展开](@entry_id:265121)，求其[拉普拉斯逆变换](@entry_id:198541)得到系统的[阶跃响应](@entry_id:148543) $g_u(t)$，然后对 $g_u(kT)$ 进行 Z 变换，最后乘以 $(1-z^{-1})$。这个过程虽然复杂，但对于精确建模至关重要。

### 利用脉冲[传递函数](@entry_id:273897)进行[系统分析](@entry_id:263805)

一旦获得了脉冲[传递函数](@entry_id:273897) $G(z)$，我们就可以在 $z$ 域中对系统的特性进行深入分析。

#### 极点与零点

与连续[传递函数](@entry_id:273897)类似，脉冲[传递函数](@entry_id:273897) $G(z)$ 的**极点**是使其分母多项式为零的 $z$ 值，而**零点**是使其分子多项式为零的 $z$ 值。

[极点和零点](@entry_id:262457)的位置决定了系统的所有动态特性。在计算[极点和零点](@entry_id:262457)时，需要注意分子和分母之间可能存在的公因子。这些公因子对应于**可消去的极点-零点对**，它们在[传递函数](@entry_id:273897)中不表现出来。

例如，考虑系统：

$$
G(z) = \frac{z^2 + 0.1z - 0.06}{z^3 - 0.1z^2 - 0.12z}
$$

首先，我们对分子和分母进行[因式分解](@entry_id:150389)。
分子：$z^2 + 0.1z - 0.06 = (z-0.2)(z+0.3)$
分母：$z^3 - 0.1z^2 - 0.12z = z(z^2 - 0.1z - 0.12) = z(z-0.4)(z+0.3)$

因此，[传递函数](@entry_id:273897)可以写作：

$$
G(z) = \frac{(z-0.2)(z+0.3)}{z(z-0.4)(z+0.3)}
$$

我们发现存在一个公因子 $(z+0.3)$。消去后，得到简化的[传递函数](@entry_id:273897)：

$$
G(z) = \frac{z-0.2}{z(z-0.4)}, \quad z \neq -0.3
$$

该系统的有限零点位于 $z=0.2$，有限极点位于 $z=0$ 和 $z=0.4$。$z=-0.3$ 是一个可移除的[奇点](@entry_id:137764)，而不是[系统的极点](@entry_id:261618)或零点 [@problem_id:1603560]。

#### 稳定性分析

对于离散时间 LTI 系统，**有界输入-有界输出 (BIBO) 稳定性**的条件是其所有极点都严格位于 $z$ 平面的**[单位圆](@entry_id:267290)内部**。也就是说，对于所有的极点 $p_i$，都必须满足 $|p_i|  1$。

这个条件的物理解释源于系统的脉冲响应 $h(k)$。一个系统是 BIBO 稳定的，当且仅当其脉冲响应是绝对可和的，即 $\sum_{k=0}^{\infty} |h(k)|  \infty$。系统的脉冲响应由其极点决定的[模式叠加](@entry_id:168041)而成，每个极点 $p_i$ 对应一个模式 $p_i^k$。如果 $|p_i|  1$，则该模式会随着时间 $k$ 的增加而衰减，从而保证了脉冲响应的收敛性。反之，如果任何一个极点 $|p_i| \ge 1$，则对应的模式不会衰减，脉冲响应将不会绝对可和。

考虑一个简单的[一阶系统](@entry_id:147467) $G(z) = \frac{1}{z - a}$，其中 $a$ 为实数。该系统有一个极点在 $z=a$。为了使系统稳定，必须满足 $|a|1$。我们可以通过其脉冲响应 $h(k) = a^{k-1}u(k-1)$ 来验证这一点，该响应的绝对和 $\sum_{k=1}^{\infty} |a|^{k-1}$ 是一个[几何级数](@entry_id:158490)，其收敛的充要条件正是 $|a|1$ [@problem_id:1603536]。

#### 瞬态响应特性

$z$ 平面上的[极点位置](@entry_id:271565)不仅决定了系统的稳定性，还详细刻画了其瞬态响应的形态。

*   **实数极点**：位于正实轴 ($0  p  1$) 的极点产生单调衰减的响应。位于负[实轴](@entry_id:148276) ($-1  p  0$) 的极点产生衰减的[振荡](@entry_id:267781)响应，[振荡频率](@entry_id:269468)为[采样频率](@entry_id:264884)的一半（[奈奎斯特频率](@entry_id:276417)）。
*   **复[共轭极点](@entry_id:166341)**：一对位于 $z = r\exp(\pm j\theta)$ 的复[共轭极点](@entry_id:166341)（其中 $r  1$）会产生一个衰减的正弦[振荡](@entry_id:267781)响应。
    *   极点的**模** $r$ 决定了衰减的速率。$r$ 越接近 0，衰减越快。$r$ 越接近 1，衰减越慢。
    *   极点的**[相角](@entry_id:274491)** $\theta$ 决定了[振荡](@entry_id:267781)的频率。$\theta=0$ 对应直流（无[振荡](@entry_id:267781)），$\theta=\pi$ 对应[奈奎斯特频率](@entry_id:276417)[振荡](@entry_id:267781)。$\theta$ 的值越大，每个样本周期内的[振荡](@entry_id:267781)越快。

例如，一个稳定的离散系统，其[主导极点](@entry_id:275579)是一对位于 $z = 0.9 \exp(\pm j\frac{\pi}{3})$ 的复[共轭极点](@entry_id:166341)。由于极点是复数，[系统响应](@entry_id:264152)将是[振荡](@entry_id:267781)的。由于极点的模是 $|z|=0.9  1$，该[振荡](@entry_id:267781)是衰减的。因此，当系统受到单位阶跃输入时，其输出将表现为**欠阻尼**特性：输出值会围绕其最终的[稳态](@entry_id:182458)值进行[振荡](@entry_id:267781)，且[振荡](@entry_id:267781)幅度随时间逐渐减小，最终收敛 [@problem_id:1603528]。

### 采样效应与混叠

采样过程本身会引入一些重要的现象，其中最著名的是**[混叠](@entry_id:146322) (Aliasing)**。当采样频率不足以捕捉连续信号中的高频分量时，这些高频分量在采样后会“伪装”成低频分量。这种效应同样体现在 $s$ 平面到 $z$ 平面的极点映射上。

由映射关系 $z = e^{sT}$ 可知，多个不同的 $s$ 平面位置可以映射到同一个 $z$ 平面位置。具体来说，如果 $s_1 = \sigma + j\omega$ 映射到 $z_1$，那么所有 $s_k = \sigma + j(\omega + k \frac{2\pi}{T})$（其中 $k$ 为任意整数）都会映射到同一个 $z_1$。

一个特别具有启发性的例子是纯[振荡](@entry_id:267781)系统。考虑一个无阻尼的 MEMS 谐振器，其连续[传递函数](@entry_id:273897)为 $G_p(s) = \frac{\omega_n^2}{s^2 + \omega_n^2}$，极点位于 $s = \pm j\omega_n$。经过采样周期为 $T$ 的采样后，其离散[系统的极点](@entry_id:261618)位于：

$$
z_{1,2} = \exp(\pm j\omega_n T) = \cos(\omega_n T) \pm j\sin(\omega_n T)
$$

通常情况下，这对极点是位于单位圆上的复共轭对，对应于一个持续的离散时间[振荡](@entry_id:267781)。然而，如果[采样周期](@entry_id:265475) $T$ 的选择使得 $\omega_n T$ 是 $\pi$ 的整数倍，即 $T = \frac{k\pi}{\omega_n}$ (其中 $k=1, 2, 3, \dots$)，会发生什么呢？

在这种特殊情况下，$\sin(\omega_n T) = \sin(k\pi) = 0$。于是，离散极点变为：

$$
z_{1,2} = \cos(k\pi) = (-1)^k
$$

这意味着，原本在连续时间域中纯粹[振荡](@entry_id:267781)的系统，在特定的[采样周期](@entry_id:265475)下，其离散模型中的极点会落在[实轴](@entry_id:148276)上（$z=1$ 或 $z=-1$）。系统的[振荡](@entry_id:267781)特性被“[混叠](@entry_id:146322)”或隐藏了。例如，当 $k$ 为偶数时，极点为 $z=1$，离散系统表现为积分器行为；当 $k$ 为奇数时，极点为 $z=-1$，表现为[奈奎斯特频率](@entry_id:276417)的[振荡](@entry_id:267781) [@problem_id:1603521]。这个例子深刻地说明了选择合适的[采样周期](@entry_id:265475)对于保持系统原有动态特性的重要性，也是香农[采样定理](@entry_id:262499)在控制系统中的具体体现。