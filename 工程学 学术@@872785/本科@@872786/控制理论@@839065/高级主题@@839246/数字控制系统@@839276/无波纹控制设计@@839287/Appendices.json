{"hands_on_practices": [{"introduction": "本节的第一个练习将引导你完成最直接的无差拍控制器设计过程。通过为闭环系统设定一个理想的、能在最短时间内稳定下来的目标传递函数，我们可以反向推导出实现该目标所需的控制器。这个练习将让你体验到通过精确抵消系统动态来获得完美响应的强大之处。[@problem_id:1567944]", "problem": "考虑一个数字控制系统，其中被控对象的离散时间传递函数为：\n$$G_p(z) = \\frac{1}{z(z - 0.5)}$$\n需要为该被控对象在单位反馈配置中设计一个传递函数为 $G_c(z)$ 的数字控制器。控制目标是实现对单位阶跃输入的最少拍响应。最少拍响应定义为系统输出在尽可能最少的采样周期内达到其最终稳态值，并在所有后续时间里保持在该值。\n\n确定实现此最少拍响应的控制器传递函数 $G_c(z)$。你的答案应为关于 $z$ 的表达式。", "solution": "给定被控对象的离散时间传递函数\n$$G_{p}(z) = \\frac{1}{z\\left(z - \\frac{1}{2}\\right)}.$$\n在单位反馈中，闭环传递函数为\n$$T(z) = \\frac{Y(z)}{R(z)} = \\frac{G_{c}(z)G_{p}(z)}{1 + G_{c}(z)G_{p}(z)}.$$\n最少拍阶跃响应要求输出在有限个采样时刻内达到其最终值并保持不变。对于一个可以写成带有显式延迟因子 $z^{-1}$ 幂次形式的被控对象，可实现的最小稳定时间等于纯延迟。重写被控对象传递函数以显露延迟：\n$$G_{p}(z) = \\frac{1}{z\\left(z - \\frac{1}{2}\\right)} = \\frac{z^{-2}}{1 - \\frac{1}{2}z^{-1}}.$$\n这表明存在两个采样周期的延迟。为实现单位稳态增益和最小可能稳定时间，闭环传递函数的最少拍选择是\n$$T(z) = z^{-2} = \\frac{1}{z^{2}}.$$\n令环路传递函数为 $L(z) = G_{c}(z)G_{p}(z)$。则\n$$T(z) = \\frac{L(z)}{1+L(z)}.$$\n设 $T(z) = z^{-2}$ 可得\n$$z^{-2} = \\frac{L(z)}{1+L(z)} \\;\\;\\Longrightarrow\\;\\; z^{-2}\\left(1+L(z)\\right) = L(z) \\;\\;\\Longrightarrow\\;\\; z^{-2} = L(z)\\left(1 - z^{-2}\\right).$$\n因此，\n$$L(z) = \\frac{z^{-2}}{1 - z^{-2}} = \\frac{1}{z^{2} - 1}.$$\n因为 $L(z) = G_{c}(z)G_{p}(z)$，求解 $G_{c}(z)$：\n$$G_{c}(z) = \\frac{L(z)}{G_{p}(z)} = \\frac{\\frac{1}{z^{2} - 1}}{\\frac{1}{z\\left(z - \\frac{1}{2}\\right)}} = \\frac{z\\left(z - \\frac{1}{2}\\right)}{z^{2} - 1}.$$\n验证：使用此 $G_{c}(z)$，\n$$L(z) = \\frac{z\\left(z - \\frac{1}{2}\\right)}{z^{2} - 1}\\cdot \\frac{1}{z\\left(z - \\frac{1}{2}\\right)} = \\frac{1}{z^{2} - 1},$$\n所以\n$$T(z) = \\frac{L(z)}{1+L(z)} = \\frac{\\frac{1}{z^{2} - 1}}{1 + \\frac{1}{z^{2} - 1}} = \\frac{1}{z^{2}} = z^{-2},$$\n这对于单位阶跃输入得到 $y[k] = r[k-2]$，即输出在两个采样周期内（由于两个采样周期的延迟，这是可能的最短时间）达到最终值并保持不变。此外，$T(1) = 1$，确保了对阶跃输入的零稳态误差。\n因此，最少拍控制器为\n$$G_{c}(z) = \\frac{z\\left(z - \\frac{1}{2}\\right)}{z^{2} - 1}.$$", "answer": "$$\\boxed{\\frac{z\\left(z-\\frac{1}{2}\\right)}{z^{2}-1}}$$", "id": "1567944"}, {"introduction": "除了直接指定目标传递函数，我们还可以通过配置闭环系统的极点来设计无差拍控制器。这个练习将向你展示如何利用这种方法，即通过调节控制器参数，将所有闭环极点都配置在 z 平面的原点。同时，我们还将考虑实际工程中常见的稳态误差要求，设计一个既能快速响应又无稳态偏差的控制器。[@problem_id:1567986]", "problem": "考虑一个数字控制系统，其被控对象由以下一阶离散时间传递函数描述：\n$$G_p(z) = \\frac{0.8 z^{-1}}{1 - 0.5 z^{-1}}$$\n您的任务是设计一个控制器 $G_c(z)$，其具有通用的比例-积分 (PI) 结构：\n$$G_c(z) = \\frac{s_0 + s_1 z^{-1}}{1 + r_1 z^{-1}}$$\n该闭环系统的设计目标有两个：\n1.  **最速响应**：闭环传递函数 $H_{cl}(z) = \\frac{G_c(z)G_p(z)}{1+G_c(z)G_p(z)}$ 的所有极点都必须位于原点 ($z=0$)。这确保了系统输出能在有限个时间步内稳定到其最终值。\n2.  **零稳态误差**：系统在单位阶跃输入响应下必须表现出零稳态误差。\n\n确定满足这些设计要求的控制器参数 $s_0$、$s_1$ 和 $r_1$ 的数值。您的最终答案应为一组分别对应于 $s_0$、$s_1$ 和 $r_1$ 的三个数值，并按此顺序排列。", "solution": "被控对象和控制器由下式给出\n$$G_p(z)=\\frac{0.8 z^{-1}}{1-0.5 z^{-1}}, \\quad G_c(z)=\\frac{s_{0}+s_{1} z^{-1}}{1+r_{1} z^{-1}}.$$\n开环传递函数为\n$$L(z)=G_c(z)G_p(z)=\\frac{0.8\\left(s_{0}+s_{1} z^{-1}\\right)z^{-1}}{\\left(1+r_{1} z^{-1}\\right)\\left(1-0.5 z^{-1}\\right)}.$$\n单位反馈下的闭环传递函数为\n$$H_{cl}(z)=\\frac{L(z)}{1+L(z)}=\\frac{0.8\\left(s_{0}+s_{1} z^{-1}\\right)z^{-1}}{\\left(1+r_{1} z^{-1}\\right)\\left(1-0.5 z^{-1}\\right)+0.8\\left(s_{0}+s_{1} z^{-1}\\right)z^{-1}}.$$\n因此，关于 $z^{-1}$ 的闭环特征多项式为\n$$D_{cl}(z^{-1})=\\left(1+r_{1} z^{-1}\\right)\\left(1-0.5 z^{-1}\\right)+0.8\\left(s_{0}+s_{1} z^{-1}\\right)z^{-1}.$$\n展开得，\n$$\\left(1+r_{1} z^{-1}\\right)\\left(1-0.5 z^{-1}\\right)=1+\\left(r_{1}-0.5\\right)z^{-1}-0.5 r_{1} z^{-2},$$\n$$0.8\\left(s_{0}+s_{1} z^{-1}\\right)z^{-1}=0.8 s_{0} z^{-1}+0.8 s_{1} z^{-2},$$\n所以\n$$D_{cl}(z^{-1})=1+\\left[r_{1}-0.5+0.8 s_{0}\\right]z^{-1}+\\left[-0.5 r_{1}+0.8 s_{1}\\right]z^{-2}.$$\n\n最速响应要求所有闭环极点都在 $z=0$ 处。将特征方程写成 $z$ 的形式 $z^{2}+d_{1} z+d_{2}=0$，原点处的最速响应意味着 $d_{1}=0$ 和 $d_{2}=0$。等效地，在 $z^{-1}$ 形式下，我们要求 $D_{cl}(z^{-1})$ 中 $z^{-1}$ 和 $z^{-2}$ 的系数为零，且常数项为一。因此，\n$$r_{1}-0.5+0.8 s_{0}=0,$$\n$$-0.5 r_{1}+0.8 s_{1}=0.$$\n\n对单位阶跃输入的零稳态误差要求 $H_{cl}(1)=1$。计算 $H_{cl}(z)$ 在 $z=1$ 处的值，\n$$H_{cl}(1)=\\frac{0.8\\left(s_{0}+s_{1}\\right)}{\\left(1+r_{1}\\right)\\left(1-0.5\\right)+0.8\\left(s_{0}+s_{1}\\right)}.$$\n施加 $H_{cl}(1)=1$ 的条件得出\n$$\\left(1+r_{1}\\right)\\left(0.5\\right)=0 \\quad \\Rightarrow \\quad r_{1}=-1.$$\n\n将 $r_{1}=-1$ 代入最速响应方程：\n$$-1-0.5+0.8 s_{0}=0 \\;\\Rightarrow\\; 0.8 s_{0}=1.5 \\;\\Rightarrow\\; s_{0}=\\frac{15}{8},$$\n$$-0.5(-1)+0.8 s_{1}=0 \\;\\Rightarrow\\; 0.5+0.8 s_{1}=0 \\;\\Rightarrow\\; s_{1}=-\\frac{5}{8}.$$\n\n验证：当 $r_{1}=-1$，$s_{0}=\\frac{15}{8}$，$s_{1}=-\\frac{5}{8}$ 时，\n$$D_{cl}(z^{-1})=1+\\left[-1-0.5+0.8\\cdot\\frac{15}{8}\\right]z^{-1}+\\left[0.5+0.8\\cdot\\left(-\\frac{5}{8}\\right)\\right]z^{-2}=1,$$\n所以 $z^{-1}$ 和 $z^{-2}$ 的系数都为零，将两个极点都置于原点。此外，\n$$H_{cl}(1)=\\frac{0.8\\left(\\frac{15}{8}-\\frac{5}{8}\\right)}{0+0.8\\left(\\frac{10}{8}\\right)}=\\frac{1}{1}=1,$$\n这确保了对单位阶跃输入的零稳态误差。\n\n因此，控制器参数为 $s_{0}=\\frac{15}{8}$，$s_{1}=-\\frac{5}{8}$ 和 $r_{1}=-1$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{15}{8} & -\\frac{5}{8} & -1\\end{pmatrix}}$$", "id": "1567986"}, {"introduction": "理论上的完美设计在现实中常常会遇到挑战，其中最主要的就是模型不确定性。这个练习模拟了一个常见的情景：基于一个不完全精确的系统模型设计的无差拍控制器，在实际应用中未能达到预期效果。你的任务就像一名控制工程师侦探，需要根据观测到的非预期振荡，反向推断出实际系统中未被建模的动态特性，从而深刻理解无差拍控制对模型精度的敏感性。[@problem_id:1567929]", "problem": "一位控制工程师的任务是为一个化工过程设计一个数字控制器。根据初始的系统辨识，该过程被建模为离散时间传递函数：\n$$P_{model}(z) = \\frac{K_m}{z-a}$$\n辨识出的参数为 $a = 0.9$ 和 $K_m = 2.0$。\n\n工程师设计了一个最少拍控制器（deadbeat controller），旨在使闭环系统对参考输入的响应达到最小（一步）镇定时间。因此，从参考信号到被控对象输出的闭环传递函数的设计目标是 $T_{ref}(z) = z^{-1}$。\n\n在将控制器应用于实际物理设备时，工程师观察到系统并未如预期那样镇定。相反，对于任何非零初始条件或扰动，输出都表现出一种持续的、不衰减的正弦振荡，其周期恰好为8个采样间隔。\n\n更详细的分析表明，初始模型是不完整的。实际被控对象的传递函数阶数更高：\n$$P_{actual}(z) = \\frac{K_a}{(z-a)(z-p_u)}$$\n位于 $z=a$ 的极点被正确辨识，但存在一个额外的未建模极点 $z=p_u$ 和一个不同的真实增益常数 $K_a$。\n\n假设控制器完全按照初始模型和最少拍准则进行设计和实现，请确定未建模极点 $p_u$ 的位置，以及实际增益与模型增益之比 $\\gamma = \\frac{K_a}{K_m}$。请以两个精确的解析表达式给出 $p_u$ 和 $\\gamma$ 的最终答案。", "solution": "用于设计的模型是 $P_{model}(z) = \\dfrac{K_{m}}{z-a}$。在单位反馈和控制器 $G_c(z)$ 的情况下，从参考到输出的闭环传递函数为\n$$\nT(z) = \\frac{P_{model}(z) G_c(z)}{1 + P_{model}(z) G_c(z)}.\n$$\n最少拍设计目标是 $T_{ref}(z) = z^{-1}$。令 $L(z) \\equiv P_{model}(z) G_c(z)$。强制令 $T(z) = z^{-1}$，可得\n$$\n\\frac{L(z)}{1 + L(z)} = z^{-1} \\;\\;\\Rightarrow\\;\\; z^{-1} \\bigl(1 + L(z)\\bigr) = L(z) \\;\\;\\Rightarrow\\;\\; z^{-1} = L(z)\\bigl(1 - z^{-1}\\bigr),\n$$\n因此\n$$\nL(z) = \\frac{z^{-1}}{1 - z^{-1}} = \\frac{1}{z - 1}.\n$$\n因此，根据 $P_{model}(z) G_c(z) = \\dfrac{1}{z - 1}$，可以得到为该模型实现 $T_{ref}(z)$ 的控制器：\n$$\nG_c(z) = \\frac{1}{z - 1}\\,\\frac{z - a}{K_{m}} = \\frac{z - a}{K_{m}(z - 1)}.\n$$\n\n实际被控对象是 $P_{actual}(z) = \\dfrac{K_{a}}{(z - a)(z - p_{u})}$。将设计的控制器应用于实际被控对象，得到的实际开环传递函数为\n$$\nL_{actual}(z) = P_{actual}(z) G_c(z) = \\frac{K_{a}}{(z - a)(z - p_{u})}\\,\\frac{z - a}{K_{m}(z - 1)} = \\frac{\\gamma}{(z - p_{u})(z - 1)},\n$$\n其中 $\\gamma \\equiv \\dfrac{K_{a}}{K_{m}}$。\n\n在单位反馈下，闭环特征方程为 $1 + L_{actual}(z) = 0$，即：\n$$\n(z - p_{u})(z - 1) + \\gamma = 0,\n$$\n或者等价地，首一特征多项式为\n$$\nz^{2} - (1 + p_{u}) z + (p_{u} + \\gamma) = 0.\n$$\n\n观测到的周期恰好为8个采样间隔的无阻尼正弦振荡意味着闭环极点位于单位圆上，角度为 $\\theta = \\dfrac{2\\pi}{8} = \\dfrac{\\pi}{4}$，即 $z_{1,2} = \\cos\\!\\bigl(\\tfrac{\\pi}{4}\\bigr) \\pm \\mathrm{j}\\sin\\!\\bigl(\\tfrac{\\pi}{4}\\bigr)$。对于单位圆上的这样一对共轭复数极点，其首一多项式为\n$$\nz^{2} - 2\\cos\\!\\bigl(\\tfrac{\\pi}{4}\\bigr) z + 1 \\;=\\; z^{2} - \\sqrt{2}\\, z + 1.\n$$\n将其与 $z^{2} - (1 + p_{u}) z + (p_{u} + \\gamma)$ 的系数进行匹配，可得\n$$\n1 + p_{u} = \\sqrt{2}, \\qquad p_{u} + \\gamma = 1.\n$$\n求解得，\n$$\np_{u} = \\sqrt{2} - 1, \\qquad \\gamma = 1 - p_{u} = 2 - \\sqrt{2}.\n$$\n若选择 $\\theta = \\dfrac{3\\pi}{4}$，则将意味着 $p_{u} = -1 - \\sqrt{2}$，该点位于单位圆外，与稳定的未建模被控对象极点不一致，因此物理上一致的解如上所示。", "answer": "$$\\boxed{\\begin{pmatrix}\\sqrt{2}-1 & 2-\\sqrt{2}\\end{pmatrix}}$$", "id": "1567929"}]}