{"hands_on_practices": [{"introduction": "LQR 设计的核心在于理解抽象的成本函数权重（$Q$ 和 $R$）与最终系统的具体性能（例如其稳定性和响应速度，由极点位置决定）之间的联系。本练习将为一个最简单的一维系统建立一个直接的定量联系，让你通过求解标量形式的里卡利方程，亲手计算出闭环极点的位置。这有助于你掌握 LQR 的基本代数推导，并直观感受权重参数如何塑造系统动态。[@problem_id:1589492]", "problem": "考虑一个用于描述磁约束系统中粒子偏离不稳定平衡点的简化一维模型，其偏离量为 $x(t)$。该偏离量的动力学由以下线性微分方程描述：\n$$\n\\dot{x}(t) = ax(t) + bu(t)\n$$\n其中 $u(t)$ 是施加到电磁铁上的控制输入电压。参数 $a$ 和 $b$ 是正常数，分别代表系统的固有不稳定性和控制输入的有效性。\n\n为了将粒子稳定在平衡点（$x=0$）处，设计了一个反馈控制器。该控制器的行为是通过使用线性二次调节器（LQR）方法优化性能准则来确定的。这涉及到在无限时间范围内最小化一个成本泛函 $J$，其定义为：\n$$\nJ = \\int_{0}^{\\infty} \\left(q x(t)^2 + r u(t)^2\\right) dt\n$$\n这里，$q$ 和 $r$ 是正常数，分别对状态偏差和控制力进行惩罚。\n\n最优 LQR 控制律是一种状态反馈控制器，其形式为 $u(t) = -Kx(t)$，其中 $K$ 是一个恒定增益。应用此控制器将系统动力学修改为一个稳定的一阶闭环系统，$\\dot{x}(t) = s x(t)$。您的任务是根据物理参数和成本参数 $a, b, q$ 和 $r$ 来确定闭环系统的极点 $s$ 的位置。", "solution": "我们从线性系统 $\\dot{x}(t) = a x(t) + b u(t)$ 和成本 $J = \\int_{0}^{\\infty} \\left(q x(t)^{2} + r u(t)^{2}\\right) dt$ 开始，其中 $a>0$, $b>0$, $q>0$ 且 $r>0$。连续时间 LQR 最优控制律为 $u(t) = -K x(t)$，其中 $K = R^{-1} B^{T} P$，$P$ 是代数 Riccati 方程的唯一半正定稳定解：\n$$\nA^{T} P + P A - P B R^{-1} B^{T} P + Q = 0.\n$$\n在标量情况下，$A=a, B=b, Q=q, R=r$，因此 Riccati 方程变为\n$$\n2 a P - \\frac{b^{2}}{r} P^{2} + q = 0.\n$$\n在 $u=-Kx$ 控制下的闭环系统为 $\\dot{x} = (a - bK) x$，因此其单个极点为\n$$\ns = a - b K = a - \\frac{b^{2}}{r} P.\n$$\n为了用 $a$, $b$, $q$ 和 $r$ 直接表示 $s$，我们将 $P = \\frac{r}{b^{2}}(a - s)$ 代入 Riccati 方程：\n$$\n2 a \\left(\\frac{r}{b^{2}}(a - s)\\right) - \\frac{b^{2}}{r} \\left(\\frac{r}{b^{2}}(a - s)\\right)^{2} + q = 0,\n$$\n化简为\n$$\n\\frac{2 a r}{b^{2}}(a - s) - \\frac{r}{b^{2}}(a - s)^{2} + q = 0.\n$$\n两边乘以 $\\frac{b^{2}}{r}$ 得\n$$\n2 a (a - s) - (a - s)^{2} + \\frac{q b^{2}}{r} = 0.\n$$\n令 $y = a - s$，我们得到二次方程\n$$\ny^{2} - 2 a y - \\frac{q b^{2}}{r} = 0.\n$$\n解出 $y$ 得\n$$\ny = a \\pm \\sqrt{a^{2} + \\frac{q b^{2}}{r}}.\n$$\n由于对于稳定解，$P = \\frac{r}{b^{2}} y$ 必须是非负的，且 $a>0$，我们选择正分支 $y = a + \\sqrt{a^{2} + \\frac{q b^{2}}{r}}$。因此，\n$$\ns = a - y = a - \\left(a + \\sqrt{a^{2} + \\frac{q b^{2}}{r}}\\right) = - \\sqrt{a^{2} + \\frac{q b^{2}}{r}}.\n$$\n这是一个负实数极点，确保了闭环系统的稳定性。", "answer": "$$\\boxed{-\\sqrt{a^{2}+\\frac{q b^{2}}{r}}}$$", "id": "1589492"}, {"introduction": "在学会计算极点之后，我们现在通过一个思想实验来建立直观理解。本练习探讨当我们将控制权重 $R$ 设为无穷大，使得控制动作的成本变得极其昂贵时，系统会发生什么。这个练习揭示了 LQR 的一个基本设计哲学：控制器总是在我们定义的成本函数所体现的“性能”与“代价”之间做出最优权衡。[@problem_id:1589454]", "problem": "考虑一个标量、线性时不变 (LTI) 系统，其状态空间方程描述为：\n$$\n\\dot{x}(t) = A x(t) + B u(t)\n$$\n其中 $x(t)$ 是状态，$u(t)$ 是控制输入，$A$ 和 $B$ 是非零实数标量常数。已知该系统是开环稳定的。\n\n使用线性二次调节器 (LQR) 框架设计了一个形式为 $u(t) = -Kx(t)$ 的状态反馈控制器。选择控制器增益 $K$ 以最小化无限时域二次代价函数：\n$$\nJ = \\int_{0}^{\\infty} \\left( Q x(t)^2 + R u(t)^2 \\right) dt\n$$\n其中 $Q$ 和 $R$ 是正常数标量权重因子 ($Q > 0, R > 0$)。该设计产生了一个闭环系统 $\\dot{x}(t) = (A - BK)x(t)$。\n\n确定当控制权重参数 $R$ 趋于无穷大时，该闭环系统的单个极点的渐近位置。用系统参数 $A$ 表示你的答案。", "solution": "我们有标量连续时间 LQR 问题，其动态方程为 $\\dot{x}(t) = A x(t) + B u(t)$，状态反馈为 $u(t) = -K x(t)$，旨在最小化\n$$\nJ = \\int_{0}^{\\infty} \\left( Q x(t)^{2} + R u(t)^{2} \\right) dt,\n$$\n其中 $Q>0$ 且 $R>0$。最优增益为 $K = R^{-1} B P$，其中 $P$ 是代数 Riccati 方程的解\n$$\nA^{T} P + P A - P B R^{-1} B^{T} P + Q = 0.\n$$\n对于标量，$A^{T} = A$ 且 $B^{T} = B$，因此 ARE 变为\n$$\n2 A P - \\frac{B^{2}}{R} P^{2} + Q = 0.\n$$\n闭环极点为\n$$\n\\lambda(R) = A - B K = A - \\frac{B^{2}}{R} P.\n$$\n当 $R \\to \\infty$ 时，我们分析 ARE。由于 $R^{-1} \\to 0$，含有 $R^{-1}$ 的项在极限情况下消失，任何极限点 $P_{\\infty}$ 都必须满足 Lyapunov 方程\n$$\n2 A P_{\\infty} + Q = 0.\n$$\n求解可得\n$$\nP_{\\infty} = -\\frac{Q}{2 A}.\n$$\n因为系统是开环稳定的，所以 $A < 0$，因此 $P_{\\infty}>0$ 且为有限值。因此，\n$$\n\\lim_{R \\to \\infty} K = \\lim_{R \\to \\infty} \\frac{B}{R} P = 0,\n$$\n且闭环极点趋向于\n$$\n\\lim_{R \\to \\infty} \\lambda(R) = A - \\lim_{R \\to \\infty} \\frac{B^{2}}{R} P = A.\n$$\n因此，当 $R \\to \\infty$ 时，单个闭环极点的渐近位置是 $A$。", "answer": "$$\\boxed{A}$$", "id": "1589454"}, {"introduction": "本练习将探讨与上一个问题相反的极端情况，帮助你更全面地理解LQR的权衡机制。通过让状态权重 $Q$ 趋近于零，我们实际上是在告诉控制器“只要系统稳定，你可以容忍任何大小的状态误差”。这个练习将清晰地展示 LQR 如何实现“最小干预”原则，即在保证稳定性的前提下，施加最“经济”的控制，这也将其与极点配置和系统稳定性的概念联系起来。[@problem_id:1589491]", "problem": "考虑一个由以下状态空间方程描述的标量、连续时间线性时不变（LTI）系统：\n$$\n\\dot{x}(t) = ax(t) + bu(t)\n$$\n其中 $x(t) \\in \\mathbb{R}$ 是状态，$u(t) \\in \\mathbb{R}$ 是控制输入，$a, b$ 是实常数且 $b \\neq 0$。\n\n设计了一个形式为 $u(t) = -Kx(t)$ 的控制律，以最小化与线性二次调节器（LQR）问题相关的无穷时域二次代价函数：\n$$\nJ = \\int_{0}^{\\infty} (Qx^{2}(t) + Ru^{2}(t)) \\,dt\n$$\n其中 $Q$ 和 $R$ 是正常数加权因子。应用此控制律会得到一个具有单个极点的稳定闭环系统。\n\n当状态加权因子 $Q$ 从正方向趋近于零时（即 $Q \\to 0^{+}$），确定此闭环极点的位置。请用系统参数 $a$ 和 $b$ 的符号表达式来表示你的答案。", "solution": "线性二次调节器（LQR）问题的解法是，找到一个状态反馈增益 $K$，使得控制律 $u(t) = -Kx(t)$ 能够最小化给定的代价函数。增益 $K$ 通过求解代数黎卡提方程（ARE）来确定。\n\n对于一个通用的LTI系统 $\\dot{x} = Ax + Bu$ 和代价函数 $J = \\int_{0}^{\\infty} (x^T Q x + u^T R u) \\,dt$，连续时间ARE由下式给出：\n$$\nA^T P + PA - PBR^{-1}B^T P + Q = 0\n$$\n其中 $P$ 是一个对称半正定矩阵。最优反馈增益则通过 $K = R^{-1}B^T P$ 计算得出。\n\n在这个具体问题中，系统是标量的。矩阵和向量都变成了标量：\n- $A = a$\n- $B = b$\n- $Q = Q$ (一个正常数)\n- $R = R$ (一个正常数)\n- $P = P$ (一个正常数)\n\n将这些代入ARE，我们得到：\n$$\naP + Pa - P b R^{-1} b P + Q = 0\n$$\n$$\n2aP - \\frac{b^2}{R}P^2 + Q = 0\n$$\n这是一个关于 $P$ 的二次方程。将其整理成标准形式：\n$$\n\\left(\\frac{b^2}{R}\\right)P^2 - 2aP - Q = 0\n$$\n我们可以使用二次公式 $P = \\frac{-(-2a) \\pm \\sqrt{(-2a)^2 - 4(\\frac{b^2}{R})(-Q)}}{2(\\frac{b^2}{R})}$ 来求解 $P$：\n$$\nP = \\frac{2a \\pm \\sqrt{4a^2 + \\frac{4b^2Q}{R}}}{\\frac{2b^2}{R}}\n$$\n$$\nP = \\frac{R}{b^2} \\left( a \\pm \\sqrt{a^2 + \\frac{b^2Q}{R}} \\right)\n$$\n对于LQR问题，解 $P$ 必须是半正定的，对于标量而言，这意味着 $P \\ge 0$。项 $\\sqrt{a^2 + \\frac{b^2Q}{R}}$ 总是大于或等于 $\\sqrt{a^2} = |a|$。\n- 如果我们选择负号，$P = \\frac{R}{b^2} (a - \\sqrt{a^2 + \\frac{b^2Q}{R}})$。由于 $\\sqrt{a^2 + \\frac{b^2Q}{R}} > |a| \\ge a$，括号内的项总是负的。因此，这个选择会得到一个负的 $P$，这不是一个有效的解。\n- 因此，我们必须选择正号以确保 $P \\ge 0$：\n$$\nP = \\frac{R}{b^2} \\left( a + \\sqrt{a^2 + \\frac{b^2Q}{R}} \\right)\n$$\n现在，我们可以求出最优增益 $K$。对于标量情况，公式 $K = R^{-1}B^T P$ 变为 $K = R^{-1} b P = \\frac{b}{R}P$。\n代入 $P$ 的表达式：\n$$\nK = \\frac{b}{R} \\left[ \\frac{R}{b^2} \\left( a + \\sqrt{a^2 + \\frac{b^2Q}{R}} \\right) \\right]\n$$\n$$\nK = \\frac{1}{b} \\left( a + \\sqrt{a^2 + \\frac{b^2Q}{R}} \\right)\n$$\n闭环系统由 $\\dot{x}(t) = ax(t) + bu(t) = ax(t) + b(-Kx(t)) = (a-bK)x(t)$ 描述。闭环极点的位置，我们称之为 $p_{cl}$，是闭环系统矩阵的特征值，即 $(a-bK)$。\n$$\np_{cl} = a - bK\n$$\n代入 $K$ 的表达式：\n$$\np_{cl} = a - b \\left[ \\frac{1}{b} \\left( a + \\sqrt{a^2 + \\frac{b^2Q}{R}} \\right) \\right]\n$$\n$$\np_{cl} = a - \\left( a + \\sqrt{a^2 + \\frac{b^2Q}{R}} \\right)\n$$\n$$\np_{cl} = -\\sqrt{a^2 + \\frac{b^2Q}{R}}\n$$\n问题要求的是当 $Q \\to 0^+$ 时该极点的位置。由于表达式在 $Q=0$ 处是连续的，我们可以通过直接代入来计算这个极限。\n$$\n\\lim_{Q \\to 0^+} p_{cl} = \\lim_{Q \\to 0^+} \\left( -\\sqrt{a^2 + \\frac{b^2Q}{R}} \\right)\n$$\n$$\n\\lim_{Q \\to 0^+} p_{cl} = -\\sqrt{a^2 + 0} = -\\sqrt{a^2}\n$$\n$a^2$ 的平方根是 $a$ 的绝对值，记为 $|a|$。\n$$\n\\lim_{Q \\to 0^+} p_{cl} = -|a|\n$$\n这个结果与 $R$ 和 $b$ 无关。它表明，当对状态的惩罚趋于零时，闭环极点移动到 $-|a|$。如果原系统是稳定的（$a < 0$），极点移动到 $a = -|a|$，这意味着控制器变得不活跃。如果原系统是不稳定的（$a > 0$），极点移动到 $-a = -|a|$，这意味着控制器通过将极点沿虚轴反射来稳定系统。", "answer": "$$\\boxed{-|a|}$$", "id": "1589491"}]}