## 引言
正定函数是数学，特别是控制理论和优化领域中的一个基石性概念。它为我们提供了一种严谨的方式来刻画“能量”或“范数”等在原点达到唯一最小值的函数。在分析复杂动态系统的行为时，我们常常面临一个挑战：如何在不直接求解系统[微分方程](@entry_id:264184)的情况下，判断其[平衡点](@entry_id:272705)是否稳定？正定函数正是解决这一问题的关键工具，它构成了著名的[李雅普诺夫稳定性理论](@entry_id:177166)的核心。

本文将带领读者系统地学习正定函数的理论与应用。在第一部分“原理与机制”中，我们将从正定函数的基本定义和几何直观出发，详细探讨其最重要的特例——二次型函数，并掌握使用[西尔维斯特准则](@entry_id:150939)和[特征值](@entry_id:154894)等方法进行判别的技巧。接着，在“应用与交叉学科联系”部分，我们将见证这一理论的强大威力，探索它如何作为李雅普诺夫函数应用于控制系统的稳定性分析与设计，并进一步了解其在[优化理论](@entry_id:144639)和现代机器学习[核方法](@entry_id:276706)中的深刻联系。最后，“动手实践”部分将提供一系列精心设计的问题，帮助您巩固所学知识，将理论应用于具体计算。通过本文的学习，您将对正定函数建立起一个从理论基础到实践应用的完整认知框架。

## 原理与机制

在引言之后，我们现在深入探讨正定函数的核心原理与机制。理解这些概念对于应用[李雅普诺夫稳定性理论](@entry_id:177166)至关重要。本节将从正定函数的基本定义出发，逐步建立其几何直观，探讨其在二次型函数中的具体表现，并介绍相关的概念及性质。

### 正定函数的定义与基本示例

在[控制系统分析](@entry_id:261228)中，我们经常处理描述系统状态的标量函数。其中一类特别重要的函数是**正定函数 (positive definite functions)**。

一个定义在包含原点的域 $D \subset \mathbb{R}^n$ 上的连续标量函数 $V(\mathbf{x})$，如果满足以下两个条件，则被称为**正定函数**：

1.  $V(\mathbf{x}) = 0$ 当且仅当 $\mathbf{x} = \mathbf{0}$ （即状态向量为[零向量](@entry_id:156189)）。
2.  对于所有非零[状态向量](@entry_id:154607) $\mathbf{x} \in D$ 且 $\mathbf{x} \neq \mathbf{0}$，恒有 $V(\mathbf{x}) > 0$。

第一个条件确立了函数在原点处取其唯一的最小值零。第二个条件则保证了函数在原点之外的任何地方都取严格的正值。这两个条件共同刻画了一种“碗状”的函数形态，其“碗底”恰好在[坐标系](@entry_id:156346)的原点。

值得注意的是，[正定性](@entry_id:149643)的定义并不要求函数在所有点都可微。例如，考虑一个二维系统，其状态为 $\mathbf{x} = \begin{pmatrix} x_1  x_2 \end{pmatrix}^T$，我们考察候选函数 $V(x_1, x_2) = 2|x_1| + 3|x_2|$。[@problem_id:1600837] 首先，当 $\mathbf{x} = \mathbf{0}$ 时，$V(0, 0) = 2|0| + 3|0| = 0$。其次，如果 $V(x_1, x_2) = 0$，由于 $|x_1| \ge 0$ 和 $|x_2| \ge 0$ 且系数 $2$ 和 $3$ 均为正，这必然要求 $|x_1|=0$ 且 $|x_2|=0$，即 $x_1=0$ 且 $x_2=0$。因此，$V(\mathbf{x})=0$ 当且仅当 $\mathbf{x}=\mathbf{0}$。最后，对于任何非零向量 $\mathbf{x} \neq \mathbf{0}$，至少有一个分量不为零，这意味着 $V(x_1, x_2)$ 是一个或两个正数的和，故 $V(x_1, x_2) > 0$。因此，尽管该函数在坐标轴上（例如原点）不可微，它仍然满足正定函数的所有条件。

正定函数的概念也不局限于多项式或[绝对值函数](@entry_id:160606)。考虑一个单状态变量系统 $x \in \mathbb{R}$，其候选函数为 $V(x) = \exp(x^2) - 1$。[@problem_id:1600818] 我们来检验其正定性。首先，在原点处，$V(0) = \exp(0^2) - 1 = 1 - 1 = 0$。其次，对于任何非零的 $x$，我们有 $x^2 > 0$。由于[指数函数](@entry_id:161417) $\exp(t)$ 是一个严格单调递增的函数，当 $t > 0$ 时 $\exp(t) > \exp(0) = 1$。因此，对于所有 $x \neq 0$，$V(x) = \exp(x^2) - 1 > 0$。该函数满足[正定性](@entry_id:149643)的两个条件，是一个有效的正定函数。

### [正定性](@entry_id:149643)的几何直观：水平集

除了代数定义，正定函数还有一个非常强烈的几何解释，这有助于我们直观地理解其性质。我们可以通过考察函数的**水平集 (level sets)** 来实现这一点。一个函数 $V(\mathbf{x})$ 的水平集是指所有满足 $V(\mathbf{x}) = c$ 的点 $\mathbf{x}$ 的集合，其中 $c$ 是一个常数。

对于一个正定函数，其[水平集](@entry_id:751248) $V(\mathbf{x}) = c$（对于任意正常数 $c$）具有一个显著的几何特征：它们是一族嵌套的、包围原点的封闭[曲面](@entry_id:267450)。[@problem_id:1600817] 随着常数 $c$ 逐渐趋近于零，这些封闭[曲面](@entry_id:267450)也相应地“收缩”并最终汇集到原点。原点本身可以被看作是 $c=0$ 时的退化[水平集](@entry_id:751248)。

让我们以一个二次型函数 $V(x_1, x_2) = x_1^2 - 2x_1x_2 + 3x_2^2$ 为例。通过[配方法](@entry_id:265480)，我们可以将其重写为：
$V(x_1, x_2) = (x_1^2 - 2x_1x_2 + x_2^2) + 2x_2^2 = (x_1 - x_2)^2 + 2x_2^2$
从这个形式可以清楚地看出，$V(0,0)=0$，并且只要 $(x_1, x_2) \neq (0,0)$，$V(x_1, x_2)$ 就是两个非负项的和（其中至少有一项为正），因此 $V(x_1, x_2) > 0$。所以该函数是正定的。

它的水平集由方程 $(x_1 - x_2)^2 + 2x_2^2 = c$ 定义。对于每一个 $c > 0$，这个方程都描述了一个在 $x_1x_2$ 平面上的椭圆。这些椭圆都以原点为中心，并且随着 $c$ 的减小而收缩。这种嵌套的、围绕原点的椭圆族，就是该函数正定性的几何体现。反之，如果一个函数的水平集是[双曲线](@entry_id:174213)或者不包围原点的抛物线，那么它通常不是正定函数。

### 二次型函数：一种重要的特例

在控制理论中，一类特别常见且极其重要的函数是**二次型函数 (quadratic form functions)**。对于[状态向量](@entry_id:154607) $\mathbf{x} \in \mathbb{R}^n$，二次型函数具有一般形式 $V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}$，其中 $\mathbf{x}$ 是一个列向量，$\mathbf{x}^T$ 是其转置（一个行向量），而 $P$ 是一个 $n \times n$ 的[实对称矩阵](@entry_id:192806)。

二次型函数的[正定性](@entry_id:149643)完全由矩阵 $P$ 的性质决定。具体来说，**二次型函数 $V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}$ 是正定的，当且仅当其对应的[对称矩阵](@entry_id:143130) $P$ 是一个正定矩阵**。因此，判断一个二次型函数是否正定，等价于判断其[关联矩阵](@entry_id:263683) $P$ 是否正定。幸运的是，我们有几种成熟的代数方法来检验矩阵的正定性。

#### 通过[西尔维斯特准则](@entry_id:150939)检验

检验[对称矩阵](@entry_id:143130)[正定性](@entry_id:149643)的一个经典方法是**[西尔维斯特准则](@entry_id:150939) (Sylvester's criterion)**。该准则指出，一个 $n \times n$ 的[对称矩阵](@entry_id:143130) $P$ 是正定的，当且仅当它的所有**主顺序子式 (leading principal minors)** 均为正。主顺序子式是由矩阵左上角 $k \times k$ 子[矩阵的行列式](@entry_id:148198)构成的，记为 $\Delta_k$，其中 $k=1, 2, \dots, n$。

对于一个 $2 \times 2$ 的对称矩阵 $P = \begin{pmatrix} p_{11}  p_{12} \\ p_{12}  p_{22} \end{pmatrix}$，我们需要检验：
1.  一阶主顺序子式： $\Delta_1 = p_{11} > 0$
2.  二阶主顺序子式： $\Delta_2 = \det(P) = p_{11}p_{22} - p_{12}^2 > 0$

例如，考虑矩阵 $P = \begin{pmatrix} 2  -1 \\ -1  2 \end{pmatrix}$。我们有 $\Delta_1 = 2 > 0$ 和 $\Delta_2 = (2)(2) - (-1)^2 = 3 > 0$。两个主顺序子式都为正，因此该矩阵是正定的，对应的函数 $V(\mathbf{x}) = 2x_1^2 - 2x_1x_2 + 2x_2^2$ 也是正定的。[@problem_id:1600795]

对于更高维的矩阵，原理是相同的。例如，对于 $3 \times 3$ 的矩阵 $P = \begin{bmatrix} 3  1  1 \\ 1  2  1 \\ 1  1  3 \end{bmatrix}$，我们需要计算三个主顺序子式：[@problem_id:1600813]
$\Delta_1 = 3 > 0$
$\Delta_2 = \det \begin{pmatrix} 3  1 \\ 1  2 \end{pmatrix} = (3)(2) - (1)(1) = 5 > 0$
$\Delta_3 = \det(P) = 3(2 \cdot 3 - 1 \cdot 1) - 1(1 \cdot 3 - 1 \cdot 1) + 1(1 \cdot 1 - 2 \cdot 1) = 3(5) - 1(2) + 1(-1) = 12 > 0$
由于所有主顺序子式都严格为正，矩阵 $P$ 是正定的，因此函数 $V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}$ 也是正定的。

#### 通过[特征值](@entry_id:154894)检验

检验矩阵[正定性](@entry_id:149643)的另一个等价且强大的方法是检查其**[特征值](@entry_id:154894) (eigenvalues)**。一个对称矩阵是正定的，当且仅当它的所有[特征值](@entry_id:154894)都严格为正。

这个准则提供了一个深刻的物理和几何洞察。对于[对称矩阵](@entry_id:143130) $P$，其二次型 $\mathbf{x}^T P \mathbf{x}$ 在单位球面 $\|\mathbf{x}\|=1$ 上的取值范围恰好被其最小和最大[特征值](@entry_id:154894)所限定。这就是著名的[瑞利商](@entry_id:137794) (Rayleigh quotient) 定理：
$\lambda_{\min} \|\mathbf{x}\|^2 \le \mathbf{x}^T P \mathbf{x} \le \lambda_{\max} \|\mathbf{x}\|^2$
其中 $\lambda_{\min}$ 和 $\lambda_{\max}$ 分别是 $P$ 的最小和最大[特征值](@entry_id:154894)。

从这个不等式可以清楚地看到，如果 $\lambda_{\min} > 0$，那么对于任何非零向量 $\mathbf{x}$，$\mathbf{x}^T P \mathbf{x}$ 必然大于零，从而函数是正定的。反之，如果函数是正定的，那么沿[最小特征值](@entry_id:177333)对应[特征向量](@entry_id:151813)方向的二次型值必须为正，从而 $\lambda_{\min}$ 必须为正。

例如，假设一个 $2 \times 2$ [对称矩阵](@entry_id:143130) $P$ 的[特征值](@entry_id:154894)为 $\lambda_1 = 0.5$ 和 $\lambda_2 = 4$。[@problem_id:1600793] 由于两个[特征值](@entry_id:154894)都大于零，我们可以立即断定矩阵 $P$ 和对应的二次型函数 $V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}$ 都是正定的。此外，我们还可以确定 $V(\mathbf{x})$ 在[单位圆](@entry_id:267290) $x_1^2 + x_2^2 = 1$ 上的最小值为 $\lambda_{\min} = 0.5$。

### 相关概念：半定函数与不定函数

与[正定性](@entry_id:149643)密切相关的是**正半定性 (positive semi-definiteness)**。一个[连续函数](@entry_id:137361) $V(\mathbf{x})$ 被称为**正半定函数**，如果它满足：
1.  $V(\mathbf{0}) = 0$
2.  对于所有[状态向量](@entry_id:154607) $\mathbf{x}$，恒有 $V(\mathbf{x}) \ge 0$。

与正定函数的关键区别在于，正半定函数允许在非零状态点上取值为零。

一个典型的例子是 $V(x_1, x_2) = (x_1 - 3x_2)^2$。[@problem_id:1600848] 这个函数显然是非负的，并且在原点为零。然而，它也在所有满足 $x_1 - 3x_2 = 0$ 的点上为零。这些点构成了一条穿过原点的直线。因此，存在无穷多个非零状态使得 $V(\mathbf{x}) = 0$。这样的函数就是正半定的，但不是正定的。

这个概念同样适用于二次型。在[西尔维斯特准则](@entry_id:150939)的检验中，如果一个主顺序子式为零（而其他主顺序子式为正），则矩阵可能是正半定的。例如，矩阵 $P = \begin{pmatrix} 1  1 \\ 1  1 \end{pmatrix}$ 的主顺序子式为 $\Delta_1=1>0$ 和 $\Delta_2=0$。[@problem_id:1600795] 它不是正定的。对应的二次型为 $V(x_1, x_2) = x_1^2 + 2x_1x_2 + x_2^2 = (x_1+x_2)^2$。这个函数在直线 $x_1+x_2=0$ 上的所有点都为零，因此是正半定的。从[特征值](@entry_id:154894)的角度看，一个[对称矩阵](@entry_id:143130)是正半定的当且仅当其所有[特征值](@entry_id:154894)均为非负（即 $\lambda_i \ge 0$）。

类似地，我们可以定义：
-   **负定函数 (Negative Definite Function)**：$V(\mathbf{x})$ 是负定的，如果 $-V(\mathbf{x})$ 是正定的。这意味着 $V(\mathbf{0})=0$ 且对于所有 $\mathbf{x} \neq \mathbf{0}$，$V(\mathbf{x})  0$。
-   **负半定函数 (Negative Semi-Definite Function)**：$V(\mathbf{x})$ 是负半定的，如果 $-V(\mathbf{x})$ 是正半定的。
-   **不定函数 (Indefinite Function)**：如果一个函数在某些点取正值，在另一些点取负值，那么它是不定的。例如，$V(x_1, x_2) = x_1^2 - x_2^2$ 就是一个不定函数。[@problem_id:1600814]

### 正定函数的代数性质

正定函数在代数运算下表现出一些有用的[封闭性质](@entry_id:136899)。了解这些性质可以帮助我们从已知的正定函数构造出新的正定函数。假设 $V_1(\mathbf{x})$ 和 $V_2(\mathbf{x})$ 是两个在 $\mathbb{R}^n$ 上定义的正定函数。[@problem_id:1600829]

-   **和**: 两个正定函数的和 $W(\mathbf{x}) = V_1(\mathbf{x}) + V_2(\mathbf{x})$ 也是正定的。这是因为 $W(\mathbf{0}) = V_1(\mathbf{0}) + V_2(\mathbf{0}) = 0+0=0$，且对于任意 $\mathbf{x} \neq \mathbf{0}$，$V_1(\mathbf{x})>0$ 且 $V_2(\mathbf{x})>0$，所以 $W(\mathbf{x}) > 0$。

-   **正数倍**: 一个正定函[数乘](@entry_id:155971)以一个正常数 $c>0$ 后，$W(\mathbf{x}) = cV_1(\mathbf{x})$ 仍然是正定的。

-   **积**: 两个正定函数的积 $W(\mathbf{x}) = V_1(\mathbf{x})V_2(\mathbf{x})$ 也是正定的。证明逻辑与求和类似。

-   **正幂**: 一个正定函数的正次幂 $W(\mathbf{x}) = (V_1(\mathbf{x}))^k$（其中 $k>0$ 是一个实数）也是正定的。

然而，并非所有运算都能保持[正定性](@entry_id:149643)。例如，两个正定函数的差不一定是正定的。考虑 $V_1(x_1, x_2) = 2x_1^2 + x_2^2$ 和 $V_2(x_1, x_2) = x_1^2 + 4x_2^2$，它们的差为 $W(\mathbf{x}) = V_1(\mathbf{x}) - V_2(\mathbf{x}) = x_1^2 - 3x_2^2$，这是一个不定函数。

### 进阶主题与联系

最后，我们讨论两个与正定性相关的重要高级概念，它们将正定性与微积分和全局系统行为联系起来。

#### 局部[正定性](@entry_id:149643)与[海森矩阵](@entry_id:139140)

对于一个一般的、非二次型的[光滑函数](@entry_id:267124) $V(\mathbf{x})$，我们如何判断它是否在原点附近是正定的？多元微积分为我们提供了工具。根据泰勒展开，一个在原点附近二次连续可微的函数 $V(\mathbf{x})$，若满足 $V(\mathbf{0})=0$ 且其梯度在原点为零 $\nabla V(\mathbf{0})=\mathbf{0}$（即原点是一个[临界点](@entry_id:144653)），其局部行为主要由其在原点的**海森矩阵 (Hessian matrix)** $\nabla^2 V(\mathbf{0})$ 决定。

一个充分条件是：如果海森矩阵 $\nabla^2 V(\mathbf{0})$ 是正定的，则函数 $V(\mathbf{x})$ 在原点的一个邻域内是**局部正定的 (locally positive definite)**。[@problem_id:1600799] 这本质上是[多元函数](@entry_id:145643)取严格局部极小值的[二阶充分条件](@entry_id:635498)。这个结论使我们能够通过计算和分析海森矩阵的定性，来判断一个复杂[非线性](@entry_id:637147)函数在[平衡点](@entry_id:272705)附近的局部正定性。

#### 径向无界性

在[李雅普诺夫稳定性](@entry_id:147734)分析中，特别是在证明**全局稳定性 (global stability)** 时，仅有正定性是不够的。我们还需要另一个性质：**径向无界性 (radial unboundedness)**。

一个函数 $V(\mathbf{x})$ 被称为径向无界的，如果当状态[向量的范数](@entry_id:154882)（即其到原点的距离）趋于无穷时，函数值也趋于无穷。形式化地，即 $\| \mathbf{x} \| \to \infty$ 蕴含 $V(\mathbf{x}) \to \infty$。

这个性质保证了函数的水平集 $V(\mathbf{x}) \le c$ 都是[有界集](@entry_id:157754)。从几何上看，一个径向无界的正定函数的图形就像一个无限延伸的“碗”，无论你在这个碗上走多远，你所处的高度都会无限增加。

所有正定的二次型函数，如 $V(x_1, x_2) = x_1^2 + 2x_1 x_2 + 2x_2^2 = (x_1+x_2)^2 + x_2^2$，都是径向无界的。[@problem_id:1600814] 高阶多项式函数如 $V(x_1, x_2) = x_1^4 + x_2^2$ 也是径向无界的。

然而，并非所有正定函数都是径向无界的。考虑函数 $V(x_1, x_2) = \frac{x_1^2}{1+x_1^2} + x_2^2$。[@problem_id:1600814] 尽管它是正定的，但它不是径向无界的。因为如果我们让 $x_2=0$ 并让 $x_1 \to \infty$，状态范数 $\|(x_1, 0)\| \to \infty$，但函数值 $V(x_1, 0) = \frac{x_1^2}{1+x_1^2}$ 趋近于 $1$，而不是无穷大。另一个例子是 $V(x_1, x_2) = \arctan(x_1^2) + \arctan(x_2^2)$，当 $\|\mathbf{x}\| \to \infty$ 时，其函数值有界，趋近于 $\pi$。这种函数在分析系统的全局行为时会带来局限性。

通过本节的学习，我们已经系统地掌握了正定函数的定义、几何意义、代数判据以及相关的重要性质。这些基础将为后续章节中运用[李雅普诺夫方法](@entry_id:635639)分析[系统稳定性](@entry_id:273248)奠定坚实的理论基石。