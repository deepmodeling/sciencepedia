{"hands_on_practices": [{"introduction": "將高階微分方程轉換為狀態空間形式是現代控制理論中的一項基本技能。本練習將指導你如何將一個經典的三階常微分方程轉換為一種標準且非常有用的狀態空間表示——控制器規範型 [@problem_id:1614942]。掌握這一過程對於使用狀態空間方法分析和設計控制系统至關重要。", "problem": "一个线性时不变 (LTI) 系统由以下三阶常微分方程描述，该方程关联了输出信号 $y(t)$ 和输入信号 $u(t)$：\n$$\n\\frac{d^3y}{dt^3} + 4\\frac{d^2y}{dt^2} + 7\\frac{dy}{dt} + 3y(t) = 5\\frac{du}{dt} + 2u(t)\n$$\n该系统可以使用状态向量 $\\mathbf{x}(t)$、状态矩阵 $A$、输入矩阵 $B$、输出矩阵 $C$ 和直接传输矩阵 $D$ 以状态空间形式表示。状态空间方程的标准形式为：\n$$\n\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + Bu(t)\n$$\n$$\ny(t) = C\\mathbf{x}(t) + Du(t)\n$$\n当系统以控制器规范型表示时，确定其状态矩阵 $A$。", "solution": "要将给定的微分方程转换为控制器规范型状态空间形式，我们首先需要找到系统的传递函数 $G(s) = Y(s)/U(s)$。我们对微分方程进行拉普拉斯变换，并假设零初始条件。\n\n给定的方程为：\n$$\n\\frac{d^3y}{dt^3} + 4\\frac{d^2y}{dt^2} + 7\\frac{dy}{dt} + 3y(t) = 5\\frac{du}{dt} + 2u(t)\n$$\n应用拉普拉斯变换，在零初始条件下，$\\mathcal{L}\\{f(t)\\} = F(s)$ 且 $\\mathcal{L}\\{\\frac{d^n f}{dt^n}\\} = s^n F(s)$，我们得到：\n$$\ns^3Y(s) + 4s^2Y(s) + 7sY(s) + 3Y(s) = 5sU(s) + 2U(s)\n$$\n提取出 $Y(s)$ 和 $U(s)$：\n$$\n(s^3 + 4s^2 + 7s + 3)Y(s) = (5s + 2)U(s)\n$$\n传递函数 $G(s)$ 是输出 $Y(s)$ 与输入 $U(s)$ 的比值：\n$$\nG(s) = \\frac{Y(s)}{U(s)} = \\frac{5s + 2}{s^3 + 4s^2 + 7s + 3}\n$$\n对于控制器规范型，我们引入一个中间变量，称之为 $Z(s)$，使得传递函数可以分解为两部分：\n$$\n\\frac{Z(s)}{U(s)} = \\frac{1}{s^3 + 4s^2 + 7s + 3} \\quad \\text{和} \\quad \\frac{Y(s)}{Z(s)} = 5s + 2\n$$\n从第一个方程，我们可以写出关于中间变量 $z(t)$ 的微分方程：\n$$\n(s^3 + 4s^2 + 7s + 3)Z(s) = U(s)\n$$\n将其转换回时域，得到：\n$$\n\\frac{d^3z}{dt^3} + 4\\frac{d^2z}{dt^2} + 7\\frac{dz}{dt} + 3z(t) = u(t)\n$$\n现在，我们基于 $z(t)$ 及其导数来定义状态变量。这是控制器规范型的标准选择。设状态向量为 $\\mathbf{x} = [x_1, x_2, x_3]^T$。\n$$\nx_1(t) = z(t)\n$$\n$$\nx_2(t) = \\dot{z}(t)\n$$\n$$\nx_3(t) = \\ddot{z}(t)\n$$\n现在我们可以通过对这些状态变量求导来写出状态方程：\n$$\n\\dot{x}_1 = \\dot{z} = x_2\n$$\n$$\n\\dot{x}_2 = \\ddot{z} = x_3\n$$\n为了求得 $\\dot{x}_3$，我们使用关于 $z(t)$ 的微分方程：\n$$\n\\dot{x}_3 = \\dddot{z} = -3z - 7\\dot{z} - 4\\ddot{z} + u(t)\n$$\n将状态变量代入此方程：\n$$\n\\dot{x}_3 = -3x_1 - 7x_2 - 4x_3 + u(t)\n$$\n现在我们可以将这三个状态方程写成矩阵形式 $\\dot{\\mathbf{x}} = A\\mathbf{x} + Bu$：\n$$\n\\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_2 \\\\ \\dot{x}_3 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -3  -7  -4 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} u(t)\n$$\n由此，我们可以确定状态矩阵 $A$ 和输入矩阵 $B$：\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -3  -7  -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n问题具体要求的是状态矩阵 $A$。为了完整起见，我们再求出输出方程。根据我们的分解，$Y(s) = (5s + 2)Z(s)$，在时域中为：\n$$\ny(t) = 5\\dot{z}(t) + 2z(t)\n$$\n代入状态变量：\n$$\ny(t) = 5x_2 + 2x_1\n$$\n写成矩阵形式 $y = C\\mathbf{x} + Du$：\n$$\ny(t) = \\begin{pmatrix} 2  5  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 0 \\end{pmatrix} u(t)\n$$\n因此，输出矩阵为 $C = \\begin{pmatrix} 2  5  0 \\end{pmatrix}$，直接传输矩阵为 $D = \\begin{pmatrix} 0 \\end{pmatrix}$。\n\n问题要求的是状态矩阵 $A$。根据我们的推导，该矩阵为：\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -3  -7  -4 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -3  -7  -4 \\end{pmatrix}}\n$$", "id": "1614942"}, {"introduction": "一旦系统被表示為狀態空間形式，我們就可以精確地預測其在給定初始條件和輸入下的動態行為。本練習 [@problem_id:1614978] 將此應用於一個衛星熱控系統的實際場景，要求你求解系统狀態隨時間的變化。通過這個練習，你將實踐計算狀態轉移矩陣以及求解二階系統的完整響應，這是分析線性系統動態特性的核心。", "problem": "一个微型卫星使用主动热控制系统来维持一个关键星上仪器的温度。该系统的热力学动态可以通过状态空间表示来建模。设状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$，其中 $x_1(t)$ 是仪器温度与其期望工作点之间的温度偏差（单位：开尔文），$x_2(t)$ 是仪器安装结构的温度偏差。\n\n系统动态由以下线性时不变 (LTI) 方程描述：\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t) $$\n系统矩阵如下：\n$$ A = \\begin{pmatrix} -1  1 \\\\ -5  -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n输入 $u(t)$ 是一个施加到仪器加热器的归一化信号。在时间 $t=0$ 时，系统处于初始状态 $\\mathbf{x}(0) = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。为了使仪器达到其工作温度，加热器被一个恒定信号激活，表示为 $t \\ge 0$ 时的单位阶跃输入 $u(t) = 1$。\n\n确定对于所有 $t \\ge 0$，仪器温度偏差 $x_1(t)$ 的表达式。", "solution": "我们已知线性时不变系统\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t), \\quad A = \\begin{pmatrix} -1  1 \\\\ -5  -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n初始条件为 $\\mathbf{x}(0) = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$，且对于 $t \\ge 0$ 有单位阶跃输入 $u(t)=1$。这种 LTI 系统的解为\n$$\n\\mathbf{x}(t) = \\exp(A t)\\,\\mathbf{x}(0) + \\int_{0}^{t} \\exp(A(t-\\tau))\\,B\\,u(\\tau)\\,d\\tau.\n$$\n对于恒定输入 $u(t)=1$，一个常数特解（稳态解）$\\mathbf{x}_{\\mathrm{ss}}$ 满足\n$$\nA\\,\\mathbf{x}_{\\mathrm{ss}} + B = \\mathbf{0} \\quad \\Longrightarrow \\quad \\mathbf{x}_{\\mathrm{ss}} = -A^{-1} B.\n$$\n计算 $A^{-1}$。行列式为\n$$\n\\det(A) = (-1)(-3) - (1)(-5) = 8,\n$$\n伴随矩阵为\n$$\n\\operatorname{adj}(A) = \\begin{pmatrix} -3  -1 \\\\ 5  -1 \\end{pmatrix},\n$$\n所以\n$$\nA^{-1} = \\frac{1}{8} \\begin{pmatrix} -3  -1 \\\\ 5  -1 \\end{pmatrix}, \\quad A^{-1} B = \\frac{1}{8} \\begin{pmatrix} -3 \\\\ 5 \\end{pmatrix}.\n$$\n因此\n$$\n\\mathbf{x}_{\\mathrm{ss}} = -A^{-1} B = \\begin{pmatrix} \\frac{3}{8} \\\\ -\\frac{5}{8} \\end{pmatrix}.\n$$\n因此，完整解可以写成\n$$\n\\mathbf{x}(t) = \\exp(A t)\\,(\\mathbf{x}(0) - \\mathbf{x}_{\\mathrm{ss}}) + \\mathbf{x}_{\\mathrm{ss}}.\n$$\n定义 $\\mathbf{v} = \\mathbf{x}(0) - \\mathbf{x}_{\\mathrm{ss}} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} \\frac{3}{8} \\\\ -\\frac{5}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix}$。\n\n为了计算 $\\exp(A t)$，我们使用具有共轭复特征值的 $2 \\times 2$ 矩阵的标准实数形式表达式。$A$ 的特征多项式是\n$$\n\\lambda^{2} + 4 \\lambda + 8 = 0,\n$$\n所以特征值为 $-2 \\pm 2 i$。令 $a = -2$ 且 $b = 2$。那么\n$$\n\\exp(A t) = \\exp(a t)\\left[ \\cos(b t)\\,I + \\frac{\\sin(b t)}{b}\\,(A - a I) \\right]\n= \\exp(-2 t)\\left[ \\cos(2 t)\\,I + \\frac{\\sin(2 t)}{2}\\,(A + 2 I) \\right].\n$$\n计算 $(A + 2 I)$ 并将其应用于 $\\mathbf{v}$：\n$$\nA + 2 I = \\begin{pmatrix} 1  1 \\\\ -5  -1 \\end{pmatrix}, \\quad (A + 2 I)\\mathbf{v} = \\begin{pmatrix} 1  1 \\\\ -5  -1 \\end{pmatrix} \\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{18}{8} \\\\ -\\frac{70}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{4} \\\\ -\\frac{35}{4} \\end{pmatrix}.\n$$\n因此\n$$\n\\exp(A t)\\,\\mathbf{v} = \\exp(-2 t)\\left[ \\cos(2 t)\\,\\mathbf{v} + \\frac{\\sin(2 t)}{2}\\,(A + 2 I)\\mathbf{v} \\right]\n= \\exp(-2 t)\\left[ \\cos(2 t)\\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix} + \\frac{\\sin(2 t)}{2}\\begin{pmatrix} \\frac{9}{4} \\\\ -\\frac{35}{4} \\end{pmatrix} \\right].\n$$\n第一个分量是\n$$\n\\left[\\exp(A t)\\,\\mathbf{v}\\right]_{1} = \\exp(-2 t)\\left( \\frac{13}{8}\\cos(2 t) + \\frac{9}{8}\\sin(2 t) \\right).\n$$\n加上稳态的第一个分量 $\\left(\\mathbf{x}_{\\mathrm{ss}}\\right)_{1} = \\frac{3}{8}$ 得到\n$$\nx_{1}(t) = \\exp(-2 t)\\left( \\frac{13}{8}\\cos(2 t) + \\frac{9}{8}\\sin(2 t) \\right) + \\frac{3}{8}, \\quad t \\ge 0.\n$$\n这满足初始条件为 $x_{1}(0) = 2$ 和 $\\dot{x}_{1}(0) = -1$ 的二阶降阶方程 $\\ddot{x}_{1} + 4 \\dot{x}_{1} + 8 x_{1} = 3$，从而验证了结果的一致性。", "answer": "$$\\boxed{\\exp(-2 t)\\left(\\frac{13}{8}\\cos(2 t)+\\frac{9}{8}\\sin(2 t)\\right)+\\frac{3}{8}}$$", "id": "1614978"}, {"introduction": "狀態變量的選擇並非唯一，巧妙的選擇可以揭示系統的内在屬性，例如其固有的振盪模式。本練習 [@problem_id:1614933] 探討了如何通過坐標變換，將一个标准的狀態矩陣 $A$ 轉化為一種更能揭示其動態特性的規範型 $A_c$。這種技術使得系統的振盪频率和阻尼等關鍵參數在新的狀態矩陣中一目了然，是進行模態分析的强大工具。", "problem": "一个二维线性时不变 (LTI) 系统由状态空间方程 $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t)$ 描述，其中状态向量为 $\\mathbf{x}(t) \\in \\mathbb{R}^2$，状态矩阵 $A$ 由下式给出：\n$$A = \\begin{pmatrix} 0  1 \\\\ -25  -6 \\end{pmatrix}$$\n为了分析该系统的振荡行为，我们通过一个实的、常数的、可逆的线性变换 $\\mathbf{x}(t) = T\\mathbf{z}(t)$ 引入一个新的状态向量 $\\mathbf{z}(t)$。在这些新坐标下，系统动力学由 $\\dot{\\mathbf{z}}(t) = A_{c}\\mathbf{z}(t)$ 描述，其中变换后的状态矩阵 $A_{c} = T^{-1}AT$ 具有以下规范形：\n$$A_{c} = \\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix}$$\n对于某些实数 $\\alpha$ 和 $\\beta$，并附加条件 $\\beta > 0$。\n\n确定实现这一目标的变换矩阵 $T$，并满足 $T$ 的第一行为 $\\begin{pmatrix} 1  0 \\end{pmatrix}$ 的约束条件。将你的答案表示为单个矩阵。", "solution": "我们给定一个实LTI系统 $\\dot{\\mathbf{x}}(t)=A\\mathbf{x}(t)$，其中\n$$\nA=\\begin{pmatrix}0  1 \\\\ -25  -6\\end{pmatrix},\n$$\n我们寻求一个实的、可逆的矩阵 $T$，其第一行为 $\\begin{pmatrix}1  0\\end{pmatrix}$，使得在变换坐标 $\\mathbf{x}=T\\mathbf{z}$ 下，矩阵 $A_{c}=T^{-1}AT$ 具有实的规范形\n$$\nA_{c}=\\begin{pmatrix}\\alpha  \\beta \\\\ -\\beta  \\alpha\\end{pmatrix},\\quad \\beta>0.\n$$\n对于一个具有共轭复特征值 $\\lambda=\\alpha\\pm i\\beta$ 和对应于 $\\lambda=\\alpha+i\\beta$ 的复特征向量 $v=p+i q$（其中 $p,q\\in\\mathbb{R}^{2}$）的实 $2\\times 2$ 矩阵，实矩阵 $T=[\\,p\\ \\ q\\,]$ 满足\n$$\nA T = T \\begin{pmatrix}\\alpha  \\beta \\\\ -\\beta  \\alpha\\end{pmatrix},\n$$\n这意味着 $T^{-1}AT=\\begin{pmatrix}\\alpha  \\beta \\\\ -\\beta  \\alpha\\end{pmatrix}$。这可以从以下推导得出\n$$\nA(p+iq)=(\\alpha+i\\beta)(p+iq)\\;\\Longleftrightarrow\\;\n\\begin{cases}\nA p=\\alpha p-\\beta q,\\\\\nA q=\\beta p+\\alpha q,\n\\end{cases}\n$$\n因此 $A[\\,p\\ \\ q\\,]=[\\,p\\ \\ q\\,]\\begin{pmatrix}\\alpha  \\beta \\\\ -\\beta  \\alpha\\end{pmatrix}$。\n\n步骤 1：计算 $A$ 的特征值。特征多项式为\n$$\n\\det(\\lambda I - A)=\\lambda^{2}+6\\lambda+25.\n$$\n求解 $\\lambda^{2}+6\\lambda+25=0$ 可得\n$$\n\\lambda=\\frac{-6\\pm\\sqrt{36-100}}{2}=-3\\pm 4 i,\n$$\n因此 $\\alpha=-3$ 且 $\\beta=4$，满足 $\\beta>0$。\n\n步骤 2：通过求解 $(A-\\lambda I)v=0$ 找到对应于 $\\lambda=-3+4 i$ 的复特征向量：\n$$\nA-\\lambda I=\\begin{pmatrix}3-4 i  1 \\\\ -25  -3-4 i\\end{pmatrix}.\n$$\n从第一行看，$(3-4 i)v_{1}+v_{2}=0$，所以设 $v_{1}=1$ 可得 $v_{2}=-(3-4 i)=-3+4 i$。因此一个特征向量是\n$$\nv=\\begin{pmatrix}1 \\\\ -3+4 i\\end{pmatrix}=p+i q,\\quad p=\\begin{pmatrix}1 \\\\ -3\\end{pmatrix},\\quad q=\\begin{pmatrix}0 \\\\ 4\\end{pmatrix}.\n$$\n\n步骤 3：用列向量 $p$ 和 $q$ 构造实变换矩阵：\n$$\nT=\\begin{pmatrix}1  0 \\\\ -3  4\\end{pmatrix}.\n$$\n它的第一行是 $\\begin{pmatrix}1  0\\end{pmatrix}$，符合要求，并且 $\\det T=4\\neq 0$，所以 $T$ 是可逆的。\n\n步骤 4：验证规范形。使用 $A p=\\alpha p-\\beta q$ 和 $A q=\\beta p+\\alpha q$，其中 $\\alpha=-3$ 和 $\\beta=4$，我们有\n$$\nA T = T \\begin{pmatrix}-3  4 \\\\ -4  -3\\end{pmatrix},\n$$\n所以 $T^{-1}AT=\\begin{pmatrix}-3  4 \\\\ -4  -3\\end{pmatrix}$，这与要求的 $\\beta>0$ 的形式相匹配。\n\n因此，所求的变换矩阵是 $T=\\begin{pmatrix}1  0 \\\\ -3  4\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}1  0 \\\\ -3  4\\end{pmatrix}}$$", "id": "1614933"}]}