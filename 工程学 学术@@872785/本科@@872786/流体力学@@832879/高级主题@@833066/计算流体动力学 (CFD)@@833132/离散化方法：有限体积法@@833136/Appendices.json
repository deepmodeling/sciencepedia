{"hands_on_practices": [{"introduction": "将控制方程从连续的偏微分形式转化为离散的代数形式，是有限体积方法的核心。这个练习将引导你完成这关键的第一步。我们将从最基础的一维稳态扩散方程入手，通过对一个控制体进行积分并近似计算其边界上的通量，来推导出中心节点与其相邻节点之间的代数关系，从而直观地理解FVM如何保证物理量的守恒。[@problem_id:1749431]", "problem": "考虑一个一维稳态物理系统，其中标量 $\\phi$ 在介质中扩散。该过程由纯扩散方程控制：\n$$ \\frac{d}{dx} \\left( \\Gamma \\frac{d\\phi}{dx} \\right) = 0 $$\n其中 $\\Gamma$ 是扩散系数，并假定为常数。\n\n该物理域被离散化为一个均匀的一维网格，相邻节点之间的间距为恒定的 $\\Delta x$。我们希望使用有限体积法 (FVM) 找到一个通用内部节点 $P$（也用索引 $i$ 表示）的代数方程。节点 $P$ 的控制体积以该节点为中心，其边界（面）位于 $x_P - \\frac{\\Delta x}{2}$ 和 $x_P + \\frac{\\Delta x}{2}$ 的位置。与 $P$ 相邻的节点是西侧节点 $W$（索引 $i-1$）和东侧节点 $E$（索引 $i+1$）。\n\n遵循 FVM 步骤，即对控制体积上的控制方程进行积分，并对面上的通量进行近似，推导出最终的代数方程。控制体积极面上的梯度应使用最近的两个节点的值来近似。例如，节点 $P$ 和 $E$ 之间的东侧面上的梯度近似为 $\\frac{\\phi_E - \\phi_P}{\\Delta x}$。\n\n最终的代数方程应写成标准形式：\n$$ a_P \\phi_P = a_W \\phi_W + a_E \\phi_E $$\n为确保系数的唯一性，方程必须进行归一化，使得 $a_W = \\frac{\\Gamma}{\\Delta x}$。\n\n基于此公式，确定系数 $a_P$ 和 $a_E$ 的表达式。请将您的答案表示为一个有序对表达式 $(a_P, a_E)$。", "solution": "从具有恒定扩散系数的稳态一维扩散方程开始：\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right)=0.$$\n对节点 $P$ 的控制体积进行积分，其边界面位于 $x_{w}=x_{P}-\\frac{\\Delta x}{2}$ 和 $x_{e}=x_{P}+\\frac{\\Delta x}{2}$：\n$$\\int_{x_{w}}^{x_{e}}\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right)\\,dx=\\left[\\Gamma \\frac{d\\phi}{dx}\\right]_{e}-\\left[\\Gamma \\frac{d\\phi}{dx}\\right]_{w}=0.$$\n在均匀网格上使用最近的两个节点来近似面上的梯度：\n$$(d\\phi/dx)_{e}\\approx\\frac{\\phi_{E}-\\phi_{P}}{\\Delta x},\\qquad(d\\phi/dx)_{w}\\approx\\frac{\\phi_{P}-\\phi_{W}}{\\Delta x}.$$\n将这些近似代入积分后的平衡方程：\n$$\\Gamma\\frac{\\phi_{E}-\\phi_{P}}{\\Delta x}-\\Gamma\\frac{\\phi_{P}-\\phi_{W}}{\\Delta x}=0.$$\n重新整理以获得代数方程：\n$$\\frac{\\Gamma}{\\Delta x}\\,\\phi_{E}+\\frac{\\Gamma}{\\Delta x}\\,\\phi_{W}=2\\,\\frac{\\Gamma}{\\Delta x}\\,\\phi_{P}.$$\n将其与标准形式 $a_{P}\\phi_{P}=a_{W}\\phi_{W}+a_{E}\\phi_{E}$ 进行匹配。根据归一化条件 $a_{W}=\\frac{\\Gamma}{\\Delta x}$，可以得出\n$$a_{E}=\\frac{\\Gamma}{\\Delta x},\\qquad a_{P}=a_{W}+a_{E}=\\frac{2\\Gamma}{\\Delta x}.$$\n因此，所求的有序对为 $(a_{P},a_{E})=\\left(\\frac{2\\Gamma}{\\Delta x},\\frac{\\Gamma}{\\Delta x}\\right)$。", "answer": "$$\\boxed{\\left(\\frac{2\\Gamma}{\\Delta x}, \\frac{\\Gamma}{\\Delta x}\\right)}$$", "id": "1749431"}, {"introduction": "在掌握了单个控制体的离散化之后，下一步是将其应用于整个计算域，并构建一个可求解的方程组。本练习将问题扩展到一个包含多个网格单元和给定边界条件的实际计算域。你将需要为每个内部节点建立代数方程，并将它们整合为一个统一的矩阵方程 $[A][\\Phi] = [b]$，这是将离散化后的问题交由计算机求解的关键准备工作。[@problem_id:1749401]", "problem": "考虑在一个长度为 $L$ 的狭窄、静止的流体通道中，一种化学物质的一维稳态输运。该物质的浓度用 $\\phi(x)$ 表示，由以下扩散方程控制：\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) + S = 0\n$$\n其中 $\\Gamma$ 是常数扩散系数。该物质经历一级化学反应，产生一个源/汇项 $S$，它是当地浓度的线性函数：\n$$\nS = S_C + S_P \\phi\n$$\n这里，$S_C$ 和 $S_P$ 是常系数。\n\n通道从 $x=0$ 延伸到 $x=L$。边界上的浓度保持在已知的恒定值：$\\phi(0) = \\phi_A$ 和 $\\phi(L) = \\phi_B$。\n\n为了求解浓度分布，将区域离散化为一个具有五个等间距节点的均匀网格：$x_0, x_1, x_2, x_3, x_4$，其中 $x_0=0$ 且 $x_4=L$。三个内部节点处的浓度，$\\phi(x_1) \\equiv \\phi_1$、$\\phi(x_2) \\equiv \\phi_2$ 和 $\\phi(x_3) \\equiv \\phi_3$，是未知的。\n\n对每个内部节点上的控制方程应用基于中心差分的有限体积法，会得到一个关于三个未知浓度的三元线性代数方程组。该方程组可以写成矩阵形式 $[A][\\Phi] = [b]$，其中 $[\\Phi]$ 是未知浓度的列向量，$[\\Phi] = \\begin{pmatrix} \\phi_1  \\phi_2  \\phi_3 \\end{pmatrix}^T$。\n\n确定 $3 \\times 3$ 的系数矩阵 $[A]$。你的答案应以 $\\Gamma$、$L$ 和 $S_P$ 表示。", "solution": "扩散系数为常数的控制方程为\n$$\n\\Gamma \\frac{d^{2}\\phi}{dx^{2}} + S_C + S_P \\phi = 0.\n$$\n将区域离散为五个等间距节点，间距为 $h = \\frac{L}{4}$。在一个围绕内部节点 $i \\in \\{1,2,3\\}$、宽度为 $h$ 的控制体积上使用有限体积法，对该控制体积积分方程，并用中心差分近似控制面梯度：\n$$\n\\Gamma \\left[\\left.\\frac{d\\phi}{dx}\\right|_{e} - \\left.\\frac{d\\phi}{dx}\\right|_{w}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\n其中\n$$\n\\left.\\frac{d\\phi}{dx}\\right|_{e} \\approx \\frac{\\phi_{i+1} - \\phi_i}{h}, \\qquad \\left.\\frac{d\\phi}{dx}\\right|_{w} \\approx \\frac{\\phi_i - \\phi_{i-1}}{h}.\n$$\n将这些代入平衡方程得到\n$$\n\\Gamma \\left[\\frac{\\phi_{i+1} - \\phi_i}{h} - \\frac{\\phi_i - \\phi_{i-1}}{h}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\n化简后得到\n$$\n\\frac{\\Gamma}{h}\\phi_{i-1} + \\left(-\\frac{2\\Gamma}{h} + S_P h\\right)\\phi_i + \\frac{\\Gamma}{h}\\phi_{i+1} = - S_C h.\n$$\n整理成标准线性系统形式 $[A][\\Phi]=[b]$，将相邻项移到左侧，将常数源项和边界贡献移到右侧。任意内部节点的有限体积系数为\n$$\na_W = \\frac{\\Gamma}{h}, \\qquad a_E = \\frac{\\Gamma}{h}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h.\n$$\n对于作用于 $[\\Phi] = (\\phi_1,\\phi_2,\\phi_3)^{T}$ 的 $3 \\times 3$ 矩阵，其行对应于节点 $i=1,2,3$。对于 $i=1$，西侧邻居是边界节点 $\\phi_0=\\phi_A$（已移到右侧），因此左侧只出现 $\\phi_1$ 和 $\\phi_2$。对于 $i=2$，两个邻居都是未知数。对于 $i=3$，东侧邻居是边界节点 $\\phi_4=\\phi_B$（已移到右侧）。代入 $h=\\frac{L}{4}$ 得\n$$\na_W = a_E = \\frac{\\Gamma}{h} = \\frac{4\\Gamma}{L}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h = \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}.\n$$\n因此，系数矩阵为\n$$\n[A] =\n\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_P L}{4}   -\\frac{4\\Gamma}{L}   0 \\\\\n-\\frac{4\\Gamma}{L}   \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}   -\\frac{4\\Gamma}{L} \\\\\n0   -\\frac{4\\Gamma}{L}   \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_P L}{4}   -\\frac{4\\Gamma}{L}   0 \\\\\n-\\frac{4\\Gamma}{L}   \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}   -\\frac{4\\Gamma}{L} \\\\\n0   -\\frac{4\\Gamma}{L}   \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}\n\\end{pmatrix}}$$", "id": "1749401"}, {"introduction": "真实的流体问题几乎总是包含对流项，而对流的主导会给数值计算带来独特的挑战。本练习将介绍包含对流和扩散的输运方程，以及一个关键的无量纲数——网格佩克莱数（Péclet number），它用于判断对流与扩散的相对强度。你将运用一种实用的混合差分格式，该格式能根据流动的物理特性自适应地调整离散方法，以确保计算结果的稳定性和物理真实性。[@problem_id:1749433]", "problem": "在计算流体动力学的研究中，通常采用混合差分格式来离散化标量属性 $\\phi$ 的对流-扩散输运方程。考虑一个稳定的一维流场，其均匀速度 $u$ 沿 $x$ 轴正向。$\\phi$ 的输运过程（在本例中代表质量分数，是无量纲的）由恒定的流体密度 $\\rho$ 和恒定的扩散系数 $\\Gamma$ 决定。\n\n建立一个有限体积法（FVM）网格，其中相邻的计算节点位于 $P$ 和 $E$ 处，$E$ 在 $P$ 的下游。这些节点之间的距离为 $\\delta x$。节点上的标量值已知为 $\\phi_P$ 和 $\\phi_E$。\n\n位于 $P$ 和 $E$ 中点的单元面 'e' 处的单位面积总通量（对流通量加扩散通量）$q_e$ 是使用混合差分格式计算的。该格式的逻辑基于局部单元佩克莱数，其定义为 $Pe = \\frac{\\rho u \\delta x}{\\Gamma}$。当佩克莱数的绝对值较高时（$|Pe| \\geq 2$），该格式采用稳定的上风差分近似来计算总通量，在强对流条件下有效地忽略了显式扩散项。对于低佩克莱数流动（$|Pe|  2$），它使用更精确的中心差分近似来计算总通量。\n\n给定以下参数：\n- 流体密度, $\\rho = 1.25$ kg/m³\n- 流速, $u = 4.0$ m/s\n- 扩散系数, $\\Gamma = 0.50$ kg/(m·s)\n- 节点间距, $\\delta x = 0.25$ m\n- 节点 P 处的标量值, $\\phi_P = 12.0$\n- 节点 E 处的标量值, $\\phi_E = 5.0$\n\n计算单元面 'e' 处单位面积上 $\\phi$ 的总通量 $q_e$。以 kg/(m²·s) 为单位表示您的答案，并四舍五入至三位有效数字。", "solution": "在面 e 处的单位面积总通量是对流和扩散贡献的总和。在面上的连续形式为，\n$$\nq_{e} = \\rho u \\,\\phi\\big|_{e} - \\Gamma \\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{e}.\n$$\n混合差分格式根据局部单元佩克莱数在上风差分和中心差分之间进行选择，\n$$\nPe = \\frac{\\rho u \\,\\delta x}{\\Gamma}.\n$$\n使用给定参数计算佩克莱数：\n$$\nPe = \\frac{(1.25)\\,(4.0)\\,(0.25)}{0.50} = \\frac{1.25}{0.50} = 2.5.\n$$\n由于 $|Pe| = 2.5 \\geq 2$，该格式使用稳定的上风差分近似，并忽略显式扩散项。当流向为 $x$ 轴正向时，上风侧的面值为 $\\phi_{e} = \\phi_{P}$，因此\n$$\nq_{e} \\approx \\rho u \\,\\phi_{P}.\n$$\n代入给定值，\n$$\nq_{e} = (1.25)\\,(4.0)\\,(12.0) = 5 \\times 12.0 = 60.0.\n$$\n因此，单位面积的总通量为 $60.0$ kg/(m$^2$·s)，保留三位有效数字。", "answer": "$$\\boxed{60.0}$$", "id": "1749433"}]}