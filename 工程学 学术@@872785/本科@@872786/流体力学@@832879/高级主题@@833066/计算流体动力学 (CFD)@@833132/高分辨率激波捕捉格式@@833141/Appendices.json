{"hands_on_practices": [{"introduction": "理论是指导，但真正的理解来自于实践。本章节提供了一系列动手练习，旨在加深您对高分辨率激波捕捉格式核心概念的理解。第一个练习将我们带回到问题的根源：激波的形成。通过分析伯格斯方程（Burgers' equation）这个经典的非线性模型，您将亲手判断何种初始条件会演化为激波，并确定其传播方向。这个练习有助于建立关于间断如何从简单状态演化而来的物理直觉，这是理解为何需要复杂数值格式的根本出发点 [@problem_id:1761771]。", "problem": "考虑一维无粘性伯格斯方程，这是研究流体动力学中激波形成的一个基本模型：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( \\frac{u^2}{2} \\right) = 0\n$$\n我们关心这个方程的黎曼问题的解，该问题由时间 $t=0$ 时的分段常数初始条件定义：\n$$\nu(x, 0) = \n\\begin{cases} \nu_L  &\\text{若 } x  0 \\\\\nu_R  \\text{若 } x > 0 \n\\end{cases}\n$$\n其中 $u_L$ 和 $u_R$ 是常数状态。根据 $u_L$ 和 $u_R$ 的值，在 $x=0$ 处的初始间断可以演化为激波（一个移动的间断）或稀疏波（一个光滑的、扩展的波）。\n\n对于状态 $(u_L, u_R)$，下列哪个初始条件会产生一个在所有时间 $t > 0$ 都向右（即 $x$ 轴正方向）传播的单一激波？\n\nA. $u_L = 2, u_R = 1$\n\nB. $u_L = 1, u_R = 2$\n\nC. $u_L = -1, u_R = -2$\n\nD. $u_L = -2, u_R = 1$\n\nE. $u_L = 1, u_R = -2$", "solution": "我们考虑具有凸通量 $f(u) = \\frac{u^{2}}{2}$ 的标量守恒律，因此 $f'(u) = u$ 且 $f''(u) = 1  0$。对于具有左右状态 $(u_{L},u_{R})$ 的黎曼问题，波的模式确定如下：\n- 如果 $u_{L}  u_{R}$ (递增数据)，解是一个稀疏波。\n- 如果 $u_{L}  u_{R}$ (递减数据)，解是一个满足Rankine–Hugoniot条件和Lax熵条件的激波。\n\n对于 $u_{L}$ 和 $u_{R}$ 之间的一个激波，Rankine–Hugoniot条件给出了激波速度\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{\\frac{u_{R}^{2}}{2} - \\frac{u_{L}^{2}}{2}}{u_{R} - u_{L}} = \\frac{u_{L} + u_{R}}{2}.\n$$\n对于凸通量，Lax熵条件要求\n$$\nf'(u_{L})  s  f'(u_{R}) \\quad \\Longleftrightarrow \\quad u_{L}  s  u_{R}.\n$$\n当 $u_{L}  u_{R}$ 时，我们有 $u_{R}  \\frac{u_{L} + u_{R}}{2}  u_{L}$，所以Lax条件自动成立。\n\n一个向右传播的单一激波要求 $u_{L}  u_{R}$ (形成激波) 和 $s = \\frac{u_{L} + u_{R}}{2}  0$ (向右移动)。我们检查每个选项：\n- A: $u_{L} = 2$, $u_{R} = 1$。这里 $u_{L}  u_{R}$，所以形成一个激波，并且 $s = \\frac{2 + 1}{2} = \\frac{3}{2}  0$，因此它向右传播。\n- B: $u_{L} = 1$, $u_{R} = 2$。由于 $u_{L}  u_{R}$，这是一个稀疏波，而不是激波。\n- C: $u_{L} = -1$, $u_{R} = -2$。由于 $u_{L}  u_{R}$，形成一个激波，但 $s = \\frac{-1 + (-2)}{2} = -\\frac{3}{2}  0$，因此它向左传播。\n- D: $u_{L} = -2$, $u_{R} = 1$。由于 $u_{L}  u_{R}$，这是一个稀疏波，而不是激波。\n- E: $u_{L} = 1$, $u_{R} = -2$。由于 $u_{L}  u_{R}$，形成一个激波，但 $s = \\frac{1 + (-2)}{2} = -\\frac{1}{2}  0$，因此它向左传播。\n\n因此，只有选项A产生一个在所有 $t > 0$ 都向右移动的单一激波。", "answer": "$$\\boxed{A}$$", "id": "1761771"}, {"introduction": "理解了激波的形成后，一个自然的问题是：我们如何用计算机来模拟它？虽然像Lax-Wendroff这样的经典高阶格式在模拟平滑流动时表现出色，但在处理包含激波或强稀疏波等极端情况时，它们可能会产生灾难性的失败。这个练习将引导您手动执行一步计算，亲眼见证在一个强稀疏波场景下，Lax-Wendroff格式如何产生非物理的负压结果。这个具体的失败案例强有力地证明了，我们需要更为稳健的数值方法，例如那些具备“保正性”等特性的高分辨率格式 [@problem_id:1761785]。", "problem": "一位计算流体动力学工程师正在使用欧拉方程模拟理想气体的一维流动。该模拟采用两步Lax-Wendroff格式以在空间和时间上达到二阶精度。在一个涉及强膨胀波的测试案例中，模拟崩溃并报告了非物理结果。你的任务是通过对一个特定的网格单元执行单个时间步的计算来分析此次失败的原因。\n\n任意单元 $j$ 中的气体状态由一个守恒变量向量 $\\mathbf{U}_j = [\\rho_j, (\\rho u)_j, E_j]^T$ 描述，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位体积的总能量。通量向量为 $\\mathbf{F}(\\mathbf{U}_j) = [(\\rho u)_j, (\\rho u^2 + p)_j, (u(E+p))_j]^T$。该气体遵循理想气体定律，其压力的状态方程由 $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$ 给出。\n\n两步Lax-Wendroff格式按如下方式将单元 $i$ 的状态从时间 $n$ 更新到 $n+1$：\n\n1.  **预测步**：在半个时间步（$n+1/2$）时计算单元界面（$i-1/2$ 和 $i+1/2$）处的状态。对于单元 $j$ 和 $j+1$ 之间的界面 $j+1/2$：\n    $$ \\mathbf{U}_{j+1/2}^{n+1/2} = \\frac{1}{2}(\\mathbf{U}_j^n + \\mathbf{U}_{j+1}^n) - \\frac{\\Delta t}{2\\Delta x}(\\mathbf{F}(\\mathbf{U}_{j+1}^n) - \\mathbf{F}(\\mathbf{U}_j^n)) $$\n\n2.  **修正步**：使用预测的界面状态来更新单元 $i$ 的状态：\n    $$ \\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x}(\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2}) - \\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})) $$\n\n考虑在时间 $t=0$ 时，代表强膨胀的三个相邻单元的以下无量纲初始条件：\n-   **单元 $i-1$**：$\\rho_{i-1} = 1.0$, $u_{i-1} = 0.0$, $p_{i-1} = 1.0$\n-   **单元 $i$**：$\\rho_i = 0.1$, $u_i = 4.0$, $p_i = 0.01$\n-   **单元 $i+1$**：$\\rho_{i+1} = 0.1$, $u_{i+1} = 4.0$, $p_{i+1} = 0.01$\n\n在你的计算中使用以下参数：\n-   比热比：$\\gamma = 1.4$\n-   时间步长与网格间距之比：$\\frac{\\Delta t}{\\Delta x} = 0.1$\n\n计算一个时间步后单元 $i$ 中的压力 $p_i^{n+1}$。用与初始条件相同的无量纲单位表示你的答案，并四舍五入到三位有效数字。", "solution": "我们使用守恒变量 $\\mathbf{U}=[\\rho,\\,m,\\,E]^{T}$（其中 $m=\\rho u$）和欧拉通量 $\\mathbf{F}(\\mathbf{U})=[m,\\,\\rho u^{2}+p,\\,u(E+p)]^{T}$。理想气体压力满足 $p=(\\gamma-1)\\left(E-\\frac{1}{2}\\rho u^{2}\\right)$，因此 $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$。\n\n给定 $\\gamma=1.4$ 和 $\\Delta t/\\Delta x=\\lambda=0.1$，在时间 $n$ 时三个单元的状态如下：\n- 单元 $i-1$：$\\rho_{i-1}=1$, $u_{i-1}=0$, $p_{i-1}=1$，那么 $m_{i-1}=0$ 且 $E_{i-1}=\\frac{1}{\\gamma-1}+0=\\frac{1}{0.4}=2.5$。因此\n$$\n\\mathbf{U}_{i-1}=[1,\\,0,\\,2.5]^{T},\\quad\n\\mathbf{F}(\\mathbf{U}_{i-1})=[0,\\,1,\\,0]^{T}.\n$$\n- 单元 $i$：$\\rho_{i}=0.1$, $u_{i}=4$, $p_{i}=0.01$，那么 $m_{i}=0.4$ 且 $E_{i}=\\frac{0.01}{0.4}+\\frac{1}{2}(0.1)(4^{2})=0.025+0.8=0.825$。因此\n$$\n\\mathbf{U}_{i}=[0.1,\\,0.4,\\,0.825]^{T},\\quad\n\\mathbf{F}(\\mathbf{U}_{i})=[0.4,\\,1.61,\\,3.34]^{T}.\n$$\n- 单元 $i+1$ 等于单元 $i$，所以 $\\mathbf{U}_{i+1}=\\mathbf{U}_{i}$ 且 $\\mathbf{F}(\\mathbf{U}_{i+1})=\\mathbf{F}(\\mathbf{U}_{i})$。\n\n在 $i-\\tfrac{1}{2}$ 处的预测值：\n$$\n\\mathbf{U}_{i-1/2}^{n+1/2}=\\tfrac{1}{2}(\\mathbf{U}_{i-1}+\\mathbf{U}_{i})-\\tfrac{\\lambda}{2}\\left(\\mathbf{F}(\\mathbf{U}_{i})-\\mathbf{F}(\\mathbf{U}_{i-1})\\right).\n$$\n按分量计算，\n$$\n\\rho_{L}=\\tfrac{1}{2}(1+0.1)-\\tfrac{0.1}{2}(0.4-0)=0.53,\n$$\n$$\nm_{L}=\\tfrac{1}{2}(0+0.4)-\\tfrac{0.1}{2}(1.61-1)=0.1695,\n$$\n$$\nE_{L}=\\tfrac{1}{2}(2.5+0.825)-\\tfrac{0.1}{2}(3.34-0)=1.4955.\n$$\n然后 $u_{L}=m_{L}/\\rho_{L}=0.1695/0.53=1695/5300$，并且\n$$\np_{L}=(\\gamma-1)\\left(E_{L}-\\tfrac{1}{2}\\rho_{L}u_{L}^{2}\\right)\n=0.4\\left(1.4955-\\tfrac{1}{2}\\cdot 0.53\\cdot\\left(\\tfrac{1695}{5300}\\right)^{2}\\right)\n\\approx 0.5873583942.\n$$\n因此，左界面通量使用这些原始变量：\n$$\n\\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})=\n\\bigl[m_{L},\\,\\rho_{L}u_{L}^{2}+p_{L},\\,u_{L}(E_{L}+p_{L})\\bigr]\n\\approx\n\\bigl[0.1695,\\,0.6415664232,\\,0.6661216945\\bigr]^{T}.\n$$\n\n在 $i+\\tfrac{1}{2}$ 处的预测值：\n$$\n\\mathbf{U}_{i+1/2}^{n+1/2}=\\tfrac{1}{2}(\\mathbf{U}_{i}+\\mathbf{U}_{i+1})-\\tfrac{\\lambda}{2}\\left(\\mathbf{F}(\\mathbf{U}_{i+1})-\\mathbf{F}(\\mathbf{U}_{i})\\right)\n=\\mathbf{U}_{i},\n$$\n所以 $\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2})=\\mathbf{F}(\\mathbf{U}_{i})=[0.4,\\,1.61,\\,3.34]^{T}$。\n\n对单元 $i$ 的修正值：\n$$\n\\mathbf{U}_{i}^{n+1}=\\mathbf{U}_{i}^{n}-\\lambda\\left(\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2})-\\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})\\right).\n$$\n计算通量差并更新：\n$$\n\\Delta \\mathbf{F}=\\bigl[0.4-0.1695,\\,1.61-0.6415664232,\\,3.34-0.6661216945\\bigr]^{T}\n=\\bigl[0.2305,\\,0.9684335768,\\,2.6738783055\\bigr]^{T},\n$$\n$$\n\\mathbf{U}_{i}^{n+1}=[0.1,\\,0.4,\\,0.825]^{T}-0.1\\,\\Delta \\mathbf{F}\n=\\bigl[0.07695,\\,0.30315664232,\\,0.5576121694505\\bigr]^{T}.\n$$\n\n从状态方程（EOS）中恢复 $p_{i}^{n+1}$：\n$$\np_{i}^{n+1}=(\\gamma-1)\\left(E_{i}^{n+1}-\\frac{1}{2}\\rho_{i}^{n+1}(u_{i}^{n+1})^2\\right)\n=(\\gamma-1)\\left(E_{i}^{n+1}-\\frac{(m_{i}^{n+1})^{2}}{2\\rho_{i}^{n+1}}\\right).\n$$\n当 $\\rho_{i}^{n+1}=0.07695$, $m_{i}^{n+1}=0.30315664232$ 时，我们有\n$$\n\\frac{(m_{i}^{n+1})^{2}}{2\\rho_{i}^{n+1}}\n=\\frac{0.0919039497827365}{0.1539}\\approx 0.597166664,\n$$\n所以\n$$\np_{i}^{n+1}=0.4\\left(0.5576121694505-0.597166664\\right)\\approx -0.0158218.\n$$\n四舍五入到三位有效数字，这得到了在崩溃中提到的非物理负压。", "answer": "$$\\boxed{-1.58 \\times 10^{-2}}$$", "id": "1761785"}, {"introduction": "在认识到经典格式的局限性后，我们转向现代高分辨率格式的核心——近似黎曼求解器。Roe求解器是其中最著名和应用最广泛的一种，但即便是如此精巧的格式也存在微妙的缺陷。本练习将让您深入研究Roe求解器的一个著名“病态”问题：在所谓的“跨音速稀疏波”（transonic rarefaction）情况下，它会错误地产生一个违背物理规律的膨胀激波。通过计算，您将识别出触发此错误的特定条件，并理解为何“熵修正”（entropy fix）是任何一个实用的、稳健的求解器中不可或缺的关键组件 [@problem_id:1761745]。", "problem": "考虑理想气体的一维欧拉方程，这在计算流体力学（CFD）中很常用。该系统由状态向量 $U$ 和通量向量 $F(U)$ 描述：\n$$U = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix}$$\n其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位体积的总能量，$p$ 是压力。该气体是完全气体，其状态方程为 $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$，其中绝热指数 $\\gamma = 1.4$。\n\n一个黎曼问题由两个恒定状态定义，即左状态（$U_L$）和右状态（$U_R$），在 $x=0$ 处由一个间断分隔。在时间 $t=0$ 时，状态为：\n- 左状态（$x  0$）：$\\rho_L = 1.0 \\text{ kg/m}^3$，$u_L = 0.9 \\text{ m/s}$，$p_L = 1.0 \\text{ Pa}$。\n- 右状态（$x > 0$）：$\\rho_R = 0.1 \\text{ kg/m}^3$，$u_R = 2.0 \\text{ m/s}$，$p_R = 0.2 \\text{ Pa}$。\n\nRoe 近似黎曼求解器基于一个线性化问题计算界面处的数值通量。这涉及到计算 Roe 平均量，用帽子符号表示。所需的公式为：\n- Roe 平均速度：$\\hat{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$\n- Roe 平均总焓：$\\hat{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$，其中 $H = (E+p)/\\rho$。\n- Roe 平均声速：$\\hat{c} = \\sqrt{(\\gamma-1)(\\hat{H} - \\frac{1}{2}\\hat{u}^2)}$\n\nRoe 平均雅可比矩阵的特征值为 $\\hat{\\lambda}_1 = \\hat{u} - \\hat{c}$，$\\hat{\\lambda}_2 = \\hat{u}$ 和 $\\hat{\\lambda}_3 = \\hat{u} + \\hat{c}$。对于一般状态 $U$，相应的特征值为 $\\lambda_1(U) = u - c$，$\\lambda_2(U) = u$ 和 $\\lambda_3(U) = u + c$，其中 $c = \\sqrt{\\gamma p / \\rho}$。\n\n对于给定的流动构型，可能会出现一种称为违反熵条件的膨胀激波的数值不稳定性。这与一个“跨音速”特征波族相关，对于该波族，特征速度 $\\lambda_k(U)$ 在界面两侧变号（即 $\\lambda_k(U_L)$ 和 $\\lambda_k(U_R)$ 符号相反）。\n\n计算与此特定跨音速波族相对应的 Roe 平均特征值 $\\hat{\\lambda}_k$。将最终答案四舍五入到四位有效数字，并以 m/s 为单位表示。", "solution": "给定完全气体的一维欧拉方程，其中 $\\gamma=1.4$，以及一个具有左右状态的黎曼问题。一个状态 $U$ 的特征速度为 $\\lambda_{1}(U)=u-c$，$\\lambda_{2}(U)=u$，$\\lambda_{3}(U)=u+c$，其中 $c=\\sqrt{\\gamma p/\\rho}$。Roe 平均速度为 $\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}$，$\\hat{\\lambda}_{2}=\\hat{u}$，$\\hat{\\lambda}_{3}=\\hat{u}+\\hat{c}$，其中\n$$\n\\hat{u}=\\frac{\\sqrt{\\rho_{L}}u_{L}+\\sqrt{\\rho_{R}}u_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}},\\quad\n\\hat{H}=\\frac{\\sqrt{\\rho_{L}}H_{L}+\\sqrt{\\rho_{R}}H_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}},\\quad\n\\hat{c}=\\sqrt{(\\gamma-1)\\left(\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\right)},\n$$\n且 $H=(E+p)/\\rho$ 及 $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$，因此\n$$\nH=\\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}+\\frac{1}{2}u^{2}.\n$$\n\n首先，计算左右声速和特征速度，以确定跨音速波族：\n$$\nc_{L}=\\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}}=\\sqrt{1.4\\cdot\\frac{1.0}{1.0}}=\\sqrt{1.4}\\approx 1.183215956,\n$$\n$$\nc_{R}=\\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}}=\\sqrt{1.4\\cdot\\frac{0.2}{0.1}}=\\sqrt{2.8}\\approx 1.673320053.\n$$\n接着\n$$\n\\lambda_{1}(U_{L})=u_{L}-c_{L}\\approx 0.9-1.183215956\\approx -0.283215956,\\quad \\lambda_{2}(U_{L})=u_{L}=0.9,\\quad \\lambda_{3}(U_{L})=u_{L}+c_{L}\\approx 2.083215956,\n$$\n$$\n\\lambda_{1}(U_{R})=u_{R}-c_{R}\\approx 2.0-1.673320053\\approx 0.326679947,\\quad \\lambda_{2}(U_{R})=u_{R}=2.0,\\quad \\lambda_{3}(U_{R})=u_{R}+c_{R}\\approx 3.673320053.\n$$\n只有 $k=1$ 族在界面两侧变号（左侧为负，右侧为正），因此跨音速波族是 $k=1$。因此我们必须计算 $\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}$。\n\n计算总焓：\n$$\n\\frac{\\gamma}{\\gamma-1}=\\frac{1.4}{0.4}=3.5,\\quad\nH_{L}=3.5\\frac{p_{L}}{\\rho_{L}}+\\frac{1}{2}u_{L}^{2}=3.5\\cdot 1.0+\\frac{1}{2}\\cdot 0.9^{2}=3.5+0.405=3.905,\n$$\n$$\nH_{R}=3.5\\frac{p_{R}}{\\rho_{R}}+\\frac{1}{2}u_{R}^{2}=3.5\\cdot\\frac{0.2}{0.1}+\\frac{1}{2}\\cdot 2.0^{2}=3.5\\cdot 2.0+2.0=9.0.\n$$\n计算 Roe 平均值。已知 $\\sqrt{\\rho_{L}}=1$ 和 $\\sqrt{\\rho_{R}}=\\sqrt{0.1}\\approx 0.316227766$，公分母为\n$$\nD=\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}=1+0.316227766016838\\approx 1.316227766016838.\n$$\n那么\n$$\n\\hat{u}=\\frac{1\\cdot 0.9+0.316227766016838\\cdot 2.0}{D}=\\frac{1.532455532033676}{1.316227766016838}\\approx 1.1642784,\n$$\n$$\n\\hat{H}=\\frac{1\\cdot 3.905+0.316227766016838\\cdot 9.0}{D}=\\frac{6.751049894151542}{1.316227766016838}\\approx 5.129089409.\n$$\n现在计算 Roe 声速：\n$$\n\\hat{u}^{2}\\approx (1.1642784)^{2}=1.35554419270656,\\quad \\frac{1}{2}\\hat{u}^{2}\\approx 0.67777209635328,\n$$\n$$\n\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\approx 5.129089409-0.67777209635328\\approx 4.45131731264672,\n$$\n$$\n\\hat{c}=\\sqrt{(\\gamma-1)\\left(\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\right)}=\\sqrt{0.4\\cdot 4.45131731264672}\\approx \\sqrt{1.780526925058688}\\approx 1.3343638.\n$$\n因此，对于跨音速族 $k=1$，\n$$\n\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}\\approx 1.1642784-1.3343638\\approx -0.1700854\\ \\text{m/s}.\n$$\n四舍五入到四位有效数字，得到 $-0.1701$ m/s。", "answer": "$$\\boxed{-0.1701}$$", "id": "1761745"}]}