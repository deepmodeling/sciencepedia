{"hands_on_practices": [{"introduction": "计算流体动力学（CFD）的核心在于将描述流体运动的连续统物理定律（如质量、动量和能量守恒）转化为计算机可以求解的代数方程组。这个过程被称为离散化。本练习将引导你亲手实践有限体积法（Finite Volume Method, FVM），这是现代CFD求解器中最常用的方法之一。你将为一个在非结构化网格中很常见的六边形控制体积推导质量守恒方程，从而深入理解物理守恒定律如何转变为离散形式。[@problem_id:1764386]", "problem": "在为一个浅水河流系统开发二维计算流体动力学（CFD）模型时，其计算域被离散化为由正六边形控制体积组成的网格。我们将分析单个此类控制体积的质量守恒。\n\n该控制体积是一个边长为 $L$ 的正六边形，以笛卡尔坐标系的原点 $(0,0)$ 为中心。我们假设模型是二维的，这对应于分析一个具有均匀单位深度的流动切片。该控制体积内流体的空间平均密度用 $\\rho_P$ 表示。\n\n六边形的面按逆时针方向从1到6编号，其中面1是位于上半平面（$y>0$）的水平面。为了进行数值近似，假定流动性质在每个面上是均匀的。对于每个面 $i$（其中 $i=1, \\dots, 6$），流体密度为 $\\rho_i$，速度矢量由 $\\vec{v}_i = u_i \\hat{i} + v_i \\hat{j}$ 给出。\n\n基于这些定义，推导控制体积内平均密度的时间变化率 $\\frac{d\\rho_P}{dt}$ 的表达式。您的答案应该是一个单一的解析表达式，用 $L$ 和各个面上的性质 $\\{\\rho_i, u_i, v_i\\}$（$i=1, \\dots, 6$）表示。", "solution": "我们对一个具有单位深度的二维固定控制体积使用积分形式的质量守恒：\n$$\\frac{d}{dt}\\int_{A}\\rho\\,dA+\\oint_{\\partial A}\\rho\\,\\vec{v}\\cdot\\vec{n}\\,dl=0.$$\n将面积平均密度 $\\rho_{P}$ 定义为 $\\int_{A}\\rho\\,dA=A\\,\\rho_{P}$（其中面积 A 固定），我们得到\n$$A\\,\\frac{d\\rho_{P}}{dt}+\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}\\,l_{i}=0,$$\n其中 $l_{i}$ 是面 $i$ 的长度，$\\vec{n}_{i}$ 是其外向单位法向量。对于边长为 $L$ 的正六边形，每个面的长度 $l_{i}=L$。边长为 $L$ 的正六边形的面积是\n$$A=6\\left(\\frac{\\sqrt{3}}{4}L^{2}\\right)=\\frac{3\\sqrt{3}}{2}\\,L^{2}.$$\n因此\n$$\\frac{d\\rho_{P}}{dt}=-\\frac{L}{A}\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}=-\\frac{2}{3\\sqrt{3}\\,L}\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}.$$\n将各个面按逆时针方向编号，面1为顶部的水平边。六个面的外向单位法向量为\n$$\\vec{n}_{1}=(0,1),\\quad \\vec{n}_{2}=\\left(-\\frac{\\sqrt{3}}{2},\\frac{1}{2}\\right),\\quad \\vec{n}_{3}=\\left(-\\frac{\\sqrt{3}}{2},-\\frac{1}{2}\\right),$$\n$$\\vec{n}_{4}=(0,-1),\\quad \\vec{n}_{5}=\\left(\\frac{\\sqrt{3}}{2},-\\frac{1}{2}\\right),\\quad \\vec{n}_{6}=\\left(\\frac{\\sqrt{3}}{2},\\frac{1}{2}\\right).$$\n将 $\\vec{v}_{i}=u_{i}\\hat{i}+v_{i}\\hat{j}$ 代入并进行点积运算，得到\n$$\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}=\\rho_{1}v_{1}+\\rho_{2}\\left(-\\frac{\\sqrt{3}}{2}u_{2}+\\frac{1}{2}v_{2}\\right)+\\rho_{3}\\left(-\\frac{\\sqrt{3}}{2}u_{3}-\\frac{1}{2}v_{3}\\right)-\\rho_{4}v_{4}+\\rho_{5}\\left(\\frac{\\sqrt{3}}{2}u_{5}-\\frac{1}{2}v_{5}\\right)+\\rho_{6}\\left(\\frac{\\sqrt{3}}{2}u_{6}+\\frac{1}{2}v_{6}\\right).$$\n代入并提取公因数消去分数中的1/2，得到以下紧凑表达式\n$$\\frac{d\\rho_{P}}{dt}=-\\frac{1}{3\\sqrt{3}\\,L}\\Big[2\\rho_{1}v_{1}+\\rho_{2}(-\\sqrt{3}\\,u_{2}+v_{2})+\\rho_{3}(-\\sqrt{3}\\,u_{3}-v_{3})-2\\rho_{4}v_{4}+\\rho_{5}(\\sqrt{3}\\,u_{5}-v_{5})+\\rho_{6}(\\sqrt{3}\\,u_{6}+v_{6})\\Big].$$\n此表达式即为所求的用 $L$ 和面上性质表示的平均密度的时间变化率。", "answer": "$$\\boxed{-\\frac{1}{3\\sqrt{3}\\,L}\\left[2\\rho_{1}v_{1}+\\rho_{2}\\left(-\\sqrt{3}\\,u_{2}+v_{2}\\right)+\\rho_{3}\\left(-\\sqrt{3}\\,u_{3}-v_{3}\\right)-2\\rho_{4}v_{4}+\\rho_{5}\\left(\\sqrt{3}\\,u_{5}-v_{5}\\right)+\\rho_{6}\\left(\\sqrt{3}\\,u_{6}+v_{6}\\right)\\right]}$$", "id": "1764386"}, {"introduction": "选择一种离散格式只是CFD分析的第一步；我们还必须确保所选的数值方案能够产生物理上真实可靠的结果。一个不恰当的格式可能会引入非物理的振荡，导致解完全错误。本练习将深入探讨一个关键概念：数值稳定性。通过分析一个看似直观的中心差分格式，你将发现它在对流占主导时可能失效，并推导出保证解的物理真实性的关键判据——网格佩克莱数（cell Péclet number）。[@problem_id:1764340]", "problem": "在计算流体动力学 (CFD) 领域，一个核心挑战是输运方程的精确数值求解。考虑一个标量 $\\phi$（例如在具有稳定均匀流体流动的狭窄通道中污染物的浓度）的一维稳态对流-扩散方程。其非守恒形式的控制方程由下式给出：\n$$u \\frac{d\\phi}{dx} - \\Gamma \\frac{d^2\\phi}{dx^2} = 0$$\n此处，$u$ 是恒定的正流体速度，$\\Gamma$ 是恒定的正扩散系数，$x$ 是空间坐标。\n\n为了对该方程进行数值求解，我们在一个均匀网格上将其离散化，节点由 $i$ 索引。节点 $i$ 的位置是 $x_i$，相邻节点之间的恒定间距为 $\\Delta x = x_{i+1} - x_i$。我们将使用有限差分法，采用二阶中心差分格式来近似一阶导数（对流项）和二阶导数（扩散项）。\n\n对于任何内部节点 $i$，得到的代数方程可以重排为以下通用形式，该形式将一个节点上的值与其直接相邻的节点联系起来：\n$$a_P \\phi_i = a_W \\phi_{i-1} + a_E \\phi_{i+1}$$\n在此约定中，下标 $P$、$W$ 和 $E$ 分别指中心（\"P\"oint）、西侧（$i-1$）和东侧（$i+1$）节点。\n\n一个数值格式要能产生物理上真实的解（即避免非物理振荡），其关键要求是连接一个节点与其相邻节点的系数（$a_W$ 和 $a_E$）必须为非负。\n\n通过如上所述离散化控制方程，确定无量纲网格佩克莱数 $Pe = \\frac{u \\Delta x}{\\Gamma}$ 的最大值，使得系数 $a_W$ 和 $a_E$ 的非负性条件得以满足。", "solution": "我们从稳态一维对流-扩散方程开始\n$$u \\frac{d\\phi}{dx} - \\Gamma \\frac{d^{2}\\phi}{dx^{2}} = 0,$$\n其中 $u0$、$\\Gamma0$ 为常数，且网格为间距 $\\Delta x$ 的均匀网格。\n\n在节点 $i$ 处使用二阶中心差分，\n$$\\left.\\frac{d\\phi}{dx}\\right|_{i} \\approx \\frac{\\phi_{i+1} - \\phi_{i-1}}{2 \\Delta x}, \\qquad \\left.\\frac{d^{2}\\phi}{dx^{2}}\\right|_{i} \\approx \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}.$$\n代入微分方程得到\n$$u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2 \\Delta x} - \\Gamma \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}} = 0.$$\n展开并重新组合各项，\n$$\\frac{\\Gamma}{\\Delta x^{2}} \\phi_{i+1} - \\frac{2 \\Gamma}{\\Delta x^{2}} \\phi_{i} + \\frac{\\Gamma}{\\Delta x^{2}} \\phi_{i-1} - \\frac{u}{2 \\Delta x} \\phi_{i+1} + \\frac{u}{2 \\Delta x} \\phi_{i-1} = 0.$$\n将相邻项移到右侧，以匹配 $a_{P} \\phi_{i} = a_{W} \\phi_{i-1} + a_{E} \\phi_{i+1}$ 的形式：\n$$\\frac{2 \\Gamma}{\\Delta x^{2}} \\phi_{i} = \\left(\\frac{\\Gamma}{\\Delta x^{2}} + \\frac{u}{2 \\Delta x}\\right) \\phi_{i-1} + \\left(\\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x}\\right) \\phi_{i+1}.$$\n因此，\n$$a_{P} = \\frac{2 \\Gamma}{\\Delta x^{2}}, \\quad a_{W} = \\frac{\\Gamma}{\\Delta x^{2}} + \\frac{u}{2 \\Delta x}, \\quad a_{E} = \\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x}.$$\n\n对相邻系数的非负性要求是\n$$a_{W} \\ge 0, \\qquad a_{E} \\ge 0.$$\n由于 $u0$、$\\Gamma0$ 且 $\\Delta x0$，我们自动得到 $a_{W}  0$。约束性条件是 $a_{E} \\ge 0$，即，\n$$\\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x} \\ge 0 \\quad \\Longleftrightarrow \\quad \\frac{u \\Delta x}{\\Gamma} \\le 2.$$\n定义网格佩克莱数 $Pe = \\frac{u \\Delta x}{\\Gamma}$，确保 $a_{W}$ 和 $a_E$ 为非负的最大值是\n$$Pe_{\\max} = 2.$$", "answer": "$$\\boxed{2}$$", "id": "1764340"}, {"introduction": "在开发和使用CFD软件时，一个至关重要的环节是代码验证（verification）：我们如何确定代码正确地求解了它应该求解的数学方程？直接用复杂的真实流动问题来测试是困难的，因为我们通常不知道精确的解析解。本练习将向你介绍一种严谨且强大的代码验证技术——“人造解方法”（Method of Manufactured Solutions, MMS）。你将扮演一位CFD开发者的角色，从一个预设的解析解出发，反向推导出所需的源项，从而构建一个可以精确衡量求解器计算精度的测试案例。[@problem_id:1764341]", "problem": "在计算流体动力学 (CFD) 领域，制造解方法 (MMS) 是一个严格的程序，用于验证数值求解器实施的正确性。该方法涉及选择一个非平凡的解析函数，作为控制偏微分方程的“制造”解。然后将此函数代入方程，以确定能使方程成立的相应源项。接着将此源项编入 CFD 代码中，并将数值结果与已知的制造解进行比较，以评估求解器的精度阶。\n\n作为一名 CFD 开发者，您的任务是为一个新求解器创建一个验证案例。该求解器用于处理标量 $\\phi(x,y)$ 的稳态二维对流扩散方程。控制方程由下式给出：\n$$U \\frac{\\partial \\phi}{\\partial x} + V \\frac{\\partial \\phi}{\\partial y} = \\Gamma \\left( \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} \\right) + S_\\phi(x,y)$$\n此处，$U$ 和 $V$ 分别是 $x$ 和 $y$ 方向的恒定速度分量，$\\Gamma$ 是恒定扩散系数。$S_\\phi(x,y)$ 是单位体积的源项。\n\n您选择了以下制造解：\n$$\\phi_m(x,y) = A \\sin(k_x x) \\exp(-\\alpha y) + C x^2 y$$\n其中 $A, C, k_x$ 和 $\\alpha$ 是已知的非零常数。\n\n您的任务是确定源项 $S_\\phi(x,y)$ 的解析表达式，该表达式必须在代码中实现，以使 $\\phi_m(x,y)$ 成为控制对流扩散方程的精确解。请提供以 $x, y$ 和给定常数 $U, V, \\Gamma, A, C, k_x$ 及 $\\alpha$ 表示的 $S_\\phi(x,y)$ 的完整表达式。", "solution": "我们从具有恒定系数的标量场 $\\phi(x,y)$ 的稳态二维对流扩散方程开始：\n$$\nU \\frac{\\partial \\phi}{\\partial x} + V \\frac{\\partial \\phi}{\\partial y} = \\Gamma \\left( \\frac{\\partial^{2} \\phi}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi}{\\partial y^{2}} \\right) + S_{\\phi}(x,y).\n$$\n给定制造解\n$$\n\\phi_{m}(x,y) = A \\sin(k_{x} x) \\exp(-\\alpha y) + C x^{2} y,\n$$\n通过将 $\\phi_{m}$ 代入控制方程并求解 $S_{\\phi}(x,y)$，可以得到使 $\\phi_{m}$ 成为精确解的源项：\n$$\nS_{\\phi}(x,y) = U \\frac{\\partial \\phi_{m}}{\\partial x} + V \\frac{\\partial \\phi_{m}}{\\partial y} - \\Gamma \\left( \\frac{\\partial^{2} \\phi_{m}}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi_{m}}{\\partial y^{2}} \\right).\n$$\n\n计算所需的导数。一阶导数：\n$$\n\\frac{\\partial \\phi_{m}}{\\partial x} = A k_{x} \\cos(k_{x} x) \\exp(-\\alpha y) + 2 C x y,\n$$\n$$\n\\frac{\\partial \\phi_{m}}{\\partial y} = -\\alpha A \\sin(k_{x} x) \\exp(-\\alpha y) + C x^{2}.\n$$\n\n二阶导数：\n$$\n\\frac{\\partial^{2} \\phi_{m}}{\\partial x^{2}} = -A k_{x}^{2} \\sin(k_{x} x) \\exp(-\\alpha y) + 2 C y,\n$$\n$$\n\\frac{\\partial^{2} \\phi_{m}}{\\partial y^{2}} = \\alpha^{2} A \\sin(k_{x} x) \\exp(-\\alpha y).\n$$\n\n构造拉普拉斯算子：\n$$\n\\frac{\\partial^{2} \\phi_{m}}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi_{m}}{\\partial y^{2}} = A (\\alpha^{2} - k_{x}^{2}) \\sin(k_{x} x) \\exp(-\\alpha y) + 2 C y.\n$$\n\n计算对流项：\n$$\nU \\frac{\\partial \\phi_{m}}{\\partial x} + V \\frac{\\partial \\phi_{m}}{\\partial y} = A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) - V \\alpha \\sin(k_{x} x) \\right] + 2 U C x y + V C x^{2}.\n$$\n\n代入 $S_{\\phi}(x,y)$ 的表达式中：\n$$\nS_{\\phi}(x,y) = A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) - V \\alpha \\sin(k_{x} x) \\right] + 2 U C x y + V C x^{2} - \\Gamma \\left[ A (\\alpha^{2} - k_{x}^{2}) \\sin(k_{x} x) \\exp(-\\alpha y) + 2 C y \\right].\n$$\n\n合并乘以共同因子的项，以获得紧凑形式：\n$$\nS_{\\phi}(x,y) = A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) + \\left( \\Gamma (k_{x}^{2} - \\alpha^{2}) - V \\alpha \\right) \\sin(k_{x} x) \\right] + C \\left( 2 U x y + V x^{2} - 2 \\Gamma y \\right).\n$$\n这就是所需的解析源项，用 $x$, $y$ 和常数 $U, V, \\Gamma, A, C, k_{x}$ 及 $\\alpha$ 表示。", "answer": "$$\\boxed{A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) + \\left( \\Gamma (k_{x}^{2} - \\alpha^{2}) - V \\alpha \\right) \\sin(k_{x} x) \\right] + C \\left( 2 U x y + V x^{2} - 2 \\Gamma y \\right)}$$", "id": "1764341"}]}