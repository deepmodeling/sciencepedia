{"hands_on_practices": [{"introduction": "要真正理解总谐波失真（THD），最好的方法是从其基本定义出发，通过分析一个非正弦波形的频谱构成。本练习将通过一个理想方波的例子，引导你使用傅里叶级数来精确计算其THD。这个过程不仅能加深你对THD物理意义的理解，即将信号分解为基波和一系列谐波，还能锻炼你将数学工具应用于实际信号分析的核心技能。[@problem_id:1342909]", "problem": "在电子系统的分析中，评估信号的纯度通常是必要的。考虑一个由函数发生器产生的理想对称方波电压 $v(t)$。该信号的峰值振幅为 $V_0$，周期为 $T$。在一个周期内，该波形定义如下：\n$$\nv(t) = \\begin{cases}\n+V_0  & \\text{for } 0  t  T/2 \\\\\n-V_0   \\text{for } T/2  t  T\n\\end{cases}\n$$\n信号与纯正弦波的偏差由其总谐波失真（THD）来量化。THD 定义为所有谐波分量（从二次谐波起）的总有效值（RMS）与基波分量的有效值之比。这可以表示为：\n$$THD = \\frac{\\sqrt{\\sum_{n=2}^{\\infty} V_{n, \\text{rms}}^2}}{V_{1, \\text{rms}}}$$\n其中 $V_{n, \\text{rms}}$ 表示第 $n$ 次谐波的有效值电压。\n\n计算此理想方波的精确理论THD。以简化的解析表达式形式给出你的答案。", "solution": "设方波的基波角频率为 $\\omega_{0} = \\frac{2\\pi}{T}$。其在一个周期内的傅里叶级数可以写为\n$$\nv(t) = \\sum_{n=1}^{\\infty} \\left[a_{n}\\cos(n\\omega_{0}t) + b_{n}\\sin(n\\omega_{0}t)\\right].\n$$\n由于 $v(t+T/2) = -v(t)$（半波对称性），因此没有直流分量，也没有偶次谐波。我们显式地计算正弦系数：\n$$\nb_{n} = \\frac{2}{T}\\int_{0}^{T} v(t)\\sin(n\\omega_{0}t)\\,dt = \\frac{2}{T}\\left[\\int_{0}^{T/2} V_{0}\\sin(n\\omega_{0}t)\\,dt + \\int_{T/2}^{T} (-V_{0})\\sin(n\\omega_{0}t)\\,dt\\right].\n$$\n计算积分，\n$$\n\\int \\sin(n\\omega_{0}t)\\,dt = -\\frac{\\cos(n\\omega_{0}t)}{n\\omega_{0}},\n$$\n所以\n$$\n\\int_{0}^{T/2} V_{0}\\sin(n\\omega_{0}t)\\,dt = \\frac{V_{0}}{n\\omega_{0}}\\left[-\\cos\\left(n\\omega_{0}\\frac{T}{2}\\right) + 1\\right],\n$$\n$$\n\\int_{T/2}^{T} (-V_{0})\\sin(n\\omega_{0}t)\\,dt = \\frac{V_{0}}{n\\omega_{0}}\\left[\\cos(n\\omega_{0}T) - \\cos\\left(n\\omega_{0}\\frac{T}{2}\\right)\\right].\n$$\n两式相加，\n$$\n\\int_{0}^{T} v(t)\\sin(n\\omega_{0}t)\\,dt = \\frac{V_{0}}{n\\omega_{0}}\\left[2 - 2\\cos\\left(n\\omega_{0}\\frac{T}{2}\\right)\\right].\n$$\n使用 $\\omega_{0} = \\frac{2\\pi}{T}$ 可得 $\\cos\\left(n\\omega_{0}\\frac{T}{2}\\right) = \\cos(n\\pi) = (-1)^{n}$ 且 $\\cos(n\\omega_{0}T) = \\cos(2\\pi n) = 1$。因此\n$$\nb_{n} = \\frac{2}{T}\\cdot \\frac{V_{0}}{n\\omega_{0}}\\cdot 2\\left[1 - \\cos(n\\pi)\\right] = \\frac{4V_{0}}{T n \\omega_{0}}\\left[1 - (-1)^{n}\\right] = \\frac{2V_{0}}{\\pi n}\\left[1 - (-1)^{n}\\right].\n$$\n因此，当 $n$ 为奇数时，$b_{n} = \\frac{4V_{0}}{\\pi n}$；当 $n$ 为偶数时，$b_{n}=0$，而所有的 $a_{n}=0$。第 $n$ 次谐波是峰值振幅为 $|b_{n}|$ 的正弦波，所以其有效值为\n$$\nV_{n,\\text{rms}} = \\frac{|b_{n}|}{\\sqrt{2}} = \n\\begin{cases}\n\\frac{4V_{0}}{\\pi n\\sqrt{2}},  n \\text{ 为奇数}, \\\\\n0,  n \\text{ 为偶数}.\n\\end{cases}\n$$\n特别地，基波的有效值为\n$$\nV_{1,\\text{rms}} = \\frac{4V_{0}}{\\pi\\sqrt{2}}.\n$$\nTHD为\n$$\n\\text{THD} = \\frac{\\sqrt{\\sum_{n=2}^{\\infty} V_{n,\\text{rms}}^{2}}}{V_{1,\\text{rms}}} = \\frac{\\sqrt{\\sum_{\\substack{n=3\\\\ n\\ \\text{为奇数}}}^{\\infty} \\left(\\frac{4V_{0}}{\\pi n\\sqrt{2}}\\right)^{2}}}{\\frac{4V_{0}}{\\pi\\sqrt{2}}} = \\sqrt{\\sum_{\\substack{n=3\\\\ n\\ \\text{为奇数}}}^{\\infty} \\frac{1}{n^{2}}}.\n$$\n使用已知级数 $\\sum_{n=1}^{\\infty}\\frac{1}{n^{2}} = \\frac{\\pi^{2}}{6}$ 并提取奇数项，\n$$\n\\sum_{\\substack{n=1\\\\ n\\ \\text{为奇数}}}^{\\infty} \\frac{1}{n^{2}} = \\sum_{n=1}^{\\infty} \\frac{1}{n^{2}} - \\sum_{n=1}^{\\infty} \\frac{1}{(2n)^{2}} = \\frac{\\pi^{2}}{6} - \\frac{1}{4}\\cdot \\frac{\\pi^{2}}{6} = \\frac{\\pi^{2}}{8}.\n$$\n因此，\n$$\n\\sum_{\\substack{n=3\\\\ n\\ \\text{为奇数}}}^{\\infty} \\frac{1}{n^{2}} = \\frac{\\pi^{2}}{8} - 1,\n$$\n并且\n$$\n\\text{THD} = \\sqrt{\\frac{\\pi^{2}}{8} - 1}.\n$$\n这就是理想对称方波的精确理论THD。", "answer": "$$\\boxed{\\sqrt{\\frac{\\pi^{2}}{8}-1}}$$", "id": "1342909"}, {"introduction": "在理想情况下，放大器应完美地线性放大信号，但现实中的器件总会引入或多或少的非线性。本练习模拟了一个常见的场景：一个具有弱三次方非线性的放大器，这是对真实放大器行为的有效近似。通过分析一个纯正弦波输入如何在这个非线性系统中产生谐波，你将推导出一个简洁的THD表达式，从而揭示失真与输入信号幅度和器件非线性特性之间的直接关系。[@problem_id:1342877]", "problem": "一位音频工程师正在对一个新的前置放大器级进行特性分析。通过测试，他们发现对于足够小的输入信号，该放大器的输入-输出电压关系可以用一个弱三次非线性模型来描述。输出电压 $V_{out}$ 与输入电压 $V_{in}$ 通过传递函数 $V_{out}(t) = a_1 V_{in}(t) + a_3 V_{in}^3(t)$ 相关联。其中，$a_1  0$ 是主线性增益系数，$a_3$ 是一个小的、非零的三次失真系数。弱非线性的条件由 $|a_3 V_p^2| \\ll a_1$ 给出。\n\n一个纯正弦测试信号 $V_{in}(t) = V_p \\sin(\\omega_0 t)$ 被施加到该前置放大器的输入端。非线性项的引入会在输出信号中产生谐波频率。\n\n总谐波失真 (THD) 定义为所有谐波分量（高于基频的频率）之和的均方根 (RMS) 电压与基波分量的均方根电压之比。\n\n假设弱非线性条件成立，推导输出信号 $V_{out}(t)$ 的总谐波失真 (THD) 的一个简化的闭式解析表达式。你的最终表达式应以参数 $V_p$、$a_1$ 和 $a_3$ 表示。", "solution": "我们从给定的传递函数和正弦输入开始。使用 $V_{in}(t) = V_{p} \\sin(\\omega_{0} t)$，输出为\n$$\nV_{out}(t) = a_{1} V_{p} \\sin(\\omega_{0} t) + a_{3} V_{p}^{3} \\sin^{3}(\\omega_{0} t).\n$$\n应用三角恒等式 $\\sin^{3} x = \\frac{3 \\sin x - \\sin 3x}{4}$ 来分离基波和三次谐波：\n$$\nV_{out}(t) = \\left(a_{1} V_{p} + \\frac{3}{4} a_{3} V_{p}^{3}\\right) \\sin(\\omega_{0} t) - \\frac{1}{4} a_{3} V_{p}^{3} \\sin(3 \\omega_{0} t).\n$$\n因此，在 $\\omega_{0}$ 处的基波分量的峰值振幅为\n$$\nA_{1} = a_{1} V_{p} + \\frac{3}{4} a_{3} V_{p}^{3},\n$$\n并且唯一存在的谐波是位于 $3 \\omega_{0}$ 处的三次谐波，其峰值振幅为\n$$\nA_{3} = -\\frac{1}{4} a_{3} V_{p}^{3}.\n$$\n对于一个正弦波 $A \\sin(\\cdot)$，其均方根值为 $|A|/\\sqrt{2}$。所有谐波之和的均方根值等于它们各自均方根值平方和的平方根；这里只存在三次谐波，所以总谐波均方根值为 $|A_{3}|/\\sqrt{2}$。基波的均方根值为 $|A_{1}|/\\sqrt{2}$。因此，精确的 THD 为\n$$\n\\mathrm{THD} = \\frac{|A_{3}|/\\sqrt{2}}{|A_{1}|/\\sqrt{2}} = \\frac{|A_{3}|}{|A_{1}|} = \\frac{\\left|\\frac{1}{4} a_{3} V_{p}^{3}\\right|}{\\left|a_{1} V_{p} + \\frac{3}{4} a_{3} V_{p}^{3}\\right|} = \\frac{|a_{3}| V_{p}^{2}}{\\left|4 a_{1} + 3 a_{3} V_{p}^{2}\\right|}.\n$$\n在弱非线性条件 $|a_{3} V_{p}^{2}| \\ll a_{1}$ 下，与 $a_{1} V_{p}$ 相比，对基波振幅的三次修正可以忽略不计，因此 $|A_{1}| \\approx a_{1} V_{p}$。仅保留 $a_{3} V_{p}^{2}/a_{1}$ 的主导项，得到简化的闭式表达式\n$$\n\\mathrm{THD} \\approx \\frac{|a_{3}| V_{p}^{3}/4}{a_{1} V_{p}} = \\frac{|a_{3}| V_{p}^{2}}{4 a_{1}}.\n$$\n该表达式以 $V_{p}$、$a_{1}$ 和 $a_{3}$ 表示，其中 $a_{1}  0$ 且 $a_{3}$ 的符号可以是正或负；绝对值保证了 THD 为非负值。", "answer": "$$\\boxed{\\frac{|a_{3}| V_{p}^{2}}{4 a_{1}}}$$", "id": "1342877"}, {"introduction": "理解了失真的来源后，下一步自然是学习如何抑制它。本练习将探讨一种最常见的信号处理技术——滤波——如何用来改善信号质量。你将计算一个含有多个谐波分量的信号在通过一个简单的一阶低通滤波器后，其THD发生的变化。这个实践操作将让你直观地看到滤波器是如何通过衰减高频谐波来“净化”信号的，从而将THD从一个抽象的度量指标，转变为一个在电路设计中可以主动控制的参数。[@problem_id:1342927]", "problem": "一个非理想振荡器产生的音频信号被发现由一个基频分量和多个谐波组成。输入信号 $v_{in}(t)$ 可由以下有限傅里叶级数精确描述：\n$$v_{in}(t) = \\sum_{n=1}^{5} V_n \\sin(2\\pi n f_1 t)$$\n基频为 $f_1 = 1.0 \\text{ kHz}$。测得前五个频率分量的电压幅值如下：\n- 基波 (n=1): $V_1 = 2.0 \\text{ V}$\n- 2次谐波 (n=2): $V_2 = 0.20 \\text{ V}$\n- 3次谐波 (n=3): $V_3 = 0.15 \\text{ V}$\n- 4次谐波 (n=4): $V_4 = 0.10 \\text{ V}$\n- 5次谐波 (n=5): $V_5 = 0.05 \\text{ V}$\n\n该信号通过一个简单的一阶RC低通滤波器进行净化。滤波器的复电压传递函数 $H(j\\omega)$ 由下式给出：\n$$H(j\\omega) = \\frac{1}{1 + j\\frac{\\omega}{\\omega_c}}$$\n其中 $\\omega = 2\\pi f$ 是信号分量的角频率，$\\omega_c = 2\\pi f_c$ 是滤波器的截止角频率。该滤波器设计的截止频率为 $f_c = 1.8 \\text{ kHz}$。\n\n信号的总谐波失真 (THD) 定义为所有谐波分量（基频以上）的总有效值（RMS）与基频分量的有效值（RMS）之比。对于由离散正弦波组成的信号，该值由以下公式给出：\n$$THD = \\frac{\\sqrt{\\sum_{n=2}^{\\infty} V_n^2}}{V_1}$$\n\n假设滤波器根据其传递函数理想工作，并且不引入任何新的失真，请计算滤波器输出信号 $v_{out}(t)$ 的总谐波失真 (THD)。将您的答案表示为小数值，并四舍五入到三位有效数字。", "solution": "题目要求计算信号在通过一阶RC低通滤波器后的总谐波失真 (THD)。为此，我们首先需要确定滤波器输出端每个频率分量的幅值。\n\n一个由其传递函数 $H(j\\omega)$ 描述的线性滤波器，会修改输入信号的每个正弦分量的幅度和相位。输出分量的幅值 $V'_n$ 是输入幅值 $V_n$ 乘以在分量频率 $\\omega_n = 2\\pi n f_1$ 处计算的传递函数的模 $|H(j\\omega_n)|$。\n\n给定传递函数的模为：\n$$|H(j\\omega)| = \\left| \\frac{1}{1 + j\\frac{\\omega}{\\omega_c}} \\right| = \\frac{|1|}{\\left|1 + j\\frac{\\omega}{\\omega_c}\\right|} = \\frac{1}{\\sqrt{1^2 + \\left(\\frac{\\omega}{\\omega_c}\\right)^2}} = \\frac{1}{\\sqrt{1 + \\left(\\frac{f}{f_c}\\right)^2}}$$\n其中 $f$ 是分量的频率，$f_c$ 是滤波器的截止频率。\n\n给定 $f_1 = 1.0 \\text{ kHz}$ 和 $f_c = 1.8 \\text{ kHz}$。我们现在对从 n=1 到 n=5 的每个分量计算其输出幅值 $V'_n = V_n \\cdot |H(j\\omega_n)|$。\n\n对于基波分量 ($n=1$):\n频率为 $f_1 = 1.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_1)| = \\frac{1}{\\sqrt{1 + (1.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 0.3086}} \\approx 0.8742$。\n输出幅值为 $V'_1 = V_1 \\cdot |H(j\\omega_1)| = 2.0 \\text{ V} \\cdot 0.8742 = 1.7484 \\text{ V}$。\n\n对于2次谐波 ($n=2$):\n频率为 $f_2 = 2 \\cdot 1.0 \\text{ kHz} = 2.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_2)| = \\frac{1}{\\sqrt{1 + (2.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 1.2346}} \\approx 0.6690$。\n输出幅值为 $V'_2 = V_2 \\cdot |H(j\\omega_2)| = 0.20 \\text{ V} \\cdot 0.6690 = 0.1338 \\text{ V}$。\n\n对于3次谐波 ($n=3$):\n频率为 $f_3 = 3 \\cdot 1.0 \\text{ kHz} = 3.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_3)| = \\frac{1}{\\sqrt{1 + (3.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 2.7778}} \\approx 0.5145$。\n输出幅值为 $V'_3 = V_3 \\cdot |H(j\\omega_3)| = 0.15 \\text{ V} \\cdot 0.5145 = 0.07718 \\text{ V}$。\n\n对于4次谐波 ($n=4$):\n频率为 $f_4 = 4 \\cdot 1.0 \\text{ kHz} = 4.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_4)| = \\frac{1}{\\sqrt{1 + (4.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 4.9383}} \\approx 0.4103$。\n输出幅值为 $V'_4 = V_4 \\cdot |H(j\\omega_4)| = 0.10 \\text{ V} \\cdot 0.4103 = 0.04103 \\text{ V}$。\n\n对于5次谐波 ($n=5$):\n频率为 $f_5 = 5 \\cdot 1.0 \\text{ kHz} = 5.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_5)| = \\frac{1}{\\sqrt{1 + (5.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 7.7160}} \\approx 0.3398$。\n输出幅值为 $V'_5 = V_5 \\cdot |H(j\\omega_5)| = 0.05 \\text{ V} \\cdot 0.3398 = 0.01699 \\text{ V}$。\n\n现在，我们可以使用提供的公式和新的输出幅值来计算输出信号的 THD。谐波幅值的平方和为：\n$$\\sum_{n=2}^{5} (V'_n)^2 = (V'_2)^2 + (V'_3)^2 + (V'_4)^2 + (V'_5)^2$$\n$$\\sum_{n=2}^{5} (V'_n)^2 = (0.1338)^2 + (0.07718)^2 + (0.04103)^2 + (0.01699)^2$$\n$$\\sum_{n=2}^{5} (V'_n)^2 \\approx 0.01790 + 0.005957 + 0.001683 + 0.0002887 \\approx 0.02583 \\text{ V}^2$$\n\n此和的平方根（THD公式的分子）为：\n$$\\sqrt{\\sum_{n=2}^{5} (V'_n)^2} \\approx \\sqrt{0.02583} \\approx 0.1607 \\text{ V}$$\n\n最后，输出信号的 THD 是该分子值与基波幅值 $V'_1$ 之比：\n$$THD_{out} = \\frac{\\sqrt{\\sum_{n=2}^{5} (V'_n)^2}}{V'_1} \\approx \\frac{0.1607 \\text{ V}}{1.7484 \\text{ V}} \\approx 0.09191$$\n\n将结果四舍五入到三位有效数字，我们得到 0.0919。", "answer": "$$\\boxed{0.0919}$$", "id": "1342927"}]}