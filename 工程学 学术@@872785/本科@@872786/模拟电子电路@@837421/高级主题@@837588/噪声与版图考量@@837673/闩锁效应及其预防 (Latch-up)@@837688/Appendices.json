{"hands_on_practices": [{"introduction": "为了有效防止闩锁效应，我们首先必须理解触发它的条件。本练习提供了一个定量模型，用于确定CMOS输入缓冲器的最大安全输入电压，将外部的电气过应力与内部的寄生导通机制直接联系起来。通过进行这项计算 [@problem_id:1314400]，你将对闩锁触发阈值有一个具体的理解。", "problem": "一个 3.3V 互补金属氧化物半导体 (CMOS) 输入缓冲器通过一个串联电阻 $R_s$ 连接到一个外部信号源。该器件的内部结构产生了一个寄生的垂直 PNP 双极结型晶体管 (BJT) 和一个寄生的横向 NPN BJT，它们共同形成一个类似晶闸管的结构。如果输入受到足够的电过应力，这个寄生结构会触发一种称为闩锁效应的破坏性大电流状态。\n\n在这种情况下，闩锁效应的引发过程被建模如下：一个超过 CMOS 电源电压 ($V_{DD}$) 的外部信号电压导致内部输入保护二极管正向偏置。该保护二极管将输入引脚连接到 $V_{DD}$ 电源轨，并具有 $V_D$ 的正向压降。当它导通时，一个注入电流 $I_{in}$ 流入器件。该电流被假定完全充当寄生 PNP 晶体管的基极电流。PNP 晶体管产生的集电极电流随后流过衬底的寄生电阻 $R_{sub}$，在其上产生一个电压降。该电压降充当寄生 NPN 晶体管的基极-发射极电压。当该电压达到 NPN 的基极-发射极导通电压 $V_{on,npn}$ 时，闩锁效应被触发。\n\n给定电路和寄生元件的以下参数：\n- 电源电压, $V_{DD} = 3.3~\\text{V}$\n- 串联电阻, $R_s = 500$ $\\Omega$\n- 寄生衬底电阻, $R_{sub} = 200$ $\\Omega$\n- 寄生N阱电阻, $R_{well} = 150$ $\\Omega$\n- PNP 电流增益, $\\beta_{pnp} = 5.5$\n- NPN 电流增益, $\\beta_{npn} = 30$\n- NPN 基极-发射极导通电压, $V_{on,npn} = 0.70~\\text{V}$\n- 保护二极管正向电压, $V_D = 0.75~\\text{V}$\n\n计算在不触发闩锁效应的情况下可以施加的外部信号源的最大电压。以伏特为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "设外部源电压为 $V_{S}$。当输入保护二极管正向偏置时，输入节点被钳位到 $V_{DD}+V_{D}$，根据欧姆定律，通过串联电阻的注入电流为：\n$$\nI_{in}=\\frac{V_{S}-(V_{DD}+V_{D})}{R_{s}} \\quad \\text{当 } V_{S}>V_{DD}+V_{D}.\n$$\n根据问题的假设，该注入电流完全充当寄生 PNP 的基极电流，因此\n$$\nI_{B,pnp}=I_{in}.\n$$\n使用 PNP 电流增益，\n$$\nI_{C,pnp}=\\beta_{pnp}\\,I_{B,pnp}=\\beta_{pnp}\\,I_{in}.\n$$\n该集电极电流流过衬底电阻，产生的电压降充当 NPN 的基极-发射极电压：\n$$\nV_{BE,npn} = I_{C,pnp}\\,R_{sub} = \\beta_{pnp}\\,I_{in}\\,R_{sub}.\n$$\n当该电压达到 NPN 的导通电压时，闩锁效应被触发：\n$$\n\\beta_{pnp}\\,I_{in}\\,R_{sub}=V_{on,npn}.\n$$\n因此，临界注入电流为\n$$\nI_{in,crit}=\\frac{V_{on,npn}}{\\beta_{pnp}\\,R_{sub}}.\n$$\n将此代入关联 $V_{S}$ 和 $I_{in}$ 的表达式中，得出闩锁效应发生前的最大安全源电压：\n$$\nV_{S,\\max}=V_{DD}+V_{D}+R_{s}\\,I_{in,crit}\n=V_{DD}+V_{D}+R_{s}\\,\\frac{V_{on,npn}}{\\beta_{pnp}\\,R_{sub}}.\n$$\n现在代入给定的数值：\n$$\nV_{S,\\max}=3.3+0.75+500\\cdot\\frac{0.70}{5.5\\cdot 200}\n=3.3+0.75+500\\cdot\\frac{0.70}{1100}\n=4.05+0.3181818\\ldots \\approx 4.37.\n$$\n四舍五入到三位有效数字，可以施加的而不触发闩锁效应的最大外部信号电压为 $4.37$。", "answer": "$$\\boxed{4.37}$$", "id": "1314400"}, {"introduction": "保护环是通过分流触发电流来防止闩锁效应的一种基本版图技术。本练习 [@problem_id:1314382] 要求你计算在两种常见的触发场景中，保护环所允许的最大电阻值。这个练习展示了如何将闩锁理论转化为稳健集成电路的实际设计规范。", "problem": "一种先进的互补金属氧化物半导体 (CMOS) 集成电路容易受到一种称为闩锁效应 (latch-up) 的破坏性现象的影响，该现象是由一个行为类似于可控硅整流器 (SCR) 的寄生四层 pnpn 结构的激活引起的。对该器件版图的分析揭示了寄生双极结型晶体管 (BJT) 和相关电阻的以下参数：\n\n- 寄生n阱电阻，$R_{well} = 2.50 \\text{ k}\\Omega$\n- 寄生p衬底电阻，$R_{sub} = 500~\\Omega$\n- 寄生垂直PNP BJT的电流增益，$\\beta_{pnp} = 1.20$\n- 寄生横向NPN BJT的电流增益，$\\beta_{npn} = 25.0$\n- 两个寄生BJT的基极-发射极开启电压，$V_{on} = 0.700 \\text{ V}$\n\n为确保可靠性，我们必须分析两种可能触发闩锁效应的不同且独立的场景，并确定相应的预防结构（称为保护环）的要求。\n\n**场景 A：输入过压触发**\n一个外部事件导致输入保护电路激活，将一个 $I_{trig,A} = 50.0 \\text{ mA}$ 的瞬态电流脉冲分流到n阱中。该电流存在使寄生PNP晶体管的发射极-基极结正向偏置的风险。一个连接到正电源电压的低电阻n+保护环被用来提供一个分流路径。这个保护环可以被建模为一个单一的分流电阻 $R_{shunt,A}$。为防止闩锁效应，n阱电阻上的电压降不得超过 $V_{on}$。\n\n**场景 B：动态衬底触发**\n一个大的、快速摆率的片上输出驱动器将一个 $I_{trig,B} = 150 \\text{ mA}$ 的瞬态电流脉冲注入p衬底。这种现象称为衬底反弹 (substrate bounce)，它在衬底中产生一个电压上升，有可能正向偏置寄生NPN晶体管的发射极-基极结。一个作为接地衬底接触的p+保护环，充当分流电阻 $R_{shunt,B}$ 来分流该电流。为防止闩锁效应，p衬底电阻上的电压降不得超过 $V_{on}$。\n\n计算每个保护环的最大允许电阻 $R_{shunt,A,max}$ 和 $R_{shunt,B,max}$，以保证电路在各自的场景中不会发生闩锁效应。\n\n按顺序以欧姆为单位给出 $R_{shunt,A,max}$ 和 $R_{shunt,B,max}$ 的最终答案。将您的数值答案四舍五入到三位有效数字。", "solution": "在每种场景下，可以通过确保注入的瞬态电流不会使相关的阱/衬底节点电压升高到足以正向偏置相应寄生 BJT 的基极-发射极结，来防止通过寄生 SCR 发生的闩锁效应。指定的预防标准是寄生电阻上的电压降不应超过基极-发射极开启电压 $V_{on}$。\n\n对于一个给定场景，注入电流 $I_{trig}$ 进入一个通过寄生电阻 $R_{par}$ 与保护环分流电阻 $R_{sh}$ 并联连接到电源的节点，其节点电压为\n$$\nV = I_{trig}\\,(R_{par} \\parallel R_{sh}) = I_{trig}\\,\\frac{R_{par}R_{sh}}{R_{par}+R_{sh}}.\n$$\n为避免正向偏置，要求\n$$\nI_{trig}\\,\\frac{R_{par}R_{sh}}{R_{par}+R_{sh}} \\leq V_{on}.\n$$\n定义最大允许等效电阻\n$$\nR_{eq,\\max} \\equiv \\frac{V_{on}}{I_{trig}}.\n$$\n那么不等式变为\n$$\n\\frac{R_{par}R_{sh}}{R_{par}+R_{sh}} \\leq R_{eq,\\max}.\n$$\n求解 $R_{sh}$ 可得\n$$\nR_{par}R_{sh} \\leq R_{eq,\\max}(R_{par}+R_{sh})\n\\;\\Rightarrow\\;\nR_{sh}(R_{par}-R_{eq,\\max}) \\leq R_{eq,\\max}R_{par}.\n$$\n假设 $R_{par} > R_{eq,\\max}$（在两种场景下都成立），两边同除以正因子 $(R_{par}-R_{eq,\\max})$ 即可得到最大允许分流电阻：\n$$\nR_{sh,\\max} = \\frac{R_{eq,\\max}R_{par}}{R_{par}-R_{eq,\\max}}.\n$$\n\n场景A（输入过压注入n阱）：此处 $R_{par} = R_{well}$ 且 $I_{trig} = I_{trig,A}$。计算\n$$\nR_{eq,\\max,A} = \\frac{V_{on}}{I_{trig,A}} = \\frac{0.700}{0.0500} = 14.0,\n$$\n$$\nR_{shunt,A,\\max} = \\frac{R_{eq,\\max,A}R_{well}}{R_{well}-R_{eq,\\max,A}}\n= \\frac{14.0 \\times 2500}{2500 - 14.0}\n= \\frac{35000}{2486} \\approx 14.1.\n$$\n\n场景B（衬底反弹注入p衬底）：此处 $R_{par} = R_{sub}$ 且 $I_{trig} = I_{trig,B}$。计算\n$$\nR_{eq,\\max,B} = \\frac{V_{on}}{I_{trig,B}} = \\frac{0.700}{0.150} = \\frac{14}{3} \\approx 4.666\\ldots,\n$$\n$$\nR_{shunt,B,\\max} = \\frac{R_{eq,\\max,B}R_{sub}}{R_{sub}-R_{eq,\\max,B}}\n= \\frac{\\left(\\frac{14}{3}\\right)\\times 500}{500 - \\frac{14}{3}}\n= \\frac{7000}{1486} = \\frac{3500}{743} \\approx 4.71.\n$$\n\n对于这个特定的预防标准，给定的晶体管电流增益是不需要的，因为问题通过限制节点电压上升来避免基极-发射极正向偏置，从而明确地约束了设计；因此，在每种场景下，只有电阻网络和 $V_{on}$ 决定了 $R_{sh,\\max}$。\n\n结果四舍五入到三位有效数字，并按要求的顺序 $(R_{shunt,A,\\max},\\,R_{shunt,B,\\max})$ 以欧姆为单位报告：", "answer": "$$\\boxed{\\begin{pmatrix} 14.1  4.71 \\end{pmatrix}}$$", "id": "1314382"}, {"introduction": "尽管有最佳的设计实践，静电放电等意外事件仍然可能触发闩锁效应。这个问题 [@problem_id:1314397] 呈现了一个设备已进入闩锁状态的真实场景。你的任务是确定恢复设备的唯一普遍有效的方法，从而加深对电源循环在处理此故障条件中的关键重要性的理解。", "problem": "一名工程专业的学生正在测试一个构建在印刷电路板（PCB）上的原型数据采集系统。该系统使用一个高精度的互补金属氧化物半导体（CMOS）模数转换器（ADC）来数字化传感器信号。实验室环境特别干燥，增加了产生静电的风险。在操作电路板时，该学生意外触摸了ADC芯片的一个模拟输入引脚，引发了一次静电放电（ESD）事件。\n\n此后，学生立即观察到ADC停止了与系统微控制器的通信。测量ADC从其5伏电源吸取的电流显示出一个异常高且稳定的值，为250毫安，远超其15毫安的典型工作电流。ADC芯片封装的表面触摸起来也明显变热。\n\n学生正确地怀疑ESD事件在ADC的CMOS结构内部触发了“闩锁效应”（latch-up）状态。闩锁效应是一种故障状态，其中在集成电路的电源轨（$V_{DD}$）和地轨（$V_{SS}$）之间形成了一个寄生的低阻抗通路。这个通路是由一个寄生的四层PNPN结构（等效于一个可控硅整流器，SCR）被触发而产生的，一旦被激活，只要电路通电，它就会形成一个自我维持的电流路径。\n\n鉴于这种情况，对于最终用户来说，以下哪项操作是从这种深度闩锁状态中恢复ADC的唯一普遍有效且安全的方法？\n\nA. 将接收到ESD脉冲的输入引脚短暂接触PCB上的一个接地点，以释放任何残留的静电。\n\nB. 通过微控制器的通信接口向ADC发送一个软件“硬复位”命令。\n\nC. 使用电路冷却喷雾剂对ADC芯片进行喷洒，以降低其温度并减小电流。\n\nD. 使用一根导线将ADC的电源引脚直接与其接地引脚短暂短路。\n\nE. 对ADC芯片执行一次电源循环，即将其专用电源关闭几秒钟，然后再重新打开。", "solution": "CMOS集成电路中的闩锁效应被建模为一个寄生的PNPN结构，等效于一个位于$V_{DD}$（阳极）和$V_{SS}$（阴极）之间的SCR。一旦被ESD等事件触发，当阳极到阴极的电流$I_{AK}$超过闩锁电流$I_{L}$时，SCR进入导通状态。导通后，只要$I_{AK} \\geq I_{H}$，SCR就保持导通，其中$I_{H}$是维持电流。恢复需要强制使$I_{AK} < I_{H}$。\n\n在一个有低阻抗电源和局部去耦电容的通电系统中，导通状态的SCR提供了一个低阻抗路径，维持了从$V_{DD}$到$V_{SS}$的大电流。观察到的症状（异常高且稳定的电源电流和芯片发热）与$I_{AK} \\gg I_{H}$的情况相符。对于最终用户而言，保证$I_{AK} < I_{H}$的唯一普遍有效且安全的方法是通过关闭电源来移除电流源，使$V_{DD} \\to 0$，并让旁路电容器中存储的电荷充分放电，从而迫使SCR的电流低于$I_{H}$并中止导通。在$V_{DD}$回到0之后，寄生结构复位到其关闭状态，当电源重新施加时，可以恢复正常操作。\n\n评估各个选项：\n\n- 选项A（将受影响的输入引脚接地）：SCR的导通路径是$V_{DD}$和$V_{SS}$之间的内部路径。一旦发生闩锁，将输入引脚强制接地并不能控制$I_{AK}$，因此不能保证$I_{AK} < I_{H}$。这种方法不是普遍有效的。\n\n- 选项B（软件硬复位）：闩锁效应是一个模拟的、寄生的导通路径，与数字状态无关。通过软件控制寄存器和接口不会影响$I_{AK}$，因此SCR会保持导通。这不能消除闩锁效应。\n\n- 选项C（冷却IC）：温度会影响诸如$I_{H}$和寄生晶体管增益等参数，但在电源仍然施加的情况下，$I_{AK}$通常仍高于$I_{H}$。不能依赖冷却来强制$I_{AK} < I_{H}$，并且这种方法不是普遍有效的；它还可能引入其他风险。\n\n- 选项D（用导线将$V_{DD}$与$V_{SS}$短路）：虽然这可能会使$V_{DD}$电压崩溃，但它有意地在电源两端造成硬短路，这可能导致仅受电源和寄生参数限制的过大峰值电流，有对IC、PCB走线、连接器和电源造成灾难性损坏的风险。这是不安全的，不推荐使用。\n\n- 选项E（电源循环：关闭，让其放电，然后打开）：切断电源会使$V_{DD}$电压崩溃并使去耦电容放电，从而使$I_{AK} \\to 0$，确保$I_{AK} < I_{H}$。这是制造商为最终用户推荐的标准、普遍有效且安全的恢复方法。\n\n因此，唯一普遍有效且安全的操作是进行电源循环，确保电源被完全切断足够长的时间，以便在重新施加电源之前所有存储的电荷都已消散。", "answer": "$$\\boxed{E}$$", "id": "1314397"}]}