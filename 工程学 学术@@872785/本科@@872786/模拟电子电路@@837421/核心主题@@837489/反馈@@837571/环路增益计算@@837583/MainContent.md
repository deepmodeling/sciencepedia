## 引言
在[模拟电路](@entry_id:274672)和更广泛的系统中，负反馈是一种无处不在的设计原则，用于稳定性能、抑制干扰和塑造[系统响应](@entry_id:264152)。然而，要精确量化反馈的效果并预测其对电路行为的深远影响，我们需要一个强大的分析工具。这个核心工具便是**[环路增益](@entry_id:268715) (Loop Gain)**。理解[环路增益](@entry_id:268715)不仅是掌握[反馈放大器](@entry_id:262853)设计的关键，也是评估系统稳定性的基石，解决了“反馈到底有多强”以及“系统是否会[振荡](@entry_id:267781)”等根本问题。

本文将通过三个章节，带领读者系统地掌握[环路增益](@entry_id:268715)。在“**原理与机制**”一章中，我们将深入探讨环路增益的定义、多种计算方法，并揭示其如何决定放大器的性能改善和稳定性边界。接着，在“**应用与跨学科联系**”一章，我们将把视野从核心电路拓扑扩展到[电力](@entry_id:262356)电子、控制系统乃至生物学等领域，展示环路增益作为一个普适概念的强大分析能力。最后，通过“**动手实践**”部分，您将有机会通过解决具体问题，将理论知识转化为实际的分析技能。让我们首先从环路增益的基本原理开始。

## 原理与机制

在上一章的介绍之后，我们现在深入探讨[负反馈放大器](@entry_id:273347)分析的核心——**[环路增益](@entry_id:268715) (loop gain)**。环路增益不仅是决定放大器[闭环性能](@entry_id:265001)（如增益稳定性和[非线性失真](@entry_id:260858)）的关键参数，也是评估其稳定性的基石。本章将系统地阐述[环路增益](@entry_id:268715)的定义、计算方法及其在电路性能和[稳定性分析](@entry_id:144077)中的核心作用。

### [环路增益](@entry_id:268715)的定义与计算方法

从概念上讲，环路增益是在一个闭合的[反馈环](@entry_id:273536)路中，信号绕行一周所经历的总增益。为了计算它，我们采用一种直观而强大的方法：**“断开环路”**。该方法包括以下步骤：

1.  将电路的所有外部独立输入源置零（例如，电压源短路，[电流源](@entry_id:275668)开路）。
2.  在环路中的任意一点“断开”信号通路。为了保持环路其余部分的直流[工作点](@entry_id:173374)和负载条件不变，断开点应当精心选择。通常，选择高阻抗点（如[运放](@entry_id:274011)的输入端）或低阻抗点（如运放的输出端）断开较为理想。
3.  在断开点的“输入”侧注入一个测试信号（电压 $V_t$ 或电流 $I_t$）。
4.  计算在断开点的“输出”侧得到的返回信号（$V_r$ 或 $I_r$）。
5.  [环路增益](@entry_id:268715) $T$ 定义为返回信号与测试信号之比，即 $T = V_r / V_t$ 或 $T = I_r / I_t$。

需要注意的是，在许多文献中，[环路增益](@entry_id:268715)的符号约定存在差异。在负反馈分析中，通常将环路增益定义为一个在工作频带内为正值的量。这通常意味着[环路增益](@entry_id:268715) $T$ 是[前向通路](@entry_id:275478)增益 $A$ 与[反馈系数](@entry_id:275731) $\beta$ 的乘积，即 $T = A\beta$。这种定义方式下，[闭环增益](@entry_id:275610)的著名公式为 $A_f = \frac{A}{1+A\beta} = \frac{A}{1+T}$。我们将遵循这一约定。

#### 理想化放大器中的环路增益

让我们从一个标准的反相运算放大器配置开始，以具体说明[环路增益](@entry_id:268715)的计算。假设[运放](@entry_id:274011)具有一个有限的、与频率无关的开环电压增益 $A$，但其[输入阻抗](@entry_id:271561)无限大，[输出阻抗](@entry_id:265563)为零。电路包含一个[输入电阻](@entry_id:178645) $R_1$ 和一个反馈电阻 $R_f$。

为了计算[环路增益](@entry_id:268715)，我们首先将输入信号源置零（接地）。然后，我们在[运放](@entry_id:274011)的输入端断开环路。一个等效的方法是计算从[运放](@entry_id:274011)输出端反馈到其反相输入端的电压部分。运放的输出电压为 $V_{out} = -A V_{-}$，其中 $V_{-}$ 是反相输入端的电压。

由于输入信号源接地，反馈网络（$R_f$ 和 $R_1$）形成了一个从 $V_{out}$ 到 $V_{-}$ 的[分压器](@entry_id:275531)。因为[运放](@entry_id:274011)的[输入阻抗](@entry_id:271561)是无限的，没有电流流入反相输入端。因此，我们可以写出：
$$ V_{-} = V_{out} \frac{R_1}{R_1 + R_f} $$

这里的比率 $\beta = \frac{R_1}{R_1 + R_f}$ 被称为**[反馈系数](@entry_id:275731) (feedback factor)**。它代表了输出信号被反馈回输入端的比例。[环路增益](@entry_id:268715) $T$ 是开环增益 $A$ 和[反馈系数](@entry_id:275731) $\beta$ 的乘积 [@problem_id:1315684]。

$$ T = A \cdot \beta = A \frac{R_1}{R_1 + R_f} $$

这个表达式揭示了环路增益由放大器自身的增益和外部反馈网络的特性共同决定。

#### 考虑非理想效应：负载的影响

实际的放大器并非理想。一个重要的非理想特性是其非零的**输出电阻 (output resistance)** $R_{out}$。当考虑 $R_{out}$ 时，反馈网络会对放大器的输出产生**[负载效应](@entry_id:262341) (loading effect)**，从而改变[环路增益](@entry_id:268715)。

让我们重新分析上述的[反相放大器](@entry_id:275864)，但这次假设[运放](@entry_id:274011)具有[输出电阻](@entry_id:276800) $R_{out}$ [@problem_id:1315713]。为了计算环路增益，我们可以在[运放](@entry_id:274011)的输出端断开环路。我们将一个测试电压 $V_t$ 注入到反馈网络（即 $R_f$ 的一端），并计算在运放的实际输出端（$R_{out}$ 之后）产生的返回电压 $V_r$。根据定义，$T = -V_r/V_t$（这里的负号是由于在输出端断开环路并定义返回信号方向的惯例，最终结果与 $A\beta$ 定义一致）。

1.  测试电压 $V_t$ 通过反馈网络 $R_f$ 和 $R_1$ 产生一个反馈电压 $V_f$ 在[运放](@entry_id:274011)的反相输入端。由于输入端接地，这是一个简单的分压：$V_f = V_t \frac{R_1}{R_1 + R_f}$。
2.  [运放](@entry_id:274011)的差分输入电压为 $V_{id} = 0 - V_f = -V_f$。因此，[运放](@entry_id:274011)内部的受控电压源产生的电压为 $V_{out,ul} = A \cdot V_{id} = -A V_f$。
3.  这个内部电压源的电压会经过由 $R_{out}$ 和反馈网络负载阻抗 $Z_L$ 组成的[分压器](@entry_id:275531)。从[运放](@entry_id:274011)输出端看进去，负载阻抗是 $Z_L = R_1 + R_f$。因此，返回电压 $V_r$ 是：
    $$ V_r = V_{out,ul} \frac{Z_L}{R_{out} + Z_L} = (-A V_f) \frac{R_1 + R_f}{R_{out} + R_1 + R_f} $$
4.  将 $V_f$ 的表达式代入，我们得到：
    $$ V_r = -A \left( V_t \frac{R_1}{R_1 + R_f} \right) \frac{R_1 + R_f}{R_{out} + R_1 + R_f} = -A V_t \frac{R_1}{R_{out} + R_1 + R_f} $$
5.  环路增益 $T = -V_r / V_t$ 就是：
    $$ T = A \frac{R_1}{R_{out} + R_1 + R_f} $$

与理想情况相比，分母中增加了 $R_{out}$ 项。这表明，[运放](@entry_id:274011)的[输出电阻](@entry_id:276800)与反馈网络共同分担了输出信号，导致有效的[环路增益](@entry_id:268715)降低。例如，对于一个开环增益 $A_v = 1.2 \times 10^5$、输出电阻 $R_{out} = 80.0 \, \Omega$、[输入电阻](@entry_id:178645) $R_1 = 2.0 \, \text{k}\Omega$ 和反馈电阻 $R_f = 48.0 \, \text{k}\Omega$ 的放大器，其直流[环路增益](@entry_id:268715)为 [@problem_id:1315706]：
$$ T = (1.2 \times 10^5) \frac{2.0 \times 10^3}{80.0 + 2.0 \times 10^3 + 48.0 \times 10^3} = \frac{2.4 \times 10^8}{50080} \approx 4.792 \times 10^3 $$

#### 频率相关的环路增益

在更现实的模型中，放大器的开环增益 $A$ 是频率的函数，通常表示为 $A(s)$，其中 $s = j\omega$ 是复频率。一个常见的简化模型是**单极点模型 (single-pole model)**，它能很好地描述许多[运放](@entry_id:274011)的主要频率特性 [@problem_id:1315685]。
$$ A(s) = \frac{A_0}{1 + s/\omega_p} $$
其中 $A_0$ 是直流开环增益，$\omega_p$ 是开环增益的[极点频率](@entry_id:262343)。在这种情况下，环路增益也成为频率的函数 $T(s)$：
$$ T(s) = A(s)\beta = \left( \frac{A_0}{1 + s/\omega_p} \right) \left( \frac{R_1}{R_1 + R_f} \right) = \frac{A_0 R_1}{(R_1 + R_f)(1 + s/\omega_p)} $$
$T(s)$ 是一个复数量，具有随频率变化的幅度和相位。这一频率特性是分析[放大器稳定性](@entry_id:272554)的关键，我们将在后续章节中详细讨论。

### [环路增益](@entry_id:268715)的普适性质

尽管我们使用[电压放大器](@entry_id:261375)作为例子，但环路增益的概念是普适的，适用于所有类型的[反馈系统](@entry_id:268816)，包括[电流放大器](@entry_id:274238)、[跨导放大器](@entry_id:266314)和[跨阻放大器](@entry_id:275441)。

#### 环路增益的无量纲性

一个基本但至关重要的问题是：[环路增益](@entry_id:268715)的物理单位是什么？答案是，**环路增益始终是一个无量纲的纯数量**。我们可以通过[量纲分析](@entry_id:140259)来证明这一点 [@problem_id:1306821]。

考虑一个**[跨阻放大器](@entry_id:275441) (transresistance amplifier)**（并联-并联反馈），其开环增益 $A_{rm} = v_o / i_i$ 的单位是欧姆 ($\Omega$)。其反馈网络对输出电压 $v_o$ 进行采样，并返回一个反馈电流 $i_f$。因此，[反馈系数](@entry_id:275731) $H = i_f / v_o$ 的单位是西门子 ($\text{S}$)，即 $\Omega^{-1}$。环路增益 $T = A_{rm} H$ 的单位是 $\Omega \cdot \text{S} = 1$，即无量纲。

再考虑一个**[跨导放大器](@entry_id:266314) (transconductance amplifier)**（[串联-串联反馈](@entry_id:269592)），其开环增益 $A_{gm} = i_o / v_i$ 的单位是西门子 ($\text{S}$)。其反馈网络对输出电流 $i_o$ 进行采样，并返回一个反馈电压 $v_f$。因此，[反馈系数](@entry_id:275731) $H = v_f / i_o$ 的单位是欧姆 ($\Omega$)。环路增益 $T = A_{gm} H$ 的单位同样是 $\text{S} \cdot \Omega = 1$，无量纲。

这个结论适用于所有四种基本的[反馈拓扑](@entry_id:271848)。[环路增益](@entry_id:268715)本质上是一个比例，描述了信号在环路中传播一周后自身被放大的倍数，因此它不携带物理单位。

#### 复杂系统中的[环路增益](@entry_id:268715)

“断开环路”的方法同样适用于具有多个反馈路径的复杂系统。在这种情况下，总[环路增益](@entry_id:268715)是在断开点测得的所有[反馈环](@entry_id:273536)路贡献的总和。

考虑一个由[传递函数](@entry_id:273897)模块描述的控制系统 [@problem_id:1560466]。假设一个前向路径由 $G_1(s)$ 和 $G_2(s)$ [串联](@entry_id:141009)组成，同时存在两个并行的[负反馈](@entry_id:138619)环路：一个通过 $H_1(s)$ 从 $G_1(s)$ 的[输出反馈](@entry_id:271838)，另一个通过 $H_2(s)$ 从 $G_2(s)$ 的[输出反馈](@entry_id:271838)。

为了计算总环路增益 $L(s)$，我们在主求和点之后、$G_1(s)$ 的输入端断开环路。我们将外部输入置零，并在此处注入一个测试信号 $V_{in}(s)$。返回到求和点的总信号 $V_{ret}(s)$ 是两个反馈路径信号之和。
- 路径1的返回信号：$V_{ret1}(s) = V_{in}(s) G_1(s) H_1(s)$
- 路径2的返回信号：$V_{ret2}(s) = V_{in}(s) G_1(s) G_2(s) H_2(s)$

总返回信号为 $V_{ret}(s) = V_{ret1}(s) + V_{ret2}(s)$。因此，总环路增益为：
$$ L(s) = \frac{V_{ret}(s)}{V_{in}(s)} = G_1(s) H_1(s) + G_1(s) G_2(s) H_2(s) = G_1(s) (H_1(s) + G_2(s) H_2(s)) $$
这表明，对于在单一断点处断开的所有环路，总环路增益是各单个[环路增益](@entry_id:268715)的代数和。

### 环路增益的重要性：性能改善与稳定性

[环路增益](@entry_id:268715)的大小直接关系到[负反馈](@entry_id:138619)所带来的所有益处，以及潜在的稳定性问题。一个核心概念是**去敏感因子 (desensitivity factor)**，定义为 $1+T$。

#### 性能改善

[负反馈](@entry_id:138619)通过因子 $1+T$ 来改善放大器的多项性能指标。

-   **[增益去敏感化](@entry_id:272462) (Gain Desensitization)**：[闭环增益](@entry_id:275610) $A_f = A / (1+T)$。如果环路增益 $T \gg 1$，则 $A_f \approx A/T = A/(A\beta) = 1/\beta$。这意味着[闭环增益](@entry_id:275610)几乎完全由外部反馈网络（决定 $\beta$）确定，而对开环增益 $A$ 的变化（例如由温度或器件差异引起）不敏感。

-   **[非线性失真](@entry_id:260858)减小 (Distortion Reduction)**：放大器内部产生的[非线性失真](@entry_id:260858)或噪声信号，在输出端会被[反馈环](@entry_id:273536)路抑制。可以证明，[闭环系统](@entry_id:270770)中的[谐波失真](@entry_id:264840)分量 $D_{fb}$ 与开环系统中的失真分量 $D_{ol}$ 之间的关系为 $D_{fb} = D_{ol} / (1+T)$ [@problem_id:1332118]。例如，如果一个音频前置放大器的设计目标是将二次[谐波失真](@entry_id:264840)降低为原来的 $1/50$，那么就必须设计一个大小为 $T=49$ 的环路增益，因为 $1+T=50$。

-   **端点阻抗的改变 (Modification of Terminal Impedances)**：[负反馈](@entry_id:138619)可以显著改变放大器的输入和[输出阻抗](@entry_id:265563)。具体效果取决于反馈的拓扑结构。例如，在**[串联-串联反馈](@entry_id:269592) (series-series feedback)** 配置中（通常用于[跨导放大器](@entry_id:266314)），[输出电阻](@entry_id:276800)会被提高。闭环输出电阻 $R_{of}$ 与开环输出电阻 $R_o$ 的关系是 $R_{of} = R_o (1+T)$ [@problem_id:1331879]。如果一个开环[输出电阻](@entry_id:276800)为 $10 \, \text{k}\Omega$ 的放大器需要被改造为一个具有 $200 \, \text{k}\Omega$ [输出电阻](@entry_id:276800)的高阻抗电流源，那么所需的环路增益为 $T = (R_{of}/R_o) - 1 = (200/10) - 1 = 19$。相反，并联采样反馈（如**[串联](@entry_id:141009)-并联反馈 (series-shunt feedback)**）会降低输出电阻。

#### [环路增益](@entry_id:268715)与稳定性

尽管[负反馈](@entry_id:138619)有诸多益处，但它也带来了潜在的**不稳定性 (instability)**。由于放大器和反馈网络中存在的延时和相移，在某些高频下，负反馈可能转变为[正反馈](@entry_id:173061)，导致系统[振荡](@entry_id:267781)。

[环路增益](@entry_id:268715) $T(j\omega)$ 的频率特性是判断稳定性的关键。当[环路增益](@entry_id:268715)的相位达到 $-180^\circ$ 时，[负反馈信号](@entry_id:268437)与输入信号同相。如果此时环路增益的幅度 $|T(j\omega)| \ge 1$，那么信号每循环一周都会被放大，导致[振荡](@entry_id:267781)。这便是**巴克豪森[振荡](@entry_id:267781)准则 (Barkhausen criterion)**。

为了量化系统离[不稳定状态](@entry_id:197287)有多远，我们引入了**[增益裕度](@entry_id:275048) (Gain Margin, GM)** 和**[相位裕度](@entry_id:264609) (Phase Margin, PM)**。

-   **[增益裕度](@entry_id:275048)** 是在[环路增益](@entry_id:268715)相位达到 $-180^\circ$ 的频率（称为[相位交越频率](@entry_id:264097) $\omega_{180}$）上，其幅度距离 1 (或 0 dB) 的大小。具体来说，$\text{GM} = 1 / |T(j\omega_{180})|$。如果在一个测试中，测得在 $\omega_{180}$ 处的[环路增益](@entry_id:268715)为 $T(j\omega_{180}) = -0.40$，这意味着其幅度为 $|T(j\omega_{180})| = 0.40$。由于幅度小于1，系统是稳定的。其[增益裕度](@entry_id:275048)为 $1/0.40 = 2.5$，换算成对数单位为 $20\log_{10}(2.5) \approx 7.96 \, \text{dB}$ [@problem_id:1334331]。正的[增益裕度](@entry_id:275048)（以dB为单位）表示系统稳定。

-   **[奈奎斯特稳定性判据](@entry_id:273425) (Nyquist Stability Criterion)** 提供了更通用的稳定性分析框架。它通过考察环路增益 $T(s)$ 在复平面上的**奈奎斯特图 (Nyquist plot)** 与**[临界点](@entry_id:144653)** $-1+j0$ 的关系来判断闭环系统的稳定性。对于一个开环稳定的系统（即 $T(s)$ 的所有极点都在左半平面），闭环系统稳定的充要条件是 $T(s)$ 的奈奎斯特图不包围 $-1+j0$ 点。

考虑一个开环稳定的放大器，其初始[环路增益](@entry_id:268715) $T_0(s)$ 的[奈奎斯特图](@entry_id:264096)在负[实轴](@entry_id:148276)上的交点为 $-1.25+j0$ [@problem_id:1334344]。由于该点在 $-1$ 点的左侧，[奈奎斯特图](@entry_id:264096)包围了[临界点](@entry_id:144653)，因此系统不稳定。如果我们通过改变[反馈系数](@entry_id:275731) $\beta$ 来调整环路增益，新的[环路增益](@entry_id:268715) $T(s)$ 是对原图 $T_0(s)$ 的一个比例缩放：$T(s) = (\beta/\beta_0) T_0(s)$。为了使系统稳定，我们必须缩放该图，使其与负[实轴](@entry_id:148276)的交点移动到 $-1$ 点的右侧。即：
$$ \left| \frac{\beta}{\beta_0} (-1.25) \right| \lt 1 $$
这导致 $\frac{\beta}{\beta_0} \lt \frac{1}{1.25} = 0.80$，即 $\beta \lt 0.80 \beta_0$。这个例子生动地说明了[环路增益](@entry_id:268715)的幅度如何直接决定了系统的稳定性边界。

综上所述，环路增益是连接开环特性与[闭环性能](@entry_id:265001)的桥梁。深刻理解其定义、计算方法以及对放大器性能和稳定性的影响，是进行任何高级[模拟电路设计](@entry_id:270580)与分析的先决条件。