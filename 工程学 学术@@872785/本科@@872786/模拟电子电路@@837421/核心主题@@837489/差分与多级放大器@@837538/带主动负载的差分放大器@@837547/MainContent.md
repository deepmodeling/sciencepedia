## 引言
[有源负载](@entry_id:262691)[差分放大器](@entry_id:272747)是现代[模拟集成电路设计](@entry_id:277019)的核心构建模块，是构建高性能运算放大器、比较器和[数据转换](@entry_id:170268)器的基石。在追求高增益和高集成度的单片电路中，传统的电阻负载因占用巨大芯片面积而变得不切实际。本文旨在解决这一关键问题，深入探讨了采用[电流镜](@entry_id:264819)作为[有源负载](@entry_id:262691)的创新设计，它不仅实现了卓越的电压增益，还为差分到单端的信号转换提供了优雅的解决方案。

在接下来的内容中，读者将系统地学习这一重要电路。**原理与机制**章节将剖析其基本工作原理，包括[直流偏置](@entry_id:271748)分析、小信号增益推导，以及[输入共模范围](@entry_id:273151)和[输出摆幅](@entry_id:260991)等性能边界。随后的**应用与跨学科联系**章节将探讨其在[系统设计](@entry_id:755777)中的角色，分析压摆率、频率响应、噪声和失真等实际性能指标，并揭示其与通信、传感等领域的联系。最后，通过一系列**动手实践**练习，您将有机会巩固所学知识，将理论应用于具体计算中。现在，让我们从理解[有源负载](@entry_id:262691)的基本原理开始。

## 原理与机制

继前一章介绍了[差分放大器](@entry_id:272747)的基本概念之后，本章将深入探讨采用[有源负载](@entry_id:262691)的[差分放大器](@entry_id:272747)的核心工作原理与关键机制。[有源负载](@entry_id:262691)，特别是[电流镜](@entry_id:264819)负载，是现代[模拟集成电路设计](@entry_id:277019)的基石。理解其行为对于掌握高性能放大器的设计至关重要。我们将系统地分析其[直流偏置](@entry_id:271748)、小信号增益，并探讨其实际性能限制和设计中的关键权衡。

### [有源负载](@entry_id:262691)的角色：从电阻到[电流镜](@entry_id:264819)

在单片集成电路（IC）中设计放大器时，一个核心目标是在尽可能小的芯片面积内实现尽可能高的[电压增益](@entry_id:266814)。传统的[差分放大器](@entry_id:272747)使用两个匹配的电阻作为负载。在这种配置下，单端输出的差分[电压增益](@entry_id:266814)近似为 $A_v \approx \frac{g_m}{2} R_L$，其中 $g_m$ 是输入晶体管的[跨导](@entry_id:274251)，$R_L$ 是负载电阻。显然，要获得高增益，就需要一个非常大的 $R_L$。然而，在标准的IC工艺中，制造大阻值的电阻会占用极其宝贵的硅片面积，这在经济上和物理上都是不切实际的。

为了克服这一挑战，设计师们转向了一种更为巧妙的解决方案：**[有源负载](@entry_id:262691)**。具体而言，就是使用一个**[电流镜](@entry_id:264819)**电路来替代无源的[负载电阻](@entry_id:267991)。这种设计选择的首要和根本原因在于，[有源负载](@entry_id:262691)能够为放大晶体管提供一个极高的有效输出电阻，从而极大地提升差分[电压增益](@entry_id:266814)，同时其占用的芯片面积远小于实现同等阻值所需的大面积电阻 [@problem_id:1297209]。

让我们更具体地比较这两种负载。一个由晶体管构成的[电流镜](@entry_id:264819)，其输出端口的[小信号电阻](@entry_id:267564)是晶体管自身的[输出电阻](@entry_id:276800) $r_o$。由于**[沟道长度调制](@entry_id:264103)效应**（channel-length modulation），这个电阻 $r_o$ 可以达到数十千欧到数兆欧的量级，而其占用的物理尺寸却非常小。相比之下，一个几十千欧的片上电阻可能需要比晶体管大几个[数量级](@entry_id:264888)的面积。

此外，[有源负载](@entry_id:262691)通过一种精巧的电流“窃取”与“注入”机制，将[差分对](@entry_id:266000)两侧的信号电流有效地结合起来，从而将放大器的有效跨导加倍，进一步提升了增益。我们将在后续的[小信号分析](@entry_id:263462)中详细阐述这一机制。因此，采用[电流镜](@entry_id:264819)作为[有源负载](@entry_id:262691)，是实现高增益、高集成度现代模拟电路的关键一步。

### 直流分析与[静态工作点](@entry_id:264648)

在分析放大器的交流小信号特性之前，必须首先确立其在无信号输入时的**[静态工作点](@entry_id:264648) (Quiescent Operating Point)**。这决定了所有晶体管的偏置条件，确保它们工作在预期的饱和区。

考虑一个典型的[CMOS](@entry_id:178661)[差分放大器](@entry_id:272747)，它由一对NMOS输入晶体管（$M_1$, $M_2$）和一个P[MOS电流镜](@entry_id:273667)[有源负载](@entry_id:262691)（$M_3$, $M_4$）构成。输入对的源极共同连接到一个理想的恒流源，该[电流源](@entry_id:275668)从节点“拉出”一个总的**尾电流** $I_{SS}$。

当差分输入电压为零时 ($v_{id} = 0$)，即 $M_1$ 和 $M_2$ 的栅极电压相等，整个电路呈现完美的对称性。由于输入晶体管 $M_1$ 和 $M_2$ 是完全匹配的，且它们的栅源电压 $V_{GS}$ 相等，尾电流 $I_{SS}$ 将会平均分配到两个支路中。因此，流过每个输入晶体管的漏极电流为：
$$
I_{D1} = I_{D2} = \frac{I_{SS}}{2}
$$

这个结论是分析所有[对称差](@entry_id:156264)分电路的出发点。例如，如果一个放大器的尾电流 $I_{SS} = 250 \ \mu\text{A}$，那么在静态条件下，流经 $M_1$ 和 $M_2$ 的电流均为 $125 \ \mu\text{A}$ [@problem_id:1297262]。

现在我们来看[有源负载](@entry_id:262691)。负载由P[MOS晶体管](@entry_id:273779) $M_3$ 和 $M_4$ 构成的[电流镜](@entry_id:264819)组成。$M_3$ 通常被配置为**[二极管](@entry_id:160339)连接**形式（其栅极与漏极相连），作为[电流镜](@entry_id:264819)的输入端或参考端。它的漏极连接到 $M_1$ 的漏极，因此流经 $M_3$ 的电流完全由 $M_1$ 的漏极电流决定：
$$
I_{D3} = I_{D1} = \frac{I_{SS}}{2}
$$

$M_4$ 作为[电流镜](@entry_id:264819)的输出端，其栅极与 $M_3$ 的栅极相连，源极也与 $M_3$ 的源极相连（通常接到电源 $V_{DD}$）。由于 $M_3$ 和 $M_4$ 也是匹配的，它们具有相同的栅源电压 $V_{SG}$，因此 $M_4$ 的漏极电流将精确地“镜像”$M_3$ 的电流：
$$
I_{D4} = I_{D3} = \frac{I_{SS}}{2}
$$

综上所述，在一个理想对称的、采用[有源负载](@entry_id:262691)的[差分放大器](@entry_id:272747)中，当没有[差分信号](@entry_id:260727)输入时，所有四个核心晶体管（$M_1, M_2, M_3, M_4$）都流过大小为 $I_{SS}/2$ 的静态[偏置电流](@entry_id:260952) [@problem_id:1297262]。

确定了电流，我们还可以计算电路中的关键节点电压。例如，P[MOS电流镜](@entry_id:273667)的公共栅极电压是一个重要的直流参数。这个电压由二极管连接的 $M_3$ 自动建立，其大小恰好能使其自身通过 $I_{D3} = I_{SS}/2$ 的电流。对于工作在[饱和区](@entry_id:262273)的P[MOS晶体管](@entry_id:273779)，其电流由下式决定（忽略[沟道长度调制](@entry_id:264103)）：
$$
I_{D} = \frac{1}{2}\mu_p C_{ox}\left(\frac{W}{L}\right)(V_{SG} - |V_{tp}|)^2
$$
其中 $\mu_p C_{ox}$ 是工艺相关的参数，$W/L$ 是晶体管的宽长比，$V_{tp}$ 是阈值电压。我们可以从中反解出 $V_{SG}$：
$$
V_{SG} = |V_{tp}| + \sqrt{\frac{2I_D}{\mu_p C_{ox}(W/L)}}
$$
假设电源电压为 $V_{DD}$，PMOS的源极接 $V_{DD}$，则公共栅极电压 $V_G$ 为 $V_G = V_{DD} - V_{SG}$。例如，对于一个尾电流 $I_{SS} = 200 \ \mu\text{A}$ 的放大器，每个支路电流为 $100 \ \mu\text{A}$。若PMO[S参数](@entry_id:754557)为 $V_{DD} = 1.8 \ \text{V}$, $V_{tp} = -0.5 \ \text{V}$, $\mu_p C_{ox} = 50 \ \mu\text{A/V}^2$ 且 $(W/L)=40$，我们可以计算出 $V_{SG} \approx 0.816 \ \text{V}$，从而得到公共栅极电压 $V_G \approx 1.8 - 0.816 = 0.984 \ \text{V}$ [@problem_id:1297202]。这个电压不仅是 $M_3$ 的栅压，也是 $M_4$ 的栅压，从而设定了整个[有源负载](@entry_id:262691)的工作状态。

### [小信号分析](@entry_id:263462)：[电压增益](@entry_id:266814)

[差分放大器](@entry_id:272747)的核心功能是放大差分输入信号。其性能由小信号[电压增益](@entry_id:266814) $A_v = v_{out} / v_{id}$ 来衡量。我们可以通过一个两步法来推导增益：首先计算放大器的**整体[跨导](@entry_id:274251)** $G_m$，然后计算其**[输出电阻](@entry_id:276800)** $R_{out}$。电压增益就是这两者的乘积。

#### 整体跨导 $G_m$

整体[跨导](@entry_id:274251) $G_m$ 定义为在输出端短路到地的情况下，输出电流 $i_{out,sc}$ 与差分输入电压 $v_{id}$ 之比，即 $G_m = i_{out,sc} / v_{id}$。让我们来推导这个值。

施加一个小的差分输入电压 $v_{id}$，我们可以设定 $v_{in1} = v_{id}/2$ 和 $v_{in2} = -v_{id}/2$（假设 $v_{in1}$ 连接到 $M_1$ 栅极，$v_{in2}$ 连接到 $M_2$ 栅极）。由于理想[尾电流源](@entry_id:262705)的存在，[差分对](@entry_id:266000)的公共源极点在交流意义上是“[虚地](@entry_id:269132)”，其电压保持不变。因此，$M_1$ 和 $M_2$ 的栅源电压变化分别为 $v_{gs1} = v_{id}/2$ 和 $v_{gs2} = -v_{id}/2$。

这导致 $M_1$ 和 $M_2$ 的漏极电流产生变化：
- $i_{d1} = g_{mn} v_{gs1} = g_{mn} (v_{id}/2)$
- $i_{d2} = g_{mn} v_{gs2} = -g_{mn} (v_{id}/2)$

其中 $g_{mn}$ 是输入N[MOS晶体管](@entry_id:273779)的[跨导](@entry_id:274251)。

现在看[有源负载](@entry_id:262691)的行为。电流 $i_{d1}$ 流入[二极管](@entry_id:160339)连接的P[MOS晶体管](@entry_id:273779) $M_3$。这个变化的电流被P[MOS电流镜](@entry_id:273667)（$M_3, M_4$）镜像。因此，$M_4$ 将会“源出”一个与 $i_{d1}$ 大小相等、方向相反的电流变化量（从PMOS角度看电流方向）。也就是说，从 $M_4$ 的漏极流入输出节点的电流为 $i_{d4} = i_{d1} = g_{mn} (v_{id}/2)$。

输出节点（$M_2$ 和 $M_4$ 的漏极连接处）的总短路电流 $i_{out,sc}$ 是流入该节点的电流之和。它等于从 $M_4$ 流入的电流减去被 $M_2$ “吸走”的电流：
$$
i_{out,sc} = i_{d4} - i_{d2} = \left( g_{mn} \frac{v_{id}}{2} \right) - \left( -g_{mn} \frac{v_{id}}{2} \right) = g_{mn} v_{id}
$$
这个结果非常简洁和深刻。它表明，[有源负载](@entry_id:262691)巧妙地将[差分对](@entry_id:266000)两侧的信号电流在输出端同相叠加，使得放大器的整体跨导等于输入晶体管的[跨导](@entry_id:274251) [@problem_id:1297244]。
$$
G_m = \frac{i_{out,sc}}{v_{id}} = g_{mn}
$$

#### 输出电阻 $R_{out}$

输出电阻 $R_{out}$ 是从输出节点向电路看进去的[等效电阻](@entry_id:264704)（同时将所有独立信号源置零）。在我们的例子中，输出节点是 $M_2$ 和 $M_4$ 的漏极。
- 向下看入 $M_2$ 的漏极，看到的电阻是其自身的[输出电阻](@entry_id:276800) $r_{o,n}$。
- 向上看入 $M_4$ 的漏极，看到的电阻是其自身的输出电阻 $r_{o,p}$。

因此，总的[输出电阻](@entry_id:276800)是这两个电阻的并联组合：
$$
R_{out} = r_{o,n} \parallel r_{o,p} = \frac{r_{o,n} r_{o,p}}{r_{o,n} + r_{o,p}}
$$
这里的 $r_{o,n}$ 和 $r_{o,p}$ 是由[沟道长度调制](@entry_id:264103)效应引起的有限输出电阻，它们的值通常很大，这正是我们期望的。

#### 增益综合

现在，我们可以将整体[跨导](@entry_id:274251)和输出电阻结合起来，得到最终的[电压增益](@entry_id:266814)。单端输出电压 $v_{out}$ 等于输出电流乘以输出电阻。需要注意的是符号的定义。根据输出电流和电压的参考方向，增益表达式可能为正或为负。

通常，我们将输出电压定义为 $v_{out}$，流入负载的电流为正。那么 $v_{out} = i_{out} \times R_{out}$。而我们之[前推](@entry_id:158718)导的 $i_{out,sc} = G_m v_{id}$ 是从节点流出的电流，所以 $i_{out} = -i_{out,sc} = -G_m v_{id}$。因此，电压增益为：
$$
A_v = \frac{v_{out}}{v_{id}} = -G_m R_{out}
$$
代入我们之前得到的结果：
$$
A_v = -g_{mn} (r_{o,n} \parallel r_{o,p}) = -g_{mn} \frac{r_{o,n} r_{o,p}}{r_{o,n} + r_{o,p}}
$$
这个公式是带[有源负载](@entry_id:262691)的[差分放大器](@entry_id:272747)的核心结果 [@problem_id:1297207]。它表明，通过使用[有源负载](@entry_id:262691)，我们获得的增益大小为 $g_{mn} (r_{o,n} \parallel r_{o,p})$。因为 $r_o$ 值很大，所以这个增益远高于使用中等大小电阻负载时能获得的增益。

值得注意的是，增益的符号取决于输入信号如何连接。如果我们将非反相输入（$v_{in,+}$）连接到 $M_2$ 的栅极，反相输入（$v_{in,-}$）连接到 $M_1$ 的栅极，那么差分输入 $v_{id} = v_{in,+} - v_{in,-}$ 产生的输出就是负增益，如上式所示。如果反过来连接，则会得到正增益 [@problem_id:1297235]。

### 性能限制与设计权衡

理论上，[有源负载](@entry_id:262691)[差分放大器](@entry_id:272747)可以提供非常高的增益。然而，在实际应用中，其性能受到一系列因素的限制，主要包括[输入共模范围](@entry_id:273151)和[输出电压摆幅](@entry_id:263071)。这些限制与电路的直流偏置和晶体管的饱和条件密切相关。

#### [输入共模范围](@entry_id:273151) (ICMR)

**[输入共模范围](@entry_id:273151) (Input Common-Mode Range, ICMR)** 是指在保持所有晶体管正常工作（即在[饱和区](@entry_id:262273)）的前提下，两个输入端可以共同变化的电压范围。这个范围由一个下限 $V_{ICM,min}$ 和一个上限 $V_{ICM,max}$ 界定。

**最小输入[共模电压](@entry_id:267734) $V_{ICM,min}$** 通常由两个条件决定：
1. [尾电流源](@entry_id:262705)必须保持在饱和区工作。一个实际的电流源需要一个最小的[电压降](@entry_id:267492) $V_{CS,min}$ 来维持其恒流特性。
2. 输入晶体管（例如NMOS对）必须能够导通并传导 $I_{SS}/2$ 的电流，这要求其栅源电压 $V_{GS}$ 必须大于[阈值电压](@entry_id:273725) $V_{tn}$。

综合这两个条件，对于一个由NMOS管实现的[尾电流源](@entry_id:262705)，[差分对](@entry_id:266000)的公共源极电压 $V_S$ 必须满足 $V_S \ge V_{SS} + V_{CS,min}$（其中 $V_{SS}$ 是负电源轨）。同时，输入[共模电压](@entry_id:267734) $V_{ICM}$ 必须足以建立所需的 $V_{GS}$，即 $V_{ICM} = V_S + V_{GS}$。因此，最小输入[共模电压](@entry_id:267734)为：
$$
V_{ICM,min} = V_{S,min} + V_{GS} = (V_{SS} + V_{CS,min}) + (V_{tn} + V_{ov})
$$
其中 $V_{ov} = V_{GS} - V_{tn}$ 是输入晶体管的**[过驱动电压](@entry_id:272139)**，它由[偏置电流](@entry_id:260952) $I_{SS}/2$ 决定。例如，对于一个尾电流为 $225 \ \mu\text{A}$、由需要 $0.35 \ \text{V}$ [电压降](@entry_id:267492)的电流源偏置的N[MOS差分对](@entry_id:272034)，若 $V_{SS}=-2.5 \ \text{V}$，$V_{tn}=0.5 \ \text{V}$，计算可得其[过驱动电压](@entry_id:272139) $V_{ov} \approx 0.212 \ \text{V}$，最终得到 $V_{ICM,min} \approx -1.44 \ \text{V}$ [@problem_id:1297263]。

**最大输入[共模电压](@entry_id:267734) $V_{ICM,max}$** 则由另一组饱和条件限制。对于NMOS输入对，当 $V_{ICM}$ 升高时，公共源极电压 $V_S$ 也随之升高。为了使输入晶体管 $M_1, M_2$ 保持在饱和区，它们的漏源电压 $V_{DS}$ 必须始终大于其[过驱动电压](@entry_id:272139) $V_{ov}$。其漏极电压 $V_D$ 由PMOS[有源负载](@entry_id:262691)的[二极管](@entry_id:160339)连接晶体管 $M_3$ 钳位在一个相对固定的值 $V_{DD} - V_{SG3}$。因此，当 $V_S$ 升高到使得 $V_{DS} = V_D - V_S$ 不再满足饱和条件时，$V_{ICM}$ 就达到了上限。对于PMOS输入对，限制 $V_{ICM,max}$ 的因素通常是确保尾部的PMOS电流源晶体管保持在饱和区 [@problem_id:1297222]。计算 $V_{ICM,max}$ 要求仔细分析所有相关的电压和饱和条件，例如，对于一个PMOS输入对，可以推导出 $V_{ICM,max} = V_{DD} - |V_{thP}| - V_{ov1} - V_{ov3}$，其中 $V_{ov1}$ 和 $V_{ov3}$ 分别是输入对管和尾电[流管](@entry_id:182650)的[过驱动电压](@entry_id:272139)。

#### [输出电压摆幅](@entry_id:263071)

**[输出电压摆幅](@entry_id:263071) (Output Voltage Swing)** 是指在不导致任何晶体管离开饱和区的前提下，输出节点电压可以变化的最大范围。它由一个上限 $V_{out,max}$ 和一个下限 $V_{out,min}$ 决定。

**最大输出电压 $V_{out,max}$** 受限于PMOS负载晶体管 $M_4$ 必须保持在[饱和区](@entry_id:262273)。这意味着其漏源电压 $V_{SD4}$ 必须大于其[过驱动电压](@entry_id:272139) $|V_{ov,p}|$。因此：
$$
V_{DD} - V_{out,max} \ge |V_{ov,p4}| \implies V_{out,max} \le V_{DD} - |V_{ov,p4}|
$$

**最小输出电压 $V_{out,min}$** 则受限于NMOS驱动晶体管 $M_2$ 和NMOS[尾电流源](@entry_id:262705) $M_{tail}$ 都必须保持在[饱和区](@entry_id:262273)。$M_2$ 需要 $V_{DS2} \ge V_{ov,n2}$，$M_{tail}$ 需要 $V_{DS,tail} \ge V_{ov,tail}$。输出电压 $V_{out}$ 就是 $M_2$ 的漏极电压。其最小值 $V_{out,min} = V_{S,M2} + V_{ov,n2}$。而 $M_2$ 的源极电压 $V_{S,M2}$ 就是[尾电流源](@entry_id:262705)的漏极电压，其最小值是 $V_{ov,tail}$。因此，一个简洁而重要的结论是：
$$
V_{out,min} = V_{ov,n2} + V_{ov,tail}
$$
其中 $V_{ov,n2}$ 和 $V_{ov,tail}$ 分别是输入对晶体管和[尾电流源](@entry_id:262705)晶体管的[过驱动电压](@entry_id:272139)。

总的[输出摆幅](@entry_id:260991)为 $V_{swing} = V_{out,max} - V_{out,min} = (V_{DD} - |V_{ov,p4}|) - (V_{ov,n2} + V_{ov,tail})$。这个表达式清晰地表明，[输出摆幅](@entry_id:260991)直接受到为维持饱和工作所需的各个[过驱动电压](@entry_id:272139)的限制 [@problem_id:1297249]。

#### 增益与摆幅的权衡

在[模拟电路设计](@entry_id:270580)中，几乎不存在“免费的午餐”。提升一项性能指标通常会以牺牲另一项为代价。对于[有源负载](@entry_id:262691)[差分放大器](@entry_id:272747)，一个最经典的权衡关系存在于**[电压增益](@entry_id:266814)**和**[输出电压摆幅](@entry_id:263071)**之间，而**沟道长度 $L$** 是调节这一权衡的关键参数。

让我们分析增加所有晶体管沟道长度 $L$ 的影响，同时保持[偏置电流](@entry_id:260952) $I_{SS}$ 和晶体管宽度 $W$ 不变。

1.  **对增益的影响**：
    [电压增益](@entry_id:266814) $|A_v| = g_{mn} (r_{o,n} \parallel r_{o,p})$。
    -   [输出电阻](@entry_id:276800) $r_o$ 与沟道长度成正比 ($r_o = V_A/I_D \propto L$) [@problem_id:1297214]。因此，增加 $L$ 会显著提高[输出电阻](@entry_id:276800)。
    -   [跨导](@entry_id:274251) $g_{mn} = \sqrt{2\mu_n C_{ox}(W/L)I_{D}}$。当 $W$ 和 $I_D$ 不变时，$g_{mn}$ 与 $1/\sqrt{L}$ 成正比。
    -   综合起来，总增益 $|A_v| \propto \frac{1}{\sqrt{L}} \times L = \sqrt{L}$。这意味着，**增加沟道长度可以提高[电压增益](@entry_id:266814)**。例如，将所有晶体管的 $L$ 加倍，增益将增加约 $\sqrt{2}$ 倍（约 $1.41$ 倍）。

2.  **对摆幅的影响**：
    [输出摆幅](@entry_id:260991) $V_{swing} = V_{DD} - \sum V_{ov}$。
    -   [过驱动电压](@entry_id:272139) $V_{ov} = \sqrt{2I_D / (\mu C_{ox}(W/L))}$。当 $W$ 和 $I_D$ 不变时，$V_{ov}$ 与 $\sqrt{L}$ 成正比。
    -   因此，增加 $L$ 会导致所有相关的[过驱动电压](@entry_id:272139)都增加。
    -   根据摆幅公式，更大的[过驱动电压](@entry_id:272139)会“侵占”电源电压提供的可用空间，从而**减小[输出电压摆幅](@entry_id:263071)**。

这就揭示了一个基本的设计权衡：**通过增加晶体管的沟道长度，设计师可以用[输出电压摆幅](@entry_id:263071)来换取更高的[电压增益](@entry_id:266814)** [@problem_id:1297249]。在对增益要求极高但信号幅度不大的应用（如许多生物信号放大器）中，设计师可能会选择较长的沟道长度。相反，在需要处理大幅度信号的应用中，则可能需要使用较短的沟道长度以保证足够的[输出摆幅](@entry_id:260991)，即使这意味着较低的增益。理解并量化这种权衡是模拟IC设计师的核心技能之一。