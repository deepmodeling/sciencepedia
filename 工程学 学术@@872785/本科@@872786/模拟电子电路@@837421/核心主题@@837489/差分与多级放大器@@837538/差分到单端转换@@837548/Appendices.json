{"hands_on_practices": [{"introduction": "在分析放大器对信号的响应之前，我们必须首先确定其直流静态工作点。这个基础练习 ([@problem_id:1297488]) 要求计算一个有源负载差分放大级的直流输出电压。这是一个关键参数，它决定了放大器的信号摆幅空间并确保所有晶体管都正确偏置在线性工作区，从而深入理解支撑现代集成放大器设计的偏置原理。", "problem": "现代模拟集成电路中的一个基本构建模块是带有源负载的差分放大器。考虑一个采用金属-氧化物-半导体场效应晶体管 (MOSFET) 技术构建的此类电路级。该电路由一对匹配的 NMOS 输入晶体管 M1 和 M2，以及一对匹配的 PMOS 晶体管 M3 和 M4 组成，后者构成一个作为有源负载的电流镜。\n\nM1 和 M2 的源极连接在一起，并接到一个恒定尾电流源，该电流源将总电流 $I_{SS}$ 灌入地。M3 和 M4 的源极连接到正电源 $V_{DD}$。M1 的漏极连接到 M3 的漏极。M2 的漏极连接到 M4 的漏极。为了形成电流镜，M3 和 M4 的栅极连接在一起，并且这条公共栅极线也连接到 M3 的漏极（一种“二极管连接”配置）。\n\n放大器的单端输出 $V_{OUT}$ 从 M2 和 M4 的漏极连接的节点处取出。放大器工作在静态状态，这意味着 M1 和 M2 的栅极电压相同，导致尾电流 $I_{SS}$ 在它们之间平均分配。\n\n对于这个特定设计，一个关键约束是所有四个晶体管（M1、M2、M3、M4）都被偏置在具有相同大小的过驱动电压下工作，我们将其表示为 $V_{OV}$。此外，电路的直流偏置点被设置成使得输出 PMOS 晶体管 M4 恰好工作在其饱和区和三极管区的边界上。\n\n假设所有晶体管的沟道长度调制效应可以忽略不计，确定静态直流输出电压 $V_{OUT}$。你的最终答案应该是一个用 $V_{DD}$ 和 $V_{OV}$ 表示的符号表达式。", "solution": "设每个器件的过驱动电压大小为 $V_{OV}$。对于 NMOS 器件，根据定义 $V_{OV} = V_{GS} - V_{TN}$；对于 PMOS 器件，根据定义 $V_{OV} = V_{SG} - |V_{TP}|$。在给定的偏置下，M1 和 M2 各自承载 $I_{SS}/2$ 的电流，并且 PMOS 电流镜 M3–M4 被偏置成 M3 为二极管连接。因为 M3 是二极管连接的，其栅-源电压 $V_{SG3}$ 会自行调整，以使其电流等于镜像参考电流。在所有四个晶体管具有相同过驱动电压大小的设计约束下，这对 PMOS 器件意味着\n$$\nV_{SG3} - |V_{TP}| = V_{OV}, \\quad V_{SG4} - |V_{TP}| = V_{OV}.\n$$\n因此，M4 以 $V_{OV}$ 的过驱动电压工作。\n\n对于一个长沟道 PMOS 晶体管，忽略沟道长度调制效应，饱和条件是 $V_{SD} \\geq V_{SG} - |V_{TP}|$，而饱和区与三极管区之间的边界发生在等号成立时：\n$$\nV_{SD4} = V_{SG4} - |V_{TP}| = V_{OV}.\n$$\n将 $V_{SD4}$ 用节点电压表示，源极在 $V_{DD}$，漏极在 $V_{OUT}$，得到\n$$\nV_{SD4} = V_{S4} - V_{D4} = V_{DD} - V_{OUT}.\n$$\n对 M4 应用边界条件可得\n$$\nV_{DD} - V_{OUT} = V_{OV} \\quad \\Rightarrow \\quad V_{OUT} = V_{DD} - V_{OV}.\n$$\n此表达式满足所述约束，并按要求仅使用了 $V_{DD}$ 和 $V_{OV}$。", "answer": "$$\\boxed{V_{DD}-V_{OV}}$$", "id": "1297488"}, {"introduction": "放大器的核心功能是提供增益，而这个实践问题 ([@problem_id:1297526]) 在高层性能指标和底层器件参数之间架起了一座桥梁。您将计算输入晶体管为达到目标电压增益所需的跨导（$g_m$）。这是一项常见的电路设计任务，它揭示了晶体管特性与放大器整体性能之间的直接联系。", "problem": "一位工程师正在设计一个音频前置放大器的输入级，该输入级采用一个带有有源电流镜负载的标准差分放大器。该放大器采用金属氧化物半导体场效应晶体管（MOSFET）技术构建，并被配置为将差分输入电压转换为单端输出电压。形成差分对的两个输入MOSFET被认为是完全匹配的。\n\n设计规范要求从差分输入到单端输出的电压增益大小为 $|A_v| = 40$。单端输出节点的总等效输出电阻为 $R_{out} = 125 \\text{ k}\\Omega$，该电阻考虑了驱动晶体管和有源负载的特性。\n\n为了满足这一增益规范，每个输入MOSFET所需的跨导 $g_m$ 是多少？请用毫西门子（mS）表示你的答案，并四舍五入到两位有效数字。", "solution": "对于一个将差分输入转换为单端输出、带有电流镜有源负载的匹配MOS差分对，设差分输入为 $v_{id} = v_{1} - v_{2}$，并采用对称驱动，使得 $v_{1} = +\\frac{v_{id}}{2}$ 和 $v_{2} = -\\frac{v_{id}}{2}$。在理想的尾电流源下，源极节点为交流地，因此输入晶体管的小信号漏极电流为 $\\Delta i_{1} = g_{m}\\frac{v_{id}}{2}$ 和 $\\Delta i_{2} = -g_{m}\\frac{v_{id}}{2}$。电流镜将 $\\Delta i_{1}$ 复制到输出支路，因此注入到输出节点的净小信号电流为\n$$\n\\Delta i_{o} = \\Delta i_{\\text{mirror}} - \\Delta i_{2} = \\Delta i_{1} - \\Delta i_{2} = g_{m}\\frac{v_{id}}{2} - \\left(-g_{m}\\frac{v_{id}}{2}\\right) = g_{m}v_{id}.\n$$\n在输出节点处存在等效输出电阻 $R_{out}$ 的情况下，输出电压为\n$$\nv_{o} = -\\Delta i_{o}R_{out} = -g_{m}R_{out}\\,v_{id},\n$$\n因此差分到单端的电压增益为\n$$\nA_{v} = \\frac{v_{o}}{v_{id}} = -g_{m}R_{out}, \\quad |A_{v}| = g_{m}R_{out}.\n$$\n求解 $g_{m}$ 得\n$$\ng_{m} = \\frac{|A_{v}|}{R_{out}}.\n$$\n代入 $|A_{v}| = 40$ 和 $R_{out} = 125 \\times 10^{3}\\ \\Omega$，\n$$\ng_{m} = \\frac{40}{125 \\times 10^{3}}\\ \\text{S} = 3.2 \\times 10^{-4}\\ \\text{S} = 0.32\\ \\text{mS}.\n$$\n四舍五入到两位有效数字，每个输入MOSFET所需的跨导为 $0.32\\ \\text{mS}$。", "answer": "$$\\boxed{0.32}$$", "id": "1297526"}, {"introduction": "理想差分放大器能完美抑制共模噪声，但真实世界的电路受非理想因素限制。本练习 ([@problem_id:1297522]) 探讨了关键性能指标——共模抑制比（CMRR），以及它如何受到尾电流源有限电阻的影响。解决这个问题将向您展示如何量化对辅助元件的要求以满足特定的CMRR目标，这是高性能模拟设计中的一项关键技能。", "problem": "一位模拟集成电路设计师正在使用一个基本的 NMOS 差分对来创建一个差分转单端转换器。该放大器的每个晶体管的漏极都连接了一个阻性负载 $R_D$。输出电压从其中一个晶体管的漏极取出，而另一个晶体管的漏极也连接到相同值的负载电阻 $R_D$，以保持电路对称。该差分对由一个非理想的尾电流源偏置，该电流源提供总直流电流 $I_{TAIL}$ 并具有有限的输出电阻 $R_{SS}$。\n\n为电路设计提供了以下参数：\n- 工艺跨导参数：$\\mu_n C_{ox} = 200 \\; \\mu\\text{A}/\\text{V}^2$\n- 两个晶体管的宽长比：$(W/L) = 50$\n- 负载电阻：$R_D = 10 \\; \\text{k}\\Omega$\n- 总尾偏置电流：$I_{TAIL} = 0.5 \\; \\text{mA}$\n\n设计必须达到至少 80 dB 的共模抑制比 (CMRR)。\n\n在您的分析中，假设两个 NMOS 晶体管完全匹配，工作在饱和区，并具有无限的本征输出电阻 ($r_o \\to \\infty$)。您也可以忽略体效应。\n\n确定尾电流源所需的最小输出电阻 $R_{SS}$，以满足此 CMRR 规范。请用兆欧 ($\\text{M}\\Omega$) 表示您的答案，并四舍五入到三位有效数字。", "solution": "在晶体管匹配、$r_{o} \\to \\infty$ 且体效应可忽略的条件下，对 NMOS 差分对进行小信号分析。令 $k \\equiv \\mu_{n} C_{ox} (W/L)$，并设每个晶体管的静态漏极电流为 $I_{D} = I_{TAIL}/2$。\n\n每个晶体管在饱和区的跨导可从平方律模型中获得：\n$$\nI_{D} = \\frac{1}{2} k V_{ov}^{2}, \\quad g_{m} = k V_{ov} = \\sqrt{2 k I_{D}}.\n$$\n\n通过用 $v_{g1} = +v_{id}/2$ 和 $v_{g2} = -v_{id}/2$ 驱动栅极，可以找到到单端输出的差模增益。对于理想的差分激励，源极节点处于交流接地状态，因此 $v_{s} = 0$。观测侧的小信号漏极电流为 $i_{d1} = g_{m} (v_{id}/2)$，并且漏极负载 $R_{D}$ 接到交流地，\n$$\nA_{d} \\equiv \\frac{v_{o}}{v_{id}} = - \\frac{g_{m} R_{D}}{2}.\n$$\n\n对于共模激励，$v_{g1} = v_{g2} = v_{cm}$，源极节点电压 $v_{s}$ 由源极节点的 KCL 决定，包括尾电阻 $R_{SS}$：\n$$\n2 g_{m} (v_{cm} - v_{s}) = \\frac{v_{s}}{R_{SS}} \\;\\;\\Rightarrow\\;\\; v_{s} = \\frac{2 g_{m} R_{SS}}{1 + 2 g_{m} R_{SS}} \\, v_{cm}.\n$$\n任一侧的漏极电流为 $i_{d} = g_{m} (v_{cm} - v_{s}) = \\dfrac{g_{m}}{1 + 2 g_{m} R_{SS}} \\, v_{cm}$，因此单端共模增益为\n$$\nA_{cm} \\equiv \\frac{v_{o}}{v_{cm}} = - \\frac{g_{m} R_{D}}{1 + 2 g_{m} R_{SS}}.\n$$\n\n因此，单端 CMRR 的幅值为\n$$\n\\mathrm{CMRR} = \\left|\\frac{A_{d}}{A_{cm}}\\right| = \\frac{\\frac{g_{m} R_{D}}{2}}{\\frac{g_{m} R_{D}}{1 + 2 g_{m} R_{SS}}} = \\frac{1 + 2 g_{m} R_{SS}}{2}.\n$$\n规范要求 $20 \\log_{10}(\\mathrm{CMRR}) \\geq 80$，即\n$$\n\\mathrm{CMRR} \\geq 10^{\\frac{80}{20}} = 10^{4}.\n$$\n因此，\n$$\n\\frac{1 + 2 g_{m} R_{SS}}{2} \\geq 10^{4} \\;\\;\\Rightarrow\\;\\; 1 + 2 g_{m} R_{SS} \\geq 2 \\times 10^{4} \\;\\;\\Rightarrow\\;\\; R_{SS} \\geq \\frac{2 \\times 10^{4} - 1}{2 g_{m}}.\n$$\n\n现在根据给定参数计算 $g_{m}$。根据 $k = \\mu_{n} C_{ox} (W/L)$ 和 $I_{D} = I_{TAIL}/2$，\n$$\nk = (200 \\times 10^{-6}) \\times 50 = 0.01 \\;\\text{A/V}^{2}, \\quad I_{D} = \\frac{0.5 \\times 10^{-3}}{2} = 0.25 \\times 10^{-3} \\;\\text{A},\n$$\n$$\ng_{m} = \\sqrt{2 k I_{D}} = \\sqrt{2 \\times 0.01 \\times 0.25 \\times 10^{-3}} = \\sqrt{5} \\times 10^{-3} \\;\\text{S}.\n$$\n因此，\n$$\nR_{SS,\\min} = \\frac{2 \\times 10^{4} - 1}{2 \\sqrt{5} \\times 10^{-3}} \\;\\Omega = \\left(\\frac{19999}{2 \\sqrt{5}}\\right) \\times 10^{3} \\;\\Omega.\n$$\n转换为兆欧可得\n$$\nR_{SS,\\min} = \\left(\\frac{19999}{2 \\sqrt{5}}\\right) \\times 10^{-3} \\;\\text{M}\\Omega \\approx 4.4719 \\;\\text{M}\\Omega.\n$$\n以兆欧为单位，四舍五入到三位有效数字，结果为 $4.47$。", "answer": "$$\\boxed{4.47}$$", "id": "1297522"}]}