## 引言
与传统的有限元方法（FEM）依赖于预定义的网格结构不同，[无网格方法](@entry_id:177458)提供了一种更为灵活的计算力学[范式](@entry_id:161181)。通过将问题域离散为一组自由[分布](@entry_id:182848)的节点，[无网格方法](@entry_id:177458)能够自然地处理大变形、裂纹扩展和移动边界等几何复杂性高的问题，从而弥补了传统方法在这些领域的不足。然而，这种灵活性的代价是形函数构造和数值实现的复杂性增加，对理论的深刻理解和严谨的数值处理提出了更高的要求。

本文旨在系统性地介绍两种最重要和最广泛使用的[无网格方法](@entry_id:177458)：[无单元伽辽金法](@entry_id:166627)（EFG）和[再生核](@entry_id:262515)粒子法（RKPM）。我们将引导读者深入其核心，从理论走向实践。在“原理与机制”一章中，我们将详细剖析形函数如何通过移动最小二乘（MLS）近似和[再生核](@entry_id:262515)思想构建，并探讨其完备性、光滑性以及缺乏[克罗内克δ](@entry_id:265321)性质等关键特性，同时阐述如何在伽辽金框架下进行数值积分和求解。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示这些方法在解决[计算固体力学](@entry_id:169583)中的前沿问题（如断裂力学和[材料非线性](@entry_id:162855)）时的强大能力，并讨论高效计算实现、[代码验证](@entry_id:146541)和稳定性控制等实际挑战。最后，通过“动手实践”部分，读者将有机会亲手解决具体问题，巩固所学知识。

## 原理与机制

与依赖于预定义网格单元来构建形函数（shape functions）的传统有限元方法（FEM）形成鲜明对比，[无网格方法](@entry_id:177458)（meshfree methods）采用了一种根本不同的[范式](@entry_id:161181)。其核心思想是将问题域离散为一组节点，即“节点云”，而无需定义连接这些节点的显式单元结构 [@problem_id:2576482]。这种方法的灵活性使得处理大变形、移动边界和断裂等问题变得更加自然。在[无网格方法](@entry_id:177458)中，场变量 $u$ 的近似解 $u_h(\mathbf{x})$ 在域内任意点 $\mathbf{x}$ 处表示为：

$$
u_h(\mathbf{x}) = \sum_{I=1}^{N} \phi_I(\mathbf{x}) d_I
$$

其中，$\{\phi_I(\mathbf{x})\}_{I=1}^{N}$ 是与节点 $I$ 关联的形函数集，$d_I$ 是相应的节点参数或自由度，$N$ 是节点总数。[无网格方法](@entry_id:177458)最关键的挑战和特色在于如何仅根据节点的位置来构建这些形函数。本章将深入探讨两种主流[无网格方法](@entry_id:177458)——[无单元伽辽金法](@entry_id:166627)（Element-Free Galerkin, EFG）和[再生核](@entry_id:262515)粒子法（Reproducing Kernel Particle Method, RKPM）——背后的核心原理和机制。

### 构建形函数：移动最小二乘（MLS）近似

移动最小二乘（MLS）法是许多[无网格方法](@entry_id:177458)（特别是EFG）构建形函数的基石。其基本思想是在每个评估点 $\mathbf{x}$ 处，通过一个加权[最小二乘拟合](@entry_id:751226)来局部地确定一个多项式近似。这个过程不依赖于任何固定的网格，而是利用评估点周围的节点信息“动态地”构建近似。

#### 权函数

MLS近似的核心要素是**权函数**（weight function），通常记为 $w$。对于每个节点 $I$，其权函数 $w(\mathbf{x} - \mathbf{x}_I)$ 在以 $\mathbf{x}_I$ 为中心的局部区域内取正值，并在该区域外为零。这个非零区域被称为节点 $I$ 的**[影响域](@entry_id:175298)**（domain of influence）或**支撑域**（support）。支撑域的大小，通常由一个称为**支撑半径**（support radius）$\rho$ 的参数控制，决定了在任何给定点 $\mathbf{x}$ 的计算中会包含哪些邻近节点。

权函数的选择对近似的性质（如[光滑性](@entry_id:634843)）和计算成本有直接影响 [@problem_id:2576464]。常用的权函数包括：
- **[三次样条](@entry_id:140033)函数**：在支撑域内是三次多项式，并在支撑域边界处保证函数值、一阶和[二阶导数](@entry_id:144508)均为零。这确保了权函数至少是 $C^2$ 连续的。
- **四次样条函数**：与三次样条类似，但在支撑域内是四次多项式，同样在边界处具有 $C^2$ 连续性。
- **截断高斯函数**：形式为 $w(r) = \exp(-\alpha r^2) - \exp(-\alpha)$（其中 $r$ 是归一化距离），在支撑域边界处仅为 $C^0$ 连续，因为其一阶导数在边界处不为零。

MLS近似的形函数会继承权函数的光滑性。例如，如果使用 $C^k$ 连续的权函数，在邻近节点集合不变的区域内，所产生的MLS形函数也是 $C^k$ 连续的 [@problem_id:2576464]。在计算成本方面，多项式权函数的评估通常比包含[指数函数](@entry_id:161417)的[高斯权函数](@entry_id:192407)更快。此外，计算成本与支撑域内的邻近节点数量密切相关。对于一个 $d$ 维空间中的均匀节点[分布](@entry_id:182848)，邻近节点的数量与 $\rho^d$ 成正比，因此将支撑半径加倍会使计算邻居节点的成本增加约 $2^d$ 倍 [@problem_id:2576464]。

#### [最小二乘拟合](@entry_id:751226)与[矩量](@entry_id:152982)矩阵

在任意评估点 $\mathbf{x}$，MLS方法旨在寻找一个局部多项式近似 $u_h(\mathbf{y}) = \mathbf{p}^T(\mathbf{y})\mathbf{a}(\mathbf{x})$，使得它与周围节点 $I$ 的参数 $d_I$ 之间的加权平方误差最小。这里，$\mathbf{p}(\mathbf{y})$ 是一个包含多项式[基函数](@entry_id:170178)的向量（例如，在二维线性基中，$\mathbf{p}^T(y_1, y_2) = [1, y_1, y_2]$），其阶数为 $m$。$\mathbf{a}(\mathbf{x})$ 是依赖于评估点 $\mathbf{x}$ 的待定系数向量。待最小化的泛函为：

$$
J(\mathbf{a}) = \sum_{I=1}^{N} w(\mathbf{x} - \mathbf{x}_I) \left( \mathbf{p}^T(\mathbf{x}_I)\mathbf{a}(\mathbf{x}) - d_I \right)^2
$$

通过令 $J$ 对 $\mathbf{a}$ 的偏导数为零（$\frac{\partial J}{\partial \mathbf{a}} = \mathbf{0}$），我们得到一组[线性方程](@entry_id:151487)，称为**法方程**（normal equations）：

$$
A(\mathbf{x})\mathbf{a}(\mathbf{x}) = B(\mathbf{x})\mathbf{d}
$$

其中 $\mathbf{d}$ 是包含所有节点参数 $d_I$ 的向量。矩阵 $A(\mathbf{x})$ 和 $B(\mathbf{x})$ 的定义如下 [@problem_id:2576459]：

- **[矩量](@entry_id:152982)矩阵 (Moment Matrix)** $A(\mathbf{x})$ 是一个 $m_p \times m_p$ 的[对称矩阵](@entry_id:143130)，其中 $m_p$ 是多项式[基函数](@entry_id:170178)的数量：
$$
A(\mathbf{x}) = \sum_{I=1}^{N} w(\mathbf{x} - \mathbf{x}_I) \mathbf{p}(\mathbf{x}_I) \mathbf{p}^T(\mathbf{x}_I)
$$

- 矩阵 $B(\mathbf{x})$ 是一个 $m_p \times N$ 的矩阵：
$$
B(\mathbf{x}) = \left[ w(\mathbf{x} - \mathbf{x}_1)\mathbf{p}(\mathbf{x}_1) \quad \dots \quad w(\mathbf{x} - \mathbf{x}_N)\mathbf{p}(\mathbf{x}_N) \right]
$$

从法方程中解出 $\mathbf{a}(\mathbf{x}) = A^{-1}(\mathbf{x})B(\mathbf{x})\mathbf{d}$，并将其代入局部近似表达式 $u_h(\mathbf{x}) = \mathbf{p}^T(\mathbf{x})\mathbf{a}(\mathbf{x})$，我们得到：

$$
u_h(\mathbf{x}) = \mathbf{p}^T(\mathbf{x}) A^{-1}(\mathbf{x}) \sum_{I=1}^{N} w(\mathbf{x} - \mathbf{x}_I) \mathbf{p}(\mathbf{x}_I) d_I
$$

通过将上式与标准近似形式 $u_h(\mathbf{x}) = \sum_I \phi_I(\mathbf{x}) d_I$ 进行比较，我们最终可以确定MLS形函数的表达式：

$$
\phi_I(\mathbf{x}) = \mathbf{p}^T(\mathbf{x}) A^{-1}(\mathbf{x}) w(\mathbf{x} - \mathbf{x}_I) \mathbf{p}(\mathbf{x}_I)
$$

#### 局部问题的[适定性](@entry_id:148590)：单解性条件

为了使MLS形函数有唯一定义，[矩量](@entry_id:152982)矩阵 $A(\mathbf{x})$ 必须在每个评估点 $\mathbf{x}$ 都是可逆的。$A(\mathbf{x})$ 是一个[对称半正定矩阵](@entry_id:163376)，其[可逆性](@entry_id:143146)等价于其[正定性](@entry_id:149643)。这引出了一个关键的**单解性条件**（unisolvency condition） [@problem_id:2576535]。

$A(\mathbf{x})$ 可逆的充分必要条件是：在点 $\mathbf{x}$ 的支撑域内，拥有严格正权重的节点集合（即“激活”节点集）不能被任何一个次数不高于 $m$ 的非零多项式同时零化。这在实践中意味着两个条件 [@problem_id:2576459]：
1.  **节点数量**：支撑域内的激活节点数量必须至少等于多项式[基函数](@entry_id:170178)的数量 $m_p = \binom{m+d}{d}$。
2.  **节点几何构型**：这些节点必须处于“一般位置”，即它们的几何[排列](@entry_id:136432)不能是退化的。例如，对于二维线性基（$m=1$, $m_p=3$），至少需要3个非共线的节点。对于二维二次基（$m=2$, $m_p=6$），至少需要6个不位于同一个二次曲线上的节点。

支撑域半径 $r_s$ 与平均节点间距 $h$ 的比值 $\rho = r_s/h$ 对满足此条件至关重要。如果 $\rho$ 太小，可能无法在每个点的支撑域内包含足够多的节点，导致 $A(\mathbf{x})$ 奇异。相反，适度增大 $\rho$（例如，在二维线性基的情况下，$\rho$ 取值在2到3之间）可以确保激活节点的数量充足且[分布](@entry_id:182848)良好，从而提高 $A(\mathbf{x})$ 和最终刚度矩阵的数值稳定性（条件数），而不会改变近似的完备性阶次 [@problem_id:2576527]。

### [再生核](@entry_id:262515)粒子法 (RKPM)

[再生核](@entry_id:262515)粒子法（RKPM）是另一种构建无网格形函数的重要方法，它与MLS在思想上密切相关。RKPM从一个初始的**[核函数](@entry_id:145324)**（kernel function）$W$（类似于MLS中的权函数）出发，通过引入一个**修正函数**（correction function）来构造一个新的**[再生核](@entry_id:262515)**（reproducing kernel）$\widetilde{W}$，以确保其满足预设的[多项式再生](@entry_id:753580)条件 [@problem_id:2576482]。

RKPM的形函数推导基于再生条件，即对于任意属于基函数空间的多项式 $p(\mathbf{x})$，其近似必须能精确地重现自身。在离散形式下，这可以表示为 $\sum_I \phi_I^{\mathrm{RKPM}}(\mathbf{x}) p(\mathbf{x}_I) = p(\mathbf{x})$。通过这一要求，可以推导出RKPM的形函数表达式 [@problem_id:2576480]：

$$
\phi_I^{\mathrm{RKPM}}(\mathbf{x}) = \mathbf{p}^T(\mathbf{x}) M^{-1}(\mathbf{x}) W(\mathbf{x} - \mathbf{x}_I) \mathbf{p}(\mathbf{x}_I) \omega_I
$$

其中，$M(\mathbf{x}) = \sum_J \omega_J W(\mathbf{x} - \mathbf{x}_J) \mathbf{p}(\mathbf{x}_J) \mathbf{p}^T(\mathbf{x}_J)$ 是RKPM的矩量矩阵，$\omega_I$ 是与节点相关的积分权重（粒子体积）。

可以观察到，RKPM和MLS的形函数表达式在结构上非常相似。事实上，当两种方法使用相同的多项式基、相同的核/权函数（即 $W \equiv w$）、以及均匀的节[点积](@entry_id:149019)分权重（即所有 $\omega_I$ 都相等，例如 $\omega_I=1$）时，它们的[矩量](@entry_id:152982)矩阵成正比（$M(\mathbf{x}) = c A(\mathbf{x})$），并且最终产生的形函数是完全相同的 [@problem_id:2576480]。这揭示了两种方法在数学本质上的紧密联系。

### 无网格形函数的基本性质

无论是通过MLS还是RKPM构造，所得到的形函数都具有一些共同的、对其在[伽辽金法](@entry_id:749698)中应用至关重要的基本性质。

#### 完备性与单位分解性

一个形函数集被称为具有 **$m$ 阶完备性**（$m$-th order completeness）或**[多项式再生](@entry_id:753580)性**，如果它能够从节点采样值中精确地重现任意一个次数不高于 $m$ 的多项式，即对于任意 $p \in \mathcal{P}_m$（次数 $\le m$ 的多项式空间），下式恒成立 [@problem_id:2576517]：

$$
\sum_{I=1}^{N} \phi_I(\mathbf{x}) p(\mathbf{x}_I) = p(\mathbf{x})
$$

通过MLS或RKPM的构造过程，只要[矩量](@entry_id:152982)矩阵可逆，形函数天然地具有与其所用多项式基 $\mathbf{p}(\mathbf{x})$ 阶次相对应的完备性。

完备性的一个直接且重要的推论是**单位分解性**（Partition of Unity, PU）。这是指所有形函数在域内任意点的和恒为1：

$$
\sum_{I=1}^{N} \phi_I(\mathbf{x}) = 1, \quad \forall \mathbf{x} \in \Omega
$$

单位分解性等价于 0 阶完备性（即能够精确重现[常数函数](@entry_id:152060)）。任何对于 $m \ge 0$ 具有 $m$ 阶完备性的近似，必然满足[单位分解](@entry_id:150115)性 [@problem_id:2576517] [@problem_id:2576531]。

单位分解性在[伽辽金法](@entry_id:749698)中具有极其重要的意义。首先，它保证了近似的**一致性**（consistency），这是收敛性的最低要求。其次，在守恒律问题的 Bubnov-Galerkin 离散化中，[单位分解](@entry_id:150115)性确保了[常数函数](@entry_id:152060)（例如 $w^h(\mathbf{x})=1$）是[试探空间](@entry_id:756166)中的一个有效函数。将这个常数函数代入离散[弱形式](@entry_id:142897)，就能在积分精确的情况下，恢复离散系统的**全局守恒律**（如全局力平衡） [@problem_id:2576531]。

#### 缺乏克罗内克（Kronecker）$\delta$ 性质

一个形函数集如果满足 $\phi_I(\mathbf{x}_J) = \delta_{IJ}$（其中 $\delta_{IJ}$ 在 $I=J$ 时为1，否则为0），则称其具有**克罗内克 $\delta$ 性质**。这个性质意味着节点参数 $d_I$ 直接等于函数在节点 $I$ 处的近似值 $u_h(\mathbf{x}_I)$。

标准MLS和RKPM方法产生的形函数通常**不具备**克罗内克 $\delta$ 性质 [@problem_id:2576486]。这是因为它们本质上是**近似**（approximation）而非**插值**（interpolation）。在节点 $\mathbf{x}_J$ 处的近似值 $u_h(\mathbf{x}_J) = \sum_I \phi_I(\mathbf{x}_J) d_I$，是多个邻近节点参数 $d_I$ 的加权平均，通常不等于 $d_J$ 本身。

这一特性带来了[无网格方法](@entry_id:177458)在实践中的一个主要挑战：**本质边界条件（[Dirichlet边界条件](@entry_id:142800)）的施加**。由于不满足克罗内克 $\delta$ 性质，我们不能像在标准有限元中那样，通过直接设置边界节点的自由度 $d_I$ 来强制施加给定的边界值。这样做并不能保证解在边界上满足条件。因此，必须采用替代的**弱施加策略**，例如：
- **[罚函数法](@entry_id:636090) (Penalty Method)**
- **[拉格朗日乘子法](@entry_id:176596) (Lagrange Multipliers)**
- **[Nitsche方法](@entry_id:175793)**

尽管存在一些可以强制插值特性的变体方法，如插值移动最小二乘（Interpolating MLS），它们通常通过引入奇异权函数来实现。然而，这种修改可能会以牺牲近似的[光滑性](@entry_id:634843)或恶化[数值条件](@entry_id:136760)数为代价 [@problem_id:2576486]。

### 从近似到求解：伽辽金框架

构建了满足特定性质的形函数后，就可以将它们用于[伽辽金法](@entry_id:749698)中，以[求解偏微分方程](@entry_id:138485)。

#### 近似精度与收敛性

形函数的完备性阶次直接决定了数值方法的[收敛率](@entry_id:146534)。对于一个具有 $p$ 阶完备性的近似空间，根据[Bramble-Hilbert引理](@entry_id:746965)和标准的[有限元误差分析](@entry_id:749282)理论，求解一个良态的[二阶椭圆问题](@entry_id:754613)时，可以预期如下的[误差收敛](@entry_id:137755)阶 [@problem_id:2576517]：
- **[能量范数](@entry_id:274966)**（例如 $H^1$ 范数）下的误差为 $O(h^p)$。
- **$L^2$ 范数**下的误差为 $O(h^{p+1})$。

这里，$h$ 是节点的特征尺寸。这些理论[收敛率](@entry_id:146534)的实现，前提是精确解具有足够的[光滑性](@entry_id:634843)（例如，属于 $H^{p+1}(\Omega)$ 空间），并且弱形式中的积分得到足够精确的计算。

此外，完备性还带来了**伽辽金精确性**（Galerkin exactness）的性质。如果一个问题的精确解本身就是一个次数不高于 $p$ 的多项式，那么具有 $p$ 阶完备性的伽辽金方法（在忽略边界条件施加和[数值积分误差](@entry_id:137490)的情况下）将能够得到该精确解 [@problem_id:2576517]。

#### [数值积分](@entry_id:136578)：背景单元的角色

[伽辽金法](@entry_id:749698)的弱形式需要计算形函数及其导数的乘积在整个问题域上的积分，例如刚度矩阵的项：
$$
K_{IJ} = \int_{\Omega} (\nabla \phi_I)^{T} k \nabla \phi_J \, d\Omega
$$
由于MLS或RKPM形函数及其导数是复杂的有理函数而非多项式，这些积分通常无法解析求解。因此，必须采用[数值积分](@entry_id:136578)。

[无网格方法](@entry_id:177458)中，一个优雅且强大的解决方案是引入一个**背景积分网格**（background integration grid）[@problem_id:2576510]。这个网格独立于节点[分布](@entry_id:182848)，仅用于将积分域 $\Omega$ 分割成一系列简单的[子域](@entry_id:155812)（**背景单元**，如四边形或三角形），然后在每个背景单元上使用标准的[高斯求积](@entry_id:146011)（Gaussian quadrature）等方法。

选择[高斯求积](@entry_id:146011)的阶数至关重要，它必须足够高，以保持近似的理论[收敛率](@entry_id:146534)。这个要求通过**“[分片检验](@entry_id:162864)”**（patch test）来形式化。为了使一个具有 $p$ 阶完备性的方法能够通过 $p$ 阶[分片检验](@entry_id:162864)，计算[刚度矩阵](@entry_id:178659)所用的求积法则必须至少能精确积分次数为 $2(p-1)$ 的多项式。根据这个规则，可以为不同类型的背景单元确定所需的[高斯点](@entry_id:170251)数 [@problem_id:2576510]：
- **一维**：需要至少 $p$ 个[高斯点](@entry_id:170251)。
- **二维[张量积](@entry_id:140694)单元（四边形）**：每个方向需要至少 $p$ 个[高斯点](@entry_id:170251)。
- **二维[三角形单元](@entry_id:167871)**：需要采用能够精确积分次数至少为 $2p-2$ 的多项式的求积方案。

不恰当的低阶积分会导致刚度矩阵奇异或近似精度下降，而过度的[超积](@entry_id:148557)分则会不必要地增加计算成本。因此，根据近似的完备性阶次来审慎选择积分方案，是成功实施无网格伽辽金方法的关键环节。