{"hands_on_practices": [{"introduction": "Inf-sup（或LBB）条件是混合问题稳定性的基石。虽然其理论证明通常很抽象，但通过一个简单的案例直接计算该常数可以提供具体的直觉。本练习旨在揭示这个常数的神秘面纱，通过在一个一维模型问题中从第一性原理出发进行推导，展示稳定性如何直接依赖于为原始变量和拉格朗日乘子所选择的函数空间，特别是边界条件和约束 [@problem_id:2577764]。", "problem": "考虑一维域 $\\Omega=(0,1)$ 以及由双线性形式 $b:V\\times Q\\to\\mathbb{R}$ 定义的混合公式\n$$\nb(v,q)=\\int_{0}^{1} v'(x)\\,q(x)\\,dx,\n$$\n其中 $V$ 和 $Q$ 是下面指定的希尔伯特空间 (Hilbert space)，范数由 $\\|v\\|_{V}=\\|v'\\|_{L^{2}(0,1)}$ 和 $\\|q\\|_{Q}=\\|q\\|_{L^{2}(0,1)}$ 给出。与 $b$ 相关的 inf-sup 常数 $\\beta$ 定义为\n$$\n\\beta=\\inf_{q\\in Q\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{b(v,q)}{\\|v\\|_{V}\\,\\|q\\|_{Q}}.\n$$\n假设主要设置为 $V=H_{0}^{1}(0,1)$ 和 $Q=L_{0}^{2}(0,1)$，其中 $H_{0}^{1}(0,1)$ 表示在 $x=0$ 和 $x=1$ 处迹为零的索博列夫空间 (Sobolev space)，而 $L_{0}^{2}(0,1)$ 表示 $L^{2}(0,1)$ 中在 $(0,1)$ 上均值为零的函数组成的子空间。从索博列夫空间 $H^{1}(0,1)$ 的基本定义和柯西-施瓦茨不等式 (Cauchy–Schwarz inequality) 出发，计算此主要设置下 inf-sup 常数 $\\beta$ 的精确值。\n\n在您的解答中，简要而严谨地讨论在以下备选的边界和余定义域选择下，$\\beta$ 将如何变化（增加、减少或保持不变），并从第一性原理出发证明您的结论，不要使用现成的公式：\n- 情况 $\\mathrm{A}$：$V=H_{0}^{1}(0,1)$ 和 $Q=L^{2}(0,1)$。\n- 情况 $\\mathrm{B}$：$V=\\{v\\in H^{1}(0,1): v(0)=0\\}$ 和 $Q=L^{2}(0,1)$。\n\n您最终提交的答案必须是主要设置下 $\\beta$ 的精确值，表示为一个无单位的实数。", "solution": "问题是为指定的希尔伯特空间 $V$ 和 $Q$ 计算与双线性形式 $b(v,q)=\\int_{0}^{1} v'(x)\\,q(x)\\,dx$ 相关的 inf-sup 常数 $\\beta$。该常数定义为\n$$\n\\beta=\\inf_{q\\in Q\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{b(v,q)}{\\|v\\|_{V}\\,\\|q\\|_{Q}}\n$$\n其中范数由 $\\|v\\|_{V}=\\|v'\\|_{L^{2}(0,1)}$ 和 $\\|q\\|_{Q}=\\|q\\|_{L^{2}(0,1)}$ 给出。$L^2(0,1)$ 内积表示为 $(f,g)_{L^2} = \\int_{0}^{1} f(x)g(x)\\,dx$。\n\n该问题在数学上是适定的 (well-posed)。半范数 $\\|v'\\|_{L^2(0,1)}$ 在 $V=H_0^1(0,1)$ 和 $V=\\{v\\in H^1(0,1):v(0)=0\\}$ 上可作为范数，这是由于庞加莱-弗里德里希不等式 (Poincaré-Friedrichs inequality)，它保证了对于在定义域内至少一点为零的函数，$\\|v'\\|_{L^2(0,1)}$ 范数可以控制 $\\|v\\|_{L^2(0,1)}$ 范数。我们对每种情况进行求解。\n\n**主要设置：$V=H_{0}^{1}(0,1)$ 和 $Q=L_{0}^{2}(0,1)$**\n\n在此设置下，inf-sup 常数为\n$$\n\\beta=\\inf_{q\\in L_{0}^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\n我们固定一个任意的 $q \\in Q \\setminus \\{0\\}$，即 $q \\in L_{0}^{2}(0,1)$；这意味着 $\\int_{0}^{1} q(x)\\,dx=0$ 且 $\\|q\\|_{L^2(0,1)} \\neq 0$。我们首先计算上确界项：\n$$\nS_q = \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}}.\n$$\n令 $V'$ 为 $V$ 中函数的导数空间，即 $V'=\\{u=v' : v \\in H_{0}^{1}(0,1)\\}$。项 $S_q$ 可以重写为\n$$\nS_q = \\sup_{u\\in V'\\setminus\\{0\\}}\\ \\frac{(u,q)_{L^2}}{\\|u\\|_{L^{2}(0,1)}}.\n$$\n我们必须刻画空间 $V'$。\n一个函数 $v$ 属于 $H^1(0,1)$，如果 $v$ 及其弱导数 $v'$ 都属于 $L^2(0,1)$。这意味着 $v$ 是绝对连续的。根据勒贝格积分 (Lebesgue integral) 的微积分基本定理，对于任何 $v \\in H_0^1(0,1)$，我们有 $v(1)-v(0) = \\int_0^1 v'(x) dx$。由于 $v \\in H_0^1(0,1)$，所以 $v(0)=v(1)=0$，这意味着 $\\int_0^1 v'(x) dx = 0$。这表明 $v' \\in L_0^2(0,1)$。因此，$V' \\subseteq L_0^2(0,1)$。\n\n反之，令 $u$ 为 $L_0^2(0,1)$ 中的任意函数。定义函数 $v$ 为 $v(x) = \\int_0^x u(t) dt$。由于 $u \\in L^2(0,1)$，$v$ 是绝对连续的，并且其导数几乎处处为 $v'(x)=u(x)$。因此，$v \\in H^1(0,1)$。我们检查边界条件：\n- $v(0) = \\int_0^0 u(t) dt = 0$。\n- $v(1) = \\int_0^1 u(t) dt = 0$，因为 $u \\in L_0^2(0,1)$。\n因此，$v \\in H_0^1(0,1)$ 且 $v'=u$。这证明了对于任何 $u \\in L_0^2(0,1)$，存在一个 $v \\in H_0^1(0,1)$ 使得 $v'=u$。所以，$L_0^2(0,1) \\subseteq V'$。\n\n结合两个包含关系，我们得到 $V' = L_0^2(0,1)$，这恰好是空间 $Q$。\n因此，上确界项 $S_q$ 是在 $u \\in L_0^2(0,1)$ 上取值的：\n$$\nS_q = \\sup_{u\\in L_{0}^{2}(0,1)\\setminus\\{0\\}}\\ \\frac{(u,q)_{L^2}}{\\|u\\|_{L^{2}(0,1)}}.\n$$\n由于 $q$ 本身就在 $L_0^2(0,1)$ 中，我们可以选择 $u=q$。这个选择给出 $\\frac{(q,q)_{L^2}}{\\|q\\|_{L^2(0,1)}} = \\|q\\|_{L^2(0,1)}$。根据柯西-施瓦茨不等式， $|(u,q)_{L^2}| \\le \\|u\\|_{L^2(0,1)}\\|q\\|_{L^2(0,1)}$，因此当 $u$ 与 $q$ 成正比时，确实达到上确界，其值为 $\\|q\\|_{L^2(0,1)}$。因此，$S_q = \\|q\\|_{Q}$。\n\n最后，我们将此结果代入 $\\beta$ 的定义中：\n$$\n\\beta = \\inf_{q\\in Q\\setminus\\{0\\}} \\frac{S_q}{\\|q\\|_Q} = \\inf_{q\\in L_0^2(0,1)\\setminus\\{0\\}} \\frac{\\|q\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}} = \\inf_{q\\in L_0^2(0,1)\\setminus\\{0\\}} 1 = 1.\n$$\ninf-sup 常数的精确值为 $1$。\n\n**备选设置分析**\n\n**情况 A: $V=H_{0}^{1}(0,1)$ 和 $Q=L^{2}(0,1)$**\n空间 $V$ 未变，因此其导数空间 $V'$ 仍然是 $L_0^2(0,1)$。空间 $Q$ 现在是完整的 $L^2(0,1)$。inf-sup 常数为\n$$\n\\beta_A = \\inf_{q\\in L^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\n固定一个任意的 $q \\in L^2(0,1) \\setminus \\{0\\}$。上确界是在 $v' = u \\in L_0^2(0,1)$ 上取值。\n任何 $q \\in L^2(0,1)$ 都可以唯一地分解为 $q = q_0 + c$，其中 $q_0 \\in L_0^2(0,1)$，$c$ 是一个常数函数。该常数是 $q$ 的均值，$c=\\int_0^1 q(x) dx$。这个分解是正交的，即 $(q_0, c)_{L^2}=0$。\n对于任何 $u \\in L_0^2(0,1)$，与 $q$ 的内积是\n$$\n(u,q)_{L^2} = (u, q_0+c)_{L^2} = (u,q_0)_{L^2} + (u,c)_{L^2}.\n$$\n第二项 $(u,c)_{L^2} = \\int_0^1 u(x)c\\,dx = c \\int_0^1 u(x)\\,dx = 0$，因为 $u \\in L_0^2(0,1)$。\n因此，$(u,q)_{L^2} = (u,q_0)_{L^2}$。上确界项是\n$$\n\\sup_{u\\in L_0^2(0,1)\\setminus\\{0\\}} \\frac{(u,q_0)_{L^2}}{\\|u\\|_{L^2(0,1)}} = \\|q_0\\|_{L^2(0,1)}.\n$$\ninf-sup 常数是此上确界与 $\\|q\\|_{L^2(0,1)}$ 之比的下确界：\n$$\n\\beta_A = \\inf_{q\\in L^2(0,1)\\setminus\\{0\\}} \\frac{\\|q_0\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}}.\n$$\n根据正交性，$\\|q\\|_{L^2(0,1)}^2 = \\|q_0\\|_{L^2(0,1)}^2 + \\|c\\|_{L^2(0,1)}^2$。我们寻求 $\\frac{\\|q_0\\|_{L^2(0,1)}}{\\sqrt{\\|q_0\\|_{L^2(0,1)}^2 + \\|c\\|_{L^2(0,1)}^2}}$ 的下确界。\n考虑一个非零常数函数 $q(x) = C \\neq 0$。对于这样的函数，其均值为 $c=C$，其零均值部分为 $q_0 = q-c = 0$。对于这个 $q$ 的选择，该比值为 $\\frac{0}{\\|C\\|_{L^2(0,1)}} = 0$。\n因此下确界为 $0$。所以 $\\beta_A=0$。常数从 $1$ 降至 $0$。这表明对于这组空间的选择，问题是病态的 (ill-posed)，因为 $Q$ 中存在（常数）函数，它们位于伴随算子的核空间中。\n\n**情况 B: $V=\\{v\\in H^{1}(0,1): v(0)=0\\}$ 和 $Q=L^{2}(0,1)$**\n在这种情况下，空间 $V$ 被扩大了，只施加了一个边界条件。空间 $Q$ 是 $L^2(0,1)$。inf-sup 常数为\n$$\n\\beta_B = \\inf_{q\\in L^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\n我们来刻画导数空间 $V' = \\{u=v' : v \\in V\\}$。\n令 $u$ 为 $L^2(0,1)$ 中的任意函数。定义 $v(x) = \\int_0^x u(t) dt$。那么 $v \\in H^1(0,1)$，几乎处处有 $v'=u$，并且 $v(0)=0$。因此 $v \\in V$。这个构造表明任何 $u \\in L^2(0,1)$ 都是 $V$ 中某个函数的导数。因此，$V'=L^2(0,1)$，这与空间 $Q$ 相同。\n对于一个固定的 $q \\in Q \\setminus \\{0\\}$，上确界是\n$$\n\\sup_{v\\in V\\setminus\\{0\\}} \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^2(0,1)}} = \\sup_{u\\in L^2(0,1)\\setminus\\{0\\}} \\frac{(u,q)_{L^2}}{\\|u\\|_{L^2(0,1)}}.\n$$\n由于 $q$ 本身就在 $L^2(0,1)$ 中，通过选择 $u=q$ 并引用柯西-施瓦茨不等式，我们发现上确界为 $\\|q\\|_{L^2(0,1)}$。\n将此代入 $\\beta_B$ 的定义中：\n$$\n\\beta_B = \\inf_{q\\in L^2(0,1)\\setminus\\{0\\}} \\frac{\\|q\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}} = 1.\n$$\n在这种情况下，inf-sup 常数的值为 $1$，这意味着它与主要设置中的值保持相同。通过放宽 $v$ 在 $x=1$ 处的边界条件，我们扩大了测试函数空间 $V$，使得其导数空间 $V'$ 成为整个 $L^2(0,1)$。这个更大的导数集合足以克服在情况 A 中看到的问题，从而得到一个稳定的公式。", "answer": "$$\n\\boxed{1}\n$$", "id": "2577764"}, {"introduction": "理论与实践之间常常存在差距。一个理论上稳定的有限元配对，如用于斯托克斯问题的泰勒-胡德(Taylor-Hood)单元，其稳定性是基于精确积分的。本练习将探讨在实际计算中不可或缺的数值积分，如何可能因积分误差而破坏离散的inf-sup条件，并指导您推导为保持稳定性所需的最低积分精度，从而深刻理解理论保证与计算实现之间的联系 [@problem_id:2577726]。", "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 上，黏度为 $\\nu>0$ 的稳态 Stokes 方程：寻找速度 $u \\in [H_{0}^{1}(\\Omega)]^{2}$ 和压力 $p \\in L_{0}^{2}(\\Omega)$，使得对所有 $v \\in [H_{0}^{1}(\\Omega)]^{2}$ 和 $q \\in L_{0}^{2}(\\Omega)$，鞍点变分问题成立，\n$$\na(u,v)+b(v,p)+b(u,q)=\\ell(v),\n$$\n其中 $a(u,v):=\\int_{\\Omega} 2\\nu\\,\\varepsilon(u):\\varepsilon(v)\\,dx$，$b(v,q):=-\\int_{\\Omega} q\\,\\nabla\\cdot v\\,dx$，以及 $\\ell(v):=\\int_{\\Omega} f\\cdot v\\,dx$，且 $\\varepsilon(u):=\\tfrac{1}{2}(\\nabla u+\\nabla u^{\\top})$。令 $\\mathcal{T}_{h}$ 为 $\\Omega$ 的一个形状正则的三角形剖分。考虑 Taylor–Hood 有限元对：对于整数 $k\\geq 1$，离散空间为 $V_{h}:=\\{v_{h}\\in [C^{0}(\\Omega)]^{2}: v_{h}|_{K}\\in [\\mathbb{P}_{k+1}(K)]^{2}\\ \\forall K\\in \\mathcal{T}_{h},\\ v_{h}|_{\\partial\\Omega}=0\\}$ 和 $Q_{h}:=\\{q_{h}\\in C^{0}(\\Omega): q_{h}|_{K}\\in \\mathbb{P}_{k}(K)\\ \\forall K\\in \\mathcal{T}_{h},\\ \\int_{\\Omega} q_{h}\\,dx=0\\}$，其中 $\\mathbb{P}_{r}(K)$ 表示在单元 $K$ 上总次数至多为 $r$ 的标量多项式。\n\n假设存在一个 Fortin 算子 $\\Pi_{F}:[H_{0}^{1}(\\Omega)]^{2}\\to V_{h}$，使得对所有 $v\\in [H_{0}^{1}(\\Omega)]^{2}$，有 $\\|\\Pi_{F} v\\|_{H^{1}(\\Omega)}\\leq C\\|v\\|_{H^{1}(\\Omega)}$，并且对所有 $q_{h}\\in Q_{h}$，\n$$\nb(\\Pi_{F}v,q_{h})=b(v,q_{h}).\n$$\n为构建离散方法，假设耦合双线性形式 $b$ 被逐单元的数值求积所替代。具体来说，对每个 $K\\in \\mathcal{T}_{h}$，令 $Q_{K}$ 为一个对 $K$ 上所有总次数至多为 $q$（求积精确度）的多项式都精确的求积格式，并定义\n$$\nb_{h}(v,q):=-\\sum_{K\\in \\mathcal{T}_{h}} Q_{K}\\big(q\\,\\nabla\\cdot v\\big).\n$$\n\n你的任务是：\n- 仅使用 Taylor–Hood 空间的多项式次数结构和求积精确度的定义，分析当 $b$ 被 $b_{h}$ 替代时，一个对 $b$ 不精确的求积如何破坏 Fortin 性质，并因此可能破坏离散 inf–sup 稳定性。\n- 推导求积精确度 $q$ 的一个充分条件（作为速度-压力多项式次数参数 $k$ 的函数），以保证对所有 $v_{h}\\in V_{h}$ 和 $q_{h}\\in Q_{h}$，\n$$\nb_{h}(v_{h},q_{h})=b(v_{h},q_{h}).\n$$\n此条件足以确保从 Fortin 算子继承的稳定性在数值求积下得以保持。\n\n作为最终答案，请以 $k$ 的闭式表达式给出最小的此类精确度 $q_{\\min}$。你的最终答案必须是单一的解析表达式，不带单位。", "solution": "Stokes 问题的混合有限元方法的稳定性取决于是否满足离散 inf-sup（或 Ladyzhenskaya-Babuška-Brezzi）条件。对于精确的双线性形式 $b$，该条件表明存在一个与网格尺寸 $h$ 无关的常数 $\\beta > 0$，使得\n$$\n\\sup_{v_{h}\\in V_{h}\\setminus\\{0\\}} \\frac{b(v_{h}, q_{h})}{\\|v_{h}\\|_{[H^{1}(\\Omega)]^{2}}} \\geq \\beta \\|q_{h}\\|_{L^{2}(\\Omega)} \\quad \\forall q_{h} \\in Q_{h}.\n$$\nFortin 算子 $\\Pi_{F}$ 的存在性是证明 Taylor-Hood 元满足此条件的标准工具。\n\n第一个任务是分析使用近似双线性形式 $b_{h}$ 会如何损害稳定性分析。带数值求积的离散系统的稳定性取决于 $b_{h}$ 的一个类似的 inf-sup 条件：\n$$\n\\sup_{v_{h}\\in V_{h}\\setminus\\{0\\}} \\frac{b_{h}(v_{h}, q_{h})}{\\|v_{h}\\|_{[H^{1}(\\Omega)]^{2}}} \\geq \\beta_{h} \\|q_{h}\\|_{L^{2}(\\Omega)} \\quad \\forall q_{h} \\in Q_{h}.\n$$\n使用 Fortin 算子证明 $b$ 的 inf-sup 条件的过程是：取任意 $q_{h} \\in Q_{h}$，并利用连续 inf-sup 条件找到一个 $v \\in [H^{1}_{0}(\\Omega)]^{2}$，使得 $b(v, q_{h}) = \\|q_{h}\\|_{L^{2}(\\Omega)}^{2}$ 且 $\\|v\\|_{[H^{1}(\\Omega)]^{2}} \\leq C \\|q_{h}\\|_{L^{2}(\\Omega)}$。然后，选择 $v_{h} = \\Pi_{F}v \\in V_{h}$。利用 Fortin 算子的性质，我们有 $b(\\Pi_{F}v, q_{h}) = b(v, q_{h}) = \\|q_{h}\\|_{L^{2}(\\Omega)}^{2}$。结合算子的稳定性 $\\|\\Pi_{F}v\\|_{[H^{1}(\\Omega)]^{2}} \\leq C_{F}\\|v\\|_{[H^{1}(\\Omega)]^{2}}$，这就确立了离散 inf-sup 条件。\n\n当 $b$ 被 $b_{h}$ 替代时，这一推理思路就不成立了。该论证的核心是恒等式 $b(\\Pi_{F}v, q_{h}) = b(v, q_{h})$。如果我们尝试对 $b_{h}$ 进行类似的论证，我们必须分析 $b_{h}(\\Pi_{F}v, q_{h})$ 这一项。一般而言，如果求积对于被积函数 $q_{h}(\\nabla \\cdot v_{h})$ 不精确，则 $b_{h}(v_{h}, q_{h}) \\neq b(v_{h}, q_{h})$。其差值为求积误差：\n$$\nb(v_{h}, q_{h}) - b_{h}(v_{h}, q_{h}) = \\sum_{K\\in\\mathcal{T}_{h}} \\left( Q_{K}(q_{h} \\nabla \\cdot v_{h}) - \\int_{K} q_{h} \\nabla \\cdot v_{h} \\,dx \\right).\n$$\n这个误差项依赖于被积函数的高阶导数，它会破坏稳定性证明。在基于 Fortin 的证明中，我们会有 $b_{h}(\\Pi_{F}v, q_{h}) = b(\\Pi_{F}v, q_{h}) - \\text{误差} = b(v, q_{h}) - \\text{误差}$。如果求积不够精确，误差项就无法被控制，我们也无法保证 $b_{h}(\\Pi_{F}v, q_{h})$ 有正下界。有可能构造一个对 $(v_h, q_h)$，使得被积函数 $q_{h}\\nabla \\cdot v_{h}$ 是一个在 $L^1$ 范数下很大，但在不够精确的求积格式的求积点上取值为零的多项式。在这种情况下，$b(v_{h}, q_{h})$ 可能很大，而 $b_{h}(v_{h}, q_{h}) = 0$，这标志着稳定性的灾难性损失。Fortin 性质本身并没有被“破坏”——它是算子 $\\Pi_F$ 对于精确形式 $b$ 的一个性质。更确切地说，它在为近似系统证明稳定性时的作用丧失了，因为关键的恒等式对于 $b_h$ 不再成立。\n\n第二个任务是找到关于求积精确度 $q$ 的一个充分条件，以确保稳定性论证得以保持。确保对 $(V_{h}, Q_{h})$ 的稳定性不被求积降低的最直接方法是，要求求积格式在用离散函数计算双线性形式 $b(\\cdot, \\cdot)$ 时是精确的。也就是说，我们寻求 $q$ 的条件，使得\n$$\nb_{h}(v_{h}, q_{h}) = b(v_{h}, q_{h}) \\quad \\forall v_{h} \\in V_{h}, \\forall q_{h} \\in Q_{h}.\n$$\n如果求积格式 $Q_{K}$ 对每个单元 $K \\in \\mathcal{T}_{h}$ 上的被积函数 $q_{h}(\\nabla \\cdot v_{h})$ 都是精确的，那么这个等式就成立。为了确定所需的精确度，我们必须找到该被积函数的最大可能多项式次数。\n\n令 $v_{h} \\in V_{h}$ 且 $q_{h} \\in Q_{h}$。在单个三角形单元 $K \\in \\mathcal{T}_{h}$ 上：\n1.  离散压力 $q_{h}|_{K}$ 是一个总次数至多为 $k$ 的多项式。因此，$q_{h}|_{K} \\in \\mathbb{P}_{k}(K)$。\n2.  离散速度 $v_{h}|_{K}$ 是一个多项式向量，其每个分量的总次数至多为 $k+1$。所以，$v_{h}|_{K} \\in [\\mathbb{P}_{k+1}(K)]^{2}$。\n3.  离散速度的散度 $\\nabla \\cdot v_{h}$ 涉及对 $v_{h}$ 的分量求一阶偏导数。一个次数为 $m$ 的多项式的导数是一个次数至多为 $m-1$ 的多项式。因此，对于 $v_{h}|_K = (v_{h,1}, v_{h,2})^T$，其中 $v_{h,1}, v_{h,2} \\in \\mathbb{P}_{k+1}(K)$，其散度为 $\\nabla \\cdot v_{h}|_{K} = \\frac{\\partial v_{h,1}}{\\partial x} + \\frac{\\partial v_{h,2}}{\\partial y}$。由于 $\\frac{\\partial v_{h,1}}{\\partial x}$ 和 $\\frac{\\partial v_{h,2}}{\\partial y}$ 都是 $\\mathbb{P}_{k}(K)$ 中的多项式，它们的和也是 $\\mathbb{P}_{k}(K)$ 中的多项式。因此，$\\nabla \\cdot v_{h}|_{K} \\in \\mathbb{P}_{k}(K)$。\n4.  被积函数是离散压力与离散速度散度的乘积：$q_{h}|_{K} (\\nabla \\cdot v_{h}|_{K})$。这是一个来自 $\\mathbb{P}_{k}(K)$ 的多项式与另一个来自 $\\mathbb{P}_{k}(K)$ 的多项式的乘积。一个次数为 $d_{1}$ 的多项式与一个次数为 $d_{2}$ 的多项式的乘积是一个次数至多为 $d_{1} + d_{2}$ 的多项式。\n5.  因此，单元 $K$ 上的被积函数 $q_{h}(\\nabla \\cdot v_{h})$ 是一个总次数至多为 $k+k = 2k$ 的多项式。\n\n为了让求积格式 $Q_{K}$ 能精确计算积分 $\\int_{K} q_{h}(\\nabla \\cdot v_{h}) \\,dx$，它必须对所有次数直至被积函数次数的多项式都精确。这得出了充分条件：\n$$\nq \\geq 2k.\n$$\n问题要求的是能够保证对所有离散函数选择都成立的最小精确度 $q_{\\min}$。当该不等式取等号时，达到这个最小值。\n\n因此，最小的充分求积精确度是 $q_{\\min} = 2k$。", "answer": "$$\n\\boxed{2k}\n$$", "id": "2577726"}, {"introduction": "在建立了一个稳定的离散格式后，我们面临的是一个大型、块结构且不定的鞍点线性系统。舒尔补(Schur complement)预条件是求解此类系统的先进策略，但其实施往往依赖于近似计算。本练习旨在量化求解器中的不精确性（例如，对主变量块使用近似逆）如何影响整体预条件效果，通过推导预条件后系统的条件数上界，在代数近似误差和迭代收敛速度之间建立起关键的定量联系 [@problem_id:2577727]。", "problem": "考虑一个由约束问题的有限元离散化产生的混合鞍点系统，其分块矩阵为\n$$\n\\begin{pmatrix}\nA  & B^{\\top} \\\\\nB  & 0\n\\end{pmatrix},\n$$\n其中 $A \\in \\mathbb{R}^{n \\times n}$ 在主空间上是对称正定（SPD）的，且 $B \\in \\mathbb{R}^{m \\times n}$。在拉格朗日乘子空间上的舒尔补为\n$$\nS \\coloneqq B A^{-1} B^{\\top} \\in \\mathbb{R}^{m \\times m},\n$$\n它在乘子空间上是SPD的。在实践中，舒尔补预处理将精确逆 $A^{-1}$ 替换为不精确逆 $\\tilde{A}^{-1}$，并可能通过一个谱等价算子进一步近似所得到的舒尔补。假设对于某些参数 $\\delta_{A} \\in [0,1)$ 和 $\\varepsilon_{S} \\in [0,1)$，以下两个乘性近似性质成立：\n- $A$ 的不精确逆：\n$$\n(1 - \\delta_{A})\\, v^{\\top} A^{-1} v \\le v^{\\top} \\tilde{A}^{-1} v \\le (1 + \\delta_{A})\\, v^{\\top} A^{-1} v \\quad \\text{对于所有 } v \\in \\mathbb{R}^{n}.\n$$\n- 实用舒尔预处理器 $\\widehat{S}$ 与不精确舒尔补 $\\tilde{S} \\coloneqq B \\tilde{A}^{-1} B^{\\top}$ 的谱等价性：\n$$\n(1 - \\varepsilon_{S})\\, q^{\\top} \\tilde{S} q \\le q^{\\top} \\widehat{S} q \\le (1 + \\varepsilon_{S})\\, q^{\\top} \\tilde{S} q \\quad \\text{对于所有 } q \\in \\mathbb{R}^{m}.\n$$\n仅使用以上定义、SPD矩阵的 Löwner 偏序以及SPD矩阵束特征值的瑞利商刻画，推导预处理算子 $\\widehat{S}^{-1} S$ 特征值的双边界，然后推断其谱条件数的最佳乘性上界。仅需报告谱条件数上界的最终闭式表达式，该表达式是关于 $\\delta_{A}$ 和 $\\varepsilon_{S}$ 的函数。不要报告任何不等式。无需四舍五入，也不涉及物理单位。", "solution": "我们从给定的定义和性质开始。由于 $A$ 是对称正定（SPD）的，舒尔补 $S \\coloneqq B A^{-1} B^{\\top}$ 在乘子空间上是SPD的。不精确逆 $\\tilde{A}^{-1}$ 满足\n$$\n(1 - \\delta_{A})\\, v^{\\top} A^{-1} v \\le v^{\\top} \\tilde{A}^{-1} v \\le (1 + \\delta_{A})\\, v^{\\top} A^{-1} v \\quad \\text{对于所有 } v \\in \\mathbb{R}^{n}.\n$$\n在SPD矩阵的 Löwner 偏序中，这等价于\n$$\n(1 - \\delta_{A})\\, A^{-1} \\preceq \\tilde{A}^{-1} \\preceq (1 + \\delta_{A})\\, A^{-1}.\n$$\n用 $B$ 左乘和用 $B^{\\top}$ 右乘保持 Löwner 序，因此\n$$\n(1 - \\delta_{A})\\, S \\preceq \\tilde{S} \\coloneqq B \\tilde{A}^{-1} B^{\\top} \\preceq (1 + \\delta_{A})\\, S.\n$$\n接下来，实用舒尔预处理器 $\\widehat{S}$ 与 $\\tilde{S}$ 谱等价，参数为 $\\varepsilon_{S}$：\n$$\n(1 - \\varepsilon_{S})\\, \\tilde{S} \\preceq \\widehat{S} \\preceq (1 + \\varepsilon_{S})\\, \\tilde{S}.\n$$\n结合这两个不等式链，可以得到 $\\widehat{S}$ 和 $S$ 之间的直接比较：\n$$\n(1 - \\varepsilon_{S})(1 - \\delta_{A})\\, S \\preceq \\widehat{S} \\preceq (1 + \\varepsilon_{S})(1 + \\delta_{A})\\, S.\n$$\n为了将这些 Löwner 界转化为预处理算子 $\\widehat{S}^{-1} S$ 的谱界，考虑对于任意非零 $q \\in \\mathbb{R}^{m}$ 其瑞利商：\n$$\nR(q) \\coloneqq \\frac{q^{\\top} S q}{q^{\\top} \\widehat{S} q}.\n$$\n前面的 Löwner 界意味着\n$$\nq^{\\top} \\widehat{S} q \\le (1 + \\varepsilon_{S})(1 + \\delta_{A})\\, q^{\\top} S q\n\\quad \\Rightarrow \\quad\nR(q) \\ge \\frac{1}{(1 + \\varepsilon_{S})(1 + \\delta_{A})},\n$$\n以及\n$$\nq^{\\top} \\widehat{S} q \\ge (1 - \\varepsilon_{S})(1 - \\delta_{A})\\, q^{\\top} S q\n\\quad \\Rightarrow \\quad\nR(q) \\le \\frac{1}{(1 - \\varepsilon_{S})(1 - \\delta_{A})}.\n$$\n因此，$\\widehat{S}^{-1} S$ 的所有特征值都位于区间\n$$\n\\left[\\frac{1}{(1 + \\varepsilon_{S})(1 + \\delta_{A})}, \\, \\frac{1}{(1 - \\varepsilon_{S})(1 - \\delta_{A})}\\right].\n$$\n$\\widehat{S}^{-1} S$ 的谱条件数是最大特征值与最小特征值之比。使用上述界限可得出乘性上界\n$$\n\\kappa(\\widehat{S}^{-1} S) \\le \\frac{\\frac{1}{(1 - \\varepsilon_{S})(1 - \\delta_{A})}}{\\frac{1}{(1 + \\varepsilon_{S})(1 + \\delta_{A})}}\n= \\frac{(1 + \\varepsilon_{S})(1 + \\delta_{A})}{(1 - \\varepsilon_{S})(1 - \\delta_{A})}.\n$$\n此表达式仅取决于近似误差 $\\delta_{A}$ 和 $\\varepsilon_{S}$，并且是所求的上界。", "answer": "$$\\boxed{\\frac{(1+\\varepsilon_{S})(1+\\delta_{A})}{(1-\\varepsilon_{S})(1-\\delta_{A})}}$$", "id": "2577727"}]}