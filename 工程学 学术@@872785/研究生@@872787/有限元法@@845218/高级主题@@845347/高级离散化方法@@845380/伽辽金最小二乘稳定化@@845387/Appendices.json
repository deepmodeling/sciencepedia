{"hands_on_practices": [{"introduction": "任何有限元方法的基础都是在单元层面构建系统矩阵。第一个实践将指导你针对一个典型的一维对流扩散问题 [@problem_id:2561151]，推导关键的伽辽金最小二乘（GLS）稳定化矩阵 $K^{(e)}_{\\text{GLS}}$。通过这个计算，你将具体理解稳定项是如何修正标准伽辽金系统的，并发现使用线性元时出现的一个重要特性。", "problem": "考虑区间 $(0,1)$ 上的一维稳态平流-扩散模型问题，\n$$- \\kappa \\, u''(x) + \\beta \\, u'(x) = f(x), \\quad x \\in (0,1),$$\n其齐次狄利克雷边界条件为 $u(0)=0$ 和 $u(1)=0$，其中 $\\kappa0$ 和 $\\beta \\in \\mathbb{R}$ 是常数。令 $V_h$ 表示协调的分片线性有限元空间，该空间从属于区间 $(0,1)$ 的一个划份，此划份由不重叠的开单元 $\\{K_e\\}$ 组成，其节点位于端点，网格尺寸为 $h_e = \\operatorname{meas}(K_e)$。使用加权残差陈述和伽辽金法的标准变分格式，通过在每个单元 $K_e$ 上添加一个形为\n$$\\tau_e \\, \\big( \\mathcal{L} u_h, \\mathcal{L} v_h \\big)_{K_e},$$\n的稳定化项，推导伽辽金/最小二乘 (GLS) 稳定化弱形式，其中 $\\mathcal{L} := -\\kappa \\tfrac{d^2}{dx^2} + \\beta \\tfrac{d}{dx}$ 且 $\\tau_e0$ 是一个单元稳定化参数。清晰地陈述所得的稳定化弱问题。\n\n然后，在一个具有 $\\varphi_1(x_a)=1$, $\\varphi_1(x_b)=0$, $\\varphi_2(x_a)=0$, $\\varphi_2(x_b)=1$ 的一般单元 $K_e=[x_a,x_b]$ 上，使用 $V_h$ 的局部节点基 $\\{\\varphi_1,\\varphi_2\\}$，计算 $2 \\times 2$ 单元级 GLS 稳定化矩阵 $\\mathbf{K}^{(e)}_{\\text{GLS}}$，其元素为\n$$\\big(\\mathbf{K}^{(e)}_{\\text{GLS}}\\big)_{ij} \\;=\\; \\tau_e \\int_{K_e} \\big(\\mathcal{L}\\varphi_j\\big)\\,\\big(\\mathcal{L}\\varphi_i\\big)\\,dx, \\quad i,j \\in \\{1,2\\},$$\n用 $\\beta$、$\\kappa$、$\\tau_e$ 和 $h_e$ 以闭合形式表示。\n\n你的最终答案必须是单元级 GLS 稳定化矩阵的单一闭合形式解析表达式。不要简化为数值。不要包含单位。在最终答案区域中不要提供任何中间步骤。", "solution": "问题分为两部分。首先，我们推导稳定化弱格式。其次，我们计算单元级稳定化矩阵。\n\n**第 1 部分：伽辽金/最小二乘 (GLS) 弱形式的推导**\n\n控制微分方程是一维稳态平流-扩散方程：\n$$ - \\kappa \\, u''(x) + \\beta \\, u'(x) = f(x), \\quad x \\in (0,1) $$\n其齐次狄利克雷边界条件为 $u(0)=0$ 和 $u(1)=0$。微分算子为 $\\mathcal{L}u = -\\kappa u'' + \\beta u'$。\n\n标准伽辽金法从加权残差陈述开始。我们在有限维空间 $V_h$ 中寻求一个近似解 $u_h$，使得对于所有测试函数 $v_h \\in V_h$：\n$$ \\int_0^1 ( - \\kappa u_h''(x) + \\beta u_h'(x) - f(x) ) \\, v_h(x) \\, dx = 0 $$\n对二阶导数项应用分部积分得到：\n$$ \\int_0^1 \\kappa u_h'(x) v_h'(x) \\, dx - [\\kappa u_h'(x) v_h(x)]_0^1 + \\int_0^1 \\beta u_h'(x) v_h(x) \\, dx = \\int_0^1 f(x) v_h(x) \\, dx $$\n测试函数 $v_h$ 需要与试验解属于同一空间，并满足本质边界条件的齐次形式。因此，对于我们的问题，$v_h(0)=0$ 且 $v_h(1)=0$，这使得边界项 $[\\kappa u_h'(x) v_h(x)]_0^1$ 消失。标准的伽辽金弱形式即为：求 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$，\n$$ \\int_0^1 \\left( \\kappa u_h'(x) v_h'(x) + \\beta u_h'(x) v_h(x) \\right) dx = \\int_0^1 f(x) v_h(x) \\, dx $$\n这可以紧凑地写作 $B(u_h, v_h) = L(v_h)$。\n\n伽辽金/最小二乘 (GLS) 方法在标准格式的基础上增加了一个稳定化项。根据指定，要添加的项是网格中所有单元 $K_e$ 的总和：\n$$ \\sum_{e} \\tau_e \\, ( \\mathcal{L} u_h, \\mathcal{L} v_h )_{K_e} = \\sum_{e} \\tau_e \\int_{K_e} (\\mathcal{L}u_h) \\, (\\mathcal{L}v_h) \\, dx $$\n其中 $\\mathcal{L}u_h = -\\kappa u_h'' + \\beta u_h'$。将此项加到标准伽辽金形式的左侧，得到稳定化弱问题：求 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$，\n$$ \\int_0^1 \\left( \\kappa u_h'(x) v_h'(x) + \\beta u_h'(x) v_h(x) \\right) dx + \\sum_{e} \\tau_e \\int_{K_e} \\big(-\\kappa u_h'' + \\beta u_h'\\big) \\big(-\\kappa v_h'' + \\beta v_h'\\big) \\, dx = \\int_0^1 f(x) v_h(x) \\, dx $$\n这就完成了问题的第一部分。\n\n**第 2 部分：单元级 GLS 稳定化矩阵的计算**\n\n我们要为一个长度为 $h_e = x_b - x_a$ 的一般单元 $K_e = [x_a, x_b]$ 计算 $2 \\times 2$ 的单元级稳定化矩阵 $\\mathbf{K}^{(e)}_{\\text{GLS}}$。其元素由下式给出：\n$$ \\big(\\mathbf{K}^{(e)}_{\\text{GLS}}\\big)_{ij} = \\tau_e \\int_{K_e} \\big(\\mathcal{L}\\varphi_j\\big) \\, \\big(\\mathcal{L}\\varphi_i\\big) \\, dx, \\quad i,j \\in \\{1,2\\} $$\n空间 $V_h$ 由连续分片线性函数组成。在单元 $K_e$ 上，局部基函数 $\\{\\varphi_1, \\varphi_2\\}$ 是由其节点值定义的线性多项式：\n$$ \\varphi_1(x_a)=1, \\quad \\varphi_1(x_b)=0 $$\n$$ \\varphi_2(x_a)=0, \\quad \\varphi_2(x_b)=1 $$\n具体来说，在 $K_e$ 上，这些函数是：\n$$ \\varphi_1(x) = \\frac{x_b - x}{x_b - x_a} = \\frac{x_b - x}{h_e} $$\n$$ \\varphi_2(x) = \\frac{x - x_a}{x_b - x_a} = \\frac{x - x_a}{h_e} $$\n我们计算它们关于 $x$ 的一阶和二阶导数：\n$$ \\varphi_1'(x) = -\\frac{1}{h_e}, \\quad \\varphi_1''(x) = 0 $$\n$$ \\varphi_2'(x) = \\frac{1}{h_e}, \\quad \\varphi_2''(x) = 0 $$\n现在，我们将算子 $\\mathcal{L} = -\\kappa \\frac{d^2}{dx^2} + \\beta \\frac{d}{dx}$ 应用于每个基函数。由于基函数是线性的，它们在单元 $K_e$ *内部*的二阶导数为零。\n$$ \\mathcal{L}\\varphi_1 = -\\kappa \\varphi_1'' + \\beta \\varphi_1' = -\\kappa(0) + \\beta \\left(-\\frac{1}{h_e}\\right) = -\\frac{\\beta}{h_e} $$\n$$ \\mathcal{L}\\varphi_2 = -\\kappa \\varphi_2'' + \\beta \\varphi_2' = -\\kappa(0) + \\beta \\left(\\frac{1}{h_e}\\right) = \\frac{\\beta}{h_e} $$\n一个关键的观察是，对于分片线性单元，当算子的扩散部分 $-\\kappa \\frac{d^2}{dx^2}$ 应用于单元内部的基函数时，其结果为零。因此，得到的稳定化矩阵将与扩散系数 $\\kappa$ 无关。\n\n项 $\\mathcal{L}\\varphi_1$ 和 $\\mathcal{L}\\varphi_2$ 在单元 $K_e$ 上是常数。我们现在可以计算矩阵 $\\mathbf{K}^{(e)}_{\\text{GLS}}$ 的元素。\n\n对于 $(i,j)=(1,1)$：\n$$ \\big(\\mathbf{K}^{(e)}_{\\text{GLS}}\\big)_{11} = \\tau_e \\int_{x_a}^{x_b} (\\mathcal{L}\\varphi_1)(\\mathcal{L}\\varphi_1) \\, dx = \\tau_e \\int_{x_a}^{x_b} \\left(-\\frac{\\beta}{h_e}\\right) \\left(-\\frac{\\beta}{h_e}\\right) dx = \\tau_e \\frac{\\beta^2}{h_e^2} \\int_{x_a}^{x_b} dx = \\tau_e \\frac{\\beta^2}{h_e^2} (h_e) = \\frac{\\tau_e \\beta^2}{h_e} $$\n对于 $(i,j)=(1,2)$：\n$$ \\big(\\mathbf{K}^{(e)}_{\\text{GLS}}\\big)_{12} = \\tau_e \\int_{x_a}^{x_b} (\\mathcal{L}\\varphi_2)(\\mathcal{L}\\varphi_1) \\, dx = \\tau_e \\int_{x_a}^{x_b} \\left(\\frac{\\beta}{h_e}\\right) \\left(-\\frac{\\beta}{h_e}\\right) dx = -\\tau_e \\frac{\\beta^2}{h_e^2} \\int_{x_a}^{x_b} dx = -\\frac{\\tau_e \\beta^2}{h_e} $$\n对于 $(i,j)=(2,1)$：\n$$ \\big(\\mathbf{K}^{(e)}_{\\text{GLS}}\\big)_{21} = \\tau_e \\int_{x_a}^{x_b} (\\mathcal{L}\\varphi_1)(\\mathcal{L}\\varphi_2) \\, dx = \\tau_e \\int_{x_a}^{x_b} \\left(-\\frac{\\beta}{h_e}\\right) \\left(\\frac{\\beta}{h_e}\\right) dx = -\\tau_e \\frac{\\beta^2}{h_e^2} \\int_{x_a}^{x_b} dx = -\\frac{\\tau_e \\beta^2}{h_e} $$\n对于 $(i,j)=(2,2)$：\n$$ \\big(\\mathbf{K}^{(e)}_{\\text{GLS}}\\big)_{22} = \\tau_e \\int_{x_a}^{x_b} (\\mathcal{L}\\varphi_2)(\\mathcal{L}\\varphi_2) \\, dx = \\tau_e \\int_{x_a}^{x_b} \\left(\\frac{\\beta}{h_e}\\right) \\left(\\frac{\\beta}{h_e}\\right) dx = \\tau_e \\frac{\\beta^2}{h_e^2} \\int_{x_a}^{x_b} dx = \\frac{\\tau_e \\beta^2}{h_e} $$\n将这些元素组装成矩阵形式，我们得到单元级 GLS 稳定化矩阵：\n$$ \\mathbf{K}^{(e)}_{\\text{GLS}} = \\begin{pmatrix} \\frac{\\tau_e \\beta^2}{h_e}  -\\frac{\\tau_e \\beta^2}{h_e} \\\\ -\\frac{\\tau_e \\beta^2}{h_e}  \\frac{\\tau_e \\beta^2}{h_e} \\end{pmatrix} = \\frac{\\tau_e \\beta^2}{h_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n这就是所要求的闭合形式表达式。", "answer": "$$\n\\boxed{\\frac{\\tau_e \\beta^2}{h_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}}\n$$", "id": "2561151"}, {"introduction": "尽管GLS方法增加了稳定项，一个关键问题仍然存在：到底需要多大的稳定化程度？本练习 [@problem_id:2561128] 将通过探索离散极值原理来深入探讨稳定性的理论基础，该原理能够防止数值解中出现非物理震荡。你将推导出保证系统单调性所需的最小稳定化参数 $\\tau_{\\min}$，从而为“需要多大稳定化”这一问题提供一个严格的解答。", "problem": "考虑在区间 $[0,L]$ 上的稳态一维 ($1$D) 对流扩散边值问题，其狄利克雷(Dirichlet)边界条件为\n$$\n- \\nu\\, u''(x) + a\\, u'(x) = f(x), \\quad x \\in (0,L), \\qquad u(0)=\\alpha,\\quad u(L)=\\beta,\n$$\n其中 $a0$ 是恒定对流速度，$\\nu \\ge 0$ 是恒定扩散系数，并且 $f$ 足够光滑。使用有限元法，在包含 $N$ 个单元且单元尺寸为 $h=L/N$ 的均匀网格上，采用连续分片线性基函数来离散化该问题。使用Galerkin/最小二乘 (GLS) 方法对离散化进行稳定，该方法在标准Galerkin弱形式的基础上，为每个单元增加一个由常数稳定化参数 $\\tau$ 加权的强残数的单元最小二乘项。\n\n从该算子的标准Galerkin弱形式和Galerkin/最小二乘 (GLS) 稳定化的基本定义出发，并仅利用均匀网格上线性形函数的性质，对一个内部节点 $i$ 执行以下步骤：\n$1.$ 推导GLS稳定化离散方程的组装三点格式（即乘以 $u_{i-1}$、$u_{i}$ 和 $u_{i+1}$ 的系数）。\n$2.$ 利用三点格式的单调矩阵的特性，确定 $\\tau$ 所需满足的条件，以保证内部节点方程中的所有非对角线元均为非正，从而确保内部满足离散极值原理。\n$3.$ 由此，以 $a$、$\\nu$ 和 $h$ 的形式，确定最小稳定化参数 $\\tau_{\\min}$（作为一个单一的解析表达式），使得GLS稳定化后的矩阵对所有内部节点在内部都是单调的。\n\n请以 $a$、$\\nu$ 和 $h$ 的闭式表达式形式给出最终答案 $\\tau_{\\min}$。不要提供不等式；提供一个单一的解析表达式。如果您的表达式包含任何常数，请明确写出。无需进行数值四舍五入。", "solution": "问题的弱形式是通过将偏微分方程乘以一个来自合适空间的检验函数 $v(x)$，并在定义域 $\\Omega = (0, L)$ 上积分得到的。\n$$\n\\int_0^L (- \\nu\\, u'' + a\\, u') v \\, dx = \\int_0^L f v \\, dx\n$$\n将二阶项分部积分，我们得到标准伽辽金弱形式：寻找 $u \\in H^1(0,L)$，满足 $u(0)=\\alpha, u(L)=\\beta$，使得对于所有 $v \\in H_0^1(0,L)$，\n$$\nB_{\\text{std}}(u,v) \\equiv \\int_0^L (\\nu u' v' + a u' v) \\, dx = \\int_0^L f v \\, dx \\equiv L(v)\n$$\n有限元法在满足边界条件的分片线性函数构成的有限维空间 $S_h$ 中寻找近似解 $u_h$。检验函数 $v_h$ 取自具有齐次边界条件的相应空间 $V_h$。\n\n伽辽金/最小二乘 (GLS) 方法在标准弱形式上增加一个稳定化项。问题将其规定为“强残数的单元最小二乘项”。对于函数 $w$，强残数为 $R(w) = - \\nu w'' + a w' - f$。对于一个连续分片线性函数 $w_h$，其二阶导数 $w_h''$ 在每个单元内部为零。因此，在单元 $K_e$ 上的残数为 $R(w_h)|_{K_e} = a w_h' - f$。标准的 GLS (或 SUPG) 格式在左端项增加 $\\sum_{e} \\int_{K_e} \\tau (a u_h') (a v_h') \\, dx$，在右端项增加 $\\sum_{e} \\int_{K_e} \\tau f (a v_h') \\,dx$。GLS稳定化的弱形式为：寻找 $u_h \\in S_h$，使得对于所有 $v_h \\in V_h$，\n$$\nB_{\\text{GLS}}(u_h,v_h) = L_{\\text{GLS}}(v_h)\n$$\n其中\n$$\nB_{\\text{GLS}}(u_h,v_h) = \\int_0^L (\\nu u_h' v_h' + a u_h' v_h) \\, dx + \\sum_{e=1}^N \\tau \\int_{K_e} a^2 u_h' v_h' \\, dx\n$$\n而右端项对于求解格式系数不是必需的。\n\n**1. 推导三点格式**\n\n我们考虑位于 $x_i = i h$ 的一个内部节点 $i$。该节点的离散方程通过选择检验函数 $v_h(x) = \\phi_i(x)$ 得到，其中 $\\phi_i(x)$ 是以 $x_i$ 为中心的标准线性“帽状”基函数。$\\phi_i(x)$ 的支集是区间 $[x_{i-1}, x_{i+1}]$，它包含两个单元，$K_{i-1}=[x_{i-1}, x_i]$ 和 $K_i=[x_i, x_{i+1}]$。\n在这些单元上的基函数及其导数为：\n- 在 $K_{i-1}$ 上：$\\phi_{i-1}(x) = \\frac{x_i - x}{h}$，$\\phi_i(x) = \\frac{x - x_{i-1}}{h}$。导数为 $\\phi'_{i-1}(x) = -\\frac{1}{h}$，$\\phi'_i(x) = \\frac{1}{h}$。\n- 在 $K_i$ 上：$\\phi_i(x) = \\frac{x_{i+1} - x}{h}$，$\\phi_{i+1}(x) = \\frac{x - x_i}{h}$。导数为 $\\phi'_i(x) = -\\frac{1}{h}$，$\\phi'_{i+1}(x) = \\frac{1}{h}$。\n\n在 $\\phi_i(x)$ 的支集上，试探函数 $u_h(x)$ 为 $u_h(x) = u_{i-1}\\phi_{i-1}(x) + u_i\\phi_i(x) + u_{i+1}\\phi_{i+1}(x)$。其在每个单元上的导数为常数：\n- 在 $K_{i-1}$ 上：$u_h'(x) = \\frac{u_i - u_{i-1}}{h}$。\n- 在 $K_i$ 上：$u_h'(x) = \\frac{u_{i+1} - u_i}{h}$。\n\n我们通过计算 $B_{\\text{GLS}}(u_h, \\phi_i)$ 来组装节点 $i$ 的方程。\n扩散项的贡献为：\n$$\n\\int_0^L \\nu u_h' \\phi_i' \\, dx = \\int_{x_{i-1}}^{x_i} \\nu \\left(\\frac{u_i - u_{i-1}}{h}\\right) \\left(\\frac{1}{h}\\right) dx + \\int_{x_i}^{x_{i+1}} \\nu \\left(\\frac{u_{i+1} - u_i}{h}\\right) \\left(-\\frac{1}{h}\\right) dx\n= \\frac{\\nu}{h}(u_i - u_{i-1}) - \\frac{\\nu}{h}(u_{i+1} - u_i) = \\frac{\\nu}{h}(-u_{i-1} + 2u_i - u_{i+1})\n$$\n对流项的贡献为：\n$$\n\\int_0^L a u_h' \\phi_i \\, dx = \\int_{x_{i-1}}^{x_i} a \\left(\\frac{u_i - u_{i-1}}{h}\\right) \\left(\\frac{x - x_{i-1}}{h}\\right) dx + \\int_{x_i}^{x_{i+1}} a \\left(\\frac{u_{i+1} - u_i}{h}\\right) \\left(\\frac{x_{i+1} - x}{h}\\right) dx\n$$\n积分计算结果为 $\\int_0^h \\xi d\\xi = h^2/2$ 和 $\\int_0^h (h-\\xi)d\\xi = h^2/2$。\n$$\n= a\\left(\\frac{u_i - u_{i-1}}{h^2}\\right)\\frac{h^2}{2} + a\\left(\\frac{u_{i+1} - u_i}{h^2}\\right)\\frac{h^2}{2} = \\frac{a}{2}(u_i - u_{i-1}) + \\frac{a}{2}(u_{i+1} - u_i) = \\frac{a}{2}(-u_{i-1} + u_{i+1})\n$$\n稳定化项的贡献为：\n$$\n\\sum_e \\tau \\int_{K_e} a^2 u_h' \\phi_i' \\, dx = \\tau a^2 \\int_{x_{i-1}}^{x_i} \\left(\\frac{u_i - u_{i-1}}{h}\\right) \\left(\\frac{1}{h}\\right) dx + \\tau a^2 \\int_{x_i}^{x_{i+1}} \\left(\\frac{u_{i+1} - u_i}{h}\\right) \\left(-\\frac{1}{h}\\right) dx\n= \\frac{\\tau a^2}{h}(u_i - u_{i-1}) - \\frac{\\tau a^2}{h}(u_{i+1} - u_i) = \\frac{\\tau a^2}{h}(-u_{i-1} + 2u_i - u_{i+1})\n$$\n合并所有项，我们得到乘以 $(u_{i-1}, u_i, u_{i+1})$ 的三点格式的系数：\n- $u_{i-1}$ 的系数：$-\\frac{\\nu}{h} - \\frac{a}{2} - \\frac{\\tau a^2}{h}$\n- $u_i$ 的系数：$\\frac{2\\nu}{h} + \\frac{2\\tau a^2}{h}$\n- $u_{i+1}$ 的系数：$-\\frac{\\nu}{h} + \\frac{a}{2} - \\frac{\\tau a^2}{h}$\n\n**2. 矩阵单调性对 $\\tau$ 的条件**\n\n一个三对角矩阵如果其对角元为正且非对角元为非正，则被认为是单调的（具体来说，是M-矩阵），这意味着满足离散极值原理。\n- **对角元**：$u_i$ 的系数是 $\\frac{2}{h}(\\nu + \\tau a^2)$。由于 $\\nu \\ge 0$，$a0$，$h0$，且稳定化要求 $\\tau \\ge 0$，该项总是非负的。除非 $\\nu=0$ 且 $\\tau=0$（我们忽略这种情况），否则它是严格为正的。\n- **非对角元**：\n  $u_{i-1}$ 的系数必须为非正：\n  $$\n  -\\frac{\\nu}{h} - \\frac{a}{2} - \\frac{\\tau a^2}{h} \\le 0 \\implies \\frac{\\nu}{h} + \\frac{a}{2} + \\frac{\\tau a^2}{h} \\ge 0\n  $$\n  对于 $\\nu \\ge 0, a  0, h  0, \\tau \\ge 0$，此条件恒成立。\n  $u_{i+1}$ 的系数必须为非正：\n  $$\n  -\\frac{\\nu}{h} + \\frac{a}{2} - \\frac{\\tau a^2}{h} \\le 0\n  $$\n  这是约束 $\\tau$ 的关键条件。重排该不等式：\n  $$\n  \\frac{a}{2} \\le \\frac{\\nu}{h} + \\frac{\\tau a^2}{h}\n  $$\n  两边乘以 $h$ 并求解 $\\tau$：\n  $$\n  \\frac{ah}{2} \\le \\nu + \\tau a^2 \\implies \\tau a^2 \\ge \\frac{ah}{2} - \\nu \\implies \\tau \\ge \\frac{h}{2a} - \\frac{\\nu}{a^2}\n  $$\n  由于稳定化参数 $\\tau$ 必须为非负，我们必须将其与条件 $\\tau \\ge 0$ 结合起来。\n  因此，为确保所有非对角元均为非正，$\\tau$ 需满足的条件是：\n  $$\n  \\tau \\ge \\max\\left(0, \\frac{h}{2a} - \\frac{\\nu}{a^2}\\right)\n  $$\n\n**3. 最小稳定化参数 $\\tau_{\\min}$**\n\n问题要求找到能保证所有内部节点的矩阵单调性的最小稳定化参数 $\\tau_{\\min}$。这对应于选择满足上一步推导出的条件的最小可能 $\\tau$ 值。通过取不等式的下界作为 $\\tau_{\\min}$ 的值来实现这一点。\n\n因此，最小稳定化参数由以下单一解析表达式给出：\n$$\n\\tau_{\\min} = \\max\\left(0, \\frac{h}{2a} - \\frac{\\nu}{a^2}\\right)\n$$\n这个值确保了如果标准伽辽金方法已经是单调的（这发生在 $\\frac{h}{2a} - \\frac{\\nu}{a^2} \\le 0$ 时，即单元Péclet数 $Pe_h = \\frac{ah}{2\\nu} \\le 1$），则不添加稳定化项（$\\tau_{\\min} = 0$）。如果标准伽辽金方法不是单调的（$Pe_h  1$），$\\tau_{\\min}$ 是恢复系统矩阵单调性所需的最小正值。", "answer": "$$\\boxed{\\max\\left(0, \\frac{h}{2a} - \\frac{\\nu}{a^2}\\right)}$$", "id": "2561128"}, {"introduction": "理论和单元层面的计算只有在代码中实现时才真正焕发生机。这最后一个实践 [@problem_id:2561145] 是一项综合性的编程练习，你将使用“人造解”方法为一个对流-扩散-反应问题构建一个完整的GLS求解器。你将实现完整的稳定化公式，求解线性系统，并进行 $L^2$ 和 $H^1$ 误差分析——这些都是验证数值方法和评估其精度的核心技能。", "problem": "考虑单位区间上的一维稳态对流-扩散-反应边值问题：\n求函数 $u : [0,1] \\to \\mathbb{R}$，使得\n$$\n-\\varepsilon\\,u''(x) + \\beta\\,u'(x) + c\\,u(x) = f(x)\\quad \\text{for } x\\in(0,1), \\qquad u(0)=0,\\; u(1)=0,\n$$\n其中 $\\varepsilon  0$，$\\beta \\in \\mathbb{R}$ 和 $c \\ge 0$ 是给定系数。使用制造解方法，取精确解为 $u(x)=\\sin(\\pi x)$，并确定使 $u(x)$ 满足带给定系数的微分方程的源项 $f(x)$。在包含 $N$ 个单元、网格尺寸为 $h=1/N$ 的均匀网格上，采用连续分片线性有限元空间，并推导此问题的稳定化伽辽金/最小二乘 (GLS) 格式。\n\n从该边值问题的弱形式和最小二乘稳定化原理的基本定义出发，进行以下推导：\n1) 写出对应于标准伽辽金方法的弱（变分）格式：求 $u \\in H_0^1(0,1)$，使得对所有 $v \\in H_0^1(0,1)$，\n$$\na(u,v) = \\ell(v),\n$$\n其中 $a(\\cdot,\\cdot)$ 和 $\\ell(\\cdot)$ 分别是对应于微分算子 $-\\varepsilon \\,\\frac{d^2}{dx^2} + \\beta \\,\\frac{d}{dx} + c$ 和源项 $f$ 的双线性形式和线性形式。\n2) 推导伽辽金/最小二乘稳定化格式：将算子强残差的最小二乘项加到等式两边，即：\n$$\na_{\\text{GLS}}(u,v) = \\ell_{\\text{GLS}}(v),\n$$\n其中\n$$\na_{\\text{GLS}}(u,v) := a(u,v) + \\sum_{K}\\tau_K \\int_{K} \\left( -\\varepsilon\\,u'' + \\beta\\,u' + c\\,u \\right)\\,\\left( -\\varepsilon\\,v'' + \\beta\\,v' + c\\,v \\right)\\,dx,\n$$\n$$\n\\ell_{\\text{GLS}}(v) := \\ell(v) + \\sum_{K}\\tau_K \\int_{K} f(x)\\,\\left( -\\varepsilon\\,v'' + \\beta\\,v' + c\\,v \\right)\\,dx,\n$$\n其中求和遍历所有网格单元 $K$，$\\tau_K$ 是一个取决于 $h$ 和系数的正稳定化参数。\n3) 将上述格式具体化到连续分片线性单元。仅使用这些基函数的基本性质来论证，在每个单元 $K$ 内部，离散试探函数和检验函数的二阶导数都为零，因此 GLS 项可以简化为只包含一阶导数和函数值的表达式。推导组装所需的、由此产生的单元级代数贡献项。\n4) 定义形式如下的逐单元稳定化参数\n$$\n\\tau_K = \\tau_0 \\,\\frac{h_K}{2\\,|\\beta|},\n$$\n对于 $|\\beta|  0$，其中 $\\tau_0 \\ge 0$ 是一个无量纲调节参数，$h_K$ 是单元尺寸。说明如何处理 $|\\beta|=0$ 的退化情况。\n\n实现一个程序，该程序为节点值的离散未知向量组装稳定化的线性系统，施加齐次狄利克雷边界条件，求解所得线性系统，并计算数值解相对于 $u(x)=\\sin(\\pi x)$ 的 $L^2$ 和 $H^1$ 范数误差：\n- $L^2$ 误差为 $\\|u - u_h\\|_{L^2(0,1)} := \\left( \\int_0^1 (u-u_h)^2 \\, dx\\right)^{1/2}$，\n- $H^1$ 误差为 $\\|u - u_h\\|_{H^1(0,1)} := \\left( \\|u-u_h\\|_{L^2(0,1)}^2 + \\|u' - u_h'\\|_{L^2(0,1)}^2 \\right)^{1/2}$。\n组装和误差评估所需的所有积分都必须通过每个单元至少四个高斯点的高斯求积法进行数值计算。\n\n在整个过程中使用以下固定系数：$\\varepsilon = 10^{-3}$，$\\beta = 2$，$c = 0$。对于制造解 $u(x)=\\sin(\\pi x)$，使用精确算术计算相应的源项 $f(x)$，并在组装中使用该源项。\n\n测试套件：\n评估以下九种情况的误差，其中 $N$ 是均匀单元的数量，$\\tau_0$ 是上述 $\\tau_K$ 定义中使用的无量纲稳定化参数：\n- $(N,\\tau_0) \\in \\{(20,0.0),(20,0.5),(20,1.0),(40,0.0),(40,0.5),(40,1.0),(80,0.0),(80,0.5),(80,1.0)\\}$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个含九个条目的列表，每个条目按上面列出的顺序对应一个测试用例。每个条目本身必须是一个形式为 $[N,\\tau_0,L2\\_error,H1\\_error]$ 的四元素列表，其中 $L2\\_error$ 和 $H1\\_error$ 是十进制数。最后一行必须具有确切的格式：\n[[N1,tau01,L2_error1,H1_error1],[N2,tau02,L2_error2,H1_error2],...,[N9,tau09,L2_error9,H1_error9]]", "solution": "我们从与该微分算子相关的基本弱形式开始。对于给定的系数 $\\varepsilon  0$，$\\beta \\in \\mathbb{R}$ 和 $c \\ge 0$，考虑算子 $L u := -\\varepsilon\\,u'' + \\beta\\,u' + c\\,u$。其强形式为 $L u = f$ 在 $(0,1)$ 上成立，并带有齐次狄利克雷边界条件 $u(0) = u(1) = 0$。标准的伽辽金弱形式是通过将强形式方程乘以一个检验函数 $v \\in H_0^1(0,1)$，在 $(0,1)$ 上积分，并对二阶导数项进行一次分部积分得到的。这就得到了双线性形式 $a(\\cdot,\\cdot)$ 和线性形式 $\\ell(\\cdot)$：\n$$\na(u,v) = \\int_0^1 \\varepsilon\\,u'(x)\\,v'(x)\\,dx \\;+\\; \\int_0^1 \\beta\\,u'(x)\\,v(x)\\,dx \\;+\\; \\int_0^1 c\\,u(x)\\,v(x)\\,dx,\n$$\n$$\n\\ell(v) = \\int_0^1 f(x)\\,v(x)\\,dx.\n$$\n伽辽金/最小二乘 (GLS) 稳定化通过在网格的每个单元 $K$ 上添加一个涉及强残差的相容最小二乘项，对此格式进行了扩充。令 $\\{\\mathcal{T}_h\\}$ 为 $[0,1]$ 的一个剖分，其单元为 $K$，尺寸为 $h_K$。定义 GLS 稳定化的双线性和线性形式如下：\n$$\na_{\\text{GLS}}(u,v) = a(u,v) + \\sum_{K \\in \\mathcal{T}_h} \\tau_K \\int_{K} (L u)\\,(L v)\\,dx,\\qquad\n\\ell_{\\text{GLS}}(v) = \\ell(v) + \\sum_{K \\in \\mathcal{T}_h} \\tau_K \\int_{K} f(x)\\,(L v)\\,dx,\n$$\n其中 $\\tau_K  0$ 的选择是为了在对流占优的情况下控制稳定性。\n\n我们在一个包含 $N$ 个单元、网格尺寸为 $h=1/N$ 的均匀网格上，采用一个连续分片线性有限元空间 $V_h \\subset H_0^1(0,1)$。在每个单元 $K=[x_i,x_{i+1}]$ 上，局部基函数是标准的线性形函数 $N_1$ 和 $N_2$。对于任何离散函数 $w_h \\in V_h$，其二阶导数 $w_h''$ 在每个单元 $K$ 内部都为零，因为 $w_h$ 在 $K$ 上是线性的。因此，对于试探函数和检验函数 $u_h, v_h \\in V_h$，\n$$\nL u_h\\big|_K = -\\varepsilon\\,u_h'' + \\beta\\,u_h' + c\\,u_h = \\beta\\,u_h' + c\\,u_h,\\quad\nL v_h\\big|_K = \\beta\\,v_h' + c\\,v_h.\n$$\n这一观察极大地简化了 GLS 项：\n$$\n\\int_{K} (L u_h)(L v_h)\\,dx = \\int_{K} (\\beta\\,u_h' + c\\,u_h)\\,(\\beta\\,v_h' + c\\,v_h)\\,dx.\n$$\n将此式展开，局部的 GLS 双线性形式由以下四个贡献项组成：\n1) $\\beta^2 \\int_K u_h' v_h' \\, dx$,\n2) $\\beta c \\int_K u_h' v_h \\, dx$,\n3) $\\beta c \\int_K u_h v_h' \\, dx$,\n4) $c^2 \\int_K u_h v_h \\, dx$.\n类似地，稳定化的右端项变为\n$$\n\\int_K f(x)\\,(\\beta\\,v_h' + c\\,v_h)\\,dx = \\beta \\int_K f(x)\\,v_h'\\,dx + c \\int_K f(x)\\,v_h\\,dx.\n$$\n这些积分可以与标准的伽辽金贡献项一起，通过在每个单元上使用高斯求积法进行组装：\n- 扩散项：$\\varepsilon \\int_K u_h' v_h' \\, dx$，\n- 对流项：$\\beta \\int_K u_h' v_h \\, dx$，\n- 反应项：$c \\int_K u_h v_h \\, dx$，\n- 载荷项：$\\int_K f(x) v_h \\, dx$。\n\n我们现在指定当 $u(x) = \\sin(\\pi x)$ 时的制造源项 $f(x)$。使用 $L u = f$，我们计算\n$$\nu'(x) = \\pi \\cos(\\pi x),\\qquad u''(x) = -\\pi^2 \\sin(\\pi x),\n$$\n因此\n$$\nf(x) = -\\varepsilon\\,u''(x) + \\beta\\,u'(x) + c\\,u(x) = \\varepsilon\\,\\pi^2 \\sin(\\pi x) + \\beta\\,\\pi \\cos(\\pi x) + c\\,\\sin(\\pi x).\n$$\n在指定系数 $\\varepsilon = 10^{-3}$，$\\beta = 2$ 和 $c=0$ 下，该式简化为\n$$\nf(x) = 10^{-3}\\,\\pi^2 \\sin(\\pi x) + 2\\pi \\cos(\\pi x).\n$$\n\n我们选择每个单元上的稳定化参数为\n$$\n\\tau_K = \\tau_0\\,\\frac{h_K}{2\\,|\\beta|},\n$$\n对于 $|\\beta|0$。如果 $|\\beta|=0$，可以设置 $\\tau_K = \\tau_0\\,h_K/2$ 作为一种备用方案，不过在我们的测试套件中，我们使用 $\\beta=2$，因此适用非退化情况。\n\n算法实现细节：\n- 生成一个均匀网格，节点为 $x_i = i h$，其中 $i=0,\\dots,N$。\n- 通过遍历单元来组装全局矩阵和向量。对于数值积分，在参考单元 $[-1,1]$ 上使用四点高斯-勒让德求积法，并通过仿射映射到每个物理单元。参考坐标 $\\xi \\in [-1,1]$ 上的形函数为 $N_1(\\xi) = \\frac{1-\\xi}{2}$ 和 $N_2(\\xi) = \\frac{1+\\xi}{2}$。它们关于 $x$ 的导数在每个单元上是常数：$dN_1/dx = -1/h_K$, $dN_2/dx = 1/h_K$；等价地，可以通过 $dx = \\frac{h_K}{2}\\,d\\xi$ 使用 $d\\xi \\mapsto dx$ 进行计算。\n- 每个单元上的标准伽辽金双线性贡献项是：\n  - 扩散：$\\varepsilon \\int_K (dN/dx)^\\top (dN/dx)\\,dx$，\n  - 对流：$\\beta \\int_K (dN/dx)^\\top N\\,dx$，\n  - 反应：$c \\int_K N^\\top N\\,dx$，\n  其中 $N=[N_1,N_2]^\\top$ 且 $dN/dx=[dN_1/dx,dN_2/dx]^\\top$。\n- GLS 双线性贡献项是 $\\tau_K \\int_K (\\beta\\,dN/dx + c\\,N)\\,(\\beta\\,dN/dx + c\\,N)^\\top\\,dx$。\n- 右端项除了标准的载荷项 $\\int_K f(x)\\,N\\,dx$ 之外，还增加了 GLS 项 $\\tau_K \\int_K f(x)\\,(\\beta\\,dN/dx + c\\,N)\\,dx$。\n- 通过为内部自由度（节点 1 到 $N-1$）构建缩减系统，在端点处施加齐次狄利克雷边界条件。\n- 求解所得线性系统以获得内部节点值。\n- 在每个单元上重构 $u_h$ 并使用四点高斯-勒让德求积法评估误差范数：\n  - 对于每个权重为 $w_q$、雅可比行列式为 $J_K = h_K/2$ 的求积点 $x_q$，计算离散解的值 $u_h(x_q)=N(x_q)\\cdot u_h^K$ 和导数 $u_h'(x_q)=dN/dx \\cdot u_h^K$。精确值为 $u(x_q)=\\sin(\\pi x_q)$ 和 $u'(x_q)=\\pi\\cos(\\pi x_q)$。累加\n    $\\int_K (u-u_h)^2\\,dx \\approx \\sum_q w_q\\,J_K\\,(u(x_q)-u_h(x_q))^2$ 和\n    $\\int_K (u'-u_h')^2\\,dx \\approx \\sum_q w_q\\,J_K\\,(u'(x_q)-u_h'(x_q))^2$。\n  - 全局 $L^2$ 误差是第一个量在所有单元上求和的平方根，而 $H^1$ 误差是两个量之和的平方根。\n\n测试套件和输出：\n使用问题中指定的九个 $(N,\\tau_0)$ 对。对每一对，计算 $L^2$ 和 $H^1$ 误差。程序必须输出单行，其中包含一个含九个条目的列表，每个条目形式为 $[N,\\tau_0,L2\\_error,H1\\_error]$，并按测试套件的顺序排列。这确保了覆盖多种网格尺寸和不同的稳定化强度，包括非稳定化情况 $\\tau_0=0$ 和两种稳定化情况。\n\n此过程基于基本弱格式和最小二乘稳定化原理，仅使用标准的有限元机制进行组装和求积，并为制造解得出可量化的误差范数，从而能够对 $h$ 和 $\\tau_0$ 对精度的影响进行有原则的研究。", "answer": "[[20, 0.0, 0.04018244917540209, 0.6781297530663363],[20, 0.5, 0.02102029337583692, 0.44391629554030646],[20, 1.0, 0.01511210404495574, 0.35414349320626354],[40, 0.0, 0.03848767794354228, 0.6436894086435016],[40, 0.5, 0.00698188506509653, 0.20302324905391503],[40, 1.0, 0.004128522305886981, 0.14371408828005345],[80, 0.0, 0.0380385926830737, 0.6358153347072553],[80, 0.5, 0.0019280961819582194, 0.08865005990263628],[80, 1.0, 0.0010648218151817294, 0.06201633512217688]]", "id": "2561145"}]}