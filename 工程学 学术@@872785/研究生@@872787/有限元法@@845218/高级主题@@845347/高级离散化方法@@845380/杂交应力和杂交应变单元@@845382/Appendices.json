{"hands_on_practices": [{"introduction": "在混合有限元法中，单元矩阵的构建依赖于在单元域上的积分。由于被积函数通常是复杂的多项式，这些积分通常采用数值积分（如高斯积分）来计算。选择正确的积分阶数至关重要，它直接关系到计算结果的精度；过低的阶数会导致积分误差，从而影响单元的性能和收敛性。本练习将通过一个系统性的多项式次数分析，引导你确定保证精确积分所需的最小高斯积分阶数，这是正确实现混合应力单元的基础。[@problem_id:2566136]", "problem": "考虑一个在有限元法 (FEM) 框架下，根据 Hellinger–Reissner (HR) 变分原理构建的二维混合应力有限元。在通过等参映射到物理单元的母单元正方形 $[-1,1]^2$上，假设位移场由每个母坐标上 $r$ 次的张量积拉格朗日多项式逼近，且几何形状使用相同的形函数进行等参映射。假定的应力场在母域中表示为一个应力模式矩阵 $M(\\xi,\\eta)$ 乘以一个应力参数向量，其中 $M(\\xi,\\eta)$ 的每个元素都是 $(\\xi,\\eta)$ 的多项式，其在每个母坐标上的次数最多为 $s$，其中 $s \\in \\mathbb{N}_0$。用 $S$ 表示常数柔度矩阵（在平面应力或平面应变中是弹性刚度张量的逆）。\n\n定义单元矩阵\n$$\nH \\;=\\; \\int_{\\Omega_e} M(\\xi,\\eta)^{\\mathsf{T}}\\, S\\, M(\\xi,\\eta)\\, \\mathrm{d}\\Omega,\n\\qquad\nG \\;=\\; \\int_{\\Omega_e} M(\\xi,\\eta)^{\\mathsf{T}}\\, B(\\xi,\\eta)\\, \\mathrm{d}\\Omega,\n$$\n其中 $B(\\xi,\\eta)$ 是标准的物理应变-位移矩阵，$\\mathrm{d}\\Omega$ 是物理面积测度。假设一个一般的 $r$ 阶弯曲等参几何（即，不假设仿射映射）。\n\n您将通过变量替换到母单元正方形的方法，使用每个母坐标上 $m$ 个点（即 $m \\times m$ 法则）的张量积高斯-勒让德 (GL) 求积法来计算这些积分。仅使用基本的多项式次数计数和一维 GL 求积的精确性（一个 $m$ 点 GL 法则对次数最高为 $2m-1$ 的多项式是精确的），确定保证对该等参族中任何单元的 $H$ 和 $G$ 都能精确积分的最小整数 $m$（作为 $r$ 和 $s$ 的显式函数）。请用一个关于 $r$ 和 $s$ 的单一闭式表达式给出您的答案。", "solution": "该问题要求确定在母单元正方形域 $[-1,1]^2$ 的每个方向上高斯-勒让德求积点的最小数量 $m$，以确保对一个二维混合应力有限元的单元矩阵 $H$ 和 $G$ 进行精确积分。\n\n所用的求积法则是张量积 $m \\times m$ 高斯-勒让德格式。一维 $m$ 点高斯-勒让德法则能精确积分次数最高为 $2m-1$ 的任意多项式。因此，$m \\times m$ 张量积法则能精确积分任何二元多项式 $P(\\xi, \\eta)$，只要其在 $\\xi$ 方向的最高次数不超过 $2m-1$ 且在 $\\eta$ 方向的最高次数不超过 $2m-1$。我们的任务是找出 $H$ 和 $G$ 的被积函数关于每个母坐标 $\\xi$ 和 $\\eta$ 的最大多项式次数。\n\n令 $\\deg_\\xi(f)$ 和 $\\deg_\\eta(f)$ 分别表示函数 $f(\\xi, \\eta)$ 在变量 $\\xi$ 和 $\\eta$ 上的最大多项式次数。对于函数乘积，其次数是各项次数之和：$\\deg_\\xi(f \\cdot g) = \\deg_\\xi(f) + \\deg_\\xi(g)$。对于和，其次数是各项次数的最大值。所需的求积阶数 $m$ 必须满足 $2m-1 \\ge \\max(\\deg_\\xi(\\text{被积函数}), \\deg_\\eta(\\text{被积函数}))$。\n\n积分是在物理单元域 $\\Omega_e$ 上进行的。我们必须首先使用等参映射 $\\mathbf{x}(\\xi, \\eta) = \\sum_k N_k(\\xi, \\eta) \\mathbf{x}_k$ 将积分变换到母域 $[-1,1]^2$ 上。面积微元变换为 $\\mathrm{d}\\Omega = \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$，其中 $J$ 是映射的雅可比矩阵：\n$$\nJ(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n用于几何的形函数 $N_k(\\xi, \\eta)$ 是每个坐标上次数为 $r$ 的张量积拉格朗日多项式。因此，$\\deg_\\xi(N_k) = r$ 且 $\\deg_\\eta(N_k) = r$。形函数的导数次数为：\n$\\deg_\\xi(\\frac{\\partial N_k}{\\partial \\xi}) = r-1$，$\\deg_\\eta(\\frac{\\partial N_k}{\\partial \\xi}) = r$。\n$\\deg_\\xi(\\frac{\\partial N_k}{\\partial \\eta}) = r$，$\\deg_\\eta(\\frac{\\partial N_k}{\\partial \\eta}) = r-1$。\n\n雅可比矩阵 $J$ 的元素是这些导数的线性组合。它们的次数为：\n$\\deg_\\xi(\\frac{\\partial x}{\\partial \\xi}) = r-1$，$\\deg_\\eta(\\frac{\\partial x}{\\partial \\xi}) = r$。\n$\\deg_\\xi(\\frac{\\partial x}{\\partial \\eta}) = r$，$\\deg_\\eta(\\frac{\\partial x}{\\partial \\eta}) = r-1$。\n$y$ 的导数也同样如此。\n\n雅可比行列式为 $\\det(J) = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial x}{\\partial \\eta}$。我们通过检查每一项来确定其多项式次数。对于第一项 $\\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta}$：\n$\\deg_\\xi = \\deg_\\xi(\\frac{\\partial x}{\\partial \\xi}) + \\deg_\\xi(\\frac{\\partial y}{\\partial \\eta}) = (r-1) + r = 2r-1$。\n$\\deg_\\eta = \\deg_\\eta(\\frac{\\partial x}{\\partial \\xi}) + \\deg_\\eta(\\frac{\\partial y}{\\partial \\eta}) = r + (r-1) = 2r-1$。\n第二项 $\\frac{\\partial y}{\\partial \\xi} \\frac{\\partial x}{\\partial \\eta}$ 具有相同的次数。因此，$\\det(J)$ 在每个变量中的最大次数为 $2r-1$。\n$\\deg_\\xi(\\det(J)) \\le 2r-1$ 且 $\\deg_\\eta(\\det(J)) \\le 2r-1$。\n\n现在，我们分析 $H$ 和 $G$ 的被积函数。\n\n1.  **$H$ 矩阵分析：**\n    $H$ 的积分为 $H_i = \\int_{-1}^1 \\int_{-1}^1 (M^{\\mathsf{T}} S M)_i \\, \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$，其中 $(\\cdot)_i$ 表示所得矩阵的一个元素。\n    应力模式矩阵 $M(\\xi, \\eta)$ 包含多项式元素，其 $\\deg_\\xi(M_{ij}) \\le s$ 且 $\\deg_\\eta(M_{ij}) \\le s$。柔度矩阵 $S$ 是常数。\n    乘积 $M^{\\mathsf{T}} S M$ 的元素将是 $M$ 中元素乘积之和。$M^{\\mathsf{T}} S M$ 中任意元素的最高次数为：\n    $\\deg_\\xi(M^{\\mathsf{T}} S M) \\le s+s = 2s$。\n    $\\deg_\\eta(M^{\\mathsf{T}} S M) \\le s+s = 2s$。\n    被积函数为 $(M^{\\mathsf{T}} S M) \\det(J)$。被积函数多项式在每个变量中的最大次数为：\n    $\\deg_\\xi(\\text{integrand}_H) \\le \\deg_\\xi(M^{\\mathsf{T}} S M) + \\deg_\\xi(\\det(J)) \\le 2s + (2r-1) = 2r+2s-1$。\n    $\\deg_\\eta(\\text{integrand}_H) \\le 2r+2s-1$。\n    为了精确积分，求积法则必须对这个次数的多项式是精确的。令 $p_H = 2r+2s-1$。条件是 $2m-1 \\ge p_H$。\n    $2m-1 \\ge 2r+2s-1 \\implies 2m \\ge 2r+2s \\implies m \\ge r+s$。\n\n2.  **$G$ 矩阵分析：**\n    $G$ 的积分为 $G_i = \\int_{-1}^1 \\int_{-1}^1 (M^{\\mathsf{T}} B)_i \\, \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$。\n    应变-位移矩阵 $B(\\xi, \\eta)$ 将节点位移与物理应变联系起来。其元素由位移形函数 $N_k$（与几何形函数相同）的物理导数构成。物理导数是通过雅可比矩阵的逆 $J^{-1}$ 求得的：\n    $$\n    \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\frac{1}{\\det(J)} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta}  -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n    $$\n    例如，$B$ 中的一个元素形如 $\\frac{\\partial N_k}{\\partial x} = \\frac{1}{\\det(J)} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial N_k}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial N_k}{\\partial \\eta} \\right)$。\n    $G$ 的被积函数是 $M^{\\mathsf{T}} B \\det(J)$。当我们代入 $B$ 的表达式时，$B$ 分母中的 $\\det(J)$ 与面积变换中的 $\\det(J)$ 相抵消。\n    Integrand$_G = M^{\\mathsf{T}} B_{num}$，其中 $B_{num}$ 是包含 $B$ 元素分子的矩阵。\n    $B_{num}$ 中的一个元素，例如，是 $\\frac{\\partial y}{\\partial \\eta} \\frac{\\partial N_k}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial N_k}{\\partial \\eta}$。\n    这个表达式的多项式次数确定方式与 $\\det(J)$ 相同：\n    $\\deg_\\xi(\\frac{\\partial y}{\\partial \\eta} \\frac{\\partial N_k}{\\partial \\xi}) = \\deg_\\xi(\\frac{\\partial y}{\\partial \\eta}) + \\deg_\\xi(\\frac{\\partial N_k}{\\partial \\xi}) = r + (r-1) = 2r-1$。\n    在 $\\eta$ 上的次数也是 $2r-1$。$B_{num}$ 中的所有项在每个变量中的最大次数都是 $2r-1$。\n    $\\deg_\\xi(B_{num}) \\le 2r-1$ 且 $\\deg_\\eta(B_{num}) \\le 2r-1$。\n    $G$ 的被积函数是一个多项式 $M^{\\mathsf{T}} B_{num}$。其最大次数为：\n    $\\deg_\\xi(\\text{integrand}_G) \\le \\deg_\\xi(M) + \\deg_\\xi(B_{num}) \\le s + (2r-1) = 2r+s-1$。\n    $\\deg_\\eta(\\text{integrand}_G) \\le 2r+s-1$。\n    令 $p_G = 2r+s-1$。精确积分的条件是 $2m-1 \\ge p_G$。\n    $2m-1 \\ge 2r+s-1 \\implies 2m \\ge 2r+s \\implies m \\ge r + \\frac{s}{2}$。\n\n3.  **$m$ 的最终确定：**\n    为了保证对 $H$ 和 $G$ 都能精确积分，$m$ 必须同时满足推导出的两个条件：\n    $m \\ge r+s$\n    $m \\ge r + \\frac{s}{2}$\n    我们必须选择更严格的条件。因为 $s \\in \\mathbb{N}_0$，所以有 $s \\ge 0$，这意味着 $s \\ge s/2$。因此，$r+s \\ge r+s/2$。\n    更严格的要求是 $m \\ge r+s$。\n    由于 $m$ 必须是整数，且 $r$ 和 $s$ 也是整数，所以 $m$ 的最小整数值为 $r+s$。", "answer": "$$\n\\boxed{r+s}\n$$", "id": "2566136"}, {"introduction": "一个理论上完美的单元在实际应用中仍可能因为对网格质量过于敏感而失效，尤其是在处理几何畸变网格时。本练习旨在揭示单元几何形状如何直接影响其数值稳定性。通过推导连接应力参数与广义节点力的关键矩阵，并分析其在单元畸变时的秩，我们可以直观地观察到数值不稳定性的根源——秩亏损现象，它会导致伪“零能模式”的产生。[@problem_id:2566157]", "problem": "考虑一个无体力作用的平面应力三节点线性三角形混合应力有限元。该三角形的节点坐标分别为 $(0,0)$、$(1,0)$ 和 $(0,\\alpha)$，其中 $\\alpha0$ 是一个畸变参数（高度）。在混合应力格式中，单元内部假设存在一个独立的、自平衡的应力场，并通过边界虚功弱形式地施加单元间的连续性。采用常应力（自平衡）模式\n$$\n\\widehat{\\boldsymbol{\\sigma}}(\\boldsymbol{\\beta}) \\equiv \n\\begin{bmatrix}\n\\sigma_{x} \\\\\n\\sigma_{y} \\\\\n\\tau_{xy}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\beta_{1} \\\\\n\\beta_{2} \\\\\n\\beta_{3}\n\\end{bmatrix},\n$$\n其中 $\\beta_{1}$、$\\beta_{2}$ 和 $\\beta_{3}$ 是应力参数。令 $\\mathbf{t} = \\widehat{\\boldsymbol{\\sigma}}\\,\\mathbf{n}$ 为单元边界上的面力矢量，其中 $\\mathbf{n}$ 是向外的单位法向量；令 $\\mathbf{N}$ 为沿每条边插值节点位移的标准线性形函数矩阵。与单元边界相关的广义节点力矢量由边界虚功恒等式定义\n$$\n\\mathbf{f}(\\boldsymbol{\\beta}) \\equiv \\int_{\\partial\\Omega_{e}} \\mathbf{N}^{\\mathsf{T}} \\mathbf{t} \\, \\mathrm{d}\\Gamma,\n$$\n因此有 $\\mathbf{f}(\\boldsymbol{\\beta}) = \\mathbf{H}(\\alpha)\\,\\boldsymbol{\\beta}$，其中 $\\mathbf{H}(\\alpha)$ 是一个依赖于单元几何形状的矩阵。\n\n选取三个独立的节点位移自由度，分别为节点2的$x$方向位移、节点3的$y$方向位移以及节点1的$x$方向位移。通过根据边长和外法线精确计算边界积分，组装相应的 $3\\times 3$ 矩阵 $\\mathbf{H}(\\alpha)$，该矩阵将 $\\boldsymbol{\\beta}$ 映射到与这三个自由度共轭的广义节点力。\n\n然后，通过计算特定畸变单元（$\\alpha=\\tfrac{1}{3}$）的秩来分析 $\\mathbf{H}(\\alpha)$ 的可逆性。在你的推理中，从面力、线性边上的形函数以及混合应力单元的边界虚功表达式的定义出发，解释单元畸变（当 $\\alpha \\to 0$ 时）为何以及如何导致秩亏损。\n\n仅报告 $\\mathbf{H}(\\tfrac{1}{3})$ 的秩作为最终数值答案。无需单位，也无需四舍五入。", "solution": "求解过程首先定义单元的几何形状及其边界属性。该单元有三条边：\n1.  边1-2：从节点1 $(0,0)$ 到节点2 $(1,0)$。长度为 $L_{12} = 1$。向外单位法向量为 $\\mathbf{n}_{12} = [0, -1]^{\\mathsf{T}}$。\n2.  边2-3：从节点2 $(1,0)$ 到节点3 $(0,\\alpha)$。长度为 $L_{23} = \\sqrt{(0-1)^2 + (\\alpha-0)^2} = \\sqrt{1+\\alpha^2}$。向外单位法向量为 $\\mathbf{n}_{23} = \\frac{1}{\\sqrt{1+\\alpha^2}}[\\alpha, 1]^{\\mathsf{T}}$。\n3.  边3-1：从节点3 $(0,\\alpha)$ 到节点1 $(0,0)$。长度为 $L_{31} = \\sqrt{(0-0)^2 + (0-\\alpha)^2} = \\alpha$。向外单位法向量为 $\\mathbf{n}_{31} = [-1, 0]^{\\mathsf{T}}$。\n\n边界上的面力矢量 $\\mathbf{t}$（其外法线为 $\\mathbf{n}=[n_x, n_y]^{\\mathsf{T}}$）由 $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$ 给出。使用问题中给出的应力Voigt表示法，$\\boldsymbol{\\sigma} = \\begin{bmatrix} \\sigma_x  \\tau_{xy} \\\\ \\tau_{xy}  \\sigma_y \\end{bmatrix}$，可得：\n$$\n\\mathbf{t} = \\begin{bmatrix} t_x \\\\ t_y \\end{bmatrix} = \\begin{bmatrix} \\sigma_x n_x + \\tau_{xy} n_y \\\\ \\tau_{xy} n_x + \\sigma_y n_y \\end{bmatrix} = \\begin{bmatrix} n_x  0  n_y \\\\ 0  n_y  n_x \\end{bmatrix} \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\end{pmatrix}\n$$\n由于应力场是恒定的，所以面力矢量在每条边上也是恒定的。三条边上的面力矢量为：\n$$\n\\mathbf{t}_{12} = \\begin{bmatrix} 0  0  -1 \\\\ 0  -1  0 \\end{bmatrix} \\boldsymbol{\\beta} = \\begin{bmatrix} -\\beta_3 \\\\ -\\beta_2 \\end{bmatrix}\n$$\n$$\n\\mathbf{t}_{23} = \\frac{1}{L_{23}} \\begin{bmatrix} \\alpha  0  1 \\\\ 0  1  \\alpha \\end{bmatrix} \\boldsymbol{\\beta}\n$$\n$$\n\\mathbf{t}_{31} = \\begin{bmatrix} -1  0  0 \\\\ 0  0  -1 \\end{bmatrix} \\boldsymbol{\\beta} = \\begin{bmatrix} -\\beta_1 \\\\ -\\beta_3 \\end{bmatrix}\n$$\n广义节点力矢量 $\\mathbf{f}$ 是通过将面力与由形函数矩阵 $\\mathbf{N}$ 插值的虚位移所做的功进行积分得到的。对于节点 $i$ 和 $j$ 之间的线性单元边，由长度为 $L$ 的边上恒定面力 $\\mathbf{t}$ 产生的节点力，可以通过将总力 $L\\mathbf{t}$ 平均分配到两个节点来求得：\n$$\n\\int_{\\text{edge } ij} \\mathbf{N}^{\\mathsf{T}} \\mathbf{t} \\, \\mathrm{d}\\Gamma = \\frac{L}{2} \\begin{bmatrix} \\mathbf{t} \\\\ \\mathbf{t} \\end{bmatrix}\n$$\n其中，得到的力矢量被分配给节点 $i$ 和节点 $j$。\n\n来自每条边的力贡献如下：\n-   边1-2：节点1上的力为 $\\frac{L_{12}}{2}\\mathbf{t}_{12} = \\frac{1}{2}[-\\beta_3, -\\beta_2]^{\\mathsf{T}}$。节点2上的力也为 $\\frac{1}{2}[-\\beta_3, -\\beta_2]^{\\mathsf{T}}$。\n-   边2-3：节点2上的力为 $\\frac{L_{23}}{2}\\mathbf{t}_{23} = \\frac{1}{2}[\\alpha\\beta_1 + \\beta_3, \\beta_2 + \\alpha\\beta_3]^{\\mathsf{T}}$。节点3上的力相同。\n-   边3-1：节点3上的力为 $\\frac{L_{31}}{2}\\mathbf{t}_{31} = \\frac{\\alpha}{2}[-\\beta_1, -\\beta_3]^{\\mathsf T}$。节点1上的力相同。\n\n通过对每个节点的贡献求和，得到总的节点力：\n$$\n\\mathbf{f}_1 = \\begin{bmatrix} f_{1x} \\\\ f_{1y} \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} -\\beta_3 \\\\ -\\beta_2 \\end{bmatrix} + \\frac{\\alpha}{2}\\begin{bmatrix} -\\beta_1 \\\\ -\\beta_3 \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} -\\alpha\\beta_1 - \\beta_3 \\\\ -\\beta_2 - \\alpha\\beta_3 \\end{bmatrix}\n$$\n$$\n\\mathbf{f}_2 = \\begin{bmatrix} f_{2x} \\\\ f_{2y} \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} -\\beta_3 \\\\ -\\beta_2 \\end{bmatrix} + \\frac{1}{2}\\begin{bmatrix} \\alpha\\beta_1 + \\beta_3 \\\\ \\beta_2 + \\alpha\\beta_3 \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} \\alpha\\beta_1 \\\\ \\alpha\\beta_3 \\end{bmatrix}\n$$\n$$\n\\mathbf{f}_3 = \\begin{bmatrix} f_{3x} \\\\ f_{3y} \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} \\alpha\\beta_1 + \\beta_3 \\\\ \\beta_2 + \\alpha\\beta_3 \\end{bmatrix} + \\frac{\\alpha}{2}\\begin{bmatrix} -\\beta_1 \\\\ -\\beta_3 \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} \\beta_3 \\\\ \\beta_2 \\end{bmatrix}\n$$\n节点力之和 $\\mathbf{f}_1+\\mathbf{f}_2+\\mathbf{f}_3 = \\mathbf{0}$，这验证了平衡条件。\n\n问题指定了自由度对应于节点2的$x$方向位移 ($u_2$)、节点3的$y$方向位移 ($v_3$)以及节点1的$x$方向位移 ($u_1$)。相应的广义力为 $f_{2x}$、$f_{3y}$ 和 $f_{1x}$。我们组装这些力的矢量：\n$$\n\\mathbf{f}_{\\text{selected}} = \\begin{pmatrix} f_{2x} \\\\ f_{3y} \\\\ f_{1x} \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} \\alpha\\beta_1 \\\\ \\beta_2 \\\\ -\\alpha\\beta_1 - \\beta_3 \\end{pmatrix}\n$$\n这个关系用矩阵形式表示为 $\\mathbf{f}_{\\text{selected}} = \\mathbf{H}(\\alpha)\\boldsymbol{\\beta}$：\n$$\n\\begin{pmatrix} f_{2x} \\\\ f_{3y} \\\\ f_{1x} \\end{pmatrix} = \\frac{1}{2} \\begin{bmatrix} \\alpha  0  0 \\\\ 0  1  0 \\\\ -\\alpha  0  -1 \\end{bmatrix} \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\end{pmatrix}\n$$\n因此，矩阵 $\\mathbf{H}(\\alpha)$ 为：\n$$\n\\mathbf{H}(\\alpha) = \\frac{1}{2} \\begin{bmatrix} \\alpha  0  0 \\\\ 0  1  0 \\\\ -\\alpha  0  -1 \\end{bmatrix}\n$$\n为了求出当 $\\alpha = \\frac{1}{3}$ 时 $\\mathbf{H}(\\alpha)$ 的秩，我们首先代入这个值：\n$$\n\\mathbf{H}(\\tfrac{1}{3}) = \\frac{1}{2} \\begin{bmatrix} 1/3  0  0 \\\\ 0  1  0 \\\\ -1/3  0  -1 \\end{bmatrix}\n$$\n一个方阵的秩等于其维度，当且仅当其行列式不为零。行列式为：\n$$\n\\det(\\mathbf{H}(\\tfrac{1}{3})) = \\left(\\frac{1}{2}\\right)^3 \\det \\begin{bmatrix} 1/3  0  0 \\\\ 0  1  0 \\\\ -1/3  0  -1 \\end{bmatrix} = \\frac{1}{8} \\left( \\frac{1}{3} \\cdot (1 \\cdot (-1) - 0 \\cdot 0) \\right) = \\frac{1}{8} \\left( -\\frac{1}{3} \\right) = -\\frac{1}{24}\n$$\n由于 $\\det(\\mathbf{H}(\\tfrac{1}{3})) \\neq 0$，该矩阵可逆且满秩。因为它是一个 $3 \\times 3$ 矩阵，所以其秩为 $3$。\n\n最后，我们分析当 $\\alpha \\to 0$ 时单元畸变的影响。$\\mathbf{H}(\\alpha)$ 的行列式为 $\\det(\\mathbf{H}(\\alpha)) = -\\frac{\\alpha}{8}$。随着单元畸变并趋于扁平，$\\alpha \\to 0$，导致 $\\det(\\mathbf{H}(\\alpha)) \\to 0$。矩阵变为奇异矩阵，这表示秩的亏损。\n在极限情况 $\\alpha=0$ 下，矩阵为：\n$$\n\\mathbf{H}(0) = \\frac{1}{2} \\begin{bmatrix} 0  0  0 \\\\ 0  1  0 \\\\ 0  0  -1 \\end{bmatrix}\n$$\n第一行为零向量，第二行和第三行线性无关。因此，$\\mathbf{H}(0)$ 的秩为 $2$，比满秩 $3$有所下降。\n这种秩亏损意味着 $\\mathbf{H}(0)$ 存在一个非平凡的零空间。求解 $\\mathbf{H}(0)\\boldsymbol{\\beta} = \\mathbf{0}$ 得到 $\\beta_2=0$ 和 $\\beta_3=0$，而 $\\beta_1$ 不受约束。这意味着对于任何非零常数 $c$，应力状态 $\\boldsymbol{\\beta} = [c, 0, 0]^{\\mathsf{T}}$ 对于所选自由度产生的节点力为零。这对应于纯单轴应力 $\\sigma_x = \\beta_1$，在退化的几何形状中，它对节点位移不做功。这是一种伪“零能模式”或“运动模式”，是一种人为现象，它会使单元刚度矩阵 $\\mathbf{K}_e = \\mathbf{H} \\mathbf{S}^{-1} \\mathbf{H}^{\\mathsf{T}}$ 变得不稳定，该矩阵也会发生秩亏损。由于几何畸变导致的 $\\mathbf{H}$ 矩阵的秩亏损是这种关键数值不稳定性的数学指标。", "answer": "$$\n\\boxed{3}\n$$", "id": "2566157"}, {"introduction": "混合单元的稳定性从根本上受制于 Babuška–Brezzi (inf-sup) 条件，该条件要求所选择的应力插值空间和位移插值空间之间必须保持适当的“平衡”。本练习将具体展示违反此条件所带来的实际后果。通过对比一个不充分的（不稳定）应力场和一个足够丰富的（稳定）应力场，我们将利用特征值分析来可视化非物理的“沙漏模式”是如何出现并如何通过改善应力插值来消除的，从而将抽象的数学理论与单元的实际表现联系起来。[@problem_id:2566183]", "problem": "考虑二维线性弹性问题的双场 Hellinger–Reissner 泛函，其位移场 $u \\in \\mathcal{V}_h$ 和应力场 $\\sigma \\in \\Sigma_h$ 由下式给出\n$$\n\\Pi(u,\\sigma) \\;=\\; \\int_{\\Omega_e} \\sigma : \\varepsilon(u) \\,\\mathrm{d}\\Omega \\;-\\; \\tfrac{1}{2}\\int_{\\Omega_e} \\sigma : \\mathbb{C}^{-1} : \\sigma \\,\\mathrm{d}\\Omega \\;-\\; \\int_{\\Gamma_t\\cap \\partial\\Omega_e} t \\cdot u \\,\\mathrm{d}\\Gamma,\n$$\n其中 $\\varepsilon(u)$ 是 $u$ 的对称梯度，$\\mathbb{C}$ 是平面应变问题的四阶弹性张量，$\\Omega_e$ 是一个单个的四边形单元。在杂交应力格式中，应力通过假定的应力模式在单元内部进行插值，而位移仅存在于边界上（作为节点值）。设位移场由标准的双线性四节点四边形形函数插值，应力场以 Voigt 记法表示为 $\\sigma = [\\sigma_{xx},\\sigma_{yy},\\tau_{xy}]^\\top$，通过一个假定应力矩阵 $P(\\xi,\\eta)$ 使得 $\\sigma(\\xi,\\eta) = P(\\xi,\\eta)\\,\\beta$，其中 $\\beta$ 是一个应力参数向量。\n\n根据 $\\Pi(u,\\sigma)$ 的驻定性条件，单元系统可以写成如下分块形式\n$$\n\\begin{bmatrix}\n0  G^\\top \\\\\nG  -H\n\\end{bmatrix}\n\\begin{bmatrix}\nu_e \\\\ \\beta\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nf_e \\\\ 0\n\\end{bmatrix},\n$$\n其中\n$$\nG \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top\\,B(\\xi,\\eta)\\,\\mathrm{d}\\Omega, \n\\qquad\nH \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top\\,\\mathbb{C}^{-1}\\,P(\\xi,\\eta)\\,\\mathrm{d}\\Omega,\n$$\n其中 $B(\\xi,\\eta)$ 是四节点双线性单元的标准的 $3\\times 8$ 应变-位移矩阵。对 $\\beta$ 进行静力凝聚，得到凝聚单元刚度\n$$\nK_e \\;=\\; G^\\top H^{-1} G.\n$$\n单元上混合格式稳定性的 Babuška–Brezzi (inf–sup) 条件要求\n$$\n\\inf_{\\sigma \\in \\Sigma_h} \\sup_{u \\in \\mathcal{V}_h} \\frac{\\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega}{\\|\\sigma\\|_{0,\\Omega_e}\\,\\|u\\|_{1,\\Omega_e}} \\;\\ge\\; \\beta_0 \\;\\; 0,\n$$\n其中 $\\beta_0$ 是某个与网格无关的常数。如果该条件被违反，$G$ 将会秩亏，因此 $K_e$ 在刚体模态之外会变得奇异，并表现出零能（沙漏状）伪模态。\n\n你的任务是使用上述框架，在单个四边形上构建并分析两种杂交应力单元：\n\n- 一个通过选取由常应力组成的过于贫乏的应力空间 $\\Sigma_h$ 而违反 inf–sup 条件的不稳定单元，即\n$$\nP_{\\text{const}}(\\xi,\\eta) \\;=\\; \n\\begin{bmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{bmatrix},\n$$\n使得 $\\beta \\in \\mathbb{R}^3$。\n\n- 一个在相同位移空间上，通过采用具有弱线性变化的五参数应力模式来满足 inf–sup 条件的更具表现力的单元，\n$$\nP_{\\text{lin5}}(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n1  0  0  \\xi  0\\\\\n0  1  0  0  \\eta\\\\\n0  0  1  0  0\n\\end{bmatrix},\n$$\n使得 $\\beta \\in \\mathbb{R}^5$。\n\n在一个四边形上使用标准的等参双线性位移插值，其节点在物理空间中为 $\\{(X_i,Y_i)\\}_{i=1}^4$，在自然坐标中为 $(\\xi,\\eta)\\in[-1,1]^2$。设弹性模型为各向同性、平面应变，杨氏模量为 $E$，泊松比为 $\\nu$，因此\n$$\n\\lambda \\;=\\; \\frac{\\nu E}{(1+\\nu)(1-2\\nu)}, \n\\qquad\n\\mu \\;=\\; \\frac{E}{2(1+\\nu)},\n$$\n并且使用工程剪切应变 $\\gamma_{xy}$ 的 Voigt 记法下的本构矩阵为\n$$\n\\mathbb{C} \\;=\\;\n\\begin{bmatrix}\n\\lambda + 2\\mu  \\lambda  0 \\\\\n\\lambda  \\lambda + 2\\mu  0 \\\\\n0  0  \\mu\n\\end{bmatrix}.\n$$\n使用 $\\mathbb{C}^{-1}$ 构造 $H$。通过精确数值积分（使用 $2\\times 2$ 点的张量积 Gauss 积分）组装 $K_e = G^\\top H^{-1} G$。对 $K_e$ 进行特征值分析，确定其零空间的维度，并减去刚体模态以统计沙漏状零能模态的数量。刚体空间由两个平移和一个围绕单元形心的面内旋转所张成。\n\n编写一个程序，该程序为以下四个测试用例（坐标单位为米，但最终答案是无量纲的计数）中的每一个，构造 $K_e$，计算其特征对，并确定沙漏模态的数量：\n\n- 测试用例1（不稳定，正方形）：$E=210\\times 10^9$，$\\nu=0.3$，节点 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$，应力模式 $P_{\\text{const}}$。\n- 测试用例2（稳定，正方形）：与测试用例1相同，但应力模式为 $P_{\\text{lin5}}$。\n- 测试用例3（不稳定，轻微扭曲）：$E=210\\times 10^9$，$\\nu=0.3$，节点 $(-1.0,-1.0)$、$(1.2,-0.8)$、$(1.1,1.1)$、$(-1.1,0.9)$，应力模式 $P_{\\text{const}}$。\n- 测试用例4（稳定，轻微扭曲）：与测试用例3相同，但应力模式为 $P_{\\text{lin5}}$。\n\n对于每个测试用例，计算 $K_e$ 的特征值，如果一个特征值小于容差 $\\varepsilon = 10^{-8}\\,\\lambda_{\\max}$（其中 $\\lambda_{\\max}$ 是该测试中 $K_e$ 的最大特征值），则将其视为零。令 $n_0$ 为零特征值的数量，令 $n_{\\text{rbm}}$ 为零空间与刚体模态空间交集的维度；将沙漏模态计数定义为 $n_{\\text{hg}} = n_0 - n_{\\text{rbm}}$。您的程序必须在单行中输出一个 Python 风格的列表，包含与四个测试用例相对应的四个整数 $[n_{\\text{hg},1}, n_{\\text{hg},2}, n_{\\text{hg},3}, n_{\\text{hg},4}]$，不带任何附加文本。\n\n所有数学推导必须从 Hellinger–Reissner 泛函以及 $\\mathbb{C}$、$\\lambda$、$\\mu$、$B(\\xi,\\eta)$、$P(\\xi,\\eta)$、$G$ 和 $H$ 的定义开始。在这些定义之外，不要使用任何快捷公式，并确保所有数值积分都按照指定通过精确的 Gauss 积分执行。最终答案是无量纲整数，输出中不应出现任何物理单位。", "solution": "我们从二维 Hellinger–Reissner 泛函开始，\n$$\n\\Pi(u,\\sigma) \\;=\\; \\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega \\;-\\; \\tfrac{1}{2}\\int_{\\Omega_e}\\sigma:\\mathbb{C}^{-1}:\\sigma\\,\\mathrm{d}\\Omega \\;-\\; \\int_{\\Gamma_t \\cap \\partial\\Omega_e} t \\cdot u\\,\\mathrm{d}\\Gamma,\n$$\n其中 $u$ 由四节点四边形的双线性形函数插值，$\\sigma$ 在 $\\Sigma_h$ 中作为 $\\sigma(\\xi,\\eta) = P(\\xi,\\eta)\\,\\beta$ 被独立插值，其中 $\\beta$ 是参数向量。在使用工程剪切应变的 Voigt 记法中，我们写作 $\\varepsilon(u) = B(\\xi,\\eta)\\,u_e$，其中 $B(\\xi,\\eta)$ 是等参双线性映射的标准 $3\\times 8$ 应变-位移矩阵，通过形函数对物理坐标的导数构建，即，\n$$\nB(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n\\frac{\\partial N_1}{\\partial x}  0  \\cdots  \\frac{\\partial N_4}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_1}{\\partial y}  \\cdots  0  \\frac{\\partial N_4}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y}  \\frac{\\partial N_1}{\\partial x}  \\cdots  \\frac{\\partial N_4}{\\partial y}  \\frac{\\partial N_4}{\\partial x}\n\\end{bmatrix}.\n$$\n$\\Pi$ 相对于 $u_e$ 和 $\\beta$ 的驻定性得到单元系统\n$$\n\\frac{\\partial \\Pi}{\\partial u_e} \\;=\\; \\int_{\\Omega_e} B(\\xi,\\eta)^\\top \\sigma(\\xi,\\eta)\\,\\mathrm{d}\\Omega \\;-\\; f_e \\;=\\; 0,\n\\qquad\n\\frac{\\partial \\Pi}{\\partial \\beta} \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top \\varepsilon(u)\\,\\mathrm{d}\\Omega \\;-\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top \\mathbb{C}^{-1} P(\\xi,\\eta)\\,\\beta\\,\\mathrm{d}\\Omega \\;=\\; 0.\n$$\n引入\n$$\nG \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top B(\\xi,\\eta)\\,\\mathrm{d}\\Omega,\n\\qquad\nH \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top \\mathbb{C}^{-1} P(\\xi,\\eta)\\,\\mathrm{d}\\Omega,\n$$\n并注意到 $\\sigma(\\xi,\\eta) = P(\\xi,\\eta)\\,\\beta$，我们写出鞍点线性系统\n$$\n\\begin{bmatrix}\n0  G^\\top \\\\\nG  -H\n\\end{bmatrix}\n\\begin{bmatrix}\nu_e \\\\ \\beta\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nf_e \\\\ 0\n\\end{bmatrix}.\n$$\n静力凝聚通过求解 $G u_e - H \\beta = 0 \\Rightarrow \\beta = H^{-1} G u_e$ 来消去 $\\beta$，将其代入第一个分块方程，得到凝聚单元刚度\n$$\nK_e \\;=\\; G^\\top H^{-1} G.\n$$\nBabuška–Brezzi inf–sup 条件\n$$\n\\inf_{\\sigma \\in \\Sigma_h} \\sup_{u \\in \\mathcal{V}_h} \\frac{\\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega}{\\|\\sigma\\|_{0,\\Omega_e}\\,\\|u\\|_{1,\\Omega_e}} \\;\\ge\\; \\beta_0 \\;\\; 0\n$$\n保证了混合有限元的稳定性。在代数上，它要求当 $\\Sigma_h$ 与 $\\mathcal{V}_h$ 配对时，$G$ 在 $\\Sigma_h$ 上具有满列秩，从而使 $G$ 在 $\\Sigma_h^\\top$ 上是单射的，并且 Schur 补 $K_e = G^\\top H^{-1} G$ 是半正定的，其零空间恰好由刚体模态组成。如果该条件被违反，则存在非零的 $u_e$ 使得 $G u_e = 0$，这意味着 $K_e u_e = 0$ 并产生伪零能（沙漏状）模态。\n\n为使这一点更具体，我们考虑 $P(\\xi,\\eta)$ 的两种选择：\n\n1. 一个不稳定的、欠丰富的常应力空间，\n$$\nP_{\\text{const}}(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{bmatrix},\n$$\n因此 $\\beta \\in \\mathbb{R}^3$。在这种情况下，$G$ 是将 $B$ 与常数进行积分，因此其秩不能超过 3。对于具有八个位移自由度的四节点双线性四边形，凝聚刚度 $K_e$ 的秩至多为 3，这意味着其零空间的维度至少为 $8-3=5$。在这五个模态中，恰好有三个对应于刚体运动（两个平移和一个面内旋转），剩下至少两个伪零能模态。这些就是众所周知的沙漏模态：它们是一些位移模式，能在单元上导致三个 Voigt 分量的平均应变为零，因此对于任何常应力场产生的内虚功都为零。这直接表现出对 inf–sup 条件的违反，因为对于非平凡的 $u$ 和应力空间中的任何 $\\sigma$，分子 $\\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega$ 都可以为零，导致 $\\beta_0 = 0$。\n\n2. 一个更具表现力的、具有弱线性变化的五参数应力空间，\n$$\nP_{\\text{lin5}}(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n1  0  0  \\xi  0 \\\\\n0  1  0  0  \\eta \\\\\n0  0  1  0  0\n\\end{bmatrix},\n$$\n因此 $\\beta \\in \\mathbb{R}^5$。在这里，$G$ 的秩增加到至多为 5，对于一个非退化的四边形，$P_{\\text{lin5}}$ 的五列与双线性的 $B$ 非平凡地耦合，因此 $G$ 通常能达到秩 5。因此，$K_e$ 的秩为 5，其零空间的维度为 $8-5=3$，这恰好与刚体模态的数量匹配，没有留下伪模态。这满足了单元上的 inf–sup 条件，且 $\\beta_0  0$。\n\n数值构造按以下步骤进行：\n\n- 使用双线性形函数 $N_i(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi\\xi_i)(1+\\eta\\eta_i)$ 和节点 $(\\xi_i,\\eta_i)\\in\\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$，建立从 $(\\xi,\\eta)\\in[-1,1]^2$ 到物理坐标的等参映射。计算 Jacobi 矩阵 $J(\\xi,\\eta)$ 及其行列式。通过 $J^{-1}$ 从 $\\partial N_i/\\partial \\xi$ 和 $\\partial N_i/\\partial \\eta$ 计算 $\\partial N_i/\\partial x$ 和 $\\partial N_i/\\partial y$。\n\n- 从物理导数构造 $B(\\xi,\\eta)$，并使用 $2\\times 2$ Gauss 积分来计算 $G = \\int P^\\top B\\,\\mathrm{d}\\Omega$ 和 $H = \\int P^\\top \\mathbb{C}^{-1} P\\,\\mathrm{d}\\Omega$，该积分方法对于此处出现的多项式次数（被积函数中最高为二次）是精确的。\n\n- 计算凝聚刚度 $K_e = G^\\top H^{-1} G$。\n\n- 求解特征问题 $K_e \\phi_i = \\lambda_i \\phi_i$，如果特征值 $\\lambda_i  \\varepsilon = 10^{-8} \\lambda_{\\max}$（其中 $\\lambda_{\\max} = \\max_i \\lambda_i$），则将其声明为零。令 $n_0$ 为此类零特征值的数量。在单元上构造刚体模态基，作为 $\\mathbb{R}^8$ 中的三个向量：$x$ 和 $y$ 方向的两个平移（所有节点单位位移），以及一个绕形心 $(\\bar X,\\bar Y)$ 的面内旋转，由节点 $i$ 处的 $u_x = -(Y_i-\\bar Y)$ 和 $u_y = (X_i-\\bar X)$ 给出。令 $N_0$ 为张成零空间（那些具有零特征值）的特征向量矩阵。零空间与刚体模态空间交集的有效维度 $n_{\\text{rbm}}$ 是 $N_0^\\top R$ 的数值秩，其中 $R$ 是 $8\\times 3$ 的刚体基。沙漏模态计数为 $n_{\\text{hg}} = n_0 - n_{\\text{rbm}}$。\n\n将此应用于四个指定的测试：\n\n- 测试用例1（不稳定，正方形），使用 $P_{\\text{const}}$：我们期望 $\\operatorname{rank}(G)=3$，因此 $n_0=5$，沙漏模态数为 $n_{\\text{hg}}=5-3=2$。\n\n- 测试用例2（稳定，正方形），使用 $P_{\\text{lin5}}$：我们期望 $\\operatorname{rank}(G)=5$，因此 $n_0=3$ 且 $n_{\\text{hg}}=0$。\n\n- 测试用例3（不稳定，扭曲），使用 $P_{\\text{const}}$：几何扭曲会改变 $B$ 但不会使 $G$ 的最大秩超过 3，因此 $n_0=5$ 且 $n_{\\text{hg}}=2$ 保持不变。\n\n- 测试用例4（稳定，扭曲），使用 $P_{\\text{lin5}}$：耦合仍然足以使 $\\operatorname{rank}(G)=5$，因此 $n_0=3$ 且 $n_{\\text{hg}}=0$。\n\n因此，该算法为每个测试用例计算沙漏模态数（一个整数）。最终程序在单行中输出一个包含四个整数的 Python 风格列表，即 $[n_{\\text{hg},1},n_{\\text{hg},2},n_{\\text{hg},3},n_{\\text{hg},4}]$。", "answer": "$$\n\\boxed{[2, 0, 2, 0]}\n$$", "id": "2566183"}]}