{"hands_on_practices": [{"introduction": "在塑性力学中，材料的响应取决于其加载历史，因此应力更新不能简单地通过胡克定律完成。我们需要一个被称为“返回映射”的算法，这是计算塑性力学的基石。本练习将引导你完成一个基本案例的推导：一个具有线性各向同性硬化的单轴杆，让你亲手实践这一核心算法 [@problem_id:2570543]。", "problem": "一维杆在小应变和小位移假设下建模，并通过一个具有单个高斯积分点的线性有限元进行离散化。材料为具有线性各向同性硬化的关联率无关弹塑性实体。本构基础包括应变加法分解 $ \\varepsilon = \\varepsilon^{e} + \\varepsilon^{p} $，胡克定律 $ \\sigma = E \\, \\varepsilon^{e} $，以及带有屈服函数 $ f(\\sigma,\\alpha) = |\\sigma| - (\\sigma_{0} + H \\alpha) $ 的塑性 Karush–Kuhn–Tucker (KKT) 条件，其中 $ \\alpha $ 是累积等效塑性应变。流动法则是关联的，因此塑性应变率满足 $ \\dot{\\varepsilon}^{p} = \\dot{\\lambda} \\, \\partial f / \\partial \\sigma $ (其中 $ \\dot{\\lambda} \\ge 0 $)，硬化定律为 $ \\dot{\\alpha} = \\dot{\\lambda} $。\n\n在时间 $ t^{n} $ 时，高斯积分点处的​​状态为无应力且无塑性应变，即 $ \\sigma^{n} = 0 $，$ \\varepsilon^{p,n} = 0 $，$ \\alpha^{n} = 0 $。在一个到位移控制的加载步中，到达时间 $ t^{n+1} $ 时，高斯积分点处的总应变在拉伸作用下单调增加至 $ \\varepsilon^{n+1} = 0.003 $。材料参数为：杨氏模量 $ E = 210~\\text{GPa} $，初始屈服应力 $ \\sigma_{0} = 250~\\text{MPa} $，以及线性各向同性硬化模量 $ H = 1.5~\\text{GPa} $。\n\n仅从所述原理（加法分解、弹性、屈服函数、KKT 条件、关联性和线性各向同性硬化）出发，通过一致性强制返回方法推导此单增量步的应力更新，并计算高斯积分点处更新后的柯西应力 $ \\sigma^{n+1} $。将最终应力以 $ \\text{MPa} $ 为单位表示，并将您的答案四舍五入至四位有效数字。", "solution": "问题陈述有效。这是一个适定的、具有科学依据的计算弹塑性问题，提供了所有必要的数据且无内部矛盾。我们将开始求解。\n\n求解框架是返回映射算法，该算法包括一个弹性预测步，以及在违反屈服准则时进行的一个塑性修正步。所有计算将对应力和模量使用一致的单位，即兆帕（$ \\text{MPa} $），其中 $ E = 210~\\text{GPa} = 2.1 \\times 10^{5}~\\text{MPa} $ 且 $ H = 1.5~\\text{GPa} = 1500~\\text{MPa} $。\n\n首先，我们执行弹性预测步。我们假设整个应变增量 $ \\Delta \\varepsilon $ 都是弹性的。在时间 $ t^{n} $ 的初始状态给定为 $ \\sigma^{n} = 0 $，$ \\varepsilon^{p,n} = 0 $，$ \\alpha^{n} = 0 $。最终总应变为 $ \\varepsilon^{n+1} = 0.003 $。初始总应变 $ \\varepsilon^{n} $ 也为零，因为 $ \\varepsilon^{n} = \\varepsilon^{e,n} + \\varepsilon^{p,n} $ 且 $ \\sigma^n=E\\varepsilon^{e,n}=0 \\implies \\varepsilon^{e,n}=0 $。因此，应变增量为 $ \\Delta\\varepsilon = \\varepsilon^{n+1} - \\varepsilon^n = 0.003 $。\n\n试探应力 $ \\sigma^{\\text{trial}} $ 通过胡克定律计算，假设塑性应变没有变化（$ \\Delta\\varepsilon^p = 0 $）：\n$$ \\sigma^{\\text{trial}} = \\sigma^{n} + E \\Delta\\varepsilon = 0 + (2.1 \\times 10^{5}~\\text{MPa}) \\times 0.003 = 630~\\text{MPa} $$\n\n接下来，我们检查这个试探状态是否违反了屈服条件。屈服函数为 $ f(\\sigma,\\alpha) = |\\sigma| - (\\sigma_{0} + H \\alpha) $。我们使用试探应力和步初的内变量 $ \\alpha^{n} = 0 $ 来评估它：\n$$ f^{\\text{trial}} = f(\\sigma^{\\text{trial}}, \\alpha^{n}) = |\\sigma^{\\text{trial}}| - (\\sigma_{0} + H \\alpha^{n}) = |630| - (250 + 1500 \\times 0) = 380~\\text{MPa} $$\n由于 $ f^{\\text{trial}}  0 $，弹性假设无效，发生了塑性变形。需要一个塑性修正步来强制执行一致性条件，确保最终状态位于屈服面上。\n\n塑性修正步将状态从 $ (\\sigma^{\\text{trial}}, \\alpha^n) $ 更新到最终状态 $ (\\sigma^{n+1}, \\alpha^{n+1}) $，使得 $ f(\\sigma^{n+1}, \\alpha^{n+1}) = 0 $。我们对增量内的流动和硬化法则使用后向欧拉积分方案。\n关联流动法则是 $ \\dot{\\varepsilon}^{p} = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\sigma} $。考虑到是拉伸加载，我们预期 $ \\sigma  0 $，因此 $ f = \\sigma - (\\sigma_{0} + H \\alpha) $ 且 $ \\frac{\\partial f}{\\partial \\sigma} = 1 $。\n硬化定律为 $ \\dot{\\alpha} = \\dot{\\lambda} $。\n在该步上积分，我们得到塑性应变和硬化变量的增量：\n$$ \\Delta\\varepsilon^{p} = \\varepsilon^{p,n+1} - \\varepsilon^{p,n} = \\Delta\\lambda \\frac{\\partial f}{\\partial \\sigma}\\bigg|_{n+1} = \\Delta\\lambda \\cdot \\text{sgn}(\\sigma^{n+1}) $$\n$$ \\Delta\\alpha = \\alpha^{n+1} - \\alpha^{n} = \\Delta\\lambda $$\n由于加载是拉伸的（$ \\sigma^{\\text{trial}}  0 $），最终应力 $ \\sigma^{n+1} $ 也必须为正。因此，$ \\text{sgn}(\\sigma^{n+1})=1 $，这得出 $ \\Delta\\varepsilon^{p} = \\Delta\\lambda $。\n根据初始条件 $ \\varepsilon^{p,n} = 0 $ 和 $ \\alpha^{n} = 0 $，我们有：\n$$ \\varepsilon^{p,n+1} = \\Delta\\lambda $$\n$$ \\alpha^{n+1} = \\Delta\\lambda $$\n更新后的应力 $ \\sigma^{n+1} $ 与试探应力相关。根据胡克定律，$ \\sigma^{n+1} = E \\varepsilon^{e,n+1} = E (\\varepsilon^{n+1} - \\varepsilon^{p,n+1}) $。\n代入 $ \\varepsilon^{p,n+1} = \\Delta\\lambda $ 并注意到 $ \\sigma^{\\text{trial}} = E \\varepsilon^{n+1} $：\n$$ \\sigma^{n+1} = E \\varepsilon^{n+1} - E \\Delta\\lambda = \\sigma^{\\text{trial}} - E \\Delta\\lambda $$\n这是“返回”方程，将应力从试探点映射回屈服面。最终状态必须满足塑性一致性条件 $ f(\\sigma^{n+1}, \\alpha^{n+1}) = 0 $：\n$$ |\\sigma^{n+1}| - (\\sigma_{0} + H \\alpha^{n+1}) = 0 $$\n由于 $ \\sigma^{n+1}  0 $，这可以简化为：\n$$ \\sigma^{n+1} - \\sigma_{0} - H \\alpha^{n+1} = 0 \\implies \\sigma^{n+1} = \\sigma_{0} + H \\Delta\\lambda $$\n我们现在得到了一个关于两个未知数 $ \\sigma^{n+1} $ 和 $ \\Delta\\lambda $ 的方程组：\n$$ \\sigma^{n+1} = \\sigma^{\\text{trial}} - E \\Delta\\lambda $$\n$$ \\sigma^{n+1} = \\sigma_{0} + H \\Delta\\lambda $$\n将这些表达式相等，可以解出一致性参数 $ \\Delta\\lambda $：\n$$ \\sigma^{\\text{trial}} - E \\Delta\\lambda = \\sigma_{0} + H \\Delta\\lambda $$\n$$ \\sigma^{\\text{trial}} - \\sigma_{0} = (E + H) \\Delta\\lambda $$\n$$ \\Delta\\lambda = \\frac{\\sigma^{\\text{trial}} - \\sigma_{0}}{E + H} = \\frac{f^{\\text{trial}}}{E+H} $$\n现在我们代入数值：\n$$ \\Delta\\lambda = \\frac{630~\\text{MPa} - 250~\\text{MPa}}{2.1 \\times 10^{5}~\\text{MPa} + 1500~\\text{MPa}} = \\frac{380}{211500} \\approx 0.00179669 $$\n最后，我们使用最直接的关系式计算更新后的应力 $ \\sigma^{n+1} $：\n$$ \\sigma^{n+1} = \\sigma_{0} + H \\Delta\\lambda = 250~\\text{MPa} + 1500~\\text{MPa} \\times \\left( \\frac{380}{211500} \\right) $$\n$$ \\sigma^{n+1} = 250 + \\frac{570000}{211500} = 250 + 2.69503546... \\approx 252.695035...~\\text{MPa} $$\n问题要求答案以 $ \\text{MPa} $ 为单位表示，并四舍五入至四位有效数字。\n$$ \\sigma^{n+1} \\approx 252.7~\\text{MPa} $$\n这个结果在物理上是合理的：由于硬化，最终应力大于初始屈服应力 $ \\sigma_{0} = 250~\\text{MPa} $，但由于塑性流动，它显著小于试探应力 $ \\sigma^{\\text{trial}} = 630~\\text{MPa} $。", "answer": "$$\\boxed{252.7}$$", "id": "2570543"}, {"introduction": "各向同性硬化模型假设屈服面只会在应力空间中均匀扩大，但这无法描述鲍辛格效应等现象，即材料在反向加载时会提前屈服。为了捕捉这种行为，我们引入了随动硬化，它允许屈服面在应力空间中平移。本练习是一个思想实验，旨在通过构建一个特定的应力路径，让你直观地理解背应力如何导致反向屈服，并决定塑性流动的方向 [@problem_id:2570566]。", "problem": "考虑一个经历小应变的固体，其在三维空间中通过有限元法 (FEM) 中使用的标准弹塑性本构更新进行建模。采用带有运动硬化的 von Mises（也称为第二偏应力不变量，$J_{2}$）屈服条件。总柯西应力张量表示为 $\\boldsymbol{\\sigma}$，其偏量部分为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$。背应力张量为 $\\boldsymbol{\\alpha}$（根据其构造为偏量），单轴拉伸下的屈服应力为常数 $\\sigma_{y}$。\n\n从一个由单调单轴拉伸产生的先前已塑性化的状态开始，假设在反向加载之前瞬间，主基下的背应力已知，且为对角矩阵，其主值为\n$$\n\\boldsymbol{\\alpha} = \\operatorname{diag}(100,\\,-50,\\,-50)\\ \\text{MPa},\n$$\n且屈服应力为 $\\sigma_{y} = 300\\ \\text{MPa}$。现在，您在主应力空间中指定一个由下式定义的应力控制路径\n$$\n\\boldsymbol{\\sigma}(t) = \\operatorname{diag}(\\sigma_{a}(t),\\,0,\\,0),\n$$\n其中 $\\sigma_{a}(t)$ 从一个正值单调减小，经过零，并变为负值（反向加载）。\n\n仅使用以下基本要素：\n- 偏量分解 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$，\n- 带有运动平移的 von Mises 屈服函数 $f(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) = \\sqrt{\\tfrac{3}{2}}\\,\\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| - \\sigma_{y}$，\n- 塑性应变的相关流动（正交）法则，\n\n完成以下任务：\n\n1) 在主应力空间中显式地构建反向加载路径，并证明它在一个压缩主应力 $\\sigma_{a}  0$ 处与平移后的屈服面相交（反向屈服）。通过在路径上强制 $f=0$ 来确定该反向屈服主应力 $\\sigma_{a}$。\n\n2) 在反向屈服的瞬间，计算塑性应变增量方向，该方向被理解为主应力空间中活动点处屈服面的单位法向。将您的答案表示为塑性应变增量方向主分量的单位向量。您必须只报告此单位向量。将最终的方向向量表示为主基下的无量纲分量。无需四舍五入；提供精确表达式。", "solution": "我们从带有运动硬化的小应变 $J_{2}$ 塑性理论的核心定义开始。带有背应力平移的屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\;=\\; \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| \\;-\\; \\sigma_{y},\n$$\n其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$ 是偏应力。塑性加载要求 $f=0$ 和 $\\dot{\\lambda} \\ge 0$，相关流动（正交）法则给出塑性应变率为\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^{p} \\;=\\; \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}.\n$$\n通过对 $f$ 微分，利用 $\\boldsymbol{s}$ 是 $\\boldsymbol{\\sigma}$ 的偏量投影以及 $\\boldsymbol{\\alpha}$ 是偏量，我们得到\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\;=\\; \\frac{3}{2}\\,\\frac{\\boldsymbol{s}-\\boldsymbol{\\alpha}}{\\|\\boldsymbol{s}-\\boldsymbol{\\alpha}\\|},\n$$\n因此塑性应变增量方向与 $\\boldsymbol{s}-\\boldsymbol{\\alpha}$ 共线（精确的标量因子对方向而言无关紧要）。因此，屈服时主基下塑性应变增量的单位方向是沿着 $\\boldsymbol{\\eta} := \\boldsymbol{s}-\\boldsymbol{\\alpha}$ 的单位向量。\n\n我们现在构建指定的路径并确定反向屈服点。\n\n1) 路径构建与反向屈服点。主应力路径为\n$$\n\\boldsymbol{\\sigma}(t) \\;=\\; \\operatorname{diag}(\\sigma_{a}(t),\\,0,\\,0),\n$$\n其中 $\\sigma_{a}(t)$ 从正值减小到负值。其偏量部分由下式得到\n$$\n\\operatorname{tr}(\\boldsymbol{\\sigma}) \\;=\\; \\sigma_{a}, \n\\qquad\n\\boldsymbol{s} \\;=\\; \\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I},\n$$\n因此在主基下\n$$\n\\boldsymbol{s} \\;=\\; \\operatorname{diag}\\!\\Big(\\frac{2}{3}\\sigma_{a},\\,-\\frac{1}{3}\\sigma_{a},\\,-\\frac{1}{3}\\sigma_{a}\\Big).\n$$\n利用给定的背应力\n$$\n\\boldsymbol{\\alpha} \\;=\\; \\operatorname{diag}(100,\\,-50,\\,-50)\\ \\text{MPa},\n$$\n相对偏应力为\n$$\n\\boldsymbol{\\eta} \\;=\\; \\boldsymbol{s} - \\boldsymbol{\\alpha}\n\\;=\\;\n\\operatorname{diag}\\!\\Big(\\frac{2}{3}\\sigma_{a} - 100,\\,-\\frac{1}{3}\\sigma_{a} + 50,\\,-\\frac{1}{3}\\sigma_{a} + 50\\Big)\\ \\text{MPa}.\n$$\n路径上的屈服条件为\n$$\nf(\\sigma_{a}) \\;=\\; \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{\\eta}\\| \\;-\\; \\sigma_{y} \\;=\\; 0,\n\\qquad \\sigma_{y} \\;=\\; 300\\ \\text{MPa}.\n$$\n在主基下计算 $\\boldsymbol{\\eta}$ 的欧几里得范数：\n$$\n\\|\\boldsymbol{\\eta}\\|^{2}\n\\;=\\;\n\\Big(\\frac{2}{3}\\sigma_{a} - 100\\Big)^{2}\n\\;+\\;\n\\Big(-\\frac{1}{3}\\sigma_{a} + 50\\Big)^{2}\n\\;+\\;\n\\Big(-\\frac{1}{3}\\sigma_{a} + 50\\Big)^{2}.\n$$\n检验向量 $\\boldsymbol{\\eta}$ 在屈服时是否能与一个简单的偏量方向成比例是方便的。假设 $\\boldsymbol{\\eta}$ 与 $\\operatorname{diag}(-1,\\,\\tfrac{1}{2},\\,\\tfrac{1}{2})$ 成比例，即，令\n$$\n\\boldsymbol{\\eta} \\;=\\; -k\\,\\operatorname{diag}\\!\\Big(1,\\,-\\tfrac{1}{2},\\,-\\tfrac{1}{2}\\Big)\n\\;=\\;\n\\operatorname{diag}(-k,\\,\\tfrac{k}{2},\\,\\tfrac{k}{2}),\n\\qquad k0,\n$$\n这表示一个与反向加载一致的压缩的第一主分量。匹配各分量可得\n$$\n\\frac{2}{3}\\sigma_{a} - 100 \\;=\\; -k,\n\\qquad\n-\\frac{1}{3}\\sigma_{a} + 50 \\;=\\; \\frac{k}{2}.\n$$\n这两个方程对任何 $\\sigma_{a}$ 都是相容的。将第一个方程重排为 $k=100-\\frac{2}{3}\\sigma_a$，代入第二个方程 $-\\frac{1}{3}\\sigma_a+50 = k/2$ 会得到一个恒等式。因此，在我们的路径上，一个 $(\\sigma_{a},k)$ 族实现了相同的方向。在这个族中，$\\boldsymbol{\\eta}$ 的范数为\n$$\n\\|\\boldsymbol{\\eta}\\|\n\\;=\\;\n\\sqrt{(-k)^{2} + \\Big(\\frac{k}{2}\\Big)^{2} + \\Big(\\frac{k}{2}\\Big)^{2}}\n\\;=\\;\n\\sqrt{\\frac{3}{2}}\\,k.\n$$\n强制执行屈服条件 $\\sqrt{\\tfrac{3}{2}}\\|\\boldsymbol{\\eta}\\| = \\sigma_{y}$ 给出\n$$\n\\sqrt{\\frac{3}{2}}\\,\\Big(\\sqrt{\\frac{3}{2}}\\,k\\Big) \\;=\\; \\sigma_{y}\n\\;\\;\\Rightarrow\\;\\;\n\\frac{3}{2}\\,k \\;=\\; \\sigma_{y}\n\\;\\;\\Rightarrow\\;\\;\nk \\;=\\; \\frac{2}{3}\\,\\sigma_{y} \\;=\\; \\frac{2}{3}\\cdot 300 \\;=\\; 200\\ \\text{MPa}.\n$$\n从 $\\tfrac{2}{3}\\sigma_{a} - 100 = -k = -200$ 解出反向屈服应力，得到\n$$\n\\frac{2}{3}\\sigma_{a} \\;=\\; -100\n\\;\\;\\Rightarrow\\;\\;\n\\sigma_{a} \\;=\\; -150\\ \\text{MPa},\n$$\n这证实了由于背应力平移，反向屈服发生在一个压缩应力下。此时，\n$$\n\\boldsymbol{\\eta} \\;=\\; \\operatorname{diag}(-200,\\,100,\\,100)\\ \\text{MPa}.\n$$\n\n2) 反向屈服时的塑性应变增量方向。根据相关流动法则，塑性应变增量方向与 $\\partial f / \\partial \\boldsymbol{\\sigma}$ 共线，也就是与 $\\boldsymbol{\\eta}$ 共线。因此，所求的主基下的单位方向向量为\n$$\n\\widehat{\\boldsymbol{n}}_{p}\n\\;=\\;\n\\frac{\\boldsymbol{\\eta}}{\\|\\boldsymbol{\\eta}\\|}\n\\;=\\;\n\\frac{1}{\\sqrt{(-200)^{2} + 100^{2} + 100^{2}}}\\,\\big(-200,\\,100,\\,100\\big)\n\\;=\\;\n\\frac{1}{100\\sqrt{6}}\\,\\big(-200,\\,100,\\,100\\big)\n\\;=\\;\n\\Big(-\\frac{2}{\\sqrt{6}},\\,\\frac{1}{\\sqrt{6}},\\,\\frac{1}{\\sqrt{6}}\\Big).\n$$\n该单位向量即为沿着所构建的路径，在反向屈服瞬间，塑性应变增量的无量纲主分量方向。注意，任何标量乘子，例如来自 $\\partial f/\\partial \\boldsymbol{\\sigma}$ 的 $\\tfrac{3}{2}$，在归一化时都会被抵消，只留下方向。", "answer": "$$\\boxed{\\begin{pmatrix}-\\dfrac{2}{\\sqrt{6}}  \\dfrac{1}{\\sqrt{6}}  \\dfrac{1}{\\sqrt{6}}\\end{pmatrix}}$$", "id": "2570566"}, {"introduction": "真实的工程材料在循环加载下通常表现出各向同性硬化和随动硬化的复杂组合。Chaboche模型是描述这种行为的强大工具，尤其擅长预测棘轮效应——即在非对称循环加载下塑性应变的逐周期累积。本练习是一个综合性的实践，要求你通过编写代码来实现一个完整的应力更新算法，从而从理论走向实践，模拟并量化这种重要的循环塑性现象 [@problem_id:2570605]。", "problem": "考虑一个单轴材料点，其本构关系由小应变关联塑性控制，采用 von Mises（偏应力第二不变量 J2）型屈服条件、包含两个背应力分量的 Chaboche 型组合各向同性-随动硬化，并施加应力控制。令总应变为 $\\varepsilon$，弹性应变为 $\\varepsilon^{e}$，塑性应变为 $\\varepsilon^{p}$。线性弹性关系成立，杨氏模量为 $E$，因此 $\\sigma = E \\left( \\varepsilon - \\varepsilon^{p} \\right)$，其中 $\\sigma$ 是柯西应力。单轴屈服函数为\n$$\nf = \\left| \\sigma - \\alpha \\right| - \\left( \\sigma_{y0} + R \\right),\n$$\n其中 $\\sigma_{y0}$ 是初始屈服应力，$\\alpha = \\alpha_{1} + \\alpha_{2}$ 是两个背应力分量之和，$R$ 是各向同性硬化变量。塑性乘子增量为 $d p \\ge 0$ 的关联流动给出的塑性应变增量为 $d \\varepsilon^{p} = d p \\, \\text{sign}\\!\\left( \\sigma - \\alpha \\right)$。两项 Chaboche 随动硬化法则和 Voce 型各向同性硬化法则的率形式假定为\n$$\nd \\alpha_{i} = \\frac{2}{3} C_{i} \\, d p \\, \\text{sign}\\!\\left( \\sigma - \\alpha \\right) - \\gamma_{i} \\, \\alpha_{i} \\, d p \\quad \\text{for } i \\in \\{1,2\\},\n$$\n$$\nd R = b \\left( Q - R \\right) d p,\n$$\n其中材料参数 $C_{i}  0$，$\\gamma_{i} \\ge 0$，$b \\ge 0$，$Q \\ge 0$。应力被规定为一个周期内随时间变化的函数，形式为一个具有非零均值的正弦波，\n$$\n\\sigma(t) = \\sigma_{m} + \\sigma_{a} \\sin \\left( \\omega t \\right),\n$$\n其中 $\\sigma_{m}$ 是平均应力，$\\sigma_{a}$ 是幅值，$\\omega$ 是角频率。所有角度均以弧度为单位。\n\n从周期开始时的原始状态（即 $\\varepsilon^{p}(0) = 0$，$\\alpha_{1}(0) = 0$，$\\alpha_{2}(0) = 0$ 和 $R(0) = 0$）出发，使用 $N$ 个均匀子步的应力控制更新，对本构方程进行整整一个周期 $T = \\frac{2\\pi}{\\omega}$ 的数值积分，并计算每周期净塑性应变累积\n$$\n\\Delta \\varepsilon^{p}_{\\text{cycle}} = \\varepsilon^{p}(T) - \\varepsilon^{p}(0).\n$$\n在塑性步中，您必须对内变量 $\\alpha_{i}$ 和 $R$ 使用无条件稳定的后向欧拉离散化，在每个子步结束时强制满足屈服条件，并一致地处理弹塑性转换。流动方向 $\\text{sign}\\!\\left( \\sigma - \\alpha \\right)$ 必须在每个子步内保持一致使用。\n\n您的程序必须：\n- 在每个应力控制的子步中实现一个鲁棒的标量返回映射算法，对于塑性子步，通过求解关于塑性乘子增量 $\\Delta p$ 的单个非线性方程，以强制在子步结束时满足 $f_{n+1} = 0$。\n- 对 $\\Delta p$ 使用一个有保障的求根过程，确保对所有测试用例都能收敛。可接受使用二分法的区间法或有保障的牛顿法。\n- 用 $N$ 个均匀步长离散化一个周期，并将带符号的塑性增量求和以累积 $\\Delta \\varepsilon^{p}_{\\text{cycle}}$。\n\n物理单位和数值精度要求：\n- 应力 $\\sigma$、$\\sigma_{y0}$、$C_{i}$ 和 $Q$ 的单位是兆帕 (MPa)。\n- 应变 $\\varepsilon$、$\\varepsilon^{p}$ 和 $\\Delta \\varepsilon^{p}_{\\text{cycle}}$ 是无量纲的。\n- 角频率 $\\omega$ 的单位是弧度/秒，时间 $t$ 的单位是秒。\n- 将最终答案表示为无量纲浮点数，并精确到六位小数。\n\n测试套件和参数：\n对于每个测试用例，材料参数和加载条件规定如下。所有用例均使用 $T = 1$ 秒（即 $\\omega = 2\\pi$ 弧度/秒）和每周期 $N = 4000$ 个子步。\n\n- 测试用例 1 (平均应力下的普遍棘轮效应)：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa。\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$。\n  - $b = 5$, $Q = 100$ MPa。\n  - $\\sigma_{m} = 150$ MPa, $\\sigma_{a} = 150$ MPa, $\\omega = 2\\pi$ rad/s。\n\n- 测试用例 2 (弹性参考，无塑性)：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa。\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$。\n  - $b = 5$, $Q = 100$ MPa。\n  - $\\sigma_{m} = 100$ MPa, $\\sigma_{a} = 50$ MPa, $\\omega = 2\\pi$ rad/s。\n\n- 测试用例 3 (每半周期的单边塑性；预期有净棘轮效应)：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa。\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$。\n  - $b = 5$, $Q = 100$ MPa。\n  - $\\sigma_{m} = 230$ MPa, $\\sigma_{a} = 60$ MPa, $\\omega = 2\\pi$ rad/s。\n\n- 测试用例 4 (更强的各向同性硬化对棘轮效应的影响)：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa。\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$。\n  - $b = 30$, $Q = 200$ MPa。\n  - $\\sigma_{m} = 230$ MPa, $\\sigma_{a} = 60$ MPa, $\\omega = 2\\pi$ rad/s。\n\n所有测试用例的初始条件均为 $\\varepsilon^{p}(0) = 0$，$\\alpha_{1}(0) = 0$，$R(0) = 0$。\n\n从时间 $t_{n}$ 到 $t_{n+1}$ 的单个子步的算法要求：\n- 给定规定的 $\\sigma_{n+1}$ 和前一状态 $\\left( \\varepsilon^{p}_{n}, \\alpha_{1,n}, \\alpha_{2,n}, R_{n} \\right)$，首先计算试探屈服函数 $f_{\\text{trial}} = \\left| \\sigma_{n+1} - \\alpha_{n} \\right| - \\left( \\sigma_{y0} + R_{n} \\right)$，其中 $\\alpha_{n} = \\alpha_{1,n} + \\alpha_{2,n}$。\n- 如果 $f_{\\text{trial}} \\le 0$，则该步为弹性步，状态不变。\n- 如果 $f_{\\text{trial}}  0$，确定流动方向 $s = \\text{sign}\\!\\left( \\sigma_{n+1} - \\alpha_{n} \\right)$，并求解塑性乘子增量 $\\Delta p \\ge 0$，该增量通过后向欧拉更新强制在步末满足屈服条件：\n  - $\\alpha_{i,n+1} = \\dfrac{ \\alpha_{i,n} + \\dfrac{2}{3} C_{i} \\, s \\, \\Delta p }{ 1 + \\gamma_{i} \\Delta p }$ (对于 $i \\in \\{1,2\\}$)，\n  - $R_{n+1} = \\dfrac{ R_{n} + b Q \\, \\Delta p }{ 1 + b \\Delta p }$,\n  - 强制满足 $\\left| \\sigma_{n+1} - \\alpha_{n+1} \\right| - \\left( \\sigma_{y0} + R_{n+1} \\right) = 0$，其中 $\\alpha_{n+1} = \\alpha_{1,n+1} + \\alpha_{2,n+1}$。\n  - 更新 $\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + s \\, \\Delta p$。\n\n数值公差必须足够严格，以确保最终四舍五入到六位小数是有意义的。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\left[ r_{1}, r_{2}, r_{3}, r_{4} \\right]$），其中每个 $r_{k}$ 是测试用例 $k$ 计算出的 $\\Delta \\varepsilon^{p}_{\\text{cycle}}$，四舍五入到六位小数。", "solution": "所述问题是有效的。它在计算固体力学领域提出了一个适定的、有科学依据的任务。该问题客观、完整，且不包含任何矛盾。问题要求在规定的应力循环下，对一个包含 Chaboche 型组合各向同性-随动硬化的标准单轴弹塑性本构模型进行数值积分。所有必要的材料参数、加载条件、初始条件和算法规范均已提供，从而可以得到唯一且有意义的解。\n\n求解过程涉及模拟材料在整个加载周期内的响应，该周期被离散为大量均匀的时间子步。对于每个子步，执行一次应力控制的更新。算法的核心是返回映射程序，任何导致塑性变形的子步都会调用该程序。\n\n材料点由其状态变量定义：塑性应变 $\\varepsilon^{p}$、两个背应力分量 $\\alpha_{1}$ 和 $\\alpha_{2}$，以及一个各向同性硬化变量 $R$。初始状态为原始状态，意味着所有这些变量在时间 $t=0$ 时均为零。\n\n在从时间 $t_{n}$ 到 $t_{n+1}$ 的每个子步中，应力 $\\sigma_{n+1} = \\sigma(t_{n+1})$ 是已知的。$t_{n}$ 时的状态，记为 $(\\varepsilon^{p}_{n}, \\alpha_{1,n}, \\alpha_{2,n}, R_{n})$，也是已知的。$t_{n}$ 时的总背应力为 $\\alpha_{n} = \\alpha_{1,n} + \\alpha_{2,n}$。\n\n首先，假设一个弹性试探步。使用上一步的状态来评估试探屈服函数 $f_{\\text{trial}}$：\n$$\nf_{\\text{trial}} = \\left| \\sigma_{n+1} - \\alpha_{n} \\right| - \\left( \\sigma_{y0} + R_{n} \\right)\n$$\n如果 $f_{\\text{trial}} \\le 0$，则假设正确：该步为弹性步。内部状态变量不发生演化。\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n}, \\quad \\alpha_{i,n+1} = \\alpha_{i,n}, \\quad R_{n+1} = R_{n}\n$$\n\n如果 $f_{\\text{trial}}  0$，则该步涉及塑性变形。$t_{n+1}$ 时的状态必须满足屈服条件 $f_{n+1}=0$。我们必须找到一致的塑性乘子增量 $\\Delta p  0$。塑性应变增量为 $d\\varepsilon^{p} = d p \\, \\text{sign}(\\sigma - \\alpha)$。内变量的演化由率方程控制，为保证无条件稳定性，使用隐式后向欧拉格式进行积分。\n\n子步的流动方向由试探状态确定：\n$$\ns = \\text{sign}\\!\\left( \\sigma_{n+1} - \\alpha_{n} \\right)\n$$\n内变量的后向欧拉离散更新法则是：\n$$\n\\alpha_{i,n+1} = \\frac{ \\alpha_{i,n} + \\frac{2}{3} C_{i} \\, s \\, \\Delta p }{ 1 + \\gamma_{i} \\Delta p } \\quad \\text{for } i \\in \\{1,2\\}\n$$\n$$\nR_{n+1} = \\frac{ R_{n} + b Q \\, \\Delta p }{ 1 + b \\Delta p }\n$$\n步末的总背应力为 $\\alpha_{n+1} = \\alpha_{1,n+1} + \\alpha_{2,n+1}$。$t_{n+1}$ 时的屈服条件成为一个关于 $\\Delta p$ 的非线性标量方程：\n$$\ng(\\Delta p) = \\left| \\sigma_{n+1} - \\alpha_{n+1}(\\Delta p) \\right| - \\left( \\sigma_{y0} + R_{n+1}(\\Delta p) \\right) = 0\n$$\n由于流动方向 $s$ 是固定的，这可以写成不带绝对值的形式：\n$$\ng(\\Delta p) = s \\left( \\sigma_{n+1} - \\sum_{i=1}^{2} \\frac{ \\alpha_{i,n} + \\frac{2}{3} C_{i} \\, s \\, \\Delta p }{ 1 + \\gamma_{i} \\Delta p } \\right) - \\left( \\sigma_{y0} + \\frac{ R_{n} + b Q \\, \\Delta p }{ 1 + b \\Delta p } \\right) = 0\n$$\n这个关于 $\\Delta p$ 的函数必须被求解。在 $\\Delta p=0$ 时，我们有 $g(0) = f_{\\text{trial}}  0$。可以证明，在物理上合理的假设下（特别是，动态恢复项不超过线性硬化项，这是模型稳定性的一个条件），导数 $g'(\\Delta p)$ 是严格为负的。这种单调递减保证了 $\\Delta p$ 存在唯一的正根，前提是材料模型能够达到该应力水平。\n\n一个鲁棒的数值求根方法，例如 Brent 方法，适用于求解 $g(\\Delta p) = 0$。这需要为根找到一个区间。我们知道根大于 0，所以下界是 $a=0$。可以通过从一个小值开始并逐渐增大直到 $g(b)$ 变为负值来找到上界 $b$。\n\n一旦找到正确的 $\\Delta p$，就使用上面的后向欧拉方程更新状态变量。塑性应变被累积：\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + s \\, \\Delta p\n$$\n在周期 $T=1$ 秒的整个循环中，对 $N=4000$ 个子步重复此过程。每个测试用例的最终结果是周期内的净累积塑性应变 $\\Delta\\varepsilon^{p}_{\\text{cycle}} = \\varepsilon^{p}(T)$。\n\n该实现将针对所提供的四个测试用例中的每一个，使用指定的材料和加载参数，遵循这一逻辑。最终结果按要求四舍五入到六位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Chaboche hardening problem for the specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (general ratcheting)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 5.0, \"Q\": 100.0,\n            \"sigma_m\": 150.0, \"sigma_a\": 150.0,\n        },\n        # Test case 2 (elastic reference)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 5.0, \"Q\": 100.0,\n            \"sigma_m\": 100.0, \"sigma_a\": 50.0,\n        },\n        # Test case 3 (unilateral plasticity)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 5.0, \"Q\": 100.0,\n            \"sigma_m\": 230.0, \"sigma_a\": 60.0,\n        },\n        # Test case 4 (stronger isotropic hardening)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 30.0, \"Q\": 200.0,\n            \"sigma_m\": 230.0, \"sigma_a\": 60.0,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_ratcheting(**params)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef compute_ratcheting(E, sig_y0, C1, gamma1, C2, gamma2, b, Q, sigma_m, sigma_a):\n    \"\"\"\n    Numerically integrates the constitutive model over one cycle.\n\n    Args:\n        E (float): Young's modulus\n        sig_y0 (float): Initial yield stress\n        C1, gamma1 (float): Parameters for backstress component 1\n        C2, gamma2 (float): Parameters for backstress component 2\n        b, Q (float): Parameters for isotropic hardening\n        sigma_m, sigma_a (float): Mean stress and stress amplitude\n\n    Returns:\n        float: Net plastic strain accumulation over one cycle.\n    \"\"\"\n    N = 4000\n    T = 1.0\n    omega = 2.0 * np.pi / T\n    dt = T / N\n\n    # Initial conditions\n    eps_p = 0.0\n    alpha1 = 0.0\n    alpha2 = 0.0\n    R = 0.0\n    \n    times = np.linspace(dt, T, N)\n    \n    for t_np1 in times:\n        sigma_np1 = sigma_m + sigma_a * np.sin(omega * t_np1)\n        \n        # State at step n (current state)\n        eps_p_n, alpha1_n, alpha2_n, R_n = eps_p, alpha1, alpha2, R\n        alpha_n = alpha1_n + alpha2_n\n        \n        # Trial yield function\n        f_trial = np.abs(sigma_np1 - alpha_n) - (sig_y0 + R_n)\n        \n        if f_trial = 1e-9: # Elastic step (with tolerance)\n            # State remains unchanged\n            eps_p_np1, alpha1_np1, alpha2_np1, R_np1 = eps_p_n, alpha1_n, alpha2_n, R_n\n        else: # Plastic step\n            s = np.sign(sigma_np1 - alpha_n)\n            \n            # Define the residual function for the return mapping\n            def residual(dp):\n                # Calculate updated state variables based on dp\n                a1_np1 = (alpha1_n + (2.0/3.0) * C1 * s * dp) / (1.0 + gamma1 * dp)\n                a2_np1 = (alpha2_n + (2.0/3.0) * C2 * s * dp) / (1.0 + gamma2 * dp)\n                R_np1_val = (R_n + b * Q * dp) / (1.0 + b * dp)\n                \n                alpha_np1_val = a1_np1 + a2_np1\n                \n                # Enforce yield condition at the end of the step\n                return s * (sigma_np1 - alpha_np1_val) - (sig_y0 + R_np1_val)\n\n            # Find a bracket for the root-finder\n            a_bracket, b_bracket = 0.0, 1e-6\n            try:\n                while residual(b_bracket) > 0:\n                    b_bracket *= 2.0\n                    if b_bracket > 1.0: # Safeguard against infinite loops\n                        raise RuntimeError(\"Failed to find root bracket below dp=1.0\")\n            except Exception as e:\n                # Can happen if residual is always positive, indicates issue in model/params\n                print(f\"Error finding bracket for brentq: {e}\")\n                dp = 0 # Assume no plastic step if bracket is not found\n            \n            # Solve for plastic multiplier increment dp\n            if residual(b_bracket) = 0:\n                dp = brentq(residual, a_bracket, b_bracket, xtol=1e-12, rtol=1e-12)\n            else: # Fallback if bracketing failed\n                dp = 0.0\n\n\n            # Update state variables with the found dp\n            alpha1_np1 = (alpha1_n + (2.0/3.0) * C1 * s * dp) / (1.0 + gamma1 * dp)\n            alpha2_np1 = (alpha2_n + (2.0/3.0) * C2 * s * dp) / (1.0 + gamma2 * dp)\n            R_np1 = (R_n + b * Q * dp) / (1.0 + b * dp)\n            eps_p_np1 = eps_p_n + s * dp\n            \n        # Update state for the next step\n        eps_p, alpha1, alpha2, R = eps_p_np1, alpha1_np1, alpha2_np1, R_np1\n        \n    return eps_p\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2570605"}]}