{"hands_on_practices": [{"introduction": "在增量返回映射算法中，首要的决策是区分弹性步骤和塑性步骤。理论上，这仅涉及检查试探屈服函数 $f^{\\text{trial}}$ 的符号，但在有限精度计算中，一个微不足道的正值可能由舍入误差引起，导致伪塑性或全局牛顿迭代收敛性的丧失。本实践练习 [@problem_id:2673914] 探讨了如何设计一个在数值上稳健的准则，以可靠地处理试探状态接近屈服面的模糊情况，从而增强算法的稳定性和效率。", "problem": "一个各向同性小应变弹塑性实体遵循 Prandtl-Reuss 方程（采用 von Mises $J_2$ 屈服准则的关联流动法则）和线性各向同性硬化。设 Cauchy 应力为 $\\boldsymbol{\\sigma}$，偏应力为 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}) \\mathbf{I}$，塑性乘子增量为 $\\Delta \\gamma \\ge 0$，累积塑性应变为 $\\alpha \\ge 0$。屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\alpha) = \\sqrt{\\tfrac{3}{2}} \\, \\|\\mathbf{s}\\| - \\sigma_y - H' \\alpha,\n$$\n其中初始屈服应力 $\\sigma_y > 0$，硬化模量 $H' \\ge 0$。一个标准的隐式返回映射算法通过一个弹性试探预测器进行，该预测器使用应变增量以及弹性模量 $K$ 和 $G$ 来计算试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{trial}}$ 和试探屈服函数\n$$\nf^{\\mathrm{trial}} = f(\\boldsymbol{\\sigma}^{\\mathrm{trial}}, \\alpha_n).\n$$\n互补条件即 Karush-Kuhn-Tucker (KKT) 条件：$f \\le 0$，$\\Delta \\gamma \\ge 0$ 和 $\\Delta \\gamma \\, f = 0$。在精确算术中，如果 $f^{\\mathrm{trial}} \\le 0$，则该步为弹性步，且 $\\Delta \\gamma = 0$；如果 $f^{\\mathrm{trial}} > 0$，则该步为塑性步，且 $\\Delta \\gamma > 0$，并在该步结束时满足 $f = 0$。\n\n在有限精度算术中，当 $f^{\\mathrm{trial}}$ 接近于零时，仅根据 $f^{\\mathrm{trial}}$ 的符号进行简单的分类可能导致错误分类、非物理的负塑性乘子、伪塑性或在耦合的牛顿迭代中丧失二次收敛性。考虑到 $f^{\\mathrm{trial}}$ 具有应力单位，并且弹性预测器通过剪切模量 $G$ 将 $\\mathbf{s}^{\\mathrm{trial}}$ 与偏应变增量关联起来。请你根据 KKT 条件以及 $J_2$ 塑性线性各向同性硬化返回映射的结构进行推理，以确定使弹性与塑性决策在浮点舍入、步长和应力尺度方面具有稳健性的准则。\n\n当 $f^{\\mathrm{trial}}$ 接近于零时，以下哪些策略是区分弹性步和塑性步的合理且稳健的方法？\n\nA. 仅根据在双精度下计算的 $f^{\\mathrm{trial}}$ 的符号进行分类：如果 $f^{\\mathrm{trial}} > 0$，则声明为塑性步，否则为弹性步。不使用任何容差、缩放或额外的检查。\n\nB. 对屈服函数使用组合的绝对-相对容差，并对塑性乘子设置阈值：定义一个与问题应力量级相当的应力尺度 $\\sigma_{\\mathrm{scale}}$，例如 $\\sigma_{\\mathrm{scale}} = \\max\\!\\big(\\sigma_y + H' \\alpha_n, \\sqrt{\\tfrac{3}{2}} \\, \\|\\mathbf{s}^{\\mathrm{trial}}\\|\\big)$，以及一个容差 $\\tau_f = \\epsilon_{\\mathrm{abs}} + \\epsilon_{\\mathrm{rel}} \\, \\sigma_{\\mathrm{scale}}$，其中 $\\epsilon_{\\mathrm{rel}} \\in (0,1)$ 且 $\\epsilon_{\\mathrm{abs}} \\ge 0$。如果 $f^{\\mathrm{trial}} \\le \\tau_f$，则将该步视为弹性步。如果 $f^{\\mathrm{trial}} > \\tau_f$，则根据返回映射一致性预测 $\\Delta \\gamma^{\\star}$，并要求 $\\Delta \\gamma^{\\star} \\ge \\tau_{\\gamma}$（其中 $\\tau_{\\gamma} = c_{\\gamma} \\, \\|\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|$，对于某个小的 $c_{\\gamma} \\in (0,1)$）才声明为塑性步；否则视为弹性步。在修正后始终强制 $f \\approx 0$ 在 $\\tau_f$ 容差范围内。\n\nC. 仅通过剪切模量对试探屈服函数进行归一化，并使用一个与应力状态和增量无关的固定容差：如果 $f^{\\mathrm{trial}}/(3G) > \\epsilon_0$（对于一个预设的 $\\epsilon_0 > 0$），则声明为塑性步；否则为弹性步。不考虑硬化、$\\sigma_y$ 或步长。\n\nD. 对应变增量采用子步法或回溯线搜索，以确保试探状态超过屈服面的幅度大于一个组合的绝对-相对容差，然后执行塑性返回。仅当修正后的状态在容差范围内满足 KKT 条件时才接受塑性步；否则减小步长并重试。\n\nE. 基于近似塑性耗散 $\\mathcal{D} \\approx \\Delta \\gamma^{\\star} \\, \\sigma_y$ 的符号来决定：如果 $\\mathcal{D} > 0$ 但 $\\mathcal{D}  \\mathcal{D}_{\\min}$（对于一个与应力尺度和步长无关的固定能量阈值 $\\mathcal{D}_{\\min}$），则分类为弹性步；否则分类为塑性步，无论 $f^{\\mathrm{trial}}$ 或硬化如何。\n\n选择所有适用项。使用 KKT 条件、$J_2$ 返回映射的结构以及量纲和尺度方面的考虑来提供你的推理。不要诉诸于未经解释的经验法则；从第一性原理和数值分析的角度来证明每个选择的合理性。", "solution": "该问题要求评估在 $J_2$ 塑性理论的计算实现中，如何稳健地区分弹性步和塑性步的策略，特别是在试探屈服函数 $f^{\\mathrm{trial}}$ 接近于零时。这是数值塑性学中的一个关键问题，因为简单的实现会受到有限精度算术相关问题的影响，导致伪塑性变形或在全局牛顿-拉夫逊迭代中丧失二次收敛性。一个稳健的准则必须基于模型的物理原理和数值分析的原则，特别是在缩放和容差方面。\n\n首先，让我们为给定模型建立塑性乘子 $\\Delta \\gamma$ 的解析形式。该问题使用一个隐式返回映射算法。一个弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{trial}}$ 是根据增量步开始时（第 $n$ 步）的状态和总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 计算得出的。试探偏应力为 $\\mathbf{s}^{\\mathrm{trial}} = \\mathbf{s}_n + 2G \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$，其中 $G$ 是剪切模量，$\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$ 是应变增量的偏量部分。\n\n试探屈服函数被评估为\n$$f^{\\mathrm{trial}} = \\sqrt{\\tfrac{3}{2}} \\|\\mathbf{s}^{\\mathrm{trial}}\\| - (\\sigma_y + H' \\alpha_n)$$\n如果 $f^{\\mathrm{trial}}  0$，则需要进行塑性修正。最终的应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 必须满足一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}, \\alpha_{n+1}) = 0$。关联 $J_2$ 塑性的返回映射规定，修正后的偏应力 $\\mathbf{s}_{n+1}$ 是试探应力 $\\mathbf{s}^{\\mathrm{trial}}$ 在更新后的屈服面上的径向投影。这导致了以下关系：\n$$\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{trial}} - 2G \\Delta \\boldsymbol{\\varepsilon}^p$$\n其中塑性应变增量由关联流动法则给出，$\\Delta \\boldsymbol{\\varepsilon}^p = \\Delta \\gamma \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。累积塑性应变 $\\alpha$ 的演化由 $\\Delta \\alpha = \\alpha_{n+1} - \\alpha_n = \\Delta \\gamma$ 给出。\n\n结合一致性条件、流动法则和硬化定律，可以推导出塑性乘子增量的精确表达式：\n$$ \\Delta \\gamma = \\frac{f^{\\mathrm{trial}}}{3G + H'} $$\n这个表达式是基础。由于 $G  0$ 且 $H' \\ge 0$，如果在 $f^{\\mathrm{trial}} \\le 0$ 时取 $\\Delta \\gamma = 0$，在 $f^{\\mathrm{trial}}  0$ 时取 $\\Delta \\gamma  0$，则在精确算术中 Karush-Kuhn-Tucker (KKT) 条件（$\\Delta \\gamma \\ge 0$，$f \\le 0$，$\\Delta \\gamma f = 0$）是满足的。挑战在于当 $f^{\\mathrm{trial}}$ 接近于零时，如何对这个开关进行数值实现。\n\n现在，我们评估每种提议的策略。\n\n**A. 仅根据在双精度下计算的 $f^{\\mathrm{trial}}$ 的符号进行分类：如果 $f^{\\mathrm{trial}}  0$，则声明为塑性步，否则为弹性步。不使用任何容差、缩放或额外的检查。**\n\n这是对数学理论的直接、简单的转译。在有限精度算术中，一个本应精确位于屈服面上（$f=0$）的状态，可能会被计算出一个微小的正或负残差，例如 $f^{\\mathrm{trial}} \\approx \\pm 10^{-15}$。这种策略会将一个可能由舍入误差引起的微小正残差解释为真实的塑性加载，从而触发一个在物理上无意义但计算成本高昂的塑性修正（伪塑性）。反之，它也可能错过一个非常小的塑性步。这种在弹塑性边界上的“抖动”已知会降低或破坏全局求解算法的二次收敛性。该策略在根本上是不稳健的，并忽略了问题的核心。\n\n结论：**不正确**。\n\n**B. 对屈服函数使用组合的绝对-相对容差，并对塑性乘子设置阈值...**\n\n该策略提出了一种多方面、按比例缩放的方法。\n1.  **屈服函数的缩放容差**：它定义了一个容差 $\\tau_f = \\epsilon_{\\mathrm{abs}} + \\epsilon_{\\mathrm{rel}} \\, \\sigma_{\\mathrm{scale}}$，其中应力尺度 $\\sigma_{\\mathrm{scale}}$ 根据当前屈服应力和试探等效应力动态更新。这是数值分析中一种标准、稳健的技术。它确保了容差相对于问题中的应力量级是有意义的，防止其对于低应力问题过于宽松，或对于高应力问题过于严格。如果 $f^{\\mathrm{trial}} \\le \\tau_f$，则将该步视为弹性步，这在屈服面周围创建了一个“容差带”，能稳健地过滤掉数值噪声，并防止因不显著的屈服面穿透而产生伪塑性。\n2.  **塑性乘子的阈值**：如果 $f^{\\mathrm{trial}}  \\tau_f$，它提出了第二个检查：预测的塑性乘子 $\\Delta \\gamma^{\\star}$ 必须大于一个容差 $\\tau_{\\gamma}$。该容差与偏应变增量成比例，即 $\\tau_{\\gamma} = c_{\\gamma} \\, \\|\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|$。这是对塑性*效应*的检查。由于 $\\Delta \\gamma$ 代表塑性应变的大小，这个条件是在询问所产生的塑性流动相对于驱动它的应变增量是否显著。这是一个在物理上和数值上都合理的检查。它提供了额外的稳健性层次，确保只有当塑性步对应于有意义的物理变形，而不仅仅是数值假象时，才会被激活。\n3.  **一致性强制**：要求在修正后强制 $f \\approx 0$ 在 $\\tau_f$ 容差范围内，是正确塑性更新的标准部分。\n\n该策略结合了多个合理的原则：适当的缩放、同时使用绝对和相对容差，以及基于“驱动力”($f^{\\mathrm{trial}}$) 和所产生的“流动”($\\Delta \\gamma$) 的阈值判断。\n\n结论：**正确**。\n\n**C. 仅通过剪切模量对试探屈服函数进行归一化，并使用一个与应力状态和增量无关的固定容差...**\n\n该策略建议将 $f^{\\mathrm{trial}}$ 归一化使其无量纲，这是一个很好的出发点。建议的归一化是 $f^{\\mathrm{trial}} / (3G)$。对于理想塑性（$H'=0$）的情况，这个量正好是塑性乘子 $\\Delta \\gamma$。该准则于是变为 $\\Delta \\gamma  \\epsilon_0$。然而，该策略有两个主要缺陷：\n1.  **不完全归一化**：它忽略了硬化模量 $H'$。$\\Delta \\gamma$ 表达式中的正确分母是 $3G + H'$。因此，这种归一化只对理想塑性有效，并且随着硬化变得越显著，其不准确性就越高。\n2.  **固定容差**：它使用一个“与应力状态和增量无关”的固定预设容差 $\\epsilon_0$。一个固定的容差在具有不同特征应力、应变或能量尺度的问题中不可能是稳健的。对于一个宏观结构分析而言合适的 $\\epsilon_0$ 值，对于一个微观尺度的模拟可能完全错误。稳健性要求容差相对于当前问题的特征量进行缩放，正如选项 B 中所做的那样。\n\n结论：**不正确**。\n\n**D. 对应变增量采用子步法或回溯线搜索...**\n\n这个选项描述了一种在根本上不同但同样有效的稳健性方法。它不是设计一个复杂的准则来对给定的固定应变增量进行分类，而是提议主动控制增量本身的大小。\n如果状态不明确（$f^{\\mathrm{trial}}$ 接近于零）或者塑性修正器未能收敛，算法会减小应变增量 ($\\Delta \\boldsymbol{\\varepsilon}$)。这是稳健非线性求解器中一种经典而强大的技术。通过减小步长，算法可以更小心地处理材料行为的急剧变化（如塑性起始）。其目标是确保试探状态要么是明确的弹性（$f^{\\mathrm{trial}} \\ll 0$），要么是明确的塑性（$f^{\\mathrm{trial}}$ 超过一个稳健的容差），从而避开模糊区域。\n最后的检查，即修正后的状态必须在容差范围内满足 KKT 条件，是接受任何步骤的必要条件，而在失败时减小步长并重试的动作是稳健时间积分方案的基石。这种策略将稳健性的重担放在步长控制算法上，而不仅仅是弹塑性开关，这是高质量有限元代码中常见且有效的方法。\n\n结论：**正确**。\n\n**E. 基于近似塑性耗散的符号来决定...**\n\n该策略试图使用物理量，即塑性耗散 $\\mathcal{D}$，作为准则。检查耗散能量是否显著的想法在物理上很有吸引力。近似式 $\\mathcal{D} \\approx \\Delta \\gamma^{\\star} \\sigma_y$ 是塑性功增量的一个合理的一阶估计。然而，该策略的致命缺陷在于其条件，即阈值 $\\mathcal{D}_{\\min}$ 是一个“与应力尺度和步长无关的固定能量阈值”。这与选项 C 中的根本错误相同。对能量或耗散等广延量设置固定阈值不可能是稳健的。什么构成“最小”耗散完全取决于具体情境：单元的大小、应变增量的大小以及系统中的总能量水平。一个稳健的准则必须将耗散增量与当前步的某个特征能量进行比较，例如弹性应变能增量。依赖于一个固定的、未缩放的阈值使得该策略不稳健。\n\n结论：**不正确**。", "answer": "$$\\boxed{BD}$$", "id": "2673914"}, {"introduction": "一旦确定某个步骤为塑性步骤，核心任务便是求解一致性方程以确定塑性乘子增量 $\\Delta \\gamma$。对于具有饱和效应等非线性硬化模型，该方程变为非线性，必须通过迭代求解。这个局部迭代过程的收敛性至关重要，若其失败则整个分析无法进行。本实践练习 [@problem_id:2568881] 深入研究了如何通过采用如安全保护的牛顿法等稳健的数值方法，来确保对这一关键标量方程的求解具有全局收敛性。", "problem": "考虑小应变关联弹塑性，其具有各向同性 von Mises 屈服条件和带饱和的非线性各向同性硬化。设 Cauchy 应力分解为 $\\boldsymbol{\\sigma} = \\mathbf{C} : (\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p})$，其中 $\\mathbf{C}$ 是各向同性弹性刚度，偏应力为 $\\mathbf{s} = \\operatorname{dev}(\\boldsymbol{\\sigma})$。屈服函数为 $f(\\boldsymbol{\\sigma}, \\alpha) = \\lVert \\mathbf{s} \\rVert - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}(\\alpha)$，其中硬化应力 $\\sigma_{y}(\\alpha)$ 是 $C^{1}$ 类函数，严格递增且有上界（饱和），例如 $\\sigma_{y}(\\alpha) = \\sigma_{\\infty} - (\\sigma_{\\infty} - \\sigma_{0}) \\exp(-b\\,\\alpha)$，参数为 $\\sigma_{\\infty}  \\sigma_{0}  0$ 和 $b  0$。内变量 $\\alpha$ 是累积塑性应变，其演化规律为 $d\\alpha = \\sqrt{\\tfrac{2}{3}}\\, d\\gamma$，其中塑性乘子增量 $d\\gamma \\ge 0$。\n\n对于从 $n$ 到 $n+1$ 的时间步，使用隐式后向欧拉返回映射算法，定义在 $n+1$ 步的试探状态为 $\\mathbf{s}_{\\mathrm{tr}} = \\mathbf{s}_{n} + 2\\mu\\, \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$，其中 $\\mu$ 是剪切模量，$\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$ 是偏应变增量。假设试探状态是塑性容许的，即 $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n})  0$。采用关联流动法则的后向欧拉更新会得到关于塑性乘子增量 $\\Delta \\gamma \\ge 0$ 的标量一致性条件，其形式为\n$$\nr(\\Delta \\gamma) \\equiv \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = 0.\n$$\n我们希望使用带区间限定的安全保护 Newton 法或在合适的价值函数上使用线搜索全局化方法来稳健地求解 $r(\\Delta \\gamma) = 0$。\n\n对于上述模型，选择所有给出充分条件和构造，以确保全局收敛到 $r(\\Delta \\gamma) = 0$ 的唯一解 $\\Delta \\gamma^{\\star} \\in (0,\\infty)$ 的陈述。\n\nA. 定义价值函数 $\\phi(\\Delta \\gamma) = \\tfrac{1}{2} \\, r(\\Delta \\gamma)^{2}$。假设 $r$ 在闭区间 $[0,\\Delta \\gamma_{\\max}]$ 上连续可微，其导数 $r'(\\Delta \\gamma)$ 在 $[0,\\Delta \\gamma_{\\max}]$ 上 Lipschitz 连续，并且存在一个常数 $c_{0}  0$ 使得对于所有 $\\Delta \\gamma \\in [0,\\Delta \\gamma_{\\max}]$ 都有 $r'(\\Delta \\gamma) \\le -c_{0}  0$。在每次迭代中使用由 $r'(\\Delta \\gamma_{k})\\, p_{k} = - r(\\Delta \\gamma_{k})$ 给出的 Newton 方向 $p_{k}$，并使用参数为 $c \\in (0,\\tfrac{1}{2})$ 和收缩因子为 $\\rho \\in (0,1)$ 的 Armijo 回溯线搜索来强制满足\n$$\n\\phi(\\Delta \\gamma_{k} + s_{k} p_{k}) \\le \\phi(\\Delta \\gamma_{k}) + c\\, s_{k}\\, \\phi'(\\Delta \\gamma_{k})\\, p_{k},\n$$\n从任何初始猜测 $\\Delta \\gamma_{0} \\in [0,\\Delta \\gamma_{\\max}]$ 开始，都会生成一个全局收敛到 $r$ 的唯一根的序列。\n\nB. 如果可以构造一个区间 $[0,\\Delta \\gamma_{\\max}]$ 满足 $r(0) > 0$ 和 $r(\\Delta \\gamma_{\\max}) \\le 0$，并且如果 $r$ 在 $[0,\\Delta \\gamma_{\\max}]$ 上是连续且严格单调的，那么一种安全保护 Newton 法（该方法在每次迭代中计算一个 Newton 试探步并将其投影回该区间，当试探步离开该区间或未能减小 $|r|$ 时回退到二分法）会全局收敛到唯一的根。\n\nC. 因为对于给定的带饱和的硬化法则，$r$ 是严格单调的，所以没有任何线搜索或安全保护的纯 Newton 法，从 $\\Delta \\gamma_{0} = 0$ 开始，对于所有容许的数据都保证全局收敛到唯一的根。\n\nD. 使用残差本身 $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ 作为价值函数，并对 $\\phi$ 施加带有 Newton 方向的 Armijo 下降条件，可以确保全局收敛，因为由于饱和效应，$\\phi$ 随 $\\Delta \\gamma$ 严格递减。\n\nE. 一个充分且可计算的、用于构造变号区间的上界是\n$$\n\\Delta \\gamma_{\\max} = \\frac{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}}{2\\mu} \\, ,\n$$\n只要该值为正，它就保证了对于任何 $\\alpha_{n}$ 都有 $r(\\Delta \\gamma_{\\max}) \\le 0$，因为在一个具有 $\\sigma_{\\infty}  \\sigma_{0}  0$ 的饱和法则中，对于所有 $\\alpha$，都有 $\\sigma_{y}(\\alpha) \\ge \\sigma_{0}$。\n\n选择所有适用的选项。", "solution": "用户要求对问题陈述进行严格验证，然后提供详细的解决方案并评估所给选项。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **框架**：小应变关联弹塑性。\n*   **屈服条件**：各向同性 von Mises。\n*   **硬化**：带饱和的非线性各向同性硬化。屈服应力 $\\sigma_{y}(\\alpha)$ 是累积塑性应变 $\\alpha$ 的 $C^{1}$ 类函数，严格递增且有上界。例如：$\\sigma_{y}(\\alpha) = \\sigma_{\\infty} - (\\sigma_{\\infty} - \\sigma_{0}) \\exp(-b\\,\\alpha)$，参数为 $\\sigma_{\\infty}  \\sigma_{0}  0$， $b  0$。\n*   **屈服函数**：$f(\\boldsymbol{\\sigma}, \\alpha) = \\lVert \\mathbf{s} \\rVert - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}(\\alpha)$，其中 $\\mathbf{s}$ 是偏应力。\n*   **累积塑性应变演化**：$d\\alpha = \\sqrt{\\tfrac{2}{3}}\\, d\\gamma$，其中 $d\\gamma \\ge 0$。\n*   **数值方案**：隐式后向欧拉返回映射算法。\n*   **试探状态**：$\\mathbf{s}_{\\mathrm{tr}} = \\mathbf{s}_{n} + 2\\mu\\, \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$。\n*   **塑性加载条件**：试探状态是塑性容许的，即 $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n})  0$。\n*   **一致性方程**：问题简化为求解关于塑性乘子增量 $\\Delta \\gamma \\ge 0$ 的标量非线性方程 $r(\\Delta \\gamma) = 0$：\n    $$r(\\Delta \\gamma) \\equiv \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = 0.$$\n*   **目标**：确定所有描述了确保全局收敛到唯一解 $\\Delta \\gamma^{\\star} \\in (0,\\infty)$ 的充分条件和构造的陈述。\n\n**第2步：使用提取的已知条件进行验证**\n\n1.  **科学依据**：该问题是计算非弹性力学中的一个经典课题，代表了有限元模拟中的局部本构更新。该模型（带各向同性硬化的 von Mises 模型）和算法（后向欧拉返回映射）都是标准的且基础稳固。\n2.  **适定性**：让我们分析函数 $r(\\Delta \\gamma)$（对于 $\\Delta \\gamma \\ge 0$）。\n    *   **在原点的值**：塑性加载条件 $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n})  0$ 等价于 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\frac{2}{3}}\\sigma_{y}(\\alpha_n)  0$。这恰好是 $r(0)$。所以，$r(0)  0$。\n    *   **单调性**：$r(\\Delta \\gamma)$ 的导数是：\n        $$r'(\\Delta \\gamma) = \\frac{d}{d(\\Delta \\gamma)} \\left( \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) \\right)$$\n        $$r'(\\Delta \\gamma) = -2\\mu - \\sqrt{\\tfrac{2}{3}} \\cdot \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) \\cdot \\sqrt{\\tfrac{2}{3}}$$\n        $$r'(\\Delta \\gamma) = -2\\mu - \\tfrac{2}{3}\\, \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right)$$\n        由于剪切模量 $\\mu  0$ 且硬化是严格递增的（$\\sigma_{y}'  0$），我们有 $r'(\\Delta \\gamma)  -2\\mu  0$ 对于所有 $\\Delta \\gamma \\ge 0$。因此，$r(\\Delta \\gamma)$ 是一个严格递减函数。\n    *   **渐进行为**：当 $\\Delta \\gamma \\to \\infty$ 时，项 $-2\\mu \\Delta \\gamma \\to -\\infty$。硬化函数 $\\sigma_{y}(\\alpha)$ 有上界，例如 $\\sigma_{\\infty}$。因此，当 $\\Delta \\gamma \\to \\infty$ 时，$r(\\Delta \\gamma) \\to -\\infty$。\n    *   **解的存在性和唯一性**：由于 $r(\\Delta \\gamma)$ 是连续的，$r(0)  0$ 且 $r(\\Delta \\gamma) \\to -\\infty$，根据介值定理，至少存在一个根。因为 $r(\\Delta \\gamma)$ 是严格递减的，这个根必须是唯一的。我们称之为 $\\Delta \\gamma^{\\star}$。由于 $r(0)0$，我们有 $\\Delta \\gamma^{\\star}  0$。寻找解的问题在数学上是适定的。\n3.  **客观性**：问题使用了精确的数学和技术语言陈述，没有主观性。\n\n**第3步：结论与行动**\n\n问题陈述在科学上是合理的，数学上是适定的，并且是客观表述的。这是一个有效的问题。我们继续进行求解。\n\n### 推导与逐项分析\n\n我们必须找出关于求解 $r(\\Delta \\gamma) = 0$ 的全局收敛算法的正确陈述。\n\n**选项 A 分析**\n该陈述提出了一种使用价值函数 $\\phi(\\Delta \\gamma) = \\frac{1}{2} r(\\Delta \\gamma)^{2}$ 的 Newton 方法的线搜索全局化。这是数值优化中的一种标准技术。\n价值函数的导数是 $\\phi'(\\Delta \\gamma) = r(\\Delta \\gamma) r'(\\Delta \\gamma)$。求根问题 $r(\\Delta \\gamma)=0$ 的 Newton 方向是 $p_{k} = -r(\\Delta \\gamma_{k}) / r'(\\Delta \\gamma_{k})$。\n价值函数沿此方向的方向导数是：\n$$\\phi'(\\Delta \\gamma_{k})\\, p_{k} = r(\\Delta \\gamma_{k}) r'(\\Delta \\gamma_{k}) \\left( \\frac{-r(\\Delta \\gamma_{k})}{r'(\\Delta \\gamma_{k})} \\right) = -[r(\\Delta \\gamma_{k})]^2 = -2\\phi(\\Delta \\gamma_{k})$$\n由于 $\\phi(\\Delta \\gamma_{k}) \\ge 0$，对于任何非根的 $\\Delta \\gamma_{k}$，方向导数都是负的，这意味着 $p_{k}$ 总是 $\\phi$ 的一个下降方向。\nArmijo 条件和回溯过程确保了每一步都能在价值函数上实现充分下降。\n该陈述包含了证明此类方法全局收敛的标准假设：价值函数梯度的 Lipschitz 连续性（如果 $\\sigma_y$ 是 $C^2$ 的，这对光滑的硬化法则是合理的假设，则 $r$ 是 $C^2$ 的，这意味着这一点），以及搜索方向是下降方向。关于 $r'(\\Delta \\gamma)$ 的条件已由物理模型满足。在这些条件下，线搜索 Newton 法保证收敛到 $\\phi$ 的一个驻点，即 $\\phi'(\\Delta \\gamma)=0$ 的地方。这意味着 $r(\\Delta \\gamma)r'(\\Delta \\gamma) = 0$。既然我们已经证明 $r'(\\Delta \\gamma)  -2\\mu  0$，那么极限点必须满足 $r(\\Delta \\gamma) = 0$。因此，该方法收敛到唯一的根 $\\Delta \\gamma^{\\star}$。\n**对 A 的结论**：正确。\n\n**选项 B 分析**\n该陈述提出了一种安全保护 Newton 法，它将 Newton 步与在区间 $[0, \\Delta \\gamma_{\\max}]$ 内的二分法相结合，其中 $r(0) > 0$ 且 $r(\\Delta \\gamma_{\\max}) \\le 0$。\n这样一个区间的存在性是有保证的，因为 $r(0)  0$ 且对于大的 $\\Delta \\gamma$，$r(\\Delta \\gamma) \\to -\\infty$。问题还要求 $r$ 在该区间上是连续且严格单调的，这一点我们已经验证过了。\n安全保护方法的工作原理如下：在每次迭代中，它尝试一个快速收敛的步骤（如 Newton 法）。如果这个步骤是“好的”（例如，保持在区间内并充分减小残差 $|r|$），它就被接受。如果不是，算法就回退到一个稳健但较慢的步骤（如二分法）。对于一个在区间上连续且变号的函数，二分法保证收敛。通过始终确保根被限定在区间内，并在必要时回退到二分法，这种混合算法保证了全局收敛。选项中的描述虽然略显非正式，但正确地指出了这种保证的所有关键要素。\n**对 B 的结论**：正确。\n\n**选项 C 分析**\n该陈述声称，纯 Newton 法（$\\Delta \\gamma_{k+1} = \\Delta \\gamma_k - r(\\Delta \\gamma_k)/r'(\\Delta \\gamma_k)$），从 $\\Delta \\gamma_0 = 0$ 开始，保证全局收敛。\n对于一个标量方程 $r(x)=0$，一个已知的定理指出，如果从 $r(x_0)0$ 的 $x_0$ 开始，并且对于所有 $x \\ge x_0$ 都有 $r'(x)0$ 和 $r''(x) \\ge 0$，那么 Newton 迭代会形成一个单调递增的序列，收敛到根。\n在我们的问题中，我们有 $r(0)  0$ 和 $r'(\\Delta\\gamma)  0$。第三个条件是 $r''(\\Delta \\gamma) \\ge 0$。让我们计算二阶导数：\n$$r''(\\Delta \\gamma) = -\\frac{2}{3} \\frac{d}{d(\\Delta \\gamma)} \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = -\\left(\\frac{2}{3}\\right)^{3/2} \\sigma_{y}''\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right)$$\n因此，条件 $r''(\\Delta \\gamma) \\ge 0$ 等价于对于所有相关的 $\\alpha$，$\\sigma_{y}''(\\alpha) \\le 0$。这意味着硬化函数 $\\sigma_y(\\alpha)$ 必须是凹函数。\n虽然提供的示例硬化法则是凹的，但问题只规定了 $\\sigma_y(\\alpha)$ 是 $C^1$ 类函数，严格递增且有界。可以构造一个具有这些性质但并非全局凹的函数（即，它可能有拐点）。如果 $\\sigma_y(\\alpha)$ 有一个凸区域（$\\sigma_y''  0$），那么 $r(\\Delta \\gamma)$ 将是凹的（$r''  0$），Newton 法可能会过冲根，可能导致发散或收敛到一个非物理的负值。因此，对于问题定义所涵盖的所有硬化法则，这一保证并非普遍有效。\n**对 C 的结论**：不正确。\n\n**选项 D 分析**\n该陈述建议使用 $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ 作为线搜索方法的价值函数。\n在线搜索算法的背景下，价值函数是一个待最小化的函数，其最小值对应于原始问题（这里是求根）的解。标准的 Armijo 条件和相关的收敛定理是为这种最小化设置推导出来的。对价值函数的一个关键要求是它必须在搜索路径上有下界。\n这里，提议的价值函数 $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ 没有下界；我们知道当 $\\Delta \\gamma \\to \\infty$ 时，$r(\\Delta \\gamma) \\to -\\infty$。一个试图最小化这个“价值函数”的线搜索算法会试图将 $\\Delta \\gamma$ 推向无穷大，而不是在 $r(\\Delta \\gamma) = 0$ 的根处停止。基于最小化的线搜索框架在这里被从根本上误用了。虽然可以为求根设计专门的阻尼 Newton 方案，但用“价值函数”和“Armijo 下降条件”这些标准术语来描述它在概念上是有缺陷的，因为目标不是最小化 $r$，而是找到它为零的地方。\n**对 D 的结论**：不正确。\n\n**选项 E 分析**\n该陈述提出了一个可计算的上界 $\\Delta \\gamma_{\\max}$ 来形成一个区间 $[0, \\Delta \\gamma_{\\max}]$。\n提议的上界是 $\\Delta \\gamma_{\\max} = \\frac{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}}{2\\mu}$。\n首先，我们必须检查这个量是否为正。塑性加载条件是 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert  \\sqrt{\\frac{2}{3}} \\sigma_y(\\alpha_n)$。由于 $\\sigma_y(\\alpha)$ 是一个严格递增函数且 $\\alpha_n \\ge 0$，我们有 $\\sigma_y(\\alpha_n) \\ge \\sigma_y(0) = \\sigma_0$。因此，$\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert  \\sqrt{\\frac{2}{3}} \\sigma_y(\\alpha_n) \\ge \\sqrt{\\frac{2}{3}} \\sigma_0$。这意味着 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\frac{2}{3}} \\sigma_0 > 0$，所以 $\\Delta \\gamma_{\\max}$ 总是正的。附带条件“只要该值为正”是多余的，但并不使陈述无效。\n接下来，我们必须检查是否 $r(\\Delta \\gamma_{\\max}) \\le 0$。\n$$r(\\Delta \\gamma_{\\max}) = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu \\Delta \\gamma_{\\max} - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right)$$\n根据 $\\Delta \\gamma_{\\max}$ 的构造，我们有 $2\\mu \\Delta \\gamma_{\\max} = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}$。将此代入 $r$ 的表达式中：\n$$r(\\Delta \\gamma_{\\max}) = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\left(\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}\\right) - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right)$$\n$$r(\\Delta \\gamma_{\\max}) = \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0} - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right) = \\sqrt{\\tfrac{2}{3}} \\left( \\sigma_{0} - \\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right) \\right)$$\n硬化函数的自变量是 $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\frac{2}{3}}\\Delta\\gamma_{\\max}$。由于 $\\alpha_n \\ge 0$ 且 $\\Delta\\gamma_{\\max} > 0$，该自变量为正。由于 $\\sigma_y$ 是严格递增的，所以 $\\sigma_y(\\alpha_{n+1}) > \\sigma_y(0) = \\sigma_0$。\n因此，$\\sigma_0 - \\sigma_y(\\alpha_{n+1})  0$，这意味着 $r(\\Delta \\gamma_{\\max})  0$。这满足了条件 $r(\\Delta \\gamma_{\\max}) \\le 0$。一个有效的变号区间 $[0, \\Delta \\gamma_{\\max}]$ 被成功构造出来。\n**对 E 的结论**：正确。\n\n**正确选项总结**\n正确的选项是 A、B 和 E，因为它们描述了用于找到一致性方程唯一解的有效且稳健的方法或构造。", "answer": "$$\\boxed{ABE}$$", "id": "2568881"}, {"introduction": "在塑性修正过程中，计算塑性流动方向 $\\boldsymbol{n}$ 是一个关键环节，对于J2塑性而言，它被定义为归一化的偏应力张量 $\\boldsymbol{s}/\\|\\boldsymbol{s}\\|$。然而，当应力状态接近纯静水压力时，偏应力模量 $\\|\\boldsymbol{s}\\|$ 趋近于零，导致流动方向的定义出现数值奇异性，这会使算法崩溃。本实践练习 [@problem_id:2568912] 旨在解决这一数值病态问题，探索了各种正则化技术，以确保在保持物理一致性的同时，获得一个在任何应力状态下都表现良好且数值稳定的流动方向定义。", "problem": "在关联塑性理论中，当使用 von Mises（第二偏应力不变量 $J_2$）屈服函数时，有限元法（FEM）实现中的增量返回映射算法使用偏量流动方向 $\\boldsymbol{n}$，其定义为 $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$，其中 $\\boldsymbol{s}$ 是 Cauchy 应力 $\\boldsymbol{\\sigma}$ 的偏量部分，$\\|\\cdot\\|$ 表示欧几里得范数。塑性流动法则是 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\partial g/\\partial \\boldsymbol{\\sigma}$，对于关联流动，塑性势 $g = f$，因此 $\\partial g/\\partial \\boldsymbol{\\sigma} = \\sqrt{3/2}\\,\\boldsymbol{n}$。在求解全局平衡的 Newton–Raphson 方法中，一致算法切线需要对所有内变量进行线性化，这涉及到 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$。考虑一个隐式增量更新，其中弹性预测给出的试探偏应力 $\\boldsymbol{s}^{\\mathrm{trial}}$ 的范数可能非常小，例如在纯静水压弹性状态附近或弹性域原点附近。\n\n从上述基本定义和标准向量微积分出发，论述当 $\\|\\boldsymbol{s}\\|$ 很小时，计算 $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$ 的数值敏感性，以及这对一致切线 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ 的影响。然后，选择一个选项，该选项既能正确识别核心数值问题，又能提出一个稳健的正则化方法，该方法能保持标架无关性和偏量性，确保非负塑性耗散，并允许在 Newton–Raphson 迭代中使用一个定义良好的一致线性化。\n\nA. 问题是由于除以一个很小的 $\\|\\boldsymbol{s}\\|$ 导致数值稳定性丧失，这会放大浮点扰动并使 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ 无界。一个稳健的修正方法是用平滑正则化 $\\boldsymbol{n}_{\\varepsilon} = \\boldsymbol{s}/\\sqrt{\\|\\boldsymbol{s}\\|^{2} + \\varepsilon^{2}}$ 替换归一化，其中选择一个与特征应力尺度相关的、具有应力量綱的 $\\varepsilon$，并在算法切线中使用一致导数 $\\partial \\boldsymbol{n}_{\\varepsilon}/\\partial \\boldsymbol{s} = \\frac{1}{\\sqrt{\\|\\boldsymbol{s}\\|^{2} + \\varepsilon^{2}}}\\,\\mathbb{I} - \\frac{\\boldsymbol{s}\\otimes \\boldsymbol{s}}{(\\|\\boldsymbol{s}\\|^{2} + \\varepsilon^{2})^{3/2}}$。\n\nB. 问题是 $\\boldsymbol{s}$ 可能在数值上失去其偏量性。一个稳健的修正方法是在归一化之前增加一个小的静水压偏置，定义 $\\tilde{\\boldsymbol{s}} = \\boldsymbol{s} + \\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 并计算 $\\boldsymbol{n} = \\tilde{\\boldsymbol{s}}/\\|\\tilde{\\boldsymbol{s}}\\|$，这样可以稳定方向并改善收敛性。\n\nC. 问题是在 $\\boldsymbol{s} = \\boldsymbol{0}$ 处 $\\boldsymbol{n}$ 缺乏唯一性。一个稳健的修正方法是，每当 $\\|\\boldsymbol{s}\\|  \\varepsilon$ 时设置 $\\boldsymbol{n} = \\boldsymbol{0}$，否则使用 $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$，这样可以避免除以小数，并将一致切线在阈值以下简化为 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} = \\boldsymbol{0}$。\n\nD. 问题仅仅是 $\\boldsymbol{n}$ 的量级会激增。一个稳健的修正方法是对分母进行截断，使用 $\\boldsymbol{n} = \\boldsymbol{s}/\\max(\\|\\boldsymbol{s}\\|,\\varepsilon)$，这保证了 $\\|\\boldsymbol{n}\\| \\le 1$ 并消除了奇点，而无需改变返回映射方程或一致切线。\n\n选择唯一最佳选项。", "solution": "该问题陈述在科学上是合理的、适定的和客观的。它描述了计算塑性力学这一成熟领域中一个标准的、非平凡的数值问题。所有给出的定义和条件都与有限元法和连续介质力学理论一致。因此，该问题是有效的，我们继续进行全面分析。\n\n核心问题涉及塑性流动方向的定义，即一个归一化的偏应力张量，$\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$。此处，$\\boldsymbol{s}$ 是偏应力张量，$\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$ 是其欧几里得范数。当弹性试探应力状态接近偏应力空间的原点时，即当 $\\|\\boldsymbol{s}\\| \\to 0$ 时，这个表达式带来了两个显著的数值挑战。\n\n首先，是直接的数值不稳定性。用一个接近于零的浮点数作除法会导致溢出或严重的精度损失。函数 $\\boldsymbol{n}(\\boldsymbol{s})$ 在 $\\boldsymbol{s} = \\boldsymbol{0}$ 处是未定义的，这对应于几何学上零向量没有唯一方向的事实。\n\n其次，对于问题中提到的隐式 Newton-Raphson 格式更为关键的是，导数 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ 的行为。Newton-Raphson 方法的二次收敛率依赖于使用一致切线算子，这是一致切线算子对数值算法的精确线性化。这需要所有内变量的 Gâteaux 导数。流动方向 $\\boldsymbol{n}$ 关于偏應力 $\\boldsymbol{s}$ 的导数是一个四阶张量，由下式给出：\n$$ \\frac{\\partial \\boldsymbol{n}}{\\partial \\boldsymbol{s}} = \\frac{\\partial}{\\partial \\boldsymbol{s}} \\left( \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|} \\right) = \\frac{1}{\\|\\boldsymbol{s}\\|} \\mathbb{I}_{\\text{dev}} - \\frac{\\boldsymbol{s} \\otimes \\boldsymbol{s}}{\\|\\boldsymbol{s}\\|^3} $$\n其中 $\\mathbb{I}_{\\text{dev}}$ 是偏量张量空间上的四阶单位张量。当 $\\|\\boldsymbol{s}\\| \\to 0$ 时，$\\|\\boldsymbol{s}\\|^{-1}$ 和 $\\|\\boldsymbol{s}\\|^{-3}$ 项导致该导数变得无界。一个奇异的导数会导致奇异或病态的全局切线刚度矩阵，从而破坏 Newton-Raphson 迭代的收敛性。\n\n一个稳健的解决方案必须对函数 $\\boldsymbol{n}(\\boldsymbol{s})$ 进行正则化，使其处处连续可微，尤其是在 $\\boldsymbol{s}=\\boldsymbol{0}$ 处，同时保留模型的基本物理特性：标架无关性、流动的偏量性以及非负的塑性耗散。\n\n现在，我们评估每个选项。\n\nA. 问题是由于除以一个很小的 $\\|\\boldsymbol{s}\\|$ 导致数值稳定性丧失，这会放大浮点扰动并使 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ 无界。一个稳健的修正方法是用平滑正则化 $\\boldsymbol{n}_{\\varepsilon} = \\boldsymbol{s}/\\sqrt{\\|\\boldsymbol{s}\\|^{2} + \\varepsilon^{2}}$ 替换归一化，其中选择一个与特征应力尺度相关的、具有应力量綱的 $\\varepsilon$，并在算法切线中使用一致导数 $\\partial \\boldsymbol{n}_{\\varepsilon}/\\partial \\boldsymbol{s} = \\frac{1}{\\sqrt{\\|\\boldsymbol{s}\\|^{2} + \\varepsilon^{2}}}\\,\\mathbb{I} - \\frac{\\boldsymbol{s}\\otimes \\boldsymbol{s}}{(\\|\\boldsymbol{s}\\|^{2} + \\varepsilon^{2})^{3/2}}$。\n\n这个选项正确地指出了两个核心问题：计算 $\\boldsymbol{n}$ 时的数值不稳定性及其导数 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ 的奇异性。所提出的正则化方法 $\\boldsymbol{n}_{\\varepsilon}(\\boldsymbol{s}) = \\boldsymbol{s}/\\sqrt{\\|\\boldsymbol{s}\\|^{2} + \\varepsilon^{2}}$ 是一种标准技术。对于任何常数 $\\varepsilon  0$ 的选择，它都是光滑的（$C^{\\infty}$）。在 $\\boldsymbol{s} = \\boldsymbol{0}$ 处，我们有 $\\boldsymbol{n}_{\\varepsilon}(\\boldsymbol{0}) = \\boldsymbol{0}$。对于 $\\|\\boldsymbol{s}\\| \\gg \\varepsilon$，我们恢复 $\\boldsymbol{n}_{\\varepsilon} \\approx \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$。这种正则化保留了流动方向的偏量性质，是标架无关的，并确保了非负耗散，因为 $\\boldsymbol{s}:\\boldsymbol{n}_{\\varepsilon} = \\|\\boldsymbol{s}\\|^2 / \\sqrt{\\|\\boldsymbol{s}\\|^2 + \\varepsilon^2} \\ge 0$。其导数由乘法法则计算得出：\n$$ \\frac{\\partial \\boldsymbol{n}_{\\varepsilon}}{\\partial \\boldsymbol{s}} = \\frac{\\partial}{\\partial \\boldsymbol{s}} \\left( \\boldsymbol{s} (\\|\\boldsymbol{s}\\|^2 + \\varepsilon^2)^{-1/2} \\right) = \\mathbb{I} \\cdot (\\|\\boldsymbol{s}\\|^2 + \\varepsilon^2)^{-1/2} + \\boldsymbol{s} \\otimes \\left( -\\frac{1}{2} (\\|\\boldsymbol{s}\\|^2 + \\varepsilon^2)^{-3/2} \\cdot 2\\boldsymbol{s} \\right) $$\n$$ = \\frac{1}{\\sqrt{\\|\\boldsymbol{s}\\|^2 + \\varepsilon^2}} \\mathbb{I} - \\frac{\\boldsymbol{s} \\otimes \\boldsymbol{s}}{(\\|\\boldsymbol{s}\\|^2 + \\varepsilon^2)^{3/2}} $$\n这与选项中的公式相匹配（使用 $\\mathbb{I}$ 作为适当的单位张量）。在 $\\boldsymbol{s} = \\boldsymbol{0}$ 处，该导数是良定义的，等于 $(1/\\varepsilon)\\mathbb{I}$。因此，切线在任何地方都是非奇异且连续的，满足了稳健 Newton-Raphson 收敛的所有要求。\n结论：**正确**。\n\nB. 问题是 $\\boldsymbol{s}$ 可能在数值上失去其偏量性。一个稳健的修正方法是在归一化之前增加一个小的静水压偏置，定义 $\\tilde{\\boldsymbol{s}} = \\boldsymbol{s} + \\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 并计算 $\\boldsymbol{n} = \\tilde{\\boldsymbol{s}}/\\|\\tilde{\\boldsymbol{s}}\\|$，这样可以稳定方向并改善收敛性。\n\n这个选项是根本错误的。主要的数值问题不是 $\\boldsymbol{s}$ 失去偏量性，而是在 $\\|\\boldsymbol{s}\\| \\to 0$ 处的奇异性。更重要的是，所提出的修正在物理上对于 $J_2$ 塑性是不可接受的。$J_2$ 塑性理论要求塑性流动是等容的（体积保持不变），这意味着塑性应变率张量 $\\dot{\\boldsymbol{\\varepsilon}}^p$ 必须是偏量。由于 $\\dot{\\boldsymbol{\\varepsilon}}^{p} \\propto \\boldsymbol{n}$，流动方向 $\\boldsymbol{n}$ 必须是一个偏量张量。所提出的 $\\tilde{\\boldsymbol{s}} = \\boldsymbol{s} + \\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 不是偏量，因为它有非零的迹：$\\mathrm{tr}(\\tilde{\\boldsymbol{s}}) = \\mathrm{tr}(\\boldsymbol{s}) + \\mathrm{tr}(\\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}) = 0 + 3\\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})$。用这个 $\\tilde{\\boldsymbol{s}}$ 来定义 $\\boldsymbol{n}$ 会引入虚假的塑性体积变化，违反了本构模型的基本原则。\n结论：**不正确**。\n\nC. 问题是在 $\\boldsymbol{s} = \\boldsymbol{0}$ 处 $\\boldsymbol{n}$ 缺乏唯一性。一个稳健的修正方法是，每当 $\\|\\boldsymbol{s}\\|  \\varepsilon$ 时设置 $\\boldsymbol{n} = \\boldsymbol{0}$，否则使用 $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$，这样可以避免除以小数，并将一致切线在阈值以下简化为 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} = \\boldsymbol{0}$。\n\n这个选项正确地指出了在原点的唯一性问题。然而，所提出的修正方法，即使用由 `if` 语句控制的分段定义，对于 Newton-Raphson 求解器来说是不稳健的。虽然函数 $\\boldsymbol{n}(\\boldsymbol{s})$ 本身是连续的，但其导数 $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ 在球面 $\\|\\boldsymbol{s}\\| = \\varepsilon$ 上变得不连续。对于 $\\|\\boldsymbol{s}\\|  \\varepsilon$，$\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} = \\boldsymbol{0}$。对于 $\\|\\boldsymbol{s}\\|  \\varepsilon$，$\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} \\neq \\boldsymbol{0}$。切线算子的这种跳跃破坏了 Newton-Raphson 方法的二次收敛性质，并且当一个状态点在迭代过程中穿过这个人为边界时，可能导致振荡或不收敛。一个“定义良好的一致线性化”至少意味着切线是连续的。这个提议未能提供一个连续的切线。\n结论：**不正确**。\n\nD. 问题仅仅是 $\\boldsymbol{n}$ 的量级会激增。一个稳健的修正方法是对分母进行截断，使用 $\\boldsymbol{n} = \\boldsymbol{s}/\\max(\\|\\boldsymbol{s}\\|,\\varepsilon)$，这保证了 $\\|\\boldsymbol{n}\\| \\le 1$ 并消除了奇点，而无需改变返回映射方程或一致切线。\n\n这个选项错误地描述了问题。$\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$ 的量级根据定义恒为 $1$（对于 $\\boldsymbol{s} \\neq \\boldsymbol{0}$）；它不会“激增”。所提出的修正方法 $\\boldsymbol{n} = \\boldsymbol{s}/\\max(\\|\\boldsymbol{s}\\|,\\varepsilon)$ 只是书写一种分段函数的不同方式，其效果与选项 C 中在原点附近的状态（如果 $\\|\\boldsymbol{s}\\|  \\varepsilon$，则 $\\boldsymbol{n} = \\boldsymbol{s}/\\varepsilon$）完全相同。与选项 C 一样，这个函数在 $\\|\\boldsymbol{s}\\| = \\varepsilon$ 处有一个不连续的导数。这使得它为 Newton-Raphson 上下文提供稳健解决方案的说法无效。声称这不改变“返回映射方程或一致切线”是错误的；它明确地改变了 $\\boldsymbol{n}$ 的定义，因此也改变了方程，并且它未能产生一个连续可微的切线。\n结论：**不正确**。\n\n最终结论：选项 A 是唯一一个正确识别了数值问题的所有方面，并提出了一个在物理上一致且在数学上稳健的解决方案，提供了 Newton-Raphson 算法达到最佳性能所需的平滑、良定义的一致切线。", "answer": "$$\\boxed{A}$$", "id": "2568912"}]}