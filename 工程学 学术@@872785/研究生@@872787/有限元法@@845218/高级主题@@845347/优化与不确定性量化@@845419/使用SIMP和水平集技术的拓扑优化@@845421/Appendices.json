{"hands_on_practices": [{"introduction": "本练习旨在深入剖析SIMP方法的核心。在运行复杂的优化之前，理解其背后的材料模型至关重要。通过从基本要求出发重建幂律插值公式[@problem_id:2606482]，您将清晰地看到惩罚因子 $p$ 是如何抑制“灰色”或中间密度单元的。这个计算练习将惩罚这一抽象概念具体化，并突显其在生成清晰的黑白分明结构布局中的核心作用。", "problem": "考虑一个通过有限元法（FEM）离散化的线性弹性柔度最小化拓扑优化问题。材料分布由固定网格上的单元密度 $\\rho_e \\in [0,1]$ 表示，并采用一种伪材料方法，通过为 $\\rho_e \\approx 0$ 的单元赋予一个很小但非零的刚度来避免奇异刚度矩阵。在带有罚函数的固体各向同性材料（SIMP）框架中，有效的单元杨氏模量 $E(\\rho_e)$ 需要满足以下从建模假设中导出的基本条件：\n1) $E(\\rho_e)$ 在 $\\rho_e$ 上单调递增。\n2) $E(0) = E_{\\min}$ 且 $E(1) = E_0$，其中 $E_0$ 是完全实体材料的杨氏模量，$E_{\\min} \\ll E_0$ 是近乎空洞单元的伪刚度。\n3) 单元刚度矩阵与 $E(\\rho_e)$ 线性相关，即 $K_e(\\rho_e) = E(\\rho_e)\\,\\tilde{K}_e$，其中 $\\tilde{K}_e$ 是为单位模量计算的参考刚度矩阵。\n4) 罚函数指数 $p1$ 通过加剧 $E(0)$ 和 $E(1)$ 之间的对比，来强制实现对中间密度的能量不利性。\n\n仅使用这些条件和量纲一致性，首先对于给定的指数 $p$，重建与上述约束一致的最简单的平滑幂律插值函数 $E(\\rho_e)$。然后，对于 $p=3$，$E_{\\min}=10^{-3}E_0$，以及三个代表性单元密度 $\\rho_e \\in \\{0.1,\\,0.5,\\,0.9\\}$，计算归一化有效刚度 $E(\\rho_e)/E_0$。在拓扑优化的背景下，并与具有清晰材料边界的水平集方法进行对比，解释这些值如何反映对中间密度的惩罚以及 $E_{\\min}$ 在数值稳定性中的作用。\n\n将你的答案以行向量 $[\\,E(0.1)/E_0,\\;E(0.5)/E_0,\\;E(0.9)/E_0\\,]$ 的形式报告，使用精确值（不进行四舍五入）。无需单位，因为通过 $E_0$ 进行归一化后，这些量已变为无量纲。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n给定的条件如下：\n- 一个线性弹性柔度最小化问题使用有限元法（FEM）进行离散化。\n- 材料分布由单元密度 $\\rho_e \\in [0,1]$ 描述。\n- 使用了伪材料方法。\n- 框架是带有罚函数的固体各向同性材料（SIMP）模型。\n- 有效的单元杨氏模量 $E(\\rho_e)$ 必须满足四个条件：\n    1. $E(\\rho_e)$ 在 $\\rho_e$ 上单调递增。\n    2. 边界条件：$E(0) = E_{\\min}$ 且 $E(1) = E_0$，其中 $E_0$ 是实体材料模量，$E_{\\min} \\ll E_0$ 是伪刚度。\n    3. 单元刚度矩阵与模量线性相关：$K_e(\\rho_e) = E(\\rho_e)\\,\\tilde{K}_e$。\n    4. 使用罚函数指数 $p  1$ 在能量上抑制中间密度。\n- 用于计算的具体值：$p=3$，$E_{\\min}=10^{-3}E_0$。\n- 用于评估的代表性密度：$\\rho_e \\in \\{0.1,\\,0.5,\\,0.9\\}$。\n\n问题陈述的验证：\n- **科学依据**：该问题牢固地建立在连续介质力学和计算结构优化的既定理论之上。SIMP方法是拓扑优化中一种经典且广泛使用的技术。所有假设和条件都是该领域的标准做法。\n- **适定性**：问题是适定的。所提供的约束足以唯一确定最简单形式的插值函数。后续的计算是该推导函数的直接应用。\n- **客观性**：问题以精确、客观和技术性的语言陈述，没有歧义或主观论断。\n\n问题陈述被认为是有效的，因为它是科学上合理的、适定的、客观的和完整的。检查清单中未发现任何缺陷。可以开始求解过程。\n\n首先，我们必须根据给定条件重建有效杨氏模量 $E(\\rho_e)$ 的最简单平滑幂律插值。设函数为一般的幂律关系。惩罚（条件4）通过项 $\\rho_e^p$ 引入。为满足边界条件（条件2），我们寻求一个将经过惩罚的密度范围，即 $[0^p, 1^p] = [0, 1]$，映射到刚度范围 $[E_{\\min}, E_0]$ 的函数。最直接的方法是对经过惩罚的密度变量 $\\rho_e^p$ 到刚度 $E$ 进行简单的线性映射。\n\n让我们提出以下函数形式：\n$$\nE(\\rho_e) = A + B \\cdot \\rho_e^p\n$$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n使用条件2，我们有：\n当 $\\rho_e = 0$ 时：$E(0) = A + B \\cdot (0)^p = A$。给定 $E(0) = E_{\\min}$，因此 $A = E_{\\min}$。\n当 $\\rho_e = 1$ 时：$E(1) = A + B \\cdot (1)^p = A + B$。给定 $E(1) = E_0$。\n代入 $A = E_{\\min}$，我们得到 $E_0 = E_{\\min} + B$，这意味着 $B = E_0 - E_{\\min}$。\n\n将常数 $A$ 和 $B$ 代回所提出的形式，得到插值方案：\n$$\nE(\\rho_e) = E_{\\min} + (E_0 - E_{\\min})\\rho_e^p\n$$\n这是标准的SIMP插值模型。我们必须根据其余条件对其进行验证。\n\n- **条件1（单调性）**：我们检查 $E(\\rho_e)$ 相对于 $\\rho_e$ 的导数：\n$$\n\\frac{dE}{d\\rho_e} = \\frac{d}{d\\rho_e} \\left( E_{\\min} + (E_0 - E_{\\min})\\rho_e^p \\right) = (E_0 - E_{\\min}) p \\rho_e^{p-1}\n$$\n鉴于 $E_{\\min} \\ll E_0$，项 $(E_0 - E_{\\min})$ 是正的。罚函数指数 $p  1$ 也是正的。对于 $\\rho_e \\in [0, 1]$，项 $\\rho_e^{p-1}$ 是非负的。因此，在整个定义域上 $\\frac{dE}{d\\rho_e} \\ge 0$，证实了该函数是单调递增的。\n\n- **条件3（刚度矩阵的线性缩放）**：这一点由问题自身的设定所满足，其中单元刚度定义为 $K_e(\\rho_e) = E(\\rho_e)\\,\\tilde{K}_e$。我们推导出的 $E(\\rho_e)$ 是一个乘以参考刚度矩阵的标量函数，这与设定一致。\n\n- **条件4（惩罚）**：对于任何 $\\rho_e \\in (0, 1)$ 和 $p  1$，我们有 $\\rho_e^p  \\rho_e$。推导出的公式表明，模量与 $\\rho_e^p$ 成比例，而不是 $\\rho_e$。在一个典型的柔度最小化问题中，总材料体积是受约束的，并且与 $\\rho_e$ 线性相关。然而，刚度与 $\\rho_e^p$ 成比例。这种不匹配使得中间密度在结构上效率低下（相对于其体积“成本”而言刚度较低），从而驱使优化算法选择接近二元（0或1）的密度。\n\n接下来，我们计算在给定参数 $p=3$ 和 $E_{\\min} = 10^{-3}E_0$ 下的归一化有效刚度 $E(\\rho_e)/E_0$。\n归一化刚度为：\n$$\n\\frac{E(\\rho_e)}{E_0} = \\frac{E_{\\min} + (E_0 - E_{\\min})\\rho_e^p}{E_0} = \\frac{E_{\\min}}{E_0} + \\left(1 - \\frac{E_{\\min}}{E_0}\\right)\\rho_e^p\n$$\n代入给定值 $\\frac{E_{\\min}}{E_0} = 10^{-3} = 0.001$ 和 $p=3$：\n$$\n\\frac{E(\\rho_e)}{E_0} = 0.001 + (1 - 0.001)\\rho_e^3 = 0.001 + 0.999 \\rho_e^3\n$$\n现在我们为三个指定的 $\\rho_e$ 值计算此表达式：\n\n1. 对于 $\\rho_e = 0.1$：\n$$\n\\frac{E(0.1)}{E_0} = 0.001 + 0.999 \\cdot (0.1)^3 = 0.001 + 0.999 \\cdot 0.001 = 0.001 \\cdot (1 + 0.999) = 0.001999\n$$\n\n2. 对于 $\\rho_e = 0.5$：\n$$\n\\frac{E(0.5)}{E_0} = 0.001 + 0.999 \\cdot (0.5)^3 = 0.001 + 0.999 \\cdot 0.125 = 0.001 + 0.124875 = 0.125875\n$$\n\n3. 对于 $\\rho_e = 0.9$：\n$$\n\\frac{E(0.9)}{E_0} = 0.001 + 0.999 \\cdot (0.9)^3 = 0.001 + 0.999 \\cdot 0.729 = 0.001 + 0.728271 = 0.729271\n$$\n\n最后，我们提供所需的解释。\n\n- **对中间密度的惩罚**：计算出的值展示了惩罚效应。对于密度为 $\\rho_e=0.5$ 的单元，其归一化刚度仅约为 $0.126$。这个值远低于其密度本身。如果没有惩罚（即 $p=1$），归一化刚度将约为 $\\frac{E(0.5)}{E_0} \\approx 0.5$。指数 $p=3$ 将此中间密度单元的刚度贡献减少了约 $0.5 / 0.126 \\approx 4$ 倍。一个寻求在给定材料体积下最大化刚度的优化算法会因此发现使用此密度的材料效率极低，并被驱使将密度推向 $0$ 或 $1$，从而产生更接近黑白分明、可制造的设计。\n\n- **$E_{\\min}$ 的作用**：最小模量 $E_{\\min}$ 是一种数值手段，而非物理手段。在有限元公式中，必须对全局刚度矩阵 $\\mathbf{K}$ 求逆以求解线性方程组 $\\mathbf{KU}=\\mathbf{F}$。如果允许单元具有零刚度（$E=0$），大片“空洞”单元区域可能导致全局矩阵 $\\mathbf{K}$ 奇异（不可逆），从而导致模拟失败。通过为近乎空洞的单元（$\\rho_e \\approx 0$）赋予一个小的非零刚度 $E_{\\min}$，我们保证了 $\\mathbf{K}$ 在整个优化过程中保持正定和可逆。$\\rho_e=0.1$ 的结果显示了其效果：刚度 $0.001999 E_0$ 非常小，主要由 $E_{\\min}$ 项（贡献了 $0.001 E_0$）主导，但至关重要的是，它不为零。\n\n- **与水平集方法的对比**：SIMP是一种基于密度的方法，其中设计变量是在固定网格上定义的材料属性场 $\\rho_e(\\mathbf{x})$。该场可以包含中间密度区域（“灰色”材料），而惩罚方案对于抑制它们至关重要。相比之下，水平集方法是基于边界的。它们通过一个高维函数 $\\phi(\\mathbf{x})$ 的零等值线来隐式表示结构。区域被划分为离散的实体（$\\phi(\\mathbf{x}) \\ge 0$）和空洞（$\\phi(\\mathbf{x})  0$）区域，具有清晰、明确的边界。材料模型本身没有中间密度。因此，“惩罚”中间密度的概念与水平集方法无关。水平集方法中的优化通过演化边界形状来最小化柔度，而SIMP则演化材料分布。因此，水平集方法天生就能产生清晰、可直接用于分析的设计，但在引发拓扑变化（例如，创建新孔洞）方面面临更大挑战，而SIMP则能自然地处理这类任务。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.001999  0.125875  0.729271\n\\end{pmatrix}\n}\n$$", "id": "2606482"}, {"introduction": "拓扑优化的朴素实现有时会产生看似规整但物理上无意义的结果，其中棋盘格是最典型的例子。本练习旨在让您获得一个定量的“顿悟”时刻[@problem_id:2606624]。您将直接比较病态棋盘格设计与均匀设计的计算刚度，从而从数学上证明为何优化器会被“欺骗”而偏爱这些非物理的解。这个练习将数值不稳定性这一抽象问题具体化，并强调了引入诸如过滤等正则化方法的必要性。", "problem": "考虑采用固体各向同性材料惩罚模型 (SIMP) 插值弹性模量的线性弹性拓扑优化。设一个单位厚度、单位正方形域 $\\Omega = [0,1]\\times [0,1]$ 被一个均匀的 $2 \\times 2$ 双线性四边形有限元网格离散。假设为平面应力状态，泊松比 $\\nu = 0$，因此单轴能量密度简化为一维形式。弹性模量通过 SIMP 插值公式 $E(\\rho) = E_{\\min} + \\rho^{p}\\left(E_{0} - E_{\\min}\\right)$ 计算，其中惩罚指数 $p  1$。对于本问题，为关注不稳定性机制，设置 $E_{\\min} = 0$，并取 $E_{0}  0$ 为一个常数。\n\n通过在所有边界节点上施加位移场 $\\mathbf{u}(x,y) = (U x, 0)$（其中 $U = 1$）来施加运动学一致边界条件 (KUBC)。使用双线性形函数，该边界条件在每个单元内被精确再现，因此应变是均匀的，$\\epsilon_{xx} = 1$，所有其他分量均为零。\n\n将有效刚度 $K_{\\mathrm{eff}}$ 定义为边界 $\\{x=1\\}$ 上 $x$ 方向的总反力除以施加的标量 $U$。\n\n构建两种具有相同体积分数 $\\bar{\\rho} = \\frac{1}{2}$ 的设计：\n(1) 均匀设计，其中所有四个单元的密度均为 $\\rho_{e} \\equiv \\bar{\\rho}$，以及\n(2) 棋盘格设计，其中 $\\rho_{e} \\in \\{0,1\\}$，其排列方式为两个对角相对的单元密度 $\\rho_{e} = 1$，另外两个单元密度 $\\rho_{e} = 0$，从而得到相同的平均密度 $\\bar{\\rho} = \\frac{1}{2}$。\n\n从最小势能原理和 $K_{\\mathrm{eff}}$ 的定义出发，推导表观刚度优势因子 $R_{\\mathrm{pre}}$ 的表达式，该因子定义为棋盘格设计的有效刚度与均匀设计的有效刚度之比，$R_{\\mathrm{pre}} = \\dfrac{K_{\\mathrm{eff}}^{\\mathrm{checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}}$，且仅用 $p$ 表示。\n\n然后，对所有四个单元应用权重均匀的线性密度滤波器，即对每个单元 $e$，定义过滤后的密度 $\\tilde{\\rho}_{e} = \\dfrac{1}{4}\\sum_{j=1}^{4} \\rho_{j}$，并重新计算过滤后的棋盘格设计的有效刚度。基于相同的推理基础，解释为什么过滤后的比率 $R_{\\mathrm{post}} = \\dfrac{K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}}$ 变为 1。\n\n提供仅用 $p$ 表示的 $R_{\\mathrm{pre}}$ 的封闭形式解析表达式作为最终答案。无需进行数值代入。将最终答案表示为无单位的单一解析表达式。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，是适定的、客观的，并包含足够的信息以获得唯一解。我们可以继续。\n\n这个问题的核心在于系统的总应变能 $\\mathcal{U}$ 与其有效刚度 $K_{\\mathrm{eff}}$ 之间的关系。对于承受指定边界位移的线性弹性系统，平衡状态下的总应变能由 $\\mathcal{U} = \\frac{1}{2} K_{\\mathrm{eff}} U^2$ 给出，其中 $U$ 是所施加位移的特征大小。在本问题中，给定 $U=1$。因此，关系简化为 $K_{\\mathrm{eff}} = 2\\mathcal{U}$。\n\n总应变能 $\\mathcal{U}$ 是应变能密度 $w$ 在整个域体积 $V$ 上的积分。由于域被离散为 4 个有限元，总应变能是每个单元中能量的总和：\n$$ \\mathcal{U} = \\sum_{e=1}^{4} \\mathcal{U}_e = \\sum_{e=1}^{4} \\int_{\\Omega_e} w_e \\, dV $$\n应变能密度为 $w = \\frac{1}{2} \\boldsymbol{\\epsilon}^T \\mathbf{C} \\boldsymbol{\\epsilon}$。对于泊松比 $\\nu=0$ 的平面应力条件，本构矩阵 $\\mathbf{C}$ 是对角矩阵：\n$$ \\mathbf{C} = E(\\rho) \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix} $$\n问题陈述指出，运动学一致边界条件 (KUBC) 导致均匀应变场 $\\epsilon_{xx}=1$，且所有其他分量均为零。因此，应变向量为 $\\boldsymbol{\\epsilon} = (1, 0, 0)^T$。密度为 $\\rho_e$ 的单元 $e$ 内的应变能密度为：\n$$ w_e = \\frac{1}{2} E(\\rho_e) (1)^2 = \\frac{1}{2} E(\\rho_e) $$\n该域是一个单位厚度的单位正方形，因此其总体积为 1。$2 \\times 2$ 的均匀网格意味着 4 个单元中每个单元的体积为 $V_e = \\frac{1}{4}$。由于应变场是均匀的，并且每个单元内的材料属性是恒定的，单个单元的应变能为：\n$$ \\mathcal{U}_e = w_e V_e = \\left(\\frac{1}{2} E(\\rho_e)\\right) \\left(\\frac{1}{4}\\right) = \\frac{1}{8} E(\\rho_e) $$\n这个 4 单元组合体的总应变能是各项之和：\n$$ \\mathcal{U} = \\sum_{e=1}^{4} \\mathcal{U}_e = \\frac{1}{8} \\sum_{e=1}^{4} E(\\rho_e) $$\n使用给定的 SIMP 定律，$E(\\rho) = E_0 \\rho^p$（因为 $E_{\\min}=0$），总应变能为：\n$$ \\mathcal{U} = \\frac{E_0}{8} \\sum_{e=1}^{4} \\rho_e^p $$\n因此，有效刚度为：\n$$ K_{\\mathrm{eff}} = 2\\mathcal{U} = \\frac{E_0}{4} \\sum_{e=1}^{4} \\rho_e^p $$\n这个通用表达式使我们能够计算任何给定密度分布 $\\{\\rho_e\\}$ 的刚度。\n\n首先，我们分析均匀设计。在这里，所有 4 个单元的密度均为 $\\rho_e = \\bar{\\rho} = \\frac{1}{2}$。\n$$ K_{\\mathrm{eff}}^{\\mathrm{uniform}} = \\frac{E_0}{4} \\sum_{e=1}^{4} \\left(\\frac{1}{2}\\right)^p = \\frac{E_0}{4} \\left(4 \\cdot \\left(\\frac{1}{2}\\right)^p\\right) = E_0 \\left(\\frac{1}{2}\\right)^p = E_0 2^{-p} $$\n\n接下来，我们分析棋盘格设计。在这里，两个对角单元的密度为 $\\rho_e = 1$，另外两个的密度为 $\\rho_e = 0$。\n$$ K_{\\mathrm{eff}}^{\\mathrm{checker}} = \\frac{E_0}{4} \\left(1^p + 0^p + 1^p + 0^p\\right) = \\frac{E_0}{4} (1 + 0 + 1 + 0) = \\frac{E_0}{4}(2) = \\frac{E_0}{2} $$\n注意，对于 $p1$，$0^p=0$。密度为零的单元的刚度正确地为零。\n\n表观刚度优势因子 $R_{\\mathrm{pre}}$ 是这两种刚度的比值：\n$$ R_{\\mathrm{pre}} = \\frac{K_{\\mathrm{eff}}^{\\mathrm{checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}} = \\frac{E_0/2}{E_0 2^{-p}} = \\frac{1}{2} \\cdot 2^p = 2^{p-1} $$\n这个结果展示了在 SIMP 模型下棋盘格模式的人为刚化效应。因为对于 $p1$，惩罚函数 $f(\\rho) = \\rho^p$ 是凸函数，根据 Jensen 不等式，插值模量的算术平均值大于平均密度的模量：$\\frac{1}{N}\\sum E(\\rho_i) \\geq E(\\frac{1}{N}\\sum \\rho_i)$。KUBC 设置物理上实现了算术平均（Voigt 界），从而使棋盘格具有更高的表观刚度。\n\n现在我们考虑对所有 4 个单元应用权重均匀的线性密度滤波器。任何单元 $e$ 的过滤后密度（或物理密度）$\\tilde{\\rho}_e$ 由设计密度 $\\rho_j$ 的平均值给出：\n$$ \\tilde{\\rho}_{e} = \\frac{1}{4} \\sum_{j=1}^{4} \\rho_{j} $$\n对于棋盘格设计，设计密度为 $\\{\\rho_1, \\rho_2, \\rho_3, \\rho_4\\} = \\{1, 0, 1, 0\\}$（或其排列组合）。其和为 $\\sum \\rho_j = 1+0+1+0 = 2$。\n应用滤波器后，我们发现每个单元的物理密度为：\n$$ \\tilde{\\rho}_{e} = \\frac{1}{4}(2) = \\frac{1}{2} $$\n过滤后，棋盘格设计转变为每个单元的物理密度均为 $\\frac{1}{2}$ 的设计。这与最初的均匀设计完全相同。刚度是使用这些物理密度 $\\tilde{\\rho}_e$ 计算的：\n$$ K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}} = \\frac{E_0}{4} \\sum_{e=1}^{4} (\\tilde{\\rho}_e)^p = \\frac{E_0}{4} \\sum_{e=1}^{4} \\left(\\frac{1}{2}\\right)^p = E_0 2^{-p} $$\n根据构造，这与 $K_{\\mathrm{eff}}^{\\mathrm{uniform}}$ 相同。\n因此，过滤后的比率 $R_{\\mathrm{post}}$ 为：\n$$ R_{\\mathrm{post}} = \\frac{K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}} = \\frac{E_0 2^{-p}}{E_0 2^{-p}} = 1 $$\n滤波器通过强制施加一个长度尺度来消除人为的刚度优势，在应用物理学（刚度计算）之前，有效地将高频棋盘格图案平滑为其体积平均值。在这个使用全局平均滤波器的特定情况下，棋盘格设计在物理上与均匀设计无法区分，它们的刚度必然相等。\n\n问题要求给出 $R_{\\mathrm{pre}}$ 的解析表达式。", "answer": "$$\\boxed{2^{p-1}}$$", "id": "2606624"}, {"introduction": "优化器需要一张“地图”来寻找最佳设计，而在拓扑优化中，这张地图就是通过灵敏度分析提供的。本练习将引导您推导柔度灵敏度——即梯度信息——它告诉算法如何调整单元密度以提高结构性能[@problem_id:2606569]。通过将推导扩展到更符合实际的多工况情形，您将掌握开发稳健且实用的优化代码所必需的一项核心技术。", "problem": "一个线性弹性结构通过有限元法离散为 $n_{\\mathrm{el}}$ 个单元，其设计变量为 $\\rho_{e} \\in [0,1]$，$e \\in \\{1,\\dots,n_{\\mathrm{el}}\\}$。在带有惩罚的固体各向同性材料 (SIMP) 插值法中，等效弹性模量为 $E(\\rho_{e}) = E_{\\min} + \\rho_{e}^{p}\\left(E_{0} - E_{\\min}\\right)$，其中 $E_{0}  0$ 是固相材料的模量，$E_{\\min}  0$ 是一个很小的背景刚度，$p \\geq 1$ 是惩罚指数。令 $\\mathbf{K}(\\boldsymbol{\\rho})$ 为组装后的全局刚度矩阵，它是通过对单元刚度矩阵 $\\mathbf{K}_{e}(\\rho_{e}) = E(\\rho_{e})\\,\\mathbf{K}_{e}^{0}$ 进行标准有限元组装得到的，其中 $\\mathbf{K}_{e}^{0}$ 是在单位模量下计算的单元刚度模板。\n\n考虑 $m$ 个独立的静态载荷工况，索引为 $i \\in \\{1,\\dots,m\\}$，其载荷向量 $\\mathbf{f}_{i}$ 不依赖于 $\\boldsymbol{\\rho}$。对于每个载荷工况，状态向量 $\\mathbf{u}_{i}(\\boldsymbol{\\rho})$ 满足平衡方程 $\\mathbf{K}(\\boldsymbol{\\rho})\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho}) = \\mathbf{f}_{i}$。多载荷加权柔度目标函数为\n$$\nC(\\boldsymbol{\\rho}) = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho}),\n$$\n其中 $\\omega_{i}  0$ 是给定的权重。在利用密度灵敏度来定义 Hamilton–Jacobi 法向速度场的嵌入式水平集方法中，量 $\\partial C/\\partial \\rho_{e}$ 用作驱动信号。\n\n仅从上述定义、$\\mathbf{K}(\\boldsymbol{\\rho})$ 的对称性以及 $\\mathbf{f}_{i}$ 独立于 $\\boldsymbol{\\rho}$ 这一事实出发，推导精确灵敏度 $\\partial C/\\partial \\rho_{e}$ 的闭式表达式，该表达式应以局部单元位移向量 $\\mathbf{u}_{e,i}$ （即 $\\mathbf{u}_{i}$ 在单元 $e$ 的自由度上的分量）、权重 $\\omega_{i}$ 和 SIMP 参数表示。用 $\\mathbf{K}_{e}^{0}$、$p$、$E_{0}$、$E_{\\min}$、$\\rho_{e}$ 和 $\\mathbf{u}_{e,i}$ 表示你的最终答案，不要引入任何额外的近似或滤波。\n\n你的最终答案必须是单个闭式解析表达式。不需要进行数值近似，最终答案中也不应包含单位。", "solution": "所述问题具有科学依据，是适定的、客观且自洽的。它代表了连续体结构拓扑优化领域的一个标准推导。因此，将提供解答。\n\n目标是推导多载荷加权柔度函数 $C(\\boldsymbol{\\rho})$ 相对于单元 $e$ 的设计变量 $\\rho_{e}$ 的灵敏度 $\\frac{\\partial C}{\\partial \\rho_{e}}$。\n\n加权柔度由下式给出\n$$\nC(\\boldsymbol{\\rho}) = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho})\n$$\n其中 $\\omega_{i}  0$ 是权重，$\\mathbf{f}_{i}$ 是载荷向量，$\\mathbf{u}_{i}(\\boldsymbol{\\rho})$ 是每个载荷工况 $i \\in \\{1,\\dots,m\\}$ 的位移向量。\n\n$C(\\boldsymbol{\\rho})$ 相对于单个设计变量 $\\rho_{e}$ 的灵敏度可通过直接微分求得。应用链式法则，并注意载荷向量 $\\mathbf{f}_{i}$ 和权重 $\\omega_{i}$ 独立于设计变量 $\\boldsymbol{\\rho}$，我们得到：\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = \\frac{\\partial}{\\partial \\rho_{e}} \\left( \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\mathbf{u}_{i} \\right) = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}}\n$$\n该表达式包含项 $\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}}$，即状态向量的灵敏度。为求此项，我们利用每个载荷工况 $i$ 的控制静态平衡方程：\n$$\n\\mathbf{K}(\\boldsymbol{\\rho})\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho}) = \\mathbf{f}_{i}\n$$\n我们对此方程关于 $\\rho_{e}$ 进行微分，对左侧应用微分的乘法法则。由于 $\\mathbf{f}_{i}$ 不依赖于 $\\boldsymbol{\\rho}$，其导数为零。\n$$\n\\frac{\\partial}{\\partial \\rho_{e}} \\left( \\mathbf{K}\\,\\mathbf{u}_{i} \\right) = \\frac{\\partial \\mathbf{f}_{i}}{\\partial \\rho_{e}}\n$$\n$$\n\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i} + \\mathbf{K}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = \\mathbf{0}\n$$\n这是线性系统灵敏度分析中的一个标准结果。\n\n该方程可以求解出 $\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = -\\mathbf{K}^{-1} \\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}} \\mathbf{u}_{i}$ 并代回到 $\\frac{\\partial C}{\\partial \\rho_{e}}$ 的表达式中。然而，一个更直接的途径，即伴随法，是利用原始状态方程来重写 $\\mathbf{f}_{i}^{\\mathsf{T}}$。\n根据状态方程，$\\mathbf{f}_{i} = \\mathbf{K}\\mathbf{u}_{i}$。取转置得到 $\\mathbf{f}_{i}^{\\mathsf{T}} = (\\mathbf{K}\\mathbf{u}_{i})^{\\mathsf{T}} = \\mathbf{u}_{i}^{\\mathsf{T}}\\mathbf{K}^{\\mathsf{T}}$。问题陈述全局刚度矩阵 $\\mathbf{K}$ 是对称的，因此 $\\mathbf{K}^{\\mathsf{T}} = \\mathbf{K}$。于是，我们有 $\\mathbf{f}_{i}^{\\mathsf{T}} = \\mathbf{u}_{i}^{\\mathsf{T}}\\mathbf{K}$。\n\n将 $\\mathbf{f}_{i}^{\\mathsf{T}}$ 的这个表达式代入 $C$ 的灵敏度方程：\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = \\sum_{i=1}^{m} \\omega_{i}\\,\\left(\\mathbf{u}_{i}^{\\mathsf{T}}\\mathbf{K}\\right)\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{i}^{\\mathsf{T}} \\left( \\mathbf{K}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} \\right)\n$$\n根据微分后的状态方程，我们可以替换括号中的项：$\\mathbf{K}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = -\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i}$。\n这得到：\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{i}^{\\mathsf{T}} \\left( -\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i} \\right) = - \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i}\n$$\n这是柔度灵敏度的一般形式。该问题是自伴随的，因为伴随场与原始场 $\\mathbf{u}_{i}$ 相同。\n\n接下来，我们计算全局刚度矩阵的导数 $\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}$。全局矩阵 $\\mathbf{K}$ 是由单元刚度矩阵 $\\mathbf{K}_{j}(\\rho_{j})$ 组装而成的。矩阵 $\\mathbf{K}$ 仅通过单元 $e$ 的刚度矩阵 $\\mathbf{K}_{e}(\\rho_{e})$ 来依赖于特定的设计变量 $\\rho_{e}$。因此，组装求和对 $\\rho_{e}$ 的导数只剩下单元 $e$ 的项。二次型 $\\mathbf{u}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i}$ 可以仅用单元 $e$ 的局部量来表示：\n$$\n\\mathbf{u}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i} = \\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}\\,\\mathbf{u}_{e,i}\n$$\n其中 $\\mathbf{u}_{e,i}$ 是单元位移向量，包含从全局位移向量 $\\mathbf{u}_{i}$ 中提取的单元 $e$ 的自由度。\n\n将此代入灵敏度表达式，得到：\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = - \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}\\,\\mathbf{u}_{e,i}\n$$\n现在，我们必须求单元刚度矩阵的导数 $\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}$。\n给定 $\\mathbf{K}_{e}(\\rho_{e}) = E(\\rho_{e})\\,\\mathbf{K}_{e}^{0}$，其中 $\\mathbf{K}_{e}^{0}$ 是常数单元刚度模板，其导数为：\n$$\n\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}} = \\frac{dE(\\rho_{e})}{d\\rho_{e}}\\,\\mathbf{K}_{e}^{0}\n$$\nSIMP 插值法则是 $E(\\rho_{e}) = E_{\\min} + \\rho_{e}^{p}\\left(E_{0} - E_{\\min}\\right)$。关于 $\\rho_{e}$ 微分：\n$$\n\\frac{dE(\\rho_{e})}{d\\rho_{e}} = \\frac{d}{d\\rho_{e}} \\left( E_{\\min} + \\rho_{e}^{p}\\left(E_{0} - E_{\\min}\\right) \\right) = p\\,\\rho_{e}^{p-1}\\left(E_{0} - E_{\\min}\\right)\n$$\n将此代回到 $\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}$ 的表达式中，得到：\n$$\n\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}} = p\\,\\rho_{e}^{p-1}\\left(E_{0} - E_{\\min}\\right)\\,\\mathbf{K}_{e}^{0}\n$$\n最后，我们将此结果代入 $\\frac{\\partial C}{\\partial \\rho_{e}}$ 的方程中：\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = - \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\left( p\\,\\rho_{e}^{p-1}\\left(E_{0} - E_{\\min}\\right)\\,\\mathbf{K}_{e}^{0} \\right)\\,\\mathbf{u}_{e,i}\n$$\n标量项可以移到二次型和求和符号之外：\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = -p\\,\\left(E_{0} - E_{\\min}\\right)\\,\\rho_{e}^{p-1} \\sum_{i=1}^{m} \\omega_{i}\\,\\left( \\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\mathbf{K}_{e}^{0}\\,\\mathbf{u}_{e,i} \\right)\n$$\n这就是灵敏度的最终闭式表达式，用问题陈述中指定的量来表示。项 $\\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\mathbf{K}_{e}^{0}\\,\\mathbf{u}_{e,i}$ 表示在单位弹性模量下计算的单元 $e$ 在载荷工况 $i$ 下的应变能。", "answer": "$$\n\\boxed{-p \\left(E_{0} - E_{\\min}\\right) \\rho_{e}^{p-1} \\sum_{i=1}^{m} \\omega_{i} \\left( \\mathbf{u}_{e,i}^{\\mathsf{T}} \\mathbf{K}_{e}^{0} \\mathbf{u}_{e,i} \\right)}\n$$", "id": "2606569"}]}