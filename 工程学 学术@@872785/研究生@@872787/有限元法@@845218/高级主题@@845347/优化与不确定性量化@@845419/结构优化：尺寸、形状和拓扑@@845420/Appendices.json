{"hands_on_practices": [{"introduction": "梯度优化算法的基石是设计灵敏度，它指明了改进结构性能的方向。对于拥有大量设计变量的拓扑优化问题，伴随法是计算灵敏度的最高效方法。本练习将通过一个热学问题，引导你从第一性原理出发，推导并求解伴随方程，从而计算热柔度对单元密度的灵敏度，让你亲手掌握这一结构优化中的核心技术。[@problem_id:2604234]", "problem": "一个一维稳态热传导问题设置在一根长度为 $L$、均匀横截面积为 $A$ 的杆上，使用两个线性单元（节点 $1$–$3$）通过有限元法（FEM）进行离散化。单元 $e$ 中的热导率通过固体各向同性材料惩罚模型（SIMP）进行插值，\n$$\nk(\\rho_e) \\;=\\; k_{\\min} \\;+\\; \\rho_e^{\\,p}\\,\\big(k_0 - k_{\\min}\\big),\n$$\n其中 $\\rho_e \\in [0,1]$ 是单元密度，$k_0$ 是固体材料的导热系数，$k_{\\min}$ 是赋予类空洞材料的微小导热系数，$p$ 是惩罚指数。控制方程的强形式为 $-\\frac{d}{dx}\\!\\left(k(\\rho)\\,\\frac{dT}{dx}\\right)=0$，边界条件为左端 $T(0)=0$ 和右端指定的向外法向热通量 $\\bar{q}$。伽辽金弱形式为\n$$\n\\int_{0}^{L} k(\\rho)\\,\\frac{dT}{dx}\\,\\frac{dv}{dx}\\,dx \\;=\\; \\int_{\\Gamma_N} \\bar{q}\\,v\\,d\\Gamma,\n$$\n离散化后得到全局系统\n$$\n\\mathbf{K}(\\boldsymbol{\\rho})\\,\\mathbf{T}\\;=\\;\\mathbf{Q},\n$$\n其中 $\\mathbf{K}$ 是自由度的对称正定电导率矩阵，$\\mathbf{T}$ 是节点温度向量，$\\mathbf{Q}$ 是节点热载荷向量。\n\n考虑具体数据：\n- $L = 2$, $A=1$,\n- $k_0 = 2$, $k_{\\min}=0.2$, $p=3$,\n- 单元密度 $\\rho_1=0.5$，$\\rho_2=1$，\n- 边界条件为左端 $T(0)=0$，右端施加均匀向外热通量 $\\bar{q}=1$，因此最右侧节点的等效节点载荷为 $Q_3 = \\bar{q}\\,A = 1$，而其他节点载荷为零。\n\n令热柔度定义为\n$$\n\\mathcal{C}(\\mathbf{T},\\boldsymbol{\\rho}) \\;=\\; \\mathbf{Q}^{\\mathsf{T}}\\,\\mathbf{T},\n$$\n其中 $\\mathbf{Q}$ 与 $\\boldsymbol{\\rho}$ 无关。使用热伴随法，计算在给定设计点处的灵敏度 $\\frac{d\\mathcal{C}}{d\\rho_1}$。您必须从第一性原理出发，显式地构建伴随问题，然后评估得到的灵敏度表达式。最终灵敏度以 $\\mathrm{W\\cdot K}$ 为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求使用伴随法计算热柔度相对于单元设计变量 $\\rho_1$ 的灵敏度 $\\frac{d\\mathcal{C}}{d\\rho_1}$。求解的结构如下：首先，我们建立系统的有限元模型；其次，我们求解原始热传导问题以找到节点温度；第三，我们建立并求解伴随问题；最后，我们计算所需的灵敏度。\n\n**1. 有限元离散化**\n\n计算域为一根长度 $L=2$ 的杆，被离散为两个等长的线性有限元。\n- 单元 1 连接节点 1 ($x=0$) 和节点 2 ($x=1$)。其长度为 $l_1=1$，密度为 $\\rho_1=0.5$。\n- 单元 2 连接节点 2 ($x=1$) 和节点 3 ($x=2$)。其长度为 $l_2=1$，密度为 $\\rho_2=1.0$。\n\n单元热导率 $k_e$ 由固体各向同性材料惩罚模型（SIMP）给出：\n$$k(\\rho_e) = k_{\\min} + \\rho_e^p (k_0 - k_{\\min})$$\n使用给定数据 $k_0 = 2$、$k_{\\min} = 0.2$ 和 $p = 3$：\n对于单元 1 ($\\rho_1=0.5$)：\n$$k_1 = 0.2 + (0.5)^3 (2 - 0.2) = 0.2 + 0.125 \\times 1.8 = 0.2 + 0.225 = 0.425$$\n对于单元 2 ($\\rho_2=1.0$)：\n$$k_2 = 0.2 + (1.0)^3 (2 - 0.2) = 0.2 + 1.8 = 2.0$$\n\n一维线性单元的电导率矩阵由下式给出：\n$$\\mathbf{k}^e = \\frac{k_e A_e}{l_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n给定 $A=1$ 和 $l_1=l_2=1$，单元矩阵为：\n$$\\mathbf{k}^1 = k_1 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 0.425 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n$$\\mathbf{k}^2 = k_2 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 2.0 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n\n将这些组装成针对节点 1、2、3 的全局 $3 \\times 3$ 电导率矩阵：\n$$\\mathbf{K}_{global} = \\begin{pmatrix} k_1  -k_1  0 \\\\ -k_1  k_1+k_2  -k_2 \\\\ 0  -k_2  k_2 \\end{pmatrix} = \\begin{pmatrix} 0.425  -0.425  0 \\\\ -0.425  2.425  -2.0 \\\\ 0  -2.0  2.0 \\end{pmatrix}$$\n\n边界条件 $T(0)=0$ 意味着 $T_1=0$。我们对自由度（即节点 2 和节点 3 的温度 $T_2$ 和 $T_3$）的系统进行划分。简化的电导率矩阵 $\\mathbf{K}$ 和温度向量 $\\mathbf{T}$ 为：\n$$\\mathbf{K} = \\begin{pmatrix} k_1+k_2  -k_2 \\\\ -k_2  k_2 \\end{pmatrix} = \\begin{pmatrix} 2.425  -2.0 \\\\ -2.0  2.0 \\end{pmatrix}$$\n$$\\mathbf{T} = \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix}$$\n外部热载荷是在右端 ($x=L=2$) 的向外热通量 $\\bar{q}=1$，对应于节点 3。等效节点载荷为 $Q_3 = \\bar{q} A = 1 \\times 1 = 1$。节点 2 没有热源，所以 $Q_2=0$。自由度的载荷向量为：\n$$\\mathbf{Q} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n\n**2. 原始分析：状态方程的求解**\n\n用于求解未知温度的控制方程组为 $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$：\n$$\\begin{pmatrix} 2.425  -2.0 \\\\ -2.0  2.0 \\end{pmatrix} \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n由第二个方程得：\n$$-2.0 T_2 + 2.0 T_3 = 1 \\implies T_3 = T_2 + 0.5$$\n将此代入第一个方程：\n$$2.425 T_2 - 2.0 (T_2 + 0.5) = 0 \\implies 2.425 T_2 - 2.0 T_2 - 1.0 = 0$$\n$$0.425 T_2 = 1.0 \\implies T_2 = \\frac{1}{0.425} = \\frac{1}{17/40} = \\frac{40}{17}$$\n现在我们求 $T_3$：\n$$T_3 = \\frac{40}{17} + 0.5 = \\frac{40}{17} + \\frac{1}{2} = \\frac{80+17}{34} = \\frac{97}{34}$$\n温度向量为 $\\mathbf{T} = \\begin{pmatrix} 40/17 \\\\ 97/34 \\end{pmatrix}$。\n\n**3. 伴随灵敏度分析**\n\n要最小化的目标函数是热柔度 $\\mathcal{C} = \\mathbf{Q}^{\\mathsf{T}}\\mathbf{T}$。我们寻求其相对于设计变量 $\\rho_1$ 的导数。根据从第一性原理推导伴随问题的要求，我们使用拉格朗日乘子向量 $\\boldsymbol{\\lambda}$（伴随变量）定义一个增广目标泛函 $\\hat{\\mathcal{C}}$，以强制执行状态方程 $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$：\n$$\\hat{\\mathcal{C}}(\\mathbf{T}, \\boldsymbol{\\rho}, \\boldsymbol{\\lambda}) = \\mathcal{C}(\\mathbf{T}) + \\boldsymbol{\\lambda}^{\\mathsf{T}} (\\mathbf{Q} - \\mathbf{K}(\\boldsymbol{\\rho})\\mathbf{T})$$\n$\\mathcal{C}$ 关于 $\\rho_1$ 的全导数等于 $\\hat{\\mathcal{C}}$ 的全导数，因为约束项为零。\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = \\frac{d\\hat{\\mathcal{C}}}{d\\rho_1} = \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\rho_1} + \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\mathbf{T}} \\frac{d\\mathbf{T}}{d\\rho_1}$$\n我们选择 $\\boldsymbol{\\lambda}$ 使得包含状态变量未知灵敏度 $\\frac{d\\mathbf{T}}{d\\rho_1}$ 的项消失。我们将其系数设为零：\n$$\\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\mathbf{T}} = \\frac{\\partial}{\\partial\\mathbf{T}} (\\mathbf{Q}^{\\mathsf{T}}\\mathbf{T} + \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{Q} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K}\\mathbf{T}) = \\mathbf{Q}^{\\mathsf{T}} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K} = \\mathbf{0}$$\n这得到了伴随方程：\n$$\\mathbf{K}^{\\mathsf{T}}\\boldsymbol{\\lambda} = \\mathbf{Q}$$\n由于电导率矩阵 $\\mathbf{K}$ 是对称的（$\\mathbf{K}^{\\mathsf{T}}=\\mathbf{K}$），伴随方程为 $\\mathbf{K}\\boldsymbol{\\lambda} = \\mathbf{Q}$。此方程在形式上与原始状态方程 $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$ 相同。因此，该问题是自伴随的，伴随问题的解与原始问题的解相同：\n$$\\boldsymbol{\\lambda} = \\mathbf{T} = \\begin{pmatrix} 40/17 \\\\ 97/34 \\end{pmatrix}$$\n通过这样选择 $\\boldsymbol{\\lambda}$，灵敏度计算简化为 $\\hat{\\mathcal{C}}$ 关于 $\\rho_1$ 的偏导数：\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\rho_1} = \\frac{\\partial}{\\partial\\rho_1} (\\mathbf{Q}^{\\mathsf{T}}\\mathbf{T} + \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{Q} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K}\\mathbf{T}) = -\\boldsymbol{\\lambda}^{\\mathsf{T}} \\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} \\mathbf{T}$$\n\n**4. 灵敏度计算**\n\n我们必须求出电导率矩阵 $\\mathbf{K}$ 关于 $\\rho_1$ 的导数：\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\frac{\\partial}{\\partial\\rho_1} \\begin{pmatrix} k_1+k_2  -k_2 \\\\ -k_2  k_2 \\end{pmatrix}$$\n只有 $k_1$ 是 $\\rho_1$ 的函数。因此：\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\begin{pmatrix} \\frac{dk_1}{d\\rho_1}  0 \\\\ 0  0 \\end{pmatrix}$$\n导数 $\\frac{dk_1}{d\\rho_1}$ 由 SIMP 定律得出：\n$$\\frac{dk_1}{d\\rho_1} = \\frac{d}{d\\rho_1} \\left(k_{\\min} + \\rho_1^p(k_0 - k_{\\min})\\right) = p \\rho_1^{p-1} (k_0 - k_{\\min})$$\n代入给定值 $p=3$, $\\rho_1=0.5$, $k_0=2$ 和 $k_{\\min}=0.2$：\n$$\\frac{dk_1}{d\\rho_1} = 3 \\times (0.5)^{3-1} \\times (2 - 0.2) = 3 \\times (0.5)^2 \\times 1.8 = 3 \\times 0.25 \\times 1.8 = 0.75 \\times 1.8 = 1.35$$\n所以，刚度矩阵的导数为：\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\begin{pmatrix} 1.35  0 \\\\ 0  0 \\end{pmatrix}$$\n现在我们将所有部分代入灵敏度表达式。由于 $\\boldsymbol{\\lambda} = \\mathbf{T}$：\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -\\mathbf{T}^{\\mathsf{T}} \\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} \\mathbf{T} = - \\begin{pmatrix} T_2  T_3 \\end{pmatrix} \\begin{pmatrix} 1.35  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix}$$\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -1.35 \\times T_2^2$$\n代入 $T_2 = \\frac{40}{17}$ 的值：\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -1.35 \\times \\left(\\frac{40}{17}\\right)^2 = -1.35 \\times \\frac{1600}{289} \\approx -7.47404844...$$\n问题要求将结果四舍五入到四位有效数字。\n$$\\frac{d\\mathcal{C}}{d\\rho_1} \\approx -7.474$$\n柔度 $\\mathcal{C}$ 的单位是热载荷（功率，W）乘以温度（K），即 W·K。设计变量 $\\rho_1$ 是无量纲的。因此，灵敏度 $\\frac{d\\mathcal{C}}{d\\rho_1}$ 的单位是 W·K，符合要求。", "answer": "$$\\boxed{-7.474}$$", "id": "2604234"}, {"introduction": "获得灵敏度信息后，下一步是利用优化算法更新设计。最优性准则（OC）法是一种广泛应用于柔度最小化问题的经典高效算法。本练习模拟了OC算法迭代过程中的关键一步：在给定单元灵敏度的情况下，如何通过二分法搜索拉格朗日乘子 $\\lambda$，从而在满足体积约束的条件下更新单元密度。这个实践将帮助你深入理解优化算法如何处理工程约束。[@problem_id:2604194]", "problem": "在基于固体各向同性材料惩罚 (SIMP) 模型的最小柔度拓扑优化中，设计变量为单元密度 $\\rho_i \\in [\\rho_{\\min}, 1]$，目标是在全局体积约束下最小化柔度 $C(\\boldsymbol{\\rho})$。考虑一个包含 $4$ 个单位体积有限元的设计，对其进行一次带移动限制的优化准则 (OC) 更新。当前设计为 $\\rho_1^{k} = 0.5$，$\\rho_2^{k} = 0.7$，$\\rho_3^{k} = 0.3$，$\\rho_4^{k} = 0.9$。在 $\\boldsymbol{\\rho}^{k}$ 处计算得到的过滤后柔度灵敏度为 $\\frac{\\partial C}{\\partial \\rho_1} = -1.6$，$\\frac{\\partial C}{\\partial \\rho_2} = -0.2$，$\\frac{\\partial C}{\\partial \\rho_3} = -1.0$，$\\frac{\\partial C}{\\partial \\rho_4} = -0.05$。移动限制为 $m = 0.1$，下界为 $\\rho_{\\min} = 0.001$，OC 阻尼指数为 $\\eta = \\frac{1}{2}$。目标许用体积为 $V^{\\star} = 2.35$ (无量纲)，每个单元的体积均为单位体积。\n\n从体积约束最小柔度问题的 Karush–Kuhn–Tucker (KKT) 最优性条件和阻尼指数为 $\\eta = \\frac{1}{2}$ 的标准优化准则 (OC) 步骤的定义出发，首先推导出在给定移动限制和边界约束下，由 OC 更新产生的单参数单调映射 $\\rho_i^{\\text{new}}(\\lambda)$。然后，利用该单调性，通过二分法搜索计算拉格朗日乘子 $\\lambda$，使得更新后的设计满足等式约束 $\\sum_{i=1}^{4} \\rho_i^{\\text{new}}(\\lambda) = V^{\\star}$。将最终的 $\\lambda$ 表示为一个无量纲数。最终答案必须是单个实数。", "solution": "逐字提取已知条件：\n- 优化模型为固体各向同性材料惩罚 (SIMP) 模型。\n- 目标是最小化柔度 $C(\\boldsymbol{\\rho})$。\n- 设计变量为单元密度 $\\rho_i$。\n- 有限元数量为 $4$。\n- 每个单元的体积为单位体积，$V_i = 1$。\n- 当前设计迭代 $\\boldsymbol{\\rho}^{k}$：$\\rho_1^{k} = 0.5$，$\\rho_2^{k} = 0.7$，$\\rho_3^{k} = 0.3$，$\\rho_4^{k} = 0.9$。\n- 过滤后的柔度灵敏度：$\\frac{\\partial C}{\\partial \\rho_1} = -1.6$，$\\frac{\\partial C}{\\partial \\rho_2} = -0.2$，$\\frac{\\partial C}{\\partial \\rho_3} = -1.0$，$\\frac{\\partial C}{\\partial \\rho_4} = -0.05$。\n- 密度下界：$\\rho_{\\min} = 0.001$。\n- 密度上界默认为 $1$。\n- 移动限制：$m = 0.1$。\n- 优化准则 (OC) 阻尼指数：$\\eta = \\frac{1}{2}$。\n- 目标许用体积：$V^{\\star} = 2.35$。\n\n优化准则 (OC) 更新规则源于体积约束柔度最小化问题的 Karush–Kuhn–Tucker (KKT) 条件。在迭代 $k+1$ 时，单元 $i$ 密度的启发式更新由下式给出：\n$$\n\\rho_i^{k+1} = \\rho_i^k (B_i)^{\\eta}\n$$\n其中 $B_i$ 是单元灵敏度与全局拉格朗日乘子 $\\lambda$ 的比值，$\\eta$ 是一个阻尼指数。量 $B_i$ 定义为：\n$$\nB_i = \\frac{-\\frac{1}{V_i}\\frac{\\partial C}{\\partial \\rho_i}}{\\lambda}\n$$\n鉴于每个单元的体积为单位体积 $V_i=1$，且灵敏度 $\\frac{\\partial C}{\\partial \\rho_i}$ 已给出，我们定义灵敏度数 $S_i = -\\frac{\\partial C}{\\partial \\rho_i}$。当阻尼指数为 $\\eta = \\frac{1}{2}$ 时，原始的 OC 更新变为：\n$$\n\\tilde{\\rho}_i^{k+1}(\\lambda) = \\rho_i^k \\sqrt{\\frac{S_i}{\\lambda}}\n$$\n此更新必须受到下界 $\\rho_{\\min}$、上界 $1$ 和移动限制 $m$ 的约束。每个密度 $\\rho_i^{k+1}$ 的允许区间为 $[\\rho_i^{\\text{lower}}, \\rho_i^{\\text{upper}}]$，其中：\n$$\n\\rho_i^{\\text{lower}} = \\max(\\rho_{\\min}, \\rho_i^k - m)\n$$\n$$\n\\rho_i^{\\text{upper}} = \\min(1, \\rho_i^k + m)\n$$\n问题指定 $\\rho_{\\min} = 0.001$ 和 $m=0.1$。我们为每个单元计算这些边界：\n- 对于单元 1：$\\rho_1^k = 0.5$。$\\rho_1^{\\text{lower}} = \\max(0.001, 0.5 - 0.1) = 0.4$。$\\rho_1^{\\text{upper}} = \\min(1, 0.5 + 0.1) = 0.6$。\n- 对于单元 2：$\\rho_2^k = 0.7$。$\\rho_2^{\\text{lower}} = \\max(0.001, 0.7 - 0.1) = 0.6$。$\\rho_2^{\\text{upper}} = \\min(1, 0.7 + 0.1) = 0.8$。\n- 对于单元 3：$\\rho_3^k = 0.3$。$\\rho_3^{\\text{lower}} = \\max(0.001, 0.3 - 0.1) = 0.2$。$\\rho_3^{\\text{upper}} = \\min(1, 0.3 + 0.1) = 0.4$。\n- 对于单元 4：$\\rho_4^k = 0.9$。$\\rho_4^{\\text{lower}} = \\max(0.001, 0.9 - 0.1) = 0.8$。$\\rho_4^{\\text{upper}} = \\min(1, 0.9 + 0.1) = 1.0$。\n\n更新后的密度，我们记为 $\\rho_i^{\\text{new}}(\\lambda)$，是原始更新在其允许区间上的投影：\n$$\n\\rho_i^{\\text{new}}(\\lambda) = \\max \\left( \\rho_i^{\\text{lower}}, \\min \\left( \\tilde{\\rho}_i^{k+1}(\\lambda), \\rho_i^{\\text{upper}} \\right) \\right)\n$$\n这定义了单参数映射 $\\boldsymbol{\\rho}^{\\text{new}}(\\lambda)$。由于 $\\tilde{\\rho}_i^{k+1}(\\lambda)$ 是关于 $\\lambda$ 的严格递减函数（对于 $\\lambda  0$），并且投影到区间上保持单调性，所以每个 $\\rho_i^{\\text{new}}(\\lambda)$ 都是关于 $\\lambda$ 的非增函数。因此，总体积 $V(\\lambda) = \\sum_{i=1}^4 \\rho_i^{\\text{new}}(\\lambda)$ 也是关于 $\\lambda$ 的非增函数。这种单调性使我们能够找到满足体积约束的唯一 $\\lambda$。\n\n我们必须找到 $\\lambda$ 使得 $\\sum_{i=1}^4 \\rho_i^{\\text{new}}(\\lambda) = V^{\\star} = 2.35$。\n让我们定义 $K_i = \\rho_i^k \\sqrt{S_i}$，其中 $S_i = -\\frac{\\partial C}{\\partial \\rho_i}$。\n- $S_1 = 1.6$, $K_1 = 0.5 \\sqrt{1.6} = \\sqrt{0.25 \\times 1.6} = \\sqrt{0.4}$。\n- $S_2 = 0.2$, $K_2 = 0.7 \\sqrt{0.2} = \\sqrt{0.49 \\times 0.2} = \\sqrt{0.098}$。\n- $S_3 = 1.0$, $K_3 = 0.3 \\sqrt{1.0} = 0.3 = \\sqrt{0.09}$。\n- $S_4 = 0.05$, $K_4 = 0.9 \\sqrt{0.05} = \\sqrt{0.81 \\times 0.05} = \\sqrt{0.0405}$。\n\n当 $\\rho_i^{\\text{lower}}  \\frac{K_i}{\\sqrt{\\lambda}}  \\rho_i^{\\text{upper}}$ 时，单元 $i$ 是“激活的”（即未达到其边界）。这等价于 $\\lambda$ 处于区间 $(\\lambda_{i,U}, \\lambda_{i,L})$ 内，其中：\n$$\n\\lambda_{i,U} = \\left(\\frac{K_i}{\\rho_i^{\\text{upper}}}\\right)^2 \\quad \\text{和} \\quad \\lambda_{i,L} = \\left(\\frac{K_i}{\\rho_i^{\\text{lower}}}\\right)^2\n$$\n- 单元 1：$\\lambda_{1,U} = \\frac{0.4}{(0.6)^2} = \\frac{0.4}{0.36} = \\frac{10}{9}$。$\\lambda_{1,L} = \\frac{0.4}{(0.4)^2} = \\frac{0.4}{0.16} = 2.5$。在 $\\lambda \\in (10/9, 2.5)$ 时激活。\n- 单元 2：$\\lambda_{2,U} = \\frac{0.098}{(0.8)^2} = \\frac{0.098}{0.64} = \\frac{49}{320} \\approx 0.1531$。$\\lambda_{2,L} = \\frac{0.098}{(0.6)^2} = \\frac{0.098}{0.36} = \\frac{49}{180} \\approx 0.2722$。在 $\\lambda \\in (49/320, 49/180)$ 时激活。\n- 单元 3：$\\lambda_{3,U} = \\frac{0.09}{(0.4)^2} = \\frac{0.09}{0.16} = \\frac{9}{16} = 0.5625$。$\\lambda_{3,L} = \\frac{0.09}{(0.2)^2} = \\frac{0.09}{0.04} = \\frac{9}{4} = 2.25$。在 $\\lambda \\in (9/16, 9/4)$ 时激活。\n- 单元 4：$\\lambda_{4,U} = \\frac{0.0405}{(1.0)^2} = 0.0405$。$\\lambda_{4,L} = \\frac{0.0405}{(0.8)^2} = \\frac{0.0405}{0.64} = \\frac{81}{1280} \\approx 0.0633$。在 $\\lambda \\in (0.0405, 81/1280)$ 时激活。\n\n我们寻求 $V(\\lambda) - 2.35 = 0$ 的根。通过在关键的 $\\lambda$ 点上评估 $V(\\lambda)$，我们可以确定每个单元的状态并找到包含解的区间。让我们分析总体积函数 $V(\\lambda) = \\sum \\rho_i^{\\text{new}}(\\lambda)$。\n- 对于 $\\lambda \\le \\lambda_{3,U} = 9/16 = 0.5625$：$\\rho_3$ 处于其上界，$\\rho_3^{\\text{new}}=0.4$。此外，对于 $\\lambda \\in (49/180, 9/16)$，$\\rho_2$ 处于其下界，$\\rho_2^{\\text{new}}=0.6$。在此范围内，$V(\\lambda) = 0.6 + 0.6 + 0.4 + 0.8 = 2.4$。这里的体积是恒定的。\n由于当 $\\lambda \\le 0.5625$ 时 $V(\\lambda)=2.4 > V^{\\star}=2.35$，解必须出现在 $\\lambda > 0.5625$ 的情况。\n\n考虑区间 $\\lambda \\in (9/16, 9/4) = (0.5625, 2.25)$。\n- 对于单元 1：$\\lambda  10/9 \\approx 1.111$，所以 $\\rho_1^{\\text{new}} = \\rho_1^{\\text{upper}} = 0.6$。\n- 对于单元 2：$\\lambda > 49/180 \\approx 0.2722$，所以 $\\rho_2^{\\text{new}} = \\rho_2^{\\text{lower}} = 0.6$。\n- 对于单元 3：$\\lambda$ 在其激活范围内，所以 $\\rho_3^{\\text{new}} = \\frac{K_3}{\\sqrt{\\lambda}} = \\frac{0.3}{\\sqrt{\\lambda}}$。\n- 对于单元 4：$\\lambda > 81/1280 \\approx 0.0633$，所以 $\\rho_4^{\\text{new}} = \\rho_4^{\\text{lower}} = 0.8$。\n\n在此区间内的总体积为：\n$$\nV(\\lambda) = 0.6 + 0.6 + \\frac{0.3}{\\sqrt{\\lambda}} + 0.8 = 2.0 + \\frac{0.3}{\\sqrt{\\lambda}}\n$$\n我们将其设为等于目标体积 $V^{\\star}$：\n$$\n2.0 + \\frac{0.3}{\\sqrt{\\lambda}} = 2.35\n$$\n$$\n\\frac{0.3}{\\sqrt{\\lambda}} = 0.35\n$$\n$$\n\\sqrt{\\lambda} = \\frac{0.3}{0.35} = \\frac{30}{35} = \\frac{6}{7}\n$$\n$$\n\\lambda = \\left(\\frac{6}{7}\\right)^2 = \\frac{36}{49}\n$$\n我们必须验证这个 $\\lambda$ 值是否位于单元 3 的假定激活区间内。\n$\\lambda = 36/49 \\approx 0.7347$。区间是 $(9/16, 9/4) = (0.5625, 2.25)$。\n由于 $0.5625  0.7347  2.25$，我们的假设是一致的。计算出的拉格朗日乘子是正确的。\n\n在 $\\lambda = 36/49$ 时，新的密度为：\n$\\rho_1^{\\text{new}} = 0.6$ (在移动上限)\n$\\rho_2^{\\text{new}} = 0.6$ (在移动下限)\n$\\rho_3^{\\text{new}} = \\frac{0.3}{\\sqrt{36/49}} = \\frac{0.3}{6/7} = 0.3 \\times \\frac{7}{6} = 0.35$ (激活)\n$\\rho_4^{\\text{new}} = 0.8$ (在移动下限)\n总体积为 $\\sum \\rho_i^{\\text{new}} = 0.6 + 0.6 + 0.35 + 0.8 = 2.35$，与 $V^{\\star}$ 正确匹配。", "answer": "$$\\boxed{\\frac{36}{49}}$$", "id": "2604194"}, {"introduction": "除了通过增减材料进行优化（尺寸和拓扑优化），我们还可以通过改变结构的边界形状来提升性能，这被称为形状优化。本练习将通过一个经典的弹性力学问题——含圆孔的无限大板，来计算柔度对于边界扰动的形状导数。通过将形状微扰与精确的应力场解相结合，你将理解结构性能是如何与边界上局部力学状态紧密相关的，这与基于域的拓扑优化灵敏度形成了鲜明对比。[@problem_id:2604201]", "problem": "考虑一个单位厚度的二维各向同性线性弹性板，板内含一个半径为 $a$ 的无牵引力圆孔。该板为无限大，在无穷远处沿 $x$ 轴方向承受均匀单轴拉伸应力 $\\sigma_0$。假设为平面应力状态，杨氏模量为 $E$，泊松比为 $\\nu$，且无体力。设 $\\Omega$ 表示弹性（材料）域，$\\Gamma_h$ 表示孔边界。柔度泛函 $J(\\Omega)$ 定义为载荷功，根据 Clapeyron 定理，在线性弹性力学中其值等于总应变能的两倍。\n\n现要求计算柔度 $J(\\Omega)$ 由一个局限在 $\\Gamma_h$ 上的光滑法向边界扰动所引起的一阶变分（形状导数）。该扰动由一个速度场 $\\mathbf{V}$ 给出，其法向分量为\n$$\n\\mathbf{V}\\cdot \\mathbf{n} \\;=\\; \\varepsilon \\cos(2\\theta)\\,,\n$$\n其中 $\\theta$ 是从 $x$ 轴起以弧度度量的极角，$\\varepsilon$ 是一个具有长度量纲的微小恒定振幅，$\\mathbf{n}$ 是材料域的外单位法向量（在 $\\Gamma_h$ 上指向孔内）。扰动在所有其他边界上均为零，且无穷远处的远程载荷在空间中保持固定。\n\n请仅从线性弹性力学中形状演算的基本原理（包括柔度的定义、Clapeyron 定理、域变分的输运定理以及域泛函一阶变分的结构）出发，推导形状导数 $dJ[\\mathbf{V}]$ 的边界积分表达式，并利用圆孔周围的精确应力场（Kirsch 解）以及平面应力本构律对其进行求值。用 $a$、$\\sigma_0$、$E$ 和 $\\varepsilon$ 的符号表示最终结果。报告单位厚度下 $dJ[\\mathbf{V}]$ 的最终值，单位为牛顿-米。最终的方框表达式中不应包含单位。角度必须以弧度处理。答案必须是单一的闭式解析表达式。", "solution": "目标是计算柔度泛函 $J(\\Omega)$ 在圆孔边界 $\\Gamma_h$ 上由给定的法向速度场 $\\mathbf{V}$ 引起的一阶变分（或形状导数）$dJ[\\mathbf{V}]$。\n\n柔度 $J(\\Omega)$ 定义为外力所做的功。对于线性弹性体，根据 Clapeyron 定理，它等于总弹性应变能 $U$ 的两倍。总应变能是应变能密度 $W(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$ 在材料域 $\\Omega$ 上的积分。\n$$\nJ(\\Omega) = 2U = 2 \\int_{\\Omega} W(\\boldsymbol{\\varepsilon}) \\, dV = \\int_{\\Omega} \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} \\, dV\n$$\n此处，$\\boldsymbol{\\sigma}$ 是应力张量，$\\boldsymbol{\\varepsilon}$ 是应变张量。\n\n对于一个仅在无牵引力边界 $\\Gamma_h$ 上非零的速度场 $\\mathbf{V}$ 所定义的扰动，柔度泛函的形状导数由经典的边界积分公式给出：\n$$\ndJ[\\mathbf{V}] = \\int_{\\Gamma_h} (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) (\\mathbf{V} \\cdot \\mathbf{n}) \\, dS\n$$\n其中 $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$ 是在边界 $\\Gamma_h$ 上计算的应变能密度，$\\mathbf{V}\\cdot\\mathbf{n}$ 是速度场的法向分量。单位法向量 $\\mathbf{n}$ 从材料域向外指出，即指向孔内。\n\n问题给出了孔边界 $\\Gamma_h$ 上的法向速度为 $\\mathbf{V}\\cdot\\mathbf{n} = \\varepsilon \\cos(2\\theta)$。边界 $\\Gamma_h$ 是一个半径为 $a$ 的圆。对于单位厚度，弧长微元为 $dS = a\\,d\\theta$。因此，形状导数为：\n$$\ndJ[\\mathbf{V}] = \\int_{0}^{2\\pi} (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} \\, (\\varepsilon \\cos(2\\theta)) \\, (a \\, d\\theta)\n$$\n\n为计算此积分，我们需要孔边界上的应力场和应变场。我们使用 Kirsch 解，该解描述了无限大板在沿 $x$ 轴的单轴远程拉伸应力 $\\sigma_0$ 作用下，圆孔周围的应力场。在极坐标 $(r, \\theta)$ 中，孔边界（$r=a$）上的应力分量为：\n$$\n\\sigma_{rr}|_{r=a} = 0\n$$\n$$\n\\sigma_{\\theta\\theta}|_{r=a} = \\sigma_0(1 - 2\\cos(2\\theta))\n$$\n$$\n\\sigma_{r\\theta}|_{r=a} = 0\n$$\n$\\sigma_{rr}$ 和 $\\sigma_{r\\theta}$ 为零证实了孔上的无牵引力边界条件。\n\n边界上的应变能密度为 $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\sigma_{rr}\\varepsilon_{rr} + \\sigma_{\\theta\\theta}\\varepsilon_{\\theta\\theta} + 2\\sigma_{r\\theta}\\varepsilon_{r\\theta}$。根据边界应力，这可简化为：\n$$\n(\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} = \\sigma_{\\theta\\theta}|_{r=a} \\, \\varepsilon_{\\theta\\theta}|_{r=a}\n$$\n应变分量 $\\varepsilon_{\\theta\\theta}$ 通过平面应力本构律与应力分量相关：\n$$\n\\varepsilon_{\\theta\\theta} = \\frac{1}{E}(\\sigma_{\\theta\\theta} - \\nu \\sigma_{rr})\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n在边界 $r=a$ 处计算该式，此时 $\\sigma_{rr}=0$：\n$$\n\\varepsilon_{\\theta\\theta}|_{r=a} = \\frac{1}{E}\\sigma_{\\theta\\theta}|_{r=a}\n$$\n因此，边界上的应变能密度可以完全用环向应力 $\\sigma_{\\theta\\theta}$ 表示：\n$$\n(\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} = \\sigma_{\\theta\\theta}|_{r=a} \\left(\\frac{\\sigma_{\\theta\\theta}|_{r=a}}{E}\\right) = \\frac{(\\sigma_{\\theta\\theta}|_{r=a})^2}{E}\n$$\n代入 Kirsch 解中的环向应力：\n$$\n(\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} = \\frac{[\\sigma_0(1 - 2\\cos(2\\theta))]^2}{E} = \\frac{\\sigma_0^2}{E}(1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta))\n$$\n现在我们将此表达式代入 $dJ[\\mathbf{V}]$ 的积分中：\n$$\ndJ[\\mathbf{V}] = \\int_{0}^{2\\pi} \\left[ \\frac{\\sigma_0^2}{E}(1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta)) \\right] (\\varepsilon \\cos(2\\theta)) (a \\, d\\theta)\n$$\n我们将常数项移到积分符号外：\n$$\ndJ[\\mathbf{V}] = \\frac{a \\varepsilon \\sigma_0^2}{E} \\int_{0}^{2\\pi} (1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta)) \\cos(2\\theta) \\, d\\theta\n$$\n让我们展开被积函数：\n$$\n(1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta)) \\cos(2\\theta) = \\cos(2\\theta) - 4\\cos^2(2\\theta) + 4\\cos^3(2\\theta)\n$$\n该积分逐项计算：\n$$\n\\int_{0}^{2\\pi} (\\cos(2\\theta) - 4\\cos^2(2\\theta) + 4\\cos^3(2\\theta)) \\, d\\theta\n$$\n我们使用以下标准定积分：\n1.  对于任何整数 $n \\neq 0$，$\\int_{0}^{2\\pi} \\cos(n\\theta) \\, d\\theta = 0$。\n2.  $\\int_{0}^{2\\pi} \\cos^2(n\\theta) \\, d\\theta = \\int_{0}^{2\\pi} \\frac{1+\\cos(2n\\theta)}{2} \\, d\\theta = \\pi$。\n3.  $\\int_{0}^{2\\pi} \\cos^3(n\\theta) \\, d\\theta = \\int_{0}^{2\\pi} \\frac{\\cos(3n\\theta) + 3\\cos(n\\theta)}{4} \\, d\\theta = 0$。\n\n应用这些结果：\n$$\n\\int_{0}^{2\\pi} \\cos(2\\theta) \\, d\\theta = 0\n$$\n$$\n-4 \\int_{0}^{2\\pi} \\cos^2(2\\theta) \\, d\\theta = -4\\pi\n$$\n$$\n4 \\int_{0}^{2\\pi} \\cos^3(2\\theta) \\, d\\theta = 0\n$$\n将这些贡献相加，积分的总值为 $0 - 4\\pi + 0 = -4\\pi$。\n\n最后，我们将此结果代回 $dJ[\\mathbf{V}]$ 的表达式中：\n$$\ndJ[\\mathbf{V}] = \\frac{a \\varepsilon \\sigma_0^2}{E} (-4\\pi)\n$$\n这就给出了单位厚度柔度一阶变分的最终符号表达式。", "answer": "$$\\boxed{- \\frac{4\\pi a \\varepsilon \\sigma_0^2}{E}}$$", "id": "2604201"}]}