{"hands_on_practices": [{"introduction": "多项式混沌展开 (Polynomial Chaos Expansion, PCE) 是许多随机有限元方法的核心。为了有效地使用PCE，我们必须首先理解其基础——正交多项式基函数是如何构建的。本练习 [@problem_id:2686929] 将指导你构建用于高斯不确定性问题的多元Hermite多项式基，这一过程不仅能让你具体感受基函数的结构，还能让你理解其规模是如何随问题维度和展开阶数增长的，这对评估计算成本至关重要。", "problem": "在随机有限元方法中，随机响应通常用多项式混沌展开（PCE）表示，该展开是基于与输入分布相适应的正交基构建的。考虑一个由独立标准正态随机变量组成的$m$维向量$\\boldsymbol{\\Xi} = (\\Xi_{1},\\ldots,\\Xi_{m})$，以及由概率论学家的Hermite多项式构建的相关Hermite混沌基。这些多项式在$L^{2}$空间中关于标准正态密度是正交的。单变量概率论学家的Hermite多项式由Rodrigues公式定义\n$$\n\\mathrm{He}_{n}(\\xi) = (-1)^{n} \\exp\\!\\left(\\frac{\\xi^{2}}{2}\\right) \\frac{d^{n}}{d\\xi^{n}} \\exp\\!\\left(-\\frac{\\xi^{2}}{2}\\right),\n$$\n其中前三项为 $\\mathrm{He}_{0}(\\xi)=1$、$\\mathrm{He}_{1}(\\xi)=\\xi$ 和 $\\mathrm{He}_{2}(\\xi)=\\xi^{2}-1$。\n\n通过张量积定义多变量Hermite混沌基函数，这些函数由多重索引$\\boldsymbol{\\alpha}=(\\alpha_{1},\\ldots,\\alpha_{m}) \\in \\mathbb{N}_{0}^{m}$和总阶数$|\\boldsymbol{\\alpha}|=\\sum_{i=1}^{m}\\alpha_{i}$索引：\n$$\n\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) \\equiv \\prod_{i=1}^{m} \\mathrm{He}_{\\alpha_{i}}(\\Xi_{i}).\n$$\n\n任务：\n- 对于总阶数$p=2$和通用维度$m$，用$\\mathrm{He}_{0}$、$\\mathrm{He}_{1}$和$\\mathrm{He}_{2}$明确写出多变量基函数集合$\\{\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) : |\\boldsymbol{\\alpha}| \\leq p\\}$，并按总阶数$|\\boldsymbol{\\alpha}|=0$、$|\\boldsymbol{\\alpha}|=1$和$|\\boldsymbol{\\alpha}|=2$进行组织。你的描述应清楚地指出所有不同类型的项，不遗漏任何类别。\n- 仅使用基于非负整数解计数的第一性原理组合推理，推导总阶数至多为$p=2$的不同多变量基函数的总数，并表示为$m$的封闭形式函数。\n\n最终答案需以$m$的单个解析表达式形式给出。无需四舍五入，也无需单位。", "solution": "问题陈述已经过验证，被认为是科学合理的、适定的和客观的。它不包含科学或事实上的不准确之处，结构严谨，并为唯一解提供了所有必要的定义和约束。因此，我们将进行推导。\n\n问题分为两个任务：第一，明确描述总阶数$p \\leq 2$的多变量Hermite基函数集合；第二，推导这些函数总数的封闭形式表达式，作为维度$m$的函数。\n\n**第一部分：$|\\boldsymbol{\\alpha}| \\leq 2$ 的基函数枚举**\n\n我们需要找出所有不同的多重索引 $\\boldsymbol{\\alpha} = (\\alpha_{1}, \\ldots, \\alpha_{m}) \\in \\mathbb{N}_{0}^{m}$，使得总阶数 $|\\boldsymbol{\\alpha}| = \\sum_{i=1}^{m} \\alpha_{i}$ 小于或等于$2$。基函数 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi})$ 是通过单变量Hermite多项式 $\\mathrm{He}_{\\alpha_{i}}(\\Xi_{i})$ 的张量积构建的。我们按总阶数来组织基函数。\n\n**情况1：总阶数 $|\\boldsymbol{\\alpha}| = 0$**\n条件 $\\sum_{i=1}^{m} \\alpha_{i} = 0$ 以及所有 $\\alpha_{i} \\in \\mathbb{N}_{0}$ 的约束，只有一个可能的解：对于所有 $i \\in \\{1, \\ldots, m\\}$，$\\alpha_{i} = 0$。\n这对应于单个多重索引 $\\boldsymbol{\\alpha} = (0, 0, \\ldots, 0)$。\n得到的基函数是：\n$$ \\Psi_{(0, \\ldots, 0)}(\\boldsymbol{\\Xi}) = \\prod_{i=1}^{m} \\mathrm{He}_{0}(\\Xi_{i}) = \\prod_{i=1}^{m} 1 = 1 $$\n总阶数为 $0$ 的基函数有 $1$ 个。\n\n**情况2：总阶数 $|\\boldsymbol{\\alpha}| = 1$**\n条件是 $\\sum_{i=1}^{m} \\alpha_{i} = 1$。对于非负整数 $\\alpha_{i}$，这意味着恰好有一个分量（比如 $\\alpha_{j}$）必须等于 $1$，而所有其他分量 $\\alpha_{k}$（对于 $k \\neq j$）必须为 $0$。\n索引 $j$ 可以是 $1$ 到 $m$ 之间的任意整数。因此，这种形式有 $m$ 个不同的多重索引。对于每个 $j \\in \\{1, \\ldots, m\\}$，多重索引为 $\\boldsymbol{\\alpha} = (0, \\ldots, 1, \\ldots, 0)$，其中 $1$ 在第 $j$ 个位置。\n相应的基函数是：\n$$ \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) = \\mathrm{He}_{1}(\\Xi_{j}) \\prod_{k \\neq j} \\mathrm{He}_{0}(\\Xi_{k}) = \\mathrm{He}_{1}(\\Xi_{j}) $$\n总阶数为 $1$ 的基函数集合是 $\\{\\mathrm{He}_{1}(\\Xi_{j}) : j=1, \\ldots, m\\}$。共有 $m$ 个这样的函数。\n\n**情况3：总阶数 $|\\boldsymbol{\\alpha}| = 2$**\n条件是 $\\sum_{i=1}^{m} \\alpha_{i} = 2$。对于非负整数 $\\alpha_{i}$，有两种不同类型的解：\n- **类型3a：** 一个分量为 $2$，其余全为 $0$。令某个 $j \\in \\{1, \\ldots, m\\}$ 的 $\\alpha_{j} = 2$，且对于所有 $k \\neq j$，$\\alpha_{k} = 0$。有 $m$ 个这样的多重索引。相应的基函数形式为：\n$$ \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) = \\mathrm{He}_{2}(\\Xi_{j}) \\prod_{k \\neq j} \\mathrm{He}_{0}(\\Xi_{k}) = \\mathrm{He}_{2}(\\Xi_{j}) $$\n这给出了 $m$ 个“纯”二阶基函数的集合：$\\{\\mathrm{He}_{2}(\\Xi_{j}) : j=1, \\ldots, m\\}$。\n\n- **类型3b：** 两个分量为 $1$，其余全为 $0$。令两个不同索引 $j, k \\in \\{1, \\ldots, m\\}$（$j \\neq k$）的 $\\alpha_{j} = 1$ 和 $\\alpha_{k} = 1$。所有其他分量都为 $0$。从 $m$ 个元素中选择两个不同索引的方法数由二项式系数 $\\binom{m}{2}$ 给出。相应的基函数形式为：\n$$ \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\Xi}) = \\mathrm{He}_{1}(\\Xi_{j}) \\mathrm{He}_{1}(\\Xi_{k}) \\prod_{l \\neq j,k} \\mathrm{He}_{0}(\\Xi_{l}) = \\mathrm{He}_{1}(\\Xi_{j})\\mathrm{He}_{1}(\\Xi_{k}) $$\n这给出了 $\\binom{m}{2} = \\frac{m(m-1)}{2}$ 个“混合”二阶基函数的集合：$\\{\\mathrm{He}_{1}(\\Xi_{j})\\mathrm{He}_{1}(\\Xi_{k}) : 1 \\leq j  k \\leq m\\}$。\n\n阶数为 $2$ 的基函数总数是这两种不相交类型计数的和：$m + \\binom{m}{2}$。\n\n**第二部分：$|\\boldsymbol{\\alpha}| \\leq 2$ 的基函数总数**\n\n我们必须推导总阶数至多为 $p=2$ 的不同基函数的总数。这等同于求多重索引集合 $S = \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{m} : |\\boldsymbol{\\alpha}| \\leq 2\\}$ 的基数。这是一个标准的组合问题。\n\n计算不等式 $\\sum_{i=1}^{m} \\alpha_{i} \\leq p$ 的非负整数解数量的问题，可以转化为计算一个等式的解数量。我们引入一个辅助“松弛”变量 $\\alpha_{m+1} \\in \\mathbb{N}_{0}$，使得不等式变成一个包含 $m+1$ 个变量的等式：\n$$ \\sum_{i=1}^{m} \\alpha_{i} + \\alpha_{m+1} = p $$\n这个方程的非负整数解的数量由“隔板法”（stars and bars）公式给出。该问题等价于将 $p$ 个不可区分的物品（星）分配到 $m+1$ 个可区分的箱子（变量 $\\alpha_{1}, \\ldots, \\alpha_{m+1}$）中。实现此目的的方法数由以下公式给出：\n$$ N_{m,p} = \\binom{p + (m+1) - 1}{(m+1) - 1} = \\binom{p+m}{m} = \\binom{p+m}{p} $$\n对于本问题的特定情况，我们有 $p=2$。基函数的总数 $N$ 是：\n$$ N = \\binom{2+m}{m} = \\binom{m+2}{2} $$\n我们展开这个二项式系数以获得最终的封闭形式表达式：\n$$ N = \\frac{(m+2)!}{2!(m+2-2)!} = \\frac{(m+2)!}{2 \\cdot m!} = \\frac{(m+2)(m+1)m!}{2m!} = \\frac{(m+1)(m+2)}{2} $$\n这个结果可以通过将在第一部分为每个阶数推导出的计数相加来验证：\n- 阶数 $0$：$1$ 个函数。\n- 阶数 $1$：$m$ 个函数。\n- 阶数 $2$：$m + \\binom{m}{2}$ 个函数。\n总数 $N$：\n$$ N = 1 + m + \\left(m + \\binom{m}{2}\\right) = 1 + 2m + \\frac{m(m-1)}{2} $$\n$$ N = \\frac{2 + 4m + m^2 - m}{2} = \\frac{m^2 + 3m + 2}{2} = \\frac{(m+1)(m+2)}{2} $$\n该验证证实了通过隔板法得到的结果。最终表达式是所要求的关于$m$的封闭形式函数。", "answer": "$$\\boxed{\\frac{(m+1)(m+2)}{2}}$$", "id": "2686929"}, {"introduction": "多项式混沌展开的真正威力在于它能极大地简化统计矩的计算。一旦我们将一个随机的物理量（例如位移）表示为PCE形式，我们就可以利用基函数的正交性，直接从展开系数中解析地计算出其均值、方差等统计信息。本练习 [@problem_id:2600487] 演示了这一关键的后处理步骤，揭示了如何将复杂的积分运算转化为简单的代数运算，从而高效地获取结果。", "problem": "考虑一个具有随机系数场的一维、稳态、线性椭圆边值问题，该问题通过有限元法（FEM）进行离散化。随机伽辽金近似使用关于单个标准正态随机变量 $\\xi \\sim \\mathcal{N}(0,1)$ 的广义多项式混沌（gPC）和概率论者的 Hermite 基 $\\{\\mathrm{He}_{\\alpha}(\\xi)\\}_{\\alpha=0}^{3}$。该基在 $L^{2}(\\mathbb{R},\\rho)$ 中是正交的，其中 $\\rho$ 是标准正态密度，满足 $\\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)\\,\\mathrm{He}_{\\beta}(\\xi)]=\\alpha!\\,\\delta_{\\alpha\\beta}$，并且 $\\mathrm{He}_{0}(\\xi)\\equiv 1$，对于所有 $\\alpha \\geq 1$，$\\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)]=0$。近似解场表示为\n$$\nu_{h}(x,\\xi)=\\sum_{m=1}^{3}\\phi_{m}(x)\\sum_{\\alpha=0}^{3}c_{m,\\alpha}\\,\\mathrm{He}_{\\alpha}(\\xi),\n$$\n在空间域 $[0,1]$ 上，使用包含两个线性单元的均匀网格，节点基函数位于 $x=0$、$x=\\tfrac{1}{2}$ 和 $x=1$。分段线性有限元形函数 $\\{\\phi_{m}(x)\\}_{m=1}^{3}$ 是此网格上常用的帽函数。系数矩阵 $\\boldsymbol{C}=[c_{m,\\alpha}]$ 由下式给出\n$$\n\\boldsymbol{C} \\;=\\;\n\\begin{pmatrix}\n1.0  0.5  -0.3  0.0 \\\\\n2.0  -0.2  0.4  0.25 \\\\\n0.0  0.1  0.0  -0.05\n\\end{pmatrix},\n$$\n其中行索引 $m\\in\\{1,2,3\\}$ 对应于空间基函数 $\\phi_{m}(x)$，列索引 $\\alpha\\in\\{0,1,2,3\\}$ 对应于 $\\mathrm{He}_{\\alpha}(\\xi)$。\n\n仅使用基的正交性和统计矩的定义，计算 $u_{h}(x,\\xi)$ 在空间位置 $\\hat{x}=0.3$ 处的均值和逐点方差。\n\n将您的最终答案表示为单行矩阵 $\\begin{pmatrix}\\mu  \\sigma^{2}\\end{pmatrix}$，其中 $\\mu$ 是均值，$\\sigma^{2}$ 是在 $x=\\hat{x}$ 处的方差，四舍五入到四位有效数字。这些量是无量纲的；答案中不要包含单位。", "solution": "必须首先验证问题的科学合理性、完整性和客观性。\n\n已知条件如下：\n- 来自随机有限元法的近似解：$u_{h}(x,\\xi)=\\sum_{m=1}^{3}\\phi_{m}(x)\\sum_{\\alpha=0}^{3}c_{m,\\alpha}\\,\\mathrm{He}_{\\alpha}(\\xi)$。\n- 随机变量是标准正态的：$\\xi \\sim \\mathcal{N}(0,1)$。\n- 随机基是概率论者的 Hermite 基 $\\{\\mathrm{He}_{\\alpha}(\\xi)\\}_{\\alpha=0}^{3}$。\n- 基的正交性条件是 $\\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)\\,\\mathrm{He}_{\\beta}(\\xi)]=\\alpha!\\,\\delta_{\\alpha\\beta}$。\n- 对于非常数项，基函数的均值为零：$\\mathrm{He}_{0}(\\xi)=1$，对于 $\\alpha \\geq 1$，$\\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)]=0$。\n- 空间域为 $[0,1]$，节点位于 $x \\in \\{0, \\frac{1}{2}, 1\\}$。\n- 空间基函数 $\\{\\phi_{m}(x)\\}_{m=1}^{3}$ 是分别对应于节点 $x=0$、$x=0.5$ 和 $x=1$ 的标准分段线性（帽）函数。\n- 系数矩阵 $\\boldsymbol{C}=[c_{m,\\alpha}]$ 如下：\n$$\n\\boldsymbol{C} \\;=\\;\n\\begin{pmatrix}\n1.0  0.5  -0.3  0.0 \\\\\n2.0  -0.2  0.4  0.25 \\\\\n0.0  0.1  0.0  -0.05\n\\end{pmatrix}\n$$\n- 任务是计算 $u_{h}(x,\\xi)$ 在位置 $\\hat{x}=0.3$ 处的均值 $\\mu$ 和逐点方差 $\\sigma^{2}$。\n\n该问题是有效的。它描述了使用随机伽辽金方法进行不确定性量化的一个标准场景。所有提供的信息都是一致的、科学上合理的，并且足以执行所需的计算。该问题是将统计矩的定义直接应用于给定的多项式混沌展开。不存在矛盾、歧义或违反科学原理的地方。因此，我们可以着手求解。\n\n近似解由广义多项式混沌（gPC）展开给出：\n$$u_{h}(x,\\xi) = \\sum_{m=1}^{3}\\phi_{m}(x) \\left( \\sum_{\\alpha=0}^{3}c_{m,\\alpha}\\,\\mathrm{He}_{\\alpha}(\\xi) \\right)$$\n我们可以通过按随机基函数对各项进行分组来重写此表达式：\n$$u_{h}(x,\\xi) = \\sum_{\\alpha=0}^{3} \\left( \\sum_{m=1}^{3} c_{m,\\alpha}\\,\\phi_{m}(x) \\right) \\mathrm{He}_{\\alpha}(\\xi)$$\n让我们在特定空间位置 $\\hat{x}=0.3$ 处评估此表达式。首先，我们必须确定分段线性基函数 $\\phi_{m}(x)$ 在此点的值。节点位于 $x_{1}=0$、$x_{2}=0.5$ 和 $x_{3}=1$。点 $\\hat{x}=0.3$ 位于第一个单元内，介于节点 $x_{1}=0$ 和 $x_{2}=0.5$ 之间。\n\n在区间 $[0, 0.5]$ 上的帽函数表达式为：\n- $\\phi_{1}(x) = \\frac{x_{2}-x}{x_{2}-x_{1}} = \\frac{0.5-x}{0.5} = 1 - 2x$\n- $\\phi_{2}(x) = \\frac{x-x_{1}}{x_{2}-x_{1}} = \\frac{x-0}{0.5} = 2x$\n- $\\phi_{3}(x) = 0$ for $x \\in [0, 0.5]$\n\n在 $\\hat{x}=0.3$ 处求值：\n- $\\phi_{1}(0.3) = 1 - 2(0.3) = 1 - 0.6 = 0.4$\n- $\\phi_{2}(0.3) = 2(0.3) = 0.6$\n- $\\phi_{3}(0.3) = 0$\n\n现在，我们可以写出 $u_{h}(0.3, \\xi)$ 的具体 gPC 展开式：\n$$u_{h}(0.3, \\xi) = \\sum_{\\alpha=0}^{3} \\left( c_{1,\\alpha}\\,\\phi_{1}(0.3) + c_{2,\\alpha}\\,\\phi_{2}(0.3) + c_{3,\\alpha}\\,\\phi_{3}(0.3) \\right) \\mathrm{He}_{\\alpha}(\\xi)$$\n令每个 Hermite 多项式的总系数为 $d_{\\alpha}$：\n$$d_{\\alpha} = c_{1,\\alpha}\\,\\phi_{1}(0.3) + c_{2,\\alpha}\\,\\phi_{2}(0.3) + c_{3,\\alpha}\\,\\phi_{3}(0.3)$$\n所以，$u_{h}(0.3, \\xi) = \\sum_{\\alpha=0}^{3} d_{\\alpha} \\mathrm{He}_{\\alpha}(\\xi)$。\n\n使用值 $\\phi_{1}(0.3)=0.4$、$\\phi_{2}(0.3)=0.6$ 和 $\\phi_{3}(0.3)=0$ 以及给定的矩阵 $\\boldsymbol{C}$：\n- 对于 $\\alpha=0$：$d_{0} = c_{1,0}(0.4) + c_{2,0}(0.6) = (1.0)(0.4) + (2.0)(0.6) = 0.4 + 1.2 = 1.6$\n- 对于 $\\alpha=1$：$d_{1} = c_{1,1}(0.4) + c_{2,1}(0.6) = (0.5)(0.4) + (-0.2)(0.6) = 0.20 - 0.12 = 0.08$\n- 对于 $\\alpha=2$：$d_{2} = c_{1,2}(0.4) + c_{2,2}(0.6) = (-0.3)(0.4) + (0.4)(0.6) = -0.12 + 0.24 = 0.12$\n- 对于 $\\alpha=3$：$d_{3} = c_{1,3}(0.4) + c_{2,3}(0.6) = (0.0)(0.4) + (0.25)(0.6) = 0 + 0.15 = 0.15$\n\n$u_{h}(0.3, \\xi)$ 的均值 $\\mu$ 是其期望值 $\\mathbb{E}[u_{h}(0.3, \\xi)]$。根据期望的线性性质：\n$$\\mu = \\mathbb{E}\\left[\\sum_{\\alpha=0}^{3} d_{\\alpha} \\mathrm{He}_{\\alpha}(\\xi)\\right] = \\sum_{\\alpha=0}^{3} d_{\\alpha} \\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)]$$\n使用性质 $\\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)] = \\delta_{\\alpha 0}$，我们得到：\n$$\\mu = d_{0} \\mathbb{E}[\\mathrm{He}_{0}(\\xi)] + \\sum_{\\alpha=1}^{3} d_{\\alpha} \\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)] = d_{0} \\cdot 1 + \\sum_{\\alpha=1}^{3} d_{\\alpha} \\cdot 0 = d_{0}$$\n因此，均值为 $\\mu = 1.6$。\n\n$u_{h}(0.3, \\xi)$ 的方差 $\\sigma^{2}$ 由 $\\mathbb{V}[u_{h}(0.3, \\xi)] = \\mathbb{E}[(u_{h}(0.3, \\xi) - \\mu)^2]$ 给出。\n由于 $\\mu = d_{0} \\mathrm{He}_{0}(\\xi)$（因为 $\\mathrm{He}_{0}(\\xi) = 1$），与均值的偏差为：\n$$u_{h}(0.3, \\xi) - \\mu = \\left(\\sum_{\\alpha=0}^{3} d_{\\alpha} \\mathrm{He}_{\\alpha}(\\xi)\\right) - d_{0}\\mathrm{He}_{0}(\\xi) = \\sum_{\\alpha=1}^{3} d_{\\alpha} \\mathrm{He}_{\\alpha}(\\xi)$$\n那么方差为：\n$$\\sigma^{2} = \\mathbb{E}\\left[ \\left( \\sum_{\\alpha=1}^{3} d_{\\alpha} \\mathrm{He}_{\\alpha}(\\xi) \\right)^2 \\right] = \\mathbb{E}\\left[ \\left( \\sum_{\\alpha=1}^{3} d_{\\alpha} \\mathrm{He}_{\\alpha}(\\xi) \\right) \\left( \\sum_{\\beta=1}^{3} d_{\\beta} \\mathrm{He}_{\\beta}(\\xi) \\right) \\right]$$\n$$\\sigma^{2} = \\sum_{\\alpha=1}^{3}\\sum_{\\beta=1}^{3} d_{\\alpha}d_{\\beta} \\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)\\mathrm{He}_{\\beta}(\\xi)]$$\n使用正交性质 $\\mathbb{E}[\\mathrm{He}_{\\alpha}(\\xi)\\mathrm{He}_{\\beta}(\\xi)] = \\alpha! \\delta_{\\alpha\\beta}$：\n$$\\sigma^{2} = \\sum_{\\alpha=1}^{3}\\sum_{\\beta=1}^{3} d_{\\alpha}d_{\\beta} (\\alpha! \\delta_{\\alpha\\beta}) = \\sum_{\\alpha=1}^{3} d_{\\alpha}^2 (\\alpha!)$$\n代入计算出的 $d_{\\alpha}$ 值：\n$$\\sigma^{2} = d_{1}^2(1!) + d_{2}^2(2!) + d_{3}^2(3!)$$\n$$\\sigma^{2} = (0.08)^2(1) + (0.12)^2(2) + (0.15)^2(6)$$\n$$\\sigma^{2} = 0.0064 + (0.0144)(2) + (0.0225)(6)$$\n$$\\sigma^{2} = 0.0064 + 0.0288 + 0.135$$\n$$\\sigma^{2} = 0.1702$$\n\n题目要求结果四舍五入到四位有效数字。\n均值为 $\\mu=1.6$，保留四位有效数字为 $1.600$。\n方差为 $\\sigma^{2}=0.1702$，已经有四位有效数字。\n\n最终答案包含均值 $\\mu = 1.600$ 和方差 $\\sigma^{2} = 0.1702$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.600  0.1702\n\\end{pmatrix}\n}\n$$", "id": "2600487"}, {"introduction": "掌握任何计算方法的最后一步是亲手实现并验证它。本练习 [@problem_id:2686978] 将引导你完成一个使用蒙特卡洛方法的随机有限元代码的完整验证过程。通过将一个带随机弹性模量的简单一维杆的数值模拟结果与已知的解析解进行比较，你将在模型建立、不确定性传播和至关重要的代码验证方面获得宝贵的实践经验。", "problem": "考虑一根长度为 $L$、横截面积恒为 $A$ 的直棱柱式一维轴向杆。该杆受到沿其轴线作用的单位长度上均布的轴向体力 $b$。杆的两端均被固定，即位移边界条件为 $u(0)=0$ 和 $u(L)=0$。轴向位移场 $u(x)$ 满足一维力平衡和线性弹性，其基本出发点如下：平衡强形式 $dN/dx + b = 0$（其中轴向力 $N(x) = A \\sigma(x)$）、运动学关系 $\\varepsilon = du/dx$ 以及 Hooke 定律 $\\sigma = E \\varepsilon$（其中 $E$ 是杨氏模量）。假设小应变和线性行为。\n\n在本问题中，杨氏模量 $E$ 是不确定的，并被建模为杆上单一的空间均匀随机变量（即，$E$ 的同一样本实现适用于所有单元和所有 $x \\in [0,L]$）。随机变量 $E$ 服从对数正态分布，其特征为均值 $\\mu_E$ 和变异系数 $c_E$。所有物理量必须使用国际单位制（SI）：长度单位为米（m），面积单位为平方米（m$^2$），力单位为牛顿（N），应力单位为帕斯卡（Pa），位移单位为米（m）。不涉及角度。您的程序的所有输出必须是无量纲的布尔值，因此没有单位。\n\n您需要通过复现两端固定时跨中节点位移的解析均值和方差，来验证一个随机有限元方法（SFEM）的实现，验证方法使用蒙特卡洛模拟（MCS）。使用标准的线性有限元离散化，包括 $N_e$ 个均匀的两节点杆单元、针对均布体力 $b$ 的协调单元荷载向量，以及在两端精确施加 Dirichlet 边界条件。当单元数量为偶数时，跨中对应于 $x=L/2$ 处的内部节点。由于 $E$ 是空间均匀的，组装后的全局刚度矩阵 $K$ 与 $E$ 呈线性比例关系，而对于固定的荷载向量 $f$，位移向量与 $E$ 呈反比关系。利用这一结构以避免冗余求解：首先计算一次单位模量情况（$E=1$）下的确定性位移向量，然后通过缩放将 $E$ 的样本映射为位移样本。\n\n您的程序需要执行的任务：\n- 为每个测试用例组装 $E=1$ 的有限元模型，并计算跨中节点位移 $u_{\\text{mid}}^{(1)}$。\n- 将 $E$ 建模为均值为 $\\mu_E$、变异系数为 $c_E$ 的对数正态随机变量。仅使用对数正态分布的成熟性质，根据 $\\mu_E$ 和 $c_E$ 推导解析期望 $\\mathbb{E}[1/E]$ 和方差 $\\operatorname{Var}[1/E]$，并由此获得跨中位移的解析均值和方差，该位移与 $E$ 的关系为 $u_{\\text{mid}} = u_{\\text{mid}}^{(1)}/E$。\n- 使用固定的确定性种子执行蒙特卡洛模拟，以生成 $E$ 的样本并计算 $u_{\\text{mid}}$ 的样本，然后使用总体公式估计 $u_{\\text{mid}}$ 的样本均值和方差。\n- 对于每个测试用例，使用容差规则 $\\lvert \\widehat{m} - m \\rvert \\le \\max(r_{\\text{tol}} \\lvert m \\rvert, a_{\\text{tol}})$ 和 $\\lvert \\widehat{v} - v \\rvert \\le \\max(r_{\\text{tol}} \\lvert v \\rvert, a_{\\text{tol}})$ 将蒙特卡洛估计值与解析均值和方差进行比较，其中 $\\widehat{m}$ 和 $\\widehat{v}$ 是蒙特卡洛估计值，$m$ 和 $v$ 是解析值，$r_{\\text{tol}}$ 是相对容差，$a_{\\text{tol}}$ 是绝对容差。当且仅当两个比较都通过时，测试用例的布尔结果为真。\n\n您的程序必须为以下测试套件实现此验证，所有量均以 SI 单位给出：\n- 测试用例 1 (正常路径): $L = 2.0$, $A = 0.01$, $b = 1.0 \\times 10^{5}$, $\\mu_E = 2.0 \\times 10^{11}$, $c_E = 0.1$, $N_e = 10$, 蒙特卡洛样本数 $N_s = 100000$, 均值的相对容差 $r_{\\text{tol},m} = 0.01$, 方差的相对容差 $r_{\\text{tol},v} = 0.03$, 绝对容差 $a_{\\text{tol},m} = 0$, $a_{\\text{tol},v} = 0$。\n- 测试用例 2 (零变异性的退化边界情况): $L = 1.0$, $A = 0.005$, $b = 5.0 \\times 10^{4}$, $\\mu_E = 1.5 \\times 10^{11}$, $c_E = 0.0$, $N_e = 8$, $N_s = 5000$, $r_{\\text{tol},m} = 1.0 \\times 10^{-12}$, $r_{\\text{tol},v} = 0.0$, $a_{\\text{tol},m} = 0$, $a_{\\text{tol},v} = 1.0 \\times 10^{-24}$。\n- 测试用例 3 (高变异性): $L = 3.0$, $A = 0.02$, $b = 2.0 \\times 10^{5}$, $\\mu_E = 7.0 \\times 10^{10}$, $c_E = 0.5$, $N_e = 20$, $N_s = 200000$, $r_{\\text{tol},m} = 0.015$, $r_{\\text{tol},v} = 0.03$, $a_{\\text{tol},m} = 0$, $a_{\\text{tol},v} = 0$。\n\n实现和数值要求：\n- 使用均匀网格（$N_e$ 为偶数）、线性形函数以及针对均布 $b$ 的协调单元荷载向量。精确施加 $u(0)=0$ 和 $u(L)=0$。\n- 每个测试用例使用有限元组装和求解计算一次 $E=1$ 时的确定性跨中位移 $u_{\\text{mid}}^{(1)}$。\n- 使用从 $\\mu_E$ 和 $c_E$ 获得的标准参数化方法，以及所有测试用例通用的固定伪随机数生成器种子，生成 $E$ 的对数正态样本。\n- 使用总体公式估计样本均值和方差。\n- 执行上述容差检查。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的布尔结果，形式为方括号内以逗号分隔的列表（例如，“[True,False,True]”）。不允许有其他输出。", "solution": "我们从一维轴向平衡和线性弹性理论出发。轴向力平衡为 $dN/dx + b = 0$，其中 $N(x) = A \\sigma(x)$，应变 $\\varepsilon(x) = du/dx$，以及 Hooke 定律 $\\sigma(x) = E \\varepsilon(x)$。消去 $\\sigma$ 和 $\\varepsilon$ 得到强形式\n$$\n\\frac{d}{dx} \\left( A E \\frac{du}{dx} \\right) + b = 0 \\quad \\text{on } x \\in (0,L), \\quad u(0)=0, \\quad u(L)=0.\n$$\n对于恒定的 $A$ 和空间均匀的 $E$，积分可得到一个二次精确位移场；由于两端的 Dirichlet 条件，该场是唯一确定的。在具有 $N_e$ 个均匀线性单元（两节点杆）的有限元方法中，Galerkin 公式得到组装后的线性系统\n$$\nK(E) \\, \\mathbf{u} = \\mathbf{f},\n$$\n其中，在施加 $u(0)=u(L)=0$ 后，$K(E)$ 对于内部自由度是对称正定的。对于长度为 $h=L/N_e$ 区间上的一个两节点单元，其模量为 $E$ 时的单元刚度为\n$$\nk_e(E) = \\frac{A E}{h} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix},\n$$\n以及均布体力 $b$ 的协调单元荷载向量为\n$$\n\\mathbf{f}_e = \\frac{b h}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}.\n$$\n对所有单元进行组装并强制施加齐次 Dirichlet 边界条件，得到关于内部节点的简化系统，由此我们可以恢复节点位移向量 $\\mathbf{u}(E)$。因为 $k_e(E)$ 以及因此 $K(E)$ 与 $E$ 呈线性比例关系，而 $\\mathbf{f}$ 不依赖于 $E$，我们有\n$$\nK(E) = E \\, K(1), \\quad \\Rightarrow \\quad \\mathbf{u}(E) = K(E)^{-1} \\mathbf{f} = \\frac{1}{E} K(1)^{-1} \\mathbf{f} = \\frac{1}{E} \\, \\mathbf{u}^{(1)},\n$$\n其中 $\\mathbf{u}^{(1)} := \\mathbf{u}(E=1)$ 是单位模量情况下的位移向量。因此，对于跨中节点（当 $N_e$ 为偶数时，这是一个内部节点），位移为\n$$\nu_{\\text{mid}}(E) = \\frac{u_{\\text{mid}}^{(1)}}{E}.\n$$\n\n我们现在将随机模量 $E$ 的不确定性传播到 $u_{\\text{mid}}$。杨氏模量被建模为均值为 $\\mu_E$、变异系数为 $c_E$ 的对数正态分布。如果 $E$ 是对数正态的，那么 $\\ln E$ 是高斯的，其参数 $\\mu$ 和 $\\sigma^2$ 满足众所周知的关系\n$$\n\\mathbb{E}[E] = \\mu_E = e^{\\mu + \\frac{1}{2} \\sigma^2}, \\qquad \\operatorname{Var}(E) = \\mu_E^2 \\, c_E^2 = \\left(e^{\\sigma^2} - 1\\right) e^{2\\mu + \\sigma^2}.\n$$\n由此，方差参数可恢复为\n$$\n\\sigma^2 = \\ln(1 + c_E^2),\n$$\n位置参数为\n$$\n\\mu = \\ln(\\mu_E) - \\frac{1}{2} \\sigma^2.\n$$\n对数正态变量的倒数也是对数正态的：如果 $E \\sim \\text{LogNormal}(\\mu, \\sigma^2)$，则 $Y := 1/E \\sim \\text{LogNormal}(-\\mu, \\sigma^2)$。因此，\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{E}\\right] = e^{-\\mu + \\frac{1}{2} \\sigma^2}, \\qquad \\operatorname{Var}\\!\\left(\\frac{1}{E}\\right) = \\left(e^{\\sigma^2} - 1\\right) e^{-2\\mu + \\sigma^2}.\n$$\n所以，因为 $u_{\\text{mid}}(E) = u_{\\text{mid}}^{(1)} \\cdot (1/E)$，跨中位移的解析均值和方差为\n$$\nm := \\mathbb{E}[u_{\\text{mid}}] = u_{\\text{mid}}^{(1)} \\, \\mathbb{E}\\!\\left[\\frac{1}{E}\\right] = u_{\\text{mid}}^{(1)} \\, e^{-\\mu + \\frac{1}{2} \\sigma^2},\n$$\n$$\nv := \\operatorname{Var}(u_{\\text{mid}}) = \\left(u_{\\text{mid}}^{(1)}\\right)^2 \\, \\operatorname{Var}\\!\\left(\\frac{1}{E}\\right) = \\left(u_{\\text{mid}}^{(1)}\\right)^2 \\left(e^{\\sigma^2} - 1\\right) e^{-2\\mu + \\sigma^2}.\n$$\n\n算法设计：\n- 对于每个测试用例，组装 $E=1$ 时的全局刚度矩阵和荷载向量，以计算 $\\mathbf{u}^{(1)}$ 并提取 $u_{\\text{mid}}^{(1)}$。这使用了上面定义的单元矩阵 $k_e(1)$ 和 $\\mathbf{f}_e$ 以及标准组装方法。通过移除刚度矩阵的第一行和最后一列以及荷载向量中的相应条目来强制执行 $u(0)=u(L)=0$。求解简化的线性系统，并用零在边界处重构完整的位移向量。\n- 将 $\\mu_E$ 和 $c_E$ 转换为底层正态分布的参数 $\\mu$ 和 $\\sigma^2$，通过 $\\sigma^2 = \\ln(1+c_E^2)$ 和 $\\mu = \\ln(\\mu_E) - \\frac{1}{2}\\sigma^2$。通过设置 $\\sigma=0$ 来处理 $c_E=0$ 的退化情况，这将产生一个确定性的 $E=\\mu_E$。\n- 使用上述公式计算 $u_{\\text{mid}}$ 的解析均值 $m$ 和方差 $v$。\n- 使用对数正态参数化和固定的种子以保证可复现性，生成 $N_s$ 个独立的 $E$ 样本。通过 $u_{\\text{mid}}^{(i)} = u_{\\text{mid}}^{(1)}/E^{(i)}$ 将这些样本映射到位移样本，而无需重新求解线性系统，这是有效的，因为存在线性缩放关系 $K(E)=E K(1)$。\n- 使用总体公式（即，除数为 $N_s$ 的 $\\operatorname{Var}$）估计蒙特卡洛均值 $\\widehat{m}$ 和方差 $\\widehat{v}$。使用每个测试用例的容差与解析值进行比较。当且仅当均值和方差的比较都满足 $\\lvert \\widehat{m} - m \\rvert \\le \\max(r_{\\text{tol},m}\\lvert m \\rvert, a_{\\text{tol},m})$ 和 $\\lvert \\widehat{v} - v \\rvert \\le \\max(r_{\\text{tol},v}\\lvert v \\rvert, a_{\\text{tol},v})$ 时，布尔结果为真。\n\n关于数值真实性的说明：\n- 对于此具有二次精确解的一维问题，当使用均匀网格和协调荷载时， $E=1$ 的确定性跨中位移等于连续问题的精确跨中值；因此，对于此一维荷载，节点处的有限元解是精确的。这确保了随机验证中唯一的差异来源是蒙特卡洛抽样误差，而不是空间离散化误差。\n- 单位在整个过程中始终为 SI 单位；最终的布尔输出在构造上是无量纲的。\n\n程序输出单行，其中包含三个布尔值的列表，每个测试用例一个，顺序与问题陈述中列出的顺序相同。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_and_solve_unit_mid_displacement(L, A, b, Ne):\n    \"\"\"\n    Assemble 1D bar FEM with linear elements, uniform mesh, consistent body force,\n    Dirichlet BC u(0)=u(L)=0, and E=1. Return the mid-span nodal displacement.\n    \"\"\"\n    assert Ne % 2 == 0, \"Number of elements must be even to have a mid-span node.\"\n    nn = Ne + 1\n    h = L / Ne\n\n    # Global stiffness and load (use E=1 here)\n    K = np.zeros((nn, nn), dtype=float)\n    f = np.zeros(nn, dtype=float)\n\n    # Element matrices for E=1\n    ke = (A / h) * np.array([[1.0, -1.0],\n                              [-1.0, 1.0]], dtype=float)\n    fe = (b * h / 2.0) * np.array([1.0, 1.0], dtype=float)\n\n    # Assembly\n    for e in range(Ne):\n        n1 = e\n        n2 = e + 1\n        K[n1, n1] += ke[0, 0]\n        K[n1, n2] += ke[0, 1]\n        K[n2, n1] += ke[1, 0]\n        K[n2, n2] += ke[1, 1]\n        f[n1] += fe[0]\n        f[n2] += fe[1]\n\n    # Apply Dirichlet BCs: u(0)=0, u(L)=0 - remove first and last DOFs\n    interior = np.arange(1, nn - 1)\n    K_ff = K[np.ix_(interior, interior)]\n    f_f = f[interior]\n\n    # Solve for interior DOFs\n    u_f = np.linalg.solve(K_ff, f_f)\n\n    # Reconstruct full displacement vector\n    u = np.zeros(nn, dtype=float)\n    u[interior] = u_f\n\n    # Mid-span node index\n    mid_node = Ne // 2\n    return u[mid_node]\n\ndef lognormal_params_from_mean_cov(mean, cov):\n    \"\"\"\n    Given mean and coefficient of variation of a lognormal variable,\n    return (mu, sigma) of the underlying normal distribution.\n    Handle cov=0 as the degenerate deterministic case with sigma=0.\n    \"\"\"\n    if cov == 0.0:\n        sigma2 = 0.0\n        sigma = 0.0\n        mu = np.log(mean) if mean > 0 else -np.inf  # mean should be > 0 for E\n        return mu, sigma\n    sigma2 = np.log(1.0 + cov * cov)\n    sigma = np.sqrt(sigma2)\n    mu = np.log(mean) - 0.5 * sigma2\n    return mu, sigma\n\ndef analytic_mean_var_u_mid(u_mid_unit, mean_E, cov_E):\n    \"\"\"\n    Using properties of the lognormal distribution, compute analytic mean and variance\n    of u_mid = u_mid_unit / E, given mean and cov of E.\n    \"\"\"\n    # Handle both general and degenerate case\n    mu, sigma = lognormal_params_from_mean_cov(mean_E, cov_E)\n    # E[1/E] and Var[1/E]\n    # For degenerate cov=0, sigma=0 => returns exact reciprocal\n    E_inv_mean = np.exp(-mu + 0.5 * sigma * sigma)\n    E_inv_var = (np.exp(sigma * sigma) - 1.0) * np.exp(-2.0 * mu + sigma * sigma)\n    m = u_mid_unit * E_inv_mean\n    v = (u_mid_unit ** 2) * E_inv_var\n    return m, v\n\ndef within_tolerance(estimate, truth, rtol, atol):\n    return abs(estimate - truth) = max(rtol * abs(truth), atol)\n\ndef run_case(case, rng):\n    \"\"\"\n    Execute one test case:\n    case = (L, A, b, mean_E, cov_E, Ne, Ns, rtol_m, rtol_v, atol_m, atol_v)\n    Returns True if both mean and variance checks pass, else False.\n    \"\"\"\n    (L, A, b, mean_E, cov_E, Ne, Ns, rtol_m, rtol_v, atol_m, atol_v) = case\n\n    # Deterministic mid-span displacement for E=1 via FEM\n    u_mid_unit = assemble_and_solve_unit_mid_displacement(L, A, b, Ne)\n\n    # Analytic mean and variance\n    m_true, v_true = analytic_mean_var_u_mid(u_mid_unit, mean_E, cov_E)\n\n    # Sample E and compute u_mid samples via scaling\n    mu, sigma = lognormal_params_from_mean_cov(mean_E, cov_E)\n    if sigma == 0.0:\n        E_samples = np.full(Ns, mean_E, dtype=float)\n    else:\n        E_samples = rng.lognormal(mean=mu, sigma=sigma, size=Ns)\n\n    u_samples = u_mid_unit / E_samples\n\n    # Monte Carlo estimates (population statistics)\n    m_hat = float(np.mean(u_samples))\n    v_hat = float(np.var(u_samples))  # population variance\n\n    # Tolerance checks\n    mean_ok = within_tolerance(m_hat, m_true, rtol_m, atol_m)\n    var_ok = within_tolerance(v_hat, v_true, rtol_v, atol_v)\n\n    return bool(mean_ok and var_ok)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # (L, A, b, mean_E, cov_E, Ne, Ns, rtol_m, rtol_v, atol_m, atol_v)\n    test_cases = [\n        (2.0, 0.01, 1.0e5, 2.0e11, 0.1, 10, 100000, 0.01, 0.03, 0.0, 0.0),\n        (1.0, 0.005, 5.0e4, 1.5e11, 0.0, 8, 5000, 1.0e-12, 0.0, 0.0, 1.0e-24),\n        (3.0, 0.02, 2.0e5, 7.0e10, 0.5, 20, 200000, 0.015, 0.03, 0.0, 0.0),\n    ]\n\n    # Fixed seed for reproducibility\n    rng = np.random.default_rng(seed=123456)\n\n    results = []\n    for case in test_cases:\n        res = run_case(case, rng)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2686978"}]}