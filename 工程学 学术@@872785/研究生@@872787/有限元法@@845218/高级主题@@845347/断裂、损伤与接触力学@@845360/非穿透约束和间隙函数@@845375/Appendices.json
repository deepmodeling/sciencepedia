{"hands_on_practices": [{"introduction": "在开发或使用任何有限元公式时，一个基本的要求是它能够精确地再现简单的、常数解的状态。这个概念通过所谓的“补丁测试”（Patch Test）来形式化，它是验证离散化方法一致性的关键基准。本练习 [@problem_id:2584061] 邀请您推导并比较三种常见的接触界面离散化方法——节点-分段法、分段-分段法和砂浆法——在均匀压力下的表现，以评估它们的基本准确性。", "problem": "一个直的平面接触界面被建模为沿 $x$ 轴的一维线段 $\\Gamma = [0,1]$，其单位外法线 $\\boldsymbol{n}$ 固定且为常数。两个线性弹性体沿 $\\Gamma$ 压合在一起，使得精确的法向接触牵引力（接触压力）是均匀的：$p(x) \\equiv p_{0}$，其中 $p_{0}  0$。在 $\\Gamma$ 上各处，法向的精确运动学间隙函数为 $g(x) \\equiv 0$，无穿透互补性简化为一致状态 $g(x)=0$, $p(x)=p_{0}$。\n\n考虑牵引力斑块检验：在 $\\Gamma$ 上的弱接触平衡方程为，对于所有容许的法向虚间隙 $w(x)$，\n$$\n\\int_{\\Gamma} p(x)\\,w(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} p_{0}\\,w(x)\\,\\mathrm{d}x.\n$$\n设主面由单个线性有限元离散化，其在 $[0,1]$ 上的节点形函数为 $N_{1}(x)=1-x$ 和 $N_{2}(x)=x$。设从面由两个线性元离散化，从节点位于 $x^{s}=\\{0,\\,0.3,\\,1\\}$，形成单元子区间 $[0,0.3]$ 和 $[0.3,1]$。\n\n使用三种不同的界面离散化方法来近似接触牵引力，每种方法都通过上述基本弱形式在 $\\Gamma$ 上定义一个离散牵引力场 $p_{h}(x)$：\n\n1) 点对段（Node-to-segment）方法：取从面节点形函数 $\\{\\psi_{i}\\}_{i=1}^{3}$ 作为接触相互作用的检验函数，并在从网格上采用节点质量集中求积，使得 $\\int_{0}^{1} q(x)\\,\\psi_{i}(x)\\,\\mathrm{d}x \\approx w_{i}\\,q(x_{i}^{s})$，其中节点权重为标准斑块长度 $w_{1}=\\tfrac{1}{2}(0.3-0)$、$w_{2}=\\tfrac{1}{2}[(0.3-0)+(1-0.3)]$ 和 $w_{3}=\\tfrac{1}{2}(1-0.3)$。推导此离散化所隐含的离散牵引力场 $p_{h}^{\\mathrm{N2S}}(x)$，并计算其相对于 $p_{0}$ 的归一化 $L^{2}$ 误差。\n\n2) 段对段（Segment-to-segment）方法：将牵引力近似为每个从段上的分段常数，$p_{h}^{\\mathrm{S2S}}(x)=t_{1}$（对于 $x\\in[0,0.3]$）和 $p_{h}^{\\mathrm{S2S}}(x)=t_{2}$（对于 $x\\in[0.3,1]$）。使用主检验函数 $N_{1}(x)$ 和 $N_{2}(x)$，并通过在每个子区间上进行精确积分来强制弱平衡，以确定 $t_{1}$ 和 $t_{2}$。计算 $p_{h}^{\\mathrm{S2S}}(x)$ 相对于 $p_{0}$ 的归一化 $L^{2}$ 误差。\n\n3) 砂浆（Mortar）法：假设一个保持常数的对偶（双正交）砂浆离散化，即离散界面双线性形式能精确地再现常数牵引力与由 $\\{N_{1},N_{2}\\}$ 张成的主检验空间所作的积分。推导离散牵引力场 $p_{h}^{\\mathrm{M}}(x)$ 并计算其相对于 $p_{0}$ 的归一化 $L^{2}$ 误差。\n\n使用在 $\\Gamma$ 上的归一化 $L^{2}$ 误差，\n$$\nE\\big(p_{h}\\big) \\;=\\; \\frac{\\big\\|p_{h}-p_{0}\\big\\|_{L^{2}(0,1)}}{\\big\\|p_{0}\\big\\|_{L^{2}(0,1)}}\n\\;=\\; \\frac{\\left(\\int_{0}^{1}\\big(p_{h}(x)-p_{0}\\big)^{2}\\,\\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{1}p_{0}^{2}\\,\\mathrm{d}x\\right)^{1/2}}.\n$$\n最后，计算单个标量\n$$\nE_{\\max} \\;=\\; \\max\\!\\big\\{\\,E\\!\\big(p_{h}^{\\mathrm{N2S}}\\big),\\;E\\!\\big(p_{h}^{\\mathrm{S2S}}\\big),\\;E\\!\\big(p_{h}^{\\mathrm{M}}\\big)\\big\\}.\n$$\n将你的最终答案表示为一个纯数（无单位）。无需四舍五入。", "solution": "问题陈述为三种不同的一维接触界面离散化构成了一个适定的牵引力斑块检验。任务是确定每种方法的离散牵引力场 $p_h(x)$，并计算其相对于精确均匀牵引力 $p(x) = p_0$ 的归一化 $L^2$ 误差。该问题具有科学依据，并提供了所有必要的数据和定义。我将开始解题。\n\n为简单起见且不失一般性，我们可以设定常数牵引力 $p_0=1$。最终误差是一个归一化量，与 $p_0$ 的值无关。对于离散牵引力场 $p_h(x)$ 和检验函数 $w(x)$，弱接触平衡方程为\n$$\n\\int_{0}^{1} p_h(x)\\,w(x)\\,\\mathrm{d}x = \\int_{0}^{1} 1 \\cdot w(x)\\,\\mathrm{d}x\n$$\n归一化 $L^2$ 误差由下式给出\n$$\nE(p_h) = \\frac{\\left(\\int_{0}^{1}(p_h(x)-1)^{2}\\,\\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{1}1^{2}\\,\\mathrm{d}x\\right)^{1/2}} = \\left(\\int_{0}^{1}(p_h(x)-1)^{2}\\,\\mathrm{d}x\\right)^{1/2}\n$$\n\n**1) 点对段（N2S）方法**\n\n对于点对段方法，检验函数是从面节点形函数，$w(x) = \\psi_i(x)$，其中 $i=1,2,3$。每个检验函数的离散弱形式为\n$$\n\\int_{0}^{1} p_h^{\\mathrm{N2S}}(x)\\,\\psi_{i}(x)\\,\\mathrm{d}x = \\int_{0}^{1} 1 \\cdot \\psi_i(x)\\,\\mathrm{d}x\n$$\n问题指定对左侧积分使用节点质量集中求积，其定义为 $\\int_{0}^{1} q(x)\\,\\psi_{i}(x)\\,\\mathrm{d}x \\approx w_{i}\\,q(x_{i}^{s})$。从节点位于 $x^s_1=0$、$x^s_2=0.3$ 和 $x^s_3=1$。应用此规则，弱形式变为：\n$$\nw_i\\,p_h^{\\mathrm{N2S}}(x_i^s) = \\int_{0}^{1} \\psi_i(x)\\,\\mathrm{d}x\n$$\n线性有限元形函数在域上的积分是“帽子”下的面积，这恰好是节点集中权重 $w_i$ 的标准定义。问题提供了这些权重：$w_1 = 0.15$，$w_2 = 0.5$，$w_3 = 0.35$。我们来验证一下：\n$$\n\\int_0^1 \\psi_1(x)dx = \\int_0^{0.3} \\frac{0.3-x}{0.3} dx = \\frac{1}{2} \\times 0.3 \\times 1 = 0.15 = w_1\n$$\n$$\n\\int_0^1 \\psi_2(x)dx = \\int_0^{0.3} \\frac{x}{0.3} dx + \\int_{0.3}^1 \\frac{1-x}{0.7} dx = \\frac{1}{2}(0.3) + \\frac{1}{2}(0.7) = 0.5 = w_2\n$$\n$$\n\\int_0^1 \\psi_3(x)dx = \\int_{0.3}^1 \\frac{x-0.3}{0.7} dx = \\frac{1}{2}(0.7) = 0.35 = w_3\n$$\n因此，牵引力节点值的方程简化为：\n$$\nw_i\\,p_h^{\\mathrm{N2S}}(x_i^s) = w_i \\implies p_h^{\\mathrm{N2S}}(x_i^s) = 1 \\quad \\text{for } i=1,2,3.\n$$\n所以，我们得到牵引力值为 $p_h^{\\mathrm{N2S}}(0)=1$、$p_h^{\\mathrm{N2S}}(0.3)=1$ 和 $p_h^{\\mathrm{N2S}}(1)=1$。\n离散牵引力场 $p_h(x)$ 是主面上的一个场，主面由单个线性元离散化。因此，很自然地使用主面形函数 $N_1(x)=1-x$ 和 $N_2(x)=x$ 来表示 $p_h(x)$：\n$$\np_h^{\\mathrm{N2S}}(x) = c_1 N_1(x) + c_2 N_2(x)\n$$\n其中 $c_1$ 和 $c_2$ 是主节点（$x=0$ 和 $x=1$）处的节点牵引力值。\n使用从节点评估的结果：\n在 $x=0$ 处：$p_h^{\\mathrm{N2S}}(0) = c_1 N_1(0) + c_2 N_2(0) = c_1$。由于 $p_h^{\\mathrm{N2S}}(0)=1$，我们有 $c_1=1$。\n在 $x=1$ 处：$p_h^{\\mathrm{N2S}}(1) = c_1 N_1(1) + c_2 N_2(1) = c_2$。由于 $p_h^{\\mathrm{N2S}}(1)=1$，我们有 $c_2=1$。\n因此，牵引力场为：\n$$\np_h^{\\mathrm{N2S}}(x) = 1 \\cdot (1-x) + 1 \\cdot x = 1\n$$\n这也满足了中间从节点 $x=0.3$ 处的条件：$p_h^{\\mathrm{N2S}}(0.3) = 1 \\cdot (1-0.3) + 1 \\cdot 0.3 = 0.7 + 0.3 = 1$。\n离散牵引力场与精确场相同，$p_h^{\\mathrm{N2S}}(x)=1$。误差为：\n$$\nE(p_h^{\\mathrm{N2S}}) = \\left(\\int_{0}^{1}(1-1)^{2}\\,\\mathrm{d}x\\right)^{1/2} = 0\n$$\n\n**2) 段对段（S2S）方法**\n\n牵引力场被近似为分段常数：$p_h^{\\mathrm{S2S}}(x) = t_1$（对于 $x \\in [0,0.3]$）和 $p_h^{\\mathrm{S2S}}(x) = t_2$（对于 $x \\in [0.3,1]$）。检验函数是主形函数 $N_1(x)=1-x$ 和 $N_2(x)=x$。我们为 $t_1$ 和 $t_2$ 建立一个 $2 \\times 2$ 的方程组。\n\n对于检验函数 $w(x)=N_1(x)$：\n$$\n\\int_0^{0.3} t_1(1-x)dx + \\int_{0.3}^1 t_2(1-x)dx = \\int_0^1 (1-x)dx\n$$\n$$\nt_1 \\left[x-\\frac{x^2}{2}\\right]_0^{0.3} + t_2 \\left[x-\\frac{x^2}{2}\\right]_{0.3}^1 = \\left[x-\\frac{x^2}{2}\\right]_0^1\n$$\n$$\nt_1 (0.3 - \\frac{0.09}{2}) + t_2 \\left((1-\\frac{1}{2}) - (0.3 - \\frac{0.09}{2})\\right) = \\frac{1}{2}\n$$\n$$\n0.255\\,t_1 + 0.245\\,t_2 = 0.5\n$$\n对于检验函数 $w(x)=N_2(x)$：\n$$\n\\int_0^{0.3} t_1 x dx + \\int_{0.3}^1 t_2 x dx = \\int_0^1 x dx\n$$\n$$\nt_1 \\left[\\frac{x^2}{2}\\right]_0^{0.3} + t_2 \\left[\\frac{x^2}{2}\\right]_{0.3}^1 = \\left[\\frac{x^2}{2}\\right]_0^1\n$$\n$$\nt_1 (\\frac{0.09}{2}) + t_2 (\\frac{1}{2} - \\frac{0.09}{2}) = \\frac{1}{2}\n$$\n$$\n0.045\\,t_1 + 0.455\\,t_2 = 0.5\n$$\n我们得到一个由两个线性方程组成的方程组：\n1) $0.255\\,t_1 + 0.245\\,t_2 = 0.5$\n2) $0.045\\,t_1 + 0.455\\,t_2 = 0.5$\n从第一个方程减去第二个方程得到：\n$$\n(0.255 - 0.045)t_1 + (0.245 - 0.455)t_2 = 0 \\implies 0.21 t_1 - 0.21 t_2 = 0 \\implies t_1 = t_2\n$$\n将 $t_1=t_2$ 代入第一个方程：\n$$\n0.255\\,t_1 + 0.245\\,t_1 = 0.5 \\implies 0.5\\,t_1 = 0.5 \\implies t_1 = 1\n$$\n因此，$t_1 = t_2 = 1$。对于所有 $x \\in [0,1]$，离散牵引力场为 $p_h^{\\mathrm{S2S}}(x)=1$。这是因为试探函数空间（分段常数）包含了精确解（一个常数）。精确解在该空间上的投影就是解本身。误差为：\n$$\nE(p_h^{\\mathrm{S2S}}) = \\left(\\int_{0}^{1}(1-1)^{2}\\,\\mathrm{d}x\\right)^{1/2} = 0\n$$\n\n**3) 砂浆（Mortar）法**\n\n问题陈述砂浆离散化“保持常数”。这是构造良好的砂浆法的一个基本性质，确保它们能通过常数场的斑块检验。形式上，这意味着对于一个常数牵引力场 $p(x) = p_0$，相应的离散牵引力场 $p_h^{\\mathrm{M}}(x)$ 精确地等于 $p_0$。\n让我们确认为何必须如此。该方法在乘子函数空间 $M_h$ 中寻找 $p_h^{\\mathrm{M}}$，使得对于主空间 $W_h = \\text{span}\\{N_1, N_2\\}$ 中的所有检验函数 $w_h$，下式成立：\n$$\n\\int_0^1 p_h^{\\mathrm{M}}(x) w_h(x) dx = \\int_0^1 p_0 w_h(x) dx\n$$\n一个保持常数的方法要求常数函数本身是乘子空间 $M_h$ 的一个元素。如果 $p_0 \\in M_h$，那么设定 $p_h^{\\mathrm{M}}(x) = p_0$ 会自然地满足弱形式：\n$$\n\\int_0^1 p_0 w_h(x) dx = \\int_0^1 p_0 w_h(x) dx\n$$\n假设该方法是适定的（即解是唯一的），那么这必须是解。因此，$p_h^{\\mathrm{M}}(x) = p_0$（在我们的例子中是1）。\n因此，离散牵引力场为 $p_h^{\\mathrm{M}}(x) = 1$。误差为：\n$$\nE(p_h^{\\mathrm{M}}) = \\left(\\int_{0}^{1}(1-1)^{2}\\,\\mathrm{d}x\\right)^{1/2} = 0\n$$\n\n**结论**\n\n所有三种指定的接触离散化方法都通过了常数压力场的牵引力斑块检验，这意味着它们完美地再现了精确的常数解。每种方法的归一化 $L^2$ 误差均为零。\n$$\nE(p_{h}^{\\mathrm{N2S}}) = 0\n$$\n$$\nE(p_{h}^{\\mathrm{S2S}}) = 0\n$$\n$$\nE(p_{h}^{\\mathrm{M}}) = 0\n$$\n因此，这些误差的最大值也为零。\n$$\nE_{\\max} = \\max\\{0, 0, 0\\} = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "2584061"}, {"introduction": "从理想化的平面界面转向更实际的多面体（非光滑）物体时，会带来重大的算法挑战。在多面体的边和角点处，接触法向不再是唯一的，这使得基于光滑曲面假设的简单算法失效。本练习 [@problem_id:2572507] 旨在让您深入分析这些失效模式，并从基本原理出发，构建一个稳健的接触算法，该算法涵盖了从几何搜索到变分一致性约束定义的关键组成部分。", "problem": "考虑三维 ($3$D) 环境中，一个弹性体与一个刚性多面体障碍物之间的无摩擦单边接触。设位于位置 $\\mathbf{x}_s \\in \\mathbb{R}^3$ 的单个从节点可能接触到一个刚性多面体主曲面 $\\Gamma_M$。该主曲面由一个无缝三角化网格表示，其小平面是完全平面的。接触通过法向上的拉格朗日乘子 $\\lambda \\in \\mathbb{R}$ 来施加。不可穿透约束通过 Karush–Kuhn–Tucker (KKT) 条件进行变分表示：\n$$\ng(\\mathbf{x}_s) \\ge 0,\\quad \\lambda \\ge 0,\\quad \\lambda\\, g(\\mathbf{x}_s) = 0,\n$$\n其中 $g(\\mathbf{x}_s)$ 是一个法向间隙函数，通过将 $\\mathbf{x}_s$ 映射到 $\\Gamma_M$ 上的最近点来定义。假设从边发生小变形，且主面是理想刚性的，因此在求解过程中只有 $\\mathbf{x}_s$ 发生变化。\n\n一种常见的实现方式是通过将 $\\mathbf{x}_s$ 投影到主面的单个光滑参数片上来计算最近点映射，并使用最近点 $\\mathbf{y} \\in \\Gamma_M$ 处的唯一单位法向量 $\\mathbf{n}(\\mathbf{y})$ 来定义 $g(\\mathbf{x}_s) = \\mathbf{n}(\\mathbf{y}) \\cdot (\\mathbf{x}_s - \\mathbf{y})$。然而，在 $\\Gamma_M$ 的边和角点附近，光滑片假设会失效：投影点可能位于多个小平面共享的一条边上，或是一个顶点上，此时法向变得非唯一。这在使用 Newton 型方法求解 KKT 系统时，可能导致非物理跳跃、丧失收敛性或不正确的激活集决策。\n\n从第一性原理出发，使用最近点作为欧几里得距离最小化子的定义，\n$$\n\\mathbf{y}^\\star(\\mathbf{x}_s) \\in \\arg\\min_{\\mathbf{y} \\in \\Gamma_M} \\|\\mathbf{x}_s - \\mathbf{y}\\|,\n$$\n以及对于多面体 $\\Gamma_M$，法向量在其小平面的相对内部是唯一定义的，但在边和顶点上是集值的（法锥）这一事实，来分析最近点映射在边/角点附近的失效情况，并提出一种基于带回退投影的逐小平面搜索的鲁棒、变分一致且对 Newton 方法友好的程序。\n\n下列哪个陈述正确地指出了失效机制，并指定了一个鲁棒的程序，该程序在变分不等式的意义上保持了不等式约束，并允许对 Newton 方法或半光滑 Newton 方法进行一致的线性化？\n\nA. 执行逐小平面的正交投影：对每个候选三角小平面，计算 $\\mathbf{x}_s$ 在该小平面平面上的正交投影及其重心坐标；如果所有重心坐标均为非负（即投影点在内部），则接受该投影点。否则，正交投影到该小平面的每条边上；如果边上的投影点位于线段之外，则取最近的端点（顶点）。通过粗略阶段搜索发现的所有相邻小平面、边和顶点，构建一个候选点集，并选择与 $\\mathbf{x}_s$ 欧几里得距离最小的候选点作为 $\\mathbf{y}^\\star$。这消除了对单一光滑参数化的依赖，并无歧义地解决了 $\\mathbf{y}^\\star$ 位置的边/角点投影问题。\n\nB. 为避免边上的法向非唯一性，将法向冻结为先前激活的小平面的法向，并禁止小平面切换；即，即使最近点迁移到相邻小平面，也始终投影到最后接触的小平面上。这确保了法向的连续性，并保证了不可穿透约束的变分一致性。\n\nC. 当 $\\mathbf{y}^\\star$ 位于边或顶点上时，通过法锥 $N_{\\Gamma_M}(\\mathbf{y}^\\star)$ 来定义容许接触法向集，这等价于由相邻小平面法向 $\\{\\mathbf{n}_i\\}$ 张成的凸锥。将单边接触约束施加为关于未知法向 $\\mathbf{n} \\in N_{\\Gamma_M}(\\mathbf{y}^\\star)$ 的单个不等式，或者等价地，施加为多个逐小平面的不等式 $g_i(\\mathbf{x}_s)=\\mathbf{n}_i \\cdot (\\mathbf{x}_s-\\mathbf{y}^\\star) \\ge 0$，每个相邻小平面对应一个拉格朗日乘子 $\\lambda_i \\ge 0$ 和互补条件 $\\lambda_i g_i(\\mathbf{x}_s)=0$，并结合使用 Clarke 广义导数进行一致的半光滑 Newton 线性化。这在边/角点处产生了一个与变分不等式一致的良态约束方向。\n\nD. 将多面体曲面替换为一个通过网格拟合 $C^2$ 样条获得的全局光滑带符号距离场，并始终使用该场的梯度作为接触法向。这保证了在边/角点处的法向唯一性，并保持了原始多面体几何的精确不可穿透约束。\n\nE. 为提高 Newton 迭代的鲁棒性，在内部 Newton 线性化过程中保持接触分类（小平面内部、边上、顶点上）及相关的激活集固定不变，仅在外部迭代之间更新它们，并且仅当一个试探步超出小的信赖域阈值并违反当前分类时才切换分类。这在迭代过程中产生了一致的切线算子，并防止了在边/角点附近因瞬时切换而引起的振荡。\n\n选择所有适用的选项。", "solution": "用户要求在有限元法的背景下，分析处理与刚性多面体之间无摩擦单边接触的程序。问题的核心在于主曲面 $\\Gamma_M$ 的非光滑性质，这导致在边和顶点处的接触法向不唯一。这种情况使假定曲面光滑的简单接触公式失效，并给 Newton 型求解器带来数值困难。一个鲁棒的程序必须能正确识别最近接触点，以变分一致的方式建立不可穿透约束，并适用于鲁棒的数值求解器。\n\n问题陈述已经过验证，被认为是科学上合理、良态的，并且没有任何使其无效的缺陷。它提出了计算接触力学中一个标准但高级的课题。我们将基于第一性原理进行求解。\n\n系统的状态由最小势能原理决定，并受到不可穿透约束 $g(\\mathbf{x}_s) \\ge 0$ 的限制。该约束通过拉格朗日乘子 $\\lambda$ 来施加，$\\lambda$ 代表接触法向力的大小。Karush-Kuhn-Tucker (KKT) 条件提供了完整的公式：\n$$ g(\\mathbf{x}_s) \\ge 0, \\quad \\lambda \\ge 0, \\quad \\lambda\\, g(\\mathbf{x}_s) = 0 $$\n此处，$g(\\mathbf{x}_s)$ 是间隙函数。对于一个通用点 $\\mathbf{x}_s$，主曲面 $\\Gamma_M$ 上的最近点 $\\mathbf{y}^\\star$ 是一个最小化问题的解：\n$$ \\mathbf{y}^\\star(\\mathbf{x}_s) \\in \\arg\\min_{\\mathbf{y} \\in \\Gamma_M} \\|\\mathbf{x}_s - \\mathbf{y}\\| $$\n间隙向量则为 $\\mathbf{g} = \\mathbf{x}_s - \\mathbf{y}^\\star$。根据到凸集（或在本例中，到凸集边界）投影的理论，间隙向量必须位于 $\\Gamma_M$ 在 $\\mathbf{y}^\\star$ 处的法锥内，即 $\\mathbf{x}_s - \\mathbf{y}^\\star \\in N_{\\Gamma_M}(\\mathbf{y}^\\star)$。因此，作用方向相反的接触力向量必须在法锥的负方向，这是排斥接触力的标准方向。间隙函数 $g(\\mathbf{x}_s)$ 是带符号距离，通常定义为 $g(\\mathbf{x}_s) = \\mathbf{n} \\cdot (\\mathbf{x}_s - \\mathbf{y}^\\star)$，其中 $\\mathbf{n}$ 是接触法向。核心困难在于，法锥以及因此产生的方向 $\\mathbf{n}$ 在边和顶点处不是单个向量。\n\n因此，一个鲁棒的方法必须包含三个主要部分：\n$1$. 一个鲁棒的几何算法，用于找到唯一的最近点 $\\mathbf{y}^\\star$。\n$2$. 一个在 $\\mathbf{y}^\\star$ 处（特别是当它位于非光滑特征上时）的接触约束和力的变分一致的公式。\n$3$. 一个稳定的数值方案（例如，修正的 Newton 方法），用于求解由此产生的非光滑、非线性方程组。\n\n现在我们根据这些原则来评估每个选项。\n\n**选项 A 分析**\n这个选项描述了一个用于在三角化曲面上寻找最近点 $\\mathbf{y}^\\star$ 的详细几何算法。该过程包括：\n$1$. 将 $\\mathbf{x}_s$ 正交投影到三角形所在平面。\n$2$. 使用重心坐标检查投影点是否在三角形内部。\n$3$. 如果不在，则投影到三角形的边（线段）上。\n$4$. 如果投影点在边线段之外，则选择最近的顶点。\n$5$. 对所有候选小平面重复此过程，并选择给出绝对最小距离的点。\n\n这种分层投影方法（平面 $\\to$ 边 $\\to$ 顶点）是为多面体网格实现 $\\arg\\min$ 算子的一种标准且数学上合理的方式。它正确地找到了 $\\mathbf{y}^\\star$ 的唯一位置，没有歧义，从而解决了源于幼稚的光滑片假设的问题的几何部分。这是任何用于多面体物体的鲁棒接触算法中必不可少的第一步。\n结论：**正确**。\n\n**选项 B 分析**\n该选项建议“冻结”接触法向，即当最近点移动到边或新小平面时，使用先前激活的小平面的法向。其声称的目标是确保法向量的连续性。虽然这确实使法向量在时间上或迭代中连续，但它在根本上与接触的物理和变分原理不一致。接触力必须垂直于*当前*接触点的约束曲面。通过使用一个“旧”法向，得到的接触力向量 $\\mathbf{F}_c = -\\lambda \\mathbf{n}_{\\text{old}}$ 可能不在当前接触点 $\\mathbf{y}^\\star$ 的容许方向集（法锥）中。这可能导致力向量有一个分量将节点沿相邻小平面*拉入*刚体内部，违反了它本应施加的不可穿透约束。这是一种非物理的、临时的修复方法，为了数值上的便利而牺牲了准确性和变分一致性。\n结论：**不正确**。\n\n**选项 C 分析**\n这个选项解决了边和顶点处法向不唯一的核心问题。它正确地将法锥 $N_{\\Gamma_M}(\\mathbf{y}^\\star)$ 识别为向量 $(\\mathbf{x}_s - \\mathbf{y}^\\star)$ 的所有可能方向的集合。在一条边上，这个锥由两个相邻小平面的法向 $\\{\\mathbf{n}_1, \\mathbf{n}_2\\}$ 张成。在一个顶点上，它由所有在此交汇的小平面的法向 $\\{\\mathbf{n}_i\\}$ 张成。该选项建议将接触约束施加为一组多个不等式，每个定义该特征的小平面 $i$ 对应一个：\n$$ g_i(\\mathbf{x}_s) = \\mathbf{n}_i \\cdot (\\mathbf{x}_s - \\mathbf{y}^\\star) \\ge 0 $$\n每个不等式都与自己的非负拉格朗日乘子 $\\lambda_i \\ge 0$ 和一个互补条件 $\\lambda_i g_i = 0$ 配对。总接触力因此有效地成为小平面法向的正线性组合，这正是一个在法锥中的向量。这是表述该问题的正确且变分一致的方式。此外，它正确地指出了使用带有 Clarke 广义导数的半光滑 Newton 方法来求解由此产生的非光滑 KKT 系统。这种方法将不可微问题转化为一个可以用鲁棒、快速收敛的数值方法解决的问题。\n结论：**正确**。\n\n**选项 D 分析**\n该选项建议用一个全局光滑的 $C^2$ 近似（例如基于样条的带符号距离场）来替换精确的多面体几何。其好处是该场的梯度在任何地方都提供了一个唯一的、连续变化的法向。然而，这个选项的关键缺陷在于其声称“保持了原始多面体几何的精确不可穿透约束”。这是一个矛盾。光滑曲面不可能与包含尖锐边和角点的多面体曲面相同。平滑一条边要么会“将其圆化”，这会允许穿透原始的尖锐角点；要么会“将其填充”，这会产生一个人为的间隙，并阻止在原始曲面上本应发生的接触。因此，该方法并未解决所述问题，而是用一个不同的、近似的问题取而代之。\n结论：**不正确**。\n\n**选项 E 分析**\n这个选项讨论了 KKT 系统的数值解法，这是“对 Newton 方法友好”的程序的关键部分。当一个从节点的位置靠近一条边或一个顶点时，其位置在 Newton 迭代中的微小变化可能导致最近点分类在相邻小平面之间或在小平面与边之间“闪烁”。这会导致系统切线刚度矩阵的剧烈变化，从而可能引起振荡（“Z”字形行为）并导致 Newton-Raphson 方法无法收敛。所提出的策略是“在内部 Newton 线性化过程中保持接触分类……固定不变，并仅在外部迭代之间更新它们”。这是对一种鲁棒的激活集策略的描述。通过在一系列“内部”Newton 迭代中冻结激活约束集，求解器处理的是一个局部光滑的问题，可以鲁棒地收敛。“外部”循环然后根据结果更新接触状态（激活集），然后开始新的内部循环。这可以防止求解器陷入振荡，是提高接触算法鲁棒性和收敛性的标准技术。\n结论：**正确**。\n\n总之，选项 A、C 和 E 描述了一个用于处理多面体接触的完整、鲁棒且现代的算法中正确且互补的组成部分。选项 A 涵盖了几何搜索，选项 C 涵盖了变分一致的公式，选项 E 涵盖了鲁棒的数值求解策略。", "answer": "$$\\boxed{ACE}$$", "id": "2572507"}, {"introduction": "即使正确地定义了接触约束，在求解非线性方程组时，数值不稳定性仍然可能出现。一个常见的难题是“振荡”（chatter），即在牛顿迭代过程中，节点的接触状态（激活或未激活）反复切换，导致求解过程无法收敛。本练习 [@problem_id:2584002] 提供了一个通过实现滞回激活/停用准则来解决此问题的动手实践机会，这是一种在数值求解器中稳定接触算法的强大技术。", "problem": "在有限元法 (FEM) 的背景下，考虑一个可变形体和一个刚性障碍物之间的无摩擦单边接触。接触法向的接触运动学由一个标量法向间隙函数 $g \\colon \\mathbb{R}^{n} \\to \\mathbb{R}$ 表示，其中 $g(\\boldsymbol{u}) \\ge 0$ 表示无穿透，$g(\\boldsymbol{u}) = 0$ 表示激活接触，$g(\\boldsymbol{u})  0$ 表示穿透。无摩擦单边接触的互补条件是著名的 Karush–Kuhn–Tucker (KKT) 条件：$g \\ge 0$，$\\lambda \\ge 0$ 和 $g\\,\\lambda = 0$，其中 $\\lambda$ 是非负接触压力拉格朗日乘子。牛顿法在每次迭代中通过求解线性化的平衡方程来获得一个试探位移增量 $\\Delta \\boldsymbol{u}^{\\text{trial}}$。下一个间隙的线性化预测使用 $g$ 沿接触法向的方向导数，即 $g_{\\text{pred}} = g_k + Dg(\\boldsymbol{u}_k) \\cdot \\Delta \\boldsymbol{u}^{\\text{trial}}$，其中 $g_k = g(\\boldsymbol{u}_k)$ 是当前间隙。\n\n设计、实现并测试一个鲁棒的牛顿迭代过程中接触状态的激活/失活准则，该准则：\n- 使用从线性化中获得的预测间隙值 $g_{\\text{pred}}$，\n- 与互补条件一致地强制非穿透，\n- 当预测间隙在零附近振荡时，防止接触状态的抖动（虚假的快速切换）。\n\n您必须从第一性原理推导该算法，并使用双阈值滞回以避免抖动。设 $\\alpha  0$ 和 $\\beta > 0$ 为固定阈值，且 $\\alpha  0  \\beta$。使用以下一维法向模型进行测试，以便法向间隙更新可直接由标量增量表示，即 $Dg(\\boldsymbol{u}_k) \\cdot \\Delta \\boldsymbol{u}^{\\text{trial}} = \\Delta g^{\\text{trial}}$，因此\n$$\ng_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}.\n$$\n在此设置中，接触状态变量 $s \\in \\{0,1\\}$ 表示未激活 ($s=0$) 或已激活 ($s=1$) 接触。您的算法必须在每个牛顿迭代 $k$ 中为每个候选接触点实现以下规则：\n- 预测间隙：$g_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}$。\n- 激活规则（滞回）：如果 $s_k = 0$ 且 $g_k \\le 0$ 或 $g_{\\text{pred}} \\le \\alpha$，则设置 $s_{k+1} = 1$；否则保持 $s_{k+1} = s_k$。\n- 失活规则（带单边释放的滞回）：如果 $s_k = 1$ 且 $g_{\\text{pred}} \\ge \\beta$ 且 $\\Delta g^{\\text{trial}} \\ge 0$ 且 $g_k \\ge 0$，则设置 $s_{k+1} = 0$；否则保持 $s_{k+1} = s_k$。\n- 状态更新：为此模型测试接受试探增量，并设置 $g_{k+1} = g_{\\text{pred}}$。\n\n这种双阈值滞回创建了一个死区 $(\\alpha, \\beta)$，在该区域内先前的接触状态得以保留，从而防止了在 $g_{\\text{pred}}$ 围绕零的小幅振荡下的抖动。\n\n程序要求：\n- 实现上述算法，并将其应用于下面提供的测试套件。\n- 对于每个测试用例，从给定的初始接触状态 $s_0$ 和初始间隙 $g_0$ 开始，然后处理给定的试探间隙增量序列 $\\{\\Delta g^{\\text{trial}}_k\\}$，在每一步更新状态和间隙。\n- 计算每个测试用例在整个序列中的状态切换总数（一次激活或失活计为一次切换）。\n- 生成一行输出，其中包含所有测试用例的结果，形式为方括号内以逗号分隔的列表。第 $i$ 个条目必须是第 $i$ 个测试用例的整数切换次数。\n\n所有距离单位为米 (m)。对所有测试用例使用固定阈值 $\\alpha = -1\\times 10^{-6}$ m 和 $\\beta = 3\\times 10^{-6}$ m。\n\n测试套件：\n- 测试用例 1（接近、激活，然后尽管有小分离仍保持激活）：$s_0 = 0$，$g_0 = 5\\times 10^{-4}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{-2\\times 10^{-4}, -2\\times 10^{-4}, -2\\times 10^{-4}, +5\\times 10^{-5}, -2\\times 10^{-5}\\}$ m。\n- 测试用例 2（在零附近振荡，通过滞回防止抖动）：$s_0 = 0$，$g_0 = 2\\times 10^{-6}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{-3\\times 10^{-6}, +3\\times 10^{-6}, -3\\times 10^{-6}, +3\\times 10^{-6}, -3\\times 10^{-6}\\}$ m。\n- 测试用例 3（分离时受控释放）：$s_0 = 1$，$g_0 = 0$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{+1\\times 10^{-6}, +1\\times 10^{-6}, +1\\times 10^{-6}, +1\\times 10^{-6}\\}$ m。\n- 测试用例 4（恰好在阈值相等时激活）：$s_0 = 0$，$g_0 = 1\\times 10^{-5}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{-1.1\\times 10^{-5}\\}$ m。\n- 测试用例 5（恰好在阈值相等时失活）：$s_0 = 1$，$g_0 = 2\\times 10^{-6}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{+1\\times 10^{-6}\\}$ m。\n- 测试用例 6（由于已存在穿透而立即激活）：$s_0 = 0$，$g_0 = -1\\times 10^{-5}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{0\\}$ m。\n- 测试用例 7（始终张开，无切换）：$s_0 = 0$，$g_0 = 1\\times 10^{-3}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{+1\\times 10^{-4}, +1\\times 10^{-4}\\}$ m。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含结果，形式为方括号内以逗号分隔的列表（例如 $[r_1,r_2,\\dots,r_7]$），其中 $r_i$ 是您的算法计算出的测试用例 $i$ 的整数状态切换次数。", "solution": "我们从无摩擦单边接触的基本互补条件开始：$g \\ge 0$，$\\lambda \\ge 0$ 和 $g\\,\\lambda = 0$。在有限元法 (FEM) 设置中，状态变量是位移向量 $\\boldsymbol{u}$，间隙函数 $g(\\boldsymbol{u})$ 描述法向分离。在牛顿迭代 $k$ 中，线性化的平衡系统产生一个试探增量 $\\Delta \\boldsymbol{u}^{\\text{trial}}$，间隙的一阶泰勒展开为\n$$\ng_{\\text{pred}} = g(\\boldsymbol{u}_k + \\Delta \\boldsymbol{u}^{\\text{trial}}) \\approx g_k + Dg(\\boldsymbol{u}_k)\\cdot \\Delta \\boldsymbol{u}^{\\text{trial}},\n$$\n其中 $g_k = g(\\boldsymbol{u}_k)$。$g_{\\text{pred}}$ 的符号表示下一个迭代的预测状态是趋向于分离 ($g_{\\text{pred}}  0$) 还是穿透 ($g_{\\text{pred}}  0$)。\n\n鲁棒切换的原理：众所周知，在每次迭代中直接根据 $g_{\\text{pred}}$ 的符号进行切换，会在 $g_{\\text{pred}}$ 因牛顿法过冲和线搜索调整而在零附近振荡时引起抖动。为防止抖动，我们引入一个由两个阈值 $\\alpha  0$ 和 $\\beta > 0$ 界定的滞回带，使得当 $g_{\\text{pred}} \\in (\\alpha,\\beta)$ 时，先前的状态得以保留。这类似于引入一个稳定的死区：只有当 $g_{\\text{pred}}$ 足够小（超过 $\\alpha$）时，接触才会激活；只有当 $g_{\\text{pred}}$ 足够大（超过 $\\beta$）时，接触才会失活。要求 $\\Delta g^{\\text{trial}} \\ge 0$ 和 $g_k \\ge 0$ 作为失活条件是一个额外的单边一致性检查，可避免在模型指示正在发生穿透或闭合步时释放接触。\n\n对一维法向模型的特化：为了测试，我们考虑单个标量法向自由度，以便 $Dg(\\boldsymbol{u}_k) \\cdot \\Delta \\boldsymbol{u}^{\\text{trial}} = \\Delta g^{\\text{trial}}$，因此\n$$\ng_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}.\n$$\n接触状态变量 $s \\in \\{0,1\\}$ 表示未激活 ($s=0$) 或已激活 ($s=1$) 接触。\n\n算法推导：\n1. 预测下一个间隙：$g_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}$。\n2. 激活条件。如果存在穿透或预测到足够强的穿透，则必须发生激活。因此，如果 $s_k=0$ 且 $g_k \\le 0$（当前存在穿透）或 $g_{\\text{pred}} \\le \\alpha$（预测穿透超过负阈值），则设置 $s_{k+1}=1$。否则，保留 $s_{k+1}=s_k$。\n3. 失活条件。为了仅在明确分离且为分离步时释放接触，要求 $g_{\\text{pred}} \\ge \\beta$（超过正阈值）且 $\\Delta g^{\\text{trial}} \\ge 0$（分离试探步）且 $g_k \\ge 0$（当前无穿透）。如果 $s_k=1$ 且这些条件成立，则设置 $s_{k+1}=0$。否则，保留 $s_{k+1}=s_k$。\n4. 状态更新。为测试模型接受试探增量，并设置 $g_{k+1} = g_{\\text{pred}}$。\n\n抖动防止原理：假设牛顿迭代产生在零附近的振荡预测，例如 $g_{\\text{pred}}$ 在两个值 $a$ 和 $b$ 之间切换，其中 $a \\in (\\alpha,0)$ 且 $b \\in (0,\\beta)$。在基于符号的简单规则下，每次迭代都可能切换状态。在滞回规则下，一旦状态变为激活，后续的 $g_{\\text{pred}} \\in (\\alpha,\\beta)$ 不会触发失活；类似地，一旦状态变为未激活，$g_{\\text{pred}} \\in (\\alpha,\\beta)$ 也不会触发激活。因此，切换仅限于预测间隙以有限余量超过阈值的情况。附加的单边检查可防止在线性预测有噪声时，在检测到闭合步或当前穿透时发生释放，否则会导致不一致的切换。\n\n数值参数和单位：我们指定 $\\alpha = -1\\times 10^{-6}$ m 和 $\\beta = 3\\times 10^{-6}$ m。所有间隙和增量都以米为单位。测试套件的用例涵盖了接近、在零附近的振荡穿越、分离时的释放、阈值相等的边界情况、已存在穿透以及始终张开的场景。\n\n程序实现细节：\n- 对每个测试用例，初始化 $(s_0,g_0)$ 并遍历规定的序列 $\\{\\Delta g^{\\text{trial}}_k\\}$，应用规则从 $s_k$ 和 $g_k$ 计算 $s_{k+1}$ 和 $g_{k+1}$。\n- 每当 $s_{k+1} \\ne s_k$ 时，计数一次切换。\n- 将每个用例的总计数附加到结果列表中。\n- 以要求的格式打印列表。\n\n滞回确保了在振荡测试中，只发生一次激活，然后状态保持稳定；而在释放测试中，在分离步上越过正阈值后发生一次失活。等式条件 $g_{\\text{pred}}=\\alpha$ 或 $g_{\\text{pred}}=\\beta$ 满足各自的不等式，因此会触发激活或失活，从而在边界处提供了确定性的决胜规则。", "answer": "[1,1,1,1,1,1,0]", "id": "2584002"}]}