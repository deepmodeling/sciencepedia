{"hands_on_practices": [{"introduction": "在深入研究用于裂纹分析的特定有限元技术之前，我们首先要通过一个基础性的推导来巩固我们的理论基础。这个练习将经典的线弹性断裂力学（LEFM）与我们计算的目标——应力强度因子（SIF）联系起来。通过从路径无关的 $J$ 积分的定义出发，并利用裂纹尖端附近的渐近场，我们可以推导出 $J$ 积分与模式 I 和模式 II 应力强度因子 $K_I$ 和 $K_{II}$ 之间的精确关系[@problem_id:2596490]。这个练习不仅揭示了这些基本断裂参数之间的内在联系，也强调了我们后续数值方法旨在计算的核心物理量。", "problem": "考虑一个包含无牵引力裂纹的二维、均匀、各向同性、线弹性体。在原点处的裂纹尖端周围使用一个奇异裂纹尖端有限元，其插值函数能精确再现裂纹尖端场的主导阶渐近行为。引入以裂纹尖端为中心点的极坐标系 $(r,\\theta)$，裂纹面位于 $\\theta=\\pm \\pi$ 处。假设为混合模式加载，其I型和II型应力强度因子分别为 $K_I$ 和 $K_{II}$。角度以弧度为单位。\n\n从线弹性断裂力学中路径无关的 $J$-积分定义出发，\n$$\nJ=\\int_{\\Gamma}\\big(W\\,n_x-\\sigma_{ij}n_j\\,\\frac{\\partial u_i}{\\partial x}\\big)\\,ds,\n$$\n其中 $\\Gamma$ 是围绕尖端的逆时针轮廓线，$W=\\tfrac{1}{2}\\sigma_{ij}\\varepsilon_{ij}$ 是应变能密度，$\\boldsymbol{n}$ 是 $\\Gamma$ 的向外单位法向量，$(\\sigma_{ij},u_i)$ 是由奇异裂纹尖端单元根据主导阶渐近场再现的应力和位移场，使用极坐标和渐近场的模式分解，在环形轮廓线 $\\Gamma: r=\\rho\\to 0$ 趋于消失的极限下计算 $J$。在平面应变条件下进行计算，并用 $K_I$、$K_{II}$、杨氏模量 $E$ 和泊松比 $\\nu$ 来唯一表示 $J$ 的最终结果。\n\n你的最终答案必须是一个单一的闭合形式解析表达式。不要提供中间方程，也不要在最终的方框答案中包含单位。", "solution": "其基本依据是各向同性材料的线弹性理论以及在线弹性断裂力学中作为能量释放率的路径无关度量—— $J$-积分的定义。对于无牵引力的裂纹尖端，其近尖端渐近场由 Williams 展开式（或等效地，Westergaard 解）给出，在混合模式下，该场可加性地分解为 I 型和 II 型两部分。这些渐近场在以尖端为中心的极坐标系 $(r,\\theta)$ 中，具有以下经过充分验证的性质：\n- 应力按 $\\sigma_{ij}(r,\\theta)\\sim r^{-1/2}$ 的比例变化，其角度依赖性由特定模式的函数承载，即\n$$\n\\sigma_{ij}(r,\\theta)=\\frac{K_I}{\\sqrt{2\\pi r}}\\,f^{(I)}_{ij}(\\theta)+\\frac{K_{II}}{\\sqrt{2\\pi r}}\\,f^{(II)}_{ij}(\\theta).\n$$\n- 位移梯度按 $\\partial u_i/\\partial x_k \\sim r^{-1/2}$ 的比例变化，其角度依赖函数 $g^{(I)}_{ik}(\\theta)$ 和 $g^{(II)}_{ik}(\\theta)$ 通过胡克定律与 $f^{(I)}_{ij}$ 和 $f^{(II)}_{ij}$ 呈线性关系。在平面应变条件下，关联应力和应变的弹性模量为 $E$ 和 $\\nu$，剪切模量为 $\\mu=E/(2(1+\\nu))$，Kolosov 常数为 $\\kappa=3-4\\nu$。\n\n取 $\\Gamma$ 为以尖端为中心、半径为 $r=\\rho$ 的圆，并令 $\\boldsymbol{n}=\\boldsymbol{e}_r$，因此有 $n_x=\\cos\\theta$ 和 $ds=\\rho\\,d\\theta$。$J$-积分的被积函数由两项组成：\n$$\n\\mathcal{J}(\\theta)=W\\,n_x-\\sigma_{ij}n_j\\,\\frac{\\partial u_i}{\\partial x}.\n$$\n根据渐近比例关系，$W=\\tfrac{1}{2}\\sigma_{ij}\\varepsilon_{ij}\\sim r^{-1}$，而 $\\sigma_{ij}n_j\\,\\partial u_i/\\partial x\\sim r^{-1}$。因此，乘以 $ds=\\rho\\,d\\theta$ 后，当 $\\rho\\to 0$ 时会得到有限的贡献，且极限存在。\n\n将混合模式分解代入 $J$ 的定义，利用线性性质，将 $J$ 分解为四项贡献：I 型模式自相关项、II 型模式自相关项以及两个交叉项。角度函数 $f^{(I)}_{ij}(\\theta)$ 和 $f^{(II)}_{ij}(\\theta)$ 的正交性（这是由 Williams 特征函数结构和在 $\\theta=\\pm\\pi$ 上的无牵引力边界条件得出的一个标准结果）确保了交叉项在 $\\theta\\in[-\\pi,\\pi]$ 上的积分为零。因此，\n$$\nJ=J_I+J_{II}.\n$$\n剩下的工作是计算每种纯模式的贡献。使用 Williams 展开式（或 Westergaard 势函数）中明确的 I 型和 II 型近尖端场，结合平面应变条件下的胡克定律，通过直接代入并在圆 $r=\\rho$ 上积分，可以表明每种模式都是可加性贡献，并得到\n$$\nJ_I=\\frac{K_I^2}{E'},\\qquad J_{II}=\\frac{K_{II}^2}{E'},\n$$\n其中 $E'$ 是平面应变模量 $E'=\\frac{E}{1-\\nu^2}$。该结果可通过计算下式得到\n$$\nJ=\\int_{-\\pi}^{\\pi}\\Big(W(\\rho,\\theta)\\cos\\theta-\\sigma_{ir}(\\rho,\\theta)\\frac{\\partial u_i}{\\partial x}(\\rho,\\theta)\\Big)\\,\\rho\\,d\\theta,\n$$\n其中\n$$\n\\sigma_{ij}^{(m)}(\\rho,\\theta)=\\frac{K_m}{\\sqrt{2\\pi\\rho}}\\,f^{(m)}_{ij}(\\theta),\\quad\n\\frac{\\partial u_i^{(m)}}{\\partial x}(\\rho,\\theta)=\\frac{K_m}{\\sqrt{2\\pi\\rho}}\\,h^{(m)}_{i}(\\theta),\n$$\n对于 $m\\in\\{I,II\\}$，并使用平面应变中的弹性能量关系式，将 $W$ 写成 $\\sigma_{ij}\\varepsilon_{ij}$ 的形式。由于 Williams 特征函数的归一化和无牵引力对称性，角度积分简化为常数，从而为两种模式都产生了所述的系数 $1/E'$。\n\n将两种模式的贡献结合起来，在平面应变条件下，可得：\n$$\nJ=\\frac{K_I^2+K_{II}^2}{E'}=\\frac{1-\\nu^2}{E}\\,\\big(K_I^2+K_{II}^2\\big).\n$$\n由于奇异裂纹尖端单元精确地再现了主导渐近场，因此基于单元的 $J$ 的域表示在 $\\rho\\to 0$ 时收敛到相同的连续介质极限，从而得到相同的闭合形式表达式。\n\n因此，在平面应变条件下，所要求的用 $K_I$、$K_{II}$、$E$ 和 $\\nu$ 表示 $J$ 的表达式为\n$$\nJ=\\frac{1-\\nu^2}{E}\\,\\big(K_I^2+K_{II}^2\\big).\n$$", "answer": "$$\\boxed{\\frac{1-\\nu^2}{E}\\left(K_I^2+K_{II}^2\\right)}$$", "id": "2596490"}, {"introduction": "在建立了理论联系之后，下一个合乎逻辑的步骤是通过直接的数值实验来验证特殊单元的有效性。这个实践练习旨在通过比较标准二次单元和“四分之一点”奇异单元在模拟裂纹面位移时的表现，来展示后者的优越性[@problem_id:2596472]。我们将一个单元的插值结果与已知的 $\\sqrt{r}$ 精确解进行对比，并评估近似误差。这个练习将清晰地揭示，为什么专门设计的奇异单元对于在断裂分析中获得准确解是必不可少的。", "problem": "考虑在二维各向同性线性弹性断裂力学（LEFM）中，针对平面应变条件下的I型裂纹，验证奇异裂尖插值与解析近尖端场的对比情况。假设材料为均匀、各向同性，其杨氏模量为 $E$，泊松比为 $\\nu$。令剪切模量为 $\\mu = \\dfrac{E}{2(1+\\nu)}$，Kolosov 常数为 $\\kappa = 3 - 4 \\nu$（平面应变）。在裂纹尖端附近，以尖端为中心、裂纹沿x轴负方向的极坐标系 $(r,\\theta)$ 中，对于应力强度因子为 $K_I$ 的I型裂纹，在裂纹表面 $\\theta = \\pm \\pi$ 处的主导阶渐近位移是经过充分检验的LEFM结果\n$$\nu_y^{\\pm}(r) = \\pm \\frac{K_I}{2 \\mu} \\sqrt{\\frac{r}{2 \\pi}} \\, (\\kappa + 1), \\quad u_x^{\\pm}(r) = 0,\n$$\n其中角度单位为弧度，$r$ 的单位为米。定义常数\n$$\nC = \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1),\n$$\n因此在上裂纹面 $\\theta = \\pi$ 上有 $u_y^{+}(r) = C \\sqrt{r}$。\n\n我们关注于使用单个二次边（三节点）等参插值来近似上裂纹面在 $r \\in [0, L]$ 区间上的位移 $u_y^{+}(r)$。该插值使用自然坐标 $\\xi \\in [-1,1]$ 和边上的二次拉格朗日形函数：\n- $N_1(\\xi) = \\dfrac{1}{2} \\xi (\\xi - 1)$ 对应于 $\\xi = -1$ 处的尖端节点，\n- $N_5(\\xi) = 1 - \\xi^2$ 对应于 $\\xi = 0$ 处的边中节点，\n- $N_2(\\xi) = \\dfrac{1}{2} \\xi (\\xi + 1)$ 对应于 $\\xi = +1$ 处的远端节点。\n\n对于等参关系 $r(\\xi) = N_1(\\xi) r_1 + N_5(\\xi) r_5 + N_2(\\xi) r_2$，需要考虑两种几何映射：\n- 标准非奇异映射：$r_1 = 0$, $r_5 = L/2$, $r_2 = L$。\n- 四分之一点奇异裂尖映射：$r_1 = 0$, $r_5 = L/4$, $r_2 = L$。\n\n在两种情况下，节点位移值均取自节点物理位置处的解析解：$u_1 = C \\sqrt{r_1}$, $u_5 = C \\sqrt{r_5}$, $u_2 = C \\sqrt{r_2}$。沿边的有限元插值为\n$$\nu_h(\\xi) = N_1(\\xi) u_1 + N_5(\\xi) u_5 + N_2(\\xi) u_2.\n$$\n在参数位置 $\\xi$ 处的精确解析值为 $u_{\\text{ex}}(\\xi) = C \\sqrt{r(\\xi)}$。\n\n您的任务：\n- 对于每种映射，在参数点样本集 $\\Xi = [-0.5, 0.0, 0.5, 0.8]$ 上评估近似误差。使用相对离散 $L^2$ 误差\n$$\ne_{L^2} = \\sqrt{\\frac{\\sum_{\\xi \\in \\Xi} \\left(u_h(\\xi) - u_{\\text{ex}}(\\xi)\\right)^2}{\\sum_{\\xi \\in \\Xi} u_{\\text{ex}}(\\xi)^2}}.\n$$\n- 对于每种映射，使用位移相关法在边中位置 $\\xi = 0$ 处估计 $K_I$。令 $\\delta = 2 u_h(0)$ 表示上裂纹面的裂纹张开位移（上表面位移大小的两倍），并令 $r_m = r(0)$ 为边中点距离尖端的物理距离。通过反转解析关系 $\\delta = 2 C \\sqrt{r}$ 来计算\n$$\nK_{\\text{est}} = \\delta \\, \\mu \\, \\sqrt{2 \\pi} \\Big/ \\left((\\kappa + 1) \\sqrt{r_m}\\right),\n$$\n并测量相对误差 $e_K = \\left|K_{\\text{est}} - K_I\\right|/K_I$。\n\n所有量均采用国际单位制（SI）：$E$ 的单位为 $\\text{Pa}$，$K_I$ 的单位为 $\\text{Pa} \\cdot \\sqrt{\\text{m}}$，$L$ 的单位为 $\\text{m}$，位移单位为 $\\text{m}$。角度单位为弧度。计算出的误差 $e_{L^2}$ 和 $e_K$ 是无量纲的。\n\n测试套件：\n- 案例1：$E = 210\\times 10^9$, $\\nu = 0.3$, $K_I = 25\\times 10^6$, $L = 1\\times 10^{-3}$。\n- 案例2：$E = 70\\times 10^9$, $\\nu = 0.33$, $K_I = 1\\times 10^6$, $L = 1\\times 10^{-2}$。\n- 案例3：$E = 3\\times 10^9$, $\\nu = 0.49$, $K_I = 5\\times 10^5$, $L = 5\\times 10^{-4}$。\n\n对于每个案例，计算四个数值：标准映射的相对离散 $L^2$ 误差 $e_{L^2}^{\\text{std}}$，四分之一点映射的相对离散 $L^2$ 误差 $e_{L^2}^{\\text{qp}}$，标准映射的相对 $K$ 误差 $e_{K}^{\\text{std}}$，以及四分之一点映射的相对 $K$ 误差 $e_{K}^{\\text{qp}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个 Python 风格的列表的列表作为结果，每个内部列表对应一个给定顺序的测试案例。每个内部列表必须是 $[e_{L^2}^{\\text{std}}, e_{L^2}^{\\text{qp}}, e_{K}^{\\text{std}}, e_{K}^{\\text{qp}}]$，使用十进制表示法。例如，一行类似于 $[[0.1,0.0,0.2,0.0],[\\dots],\\dots]$。", "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于线性弹性断裂力学和有限元法的原理，问题提法得当，数据充分且一致，并以客观、明确的语言表述。这些任务构成了计算断裂力学中的一个标准验证练习。因此，我们可以着手求解。\n\n该问题要求对用于模拟裂纹表面近尖端位移场的二次线单元的两种不同等参映射，评估两种类型的误差。在应用于具体测试案例之前，可以对分析进行泛化。\n\n我们首先根据给定的杨氏模量 $E$ 和泊松比 $\\nu$ 来定义材料常数：\n剪切模量 $\\mu$ 由下式给出\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\n平面应变下的 Kolosov 常数 $\\kappa$ 为\n$$ \\kappa = 3 - 4\\nu $$\n上裂纹面 $(\\theta = \\pi)$ 的解析位移为 $u_y^+(r) = C \\sqrt{r}$，其中常数 $C$ 定义为\n$$ C = \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1) $$\n此处，$K_I$ 是 I 型应力强度因子。\n\n有限元近似使用三节点二次拉格朗日形函数：\n$N_1(\\xi) = \\frac{1}{2}\\xi(\\xi-1)$, $N_5(\\xi) = 1-\\xi^2$, and $N_2(\\xi) = \\frac{1}{2}\\xi(\\xi+1)$。\n几何 $r(\\xi)$ 和位移 $u_h(\\xi)$ 采用等参插值：\n$$ r(\\xi) = N_1(\\xi) r_1 + N_5(\\xi) r_5 + N_2(\\xi) r_2 $$\n$$ u_h(\\xi) = N_1(\\xi) u_1 + N_5(\\xi) u_5 + N_2(\\xi) u_2 $$\n节点坐标是相对于单元长度 $L$ 定义的，裂纹尖端位于 $r_1=0$。节点位移根据解析解设定：$u_1 = C\\sqrt{r_1}$, $u_5 = C\\sqrt{r_5}$, $u_2 = C\\sqrt{r_2}$。由于 $r_1=0$，因此 $u_1=0$。\n\n首先，我们分析四分之一点映射，其节点坐标为 $r_1=0$, $r_5=L/4$ 和 $r_2=L$。几何映射为：\n$$ r(\\xi) = N_1(\\xi)(0) + N_5(\\xi)\\frac{L}{4} + N_2(\\xi)L = (1-\\xi^2)\\frac{L}{4} + \\frac{1}{2}\\xi(\\xi+1)L $$\n$$ r(\\xi) = \\frac{L}{4} (1-\\xi^2 + 2\\xi(\\xi+1)) = \\frac{L}{4} (1-\\xi^2 + 2\\xi^2 + 2\\xi) = \\frac{L}{4} (1 + 2\\xi + \\xi^2) = \\frac{L}{4}(1+\\xi)^2 $$\n在参数位置 $\\xi$ 处的精确位移为 $u_{\\text{ex}}(\\xi) = C\\sqrt{r(\\xi)}$。代入映射关系可得：\n$$ u_{\\text{ex}}(\\xi) = C \\sqrt{\\frac{L}{4}(1+\\xi)^2} = \\frac{C\\sqrt{L}}{2}(1+\\xi) $$\n现在，我们计算有限元插值 $u_h(\\xi)$。节点位移为 $u_1 = 0$, $u_5 = C\\sqrt{L/4} = C\\sqrt{L}/2$ 和 $u_2 = C\\sqrt{L}$。\n$$ u_h(\\xi) = N_1(\\xi)(0) + N_5(\\xi)\\frac{C\\sqrt{L}}{2} + N_2(\\xi)C\\sqrt{L} = C\\sqrt{L} \\left( \\frac{1}{2}(1-\\xi^2) + \\frac{1}{2}\\xi(\\xi+1) \\right) $$\n$$ u_h(\\xi) = \\frac{C\\sqrt{L}}{2} (1-\\xi^2 + \\xi^2+\\xi) = \\frac{C\\sqrt{L}}{2}(1+\\xi) $$\n我们发现对于所有 $\\xi \\in [-1,1]$，$u_h(\\xi) = u_{\\text{ex}}(\\xi)$。这是四分之一点单元的一个基本性质：它能精确地再现其边上的 $\\sqrt{r}$ 奇异性行为。因此，近似误差 $(u_h(\\xi) - u_{\\text{ex}}(\\xi))$ 对所有样本点都恒等于零。所以，四分之一点映射的相对离散 $L^2$ 误差必定为零：\n$$ e_{L^2}^{\\text{qp}} = 0 $$\n\n接下来，我们分析估计的应力强度因子的误差 $e_K$。估计公式为：\n$$ K_{\\text{est}} = \\frac{\\delta \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_m}} $$\n其中 $\\delta = 2 u_h(0)$ 且 $r_m = r(0)$。在边中位置 $\\xi=0$ 处，形函数为 $N_1(0)=0$, $N_5(0)=1$, $N_2(0)=0$。\n这得到 $r_m = r(0) = r_5$ 和 $u_h(0) = u_5$。裂纹张开位移为 $\\delta = 2u_5$。将这些代入 $K_{\\text{est}}$ 的公式：\n$$ K_{\\text{est}} = \\frac{(2u_5) \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_5}} $$\n节点位移 $u_5$ 是由解析解给出的，$u_5 = C\\sqrt{r_5}$。代入此式以及 $C$ 的定义：\n$$ K_{\\text{est}} = \\frac{2 \\left( \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1) \\sqrt{r_5} \\right) \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_5}} $$\n这些项在代数上可以消去：\n$$ K_{\\text{est}} = \\frac{2 K_I (\\kappa+1) \\sqrt{r_5} \\mu \\sqrt{2\\pi}}{2 \\mu \\sqrt{2\\pi} (\\kappa+1) \\sqrt{r_5}} = K_I $$\n这个结果与边中节点的位置 $r_5$ 无关。它既适用于标准映射（$r_5 = L/2$），也适用于四分之一点映射（$r_5 = L/4$）。考虑到节点位移是由解析解设定的，这种估计 $K_I$ 的方法是同义反复的。因此，两种映射的相对误差 $e_K = |K_{\\text{est}} - K_I|/K_I$ 都为零：\n$$ e_{K}^{\\text{std}} = 0 \\quad \\text{and} \\quad e_{K}^{\\text{qp}} = 0 $$\n\n最后，我们分析标准非奇异映射的 $L^2$ 误差，其中 $r_1=0$, $r_5=L/2$ 和 $r_2=L$。几何映射为：\n$$ r(\\xi) = (1-\\xi^2)\\frac{L}{2} + \\frac{1}{2}\\xi(\\xi+1)L = \\frac{L}{2}(1-\\xi^2 + \\xi^2+\\xi) = \\frac{L}{2}(1+\\xi) $$\n精确位移为 $u_{\\text{ex}}(\\xi) = C\\sqrt{r(\\xi)} = C\\sqrt{\\frac{L}{2}(1+\\xi)}$。\n节点位移为 $u_1=0$, $u_5=C\\sqrt{L/2}$, $u_2=C\\sqrt{L}$。插值为：\n$$ u_h(\\xi) = u_5 N_5(\\xi) + u_2 N_2(\\xi) = C\\sqrt{L/2}\\,(1-\\xi^2) + C\\sqrt{L}\\,\\frac{1}{2}\\xi(\\xi+1) $$\n$$ u_h(\\xi) = C\\sqrt{L} \\left( \\frac{1-\\xi^2}{\\sqrt{2}} + \\frac{\\xi(\\xi+1)}{2} \\right) $$\n与四分之一点情况不同，$u_h(\\xi)$ 不等于 $u_{\\text{ex}}(\\xi)$。我们必须计算相对误差：\n$$ e_{L^2}^{\\text{std}} = \\sqrt{\\frac{\\sum_{\\xi \\in \\Xi} \\left(u_h(\\xi) - u_{\\text{ex}}(\\xi)\\right)^2}{\\sum_{\\xi \\in \\Xi} u_{\\text{ex}}(\\xi)^2}} $$\n请注意，$u_h(\\xi)$ 和 $u_{\\text{ex}}(\\xi)$ 都与因子 $C\\sqrt{L}$ 成正比。该因子在相对误差表达式的分子和分母中被消去。因此，$e_{L^2}^{\\text{std}}$ 是一个与 $E, \\nu, K_I, L$ 无关的常数。我们针对样本点 $\\Xi = [-0.5, 0.0, 0.5, 0.8]$ 计算该值。\n让我们定义归一化位移 $\\tilde{u}_h(\\xi) = u_h(\\xi)/(C\\sqrt{L})$ 和 $\\tilde{u}_{\\text{ex}}(\\xi) = u_{\\text{ex}}(\\xi)/(C\\sqrt{L})$。\n$$ \\tilde{u}_{\\text{ex}}(\\xi) = \\sqrt{\\frac{1+\\xi}{2}} $$\n$$ \\tilde{u}_h(\\xi) = \\frac{1-\\xi^2}{\\sqrt{2}} + \\frac{\\xi(\\xi+1)}{2} $$\n我们对 $\\xi \\in \\Xi$ 计算总和：\n- 对于 $\\xi = -0.5$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.25} = 0.5$，$\\tilde{u}_h = \\frac{0.75}{\\sqrt{2}} - 0.125 \\approx 0.40533$。\n- 对于 $\\xi = 0.0$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.5} \\approx 0.70711$，$\\tilde{u}_h = \\frac{1}{\\sqrt{2}} \\approx 0.70711$。（在节点处误差为零）。\n- 对于 $\\xi = 0.5$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.75} \\approx 0.86603$，$\\tilde{u}_h = \\frac{0.75}{\\sqrt{2}} + 0.375 \\approx 0.90533$。\n- 对于 $\\xi = 0.8$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.9} \\approx 0.94868$，$\\tilde{u}_h = \\frac{0.36}{\\sqrt{2}} + 0.72 \\approx 0.97456$。\n\n误差平方和：$\\sum (\\tilde{u}_h - \\tilde{u}_{\\text{ex}})^2 \\approx (-0.09467)^2 + 0^2 + (0.03930)^2 + (0.02588)^2 \\approx 0.008962 + 0 + 0.001545 + 0.000670 = 0.011177$。\n精确值平方和：$\\sum \\tilde{u}_{\\text{ex}}^2 = 0.25 + 0.5 + 0.75 + 0.9 = 2.4$。\n相对误差为：\n$$ e_{L^2}^{\\text{std}} = \\sqrt{\\frac{0.011177}{2.4}} \\approx \\sqrt{0.004657} \\approx 0.06824 $$\n因此，对于任何有效的物理参数集，计算出的四个误差指标将是 $[0.06824, 0.0, 0.0, 0.0]$。此结果适用于所有三个给定的测试案例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FEM crack-tip interpolation verification problem for three test cases.\n    \"\"\"\n\n    # Define the set of parametric points for error evaluation.\n    xi_points = np.array([-0.5, 0.0, 0.5, 0.8])\n\n    # Define the quadratic Lagrange shape functions.\n    # N1 is not needed since r1=u1=0.\n    def N5(xi):\n        return 1 - xi**2\n\n    def N2(xi):\n        return 0.5 * xi * (xi + 1)\n\n    test_cases = [\n        # Case 1: E (Pa), nu, K_I (Pa.sqrt(m)), L (m)\n        (210e9, 0.3, 25e6, 1e-3),\n        # Case 2\n        (70e9, 0.33, 1e6, 1e-2),\n        # Case 3\n        (3e9, 0.49, 5e5, 5e-4),\n    ]\n\n    all_results = []\n\n    for E, nu, K_I, L in test_cases:\n        \n        # As derived in the solution, the relative errors e_L2^qp, e_K^std, and e_K^qp\n        # are analytically zero for this problem setup.\n        # The error e_L2^std is a constant, independent of the physical parameters.\n        # The full calculation is performed here for completeness and to demonstrate\n        # the procedure for a general case.\n\n        # ----- 1. Standard Mapping -----\n        \n        # Midside node at L/2\n        r5_std = L / 2.0\n        r2_std = L\n        \n        # Normalized displacements (division by C*sqrt(L)) for error calculation\n        # This makes the calculation independent of C and L.\n        # u_h_norm = u_h / (C*sqrt(L))\n        # u_ex_norm = u_ex / (C*sqrt(L))\n\n        sum_sq_err_std = 0.0\n        sum_sq_ex_std = 0.0\n        \n        for xi in xi_points:\n            # Physical coordinate r(xi) = L/2 * (1+xi)\n            r_val = (L / 2.0) * (1 + xi)\n            \n            # Exact solution (normalized)\n            u_ex_norm = np.sqrt(r_val / L) # = sqrt(0.5*(1+xi))\n            \n            # Interpolated solution (normalized)\n            # u5_norm = sqrt(r5_std/L) = sqrt(0.5)\n            # u2_norm = sqrt(r2_std/L) = 1.0\n            u_h_norm = np.sqrt(0.5) * N5(xi) + 1.0 * N2(xi)\n\n            sum_sq_err_std += (u_h_norm - u_ex_norm)**2\n            sum_sq_ex_std += u_ex_norm**2\n        \n        # The denominator sum_sq_ex_std cannot be zero for the given Xi.\n        e_L2_std = np.sqrt(sum_sq_err_std / sum_sq_ex_std) if sum_sq_ex_std > 0 else 0.0\n        \n        # As shown analytically, K_est = K_I, so the error is zero.\n        e_K_std = 0.0\n\n        # ----- 2. Quarter-Point Mapping -----\n        \n        # The QP element exactly reproduces the sqrt(r) field.\n        # Therefore, the interpolation error is identically zero.\n        e_L2_qp = 0.0\n        \n        # As shown analytically, K_est = K_I, so the error is zero.\n        e_K_qp = 0.0\n\n        all_results.append([e_L2_std, e_L2_qp, e_K_std, e_K_qp])\n\n    # Final print statement in the exact required format.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "2596472"}, {"introduction": "我们已经通过实验证明了四分之一点单元的卓越性能，现在是时候揭开其“魔法”背后的数学原理了。这个实践将带你深入了解奇异单元的内部工作机制，通过实现一个数值积分程序来计算一个具有代表性的奇异积分[@problem_id:2602837]。你将亲身体验到，在四分之一点映射下，参考坐标空间中的雅可比行列式如何巧妙地“抵消”物理空间中的积分奇异性，从而将一个棘手的奇异被积函数转化为一个行为良好的常规函数。完成这个练习后，你将对奇异单元为何能高效、精确地处理裂纹尖端问题有更深刻的理解。", "problem": "你的任务是实现一个单元级的高斯求积程序，以评估在有限元法（FEM）中计算应力强度因子（SIF）时出现的域积分。评估必须在等参单元中执行，并正确处理在裂纹尖端采用四分之一点映射的单元。你的程序将计算一个奇异但可积的域积分，该积分可作为用于提取SIF的路径无关积分的域形式中出现的奇异核的代理。\n\n从适用于线弹性中裂纹尖端场高级计算的基础出发：\n- 能量守恒和能量释放率的定义，这是路径无关裂纹积分的基础。\n- 散度定理，它为将线积分转换为域积分提供了依据。\n- 线弹性断裂力学中场的近尖端渐近性质，这意味着在裂纹尖端附近存在奇异被积函数，并推动了特殊等参映射的应用。\n\n你不能使用任何预封装或简化的SIF公式。相反，你的实现应基于以下原则：\n- 从具有局部坐标 $(\\xi,\\eta)\\in[-1,1]^2$ 的方形参考域到物理单元的等参映射。\n- 高斯求积法通过在参考域中的求积点对被积函数进行采样，并乘以等参映射的雅可比行列式来评估面积分。\n- 对于裂纹尖端附近的具有四分之一点映射的单元，需要进行特殊处理。在这些单元中，从裂纹尖端引出的边上的边中节点被移动到四分之一点，以便映射能够再现应变场中正确的平方根奇异性，并对组合的被积函数与雅可比行列式进行正则化，以便进行数值积分。\n\n目标积分评估：\n- 定义裂纹尖端位于笛卡尔坐标系的原点。令 $r=\\sqrt{x^2+y^2}$ 表示到裂纹尖端的距离。考虑标量函数 $g(x,y)=r^{-1/2}$，它在代理意义上捕捉了与裂纹尖端能量相关的代数奇异性结构。\n- 对于一个给定的物理矩形单元，其尺寸为 $L$（在 $x$ 方向）和 $H$（在 $y$ 方向的半高），其排列方式为裂纹沿 $x$ 轴，裂纹尖端位于 $x=0$ 的左边缘，单个单元的物理域定义为 $\\Omega=\\{(x,y): 0\\le x\\le L,\\ -H\\le y\\le H\\}$。\n- 需要评估的积分是域积分\n$$\nI(L,H)=\\iint_{\\Omega} g(x,y)\\,d\\Omega=\\iint_{\\Omega} r^{-1/2}\\,dx\\,dy.\n$$\n当 $L$ 和 $H$ 以米表示时，该积分的单位为 $\\mathrm{m}^{3/2}$。\n\n单元类型和映射：\n- 情况 A 使用一个 4 节点双线性等参四边形（通常表示为 Q4）映射，将参考正方形映射到 $\\Omega$，其角节点位于 $(0,-H)$, $(L,-H)$, $(L,H)$, $(0,H)$。\n- 情况 B 和情况 C 使用一个 8 节点“巧”单元等参四边形（通常表示为 Q8），并采用四分之一点布置来模拟裂纹尖端：尖端位于左边缘的边中节点上。8个节点的物理坐标（按标准“巧”单元约定，包括边中节点排序）是：\n    - 节点 1：$(0,-H)$，位于 $(\\xi,\\eta)=(-1,-1)$，\n    - 节点 2：$(L,-H)$，位于 $(\\xi,\\eta)=(1,-1)$，\n    - 节点 3：$(L,H)$，位于 $(\\xi,\\eta)=(1,1)$，\n    - 节点 4：$(0,H)$，位于 $(\\xi,\\eta)=(-1,1)$，\n    - 节点 5：$(L/4,-H)$，位于 $(\\xi,\\eta)=(0,-1)$（底边边中节点移至四分之一点），\n    - 节点 6：$(L,0)$，位于 $(\\xi,\\eta)=(1,0)$（右边边中节点），\n    - 节点 7：$(L/4,H)$，位于 $(\\xi,\\eta)=(0,1)$（顶边边中节点移至四分之一点），\n    - 节点 8：$(0,0)$，位于 $(\\xi,\\eta)=(-1,0)$（左边边中节点，位于裂纹尖端）。\n这种四分之一点映射通过使物理径向坐标沿从尖端发出的边与参考坐标呈二次方关系，来模拟裂纹尖端场的平方根行为。\n\n求积和算法要求：\n- 对每个单元的参考正方形，在每个方向上使用 $n$ 阶张量积高斯求积。在每个求积点 $(\\xi_i,\\eta_j)$（权重为 $(w_i,w_j)$）处：\n    1. 评估等参形函数及其导数，以计算物理坐标 $(x,y)$ 和雅可比矩阵 $J(\\xi,\\eta)$。\n    2. 计算行列式 $\\det J(\\xi,\\eta)$。\n    3. 评估 $g(x,y)=(x^2+y^2)^{-1/4}$，注意通过在 $r=0$ 处进行适当的极限处理来避免除以零。\n    4. 累加贡献项 $g(x,y)\\,\\det J(\\xi,\\eta)\\,w_i\\,w_j$。\n- 确保所有计算均采用国际单位制（SI），其中 $L$ 和 $H$ 以米为单位，积分 $I$ 以 $\\mathrm{m}^{3/2}$ 为单位报告。\n\n特殊处理的理由：\n- 在你的方法中解释，为什么在裂纹尖端附近需要四分之一点映射来准确地对奇异场进行数值积分，以及它如何改变雅可比行列式以正则化参考空间中的被积函数。\n\n测试套件和要求的输出：\n- 为以下三个测试案例实现并评估积分 $I(L,H)$：\n    1. 情况 A（基准，标准等参 Q4）：$L=1.0, H=0.5$, 求积阶数 $n=8$.\n    2. 情况 B（四分之一点等参 Q8）：$L=1.0, H=0.5$, 求积阶数 $n=8$.\n    3. 情况 C（四分之一点等参 Q8，更小的域和更高的分辨率）：$L=0.1, H=0.05$, 求积阶数 $n=16$.\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，例如，“[result1,result2,result3]”。每个结果必须是一个浮点数，代表相应测试用例的 $I(L,H)$（单位为 $\\mathrm{m}^{3/2}$），使用标准十进制表示法，文本输出中不含单位。在内部，你必须始终使用 SI 单位。\n\n交付物：\n- 一个完整的、可运行的程序，该程序实现上述要求，遵守指定的求积和等参映射，计算所要求的三个积分，并以指定的单行格式精确输出它们。", "solution": "该问题要求对一个奇异域积分进行数值评估，这是计算断裂力学中为了使用基于域的守恒积分（如 J-积分）计算应力强度因子时经常遇到的任务。该积分定义为：\n$$\nI(L,H) = \\iint_{\\Omega} g(x,y)\\,d\\Omega = \\iint_{\\Omega} (x^2+y^2)^{-1/4}\\,dx\\,dy\n$$\n函数 $g(x,y) = r^{-1/2} = (x^2+y^2)^{-1/4}$，其中 $r = \\sqrt{x^2+y^2}$ 是距原点的径向距离，在位于 $(0,0)$ 的裂纹尖端处具有奇异性。这种奇异性是可积的，因为变换到极坐标后，被积函数的形式为 $r^{-1/2} \\cdot r \\,dr\\,d\\theta = r^{1/2}\\,dr\\,d\\theta$，这在 $r=0$ 处是有限的。然而，标准的数值求积格式在处理奇异被积函数时表现不佳。解决方案是使用从一个规则的参考域，即正方形 $(\\xi,\\eta) \\in [-1,1]^2$，到物理单元域 $\\Omega$ 的等参映射。\n\n积分变换如下：\n$$\nI = \\iint_{\\Omega} g(x,y)\\,dx\\,dy = \\int_{-1}^{1}\\int_{-1}^{1} g\\left(x(\\xi,\\eta), y(\\xi,\\eta)\\right) \\det[J(\\xi,\\eta)] \\,d\\xi\\,d\\eta\n$$\n其中 $J(\\xi,\\eta)$ 是映射 $(x,y) = \\mathbf{X}(\\xi,\\eta)$ 的雅可比矩阵。然后，这个变换后的积分使用张量积高斯求积法则进行近似：\n$$\nI \\approx \\sum_{i=1}^{n} \\sum_{j=1}^{n} w_i w_j g\\left(x(\\xi_i,\\eta_j), y(\\xi_i,\\eta_j)\\right) \\det[J(\\xi_i,\\eta_j)]\n$$\n这里，$(\\xi_i, \\eta_j)$ 是求积点，$(w_i, w_j)$ 是对应的 $n$ 阶求积法则的权。问题的核心在于映射 $\\mathbf{X}(\\xi,\\eta)$ 及其雅可比行列式的构建。该映射使用形函数 $N_k(\\xi,\\eta)$ 和节点坐标 $(x_k, y_k)$ 定义：\n$$\nx(\\xi,\\eta) = \\sum_{k} N_k(\\xi,\\eta) x_k \\quad , \\quad y(\\xi,\\eta) = \\sum_{k} N_k(\\xi,\\eta) y_k\n$$\n雅可比矩阵的分量计算如下：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_k \\frac{\\partial N_k}{\\partial \\xi} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\xi} y_k \\\\ \\sum_k \\frac{\\partial N_k}{\\partial \\eta} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\eta} y_k \\end{pmatrix}\n$$\n我们按规定分析每种情况。\n\n情况 A：4 节点双线性四边形 (Q4)\n对于指定的物理角节点 $(0,-H), (L,-H), (L,H), (0,H)$，从 $(\\xi,\\eta) \\in [-1,1]^2$ 的标准 Q4 等参映射简化为：\n$$\nx(\\xi,\\eta) = \\frac{L}{2}(1+\\xi) \\quad , \\quad y(\\xi,\\eta) = H\\eta\n$$\n雅可比矩阵是常数对角矩阵：\n$$\nJ = \\begin{pmatrix} L/2 & 0 \\\\ 0 & H \\end{pmatrix} \\implies \\det(J) = \\frac{LH}{2}\n$$\n参考空间中的被积函数是 $g \\det(J) = \\left( (\\frac{L}{2}(1+\\xi))^2 + (H\\eta)^2 \\right)^{-1/4} \\frac{LH}{2}$。函数 $g$ 在物理原点 $(0,0)$ 的奇异性被映射到参考域边界上的点 $(\\xi,\\eta)=(-1,0)$。标准的高斯-勒让德求积点位于 $(-1,1)$ 内，因此不会遇到除以零的情况，但被积函数在该点附近变化剧烈，这会影响低阶求积的精度。\n\n情况 B 和 C：带四分之一点映射的 8 节点“巧”单元四边形 (Q8)\n这种配置是专门为处理裂纹尖端奇异性而设计的。裂纹尖端位于节点 8，其物理坐标为 $(0,0)$，参考坐标为 $(\\xi,\\eta)=(-1,0)$。关键特征是将边中节点 5 和 7 放置在顶部和底部物理边的四分之一点处（$x=L/4$），而不是中点（$x=L/2$）。\n\n特殊处理的理由：\n四分之一点单元的目的是将尖端附近场的已知渐近行为嵌入到单元的映射中。对于 I 型裂纹，位移与 $\\sqrt{r}$ 成正比，应变/应力与 $1/\\sqrt{r}$ 成正比，其中 $r$ 是与尖端的距离。与应变平方相关的能量密度与 $1/r$ 成正比。当前的被积函数 $g(x,y)$ 具有 $1/\\sqrt{r}$ 的行为，这是域积分公式中某些项的特征。\n\n让我们分析指定的 Q8 单元沿线 $\\eta=0$（对应于物理裂纹线 $y=0$）提供的映射。该映射简化为：\n$$\nx(\\xi,0) = \\frac{L}{4}(1+\\xi)^2\n$$\n在裂纹尖端附近 $(\\xi \\to -1)$，令 $\\zeta = 1+\\xi$。物理径向坐标 $r$ 按 $r=x \\propto \\zeta^2$ 缩放。这意味着 $\\sqrt{r} \\propto \\zeta = 1+\\xi$。\n\n现在，我们检查雅可比行列式。详细分析表明，在裂纹尖端 $(\\xi,\\eta)=(-1,0)$ 附近，雅可比矩阵具有渐近形式 $J \\approx \\begin{pmatrix} \\frac{L}{2}(1+\\xi) & 0 \\\\ 0 & H \\end{pmatrix}$，从而得到一个行列式：\n$$\n\\det(J) \\propto (1+\\xi) \\propto \\sqrt{r}\n$$\n在参考空间中需要积分的项是乘积 $g(x,y)\\det(J)$。在尖端附近，其行为是：\n$$\ng \\cdot \\det(J) \\propto \\frac{1}{\\sqrt{r}} \\cdot \\sqrt{r} = 1\n$$\n原始函数 $g(x,y)$ 中的奇异性被嵌入雅可比行列式中的奇异性所抵消。得到的被积函数 $g\\det(J)$ 在参考空间 $(\\xi,\\eta)$ 中是正则的（且近似为常数），即使在对应于裂纹尖端的点也是如此。因此，标准高斯求积可以高精度地评估该积分。这种正则化是在断裂力学中使用四分之一点单元的根本原因。\n\n实现将通过为 Q4 和 Q8 单元定义形函数及其导数，在每个高斯点构建雅可比矩阵，并累加加权和来进行。", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef shape_functions_q4(xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for a 4-node quad element.\n    Nodes are ordered CCW from bottom-left (-1,-1).\n    \"\"\"\n    xi_nodes = np.array([-1, 1, 1, -1])\n    eta_nodes = np.array([-1, -1, 1, 1])\n\n    N = 0.25 * (1 + xi * xi_nodes) * (1 + eta * eta_nodes)\n    \n    dN_dxi = 0.25 * xi_nodes * (1 + eta * eta_nodes)\n    dN_deta = 0.25 * eta_nodes * (1 + xi * xi_nodes)\n\n    return N, dN_dxi, dN_deta\n\ndef shape_functions_q8(xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for an 8-node serendipity quad element.\n    Node numbering is as specified in the problem statement.\n    \"\"\"\n    N = np.zeros(8)\n    dN_dxi = np.zeros(8)\n    dN_deta = np.zeros(8)\n    \n    xi2 = xi * xi\n    eta2 = eta * eta\n\n    # Corner nodes (i=0 to 3, corresponding to nodes 1 to 4)\n    xi_n = np.array([-1, 1, 1, -1])\n    eta_n = np.array([-1, -1, 1, 1])\n\n    for i in range(4):\n        s = xi * xi_n[i]\n        t = eta * eta_n[i]\n        N[i] = 0.25 * (1 + s) * (1 + t) * (s + t - 1)\n        dN_dxi[i] = 0.25 * xi_n[i] * (1 + t) * (2 * s + t)\n        dN_deta[i] = 0.25 * eta_n[i] * (1 + s) * (s + 2 * t)\n\n    # Midside nodes (i=4 to 7, corresponding to nodes 5 to 8)\n    # Node 5: (xi=0, eta=-1)\n    N[4] = 0.5 * (1 - xi2) * (1 - eta)\n    dN_dxi[4] = -xi * (1 - eta)\n    dN_deta[4] = -0.5 * (1 - xi2)\n    \n    # Node 6: (xi=1, eta=0)\n    N[5] = 0.5 * (1 + xi) * (1 - eta2)\n    dN_dxi[5] = 0.5 * (1 - eta2)\n    dN_deta[5] = -eta * (1 + xi)\n\n    # Node 7: (xi=0, eta=1)\n    N[6] = 0.5 * (1 - xi2) * (1 + eta)\n    dN_dxi[6] = -xi * (1 + eta)\n    dN_deta[6] = 0.5 * (1 - xi2)\n    \n    # Node 8: (xi=-1, eta=0)\n    N[7] = 0.5 * (1 - xi) * (1 - eta2)\n    dN_dxi[7] = -0.5 * (1 - eta2)\n    dN_deta[7] = -eta * (1 - xi)\n    \n    return N, dN_dxi, dN_deta\n\ndef evaluate_integral(L, H, n, element_type):\n    \"\"\"\n    Evaluates the domain integral using Gaussian quadrature.\n    \"\"\"\n    # Get Gaussian quadrature points and weights\n    xi_p, w = roots_legendre(n)\n    \n    # Physical nodal coordinates\n    if element_type == 'Q4':\n        x_nodes = np.array([0, L, L, 0])\n        y_nodes = np.array([-H, -H, H, H])\n        shape_func = shape_functions_q4\n    elif element_type == 'Q8':\n        x_nodes = np.array([0, L, L, 0, L/4, L, L/4, 0])\n        y_nodes = np.array([-H, -H, H, H, -H, 0, H, 0])\n        shape_func = shape_functions_q8\n    else:\n        raise ValueError(\"Unknown element type\")\n\n    integral_val = 0.0\n\n    # Tensor product quadrature loop\n    for i in range(n):\n        for j in range(n):\n            xi = xi_p[i]\n            eta = xi_p[j]\n            wi = w[i]\n            wj = w[j]\n\n            N, dN_dxi, dN_deta = shape_func(xi, eta)\n\n            # Isoparametric mapping\n            x = np.dot(N, x_nodes)\n            y = np.dot(N, y_nodes)\n\n            # Jacobian matrix\n            J11 = np.dot(dN_dxi, x_nodes)\n            J12 = np.dot(dN_dxi, y_nodes)\n            J21 = np.dot(dN_deta, x_nodes)\n            J22 = np.dot(dN_deta, y_nodes)\n\n            detJ = J11 * J22 - J12 * J21\n            \n            # Integrand a(x,y) = (x^2 + y^2)^(-1/4)\n            # Quadrature points are in (-1,1), so r will not be exactly 0\n            # for the mappings used.\n            r_squared = x*x + y*y\n            g = r_squared**(-0.25)\n            \n            integral_val += g * detJ * wi * wj\n            \n    return integral_val\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (L, H, n, element_type)\n        (1.0, 0.5, 8, 'Q4'),\n        (1.0, 0.5, 8, 'Q8'),\n        (0.1, 0.05, 16, 'Q8'),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, H, n, element_type = case\n        result = evaluate_integral(L, H, n, element_type)\n        results.append(result)\n        \n    # Format the output as specified\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2602837"}]}