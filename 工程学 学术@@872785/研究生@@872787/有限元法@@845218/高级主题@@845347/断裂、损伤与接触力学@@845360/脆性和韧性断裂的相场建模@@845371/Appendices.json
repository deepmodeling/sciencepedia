{"hands_on_practices": [{"introduction": "在将相场断裂模型付诸有限元（FEM）数值实现时，核心任务是建立应力与应变之间的本构关系，并推导其线性化形式，即切线模量。本练习将通过一个一维杆的实例，指导你如何处理拉压不对称性，并推导在损伤演化过程中材料的应力响应和算法切线模量。这是构建稳健高效的数值求解方案的基础。[@problem_id:2587040]", "problem": "在有限元法（FEM）中，使用断裂相场法对一维小应变杆进行建模。未损伤材料的弹性自由能密度被视为应变的二次函数，并采用拉压分解来防止在受压情况下发生损伤演化。该分解作用于应变能，其正（拉伸）和负（压缩）部分通过麦考利括号定义如下。设小应变为 $\\varepsilon$。定义 $\\langle x \\rangle_{+} = \\max(x,0)$ 和 $\\langle x \\rangle_{-} = \\min(x,0)$。未损伤能量密度为 $\\psi_{0}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2}$，其中杨氏模量 $E0$，分解后的能量为\n$$\n\\psi_{0}^{+}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2},\n\\qquad\n\\psi_{0}^{-}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2}.\n$$\n退化仅通过标量退化函数 $g(d)$ 作用于拉伸能，其中损伤变量满足 $0 \\le d \\le 1$。考虑广泛使用的选择\n$$\ng(d) = (1-d)^{2} + k,\n$$\n其中 $k \\in (0,1)$ 是一个小的残余刚度。退化的弹性自由能密度表示为\n$$\n\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}^{+}(\\varepsilon) + \\psi_{0}^{-}(\\varepsilon).\n$$\n假设在有限元解的全局 Newton 迭代过程中，损伤变量 $d$ 在局部 Gauss 点上保持固定，并且进入线性化的算法（一致）切线模量为 $\\mathbb{C}_{\\mathrm{alg}} = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$, 其中 Cauchy 应力由超弹性理论定义为 $\\sigma(\\varepsilon,d) = \\frac{\\partial \\psi(\\varepsilon,d)}{\\partial \\varepsilon}$。\n\n从给定的自由能分解和定义出发，推导一维情况下 $\\sigma(\\varepsilon,d)$ 和算法切线模量 $C_{\\mathrm{alg}}(\\varepsilon,d) = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$ 的分段表达式，并注意拉压分解。然后，使用参数 $E = 210 \\text{ GPa}$, $k = 1.0 \\times 10^{-6}$, $d = 0.6$ 和应变 $\\varepsilon = 2.0 \\times 10^{-3}$ 计算算法切线模量。\n\n将您的最终数值答案四舍五入到四位有效数字，并以 $\\text{GPa}$ 为单位表示。您最终报告的答案必须仅为指定状态下的算法切线模量值。", "solution": "我们从给定的带有拉压分解的超弹性自由能密度开始：\n$$\n\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}^{+}(\\varepsilon) + \\psi_{0}^{-}(\\varepsilon)\n$$\n其中，$\\psi_{0}^{+}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2}$ 和 $\\psi_{0}^{-}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2}$。退化函数为 $g(d) = (1-d)^{2} + k$。\n\n柯西应力 $\\sigma$ 由超弹性关系 $\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon}$ 定义。我们需要分情况讨论：\n\n1.  **拉伸状态 ($\\varepsilon > 0$)**:\n    此时，$\\langle \\varepsilon \\rangle_{+} = \\varepsilon$ 且 $\\langle \\varepsilon \\rangle_{-} = 0$。自由能密度简化为：\n    $$\n    \\psi(\\varepsilon,d) = g(d) \\frac{1}{2} E \\varepsilon^2\n    $$\n    应力为：\n    $$\n    \\sigma(\\varepsilon,d) = \\frac{\\partial}{\\partial \\varepsilon} \\left( g(d) \\frac{1}{2} E \\varepsilon^2 \\right) = g(d) E \\varepsilon\n    $$\n    算法切线模量为：\n    $$\n    C_{\\mathrm{alg}}(\\varepsilon,d) = \\frac{\\partial \\sigma}{\\partial \\varepsilon} = g(d) E\n    $$\n\n2.  **压缩状态 ($\\varepsilon  0$)**:\n    此时，$\\langle \\varepsilon \\rangle_{+} = 0$ 且 $\\langle \\varepsilon \\rangle_{-} = \\varepsilon$。自由能密度简化为：\n    $$\n    \\psi(\\varepsilon,d) = \\frac{1}{2} E \\varepsilon^2\n    $$\n    应力为：\n    $$\n    \\sigma(\\varepsilon,d) = \\frac{\\partial}{\\partial \\varepsilon} \\left( \\frac{1}{2} E \\varepsilon^2 \\right) = E \\varepsilon\n    $$\n    算法切线模量为：\n    $$\n    C_{\\mathrm{alg}}(\\varepsilon,d) = \\frac{\\partial \\sigma}{\\partial \\varepsilon} = E\n    $$\n\n3.  **零应变状态 ($\\varepsilon = 0$)**:\n    应力为零，但切线模量在这一点是不连续的，从左侧逼近为 $E$，从右侧逼近为 $g(d)E$。\n\n问题要求计算在应变 $\\varepsilon = 2.0 \\times 10^{-3}$ 时的算法切线模量。这是一个拉伸状态，因此我们使用公式 $C_{\\mathrm{alg}} = g(d)E$。\n\n给定参数：$E = 210 \\text{ GPa}$, $d = 0.6$, $k = 1.0 \\times 10^{-6}$。\n首先计算退化函数的值：\n$$\ng(d=0.6) = (1 - 0.6)^2 + 1.0 \\times 10^{-6} = 0.4^2 + 1.0 \\times 10^{-6} = 0.16 + 0.000001 = 0.160001\n$$\n然后计算算法切线模量：\n$$\nC_{\\mathrm{alg}} = g(0.6) \\times E = 0.160001 \\times 210 \\text{ GPa} \\approx 33.60021 \\text{ GPa}\n$$\n根据要求，将结果四舍五入到四位有效数字，得到 $33.60 \\text{ GPa}$。", "answer": "$$\\boxed{33.60}$$", "id": "2587040"}, {"introduction": "相场模型中的参数，如临界能量释放率 $G_c$ 和长度尺度 $\\ell$，并非总能直接测量。本练习旨在弥合理论模型与实验现实之间的鸿沟，你将学习如何从可测量的宏观力学性能（如材料的抗拉强度和损伤区的宽度）出发，反向推导出模型的关键参数。掌握这种标定方法是使相场模型具有预测能力的关键一步。[@problem_id:2587016]", "problem": "考虑一根长度为 $L$、横截面积为 $A$ 的一维小应变单轴杆，其两端承受单调递增的拉伸位移，并使用 Ambrosio-Tortorelli (AT2) 型脆性相场方法进行建模。令 $u(x)$ 表示位移，$d(x) \\in [0,1]$ 表示裂纹相场变量，其中 $d=0$ 对应于完好状态，$d=1$ 对应于完全断裂状态。假设材料具有杨氏模量为 $E$ 的线性弹性本构行为，并采用具有内禀长度尺度 $\\ell$ 和临界能量释放率 $G_c$ 的标准 AT2 脆性断裂能量正则化。\n\n单位面积的总能量泛函（忽略恒定的横截面并在杆上积分）由下式给出\n$$\n\\mathcal{E}[u,d] \\;=\\; \\int_{0}^{L} \\left( g(d)\\,\\psi_e(\\varepsilon(u)) \\;+\\; G_c\\,\\gamma_\\ell(d,d') \\right)\\,\\mathrm{d}x,\n$$\n其中小应变张量简化为一维应变 $\\varepsilon(u)=u'(x)$，弹性应变能密度为 $\\psi_e(\\varepsilon) = \\tfrac{1}{2}E\\,\\varepsilon^2$，退化函数为 $g(d)=(1-d)^2+\\eta$（其中 $\\eta \\to 0^{+}$），裂纹面密度为\n$$\n\\gamma_\\ell(d,d') \\;=\\; \\frac{1}{2\\ell}\\,d^2 \\;+\\; \\frac{\\ell}{2}\\,(d')^2.\n$$\n\n从变分法和能量最小化原理出发，并仅使用上述定义和标准的小应变线性弹性理论，执行以下操作：\n\n1) 对于均匀应变 $\\varepsilon$ 状态，推导关于均匀相场 $d$ 的驻值条件，并由此获得能量驻定状态下的名义应力 $\\sigma(\\varepsilon)$ 作为 $\\varepsilon$ 的函数。在位移控制试验中，使用软化分岔起始的论证，确定均匀响应达到峰值并开始退化时的临界名义应力 $\\sigma_c$。您的推导必须仅基于所提供的能量结构，明确展示 $\\sigma_c$ 对 $E$、$G_c$ 和 $\\ell$ 的标度关系。\n\n2) 考虑无限一维域中零载荷下的稳态孤立裂纹剖面，该剖面通过仅最小化断裂正则化项并满足 $d(0)=1$ 和 $\\lim_{|x|\\to\\infty}d(x)=0$ 的条件来确定。推导 $d(x)$ 的闭式解，并用它来定义相场剖面的半峰全宽 $w$，即 $d(x)=\\tfrac{1}{2}$ 的两点之间的距离。以 $\\ell$ 表示 $w$。\n\n3) 利用您在 (1) 和 (2) 中得到的结果，消去 $\\ell$ 和 $G_c$，代之以可测量的量。给定弹性模量 $E$、峰值载荷下测得的临界名义应力 $\\sigma_c$ 以及观测到的损伤带的半峰全宽 $w$，使用您获得的 AT2 模型方程，推导 $G_c$ 和 $\\ell$ 的显式校准公式。\n\n4) 实现一个程序，对于下方的每个测试用例，该程序以 $E$ (单位：帕斯卡)、$\\sigma_c$ (单位：帕斯卡) 和 $w$ (单位：米) 作为输入，计算 $\\ell$ (单位：米) 和 $G_c$ (单位：焦耳每平方米)，并返回序对 $(G_c, \\ell)$。\n\n使用以下测试套件（每个测试是一个 SI 单位的三元组 $(E,\\sigma_c,w)$）：\n- 测试 1：$(7.0\\times 10^{10},\\; 3.0\\times 10^{8},\\; 6.0\\times 10^{-4})$\n- 测试 2：$(2.10\\times 10^{11},\\; 1.0\\times 10^{9},\\; 2.0\\times 10^{-4})$\n- 测试 3：$(3.0\\times 10^{9},\\; 6.0\\times 10^{7},\\; 3.0\\times 10^{-3})$\n- 测试 4：$(5.0\\times 10^{10},\\; 2.0\\times 10^{8},\\; 1.0\\times 10^{-6})$\n\n最终输出要求：\n- 单位：$G_c$ 以焦耳每平方米报告，$\\ell$ 以米报告。\n- 输出格式：您的程序应生成单行输出，其中包含所有测试的结果，形式为逗号分隔的列表，并用方括号括起，序对按顺序展开，即 $[G_{c}^{(1)},\\ell^{(1)},G_{c}^{(2)},\\ell^{(2)},G_{c}^{(3)},\\ell^{(3)},G_{c}^{(4)},\\ell^{(4)}]$。\n- 数值格式：每个数字必须以具有六位有效数字的浮点值打印。", "solution": "在尝试任何解决方案之前，对所提出的问题进行了严格的验证。\n\n**步骤1：提取的已知条件**\n- **域**：一维杆，长度 $L$，横截面积 $A$。\n- **物理**：小应变单轴拉伸，脆性断裂。\n- **模型**：Ambrosio-Tortorelli (AT2) 相场模型。\n- **状态变量**：位移 $u(x)$，相场 $d(x) \\in [0,1]$。\n- **材料参数**：杨氏模量 $E$，临界能量释放率 $G_c$，内禀长度尺度 $\\ell$。\n- **能量泛函（单位面积对长度积分）**：$\\mathcal{E}[u,d] = \\int_{0}^{L} \\left( g(d)\\,\\psi_e(\\varepsilon(u)) + G_c\\,\\gamma_\\ell(d,d') \\right)\\,\\mathrm{d}x$。\n- **应变**：$\\varepsilon(u) = u'(x)$。\n- **弹性应变能密度**：$\\psi_e(\\varepsilon) = \\frac{1}{2}E\\,\\varepsilon^2$。\n- **退化函数**：$g(d)=(1-d)^2+\\eta$，其中 $\\eta \\to 0^{+}$。\n- **裂纹面密度**：$\\gamma_\\ell(d,d') = \\frac{1}{2\\ell}\\,d^2 + \\frac{\\ell}{2}\\,(d')^2$。\n\n**步骤2：问题陈述的验证**\n- **科学依据**：该问题基于 Ambrosio-Tortorelli 相场模型，这是计算连续介质力学中用于断裂模拟的一个标准且成熟的框架。所有提供的方程都是该模型在特定一维脆性断裂情况下的正确表示。该问题在科学上是合理的。\n- **适定性**：这些任务以数学精度定义。它们需要变分法和材料力学中的标准技术，从而得出唯一且有意义的结果。所要求的校准是应用此类模型的标准程序。该问题是适定的。\n- **客观性**：问题以客观、正式的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论**\n该问题被认定为**有效**。它是自洽的、科学合理的且客观的。将根据要求，基于基本原理构建解决方案。对于所有推导，正则化参数 $\\eta$ 均取 $\\eta \\to 0$。\n\n**第1部分：临界应力的推导**\n\n问题要求分析均匀状态，其中应变 $\\varepsilon$ 和相场 $d$ 在整个杆中都是均匀的。因此，$\\varepsilon(x) = \\varepsilon$ 和 $d(x) = d$ 是常数，这意味着 $d' = 0$。总能量的被积函数，代表能量密度 $\\Psi$，简化为：\n$$\n\\Psi(\\varepsilon, d) = g(d)\\,\\psi_e(\\varepsilon) + G_c\\,\\gamma_\\ell(d,0) = (1-d)^2 \\frac{1}{2}E\\varepsilon^2 + \\frac{G_c}{2\\ell}d^2\n$$\n能量驻定要求对于给定的施加应变 $\\varepsilon$，能量密度相对于内变量 $d$ 最小化。此条件通过将 $\\Psi$ 对 $d$ 的偏导数设为零来找到：\n$$\n\\frac{\\partial \\Psi}{\\partial d} = 2(1-d)(-1) \\frac{1}{2}E\\varepsilon^2 + \\frac{G_c}{\\ell}d = 0\n$$\n$$\n-(1-d)E\\varepsilon^2 + \\frac{G_c}{\\ell}d = 0\n$$\n求解作为应变 $\\varepsilon$ 函数的平衡相场值 $d$：\n$$\nd\\left(E\\varepsilon^2 + \\frac{G_c}{\\ell}\\right) = E\\varepsilon^2 \\quad \\implies \\quad d(\\varepsilon) = \\frac{E\\varepsilon^2}{E\\varepsilon^2 + G_c/\\ell}\n$$\n退化材料中的名义应力 $\\sigma$ 由弹性应变能密度对应变的导数乘以退化函数给出：\n$$\n\\sigma = \\frac{\\partial (g(d)\\psi_e)}{\\partial \\varepsilon} = g(d) \\frac{\\partial \\psi_e}{\\partial \\varepsilon} = (1-d)^2 E \\varepsilon\n$$\n将 $d(\\varepsilon)$ 的平衡表达式代入应力关系式，需要首先计算 $(1-d)$：\n$$\n1 - d(\\varepsilon) = 1 - \\frac{E\\varepsilon^2}{E\\varepsilon^2 + G_c/\\ell} = \\frac{E\\varepsilon^2 + G_c/\\ell - E\\varepsilon^2}{E\\varepsilon^2 + G_c/\\ell} = \\frac{G_c/\\ell}{E\\varepsilon^2 + G_c/\\ell}\n$$\n现在，我们得到应力作为应变的显式函数：\n$$\n\\sigma(\\varepsilon) = \\left(\\frac{G_c/\\ell}{E\\varepsilon^2 + G_c/\\ell}\\right)^2 E\\varepsilon = \\frac{(G_c/\\ell)^2 E \\varepsilon}{(E\\varepsilon^2 + G_c/\\ell)^2}\n$$\n临界应力 $\\sigma_c$ 是 $\\sigma(\\varepsilon)$ 的最大值，对应于材料软化的开始。我们通过将 $\\sigma(\\varepsilon)$ 对应变 $\\varepsilon$ 的导数设为零来找到这个峰值：\n$$\n\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = (G_c/\\ell)^2 E \\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon} \\left[ \\frac{\\varepsilon}{(E\\varepsilon^2 + G_c/\\ell)^2} \\right] = 0\n$$\n应用微分的商法则：\n$$\n1 \\cdot (E\\varepsilon^2 + G_c/\\ell)^2 - \\varepsilon \\cdot 2(E\\varepsilon^2 + G_c/\\ell)(2E\\varepsilon) = 0\n$$\n假设 $\\varepsilon \\neq 0$，我们可以除以 $(E\\varepsilon^2 + G_c/\\ell)$：\n$$\n(E\\varepsilon^2 + G_c/\\ell) - 4E\\varepsilon^2 = 0\n$$\n$$\nG_c/\\ell - 3E\\varepsilon^2 = 0\n$$\n这给出了应力达到最大值时的临界应变 $\\varepsilon_c$：\n$$\n\\varepsilon_c^2 = \\frac{G_c}{3E\\ell} \\quad \\implies \\quad \\varepsilon_c = \\sqrt{\\frac{G_c}{3E\\ell}}\n$$\n将 $\\varepsilon_c$ 代回到 $\\sigma(\\varepsilon)$ 的表达式中，得到临界应力 $\\sigma_c$：\n$$\n\\sigma_c = \\sigma(\\varepsilon_c) = \\frac{(G_c/\\ell)^2 E \\varepsilon_c}{(E\\varepsilon_c^2 + G_c/\\ell)^2} = \\frac{(G_c/\\ell)^2 E \\sqrt{G_c/(3E\\ell)}}{(E(G_c/(3E\\ell)) + G_c/\\ell)^2}\n$$\n分母简化为：\n$$\n\\left(\\frac{G_c}{3\\ell} + \\frac{G_c}{\\ell}\\right)^2 = \\left(\\frac{4G_c}{3\\ell}\\right)^2 = \\frac{16}{9}\\left(\\frac{G_c}{\\ell}\\right)^2\n$$\n因此，临界应力为：\n$$\n\\sigma_c = \\frac{(G_c/\\ell)^2 E \\sqrt{G_c/(3E\\ell)}}{\\frac{16}{9}(G_c/\\ell)^2} = \\frac{9}{16} E \\sqrt{\\frac{G_c}{3E\\ell}} = \\frac{9}{16} \\sqrt{E^2 \\frac{G_c}{3E\\ell}} = \\frac{9}{16} \\sqrt{\\frac{EG_c}{3\\ell}}\n$$\n这可以写成：\n$$\n\\sigma_c = \\frac{3\\sqrt{3}}{16}\\sqrt{\\frac{EG_c}{\\ell}}\n$$\n这个结果显示了 $\\sigma_c$ 与 $E$、$G_c$ 和 $\\ell$ 的标度关系，符合要求。\n\n**第2部分：孤立裂纹剖面与宽度**\n\n对于无限域中零载荷下的孤立裂纹，弹性应变能项为零（$\\psi_e=0$）。总能量完全由断裂正则化项贡献。我们必须最小化：\n$$\n\\mathcal{E}[d] = \\int_{-\\infty}^{\\infty} G_c \\gamma_\\ell(d,d') \\mathrm{d}x = \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d^2}{2\\ell} + \\frac{\\ell (d')^2}{2} \\right) \\mathrm{d}x\n$$\n最小化函数 $d(x)$ 对应的欧拉-拉格朗日方程为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial \\mathcal{L}}{\\partial d'}\\right) = 0 \\quad \\text{其中 } \\mathcal{L} = G_c \\left( \\frac{d^2}{2\\ell} + \\frac{\\ell (d')^2}{2} \\right)\n$$\n$$\nG_c\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}(G_c\\ell d') = 0 \\quad \\implies \\quad \\frac{d}{\\ell} - \\ell d'' = 0\n$$\n$$\nd''(x) - \\frac{1}{\\ell^2}d(x) = 0\n$$\n这是一个标准的齐次二阶线性常微分方程。其通解为 $d(x) = C_1 e^{x/\\ell} + C_2 e^{-x/\\ell}$。我们应用边界条件：$d(0)=1$ 和 $\\lim_{|x|\\to\\infty}d(x)=0$。\n- 为了使解在 $x \\to \\infty$ 时衰减，必须有 $C_1=0$。因此，对于 $x \\ge 0$，有 $d(x) = C_2 e^{-x/\\ell}$。\n- 为了使解在 $x \\to -\\infty$ 时衰减，必须有 $C_2=0$。因此，对于 $x \\le 0$，有 $d(x) = C_1 e^{x/\\ell}$。\n结合这些并施加连续性和对称性（$d(x)=d(-x)$），解的形式为 $d(x) = C e^{-|x|/\\ell}$。应用中心处的条件，$d(0)=1$：\n$$\nC e^{-|0|/\\ell} = C = 1 \\implies d(x) = e^{-|x|/\\ell}\n$$\n半峰全宽 $w$ 是 $d(x) = \\frac{1}{2}$ 的两点之间的距离。令 $x_h  0$ 为满足此条件的点：\n$$\nd(x_h) = e^{-x_h/\\ell} = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-\\frac{x_h}{\\ell} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) \\quad \\implies \\quad x_h = \\ell\\ln(2)\n$$\n根据对称性，另一个点在 $-x_h$ 处。全宽 $w$ 是这些点之间的距离：\n$$\nw = x_h - (-x_h) = 2x_h = 2\\ell\\ln(2)\n$$\n\n**第3部分：$G_c$ 和 $\\ell$ 的校准公式**\n\n我们已经推导出两个关键关系，将模型参数（$\\ell, G_c$）与可测量量（$w, \\sigma_c, E$）联系起来：\n1.  $\\sigma_c = \\frac{3\\sqrt{3}}{16}\\sqrt{\\frac{EG_c}{\\ell}}$\n2.  $w = 2\\ell\\ln(2)$\n\n我们现在对这些方程进行代数操作，以 $E$、$\\sigma_c$ 和 $w$ 来表示 $\\ell$ 和 $G_c$。\n从方程 (2)，我们可以直接解出长度尺度 $\\ell$：\n$$\n\\ell = \\frac{w}{2\\ln(2)}\n$$\n接下来，我们重新整理方程 (1) 以求解 $G_c$：\n$$\n\\sqrt{\\frac{EG_c}{\\ell}} = \\frac{16\\sigma_c}{3\\sqrt{3}}\n$$\n两边平方得到：\n$$\n\\frac{EG_c}{\\ell} = \\left(\\frac{16\\sigma_c}{3\\sqrt{3}}\\right)^2 = \\frac{256\\sigma_c^2}{27}\n$$\n$$\nG_c = \\frac{256\\sigma_c^2 \\ell}{27E}\n$$\n最后，我们将第一个校准公式中 $\\ell$ 的表达式代入这个 $G_c$ 的方程中以消去 $\\ell$：\n$$\nG_c = \\frac{256\\sigma_c^2}{27E} \\left(\\frac{w}{2\\ln(2)}\\right) = \\frac{128\\sigma_c^2 w}{27E\\ln(2)}\n$$\n最终的校准公式为：\n$$\n\\ell = \\frac{w}{2\\ln(2)} \\quad \\text{和} \\quad G_c = \\frac{128\\sigma_c^2 w}{27E\\ln(2)}\n$$\n这些公式允许从实验测量值直接计算相场模型参数。\n\n**第4部分：实现**\n程序需要为提供的测试用例实现推导出的校准公式。这是第3部分结果的直接应用。代码将按照规定在最终答案块中提供。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the phase-field parameters Gc and l based on macroscopic\n    material properties E, sigma_c, and w for the AT2 model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (E, sigma_c, w) in SI units.\n    test_cases = [\n        (7.0e10, 3.0e8, 6.0e-4),    # Test 1\n        (2.10e11, 1.0e9, 2.0e-4),   # Test 2\n        (3.0e9, 6.0e7, 3.0e-3),     # Test 3\n        (5.0e10, 2.0e8, 1.0e-6),    # Test 4\n    ]\n\n    results = []\n    \n    # Pre-calculate the natural logarithm of 2 for efficiency.\n    ln2 = np.log(2)\n\n    for E, sigma_c, w in test_cases:\n        # Based on the derived calibration formulas:\n        # l = w / (2 * ln(2))\n        # Gc = (128 * sigma_c^2 * w) / (27 * E * ln(2))\n\n        # Calculate the internal length scale, l (in meters).\n        ell = w / (2 * ln2)\n\n        # Calculate the critical energy release rate, Gc (in J/m^2).\n        # numerator = 128 * sigma_c**2 * w\n        # denominator = 27 * E * ln2\n        # Gc = numerator / denominator\n        \n        # Alternatively, using the derived relation involving ell:\n        # Gc = (256 * sigma_c**2 / (27 * E)) * ell\n        # This form is also valid but reuses a calculated value. Let's use the\n        # primary formula derived in the solution.\n        Gc = (128 * sigma_c**2 * w) / (27 * E * ln2)\n\n        # Append the formatted results to the list.\n        # The format specifier \".6g\" ensures 6 significant figures.\n        results.append(f\"{Gc:.6g}\")\n        results.append(f\"{ell:.6g}\")\n\n    # Final print statement in the exact required format:\n    # [Gc_1, l_1, Gc_2, l_2, ...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2587016"}, {"introduction": "在掌握了基本本构关系和参数标定之后，我们将挑战更复杂的二维混合模式断裂问题。本练习要求你编写一个程序，计算在平面应变和拉压异性条件下，材料点的总能量密度。这不仅能检验你对能量分解、谱分解等核心概念的理解，也是对你将复杂物理模型转化为可执行代码能力的综合考验。[@problem_id:2586994]", "problem": "构建一个程序，用于在小应变、平面应变线弹性条件下，使用拉压谱分解，计算一个材料点处的相场混合模式脆性断裂能量密度。其基础是弹性应变能密度和裂纹表面密度泛函。从各向同性线弹性的基本弹性能、小应变张量的谱分解以及相场的标准二次退化函数开始。\n\n从以下基本陈述开始：\n- 无穷小应变张量为 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$，其中 $\\boldsymbol{u}$ 是位移场。\n- 对于各向同性线弹性（平面应变），未损伤应变能密度为 $\\psi_{0}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$，其中 Lamé 参数 $\\lambda$ 和 $\\mu$ 与杨氏模量 $E$ 和泊松比 $\\nu$ 的关系为 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n- 设 $\\boldsymbol{\\varepsilon}$ 的谱分解为 $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{2}\\varepsilon_{i}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i}$，其中 $\\varepsilon_{i}$ 为主应变，$\\boldsymbol{n}_{i}$ 为平面内的标准正交特征向量。定义正应变张量和负应变张量如下\n$$\n\\boldsymbol{\\varepsilon}_{+} = \\sum_{i=1}^{2}\\langle \\varepsilon_{i}\\rangle_{+}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\\qquad \n\\boldsymbol{\\varepsilon}_{-} = \\sum_{i=1}^{2}\\langle \\varepsilon_{i}\\rangle_{-}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\n$$\n其中 $\\langle x\\rangle_{+} = \\max(x,0)$ 且 $\\langle x\\rangle_{-} = \\min(x,0)$。\n- 未损伤能量的拉压分解由下式给出\n$$\n\\psi_{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+},\\qquad\n\\psi_{-}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}.\n$$\n这实现了一种压缩分解，可以防止压缩状态驱动损伤演化，同时保留其弹性能量。\n- 设退化函数为 $g(d) = (1-d)^{2} + \\kappa$，其中 $\\kappa0$ 为一个小的残余刚度。每单位体积的裂纹表面密度项为\n$$\n\\gamma(d,\\nabla d) = \\frac{G_{c}}{2\\ell}d^{2} + \\frac{G_{c}\\ell}{2}\\,|\\nabla d|^{2},\n$$\n其中 $G_{c}$ 是临界能量释放率，$\\ell$ 是内禀长度尺度。\n- 采用压缩分解的总混合模式断裂能量密度为\n$$\nW(\\boldsymbol{\\varepsilon},d,\\nabla d) = g(d)\\,\\psi_{+}(\\boldsymbol{\\varepsilon}) + \\psi_{-}(\\boldsymbol{\\varepsilon}) + \\gamma(d,\\nabla d).\n$$\n\n你的任务是实现一个程序，对于一组给定的材料参数以及 $\\boldsymbol{\\varepsilon}$、$d$ 和 $\\nabla d$ 的多个测试用例，计算在某一点的 $W(\\boldsymbol{\\varepsilon},d,\\nabla d)$。计算必须：\n- 使用 $\\boldsymbol{\\varepsilon}$ 的谱分解来构建 $\\boldsymbol{\\varepsilon}_{+}$ 和 $\\boldsymbol{\\varepsilon}_{-}$。\n- 使用压缩分解，使得只有 $\\psi_{+}$ 被 $g(d)$ 退化。\n- 使用一致的平面应变表达式，用 $E$ 和 $\\nu$ 表示 $\\lambda$ 和 $\\mu$。\n\n所有输入均采用国际单位制 (SI)：\n- 杨氏模量 $E$ 的单位为帕斯卡 ($\\mathrm{Pa}$)。\n- 泊松比 $\\nu$ 无量纲。\n- 临界能量释放率 $G_{c}$ 的单位为焦耳/平方米 ($\\mathrm{J}/\\mathrm{m}^{2}$)。\n- 长度尺度 $\\ell$ 的单位为米 ($\\mathrm{m}$)。\n- 应变张量分量是无量纲的。\n- 相场 $d$ 是无量纲的。\n- 相场梯度分量的单位为 1/米 ($\\mathrm{m}^{-1}$)。\n- 输出的能量密度 $W$ 必须以焦耳/立方米 ($\\mathrm{J}/\\mathrm{m}^{3}$) 为单位报告。\n\n测试套件和所需数值：\n- 所有案例的通用材料参数：$E = 2.10\\times 10^{11}\\ \\mathrm{Pa}$，$\\nu = 0.30$，$G_{c} = 2.70\\times 10^{3}\\ \\mathrm{J}/\\mathrm{m}^{2}$，$\\ell = 1.0\\times 10^{-3}\\ \\mathrm{m}$，$\\kappa = 1.0\\times 10^{-6}$。\n- 案例 1（单轴拉伸，通过分解进行混合模式检查）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.0\\times 10^{-3}  0 \\\\ 0  0 \\end{bmatrix}$，\n  - $d = 4.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 1.0\\times 10^{2} \\\\ -5.0\\times 10^{1} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 案例 2（纯剪切，II 型模式）：\n  - 设 $\\gamma = 2.0\\times 10^{-3}$，$\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0  \\gamma/2 \\\\ \\gamma/2  0 \\end{bmatrix}$，\n  - $d = 2.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 案例 3（均匀压缩，压缩分解）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} -8.0\\times 10^{-4}  0 \\\\ 0  -8.0\\times 10^{-4} \\end{bmatrix}$，\n  - $d = 9.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 2.0\\times 10^{2} \\\\ 2.0\\times 10^{2} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 案例 4（零应变，仅含梯度的裂纹表面项）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$，\n  - $d = 5.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 1.0\\times 10^{1} \\\\ -1.0\\times 10^{1} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 案例 5（双轴混合拉伸-压缩）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.5\\times 10^{-3}  0 \\\\ 0  -5.0\\times 10^{-4} \\end{bmatrix}$，\n  - $d = 1.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 0 \\\\ 1.0\\times 10^{2} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n\n你的程序必须为上述每个案例计算 $W$，并生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $[w_{1},w_{2},w_{3},w_{4},w_{5}]$，其中每个 $w_{i}$ 是案例 $i$ 的 $W$，单位是 $\\mathrm{J}/\\mathrm{m}^{3}$，打印为小数点后保留六位的小数浮点数（例如，$123.456789$ 应打印为 $123.456789$，$1.0\\times 10^{3}$ 应打印为 $1000.000000$）。不应打印任何额外文本。程序不得读取任何输入，并且必须能按原样执行。", "solution": "该问题要求在平面应变线弹性条件下，计算一个材料点处的总相场断裂能量密度，记为 $W(\\boldsymbol{\\varepsilon},d,\\nabla d)$。该模型引入了弹性应变能的拉压分解，以确保只有拉伸状态才会导致材料退化。任务是在给定一组材料参数和状态变量的情况下，针对五个不同的测试案例评估该能量密度。\n\n首先，我们根据所提供的定义建立理论框架。总能量密度 $W$ 由三部分组成：退化的拉伸弹性能、未退化的压缩弹性能和裂纹表面能。控制方程为：\n$$\nW(\\boldsymbol{\\varepsilon},d,\\nabla d) = g(d)\\,\\psi_{+}(\\boldsymbol{\\varepsilon}) + \\psi_{-}(\\boldsymbol{\\varepsilon}) + \\gamma(d,\\nabla d)\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是无穷小应变张量，$d$ 是表示损伤的相场变量（$d=0$ 表示完好材料，$d=1$ 表示完全断裂的材料），$\\nabla d$ 是其梯度。\n\n总能量的各组成部分定义如下：\n1.  **应变能分解**：应变能被加法分解为拉伸部分 $\\psi_{+}(\\boldsymbol{\\varepsilon})$ 和压缩部分 $\\psi_{-}(\\boldsymbol{\\varepsilon})$。这种分解基于应变张量 $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{2}\\varepsilon_{i}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i}$ 的谱分解，其中 $\\varepsilon_{i}$ 是主应变。\n    拉伸和压缩能量部分为：\n    $$\n    \\psi_{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}\n    $$\n    $$\n    \\psi_{-}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}\n    $$\n    此处，$\\langle x\\rangle_{+} = \\max(x,0)$ 且 $\\langle x\\rangle_{-} = \\min(x,0)$。项 $\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}$ 和 $\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}$ 分别根据主应变计算为 $\\sum_{i=1}^{2}(\\langle \\varepsilon_{i}\\rangle_{+})^{2}$ 和 $\\sum_{i=1}^{2}(\\langle \\varepsilon_{i}\\rangle_{-})^{2}$。Lamé 参数 $\\lambda$ 和 $\\mu$ 针对平面应变，用杨氏模量 $E$ 和泊松比 $\\nu$ 表示：\n    $$\n    \\mu = \\frac{E}{2(1+\\nu)}, \\qquad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n    $$\n2.  **退化函数**：能量的拉伸部分被函数 $g(d)$ 退化：\n    $$\n    g(d) = (1-d)^{2} + \\kappa\n    $$\n    其中 $\\kappa$ 是一个小参数，用以确保问题在完全退化（$d=1$）时的适定性。\n\n3.  **裂纹表面密度**：与裂纹表面形成相关的能量使用相场及其梯度进行正则化：\n    $$\n    \\gamma(d,\\nabla d) = \\frac{G_{c}}{2\\ell}d^{2} + \\frac{G_{c}\\ell}{2}\\,|\\nabla d|^{2}\n    $$\n    其中 $G_{c}$ 是材料的临界能量释放率，$\\ell$ 是一个长度尺度参数，它控制着正则化裂纹的宽度。\n\n每个测试用例的计算过程如下：\n\n1.  根据给定的材料属性 $E = 2.10\\times 10^{11}\\,\\mathrm{Pa}$ 和 $\\nu = 0.30$ 计算 Lamé 参数 $\\lambda$ 和 $\\mu$。\n    $$\n    \\mu = \\frac{2.10\\times 10^{11}}{2(1+0.30)} = \\frac{2.10\\times 10^{11}}{2.6} \\approx 8.076923 \\times 10^{10}\\,\\mathrm{Pa}\n    $$\n    $$\n    \\lambda = \\frac{(2.10\\times 10^{11})(0.30)}{(1+0.30)(1-2 \\times 0.30)} = \\frac{0.63\\times 10^{11}}{1.3 \\times 0.4} = \\frac{0.63\\times 10^{11}}{0.52} \\approx 1.211538 \\times 10^{11}\\,\\mathrm{Pa}\n    $$\n2.  对于给定的应变张量 $\\boldsymbol{\\varepsilon}$，通过求 $\\boldsymbol{\\varepsilon}$ 的矩阵表示的特征值来计算其主应变 $\\varepsilon_1, \\varepsilon_2$。\n3.  计算主应变和迹的正负部分：$\\langle \\varepsilon_{i}\\rangle_{+}$、$\\langle \\varepsilon_{i}\\rangle_{-}$、$\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}$ 和 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}$。\n4.  计算能量分量 $\\psi_{+}(\\boldsymbol{\\varepsilon})$ 和 $\\psi_{-}(\\boldsymbol{\\varepsilon})$。\n5.  使用给定的 $d$ 值和 $\\kappa = 1.0\\times 10^{-6}$ 计算退化函数 $g(d)$。\n6.  使用给定的 $d$、$\\nabla d$、$G_{c} = 2.70\\times 10^{3}\\,\\mathrm{J}/\\mathrm{m}^{2}$ 和 $\\ell = 1.0\\times 10^{-3}\\,\\mathrm{m}$ 计算裂纹表面密度 $\\gamma(d,\\nabla d)$。\n7.  最后，使用主公式组合成总能量密度 $W$。\n\n我们现在将此过程应用于每个测试案例。\n\n**案例 1**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.0\\times 10^{-3}  0 \\\\ 0  0 \\end{bmatrix}$，$d = 0.4$，$\\nabla d = [100, -50]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 1.0\\times 10^{-3}$，$\\varepsilon_2 = 0$。\n- 应变部分：$\\langle \\varepsilon_1 \\rangle_+ = 1.0\\times 10^{-3}$，$\\langle \\varepsilon_2 \\rangle_+ = 0$。$\\langle \\varepsilon_1 \\rangle_- = 0$，$\\langle \\varepsilon_2 \\rangle_- = 0$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = 1.0\\times 10^{-3}$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_+ = 1.0\\times 10^{-3}$ 且 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = 0$。\n- 能量分量：\n  $\\psi_+ = \\frac{1}{2}\\lambda(10^{-3})^2 + \\mu(10^{-3})^2 = (\\frac{\\lambda}{2} + \\mu) \\times 10^{-6} \\approx 141346.15\\,\\mathrm{J}/\\mathrm{m}^3$。\n  $\\psi_- = 0$。\n- 退化：$g(0.4) = (1-0.4)^2 + 10^{-6} = 0.360001$。\n- 裂纹能量：$|\\nabla d|^2 = 100^2 + (-50)^2 = 12500$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.4)^2 + \\frac{2700 \\times 10^{-3}}{2}(12500) = 216000 + 16875 = 232875\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_1 = (0.360001) \\times 141346.15... + 0 + 232875 \\approx 50884.76 + 232875 \\approx 283759.76\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**案例 2**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0  1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  0 \\end{bmatrix}$，$d = 0.2$，$\\nabla d = [0, 0]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 1.0\\times 10^{-3}$，$\\varepsilon_2 = -1.0\\times 10^{-3}$。\n- 应变部分：$\\langle \\varepsilon_1 \\rangle_+ = 1.0\\times 10^{-3}$，$\\langle \\varepsilon_2 \\rangle_+ = 0$。$\\langle \\varepsilon_1 \\rangle_- = 0$，$\\langle \\varepsilon_2 \\rangle_- = -1.0\\times 10^{-3}$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = 0$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_+ = 0$ 且 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = 0$。\n- 能量分量：\n  $\\psi_+ = \\mu(10^{-3})^2 \\approx 80769.23\\,\\mathrm{J}/\\mathrm{m}^3$。\n  $\\psi_- = \\mu(-10^{-3})^2 \\approx 80769.23\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 退化：$g(0.2) = (1-0.2)^2 + 10^{-6} = 0.640001$。\n- 裂纹能量：$|\\nabla d|^2 = 0$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.2)^2 + 0 = 54000\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_2 = (0.640001) \\times 80769.23... + 80769.23... + 54000 \\approx 51692.39 + 80769.23 + 54000 \\approx 186461.62\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**案例 3**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} -8.0\\times 10^{-4}  0 \\\\ 0  -8.0\\times 10^{-4} \\end{bmatrix}$，$d = 0.9$，$\\nabla d = [200, 200]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = -8.0\\times 10^{-4}$，$\\varepsilon_2 = -8.0\\times 10^{-4}$。\n- 应变部分：所有正部分均为零。$\\langle \\varepsilon_1 \\rangle_- = -8.0\\times 10^{-4}$，$\\langle \\varepsilon_2 \\rangle_- = -8.0\\times 10^{-4}$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = -1.6\\times 10^{-3}$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = -1.6\\times 10^{-3}$。\n- 能量分量：\n  $\\psi_+ = 0$。\n  $\\psi_- = \\frac{1}{2}\\lambda(-1.6\\times 10^{-3})^2 + \\mu(2 \\times (-8.0\\times 10^{-4})^2) = 1.28(\\lambda+\\mu)\\times 10^{-6} \\approx 258461.54\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 退化：$g(0.9) = (1-0.9)^2 + 10^{-6} = 0.010001$。\n- 裂纹能量：$|\\nabla d|^2 = 200^2 + 200^2 = 80000$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.9)^2 + \\frac{2700 \\times 10^{-3}}{2}(80000) = 1093500 + 108000 = 1201500\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_3 = 0 + 258461.54... + 1201500 \\approx 1459961.54\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**案例 4**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$，$d = 0.5$，$\\nabla d = [10, -10]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 0$, $\\varepsilon_2 = 0$。\n- 应变部分：所有与应变相关的项均为零。\n- 能量分量：$\\psi_+ = 0$, $\\psi_- = 0$。\n- 退化：$g(0.5) = (1-0.5)^2 + 10^{-6} = 0.250001$。\n- 裂纹能量：$|\\nabla d|^2 = 10^2 + (-10)^2 = 200$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.5)^2 + \\frac{2700 \\times 10^{-3}}{2}(200) = 337500 + 270 = 337770\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_4 = 0 + 0 + 337770 = 337770.00\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**案例 5**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.5\\times 10^{-3}  0 \\\\ 0  -5.0\\times 10^{-4} \\end{bmatrix}$，$d = 0.1$，$\\nabla d = [0, 100]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 1.5\\times 10^{-3}$，$\\varepsilon_2 = -5.0\\times 10^{-4}$。\n- 应变部分：$\\langle \\varepsilon_1 \\rangle_+ = 1.5\\times 10^{-3}$，$\\langle \\varepsilon_2 \\rangle_+ = 0$。$\\langle \\varepsilon_1 \\rangle_- = 0$，$\\langle \\varepsilon_2 \\rangle_- = -5.0\\times 10^{-4}$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = 1.0\\times 10^{-3}$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_+ = 1.0\\times 10^{-3}$ 且 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = 0$。\n- 能量分量：\n  $\\psi_+ = \\frac{1}{2}\\lambda(10^{-3})^2 + \\mu(1.5\\times 10^{-3})^2 = (0.5\\lambda + 2.25\\mu)\\times 10^{-6} \\approx 242307.69\\,\\mathrm{J}/\\mathrm{m}^3$。\n  $\\psi_- = \\mu(-5.0\\times 10^{-4})^2 = 0.25\\mu\\times 10^{-6} \\approx 20192.31\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 退化：$g(0.1) = (1-0.1)^2 + 10^{-6} = 0.810001$。\n- 裂纹能量：$|\\nabla d|^2 = 0^2 + 100^2 = 10000$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.1)^2 + \\frac{2700 \\times 10^{-3}}{2}(10000) = 13500 + 13500 = 27000\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_5 = (0.810001) \\times 242307.69... + 20192.31... + 27000 \\approx 196270.00 + 20192.31 + 27000 \\approx 243462.31\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n五个案例计算出的能量密度总结如下：\n$W_1 \\approx 283759.756795\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_2 \\approx 186461.619231\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_3 \\approx 1459961.538462\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_4 = 337770.000000\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_5 \\approx 243462.307692\\,\\mathrm{J}/\\mathrm{m}^3$\n实现将基于这些计算进行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the phase-field mixed-mode brittle fracture energy density\n    for a set of test cases.\n    \"\"\"\n    # Common material parameters (SI units)\n    E = 2.10e11  # Young's modulus (Pa)\n    nu = 0.30    # Poisson's ratio\n    Gc = 2.70e3  # Critical energy release rate (J/m^2)\n    l = 1.0e-3   # Length scale (m)\n    kappa = 1.0e-6 # Residual stiffness parameter\n\n    # Define the test cases\n    test_cases = [\n        # Case 1: Uniaxial tension, mixed-mode check via split\n        {\n            \"eps\": np.array([[1.0e-3, 0.0], [0.0, 0.0]]),\n            \"d\": 4.0e-1,\n            \"grad_d\": np.array([1.0e2, -5.0e1])\n        },\n        # Case 2: Pure shear, Mode II\n        {\n            \"eps\": np.array([[0.0, 1.0e-3], [1.0e-3, 0.0]]), # gamma = 2e-3, eps_xy = gamma/2\n            \"d\": 2.0e-1,\n            \"grad_d\": np.array([0.0, 0.0])\n        },\n        # Case 3: Uniform compression, compression split\n        {\n            \"eps\": np.array([[-8.0e-4, 0.0], [0.0, -8.0e-4]]),\n            \"d\": 9.0e-1,\n            \"grad_d\": np.array([2.0e2, 2.0e2])\n        },\n        # Case 4: Zero strain, gradient-only crack surface term\n        {\n            \"eps\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n            \"d\": 5.0e-1,\n            \"grad_d\": np.array([1.0e1, -1.0e1])\n        },\n        # Case 5: Biaxial mixed tension-compression\n        {\n            \"eps\": np.array([[1.5e-3, 0.0], [0.0, -5.0e-4]]),\n            \"d\": 1.0e-1,\n            \"grad_d\": np.array([0.0, 1.0e2])\n        }\n    ]\n\n    # Calculate Lamé parameters for plane strain\n    mu = E / (2 * (1 + nu))\n    lambda_ = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n    results = []\n    for case in test_cases:\n        eps = case[\"eps\"]\n        d = case[\"d\"]\n        grad_d = case[\"grad_d\"]\n\n        # 1. Spectral decomposition of the strain tensor\n        # For a 2x2 symmetric matrix, eigenvalues are the principal strains\n        principal_strains = np.linalg.eigvalsh(eps)\n\n        # 2. Compute positive and negative parts\n        tr_eps = np.sum(principal_strains)\n        tr_eps_plus = max(tr_eps, 0)\n        tr_eps_minus = min(tr_eps, 0)\n\n        eps_plus_vals = np.maximum(principal_strains, 0)\n        eps_minus_vals = np.minimum(principal_strains, 0)\n        \n        # The term eps_p:eps_p is sum(eps_p_i^2)\n        eps_plus_dot_eps_plus = np.sum(eps_plus_vals**2)\n        # The term eps_m:eps_m is sum(eps_m_i^2)\n        eps_minus_dot_eps_minus = np.sum(eps_minus_vals**2)\n        \n        # 3. Calculate tensile and compressive strain energy densities\n        psi_plus = 0.5 * lambda_ * tr_eps_plus**2 + mu * eps_plus_dot_eps_plus\n        psi_minus = 0.5 * lambda_ * tr_eps_minus**2 + mu * eps_minus_dot_eps_minus\n\n        # 4. Calculate degradation function\n        g_d = (1 - d)**2 + kappa\n\n        # 5. Calculate crack surface density\n        grad_d_norm_sq = np.sum(grad_d**2)\n        gamma = (Gc / (2 * l)) * d**2 + (Gc * l / 2) * grad_d_norm_sq\n\n        # 6. Assemble total energy density\n        W = g_d * psi_plus + psi_minus + gamma\n        results.append(W)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```", "id": "2586994"}]}