## 引言
标准有限元方法（FEM）在处理光滑、连续的物理问题时表现出色，但当面对包含裂纹、[材料界面](@entry_id:751731)或[奇异点](@entry_id:199525)的复杂情况时，其基于多项式近似的本质便会遇到瓶颈。为了精确捕捉这些局部剧烈变化，传统方法往往需要极度精细且与特征几何对齐的网格，这在计算上代价高昂且缺乏灵活性。[单位分解](@entry_id:150115)富集概念的出现，为解决这一长期挑战提供了革命性的思路，它允许在不改变背景[网格拓扑](@entry_id:167986)的情况下，将解的复杂局部行为“植入”到标准的[有限元近似](@entry_id:166278)空间中。

本文旨在系统性地介绍单位分解富集方法的核心思想、应用与实践。读者将通过三个章节的学习，全面掌握这一先进数值技术。在“原理与机制”一章中，我们将深入其数学根基，从单位分解属性和补片检验出发，阐明富集空间的构建原则与稳定性保障机制。接下来，在“应用与交叉学科联系”一章，我们将展示该方法如何在[断裂力学](@entry_id:141480)、多物理场界面问题和多尺度建模等前沿领域大放异彩。最后，“动手实践”一章将提供一系列精心设计的练习，帮助您将理论知识转化为实践能力。

通过本次学习，您将不仅理解[扩展有限元法](@entry_id:162867)（XFEM）等先进技术背后的“为什么”，更能掌握其“如何做”。让我们首先从其最根本的原理与机制开始探索。

## 原理与机制

在上一章中，我们介绍了在处理不连续、[奇异点](@entry_id:199525)等复杂物理现象时，标准有限元方法所面临的挑战。本章将深入探讨一种强大的解决方案——基于单位分解（Partition of Unity, PU）的富集方法。我们将从其核心数学原理出发，系统性地阐述富集空间的构建、稳定性和一致性保障机制，以及其在断裂力学和界面问题中的经典应用。通过本章的学习，读者将理解该方法如何通过在标准多项式近似中“植入”问题的局部解信息，从而以极高的效率和精度捕捉复杂行为。

### 单位分解属性：一致性的基石

单位分解（Partition of Unity, PU）属性是所有现代富集方法（包括广义有限元法GFEM和[扩展有限元法](@entry_id:162867)XFEM）的理论基石。对于一个定义在区域 $\Omega$ 上的[有限元网格](@entry_id:174862)，其节点形函数族 $\{N_a(x)\}_{a=1}^{n}$ 若满足[单位分解](@entry_id:150115)属性，则意味着在区域内（几乎）任意一点 $x$，所有形函数的值之和恒为1：
$$
\sum_{a=1}^{n} N_a(x) = 1 \quad \forall x \in \Omega
$$
在标准的[拉格朗日形函数](@entry_id:635448)中，每个函数 $N_a$ 的支集（即函数值非零的区域）通常被限制在以节点 $a$ 为中心的单元片（patch）上。

这一属性看似简单，却直接保证了[近似方案](@entry_id:267451)最基本的一致性要求：**常数场的精确再现** [@problem_id:2586332]。考虑一个常数函数 $u(x) = c$。其标准有限元插值 $u_h(x)$ 为：
$$
u_h(x) = \sum_{a=1}^{n} u(x_a) N_a(x) = \sum_{a=1}^{n} c \cdot N_a(x) = c \sum_{a=1}^{n} N_a(x)
$$
为了使近似解 $u_h(x)$ 精确地等于原解 $u(x) = c$，必须满足 $\sum_{a=1}^{n} N_a(x) = 1$。这种再现常数（或线性）场的能力是[有限元法](@entry_id:749389)[收敛的必要条件](@entry_id:157681)，通过了所谓的 **$p$ 阶补片检验（Patch Test）** 的最低阶测试（$p=0$ 阶） [@problem_id:2586340]。

更广泛地说，$p$ 阶补片检验是在一个单元补片 $\omega \subset \Omega$ 上进行的局部诊断，用以评估方法的多项式一致性。检验过程如下：任取一个次数不高于 $p$ 的多项式 $q \in \mathbb{P}_p(\omega)$，并以此构造一个边值问题，使其精确解就是 $q$。具体而言，源项设为 $f = -\nabla \cdot (a \nabla q)$，边界条件设为 $g=q|_{\partial \omega}$。如果离散方法在该补片上求解得到的解 $u_h$ 与 $q$ 完全相等（$u_h \equiv q$），则称该方法通过了 $p$ 阶补片检验。

对于富集方法而言，通过补片检验至关重要。因为富集项（通常为非多项式）与标准多项式形函数的乘积可能会破坏原有的多项式再现能力。如果一个方法连简单的多项式场都无法正确模拟，就意味着其存在一个不随网格加密而消失的系统性偏差（[一致性误差](@entry_id:747725)），从而无法保证对任意光滑解的收敛性 [@problem_id:2586340]。因此，确保富集后的空间仍然能够精确再现多项式场，是设计任何有效富集方法的首要任务。

### 广义框架：[单位分解法](@entry_id:170899) (PUM)

[单位分解](@entry_id:150115)属性不仅是检验一致性的工具，其本身也提供了一种构建近似空间的通用框架，即**[单位分解法](@entry_id:170899)（Partition of Unity Method, PUM）**。其核心思想是将全局近似 $u_h$ 表示为一系列局部近似 $u_i$ 通过[单位分解](@entry_id:150115)函数 $\phi_i$ 进行“粘合”的结果：
$$
u_h = \sum_{i} \phi_i u_i
$$
这里，$\{\phi_i\}$ 是一族满足单位分解性质的权函数，而每个 $u_i$ 是一个定义在局部区域 $\omega_i$（通常是 $\phi_i$ 的支集）上的、能够反映问题局部特征的近似函数。

为了保证该方法对于[二阶椭圆问题](@entry_id:754613)的[适定性](@entry_id:148590)（$H^1$-协调性）和稳定性，PUM的构建需要满足一系列严格的数学条件 [@problem_id:2586336]。首先，需要一个定义在 $\Omega$ 上的**开覆盖** $\{\omega_i\}_{i \in I}$，它必须是**局部有限**的，并且具有**一致有界重叠度**，即存在一个与网格无关的整数 $M$，使得域内任意点 $x$ 最多属于 $M$ 个开集 $\omega_i$。其次，需要一族**从属于**该覆盖的单位分解函数 $\{\phi_i\}_{i \in I}$，满足：
1.  **从属关系**: $\text{supp}(\phi_i) \subset \omega_i$
2.  **[单位分解](@entry_id:150115)**: $\sum_{i \in I} \phi_i(x) = 1$
3.  **正则性**: $\phi_i \in W^{1,\infty}(\Omega)$，即函数本身及其一阶[弱导数](@entry_id:189356)都有界。
4.  **尺度一致的梯度界**: 存在一个与网格尺寸无关的常数 $C$，使得 $\|\nabla \phi_i\|_{L^{\infty}(\omega_i)} \le C \cdot h_i^{-1}$，其中 $h_i = \text{diam}(\omega_i)$。

这些条件确保了通过乘积法则 $\nabla u_h = \sum_i (\nabla \phi_i u_i + \phi_i \nabla u_i)$ 得到的梯度是平方可积的，从而保证了全局近似的 $H^1$-协调性。同时，有界重叠度和梯度界是保证数值方法稳定性和获得最优[收敛率](@entry_id:146534)的关键。

在GFEM/XFEM的实践中，上述抽象框架被具体化。[单位分解](@entry_id:150115)函数 $\phi_i$ 就是标准的有限元形函数 $N_i$，覆盖 $\omega_i$ 就是形函数的支集（单元片）。局部近似空间 $V_i = \text{span}\{\psi_{i,\alpha}\}_{\alpha=1}^{m_i}$ 则由一组**富集函数** $\psi_{i,\alpha}$ 张成。全局富集空间 $\mathcal{W}$ 定义为：
$$
\mathcal{W} := \sum_{i=1}^{n} N_i V_i = \text{span}\{ N_i \psi_{i,\alpha} \}
$$
为了确保整个富集空间 $\mathcal{W}$ 属于 $H^1(\Omega)$，对富集函数 $\psi_{i,\alpha}$ 的正则性有基本要求。根据[索博列夫空间](@entry_id:141995)的乘法定理，一个充分条件是，每个局部富集函数本身也必须是 $H^1$ 的，即 $\psi_{i,\alpha} \in H^1(\omega_i)$ [@problem_id:2586313]。如果富集函数自身存在跳跃（不属于 $H^1$），那么与非零的形函数相乘后，其[不连续性](@entry_id:144108)依然存在，从而破坏全局的 $C^0$ 连续性和 $H^1$ 协调性。

### 关键机制：移位富集与[线性无关](@entry_id:148207)性

在构建富集空间时，一个核心的挑战是避免新引入的富集[基函数](@entry_id:170178)与原有的标准[基函数](@entry_id:170178)产生**[线性相关](@entry_id:185830)**。如果使用朴素的“非移位”富集，即富集[基函数](@entry_id:170178)形如 $N_a(x)\psi(x)$，当富集函数 $\psi(x)$ 恰好是标准有限元空间 $V_h$ 能够精确再现的函数（例如，当 $p \ge 1$ 时，$\psi(x)$ 是一个常数或线性函数），问题就出现了。此时，函数 $\psi(x)$ 不仅可以由标准[基函数](@entry_id:170178)[线性表示](@entry_id:139970)，也可以由富集[基函数](@entry_id:170178)[线性表示](@entry_id:139970)：
$$
\psi(x) = \sum_a \psi(x_a) N_a(x) = \psi(x) \sum_a N_a(x) = \sum_a (N_a(x)\psi(x))
$$
这表明标准[基函数](@entry_id:170178)与富集[基函数](@entry_id:170178)的集合 $\{N_a\} \cup \{N_a \psi\}$ 是[线性相关](@entry_id:185830)的，会导致最终的[刚度矩阵](@entry_id:178659)奇异或严重病态 [@problem_id:2586367]。

为解决此问题，一种被称为**移位富集（shifted enrichment）** 的关键技术被引入。其思想是，将富集[基函数](@entry_id:170178)修正为：
$$
\chi_a(x) = N_a(x) \left( \psi(x) - \psi(x_a) \right)
$$
这种形式的巧妙之处在于，它能同时保证两点重要性质：

1.  **保持节点插值特性**：由于[拉格朗日形函数](@entry_id:635448)具有克罗内克（Kronecker-delta）性质 $N_a(x_b) = \delta_{ab}$，移位后的富集[基函数](@entry_id:170178) $\chi_a(x)$ 在所有节点（包括其自身的节点 $x_a$）处的值均为零：$\chi_a(x_b) = \delta_{ab}(\psi(x_b) - \psi(x_a)) = 0$。这意味着富集项不会“污染”标准节点自由度的物理意义。在富集近似 $u_h(x) = \sum_a N_a u_a + \sum_b \chi_b a_b$ 中，$u_h(x_a) = u_a$ 仍然成立，标准自由度 $u_a$ 依然代表着解在节点 $a$ 处的（连续部分）值 [@problem_id:2586363]。

2.  **解耦标准与富集空间**：考虑所有[移位](@entry_id:145848)富集[基函数](@entry_id:170178)的和，利用单位分解性质，我们得到：
    $$
    \sum_a N_a(x) (\psi(x) - \psi(x_a)) = \psi(x) \sum_a N_a(x) - \sum_a N_a(x)\psi(x_a) = \psi(x) - I_h\psi(x)
    $$
    其中 $I_h\psi$ 是 $\psi$ 的标准有限元插值。这个结果表明，如果 $\psi$ 本身就可以被标准有限元空间精确插值（即 $\psi = I_h\psi$），那么所有移位富集[基函数](@entry_id:170178)的特定线性组合将恒等于零。这从根本上消除了标准空间与富集空间之间的[线性相关](@entry_id:185830)性，极大地改善了刚度[矩阵的[条件](@entry_id:150947)数](@entry_id:145150) [@problem_id:2586367]。

### 应用一：模拟强不连续性

XFEM最成功的应用之一是模拟材料内部的强[不连续性](@entry_id:144108)，如裂纹和界面。这类问题中，[位移场](@entry_id:141476)在[不连续面](@entry_id:180188)上发生跳跃。

为在有限元框架中描述这种跳跃，我们首先需要一种描述[不连续面](@entry_id:180188)几何的方法。**[水平集方法](@entry_id:165633)（Level Set Method）** 提供了一种优雅的[隐式表示](@entry_id:195378)。一个光滑的水平集函数 $\phi(x)$ 被用来定义界面 $\Gamma$，使得 $\Gamma = \{ x \in \Omega : \phi(x) = 0 \}$。区域 $\Omega$ 被 $\Gamma$ 分为两部分：$\Omega^+ = \{x : \phi(x) > 0\}$ 和 $\Omega^- = \{x : \phi(x)  0\}$。

接下来，我们选择一个能够代表跳跃的富集函数。**亥维赛德函数（Heaviside function）** 是理想的选择，它在界面两侧取不同的常数值。例如，我们可以定义：
$$
H(\phi(x)) = \begin{cases} +1,  \phi(x) > 0 \\ -1,  \phi(x)  0 \end{cases}
$$
结合移位富集的思想，用于模拟强不连续性的完整XFEM近似形式为：
$$
u_h(x) = \underbrace{\sum_{a \in \mathcal{N}} N_a(x) u_a}_{\text{标准部分}} + \underbrace{\sum_{b \in \mathcal{N}_\Gamma} N_b(x) \left( H(\phi(x)) - H(\phi(x_b)) \right) a_b}_{\text{富集部分}}
$$
其中，$\mathcal{N}$ 是所有节点的集合，而 $\mathcal{N}_\Gamma$ 是**被富集的节点集**。一个节点 $b$ 需要被富集，当且仅当它的形函数支集 $\text{supp}(N_b)$ 被[不连续面](@entry_id:180188) $\Gamma$ 切割，即 $\text{supp}(N_b) \cap \Gamma \neq \emptyset$ [@problem_id:2586337]。如果一个节点的支集完全位于 $\Gamma$ 的一侧，那么在其支集内 $H(\phi(x))$ 是常数，[移位](@entry_id:145848)富集项恒为零，无需添加。

**示例：一个被切割的单元** [@problem_id:2586337]

让我们通过一个具体的例子来理解上述公式。考虑一个位于单位正方形 $[0,1]^2$ 内的[双线性](@entry_id:146819)[四边形单元](@entry_id:176937)，其节点为 $x_1=(0,0), x_2=(1,0), x_3=(1,1), x_4=(0,1)$。不连续界面由[水平集](@entry_id:751248)函数 $\phi(x,y) = y - x + 0.1$ 定义。

1.  **确定富集节点**: 界面 $\Gamma$ 的方程为 $y=x-0.1$。该线段从 $(0.1, 0)$ 到 $(1, 0.9)$，贯穿了整个单元。由于该单元内所有四个节点的形函数支集都是这个单元本身，所以界面切割了所有四个节点的支集。因此，富集节点集为 $\mathcal{N}_\Gamma = \{1, 2, 3, 4\}$。

2.  **计算某点的近似值**: 我们希望计算点 $x^* = (0.75, 0.20)$ 处的近似位移 $u_h(x^*)$。
    *   **形函数值**:
        $N_1(x^*) = (1-0.75)(1-0.20) = 0.20$
        $N_2(x^*) = 0.75(1-0.20) = 0.60$
        $N_3(x^*) = 0.75 \times 0.20 = 0.15$
        $N_4(x^*) = (1-0.75) \times 0.20 = 0.05$
    *   **亥维赛德函数值**:
        $H(\phi(x^*))$: $\phi(0.75, 0.20) = 0.2 - 0.75 + 0.1 = -0.45  0 \implies H(\phi(x^*)) = -1$
        $H(\phi(x_1))$: $\phi(0,0) = 0.1 > 0 \implies H(\phi(x_1)) = +1$
        $H(\phi(x_2))$: $\phi(1,0) = -0.9  0 \implies H(\phi(x_2)) = -1$
        $H(\phi(x_3))$: $\phi(1,1) = 0.1 > 0 \implies H(\phi(x_3)) = +1$
        $H(\phi(x_4))$: $\phi(0,1) = 1.1 > 0 \implies H(\phi(x_4)) = +1$
    *   **组装**: 将上述值代入富集近似公式：
        $u_h(x^*) = \sum_{a=1}^4 N_a(x^*) u_a + \sum_{b=1}^4 N_b(x^*) (H(\phi(x^*)) - H(\phi(x_b))) a_b$
        $u_h(x^*) = (0.2 u_1 + 0.6 u_2 + 0.15 u_3 + 0.05 u_4) + N_1(x^*)(-1 - 1)a_1 + N_2(x^*)(-1 - (-1))a_2 + N_3(x^*)(-1 - 1)a_3 + N_4(x^*)(-1 - 1)a_4$
        $u_h(x^*) = 0.2 u_1 + 0.6 u_2 + 0.15 u_3 + 0.05 u_4 - 0.4 a_1 - 0.3 a_3 - 0.1 a_4$

这个例子清晰地展示了如何将抽象的富集公式应用于具体的单元和界面，并计算出任意点的位移如何依赖于标准节点自由度 $u_a$ 和富集自由度 $a_b$。

### 应用二：模拟奇异性

另一类标准有限元难以处理的问题是场变量的奇异性，例如线弹性断裂力学中裂纹尖端的[应力奇异性](@entry_id:166362)。在[裂纹尖端](@entry_id:182807)附近，[位移场](@entry_id:141476)呈现特定的非多项式形式，而应[力场](@entry_id:147325)则趋于无穷。

对于二维线弹性体中的直裂纹，Williams的[渐近分析](@entry_id:160416)表明，裂尖附近的[位移场](@entry_id:141476)可以展开为以裂尖为原点的极坐标 $(r, \theta)$ 下 $r$ 的半整数次幂级数。[位移场](@entry_id:141476)的领先项具有 $r^{1/2}$ 的形式，而应[力场](@entry_id:147325)则具有 $r^{-1/2}$ 的奇异性。标准多项式形函数无法有效捕捉这种根式行为。

XFEM通过直接将这些渐近解的[基函数](@entry_id:170178)作为富集函数 $\psi$ 来解决此问题。对于一个位于原点的裂纹尖端，其裂纹面位于 $\theta = \pm \pi$，用于富集位移场的**前四个标准裂尖富集函数**是 [@problem_id:2586318]：
$$
\{ \sqrt{r}\cos(\theta/2), \quad \sqrt{r}\sin(\theta/2), \quad \sqrt{r}\cos(\theta/2)\sin\theta, \quad \sqrt{r}\sin(\theta/2)\sin\theta \}
$$
这组函数张成了I型（张开型）和II型（滑移型）裂纹的[近场](@entry_id:269780)位移解空间。将这些函数引入到PU框架中，使得有限元解在裂尖附近自然地具备了正确的奇异性，从而可以用较粗的网格获得极高精度的[应力强度因子](@entry_id:183032)。

### 实施中的关键机制

理论框架的成功实施依赖于两个关键的实际操作机制：保证协调性和正确的[数值积分](@entry_id:136578)。

#### 跨单元协调性

在标准有限元中，$C^0$ 连续性是自然保证的，因为相邻单元共享节点和形函数。但在富集方法中，如果富集区域处理不当，很容易在单元边界上引入人为的“伪不连续”，从而破坏[全局解](@entry_id:180992)的协调性。为保持富集空间的全局 $C^0$ 连续性，必须确保在任何不与物理[不连续面](@entry_id:180188)重合的单元公共边界 $\Gamma$ 上，从相邻单元 $K_1$ 和 $K_2$ 得到的迹（trace）是相同的 [@problem_id:2586309]。以下两种策略可确保这一点：

1.  **全节点支集激活**: 这是最简单直接的方法。一旦一个节点 $j$ 被确定为富集节点，其对应的富集[基函数](@entry_id:170178) $N_j(x) (\Psi(x)-\Psi(x_j))$ 就在 $N_j$ 的整个支集上被“激活”。由于相邻单元共享节点 $j$，它们也必然共享相同的富集[基函数](@entry_id:170178)，因此在公共边界上的迹自然吻合。

2.  **过渡函数（Blending Functions）**: 在某些情况下，我们可能希望将富集的影响限制在节点支集的一个子区域内，以避免过度富集。此时，简单地在某些单元中“关闭”富集会破坏协调性。正确的做法是引入一个连续的过渡函数 $R(x)$，它在富集区域内部为1，在富集区域的边界上平滑地过渡到0。富集[基函数](@entry_id:170178)变为 $N_j(x)R(x)(\Psi(x)-\Psi(x_j))$。由于 $R(x)$ 在富集区域边界（包括与非富集单元的公共边界）上为零，富集项的贡献在此处消失，从而保证了与邻近非富集单元的迹相匹配，维持了全局 $C^0$ 连续性。

#### [数值积分](@entry_id:136578)

富集方法带来的另一个巨大挑战是[数值积分](@entry_id:136578)。在包含亥维赛德富集的单元中，被积函数（例如，来自[刚度矩阵](@entry_id:178659)的项 $\nabla(N_i H) \cdot \nabla(N_j H)$）不再是光滑的多项式，而是在[不连续面](@entry_id:180188) $\Gamma$ 上存在跳跃的**分片多项式**。

标准的**高斯积分**是为光滑多项式设计的，其高精度依赖于被积函数的高阶[可微性](@entry_id:140863)。当直接将[高斯积分](@entry_id:187139)应用于被切割单元时，其基本假设被违反 [@problem_id:2586316]。其后果是：

*   **丧失精度和一致性**: 积分结果不再精确。由于[高斯积分](@entry_id:187139)点的位置是固定的，它们相对于[不连续面](@entry_id:180188)的位置具有任意性。积分点可能完全落在界面的一侧，导致对另一侧信息的完全忽略，产生系统性的、不随积分点数增加而轻易消除的偏差。这破坏了[单元刚度矩阵](@entry_id:139369)的一致性。
*   **矩阵病态**: 如果某个富集自由度相关的[基函数](@entry_id:170178)在所有[高斯积分](@entry_id:187139)点上都恰好为零或接近于零，那么该自由度对刚度矩阵的贡献将是零或极小，可能导致全局矩阵奇[异或](@entry_id:172120)严重病态。

正确的解决方案是采用**子单元积分（Sub-element Integration）** [@problem_id:2586316]。其核心思想是，用[不连续面](@entry_id:180188) $\Gamma$ 将被切割的单元（例如，四边形）细分为多个子单元（例如，三角形或多边形）。在每个子单元内部，水平集函数 $\phi(x)$ 的符号是确定的，因此亥维赛德函数 $H(\phi(x))$ 是一个常数。这样，原始的分片多项式被积函数在每个子单元上都变回了标准的多项式。此时，再在每个子单元上分别应用标准的[高斯积分](@entry_id:187139)，就可以恢复其原有的高精度和可靠性。最后将所有子单元的积分结果相加，即可得到整个单元上准确的积分值。这一过程确保了数值积分与物理[不连续性](@entry_id:144108)相协调，是XFEM成功实施的必备环节。