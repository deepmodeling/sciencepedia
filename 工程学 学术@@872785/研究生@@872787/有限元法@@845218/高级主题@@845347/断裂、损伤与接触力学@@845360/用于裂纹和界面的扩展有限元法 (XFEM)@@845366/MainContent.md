## 引言
在[计算力学](@entry_id:174464)领域，精确模拟包含裂纹、[相界](@entry_id:172947)或[材料界面](@entry_id:751731)等不连续性的物理现象，始终是一项极具挑战性的任务。传统的[有限元法](@entry_id:749389)（FEM）要求网格线与这些不连续性的几何边界完全对齐，这一限制使得在处理移动或演化的[不连续性](@entry_id:144108)（如裂纹扩展）时，必须进行复杂且计算成本高昂的网格重构，从而严重制约了其应用效率和范围。为了突破这一瓶颈，[扩展有限元法](@entry_id:162867)（Extended Finite Element Method, XFEM）应运而生，它为在固定网格上模拟任意不连续性提供了一个强大而优雅的框架。

本文旨在全面而系统地介绍[扩展有限元法](@entry_id:162867)，引领读者从基本原理走向前沿应用。我们将通过三个循序渐进的章节，构建一个完整的知识体系：

第一章 **原理与机制**，将深入剖析XFEM的理论核心。我们将从[单位分解法](@entry_id:170899)（Partition of Unity Method）出发，详细阐述如何通过引入特殊的“增强函数”来丰富标准有限元逼近空间，使其能够精确地表示强[不连续性](@entry_id:144108)（如裂纹引起的位移跳跃）和弱不连续性（如[材料界面](@entry_id:751731)引起的应变扭折）。同时，我们也将讨论数值积分、[条件数](@entry_id:145150)稳定化等关键的实现细节。

第二章 **应用与[交叉](@entry_id:147634)学科联系**，将展示XFEM在解决实际问题中的强大威力。我们将超越基础理论，探讨其在高等断裂力学分析（如黏聚区模型和[动态断裂](@entry_id:190194)）、多[材料界面](@entry_id:751731)力学、多物理场耦合问题以及结构拓扑优化等领域的广泛应用，揭示XFEM如何连接理论与工程实践。

最后，**动手实践**部分将提供一系列精心设计的问题，旨在帮助读者将理论知识转化为实践技能，通过具体的计算和验证任务，加深对XFEM核心概念的理解。

通过本文的学习，读者将能够深刻理解XFEM的精髓，并掌握其在模拟复杂不连续性问题中的应用方法，为从事相关的科学研究和工程分析奠定坚实的基础。

## 原理与机制

[扩展有限元法 (XFEM)](@entry_id:174957) 的核心在于它能够通过增强标准有限元法的逼近空间，精确地表示解场中的不连续和奇异等局部特征，而无需使网格与这些特征的几何形状完全对齐。这是通过一种称为**[单位分解法](@entry_id:170899) (Partition of Unity Method, PUM)** 的通用框架实现的。本章将深入探讨 XFEM 的基本原理，阐述其如何对裂纹和界面等不同类型的间断进行建模，并讨论实现一个稳健的 XFEM 所需的关键机制。

### [单位分解法](@entry_id:170899)的思想

标准有限元法 (FEM) 的[位移场](@entry_id:141476)逼近 $\mathbf{u}_h(\mathbf{x})$ 是由与节点 $i$ 关联的自由度 $\mathbf{u}_i$ 和形函数 $N_i(\mathbf{x})$ [线性组合](@entry_id:154743)而成：

$$
\mathbf{u}_h(\mathbf{x}) = \sum_{i \in \mathcal{I}} N_i(\mathbf{x}) \mathbf{u}_i
$$

其中 $\mathcal{I}$ 是全局节点集。这些形函数 $N_i$ 构成了一个**[单位分解](@entry_id:150115)**，即在整个求解域 $\Omega$ 内，所有形函数之和恒为1：

$$
\sum_{i \in \mathcal{I}} N_i(\mathbf{x}) = 1, \quad \forall \mathbf{x} \in \Omega
$$

这个性质保证了有限元逼近能够精确地重现[刚体运动](@entry_id:193355)和常应变状态。

XFEM 的核心思想是利用[单位分解](@entry_id:150115)的特性来局部地“丰富”或“增强”逼近空间。这是通过将已知的局部解的特征（由**增强函数** $\Psi(\mathbf{x})$ 描述）乘上标准的有限元形函数 $N_j(\mathbf{x})$ 来实现的。对于需要增强的节点[子集](@entry_id:261956) $\mathcal{J} \subset \mathcal{I}$，其逼近形式扩展为：

$$
\mathbf{u}_h(\mathbf{x}) = \underbrace{\sum_{i \in \mathcal{I}} N_i(\mathbf{x}) \mathbf{u}_i}_{\text{标准部分}} + \underbrace{\sum_{j \in \mathcal{J}} N_j(\mathbf{x}) \Psi(\mathbf{x}) \mathbf{a}_j}_{\text{增强部分}}
$$

其中 $\mathbf{a}_j$ 是与增强相关的附加自由度。由于增强项 $N_j(\mathbf{x}) \Psi(\mathbf{x})$ 的支集被限制在标准形函数 $N_j$ 的支集内，这种增强是严格局部的。更重要的是，由于 $N_j$ 在单元边界上是连续的 ($C^0$ 连续)，因此整个逼近 $\mathbf{u}_h$ 的连续性由标准形函数控制。如果增强函数 $\Psi$ 本身是不连续的，那么[位移场](@entry_id:141476)的不连续性将精确地发生在 $\Psi$ 不连续的地方，而不会破坏单元间的协调性。这使得 XFEM 能够在不重构网格的情况下，对穿过单元内部的裂纹等[不连续性](@entry_id:144108)进行建模 [@problem_id:2574821]。

### 强[不连续性建模](@entry_id:165486)：裂纹

裂纹是典型的**强[不连续性](@entry_id:144108)**，其特征是裂纹面两侧的[位移场](@entry_id:141476)存在跳跃。在 XFEM 中，我们通过引入两种不同类型的增强来分别处理裂纹体和裂纹尖端。

#### 裂纹体的位移跳跃建模

为了模拟裂纹面 $\Gamma_c$ 上的位移跳跃，我们需要一个跨越 $\Gamma_c$ 时不连续的增强函数。最自然的选择是**亥维赛德函数 (Heaviside function)**。通常，裂纹的几何形状由一个**符号距离[水平集](@entry_id:751248)函数** $\phi(\mathbf{x})$ [隐式表示](@entry_id:195378)，其中 $\Gamma_c = \{\mathbf{x} \in \Omega : \phi(\mathbf{x}) = 0\}$。$\phi(\mathbf{x})$ 在裂纹的一侧为正，另一侧为负。

我们可以定义亥维赛德增强函数为：

$$
H(\phi(\mathbf{x})) = \begin{cases} +1,  \phi(\mathbf{x}) > 0 \\ -1,  \phi(\mathbf{x})  0 \end{cases}
$$

这个函数在裂纹面 $\Gamma_c$ 上有一个大小为 2 的跳跃。当它被用于增强逼近时，位移场的跳跃 $\llbracket \mathbf{u}_h \rrbracket$ 为：

$$
\llbracket \mathbf{u}_h(\mathbf{x}) \rrbracket = 2 \sum_{j \in \mathcal{J}} N_j(\mathbf{x}) \mathbf{a}_j, \quad \mathbf{x} \in \Gamma_c
$$

这里的节点集 $\mathcal{J}$ 包含了所有其形函数支集被裂纹内部穿过的节点。这个选择准则是至关重要的：如果一个节点的支集完全位于裂纹的一侧，那么 $H(\phi(\mathbf{x}))$ 在其支集内为常数，增强项 $N_j H(\phi)$ 将与标准形函数 $N_j$ 线性相关，这会引入数值不稳定（病态）并且不增加任何新的逼近能力。因此，只有那些支集被“切开”的节点才需要被亥维赛德函数增强 [@problem_id:2557291]。

#### 裂纹尖端的奇异性建模

在[线性弹性断裂力学 (LEFM)](@entry_id:186451) 中，[裂纹尖端](@entry_id:182807)附近的应[力场](@entry_id:147325)是奇异的，通常表现为与到尖端距离 $r$ 的平方根成反比，即 $\sigma \sim r^{-1/2}$。这导致[位移场](@entry_id:141476)具有 $u \sim r^{1/2}$ 的形式。这种 $r^{1/2}$ 行为意味着位移的导数是奇异的，因此解不属于高阶索博列夫空间 $H^2(\Omega)$，尽管它仍然属于 $H^1(\Omega)$ [@problem_id:2557353]。

亥维赛德函数无法捕捉这种奇异性。为了[精确模拟](@entry_id:749142)尖端场，我们需要引入一组不同的增强函数，即所谓的**分支函数 (branch functions)**，它们能够张成尖端附近[位移场](@entry_id:141476)的渐近[解空间](@entry_id:200470)。对于二维平面应变问题中的 I 型（张开型）和 II 型（滑移型）混合模式裂纹，[位移场](@entry_id:141476)的[渐近展开](@entry_id:173196)（威廉姆斯展开）表明，其主要部分可以由四个线形无关的函数跨越。一个标准的、物理上直观的分支函数集是 [@problem_id:2557328]：

$$
\{ \sqrt{r}\sin(\frac{\theta}{2}), \sqrt{r}\cos(\frac{\theta}{2}), \sqrt{r}\sin(\frac{\theta}{2})\sin\theta, \sqrt{r}\cos(\frac{\theta}{2})\sin\theta \}
$$

其中 $(r, \theta)$ 是以[裂纹尖端](@entry_id:182807)为原点的局部极[坐标系](@entry_id:156346)。

在实际操作中，我们会定义一个围绕[裂纹尖端](@entry_id:182807)的“尖端增强区域”。位于该区域内的节点将被这组分支函数增强。为了避免与亥维赛德增强过度耦合和[线性相关](@entry_id:185830)，这些尖端节点通常不再同时用亥维赛德函数增强 [@problem_id:2574821]。通过将奇异场的解析形式直接内建到逼近空间中，XFEM 能够以极高的精度计算[应力强度因子](@entry_id:183032)等断裂参数。

### 弱[不连续性建模](@entry_id:165486)：[材料界面](@entry_id:751731)

与裂纹不同，[材料界面](@entry_id:751731)是一种**弱[不连续性](@entry_id:144108)**。在理想界面处，[位移场](@entry_id:141476)是连续的（$\llbracket \mathbf{u} \rrbracket = \mathbf{0}$），但由于材料属性的突变，位移的梯度（即应变和应力）可能是不连续的（$\llbracket \nabla\mathbf{u} \rrbracket \neq \mathbf{0}$）。

显然，亥维赛德函数不适用于此种情况，因为它会引入一个非物理的位移跳跃。我们需要一个本身连续（$C^0$），但其梯度不连续的增强函数。一个典型的选择是基于[符号距离函数](@entry_id:754834) $\phi(\mathbf{x})$ 的[绝对值函数](@entry_id:160606) $|\phi(\mathbf{x})|$。这个函数在界面 $\phi(\mathbf{x})=0$ 处是连续的，但其梯度 $\nabla|\phi(\mathbf{x})| = \text{sgn}(\phi(\mathbf{x}))\nabla\phi(\mathbf{x})$ 在跨越界面时会因为[符号函数](@entry_id:167507) $\text{sgn}(\phi(\mathbf{x}))$ 的跳跃而不连续。

为了保持标准自由度 $\mathbf{u}_i$ 作为节点位移的物理意义（即满足克罗内克-德尔[塔性质](@entry_id:273153)），通常使用一种“平移”的增强形式：

$$
\mathbf{u}_h(\mathbf{x}) = \sum_{i \in \mathcal{I}} N_i(\mathbf{x}) \mathbf{u}_i + \sum_{j \in \mathcal{J}_{\Gamma}} N_j(\mathbf{x}) \Big( |\phi(\mathbf{x})| - |\phi(\mathbf{x}_j)| \Big) \mathbf{a}_j
$$

其中 $\mathcal{J}_{\Gamma}$ 是其支集被界面穿过的节点集。平移项 $-|\phi(\mathbf{x}_j)|$ 确保了在任意节点 $\mathbf{x}_k$ 处，增强项 $N_j(\mathbf{x}_k)(|\phi(\mathbf{x}_k)| - |\phi(\mathbf{x}_j)|)$ 均为零，从而 $\mathbf{u}_h(\mathbf{x}_k) = \mathbf{u}_k$。这种形式的增强正确地引入了应变的[不连续性](@entry_id:144108)，同时保持了位移的连续性 [@problem_id:2557288]。另一种有效的增强方式是所谓的“脊函数 (ridge function)”，它通过对 $| \phi |$ 和 $\phi$ 的有限元插值进行组合来构造，同样可以实现弱不连续性。

### 变分框架与实现细节

#### 函数空间与[弱形式](@entry_id:142897)

从数学角度看，一个包含内部[不连续面](@entry_id:180188) $\Gamma_c$ 的体的位移场不再属于标准的索博列夫空间 $H^1(\Omega)$，因为 $H^1$ 函数在整个域上是连续的。正确的[函数空间](@entry_id:143478)是所谓的**破碎索博列夫空间 (broken Sobolev space)**，记为 $H^1(\Omega \setminus \Gamma_c)$。这个空间由在[子域](@entry_id:155812) $\Omega^+$ 和 $\Omega^-$ 上分别为 $H^1$ 函数的函数组成，但在跨越 $\Gamma_c$ 时允许不连续。

尽管解空间被“破碎”，但对于施加在外部边界 $\partial\Omega$ 上的狄利克雷（本质）边界条件，我们仍然可以像标准有限元一样强加。这是因为[迹定理](@entry_id:203967)保证了从 $H^1(\Omega^\pm)$ 到其边界 $\partial\Omega^\pm$ 的[迹算子](@entry_id:183665)是连续的。由于外边界 $\partial\Omega$ 是子域边界的一部分，因此在 $\partial\Omega$ 上的迹是良定义的，可以直接在试探和检验函数空间的定义中施加约束 [@problem_id:2557359]。

#### 几何表示

在 XFEM 中，裂纹和界面的几何信息需要被传递到有限元模型中。**[水平集方法](@entry_id:165633)**是一种强大而灵活的工具。对于一个二维裂纹，通常需要两个[水平集](@entry_id:751248)函数来完整描述其几何：

1.  **$\phi(\mathbf{x})$**：一个[符号距离函数](@entry_id:754834)，其零等值线表示裂纹面本身，即 $\Gamma_c = \{\mathbf{x} : \phi(\mathbf{x}) = 0\}$。
2.  **$\psi(\mathbf{x})$**：另一个[水平集](@entry_id:751248)函数，其零等值线表示一条穿过裂纹尖端的曲线，且在尖端处与裂纹**正交**。

通过这对函数，[裂纹尖端](@entry_id:182807)可以被唯一确定为 $\{\mathbf{x} : \phi(\mathbf{x})=0, \psi(\mathbf{x})=0\}$。在尖端附近，$(\phi, \psi)$ 的梯度近似正交，构成一个局部[正交坐标](@entry_id:166074)系，这对于定义分支函数所需的极坐标 $(r,\theta)$ 非常方便。在计算中，这些[水平集](@entry_id:751248)函数的值通常在网格节点上定义，然后在单元内部通过标准形函数进行插值。为了保持插值后[水平集](@entry_id:751248)函数的距离特性（即 $|\nabla\phi|=1$），可能需要周期性地通过求解 Eikonal 方程进行**重新初始化** [@problem_id:2557346]。

#### [数值积分](@entry_id:136578)

XFEM 的一个关键挑战是[数值积分](@entry_id:136578)。当一个单元被[不连续面](@entry_id:180188)（如裂纹）切割时，其[刚度矩阵](@entry_id:178659)的被积函数将包含亥维赛德函数，从而在单元内部是不连续的。例如，标准自由度与增强自由度之间的耦合刚度项的被积函数形式为 $P(\mathbf{x})H(\phi(\mathbf{x}))$，其中 $P(\mathbf{x})$ 是一个光滑的多项式。

标准的**[高斯积分](@entry_id:187139)**方案是为光滑（通常是多项式）被积函数设计的，直接应用于这种[不连续函数](@entry_id:143848)上会产生严重的误差，并且增加积分点数也无法保证收敛到精确值。正确的做法是将被切割的单元 $\Omega_e$ 沿[不连续面](@entry_id:180188) $\Gamma_c \cap \Omega_e$ 显式地划分为两个或多个子单元（例如，子三角形或子四边形）。在每个子单元内部，被积函数是光滑的，因此可以安全地应用标准高斯积分。这个过程被称为**子单元划分积分** [@problem_id:2557343]。

$$
\int_{\Omega_e} P(\mathbf{x})H(\phi) \,d\Omega = \int_{\Omega_e^+} P(\mathbf{x})(+1) \,d\Omega + \int_{\Omega_e^-} P(\mathbf{x})(-1) \,d\Omega
$$

### 高级主题：收敛性与条件数

#### [收敛率](@entry_id:146534)

XFEM 的一个主要优势是它能够恢复最优的[收敛率](@entry_id:146534)。对于包含奇异性的问题（如裂纹），标准有限元法的收敛性会受到解的低光滑度的限制。例如，对于一个包含 $r^{1/2}$ 奇异性的问题，使用线性单元 ($p=1$) 的标准 FEM 在[能量范数](@entry_id:274966)下的[收敛率](@entry_id:146534)仅为 $\mathcal{O}(h^{1/2})$，远低于光滑问题下的 $\mathcal{O}(h)$。

相比之下，通过引入分支函数，XFEM 将奇异性的解析形式直接构建到逼近空间中。这意味着解的奇异部分可以被精确（或极高精度地）捕捉。误差主要来自于对解的光滑部分的逼近。对于裂纹问题，从解中减去主导奇异项后，余下的部分通常具有更高的光滑度（例如，属于 $H^2(\Omega)$）。因此，分支增强的 XFEM 能够恢复线性单元在光滑问题下的最优[收敛率](@entry_id:146534)，即 $\mathcal{O}(h)$ [@problem_id:2557353]。

#### 混合单元问题

当一个增强区域与未增强区域相邻时，会出现所谓的**混合单元 (blending elements)**。这些单元包含一部分增强节点和一部分标准节点。如果直接使用增强函数，可能会破坏单位分解性质在这些单元中的精确再现能力，导致多项式一致性丧失和[收敛率](@entry_id:146534)下降，这种现象被称为“污染效应” [@problem_id:2574821]。

为了解决这个问题，可以引入一个**[斜坡函数](@entry_id:273156) (ramp function)** $R(\mathbf{x})$ 来修正增强项。这个函数在混合单元内部平滑地从 0 过渡到 1。具体来说，$R(\mathbf{x})$ 在未增强的边界上为 0，在增强的边界上为 1。它可以通过混合单元自身的形函数来构造。例如，在一个从 $x=0$（未增强）到 $x=h$（增强）的单元中，[斜坡函数](@entry_id:273156)可以简单地构造为 $R(\mathbf{x}) = \sum N_i(\mathbf{x}) R_i$，其中节点值 $R_i$ 在 $x=0$ 处为 0，在 $x=h$ 处为 1。对于一个矩形单元，这通常会得到一个简单的线性函数，如 $R(x) = x/h$ [@problem_id:2557286]。修正后的增强项变为 $R(\mathbf{x}) N_j(\mathbf{x}) \Psi(\mathbf{x})$，它在未增强的边界上自然消失，从而保持了多项式一致性。

#### [条件数](@entry_id:145150)问题

当[不连续面](@entry_id:180188)非常靠近单元的边界或顶点时，XFEM 会遇到严重的**病态 (ill-conditioning)** 问题。在这种情况下，一个被切割的子区域面积可能变得非常小（例如，面积为 $\epsilon A$，其中 $\epsilon \ll 1$）。

这导致与增强自由度相关的[基函数](@entry_id:170178)（例如，亥维赛德增强）的能量（即刚度矩阵对角项）变得非常小，其大小与这个小子区域的测度成正比，即 $\mathcal{O}(\epsilon)$。而标准[基函数](@entry_id:170178)的能量仍然是 $\mathcal{O}(1)$。这使得[全局刚度矩阵](@entry_id:138630)的[最小特征值](@entry_id:177333)趋于零，而最大[特征值保持](@entry_id:636565)不变，导致[条件数](@entry_id:145150) $\kappa(\mathbf{K})$ 像 $\mathcal{O}(\epsilon^{-1})$ 一样爆炸式增长 [@problem_id:2557333]。

[病态问题](@entry_id:137067)会导致迭代求解器收敛缓慢甚至失败，并放大[舍入误差](@entry_id:162651)。一个有效的缓解策略是对增强自由度进行**[预处理](@entry_id:141204)**或**缩放**。其思想是通过缩放[基函数](@entry_id:170178)，使其能量范数保持在 $\mathcal{O}(1)$，与切割位置无关。具体来说，可以将增强[基函数](@entry_id:170178) $\psi_i$ 缩放为 $\widehat{\psi}_i = \psi_i / \|\psi_i\|_E$，其中 $\|\cdot\|_E$ 是[能量范数](@entry_id:274966)。在实践中，这等效于将相应的[刚度矩阵](@entry_id:178659)行和列乘以一个缩放因子，或者直接对增强自由度进行缩放。这个缩放因子通常与小区域面积的平方根成反比，即 $1/\sqrt{\epsilon}$。这种方法可以有效地稳定条件数，使其不再依赖于切割位置 [@problem_id:2557333]。