{"hands_on_practices": [{"introduction": "理解应力奇异性的第一步是剖析其理想化的数学模型。本练习将引导您使用经典的分离变量法，从控制方程和边界条件出发，推导出决定奇异行为特征的指数 $\\lambda$。通过这个基础练习 [@problem_id:2602453]，您将深入理解为何奇异性会呈现出特定的幂律形式，为更复杂的分析奠定坚实的数学基础。", "problem": "一个均匀、各向同性、线性弹性体占据一个平面楔形域，该域在极坐标中定义为 $0  r  R$ 和 $0  \\theta  \\omega$，其中 $\\omega \\in (0, 2\\pi]$ 是楔形顶角（角度以弧度为单位）。考虑在楔形域内，无体力情况下的反平面剪切（III型）变形，其面外位移 $u(r,\\theta)$ 由拉普拉斯方程 $\\,\\nabla^{2} u = 0\\,$ 控制。这种反平面剪切设置是用于几何奇异点附近应力计算的典范局部模型，并被广泛用于为扩展有限元法（XFEM）构建局部奇异富集。极坐标中的剪应力分量为 $\\tau_{r z} = \\mu\\,\\partial u/\\partial r$ 和 $\\tau_{\\theta z} = \\mu\\,r^{-1}\\,\\partial u/\\partial \\theta$，其中 $\\mu$ 是剪切模量。\n\n从极坐标中的拉普拉斯算子和应用于楔形域中 $u(r,\\theta)$ 的分离变量法出发，执行以下操作：\n\n- 推导径向部分和角向部分的分离后的常微分方程，并获得当 $r \\to 0^{+}$ 时有界的 $u(r,\\theta)$ 的可分离广义本征函数形式。\n- 在楔形面上施加本质（Dirichlet）边界条件 $u(r,0) = 0$ 和 $u(r,\\omega) = 0$，以确定表征近尖端奇异行为的容许分离常数。简要解释为什么这些边界条件会导致容许指数的离散族。\n\n你的最终答案必须是容许指数 $\\,\\lambda\\,$ 作为整数模态指数 $\\,n \\in \\mathbb{N}\\,$ 和楔形角 $\\,\\omega\\,$ 的函数的单一闭式解析表达式。最终答案中不要包含单位。角度以弧度为单位。如果引入任何近似，请说明理由；然而，此处期望得到一个精确表达式，因此不需要四舍五入。", "solution": "该问题陈述已被验证为具有科学依据、适定且客观。它是线性弹性力学和断裂力学中的一个标准问题。我们开始求解。\n\n在反平面剪切情况下，面外位移 $u(r, \\theta)$ 的控制方程是二维拉普拉斯方程 $\\nabla^2 u = 0$。在极坐标 $(r, \\theta)$ 中，该方程表示为：\n$$ \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 u}{\\partial \\theta^2} = 0 $$\n我们使用分离变量法寻求非平凡解。我们假设位移场具有 $u(r, \\theta) = F(r)G(\\theta)$ 的形式。将此形式代入拉普拉斯方程得到：\n$$ \\frac{1}{r} G(\\theta) \\frac{d}{d r} \\left( r \\frac{dF}{d r} \\right) + \\frac{1}{r^2} F(r) \\frac{d^2 G}{d \\theta^2} = 0 $$\n乘以 $\\frac{r^2}{F(r)G(\\theta)}$ 可实现变量分离：\n$$ \\frac{r}{F(r)} \\frac{d}{d r} \\left( r \\frac{dF}{d r} \\right) = - \\frac{1}{G(\\theta)} \\frac{d^2 G}{d \\theta^2} $$\n左侧仅为 $r$ 的函数，而右侧仅为 $\\theta$ 的函数。为使该等式在域中对所有 $r$ 和 $\\theta$ 成立，两侧必须等于一个常数。我们将此分离常数记为 $k$。\n这导出了两个常微分方程：\n1.  角向部分：$\\frac{d^2 G}{d \\theta^2} + k G(\\theta) = 0$\n2.  径向部分：$r \\frac{d}{d r} \\left( r \\frac{dF}{d r} \\right) - k F(r) = 0$，可展开为 $r^2 \\frac{d^2 F}{d r^2} + r \\frac{dF}{d r} - k F(r) = 0$。\n\n我们首先分析角向方程。边界条件给定为 $u(r, 0) = 0$ 和 $u(r, \\omega) = 0$。对于 $F(r) \\not\\equiv 0$ 的非平凡解，这些条件必须由角向函数 $G(\\theta)$ 满足，因此我们有 $G(0) = 0$ 和 $G(\\omega) = 0$。\n$G''(\\theta) + k G(\\theta) = 0$ 的通解取决于 $k$ 的符号。\n如果 $k = 0$，解为 $G(\\theta) = A \\theta + B$。条件 $G(0) = 0$ 意味着 $B=0$。条件 $G(\\omega) = 0$ 意味着 $A \\omega = 0$，由于 $\\omega > 0$，所以 $A=0$。这得到平凡解 $G(\\theta) = 0$，不是我们所关心的解。\n如果 $k  0$，令 $k = -\\lambda^2$，其中 $\\lambda > 0$。解为 $G(\\theta) = A \\sinh(\\lambda \\theta) + B \\cosh(\\lambda \\theta)$。条件 $G(0) = 0$ 意味着 $B=0$。条件 $G(\\omega) = 0$ 意味着 $A \\sinh(\\lambda \\omega) = 0$。由于 $\\lambda > 0$ 且 $\\omega > 0$，$\\sinh(\\lambda \\omega) \\neq 0$，所以必须有 $A=0$。同样，这导致平凡解。\n如果 $k > 0$，令 $k = \\lambda^2$，其中 $\\lambda > 0$。通解为 $G(\\theta) = A \\sin(\\lambda \\theta) + B \\cos(\\lambda \\theta)$。\n应用边界条件 $G(0) = 0$：\n$G(0) = A \\sin(0) + B \\cos(0) = B = 0$。\n解必须具有 $G(\\theta) = A \\sin(\\lambda \\theta)$ 的形式。\n应用第二个边界条件 $G(\\omega) = 0$：\n$G(\\omega) = A \\sin(\\lambda \\omega) = 0$。\n为得到非平凡解，我们需要 $A \\neq 0$。这要求 $\\sin(\\lambda \\omega) = 0$。当 $\\lambda \\omega$ 是 $\\pi$ 的整数倍时，此条件得到满足。\n$$ \\lambda \\omega = n \\pi, \\quad \\text{for } n \\in \\mathbb{Z} $$\n这给出了参数 $\\lambda$ 的容许值：\n$$ \\lambda_n = \\frac{n \\pi}{\\omega} $$\n由于 $\\lambda$ 被定义为正数，且 $n$ 的负值只会改变本征函数 $\\sin(\\lambda_n \\theta)$ 的符号，这个符号可以被吸收到常数 $A$ 中，因此我们可以将 $n$ 限制为正整数，即 $n \\in \\mathbb{N} = \\{1, 2, 3, \\ldots\\}$。\n在关于 $G(\\theta)$ 的二阶常微分方程上施加两个边界条件，构成了一个 Sturm-Liouville 本征值问题。众所周知，这类问题具有离散的本征值谱，在本例中即为 $k = \\lambda_n^2$ 的值。这正是边界条件导致容许指数离散族的原因。\n\n现在，我们求解 $k = \\lambda_n^2$ 时的径向方程：\n$$ r^2 F_n''(r) + r F_n'(r) - \\lambda_n^2 F_n(r) = 0 $$\n这是一个 Cauchy-Euler 方程。我们寻求 $F_n(r) = r^p$ 形式的解。将此形式代入方程，得到指征方程：\n$$ p(p-1) + p - \\lambda_n^2 = 0 \\implies p^2 - \\lambda_n^2 = 0 \\implies p = \\pm \\lambda_n $$\n因此，径向部分的通解为：\n$$ F_n(r) = C_1 r^{\\lambda_n} + C_2 r^{-\\lambda_n} $$\n问题要求位移场 $u(r, \\theta)$ 在 $r \\to 0^+$ 时是有界的。由于对于 $n \\in \\mathbb{N}$ 和 $\\omega \\in (0, 2\\pi]$，$\\lambda_n = \\frac{n \\pi}{\\omega} > 0$，项 $r^{-\\lambda_n}$ 在 $r \\to 0^+$ 时发散。为确保解的有界性，其系数必须为零，因此我们令 $C_2 = 0$。\n因此，物理上可接受的径向解为 $F_n(r) = C_1 r^{\\lambda_n}$。\n\n结合径向和角向部分，在原点处有界的可分离本征函数形式为：\n$$ u_n(r, \\theta) = A_n r^{\\lambda_n} \\sin(\\lambda_n \\theta) $$\n其中 $A_n$ 是常数，容许指数 $\\lambda_n$ 由推导出的表达式给出。通解是这些本征函数的叠加：\n$$ u(r, \\theta) = \\sum_{n=1}^{\\infty} A_n r^{\\frac{n \\pi}{\\omega}} \\sin\\left(\\frac{n \\pi}{\\omega} \\theta\\right) $$\n问题要求给出容许指数 $\\lambda$ 作为整数模态指数 $n$ 和楔形角 $\\omega$ 的函数的闭式解析表达式。根据我们的推导，该表达式为：\n$$ \\lambda = \\frac{n \\pi}{\\omega} $$\n指数 $\\lambda$ 是无量纲的，因为 $n$ 和 $\\pi$ 是无量纲数，而 $\\omega$ 是以弧度为单位的角度，也是一个无量纲量。", "answer": "$$\\boxed{\\frac{n \\pi}{\\omega}}$$", "id": "2602453"}, {"introduction": "在掌握了基本理论之后，我们将其应用于一个非常实际的工程场景：L 形域的凹角。与上一个练习不同，本题 [@problem_id:2602467] 考虑了无牵引力的边界条件，这在结构分析中更为常见。本练习不仅要求您计算主导奇异指数，还需要您将这个数学值与其物理后果联系起来，即分析它对索伯列夫空间 $H^1$ 正则性的影响，这是理解有限元法收敛性的关键一步。", "problem": "考虑一个在原点处具有单个凹角的二维L形弹性域中的反平面剪切问题。在该角点的一个足够小的邻域内，引入以角点为中心的极坐标 $\\left(r,\\theta\\right)$，使得该域局部上与一个内角为 $\\omega = \\frac{3\\pi}{2}$ 弧度的楔形区域 $\\left\\{(r,\\theta): r>0,\\ 0  \\theta  \\omega\\right\\}$ 重合。假设无体力，并假设两个楔形面 $\\theta=0$ 和 $\\theta=\\omega$ 上无面力。设平面外位移为 $w(r,\\theta)$，它满足反平面剪切的线性弹性力学平衡方程。\n\n1. 从反平面剪切的第一性原理出发，通过寻找分离变量形式 $w_{\\text{sing}}(r,\\theta)=r^{\\lambda} f(\\theta)$ 并施加控制偏微分方程和边界条件，来推导角点附近的局部主阶奇异行为。利用此方法得到确定容许指数 $\\lambda$ 的特征方程，并计算最小的正指数。\n\n2. 使用最小正指数的值，论证应变能密度的局部可积性，并说明其对于 $w$ 在角点邻域内属于索伯列夫空间 $H^{1}$ 的影响。\n\n最终答案只给出主奇异指数 $\\lambda$ 的精确值（无单位，不四舍五入）。任何关于 $H^{1}$ 正则性的讨论都应包含在您的解答中，而不是在最终答案里。", "solution": "在反平面剪切中，位移具有形式 $u_{x}=0$, $u_{y}=0$, $u_{z}=w(x,y)$，唯一非零的柯西应力分量是剪应力 $\\tau_{xz}$ 和 $\\tau_{yz}$。对于剪切模量为 $G$ 的均匀、各向同性、线弹性材料，本构关系给出 $\\tau_{xz}=G\\,\\partial w/\\partial x$ 和 $\\tau_{yz}=G\\,\\partial w/\\partial y$。在无体力的情况下，静力平衡要求 $\\nabla\\cdot\\boldsymbol{\\sigma}=\\boldsymbol{0}$，这可简化为\n$$\n\\frac{\\partial \\tau_{xz}}{\\partial x}+\\frac{\\partial \\tau_{yz}}{\\partial y}=0.\n$$\n代入本构关系并利用 $G$ 是常数这一事实，得到平面外位移的拉普拉斯方程：\n$$\n\\Delta w=0.\n$$\n在极坐标 $\\left(r,\\theta\\right)$ 中，拉普拉斯算子变为\n$$\n\\Delta w=\\frac{\\partial^{2}w}{\\partial r^{2}}+\\frac{1}{r}\\frac{\\partial w}{\\partial r}+\\frac{1}{r^{2}}\\frac{\\partial^{2}w}{\\partial \\theta^{2}}.\n$$\n在楔形面 $\\theta=0$ 和 $\\theta=\\omega$ 上的无面力边界条件意味着那里的法向剪应力为零。对于反平面剪切，在射线 $\\theta=\\text{const}$ 上的无面力条件局部简化为\n$$\n\\frac{\\partial w}{\\partial n}=0\\quad\\Longleftrightarrow\\quad \\frac{1}{r}\\frac{\\partial w}{\\partial \\theta}=0\\quad\\text{on}\\ \\theta=0,\\ \\theta=\\omega.\n$$\n因此，边界条件变为\n$$\n\\frac{\\partial w}{\\partial \\theta}(r,0)=0,\\qquad \\frac{\\partial w}{\\partial \\theta}(r,\\omega)=0,\\qquad r>0.\n$$\n我们寻找一个具有如下形式的主阶奇异项：\n$$\nw_{\\text{sing}}(r,\\theta)=r^{\\lambda}f(\\theta),\\quad \\lambda>0.\n$$\n代入拉普拉斯方程得到\n\\begin{align*}\n\\frac{\\partial w}{\\partial r}=\\lambda r^{\\lambda-1}f(\\theta),\\\\\n\\frac{\\partial^{2}w}{\\partial r^{2}}=\\lambda(\\lambda-1)r^{\\lambda-2}f(\\theta),\\\\\n\\frac{\\partial^{2}w}{\\partial \\theta^{2}}=r^{\\lambda}f''(\\theta).\n\\end{align*}\n因此\n$$\n\\Delta w_{\\text{sing}}=r^{\\lambda-2}\\left[\\lambda(\\lambda-1)f(\\theta)+\\lambda f(\\theta)+f''(\\theta)\\right]=r^{\\lambda-2}\\left[f''(\\theta)+\\lambda^{2}f(\\theta)\\right]=0,\n$$\n所以 $f$ 满足常微分方程\n$$\nf''(\\theta)+\\lambda^{2}f(\\theta)=0.\n$$\n其通解为\n$$\nf(\\theta)=A\\cos(\\lambda \\theta)+B\\sin(\\lambda \\theta).\n$$\n无面力边界条件转化为\n$$\n\\frac{\\partial w_{\\text{sing}}}{\\partial \\theta}(r,\\theta)=r^{\\lambda}f'(\\theta)=0\\quad \\text{at}\\ \\theta=0,\\ \\theta=\\omega.\n$$\n计算 $f'(\\theta)=-A\\lambda \\sin(\\lambda \\theta)+B\\lambda \\cos(\\lambda \\theta)$。施加 $f'(0)=0$ 得到\n$$\nf'(0)=B\\lambda=0\\quad\\Longrightarrow\\quad B=0.\n$$\n那么 $f'(\\omega)=-A\\lambda \\sin(\\lambda \\omega)=0$。对于非平凡的角向形状 $A\\neq 0$，这意味着特征方程为\n$$\n\\sin(\\lambda \\omega)=0\\quad\\Longleftrightarrow\\quad \\lambda \\omega = m\\pi,\\quad m\\in \\mathbb{N}.\n$$\n因此，容许的奇异指数为\n$$\n\\lambda_{m}=\\frac{m\\pi}{\\omega},\\quad m=1,2,\\dots\n$$\n主奇异指数是最小的正指数：\n$$\n\\lambda=\\frac{\\pi}{\\omega}.\n$$\n对于给定的凹角 $\\omega=\\frac{3\\pi}{2}$，\n$$\n\\lambda=\\frac{\\pi}{\\frac{3\\pi}{2}}=\\frac{2}{3}.\n$$\n\n为了讨论对 $H^{1}$ 正则性的影响，注意到应力分量与 $w$ 的梯度成正比，且与奇异项相关的梯度大小在 $r\\to 0$ 时的行为如同\n$$\n|\\nabla w_{\\text{sing}}|\\sim r^{\\lambda-1}\\quad\\text{as}\\ r\\to 0.\n$$\n局部应变能密度与 $|\\nabla w|^{2}$ 成正比，因此角点附近的能量（不计常数因子）按如下方式标度\n$$\n\\int_{0}^{\\varepsilon}\\int_{0}^{\\omega}|\\nabla w_{\\text{sing}}|^{2}\\, r\\, d\\theta\\, dr\\ \\sim\\ \\int_{0}^{\\varepsilon}\\int_{0}^{\\omega} r^{2(\\lambda-1)}\\, r\\, d\\theta\\, dr\\ =\\ \\omega\\int_{0}^{\\varepsilon} r^{2\\lambda-1}\\, dr.\n$$\n该积分在 $r=0$ 处收敛，当且仅当 $2\\lambda-1>-1$，即 $\\lambda>0$。由于 $\\lambda=\\frac{2}{3}>0$，能量是有限的，位移 $w$ 在角点周围局部属于 $H^{1}$ 空间。然而，因为 $\\lambda  1$，应力 $|\\nabla w|$ 在 $r\\to 0$ 时像 $r^{-1/3}$ 一样是无界的，这排除了在角点邻域内具有更高正则性（例如 $H^{2}$）的可能性。从有限元方法的角度来看，有限的能量意味着在 $H^{1}$ 框架下的问题是适定的，但应力奇异性使得为了精确计算角点附近的应力，必须进行网格加密或富集。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "2602467"}, {"introduction": "虽然解析推导非常优雅，但在复杂的工程问题中，我们往往依赖于数值模拟。本练习旨在搭建理论与计算实践之间的桥梁。您将设计一个数值程序 [@problem_id:2602428]，根据一系列有限元仿真的收敛数据，反向估计奇异指数 $\\lambda$。这项动手实践展示了如何从计算结果中提取关键的物理参数，是计算科学家和工程师必备的一项实用技能。", "problem": "考虑一个二维标量椭圆边值问题，该问题由定义在具有单个内角大于 $\\pi$ 的凹角的多边形域上的泊松方程建模。经典正则性理论表明，精确解在角点附近表现出形式为 $u(r,\\theta) \\sim r^{\\lambda}\\phi(\\theta)$ 的奇异性，其中 $r$ 是到角点的距离，$\\lambda \\in (0,1)$ 是由几何形状和边界条件决定的角点指数。在使用多项式次数为 $p$ 的连续分片多项式形函数的有限元（FE，Finite Element）方法中，能量范数误差受此奇异性支配。在朝向角点进行几何加密（加密指数为 $\\beta > 0$）的网格上（这意味着角点附近的有效分辨率比均匀加密增长得更快），经过充分检验的先验误差估计表明，能量范数误差表现为\n$$\n\\| \\nabla(u - u_h) \\|_{L^2(\\Omega)} \\approx C\\, h^{\\alpha}, \\quad \\alpha = \\min(p, \\beta \\lambda),\n$$\n对于角点附近足够小的特征网格尺寸 $h$ 和某个与网格无关的常数 $C>0$。对于线性元， $p = 1$。目标是根据在一系列连续加密的几何分级网格上测得的能量范数误差，来估计未知的角点指数 $\\lambda$。\n\n任务。设计并实现一个稳健的数值程序，给定以下输入：\n- 角点附近的一系列特征网格尺寸 $h_k$，\n- 相应的测量能量范数误差 $e_k \\approx \\| \\nabla(u - u_h) \\|_{L^2(\\Omega)}$，\n- 已知的网格加密指数 $\\beta$，\n返回角点指数的估计值 $\\widehat{\\lambda}$。您的方法必须：\n1) 从线性元（$p = 1$）的基本模型 $e_k \\approx C\\, h_k^{\\alpha}$（其中 $\\alpha = \\min(1, \\beta \\lambda)$）出发，\n2) 变换到对数坐标，将收敛率 $\\alpha$ 识别为线性关系 $\\log(e_k) \\approx \\log C + \\alpha \\log(h_k)$ 中的斜率，\n3) 使用统计上合理且数值上稳健的策略来减轻预渐近污染和轻微噪声的影响。具体来说，在所有后缀（最后 $m$ 个层级，其中 $m \\ge 3$）中，选择一个既能最小化 $(\\log h, \\log e)$ 中最小二乘线性拟合的残差，又能表现出稳定成对斜率的后缀，然后使用从此后缀得到的斜率 $\\widehat{\\alpha}$，\n4) 通过设置 $\\widehat{\\alpha}_{\\text{clip}} = \\min(\\widehat{\\alpha}, 1)$ 来强制执行多项式次数饱和，\n5) 返回 $\\widehat{\\lambda} = \\widehat{\\alpha}_{\\text{clip}}/\\beta$。\n\n您的程序必须实现此过程并将其应用于以下测试套件。每个测试用例按如下方式提供 $(\\beta, \\{h_k\\}, \\{e_k\\})$。所有数字都是无量纲的，没有物理单位。\n\n测试用例 1（理想情况，清晰的渐近区域）：\n- $\\beta = 1.5$，\n- $h = (0.2, 0.1, 0.05, 0.025, 0.0125)$，\n- $e = C h^{\\alpha}$，其中 $C = 2.0$ 且 $\\alpha = 0.75$。\n\n测试用例 2（多项式次数饱和，即 $\\beta \\lambda > 1$，因此观察到的速率为 $1$）：\n- $\\beta = 2.5$，\n- $h = (0.4, 0.2, 0.1, 0.05, 0.025)$，\n- $e = C h^{1}$，其中 $C = 0.5$。\n\n测试用例 3（粗糙层级上的预渐近污染，然后是干净的幂律）：\n- $\\beta = 1.0$，\n- $h = (0.4, 0.2, 0.1, 0.05, 0.025)$，\n- $e = C h^{\\alpha}$，其中 $C = 1.3$ 且 $\\alpha = 0.33$，但前两个值被放大了 1.6 倍，即报告的序列是 $(1.6 C h_1^{\\alpha}, 1.6 C h_2^{\\alpha}, C h_3^{\\alpha}, C h_4^{\\alpha}, C h_5^{\\alpha})$。\n\n测试用例 4（轻微测量噪声）：\n- $\\beta = 1.2$，\n- $h = (0.3, 0.15, 0.075, 0.0375, 0.01875, 0.009375)$，\n- $e = C h^{\\alpha}$，其中 $C = 0.8$ 且 $\\alpha = 0.84$，逐元素乘以固定的扰动因子 $(1.02, 0.98, 1.01, 0.99, 1.00, 1.03)$。\n\n实现要求：\n- 为每个测试用例独立计算 $\\widehat{\\lambda}$。\n- 为确保稳健性，在选择后缀时，请在 $(\\log h, \\log e)$ 中的小最小二乘残差与成对斜率的稳定性之间取得平衡；例如，您可以对候选后缀内局部斜率的较大变异性进行惩罚。\n- 最终输出结果四舍五入至 3 位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按测试用例 1 到 4 的顺序排列的结果，格式为方括号内逗号分隔的列表。例如：$[0.123,0.456,0.789,0.321]$。", "solution": "所提出的问题是在将有限元法（FEM）应用于带凹角域上的泊松问题的背景下，设计一个用于估计角点奇异性指数（记为 $\\lambda$）的数值程序。该估计将使用在一系列几何加密网格上测得的能量范数误差序列 $e_k$（对应于特征网格尺寸序列 $h_k$）来执行。该程序必须对预渐近效应和测量噪声具有稳健性。\n\n这是一个有效的问题。它在科学上基于成熟的奇异问题有限元分析理论。其前提在事实上是合理的，目标定义明确，所提供的测试用例在数值上是可能的情景。我们将继续推导并实现所需的程序。\n\n其理论基础是误差能量范数的先验误差估计。对于在加密指数为 $\\beta$ 的几何加密网格上的线性有限元（$p=1$），该估计由下式给出：\n$$\ne_h \\equiv \\| \\nabla(u - u_h) \\|_{L^2(\\Omega)} \\approx C h^{\\alpha}\n$$\n此处，$u$ 是精确解，$u_h$ 是有限元近似解，$h$ 是奇异点附近的特征网格尺寸，$C$ 是一个与 $h$ 无关的常数。收敛率 $\\alpha$ 由形函数的多项式次数与根据奇异性调整的网格加密之间的最小值确定：\n$$\n\\alpha = \\min(p, \\beta \\lambda) = \\min(1, \\beta \\lambda)\n$$\n我们的目标是从离散数据对 $(h_k, e_k)$（其中 $k=1, \\dots, N$）中估计 $\\lambda$。\n\n为了从幂律关系中提取指数 $\\alpha$，我们通过对两边取自然对数将方程转换为线性形式：\n$$\n\\ln(e_k) \\approx \\ln(C) + \\alpha \\ln(h_k)\n$$\n该方程的形式为 $y_k \\approx c + \\alpha x_k$，其中 $y_k = \\ln(e_k)$，$x_k = \\ln(h_k)$，截距 $c = \\ln(C)$。收敛率 $\\alpha$ 是误差与网格尺寸的双对数图中直线的斜率。\n\n直接对所有数据点 $(x_k, y_k)$ 应用线性回归是天真的，因为数值数据经常受到污染。较粗的网格（较大的 $h_k$）可能不处于理论成立的渐近区域内，并且所有测量都可能受到小的扰动。问题要求采用一个稳健的程序来缓解这些问题。\n\n规定的稳健策略涉及分析数据序列的后缀。其基本原理是，对于较小的 $h_k$（对应于一系列渐进加密网格中的最后几项），渐近误差估计更为准确。我们考虑所有长度为 $m \\geq 3$ 的后缀，其中至少需要 3 个点才能进行最低限度的稳健统计分析（例如，计算成对斜率的标准差）。\n\n对于由最后 $m$ 个数据点组成的每个候选后缀，我们使用两个指标来评估其质量：\n1.  **拟合优度**：这衡量了后缀中的点对线性模型的遵循程度。我们对后缀的 $(\\ln h, \\ln e)$ 数据执行线性最小二乘回归，以找到估计的斜率 $\\widehat{\\alpha}_m$ 和截距 $\\widehat{c}_m$。此拟合的质量通过均方根误差（RMSE）来量化：\n    $$\n    R_m = \\sqrt{\\frac{1}{m} \\sum_{i=N-m+1}^{N} \\left( \\ln(e_i) - (\\widehat{\\alpha}_m \\ln(h_i) + \\widehat{c}_m) \\right)^2}\n    $$\n2.  **收敛率的稳定性**：这衡量了后缀内收敛率的一致性。我们计算连续点之间的局部、成对斜率：\n    $$\n    s_i = \\frac{\\ln(e_{i+1}) - \\ln(e_i)}{\\ln(h_{i+1}) - \\ln(h_i)}\n    $$\n    对于后缀内的点 $i$ 和 $i+1$。然后通过这些成对斜率的标准差 $V_m$ 来衡量稳定性。一个小的 $V_m$ 表示收敛率在后缀所包含的加密层级上是稳定的。\n\n为了选择“最佳”后缀，我们必须平衡这两个标准。较小的 RMSE 和较小的斜率标准差都是我们所期望的。我们为每个长度为 $m$ 的后缀定义一个简单的、未加权的成本函数 $J_m$：\n$$\nJ_m = R_m + V_m\n$$\n最小化此成本函数的后缀被认为是渐近行为最可靠的表示。从此最优后缀的线性拟合中得到的斜率 $\\widehat{\\alpha}$ 被选为我们对收敛率的最佳估计。\n\n一旦确定了最优速率 $\\widehat{\\alpha}$，我们必须考虑由基函数的多项式次数施加的饱和效应。真实速率 $\\alpha$ 不能超过 $p=1$。因此，我们对估计的速率进行截断：\n$$\n\\widehat{\\alpha}_{\\text{clip}} = \\min(\\widehat{\\alpha}, 1.0)\n$$\n最后，我们反转关系式 $\\widehat{\\alpha}_{\\text{clip}} = \\beta \\widehat{\\lambda}$ 来求得奇异性指数的估计值：\n$$\n\\widehat{\\lambda} = \\frac{\\widehat{\\alpha}_{\\text{clip}}}{\\beta}\n$$\n这就完成了稳健估计算计程序的设计。接下来的实现将把此逻辑应用于所提供的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not strictly necessary as numpy covers the needs.\n\ndef estimate_lambda(beta, h_values, e_values):\n    \"\"\"\n    Estimates the corner singularity exponent lambda from FE error data.\n\n    Args:\n        beta (float): The mesh grading exponent.\n        h_values (np.ndarray): A sequence of characteristic mesh sizes.\n        e_values (np.ndarray): A sequence of corresponding energy norm errors.\n\n    Returns:\n        float: The estimated singularity exponent lambda_hat.\n    \"\"\"\n    if len(h_values)  3:\n        raise ValueError(\"At least 3 data points are required.\")\n\n    log_h = np.log(h_values)\n    log_e = np.log(e_values)\n\n    best_suffix_info = {\n        'cost': np.inf,\n        'alpha': np.nan,\n        'length': 0\n    }\n\n    n_points = len(h_values)\n    min_suffix_len = 3\n\n    # Iterate through all possible suffixes of length m >= 3\n    for m in range(min_suffix_len, n_points + 1):\n        # Extract the current suffix (last m points)\n        x_suffix = log_h[-m:]\n        y_suffix = log_e[-m:]\n\n        # 1. Perform linear least-squares regression\n        # np.polyfit(x, y, 1) returns [slope, intercept]\n        slope, intercept = np.polyfit(x_suffix, y_suffix, 1)\n\n        # 2. Calculate the Root Mean Squared Error (RMSE) of the fit\n        predictions = slope * x_suffix + intercept\n        residuals = y_suffix - predictions\n        rmse = np.sqrt(np.mean(residuals**2))\n\n        # 3. Calculate the stability of pairwise slopes\n        # Pairwise slopes are (y2-y1)/(x2-x1)\n        pairwise_slopes = (y_suffix[1:] - y_suffix[:-1]) / (x_suffix[1:] - x_suffix[:-1])\n        \n        # Standard deviation of pairwise slopes\n        slope_std_dev = np.std(pairwise_slopes) if len(pairwise_slopes) > 1 else 0\n\n        # 4. Define and compute the cost function\n        cost = rmse + slope_std_dev\n        \n        # 5. Check if this is the best suffix found so far\n        if cost  best_suffix_info['cost']:\n            best_suffix_info['cost'] = cost\n            best_suffix_info['alpha'] = slope\n            best_suffix_info['length'] = m\n\n    # Extract the best estimate for alpha from the optimal suffix\n    alpha_hat = best_suffix_info['alpha']\n\n    # Enforce the polynomial-degree saturation: alpha = p=1\n    alpha_clip = min(alpha_hat, 1.0)\n\n    # Compute the final estimate for lambda\n    lambda_hat = alpha_clip / beta\n\n    return lambda_hat\n\ndef solve():\n    \"\"\"\n    Defines the test cases, runs the estimation for each, and prints the results.\n    \"\"\"\n    # Test case 1: Happy path, clear asymptotic regime\n    h1 = np.array([0.2, 0.1, 0.05, 0.025, 0.0125])\n    e1 = 2.0 * h1**0.75\n    case1 = (1.5, h1, e1)\n\n    # Test case 2: Saturation at polynomial degree\n    h2 = np.array([0.4, 0.2, 0.1, 0.05, 0.025])\n    e2 = 0.5 * h2**1.0\n    case2 = (2.5, h2, e2)\n\n    # Test case 3: Pre-asymptotic contamination\n    h3 = np.array([0.4, 0.2, 0.1, 0.05, 0.025])\n    e3_base = 1.3 * h3**0.33\n    e3_base[:2] *= 1.6  # Inflate the first two error values\n    case3 = (1.0, h3, e3_base)\n\n    # Test case 4: Mild measurement noise\n    h4 = np.array([0.3, 0.15, 0.075, 0.0375, 0.01875, 0.009375])\n    e4_base = 0.8 * h4**0.84\n    perturbations = np.array([1.02, 0.98, 1.01, 0.99, 1.00, 1.03])\n    e4 = e4_base * perturbations\n    case4 = (1.2, h4, e4)\n\n    test_cases = [case1, case2, case3, case4]\n\n    results = []\n    for beta, h, e in test_cases:\n        lambda_estimate = estimate_lambda(beta, h, e)\n        results.append(lambda_estimate)\n\n    # Format the final output string as required.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2602428"}]}