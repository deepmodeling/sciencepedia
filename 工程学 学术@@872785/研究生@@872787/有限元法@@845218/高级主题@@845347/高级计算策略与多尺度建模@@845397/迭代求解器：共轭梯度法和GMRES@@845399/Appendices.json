{"hands_on_practices": [{"introduction": "共轭梯度（CG）方法是求解具有对称正定（SPD）矩阵的线性系统的强大工具。在应用该方法之前，确认矩阵的SPD性质并理解其相关的“能量”范数是至关重要的第一步。本练习将引导你通过基本定义来验证一个典型的有限元刚度矩阵是否为SPD矩阵，并计算其能量范数[@problem_id:2570982]，为掌握CG方法奠定坚实的数学基础。", "problem": "在有限元法 (FEM) 中，与强制双线性形式相关的刚度矩阵是对称正定 (SPD) 的，这导出了一个适用于共轭梯度法的能量内积。考虑矩阵\n$$\nA=\\begin{bmatrix}2  -1 \\\\ -1  2\\end{bmatrix}\n$$\n和向量\n$$\nx=\\begin{bmatrix}1 \\\\ 2\\end{bmatrix}.\n$$\n仅使用基本定义，完成以下操作：\n1. 使用由 $A$ 导出的能量内积，计算能量范数 $\\|x\\|_{A}$。\n2. 从第一性原理出发，通过检查对称性并证明对于任意非零 $z\\in\\mathbb{R}^{2}$ 都有 $z^{\\mathsf{T}}Az0$，来验证 $A$ 是对称正定的。\n\n请精确表示范数 $\\|x\\|_{A}$；不需要四舍五入或近似计算。", "solution": "所述问题是有效的。它在科学上基于线性代数和数值分析的原理，是适定的，且所有提供的数据都是完整和一致的。我们将开始求解。\n\n问题要求使用给定的矩阵 $A$ 和向量 $x$ 完成两项任务：\n$$\nA=\\begin{bmatrix}2  -1 \\\\ -1  2\\end{bmatrix}, \\quad x=\\begin{bmatrix}1 \\\\ 2\\end{bmatrix}\n$$\n第一项任务是计算能量范数 $\\|x\\|_{A}$。由对称正定矩阵 $A$ 导出的能量内积对于任意向量 $u, v \\in \\mathbb{R}^n$ 定义为：\n$$\n\\langle u, v \\rangle_{A} = u^{\\mathsf{T}}Av\n$$\n相应的能量范数则定义为：\n$$\n\\|u\\|_{A} = \\sqrt{\\langle u, u \\rangle_{A}} = \\sqrt{u^{\\mathsf{T}}Au}\n$$\n\n为了计算 $\\|x\\|_{A}$，我们首先计算乘积 $Ax$：\n$$\nAx = \\begin{bmatrix}2  -1 \\\\ -1  2\\end{bmatrix} \\begin{bmatrix}1 \\\\ 2\\end{bmatrix} = \\begin{bmatrix}2 \\cdot 1 + (-1) \\cdot 2 \\\\ -1 \\cdot 1 + 2 \\cdot 2\\end{bmatrix} = \\begin{bmatrix}2-2 \\\\ -1+4\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 3\\end{bmatrix}\n$$\n接下来，我们计算二次型 $x^{\\mathsf{T}}Ax$，即能量范数 $\\|x\\|_{A}$ 的平方：\n$$\n\\|x\\|_{A}^2 = x^{\\mathsf{T}}(Ax) = \\begin{bmatrix}1  2\\end{bmatrix} \\begin{bmatrix}0 \\\\ 3\\end{bmatrix} = 1 \\cdot 0 + 2 \\cdot 3 = 6\n$$\n能量范数是该值的平方根：\n$$\n\\|x\\|_{A} = \\sqrt{6}\n$$\n\n第二项任务是从第一性原理验证矩阵 $A$ 是对称正定 (SPD) 的。一个矩阵是 SPD 的，如果它既是对称的又是正定的。\n\n首先，我们检查对称性。如果 $A = A^{\\mathsf{T}}$，则矩阵 $A$ 是对称的。\n$$\nA^{\\mathsf{T}} = \\begin{bmatrix}2  -1 \\\\ -1  2\\end{bmatrix}^{\\mathsf{T}} = \\begin{bmatrix}2  -1 \\\\ -1  2\\end{bmatrix}\n$$\n由于 $A = A^{\\mathsf{T}}$，矩阵 $A$ 是对称的。\n\n其次，我们检查正定性。如果对于任意非零向量 $z \\in \\mathbb{R}^2$，二次型 $z^{\\mathsf{T}}Az$ 严格为正，则矩阵 $A$ 是正定的。设 $z=\\begin{bmatrix}z_1 \\\\ z_2\\end{bmatrix}$ 为一个任意非零向量，意味着 $z_1, z_2$ 中至少有一个不为零。我们计算 $z^{\\mathsf{T}}Az$：\n$$\nz^{\\mathsf{T}}Az = \\begin{bmatrix}z_1  z_2\\end{bmatrix} \\begin{bmatrix}2  -1 \\\\ -1  2\\end{bmatrix} \\begin{bmatrix}z_1 \\\\ z_2\\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix}z_1  z_2\\end{bmatrix} \\begin{bmatrix}2z_1 - z_2 \\\\ -z_1 + 2z_2\\end{bmatrix}\n$$\n$$\n= z_1(2z_1 - z_2) + z_2(-z_1 + 2z_2)\n$$\n$$\n= 2z_1^2 - z_1z_2 - z_2z_1 + 2z_2^2 = 2z_1^2 - 2z_1z_2 + 2z_2^2\n$$\n为了证明该表达式对于任意非零 $z$ 都严格为正，我们可以通过配方法来完成：\n$$\n2z_1^2 - 2z_1z_2 + 2z_2^2 = (z_1^2 - 2z_1z_2 + z_2^2) + z_1^2 + z_2^2 = (z_1 - z_2)^2 + z_1^2 + z_2^2\n$$\n该表达式是三个实数平方项之和：$(z_1 - z_2)^2$、$z_1^2$ 和 $z_2^2$。每一项都是非负的。当且仅当所有单项都为零时，和才等于零：\n$$\nz_1^2=0 \\implies z_1=0\n$$\n$$\nz_2^2=0 \\implies z_2=0\n$$\n如果 $z_1=0$ 且 $z_2=0$，那么 $(z_1-z_2)^2=0$ 也成立。因此，$z^{\\mathsf{T}}Az = 0$ 当且仅当 $z = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$。对于任意非零向量 $z$，$z_1$ 或 $z_2$ 中至少有一个不为零，这意味着 $z_1^2$ 或 $z_2^2$ 中至少有一项是严格为正的。因此，这个和是严格为正的。\n$$\nz^{\\mathsf{T}}Az > 0 \\quad \\text{对于所有 } z \\in \\mathbb{R}^2, z \\neq \\mathbf{0}\n$$\n这证明了矩阵 $A$ 是正定的。由于 $A$ 既是对称的又是正定的，所以它是一个 SPD 矩阵。验证完成。", "answer": "$$\n\\boxed{\\sqrt{6}}\n$$", "id": "2570982"}, {"introduction": "在理解了对称正定矩阵的基础之后，是时候亲手实践共轭梯度算法的完整流程了。这个练习将带你一步步完成一个简单系统的CG迭代计算[@problem_id:2570866]。通过显式地计算每一步的步长 $\\alpha_{k}$、系数 $\\beta_{k}$、解向量 $x_{k}$、残差 $r_{k}$ 和搜索方向 $p_{k}$，你将能直观地看到该方法如何巧妙地构造A-正交的搜索方向，并最终在有限步内收敛到精确解。", "problem": "考虑一个对称正定 (SPD) 线性系统，该系统源于一个二自由度有限元模型，其刚度矩阵为 $A=\\begin{bmatrix}20\\\\01\\end{bmatrix}$，右端项为 $b=\\begin{bmatrix}2\\\\1\\end{bmatrix}$，初始猜测值为 $x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$。从 $x_{0}$ 开始，应用共轭梯度 (CG) 法进行 $2$ 次迭代。从适用于 SPD 系统的第一性原理出发：二次能量泛函 $J(x)=\\tfrac{1}{2}x^{\\mathsf{T}}A x-b^{\\mathsf{T}}x$，残差 $r_{k}=b-Ax_{k}$，搜索子空间 $x_{k+1}\\in x_{k}+\\operatorname{span}\\{p_{k}\\}$，搜索方向的 $A$-共轭性 $p_{i}^{\\mathsf{T}}A p_{j}=0$ (对于 $i\\neq j$)，以及由沿 $p_{k}$ 方向最小化 $J$ 所导出的残差与当前搜索方向的正交性。仅使用这些基本事实，首先推导步长 $\\alpha_{k}$ 和递归系数 $\\beta_{k}$ 关于 $r_{k}$、$p_{k}$ 和 $A$ 的表达式，然后进行计算，以精确的有理数形式明确地获得以下量：$\\alpha_{0}$、$\\beta_{0}$、$\\alpha_{1}$、$\\beta_{1}$、迭代值 $x_{1}$ 和 $x_{2}$、残差 $r_{0}$、$r_{1}$、$r_{2}$，以及搜索方向 $p_{0}$、$p_{1}$、$p_{2}$。\n\n将你的最终结果表示为一个单行矩阵，并严格按照以下顺序包含：\n$$\\bigl[\\alpha_{0},\\,\\beta_{0},\\,\\alpha_{1},\\,\\beta_{1},\\,x_{0,1},\\,x_{0,2},\\,x_{1,1},\\,x_{1,2},\\,x_{2,1},\\,x_{2,2},\\,r_{0,1},\\,r_{0,2},\\,r_{1,1},\\,r_{1,2},\\,r_{2,1},\\,r_{2,2},\\,p_{0,1},\\,p_{0,2},\\,p_{1,1},\\,p_{1,2},\\,p_{2,1},\\,p_{2,2}\\bigr].$$\n\n所有量均需精确表示；无需四舍五入。", "solution": "所述问题具有科学依据，是适定的、客观且自洽的。这是应用共轭梯度 (CG) 法的一个典型练习。因此，该问题被认定为有效，并将提供完整解答。\n\n问题要求从第一性原理推导共轭梯度算法的参数，然后对给定的线性系统执行两次迭代。\n\n**1. CG 算法参数的推导**\n\n设线性系统为 $Ax = b$，其中 $A$ 是一个 $n \\times n$ 的对称正定 (SPD) 矩阵。解 $x$ 唯一地最小化二次能量泛函 $J(x) = \\frac{1}{2}x^{\\mathsf{T}}A x - b^{\\mathsf{T}}x$。CG 法是一个迭代过程，生成一个收敛于真实解的近似序列 $x_k$。\n\n该方法由以下更新规则定义：\n$x_{k+1} = x_k + \\alpha_k p_k$\n$r_{k+1} = r_k - \\alpha_k A p_k$\n$p_{k+1} = r_{k+1} + \\beta_k p_k$\n其中 $r_k = b - Ax_k$ 是第 $k$ 步的残差，$p_k$ 是搜索方向，$\\alpha_k$ 是步长，$\\beta_k$ 是一个用于将新残差与前一个搜索方向组合的系数。\n\n**步长 $\\alpha_k$ 的推导：**\n选择步长 $\\alpha_k$ 以沿搜索方向 $p_k$ 最小化能量泛函 $J(x_{k+1})$。也就是说，我们对 $\\alpha_k$ 最小化 $J(x_k + \\alpha_k p_k)$。\n$$J(x_k + \\alpha_k p_k) = \\frac{1}{2}(x_k + \\alpha_k p_k)^{\\mathsf{T}}A(x_k + \\alpha_k p_k) - b^{\\mathsf{T}}(x_k + \\alpha_k p_k)$$\n为了找到最小值，我们将关于 $\\alpha_k$ 的导数设为零：\n$$\\frac{d}{d\\alpha_k} J(x_k + \\alpha_k p_k) = 0$$\n使用矩阵微积分的乘法法则和 $A$ 的对称性，我们得到：\n$$p_k^{\\mathsf{T}}A(x_k + \\alpha_k p_k) - p_k^{\\mathsf{T}}b = 0$$\n$$p_k^{\\mathsf{T}}Ax_k + \\alpha_k p_k^{\\mathsf{T}}Ap_k - p_k^{\\mathsf{T}}b = 0$$\n$$\\alpha_k (p_k^{\\mathsf{T}}Ap_k) = p_k^{\\mathsf{T}}(b - Ax_k)$$\n使用残差的定义 $r_k = b - Ax_k$，我们得到：\n$$\\alpha_k = \\frac{p_k^{\\mathsf{T}}r_k}{p_k^{\\mathsf{T}}Ap_k}$$\n这是一个通用表达式。对于 CG 算法，可以证明 $p_k^{\\mathsf{T}}r_k = r_k^{\\mathsf{T}}r_k$。从 $p_0 = r_0$ 开始，对于 $k=0$ 这是平凡的。对于 $k0$，$p_k = r_k + \\beta_{k-1}p_{k-1}$。因此，$p_k^{\\mathsf{T}}r_k = (r_k + \\beta_{k-1}p_{k-1})^{\\mathsf{T}}r_k = r_k^{\\mathsf{T}}r_k + \\beta_{k-1}p_{k-1}^{\\mathsf{T}}r_k$。产生 $\\alpha_{k-1}$ 的最优性条件等价于 $r_k^{\\mathsf{T}}p_{k-1}=0$。因此，$p_{k-1}^{\\mathsf{T}}r_k=0$，这使得表达式简化为 $p_k^{\\mathsf{T}}r_k = r_k^{\\mathsf{T}}r_k$。\n因此，步长的标准公式是：\n$$\\alpha_k = \\frac{r_k^{\\mathsf{T}}r_k}{p_k^{\\mathsf{T}}Ap_k}$$\n\n**递归系数 $\\beta_k$ 的推导：**\n搜索方向必须是 $A$-共轭的，即对于所有 $j \\le k$，$p_{k+1}^{\\mathsf{T}}A p_j = 0$。我们对 $j=k$ 强制执行此条件：\n$$p_{k+1}^{\\mathsf{T}}A p_k = 0$$\n代入新搜索方向的表达式 $p_{k+1} = r_{k+1} + \\beta_k p_k$：\n$$(r_{k+1} + \\beta_k p_k)^{\\mathsf{T}}A p_k = 0$$\n$$r_{k+1}^{\\mathsf{T}}A p_k + \\beta_k p_k^{\\mathsf{T}}A p_k = 0$$\n解出 $\\beta_k$：\n$$\\beta_k = - \\frac{r_{k+1}^{\\mathsf{T}}A p_k}{p_k^{\\mathsf{T}}A p_k}$$\n这个公式可以简化。根据残差更新公式 $r_{k+1} = r_k - \\alpha_k A p_k$，我们可以写出 $A p_k = \\frac{1}{\\alpha_k}(r_k - r_{k+1})$。将其代入分子：\n$$\\beta_k = - \\frac{r_{k+1}^{\\mathsf{T}}\\left(\\frac{1}{\\alpha_k}(r_k - r_{k+1})\\right)}{p_k^{\\mathsf{T}}A p_k} = -\\frac{1}{\\alpha_k} \\frac{r_{k+1}^{\\mathsf{T}}r_k - r_{k+1}^{\\mathsf{T}}r_{k+1}}{p_k^{\\mathsf{T}}A p_k}$$\nCG 的一个基本性质是残差的正交性，$r_{k+1}^{\\mathsf{T}}r_k = 0$。这可以通过对搜索方向的 $A$-共轭性使用归纳法来证明。因此，表达式变为：\n$$\\beta_k = \\frac{1}{\\alpha_k} \\frac{r_{k+1}^{\\mathsf{T}}r_{k+1}}{p_k^{\\mathsf{T}}A p_k}$$\n现在，代入 $\\alpha_k = \\frac{r_k^{\\mathsf{T}}r_k}{p_k^{\\mathsf{T}}Ap_k}$ 的表达式，这意味着 $\\alpha_k p_k^{\\mathsf{T}}Ap_k = r_k^{\\mathsf{T}}r_k$：\n$$\\beta_k = \\frac{r_{k+1}^{\\mathsf{T}}r_{k+1}}{r_k^{\\mathsf{T}}r_k}$$\n\n**2. CG 算法的应用**\n\n问题给定：\n$A = \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix}$，$b = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$，以及初始猜测值 $x_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n\n**迭代 $k=0$：**\n初始残差：\n$r_0 = b - A x_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} - \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix}\\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n初始搜索方向：\n$p_0 = r_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n残差的标量积：\n$r_0^{\\mathsf{T}}r_0 = 2^2 + 1^2 = 5$。\n计算 $A p_0$：\n$A p_0 = \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix}\\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix}$。\n计算 $p_0^{\\mathsf{T}}A p_0$：\n$p_0^{\\mathsf{T}}A p_0 = \\begin{bmatrix} 2  1 \\end{bmatrix} \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix} = 8 + 1 = 9$。\n步长 $\\alpha_0$：\n$\\alpha_0 = \\frac{r_0^{\\mathsf{T}}r_0}{p_0^{\\mathsf{T}}A p_0} = \\frac{5}{9}$。\n更新迭代值 $x_1$：\n$x_1 = x_0 + \\alpha_0 p_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\frac{5}{9}\\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix}$。\n更新残差 $r_1$：\n$r_1 = r_0 - \\alpha_0 A p_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} - \\frac{5}{9}\\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 18/9 - 20/9 \\\\ 9/9 - 5/9 \\end{bmatrix} = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix}$。\n新残差的标量积：\n$r_1^{\\mathsf{T}}r_1 = (-\\frac{2}{9})^2 + (\\frac{4}{9})^2 = \\frac{4}{81} + \\frac{16}{81} = \\frac{20}{81}$。\n递归系数 $\\beta_0$：\n$\\beta_0 = \\frac{r_1^{\\mathsf{T}}r_1}{r_0^{\\mathsf{T}}r_0} = \\frac{20/81}{5} = \\frac{4}{81}$。\n更新搜索方向 $p_1$：\n$p_1 = r_1 + \\beta_0 p_0 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} + \\frac{4}{81}\\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} -18/81 \\\\ 36/81 \\end{bmatrix} + \\begin{bmatrix} 8/81 \\\\ 4/81 \\end{bmatrix} = \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix}$。\n\n**迭代 $k=1$：**\n我们有 $r_1 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix}$，$p_1 = \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix}$，以及 $r_1^{\\mathsf{T}}r_1 = \\frac{20}{81}$。\n计算 $A p_1$：\n$Ap_1 = \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix}\\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} -20/81 \\\\ 40/81 \\end{bmatrix}$。\n计算 $p_1^{\\mathsf{T}}A p_1$：\n$p_1^{\\mathsf{T}}A p_1 = \\begin{bmatrix} -10/81  40/81 \\end{bmatrix} \\begin{bmatrix} -20/81 \\\\ 40/81 \\end{bmatrix} = \\frac{200}{81^2} + \\frac{1600}{81^2} = \\frac{1800}{6561}$。\n步长 $\\alpha_1$：\n$\\alpha_1 = \\frac{r_1^{\\mathsf{T}}r_1}{p_1^{\\mathsf{T}}A p_1} = \\frac{20/81}{1800/6561} = \\frac{20}{81} \\cdot \\frac{6561}{1800} = \\frac{20 \\cdot 81}{1800} = \\frac{1620}{1800} = \\frac{9}{10}$。\n更新迭代值 $x_2$：\n$x_2 = x_1 + \\alpha_1 p_1 = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix} + \\frac{9}{10}\\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix} + \\begin{bmatrix} -1/9 \\\\ 4/9 \\end{bmatrix} = \\begin{bmatrix} 9/9 \\\\ 9/9 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n更新残差 $r_2$：\n$r_2 = r_1 - \\alpha_1 A p_1 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} - \\frac{9}{10}\\begin{bmatrix} -20/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} - \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n新残差的标量积：\n$r_2^{\\mathsf{T}}r_2 = 0^2 + 0^2 = 0$。\n递归系数 $\\beta_1$：\n$\\beta_1 = \\frac{r_2^{\\mathsf{T}}r_2}{r_1^{\\mathsf{T}}r_1} = \\frac{0}{20/81} = 0$。\n更新搜索方向 $p_2$：\n$p_2 = r_2 + \\beta_1 p_1 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + 0 \\cdot \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n算法在 2 步内收敛到精确解 $x=\\begin{bmatrix}1\\\\1\\end{bmatrix}$，这对于一个 $2 \\times 2$ 系统是预期的结果。\n\n**各量汇总：**\n$\\alpha_0 = 5/9$\n$\\beta_0 = 4/81$\n$\\alpha_1 = 9/10$\n$\\beta_1 = 0$\n$x_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n$x_1 = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix}$\n$x_2 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n$r_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$\n$r_1 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix}$\n$r_2 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n$p_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$\n$p_1 = \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix}$\n$p_2 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n这些将被组装到最终的答案矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{9}  \\frac{4}{81}  \\frac{9}{10}  0  0  0  \\frac{10}{9}  \\frac{5}{9}  1  1  2  1  -\\frac{2}{9}  \\frac{4}{9}  0  0  2  1  -\\frac{10}{81}  \\frac{40}{81}  0  0\n\\end{pmatrix}\n}\n$$", "id": "2570866"}, {"introduction": "当线性系统的矩阵不再对称正定时，共轭梯度方法便不再适用，此时我们需要更通用的广义最小残差（GMRES）方法。GMRES的核心在于Arnoldi过程，它为Krylov子空间构建了一个标准正交基，并将原始问题转化为一个更小的最小二乘问题。本练习将指导你完成一步Arnoldi迭代，并用其计算GMRES的解，从而深入理解该方法的基本力学[@problem_id:2570955]。", "problem": "考虑一个由有限元离散化产生的线性系统 $A x = b$，其中\n$$\nA=\\begin{bmatrix}2  1 \\\\ 0  3\\end{bmatrix}, \\quad b=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}, \\quad x_{0}=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}.\n$$\n令 $\\|\\cdot\\|$ 表示欧几里得范数。您将执行一步 Arnoldi 过程，并计算由一步广义最小残差 (GMRES) 方法产生的残差范数。\n\n从初始残差 $r_{0}=b-A x_{0}$ 开始，定义第一个 Arnoldi 向量 $v_{1}=r_{0}/\\|r_{0}\\|$。执行一步 Arnoldi 过程以获得标量 $h_{11}$ 和 $h_{21}$，使得\n$$\nA v_{1}=v_{1} h_{11}+v_{2} h_{21},\n$$\n其中如果 $h_{21}\\neq 0$，则 $v_{2}$ 是下一个 Arnoldi 向量。使用这些结果来构建 $(1+1)\\times 1$ 的上Hessenberg矩阵 (upper Hessenberg matrix) $\\hat{H}_{1}=\\begin{bmatrix}h_{11} \\\\ h_{21}\\end{bmatrix}$ 和标量 $\\beta=\\|r_{0}\\|$。\n\n仅使用克里洛夫子空间 (Krylov subspaces) 的定义性质、Arnoldi 关系以及 Arnoldi 向量的正交规范性，推导单步 GMRES 最小二乘问题，并计算此单步之后的 GMRES 残差范数。请提供残差范数的精确值作为最终答案（无需四舍五入）。", "solution": "该问题要求计算给定线性系统 $A x = b$ 在执行一步广义最小残差 (GMRES) 方法后的残差范数。在进行求解之前，我们必须首先验证问题陈述，该问题陈述是适定的 (well-posed) 且科学上合理的。\n\n问题由矩阵 $A$、向量 $b$ 和初始猜测 $x_{0}$ 定义：\n$$\nA=\\begin{bmatrix}2  1 \\\\ 0  3\\end{bmatrix}, \\quad b=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}, \\quad x_{0}=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}\n$$\nGMRES 算法在克里洛夫子空间中迭代寻找近似解。该过程从计算初始残差 $r_{0}$ 开始。\n\n首先，我们计算初始残差 $r_{0}$：\n$$\nr_{0} = b - A x_{0} = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} - \\begin{bmatrix}2  1 \\\\ 0  3\\end{bmatrix} \\begin{bmatrix}0 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix}\n$$\n初始残差的范数，记为 $\\beta$，使用欧几里得范数计算：\n$$\n\\beta = \\|r_{0}\\| = \\sqrt{1^{2} + 1^{2}} = \\sqrt{2}\n$$\nArnoldi 过程的第一步为克里洛夫子空间 $\\mathcal{K}_{1}(A, r_{0})$ 生成一个标准正交基。第一个基向量 $v_{1}$ 是归一化的初始残差：\n$$\nv_{1} = \\frac{r_{0}}{\\|r_{0}\\|} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix}\n$$\n接下来，我们执行一步 Arnoldi 迭代来求解海森堡矩阵 (Hessenberg matrix) $\\hat{H}_{1}$ 的元素。我们计算 $A$ 和 $v_{1}$ 的乘积：\n$$\nw_{1} = A v_{1} = \\begin{bmatrix}2  1 \\\\ 0  3\\end{bmatrix} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}2(1)+1(1) \\\\ 0(1)+3(1)\\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}3 \\\\ 3\\end{bmatrix}\n$$\n系数 $h_{11}$ 是 $w_{1}$ 在 $v_{1}$ 上的投影。由于我们处理的是实向量，因此 $h_{11} = v_{1}^{T} w_{1}$：\n$$\nh_{11} = \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1  1\\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} \\right) = \\frac{1}{2} (1 \\cdot 3 + 1 \\cdot 3) = \\frac{6}{2} = 3\n$$\n下一个 Arnoldi 向量 $v_{2}$ 是通过将 $w_{1}$ 对 $v_{1}$ 正交化得到的。令 $\\tilde{w}_{1} = w_{1} - h_{11} v_{1}$：\n$$\n\\tilde{w}_{1} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} - 3 \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\left( \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} - \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} \\right) = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}\n$$\n系数 $h_{21}$ 是该向量的范数：\n$$\nh_{21} = \\|\\tilde{w}_{1}\\| = \\sqrt{0^2 + 0^2} = 0\n$$\n这种情况，即 $h_{m+1, m} = 0$，被称为“幸运分解”(lucky breakdown)。这意味着克里洛夫子空间 $\\mathcal{K}_{m}(A, r_{0})$ 是 $A$ 的一个不变子空间。在本例中，对于 $m=1$，我们有 $A v_{1} = h_{11} v_{1}$，这意味着 $v_{1}$（以及 $r_{0}$）是矩阵 $A$ 的一个特征向量，其特征值为 $h_{11}=3$。\n\nGMRES 方法找到一个形式为 $x_{m} = x_{0} + z_{m}$ 的近似解，其中 $z_{m}$ 位于克里洛夫子空间 $\\mathcal{K}_{m}(A, r_{0}) = \\text{span}\\{v_{1}, v_{2}, \\ldots, v_{m}\\}$ 中。选择向量 $z_{m}$ 以最小化残差 $r_{m} = \\|b - A x_{m}\\|$ 的范数。\n对于第一步 ($m=1$)，我们寻求使 $\\|r_{1}\\|$ 最小化的 $x_{1} = x_{0} + y_{1}v_{1}$。残差为：\n$$\nr_{1} = b - A x_{1} = b - A(x_{0} + y_{1}v_{1}) = (b - A x_{0}) - y_{1}A v_{1} = r_{0} - y_{1}A v_{1}\n$$\n使用 Arnoldi 关系 $r_{0} = \\beta v_{1}$ 和 $A v_{1} = h_{11}v_{1} + h_{21}v_{2}$，我们得到：\n$$\nr_{1} = \\beta v_{1} - y_{1}(h_{11}v_{1} + h_{21}v_{2}) = (\\beta - y_{1}h_{11})v_{1} - y_{1}h_{21}v_{2}\n$$\n由于 Arnoldi 向量是标准正交的，残差的范数为：\n$$\n\\|r_{1}\\|^{2} = \\|(\\beta - y_{1}h_{11})v_{1} - y_{1}h_{21}v_{2}\\|^{2} = (\\beta - y_{1}h_{11})^{2} + (-y_{1}h_{21})^{2}\n$$\n最小化 $\\|r_{1}\\|$ 等价于为 $y$ 求解以下 $(m+1) \\times m$ 的最小二乘问题：\n$$\n\\min_{y \\in \\mathbb{R}^{m}} \\|\\hat{H}_{m} y - \\beta e_{1}\\|\n$$\n其中 $\\hat{H}_{m}$ 是来自 Arnoldi 过程的 $(m+1) \\times m$ 上Hessenberg矩阵，而 $e_{1}$ 是 $\\mathbb{R}^{m+1}$ 中的第一个标准基向量。GMRES 残差的范数 $\\|r_{m}\\|$ 是该最小化过程的直接结果。\n\n对于 $m=1$，我们有 $y \\in \\mathbb{R}^{1}$（一个标量 $y_1$）和 $e_{1} \\in \\mathbb{R}^{2}$。问题是：\n$$\n\\min_{y_{1}} \\left\\| \\begin{bmatrix} h_{11} \\\\ h_{21} \\end{bmatrix} [y_{1}] - \\beta \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\right\\|\n$$\n代入计算出的值 $h_{11}=3$, $h_{21}=0$ 和 $\\beta=\\sqrt{2}$：\n$$\n\\min_{y_{1}} \\left\\| \\begin{bmatrix} 3 \\\\ 0 \\end{bmatrix} [y_{1}] - \\sqrt{2} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\right\\| = \\min_{y_{1}} \\left\\| \\begin{bmatrix} 3y_{1} - \\sqrt{2} \\\\ 0 \\end{bmatrix} \\right\\|\n$$\n该向量的范数是 $\\sqrt{(3y_{1} - \\sqrt{2})^{2} + 0^{2}} = |3y_{1} - \\sqrt{2}|$。\n当 $3y_{1} - \\sqrt{2} = 0$ 时，该表达式达到最小值，这意味着选择 $y_{1} = \\frac{\\sqrt{2}}{3}$。最小值本身，即一步 GMRES 后的残差范数，为 $0$。\n\n因此，GMRES 在一步内收敛到精确解，因为初始残差 $r_{0}$ 是矩阵 $A$ 的一个特征向量。最终的残差范数 $\\|r_{1}\\|$ 为零。", "answer": "$$\\boxed{0}$$", "id": "2570955"}]}