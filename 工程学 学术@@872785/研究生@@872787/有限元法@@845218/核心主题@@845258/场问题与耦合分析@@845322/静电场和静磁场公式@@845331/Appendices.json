{"hands_on_practices": [{"introduction": "选择正确的有限元空间对于获得具有物理意义的模拟结果至关重要。例如，在静电学中，不恰当的离散格式可能无法正确地在单元边界上保持通量的连续性，从而引入虚假的“电荷源”，这违反了高斯定律。本练习将指导您设计一个被称为“膜片检验”（patch test）的诊断工具[@problem_id:2553554]，用于检测由非协调元（nonconforming elements）引起的这些基本公式错误，从而加深对离散层面满足守恒律重要性的理解。", "problem": "考虑一种占据多边形域 $\\Omega \\subset \\mathbb{R}^2$ 的均匀、各向同性材料，其介电常数 $\\varepsilon$ 为常数。在静电学中，控制定律是高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_f$（其中 $\\mathbf{D} = \\varepsilon \\mathbf{E}$ 和 $\\mathbf{E} = - \\nabla \\phi$），$\\rho_f$ 是自由电荷密度，$\\phi$ 是电势。在静磁学中，相关的无散约束是 $\\nabla \\cdot \\mathbf{B} = 0$（其中 $\\mathbf{B} = \\mu \\mathbf{H}$ 和 $\\nabla \\times \\mathbf{H} = \\mathbf{J}$）。对于无电荷的静电情况，$\\rho_f = 0$ 意味着任何物理上可接受的通量密度都必须满足 $\\nabla \\cdot \\mathbf{D} = 0$，并且根据散度定理，通过任何子域 $P \\subset \\Omega$ 的边界 $\\partial P$ 的净向外通量必须为零，即 $\\int_{\\partial P} \\mathbf{D} \\cdot \\mathbf{n} \\, \\mathrm{d}s = 0$，其中 $\\mathbf{n}$ 是单位外法线。\n\n有限元法（FEM）离散化中的一个常见失效模式发生在对类通量未知数（例如，用分量连续的拉格朗日空间来近似 $\\mathbf{D}$ 或 $\\mathbf{B}$）使用非协调矢量场空间时，这种空间不强制法向分量跨单元间边界的连续性。这种非协调性会引入伪源，表现为即使在精确物理要求为零的情况下，一小块单元的边界上的净通量也不为零。\n\n要求你设计一个最小的、诊断性的“斑片检验”，以可靠地检测由非协调空间引起的这种伪散度。你可以假设网格为单纯形网格，且“斑片”是由形成类平行四边形四边形的 $2$ 个三角形的并集。你的检验必须基于基本场论，并且必须指明边界数据、被探测的构造精确行为、从离散解中计算的测量值以及判断通过或失败的标准。以下哪种斑片检验设计能正确检测出由非协调空间引入的局部电荷（或通量）守恒的违背？\n\nA. 静电学，无电荷情况。在 $\\partial \\Omega$ 上规定狄利克雷数据 $\\phi = x$，使用矢量场公式求解，其中电通量密度 $\\mathbf{D}_h$ 在三角形上的分量连续多项式空间 $[P_1]^2$ 中近似（即 $\\mathbf{D}_h \\in [C^0]^2$ 但不满足 $H(\\mathrm{div})$协调性）。对于由两个三角形组成的斑片 $P$，计算净向外通量 $\\int_{\\partial P} \\mathbf{D}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s$。如果在网格加密下该量不趋于 $0$，则判定为失败，因为精确解具有均匀电场 $\\mathbf{E}$，因此 $\\nabla \\cdot \\mathbf{D} = 0$。\n\nB. 静电学，无电荷情况。在 $\\partial \\Omega$ 上规定狄利克雷数据 $\\phi = x$，用任何公式求解，并对由两个三角形组成的斑片 $P$ 计算切向分量的线积分 $\\int_{\\partial P} \\mathbf{E}_h \\cdot \\mathbf{t} \\, \\mathrm{d}s$。如果此积分为非零，则判定为失败，因为非零的切向环量表示在单元间面上产生了伪电荷。\n\nC. 静磁学，无电流情况。使用磁矢量势公式，其中标量势 $A_z$ 在 $H^1(\\Omega)$ 中，因此 $\\mathbf{B}_h = \\nabla \\times (A_{z,h} \\mathbf{e}_z)$。对于由两个三角形组成的斑片 $P$，计算 $\\int_{\\partial P} \\mathbf{B}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s$。如果此积分为非零，则判定为失败，因为对于 $\\mathbf{B}_h$ 而言，$A_{z,h} \\in H^1$ 不满足 $H(\\mathrm{div})$协调性。\n\nD. 静电学，无电荷情况。在 $\\partial \\Omega$ 上规定狄利克雷数据 $\\phi = x$，用任何离散空间求解 $\\mathbf{D}_h$，并对两个三角形斑片中的每个单元 $K$ 计算单元散度积分 $\\int_{K} \\nabla \\cdot \\mathbf{D}_h \\, \\mathrm{d}\\Omega$。如果每个单元积分近似为零，则判定为成功，因为这证明了斑片中任何地方都没有伪电荷。\n\n选择正确的选项。", "solution": "必须首先验证问题陈述的科学和逻辑完整性。\n\n**步骤 1：提取已知条件**\n- **材料**：均匀、各向同性，介电常数 $\\varepsilon$ 为常数。\n- **域**：多边形域 $\\Omega \\subset \\mathbb{R}^2$。\n- **静电学定律**：$\\nabla \\cdot \\mathbf{D} = \\rho_f$，$\\mathbf{D} = \\varepsilon \\mathbf{E}$，$\\mathbf{E} = - \\nabla \\phi$。\n- **静磁学定律**：$\\nabla \\cdot \\mathbf{B} = 0$，$\\mathbf{B} = \\mu \\mathbf{H}$，$\\nabla \\times \\mathbf{H} = \\mathbf{J}$。\n- **无电荷条件**：对于 $\\rho_f = 0$，$\\nabla \\cdot \\mathbf{D} = 0$。根据散度定理，对于任何子域 $P \\subset \\Omega$，$\\int_{\\partial P} \\mathbf{D} \\cdot \\mathbf{n} \\, \\mathrm{d}s = 0$。\n- **FEM 失效模式**：对类通量未知数（如 $\\mathbf{D}$ 或 $\\mathbf{B}$）使用非协调矢量场空间（如分量连续的拉格朗日空间），不强制法向分量跨单元的连续性。这可能引入伪源，通过一小块单元 $P$ 上的非零净通量 $\\int_{\\partial P} \\mathbf{D}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s \\neq 0$ 来量化。\n- **任务**：设计一个最小的“斑片检验”来检测这些伪源。斑片 $P$ 是 $2$ 个三角形的并集。检验必须指明边界数据、构造的精确行为、测量值以及通过/失败标准。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述在科学上基于麦克斯韦方程组和有限元法（FEM）理论。函数空间如 $H(\\mathrm{div})$、协调与非协调近似以及斑片检验等概念，在计算工程中是标准和基础的。所描述的问题——由散度约束场的非 $H(\\mathrm{div})$ 协调近似引起的伪源——是一个众所周知的现象。该问题是适定的、客观的和自洽的，提供了评估所提出的检验设计所需的所有必要背景。这个问题并非无足轻重，因为它需要对数值误差的数学根源有精确的理解。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。着手求解。\n\n这个问题的核心基本物理定律是局部电荷守恒，在无电荷静电情况下表示为 $\\nabla \\cdot \\mathbf{D} = 0$。电通量密度的有限元近似 $\\mathbf{D}_h$ 位于一个合适的函数空间中。为了很好地近似条件 $\\nabla \\cdot \\mathbf{D} = 0$，$\\mathbf{D}_h$ 的空间理想上应为 $H(\\mathrm{div}, \\Omega) = \\{ \\mathbf{v} \\in [L^2(\\Omega)]^2 \\mid \\nabla \\cdot \\mathbf{v} \\in L^2(\\Omega) \\}$ 的一个子空间。这个空间中的元素在单元间边界上具有连续的法向分量。\n\n问题陈述中提到使用了一个非协调空间，例如，连续分片线性矢量场空间 $[P_1]^2$。虽然该空间中矢量的每个分量都是连续的，但法向分量 $\\mathbf{D}_h \\cdot \\mathbf{n}$ 在单元边上通常是不连续的。法向分量的这个跳跃，$[[\\mathbf{D}_h \\cdot \\mathbf{n}]]$, 在网格的骨架上充当伪表面电荷密度。\n\n一个合适的诊断检验必须能够检测到这些伪电荷的存在。根据散度定理，穿出闭合边界的净通量等于所包含的总电荷。对于一个单元斑片 $P$，总的伪电荷由其边界上的净通量积分来测量：$\\int_{\\partial P} \\mathbf{D}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s$。如果方法是协调且准确的，这个量应该接近于零，就像它对于精确解一样。一个非协调方法通常会使这个积分得到一个非零结果。该检验应基于一个简单的已知解，以分离出方法的误差。均匀场是最简单的非平凡情况。\n\n现在，我们评估每个提出的选项。\n\n**A. 静电学，无电荷情况。在 $\\partial \\Omega$ 上规定狄利克雷数据 $\\phi = x$，使用矢量场公式求解，其中电通量密度 $\\mathbf{D}_h$ 在三角形上的分量连续多项式空间 $[P_1]^2$ 中近似（即 $\\mathbf{D}_h \\in [C^0]^2$ 但不满足 $H(\\mathrm{div})$协调性）。对于由两个三角形组成的斑片 $P$，计算净向外通量 $\\int_{\\partial P} \\mathbf{D}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s$。如果在网格加密下该量不趋于 $0$，则判定为失败，因为精确解具有均匀电场 $\\mathbf{E}$，因此 $\\nabla \\cdot \\mathbf{D} = 0$。**\n\n这个检验设计是正确且稳健的。\n1.  **构造解**：在边界 $\\partial \\Omega$ 上规定 $\\phi = x$ 构造了一个精确解，其势函数在整个 $\\Omega$ 上为 $\\phi(x,y) = x$。这对应于一个均匀电场 $\\mathbf{E} = -\\nabla \\phi = (-1, 0)$ 和一个均匀通量密度 $\\mathbf{D} = \\varepsilon\\mathbf{E} = (-\\varepsilon, 0)$。这个精确场是无散的，$\\nabla \\cdot \\mathbf{D} = 0$，所以对于任何斑片 $P$，精确通量为 $\\int_{\\partial P} \\mathbf{D} \\cdot \\mathbf{n} \\, \\mathrm{d}s = 0$。\n2.  **FEM 空间**：它正确地将 $[P_1]^2$（或更一般地 $[C^0]^2$）识别为非 $H(\\mathrm{div})$ 协调空间。\n3.  **测量**：测量值为 $\\int_{\\partial P} \\mathbf{D}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s$。如前所述，这个积分精确地测量了斑片 $P$ 内包含的净伪电荷，这些伪电荷源于 $\\mathbf{D}_h$ 法向分量在斑片内部边上的非零跳跃。\n4.  **标准**：如果该量与 $0$ 有显著差异（或不如预期那样收敛到 $0$），则判定为失败，这是诊断违反局部电荷守恒的正确方法。\n该选项直接且正确地针对问题陈述中描述的失效模式。\n\n结论：**正确**。\n\n**B. 静电学，无电荷情况。在 $\\partial \\Omega$ 上规定狄利克雷数据 $\\phi = x$，用任何公式求解，并对由两个三角形组成的斑片 $P$ 计算切向分量的线积分 $\\int_{\\partial P} \\mathbf{E}_h \\cdot \\mathbf{t} \\, \\mathrm{d}s$。如果此积分为非零，则判定为失败，因为非零的切向环量表示在单元间面上产生了伪电荷。**\n\n这个检验是错误的。积分 $\\int_{\\partial P} \\mathbf{E}_h \\cdot \\mathbf{t} \\, \\mathrm{d}s$ 表示电场沿斑片边界的环量。在静电学中，电场是保守的，意味着 $\\mathbf{E} = -\\nabla\\phi$，这表明其旋度为零：$\\nabla \\times \\mathbf{E} = 0$。根据斯托克斯定理，沿任何闭合回路的环量为零。非零环量将表明违反了 $\\nabla \\times \\mathbf{E} = 0$，即存在伪旋度，而不是伪散度（电荷）。此外，非零环量指示“伪电荷产生”的理由在物理上是错误的。$\\mathbf{E}$ 的环量与变化的磁场有关（法拉第定律），而不是静电荷。此检验诊断的是一种不同类型的误差，与 $H(\\mathrm{curl})$协调性相关，而与 $H(\\mathrm{div})$协调性无关。\n\n结论：**错误**。\n\n**C. 静磁学，无电流情况。使用磁矢量势公式，其中标量势 $A_z$ 在 $H^1(\\Omega)$ 中，因此 $\\mathbf{B}_h = \\nabla \\times (A_{z,h} \\mathbf{e}_z)$。对于由两个三角形组成的斑片 $P$，计算 $\\int_{\\partial P} \\mathbf{B}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s$。如果此积分为非零，则判定为失败，因为对于 $\\mathbf{B}_h$ 而言，$A_{z,h} \\in H^1$ 不满足 $H(\\mathrm{div})$协调性。**\n\n这个检验设计不当，因为它保证会通过，使其作为诊断工具毫无用处。基本定律 $\\nabla \\cdot \\mathbf{B} = 0$ 在 $\\mathbf{B}$ 被定义为矢量势 $\\mathbf{A}$ 的旋度时是恒成立的，因为旋度的散度恒为零：$\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$。这对离散近似也同样适用：$\\mathbf{B}_h = \\nabla \\times \\mathbf{A}_h$ 意味着 $\\nabla \\cdot \\mathbf{B}_h = 0$ 是精确满足的（在分布意义上）。因此，根据散度定理，穿出任何斑片 $P$ 的净通量将恒为零：$\\int_{\\partial P} \\mathbf{B}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s = \\int_P \\nabla \\cdot \\mathbf{B}_h \\, \\mathrm{d}\\Omega = \\int_P 0 \\, \\mathrm{d}\\Omega = 0$。这种公式，由于其自身结构，避免了伪磁单极子（伪散度）。因此，这个检验不可能失败，也无法检测任何误差，包括所讨论的误差。\n\n结论：**错误**。\n\n**D. 静电学，无电荷情况。在 $\\partial \\Omega$ 上规定狄利克雷数据 $\\phi = x$，用任何离散空间求解 $\\mathbf{D}_h$，并对两个三角形斑片中的每个单元 $K$ 计算单元散度积分 $\\int_{K} \\nabla \\cdot \\mathbf{D}_h \\, \\mathrm{d}\\Omega$。如果每个单元积分近似为零，则判定为成功，因为这证明了斑片中任何地方都没有伪电荷。**\n\n这个检验是不充分的。非 $H(\\mathrm{div})$ 协调空间问题的核心在于单元间边界上法向通量分量的不连续性，这会产生伪*表面*电荷。这个检验只检查每个单元内的伪*体*电荷。根据散度定理，$\\int_K \\nabla \\cdot \\mathbf{D}_h \\, \\mathrm{d}\\Omega = \\int_{\\partial K} \\mathbf{D}_h \\cdot \\mathbf{n} \\, \\mathrm{d}s$。对于某些有限元公式（例如，带有分片常数检验函数的混合方法用于散度约束），可以强制对每个单元 $K$ 该积分为零。然而，这只意味着从每个单独单元流出的总通量为零。它不能阻止一个大的伪通量从一个单元穿过共享边流出，而一个不相关的通量进入相邻单元，从而违反局部守恒。该检验完全没有探测单元间的界面条件，而这正是误差表现出来的地方。基于此测量宣布成功将导致假阳性，因为关键的误差机制没有被测量。\n\n结论：**错误**。\n\n总之，只有选项 A 正确地构建了一个斑片检验，该检验对由通量场的非 $H(\\mathrm{div})$ 协调近似导致的伪散度这种特定失效模式敏感。", "answer": "$$\\boxed{A}$$", "id": "2553554"}, {"introduction": "在理解了为何需要为电磁场问题设计专门的单元之后，接下来的重点是掌握如何实际使用它们。本练习将介绍在静磁学中至关重要的 Nedelec 边单元，它是一种能够确保切向连续性的 $H(\\mathrm{curl})$ 协调元。通过这个练习，您将获得推导单元刚度矩阵的具体实践经验[@problem_id:2553591]，这是编写任何有限元代码都必须掌握的核心步骤。", "problem": "考虑一个单连通、无源、各向同性的区域，其磁导率为常数 $\\mu$。从麦克斯韦方程组推导出的旋度-旋度公式出发，在单个四面体单元上使用最低阶 Nedelec（第一类）边单元的有限元方法（FEM）。设该四面体为参考单纯形，其顶点为 $x_{1}=(0,0,0)$、$x_{2}=(1,0,0)$、$x_{3}=(0,1,0)$ 和 $x_{4}=(0,0,1)$，并设局部边的方向为从编号较小的顶点指向编号较大的顶点，顺序为 $(1,2)$、$(1,3)$、$(1,4)$、$(2,3)$、$(2,4)$、$(3,4)$。用 $\\lambda_{a}$（$a=1,2,3,4$）表示重心坐标，并使用定义在边 $(a,b)$ 上的规范最低阶 Nedelec 基函数 $\\mathbf{N}_{ab}=\\lambda_{a}\\nabla \\lambda_{b}-\\lambda_{b}\\nabla \\lambda_{a}$。\n\n1) 推导单元刚度矩阵 $\\mathbf{K}_{e}$，其元素为\n$$\nK_{(ab),(cd)} \\;=\\; \\int_{K} \\mu^{-1} \\big(\\nabla \\times \\mathbf{N}_{ab}\\big)\\cdot\\big(\\nabla \\times \\mathbf{N}_{cd}\\big)\\, \\mathrm{d}V,\n$$\n其中 $(a,b)$ 和 $(c,d)$ 是按给定顺序的所有局部边。\n\n2) 假设此单个四面体（其全局方向与局部方向一致，即从编号较小的顶点指向编号较大的顶点）的全局边编号由以下边到索引的无序列表关联给出\n$$\n(1,3)\\mapsto 7,\\quad (1,2)\\mapsto 4,\\quad (3,4)\\mapsto 12,\\quad (1,4)\\mapsto 9,\\quad (2,4)\\mapsto 11,\\quad (2,3)\\mapsto 8.\n$$\n请指明从局部自由度（DOF）到全局自由度的映射，包括每个局部边相对于其全局方向的方向符号。\n\n作为最终答案，报告此单元的标量值 $S=\\mu\\, \\mathrm{tr}(\\mathbf{K}_{e})$。无需四舍五入，您应提供一个精确值。根据其构造，最终报告的标量 $S$ 是无量纲的，并且必须以单个实数的形式给出。", "solution": "所述问题具有科学依据，提法恰当且完整。它展示了一个静磁学有限元方法（FEM）的标准练习。所有必要数据，包括单元的几何形状、基函数的定义以及刚度矩阵的公式，均已提供。因此，该问题被认为是有效的。我将继续进行解答。\n\n问题要求推导单元刚度矩阵 $\\mathbf{K}_e$ 并计算标量值 $S = \\mu \\, \\mathrm{tr}(\\mathbf{K}_e)$。\n\n无源区域中静磁学的控制方程为 $\\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{A}) = \\mathbf{0}$，其中 $\\mathbf{A}$ 是磁矢量势。相应的弱形式可导出单元刚度矩阵的元素：\n$$\nK_{(ab),(cd)} = \\int_{K} \\mu^{-1} (\\nabla \\times \\mathbf{N}_{ab}) \\cdot (\\nabla \\times \\mathbf{N}_{cd}) \\, \\mathrm{d}V\n$$\n其中 $K$ 是四面体单元的体积，$\\mathbf{N}_{ab}$ 是最低阶 Nedelec 边基函数。连接顶点 $a$ 和 $b$ 的边的基函数由下式给出：\n$$\n\\mathbf{N}_{ab} = \\lambda_a \\nabla \\lambda_b - \\lambda_b \\nabla \\lambda_a\n$$\n其中 $\\lambda_i$ 是重心坐标。\n\n首先，我们确定所指定的参考四面体的属性。顶点为 $x_1=(0,0,0)$、$x_2=(1,0,0)$、$x_3=(0,1,0)$ 和 $x_4=(0,0,1)$。重心坐标 $\\lambda_i(\\mathbf{x})$ 是关于位置 $\\mathbf{x}=(x,y,z)$ 的线性函数，满足 $\\lambda_i(x_j) = \\delta_{ij}$。对于这个特定的四面体，它们是：\n$$\n\\lambda_1(\\mathbf{x}) = 1 - x - y - z\n$$\n$$\n\\lambda_2(\\mathbf{x}) = x\n$$\n$$\n\\lambda_3(\\mathbf{x}) = y\n$$\n$$\n\\lambda_4(\\mathbf{x}) = z\n$$\n重心坐标的梯度是常数向量：\n$$\n\\mathbf{g}_1 = \\nabla \\lambda_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\mathbf{g}_2 = \\nabla \\lambda_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{g}_3 = \\nabla \\lambda_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{g}_4 = \\nabla \\lambda_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n该四面体的体积为 $V_K = \\frac{1}{6} |(x_2-x_1) \\cdot ((x_3-x_1) \\times (x_4-x_1))| = \\frac{1}{6}$。\n\n接下来，我们计算基函数 $\\mathbf{N}_{ab}$ 的旋度。使用向量恒等式 $\\nabla \\times (f \\mathbf{G}) = (\\nabla f) \\times \\mathbf{G} + f(\\nabla \\times \\mathbf{G})$，并注意到 $\\nabla \\lambda_i$ 是常数向量（因此其旋度为零），我们得到：\n$$\n\\nabla \\times \\mathbf{N}_{ab} = \\nabla \\times (\\lambda_a \\nabla \\lambda_b) - \\nabla \\times (\\lambda_b \\nabla \\lambda_a)\n= (\\nabla \\lambda_a \\times \\nabla \\lambda_b) - (\\nabla \\lambda_b \\times \\nabla \\lambda_a)\n= 2 (\\nabla \\lambda_a \\times \\nabla \\lambda_b)\n$$\n由于梯度是常数，每个基函数的旋度 $\\nabla \\times \\mathbf{N}_{ab}$ 在单元 $K$ 上是一个常数向量。我们记 $\\mathbf{C}_{ab} = \\nabla \\lambda_a \\times \\nabla \\lambda_b$。\n\n刚度矩阵的积分大大简化：\n$$\nK_{(ab),(cd)} = \\int_{K} \\mu^{-1} (2 \\mathbf{C}_{ab}) \\cdot (2 \\mathbf{C}_{cd}) \\, \\mathrm{d}V = \\frac{4}{\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd}) \\int_{K} \\mathrm{d}V = \\frac{4 V_K}{\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd})\n$$\n代入 $V_K = 1/6$，我们得到：\n$$\nK_{(ab),(cd)} = \\frac{4}{6\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd}) = \\frac{2}{3\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd})\n$$\n\n局部边的顺序为 $e_1=(1,2)$、$e_2=(1,3)$、$e_3=(1,4)$、$e_4=(2,3)$、$e_5=(2,4)$、$e_6=(3,4)$。我们计算相应的旋度向量 $\\mathbf{C}_{ab}$：\n$$\n\\mathbf{C}_{12} = \\mathbf{g}_1 \\times \\mathbf{g}_2 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} \\times \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{13} = \\mathbf{g}_1 \\times \\mathbf{g}_3 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{14} = \\mathbf{g}_1 \\times \\mathbf{g}_4 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{23} = \\mathbf{g}_2 \\times \\mathbf{g}_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{24} = \\mathbf{g}_2 \\times \\mathbf{g}_4 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{34} = \\mathbf{g}_3 \\times \\mathbf{g}_4 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n现在，我们计算点积矩阵 $[\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd}]$。设旋度向量的有序集合为 $\\{\\mathbf{v}_1, \\dots, \\mathbf{v}_6\\} = \\{\\mathbf{C}_{12}, \\mathbf{C}_{13}, \\mathbf{C}_{14}, \\mathbf{C}_{23}, \\mathbf{C}_{24}, \\mathbf{C}_{34}\\}$。点积矩阵 $\\mathbf{v}_i \\cdot \\mathbf{v}_j$ 为：\n$$\n\\begin{pmatrix}\n2  -1  -1  1  1  0 \\\\\n-1  2  -1  -1  0  1 \\\\\n-1  -1  2  0  -1  -1 \\\\\n1  -1  0  1  0  0 \\\\\n1  0  -1  0  1  0 \\\\\n0  1  -1  0  0  1\n\\end{pmatrix}\n$$\n\n1) 单元刚度矩阵 $\\mathbf{K}_e$ 是该矩阵乘以 $\\frac{2}{3\\mu}$：\n$$\n\\mathbf{K}_{e} = \\frac{2}{3\\mu}\n\\begin{pmatrix}\n2  -1  -1  1  1  0 \\\\\n-1  2  -1  -1  0  1 \\\\\n-1  -1  2  0  -1  -1 \\\\\n1  -1  0  1  0  0 \\\\\n1  0  -1  0  1  0 \\\\\n0  1  -1  0  0  1\n\\end{pmatrix} = \\frac{1}{3\\mu} \\begin{pmatrix}\n4  -2  -2  2  2  0 \\\\\n-2  4  -2  -2  0  2 \\\\\n-2  -2  4  0  -2  -2 \\\\\n2  -2  0  2  0  0 \\\\\n2  0  -2  0  2  0 \\\\\n0  2  -2  0  0  2\n\\end{pmatrix}\n$$\n\n2) 确定从局部自由度（DOF）到全局自由度的映射。\n局部自由度按边排序：$1 \\to (1,2)$、$2 \\to (1,3)$、$3 \\to (1,4)$、$4 \\to (2,3)$、$5 \\to (2,4)$、$6 \\to (3,4)$。\n对于边 $(a,b)$ 且 $a  b$，局部方向是从 $a$ 到 $b$。\n全局自由度由以下映射给出：$(1,2) \\mapsto 4, (1,3) \\mapsto 7, (1,4) \\mapsto 9, (2,3) \\mapsto 8, (2,4) \\mapsto 11, (3,4) \\mapsto 12$。\n全局方向也是从编号较小的顶点指向编号较大的顶点。\n由于所有边的局部和全局方向都匹配，因此所有自由度的方向符号均为 $+1$。映射如下：\n- 局部自由度 1（边 $(1,2)$）映射到全局自由度 $4$，符号为 $+1$。\n- 局部自由度 2（边 $(1,3)$）映射到全局自由度 $7$，符号为 $+1$。\n- 局部自由度 3（边 $(1,4)$）映射到全局自由度 $9$，符号为 $+1$。\n- 局部自由度 4（边 $(2,3)$）映射到全局自由度 $8$，符号为 $+1$。\n- 局部自由度 5（边 $(2,4)$）映射到全局自由度 $11$，符号为 $+1$。\n- 局部自由度 6（边 $(3,4)$）映射到全局自由度 $12$，符号为 $+1$。\n\n最后，我们计算标量值 $S = \\mu \\, \\mathrm{tr}(\\mathbf{K}_e)$。这是矩阵 $\\mu \\mathbf{K}_e$ 的迹。\n$$\n\\mu \\mathbf{K}_e = \\frac{2}{3}\n\\begin{pmatrix}\n2  -1  -1  1  1  0 \\\\\n-1  2  -1  -1  0  1 \\\\\n-1  -1  2  0  -1  -1 \\\\\n1  -1  0  1  0  0 \\\\\n1  0  -1  0  1  0 \\\\\n0  1  -1  0  0  1\n\\end{pmatrix}\n$$\n迹是对角元素之和：\n$$\nS = \\mathrm{tr}(\\mu \\mathbf{K}_e) = \\frac{2}{3} (2 + 2 + 2 + 1 + 1 + 1) = \\frac{2}{3} (9) = 6\n$$\n该问题是在具有无量纲坐标的参考单元上设置的，这使得计算出的值 $S$ 成为无量纲量，正如问题描述中所述。", "answer": "$$\\boxed{6}$$", "id": "2553591"}, {"introduction": "有限元法的应用常常需要从理想化的几何模型过渡到包含尖锐拐角的现实场景，而这些几何特征会在解中引入“奇异性”（singularities），从而严重降低标准有限元方法的计算精度。本练习旨在探讨如何应对这一挑战，您将学习如何分析静电势在所谓的“凹角”附近的奇异行为，并据此设计一个“分级网格”（graded mesh）策略 [@problem_id:2553552]。这是一种高级计算建模中的关键技术，能够有效恢复有限元法的最优收敛率。", "problem": "考虑一个平面多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 中的静电学问题，该域在原点处有一个内角为 $\\omega \\in (\\pi,2\\pi)$ 的凹角。静电势 $\\phi$ 满足从麦克斯韦静电场方程组导出的无源控制方程，\n$$\n-\\nabla \\cdot (\\varepsilon \\nabla \\phi) = 0 \\quad \\text{in } \\Omega,\n$$\n并在边界 $\\partial \\Omega$ 上满足齐次狄利克雷边界条件 $\\phi = 0$，其中介电常数 $\\varepsilon$ 在角点的一个邻域内为正常数标量。假设在一族形状规则的三角剖分上采用协调、分片线性的有限元法（FEM）进行离散化，并且通过径向分级策略将网格加密局部化到凹角的一个邻域内，而在远离角点的区域保持准均匀。\n\n你的任务是确定角点附近 $\\phi$ 的主阶行为，并选择一个径向网格分级律 $h(r) \\simeq C r^{\\alpha}$（其中 $r$ 是到角点的距离，$C0$ 是一个常数），该分级律能够恢复相对于总自由度数 $N$ 的可能的最优 $H^{1}$-误差率。此处，“最优”指的是在二维情况下对光滑解成立的误差率，即\n$$\n\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} = \\mathcal{O}(N^{-1/2}).\n$$\n请选择一个选项，该选项正确且一致地陈述了：(i) 角点附近 $\\phi$ 主项的奇异指数和角相关性，(ii) 实现最优 $H^{1}$-误差率的分级指数 $\\alpha$，以及 (iii) 由此得到的以 $N$ 表示的 $H^{1}$-误差率。\n\nA. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 会得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。\n\nB. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\omega/\\pi$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 会得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。\n\nC. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\cos(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda}$ 会得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。\n\nD. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。准均匀网格（无分级，$h$ 与 $r$ 无关）已经可以得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知条件\n-   **域**：一个平面多边形域 $\\Omega \\subset \\mathbb{R}^{2}$，在原点处有一个凹角。\n-   **角点内角**：角点的内角为 $\\omega \\in (\\pi, 2\\pi)$。\n-   **控制方程**：静电势 $\\phi$ 满足 $-\\nabla \\cdot (\\varepsilon \\nabla \\phi) = 0$ in $\\Omega$。\n-   **介电常数**：$\\varepsilon$ 在角点附近为正常数标量。\n-   **边界条件**：齐次狄利克雷条件，$\\phi = 0$ on $\\partial \\Omega$。\n-   **数值方法**：在形状规则的三角剖分上采用协调、分片线性的有限元法（FEM）。\n-   **网格策略**：角点附近采用径向分级网格，单元尺寸 $h(r) \\simeq C r^{\\alpha}$（$r0$），其中 $r$ 是离角点的距离。网格在远离角点处是准均匀的。\n-   **目标**：确定 $\\phi$ 在角点附近的主阶行为和所需的分级指数 $\\alpha$，以实现“最优” $H^{1}$-误差率，定义为 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} = \\mathcal{O}(N^{-1/2})$，其中 $N$ 是自由度数。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了非凸多边形域上的拉普拉斯方程（$\\Delta \\phi = 0$，因为 $\\varepsilon$ 是常数）。这是势理论和计算电磁学中的一个经典问题。解中存在角点奇点是一个公认的数学事实。在有限元法中使用分级网格来改善奇异解的收敛率是数值分析中一种标准且有充分依据的技术。该问题在科学上和数学上都是合理的。\n2.  **适定性**：有界域上带有齐次狄利克雷边界条件的拉普拉斯方程是一个适定的椭圆边值问题，在索博列夫空间 $H_0^1(\\Omega)$ 中存在唯一的弱解。所提出的问题是精确的，并且在有限元法理论框架内有确切的答案。\n3.  **客观性**：语言正式且无歧义。所有术语如“$H^1$-误差”、“自由度”和“形状规则”都有精确的数学定义。\n4.  **完整性**：该问题提供了确定解的奇点和推导最优网格分级策略所需的所有必要信息。\n\n### 步骤3：结论与行动\n问题陈述是有效的。这是偏微分方程数值分析中的一个标准、适定的问题。可以开始求解过程。\n\n---\n\n### 解的推导\n\n分析过程分为三部分：确定解的奇点，推导最优网格分级，以及评估最终的收敛率。\n\n**第一部分：凹角处的解的奇点**\n\n在原点附近，由于 $\\varepsilon$ 是常数，控制方程即为拉普拉斯方程。在极坐标 $(r, \\theta)$ 中，拉普拉斯方程为：\n$$\n\\frac{\\partial^2 \\phi}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial \\phi}{\\partial r} + \\frac{1}{r^2} \\frac{\\partial^2 \\phi}{\\partial \\theta^2} = 0\n$$\n我们寻求一个分离变量形式的解 $\\phi(r, \\theta) = R(r) \\Theta(\\theta)$。将此代入方程可得：\n$$\n\\frac{r^2 R''(r) + r R'(r)}{R(r)} = - \\frac{\\Theta''(\\theta)}{\\Theta(\\theta)} = \\mu\n$$\n其中 $\\mu$ 是分离常数。这引出两个常微分方程：\n$$\n\\Theta''(\\theta) + \\mu \\Theta(\\theta) = 0\n$$\n$$\nr^2 R''(r) + r R'(r) - \\mu R(r) = 0\n$$\n第二个方程是柯西-欧拉方程，其通解为 $R(r) = c_1 r^{\\sqrt{\\mu}} + c_2 r^{-\\sqrt{\\mu}}$。为了使解具有有限能量（即 $\\phi \\in H^1(\\Omega)$），必须舍弃负幂次项 $r^{-\\sqrt{\\mu}}$，因为它会导致在 $r=0$ 附近能量积分为无穷大。因此我们设 $c_2=0$ 并令 $\\lambda = \\sqrt{\\mu}$，所以 $R(r) = c_1 r^\\lambda$ 且 $\\lambda  0$。\n\n角向部分由 $\\Theta''(\\theta) + \\lambda^2 \\Theta(\\theta) = 0$ 控制，其通解为 $\\Theta(\\theta) = A \\cos(\\lambda \\theta) + B \\sin(\\lambda \\theta)$。齐次狄利克雷边界条件 $\\phi=0$ 应用于构成角点的两条边。我们调整坐标系，使这两条边对应于 $\\theta=0$ 和 $\\theta=\\omega$。\n-   $\\phi(r, 0) = 0 \\implies \\Theta(0) = 0 \\implies A \\cos(0) + B \\sin(0) = A = 0$。\n解的形式必须为 $\\Theta(\\theta) = B \\sin(\\lambda \\theta)$。\n-   $\\phi(r, \\omega) = 0 \\implies \\Theta(\\omega) = 0 \\implies B \\sin(\\lambda \\omega) = 0$。\n为了得到非平凡解（$B \\neq 0$），我们要求 $\\sin(\\lambda \\omega) = 0$。这意味着 $\\lambda \\omega = k \\pi$，其中 $k \\ge 1$ 为整数。\n\n解是一个级数，形式为 $\\phi(r, \\theta) = \\sum_{k=1}^{\\infty} c_k r^{k\\pi/\\omega} \\sin(k\\pi\\theta/\\omega)$。角点附近（$r \\to 0$）的主阶行为由具有最小正指数 $\\lambda$ 的项决定。这对应于 $k=1$：\n$$\n\\lambda = \\frac{\\pi}{\\omega}\n$$\n由于角是凹角，$\\omega \\in (\\pi, 2\\pi)$，这意味着奇异指数 $\\lambda = \\pi/\\omega$ 在范围 $(1/2, 1)$ 内。解不属于 $H^2(\\Omega)$，因为它的二阶导数行为如 $r^{\\lambda-2}$，在 $r=0$ 附近不是平方可積的。\n因此，主项为 $\\phi(r,\\theta) \\approx C r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。\n\n**第二部分：最优网格分级**\n\n对于光滑解，在二维（$d=2$）情况下，分片线性有限元法（$p=1$）得到的 $H^1$-误差率为 $\\|\\nabla(\\phi-\\phi_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h)$，其中 $h$ 是网格尺寸。对于准均匀网格（$h = \\text{const}$），自由度数 $N$ 的缩放关系为 $N \\propto h^{-2}$，因此误差率为 $\\mathcal{O}(N^{-1/2})$。\n\n由于存在奇点 $\\phi \\sim r^\\lambda$（$\\lambda  1$），在准均匀网格上的收敛率会恶化为 $\\|\\nabla(\\phi-\\phi_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h^\\lambda) = \\mathcal{O}(N^{-\\lambda/2})$。由于 $\\lambda  1$，这个速率是次优的。\n\n为了恢复最优速率 $\\mathcal{O}(N^{-1/2})$，必须对网格进行分级。最优网格设计的原则是在所有单元上均分插值误差。单元 $K$ 上的局部 $H^1$ 插值误差由 $C h_K |\\phi|_{H^2(K)}$ 界定。我们希望对所有单元 $K$，$h_K |\\phi|_{H^2(K)}$ 近似为常数。\n解的奇异部分的二阶导数行为如 $|\\nabla^2 \\phi| \\sim r^{\\lambda-2}$。严格的分析表明，在离角点距离为 $r$、尺寸为 $h(r)$ 的单元 $K$ 上，局部 $H^2$ 半范数行为如 $|\\phi|_{H^2(K)} \\sim h(r) r^{\\lambda-2}$。\n均分原则 $h(r) |\\phi|_{H^2(K)} \\approx \\text{const}$ 变为：\n$$\nh(r) \\cdot [h(r) r^{\\lambda-2}] \\approx \\text{const} \\implies h(r)^2 r^{\\lambda-2} \\approx \\text{const}\n$$\n$$\nh(r)^2 \\propto r^{2-\\lambda} \\implies h(r) \\propto r^{1-\\lambda/2}\n$$\n因此，所需的分级指数为 $\\alpha = 1 - \\lambda/2$。\n\n采用这种分级，$h(r) = C r^{1-\\lambda/2}$，误差得到控制。单元/顶点的总数 $N$ 由奇点附近最精细的网格部分主导。设 $h_{min}$ 是最小单元尺寸。更有用的是，设 $h_{max}$ 是准均匀部分网格的单元尺寸。可以证明，顶点总数 $N$ 的缩放关系为 $N \\propto h_{max}^{-2}$。误差分析证实，采用这种分级，$\\|\\nabla(\\phi-\\phi_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h_{max}) = \\mathcal{O}(N^{-1/2})$，恢复了最优速率。\n\n### 逐项分析\n\n**A. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 会得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   主项的形式和指数 $\\lambda = \\pi/\\omega$ 是正确的，如上文推导。\n-   对于分片线性单元，分级律 $h(r) \\simeq C r^{\\alpha}$ 且 $\\alpha = 1 - \\lambda/2$ 是恢复最优 $H^1$-误差率的正确选择。\n-   最终的误差率 $\\mathcal{O}(N^{-1/2})$ 确实是该分级策略所能达到的“最优”速率。\n这个陈述完全一致且正确。\n结论：**正确**。\n\n**B. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\omega/\\pi$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 会得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   奇异指数被陈述为 $\\lambda = \\omega/\\pi$。由于 $\\omega \\in (\\pi, 2\\pi)$，该指数将大于1。决定主导奇异行为的最小正指数是 $\\pi/\\omega  1$。因此，这个陈述不正确。\n结论：**不正确**。\n\n**C. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\cos(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda}$ 会得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   角相关性被给出为 $\\cos(\\lambda \\theta)$。这违反了在 $\\theta=0$ 处的边界条件 $\\phi=0$，因此不正确。\n-   分级指数被陈述为 $\\alpha = 1-\\lambda$。这不是优化 $H^1$-误差的正确指数。\n结论：**不正确**。\n\n**D. 主项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。准均匀网格（无分级，$h$ 与 $r$ 无关）已经可以得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   关于准均匀网格能达到最优速率的说法是根本错误的。如推导所示，准均匀网格会导致一个次优的收敛率 $\\mathcal{O}(N^{-\\lambda/2})$，其中 $\\lambda = \\pi/\\omega  1$。网格分级的目的正是为了克服这个缺陷。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2553552"}]}