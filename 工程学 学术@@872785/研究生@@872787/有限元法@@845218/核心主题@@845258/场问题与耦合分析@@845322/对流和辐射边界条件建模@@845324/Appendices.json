{"hands_on_practices": [{"introduction": "在深入研究复杂的有限元方法（FEM）公式之前，掌握基本物理原理至关重要。本练习旨在强调在辐射传热计算中使用绝对温标的根本重要性。通过量化因误用摄氏温标而非开尔文温标所导致的误差，它清晰地揭示了一个看似微小的疏忽如何导致灾难性的错误结果，这对于任何进行热分析的工程师或科学家来说都是一个基础且关键的知识点。[@problem_id:2549197]", "problem": "一根长度为 $L$ 的一维热棒使用有限元法 (FEM) 进行建模。在边界 $x=L$ 处，通过对流和热辐射两种方式与温度为 $T_{\\infty}$ 的环境进行热交换。$x=L$ 处的表面温度为 $T_{s}$。进入弱形式自然边界积分的边界牵引力（向外热通量）是对流项和辐射项之和。从以下基本事实出发：(i) 牛顿冷却定律指出对流热通量与温差成正比，(ii) 黑体发射的斯蒂芬-玻尔兹曼定律指出发射功率与绝对温度的四次方成正比，请推导一个发射率为 $\\epsilon$ 的漫-灰表面与其周围环境之间的净辐射热通量的正确表达式。然后，假设一位工程师在计算辐射边界牵引力时，错误地将以摄氏度表示的温度而非以开尔文为单位的绝对温度代入了四次方关系中。\n\n对于 $T_{s}=120\\,^{\\circ}\\mathrm{C}$ 和 $T_{\\infty}=25\\,^{\\circ}\\mathrm{C}$ 的特定情况，其中发射率 $\\epsilon$ 和斯蒂芬-玻尔兹曼常数 $\\sigma$ 视为给定的物理常数，计算仅因使用摄氏度而非开尔文所导致的辐射牵引力贡献的有符号相对误差，其定义为\n$$\\delta \\equiv \\frac{q_{\\text{wrong}}-q_{\\text{correct}}}{q_{\\text{correct}}},$$\n其中 $q_{\\text{wrong}}$ 是使用摄氏度计算的辐射项，$q_{\\text{correct}}$ 是使用开尔文绝对温度计算的辐射项。请将最终答案表示为一个无量纲小数（而非百分比），并四舍五入到四位有效数字。", "solution": "问题陈述已经过评估，被认为是有效的。它具有科学依据，问题适定且客观。这是一个传热学中标准但初等的问题，旨在说明在涉及斯蒂芬-玻尔兹曼定律的计算中使用绝对温标的至关重要性。我们现在开始进行正式求解。\n\n首先，我们必须推导净辐射热通量的表达式，它是在有限元法公式中的边界牵引力贡献。位于 $x=L$ 处的表面被描述为一个温度为 $T_s$、发射率为 $\\epsilon$ 的漫-灰表面，与温度为 $T_{\\infty}$ 的大环境进行热交换。\n\n1.  **发射**：根据斯蒂芬-玻尔兹曼定律，一个真实（灰）表面的发射功率由 $E = \\epsilon \\sigma T_s^4$ 给出，其中 $\\sigma$ 是斯蒂芬-玻尔兹曼常数，$T_s$ 是以开尔文为单位的绝对表面温度。这是单位面积表面辐射出去的能量。\n\n2.  **辐照与吸收**：周围环境被视为一个大的包壳，其行为类似于一个绝对温度为 $T_{\\infty}$ 的黑体辐射器。因此，从周围环境投射到该表面的辐射（称为辐照度）为 $G = \\sigma T_{\\infty}^4$。该表面会吸收一部分入射辐射。根据基尔霍夫热辐射定律的推论，一个灰表面的吸收率 $\\alpha$ 等于其发射率 $\\epsilon$。因此，吸收的辐射通量为 $G_{abs} = \\alpha G = \\epsilon \\sigma T_{\\infty}^4$。\n\n3.  **净通量**：净辐射热通量 $q_{\\text{rad}}$ 是发射通量与吸收通量之差。它代表了单位面积表面由于辐射而净流失的能量速率。\n    $$q_{\\text{rad}} = E - G_{abs} = \\epsilon \\sigma T_s^4 - \\epsilon \\sigma T_{\\infty}^4$$\n    这可以简化为辐射边界牵引力的正确表达式：\n    $$q_{\\text{correct}} = \\epsilon \\sigma (T_s^4 - T_{\\infty}^4)$$\n    必须认识到，此方程中的 $T_s$ 和 $T_{\\infty}$ 必须使用绝对温标（如开尔文 $(\\mathrm{K})$）来表示。\n\n现在，我们计算由上述错误所引起的相对误差。工程师错误地使用了以摄氏度 $(^{\\circ}\\mathrm{C})$ 表示的温度，而不是开尔文。给定表面温度 $T_{s,C} = 120 \\,^{\\circ}\\mathrm{C}$ 和环境温度 $T_{\\infty,C} = 25 \\,^{\\circ}\\mathrm{C}$。\n\n从摄氏度到开尔文的转换公式为 $T_K = T_C + 273.15$。\n正确的绝对温度为：\n$T_{s,K} = 120 + 273.15 = 393.15 \\, \\mathrm{K}$\n$T_{\\infty,K} = 25 + 273.15 = 298.15 \\, \\mathrm{K}$\n\n正确的辐射通量为：\n$$q_{\\text{correct}} = \\epsilon \\sigma (T_{s,K}^4 - T_{\\infty,K}^4) = \\epsilon \\sigma \\left( (393.15)^4 - (298.15)^4 \\right)$$\n\n直接使用摄氏度值错误计算的通量为：\n$$q_{\\text{wrong}} = \\epsilon \\sigma (T_{s,C}^4 - T_{\\infty,C}^4) = \\epsilon \\sigma \\left( (120)^4 - (25)^4 \\right)$$\n\n有符号相对误差 $\\delta$ 定义为：\n$$\\delta = \\frac{q_{\\text{wrong}} - q_{\\text{correct}}}{q_{\\text{correct}}}$$\n代入通量的表达式：\n$$\\delta = \\frac{\\epsilon \\sigma (T_{s,C}^4 - T_{\\infty,C}^4) - \\epsilon \\sigma (T_{s,K}^4 - T_{\\infty,K}^4)}{\\epsilon \\sigma (T_{s,K}^4 - T_{\\infty,K}^4)}$$\n项 $\\epsilon \\sigma$ 是一个非零公因子，可以消去，剩下：\n$$\\delta = \\frac{T_{s,C}^4 - T_{\\infty,C}^4}{T_{s,K}^4 - T_{\\infty,K}^4} - 1$$\n\n我们现在代入数值：\n分子计算：\n$$T_{s,C}^4 - T_{\\infty,C}^4 = (120)^4 - (25)^4 = 207360000 - 390625 = 206969375$$\n分母计算：\n$$T_{s,K}^4 - T_{\\infty,K}^4 = (393.15)^4 - (298.15)^4 \\approx 2.39025 \\times 10^{10} - 7.89617 \\times 10^9 = 1.60063 \\times 10^{10}$$\n精确差值为 $16006345000$。\n\n现在我们计算该比率：\n$$\\frac{T_{s,C}^4 - T_{\\infty,C}^4}{T_{s,K}^4 - T_{\\infty,K}^4} = \\frac{206969375}{16006345000} \\approx 0.0129304$$\n\n最后，我们计算相对误差 $\\delta$：\n$$\\delta = 0.0129304 - 1 = -0.9870696$$\n\n题目要求答案四舍五入到四位有效数字。前四位有效数字是 $9, 8, 7, 0$。其后一位数字是 $6$，所以我们将最后一位有效数字向上取整。\n$$\\delta \\approx -0.9871$$\n这个巨大的负误差表明，错误的计算严重低估了真实的辐射热通量，其结果仅为正确值的大约 $1.3\\%$。这样的错误不仅仅是数值上的差异，更是物理推理上的根本性失败，会导致灾难性的设计缺陷。", "answer": "$$\\boxed{-0.9871}$$", "id": "2549197"}, {"introduction": "在掌握了物理基础之后，计算科学中的一个关键步骤是代码验证。本练习介绍了“人造解法”（Method of Manufactured Solutions, MMS），这是一种用于确保数值求解器正确实施的强大技术。通过从一个预设的“人造”解出发，您将反向推导必需的源项和边界条件，从而获得宝贵的实践经验，这对于开发和验证仿真软件至关重要。[@problem_id:2549238]", "problem": "考虑一个单位正方形区域 $\\Omega=(0,1)\\times(0,1)$ 上的稳态热传导问题，其热导率 $k=1$ 为常数。设一个设定的温度场由 $T(x,y)=1+x^{2}+y^{2}$ 给出。该区域内的控制强形式方程为带有体积源 $s(x,y)$ 的稳态能量平衡方程，即在 $\\Omega$ 内有 $-\\nabla\\cdot(k\\nabla T)=s$。边界 $\\partial\\Omega$ 被划分为四个边：$\\Gamma_{L}=\\{x=0,\\,0\\le y\\le 1\\}$，$\\Gamma_{R}=\\{x=1,\\,0\\le y\\le 1\\}$，$\\Gamma_{B}=\\{0\\le x\\le 1,\\,y=0\\}$ 和 $\\Gamma_{T}=\\{0\\le x\\le 1,\\,y=1\\}$。你将在 $\\Gamma_{L}\\cup\\Gamma_{T}$ 上施加本质（狄利克雷）数据，在 $\\Gamma_{B}$ 上施加自然（诺伊曼）数据，并在 $\\Gamma_{R}$ 上施加一个罗宾型边界条件，该条件模拟了在热传导中使用的标准线性化下的对流和辐射组合。\n\n任务：\n1) 从能量守恒和傅里叶定律出发，确定体积源 $s(x,y)$，使得 $T$ 成为 $k=1$ 时区域方程的一个解。\n2) 通过取 $T$ 的适当迹来确定 $\\Gamma_{L}$ 和 $\\Gamma_{T}$ 上的边界数据，使得 $T$ 在这些边界上精确满足本质条件。确定 $\\Gamma_{B}$ 上的外法向热通量，使得 $T$ 在该边界上精确满足自然条件。\n3) 在 $\\Gamma_{R}$ 上，施加一个罗宾型条件，其中 $h$ 是一个恒定的正传热系数，代表对流和线性化辐射贡献的总和。确定沿 $\\Gamma_{R}$ 的环境温度分布 $T_{\\infty}(y)$，使得设定的场 $T$ 对于所有 $y\\in[0,1]$ 精确满足罗宾边界平衡。\n\n以显式解析表达式的形式提供最终的边界数据。按照 $\\big(\\bar T_{\\Gamma_{L}}(y),\\ \\bar T_{\\Gamma_{T}}(x),\\ \\bar q_{\\Gamma_{B}}(x),\\ h,\\ T_{\\infty,\\Gamma_{R}}(y)\\big)$ 的顺序，以单行矩阵的形式报告它们。最终答案中不需要单位，也不需要四舍五入。", "solution": "首先将使用规定的标准对问题陈述进行验证。\n\n步骤 1：提取给定条件\n- 区域：$\\Omega=(0,1)\\times(0,1)$\n- 热导率：$k=1$（常数）\n- 设定温度场：$T(x,y)=1+x^{2}+y^{2}$\n- 控制方程：在 $\\Omega$ 中 $-\\nabla\\cdot(k\\nabla T)=s$\n- 边界划分：\n  - $\\Gamma_{L}=\\{x=0,\\,0\\le y\\le 1\\}$（本质/狄利克雷）\n  - $\\Gamma_{R}=\\{x=1,\\,0\\le y\\le 1\\}$（罗宾）\n  - $\\Gamma_{B}=\\{0\\le x\\le 1,\\,y=0\\}$（自然/诺伊曼）\n  - $\\Gamma_{T}=\\{0\\le x\\le 1,\\,y=1\\}$（本质/狄利克雷）\n- 任务：\n  1. 确定体积源 $s(x,y)$。\n  2. 确定 $\\Gamma_{L}$ 和 $\\Gamma_{T}$ 上的狄利克雷数据 $\\bar{T}$，以及 $\\Gamma_{B}$ 上的诺伊曼数据 $\\bar{q}$。\n  3. 对于一个恒定的正传热系数 $h$，确定 $\\Gamma_{R}$ 上的环境温度 $T_{\\infty}(y)$，使得 $T(x,y)$ 满足罗宾条件。\n\n步骤 2：使用提取的给定条件进行验证\n该问题具有科学依据，是一个基于傅里叶定律和能量守恒的标准稳态热传导问题。设定解法是用于验证数值代码的一种成熟且严谨的技术。该问题是适定的，因为它要求确定由给定的光滑候选解唯一确定的源项和边界条件。所有术语在数学上都是精确和客观的。不存在矛盾、信息缺失或物理上不可能的条件。该问题是向量微积分在偏微分方程上的直接应用。它并非无关紧要、不适定或故作高深。\n\n步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n解答过程通过执行三个指定的任务来进行。\n\n任务 1：确定体积源 $s(x,y)$\n控制方程是稳态能量平衡，表示为 $-\\nabla\\cdot(k\\nabla T) = s(x,y)$。当热导率 $k=1$ 为常数时，该方程简化为泊松方程 $-\\nabla^{2}T = s(x,y)$，其中 $\\nabla^{2}$ 是拉普拉斯算子。\n设定的温度场为 $T(x,y)=1+x^{2}+y^{2}$。\n首先，我们计算温度场的梯度 $\\nabla T$：\n$$ \\nabla T(x,y) = \\frac{\\partial T}{\\partial x}\\mathbf{i} + \\frac{\\partial T}{\\partial y}\\mathbf{j} $$\n偏导数是：\n$$ \\frac{\\partial T}{\\partial x} = \\frac{\\partial}{\\partial x}(1+x^{2}+y^{2}) = 2x $$\n$$ \\frac{\\partial T}{\\partial y} = \\frac{\\partial}{\\partial y}(1+x^{2}+y^{2}) = 2y $$\n因此，梯度为 $\\nabla T(x,y) = 2x\\mathbf{i} + 2y\\mathbf{j}$。\n接下来，我们计算温度场的拉普拉斯算子 $\\nabla^{2}T = \\nabla \\cdot (\\nabla T)$：\n$$ \\nabla^{2}T = \\frac{\\partial^{2}T}{\\partial x^{2}} + \\frac{\\partial^{2}T}{\\partial y^{2}} $$\n二阶偏导数是：\n$$ \\frac{\\partial^{2}T}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}(2x) = 2 $$\n$$ \\frac{\\partial^{2}T}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}(2y) = 2 $$\n因此，拉普拉斯算子是一个常数：\n$$ \\nabla^{2}T = 2 + 2 = 4 $$\n然后从控制方程中求出源项 $s(x,y)$：\n$$ s(x,y) = -\\nabla^{2}T = -4 $$\n因此，需要一个大小为 $4$ 的恒定体积热汇来维持给定的温度场。\n\n任务 2：确定 $\\Gamma_{L}$、$\\Gamma_{T}$ 和 $\\Gamma_{B}$ 上的边界数据\n边界条件通过强制设定的解 $T(x,y)$ 精确满足它们而导出。\n\n在左边界 $\\Gamma_{L}=\\{x=0,\\,0\\le y\\le 1\\}$ 上，施加一个本质（狄利克雷）条件。规定的温度 $\\bar{T}_{\\Gamma_{L}}(y)$ 是 $T(x,y)$ 在此边界上的迹：\n$$ \\bar{T}_{\\Gamma_{L}}(y) = T(0,y) = 1+0^{2}+y^{2} = 1+y^{2} $$\n\n在上边界 $\\Gamma_{T}=\\{0\\le x\\le 1,\\,y=1\\}$ 上，也施加一个本质（狄利克雷）条件。规定的温度 $\\bar{T}_{\\Gamma_{T}}(x)$ 是 $T(x,y)$ 在此边界上的迹：\n$$ \\bar{T}_{\\Gamma_{T}}(x) = T(x,1) = 1+x^{2}+1^{2} = 2+x^{2} $$\n\n在下边界 $\\Gamma_{B}=\\{0\\le x\\le 1,\\,y=0\\}$ 上，施加一个自然（诺伊曼）条件。该条件指定了外法向热通量 $\\bar{q}_{\\Gamma_{B}}(x)$。热通量向量由傅里叶定律给出，$\\mathbf{q} = -k\\nabla T$。外法向通量为 $\\mathbf{q} \\cdot \\mathbf{n} = -k\\nabla T \\cdot \\mathbf{n}$。\n在 $\\Gamma_{B}$ 上的单位外法向向量是 $\\mathbf{n} = (0,-1)$。\n规定的通量是：\n$$ \\bar{q}_{\\Gamma_{B}}(x) = -k\\nabla T(x,0) \\cdot \\mathbf{n} = -1 \\cdot (2x, 2(0)) \\cdot (0,-1) = -(2x,0) \\cdot (0,-1) = -(2x)(0)-(0)(-1) = 0 $$\n因此，边界 $\\Gamma_{B}$ 是绝热的（完全绝缘）。\n\n任务 3：确定 $\\Gamma_{R}$ 上的环境温度分布\n在右边界 $\\Gamma_{R}=\\{x=1,\\,0\\le y\\le 1\\}$ 上，施加一个罗宾型条件。该条件将外法向传导热通量与向环境介质的传热联系起来：\n$$ -k\\nabla T \\cdot \\mathbf{n} = h(T-T_{\\infty}) $$\n这里，$h$ 是一个恒定的正传热系数，$T_{\\infty}(y)$ 是待确定的环境温度分布。\n在 $\\Gamma_{R}$ 上的单位外法向向量是 $\\mathbf{n}=(1,0)$。\n方程的左侧（LHS）是在 $x=1$ 处计算的外向传导通量：\n$$ \\text{LHS} = -k\\nabla T(1,y) \\cdot \\mathbf{n} = -1 \\cdot (2(1), 2y) \\cdot (1,0) = -(2,2y) \\cdot (1,0) = -2 $$\n方程的右侧（RHS）涉及边界上的温度 $T(1,y)$ 和未知的环境温度 $T_{\\infty,\\Gamma_{R}}(y)$：\n$$ T(1,y) = 1+1^{2}+y^{2} = 2+y^{2} $$\n$$ \\text{RHS} = h(T(1,y) - T_{\\infty,\\Gamma_{R}}(y)) = h((2+y^{2}) - T_{\\infty,\\Gamma_{R}}(y)) $$\n令 LHS 和 RHS 相等，得到：\n$$ -2 = h(2+y^{2} - T_{\\infty,\\Gamma_{R}}(y)) $$\n我们现在求解 $T_{\\infty,\\Gamma_{R}}(y)$：\n$$ -\\frac{2}{h} = 2+y^{2} - T_{\\infty,\\Gamma_{R}}(y) $$\n$$ T_{\\infty,\\Gamma_{R}}(y) = 2+y^{2} + \\frac{2}{h} $$\n该表达式给出了沿 $\\Gamma_R$ 所需的环境温度分布，以确保设定的解被精确满足。\n\n最终结果汇总：\n所需的边界量为：\n- $\\Gamma_L$ 上的规定温度：$\\bar{T}_{\\Gamma_{L}}(y) = 1+y^{2}$\n- $\\Gamma_T$ 上的规定温度：$\\bar{T}_{\\Gamma_{T}}(x) = 2+x^{2}$\n- $\\Gamma_B$ 上的规定外法向通量：$\\bar{q}_{\\Gamma_{B}}(x) = 0$\n- $\\Gamma_R$ 上的传热系数：$h$（一个给定的正常数）\n- $\\Gamma_R$ 上的环境温度：$T_{\\infty,\\Gamma_{R}}(y) = 2+y^{2} + \\frac{2}{h}$\n\n这些结果以所要求的矩阵格式呈现。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1+y^{2}  2+x^{2}  0  h  2+y^{2}+\\frac{2}{h} \\end{pmatrix} } $$", "id": "2549238"}, {"introduction": "本节将理论与实践相结合，指导您完成从物理模型到数值求解的完整工作流程。在理解了基本物理和验证方法之后，下一步是解决一个具体的工程问题。此练习将引导您将一个带有非线性辐射边界的边值问题简化为单个代数方程，并实施标准的牛顿-拉弗森（Newton-Raphson）方法来求解它，这真实地模拟了在有限元软件中处理非线性边界条件的核心过程。[@problem_id:2549213]", "problem": "考虑一维稳态热传导问题，该问题由开放区间 $(0,L)$ 上的二阶常微分方程 (ODE) $-k\\,T''(x)=0$ 控制，其在 $x=0$ 处具有辐射自然边界，在 $x=L$ 处具有给定温度（Dirichlet 条件）。参数包括：热导率 $k$（单位为 $\\mathrm{W\\,m^{-1}\\,K^{-1}}$），长度 $L$（单位为 $\\mathrm{m}$），发射率 $\\epsilon$（无量纲），以及 Stefan–Boltzmann 常数 $\\sigma$（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-4}}$）。环境温度为 $T_{\\infty}$（单位为 $\\mathrm{K}$），$x=L$ 处的给定温度为 $\\bar T$（单位为 $\\mathrm{K}$）。$x=0$ 处的辐射边界条件为\n$$-k\\,T'(0)=\\epsilon\\,\\sigma\\left(T(0)^4 - T_{\\infty}^4\\right),$$\n其中 $T'(0)$ 表示 $T$ 在 $x=0$ 处相对于外向单位法线的导数（因此，左侧代表正的外向热通量）。$x=L$ 处的边界条件为 $T(L)=\\bar T$。\n\n任务：\n- 从 $-k\\,T''(x)=0$ 的解是关于 $x$ 的线性函数、Fourier 定律给出传导通量、以及 Stefan–Boltzmann 定律控制辐射通量这些基本事实出发，将该边值问题简化为关于标量未知数 $T(0)$ 的单个非线性代数方程。\n- 推导一个一致的 Newton 迭代法来求解此标量非线性方程。您的迭代过程必须使用一个残差函数及其相对于 $T(0)$ 的导数来表示，这些函数和导数直接从简化后的代数方程中获得。\n- 实现一个程序，对下面列出的每组参数，使用您推导的 Newton 迭代法求解 $T(0)$。该程序必须使用基于残差范数容差的停止准则，并应包含全局化策略（例如步长阻尼）以确保稳健收敛。如果 $\\epsilon=0$，程序仍应返回正确答案。最终答案必须以开尔文（单位 $\\mathrm{K}$）表示，并四舍五入到三位小数。\n\n测试集（每个元组为 $(k, L, \\epsilon, \\sigma, T_{\\infty}, \\bar T)$，单位为 $\\left(\\mathrm{W\\,m^{-1}\\,K^{-1}}, \\mathrm{m}, -, \\mathrm{W\\,m^{-2}\\,K^{-4}}, \\mathrm{K}, \\mathrm{K}\\right)$）：\n- 情况 1：$\\left(200,\\,0.01,\\,0.8,\\,5.670374419\\times 10^{-8},\\,300,\\,500\\right)$\n- 情况 2：$\\left(100,\\,0.05,\\,0,\\,5.670374419\\times 10^{-8},\\,400,\\,800\\right)$\n- 情况 3：$\\left(10,\\,0.2,\\,0.9,\\,5.670374419\\times 10^{-8},\\,300,\\,350\\right)$\n- 情况 4：$\\left(30,\\,0.1,\\,0.6,\\,5.670374419\\times 10^{-8},\\,300,\\,305\\right)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果，例如 $[T_0^{(1)},T_0^{(2)},T_0^{(3)},T_0^{(4)}]$，其中每个 $T_0^{(i)}$ 是计算出的 $T(0)$ 近似值，单位为 $\\mathrm{K}$，并四舍五入到三位小数。不得打印任何额外文本。", "solution": "问题陈述经过验证且有效。它在科学上基于热传递原理，即 Fourier 传导定律和 Stefan-Boltzmann 辐射定律。该问题是适定的，描述了一个具有充分且一致条件的一维稳态边值问题。语言客观，所提供的参数在物理上是现实的。\n\n求解过程始于控制一维稳态热传导且无内部热源的常微分方程 (ODE)：\n$$ -k\\,T''(x) = 0 $$\n其中 $k$ 是热导率，假定为常数。由于 $k0$，该方程简化为 $T''(x) = 0$。该 ODE 的通解是 $x$ 的线性函数：\n$$ T(x) = C_1 x + C_2 $$\n其中 $C_1$ 和 $C_2$ 是积分常数。\n\n这些常数通过应用边界条件来确定。我们将 $x=0$ 处的未知温度定义为 $T_0 \\equiv T(0)$。两个条件是：\n1. 在 $x=0$ 处：$T(0) = T_0$。\n2. 在 $x=L$ 处：$T(L) = \\bar{T}$。\n\n将第一个条件应用于通解，得到：\n$$ T(0) = C_1(0) + C_2 = T_0 \\implies C_2 = T_0 $$\n将第二个条件应用于通解，得到：\n$$ T(L) = C_1 L + C_2 = \\bar{T} $$\n将 $C_2=T_0$ 代入第二个方程，可以解出 $C_1$：\n$$ C_1 L + T_0 = \\bar{T} \\implies C_1 = \\frac{\\bar{T} - T_0}{L} $$\n因此，杆内的温度分布完全由未知的边界温度 $T_0$ 确定：\n$$ T(x) = \\left(\\frac{\\bar{T} - T_0}{L}\\right) x + T_0 $$\n热通量由 Fourier 定律给出，$q(x) = -k\\,T'(x)$。温度的导数为：\n$$ T'(x) = \\frac{d}{dx}T(x) = \\frac{\\bar{T} - T_0}{L} $$\n这是一个常数，表明整个杆内的热通量是均匀的，这与没有热源的稳态问题相一致。\n\n问题在 $x=0$ 处指定了一个非线性辐射边界条件：\n$$ -k\\,T'(0) = \\epsilon\\,\\sigma\\left(T(0)^4 - T_{\\infty}^4\\right) $$\n$T'(0)$ 项被定义为在 $x=0$ 处相对于外向单位法线的导数。对于区间 $[0, L]$ 上的域，在 $x=0$ 处的外向法线指向负 $x$ 方向。因此，法向导数为 $\\frac{\\partial T}{\\partial n}|_{x=0} = -\\frac{dT}{dx}|_{x=0}$。问题中的符号 $T'(0)$ 对应于此法向导数。\n$$ T'(0) = -\\frac{dT}{dx}\\bigg|_{x=0} = -\\left(\\frac{\\bar{T} - T_0}{L}\\right) = \\frac{T_0 - \\bar{T}}{L} $$\n将 $T'(0)$ 和 $T(0)=T_0$ 的表达式代入辐射边界条件，得到：\n$$ -k \\left(\\frac{T_0 - \\bar{T}}{L}\\right) = \\epsilon\\,\\sigma\\left(T_0^4 - T_{\\infty}^4\\right) $$\n整理左侧，得到：\n$$ \\frac{k}{L}(\\bar{T} - T_0) = \\epsilon\\,\\sigma\\left(T_0^4 - T_{\\infty}^4\\right) $$\n这个方程表示了在 $x=0$ 处的物理平衡：从杆传导至边界的热量 $\\frac{k}{L}(\\bar{T} - T_0)$，必须等于从边界辐射出去的热量 $\\epsilon\\,\\sigma(T_0^4 - T_{\\infty}^4)$。这就是我们所求的关于未知标量 $T_0$ 的单个非线性代数方程。\n\n为了数值求解此方程，我们采用 Newton-Raphson 方法。首先，我们将所有项移到一边，定义一个残差函数 $R(T_0)$：\n$$ R(T_0) = \\frac{k}{L}(\\bar{T} - T_0) - \\epsilon\\,\\sigma\\left(T_0^4 - T_{\\infty}^4\\right) = 0 $$\nNewton 迭代需要残差函数相对于未知数 $T_0$ 的导数。这个导数 $R'(T_0)$ 是该标量系统的 Jacobian：\n$$ R'(T_0) = \\frac{d}{dT_0} \\left[ \\frac{k}{L}(\\bar{T} - T_0) - \\epsilon\\,\\sigma(T_0^4 - T_{\\infty}^4) \\right] $$\n$$ R'(T_0) = -\\frac{k}{L} - \\epsilon\\,\\sigma(4T_0^3) = -\\left(\\frac{k}{L} + 4\\epsilon\\,\\sigma T_0^3\\right) $$\n对于任何物理上有意义的温度 $T_0  0$，导数 $R'(T_0)$ 恒为负，因为 $k, L, \\epsilon, \\sigma$ 都是正常数。这确保了残差函数是单调递减的，从而保证了唯一正根的存在。\n\nNewton-Raphson 迭代由以下更新规则给出：\n$$ T_{0,n+1} = T_{0,n} - \\frac{R(T_{0,n})}{R'(T_{0,n})} $$\n其中 $T_{0,n}$ 是在第 $n$ 次迭代时 $T_0$ 的估计值。\n\n实现将使用此迭代。一个合适的初始猜测是 $T_{0,0} = \\bar{T}$。迭代持续进行，直到残差的绝对值 $|R(T_{0,n})|$ 小于指定的容差。为确保稳健收敛，我们加入了一个全局化策略，具体来说是回溯线搜索。更新被修改为 $T_{0,n+1} = T_{0,n} + \\alpha \\Delta T_{0,n}$，其中 $\\Delta T_{0,n} = -R(T_{0,n})/R'(T_{0,n})$ 是完整的 Newton 步长，$\\alpha \\in (0, 1]$ 是一个阻尼因子。我们从 $\\alpha=1$ 开始，并相继将其减半，直到残差范数实现充分减小，即 $|R(T_{0,n+1})|  |R(T_{0,n})|$。\n\n在发射率 $\\epsilon=0$ 的特殊情况下，边界条件简化为 $\\frac{k}{L}(\\bar{T} - T_0) = 0$，这意味着 $T_0 = \\bar{T}$。这对应于一个绝热边界，其中零热通量 ($T'(x)=0$) 导致均匀的温度分布。推导出的 Newton 迭代法能正确地在单次迭代中收敛到此解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef newton_solver(k, L, eps, sigma, T_inf, T_bar):\n    \"\"\"\n    Solves the nonlinear equation for T(0) using a damped Newton's method.\n    \n    Args:\n        k (float): Thermal conductivity (W m^-1 K^-1).\n        L (float): Length of the rod (m).\n        eps (float): Emissivity (dimensionless).\n        sigma (float): Stefan-Boltzmann constant (W m^-2 K^-4).\n        T_inf (float): Ambient temperature (K).\n        T_bar (float): Prescribed temperature at x=L (K).\n        \n    Returns:\n        float: The solved temperature T(0) in Kelvin.\n    \"\"\"\n    \n    # In the case of zero emissivity, the boundary is insulated.\n    # The heat flux is zero, so T'(x) = 0, and T(x) is constant.\n    # Therefore, T(0) = T(L) = T_bar.\n    if eps == 0.0:\n        return T_bar\n\n    # --- Newton-Raphson Solver Setup ---\n    # Initial guess for T(0) is the prescribed temperature at the other end.\n    T0 = float(T_bar)\n    \n    tol = 1e-9  # Convergence tolerance for the residual norm\n    max_iter = 50  # Maximum number of Newton iterations\n    max_ls_iter = 10  # Maximum number of line search (damping) steps\n\n    for i in range(max_iter):\n        # Define the residual function R(T0) and its derivative R_prime(T0).\n        # R(T0) = k/L * (T_bar - T0) - eps * sigma * (T0^4 - T_inf^4)\n        term_cond = (k / L) * (T_bar - T0)\n        term_rad = eps * sigma * (T0**4 - T_inf**4)\n        res = term_cond - term_rad\n\n        # Check for convergence\n        if abs(res)  tol:\n            return T0\n\n        # R_prime(T0) = -k/L - 4 * eps * sigma * T0^3\n        jac = -(k / L) - 4 * eps * sigma * T0**3\n        \n        if abs(jac)  1e-20:\n            raise RuntimeError(\"Singular Jacobian encountered; solver failed.\")\n\n        # Full Newton step\n        delta_T0 = -res / jac\n\n        # --- Globalization: Damped step with backtracking line search ---\n        alpha = 1.0  # Initial damping factor\n        current_res_norm = abs(res)\n        step_found = False\n\n        for _ in range(max_ls_iter):\n            T0_next = T0 + alpha * delta_T0\n            \n            # Ensure temperature remains physically meaningful (positive Kelvin)\n            if T0_next = 0:\n                alpha /= 2.0\n                continue\n\n            # Calculate residual at the new trial point\n            next_term_cond = (k / L) * (T_bar - T0_next)\n            next_term_rad = eps * sigma * (T0_next**4 - T_inf**4)\n            new_res_norm = abs(next_term_cond - next_term_rad)\n\n            # Accept step if residual is reduced\n            if new_res_norm  current_res_norm:\n                T0 = T0_next\n                step_found = True\n                break\n            \n            # Reduce step size if residual did not decrease\n            alpha /= 2.0\n\n        if not step_found:\n            raise RuntimeError(\"Line search failed to find a descent direction.\")\n\n    raise RuntimeError(f\"Newton's method did not converge within {max_iter} iterations.\")\n\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print the results.\n    \"\"\"\n    # Test suite: (k, L, epsilon, sigma, T_infinity, T_bar)\n    test_cases = [\n        (200.0, 0.01, 0.8, 5.670374419e-8, 300.0, 500.0),\n        (100.0, 0.05, 0.0, 5.670374419e-8, 400.0, 800.0),\n        (10.0, 0.2, 0.9, 5.670374419e-8, 300.0, 350.0),\n        (30.0, 0.1, 0.6, 5.670374419e-8, 300.0, 305.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        k, L, eps, sigma, T_inf, T_bar = case\n        try:\n            T0_solution = newton_solver(k, L, eps, sigma, T_inf, T_bar)\n            # Format the result to three decimal places as required.\n            results.append(f\"{T0_solution:.3f}\")\n        except RuntimeError as e:\n            results.append(f\"Error: {e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2549213"}]}