{"hands_on_practices": [{"introduction": "为了从根本上理解SUPG方法的稳定化机理，这个练习将问题简化到一维纯对流情况。通过推导在特定稳定参数 $\\tau$ 下SUPG方法产生的离散格式，你将发现它与经典的一阶迎风有限差分格式之间的深刻联系，从而直观地认识到SUPG是如何引入“恰到好处的”人工黏性来保证数值稳定性的。[@problem_id:2602080]", "problem": "考虑一维空间中的稳态线性平流方程，\n$$\na\\,\\frac{d u}{d x} = f(x) \\quad \\text{on } [0,L],\n$$\n其中平流速度 $a>0$ 为常数。设 $u(x)$ 在一个均匀网格上用连续分片线性有限元函数来近似，该网格的节点为 $x_i=i\\,h$，其中 $h=L/N$ 且 $i=0,1,\\dots,N$。使用与节点相关的标准连续基函数 $\\{\\varphi_i\\}$。采用流线迎风/Petrov-Galerkin (SUPG) 方法，其中与节点 $i$ 相关的检验函数被修改为\n$$\n\\widetilde{w}_i \\equiv \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x},\n$$\n稳定化参数为\n$$\n\\tau = \\frac{h}{2a}.\n$$\n从平流的标准 Galerkin 弱形式出发（不对平流项进行分部积分），一致地加入 SUPG 扰动，并推导对刚度矩阵的单元级贡献。将这些贡献组装起来，以获得对于一个内部节点 $i$（远离边界）的离散残差方程中，乘以节点未知数 $\\{u_{i-1},u_i,u_{i+1}\\}$ 的三点格式系数。忽略来自 $f(x)$ 的载荷向量贡献；仅计算刚度（左手边）的贡献。\n\n然后，将得到的 SUPG 格式与相同均匀网格上 $a>0$ 的经典一阶迎风有限差分格式进行比较。\n\n请将您的最终答案以一个行矩阵的形式，写出乘以 $\\{u_{i-1},u_i,u_{i+1}\\}$ 的系数有序三元组。无需四舍五入，也无需单位。", "solution": "必须首先验证问题陈述的科学合理性、适定性和客观性。\n\n**步骤 1：提取已知条件**\n-   控制方程：$a\\,\\frac{d u}{d x} = f(x)$，在域 $[0,L]$ 上。\n-   平流速度：$a$ 是一个正常数，$a>0$。\n-   近似方法：在均匀网格上的连续分片线性有限元法。\n-   网格节点：$x_i=i\\,h$，其中 $h=L/N$，对于 $i=0,1,\\dots,N$。\n-   基函数：标准线性帽子函数 $\\{\\varphi_i\\}$。\n-   数值格式：流线迎风/Petrov-Galerkin (SUPG)。\n-   检验函数：$\\widetilde{w}_i = \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x}$。\n-   稳定化参数：$\\tau = \\frac{h}{2a}$。\n-   任务：通过组装单元级刚度贡献，推导内部节点 $i$ 的三点格式系数，忽略载荷向量 $f(x)$。需要找到节点未知数 $\\{u_{i-1}, u_i, u_{i+1}\\}$ 的系数。\n\n**步骤 2：使用提取的已知条件进行验证**\n对问题进行严格验证。\n-   **科学基础**：该问题是偏微分方程数值分析中的一个标准、典型的练习，具体涉及平流主导问题的有限元方法。SUPG 方法是一种成熟的基础技术。\n-   **适定性**：问题给出了精确的规定。所有必要组成部分——方程、离散化、基函数和检验函数，以及稳定化参数的具体形式——都已提供。目标明确且可实现。\n-   **客观性**：语言形式化、技术性强，没有任何主观或模糊的术语。\n\n该问题没有任何无效性缺陷。它是自洽的、科学正确的，并且表述明确。\n\n**步骤 3：结论与行动**\n此问题是**有效的**。将推导解答。\n\n**SUPG 格式的推导**\n\n使用 Petrov-Galerkin 检验函数 $\\widetilde{w}_i$ 的平流方程的弱形式为：\n找到 $u_h \\in V_h$，使得对于每个基函数索引 $i$，\n$$\n\\int_0^L \\widetilde{w}_i \\left( a\\,\\frac{d u_h}{d x} - f(x) \\right) dx = 0\n$$\n其中 $u_h(x) = \\sum_{j=0}^{N} u_j \\varphi_j(x)$ 是有限元近似。代入 $\\widetilde{w}_i$ 的表达式，我们得到：\n$$\n\\int_0^L \\left( \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x} \\right) \\left( a\\,\\frac{d u_h}{d x} - f(x) \\right) dx = 0\n$$\n问题指明忽略来自 $f(x)$ 的载荷向量贡献。第 $i$ 个方程的左手边（刚度）贡献为：\n$$\n\\sum_{j=0}^{N} u_j \\left[ \\int_0^L a\\,\\varphi_i \\frac{d \\varphi_j}{d x} dx + \\int_0^L \\tau\\,a^2\\,\\frac{d \\varphi_i}{d x} \\frac{d \\varphi_j}{d x} dx \\right] = 0\n$$\n方括号中的项代表全局刚度矩阵的元素 $K_{ij}$。\n$$\nK_{ij} = \\underbrace{\\int_0^L a\\,\\varphi_i \\frac{d \\varphi_j}{d x} dx}_{K_G} + \\underbrace{\\int_0^L \\tau\\,a^2\\,\\frac{d \\varphi_i}{d x} \\frac{d \\varphi_j}{d x} dx}_{K_S}\n$$\n这些积分是逐单元计算的。考虑一个长度为 $h$ 的一般单元 $[x_k, x_{k+1}]$。我们使用一个局部坐标 $\\xi = (x-x_k)/h$，其中 $\\xi \\in [0,1]$。此单元上的线性基函数为：\n$$\nN_1(\\xi) = 1-\\xi \\quad \\text{(与节点 } k \\text{ 相关)}\n$$\n$$\nN_2(\\xi) = \\xi \\quad \\text{(与节点 } k+1 \\text{ 相关)}\n$$\n它们关于 $x$ 的导数为：\n$$\n\\frac{d N_1}{d x} = \\frac{d N_1}{d \\xi} \\frac{d \\xi}{d x} = -1 \\cdot \\frac{1}{h} = -\\frac{1}{h}\n$$\n$$\n\\frac{d N_2}{d x} = \\frac{d N_2}{d \\xi} \\frac{d \\xi}{d x} = 1 \\cdot \\frac{1}{h} = \\frac{1}{h}\n$$\n$2 \\times 2$ 的单元刚度矩阵 $K^e$ 的元素为 $K^e_{mn}$，其中 $m,n \\in \\{1,2\\}$。\n\n首先，我们计算标准 Galerkin 贡献 $K_G^e$：\n$$\nK_{G,mn}^e = \\int_{x_k}^{x_{k+1}} a\\,N_m \\frac{d N_n}{d x} dx = \\int_0^1 a\\,N_m(\\xi) \\frac{d N_n}{d x} h\\,d\\xi\n$$\n$$\nK_{G,11}^e = a \\int_0^1 (1-\\xi) \\left(-\\frac{1}{h}\\right) h\\,d\\xi = -a \\left[\\xi - \\frac{\\xi^2}{2}\\right]_0^1 = -\\frac{a}{2}\n$$\n$$\nK_{G,12}^e = a \\int_0^1 (1-\\xi) \\left(\\frac{1}{h}\\right) h\\,d\\xi = a \\left[\\xi - \\frac{\\xi^2}{2}\\right]_0^1 = \\frac{a}{2}\n$$\n$$\nK_{G,21}^e = a \\int_0^1 \\xi \\left(-\\frac{1}{h}\\right) h\\,d\\xi = -a \\left[\\frac{\\xi^2}{2}\\right]_0^1 = -\\frac{a}{2}\n$$\n$$\nK_{G,22}^e = a \\int_0^1 \\xi \\left(\\frac{1}{h}\\right) h\\,d\\xi = a \\left[\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{a}{2}\n$$\n因此，Galerkin 单元矩阵为：\n$$\nK_G^e = \\frac{a}{2} \\begin{pmatrix} -1  1 \\\\ -1  1 \\end{pmatrix}\n$$\n接下来，我们计算 SUPG 稳定化贡献 $K_S^e$：\n$$\nK_{S,mn}^e = \\int_{x_k}^{x_{k+1}} \\tau\\,a^2\\,\\frac{d N_m}{d x} \\frac{d N_n}{d x} dx = \\int_0^1 \\tau\\,a^2\\,\\frac{d N_m}{d x} \\frac{d N_n}{d x} h\\,d\\xi\n$$\n由于导数在单元上是常数，导数乘积的矩阵为 $\\frac{1}{h^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。\n$$\nK_S^e = \\tau a^2 h \\frac{1}{h^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{\\tau a^2}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n现在，代入给定的稳定化参数 $\\tau = \\frac{h}{2a}$：\n$$\nK_S^e = \\frac{(h/2a) a^2}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n总单元刚度矩阵 $K^e$ 是 $K_G^e + K_S^e$ 的和：\n$$\nK^e = \\frac{a}{2} \\begin{pmatrix} -1  1 \\\\ -1  1 \\end{pmatrix} + \\frac{a}{2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 0  0 \\\\ -2  2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ -a  a \\end{pmatrix}\n$$\n为了找到内部节点 $i$ 的格式，我们组装来自两个相邻单元的贡献：单元 $e_{i-1} = [x_{i-1}, x_i]$ 和单元 $e_i = [x_i, x_{i+1}]$。节点 $i$ 的离散方程是 $\\sum_j K_{ij} u_j = F_i$。我们寻求系数 $K_{i,i-1}$、$K_{i,i}$ 和 $K_{i,i+1}$。\n\n-   **来自单元 $e_{i-1} = [x_{i-1}, x_i]$ 的贡献**：\n    局部节点 $1,2$ 对应于全局节点 $i-1, i$。我们关心的是全局矩阵的第 $i$ 行，这对应于 $K^e$ 的第二行（$m=2$）。\n    -   $u_{i-1}$ 的系数（全局列 $i-1$，局部列 $n=1$）是 $K_{21}^e = -a$。\n    -   $u_i$ 的系数（全局列 $i$，局部列 $n=2$）是 $K_{22}^e = a$。\n\n-   **来自单元 $e_i = [x_i, x_{i+1}]$ 的贡献**：\n    局部节点 $1,2$ 对应于全局节点 $i, i+1$。我们关心的是全局矩阵的第 $i$ 行，这对应于 $K^e$ 的第一行（$m=1$）。\n    -   $u_i$ 的系数（全局列 $i$，局部列 $n=1$）是 $K_{11}^e = 0$。\n    -   $u_{i+1}$ 的系数（全局列 $i+1$，局部列 $n=2$）是 $K_{12}^e = 0$。\n\n对第 $i$ 行的贡献求和：\n-   $u_{i-1}$ 的系数：$K_{i,i-1} = -a$。\n-   $u_i$ 的系数：$K_{i,i} = a + 0 = a$。\n-   $u_{i+1}$ 的系数：$K_{i,i+1} = 0$。\n\n得到的 $\\{u_{i-1}, u_i, u_{i+1}\\}$ 的系数格式为 $(-a, a, 0)$。节点 $i$ 处的离散方程为 $-a u_{i-1} + a u_i = (\\text{RHS})_i$。\n\n与一阶迎风有限差分法的比较是有启发性的。对于 $a>0$，$a \\frac{du}{dx} = f$ 的迎风格式为 $a\\frac{u_i - u_{i-1}}{h} = f_i$。算子 $a(u_i - u_{i-1})/h$ 由系数 $(-a/h, a/h, 0)$ 产生。我们推导出的 SUPG 系数 $(-a, a, 0)$ 产生的算子与之成比例。当源项 $f$ 为常数时，这两种方法变得相同，因为集中质量有限元右端向量得到 $F_i = f \\cdot h$，给出 $a(u_i - u_{i-1}) = f \\cdot h$，这与有限差分格式等价。问题要求的是刚度矩阵的系数，已按要求推导出来。\n\n因此，乘以 $\\{u_{i-1},u_i,u_{i+1}\\}$ 的系数有序三元组是 $(-a, a, 0)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-a  a  0\n\\end{pmatrix}\n}\n$$", "id": "2602080"}, {"introduction": "将SUPG方法从一维推广到多维，一个核心挑战是如何定义与流动方向相关的单元特征尺寸。本练习将指导你计算在二维三角形单元上沿流线方向的特征长度 $h_{\\boldsymbol{t}}$，并用它来确定最优的稳定参数 $\\tau$。掌握这个计算过程是你在二维或三维问题中成功实施SUPG方法的关键一步。[@problem_id:2602150]", "problem": "考虑二维空间中的稳态、无量纲的平流-扩散-反应边值问题，\n$$-\\,\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{在多边形域中},$$\n其系数为常数。我们关注一个单一的仿射线性三角形有限元，其顶点位于\n$$\\boldsymbol{x}_1=(0,0),\\quad \\boldsymbol{x}_2=(0.04,0),\\quad \\boldsymbol{x}_3=(0,0.03),$$\n以及相关的线性拉格朗日节点形函数 $N_i$，这些形函数满足单位分解和线性完备性。设平流速度为 $\\boldsymbol{\\beta}=(10,0.5)$，扩散系数为 $\\epsilon=10^{-4}$，反应系数为 $\\sigma=0$。\n\n(a) 仅从以下两点出发：(i) 线性两节点一维单元的恒等式，即形函数导数的绝对值之和等于 $2/h$（其中 $h$ 是单元长度），以及 (ii) 三角形的仿射映射和方向导数概念，推导沿流线方向 $\\boldsymbol{t}=\\boldsymbol{\\beta}/\\|\\boldsymbol{\\beta}\\|$ 的方向单元长度 $h_{\\boldsymbol{t}}$ 的公式，该公式用常梯度 $\\nabla N_i$ 和 $\\boldsymbol{t}$ 表示。然后，对给定的三角形和 $\\boldsymbol{\\beta}$，计算 $h_{\\boldsymbol{t}}$ 的值。\n\n(b) 利用一维常系数分析，该分析可得出沿流线方向的最优流线迎风/彼得罗夫-伽辽金 (SUPG) 稳定化参数，推导稳定化参数 $\\tau$ 的表达式，该表达式用 $h_{\\boldsymbol{t}}$、$\\|\\boldsymbol{\\beta}\\|$、$\\epsilon$ 和单元佩克莱数表示。然后，根据给定数据计算 $\\tau$ 的值。\n\n提供 $h_{\\boldsymbol{t}}$ 和 $\\tau$ 的最终数值。将两者均四舍五入至六位有效数字。将最终答案表示为有序对 $(h_{\\boldsymbol{t}},\\ \\tau)$，不带单位。", "solution": "问题陈述经验证是适定的、有科学依据且自洽的。它是在平流主导问题的有限元分析中一个标准的、尽管不简单的练习。我们开始求解。\n\n问题分为两部分。我们按顺序解决每一部分。\n\n(a) 方向单元长度 $h_{\\boldsymbol{t}}$ 的推导与计算。\n\n对于一个线性三角形单元，拉格朗日节点形函数 $N_i(\\boldsymbol{x})$ 是空间坐标 $\\boldsymbol{x}=(x,y)$ 的线性函数。因此，它们的梯度 $\\nabla N_i$ 在整个单元上是常向量。这些梯度由单元的几何形状决定。给定顶点 $\\boldsymbol{x}_1=(0,0)$、$\\boldsymbol{x}_2=(0.04,0)$ 和 $\\boldsymbol{x}_3=(0,0.03)$，三角形的面积为 $A = \\frac{1}{2}(0.04)(0.03) = 0.0006$。梯度计算如下：\n$$\n\\nabla N_i = \\frac{1}{2A} \\begin{pmatrix} y_j - y_k \\\\ x_k - x_j \\end{pmatrix}\n$$\n其中 $(i,j,k)$ 是 $(1,2,3)$ 的一个循环置换。对于给定的顶点：\n$$\n\\nabla N_1 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0.03 \\\\ 0 - 0.04 \\end{pmatrix} = \\begin{pmatrix} -25 \\\\ -100/3 \\end{pmatrix}\n$$\n$$\n\\nabla N_2 = \\frac{1}{0.0012} \\begin{pmatrix} 0.03 - 0 \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 25 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla N_3 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0 \\\\ 0.04 - 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 100/3 \\end{pmatrix}\n$$\n线性完备性条件 $\\sum_{i=1}^3 \\nabla N_i = \\boldsymbol{0}$ 得到满足。\n\n题目要求从一个长度为 $h$ 的线性两节点一维单元的恒等式 $\\sum_{i=1}^2 |N_i'| = \\frac{2}{h}$ 出发。这个恒等式可以重新排列来定义单元长度为 $h = 2 / (\\sum_{i=1}^2 |N_i'|)$。\n\n我们将这个概念推广到多维。沿单一空间坐标的导数 $N_i'$ 的角色被沿指定流线方向（由单位向量 $\\boldsymbol{t}$ 给出）的 $N_i$ 的方向导数所取代。方向导数为 $\\nabla N_i \\cdot \\boldsymbol{t}$。求和遍及单元的所有节点，本例中为 $i=1, 2, 3$。由此得出方向单元长度 $h_{\\boldsymbol{t}}$ 的定义：\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}|}\n$$\n流线方向与平流速度 $\\boldsymbol{\\beta}=(10, 0.5)$ 一致。单位向量为 $\\boldsymbol{t} = \\boldsymbol{\\beta} / \\|\\boldsymbol{\\beta}\\|$。首先，我们计算点积 $\\nabla N_i \\cdot \\boldsymbol{\\beta}$：\n$$\n\\nabla N_1 \\cdot \\boldsymbol{\\beta} = (-25)(10) + (-\\frac{100}{3})(0.5) = -250 - \\frac{50}{3} = -\\frac{800}{3}\n$$\n$$\n\\nabla N_2 \\cdot \\boldsymbol{\\beta} = (25)(10) + (0)(0.5) = 250\n$$\n$$\n\\nabla N_3 \\cdot \\boldsymbol{\\beta} = (0)(10) + (\\frac{100}{3})(0.5) = \\frac{50}{3}\n$$\n它们的绝对值之和为：\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = |-\\frac{800}{3}| + |250| + |\\frac{50}{3}| = \\frac{800}{3} + \\frac{750}{3} + \\frac{50}{3} = \\frac{1600}{3}\n$$\n平流速度的大小为 $\\|\\boldsymbol{\\beta}\\| = \\sqrt{10^2 + 0.5^2} = \\sqrt{100.25}$。\n现在我们可以写出方向导数绝对值的和：\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}| = \\sum_{i=1}^3 \\left|\\nabla N_i \\cdot \\frac{\\boldsymbol{\\beta}}{\\|\\boldsymbol{\\beta}\\|}\\right| = \\frac{1}{\\|\\boldsymbol{\\beta}\\|} \\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = \\frac{1600/3}{\\sqrt{100.25}}\n$$\n将此代入 $h_{\\boldsymbol{t}}$ 的公式中：\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\frac{1600/3}{\\sqrt{100.25}}} = \\frac{6 \\sqrt{100.25}}{1600} = \\frac{3 \\sqrt{100.25}}{800}\n$$\n对该表达式进行数值计算，我们得到：\n$$\nh_{\\boldsymbol{t}} \\approx \\frac{3 \\times 10.0124922}{800} \\approx 0.03754684575\n$$\n四舍五入到六位有效数字， $h_{\\boldsymbol{t}} = 0.0375468$。\n\n(b) SUPG 稳定化参数 $\\tau$ 的推导与计算。\n\n对于长度为 $h$ 的线性单元上的一维常系数平流-扩散方程，最优 SUPG 稳定化参数由下式给出：\n$$\n\\tau_{\\text{1D}} = \\frac{h}{2\\beta} \\left( \\coth(Pe_{\\text{1D}}) - \\frac{1}{Pe_{\\text{1D}}} \\right)\n$$\n其中一维佩克莱数为 $Pe_{\\text{1D}} = \\frac{\\beta h}{2\\epsilon}$。\n\n为了推导多维情况下的表达式，我们通过一致地将一维量替换为它们的多维对应量来推广此公式。单元长度 $h$ 被沿流线的方向单元长度 $h_{\\boldsymbol{t}}$ 替换。标量速度 $\\beta$ 被其大小 $\\|\\boldsymbol{\\beta}\\|$ 替换。这得出了稳定化参数 $\\tau$ 的表达式：\n$$\n\\tau = \\frac{h_{\\boldsymbol{t}}}{2\\|\\boldsymbol{\\beta}\\|} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\n其中单元佩克莱数现在定义为：\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon}\n$$\n这就构成了所要求的推导。现在我们根据给定数据进行计算。首先，我们计算单元佩克莱数 $Pe$：\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon} = \\frac{\\sqrt{100.25}}{2 \\times 10^{-4}} \\left( \\frac{3 \\sqrt{100.25}}{800} \\right) = \\frac{3 (100.25)}{1600 \\times 10^{-4}} = \\frac{300.75}{0.16} = 1879.6875\n$$\n佩克莱数的值非常大，表示这是一个强平流主导的状态。对于大的自变量 $x$，双曲余切函数 $\\coth(x)$ 迅速趋近于 $1$。对于 $Pe = 1879.6875$，$\\coth(Pe)$ 的值在计算上与 $1$ 无法区分。因此，我们可以使用高佩克莱数的渐近形式。\n将 $h_{\\boldsymbol{t}}$ 和 $Pe$ 的表达式代入 $\\tau$ 的公式中：\n$$\n\\tau = \\frac{1}{2\\|\\boldsymbol{\\beta}\\|} \\left(\\frac{3 \\|\\boldsymbol{\\beta}\\|}{800}\\right) \\left( \\coth(Pe) - \\frac{1}{Pe} \\right) = \\frac{3}{1600} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\n使用 $Pe$ 的值和近似 $\\coth(Pe) \\approx 1$：\n$$\n\\tau \\approx \\frac{3}{1600} \\left( 1 - \\frac{1}{1879.6875} \\right)\n$$\n$$\n\\tau \\approx 0.001875 \\left( 1 - 0.0005320053... \\right) \\approx 0.001875 \\times 0.99946799... \\approx 0.00187400249\n$$\n四舍五入到六位有效数字，$\\tau = 0.00187400$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.0375468  0.00187400 \\end{pmatrix}}$$", "id": "2602150"}, {"introduction": "在计算出稳定参数后，最后一步是将其正确地整合到有限元组装流程中。这个问题详细剖析了在单元层面实现SUPG稳定项的算法，引导你思考如何在积分点上计算单元残差，并将其拆分为对刚度矩阵和载荷向量的贡献。理解这个过程为你编写高效、准确的SUPG计算代码提供了清晰的指南。[@problem_id:2602122]", "problem": "考虑在多边形区域 $\\Omega \\subset \\mathbb{R}^2$ 上提出的、具有适当的本质边界条件和自然边界条件的稳态平流-扩散-反应模型：求 $u:\\Omega \\to \\mathbb{R}$ 使得\n$$\n-\\nabla\\cdot\\left(\\kappa\\,\\nabla u\\right) + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{in }\\Omega,\n$$\n其中 $\\kappa>0$ 是扩散系数，$\\boldsymbol{\\beta}\\in\\mathbb{R}^2$ 是平流速度，$\\sigma\\ge 0$ 是反应系数，$f$ 是给定的源项。令 $V_h$ 为 $\\Omega$ 的一个协调三角剖分 $\\mathcal{T}_h$ 上的连续分片线性函数空间。在每个三角形 $K\\in\\mathcal{T}_h$上，令 $\\{N_i\\}_{i=1}^3$ 表示局部线性形函数，$\\nabla N_i$ 为其在 $K$ 上的常梯度。假设系数 $\\kappa|_K$、$\\boldsymbol{\\beta}|_K$ 和 $\\sigma|_K$ 在单元上是常数。\n\n经典 Galerkin 方法寻求 $u_h\\in V_h$，使得对于所有 $w_h\\in V_h$，\n$$\n\\sum_{K\\in\\mathcal{T}_h}\\int_K \\left(\\kappa\\,\\nabla u_h\\cdot\\nabla w_h + (\\boldsymbol{\\beta}\\cdot\\nabla u_h)\\,w_h + \\sigma\\,u_h\\,w_h\\right)\\,dx = \\sum_{K\\in\\mathcal{T}_h}\\int_K f\\,w_h\\,dx + \\text{边界贡献}.\n$$\n为了改善在平流主导区域的稳定性，流线迎风/Petrov–Galerkin (SUPG) 方法通过流线方向项 $w_h^{\\text{SUPG}} = w_h + \\tau_K\\,\\boldsymbol{\\beta}\\cdot\\nabla w_h$ 来丰富检验函数，其中 $\\tau_K>0$ 是一个单元稳定化参数。每个单元 $K$ 上的 SUPG 贡献由强残差构建\n$$\nr(u_h) := -\\nabla\\cdot\\left(\\kappa\\,\\nabla u_h\\right) + \\boldsymbol{\\beta}\\cdot\\nabla u_h + \\sigma\\,u_h - f,\n$$\n并通过添加单元项 $\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla w_h)\\,r(u_h)\\,dx$ 来修正弱形式。\n\n令 $\\{\\hat{\\boldsymbol{\\xi}}_q, \\hat{\\omega}_q\\}_{q=1}^{N_q}$ 为参考三角形 $\\hat{K}$ 上的一个求积法则，它对次数至少为 $1$ 的多项式是精确的。令 $F_K:\\hat{K}\\to K$ 为仿射单元映射，其雅可比矩阵为 $\\mathbf{J}_K$，行列式为 $J_K = \\det(\\mathbf{J}_K) > 0$。用 $\\boldsymbol{x}_q = F_K(\\hat{\\boldsymbol{\\xi}}_q)$ 表示物理求积点，用 $\\omega_q = \\hat{\\omega}_q\\,J_K$ 表示物理权重。\n\n下面的哪个选项给出了一个正确的单元级算法，用于在线性三角形单元 $K$ 上仅组装 SUPG 稳定化贡献，即单元矩阵 $K^{\\text{SUPG}}_e$ 和向量 $b^{\\text{SUPG}}_e$，使得全局系统接收到附加项\n$$\n\\sum_{K\\in\\mathcal{T}_h}\\left(K^{\\text{SUPG}}_e\\,\\boldsymbol{u}_e\\right) \\quad \\text{在左端和} \\quad \\sum_{K\\in\\mathcal{T}_h} b^{\\text{SUPG}}_e \\quad \\text{在右端},\n$$\n其中 $\\boldsymbol{u}_e$ 汇集了单元节点值，并且该算法明确使用在求积点处对 $r(u_h)$ 和 $\\boldsymbol{\\beta}\\cdot\\nabla w_h$ 的求值？\n\nA. 单元常系数、残差一致的 SUPG 组装：\n- 步骤 $1$：提取 $\\kappa|_K$、$\\boldsymbol{\\beta}|_K$、$\\sigma|_K$，并选择 $\\tau_K>0$。计算 $\\nabla N_i$（对于 $i\\in\\{1,2,3\\}$），并预计算 $\\boldsymbol{\\beta}\\cdot\\nabla N_i$（在 $K$ 上为常数）。将 $K^{\\text{SUPG}}_e\\in\\mathbb{R}^{3\\times 3}$ 和 $b^{\\text{SUPG}}_e\\in\\mathbb{R}^3$ 初始化为零。\n- 步骤 $2$：对于在 $\\boldsymbol{x}_q$ 处、权重为 $\\omega_q$ 的每个求积点 $q\\in\\{1,\\dots,N_q\\}$：\n  - 计算 $N_j(\\boldsymbol{x}_q)$（对于 $j\\in\\{1,2,3\\}$）；计算 $u_h(\\boldsymbol{x}_q) = \\sum_{j=1}^3 N_j(\\boldsymbol{x}_q)\\,u_j$ 和 $\\nabla u_h = \\sum_{j=1}^3 \\nabla N_j\\,u_j$。\n  - 计算强残差 $r_q := -\\nabla\\cdot(\\kappa\\,\\nabla u_h) + \\boldsymbol{\\beta}\\cdot\\nabla u_h + \\sigma\\,u_h(\\boldsymbol{x}_q) - f(\\boldsymbol{x}_q)$。对于具有单元常数 $\\kappa$ 的线性三角形，注意在 $K$ 中 $\\nabla\\cdot(\\kappa\\,\\nabla u_h)=0$。\n  - 对于每个检验索引 $i\\in\\{1,2,3\\}$ 和试验索引 $j\\in\\{1,2,3\\}$，累加\n    $$\n    K^{\\text{SUPG}}_{e,ij}\\;{+}{=}\\;\\omega_q\\,\\tau_K\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_i\\right)\\,\\Big(\\boldsymbol{\\beta}\\cdot\\nabla N_j + \\sigma\\,N_j(\\boldsymbol{x}_q)\\Big).\n    $$\n  - 对于每个检验索引 $i\\in\\{1,2,3\\}$，累加右端项\n    $$\n    b^{\\text{SUPG}}_{e,i}\\;{+}{=}\\;\\omega_q\\,\\tau_K\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_i\\right)\\,f(\\boldsymbol{x}_q).\n    $$\n- 步骤 $3$：将 $K^{\\text{SUPG}}_e$ 加到全局刚度矩阵，将 $b^{\\text{SUPG}}_e$ 加到全局载荷向量。对于单元常数，这精确地实现了 $\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla w_h)\\,\\big(\\boldsymbol{\\beta}\\cdot\\nabla u_h + \\sigma\\,u_h - f\\big)\\,dx$，同时正确地承认了对于线性的 $u_h$ 和常数 $\\kappa$，在 $K$ 中 $-\\nabla\\cdot(\\kappa\\,\\nabla u_h)=0$。\n\nB. 仅载荷的残差注入：\n- 步骤 $1$：选择 $\\tau_K>0$，在 $K$ 上计算 $\\nabla N_i$ 和 $\\boldsymbol{\\beta}\\cdot\\nabla N_i$；设置 $K^{\\text{SUPG}}_e=\\boldsymbol{0}$。\n- 步骤 $2$：对于每个求积点 $q$，计算 $u_h(\\boldsymbol{x}_q)$ 和 $\\nabla u_h$；如上形成 $r_q$ 并仅组装\n  $$\n  b^{\\text{SUPG}}_{e,i}\\;{+}{=}\\;\\omega_q\\,\\tau_K\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_i\\right)\\,r_q\n  $$\n  对于 $i\\in\\{1,2,3\\}$。不向刚度矩阵添加任何 SUPG 贡献。\n\nC. 带集中流线检验的类平流质量 SUPG：\n- 步骤 $1$：计算 $\\nabla N_i$ 和 $N_i(\\boldsymbol{x}_q)$；选择 $\\tau_K>0$。\n- 步骤 $2$：对于每个求积点 $q$，组装\n  $$\n  K^{\\text{SUPG}}_{e,ij}\\;{+}{=}\\;\\omega_q\\,\\tau_K\\,\\left|\\boldsymbol{\\beta}\\right|\\,N_i(\\boldsymbol{x}_q)\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_j\\right),\n  $$\n  并设置 $b^{\\text{SUPG}}_e=\\boldsymbol{0}$。这将 $\\boldsymbol{\\beta}\\cdot\\nabla w_h$ 替换为 $\\left|\\boldsymbol{\\beta}\\right|\\,w_h$ 以简化计算。\n\nD. 在 K 内恢复 $-\\nabla\\cdot(\\kappa\\nabla u_h)$ 的扩散增强 SUPG：\n- 步骤 $1$：计算 $\\nabla N_i$、$\\boldsymbol{\\beta}\\cdot\\nabla N_i$ 和一个离散拉普拉斯算子近似 $\\Delta u_h|_{K} \\approx \\sum_{j=1}^3 u_j\\,\\Delta N_j$；选择 $\\tau_K>0$。\n- 步骤 $2$：对于每个 $q$，设置\n  $$\n  K^{\\text{SUPG}}_{e,ij}\\;{+}{=}\\;\\omega_q\\,\\tau_K\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_i\\right)\\,\\Big(-\\kappa\\,\\Delta N_j + \\boldsymbol{\\beta}\\cdot\\nabla N_j + \\sigma\\,N_j(\\boldsymbol{x}_q)\\Big),\n  $$\n  和\n  $$\n  b^{\\text{SUPG}}_{e,i}\\;{+}{=}\\;\\omega_q\\,\\tau_K\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_i\\right)\\,f(\\boldsymbol{x}_q).\n  $$\n\nE. 源项符号反转的 SUPG：\n- 步骤 $1$：计算 $\\nabla N_i$ 和 $\\boldsymbol{\\beta}\\cdot\\nabla N_i$；选择 $\\tau_K>0$。\n- 步骤 $2$：对于每个 $q$，组装\n  $$\n  K^{\\text{SUPG}}_{e,ij}\\;{+}{=}\\;\\omega_q\\,\\tau_K\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_i\\right)\\,\\Big(\\boldsymbol{\\beta}\\cdot\\nabla N_j + \\sigma\\,N_j(\\boldsymbol{x}_q)\\Big)\n  $$\n  和\n  $$\n  b^{\\text{SUPG}}_{e,i}\\;{+}{=}\\;-\\omega_q\\,\\tau_K\\,\\left(\\boldsymbol{\\beta}\\cdot\\nabla N_i\\right)\\,f(\\boldsymbol{x}_q),\n  $$\n  使得源项贡献以负号进入左端。\n\n选择正确的选项。", "solution": "我们从控制方程开始\n$$\n-\\nabla\\cdot(\\kappa\\,\\nabla u) + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{in }\\Omega,\n$$\n其中 $\\kappa>0$, $\\boldsymbol{\\beta}\\in\\mathbb{R}^2$, $\\sigma\\ge 0$。在三角形网格上，使用连续分片线性的试验和检验空间，经典的 Galerkin 弱形式增加了扩散、平流和反应双线性形式以及一个源项线性形式。流线迎风/Petrov–Galerkin (SUPG) 修正是通过 $w_h^{\\text{SUPG}} = w_h + \\tau_K\\,\\boldsymbol{\\beta}\\cdot\\nabla w_h$ 来丰富检验函数。在每个单元 $K$ 上的附加 SUPG 项是\n$$\n\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla w_h)\\,r(u_h)\\,dx,\n$$\n其中强残差为\n$$\nr(u_h) = -\\nabla\\cdot(\\kappa\\,\\nabla u_h) + \\boldsymbol{\\beta}\\cdot\\nabla u_h + \\sigma\\,u_h - f.\n$$\n对于具有单元常数 $\\kappa$ 的线性三角形，我们在 $K$ 上有 $\\nabla u_h$ 为常数，因此在 $K$ 的内部，$\\nabla\\cdot(\\kappa\\,\\nabla u_h) = \\kappa\\,\\nabla\\cdot(\\nabla u_h) = \\kappa\\,\\Delta u_h = 0$。因此，在此类单元上，\n$$\nr(u_h) = \\boldsymbol{\\beta}\\cdot\\nabla u_h + \\sigma\\,u_h - f \\quad \\text{在 }K \\text{ 中逐点成立}。\n$$\n令 $\\{N_i\\}_{i=1}^3$ 为 $K$ 上的局部基函数，并注意 $\\nabla N_i$ 在 $K$ 上是常数。当用节点未知数 $\\{u_j\\}_{j=1}^3$ 表示时，对离散方程的 SUPG 贡献具有以下形式\n$$\n\\sum_{i=1}^3 \\sum_{j=1}^3 \\left[\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,\\big(\\boldsymbol{\\beta}\\cdot\\nabla N_j + \\sigma\\,N_j\\big)\\,dx\\right] u_j\n=\n\\sum_{i=1}^3 \\left[\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,f\\,dx\\right],\n$$\n这确定了单元级矩阵和向量的项为\n$$\nK^{\\text{SUPG}}_{e,ij} = \\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,\\big(\\boldsymbol{\\beta}\\cdot\\nabla N_j + \\sigma\\,N_j\\big)\\,dx,\n\\qquad\nb^{\\text{SUPG}}_{e,i} = \\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,f\\,dx.\n$$\n这些积分通过数值求积来计算。在参考三角形 $\\hat{K}$ 上使用一个求积法则 $\\{\\hat{\\boldsymbol{\\xi}}_q,\\hat{\\omega}_q\\}_{q=1}^{N_q}$，通过仿射映射 $F_K$ 和雅可比行列式 $J_K$，定义 $\\boldsymbol{x}_q=F_K(\\hat{\\boldsymbol{\\xi}}_q)$ 和 $\\omega_q=\\hat{\\omega}_q\\,J_K$。对于具有单元常数的线性单元，被积函数在空间上最多是线性的，因此一个对次数至少为1的多项式精确的求积法则就足够了。单元组装过程如下：\n- 预计算 $\\nabla N_i$ 和 $\\boldsymbol{\\beta}\\cdot\\nabla N_i$（在 $K$ 上为常数）并选择 $\\tau_K$。\n- 对于每个求积点 q，计算 $N_j(\\boldsymbol{x}_q)$、$u_h(\\boldsymbol{x}_q)=\\sum_j N_j(\\boldsymbol{x}_q)\\,u_j$、$\\nabla u_h=\\sum_j \\nabla N_j\\,u_j$，然后计算 $r_q = \\boldsymbol{\\beta}\\cdot\\nabla u_h + \\sigma\\,u_h(\\boldsymbol{x}_q) - f(\\boldsymbol{x}_q)$。\n- 通过 $\\omega_q\\,\\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_j + \\sigma\\,N_j(\\boldsymbol{x}_q))$ 累加矩阵项，并通过 $\\omega_q\\,\\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,f(\\boldsymbol{x}_q)$ 累加右端项。\n\n这个过程与以下原则一致：对于一个线性问题，SUPG 项对左端（通过 $r(u_h)$ 中依赖于 $u_h$ 的部分）和右端（通过源项 $f$）都有贡献。考虑到这一点，我们分析每个选项。\n\n选项 A：此选项遵循 Petrov–Galerkin 定义。它：\n- 在单元积分中使用了 $w_h^{\\text{SUPG}}-w_h=\\tau_K\\,\\boldsymbol{\\beta}\\cdot\\nabla w_h$。\n- 逐点形成强残差，并正确地认识到对于分片线性的 $u_h$ 和单元常数 $\\kappa$，在 $K$ 内部 $-\\nabla\\cdot(\\kappa\\nabla u_h)=0$。\n- 将 SUPG 项分为一个双线性贡献 $\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_j + \\sigma\\,N_j)\\,dx$ 和一个线性贡献 $\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,f\\,dx$，与上面的推导相匹配。\n- 通过 $\\boldsymbol{\\beta}\\cdot\\nabla N_i$（其在 $K$ 上为常数）来计算 $\\boldsymbol{\\beta}\\cdot\\nabla w_h$，并对 $N_j$ 和 $f$ 的相关性使用数值求积。\n因此，选项 A 是正确的。\n\n选项 B：此选项通过插入当前的离散残差 $r_q$ 仅组装右端向量，并设置 $K^{\\text{SUPG}}_e=\\boldsymbol{0}$。对于一个线性问题，这会产生一个不一致的离散化，因为 SUPG 项在 $u_h$ 中是线性的，必须通过 $r(u_h)$ 中依赖于 $u_h$ 的部分对左端有贡献。将整个 SUPG 项作为载荷处理，会使该方法依赖于非线性迭代（即使底层算子是线性的），并且，在不形成相应切线的情况下，会导致矩阵中没有稳定化作用，或者导致一个与 SUPG 双线性形式不等价的不动点线性化。因此，选项 B 是不正确的。\n\n选项 C：此选项将流线加权的检验函数导数 $\\boldsymbol{\\beta}\\cdot\\nabla w_h$ 替换为 $\\left|\\boldsymbol{\\beta}\\right|\\,w_h$。这违反了 Petrov–Galerkin 定义，因为稳定化必须通过 $w_h$ 的导数在流线方向上起作用，而不是通过 $w_h$ 本身按 $\\left|\\boldsymbol{\\beta}\\right|$ 缩放。得到的 $K^{\\text{SUPG}}_e$ 与 SUPG 项不一致，并引入了一个人为的类质量项而不是流线扩散，并且它忽略了强残差所要求的反应和源项贡献。因此，选项 C 是不正确的。\n\n选项 D：此选项试图通过 $-\\kappa\\,\\Delta N_j$ 将扩散项并入 SUPG 残差中。对于仿射三角形上的线性形函数，我们在 $K$ 中有 $\\Delta N_j=0$，所以 $-\\kappa\\,\\Delta N_j$ 项为零，不应出现。包含此项的非零近似与单元常数 $\\kappa$ 的精确残差结构相矛盾。因此，该选项要么增加了伪扩散，要么依赖于不一致的二阶导数恢复。因此，选项 D 是不正确的。\n\n选项 E：此选项具有正确的左端双线性形式，但在右端项中引入了带负号的源项，即 $b^{\\text{SUPG}}_{e,i} = -\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla N_i)\\,f\\,dx$。根据定义 $r(u_h)= (\\text{operator on }u_h) - f$，弱形式中的 SUPG 项是 $\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla w_h)\\,\\big[(\\text{operator on }u_h) - f\\big]\\,dx$。涉及 $u_h$ 的贡献属于左端，而带有 $-f$ 的项作为 $+\\int_K \\tau_K\\,(\\boldsymbol{\\beta}\\cdot\\nabla w_h)\\,f\\,dx$ 移动到右端。因此，$b^{\\text{SUPG}}_e$ 中源项贡献的正确符号是正号，而不是负号。因此，选项 E 是不正确的。\n\n总而言之，只有选项 A 匹配 SUPG 公式、具有单元常系数的线性三角形的强残差结构，以及在求积点计算 $r(u_h)$ 和 $\\boldsymbol{\\beta}\\cdot\\nabla w_h$ 所需的基于求积的组装方法。", "answer": "$$\\boxed{A}$$", "id": "2602122"}]}