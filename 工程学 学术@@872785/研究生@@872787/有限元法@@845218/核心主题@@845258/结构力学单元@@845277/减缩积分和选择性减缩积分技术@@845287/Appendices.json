{"hands_on_practices": [{"introduction": "在深入探讨降阶积分的复杂性与潜在缺陷之前，我们必须首先理解为何它能成为一个精确而强大的工具。任何有效的有限元都必须满足一个基本要求，即通过“单元检验”(patch test)，这意味着它能够精确地表示一个常应变状态。\n\n本练习 [@problem_id:2592719] 通过对一个Q4单元施加线性位移场来展示这一原理。通过完成此实践，您将证明降阶积分和完全积分方案均能得到完全相同且精确的应变能，从而验证单元的基本一致性。", "problem": "考虑在二维平面应力线性弹性问题的有限元法(FEM)中，一个单一的等参双线性四边形单元(Q4)。该单元在物理坐标中占据一个单位正方形，节点按逆时针排序，分别为节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(1,0)$，节点 $3$ 位于 $(1,1)$，以及节点 $4$ 位于 $(0,1)$。假设单元厚度为单位1。材料是均匀、各向同性的线性弹性体，其杨氏模量为 $E$，泊松比为 $\\nu$。\n\n使用母坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 以及标准的等参映射 $x=(1+\\xi)/2$，$y=(1+\\eta)/2$。双线性形函数为\n$$\nN_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}.\n$$\n设平面应力本构矩阵的 Voigt 形式为\n$$\n\\mathbf{D}=\\frac{E}{1-\\nu^{2}}\n\\begin{bmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{bmatrix}.\n$$\n设应变-位移矩阵 $\\mathbf{B}(\\xi,\\eta)$ 按照二维问题的常规方式由形函数导数组装而成，位移向量为 $\\mathbf{d}=[u_{1},v_{1},u_{2},v_{2},u_{3},v_{3},u_{4},v_{4}]^{\\top}$：\n$$\n\\boldsymbol{\\varepsilon}(\\xi,\\eta)=\\mathbf{B}(\\xi,\\eta)\\,\\mathbf{d},\\quad\n\\mathbf{B}_{i}(\\xi,\\eta)=\n\\begin{bmatrix}\n\\frac{\\partial N_{i}}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_{i}}{\\partial y} \\\\\n\\frac{\\partial N_{i}}{\\partial y}  \\frac{\\partial N_{i}}{\\partial x}\n\\end{bmatrix},\\quad\n\\mathbf{B}=[\\mathbf{B}_{1}\\ \\mathbf{B}_{2}\\ \\mathbf{B}_{3}\\ \\mathbf{B}_{4}],\n$$\n该单元上的雅可比行列式为 $|J|=1/4$。\n\n设 $\\mathbf{K}$ 使用高斯积分进行组装，如下所示\n$$\n\\mathbf{K}=\\int_{\\Omega}\\mathbf{B}^{\\top}\\mathbf{D}\\mathbf{B}\\,\\mathrm{d}A\n=\\int_{-1}^{1}\\int_{-1}^{1}\\mathbf{B}(\\xi,\\eta)^{\\top}\\mathbf{D}\\mathbf{B}(\\xi,\\eta)\\,|J|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n并用以下方法进行近似：\n- 采用完全 $2\\times 2$ 高斯法则，积分点为 $(\\xi,\\eta)=\\left(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3}\\right)$，权重为单位1，以及\n- 采用减缩 $1\\times 1$ 高斯法则，积分点为 $(\\xi,\\eta)=(0,0)$，权重为 $4$。\n\n现在考虑线性位移场\n$$\nu(x,y)=a\\,x+b\\,y,\\qquad v(x,y)=c\\,x+d\\,y,\n$$\n其中 $a,b,c,d$ 为常数。设 $\\mathbf{d}$ 是通过在单元节点处计算 $(u,v)$ 得到的相应节点位移向量。\n\n使用 $2\\times 2$ 积分和 $1\\times 1$ 积分计算单元预测的应变能，\n$$\nU_{2\\times 2}=\\frac{1}{2}\\,\\mathbf{d}^{\\top}\\mathbf{K}_{2\\times 2}\\mathbf{d},\\qquad\nU_{1\\times 1}=\\frac{1}{2}\\,\\mathbf{d}^{\\top}\\mathbf{K}_{1\\times 1}\\mathbf{d},\n$$\n并将每个表达式简化为关于 $a,b,c,d,E,\\nu$ 的闭式表达式。报告一个同时等于 $U_{2\\times 2}$ 和 $U_{1\\times 1}$ 的单一简化解析表达式。不需要进行数值计算。将最终答案表示为单一解析公式；最终答案框中不要包含单位。", "solution": "经审查，该问题陈述是有效的。这是有限元分析领域的一个适定问题，科学上是合理的，并包含了获得唯一解所需的所有信息。这是一个双线性四边形单元的单元检验（patch test）的标准演示。\n\n其核心原理是，双线性等参单元可以精确地表示在笛卡尔坐标系下为线性的位移场。因此，由有限元近似计算出的应变场在整个单元内是恒定的，并且与精确的解析应变场相同。总应变能是应变二次型的积分，因此任何能够精确积分常数函数的数值积分法则都能精确计算它。$1 \\times 1$ 和 $2 \\times 2$ 高斯积分法则都满足这个条件。\n\n让我们逐步证明这一点。\n\n首先，我们从给定的线性位移场确定精确应变场：\n$$\nu(x,y) = a x + b y\n$$\n$$\nv(x,y) = c x + d y\n$$\n应变张量在 Voigt 记法下的分量 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{x}, \\varepsilon_{y}, \\gamma_{xy}]^{\\top}$ 为：\n$$\n\\varepsilon_{x} = \\frac{\\partial u}{\\partial x} = a\n$$\n$$\n\\varepsilon_{y} = \\frac{\\partial v}{\\partial y} = d\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = b + c\n$$\n精确应变向量在整个单元内是恒定的：$\\boldsymbol{\\varepsilon}_{\\text{exact}} = [a, d, b+c]^{\\top}$。\n\n接下来，我们将四个节点的坐标代入位移场函数来计算节点位移。节点为 $1:(0,0)$，$2:(1,0)$，$3:(1,1)$ 和 $4:(0,1)$。\n$$\nu_1 = u(0,0) = 0, \\quad v_1 = v(0,0) = 0\n$$\n$$\nu_2 = u(1,0) = a, \\quad v_2 = v(1,0) = c\n$$\n$$\nu_3 = u(1,1) = a+b, \\quad v_3 = v(1,1) = c+d\n$$\n$$\nu_4 = u(0,1) = b, \\quad v_4 = v(0,1) = d\n$$\n节点位移向量 $\\mathbf{d}$ 为：\n$$\n\\mathbf{d} = [0, 0, a, c, a+b, c+d, b, d]^{\\top}\n$$\n\n现在，我们使用有限元公式 $\\boldsymbol{\\varepsilon}(\\xi, \\eta) = \\mathbf{B}(\\xi, \\eta)\\mathbf{d}$ 来计算单元内的应变场。应变分量由下式给出：\n$$\n\\varepsilon_x(\\xi,\\eta) = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial x} u_i, \\quad \\varepsilon_y(\\xi,\\eta) = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial y} v_i, \\quad \\gamma_{xy}(\\xi,\\eta) = \\sum_{i=1}^{4} \\left(\\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i\\right)\n$$\n为了求导数 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$，我们对等参映射 $x=(1+\\xi)/2$，$y=(1+\\eta)/2$ 使用链式法则和雅可比矩阵。\n雅可比矩阵为 $\\mathbf{J} = \\begin{bmatrix} \\partial x/\\partial\\xi  \\partial y/\\partial\\xi \\\\ \\partial x/\\partial\\eta  \\partial y/\\partial\\eta \\end{bmatrix} = \\begin{bmatrix} 1/2  0 \\\\ 0  1/2 \\end{bmatrix}$。其逆矩阵为 $\\mathbf{J}^{-1} = \\begin{bmatrix} 2  0 \\\\ 0  2 \\end{bmatrix}$。\n因此，$\\frac{\\partial}{\\partial x} = 2\\frac{\\partial}{\\partial\\xi}$ 且 $\\frac{\\partial}{\\partial y} = 2\\frac{\\partial}{\\partial\\eta}$。\n形函数关于笛卡尔坐标的导数为：\n$$\n\\frac{\\partial N_1}{\\partial x} = -\\frac{1}{2}(1-\\eta), \\quad \\frac{\\partial N_1}{\\partial y} = -\\frac{1}{2}(1-\\xi)\n$$\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{2}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}(1+\\xi)\n$$\n$$\n\\frac{\\partial N_3}{\\partial x} = \\frac{1}{2}(1+\\eta), \\quad \\frac{\\partial N_3}{\\partial y} = \\frac{1}{2}(1+\\xi)\n$$\n$$\n\\frac{\\partial N_4}{\\partial x} = -\\frac{1}{2}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial y} = \\frac{1}{2}(1-\\xi)\n$$\n将这些代入 $\\varepsilon_x$ 的表达式中：\n$$\n\\varepsilon_x = \\frac{\\partial N_2}{\\partial x} u_2 + \\frac{\\partial N_3}{\\partial x} u_3 + \\frac{\\partial N_4}{\\partial x} u_4 = \\frac{1}{2}(1-\\eta) a + \\frac{1}{2}(1+\\eta) (a+b) - \\frac{1}{2}(1+\\eta) b\n$$\n$$\n\\varepsilon_x = \\frac{a}{2} - \\frac{a\\eta}{2} + \\frac{a}{2} + \\frac{a\\eta}{2} + \\frac{b}{2} + \\frac{b\\eta}{2} - \\frac{b}{2} - \\frac{b\\eta}{2} = a\n$$\n同样对于 $\\varepsilon_y$：\n$$\n\\varepsilon_y = \\frac{\\partial N_2}{\\partial y} v_2 + \\frac{\\partial N_3}{\\partial y} v_3 + \\frac{\\partial N_4}{\\partial y} v_4 = -\\frac{1}{2}(1+\\xi) c + \\frac{1}{2}(1+\\xi) (c+d) + \\frac{1}{2}(1-\\xi) d\n$$\n$$\n\\varepsilon_y = -\\frac{c}{2} - \\frac{c\\xi}{2} + \\frac{c}{2} + \\frac{c\\xi}{2} + \\frac{d}{2} + \\frac{d\\xi}{2} + \\frac{d}{2} - \\frac{d\\xi}{2} = d\n$$\n以及对于 $\\gamma_{xy}$：\n$$\n\\gamma_{xy} = \\left(\\frac{\\partial N_2}{\\partial y}u_2 + \\frac{\\partial N_2}{\\partial x}v_2\\right) + \\left(\\frac{\\partial N_3}{\\partial y}u_3 + \\frac{\\partial N_3}{\\partial x}v_3\\right) + \\left(\\frac{\\partial N_4}{\\partial y}u_4 + \\frac{\\partial N_4}{\\partial x}v_4\\right)\n$$\n$$\n\\gamma_{xy} = \\left(-\\frac{a}{2}(1+\\xi) + \\frac{c}{2}(1-\\eta)\\right) + \\left(\\frac{a+b}{2}(1+\\xi) + \\frac{c+d}{2}(1+\\eta)\\right) + \\left(\\frac{b}{2}(1-\\xi) - \\frac{d}{2}(1+\\eta)\\right)\n$$\n$$\n\\gamma_{xy} = (1+\\xi)\\left(-\\frac{a}{2}+\\frac{a+b}{2}\\right) + (1-\\xi)\\left(\\frac{b}{2}\\right) + (1-\\eta)\\left(\\frac{c}{2}\\right) + (1+\\eta)\\left(\\frac{c+d}{2}-\\frac{d}{2}\\right)\n$$\n$$\n\\gamma_{xy} = \\frac{b}{2}(1+\\xi) + \\frac{b}{2}(1-\\xi) + \\frac{c}{2}(1-\\eta) + \\frac{c}{2}(1+\\eta) = \\frac{b}{2}+\\frac{b\\xi}{2}+\\frac{b}{2}-\\frac{b\\xi}{2} + \\frac{c}{2}-\\frac{c\\eta}{2}+\\frac{c}{2}+\\frac{c\\eta}{2} = b+c\n$$\n由单元计算出的应变向量 $\\boldsymbol{\\varepsilon}_{FEM} = [a, d, b+c]^{\\top}$ 是恒定的，并且与 $\\boldsymbol{\\varepsilon}_{\\text{exact}}$ 相同。\n\n应变能通过积分 $U = \\frac{1}{2} \\int_{\\Omega} \\boldsymbol{\\varepsilon}^{\\top} \\mathbf{D} \\boldsymbol{\\varepsilon} \\, \\mathrm{d}A$ 计算。在有限元背景下，这变为\n$$\nU = \\frac{1}{2} \\int_{\\Omega} (\\mathbf{B}\\mathbf{d})^{\\top} \\mathbf{D} (\\mathbf{B}\\mathbf{d}) \\, \\mathrm{d}A = \\frac{1}{2} \\int_{-1}^{1}\\int_{-1}^{1} \\boldsymbol{\\varepsilon}_{FEM}^{\\top} \\mathbf{D} \\boldsymbol{\\varepsilon}_{FEM} |J| \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\n由于 $\\boldsymbol{\\varepsilon}_{FEM} = \\boldsymbol{\\varepsilon}_{\\text{exact}}$ 是一个常向量，整个被积函数 $\\boldsymbol{\\varepsilon}_{\\text{exact}}^{\\top} \\mathbf{D} \\boldsymbol{\\varepsilon}_{\\text{exact}} |J|$ 是一个常标量值。减缩 $1 \\times 1$ 和完全 $2 \\times 2$ 高斯积分方案都能精确地积分常数函数。因此，$U_{1 \\times 1} = U_{2 \\times 2}$，并且两者都等于精确的解析应变能。\n\n总应变能等于常数应变能密度 $W = \\frac{1}{2}\\boldsymbol{\\varepsilon}_{\\text{exact}}^{\\top}\\mathbf{D}\\boldsymbol{\\varepsilon}_{\\text{exact}}$ 乘以单元的面积，即 $1 \\times 1 = 1$。\n$$\nU = \\frac{1}{2} \\boldsymbol{\\varepsilon}_{\\text{exact}}^{\\top} \\mathbf{D} \\boldsymbol{\\varepsilon}_{\\text{exact}}\n$$\n代入矩阵和向量：\n$$\nU = \\frac{1}{2} \\begin{bmatrix} a  d  b+c \\end{bmatrix} \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{bmatrix} a \\\\ d \\\\ b+c \\end{bmatrix}\n$$\n$$\nU = \\frac{E}{2(1-\\nu^2)} \\begin{bmatrix} a  d  b+c \\end{bmatrix} \\begin{bmatrix} a+\\nu d \\\\ \\nu a+d \\\\ \\frac{1-\\nu}{2}(b+c) \\end{bmatrix}\n$$\n$$\nU = \\frac{E}{2(1-\\nu^2)} \\left[ a(a+\\nu d) + d(\\nu a+d) + (b+c)\\left(\\frac{1-\\nu}{2}(b+c)\\right) \\right]\n$$\n$$\nU = \\frac{E}{2(1-\\nu^2)} \\left[ a^2 + \\nu ad + \\nu ad + d^2 + \\frac{1-\\nu}{2}(b+c)^2 \\right]\n$$\n简化的最终表达式为：\n$$\nU = \\frac{E}{2(1-\\nu^2)} \\left[ a^2 + d^2 + 2\\nu ad + \\frac{1-\\nu}{2}(b+c)^2 \\right]\n$$\n这个单一表达式同时代表了 $U_{2 \\times 2}$ 和 $U_{1 \\times 1}$，正如我们的分析所证明的那样。", "answer": "$$ \\boxed{\\frac{E}{2(1-\\nu^2)} \\left( a^2 + d^2 + 2\\nu ad + \\frac{1-\\nu}{2}(b+c)^2 \\right)} $$", "id": "2592719"}, {"introduction": "虽然降阶积分对于常应变状态是精确的，但对于更一般的情况，它是一种近似，这可能导致误差和伪零能模式（即沙漏模式）。为了有效运用此技术，我们必须理解其近似的精确本质。\n\n本实践 [@problem_id:2592725] 要求您为一个通用多项式推导单点求积规则的显式积分误差。此分析将精确揭示降阶积分忽略了哪些多项式项，从而为降阶积分相关的计算不准确和不稳定性问题提供了清晰的数学溯源。", "problem": "考虑参考方形域 $\\Omega = [-1,1] \\times [-1,1]$ 以及通过在每个坐标方向上使用单点 Gauss–Legendre 法则得到的张量积高斯求积法则（即，在中心点进行单点求值的减缩积分法则）。在一维区间 $[-1,1]$ 上，单点 Gauss–Legendre 法则的节点为 $x = 0$，权重为 $2$。因此，二维张量积法则在点 $(x,y) = (0,0)$ 处求值，总权重为 $4$。在使用等参双线性单元的有限元方法中，这是对参考方形上的单元级积分所采用的标准减缩积分。\n\n设被积函数为以下总次数至多为 $4$ 的多项式，\n$$\np(x,y)\n= a_{00}\n+ a_{10} x + a_{01} y + a_{11} x y\n+ a_{20} x^{2} + a_{02} y^{2}\n+ a_{21} x^{2} y + a_{12} x y^{2}\n+ a_{22} x^{2} y^{2}\n+ a_{40} x^{4} + a_{04} y^{4},\n$$\n其中系数 $a_{ij} \\in \\mathbb{R}$ 为实数。定义精确积分\n$$\nI[p] \\equiv \\int_{-1}^{1} \\int_{-1}^{1} p(x,y) \\, \\mathrm{d}y \\, \\mathrm{d}x,\n$$\n以及减缩（单点）求积近似\n$$\nQ_{\\mathrm{red}}[p] \\equiv 4 \\, p(0,0).\n$$\n\n仅从对称区间上多项式积分的基本性质和张量积求积法则的定义出发，显式地构造积分误差\n$$\nE(a_{00},a_{10},a_{01},a_{11},a_{20},a_{02},a_{21},a_{12},a_{22},a_{40},a_{04}) \\equiv I[p] - Q_{\\mathrm{red}}[p]\n$$\n使其成为一个关于系数 $a_{ij}$ 的闭式解析表达式。你的推导过程必须清楚地说明减缩积分法则忽略了哪些多项式矩，以及它们是如何进入误差的。将你的最终答案表示为关于系数 $a_{ij}$ 的单一简化解析表达式。无需进行取整。", "solution": "问题陈述已经过评估并被确定为有效。它在科学上是合理的、良定的，并且没有歧义。它提出了一个在有限元方法背景下，数值积分领域内的标准、可形式化的问题。因此，我们可以着手进行推导。\n\n目标是求出给定多项式 $p(x,y)$ 的积分误差 $E$，它被定义为精确积分 $I[p]$ 与求积近似 $Q_{\\mathrm{red}}[p]$ 之间的差值。误差由下式给出\n$$\nE \\equiv I[p] - Q_{\\mathrm{red}}[p] = \\int_{-1}^{1} \\int_{-1}^{1} p(x,y) \\, \\mathrm{d}y \\, \\mathrm{d}x - 4 \\, p(0,0).\n$$\n我们将分析多项式 $p(x,y)$ 中每一项对总误差的贡献。该多项式为\n$$\np(x,y)\n= a_{00}\n+ a_{10} x + a_{01} y + a_{11} x y\n+ a_{20} x^{2} + a_{02} y^{2}\n+ a_{21} x^{2} y + a_{12} x y^{2}\n+ a_{22} x^{2} y^{2}\n+ a_{40} x^{4} + a_{04} y^{4}.\n$$\n由于积分算子和求积算子都具有线性性，我们可以计算每个单项式项 $a_{ij} x^i y^j$ 的误差，然后将结果相加。单项的误差为\n$$\nE_{ij} = a_{ij} \\left( \\int_{-1}^{1} \\int_{-1}^{1} x^i y^j \\, \\mathrm{d}y \\, \\mathrm{d}x - 4 \\cdot (0^i 0^j) \\right),\n$$\n其中我们采用约定 $0^0 = 1$。\n\n我们首先计算一般单项式 $x^i y^j$ 在域 $\\Omega = [-1,1] \\times [-1,1]$ 上的精确积分。利用积分的可分离性：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} x^i y^j \\, \\mathrm{d}y \\, \\mathrm{d}x = \\left( \\int_{-1}^{1} x^i \\, \\mathrm{d}x \\right) \\left( \\int_{-1}^{1} y^j \\, \\mathrm{d}y \\right).\n$$\n在对称区间 $[-L, L]$ 上积分的一个基本性质是，奇函数的积分为零，而偶函数的积分等于其在 $[0, L]$ 上积分的两倍。对于在 $[-1, 1]$ 上的多项式项 $z^k$：\n$$\n\\int_{-1}^{1} z^k \\, \\mathrm{d}z =\n\\begin{cases}\n0  \\text{若 } k \\text{ 为奇数} \\\\\n\\frac{2}{k+1}  \\text{若 } k \\text{ 为偶数}\n\\end{cases}\n$$\n因此，二重积分 $\\int_{-1}^{1} \\int_{-1}^{1} x^i y^j \\, \\mathrm{d}y \\, \\mathrm{d}x$ 仅当指数 $i$ 和 $j$ 均为偶数时才非零。在这种情况下，其值为\n$$\n\\left( \\frac{2}{i+1} \\right) \\left( \\frac{2}{j+1} \\right) = \\frac{4}{(i+1)(j+1)}.\n$$\n\n接下来，我们分析单项式 $a_{ij} x^i y^j$ 的求积近似。法则是 $Q_{\\mathrm{red}}[p] \\equiv 4 \\, p(0,0)$。\n$$\nQ_{\\mathrm{red}}[a_{ij} x^i y^j] = 4 \\cdot a_{ij} \\cdot (0^i 0^j).\n$$\n该表达式仅在 $i=0$ 和 $j=0$ 的常数项情况下非零。对于此情况，$Q_{\\mathrm{red}}[a_{00}] = 4 a_{00}$。对于所有其他 $i>0$ 或 $j>0$ 的单项式 $a_{ij} x^i y^j$，求积法则的结果为零。\n\n现在，我们通过检查多项式 $p(x,y)$ 的每一项来系统地构造误差。\n\n1.  至少有一个奇次指数的项（例如，$a_{10}x, a_{01}y, a_{11}xy, a_{21}x^2y, a_{12}xy^2$）：\n    对于任何此类项 $a_{ij}x^i y^j$，$i$ 或 $j$（或两者）为奇数。其精确积分为零。求积近似也为零，因为该项在 $(0,0)$ 处为零。\n    $$\n    I[a_{ij}x^i y^j] = 0, \\quad Q_{\\mathrm{red}}[a_{ij}x^i y^j] = 0 \\implies E_{ij} = 0.\n    $$\n    因此，单点求积法则对于所有至少在一个变量上是奇次的单项式都是精确的。\n\n2.  常数项 ($a_{00}$):\n    这里，$i=0$ 且 $j=0$。\n    $$\n    I[a_{00}] = a_{00} \\int_{-1}^{1} \\int_{-1}^{1} 1 \\, \\mathrm{d}y \\, \\mathrm{d}x = 4a_{00}.\n    $$\n    $$\n    Q_{\\mathrm{red}}[a_{00}] = 4 \\cdot a_{00} \\cdot (0^0 0^0) = 4a_{00}.\n    $$\n    误差为 $E_{00} = 4a_{00} - 4a_{00} = 0$。该法则对常数项是精确的。这是设计使然，因为任何合理的求积法则都必须能精确地积分常数。\n\n3.  仅含非零偶次指数的项（例如，$a_{20}x^2, a_{02}y^2, a_{22}x^2y^2, a_{40}x^4, a_{04}y^4$）：\n    对于这些项，求积近似的计算结果为零，因为它们都包含 $x$ 或 $y$ 的幂。然而，它们的精确积分非零。因此，误差就是精确积分的值。这就是误差产生的地方。单点法则未能捕捉到这些非常数的、纯偶次多项式矩的贡献。\n\n    - 对于 $a_{20}x^2$:\n      $I[a_{20}x^2] = a_{20} \\frac{4}{(2+1)(0+1)} = \\frac{4}{3}a_{20}$。$Q_{\\mathrm{red}}[a_{20}x^2] = 0$。\n      误差：$E_{20} = \\frac{4}{3}a_{20}$。\n\n    - 对于 $a_{02}y^2$:\n      $I[a_{02}y^2] = a_{02} \\frac{4}{(0+1)(2+1)} = \\frac{4}{3}a_{02}$。$Q_{\\mathrm{red}}[a_{02}y^2] = 0$。\n      误差：$E_{02} = \\frac{4}{3}a_{02}$。\n\n    - 对于 $a_{22}x^2y^2$:\n      $I[a_{22}x^2y^2] = a_{22} \\frac{4}{(2+1)(2+1)} = \\frac{4}{9}a_{22}$。$Q_{\\mathrm{red}}[a_{22}x^2y^2] = 0$。\n      误差：$E_{22} = \\frac{4}{9}a_{22}$。\n\n    - 对于 $a_{40}x^4$:\n      $I[a_{40}x^4] = a_{40} \\frac{4}{(4+1)(0+1)} = \\frac{4}{5}a_{40}$。$Q_{\\mathrm{red}}[a_{40}x^4] = 0$。\n      误差：$E_{40} = \\frac{4}{5}a_{40}$。\n\n    - 对于 $a_{04}y^4$:\n      $I[a_{04}y^4] = a_{04} \\frac{4}{(0+1)(4+1)} = \\frac{4}{5}a_{04}$。$Q_{\\mathrm{red}}[a_{04}y^4] = 0$。\n      误差：$E_{04} = \\frac{4}{5}a_{04}$。\n\n总误差 $E$ 是每一项误差的总和。\n$$\nE = E_{00} + E_{10} + E_{01} + E_{11} + E_{20} + E_{02} + E_{21} + E_{12} + E_{22} + E_{40} + E_{04}\n$$\n代入计算出的值：\n$$\nE = 0 + 0 + 0 + 0 + \\frac{4}{3}a_{20} + \\frac{4}{3}a_{02} + 0 + 0 + \\frac{4}{9}a_{22} + \\frac{4}{5}a_{40} + \\frac{4}{5}a_{04}.\n$$\n简化此表达式即可得到作为多项式系数函数的积分误差的最终结果。\n$$\nE(a_{ij}) = \\frac{4}{3}a_{20} + \\frac{4}{3}a_{02} + \\frac{4}{9}a_{22} + \\frac{4}{5}a_{40} + \\frac{4}{5}a_{04}.\n$$\n此表达式表明，对于这个特定的多项式，单点减缩积分法则的误差仅取决于 2 次和 4 次的纯偶次幂项的系数。", "answer": "$$\n\\boxed{\\frac{4}{3}a_{20} + \\frac{4}{3}a_{02} + \\frac{4}{9}a_{22} + \\frac{4}{5}a_{40} + \\frac{4}{5}a_{04}}\n$$", "id": "2592725"}, {"introduction": "降阶积分的性能对单元的几何形状高度敏感。严重的网格畸变可能导致灾难性的计算失败，其结果不仅是不准确的，甚至是违背物理直觉的。\n\n在这个关键练习 [@problem_id:2592778] 中，您将研究一个病态畸变的单元，其等参映射在局部发生了翻转。您将计算出积分点处的负雅可比行列式，并分析其后果：形成负的单元刚度，这违反了物理学基本原理并导致致命的数值不稳定性。这个例子将深刻地提醒我们，在使用降阶积分时，保证网格质量至关重要。", "problem": "您正在研究有限元法(FEM)中双线性等参四边形(Q4)单元的数值积分效应。考虑母坐标 $(\\xi,\\eta)\\in[-1,1]^2$ 中的标准参考单元，以及由Q4形函数 $N_i(\\xi,\\eta)$ 和节点坐标 $(x_i,y_i)$ 定义到物理坐标 $(x,y)$ 的双线性映射：\n- $N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$,\n- $N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$,\n- $(x(\\xi,\\eta),y(\\xi,\\eta))=\\sum_{i=1}^{4}N_i(\\xi,\\eta)(x_i,y_i)$.\n\n雅可比矩阵为 $J(\\xi,\\eta)=\\begin{pmatrix}\\partial x/\\partial \\xi  \\partial y/\\partial \\xi\\\\ \\partial x/\\partial \\eta  \\partial y/\\partial \\eta\\end{pmatrix}$，其行列式为 $\\det J(\\xi,\\eta)$。在 $[-1,1]^2$ 上的单点（减缩）高斯积分中，积分权重为 $w_0=4$，常数被积函数近似为其在 $(\\xi,\\eta)=(0,0)$ 处的值乘以 $w_0$。\n\n通过采用与标准Q4节点顺序相关的以下节点坐标（单位：米）来构造一个特定的扭曲Q4单元：$(x_1,y_1)=(2,0)$, $(x_2,y_2)=(1,0.2)$, $(x_3,y_3)=(1,2.2)$, $(x_4,y_4)=(2,2.4)$。仅使用上述基本定义，不引入任何专门的“捷径”公式，计算此单元面积分的 $1\\times 1$ 高斯法则的有效权重，其定义为\n$$\nw_{\\mathrm{eff}} \\equiv w_0\\,\\det J(0,0).\n$$\n然后，基于具有正传导系数 $k>0$ 和恒定厚度的标量扩散问题的刚度构造第一性原理，解释在 $1\\times 1$ 减缩积分下单元能量贡献的符号及其相关的稳定性影响。以 $\\mathrm{m}^2$ 为单位给出 $w_{\\mathrm{eff}}$ 的最终数值。不要四舍五入。", "solution": "首先对问题进行验证。\n\n**步骤1：提取已知条件**\n- 双线性形函数：$N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$。\n- 等参映射：$(x(\\xi,\\eta),y(\\xi,\\eta))=\\sum_{i=1}^{4}N_i(\\xi,\\eta)(x_i,y_i)$。\n- 雅可比矩阵：$J(\\xi,\\eta)=\\begin{pmatrix}\\partial x/\\partial \\xi  \\partial y/\\partial \\xi\\\\ \\partial x/\\partial \\eta  \\partial y/\\partial \\eta\\end{pmatrix}$。\n- 单点高斯积分：母坐标 $(\\xi,\\eta)=(0,0)$，权重 $w_0=4$。\n- 节点坐标（单位：米）：$(x_1,y_1)=(2,0)$, $(x_2,y_2)=(1,0.2)$, $(x_3,y_3)=(1,2.2)$, $(x_4,y_4)=(2,2.4)$。\n- 有效权重的定义：$w_{\\mathrm{eff}} \\equiv w_0\\,\\det J(0,0)$。\n- 任务：计算 $w_{\\mathrm{eff}}$，并解释对于一个传导系数 $k>0$ 的扩散问题，单元能量贡献的符号及其稳定性影响。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及有限元法(FEM)中的标准概念，即等参格式、映射的雅可比和减缩高斯积分。该问题是适定的；它提供了执行所需计算和后续分析的所有必要数据和定义。语言客观而精确。节点坐标定义了一个非自交但扭曲的四边形，这是研究雅可比行列式行为的一个有效且信息丰富的案例。没有矛盾、缺失数据或违反标准的情况。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n第一个任务是计算有效权重 $w_{\\mathrm{eff}} = w_0\\,\\det J(0,0)$。这需要计算参考单元中心点 $(\\xi,\\eta)=(0,0)$ 处的雅可比矩阵 $J$。\n\n坐标映射由下式给出：\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$$\n$$y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$$\n\n雅可比矩阵的分量是这些映射函数的偏导数。\n$$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i, \\quad J_{12} = \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i$$\n$$J_{21} = \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i, \\quad J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i$$\n\n首先，我们计算形函数关于 $\\xi$ 和 $\\eta$ 的偏导数：\n$$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$$\n$$\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)$$\n$$\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)$$\n$$\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)$$\n\n在积分点 $(\\xi,\\eta)=(0,0)$ 处计算这些导数：\n$$\\frac{\\partial N_1}{\\partial \\xi}\\Big|_{(0,0)} = -\\frac{1}{4}, \\quad \\frac{\\partial N_1}{\\partial \\eta}\\Big|_{(0,0)} = -\\frac{1}{4}$$\n$$\\frac{\\partial N_2}{\\partial \\xi}\\Big|_{(0,0)} = \\frac{1}{4}, \\quad \\frac{\\partial N_2}{\\partial \\eta}\\Big|_{(0,0)} = -\\frac{1}{4}$$\n$$\\frac{\\partial N_3}{\\partial \\xi}\\Big|_{(0,0)} = \\frac{1}{4}, \\quad \\frac{\\partial N_3}{\\partial \\eta}\\Big|_{(0,0)} = \\frac{1}{4}$$\n$$\\frac{\\partial N_4}{\\partial \\xi}\\Big|_{(0,0)} = -\\frac{1}{4}, \\quad \\frac{\\partial N_4}{\\partial \\eta}\\Big|_{(0,0)} = \\frac{1}{4}$$\n\n现在，我们使用给定的节点坐标 $(x_1,y_1)=(2,0)$, $(x_2,y_2)=(1,0.2)$, $(x_3,y_3)=(1,2.2)$, $(x_4,y_4)=(2,2.4)$ 计算雅可比矩阵 $J(0,0)$ 的分量。\n$$J_{11}(0,0) = \\frac{1}{4}(-x_1 + x_2 + x_3 - x_4) = \\frac{1}{4}(-2 + 1 + 1 - 2) = \\frac{-2}{4} = -0.5$$\n$$J_{12}(0,0) = \\frac{1}{4}(-y_1 + y_2 + y_3 - y_4) = \\frac{1}{4}(-0 + 0.2 + 2.2 - 2.4) = \\frac{0}{4} = 0$$\n$$J_{21}(0,0) = \\frac{1}{4}(-x_1 - x_2 + x_3 + x_4) = \\frac{1}{4}(-2 - 1 + 1 + 2) = \\frac{0}{4} = 0$$\n$$J_{22}(0,0) = \\frac{1}{4}(-y_1 - y_2 + y_3 + y_4) = \\frac{1}{4}(-0 - 0.2 + 2.2 + 2.4) = \\frac{4.4}{4} = 1.1$$\n\n在原点的雅可比矩阵是：\n$$J(0,0) = \\begin{pmatrix} -0.5  0 \\\\ 0  1.1 \\end{pmatrix}$$\n行列式为 $\\det J(0,0) = (-0.5)(1.1) - (0)(0) = -0.55$。\n然后，有效权重计算如下：\n$$w_{\\mathrm{eff}} = w_0\\,\\det J(0,0) = 4 \\times (-0.55) = -2.2$$\n节点坐标的单位是米，所以 $\\det J$ 的单位是 $\\mathrm{m}^2$。权重 $w_0$ 是无量纲的。因此，$w_{\\mathrm{eff}}$ 的单位是 $\\mathrm{m}^2$。\n\n第二个任务是解释对于一个标量扩散问题，在 $1 \\times 1$ 减缩积分下单元能量贡献的符号及其相关的稳定性影响。\n一个二维标量扩散问题的单元刚度矩阵 $K^e$ 由以下积分给出：\n$$K^e = \\int_{\\Omega^e} B^T D B \\,d\\Omega$$\n其中 $B$ 是形函数的空间导数矩阵，$D$ 是材料本构矩阵（这里是标量传导系数 $k>0$），$\\Omega^e$ 是单元域。将积分变换到母域 $[-1,1]^2$：\n$$K^e = \\int_{-1}^{1}\\int_{-1}^{1} B(\\xi,\\eta)^T k B(\\xi,\\eta) \\det J(\\xi,\\eta) \\,d\\xi d\\eta$$\n使用 $1 \\times 1$ 高斯法则，该积分通过在 $(\\xi,\\eta)=(0,0)$ 处计算被积函数并乘以权重 $w_0=4$ 来近似：\n$$K^e \\approx w_0 \\left[ B^T k B \\det J \\right]_{(\\xi,\\eta)=(0,0)} = k \\, w_0 \\det J(0,0) \\, [B^T B]_{(0,0)}$$\n代入 $w_{\\mathrm{eff}}$ 的定义：\n$$K^e \\approx k \\, w_{\\mathrm{eff}} \\, [B^T B]_{(0,0)}$$\n我们发现 $w_{\\mathrm{eff}} = -2.2$，是一个负值。项 $[B^T B]_{(0,0)}$ 由于其作为外积的构造，是一个半正定矩阵。传导系数 $k$ 给定为正。因此，近似的单元刚度矩阵 $K^e$ 是一个负标量 ($k \\, w_{\\mathrm{eff}}$) 和一个半正定矩阵的乘积。这使得 $K^e$ 成为一个*半负定*矩阵。\n\n与节点未知量向量 $d^e$ 相关的单元内能（或在结构力学类比中的应变能）是 $U^e = \\frac{1}{2} (d^e)^T K^e d^e$。对于任何非刚体模态的非零模式 $d^e$（即，$B d^e \\neq 0$），能量贡献将是负的：$U^e < 0$。\n\n意义和稳定性：\n1.  **能量贡献的符号**：能量贡献是非正的。对于任何非零能模式的状态，其贡献是严格为负的。这在物理上是不正确的。一个被动的扩散系统必须始终储存非负的能量；其刚度必须抵抗变化，而不是促进变化。负能量意味着单元在“变形”下产生能量，这违反了热力学和稳定性的基本原理。\n2.  **稳定性影响**：将单元刚度矩阵组装成全局刚度矩阵 $K$ 将导致一个不能保证是半正定的矩阵。由于半负定的 $K^e$ 导致 $K$ 中出现负特征值，这标志着结构不稳定性。在静态分析中，方程组 $K d = f$ 将是不稳定的，可能没有解或有一个位移无限增长的非物理解。势能泛函将没有最小值。这种病态问题是由于在等参映射反转（$\\det J < 0$）的区域中使用单个积分点的直接结果。这样一个“翻转”的单元导致计算出负面积，当用于刚度计算时，会导致灾难性的数值不稳定性。", "answer": "$$\\boxed{-2.2}$$", "id": "2592778"}]}