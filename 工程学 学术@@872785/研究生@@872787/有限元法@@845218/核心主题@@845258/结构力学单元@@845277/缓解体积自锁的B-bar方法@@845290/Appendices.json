{"hands_on_practices": [{"introduction": "应用B-bar方法的第一步是计算单元平均的体积应变-位移算子 $\\bar{\\boldsymbol{B}}_{\\text{vol}}$。本练习将引导您在一个理想化的几何形状上，为常用的双线性四边形（Q4）单元进行分步推导。这个基础计算对于理解该算子的结构以及它如何从第一性原理推导而来至关重要。[@problem_id:2542562]", "problem": "考虑一个二维平面应变中的四节点双线性四边形（Q4）有限元。设物理单元占据单位正方形，其顶点在物理坐标 $(x,y)$ 中为 $(0,0)$、$(1,0)$、$(1,1)$、$(0,1)$。等参母坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，到物理单元的映射是仿射的，由 $x=\\tfrac{1}{2}(1+\\xi)$ 和 $y=\\tfrac{1}{2}(1+\\eta)$ 给出。该单元的节点位移向量按如下顺序排列\n$$\n\\boldsymbol{d}_e=\\begin{bmatrix}u_{1x}  u_{1y}  u_{2x}  u_{2y}  u_{3x}  u_{3y}  u_{4x}  u_{4y}\\end{bmatrix}^{\\mathsf{T}}.\n$$\n在平面应变中，一点的体积应变定义为无穷小应变张量的迹，即 $ \\epsilon_v=\\epsilon_{xx}+\\epsilon_{yy}$。相关的体积应变-位移算子行向量为 $ \\boldsymbol{B}_{\\text{vol}}(x,y)$，使得 $ \\epsilon_v(x,y)=\\boldsymbol{B}_{\\text{vol}}(x,y)\\,\\boldsymbol{d}_e$。对于一个 Q4 单元，\n$$\n\\boldsymbol{B}_{\\text{vol}}(x,y)=\\begin{bmatrix}N_{1,x}  N_{1,y}  N_{2,x}  N_{2,y}  N_{3,x}  N_{3,y}  N_{4,x}  N_{4,y}\\end{bmatrix},\n$$\n其中 $N_i(\\xi,\\eta)$ 是标准的双线性形函数，下标 $x,y$ 表示对物理坐标的偏导数。$B$-bar 方法将 $\\boldsymbol{B}_{\\text{vol}}(x,y)$ 替换为其单元平均值\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}}=\\frac{1}{A_e}\\int_{\\Omega_e}\\boldsymbol{B}_{\\text{vol}}(x,y)\\,\\mathrm{d}\\Omega,\n$$\n其中 $A_e$ 是单元面积，$\\Omega_e$ 是其域。\n\n从这些定义出发，仅使用给定的映射、在 $[-1,1]^2$ 上的标准双线性形函数以及积分的变量变换公式，推导该单位正方形单元的平均体积算子行向量 $\\bar{\\boldsymbol{B}}_{\\text{vol}}$ 的闭式表达式。从你的推导中明确说明为什么结果在单元上是常数。将你的最终结果表示为一个 $1\\times 8$ 的行矩阵，其元素为精确有理数，顺序为 $\\begin{bmatrix}N_{1,x}  N_{1,y}  N_{2,x}  N_{2,y}  N_{3,x}  N_{3,y}  N_{4,x}  N_{4,y}\\end{bmatrix}$。不需要四舍五入，也不需要物理单位。", "solution": "所述问题在科学上是合理的、自洽且适定的。它构成了有限元法理论中的一个标准练习。所有提供的信息都是一致的，并且足以推导出一个唯一的、可验证的解。因此，我们将着手进行推导。\n\n目标是计算特定四节点双线性四边形（Q$4$）单元的平均体积应变-位移算子 $\\bar{\\boldsymbol{B}}_{\\text{vol}}$。该算子定义为局部算子 $\\boldsymbol{B}_{\\text{vol}}(x,y)$ 的单元平均值：\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\frac{1}{A_e}\\int_{\\Omega_e}\\boldsymbol{B}_{\\text{vol}}(x,y)\\,\\mathrm{d}\\Omega\n$$\n其中 $A_e$ 是单元 $\\Omega_e$ 的面积。局部算子由下式给出：\n$$\n\\boldsymbol{B}_{\\text{vol}}(x,y) = \\begin{bmatrix} N_{1,x}  N_{1,y}  N_{2,x}  N_{2,y}  N_{3,x}  N_{3,y}  N_{4,x}  N_{4,y} \\end{bmatrix}\n$$\n推导过程首先将形函数对物理坐标 $(x,y)$ 的导数用对母坐标 $(\\xi,\\eta)$ 的导数表示，然后在单元域上进行积分。\n\n首先，我们在母域 $[-1,1] \\times [-1,1]$ 上定义标准双线性形函数 $N_i(\\xi, \\eta)$。节点编号 $1,2,3,4$ 对应于物理空间中的顶点 $(0,0), (1,0), (1,1), (0,1)$，这又对应于母空间中的顶点 $(-1,-1), (1,-1), (1,1), (-1,1)$。形函数为：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n接下来，我们计算这些形函数对母坐标 $\\xi$ 和 $\\eta$ 的导数。\n$$\n\\begin{array}{ll}\nN_{1,\\xi} = -\\frac{1}{4}(1-\\eta),  N_{1,\\eta} = -\\frac{1}{4}(1-\\xi) \\\\\nN_{2,\\xi} = \\frac{1}{4}(1-\\eta),  N_{2,\\eta} = -\\frac{1}{4}(1+\\xi) \\\\\nN_{3,\\xi} = \\frac{1}{4}(1+\\eta),  N_{3,\\eta} = \\frac{1}{4}(1+\\xi) \\\\\nN_{4,\\xi} = -\\frac{1}{4}(1+\\eta),  N_{4,\\eta} = \\frac{1}{4}(1-\\xi)\n\\end{array}\n$$\n为了将这些导数转换到物理坐标系，我们需要给定映射 $x=\\frac{1}{2}(1+\\xi)$ 和 $y=\\frac{1}{2}(1+\\eta)$ 的雅可比矩阵 $\\boldsymbol{J}$。\n$$\n\\boldsymbol{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix}\n$$\n雅可比行列式为 $\\det(\\boldsymbol{J}) = (\\frac{1}{2})(\\frac{1}{2}) - (0)(0) = \\frac{1}{4}$。雅可比矩阵的逆为：\n$$\n\\boldsymbol{J}^{-1} = \\frac{1}{\\det(\\boldsymbol{J})} \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix} = 4 \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix} = \\begin{bmatrix} 2  0 \\\\ 0  2 \\end{bmatrix}\n$$\n由于映射是仿射的，$\\boldsymbol{J}$ 和 $\\boldsymbol{J}^{-1}$ 都是常数矩阵。导数的链式法则表明：\n$$\n\\begin{Bmatrix} N_{i,x} \\\\ N_{i,y} \\end{Bmatrix} = \\boldsymbol{J}^{-1} \\begin{Bmatrix} N_{i,\\xi} \\\\ N_{i,\\eta} \\end{Bmatrix} = \\begin{bmatrix} 2  0 \\\\ 0  2 \\end{bmatrix} \\begin{Bmatrix} N_{i,\\xi} \\\\ N_{i,\\eta} \\end{Bmatrix} = \\begin{Bmatrix} 2 N_{i,\\xi} \\\\ 2 N_{i,\\eta} \\end{Bmatrix}\n$$\n因此，我们得到 $\\boldsymbol{B}_{\\text{vol}}$ 的分量作为 $(\\xi,\\eta)$ 的函数：\n$$\n\\begin{array}{ll}\nN_{1,x} = 2 N_{1,\\xi} = -\\frac{1}{2}(1-\\eta),  N_{1,y} = 2 N_{1,\\eta} = -\\frac{1}{2}(1-\\xi) \\\\\nN_{2,x} = 2 N_{2,\\xi} = \\frac{1}{2}(1-\\eta),  N_{2,y} = 2 N_{2,\\eta} = -\\frac{1}{2}(1+\\xi) \\\\\nN_{3,x} = 2 N_{3,\\xi} = \\frac{1}{2}(1+\\eta),  N_{3,y} = 2 N_{3,\\eta} = \\frac{1}{2}(1+\\xi) \\\\\nN_{4,x} = 2 N_{4,\\xi} = -\\frac{1}{2}(1+\\eta),  N_{4,y} = 2 N_{4,\\eta} = \\frac{1}{2}(1-\\xi) \\\\\n\\end{array}\n$$\n物理单元是单位正方形，所以其面积 $A_e = 1$。$\\bar{\\boldsymbol{B}}_{\\text{vol}}$ 的积分被变换到母域：\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\frac{1}{A_e} \\int_{\\Omega_e} \\boldsymbol{B}_{\\text{vol}} \\, \\mathrm{d}\\Omega = \\frac{1}{1} \\int_{-1}^1 \\int_{-1}^1 \\boldsymbol{B}_{\\text{vol}}(\\xi,\\eta) \\det(\\boldsymbol{J}) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 \\boldsymbol{B}_{\\text{vol}}(\\xi,\\eta) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\n我们对算子的每个分量计算该积分。对于任何线性函数 $f(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta$，其在母域上的积分为：\n$$\n\\int_{-1}^1 \\int_{-1}^1 (c_0 + c_1\\xi + c_2\\eta) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 4c_0\n$$\n因为关于 $\\xi$ 或 $\\eta$ 的线性项的积分为零。因此，对于每个作为 $\\xi$ 和 $\\eta$ 线性函数的分量，我们只需要其常数项。\n\n- 对于 $N_{1,x} = -\\frac{1}{2}(1-\\eta) = -\\frac{1}{2}+\\frac{1}{2}\\eta$，常数项为 $-\\frac{1}{2}$。积分为 $4(-\\frac{1}{2}) = -2$。\n- 对于 $N_{1,y} = -\\frac{1}{2}(1-\\xi) = -\\frac{1}{2}+\\frac{1}{2}\\xi$，积分为 $4(-\\frac{1}{2}) = -2$。\n- 对于 $N_{2,x} = \\frac{1}{2}(1-\\eta) = \\frac{1}{2}-\\frac{1}{2}\\eta$，积分为 $4(\\frac{1}{2}) = 2$。\n- 对于 $N_{2,y} = -\\frac{1}{2}(1+\\xi) = -\\frac{1}{2}-\\frac{1}{2}\\xi$，积分为 $4(-\\frac{1}{2}) = -2$。\n- 对于 $N_{3,x} = \\frac{1}{2}(1+\\eta) = \\frac{1}{2}+\\frac{1}{2}\\eta$，积分为 $4(\\frac{1}{2}) = 2$。\n- 对于 $N_{3,y} = \\frac{1}{2}(1+\\xi) = \\frac{1}{2}+\\frac{1}{2}\\xi$，积分为 $4(\\frac{1}{2}) = 2$。\n- 对于 $N_{4,x} = -\\frac{1}{2}(1+\\eta) = -\\frac{1}{2}-\\frac{1}{2}\\eta$，积分为 $4(-\\frac{1}{2}) = -2$。\n- 对于 $N_{4,y} = \\frac{1}{2}(1-\\xi) = \\frac{1}{2}-\\frac{1}{2}\\xi$，积分为 $4(\\frac{1}{2}) = 2$。\n\n积分后分量的向量为 $\\begin{bmatrix} -2  -2  2  -2  2  2  -2  2 \\end{bmatrix}$。现在我们应用前置因子 $\\frac{1}{4}$：\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\frac{1}{4} \\begin{bmatrix} -2  -2  2  -2  2  2  -2  2 \\end{bmatrix}\n$$\n这得出了常数平均算子行向量的最终表达式：\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\begin{bmatrix} -\\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{2} \\end{bmatrix}\n$$\n结果是常数，因为 $\\bar{\\boldsymbol{B}}_{\\text{vol}}$ 定义为空间变化函数 $\\boldsymbol{B}_{\\text{vol}}(x,y)$ 在单元域 $\\Omega_e$ 上的平均值。在一个固定域上的定积分会得到一个单一的值，而不是一个关于积分变量的函数。上述推导通过执行定积分明确地计算了这个常数向量，从而证明了为什么结果在单元内与位置无关。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}\n$$", "id": "2542562"}, {"introduction": "B-bar方法的成功之处在于它改变单元刚度的方式，特别是通过消除对某些变形模式的非物理性抵抗。本练习将研究Q4单元中臭名昭著的“沙漏”模式，这是一种理想情况下应保持体积不变的变形。通过比较标准方法和B-bar方法计算的体积应变能，您将亲眼看到B-bar列式如何正确地识别出这种模式的体积应变能为零，从而防止了伪刚化现象的发生。[@problem_id:2542578]", "problem": "考虑一个二维 (2D) 平面应变状态下的四节点双线性等参四边形 (Q4) 有限元，其边长为 $L$，厚度为常数 $t$。材料为各向同性，体积模量为 $\\kappa$，并假设应变能进行了体积-偏应变分离。体积应变为 $\\operatorname{tr}(\\boldsymbol{\\varepsilon})=\\partial u/\\partial x+\\partial v/\\partial y$，体积能量密度为 $w_{\\text{vol}}=(\\kappa/2)\\left(\\operatorname{tr}(\\boldsymbol{\\varepsilon})\\right)^{2}$。设单元的节点自由度按标准逆时针节点顺序排列为 $\\{u_{1},v_{1},u_{2},v_{2},u_{3},v_{3},u_{4},v_{4}\\}^{T}$，等参映射为 $x=(L/2)\\,\\xi$, $y=(L/2)\\,\\eta$，其中 $(\\xi,\\eta)\\in[-1,1]^{2}$。\n\n从体积能量泛函和体积应变的定义出发，执行以下步骤：\n- 推导单元的原始体积刚度贡献 $K_{\\text{vol}}$，用体积应变-位移算子 $B_{\\text{vol}}$ 表示。\n- 利用将 $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$ 在单元上 $L^2$-投影到常数空间上的思想（即用于缓解体积锁定的 B-bar 方法的精髓），推导 B-bar 体积贡献 $\\bar{K}_{\\text{vol}}$ 和相应的投影算子 $\\bar{B}_{\\text{vol}}$。\n- 对于由 $u$ 分量 $[u_{1},u_{2},u_{3},u_{4}]=[\\gamma,-\\gamma,\\gamma,-\\gamma]$ 和 $v$ 分量 $[v_{1},v_{2},v_{3},v_{4}]=[0,0,0,0]$ 定义的特定节点位移模式，证明插值位移场为 $u(\\xi,\\eta)=\\gamma\\,\\xi\\,\\eta$ 和 $v(\\xi,\\eta)=0$。然后，用 $\\kappa$、 $t$、 $L$ 和 $\\gamma$ 表示标量值 $v^{T}K_{\\text{vol}}v$ 和 $v^{T}\\bar{K}_{\\text{vol}}v$。\n\n定义归一化差异\n$$\\Delta R=\\frac{v^{T}K_{\\text{vol}}v-v^{T}\\bar{K}_{\\text{vol}}v}{\\kappa\\,t\\,\\gamma^{2}}.$$\n以闭合形式计算 $\\Delta R$。给出你最终的答案，形式为一个简化的解析值。最终答案中不包含单位。无需四舍五入。", "solution": "该问题陈述具有科学依据、问题适定、客观且自成体系。它代表了计算固体力学领域，特别是有限元方法中的一个标准练习。未检测到不一致或谬误之处。该问题有效，我将着手解答。\n\n该分析涉及一个处于平面应变条件下的二维四节点等参四边形单元。单元几何形状为边长为 $L$ 的正方形，由 $(\\xi, \\eta)$ 坐标系中的一个正则母元映射而来，其中 $\\xi, \\eta \\in [-1, 1]$。该映射由 $x=(L/2)\\xi$ 和 $y=(L/2)\\eta$ 给出。\n\n该变换的雅可比矩阵为\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} L/2  0 \\\\ 0  L/2 \\end{pmatrix} $$\n雅可比行列式为 $\\det(\\mathbf{J}) = L^2/4$。面积微元为 $dA = \\det(\\mathbf{J}) d\\xi d\\eta = (L^2/4) d\\xi d\\eta$。\n\n位移场 $(u, v)$ 是通过使用双线性形函数 $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)$ 从节点位移插值得到的，其中 $(\\xi_i, \\eta_i)$ 是节点 $i$ 的坐标。设节点自由度向量为 $\\mathbf{d} = \\{u_{1},v_{1},u_{2},v_{2},u_{3},v_{3},u_{4},v_{4}\\}^{T}$。问题陈述中使用符号 $v$ 表示此向量；为避免与位移的 $y$ 分量混淆，我们在推导中将使用 $\\mathbf{d}$。\n\n体积应变为 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}$。物理坐标系和母元坐标系下的导数关系为 $\\left\\{\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right\\}^T = \\mathbf{J}^{-1} \\left\\{\\frac{\\partial}{\\partial \\xi}, \\frac{\\partial}{\\partial \\eta}\\right\\}^T = \\frac{2}{L}\\mathbf{I} \\left\\{\\frac{\\partial}{\\partial \\xi}, \\frac{\\partial}{\\partial \\eta}\\right\\}^T$。\n体积应变可以表示为 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = B_{\\text{vol}} \\mathbf{d}$，其中 $B_{\\text{vol}}$ 是一个 $1 \\times 8$ 的行向量，由下式给出：\n$$ B_{\\text{vol}} = \\left[ \\frac{\\partial N_1}{\\partial x}, \\frac{\\partial N_1}{\\partial y}, \\dots, \\frac{\\partial N_4}{\\partial x}, \\frac{\\partial N_4}{\\partial y} \\right] $$\n其中 $\\frac{\\partial N_i}{\\partial x} = \\frac{2}{L}\\frac{\\partial N_i}{\\partial \\xi}$ 且 $\\frac{\\partial N_i}{\\partial y} = \\frac{2}{L}\\frac{\\partial N_i}{\\partial \\eta}$。\n\n体积应变能泛函为 $W_{\\text{vol}} = \\frac{1}{2}\\int_{V} \\kappa (\\operatorname{tr}(\\boldsymbol{\\varepsilon}))^2 dV$。对于厚度为常数 $t$ 的单元，这变为 $W_{\\text{vol}} = \\frac{1}{2} \\mathbf{d}^T K_{\\text{vol}} \\mathbf{d}$，其中体积刚度矩阵 $K_{\\text{vol}}$ 为：\n$$ K_{\\text{vol}} = \\int_A t B_{\\text{vol}}^T \\kappa B_{\\text{vol}} dA = \\kappa t \\int_{-1}^1 \\int_{-1}^1 B_{\\text{vol}}^T(\\xi,\\eta) B_{\\text{vol}}(\\xi,\\eta) \\det(\\mathbf{J}) d\\xi d\\eta $$\n\nB-bar 方法旨在通过将局部体积应变 $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$ 替换为其在单元体积上的平均值 $\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})}$ 来缓解体积锁定。这等效于将应变 $L^2$-投影到单元上的常数函数空间。\n$$ \\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\frac{1}{V_{el}} \\int_{V_{el}} \\operatorname{tr}(\\boldsymbol{\\varepsilon}) dV = \\frac{1}{A_{el}} \\int_{A_{el}} \\operatorname{tr}(\\boldsymbol{\\varepsilon}) dA $$\n其中 $A_{el} = L^2$。\n代入 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = B_{\\text{vol}} \\mathbf{d}$，我们得到 $\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\bar{B}_{\\text{vol}} \\mathbf{d}$，其中修正后的应变-位移算子 $\\bar{B}_{\\text{vol}}$ 在单元上是恒定的：\n$$ \\bar{B}_{\\text{vol}} = \\frac{1}{A_{el}} \\int_{A_{el}} B_{\\text{vol}} dA = \\frac{1}{L^2} \\int_{-1}^1 \\int_{-1}^1 B_{\\text{vol}}(\\xi, \\eta) \\frac{L^2}{4} d\\xi d\\eta = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 B_{\\text{vol}}(\\xi, \\eta) d\\xi d\\eta $$\n修正后的体积刚度矩阵 $\\bar{K}_{\\text{vol}}$ 使用这个常数算子推导得出：\n$$ \\bar{K}_{\\text{vol}} = \\int_A t \\bar{B}_{\\text{vol}}^T \\kappa \\bar{B}_{\\text{vol}} dA = \\kappa t \\bar{B}_{\\text{vol}}^T \\bar{B}_{\\text{vol}} \\int_A dA = \\kappa t A_{el} \\bar{B}_{\\text{vol}}^T \\bar{B}_{\\text{vol}} $$\n相应的应变能为 $\\frac{1}{2} \\mathbf{d}^T \\bar{K}_{\\text{vol}} \\mathbf{d} = \\frac{1}{2} \\kappa t A_{el} (\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})})^2$。\n\n我们现在分析具有分量 $u_1=\\gamma, u_2=-\\gamma, u_3=\\gamma, u_4=-\\gamma$ 和 $v_1=v_2=v_3=v_4=0$ 的特定节点位移向量 $\\mathbf{v}$（为清晰起见，此处表示为 $\\mathbf{d}$）。\n插值位移场为 $u(\\xi, \\eta) = \\sum_{i=1}^4 N_i u_i$ 和 $v(\\xi, \\eta) = \\sum_{i=1}^4 N_i v_i$。\n$$ v(\\xi, \\eta) = N_1(0) + N_2(0) + N_3(0) + N_4(0) = 0 $$\n$$ u(\\xi, \\eta) = \\gamma(N_1 - N_2 + N_3 - N_4) $$\n使用形函数定义 $N_i = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)$，其中 $(\\xi_1, \\eta_1)=(-1,-1)$, $(\\xi_2, \\eta_2)=(1,-1)$, $(\\xi_3, \\eta_3)=(1,1)$, $(\\xi_4, \\eta_4)=(-1,1)$：\n$$ N_1 - N_2 = \\frac{1}{4}(1-\\eta)(1-\\xi - (1+\\xi)) = -\\frac{1}{2}\\xi(1-\\eta) $$\n$$ N_3 - N_4 = \\frac{1}{4}(1+\\eta)(1+\\xi - (1-\\xi)) = \\frac{1}{2}\\xi(1+\\eta) $$\n$$ u(\\xi, \\eta) = \\gamma \\left( -\\frac{1}{2}\\xi(1-\\eta) + \\frac{1}{2}\\xi(1+\\eta) \\right) = \\gamma \\left( -\\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\eta + \\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\eta \\right) = \\gamma \\xi \\eta $$\n位移场确实是 $u(\\xi, \\eta) = \\gamma\\xi\\eta$ 和 $v(\\xi, \\eta)=0$。这就是众所周知的沙漏模式。\n\n接下来，我们计算由此产生的体积应变：\n$$ \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = \\frac{2}{L}\\frac{\\partial u}{\\partial \\xi} + \\frac{2}{L}\\frac{\\partial v}{\\partial \\eta} = \\frac{2}{L}\\frac{\\partial}{\\partial \\xi}(\\gamma\\xi\\eta) + \\frac{2}{L}\\frac{\\partial}{\\partial \\eta}(0) = \\frac{2\\gamma\\eta}{L} $$\n标准格式的应变能是 $\\frac{1}{2} \\mathbf{v}^T K_{\\text{vol}} \\mathbf{v}$。 因此，二次型 $\\mathbf{v}^T K_{\\text{vol}} \\mathbf{v}$ 为：\n$$ \\mathbf{v}^T K_{\\text{vol}} \\mathbf{v} = \\kappa t \\int_A (\\operatorname{tr}(\\boldsymbol{\\varepsilon}))^2 dA = \\kappa t \\int_{-1}^1 \\int_{-1}^1 \\left(\\frac{2\\gamma\\eta}{L}\\right)^2 \\frac{L^2}{4} d\\xi d\\eta $$\n$$ \\mathbf{v}^T K_{\\text{vol}} \\mathbf{v} = \\kappa t \\frac{4\\gamma^2}{L^2} \\frac{L^2}{4} \\int_{-1}^1 \\int_{-1}^1 \\eta^2 d\\xi d\\eta = \\kappa t \\gamma^2 \\left( \\int_{-1}^1 d\\xi \\right) \\left( \\int_{-1}^1 \\eta^2 d\\eta \\right) $$\n积分计算结果为 $\\int_{-1}^1 d\\xi = 2$ 和 $\\int_{-1}^1 \\eta^2 d\\eta = [\\eta^3/3]_{-1}^1 = 2/3$。\n$$ \\mathbf{v}^T K_{\\text{vol}} \\mathbf{v} = \\kappa t \\gamma^2 (2) \\left(\\frac{2}{3}\\right) = \\frac{4}{3} \\kappa t \\gamma^2 $$\n这个非零能量是伪能，因为理想情况下沙漏模式应为纯剪切变形，其体积变化为零。\n\n对于 B-bar 格式，我们首先计算平均体积应变：\n$$ \\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\frac{1}{A_{el}} \\int_A \\operatorname{tr}(\\boldsymbol{\\varepsilon}) dA = \\frac{1}{L^2} \\int_{-1}^1 \\int_{-1}^1 \\left(\\frac{2\\gamma\\eta}{L}\\right) \\frac{L^2}{4} d\\xi d\\eta $$\n$$ \\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\frac{\\gamma}{2L} \\int_{-1}^1 \\int_{-1}^1 \\eta d\\xi d\\eta = \\frac{\\gamma}{2L} \\left( \\int_{-1}^1 d\\xi \\right) \\left( \\int_{-1}^1 \\eta d\\eta \\right) $$\n积分 $\\int_{-1}^1 \\eta d\\eta = [\\eta^2/2]_{-1}^1 = 0$。 因此，$\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = 0$。\nB-bar 格式的应变能为：\n$$ \\mathbf{v}^T \\bar{K}_{\\text{vol}} \\mathbf{v} = \\kappa t A_{el} (\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})})^2 = \\kappa t L^2 (0)^2 = 0 $$\nB-bar 方法正确地为该模式分配了零体积能。\n\n最后，我们计算归一化差异 $\\Delta R$：\n$$ \\Delta R = \\frac{\\mathbf{v}^T K_{\\text{vol}} \\mathbf{v} - \\mathbf{v}^T \\bar{K}_{\\text{vol}} \\mathbf{v}}{\\kappa t \\gamma^2} = \\frac{\\frac{4}{3} \\kappa t \\gamma^2 - 0}{\\kappa t \\gamma^2} $$\n$$ \\Delta R = \\frac{4}{3} $$\n结果是一个无量纲常数。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2542578"}, {"introduction": "任何数值方法的最终检验标准是其在模拟中的性能。这最后一个练习涉及一个小型计算问题，要求您使用标准列式和B-bar列式来解决一个简单的结构问题。通过比较在近不可压缩材料下的计算结果，您将能用数值量化体积锁死的显著影响，并看到B-bar方法如何成功地缓解它，从而得到更准确的结果。[@problem_id:2542550]", "problem": "一个二维小应变线性弹性问题将在平面应变条件下，使用有限元法（FEM）和双线性四边形单元（Q4）在一个宽为 $L=2\\,\\mathrm{m}$、高为 $H=1\\,\\mathrm{m}$ 的矩形域上求解。网格由两个沿 $x$ 方向并排排列的 Q4 单元组成，具有单位平面外厚度。全局节点坐标（单位为米）为 $[(0,0),(1,0),(2,0),(0,1),(1,1),(2,1)]$，按节点 $0$ 到 $5$ 的顺序排列。两个单元由节点连接关系 $[0,1,4,3]$ 和 $[1,2,5,4]$ 定义，其局部节点排序与通常的 Q4 形函数 $(\\xi,\\eta)\\in[-1,1]^2$ 一致：节点 $0$ 位于 $(-1,-1)$，节点 $1$ 位于 $(+1,-1)$，节点 $2$ 位于 $(+1,+1)$，节点 $3$ 位于 $(-1,+1)$。\n\n材料行为是线弹性各向同性的，其杨氏模量为 $E$（单位：$\\mathrm{Pa}$），泊松比为 $\\nu$（无量纲）。在平面应变条件下，定义拉梅参数 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$。标准的基于位移的公式对每个单元采用 $2\\times 2$ 高斯积分来组装全局刚度矩阵\n$$\n\\mathbf{K}_\\text{std} = \\sum_{e} \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D}\\, \\mathbf{B}\\, \\mathrm{d}\\Omega\n$$\n其中 $\\mathbf{B}$ 是 Q4 单元在 Voigt 标记法下的常规应变-位移矩阵（使用工程剪切应变 $\\gamma_{xy}$），$\\mathbf{D}$ 是平面应变本构矩阵。为分离并量化体积锁定效应，使用以下公式将本构响应分解为偏量和体积部分\n$$\n\\mathbf{D} = \\mathbf{D}_\\text{dev} + \\mathbf{D}_\\text{vol}, \\quad \\mathbf{D}_\\text{dev} = \\mathrm{diag}(2\\mu, 2\\mu, \\mu), \\quad \\mathbf{D}_\\text{vol} = \\lambda \\begin{bmatrix} 1  1  0\\\\ 1  1  0\\\\ 0  0  0 \\end{bmatrix}\n$$\n二维体积应变度量取为 $\\varepsilon_v = \\varepsilon_x + \\varepsilon_y$，可写为 $\\varepsilon_v = \\mathbf{B}_v \\mathbf{u}$，其中 $\\mathbf{B}_v = [1, 1, 0]\\mathbf{B}$ 是作用于单元节点位移 $\\mathbf{u}$ 上的一个 $1\\times n_\\text{dof}$ 行算子。\n\n为缓解体积锁定，实施 $\\bar{B}$ (B-bar) 方法，将体积能中的逐点体积应变替换为其单元平均值，\n$$\n\\bar{\\mathbf{B}}_v = \\frac{1}{|\\Omega_e|}\\int_{\\Omega_e} \\mathbf{B}_v\\, \\mathrm{d}\\Omega,\n$$\n同时保留标准的偏量贡献。在 B-bar 方法下，得到的单元刚度为\n$$\n\\mathbf{K}_e^{\\bar{B}} = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D}_\\text{dev}\\, \\mathbf{B}\\, \\mathrm{d}\\Omega \\;+\\; \\lambda\\, |\\Omega_e|\\, \\bar{\\mathbf{B}}_v^\\top \\bar{\\mathbf{B}}_v.\n$$\n\n载荷：在右边界 $x=L$ 上施加一个大小为 $p$（单位：$\\mathrm{Pa}$）的均布压力，方向沿 $x$ 轴负方向向内。这在该边界上产生一个单位厚度上的面力向量 $\\mathbf{t} = [-p, 0]^\\top$。使用通过沿边界边进行适当的一维高斯求积得到的一致边界载荷向量。边界条件：通过在节点 $0$ 和 $3$ 处强制 $\\mathbf{u}=(0,0)$ 来完全固定左边界。\n\n设未知节点位移的全局向量为 $\\mathbf{U} \\in \\mathbb{R}^{12}$，按 $[u_0, v_0, u_1, v_1, \\dots, u_5, v_5]^\\top$ 排序。求解两个线性系统，\n$$\n\\mathbf{K}_\\text{std}\\mathbf{U}_\\text{std} = \\mathbf{F},\\qquad \\mathbf{K}_{\\bar{B}}\\mathbf{U}_{\\bar{B}} = \\mathbf{F},\n$$\n具有相同的边界条件和载荷向量 $\\mathbf{F}$。定义 $x$ 方向的等效边缘刚度为\n$$\nk_\\text{eff} = \\frac{F_\\text{tot}}{\\bar{u}_R}, \\quad \\bar{u}_R = \\frac{u_2 + u_5}{2}, \\quad F_\\text{tot} = p\\,H,\n$$\n其中 $u_2$ 和 $u_5$ 分别是节点 $2$ 和节点 $5$ 处的 $x$ 方向位移，$H=1\\,\\mathrm{m}$。由于线性关系，$k_\\text{eff}$ 除了数值舍入误差外，与载荷大小无关。通过以下比率来量化锁定引起的刚度膨胀\n$$\nr = \\frac{k_{\\text{eff},\\text{std}}}{k_{\\text{eff},\\bar{B}}}.\n$$\n\n编写一个程序，为所述网格组装 $\\mathbf{K}_\\text{std}$ 和 $\\mathbf{K}_{\\bar{B}}$，并针对以下参数值测试套件（全部采用国际单位制）求解位移：\n- 测试 1（基准可压缩）：$E=1.0\\times 10^6$, $\\nu=0.3$, $p=1.0\\times 10^3$。\n- 测试 2（近不可压缩）：$E=1.0\\times 10^6$, $\\nu=0.4999$, $p=1.0\\times 10^3$。\n- 测试 3（近不可压缩时的缩放载荷和刚度）：$E=2.0\\times 10^6$, $\\nu=0.4999$, $p=2.0\\times 10^3$。\n- 测试 4（无体积耦合）：$E=1.0\\times 10^6$, $\\nu=0.0$, $p=1.0\\times 10^3$。\n\n对于每个测试用例，计算如上定义的标量比率 $r$。您的程序应生成单行输出，其中包含按上述测试顺序排列的四个比率，格式为方括号内以逗号分隔的列表（例如，“[r1,r2,r3,r4]”）。这些比率是无量纲实数，必须以十进制数值报告，不带任何单位符号。", "solution": "我们从二维小应变线性弹性、平面应变运动学和虚功原理出发。该域使用双线性四边形（Q4）有限元进行离散化。主要目标是比较标准的全积分位移公式与一种旨在缓解近不可压缩情况下体积锁定的 $\\bar{B}$ (B-bar) 修正方法。\n\n1. 运动学和应变-位移关系。对于一个节点位移堆叠为 $\\mathbf{u}_e \\in \\mathbb{R}^{8}$ 的 Q4 单元，使用工程剪切应变的 Voigt 标记法表示的应变向量为\n$$\n\\boldsymbol{\\varepsilon} = \\begin{bmatrix}\\varepsilon_x\\\\ \\varepsilon_y\\\\ \\gamma_{xy}\\end{bmatrix} = \\mathbf{B}(\\xi,\\eta)\\,\\mathbf{u}_e,\n$$\n其中 $\\mathbf{B}$ 集合了双线性形函数相对于物理坐标的导数。使用标准等参映射，坐标为 $(\\xi,\\eta)\\in[-1,1]^2$，以及雅可比矩阵 $\\mathbf{J}$，相对于 $x,y$ 的导数通过 $\\begin{bmatrix}\\partial N_i/\\partial x\\\\ \\partial N_i/\\partial y \\end{bmatrix} = \\mathbf{J}^{-1}\\begin{bmatrix}\\partial N_i/\\partial \\xi\\\\ \\partial N_i/\\partial \\eta \\end{bmatrix}$ 获得。\n\n2. 本构律和体积-偏量分解。在平面应变和各向同性线弹性条件下，应力-应变定律为\n$$\n\\boldsymbol{\\sigma} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}, \\quad \\mathbf{D} = \\begin{bmatrix}\\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  \\mu\\end{bmatrix},\n$$\n其中拉梅参数为 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$。为分析锁定，我们将响应分解为偏量部分和体积部分。在二维情况下，一个方便的精确分解是\n$$\n\\mathbf{D} = \\underbrace{\\mathrm{diag}(2\\mu,\\,2\\mu,\\,\\mu)}_{\\mathbf{D}_\\text{dev}} \\;+\\; \\underbrace{\\lambda\\begin{bmatrix} 1  1  0\\\\ 1  1  0\\\\ 0  0  0 \\end{bmatrix}}_{\\mathbf{D}_\\text{vol}}.\n$$\n我们所作用的体积应变度量是 $\\varepsilon_v = \\varepsilon_x + \\varepsilon_y$，它可以通过行算子 $\\mathbf{P}_v = [1,\\,1,\\,0]$ 作用于 $\\boldsymbol{\\varepsilon}$ 来提取。在单元层面，$\\varepsilon_v = \\mathbf{B}_v \\mathbf{u}_e$，其中 $\\mathbf{B}_v = \\mathbf{P}_v \\mathbf{B}$。\n\n3. 虚功原理和标准刚度。弱形式（虚功原理）得到标准单元刚度\n$$\n\\mathbf{K}_e^\\text{std} = \\int_{\\Omega_e} \\mathbf{B}^\\top (\\mathbf{D}_\\text{dev} + \\mathbf{D}_\\text{vol})\\, \\mathbf{B}\\, \\mathrm{d}\\Omega \\;=\\; \\underbrace{\\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D}_\\text{dev} \\mathbf{B}\\,\\mathrm{d}\\Omega}_{\\mathbf{K}_{e,\\text{dev}}} \\;+\\; \\underbrace{\\int_{\\Omega_e} \\mathbf{B}_v^\\top \\lambda\\, \\mathbf{B}_v\\, \\mathrm{d}\\Omega}_{\\mathbf{K}_{e,\\text{vol}}}.\n$$\n在数值上，我们在点 $(\\xi,\\eta) = (\\pm\\frac{1}{\\sqrt{3}},\\pm\\frac{1}{\\sqrt{3}})$ 处使用 $2\\times 2$ 高斯求积法计算积分，每个点的权重为 $1$，并乘以 $\\det\\mathbf{J}$。\n\n4. B-bar 修正。体积锁定源于当体积模量（或 $\\lambda$）很大时，低阶位移场无法表示不可压缩模式。B-bar 技术通过将逐点体积应变替换为其单元平均值来正则化体积部分。定义平均体积算子\n$$\n\\bar{\\mathbf{B}}_v = \\frac{1}{|\\Omega_e|} \\int_{\\Omega_e} \\mathbf{B}_v\\,\\mathrm{d}\\Omega,\n$$\n其中 $|\\Omega_e|$ 是单元面积（已隐含单位厚度）。则 B-bar 体积刚度为\n$$\n\\mathbf{K}_{e,\\text{vol}}^{\\bar{B}} = \\int_{\\Omega_e} \\bar{\\mathbf{B}}_v^\\top \\lambda\\, \\bar{\\mathbf{B}}_v\\, \\mathrm{d}\\Omega = \\lambda\\, |\\Omega_e|\\, \\bar{\\mathbf{B}}_v^\\top \\bar{\\mathbf{B}}_v,\n$$\n因为 $\\bar{\\mathbf{B}}_v$ 在单元上是常数。偏量部分保持不变，并使用完整的 $2\\times 2$ 求积进行积分。B-bar 单元刚度为\n$$\n\\mathbf{K}_e^{\\bar{B}} = \\mathbf{K}_{e,\\text{dev}} + \\mathbf{K}_{e,\\text{vol}}^{\\bar{B}}.\n$$\n\n5. 边界条件和载荷。通过在节点 $0$ 和 $3$ 处设置 $u=v=0$ 来固定左边界。在右边界 $x=L$ 上，施加向内（$x$ 轴负方向）的均布压力 $p$，产生面力 $\\mathbf{t} = [-p,0]^\\top$。最右侧单元右边界上的一致边界载荷向量通过沿边参数 $\\eta\\in[-1,1]$ 在 $\\xi=+1$ 处进行一维高斯求积计算，\n$$\n\\mathbf{f}_e^\\text{edge} = \\int_{-1}^{1} \\mathbf{N}_\\text{edge}^\\top \\mathbf{t} \\, J_\\text{edge}\\, \\mathrm{d}\\eta,\n$$\n其中 $J_\\text{edge} = \\left\\|\\dfrac{\\partial \\mathbf{x}}{\\partial \\eta}\\right\\|$ 是边雅可比行列式（对于线性边是物理边长的一半），$\\mathbf{N}_\\text{edge}$ 包含映射到父单元边上的边形函数。在单位厚度和 $H=1\\,\\mathrm{m}$ 的情况下，总施加载荷的大小为 $F_\\text{tot} = pH$。\n\n6. 求解与度量。组装全局刚度矩阵 $\\mathbf{K}_\\text{std}$ 和 $\\mathbf{K}_{\\bar{B}}$ 以及单个全局载荷向量 $\\mathbf{F}$。通过行/列消除法或罚函数法施加本质边界条件。求解线性系统以获得 $\\mathbf{U}_\\text{std}$ 和 $\\mathbf{U}_{\\bar{B}}$。提取右边界的平均水平位移 $\\bar{u}_R = (u_2 + u_5)/2$。定义等效边缘刚度\n$$\nk_{\\text{eff},\\text{std}} = \\frac{F_\\text{tot}}{\\bar{u}_{R,\\text{std}}}, \\qquad k_{\\text{eff},\\bar{B}} = \\frac{F_\\text{tot}}{\\bar{u}_{R,\\bar{B}}},\n$$\n并计算锁定-膨胀比 $r = k_{\\text{eff},\\text{std}}/k_{\\text{eff},\\bar{B}}$。对于一个解析良好、可压缩的材料（例如 $\\nu=0.3$），我们预期 $r \\approx 1$。对于近不可压缩情况（例如 $\\nu=0.4999$），标准公式会表现出体积锁定，因此 $r1$，这量化了由 B-bar 方法缓解的刚度高估。对于 $\\nu=0$，体积部分和偏量部分解耦（$\\lambda=0$），因此两种方法一致，且 $r=1$。\n\n7. 程序的算法步骤。\n- 定义网格几何、连接关系和自由度映射。\n- 对每个单元：\n  - 对每个 $2\\times 2$ 高斯点，计算 $\\mathbf{B}$、$\\det\\mathbf{J}$，使用 $\\mathbf{D}_\\text{dev}$ 累加 $\\mathbf{K}_{e,\\text{dev}}$，对于标准方法，使用 $\\lambda$ 和 $\\mathbf{B}_v$ 累加 $\\mathbf{K}_{e,\\text{vol}}$，同时为 B-bar 方法累加 $\\int \\mathbf{B}_v \\,\\mathrm{d}\\Omega$ 和 $|\\Omega_e|$。\n  - 求积后，形成 $\\mathbf{K}_{e,\\text{vol}}^{\\bar{B}} = \\lambda |\\Omega_e|\\, \\bar{\\mathbf{B}}_v^\\top \\bar{\\mathbf{B}}_v$，并将其与 $\\mathbf{K}_{e,\\text{dev}}$ 相加，得到 B-bar 单元刚度。\n- 通过在相应的全局自由度上求和单元贡献，组装全局刚度矩阵。\n- 通过在最右侧单元的右边界（$\\xi=+1$）上使用一维高斯求积进行一致边积分，并施加载荷 $\\mathbf{t}=[-p,0]^\\top$，来组装全局载荷向量。\n- 在节点 $0$ 和 $3$ 处施加本质边界条件（$u=v=0$）。\n- 求解两个线性系统并为每个测试计算 $r$。\n\n8. 测试套件和输出。针对四个指定的测试用例运行该过程：\n- 测试 1：$E=1.0\\times 10^6\\,\\mathrm{Pa}$, $\\nu=0.3$, $p=1.0\\times 10^3\\,\\mathrm{Pa}$。\n- 测试 2：$E=1.0\\times 10^6\\,\\mathrm{Pa}$, $\\nu=0.4999$, $p=1.0\\times 10^3\\,\\mathrm{Pa}$。\n- 测试 3：$E=2.0\\times 10^6\\,\\mathrm{Pa}$, $\\nu=0.4999$, $p=2.0\\times 10^3\\,\\mathrm{Pa}$。\n- 测试 4：$E=1.0\\times 10^6\\,\\mathrm{Pa}$, $\\nu=0.0$, $p=1.0\\times 10^3\\,\\mathrm{Pa}$。\n\n由于线性缩放，测试 2 和测试 3 应产生几乎相同的 $r$ 值（在数值舍入误差范围内）。最终输出是包含 $[r_1,r_2,r_3,r_4]$ 的单行，其中每个 $r_i$ 都是一个无量纲的十进制数。", "answer": "[1.00223594,228.60875619,228.60875619,1.00000000]", "id": "2542550"}]}