{"hands_on_practices": [{"introduction": "理解任何有限元单元的第一步是掌握其运动学。本练习提供了一个基础实践，引导你从退化实体法的基本运动学假设出发，直接推导出纯弯曲状态下板的经典线性应变分布[@problem_id:2596080]。这个推导过程将加深你对位移场、转动和应变之间关系的理解，是后续更复杂分析的基石。", "problem": "考虑一个平坦、初始未变形的各向同性板，其厚度为常数 $t$，中面与笛卡尔 $x\\text{-}y$ 平面重合。厚度坐标 $z \\in [-t/2,\\, t/2]$ 沿参考单位法向量 $\\mathbf{e}_3$ 方向为正。在线性化（小应变，小转动）运动学框架下进行分析。采用壳的退化实体法 (DSA)，其中任意材料点由中面上的一个点加上一个穿过厚度、长度为 $t$ 的直导向矢量表示。假设导向矢量不可伸长（无厚度拉伸）、变形后导向矢量保持为直线，且各处横向剪切应变为零（基尔霍夫-拉夫弯曲运动学）。\n\n施加纯弯曲状态，使得中面不发生薄膜变形，而板呈现恒定曲率。设中面的横向挠度为 $w(x,y)$，并根据经典的小斜率约定定义曲率分量\n$$\n\\kappa_x = w_{,xx}, \\quad \\kappa_y = w_{,yy}, \\quad \\kappa_{xy} = w_{,xy},\n$$\n其中逗号表示对指定坐标的偏微分。使用三维小应变定义\n$$\n\\varepsilon_{ij} = \\tfrac{1}{2}\\left(u_{i,j} + u_{j,i}\\right),\n$$\n以及专门针对上述假设的 DSA 运动学，推导沿厚度方向的面内应变分量，从而获得正应变 $\\varepsilon_{xx}(z)$ 和 $\\varepsilon_{yy}(z)$ 以及工程剪切应变 $\\gamma_{xy}(z) = 2 \\varepsilon_{xy}(z)$ 沿厚度变化的显式表达式，该表达式应以 $z$、$\\kappa_x$、$\\kappa_y$ 和 $\\kappa_{xy}$ 表示。根据你的表达式验证在中面 $z=0$ 处薄膜应变为零。\n\n将最终答案以闭合形式表示为单行矩阵\n$$\n\\big[\\,\\varepsilon_{xx}(z),\\ \\varepsilon_{yy}(z),\\ \\gamma_{xy}(z)\\,\\big]\n$$\n。无需进行数值计算。陈述你所使用的、与问题陈述和 DSA 框架一致的任何中间假设。", "solution": "问题陈述已经过验证。我们发现它是自洽的，科学上基于经典的板壳理论，并且在数学上是适定的。我们将开始推导。\n\n退化实体法 (DSA) 的基本前提是，用三维物体的中面运动和一个导向矢量来描述其运动学。对于一个平坦板，未变形构型中任意点的位置矢量 $\\mathbf{X}$ 由下式给出\n$$\n\\mathbf{X}(x, y, z) = \\mathbf{x}_m(x,y) + z \\mathbf{e}_3\n$$\n其中 $\\mathbf{x}_m(x,y) = x \\mathbf{e}_1 + y \\mathbf{e}_2$ 是中面上一点的位置矢量，而 $\\mathbf{e}_3$ 是单位法向导向矢量。坐标 $z$ 位于区间 $[-t/2, t/2]$ 内。\n\n变形后，同一材料点的位置由下式描述\n$$\n\\mathbf{x}(x, y, z) = \\mathbf{x}_m^{\\text{def}}(x,y) + z \\mathbf{d}(x,y)\n$$\n其中 $\\mathbf{x}_m^{\\text{def}}$ 是中面点的变形后位置，$\\mathbf{d}$ 是变形后的导向矢量。位移矢量 $\\mathbf{u}(x, y, z)$ 是变形后位置与未变形位置之差：\n$$\n\\mathbf{u}(x, y, z) = \\mathbf{x}(x, y, z) - \\mathbf{X}(x, y, z) = (\\mathbf{x}_m^{\\text{def}} - \\mathbf{x}_m) + z (\\mathbf{d} - \\mathbf{e}_3)\n$$\n设中面的位移为 $\\mathbf{u}_m(x,y) = u(x,y)\\mathbf{e}_1 + v(x,y)\\mathbf{e}_2 + w(x,y)\\mathbf{e}_3$。问题指定了纯弯曲状态，这意味着中面不发生薄膜变形。对于小位移，这允许我们将中面面内位移设为零，即 $u(x,y) = 0$ 和 $v(x,y) = 0$。因此，中面位移是纯横向的：$\\mathbf{u}_m(x,y) = w(x,y)\\mathbf{e}_3$。\n\n如前所述，基尔霍夫-拉夫理论的运动学假设规定，导向矢量保持为直线并垂直于变形后的中面。变形后的中面由 $\\mathbf{r}(x,y) = x \\mathbf{e}_1 + y \\mathbf{e}_2 + w(x,y) \\mathbf{e}_3$ 参数化。该曲面的切向量为：\n$$\n\\mathbf{r}_{,x} = \\mathbf{e}_1 + w_{,x} \\mathbf{e}_3 \\quad \\text{and} \\quad \\mathbf{r}_{,y} = \\mathbf{e}_2 + w_{,y} \\mathbf{e}_3\n$$\n变形后中面的法向量通过叉积求得：\n$$\n\\mathbf{N} = \\mathbf{r}_{,x} \\times \\mathbf{r}_{,y} = (\\mathbf{e}_1 + w_{,x} \\mathbf{e}_3) \\times (\\mathbf{e}_2 + w_{,y} \\mathbf{e}_3) = -w_{,x} \\mathbf{e}_1 - w_{,y} \\mathbf{e}_2 + \\mathbf{e}_3\n$$\n变形后的导向矢量 $\\mathbf{d}$ 是 $\\mathbf{N}$ 方向上的单位向量。\n$$\n\\mathbf{d} = \\frac{\\mathbf{N}}{|\\mathbf{N}|} = \\frac{-w_{,x} \\mathbf{e}_1 - w_{,y} \\mathbf{e}_2 + \\mathbf{e}_3}{\\sqrt{w_{,x}^2 + w_{,y}^2 + 1}}\n$$\n在小转动假设下，斜率 $w_{,x}$ 和 $w_{,y}$ 是小量。因此，分母可以线性化：$\\sqrt{1 + w_{,x}^2 + w_{,y}^2} \\approx 1$。因此，线性化后的变形导向矢量为：\n$$\n\\mathbf{d} \\approx -w_{,x} \\mathbf{e}_1 - w_{,y} \\mathbf{e}_2 + \\mathbf{e}_3\n$$\n将中面位移和线性化后的导向矢量代入一般位移方程，得到整个厚度上的位移场分量：\n$$\n\\mathbf{u}(x, y, z) = w(x,y)\\mathbf{e}_3 + z ((-w_{,x} \\mathbf{e}_1 - w_{,y} \\mathbf{e}_2 + \\mathbf{e}_3) - \\mathbf{e}_3) = -z w_{,x} \\mathbf{e}_1 - z w_{,y} \\mathbf{e}_2 + w \\mathbf{e}_3\n$$\n位移矢量 $\\mathbf{u} = u_x \\mathbf{e}_1 + u_y \\mathbf{e}_2 + u_z \\mathbf{e}_3$ 的分量为：\n$$\nu_x(x,y,z) = -z w_{,x}(x,y)\n$$\n$$\nu_y(x,y,z) = -z w_{,y}(x,y)\n$$\n$$\nu_z(x,y,z) = w(x,y)\n$$\n该位移场正确地满足了基尔霍夫-拉夫假定中的零横向剪切应变条件：\n$$\n\\varepsilon_{xz} = \\frac{1}{2}(u_{x,z} + u_{z,x}) = \\frac{1}{2}(\\frac{\\partial}{\\partial z}(-z w_{,x}) + \\frac{\\partial}{\\partial x}(w)) = \\frac{1}{2}(-w_{,x} + w_{,x}) = 0\n$$\n$$\n\\varepsilon_{yz} = \\frac{1}{2}(u_{y,z} + u_{z,y}) = \\frac{1}{2}(\\frac{\\partial}{\\partial z}(-z w_{,y}) + \\frac{\\partial}{\\partial y}(w)) = \\frac{1}{2}(-w_{,y} + w_{,y}) = 0\n$$\n现在，我们使用小应变定义 $\\varepsilon_{ij} = \\frac{1}{2}(u_{i,j} + u_{j,i})$ 来计算面内应变分量。\n$x$ 方向的正应变为：\n$$\n\\varepsilon_{xx} = u_{x,x} = \\frac{\\partial}{\\partial x}(-z w_{,x}) = -z w_{,xx}\n$$\n$y$ 方向的正应变为：\n$$\n\\varepsilon_{yy} = u_{y,y} = \\frac{\\partial}{\\partial y}(-z w_{,y}) = -z w_{,yy}\n$$\n$x\\text{-}y$ 平面内的张量剪切应变为：\n$$\n\\varepsilon_{xy} = \\frac{1}{2}(u_{x,y} + u_{y,x}) = \\frac{1}{2}\\left(\\frac{\\partial}{\\partial y}(-z w_{,x}) + \\frac{\\partial}{\\partial x}(-z w_{,y})\\right) = \\frac{1}{2}(-z w_{,xy} - z w_{,yx})\n$$\n假设位移函数 $w(x,y)$ 足够光滑，则微分顺序无关 ($w_{,xy} = w_{,yx}$)，因此：\n$$\n\\varepsilon_{xy} = -z w_{,xy}\n$$\n问题要求的是工程剪切应变 $\\gamma_{xy}$，其定义为 $\\gamma_{xy} = 2 \\varepsilon_{xy}$。\n$$\n\\gamma_{xy} = -2z w_{,xy}\n$$\n代入给定的曲率分量定义 $\\kappa_x = w_{,xx}$、$\\kappa_y = w_{,yy}$ 和 $\\kappa_{xy} = w_{,xy}$，我们得到应变作为厚度坐标 $z$ 和中面曲率的函数的最终表达式：\n$$\n\\varepsilon_{xx}(z) = -z \\kappa_x\n$$\n$$\n\\varepsilon_{yy}(z) = -z \\kappa_y\n$$\n$$\n\\gamma_{xy}(z) = -2z \\kappa_{xy}\n$$\n这些结果表明，面内应变沿厚度呈线性变化，这是基尔霍夫-拉夫板理论的一个经典结果。\n\n最后，我们必须验证在中面 $z=0$ 处薄膜应变为零。将 $z=0$ 代入推导出的表达式：\n$$\n\\varepsilon_{xx}(0) = -(0)\\kappa_x = 0\n$$\n$$\n\\varepsilon_{yy}(0) = -(0)\\kappa_y = 0\n$$\n$$\n\\gamma_{xy}(0) = -2(0)\\kappa_{xy} = 0\n$$\n这证实了中面上薄膜变形为零的条件，与初始问题陈述中的纯弯曲状态一致。因此，所需的行矩阵由这些推导出的表达式构成。", "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n-z\\kappa_x  -z\\kappa_y  -2z\\kappa_{xy}\n\\end{bmatrix}\n}\n$$", "id": "2596080"}, {"introduction": "退化实体法的一个强大之处在于其源于三维连续介质力学，但这同样也引入了一些需要仔细处理的细节。本练习旨在探讨弯曲过程中因泊松效应引起的厚度变化这一关键物理现象[@problem_id:2595991]。通过对比一个简化的运动学假设（$\\varepsilon_{33}=0$）与物理上更准确的平面应力条件（$\\sigma_{33}=0$），你将认识到不同建模选择对结果的深刻影响。", "problem": "设计并实现一个独立的数值实验，其形式为一个单一的可执行程序，用以量化退化实体法 (Degenerated Solid Approach, DSA) 壳截面在弯曲作用下如何预测厚度应变，这包括横向正应力未被施加或被明确施加为零两种情况。从基本的小应变、小转动运动学和线性各向同性三维本构定律出发。假设一个厚度为 $t$ 的平壳截面，其厚度方向坐标 $z \\in [-t/2,t/2]$ 从中面线性度量，并考虑在中面轴 $x$ 和 $y$ 上具有给定曲率 $\\kappa_x$ 和 $\\kappa_y$ 的纯弯曲情况。在本实验中忽略横向剪切应变。\n\n使用以下基本依据：\n- 线性化小应变张量 $\\boldsymbol{\\varepsilon}$，其中，经典壳截面在纯弯曲下的面内弯曲应变表示为 $\\varepsilon_{11} = -z\\,\\kappa_x$，$\\varepsilon_{22} = -z\\,\\kappa_y$，而 $\\varepsilon_{12}$ 取决于扭转曲率，但在仅给定 $\\kappa_x$ 和 $\\kappa_y$ 的情况下，本任务不需要该分量。假设没有薄膜应变和横向剪切应变。\n- 线性各向同性三维 Hooke 定律 $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon} + \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I}$，其中 $\\lambda$ 和 $\\mu$ 是 Lamé 参数，通过 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}$ 与杨氏模量 (Young’s modulus) $E$ 和泊松比 (Poisson’s ratio) $\\nu$ 相关联。\n\n定义并比较 DSA 壳截面的以下两种建模选择：\n- 模型 A（不施加横向正应力）：采用一种典型的朴素退化实体壳的运动学约束，该约束不允许在纯弯曲中出现厚度拉伸，即在整个厚度上设置 $\\varepsilon_{33} = 0$。这通常会产生一个非零的 $\\sigma_{33}$。\n- 模型 B（施加零横向正应力）：在整个厚度上逐点施加 $\\sigma_{33}=0$，并确定在存在面内弯曲应变的情况下，满足三维各向同性弹性的隐含 $\\varepsilon_{33}$。\n\n对于两种模型，将可测量量定义为顶面厚度应变，即在 $z=+t/2$ 处的 $\\varepsilon_{33}$ 值。目标是为每个测试用例计算一对数值 $[\\varepsilon_{33}^{\\mathrm{A}}(+t/2), \\varepsilon_{33}^{\\mathrm{B}}(+t/2)]$，其中第一个条目对应模型 A，第二个条目对应模型 B。由于应变是无量纲的，因此将两个输出都报告为无量纲数。\n\n您的程序必须：\n- 从基本依据推导所需的表达式，而不是引用专门的壳体公式。\n- 实现两种模型顶面厚度应变的计算。\n- 使用以下测试套件，每个套件由 $(E,\\nu,t,\\kappa_x,\\kappa_y)$ 指定，其中 $E$ 的单位为帕斯卡 (pascals)，$t$ 的单位为米 (meters)，$\\kappa_x,\\kappa_y$ 的单位为米分之一 (inverse meters)：\n    1. $(2.10\\times 10^{11},\\,0.3,\\,0.01,\\,1.0,\\,0.0)$\n    2. $(7.0\\times 10^{10},\\,0.0,\\,0.02,\\,2.0,\\,0.0)$\n    3. $(3.0\\times 10^{9},\\,0.49,\\,0.005,\\,10.0,\\,10.0)$\n    4. $(1.0\\times 10^{11},\\,0.25,\\,0.0001,\\,10000.0,\\,-10000.0)$\n\n关于数值输出：\n- 将所有输出表示为无量纲应变。\n- 将每个报告值精确到 $6$ 位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个数对列表，每个数对的格式为 [$\\varepsilon_{33}^{\\mathrm{A}}(+t/2)$,$\\varepsilon_{33}^{\\mathrm{B}}(+t/2)$]，不含任何空格，数对之间用逗号分隔。例如：[[$a_1$,$b_1$],[$a_2$,$b_2$],[$a_3$,$b_3$],[$a_4$,$b_4$]]。\n\n您的交付内容是：\n- 一个完整的、可运行的程序，用于计算测试套件所需的量。\n- 程序应仅以上述确切格式生成单行输出。", "solution": "问题陈述是有效的。它提出了一个在连续介质力学及其在壳单元理论中应用的适定 (well-posed) 且具有科学依据的练习，没有矛盾或含糊之处。我们将进行严格的推导。\n\n目标是通过计算纯弯曲下退化实体壳单元顶面的厚度应变，来比较两种建模假设。\n\n**1. 基本关系**\n\n应变状态由纯弯曲的小应变运动学决定。根据问题陈述中无薄膜应变或横向剪切应变的假设，应变张量 $\\boldsymbol{\\varepsilon}$ 的非零分量如下：\n$$\n\\varepsilon_{11} = -z\\,\\kappa_x\n$$\n$$\n\\varepsilon_{22} = -z\\,\\kappa_y\n$$\n分量 $\\varepsilon_{33}$ 尚待根据具体的模型假设确定。所有其他分量均为零，因此应变张量的形式为：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} -z\\,\\kappa_x  0  0 \\\\ 0  -z\\,\\kappa_y  0 \\\\ 0  0  \\varepsilon_{33} \\end{pmatrix}\n$$\n应变张量的迹为：\n$$\n\\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33} = -z(\\kappa_x + \\kappa_y) + \\varepsilon_{33}\n$$\n材料行为由线性各向同性三维 Hooke 定律描述：\n$$\n\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon} + \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I}\n$$\n其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\mathbf{I}$ 是单位矩阵，$\\lambda$ 和 $\\mu$ 是 Lamé 参数。其分量形式为 $\\sigma_{ij} = 2\\mu\\,\\varepsilon_{ij} + \\lambda\\,\\delta_{ij}\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})$。\n\n**2. 横向应力控制方程的推导**\n\n我们关心的是横向正应力 $\\sigma_{33}$ 及其与横向正应变 $\\varepsilon_{33}$ 的关系。使用 Hooke 定律关于 $33$ 分量（$i=j=3$）的分量形式：\n$$\n\\sigma_{33} = 2\\mu\\,\\varepsilon_{33} + \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\n$$\n代入迹的表达式：\n$$\n\\sigma_{33} = 2\\mu\\,\\varepsilon_{33} + \\lambda(-z(\\kappa_x + \\kappa_y) + \\varepsilon_{33})\n$$\n合并含 $\\varepsilon_{33}$ 的项：\n$$\n\\sigma_{33} = (2\\mu + \\lambda)\\varepsilon_{33} - \\lambda z(\\kappa_x + \\kappa_y)\n$$\n这个基本方程将横向应力 $\\sigma_{33}$ 与横向应变 $\\varepsilon_{33}$ 以及给定的弯曲曲率联系起来。它将用于分析两种模型。\n\n**3. 模型 A 的分析**\n\n模型 A 施加了一个严格的运动学约束，即不发生厚度应变。在用基本实体单元公式模拟薄结构时，这是一个常见但朴素的假设。\n该约束为：\n$$\n\\varepsilon_{33} = 0 \\quad \\forall z \\in [-t/2, t/2]\n$$\n需要计算的量是顶面厚度应变 $\\varepsilon_{33}^{\\mathrm{A}}(+t/2)$。根据模型的定义：\n$$\n\\varepsilon_{33}^{\\mathrm{A}}(+t/2) = 0\n$$\n该模型错误地预测了弯曲中由泊松效应引起的厚度变化为零。其结果是，它预测出一个非物理的横向正应力 $\\sigma_{33}^{\\mathrm{A}} = -\\lambda z(\\kappa_x + \\kappa_y)$，这违反了壳体顶面和底面的零牵引力边界条件。\n\n**4. 模型 B 的分析**\n\n模型 B 施加了物理上正确的零横向正应力条件，这对应于厚度方向上每一点的平面应力状态。这是经典板壳理论中所做的假设。\n该约束为：\n$$\n\\sigma_{33} = 0 \\quad \\forall z \\in [-t/2, t/2]\n$$\n我们将此约束应用于我们的控制方程：\n$$\n0 = (2\\mu + \\lambda)\\varepsilon_{33}^{\\mathrm{B}}(z) - \\lambda z(\\kappa_x + \\kappa_y)\n$$\n求解厚度应变 $\\varepsilon_{33}^{\\mathrm{B}}(z)$：\n$$\n\\varepsilon_{33}^{\\mathrm{B}}(z) = \\frac{\\lambda}{2\\mu + \\lambda} z(\\kappa_x + \\kappa_y)\n$$\n为了用杨氏模量 $E$ 和泊松比 $\\nu$ 来表示系数，我们使用给定的关系式：\n$$\n\\mu = \\frac{E}{2(1+\\nu)} \\quad \\text{和} \\quad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n$$\n分母为：\n$$\n2\\mu + \\lambda = 2\\left(\\frac{E}{2(1+\\nu)}\\right) + \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{E}{1+\\nu} + \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{E(1-2\\nu) + E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\n因此，系数比为：\n$$\n\\frac{\\lambda}{2\\mu + \\lambda} = \\frac{\\frac{E\\nu}{(1+\\nu)(1-2\\nu)}}{\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}} = \\frac{\\nu}{1-\\nu}\n$$\n因此，厚度应变分布为：\n$$\n\\varepsilon_{33}^{\\mathrm{B}}(z) = \\frac{\\nu}{1-\\nu} z (\\kappa_x + \\kappa_y)\n$$\n需要计算的量是在顶面 $z = +t/2$ 处评估的该应变值：\n$$\n\\varepsilon_{33}^{\\mathrm{B}}(+t/2) = \\frac{\\nu}{1-\\nu} \\frac{t}{2} (\\kappa_x + \\kappa_y)\n$$\n\n**5. 计算公式总结**\n\n对于由元组 $(E, \\nu, t, \\kappa_x, \\kappa_y)$ 指定的每个测试用例，所需的顶面厚度应变对 $[\\varepsilon_{33}^{\\mathrm{A}}(+t/2), \\varepsilon_{33}^{\\mathrm{B}}(+t/2)]$ 计算如下：\n\n-   **模型 A 应变：**\n    $$\n    \\varepsilon_{33}^{\\mathrm{A}}(+t/2) = 0\n    $$\n\n-   **模型 B 应变：**\n    $$\n    \\varepsilon_{33}^{\\mathrm{B}}(+t/2) = \\left( \\frac{\\nu}{1-\\nu} \\right) \\frac{t}{2} (\\kappa_x + \\kappa_y)\n    $$\n\n这些公式将用于给定的测试套件。请注意，杨氏模量 $E$ 并未出现在应变的最终表达式中，因为这是一个由运动学驱动的问题。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes thickness strain at the top surface of a shell section under pure bending\n    for two different modeling assumptions based on the Degenerated Solid Approach (DSA).\n\n    Model A assumes zero thickness strain (eps_33 = 0).\n    Model B enforces zero transverse normal stress (sigma_33 = 0).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E, nu, t, kx, ky)\n    # E: Young's modulus (Pa)\n    # nu: Poisson's ratio (dimensionless)\n    # t: thickness (m)\n    # kx, ky: curvatures (1/m)\n    test_cases = [\n        (2.10e11, 0.3, 0.01, 1.0, 0.0),\n        (7.0e10, 0.0, 0.02, 2.0, 0.0),\n        (3.0e9, 0.49, 0.005, 10.0, 10.0),\n        (1.0e11, 0.25, 0.0001, 10000.0, -10000.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, nu, t, kx, ky = case\n\n        # --- Model A Calculation ---\n        # The kinematic assumption for Model A is that thickness strain is zero everywhere.\n        # eps_33_A(z) = 0 for all z.\n        eps33_A_top = 0.0\n\n        # --- Model B Calculation ---\n        # The assumption for Model B is that transverse normal stress is zero (sigma_33 = 0).\n        # The derived formula for the thickness strain at the top surface (z = +t/2) is:\n        # eps_33_B(z=+t/2) = (nu / (1 - nu)) * (t / 2) * (kx + ky)\n        \n        # Handle the case where nu = 1, though not present in test data.\n        if nu == 1.0:\n            # This would physically correspond to an infinite strain if (kx+ky) is not zero.\n            # We set it to a large number or handle as an error, but for the given\n            # test suite, this condition is not met.\n            eps33_B_top = float('inf') if (kx + ky) != 0 else 0.0\n        else:\n            eps33_B_top = (nu / (1.0 - nu)) * (t / 2.0) * (kx + ky)\n\n        # Append the pair of results for the current test case.\n        results.append([eps33_A_top, eps33_B_top])\n\n    # --- Final Output Formatting ---\n    # The output format must be a single line: [[a1,b1],[a2,b2],...], with no spaces\n    # and each value rounded to exactly 6 decimal places.\n    \n    formatted_pairs = []\n    for pair in results:\n        # Format each number to 6 decimal places and create the pair string \"[a,b]\".\n        # The f-string format specifier '{value:.6f}' handles rounding correctly.\n        formatted_pair_str = f\"[{pair[0]:.6f},{pair[1]:.6f}]\"\n        formatted_pairs.append(formatted_pair_str)\n\n    # Join the formatted pairs with commas and enclose in brackets.\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n\n    print(final_output_string)\n\nsolve()\n```", "id": "2595991"}, {"introduction": "开发一个有限元不仅是编写代码，更关键的是要严格地验证其正确性。最后的这项练习提供了一份全面的验证清单，它植根于基本力学和数值分析原理[@problem_id:2596066]。这份清单将作为你未来验证任何新实现的壳单元的路线图，确保其可靠性和准确性。", "problem": "您实现了一种基于位移的壳单元有限元，采用了退化实体法（DSA）。在该方法中，通过引入中面插值和沿厚度方向的导向矢量场，将一个三维等参实体在运动学上简化为一个壳。该公式旨在用于线性弹性力学中的小应变和小转动情况，并在单元参数坐标中使用标准高斯积分。现在要求您为该实现设计一份严格的验证清单，该清单需基于第一性原理，包括：线性弹性力学的虚功原理、叠加刚体运动下的不变性、等参插值的多项式完备性、Galerkin方法的变分收敛理论以及经典壳理论的厚度缩放关系。\n\n请选择所有必须包含在一个可靠的DSA壳单元验证清单中的项目，确保这些检查是必要的，并且为了科学的真实性而陈述正确。该清单必须包括斑块检验、能量收敛和刚体模态检查，但也可以包含其他必要的项目。选择所有适用项。\n\nA. 包括在平直和轻度扭曲的网格上进行膜和弯曲斑块检验，以验证在等参映射的雅可比行列式处处为正的前提下，恒定面内应变状态和恒定曲率状态能够被精确再现（在数值容差范围内）。\n\nB. 包括横向剪切斑块检验：驱动一个板趋向恒定横向剪切状态，并验证在薄板极限下的纯弯曲情况下，计算出的横向剪切应变能随着厚度 $t \\to 0$ 趋于零（无剪切自锁），并且恒定横向剪切状态能在容差范围内被再现。\n\nC. 包括对无约束装配体进行刚体模态审查：验证全局刚度矩阵 $K$ 是对称半正定的，并且在三维空间中恰好有 $6$ 个独立的零模态，对应于 $3$ 个平移和 $3$ 个旋转。\n\nD. 包括在h-细化下对具有已知精确解的光滑基准问题进行能量范数收敛性研究：验证能量范数误差的衰减速率符合单元插值阶数 $p$ 的预期速率，例如 $\\lVert e \\rVert_{E} = \\mathcal{O}(h^{p})$。\n\nE. 允许在高度扭曲区域出现雅可比行列式为负的单元，以更好地表示曲率，前提是全局解保持连续。\n\nF. 依赖于单个严重扭曲单元在任意载荷下某个节点的位移，通过反复Newton迭代直至变化小于 $1\\times 10^{-6}$，以此作为主要的正确性检查。\n\nG. 包括厚度缩放研究：对于膜力主导的载荷，验证总应变能满足 $U \\propto t$；对于弯曲主导的载荷，验证总应变能满足 $U \\propto t^{3}$，这与经典壳理论一致。\n\nH. 故意启用无稳定化的减缩积分，并验证零能沙漏模态的出现，以此作为公式避免了自锁的证据。\n\nI. 验证单元刚度矩阵的对称性和功的互易性：在线性、保守本构律和精确积分下，组装的切线刚度满足 $K = K^{T}$，并在相互的载荷/位移交换中产生相同的功（Maxwell–Betti互易定理）。", "solution": "提交分析的问题陈述在科学上是合理的且适定的。它描述了验证有限元公式的标准背景——具体来说，是用于线性弹性力学的退化实体壳单元。该问题要求识别出一个验证清单中必要且正确的项目，这些项目需基于计算力学的既定原则。问题是有效的，我们可以继续进行解答。\n\n我们现在将评估每个提议的清单项目。\n\n**A. 包括在平直和轻度扭曲的网格上进行膜和弯曲斑块检验，以验证在等参映射的雅可比行列式处处为正的前提下，恒定面内应变状态和恒定曲率状态能够被精确再现（在数值容差范围内）。**\n\n这是一个基础且必要的验证测试。由Irons构思的斑块检验是收敛的必要条件。当施加能产生恒定应变状态的边界条件时，单元公式必须能够精确地表示该状态。对于壳单元，这必须对膜（恒定面内应变）和纯弯曲（恒定曲率）状态都进行验证。在规则和扭曲的网格上执行测试，可确保公式是鲁棒的，并且其精度不会因合理的几何扭曲而受损。等参映射的雅可比行列式必须为正（$J  0$）的条件至关重要；它保证了从父单元到物理单元的唯一、非反转的映射，这是任何有意义计算的前提。\n\n结论：**正确**。\n\n**B. 包括横向剪切斑块检验：驱动一个板趋向恒定横向剪切状态，并验证在薄板极限下的纯弯曲情况下，计算出的横向剪切应变能随着厚度 $t \\to 0$ 趋于零（无剪切自锁），并且恒定横向剪切状态能在容差范围内被再现。**\n\n这个项目结合了对基于Reissner-Mindlin运动学（例如退化实体法）的壳单元的两项关键检查。首先，它解决了剪切自锁问题。在薄板极限（$t \\to 0$）下，纯弯曲状态应引起可忽略的横向剪切应变。如果单元公式错误地产生了伪剪切应变，它将变得过于刚硬，这种现象被称为剪切自锁。验证在纯弯曲下，随着 $t \\to 0$，横向剪切应变能消失，即可确认不存在这种病态问题。其次，它包括了对横向剪切分量的斑块检验。单元必须能够精确表示恒定的横向剪切状态。此检查的两个组成部分对于验证现代壳单元都是必不可少的。\n\n结论：**正确**。\n\n**C. 包括对无约束装配体进行刚体模态审查：验证全局刚度矩阵 $K$ 是对称半正定的，并且在三维空间中恰好有 $6$ 个独立的零模态，对应于 $3$ 个平移和 $3$ 个旋转。**\n\n这是一项不可或缺的检查。任何有效的连续体结构的有限元模型都必须能够在不产生内应力或应变的情况下进行刚体运动。对于三维空间中的无约束单元或装配体，存在六种刚体模态（三个平移，三个旋转）。这些运动对应于刚度矩阵 $K$ 的零空间。因此，对 $K$ 进行特征值分析必须揭示恰好六个零特征值（在机器精度内）。所有其他特征值必须为正，这确定了 $K$ 是半正定的。$K$ 的对称性是使用带有对称本构律（线性弹性）的变分原理的结果。此检查验证了单元公式的基本运动学完整性。\n\n结论：**正确**。\n\n**D. 包括在h-细化下对具有已知精确解的光滑基准问题进行能量范数收敛性研究：验证能量范数误差的衰减速率符合单元插值阶数 $p$ 的预期速率，例如 $\\lVert e \\rVert_{E} = \\mathcal{O}(h^{p})$。**\n\n这是验证有限元实现准确性和正确性的标准程序。根据变分收敛理论，对于应用于足够正则问题的协调有限元方法，能量范数中的误差 $\\lVert e \\rVert_{E} \\equiv \\lVert u - u_h \\rVert_E$ 必须随着网格尺寸 $h$ 趋于零而收敛到零。收敛速率由用于单元形函数的多项式插值的阶数 $p$ 决定。最佳收敛速率为 $\\mathcal{O}(h^p)$。在具有已知光滑解的基准问题上验证实现达到了这个理论速率，可以确认代码中没有会降低其精度的错误。\n\n结论：**正确**。\n\n**E. 允许在高度扭曲区域出现雅可比行列式为负的单元，以更好地表示曲率，前提是全局解保持连续。**\n\n这个陈述是根本上错误和危险的。雅可比行列式 $J$ 将物理坐标系中的微分体积元与父坐标系中的微分体积元联系起来：$dV = J \\, d\\xi d\\eta d\\zeta$。非正的雅可比行列式（$J \\le 0$）表示等参映射是奇异的或“折叠的”，意味着它不再是一一映射。这违反了有限元方法的数学基础。在这样的域上进行数值积分是未定义的或会产生无意义的结果。单元几何是无效的。声称这可以“更好地表示曲率”是没有科学依据的。使用这种无效单元无法保证全局解的连续性；事实上，情况恰恰相反。\n\n结论：**不正确**。\n\n**F. 依赖于单个严重扭曲单元在任意载荷下某个节点的位移，通过反复Newton迭代直至变化小于 $1\\times 10^{-6}$，以此作为主要的正确性检查。**\n\n这个提议的检查在方法论上是不健全的，并且完全不充分。验证必须是系统和全面的，而不是基于轶事般的单点检查。使用单个“严重扭曲”的单元是对网格质量差的鲁棒性测试，而不是主要的正确性检查。“任意载荷”的定义不明确；验证测试需要精确定义的载荷和边界条件以产生已知的结果。此外，问题指定的是线性弹性力学，其控制代数系统是 $K d = F$。这里没有“Newton迭代”，这是非线性分析的特征。这个提议是一系列不良实践的集合。\n\n结论：**不正确**。\n\n**G. 包括厚度缩放研究：对于膜力主导的载荷，验证总应变能满足 $U \\propto t$；对于弯曲主导的载荷，验证总应变能满足 $U \\propto t^{3}$，这与经典壳理论一致。**\n\n这是一项针对壳单元的重要且富有洞察力的验证测试。它检查单元的行为是否正确地捕捉了薄结构的物理特性。根据经典板壳理论，膜刚度与厚度 $t$ 成正比，而弯曲刚度与 $t^3$ 成正比。因此，对于给定的位移场，在膜力主导的问题中，应变能 $U$ 应与 $t$ 线性缩放，而在弯曲主导的问题中，应与 $t^3$ 缩放。验证有限元模型再现了这些渐近缩放定律，可以确认该公式正确区分了膜作用和弯曲作用，并且在薄板极限下表现出物理上正确的行为。\n\n结论：**正确**。\n\n**H. 故意启用无稳定化的减缩积分，并验证零能沙漏模态的出现，以此作为公式避免了自锁的证据。**\n\n这个陈述表明了对数值方法的严重误解。减缩积分是一种用于缓解自锁的技术，但其常见的副作用是引入伪零能变形模态，即所谓的沙漏模态。这些模态不受单元抵抗，并且会破坏解。它们的出现是刚度矩阵秩亏的症状，这是一种必须通过稳定化技术（例如，沙漏控制）来抑制的数值病态。沙漏模态的出现不是成功的“证据”；它是一个需要解决的问题的证据。人们验证的是单元公式*避免了自锁*并*控制了伪模态*，而不是它产生了伪模态。\n\n结论：**不正确**。\n\n**I. 验证单元刚度矩阵的对称性和功的互易性：在线性、保守本构律和精确积分下，组装的切线刚度满足 $K = K^{T}$，并在相互的载荷/位移交换中产生相同的功（Maxwell–Betti互易定理）。**\n\n这是一个基础但关键的检查。对于从变分原理（虚功原理）推导出的保守系统（线性弹性材料，无非保守载荷），其产生的刚度矩阵必须是对称的。这个性质，$K = K^T$，在离散层面上反映了Maxwell-Betti互易定理。验证刚度矩阵的对称性是检查实现错误的一个简单而有效的方法。虽然“精确积分”是一种理想情况，但使用像Gauss-Legendre这样的标准对称求积方案，即使积分不精确，通常也能保持对称性。此检查是严格验证协议的必要部分。\n\n结论：**正确**。", "answer": "$$\\boxed{ABCDGI}$$", "id": "2596066"}]}