{"hands_on_practices": [{"introduction": "在有限元分析中，真实世界的几何形状很少是完美的矩形或三角形。为了模拟这些复杂的形状，我们采用等参单元的概念，它能将一个简单的“标准”单元映射到物理空间中的实际单元。这项练习将指导你计算这个映射的核心——雅可比矩阵，这是将在标准坐标系下计算的导数转换为物理坐标系下应变的关键步骤。[@problem_id:2542271]", "problem": "考虑一个四节点双线性等参轴对称实体有限元，其自然（母）坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，物理坐标为 $(r,z)$。该单元使用标准的双线性形函数 $N_{i}(\\xi,\\eta)$，其中 $i\\in\\{1,2,3,4\\}$，分别对应于母空间角点 $(\\xi,\\eta)=(-1,-1),(+1,-1),(+1,+1),(-1,+1)$ 处的节点。等参映射为 $r(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,r_{i}$ 和 $z(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,z_{i}$。从链式法则和映射的雅可比定义出发，推导雅可比矩阵 $J=\\partial(r,z)/\\partial(\\xi,\\eta)$ 以及将自然梯度 $\\left[\\partial N_{i}/\\partial \\xi,\\partial N_{i}/\\partial \\eta\\right]^{\\mathsf{T}}$ 映射到应变-位移矩阵（B矩阵）中所需的物理梯度 $\\left[\\partial N_{i}/\\partial r,\\partial N_{i}/\\partial z\\right]^{\\mathsf{T}}$ 的算子关系。然后，对于一个特定的轴对称单元，其在 $(r,z)$ 平面内的节点坐标为\n- 节点 $1$：$(r_{1},z_{1})=(\\,0.5,\\,0\\,)$，\n- 节点 $2$：$(r_{2},z_{2})=(\\,1.5,\\,0\\,)$，\n- 节点 $3$：$(r_{3},z_{3})=(\\,1.5,\\,1\\,)$，\n- 节点 $4$：$(r_{4},z_{4})=(\\,0.5,\\,1\\,)$，\n在自然点 $(\\xi,\\eta)=(0,0)$ 处，计算雅可比矩阵的各项以及对 $i=1,2,3,4$ 的物理导数 $\\partial N_{i}/\\partial r$ 和 $\\partial N_{i}/\\partial z$。长度单位使用米。将最终答案表示为单个行矩阵，首先按行主序 $\\left[J_{11},J_{12},J_{21},J_{22}\\right]$ 列出雅可比矩阵的各项，然后按顺序 $\\left[\\partial N_{1}/\\partial r,\\partial N_{1}/\\partial z,\\partial N_{2}/\\partial r,\\partial N_{2}/\\partial z,\\partial N_{3}/\\partial r,\\partial N_{3}/\\partial z,\\partial N_{4}/\\partial r,\\partial N_{4}/\\partial z\\right]$ 列出八个导数。报告精确值（不进行四舍五入），并且不要在行矩阵中包含单位。", "solution": "问题陈述已被解析和验证。我们发现它具有科学依据，问题定义明确、客观且完整。它代表了有限元方法理论中的一个标准练习。没有逻辑不一致或事实错误。因此，有必要提供一个解。\n\n四节点等参单元使用定义在母域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 上的双线性形函数 $N_i(\\xi, \\eta)$。对于分别位于角点 $(\\xi_i, \\eta_i)$ 为 $(-1, -1), (+1, -1), (+1, +1), (-1, +1)$ 的节点 $i \\in \\{1, 2, 3, 4\\}$，其形函数为：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta)\n\\end{aligned}\n$$\n等参映射通过这些形函数将物理坐标 $(r, z)$ 与自然坐标 $(\\xi, \\eta)$ 联系起来：\n$$\nr(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) r_i \\quad \\text{和} \\quad z(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) z_i\n$$\n其中 $(r_i, z_i)$ 是物理域中节点 $i$ 的坐标。\n\n物理坐标系和自然坐标系中导数之间的关系通过链式法则建立。对于任意函数 $f(r, z)$，其关于 $(\\xi, \\eta)$ 的导数为：\n$$\n\\frac{\\partial f}{\\partial \\xi} = \\frac{\\partial f}{\\partial r} \\frac{\\partial r}{\\partial \\xi} + \\frac{\\partial f}{\\partial z} \\frac{\\partial z}{\\partial \\xi}\n$$\n$$\n\\frac{\\partial f}{\\partial \\eta} = \\frac{\\partial f}{\\partial r} \\frac{\\partial r}{\\partial \\eta} + \\frac{\\partial f}{\\partial z} \\frac{\\partial z}{\\partial \\eta}\n$$\n这可以表示为矩阵形式：\n$$\n\\begin{Bmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial r}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial r}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\eta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial f}{\\partial r} \\\\ \\frac{\\partial f}{\\partial z} \\end{Bmatrix}\n$$\n此关系中的矩阵是变换的雅可比矩阵，记为 $J$：\n$$\nJ = \\frac{\\partial(r, z)}{\\partial(\\xi, \\eta)} = \\begin{bmatrix} J_{11} & J_{12} \\\\ J_{21} & J_{22} \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial r}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial r}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\eta} \\end{bmatrix}\n$$\n雅可比矩阵的分量通过对等参映射表达式求导得到：\n$$\nJ_{11} = \\frac{\\partial r}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} r_i \\quad, \\quad J_{12} = \\frac{\\partial z}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} z_i\n$$\n$$\nJ_{21} = \\frac{\\partial r}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} r_i \\quad, \\quad J_{22} = \\frac{\\partial z}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} z_i\n$$\n至此完成了雅可比矩阵的推导。\n\n为了从自然梯度 $\\left[\\partial N_i / \\partial \\xi, \\partial N_i / \\partial \\eta\\right]^{\\mathsf{T}}$ 获得物理梯度 $\\left[\\partial N_i / \\partial r, \\partial N_i / \\partial z\\right]^{\\mathsf{T}}$，我们必须对矩阵关系求逆。设 $f = N_i$，我们有：\n$$\n\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix} = J \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial r} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{Bmatrix}\n$$\n求解物理梯度需要雅可比矩阵的逆，前提是其行列式不为零：\n$$\n\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial r} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{Bmatrix} = J^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}\n$$\n其中\n$$\nJ^{-1} = \\frac{1}{\\det(J)} \\begin{bmatrix} J_{22} & -J_{12} \\\\ -J_{21} & J_{11} \\end{bmatrix} \\quad \\text{且} \\quad \\det(J) = J_{11}J_{22} - J_{12}J_{21}\n$$\n因此，将自然梯度映射到物理梯度的算子是 $J^{-1}$。\n\n现在，我们对给定节点坐标的单元进行具体计算：\n- 节点 $1$：$(r_1, z_1) = (0.5, 0)$\n- 节点 $2$：$(r_2, z_2) = (1.5, 0)$\n- 节点 $3$：$(r_3, z_3) = (1.5, 1)$\n- 节点 $4$：$(r_4, z_4) = (0.5, 1)$\n所有计算都将在母单元的中心 $(\\xi, \\eta) = (0, 0)$ 处进行。\n\n首先，计算形函数关于自然坐标的导数：\n$$\n\\begin{aligned}\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi) \\\\\n\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi) \\\\\n\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi) \\\\\n\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta), \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n\\end{aligned}\n$$\n在 $(\\xi, \\eta) = (0, 0)$ 处计算这些导数的值：\n$$\n\\begin{alignedat}{4}\n\\frac{\\partial N_1}{\\partial \\xi}\\bigg|_{(0,0)} = -\\frac{1}{4}, \\quad \\frac{\\partial N_2}{\\partial \\xi}\\bigg|_{(0,0)} = \\frac{1}{4}, \\quad \\frac{\\partial N_3}{\\partial \\xi}\\bigg|_{(0,0)} = \\frac{1}{4}, \\quad \\frac{\\partial N_4}{\\partial \\xi}\\bigg|_{(0,0)} = -\\frac{1}{4} \\\\\n\\frac{\\partial N_1}{\\partial \\eta}\\bigg|_{(0,0)} = -\\frac{1}{4}, \\quad \\frac{\\partial N_2}{\\partial \\eta}\\bigg|_{(0,0)} = -\\frac{1}{4}, \\quad \\frac{\\partial N_3}{\\partial \\eta}\\bigg|_{(0,0)} = \\frac{1}{4}, \\quad \\frac{\\partial N_4}{\\partial \\eta}\\bigg|_{(0,0)} = \\frac{1}{4}\n\\end{alignedat}\n$$\n使用这些值，在 $(\\xi, \\eta) = (0, 0)$ 处的雅可比分量为：\n$$\nJ_{11} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} r_i = \\frac{1}{4}(-1 \\cdot 0.5 + 1 \\cdot 1.5 + 1 \\cdot 1.5 - 1 \\cdot 0.5) = \\frac{1}{4}(-0.5 + 1.5 + 1.5 - 0.5) = \\frac{2}{4} = \\frac{1}{2}\n$$\n$$\nJ_{12} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} z_i = \\frac{1}{4}(-1 \\cdot 0 + 1 \\cdot 0 + 1 \\cdot 1 - 1 \\cdot 1) = \\frac{1}{4}(0 + 0 + 1 - 1) = 0\n$$\n$$\nJ_{21} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} r_i = \\frac{1}{4}(-1 \\cdot 0.5 - 1 \\cdot 1.5 + 1 \\cdot 1.5 + 1 \\cdot 0.5) = \\frac{1}{4}(-0.5 - 1.5 + 1.5 + 0.5) = 0\n$$\n$$\nJ_{22} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} z_i = \\frac{1}{4}(-1 \\cdot 0 - 1 \\cdot 0 + 1 \\cdot 1 + 1 \\cdot 1) = \\frac{1}{4}(0 + 0 + 1 + 1) = \\frac{2}{4} = \\frac{1}{2}\n$$\n在 $(\\xi, \\eta) = (0, 0)$ 处的雅可比矩阵是 $J = \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{bmatrix}$。其行列式为 $\\det(J) = (1/2)(1/2) - 0 = 1/4$。逆雅可比矩阵为：\n$$\nJ^{-1} = \\frac{1}{1/4} \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{bmatrix} = 4 \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{bmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix}\n$$\n最后，计算在 $(\\xi, \\eta) = (0, 0)$ 处每个节点 $i$ 的物理导数：\n对于 $i=1$：$\\begin{Bmatrix} \\partial N_1/\\partial r \\\\ \\partial N_1/\\partial z \\end{Bmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{Bmatrix} -1/4 \\\\ -1/4 \\end{Bmatrix} = \\begin{Bmatrix} -1/2 \\\\ -1/2 \\end{Bmatrix}$\n对于 $i=2$：$\\begin{Bmatrix} \\partial N_2/\\partial r \\\\ \\partial N_2/\\partial z \\end{Bmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{Bmatrix} 1/4 \\\\ -1/4 \\end{Bmatrix} = \\begin{Bmatrix} 1/2 \\\\ -1/2 \\end{Bmatrix}$\n对于 $i=3$：$\\begin{Bmatrix} \\partial N_3/\\partial r \\\\ \\partial N_3/\\partial z \\end{Bmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{Bmatrix} 1/4 \\\\ 1/4 \\end{Bmatrix} = \\begin{Bmatrix} 1/2 \\\\ 1/2 \\end{Bmatrix}$\n对于 $i=4$：$\\begin{Bmatrix} \\partial N_4/\\partial r \\\\ \\partial N_4/\\partial z \\end{Bmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{Bmatrix} -1/4 \\\\ 1/4 \\end{Bmatrix} = \\begin{Bmatrix} -1/2 \\\\ 1/2 \\end{Bmatrix}$\n\n现在将结果汇编成指定的单行矩阵格式。\n雅可比矩阵的各项为：$J_{11} = 1/2$, $J_{12} = 0$, $J_{21} = 0$, $J_{22} = 1/2$。\n物理导数为：\n$\\left(\\frac{\\partial N_1}{\\partial r}, \\frac{\\partial N_1}{\\partial z}\\right) = \\left(-\\frac{1}{2}, -\\frac{1}{2}\\right)$\n$\\left(\\frac{\\partial N_2}{\\partial r}, \\frac{\\partial N_2}{\\partial z}\\right) = \\left(\\frac{1}{2}, -\\frac{1}{2}\\right)$\n$\\left(\\frac{\\partial N_3}{\\partial r}, \\frac{\\partial N_3}{\\partial z}\\right) = \\left(\\frac{1}{2}, \\frac{1}{2}\\right)$\n$\\left(\\frac{\\partial N_4}{\\partial r}, \\frac{\\partial N_4}{\\partial z}\\right) = \\left(-\\frac{1}{2}, \\frac{1}{2}\\right)$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & 0 & 0 & \\frac{1}{2} & -\\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}}\n$$", "id": "2542271"}, {"introduction": "在我们掌握了如何在物理坐标系中计算形函数导数后，下一步便是构建有限元公式中的核心——应变-位移矩阵（$\\mathbf{B}$ 矩阵）。该矩阵是连接节点位移和单元内应变的桥梁，是计算单元刚度矩阵的基础。这项练习将引导你为线性三角形单元推导并计算 $\\mathbf{B}$ 矩阵，让你亲身体验从基本运动学关系到有限元矩阵形式的完整过程。[@problem_id:2542358]", "problem": "考虑一个用于有限元法 (FEM) 中模拟绕 $r=0$ 轴旋转的回转体的三节点线性三角形轴对称实体单元。设子午 $(r,z)$ 平面中的节点坐标为 $(r_{i},z_{i})$，其中 $i=1,2,3$。小应变轴对称运动学将径向位移 $u_{r}(r,z)$ 和轴向位移 $u_{z}(r,z)$ 与应变分量 $\\varepsilon_{r}$、$\\varepsilon_{z}$、$\\gamma_{rz}$ 和 $\\varepsilon_{\\theta}$ 联系起来，其中 $\\varepsilon_{\\theta}$ 是周向（环向）应变。该单元使用面积（重心）坐标 $(L_{1},L_{2},L_{3})$ 和线性形函数 $N_{i}(r,z)=L_{i}(r,z)$，因此 $N_{i}$ 相对于 $r$ 和 $z$ 的导数在整个单元上是常数。节点自由度 (DOF) 按以下向量形式排列\n\n$$\n\\mathbf{d}=\\begin{pmatrix}u_{r1} & u_{z1} & u_{r2} & u_{z2} & u_{r3} & u_{z3}\\end{pmatrix}^{\\mathsf{T}}.\n$$\n\n仅使用轴对称小应变的基本运动学关系和线性三角形的面积坐标定义，完成以下任务：\n\n1. 从轴对称情况下 $\\varepsilon_{r}$、$\\varepsilon_{z}$、$\\varepsilon_{\\theta}$ 和 $\\gamma_{rz}$ 的定义出发，推导显式应变-位移矩阵 $\\mathbf{B}(r,z)$，使得\n\n$$\n\\begin{pmatrix}\\varepsilon_{r} & \\varepsilon_{z} & \\varepsilon_{\\theta} & \\gamma_{rz}\\end{pmatrix}^{\\mathsf{T}}=\\mathbf{B}(r,z)\\,\\mathbf{d}.\n$$\n\n将 $\\mathbf{B}(r,z)$ 完全用常数导数 $\\partial N_{i}/\\partial r$、$\\partial N_{i}/\\partial z$ 和形函数 $N_{i}(r,z)$ 本身表示，这些量在单元内的一个通用点 $(r,z)$ 处进行计算。\n\n2. 对于具有以下节点坐标的特定三角形\n\n$$\n(r_{1},z_{1})=(0.06,\\,0.00),\\quad (r_{2},z_{2})=(0.10,\\,0.00),\\quad (r_{3},z_{3})=(0.08,\\,0.05),\n$$\n\n在单元形心处，即在 $L_{1}=L_{2}=L_{3}=1/3$ 的点，计算 $\\mathbf{B}(r,z)$ 的值。使用此形心处的值，提取单个标量项 $\\mathbf{B}_{3,1}$，它是在环向应变方程中乘以 $u_{r1}$ 的系数。提供在形心处 $\\mathbf{B}_{3,1}$ 的数值，四舍五入到四位有效数字。最终答案以 $\\mathrm{m}^{-1}$ 为单位表示。", "solution": "首先对问题进行验证。\n\n逐字提取给定条件：\n- 使用一个三节点线性三角形轴对称实体单元来模拟绕 $r=0$ 轴旋转的回转体。\n- 子午 $(r,z)$ 平面中的节点坐标为 $(r_{i},z_{i})$，其中 $i=1,2,3$。\n- 小应变轴对称运动学将位移 $u_{r}(r,z)$ 和 $u_{z}(r,z)$ 与应变分量 $\\varepsilon_{r}$、$\\varepsilon_{z}$、$\\varepsilon_{\\theta}$ 和 $\\gamma_{rz}$ 联系起来。\n- 单元使用面积（重心）坐标 $(L_{1},L_{2},L_{3})$ 和线性形函数 $N_{i}(r,z)=L_{i}(r,z)$。\n- $N_{i}$ 相对于 $r$ 和 $z$ 的导数是常数。\n- 节点自由度向量为 $\\mathbf{d}=\\begin{pmatrix}u_{r1} & u_{z1} & u_{r2} & u_{z2} & u_{r3} & u_{z3}\\end{pmatrix}^{\\mathsf{T}}$。\n- 待推导的应变-位移关系为 $\\begin{pmatrix}\\varepsilon_{r} & \\varepsilon_{z} & \\varepsilon_{\\theta} & \\gamma_{rz}\\end{pmatrix}^{\\mathsf{T}}=\\mathbf{B}(r,z)\\,\\mathbf{d}$。\n- 具体的节点坐标为 $(r_{1},z_{1})=(0.06,\\,0.00)$、$(r_{2},z_{2})=(0.10,\\,0.00)$ 和 $(r_{3},z_{3})=(0.08,\\,0.05)$。\n- 需要在单元形心处进行计算，该处 $L_{1}=L_{2}=L_{3}=1/3$。\n- 目标是特定项 $\\mathbf{B}_{3,1}$ 在形心处的数值。\n\n验证结论：\n该问题具有科学依据，根植于有限元法和轴对称体连续介质力学的标准理论。这是一个适定的问题，提供了所有必要的定义、常数和明确的目标。语言客观而精确。所提供的数据是一致的，不会导致物理或数学上的矛盾。该问题需要进行标准的、但并非不重要的推导和计算，这是典型工程分析问题的特征。因此，该问题被认为是有效的，并将提供解答。\n\n解答按要求分为两部分进行。\n\n第 $1$ 部分：应变-位移矩阵 $\\mathbf{B}(r,z)$ 的推导。\n轴对称坐标系中小应变的基本运动学关系为：\n$$\n\\varepsilon_{r} = \\frac{\\partial u_{r}}{\\partial r}\n$$\n$$\n\\varepsilon_{z} = \\frac{\\partial u_{z}}{\\partial z}\n$$\n$$\n\\varepsilon_{\\theta} = \\frac{u_{r}}{r}\n$$\n$$\n\\gamma_{rz} = \\frac{\\partial u_{r}}{\\partial z} + \\frac{\\partial u_{z}}{\\partial r}\n$$\n$3$ 节点线性三角形单元内的位移场是使用形函数 $N_{i}(r,z)$ 从节点位移插值得到的。对于线性单元，形函数 $N_{i}$ 与面积坐标 $L_{i}$ 相同。\n单元内任意点 $(r,z)$ 处的位移分量 $u_{r}(r,z)$ 和 $u_{z}(r,z)$ 由下式给出：\n$$\nu_{r}(r,z) = N_{1}(r,z)u_{r1} + N_{2}(r,z)u_{r2} + N_{3}(r,z)u_{r3} = \\sum_{i=1}^{3} N_{i} u_{ri}\n$$\n$$\nu_{z}(r,z) = N_{1}(r,z)u_{z1} + N_{2}(r,z)u_{z2} + N_{3}(r,z)u_{z3} = \\sum_{i=1}^{3} N_{i} u_{zi}\n$$\n通过将这些位移近似表达式代入运动学关系，可以求出应变分量。\n\n对于 $\\varepsilon_{r}$：\n$$\n\\varepsilon_{r} = \\frac{\\partial}{\\partial r} \\left( \\sum_{i=1}^{3} N_{i} u_{ri} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial r} u_{ri} = \\frac{\\partial N_{1}}{\\partial r} u_{r1} + \\frac{\\partial N_{2}}{\\partial r} u_{r2} + \\frac{\\partial N_{3}}{\\partial r} u_{r3}\n$$\n对于 $\\varepsilon_{z}$：\n$$\n\\varepsilon_{z} = \\frac{\\partial}{\\partial z} \\left( \\sum_{i=1}^{3} N_{i} u_{zi} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial z} u_{zi} = \\frac{\\partial N_{1}}{\\partial z} u_{z1} + \\frac{\\partial N_{2}}{\\partial z} u_{z2} + \\frac{\\partial N_{3}}{\\partial z} u_{z3}\n$$\n对于 $\\varepsilon_{\\theta}$：\n$$\n\\varepsilon_{\\theta} = \\frac{1}{r} u_{r} = \\frac{1}{r} \\left( \\sum_{i=1}^{3} N_{i} u_{ri} \\right) = \\frac{N_{1}}{r} u_{r1} + \\frac{N_{2}}{r} u_{r2} + \\frac{N_{3}}{r} u_{r3}\n$$\n对于 $\\gamma_{rz}$：\n$$\n\\gamma_{rz} = \\frac{\\partial}{\\partial z} \\left( \\sum_{i=1}^{3} N_{i} u_{ri} \\right) + \\frac{\\partial}{\\partial r} \\left( \\sum_{i=1}^{3} N_{i} u_{zi} \\right) = \\sum_{i=1}^{3} \\left( \\frac{\\partial N_{i}}{\\partial z} u_{ri} + \\frac{\\partial N_{i}}{\\partial r} u_{zi} \\right)\n$$\n这 $4$ 个应变关系必须表示为矩阵形式 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\mathbf{d}$，其中 $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{r} & \\varepsilon_{z} & \\varepsilon_{\\theta} & \\gamma_{rz} \\end{pmatrix}^{\\mathsf{T}}$ 且 $\\mathbf{d} = \\begin{pmatrix} u_{r1} & u_{z1} & u_{r2} & u_{z2} & u_{r3} & u_{z3} \\end{pmatrix}^{\\mathsf{T}}$。通过收集每个应变分量对应的节点位移的系数，我们构建了 $4\\times6$ 矩阵 $\\mathbf{B}(r,z)$ 的各行。\n\n第 $1$ 行 ($\\varepsilon_{r}$): $\\begin{pmatrix} \\frac{\\partial N_{1}}{\\partial r} & 0 & \\frac{\\partial N_{2}}{\\partial r} & 0 & \\frac{\\partial N_{3}}{\\partial r} & 0 \\end{pmatrix}$\n第 $2$ 行 ($\\varepsilon_{z}$): $\\begin{pmatrix} 0 & \\frac{\\partial N_{1}}{\\partial z} & 0 & \\frac{\\partial N_{2}}{\\partial z} & 0 & \\frac{\\partial N_{3}}{\\partial z} \\end{pmatrix}$\n第 $3$ 行 ($\\varepsilon_{\\theta}$): $\\begin{pmatrix} \\frac{N_{1}}{r} & 0 & \\frac{N_{2}}{r} & 0 & \\frac{N_{3}}{r} & 0 \\end{pmatrix}$\n第 $4$ 行 ($\\gamma_{rz}$): $\\begin{pmatrix} \\frac{\\partial N_{1}}{\\partial z} & \\frac{\\partial N_{1}}{\\partial r} & \\frac{\\partial N_{2}}{\\partial z} & \\frac{\\partial N_{2}}{\\partial r} & \\frac{\\partial N_{3}}{\\partial z} & \\frac{\\partial N_{3}}{\\partial r} \\end{pmatrix}$\n\n将这些行组合起来，得到完整的应变-位移矩阵 $\\mathbf{B}(r,z)$：\n$$\n\\mathbf{B}(r,z) = \\begin{pmatrix}\n\\frac{\\partial N_{1}}{\\partial r} & 0 & \\frac{\\partial N_{2}}{\\partial r} & 0 & \\frac{\\partial N_{3}}{\\partial r} & 0 \\\\\n0 & \\frac{\\partial N_{1}}{\\partial z} & 0 & \\frac{\\partial N_{2}}{\\partial z} & 0 & \\frac{\\partial N_{3}}{\\partial z} \\\\\n\\frac{N_{1}}{r} & 0 & \\frac{N_{2}}{r} & 0 & \\frac{N_{3}}{r} & 0 \\\\\n\\frac{\\partial N_{1}}{\\partial z} & \\frac{\\partial N_{1}}{\\partial r} & \\frac{\\partial N_{2}}{\\partial z} & \\frac{\\partial N_{2}}{\\partial r} & \\frac{\\partial N_{3}}{\\partial z} & \\frac{\\partial N_{3}}{\\partial r}\n\\end{pmatrix}\n$$\n这就完成了问题的第一部分。对于线性三角形单元，导数 $\\frac{\\partial N_{i}}{\\partial r}$ 和 $\\frac{\\partial N_{i}}{\\partial z}$ 在整个单元内是常数，而形函数 $N_{i}$ 本身和项 $1/r$ 则随位置 $(r,z)$ 而变化。\n\n第 $2$ 部分：在单元形心处计算 $\\mathbf{B}_{3,1}$。\n项 $\\mathbf{B}_{3,1}$ 是 $\\mathbf{B}$ 矩阵第 $3$ 行第 $1$ 列的元素。根据推导出的表达式，该项为：\n$$\n\\mathbf{B}_{3,1}(r,z) = \\frac{N_{1}(r,z)}{r}\n$$\n我们必须在特定三角形单元的形心处计算此表达式的值。\n问题陈述，在形心处，面积坐标为 $L_{1}=L_{2}=L_{3}=1/3$。由于对于线性单元有 $N_{i} = L_{i}$，因此第一个形函数在形心处的值为 $N_{1} = 1/3$。\n\n形心的径向坐标 $r$（我们记为 $r_{c}$）是节点径向坐标的平均值，因为插值属性 $r = \\sum N_{i} r_{i}$ 成立。\n$$\nr_{c} = N_{1}r_{1} + N_{2}r_{2} + N_{3}r_{3}\n$$\n代入形心值 $N_{i}=1/3$：\n$$\nr_{c} = \\frac{1}{3}r_{1} + \\frac{1}{3}r_{2} + \\frac{1}{3}r_{3} = \\frac{r_{1} + r_{2} + r_{3}}{3}\n$$\n给定的节点坐标为 $(r_{1},z_{1})=(0.06,\\,0.00)$、$(r_{2},z_{2})=(0.10,\\,0.00)$ 和 $(r_{3},z_{3})=(0.08,\\,0.05)$。\n我们计算 $r_{c}$：\n$$\nr_{c} = \\frac{0.06 + 0.10 + 0.08}{3} = \\frac{0.24}{3} = 0.08 \\, \\text{m}\n$$\n现在我们在形心处通过代入 $N_{1}=1/3$ 和 $r=r_{c}=0.08$ 来计算 $\\mathbf{B}_{3,1}$ 的值：\n$$\n\\mathbf{B}_{3,1}|_{\\text{centroid}} = \\frac{1/3}{r_{c}} = \\frac{1}{3 \\times 0.08} = \\frac{1}{0.24}\n$$\n其数值为：\n$$\n\\frac{1}{0.24} = \\frac{100}{24} = \\frac{25}{6} \\approx 4.1666... \\, \\mathrm{m}^{-1}\n$$\n按要求四舍五入到四位有效数字，该值为 $4.167 \\, \\mathrm{m}^{-1}$。", "answer": "$$\n\\boxed{4.167}\n$$", "id": "2542358"}, {"introduction": "开发有限元公式并编写代码只是工作的一半，我们还必须确保其计算结果的正确性。验证（Verification）是这一过程的关键环节，它通过将数值解与已知的解析解进行比较来评估代码的准确性。这项实践将模拟这一重要过程，要求你将一个厚壁圆筒问题的“有限元”结果与精确的拉梅（Lamé）解进行对比，并学习如何量化数值误差，从而建立对模拟结果的信心。[@problem_id:2542326]", "problem": "考虑一个承受轴对称内外压力的长壁厚、线性弹性、各向同性圆筒。假设采用长圆筒近似，从而状态是轴对称的，轴向位移没有变化，并在轴向方向上使用平面应变条件。目标是通过将径向位移和环向应力分布与Lamé解析解进行比较来验证一组给定的有限元（FE）结果，并计算相对误差范数。\n\n从柱坐标系中无彻体力的轴对称状态的基本平衡出发，径向平衡方程为\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0,\n$$\n轴对称径向位移 $u(r)$ 的运动学关系给出\n$$\n\\varepsilon_r = \\frac{du}{dr}, \\quad \\varepsilon_\\theta = \\frac{u}{r}, \\quad \\varepsilon_z = 0 \\quad \\text{(平面应变)}.\n$$\n使用三维线性弹性本构律，\n$$\n\\boldsymbol{\\sigma} = 2 G \\boldsymbol{\\varepsilon} + \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I},\n$$\n其中 $G = \\frac{E}{2(1+\\nu)}$ 是剪切模量，$\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 是第一Lamé参数，$E$ 是杨氏模量，$\\nu$ 是泊松比。在此模型下，通过求解平衡方程可以得到径向应力和环向应力的通解，其具有Lamé形式，这是公认的结论：\n$$\n\\sigma_r(r) = A - \\frac{B}{r^2}, \\qquad \\sigma_\\theta(r) = A + \\frac{B}{r^2},\n$$\n其中常数 $A$ 和 $B$ 由边界条件确定。对于一个内半径为 $a$、外半径为 $b$ 的圆筒，在 $r=a$ 处承受内压 $p_i$，在 $r=b$ 处承受外压 $p_o$，其边界条件为 $\\sigma_r(a) = -p_i$ 和 $\\sigma_r(b) = -p_o$，由此可得\n$$\nA = \\frac{p_i a^2 - p_o b^2}{b^2 - a^2}, \\qquad B = \\frac{(p_i - p_o) a^2 b^2}{b^2 - a^2}.\n$$\n在平面应变条件下，将本构律与Lamé应力和运动学关系相结合，可得到精确的径向位移为\n$$\nu_{\\text{exact}}(r) = \\frac{1+\\nu}{E}\\left[(1-2\\nu) A \\, r + \\frac{B}{r} \\right],\n$$\n精确的环向应力为\n$$\n\\sigma_{\\theta,\\text{exact}}(r) = A + \\frac{B}{r^2}.\n$$\n\n使用轴对称测度在环形横截面上定义误差的相对加权 $L^2$-范数，这为 $r \\in [a,b]$ 上的积分引入了权重 $r$。对于一个场 $f(r)$，其有限元近似为 $f_{\\text{FE}}(r)$，精确解为 $f_{\\text{exact}}(r)$，定义\n$$\n\\| e \\|_{L^2_r} = \\left( \\int_a^b r \\, \\left( f_{\\text{FE}}(r) - f_{\\text{exact}}(r) \\right)^2 \\, dr \\right)^{1/2}, \\quad\n\\| f_{\\text{exact}} \\|_{L^2_r} = \\left( \\int_a^b r \\, \\left( f_{\\text{exact}}(r) \\right)^2 \\, dr \\right)^{1/2},\n$$\n相对误差定义为\n$$\n\\mathcal{E}_{\\text{rel}} = \n\\begin{cases}\n\\frac{\\| e \\|_{L^2_r}}{\\| f_{\\text{exact}} \\|_{L^2_r}}, & \\text{若 } \\| f_{\\text{exact}} \\|_{L^2_r} > 0, \\\\\n0, & \\text{若 } \\| f_{\\text{exact}} \\|_{L^2_r} = 0 \\text{ 且 } \\| e \\|_{L^2_r} = 0, \\\\\n1, & \\text{若 } \\| f_{\\text{exact}} \\|_{L^2_r} = 0 \\text{ 且 } \\| e \\|_{L^2_r} > 0.\n\\end{cases}\n$$\n在数值实现中，使用梯形法则对从 $a$ 到 $b$ 均匀分布的一组 $N$ 个径向节点 $r_i$, $i = 0,1,\\dots,N-1$ 上的积分进行近似：\n$$\n\\int_a^b r \\, g(r) \\, dr \\approx \\sum_{i=0}^{N-2} \\frac{(r_{i+1} - r_i)}{2} \\left[ r_i \\, g(r_i) + r_{i+1} \\, g(r_{i+1}) \\right].\n$$\n注意，常数因子 $2\\pi$ 和圆筒长度 $L$ 在相对误差中被消掉了，因此它们不影响该比值。\n\n实现一个程序，对于每个测试用例，在 $N$ 个节点 $\\{ r_i \\}$ 上构建精确解和一个人造的有限元数据集，并计算径向位移 $u(r)$（单位：米）和环向应力 $\\sigma_\\theta(r)$（单位：帕斯卡）的相对加权 $L^2$ 误差。人造的有限元数据集被定义为精确解的受控扰动，以模拟真实的有限元误差：\n$$\nu_{\\text{FE}}(r_i) = u_{\\text{exact}}(r_i) \\left[ 1 + \\delta \\, \\sin\\!\\left( \\pi \\, \\frac{r_i - a}{b - a} \\right) \\right],\n$$\n$$\n\\sigma_{\\theta,\\text{FE}}(r_i) = \\sigma_{\\theta,\\text{exact}}(r_i) \\left[ 1 - \\delta \\, \\cos\\!\\left( \\pi \\, \\frac{r_i - a}{b - a} \\right) \\right],\n$$\n每个测试用例都有一个规定的扰动幅度 $\\delta$。\n\n所有物理量必须使用以下单位：长度以米为单位，压力和弹性模量以帕斯卡为单位，位移以米为单位。三角函数中的角度默认为弧度。您的程序必须将相对误差报告为无量纲浮点数，并四舍五入到六位小数。\n\n测试套件：\n- 案例1（中等厚度，仅内压）：$a = 0.05$, $b = 0.15$, $p_i = 50 \\times 10^6$, $p_o = 0$, $E = 210 \\times 10^9$, $\\nu = 0.3$, $\\delta = 0.01$, $N = 17$。\n- 案例2（内外均有压力）：$a = 0.1$, $b = 0.2$, $p_i = 100 \\times 10^6$, $p_o = 20 \\times 10^6$, $E = 70 \\times 10^9$, $\\nu = 0.33$, $\\delta = 0.015$, $N = 17$。\n- 案例3（薄壁极限）：$a = 0.099$, $b = 0.1$, $p_i = 30 \\times 10^6$, $p_o = 0$, $E = 200 \\times 10^9$, $\\nu = 0.25$, $\\delta = 0.005$, $N = 17$。\n- 案例4（静水压力，无净载荷）：$a = 0.08$, $b = 0.12$, $p_i = 10 \\times 10^6$, $p_o = 10 \\times 10^6$, $E = 150 \\times 10^9$, $\\nu = 0.28$, $\\delta = 0$, $N = 17$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例贡献一个包含两个数字的列表，顺序为 $\\left[ \\mathcal{E}^{(u)}_{\\text{rel}}, \\mathcal{E}^{(\\sigma_\\theta)}_{\\text{rel}} \\right]$。因此，对于所有四个案例，最终输出必须是以下形式的单行：\n$$\n\\left[ [e_{u,1}, e_{\\theta,1}], [e_{u,2}, e_{\\theta,2}], [e_{u,3}, e_{\\theta,3}], [e_{u,4}, e_{\\theta,4}] \\right],\n$$\n其中每个 $e$ 都四舍五入到六位小数。", "solution": "所提出的问题是数值方法验证中的一个标准练习，特别是用于将有限元（FE）实现与已知的解析解进行对比验证。其物理背景是承受轴对称压力的厚壁圆筒的线性弹性响应，这是固体力学中一个由Lamé方程解决的经典问题。该问题的所有方面在科学上和数学上都是严谨的，并且提供了所有必需的数据和定义。其步骤是计算解析解，生成一个具有规定误差的人造有限元数据集，然后使用指定的误差范数来量化两者之间的差异。\n\n基本原理是连续介质力学中关于线性弹性、各向同性材料在平面应变条件（$\\varepsilon_z = 0$）下的理论。在柱坐标系中，根据平衡原理推导出的径向控制方程是：\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0\n$$\n此处，$\\sigma_r$ 和 $\\sigma_\\theta$ 分别是径向应力和环向应力。对于纯径向位移场 $u(r)$，其应变-位移关系为：\n$$\n\\varepsilon_r = \\frac{du}{dr}, \\quad \\varepsilon_\\theta = \\frac{u}{r}\n$$\n利用线性弹性本构律求解该系统，可得到著名的Lamé应力分布：\n$$\n\\sigma_r(r) = A - \\frac{B}{r^2}, \\qquad \\sigma_\\theta(r) = A + \\frac{B}{r^2}\n$$\n常数 $A$ 和 $B$ 是通过在内半径 $r=a$ 和外半径 $r=b$ 处应用压力边界条件 $\\sigma_r(a) = -p_i$ 和 $\\sigma_r(b) = -p_o$ 来确定的。这可以导出：\n$$\nA = \\frac{p_i a^2 - p_o b^2}{b^2 - a^2}, \\qquad B = \\frac{(p_i - p_o) a^2 b^2}{b^2 - a^2}\n$$\n精确的环向应力 $\\sigma_{\\theta,\\text{exact}}(r)$ 由此公式直接给出。精确的径向位移 $u_{\\text{exact}}(r)$ 由应变导出，而应变又通过本构律与应力相关联。在平面应变条件下，这种关系得出：\n$$\nu_{\\text{exact}}(r) = \\frac{1+\\nu}{E}\\left[(1-2\\nu) A \\, r + \\frac{B}{r} \\right]\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n\n为了验证一个潜在的有限元解，我们通过向精确解引入一个幅度为 $\\delta$ 的受控扰动，在 $N$ 个离散的径向节点 $r_i$ 上生成一个人造数据集：\n$$\nu_{\\text{FE}}(r_i) = u_{\\text{exact}}(r_i) \\left[ 1 + \\delta \\, \\sin\\!\\left( \\pi \\, \\frac{r_i - a}{b - a} \\right) \\right]\n$$\n$$\n\\sigma_{\\theta,\\text{FE}}(r_i) = \\sigma_{\\theta,\\text{exact}}(r_i) \\left[ 1 - \\delta \\, \\cos\\!\\left( \\pi \\, \\frac{r_i - a}{b - a} \\right) \\right]\n$$\n有限元近似解 $f_{\\text{FE}}$ 和精确解 $f_{\\text{exact}}$ 之间的比较是通过相对加权 $L^2$-范数来量化的，定义为 $\\mathcal{E}_{\\text{rel}} = \\| e \\|_{L^2_r} / \\| f_{\\text{exact}} \\|_{L^2_r}$，其中 $e = f_{\\text{FE}} - f_{\\text{exact}}$。范数的平方 $\\| \\cdot \\|_{L^2_r}^2$ 涉及一个由径向坐标 $r$ 加权的积分：\n$$\n\\| g \\|_{L^2_r}^2 = \\int_a^b r \\, (g(r))^2 \\, dr\n$$\n该积分在 $N$ 个节点集上使用梯形法则进行数值近似：\n$$\n\\int_a^b r \\, (g(r))^2 \\, dr \\approx \\sum_{i=0}^{N-2} \\frac{r_{i+1} - r_i}{2} \\left[ r_i (g(r_i))^2 + r_{i+1} (g(r_{i+1}))^2 \\right]\n$$\n这等同于对函数 $F(r) = r \\cdot (g(r))^2$ 应用标准梯形法则。\n\n每个指定测试用例的计算算法如下：\n1.  根据给定的几何和载荷参数（$a, b, p_i, p_o$）计算Lamé常数 $A$ 和 $B$。\n2.  生成一个从 $a$ 到 $b$ 均匀分布的包含 $N$ 个径向节点的数组。\n3.  在这些节点上计算精确解 $u_{\\text{exact}}$ 和 $\\sigma_{\\theta,\\text{exact}}$ 的值。\n4.  在相同的节点上计算人造有限元数据 $u_{\\text{FE}}$ 和 $\\sigma_{\\theta,\\text{FE}}$ 的值。\n5.  对于位移场和环向应力场，计算误差场 $e(r_i)$ 和精确场 $f_{\\text{exact}}(r_i)$。\n6.  使用数值积分法则计算误差场范数的平方 $\\| e \\|_{L^2_r}^2$ 和精确场范数的平方 $\\| f_{\\text{exact}} \\|_{L^2_r}^2$。\n7.  通过计算这些范数之比的平方根来确定相对误差 $\\mathcal{E}_{\\text{rel}}$，并按照规定仔细处理精确解范数为零的情况。\n8.  对于每个测试用例，收集计算出的位移和环向应力的相对误差，并按要求格式化。对于测试用例4，$\\delta=0$，这意味着人造数据与精确解完全相同，因此预期相对误差为0。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n\n    def calculate_errors_for_case(params):\n        \"\"\"\n        Calculates the relative weighted L2 error for displacement and hoop stress\n        for a single test case.\n        \n        Args:\n            params (tuple): A tuple containing the parameters for the case:\n                            (a, b, p_i, p_o, E, nu, delta, N).\n        \n        Returns:\n            list: A list containing two floats [rel_error_u, rel_error_sigma].\n        \"\"\"\n        a, b, p_i, p_o, E, nu, delta, N = params\n\n        # 1. Calculate Lamé constants\n        a2 = a**2\n        b2 = b**2\n        if abs(b2 - a2)  1e-15: # Avoid division by zero for thin-walled degenerate case\n            return [0.0, 0.0]\n        \n        A = (p_i * a2 - p_o * b2) / (b2 - a2)\n        B = (p_i - p_o) * a2 * b2 / (b2 - a2)\n\n        # 2. Generate N uniformly spaced radial nodes\n        r_nodes = np.linspace(a, b, N)\n\n        # 3. Evaluate exact solutions at nodes\n        # The problem guarantees r_nodes > 0 since a > 0.\n        u_exact = ((1 + nu) / E) * ((1 - 2 * nu) * A * r_nodes + B / r_nodes)\n        sigma_theta_exact = A + B / r_nodes**2\n\n        # 4. Generate synthetic FE data at nodes\n        r_normalized = (r_nodes - a) / (b - a) if (b - a) != 0 else np.zeros_like(r_nodes)\n        u_fe = u_exact * (1 + delta * np.sin(np.pi * r_normalized))\n        sigma_theta_fe = sigma_theta_exact * (1 - delta * np.cos(np.pi * r_normalized))\n        \n        def get_relative_error(f_fe, f_exact, r_nodes):\n            \"\"\"\n            Computes the relative weighted L2 error for a generic field f.\n            \"\"\"\n            error_field = f_fe - f_exact\n            \n            # Form the integrands for the weighted L2 norm calculation.\n            # The function to integrate is r * (g(r))^2.\n            integrand_for_error_norm_sq = r_nodes * (error_field**2)\n            integrand_for_exact_norm_sq = r_nodes * (f_exact**2)\n            \n            # 6. Use numpy.trapz to perform numerical integration: integral of y(x)dx\n            norm_e_sq = np.trapz(integrand_for_error_norm_sq, r_nodes)\n            norm_f_exact_sq = np.trapz(integrand_for_exact_norm_sq, r_nodes)\n\n            norm_e = np.sqrt(norm_e_sq)\n            norm_f_exact = np.sqrt(norm_f_exact_sq)\n            \n            # 7. Apply the specified definition for relative error\n            if norm_f_exact > 1e-15:  # Use a small tolerance for floating point comparison\n                rel_error = norm_e / norm_f_exact\n            elif norm_e  1e-15:  # Both norms are zero\n                rel_error = 0.0\n            else:  # Zero exact solution norm, but non-zero error\n                rel_error = 1.0\n                \n            return rel_error\n\n        # Calculate relative errors for both fields\n        rel_error_u = get_relative_error(u_fe, u_exact, r_nodes)\n        rel_error_sigma = get_relative_error(sigma_theta_fe, sigma_theta_exact, r_nodes)\n        \n        return [rel_error_u, rel_error_sigma]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, b, p_i, p_o, E, nu, delta, N)\n        (0.05, 0.15, 50e6, 0, 210e9, 0.3, 0.01, 17),\n        (0.1, 0.2, 100e6, 20e6, 70e9, 0.33, 0.015, 17),\n        (0.099, 0.1, 30e6, 0, 200e9, 0.25, 0.005, 17),\n        (0.08, 0.12, 10e6, 10e6, 150e9, 0.28, 0.0, 17),\n    ]\n\n    results = []\n    for case in test_cases:\n        errors = calculate_errors_for_case(case)\n        results.append(errors)\n\n    # Format the final output string to match the required format.\n    # e.g., [[0.005697,0.008101],[...]] with no spaces.\n    list_of_strs = []\n    for pair in results:\n        list_of_strs.append(f'[{pair[0]:.6f},{pair[1]:.6f}]')\n    \n    final_output_string = f\"[{','.join(list_of_strs)}]\"\n\n    print(final_output_string)\n\nsolve()\n```", "id": "2542326"}]}