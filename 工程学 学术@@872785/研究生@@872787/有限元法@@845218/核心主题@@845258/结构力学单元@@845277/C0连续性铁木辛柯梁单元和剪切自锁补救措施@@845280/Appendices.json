{"hands_on_practices": [{"introduction": "在讨论“减缩积分”作为剪切锁死的补救措施之前，我们必须首先明确“完全”或精确积分的含义。第一个练习旨在建立这一基准。通过推导不同阶次的单元，其刚度矩阵的弯曲和剪切部分进行精确积分所需的 Gauss 点数，你将为理解为何选择特定的积分方案，以及什么是“减缩”积分奠定坚实的形式化基础。[@problem_id:2543380]", "problem": "一个长度为 $L$、具有恒定属性 $E$、$I$、$G$、$A$ 和剪切修正因子 $\\kappa$ 的直棱柱 Timoshenko 梁单元，采用有限元法（FEM）进行建模。横向位移 $w(x)$ 和横截面转角 $\\phi(x)$ 在每个单元上通过多项式次数为 $p \\in \\{1,2,3\\}$ 的 $C^{0}$ 连续、同阶 Lagrange 形函数进行近似。几何映射是线性的，因此雅可比矩阵在单元上是常数。在 Timoshenko 运动学假设下，弯曲应变度量为 $\\kappa_{b}(x)=\\phi'(x)$，剪切应变度量为 $\\gamma(x)=w'(x)-\\phi(x)$。单元的弯曲和剪切刚度贡献定义如下：\n$$\nK_{b}=\\int_{x_{e}} B_{b}(x)^{\\mathsf{T}}\\,E I\\,B_{b}(x)\\,\\mathrm{d}x,\\qquad\nK_{s}=\\int_{x_{e}} B_{s}(x)^{\\mathsf{T}}\\,\\kappa G A\\,B_{s}(x)\\,\\mathrm{d}x,\n$$\n其中 $B_{b}(x)$ 和 $B_{s}(x)$ 分别是与 $\\kappa_{b}$ 和 $\\gamma$ 相关联的标准应变-位移算子。\n\n从上述运动学定义和插值假设出发，对每个 $p \\in \\{1,2,3\\}$，确定精确积分 $K_{b}$ 和 $K_{s}$ 所需的 Gauss-Legendre 点的最小数量 $n_{b}$ 和 $n_{s}$。你的推导应基于 $B_{b}(x)$ 和 $B_{s}(x)$ 条目的多项式次数以及 Gauss-Legendre 求积的精确性。假设所有系数 $E$、$I$、$G$、$A$、$\\kappa$ 以及雅可比矩阵在单元上均为常数，因此它们不影响被积函数的多项式次数。\n\n将你的最终答案表示为单行矩阵 $[\\,n_{b}(1)\\;n_{s}(1)\\;n_{b}(2)\\;n_{s}(2)\\;n_{b}(3)\\;n_{s}(3)\\,]$，其中 $n_{b}(p)$ 和 $n_{s}(p)$ 表示在多项式次数为 $p$ 时，精确积分 $K_{b}$ 和 $K_{s}$ 的最小 Gauss 阶数。无需四舍五入，不涉及单位。在你的推导中，请将你的确定过程与 $B_{b}$ 和 $B_{s}$ 的多项式次数联系起来。", "solution": "如题所述，该问题是适定的且在科学上是合理的，允许一个严谨且明确的解。我们的任务是确定，对于采用次数为 $p \\in \\{1,2,3\\}$ 的同阶 Lagrange 多项式插值的 Timoshenko 梁单元，精确数值积分单元弯曲刚度矩阵 $K_{b}$ 和剪切刚度矩阵 $K_{s}$ 所需的 Gauss-Legendre 求积点的最小数量，分别记为 $n_{b}$ 和 $n_{s}$。\n\n控制这个问题的基本原理是 Gauss-Legendre 求积的精确性：一个 $n$ 点法则能精确积分最高为 $2n - 1$ 次的多项式。因此，为了找到所需的最小点数 $n$，我们必须首先确定被积函数的多项式次数 $d_{\\text{poly}}$。最小的 $n$ 则是满足 $2n - 1 \\ge d_{\\text{poly}}$ 的最小整数，这导出了公式 $n = \\lceil \\frac{d_{\\text{poly}} + 1}{2} \\rceil$。\n\n问题陈述，横向位移 $w(x)$ 和横截面转角 $\\phi(x)$ 使用次数为 $p$ 的 Lagrange 形函数 $N_i(x)$ 进行插值。因此，场变量表示为：\n$$\nw(x) = \\sum_{i=1}^{p+1} N_{i}(x) w_{i} \\quad \\text{和} \\quad \\phi(x) = \\sum_{i=1}^{p+1} N_{i}(x) \\phi_{i}\n$$\n其中 $w_{i}$ 和 $\\phi_{i}$ 是节点自由度，一个 $p$ 阶 Lagrange 单元有 $p+1$ 个节点。设 $\\mathbf{N}(x)$ 为形函数的行向量 $[N_1(x), N_2(x), \\dots, N_{p+1}(x)]$。\n\n应变度量由 $\\kappa_{b}(x) = \\phi'(x)$ 和 $\\gamma(x) = w'(x) - \\phi(x)$ 给出。应变-位移矩阵 $B_b(x)$ 和 $B_s(x)$ 将这些应变与单元的节点自由度联系起来。\n\n首先，我们分析弯曲贡献。弯曲应变为 $\\kappa_{b}(x) = \\phi'(x) = \\mathbf{N}'(x) \\boldsymbol{\\phi}$，其中 $\\mathbf{N}'(x)$ 是形函数向量的导数，$\\boldsymbol{\\phi}$ 是节点转角向量。由于每个 $N_i(x)$ 是一个 $p$ 次多项式，其导数 $N_i'(x)$ 是一个 $p-1$ 次多项式。因此，弯曲应变-位移矩阵 $B_b(x)$ 的条目是 $p-1$ 次多项式。\n弯曲刚度矩阵 $K_b$ 的被积函数是 $B_{b}(x)^{\\mathsf{T}}\\,E I\\,B_{b}(x)$。由于 $E$ 和 $I$ 是常数，被积函数的多项式次数由乘积 $B_{b}(x)^{\\mathsf{T}}B_{b}(x)$ 决定。该矩阵乘积的条目是 $p-1$ 次多项式乘积的和。因此，被积函数的次数为 $d_{\\text{poly},b} = (p-1) + (p-1) = 2p - 2$。\n弯曲所需的最小 Gauss 点数为：\n$$\nn_{b}(p) = \\left\\lceil \\frac{d_{\\text{poly},b} + 1}{2} \\right\\rceil = \\left\\lceil \\frac{(2p - 2) + 1}{2} \\right\\rceil = \\left\\lceil \\frac{2p - 1}{2} \\right\\rceil = \\left\\lceil p - \\frac{1}{2} \\right\\rceil = p\n$$\n\n接下来，我们分析剪切贡献。剪切应变为 $\\gamma(x) = w'(x) - \\phi(x) = \\mathbf{N}'(x) \\mathbf{w} - \\mathbf{N}(x) \\boldsymbol{\\phi}$。剪切应变-位移矩阵 $B_s(x)$ 由 $\\mathbf{N}'(x)$ 的分量（$p-1$ 次多项式）和 $-\\mathbf{N}(x)$ 的分量（$p$ 次多项式）构成。\n剪切刚度矩阵 $K_s$ 的被积函数是 $B_{s}(x)^{\\mathsf{T}}\\,\\kappa G A\\,B_{s}(x)$。由于 $\\kappa$、$G$ 和 $A$ 是常数，被积函数的次数由乘积 $B_{s}(x)^{\\mathsf{T}}B_{s}(x)$ 中条目的最高次数决定。该乘积将包含 $(\\mathbf{N}')^{\\mathsf{T}}\\mathbf{N}'$、$\\mathbf{N}^{\\mathsf{T}}\\mathbf{N}$ 形式的项以及混合项。最高的多项式次数来自 $\\mathbf{N}^{\\mathsf{T}}\\mathbf{N}$ 块，其条目的次数为 $p+p=2p$。因此，剪切的被积函数次数为 $d_{\\text{poly},s} = 2p$。\n剪切所需的最小 Gauss 点数为：\n$$\nn_{s}(p) = \\left\\lceil \\frac{d_{\\text{poly},s} + 1}{2} \\right\\rceil = \\left\\lceil \\frac{2p + 1}{2} \\right\\rceil = \\left\\lceil p + \\frac{1}{2} \\right\\rceil = p+1\n$$\n\n现在，我们将这些通用公式应用于指定的多项式次数 $p \\in \\{1, 2, 3\\}$。\n\n情况 $p=1$ (线性单元)：\n- 弯曲：$d_{\\text{poly},b} = 2(1) - 2 = 0$。$n_{b}(1) = \\lceil \\frac{0+1}{2} \\rceil = 1$。\n- 剪切：$d_{\\text{poly},s} = 2(1) = 2$。$n_{s}(1) = \\lceil \\frac{2+1}{2} \\rceil = 2$。\n\n情况 $p=2$ (二次单元)：\n- 弯曲：$d_{\\text{poly},b} = 2(2) - 2 = 2$。$n_{b}(2) = \\lceil \\frac{2+1}{2} \\rceil = 2$。\n- 剪切：$d_{\\text{poly},s} = 2(2) = 4$。$n_{s}(2) = \\lceil \\frac{4+1}{2} \\rceil = 3$。\n\n情况 $p=3$ (三次单元)：\n- 弯曲：$d_{\\text{poly},b} = 2(3) - 2 = 4$。$n_{b}(3) = \\lceil \\frac{4+1}{2} \\rceil = 3$。\n- 剪切：$d_{\\text{poly},s} = 2(3) = 6$。$n_{s}(3) = \\lceil \\frac{6+1}{2} \\rceil = 4$。\n\n这些结果表示精确形成刚度矩阵所需的积分阶数，没有进行任何故意的减缩积分（减缩积分可用于纠正剪切自锁）。本问题严格关注精确积分。\n\n最终答案将这些结果汇总为指定的矩阵格式。\n当 $p=1$ 时：$n_{b}(1)=1$，$n_{s}(1)=2$。\n当 $p=2$ 时：$n_{b}(2)=2$，$n_{s}(2)=3$。\n当 $p=3$ 时：$n_{b}(3)=3$，$n_{s}(3)=4$。\n得到的行矩阵是 $[\\,1 \\quad 2 \\quad 2 \\quad 3 \\quad 3 \\quad 4\\,]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2  2  3  3  4\n\\end{pmatrix}\n}\n$$", "id": "2543380"}, {"introduction": "斑块检验（Patch Test）是有限元方法中一种强大的诊断工具，用于验证单元是否能准确再现基本的变形状态。在这里，我们将对线性 Timoshenko 梁单元施加一个纯弯曲状态的斑块检验。这个练习将从解析上揭示剪切锁死的根源——即“寄生”剪切应变——并清晰地展示为何完全积分的单元无法通过检验，而减缩积分单元却能成功。[@problem_id:2543362]", "problem": "考虑一根长度为$L$、抗弯刚度为$EI$、抗剪刚度为$k_{s} G A$的均质等截面Timoshenko梁，该梁被一个具有节点自由度$\\{w_{1}, \\theta_{1}, w_{2}, \\theta_{2}\\}$的$C^{0}$两节点Timoshenko梁有限元离散化。该单元采用线性形函数 $N_{1}(x)=1-x/L$ 和 $N_{2}(x)=x/L$，因此有 $w_{h}(x)=N_{1}(x) w_{1}+N_{2}(x) w_{2}$ 和 $\\theta_{h}(x)=N_{1}(x) \\theta_{1}+N_{2}(x) \\theta_{2}$。Timoshenko梁的运动学关系由横向剪应变 $\\gamma(x)=w^{\\prime}(x)-\\theta(x)$ 和弯曲曲率 $\\kappa_{b}(x)=\\theta^{\\prime}(x)$ 给出。Timoshenko梁的应变能为\n$$\n\\Pi=\\frac{1}{2}\\int_{0}^{L}\\left(E I\\,\\kappa_{b}(x)^{2}+k_{s} G A\\,\\gamma(x)^{2}\\right)\\,\\mathrm{d}x.\n$$\n通过给定精确场，建立对应于恒定弯曲曲率和零剪切的单单元分片检验\n$$\n\\theta^{\\star}(x)=\\theta_{0}-\\kappa_{0}\\,x,\\qquad \\gamma^{\\star}(x)=0,\\qquad w^{\\star}(x)=w_{0}+\\theta_{0}\\,x-\\frac{1}{2}\\kappa_{0}\\,x^{2},\n$$\n其中$\\kappa_{0}\\neq 0$、$\\theta_{0}$和$w_{0}$为给定常数。将该单元的节点值设为精确场在$x=0$和$x=L$处的值，从而对该单元应用此分片检验，即\n$$\nw_{1}=w^{\\star}(0),\\quad \\theta_{1}=\\theta^{\\star}(0),\\quad w_{2}=w^{\\star}(L),\\quad \\theta_{2}=\\theta^{\\star}(L).\n$$\n定义单元“通过”分片检验的条件为：在无外部载荷的情况下，对于施加的节点值，单元计算出的应变能的剪切贡献精确为零。使用(i) $[-1,1]$（映射到$[0,L]$）上的2点Gauss求积和(ii) $[-1,1]$（映射到$[0,L]$）上的1点Gauss求积，计算此单元贡献的剪切应变能。然后定义通过指示符\n$$\nP_{\\mathrm{full}}=\\begin{cases}1,  \\text{若 } U_{s}^{\\mathrm{full}}=0, \\\\ 0,  \\text{若 } U_{s}^{\\mathrm{full}}\\neq 0\\end{cases}\\qquad\nP_{\\mathrm{red}}=\\begin{cases}1,  \\text{若 } U_{s}^{\\mathrm{red}}=0, \\\\ 0,  \\text{若 } U_{s}^{\\mathrm{red}}\\neq 0\\end{cases}\n$$\n其中$U_{s}$表示单元能量的剪切部分，即$U_{s}=\\frac{1}{2}\\int_{0}^{L}k_{s} G A\\,\\gamma_{h}(x)^{2}\\,\\mathrm{d}x$，使用相应的求积法则计算。将最终答案表示为行矩阵 $\\big(P_{\\mathrm{full}}\\;\\;P_{\\mathrm{red}}\\big)$。无需四舍五入，指示符不带单位。", "solution": "该问题要求对一个$C^0$两节点Timoshenko梁有限元执行分片检验。该检验对应于恒定弯曲曲率和零剪切应变的状态。检验的结果取决于在使用两种不同的数值积分方案——2点（完全）和1点（减缩）Gauss求积——计算时，所得到的剪切应变能是零还是非零。\n\n首先，我们通过计算给定精确场在单元节点 $x=0$ 和 $x=L$ 处的值来确定节点自由度 $\\{w_1, \\theta_1, w_2, \\theta_2\\}$。\n\n精确场由下式给出：\n$$\nw^{\\star}(x) = w_0 + \\theta_0 x - \\frac{1}{2} \\kappa_0 x^2\n$$\n$$\n\\theta^{\\star}(x) = \\theta_0 - \\kappa_0 x\n$$\n\n在第一个节点（$x=0$）：\n$$\nw_1 = w^{\\star}(0) = w_0 + \\theta_0(0) - \\frac{1}{2}\\kappa_0(0)^2 = w_0\n$$\n$$\n\\theta_1 = \\theta^{\\star}(0) = \\theta_0 - \\kappa_0(0) = \\theta_0\n$$\n\n在第二个节点（$x=L$）：\n$$\nw_2 = w^{\\star}(L) = w_0 + \\theta_0 L - \\frac{1}{2}\\kappa_0 L^2\n$$\n$$\n\\theta_2 = \\theta^{\\star}(L) = \\theta_0 - \\kappa_0 L\n$$\n\n接下来，我们使用线性形函数 $N_1(x) = 1 - x/L$ 和 $N_2(x) = x/L$ 以及计算出的节点值，构建插值场 $w_h(x)$ 和 $\\theta_h(x)$。\n\n插值的横向位移是：\n$$\nw_h(x) = N_1(x)w_1 + N_2(x)w_2 = \\left(1 - \\frac{x}{L}\\right)w_0 + \\frac{x}{L}\\left(w_0 + \\theta_0 L - \\frac{1}{2}\\kappa_0 L^2\\right)\n$$\n$$\nw_h(x) = w_0 - \\frac{x}{L}w_0 + \\frac{x}{L}w_0 + \\theta_0 x - \\frac{1}{2}\\kappa_0 L x = w_0 + \\theta_0 x - \\frac{1}{2}\\kappa_0 L x\n$$\n\n插值的转角是：\n$$\n\\theta_h(x) = N_1(x)\\theta_1 + N_2(x)\\theta_2 = \\left(1 - \\frac{x}{L}\\right)\\theta_0 + \\frac{x}{L}\\left(\\theta_0 - \\kappa_0 L\\right)\n$$\n$$\n\\theta_h(x) = \\theta_0 - \\frac{x}{L}\\theta_0 + \\frac{x}{L}\\theta_0 - \\kappa_0 x = \\theta_0 - \\kappa_0 x\n$$\n注意到，线性插值恢复了精确的转角场，$\\theta_h(x) = \\theta^{\\star}(x)$，但未能恢复二次的精确位移场 $w^{\\star}(x)$。\n\n剪切应变的有限元近似为 $\\gamma_h(x) = w_h'(x) - \\theta_h(x)$。我们首先计算插值位移的导数：\n$$\nw_h'(x) = \\frac{d}{dx}\\left(w_0 + \\theta_0 x - \\frac{1}{2}\\kappa_0 L x\\right) = \\theta_0 - \\frac{1}{2}\\kappa_0 L\n$$\n现在，我们求出剪切应变：\n$$\n\\gamma_h(x) = \\left(\\theta_0 - \\frac{1}{2}\\kappa_0 L\\right) - \\left(\\theta_0 - \\kappa_0 x\\right) = \\kappa_0 \\left(x - \\frac{L}{2}\\right)\n$$\n这个非零应变 $\\gamma_h(x)$ 被称为寄生剪切，因为它出现在有限元近似中，即使精确场具有零剪切应变 $\\gamma^{\\star}(x)=0$。\n\n单元的剪切应变能由 $U_s = \\frac{1}{2}\\int_{0}^{L}k_s G A\\,\\gamma_h(x)^2\\,\\mathrm{d}x$ 给出。代入 $\\gamma_h(x)$ 的表达式：\n$$\nU_s = \\frac{1}{2} k_s G A \\int_{0}^{L} \\left[\\kappa_0 \\left(x - \\frac{L}{2}\\right)\\right]^2 \\mathrm{d}x = \\frac{1}{2} k_s G A \\kappa_0^2 \\int_{0}^{L} \\left(x - \\frac{L}{2}\\right)^2 \\mathrm{d}x\n$$\n为了进行Gauss求积，我们使用变换 $x(\\xi) = \\frac{L}{2}(1+\\xi)$ 将积分域从 $x \\in [0, L]$ 映射到自然坐标 $\\xi \\in [-1, 1]$。该变换的雅可比行列式是 $J = \\frac{dx}{d\\xi} = \\frac{L}{2}$。$(x - L/2)$ 项变为：\n$$\nx - \\frac{L}{2} = \\frac{L}{2}(1+\\xi) - \\frac{L}{2} = \\frac{L}{2}\\xi\n$$\n剪切能的积分变换为：\n$$\nU_s = \\frac{1}{2} k_s G A \\kappa_0^2 \\int_{-1}^{1} \\left(\\frac{L}{2}\\xi\\right)^2 \\left(\\frac{L}{2}\\right) \\mathrm{d}\\xi = \\frac{k_s G A \\kappa_0^2 L^3}{16} \\int_{-1}^{1} \\xi^2 \\mathrm{d}\\xi\n$$\n\n我们现在使用两种指定的求积法则计算这个积分。\n\n(i) 使用2点Gauss求积进行完全积分：\n求积点为 $\\xi_{1,2} = \\mp 1/\\sqrt{3}$，权重为 $w_{1,2} = 1$。\n积分近似为：\n$$\n\\int_{-1}^{1} \\xi^2 \\mathrm{d}\\xi \\approx \\sum_{i=1}^2 w_i \\xi_i^2 = (1)\\left(-\\frac{1}{\\sqrt{3}}\\right)^2 + (1)\\left(\\frac{1}{\\sqrt{3}}\\right)^2 = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}\n$$\n这个结果是精确的，因为2点Gauss求积对最高为 $2(2)-1=3$ 次的多项式是精确的。\n剪切能是：\n$$\nU_s^{\\mathrm{full}} = \\frac{k_s G A \\kappa_0^2 L^3}{16} \\left(\\frac{2}{3}\\right) = \\frac{k_s G A \\kappa_0^2 L^3}{24}\n$$\n由于 $\\kappa_0 \\neq 0$ 且材料和几何属性为正，所以 $U_s^{\\mathrm{full}} \\neq 0$。在完全积分下，单元未能通过分片检验。因此，通过指示符为 $P_{\\mathrm{full}}=0$。\n\n(ii) 使用1点Gauss求积进行减缩积分：\n求积点为 $\\xi_1 = 0$，权重为 $w_1 = 2$。\n积分近似为：\n$$\n\\int_{-1}^{1} \\xi^2 \\mathrm{d}\\xi \\approx \\sum_{i=1}^1 w_i \\xi_i^2 = (2)(0)^2 = 0\n$$\n剪切能是：\n$$\nU_s^{\\mathrm{red}} = \\frac{k_s G A \\kappa_0^2 L^3}{16} (0) = 0\n$$\n由于 $U_s^{\\mathrm{red}} = 0$，在减缩积分下，单元通过了分片检验。这是因为单个积分点 $\\xi=0$（对应于$x=L/2$）正是寄生剪切应变 $\\gamma_h(x)$ 为零的地方。因此，通过指示符为 $P_{\\mathrm{red}}=1$。\n\n最终答案是表示通过指示符的行矩阵 $(P_{\\mathrm{full}}\\;\\;P_{\\mathrm{red}})$。\n$$\n\\big(P_{\\mathrm{full}}\\;\\;P_{\\mathrm{red}}\\big) = \\big(0\\;\\;1\\big)\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1\n\\end{pmatrix}\n}\n$$", "id": "2543362"}, {"introduction": "理论和解析测试至关重要，但最终的检验来自于实际应用。最后一个练习将通过编程，实现一个经典的悬臂梁问题求解，分别使用标准的完全积分单元和采用减缩积分的无锁死单元。通过将数值结果与不同长细比梁的精确解进行对比，你将亲眼见证剪切锁死的显著影响以及补救措施的成功。[@problem_id:2543367]", "problem": "一根均质矩形截面的悬臂梁采用铁木辛柯梁理论进行建模。梁的轴向坐标为 $x \\in [0,L]$，横向位移场为 $w(x)$，横截面转动场为 $\\theta(x)$。本构关系为 $M(x) = E I \\, \\theta'(x)$ 和 $Q(x) = \\kappa G A \\, \\big(w'(x) - \\theta(x)\\big)$，其中 $M$ 是弯矩，$Q$ 是剪力，$E$ 是杨氏模量，$G$ 是剪切模量，$I$ 是截面二次矩，$A$ 是横截面积，$\\kappa$ 是剪切修正因子。梁在 $x=0$ 处被夹紧，满足 $w(0) = 0$ 和 $\\theta(0) = 0$；在 $x=L$ 处承受大小为 $P$ 的集中端部载荷（横向剪力），且无施加的端部弯矩。使用铁木辛柯梁的弱形式，推导一个每个节点具有节点自由度 $\\{w_i,\\theta_i\\}$ 的 $C^0$ 两节点有限元，其中 $w$ 和 $\\theta$ 均采用线性插值，并计算在包含 $N_e$ 个单元的均匀网格上的全局响应。\n\n必须实现两种单元变体：\n- 标准单元：剪切能项和弯曲能项在每个单元上均采用完全高斯积分。\n- 无闭锁单元：采用选择性减缩积分，剪切能项在每个单元上使用单个高斯点积分，而弯曲能项仍采用完全积分。\n\n从第一性原理出发，始于虚功原理，展示单元刚度贡献如何从弯曲能项和剪切能项中产生，并特别注意形函数、其导数以及从父单元到物理坐标的映射。然后，对于上述指定的承受端部载荷的悬臂梁，推导其端部转角和端部挠度的精确铁木辛柯解，用 $(E,G,A,I,\\kappa,L,P)$ 表示。\n\n你的程序必须：\n- 使用上述两种单元变体分别为悬臂梁组装全局刚度矩阵。\n- 在 $x=0$ 处对 $w$ 和 $\\theta$ 施加夹紧边界条件。\n- 将节点端部载荷 $P$ 施加到 $x=L$ 处最后一个节点的横向位移自由度上。\n- 求解得到的线性系统，以获得以米为单位的端部挠度 $w(L)$ 和以弧度为单位的端部转角 $\\theta(L)$。\n- 计算精确的铁木辛柯端部挠度和转角的闭式解，并评估两种有限元预测相对于精确解的绝对相对误差。\n\n所有物理量必须使用国际单位制（SI）表示。挠度以米报告，转角以弧度报告。\n\n测试套件：\n- 使用 $E = 210 \\times 10^{9}$ Pa，泊松比 $\\nu = 0.3$ 因此 $G = \\dfrac{E}{2(1+\\nu)}$，剪切因子 $\\kappa = \\dfrac{5}{6}$，梁宽 $b = 1$ m，梁长 $L = 1$ m，包含 $N_e = 4$ 个单元的均匀网格，以及端部载荷 $P = 1$ N。对于厚度为 $t$ 的矩形截面，使用 $A = b t$ 和 $I = \\dfrac{b t^{3}}{12}$。\n- 评估四种长细比 $L/t \\in \\{5, 10, 50, 100\\}$ 的情况。对于每种情况，确定 $t = L/(L/t)$，然后相应地计算 $A$ 和 $I$。\n- 对于每种情况，计算四个浮点数：使用标准单元的端部挠度绝对相对误差，使用标准单元的端部转角绝对相对误差，使用无闭锁单元的端部挠度绝对相对误差，以及使用无闭锁单元的端部转角绝对相对误差。\n\n角度单位要求：所有角度必须以弧度为单位。物理单位要求：所有挠度必须以米为单位。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由逗号分隔的四元素列表组成的列表，每个测试用例一个列表，并用方括号括起来。每个内部列表必须按 $[L/t, \\varepsilon_{w}^{\\mathrm{std}}, \\varepsilon_{\\theta}^{\\mathrm{std}}, \\varepsilon_{w}^{\\mathrm{lf}}, \\varepsilon_{\\theta}^{\\mathrm{lf}}]$ 的顺序排列，其中每个 $\\varepsilon$ 是一个以小数表示的绝对相对误差（而非百分比）。例如：$[[5,0.001,0.002,0.0001,0.0002],[10, \\dots ],\\dots]$。", "solution": "该问题要求使用铁木辛柯梁理论对悬臂梁进行有限元分析。我们必须构建两种类型的 $C^0$ 两节点单元：一种是表现出剪切闭锁的标准全积分单元，另一种是采用选择性减缩积分的无闭锁单元。分析结果将与承受端部载荷的悬臂梁的精确解析解进行比较。\n\n我们从基本原理开始。铁木辛柯梁的应变能 $U$ 由弯曲和剪切两部分组成：\n$$ U = \\frac{1}{2} \\int_{0}^{L} \\left( E I \\left(\\frac{d\\theta}{dx}\\right)^2 + \\kappa G A \\left(\\frac{dw}{dx} - \\theta\\right)^2 \\right) dx $$\n此处，$w(x)$ 是横向位移，$\\theta(x)$ 是横截面的转角，$E$ 是杨氏模量，$G$ 是剪切模量，$I$ 是截面二次矩，$A$ 是横截面积，$\\kappa$ 是剪切修正因子，$L$ 是梁的长度。\n\n虚功原理指出，对于处于平衡状态的系统，内力的虚功等于外力的虚功。对于本问题，在 $x=L$ 处施加了端部载荷 $P$，其弱形式由 $\\delta U = \\delta W_{\\text{ext}}$ 给出，即：\n$$ \\int_{0}^{L} E I \\frac{d\\theta}{dx} \\frac{d(\\delta\\theta)}{dx} dx + \\int_{0}^{L} \\kappa G A \\left(\\frac{dw}{dx} - \\theta\\right) \\left(\\frac{d(\\delta w)}{dx} - \\delta\\theta\\right) dx = P \\delta w(L) $$\n该方程对所有运动学上容许的虚位移 $\\delta w$ 和虚转角 $\\delta\\theta$ 均成立。第一个积分代表弯曲能的贡献，第二个积分代表剪切能的贡献。\n\n现在我们将域离散化为 $N_e$ 个有限元。对于长度为 $h_e$ 的单个两节点单元，我们引入局部坐标 $\\xi \\in [-1, 1]$。物理坐标 $x$ 通过 $x(\\xi) = x_c + \\frac{h_e}{2}\\xi$ 进行映射，其中 $x_c$ 是单元的中心。此变换的雅可比行列式为 $J = \\frac{dx}{d\\xi} = \\frac{h_e}{2}$。\n\n单元内的位移场 $w(x)$ 和转动场 $\\theta(x)$ 使用线性的拉格朗日形函数 $N_1$ 和 $N_2$ 从节点自由度 $\\mathbf{d}^e = \\{w_1, \\theta_1, w_2, \\theta_2\\}^T$ 插值得到：\n$$ N_1(\\xi) = \\frac{1}{2}(1-\\xi), \\quad N_2(\\xi) = \\frac{1}{2}(1+\\xi) $$\n$$ w(\\xi) = N_1(\\xi)w_1 + N_2(\\xi)w_2 $$\n$$ \\theta(\\xi) = N_1(\\xi)\\theta_1 + N_2(\\xi)\\theta_2 $$\n\n对 $x$ 的导数为 $\\frac{d(\\cdot)}{dx} = \\frac{d\\xi}{dx}\\frac{d(\\cdot)}{d\\xi} = \\frac{2}{h_e}\\frac{d(\\cdot)}{d\\xi}$。我们定义应变-位移矩阵。曲率为 $\\frac{d\\theta}{dx} = \\mathbf{B}_b \\mathbf{d}^e$，剪应变为 $\\gamma = \\frac{dw}{dx} - \\theta = \\mathbf{B}_s \\mathbf{d}^e$。\n用于弯曲的矩阵 $\\mathbf{B}_b$ 由 $\\theta$ 的导数推导而来：\n$$ \\frac{d\\theta}{dx} = \\frac{2}{h_e} \\left( \\frac{dN_1}{d\\xi}\\theta_1 + \\frac{dN_2}{d\\xi}\\theta_2 \\right) = \\frac{2}{h_e} \\left( -\\frac{1}{2}\\theta_1 + \\frac{1}{2}\\theta_2 \\right) = \\frac{1}{h_e}(-\\theta_1 + \\theta_2) $$\n$$ \\mathbf{B}_b = \\frac{1}{h_e} \\begin{bmatrix} 0  -1  0  1 \\end{bmatrix} $$\n用于剪切的矩阵 $\\mathbf{B}_s$ 由 $\\frac{dw}{dx} - \\theta$ 推导而来：\n$$ \\frac{dw}{dx} = \\frac{1}{h_e}(-w_1 + w_2) $$\n$$ \\gamma = \\frac{1}{h_e}(-w_1 + w_2) - (N_1(\\xi)\\theta_1 + N_2(\\xi)\\theta_2) $$\n$$ \\mathbf{B}_s(\\xi) = \\begin{bmatrix} -\\frac{1}{h_e}  -N_1(\\xi)  \\frac{1}{h_e}  -N_2(\\xi) \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{h_e}  -\\frac{1}{2}(1-\\xi)  \\frac{1}{h_e}  -\\frac{1}{2}(1+\\xi) \\end{bmatrix} $$\n将这些离散形式代入弱形式并在单元域上积分，可得到单元刚度矩阵 $\\mathbf{k}^e = \\mathbf{k}_b^e + \\mathbf{k}_s^e$：\n$$ \\mathbf{k}_b^e = \\int_{-1}^{1} \\mathbf{B}_b^T E I \\mathbf{B}_b \\, J \\, d\\xi $$\n$$ \\mathbf{k}_s^e = \\int_{-1}^{1} \\mathbf{B}_s(\\xi)^T \\kappa G A \\mathbf{B}_s(\\xi) \\, J \\, d\\xi $$\n\n对于弯曲刚度 $\\mathbf{k}_b^e$，由于 $\\mathbf{B}_b$ 是常数，被积函数也是常数。积分为：\n$$ \\mathbf{k}_b^e = E I \\mathbf{B}_b^T \\mathbf{B}_b h_e = \\frac{E I}{h_e} \\begin{bmatrix} 0  0  0  0 \\\\ 0  1  0  -1 \\\\ 0  0  0  0 \\\\ 0  -1  0  1 \\end{bmatrix} $$\n这个结果是精确的，可以通过单个高斯点得到。\n\n对于剪切刚度 $\\mathbf{k}_s^e$，被积函数 $\\mathbf{B}_s^T \\mathbf{B}_s$ 是一个包含最高为2次 $\\xi$ 多项式的 $4 \\times 4$ 矩阵。完全精确积分需要一个2点高斯求积法则（$n$ 个点可以精确积分 $2n-1$ 次多项式；对于2次多项式，我们需要 $n=2$ 个点）。\n标准单元使用这个2点法则。对于剪切变形可以忽略的细长梁，$\\kappa G A$ 项变得非常大。数值积分在两个点上强制施加条件 $\\frac{dw}{dx} - \\theta \\approx 0$，这对使用线性形函数的单元造成了过度约束，导致了被称为剪切闭锁的人为刚性响应。\n\n无闭锁单元使用选择性减缩积分。我们用1点高斯求积法则（$\\xi=0$，权重 $w=2$）对剪切项进行积分。这仅在单元中心施加约束 $\\frac{dw}{dx} - \\theta = 0$，从而缓解了人为的刚度。在 $\\xi=0$ 时，$\\mathbf{B}_s(0) = [-\\frac{1}{h_e}, -\\frac{1}{2}, \\frac{1}{h_e}, -\\frac{1}{2}]$。\n$$ \\mathbf{k}_s^e(\\text{reduced}) = \\kappa G A (\\mathbf{B}_s(0)^T \\mathbf{B}_s(0)) \\frac{h_e}{2} (2) = \\frac{\\kappa G A}{h_e} \\begin{bmatrix} 1  h_e/2  -1  h_e/2 \\\\ h_e/2  h_e^2/4  -h_e/2  h_e^2/4 \\\\ -1  -h_e/2  1  -h_e/2 \\\\ h_e/2  h_e^2/4  -h_e/2  h_e^2/4 \\end{bmatrix} $$\n\n接下来，我们推导精确的解析解。控制微分方程由势能的第一变分得到，从而引出强形式。使用与我们的弱形式一致的符号约定，可得：\n$$ \\frac{dM}{dx} = -Q, \\quad \\frac{dQ}{dx} = 0 $$\n其中 $M = EI \\frac{d\\theta}{dx}$ 是弯矩，$Q = \\kappa G A (\\frac{dw}{dx} - \\theta)$ 是剪力。\n对于在 $x=L$ 处有端部载荷 $P$ 的悬臂梁，边界条件为 $w(0)=0, \\theta(0)=0, M(L)=0, Q(L)=P$。\n由 $Q'=0$ 和 $Q(L)=P$，我们得到对所有 $x$ 都有 $Q(x)=P$。\n由 $M' = -Q = -P$，积分得到 $M(x) = -Px + C_1$。使用 $M(L)=0$，我们发现 $-PL+C_1=0 \\Rightarrow C_1=PL$。因此，$M(x)=P(L-x)$。\n现在我们求解 $\\theta(x)$ 和 $w(x)$：\n$$ \\frac{d\\theta}{dx} = \\frac{M(x)}{EI} = \\frac{P(L-x)}{EI} $$\n积分并使用 $\\theta(0)=0$：\n$$ \\theta(x) = \\frac{P}{EI}\\left(Lx - \\frac{x^2}{2}\\right) $$\n接着，从剪切本构关系出发：\n$$ \\frac{dw}{dx} = \\theta(x) + \\frac{Q(x)}{\\kappa G A} = \\frac{P}{EI}\\left(Lx - \\frac{x^2}{2}\\right) + \\frac{P}{\\kappa G A} $$\n积分并使用 $w(0)=0$：\n$$ w(x) = \\frac{P}{EI}\\left(\\frac{Lx^2}{2} - \\frac{x^3}{6}\\right) + \\frac{Px}{\\kappa G A} $$\n在梁端 $x=L$ 处进行计算，我们得到精确的端部挠度和转角：\n$$ w_{\\text{ex}}(L) = \\frac{P}{EI}\\left(\\frac{L^3}{2} - \\frac{L^3}{6}\\right) + \\frac{PL}{\\kappa G A} = \\frac{PL^3}{3EI} + \\frac{PL}{\\kappa G A} $$\n$$ \\theta_{\\text{ex}}(L) = \\frac{P}{EI}\\left(L^2 - \\frac{L^2}{2}\\right) = \\frac{PL^2}{2EI} $$\n这些公式提供了用于验证有限元解的基准。这些项分别代表了弯曲和剪切对挠度的贡献，以及纯弯曲对转角的贡献。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Timoshenko beam problem using two different finite element formulations\n    and compares the results to the exact analytical solution.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    E = 210e9  # Young's modulus in Pa\n    nu = 0.3    # Poisson's ratio\n    G = E / (2 * (1 + nu))  # Shear modulus in Pa\n    kappa_s = 5.0 / 6.0  # Shear correction factor\n    b = 1.0     # Beam width in m\n    L = 1.0     # Beam length in m\n    P = 1.0     # Tip load in N\n    Ne = 4      # Number of elements\n    h = L / Ne  # Element length\n\n    # --- Test Cases ---\n    slenderness_ratios = [5, 10, 50, 100]\n    test_cases = []\n    for s_ratio in slenderness_ratios:\n        t = L / s_ratio\n        A = b * t\n        I = (b * t**3) / 12\n        test_cases.append({\n            \"slenderness\": s_ratio,\n            \"A\": A,\n            \"I\": I\n        })\n    \n    # Gauss quadrature points and weights\n    # 2-point rule for full integration of shear term\n    gauss_points_2 = [-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)]\n    gauss_weights_2 = [1.0, 1.0]\n\n    all_results = []\n\n    def get_element_stiffness(A, I, integration_type):\n        \"\"\"Calculates the 4x4 element stiffness matrix.\"\"\"\n        # Bending stiffness matrix (k_b)\n        # This is constant and integration is exact with one point.\n        k_b = (E * I / h) * np.array([\n            [0, 0, 0, 0],\n            [0, 1, 0, -1],\n            [0, 0, 0, 0],\n            [0, -1, 0, 1]\n        ])\n\n        # Shear stiffness matrix (k_s)\n        k_s = np.zeros((4, 4))\n        if integration_type == 'full':\n            # Full integration (2-point Gauss quadrature)\n            for xi, w in zip(gauss_points_2, gauss_weights_2):\n                N1 = 0.5 * (1 - xi)\n                N2 = 0.5 * (1 + xi)\n                # Shear strain-displacement matrix B_s\n                B_s = np.array([-1.0/h, -N1, 1.0/h, -N2])\n                k_s += w * np.outer(B_s, B_s)\n            k_s *= kappa_s * G * A * h / 2.0\n        \n        elif integration_type == 'reduced':\n            # Reduced integration (1-point Gauss quadrature at xi=0)\n            # Analytically derived formula for efficiency\n            factor = kappa_s * G * A / h\n            k_s = factor * np.array([\n                [1,         h/2,       -1,      h/2],\n                [h/2,   h**2/4,  -h/2,   h**2/4],\n                [-1,     -h/2,        1,     -h/2],\n                [h/2,   h**2/4,  -h/2,   h**2/4]\n            ])\n        \n        return k_b + k_s\n\n    def run_fem(A, I, integration_type):\n        \"\"\"Assembles and solves the global finite element system.\"\"\"\n        num_dofs = 2 * (Ne + 1)\n        K_global = np.zeros((num_dofs, num_dofs))\n        F_global = np.zeros(num_dofs)\n\n        # Get element stiffness matrix\n        k_e = get_element_stiffness(A, I, integration_type)\n\n        # Assemble global stiffness matrix\n        for i in range(Ne):\n            dof_indices = np.array([2*i, 2*i + 1, 2*i + 2, 2*i + 3])\n            K_global[np.ix_(dof_indices, dof_indices)] += k_e\n\n        # Apply force boundary condition\n        # A positive force P is applied to the transverse displacement DOF of the last node.\n        F_global[2 * Ne] = P\n\n        # Apply displacement boundary conditions (clamped at x=0)\n        # w(0) = 0 and theta(0) = 0\n        K_global[0, :] = 0\n        K_global[:, 0] = 0\n        K_global[0, 0] = 1.0\n        F_global[0] = 0\n\n        K_global[1, :] = 0\n        K_global[:, 1] = 0\n        K_global[1, 1] = 1.0\n        F_global[1] = 0\n\n        # Solve the system\n        d = np.linalg.solve(K_global, F_global)\n\n        # Extract tip deflection and rotation\n        tip_deflection = d[2 * Ne]\n        tip_rotation = d[2 * Ne + 1]\n        \n        return tip_deflection, tip_rotation\n\n    for case in test_cases:\n        s_ratio = case['slenderness']\n        A = case['A']\n        I = case['I']\n\n        # --- Exact Solution ---\n        w_exact = (P * L**3) / (3 * E * I) + (P * L) / (kappa_s * G * A)\n        theta_exact = (P * L**2) / (2 * E * I)\n\n        # --- FEM Solutions ---\n        # Standard Element (Full Integration)\n        w_std, theta_std = run_fem(A, I, 'full')\n\n        # Locking-Free Element (Reduced Integration)\n        w_lf, theta_lf = run_fem(A, I, 'reduced')\n\n        # --- Calculate Relative Errors ---\n        err_w_std = abs((w_std - w_exact) / w_exact)\n        err_theta_std = abs((theta_std - theta_exact) / theta_exact)\n        err_w_lf = abs((w_lf - w_exact) / w_exact)\n        err_theta_lf = abs((theta_lf - theta_exact) / theta_exact)\n        \n        all_results.append([s_ratio, err_w_std, err_theta_std, err_w_lf, err_theta_lf])\n\n    # Final print statement in the exact required format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2543367"}]}