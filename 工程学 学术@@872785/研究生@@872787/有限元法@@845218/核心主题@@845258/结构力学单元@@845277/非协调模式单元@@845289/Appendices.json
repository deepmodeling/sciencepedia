{"hands_on_practices": [{"introduction": "在有限元分析中，标准低阶单元（如四节点四边形单元）在模拟弯曲问题时常常会表现出过度刚硬的现象，即所谓的“剪切锁定”，导致计算结果严重失真。为了克服这一难题，研究人员发展了多种单元技术。这项练习通过一个经典的悬臂梁纯弯曲问题，引导我们从根本上辨析和比较不同单元配方的表现，包括标准单元、减缩积分单元以及非协调模式单元，从而深刻理解为何非协调模式能够有效缓解锁定效应，并提供更为精确的应力解 [@problem_id:2568555]。", "problem": "一根长为 $L$、高为 $H$、厚度为 $t$（平面外方向）的细长平面应力悬臂梁，在 $x=L$ 处承受一个恒定的端部弯矩 $M$，该弯矩引起了绕 $z$ 轴的近纯弯曲。材料是线弹性的，杨氏模量为 $E$，泊松比为 $\\nu$。精确的连续介质弯曲场（对于细长梁）具有沿深度线性变化的轴向应力 $\\sigma_{xx}(y)=\\dfrac{M}{I}\\,y$，其中 $I=\\dfrac{H^3 t}{12}$，并且内部的剪切应力 $\\sigma_{xy}\\approx 0$ 可忽略不计。\n\n在一个矩形域上，使用等参双线性四边形单元的结构化网格对梁进行离散。考虑三种单元/积分变体：\n- 标准双线性 $Q4$ 单元，采用 $2\\times 2$ 点的完全高斯积分。\n- 减缩积分双线性 $Q4$ 单元，采用 $1\\times 1$ 点（无沙漏控制）。\n- 用不相容模式（Wilson–Taylor 类型）增强的双线性 $Q4$ 单元，在单元层面进行凝聚，并采用 $2\\times 2$ 点积分。\n\n沿着位于某个固定位置 $x=x_c$（其中 $0  x_c  L$）的垂直截面上观察到的点态轴向应力 $\\sigma_{xx}(y)$ 的分布，以下哪些陈述是正确的？\n\nA. 在弯曲主导状态下，标准的完全积分 $Q4$ 单元倾向于在 $\\sigma_{xx}(y)$ 中产生显著的单元间振荡，因为 $u_y$ 中精确的关于 $x$ 的二次分量无法由双线性场表示，导致寄生剪切/薄膜应变和单元间应力跳跃；减缩积分 $Q4$ 单元通常通过对寄生刚度积分不足来减小振荡幅度，但有出现沙漏模式的风险；带有不相容模式的 $Q4$ 单元通过改善对曲率引起的应变梯度的表示，同时不引入伪零能模式，从而产生最平滑和最准确的应力分布。\n\nB. 标准 $Q4$ 单元在弯曲下产生振荡的主要原因是体积锁定；因此，当 $\\nu\\to 0$ 时，无论积分规则如何，振荡都会消失。\n\nC. 减缩积分完全消除了弯曲中的振荡，因为它精确地积分了双线性刚度；因此，在受到纯弯曲的规则网格上，它不会出现沙漏现象。\n\nD. 不相容模式增强通过在单元内部增加在单元边界上消失的泡状位移模式来增强位移场，从而减少振荡，这保持了单元间的 $C^0$ 连续性，同时提高了单元表示曲率的能力；这减轻了寄生剪切/薄膜应变，并且不会产生沙漏模式。\n\nE. 如果在深度 $H$ 方向上只使用一个单元（$N_h=1$），那么在纯弯曲情况下，这三种公式会产生基本上相同的点态轴向应力，因为它们共享相同的边界节点自由度。", "solution": "### 推导与分析\n\n该问题涉及低阶有限元精确模拟纯弯曲状态的能力。根据 Euler-Bernoulli 梁理论，悬臂梁在端部弯矩 $M$ 作用下的精确位移场为：\n$$u_x(x,y) = -\\frac{M}{EI}xy$$\n$$u_y(x,y) = \\frac{M}{2EI}x^2 + \\frac{\\nu M}{2EI}y^2 + \\text{刚体位移项}$$\n关键特征是轴向位移 $u_x$ 在 $x$ 和 $y$ 上是双线性的，而横向位移 $u_y$ 在 $x$ 上是二次的。相应的应变为 $\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = -\\frac{M}{EI}y$，$\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\nu M}{EI}y$，以及剪应变 $\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = (-\\frac{M}{EI}x) + (\\frac{M}{EI}x) = 0$。轴向应力为 $\\sigma_{xx} \\approx E \\epsilon_{xx} = -\\frac{M}{I}y$（为简化起见，假设平面应力且 $\\nu=0$，但论证对一般 $\\nu$ 仍然成立），它在 $y$ 上是线性的。\n\n1.  **标准双线性 Q4 单元（完全积分）**\n    一个标准的等参 $Q4$ 单元的位移场对于每个分量都具有 $u(\\xi, \\eta) = a_0 + a_1\\xi + a_2\\eta + a_3\\xi\\eta$ 的形式，其中 $\\xi$ 和 $\\eta$ 是局部坐标。对于与 $x,y$ 轴对齐的矩形网格，$\\xi$ 与 $x$ 成正比，$\\eta$ 与 $y$ 成正比。该单元可以精确表示双线性的 $u_x$ 场。然而，它不能表示二次的 $u_y(x) \\propto x^2$ 场。为了近似所需的曲率，单元边缘必须弯曲，但它们被约束为保持直线。当这些单元的集合弯曲时，每个单元变形成的形状会引起一种伪非零剪切应变，$\\gamma_{xy}^{spurious} \\neq 0$。这是因为来自有限元近似的项 $\\frac{\\partial u_y}{\\partial x}$ 并不能像它应该的那样精确地抵消 $\\frac{\\partial u_x}{\\partial y}$ 项。这种伪剪切应变产生人为的剪切应力，并贡献了一个大的、非物理的应变能项，使单元在弯曲中表现得过刚。这种现象被称为**剪切锁定**。这种过度的刚度导致位移和应力结果不佳，表现为应力场中从一个单元到下一个单元的剧烈振荡，因为单元在努力适应弯曲变形。\n\n2.  **减缩积分 Q4 单元 (Q4/1)**\n    此公式使用单元中心（$\\xi=0, \\eta=0$）的单个高斯点来计算应变并构建刚度矩阵。对于弯曲下的矩形单元，寄生剪切应变场 $\\gamma_{xy}^{spurious}$ 恰好在单元中心为零。通过仅使用该点来计算应变能积分，完全忽略了寄生剪切的贡献。这“解锁”了单元，使其在弯曲主导问题中变得更加柔顺和准确。与锁定相关的严重应力振荡被大大减少。然而，这是有代价的。单个积分点无法“感知”某些变形模式，这些模式被称为**沙漏模式**或零能模式。这些是伪变形模式，它们在单元中心不产生应变，因此没有相关的刚度。如果被激发，它们会用无意义的振荡破坏解。\n\n3.  **带不相容模式的 Q4 单元 (Q4I)**\n    这种先进的公式增强了单元的运动学。标准的双线性位移场被内部“泡状”函数增强，这些函数在单元边界上为零。对于弯曲，关键的模式是 $(1-\\xi^2)$ 和 $(1-\\eta^2)$ 的形式。例如，用一个与 $(1-\\xi^2)$ 成比例的模式来丰富 $u_y$，允许单元在内部表示位移的二次变化。这提供了模拟纯弯曲曲率所需的运动学自由度，而不会引起寄生剪切应变。由于增强模式在单元边界处为零，因此与相邻单元的 $C^0$-连续性得以保持。与这些模式相关的内部参数在单元层面被凝聚掉。该单元使用完全的 $2\\times 2$ 积分进行评估，这提供了正确的刚度，并确保沙漏模式具有正的应变能，因此被抑制。该公式成功地解决了剪切锁定问题，而没有引入减缩积分的不稳定性，从而得到平滑且高度准确的应力解。\n\n### 逐项分析\n\n**A. 在弯曲主导状态下，标准的完全积分 $Q4$ 单元倾向于在 $\\sigma_{xx}(y)$ 中产生显著的单元间振荡，因为 $u_y$ 中精确的关于 $x$ 的二次分量无法由双线性场表示，导致寄生剪切/薄膜应变和单元间应力跳跃；减缩积分 $Q4$ 单元通常通过对寄生刚度积分不足来减小振荡幅度，但有出现沙漏模式的风险；带有不相容模式的 $Q4$ 单元通过改善对曲率引起的应变梯度的表示，同时不引入伪零能模式，从而产生最平滑和最准确的应力分布。**\n这个陈述提供了一个完整而准确的总结。它正确地指出了标准 $Q4$ 单元的运动学缺陷是寄生剪切（剪切锁定）和应力振荡的原因。它正确地描述了减缩积分的权衡（以沙漏风险换取锁定减少）。它还正确地描述了不相容模式单元的优越性能，该单元通过丰富运动学来精确表示曲率，同时使用完全积分来避免伪模式。\n**结论：正确。**\n\n**B. 标准 $Q4$ 单元在弯曲下产生振荡的主要原因是体积锁定；因此，当 $\\nu\\to 0$ 时，无论积分规则如何，振荡都会消失。**\n这个陈述是不正确的。这个问题中主要的锁定机制是**剪切锁定**，它源于单元无法模拟纯弯曲变形。**体积锁定**发生在近不可压缩材料中（当泊松比 $\\nu \\to 0.5$ 时），除非 $\\nu$ 非常高，否则与此特定问题无关。剪切锁定即使在 $\\nu=0$ 时也存在，因为它与剪切模量 $G = E/(2(1+\\nu))$ 相关，该模量保持有限。\n**结论：不正确。**\n\n**C. 减缩积分完全消除了弯曲中的振荡，因为它精确地积分了双线性刚度；因此，在受到纯弯曲的规则网格上，它不会出现沙漏现象。**\n这个陈述包含多个错误。首先，减缩积分并不能“精确地积分”双线性刚度矩阵；对于矩形 $Q4$ 单元的刚度矩阵，需要完全（$2\\times 2$）求积才能实现精确积分。减缩积分之所以有效，恰恰是因为它*不精确地*积分了刚度，未能捕捉到寄生剪切能。其次，虽然它显著减少了由锁定引起的振荡，但它并不能“完全消除”它们；由此产生的单元内常数应力分布本身就是一种振荡形式（阶梯状近似）。第三，虽然在完美网格上的纯弯曲可能不会激发沙漏模式，但该单元公式在更一般的情况下从根本上是容易受到它们影响的。该陈述错误地描述了基本原理。\n**结论：不正确。**\n\n**D. 不相容模式增强通过在单元内部增加在单元边界上消失的泡状位移模式来增强位移场，从而减少振荡，这保持了单元间的 $C^0$ 连续性，同时提高了单元表示曲率的能力；这减轻了寄生剪切/薄膜应变，并且不会产生沙漏模式。**\n这个陈述对不相容模式方法提供了精确而准确的描述。位移场通过内部模式（在单元边界上为零的函数，从而保持 $C^0$ 连续性）得到增强。这种增强直接提高了单元表示曲率的能力。结果，寄生剪切的来源被消除。该单元采用完全积分，它能正确捕捉所有变形模式的能量，因此不会遭受沙漏之苦。\n**结论：正确。**\n\n**E. 如果在深度 $H$ 方向上只使用一个单元（$N_h=1$），那么在纯弯曲情况下，这三种公式会产生基本上相同的点态轴向应力，因为它们共享相同的边界节点自由度。**\n这个陈述是不正确的。由于不同的积分规则和/或运动学假设，这三种公式具有根本不同的单元刚度矩阵（$[K_e]$）。对于给定的应用载荷，系统方程 $[K][U]=[F]$ 将为每种公式产生不同的节点位移向量 $[U]$。因此，由这些位移计算出的应力（例如 $\\boldsymbol{\\sigma}=[D][B][U]$）也将不同。开发 $Q4/1$ 和 $Q4I$ 单元的根本动机就是它们在弯曲中能产生优于标准 $Q4$ 单元的结果，而这种差异并不会仅仅因为网格在一个方向上粗糙而消失。标准 $Q4$ 单元的剪切锁定仍然存在。\n**结论：不正确。**", "answer": "$$\\boxed{AD}$$", "id": "2568555"}, {"introduction": "理解了非协调模式在概念上的优势后，下一步是通过具体的计算来掌握其工作机理。本练习将引导我们为一个承受弯曲的板单元手动引入一个特定的非协调转动模式，并定量分析它对单元刚度矩阵的贡献 [@problem_id:2568518]。通过推导和计算非协调模式引入的附加项 $\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}$，我们将亲眼见证非协调模式如何通过“软化”效应来修正标准单元的刚度，使其能够更准确地模拟弯曲变形。", "problem": "考虑在有限元法 (FEM) 中，一个用于薄板弯曲问题的单一四节点等参四边形单元，该薄板根据 Mindlin–Reissner 理论建模，占据 x–y 平面中的单位正方形区域 $\\Omega = [0,1] \\times [0,1]$。仅关注能量的弯曲部分（忽略横向剪切）。设板的弯曲本构矩阵为\n$$\n\\mathbf{D}_{b} \\;=\\; D_{0}\\begin{bmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\n通过归一化 $D_{0} = 1$ 和 $\\nu = 0$，使得 $\\mathbf{D}_{b} = \\mathrm{diag}(1,\\,1,\\,\\tfrac{1}{2})$。弯曲应变（曲率）由转角 $\\theta_{x}(x,y)$ 和 $\\theta_{y}(x,y)$ 定义如下\n$$\n\\kappa_{x} = -\\frac{\\partial \\theta_{x}}{\\partial x}, \\quad\n\\kappa_{y} = -\\frac{\\partial \\theta_{y}}{\\partial y}, \\quad\n\\kappa_{xy} = -\\frac{\\partial \\theta_{x}}{\\partial y} - \\frac{\\partial \\theta_{y}}{\\partial x}.\n$$\n设协调转角由节点值双线性插值得到，并考虑对应于绕 y 轴的均匀曲率的特定协调弯曲模式：\n$$\n\\theta_{x}^{c}(x,y) = x, \\qquad \\theta_{y}^{c}(x,y) = 0,\n$$\n通过为 $\\theta_{x}$ 赋予等于 x 坐标的节点值并为 $\\theta_{y}$ 赋予零值，该模式可以在 $\\Omega$ 上由双线性插值精确表示。用一个形式如下的单个标量非协调内部模式 $a \\in \\mathbb{R}$ 对该单元进行增广\n$$\n\\theta_{x}^{i}(x,y) = a\\,x\\,y, \\qquad \\theta_{y}^{i}(x,y) = 0,\n$$\n该模式将在单元层面通过静力凝聚被消除。用 $\\mathbf{K}_{cc}$ 表示与协调自由度相关的协调弯曲刚度，用 $\\mathbf{K}_{ii}$ 表示单个非协调模式的自刚度，用 $\\mathbf{K}_{ci}$、$\\mathbf{K}_{ic}$ 表示耦合块。使用弯曲能量泛函\n$$\n\\Pi_{b}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A,\n$$\n计算上述场的标量二次型\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q,\n$$\n其中 $q$ 是再现 $\\theta_{x}^{c}(x,y)=x$，$\\theta_{y}^{c}(x,y)=0$ 的协调节点向量。然后，通过以下比率来量化沿此模式的弯曲刚度变化\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}.\n$$\n将 $r$ 精确计算为一个实数。最终答案以无单位的精确数表示。无需四舍五入。", "solution": "任务是计算比率 $r$，其定义为：\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}\n$$\n该表达式中的各项源于单元的弯曲能量泛函 $\\Pi_b$。总转角场是协调部分和非协调部分之和，前者从节点自由度 $q$ 插值得到，后者由内部自由度 $a$ 参数化。设转角场为 $\\boldsymbol{\\theta} = (\\theta_x, \\theta_y)$。应变向量 $\\boldsymbol{\\kappa} = (\\kappa_x, \\kappa_y, \\kappa_{xy})$ 是通过一个微分算子从 $\\boldsymbol{\\theta}$ 导出的，我们记为 $\\boldsymbol{\\kappa} = \\mathcal{L}(\\boldsymbol{\\theta})$。该关系是线性的。因此，总应变可以分解为 $\\boldsymbol{\\kappa} = \\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i$，其中 $\\boldsymbol{\\kappa}^c = \\mathcal{L}(\\boldsymbol{\\theta}^c)$ 且 $\\boldsymbol{\\kappa}^i = \\mathcal{L}(\\boldsymbol{\\theta}^i)$。\n\n弯曲能量泛函由下式给出：\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A\n$$\n代入分解后的应变，我们得到：\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} (\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)^{T}\\,\\mathbf{D}_{b}\\,(\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)\\, \\mathrm{d}A \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\left( (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c + 2 (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i + (\\boldsymbol{\\kappa}^i)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i \\right) \\mathrm{d}A\n$$\n应变场通过应变-位移矩阵 $\\mathbf{B}_c$ 和 $\\mathbf{B}_i$ 与自由度 $q$ 和 $a$ 相关，使得 $\\boldsymbol{\\kappa}^c = \\mathbf{B}_c q$ 和 $\\boldsymbol{\\kappa}^i = \\mathbf{B}_i a$。能量可以写成矩阵形式：\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2} q^T \\mathbf{K}_{cc} q + q^T \\mathbf{K}_{ci} a + \\frac{1}{2} a^T \\mathbf{K}_{ii} a\n$$\n其中刚度子矩阵由在单元域 $\\Omega$ 上的积分定义：\n$\\mathbf{K}_{cc} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_c \\,\\mathrm{d}A$，$\\mathbf{K}_{ci} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_i \\,\\mathrm{d}A$，以及 $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\,\\mathrm{d}A$。\n\n比率 $r$ 中的二次型可以直接用应变场表示：\n分母是 $q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\mathbf{B}_c q)^T \\mathbf{D}_b (\\mathbf{B}_c q) \\,\\mathrm{d}A = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\,\\mathrm{d}A$。\n对于分子，由于 $a$ 是一个标量自由度，$\\mathbf{K}_{ii}$ 是一个 $1 \\times 1$ 矩阵（一个标量），$\\mathbf{K}_{ic}$ 是一个 $1 \\times N$ 的行向量（其中 $N$ 是 $q$ 的大小），而 $\\mathbf{K}_{ci} = \\mathbf{K}_{ic}^T$ 是一个 $N \\times 1$ 的列向量。分子变为：\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{(q^T \\mathbf{K}_{ci})(\\mathbf{K}_{ic} q)}{\\mathbf{K}_{ii}} = \\frac{(\\mathbf{K}_{ic}q)^2}{\\mathbf{K}_{ii}}\n$$\n其中 $\\mathbf{K}_{ic} q = \\left(\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_c \\,\\mathrm{d}A\\right) q = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b (\\mathbf{B}_c q) \\,\\mathrm{d}A = \\int_{\\Omega} (\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c) \\,\\mathrm{d}A$。此外，$\\mathbf{K}_{ii}$ 是标量积分 $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\,\\mathrm{d}A$。\n因此，分子是：\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\,\\mathrm{d}A \\right)^2}{\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\,\\mathrm{d}A}\n$$\n\n我们现在使用所提供的数据计算必要的组成部分。\n区域为 $\\Omega = [0,1] \\times [0,1]$。\n本构矩阵为 $\\mathbf{D}_{b} = \\mathrm{diag}(1, 1, \\frac{1}{2})$。\n\n首先，确定应变场。\n协调转角场为 $\\theta_{x}^{c}(x,y) = x$ 和 $\\theta_{y}^{c}(x,y) = 0$。相应的协调应变（曲率）为：\n$$\n\\boldsymbol{\\kappa}^c = \\begin{pmatrix} -\\frac{\\partial \\theta_{x}^{c}}{\\partial x} \\\\ -\\frac{\\partial \\theta_{y}^{c}}{\\partial y} \\\\ -\\frac{\\partial \\theta_{x}^{c}}{\\partial y} - \\frac{\\partial \\theta_{y}^{c}}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\partial (x)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (x)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n非协调转角场为 $\\theta_{x}^{i}(x,y) = a\\,x\\,y$ 和 $\\theta_{y}^{i}(x,y) = 0$。相应的非协调应变为：\n$$\n\\boldsymbol{\\kappa}^i = \\begin{pmatrix} -\\frac{\\partial (a\\,x\\,y)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (a\\,x\\,y)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -a\\,y \\\\ 0 \\\\ -a\\,x \\end{pmatrix} = a \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}\n$$\n由此，我们确定非协调应变形状矩阵为 $\\mathbf{B}_i = \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}$。\n\n现在，我们计算积分。\n1. $r$ 的分母：$q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\,\\mathrm{d}A$。\n被积函数是：\n$$\n(\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -1  0  0 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1  0  0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1\n$$\n积分区域是单位正方形：\n$$\nq^T \\mathbf{K}_{cc} q = \\int_{0}^{1}\\int_{0}^{1} 1\\, \\mathrm{d}x\\mathrm{d}y = 1\n$$\n\n2. $r$ 的分子：$q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q$。这需要两个独立的积分。\na. 耦合积分项 $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\,\\mathrm{d}A$：\n被积函数是：\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -y  0  -x \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -y  0  -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = y\n$$\n积分为：\n$$\n\\int_{0}^{1}\\int_{0}^{1} y\\, \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} y \\left[ x \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} y\\, \\mathrm{d}y = \\left[ \\frac{y^2}{2} \\right]_{0}^{1} = \\frac{1}{2}\n$$\n所以，平方项是 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n\nb. 非协调刚度项 $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\,\\mathrm{d}A$：\n被积函数是：\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i = \\begin{pmatrix} -y  0  -x \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = \\begin{pmatrix} -y  0  -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = y^2 + \\frac{x^2}{2}\n$$\n积分为：\n$$\n\\mathbf{K}_{ii} = \\int_{0}^{1}\\int_{0}^{1} \\left(y^2 + \\frac{x^2}{2}\\right) \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} \\left[ y^2 x + \\frac{x^3}{6} \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} \\left(y^2 + \\frac{1}{6}\\right) \\mathrm{d}y\n$$\n$$\n\\mathbf{K}_{ii} = \\left[ \\frac{y^3}{3} + \\frac{y}{6} \\right]_{0}^{1} = \\frac{1}{3} + \\frac{1}{6} = \\frac{2}{6} + \\frac{1}{6} = \\frac{3}{6} = \\frac{1}{2}\n$$\n\nc. 组合分子：\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\frac{1}{2} \\right)^2}{\\frac{1}{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}\n$$\n\n3. 最后，计算比率 $r$：\n$$\nr = \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q} = \\frac{\\frac{1}{2}}{1} = \\frac{1}{2}\n$$\n由于添加了非协调模式，代表给定模式下弯曲刚度变化的这个比率恰好是 $\\frac{1}{2}$。这种变化对应于刚度的降低，因为静力凝聚后的有效刚度矩阵是 $\\mathbf{K}_{eff} = \\mathbf{K}_{cc} - \\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}$。这种软化效应是此类非协调模式列式的一个已知结果，通常被引入以缓解闭锁现象。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2568518"}, {"introduction": "理论上的完美单元在实际工程应用中仍可能面临数值稳定性问题，尤其是在网格质量不佳时。这项练习将我们的注意力转向一个核心的实际问题：当单元形状发生畸变（例如，具有很大的宽高比）时，非协调模式的内部刚度矩阵 $\\mathbf{K}_{ii}$ 可能会变得病态，从而影响求解的稳定性和精度 [@problem_id:2568531]。通过编程实践，我们将数值化地探究单元宽高比对 $\\mathbf{K}_{ii}$ 条件数的影响，并验证一种有效的模式缩放策略是如何彻底解决这一病态问题，确保单元的鲁棒性。", "problem": "给定一个二维线性弹性平面应变问题中的矩形、等参、四节点四边形有限元。考虑采用增强假设应变 (EAS) 的非协调模式增强，其包含 $2$ 个内部应变参数，收集在向量 $\\boldsymbol{\\alpha} = [\\alpha_{x}, \\alpha_{y}]^{\\mathsf{T}}$ 中。非协调应变场直接在物理坐标 $(x,y)$ 中假设为\n$$\n\\boldsymbol{\\varepsilon}^{\\text{inc}}(x,y) \\;=\\; \\mathbf{H}(x,y)\\,\\boldsymbol{\\alpha}, \\qquad \n\\mathbf{H}(x,y) \\;=\\; \n\\begin{bmatrix}\nx  0 \\\\\n0  y \\\\\n0  0\n\\end{bmatrix},\n$$\n因此 $\\varepsilon_{xx}^{\\text{inc}} = \\alpha_{x}\\,x$，$\\varepsilon_{yy}^{\\text{inc}} = \\alpha_{y}\\,y$，且 $\\gamma_{xy}^{\\text{inc}} = 0$。\n\n设单元在物理坐标中占据矩形区域 $[-a/2,\\,a/2] \\times [-b/2,\\,b/2]$，其边长为 $a0$ 和 $b0$，纵横比为 $r = a/b$。平面应变的线性弹性本构矩阵为\n$$\n\\mathbf{D} \\;=\\; \n\\begin{bmatrix}\n\\lambda + 2\\mu  \\lambda  0 \\\\\n\\lambda  \\lambda + 2\\mu  0 \\\\\n0  0  2\\mu\n\\end{bmatrix}, \\qquad\n\\lambda \\;=\\; \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}, \\quad\n\\mu \\;=\\; \\dfrac{E}{2(1+\\nu)},\n$$\n其中 $E0$ 是杨氏模量，$\\nu \\in (0,\\,0.5)$ 是泊松比。非协调模式内刚度子矩阵 $\\mathbf{K}_{ii} \\in \\mathbb{R}^{2\\times 2}$ 由非协调模式的应变能定义：\n$$\n\\mathbf{K}_{ii} \\;=\\; \\int_{\\Omega_e} \\mathbf{H}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\mathbf{H}(x,y) \\,\\mathrm{d}A,\n$$\n其中 $\\Omega_e$ 是物理坐标中的单元域。假设厚度等于 $1$，因此 $\\mathrm{d}A$ 是面积度量，并且所有量都单位一致；因此，所要求的条件数是无量纲的，必须作为纯数字报告，不带任何单位。\n\n为了缓解大纵横比下的病态问题，考虑一个基于长度的非协调应变映射缩放变体，\n$$\n\\widetilde{\\mathbf{H}}(x,y) \\;=\\; \n\\begin{bmatrix}\n\\dfrac{x}{a}  0 \\\\\n0  \\dfrac{y}{b} \\\\\n0  0\n\\end{bmatrix},\n\\qquad\n\\widetilde{\\mathbf{K}}_{ii} \\;=\\; \\int_{\\Omega_e} \\widetilde{\\mathbf{H}}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\widetilde{\\mathbf{H}}(x,y) \\,\\mathrm{d}A,\n$$\n这对应于在每个方向上通过特征单元长度来缩放内部参数。数值任务是评估 $\\mathbf{K}_{ii}$ 的条件数对纵横比的敏感性，并评估上述缩放的有效性。\n\n从总弹性势能泛函和增强假设应变非协调模式的定义出发，推导数值计算 $\\mathbf{K}_{ii}$ 及其条件数所需的表达式。然后实现一个程序，在父正方形 $[-1,1]\\times[-1,1]$ 上使用张量积高斯-勒让德求积，并采用等参映射\n$$\nx = \\dfrac{a}{2}\\,\\xi, \\qquad y = \\dfrac{b}{2}\\,\\eta, \\qquad \\mathrm{d}A = \\dfrac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n为每个测试案例计算以下内容：\n- 未缩放矩阵的谱条件数 $\\kappa(\\mathbf{K}_{ii})$，以及\n- 长度缩放矩阵的谱条件数 $\\kappa(\\widetilde{\\mathbf{K}}_{ii})$。\n\n您的程序必须从基本原理出发实现以下步骤：\n- 从 $(E,\\nu)$ 构建 $\\mathbf{D}$，\n- 通过对给定积分进行数值求积来组装 $\\mathbf{K}_{ii}$ 和 $\\widetilde{\\mathbf{K}}_{ii}$，以及\n- 使用矩阵 $2$-范数计算谱条件数。\n\n使用以下单元和材料参数 $(a,b,E,\\nu)$ 的测试套件：\n- 案例 1：$(a,b,E,\\nu) = (\\,1,\\,1,\\,1,\\,0.3\\,)$，\n- 案例 2：$(a,b,E,\\nu) = (\\,10,\\,1,\\,1,\\,0.3\\,)$，\n- 案例 3：$(a,b,E,\\nu) = (\\,1,\\,10,\\,1,\\,0.3\\,)$，\n- 案例 4：$(a,b,E,\\nu) = (\\,10^{-3},\\,1,\\,1,\\,0.3\\,)$，\n- 案例 5：$(a,b,E,\\nu) = (\\,4,\\,1,\\,1,\\,0.4999\\,)$。\n\n所有输出必须是无量纲的实数。对于每个案例，返回一个浮点数对 $[\\kappa(\\mathbf{K}_{ii}),\\,\\kappa(\\widetilde{\\mathbf{K}}_{ii})]$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含所有案例的结果对的逗号分隔列表，并用方括号括起来。例如，概念格式为 $[\\,[\\kappa_{1}^{\\text{un}},\\kappa_{1}^{\\text{sc}}],\\,[\\kappa_{2}^{\\text{un}},\\kappa_{2}^{\\text{sc}}],\\,\\dots\\,]$。", "solution": "任务是计算与非协调模式公式相关的两个内刚度矩阵 $\\mathbf{K}_{ii}$ 和 $\\widetilde{\\mathbf{K}}_{ii}$ 的谱条件数。推导必须从基本原理出发，计算必须按照指定使用数值求积进行。\n\n首先，我们推导刚度矩阵的被积函数。非协调应变的未缩放形函数矩阵是 $\\mathbf{H}(x,y) = \\begin{bmatrix} x  0 \\\\ 0  y \\\\ 0  0 \\end{bmatrix}$。本构矩阵是 $\\mathbf{D}$。$\\mathbf{K}_{ii}$ 的被积函数是 $2 \\times 2$ 矩阵 $\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H}$。\n$$\n\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H} =\n\\begin{bmatrix} x  0  0 \\\\ 0  y  0 \\end{bmatrix}\n\\begin{bmatrix}\n\\lambda + 2\\mu  \\lambda  0 \\\\\n\\lambda  \\lambda + 2\\mu  0 \\\\\n0  0  2\\mu\n\\end{bmatrix}\n\\begin{bmatrix} x  0 \\\\ 0  y \\\\ 0  0 \\end{bmatrix}\n=\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2  \\lambda xy \\\\ \\lambda xy  (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n$$\n矩阵 $\\mathbf{K}_{ii}$ 是通过在单元域 $\\Omega_e = [-a/2, a/2] \\times [-b/2, b/2]$ 上对此表达式进行积分得到的。\n$$\n\\mathbf{K}_{ii} = \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2}\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2  \\lambda xy \\\\ \\lambda xy  (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n由于积分域关于原点对称，非对角项（是奇函数 $xy$）的积分为零。\n$$\n\\int_{-a/2}^{a/2} x \\,\\mathrm{d}x = 0, \\quad \\int_{-b/2}^{b/2} y \\,\\mathrm{d}y = 0 \\quad \\implies \\quad \\int_{\\Omega_e} xy \\,\\mathrm{d}A = 0\n$$\n对角项计算如下：\n$$\n(\\mathbf{K}_{ii})_{11} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} x^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( b \\right) \\left( \\frac{x^3}{3} \\right)\\bigg|_{-a/2}^{a/2} = (\\lambda + 2\\mu) \\frac{a^3b}{12}\n$$\n$$\n(\\mathbf{K}_{ii})_{22} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} y^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( a \\right) \\left( \\frac{y^3}{3} \\right)\\bigg|_{-b/2}^{b/2} = (\\lambda + 2\\mu) \\frac{ab^3}{12}\n$$\n因此，未缩放的内刚度矩阵是对角矩阵：\n$$\n\\mathbf{K}_{ii} = \\frac{\\lambda + 2\\mu}{12}\n\\begin{bmatrix} a^3b  0 \\\\ 0  ab^3 \\end{bmatrix}\n$$\n谱条件数 $\\kappa(\\mathbf{K}_{ii})$ 是最大特征值与最小特征值之比。对于正定对角矩阵，这是最大对角元素与最小对角元素之比。\n$$\n\\kappa(\\mathbf{K}_{ii}) = \\frac{\\max(a^3b, ab^3)}{\\min(a^3b, ab^3)} = \\frac{\\max(a^2, b^2)}{\\min(a^2, b^2)} = \\left( \\frac{\\max(a, b)}{\\min(a, b)} \\right)^2 = \\max\\left( \\frac{a^2}{b^2}, \\frac{b^2}{a^2} \\right)\n$$\n如果我们定义纵横比 $r = a/b$，那么 $\\kappa(\\mathbf{K}_{ii}) = \\max(r^2, 1/r^2)$。这直接显示了条件数对单元纵横比的敏感性。\n\n接下来，我们分析基于长度的缩放公式。缩放后的形函数矩阵是 $\\widetilde{\\mathbf{H}}(x,y) = \\begin{bmatrix} x/a  0 \\\\ 0  y/b \\\\ 0  0 \\end{bmatrix}$。被积函数是 $\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}}$。按照相同的步骤，我们在被积函数表达式中将 $x$ 替换为 $x/a$，将 $y$ 替换为 $y/b$。\n$$\n\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}} =\n\\begin{bmatrix} (\\lambda + 2\\mu)(x/a)^2  \\lambda (x/a)(y/b) \\\\ \\lambda (x/a)(y/b)  (\\lambda + 2\\mu)(y/b)^2 \\end{bmatrix}\n$$\n在 $\\Omega_e$ 上积分：\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{11} = \\frac{\\lambda + 2\\mu}{a^2} \\int_{\\Omega_e} x^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{a^2} \\frac{a^3b}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{22} = \\frac{\\lambda + 2\\mu}{b^2} \\int_{\\Omega_e} y^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{b^2} \\frac{ab^3}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\n非对角项同样为零。得到的缩放矩阵为：\n$$\n\\widetilde{\\mathbf{K}}_{ii} = (\\lambda + 2\\mu) \\frac{ab}{12}\n\\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}\n$$\n这是一个单位矩阵的倍数。任何非零单位矩阵倍数的条件数恒为 $1$。\n$$\n\\kappa(\\widetilde{\\mathbf{K}}_{ii}) = 1\n$$\n该解析推导证实，长度缩放消除了内刚度矩阵条件数对单元纵横比的依赖性。值得注意的是，材料参数 $E$ 和 $\\nu$ 在两种情况下都不影响条件数，因为它们作为公共缩放因子出现在对角项上。\n\n对于数值实现，我们使用张量积高斯-勒让德求积。从父单元 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 到物理单元的变换是 $x = \\frac{a}{2}\\xi$ 和 $y = \\frac{b}{2}\\eta$。面积微元是 $\\mathrm{d}A = \\det(\\mathbf{J})\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta = \\frac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n$\\mathbf{K}_{ii}$ 或 $\\widetilde{\\mathbf{K}}_{ii}$ 的任何分量的积分形式为：\n$$\n\\int_{\\Omega_e} f(x,y) \\,\\mathrm{d}A = \\int_{-1}^{1} \\int_{-1}^{1} f\\left(\\frac{a}{2}\\xi, \\frac{b}{2}\\eta\\right) \\frac{ab}{4} \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta \\approx \\frac{ab}{4} \\sum_{i=1}^{N_p} \\sum_{j=1}^{N_p} w_i w_j f\\left(\\frac{a}{2}\\xi_i, \\frac{b}{2}\\eta_j\\right)\n$$\n其中 $(\\xi_i, w_i)$ 和 $(\\eta_j, w_j)$ 是高斯点和权重，$N_p$ 是一维上的点数。被积函数是关于 $x$ 和 $y$ 的最高 $2$ 次多项式。映射到父单元后，它们成为关于 $\\xi$ 和 $\\eta$ 的同次多项式。一个 $2$ 点高斯法则 ($N_p=2$) 可以精确积分最高 $2 \\times 2 - 1 = 3$ 次的多项式。因此，一个 $2 \\times 2$ 的张量积求积法则足以精确计算这些积分。\n\n该实现将为每个测试案例构建本构矩阵 $\\mathbf{D}$，使用 $2 \\times 2$ 高斯求积对 $\\mathbf{K}_{ii}$ 和 $\\widetilde{\\mathbf{K}}_{ii}$ 进行数值积分，然后计算它们的谱条件数。", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Solves the finite element problem for all specified test cases.\n    \"\"\"\n    \n    # Test suite of element and material parameters (a, b, E, nu).\n    test_cases = [\n        # Case 1: Square element, standard material.\n        (1.0, 1.0, 1.0, 0.3),\n        # Case 2: High aspect ratio (a > b).\n        (10.0, 1.0, 1.0, 0.3),\n        # Case 3: High aspect ratio (b > a).\n        (1.0, 10.0, 1.0, 0.3),\n        # Case 4: Extreme aspect ratio (a  b).\n        (1e-3, 1.0, 1.0, 0.3),\n        # Case 5: High aspect ratio, near-incompressible material.\n        (4.0, 1.0, 1.0, 0.4999),\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa_pair = compute_condition_numbers(*case)\n        results.append(kappa_pair)\n\n    # Format the final output as a comma-separated list of lists.\n    # str([a, b]) produces '[a, b]'. join combines these strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_condition_numbers(a: float, b: float, E: float, nu: float):\n    \"\"\"\n    Computes the spectral condition numbers for K_ii and tilde(K)_ii.\n    \n    Args:\n        a: Length of the element in the x-direction.\n        b: Length of the element in the y-direction.\n        E: Young's modulus.\n        nu: Poisson's ratio.\n        \n    Returns:\n        A list containing the condition numbers [kappa(K_ii), kappa(tilde(K)_ii)].\n    \"\"\"\n    \n    # 1. Construct the plane strain constitutive matrix D.\n    # Lamé parameters\n    lmbda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    mu = E / (2 * (1 + nu))\n    \n    D = np.array([\n        [lmbda + 2 * mu, lmbda,         0],\n        [lmbda,         lmbda + 2 * mu, 0],\n        [0,             0,             2 * mu]\n    ])\n    \n    # 2. Set up tensor-product Gauss-Legendre quadrature.\n    # A 2-point rule is exact for the polynomial integrands.\n    n_gauss_points = 2\n    gauss_points, gauss_weights = roots_legendre(n_gauss_points)\n    \n    # Isoparametric mapping Jacobian determinant (constant for a rectangle).\n    det_J = (a * b) / 4.0\n    \n    # 3. Assemble K_ii (unscaled) and tilde(K)_ii (scaled).\n    K_ii = np.zeros((2, 2))\n    tilde_K_ii = np.zeros((2, 2))\n    \n    for i in range(n_gauss_points):\n        for j in range(n_gauss_points):\n            xi = gauss_points[i]\n            eta = gauss_points[j]\n            w_i = gauss_weights[i]\n            w_j = gauss_weights[j]\n            \n            # Map from parent to physical coordinates.\n            x = (a / 2.0) * xi\n            y = (b / 2.0) * eta\n            \n            # --- Unscaled version ---\n            # H matrix: epsilon_inc = H * alpha\n            H = np.array([\n                [x,   0.0],\n                [0.0,   y],\n                [0.0, 0.0]\n            ])\n            \n            # Integrand for K_ii\n            integrand_K = H.T @ D @ H\n            K_ii += integrand_K * w_i * w_j * det_J\n\n            # --- Scaled version ---\n            # tilde(H) matrix\n            tilde_H = np.array([\n                [x / a, 0.0],\n                [0.0, y / b],\n                [0.0, 0.0]\n            ])\n\n            # Integrand for tilde(K)_ii\n            integrand_tilde_K = tilde_H.T @ D @ tilde_H\n            tilde_K_ii += integrand_tilde_K * w_i * w_j * det_J\n\n    # 4. Compute spectral condition numbers (using 2-norm).\n    kappa_K_ii = np.linalg.cond(K_ii, 2)\n    kappa_tilde_K_ii = np.linalg.cond(tilde_K_ii, 2)\n    \n    return [kappa_K_ii, kappa_tilde_K_ii]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2568531"}]}