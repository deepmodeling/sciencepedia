{"hands_on_practices": [{"introduction": "我们的动手实践始于后验误差估计中最基本的组成部分：单元内部残差。这个练习将指导你为一个使用线性元的简单一维问题计算强残差 $r_K$ [@problem_id:2594006]。通过这个计算，你将揭示一个关于为何跳跃残差对于一个收敛的误差估计器至关重要的关键见解。", "problem": "考虑区间 $[0,1]$ 上的一维边值问题：求 $u \\in H_{0}^{1}(0,1)$，使得\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0,\n$$\n给定右端项为\n$$\nf(x) = 2 + \\sin(2\\pi x).\n$$\n设 $\\mathcal{T}_h$ 是将 $[0,1]$ 均匀划分为两个单元 $K_{1} = (0,\\tfrac{1}{2})$ 和 $K_{2} = (\\tfrac{1}{2},1)$ 的剖分，每个单元的长度为 $h_K = \\tfrac{1}{2}$。设 $V_h \\subset H_{0}^{1}(0,1)$ 是从属于 $\\mathcal{T}_h$ 的标准连续分片线性函数空间。记 $u_h \\in V_h$ 为由伽辽金条件定义的协调有限元解\n$$\n\\int_{0}^{1} u_h'(x)\\,v_h'(x)\\,dx = \\int_{0}^{1} f(x)\\,v_h(x)\\,dx \\quad \\text{for all } v_h \\in V_h.\n$$\n对每个单元 $K \\in \\mathcal{T}_h$，定义强单元残差为内部量\n$$\nr_K(x) := f(x) + u_h''(x) \\quad \\text{for } x \\in K,\n$$\n即离散解限制在单元 $K$ 内部的强残差。\n\n任务：\n- 仅使用上述定义和连续分片线性基函数的标准性质，显式计算每个单元 $K \\in \\{K_{1},K_{2}\\}$ 上的 $r_K(x)$。\n- 然后，将 $h_K$ 视为可变单元长度，确定强残差的大小在 $L^{\\infty}(K)$ 范数意义下如何随 $h_K$ 缩放，即刻画 $\\|r_K\\|_{L^{\\infty}(K)}$ 对 $h_K$ 的依赖关系。\n\n答案规格：\n- 将 $\\|r_K\\|_{L^{\\infty}(K)}$ 相对于 $h_K$ 的最终缩放定律表示为 $h_K^{\\alpha}$ 形式的单项式。您的最终答案必须仅为该单项式（无解释性文本）。", "solution": "首先必须验证所述问题的正确性、一致性和科学依据。\n\n**步骤1：提取已知条件**\n所提供的信息如下：\n- **边值问题 (BVP)：** 求 $u \\in H_{0}^{1}(0,1)$，使得当 $x \\in (0,1)$ 时有 $- u''(x) = f(x)$，边界条件为 $u(0) = 0$ 和 $u(1) = 0$。\n- **强迫函数：** $f(x) = 2 + \\sin(2\\pi x)$。\n- **网格：** 将 $[0,1]$ 均匀划分为两个单元 $K_{1} = (0,\\tfrac{1}{2})$ 和 $K_{2} = (\\tfrac{1}{2},1)$ 的剖分 $\\mathcal{T}_h$。单元长度为 $h_K = \\tfrac{1}{2}$。\n- **有限元空间：** $V_h \\subset H_{0}^{1}(0,1)$ 是从属于 $\\mathcal{T}_h$ 且满足零边界条件的连续分片线性函数空间。\n- **伽辽金公式：** 有限元解 $u_h \\in V_h$ 由 $\\int_{0}^{1} u_h'(x)\\,v_h'(x)\\,dx = \\int_{0}^{1} f(x)\\,v_h(x)\\,dx$ 对所有 $v_h \\in V_h$ 定义。\n- **强单元残差：** 对于单元 $K \\in \\mathcal{T}_h$，残差定义为 $r_K(x) := f(x) + u_h''(x)$，其中 $x \\in K$。\n- **任务：**\n    1. 在 $K_{1}$ 和 $K_{2}$ 上显式计算 $r_K(x)$。\n    2. 将 $\\|r_K\\|_{L^{\\infty}(K)}$ 相对于可变单元长度 $h_K$ 的缩放关系刻画为单项式 $h_K^{\\alpha}$ 的形式。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是有限元方法后验误差分析中的一个标准练习。\n- **科学依据：** 该问题坚实地基于求解二阶椭圆型偏微分方程的有限元方法的数学理论。所有定义都是标准且正确的。\n- **适定性：** 带齐次狄利克雷边界条件的一维泊松方程是一个经典的适定边值问题。相应的伽辽金问题也是适定的。\n- **客观性：** 该问题以精确、客观的数学语言陈述。\n- **完备性与一致性：** 该问题是自洽且内部一致的。它提供了确定有限元解和所得残差所需的所有必要信息。\n\n**步骤3：结论与行动**\n问题有效。我将继续进行完整解答。\n\n对于给定的网格，有限元空间 $V_h$ 的节点位于 $x_0=0$，$x_1=\\tfrac{1}{2}$ 和 $x_2=1$。由于齐次狄利克雷条件 $u_h(0)=u_h(1)=0$，空间 $V_h$ 是一维的，由单个基函数——中心在内部节点 $x_1=\\tfrac{1}{2}$ 的“帽子”函数 $\\phi_1(x)$ 张成。该基函数定义为：\n$$\n\\phi_1(x) = \\begin{cases} 2x  \\text{if } x \\in [0, \\tfrac{1}{2}] \\\\ 2(1-x)  \\text{if } x \\in [\\tfrac{1}{2}, 1] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n有限元解 $u_h(x)$ 可以写成 $u_h(x) = c_1 \\phi_1(x)$，其中 $c_1$ 是一个待定的标量系数。伽辽金条件要求对 $V_h$ 中的所有函数进行测试，这可以通过对基函数 $\\phi_1(x)$ 进行测试来满足。\n$$\n\\int_{0}^{1} (c_1 \\phi_1(x))' (\\phi_1(x))' dx = \\int_{0}^{1} f(x) \\phi_1(x) dx\n$$\n这可以简化为一个关于 $c_1$ 的线性方程：\n$$\nc_1 \\left( \\int_{0}^{1} |\\phi_1'(x)|^2 dx \\right) = \\int_{0}^{1} f(x) \\phi_1(x) dx\n$$\n我们计算积分。基函数的导数为：\n$$\n\\phi_1'(x) = \\begin{cases} 2  \\text{if } x \\in (0, \\tfrac{1}{2}) \\\\ -2  \\text{if } x \\in (\\tfrac{1}{2}, 1) \\end{cases}\n$$\n左侧的积分为：\n$$\n\\int_{0}^{1} |\\phi_1'(x)|^2 dx = \\int_{0}^{1/2} (2)^2 dx + \\int_{1/2}^{1} (-2)^2 dx = 4 \\cdot \\frac{1}{2} + 4 \\cdot \\frac{1}{2} = 4\n$$\n右侧的积分为：\n$$\n\\int_{0}^{1} f(x) \\phi_1(x) dx = \\int_{0}^{1} (2 + \\sin(2\\pi x)) \\phi_1(x) dx = \\int_{0}^{1} 2\\phi_1(x) dx + \\int_{0}^{1} \\sin(2\\pi x) \\phi_1(x) dx\n$$\n第一项是由 $\\phi_1(x)$ 定义的三角形面积的两倍。$\\phi_1(x)$ 在 $x=1/2$ 处的最大值为 $1$。所以面积是 $\\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$。因此，$\\int_{0}^{1} 2\\phi_1(x) dx = 2 \\times \\frac{1}{2} = 1$。\n由于对称性，第二项为零。函数 $\\phi_1(x)$ 关于 $x=\\tfrac{1}{2}$ 是偶函数，而函数 $\\sin(2\\pi x)$ 关于 $x=\\tfrac{1}{2}$ 是奇函数（因为 $\\sin(2\\pi(\\tfrac{1}{2}-z)) = \\sin(\\pi - 2\\pi z) = \\sin(2\\pi z)$ 并且 $\\sin(2\\pi(\\tfrac{1}{2}+z)) = \\sin(\\pi + 2\\pi z) = -\\sin(2\\pi z)$）。它们乘积在对称/反对称点周围的对称区间 $[0,1]$ 上的积分为零。\n因此，右侧积分的计算结果为 $1$。\n\n关于 $c_1$ 的方程变为 $4c_1 = 1$，得出 $c_1 = \\tfrac{1}{4}$。有限元解为：\n$$\nu_h(x) = \\frac{1}{4} \\phi_1(x) = \\begin{cases} \\frac{1}{2}x  \\text{if } x \\in [0, \\tfrac{1}{2}] \\\\ \\frac{1}{2}(1-x)  \\text{if } x \\in [\\tfrac{1}{2}, 1] \\end{cases}\n$$\n现在我们解决第一个任务：计算强单元残差 $r_K(x) = f(x) + u_h''(x)$。\n函数 $u_h(x)$ 在每个单元 $K \\in \\{K_{1}, K_{2}\\}$ 的内部是线性的。因此，它的二阶导数 $u_h''(x)$ 对于所有 $x \\in K_1 \\cup K_2$ 恒为零。\n$$\nu_h''(x) = 0 \\quad \\text{for } x \\in (0,\\tfrac{1}{2}) \\cup (\\tfrac{1}{2},1)\n$$\n因此，每个单元内部的强单元残差就是强迫函数 $f(x)$：\n$$\nr_K(x) = f(x) + 0 = 2 + \\sin(2\\pi x) \\quad \\text{for } x \\in K\n$$\n这个结果对 $K_1 = (0,\\tfrac{1}{2})$ 和 $K_2 = (\\tfrac{1}{2},1)$ 都成立。这完成了第一个任务。\n\n接下来，我们解决第二个任务：确定 $\\|r_K\\|_{L^{\\infty}(K)}$ 随可变单元长度 $h_K$ 的缩放关系。\n从上一步我们已经确定，对于任何网格中的任何单元 $K$，分片线性逼近的强单元残差由 $r_K(x) = f(x)$ 给出，其中 $x \\in K$。因此，其在 $L^{\\infty}(K)$ 范数下的量值为：\n$$\n\\|r_K\\|_{L^{\\infty}(K)} = \\sup_{x \\in K} |r_K(x)| = \\sup_{x \\in K} |f(x)|\n$$\n问题是当单元尺寸 $h_K$ 趋于零时，这个量如何缩放。让我们考虑一个网格序列，其中 $h_K \\to 0$。对于这样一个网格中的任何单元 $K$，设 $x_K$ 是 $K$ 中的一个点。当 $h_K \\to 0$ 时，区间 $K$ 收缩到一个点。由于强迫函数 $f(x) = 2 + \\sin(2\\pi x)$ 处处连续，$|f(x)|$ 在一个收缩区间 $K$ 上的上确界收敛于 $|f|$ 在该极限点的值。\n$$\n\\lim_{h_K \\to 0} \\|r_K\\|_{L^{\\infty}(K)} = \\lim_{h_K \\to 0} \\sup_{x \\in K} |f(x)| = |f(x^*)|\n$$\n其中 $x^*$ 是单元 $K$ 收缩到的点。\n通常，对于任何非零点 $x^*$，$|f(x^*)|$ 是一个正常数。例如，对于我们特定的 $f(x)$，对所有 $x$ 都有 $|f(x)| \\ge 2 - 1 = 1$。当参数 $h_K$ 趋于零时，一个收敛到非零常数的量，我们称其相对于该参数是零阶的。这可以写成 $O(h_K^0)$，或简写为 $O(1)$。\n因此，缩放定律的形式为 $C \\cdot h_K^{\\alpha}$，其中 $\\alpha=0$。表示这种依赖关系的单项式是 $h_K^0$。这反映了分片线性单元的一个基本性质，即强内部残差在 $L^{\\infty}$ 范数下不收敛于零；它仅仅变为源项的局部值。", "answer": "$$\\boxed{h_{K}^{0}}$$", "id": "2594006"}, {"introduction": "在研究了单元内部残差之后，我们现在将注意力转向区域的边界，特别是施加了 Neumann 条件的地方。这个实践专注于计算边界通量残差，它衡量了施加的自然通量与有限元解的通量之间的差异 [@problem_id:2593990]。掌握这种计算对于准确评估带有规定通量或牵引力条件的问题的误差至关重要。", "problem": "考虑在区间 $(0,1)$ 上具有混合边界条件的一维二阶椭圆边值问题：求 $u$ 使得\n$$-(A u')' = f \\quad \\text{in } (0,1), \\qquad u(0)=0, \\qquad A(1)\\,u'(1)=g,$$\n其中扩散系数为 $A(x)=2+x$，源项 $f$ 是 $L^{2}(0,1)$ 中的任意函数，且 $g \\in \\mathbb{R}$。设有限元法（FEM）近似解 $u_h$ 是在节点为 $x_0=0$、$x_1=0.35$ 和 $x_2=1$ 的网格上的连续分片线性函数，其节点值为\n$$u_h(0)=0, \\qquad u_h(0.35)=0.09, \\qquad u_h(1)=0.46.$$\n假设诺伊曼（Neumann）数据为 $g=\\frac{81}{50}$。从弱形式出发，在每个单元上使用分部积分，将 $x=1$ 处的边界残差定义为边界上施加的通量与 $u_h$ 的离散通量之间的不匹配。然后，使用标准的一维基于残差的后验误差指示子缩放方法，与端点 $x=1$ 相关的边界-面贡献是边界残差的绝对值乘以相邻单元长度的平方根。\n\n计算最后一个单元 $(0.35,1)$ 在 $x=1$ 处的此边界贡献，并以单个简化的精确表达式给出最终答案。无需四舍五入。", "solution": "问题陈述经评估有效。其科学基础是偏微分方程数值分析理论，特别是有限元法的后验误差估计。该问题是适定的，为得到唯一的、可计算的结果提供了所有必要的数据和定义。问题是客观的，没有歧义。\n\n目标是计算边界点 $x=1$ 处对基于残差的后验误差指示子的边界贡献。这个贡献我们记为 $\\eta_N$，定义为边界残差 $R_N$ 的绝对值乘以相邻单元长度 $h$ 的平方根。具体来说，对于最后一个单元 $K_2 = (x_1, x_2)$，其长度为 $h_2 = x_2 - x_1$。因此，在 $x=x_2=1$ 处的边界贡献为 $\\eta_N = |R_N| h_2^{1/2}$。\n\n在 $x=1$ 处的边界残差 $R_N$ 定义为施加的通量和离散通量之间的不匹配。施加的通量由诺伊曼边界条件 $A(1)u'(1)=g$ 给出。从有限元解 $u_h$ 导出的离散通量是 $A(1)u_h'(1)$。因此，残差为：\n$$R_N = g - A(1)u_h'(1)$$\n我们现在来计算这个表达式的各个部分。\n\n首先，我们确定有限元近似解的导数 $u_h'(1)$。函数 $u_h$ 是连续的分片线性函数。在最后一个单元 $K_2 = (x_1, x_2) = (0.35, 1)$ 上，其导数是常数，等于连接点 $(x_1, u_h(x_1))$ 和 $(x_2, u_h(x_2))$ 的线段斜率。给定的节点值为 $u_h(0.35)=0.09$ 和 $u_h(1)=0.46$。\n该单元上的导数为：\n$$u_h'(x) = \\frac{u_h(x_2) - u_h(x_1)}{x_2 - x_1} = \\frac{0.46 - 0.09}{1 - 0.35} = \\frac{0.37}{0.65}$$\n为了使用精确分数进行计算，我们将其写为：\n$$u_h'(1) = \\frac{37/100}{65/100} = \\frac{37}{65}$$\n符号 $u_h'(1)$ 表示 $u_h$ 在与边界点 $x=1$ 相邻的单元上的导数。\n\n其次，我们计算扩散系数 $A(x)$ 在边界点 $x=1$ 处的值。给定的系数为 $A(x) = 2+x$。\n$$A(1) = 2+1 = 3$$\n\n第三，我们使用给定的诺伊曼数据 $g=\\frac{81}{50}$ 计算边界残差 $R_N$。\n$$R_N = g - A(1)u_h'(1) = \\frac{81}{50} - 3 \\left(\\frac{37}{65}\\right) = \\frac{81}{50} - \\frac{111}{65}$$\n为了对这两个分数进行减法运算，我们找到一个公分母。$50 = 2 \\times 5^2$ 和 $65 = 5 \\times 13$ 的最小公倍数是 $2 \\times 5^2 \\times 13 = 650$。\n$$R_N = \\frac{81 \\times 13}{650} - \\frac{111 \\times 10}{650} = \\frac{1053 - 1110}{650} = -\\frac{57}{650}$$\n\n第四，我们确定与边界相邻的单元 $K_2 = (0.35, 1)$ 的长度 $h_2$。\n$$h_2 = 1 - 0.35 = 0.65 = \\frac{65}{100} = \\frac{13}{20}$$\n\n最后，我们计算误差指示子的边界贡献 $\\eta_N$。\n$$\\eta_N = |R_N| h_2^{1/2} = \\left|-\\frac{57}{650}\\right| \\sqrt{\\frac{13}{20}} = \\frac{57}{650} \\sqrt{\\frac{13}{20}}$$\n我们继续简化这个表达式。\n$$\\eta_N = \\frac{57}{650} \\frac{\\sqrt{13}}{\\sqrt{20}} = \\frac{57}{650} \\frac{\\sqrt{13}}{\\sqrt{4 \\times 5}} = \\frac{57}{650} \\frac{\\sqrt{13}}{2\\sqrt{5}}$$\n为了使分母有理化，我们将分子和分母同乘以 $\\sqrt{5}$：\n$$\\eta_N = \\frac{57 \\sqrt{13} \\sqrt{5}}{650 \\times 2 \\sqrt{5} \\sqrt{5}} = \\frac{57 \\sqrt{65}}{1300 \\times 5} = \\frac{57 \\sqrt{65}}{6500}$$\n分子的系数 $57$ 的质因数分解是 $3 \\times 19$。分母 $6500 = 65 \\times 100 = 5 \\times 13 \\times 10^2$。没有公因数，所以该表达式已是最简形式。", "answer": "$$ \\boxed{\\frac{57\\sqrt{65}}{6500}} $$", "id": "2593990"}, {"introduction": "现在，我们将这些概念综合到一个更接近实际应用的二维非结构网格的综合问题中。这最后一个练习要求你计算单元内部残差和单元间跳跃残差，从而由局部指标组装成一个全局误差估计器 [@problem_id:2594040]。最终目标是利用这些局部指标来识别对误差贡献最大的单元，从而展示自适应网格加密的核心原理。", "problem": "考虑一个多边形区域上的带有齐次狄利克雷边界条件的标量泊松问题：寻找 $u \\in H_{0}^{1}(\\Omega)$ 使得\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \n\\qquad u = 0 \\quad \\text{on } \\partial\\Omega.\n$$\n设 $\\Omega$ 是以顶点 $V_{1}=(0,0)$、$V_{2}=(2,0)$ 和 $V_{3}=(0,1)$ 构成的三角形。考虑一个协调网格，该网格通过添加内点 $M=(0.6,0.4)$ 并将区域剖分为三个三角形而获得\n$$\nK_{1} = \\triangle(V_{1},V_{2},M), \n\\quad \nK_{2} = \\triangle(V_{2},V_{3},M),\n\\quad \nK_{3} = \\triangle(V_{3},V_{1},M).\n$$\n在此网格上使用标准的连续分片线性（即 $\\mathbb{P}_{1}$）有限元空间。设计算得到的有限元逼近 $u_{h}$ 由以下节点值给出\n$$\nu_{h}(V_{1})=0, \\quad u_{h}(V_{2})=0, \\quad u_{h}(V_{3})=0, \\quad u_{h}(M)=1.\n$$\n假设源项在每个单元上是分片常数，\n$$\nf|_{K_{1}}=1, \n\\qquad \nf|_{K_{2}}=-2, \n\\qquad \nf|_{K_{3}}=\\tfrac{1}{2}.\n$$\n采用以下几何尺度：对于每个单元 $K$，设 $h_{K}$ 为单元直径，定义为 $K$ 的最大边长；对于每条边 $E$，设 $h_{E}$ 为边长 $|E|$。考虑有限元法（FEM）的经典基于残差的后验误差估计框架，其中误差由单元残差和法向通量跨内部边的跳跃所控制。\n\n从弱形式和残差的逐单元分部积分表示出发，并使用标准的反向不等式和迹不等式来导出网格相关的权重，推导基于残差的 $\\mathbb{P}_{1}$ 单元和内部边的局部指标 $\\eta_{K}$，该指标用单元残差 $r_{K}$ 和内部边跳跃残差 $j_{E}$ 表示。然后，对于上面给出的特定 $u_{h}$、网格和 $f$，显式计算：\n- 三个局部指标 $\\eta_{K_{1}}$、$\\eta_{K_{2}}$ 和 $\\eta_{K_{3}}$，\n- 全局估计子 $\\eta = \\left(\\sum_{K} \\eta_{K}^{2}\\right)^{1/2}$，\n- 以及具有主导贡献（最大的 $\\eta_{K}$）的单元 $K$ 的索引，对于 $K_{1}$ 报告为 $1$，对于 $K_{2}$ 报告为 $2$，或对于 $K_{3}$ 报告为 $3$。\n\n将您的最终答案表示为 $\\bigl[\\eta_{K_{1}},\\,\\eta_{K_{2}},\\,\\eta_{K_{3}},\\,\\eta,\\,\\text{主导单元的索引}\\bigr]$ 顺序的单行矩阵，使用精确值（不四舍五入）。", "solution": "所述问题具有科学依据、是适定的、客观且自洽的。它提出了一个有限元法后验误差分析的标准练习。所有必要的数据和定义均已提供，没有矛盾或歧义。因此，该问题是有效的，我将着手解决它。\n\n该问题涉及区域 $\\Omega$ 上的泊松方程 $-\\Delta u = f$，带有齐次狄利克雷边界条件 $u=0$ on $\\partial\\Omega$。其弱形式是寻找 $u \\in H_0^1(\\Omega)$ 使得\n$$ a(u,v) := \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\mathbf{x} = \\int_{\\Omega} f v \\, d\\mathbf{x} =: (f,v) \\quad \\forall v \\in H_0^1(\\Omega) $$\n设 $u_h$ 是来自协调空间 $V_h \\subset H_0^1(\\Omega)$ 的有限元逼近。误差 $e = u - u_h$ 对所有 $v_h \\in V_h$ 满足伽辽金正交性条件 $a(e,v_h) = 0$。对于任意测试函数 $v \\in H_0^1(\\Omega)$，误差方程为\n$$ a(e,v) = a(u,v) - a(u_h,v) = (f,v) - a(u_h,v) $$\n我们可以通过逐单元分部积分来表示右端项：\n$$ a(e,v) = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K f v \\, d\\mathbf{x} - \\int_K \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x} \\right) = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K (f + \\Delta u_h) v \\, d\\mathbf{x} + \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds \\right) $$\n其中 $\\mathbf{n}_K$ 是单元 $K$ 边界 $\\partial K$ 的单位外法向量。由于 $u_h$ 是一个连续分片线性函数（$\\mathbb{P}_1$），其拉普拉斯算子 $\\Delta u_h$ 在每个单元 $K$ 内部为零。单元残差为 $r_K = f|_{K}$。\n边界积分之和可以分解到内部边 $\\mathcal{E}_I$ 和边界边 $\\mathcal{E}_B$ 上：\n$$ \\sum_{K \\in \\mathcal{T}_h} \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds = \\sum_{E \\in \\mathcal{E}_I} \\int_E \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket v \\, ds + \\sum_{E \\in \\mathcal{E}_B} \\int_E (\\nabla u_h \\cdot \\mathbf{n}) v \\, ds $$\n在单元 $K_+$ 和 $K_-$ 之间的内部边 $E$ 上的跳跃 $\\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket$ 是 $(\\nabla u_h)|_{K_+} \\cdot \\mathbf{n}_+ + (\\nabla u_h)|_{K_-} \\cdot \\mathbf{n}_-$。因为 $v \\in H_0^1(\\Omega)$，它在 $\\partial\\Omega$ 上的迹为零，所以边界边上的积分为零。设 $j_E = \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket$。误差方程变为：\n$$ a(e,v) = \\sum_{K \\in \\mathcal{T}_h} \\int_K r_K v \\, d\\mathbf{x} + \\sum_{E \\in \\mathcal{E}_I} \\int_E j_E v \\, ds $$\n标准的后验误差分析，使用柯西-施瓦茨不等式和迹不等式，导出了误差能量范数 $\\|e\\|_{E}^2 = a(e,e)$ 的一个上界，形式为 $\\|e\\|_{E}^2 \\le C \\sum_K \\eta_K^2$。局部误差指标 $\\eta_K$ 由下式给出\n$$ \\eta_K^2 = C_R^2 h_K^2 \\|r_K\\|_{L^2(K)}^2 + \\frac{1}{2} C_J^2 \\sum_{E \\subset \\partial K \\cap \\Omega} h_E \\|j_E\\|_{L^2(E)}^2 $$\n其中 $h_K$ 是单元直径，$h_E$ 是边长。因子 $C_R$ 和 $C_J$ 是依赖于形状正则性的常数，但在实践中通常设为 $1$。根据问题陈述，我们假设 $C_R=C_J=1$。由于源项 $f$ 和 $\\mathbb{P}_1$ 逼近 $u_h$ 的梯度在每个单元上都是常数，局部指标简化为：\n$$ \\eta_K^2 = h_K^2 (f|_K)^2 |K| + \\frac{1}{2} \\sum_{E \\subset \\partial K \\cap \\Omega} j_E^2 h_E^2 $$\n我们现在针对该特定问题计算这些量。\n\n**1. 几何属性**\n顶点为 $V_1=(0,0)$、$V_2=(2,0)$、$V_3=(0,1)$ 和 $M=(0.6,0.4)$。\n单元 $K_1=\\triangle(V_1,V_2,M)$、$K_2=\\triangle(V_2,V_3,M)$、$K_3=\\triangle(V_3,V_1,M)$ 的面积是：\n$|K_1| = \\frac{1}{2}|(2)(0.4)-(0)(0.6)| = 0.4 = \\frac{2}{5}$\n$|K_2| = \\frac{1}{2}|(2-0.6)(1-0.4) - (0-0.6)(0-0.4)| = \\frac{1}{2} |1.4 \\times 0.6 - 0.6 \\times 0.4| = 0.3 = \\frac{3}{10}$\n$|K_3| = \\frac{1}{2}|(0-0.6)(0-0.4) - (0.6-0.6)(1-0.4)| = 0.3 = \\frac{3}{10}$\n边长（$h_E = |E|$）是：\n$h_{V_1V_2}=2$, $h_{V_2V_3}=\\sqrt{(2-0)^2+(0-1)^2}=\\sqrt{5}$, $h_{V_3V_1}=1$.\n$h_{V_1M}=\\sqrt{0.6^2+0.4^2}=\\sqrt{0.52}=\\frac{\\sqrt{13}}{5}$.\n$h_{V_2M}=\\sqrt{(2-0.6)^2+(0-0.4)^2}=\\sqrt{1.4^2+0.4^2}=\\sqrt{2.12}=\\frac{\\sqrt{53}}{5}$.\n$h_{V_3M}=\\sqrt{(0-0.6)^2+(1-0.4)^2}=\\sqrt{0.6^2+0.6^2}=\\sqrt{0.72}=\\frac{3\\sqrt{2}}{5}$.\n单元直径（$h_K = \\max_{E \\subset \\partial K} h_E$）是：\n$h_{K_1}=\\max\\{2, \\frac{\\sqrt{13}}{5}, \\frac{\\sqrt{53}}{5}\\} = 2$.\n$h_{K_2}=\\max\\{\\sqrt{5}, \\frac{\\sqrt{53}}{5}, \\frac{3\\sqrt{2}}{5}\\} = \\sqrt{5}$.\n$h_{K_3}=\\max\\{1, \\frac{\\sqrt{13}}{5}, \\frac{3\\sqrt{2}}{5}\\} = 1$.\n\n**2. 有限元解的梯度**\n解 $u_h$ 由节点值 $u_h(V_1)=u_h(V_2)=u_h(V_3)=0$ 和 $u_h(M)=1$ 指定。梯度 $\\nabla u_h$ 在每个单元 $K_i$ 上是常数：\n在 $K_1=\\triangle(V_1,V_2,M)$ 上：$u_h(x,y)=ax+by+c$。从 $u_h(0,0)=0 \\implies c=0$；$u_h(2,0)=0 \\implies 2a=0 \\implies a=0$；$u_h(0.6,0.4)=1 \\implies 0.4b=1 \\implies b=5/2$。因此，$\\nabla u_h|_{K_1} = (0, \\frac{5}{2})$。\n在 $K_2=\\triangle(V_2,V_3,M)$ 上：$u_h(2,0)=0 \\implies 2a+c=0$；$u_h(0,1)=0 \\implies b+c=0$；$u_h(0.6,0.4)=1 \\implies 0.6a+0.4b+c=1$。解此方程组得到 $a=-5/3, b=-10/3, c=10/3$。因此，$\\nabla u_h|_{K_2} = (-\\frac{5}{3}, -\\frac{10}{3})$。\n在 $K_3=\\triangle(V_3,V_1,M)$ 上：$u_h(0,1)=0 \\implies b+c=0$；$u_h(0,0)=0 \\implies c=0 \\implies b=0$；$u_h(0.6,0.4)=1 \\implies 0.6a=1 \\implies a=5/3$。因此，$\\nabla u_h|_{K_3} = (\\frac{5}{3}, 0)$。\n\n**3. 跳跃残差**\n内部边为 $E_{1M} = K_1 \\cap K_3$，$E_{2M} = K_1 \\cap K_2$ 和 $E_{3M} = K_2 \\cap K_3$。\n对于 $E_{1M}$：从 $K_3$ 指向 $K_1$ 的法向量为 $\\mathbf{n}_{1M} = \\frac{1}{h_{V_1M}}(-0.4, 0.6)$。\n$j_{1M} = (\\nabla u_h|_{K_3} - \\nabla u_h|_{K_1}) \\cdot \\mathbf{n}_{1M} = ((\\frac{5}{3},0) - (0, \\frac{5}{2})) \\cdot \\frac{5}{\\sqrt{13}}(-\\frac{2}{5},\\frac{3}{5}) = (\\frac{5}{3}, -\\frac{5}{2}) \\cdot \\frac{1}{\\sqrt{13}}(-2,3) = \\frac{1}{\\sqrt{13}}(-\\frac{10}{3}-\\frac{15}{2}) = -\\frac{65}{6\\sqrt{13}} = -\\frac{5\\sqrt{13}}{6}$。\n对于 $E_{2M}$：从 $K_1$ 指向 $K_2$ 的法向量为 $\\mathbf{n}_{2M} = \\frac{1}{h_{V_2M}}(0.4, 1.4)$。\n$j_{2M} = (\\nabla u_h|_{K_1} - \\nabla u_h|_{K_2}) \\cdot \\mathbf{n}_{2M} = ((0, \\frac{5}{2}) - (-\\frac{5}{3},-\\frac{10}{3})) \\cdot \\frac{5}{\\sqrt{53}}(\\frac{2}{5},\\frac{7}{5}) = (\\frac{5}{3}, \\frac{35}{6}) \\cdot \\frac{1}{\\sqrt{53}}(2,7) = \\frac{1}{\\sqrt{53}}(\\frac{10}{3}+\\frac{245}{6}) = \\frac{265}{6\\sqrt{53}} = \\frac{5\\sqrt{53}}{6}$。\n对于 $E_{3M}$：从 $K_2$ 指向 $K_3$ 的法向量为 $\\mathbf{n}_{3M} = \\frac{1}{h_{V_3M}}(0.6, 0.6)$。\n$j_{3M} = (\\nabla u_h|_{K_2} - \\nabla u_h|_{K_3}) \\cdot \\mathbf{n}_{3M} = ((-\\frac{5}{3},-\\frac{10}{3}) - (\\frac{5}{3},0)) \\cdot \\frac{1}{0.6\\sqrt{2}}(0.6,0.6) = (-\\frac{10}{3},-\\frac{10}{3}) \\cdot \\frac{1}{\\sqrt{2}}(1,1) = -\\frac{20}{3\\sqrt{2}} = -\\frac{10\\sqrt{2}}{3}$。\n\n**4. 局部指标**\n我们计算 $\\eta_K^2$ 的两个部分：单元残差项 $h_K^2 (f|_K)^2 |K|$ 和跳跃项 $\\frac{1}{2} \\sum j_E^2 h_E^2$。\n源项：$f|_{K_1} = 1$，$f|_{K_2} = -2$，$f|_{K_3} = 1/2$。\n跳跃项的平方 $j_E^2 h_E^2$：\n$j_{1M}^2 h_{1M}^2 = (-\\frac{5\\sqrt{13}}{6})^2 (\\frac{\\sqrt{13}}{5})^2 = \\frac{25 \\cdot 13}{36} \\frac{13}{25} = \\frac{169}{36}$。\n$j_{2M}^2 h_{2M}^2 = (\\frac{5\\sqrt{53}}{6})^2 (\\frac{\\sqrt{53}}{5})^2 = \\frac{25 \\cdot 53}{36} \\frac{53}{25} = \\frac{2809}{36}$。\n$j_{3M}^2 h_{3M}^2 = (-\\frac{10\\sqrt{2}}{3})^2 (\\frac{3\\sqrt{2}}{5})^2 = \\frac{200}{9} \\frac{18}{25} = 16$。\n\n对于 $K_1$：\n$\\eta_{K_1}^2 = (2)^2 (1)^2 (\\frac{2}{5}) + \\frac{1}{2}(j_{1M}^2 h_{1M}^2 + j_{2M}^2 h_{2M}^2) = \\frac{8}{5} + \\frac{1}{2}(\\frac{169}{36} + \\frac{2809}{36}) = \\frac{8}{5} + \\frac{2978}{72} = \\frac{8}{5} + \\frac{1489}{36} = \\frac{288+7445}{180} = \\frac{7733}{180}$。\n$\\eta_{K_1} = \\sqrt{\\frac{7733}{180}} = \\frac{\\sqrt{7733}}{6\\sqrt{5}} = \\frac{\\sqrt{38665}}{30}$。\n\n对于 $K_2$：\n$\\eta_{K_2}^2 = (\\sqrt{5})^2 (-2)^2 (\\frac{3}{10}) + \\frac{1}{2}(j_{2M}^2 h_{2M}^2 + j_{3M}^2 h_{3M}^2) = 5 \\cdot 4 \\cdot \\frac{3}{10} + \\frac{1}{2}(\\frac{2809}{36} + 16) = 6 + \\frac{1}{2}(\\frac{2809+576}{36}) = 6 + \\frac{3385}{72} = \\frac{432+3385}{72} = \\frac{3817}{72}$。\n$\\eta_{K_2} = \\sqrt{\\frac{3817}{72}} = \\frac{\\sqrt{3817}}{6\\sqrt{2}} = \\frac{\\sqrt{7634}}{12}$。\n\n对于 $K_3$：\n$\\eta_{K_3}^2 = (1)^2 (\\frac{1}{2})^2 (\\frac{3}{10}) + \\frac{1}{2}(j_{3M}^2 h_{3M}^2 + j_{1M}^2 h_{1M}^2) = \\frac{3}{40} + \\frac{1}{2}(16 + \\frac{169}{36}) = \\frac{3}{40} + \\frac{1}{2}(\\frac{576+169}{36}) = \\frac{3}{40} + \\frac{745}{72} = \\frac{27+3725}{360} = \\frac{3752}{360} = \\frac{469}{45}$。\n$\\eta_{K_3} = \\sqrt{\\frac{469}{45}} = \\frac{\\sqrt{469}}{3\\sqrt{5}} = \\frac{\\sqrt{2345}}{15}$。\n\n**5. 全局估计子和主导单元**\n全局估计子 $\\eta$ 由 $\\eta^2 = \\sum_K \\eta_K^2$ 给出。\n$\\eta^2 = \\frac{7733}{180} + \\frac{3817}{72} + \\frac{469}{45} = \\frac{2 \\cdot 7733}{360} + \\frac{5 \\cdot 3817}{360} + \\frac{8 \\cdot 469}{360} = \\frac{15466 + 19085 + 3752}{360} = \\frac{38303}{360}$。\n$\\eta = \\sqrt{\\frac{38303}{360}} = \\frac{\\sqrt{38303}}{6\\sqrt{10}} = \\frac{\\sqrt{383030}}{60}$。\n\n为了找到主导单元，我们比较 $\\eta_{K_1}^2$、$\\eta_{K_2}^2$ 和 $\\eta_{K_3}^2$。\n$\\eta_{K_1}^2 = \\frac{7733}{180} = \\frac{15466}{360}$。\n$\\eta_{K_2}^2 = \\frac{3817}{72} = \\frac{19085}{360}$。\n$\\eta_{K_3}^2 = \\frac{469}{45} = \\frac{3752}{360}$。\n因为 $19085 > 15466 > 3752$，所以最大的指标是 $\\eta_{K_2}$。主导单元的索引是 $2$。\n\n最终结果被组合成所要求的矩阵格式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{38665}}{30} & \\frac{\\sqrt{7634}}{12} & \\frac{\\sqrt{2345}}{15} & \\frac{\\sqrt{383030}}{60} & 2 \\end{pmatrix}}\n$$", "id": "2594040"}]}