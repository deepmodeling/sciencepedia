{"hands_on_practices": [{"introduction": "要想真正掌握伽辽金正交性，没有什么比亲眼见证其运作过程更有效了。第一个练习将引导您从头开始，对一个一维问题进行完整（尽管简单）的有限元计算。通过组装系统并明确计算残差，您将验证正交性原理，它不是一个抽象的定理，而是该方法机制的直接结果[@problem_id:2561440]。", "problem": "考虑定义在区间 $[0,1]$ 上的边值问题：求满足 $-u'' = f$ 的 $u$，边界条件为 $u(0)=0$ 和 $u(1)=0$，其中 $f(x) = 1$。其变分形式为：寻求 $u \\in H_0^1(0,1)$，使得\n$$\na(u,v) = \\ell(v) \\quad \\text{对所有 } v \\in H_0^1(0,1),\n$$\n其中双线性形式和线性泛函分别为\n$$\na(u,v) := \\int_0^1 u'(x) v'(x)\\,dx, \n\\qquad \n\\ell(v) := \\int_0^1 f(x)\\,v(x)\\,dx.\n$$\n设 $V_h \\subset H_0^1(0,1)$ 是在均匀网格上的连续分片线性有限元空间（有限元方法 FEM），其节点为 $x_0=0$、$x_1=\\frac{1}{3}$、$x_2=\\frac{2}{3}$、$x_3=1$。用 $\\{\\phi_1, \\phi_2\\}$ 表示与内部节点 $x_1=\\frac{1}{3}$ 和 $x_2=\\frac{2}{3}$ 分别关联的 $V_h$ 的节点基。Galerkin 近似解 $u_h \\in V_h$ 满足\n$$\na(u_h, v_h) = \\ell(v_h) \\quad \\text{对所有 } v_h \\in V_h.\n$$\n任务：\n- 组装刚度矩阵 $K \\in \\mathbb{R}^{2 \\times 2}$ 和载荷向量 $F \\in \\mathbb{R}^{2}$，其元素为 $K_{ij} := a(\\phi_j,\\phi_i)$ 和 $F_i := \\ell(\\phi_i)$，计算过程仅使用上述定义以及网格和基的具体信息。\n- 求解组装好的线性系统，以获得 $u_h = u_1 \\phi_1 + u_2 \\phi_2$ 的系数向量 $U_h = (u_1, u_2)^{\\top}$。\n- 定义弱残差泛函 $R: V_h \\to \\mathbb{R}$ 为 $R(v_h) := a(u_h, v_h) - \\ell(v_h)$。通过计算定义 $a(\\cdot,\\cdot)$ 和 $\\ell(\\cdot)$ 的积分来显式计算 $R(\\phi_1)$ 和 $R(\\phi_2)$。使用这些值来验证对所有 $v_h \\in V_h$ 成立的 Galerkin 正交性 $R(v_h)=0$。\n- 令\n$$\nE := |R(\\phi_1)|^2 + |R(\\phi_2)|^2.\n$$\n提供 $E$ 的值作为你的最终答案。无需四舍五入，也不应包含任何单位。", "solution": "空间 $V_h$ 的节点基函数 $\\{\\phi_1, \\phi_2\\}$ 是分片线性的“帽子”函数。给定网格节点 $x_0=0$、$x_1=\\frac{1}{3}$、$x_2=\\frac{2}{3}$、$x_3=1$，$\\phi_1(x)$ 和 $\\phi_2(x)$ 的显式表达式为：\n$$\n\\phi_1(x) = \\begin{cases} 3x,  x \\in [0, \\frac{1}{3}] \\\\ 2 - 3x,  x \\in [\\frac{1}{3}, \\frac{2}{3}] \\\\ 0,  \\text{其他} \\end{cases}\n\\quad \\text{和} \\quad\n\\phi_2(x) = \\begin{cases} 3x - 1,  x \\in [\\frac{1}{3}, \\frac{2}{3}] \\\\ 3 - 3x,  x \\in [\\frac{2}{3}, 1] \\\\ 0,  \\text{其他} \\end{cases}\n$$\n它们的导数是分片常数：\n$$\n\\phi_1'(x) = \\begin{cases} 3,  x \\in (0, \\frac{1}{3}) \\\\ -3,  x \\in (\\frac{1}{3}, \\frac{2}{3}) \\\\ 0,  \\text{其他} \\end{cases}\n\\quad \\text{和} \\quad\n\\phi_2'(x) = \\begin{cases} 3,  x \\in (\\frac{1}{3}, \\frac{2}{3}) \\\\ -3,  x \\in (\\frac{2}{3}, 1) \\\\ 0,  \\text{其他} \\end{cases}\n$$\n第一个任务是组装刚度矩阵 $K$ 和载荷向量 $F$。刚度矩阵的元素 $K_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_j'(x) \\phi_i'(x) dx$ 计算如下：\n$$\nK_{11} = a(\\phi_1, \\phi_1) = \\int_0^1 (\\phi_1'(x))^2 dx = \\int_0^{1/3} (3)^2 dx + \\int_{1/3}^{2/3} (-3)^2 dx = 9\\left(\\frac{1}{3}\\right) + 9\\left(\\frac{1}{3}\\right) = 6\n$$\n$$\nK_{22} = a(\\phi_2, \\phi_2) = \\int_0^1 (\\phi_2'(x))^2 dx = \\int_{1/3}^{2/3} (3)^2 dx + \\int_{2/3}^{1} (-3)^2 dx = 9\\left(\\frac{1}{3}\\right) + 9\\left(\\frac{1}{3}\\right) = 6\n$$\n$$\nK_{12} = a(\\phi_2, \\phi_1) = \\int_0^1 \\phi_2'(x) \\phi_1'(x) dx = \\int_{1/3}^{2/3} (3)(-3) dx = -9\\left(\\frac{1}{3}\\right) = -3\n$$\n由于双线性形式 $a(\\cdot, \\cdot)$ 是对称的，所以 $K_{21} = a(\\phi_1, \\phi_2) = K_{12} = -3$。因此，刚度矩阵为：\n$$\nK = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}\n$$\n载荷向量的元素 $F_i = \\ell(\\phi_i) = \\int_0^1 f(x) \\phi_i(x) dx$（其中 $f(x)=1$）计算如下：\n$$\nF_1 = \\ell(\\phi_1) = \\int_0^1 \\phi_1(x) dx = \\int_0^{1/3} 3x \\,dx + \\int_{1/3}^{2/3} (2-3x) \\,dx = \\left[\\frac{3x^2}{2}\\right]_0^{1/3} + \\left[2x - \\frac{3x^2}{2}\\right]_{1/3}^{2/3} = \\frac{1}{6} + \\left( \\left(\\frac{4}{3} - \\frac{2}{3}\\right) - \\left(\\frac{2}{3} - \\frac{1}{6}\\right) \\right) = \\frac{1}{3}\n$$\n$$\nF_2 = \\ell(\\phi_2) = \\int_0^1 \\phi_2(x) dx = \\int_{1/3}^{2/3} (3x-1) \\,dx + \\int_{2/3}^{1} (3-3x) \\,dx = \\left[\\frac{3x^2}{2} - x\\right]_{1/3}^{2/3} + \\left[3x - \\frac{3x^2}{2}\\right]_{2/3}^{1} = \\left( \\left(\\frac{2}{3} - \\frac{2}{3}\\right) - \\left(\\frac{1}{6} - \\frac{1}{3}\\right) \\right) + \\left( \\left(3 - \\frac{3}{2}\\right) - \\left(2 - \\frac{2}{3}\\right) \\right) = \\frac{1}{3}\n$$\n因此，载荷向量为：\n$$\nF = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}\n$$\n下一个任务是求解线性系统 $K U_h = F$，以得到系数向量 $U_h = (u_1, u_2)^\\top$：\n$$\n\\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}\n$$\n$K$ 的逆矩阵是 $K^{-1} = \\frac{1}{\\det(K)} \\begin{pmatrix} 6  3 \\\\ 3  6 \\end{pmatrix}$，其中 $\\det(K) = (6)(6) - (-3)(-3) = 36-9=27$。\n$$\nK^{-1} = \\frac{1}{27} \\begin{pmatrix} 6  3 \\\\ 3  6 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n求解 $U_h$：\n$$\nU_h = K^{-1}F = \\frac{1}{9} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} \\frac{2}{3} + \\frac{1}{3} \\\\ \\frac{1}{3} + \\frac{2}{3} \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{9} \\\\ \\frac{1}{9} \\end{pmatrix}\n$$\n所以，$u_1 = \\frac{1}{9}$ 且 $u_2 = \\frac{1}{9}$，伽辽金解为 $u_h(x) = \\frac{1}{9}\\phi_1(x) + \\frac{1}{9}\\phi_2(x)$。\n\n第三个任务是为基函数 $v_h=\\phi_1$ 和 $v_h=\\phi_2$ 计算弱残差 $R(v_h) = a(u_h, v_h) - \\ell(v_h)$。\n对于 $v_h=\\phi_1$：\n$$\nR(\\phi_1) = a(u_h, \\phi_1) - \\ell(\\phi_1) = a\\left(\\frac{1}{9}\\phi_1 + \\frac{1}{9}\\phi_2, \\phi_1\\right) - \\ell(\\phi_1)\n$$\n根据 $a(\\cdot,\\cdot)$ 的线性性质和刚度矩阵的定义：\n$$\na(u_h, \\phi_1) = u_1 a(\\phi_1, \\phi_1) + u_2 a(\\phi_2, \\phi_1) = \\frac{1}{9} K_{11} + \\frac{1}{9} K_{12} = \\frac{1}{9}(6) + \\frac{1}{9}(-3) = \\frac{3}{9} = \\frac{1}{3}\n$$\n我们之前计算过 $\\ell(\\phi_1) = F_1 = \\frac{1}{3}$。因此，\n$$\nR(\\phi_1) = \\frac{1}{3} - \\frac{1}{3} = 0\n$$\n对于 $v_h=\\phi_2$：\n$$\nR(\\phi_2) = a(u_h, \\phi_2) - \\ell(\\phi_2) = a\\left(\\frac{1}{9}\\phi_1 + \\frac{1}{9}\\phi_2, \\phi_2\\right) - \\ell(\\phi_2)\n$$\n根据线性性质和刚度矩阵的定义：\n$$\na(u_h, \\phi_2) = u_1 a(\\phi_1, \\phi_2) + u_2 a(\\phi_2, \\phi_2) = \\frac{1}{9} K_{21} + \\frac{1}{9} K_{22} = \\frac{1}{9}(-3) + \\frac{1}{9}(6) = \\frac{3}{9} = \\frac{1}{3}\n$$\n我们之前计算过 $\\ell(\\phi_2) = F_2 = \\frac{1}{3}$。因此，\n$$\nR(\\phi_2) = \\frac{1}{3} - \\frac{1}{3} = 0\n$$\n伽辽金正交性指出，对于所有 $v_h \\in V_h$，有 $a(u_h, v_h) - \\ell(v_h) = 0$。任何 $v_h \\in V_h$ 都可以写成 $v_h = c_1 \\phi_1 + c_2 \\phi_2$。残差泛函 $R$ 是线性的，所以 $R(v_h) = R(c_1 \\phi_1 + c_2 \\phi_2) = c_1 R(\\phi_1) + c_2 R(\\phi_2)$。由于我们已经显式计算出 $R(\\phi_1)=0$ 和 $R(\\phi_2)=0$，因此对于所有 $v_h \\in V_h$ 都有 $R(v_h)=0$，从而验证了该性质。\n\n最后，我们计算 $E := |R(\\phi_1)|^2 + |R(\\phi_2)|^2$。使用计算出的值：\n$$\nE = |0|^2 + |0|^2 = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "2561440"}, {"introduction": "伽辽金正交性不仅是一个优美的数学性质，它也是有限元方法之所以如此出色的关键。本练习将引导您推导塞阿引理(Céa's Lemma)，从而探索伽辽金正交性与其最重要的推论——最佳逼近性质之间的联系[@problem_id:2561496]。您还将通过为一个具体的扩散问题计算其误差界中的相关常数，从而将这个抽象的理论具体化，并揭示逼近的质量是如何依赖于底层偏微分方程的性质的。", "problem": "考虑单位区间上具有可变扩散系数的一维泊松边值问题。令 $V := H_{0}^{1}(0,1)$，并定义双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $\\ell(\\cdot)$ 如下：\n$$\na(u,v) := \\int_{0}^{1} p(x)\\, u'(x)\\, v'(x)\\, dx, \\qquad \\ell(v) := \\int_{0}^{1} f(x)\\, v(x)\\, dx,\n$$\n其中 $p \\in L^{\\infty}(0,1)$ 几乎处处满足 $p(x) \\geq p_{\\min}  0$。该模型问题的弱形式为：求 $u \\in V$ 使得\n$$\na(u,v) = \\ell(v) \\quad \\text{for all } v \\in V.\n$$\n令 $V_{h} \\subset V$ 为在 $[0,1]$ 的一个具有 $N$ 个等长子区间的均匀网格上的协调分片线性拉格朗日有限元空间，并令 $u_{h} \\in V_{h}$ 解离散问题\n$$\na(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\text{for all } v_{h} \\in V_{h}.\n$$\n在 $V$ 上采用能量半范数 $\\|v\\|_{E} := \\left(\\int_{0}^{1} |v'(x)|^{2}\\, dx\\right)^{1/2}$。仅从 $a(\\cdot,\\cdot)$ 关于 $\\|\\cdot\\|_{E}$ 的连续性和强制性的定义出发（即，存在常数 $\\alpha  0$ 和 $M \\geq \\alpha$ 使得对所有 $v \\in V$ 有 $a(v,v) \\geq \\alpha \\|v\\|_{E}^{2}$，且对所有 $w,z \\in V$ 有 $|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$），进行一个具体的推导，该推导需要：\n- 建立伽辽金正交性 $a(u-u_{h}, v_{h}) = 0$ 对所有 $v_{h} \\in V_{h}$ 成立，\n- 并证明能量半范数下的最佳逼近界，\n$$\n\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{E}.\n$$\n\n然后，将问题具体化到在 $[0,1]$ 上的显式扩散系数 $p(x) := 1 + x$。仅使用上述定义，并且不借助这些定义之外的任何捷径，计算关于 $\\|\\cdot\\|_{E}$ 的连续性常数和强制性常数的精确值，并由此确定对于此 $p(x)$，比值 $M/\\alpha$ 的精确值。请以单个实数的形式提供您的最终答案。不需要单位。请勿对答案进行四舍五入。", "solution": "我们首先按要求推导伽辽金方法的一般性质。\n\n问题的弱形式是求 $u \\in V$ 使得\n$$a(u,v) = \\ell(v) \\quad \\forall v \\in V.$$\n有限元逼近是求 $u_{h} \\in V_{h}$ 使得\n$$a(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\n此处，$V = H_{0}^{1}(0,1)$ 且 $V_{h}$ 是一个协调的有限维子空间，即 $V_{h} \\subset V$。\n\n**1. 伽辽金正交性的推导**\n\n伽辽金正交性建立了误差 $e = u - u_{h}$ 与离散空间 $V_{h}$ 之间的关系。\n由于 $V_{h} \\subset V$，精确解 $u$ 的弱形式也必须对任何检验函数 $v_{h} \\in V_{h}$ 成立。因此，我们有\n$$a(u, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\n同时，我们有由 $u_{h}$ 满足的离散问题：\n$$a(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\n将第二个方程从第一个方程中减去，得到\n$$a(u, v_{h}) - a(u_{h}, v_{h}) = 0 \\quad \\forall v_{h} \\in V_{h}.$$\n根据双线性形式 $a(\\cdot, \\cdot)$ 对其第一个参数的线性性，我们可以合并这些项：\n$$a(u - u_{h}, v_{h}) = 0 \\quad \\forall v_{h} \\in V_{h}.$$\n这就是伽辽金正交性。\n\n**2. 最佳逼近界（Céa引理）的推导**\n\n这个结果为有限元解的误差提供了一个上界，其推导依赖于伽辽金正交性和双线性形式的假设性质。\n\n令 $e = u - u_{h}$ 为误差。根据 $a(\\cdot, \\cdot)$ 关于能量半范数 $\\| \\cdot \\|_{E}$ 的强制性定义，对于任何 $v \\in V$ 我们有：\n$$a(v,v) \\geq \\alpha \\|v\\|_{E}^{2},$$\n其中 $\\alpha  0$ 是强制性常数。将此应用于误差 $e = u-u_h \\in V$，我们得到\n$$\\alpha \\|u - u_{h}\\|_{E}^{2} \\leq a(u - u_{h}, u - u_{h}).$$\n现在，对于任意一个函数 $v_{h} \\in V_{h}$，我们可以写出 $u - u_h = (u - v_h) + (v_h - u_h)$。利用 $a(\\cdot, \\cdot)$ 的双线性性，我们有\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, (u - v_{h}) + (v_{h} - u_{h})) = a(u - u_{h}, u - v_{h}) + a(u - u_{h}, v_{h} - u_{h}).$$\n项 $v_{h} - u_{h}$ 是子空间 $V_{h}$ 中两个函数的差，由于 $V_{h}$ 是一个向量空间，所以 $v_{h} - u_{h} \\in V_{h}$。根据上面推导的伽辽金正交性，第二项为零：\n$$a(u - u_{h}, v_{h} - u_{h}) = 0.$$\n这将表达式简化为\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, u - v_{h}).$$\n现在我们应用双线性形式 $a(\\cdot, \\cdot)$ 的连续性，其定义为\n$$|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$$\n其中常数 $M \\geq \\alpha$。应用此不等式，我们得到\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, u - v_{h}) \\leq |a(u - u_{h}, u - v_{h})| \\leq M \\|u - u_{h}\\|_{E} \\|u - v_{h}\\|_{E}.$$\n结合我们的不等式，我们有：\n$$\\alpha \\|u - u_{h}\\|_{E}^{2} \\leq a(u - u_{h}, u - u_{h}) \\leq M \\|u - u_{h}\\|_{E} \\|u - v_{h}\\|_{E}.$$\n如果 $\\|u - u_{h}\\|_{E} = 0$，则所求不等式平凡成立。如果 $\\|u - u_{h}\\|_{E}  0$，我们可以两边除以 $\\alpha \\|u - u_{h}\\|_{E}$ 得到\n$$\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\|u - v_{h}\\|_{E}.$$\n这个不等式对任意的 $v_{h} \\in V_{h}$ 都成立。因此，我们可以在右边对 $V_{h}$ 中所有可能的 $v_{h}$ 取下确界，从而得到最佳逼近界：\n$$\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{E}.$$\n这就完成了推导。\n\n接下来，我们计算在 $p(x) = 1+x$ 的特定情况下常数 $\\alpha$ 和 $M$ 的显式值。\n\n**3. 强制性常数 $\\alpha$ 的计算**\n\n强制性常数 $\\alpha$ 是使得对所有 $v \\in V = H_0^1(0,1)$ 都有 $a(v,v) \\geq \\alpha \\|v\\|_{E}^{2}$ 的最大实数。\n$$\\alpha = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{a(v,v)}{\\|v\\|_{E}^{2}} = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} p(x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx} = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} (1+x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\n该表达式可被视为函数 $p(x)=1+x$ 以非负权函数 $|v'(x)|^2$ 的加权平均。该加权平均的下确界是被加权函数的本性下确界。\n$$\\alpha = \\underset{x \\in (0,1)}{\\mathrm{ess\\,inf}} \\, p(x) = \\underset{x \\in (0,1)}{\\mathrm{ess\\,inf}} \\, (1+x).$$\n由于 $p(x)=1+x$ 在闭区间 $[0,1]$ 上是连续函数，其本性下确界就是它的最小值，在 $x=0$ 处取得。\n$$\\alpha = \\min_{x \\in [0,1]} (1+x) = 1+0 = 1.$$\n\n**4. 连续性常数 $M$ 的计算**\n\n连续性常数 $M$ 是使得对所有 $w,z \\in V$ 都有 $|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$ 的最小实数。\n$$M = \\sup_{w,z \\in V \\setminus \\{0\\}} \\frac{|a(w,z)|}{\\|w\\|_{E}\\|z\\|_{E}} = \\sup_{w,z \\in V \\setminus \\{0\\}} \\frac{|\\int_{0}^{1} p(x) w'(x) z'(x) dx|}{\\left(\\int_{0}^{1} |w'(x)|^{2} dx\\right)^{1/2} \\left(\\int_{0}^{1} |z'(x)|^{2} dx\\right)^{1/2}}.$$\n对于一个实的、对称的双线性形式，上确界在 $w=z$ 时达到。因此，\n$$M = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{|a(v,v)|}{\\|v\\|_{E}^{2}} = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} p(x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\n代入 $p(x)=1+x$：\n$$M = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} (1+x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\n与强制性常数类似，该表达式的上确界是函数 $p(x)$ 的本性上确界。\n$$M = \\underset{x \\in (0,1)}{\\mathrm{ess\\,sup}} \\, p(x) = \\underset{x \\in (0,1)}{\\mathrm{ess\\,sup}} \\, (1+x).$$\n由于 $p(x)=1+x$ 是连续的，其本性上确界就是它在 $[0,1]$ 上的最大值，在 $x=1$ 处取得。\n$$M = \\max_{x \\in [0,1]} (1+x) = 1+1 = 2.$$\n\n**5. 最终比值**\n\n问题要求比值 $M/\\alpha$ 的精确值。使用计算出的常数：\n$$ \\frac{M}{\\alpha} = \\frac{2}{1} = 2. $$", "answer": "$$\n\\boxed{2}\n$$", "id": "2561496"}, {"introduction": "理解一个原理的有效方法是观察当其基本假设被打破时会发生什么。最后一个练习将研究一个“非协调”的情景，其中离散函数空间包含不连续性，这违反了 $V_h \\subset V$ 的条件[@problem_id:2561497]。您会发现，标准的伽辽金正交性不再成立，取而代之的是一个涉及界面不一致性误差的新关系，从而突显了协调性在标准有限元理论中的关键作用。", "problem": "设 $V := H_{0}^{1}(0,1)$，考虑一维线性偏微分方程（PDE）的边值问题\n$$\n-u'' = x \\quad \\text{in } (0,1), \\qquad u(0)=u(1)=0,\n$$\n其弱形式为：求 $u \\in V$，使得\n$$\na(u,v) = \\ell(v) \\quad \\text{对所有 } v \\in V,\n$$\n其中\n$$\na(w,v) := \\int_{0}^{1} w'(x)\\,v'(x)\\,dx, \n\\qquad \n\\ell(v) := \\int_{0}^{1} x\\,v(x)\\,dx.\n$$\n定义一个非协调离散空间 $V_{h}$\n$$\nV_{h} := \\left\\{ v_{h} \\,\\middle|\\, v_{h}\\big|_{(0,\\frac{1}{2})} \\text{ 和 } v_{h}\\big|_{(\\frac{1}{2},1)} \\text{ 是线性的, } v_{h}(0)=0,\\ v_{h}(1)=0 \\right\\},\n$$\n在 $x=\\tfrac{1}{2}$ 处不强制连续性。设基函数 $\\{\\varphi_{L},\\varphi_{R}\\} \\subset V_{h}$ 定义为\n$$\n\\varphi_{L}(x) := \n\\begin{cases}\n2x,  x \\in [0,\\tfrac{1}{2}],\\\\\n0,  x \\in (\\tfrac{1}{2},1],\n\\end{cases}\n\\qquad\n\\varphi_{R}(x) := \n\\begin{cases}\n0,  x \\in [0,\\tfrac{1}{2}),\\\\\n2(1-x),  x \\in [\\tfrac{1}{2},1].\n\\end{cases}\n$$\n考虑朴素的非协调有限元法（FEM），其定义为：求 $u_{h} \\in V_{h}$，使得\n$$\na_{h}(u_{h},v_{h}) = \\ell(v_{h}) \\quad \\text{对所有 } v_{h} \\in V_{h},\n$$\n其中\n$$\na_{h}(w_{h},v_{h}) := \\int_{0}^{\\frac{1}{2}} w_{h}'(x)\\,v_{h}'(x)\\,dx \\;+\\; \\int_{\\frac{1}{2}}^{1} w_{h}'(x)\\,v_{h}'(x)\\,dx.\n$$\n任务：\n1) 从强形式偏微分方程和边界条件出发，确定精确解 $u$。\n2) 将 $u_{h} \\in V_{h}$ 参数化为在 $[0,\\tfrac{1}{2}]$ 上 $u_{h}(x) = \\alpha x$ 和在 $[\\tfrac{1}{2},1]$ 上 $u_{h}(x) = \\beta(1-x)$，并用 $\\varphi_{L}$ 和 $\\varphi_{R}$ 测试离散方程，从而确定系数 $\\alpha$ 和 $\\beta$。\n3) 仅使用上述定义，计算伽辽金正交性残量\n$$\n\\delta := a(u-u_{h},\\varphi_{L}).\n$$\n4) 精确指出常规伽辽金正交性证明（即推导得出对所有 $v_{h}$ 都有 $a(u-u_{h},v_{h})=0$）的哪一步在此处不适用，因为 $V_{h} \\not\\subset V$，并写出本例中取而代之的界面相容性项；验证它等于你计算出的 $\\delta$ 值。\n\n将单一实数 $\\delta$ 作为你的最终答案，以精确形式报告（不要四舍五入）。不需要单位。", "solution": "我们将按顺序解决这四个任务。\n\n**1. 确定精确解 $u$**\n\n强形式问题为 $-u'' = x$，边界条件为 $u(0)=0$ 和 $u(1)=0$。对微分方程积分两次：\n$$\n-u'(x) = \\frac{x^2}{2} + C_1 \\implies -u(x) = \\frac{x^3}{6} + C_1 x + C_2\n$$\n应用边界条件 $u(0)=0$ 得 $C_2=0$。应用 $u(1)=0$ 得 $-\\frac{1}{6} - C_1 = 0$，即 $C_1 = -\\frac{1}{6}$。因此，精确解为：\n$$\nu(x) = \\frac{x - x^3}{6}\n$$\n其导数为：\n$$\nu'(x) = \\frac{1 - 3x^2}{6}\n$$\n\n**2. 确定离散解 $u_h$**\n\n离散解 $u_h \\in V_h$ 求解 $a_h(u_h,v_h) = \\ell(v_h)$。我们用基函数 $\\{\\varphi_L, \\varphi_R\\}$ 对该方程进行测试。离散解在 $[0,\\tfrac{1}{2}]$ 上为 $u_h(x) = \\alpha x$，在 $[\\tfrac{1}{2},1]$ 上为 $u_h(x) = \\beta(1-x)$。其导数分别为 $\\alpha$ 和 $-\\beta$。\n\n用 $v_h = \\varphi_L$ 测试：\n$$\na_h(u_h, \\varphi_L) = \\int_0^{\\frac{1}{2}} (\\alpha)(2)\\,dx = \\alpha\n$$\n$$\n\\ell(\\varphi_L) = \\int_0^{\\frac{1}{2}} x(2x) dx = 2\\left[\\frac{x^3}{3}\\right]_0^{\\frac{1}{2}} = 2\\left(\\frac{1}{24}\\right) = \\frac{1}{12}\n$$\n因此，$\\alpha = \\frac{1}{12}$。\n\n用 $v_h = \\varphi_R$ 测试：\n$$\na_h(u_h, \\varphi_R) = \\int_{\\frac{1}{2}}^1 (-\\beta)(-2)\\,dx = \\beta\n$$\n$$\n\\ell(\\varphi_R) = \\int_{\\frac{1}{2}}^1 x(2(1-x)) dx = 2\\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{\\frac{1}{2}}^1 = 2\\left[ \\left(\\frac{1}{2}-\\frac{1}{3}\\right) - \\left(\\frac{1}{8} - \\frac{1}{24}\\right) \\right] = 2\\left[ \\frac{1}{6} - \\frac{1}{12} \\right] = \\frac{1}{6}\n$$\n因此，$\\beta = \\frac{1}{6}$。\n离散解为在 $[0,\\tfrac{1}{2}]$ 上 $u_h(x) = \\frac{1}{12}x$，在 $[\\tfrac{1}{2},1]$ 上 $u_h(x) = \\frac{1}{6}(1-x)$。\n\n**3. 计算伽辽金正交性残量 $\\delta$**\n\n残量定义为 $\\delta := a(u-u_h,\\varphi_{L})$。由于当 $x > \\frac{1}{2}$ 时 $\\varphi_L'(x) = 0$，积分简化到区间 $(0, \\frac{1}{2})$：\n$$\n\\delta = \\int_0^{\\frac{1}{2}} (u'(x) - u_h'(x))\\varphi_L'(x) dx\n$$\n在这个区间上，我们有 $u'(x) = \\frac{1-3x^2}{6}$，$u_h'(x) = \\alpha = \\frac{1}{12}$，以及 $\\varphi_L'(x) = 2$。\n$$\n\\delta = \\int_0^{\\frac{1}{2}} \\left( \\frac{1-3x^2}{6} - \\frac{1}{12} \\right) (2) dx = \\frac{1}{6} \\int_0^{\\frac{1}{2}} (2(1-3x^2) - 1) dx = \\frac{1}{6} \\int_0^{\\frac{1}{2}} (1 - 6x^2) dx\n$$\n计算积分：\n$$\n\\delta = \\frac{1}{6} \\left[ x - 2x^3 \\right]_0^{\\frac{1}{2}} = \\frac{1}{6} \\left( \\frac{1}{2} - 2\\left(\\frac{1}{8}\\right) \\right) = \\frac{1}{6} \\left( \\frac{1}{2} - \\frac{1}{4} \\right) = \\frac{1}{6} \\left( \\frac{1}{4} \\right) = \\frac{1}{24}\n$$\n\n**4. 伽辽金正交性失效分析**\n\n对于标准的协调方法，其中 $V_h \\subset V=H_0^1(0,1)$，伽辽金正交性 $a(u-u_h, v_h) = 0$ 成立。证明的关键一步是 $a(u, v_h) = \\ell(v_h)$，这是因为 $v_h$ 是 $V$ 中的有效测试函数。\n**此步骤在此处不适用**，因为 $V_h \\not\\subset V$。$V_h$ 中的函数（如 $\\varphi_L$）在 $x=\\frac{1}{2}$ 处不连续，因此不属于 $H_0^1(0,1)$ 空间。我们不能直接在连续弱形式中将 $v_h$ 作为测试函数。\n\n取而代之的关系可以通过对 $-u''=x$ 两边乘以 $v_h \\in V_h$ 并按单元进行分部积分得到：\n$$\n\\ell(v_h) = \\int_0^1 (-u'') v_h dx = \\int_0^{\\frac{1}{2}} u' v_h' dx + \\int_{\\frac{1}{2}}^1 u' v_h' dx - [u'v_h]_0^{\\frac{1}{2}^-} - [u'v_h]_{\\frac{1}{2}^+}^1\n$$\n由于 $v_h(0)=v_h(1)=0$，上式简化为：\n$$\n\\ell(v_h) = a(u, v_h) - u'(\\tfrac{1}{2})v_h(\\tfrac{1}{2}^-) + u'(\\tfrac{1}{2})v_h(\\tfrac{1}{2}^+) = a(u, v_h) + u'(\\tfrac{1}{2}) \\left( v_h(\\tfrac{1}{2}^+) - v_h(\\tfrac{1}{2}^-) \\right)\n$$\n这个恒等式可以写为 $a(u, v_h) = \\ell(v_h) - u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}$，其中 $[|v_h|]_{\\frac{1}{2}}$ 是 $v_h$ 在 $x=\\frac{1}{2}$ 处的跳跃。$u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}$ 就是**界面相容性项**。\n\n现在我们可以表示误差。注意到 $a_h(u_h, v_h) = a(u_h, v_h)$ 且离散形式为 $a_h(u_h, v_h) = \\ell(v_h)$。\n$$\na(u-u_h, v_h) = a(u,v_h) - a(u_h, v_h) = \\left( \\ell(v_h) - u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}} \\right) - \\ell(v_h) = -u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}\n$$\n我们用 $v_h = \\varphi_L$ 来验证这个公式。\n$$\nu'(\\tfrac{1}{2}) = \\frac{1-3(\\frac{1}{2})^2}{6} = \\frac{1 - \\frac{3}{4}}{6} = \\frac{\\frac{1}{4}}{6} = \\frac{1}{24}\n$$\n$$\n[|\\varphi_L|]_{\\frac{1}{2}} = \\varphi_L(\\tfrac{1}{2}^+) - \\varphi_L(\\tfrac{1}{2}^-) = 0 - 2(\\tfrac{1}{2}) = -1\n$$\n代入公式：\n$$\n\\delta = a(u-u_h, \\varphi_L) = -u'(\\tfrac{1}{2})[|\\varphi_L|]_{\\frac{1}{2}} = -\\left(\\frac{1}{24}\\right)(-1) = \\frac{1}{24}\n$$\n这个结果与任务3中直接计算的 $\\delta$ 值相匹配。", "answer": "$$\\boxed{\\frac{1}{24}}$$", "id": "2561497"}]}