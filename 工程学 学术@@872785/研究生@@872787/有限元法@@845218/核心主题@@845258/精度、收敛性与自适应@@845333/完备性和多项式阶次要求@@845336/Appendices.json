{"hands_on_practices": [{"introduction": "理论要通过实践来巩固。要讨论完备性的后果，我们首先必须学会如何检验它。这个练习 [@problem_id:2545388] 提供了一种直接的方法，来测试一个标准的双二次（$Q_2$）单元的函数再生能力。通过尝试插值一个部分处于、部分不处于该单元多项式空间的多项式，我们可以清晰地看到哪些项被精确捕捉，哪些项则丢失了，并量化由此产生的误差。", "problem": "在有限元方法 (FEM) 的背景下，考虑参考正方形 $\\widehat{\\Omega} = [-1,1] \\times [-1,1]$。$\\widehat{\\Omega}$ 上的一个 $Q_2$ 四边形单元有九个拉格朗日插值节点，分别位于四个角点、四条边的中点和中心，即位于 $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$。令 $I_{Q_2}$ 表示相应的节点拉格朗日插值算子。$\\widehat{\\Omega}$ 上的 $Q_2$ 插值空间是每个变量次数最高为 2 的张量积多项式空间。\n\n从张量积多项式空间和节点拉格朗日插值的定义出发。仅使用这些定义作为基本依据，对标量位移场\n$$\nu(\\xi,\\eta) = \\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3.\n$$\n回答以下问题：\n1) 从第一性原理出发进行推理，确定在总次数为三的单项式集合 $\\{\\xi^3,\\ \\xi^2 \\eta,\\ \\xi \\eta^2,\\ \\eta^3\\}$ 中，哪些能被 $I_{Q_2}$ 精确再生，哪些不能。\n\n2) 通过列出 $u(\\xi,\\eta)$ 在所有九个 $Q_2$ 节点 $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$ 处的值来指定节点位移数据。\n\n3) 计算插值误差在 $\\widehat{\\Omega}$ 上的 $L^2$ 范数的平方，\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} \\big(u(\\xi,\\eta) - I_{Q_2}u(\\xi,\\eta)\\big)^2 \\, d\\eta \\, d\\xi,\n$$\n并给出其精确值。\n\n将最终答案以单个精确数的形式提供（无单位，不进行四舍五入）。", "solution": "首先对问题进行有效性验证。\n\n**问题验证**\n\n**第一步：提取已知条件**\n- 参考域：$\\widehat{\\Omega} = [-1,1] \\times [-1,1]$。\n- 单元类型：$Q_2$ 四边形。\n- 插值节点：$(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$。\n- 算子：$I_{Q_2}$ 是节点拉格朗日插值算子。\n- 插值空间：每个变量次数最高为 2 的张量积多项式空间，我们记为 $\\mathcal{Q}_2(\\widehat{\\Omega})$。\n- 标量场：$u(\\xi,\\eta) = \\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3$。\n- 任务：\n  1. 确定单项式集合 $\\{\\xi^3,\\ \\xi^2 \\eta,\\ \\xi \\eta^2,\\ \\eta^3\\}$ 中哪些能被 $I_{Q_2}$ 精确再生。\n  2. 指定 $u(\\xi,\\eta)$ 在所有 9 个节点上的节点值。\n  3. 计算插值误差的 $L^2$ 范数的平方，$\\int_{-1}^{1} \\int_{-1}^{1} (u - I_{Q_2}u)^2 \\, d\\eta \\, d\\xi$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是有限元方法理论中的一个标准练习。它基于完善的多项式插值和数值积分原理。\n- **适定性：** 问题提供了一个特定的函数、一个明确定义的插值方案和一组清晰的问题。存在唯一且有意义的解，并且可以计算出来。\n- **客观性：** 问题用精确的数学语言陈述。\n- **完整性和一致性：** 提供了所有必要的定义和数据，并且相互一致。$Q_2$ 单元的定义、其节点位置及其多项式空间是标准的且陈述正确。\n\n**第三步：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n**解答**\n\n基本定义如下。参考正方形 $\\widehat{\\Omega}$ 上的 $Q_2$ 张量积多项式空间由下式给出\n$$\n\\mathcal{Q}_2(\\widehat{\\Omega}) = \\text{span}\\{ \\xi^i \\eta^j \\mid 0 \\le i \\le 2, 0 \\le j \\le 2 \\}.\n$$\n九个节点的集合是 $\\mathcal{N} = \\{(\\xi_k, \\eta_k) \\mid \\xi_k, \\eta_k \\in \\{-1,0,1\\}\\}$。节点拉格朗日插值算子 $I_{Q_2}$ 将一个连续函数 $v(\\xi,\\eta)$ 映射到唯一满足插值条件的多项式 $I_{Q_2}v \\in \\mathcal{Q}_2(\\widehat{\\Omega})$：\n$$\n(I_{Q_2}v)(\\xi_k, \\eta_k) = v(\\xi_k, \\eta_k) \\quad \\forall (\\xi_k, \\eta_k) \\in \\mathcal{N}.\n$$\n\n**1) 单项式再生**\n\n一个函数 $v$ 被算子 $I_{Q_2}$ 精确再生，当且仅当 $I_{Q_2}v = v$。拉格朗日插值定义的一个直接推论是，如果 $v$ 本身是插值空间 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 的一个元素，那么 $I_{Q_2}v = v$。这是因为 $v \\in \\mathcal{Q}_2(\\widehat{\\Omega})$ 满足插值条件，且插值多项式是唯一的。\n\n我们逐一考察集合 $\\{\\xi^3,\\ \\xi^2 \\eta,\\ \\xi \\eta^2,\\ \\eta^3\\}$ 中的每个单项式。\n\n- 对于 $v(\\xi,\\eta) = \\xi^2 \\eta$：指数为 $i=2$ 和 $j=1$。因为 $0 \\le 2 \\le 2$ 和 $0 \\le 1 \\le 2$，这个单项式是 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 的一个元素。因此，它被**精确再生**。\n\n- 对于 $v(\\xi,\\eta) = \\xi \\eta^2$：指数为 $i=1$ 和 $j=2$。因为 $0 \\le 1 \\le 2$ 和 $0 \\le 2 \\le 2$，这个单项式也是 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 的一个元素。因此，它被**精确再生**。\n\n- 对于 $v(\\xi,\\eta) = \\xi^3$：指数为 $i=3$ 和 $j=0$。因为 $i=3 > 2$，这个单项式不在 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 中。为了确定其插值多项式，我们在节点处计算 $v$ 的值。对于任意节点 $(\\xi_k, \\eta_k)$，其坐标 $\\xi_k$ 在 $\\{-1, 0, 1\\}$ 集合中。对于这些值，$\\xi_k^3 = \\xi_k$。例如， $(-1)^3 = -1$， $0^3 = 0$， $1^3 = 1$。因此，函数 $\\xi^3$ 的节点值与函数 $\\xi$ 的节点值相同。函数 $p(\\xi, \\eta) = \\xi$ 在 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 中。因为在所有九个节点上 $p(\\xi_k, \\eta_k) = \\xi_k = \\xi_k^3$，根据拉格朗日插值多项式的唯一性，我们必有 $I_{Q_2}(\\xi^3) = p(\\xi,\\eta) = \\xi$。由于函数 $\\xi$ 在 $\\widehat{\\Omega}$ 上与函数 $\\xi^3$ 不完全相同，单项式 $\\xi^3$ **不被精确再生**。\n\n- 对于 $v(\\xi,\\eta) = \\eta^3$：与 $\\xi^3$ 的情况对称，指数 $j=3 > 2$，所以 $\\eta^3$ 不在 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 中。在节点处，$\\eta_k \\in \\{-1, 0, 1\\}$，所以 $\\eta_k^3 = \\eta_k$。$\\eta^3$ 的节点值与函数 $\\eta$ 的节点值相同。因为 $\\eta \\in \\mathcal{Q}_2(\\widehat{\\Omega})$，插值多项式的唯一性意味着 $I_{Q_2}(\\eta^3) = \\eta$。由于 $\\eta \\neq \\eta^3$，单项式 $\\eta^3$ **不被精确再生**。\n\n**2) 节点位移数据**\n\n位移场为 $u(\\xi,\\eta) = \\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3$。我们在九个节点 $(\\xi, \\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$ 处计算 $u$ 的值。计算结果列表如下。\n- $u(-1, -1) = (-1)^3 + (-1)^2(-1) + (-1)(-1)^2 + (-1)^3 = -1 - 1 - 1 - 1 = -4$\n- $u(-1, 0) = (-1)^3 + (-1)^2(0) + (-1)(0)^2 + (0)^3 = -1 + 0 + 0 + 0 = -1$\n- $u(-1, 1) = (-1)^3 + (-1)^2(1) + (-1)(1)^2 + (1)^3 = -1 + 1 - 1 + 1 = 0$\n- $u(0, -1) = (0)^3 + (0)^2(-1) + (0)(-1)^2 + (-1)^3 = 0 + 0 + 0 - 1 = -1$\n- $u(0, 0) = (0)^3 + (0)^2(0) + (0)(0)^2 + (0)^3 = 0 + 0 + 0 + 0 = 0$\n- $u(0, 1) = (0)^3 + (0)^2(1) + (0)(1)^2 + (1)^3 = 0 + 0 + 0 + 1 = 1$\n- $u(1, -1) = (1)^3 + (1)^2(-1) + (1)(-1)^2 + (-1)^3 = 1 - 1 + 1 - 1 = 0$\n- $u(1, 0) = (1)^3 + (1)^2(0) + (1)(0)^2 + (0)^3 = 1 + 0 + 0 + 0 = 1$\n- $u(1, 1) = (1)^3 + (1)^2(1) + (1)(1)^2 + (1)^3 = 1 + 1 + 1 + 1 = 4$\n\n九个节点值为 $\\{-4, -1, 0, -1, 0, 1, 0, 1, 4\\}$。\n\n**3) 插值误差的 $L^2$ 范数的平方**\n\n插值误差为 $e(\\xi, \\eta) = u(\\xi, \\eta) - I_{Q_2}u(\\xi, \\eta)$。\n利用 $I_{Q_2}$ 算子的线性和第 1) 部分的结果：\n$$\nI_{Q_2}u = I_{Q_2}(\\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3) = I_{Q_2}(\\xi^3) + I_{Q_2}(\\xi^2 \\eta) + I_{Q_2}(\\xi \\eta^2) + I_{Q_2}(\\eta^3)\n$$\n$$\nI_{Q_2}u(\\xi, \\eta) = \\xi + \\xi^2 \\eta + \\xi \\eta^2 + \\eta\n$$\n因此，误差函数为：\n$$\ne(\\xi, \\eta) = (\\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3) - (\\xi + \\xi^2 \\eta + \\xi \\eta^2 + \\eta) = (\\xi^3 - \\xi) + (\\eta^3 - \\eta)\n$$\n我们必须计算此误差在 $\\widehat{\\Omega}$ 上的 $L^2$ 范数的平方：\n$$\nE = \\int_{-1}^{1} \\int_{-1}^{1} [e(\\xi,\\eta)]^2 \\, d\\eta \\, d\\xi = \\int_{-1}^{1} \\int_{-1}^{1} [(\\xi^3 - \\xi) + (\\eta^3 - \\eta)]^2 \\, d\\eta \\, d\\xi\n$$\n我们展开被积函数：\n$$\n[(\\xi^3 - \\xi) + (\\eta^3 - \\eta)]^2 = (\\xi^3 - \\xi)^2 + (\\eta^3 - \\eta)^2 + 2(\\xi^3 - \\xi)(\\eta^3 - \\eta)\n$$\n积分变为：\n$$\nE = \\int_{-1}^{1} \\int_{-1}^{1} (\\xi^3 - \\xi)^2 \\, d\\eta \\, d\\xi + \\int_{-1}^{1} \\int_{-1}^{1} (\\eta^3 - \\eta)^2 \\, d\\eta \\, d\\xi + \\int_{-1}^{1} \\int_{-1}^{1} 2(\\xi^3 - \\xi)(\\eta^3 - \\eta) \\, d\\eta \\, d\\xi\n$$\n让我们分析第三项，即交叉乘积积分：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} 2(\\xi^3 - \\xi)(\\eta^3 - \\eta) \\, d\\eta \\, d\\xi = 2 \\left( \\int_{-1}^{1} (\\xi^3 - \\xi) \\, d\\xi \\right) \\left( \\int_{-1}^{1} (\\eta^3 - \\eta) \\, d\\eta \\right)\n$$\n被积函数 $f(\\xi) = \\xi^3 - \\xi$ 是一个奇函数，意味着 $f(-\\xi) = -f(\\xi)$。奇函数在对称区间 $[-1, 1]$ 上的积分为零。\n$$\n\\int_{-1}^{1} (\\xi^3 - \\xi) \\, d\\xi = \\left[ \\frac{\\xi^4}{4} - \\frac{\\xi^2}{2} \\right]_{-1}^{1} = \\left(\\frac{1}{4} - \\frac{1}{2}\\right) - \\left(\\frac{(-1)^4}{4} - \\frac{(-1)^2}{2}\\right) = -\\frac{1}{4} - \\left(-\\frac{1}{4}\\right) = 0\n$$\n因此，交叉乘积积分为 $2 \\times 0 \\times 0 = 0$。\n\n总误差是前两个积分之和，由于对称性，这两个积分是相同的。让我们计算第一个积分：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} (\\xi^3 - \\xi)^2 \\, d\\eta \\, d\\xi = \\left( \\int_{-1}^{1} d\\eta \\right) \\left( \\int_{-1}^{1} (\\xi^3 - \\xi)^2 \\, d\\xi \\right) = 2 \\int_{-1}^{1} (\\xi^6 - 2\\xi^4 + \\xi^2) \\, d\\xi\n$$\n被积函数是偶函数，所以我们可以从 $0$ 积分到 $1$，然后乘以 $2$：\n$$\n2 \\int_{-1}^{1} (\\xi^6 - 2\\xi^4 + \\xi^2) \\, d\\xi = 2 \\times 2 \\int_{0}^{1} (\\xi^6 - 2\\xi^4 + \\xi^2) \\, d\\xi = 4 \\left[ \\frac{\\xi^7}{7} - \\frac{2\\xi^5}{5} + \\frac{\\xi^3}{3} \\right]_{0}^{1}\n$$\n$$\n= 4 \\left( \\frac{1}{7} - \\frac{2}{5} + \\frac{1}{3} \\right) = 4 \\left( \\frac{15 \\cdot 1 - 21 \\cdot 2 + 35 \\cdot 1}{105} \\right) = 4 \\left( \\frac{15 - 42 + 35}{105} \\right) = 4 \\left( \\frac{8}{105} \\right) = \\frac{32}{105}\n$$\n由于对称性，涉及 $\\eta$ 的第二个积分具有相同的值：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} (\\eta^3 - \\eta)^2 \\, d\\eta \\, d\\xi = \\frac{32}{105}\n$$\n误差的 $L^2$ 范数平方总和为：\n$$\nE = \\frac{32}{105} + \\frac{32}{105} + 0 = \\frac{64}{105}\n$$", "answer": "$$\n\\boxed{\\frac{64}{105}}\n$$", "id": "2545388"}, {"introduction": "现在我们理解了如何检验完备性，接下来将探讨它为何如此关键。这个实践 [@problem_id:2545358] 在一个简单的一维问题上，对比了一个标准的完备二次单元和一个自定义的“不完备”单元。这个精心构建的例子分离出了多项式再生能力失效所带来的影响，展示了它对解的精度和收敛率产生的直接且可量化的后果。", "problem": "构建、分析和编程一个一维模型问题，该问题旨在揭示不完全多项式再生对有限元法（FEM）中一致性（分片检验）行为和 Sobolev $H^1$ 误差率的影响。在纯数学的框架下进行。\n\n考虑单位区间上的边值问题，其具有齐次 Dirichlet 边界条件：\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \n\\qquad\nu(0) = 0, \\quad u(1) = 0,\n$$\n其中 $f(x) = 2$。精确解为 $u_\\star(x) = x(1-x)$。\n\n使用变分形式：寻找 $u \\in H^1_0(0,1)$ 使得\n$$\na(u,v) = \\ell(v) \\quad \\forall v \\in H^1_0(0,1),\n$$\n其中\n$$\na(u,v) = \\int_0^1 u'(x)\\, v'(x)\\, dx, \n\\qquad \n\\ell(v) = \\int_0^1 f(x)\\, v(x)\\, dx.\n$$\n\n在一个包含 $N$ 个单元、网格尺寸为 $h = 1/N$ 的均匀网格上进行离散化，使用以下两个协调 $H^1$ 子空间：\n\n- 完全二次 Lagrange 空间 $V_h^{(P2)}$：在每个单元上为二次多项式的连续函数（完全 2 次再生）。在每个单元上，使用参考坐标 $\\xi \\in [0,1]$ 和与 $\\xi=0$、$\\xi=1/2$、$\\xi=1$ 相关联的标准二次 Lagrange 形函数。\n\n- 不完全类二次空间 $V_h^{(\\text{inc})}$：在参考坐标 $\\xi \\in [0,1]$ 中，由集合 $\\{1-\\xi,\\, \\xi,\\, \\sin(\\pi \\xi)\\}$ 在每个单元上张成的连续函数，并通过仿射映射到每个物理单元。该空间每个单元有三个自由度（DOFs），但在局部不包含所有二次多项式，因此即使使用精确积分，也无法精确再生 $u_\\star(x)$。\n\n任务：\n\n1. 从变分形式和两个离散空间的定义出发，证明为何 $V_h^{(P2)}$ 对任意 $N$ 都能再生精确的二次解 $u_\\star$（因此 $H^1$ 误差为零），而不完全空间 $V_h^{(\\text{inc})}$ 未能再生 $u_\\star$，从而即使所有积分都精确计算，也表现出非零的一致性（分片检验）误差。\n\n2. 使用精确的单元级积分（无数值积分误差），为两种离散化方法组装全局刚度矩阵和载荷向量，强施加边界条件（即 $u(0)=u(1)=0$），并求解得到的线性系统。\n\n3. 对于两种方法，通过在每个单元上进行闭式积分来精确计算误差的 $H^1$ 半范数，\n$$\n\\lvert u_\\star - u_h \\rvert_{H^1(0,1)} = \\left( \\int_0^1 \\left( u_\\star'(x) - u_h'(x) \\right)^2 dx \\right)^{1/2},\n$$\n然后，对于不完全空间 $V_h^{(\\text{inc})}$，通过以下公式估算连续细化之间观察到的 $H^1$ 收敛阶\n$$\np_{\\text{obs}}(N \\to 2N) = \\log_2 \\left( \\frac{ \\lvert u_\\star - u_h^{(\\text{inc})} \\rvert_{H^1} \\text{ at } N }{ \\lvert u_\\star - u_h^{(\\text{inc})} \\rvert_{H^1} \\text{ at } 2N } \\right).\n$$\n\n4. 测试套件。对以下网格尺寸运行计算\n$$\nN \\in \\{1, 2, 4, 8\\}.\n$$\n对每个 $N$，计算：\n- $V_h^{(\\text{inc})}$ 的 $H^1$ 误差，\n- $V_h^{(P2)}$ 的 $H^1$ 误差。\n\n此外，对于不完全空间，在 $N \\in \\{1,2,4\\}$ 的情况下，计算 $N \\to 2N$ 变换过程的观察收敛阶 $p_{\\text{obs}}$。\n\n5. 最终输出格式。你的程序应该生成单行输出，包含一个由逗号分隔的、用方括号括起来的扁平实数列表，顺序如下：\n$$\n\\big[\nE_{\\text{inc}}(1),\\ E_{\\text{inc}}(2),\\ E_{\\text{inc}}(4),\\ E_{\\text{inc}}(8),\\ \np_{\\text{obs}}(1 \\to 2),\\ p_{\\text{obs}}(2 \\to 4),\\ p_{\\text{obs}}(4 \\to 8),\\ \nE_{P2}(1),\\ E_{P2}(2),\\ E_{P2}(4),\\ E_{P2}(8)\n\\big].\n$$\n所有数值都应表示为浮点数。不涉及物理单位。\n\n科学真实性和一致性要求：\n- 离散双线性和线性形式中的所有积分必须以闭式形式精确计算。\n- 对于 $V_h^{(\\text{inc})}$ 的非零一致性误差的证明必须依赖于多项式再生的失败，而不是积分误差或边界条件处理不当。\n- 你的解答中的推导必须从变分形式和标准的有限元组装原理开始，不得使用快捷公式来得出目标结论。", "solution": "问题陈述需要经过验证。\n\n**步骤 1：提取已知条件**\n- **控制方程**：$-u''(x) = f(x)$，对于 $x \\in (0,1)$。\n- **力函数**：$f(x) = 2$。\n- **边界条件**：$u(0) = 0$，$u(1) = 0$。\n- **精确解**：$u_\\star(x) = x(1-x)$。\n- **变分形式**：寻找 $u \\in H^1_0(0,1)$ 使得对所有 $v \\in H^1_0(0,1)$ 都有 $a(u,v) = \\ell(v)$。\n- **双线性形式**：$a(u,v) = \\int_0^1 u'(x)\\, v'(x)\\, dx$。\n- **线性形式**：$\\ell(v) = \\int_0^1 f(x)\\, v(x)\\, dx$。\n- **离散化**：包含 $N$ 个单元的均匀网格，网格尺寸 $h = 1/N$。\n- **有限元空间 1**：$V_h^{(P2)}$，连续分片二次 Lagrange 单元。\n- **有限元空间 2**：$V_h^{(\\text{inc})}$，在参考单元 $\\xi \\in [0,1]$ 上由 $\\{1-\\xi, \\xi, \\sin(\\pi \\xi)\\}$ 局部张成的连续函数。\n- **误差度量**：$H^1$ 半范数，$\\lvert u_\\star - u_h \\rvert_{H^1(0,1)} = \\left( \\int_0^1 \\left( u_\\star'(x) - u_h'(x) \\right)^2 dx \\right)^{1/2}$。\n- **收敛阶**：$p_{\\text{obs}}(N \\to 2N) = \\log_2 \\left( \\frac{ \\lvert u_\\star - u_h \\rvert_{H^1} \\text{ at } N }{ \\lvert u_\\star - u_h \\rvert_{H^1} \\text{ at } 2N } \\right)$。\n- **计算任务**：计算 $N \\in \\{1, 2, 4, 8\\}$ 时的误差以及 $N \\in \\{1,2,4\\}$ 时 $N \\to 2N$ 的收敛阶。所有积分必须精确。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是有限元方法理论中的一个标准教科书练习。它有科学依据、适定、客观且自洽。定义精确。“不完全”单元空间的构建是证明多项式完备性对一致性和收敛性重要性的有效方法。该问题满足所有有效性标准。\n\n**步骤 3：结论与行动**\n问题有效。现提供一个完整的、有理有据的解答。\n\n***\n\n分析将按照概述的任务进行。\n\n**1. 一致性与多项式再生分析**\n\n如果一个有限元方法能够精确再生某个次数的多项式解，那么它是一致的。这通常通过分片检验来检查。在我们的例子中，精确解 $u_\\star(x) = x-x^2$ 是一个全局二次多项式。\n\n对于连续分片二次多项式空间 $V_h^{(P2)}$，显而易见，任何全局二次多项式对于任意网格尺寸 $N \\ge 1$ 都是该空间的成员。因此，$u_\\star(x) \\in V_h^{(P2)}$。Galerkin 方法从子空间 $V_h$ 中找到最佳逼近 $u_h$，该逼近在与双线性形式 $a(\\cdot,\\cdot)$ 相关联的能量范数下使误差最小化。如果精确解 $u_\\star$ 已经在试探空间 $V_h$ 中，那么唯一的最佳逼近就是精确解本身。因此，有限元解为 $u_h = u_\\star$。所以，误差 $u_\\star - u_h$ 恒等于零，且对任意 $N$，$H^1$ 误差范数 $\\lvert u_\\star - u_h \\rvert_{H^1(0,1)}$ 都为零。该方法通过了二次多项式的分片检验。\n\n对于空间 $V_h^{(\\text{inc})}$，参考单元 $\\xi \\in [0,1]$ 上的基函数是 $\\{1-\\xi, \\xi, \\sin(\\pi\\xi)\\}$。在此局部空间内的任何函数 $u_h(\\xi)$ 都具有 $c_1(1-\\xi) + c_2\\xi + c_3\\sin(\\pi\\xi)$ 的形式。这是一个线性函数加上一个正弦“气泡”函数。一般的二次函数 $A\\xi^2+B\\xi+C$ 不能被这个基表示，除非 $A=0$。精确解当映射到参考单元时，为 $u_\\star(\\xi) = u_\\star(x_e+h\\xi) = h^2\\xi(1-\\xi) + \\text{线性项}$，它包含一个非零的 $\\xi^2$ 项。因此，$u_\\star \\notin V_h^{(\\text{inc})}$。因为该方法不能再生精确解，所以有限元解 $u_h$ 将不等于 $u_\\star$，从而会出现一个非零的一致性误差。该方法未能通过二次多项式的分片检验。\n\n**2. 有限元公式化与求解**\n\n我们计算单元刚度矩阵 $K^e$ 和载荷向量 $F^e$。从参考坐标 $\\xi \\in [0,1]$ 到物理坐标 $x \\in [x_e, x_{e+1}]$ 的变换是 $x(\\xi) = x_e + h\\xi$，其 Jacobian 行列式为 $J=h$。\n单元刚度矩阵和载荷向量的项为：\n$$\nK^e_{ij} = \\int_{x_e}^{x_{e+1}} \\phi_i'(x) \\phi_j'(x) dx = \\frac{1}{h} \\int_0^1 \\frac{d\\hat{\\phi}_i}{d\\xi} \\frac{d\\hat{\\phi}_j}{d\\xi} d\\xi\n$$\n$$\nF^e_i = \\int_{x_e}^{x_{e+1}} f(x) \\phi_i(x) dx = \\int_0^1 2 \\cdot \\hat{\\phi}_i(\\xi) h d\\xi = 2h \\int_0^1 \\hat{\\phi}_i(\\xi) d\\xi\n$$\n\n**完全二次空间 $V_h^{(P2)}$**\n如前所述，$u_h = u_\\star$，因此对所有 $N$ 都有误差 $\\lvert u_\\star - u_h \\rvert_{H^1(0,1)} = 0$。无需详细推导该系统即可得出此结论。\n\n**不完全空间 $V_h^{(\\text{inc})}$**\n局部基函数为 $\\hat{\\phi}_1(\\xi) = 1-\\xi$、$\\hat{\\phi}_2(\\xi) = \\xi$ 和 $\\hat{\\phi}_3(\\xi) = \\sin(\\pi\\xi)$。前两者与单元节点相关联，第三个是内部气泡函数。\n其导数为 $\\hat{\\phi}_1'(\\xi)=-1$、$\\hat{\\phi}_2'(\\xi)=1$ 和 $\\hat{\\phi}_3'(\\xi)=\\pi\\cos(\\pi\\xi)$。\n\n参考刚度矩阵的积分为：\n$\\int_0^1 (\\hat{\\phi}_1')^2 d\\xi = 1$\n$\\int_0^1 \\hat{\\phi}_1' \\hat{\\phi}_2' d\\xi = -1$\n$\\int_0^1 (\\hat{\\phi}_2')^2 d\\xi = 1$\n$\\int_0^1 (\\hat{\\phi}_3')^2 d\\xi = \\pi^2 \\int_0^1 \\cos^2(\\pi\\xi)d\\xi = \\pi^2/2$\n$\\int_0^1 \\hat{\\phi}_1' \\hat{\\phi}_3' d\\xi = -\\pi \\int_0^1 \\cos(\\pi\\xi)d\\xi = 0$\n$\\int_0^1 \\hat{\\phi}_2' \\hat{\\phi}_3' d\\xi = \\pi \\int_0^1 \\cos(\\pi\\xi)d\\xi = 0$\n\n这得到单元刚度矩阵：\n$$\nK^e = \\frac{1}{h} \\begin{pmatrix} 1  -1  0 \\\\ -1  1  0 \\\\ 0  0  \\pi^2/2 \\end{pmatrix}\n$$\n参考载荷向量的积分为：\n$\\int_0^1 \\hat{\\phi}_1(\\xi) d\\xi = 1/2$\n$\\int_0^1 \\hat{\\phi}_2(\\xi) d\\xi = 1/2$\n$\\int_0^1 \\hat{\\phi}_3(\\xi) d\\xi = \\int_0^1 \\sin(\\pi\\xi)d\\xi = [- \\frac{1}{\\pi}\\cos(\\pi\\xi)]_0^1 = 2/\\pi$\n这得到单元载荷向量：\n$$\nF^e = 2h \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 2/\\pi \\end{pmatrix} = h \\begin{pmatrix} 1 \\\\ 1 \\\\ 4/\\pi \\end{pmatrix}\n$$\n因为在双线性形式中，气泡函数基与线性节点基是正交的，所以全局系统解耦。节点值的系统与标准线性单元（P1）的系统相同，对于 $-u''=2$，它产生的节点值是精确的：$u_h(x_i) = u_\\star(x_i)$。每个单元 $e$ 上的气泡系数 $c_e$ 的系统是独立的：\n$$\n\\frac{1}{h} (\\pi^2/2) c_e = h (4/\\pi) \\implies c_e = \\frac{8h^2}{\\pi^3}\n$$\n因此，单元 $e$ 上的解为 $u_h(x) = u_\\star(x_e)(1-\\xi) + u_\\star(x_{e+1})\\xi + \\frac{8h^2}{\\pi^3}\\sin(\\pi\\xi)$，其中 $x = x_e + h\\xi$。\n\n**3. 误差计算与收敛阶**\n\n$H^1$ 半范数误差按单元计算：\n$\\lvert u_\\star - u_h \\rvert_{H^1(0,1)}^2 = \\sum_e \\int_{x_e}^{x_{e+1}} (u_\\star' - u_h')^2 dx = \\sum_e \\frac{1}{h} \\int_0^1 (\\frac{du_\\star}{d\\xi} - \\frac{du_h}{d\\xi})^2 d\\xi$。\n在一个单元上，精确解的导数为 $\\frac{du_\\star}{d\\xi} = h(1-2x_e) - 2h^2\\xi$。\n有限元解的导数为 $\\frac{du_h}{d\\xi} = (u_{e+1}-u_e) + c_e \\pi \\cos(\\pi\\xi) = h(1-2x_e-h) + \\frac{8h^2}{\\pi^2}\\cos(\\pi\\xi)$。\n导数之差为：\n$$\n\\frac{du_\\star}{d\\xi} - \\frac{du_h}{d\\xi} = [h(1-2x_e) - 2h^2\\xi] - [h(1-2x_e-h) + \\frac{8h^2}{\\pi^2}\\cos(\\pi\\xi)] = h^2(1-2\\xi) - \\frac{8h^2}{\\pi^2}\\cos(\\pi\\xi)\n$$\n一个单元上的误差平方为：\n$$\nE_e^2 = \\frac{1}{h} \\int_0^1 \\left( h^2(1-2\\xi) - \\frac{8h^2}{\\pi^2}\\cos(\\pi\\xi) \\right)^2 d\\xi = h^3 \\int_0^1 \\left( (1-2\\xi) - \\frac{8}{\\pi^2}\\cos(\\pi\\xi) \\right)^2 d\\xi\n$$\n积分项对所有单元都是常数。设其为 $I$：\n$I = \\int_0^1 \\left[ (1-2\\xi)^2 - \\frac{16}{\\pi^2}(1-2\\xi)\\cos(\\pi\\xi) + \\frac{64}{\\pi^4}\\cos^2(\\pi\\xi) \\right] d\\xi$。\n我们计算每一项：\n$\\int_0^1 (1-2\\xi)^2 d\\xi = \\int_0^1 (1-4\\xi+4\\xi^2) d\\xi = [\\xi-2\\xi^2+4\\xi^3/3]_0^1 = 1/3$。\n$\\int_0^1 (1-2\\xi)\\cos(\\pi\\xi)d\\xi = [(1-2\\xi)\\frac{\\sin(\\pi\\xi)}{\\pi}]_0^1 - \\int_0^1 \\frac{\\sin(\\pi\\xi)}{\\pi}(-2)d\\xi = \\frac{2}{\\pi}\\int_0^1 \\sin(\\pi\\xi)d\\xi = \\frac{4}{\\pi^2}$。\n$\\int_0^1 \\cos^2(\\pi\\xi)d\\xi = 1/2$。\n代入这些值：\n$I = \\frac{1}{3} - \\frac{16}{\\pi^2}\\left(\\frac{4}{\\pi^2}\\right) + \\frac{64}{\\pi^4}\\left(\\frac{1}{2}\\right) = \\frac{1}{3} - \\frac{64}{\\pi^4} + \\frac{32}{\\pi^4} = \\frac{1}{3} - \\frac{32}{\\pi^4}$。\n总误差平方是 $N$ 个单元的总和：\n$\\lvert u_\\star - u_h \\rvert_{H^1}^2 = N \\cdot E_e^2 = N h^3 I = (1/h) h^3 I = h^2 I$。\n因此，$H^1$ 半范数误差为：\n$$\n\\lvert u_\\star - u_h^{(\\text{inc})} \\rvert_{H^1(0,1)} = h \\sqrt{\\frac{1}{3} - \\frac{32}{\\pi^4}}\n$$\n由于误差与 $h$ 成正比，收敛阶 $p$ 精确为 $1$。\n$p_{\\text{obs}}(N \\to 2N) = \\log_2(\\frac{h_N\\sqrt{I}}{h_{2N}\\sqrt{I}}) = \\log_2(\\frac{1/N}{1/(2N)}) = \\log_2(2) = 1$。\n\n**4. 数值评估**\n\n我们现在计算所需的值。\n误差常数为 $C = \\sqrt{1/3 - 32/\\pi^4} \\approx 0.069410283074$。\n不完全方法的误差为 $E_{\\text{inc}}(N) = C/N$。\n完全 P2 方法的误差为 $E_{P2}(N) = 0$。\n不完全方法的观察收敛阶为 $p_{\\text{obs}} = 1$。\n\n- 对于 $N=1$：$E_{\\text{inc}}(1) = C \\approx 0.06941028$，$E_{P2}(1) = 0$。\n- 对于 $N=2$：$E_{\\text{inc}}(2) = C/2 \\approx 0.03470514$，$E_{P2}(2) = 0$。\n- 对于 $N=4$：$E_{\\text{inc}}(4) = C/4 \\approx 0.01735257$，$E_{P2}(4) = 0$。\n- 对于 $N=8$：$E_{\\text{inc}}(8) = C/8 \\approx 0.00867629$，$E_{P2}(8) = 0$。\n\n- 收敛阶 ($1 \\to 2$)：$p_{\\text{obs}} = 1.0$。\n- 收敛阶 ($2 \\to 4$)：$p_{\\text{obs}} = 1.0$。\n- 收敛阶 ($4 \\to 8$)：$p_{\\text{obs}} = 1.0$。\n\n这些解析推导的值是精确的计算机实现必须产生的结果。以下程序计算这些结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs, analyzes, and programs a one-dimensional FEM problem\n    to study the effect of incomplete polynomial reproduction.\n\n    The problem is -u'' = 2 on (0,1) with u(0)=u(1)=0.\n    The exact solution is u*(x) = x(1-x).\n\n    Two element types are considered:\n    1. V_h^(P2): Standard complete quadratic elements.\n    2. V_h^(inc): Incomplete elements spanned by {1-xi, xi, sin(pi*xi)}.\n\n    The H1-seminorm of the error and convergence rates are computed analytically.\n    \"\"\"\n\n    # As derived in the solution, the error for the complete P2 element is\n    # always zero because the exact solution is a quadratic polynomial and\n    # is therefore contained in the finite element space V_h^(P2) for any N.\n    # E_p2(N) = 0 for all N.\n\n    # For the incomplete element, the H1-seminorm error was derived to be\n    # |u* - u_h|_H1 = h * sqrt(1/3 - 32/pi^4), where h = 1/N.\n    # The convergence rate p_obs is therefore log2( (h_N)/(h_2N) ) = log2(2) = 1.\n\n    # Test cases for number of elements N\n    N_values = [1, 2, 4, 8]\n\n    # Calculate the error constant C = sqrt(1/3 - 32/pi^4)\n    error_constant = np.sqrt(1/3 - 32 / np.pi**4)\n\n    # Calculate H1 errors for the incomplete space V_h^(inc)\n    errors_inc = [error_constant / N for N in N_values]\n\n    # The observed convergence rates are analytically known to be 1.0\n    rates_inc = [1.0, 1.0, 1.0]\n\n    # H1 errors for the complete space V_h^(P2) are all zero\n    errors_p2 = [0.0, 0.0, 0.0, 0.0]\n\n    # Assemble the final flat list of results in the specified order\n    # [E_inc(1), E_inc(2), E_inc(4), E_inc(8),\n    #  p_obs(1->2), p_obs(2->4), p_obs(4->8),\n    #  E_p2(1), E_p2(2), E_p2(4), E_p2(8)]\n    results = errors_inc + rates_inc + errors_p2\n\n    # Format the output as a comma-separated list of floating-point numbers\n    # enclosed in square brackets.\n    # The map(str, ...) is used to ensure default float representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2545358"}, {"introduction": "在实际应用中，有限元很少是完美的正方形或三角形。这个练习 [@problem_id:2545386] 深入探讨了等参单元的一个关键微妙之处：从“完美”的参考单元到扭曲的物理单元的几何映射如何破坏其多项式性质。通过分析一个映射到梯形的双线性单元，我们可以从数学上证明并量化，一个在参考空间中的简单线性函数如何在物理空间中变成一个更复杂的非多项式函数，从而破坏了达到最优性能所需的完备性。", "problem": "考虑一个单一的等参双线性四边形单元，该单元通过将具有局部坐标 $(\\xi,\\eta)$ 的参考正方形 $[-1,1]^2$ 映射到具有物理坐标 $(x,y)$ 的物理、轻微扭曲的梯形而获得。该映射由标准双线性形函数\n$$\nN_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4},\n$$\n以及物理节点坐标\n$$\n\\boldsymbol{X}_{1}=(0,0),\\quad \\boldsymbol{X}_{2}=(1,0),\\quad \\boldsymbol{X}_{3}=(1+\\beta,1),\\quad \\boldsymbol{X}_{4}=(0,1),\n$$\n定义，其中 $\\beta$ 是一个实数参数，量化了该形状与平行四边形的偏差，并满足非退化条件 $1+\\beta\\,y0$ 对所有 $y\\in[0,1]$ 成立（例如，$\\beta-1$ 即可）。等参映射 $\\boldsymbol{F}:[-1,1]^2\\to\\mathbb{R}^2$ 为\n$$\n\\boldsymbol{F}(\\xi,\\eta)=\\sum_{a=1}^{4}N_{a}(\\xi,\\eta)\\,\\boldsymbol{X}_{a}=(x(\\xi,\\eta),y(\\xi,\\eta))。\n$$\n\n令 $\\mathbb{Q}_{1}$ 表示参考单元上的多项式空间，其中多项式在每个变量中的次数最多为一，即 $\\operatorname{span}\\{1,\\xi,\\eta,\\xi\\eta\\}$。考虑参考多项式 $q(\\xi,\\eta)=\\xi+\\eta\\in\\mathbb{Q}_{1}$。其在物理坐标中的像通过逆映射的前推定义为\n$$\np(x,y)=q\\big(\\boldsymbol{F}^{-1}(x,y)\\big)=\\xi(x,y)+\\eta(x,y)。\n$$\n由于当 $\\beta\\neq 0$ 时，该映射是双线性的且通常是非仿射的，因此函数 $p(x,y)$ 未必是 $(x,y)$ 的多项式。\n\n令 $(x_{c},y_{c})=\\boldsymbol{F}(0,0)$ 为参考中心 $(\\xi,\\eta)=(0,0)$ 的物理像。作为由映射扭曲引起的非多项式行为的定量证明，请计算在点 $(x_{c},y_{c})$ 处的二阶导数 $\\frac{\\partial^{2}p}{\\partial y^{2}}$，并将其表示为仅含 $\\beta$ 的闭式解析函数。请提供精确表达式。不需要数值近似，且不涉及单位。", "solution": "用户提供了一个问题陈述。第一步也是最关键的一步是严格验证该陈述。\n\n**步骤1：提取已知条件**\n-   **参考域：** $(\\xi,\\eta)$ 平面中的一个正方形，定义为 $(\\xi,\\eta) \\in [-1,1]^2$。\n-   **物理域：** 一个顶点为 $\\boldsymbol{X}_{1}=(0,0)$、$\\boldsymbol{X}_{2}=(1,0)$、$\\boldsymbol{X}_{3}=(1+\\beta,1)$ 和 $\\boldsymbol{X}_{4}=(0,1)$ 的梯形。参数 $\\beta$ 是一个实数。\n-   **非退化条件：** $1+\\beta y0$ 对所有 $y \\in [0,1]$ 成立。\n-   **映射：** 一个等参映射 $\\boldsymbol{F}:[-1,1]^2\\to\\mathbb{R}^2$，其中 $\\boldsymbol{F}(\\xi,\\eta) = \\sum_{a=1}^{4}N_{a}(\\xi,\\eta)\\,\\boldsymbol{X}_{a} = (x(\\xi,\\eta), y(\\xi,\\eta))$。\n-   **形函数：** 双线性形函数 $N_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4}$、 $N_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4}$、 $N_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4}$、 $N_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}$。\n-   **目标函数：** 一个标量场 $p(x,y)$，定义为 $q(\\xi,\\eta) = \\xi+\\eta$ 的前推，即 $p(x,y) = q(\\boldsymbol{F}^{-1}(x,y)) = \\xi(x,y) + \\eta(x,y)$。\n-   **求值点：** 参考中心的物理像 $(x_c, y_c) = \\boldsymbol{F}(0,0)$。\n-   **目标：** 计算在点 $(x_c, y_c)$ 处的二阶偏导数 $\\frac{\\partial^{2}p}{\\partial y^{2}}$，作为 $\\beta$ 的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n根据验证标准对问题进行审查。\n-   **科学依据：** 该问题坚实地植根于有限元法（FEM）理论，特别是关于等参单元和几何映射对多项式空间的影响。所有概念都是计算力学和应用数学中的标准概念。该问题在化学、物理和数学上都是合理的。\n-   **适定性：** 该问题是适定的。它要求计算一个具体、明确定义的数学量。所有必要的数据和函数关系都已提供。非退化条件 $1+\\beta y > 0$ 确保了映射 $\\boldsymbol{F}$ 是可逆的，这对于函数 $p(x,y)$ 的良定义是必要的。\n-   **客观性：** 该问题以精确、客观的数学语言陈述，没有任何主观性或歧义。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、适定的、客观的和完整的。它代表了有限元理论中一个标准的、非平凡的计算。因此，该问题被判定为 **有效**。我们可以继续进行求解。\n\n首先，我们确定等参映射 $\\boldsymbol{F}(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta))$ 的显式形式。\n物理x坐标由下式给出\n$$\nx(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) x_a = N_1(\\xi,\\eta) \\cdot 0 + N_2(\\xi,\\eta) \\cdot 1 + N_3(\\xi,\\eta) \\cdot (1+\\beta) + N_4(\\xi,\\eta) \\cdot 0\n$$\n$$\nx(\\xi,\\eta) = \\frac{(1+\\xi)(1-\\eta)}{4} + (1+\\beta)\\frac{(1+\\xi)(1+\\eta)}{4} = \\frac{1+\\xi}{4} \\left[ (1-\\eta) + (1+\\beta)(1+\\eta) \\right]\n$$\n$$\nx(\\xi,\\eta) = \\frac{1+\\xi}{4} [1-\\eta + 1 + \\eta + \\beta + \\beta\\eta] = \\frac{1+\\xi}{4} (2+\\beta+\\beta\\eta).\n$$\n物理y坐标由下式给出\n$$\ny(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) y_a = N_1(\\xi,\\eta) \\cdot 0 + N_2(\\xi,\\eta) \\cdot 0 + N_3(\\xi,\\eta) \\cdot 1 + N_4(\\xi,\\eta) \\cdot 1\n$$\n$$\ny(\\xi,\\eta) = \\frac{(1+\\xi)(1+\\eta)}{4} + \\frac{(1-\\xi)(1+\\eta)}{4} = \\frac{1+\\eta}{4} [(1+\\xi)+(1-\\xi)] = \\frac{1+\\eta}{4} \\cdot 2 = \\frac{1+\\eta}{2}.\n$$\n从 $y(\\xi,\\eta)$ 的表达式中可以得到一个关键的简化。它只依赖于 $\\eta$。我们可以反转这个关系来求出 $\\eta$ 作为 $y$ 的函数：\n$$\n\\eta(x,y) = 2y - 1.\n$$\n需要求导的函数是 $p(x,y) = \\xi(x,y) + \\eta(x,y)$。由于 $\\eta(x,y)$ 是 $y$ 的线性函数且与 $x$ 无关，其关于 $y$ 的二阶导数为零：\n$$\n\\frac{\\partial \\eta}{\\partial y} = 2, \\quad \\frac{\\partial^2 \\eta}{\\partial y^2} = 0.\n$$\n因此，问题简化为计算 $\\frac{\\partial^2 \\xi}{\\partial y^2}$：\n$$\n\\frac{\\partial^2 p}{\\partial y^2} = \\frac{\\partial^2 \\xi}{\\partial y^2} + \\frac{\\partial^2 \\eta}{\\partial y^2} = \\frac{\\partial^2 \\xi}{\\partial y^2}.\n$$\n为了求出 $\\frac{\\partial^2 \\xi}{\\partial y^2}$，我们使用链式法则。任意函数 $f(\\xi,\\eta)$ 关于 $y$ 的一阶导数为\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{\\partial f}{\\partial \\xi}\\frac{\\partial \\xi}{\\partial y} + \\frac{\\partial f}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial y}.\n$$\n取 $f=\\xi$ 得到 $\\frac{\\partial \\xi}{\\partial y}$，这没有帮助。相反，我们从映射 $\\boldsymbol{F}$ 的雅可比矩阵 $J$ 的逆矩阵中计算导数 $\\frac{\\partial \\xi}{\\partial y}$ 和 $\\frac{\\partial \\eta}{\\partial y}$。\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}.\n$$\n其分量为：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}(2+\\beta+\\beta\\eta), \\quad \\frac{\\partial x}{\\partial \\eta} = \\frac{\\beta}{4}(1+\\xi), \\quad \\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{2}.\n$$\n所以，$J = \\begin{pmatrix} \\frac{1}{4}(2+\\beta+\\beta\\eta)  \\frac{\\beta}{4}(1+\\xi) \\\\ 0  \\frac{1}{2} \\end{pmatrix}$。\n行列式为 $\\det(J) = \\frac{1}{8}(2+\\beta+\\beta\\eta)$。\n逆映射的雅可比矩阵为 $J^{-1} = \\begin{pmatrix} \\frac{\\partial \\xi}{\\partial x}  \\frac{\\partial \\xi}{\\partial y} \\\\ \\frac{\\partial \\eta}{\\partial x}  \\frac{\\partial \\eta}{\\partial y} \\end{pmatrix} = \\frac{1}{\\det(J)}\\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta}  -\\frac{\\partial x}{\\partial \\eta} \\\\ -\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix}$。\n由此，我们求得 $\\frac{\\partial \\xi}{\\partial y}$：\n$$\n\\frac{\\partial \\xi}{\\partial y} = \\frac{-\\frac{\\partial x}{\\partial \\eta}}{\\det(J)} = \\frac{-\\frac{\\beta}{4}(1+\\xi)}{\\frac{1}{8}(2+\\beta+\\beta\\eta)} = -\\frac{2\\beta(1+\\xi)}{2+\\beta+\\beta\\eta}.\n$$\n记此为 $\\xi_y$。为计算二阶导数 $\\frac{\\partial^2 \\xi}{\\partial y^2} = \\frac{\\partial}{\\partial y}(\\xi_y)$，我们再次应用链式法则：\n$$\n\\frac{\\partial^2 \\xi}{\\partial y^2} = \\frac{\\partial \\xi_y}{\\partial \\xi}\\frac{\\partial \\xi}{\\partial y} + \\frac{\\partial \\xi_y}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial y} = \\xi_y \\frac{\\partial \\xi_y}{\\partial \\xi} + 2 \\frac{\\partial \\xi_y}{\\partial \\eta}.\n$$\n我们需要 $\\xi_y$ 关于 $\\xi$ 和 $\\eta$ 的偏导数：\n$$\n\\frac{\\partial \\xi_y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(-\\frac{2\\beta(1+\\xi)}{2+\\beta+\\beta\\eta}\\right) = -\\frac{2\\beta}{2+\\beta+\\beta\\eta}.\n$$\n$$\n\\frac{\\partial \\xi_y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(-\\frac{2\\beta(1+\\xi)}{2+\\beta+\\beta\\eta}\\right) = -2\\beta(1+\\xi) \\frac{-\\beta}{(2+\\beta+\\beta\\eta)^2} = \\frac{2\\beta^2(1+\\xi)}{(2+\\beta+\\beta\\eta)^2}.\n$$\n我们在中心点 $(\\xi,\\eta)=(0,0)$ 处计算这些表达式的值：\n在 $(\\xi,\\eta)=(0,0)$ 处：\n$$\n\\xi_y = -\\frac{2\\beta(1+0)}{2+\\beta+\\beta(0)} = -\\frac{2\\beta}{2+\\beta}.\n$$\n$$\n\\frac{\\partial \\xi_y}{\\partial \\xi} = -\\frac{2\\beta}{2+\\beta+\\beta(0)} = -\\frac{2\\beta}{2+\\beta}.\n$$\n$$\n\\frac{\\partial \\xi_y}{\\partial \\eta} = \\frac{2\\beta^2(1+0)}{(2+\\beta+\\beta(0))^2} = \\frac{2\\beta^2}{(2+\\beta)^2}.\n$$\n现在，将这些值代入二阶导数的表达式中：\n$$\n\\left.\\frac{\\partial^2 \\xi}{\\partial y^2}\\right|_{(\\xi,\\eta)=(0,0)} = \\left(-\\frac{2\\beta}{2+\\beta}\\right) \\left(-\\frac{2\\beta}{2+\\beta}\\right) + 2 \\left(\\frac{2\\beta^2}{(2+\\beta)^2}\\right)\n$$\n$$\n\\left.\\frac{\\partial^2 \\xi}{\\partial y^2}\\right|_{(\\xi,\\eta)=(0,0)} = \\frac{4\\beta^2}{(2+\\beta)^2} + \\frac{4\\beta^2}{(2+\\beta)^2} = \\frac{8\\beta^2}{(2+\\beta)^2}.\n$$\n由于 $\\frac{\\partial^2 p}{\\partial y^2} = \\frac{\\partial^2 \\xi}{\\partial y^2}$，这就是最终结果。当 $\\beta \\neq 0$ 时，该值为非零，这证实了双线性映射后的函数 $p(x,y)$ 在物理坐标中不是一个简单的多项式（具体来说，不是线性的），表明扭曲单元丧失了多项式保持特性。", "answer": "$$\n\\boxed{\\frac{8\\beta^2}{(2+\\beta)^2}}\n$$", "id": "2545386"}]}