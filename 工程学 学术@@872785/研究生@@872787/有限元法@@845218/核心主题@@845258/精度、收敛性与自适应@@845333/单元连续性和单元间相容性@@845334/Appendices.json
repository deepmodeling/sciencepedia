{"hands_on_practices": [{"introduction": "在模拟板壳弯曲等物理问题时，我们不仅需要保证位移场的连续性，还需要保证其导数（即转角）的连续性。这就要求我们使用所谓的 $C^1$ 连续单元。本练习 [@problem_id:2553873] 将指导您从第一性原理出发，一步步构建一个经典的 $C^1$ 单元——矩形双三次 Hermite 单元。通过这个过程，您将掌握如何利用张量积方法精心设计形函数，以满足跨单元边界的特定连续性要求。", "problem": "设参考单元为矩形 $\\Omega_{e} = \\{ (\\xi,\\eta) \\,:\\, \\xi \\in [-1,1], \\ \\eta \\in [-1,1] \\}$。考虑在 $\\Omega_{e}$ 上用一个双三次多项式来近似标量场 $u(\\xi,\\eta)$，该多项式适用于有限元法（FEM）。目标是构建一个二维三次 Hermite 单元，该单元在轴对齐的矩形网格的单元间边界上强制实现一阶导数的连续性（记为 $C^{1}$ 连续性）。\n\n从 $C^{1}$ 单元间协调性要求 $u$ 的迹及其一阶导数在任何公共边上都连续这一核心定义出发，按以下步骤进行：\n\n1) 在一维区间 $[-1,1]$ 上，推导四个三次多项式 $H_{1}(\\xi)$、$H_{2}(\\xi)$、$H_{3}(\\xi)$ 和 $H_{4}(\\xi)$，它们作为与端点 $\\xi=-1$ 和 $\\xi=1$ 处的节点数据相关联的 Hermite 基。具体要求是，每个 $H_{i}$ 都满足插值条件，以确保在其关联端点处精确再现节点值和节点一阶导数，而在相对端点处这些量为零。具体来说，对于端点 $\\xi=-1$，强制 $H_{1}(-1)=1$，$H_{1}'(-1)=0$，$H_{1}(1)=0$，$H_{1}'(1)=0$ 以及 $H_{2}(-1)=0$，$H_{2}'(-1)=1$，$H_{2}(1)=0$，$H_{2}'(1)=0$。对于端点 $\\xi=1$，强制 $H_{3}(-1)=0$，$H_{3}'(-1)=0$，$H_{3}(1)=1$，$H_{3}'(1)=0$ 以及 $H_{4}(-1)=0$，$H_{4}'(-1)=0$，$H_{4}(1)=0$，$H_{4}'(1)=1$。\n\n2) 在 $\\Omega_{e}$ 上使用张量积构造，为位于四个角点 $(\\xi,\\eta) \\in \\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$ 的 16 个节点量构建双三次 Hermite 形函数，其中每个角点的自由度为 $\\{u, u_{,\\xi}, u_{,\\eta}, u_{,\\xi\\eta}\\}$。每个节点量的形函数必须是 $\\xi$ 和 $\\eta$ 中合适的相应一维 Hermite 多项式的乘积，以匹配其作为值、$\\xi$ 方向一阶导数、$\\eta$ 方向一阶导数或 $\\xi$ 和 $\\eta$ 方向混合导数的角色。\n\n3) 根据 $C^{1}$ 连续性的定义，论证在沿公共边相交的两个相邻矩形单元之间，必须共享（组合为单值）哪些节点量，并简要解释为什么当这些量被共享时，张量积构造能满足沿边的 $C^{1}$ 连续性。\n\n最后，计算对应于角点 $(\\xi,\\eta)=(1,1)$ 处节点位移 $u$ 的形函数在参数点 $(\\xi,\\eta)=(\\tfrac{1}{2},-\\tfrac{1}{2})$ 处的值。将此值作为你的最终答案。无需四舍五入；给出精确值。", "solution": "所述问题在科学上是合理的、适定的，并包含获得唯一解所需的所有信息。这是有限元法理论中的一个标准问题。我们开始求解。\n\n首先，我们推导在区间 $\\xi \\in [-1,1]$ 上的一维三次 Hermite 基函数。一个一般的三次多项式可以写成 $p(\\xi) = a\\xi^3 + b\\xi^2 + c\\xi + d$，其导数为 $p'(\\xi) = 3a\\xi^2 + 2b\\xi + c$。我们必须找到四个这样的多项式，$H_1(\\xi)$、$H_2(\\xi)$、$H_3(\\xi)$ 和 $H_4(\\xi)$，每个多项式都满足一组给定的四个插值条件。\n\n对于 $H_1(\\xi)$，条件是 $H_1(-1)=1$，$H_1'(-1)=0$，$H_1(1)=0$ 和 $H_1'(1)=0$。这导出了关于系数 $(a,b,c,d)$ 的以下线性方程组：\n$$\n\\begin{cases}\n-a + b - c + d = 1 \\\\\na + b + c + d = 0 \\\\\n3a - 2b + c = 0 \\\\\n3a + 2b + c = 0\n\\end{cases}\n$$\n从最后两个方程中，将一个从另一个中减去得到 $4b=0$，所以 $b=0$。将它们相加得到 $6a+2c=0$，所以 $c=-3a$。将 $b=0$ 和 $c=-3a$ 代入前两个方程得到 $-a+3a+d=1$ (即 $2a+d=1$) 和 $a-3a+d=0$ (即 $-2a+d=0$)。从这两个中的第二个方程得到 $d=2a$。将此代入第一个方程得到 $2a+2a=1$，所以 $a=1/4$。因此，$d=1/2$，$c=-3/4$，$b=0$。该多项式为：\n$$H_1(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{3}{4}\\xi + \\frac{1}{2}$$\n\n对于 $H_2(\\xi)$，条件是 $H_2(-1)=0$，$H_2'(-1)=1$，$H_2(1)=0$ 和 $H_2'(1)=0$。该方程组为：\n$$\n\\begin{cases}\n-a + b - c + d = 0 \\\\\na + b + c + d = 0 \\\\\n3a - 2b + c = 1 \\\\\n3a + 2b + c = 0\n\\end{cases}\n$$\n前两个方程意味着 $b+d=0$ 和 $a+c=0$，所以 $d=-b$ 和 $c=-a$。后两个方程得到 $6a+2c=1$ 和 $-4b=1$。从 $-4b=1$ 中，我们有 $b=-1/4$，所以 $d=1/4$。从 $6a+2c=1$ 和 $c=-a$ 中，我们有 $6a-2a=1$，这得到 $a=1/4$。因此，$c=-1/4$。该多项式为：\n$$H_2(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{1}{4}\\xi^2 - \\frac{1}{4}\\xi + \\frac{1}{4}$$\n\n函数 $H_3(\\xi)$ 和 $H_4(\\xi)$ 可以通过对称性找到。$H_3(\\xi)$ 必须满足 $H_3(-1)=0$，$H_3'(-1)=0$，$H_3(1)=1$，$H_3'(1)=0$。这些与 $H_1(-\\xi)$ 满足的条件相同。因此，$H_3(\\xi) = H_1(-\\xi)$:\n$$H_3(\\xi) = \\frac{1}{4}(-\\xi)^3 - \\frac{3}{4}(-\\xi) + \\frac{1}{2} = -\\frac{1}{4}\\xi^3 + \\frac{3}{4}\\xi + \\frac{1}{2}$$\n类似地，$H_4(\\xi)$ 必须满足 $H_4(-1)=0$，$H_4'(-1)=0$，$H_4(1)=0$，$H_4'(1)=1$。这些条件被 $-H_2(-\\xi)$ 满足。因此，$H_4(\\xi) = -H_2(-\\xi)$:\n$$H_4(\\xi) = - \\left( \\frac{1}{4}(-\\xi)^3 - \\frac{1}{4}(-\\xi)^2 - \\frac{1}{4}(-\\xi) + \\frac{1}{4} \\right) = \\frac{1}{4}\\xi^3 + \\frac{1}{4}\\xi^2 - \\frac{1}{4}\\xi - \\frac{1}{4}$$\n\n接下来，我们使用张量积构造在参考正方形 $\\Omega_e$ 上构建双三次 Hermite 形函数。这 16 个自由度 (DOF) 是函数 $u$、其一阶导数 $u_{,\\xi}$ 和 $u_{,\\eta}$ 以及其混合导数 $u_{,\\xi\\eta}$ 在四个角点 $(\\xi_i, \\eta_j)$（其中 $\\xi_i, \\eta_j \\in \\{-1,1\\}$）处的值。近似解 $u_h(\\xi, \\eta)$ 是 16 个形函数的线性组合，每个形函数乘以一个节点自由度。一个形函数 $N(\\xi,\\eta)$ 是 $\\xi$ 中的一维基函数和 $\\eta$ 中的一维基函数的乘积。让我们区分用于函数值的基函数，我们称之为“值”函数 ($H_1, H_3$)，和用于导数值的基函数，即“导数”函数 ($H_2, H_4$)。特定自由度的形函数是通过在每个变量中选择与该自由度类型对应的 1D 函数来构造的。例如，角点处自由度 $u_{,\\xi}$ 的形函数在 $\\xi$ 中涉及一个“导数”函数，在 $\\eta$ 中涉及一个“值”函数。在坐标为 $(\\xi_i, \\eta_j)$ 的角点处，四个形函数是：\n-   对于 $u$：$N^u(\\xi,\\eta) = H_{val}(\\xi, \\xi_i) H_{val}(\\eta, \\eta_j)$\n-   对于 $u_{,\\xi}$：$N^{u_\\xi}(\\xi,\\eta) = H_{der}(\\xi, \\xi_i) H_{val}(\\eta, \\eta_j)$\n-   对于 $u_{,\\eta}$：$N^{u_\\eta}(\\xi,\\eta) = H_{val}(\\xi, \\xi_i) H_{der}(\\eta, \\eta_j)$\n-   对于 $u_{,\\xi\\eta}$：$N^{u_{\\xi\\eta}}(\\xi,\\eta) = H_{der}(\\xi, \\xi_i) H_{der}(\\eta, \\eta_j)$\n其中 $H_{val}(\\cdot, -1)=H_1$，$H_{der}(\\cdot, -1)=H_2$，$H_{val}(\\cdot, 1)=H_3$ 和 $H_{der}(\\cdot, 1)=H_4$。\n\n我们现在论证跨单元边界的 $C^1$ 连续性。考虑两个单元共享的一条边，例如，单元 A 在 $\\xi=1$ 的边和单元 B 在 $\\xi=-1$ 的边。\n函数 $u$ 的连续性要求沿该边的 $u_h(\\xi,\\eta)$ 的迹由该边上的自由度唯一确定。让我们检查沿 $\\xi=1$ 的 $u_h$ 的迹：\n$u_h(1,\\eta)$。完整的展开是所有 16 个自由度的总和。然而，根据构造，$H_1(1)=0$，$H_2(1)=0$，$H_1'(1)=0$ 和 $H_2'(1)=0$。这意味着与 $\\xi=-1$ 处的节点相关联的任何形函数都沿直线 $\\xi=1$ 为零。因此，迹 $u_h(1,\\eta)$ 仅由该边上节点处的自由度确定，即在 $(1,-1)$ 和 $(1,1)$ 处的自由度。表达式简化为：\n$$ u_h(1, \\eta) = u(1,-1)H_3(1)H_1(\\eta) + u_{,\\eta}(1,-1)H_3(1)H_2(\\eta) + u(1,1)H_3(1)H_3(\\eta) + u_{,\\eta}(1,1)H_3(1)H_4(\\eta) $$\n由于 $H_3(1)=1$，这变为：\n$$ u_h(1, \\eta) = u(1,-1)H_1(\\eta) + u_{,\\eta}(1,-1)H_2(\\eta) + u(1,1)H_3(\\eta) + u_{,\\eta}(1,1)H_4(\\eta) $$\n这是沿该边的一维三次 Hermite 表示，完全由该边的两个角节点处的四个节点自由度 $\\{u, u_{,\\eta}\\}$ 定义。\n类似地，对于单元 B，迹 $u_h(-1,\\eta)$ 由其在 $\\xi=-1$ 的边上的自由度 $\\{u, u_{,\\eta}\\}$ 确定。如果两个单元在其公共节点上共享这四个自由度，则函数 $u$ 将在其边界上连续。\n\n一阶导数的连续性要求法向导数的连续性。对于轴对齐的矩形网格，跨越垂直边的法向导数，在相差一个单元雅可比矩阵的缩放因子的情况下，是 $\\frac{\\partial u}{\\partial \\xi}$。我们检查沿 $\\xi=1$ 的 $\\frac{\\partial u_h}{\\partial \\xi}$ 的迹。将 $u_h$ 的展开式对 $\\xi$ 求导并在 $\\xi=1$ 处求值，涉及到诸如 $H_i'(1)$ 的项。根据构造，$H_1'(1)=0, H_2'(1)=0, H_3'(1)=0$，但是 $H_4'(1)=1$。因此，只有涉及 $H_4'(\\xi)$ 或源于 $\\xi=1$ 处自由度 $u_{,\\xi}$ 和 $u_{,\\xi\\eta}$ 的项会保留下来。迹为：\n$$ \\frac{\\partial u_h}{\\partial \\xi}(1,\\eta) = u_{,\\xi}(1,-1)H_4'(1)H_1(\\eta) + u_{,\\xi\\eta}(1,-1)H_4'(1)H_2(\\eta) + u_{,\\xi}(1,1)H_4'(1)H_3(\\eta) + u_{,\\xi\\eta}(1,1)H_4'(1)H_4(\\eta) $$\n由于 $H_4'(1)=1$，这变为：\n$$ \\frac{\\partial u_h}{\\partial \\xi}(1, \\eta) = u_{,\\xi}(1,-1)H_1(\\eta) + u_{,\\xi\\eta}(1,-1)H_2(\\eta) + u_{,\\xi}(1,1)H_3(\\eta) + u_{,\\xi\\eta}(1,1)H_4(\\eta) $$\n这个迹又是一个一维三次 Hermite 表示，由该边的角点处的四个节点自由度 $\\{u_{,\\xi}, u_{,\\xi\\eta}\\}$ 确定。如果这些四个自由度在相邻单元之间共享，则法向导数将是连续的。\n因此，为确保 $C^1$ 连续性，公共边界上节点的所有自由度 $\\{u, u_{,\\xi}, u_{,\\eta}, u_{,\\xi\\eta}\\}$ 都必须共享。张量积构造内在地满足了这一要求，因为任何边上的行为完全由位于该边上的自由度控制。\n\n最后，我们计算对应于角点 $(\\xi, \\eta)=(1,1)$ 处节点位移 $u$ 的形函数在点 $(\\xi,\\eta)=(\\frac{1}{2},-\\frac{1}{2})$ 处的值。这个形函数是 $N(\\xi,\\eta) = H_3(\\xi)H_3(\\eta)$。我们必须计算 $N(\\frac{1}{2}, -\\frac{1}{2}) = H_3(\\frac{1}{2}) H_3(-\\frac{1}{2})$。\n我们使用表达式 $H_3(s) = -\\frac{1}{4}s^3 + \\frac{3}{4}s + \\frac{1}{2}$。\n首先，对于 $s = \\frac{1}{2}$：\n$$ H_3\\left(\\frac{1}{2}\\right) = -\\frac{1}{4}\\left(\\frac{1}{2}\\right)^3 + \\frac{3}{4}\\left(\\frac{1}{2}\\right) + \\frac{1}{2} = -\\frac{1}{4}\\left(\\frac{1}{8}\\right) + \\frac{3}{8} + \\frac{1}{2} = -\\frac{1}{32} + \\frac{12}{32} + \\frac{16}{32} = \\frac{27}{32} $$\n接着，对于 $s = -\\frac{1}{2}$：\n$$ H_3\\left(-\\frac{1}{2}\\right) = -\\frac{1}{4}\\left(-\\frac{1}{2}\\right)^3 + \\frac{3}{4}\\left(-\\frac{1}{2}\\right) + \\frac{1}{2} = -\\frac{1}{4}\\left(-\\frac{1}{8}\\right) - \\frac{3}{8} + \\frac{1}{2} = \\frac{1}{32} - \\frac{12}{32} + \\frac{16}{32} = \\frac{5}{32} $$\n形函数的值是这两个值的乘积：\n$$ N\\left(\\frac{1}{2}, -\\frac{1}{2}\\right) = \\left(\\frac{27}{32}\\right) \\times \\left(\\frac{5}{32}\\right) = \\frac{135}{1024} $$", "answer": "$$\\boxed{\\frac{135}{1024}}$$", "id": "2553873"}, {"introduction": "在构建了具体的 $C^1$ 单元之后，让我们退后一步，审视其背后的普适性原理。要确保两个相邻单元在共享边界上的近似解是连续的，它们的迹（trace）必须完全吻合。本练习 [@problem_id:2553906] 将引导您从多项式相等的基本定义出发，推导出一系列确保场及其法向导数连续的普适代数条件。这个过程不仅揭示了连续性的数学本质，还让您能够通过维度计算，精确地确定实现这种兼容性所需的最小约束数量。", "problem": "考虑两个相邻的二维有限元，它们共享一条直的公共边 $e$，其端点通过仿射参数化 $t \\mapsto \\boldsymbol{x}(t)$ 映射到参数区间 $[-1,1]$。在每个单元上，有限元空间是一阶连续可微的（$C^1$），其边迹是多项式：场 $u$ 沿边 $e$ 的迹属于多项式空间 $\\mathbb{P}_p([-1,1])$，法向导数 $\\partial_{\\boldsymbol{n}} u := \\nabla u \\cdot \\boldsymbol{n}$ 沿边 $e$ 的迹属于 $\\mathbb{P}_q([-1,1])$，其中 $\\boldsymbol{n}$ 是在边 $e$ 上一致选取的固定单位法向量（左单元和右单元的迹都使用相同的 $\\boldsymbol{n}$ 来定义）。令 $u_L(t)$, $u_R(t) \\in \\mathbb{P}_p([-1,1])$ 表示 $u$ 在边 $e$ 上的左右迹，令 $\\lambda_L(t)$, $\\lambda_R(t) \\in \\mathbb{P}_q([-1,1])$ 表示 $\\partial_{\\boldsymbol{n}} u$ 的相应迹。假设在每一侧，这些迹分别在单项式基 $\\{t^k\\}_{k=0}^p$ 和 $\\{t^k\\}_{k=0}^q$ 中表示为：\n$$\nu_L(t) = \\sum_{k=0}^{p} a_{L,k}\\, t^k,\\quad u_R(t) = \\sum_{k=0}^{p} a_{R,k}\\, t^k,\\quad\n\\lambda_L(t) = \\sum_{k=0}^{q} b_{L,k}\\, t^k,\\quad \\lambda_R(t) = \\sum_{k=0}^{q} b_{R,k}\\, t^k,\n$$\n其系数 $\\{a_{L,k}\\}_{k=0}^{p}$、$\\{a_{R,k}\\}_{k=0}^{p}$、$\\{b_{L,k}\\}_{k=0}^{q}$ 和 $\\{b_{R,k}\\}_{k=0}^{q}$ 是先验独立的。\n\n从连续性的定义和多项式相等的基本特征出发，完成以下任务：\n\n1. 推导施加在边系数上的必要和充分的代数条件，这些条件强制 $u$ 及其法向导数 $\\partial_{\\boldsymbol{n}} u$ 跨越边 $e$ 连续，即对于所有 $t \\in [-1,1]$，$u_L(t) = u_R(t)$ 且 $\\lambda_L(t) = \\lambda_R(t)$。你的推导必须独立于任何特定的节点或求积点选择，并且应仅依赖于这样一个事实：同一空间中的两个多项式相等，当且仅当它们在同一组基下的所有系数都相同。\n\n2. 使用你在第1部分的结果和维数计数论证，确定必须施加在 $2(p+1) + 2(q+1)$ 个边系数上的独立标量线性约束的最小数量，以确保这两个连续性条件普遍成立，假设两个单元在边 $e$ 上使用相同的多项式次数 $p$ 和 $q$。将你的最终答案表示为关于 $p$ 和 $q$ 的闭式解析表达式。不需要四舍五入，也没有物理单位。\n\n只需提供第2部分所要求的最终表达式作为你的最终答案。", "solution": "问题陈述经过了验证，并且被认为是科学上合理的、适定的和客观的。它代表了有限元方法中的一个标准理论问题。没有发现可识别的缺陷。我们可以开始解答。\n\n问题要求推导跨共享单元边的连续性条件，并且随后列举这些条件。推导必须基于多项式相等的基本原理。\n\n一个多项式由其在给定基下的系数唯一确定。在同一基 $\\{\\phi_k(t)\\}_{k=0}^{n}$ 下表示的两个多项式 $P(t) = \\sum_{k=0}^{n} c_k \\phi_k(t)$ 和 $Q(t) = \\sum_{k=0}^{n} d_k \\phi_k(t)$，在一个区间内对所有 $t$ 都相等，当且仅当它们的对应系数相等，即对所有 $k \\in \\{0, 1, \\dots, n\\}$ 都有 $c_k = d_k$。这源于基函数的线性无关性。如果 $P(t) = Q(t)$，那么它们的差是零多项式：$\\sum_{k=0}^{n} (c_k - d_k) \\phi_k(t) = 0$。$\\{\\phi_k(t)\\}$ 的线性无关性意味着这个线性组合的所有系数都必须为零，因此 $c_k - d_k = 0$。这就证明了条件的必要性和充分性。我们将这个原理应用于给定的问题。\n\n单项式基 $\\{t^k\\}$ 在任何区间（包括 $[-1, 1]$）上都是一组线性无关的函数。\n\n第1部分：条件推导。\n\n首先，我们强制场 $u$ 的连续性。条件是对于所有 $t \\in [-1, 1]$，来自左单元的迹 $u_L(t)$ 必须与来自右单元的迹 $u_R(t)$ 完全相同。\n$$\nu_L(t) = u_R(t) \\quad \\forall t \\in [-1, 1]\n$$\n代入在单项式基中的给定多项式表示：\n$$\n\\sum_{k=0}^{p} a_{L,k}\\, t^k = \\sum_{k=0}^{p} a_{R,k}\\, t^k\n$$\n这个方程可以重新整理，将两个多项式相等表示为单个多项式恒等于零：\n$$\n\\sum_{k=0}^{p} a_{L,k}\\, t^k - \\sum_{k=0}^{p} a_{R,k}\\, t^k = 0\n$$\n$$\n\\sum_{k=0}^{p} (a_{L,k} - a_{R,k})\\, t^k = 0 \\quad \\forall t \\in [-1, 1]\n$$\n根据上述多项式相等原理，要使这个 $p$ 次多项式在一个区间上为零，其所有系数都必须为零。这给出了关于系数 $\\{a_{L,k}\\}$ 和 $\\{a_{R,k}\\}$ 的以下必要和充分条件集：\n$$\na_{L,k} - a_{R,k} = 0 \\quad \\text{for } k = 0, 1, \\dots, p\n$$\n或等价地，\n$$\na_{L,k} = a_{R,k} \\quad \\text{for } k = 0, 1, \\dots, p\n$$\n\n其次，我们强制法向导数 $\\partial_{\\boldsymbol{n}} u$ 的连续性。条件是对于所有 $t \\in [-1, 1]$，来自左侧的法向导数迹 $\\lambda_L(t)$ 必须等于来自右侧的迹 $\\lambda_R(t)$。\n$$\n\\lambda_L(t) = \\lambda_R(t) \\quad \\forall t \\in [-1, 1]\n$$\n代入来自空间 $\\mathbb{P}_q([-1,1])$ 的多项式表示：\n$$\n\\sum_{k=0}^{q} b_{L,k}\\, t^k = \\sum_{k=0}^{q} b_{R,k}\\, t^k\n$$\n遵循与场 $u$ 相同的逻辑，我们重新整理方程：\n$$\n\\sum_{k=0}^{q} (b_{L,k} - b_{R,k})\\, t^k = 0 \\quad \\forall t \\in [-1, 1]\n$$\n单项式基函数 $\\{t^k\\}_{k=0}^q$ 的线性无关性要求每个系数都为零。这产生了关于系数 $\\{b_{L,k}\\}$ 和 $\\{b_{R,k}\\}$ 的必要和充分条件：\n$$\nb_{L,k} - b_{R,k} = 0 \\quad \\text{for } k = 0, 1, \\dots, q\n$$\n或等价地，\n$$\nb_{L,k} = b_{R,k} \\quad \\text{for } k = 0, 1, \\dots, q\n$$\n这就完成了代数条件的推导。\n\n第2部分：约束计数。\n\n问题要求施加在总共 $2(p+1) + 2(q+1)$ 个系数上的独立标量线性约束的最小数量。一个约束是关联这些系数的一个线性代数方程。\n\n对于场 $u$ 的连续性，条件是对于从 $0$ 到 $p$ 的每个索引值 $k$，都有 $a_{L,k} = a_{R,k}$。索引 $k$ 取 $p+1$ 个不同的整数值（$0, 1, \\dots, p$）。因此，我们得到一个包含 $p+1$ 个线性方程的方程组。每个方程 $a_{L,k} - a_{R,k} = 0$ 都涉及一对唯一的系数 $(a_{L,k}, a_{R,k})$，这对系数不出现在该方程组的任何其他方程中。因此，这 $p+1$ 个约束是线性无关的。\n\n对于法向导数 $\\partial_{\\boldsymbol{n}} u$ 的连续性，条件是对于从 $0$ 到 $q$ 的每个索引值 $k$，都有 $b_{L,k} = b_{R,k}$。索引 $k$ 取 $q+1$ 个不同的整数值（$0, 1, \\dots, q$）。这给出了一个包含 $q+1$ 个线性方程的方程组。类似地，这 $q+1$ 个约束是线性无关的。\n\n总的系数集被划分为 $\\{a_{L,k}, a_{R,k}\\}$ 和 $\\{b_{L,k}, b_{R,k}\\}$。第一组约束只涉及 'a' 系数，第二组只涉及 'b' 系数。因此，这两组约束本身是相互独立的。\n\n独立标量线性约束的总数是场的约束数量与其法向导数的约束数量之和。\n约束总数 = ($u$ 的约束数量) + ($\\partial_{\\boldsymbol{n}} u$ 的约束数量)\n$$\n\\text{Total constraints} = (p+1) + (q+1)\n$$\n简化此表达式得到最终结果：\n$$\n\\text{Total constraints} = p+q+2\n$$\n这是在问题所定义的意义上，确保跨边 $C^1$ 连续性所需的最小约束数量。这可以通过维数计数论证来理解。系数空间的初始维数是 $2(p+1) + 2(q+1)$。施加连续性条件后，自由度减少到 $(p+1) + (q+1)$，因为一个单元的系数决定了相邻单元的系数。维数的减少量，也就是约束的数量，是 $[2(p+1) + 2(q+1)] - [(p+1) + (q+1)] = (p+1) + (q+1) = p+q+2$。", "answer": "$$\\boxed{p+q+2}$$", "id": "2553906"}, {"introduction": "我们已经学习了如何构建并理论上保证单元间的连续性，但这是否意味着只要保证了沿每条边的连续性，就能实现全局的 $C^1$ 连续性呢？尤其是在多个单元交汇的顶点处，情况是否依然如此？本练习 [@problem_id:2553950] 提供了一个深刻的反例，旨在揭示这一问题中的陷阱。通过一个具体的函数构造，您将验证即使函数值及其切向导数在单元边界上处处连续，其梯度在共享顶点处仍可能发生跳变，从而破坏全局的 $C^1$ 光滑性。", "problem": "考虑在有限元方法（FEM）中，在三角剖分上构造全局 $C^{1}$ 函数的以下设置。令 $\\Omega = [0,1] \\times [0,1] \\subset \\mathbb{R}^{2}$ 被从 $(1,0)$ 到 $(0,1)$ 的对角线划分为两个三角形：\n- $T_{1} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$,\n- $T_{2} = \\operatorname{conv}\\{(1,1),(1,0),(0,1)\\}$.\n共享的内部边为 $E = \\{(s,1-s) : s \\in [0,1]\\}$，其单位切向量为 $t = \\frac{1}{\\sqrt{2}}(1,-1)$。\n\n定义一个分片多项式 $u$ 如下：\n- $u|_{T_{1}}(x,y) = p_{1}(x,y) = x(x+y-1)$,\n- $u|_{T_{2}}(x,y) = p_{2}(x,y) = y(x+y-1)$.\n\n仅使用 $C^{0}$ 和 $C^{1}$ 连续性以及沿边的切向导数的基本定义：如果一个函数在一条边上的迹（traces）相匹配，则它在该边上是 $C^{0}$ 连续的；如果除此之外，它的梯度也沿该边匹配，则它在该边上是 $C^{1}$ 连续的；切向导数是沿该边的 $\\partial_{t} u = \\nabla u \\cdot t$。\n\n任务：\n1) 根据第一性原理验证，沿着 $E$ 的整个内部，来自 $T_{1}$ 和 $T_{2}$ 的 $u$ 的迹重合，并且 $\\partial_{t} u$ 在 $E$ 上也是连续的（即，来自 $T_{1}$ 和 $T_{2}$ 的切向导数沿着 $E$ 重合）。\n2) 在顶点 $v = (1,0)$ 处计算梯度 $\\nabla p_{1}$ 和 $\\nabla p_{2}$，并解释为什么尽管 $u$ 和 $\\partial_{t} u$ 满足边上的连续性，但这表明 $u$ 在 $v$ 点不是 $C^{1}$ 的。\n3) 设在 $v$ 点的梯度跳跃为向量 $J = \\nabla p_{1}(v) - \\nabla p_{2}(v)$。精确计算欧几里得范数 $\\|J\\|_{2}$。\n\n请给出 $\\|J\\|_{2}$ 的精确值作为最终答案（无单位，不四舍五入）。", "solution": "问题陈述经核实具有科学依据、问题明确且客观。它提出了有限元方法（FEM）中关于单元间连续性的一个标准的、非平凡的练习。我们将继续进行解答。\n\n该问题要求我们分析定义在区域 $\\Omega = [0,1] \\times [0,1]$ 上的分片多项式函数 $u$ 的连续性，该区域被划分为两个三角形 $T_{1} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$ 和 $T_{2} = \\operatorname{conv}\\{(1,1),(1,0),(0,1)\\}$。函数 $u$ 定义为 $u|_{T_{1}}(x,y) = p_{1}(x,y) = x(x+y-1)$ 和 $u|_{T_{2}}(x,y) = p_{2}(x,y) = y(x+y-1)$。共享边为 $E = \\{(s, 1-s) : s \\in [0,1]\\}$。\n\n**任务 1：验证沿边 $E$ 的 $C^{0}$ 连续性和切向导数连续性。**\n\n首先，我们验证 $C^{0}$ 连续性。如果一个函数在一条边上，其来自两个相邻单元的值（迹）在整条边上重合，则该函数在该边上是 $C^{0}$ 连续的。边 $E$ 上的点 $(x,y)$ 满足线性方程 $x+y-1=0$。\n$p_{1}$ 在 $E$ 上的迹可以通过将其表达式中的 $y=1-x$（或者更一般地，识别出 $x+y-1=0$）代入得到：\n$$ u|_{T_{1}, E} = p_{1}(x,y)|_{x+y-1=0} = x(0) = 0 $$\n$p_{2}$ 在 $E$ 上的迹可以类似地计算：\n$$ u|_{T_{2}, E} = p_{2}(x,y)|_{x+y-1=0} = y(0) = 0 $$\n由于两个迹在边 $E$ 上恒等于零，因此我们在 $E$ 上有 $p_{1} = p_{2}$。所以，函数 $u$ 在边 $E$ 的内部是 $C^{0}$ 连续的。\n\n接下来，我们验证切向导数 $\\partial_{t}u = \\nabla u \\cdot t$ 的连续性，其中 $t = \\frac{1}{\\sqrt{2}}(1,-1)$ 是 $E$ 的单位切向量。我们必须首先计算 $p_{1}$ 和 $p_{2}$ 的梯度。\n对于 $p_{1}(x,y) = x^{2} + xy - x$，梯度为：\n$$ \\nabla p_{1}(x,y) = \\left( \\frac{\\partial p_{1}}{\\partial x}, \\frac{\\partial p_{1}}{\\partial y} \\right) = (2x + y - 1, x) $$\n对于 $p_{2}(x,y) = xy + y^{2} - y$，梯度为：\n$$ \\nabla p_{2}(x,y) = \\left( \\frac{\\partial p_{2}}{\\partial x}, \\frac{\\partial p_{2}}{\\partial y} \\right) = (y, x + 2y - 1) $$\n现在，我们沿边 $E$ 计算这些梯度，该边可以参数化为 $(x,y) = (s, 1-s)$，其中 $s \\in [0,1]$。\n梯度 $\\nabla p_{1}$ 在 $E$ 上的迹为：\n$$ \\nabla p_{1}(s, 1-s) = (2s + (1-s) - 1, s) = (s, s) $$\n梯度 $\\nabla p_{2}$ 在 $E$ 上的迹为：\n$$ \\nabla p_{2}(s, 1-s) = (1-s, s + 2(1-s) - 1) = (1-s, 1-s) $$\n现在我们计算沿边 $E$ 的切向导数，其中 $s \\in (0,1)$：\n对于 $p_{1}$：\n$$ \\partial_{t} p_{1}|_{E} = \\nabla p_{1}(s, 1-s) \\cdot t = (s,s) \\cdot \\frac{1}{\\sqrt{2}}(1,-1) = \\frac{1}{\\sqrt{2}}(s \\cdot 1 + s \\cdot (-1)) = \\frac{1}{\\sqrt{2}}(s-s) = 0 $$\n对于 $p_{2}$：\n$$ \\partial_{t} p_{2}|_{E} = \\nabla p_{2}(s, 1-s) \\cdot t = (1-s, 1-s) \\cdot \\frac{1}{\\sqrt{2}}(1,-1) = \\frac{1}{\\sqrt{2}}((1-s) \\cdot 1 + (1-s) \\cdot (-1)) = 0 $$\n由于来自两侧的切向导数沿边 $E$ 的内部恒等于零，所以 $\\partial_{t} u$ 确实在 $E$ 上是连续的。\n\n**任务 2：分析顶点 $v = (1,0)$ 处的连续性。**\n\n为了使一个函数在区域 $\\Omega$ 内是 $C^{1}$ 连续的，其梯度必须在 $\\Omega$ 中的每一点都连续。这要求在共享边界上的任何一点，无论从哪个方向逼近（即，从哪个单元），梯度都必须有一个唯一的值。我们在顶点 $v=(1,0)$ 测试这个条件，该顶点是 $T_{1}$ 和 $T_{2}$ 的共享顶点。\n\n我们在此顶点处计算 $p_{1}$ 和 $p_{2}$ 的梯度：\n$$ \\nabla p_{1}(1,0) = (2(1) + 0 - 1, 1) = (1,1) $$\n$$ \\nabla p_{2}(1,0) = (0, 1 + 2(0) - 1) = (0,0) $$\n当 $(x,y)$ 从 $T_{1}$ 内部逼近 $v=(1,0)$ 时，$u$ 的梯度的极限是 $(1,1)$，而从 $T_{2}$ 内部逼近时的极限是 $(0,0)$。由于 $\\nabla p_{1}(v) \\neq \\nabla p_{2}(v)$，函数 $u$ 的梯度在顶点 $v$ 处没有唯一定义。因此，$u$ 在 $v$ 点不可微，并且在 $v$ 的任何开邻域内都不是 $C^{1}$ 的，因此在 $\\Omega$ 上不是 $C^{1}$ 的。\n\n对于 $u$ 及其切向导数 $\\partial_{t} u$ 满足边上的连续性是其在单元相交的顶点处具有 $C^{1}$ 连续性的必要但不充分条件。一个顶点涉及所有相邻单元的约束，确保完整梯度向量的连续性比确保沿一条边的单个方向导数的连续性是一个更严格的条件。这个例子说明了构造 $C^{1}$ 有限元的一个基本困难。\n\n**任务 3：计算梯度跳跃的范数。**\n\n在顶点 $v=(1,0)$ 处的梯度跳跃定义为向量 $J = \\nabla p_{1}(v) - \\nabla p_{2}(v)$。使用任务 2 中计算的值：\n$$ J = (1,1) - (0,0) = (1,1) $$\n这个跳跃向量的欧几里得范数 $\\|J\\|_{2}$ 计算如下：\n$$ \\|J\\|_{2} = \\sqrt{1^{2} + 1^{2}} = \\sqrt{1 + 1} = \\sqrt{2} $$\n这个非零跳跃量化了梯度在顶点 $v$ 处的不连续性。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "2553950"}]}