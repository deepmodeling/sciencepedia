{"hands_on_practices": [{"introduction": "我们的第一个练习是先验分析方法的基础训练。我们将处理一个简单的一维泊松问题，并解析地计算连续性常数和矫顽力常数，并会发现它们都是理想值。这个练习将提升您应用基本定义的技能，并最终计算一个光滑解的精确最佳逼近误差，为有限元方法致力于实现的目标提供一个具体的基准。[@problem_id:2539828]", "problem": "令 $\\Omega=(0,1)$ 且 $V=H_{0}^{1}(0,1)$。考虑双线性形式 $a:V\\times V\\to\\mathbb{R}$，定义为 $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,dx$。为 $V$ 配备能量范数 $\\|v\\|_{E}=\\left(\\int_{0}^{1}|v'(x)|^{2}\\,dx\\right)^{1/2}$。\n\n任务 A. 仅使用柯西-施瓦茨不等式以及希尔伯特空间上双线性形式的连续性常数和矫顽性常数的定义，确定 $a(\\cdot,\\cdot)$ 关于范数 $\\|\\cdot\\|_{E}$ 的连续性常数 $M$ 和矫顽性常数 $\\alpha$。\n\n任务 B. 设 $\\{\\mathcal{T}_{h}\\}$ 是 $\\Omega$ 上的一个均匀网格族，包含 $N$ 个等长子区间，长度为 $h=1/N$。令 $V_{h}\\subset V$ 表示在 $\\mathcal{T}_{h}$ 上的协调空间，由在 $x=0$ 和 $x=1$ 处满足齐次狄利克雷边界条件的连续分片线性函数构成。对于目标函数 $u(x)=\\sin(\\pi x)$，计算在能量范数下从 $V_{h}$ 出发的最佳逼近误差的精确值，即\n$$\n\\inf_{v_{h}\\in V_{h}} \\|u-v_{h}\\|_{E},\n$$\n以 $h$ 的显式函数形式给出封闭解。你的最终答案必须是关于 $h$ 的单个封闭形式表达式。", "solution": "所给问题是有限元方法基本理论中的一个适定性练习。它在数学上是合理的、自洽的，并且所有术语都根据该领域的标准惯例定义。我将开始解答。\n\n问题包括两个任务。我将按顺序解决它们。\n\n任务 A：确定连续性常数和矫顽性常数。\n\n空间为 $V = H_{0}^{1}(0,1)$，配备范数 $\\|v\\|_{E} = \\left(\\int_{0}^{1}|v'(x)|^{2}\\,dx\\right)^{1/2}$。双线性形式为 $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,dx$。\n\n首先，我们确定连续性常数 $M$。连续性的定义要求找到最小的 $M \\in \\mathbb{R}$，使得对于所有 $u, v \\in V$：\n$$\n|a(u,v)| \\le M \\|u\\|_{E} \\|v\\|_{E}\n$$\n我们从 $a(u,v)$ 的定义开始，并对导数的乘积 $u'(x)$ 和 $v'(x)$ 应用积分形式的柯西-施瓦茨不等式。\n$$\n|a(u,v)| = \\left|\\int_{0}^{1} u'(x)\\,v'(x)\\,dx\\right| \\le \\left(\\int_{0}^{1} |u'(x)|^{2}\\,dx\\right)^{1/2} \\left(\\int_{0}^{1} |v'(x)|^{2}\\,dx\\right)^{1/2}\n$$\n根据能量范数 $\\|\\cdot\\|_{E}$ 的定义，右侧恰好是 $\\|u\\|_{E} \\|v\\|_{E}$。因此，我们有：\n$$\n|a(u,v)| \\le \\|u\\|_{E} \\|v\\|_{E}\n$$\n这个不等式表明，当 $M \\le 1$ 时，连续性条件得到满足。为了确定精确常数是 $M=1$，我们必须证明这个界是可以达到的。考虑任意非零函数 $u \\in V$。如果我们选择 $v=u$，我们有：\n$$\n|a(u,u)| = \\left|\\int_{0}^{1} (u'(x))^{2}\\,dx\\right| = \\int_{0}^{1} |u'(x)|^{2}\\,dx = \\|u\\|_{E}^2\n$$\n在这种情况下，不等式 $|a(u,u)| \\le M \\|u\\|_{E} \\|u\\|_{E}$ 变为 $\\|u\\|_{E}^2 \\le M \\|u\\|_{E}^2$，对于非零的 $u$ 这意味着 $M \\ge 1$。结合 $M \\le 1$ 和 $M \\ge 1$，我们得出结论，精确的连续性常数是 $M=1$。\n\n接下来，我们确定矫顽性常数 $\\alpha$。矫顽性的定义要求找到最大的 $\\alpha > 0$，使得对于所有 $v \\in V$：\n$$\na(v,v) \\ge \\alpha \\|v\\|_{E}^{2}\n$$\n从双线性形式 $a(\\cdot,\\cdot)$ 和能量范数 $\\|\\cdot\\|_{E}$ 的定义，我们有：\n$$\na(v,v) = \\int_{0}^{1} v'(x)\\,v'(x)\\,dx = \\int_{0}^{1} |v'(x)|^{2}\\,dx\n$$\n能量范数的平方是：\n$$\n\\|v\\|_{E}^{2} = \\left(\\left(\\int_{0}^{1}|v'(x)|^{2}\\,dx\\right)^{1/2}\\right)^2 = \\int_{0}^{1} |v'(x)|^{2}\\,dx\n$$\n显而易见，$a(v,v) = \\|v\\|_{E}^{2}$。矫顽性不等式变为 $\\|v\\|_{E}^{2} \\ge \\alpha \\|v\\|_{E}^{2}$。对于任何非零的 $v$，这当且仅当 $\\alpha \\le 1$ 时成立。因此，最大的此类常数是 $\\alpha=1$。\n\n任务 B：计算最佳逼近误差。\n\n我们被要求计算 $u(x)=\\sin(\\pi x)$ 的 $\\inf_{v_{h}\\in V_{h}} \\|u-v_{h}\\|_{E}$。空间 $(V, a(\\cdot, \\cdot))$ 是一个希尔伯特空间，其内积由双线性形式 $a(\\cdot,\\cdot)$ 给出。有限元空间 $V_h$ 是 $V$ 的一个闭子空间。根据希尔伯特投影定理，对于任何 $u \\in V$，存在唯一的最佳逼近 $u_h^* \\in V_h$，它在所有 $v_h \\in V_h$ 中最小化距离 $\\|u-v_h\\|_E$。这个最佳逼近是 $u$ 在 $V_h$ 上的正交投影，由正交性条件定义：\n$$\na(u - u_h^*, v_h) = 0 \\quad \\forall v_h \\in V_h\n$$\n这是 $u$ 到 $V_h$ 上的里兹-伽辽金投影的定义。\n\n对于使用分片线性元的一维问题，一个关键性质是里兹-伽辽金投影 $u_h^*$ 与标准拉格朗日插值 $I_h u$ 是相同的。我们来证明这一点。设 $I_h u$ 是连续分片线性函数，使得对于网格 $\\mathcal{T}_h$ 的所有节点 $x_i$，有 $(I_h u)(x_i) = u(x_i)$。我们必须证明对于所有 $v_h \\in V_h$，有 $a(u - I_h u, v_h) = 0$。\n任何 $v_h \\in V_h$ 的导数都是分片常数。设网格的子区间为 $K_j = [x_j, x_{j+1}]$，其中 $j=0, \\dots, N-1$。\n$$\na(u - I_h u, v_h) = \\int_0^1 (u - I_h u)'(x) v_h'(x) dx = \\sum_{j=0}^{N-1} \\int_{K_j} (u - I_h u)'(x) v_h'(x) dx\n$$\n由于 $v_h'$ 在每个 $K_j$ 上是常数，比如说对于 $x \\in (x_j, x_{j+1})$ 有 $v_h'(x) = c_j$，我们有：\n$$\na(u - I_h u, v_h) = \\sum_{j=0}^{N-1} c_j \\int_{x_j}^{x_{j+1}} (u - I_h u)'(x) dx\n$$\n根据微积分基本定理，由于 $u-I_h u \\in H^1(0,1)$ 因而绝对连续，该定理适用：\n$$\n\\int_{x_j}^{x_{j+1}} (u - I_h u)'(x) dx = (u - I_h u)(x_{j+1}) - (u - I_h u)(x_j)\n$$\n根据拉格朗日插值的定义，在所有节点 $x_k$ 处，有 $(u - I_h u)(x_k) = u(x_k) - (I_h u)(x_k) = u(x_k) - u(x_k) = 0$。因此，对于每个子区间 $K_j$，该积分为 $0 - 0 = 0$。这证明了对于所有 $v_h \\in V_h$，有 $a(u - I_h u, v_h) = 0$。\n因此，最佳逼近 $u_h^*$ 确实是插值 $I_h u$。我们必须计算的量是 $\\|u - I_h u\\|_E$。\n\n利用我们刚刚证明的伽辽金正交性 $a(u - I_h u, I_h u) = 0$，我们可以写出：\n$$\n\\|u - I_h u\\|_E^2 = a(u - I_h u, u - I_h u) = a(u - I_h u, u) - a(u - I_h u, I_h u) = a(u,u) - a(I_h u, u)\n$$\n我们分别计算这两项。第一项是 $u$ 的范数的平方：\n$$\na(u,u) = \\|u\\|_E^2 = \\int_0^1 (u'(x))^2 dx = \\int_0^1 (\\pi\\cos(\\pi x))^2 dx = \\pi^2 \\int_0^1 \\cos^2(\\pi x) dx\n$$\n$$\na(u,u) = \\pi^2 \\int_0^1 \\frac{1+\\cos(2\\pi x)}{2} dx = \\pi^2 \\left[\\frac{x}{2} + \\frac{\\sin(2\\pi x)}{4\\pi}\\right]_0^1 = \\pi^2 \\left(\\frac{1}{2}\\right) = \\frac{\\pi^2}{2}\n$$\n第二项是 $a(I_h u, u) = \\int_0^1 (I_h u)'(x) u'(x) dx$。我们通过对单元求和来计算它：\n$$\na(I_h u, u) = \\sum_{j=0}^{N-1} \\int_{x_j}^{x_{j+1}} (I_h u)'(x) u'(x) dx\n$$\n在单元 $K_j = [x_j, x_{j+1}]$ 上，其中 $x_j=jh$，线性插值的导数是常数：\n$$\n(I_h u)'(x) = \\frac{u(x_{j+1}) - u(x_j)}{h} = \\frac{\\sin(\\pi(j+1)h) - \\sin(\\pi j h)}{h}\n$$\n$K_j$ 上的积分是：\n$$\n\\left(\\frac{\\sin(\\pi(j+1)h) - \\sin(\\pi j h)}{h}\\right) \\int_{jh}^{(j+1)h} \\pi\\cos(\\pi x)dx = \\frac{\\sin(\\pi(j+1)h) - \\sin(\\pi j h)}{h} [\\sin(\\pi x)]_{jh}^{(j+1)h}\n$$\n$$\n= \\frac{(\\sin(\\pi(j+1)h) - \\sin(\\pi j h))^2}{h}\n$$\n对所有单元 $j=0, \\dots, N-1$ 求和：\n$$\na(I_h u, u) = \\frac{1}{h} \\sum_{j=0}^{N-1} (\\sin(\\pi(j+1)h) - \\sin(\\pi j h))^2\n$$\n使用恒等式 $\\sin(A) - \\sin(B) = 2\\cos\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$：\n$$\n\\sin(\\pi(j+1)h) - \\sin(\\pi j h) = 2\\cos\\left(\\pi(j+1/2)h\\right)\\sin\\left(\\frac{\\pi h}{2}\\right)\n$$\n所以，求和变为：\n$$\na(I_h u, u) = \\frac{1}{h} \\sum_{j=0}^{N-1} 4\\sin^2\\left(\\frac{\\pi h}{2}\\right)\\cos^2\\left(\\pi(j+1/2)h\\right) = \\frac{4\\sin^2(\\pi h/2)}{h} \\sum_{j=0}^{N-1} \\cos^2\\left(\\pi(j+1/2)h\\right)\n$$\n我们计算余弦平方和：\n$$\n\\sum_{j=0}^{N-1} \\cos^2\\left(\\pi(j+1/2)h\\right) = \\sum_{j=0}^{N-1} \\frac{1+\\cos(2\\pi(j+1/2)h)}{2} = \\frac{N}{2} + \\frac{1}{2}\\sum_{j=0}^{N-1}\\cos(\\pi(2j+1)h)\n$$\n余弦和是几何级数 $\\sum_{j=0}^{N-1} \\exp(i\\pi(2j+1)h) = e^{i\\pi h}\\sum_{j=0}^{N-1} (e^{i2\\pi h})^j$ 的实部。由于 $h=1/N$ 且 $N>1$，公比 $e^{i2\\pi h} \\ne 1$。该和为 $e^{i\\pi h}\\frac{1-e^{i2\\pi hN}}{1-e^{i2\\pi h}} = e^{i\\pi h}\\frac{1-e^{i2\\pi}}{1-e^{i2\\pi h}} = 0$。因此，$\\sum_{j=0}^{N-1}\\cos(\\pi(2j+1)h) = 0$。\n余弦平方和简化为 $N/2$。因此：\n$$\na(I_h u, u) = \\frac{4\\sin^2(\\pi h/2)}{h} \\left(\\frac{N}{2}\\right) = \\frac{2N\\sin^2(\\pi h/2)}{h}\n$$\n代入 $N=1/h$：\n$$\na(I_h u, u) = \\frac{2\\sin^2(\\pi h/2)}{h^2}\n$$\n使用恒等式 $2\\sin^2(\\theta) = 1-\\cos(2\\theta)$，这可以写成：\n$$\na(I_h u, u) = \\frac{1-\\cos(\\pi h)}{h^2}\n$$\n最后，我们计算误差的平方：\n$$\n\\|u - I_h u\\|_E^2 = a(u,u) - a(I_h u, u) = \\frac{\\pi^2}{2} - \\frac{1-\\cos(\\pi h)}{h^2}\n$$\n最佳逼近误差是该量的平方根。", "answer": "$$\n\\boxed{\\left(\\frac{\\pi^2}{2} - \\frac{1-\\cos(\\pi h)}{h^2}\\right)^{1/2}}\n$$", "id": "2539828"}, {"introduction": "理论通过实践得以鲜活。这项练习要求您编写一个程序，以数值方式验证Céa引理的核心论述。通过计算实际的伽辽金误差和最佳逼近误差，您将亲眼看到它们的比值受稳定性常数 $M/ \\alpha$ 控制，而在这种理想情况下，该常数恰好为1。这个练习对于培养泛函分析中的抽象概念如何转化为具体数值结果的直觉至关重要。[@problem_id:2539864]", "problem": "考虑单位区间上具有齐次狄利克雷边界条件的一维泊松边界值问题：求 $u \\in H_0^1(0,1)$ 使得\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = u(1) = 0,\n$$\n其变分形式为：求满足下式的 $u \\in H_0^1(0,1)$\n$$\na(u,w) = \\ell(w) \\quad \\text{for all } w \\in H_0^1(0,1),\n$$\n其中双线性形式和线性形式由下式给出\n$$\na(v,w) := \\int_0^1 v'(x)\\,w'(x)\\,dx, \\qquad \\ell(w) := \\int_0^1 f(x)\\,w(x)\\,dx.\n$$\n设精确解选为\n$$\nu(x) := e^x \\sin(\\pi x),\n$$\n从而 $f$ 由该方程确定。定义由 $a(\\cdot,\\cdot)$ 导出的能量范数为\n$$\n\\|v\\|_a := \\sqrt{a(v,v)} = \\left(\\int_0^1 |v'(x)|^2\\,dx\\right)^{1/2}.\n$$\n\n设 $V_h \\subset H_0^1(0,1)$ 为在一个包含 $N$ 个单元的均匀网格上的标准连续分片线性有限元空间，其节点为 $x_i = i/N$（$i=0,1,\\dots,N$），且唯一的自由度位于内部节点 $x_1,\\dots,x_{N-1}$。伽辽金有限元近似 $u_h \\in V_h$ 由下式定义\n$$\na(u_h,w_h) = \\ell(w_h) \\quad \\text{for all } w_h \\in V_h.\n$$\n定义 $u$ 在 $V_h$ 中的 $a(\\cdot,\\cdot)$-最佳逼近 $p_h$ 为满足下式的唯一单元\n$$\na(u - p_h, w_h) = 0 \\quad \\text{for all } w_h \\in V_h,\n$$\n等价地，$a(p_h,w_h) = a(u,w_h)$ 对所有 $w_h \\in V_h$ 成立。\n\n您的任务是实现一个程序，对一小组网格尺寸的测试集，数值计算比率\n$$\nR_h := \\frac{\\|u - u_h\\|_a}{\\inf_{v_h \\in V_h} \\|u - v_h\\|_a} = \\frac{\\|u - u_h\\|_a}{\\|u - p_h\\|_a},\n$$\n并验证该比率被一个理想上界一致地约束，该上界源于 $a(\\cdot,\\cdot)$ 相对于 $\\|\\cdot\\|_a$ 的连续性和矫顽性属性。具体来说，您的程序必须：\n- 组装对应于 $V_h$ 上的 $a(\\cdot,\\cdot)$ 的刚度矩阵。\n- 使用由所选精确解 $u$ 导出的精确右端项 $f$ 来组装对应于 $\\ell(\\cdot)$ 的载荷向量。\n- 通过求解伽辽金系统来计算 $u_h$。\n- 通过求解 $a(\\cdot,\\cdot)$-正交投影系统来计算 $p_h$，即组装右端项，其元素为 $a(u,\\phi_i)$，其中 $\\{\\phi_i\\}$ 是 $V_h$ 的节点基函数。\n- 通过对 $\\int_0^1 |(u' - u_h')|^2\\,dx$ 和 $\\int_0^1 |(u' - p_h')|^2\\,dx$ 进行精确的数值积分，来评估能量范数误差 $\\|u - u_h\\|_a$ 和 $\\|u - p_h\\|_a$。\n- 从第一性原理出发，确定 $a(\\cdot,\\cdot)$ 相对于 $\\|\\cdot\\|_a$ 的连续性常数 $M$ 和矫顽性常数 $\\alpha$。使用这些常数来得出 $R_h$ 的理想一致上界。\n- 返回测试集的比率列表 $R_h$ 和用于验证的上界，以及一个布尔值，指示所有比率是否在一个小的数值容差范围内满足该上界。\n\n使用以下网格单元数（单元数量）的测试集：$N \\in \\{2,4,8,16\\}$。这些选择测试了：\n- $N=2$：一个具有单个内部自由度的最小非平凡空间（边界情况）。\n- $N=4$：一个粗网格（一般情况）。\n- $N=8$ 和 $N=16$：逐渐加密的网格，以测试加密下的稳定性。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，具体格式如下\n$$\n[\\;R_{2},\\;R_{4},\\;R_{8},\\;R_{16},\\;B,\\;T\\;],\n$$\n其中 $R_{N}$ 表示给定 $N$ 的计算比率，$B$ 是从连续性和矫顽性常数导出的计算理想上界，而 $T$ 是一个布尔值，指示所有比率是否在加上一个小的正容差（您可以选择一个合理的固定容差，例如 $10^{-8}$）后小于或等于 $B$。所有输出都是无量纲的实数或布尔值；不涉及任何物理单位或角度。最终输出的类型必须是：每个 $R_N$ 和 $B$ 为浮点数，T 为布尔值。", "solution": "问题陈述需经过验证。\n\n### 步骤1：提取已知条件\n- **问题**：一维泊松方程 $- u''(x) = f(x)$，定义于 $x \\in (0,1)$，具有齐次狄利克雷边界条件 $u(0) = u(1) = 0$。\n- **变分形式**：求 $u \\in H_0^1(0,1)$ 使得对所有 $w \\in H_0^1(0,1)$ 均有 $a(u,w) = \\ell(w)$。\n- **双线性形式**：$a(v,w) := \\int_0^1 v'(x)\\,w'(x)\\,dx$。\n- **线性形式**：$\\ell(w) := \\int_0^1 f(x)\\,w(x)\\,dx$。\n- **精确解**：$u(x) := e^x \\sin(\\pi x)$。这决定了 $f(x) = -u''(x)$。\n- **能量范数**：$\\|v\\|_a := \\sqrt{a(v,v)} = \\left(\\int_0^1 |v'(x)|^2\\,dx\\right)^{1/2}$。\n- **有限元空间**：$V_h \\subset H_0^1(0,1)$ 是在具有 $N$ 个单元的均匀网格上的连续分片线性函数空间，节点位于 $x_i = i/N$（$i=0, \\dots, N$）。\n- **伽辽金近似**：$u_h \\in V_h$ 由 $a(u_h,w_h) = \\ell(w_h)$ 对所有 $w_h \\in V_h$ 定义。\n- **最佳逼近**：$p_h \\in V_h$ 由 $a(u - p_h, w_h) = 0$ 对所有 $w_h \\in V_h$ 定义。\n- **目标**：对 $N \\in \\{2, 4, 8, 16\\}$ 计算比率 $R_h := \\frac{\\|u - u_h\\|_a}{\\inf_{v_h \\in V_h} \\|u - v_h\\|_a} = \\frac{\\|u - u_h\\|_a}{\\|u - p_h\\|_a}$，从连续性和矫顽性常数中找到此比率的理想上界 $B$，并验证是否 $R_h \\le B$。\n- **输出格式**：$[\\;R_{2},\\;R_{4},\\;R_{8},\\;R_{16},\\;B,\\;T\\;]$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是有限元方法（FEM）在一维泊松方程上的标准应用。它涉及变分形式、伽辽金近似和通过 Céa 引理进行的先验误差估计等基本概念。所有方面都牢固地植根于偏微分方程数值分析的数学理论。\n- **适定性**：带狄利克雷边界条件的一维泊松问题是经典的适定问题。相关的双线性形式 $a(\\cdot,\\cdot)$ 在 $H_0^1(0,1)$ 上是对称正定的，通过 Lax-Milgram 定理及其离散模拟，保证了连续问题和离散问题都有唯一解。\n- **客观性**：问题使用精确、无歧义的数学语言陈述。\n- **完整性与一致性**：提供了所有必要的定义、方程和数据。精确解 $u(x)$ 满足边界条件，并唯一确定了右端项 $f(x)$。$u_h$ 和 $p_h$ 的定义是标准的且一致的。没有矛盾之处。\n- **与主题的关系**：该问题直接关系到对 Céa 引理中出现的常数的数值验证，这是有限元方法中先验误差分析的基石。\n\n### 步骤3：结论与行动\n该问题是有效的。它是一个定义明确、自成体系且理论上合理的数值分析练习。将提供完整的解决方案。\n\n### 解法\n任务是计算比率 $R_h = \\|u - u_h\\|_a / \\|u - p_h\\|_a$，并将其与从 Céa 引理导出的理论界限进行比较。\n\n**1. 理论上界的分析**\n\nCéa 引理为伽辽金近似提供了一个先验误差界。对于一个双线性形式 $a(\\cdot,\\cdot)$ 和一个有限元空间 $V_h \\subset V$，该引理指出能量范数下的误差有界：\n$$\n\\|u - u_h\\|_a \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_a\n$$\n其中 $M$ 是连续性常数，$\\alpha$ 是 $a(\\cdot,\\cdot)$ 相对于能量范数 $\\|\\cdot\\|_a$ 的矫顽性常数。问题将 $p_h$ 定义为最佳逼近，因此 $\\inf_{v_h \\in V_h} \\|u - v_h\\|_a = \\|u - p_h\\|_a$。于是，该比率有界为：\n$$\nR_h = \\frac{\\|u - u_h\\|_a}{\\|u - p_h\\|_a} \\le \\frac{M}{\\alpha} = B\n$$\n我们必须确定给定问题的常数 $M$ 和 $\\alpha$。\n\n- **连续性**：我们寻求最小的常数 $M$，使得对所有 $v, w \\in H_0^1(0,1)$ 都有 $|a(v,w)| \\le M \\|v\\|_a \\|w\\|_a$。\n双线性形式为 $a(v,w) = \\int_0^1 v'(x)w'(x)dx$。根据积分的柯西-施瓦茨不等式：\n$$\n|a(v,w)| = \\left| \\int_0^1 v'(x)w'(x)dx \\right| \\le \\left(\\int_0^1 |v'(x)|^2dx\\right)^{1/2} \\left(\\int_0^1 |w'(x)|^2dx\\right)^{1/2}\n$$\n根据能量范数的定义，$\\|v\\|_a = \\left(\\int_0^1 |v'(x)|^2dx\\right)^{1/2}$。因此：\n$$\n|a(v,w)| \\le \\|v\\|_a \\|w\\|_a\n$$\n这个不等式在常数为1时成立。这个界是锐的，所以连续性常数是 $M=1$。\n\n- **矫顽性**：我们寻求最大的常数 $\\alpha$，使得对所有 $v \\in H_0^1(0,1)$ 都有 $a(v,v) \\ge \\alpha \\|v\\|_a^2$。\n根据定义：\n$$\na(v,v) = \\int_0^1 |v'(x)|^2dx = \\|v\\|_a^2\n$$\n这意味着 $a(v,v) \\ge 1 \\cdot \\|v\\|_a^2$。这个界是锐的，所以矫顽性常数是 $\\alpha=1$。\n\n因此，比率 $R_h$ 的理想一致上界是 $B = M/\\alpha = 1/1 = 1$。\n\n**2. 伽辽金近似与最佳逼近的同一性**\n\n一个针对此问题的关键观察简化了分析。连续解 $u$ 满足 $a(u, w) = \\ell(w)$ 对所有 $w \\in H_0^1(0,1)$ 成立。这对于任何测试函数 $w_h \\in V_h$ 也特别成立，所以 $a(u, w_h) = \\ell(w_h)$ 对所有 $w_h \\in V_h$ 成立。\n\n伽辽金近似 $u_h$ 由 $a(u_h, w_h) = \\ell(w_h)$ 对所有 $w_h \\in V_h$ 定义。\n结合这两者，我们得到 $a(u, w_h) = a(u_h, w_h)$，这意味着：\n$$\na(u - u_h, w_h) = 0 \\quad \\text{for all } w_h \\in V_h.\n$$\n这是伽辽金正交性的性质。现在，将其与最佳逼近 $p_h$ 的定义进行比较：\n$$\na(u - p_h, w_h) = 0 \\quad \\text{for all } w_h \\in V_h.\n$$\n这两个定义是相同的。这意味着 $a(u_h, w_h) = a(p_h, w_h)$，或 $a(u_h - p_h, w_h) = 0$ 对所有 $w_h \\in V_h$ 成立。因为 $u_h - p_h \\in V_h$，我们可以选择 $w_h = u_h - p_h$，得到 $a(u_h - p_h, u_h - p_h) = \\|u_h - p_h\\|_a^2 = 0$。由于 $\\|\\cdot\\|_a$ 是 $V_h$ 上的一个范数，这意味着 $u_h - p_h = 0$，所以 $u_h = p_h$。\n\n理论上，伽辽金近似和最佳逼近是同一个函数。因此，误差范数必须相同，即 $\\|u-u_h\\|_a = \\|u-p_h\\|_a$，并且比率 $R_h$ 必须恰好为 1。数值计算中任何偏离 1 的情况都将归因于近似误差，主要是用于组装 $u_h$ 的载荷向量的数值积分所带来的误差。\n\n**3. 数值实现策略**\n\n我们将为给定的 $N$ 值实现有限元过程。\n- **精确解及其导数**：\n精确解为 $u(x) = e^x \\sin(\\pi x)$。其导数为 $u'(x) = e^x (\\sin(\\pi x) + \\pi \\cos(\\pi x))$。右端项为 $f(x) = -u''(x) = -e^x((1 - \\pi^2)\\sin(\\pi x) + 2\\pi \\cos(\\pi x))$。\n\n- **有限元离散化**：\n我们使用与内部节点 $x_i = i/h$（其中 $h=1/N$）相关的标准线性基“帽子”函数 $\\{\\phi_i(x)\\}_{i=1}^{N-1}$。有限元解的形式为 $v_h(x) = \\sum_{i=1}^{N-1} c_i \\phi_i(x)$。\n\n- **刚度矩阵**：刚度矩阵 $A$ 的元素为 $A_{ij} = a(\\phi_j, \\phi_i)$。对于步长为 $h$ 的均匀网格，这会得到一个 $(N-1) \\times (N-1)$ 的三对角矩阵：\n$$\nA = \\frac{1}{h} \\begin{pmatrix} 2 & -1 &  \\\\ -1 & 2 & -1 \\\\  & \\ddots & \\ddots & \\ddots \\\\  &  & -1 & 2 & -1 \\\\ & & & -1 & 2 \\end{pmatrix}\n$$\n\n- **$u_h$ 的载荷向量**：向量 $\\mathbf{b}$ 的元素为 $b_i = \\ell(\\phi_i) = \\int_0^1 f(x) \\phi_i(x) dx$。这个积分将在 $\\phi_i(x)$ 的支集 $(x_{i-1}, x_{i+1})$ 上使用高精度数值积分（`scipy.integrate.quad`）进行计算。\n\n- **$p_h$ 的载荷向量**：用于最佳逼近系统的向量 $\\mathbf{d}$ 的元素为 $d_i = a(u, \\phi_i) = \\int_0^1 u'(x)\\phi_i'(x) dx$。通过分部积分可以得到一个无需数值积分的精确公式：\n$$\nd_i = \\int_{x_{i-1}}^{x_i} u'(x)\\frac{1}{h}dx + \\int_{x_i}^{x_{i+1}} u'(x)\\frac{-1}{h}dx = \\frac{1}{h}\\left( [u(x)]_{x_{i-1}}^{x_i} - [u(x)]_{x_i}^{x_{i+1}} \\right) = \\frac{1}{h}(2u(x_i) - u(x_{i-1}) - u(x_{i+1}))\n$$\n计算出的解 $\\tilde{u}_h$ 和 $\\tilde{p}_h$ 之间的任何数值差异都将源于计算 $\\mathbf{b}$ 时的积分误差与 $\\mathbf{d}$ 的高精度计算之间的对比。\n\n- **求解与误差计算**：我们求解线性系统 $A\\mathbf{u}_h = \\mathbf{b}$ 和 $A\\mathbf{p}_h = \\mathbf{d}$ 以找到系数向量。得到的函数是 $u_h(x)$ 和 $p_h(x)$。它们的导数是分片常数，例如，在单元 $(x_k, x_{k+1})$ 上 $u_h'(x) = (u_{h,k+1} - u_{h,k})/h$。误差范数的平方，$\\|u-u_h\\|_a^2 = \\int_0^1 |u'(x)-u_h'(x)|^2 dx$ 和 $\\|u-p_h\\|_a^2 = \\int_0^1 |u'(x)-p_h'(x)|^2 dx$，通过将每个单元上的积分相加来计算，再次使用 `scipy.integrate.quad` 以确保精度。\n\n最后，为每个 $N$ 计算比率 $R_N$，并将结果列表与理论上界 $B=1.0$以及一个布尔校验 $T$ 一同编译，该校验用于检查所有比率是否在一个小的容差范围内满足 $R_N \\le B$。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the 1D Poisson problem using FEM, computes the ratio of Galerkin error\n    to best-approximation error, and verifies it against the theoretical bound.\n    \"\"\"\n    test_cases = [2, 4, 8, 16]\n    ratios = []\n    \n    # Exact solution and its derivatives\n    # u(x) = exp(x) * sin(pi*x)\n    u_func = lambda x: np.exp(x) * np.sin(np.pi * x)\n    # u'(x) = exp(x) * (sin(pi*x) + pi*cos(pi*x))\n    u_prime_func = lambda x: np.exp(x) * (np.sin(np.pi * x) + np.pi * np.cos(np.pi * x))\n    # f(x) = -u''(x) = -exp(x) * ((1-pi^2)*sin(pi*x) + 2*pi*cos(pi*x))\n    f_func = lambda x: -np.exp(x) * ((1.0 - np.pi**2) * np.sin(np.pi * x) + 2.0 * np.pi * np.cos(np.pi * x))\n    \n    # Derivation in solution text shows M=1, alpha=1.\n    bound_B = 1.0\n    \n    for N in test_cases:\n        h = 1.0 / N\n        dim = N - 1\n        x_nodes = np.linspace(0.0, 1.0, N + 1)\n        \n        # Assemble stiffness matrix A\n        if dim > 0:\n            main_diag = np.full(dim, 2.0)\n            off_diag = np.full(dim - 1, -1.0)\n            A = (np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)) / h\n        elif dim == 0: # Should not happen with N>=2\n            A = np.array([])\n        \n        # Assemble load vector b for u_h using numerical quadrature for \\int f*phi_i dx\n        b = np.zeros(dim)\n        for i in range(dim):\n            node_idx = i + 1\n            x_im1, x_i, x_ip1 = x_nodes[node_idx-1], x_nodes[node_idx], x_nodes[node_idx+1]\n            \n            # Integrand over [x_{i-1}, x_i]\n            integrand1 = lambda x: f_func(x) * (x - x_im1) / h\n            # Integrand over [x_i, x_{i+1}]\n            integrand2 = lambda x: f_func(x) * (x_ip1 - x) / h\n            \n            val1, _ = quad(integrand1, x_im1, x_i, epsabs=1e-14, epsrel=1e-14)\n            val2, _ = quad(integrand2, x_i, x_ip1, epsabs=1e-14, epsrel=1e-14)\n            b[i] = val1 + val2\n\n        # Assemble load vector d for p_h using the exact formula for a(u, phi_i)\n        d = np.zeros(dim)\n        for i in range(dim):\n            node_idx = i + 1\n            x_im1, x_i, x_ip1 = x_nodes[node_idx-1], x_nodes[node_idx], x_nodes[node_idx+1]\n            d[i] = (2.0 * u_func(x_i) - u_func(x_im1) - u_func(x_ip1)) / h\n\n        # Solve for coefficients\n        if dim > 0:\n            coeffs_uh = np.linalg.solve(A, b)\n            coeffs_ph = np.linalg.solve(A, d)\n        else: # N=1 case, not in test suite\n            coeffs_uh = np.array([])\n            coeffs_ph = np.array([])\n            \n        # Add boundary values (0)\n        c_full = np.concatenate(([0.0], coeffs_uh, [0.0]))\n        p_full = np.concatenate(([0.0], coeffs_ph, [0.0]))\n\n        # Numerically compute the energy norm errors ||u - u_h||_a^2 and ||u - p_h||_a^2\n        err_uh_sq = 0.0\n        err_ph_sq = 0.0\n        \n        for k in range(N):\n            xk, xkp1 = x_nodes[k], x_nodes[k+1]\n            \n            # u_h'(x) is constant on (xk, xkp1)\n            uh_prime_val = (c_full[k+1] - c_full[k]) / h\n            # p_h'(x) is constant on (xk, xkp1)\n            ph_prime_val = (p_full[k+1] - p_full[k]) / h\n            \n            # Integrand for ||u - u_h||_a^2\n            integrand_uh = lambda x: (u_prime_func(x) - uh_prime_val)**2\n            # Integrand for ||u - p_h||_a^2\n            integrand_ph = lambda x: (u_prime_func(x) - ph_prime_val)**2\n            \n            # Accumulate integral over each element\n            err_uh_sq += quad(integrand_uh, xk, xkp1, epsabs=1e-14, epsrel=1e-14)[0]\n            err_ph_sq += quad(integrand_ph, xk, xkp1, epsabs=1e-14, epsrel=1e-14)[0]\n\n        # Compute the ratio R_h\n        if err_ph_sq < 1e-15: # Avoid division by zero if p_h is extremely accurate\n             ratio = 1.0 if err_uh_sq < 1e-15 else np.inf\n        else:\n            ratio = np.sqrt(err_uh_sq) / np.sqrt(err_ph_sq)\n        \n        ratios.append(ratio)\n    \n    # Verify if all ratios satisfy the bound R_h = B + tolerance\n    tolerance = 1e-8\n    test_passed = all(r = bound_B + tolerance for r in ratios)\n    \n    final_output = ratios + [bound_B, test_passed]\n\n    # Format the output as a string\n    output_str = f\"[{','.join(map(str, final_output))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2539864"}, {"introduction": "Céa引理保证了准最优性，但这一保证的质量取决于稳定性常数 $M/\\alpha$。这最后一个练习探讨了一个反应扩散问题，其中该常数并不理想，并且关键地依赖于一个物理参数 $\\epsilon$。您将分析当问题变为奇异扰动时（$\\epsilon \\to 0$），比值 $M/\\alpha$ 的行为，从而揭示为何一个形式上正确的先验界在实际的、前渐近（pre-asymptotic）的情况下有时可能在数量上产生误导。[@problem_id:2539773]", "problem": "考虑开区间 $(0,1)$ 上的齐次 Dirichlet 边界条件下的一维反应扩散模型，其中 $0\\epsilon \\ll 1$：\n$$\n\\epsilon\\,u''-u=f \\quad \\text{in }(0,1), \\qquad u(0)=u(1)=0.\n$$\n采用通过将方程乘以 $-1$ 并进行分部积分得到的强制变分形式，使得双线性形式和线性泛函为\n$$\na(u,v)=\\epsilon\\int_{0}^{1}u'(x)\\,v'(x)\\,dx+\\int_{0}^{1}u(x)\\,v(x)\\,dx, \\qquad \\ell(v)=-\\int_{0}^{1}f(x)\\,v(x)\\,dx,\n$$\n对所有 $u,v\\in H_{0}^{1}(0,1)$ 成立。使用范数 $\\|v\\|_{H_{0}^{1}(0,1)}:=\\|v'\\|_{L^{2}(0,1)}$。仅使用核心定义（双线性形式的连续性和强制性）和熟知的事实（$(0,1)$ 上的尖锐 Poincaré 不等式），完成以下任务：\n\n1. 确定最小强制常数 $\\alpha0$ 和一个有效的连续常数 $M0$，使得\n$$\na(v,v)\\ge \\alpha\\,\\|v\\|_{H_{0}^{1}(0,1)}^{2}\\quad \\text{for all } v\\in H_{0}^{1}(0,1), \n$$\n和\n$$\n|a(w,v)|\\le M\\,\\|w\\|_{H_{0}^{1}(0,1)}\\,\\|v\\|_{H_{0}^{1}(0,1)}\\quad \\text{for all } w,v\\in H_{0}^{1}(0,1).\n$$\n\n2. 然后，使用 $(0,1)$ 上 Poincaré 不等式中的最优常数，将比率 $M/\\alpha$ 表示为仅含 $\\epsilon$ 的闭合形式。\n\n最后，简要说明当 $\\epsilon\\to 0$ 时，$M/\\alpha$ 的标度变化如何影响有限元方法（FEM）中由 Céa 引理提供的先验误差估计的预渐近可靠性。\n\n重要提示：将您关于 $M/\\alpha$ 的最终答案表示为仅含 $\\epsilon$ 的单个闭合形式解析表达式，不进行任何数值近似或四舍五入。", "solution": "所述问题在数学和科学上是合理的、自洽的且适定的。这是针对奇异摄动问题的有限元方法先验分析中的一个标准练习。我们着手求解。\n\n任务是为双线性形式\n$$ a(u,v)=\\epsilon\\int_{0}^{1}u'(x)\\,v'(x)\\,dx+\\int_{0}^{1}u(x)\\,v(x)\\,dx $$\n找到关于范数 $\\|v\\|_{H_{0}^{1}(0,1)}:=\\|v'\\|_{L^{2}(0,1)}$ 的强制常数 $\\alpha$ 和连续常数 $M$。\n\n首先，我们确定最小强制常数 $\\alpha$。强制性条件为 $a(v,v) \\ge \\alpha \\|v\\|_{H_{0}^{1}(0,1)}^{2}$ 对所有 $v \\in H_0^1(0,1)$ 成立。代入双线性形式和范数的定义，我们有：\n$$ \\epsilon\\int_{0}^{1}(v'(x))^{2}\\,dx+\\int_{0}^{1}(v(x))^{2}\\,dx \\ge \\alpha \\int_{0}^{1}(v'(x))^{2}\\,dx. $$\n使用 $L^2$-范数的记号，$\\|v'\\|_{L^2(0,1)}^2 = \\int_0^1 (v'(x))^2 dx$ 和 $\\|v\\|_{L^2(0,1)}^2 = \\int_0^1 (v(x))^2 dx$，不等式变为：\n$$ \\epsilon \\|v'\\|_{L^2(0,1)}^{2} + \\|v\\|_{L^2(0,1)}^{2} \\ge \\alpha \\|v'\\|_{L^2(0,1)}^{2}. $$\n为了找到 $\\alpha$ 的最小可能值，我们计算瑞利商的下确界：\n$$ \\alpha = \\inf_{v \\in H_0^1(0,1), v \\neq 0} \\frac{a(v,v)}{\\|v'\\|_{L^2(0,1)}^2} = \\inf_{v \\neq 0} \\frac{\\epsilon \\|v'\\|_{L^2(0,1)}^{2} + \\|v\\|_{L^2(0,1)}^{2}}{\\|v'\\|_{L^2(0,1)}^2} = \\epsilon + \\inf_{v \\neq 0} \\frac{\\|v\\|_{L^2(0,1)}^2}{\\|v'\\|_{L^2(0,1)}^2}. $$\n项 $\\inf_{v \\neq 0} \\frac{\\|v\\|_{L^2(0,1)}^2}{\\|v'\\|_{L^2(0,1)}^2}$ 可以任意地接近于零。为了证明这一点，考虑函数序列 $v_n(x) = \\sin(n\\pi x)$，其中 $n \\in \\{1, 2, 3, \\dots\\}$，这些函数属于 $H_0^1(0,1)$。$v_n$ 的 $L^2$-范数的平方是 $\\|v_n\\|_{L^2(0,1)}^2 = \\int_0^1 \\sin^2(n\\pi x)dx = \\frac{1}{2}$，其导数的 $L^2$-范数的平方是 $\\|v_n'\\|_{L^2(0,1)}^2 = \\int_0^1 (n\\pi)^2 \\cos^2(n\\pi x)dx = \\frac{(n\\pi)^2}{2}$。该比值为 $\\frac{\\|v_n\\|_{L^2(0,1)}^2}{\\|v_n'\\|_{L^2(0,1)}^2} = \\frac{1}{(n\\pi)^2}$，当 $n \\to \\infty$ 时趋于 $0$。因此，下确界为 $0$。\n因此，最小（最优）强制常数为 $\\alpha = \\epsilon$。\n\n接下来，我们确定一个有效的连续常数 $M$。连续性条件为 $|a(w,v)| \\le M \\|w\\|_{H_{0}^{1}(0,1)} \\|v\\|_{H_{0}^{1}(0,1)}$ 对所有 $w, v \\in H_0^1(0,1)$ 成立。使用指定的范数，该条件为：\n$$ |a(w,v)| \\le M \\|w'\\|_{L^2(0,1)} \\|v'\\|_{L^2(0,1)}. $$\n对双线性形式应用三角不等式和 Cauchy-Schwarz 不等式：\n$$ |a(w,v)| = \\left|\\epsilon\\int_{0}^{1}w'v'\\,dx+\\int_{0}^{1}wv\\,dx\\right| \\le \\epsilon \\left|\\int_{0}^{1}w'v'\\,dx\\right| + \\left|\\int_{0}^{1}wv\\,dx\\right| \\le \\epsilon \\|w'\\|_{L^2} \\|v'\\|_{L^2} + \\|w\\|_{L^2} \\|v\\|_{L^2}. $$\n为了只用 $\\|w'\\|_{L^2}$ 和 $\\|v'\\|_{L^2}$ 来获得一个界，我们使用 $(0,1)$ 上的尖锐 Poincaré 不等式，该不等式表明对于任何 $v \\in H_0^1(0,1)$，有 $\\|v\\|_{L^2} \\le C_P \\|v'\\|_{L^2}$。尖锐常数 $C_P$ 由 $1/\\sqrt{\\lambda_1}$ 给出，其中 $\\lambda_1$ 是带有齐次 Dirichlet 边界条件的算子 $-d^2/dx^2$ 的最小特征值。特征值为 $\\lambda_n = (n\\pi)^2$（$n=1,2,\\dots$），所以 $\\lambda_1 = \\pi^2$。因此，尖锐不等式为 $\\|v\\|_{L^2} \\le \\frac{1}{\\pi}\\|v'\\|_{L^2}$。\n将此代入我们对 $|a(w,v)|$ 的界中：\n$$ |a(w,v)| \\le \\epsilon \\|w'\\|_{L^2} \\|v'\\|_{L^2} + \\left(\\frac{1}{\\pi}\\|w'\\|_{L^2}\\right) \\left(\\frac{1}{\\pi}\\|v'\\|_{L^2}\\right) = \\left(\\epsilon + \\frac{1}{\\pi^2}\\right) \\|w'\\|_{L^2} \\|v'\\|_{L^2}. $$\n这表明 $M = \\epsilon + \\frac{1}{\\pi^2}$ 是一个有效的连续常数。为了验证它是最小可能值，我们必须检查上确界是否可以达到。上确界是\n$$ M = \\sup_{w,v \\neq 0} \\frac{|a(w,v)|}{\\|w'\\|_{L^2}\\|v'\\|_{L^2}} \\ge \\sup_{v \\neq 0} \\frac{a(v,v)}{\\|v'\\|_{L^2}^2} = \\sup_{v \\neq 0} \\left(\\epsilon + \\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}\\right) = \\epsilon + \\sup_{v \\neq 0} \\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}. $$\n比率 $\\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}$ 的上确界是最小特征值 $\\lambda_1=\\pi^2$ 的倒数，即 $1/\\pi^2$。这个上确界由第一特征函数 $v_1(x) = \\sin(\\pi x)$ 达到。因此，最优连续常数为 $M = \\epsilon + \\frac{1}{\\pi^2}$。\n\n于是，比率 $M/\\alpha$ 为：\n$$ \\frac{M}{\\alpha} = \\frac{\\epsilon + \\frac{1}{\\pi^2}}{\\epsilon} = 1 + \\frac{1}{\\epsilon \\pi^2}. $$\n\n最后，我们分析这个比率对 Céa 引理的影响。该引理为有限元解 $u_h$ 相对于精确解 $u$ 提供了先验误差估计：\n$$ \\|u - u_h\\|_{H_0^1(0,1)} \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_{H_0^1(0,1)}. $$\n此处，$V_h$ 是 $H_0^1(0,1)$ 的有限维子空间，范数如前所定，$\\|v\\|_{H_0^1(0,1)} = \\|v'\\|_{L^2(0,1)}$。稳定常数为 $\\frac{M}{\\alpha} = 1 + \\frac{1}{\\epsilon \\pi^2}$。在 $\\epsilon \\to 0$ 的奇异摄动情况下，该常数以 $O(\\epsilon^{-1})$ 的标度变化且无界增长。一个非常大的稳定常数使得该估计在预渐近区域（即，对于实际的网格尺寸 $h$）的量化效果很差。尽管该估计在形式上仍然有效，但它变成了对真实误差的极端高估，使其成为一个在 $\\epsilon$ 很小时预测数值解准确性的不可靠工具。这种由于问题参数导致的先验误差界的退化是数值分析中一个众所周知的问题。", "answer": "$$\n\\boxed{1 + \\frac{1}{\\epsilon \\pi^{2}}}\n$$", "id": "2539773"}]}