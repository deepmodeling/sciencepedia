{"hands_on_practices": [{"introduction": "任何动力学有限元分析的第一步都是从连续系统的控制偏微分方程出发，推导出离散的运动方程。本练习将通过一个基础性示例，引导您完整地实践这一过程。您将学习如何对一维弹性动力学方程应用伽辽金法，从而推导出一致质量矩阵，该矩阵正确地描述了单元内节点之间的惯性耦合效应 [@problem_id:2594295]。", "problem": "考虑一根均匀、等截面的一维轴向杆，占据区间 $x \\in [0,L]$，其横截面积 $A$ 和材料密度 $\\rho$ 均为常数。设 $u(x,t)$ 表示轴向位移。轴向运动的控制方程源于施加于杆的微分段上的线性动量守恒（牛顿第二定律），得到一维弹性动力学的强形式：\n$$\\rho A \\,\\ddot{u}(x,t) - \\frac{\\partial}{\\partial x}\\!\\big(EA\\,\\frac{\\partial u}{\\partial x}(x,t)\\big) = A\\,b(x,t),$$\n其中 $E$ 是杨氏模量，$b(x,t)$ 是单位体积的轴向体力。使用有限元法（FEM）中的标准伽辽金法，求解在 $x=0$ 和 $x=L$ 处具有节点的单个2节点线性杆单元的半离散运动方程。假设位移场近似为\n$$u(x,t) \\approx N_1(x)\\,d_1(t) + N_2(x)\\,d_2(t),$$\n其线性形函数为\n$$N_1(x) = 1 - \\frac{x}{L},\\qquad N_2(x) = \\frac{x}{L},$$\n并取权函数等于形函数（伽辽金选择）。从弱形式出发，根据第一性原理推导单元级半离散方程，并将一致单元质量矩阵 $\\mathbf{M}^{e}$ 确定为乘以节点加速度的系数矩阵。然后在 $x \\in [0,L]$ 上显式计算必要的积分，以获得用 $\\rho$、$A$ 和 $L$ 表示的 $\\mathbf{M}^{e}$ 的闭合形式表达式。\n\n以单个解析表达式的形式提供最终的单元质量矩阵。不要代入数值，不要包含单位，也不要四舍五入。", "solution": "问题陈述已经过审查，并被认为是有效的。它具有科学依据，是适定的、客观的，并包含了使用伽辽金法推导一维线性杆单元的一致质量矩阵所需的所有信息。这是有限元法研究中的一个标准问题。我们将开始推导。\n\n起点是一维弹性动力学控制方程的强形式，如下所示：\n$$ \\rho A \\,\\ddot{u}(x,t) - \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}(x,t)\\right) = A\\,b(x,t) $$\n其中 $\\rho$ 是材料密度，$A$ 是横截面积，$u(x,t)$ 是轴向位移，$E$ 是杨氏模量，$b(x,t)$ 是单位体积的体力。双点 $\\ddot{u}$ 表示对时间 $t$ 的二阶偏导数。\n\n为了推导弱形式，我们将方程乘以一个任意的权函数 $w(x)$，并在单个有限元的域（即从 $x=0$ 到 $x=L$）上积分。\n$$ \\int_{0}^{L} w(x) \\left[ \\rho A \\,\\ddot{u}(x,t) - \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right) \\right] dx = \\int_{0}^{L} w(x) A\\,b(x,t) dx $$\n我们重新排列各项，并对包含 $u$ 的二阶空间导数的项应用分部积分法。这个过程降低了对位移场 $u(x,t)$ 的连续性要求。\n$$ \\int_{0}^{L} w(x) \\rho A \\ddot{u} \\,dx - \\int_{0}^{L} w(x) \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right) dx = \\int_{0}^{L} w(x) A\\,b(x,t) dx $$\n左侧第二项进行分部积分：\n$$ \\int_{0}^{L} w(x) \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right) dx = \\left[ w(x) EA \\frac{\\partial u}{\\partial x} \\right]_{0}^{L} - \\int_{0}^{L} \\frac{\\partial w}{\\partial x} EA \\frac{\\partial u}{\\partial x} dx $$\n将其代回积分方程，得到单元的弱形式：\n$$ \\int_{0}^{L} w(x) \\rho A \\ddot{u} \\,dx + \\int_{0}^{L} \\frac{\\partial w}{\\partial x} EA \\frac{\\partial u}{\\partial x} dx = \\int_{0}^{L} w(x) A\\,b(x,t) dx + \\left[ w(x) EA \\frac{\\partial u}{\\partial x} \\right]_{0}^{L} $$\n对于任何容许的权函数 $w(x)$，该方程都必须成立。右侧的项代表外力所做的功，包括体力和节点力（边界牵引力）。\n\n接下来，我们引入单元上位移场 $u(x,t)$ 的有限元近似。对于一个2节点线性单元，位移由节点位移 $d_1(t)$ 和 $d_2(t)$ 使用线性形函数 $N_1(x)$ 和 $N_2(x)$ 进行插值得到：\n$$ u(x,t) \\approx u^h(x,t) = N_1(x)d_1(t) + N_2(x)d_2(t) = \\mathbf{N}(x)\\mathbf{d}(t) $$\n其中 $\\mathbf{N}(x) = \\begin{pmatrix} N_1(x)  N_2(x) \\end{pmatrix}$ 是形函数矩阵，$\\mathbf{d}(t) = \\begin{pmatrix} d_1(t) \\\\ d_2(t) \\end{pmatrix}$ 是节点位移向量。形函数由 $N_1(x) = 1 - \\frac{x}{L}$ 和 $N_2(x) = \\frac{x}{L}$ 给出。\n\n所需的导数为：\n$$ \\ddot{u}(x,t) \\approx \\mathbf{N}(x)\\ddot{\\mathbf{d}}(t) $$\n$$ \\frac{\\partial u}{\\partial x}(x,t) \\approx \\frac{d\\mathbf{N}}{dx}\\mathbf{d}(t) = \\mathbf{B}(x)\\mathbf{d}(t) $$\n其中 $\\mathbf{B}(x) = \\begin{pmatrix} \\frac{dN_1}{dx}  \\frac{dN_2}{dx} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix}$。\n\n在伽辽金法中，权函数选择为形函数本身，即对于 $i=1, 2$，$w(x)$ 被设为 $N_i(x)$。这可以写成矩阵形式，即设权函数向量为 $\\mathbf{w}(x) = \\mathbf{N}^T(x)$。将这些近似代入弱形式，得到一个常微分方程组：\n$$ \\left( \\int_{0}^{L} \\mathbf{N}^T(x) \\rho A \\mathbf{N}(x) dx \\right) \\ddot{\\mathbf{d}}(t) + \\left( \\int_{0}^{L} \\mathbf{B}^T(x) EA \\mathbf{B}(x) dx \\right) \\mathbf{d}(t) = \\mathbf{F}^e(t) $$\n其中 $\\mathbf{F}^e(t)$ 是单元力向量。这就是半离散运动方程，$\\mathbf{M}^e \\ddot{\\mathbf{d}}(t) + \\mathbf{K}^e \\mathbf{d}(t) = \\mathbf{F}^e(t)$。\n\n问题要求推导一致单元质量矩阵 $\\mathbf{M}^e$，它是节点加速度 $\\ddot{\\mathbf{d}}(t)$ 的系数矩阵。\n$$ \\mathbf{M}^e = \\int_{0}^{L} \\mathbf{N}^T(x) \\rho A \\mathbf{N}(x) dx = \\rho A \\int_{0}^{L} \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} \\begin{pmatrix} N_1(x)  N_2(x) \\end{pmatrix} dx $$\n$$ \\mathbf{M}^e = \\rho A \\int_{0}^{L} \\begin{pmatrix} N_1^2(x)  N_1(x)N_2(x) \\\\ N_2(x)N_1(x)  N_2^2(x) \\end{pmatrix} dx $$\n我们计算矩阵每个分量 $M^e_{ij} = \\rho A \\int_0^L N_i(x)N_j(x) dx$ 的积分。\n\n分量 $M^e_{11}$：\n$$ M^e_{11} = \\rho A \\int_{0}^{L} (1 - \\frac{x}{L})^2 dx = \\rho A \\left[ -L\\frac{(1 - \\frac{x}{L})^3}{3} \\right]_{0}^{L} = \\rho A \\left( 0 - (-L\\frac{1}{3}) \\right) = \\frac{\\rho A L}{3} $$\n\n分量 $M^e_{22}$：\n$$ M^e_{22} = \\rho A \\int_{0}^{L} (\\frac{x}{L})^2 dx = \\frac{\\rho A}{L^2} \\int_{0}^{L} x^2 dx = \\frac{\\rho A}{L^2} \\left[ \\frac{x^3}{3} \\right]_{0}^{L} = \\frac{\\rho A}{L^2} \\frac{L^3}{3} = \\frac{\\rho A L}{3} $$\n\n分量 $M^e_{12} = M^e_{21}$（由对称性可知）：\n$$ M^e_{12} = \\rho A \\int_{0}^{L} (1 - \\frac{x}{L})(\\frac{x}{L}) dx = \\rho A \\int_{0}^{L} (\\frac{x}{L} - \\frac{x^2}{L^2}) dx = \\rho A \\left[ \\frac{x^2}{2L} - \\frac{x^3}{3L^2} \\right]_{0}^{L} $$\n$$ M^e_{12} = \\rho A \\left( (\\frac{L^2}{2L} - \\frac{L^3}{3L^2}) - 0 \\right) = \\rho A \\left( \\frac{L}{2} - \\frac{L}{3} \\right) = \\rho A \\left( \\frac{3L - 2L}{6} \\right) = \\frac{\\rho A L}{6} $$\n\n将各分量组装成矩阵 $\\mathbf{M}^e$：\n$$ \\mathbf{M}^e = \\begin{pmatrix} \\frac{\\rho A L}{3}  \\frac{\\rho A L}{6} \\\\ \\frac{\\rho A L}{6}  \\frac{\\rho A L}{3} \\end{pmatrix} $$\n这可以写成因子分解的形式，即为最终答案。\n$$ \\mathbf{M}^e = \\frac{\\rho A L}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$", "answer": "$$\n\\boxed{\\frac{\\rho A L}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}}\n$$", "id": "2594295"}, {"introduction": "在掌握了矩阵推导的基础之上，本练习将深入探讨半离散系统的物理意义。我们将研究无约束结构中的刚体模态，即那些不产生任何弹性应变的运动形式。通过分析梁单元，本练习将验证一个关键特性：刚度矩阵对于刚体模态产生的恢复力为零，而质量矩阵则正确地捕捉了这些运动的惯性属性 [@problem_id:2594259]。", "problem": "考虑一个长度为 $L$、横截面积为 $A$、质量密度为 $\\rho$、抗弯刚度为 $E I$ 的均匀、等截面、平面的欧拉-伯努利梁单元（双节点，三次 Hermite 插值）。设单元节点自由度按顺序表示为 $q = [v_1,\\ \\varphi_1,\\ v_2,\\ \\varphi_2]^{\\mathsf{T}}$，其中 $v_i$ 是节点 $i$ 处的横向位移，$\\varphi_i$ 是节点 $i$ 处的转角（斜率）。从基本能量定义出发，使用标准伽辽金半离散化方法：协调单元质量矩阵满足 $M_{ij} = \\int_{0}^{L} \\rho A\\, N_i(x)\\, N_j(x)\\, \\mathrm{d}x$，单元刚度矩阵满足 $K_{ij} = \\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, \\mathrm{d}x$，其中 $N_i(x)$ 是与 $q$ 的分量相关联的欧拉-伯努利 Hermite 形函数，$N_i''(x)$ 表示关于 $x$ 的二阶导数。\n\na) 在节点基 $q$ 中，确定该自由-自由单元的两个线性无关的刚体模态，一个对应于纯刚性平移，另一个对应于纯刚性转动。施加归一化约束，使得平移模态具有 $v_1=1$ 和 $\\varphi_1=0$，转动模态具有 $\\varphi_1=\\varphi_2=1$ 和 $v_1=0$。将这些列向量分别记为 $\\boldsymbol{\\phi}_t$ 和 $\\boldsymbol{\\phi}_r$，并令 $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_t\\ \\ \\boldsymbol{\\phi}_r]$。\n\nb) 仅使用欧拉-伯努利梁理论的基本定义，验证单元刚度矩阵能够零化两个刚体模态，即 $\\mathbf{K} \\boldsymbol{\\phi}_t = \\mathbf{0}$ 和 $\\mathbf{K} \\boldsymbol{\\phi}_r = \\mathbf{0}$。\n\nc) 构建在刚体子空间上诱导的 $2 \\times 2$ 广义质量矩阵 $\\mathbf{G} = \\boldsymbol{\\Phi}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\Phi}$，并以 $\\rho$、$A$ 和 $L$ 的函数形式计算其行列式的闭合形式解。将最终答案表示为仅包含 $\\rho$、$A$ 和 $L$ 的符号表达式；不要附加单位。", "solution": "在尝试任何解答之前，应对问题进行验证。\n\n已知条件如下：\n- 一个均匀、等截面、平面的欧拉-伯努利梁单元。\n- 长度：$L$。\n- 横截面积：$A$。\n- 质量密度：$\\rho$。\n- 抗弯刚度：$E I$。\n- 节点自由度 (DOF) 向量：$q = [v_1,\\ \\varphi_1,\\ v_2,\\ \\varphi_2]^{\\mathsf{T}}$。\n- $v_i$：节点 $i$ 处的横向位移。\n- $\\varphi_i$：节点 $i$ 处的转角。\n- 协调质量矩阵定义：$M_{ij} = \\int_{0}^{L} \\rho A\\, N_i(x)\\, N_j(x)\\, \\mathrm{d}x$。\n- 刚度矩阵定义：$K_{ij} = \\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, \\mathrm{d}x$。\n- $N_i(x)$：Hermite 形函数。\n- 刚性平移模态 $\\boldsymbol{\\phi}_t$ 的约束条件：$v_1=1$，$\\varphi_1=0$。\n- 刚性转动模态 $\\boldsymbol{\\phi}_r$ 的约束条件：$\\varphi_1=\\varphi_2=1$，$v_1=0$。\n- 刚体模态矩阵：$\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_t\\ \\ \\boldsymbol{\\phi}_r]$。\n\n该问题具有科学依据，是在标准结构分析和有限元理论中构建的。该问题是适定的，因为所提供的约束足以唯一确定所需的量。语言客观而精确。所有必要信息都已提供。该问题被认为是有效的。\n\n解答按要求分为三个部分进行。\n\na) 刚体模态的确定\n\n平面梁的刚体运动由一个位移场 $v(x)$ 描述，该位移场最多是空间坐标 $x$ 的线性函数。这是因为这种运动不产生曲率，$v''(x) = 0$，因此也不产生应变。一般形式为 $v(x) = c_0 + c_1 x$，其中 $c_0$ 和 $c_1$ 是常数。转角即为斜率，$\\varphi(x) = v'(x) = c_1$。\n\n对于刚性平移模态 $\\boldsymbol{\\phi}_t$：\n运动是纯平移，所以 $v(x) = c_0$ 且 $\\varphi(x) = 0$。\n问题施加了约束条件 $v_1 = v(0) = 1$ 和 $\\varphi_1 = \\varphi(0) = 0$。\n由 $v(0)=1$ 可得 $c_0=1$。位移场必须是 $v(x) = 1$。\n与该场对应的节点自由度为：\n$v_1 = v(0) = 1$\n$\\varphi_1 = v'(0) = 0$\n$v_2 = v(L) = 1$\n$\\varphi_2 = v'(L) = 0$\n作为列向量，平移模态为 $\\boldsymbol{\\phi}_t = [1,\\ 0,\\ 1,\\ 0]^{\\mathsf{T}}$。\n\n对于刚性转动模态 $\\boldsymbol{\\phi}_r$：\n运动是绕某个中心的纯转动，由 $v(x) = c_0 + c_1 x$ 描述。\n问题施加了约束条件 $\\varphi_1 = \\varphi(0) = 1$，$\\varphi_2 = \\varphi(L) = 1$ 和 $v_1 = v(0) = 0$。\n从 $\\varphi(x) = c_1$ 可知，约束条件 $\\varphi(0)=1$ 和 $\\varphi(L)=1$ 均得出 $c_1=1$。\n由 $v(0)=0$ 可得 $c_0 + c_1(0) = 0$，所以 $c_0=0$。\n位移场必须是 $v(x) = x$。这表示绕原点 $x=0$ 的刚性转动。\n与该场对应的节点自由度为：\n$v_1 = v(0) = 0$\n$\\varphi_1 = v'(0) = 1$\n$v_2 = v(L) = L$\n$\\varphi_2 = v'(L) = 1$\n作为列向量，转动模态为 $\\boldsymbol{\\phi}_r = [0,\\ 1,\\ L,\\ 1]^{\\mathsf{T}}$。\n\n刚体模态矩阵为 $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_t\\ \\ \\boldsymbol{\\phi}_r] = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  L \\\\ 0  1 \\end{pmatrix}$。\n\nb) 刚度矩阵零化作用的验证\n\n单元刚度矩阵 $\\mathbf{K}$ 必须能够零化任何刚体模态向量 $\\boldsymbol{\\phi}$。这是一个基本性质，反映了刚体运动不引起应变，因此不产生弹性恢复力。我们必须证明 $\\mathbf{K} \\boldsymbol{\\phi} = \\mathbf{0}$。\n向量 $\\mathbf{K} \\boldsymbol{\\phi}$ 的第 $i$ 个分量由 $(\\mathbf{K}\\boldsymbol{\\phi})_i = \\sum_{j=1}^{4} K_{ij} \\phi_j$ 给出。\n代入 $K_{ij}$ 的定义：\n$$ (\\mathbf{K}\\boldsymbol{\\phi})_i = \\sum_{j=1}^{4} \\left( \\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, \\mathrm{d}x \\right) \\phi_j $$\n根据积分的线性性质，我们可以写出：\n$$ (\\mathbf{K}\\boldsymbol{\\phi})_i = \\int_{0}^{L} E I\\, N_i''(x) \\left( \\sum_{j=1}^{4} N_j''(x) \\phi_j \\right) \\mathrm{d}x $$\n表达式 $\\sum_{j=1}^{4} N_j(x) \\phi_j$ 表示与 $\\boldsymbol{\\phi}$ 中的节点位移相对应的位移场 $v_\\phi(x)$。因此，括号中的项是该场的二阶导数：\n$$ v_\\phi''(x) = \\left( \\sum_{j=1}^{4} N_j(x) \\phi_j \\right)'' = \\sum_{j=1}^{4} N_j''(x) \\phi_j $$\n对于任何刚体模态，其对应的位移场 $v_\\phi(x)$ 最多是线性的，因此其二阶导数 $v_\\phi''(x)$ 对于所有 $x \\in [0, L]$ 必须恒为零。\n我们已经确定了位移场：对于 $\\boldsymbol{\\phi}_t$ 是 $v_t(x) = 1$，对于 $\\boldsymbol{\\phi}_r$ 是 $v_r(x) = x$。\n对于平移模态 $\\boldsymbol{\\phi}_t$，我们有 $v_t''(x) = (1)'' = 0$。\n对于转动模态 $\\boldsymbol{\\phi}_r$，我们有 $v_r''(x) = (x)'' = 0$。\n因此，对于这两种模态，被积函数都为零：\n$$ (\\mathbf{K}\\boldsymbol{\\phi}_t)_i = \\int_{0}^{L} E I\\, N_i''(x) \\cdot (0) \\, \\mathrm{d}x = 0 $$\n$$ (\\mathbf{K}\\boldsymbol{\\phi}_r)_i = \\int_{0}^{L} E I\\, N_i''(x) \\cdot (0) \\, \\mathrm{d}x = 0 $$\n由于这对每个分量 $i=1, 2, 3, 4$ 都成立，我们严格地验证了 $\\mathbf{K} \\boldsymbol{\\phi}_t = \\mathbf{0}$ 和 $\\mathbf{K} \\boldsymbol{\\phi}_r = \\mathbf{0}$。\n\nc) 广义质量矩阵行列式的计算\n\n刚体子空间上的广义质量矩阵为 $\\mathbf{G} = \\boldsymbol{\\Phi}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\Phi}$。其分量为 $G_{ab} = \\boldsymbol{\\phi}_a^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_b$，其中 $a, b \\in \\{t, r\\}$。\n我们可以不显式构造完整的质量矩阵 $\\mathbf{M}$ 就计算出这些分量。分量 $\\boldsymbol{\\phi}_a^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_b$ 可以表示为：\n$$ \\boldsymbol{\\phi}_a^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_b = \\sum_{i=1}^{4} \\sum_{j=1}^{4} (\\phi_a)_i M_{ij} (\\phi_b)_j = \\sum_{i,j} (\\phi_a)_i \\left(\\int_{0}^{L} \\rho A\\, N_i(x)\\, N_j(x)\\, \\mathrm{d}x \\right) (\\phi_b)_j $$\n$$ = \\int_{0}^{L} \\rho A \\left(\\sum_{i=1}^{4} N_i(x) (\\phi_a)_i\\right) \\left(\\sum_{j=1}^{4} N_j(x) (\\phi_b)_j\\right) \\mathrm{d}x = \\int_{0}^{L} \\rho A\\, v_a(x)\\, v_b(x)\\, \\mathrm{d}x $$\n其中 $v_a(x)$ 和 $v_b(x)$ 是模态 $\\boldsymbol{\\phi}_a$ 和 $\\boldsymbol{\\phi}_b$ 的位移场。\n\n$G_{11} = \\boldsymbol{\\phi}_t^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_t = \\int_{0}^{L} \\rho A\\, v_t(x)\\, v_t(x)\\, \\mathrm{d}x$。当 $v_t(x)=1$ 时：\n$$ G_{11} = \\int_{0}^{L} \\rho A\\, (1)^2 \\, \\mathrm{d}x = \\rho A \\int_{0}^{L} \\mathrm{d}x = \\rho A L $$\n这是梁单元的总质量，与纯平移的预期相符。\n\n$G_{22} = \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_r = \\int_{0}^{L} \\rho A\\, v_r(x)\\, v_r(x)\\, \\mathrm{d}x$。当 $v_r(x)=x$ 时：\n$$ G_{22} = \\int_{0}^{L} \\rho A\\, x^2 \\, \\mathrm{d}x = \\rho A \\left[ \\frac{x^3}{3} \\right]_{0}^{L} = \\frac{\\rho A L^3}{3} $$\n这是梁关于 $x=0$ 端点的质量惯性矩。\n\n$G_{12} = \\boldsymbol{\\phi}_t^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_r = \\int_{0}^{L} \\rho A\\, v_t(x)\\, v_r(x)\\, \\mathrm{d}x$。当 $v_t(x)=1$ 和 $v_r(x)=x$ 时：\n$$ G_{12} = \\int_{0}^{L} \\rho A\\, (1)(x) \\, \\mathrm{d}x = \\rho A \\left[ \\frac{x^2}{2} \\right]_{0}^{L} = \\frac{\\rho A L^2}{2} $$\n这是关于 $x=0$ 端点的质量一阶矩。\n\n由于 $\\mathbf{M}$ 是对称的，$\\mathbf{G}$ 也必定是对称的，所以 $G_{21} = G_{12}$。\n广义质量矩阵是：\n$$ \\mathbf{G} = \\begin{pmatrix} \\rho A L  \\frac{1}{2} \\rho A L^2 \\\\ \\frac{1}{2} \\rho A L^2  \\frac{1}{3} \\rho A L^3 \\end{pmatrix} $$\n行列式计算如下：\n$$ \\det(\\mathbf{G}) = (\\rho A L) \\left(\\frac{1}{3} \\rho A L^3\\right) - \\left(\\frac{1}{2} \\rho A L^2\\right)^2 $$\n$$ \\det(\\mathbf{G}) = \\frac{1}{3} (\\rho A)^2 L^4 - \\frac{1}{4} (\\rho A)^2 L^4 $$\n$$ \\det(\\mathbf{G}) = \\left(\\frac{1}{3} - \\frac{1}{4}\\right) (\\rho A)^2 L^4 = \\left(\\frac{4-3}{12}\\right) (\\rho A)^2 L^4 = \\frac{1}{12} (\\rho A)^2 L^4 $$\n这就是行列式的最终符号表达式。", "answer": "$$\\boxed{\\frac{1}{12} (\\rho A)^{2} L^{4}}$$", "id": "2594259"}, {"introduction": "最后的实践环节旨在解决动力学仿真中的一个核心问题：我们的半离散模型到底有多精确？本练习将深入探讨数值频散的概念，即空间离散化导致不同频率的波以错误的速度传播的现象。通过分析这种误差，我们将推导出一个至关重要的实用准则，它将所需的单元尺寸与物理现象的波长联系起来，从而确保仿真的保真度 [@problem_id:2594269]。", "problem": "考虑一根无限长、均匀、各向同性的杆中的纵向小振幅波。其控制强形式为一维线性弹性波动方程\n$$\n\\rho \\, u_{tt}(x,t) \\;=\\; E \\, u_{xx}(x,t),\n$$\n其中 $u(x,t)$ 是位移，$\\rho$ 是质量密度，$E$ 是杨氏模量。精确的物理相速度为 $c = \\sqrt{E/\\rho}$，对于物理波数为 $k$ 的单色平面波，其物理波长为 $\\lambda = 2\\pi/k$。\n\n使用标准的 Galerkin 有限元法 (FEM)，在线性 Lagrange 基函数和单元尺寸为 $h$ 的均匀网格上进行空间半离散化，并使用一致质量矩阵。假设周期性设置，以允许离散的 Bloch 波存在。关注最低的色散分支。\n\n根据半离散色散关系定义数值相速度 $v_p^h$。设目标是为最低分支保持相对相速度误差的预定界限 $\\varepsilon > 0$，即：\n$$\n\\left| \\frac{v_p^h - c}{c} \\right| \\;\\le\\; \\varepsilon.\n$$\n从控制方程的弱形式出发，通过 Galerkin 半离散化，推导最低分支的离散色散关系，获得其在无量纲波数较小时的主导非平凡阶渐近式，并由此建立一个关于网格与波长之比 $h/\\lambda$ 的准则，以保证对于足够小的 $kh$ 值，上述误差界限得以满足。\n\n定义 $\\eta(\\varepsilon)$ 为单元尺寸与物理波长的最大允许比率，使得 $h/\\lambda \\le \\eta(\\varepsilon)$ 能确保最低色散分支的相对相速度误差界限。$\\eta(\\varepsilon)$ 的闭式表达式是什么？\n\n请用仅含 $\\varepsilon$ 的符号表达式给出最终答案。不需要单位。", "solution": "对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 控制方程：$\\rho \\, u_{tt}(x,t) = E \\, u_{xx}(x,t)$\n- 变量和常数：$u(x,t)$ 是位移，$\\rho$ 是质量密度，$E$ 是杨氏模量。\n- 精确相速度：$c = \\sqrt{E/\\rho}$\n- 物理波数：$k$\n- 物理波长：$\\lambda = 2\\pi/k$\n- 数值方法：标准的 Galerkin 有限元法 (FEM)，使用线性 Lagrange 基函数。\n- 网格细节：均匀网格，单元尺寸为 $h$。\n- 质量矩阵：一致质量矩阵。\n- 边界条件：周期性设置，允许离散 Bloch 波。\n- 分析目标：最低色散分支。\n- 数值相速度：$v_p^h$\n- 误差容限：$\\left| \\frac{v_p^h - c}{c} \\right| \\le \\varepsilon$，对于给定的 $\\varepsilon > 0$。\n- 要求推导：对于小 $kh$ 值，关于网格与波长之比 $h/\\lambda$ 的准则。\n- 最终目标：求出 $\\eta(\\varepsilon)$ 的表达式，即最大允许比率 $h/\\lambda$。\n\n**第2步：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于一维线性波动方程（物理学中的一个基本模型）及其使用有限元法（一种标准且成熟的技术）的数值解。数值方案的色散分析是计算力学中的核心课题，具有科学严谨性。该问题是合理的。\n- **适定性**：问题阐述清晰。它要求基于一系列明确定义的数学步骤推导一个量 $\\eta(\\varepsilon)$：推导弱形式、半离散化、色散分析和渐近展开。所有确定唯一解所需的信息都已提供。\n- **客观性**：问题使用精确的数学语言和客观标准进行表述。没有主观或含糊不清的陈述。\n- **完整性**：问题是自洽的。它提供了控制偏微分方程、要使用的具体数值方法（采用线性单元和一致质量的 Galerkin 有限元法）、要假设的解的类型（周期域的 Bloch 波）以及要分析的误差度量。\n- **其他标准**：该问题不属于科学上不合理、不可形式化、不完整、自相矛盾、不切实际、不适定、微不足道或超出科学可验证范围的情况。\n\n**第3步：结论与行动**\n该问题是**有效的**。将提供一个完整、论证充分的解答。\n\n出发点是一维波动方程的强形式：\n$$\n\\rho \\frac{\\partial^2 u}{\\partial t^2} - E \\frac{\\partial^2 u}{\\partial x^2} = 0\n$$\n为推导弱形式，我们乘以一个测试函数 $w(x)$ 并在空间域上积分。对于周期性问题，该域可以被视为无限域或具有周期性边界条件的有限长度域。\n$$\n\\int_{-\\infty}^{\\infty} w \\left( \\rho \\frac{\\partial^2 u}{\\partial t^2} - E \\frac{\\partial^2 u}{\\partial x^2} \\right) dx = 0\n$$\n对第二项应用分部积分法，得到：\n$$\n\\int_{-\\infty}^{\\infty} \\left( \\rho w \\frac{\\partial^2 u}{\\partial t^2} + E \\frac{\\partial w}{\\partial x} \\frac{\\partial u}{\\partial x} \\right) dx - \\left[ w E \\frac{\\partial u}{\\partial x} \\right]_{-\\infty}^{\\infty} = 0\n$$\n对于在无穷远处衰减的函数或周期性条件，边界项消失。于是弱形式为：求 $u(x,t)$，使得对于所有容许的测试函数 $w(x)$，\n$$\n\\int_{-\\infty}^{\\infty} \\rho w \\ddot{u} \\, dx + \\int_{-\\infty}^{\\infty} E w' u' \\, dx = 0\n$$\n其中撇号和点号分别表示空间和时间导数。\n\n我们使用 Galerkin 方法进行半离散化。位移场 $u(x,t)$ 近似为 $u^h(x,t) = \\sum_{j} N_j(x) d_j(t)$，其中 $N_j(x)$ 是以节点 $j$ 为中心的线性“帽”状基函数，$d_j(t)$ 是节点位移。测试函数选自相同的基，$w(x) = N_i(x)$。这导出了一个常微分方程组：\n$$\n\\boldsymbol{M} \\ddot{\\boldsymbol{d}}(t) + \\boldsymbol{K} \\boldsymbol{d}(t) = \\boldsymbol{0}\n$$\n这里，$\\boldsymbol{M}$ 是全局一致质量矩阵，$\\boldsymbol{K}$ 是全局刚度矩阵。它们的项为 $M_{ij} = \\int \\rho N_i N_j \\, dx$ 和 $K_{ij} = \\int E N_i' N_j' \\, dx$。\n\n对于单元尺寸为 $h$ 的均匀网格和线性单元，一个跨越 $[x_1, x_2]$ 的单元的单元质量矩阵和刚度矩阵为：\n$$\n\\mathbf{M}^e = \\frac{\\rho h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad \\mathbf{K}^e = \\frac{E}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n为一般内部节点 $j$ 组装这些矩阵，得到单个方程：\n$$\n\\frac{\\rho h}{6} (\\ddot{d}_{j-1} + 4 \\ddot{d}_j + \\ddot{d}_{j+1}) + \\frac{E}{h} (-d_{j-1} + 2 d_j - d_{j+1}) = 0\n$$\n我们寻求形式为 $d_j(t) = A \\exp(i(kjh - \\omega^h t))$ 的离散 Bloch 波解，其中 $k$ 是波数，$\\omega^h$ 是数值频率。将此代入节点 $j$ 的方程中，得到：\n$$\n\\ddot{d}_j = -(\\omega^h)^2 d_j, \\quad d_{j \\pm 1} = d_j \\exp(\\pm ikh)\n$$\n方程变为：\n$$\n-\\frac{\\rho h}{6}(\\omega^h)^2 (e^{-ikh} + 4 + e^{ikh}) + \\frac{E}{h}(-e^{-ikh} + 2 - e^{ikh}) = 0\n$$\n使用 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们将其简化为：\n$$\n-\\frac{\\rho h}{6}(\\omega^h)^2 (2\\cos(kh) + 4) + \\frac{E}{h}(-2\\cos(kh) + 2) = 0\n$$\n求解 $(\\omega^h)^2$：\n$$\n(\\omega^h)^2 \\frac{\\rho h}{3} (\\cos(kh) + 2) = \\frac{2E}{h}(1-\\cos(kh)) \\implies (\\omega^h)^2 = \\frac{6E}{\\rho h^2} \\frac{1-\\cos(kh)}{2+\\cos(kh)}\n$$\n数值相速度为 $v_p^h = \\omega^h / k$。数值相速度与精确相速度 $c=\\sqrt{E/\\rho}$ 之比的平方为：\n$$\n\\left(\\frac{v_p^h}{c}\\right)^2 = \\frac{(\\omega^h)^2}{k^2 c^2} = \\frac{1}{k^2(E/\\rho)} \\frac{6E}{\\rho h^2} \\frac{1-\\cos(kh)}{2+\\cos(kh)} = \\frac{6}{(kh)^2} \\frac{1-\\cos(kh)}{2+\\cos(kh)}\n$$\n令 $\\alpha = kh$ 为无量纲波数。色散关系为：\n$$\n\\left(\\frac{v_p^h}{c}\\right)^2 = \\frac{6}{\\alpha^2} \\frac{1-\\cos(\\alpha)}{2+\\cos(\\alpha)}\n$$\n我们现在求小 $\\alpha$ 的渐近行为。我们使用 $\\cos(\\alpha)$ 在 $\\alpha=0$ 处的泰勒级数展开：\n$$\n\\cos(\\alpha) = 1 - \\frac{\\alpha^2}{2!} + \\frac{\\alpha^4}{4!} - O(\\alpha^6)\n$$\n将此代入色散关系中：\n$$\n\\left(\\frac{v_p^h}{c}\\right)^2 = \\frac{6}{\\alpha^2} \\frac{1 - (1 - \\frac{\\alpha^2}{2} + \\frac{\\alpha^4}{24} - \\dots)}{2 + (1 - \\frac{\\alpha^2}{2} + \\frac{\\alpha^4}{24} - \\dots)} = \\frac{6}{\\alpha^2} \\frac{\\frac{\\alpha^2}{2} - \\frac{\\alpha^4}{24} + O(\\alpha^6)}{3 - \\frac{\\alpha^2}{2} + O(\\alpha^4)}\n$$\n$$\n= \\frac{3 - \\frac{\\alpha^2}{4} + O(\\alpha^4)}{3 - \\frac{\\alpha^2}{2} + O(\\alpha^4)} = \\frac{1 - \\frac{\\alpha^2}{12} + O(\\alpha^4)}{1 - \\frac{\\alpha^2}{6} + O(\\alpha^4)}\n$$\n对于小的 $x$，使用几何级数近似 $(1-x)^{-1} \\approx 1+x$：\n$$\n\\left(\\frac{v_p^h}{c}\\right)^2 \\approx \\left(1 - \\frac{\\alpha^2}{12}\\right) \\left(1 + \\frac{\\alpha^2}{6}\\right) = 1 + \\frac{\\alpha^2}{6} - \\frac{\\alpha^2}{12} - \\frac{\\alpha^4}{72} \\approx 1 + \\frac{\\alpha^2}{12}\n$$\n主导的非平凡渐近表达式为 $\\left(\\frac{v_p^h}{c}\\right)^2 \\approx 1 + \\frac{\\alpha^2}{12}$。现在我们求速度之比：\n$$\n\\frac{v_p^h}{c} = \\sqrt{1 + \\frac{\\alpha^2}{12}} \\approx 1 + \\frac{1}{2} \\frac{\\alpha^2}{12} = 1 + \\frac{\\alpha^2}{24}\n$$\n这里使用了对于小 $x$ 的二项式近似 $\\sqrt{1+x} \\approx 1+x/2$。相对相速度误差为：\n$$\n\\frac{v_p^h - c}{c} = \\frac{v_p^h}{c} - 1 \\approx \\frac{\\alpha^2}{24}\n$$\n误差为正，这意味着相位超前 ($v_p^h > c$)。问题要求误差界限为：\n$$\n\\left| \\frac{v_p^h - c}{c} \\right| \\le \\varepsilon \\implies \\frac{\\alpha^2}{24} \\le \\varepsilon\n$$\n这给出 $\\alpha^2 \\le 24\\varepsilon$。现在我们将其与所要求的比率 $h/\\lambda$ 联系起来。根据定义，$\\alpha=kh$ 且 $\\lambda=2\\pi/k$，因此 $k=2\\pi/\\lambda$。\n$$\n\\alpha = \\frac{2\\pi}{\\lambda} h\n$$\n将此代入不等式中：\n$$\n\\left(\\frac{2\\pi h}{\\lambda}\\right)^2 \\le 24\\varepsilon\n$$\n$$\n4\\pi^2 \\left(\\frac{h}{\\lambda}\\right)^2 \\le 24\\varepsilon\n$$\n$$\n\\left(\\frac{h}{\\lambda}\\right)^2 \\le \\frac{24\\varepsilon}{4\\pi^2} = \\frac{6\\varepsilon}{\\pi^2}\n$$\n取平方根，得到关于网格与波长之比的准则：\n$$\n\\frac{h}{\\lambda} \\le \\sqrt{\\frac{6\\varepsilon}{\\pi^2}} = \\frac{\\sqrt{6\\varepsilon}}{\\pi}\n$$\n问题将 $\\eta(\\varepsilon)$ 定义为最大允许比率 $h/\\lambda$。因此，\n$$\n\\eta(\\varepsilon) = \\frac{\\sqrt{6\\varepsilon}}{\\pi}\n$$\n这就是保证在无量纲波数足够小的情况下相速度误差界限的闭式表达式。", "answer": "$$\n\\boxed{\\frac{\\sqrt{6\\varepsilon}}{\\pi}}\n$$", "id": "2594269"}]}