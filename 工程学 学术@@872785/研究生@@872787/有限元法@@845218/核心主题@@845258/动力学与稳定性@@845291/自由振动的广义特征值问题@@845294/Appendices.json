{"hands_on_practices": [{"introduction": "这项练习将引导你完整地走过一个自由振动问题的有限元方法（FEM）全过程。你将从应变能和动能的基本原理出发，推导出一个简单杆单元的刚度矩阵和质量矩阵。这项实践旨在巩固物理原理与其离散矩阵表示之间的联系，并指导你完成组装全局系统、施加边界条件，并最终求解结构基频的全过程。[@problem_id:2562525]", "problem": "考虑一根均匀直棱轴向杆，使用线性二节点杆单元通过有限元法 (FEM) 进行建模。该杆具有恒定的杨氏模量 $E$、横截面积 $A$、质量密度 $\\rho$ 和总长度 $L$。该杆两端固定（固支-固支边界条件）。随时间变化的轴向位移场记为 $u(x,t)$。假设为小变形和线性、弹性、一维轴向行为。\n\n任务：\n1. 从轴向应变 $\\varepsilon(x,t)$、柯西应力 $\\sigma(x,t)$ 的标准定义，以及弹性应变能和动能的表达式出发，推导长度为 $\\ell_{e}$ 的单个线性二节点杆单元的单元刚度矩阵和一致单元质量矩阵。在单元上使用标准线性形函数进行插值，且不假设集总质量。\n2. 将杆离散为2个等长单元（$\\ell_{e} = L/2$），节点从左端到右端编号为1、2和3。组装全局刚度矩阵和质量矩阵，然后在节点1和3处施加固支边界条件，以获得用于自由振动的简化广义特征值问题。确定离散化系统的基频角频率 $\\omega_{1}$。\n3. 对于给定的数据 $E = 75 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 3000\\,\\mathrm{kg\\,m^{-3}}$，$A = 5 \\times 10^{-4}\\,\\mathrm{m^{2}}$ 和 $L = 2\\,\\mathrm{m}$，数值计算 $\\omega_{1}$。以弧度/秒为单位表示最终频率，并将答案四舍五入到四位有效数字。", "solution": "所述问题是有效的、有科学依据且适定的。这是有限元法在结构动力学中应用的一个标准练习。我们开始进行求解。\n\n自由振动的分析始于能量守恒原理，或更正式地，哈密顿原理。对于一个无外力做功的保守系统，运动方程由拉格朗日量 $L = T - U$ 导出，其中 $T$ 是总动能，$U$ 是总应变能。变分法导出了有限元系统的矩阵运动方程：$\\mathbf{M}\\ddot{\\mathbf{u}} + \\mathbf{K}\\mathbf{u} = \\mathbf{0}$。对于自由谐振，我们假设解的形式为 $\\mathbf{u}(t) = \\mathbf{U} e^{i\\omega t}$，这产生广义特征值问题 $(\\mathbf{K} - \\omega^{2}\\mathbf{M})\\mathbf{U} = \\mathbf{0}$，其中 $\\omega$ 代表固有角频率，$\\mathbf{U}$ 代表相应的振型。\n\n**任务1：单元刚度矩阵和质量矩阵的推导**\n\n我们考虑一个长度为 $\\ell_e$、横截面积为 $A$、杨氏模量为 $E$、质量密度为 $\\rho$ 的单个线性二节点轴向杆单元。设该单元沿 $x$ 轴从 $x=0$ 延伸到 $x=\\ell_e$。单元内的轴向位移场 $u(x,t)$ 通过线性形函数 $N_1(x)$ 和 $N_2(x)$ 从节点位移 $u_1(t)$ 和 $u_2(t)$ 插值得到：\n$$u(x,t) = N_1(x) u_1(t) + N_2(x) u_2(t) = \\mathbf{N}(x)\\mathbf{d}_e(t)$$\n其中 $\\mathbf{d}_e(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ 是节点位移向量，$\\mathbf{N}(x) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix}$ 是形函数矩阵。对于线性单元，这些函数是：\n$$N_1(x) = 1 - \\frac{x}{\\ell_e} \\quad \\text{和} \\quad N_2(x) = \\frac{x}{\\ell_e}$$\n\n轴向应变 $\\varepsilon(x,t)$ 是位移的空间导数：\n$$\\varepsilon(x,t) = \\frac{\\partial u}{\\partial x} = \\frac{d\\mathbf{N}}{dx}\\mathbf{d}_e(t) = \\mathbf{B}\\mathbf{d}_e(t)$$\n该单元的应变-位移矩阵 $\\mathbf{B}$ 是恒定的：\n$$\\mathbf{B} = \\frac{d\\mathbf{N}}{dx} = \\begin{pmatrix} \\frac{d N_1}{dx} & \\frac{d N_2}{dx} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\ell_e} & \\frac{1}{\\ell_e} \\end{pmatrix}$$\n\n储存在单元中的弹性应变能 $U_e$ 由下式给出：\n$$U_e = \\frac{1}{2} \\int_V \\sigma \\varepsilon \\, dV = \\frac{1}{2} \\int_0^{\\ell_e} (E\\varepsilon) \\varepsilon A \\, dx = \\frac{1}{2} \\int_0^{\\ell_e} (\\mathbf{d}_e^T \\mathbf{B}^T E \\mathbf{B} \\mathbf{d}_e) A \\, dx$$\n由于 $\\mathbf{d}_e$ 不是 $x$ 的函数，上式简化为 $U_e = \\frac{1}{2} \\mathbf{d}_e^T \\mathbf{k}_e \\mathbf{d}_e$，其中单元刚度矩阵 $\\mathbf{k}_e$ 为：\n$$\\mathbf{k}_e = \\int_0^{\\ell_e} \\mathbf{B}^T E \\mathbf{B} A \\, dx = A E \\ell_e \\mathbf{B}^T \\mathbf{B}$$\n代入 $\\mathbf{B}$ 的表达式：\n$$\\mathbf{k}_e = A E \\ell_e \\begin{pmatrix} -1/\\ell_e \\\\ 1/\\ell_e \\end{pmatrix} \\begin{pmatrix} -1/\\ell_e & 1/\\ell_e \\end{pmatrix} = A E \\ell_e \\begin{pmatrix} 1/\\ell_e^2 & -1/\\ell_e^2 \\\\ -1/\\ell_e^2 & 1/\\ell_e^2 \\end{pmatrix} = \\frac{AE}{\\ell_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\n单元的动能 $T_e$ 由下式给出：\n$$T_e = \\frac{1}{2} \\int_V \\rho \\dot{u}^2 \\, dV = \\frac{1}{2} \\int_0^{\\ell_e} \\rho (\\mathbf{N}\\dot{\\mathbf{d}}_e)^2 A \\, dx = \\frac{1}{2} \\int_0^{\\ell_e} \\dot{\\mathbf{d}}_e^T \\mathbf{N}^T \\rho \\mathbf{N} \\dot{\\mathbf{d}}_e A \\, dx$$\n这简化为 $T_e = \\frac{1}{2} \\dot{\\mathbf{d}}_e^T \\mathbf{m}_e \\dot{\\mathbf{d}}_e$，其中一致单元质量矩阵 $\\mathbf{m}_e$ 为：\n$$\\mathbf{m}_e = \\int_0^{\\ell_e} \\mathbf{N}^T \\rho \\mathbf{N} A \\, dx = \\rho A \\int_0^{\\ell_e} \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix} dx$$\n$$\\mathbf{m}_e = \\rho A \\int_0^{\\ell_e} \\begin{pmatrix} (1 - x/\\ell_e)^2 & (x/\\ell_e)(1 - x/\\ell_e) \\\\ (x/\\ell_e)(1 - x/\\ell_e) & (x/\\ell_e)^2 \\end{pmatrix} dx$$\n计算积分：\n$\\int_0^{\\ell_e} (1 - x/\\ell_e)^2 dx = \\ell_e/3$\n$\\int_0^{\\ell_e} (x/\\ell_e)(1 - x/\\ell_e) dx = \\ell_e/6$\n$\\int_0^{\\ell_e} (x/\\ell_e)^2 dx = \\ell_e/3$\n因此，一致单元质量矩阵为：\n$$\\mathbf{m}_e = \\rho A \\ell_e \\begin{pmatrix} 1/3 & 1/6 \\\\ 1/6 & 1/3 \\end{pmatrix} = \\frac{\\rho A \\ell_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n\n**任务2：系统组装、边界条件和特征值问题**\n\n总长度为 $L$ 的杆被离散为两个等长单元，长度为 $\\ell_e = L/2$。节点编号为1、2和3。单元(1)连接节点1和2，单元(2)连接节点2和3。每个单元的单元矩阵为：\n$$\\mathbf{k}^{(1)} = \\mathbf{k}^{(2)} = \\frac{AE}{L/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{2AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n$$\\mathbf{m}^{(1)} = \\mathbf{m}^{(2)} = \\frac{\\rho A (L/2)}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\frac{\\rho A L}{12} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n全局刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 是通过将每个单元的贡献求和到一个对应于全局自由度 $u_1$、$u_2$ 和 $u_3$ 的 $3 \\times 3$ 矩阵中来组装的。\n$$ \\mathbf{K} = \\frac{2AE}{L} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1+1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\frac{2AE}{L} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} $$\n$$ \\mathbf{M} = \\frac{\\rho A L}{12} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2+2 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} = \\frac{\\rho A L}{12} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 4 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} $$\n杆的两端是固定的，这意味着边界条件为 $u_1 = 0$ 和 $u_3 = 0$。我们通过从全局特征值问题 $(\\mathbf{K} - \\omega^2 \\mathbf{M})\\mathbf{U} = \\mathbf{0}$ 中消去与受约束自由度（1和3）对应的行和列，来获得关于未知位移 $u_2$ 的自由振动的简化系统。简化后的系统是一个只涉及中心节点自由度的标量方程：\n$$(K_{22} - \\omega^2 M_{22}) u_2 = 0$$\n为了得到非平凡解（$u_2 \\ne 0$），括号中的项必须为零。所需的矩阵分量是：\n$$K_{22} = \\frac{2AE}{L}(2) = \\frac{4AE}{L}$$\n$$M_{22} = \\frac{\\rho A L}{12}(4) = \\frac{\\rho A L}{3}$$\n特征值问题变为：\n$$\\frac{4AE}{L} - \\omega^2 \\frac{\\rho A L}{3} = 0$$\n该系统只有一个自由度，因此它只产生一个固有频率，即该离散化模型的基频 $\\omega_1$。求解 $\\omega_1^2$：\n$$\\omega_1^2 = \\frac{4AE/L}{\\rho A L/3} = \\frac{12AE}{\\rho A L^2} = \\frac{12E}{\\rho L^2}$$\n基频角频率为：\n$$\\omega_1 = \\sqrt{\\frac{12E}{\\rho L^2}} = \\frac{2\\sqrt{3}}{L}\\sqrt{\\frac{E}{\\rho}}$$\n\n**任务3：数值计算**\n\n我们有以下给定数据：$E = 75 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 3000\\,\\mathrm{kg\\,m^{-3}}$，$A = 5 \\times 10^{-4}\\,\\mathrm{m^{2}}$ 和 $L = 2\\,\\mathrm{m}$。注意，面积 $A$ 在频率表达式中被消掉了。\n将数值代入推导出的 $\\omega_1$ 表达式中：\n$$\\omega_1 = \\sqrt{\\frac{12 \\times (75 \\times 10^9)}{3000 \\times 2^2}} = \\sqrt{\\frac{900 \\times 10^9}{3000 \\times 4}} = \\sqrt{\\frac{9 \\times 10^{11}}{12000}}$$\n$$\\omega_1 = \\sqrt{\\frac{9 \\times 10^{11}}{1.2 \\times 10^4}} = \\sqrt{\\frac{9}{1.2} \\times 10^7} = \\sqrt{7.5 \\times 10^7} = \\sqrt{75 \\times 10^6}$$\n$$\\omega_1 = 10^3 \\sqrt{75} = 10^3 \\sqrt{25 \\times 3} = 5000\\sqrt{3} \\approx 8660.254 \\, \\mathrm{rad/s}$$\n将结果四舍五入到四位有效数字，得到：\n$$\\omega_1 \\approx 8660 \\, \\mathrm{rad/s}$$", "answer": "$$\\boxed{8660}$$", "id": "2562525"}, {"introduction": "在基本公式构建的基础上，本练习深入探讨了数值动力学的一个关键方面：色散分析。你将研究质量矩阵的选择——即一致质量矩阵与集总质量矩阵——如何影响波在有限元网格中的传播，尤其是在高频情况下。这一分析对于理解有限元模拟在波传播现象中的准确性和局限性至关重要，并引出了旨在提高解的保真度的高阶方法概念。[@problem_id:2562488]", "problem": "一根横截面积为 $A$、质量密度为 $\\rho$、杨氏模量为 $E$ 的无限长、均匀、棱柱状弹性杆，其纵向小振幅自由振动由一维波动方程 $\\rho A \\, \\partial^{2} u / \\partial t^{2} - E A \\, \\partial^{2} u / \\partial x^{2} = 0$ 控制，其中 $u(x,t)$ 是轴向位移。弹性波速为 $c = \\sqrt{E / \\rho}$。该杆通过有限元法（FEM）进行离散化，使用尺寸为 $h$ 的双节点线性单元组成的均匀网格。标准单元刚度矩阵和一致质量矩阵分别为 $K_{e} = (E A / h) \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$ 和 $M_{e}^{c} = (\\rho A h / 6) \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$，而集中单元质量矩阵为 $M_{e}^{\\ell} = (\\rho A h / 2) \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$。设 $u_{j}(t)$ 表示第 $j$ 个节点的位移，并假设对于波数 $k$ 和角频率 $\\omega$，Bloch 波 ansatz $u_{j}(t) = U \\exp(\\mathrm{i} (j k h - \\omega t))$ 成立。通过在无限晶格上组装全局半离散系统 $M \\ddot{u} + K u = 0$ 并代入 Bloch ansatz，可以得到形如 $K \\phi = \\omega^{2} M \\phi$ 的广义特征值问题，从而得出 $\\omega$ 和 $k$ 之间的离散色散关系。\n\n任务1：从组装的节点方程出发，并且不使用任何非由前述定义推导出的结果，推导一致质量矩阵和集中质量矩阵的离散色散关系 $\\Omega(kh)$，其中无量纲频率为 $\\Omega = \\omega h / c$。然后，评估这两种质量矩阵的高频边界极限 $\\lim_{kh \\to \\pi} \\Omega$，并评论与一致质量情况相比，质量集中如何改变高频色散。\n\n任务2：为了在不改变刚度的情况下改善高波数下的色散，考虑在组装的晶格层面上采用如下形式的最近邻校正质量\n$$( - \\omega^{2} ) \\, \\rho A h \\, \\big( \\alpha_{0} \\, u_{j} + \\alpha_{1} \\, (u_{j-1} + u_{j+1}) \\big) + \\frac{E A}{h} \\, \\big( 2 u_{j} - u_{j-1} - u_{j+1} \\big) = 0,$$\n其中 $\\alpha_{0}$ 和 $\\alpha_{1}$ 是实数、无量纲系数。施加零波数归一化约束 $\\alpha_{0} + 2 \\alpha_{1} = 1$，以使主阶长波长相速度等于 $c$。使用 Bloch ansatz，推导相应的色散关系\n$$(\\Omega(kh))^{2} \\;=\\; \\frac{2 \\, \\big( 1 - \\cos(kh) \\big)}{\\alpha_{0} + 2 \\alpha_{1} \\cos(kh)}.$$\n通过将此关系在 $x = 0$ 附近展开为 $x = (kh)^{2}$ 的幂级数，确定能够消除 $\\mathcal{O}((kh)^{2})$ 色散误差的 $\\alpha_{1}$ 的唯一值，即强制 $(\\Omega / (kh))^{2} = 1 + \\mathcal{O}((kh)^{4})$。将 $\\alpha_{1}$ 的值作为最终答案报告。不需要四舍五入；提供一个不带单位的精确值。", "solution": "问题陈述科学上合理、提法得当且客观。这是分析一维波动方程 $\\rho A \\, \\partial^{2} u / \\partial t^{2} - E A \\, \\partial^{2} u / \\partial x^{2} = 0$ 有限元离散化中数值色散的一个标准练习。所有必要信息都已提供，任务定义明确。因此，该问题被认为是有效的，并将提供解答。\n\n该问题要求对一维波动方程的有限元离散化的色散特性进行两部分分析。\n\n任务1：推导一致质量矩阵和集中质量矩阵的离散色散关系，并分析其高频行为。\n\n首先，我们为一个无限均匀网格中的一般节点 $j$ 组装半离散运动方程。该方程的形式为 $M \\ddot{u} + K u = 0$。该系统中与节点位移 $u_j(t)$ 对应的行是通过对与节点 $j$ 相邻的两个单元——单元 $(j-1, j)$ 和单元 $(j, j+1)$——的贡献求和来构建的。\n\n节点 $j$ 处的刚度贡献来自于相邻单元施加的力。使用给定的单元刚度矩阵 $K_{e} = (E A / h) \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$，来自单元 $(j-1, j)$ 对节点 $j$ 的力是 $K_e$ 的第二行作用于 $(u_{j-1}, u_j)^T$ 的结果，即 $\\frac{EA}{h}(-u_{j-1} + u_j)$。来自单元 $(j, j+1)$ 对节点 $j$ 的力是 $K_e$ 的第一行作用于 $(u_j, u_{j+1})^T$ 的结果，即 $\\frac{EA}{h}(u_j - u_{j+1})$。节点 $j$ 的总刚度项是其和：\n$$ (K u)_j = \\frac{EA}{h}(-u_{j-1} + u_j) + \\frac{EA}{h}(u_j - u_{j+1}) = \\frac{EA}{h}(2u_j - u_{j-1} - u_{j+1}) $$\n对于一致质量和集中质量公式，该项是相同的，因为刚度矩阵没有改变。\n\n惯性项 $(M \\ddot{u})_j$ 取决于质量矩阵。\n对于一致质量矩阵 $M_{e}^{c} = (\\rho A h / 6) \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$，来自单元 $(j-1, j)$ 对节点 $j$ 的惯性项是 $M_e^c$ 的第二行作用于 $(\\ddot{u}_{j-1}, \\ddot{u}_j)^T$ 的结果，即 $\\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 2\\ddot{u}_j)$。来自单元 $(j, j+1)$ 的项是第一行作用于 $(\\ddot{u}_j, \\ddot{u}_{j+1})^T$ 的结果，即 $\\frac{\\rho A h}{6}(2\\ddot{u}_j + \\ddot{u}_{j+1})$。总惯性项为：\n$$ (M^c \\ddot{u})_j = \\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 2\\ddot{u}_j) + \\frac{\\rho A h}{6}(2\\ddot{u}_j + \\ddot{u}_{j+1}) = \\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) $$\n一致质量情况下的运动方程为：\n$$ \\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{EA}{h}(2u_j - u_{j-1} - u_{j+1}) = 0 $$\n\n对于集中质量矩阵 $M_{e}^{\\ell} = (\\rho A h / 2) \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$，过程是类似的。来自单元 $(j-1, j)$ 对节点 $j$ 的惯性项为 $\\frac{\\rho A h}{2}\\ddot{u}_j$，来自单元 $(j, j+1)$ 的惯性项也为 $\\frac{\\rho A h}{2}\\ddot{u}_j$。总惯性项为：\n$$ (M^\\ell \\ddot{u})_j = \\frac{\\rho A h}{2}\\ddot{u}_j + \\frac{\\rho A h}{2}\\ddot{u}_j = \\rho A h \\ddot{u}_j $$\n集中质量情况下的运动方程为：\n$$ \\rho A h \\ddot{u}_j + \\frac{EA}{h}(2u_j - u_{j-1} - u_{j+1}) = 0 $$\n\n为了找到色散关系，我们将 Bloch 波 ansatz $u_j(t) = U \\exp(\\mathrm{i}(jkh - \\omega t))$ 代入这些方程。我们注意到 $\\ddot{u}_j = -\\omega^2 u_j$ 且 $u_{j\\pm 1} = u_j \\exp(\\pm \\mathrm{i}kh)$。\n\n对于一致质量情况：\n$$ -\\omega^2 \\frac{\\rho A h}{6}(u_j e^{-\\mathrm{i}kh} + 4u_j + u_j e^{\\mathrm{i}kh}) + \\frac{EA}{h}(2u_j - u_j e^{-\\mathrm{i}kh} - u_j e^{\\mathrm{i}kh}) = 0 $$\n除以 $u_j$ 并使用 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$:\n$$ -\\omega^2 \\frac{\\rho A h}{6}(2\\cos(kh) + 4) + \\frac{EA}{h}(2 - 2\\cos(kh)) = 0 $$\n求解 $\\omega^2$：\n$$ \\omega^2 = \\frac{EA/h}{\\rho A h/3} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)} = \\frac{3E}{\\rho h^2} \\frac{1 - \\cos(kh)}{1 + \\cos(kh)/2} $$\n让我回顾一下代数运算。$\\frac{\\rho A h}{6}(4+2\\cos(kh)) = \\frac{\\rho A h}{3}(2+\\cos(kh))$。不，那是不正确的。\n系数是 $\\frac{\\rho A h}{6}(4+2\\cos(kh))$。另一项是 $\\frac{EA}{h} 2(1-\\cos(kh))$。\n$$ \\omega^2 = \\frac{EA/h}{\\rho A h/6} \\frac{2(1-\\cos(kh))}{4+2\\cos(kh)} = \\frac{6E}{\\rho h^2} \\frac{1-\\cos(kh)}{2+\\cos(kh)} $$\n使用定义 $c = \\sqrt{E/\\rho}$ 和 $\\Omega = \\omega h/c$，我们找到无量纲色散关系：\n$$ \\Omega_c^2 = \\frac{\\omega^2 h^2}{c^2} = \\frac{\\omega^2 h^2 \\rho}{E} = 6 \\frac{1 - \\cos(kh)}{2 + \\cos(kh)} $$\n\n对于集中质量情况：\n$$ -\\omega^2 \\rho A h u_j + \\frac{EA}{h}(2u_j - u_j e^{-\\mathrm{i}kh} - u_j e^{\\mathrm{i}kh}) = 0 $$\n$$ -\\omega^2 \\rho A h + \\frac{EA}{h}(2 - 2\\cos(kh)) = 0 $$\n求解 $\\omega^2$：\n$$ \\omega^2 = \\frac{EA/h}{\\rho A h} (2(1-\\cos(kh))) = \\frac{2E}{\\rho h^2}(1-\\cos(kh)) $$\n无量纲色散关系为：\n$$ \\Omega_\\ell^2 = \\frac{\\omega^2 h^2}{c^2} = 2(1 - \\cos(kh)) $$\n这可以用半角恒等式 $1-\\cos(x) = 2\\sin^2(x/2)$ 重写：\n$$ \\Omega_\\ell^2 = 4\\sin^2(kh/2) \\implies \\Omega_\\ell(kh) = 2|\\sin(kh/2)| $$\n\n现在，评估当 $kh \\to \\pi$ 时的高频极限：\n对于一致质量：\n$$ \\lim_{kh \\to \\pi} \\Omega_c^2 = 6 \\frac{1 - \\cos(\\pi)}{2 + \\cos(\\pi)} = 6 \\frac{1 - (-1)}{2 + (-1)} = 6 \\frac{2}{1} = 12 $$\n$$ \\lim_{kh \\to \\pi} \\Omega_c = \\sqrt{12} = 2\\sqrt{3} $$\n对于集中质量：\n$$ \\lim_{kh \\to \\pi} \\Omega_\\ell^2 = 2(1 - \\cos(\\pi)) = 2(1 - (-1)) = 4 $$\n$$ \\lim_{kh \\to \\pi} \\Omega_\\ell = 2 $$\n精确的色散关系是 $\\omega=ck$，或 $\\Omega = kh$。在区域边界，$\\Omega_{exact}(\\pi) = \\pi \\approx 3.14159$。一致质量法给出 $\\Omega_c(\\pi) = 2\\sqrt{3} \\approx 3.464$，高估了频率。集中质量法给出 $\\Omega_\\ell(\\pi) = 2$，低估了频率。因此，质量集中显著降低了高波数模式的频率，与“更硬”的一致质量公式相比，有效地“软化”了离散系统的动态响应。\n\n任务2：确定改进质量公式的系数 $\\alpha_1$。\n\n给定一个校正质量公式的广义运动方程：\n$$ ( - \\omega^{2} ) \\, \\rho A h \\, \\big( \\alpha_{0} \\, u_{j} + \\alpha_{1} \\, (u_{j-1} + u_{j+1}) \\big) + \\frac{E A}{h} \\, \\big( 2 u_{j} - u_{j-1} - u_{j+1} \\big) = 0 $$\n代入 Bloch ansatz，我们得到：\n$$ -\\omega^2 \\rho A h (\\alpha_0 + 2\\alpha_1 \\cos(kh)) + \\frac{EA}{h}(2 - 2\\cos(kh)) = 0 $$\n求解 $\\omega^2$ 并转换为 $\\Omega^2$：\n$$ \\Omega^2 = \\frac{\\omega^2 h^2}{c^2} = \\frac{2(1 - \\cos(kh))}{\\alpha_0 + 2\\alpha_1 \\cos(kh)} $$\n这证实了问题中给出的关系。在约束条件 $\\alpha_0 = 1 - 2\\alpha_1$ 下，分母变为 $1 - 2\\alpha_1 + 2\\alpha_1\\cos(kh) = 1 - 2\\alpha_1(1-\\cos(kh))$。\n所以，色散关系是：\n$$ \\Omega^2 = \\frac{2(1 - \\cos(kh))}{1 - 2\\alpha_1(1 - \\cos(kh))} $$\n我们需要找到 $\\alpha_1$ 使得 $(\\Omega/(kh))^2 = 1 + \\mathcal{O}((kh)^4)$。设 $q = kh$。我们将 $(\\Omega/q)^2$ 在 $q=0$ 附近展开为 $q$ 的幂级数。\n我们使用 $\\cos(q)$ 的泰勒级数：\n$$ \\cos(q) = 1 - \\frac{q^2}{2!} + \\frac{q^4}{4!} - \\mathcal{O}(q^6) $$\n$$ 1 - \\cos(q) = \\frac{q^2}{2} - \\frac{q^4}{24} + \\mathcal{O}(q^6) $$\n$\\Omega^2$ 的分子是 $2(1-\\cos(q)) = q^2 - \\frac{q^4}{12} + \\mathcal{O}(q^6)$。\n$\\Omega^2$ 的分母是 $1 - 2\\alpha_1(\\frac{q^2}{2} - \\frac{q^4}{24} + \\mathcal{O}(q^6)) = 1 - \\alpha_1 q^2 + \\frac{\\alpha_1}{12} q^4 - \\mathcal{O}(q^6)$。\n现在我们构建 $(\\Omega/q)^2 = \\Omega^2/q^2$ 的比率：\n$$ \\frac{\\Omega^2}{q^2} = \\frac{1 - \\frac{q^2}{12} + \\mathcal{O}(q^4)}{1 - \\alpha_1 q^2 + \\mathcal{O}(q^4)} $$\n使用几何级数展开 $(1-z)^{-1} = 1 + z + z^2 + \\dots$ 其中 $z = \\alpha_1 q^2 - \\mathcal{O}(q^4)$:\n$$ \\frac{\\Omega^2}{q^2} = \\left(1 - \\frac{q^2}{12} + \\mathcal{O}(q^4)\\right) \\left(1 + \\alpha_1 q^2 + \\mathcal{O}(q^4)\\right) $$\n$$ \\frac{\\Omega^2}{q^2} = 1 + \\alpha_1 q^2 - \\frac{1}{12} q^2 + \\mathcal{O}(q^4) = 1 + \\left(\\alpha_1 - \\frac{1}{12}\\right)q^2 + \\mathcal{O}(q^4) $$\n色散误差为 $\\mathcal{O}((kh)^4)$ 阶的条件意味着 $(kh)^2 = q^2$ 项的系数必须为零。\n$$ \\alpha_1 - \\frac{1}{12} = 0 $$\n这就得出了 $\\alpha_1$ 的唯一值：\n$$ \\alpha_1 = \\frac{1}{12} $$\n$\\alpha_1$ 的这一选择消除了主误差项，使得数值格式对于长波长在空间上达到四阶精度。相应的 $\\alpha_0$ 值将是 $\\alpha_0 = 1 - 2(\\frac{1}{12}) = 1 - \\frac{1}{6} = \\frac{5}{6}$。所得的质量矩阵为数值相速度提供了更高阶的精度。", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "2562488"}, {"introduction": "这最后一项实践是一个综合性的计算挑战，它将理论与实际应用联系起来。你将使用更高级的、能够提供高精度的$p$型谱元法，来开发一个悬臂梁振动问题的求解器。这项任务要求你处理$C^1$连续梁单元的复杂性，将公式转化为代码实现，并将你的数值结果与精确的解析解进行验证，这完整地反映了计算工程师的工作流程。[@problem_id:2562466]", "problem": "您的任务是设计并实现一种计算方法，使用有限元法（FEM）来近似计算一根均匀细长悬臂梁的前两个自由振动特征值。您的方法必须基于第一性原理，并构建为自由振动的广义特征值问题。您的程序必须由多项式阶数 $p=4$ 的 $C^1$ 谱梁单元组装全局刚度矩阵和质量矩阵，施加适用于悬臂梁的固支-自由边界条件，求解广义对称特征值问题，并将最低的两个角频率与解析值进行比较。最终输出必须汇总在一个小型测试套件上的精度评估。\n\n基本依据和推导约束：\n- 从用于小横向振动的欧拉-伯努利梁模型出发。其控制方程为 $ \\rho A \\, \\partial^2 w/\\partial t^2 + E I \\, \\partial^4 w/\\partial x^4 = 0$，其中 $w(x,t)$ 是横向位移，$x \\in [0,L]$ 是梁轴，$t$ 是时间，$E$ 是杨氏模量，$I$ 是面积二次矩，$A$ 是横截面积，$\\rho$ 是单位体积的质量密度。\n- 对悬臂梁使用标准的固支-自由边界条件：在 $x=0$（固支端），$w(0,t)=0$ 和 $\\partial w/\\partial x (0,t)=0$；在 $x=L$（自由端），弯矩和剪力消失，即 $E I \\, \\partial^2 w/\\partial x^2 (L,t)=0$ 和 $E I \\, \\partial^3 w/\\partial x^3 (L,t)=0$。\n- 通过将控制方程乘以一个容许的检验函数并根据需要进行分部积分，以避免在试探/检验空间上出现四阶导数，从而推导出弱形式。得到的双线性形式必须分别定义单元刚度矩阵和质量矩阵：\n  - 刚度双线性形式应涉及试探函数和检验函数的二阶空间导数。\n  - 质量双线性形式应涉及试探函数和检验函数本身。\n- 在每个单元上构建一个多项式阶数 $p=4$ 的一维 $C^1$ 谱梁单元。单元近似必须：\n  - 在每个单元端点包含位移和转角（斜率）的节点自由度，以满足 $C^1$ 单元间连续性。\n  - 用一个4阶的内部分层模式（气泡函数）来增强三次埃尔米特节点基。该函数及其一阶导数在单元两端均为零，从而实现一个 $p=4$ 的谱单元。不得先验地假设内部模式的具体公式；它必须从第一性原理出发推导，以满足所述的消失条件。\n- 使用仿射映射，将每个长度为 $\\ell$ 的物理单元映射到参考坐标 $z \\in [0,1]$。使用链式法则，确保所有关于 $x$ 的导数都正确地用关于 $z$ 的导数表示。您的实现必须使用足够阶数的高斯-勒让德求积，对基函数所隐含的最高阶多项式精确地积分单元矩阵。\n- 为 $N_e$ 个单元的均匀网格组装全局质量矩阵和刚度矩阵，并通过消除与 $w(0)$ 和 $\\partial w/\\partial x (0)$ 相关的全局自由度，施加 $x=0$ 处的固支边界条件。\n\n解析参考：\n- 对于均匀的欧拉-伯努利悬臂梁，解析的无量纲波数 $\\alpha_n$ 是超越方程 $\\cosh(\\alpha)\\cos(\\alpha)+1=0$ 的正根，该方程必须通过数值方法求解。精确的角频率为\n$$\n\\omega_n \\;=\\; \\frac{\\alpha_n^2}{L^2}\\,\\sqrt{\\frac{E I}{\\rho A}}.\n$$\n您必须为每个测试案例计算前两个值 $\\omega_1$ 和 $\\omega_2$，单位为弧度/秒。\n\n数值任务：\n- 形成广义、对称、正定的特征值问题\n$$\n\\mathbf{K} \\mathbf{u} \\;=\\; \\lambda\\, \\mathbf{M} \\mathbf{u},\n$$\n其中 $\\lambda = \\omega^2$。计算最小的两个正特征值，将它们转换为角频率 $\\omega$（单位：弧度/秒），并与解析值进行比较。\n\n测试套件和要求输出：\n对于下面的每个参数集，使用如上定义的 $p=4$ 谱单元，并计算数值角频率与解析角频率之间在前两种模式下的绝对相对误差（以小数形式，而非百分比）：\n$$\n\\varepsilon_n \\;=\\; \\frac{\\lvert \\omega_n^{\\text{num}} - \\omega_n^{\\text{exact}} \\rvert}{\\omega_n^{\\text{exact}}}.\n$$\n所有物理答案必须以国际单位制（SI）表示。您的程序输出必须是单行，包含一个扁平的、逗号分隔的列表，内含六个误差值，按案例和模式排序，并用方括号括起，每个数字四舍五入到恰好 $8$ 位小数。\n\n测试案例：\n- 案例 1：$E = 210 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 7800\\,\\mathrm{kg/m^3}$，矩形截面，宽 $b = 0.01\\,\\mathrm{m}$，高 $h = 0.01\\,\\mathrm{m}$，因此 $A = b h$ 且 $I = b h^3 / 12$，梁长 $L = 1.0\\,\\mathrm{m}$，单元数量 $N_e = 1$。\n- 案例 2：与案例 1 相同的材料和截面，但 $L = 1.0\\,\\mathrm{m}$，单元数量 $N_e = 2$。\n- 案例 3：$E = 70 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 2700\\,\\mathrm{kg/m^3}$，矩形截面，宽 $b = 0.02\\,\\mathrm{m}$，高 $h = 0.01\\,\\mathrm{m}$，$A = b h$，$I = b h^3 / 12$，梁长 $L = 2.0\\,\\mathrm{m}$，单元数量 $N_e = 3$。\n\n最终输出格式：\n- 您的程序应精确地产生一行输出，包含列表\n$[\\varepsilon_{1}^{(1)},\\varepsilon_{2}^{(1)},\\varepsilon_{1}^{(2)},\\varepsilon_{2}^{(2)},\\varepsilon_{1}^{(3)},\\varepsilon_{2}^{(3)}]$\n其中每个条目四舍五入到8位小数，并且没有附加文本。", "solution": "所提出的问题是计算结构动力学中的一个标准、适定的问题。它要求实现一种特定的有限元法（FEM）来确定悬臂梁的固有频率，并根据已知的解析解评估其精度。所有给定的条件在科学上都是合理的、一致的，并且足以构建一个唯一的解。因此，该问题是有效的。\n\n解决方案从控制物理原理到数值实现系统地进行。\n\n**1. 控制方程和弱形式**\n\n均匀欧拉-伯努利梁的自由、无阻尼横向振动由以下偏微分方程控制：\n$$\n\\rho A \\frac{\\partial^2 w(x,t)}{\\partial t^2} + E I \\frac{\\partial^4 w(x,t)}{\\partial x^4} = 0\n$$\n其中 $w(x,t)$ 是横向位移，$x$ 是沿梁长 $L$ 的空间坐标，$t$ 是时间，$\\rho$ 是材料密度，$A$ 是横截面积，$E$ 是杨氏模量，$I$ 是截面的面积二次矩。\n\n我们寻找形式为 $w(x,t) = W(x) e^{i \\omega t}$ 的谐波解，其中 $W(x)$ 是振型，$\\omega$ 是角频率。将此代入控制方程，得到关于振型的常微分方程：\n$$\nE I \\frac{d^4 W(x)}{dx^4} - \\rho A \\omega^2 W(x) = 0\n$$\n为了推导弱形式，我们用一个来自合适的容许函数空间的任意检验函数 $v(x)$ 乘以方程，并在梁的长度 $L$ 上积分：\n$$\n\\int_0^L v \\left( E I \\frac{d^4 W}{dx^4} - \\rho A \\omega^2 W \\right) dx = 0\n$$\n容许函数空间是满足本质（狄利克雷）边界条件且足够光滑的函数集合。对于在 $x=0$ 处固支的悬臂梁，这些条件是 $W(0)=0$ 和 $W'(0)=0$。因此，$v(0)=0$ 和 $v'(0)=0$。\n\n将第一项进行两次分部积分，将导数从试探函数 $W(x)$ 转移到检验函数 $v(x)$：\n$$\n\\int_0^L E I \\frac{d^2 v}{dx^2} \\frac{d^2 W}{dx^2} dx - \\left[ v E I \\frac{d^3 W}{dx^3} \\right]_0^L + \\left[ \\frac{dv}{dx} E I \\frac{d^2 W}{dx^2} \\right]_0^L - \\omega^2 \\int_0^L \\rho A v W dx = 0\n$$\n由于检验函数 $v$ 的本质边界条件，在 $x=0$ 处的边界项消失。在自由端 $x=L$ 处的自然边界条件是弯矩和剪力为零，即 $E I W''(L)=0$ 和 $E I W'''(L)=0$。这些条件也导致在 $x=L$ 处的边界项消失。\n\n得到的弱形式为：寻找 $(\\omega^2, W)$，使得对于所有容许的 $v$：\n$$\n\\int_0^L E I v'' W'' dx = \\omega^2 \\int_0^L \\rho A v W dx\n$$\n这定义了一个广义特征值问题，其中刚度双线性形式为 $k(v,W) = \\int_0^L E I v'' W'' dx$，质量双线性形式为 $m(v,W) = \\int_0^L \\rho A v W dx$。\n\n**2. 参考单元上的有限元离散化**\n\n问题指定了一个多项式阶数 $p=4$ 的 $C^1$ 谱单元。这是通过用一个4阶的分层气泡函数来增强标准三次埃尔米特基函数构建的。一个物理长度为 $\\ell_e$ 的单元通过仿射映射 $x(z) = x_1 + \\ell_e z$ 映射到坐标为 $z \\in [0,1]$ 的参考单元，其中 $x_1$ 是物理单元的起始坐标。链式法则给出了导数的关系：$d/dx = (1/\\ell_e) d/dz$ 和 $d^2/dx^2 = (1/\\ell_e^2) d^2/dz^2$。\n\n局部​​位移场 $W^e(z)$ 使用五个基函数进行插值，对应五个自由度（DOF）：起始节点（$z=0$）的位移 $w_1$ 和转角 $\\theta_1$，结束节点（$z=1$）的位移 $w_2$ 和转角 $\\theta_2$，以及一个内部分层系数 $a_1$。\n插值公式为：\n$$\nW^e(z) = \\mathbf{N}(z,\\ell_e) \\mathbf{d}^e = H_1(z)w_1 + \\ell_e H_2(z)\\theta_1 + H_3(z)w_2 + \\ell_e H_4(z)\\theta_2 + H_5(z)a_1\n$$\n其中 $\\mathbf{d}^e = [w_1, \\theta_1, w_2, \\theta_2, a_1]^T$ 是单元自由度向量。基函数为：\n-   **三次埃尔米特基函数 ($p=3$)**：这些函数确保了单元间的 $C^1$ 连续性。\n    $H_1(z) = 2z^3 - 3z^2 + 1$\n    $H_2(z) = z^3 - 2z^2 + z$\n    $H_3(z) = -2z^3 + 3z^2$\n    $H_4(z) = z^3 - z^2$\n-   **四次气泡函数 ($p=4$)**：此函数及其一阶导数在单元节点 ($z=0, 1$) 处为零，确保了基函数的分层性质。\n    $H_5(z) = z^2(1-z)^2 = z^4 - 2z^3 + z^2$\n\n**3. 单元刚度矩阵和质量矩阵**\n\n将有限元近似代入双线性形式，并将积分变量更改为参考坐标 $z$，我们得到单元刚度矩阵 $\\mathbf{K}^e$ 和质量矩阵 $\\mathbf{M}^e$。\n$$\n\\mathbf{K}^e_{ij} = \\int_{x_1}^{x_1+\\ell_e} E I \\frac{d^2 N_i}{dx^2} \\frac{d^2 N_j}{dx^2} dx_e\n\\quad , \\quad\n\\mathbf{M}^e_{ij} = \\int_{x_1}^{x_1+\\ell_e} \\rho A N_i N_j dx_e\n$$\n使用坐标变换，这些可以写成一个包含与单元属性无关的参考矩阵的因式分解形式：\n$$\n\\mathbf{K}^e = \\frac{EI}{\\ell_e^3} \\mathbf{L}_{\\ell_e} \\mathbf{K}_{\\text{ref}} \\mathbf{L}_{\\ell_e}\n\\quad , \\quad\n\\mathbf{M}^e = \\rho A \\ell_e \\mathbf{L}_{\\ell_e} \\mathbf{M}_{\\text{ref}} \\mathbf{L}_{\\ell_e}\n$$\n其中 $\\mathbf{L}_{\\ell_e} = \\text{diag}([1, \\ell_e, 1, \\ell_e, 1])$。参考矩阵通过在 $z \\in [0,1]$ 上积分计算：\n$$\n(\\mathbf{K}_{\\text{ref}})_{ij} = \\int_0^1 H_i''(z) H_j''(z) dz\n\\quad , \\quad\n(\\mathbf{M}_{\\text{ref}})_{ij} = \\int_0^1 H_i(z) H_j(z) dz\n$$\n其中我们将 $H_i$ 定义为不含 $\\ell_e$ 缩放的关于 $z$ 的多项式。$\\mathbf{K}_{\\text{ref}}$ 的被积函数中的最高多项式阶数为 $(4-2)+(4-2)=4$，而 $\\mathbf{M}_{\\text{ref}}$ 的为 $4+4=8$。为了精确积分这些，需要一个至少有 $\\lceil(8+1)/2\\rceil = 5$ 个点的高斯-勒让德求积法则。\n\n**4. 系统组装和边界条件**\n\n全局刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 是通过根据全局自由度编号，对每个单元矩阵 $\\mathbf{K}^e$ 和 $\\mathbf{M}^e$ 的贡献求和来组装的。对于一个包含 $N_e$ 个单元的网格，有 $N_e+1$ 个节点和 $N_e$ 个内部自由度，总计有 $2(N_e+1) + N_e = 3N_e+2$ 个自由度。\n\n通过从 $\\mathbf{K}$ 和 $\\mathbf{M}$ 中删除与前两个全局自由度对应的行和列，施加在 $x=0$ 处的悬臂梁边界条件（$w(0)=0$，$w'(0)=0$）。这会得到简化的非奇异矩阵 $\\mathbf{K}_{\\text{red}}$ 和 $\\mathbf{M}_{\\text{red}}$。\n\n**5. 特征值问题求解**\n\n系统被简化为广义对称特征值问题：\n$$\n\\mathbf{K}_{\\text{red}} \\mathbf{u}_{\\text{red}} = \\lambda \\mathbf{M}_{\\text{red}} \\mathbf{u}_{\\text{red}}\n$$\n其中 $\\lambda = \\omega^2$。该问题通过数值方法求解特征值 $\\lambda_n$。最小的两个正特征值 $\\lambda_1$ 和 $\\lambda_2$ 给出前两个固有角频率的平方：$\\omega_n^{\\text{num}} = \\sqrt{\\lambda_n}$。\n\n**6. 解析解与误差计算**\n\n均匀悬臂梁的精确角频率由下式给出：\n$$\n\\omega_n^{\\text{exact}} = \\frac{\\alpha_n^2}{L^2} \\sqrt{\\frac{E I}{\\rho A}}\n$$\n其中 $\\alpha_n$ 是超越方程 $\\cosh(\\alpha)\\cos(\\alpha)+1=0$ 的正根。这些根必须使用数值求根算法找到。前两个根近似为 $\\alpha_1 \\approx 1.875104$ 和 $\\alpha_2 \\approx 4.694091$。\n\n数值解的精度通过每个模式的绝对相对误差来量化：\n$$\n\\varepsilon_n = \\frac{|\\omega_n^{\\text{num}} - \\omega_n^{\\text{exact}}|}{\\omega_n^{\\text{exact}}}\n$$\n以下程序为指定的测试套件实现了这整个过程。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the cantilever beam vibration problem using a p=4 FEM,\n    compares with the analytical solution, and computes relative errors.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: E, rho, b, h, L, Ne\n        (210e9, 7800.0, 0.01, 0.01, 1.0, 1),\n        # Case 2: Same, but Ne=2\n        (210e9, 7800.0, 0.01, 0.01, 1.0, 2),\n        # Case 3: E, rho, b, h, L, Ne\n        (70e9, 2700.0, 0.02, 0.01, 2.0, 3)\n    ]\n\n    all_errors = []\n    for E, rho, b, h, L, Ne in test_cases:\n        A = b * h\n        I = b * h**3 / 12.0\n        \n        # 1. Analytical Solution\n        def transcendental_eq(alpha):\n            return np.cosh(alpha) * np.cos(alpha) + 1.0\n\n        # Find the first two positive roots\n        sol1 = root_scalar(transcendental_eq, bracket=[1.8, 1.9], method='brentq')\n        alpha1 = sol1.root\n        sol2 = root_scalar(transcendental_eq, bracket=[4.6, 4.7], method='brentq')\n        alpha2 = sol2.root\n        \n        alphas = np.array([alpha1, alpha2])\n        \n        omega_exact = (alphas**2 / L**2) * np.sqrt(E * I / (rho * A))\n\n        # 2. Numerical Solution (FEM)\n        \n        # Reference element properties (p=4 basis) on z in [0,1]\n        # Basis functions: H1, H2, H3, H4 (Hermite), H5 (Bubble)\n        # H1(z) = 2z^3 - 3z^2 + 1\n        # H2(z) = z^3 - 2z^2 + z\n        # H3(z) = -2z^3 + 3z^2\n        # H4(z) = z^3 - z^2\n        # H5(z) = z^4 - 2z^3 + z^2\n        \n        # Second derivatives for stiffness matrix\n        # H1''(z) = 12z - 6\n        # H2''(z) = 6z - 4\n        # H3''(z) = -12z + 6\n        # H4''(z) = 6z - 2\n        # H5''(z) = 12z^2 - 12z + 2\n        \n        def get_basis_functions(z):\n            z2 = z * z\n            z3 = z2 * z\n            z4 = z3 * z\n            H = np.zeros(5)\n            H[0] = 2.0*z3 - 3.0*z2 + 1.0\n            H[1] = z3 - 2.0*z2 + z\n            H[2] = -2.0*z3 + 3.0*z2\n            H[3] = z3 - z2\n            H[4] = z4 - 2.0*z3 + z2\n            return H\n\n        def get_basis_second_derivatives(z):\n            z2 = z * z\n            H_dd = np.zeros(5)\n            H_dd[0] = 12.0*z - 6.0\n            H_dd[1] = 6.0*z - 4.0\n            H_dd[2] = -12.0*z + 6.0\n            H_dd[3] = 6.0*z - 2.0\n            H_dd[4] = 12.0*z2 - 12.0*z + 2.0\n            return H_dd\n\n        # 5-point Gauss-Legendre quadrature on [0, 1]\n        z_gl = np.array([0.046910077, 0.230765345, 0.5, 0.769234655, 0.953089922])\n        w_gl = np.array([0.118463442, 0.239314335, 0.284444444, 0.239314335, 0.118463442])\n\n        # Compute reference stiffness and mass matrices\n        K_ref = np.zeros((5, 5))\n        M_ref = np.zeros((5, 5))\n        for i in range(len(z_gl)):\n            z = z_gl[i]\n            w = w_gl[i]\n            H = get_basis_functions(z)\n            H_dd = get_basis_second_derivatives(z)\n            K_ref += w * np.outer(H_dd, H_dd)\n            M_ref += w * np.outer(H, H)\n\n        # Assemble global matrices\n        n_nodes = Ne + 1\n        n_dof_nodal = 2 * n_nodes\n        n_dof_internal = Ne\n        n_dof_total = n_dof_nodal + n_dof_internal\n        \n        K_global = np.zeros((n_dof_total, n_dof_total))\n        M_global = np.zeros((n_dof_total, n_dof_total))\n        \n        ell = L / Ne\n        L_mat = np.diag([1.0, ell, 1.0, ell, 1.0])\n\n        K_elem = (E * I / ell**3) * (L_mat @ K_ref @ L_mat)\n        M_elem = (rho * A * ell) * (L_mat @ M_ref @ L_mat)\n\n        for e in range(Ne):\n            # Global indices for DOFs of element e\n            # Nodal DOFs for node e (w, theta) and e+1 (w, theta)\n            # Internal DOF for element e\n            g_idx = np.array([\n                2 * e, 2 * e + 1,        # Node e\n                2 * (e + 1), 2 * (e + 1) + 1,  # Node e+1\n                n_dof_nodal + e          # Internal DOF for element e\n            ])\n            \n            K_global[np.ix_(g_idx, g_idx)] += K_elem\n            M_global[np.ix_(g_idx, g_idx)] += M_elem\n            \n        # Apply clamped boundary conditions at x=0 (node 0)\n        # w(0) = 0, w'(0) = 0 correspond to DOFs 0 and 1\n        free_dofs = np.arange(2, n_dof_total)\n        K_red = K_global[np.ix_(free_dofs, free_dofs)]\n        M_red = M_global[np.ix_(free_dofs, free_dofs)]\n        \n        # Solve the generalized eigenvalue problem\n        # K_red * u = lambda * M_red * u\n        eigenvalues, _ = eigh(K_red, M_red)\n        \n        # Eigenvalues are lambda = omega^2. Take the first two.\n        omega_num = np.sqrt(eigenvalues[:2])\n        \n        # 3. Calculate Relative Error\n        errors = np.abs(omega_num - omega_exact) / omega_exact\n        all_errors.extend(errors)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join([f'{err:.8f}' for err in all_errors])}]\")\n\nsolve()\n```", "id": "2562466"}]}