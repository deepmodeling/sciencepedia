{"hands_on_practices": [{"introduction": "要掌握谐响应分析，最有效的方法莫过于从一个基础问题入手，完整地走一遍分析流程。本练习提供了一个简单的双自由度系统，旨在引导您从头开始，通过模态叠加法进行强迫振动分析。通过逐步求解这个问题，您将练习从建立特征值问题、计算模态参数，到最终求解系统在谐波激励下的稳态响应的全过程，为理解更复杂的系统打下坚实的基础 [@problem_id:2563527]。", "problem": "一个通过有限元法 (FEM) 得到的两自由度有限元模型由组装的质量矩阵 $M \\in \\mathbb{R}^{2 \\times 2}$ 和刚度矩阵 $K \\in \\mathbb{R}^{2 \\times 2}$ 描述，\n$$\nM = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\ \\text{kg}, \n\\qquad\nK = \\begin{pmatrix} 6000  -2000 \\\\ -2000  4000 \\end{pmatrix} \\ \\text{N/m}.\n$$\n假设存在比例 (瑞利) 阻尼 $C = \\alpha M + \\beta K$，其中 $\\alpha = 0.5 \\ \\text{s}^{-1}$ 且 $\\beta = 1.0 \\times 10^{-4} \\ \\text{s}$。节点力是简谐的，\n$$\nf(t) = \\Re\\!\\left\\{ \\hat{F} \\exp(\\mathrm{i} \\omega t) \\right\\}, \n\\qquad \n\\hat{F} = \\begin{pmatrix} 10 \\\\ 0 \\end{pmatrix} \\ \\text{N}, \n\\qquad \n\\omega = 60 \\ \\text{rad/s}.\n$$\n仅从牛顿第二定律和有限元法的离散动力学平衡定义出发，且不预先假设任何模态关系，完成以下任务：\n\n1) 通过寻找可分离的简谐解，从无阻尼、无外力的运动方程中严格推导出有限维自由振动特征问题，并用物理量定义特征值和特征向量。\n\n2) 对于给定的 $M$ 和 $K$，明确计算前两个特征对 $(\\lambda_i, \\phi_i)$，其中 $\\lambda_i = \\omega_i^2$，$\\omega_i$ 是固有圆频率，并按 $\\lambda_i$ 的升序排列。\n\n3) 使用质量内积对特征向量进行归一化，使得对每个 $i$ 都有 $\\phi_i^{\\mathsf{T}} M \\phi_i = 1$，并给出质量归一化的振型。\n\n4) 验证正交关系 $\\Phi^{\\mathsf{T}} M \\Phi = I$ 和 $\\Phi^{\\mathsf{T}} K \\Phi = \\mathrm{diag}(\\lambda_1,\\lambda_2)$，其中 $\\Phi = [\\phi_1 \\ \\phi_2]$ 是由质量归一化振型组成的矩阵。\n\n5) 使用质量归一化的模态基和瑞利阻尼，从第一性原理推导简谐激励下的解耦模态方程，求得复稳态响应幅值 $\\hat{X}(\\omega)$，并计算在 $\\omega = 60 \\ \\text{rad/s}$ 时第二自由度上稳态位移的幅值。\n\n将最终所求的幅值以毫米表示，并将您的答案四舍五入到四位有效数字。仅提供所要求的单个数值。", "solution": "问题陈述需要经过验证。\n\n**第 1 步：提取已知条件**\n- 质量矩阵: $M = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\ \\text{kg}$\n- 刚度矩阵: $K = \\begin{pmatrix} 6000  -2000 \\\\ -2000  4000 \\end{pmatrix} \\ \\text{N/m}$\n- 瑞利阻尼参数: $\\alpha = 0.5 \\ \\text{s}^{-1}$, $\\beta = 1.0 \\times 10^{-4} \\ \\text{s}$\n- 阻尼矩阵: $C = \\alpha M + \\beta K$\n- 简谐力向量: $f(t) = \\Re\\!\\left\\{ \\hat{F} \\exp(\\mathrm{i} \\omega t) \\right\\}$\n- 力幅值向量: $\\hat{F} = \\begin{pmatrix} 10 \\\\ 0 \\end{pmatrix} \\ \\text{N}$\n- 激振频率: $\\omega = 60 \\ \\text{rad/s}$\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是线性结构动力学中的一个标准练习，具体是使用模态分析法对多自由度系统进行简谐响应分析。质量矩阵 $M$ 是对称正定的（特征值为 2 和 1）。刚度矩阵 $K$ 是对称的，其行列式为 $\\det(K) = (6000)(4000) - (-2000)^2 = 2 \\times 10^7 > 0$，其迹为 $10000 > 0$，因此 $K$ 也是正定的。该系统是物理上稳定的。\n- **适定性**：该问题是适定的。所有必要的数据和条件都已提供，可以找到唯一的稳态响应。\n- **客观性**：该问题使用精确、定量的语言陈述，不含主观因素。\n\n**第 3 步：结论与行动**\n该问题有科学依据、适定、客观且完整。因此，它被认为是**有效的**。现在将按要求从第一性原理推导解答。\n\n离散有限元系统的动力学平衡由牛顿第二定律给出：\n$$M \\ddot{x}(t) + C \\dot{x}(t) + K x(t) = f(t)$$\n其中 $x(t) \\in \\mathbb{R}^n$ 是节点位移向量，$M$、$C$、$K$ 分别是质量、阻尼和刚度矩阵。\n\n1) 自由振动特征问题的推导\n对于无阻尼 ($C=0$) 和自由 ($f(t)=0$) 振动，运动方程简化为：\n$$M \\ddot{x}(t) + K x(t) = 0$$\n我们寻找形式为 $x(t) = \\phi \\cos(\\omega_n t + \\psi)$ 的可分离简谐解，或者更方便地使用复数形式 $x(t) = \\phi \\exp(\\mathrm{i} \\omega_n t)$，其中 $\\phi$ 是表示振型的常数向量，$\\omega_n$ 是固有圆频率。其二阶时间导数为 $\\ddot{x}(t) = -\\omega_n^2 \\phi \\exp(\\mathrm{i} \\omega_n t)$。代入运动方程：\n$$M(-\\omega_n^2 \\phi \\exp(\\mathrm{i} \\omega_n t)) + K(\\phi \\exp(\\mathrm{i} \\omega_n t)) = 0$$\n提出非零项 $\\exp(\\mathrm{i} \\omega_n t)$ 后，我们得到：\n$$(K - \\omega_n^2 M) \\phi = 0$$\n令 $\\lambda = \\omega_n^2$，我们得到广义特征值问题：\n$$K \\phi = \\lambda M \\phi$$\n此处，特征值 $\\lambda$ 是固有圆频率的平方，对应的非平凡特征向量 $\\phi$ 是振动振型。\n\n2) 特征对的计算\n对于给定的矩阵，我们求解 $\\det(K - \\lambda M) = 0$。\n$$K - \\lambda M = \\begin{pmatrix} 6000  -2000 \\\\ -2000  4000 \\end{pmatrix} - \\lambda \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 6000 - 2\\lambda  -2000 \\\\ -2000  4000 - \\lambda \\end{pmatrix}$$\n特征方程为：\n$$(6000 - 2\\lambda)(4000 - \\lambda) - (-2000)^2 = 0$$\n$$24 \\times 10^6 - 6000\\lambda - 8000\\lambda + 2\\lambda^2 - 4 \\times 10^6 = 0$$\n$$2\\lambda^2 - 14000\\lambda + 20 \\times 10^6 = 0$$\n$$\\lambda^2 - 7000\\lambda + 10 \\times 10^6 = 0$$\n解此二次方程得到特征值：\n$$\\lambda = \\frac{7000 \\pm \\sqrt{7000^2 - 4(10 \\times 10^6)}}{2} = \\frac{7000 \\pm \\sqrt{49 \\times 10^6 - 40 \\times 10^6}}{2} = \\frac{7000 \\pm 3000}{2}$$\n按升序排列的特征值为：\n$\\lambda_1 = \\frac{4000}{2} = 2000$\n$\\lambda_2 = \\frac{10000}{2} = 5000$\n\n现在，我们求解相应的特征向量。\n对于 $\\lambda_1 = 2000$：$(K - 2000 M)\\phi_1 = 0$\n$$\\begin{pmatrix} 6000 - 4000  -2000 \\\\ -2000  4000 - 2000 \\end{pmatrix} \\begin{pmatrix} \\phi_{11} \\\\ \\phi_{12} \\end{pmatrix} = \\begin{pmatrix} 2000  -2000 \\\\ -2000  2000 \\end{pmatrix} \\begin{pmatrix} \\phi_{11} \\\\ \\phi_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n这得到 $2000\\phi_{11} - 2000\\phi_{12} = 0$，所以 $\\phi_{11} = \\phi_{12}$。一个未归一化的特征向量是 $\\tilde{\\phi}_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n对于 $\\lambda_2 = 5000$：$(K - 5000 M)\\phi_2 = 0$\n$$\\begin{pmatrix} 6000 - 10000  -2000 \\\\ -2000  4000 - 5000 \\end{pmatrix} \\begin{pmatrix} \\phi_{21} \\\\ \\phi_{22} \\end{pmatrix} = \\begin{pmatrix} -4000  -2000 \\\\ -2000  -1000 \\end{pmatrix} \\begin{pmatrix} \\phi_{21} \\\\ \\phi_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n这得到 $-2000\\phi_{21} - 1000\\phi_{22} = 0$，所以 $\\phi_{22} = -2\\phi_{21}$。一个未归一化的特征向量是 $\\tilde{\\phi}_2 = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。\n\n特征对为 $(\\lambda_1, \\tilde{\\phi}_1) = (2000, \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix})$ 和 $(\\lambda_2, \\tilde{\\phi}_2) = (5000, \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix})$。\n\n3) 特征向量的质量归一化\n归一化条件是 $\\phi_i^{\\mathsf{T}} M \\phi_i = 1$。令 $\\phi_i = c_i \\tilde{\\phi}_i$。那么 $c_i = (\\tilde{\\phi}_i^{\\mathsf{T}} M \\tilde{\\phi}_i)^{-1/2}$。\n对于 $\\lambda_1$:\n$\\tilde{\\phi}_1^{\\mathsf{T}} M \\tilde{\\phi}_1 = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 2+1=3$。所以，$c_1 = 1/\\sqrt{3}$。\n$\\phi_1 = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n对于 $\\lambda_2$:\n$\\tilde{\\phi}_2^{\\mathsf{T}} M \\tilde{\\phi}_2 = \\begin{pmatrix} 1  -2 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = 2+4=6$。所以，$c_2 = 1/\\sqrt{6}$。\n$\\phi_2 = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。\n质量归一化的振型为 $\\phi_1 = \\begin{pmatrix} 1/\\sqrt{3} \\\\ 1/\\sqrt{3} \\end{pmatrix}$ 和 $\\phi_2 = \\begin{pmatrix} 1/\\sqrt{6} \\\\ -2/\\sqrt{6} \\end{pmatrix}$。\n\n4) 正交关系的验证\n模态矩阵为 $\\Phi = [\\phi_1 \\ \\phi_2] = \\begin{pmatrix} 1/\\sqrt{3}  1/\\sqrt{6} \\\\ 1/\\sqrt{3}  -2/\\sqrt{6} \\end{pmatrix}$。\n验证模态质量矩阵：\n$$\\Phi^{\\mathsf{T}} M \\Phi = \\begin{pmatrix} 1/\\sqrt{3}  1/\\sqrt{3} \\\\ 1/\\sqrt{6}  -2/\\sqrt{6} \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{3}  1/\\sqrt{6} \\\\ 1/\\sqrt{3}  -2/\\sqrt{6} \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{3}  1/\\sqrt{3} \\\\ 1/\\sqrt{6}  -2/\\sqrt{6} \\end{pmatrix} \\begin{pmatrix} 2/\\sqrt{3}  2/\\sqrt{6} \\\\ 1/\\sqrt{3}  -2/\\sqrt{6} \\end{pmatrix}$$\n$$= \\begin{pmatrix} \\frac{2}{3}+\\frac{1}{3}  \\frac{2}{\\sqrt{18}}-\\frac{2}{\\sqrt{18}} \\\\ \\frac{2}{\\sqrt{18}}-\\frac{2}{\\sqrt{18}}  \\frac{2}{6}+\\frac{4}{6} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$$\n验证模态刚度矩阵：\n从 $K\\phi_i = \\lambda_i M\\phi_i$ 可知，我们有 $\\Phi^{\\mathsf{T}} K \\Phi = \\Phi^{\\mathsf{T}} M \\Phi \\Lambda = I \\Lambda = \\Lambda$。我们通过直接计算来验证。\n$$\\Phi^{\\mathsf{T}} K \\Phi = \\begin{pmatrix} 1/\\sqrt{3}  1/\\sqrt{3} \\\\ 1/\\sqrt{6}  -2/\\sqrt{6} \\end{pmatrix} \\begin{pmatrix} 6000  -2000 \\\\ -2000  4000 \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{3}  1/\\sqrt{6} \\\\ 1/\\sqrt{3}  -2/\\sqrt{6} \\end{pmatrix}$$\n$$= \\begin{pmatrix} 1/\\sqrt{3}  1/\\sqrt{3} \\\\ 1/\\sqrt{6}  -2/\\sqrt{6} \\end{pmatrix} \\begin{pmatrix} 4000/\\sqrt{3}  10000/\\sqrt{6} \\\\ 2000/\\sqrt{3}  -10000/\\sqrt{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{6000}{3}  0 \\\\ 0  \\frac{30000}{6} \\end{pmatrix} = \\begin{pmatrix} 2000  0 \\\\ 0  5000 \\end{pmatrix} = \\mathrm{diag}(\\lambda_1, \\lambda_2)$$\n正交关系已验证。\n\n5) 简谐响应分析\n完整的运动方程为 $M \\ddot{x}(t) + C \\dot{x}(t) + K x(t) = f(t)$。我们使用模态坐标变换 $x(t) = \\Phi q(t)$。代入并左乘 $\\Phi^{\\mathsf{T}}$ 得到：\n$$\\Phi^{\\mathsf{T}} M \\Phi \\ddot{q}(t) + \\Phi^{\\mathsf{T}} C \\Phi \\dot{q}(t) + \\Phi^{\\mathsf{T}} K \\Phi q(t) = \\Phi^{\\mathsf{T}} f(t)$$\n使用正交关系和瑞利阻尼的形式 $C = \\alpha M + \\beta K$，模态阻尼矩阵为：\n$$\\Phi^{\\mathsf{T}} C \\Phi = \\alpha (\\Phi^{\\mathsf{T}} M \\Phi) + \\beta (\\Phi^{\\mathsf{T}} K \\Phi) = \\alpha I + \\beta \\Lambda = \\mathrm{diag}(\\alpha + \\beta \\lambda_i)$$\n该方程组解耦为一组独立的模态方程：\n$$\\ddot{q}_i(t) + (\\alpha + \\beta \\lambda_i) \\dot{q}_i(t) + \\lambda_i q_i(t) = F_i(t)$$\n其中 $F_i(t) = \\phi_i^{\\mathsf{T}} f(t)$ 是模态力。对于简谐力 $f(t) = \\Re\\{ \\hat{F} \\exp(\\mathrm{i} \\omega t) \\}$，我们寻求稳态解 $q_i(t) = \\Re\\{ \\hat{Q}_i \\exp(\\mathrm{i} \\omega t) \\}$。代入得到：\n$$(-\\omega^2 + \\mathrm{i}\\omega(\\alpha+\\beta\\lambda_i) + \\lambda_i) \\hat{Q}_i = \\phi_i^{\\mathsf{T}} \\hat{F}$$\n$$\\hat{Q}_i = \\frac{\\phi_i^{\\mathsf{T}} \\hat{F}}{\\lambda_i - \\omega^2 + \\mathrm{i}\\omega(\\alpha+\\beta\\lambda_i)}$$\n复位移幅值为 $\\hat{X} = \\Phi \\hat{Q} = \\sum_{i=1}^{2} \\phi_i \\hat{Q}_i$。我们需要计算第二个分量的幅值 $|\\hat{X}_2|$。\n$\\hat{X}_2 = \\phi_{12} \\hat{Q}_1 + \\phi_{22} \\hat{Q}_2$。\n\n数值计算：\n$\\omega = 60 \\ \\text{rad/s}$，所以 $\\omega^2 = 3600$。\n$\\hat{F} = \\begin{pmatrix} 10 \\\\ 0 \\end{pmatrix}$。\n模态力：\n$\\phi_1^{\\mathsf{T}} \\hat{F} = (1/\\sqrt{3})(1)(10) = 10/\\sqrt{3}$。\n$\\phi_2^{\\mathsf{T}} \\hat{F} = (1/\\sqrt{6})(1)(10) = 10/\\sqrt{6}$。\n\n复模态幅值：\n对于 $i=1$：$\\lambda_1=2000$。分母 $D_1 = 2000 - 3600 + \\mathrm{i}(60)(0.5 + 10^{-4}(2000)) = -1600 + \\mathrm{i}(60)(0.7) = -1600 + 42\\mathrm{i}$。\n$\\hat{Q}_1 = \\frac{10/\\sqrt{3}}{-1600 + 42\\mathrm{i}}$。\n对于 $i=2$：$\\lambda_2=5000$。分母 $D_2 = 5000 - 3600 + \\mathrm{i}(60)(0.5 + 10^{-4}(5000)) = 1400 + \\mathrm{i}(60)(1.0) = 1400 + 60\\mathrm{i}$。\n$\\hat{Q}_2 = \\frac{10/\\sqrt{6}}{1400 + 60\\mathrm{i}}$。\n\n第二自由度的复幅值：\n$\\phi_{12} = 1/\\sqrt{3}$，$\\phi_{22} = -2/\\sqrt{6}$。\n$$\\hat{X}_2 = \\left(\\frac{1}{\\sqrt{3}}\\right) \\left(\\frac{10/\\sqrt{3}}{-1600 + 42\\mathrm{i}}\\right) + \\left(\\frac{-2}{\\sqrt{6}}\\right) \\left(\\frac{10/\\sqrt{6}}{1400 + 60\\mathrm{i}}\\right)$$\n$$\\hat{X}_2 = \\frac{10}{3(-1600 + 42\\mathrm{i})} - \\frac{20}{6(1400 + 60\\mathrm{i})} = \\frac{10}{3} \\left[ \\frac{1}{-1600 + 42\\mathrm{i}} - \\frac{1}{1400 + 60\\mathrm{i}} \\right]$$\n$$\\hat{X}_2 = \\frac{10}{3} \\left[ \\frac{(1400 + 60\\mathrm{i}) - (-1600 + 42\\mathrm{i})}{(-1600 + 42\\mathrm{i})(1400 + 60\\mathrm{i})} \\right] = \\frac{10}{3} \\left[ \\frac{3000 + 18\\mathrm{i}}{-2242520 - 37200\\mathrm{i}} \\right]$$\n幅值为 $|\\hat{X}_2| = \\frac{10}{3} \\frac{|3000+18\\mathrm{i}|}{|-2242520-37200\\mathrm{i}|}$。\n$|3000+18\\mathrm{i}| = \\sqrt{3000^2 + 18^2} = \\sqrt{9000324}$。\n$|-2242520-37200\\mathrm{i}| = \\sqrt{(-2242520)^2 + (-37200)^2} = \\sqrt{5028896040000 + 1383840000} = \\sqrt{5030279880000}$。\n$$|\\hat{X}_2| = \\frac{10}{3} \\sqrt{\\frac{9000324}{5030279880000}} \\approx \\frac{10}{3} \\sqrt{1.78923 \\times 10^{-6}} \\approx \\frac{10}{3} (1.33762 \\times 10^{-3})$$\n$$|\\hat{X}_2| \\approx 0.00445873 \\ \\text{m}$$\n该位移的单位是米。要转换为毫米，需乘以 1000：\n$$|\\hat{X}_2| \\approx 4.45873 \\ \\text{mm}$$\n四舍五入到四位有效数字，得到 $4.459 \\ \\text{mm}$。", "answer": "$$\n\\boxed{4.459}\n$$", "id": "2563527"}, {"introduction": "在谐响应分析中，除了众所周知的共振（即频率响应函数的极点）之外，还存在一种同样重要的现象——反共振（即频率响应函数的零点）。本练习将深入探讨反共振，即在激励点施加谐波力，而该点的位移响应却为零的特定频率条件。您将通过分析一个双自由度无阻尼系统，推导其驱动点频率响应函数 $H_{11}(\\omega)$，并从模态贡献的相消干涉以及动力刚度矩阵的代数结构两个角度，来定位和理解反共振频率 [@problem_id:2563508]。", "problem": "一个两自由度 (DOF) 线性力学系统由两个轴向弹簧单元和集总质量通过有限元法 (FEM) 组装而成。集总质量矩阵为 $M \\in \\mathbb{R}^{2 \\times 2}$，其中 $M = \\mathrm{diag}(1,1)\\,\\mathrm{kg}$，组装后的刚度矩阵为\n$$\nK \\, [\\mathrm{N/m}] \\;=\\; \\begin{bmatrix} 4  -1 \\\\ -1  6 \\end{bmatrix},\n$$\n这对应于在自由度 1 处刚度为 $k_1 = 3\\,\\mathrm{N/m}$ 和在自由度 2 处刚度为 $k_3 = 5\\,\\mathrm{N/m}$ 的接地弹簧，它们通过一个刚度为 $k_2 = 1\\,\\mathrm{N/m}$ 的连接弹簧耦合。该系统是无阻尼的，因此 $C = 0$。在自由度 1 上施加一个单位振幅的简谐点力 $f_1(t) = \\Re\\{\\hat{f}_1 \\exp(\\mathrm{i}\\,\\omega t)\\}$，其中 $\\hat{f}_1 = 1\\,\\mathrm{N}$；自由度 2 不受力。令 $\\hat{x}(\\omega) \\in \\mathbb{C}^2$ 表示复位移向量。定义频率响应函数 (FRF) 矩阵 $H(\\omega)$ 为 $\\hat{x}(\\omega) = H(\\omega)\\,\\hat{f}$，其中 $\\hat{f} = [1\\;\\;0]^{\\mathsf{T}}\\,\\mathrm{N}$ 且 $H(\\omega) = \\left(K - \\omega^2 M\\right)^{-1}$ (位移导纳)。用 $H_{11}(\\omega)$ 表示从自由度 1 的力到自由度 1 的位移的位移导纳。\n\n仅从牛顿第二定律和有限元组装原理出发，在频域中使用复相量进行分析：\n- 根据动态刚度矩阵 $\\left(K - \\omega^2 M\\right)$ 推导出 $H_{11}(\\omega)$。\n- 使用满足 $\\Phi^{\\mathsf{T}} M \\Phi = I$ 和 $\\Phi^{\\mathsf{T}} K \\Phi = \\Omega^2 = \\mathrm{diag}(\\omega_1^2,\\omega_2^2)$ 的质量归一化特征向量 $\\Phi$ 建立无阻尼模态分解。用模态留数和参与因子表示 $H_{11}(\\omega)$，为该系统明确地识别这些量，并使用该表示法来解析地定位所有有限反共振频率 (即，实数 $\\omega > 0$ 使得 $H_{11}(\\omega) = 0$)。\n- 从模态贡献的相消干涉和动态刚度的余子式（代数余子式）的角度解释反共振条件。\n\n将反共振频率报告为单个实数或闭式解析表达式。以弧度/秒为单位表示最终频率。无需四舍五入；报告精确值。", "solution": "出发点是组装好的有限元模型的牛顿第二定律，\n$$\nM\\,\\ddot{x}(t) + C\\,\\dot{x}(t) + K\\,x(t) \\;=\\; f(t),\n$$\n对于当前的无阻尼系统，$C=0$。在自由度 1 上施加简谐点力 $f(t) = \\Re\\{\\hat{f}\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$，其中 $\\hat{f} = [1\\;\\;0]^{\\mathsf{T}}$，并设简谐解的形式为 $x(t) = \\Re\\{\\hat{x}(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$，代入后得到频域平衡方程\n$$\n\\bigl(K - \\omega^2 M\\bigr)\\,\\hat{x}(\\omega) \\;=\\; \\hat{f}.\n$$\n因此，频率响应函数 (FRF) 矩阵 (位移导纳) 为\n$$\nH(\\omega) \\;=\\; \\bigl(K - \\omega^2 M\\bigr)^{-1},\n$$\n我们关心的标量 FRF 是 $H(\\omega)$ 的 $(1,1)$ 项 $H_{11}(\\omega)$。对于给定的 $M$ 和 $K$，\n$$\nK - \\omega^2 M \\;=\\; \\begin{bmatrix} 4 - \\omega^2  -1 \\\\ -1  6 - \\omega^2 \\end{bmatrix}.\n$$\n对于一个 $2\\times 2$ 的对称矩阵 $A(\\omega) = \\begin{bmatrix} a(\\omega)  b \\\\ b  d(\\omega)\\end{bmatrix}$，其中 $b=-1$，其逆矩阵为\n$$\nA(\\omega)^{-1} \\;=\\; \\frac{1}{\\Delta(\\omega)}\\begin{bmatrix} d(\\omega)  -b \\\\ -b  a(\\omega)\\end{bmatrix}, \\qquad \\Delta(\\omega) \\;=\\; a(\\omega)\\,d(\\omega) - b^2.\n$$\n因此，\n$$\nH_{11}(\\omega) \\;=\\; \\frac{6 - \\omega^2}{\\bigl(4 - \\omega^2\\bigr)\\bigl(6 - \\omega^2\\bigr) - 1}.\n$$\n任何有限反共振频率都是一个实数 $\\omega>0$，使得 $H_{11}(\\omega) = 0$，即分子为零而分母不为零。这给出了解析条件\n$$\n6 - \\omega^2 \\;=\\; 0 \\;\\;\\Longrightarrow\\;\\; \\omega^2 \\;=\\; 6, \\quad \\omega \\;=\\; \\sqrt{6}.\n$$\n为了通过模态留数和参与因子来解释和确认这个反共振，我们构建无阻尼模态分解。求解广义特征值问题\n$$\nK\\,\\phi_r \\;=\\; \\omega_r^2\\,M\\,\\phi_r,\\quad r=1,2,\n$$\n其中 $M = I$。特征值是以下方程的根\n$$\n\\det\\!\\left(K - \\lambda I\\right) \\;=\\; \\det\\!\\begin{bmatrix} 4 - \\lambda  -1 \\\\ -1  6 - \\lambda \\end{bmatrix} \\;=\\; (4-\\lambda)(6-\\lambda) - 1 \\;=\\; \\lambda^2 - 10\\lambda + 23 \\;=\\; 0.\n$$\n因此\n$$\n\\omega_1^2 \\;=\\; 5 - \\sqrt{2}, \\qquad \\omega_2^2 \\;=\\; 5 + \\sqrt{2}.\n$$\n对应于 $\\omega_1^2$ 的一个（未归一化的）特征向量满足\n$$\n\\begin{bmatrix} 4 - (5 - \\sqrt{2})  -1 \\\\ -1  6 - (5 - \\sqrt{2}) \\end{bmatrix} \\begin{bmatrix} x \\\\ y \\end{bmatrix} \\;=\\; \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n\\;\\;\\Longrightarrow\\;\\; y \\;=\\; (\\sqrt{2}-1)\\,x,\n$$\n所以我们可以取 $\\phi_1 \\propto \\begin{bmatrix} 1 \\\\ \\sqrt{2}-1 \\end{bmatrix}$。对于 $\\omega_2^2$，\n$$\n\\begin{bmatrix} 4 - (5 + \\sqrt{2})  -1 \\\\ -1  6 - (5 + \\sqrt{2}) \\end{bmatrix} \\begin{bmatrix} x \\\\ y \\end{bmatrix} \\;=\\; \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n\\;\\;\\Longrightarrow\\;\\; y \\;=\\; -\\,(1+\\sqrt{2})\\,x,\n$$\n所以我们可以取 $\\phi_2 \\propto \\begin{bmatrix} 1 \\\\ -(1+\\sqrt{2}) \\end{bmatrix}$。当 $M=I$ 时，质量归一化要求 $\\phi_r^{\\mathsf{T}} \\phi_r = 1$。上述方向向量的欧几里得范数的平方为\n$$\n\\|\\phi_1\\|^2 \\;=\\; 1 + (\\sqrt{2}-1)^2 \\;=\\; 4 - 2\\sqrt{2}, \\qquad\n\\|\\phi_2\\|^2 \\;=\\; 1 + (1+\\sqrt{2})^2 \\;=\\; 4 + 2\\sqrt{2}.\n$$\n因此，质量归一化的模态向量为\n$$\n\\phi_1 \\;=\\; \\frac{1}{\\sqrt{4 - 2\\sqrt{2}}}\\begin{bmatrix} 1 \\\\ \\sqrt{2}-1 \\end{bmatrix}, \n\\qquad\n\\phi_2 \\;=\\; \\frac{1}{\\sqrt{4 + 2\\sqrt{2}}}\\begin{bmatrix} 1 \\\\ -(1+\\sqrt{2}) \\end{bmatrix}.\n$$\n令 $b = [1\\;\\;0]^{\\mathsf{T}}$ 表示输入分布（在自由度 1 上的单位点载荷）。在模态坐标 $q$ 中，有 $x = \\Phi q$，无阻尼解耦方程为\n$$\n\\ddot{q}_r + \\omega_r^2 q_r \\;=\\; \\phi_r^{\\mathsf{T}} b,\n$$\n所以对于这个输入，模态参与因子是\n$$\np_r \\;=\\; \\phi_r^{\\mathsf{T}} b \\;=\\; \\phi_{1r}, \\quad r = 1,2.\n$$\n位移导纳项 $H_{11}(\\omega)$ 于是可以进行标准的留数展开\n$$\nH_{11}(\\omega) \\;=\\; \\sum_{r=1}^{2} \\frac{\\phi_{1r}\\,p_r}{\\omega_r^2 - \\omega^2}\n\\;=\\; \\sum_{r=1}^{2} \\frac{\\phi_{1r}^2}{\\omega_r^2 - \\omega^2}.\n$$\n定义模态留数 $R_r = \\phi_{1r} p_r = \\phi_{1r}^2$。反共振条件 $H_{11}(\\omega_a) = 0$ 变为\n$$\n\\frac{R_1}{\\omega_1^2 - \\omega_a^2} + \\frac{R_2}{\\omega_2^2 - \\omega_a^2} \\;=\\; 0,\n$$\n解得\n$$\n\\omega_a^2 \\;=\\; \\frac{R_1\\,\\omega_2^2 + R_2\\,\\omega_1^2}{R_1 + R_2}.\n$$\n对于 $M=I$ 和质量归一化的模态，完备性意味着 $\\sum_{r} \\phi_r \\phi_r^{\\mathsf{T}} = I$，因此 $R_1 + R_2 = \\phi_{11}^2 + \\phi_{21}^2 = 1$。使用上述归一化的第一分量，\n$$\nR_1 \\;=\\; \\frac{1}{4 - 2\\sqrt{2}}, \\qquad R_2 \\;=\\; \\frac{1}{4 + 2\\sqrt{2}},\n$$\n并且 $\\omega_1^2 = 5 - \\sqrt{2}$，$\\omega_2^2 = 5 + \\sqrt{2}$。因此\n$$\n\\omega_a^2 \\;=\\; R_1\\,\\omega_2^2 + R_2\\,\\omega_1^2 \n\\;=\\; \\frac{5 + \\sqrt{2}}{4 - 2\\sqrt{2}} + \\frac{5 - \\sqrt{2}}{4 + 2\\sqrt{2}}\n\\;=\\; \\frac{(5+\\sqrt{2})(4+2\\sqrt{2}) + (5-\\sqrt{2})(4-2\\sqrt{2})}{(4-2\\sqrt{2})(4+2\\sqrt{2})}.\n$$\n分子可简化为\n$$\n(5+\\sqrt{2})(4+2\\sqrt{2}) + (5-\\sqrt{2})(4-2\\sqrt{2})\n= \\bigl(20 + 14\\sqrt{2} + 2(\\sqrt{2})^2\\bigr) + \\bigl(20 - 14\\sqrt{2} + 2(\\sqrt{2})^2\\bigr)\n= 40 + 4\\cdot 2\n= 48,\n$$\n分母为 $(4-2\\sqrt{2})(4+2\\sqrt{2}) = 16-8 = 8$。因此 $\\omega_a^2 = 48/8 = 6$，所以 $\\omega_a = \\sqrt{6}$。\n\n物理和代数解释：\n- 模态干涉：$H_{11}(\\omega) = \\sum_r R_r/(\\omega_r^2 - \\omega^2)$ 表明，在 $\\omega = \\omega_a$ 处，两个模态的贡献完全抵消，因为在区间 $\\omega \\in (\\omega_1, \\omega_2)$ 内，两个分式 $(\\omega_1^2-\\omega^2)$ 和 $(\\omega_2^2-\\omega^2)$ 符号相反，它们以留数 $R_r = \\phi_{1r}^2$ 加权，从而在自由度 1 处产生相消干涉。\n- 代数余子式（余子式）观点：对于一个 $2\\times 2$ 的对称动态刚度矩阵 $A(\\omega)$，$H_{11}(\\omega) = A_{22}(\\omega)/\\det A(\\omega)$。因此反共振满足 $A_{22}(\\omega) = 0$，即，\n$$\n6 - \\omega^2 \\;=\\; 0 \\;\\;\\Longleftrightarrow\\;\\; \\omega \\;=\\; \\sqrt{6},\n$$\n这对于当前链式系统等价于 $\\omega^2 = (k_2 + k_3)/m_2$，揭示了反共振频率是通过代数余子式“看到”的未受力互补子结构的固有频率。\n\n因此，对于该系统，$H_{11}(\\omega)$ 的唯一有限反共振频率是 $\\omega_a = \\sqrt{6}$ 弧度/秒。", "answer": "$$\\boxed{\\sqrt{6}}$$", "id": "2563508"}, {"introduction": "本练习将谐响应分析的应用拓展到了一个前沿领域：周期性结构，也被称为声子晶体或超材料。这类结构因其独特的波动调控能力而备受关注，其核心特性是“带隙”或“禁带”的存在，即在特定频率范围内波无法在结构中传播。您将首先从第一性原理出发，为无限长的一维双原子链推导色散关系，并预测禁带的频率范围；随后，您将通过有限元法对一个有限长链进行数值模拟，验证在禁带频率下波动的衰减现象，从而将理论分析与计算实践紧密结合 [@problem_id:2563559]。", "problem": "考虑一个一维周期性晶格，它由一个重复的晶胞构成，该晶胞包含由相同的线性弹簧连接的两个点质量。每个晶胞包含一个质量为 $m_a$ 的质点，其后为一个质量为 $m_b$ 的质点，相邻的质量通过刚度为 $k$ 的弹簧连接，且仅存在最近邻相互作用。不存在几何非线性，所有相互作用均为线性。假设为小幅振荡，因此叠加原理适用。晶格间距 $a$ 是均匀的，但在计算最近邻耦合下的带边频率时无需指定。目标是双重的：首先，从第一性原理推导此双原子链的色散关系，并确定出现空间衰减的角频率（单位：rad/s）的禁带区间；其次，将该预测与一个由有限数量晶胞构成的、承受简谐点力的有限长条带的端到端导纳进行比较。\n\n出发点和建模假设：\n- 使用牛顿第二定律，为一个包含两个质量 $m_a$ 和 $m_b$ 的通用晶胞编写运动方程，其中刚度为 $k$ 的线性弹簧将每个质量与其左右相邻晶胞中的质量相连。\n- 通过假设具有角频率 $\\omega$ 的简谐时间依赖性以及由波数 $q$ 参数化的跨晶胞空间相移，来应用布洛赫-弗洛凯（Bloch-Floquet）周期性（空间周期性的稳态响应）。\n- 通过强制要求单个晶胞内振幅的齐次方程存在非平凡解来获得色散关系，这会产生一个连接 $\\omega$ 和 $q$ 的特征值条件。\n- 将禁带识别为角频率 $\\omega$ 的连续区间，在这些区间内布洛赫波数 $q$ 变为复数值，这与布里渊区边界处声学支和光学支之间的谱隙相吻合。\n\n有限长条带比较：\n- 构建一个具有 $N$ 个晶胞（因此有 $2N$ 个自由度）且两端自由的有限长条带，其质量矩阵 $M \\in \\mathbb{R}^{2N \\times 2N}$ 为对角矩阵，对角元交替为 $m_a, m_b, \\dots$，其刚度矩阵 $K \\in \\mathbb{R}^{2N \\times 2N}$ 为三对角矩阵，对应于刚度为 $k$ 的最近邻弹簧（末端质量连接一个弹簧，内部质量连接两个）。\n- 包含与刚度成正比的微小瑞利型粘性阻尼 $C = \\beta K$，其中给定的 $\\beta$ 单位为秒，以正则化共振峰，而不显著改变带隙预测。\n- 在最左侧的质量（自由度 1）上施加一个大小为 1 牛顿的单位振幅简谐力，并通过求解线性系统 $(K - \\omega^2 M + i \\omega C)\\,x = f$ 来计算最右侧质量（自由度 $2N$）的复数稳态位移。对于单位输入，将端到端导纳的幅值定义为 $|x_{2N}|$。\n\n要求的推导和计算：\n- 从第一性原理推导所描述的双原子链的色散关系。从该关系式中，确定布里渊区边界处的频率，并获得界定声学支和光学支之间禁带的带边角频率（单位：rad/s）。不得假设或直接引用最终公式；您必须从基本方程和布洛赫-弗洛凯周期性出发进行推导。\n- 对于下方的每个测试用例，计算：\n  1. 根据色散关系预测的禁带边缘 $\\omega_{\\text{low}}$ 和 $\\omega_{\\text{high}}$（单位：rad/s）。\n  2. 带隙中心频率 $\\omega_{\\text{mid}} = (\\omega_{\\text{low}} + \\omega_{\\text{high}})/2$（单位：rad/s）。如果预测的带宽 $\\omega_{\\text{high}} - \\omega_{\\text{low}}$ 在容差范围内数值上为零，则将该情况视为没有禁带。\n  3. 一个参考通带频率 $\\omega_{\\text{ref}} = 0.9\\,\\omega_{\\text{low}}$（单位：rad/s），它位于带隙下方的声学通带内。对于没有带隙的情况，仍使用 $\\omega_{\\text{ref}} = 0.9\\,\\omega_{\\text{low}}$，其中 $\\omega_{\\text{low}}$ 被解释为布里渊边界频率。\n  4. 对于具有 $N$ 个晶胞的相应有限长条带，计算端到端导纳 $|x_{2N}(\\omega_{\\text{mid}})|$ 和 $|x_{2N}(\\omega_{\\text{ref}})|$。定义衰减比 $r = |x_{2N}(\\omega_{\\text{mid}})| / |x_{2N}(\\omega_{\\text{ref}})|$。如果预测的带宽在容差范围内为零，则根据定义将 $r$ 设为 $1.0$（无预测衰减）。\n\n物理单位和数值约定：\n- 质量单位必须是千克（$\\mathrm{kg}$），刚度单位是牛顿/米（$\\mathrm{N/m}$），阻尼系数 $\\beta$ 单位是秒（$\\mathrm{s}$），角频率单位是弧度/秒（$\\mathrm{rad/s}$），力单位是牛顿（$\\mathrm{N}$），位移单位是米（$\\mathrm{m}$）。\n- 将最终的比率 $r$ 报告为无量纲数。\n\n测试套件：\n- 使用以下三组参数集，每组指定为 $(m_a, m_b, k, N, \\beta)$：\n  1. $(1.0, 3.0, 10000.0, 20, 1.0 \\times 10^{-4})$\n  2. $(1.0, 1.5, 10000.0, 20, 1.0 \\times 10^{-4})$\n  3. $(1.0, 1.0, 10000.0, 20, 1.0 \\times 10^{-4})$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的衰减比，格式为用方括号括起来的逗号分隔列表，顺序与上文相同，并四舍五入到六位有效数字（例如，$\\left[0.0123456,0.0789,1.23\\right]$）。根据需要使用科学计数法，但确保每个条目有六位有效数字。", "solution": "问题陈述经评估有效。这是一个在晶格动力学领域中定义明确的问题，其基础是固态物理和结构力学中已确立的原理。该问题自成体系、科学严谨，其目标陈述清晰而精确。我们现在将给出完整的解决方案。\n\n解决方案分为两部分。首先，我们从第一性原理出发，推导无限长一维双原子链的色散关系，以预测频带隙。其次，我们描述有限长链的数值模型，以验证带隙理论所预测的衰减。\n\n**1. 无限长双原子链的色散关系**\n\n考虑一个无限长的一维晶格，由交替出现的质量 $m_a$ 和 $m_b$ 组成，它们通过刚度为 $k$ 的相同弹簧相连。设长度为 $a$ 的晶胞包含一个 a 型质量和一个 b 型质量。设 $u_{n,a}$ 表示第 $n$ 个晶胞中质量 $m_a$ 偏离平衡位置的位移，$u_{n,b}$ 为同一晶胞中质量 $m_b$ 的位移。质量排列如下：$\\dots - (m_b)_{n-1} - k - (m_a)_n - k - (m_b)_n - k - (m_a)_{n+1} - \\dots$。\n\n对第 $n$ 个晶胞中的每个质量应用牛顿第二定律，可得运动方程：\n$$\nm_a \\frac{d^2 u_{n,a}}{dt^2} = k(u_{n,b} - u_{n,a}) + k(u_{n-1,b} - u_{n,a}) = k(u_{n,b} + u_{n-1,b} - 2u_{n,a})\n$$\n$$\nm_b \\frac{d^2 u_{n,b}}{dt^2} = k(u_{n+1,a} - u_{n,b}) + k(u_{n,a} - u_{n,b}) = k(u_{n+1,a} + u_{n,a} - 2u_{n,b})\n$$\n\n我们寻求行波解。根据适用于周期系统的布洛赫定理，解可以写成一个平面波乘以一个具有晶格周期性的函数的形式。我们假设简谐解的形式为：\n$$\nu_{n,a}(t) = A e^{i(qna - \\omega t)}\n$$\n$$\nu_{n,b}(t) = B e^{i(qna - \\omega t)}\n$$\n其中 $A$ 和 $B$ 是晶胞内质量的复振幅，$q$ 是波数，$\\omega$ 是角频率。相邻晶胞中的位移通过一个相位因子关联。具体来说，$u_{n-1,b} = u_{n,b} e^{-iqa}$ 且 $u_{n+1,a} = u_{n,a} e^{iqa}$。\n\n将这些解代入运动方程，并消去公因子 $e^{i(qna - \\omega t)}$，我们得到关于振幅 $A$ 和 $B$ 的代数方程组：\n$$\n-\\omega^2 m_a A = k(B + B e^{-iqa} - 2A)\n$$\n$$\n-\\omega^2 m_b B = k(A e^{iqa} + A - 2B)\n$$\n将这些方程重新排列成矩阵形式，得到：\n$$\n\\begin{pmatrix}\n2k - m_a \\omega^2  -k(1 + e^{-iqa}) \\\\\n-k(1 + e^{iqa})  2k - m_b \\omega^2\n\\end{pmatrix}\n\\begin{pmatrix}\nA \\\\\nB\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n为了使非平凡解 $(A, B)$ 存在，系数矩阵的行列式必须为零：\n$$\n(2k - m_a \\omega^2)(2k - m_b \\omega^2) - k^2(1 + e^{-iqa})(1 + e^{iqa}) = 0\n$$\n第二项可简化为：$k^2 (1 + e^{iqa} + e^{-iqa} + 1) = k^2(2 + 2\\cos(qa)) = 2k^2(1 + \\cos(qa)) = 4k^2\\cos^2(qa/2)$。\n因此，行列式条件变为：\n$$\n(2k - m_a \\omega^2)(2k - m_b \\omega^2) - 4k^2\\cos^2(qa/2) = 0\n$$\n展开并重新整理得到色散关系，这是一个关于 $\\omega^2$ 的二次方程：\n$$\nm_a m_b \\omega^4 - 2k(m_a + m_b) \\omega^2 + 4k^2(1 - \\cos^2(qa/2)) = 0\n$$\n$$\nm_a m_b \\omega^4 - 2k(m_a + m_b) \\omega^2 + 4k^2\\sin^2(qa/2) = 0\n$$\n求解 $\\omega^2$ 得到两个解，分别对应光学支和声学支：\n$$\n\\omega^2(q) = \\frac{k(m_a + m_b)}{m_a m_b} \\pm k \\sqrt{\\left(\\frac{m_a + m_b}{m_a m_b}\\right)^2 - \\frac{4\\sin^2(qa/2)}{m_a m_b}}\n$$\n\n**2. 带隙识别**\n\n频带隙，或称禁带，是指一个频率范围，在此范围内不存在实数值的波数 $q$，意味着波无法在不衰减的情况下传播。该带隙出现在声学支的上限和光学支的下限之间。这些极限位于第一布里渊区的边界处，即 $q = \\pm\\pi/a$。\n\n在布里渊区边界，$q=\\pi/a$，我们有 $\\sin^2(qa/2) = \\sin^2(\\pi/2) = 1$。平方根下的项变为：\n$$\n\\sqrt{\\left(\\frac{m_a + m_b}{m_a m_b}\\right)^2 - \\frac{4}{m_a m_b}} = \\sqrt{\\frac{(m_a + m_b)^2 - 4m_a m_b}{(m_a m_b)^2}} = \\sqrt{\\frac{(m_a - m_b)^2}{(m_a m_b)^2}} = \\left|\\frac{m_a - m_b}{m_a m_b}\\right| = \\left|\\frac{1}{m_b} - \\frac{1}{m_a}\\right|\n$$\n因此，在布里渊区边界处的频率为：\n$$\n\\omega^2_{\\pm} = k\\left(\\frac{1}{m_a} + \\frac{1}{m_b}\\right) \\pm k\\left|\\frac{1}{m_a} - \\frac{1}{m_b}\\right|\n$$\n声学支的顶端对应负号，光学支的底端对应正号。\n不失一般性，假设 $m_b > m_a$。那么 $1/m_a > 1/m_b$。频率为：\n$$\n\\omega_{acoustic,max}^2 = k\\left(\\frac{1}{m_a} + \\frac{1}{m_b} - \\left(\\frac{1}{m_a} - \\frac{1}{m_b}\\right)\\right) = \\frac{2k}{m_b}\n$$\n$$\n\\omega_{optical,min}^2 = k\\left(\\frac{1}{m_a} + \\frac{1}{m_b} + \\left(\\frac{1}{m_a} - \\frac{1}{m_b}\\right)\\right) = \\frac{2k}{m_a}\n$$\n因此，禁带是频率区间 $[\\omega_{\\text{low}}, \\omega_{\\text{high}}]$，其中：\n$$\n\\omega_{\\text{low}} = \\sqrt{\\frac{2k}{\\max(m_a, m_b)}}\n$$\n$$\n\\omega_{\\text{high}} = \\sqrt{\\frac{2k}{\\min(m_a, m_b)}}\n$$\n如果 $m_a = m_b$，则带隙闭合，即 $\\omega_{\\text{low}} = \\omega_{\\text{high}}$。\n\n**3. 有限长条带分析**\n\n为了验证这一预测，我们建立一个包含 $N$ 个晶胞（共 $2N$ 个质量）且两端自由的有限长链模型。稳态简谐强迫下的运动方程为：\n$$\n(-\\omega^2 M + i\\omega C + K)x = f\n$$\n其中 $x$ 是复位移振幅的向量。\n- 质量矩阵 $M \\in \\mathbb{R}^{2N \\times 2N}$ 是对角矩阵，其对角元 $M_{ii}$ 在 $m_a$ 和 $m_b$ 之间交替。\n- 由于最近邻相互作用，刚度矩阵 $K \\in \\mathbb{R}^{2N \\times 2N}$ 是对称三对角矩阵。对于自由端，有 $K_{1,1}=k$，$K_{2N,2N}=k$，而内部质量的主对角元为 $2k$。非对角元为 $-k$。\n- 阻尼以瑞利（Rayleigh）阻尼的形式引入，$C = \\beta K$，其中 $\\beta$ 是给定的系数。\n- 力向量 $f \\in \\mathbb{R}^{2N}$ 只有一个非零分量 $f_1=1$，表示作用在最左侧质量上的单位简谐力。\n我们针对两个频率求解该线性系统以获得位移向量 $x$：一个是在通带内的参考频率 $\\omega_{\\text{ref}} = 0.9\\,\\omega_{\\text{low}}$，另一个是在禁带内的带隙中心频率 $\\omega_{\\text{mid}} = (\\omega_{\\text{low}} + \\omega_{\\text{high}})/2$。\n衰减比定义为 $r = |x_{2N}(\\omega_{\\text{mid}})| / |x_{2N}(\\omega_{\\text{ref}})|$，其中 $x_{2N}$ 是最右侧质量的位移。该比率量化了由带隙引起的衰减。对于 $m_a=m_b$ 的情况，带隙闭合，我们定义 $r=1.0$。\n\n所提供的代码实现了此过程，以计算指定测试用例的衰减比。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the diatomic chain problem for the given test cases.\n    It calculates the band gap from the dispersion relation and then computes\n    the wave decay ratio for a finite chain using a matrix-based approach.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (m_a, m_b, k, N, beta)\n        (1.0, 3.0, 10000.0, 20, 1.0e-4),\n        (1.0, 1.5, 10000.0, 20, 1.0e-4),\n        (1.0, 1.0, 10000.0, 20, 1.0e-4),\n    ]\n\n    results = []\n    # Use a small tolerance for floating point comparison of the band width\n    tolerance = 1e-9\n\n    for case in test_cases:\n        m_a, m_b, k, N, beta = case\n        \n        # 1. Predict stop-band edges from dispersion relation\n        m_max = max(m_a, m_b)\n        m_min = min(m_a, m_b)\n        \n        w_low = np.sqrt(2 * k / m_max)\n        w_high = np.sqrt(2 * k / m_min)\n        \n        # Check for band gap closure\n        if abs(w_high - w_low)  tolerance:\n            results.append(1.0)\n            continue\n            \n        # 2. Define key frequencies\n        w_mid = (w_low + w_high) / 2.0\n        w_ref = 0.9 * w_low\n        \n        # 3. Finite strip analysis\n        num_dof = 2 * N\n        \n        # Construct mass matrix M\n        mass_vector = np.array([m_a if i % 2 == 0 else m_b for i in range(num_dof)])\n        M = np.diag(mass_vector)\n        \n        # Construct stiffness matrix K for a free-free chain\n        K = np.zeros((num_dof, num_dof))\n        diag_main = 2 * k * np.ones(num_dof)\n        diag_off = -k * np.ones(num_dof - 1)\n        \n        np.fill_diagonal(K, diag_main)\n        K += np.diag(diag_off, k=1)\n        K += np.diag(diag_off, k=-1)\n        \n        # Adjust for free boundary conditions\n        K[0, 0] = k\n        K[-1, -1] = k\n        \n        # Construct forcing vector f\n        f = np.zeros(num_dof, dtype=np.complex128)\n        f[0] = 1.0\n\n        # Function to compute receptance at the end\n        def get_end_receptance(omega, M_mat, K_mat, f_vec, beta_val):\n            # Dynamic stiffness matrix: A(omega) = (K - omega^2*M + i*omega*C)\n            # where C = beta*K\n            A = (1 + 1j * omega * beta_val) * K_mat - omega**2 * M_mat\n            x = np.linalg.solve(A, f_vec)\n            # Return magnitude of displacement at the rightmost mass (index 2N-1)\n            return np.abs(x[-1])\n\n        # Compute receptances\n        receptance_mid = get_end_receptance(w_mid, M, K, f, beta)\n        receptance_ref = get_end_receptance(w_ref, M, K, f, beta)\n        \n        # 4. Compute the decay ratio\n        if receptance_ref == 0:\n            # Avoid division by zero, though physically unlikely with damping\n            # A very large ratio would indicate an issue, but we set to a marker value\n            decay_ratio = np.inf\n        else:\n            decay_ratio = receptance_mid / receptance_ref\n            \n        results.append(decay_ratio)\n\n    # Format results to 6 significant figures and generate the final output string\n    formatted_results = [\"{:.6g}\".format(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2563559"}]}