{"hands_on_practices": [{"introduction": "在处理复杂的大型系统之前，亲手解决一个小型问题是建立物理直觉的关键一步。本练习将引导你为一个简单的双自由度（2-DOF）系统手动求解其广义特征值问题。通过这个过程，你将直接看到数学上的特征值和特征向量如何分别对应于系统的固有频率和物理上的振动形态（即振型），从而深刻理解模态分析的基本原理。[@problem_id:2578908]", "problem": "考虑一个在线性有限元法（FEM）框架下建模的线性、无阻尼、二自由度（DOF）机械系统。设广义坐标为节点位移 $q_{1}(t)$ 和 $q_{2}(t)$，并将其汇集于向量 $\\mathbf{q}(t) = \\begin{pmatrix} q_{1}(t) \\\\ q_{2}(t) \\end{pmatrix}$ 中。运动方程源于应用于广义坐标的牛顿第二定律。对称、正定的质量矩阵和刚度矩阵由下式给出：\n$$\nM = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} \\ \\text{kg}, \n\\qquad\nK = \\begin{pmatrix} 5000  -1500 \\\\ -1500  2500 \\end{pmatrix} \\ \\text{N/m}.\n$$\n从第一性原理出发，建立该系统自由振动的控制方程，并推导确定无阻尼固有圆频率及其振型的相关广义特征值问题。然后，显式求解该二自由度系统的特征值问题，以获得两个固有频率及其对应的质量归一化振型。请对变形模式提供物理解释，识别哪种模式主要是同相的，哪种是反相的，并解释耦合项如何影响这些模式。\n\n答案规格：最终答案仅报告较低的固有圆频率。以弧度/秒为单位表示，并将您的答案四舍五入至四位有效数字。", "solution": "用户提出了一个线性结构动力学问题。第一个强制性步骤是对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n问题陈述逐字提供了以下信息：\n- 系统类型：线性、无阻尼、二自由度（$2$-DOF）。\n- 建模框架：有限元法（FEM）。\n- 广义坐标向量：$\\mathbf{q}(t) = \\begin{pmatrix} q_{1}(t) \\\\ q_{2}(t) \\end{pmatrix}$。\n- 质量矩阵：$M = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} \\ \\text{kg}$。据称其为对称、正定矩阵。\n- 刚度矩阵：$K = \\begin{pmatrix} 5000  -1500 \\\\ -1500  2500 \\end{pmatrix} \\ \\text{N/m}$。据称其为对称矩阵。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n1.  **科学依据**：该问题植根于经典力学，特别是保守系统的微振动理论，这是物理学和工程学中的一个基本课题。控制方程 $M\\ddot{\\mathbf{q}} + K\\mathbf{q} = \\mathbf{0}$ 是一种标准表示。必须检查矩阵是否具有所述属性。\n    - 质量矩阵 $M$ 是对称的。其主子式为 $\\det(3) = 3 > 0$ 和 $\\det(M) = (3)(2) - (1)(1) = 5 > 0$。因此，$M$ 是正定的。\n    - 刚度矩阵 $K$ 是对称的。其主子式为 $\\det(5000) = 5000 > 0$ 和 $\\det(K) = (5000)(2500) - (-1500)^2 = 12,500,000 - 2,250,000 = 10,250,000 > 0$。因此，$K$ 也是正定的。\n    对于一个稳定的无源机械系统，矩阵的这些属性与物理现实一致。该问题在科学上是合理的。\n2.  **适定性**：对于具有对称、正定质量（$M$）和刚度（$K$）矩阵的系统，线性代数和机械振动理论保证存在一组实的正固有频率和一组对应的 M-正交振型。存在唯一解。该问题是适定的。\n3.  **客观性**：该问题使用机械工程中精确的标准术语进行陈述。它没有模糊性和主观论断。\n4.  **完整性和一致性**：确定固有频率和振型所需的所有数据（$M$ 和 $K$ 矩阵）均已提供。单位在物理上是一致的。该问题是自洽的。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、适定的、客观的和完整的。它是结构动力学中一个标准的、有效的问题。将提供解答。\n\n---\n\n线性系统自由无阻尼振动的控制方程由拉格朗日方程给出，在本情境中，其形式为牛顿第二定律的矩阵形式：\n$$\nM\\ddot{\\mathbf{q}}(t) + K\\mathbf{q}(t) = \\mathbf{0}\n$$\n其中 $M$ 是质量矩阵，$K$ 是刚度矩阵，$\\mathbf{q}(t)$ 是广义位移向量。\n\n为求固有频率和振型，我们假设一种形式为同步谐波运动的解：\n$$\n\\mathbf{q}(t) = \\mathbf{\\phi} e^{i\\omega t}\n$$\n其中 $\\mathbf{\\phi}$ 是与时间无关的振型向量（振幅向量），$\\omega$ 是固有圆频率，$i = \\sqrt{-1}$。将此假设解对时间求两次导数，得到：\n$$\n\\ddot{\\mathbf{q}}(t) = -\\omega^2 \\mathbf{\\phi} e^{i\\omega t}\n$$\n将假设解及其二阶导数代入运动方程，得到：\n$$\n-M\\omega^2 \\mathbf{\\phi} e^{i\\omega t} + K \\mathbf{\\phi} e^{i\\omega t} = \\mathbf{0}\n$$\n由于项 $e^{i\\omega t}$ 永不为零，我们可以用它来除整个方程，从而得到广义特征值问题：\n$$\n(K - \\omega^2 M) \\mathbf{\\phi} = \\mathbf{0}\n$$\n为了得到振型 $\\mathbf{\\phi}$ 不为零向量的非平凡解，系数矩阵的行列式必须为零：\n$$\n\\det(K - \\omega^2 M) = 0\n$$\n令 $\\lambda = \\omega^2$。方程变为关于 $\\lambda$ 的特征方程：\n$$\n\\det(K - \\lambda M) = 0\n$$\n代入给定的矩阵 $M$ 和 $K$：\n$$\n\\det\\left(\\begin{pmatrix} 5000  -1500 \\\\ -1500  2500 \\end{pmatrix} - \\lambda \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}\\right) = 0\n$$\n$$\n\\det\\begin{pmatrix} 5000 - 3\\lambda  & -1500 - \\lambda \\\\ -1500 - \\lambda  & 2500 - 2\\lambda \\end{pmatrix} = 0\n$$\n计算行列式得到特征多项式：\n$$\n(5000 - 3\\lambda)(2500 - 2\\lambda) - (-1500 - \\lambda)^2 = 0\n$$\n$$\n(12,500,000 - 10,000\\lambda - 7,500\\lambda + 6\\lambda^2) - (2,250,000 + 3,000\\lambda + \\lambda^2) = 0\n$$\n$$\n6\\lambda^2 - 17,500\\lambda + 12,500,000 - \\lambda^2 - 3,000\\lambda - 2,250,000 = 0\n$$\n合并同类项得到一个关于 $\\lambda$ 的二次方程：\n$$\n5\\lambda^2 - 20,500\\lambda + 10,250,000 = 0\n$$\n两边除以 $5$ 以简化方程：\n$$\n\\lambda^2 - 4100\\lambda + 2,050,000 = 0\n$$\n我们使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解此二次方程以得到特征值 $\\lambda_1$ 和 $\\lambda_2$：\n$$\n\\lambda = \\frac{4100 \\pm \\sqrt{(-4100)^2 - 4(1)(2,050,000)}}{2} = \\frac{4100 \\pm \\sqrt{16,810,000 - 8,200,000}}{2}\n$$\n$$\n\\lambda = \\frac{4100 \\pm \\sqrt{8,610,000}}{2}\n$$\n两个特征值为：\n$$\n\\lambda_1 = \\frac{4100 - \\sqrt{8,610,000}}{2} \\approx \\frac{4100 - 2934.28}{2} \\approx 582.86 \\, (\\text{rad/s})^2\n$$\n$$\n\\lambda_2 = \\frac{4100 + \\sqrt{8,610,000}}{2} \\approx \\frac{4100 + 2934.28}{2} \\approx 3517.14 \\, (\\text{rad/s})^2\n$$\n固有圆频率是特征值的平方根，即 $\\omega = \\sqrt{\\lambda}$。\n较低的固有频率是：\n$$\n\\omega_1 = \\sqrt{\\lambda_1} = \\sqrt{\\frac{4100 - \\sqrt{8,610,000}}{2}} \\approx 24.142 \\, \\text{rad/s}\n$$\n较高的固有频率是：\n$$\n\\omega_2 = \\sqrt{\\lambda_2} = \\sqrt{\\frac{4100 + \\sqrt{8,610,000}}{2}} \\approx 59.305 \\, \\text{rad/s}\n$$\n接下来，我们通过求解 $(K - \\lambda_i M)\\mathbf{\\phi}_i = \\mathbf{0}$ 来为每个特征值找到对应的特征向量（振型）$\\mathbf{\\phi}_i$。\n对于 $\\lambda_1 \\approx 582.86$，方程组为：\n$$\n\\begin{pmatrix} 5000 - 3(\\lambda_1)  & -1500 - \\lambda_1 \\\\ -1500 - \\lambda_1  & 2500 - 2(\\lambda_1) \\end{pmatrix} \\begin{pmatrix} \\phi_{11} \\\\ \\phi_{21} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n使用第一行：$(5000 - 3(582.86))\\phi_{11} - (1500 + 582.86)\\phi_{21} = 0$，简化为 $3251.42\\phi_{11} - 2082.86\\phi_{21} = 0$。分量之比为 $\\frac{\\phi_{21}}{\\phi_{11}} = \\frac{3251.42}{2082.86} \\approx 1.561$。第一振型为 $\\mathbf{\\phi}_1 \\propto \\begin{pmatrix} 1 \\\\ 1.561 \\end{pmatrix}$。\n\n对于 $\\lambda_2 \\approx 3517.14$，方程组为：\n$$\n\\begin{pmatrix} 5000 - 3(\\lambda_2)  & -1500 - \\lambda_2 \\\\ -1500 - \\lambda_2  & 2500 - 2(\\lambda_2) \\end{pmatrix} \\begin{pmatrix} \\phi_{12} \\\\ \\phi_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n使用第一行：$(5000 - 3(3517.14))\\phi_{12} - (1500 + 3517.14)\\phi_{22} = 0$，得到 $-5551.42\\phi_{12} - 5017.14\\phi_{22} = 0$。分量之比为 $\\frac{\\phi_{22}}{\\phi_{12}} = -\\frac{5551.42}{5017.14} \\approx -1.106$。第二振型为 $\\mathbf{\\phi}_2 \\propto \\begin{pmatrix} 1 \\\\ -1.106 \\end{pmatrix}$。\n\n为获得质量归一化振型 $\\mathbf{\\hat{\\phi}}_i$，我们施加条件 $\\mathbf{\\hat{\\phi}}_i^T M \\mathbf{\\hat{\\phi}}_i = 1$。令 $\\mathbf{\\hat{\\phi}}_i = c_i \\mathbf{\\phi}_i$。则 $c_i = (\\mathbf{\\phi}_i^T M \\mathbf{\\phi}_i)^{-1/2}$。\n对于 $\\mathbf{\\phi}_1 = \\begin{pmatrix} 1 \\\\ 1.561 \\end{pmatrix}$：$c_1 = (3(1)^2 + 2(1)(1)(1.561) + 2(1.561)^2)^{-1/2} \\approx 0.3016$。\n$\\mathbf{\\hat{\\phi}}_1 \\approx \\begin{pmatrix} 0.3016 \\\\ 0.4708 \\end{pmatrix}$。\n对于 $\\mathbf{\\phi}_2 = \\begin{pmatrix} 1 \\\\ -1.106 \\end{pmatrix}$：$c_2 = (3(1)^2 + 2(1)(1)(-1.106) + 2(-1.106)^2)^{-1/2} \\approx 0.5560$。\n$\\mathbf{\\hat{\\phi}}_2 \\approx \\begin{pmatrix} 0.5560 \\\\ -0.6150 \\end{pmatrix}$。\n\n**物理解释：**\n1.  **第一模式（较低频率，$\\omega_1 \\approx 24.14$ rad/s）：** 振型 $\\mathbf{\\hat{\\phi}}_1$ 的分量符号相同。这意味着两个自由度 $q_1$ 和 $q_2$ 在任何时候都朝同一个方向运动。这是**同相**模式。振幅比显示，第二个坐标的运动量约是第一个坐标的 $1.561$ 倍。该模式代表一种集体的、能量较低的运动。\n2.  **第二模式（较高频率，$\\omega_2 \\approx 59.31$ rad/s）：** 振型 $\\mathbf{\\hat{\\phi}}_2$ 的分量符号相反。这意味着 $q_1$ 和 $q_2$ 在任何时候都朝相反的方向运动。这是**反相**模式。它代表一种能量较高的、差分运动，其中各分量相互对抗运动。\n\n**耦合的影响：** 非对角项 $m_{12}=1$ 和 $k_{12}=-1500$ 分别代表惯性耦合和弹性耦合。如果没有这些项，系统将解耦为两个独立的单自由度振子。耦合主要有两个作用：\n- 它混合了两种运动，确保没有一种模式只涉及单个坐标的运动。这些模式是“纯粹的”单坐标运动的组合。\n- 它“分裂”了固有频率。一个非耦合系统的频率将是 $\\sqrt{k_{11}/m_{11}} \\approx 40.8$ rad/s 和 $\\sqrt{k_{22}/m_{22}} \\approx 35.4$ rad/s。耦合作用使得一个频率低于（同相模式，$\\omega_1$）、另一个频率高于（反相模式，$\\omega_2$）非耦合时的频率。这是耦合振子系统中的一个普遍现象。\n\n问题要求的是较低的固有圆频率 $\\omega_1$，四舍五入至四位有效数字。\n$$\n\\omega_1 = \\sqrt{\\frac{4100 - \\sqrt{8,610,000}}{2}} \\approx 24.14249 \\, \\text{rad/s}\n$$\n四舍五入至 $4$ 位有效数字得到 $24.14$。", "answer": "$$\n\\boxed{24.14}\n$$", "id": "2578908"}, {"introduction": "在工程实践中，出于效率考虑，我们通常只采用系统所有振型的一个子集来进行动态分析，这一过程称为模态截断。本练习将深入探讨模态截断的理论后果。你将通过推导每个振型对最终静力响应的贡献，揭示为何简单的模态叠加（模态位移法）在预测静力行为时会产生误差，并理解引入静力校正的必要性，为学习更高级的模态组合方法奠定理论基础。[@problem_id:2578769]", "problem": "考虑一个具有 $n$ 个自由度的线性时不变多自由度结构，其通过有限元法得到的半离散运动方程为：\n$$\n\\boldsymbol{M}\\,\\ddot{\\boldsymbol{x}}(t)+\\boldsymbol{C}\\,\\dot{\\boldsymbol{x}}(t)+\\boldsymbol{K}\\,\\boldsymbol{x}(t)=\\boldsymbol{f}_0\\,H(t),\n$$\n其中 $\\boldsymbol{M}\\in\\mathbb{R}^{n\\times n}$ 和 $\\boldsymbol{K}\\in\\mathbb{R}^{n\\times n}$ 是对称正定质量矩阵和刚度矩阵，$\\boldsymbol{C}\\in\\mathbb{R}^{n\\times n}$ 是粘性阻尼矩阵，$\\boldsymbol{f}_0\\in\\mathbb{R}^{n}$ 是恒定载荷向量，$H(t)$ 是亥维赛单位阶跃函数。假设初始条件为零，即 $\\boldsymbol{x}(0)=\\boldsymbol{0}$ 和 $\\dot{\\boldsymbol{x}}(0)=\\boldsymbol{0}$。设广义特征问题\n$$\n\\boldsymbol{K}\\,\\boldsymbol{\\phi}_r=\\omega_r^{2}\\,\\boldsymbol{M}\\,\\boldsymbol{\\phi}_r,\\quad r=1,\\dots,n,\n$$\n存在一组完备的实特征对，其中质量归一化的特征向量为 $\\boldsymbol{\\phi}_r$，它们被收集在模态矩阵 $\\boldsymbol{\\Phi}=\\begin{bmatrix}\\boldsymbol{\\phi}_1  \\cdots  \\boldsymbol{\\phi}_n\\end{bmatrix}$ 中，满足 $\\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{M}\\boldsymbol{\\Phi}=\\boldsymbol{I}$，自振圆频率为 $\\omega_r>0$。\n\n仅从这些基本定义和性质出发，不引用任何现成的模态叠加公式，推导由阶跃载荷产生的最终静位移 $\\boldsymbol{x}_{\\infty}=\\lim_{t\\to\\infty}\\boldsymbol{x}(t)$ 中每个模态的精确贡献。具体而言：\n\n1. 推导第 $r$ 阶模态对 $\\boldsymbol{x}_{\\infty}$ 的模态贡献向量的闭式表达式，用 $\\boldsymbol{\\phi}_r$、$\\omega_r$ 和 $\\boldsymbol{f}_0$ 表示。\n\n2. 利用由广义特征结构证明的算子恒等式，解释为什么对于一个通用的 $\\boldsymbol{f}_0$，将展开式截断到前 $m < n$ 个模态的近似解通常不能满足静力平衡方程 $\\boldsymbol{K}\\boldsymbol{x}=\\boldsymbol{f}_0$。", "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于线性结构动力学原理，问题提法恰当，并以客观、正式的语言表达。陈述中不含矛盾之处，并且为推导提供了所有必要的信息。我们可以开始求解。\n\n该问题要求基于模态分析，推导关于线性系统在阶跃载荷下静态响应的两个相关结果。\n\n首先，我们推导第 $r$ 阶模态对最终静位移 $\\boldsymbol{x}_{\\infty}$ 的贡献。控制运动方程如下：\n$$\n\\boldsymbol{M}\\,\\ddot{\\boldsymbol{x}}(t)+\\boldsymbol{C}\\,\\dot{\\boldsymbol{x}}(t)+\\boldsymbol{K}\\,\\boldsymbol{x}(t)=\\boldsymbol{f}_0\\,H(t)\n$$\n最终静位移 $\\boldsymbol{x}_{\\infty}$ 是位移在 $t \\to \\infty$ 时的极限。对于一个受恒定载荷作用的稳定系统，在平衡状态下，速度和加速度必须为零。因此，$\\lim_{t\\to\\infty} \\dot{\\boldsymbol{x}}(t) = \\boldsymbol{0}$ 且 $\\lim_{t\\to\\infty} \\ddot{\\boldsymbol{x}}(t) = \\boldsymbol{0}$。当 $t>0$ 时，亥维赛函数 $H(t)=1$。运动方程简化为静力平衡方程：\n$$\n\\boldsymbol{K}\\,\\boldsymbol{x}_{\\infty} = \\boldsymbol{f}_0\n$$\n由于刚度矩阵 $\\boldsymbol{K}$ 已知为正定矩阵，因此它是可逆的，精确的静位移可以唯一确定为 $\\boldsymbol{x}_{\\infty} = \\boldsymbol{K}^{-1}\\boldsymbol{f}_0$。\n\n为了找出每个模态对这一结果的贡献，我们使用模态坐标变换。位移向量 $\\boldsymbol{x}(t)$ 表示为质量归一化特征向量 $\\boldsymbol{\\phi}_r$ 的线性组合：\n$$\n\\boldsymbol{x}(t) = \\sum_{r=1}^{n} \\boldsymbol{\\phi}_r q_r(t) = \\boldsymbol{\\Phi}\\boldsymbol{q}(t)\n$$\n其中 $q_r(t)$ 是模态坐标。将此展开式代入完整的动力学方程，并左乘模态矩阵的转置 $\\boldsymbol{\\Phi}^{\\mathsf{T}}$，我们得到：\n$$\n\\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{M}\\boldsymbol{\\Phi}\\,\\ddot{\\boldsymbol{q}}(t) + \\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{\\Phi}\\,\\dot{\\boldsymbol{q}}(t) + \\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{\\Phi}\\,\\boldsymbol{q}(t) = \\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{f}_0\\,H(t)\n$$\n利用质量正交归一性 $\\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{M}\\boldsymbol{\\Phi}=\\boldsymbol{I}$。根据广义特征问题 $\\boldsymbol{K}\\boldsymbol{\\phi}_r = \\omega_r^2 \\boldsymbol{M}\\boldsymbol{\\phi}_r$，我们可以写出 $\\boldsymbol{K}\\boldsymbol{\\Phi} = \\boldsymbol{M}\\boldsymbol{\\Phi}\\boldsymbol{\\Omega}^2$，其中 $\\boldsymbol{\\Omega}^2$ 是自振频率平方的对角矩阵，$\\boldsymbol{\\Omega}^2 = \\text{diag}(\\omega_1^2, \\dots, \\omega_n^2)$。左乘 $\\boldsymbol{\\Phi}^{\\mathsf{T}}$ 得到 $\\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{\\Phi} = \\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{M}\\boldsymbol{\\Phi}\\boldsymbol{\\Omega}^2 = \\boldsymbol{I}\\boldsymbol{\\Omega}^2 = \\boldsymbol{\\Omega}^2$。模态坐标系下的方程组为：\n$$\n\\boldsymbol{I}\\,\\ddot{\\boldsymbol{q}}(t) + \\boldsymbol{C}_{\\text{modal}}\\,\\dot{\\boldsymbol{q}}(t) + \\boldsymbol{\\Omega}^2\\,\\boldsymbol{q}(t) = \\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{f}_0\\,H(t)\n$$\n其中 $\\boldsymbol{C}_{\\text{modal}} = \\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{\\Phi}$。在 $t \\to \\infty$ 的静态极限下，时间导数 $\\ddot{\\boldsymbol{q}}(t)$ 和 $\\dot{\\boldsymbol{q}}(t)$ 消失。第 $r$ 阶模态方程变为：\n$$\n\\omega_r^2 q_{r, \\infty} = \\boldsymbol{\\phi}_r^{\\mathsf{T}}\\boldsymbol{f}_0\n$$\n其中 $q_{r, \\infty} = \\lim_{t\\to\\infty} q_r(t)$。由于 $\\boldsymbol{K}$ 是正定的，所有 $\\omega_r^2 > 0$，所以我们可以解出静态模态坐标：\n$$\nq_{r, \\infty} = \\frac{\\boldsymbol{\\phi}_r^{\\mathsf{T}}\\boldsymbol{f}_0}{\\omega_r^2}\n$$\n总静位移是所有模态贡献的总和：$\\boldsymbol{x}_{\\infty} = \\sum_{r=1}^{n} \\boldsymbol{\\phi}_r q_{r, \\infty}$。因此，第 $r$ 阶模态对该最终静位移向量的贡献，记为 $\\boldsymbol{x}_{r, \\infty}$，是：\n$$\n\\boldsymbol{x}_{r, \\infty} = \\boldsymbol{\\phi}_r q_{r, \\infty} = \\boldsymbol{\\phi}_r \\left( \\frac{\\boldsymbol{\\phi}_r^{\\mathsf{T}}\\boldsymbol{f}_0}{\\omega_r^2} \\right) = \\frac{\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\boldsymbol{f}_0}{\\omega_r^2}\n$$\n这就完成了问题的第一部分。\n\n其次，我们分析截断模态级数的影响。如果将展开式截断到前 $m < n$ 个模态，则近似的静位移为：\n$$\n\\boldsymbol{x}_{\\infty}^{(m)} = \\sum_{r=1}^{m} \\boldsymbol{x}_{r, \\infty} = \\sum_{r=1}^{m} \\frac{\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\boldsymbol{f}_0}{\\omega_r^2}\n$$\n为了评估这个截断解是否满足静力平衡，我们计算相应的内部恢复力 $\\boldsymbol{K}\\boldsymbol{x}_{\\infty}^{(m)}$：\n$$\n\\boldsymbol{K}\\boldsymbol{x}_{\\infty}^{(m)} = \\boldsymbol{K} \\left( \\sum_{r=1}^{m} \\frac{\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}}}{\\omega_r^2} \\right) \\boldsymbol{f}_0 = \\left( \\sum_{r=1}^{m} \\frac{\\boldsymbol{K}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}}}{\\omega_r^2} \\right) \\boldsymbol{f}_0\n$$\n代入特征问题关系式 $\\boldsymbol{K}\\boldsymbol{\\phi}_r = \\omega_r^2 \\boldsymbol{M}\\boldsymbol{\\phi}_r$：\n$$\n\\boldsymbol{K}\\boldsymbol{x}_{\\infty}^{(m)} = \\left( \\sum_{r=1}^{m} \\frac{\\omega_r^2 \\boldsymbol{M}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}}}{\\omega_r^2} \\right) \\boldsymbol{f}_0 = \\left( \\sum_{r=1}^{m} \\boldsymbol{M}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\right) \\boldsymbol{f}_0\n$$\n为了满足静力平衡，这个内力必须与外加载荷 $\\boldsymbol{f}_0$ 相平衡。这里需要的算子恒等式是单位矩阵按质量加权投影算子的展开。由于 $\\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{M}\\boldsymbol{\\Phi}=\\boldsymbol{I}$，可以推断出 $\\boldsymbol{\\Phi}^{-1} = \\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{M}$（因为 $\\boldsymbol{\\Phi}$ 是方阵），因此 $\\boldsymbol{I} = \\boldsymbol{\\Phi}\\boldsymbol{\\Phi}^{-1} = \\boldsymbol{\\Phi}(\\boldsymbol{\\Phi}^{\\mathsf{T}}\\boldsymbol{M}) = \\sum_{r=1}^{n} \\boldsymbol{\\phi}_r\\boldsymbol{\\phi}_r^{\\mathsf{T}}\\boldsymbol{M}$。应用此恒等式可以将任意向量（此处为 $\\boldsymbol{M}^{-1}\\boldsymbol{f}_0$）重写为 $\\boldsymbol{M}^{-1}\\boldsymbol{f}_0 = \\sum_{r=1}^n \\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\boldsymbol{f}_0$，两边乘以 $\\boldsymbol{M}$ 后，得到之前隐式使用的恒等式：$\\boldsymbol{f}_0 = \\sum_{r=1}^n \\boldsymbol{M}\\boldsymbol{\\phi}_r\\boldsymbol{\\phi}_r^{\\mathsf{T}}\\boldsymbol{f}_0$。\n由截断级数得到的恢复力只是一个部分和，即 $\\sum_{r=1}^{m} \\boldsymbol{M}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\boldsymbol{f}_0$，这通常不等于 $\\boldsymbol{f}_0$。\n\n残余载荷向量 $\\boldsymbol{f}_{\\text{res}}$ 是外加载荷与由截断模态解计算出的内部恢复力之间的差值：\n$$\n\\boldsymbol{f}_{\\text{res}} = \\boldsymbol{f}_0 - \\boldsymbol{K}\\boldsymbol{x}_{\\infty}^{(m)} = \\boldsymbol{f}_0 - \\left( \\sum_{r=1}^{m} \\boldsymbol{M}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\right) \\boldsymbol{f}_0\n$$\n使用关于 $\\boldsymbol{f}_0$ 的恒等式，我们发现：\n$$\n\\boldsymbol{f}_{\\text{res}} = \\left( \\sum_{r=1}^{n} \\boldsymbol{M}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\right) \\boldsymbol{f}_0 - \\left( \\sum_{r=1}^{m} \\boldsymbol{M}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\right) \\boldsymbol{f}_0 = \\left( \\sum_{r=m+1}^{n} \\boldsymbol{M}\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\right) \\boldsymbol{f}_0\n$$\n该残余载荷代表了由被截断动力学分析排除的高频模态（$r > m$）所承担的那部分静载荷。静力修正方法旨在通过将由 $\\boldsymbol{f}_{\\text{res}}$ 引起的静位移（约为 $\\boldsymbol{K}^{-1}\\boldsymbol{f}_{\\text{res}}$）添加到截断模态解 $\\boldsymbol{x}_{\\infty}^{(m)}$ 中，来弥补这种不平衡。这提高了整体响应中静态分量的准确性。", "answer": "$$\n\\boxed{\\frac{\\boldsymbol{\\phi}_r \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\boldsymbol{f}_0}{\\omega_r^2}}\n$$", "id": "2578769"}, {"introduction": "本练习将理论付诸实践，要求你通过编程来比较两种核心的模态截断方法：标准的模态位移法（MDM）和包含静力校正的模态加速度法（MAM）。你将为一个多自由度系统实现这两种方法，并量化它们在预测位移和反力峰值时的精度差异。通过这个对比，你将亲身体会到模态加速度法在提高计算精度，尤其是在恢复结构内力方面的显著优势。[@problem_id:2578761]", "problem": "给定一个线性、时不变的二阶系统，该系统由结构动力学的有限元法（FEM）半离散化得到，由以下矩阵常微分方程控制\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\,\\mathbf{x}(t) = \\mathbf{f}(t),\n$$\n初始条件为\n$$\n\\mathbf{x}(0) = \\mathbf{0},\\quad \\dot{\\mathbf{x}}(0) = \\mathbf{0}.\n$$\n其中，$\\mathbf{M}\\in\\mathbb{R}^{n\\times n}$ 是对称正定质量矩阵，$\\mathbf{K}\\in\\mathbb{R}^{n\\times n}$ 是对称正定刚度矩阵，$\\mathbf{C}\\in\\mathbb{R}^{n\\times n}$ 是阻尼矩阵，假定为 Rayleigh 阻尼形式 $\\mathbf{C} = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K}$，$\\mathbf{f}(t)$ 是一个阶跃荷载 $\\mathbf{f}(t) = \\mathbf{f}_0\\,H(t)$，其中 $H(t)$ 是 Heaviside 阶跃函数，$\\mathbf{f}_0\\in\\mathbb{R}^{n}$ 是一个常数荷载向量，$t$ 是时间，单位为秒。\n\n任务是比较两种用于预测阶跃荷载下物理位移响应和支座反力的模态叠加截断策略：\n- 模态位移法 (MDM)：保留 $r$ 个模态，并仅从保留的模态位移重构物理位移。\n- 模态加速度法 (MAM)：为模态动力学保留 $r$ 个模态，但通过使用刚度矩阵的静态校正来强制残余荷载的平衡，从而增强物理位移的重构。\n\n您必须：\n1. 从上述基本控制方程和 Rayleigh 阻尼的定义出发，通过求解广义特征值问题来推导模态方程\n$$\n\\mathbf{K}\\,\\boldsymbol{\\phi}_j = \\omega_j^2\\,\\mathbf{M}\\,\\boldsymbol{\\phi}_j,\\quad j=1,\\dots,n,\n$$\n并进行质量归一化 $\\boldsymbol{\\phi}_i^{\\top}\\mathbf{M}\\,\\boldsymbol{\\phi}_j = \\delta_{ij}$。记 $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1,\\dots,\\boldsymbol{\\phi}_n]$，$\\boldsymbol{\\Omega}^2 = \\mathrm{diag}(\\omega_1^2,\\dots,\\omega_n^2)$，并写出阶跃荷载下广义坐标 $\\mathbf{q}(t)$ 的解耦模态方程。\n2. 精确定义仅使用前 $r$ 个模态的 MDM 和 MAM 物理位移重构，确保 MAM 校正是通过在每个时间 $t$ 强制物理坐标中残余荷载的静态平衡来获得的。不要假定荷载除了是阶跃荷载之外有任何特殊结构；从第一性原理推导表达式。\n3. 对于一个三自由度链，其平动自由度为 $\\mathbf{x}(t) = [x_1(t), x_2(t), x_3(t)]^\\top$，单位为米，采用以下刚度拓扑：刚度为 $k_1$ 的弹簧连接 $x_1$ 和地面，刚度为 $k_2$ 的弹簧连接 $x_1$ 和 $x_2$，刚度为 $k_3$ 的弹簧连接 $x_2$ 和 $x_3$。相应的刚度矩阵为\n$$\n\\mathbf{K} = \\begin{bmatrix}\nk_1 + k_2  &-k_2  &0\\\\\n-k_2  &k_2 + k_3  &-k_3\\\\\n0  &-k_3  &k_3\n\\end{bmatrix}.\n$$\n基底反力定义为接地弹簧中的弹性力，即 $R_\\text{base}(t) = k_1\\,x_1(t)$，单位为牛顿。\n4. 通过在两个选定的圆频率 $\\omega_a$ 和 $\\omega_b$ 处强制目标模态阻尼比 $\\zeta(\\omega_a)=\\zeta_a$ 和 $\\zeta(\\omega_b)=\\zeta_b$，并使用质量归一化模态的恒等式来校准 Rayleigh 阻尼系数 $\\alpha$ 和 $\\beta$\n$$\n\\zeta_j \\equiv \\frac{\\boldsymbol{\\phi}_j^{\\top}\\mathbf{C}\\,\\boldsymbol{\\phi}_j}{2\\,\\omega_j} = \\frac{\\alpha}{2\\,\\omega_j} + \\frac{\\beta\\,\\omega_j}{2}.\n$$\n对于下面的每个测试用例，使用 $\\omega_a=\\omega_1$、$\\omega_b=\\omega_3$ 以及指定的目标 $\\zeta_a$ 和 $\\zeta_b$。\n5. 使用对线性系统无条件稳定且二阶精确的模态空间时间积分方案（例如，Newmark 平均加速度法）来计算保留的广义坐标（对于 MDM 和 MAM 重构）以及使用所有 $n$ 个模态的参考解的时间历程。由于质量归一化，模态质量必须为 $1$。时间单位为秒，力单位为牛顿，质量单位为千克，刚度单位为牛顿/米。所有情况下，初始条件均为零。Heaviside 阶跃在 $t=0^+$ 时施加。\n6. 对于每个测试用例，计算：\n   - 顶部自由度 $x_3(t)$ 的峰值绝对位移，单位为米。\n   - 基底反力 $R_\\text{base}(t)$ 的峰值绝对值，单位为牛顿。\n   对于这两个量，计算 MDM 和 MAM 相对于使用所有 $n$ 个模态的全模态参考解的绝对相对误差：\n$$\n\\varepsilon = \\left|\\frac{\\text{approximate peak}}{\\text{reference peak}} - 1\\right|.\n$$\n将这些误差表示为小数（而非百分比），并四舍五入到六位小数。\n\n实现一个程序，为以下测试套件执行上述操作。在每个案例中，指定质量矩阵 $\\mathbf{M}$（对角阵）、刚度参数 $(k_1,k_2,k_3)$、阶跃荷载向量 $\\mathbf{f}_0$、保留的模态数 $r$、在 $(\\omega_1,\\omega_3)$ 处的 Rayleigh 阻尼目标 $(\\zeta_a,\\zeta_b)$、最终时间 $T_\\text{end}$（秒）和均匀时间步长 $\\Delta t$（秒）。\n\n测试套件：\n- 案例 A（基准，轻阻尼，一阶模态截断）：\n  - $\\mathbf{M} = \\mathrm{diag}([1000, 1200, 800])$，单位为千克。\n  - $(k_1,k_2,k_3) = (2.0\\times 10^6, 1.5\\times 10^6, 1.0\\times 10^6)$，单位为牛顿/米。\n  - $\\mathbf{f}_0 = [0, 0, 10000]^\\top$，单位为牛顿。\n  - $r = 1$。\n  - $(\\zeta_a, \\zeta_b) = (0.02, 0.02)$。\n  - $T_\\text{end} = 1.2$ 秒，$\\Delta t = 5.0\\times 10^{-4}$ 秒。\n- 案例 B（较硬系统，一阶模态截断）：\n  - $\\mathbf{M} = \\mathrm{diag}([1000, 1200, 800])$，单位为千克。\n  - $(k_1,k_2,k_3) = (5.0\\times 10^6, 5.0\\times 10^6, 5.0\\times 10^6)$，单位为牛顿/米。\n  - $\\mathbf{f}_0 = [5000, 0, 0]^\\top$，单位为牛顿。\n  - $r = 1$。\n  - $(\\zeta_a, \\zeta_b) = (0.02, 0.02)$。\n  - $T_\\text{end} = 0.6$ 秒，$\\Delta t = 2.0\\times 10^{-4}$ 秒。\n- 案例 C（无阻尼，二阶模态截断）：\n  - $\\mathbf{M} = \\mathrm{diag}([1000, 1200, 800])$，单位为千克。\n  - $(k_1,k_2,k_3) = (2.5\\times 10^6, 1.8\\times 10^6, 1.2\\times 10^6)$，单位为牛顿/米。\n  - $\\mathbf{f}_0 = [0, 8000, 0]^\\top$，单位为牛顿。\n  - $r = 2$。\n  - $(\\zeta_a, \\zeta_b) = (0.0, 0.0)$，即 $\\alpha=\\beta=0$。\n  - $T_\\text{end} = 1.0$ 秒，$\\Delta t = 4.0\\times 10^{-4}$ 秒。\n\n您的程序必须：\n- 对于每个案例，组装 $\\mathbf{M}$ 和 $\\mathbf{K}$，计算全套质量归一化的模态，确定 Rayleigh 阻尼的 $\\alpha$ 和 $\\beta$（案例 C 除外，其中 $\\alpha=\\beta=0$），组装 $\\mathbf{C}$，并使用一致的 Newmark 平均加速度方案，针对给定的 $\\Delta t$ 和 $T_\\text{end}$，对保留集和全集的解耦模态方程进行积分。\n- 仅使用保留的模态重构 MDM 和 MAM 的物理位移时间历程，并使用所有模态计算参考物理位移。\n- 计算 MDM、MAM 和参考解各自的峰值绝对 $x_3(t)$（米）和峰值绝对 $R_\\text{base}(t)=k_1 x_1(t)$（牛顿），然后按规定计算绝对相对误差，四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含每个案例 A、B、C 的：$x_3$ 处的 MDM 位移误差、$x_3$ 处的 MAM 位移误差、MDM 基底反力误差、MAM 基底反力误差。所有值必须是四舍五入到六位小数的小数。例如，输出格式必须是\n$$\n[\\varepsilon^\\text{A}_\\text{MDM,disp},\\varepsilon^\\text{A}_\\text{MAM,disp},\\varepsilon^\\text{A}_\\text{MDM,rxn},\\varepsilon^\\text{A}_\\text{MAM,rxn},\\varepsilon^\\text{B}_\\text{MDM,disp},\\dots,\\varepsilon^\\text{C}_\\text{MAM,rxn}]\n$$\n包含恰好 $12$ 个条目，无额外文本。", "solution": "所提出的问题是结构动力学领域的一个标准的、适定的问题，具体涉及模态分析和模型降阶技术。所有提供的数据、方程和条件在科学上都是合理的、一致的，并且足以得到唯一解。该问题是有效的。\n\n任务是分析一个线性时不变结构系统，并比较两种模态截断方法：模态位移法（MDM）和模态加速度法（MAM）。该系统由二阶矩阵常微分方程控制：\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\,\\mathbf{x}(t) = \\mathbf{f}(t)\n$$\n初始条件为零 $\\mathbf{x}(0) = \\mathbf{0}$ 和 $\\dot{\\mathbf{x}}(0) = \\mathbf{0}$。矩阵 $\\mathbf{M}$ 和 $\\mathbf{K}$ 分别是对称正定的质量矩阵和刚度矩阵。阻尼矩阵 $\\mathbf{C}$ 假定为 Rayleigh 形式，$\\mathbf{C} = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K}$。外部荷载是一个阶跃函数 $\\mathbf{f}(t) = \\mathbf{f}_0\\,H(t)$。\n\n**1. 解耦模态方程的推导**\n\n模态分析的核心是将耦合的物理坐标系 $\\mathbf{x}(t)$ 变换为一组解耦的广义（或模态）坐标 $\\mathbf{q}(t)$。这通过求解无阻尼自由振动的广义特征值问题来实现：\n$$\n\\mathbf{K}\\,\\boldsymbol{\\phi}_j = \\omega_j^2\\,\\mathbf{M}\\,\\boldsymbol{\\phi}_j, \\quad j=1,\\dots,n\n$$\n其中 $\\omega_j$ 是自振圆频率，$\\boldsymbol{\\phi}_j$ 是相应的振型。振型关于 $\\mathbf{M}$ 和 $\\mathbf{K}$ 都是正交的。我们强制进行质量归一化，使得：\n$$\n\\boldsymbol{\\phi}_i^{\\top}\\mathbf{M}\\,\\boldsymbol{\\phi}_j = \\delta_{ij} \\quad (\\text{模态质量为单位1})\n$$\n$$\n\\boldsymbol{\\phi}_i^{\\top}\\mathbf{K}\\,\\boldsymbol{\\phi}_j = \\omega_j^2 \\delta_{ij} \\quad (\\text{模态刚度为 } \\omega_j^2)\n$$\n令 $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1, \\dots, \\boldsymbol{\\phi}_n]$ 为振型矩阵，$\\boldsymbol{\\Omega}^2 = \\mathrm{diag}(\\omega_1^2, \\dots, \\omega_n^2)$ 为频率平方的对角矩阵。坐标变换定义为 $\\mathbf{x}(t) = \\boldsymbol{\\Phi}\\,\\mathbf{q}(t)$。将此代入控制方程：\n$$\n\\mathbf{M}\\,\\boldsymbol{\\Phi}\\,\\ddot{\\mathbf{q}}(t) + \\mathbf{C}\\,\\boldsymbol{\\Phi}\\,\\dot{\\mathbf{q}}(t) + \\mathbf{K}\\,\\boldsymbol{\\Phi}\\,\\mathbf{q}(t) = \\mathbf{f}(t)\n$$\n用 $\\boldsymbol{\\Phi}^{\\top}$ 左乘并应用正交性，得到：\n$$\n\\boldsymbol{\\Phi}^{\\top}\\mathbf{M}\\,\\boldsymbol{\\Phi}\\,\\ddot{\\mathbf{q}}(t) + \\boldsymbol{\\Phi}^{\\top}\\mathbf{C}\\,\\boldsymbol{\\Phi}\\,\\dot{\\mathbf{q}}(t) + \\boldsymbol{\\Phi}^{\\top}\\mathbf{K}\\,\\boldsymbol{\\Phi}\\,\\mathbf{q}(t) = \\boldsymbol{\\Phi}^{\\top}\\mathbf{f}(t)\n$$\n$$\n\\mathbf{I}\\,\\ddot{\\mathbf{q}}(t) + \\mathbf{\\hat{C}}\\,\\dot{\\mathbf{q}}(t) + \\boldsymbol{\\Omega}^2\\,\\mathbf{q}(t) = \\boldsymbol{\\Phi}^{\\top}\\mathbf{f}(t)\n$$\n其中 $\\mathbf{\\hat{C}} = \\boldsymbol{\\Phi}^{\\top}\\mathbf{C}\\,\\boldsymbol{\\Phi}$ 是模态阻尼矩阵。对于 Rayleigh 阻尼，$\\mathbf{C} = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K}$，模态阻尼矩阵变为对角阵：\n$$\n\\mathbf{\\hat{C}} = \\boldsymbol{\\Phi}^{\\top}(\\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K})\\boldsymbol{\\Phi} = \\alpha\\,\\boldsymbol{\\Phi}^{\\top}\\mathbf{M}\\,\\boldsymbol{\\Phi} + \\beta\\,\\boldsymbol{\\Phi}^{\\top}\\mathbf{K}\\,\\boldsymbol{\\Phi} = \\alpha\\,\\mathbf{I} + \\beta\\,\\boldsymbol{\\Omega}^2\n$$\n这得到了一组 $n$ 个解耦的单自由度（SDOF）方程。对于第 $j$ 个模态，方程为：\n$$\n\\ddot{q}_j(t) + (\\alpha + \\beta\\,\\omega_j^2)\\,\\dot{q}_j(t) + \\omega_j^2\\,q_j(t) = \\boldsymbol{\\phi}_j^{\\top}\\mathbf{f}(t)\n$$\n项 $(\\alpha + \\beta\\,\\omega_j^2)$ 等价于 $2\\zeta_j\\omega_j$，其中 $\\zeta_j$ 是第 $j$ 阶模态的模态阻尼比。因此，$\\zeta_j = \\frac{\\alpha}{2\\omega_j} + \\frac{\\beta\\omega_j}{2}$。对于指定的阶跃荷载，每个模态坐标的方程变为：\n$$\n\\ddot{q}_j(t) + 2\\zeta_j\\omega_j\\,\\dot{q}_j(t) + \\omega_j^2\\,q_j(t) = \\boldsymbol{\\phi}_j^{\\top}\\mathbf{f}_0, \\quad \\text{for } t > 0\n$$\n初始条件变换为 $\\mathbf{q}(0) = \\boldsymbol{\\Phi}^{-1}\\mathbf{x}(0) = \\mathbf{0}$ 和 $\\dot{\\mathbf{q}}(0) = \\boldsymbol{\\Phi}^{-1}\\dot{\\mathbf{x}}(0) = \\mathbf{0}$。\n\n**2. 模态位移法（MDM）与模态加速度法（MAM）**\n\n当使用一个包含 $r < n$ 个模态的简化集（通常是频率最低的那些模态）时，我们寻求 $\\mathbf{x}(t)$ 的一个近似解。\n\n**模态位移法（MDM）：**该方法直接截断位移的模态级数展开。近似的物理位移仅由 $r$ 个保留的模态坐标重构：\n$$\n\\mathbf{x}_\\text{MDM}(t) = \\sum_{j=1}^r \\boldsymbol{\\phi}_j q_j(t) = \\boldsymbol{\\Phi}_r \\mathbf{q}_r(t)\n$$\n其中 $\\boldsymbol{\\Phi}_r = [\\boldsymbol{\\phi}_1, \\dots, \\boldsymbol{\\phi}_r]$ 和 $\\mathbf{q}_r(t) = [q_1(t), \\dots, q_r(t)]^\\top$。模态坐标 $q_j(t)$（对于 $j=1, \\dots, r$）是通过对它们各自的 SDOF 方程进行积分得到的。\n\n**模态加速度法（MAM）：**该方法通过包含一个对被截断的高阶模态贡献的静态校正，提供了一个改进的近似。我们首先重写控制方程，以静态方式表达位移：\n$$\n\\mathbf{x}(t) = \\mathbf{K}^{-1}[\\mathbf{f}(t) - \\mathbf{M}\\,\\ddot{\\mathbf{x}}(t) - \\mathbf{C}\\,\\dot{\\mathbf{x}}(t)]\n$$\n项 $\\mathbf{K}^{-1}\\mathbf{f}(t)$ 是伪静态响应。其他项代表由惯性力和阻尼力引起的动力修正。MAM 的关键思想是仅使用保留的 $r$ 个模态来近似这些动力项。\n$$\n\\ddot{\\mathbf{x}}(t) \\approx \\sum_{j=1}^r \\boldsymbol{\\phi}_j \\ddot{q}_j(t), \\quad \\dot{\\mathbf{x}}(t) \\approx \\sum_{j=1}^r \\boldsymbol{\\phi}_j \\dot{q}_j(t)\n$$\n一个更清晰的推导是观察到全位移是 $\\mathbf{x}(t) = \\sum_{j=1}^n \\boldsymbol{\\phi}_j q_j(t)$。我们将其分为保留部分和截断部分：\n$$\n\\mathbf{x}(t) = \\sum_{j=1}^r \\boldsymbol{\\phi}_j q_j(t) + \\sum_{j=r+1}^n \\boldsymbol{\\phi}_j q_j(t)\n$$\nMAM 通过高频截断模态（$j > r$）的静态响应来近似它们的贡献。从模态方程出发，对于高频模态忽略惯性项和阻尼项，得到 $\\omega_j^2 q_j(t) \\approx \\boldsymbol{\\phi}_j^\\top \\mathbf{f}(t)$，因此 $q_j(t) \\approx \\frac{\\boldsymbol{\\phi}_j^\\top \\mathbf{f}(t)}{\\omega_j^2}$。因此，MAM 位移为：\n$$\n\\mathbf{x}_\\text{MAM}(t) \\approx \\sum_{j=1}^r \\boldsymbol{\\phi}_j q_j(t) + \\sum_{j=r+1}^n \\boldsymbol{\\phi}_j \\frac{\\boldsymbol{\\phi}_j^{\\top}\\mathbf{f}(t)}{\\omega_j^2}\n$$\n第二项是截断模态的静态响应。这可以表示为总静态响应与保留模态的静态响应之差：\n$$\n\\sum_{j=r+1}^n \\boldsymbol{\\phi}_j \\frac{\\boldsymbol{\\phi}_j^{\\top}\\mathbf{f}(t)}{\\omega_j^2} = \\mathbf{K}^{-1}\\mathbf{f}(t) - \\sum_{j=1}^r \\boldsymbol{\\phi}_j \\frac{\\boldsymbol{\\phi}_j^{\\top}\\mathbf{f}(t)}{\\omega_j^2}\n$$\n将其代回，我们得到了阶跃荷载 $\\mathbf{f}(t) = \\mathbf{f}_0 H(t)$ 下 MAM 位移的最终表达式：\n$$\n\\mathbf{x}_\\text{MAM}(t) = \\mathbf{K}^{-1}\\mathbf{f}_0 + \\sum_{j=1}^r \\boldsymbol{\\phi}_j \\left( q_j(t) - \\frac{\\boldsymbol{\\phi}_j^{\\top}\\mathbf{f}_0}{\\omega_j^2} \\right)\n$$\n这里，$q_j(t)$ 是第 $j$ 个模态坐标的完整动力解，减去的项是其静态分量。这种公式用高阶模态的静态响应代替了它们的动力响应，这通常是一个显著的改进，尤其是在恢复内力和反力时。\n\n**3. 数值积分**\n\n使用 Newmark 平均加速度法对 SDOF 模态方程进行数值积分。对于此方法，参数为 $\\gamma = 1/2$ 和 $\\beta_{NM} = 1/4$。它对线性系统是无条件稳定的，并且具有二阶精度。在每个时间步 $t_{i+1} = t_i + \\Delta t$，对于每个模态 $j$，给定 $(q_{j,i}, \\dot{q}_{j,i}, \\ddot{q}_{j,i})$，我们求解 $(q_{j,i+1}, \\dot{q}_{j,i+1}, \\ddot{q}_{j,i+1})$。在初始条件 $q_j(0)=0, \\dot{q}_j(0)=0$下，初始加速度为 $\\ddot{q}_j(0) = \\boldsymbol{\\phi}_j^\\top\\mathbf{f}_0$。更新过程在每个时间步中进行，直到 $T_\\text{end}$。\n\n**4. 关注量与误差度量**\n\n对于每种重构方法（MDM、MAM）和全模态参考解，我们计算物理位移 $\\mathbf{x}(t)$ 的时间历程。由此，我们提取两个量：\n- 顶部自由度的位移，$x_3(t)$。\n- 基底反力，$R_\\text{base}(t) = k_1 x_1(t)$。\n\n对于每个量，我们找到其在整个时间历程中的峰值绝对值。然后，一个近似方法（MDM 或 MAM）的绝对相对误差 $\\varepsilon$ 是相对于参考解（使用所有 $n$ 个模态）计算的，公式如下：\n$$\n\\varepsilon = \\left|\\frac{\\text{approximate peak}}{\\text{reference peak}} - 1\\right|\n$$\n下面的程序为指定的测试套件实现了此过程。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for MDM vs. MAM comparison.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"M_diag\": [1000.0, 1200.0, 800.0],\n            \"k_vals\": (2.0e6, 1.5e6, 1.0e6),\n            \"f0\": np.array([0.0, 0.0, 10000.0]),\n            \"r\": 1,\n            \"zetas\": (0.02, 0.02),\n            \"Tend\": 1.2,\n            \"dt\": 5.0e-4,\n        },\n        {\n            \"name\": \"Case B\",\n            \"M_diag\": [1000.0, 1200.0, 800.0],\n            \"k_vals\": (5.0e6, 5.0e6, 5.0e6),\n            \"f0\": np.array([5000.0, 0.0, 0.0]),\n            \"r\": 1,\n            \"zetas\": (0.02, 0.02),\n            \"Tend\": 0.6,\n            \"dt\": 2.0e-4,\n        },\n        {\n            \"name\": \"Case C\",\n            \"M_diag\": [1000.0, 1200.0, 800.0],\n            \"k_vals\": (2.5e6, 1.8e6, 1.2e6),\n            \"f0\": np.array([0.0, 8000.0, 0.0]),\n            \"r\": 2,\n            \"zetas\": (0.0, 0.0),\n            \"Tend\": 1.0,\n            \"dt\": 4.0e-4,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        results = _solve_case(**case)\n        all_results.extend(results)\n\n    # Format the final output as specified.\n    print(f\"[{','.join([f'{r:.6f}' for r in all_results])}]\")\n\n\ndef _solve_case(name, M_diag, k_vals, f0, r, zetas, Tend, dt):\n    \"\"\"\n    Solves a single test case for the modal analysis comparison.\n    \"\"\"\n    n = len(M_diag)\n    M = np.diag(M_diag)\n    k1, k2, k3 = k_vals\n    K = np.array([\n        [k1 + k2, -k2, 0],\n        [-k2, k2 + k3, -k3],\n        [0, -k3, k3]\n    ])\n\n    # 1. Solve the generalized eigenvalue problem K*phi = omega^2*M*phi\n    eigvals, eigvecs = eigh(K, M)\n    omega = np.sqrt(eigvals)\n    \n    # 2. Mass-normalize the eigenvectors\n    Phi = np.zeros_like(eigvecs)\n    for j in range(n):\n        phi_j_un = eigvecs[:, j]\n        norm_factor = np.sqrt(phi_j_un.T @ M @ phi_j_un)\n        Phi[:, j] = phi_j_un / norm_factor\n\n    # 3. Determine Rayleigh damping coefficients alpha and beta\n    zeta_a, zeta_b = zetas\n    if zeta_a == 0.0 and zeta_b == 0.0:\n        alpha, beta = 0.0, 0.0\n    else:\n        # Calibrate using modes 1 and 3 (indices 0 and 2)\n        omega_a, omega_b = omega[0], omega[2]\n        A = np.array([[1, omega_a**2], [1, omega_b**2]])\n        b_vec = np.array([2 * zeta_a * omega_a, 2 * zeta_b * omega_b])\n        alpha, beta = np.linalg.solve(A, b_vec)\n    \n    # 4. Calculate modal damping ratios and modal forces\n    modal_zeta = (alpha / (2 * omega)) + (beta * omega / 2)\n    modal_forces = Phi.T @ f0\n\n    # 5. Time integration using Newmark's average-acceleration method\n    time_steps = np.arange(0, Tend + dt/2, dt)\n    num_steps = len(time_steps)\n    \n    q = np.zeros((n, num_steps))\n    q_dot = np.zeros((n, num_steps))\n    q_ddot = np.zeros((n, num_steps))\n\n    # Initial conditions: q(0) = 0, q_dot(0) = 0\n    # From EOM at t=0: I*q_ddot + C_modal*q_dot + Omega^2*q = F_modal => 1*q_ddot(0) = p\n    q_ddot[:, 0] = modal_forces\n\n    gamma_nm, beta_nm = 0.5, 0.25\n\n    for j in range(n):\n        c_j = 2 * modal_zeta[j] * omega[j]\n        k_j = omega[j]**2\n        p_j = modal_forces[j]\n        \n        # Pre-calculate constant denominator for acceleration update\n        denom = 1 + c_j * gamma_nm * dt + k_j * beta_nm * dt**2\n        \n        for i in range(num_steps - 1):\n            # Predictors (for average acceleration method)\n            q_pred = q[j, i] + dt * q_dot[j, i] + (dt**2 / 4) * q_ddot[j, i]\n            q_dot_pred = q_dot[j, i] + (dt / 2) * q_ddot[j, i]\n            \n            # Solve for acceleration at t_{i+1}\n            q_ddot[j, i+1] = (p_j - c_j * q_dot_pred - k_j * q_pred) / denom\n            \n            # Correctors\n            q_dot[j, i+1] = q_dot_pred + gamma_nm * dt * q_ddot[j, i+1]\n            q[j, i+1] = q_pred + beta_nm * dt**2 * q_ddot[j, i+1]\n\n    # 6. Reconstruct physical responses\n    # Reference solution (all modes)\n    x_ref = Phi @ q\n\n    # MDM solution (r modes)\n    Phi_r = Phi[:, :r]\n    q_r = q[:r, :]\n    x_mdm = Phi_r @ q_r\n\n    # MAM solution (r modes)\n    K_inv_f0 = np.linalg.solve(K, f0).reshape(-1, 1)\n    mam_dynamic_part = np.zeros((n, num_steps))\n    for j in range(r):\n        q_j_static = modal_forces[j] / omega[j]**2\n        mam_dynamic_part += Phi[:, j:j+1] @ (q_r[j:j+1, :] - q_j_static)\n    x_mam = K_inv_f0 + mam_dynamic_part\n\n    # 7. Calculate peak values and relative errors\n    # Peak displacement at x3 (DOF 3, index 2)\n    peak_x3_ref = np.max(np.abs(x_ref[2, :]))\n    peak_x3_mdm = np.max(np.abs(x_mdm[2, :]))\n    peak_x3_mam = np.max(np.abs(x_mam[2, :]))\n\n    err_disp_mdm = abs(peak_x3_mdm / peak_x3_ref - 1)\n    err_disp_mam = abs(peak_x3_mam / peak_x3_ref - 1)\n\n    # Peak base reaction R_base = k1 * x1 (DOF 1, index 0)\n    R_ref = k1 * x_ref[0, :]\n    R_mdm = k1 * x_mdm[0, :]\n    R_mam = k1 * x_mam[0, :]\n\n    peak_R_ref = np.max(np.abs(R_ref))\n    peak_R_mdm = np.max(np.abs(R_mdm))\n    peak_R_mam = np.max(np.abs(R_mam))\n\n    err_rxn_mdm = abs(peak_R_mdm / peak_R_ref - 1)\n    err_rxn_mam = abs(peak_R_mam / peak_R_ref - 1)\n\n    return [err_disp_mdm, err_disp_mam, err_rxn_mdm, err_rxn_mam]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2578761"}]}