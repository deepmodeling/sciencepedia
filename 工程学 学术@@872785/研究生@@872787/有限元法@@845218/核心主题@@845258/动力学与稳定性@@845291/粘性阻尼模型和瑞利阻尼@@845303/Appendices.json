{"hands_on_practices": [{"introduction": "本节的第一个练习是一个基础性的演练。我们将分析一个简单的双自由度系统，进行模态分析，然后校准瑞利阻尼系数 $\\alpha$ 和 $\\beta$，以在系统的前两个模态中实现特定的阻尼比。这个实践将理论参数与可观测的动力学行为联系起来，帮助你掌握瑞利阻尼在多自由度系统中的基本应用方法。[@problem_id:2610995]", "problem": "考虑一个在有限元法 (FEM) 框架下建模的两自由度 (2-DOF) 线性质量-弹簧系统，该系统由两个串联的质点组成：质量 $1$ 通过刚度为 $k_1$ 的线性弹簧连接到地面，质量 $1$ 和质量 $2$ 通过刚度为 $k_2$ 的线性弹簧连接，质量 $2$ 没有直接接地支撑。假设位移为小位移且系统表现为线性行为。质量矩阵为对角矩阵，其元素等于集中质量。在物理坐标下，组装后的无阻尼运动方程形式为 $M \\ddot{u} + K u = 0$，而计入线性粘性阻尼后，方程变为 $M \\ddot{u} + C \\dot{u} + K u = 0$。假设阻尼为比例 (Rayleigh) 形式 $C = \\alpha M + \\beta K$。系统数据为 $m_1 = m_2 = 1\\ \\mathrm{kg}$，$k_1 = 1000\\ \\mathrm{N/m}$，$k_2 = 2000\\ \\mathrm{N/m}$。\n\n任务：\n- 从第一性原理出发，组装 $2\\times 2$ 的质量矩阵 $M$ 和刚度矩阵 $K$，并建立无阻尼自由振动特征问题。求解无阻尼固有频率 $\\omega_1$ 和 $\\omega_2$。\n- 标定 Rayleigh 阻尼系数 $(\\alpha,\\beta)$，使得第一阶和第二阶模态阻尼比分别为 $\\zeta_1 = 0.02$ 和 $\\zeta_2 = 0.05$。推导过程应基于比例阻尼下阻尼方程在模态坐标中的解耦，以及模态阻尼比的定义。\n- 为验证时域衰减，考虑一个初值问题，其中 $u(0)$ 等于第一阶质量归一化特征向量，并进行缩放，使得自由度 $1$ 在 $t=0$ 时的位移为 $1\\ \\mathrm{mm}$，且 $\\dot{u}(0)=0$。利用比例阻尼和正交性所支持的单模态近似，推导在此初始条件下 $u_1(t)$ 的解析形式，并确定 $u_1(t)$ 的前两个连续正向峰值的绝对值之比 $r$，即 $r = |u_1(t_{p,1})|/|u_1(t_{p,2})|$。\n\n仅报告 $r$ 的值，形式为无量纲小数，并四舍五入到 $4$ 位有效数字。", "solution": "在尝试任何解答之前，首先对问题陈述的有效性进行严格评估。\n\n### 步骤 1：提取已知条件\n- 系统：一个两自由度 (2-DOF) 线性质量-弹簧系统。\n- 质量矩阵 ($M$)：对角矩阵，其元素等于集中质量。\n- 阻尼矩阵 ($C$)：比例 (Rayleigh) 形式，$C = \\alpha M + \\beta K$。\n- 质量值：$m_1 = 1\\ \\mathrm{kg}$，$m_2 = 1\\ \\mathrm{kg}$。\n- 刚度值：$k_1 = 1000\\ \\mathrm{N/m}$，$k_2 = 2000\\ \\mathrm{N/m}$。\n- 模态阻尼比：$\\zeta_1 = 0.02$，$\\zeta_2 = 0.05$。\n- 初始条件 (IC)：$u(0)$ 为第一阶质量归一化特征向量，经缩放后使得 $u_1(0) = 1\\ \\mathrm{mm} = 0.001\\ \\mathrm{m}$，且 $\\dot{u}(0)=0$。\n- 要求输出：位移 $u_1(t)$ 的前两个连续正向峰值的绝对值之比 $r = |u_1(t_{p,1})|/|u_1(t_{p,2})|$，四舍五入到 $4$ 位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是结构动力学中的一个标准练习，具体涉及多自由度系统、模态分析和 Rayleigh 阻尼。\n- **科学依据：** 该问题基于经典力学和线性系统理论的基本原理。其模型和参数对于一个小型机械系统是物理上现实的。\n- **良态问题：** 该问题是自洽的，提供了确定所求值 $r$ 的唯一解所需的所有数据和条件。各项任务逻辑顺序清晰。\n- **客观性：** 问题陈述使用了该领域精确、标准的术语。术语使用基本准确，足以进行明确的物理解释。\n\n### 步骤 3：结论与行动\n该问题被判定为 **有效**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n\n分析按照问题陈述中所划分的三个阶段进行。\n\n**1. 系统矩阵与无阻尼特征问题**\n\n首先，组装该两自由度系统的质量矩阵 $M$ 和刚度矩阵 $K$。\n质量块的位置由位移向量 $u = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ 表示。\n质量矩阵被指定为对角（集中）矩阵，其中 $m_1=1$，$m_2=1$：\n$$ M = \\begin{pmatrix} m_1  0 \\\\ 0  m_2 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\n刚度矩阵 $K$ 由弹簧施加的力推导得出。力向量 $F$ 为 $F = -Ku$。\n作用在质量 $1$ 上的力：$F_1 = -k_1 u_1 - k_2(u_1-u_2) = -(k_1+k_2)u_1 + k_2 u_2$。\n作用在质量 $2$ 上的力：$F_2 = -k_2(u_2-u_1) = k_2 u_1 - k_2 u_2$。\n由此，刚度矩阵为：\n$$ K = \\begin{pmatrix} k_1+k_2  -k_2 \\\\ -k_2  k_2 \\end{pmatrix} $$\n代入给定的刚度值 $k_1 = 1000\\ \\mathrm{N/m}$ 和 $k_2 = 2000\\ \\mathrm{N/m}$：\n$$ K = \\begin{pmatrix} 3000  -2000 \\\\ -2000  2000 \\end{pmatrix} $$\n无阻尼自由振动特征问题为 $(K - \\omega^2 M)\\phi = 0$。我们通过求解特征方程 $\\det(K-\\lambda M)=0$ 的根来求解固有频率的平方 $\\lambda = \\omega^2$。由于 $M$ 是单位矩阵，这简化为 $\\det(K-\\lambda I)=0$。\n$$ \\det \\begin{pmatrix} 3000-\\lambda  -2000 \\\\ -2000  2000-\\lambda \\end{pmatrix} = 0 $$\n$$ (3000-\\lambda)(2000-\\lambda) - (-2000)^2 = 0 $$\n$$ \\lambda^2 - 5000\\lambda + 6 \\times 10^6 - 4 \\times 10^6 = 0 $$\n$$ \\lambda^2 - 5000\\lambda + 2 \\times 10^6 = 0 $$\n使用二次公式求得 $\\lambda$ 的解：\n$$ \\lambda = \\frac{5000 \\pm \\sqrt{5000^2 - 4(1)(2 \\times 10^6)}}{2} = \\frac{5000 \\pm \\sqrt{25 \\times 10^6 - 8 \\times 10^6}}{2} = \\frac{5000 \\pm \\sqrt{17 \\times 10^6}}{2} $$\n$$ \\lambda = 2500 \\pm 500\\sqrt{17} $$\n两个固有频率的平方为 $\\lambda_1 = \\omega_1^2$ 和 $\\lambda_2 = \\omega_2^2$。按照惯例，$\\omega_1  \\omega_2$。\n$$ \\omega_1^2 = 2500 - 500\\sqrt{17} \\quad (\\text{rad/s})^2 $$\n$$ \\omega_2^2 = 2500 + 500\\sqrt{17} \\quad (\\text{rad/s})^2 $$\n\n**2. 比例阻尼标定**\n\n阻尼为 Rayleigh 形式 $C = \\alpha M + \\beta K$。对于这种比例阻尼，有阻尼运动方程在模态坐标基下解耦。第 $i$ 阶模态的模态阻尼比 $\\zeta_i$ 由以下关系式给出：\n$$ 2\\zeta_i\\omega_i = \\alpha + \\beta\\omega_i^2 $$\n或者等价地，\n$$ \\zeta_i = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2} $$\n问题给出了 $\\zeta_1 = 0.02$ 和 $\\zeta_2 = 0.05$。我们得到一个关于系数 $\\alpha$ 和 $\\beta$ 的二元线性方程组：\n$$ \\begin{pmatrix} 1  \\omega_1^2 \\\\ 1  \\omega_2^2 \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} 2\\omega_1\\zeta_1 \\\\ 2\\omega_2\\zeta_2 \\end{pmatrix} $$\n由于 $\\omega_1^2 \\neq \\omega_2^2$，该方程组对于 $(\\alpha, \\beta)$ 有唯一解。这证实了指定的模态阻尼比可以通过 Rayleigh 阻尼模型实现，从而证明了在后续任务中使用单模态分析的合理性。最终答案不需要 $\\alpha$ 和 $\\beta$ 的显式值。\n\n**3. 时域响应与峰值比**\n\n系统受到初始条件 $u(0) = c_1\\phi_1$ 和 $\\dot{u}(0)=0$ 的作用，其中 $\\phi_1$ 是第一阶质量归一化特征向量，$c_1$ 是一个缩放常数。因为初始位移与单一模态振型成正比且初始速度为零，所以只有该模态会被激励。所有其他的模态坐标 $q_i(t)$（对于 $i  1$）在所有时间 $t$ 都将为零。因此，响应完全由第一阶模态的贡献给出：\n$$ u(t) = \\phi_1 q_1(t) $$\n第一阶模态坐标 $q_1(t)$ 的运动方程是一个单自由度系统的方程：\n$$ \\ddot{q}_1(t) + 2\\zeta_1\\omega_1 \\dot{q}_1(t) + \\omega_1^2 q_1(t) = 0 $$\n通过将物理初始条件投影到模态基上，可以找到 $q_1(t)$ 的初始条件：\n$$ q_1(0) = \\phi_1^T M u(0) = \\phi_1^T M (c_1\\phi_1) = c_1(\\phi_1^T M \\phi_1) = c_1 $$\n最后一步是根据质量归一化条件 $\\phi_1^T M \\phi_1 = 1$ 得出的。\n$$ \\dot{q}_1(0) = \\phi_1^T M \\dot{u}(0) = \\phi_1^T M (0) = 0 $$\n初始位移为 $q_1(0)$、初始速度为零的单自由度 (SDOF) 方程的解为：\n$$ q_1(t) = q_1(0) e^{-\\zeta_1\\omega_1 t} \\left(\\cos(\\omega_{d1}t) + \\frac{\\zeta_1}{\\sqrt{1-\\zeta_1^2}}\\sin(\\omega_{d1}t)\\right) $$\n其中 $\\omega_{d1} = \\omega_1\\sqrt{1-\\zeta_1^2}$ 是有阻尼固有频率。\n第一个质量块的位移 $u_1(t)$ 是 $u(t)$ 的第一个分量：\n$$ u_1(t) = \\phi_{11} q_1(t) = \\phi_{11} q_1(0) e^{-\\zeta_1\\omega_1 t} \\left(\\dots\\right) $$\n从初始条件可知 $u_1(0) = \\phi_{11} q_1(0) = 0.001\\ \\mathrm{m}$。因此：\n$$ u_1(t) = u_1(0) e^{-\\zeta_1\\omega_1 t} \\left(\\cos(\\omega_{d1}t) + \\frac{\\zeta_1}{\\sqrt{1-\\zeta_1^2}}\\sin(\\omega_{d1}t)\\right) $$\n对于初始速度为零的特定情况，响应的极值（峰值和谷值）出现在 $\\sin(\\omega_{d1}t)=0$ 的时刻，即 $t = \\frac{n\\pi}{\\omega_{d1}}$（其中 $n=0, 1, 2, \\dots$ 为整数）。\n在 $t=0$ ($n=0$) 时，我们有 $u_1(0)=0.001 > 0$ 且 $\\dot{u}_1(0)=0$。二阶导数 $\\ddot{u}_1(0)  0$，证实这是一个局部最大值。因此，第一个正向峰值出现在 $t_{p,1} = 0$，其幅值为 $|u_1(t_{p,1})| = u_1(0) = 0.001$。\n下一个峰值出现在 $n=1$，即 $t=\\pi/\\omega_{d1}$。此时，$\\cos(\\omega_{d1}t) = \\cos(\\pi)=-1$，对应一个负向峰值。\n下一个正向峰值出现在 $n=2$，即 $t_{p,2} = \\frac{2\\pi}{\\omega_{d1}}$。此时，$\\cos(\\omega_{d1}t_{p,2}) = \\cos(2\\pi) = 1$ 且 $\\sin(\\omega_{d1}t_{p,2}) = \\sin(2\\pi) = 0$。\n第二个正向峰值的幅值为：\n$$ |u_1(t_{p,2})| = \\left| u_1(0) e^{-\\zeta_1\\omega_1 t_{p,2}} (\\cos(2\\pi)+0) \\right| = u_1(0) e^{-\\zeta_1\\omega_1 \\frac{2\\pi}{\\omega_{d1}}} $$\n所要求的比值 $r$ 为：\n$$ r = \\frac{|u_1(t_{p,1})|}{|u_1(t_{p,2})|} = \\frac{u_1(0)}{u_1(0) \\exp\\left(-\\frac{2\\pi\\zeta_1\\omega_1}{\\omega_{d1}}\\right)} = \\exp\\left(\\frac{2\\pi\\zeta_1\\omega_1}{\\omega_{d1}}\\right) $$\n代入 $\\omega_{d1} = \\omega_1\\sqrt{1-\\zeta_1^2}$：\n$$ r = \\exp\\left(\\frac{2\\pi\\zeta_1\\omega_1}{\\omega_1\\sqrt{1-\\zeta_1^2}}\\right) = \\exp\\left(\\frac{2\\pi\\zeta_1}{\\sqrt{1-\\zeta_1^2}}\\right) $$\n这个指数 $\\delta = \\frac{2\\pi\\zeta_1}{\\sqrt{1-\\zeta_1^2}}$ 是对数衰减率。\n给定 $\\zeta_1=0.02$。我们代入这个值来获得数值答案。\n$$ r = \\exp\\left(\\frac{2\\pi(0.02)}{\\sqrt{1-(0.02)^2}}\\right) = \\exp\\left(\\frac{0.04\\pi}{\\sqrt{1-0.0004}}\\right) = \\exp\\left(\\frac{0.04\\pi}{\\sqrt{0.9996}}\\right) $$\n$$ r \\approx \\exp\\left(\\frac{0.1256637}{0.99979998}\\right) \\approx \\exp(0.12569135) \\approx 1.1339304 $$\n将结果四舍五入到 $4$ 位有效数字，我们得到 $r = 1.134$。", "answer": "$$\\boxed{1.134}$$", "id": "2610995"}, {"introduction": "虽然瑞利阻尼模型在工程中应用广泛，但它也存在显著的局限性。本练习旨在揭示其最关键的弱点之一：“阻尼凹陷”现象。通过尝试在频率相差较远的模态上设定统一的阻尼比，我们将看到该模型如何不可避免地导致中间频率的模态阻尼不足。这对于宽频带动力学分析是一个至关重要的考量。[@problem_id:2610929]", "problem": "一个通过有限元法（FEM）建立的三自由度结构模型，在无阻尼情况下进行了模态分析，得到了以下固有圆频率：$\\omega_{1} = 10 \\ \\text{rad/s}$，$\\omega_{2} = 100 \\ \\text{rad/s}$，以及 $\\omega_{3} = 1000 \\ \\text{rad/s}$。假设阻尼矩阵为比例阻尼（Rayleigh阻尼），即 $\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}$，其中 $\\mathbf{M}$ 和 $\\mathbf{K}$ 分别是组合后的质量矩阵和刚度矩阵，而 $\\alpha$ 和 $\\beta$ 是待选的标量。您需要选择 $\\alpha$ 和 $\\beta$，使得第1阶和第3阶模态的模态阻尼比均等于 $\\zeta_{0} = 0.05$。仅使用线性振动和比例阻尼的基本原理，确定中间模态在 $\\omega_{2} = 100 \\ \\text{rad/s}$ 时所产生的阻尼比 $\\zeta_{2}$。将您的答案四舍五入到四位有效数字，并以不带单位的小数形式报告。该计算必须明确地证明，当特征频率分布不均匀时，在两个模态上匹配 $\\zeta$ 并不能保证中间模态具有可接受的阻尼。", "solution": "所述问题是有效的。其科学基础在于线性结构动力学原理，提法恰当，信息充分，可得到唯一解，并且用客观、明确的语言表达。我们现在开始进行正式推导。\n\n对于无阻尼固有圆频率 $\\omega_i$，第 $i$ 阶模态的模态阻尼比 $\\zeta_i$ 与 Rayleigh 阻尼系数 $\\alpha$ 和 $\\beta$ 之间的基本关系由下式给出：\n$$2\\zeta_i\\omega_i = \\alpha + \\beta\\omega_i^2$$\n这可以表示为阻尼比的形式：\n$$\\zeta_i = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2}$$\n问题给出了一个三自由度系统的固有频率：$\\omega_1 = 10 \\ \\text{rad/s}$，$\\omega_2 = 100 \\ \\text{rad/s}$，以及 $\\omega_3 = 1000 \\ \\text{rad/s}$。\n必须选择阻尼系数 $\\alpha$ 和 $\\beta$，使得第一和第三模态的阻尼比等于目标值 $\\zeta_0 = 0.05$。\n这为我们提供了关于两个未知数 $\\alpha$ 和 $\\beta$ 的一个二元线性方程组：\n对于模态1：\n$$\\zeta_1 = \\zeta_0 = \\frac{\\alpha}{2\\omega_1} + \\frac{\\beta\\omega_1}{2} \\implies 2\\zeta_0\\omega_1 = \\alpha + \\beta\\omega_1^2$$\n对于模态3：\n$$\\zeta_3 = \\zeta_0 = \\frac{\\alpha}{2\\omega_3} + \\frac{\\beta\\omega_3}{2} \\implies 2\\zeta_0\\omega_3 = \\alpha + \\beta\\omega_3^2$$\n我们可以以符号方式求解该方程组。第二个方程减去第一个方程，得到：\n$$2\\zeta_0\\omega_3 - 2\\zeta_0\\omega_1 = (\\alpha + \\beta\\omega_3^2) - (\\alpha + \\beta\\omega_1^2)$$\n$$2\\zeta_0(\\omega_3 - \\omega_1) = \\beta(\\omega_3^2 - \\omega_1^2) = \\beta(\\omega_3 - \\omega_1)(\\omega_3 + \\omega_1)$$\n因为 $\\omega_3 \\neq \\omega_1$，我们可以两边同除以 $(\\omega_3 - \\omega_1)$ 来求得 $\\beta$：\n$$\\beta = \\frac{2\\zeta_0}{\\omega_1 + \\omega_3}$$\n现在，我们将这个 $\\beta$ 的表达式代回第一个方程以求解 $\\alpha$：\n$$\\alpha = 2\\zeta_0\\omega_1 - \\beta\\omega_1^2 = 2\\zeta_0\\omega_1 - \\left(\\frac{2\\zeta_0}{\\omega_1 + \\omega_3}\\right)\\omega_1^2$$\n$$\\alpha = 2\\zeta_0 \\left( \\omega_1 - \\frac{\\omega_1^2}{\\omega_1 + \\omega_3} \\right) = 2\\zeta_0 \\left( \\frac{\\omega_1(\\omega_1 + \\omega_3) - \\omega_1^2}{\\omega_1 + \\omega_3} \\right) = 2\\zeta_0 \\frac{\\omega_1^2 + \\omega_1\\omega_3 - \\omega_1^2}{\\omega_1 + \\omega_3}$$\n$$\\alpha = 2\\zeta_0 \\frac{\\omega_1\\omega_3}{\\omega_1 + \\omega_3}$$\n我们现在代入给定的数值：$\\zeta_0 = 0.05$，$\\omega_1 = 10 \\ \\text{rad/s}$，$\\omega_3 = 1000 \\ \\text{rad/s}$。\n$$\\beta = \\frac{2(0.05)}{10 + 1000} = \\frac{0.1}{1010} = \\frac{1}{10100}$$\n$$\\alpha = 2(0.05) \\frac{10 \\cdot 1000}{10 + 1000} = (0.1) \\frac{10000}{1010} = \\frac{1000}{1010} = \\frac{100}{101}$$\n在确定了系数 $\\alpha = \\frac{100}{101}$ 和 $\\beta = \\frac{1}{10100}$ 之后，我们可以计算频率为 $\\omega_2 = 100 \\ \\text{rad/s}$ 的中间模态的阻尼比 $\\zeta_2$：\n$$\\zeta_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2}$$\n$$\\zeta_2 = \\frac{100/101}{2(100)} + \\frac{(1/10100)(100)}{2} = \\frac{1}{2 \\cdot 101} + \\frac{100}{2 \\cdot 10100} = \\frac{1}{202} + \\frac{1}{202}$$\n$$\\zeta_2 = \\frac{2}{202} = \\frac{1}{101}$$\n问题要求将此答案表示为小数并四舍五入到四位有效数字。\n$$\\zeta_2 = \\frac{1}{101} \\approx 0.00990099...$$\n四舍五入到四位有效数字得到 $0.009901$。\n\n该结果明确地展示了标准Rayleigh阻尼模型的关键弱点。阻尼比函数 $\\zeta(\\omega) = \\frac{\\alpha}{2\\omega} + \\frac{\\beta\\omega}{2}$ 是通过在两个频率 $\\omega_1$ 和 $\\omega_3$ 上匹配期望的阻尼 $\\zeta_0$ 来定义的。该函数表示了质量比例阻尼（$\\frac{1}{\\omega}$ 项，在低频时占主导地位）和刚度比例阻尼（$\\omega$ 项，在高频时占主导地位）的叠加。该函数在频率 $\\omega_{min}$ 处出现最小值，在该频率处其导数为零：\n$$\\frac{d\\zeta}{d\\omega} = -\\frac{\\alpha}{2\\omega^2} + \\frac{\\beta}{2} = 0 \\implies \\omega_{min} = \\sqrt{\\frac{\\alpha}{\\beta}}$$\n使用我们计算出的系数：\n$$\\omega_{min} = \\sqrt{\\frac{100/101}{1/10100}} = \\sqrt{\\frac{100 \\cdot 10100}{101}} = \\sqrt{100 \\cdot 100} = 100 \\ \\text{rad/s}$$\n该计算揭示了中间频率 $\\omega_2 = 100 \\ \\text{rad/s}$ 恰好是阻尼发生最小值的频率。这并非巧合；它是频率呈对数间隔分布（即 $\\omega_2 = \\sqrt{\\omega_1 \\omega_3}$）的直接结果。此最小值处的阻尼为 $\\zeta_{min} = \\sqrt{\\alpha\\beta} = \\sqrt{\\frac{100}{101} \\cdot \\frac{1}{10100}} = \\frac{1}{101}$。$\\zeta_2$ 的值显著低于 $\\zeta_0$，这一现象被称为“阻尼凹陷”（damping sag）。这说明，当模态频率间隔很大时，使用简单的双参数Rayleigh模型在整个频谱范围内实现均匀的阻尼水平是不可能的。该模型必然会对中间模态产生阻尼不足。", "answer": "$$\\boxed{0.009901}$$", "id": "2610929"}, {"introduction": "将理论知识转化为实际的计算实现是研究生阶段的一项核心技能。本练习要求你设计一个计算单元测试。你将从第一性原理出发，验证一个瑞利阻尼系统在模态坐标下是否正确解耦，并检验其模态阻尼比是否与理论预测相符。这个过程将连接解析公式与稳健的软件验证，加深你对模型计算特性的理解。[@problem_id:2610986]", "problem": "给定一个线性、无阻尼、三自由度 ($3$-DOF) 的质量-弹簧有限元模型，该模型由三个相同的集总质量通过相同的线性弹簧串联而成，两端的质量连接到固定支座上。设位移向量为 $\\mathbf{x}(t) \\in \\mathbb{R}^3$。质量矩阵为 $\\mathbf{M} = m \\mathbf{I}$，其中标量质量 $m \\gt 0$；刚度矩阵为对称三对角矩阵\n$$\n\\mathbf{K} = k \\begin{bmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{bmatrix},\n$$\n其中标量弹簧常数 $k \\gt 0$。假设采用由瑞利阻尼（Rayleigh damping）建模的 Kelvin-Voigt 线性粘性阻尼，即阻尼矩阵为\n$$\n\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K},\n$$\n其中瑞利系数 $\\alpha \\ge 0$ (单位为 $\\mathrm{s}^{-1}$) 且 $\\beta \\ge 0$ (单位为 $\\mathrm{s}$)。运动方程为\n$$\n\\mathbf{M}\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\mathbf{x}(t) = \\mathbf{0}.\n$$\n\n您的任务是设计一个自动化单元测试，用于验证此 $3$-DOF 基准问题中瑞利阻尼实现的两个属性：\n\n- 模态解耦：在由无阻尼问题的广义特征向量定义的模态基中，变换后的阻尼矩阵是（在数值公差范围内）对角矩阵，这意味着有阻尼运动方程解耦为独立的标量模态方程。\n\n- 正确的模态阻尼比：对于每个模态 $n$，由瑞利阻尼理论预测的模态阻尼比 $\\zeta_n$ 必须与通过变换得到的模态阻尼矩阵对角线元素测得的模态阻尼比相匹配。\n\n仅从以下基本原理出发：\n\n- 将牛顿第二定律应用于线性有限元半离散化，得到上述二阶常微分方程组。\n\n- 用于无阻尼自由振动的广义对称定特征值问题，该问题确定了固有频率和振型：\n$$\n\\mathbf{K}\\boldsymbol{\\phi}_n = \\omega_n^2 \\mathbf{M} \\boldsymbol{\\phi}_n,\n$$\n其中固有频率 $\\omega_n$ 为实数且为正，振型 $\\boldsymbol{\\phi}_n$ 为实数，并选择满足 $\\boldsymbol{\\Phi}^\\mathsf{T}\\mathbf{M}\\boldsymbol{\\Phi} = \\mathbf{I}$，其中模态矩阵 $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1\\ \\boldsymbol{\\phi}_2\\ \\boldsymbol{\\phi}_3]$。\n\n仅基于这些原理，且不使用简化公式，推导所需的表达式以 (i) 证明在瑞利阻尼下实现模态解耦，以及 (ii) 计算理论模态阻尼比 $\\zeta_n$ 以便与从变换后的阻尼矩阵中识别出的值进行比较。\n\n然后实现一个程序，对下面的每个测试用例执行以下操作：\n\n1.  根据提供的参数 $(m,k,\\alpha,\\beta)$（以国际单位制 (SI) 指定：$m$ 单位为 $\\mathrm{kg}$，$k$ 单位为 $\\mathrm{N}/\\mathrm{m}$，$\\alpha$ 单位为 $\\mathrm{s}^{-1}$，$\\beta$ 单位为 $\\mathrm{s}$）构建 $\\mathbf{M}$、$\\mathbf{K}$ 和 $\\mathbf{C}$。\n\n2.  求解 $(\\mathbf{K},\\mathbf{M})$ 的广义对称定特征值问题，以获得固有频率 $\\omega_n$ 和一个 $\\mathbf{M}$-正交的模态矩阵 $\\boldsymbol{\\Phi}$。\n\n3.  构建模态阻尼矩阵 $\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi}$，并检查其非对角线元素绝对值的最大值是否低于公差 $\\tau_\\mathrm{off} = 10^{-9}$。如果最大绝对非对角线值小于 $\\tau_\\mathrm{off}$，则声明“解耦已验证”。\n\n4.  对于每个模态，仅使用推导出的关系式计算瑞利阻尼所蕴含的理论模态阻尼比 $\\zeta_n$，并将其与从 $\\mathbf{C}_\\mathrm{modal}$ 的对角线元素和固有频率 $\\omega_n$ 获得的“测量”模态阻尼比进行比较。如果所有模态的最大绝对差值小于公差 $\\tau_\\zeta = 10^{-9}$，则声明阻尼比“正确”。\n\n5.  当且仅当“解耦已验证”和“阻尼比正确”两个条件都成立时，为该测试用例返回布尔值 $true$；否则返回 $false$。\n\n使用以下参数集 $(m,k,\\alpha,\\beta)$ 的测试套件：\n\n- 测试 $1$：$(m,k,\\alpha,\\beta) = (2.0,1000.0,0.4,0.0008)$。\n\n- 测试 $2$：$(m,k,\\alpha,\\beta) = (1.0,1000.0,0.2,0.0)$。\n\n- 测试 $3$：$(m,k,\\alpha,\\beta) = (1.0,1200.0,0.0,0.001)$。\n\n- 测试 $4$：$(m,k,\\alpha,\\beta) = (1.5,500.0,0.1,0.002)$。\n\n所有计算必须在国际单位制（SI）下进行；然而，最终输出是无单位的布尔值。您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，“[true,true,false]”），但要使用编程语言的规范布尔文字。\n\n预期的输出类型是一个布尔值列表，每个测试用例对应一个，顺序与列表顺序相同。不需要用户输入；程序必须按原样运行至完成并打印单行结果。", "solution": "该问题要求推导瑞利阻尼在一个特定的三自由度 ($3$-DOF) 系统背景下的基本性质，并随后实现一个数值验证测试。推导过程必须从第一性原理出发。\n\n设系统的运动方程为\n$$\n\\mathbf{M}\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\mathbf{x}(t) = \\mathbf{0}\n$$\n其中 $\\mathbf{x}(t) \\in \\mathbb{R}^3$ 是位移向量，$\\mathbf{M}$、$\\mathbf{C}$ 和 $\\mathbf{K}$ 分别是质量、阻尼和刚度矩阵。\n\n无阻尼自由振动由广义特征值问题控制：\n$$\n\\mathbf{K}\\boldsymbol{\\phi}_n = \\omega_n^2 \\mathbf{M} \\boldsymbol{\\phi}_n\n$$\n其中 $\\omega_n$ 是固有频率，$\\boldsymbol{\\phi}_n$ 是模态 $n=1, 2, 3$ 的振型。振型可以组合成一个模态矩阵 $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1, \\boldsymbol{\\phi}_2, \\boldsymbol{\\phi}_3]$。我们已知这些振型被选择为 $\\mathbf{M}$-正交的，这意味着\n$$\n\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi} = \\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是 $3 \\times 3$ 的单位矩阵。\n\n物理坐标 $\\mathbf{x}(t)$ 可以通过变换用模态坐标 $\\mathbf{q}(t)=[q_1(t), q_2(t), q_3(t)]^\\mathsf{T}$ 表示\n$$\n\\mathbf{x}(t) = \\boldsymbol{\\Phi}\\mathbf{q}(t)\n$$\n将此代入运动方程，并左乘 $\\boldsymbol{\\Phi}^\\mathsf{T}$，得到模态坐标下的方程：\n$$\n(\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi}) \\ddot{\\mathbf{q}}(t) + (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi}) \\dot{\\mathbf{q}}(t) + (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi}) \\mathbf{q}(t) = \\mathbf{0}\n$$\n这是一个由模态矩阵 $\\mathbf{M}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi}$、$\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi}$ 和 $\\mathbf{K}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi}$ 控制的耦合方程组。\n\n根据定义，模态质量矩阵是 $\\mathbf{M}_\\mathrm{modal} = \\mathbf{I}$。\n为了确定模态刚度矩阵，我们将所有模态的特征值问题统一写为 $\\mathbf{K}\\boldsymbol{\\Phi} = \\mathbf{M}\\boldsymbol{\\Phi}\\boldsymbol{\\Omega}^2$，其中 $\\boldsymbol{\\Omega}^2 = \\mathrm{diag}(\\omega_1^2, \\omega_2^2, \\omega_3^2)$。左乘 $\\boldsymbol{\\Phi}^\\mathsf{T}$ 得：\n$$\n\\mathbf{K}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi} = \\boldsymbol{\\Phi}^\\mathsf{T} (\\mathbf{M}\\boldsymbol{\\Phi}\\boldsymbol{\\Omega}^2) = (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi})\\boldsymbol{\\Omega}^2 = \\mathbf{I}\\boldsymbol{\\Omega}^2 = \\boldsymbol{\\Omega}^2\n$$\n模态刚度矩阵是对角的，这证实了方程在刚度方面是解耦的。\n\n核心任务是分析模态阻尼矩阵 $\\mathbf{C}_\\mathrm{modal}$。问题指定了瑞利阻尼，其中阻尼矩阵 $\\mathbf{C}$ 是质量和刚度矩阵的线性组合：\n$$\n\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}\n$$\n其中 $\\alpha$ 和 $\\beta$ 为标量系数。\n\n**第一部分 (i)：模态解耦验证**\n为了证明瑞利阻尼导致模态解耦，我们计算模态阻尼矩阵 $\\mathbf{C}_\\mathrm{modal}$：\n$$\n\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi} = \\boldsymbol{\\Phi}^\\mathsf{T} (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\boldsymbol{\\Phi}\n$$\n利用矩阵乘法的线性性质，我们有：\n$$\n\\mathbf{C}_\\mathrm{modal} = \\alpha (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi}) + \\beta (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi})\n$$\n代入先前建立的模态质量和刚度矩阵的恒等式：\n$$\n\\mathbf{C}_\\mathrm{modal} = \\alpha \\mathbf{I} + \\beta \\boldsymbol{\\Omega}^2\n$$\n由于 $\\mathbf{I}$ 和 $\\boldsymbol{\\Omega}^2$ 都是对角矩阵，它们的线性组合 $\\mathbf{C}_\\mathrm{modal}$ 也是一个对角矩阵。其对角线元素为 $[\\mathbf{C}_\\mathrm{modal}]_{nn} = \\alpha + \\beta\\omega_n^2$。非对角线元素全为零。这从第一性原理证明了，选择瑞利阻尼可确保运动方程组在模态基中完全解耦。数值验证将包括计算 $\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\boldsymbol{\\Phi}$ 并确认其非对角线元素在数值公差 $\\tau_\\mathrm{off}$ 范围内为零。\n\n**第二部分 (ii)：模态阻尼比推导**\n有了对角的模态矩阵后，方程组变为：\n$$\n\\mathbf{I}\\ddot{\\mathbf{q}}(t) + (\\alpha \\mathbf{I} + \\beta \\boldsymbol{\\Omega}^2)\\dot{\\mathbf{q}}(t) + \\boldsymbol{\\Omega}^2\\mathbf{q}(t) = \\mathbf{0}\n$$\n这代表了一组 3 个独立的标量微分方程。对于每个模态 $n$，方程为：\n$$\n\\ddot{q}_n(t) + (\\alpha + \\beta \\omega_n^2) \\dot{q}_n(t) + \\omega_n^2 q_n(t) = 0\n$$\n粘性阻尼单自由度振子的标准规范形式为：\n$$\n\\ddot{q}_n(t) + 2\\zeta_n\\omega_n \\dot{q}_n(t) + \\omega_n^2 q_n(t) = 0\n$$\n其中 $\\zeta_n$ 是模态 $n$ 的模态阻尼比。通过比较推导出的模态方程和标准形式中速度项 $\\dot{q}_n(t)$ 的系数，我们令它们相等：\n$$\n2\\zeta_n\\omega_n = \\alpha + \\beta \\omega_n^2\n$$\n解出理论模态阻尼比 $\\zeta_n$ 得到所需表达式：\n$$\n\\zeta_n = \\frac{\\alpha + \\beta \\omega_n^2}{2\\omega_n}\n$$\n数值测试必须验证此关系。模态 $n$ 的“测量”阻尼比从数值计算的模态阻尼矩阵的对角线元素 $c_{nn} = [\\mathbf{C}_\\mathrm{modal}]_{nn}$ 获得。根据标准形式，$c_{nn} = 2\\zeta_{n, \\text{measured}}\\omega_n$，这给出：\n$$\n\\zeta_{n, \\text{measured}} = \\frac{c_{nn}}{2\\omega_n}\n$$\n验证过程包括比较理论值 $\\zeta_n$ 与测量值 $\\zeta_{n, \\text{measured}}$，并检查每个模态的绝对差值是否在数值公差 $\\tau_\\zeta$ 内。\n\n所实现的程序将对每个测试用例执行这些步骤，以确定解耦和阻尼比属性是否都成立。", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Executes a unit test to verify Rayleigh damping properties for a 3-DOF system.\n    \"\"\"\n\n    test_cases = [\n        # (m, k, alpha, beta)\n        (2.0, 1000.0, 0.4, 0.0008),  # Test 1\n        (1.0, 1000.0, 0.2, 0.0),     # Test 2\n        (1.0, 1200.0, 0.0, 0.001),    # Test 3\n        (1.5, 500.0, 0.1, 0.002),     # Test 4\n    ]\n\n    tolerances = {\n        \"off_diag\": 1e-9,\n        \"damping_ratio\": 1e-9,\n    }\n\n    results = []\n\n    for m, k, alpha, beta in test_cases:\n        # Step 1: Construct M, K, and C matrices\n        # Mass matrix M = m * I\n        M = m * np.identity(3)\n        \n        # Stiffness matrix K\n        K_base = np.array([\n            [2.0, -1.0, 0.0],\n            [-1.0, 2.0, -1.0],\n            [0.0, -1.0, 2.0]\n        ])\n        K = k * K_base\n        \n        # Rayleigh damping matrix C = alpha*M + beta*K\n        C = alpha * M + beta * K\n\n        # Step 2: Solve the generalized eigenvalue problem K*phi = omega^2*M*phi\n        # scipy.linalg.eigh returns eigenvalues (omega^2) and M-orthonormal eigenvectors (Phi)\n        # such that Phi.T @ M @ Phi = I.\n        omega_sq, Phi = linalg.eigh(K, M)\n        \n        # Natural frequencies omega = sqrt(omega^2)\n        # Eigvals are guaranteed to be positive since K is positive definite.\n        omega = np.sqrt(omega_sq)\n\n        # Step 3: Verify modal decoupling\n        # Form modal damping matrix C_modal = Phi.T * C * Phi\n        C_modal = Phi.T @ C @ Phi\n        \n        # Check if C_modal is diagonal within tolerance tau_off\n        off_diag_mask = ~np.eye(3, dtype=bool)\n        max_abs_off_diag = np.max(np.abs(C_modal[off_diag_mask]))\n        decoupling_verified = max_abs_off_diag  tolerances[\"off_diag\"]\n\n        # Step 4: Verify modal damping ratios\n        # Compute theoretical damping ratios from the derived formula:\n        # zeta_n = (alpha + beta * omega_n^2) / (2 * omega_n)\n        zeta_theoretical = (alpha + beta * omega_sq) / (2 * omega)\n        \n        # Compute \"measured\" damping ratios from the diagonal of C_modal:\n        # c_nn = 2 * zeta_n_measured * omega_n => zeta_n_measured = c_nn / (2*omega_n)\n        c_modal_diag = np.diag(C_modal)\n        zeta_measured = c_modal_diag / (2 * omega)\n        \n        # Check if theoretical and measured ratios match within tolerance tau_zeta\n        max_abs_diff = np.max(np.abs(zeta_theoretical - zeta_measured))\n        ratios_correct = max_abs_diff  tolerances[\"damping_ratio\"]\n\n        # Step 5: Final result for the test case\n        # Test passes if and only if both conditions are met\n        test_passed = decoupling_verified and ratios_correct\n        results.append(str(test_passed).lower())\n\n    # Print results in the required format\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2610986"}]}