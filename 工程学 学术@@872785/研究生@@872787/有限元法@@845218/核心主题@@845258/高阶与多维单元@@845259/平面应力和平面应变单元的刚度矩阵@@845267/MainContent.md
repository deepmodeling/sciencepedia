## 引言
[单元刚度矩阵](@entry_id:139369)是[有限元分析](@entry_id:138109)的基石，它将复杂的[连续介质力学](@entry_id:155125)问题转化为可解的代数方程组。在工程实践中，许多三维结构可以被合理地简化为二维问题进行分析，其中[平面应力与平面应变](@entry_id:172357)是两种最核心的简化模型。理解如何针对这两种情况构建精确、稳健的[单元刚度矩阵](@entry_id:139369)，是掌握有限元方法的关键。然而，从理论公式到可靠的数值结果之间存在着诸多挑战，包括如何处理复杂几何、如何选择合适的数值积分方案，以及如何识别并规避[体积锁定](@entry_id:172606)、[沙漏模式](@entry_id:174855)等[数值病态](@entry_id:169044)问题。本文旨在系统性地填补这一知识鸿沟，为读者提供一个全面的指南。

在接下来的章节中，我们将踏上一段从基本原理到高级应用的旅程。第一章“原理与机制”将从连续介质力学出发，详细推导[应变-位移关系](@entry_id:173321)和本构关系，并最终形成[单元刚度矩阵](@entry_id:139369)的积分表达式，同时阐明[平面应力与平面应变](@entry_id:172357)的本质区别。第二章“应用与交叉学科联系”将展示这些理论在解决真实工程问题中的威力，探讨如何模拟载荷、处理[各向异性材料](@entry_id:184874)，并将其扩展到[结构稳定性](@entry_id:147935)和多物理场耦合等前沿领域。最后，在“动手实践”部分，我们将通过具体的编程练习，将理论知识转化为解决实际计算问题的能力。通过本系列的学习，您将不仅理解公式，更能掌握其背后的物理意义和计算技巧。

## 原理与机制

本章旨在深入探讨[平面应力与平面应变](@entry_id:172357)问题的有限元分析中所涉及的核心原理与机制。我们将从连续介质力学的基本运动学关系出发，系统地建立描述单元行为的[代数方程](@entry_id:272665)。我们将详细推导[单元刚度矩阵](@entry_id:139369)的构成，阐明[平面应力与平面应变](@entry_id:172357)这两种二维简化假设的物理意义、数学表达及其对本构关系的影响。此外，我们还将讨论从简单单元到更通用[等参单元](@entry_id:173863)的演进，及其在数值积分和实际计算中的关键考量。最后，本章将触及在实际应用中至关重要的一些高等议题，如[体积锁定](@entry_id:172606)和[沙漏模式](@entry_id:174855)等[数值病态](@entry_id:169044)问题，并最终阐述如何将单个单元的力学行为整合为整体结构的响应。

### 基本[运动学](@entry_id:173318)：[应变-位移关系](@entry_id:173321)

在[连续介质力学](@entry_id:155125)中，物体的变形是通过[位移场](@entry_id:141476) $\mathbf{u}(x,y)$ 来描述的。对于平面问题，[位移场](@entry_id:141476)有两个分量：$u(x,y)$ 和 $v(x,y)$，分别代表沿 $x$ 轴和 $y$ 轴的位移。当变形足够小（即[位移梯度](@entry_id:165352)远小于1）时，我们可以采用小应变（或称[微应变](@entry_id:191645)）理论。在此理论框架下，[应变张量](@entry_id:193332) $\boldsymbol{\epsilon}$ 被定义为[位移梯度张量](@entry_id:748571) $\nabla \mathbf{u}$ 的对称部分。

具体而言，平面内的三个应变分量——两个[正应变](@entry_id:204633) $\epsilon_{xx}$、$\epsilon_{yy}$ 和一个[剪应变](@entry_id:175241) $\gamma_{xy}$——与位移分量的空间导数（梯度）直接相关。这些关系构成了[有限元列式](@entry_id:164720)中[运动学](@entry_id:173318)部分的基础。[正应变](@entry_id:204633)代表了材料沿坐标轴方向的伸长或缩短，其定义为：
$$
\epsilon_{xx} = \frac{\partial u}{\partial x}
$$
$$
\epsilon_{yy} = \frac{\partial v}{\partial y}
$$
工程[剪应变](@entry_id:175241) $\gamma_{xy}$ 则描述了初始相互垂直的两条[线元](@entry_id:196833)之间夹角的变化。它被定义为：
$$
\gamma_{xy} = \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}
$$
这三个表达式是构建[应变-位移矩阵](@entry_id:163451)（即 $\mathbf{B}$ 矩阵）的出发点。在有限元方法中，我们通常将这三个应变分量组织成一个列向量，称为应变向量，通常采用Voigt标记法：
$$
\boldsymbol{\epsilon} = \begin{pmatrix} \epsilon_{xx} \\ \epsilon_{yy} \\ \gamma_{xy} \end{pmatrix}
$$
这个关系，$\boldsymbol{\epsilon} = f(\nabla \mathbf{u})$，是纯粹的几何关系，不涉及任何材料属性。它将连续的位移场与应变场联系起来 [@problem_id:2554583]。

### 二维弹性力学：[平面应力与平面应变](@entry_id:172357)假设

大多数实际工程结构本质上是三维的。然而，在许多情况下，结构的几何形状、载荷及约束条件允许我们做出合理的简化，将问题简化为二维模型进行分析。这不仅大大降低了计算成本，而且往往能提供足够精确的结果。在弹性力学中，最常用的两种二维简化是**[平面应力](@entry_id:172193)**和**[平面应变](@entry_id:167046)**。

#### 概念基础与物理情景

**[平面应力](@entry_id:172193) (Plane Stress)** 假设适用于几何外形为“薄板”的结构。这类结构的一个维度（厚度）远小于另外两个维度（平面内尺寸）。例如，受平面内力作用的薄壁容器、薄金属板等。其核心物理假设是：由于厚度方向（通常设为 $z$ 轴）的尺寸很小，且其上下表面（$z = \pm t/2$）通常是自由的（无面力作用），因此可以认为垂直于平面的应力分量在整个厚度上都近似为零 [@problem_id:2554515]。数学上，这意味着：
$$
\sigma_{zz} \approx 0, \quad \sigma_{xz} \approx 0, \quad \sigma_{yz} \approx 0
$$
这个假设是关于**应力状态**的。

**平面应变 (Plane Strain)** 假设则适用于几何[外形](@entry_id:146590)为“长柱体”的结构。这类结构的特点是，其在一个方向（轴向，通常设为 $z$ 轴）上的长度远大于其[横截面](@entry_id:154995)的特征尺寸，并且其几何形状、材料属性和所受载荷在轴向上保持不变或变化非常缓慢。典型的例子包括长坝、隧道、挡土墙以及长管道的[横截面分析](@entry_id:748080)。其核心物理假设是：由于轴向的约束（可以想象成无限长或者两端被刚性固定），物体在轴向（$z$ 方向）上没有位移，或者说各[横截面](@entry_id:154995)的变形模式都相同，与 $z$ 坐标无关。根据[圣维南原理](@entry_id:165302)（Saint-Venant's principle），这种假设在远离结构两端的中间部分是高度精确的 [@problem_id:2554515]。数学上，这意味着所有与 $z$ 方向相关的应变分量均为零：
$$
\epsilon_{zz} = 0, \quad \gamma_{xz} = 0, \quad \gamma_{yz} = 0
$$
这个假设是关于**运动学或应变状态**的。

#### 对[应力与应变](@entry_id:137374)张量的影响

这两种假设从根本上改变了问题的维度，并对非零的[应力应变](@entry_id:204183)分量产生了直接影响。

在**[平面应力](@entry_id:172193)**条件下，[应力张量](@entry_id:148973)被简化。根据定义，只有平面内的应力分量 $\sigma_{xx}, \sigma_{yy}, \sigma_{xy}$ 可以非零。然而，这并不意味着平面外的应变分量也为零。特别是面外[正应变](@entry_id:204633) $\epsilon_{zz}$，它由[泊松效应](@entry_id:158876)引起。当一个物体在平面内被拉伸时（例如 $\sigma_{xx} > 0$），它会在厚度方向上收缩。根据胡克定律，对于各向同性材料，这种关系可以表示为：
$$
\epsilon_{zz} = -\frac{\nu}{E}(\sigma_{xx} + \sigma_{yy})
$$
其中 $E$ 是杨氏模量，$\nu$ 是[泊松比](@entry_id:158876)。因此，在[平面应力](@entry_id:172193)状态下，物体厚度的变化是普遍存在的 [@problem_id:2554568]。总结来说，在[平面应力假设](@entry_id:184389)下，可能非零的应力分量为 $\sigma_{xx}, \sigma_{yy}, \sigma_{xy}$，而可能非零的应变分量为 $\epsilon_{xx}, \epsilon_{yy}, \gamma_{xy}$ 以及 $\epsilon_{zz}$ [@problem_id:2554519]。

在**平面应变**条件下，应变张量被简化。根据定义，只有平面内的应变分量 $\epsilon_{xx}, \epsilon_{yy}, \gamma_{xy}$ 可以非零。然而，为了维持 $\epsilon_{zz}=0$ 这一运动学约束，必须存在一个非零的面外[正应力](@entry_id:260622) $\sigma_{zz}$ 来“抵抗”由平面内变形引起的[泊松效应](@entry_id:158876)。这个反力应力的大小为：
$$
\sigma_{zz} = \nu(\sigma_{xx} + \sigma_{yy})
$$
这个应力是维持平面应变状态所必需的[内力](@entry_id:167605)。因此，在平面应变状态下，除了平面[内应力](@entry_id:193721) $\sigma_{xx}, \sigma_{yy}, \sigma_{xy}$ 外，$\sigma_{zz}$ 通常也非零 [@problem_id:2554568]。总结来说，在[平面应变假设](@entry_id:186003)下，可能非零的应变分量为 $\epsilon_{xx}, \epsilon_{yy}, \gamma_{xy}$，而可能非零的应力分量为 $\sigma_{xx}, \sigma_{yy}, \sigma_{xy}$ 以及 $\sigma_{zz}$ [@problem_id:2554519]。

### 本构关系：材料刚度矩阵

本构关系（或材料本构律）描述了材料内部[应力与应变](@entry_id:137374)之间的关系。对于线弹性、各向同性材料，该关系由[广义胡克定律](@entry_id:203555)给出。根据所采用的二维假设（[平面应力](@entry_id:172193)或[平面应变](@entry_id:167046)），我们可以从三维[胡克定律](@entry_id:149682)推导出相应的二维形式，即材料刚度矩阵 $\mathbf{D}$，它将应变向量 $\boldsymbol{\epsilon}$ 与应力向量 $\boldsymbol{\sigma}$ 联系起来：$\boldsymbol{\sigma} = \mathbf{D} \boldsymbol{\epsilon}$。

对于**[平面应力](@entry_id:172193)**，我们从 $\sigma_{zz}=0$ 的约束出发。通过代数操作消去三维胡克定律中的 $\epsilon_{zz}$，我们可以得到只涉及平面内分量的[应力-应变关系](@entry_id:274093)。最终的材料刚度矩阵 $\mathbf{D}_{\text{ps}}$ 为：
$$
\mathbf{D}_{\text{ps}} = \frac{E}{1-\nu^2} \begin{pmatrix} 1 & \nu & 0 \\ \nu & 1 & 0 \\ 0 & 0 & \frac{1-\nu}{2} \end{pmatrix}
$$
这个矩阵将[平面应变](@entry_id:167046)向量 $\boldsymbol{\epsilon} = [\epsilon_{xx}, \epsilon_{yy}, \gamma_{xy}]^T$ 映射到[平面应力](@entry_id:172193)向量 $\boldsymbol{\sigma} = [\sigma_{xx}, \sigma_{yy}, \sigma_{xy}]^T$。

对于**[平面应变](@entry_id:167046)**，我们从 $\epsilon_{zz}=0$ 的约束出发。直接将此条件代入三维胡克定律，即可得到平面内应力与应变的关系。最终的[材料刚度](@entry_id:158390)矩阵 $\mathbf{D}_{\text{pe}}$ 为：
$$
\mathbf{D}_{\text{pe}} = \frac{E}{(1+\nu)(1-2\nu)} \begin{pmatrix} 1-\nu & \nu & 0 \\ \nu & 1-\nu & 0 \\ 0 & 0 & \frac{1-2\nu}{2} \end{pmatrix}
$$
比较这两个矩阵可以发现，它们的结构和系数都不同。这是因为平面应变状态下材料在平面内的行为表现得更“硬”。面外约束的存在，使得在产生相同的平面内应变时需要更大的应力。

### [单元刚度矩阵](@entry_id:139369)：公式

[单元刚度矩阵](@entry_id:139369) $\mathbf{K}_e$ 是连接单元节点力与节点位移的核心。它量化了单元抵抗变形的能力。其推导过程始于虚功原理或[最小势能原理](@entry_id:173340)，并结合了[运动学](@entry_id:173318)关系、[本构关系](@entry_id:186508)以及[位移场](@entry_id:141476)的离散化。

#### 从离散化到矩阵形式

在有限元中，一个单元内的连续位移场 $\mathbf{u}(x,y)$ 是通过该单元的节点位移向量 $\mathbf{d}_e$ 和一组[插值函数](@entry_id:262791)——形函数 $\mathbf{N}(x,y)$ ——来近似的：
$$
\mathbf{u}(x,y) = \mathbf{N}(x,y) \mathbf{d}_e
$$
将此位移插值代入应变-位移的[微分](@entry_id:158718)关系中，我们便可将应变向量 $\boldsymbol{\epsilon}$ 表示为节点位移向量 $\mathbf{d}_e$ 的[线性组合](@entry_id:154743)：
$$
\boldsymbol{\epsilon} = \mathbf{B} \mathbf{d}_e
$$
这里的 $\mathbf{B}$ 矩阵称为**[应变-位移矩阵](@entry_id:163451)**，它的元素由形函数 $\mathbf{N}$ 的空间导数构成。$\mathbf{B}$ 矩阵的作用是将离散的节点位移映射为单元内的连续（或在积分点处）的应变场。

#### 积分形式

基于[虚功原理](@entry_id:138749)，可以推导出[单元刚度矩阵](@entry_id:139369)的标准积分表达式。对于一个厚度为 $t$ 的平面单元，其[刚度矩阵](@entry_id:178659)为：
$$
\mathbf{K}_e = \int_{\Omega_e} \mathbf{B}^T \mathbf{D} \mathbf{B} \, t \, d\Omega
$$
其中 $\Omega_e$ 是单元的积分域（面积）。这个公式优雅地整合了问题的三个核心要素：
1.  **运动学** (Kinematics)：体现在 $\mathbf{B}$ 矩阵中，它描述了变形的几何模式。
2.  **材料属性** (Material Properties)：体现在 $\mathbf{D}$ 矩阵中，它描述了材料的物理响应。
3.  **几何形状** (Geometry)：体现在积分域 $\Omega_e$ 和厚度 $t$ 中。

值得强调的是，[平面应力与平面应变](@entry_id:172357)模型的唯一区别在于积分中使用的 $\mathbf{D}$ 矩阵不同。几何相关的 $\mathbf{B}$ 矩阵和组装过程对于两种情况是完全相同的 [@problem_id:2554525]。

#### 示例：[常应变三角形单元](@entry_id:748101) (CST)

为了更具体地理解上述概念，让我们考察最简单的平面单元——三节点常应变三角形（CST）单元。对于一个线性[三角形单元](@entry_id:167871)，其形函数是 $x, y$ 的线性函数。因此，它们的导数是常数，这导致 $\mathbf{B}$ 矩阵在整个单元内是一个常数矩阵。在这种特殊情况下，[单元刚度矩阵](@entry_id:139369)的积分计算变得非常简单，积分号可以被移除：
$$
\mathbf{K}_e = \mathbf{B}^T \mathbf{D} \mathbf{B} \cdot A_e \cdot t
$$
其中 $A_e$ 是[三角形单元](@entry_id:167871)的面积。

通过一个具体的计算实例 [@problem_id:2554529]，我们可以比较在相同几何形状、材料参数（$E, \nu$）和节点位移下，[平面应力与平面应变](@entry_id:172357)单元的差异。计算结果表明，对于完全相同的节点位移模式，[平面应变](@entry_id:167046)单元储存的应变能 $U_e = \frac{1}{2} \mathbf{d}_e^T \mathbf{K}_e \mathbf{d}_e$ 要大于平面应力单元。这从能量的角度验证了我们之前的论断：由于存在面外约束，[平面应变](@entry_id:167046)模型表现出更高的刚度。施加相同的变形需要做更多的功。

### 数值实现：等参元与数值积分

虽然[CST单元](@entry_id:748101)在教学上很有用，但其精度较低（应变为常数），并且三角形网格有时难以生成。在现代[有限元分析](@entry_id:138109)中，[四边形单元](@entry_id:176937)因其更好的性能和灵活性而被广泛使用。为了处理任意形状的四边形，我们引入了**[等参映射](@entry_id:173239)**的概念。

#### [四边形单元](@entry_id:176937)的[等参映射](@entry_id:173239)

等参元的核心思想是，用同一组形函数既插值单元内的物理量（如位移），也描述单元的几何形状。分析在一个简单的、规则的“父单元”上进行，该父单元通常是位于局部坐标系 $(\xi, \eta)$ 中，范围为 $[-1, 1] \times [-1, 1]$ 的正方形。然后，通过一个映射关系将这个父单元变换到物理[坐标系](@entry_id:156346) $(x, y)$ 中的实际单元形状。

对于一个四节点（[双线性](@entry_id:146819)）[四边形单元](@entry_id:176937)，其物理坐标 $(x,y)$ 与父单元坐标 $(\xi, \eta)$ 之间的映射关系为：
$$
x(\xi, \eta) = \sum_{i=1}^{4} N_i(\xi, \eta) x_i, \quad y(\xi, \eta) = \sum_{i=1}^{4} N_i(\xi, \eta) y_i
$$
其中 $(x_i, y_i)$ 是单元在物理空间中的节点坐标，$N_i(\xi, \eta)$ 是双线性形函数，例如 $N_1(\xi, \eta) = \frac{1}{4}(1-\xi)(1-\eta)$ [@problem_id:2554559]。

由于所有的计算（如求形函数的导数）都在简单的父单元上进行，我们需要一个工具来转换不同[坐标系](@entry_id:156346)下的[微分](@entry_id:158718)运算。这个工具就是**雅可比矩阵 (Jacobian Matrix)** $\mathbf{J}$：
$$
\mathbf{J} = \begin{pmatrix} \frac{\partial x}{\partial \xi} & \frac{\partial x}{\partial \eta} \\ \frac{\partial y}{\partial \xi} & \frac{\partial y}{\partial \eta} \end{pmatrix}
$$
通过[链式法则](@entry_id:190743)，物理[坐标系](@entry_id:156346)下的导数可以通过[雅可比矩阵](@entry_id:264467)的逆 $\mathbf{J}^{-1}$ 来计算。此外，面积微元也通过[雅可比行列式](@entry_id:137120) $\det(\mathbf{J})$ 进行转换：$d\Omega = dx dy = \det(\mathbf{J}) d\xi d\eta$。因此，[单元刚度矩阵](@entry_id:139369)的积分最终被转换到父单元上进行：
$$
\mathbf{K}_e = \int_{-1}^{1}\int_{-1}^{1} \mathbf{B}(\xi, \eta)^T \mathbf{D} \mathbf{B}(\xi, \eta) \det(\mathbf{J}(\xi, \eta)) \, t \, d\xi d\eta
$$
这里的 $\mathbf{B}(\xi, \eta)$ 包含了 $\mathbf{J}^{-1}$，因此它通常是 $(\xi, \eta)$ 的一个复杂函数。

#### [数值积分](@entry_id:136578)：[高斯积分](@entry_id:187139)

上述积分表达式中的被积函数通常是 $(\xi, \eta)$ 的有理多项式或更复杂的形式，很难获得解析解。因此，必须采用数值积分。有限元中最常用的[数值积分方法](@entry_id:141406)是**高斯-勒让德积分 (Gauss-Legendre Quadrature)**。其思想是用一系列特[定积分](@entry_id:147612)点（[高斯点](@entry_id:170251)）的函数值与相应权重（高斯权重）的加权和来近似[定积分](@entry_id:147612)：
$$
\int_{-1}^{1} f(\xi) d\xi \approx \sum_{i=1}^{n} w_i f(\xi_i)
$$
$n$ 点[高斯积分](@entry_id:187139)能够精确地对最高 $2n-1$ 次的多项式进行积分。常见的一维[高斯积分](@entry_id:187139)规则包括 [@problem_id:2554588]：
- **1[点积](@entry_id:149019)分**: 节点 $\xi_1 = 0$, 权重 $w_1 = 2$。
- **2[点积](@entry_id:149019)分**: 节点 $\xi_{1,2} = \pm 1/\sqrt{3}$, 权重 $w_{1,2} = 1$。
- **3[点积](@entry_id:149019)分**: 节点 $\xi_1 = 0, \xi_{2,3} = \pm \sqrt{3/5}$, 权重 $w_1=8/9, w_{2,3}=5/9$。

对于在正方形父单元上的二维积分，我们采用**张量积**规则，即在每个坐标方向上独立地使用一维[高斯积分](@entry_id:187139)。例如，一个 $2 \times 2$ 的[高斯积分](@entry_id:187139)方案会使用 4 个积分点，其坐标是 $(\pm 1/\sqrt{3}, \pm 1/\sqrt{3})$，每个点的权重都是 $1 \times 1 = 1$。

#### 积分阶数与单元性能

选择合适的积分点数量（积分阶数）至关重要。对于四节点双线性（Q4）单元，标准的积分方案是 $2 \times 2$ 高斯积分。这被称为**完全积分 (Full Integration)**。其背后的原理是：当单元的几何形状为平行四边形时，其雅可比矩阵 $\mathbf{J}$ 是一个常数。此时，$\mathbf{B}$ 矩阵的元素是 $(\xi, \eta)$ 的线性函数，导致被积函数 $\mathbf{B}^T \mathbf{D} \mathbf{B}$ 是一个二次多项式。一个 $2 \times 2$ 的[高斯积分](@entry_id:187139)方案能够精确积分最高三次的多项式，因此对于平行[四边形单元](@entry_id:176937)，它能够精确地计算出刚度矩阵 [@problem_id:2554560]。对于更一般的扭曲四边形，这只是一个近似，但通常已足够精确。

有时，我们会故意使用比完全积分阶数更低的积分方案，例如对[Q4单元](@entry_id:176936)使用 $1 \times 1$ 积分，这被称为**[减缩积分](@entry_id:167949) (Reduced Integration)**。[减缩积分](@entry_id:167949)可以显著降低计算成本，并且在某些情况下可以改善单元的性能，例如避免“锁定”现象。但它也可能引入新的问题。

### 进阶主题与[病态问题](@entry_id:137067)

标准的有限元公式在某些特定情况下会表现出不理想的数值行为，即所谓的“病态”问题。理解这些问题的根源并掌握其解决方法是成为一名合格[有限元分析](@entry_id:138109)师的必经之路。

#### [近不可压缩材料](@entry_id:752388)的[体积锁定](@entry_id:172606)

当材料的[泊松比](@entry_id:158876) $\nu$ 趋近于 $0.5$ 时，材料变得**[近不可压缩](@entry_id:752387)**。此时，[体积模量](@entry_id:160069) $\kappa$ 会趋于无穷大。

在**[平面应变](@entry_id:167046)**条件下，[本构矩阵](@entry_id:164908) $\mathbf{D}_{\text{pe}}$ 的系数中包含了 $\lambda = \frac{E\nu}{(1+\nu)(1-2\nu)}$ 项，当 $\nu \to 0.5$ 时，$\lambda \to \infty$。这导致刚度矩阵中与体积变形相关的部分变得非常大，从而对任何体积变化施加了巨大的“惩罚”。对于采用完全积分（如 $2 \times 2$）的[Q4单元](@entry_id:176936)，这相当于在4个[高斯点](@entry_id:170251)上强制施加了近似的体积不变约束（$\epsilon_{vol} \approx 0$）。然而，[Q4单元](@entry_id:176936)的位移模式（运动自由度）不足以在满足这些强约束的同时还能表示复杂的变形（如弯曲）。其结果是，单元变得异常刚硬，无法正确响应载荷，这种现象被称为**[体积锁定](@entry_id:172606) (Volumetric Locking)** [@problem_id:2554494]。

相比之下，在**平面应力**条件下，[本构矩阵](@entry_id:164908) $\mathbf{D}_{\text{ps}}$ 的所有系数在 $\nu \to 0.5$ 时都保持有界。材料的不可压缩性通过厚度方向的自由收缩（$\epsilon_{zz} \neq 0$）来适应，而不会在平面内产生过强的约束。因此，平面应力单元不会因为材料的[近不可压缩性](@entry_id:752381)而发生[体积锁定](@entry_id:172606) [@problem_id:2554494]。

解决[平面应变](@entry_id:167046)锁定问题的一种常用方法是采用**[选择性减缩积分](@entry_id:168281) (Selective Reduced Integration)**，即对刚度矩阵中与体积变形相关的项使用低阶积分（如 $1 \times 1$），而对其余（剪切）部分仍使用完全积分。这有效减少了约束数量，从而缓解了锁定问题 [@problem_id:2554494]。

#### [伪零能模式](@entry_id:755267)（沙漏）

[减缩积分](@entry_id:167949)虽然能解决锁定问题，但它也可能带来一种新的数值不稳定现象——**[伪零能模式](@entry_id:755267) (Spurious Zero-Energy Modes)**，通常被称为**[沙漏模式](@entry_id:174855) (Hourglassing)**。

当使用[减缩积分](@entry_id:167949)时，我们只在少数几个点上考察单元的应变。这意味着可能存在一些特定的、非刚体运动的节点位移模式，它们恰好在所有积分点上产生的应均为零。由于[单元刚度矩阵](@entry_id:139369)是通过在积分点处对 $\mathbf{B}^T \mathbf{D} \mathbf{B}$ 求值来计算的，这些模式将不会贡献任何[应变能](@entry_id:162699)，因此其对应的刚度为零。

对于采用 $1 \times 1$ [减缩积分](@entry_id:167949)的[Q4单元](@entry_id:176936)，存在两种独立的[沙漏模式](@entry_id:174855)。它们对应于单元节点的一种交替、弯折的变形模式，看起来像一个沙漏，因此得名。这两种模式的典型节点位移向量（不考虑[刚体运动](@entry_id:193355)）为 [@problem_id:2554501]：
1.  $\mathbf{d}_u = [1, -1, 1, -1]^T, \quad \mathbf{d}_v = [0, 0, 0, 0]^T$
2.  $\mathbf{d}_u = [0, 0, 0, 0]^T, \quad \mathbf{d}_v = [1, -1, 1, -1]^T$

这些[零能模式](@entry_id:172472)会导致[刚度矩阵](@entry_id:178659)奇异（除了刚体运动模态外），使得单个单元无法抵抗这种变形。在由多个单元组成的网格中，这种不稳定性可能会传播，导致解出现非物理的、棋盘状的[振荡](@entry_id:267781)。因此，在使用[减缩积分](@entry_id:167949)时，通常需要配合使用“[沙漏控制](@entry_id:163812)”或“[沙漏稳定](@entry_id:750386)”技术来人为地给这些模式增加一定的刚度。

### 从单元到系统：组装过程

计算出每个单元的[刚度矩阵](@entry_id:178659) $\mathbf{K}_e$ 后，下一步是将它们“组装”成整个结构的**[全局刚度矩阵](@entry_id:138630) $\mathbf{K}$**。这个过程的核心是将单元层面的自由度（DOFs）映射到系统层面的全局自由度。

这个映射过程在代数上可以用一个**布尔选择矩阵** $\mathbf{L}_e$ 来描述。对于每个单元 $e$，其局部节点位移向量 $\mathbf{d}_e$ 可以通过从全局位移向量 $\mathbf{d}$ 中“收集”相应的分量得到：
$$
\mathbf{d}_e = \mathbf{L}_e \mathbf{d}
$$
$\mathbf{L}_e$ 的具体形式完全取决于单元的节点连接关系（即单元由哪些全局节点组成）以及全局和局部自由度的编号顺序。例如，对于一个由全局节点(2, 4, 3)组成的单元，其局部自由度将按照 $(u_2, v_2, u_4, v_4, u_3, v_3)$ 的顺序从全局向量中提取 [@problem_id:2554525]。

基于能量原理，[全局刚度矩阵](@entry_id:138630)是所有[单元刚度矩阵](@entry_id:139369)贡献的总和。每个单元的贡献通过一个“分散-相加”的操作添加到全局矩阵的正确位置。这个操作在数学上表现为一个[合同变换](@entry_id:154837)（congruence transformation）：
$$
\mathbf{K} = \sum_{e} \mathbf{L}_e^T \mathbf{K}_e \mathbf{L}_e
$$
这里的 $\mathbf{L}_e^T$ 算子将局部[单元刚度矩阵](@entry_id:139369)“分散”到全局矩阵中。这个组装过程是一个纯粹的拓扑和簿记操作，它只关心“哪个自由度连接到哪里”。因此，无论分析的是平面应力问题还是[平面应变](@entry_id:167046)问题，组装过程和所使用的 $\mathbf{L}_e$ 矩阵都是完全相同的。物理模型的差异已经完全包含在每个 $\mathbf{K}_e$ 矩阵的数值中了 [@problem_id:2554525]。