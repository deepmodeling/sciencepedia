{"hands_on_practices": [{"introduction": "有限元方法的核心依赖于对每个单元上积分的精确计算。对于多项式积分，高斯求积提供了最高的精度，构成了有限元数值积分的基石。本练习将带您回归基础，要求您从第一性原理出发，构建一个两点高斯-勒让德求积法则，揭示了如何通过优化节点和权重以达到最大积分精度。[@problem_id:2591926]", "problem": "在有限元方法中，参考区间上的积分通常通过高斯求积法计算。考虑参考区间 $[-1,1]$，其单位权函数为 $w(x)=1$。寻求一个具有 $n=2$ 个节点的形式如下的求积法则\n$$\n\\int_{-1}^{1} f(x)\\,dx \\approx w_1 f(x_1) + w_2 f(x_2),\n$$\n其中 $x_1,x_2 \\in (-1,1)$ 且 $w_1,w_2>0$。仅使用该求积法则对所有次数至多为3的多项式 $f(x)$ 都精确这一要求，构建与 $f(x)=x^k$（其中 $k\\in\\{0,1,2,3\\}$）相关的矩匹配方程组，并求解以确定 $x_1,x_2,w_1,w_2$。你的推导不得引用特殊函数表或超出单项式精确性和多项式积分基本微积分之外的性质。\n\n然后，通过直接代入 $f(x)=x^k$（其中 $k\\in\\{0,1,2,3\\}$），并在每种情况下确认精确积分与求积和相等，来验证你的结果。\n\n以单行矩阵 $\\big(x_1,\\;x_2,\\;w_1,\\;w_2\\big)$ 的形式提供你的最终答案，并满足排序约束 $x_1 < 0$。", "solution": "目标是在 $[-1,1]$ 上构建一个具有 $n=2$ 个节点的求积法则，该法则对所有次数至多为3的多项式都精确。根据定义，对次数至多为3的多项式精确意味着，对于 $f(x)=x^k$（其中 $k\\in\\{0,1,2,3\\}$），\n$$\n\\int_{-1}^{1} x^k\\,dx \\;=\\; w_1 x_1^k + w_2 x_2^k.\n$$\n我们仅使用单项式的积分来建立相应的方程。所需的精确积分通过基本微积分计算得出：\n- 对于 $k=0$，$\\displaystyle \\int_{-1}^{1} x^0\\,dx = \\int_{-1}^{1} 1\\,dx = 2$。\n- 对于 $k=1$，$\\displaystyle \\int_{-1}^{1} x\\,dx = 0$，由对称性可知。\n- 对于 $k=2$，$\\displaystyle \\int_{-1}^{1} x^2\\,dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{1}{3}-\\left(-\\frac{1}{3}\\right)=\\frac{2}{3}$。\n- 对于 $k=3$，$\\displaystyle \\int_{-1}^{1} x^3\\,dx = 0$，由对称性可知。\n\n因此，矩匹配方程组为\n\n$$\n\\begin{aligned}\nk=0:\\quad  w_1 + w_2 = 2, \\\\\nk=1:\\quad  w_1 x_1 + w_2 x_2 = 0, \\\\\nk=2:\\quad  w_1 x_1^2 + w_2 x_2^2 = \\frac{2}{3}, \\\\\nk=3:\\quad  w_1 x_1^3 + w_2 x_2^3 = 0.\n\\end{aligned}\n$$\n\n\n我们现在仅利用这些方程来确定参数。考虑奇数阶矩的两个方程：\n\n$$\nw_1 x_1 + w_2 x_2 = 0,\\qquad w_1 x_1^3 + w_2 x_2^3 = 0.\n$$\n\n引入变量 $y_1 := w_1 x_1$ 和 $y_2 := w_2 x_2$。该系统变为\n\n$$\n\\begin{pmatrix}\n1  1 \\\\\nx_1^2  x_2^2\n\\end{pmatrix}\n\\begin{pmatrix}\ny_1 \\\\ y_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0\n\\end{pmatrix}.\n$$\n\n为了使非平凡解 $(y_1,y_2)$ 存在（这是必要的，除非 $x_1=x_2=0$，而这是不允许的，因为一个具有非零精确度的两点法则需要不同的节点），行列式必须为零：\n\n$$\nx_2^2 - x_1^2 = 0 \\quad \\Rightarrow \\quad x_2^2 = x_1^2.\n$$\n\n因此 $|x_1|=|x_2|$。由于节点必须是不同的且在 $(-1,1)$ 内，我们得出结论\n\n$$\nx_2 = -x_1.\n$$\n\n回到 $y_1 + y_2 = 0$ 并代入 $x_2=-x_1$ 可得\n\n$$\nw_1 x_1 + w_2 (-x_1) = 0 \\;\\Rightarrow\\; (w_1 - w_2) x_1 = 0.\n$$\n\n因为 $x_1 \\neq 0$，所以\n\n$$\nw_1 = w_2.\n$$\n\n将公共权重记为 $w$，正节点记为 $a>0$，则有 $x_1=-a$, $x_2=a$ 和 $w_1=w_2=w$。剩下的两个方程变为\n\n$$\nw + w = 2 \\;\\Rightarrow\\; 2w = 2 \\;\\Rightarrow\\; w = 1,\n$$\n\n以及\n\n$$\nw x_1^2 + w x_2^2 = \\frac{2}{3} \\;\\Rightarrow\\; 1\\cdot a^2 + 1\\cdot a^2 = \\frac{2}{3} \\;\\Rightarrow\\; 2a^2 = \\frac{2}{3} \\;\\Rightarrow\\; a^2 = \\frac{1}{3}.\n$$\n\n取 $a>0$ 得 $a = \\frac{1}{\\sqrt{3}}$。强制执行排序约束 $x_10$ 和 $x_20$（由 $x_2=-x_1$ 和 $x_1 \\neq x_2$ 隐含），我们最终得到 $x_1 = -\\frac{1}{\\sqrt{3}}$ 和 $x_2 = \\frac{1}{\\sqrt{3}}$。\n\n因此，求积法则是\n$$\n\\int_{-1}^1 f(x)\\,dx \\approx 1 \\cdot f\\left(-\\frac{1}{\\sqrt{3}}\\right) + 1 \\cdot f\\left(\\frac{1}{\\sqrt{3}}\\right).\n$$\n\n**验证**\n\n- **k=0**: $f(x)=1 \\implies \\int_{-1}^{1} 1\\,dx = 2$。求积和为 $1(1) + 1(1) = 2$。✅\n- **k=1**: $f(x)=x \\implies \\int_{-1}^{1} x\\,dx = 0$。求积和为 $1(-\\frac{1}{\\sqrt{3}}) + 1(\\frac{1}{\\sqrt{3}}) = 0$。✅\n- **k=2**: $f(x)=x^2 \\implies \\int_{-1}^{1} x^2\\,dx = \\frac{2}{3}$。求积和为 $1(-\\frac{1}{\\sqrt{3}})^2 + 1(\\frac{1}{\\sqrt{3}})^2 = \\frac{1}{3}+\\frac{1}{3} = \\frac{2}{3}$。✅\n- **k=3**: $f(x)=x^3 \\implies \\int_{-1}^{1} x^3\\,dx = 0$。求积和为 $1(-\\frac{1}{\\sqrt{3}})^3 + 1(\\frac{1}{\\sqrt{3}})^3 = -\\frac{1}{3\\sqrt{3}}+\\frac{1}{3\\sqrt{3}} = 0$。✅\n\n推导是正确的，并且所有参数都已确定。最终答案是 $x_1 = -\\frac{1}{\\sqrt{3}}$，$x_2 = \\frac{1}{\\sqrt{3}}$，$w_1=1$ 和 $w_2=1$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  1  1\\end{pmatrix}}$$", "id": "2591926"}, {"introduction": "现实世界中的工程问题很少是一维的。本练习将我们的理解推向二维，处理在三角形参考单元上的积分，这是有限元网格中的一个基本构件。您将通过在重心坐标系下求解矩方程来构建一个对称求积法则，这是处理二维或三维单纯形单元的一项关键技能。[@problem_id:2591977]", "problem": "在有限元方法 (FEM) 中，单纯形上的单元积分通常采用求积法则来近似，这些求积法则是为对所有次数不高于指定总次数的多项式精确而构造的。考虑参考三角形 $\\widehat{T} = \\{(x,y) \\in \\mathbb{R}^{2} : x \\ge 0,\\ y \\ge 0,\\ x + y \\le 1\\}$，其面积为 $\\lvert \\widehat{T} \\rvert = \\frac{1}{2}$。一个具有单轨点的完全对称求积法则有 $3$ 个节点，由重心三元组 $(a,a,1-2a)$ 的排列给出，每个节点具有相同的权重 $w$，使得对于任意被积函数 $f$，\n$$\n\\int_{\\widehat{T}} f(x,y)\\,dx\\,dy = \\lvert \\widehat{T} \\rvert \\sum_{i=1}^{3} w\\, f(x_i,y_i),\n$$\n其中 $(x_i,y_i)$ 是相对于顶点 $(0,0)$、$(1,0)$、$(0,1)$，与 $(a,a,1-2a)$ 的 $3$ 个排列相对应的笛卡尔坐标。仅使用基本定义和直接计算矩，确定参数 $w$ 和 $a$，使得该法则对 $\\widehat{T}$ 上所有总次数至多为 $2$ 的多项式都是精确的。施加内点条件，即所有重心坐标都严格为正，$a \\in (0,\\tfrac{1}{2})$。然后，通过在 $\\widehat{T}$ 上直接积分并与求积计算结果进行比较，对测试集 $\\{1, x, y, x^{2}, xy, y^{2}\\}$ 显式地检验该法则，以验证其精确性。\n\n以一个包含数对 $(w,a)$ 的单行矩阵形式给出你的最终答案。无需四舍五入。", "solution": "目标是为参考三角形 $\\widehat{T}$ 上的一个 3 点对称求积法则找到权重 $w$ 和重心坐标参数 $a$，使其对所有总次数至多为 2 的多项式都精确。总次数至多为 2 的多项式空间，记为 $\\mathcal{P}_2(\\widehat{T})$，有一组基 $\\{1, x, y, x^2, xy, y^2\\}$。该求积法则必须能精确积分这些基函数中的每一个。\n\n求积法则由下式给出\n$$\n\\int_{\\widehat{T}} f(x,y)\\,dx\\,dy \\approx \\lvert \\widehat{T} \\rvert \\sum_{i=1}^{3} w\\, f(x_i,y_i) = \\frac{1}{2} w \\sum_{i=1}^{3} f(x_i,y_i)\n$$\n求积点 $(x_i, y_i)$ 是与重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 的排列相对应的笛卡尔坐标，这些排列由三元组 $(a, a, 1-2a)$ 给出。参考三角形 $\\widehat{T}$ 的顶点是 $V_1=(0,0)$，$V_2=(1,0)$ 和 $V_3=(0,1)$。一个具有重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 的点，其笛卡尔坐标为 $(x,y) = \\lambda_1 V_1 + \\lambda_2 V_2 + \\lambda_3 V_3 = (\\lambda_2, \\lambda_3)$。$(a, a, 1-2a)$ 的三个排列导出以下求积点：\n\\begin{itemize}\n    \\item $P_1$：$(\\lambda_1, \\lambda_2, \\lambda_3) = (1-2a, a, a) \\implies (x_1, y_1) = (a, a)$\n    \\item $P_2$：$(\\lambda_1, \\lambda_2, \\lambda_3) = (a, 1-2a, a) \\implies (x_2, y_2) = (1-2a, a)$\n    \\item $P_3$：$(\\lambda_1, \\lambda_2, \\lambda_3) = (a, a, 1-2a) \\implies (x_3, y_3) = (a, 1-2a)$\n\\end{itemize}\n条件 $a \\in (0, \\frac{1}{2})$ 确保了 $a  0$ 和 $1-2a  0$，因此所有重心坐标都严格为正，从而将这些点置于三角形内部。\n\n我们首先使用公式 $\\int_{\\widehat{T}} x^m y^n \\,dx\\,dy = \\frac{m! n!}{(m+n+2)!}$ 计算基多项式在 $\\widehat{T}$ 上的精确积分（矩）：\n\\begin{align*}\n    I(1) = \\int_{\\widehat{T}} 1 \\,dx\\,dy = \\frac{0!0!}{2!} = \\frac{1}{2} \\\\\n    I(x) = \\int_{\\widehat{T}} x \\,dx\\,dy = \\frac{1!0!}{3!} = \\frac{1}{6} \\\\\n    I(y) = \\int_{\\widehat{T}} y \\,dx\\,dy = \\frac{0!1!}{3!} = \\frac{1}{6} \\\\\n    I(x^2) = \\int_{\\widehat{T}} x^2 \\,dx\\,dy = \\frac{2!0!}{4!} = \\frac{2}{24} = \\frac{1}{12} \\\\\n    I(xy) = \\int_{\\widehat{T}} xy \\,dx\\,dy = \\frac{1!1!}{4!} = \\frac{1}{24} \\\\\n    I(y^2) = \\int_{\\widehat{T}} y^2 \\,dx\\,dy = \\frac{0!2!}{4!} = \\frac{2}{24} = \\frac{1}{12}\n\\end{align*}\n\n接下来，我们对每个基函数计算求积法则，记为 $Q(f)$：\n\\begin{align*}\n    Q(1) = \\frac{1}{2} w (1 + 1 + 1) = \\frac{3w}{2} \\\\\n    Q(x) = \\frac{1}{2} w (a + (1-2a) + a) = \\frac{w}{2} \\\\\n    Q(y) = \\frac{1}{2} w (a + a + (1-2a)) = \\frac{w}{2} \\\\\n    Q(x^2) = \\frac{1}{2} w (a^2 + (1-2a)^2 + a^2) = \\frac{1}{2} w (2a^2 + 1 - 4a + 4a^2) = \\frac{w}{2} (6a^2 - 4a + 1) \\\\\n    Q(xy) = \\frac{1}{2} w (a \\cdot a + (1-2a)a + a(1-2a)) = \\frac{1}{2} w (a^2 + 2a - 4a^2) = \\frac{w}{2} (2a - 3a^2) \\\\\n    Q(y^2) = \\frac{1}{2} w (a^2 + a^2 + (1-2a)^2) = \\frac{1}{2} w (2a^2 + 1 - 4a + 4a^2) = \\frac{w}{2} (6a^2 - 4a + 1)\n\\end{align*}\n\n我们令精确积分等于求积近似值，$I(f) = Q(f)$，来构成一个关于 $w$ 和 $a$ 的方程组。\n\n对于 0 次：\n$I(1) = Q(1) \\implies \\frac{1}{2} = \\frac{3w}{2} \\implies w = \\frac{1}{3}$。\n\n对于 1 次：\n$I(x) = Q(x) \\implies \\frac{1}{6} = \\frac{w}{2} \\implies w = \\frac{1}{3}$。\n$I(y) = Q(y) \\implies \\frac{1}{6} = \\frac{w}{2} \\implies w = \\frac{1}{3}$。\n这与 0 次的结果一致。法则的对称结构确保了如果 $I(x)=Q(x)$，那么 $I(y)=Q(y)$ 也成立。\n\n对于 2 次，我们代入 $w = \\frac{1}{3}$：\n$I(x^2) = Q(x^2) \\implies \\frac{1}{12} = \\frac{1}{2} \\left(\\frac{1}{3}\\right) (6a^2 - 4a + 1) \\implies \\frac{1}{12} = \\frac{1}{6} (6a^2 - 4a + 1)$。\n两边乘以 $12$ 得到 $1 = 2(6a^2 - 4a + 1)$，可简化为二次方程 $12a^2 - 8a + 1 = 0$。\n由对称性可知，从 $I(y^2) = Q(y^2)$ 得到的方程是相同的。\n\n$I(xy) = Q(xy) \\implies \\frac{1}{24} = \\frac{1}{2} \\left(\\frac{1}{3}\\right) (2a - 3a^2) \\implies \\frac{1}{24} = \\frac{1}{6} (2a - 3a^2)$。\n两边乘以 $24$ 得到 $1 = 4(2a - 3a^2)$，可简化为 $1 = 8a - 12a^2$，即 $12a^2 - 8a + 1 = 0$。\n所有二次多项式都得出了关于 $a$ 的相同条件。\n\n我们使用求根公式解二次方程 $12a^2 - 8a + 1 = 0$：\n$$ a = \\frac{-(-8) \\pm \\sqrt{(-8)^2 - 4(12)(1)}}{2(12)} = \\frac{8 \\pm \\sqrt{64 - 48}}{24} = \\frac{8 \\pm \\sqrt{16}}{24} = \\frac{8 \\pm 4}{24} $$\n两个解是 $a_1 = \\frac{8+4}{24} = \\frac{12}{24} = \\frac{1}{2}$ 和 $a_2 = \\frac{8-4}{24} = \\frac{4}{24} = \\frac{1}{6}$。\n问题施加了严格的内点条件 $a \\in (0, \\frac{1}{2})$。解 $a_1 = \\frac{1}{2}$ 位于该区间的边界上，因此被舍弃。解 $a_2 = \\frac{1}{6}$ 在该区间内。\n因此，所需的参数为 $w = \\frac{1}{3}$ 和 $a = \\frac{1}{6}$。\n\n最后，我们按要求对推导出的参数验证其精确性。\n当 $w=\\frac{1}{3}$ 和 $a=\\frac{1}{6}$ 时，求积法则为 $Q(f) = \\frac{1}{6} \\sum_{i=1}^{3} f(x_i, y_i)$。\n点参数为 $1-2a = 1-2(\\frac{1}{6}) = 1-\\frac{1}{3} = \\frac{2}{3}$。\n笛卡尔点为 $P_1 = (\\frac{1}{6}, \\frac{1}{6})$，$P_2 = (\\frac{2}{3}, \\frac{1}{6})$ 和 $P_3 = (\\frac{1}{6}, \\frac{2}{3})$。\n将该法则应用于基函数：\n\\begin{align*}\n    Q(1) = \\frac{1}{6}(1+1+1) = \\frac{3}{6} = \\frac{1}{2} = I(1) \\\\\n    Q(x) = \\frac{1}{6}(\\frac{1}{6} + \\frac{2}{3} + \\frac{1}{6}) = \\frac{1}{6}(\\frac{1}{6} + \\frac{4}{6} + \\frac{1}{6}) = \\frac{1}{6}(\\frac{6}{6}) = \\frac{1}{6} = I(x) \\\\\n    Q(y) = \\frac{1}{6}(\\frac{1}{6} + \\frac{1}{6} + \\frac{2}{3}) = \\frac{1}{6}(\\frac{1}{6} + \\frac{1}{6} + \\frac{4}{6}) = \\frac{1}{6}(\\frac{6}{6}) = \\frac{1}{6} = I(y) \\\\\n    Q(x^2) = \\frac{1}{6}\\left((\\frac{1}{6})^2 + (\\frac{2}{3})^2 + (\\frac{1}{6})^2\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{16}{36} + \\frac{1}{36}\\right) = \\frac{1}{6}\\left(\\frac{18}{36}\\right) = \\frac{1}{6 \\cdot 2} = \\frac{1}{12} = I(x^2) \\\\\n    Q(xy) = \\frac{1}{6}\\left(\\frac{1}{6}\\cdot\\frac{1}{6} + \\frac{2}{3}\\cdot\\frac{1}{6} + \\frac{1}{6}\\cdot\\frac{2}{3}\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{2}{18} + \\frac{2}{18}\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36}\\right) = \\frac{1}{6}\\left(\\frac{9}{36}\\right) = \\frac{1}{6 \\cdot 4} = \\frac{1}{24} = I(xy) \\\\\n    Q(y^2) = \\frac{1}{6}\\left((\\frac{1}{6})^2 + (\\frac{1}{6})^2 + (\\frac{2}{3})^2\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{1}{36} + \\frac{16}{36}\\right) = \\frac{1}{6}\\left(\\frac{18}{36}\\right) = \\frac{1}{6 \\cdot 2} = \\frac{1}{12} = I(y^2)\n\\end{align*}\n验证确认了参数为 $w=\\frac{1}{3}$ 和 $a=\\frac{1}{6}$ 的法则对所有次数至多为 2 的基多项式都是精确的。因此解是正确的。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3}  \\frac{1}{6} \\end{pmatrix}}\n$$", "id": "2591977"}, {"introduction": "知道如何构建求积法则是一回事，而知道在具体问题中应用哪种法则是另一回事，后者是实用的有限元实现中的一项关键技能。这最后一个练习连接了理论与应用，挑战您设计一个稳健的算法，以确定精确积分典型有限元公式中出现的复杂多项式表达式所需的最小求积阶数。这个练习概括了开发高效可靠的仿真软件所需的核心决策过程。[@problem_id:2591935]", "problem": "考虑一个定义在单元 $K \\subset \\mathbb{R}^d$ 上的有限元公式，该单元是通过仿射映射 $F : \\hat K \\to K$, $F(\\hat x) = B \\hat x + b$ 从参考单元 $\\hat K$ 获得的，其中雅可比矩阵 $B$ 为常数，且行列式 $|\\det B| \\neq 0$。设物理单元上的被积函数是由基函数及其导数与一个多项式系数的乘积构成的。将其拉回到参考单元 $\\hat K$ 上，被积函数可以写成一个有限和的形式\n$$\nI(\\hat x) \\;=\\; \\sum_{t=1}^{T} \\hat c_t(\\hat x)\\, \\prod_{\\ell=1}^{m_t} D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x),\n$$\n其中：\n- 对于每个项索引 $t \\in \\{1,\\dots,T\\}$，系数 $\\hat c_t$ 是 $\\hat K$ 上的一个总次数为 $q_t \\in \\mathbb{N}_0$ 的多项式。\n- 对于每个因子索引 $\\ell \\in \\{1,\\dots,m_t\\}$，$\\hat \\varphi_{\\ell,t}$ 是 $\\hat K$ 上的一个总次数为 $p_{\\ell,t} \\in \\mathbb{N}_0$ 的多项式基函数，而 $D^{\\alpha_{\\ell,t}}$ 表示一个多重指标为 $\\alpha_{\\ell,t} \\in \\mathbb{N}_0^d$、总阶数为 $|\\alpha_{\\ell,t}| \\in \\mathbb{N}_0$ 的偏导数。\n- 仿射映射意味着导数的变换只引入常数系数，并且体积因子 $|\\det B|$ 在 $K$ 上是常数。\n\n假设在 $\\hat K$ 上使用一个求积法则，该法则对于 $d$ 维空间中所有总次数至多为 $R \\in \\mathbb{N}_0$ 的多项式都是精确的。目标是确定一个算法，在给定数据 $\\{q_t\\}$, $\\{p_{\\ell,t}\\}$ 和 $\\{|\\alpha_{\\ell,t}|\\}$ 的情况下，返回最小的精确次数 $R$，使得求积法则能对所有仿射映射下的此类被积函数精确地计算积分 $\\int_{\\hat K} I(\\hat x)\\, d\\hat x$。\n\n以下哪种算法能正确计算这个最小的 $R$？\n\nA. 对于每一项 $t$，检查是否存在任何 $\\ell$ 使得 $|\\alpha_{\\ell,t}|  p_{\\ell,t}$。如果存在，则第 $t$ 项中的整个乘积恒等于零，可以舍弃。否则，设置\n$$\nM_t \\;=\\; q_t \\;+\\; \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr).\n$$\n返回 $R \\;=\\; \\max_{1 \\le t \\le T} M_t$。\n\nB. 对于每一项 $t$，忽略导数并设置\n$$\nM_t \\;=\\; q_t \\;+\\; \\sum_{\\ell=1}^{m_t} p_{\\ell,t}.\n$$\n返回 $R \\;=\\; \\max_{1 \\le t \\le T} M_t$。\n\nC. 对于每一项 $t$，将空间维度作为一个附加的安全因子包含进来，并设置\n$$\nM_t \\;=\\; d \\;+\\; q_t \\;+\\; \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr).\n$$\n返回 $R \\;=\\; \\max_{1 \\le t \\le T} M_t$。\n\nD. 通过定义\n$$\nS \\;=\\; \\max_{1 \\le t \\le T} \\left(q_t \\;+\\; \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)\\right),\n$$\n简化为一维估计，选择点数 $n \\in \\mathbb{N}$ 满足 $n \\ge S$ 的最小一维高斯法则，并声明相关的多维张量积法则对所有 $d$ 都具有足够的精确度，然后返回 $R=S$。\n\nE. 对于每一项 $t$，只取微分后留下的最大因子次数，并设置\n$$\nM_t \\;=\\; q_t \\;+\\; \\max_{1 \\le \\ell \\le m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr).\n$$\n返回 $R \\;=\\; \\max_{1 \\le t \\le T} M_t$。\n\n选择所有适用项。基于第一性原理解释你的选择，除了总次数、多项式微分、仿射变量变换和求积法则精确性的基本定义外，不假设任何专门的公式。", "solution": "该问题要求确定在参考有限元 $\\hat K$ 上的一个积分所需的最小求积精确次数，记为 $R$。一个精确次数为 $R$ 的求积法则可以精确地积分任何总次数最高为 $R$ 的多项式。所讨论的被积函数 $I(\\hat x)$ 是 $T$ 项之和，即 $I(\\hat x) = \\sum_{t=1}^{T} I_t(\\hat x)$。\n\n根据积分的线性性质，和的积分等于积分的和：\n$$\n\\int_{\\hat K} I(\\hat x) \\, d\\hat x = \\int_{\\hat K} \\sum_{t=1}^{T} I_t(\\hat x) \\, d\\hat x = \\sum_{t=1}^{T} \\int_{\\hat K} I_t(\\hat x) \\, d\\hat x\n$$\n为了让求积法则能精确地计算总积分，它必须能精确地计算每一项 $I_t(\\hat x)$ 的积分。这意味着该法则的精确次数 $R$ 必须大于或等于每一项 $I_t(\\hat x)$ 的总多项式次数。为了找到*最小*的 $R$，我们必须将 $R$ 设置为在所有项 $I_t(\\hat x)$ 中找到的最大总次数。\n$$\nR = \\max_{1 \\le t \\le T} \\left\\{ \\deg\\left(I_t(\\hat x)\\right) \\right\\}\n$$\n这假设了不同项 $I_t(\\hat x)$ 之间的最高次部分没有发生偶然的抵消，为了保证对所有可能的基函数和系数都精确，这个假设是必须的。\n\n让我们分析单项 $I_t(\\hat x)$ 的总多项式次数。其结构如下：\n$$\nI_t(\\hat x) = \\hat c_t(\\hat x)\\, \\prod_{\\ell=1}^{m_t} D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x)\n$$\n这是一个由几个多项式函数组成的乘积。多项式次数的一个基本性质是，多项式乘积的次数是它们各自次数的和。\n$$\n\\deg(I_t) = \\deg(\\hat c_t) + \\sum_{\\ell=1}^{m_t} \\deg\\left(D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}\\right)\n$$\n我们已知 $\\deg(\\hat c_t) = q_t$。我们必须确定每个因子 $D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x)$ 的次数。\n\n函数 $\\hat \\varphi_{\\ell,t}$ 是一个总次数为 $p_{\\ell,t}$ 的多项式。算子 $D^{\\alpha_{\\ell,t}}$ 代表总阶数为 $|\\alpha_{\\ell,t}|$ 的偏微分。\n当一个总次数为 $p$ 的多项式被一个总阶数为 $|\\alpha|$ 的算子微分时，得到的多项式的总次数至多为 $p - |\\alpha|$。\n关键的是，如果微分的阶数超过了多项式的次数，即 $|\\alpha_{\\ell,t}|  p_{\\ell,t}$，则其导数恒为零多项式。按照惯例，零多项式的次数是 $-\\infty$。\n如果对于给定的项 $t$，只要存在一个因子 $\\ell$ 使得 $|\\alpha_{\\ell,t}|  p_{\\ell,t}$，那么对应的因子 $D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x)$ 就为零。这使得整个乘积 $I_t(\\hat x)$ 恒等于零。零函数的积分是零，任何有效的求积法则都能精确计算它。因此，这些消失项对所需的最小次数 $R$ 不施加任何约束（除了 $R \\ge 0$），并且可以从最大次数的计算中排除。\n\n对于一个非零项，我们必须有对所有的 $\\ell = 1, \\dots, m_t$ 都有 $|\\alpha_{\\ell,t}| \\le p_{\\ell,t}$。导数 $D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}$ 的次数至多是 $p_{\\ell,t} - |\\alpha_{\\ell,t}|$。为确保算法对所有次数为 $p_{\\ell,t}$ 的基函数 $\\hat \\varphi_{\\ell,t}$ 都正确，我们必须考虑次数减少最小的最坏情况。$D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}$ 的最大可能次数恰好是 $p_{\\ell,t} - |\\alpha_{\\ell,t}|$。例如，对于 $\\varphi(x_1, \\dots, x_d) = x_1^p$，$\\deg(\\varphi)=p$，且 $\\frac{\\partial^k \\varphi}{\\partial x_1^k}$ 的次数是 $p-k$。算法必须对此类情况足够鲁棒。\n\n因此，对于一个非零项 $t$，最大可能的总次数是：\n$$\nM_t = q_t + \\sum_{\\ell=1}^{m_t} \\left(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\right)\n$$\n所需的最小精确次数 $R$ 是所有非零项的这些次数中的最大值：\n$$\nR = \\max \\left\\{ M_t \\mid \\forall \\ell \\in \\{1,\\dots,m_t\\}, |\\alpha_{\\ell,t}| \\le p_{\\ell,t} \\right\\}\n$$\n这就完成了正确算法的推导。\n\n现在，我们来评估每个选项：\n\n**A. 对于每一项 $t$，检查是否存在任何 $\\ell$ 使得 $|\\alpha_{\\ell,t}|  p_{\\ell,t}$。如果存在，则第 $t$ 项中的整个乘积恒等于零，可以舍弃。否则，设置 $M_t = q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$。返回 $R = \\max_{1 \\le t \\le T} M_t$。**\n该算法精确地实现了从第一性原理推导出的逻辑。它正确地识别和处理了消失项，通过对其因子次数求和来正确计算每个非零项的最大可能次数，并通过取所有项的最大值来正确确定整体所需的精确度。\n结论：**正确**。\n\n**B. 对于每一项 $t$，忽略导数并设置 $M_t = q_t + \\sum_{\\ell=1}^{m_t} p_{\\ell,t}$。返回 $R = \\max_{1 \\le t \\le T} M_t$。**\n该算法错误地计算了被积函数的次数。它没有考虑到微分导致的多项式次数减少。量 $p_{\\ell,t} - |\\alpha_{\\ell,t}|$ 被替换为 $p_{\\ell,t}$。由于 $|\\alpha_{\\ell,t}| \\ge 0$，这个公式得出的精确次数大于或等于正确的最小值。由于目标是找到*最小*次数 $R$，该算法是不正确的，因为它过于保守，并且通常不是最小的。\n结论：**不正确**。\n\n**C. 对于每一项 $t$，将空间维度作为一个附加的安全因子包含进来，并设置 $M_t = d + q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$。返回 $R = \\max_{1 \\le t \\le T} M_t$。**\n该算法将空间维度 $d$ 添加到正确计算的项次数上。这种修改没有任何基于原理的理由。一个 $d$ 变量多项式的总次数的定义与 $d$ 无关。从物理单元 $K$ 到参考单元 $\\hat K$ 的变换是仿射映射，其雅可比行列式 $|\\det B|$ 是一个常数。这个常数因子不会改变被积函数的多项式次数。加上 $d$ 会使得最终的次数 $R$ 不是最小的。\n结论：**不正确**。\n\n**D. 通过定义 $S = \\max_{1 \\le t \\le T} \\left(q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)\\right)$ 简化为一维估计，选择点数 $n \\in \\mathbb{N}$ 满足 $n \\ge S$ 的最小一维高斯法则，并声明相关的多维张量积法则对所有 $d$ 都具有足够的精确度，然后返回 $R = S$。**\n这个选项有多个缺陷。首先，也是最关键的，它忽略了对 $|\\alpha_{\\ell,t}|  p_{\\ell,t}$ 的消失项的检查。如果存在这样的项，这个公式可能会为一个零多项式得出一个正的次数，导致一个不正确、非最小的 $R$。例如，如果一个被积函数项是 $\\frac{d^2}{dx^2}(x)$，它的次数是 $-\\infty$（因为函数是 $0$）。这里的公式会计算出 $p-|\\alpha| = 1-2 = -1$。如果这是一个乘积的一部分，例如 $x^3 \\cdot \\frac{d^2}{dx^2}(x)$，结果是 $0$，但该公式会给出 $3 + (1-2) = 2$。这是不正确的。选项 A 中的检查是必不可少的。其次，关于一维高斯法则和张量积的论证是混淆不清且包含错误的（例如，一个 $n$ 点高斯法则对次数 $S$ 精确的条件是 $2n-1 \\ge S$，而不是 $n \\ge S$）。由于缺少该检查，算法本身是有缺陷的。\n结论：**不正确**。\n\n**E. 对于每一项 $t$，只取微分后留下的最大因子次数，并设置 $M_t = q_t + \\max_{1 \\le \\ell \\le m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$。返回 $R = \\max_{1 \\le t \\le T} M_t$。**\n该算法基于一个错误的多项式次数性质。多项式乘积的次数是它们次数的*和*，而不是最大值。该算法用最大值 $\\max_{\\ell}$ 替代了求和 $\\sum_{\\ell}$。这通常会计算出一个过低的次数，导致求积不充分和不正确的积分结果。例如，$(x^2) \\cdot (x^3)$ 的次数是 $2+3=5$，但这个公式会计算出 $\\max(2,3) = 3$。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2591935"}]}