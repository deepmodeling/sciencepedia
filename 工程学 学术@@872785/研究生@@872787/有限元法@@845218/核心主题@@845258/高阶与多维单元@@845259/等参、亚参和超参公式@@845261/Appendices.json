{"hands_on_practices": [{"introduction": "理解从简单参考单元到物理单元的映射是有限元方法的基础。这个练习将探讨一种特殊但重要的情形：当物理单元是平行四边形时，等参数映射简化为仿射映射。这种简化揭示了一个关键点：雅可比矩阵 $ \\mathbf{J} $ 变为常数，其行列式 $ \\det \\mathbf{J} $ 与单元面积直接相关。通过这个练习，你将深入理解二维双线性映射的几何本质。[@problem_id:2570213]", "problem": "在有限元法 (FEM) 的背景下，考虑从具有局部坐标 $(\\xi,\\eta)$ 的参考正方形 $\\hat{\\Omega} = [-1,1]^2$ 到具有全局坐标 $(x,y)$ 的物理四边形的等参双线性四边形映射。四个参考节点位于 $(-1,-1)$, $(+1,-1)$, $(+1,+1)$ 和 $(-1,+1)$，其对应的物理顶点位置为 $\\mathbf{X}_1$, $\\mathbf{X}_2$, $\\mathbf{X}_3$ 和 $\\mathbf{X}_4$。假设这些物理顶点排列成一个构成平行四边形的仿射构型：\n- $\\mathbf{X}_1 = (x_1, y_1)$,\n- $\\mathbf{X}_2 = (x_1 + a_x, y_1 + a_y)$,\n- $\\mathbf{X}_3 = (x_1 + a_x + b_x, y_1 + a_y + b_y)$,\n- $\\mathbf{X}_4 = (x_1 + b_x, y_1 + b_y)$,\n其中 $(a_x,a_y)$ 和 $(b_x,b_y)$ 是定义 $\\mathbf{X}_1$ 处两条相邻边的固定向量。使用等参概念（即用相同的双线性形函数对几何和场进行插值），从 $\\hat{\\Omega}$ 上的标准双线性形函数出发，并：\n- 显式地写出映射 $\\mathbf{F}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{X}_i$，\n- 在给定的仿射顶点构型下简化该映射，\n- 计算雅可比矩阵 $\\mathbf{J}(\\xi,\\eta) = \\partial \\mathbf{F} / \\partial (\\xi,\\eta)$ 及其行列式，\n- 并在 $a_x b_y - a_y b_x > 0$ 的条件下，论证 $\\hat{\\Omega}$ 的内点是否映射到物理四边形的内点。\n\n作为最终答案，请提供行列式 $\\det \\mathbf{J}$ 关于 $a_x$, $a_y$, $b_x$ 和 $b_y$ 的封闭形式表达式。无需四舍五入。最终答案中不要包含单位。", "solution": "所述问题是有限元法理论中的一个标准练习。它具有科学依据，是适定的，并包含足够的信息以获得唯一解。我们将直接进行推导。\n\n等参格式利用同一组形函数 $N_i$ 对单元的几何形状和单元上的未知场变量进行插值。对于一个双线性四节点四边形单元，从参考坐标 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 对坐标向量 $\\mathbf{x} = (x, y)$ 的插值由映射 $\\mathbf{F}(\\xi, \\eta)$ 给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\mathbf{F}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{X}_i\n$$\n其中 $\\mathbf{X}_i$ 是物理单元顶点的坐标。从左下角 $(\\xi=-1, \\eta=-1)$ 开始逆时针排序的四个节点的标准双线性形函数为：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n问题指定了构成平行四边形的物理顶点的坐标：\n$$\n\\begin{aligned}\n\\mathbf{X}_1 = (x_1, y_1) \\\\\n\\mathbf{X}_2 = (x_1 + a_x, y_1 + a_y) \\\\\n\\mathbf{X}_3 = (x_1 + a_x + b_x, y_1 + a_y + b_y) \\\\\n\\mathbf{X}_4 = (x_1 + b_x, y_1 + b_y)\n\\end{aligned}\n$$\n此处，$\\mathbf{a} = (a_x, a_y)$ 和 $\\mathbf{b} = (b_x, b_y)$ 表示从顶点 $\\mathbf{X}_1$ 出发的两条相邻边的向量。\n\n我们现在分别显式地写出 $x$ 和 $y$ 坐标的映射。\n对于 $x$ 坐标：\n$$\nx(\\xi, \\eta) = N_1(\\xi, \\eta) x_1 + N_2(\\xi, \\eta) (x_1 + a_x) + N_3(\\xi, \\eta) (x_1 + a_x + b_x) + N_4(\\xi, \\eta) (x_1 + b_x)\n$$\n我们可以对各项进行重组：\n$$\nx(\\xi, \\eta) = x_1 (N_1 + N_2 + N_3 + N_4) + a_x (N_2 + N_3) + b_x (N_3 + N_4)\n$$\n形函数的一个基本性质是它们构成单位分解，即 $\\sum_{i=1}^{4} N_i(\\xi, \\eta) = 1$。让我们验证其他的和：\n$$\nN_2 + N_3 = \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) = \\frac{1}{4}(1+\\xi)[(1-\\eta)+(1+\\eta)] = \\frac{1}{2}(1+\\xi)\n$$\n$$\nN_3 + N_4 = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta)[(1+\\xi)+(1-\\xi)] = \\frac{1}{2}(1+\\eta)\n$$\n将这些代入 $x(\\xi, \\eta)$ 的表达式中，得到：\n$$\nx(\\xi, \\eta) = x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x\n$$\n根据相同的逻辑， $y$ 坐标的映射为：\n$$\ny(\\xi, \\eta) = y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y\n$$\n这两个方程定义了从参考正方形到物理平行四边形的显式仿射映射。\n\n下一步是计算此变换的雅可比矩阵 $\\mathbf{J}(\\xi, \\eta)$。雅可比矩阵定义为：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\frac{\\partial \\mathbf{F}}{\\partial (\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们从简化的映射方程中计算必要的偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x \\right) = \\frac{1}{2}a_x\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x \\right) = \\frac{1}{2}b_x\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y \\right) = \\frac{1}{2}a_y\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y \\right) = \\frac{1}{2}b_y\n$$\n组合这些分量得到雅可比矩阵：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{1}{2}a_x  \\frac{1}{2}b_x \\\\ \\frac{1}{2}a_y  \\frac{1}{2}b_y \\end{pmatrix}\n$$\n注意，对于仿射映射，雅可比矩阵是常数；它不是局部坐标 $(\\xi, \\eta)$ 的函数。\n\n最后，我们计算雅可比矩阵的行列式：\n$$\n\\det \\mathbf{J} = \\left(\\frac{1}{2}a_x\\right)\\left(\\frac{1}{2}b_y\\right) - \\left(\\frac{1}{2}b_x\\right)\\left(\\frac{1}{2}a_y\\right) = \\frac{1}{4}(a_x b_y - a_y b_x)\n$$\n表达式 $a_x b_y - a_y b_x$ 是向量 $\\mathbf{a}=(a_x, a_y, 0)$ 和 $\\mathbf{b}=(b_x, b_y, 0)$ 叉积的模，其几何意义是由这两个向量构成的平行四边形的面积。设 $A$ 为物理单元的面积。那么 $\\det\\mathbf{J} = \\frac{A}{4}$，因为参考正方形的面积为 $4$。微分面积关系为 $dx\\,dy = (\\det \\mathbf{J}) \\,d\\xi\\,d\\eta$。\n\n关于内点的映射：为使映射有效（即一对一且保向），雅可比行列式必须在域内处处为正。问题指定 $a_x b_y - a_y b_x > 0$。因此，$\\det \\mathbf{J} = \\frac{1}{4}(a_x b_y - a_y b_x) > 0$。由于雅可比行列式是一个正常数，该映射对于所有 $(\\xi, \\eta) \\in \\hat{\\Omega}$ 都是非奇异的。一个非奇异的仿射变换是双射。因此，它将参考正方形的边界映射到物理平行四边形的边界上，并且关键地，它将参考正方形的内部唯一地映射到物理平行四边形的内部。条件 $\\det \\mathbf{J} > 0$ 确保单元不是退化的（即塌陷成一条线或一个点）且未反转（即顶点以一致的逆时针顺序编号）。", "answer": "$$\\boxed{\\frac{1}{4}(a_x b_y - a_y b_x)}$$", "id": "2570213"}, {"introduction": "在掌握了基本几何映射之后，本练习将探讨一个关键的实施细节：数值积分。对于一个普通的、非平行四边形的四边形单元，雅可比行列式 $\\det J$ 不再是常数，这使得被积函数变为一个更复杂的多项式。本练习将引导你确定质量矩阵被积函数的精确多项式次数，从而决定为实现精确积分所需的最小高斯积分阶数。[@problem_id:2570264]", "problem": "考虑一个用于二维结构动力学的四节点双线性四边形有限元，其质量密度 $\\rho$ 和厚度 $t$ 均为常数。该单元的几何形状通过一个具有任意非退化节点坐标的等参双线性映射，从母坐标 $(\\xi,\\eta) \\in [-1,1]\\times[-1,1]$ 中的双单位正方形映射到物理单元。场（例如位移）由相同的四个双线性形函数 $N_i(\\xi,\\eta)$，$i=1,\\dots,4$ 进行插值（即，该格式为等参格式，且场插值在每个母坐标上都是线性的）。\n\n协调单元质量矩阵的各项由以下基本关系式定义\n$$\nM_{ij} \\;=\\; \\int_{\\Omega_e} \\rho\\, t \\, N_i(\\boldsymbol{x})\\,N_j(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega \\,,\n$$\n其中 $\\Omega_e$ 是物理坐标下的单元域，$\\boldsymbol{x} = \\boldsymbol{x}(\\xi,\\eta)$ 是等参映射。使用到母域的等参变量替换，并分别在 $\\xi$ 和 $\\eta$ 方向上采用具有 $(n_\\xi,n_\\eta)$ 个点的张量积高斯-勒让德求积法，确定对于所有 $i,j$ 和任意双线性单元几何形状，精确积分 $M_{ij}$ 所需的最小点对 $(n_\\xi,n_\\eta)$。\n\n你的推理必须从第一性原理（上述定义以及等参映射和高斯-勒让德求积的标准性质）出发，通过确定被积函数在每个母坐标中的多项式次数来进行。将最小的 $(n_\\xi,n_\\eta)$ 表示为单个有序对。最终答案无需四舍五入，也无需报告单位。", "solution": "首先对所提出的问题进行强制性验证程序。\n\n第 1 步：提取已知条件\n- 单元类型：二维四节点双线性四边形有限元。\n- 物理性质：恒定质量密度 $\\rho$，恒定厚度 $t$。\n- 母域：$(\\xi,\\eta)$ 坐标系中的双单位正方形，其中 $(\\xi,\\eta) \\in [-1,1]\\times[-1,1]$。\n- 几何映射：从母域到物理域的等参双线性映射，具有任意非退化节点坐标。$ \\boldsymbol{x} = \\boldsymbol{x}(\\xi,\\eta) $。\n- 场插值：相同的四个双线性形函数 $N_i(\\xi,\\eta)$，$i=1, \\dots, 4$。\n- 协调质量矩阵项的定义：$M_{ij} = \\int_{\\Omega_e} \\rho\\, t \\, N_i(\\boldsymbol{x})\\,N_j(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega$。\n- 数值积分方法：具有 $(n_\\xi,n_\\eta)$ 个点的张量积高斯-勒让德求积。\n- 目标：确定对于所有 $i,j$ 和任意双线性单元几何形状，精确积分 $M_{ij}$ 所需的最小点对 $(n_\\xi,n_\\eta)$。\n\n第 2 步：使用提取的已知条件进行验证\n- **科学依据：** 该问题是有限元法理论中的一个标准、基本问题。它涉及等参格式、协调质量矩阵和数值求积，这些都是计算力学和应用数学中成熟的概念。\n- **适定性：** 该问题是适定的。它提供了所有必要的信息（单元类型、插值、映射、积分规则）来确定被积函数的多项式阶数，从而直接得出精确积分所需的求积点数。解是唯一且稳定的。\n- **客观性：** 语言精确、专业，没有任何主观性或模糊性。像“双线性”、“等参”和“高斯-勒让德求积”等术语都有严谨的数学定义。\n\n第 3 步：结论与行动\n该问题在科学上是合理的、自洽的且适定的。它是计算工程领域中的一个有效问题。将制定解答。\n\n二维单元的协调质量矩阵由下式给出\n$$ M_{ij} = \\int_{\\Omega_e} \\rho t N_i(\\boldsymbol{x}) N_j(\\boldsymbol{x}) \\, \\mathrm{d}\\Omega $$\n其中 $\\rho$ 和 $t$ 是常数，$\\Omega_e$ 是物理坐标 $\\boldsymbol{x} = (x,y)$ 下的单元域。\n\n该格式是等参的，意味着从母坐标 $(\\xi, \\eta)$ 到物理坐标 $(x,y)$ 的几何映射使用与场插值相同的形函数。积分必须转换到母域 $[-1,1] \\times [-1,1]$：\n$$ \\mathrm{d}\\Omega = \\mathrm{d}x \\mathrm{d}y = \\det J \\, \\mathrm{d}\\xi \\mathrm{d}\\eta $$\n其中 $\\det J$ 是几何变换的雅可比矩阵的行列式。质量矩阵表达式变为：\n$$ M_{ij} = \\rho t \\int_{-1}^{1} \\int_{-1}^{1} N_i(\\xi, \\eta) N_j(\\xi, \\eta) \\det J(\\xi, \\eta) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta $$\n为了确定精确积分所需的高斯-勒让德求积点的最小数量 $(n_\\xi, n_\\eta)$，我们必须找出被积函数 $F(\\xi, \\eta) = N_i(\\xi, \\eta) N_j(\\xi, \\eta) \\det J(\\xi, \\eta)$ 关于每个母坐标 $\\xi$ 和 $\\eta$ 的多项式次数。\n\n首先，我们分析四节点双线性单元的形函数 $N_i(\\xi, \\eta)$。它们的形式为 $c(1 \\pm \\xi)(1 \\pm \\eta)$，例如 $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$。每个形函数在 $\\xi$ 上是线性的，在 $\\eta$ 上也是线性的。因此，两个这样的形函数之积 $N_i(\\xi, \\eta) N_j(\\xi, \\eta)$ 将是一个双二次多项式。也就是说，它是一个在 $\\xi$ 方向上次数最多为 2，在 $\\eta$ 方向上次数最多为 2 的多项式。例如，$N_1(\\xi,\\eta) N_3(\\xi,\\eta) = \\frac{1}{16}(1-\\xi^2)(1-\\eta^2)$，它在 $\\xi$ 和 $\\eta$ 上都是二次的。\n\n接下来，我们分析雅可比行列式 $\\det J$。几何映射为\n$$ \\boldsymbol{x}(\\xi, \\eta) = \\sum_{k=1}^{4} N_k(\\xi, \\eta) \\boldsymbol{x}_k $$\n其中 $\\boldsymbol{x}_k$ 是恒定的节点坐标向量。雅可比矩阵 $J$ 的分量由映射的偏导数给出：\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_k \\frac{\\partial N_k}{\\partial \\xi} x_k  \\sum_k \\frac{\\partial N_k}{\\partial \\eta} x_k \\\\ \\sum_k \\frac{\\partial N_k}{\\partial \\xi} y_k  \\sum_k \\frac{\\partial N_k}{\\partial \\eta} y_k \\end{pmatrix} $$\n双线性形函数的偏导数为：\n$$ \\frac{\\partial N_k}{\\partial \\xi} \\text{ 在 } \\eta \\text{ 上是线性的，在 } \\xi \\text{ 上是常数。} $$\n$$ \\frac{\\partial N_k}{\\partial \\eta} \\text{ 在 } \\xi \\text{ 上是线性的，在 } \\eta \\text{ 上是常数。} $$\n因此，雅可比矩阵的各项具有以下多项式依赖关系：\n$$ \\frac{\\partial x}{\\partial \\xi} = f_1(\\eta), \\quad \\frac{\\partial x}{\\partial \\eta} = g_1(\\xi) $$\n$$ \\frac{\\partial y}{\\partial \\xi} = f_2(\\eta), \\quad \\frac{\\partial y}{\\partial \\eta} = g_2(\\xi) $$\n其中 $f_1, f_2$ 是 $\\eta$ 的线性函数，$g_1, g_2$ 是 $\\xi$ 的线性函数。\n\n雅可比行列式为\n$$ \\det J(\\xi, \\eta) = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta} \\frac{\\partial y}{\\partial \\xi} = f_1(\\eta) g_2(\\xi) - g_1(\\xi) f_2(\\eta) $$\n对于一个任意的、非退化的单元几何形状，节点坐标使得这些函数不为零。一个 $\\eta$ 的线性函数与一个 $\\xi$ 的线性函数之积是一个形如 $a+b\\xi+c\\eta+d\\xi\\eta$ 的双线性多项式。因此， $\\det J$ 通常是一个双线性多项式，即它在 $\\xi$ 方向上的次数为 1，在 $\\eta$ 方向上的次数为 1。\n\n总的被积函数是乘积 $N_i N_j \\det J$。\n- 项 $N_i N_j$ 是一个在 $\\xi$ 方向上次数为 2，在 $\\eta$ 方向上次数为 2 的多项式。\n- 项 $\\det J$ 是一个在 $\\xi$ 方向上次数为 1，在 $\\eta$ 方向上次数为 1 的多项式。\n两个多项式乘积的次数是它们次数的和。\n- 被积函数在 $\\xi$ 方向上的次数是 $2 + 1 = 3$。\n- 被积函数在 $\\eta$ 方向上的次数是 $2 + 1 = 3$。\n\n一个 n 点高斯-勒让德求积法则可以精确积分次数最高为 $2n-1$ 的多项式。\n要精确积分一个次数为 $p$ 的多项式，我们需要 $2n-1 \\ge p$，这意味着 $n \\ge \\frac{p+1}{2}$。\n\n对于 $\\xi$ 方向的积分，多项式次数为 $p_\\xi = 3$。所需的点数 $n_\\xi$ 为：\n$$ n_\\xi \\ge \\frac{3+1}{2} = 2 $$\n最小整数值为 $n_\\xi = 2$。\n\n对于 $\\eta$ 方向的积分，多项式次数为 $p_\\eta = 3$。所需的点数 $n_\\eta$ 为：\n$$ n_\\eta \\ge \\frac{3+1}{2} = 2 $$\n最小整数值为 $n_\\eta = 2$。\n\n因此，对于任意四节点双线性等参单元，要精确积分协调质量矩阵所需的最小求积点对 $(n_\\xi, n_\\eta)$ 是 $(2, 2)$。这对应于一个 $2 \\times 2$ 的高斯求积法则。", "answer": "$$ \\boxed{(2, 2)} $$", "id": "2570264"}, {"introduction": "最后一个练习探讨了几何插值与场插值不匹配时（即次参数或超参数单元）所带来的微妙而关键的后果。通过分析一个应用于弯曲边界的次参数公式，你将亲眼看到几何表示的不精确性如何导致模型无法精确再现一个简单的线性位移场。这种无法通过所谓的“分片检验”（patch test）的情况，突显了在几何表示精度和求解精度之间进行权衡的重要性。[@problem_id:2570242]", "problem": "一个二乘二的四边形有限元片区被用来近似一个其下边界为曲线的区域。物理坐标选择如下。设曲率参数为一个固定的常数 $\\kappa \\in \\mathbb{R}$，其绝对值 $|\\kappa|$ 足够小，使得在 $x=-1$ 和 $x=1$ 之间的弧线 $y=\\kappa x^{2}$ 是一条平缓的曲线。通过它们的 $(x,y)$ 坐标在物理平面中定义网格点：\n- 底行（待近似的曲线边界）：$(-1,\\kappa)$、$(0,0)$、$(1,\\kappa)$。\n- 中行：$(-1,0.5)$、$(0,0.5)$、$(1,0.5)$。\n- 顶行：$(-1,1)$、$(0,1)$、$(1,1)$。\n\n这产生了四个单元：左下单元 $E_{11}$，其角点为 $(-1,\\kappa)$、$(0,0)$、$(0,0.5)$、$(-1,0.5)$；右下单元 $E_{12}$，其角点为 $(0,0)$、$(1,\\kappa)$、$(1,0.5)$、$(0,0.5)$；以及两个类似构成的上部单元。\n\n考虑以下精确意义上的亚参数公式：\n- 每个单元中的几何映射使用仅由四个单元角点上的节点在父正方形上定义的标准双线性形函数构成的四节点双线性映射，从而用角点之间的直线弦来近似曲线下边界。\n- 每个单元中的位移插值使用八节点 serendipity 二次形函数（每个单元有四个角节点和四个边中节点）。在每条边上如下放置边中节点：在所有非曲线边上，将边中节点放置在物理平面中边的中点处；在下部单元的两条曲线边界边上，将边中节点放置在真实的弧线中点处，即对于 $E_{11}$ 为 $(-0.5,\\kappa/4)$，对于 $E_{12}$ 为 $(0.5,\\kappa/4)$。\n- 这使得几何相对于位移场是亚参数的，因为几何只使用双线性角点插值，而位移场使用参考真实曲线上边中节点的二次插值。\n\n设精确位移场为线性函数 $u(x,y)=\\alpha+\\beta x+\\gamma y$，其中 $\\alpha,\\beta,\\gamma \\in \\mathbb{R}$ 是任意常数。对于左下单元 $E_{11}$，令 $(\\xi,\\eta)$ 表示标准父坐标，令 $(x_{g}(\\xi,\\eta),y_{g}(\\xi,\\eta))$ 表示仅使用 $E_{11}$ 四个角点的双线性几何映射，而 $u_{h}(\\xi,\\eta)$ 表示使用 $E_{11}$ 的八个节点值（四个角点加四个边中点）作为自由度的 $u$ 的二次 serendipity 插值。\n\n从等参和亚参映射的基本定义以及拉格朗日形函数的插值性质出发，从第一性原理推导 $E_{11}$ 单元中心的插值误差\n$$\ne \\equiv u_{h}(0,0) - u\\!\\bigl(x_{g}(0,0),y_{g}(0,0)\\bigr),\n$$\n的精确解析表达式，用 $\\beta$、$\\gamma$ 和 $\\kappa$ 表示。你的最终答案必须是一个单一的闭合形式表达式。不需要进行数值计算。", "solution": "所述问题具有科学依据，内容自洽，且提法恰当。它构成了有限元方法理论中的一个有效练习。我们将着手解决它。\n\n目标是计算单元 $E_{11}$ 中心的插值误差 $e$，其定义为\n$$e \\equiv u_{h}(0,0) - u\\!\\bigl(x_{g}(0,0),y_{g}(0,0)\\bigr)$$\n其中 $(\\xi, \\eta)=(0,0)$ 代表父单元域 $[-1,1] \\times [-1,1]$ 的中心。函数 $u_{h}$ 是精确位移场 $u(x,y)$ 的有限元插值函数，而 $(x_g, y_g)$ 表示从父坐标到物理坐标的几何映射。\n\n首先，我们分析插值函数 $u_{h}(\\xi,\\eta)$ 的结构。它是由八节点 serendipity 二次形函数构成的，我们将其记为 $N_i^q(\\xi,\\eta)$，$i=1, \\dots, 8$。插值函数由下式给出\n$$u_{h}(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) u_i$$\n其中 $u_i$ 是精确位移场 $u(x,y)$ 的节点值。精确场是给定的线性函数 $u(x,y) = \\alpha + \\beta x + \\gamma y$。因此，节点值为 $u_i = u(x_i, y_i) = \\alpha + \\beta x_i + \\gamma y_i$，其中 $(x_i, y_i)$ 是第 $i$ 个节点的坐标。\n\n将 $u_i$ 的表达式代入 $u_h$ 的公式中：\n$$u_{h}(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) (\\alpha + \\beta x_i + \\gamma y_i)$$\n根据求和的线性性质，我们可以分配求和：\n$$u_{h}(\\xi, \\eta) = \\alpha \\left(\\sum_{i=1}^{8} N_i^q(\\xi, \\eta)\\right) + \\beta \\left(\\sum_{i=1}^{8} N_i^q(\\xi, \\eta) x_i\\right) + \\gamma \\left(\\sum_{i=1}^{8} N_i^q(\\xi, \\eta) y_i\\right)$$\n有限元形函数的一个基本性质是单位分解性，即对于父域中的所有 $(\\xi, \\eta)$，$\\sum_{i=1}^{8} N_i^q(\\xi, \\eta) = 1$。表达式中的另外两个和，根据定义，是使用二次形函数得到的几何映射函数。我们把这个二次映射记为 $(x_h(\\xi, \\eta), y_h(\\xi, \\eta))$：\n$$x_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) x_i$$\n$$y_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) y_i$$\n这是八节点等参单元的几何映射。根据这些定义，$u_h$ 的表达式变为：\n$$u_h(\\xi, \\eta) = \\alpha + \\beta x_h(\\xi, \\eta) + \\gamma y_h(\\xi, \\eta) = u(x_h(\\xi, \\eta), y_h(\\xi, \\eta))$$\n这表明对于线性场，二次 serendipity 插值函数与在二次映射坐标处求值的精确场是相同的。\n\n现在，我们可以重写在父单元中心 $(\\xi, \\eta) = (0,0)$ 处计算的误差表达式 $e$：\n$$e = u(x_h(0,0), y_h(0,0)) - u(x_g(0,0), y_g(0,0))$$\n代入 $u(x,y)$ 的线性形式：\n$$e = \\bigl(\\alpha + \\beta x_h(0,0) + \\gamma y_h(0,0)\\bigr) - \\bigl(\\alpha + \\beta x_g(0,0) + \\gamma y_g(0,0)\\bigr)$$\n常数 $\\alpha$ 消去，我们得到：\n$$e = \\beta \\bigl(x_h(0,0) - x_g(0,0)\\bigr) + \\gamma \\bigl(y_h(0,0) - y_g(0,0)\\bigr)$$\n问题简化为计算父单元中心在两种不同几何映射下的映射物理坐标之差：双线性映射 $x_g, y_g$（为亚参数几何所指定）和二次映射 $x_h, y_h$（由位移插值隐式定义）。\n\n我们来计算 $(x_g(0,0), y_g(0,0))$。双线性映射使用单元 $E_{11}$ 的四个角节点：\n$P_1 = (-1, \\kappa)$, $P_2 = (0, 0)$, $P_3 = (0, 0.5)$, $P_4 = (-1, 0.5)$。\n在中心点 $(\\xi, \\eta)=(0,0)$ 处，双线性形函数都等于 $N_j^b(0,0) = 1/4$，对于 $j=1,2,3,4$。\n$$x_g(0,0) = \\frac{1}{4} (x_1+x_2+x_3+x_4) = \\frac{1}{4}(-1 + 0 + 0 - 1) = -\\frac{1}{2}$$\n$$y_g(0,0) = \\frac{1}{4} (y_1+y_2+y_3+y_4) = \\frac{1}{4}(\\kappa + 0 + 0.5 + 0.5) = \\frac{1}{4}(1+\\kappa)$$\n\n接下来，我们计算 $(x_h(0,0), y_h(0,0))$。这个二次映射使用单元的所有八个节点。在中心点 $(\\xi, \\eta)=(0,0)$ 处，serendipity 形函数 $N_i^q$ 的值为：\n对于四个角节点（$i=1,2,3,4$），$N_i^q(0,0) = -1/4$。\n对于四个边中节点（$i=5,6,7,8$），$N_i^q(0,0) = 1/2$。\n八个节点的坐标如下：\n角节点：$P_1(-1, \\kappa)$、 $P_2(0, 0)$、 $P_3(0, 0.5)$、 $P_4(-1, 0.5)$。\n边中节点：$P_5(-0.5, \\kappa/4)$、 $P_6(0, 0.25)$、 $P_7(-0.5, 0.5)$、 $P_8(-1, (0.5+\\kappa)/2)$。\n$$x_h(0,0) = \\sum_{i=1}^8 N_i^q(0,0) x_i = -\\frac{1}{4}(x_1+x_2+x_3+x_4) + \\frac{1}{2}(x_5+x_6+x_7+x_8)$$\n$$x_h(0,0) = -\\frac{1}{4}(-1+0+0-1) + \\frac{1}{2}(-0.5+0-0.5-1) = -\\frac{1}{4}(-2) + \\frac{1}{2}(-2) = \\frac{1}{2} - 1 = -\\frac{1}{2}$$\n$$y_h(0,0) = \\sum_{i=1}^8 N_i^q(0,0) y_i = -\\frac{1}{4}(y_1+y_2+y_3+y_4) + \\frac{1}{2}(y_5+y_6+y_7+y_8)$$\n$$y_h(0,0) = -\\frac{1}{4}(\\kappa+0+0.5+0.5) + \\frac{1}{2}\\left(\\frac{\\kappa}{4} + 0.25 + 0.5 + \\frac{0.5+\\kappa}{2}\\right)$$\n$$y_h(0,0) = -\\frac{1}{4}(1+\\kappa) + \\frac{1}{2}\\left(1 + \\frac{3\\kappa}{4}\\right)$$\n$$y_h(0,0) = -\\frac{1}{4} - \\frac{\\kappa}{4} + \\frac{1}{2} + \\frac{3\\kappa}{8} = \\frac{1}{4} + \\left(-\\frac{2\\kappa}{8} + \\frac{3\\kappa}{8}\\right) = \\frac{1}{4} + \\frac{\\kappa}{8}$$\n现在我们计算坐标差：\n$$x_h(0,0) - x_g(0,0) = -\\frac{1}{2} - \\left(-\\frac{1}{2}\\right) = 0$$\n$$y_h(0,0) - y_g(0,0) = \\left(\\frac{1}{4} + \\frac{\\kappa}{8}\\right) - \\left(\\frac{1}{4}(1+\\kappa)\\right) = \\frac{1}{4} + \\frac{\\kappa}{8} - \\frac{1}{4} - \\frac{\\kappa}{4} = \\frac{\\kappa}{8} - \\frac{2\\kappa}{8} = -\\frac{\\kappa}{8}$$\n最后，我们将这些差值代回误差 $e$ 的表达式中：\n$$e = \\beta(0) + \\gamma\\left(-\\frac{\\kappa}{8}\\right) = -\\frac{\\gamma\\kappa}{8}$$\n单元中心的插值误差完全是由于单元定义所使用的几何映射与高阶位移场为保持对线性函数的精确性而隐式要求的几何映射之间的不一致造成的。该误差与曲率参数 $\\kappa$ 以及场在 $y$ 方向的梯度 $\\gamma$ 成正比。", "answer": "$$ \\boxed{-\\frac{\\gamma\\kappa}{8}} $$", "id": "2570242"}]}