## 引言
在[有限元分析](@entry_id:138109)的广阔世界中，三维实体单元是模拟真实世界结构和物理现象的基石。从简单的线性单元到复杂的[高阶单元](@entry_id:750328)，每种选择都深刻影响着模拟的精度、计算成本和最终结果的可靠性。然而，许多学习者在掌握了[有限元法](@entry_id:749389)的基本理论后，往往在如何构建、选择和有效使用这些三维单元上遇到瓶颈。本文旨在填补这一知识鸿沟，系统性地引领读者深入探索四面体与[六面体单元](@entry_id:174602)的核心技术。

在接下来的内容中，您将踏上一段从基础到前沿的学习之旅。**第一章：原理与机制**将从第一性原理出发，详细阐述线性单元（T4, H8）和[高阶单元](@entry_id:750328)（T10, H20）的形函数构造、[等参映射](@entry_id:173239)及其背后的数学机理。**第二章：应用与交叉学科联系**将理论付诸实践，展示如何应用这些单元解决[固体力学](@entry_id:164042)、动力学及[非线性](@entry_id:637147)问题，并探讨几何精度、数值稳定性和高级列式等关键议题。最后，**第三章：动手实践**提供了一系列精心设计的计算练习，旨在巩固您对核心概念的理解，将理论知识转化为实际操作能力。通过本次学习，您将能够自信地驾驭这些强大的分析工具，以应对复杂的工程与科学挑战。

## 原理与机制

本章在前一章介绍有限元法基本思想的基础上，深入探讨三维实体单元的[构造原理](@entry_id:141667)与工作机制。我们将系统地阐述[四面体单元](@entry_id:168311)和[六面体单元](@entry_id:174602)的数学表述，重点关注从简单的线性单元（T4 和 H8）到更复杂的[高阶单元](@entry_id:750328)（T10 和 H20）的演进。本章的目标是为读者提供一个坚实的理论框架，理解这些单元的插值特性、[几何映射](@entry_id:749852)能力及其在求解工程与科学问题时的计算细节。

### [参考单元](@entry_id:168425)与[坐标系](@entry_id:156346)

为了系统地构建适用于任意形状和尺寸物理单元的形函数，[有限元法](@entry_id:749389)引入了[参考单元](@entry_id:168425)（或称母单元）的概念。参考单元是具有简单几何形状和固定坐标范围的理想化单元。通过一个数学映射，我们可以将这个[参考单元](@entry_id:168425)变换为物理空间中的任意实际单元。

#### [四面体单元](@entry_id:168311)与[重心坐标](@entry_id:155488)

对于[四面体单元](@entry_id:168311)，其最自然的参考[坐标系](@entry_id:156346)是**[重心坐标](@entry_id:155488)（barycentric coordinates）**，记为 $(L_1, L_2, L_3, L_4)$。对于参考四面体中的任意一点，其[重心坐标](@entry_id:155488)可以直观地理解为四个顶点对其“贡献”的权重。这些坐标具有以下基本性质：

1.  **单位和性**：在单元内的任意一点，四个[重心坐标](@entry_id:155488)之和恒为1。即 $\sum_{i=1}^4 L_i = 1$。
2.  **非负性**：对于单元内部（包括边界）的任意一点，所有[重心坐标](@entry_id:155488)均满足 $L_i \ge 0$。
3.  **节点属性**：在第 $i$ 个顶点处，其对应的[重心坐标](@entry_id:155488) $L_i = 1$，而所有其他[重心坐标](@entry_id:155488) $L_j$ ($j \neq i$) 均为 $0$。
4.  **边界特性**：在与顶点 $i$ 相对的那个面上，[重心坐标](@entry_id:155488) $L_i$ 的值恒为 $0$。

这些性质使得[重心坐标](@entry_id:155488)成为构建[四面体单元](@entry_id:168311)形函数的理想工具。由于 $\sum L_i = 1$，四个坐标中只有三个是独立的。它们是定义在四面体上的仿射坐标。[@problem_id:2604809]

#### [六面体单元](@entry_id:174602)与自然坐标

对于[六面体单元](@entry_id:174602)，通常采用一个边长为2的立方体作为参考单元，其中心位于原点。该[参考单元](@entry_id:168425)在**自然坐标（natural coordinates）**系 $(\xi, \eta, \zeta)$ 中定义为 $\{(\xi, \eta, \zeta) \in [-1, 1]^3\}$。这个[坐标系](@entry_id:156346)的选择具有良好的对称性，极大地简化了形函数的表达式。单元的八个角点坐标为 $(\pm 1, \pm 1, \pm 1)$。

### [等参概念](@entry_id:136811)：线性单元

**等参（isoparametric）**概念是有限元方法中的一个核心思想。它主张使用同一组形函数来描述单元的几何形状和单元内的物理场（如位移、温度等）。物理单元中的任意一点的[坐标向量](@entry_id:153319) $\boldsymbol{x}$ 可以通过参考单元坐标 $\boldsymbol{\xi}$ 和单元的节点坐标 $\boldsymbol{X}_a$ 进行插值得到：

$$
\boldsymbol{x}(\boldsymbol{\xi}) = \sum_{a=1}^{n} N_a(\boldsymbol{\xi}) \boldsymbol{X}_a
$$

其中 $N_a(\boldsymbol{\xi})$ 是节点 $a$ 的形函数，$n$ 是单元的节点总数。

#### 4节点线性四面体 (T4)

最简单的三维单元是 T4 单元，它由四个顶点节点构成。其形函数直接取自[重心坐标](@entry_id:155488)：

$$
N_i = L_i \quad (i=1, 2, 3, 4)
$$

由于[重心坐标](@entry_id:155488) $L_i$ 是空间坐标的线性函数，T4 单元的形函数是线性的。这满足了[拉格朗日插值](@entry_id:167052)的基本要求，即在节点 $i$ 处 $N_i=1$，在所有其他节点 $j$ 处 $N_j=0$。[线性插值](@entry_id:137092)意味着单元内的场（如位移）是线性变化的，这导致单元内的应变为常数。几何上，等参 T4 单元是一个具有平直边界和平面（三角形）的四面体。[@problem_id:2604809]

#### 8节点线性六面体 (H8)

H8 单元是三维分析中最常用的单元之一。它有八个节点，位于参考立方体的角点处。其形函数是通过一维线性[拉格朗日多项式](@entry_id:142463)进行张量积构造的。对于节点 $i$，其在参考单元中的坐标为 $(\xi_i, \eta_i, \zeta_i)$，其中 $\xi_i, \eta_i, \zeta_i \in \{-1, 1\}$。其形函数为：

$$
N_i(\xi, \eta, \zeta) = \frac{1}{8} (1 + \xi\xi_i) (1 + \eta\eta_i) (1 + \zeta\zeta_i)
$$

这种形式的函数是**三线性（trilinear）**的，即在每个坐标方向上都是线性的。在等参格式下，H8 单元的边是直线，但其面可以是双线性[曲面](@entry_id:267450)，这意味着四个面节点不一定共面，从而可以模拟扭曲的形状。[@problem_id:2604845] [@problem_id:2604794]

### [高阶单元](@entry_id:750328)以提升精度

线性单元在许多情况下过于简单，尤其是在模拟弯曲变形或具有复杂应力梯度的区域时。[高阶单元](@entry_id:750328)通过引入更多的节点和更高次的多项式插值，提供了更强的近似能力。

#### 采用高阶插值的理由

线性单元（$p=1$）的[位移场](@entry_id:141476)插值沿单元边界是线性的，这意味着其[二阶导数](@entry_id:144508)（与曲率相关）恒为零。因此，它们无法精确捕捉场内的弯曲。相比之下，二次单元（$p=2$）沿边界的插值是二次多项式，其[二阶导数](@entry_id:144508)可以为常数。这意味着它们能够精确表示具有[恒定曲率](@entry_id:162122)的场，并能更好地逼近更复杂的场变化。这种增强的近似能力直接转化为更高的收敛速度。对于光滑解，在[能量范数](@entry_id:274966)（$H^1$-[半范数](@entry_id:264573)）下，线性单元的[误差收敛](@entry_id:137755)阶为 $O(h)$，而二次单元则为 $O(h^2)$，其中 $h$ 是网格尺寸。[@problem_id:2604794]

#### 10节点二次四面体 (T10)

T10 单元在线性 T4 单元的四个顶点[节点基](@entry_id:752522)础上，于六条边的中点各增加一个节点，总计十个节点。这使得我们可以构建二次形函数。使用[重心坐标](@entry_id:155488)，这些形函数具有简洁的形式：

- **顶点节点 $i$ ($i=1, \dots, 4$)**:
  $$
  N_i = L_i(2L_i - 1)
  $$
- **边中点节点 $ij$ (连接顶点 $i$ 和 $j$)**:
  $$
  N_{ij} = 4L_iL_j
  $$

可以验证，这些形函数满足[拉格朗日插值](@entry_id:167052)特性。例如，对于顶点 $i$，当 $L_i=1$ 时，$N_i=1$；而在其他任何顶点或任何不与 $i$ 相连的边的中点处， $N_i=0$。同样，对于边 $ij$ 的中点（此处 $L_i = L_j = 1/2$），$N_{ij} = 4(1/2)(1/2) = 1$，而在所有其他节点处均为零。[@problem_id:2604809] [@problem_id:2604835]

所有这些形函数都满足一个重要的性质：**[单位分解](@entry_id:150115)（partition of unity）**，即 $\sum_{a=1}^{10} N_a = 1$。这确保了单元能够精确地表示刚体位移（常数场）。[@problem_id:2604809]

#### 20节点二次六面体 (H20) 与 serendipity 族

与 T10 类似，H20 单元在 H8 单元的八个顶点[节点基](@entry_id:752522)础上，于十二条边的中点各增加一个节点，总计二十个节点。这种单元属于 **serendipity**（意外发现）族，其特点是仅使用顶点和边节点，而没有面心和体心节点，从而在保持二次[多项式完备性](@entry_id:177462)的同时，比完整的[张量积](@entry_id:140694)单元（见下文）拥有更少的自由度。[@problem_id:2604845]

H20 单元的形函数更为复杂：
- **顶点节点 $i$ (坐标为 $\xi_i, \eta_i, \zeta_i \in \{\pm 1\}$)**:
  $$
  N_i = \frac{1}{8}(1+\xi\xi_i)(1+\eta\eta_i)(1+\zeta\zeta_i)(\xi\xi_i+\eta\eta_i+\zeta\zeta_i-2)
  $$
- **边中点节点 (例如，位于平行于 $\xi$ 轴的边上，坐标为 $(0, \eta_j, \zeta_j)$)**:
  $$
  N_j = \frac{1}{4}(1-\xi^2)(1+\eta\eta_j)(1+\zeta\zeta_j)
  $$
其他边中点节点的形函数可以通过对坐标进行[循环置换](@entry_id:272913)得到。[@problem_id:2604845]

[高阶单元](@entry_id:750328)最重要的优势之一是其几何[表示能力](@entry_id:636759)。由于使用了二次插值，T10 和 H20 单元的边可以是二次曲线（如抛物线），面可以是[二次曲面](@entry_id:264390)。这使得它们能够非常精确地拟合复杂几何模型的弧形边界，而线性单元只能用分段直线来近似。[@problem_id:2604835] [@problem_id:2604794]

#### 深入探讨：Serendipity 单元的[多项式空间](@entry_id:144410)

H20 单元的效率源于其并未包含完整的二次[张量积](@entry_id:140694)[多项式空间](@entry_id:144410) $\mathbb{Q}_2$。一个完整的 $\mathbb{Q}_2$ 空间由所有形如 $\xi^a \eta^b \zeta^c$ 且 $a,b,c \in \{0,1,2\}$ 的单项式张成，其维数为 $3 \times 3 \times 3 = 27$。这对应于一个 **27节点六面体（H27）**，它在 H20 的[节点基](@entry_id:752522)础上，还在六个面心和单元体心各增加了一个节点。

H20 的形[函数空间](@entry_id:143478)维数为20，因此必然缺少 $\mathbb{Q}_2$ 中的7个单项式。这些缺失的项与面和体的“气泡”函数相关。通过分析 H20 形函数在面上的迹（trace），可以发现其无法表示面内的 $\xi^2\eta^2$ 等项。推广到三维，H20 单元无法表示的 $\mathbb{Q}_2$ 基单项式共有7个：
$$
\{\xi^2\eta^2, \xi^2\zeta^2, \eta^2\zeta^2, \xi\eta^2\zeta^2, \xi^2\eta\zeta^2, \xi^2\eta^2\zeta, \xi^2\eta^2\zeta^2\}
$$
[@problem_id:2604813]

尽管 H20 的[多项式空间](@entry_id:144410)小于 H27，但两种单元都包含了完整的三维二次多项式空间 $\mathbb{P}_2$（所有总次数不大于2的多项式）。根据有限元[收敛理论](@entry_id:176137)，收敛阶数由单元能够完整表示的最高次[多项式空间](@entry_id:144410) $\mathbb{P}_k$ 决定。由于 H20 和 H27 都完整包含 $\mathbb{P}_2$，它们的渐近[收敛阶](@entry_id:146394)数是相同的（例如，在能量范数下均为 $O(h^2)$）。然而，由于 H27 拥有更丰富的插值空间，对于给定的网格尺寸，它通常能提供更小的误差（即[误差常数](@entry_id:168754)更小），但代价是每个单元多出7个节点（即21个位移自由度）。[@problem_id:2604828]

### 映射的数学：梯度与雅可比矩阵

在有限元计算中，我们需要计算形函数相对于物理坐标 $(x,y,z)$ 的梯度，以进一步计算应变和应力。然而，形函数是定义在参考坐标 $\boldsymbol{\xi}$ 上的。这就需要通过雅可比矩阵进行坐标转换。

#### 变换的雅可比矩阵

[雅可比矩阵](@entry_id:264467) $\boldsymbol{J}$ 定义了从参考[坐标系](@entry_id:156346)到物理[坐标系](@entry_id:156346)的[局部线性](@entry_id:266981)映射关系：

$$
\boldsymbol{J}(\boldsymbol{\xi}) = \frac{\partial \boldsymbol{x}}{\partial \boldsymbol{\xi}} =
\begin{bmatrix}
\frac{\partial x}{\partial \xi} & \frac{\partial x}{\partial \eta} & \frac{\partial x}{\partial \zeta} \\
\frac{\partial y}{\partial \xi} & \frac{\partial y}{\partial \eta} & \frac{\partial y}{\partial \zeta} \\
\frac{\partial z}{\partial \xi} & \frac{\partial z}{\partial \eta} & \frac{\partial z}{\partial \zeta}
\end{bmatrix}
= \sum_{a=1}^{n} \boldsymbol{X}_a \otimes \nabla_{\boldsymbol{\xi}} N_a(\boldsymbol{\xi})
$$

雅可比矩阵的[行列式](@entry_id:142978) $\det(\boldsymbol{J})$ 表示了微元体积的缩放关系：$dV_{phys} = \det(\boldsymbol{J}) dV_{ref}$。为了保证映射的有效性，$\det(\boldsymbol{J})$ 必须在整个单元内为正。

- 对于 T4 单元和经过[仿射映射](@entry_id:746332)（即平移、旋转、缩放和剪切）的 H8 单元，其几何插值是线性的，因此[雅可比矩阵](@entry_id:264467) $\boldsymbol{J}$ 在整个单元内是一个**常数**。[@problem_id:2604809] [@problem_id:2604848]
- 对于 T10 和 H20 单元，由于其形函数是二次的，其梯度是线性的。因此，[雅可比矩阵](@entry_id:264467) $\boldsymbol{J}$ 是参考坐标 $\boldsymbol{\xi}$ 的**线性函数**，在单元内是变化的。[@problem_id:2604809]

#### [梯度场](@entry_id:264143)的变换

根据多元微积分的[链式法则](@entry_id:190743)，物理坐标梯度 $\nabla_{\boldsymbol{x}} f$ 和参考坐标梯度 $\nabla_{\boldsymbol{\xi}} f$ 之间的关系是：

$$
\nabla_{\boldsymbol{\xi}} f = \boldsymbol{J}^{\top} \nabla_{\boldsymbol{x}} f
$$

为了得到我们需要的物理梯度，需要求解上述方程，这要求[雅可比矩阵](@entry_id:264467)是可逆的：

$$
\nabla_{\boldsymbol{x}} f = (\boldsymbol{J}^{\top})^{-1} \nabla_{\boldsymbol{\xi}} f = \boldsymbol{J}^{-\top} \nabla_{\boldsymbol{\xi}} f
$$

这个关系式是有限元程序中计算应变的核心。例如，给定一个[仿射映射](@entry_id:746332) $\boldsymbol{x}(\boldsymbol{\xi}) = \boldsymbol{b} + \boldsymbol{B} \boldsymbol{\xi}$，[雅可比矩阵](@entry_id:264467)就是常数矩阵 $\boldsymbol{J} = \boldsymbol{B}$。我们可以直接计算其[逆矩阵](@entry_id:140380) $\boldsymbol{J}^{-1}$，然后用于整个单元的梯度变换计算。[@problem_id:2604848]

#### 形函数梯度的性质

形函数梯度的性质决定了单元能够表示的应变场。
- 对于 T4 单元，由于 $N_i = L_i$ 且在[仿射映射](@entry_id:746332)下 $\nabla L_i$ 为常向量，所以 $\nabla N_i$ 也是常向量。这导致 T4 单元只能表示**常数应变**状态。
- 对于 T10 单元（在[仿射映射](@entry_id:746332)下），其形函数的梯度是空间坐标的线性函数。例如，顶点形函数的梯度为 $\nabla N_i = (4L_i - 1)\nabla L_i$，边中点形函数的梯度为 $\nabla N_{ij} = 4(L_j \nabla L_i + L_i \nabla L_j)$。由于 $L_k$ 是线性的，而 $\nabla L_k$ 是常数，这些梯度都是线性变化的。因此，T10 单元能够表示**线性应变**场，这对于模拟弯曲等问题至关重要。[@problem_id:2604825]
- 同样，H8 单元通常只能表示在特定方向上线性变化的复杂应变状态，而 H20 单元则能表示完整的三维线性应变场。

此外，由于[单位分解](@entry_id:150115)性质 $\sum_a N_a = 1$，其梯度必然为零，即 $\sum_a \nabla N_a = \boldsymbol{0}$。这个性质对于保证单元的力学平衡至关重要。[@problem_id:2604825]

### 对近似与收敛的影响

单元的选择和构造方式直接影响到[有限元分析](@entry_id:138109)的精度、收敛性和计算成本。

#### 几何保真度与场近似

如前所述，[高阶单元](@entry_id:750328)（T10, H20）能够用二次曲[线或](@entry_id:170208)[曲面](@entry_id:267450)来表示几何边界，而线性单元（T4, H8）只能使用直边。对于具有[曲面](@entry_id:267450)边界的结构，使用[高阶单元](@entry_id:750328)进行几何建模，可以显著减小几何近似误差。例如，要[精确模拟](@entry_id:749142)一个圆弧边界，可以使用一个二次单元，并将其边中点节点放置在圆弧的精确位置上。虽然抛物线形的单元边无法完[全等](@entry_id:273198)同于圆弧，但其近似误差阶数可达 $O(h^3)$，远优于线性单元的 $O(h^2)$ 误差。[@problem_id:2604835]

#### 检验：[收敛的必要条件](@entry_id:157681)

**检验（Patch Test）**是验证有限元单元 formulation 正确性的一个基本准则。它要求在一个由任意形状单元组成的“斑块”上，如果施加的边界条件来自于一个已知的简单多项式解（例如线性或二次位移场），那么有限元解必须精确地重现该多项式解。

- **线性检验**：要求单元能精确重现任意线性[位移场](@entry_id:141476) $\boldsymbol{u}(\boldsymbol{x}) = \boldsymbol{a} + \boldsymbol{B} \boldsymbol{x}$，此时应变为常数。为了通过此检验，单元必须满足两个条件：(1) **线性完备性**：形函数必须能够精确表示线性场；(2) **积分精度**：用于计算[单元刚度矩阵](@entry_id:139369)的数值积分方案必须能够精确地积分[常数函数](@entry_id:152060)。对于[仿射映射](@entry_id:746332)的 T4 和 H8 单元，这意味着单[点积](@entry_id:149019)分就足够了。[@problem_id:2604800]
- **二次检验**：要求单元能精确重现任意二次[位移场](@entry_id:141476)。类似地，这要求[单元形函数](@entry_id:198891)具有**二次完备性**，并且数值积分方案能够精确积分二次多项式（因为应变是线性的，[刚度矩阵](@entry_id:178659)的被积函数是二次的）。对于[仿射映射](@entry_id:746332)的 T10 和 H20 单元，这分别要求至少2阶精度的四面[体积分](@entry_id:171119)和 $2 \times 2 \times 2$ 的[高斯积分](@entry_id:187139)。[@problem_id:2604800]

通过检验是保证单元收敛到正确解的必要（但非充分）条件。

#### 亚参数、等参数与超参数列式

在实践中，我们可以为几何插值和场插值选择不同阶次的多项式，这引出了以下三种列式：
- **等参数 (Isoparametric, $p_g = p_u$)**: 几何和场的插值阶次相同。这是最常见的选择，如用 H20 单元同时描述二次几何和二次[位移场](@entry_id:141476)。它在几何和场近似能力之间取得了平衡。[@problem_id:2604798]
- **亚参数 (Subparametric, $p_g  p_u$)**: 几何插值阶次低于场插值阶次。例如，使用线性几何（H8 的节点）和二次[位移场](@entry_id:141476)。这种做法在几何非常简单（如直角块）但场变化剧烈时可能有意义，但通常会因为几何误差限制整体收敛阶而较少使用。[@problem_id:2604798]
- **超参数 (Superparametric, $p_g > p_u$)**: 几何插值阶次高于场插值阶次。一个极具实用价值的例子是：使用二次几何（H20 的节点）来描述几何，但只在角点（H8 的节点）上定义自由度来插值一个线性位移场。这样做的好处是，在不增加[求解方程组](@entry_id:152624)规模（自由度总数不变）的情况下，能极大地提高对弯曲边界的几何描述精度。这对于涉及[曲面](@entry_id:267450)接触、或在[曲面](@entry_id:267450)上施加[分布](@entry_id:182848)力的分析尤其有效，因为它能提供更精确的[法向量](@entry_id:264185)和曲率计算，从而在粗糙网格上获得显著改善的结果。[@problem_id:2604798]

综上所述，从简单的 T4、H8 单元到复杂的 T10、H20 单元，有限元方法提供了一个功能强大的工具箱。理解这些单元背后的原理与机制，以及它们在精度、计算成本和几何[表示能力](@entry_id:636759)之间的权衡，是进行高质量有限元分析的关键。