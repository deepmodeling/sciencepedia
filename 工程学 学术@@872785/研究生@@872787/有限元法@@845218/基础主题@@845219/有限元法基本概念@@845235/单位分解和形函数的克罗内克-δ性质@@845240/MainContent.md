## 引言
形函数是有限元方法（FEM）的基石，构成了离散近似空间的骨架。在众多数学性质中，**克罗内克-德尔[塔性质](@entry_id:273153)**和**[单位分解](@entry_id:150115)性质**是其中最基本也最关键的两个。它们不仅是保证数值解收敛性和准确性的数学前提，更是连接有限[元理论](@entry_id:638043)与工程实践的桥梁。然而，许多使用者虽能熟练应用有限元软件，却可能对这些性质的深刻内涵及其如何从第一性原理层面确保分析结果的物理实在性缺乏系统认知。本文旨在填补这一知识鸿沟，为读者构建一个从理论根基到高级应用的完整理解框架。

在接下来的内容中，我们将分三个章节展开系统性探讨。首先，在**“原理与机制”**一章，我们将从Ciarlet三元组的严谨数学定义出发，深入剖析这两种性质的起源、精确表述及其对节点插值和常数场再生的直接影响。接着，在**“应用与跨学科关联”**一章，我们将展示这些看似抽象的性质如何在几何建模、高级数值方法（如XFEM、DG法）以及[计算材料科学](@entry_id:145245)等跨学科领域中，作为强大的构造工具发挥核心作用。最后，通过**“动手实践”**部分提供的精选习题，读者将有机会亲手验证和应用所学理论，从而将抽象概念内化为解决实际问题的能力。现在，让我们首先进入对这些基本原理的深入探索。

## 原理与机制

在有限元方法 (FEM) 的理论框架中，形函数 (shape functions) 是构建离散近似空间和插值任意场的基本构件。这些函数的特定数学性质直接决定了[数值方法的收敛性](@entry_id:635470)、准确性和物理实在性。本章将深入探讨两个最基本且至关重要的性质：**克罗内克-德尔[塔性质](@entry_id:273153) (Kronecker-delta property)** 和 **单位分解性质 (partition of unity property)**。我们将从第一性原理出发，阐明这些性质的定义、推论及其在[有限元分析](@entry_id:138109)实践中的深刻影响。

### 形函数的基本性质：从第一性原理出发

为了严谨地理解形函数的内涵，我们首先引入有限元的现代数学定义，即所谓的 **Ciarlet 定义**。根据此定义，一个有限元被定义为一个三元组 $(\hat{K}, \hat{\mathcal{P}}, \hat{\Sigma})$，其中：

1.  $\hat{K}$ 是一个几何实体，称为**参考单元 (reference element)**，例如二维的单位正方形或单位三角形。
2.  $\hat{\mathcal{P}}$ 是一个定义在 $\hat{K}$ 上的有限维[函数空间](@entry_id:143478)，通常是[多项式空间](@entry_id:144410)，称为**[试探空间](@entry_id:756166) (trial space)**。
3.  $\hat{\Sigma} = \{\ell_i\}_{i=1}^n$ 是一个由 $n$ 个定义在 $\hat{\mathcal{P}}$ 上的[线性无关](@entry_id:148207)的**[线性泛函](@entry_id:276136) (linear functionals)** 组成的集合，其中 $n = \dim(\hat{\mathcal{P}})$。这些泛函定义了单元的**自由度 (degrees of freedom)**。该集合必须是**单值可解的 (unisolvent)**，即如果一个函数 $v \in \hat{\mathcal{P}}$ 满足 $\ell_i(v) = 0$ 对所有 $i=1, \dots, n$ 成立，那么 $v$ 必然是零函数。

#### 对偶基与克罗内克-德尔[塔性质](@entry_id:273153)

在此框架下，**形函数** $\{N_i\}_{i=1}^n$ 被定义为构成[试探空间](@entry_id:756166) $\hat{\mathcal{P}}$ 的一组**[基函数](@entry_id:170178) (basis functions)**，它们与自由度泛函集 $\hat{\Sigma}$ 构成**对偶关系 (duality relationship)**。这种对偶关系通过以下条件精确表达 [@problem_id:2586137]：
$$
\ell_j(N_i) = \delta_{ij} \quad \forall i,j \in \{1, \dots, n\}
$$
其中 $\delta_{ij}$ 是**克罗内克-德尔塔 (Kronecker delta)** 符号，当 $i=j$ 时其值为 $1$，当 $i \neq j$ 时为 $0$。这个方程从根本上定义了形函数 $N_i$：它是一个在施加第 $i$ 个自由度泛函时值为 $1$，而在施加所有其他自由度泛函时值为 $0$ 的[基函数](@entry_id:170178)。这一关系是克罗内克-德尔[塔性质](@entry_id:273153)的最普适形式。

#### [拉格朗日形函数](@entry_id:635448)

在有限元法中最常见的一类单元是**拉格朗日单元 (Lagrange elements)**。对于这类单元，自由度是通过在单元上的一组**节点 (nodes)** $\{\boldsymbol{\xi}_j\}_{j=1}^n$ 处的函数值来定义的。因此，其[线性泛函](@entry_id:276136)是简单的**点求值算子**：
$$
\ell_j(v) = v(\boldsymbol{\xi}_j)
$$
将此具体形式的泛函代入普适的对偶关系式中，我们便得到了[拉格朗日形函数](@entry_id:635448)所满足的、更为人熟知的克罗内克-德尔[塔性质](@entry_id:273153) [@problem_id:2586137]：
$$
N_i(\boldsymbol{\xi}_j) = \delta_{ij}
$$
这个表达式的直观含义是：形函数 $N_i$ 在其关联的节点 $\boldsymbol{\xi}_i$ 处取值为 $1$，而在所有其他节点 $\boldsymbol{\xi}_j$ ($j \neq i$) 处取值为 $0$。

#### 克罗内克-德尔[塔性质](@entry_id:273153)的直接推论：节点插值

克罗内克-德尔[塔性质](@entry_id:273153)的核心作用在于确保**节点插值 (nodal interpolation)** 的准确性。给定一个场 $u(\boldsymbol{\xi})$，其[有限元近似](@entry_id:166278)或[插值函数](@entry_id:262791) $u^h(\boldsymbol{\xi})$ 被构造为形函数的[线性组合](@entry_id:154743)：
$$
u^h(\boldsymbol{\xi}) = \sum_{i=1}^{n} u_i N_i(\boldsymbol{\xi})
$$
对于拉格朗日单元，系数 $u_i$ 就是场在节点处的**自由度**，即 $u_i = \ell_i(u) = u(\boldsymbol{\xi}_i)$。现在，我们来考察近似函数 $u^h$ 在任意节点 $\boldsymbol{\xi}_j$ 处的值：
$$
u^h(\boldsymbol{\xi}_j) = \sum_{i=1}^{n} u_i N_i(\boldsymbol{\xi}_j)
$$
利用克罗内克-德尔[塔性质](@entry_id:273153) $N_i(\boldsymbol{\xi}_j) = \delta_{ij}$，上式中的求和项只有在 $i=j$ 时才非零，因此：
$$
u^h(\boldsymbol{\xi}_j) = \sum_{i=1}^{n} u_i \delta_{ij} = u_j
$$
这个结果表明，近似函数 $u^h$ 在每个节点处的值都精确地等于该节点的自由度 $u_j$。这正是“插值”一词的含义 [@problem_id:2586139]。值得注意的是，这一性质是克罗内克-德尔塔条件的直接推论，而并非由其他性质（如单位分解）所保证。如果一组[基函数](@entry_id:170178)不具备克罗内克-德尔[塔性质](@entry_id:273153)（例如用于[Bézier曲线](@entry_id:160922)的[Bernstein基多项式](@entry_id:169836)），那么通过简单地将节点值作为系数所构造的函数通常不会穿过这些节点。

### 单位分解性质及其重要推论

与克罗内克-德尔[塔性质](@entry_id:273153)同等重要的是**单位分解性质 (partition of unity property)**，它指的是在单元内的任意一点 $\boldsymbol{\xi}$，所有形函数的值之和恒为 $1$：
$$
\sum_{i=1}^{n} N_i(\boldsymbol{\xi}) = 1 \quad \forall \boldsymbol{\xi} \in \hat{K}
$$

#### [单位分解](@entry_id:150115)的起源：常数场再生

单位分解性质的根本来源是[有限元近似](@entry_id:166278)的一个基本要求：能够**精确再生 (exactly reproduce)** 常数场。这是保证收敛性的最低阶[一致性条件](@entry_id:637057)。假设我们要插值一个常数场 $u(\boldsymbol{\xi}) = c$。其节点值为 $u_i = u(\boldsymbol{\xi}_i) = c$。其[插值函数](@entry_id:262791)为：
$$
u^h(\boldsymbol{\xi}) = \sum_{i=1}^{n} u_i N_i(\boldsymbol{\xi}) = \sum_{i=1}^{n} c N_i(\boldsymbol{\xi}) = c \left( \sum_{i=1}^{n} N_i(\boldsymbol{\xi}) \right)
$$
为了使插值完全精确，即 $u^h(\boldsymbol{\xi}) = c$ 对所有 $\boldsymbol{\xi}$ 成立，括号内的求和项必须恒等于 $1$。因此，单位分解性质是保证任何常数场都能被有限元空间无误差表示的充分必要条件 [@problem_id:2586137] [@problem_id:2586143]。这一要求对于包含常数项（即 $P_0$ 空间）的任何标准多项式[试探空间](@entry_id:756166)都是成立的。

#### [单位分解](@entry_id:150115)的数学推论

[单位分解](@entry_id:150115)性质是一条强大的恒等式，它在整个单元域上都成立，从而引出一系列重要的推论。

首先，对该恒等式求梯度，由于常数 $1$ 的梯度为零向量，我们得到 [@problem_id:2586143]：
$$
\nabla \left( \sum_{i=1}^{n} N_i(\boldsymbol{\xi}) \right) = \nabla(1) \implies \sum_{i=1}^{n} \nabla N_i(\boldsymbol{\xi}) = \mathbf{0}
$$
这意味着所有形函数的梯度之和在任意点都为零。这一推论保证了插值常数场的梯度也能够被精确再生为零，这在[应力应变](@entry_id:204183)分析等应用中至关重要。

其次，在物理应用中，单位分解性质确保了物理量的守恒。例如，在伽辽金 (Galerkin) [有限元列式](@entry_id:164720)中，一个均匀[体力](@entry_id:174230)源 $b_0$ 对单元产生的节点力向量为 $f_i^{(e)} = \int_{\Omega_e} N_i(\boldsymbol{x}) b_0 \, \mathrm{d}\Omega$。所有节点力的总和为：
$$
\sum_{i=1}^{n} f_i^{(e)} = \sum_{i=1}^{n} \int_{\Omega_e} N_i(\boldsymbol{x}) b_0 \, \mathrm{d}\Omega = b_0 \int_{\Omega_e} \left( \sum_{i=1}^{n} N_i(\boldsymbol{x}) \right) \mathrm{d}\Omega
$$
应用单位分解性质，括号内的和为 $1$，因此：
$$
\sum_{i=1}^{n} f_i^{(e)} = b_0 \int_{\Omega_e} 1 \, \mathrm{d}\Omega = b_0 |\Omega_e|
$$
这表明，施加在单元上的总力被精确地分配到了各个节点上 [@problem_id:2586143]。同理，对于[一致质量矩阵](@entry_id:174630) $\boldsymbol{M}^{(e)}$，其中 $M_{ij} = \int_{\Omega_e} \rho N_i N_j \, \mathrm{d}\Omega$ (假设密度 $\rho$ 为常数)，第 $i$ 行的行和 (row sum) 为 $s_i = \sum_j M_{ij} = \rho \int_{\Omega_e} N_i(\boldsymbol{x}) \, \mathrm{d}\Omega$。所有行和的总和，即矩阵所有元素的总和，则精确等于单元的总质量 $\rho |\Omega_e|$ [@problem_id:2586172]。

#### 具体实例：双线性[四边形单元](@entry_id:176937)

为了将上述抽象概念具体化，我们考察一个标准的**四节点[双线性](@entry_id:146819)[四边形单元](@entry_id:176937) ($Q_4$)**。其参考单元是在参数坐标 $(\xi, \eta)$ 下的单位正方形 $[-1,1]^2$。节点按逆时针顺序编号为 $1:(-1,-1)$, $2:(+1,-1)$, $3:(+1,+1)$, $4:(-1,+1)$。

这些形函数可以通过**[张量积](@entry_id:140694) (tensor product)** 的方法构造。首先，我们定义一维 $[-1,1]$ 区间上的线性[拉格朗日基](@entry_id:751105)函数：
$$
L_1(\zeta) = \frac{1-\zeta}{2}, \quad L_2(\zeta) = \frac{1+\zeta}{2}
$$
$L_1$ 在 $\zeta=-1$ 处为 $1$，在 $\zeta=+1$ 处为 $0$；$L_2$ 则相反。二维的形函数 $N_i(\xi,\eta)$ 通过将 $\xi$ 方向和 $\eta$ 方向的一维[基函数](@entry_id:170178)相乘得到。例如，对于节点 $1(-1,-1)$，我们需要一个在 $\xi=-1$ 和 $\eta=-1$ 处都为 $1$ 的函数，因此我们选择 $L_1(\xi)$ 和 $L_1(\eta)$ 的乘积。遵循此逻辑，四个形函数为 [@problem_id:2586135]：
$$
\begin{align*}
N_1(\xi,\eta)  = L_1(\xi)L_1(\eta) = \frac{1}{4}(1-\xi)(1-\eta) \\
N_2(\xi,\eta)  = L_2(\xi)L_1(\eta) = \frac{1}{4}(1+\xi)(1-\eta) \\
N_3(\xi,\eta)  = L_2(\xi)L_2(\eta) = \frac{1}{4}(1+\xi)(1+\eta) \\
N_4(\xi,\eta)  = L_1(\xi)L_2(\eta) = \frac{1}{4}(1-\xi)(1+\eta)
\end{align*}
$$
通过直接代入节点坐标，可以验证这些函数满足克罗内克-德尔[塔性质](@entry_id:273153)。例如，$N_1(1,-1) = \frac{1}{4}(1-1)(1-(-1))=0$，$N_1(-1,-1) = \frac{1}{4}(1-(-1))(1-(-1))=1$。将这四个函数相加，经过简单的代数化简，可以验证它们的和恒等于 $1$，从而满足[单位分解](@entry_id:150115)性质。

### 从局部到全局：性质的保持

到目前为止，我们的讨论都集中在单个参考单元上。一个实际的有限元模型是由大量单元组成的网格。因此，我们需要理解这些基本性质是如何从**局部 (local)** 的单元层面过渡到**全局 (global)** 的网格层面的。

#### 局部形函数与[全局基函数](@entry_id:749917)

在**协调 (conforming)** 有限元方法中，整个求解域 $\Omega$ 被剖分成一个单元网格 $\mathcal{T}_h$。每个物理单元 $K \in \mathcal{T}_h$ 都通过一个可逆的**单元映射** $F_K: \hat{K} \to K$ 从[参考单元](@entry_id:168425) $\hat{K}$ 变换而来。定义在参考单元上的局部形函数 $\hat{N}_a(\hat{\boldsymbol{x}})$ 通过复合映射成为定义在物理单元上的形函数 $N_a^K(\boldsymbol{x}) = \hat{N}_a(F_K^{-1}(\boldsymbol{x}))$。

网格中的每个节点都被赋予一个唯一的全局编号，从 $1$ 到 $N$ (总节点数)。单元的局部节点编号 (例如，从 $1$ 到 $n_{\text{loc}}$) 通过一个**局部-全局映射表** $\mathcal{I}_K$ 与全局节点编号相关联。

**[全局基函数](@entry_id:749917) (global basis function)** $\varphi_i(\boldsymbol{x})$ 是与全局节点 $i$ 相关联的、定义在整个域 $\Omega$ 上的函数。它是通过“拼接”所有包含全局节点 $i$ 的单元的局部形函数而成的。具体来说，对于任意单元 $K$，如果全局节点 $i$ 对应于其局部节点 $a$ (即 $\mathcal{I}_K(a)=i$)，则 $\varphi_i$ 在 $K$ 上的表达式就是 $N_a^K$；否则，$\varphi_i$ 在 $K$ 上的值为零 [@problem_id:2586161]。由于在单元边界上，相邻单元共享的节点的形函数值是匹配的，这保证了[全局基函数](@entry_id:749917) $\varphi_i$ 在整个域上是连续的 ($C^0$ 连续)。

#### 全局克罗内克-德尔[塔性质](@entry_id:273153)与单位分解

通过上述的构造过程，局部形函数的基本性质被完美地继承到了[全局基函数](@entry_id:749917)上。

对于任意两个全局节点 $x_i$ 和 $x_j$，[全局基函数](@entry_id:749917) $\varphi_i$ 在 $x_j$ 处的值 $\varphi_i(x_j)$ 满足**全局克罗内克-德尔[塔性质](@entry_id:273153)** [@problem_id:2586161]：
$$
\varphi_i(x_j) = \delta_{ij}
$$
这是因为：如果 $i=j$，$\varphi_i$ 在其关联节点 $x_i$ 处的值由任何包含该节点的单元的局部形函数给出，该值恒为 $1$。如果 $i \neq j$，且 $x_j$ 位于某个包含节点 $x_i$ 的单元上，那么在局部层面，$\varphi_i$ 对应于一个局部形函数 $N_a^K$，而 $x_j$ 对应于另一个局部节点 $b \neq a$，根据局部克罗内克-德尔[塔性质](@entry_id:273153)，$N_a^K(x_j)=0$。如果 $x_j$ 不在任何包含 $x_i$ 的单元上，则 $\varphi_i$ 在 $x_j$ 所在单元的值定义为零。

同样，**全局单位分解性质**也成立。在域 $\Omega$ 内的任意一点 $\boldsymbol{x}$，该点必定属于某个单元 $K$。在该点，只有与单元 $K$ 的节点相关联的[全局基函数](@entry_id:749917)才可能非零。因此，所有[全局基函数](@entry_id:749917)在该点的值之和，就等于单元 $K$ 上所有局部形函数的值之和，根据局部[单位分解](@entry_id:150115)性质，这个和为 $1$：
$$
\sum_{i=1}^{N} \varphi_i(\boldsymbol{x}) = 1 \quad \forall \boldsymbol{x} \in \Omega
$$

### 关键性质的实践应用

这些抽象的性质在有限元分析的实际操作中扮演着至关重要的角色。

#### [狄利克雷边界条件](@entry_id:173524)的强施加

在求解偏微分方程时，**本质边界条件 (essential boundary conditions)**，例如狄利克雷 (Dirichlet) 边界条件，必须被精确满足。对于[拉格朗日有限元](@entry_id:751107)，全局克罗内克-德尔[塔性质](@entry_id:273153)使得这一操作变得异常简单 [@problem_id:2586165]。

全局有限元解可以表示为 $u_h(\boldsymbol{x}) = \sum_{j=1}^N u_j \varphi_j(\boldsymbol{x})$。由于 $\varphi_j(x_i) = \delta_{ij}$，在任意节点 $x_i$ 处，解的值为 $u_h(x_i) = u_i$。这意味着系数 $u_i$ 就是解在节点 $i$ 处的物理值。因此，要在边界节点 $x_i$ 上施加一个给定的边界条件 $u(x_i) = g_i$，我们只需直接将对应的未知系数设置为该值，即 $u_i = g_i$。这种方法被称为**强施加 (strong imposition)**。

#### 边界条件施加的代数效应

这种对系数的直接指定，在代数上表现为对最终的线性方程系统 $\boldsymbol{K}\boldsymbol{u}=\boldsymbol{f}$ 的修改。假设我们将节点分为**自由节点** (下标 $f$) 和**约束节点** (下标 $c$) 两部分，方程系统可以分块写为：
$$
\begin{pmatrix}
\boldsymbol{K}_{ff} & \boldsymbol{K}_{fc} \\
\boldsymbol{K}_{cf} & \boldsymbol{K}_{cc}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{u}_f \\
\boldsymbol{u}_c
\end{pmatrix}
=
\begin{pmatrix}
\boldsymbol{f}_f \\
\boldsymbol{f}_c
\end{pmatrix}
$$
由于约束节点的位移向量 $\boldsymbol{u}_c$ 已知（等于给定的边界值向量 $\boldsymbol{g}_c$），我们可以将其代入第一行方程：
$$
\boldsymbol{K}_{ff} \boldsymbol{u}_f + \boldsymbol{K}_{fc} \boldsymbol{g}_c = \boldsymbol{f}_f
$$
整理后得到一个只包含自由节点未知数 $\boldsymbol{u}_f$ 的、规模更小的线性系统 [@problem_id:2586165]：
$$
\boldsymbol{K}_{ff} \boldsymbol{u}_f = \boldsymbol{f}_f - \boldsymbol{K}_{fc} \boldsymbol{g}_c
$$
求解该系统得到 $\boldsymbol{u}_f$ 后，完整的解向量 $\boldsymbol{u}$ 就完全确定了。

#### 单元检验

**单元检验 (patch test)** 是验证有限元实现正确性的一个基本标准。它要求在一个由多个单元组成的“补丁”上，如果施加的边界条件对应于一个常应变状态（即仿射[位移场](@entry_id:141476) $u^*(\boldsymbol{x}) = \boldsymbol{a} + \boldsymbol{B}\boldsymbol{x}$），那么有限元解必须精确地重现这个常应变状态。

单元能否通过检验，根本上取决于其**[函数空间](@entry_id:143478)的完备性 (completeness)**，即它必须能够精确表示任何仿射场。对于使用标准多项式的等参拉格朗日单元，这一条件通常是满足的。在此前提下，克罗内克-德尔[塔性质](@entry_id:273153)的作用是提供一种便捷的途径来施加仿射[位移边界条件](@entry_id:203261)。通过在边界节点上强行施加精确的节点位移 $d_i = u^*(x_i)$，我们为离散系统提供了“正确答案”的边界信息。由于函数空间本身就包含这个“正确答案”，并且[伽辽金法](@entry_id:749698)的解是唯一的，所以最终的有限元解 $u_h$ 将与精确解 $u^*$ 完全一致，从而通过检验 [@problem_id:2586141]。

### 超越基本性质：非负性及其意义

最后，我们讨论一个不总是成立、但却非常理想的性质：**非负性 (non-negativity)**，即 $N_i(\boldsymbol{x}) \ge 0$ 对单元内所有点成立。

#### 形函数的非负性

[单位分解](@entry_id:150115)性质本身并不要求形函数是非负的，它只约束了它们的和。事实上，许多常用的单元，特别是高阶拉格朗日单元，其形函数在单元内部会取负值。此外，即使是双线性单元，当其几何形状从标准的矩形或平行四边形发生畸变时，其形函数也可能出现负值 [@problem_id:2586162]。

考虑一个物理坐标顶点为 $1:(0,0)$, $2:(2,0)$, $3:(2, 1/5)$, $4:(0,3)$ 的[四边形单元](@entry_id:176937)。这是一个凸四边形，但由于节点 $3$ 的位置，它显得有些“内凹”。我们可以通过求解一个[线性方程组](@entry_id:148943)来找到在物理坐标下定义的[双线性](@entry_id:146819)形函数。利用插值性质，我们发现在该单元内部点 $(1,1)$ 处，四个形函数的值为 [@problem_id:2586118]：
$$
\begin{pmatrix} N_1(1,1) & N_2(1,1) & N_3(1,1) & N_4(1,1) \end{pmatrix} = \begin{pmatrix} \frac{1}{3} & -2 & \frac{5}{2} & \frac{1}{6} \end{pmatrix}
$$
可见，形函数 $N_2$ 在该点的值为负。

#### 非负性与离散极值原理

形函数的非负性虽然不是必须的，但在某些应用中却极为重要，特别是对于[扩散](@entry_id:141445)问题。当非负性 ($N_i \ge 0$) 与[单位分解](@entry_id:150115)性 ($\sum N_i = 1$) 同时满足时，[插值函数](@entry_id:262791) $u_h(\boldsymbol{x}) = \sum u_i N_i(\boldsymbol{x})$ 就成了节点值 $\{u_i\}$ 的一个**凸组合 (convex combination)**。

凸组合的一个重要结果是，[插值函数](@entry_id:262791)的值永远不会超过其节点值的最大值，也不会低于其最小值：
$$
\min_{i} u_i \le u_h(\boldsymbol{x}) \le \max_{i} u_i
$$
这可以防止在单元内部产生非物理的**过冲 (overshoot)** 或**下冲 (undershoot)** 现象。在模拟热传导或物质[扩散](@entry_id:141445)等问题时，这一特性与**离散极值原理 (Discrete Maximum Principle, DMP)** 密切相关，它保证了数值解不会在没有物理源的情况下产生新的[局部极值](@entry_id:144991)。通常，满足DMP的有限元格式其刚度矩阵具有**[M-矩阵](@entry_id:189121)**的性质（对角元为正，非对角元非正），而形函数的非负性是通向这一目标的关键一步 [@problem_id:2586162]。

回到前面几何畸变的例子，由于 $N_2(1,1) = -2  0$，插值不再是[凸组合](@entry_id:635830)。如果我们设定节点值 $u_1=1, u_3=1, u_4=1$ 且 $u_2=0$ (所有节点值都在 $[0,1]$ 区间内)，那么在点 $(1,1)$ 的插值结果为：
$$
u_h(1,1) = \frac{1}{3}(1) -2(0) + \frac{5}{2}(1) + \frac{1}{6}(1) = \frac{1}{3} + \frac{5}{2} + \frac{1}{6} = 3
$$
插值结果 $3$ 远远超出了节点值的最大值 $1$ [@problem_id:2586118]。这个例子生动地说明了，违反非负性可能导致数值解出现与物理直觉相悖的[振荡](@entry_id:267781)。因此，在设计[有限元网格](@entry_id:174862)时，应尽量避免使用形状严重畸变的单元，以保持形函数的良好性质。