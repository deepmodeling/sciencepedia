{"hands_on_practices": [{"introduction": "求解大型稀疏线性方程组 $K u = f$ 是有限元分析中的核心计算任务。对于这类问题，迭代法通常比直接法更具优势。本练习将通过推导经典定常迭代法（如雅可比法和高斯-赛德尔法）的核心机制，帮助您建立直观的理解。通过从第一性原理出发推导迭代矩阵，并为一个简单实例验证收敛性，您将能够巩固关于谱半径的抽象收敛理论。[@problem_id:2596855]", "problem": "一个对称、强制椭圆边值问题的有限元方法 (FEM) 离散化产生了一个形如 $K u = f$ 的线性系统，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵，$f \\in \\mathbb{R}^{n}$。求解 $K u = f$ 的定常迭代法可以由矩阵分裂 $K = M - N$ 构造，其中 $M$ 是非奇异的，从而得到形如 $u^{(k+1)} = M^{-1} N u^{(k)} + M^{-1} f$ 的不动点迭代。相关的迭代矩阵是 $T = M^{-1} N$，当且仅当 $T$ 的谱半径严格小于 1 时，该方法对任意初始猜测收敛。\n\n仅使用这些基本事实和典范分解 $K = D - L - U$（其中 $D$ 是 $K$ 的对角部分，$-L$ 是 $K$ 的严格下三角部分，$-U$ 是 $K$ 的严格上三角部分），完成以下任务：\n\n- 从第一性原理出发，推导分别对应于雅可比 (Jacobi) 方法、高斯-赛德尔 (Gauss-Seidel) 方法和逐次超松弛 (SOR) 方法的迭代矩阵 $T_{\\text{J}}$、$T_{\\text{GS}}$ 和 $T_{\\text{SOR}}$。\n- 陈述每种方法的收敛条件（用谱半径表示），并根据迭代矩阵的特征值来解释它。\n\n最后，考虑在 $[0,1]$ 上对模型问题 $-u'' = f$（带齐次狄利克雷边界条件）使用具有 2 个内部节点的均匀网格进行标准线性有限元离散化所得到的全局刚度矩阵 $K \\in \\mathbb{R}^{2 \\times 2}$。这会得到\n$$\nK = \\begin{pmatrix}\n2  -1 \\\\\n-1  2\n\\end{pmatrix}.\n$$\n对于这个 $K$，明确计算高斯-赛德尔迭代矩阵 $T_{\\text{GS}}$ 及其谱半径。将 $T_{\\text{GS}}$ 的谱半径作为最终答案报告。无需四舍五入。", "solution": "问题陈述已被解析并被认为是有效的。它具有科学依据，问题设定良好，且不含歧义或矛盾。它提出了一个数值线性代数中的标准练习，具体涉及对来自有限元离散化的线性系统定常迭代方法的分析。我们将着手求解。\n\n该问题要求推导几种经典定常迭代方法的迭代矩阵，讨论它们的收敛性，并对给定的矩阵 $K$ 进行具体计算。迭代的一般形式为 $u^{(k+1)} = T u^{(k)} + c$，其中 $T$ 是迭代矩阵， $c = M^{-1} f$。当且仅当迭代矩阵的谱半径 $\\rho(T)$ 严格小于 1 时，该方法收敛。谱半径定义为 $\\rho(T) = \\max_i |\\lambda_i(T)|$，其中 $\\lambda_i(T)$ 是 $T$ 的特征值。我们已知线性系统 $K u = f$ 以及矩阵 $K$ 分解为其对角 ($D$)、严格下三角 ($-L$) 和严格上三角 ($-U$) 部分的典范分裂，即 $K = D - L - U$。\n\n首先，我们推导迭代矩阵 $T_{\\text{J}}$、$T_{\\text{GS}}$ 和 $T_{\\text{SOR}}$。迭代矩阵 $T$ 由 $K$ 分裂为 $K = M - N$ 而来，其中 $M$ 是非奇异的。迭代过程为 $M u^{(k+1)} = N u^{(k)} + f$，等价于 $u^{(k+1)} = M^{-1} N u^{(k)} + M^{-1} f$。因此，迭代矩阵是 $T = M^{-1} N$。由于 $N = M - K$，这也可以表示为 $T = M^{-1}(M - K) = I - M^{-1}K$。\n\n对于雅可比方法，分裂的选择使得 $M$ 是 $K$ 的对角部分。\n- 分裂：$M_{\\text{J}} = D$ 和 $N_{\\text{J}} = L + U$。\n- 迭代矩阵：$T_{\\text{J}} = M_{\\text{J}}^{-1} N_{\\text{J}} = D^{-1}(L + U)$。\n雅可比方法的收敛条件是其迭代矩阵的谱半径小于 1：$\\rho(T_{\\text{J}})  1$。这意味着 $T_{\\text{J}}$ 的最大模特征值必须严格小于 1。\n\n对于高斯-赛德尔方法，分裂的选择使得 $M$ 是 $K$ 的下三角部分，包括对角线。\n- 分裂：$M_{\\text{GS}} = D - L$ 和 $N_{\\text{GS}} = U$。\n- 迭代矩阵：$T_{\\text{GS}} = M_{\\text{GS}}^{-1} N_{\\text{GS}} = (D - L)^{-1} U$。\n高斯-赛德尔方法的收敛条件是 $\\rho(T_{\\text{GS}})  1$，这要求 $(D-L)^{-1}U$ 的最大模特征值严格小于 1。\n\n对于逐次超松弛 (SOR) 方法，引入了一个松弛参数 $\\omega$。迭代过程被构造为前一次迭代和高斯-赛德尔更新的加权平均。这导致了以下分裂：\n- 分裂：$M_{\\text{SOR}} = \\frac{1}{\\omega}(D - \\omega L)$ 和 $N_{\\text{SOR}} = \\frac{1}{\\omega}((1-\\omega)D + \\omega U)$。\n为了验证这一点，我们检查 $M_{\\text{SOR}} - N_{\\text{SOR}} = \\frac{1}{\\omega}(D - \\omega L) - \\frac{1}{\\omega}((1-\\omega)D + \\omega U) = \\frac{1}{\\omega}(D - \\omega L - D + \\omega D - \\omega U) = D - L - U = K$。\n- 迭代矩阵：$T_{\\text{SOR}} = M_{\\text{SOR}}^{-1} N_{\\text{SOR}} = \\left(\\frac{1}{\\omega}(D - \\omega L)\\right)^{-1} \\left(\\frac{1}{\\omega}((1-\\omega)D + \\omega U)\\right) = (D - \\omega L)^{-1}((1-\\omega)D + \\omega U)$。\nSOR 方法的收敛条件是 $\\rho(T_{\\text{SOR}})  1$，这取决于松弛参数 $\\omega$ 的选择。\n\n接下来，我们处理给定矩阵的具体情况：\n$$\nK = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\n$$\n我们必须首先计算高斯-赛德尔迭代矩阵 $T_{\\text{GS}}$ 及其谱半径。我们将 $K$ 分解为 $D$、$L$ 和 $U$。\n- 对角部分是 $D = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}$。\n- 严格下三角部分是 $-L = \\begin{pmatrix} 0  0 \\\\ -1  0 \\end{pmatrix}$，这意味着 $L = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$。\n- 严格上三角部分是 $-U = \\begin{pmatrix} 0  -1 \\\\ 0  0 \\end{pmatrix}$，这意味着 $U = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$。\n\n高斯-赛德尔迭代矩阵是 $T_{\\text{GS}} = (D-L)^{-1}U$。首先，我们计算 $D-L$：\n$$\nD - L = \\begin{pmatrix} 2  0 \\\\ -1  2 \\end{pmatrix}\n$$\n接下来，我们求这个矩阵的逆矩阵 $(D-L)^{-1}$。对于一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆矩阵是 $\\frac{1}{ad-bc}\\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n$D-L$ 的行列式是 $(2)(2) - (0)(-1) = 4$。\n$$\n(D - L)^{-1} = \\frac{1}{4} \\begin{pmatrix} 2  0 \\\\ 1  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ \\frac{1}{4}  \\frac{1}{2} \\end{pmatrix}\n$$\n现在我们通过将 $(D-L)^{-1}$ 乘以 $U$ 来计算 $T_{\\text{GS}}$：\n$$\nT_{\\text{GS}} = (D-L)^{-1}U = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ \\frac{1}{4}  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} (\\frac{1}{2})(0) + (0)(0)  (\\frac{1}{2})(1) + (0)(0) \\\\ (\\frac{1}{4})(0) + (\\frac{1}{2})(0)  (\\frac{1}{4})(1) + (\\frac{1}{2})(0) \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{1}{2} \\\\ 0  \\frac{1}{4} \\end{pmatrix}\n$$\n最后，我们计算 $T_{\\text{GS}}$ 的谱半径。我们通过求解特征方程 $\\det(T_{\\text{GS}} - \\lambda I) = 0$ 来找到特征值 $\\lambda$。\n$$\n\\det\\left(\\begin{pmatrix} 0  \\frac{1}{2} \\\\ 0  \\frac{1}{4} \\end{pmatrix} - \\begin{pmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{pmatrix}\\right) = \\det\\begin{pmatrix} -\\lambda  \\frac{1}{2} \\\\ 0  \\frac{1}{4} - \\lambda \\end{pmatrix} = 0\n$$\n行列式是 $(-\\lambda)(\\frac{1}{4} - \\lambda) - (\\frac{1}{2})(0) = -\\lambda(\\frac{1}{4} - \\lambda) = 0$。\n特征值是此方程的根：$\\lambda_1 = 0$ 和 $\\lambda_2 = \\frac{1}{4}$。\n谱半径是特征值绝对值的最大值：\n$$\n\\rho(T_{\\text{GS}}) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max\\left(|0|, \\left|\\frac{1}{4}\\right|\\right) = \\max\\left(0, \\frac{1}{4}\\right) = \\frac{1}{4}\n$$\n对于给定的 $K$，高斯-赛德尔迭代矩阵的谱半径是 $\\frac{1}{4}$。", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "2596855"}, {"introduction": "基础迭代方法的收敛速度可能很慢，尤其是在网格加密时。预处理技术是加速收敛的关键，它通过将原系统 $K u = f$ 变换为一个谱特性更好、更容易求解的等价系统。本练习将引导您对一个典型的有限元模型问题进行深入的解析，分析最简单的预处理器之一——雅可比预处理器——的效果。通过推导预处理后系统矩阵条件数的精确表达式，您将能定量地理解网格尺寸如何影响收敛性，并体会预处理在改善系统谱分布中的核心作用。[@problem_id:2596789]", "problem": "考虑在单位区间上的一个标量二阶自伴椭圆算子的边值问题，其边界条件为齐次狄利克雷边界条件。设其弱形式为：寻找 $u \\in H_{0}^{1}(0,1)$，使得对于任意 $v \\in H_{0}^{1}(0,1)$，\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} f(x)\\,v(x)\\,\\mathrm{d}x.\n$$\n使用连续分片线性有限元在均匀网格上离散化此问题，网格尺寸为 $h = \\frac{1}{n+1}$，其中 $n$ 是内部节点（自由度）的数量。记所得到的全局刚度矩阵为 $K \\in \\mathbb{R}^{n \\times n}$。矩阵 $K$ 是对称正定的 (SPD)。考虑雅可比预条件子 $M = D$，其中 $D$ 是 $K$ 的对角部分，以及对称预处理矩阵\n$$\nJ \\;=\\; D^{-\\frac{1}{2}}\\,K\\,D^{-\\frac{1}{2}}.\n$$\n从双线性形式的定义和节点基的构造出发，显式地组装 $K$ 和 $D$，然后分析 $J$ 的谱。推导 $J$ 的条件数的闭式表达式，该条件数定义为其最大特征值与最小特征值之比，并表示为 $n$ 的函数。你的最终答案必须是一个关于 $n$ 的无单位的解析表达式。不要提供不等式；给出精确表达式。", "solution": "所述问题在科学上是合理的、适定的，并包含唯一解所需的所有信息。我们着手进行推导。\n\n问题是寻找 $u \\in H_{0}^{1}(0,1)$，使得对于所有 $v \\in H_{0}^{1}(0,1)$，以下弱形式成立：\n$$\na(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x = \\int_{0}^{1} f(x)\\,v(x)\\,\\mathrm{d}x = L(v).\n$$\n我们使用均匀网格离散化区域 $[0, 1]$，节点为 $x_i = i h$，其中 $i=0, 1, \\dots, n+1$，网格尺寸为 $h = \\frac{1}{n+1}$。自由度对应于 $n$ 个内部节点 $x_1, \\dots, x_n$。\n\n有限元空间 $V_h \\subset H_0^1(0,1)$ 由连续分片线性函数组成。该空间由节点基函数 $\\{\\phi_i(x)\\}_{i=1}^n$（通常称为“帽子函数”）张成。每个基函数 $\\phi_i(x)$ 定义为分片线性的，满足 $\\phi_i(x_j) = \\delta_{ij}$（对于 $i,j \\in \\{1, \\dots, n\\}$）以及 $\\phi_i(0) = \\phi_i(1) = 0$。\n\n$\\phi_i(x)$ 的显式形式为：\n$$\n\\phi_i(x) =\n\\begin{cases}\n\\frac{x - x_{i-1}}{h}  \\text{for } x \\in [x_{i-1}, x_i] \\\\\n\\frac{x_{i+1} - x}{h}  \\text{for } x \\in [x_i, x_{i+1}] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n其导数 $\\phi_i'(x)$ 是一个分片常数函数：\n$$\n\\phi_i'(x) =\n\\begin{cases}\n\\frac{1}{h}  \\text{for } x \\in (x_{i-1}, x_i) \\\\\n-\\frac{1}{h}  \\text{for } x \\in (x_i, x_{i+1}) \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n全局刚度矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 的元素由 $K_{ij} = a(\\phi_j, \\phi_i) = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\,\\mathrm{d}x$ 给出。\n\n首先，我们计算对角元素 $K_{ii}$：\n$$\nK_{ii} = \\int_{0}^{1} (\\phi_i'(x))^2 \\,\\mathrm{d}x = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2 \\,\\mathrm{d}x + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2 \\,\\mathrm{d}x\n$$\n$$\nK_{ii} = \\frac{1}{h^2}(x_i - x_{i-1}) + \\frac{1}{h^2}(x_{i+1} - x_i) = \\frac{1}{h^2}(h) + \\frac{1}{h^2}(h) = \\frac{2}{h}.\n$$\n接下来，我们计算非对角元素 $K_{i, i+1}$。$\\phi_i'(x)$ 和 $\\phi_{i+1}'(x)$ 的支集仅在区间 $(x_i, x_{i+1})$ 上重叠。\n$$\nK_{i,i+1} = \\int_{0}^{1} \\phi_i'(x) \\phi_{i+1}'(x) \\,\\mathrm{d}x = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\,\\mathrm{d}x = -\\frac{1}{h^2}(x_{i+1} - x_i) = -\\frac{1}{h}.\n$$\n根据双线性形式的对称性，有 $K_{i+1,i} = K_{i,i+1} = -\\frac{1}{h}$。\n对于 $|i-j|  1$ 的情况，$\\phi_i'(x)$ 和 $\\phi_j'(x)$ 的支集不相交，因此它们的乘积处处为零。所以，$K_{ij} = \\int_{0}^{1} 0 \\,\\mathrm{d}x = 0$。\n\n所得到的刚度矩阵 $K$ 是一个对称三对角矩阵：\n$$\nK = \\frac{1}{h} \\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\ddots  \\vdots \\\\\n0  -1  2  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{pmatrix}_{n \\times n}.\n$$\n雅可比预条件子是 $M=D$，其中 $D$ 是 $K$ 的对角部分。根据我们对 $K_{ii}$ 的计算，我们有：\n$$\nD = \\mathrm{diag}(K) = \\frac{2}{h} I_n,\n$$\n其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n\n对称预处理矩阵 $J$ 定义为 $J = D^{-1/2} K D^{-1/2}$。我们有：\n$$\nD^{1/2} = \\sqrt{\\frac{2}{h}} I_n \\quad \\text{and} \\quad D^{-1/2} = \\sqrt{\\frac{h}{2}} I_n.\n$$\n将这些代入 $J$ 的表达式中：\n$$\nJ = \\left(\\sqrt{\\frac{h}{2}} I_n\\right) \\left(\\frac{1}{h} \\begin{pmatrix}\n2  -1   \\\\\n-1  2  \\ddots  \\\\\n \\ddots  \\ddots  -1 \\\\\n  -1  2\n\\end{pmatrix}\\right) \\left(\\sqrt{\\frac{h}{2}} I_n\\right)\n$$\n$$\nJ = \\frac{h}{2} K = \\frac{h}{2} \\frac{1}{h} \\begin{pmatrix}\n2  -1   \\\\\n-1  2  \\ddots  \\\\\n \\ddots  \\ddots  -1 \\\\\n  -1  2\n\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}\n2  -1   \\\\\n-1  2  \\ddots  \\\\\n \\ddots  \\ddots  -1 \\\\\n  -1  2\n\\end{pmatrix}.\n$$\n因此，$J$ 是标准三对角矩阵的一个缩放版本。令 $A$ 为一个 $n \\times n$ 矩阵，其对角元素为 $2$，次对角线和超对角线元素为 $-1$。那么 $J = \\frac{1}{2} A$。\n\n矩阵 $A$ 的特征值是众所周知的，由下式给出：\n$$\n\\mu_k(A) = 2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right) \\quad \\text{for } k=1, 2, \\dots, n.\n$$\n$J$ 的特征值 $\\lambda_k$ 就是 $A$ 的特征值的 $\\frac{1}{2}$ 倍：\n$$\n\\lambda_k(J) = \\frac{1}{2} \\mu_k(A) = \\frac{1}{2} \\left(2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right)\\right) = 1 - \\cos\\left(\\frac{k\\pi}{n+1}\\right).\n$$\n使用三角恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，我们可以将特征值重写为：\n$$\n\\lambda_k(J) = 2\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right) \\quad \\text{for } k=1, 2, \\dots, n.\n$$\n条件数 $\\kappa(J)$ 是最大特征值与最小特征值之比，即 $\\kappa(J) = \\frac{\\lambda_{\\max}(J)}{\\lambda_{\\min}(J)}$。\n函数 $\\sin^2(x)$ 在区间 $[0, \\frac{\\pi}{2}]$ 上是单调递增的。对于 $k \\in \\{1, \\dots, n\\}$，自变量 $\\frac{k\\pi}{2(n+1)}$ 在范围 $(0, \\frac{\\pi}{2})$ 内。\n最小特征值对应于 $k=1$：\n$$\n\\lambda_{\\min}(J) = \\lambda_1 = 2\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n最大特征值对应于 $k=n$：\n$$\n\\lambda_{\\max}(J) = \\lambda_n = 2\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right).\n$$\n我们可以使用恒等式 $\\sin(\\frac{\\pi}{2} - \\theta) = \\cos(\\theta)$ 来简化 $\\lambda_{\\max}(J)$ 的表达式：\n$$\n\\frac{n\\pi}{2(n+1)} = \\frac{(n+1-1)\\pi}{2(n+1)} = \\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}.\n$$\n因此，\n$$\n\\lambda_{\\max}(J) = 2\\sin^2\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = 2\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n现在我们计算条件数：\n$$\n\\kappa(J) = \\frac{\\lambda_{\\max}(J)}{\\lambda_{\\min}(J)} = \\frac{2\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{2\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\left(\\frac{\\cos\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin\\left(\\frac{\\pi}{2(n+1)}\\right)}\\right)^2.\n$$\n这可以简化为最终的表达式。\n$$\n\\kappa(J) = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n这就是雅可比预处理矩阵 $J$ 的条件数关于 $n$ 的精确闭式表达式。", "answer": "$$\\boxed{\\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)}$$", "id": "2596789"}, {"introduction": "除了迭代法，直接法（如 $LU$ 分解）在求解有限元方程组中也扮演着重要角色，尤其对于中小型问题。直接法的计算效率和内存消耗主要受“填充”（fill-in）现象的影响，即在分解过程中产生新的非零元。通过对矩阵的行和列进行重排序，可以显著减少填充，从而提升求解性能。本练习将让您亲手实践一种经典的带宽缩减算法——Cuthill-McKee（CM）算法。您将为一个给定的网格图执行该算法，通过这个过程直观地理解节点重排序如何优化稀疏矩阵的结构，为高效的直接求解奠定基础。[@problem_id:2596891]", "problem": "考虑一个对称正定全局刚度矩阵 $K$，该矩阵源于一个通过线性三角形有限元在规则的 $3 \\times 3$ 网格节点上离散化的标量扩散问题。$K$ 的非零模式与一个无向网格图的邻接关系相同，该图的顶点集为 $\\{1,2,3,4,5,6,7,8,9\\}$，其边编码了节点耦合（当且仅当对应的刚度矩阵项非零时，两个顶点之间存在一条边）。该网格是通过连接水平和垂直的网格邻居，并为每个方形单元从左下角到右上角添加一条对角线而获得的。得到的无向邻接关系由以下邻居列表给出（每行列出指定节点的邻居）：\n- 节点 $1$: $\\{2,4\\}$。\n- 节点 $2$: $\\{1,3,5,4\\}$。\n- 节点 $3$: $\\{2,6,5\\}$。\n- 节点 $4$: $\\{1,5,7,2\\}$。\n- 节点 $5$: $\\{2,4,6,8,3,7\\}$。\n- 节点 $6$: $\\{3,5,9,8\\}$。\n- 节点 $7$: $\\{4,8,5\\}$。\n- 节点 $8$: $\\{5,7,9,6\\}$。\n- 节点 $9$: $\\{6,8\\}$。\n\n你需要应用 Cuthill–McKee (CM) 算法来减小 $K$ 的包络。请使用以下基本定义和规则：\n- 顶点的度是其邻居的数量。\n- 广度优先搜索 (BFS) 层集是从一个选定的起始顶点 $s$ 开始构建的：层 $L_{0}=\\{s\\}$，$L_{k+1}$ 是 $L_{k}$ 中所有先前未访问过的邻居的集合。\n- 在 CM 算法中，当扩展一个顶点时，未访问的邻居按照其当前度的非递减顺序入队，若度相同，则按递增的顶点索引排序。访问顺序是顶点出队的顺序。\n- 起始顶点 $s$ 选择度最小的顶点之一；如果有多个，选择索引最小的那个。\n- 由排序 $r$ 导出的置换矩阵的带宽 $b$ 定义为 $b=\\max\\{\\,|p(i)-p(j)|:\\,K_{ij}\\neq 0\\,\\}$，其中 $p(i)$ 是顶点 $i$ 在排序 $r$ 中的位置（位置从 $1$ 开始计数）。\n\n任务：\n1. 根据上述规则，确定每个节点的度并识别起始顶点 $s$。\n2. 为该图构建 CM 算法从 $s$ 开始使用的 BFS 层集 $L_{0},L_{1},\\dots$。\n3. 使用 CM 的邻居排序规则，生成 CM 顶点排序 $r$（即顶点出队的序列）。\n4. 计算在由 $r$ 定义的置换下 $K$ 的带宽 $b$。\n\n将最终带宽 $b$ 表示为单个整数。无需四舍五入。无需单位。", "solution": "问题陈述已经过严格评估，被认为是有效的。它提出了一个计算图论中的良定问题，特别是应用 Cuthill–McKee 算法进行稀疏矩阵重排。所有必要的数据，包括图的邻接表和算法执行的具体规则，都已明确提供。该问题具有科学依据，是客观的，并且不包含内部矛盾。我们可以开始求解。\n\n解决方案需要系统地应用 Cuthill–McKee (CM) 算法，这涉及如前所述的四个主要任务。\n\n**任务1：确定节点度和起始顶点**\n\n首先，我们必须计算图中每个顶点的度，即邻接表中给出的每个节点的邻居数量。\n- 节点 $1$ 的度：$\\text{deg}(1) = |\\{2, 4\\}| = 2$\n- 节点 $2$ 的度：$\\text{deg}(2) = |\\{1, 3, 5, 4\\}| = 4$\n- 节点 $3$ 的度：$\\text{deg}(3) = |\\{2, 6, 5\\}| = 3$\n- 节点 $4$ 的度：$\\text{deg}(4) = |\\{1, 5, 7, 2\\}| = 4$\n- 节点 $5$ 的度：$\\text{deg}(5) = |\\{2, 4, 6, 8, 3, 7\\}| = 6$\n- 节点 $6$ 的度：$\\text{deg}(6) = |\\{3, 5, 9, 8\\}| = 4$\n- 节点 $7$ 的度：$\\text{deg}(7) = |\\{4, 8, 5\\}| = 3$\n- 节点 $8$ 的度：$\\text{deg}(8) = |\\{5, 7, 9, 6\\}| = 4$\n- 节点 $9$ 的度：$\\text{deg}(9) = |\\{6, 8\\}| = 2$\n\n所有顶点中的最小度为 $2$。具有此最小度的顶点是 $\\{1, 9\\}$。根据指定规则，我们通过选择索引最小的顶点来打破平局。因此，CM算法的起始顶点 $s$ 是 $s=1$。\n\n**任务2：构建广度优先搜索（BFS）层集**\n\n从 $s=1$ 开始，我们构建层集 $L_k$。$L_0$ 包含起始顶点。$L_{k+1}$ 包含 $L_k$ 中所有顶点的未访问过的邻居。\n- $L_0 = \\{1\\}$\n- 节点 $1$ 的邻居是 $\\{2, 4\\}$。两者都未被访问。因此，$L_1 = \\{2, 4\\}$。\n- 找出 $L_1$ 中节点的邻居。节点 $2$ 的邻居是 $\\{1, 3, 5, 4\\}$；未访问的有 $\\{3, 5\\}$。节点 $4$ 的邻居是 $\\{1, 5, 7, 2\\}$；未访问的有 $\\{5, 7\\}$。$L_1$ 的所有未访问邻居的集合是 $\\{3, 5\\} \\cup \\{5, 7\\} = \\{3, 5, 7\\}$。因此，$L_2 = \\{3, 5, 7\\}$。\n- 检查 $L_2$ 中节点的邻居。节点 $3$ 的邻居是 $\\{2, 6, 5\\}$；未访问的是 $\\{6\\}$。节点 $5$ 的邻居是 $\\{2, 4, 6, 8, 3, 7\\}$；未访问的是 $\\{6, 8\\}$。节点 $7$ 的邻居是 $\\{4, 8, 5\\}$；未访问的是 $\\{8\\}$。$L_2$ 的所有未访问邻居的集合是 $\\{6\\} \\cup \\{6, 8\\} \\cup \\{8\\} = \\{6, 8\\}$。因此，$L_3 = \\{6, 8\\}$。\n- 检查 $L_3$ 中节点的邻居。节点 $6$ 的邻居是 $\\{3, 5, 9, 8\\}$；未访问的是 $\\{9\\}$。节点 $8$ 的邻居是 $\\{5, 7, 9, 6\\}$；未访问的是 $\\{9\\}$。$L_3$ 的所有未访问邻居的集合是 $\\{9\\} \\cup \\{9\\} = \\{9\\}$。因此，$L_4 = \\{9\\}$。\n- $L_4$ 中的节点 $9$ 的邻居是 $\\{6, 8\\}$，两者都已被访问。过程终止。\n\nBFS 层集为：\n$L_0 = \\{1\\}$\n$L_1 = \\{2, 4\\}$\n$L_2 = \\{3, 5, 7\\}$\n$L_3 = \\{6, 8\\}$\n$L_4 = \\{9\\}$\n\n**任务3：生成 Cuthill–McKee 顶点排序**\n\n现在我们通过从 $s=1$ 开始执行 BFS 来生成排序 $r$。我们使用一个队列 $Q$ 和一个结果列表 $R$。当将被出队顶点的邻居添加到队列中时，它们按度的非递减顺序排序，若度相同则按顶点索引的递增顺序打破平局。\n\n1.  初始化：$R = \\emptyset$，$Q = \\emptyset$。将起始顶点 $s=1$ 添加到 $Q$。$Q = (1)$。\n2.  将 $1$ 出队。将 $1$ 添加到 $R$。$R = (1)$。节点 $1$ 的邻居是 $\\{2, 4\\}$。两者都未被访问。\n    它们的度是 $\\text{deg}(2) = 4$ 和 $\\text{deg}(4) = 4$。度存在平局。按顶点索引打破平局：$2  4$。排序后的顺序是 $(2, 4)$。将它们入队。$Q = (2, 4)$。\n3.  将 $2$ 出队。将 $2$ 添加到 $R$。$R = (1, 2)$。节点 $2$ 未访问的邻居是 $\\{3, 5\\}$。\n    它们的度是 $\\text{deg}(3) = 3$ 和 $\\text{deg}(5) = 6$。排序后的顺序是 $(3, 5)$。将它们入队。$Q = (4, 3, 5)$。\n4.  将 $4$ 出队。将 $4$ 添加到 $R$。$R = (1, 2, 4)$。节点 $4$ 唯一未访问的邻居是 $\\{7\\}$。\n    它的度是 $\\text{deg}(7) = 3$。将其入队。$Q = (3, 5, 7)$。\n5.  将 $3$ 出队。将 $3$ 添加到 $R$。$R = (1, 2, 4, 3)$。节点 $3$ 唯一未访问的邻居是 $\\{6\\}$。\n    它的度是 $\\text{deg}(6) = 4$。将其入队。$Q = (5, 7, 6)$。\n6.  将 $5$ 出队。将 $5$ 添加到 $R$。$R = (1, 2, 4, 3, 5)$。节点 $5$ 唯一未访问的邻居是 $\\{8\\}$。\n    它的度是 $\\text{deg}(8) = 4$。将其入队。$Q = (7, 6, 8)$。\n7.  将 $7$ 出队。将 $7$ 添加到 $R$。$R = (1, 2, 4, 3, 5, 7)$。节点 $7$ 没有未访问的邻居。$Q = (6, 8)$。\n8.  将 $6$ 出队。将 $6$ 添加到 $R$。$R = (1, 2, 4, 3, 5, 7, 6)$。节点 $6$ 唯一未访问的邻居是 $\\{9\\}$。\n    它的度是 $\\text{deg}(9) = 2$。将其入队。$Q = (8, 9)$。\n9.  将 $8$ 出队。将 $8$ 添加到 $R$。$R = (1, 2, 4, 3, 5, 7, 6, 8)$。节点 $8$ 没有未访问的邻居。$Q = (9)$。\n10. 将 $9$ 出队。将 $9$ 添加到 $R$。$R = (1, 2, 4, 3, 5, 7, 6, 8, 9)$。节点 $9$ 没有未访问的邻居。$Q = ()$。\n\n队列为空。最终的 CM 排序为 $r = (1, 2, 4, 3, 5, 7, 6, 8, 9)$。\n\n**任务4：计算置换矩阵的带宽**\n\n带宽 $b$ 由 $b = \\max\\{|p(i) - p(j)| : K_{ij} \\neq 0\\}$ 给出，其中 $p(i)$ 是顶点 $i$ 在排序 $r$ 中的新位置（从 $1$ 到 $9$）。\n排序 $r$ 给了我们置换映射 $p$：\n- $p(1)=1$\n- $p(2)=2$\n- $p(4)=3$\n- $p(3)=4$\n- $p(5)=5$\n- $p(7)=6$\n- $p(6)=7$\n- $p(8)=8$\n- $p(9)=9$\n\n我们现在计算图中每条边 $(i, j)$ 的置换位置的绝对差：\n- 边 $(1,2)$: $|p(1)-p(2)| = |1-2| = 1$\n- 边 $(1,4)$: $|p(1)-p(4)| = |1-3| = 2$\n- 边 $(2,3)$: $|p(2)-p(3)| = |2-4| = 2$\n- 边 $(2,4)$: $|p(2)-p(4)| = |2-3| = 1$\n- 边 $(2,5)$: $|p(2)-p(5)| = |2-5| = 3$\n- 边 $(3,5)$: $|p(3)-p(5)| = |4-5| = 1$\n- 边 $(3,6)$: $|p(3)-p(6)| = |4-7| = 3$\n- 边 $(4,5)$: $|p(4)-p(5)| = |3-5| = 2$\n- 边 $(4,7)$: $|p(4)-p(7)| = |3-6| = 3$\n- 边 $(5,6)$: $|p(5)-p(6)| = |5-7| = 2$\n- 边 $(5,7)$: $|p(5)-p(7)| = |5-6| = 1$\n- 边 $(5,8)$: $|p(5)-p(8)| = |5-8| = 3$\n- 边 $(6,8)$: $|p(6)-p(8)| = |7-8| = 1$\n- 边 $(6,9)$: $|p(6)-p(9)| = |7-9| = 2$\n- 边 $(7,8)$: $|p(7)-p(8)| = |6-8| = 2$\n- 边 $(8,9)$: $|p(8)-p(9)| = |8-9| = 1$\n\n所有位置差的集合是 $\\{1, 2, 3\\}$。这个集合中的最大值是 $3$。\n因此，根据 CM 排序置换后的矩阵的带宽 $b$ 是 $3$。", "answer": "$$\n\\boxed{3}\n$$", "id": "2596891"}]}