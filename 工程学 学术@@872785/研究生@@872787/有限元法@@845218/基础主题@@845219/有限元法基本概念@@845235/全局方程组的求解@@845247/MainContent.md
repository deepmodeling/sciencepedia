## 引言
[有限元分析](@entry_id:138109)将复杂的物理问题，如结构应力、热量传导或流体流动，转化为一个大型的代数方程组，通常表示为 $K u = f$。这个全局系统[方程组](@entry_id:193238)的求解，是整个[有限元分析](@entry_id:138109)流程中的计算核心，其效率直接决定了大规模工程与科学问题仿真的可行性。然而，从连续的[偏微分方程](@entry_id:141332)到离散的代数系统，再到最终求得数以百万计的未知数，这一过程涉及深刻的数学原理和复杂的计算策略。本文旨在弥合理论与实践之间的鸿沟，为读者系统性地梳理全局[方程组](@entry_id:193238)求解的完整知识体系。

在接下来的内容中，我们将分三步深入这一主题。首先，在“原理与机制”一章，我们将揭示全局系统是如何通过组装局部单元信息而形成的，剖析其关键的代数性质（如稀疏性、对称性），并详细介绍求解该系统的两大基本武器——直接法和迭代法，以及加速收敛的灵魂——预处理技术。随后，“应用与[交叉](@entry_id:147634)学科联系”一章将展示这些抽象的[数值算法](@entry_id:752770)如何在固体力学、[流体力学](@entry_id:136788)、波物理及[多物理场耦合](@entry_id:171389)等前沿领域中应对具体挑战，例如处理[材料非线性](@entry_id:162855)、[体积锁定](@entry_id:172606)和非对称[对流](@entry_id:141806)效应。最后，“动手实践”部分将提供一系列精心设计的问题，帮助您将理论知识转化为解决实际问题的能力。

现在，让我们从第一步开始，深入了解全局系统的构建原理、内在属性以及求解这些系统的核心数值方法。

## 原理与机制

在上一章中，我们探讨了如何通过变分原理和伽辽金方法，将一个连续的[偏微分方程](@entry_id:141332)（PDE）问题转化为一个离散的[代数方程](@entry_id:272665)组。这一过程的最终产物是所谓的**全局[线性系统](@entry_id:147850)**，形式为 $K u = f$。本章将深入探讨该系统的构建原理、内在属性以及求解该系统的核心数值方法。我们的目标是建立一个从理论到实践的坚实桥梁，理解从局部单元贡献到全局系统解的完整流程。

### 全局系统的形成：从局部到全局

[有限元法](@entry_id:749389)的核心思想是“[分而治之](@entry_id:273215)”。我们将复杂的求解域 $\Omega$ 剖分为简单的、非重叠的单元（如三角形或四边形）集合 $\mathcal{T}_h$。在每个单元 $e$ 上，我们计算一个**局部刚度矩阵** $K^{(e)}$ 和一个**局部[载荷向量](@entry_id:635284)** $f^{(e)}$。全局系统 $K u = f$ 并非凭空产生，而是通过一个称为**组装**（Assembly）的系统过程，将所有单元的贡献累加而成。

这个过程的本质是，[全局刚度矩阵](@entry_id:138630)的第 $(i, j)$ 个元素 $K_{ij}$ 代表了第 $j$ 个自由度（对应[基函数](@entry_id:170178) $\varphi_j$）对第 $i$ 个自由度（对应测试函数 $\varphi_i$）的影响。根据[伽辽金法](@entry_id:749698)的推导，这种影响是定义在整个域 $\Omega$ 上的[双线性形式](@entry_id:746794) $a(\varphi_j, \varphi_i)$。由于[积分的可加性](@entry_id:139690)，这个全局积分可以分解为在所有单元上的积分之和：

$K_{ij} = a(\varphi_j, \varphi_i) = \int_{\Omega} \mathcal{L}(\varphi_j) \cdot \mathcal{L}(\varphi_i) \,dx = \sum_{e \in \mathcal{T}_h} \int_{e} \mathcal{L}(\varphi_j)|_e \cdot \mathcal{L}(\varphi_i)|_e \,dx = \sum_{e \in \mathcal{T}_h} a_e(\varphi_j, \varphi_i)$

其中 $\mathcal{L}$ 是一个[微分算子](@entry_id:140145)。上式表明，[全局刚度矩阵](@entry_id:138630)的每个元素都是所有单元贡献的总和。由于[有限元基函数](@entry_id:749279)具有**局部支集**（即 $\varphi_i$ 仅在包含节点 $i$ 的单元上非零），$a_e(\varphi_j, \varphi_i)$ 仅当节点 $i$ 和节点 $j$ 都属于单元 $e$ 时才可能非零。

在计算实践中，我们通过一个**“分散-相加”（scatter-add）**的算法来实现组装。首先，为域中的所有节点（自由度）建立一个从 $1$ 到 $N$ 的**全局编号**。对于每个单元 $e$，我们维护一个**单元连通性数组** $I^{(e)}$，它将单元的局部节点编号（例如，从 $1$ 到 $n_e$）映射到它们的全局节点编号。组装过程如下：
1. 初始化一个 $N \times N$ 的零矩阵 $K$。
2. 对网格中的每个单元 $e$ 进行循环：
    a. 计算 $n_e \times n_e$ 的局部[刚度矩阵](@entry_id:178659) $K^{(e)}$。
    b. 对于 $K^{(e)}$ 中的每一个元素 $K^{(e)}_{ab}$，将其值加到全局矩阵 $K$ 的 $(I^{(e)}_a, I^{(e)}_b)$ 位置上。即：$K_{I^{(e)}_a, I^{(e)}_b} \mathrel{+}= K^{(e)}_{ab}$。

这个过程可以用更严谨的矩阵语言来描述。我们可以为每个单元 $e$ 定义一个**延拓矩阵**（prolongation matrix）或选择矩阵 $P^{(e)} \in \mathbb{R}^{N \times n_e}$。该矩阵的第 $(i, a)$ 个元素定义为：如果全局自由度 $i$ 对应于单元 $e$ 的第 $a$ 个局部自由度（即 $i=I^{(e)}_a$），则为 $1$，否则为 $0$。利用这个矩阵，$K^{(e)}$ 可以被“延拓”到一个 $N \times N$ 的矩阵 $P^{(e)} K^{(e)} (P^{(e)})^{\top}$，该矩阵在与单元 $e$ 相关的自由度上具有非零值，而在其他地方为零。[全局刚度矩阵](@entry_id:138630) $K$ 就是所有这些延拓后的单元矩阵之和 [@problem_id:2596847]：

$K = \sum_{e \in \mathcal{T}_h} P^{(e)} K^{(e)} (P^{(e)})^{\top}$

这个公式优雅地概括了组装操作的本质：将局部信息映射到[全局坐标系](@entry_id:171029)中并进行叠加。全局[载荷向量](@entry_id:635284) $f$ 的组装过程与此完全类似。

### [全局刚度矩阵](@entry_id:138630)的性质

通过组装得到的[全局刚度矩阵](@entry_id:138630) $K$ 并非任意矩阵，它继承了其所源自的物理问题和数学公式的深刻性质。理解这些性质对于选择合适的求解器至关重要。

#### [稀疏性](@entry_id:136793)

由于[有限元基函数](@entry_id:749279) $\varphi_i$ 的支集是局部的，[全局刚度矩阵](@entry_id:138630) $K$ 的元素 $K_{ij} = a(\varphi_j, \varphi_i)$ 只有在[基函数](@entry_id:170178) $\varphi_i$ 和 $\varphi_j$ 的支集有重叠时才非零。在标准的有限元实现中，这意味着节点 $i$ 和 $j$ 必须同属于至少一个单元。因此，对于一个拥有 $N$ 个节点的网格，每个节点只与少数几个邻近节点相连，这导致 $K$ 矩阵中绝大多数元素为零。这种**[稀疏性](@entry_id:136793)**是有限元矩阵的一个标志性特征，也是高效求解大规模问题的关键。矩阵的非零元素模式可以被一个[无向图](@entry_id:270905) $G(K)$ 所描述，其中图的顶点是节点编号 $\{1, \dots, N\}$，当且仅当 $K_{ij} \neq 0$ 时，顶点 $i$ 和 $j$ 之间存在一条边 [@problem_id:2596825]。

#### 对称性

如果用于推导离散系统的[双线性形式](@entry_id:746794) $a(u,v)$ 是对称的，即 $a(u,v) = a(v,u)$，那么[全局刚度矩阵](@entry_id:138630) $K$ 也是对称的，即 $K_{ij} = a(\varphi_j, \varphi_i) = a(\varphi_i, \varphi_j) = K_{ji}$。对于许多物理问题，如[扩散](@entry_id:141445)问题和线性[弹性静力学](@entry_id:198298)问题，其对应的双线性形式天然具有对称性。因此，在这些情况下，$K$ 是一个[对称矩阵](@entry_id:143130)。

#### 正定性

矩阵的**正定性**是另一个关键属性。一个对称矩阵 $K$ 被称为**[对称正定](@entry_id:145886)（Symmetric Positive Definite, SPD）**的，如果对于任何非[零向量](@entry_id:156189) $x$，都有 $x^{\top} K x > 0$。

让我们以一个典型的标量[扩散](@entry_id:141445)问题 $-\nabla \cdot (\kappa \nabla u) = f$ 为例来说明。其对应的[双线性形式](@entry_id:746794)为 $a(u,v) = \int_{\Omega} \kappa \nabla u \cdot \nabla v \, dx$。对于任意非零的离散函数 $u_h = \sum_j u_j \varphi_j$，其系数向量为 $\mathbf{u}$。与矩阵 $K$ 相关的二次型为：

$\mathbf{u}^{\top} K \mathbf{u} = a(u_h, u_h) = \int_{\Omega} \kappa |\nabla u_h|^2 \, dx$

要使该积分为正，需要满足两个条件 [@problem_id:2596837]：
1.  **物理稳定性**：材料系数 $\kappa(x)$ 必须在整个域上是一致为正的，即存在一个常数 $\kappa_{\min} > 0$ 使得 $\kappa(x) \ge \kappa_{\min}$ 几乎处处成立。如果 $\kappa$ 在某个区域为零，二次型的值也可能为零。
2.  **约束充分性**：[函数空间](@entry_id:143478)必须排除那些使积分为零的非零函数。对于上述积分，只有当 $\nabla u_h = 0$（即 $u_h$ 是常数）时，积分才为零。如果我们施加了**齐次狄利克雷边界条件**（例如，$u=0$ on $\partial \Omega$），那么唯一梯度为零的函数就是零函数。通过**[庞加莱不等式](@entry_id:142086)**（Poincaré inequality），我们可以保证 $|u_h|_{H^1(\Omega)}^2 = \int_{\Omega} |\nabla u_h|^2 \, dx > 0$ 对于任何非零的 $u_h$ 成立。

因此，对于一个具有一致正[扩散](@entry_id:141445)系数和充分狄利克雷边界条件的[椭圆问题](@entry_id:146817)，其刚度矩阵 $K$ 是对称正定的。如果边界条件不足以排除零能量模式（例如，纯诺伊曼边界问题，其解允许任意常数），则矩阵将是**半正定**的，其零空间对应于这些常数模式。

这一概念可以推广到更复杂的矢量问题，如**[线性弹性力学](@entry_id:166983)** [@problem_id:2596921]。在这种情况下，$K$ 具有块结构，并且其零空间对应于**刚体位移**（平移和旋转）。为了得到一个[对称正定系统](@entry_id:172662)，必须施加足够的位移约束来消除所有这些刚体运动模式。

### 边界条件的处理

在组装完“原始”的全局系统后，必须施加边界条件。对于齐次[狄利克雷边界条件](@entry_id:173524) $u_i = 0$（其中 $i$ 属于约束自由度集 $C$），有几种经典的处理方法，它们会对最终线性系统的代数性质产生显著影响 [@problem_id:2596880]。

1.  **消元法（Elimination）**：这是理论上最直接和“纯净”的方法。它将[系统矩阵](@entry_id:172230) $K$ 和向量 $f$ 按照自由度集 $F$ 和约束自由度集 $C$ 进行分块，然后直接求解与自由度相关的子系统 $K_{FF} u_F = f_F - K_{FC} u_C$。在齐次条件下，$u_C = 0$，系统简化为 $K_{FF} u_F = f_F$。由于 $K_{FF}$ 是 SPD 矩阵 $K$ 的一个[主子矩阵](@entry_id:201119)，它本身也是 SPD 的。此方法得到的系统阶数更低，性质优良，但实现起来较为复杂，因为它会改变矩阵的原始结构。

2.  **罚函数法（Penalty Method）**：该方法通过向原始系统添加一个“惩罚项”来近似施加约束。修改后的系统为 $(K + \alpha P) u = f$，其中 $P$ 是一个在约束自由度上为 $1$、其他地方为 $0$ 的对角矩阵（投影算子），$\alpha$ 是一个很大的正数（罚参数）。这种方法的优点是实现简单，不改变矩阵的尺寸和稀疏模式。修改后的矩阵 $K+\alpha P$ 仍然是 SPD 的。然而，它的一个巨大缺点是会严重恶化系统的**条件数**，$\kappa(K+\alpha P)$ 会随着 $\alpha$ 的增大而增长，给迭代求解器带来困难。

3.  **[拉格朗日乘子法](@entry_id:176596)（Lagrange Multipliers）**：此方法引入一个新的未知量——拉格朗日乘子 $\lambda$，将约束 $Cu=d$ 整合到一个更大的增广系统中：
    $$
    \begin{bmatrix} K  C^{\top} \\ C  0 \end{bmatrix} \begin{bmatrix} u \\ \lambda \end{bmatrix} = \begin{bmatrix} f \\ d \end{bmatrix}
    $$
    这个[增广矩阵](@entry_id:150523)是**对称**的，但由于其右下角的 $0$ 块，它不再是正定的，而是**不定**的。这种系统被称为**[鞍点系统](@entry_id:754480)**。虽然它精确地施加了约束，但其不定的性质意味着不能使用为 SPD [系统设计](@entry_id:755777)的求解器（如标准[共轭梯度法](@entry_id:143436)），而必须采用如 [MINRES](@entry_id:752003) 或 GMRES 等更通用的 [Krylov 子空间方法](@entry_id:144111)。

### 求解全局系统：直接法

一旦全局系统形成，我们面临的核心任务就是求解它。求解方法主要分为两大类：直接法和迭代法。

直接法通过一系列可预测的、有限步的算术运算来求得精确解（在不考虑[舍入误差](@entry_id:162651)的情况下）。对于来自有限元的[稀疏线性系统](@entry_id:174902)，最常用的直接法是基于**高斯消元**的变体。

#### [对称正定系统](@entry_id:172662)：稀疏 Cholesky 分解

当[系统矩阵](@entry_id:172230) $K$ 是 SPD 时（例如，通过消元法处理边界条件后），**Cholesky 分解**是首选方法。它将 $K$ 分解为 $K = L L^{\top}$，其中 $L$ 是一个下三角矩阵。求解过程变为两个简单的三角系统求解：首先求解 $L y = f$ 得到 $y$，然后求解 $L^{\top} u = y$ 得到最终解 $u$。

对于稀疏矩阵，一个严峻的挑战是**填充（fill-in）**：即使 $K$ 是稀疏的，其 Cholesky 因子 $L$ 也可能包含大量非零元，这些非零元位于 $K$ 中原本为零的位置。填充的数量和位置严重依赖于消元过程中变量的顺序。一个糟糕的顺序可能导致 $L$ 几乎是满的，从而使得分解的计算成本和内存需求高得无法接受。

为了最小化填充，需要找到一个优化的**消元排序（ordering）**。这个问题在图论中有深刻的对应：寻找一个最小填充排序等价于为矩阵的图 $G(K)$ 寻找一个**最小弦化（minimum chordal completion）** [@problem_id:2596825]。这是一个 N[P-难](@entry_id:265298)问题，因此在实践中我们使用启发式算法来寻找“足够好”的排序。主要有两类排序策略 [@problem_id:2596815]：

*   **近似[最小度](@entry_id:273557)（Approximate Minimum Degree, AMD）**：这是一种**局部贪心**策略。在消元的每一步，它选择当前图中度数（邻居数）最小的节点进行消元，以期在局部产生最少的填充。AMD 及其变种算法计算速度快，对于中小型问题或结构不规则的网格通常表现优异。
*   **[嵌套剖分](@entry_id:265897)（Nested Dissection, ND）**：这是一种**全局分治**策略。它通过寻找图的**分隔子（separator）**（一个移除后能将图分成两个不相连部分的较小顶点集），递归地对图进行剖分。该算法首先对两个[子图](@entry_id:273342)内的节点进行编号，最后对分隔子内的节点编号。对于源自二维和三维规则网格的图，ND 算法被证明是**渐近最优**的。例如，对于一个有 $N$ 个自由度的二维问题，ND 排序可以实现填充量为 $\mathcal{O}(N \log N)$，计算量为 $\mathcal{O}(N^{3/2})$。相比之下，一些简单的排序（如按坐标排序）或在最坏情况下的 AMD 排序，其计算量可能高达 $\mathcal{O}(N^2)$。因此，对于非常大规模的问题，ND 的渐近优势使其成为首选，尽管其排序本身的计算成本高于 AMD。

#### 一般系统：稀疏 LU 分解

当矩阵非对称或不定时（例如，在求解[对流](@entry_id:141806)占优问题或使用拉格朗日乘子时），必须使用更通用的 **LU 分解**。与 Cholesky 分解不同，LU 分解需要**主元选择（pivoting）**来保证[数值稳定性](@entry_id:146550)。例如，考虑以下矩阵 [@problem_id:2596913]：
$$
A(\epsilon) = \begin{bmatrix} \epsilon  1  0  0\\ 1  0  1  0\\ 0  1  0  1\\ 0  0  1  0 \end{bmatrix}
$$
当 $\epsilon$ 是一个很小的正数时，如果不进行主元选择，第一步消元将使用 $\epsilon$ 作为主元，产生一个巨大的乘子 $1/\epsilon$，这会极大地放大[舍入误差](@entry_id:162651)。**[部分主元法](@entry_id:138396)（Partial Pivoting）**通过在每一步交换行，确保使用当前列中[绝对值](@entry_id:147688)最大的元素作为主元，从而将乘子的[绝对值](@entry_id:147688)限制在 $1$ 以内，保证了稳定性。

在[稀疏矩阵](@entry_id:138197)的背景下，主元选择与填充最小化之间存在着深刻的矛盾。一个预先计算好的、旨在最小化填充的静态排序，可能会被分解过程中为了保证[数值稳定性](@entry_id:146550)而进行的动态行交换所打乱。这种动态交换会引入额外的、不可预测的填充。为了平衡这一矛盾，现代[稀疏直接求解器](@entry_id:755097)通常采用**[阈值主元法](@entry_id:755960)（Threshold Pivoting）**。该策略允许选择一个不一定是列主元但“足够大”的元素作为主元（例如，其[绝对值](@entry_id:147688)不小于列主元[绝对值](@entry_id:147688)的 $\tau$ 倍，其中 $\tau \in (0, 1]$ 是一个阈值参数），从而在保证一定数值稳定性的前提下，为选择稀疏性更好的主元提供了灵活性。

### 求解全局系统：[迭代法](@entry_id:194857)

对于三维问题或需要极高网格分辨率的问题，直接法的内存和计算成本（即使有优化的排序）可能会变得令人望而却步。在这种情况下，**[迭代法](@entry_id:194857)**成为更具吸[引力](@entry_id:175476)的选择。迭代法从一个初始猜测解 $u_0$ 开始，通过一系列迭代步骤 $u_{k+1} = \mathcal{F}(u_k, K, f)$ 来逐步逼近真实解。

#### 共轭梯度法与[预处理](@entry_id:141204)

对于 SPD 系统，**[共轭梯度法](@entry_id:143436)（Conjugate Gradient, CG）**是当之无愧的主力算法。它的收敛速度主要取决于矩阵的**[条件数](@entry_id:145150)** $\kappa(K) = \lambda_{\max}(K)/\lambda_{\min}(K)$，其中 $\lambda_{\max}$ 和 $\lambda_{\min}$ 分别是 $K$ 的最大和最小特征值。对于由二阶椭圆 PDE 离散化得到的矩阵 $K$，其[条件数](@entry_id:145150)通常会随着网格尺寸 $h$ 的减小而恶化（例如，$\kappa(K) = \mathcal{O}(h^{-2})$）。这意味着网格越密，CG 收敛所需的迭代次数就越多，这使得“朴素”的 CG 法效率不高。

解决这一问题的关键是**[预处理](@entry_id:141204)（Preconditioning）**。其思想不是直接求解 $Ku=f$，而是求解一个与之等价但“更好”的系统，例如[左预处理](@entry_id:165660)系统 $M^{-1} K u = M^{-1} f$，其中 $M$ 是一个 SPD 矩阵，称为**[预条件子](@entry_id:753679)**。一个好的预条件子 $M$ 应满足两个条件：(1) $M$ 在某种意义上“近似”于 $K$；(2) 求解形如 $Mz=r$ 的线性系统应该非常高效。预处理的目标是使预处理后的矩阵 $M^{-1}K$ 的条件数 $\kappa(M^{-1}K)$ 远小于 $\kappa(K)$，并且理想情况下与网格尺寸 $h$ 无关。

[预条件子](@entry_id:753679)的有效性可以通过**谱等价**来量化 [@problem_id:2596881]。如果存在与 $h$ 无关的正常数 $c_1$ 和 $c_2$，使得对于所有非[零向量](@entry_id:156189) $x$，都满足：
$c_1 x^{\top} K x \le x^{\top} M x \le c_2 x^{\top} K x$
那么我们称 $M$ 和 $K$ 是谱等价的。这个条件保证了[预处理](@entry_id:141204)后系统的所有[特征值](@entry_id:154894)都位于区间 $[1/c_2, 1/c_1]$ 内，因此其[条件数](@entry_id:145150) $\kappa(M^{-1}K) \le c_2/c_1$ 是一个与网格尺寸 $h$ 无关的常数。这样的预条件子被称为是**最优的**或**网格无关的**，因为它能保证达到给定精度所需的 CG 迭代次[数基](@entry_id:634389)本不随网格加密而增加。

#### 超越[条件数](@entry_id:145150)：[特征值分布](@entry_id:194746)的作用

经典的 CG [收敛理论](@entry_id:176137)给出的[上界](@entry_id:274738)主要依赖于条件数。然而，这个上界往往是悲观的。实际的收敛行为更精细地依赖于整个**[特征值分布](@entry_id:194746)** [@problem_id:2596805]。一个特别重要且常见的情况是，预处理后矩阵的[特征值](@entry_id:154894)大部分聚集在一个或几个很小的区间内，只有少数几个**离群（outlier）**[特征值分布](@entry_id:194746)在远处。

在这种情况下，CG 方法会展现出所谓的**[超线性收敛](@entry_id:141654)**行为。在最初的少数几次迭代中，收敛可能较慢，因为算法需要“处理”这些离群[特征值](@entry_id:154894)。一旦这些离群值的影响被“滤除”（在算法内部，这对应于构造出一个在这些离群值位置近似为零的多项式），后续的收敛速度将由那些紧密聚集的[特征值](@entry_id:154894)所决定的有效条件数来主导，这个有效[条件数](@entry_id:145150)远小于全局[条件数](@entry_id:145150)。因此，拥有聚集的[特征值](@entry_id:154894)谱（即使全局[条件数](@entry_id:145150)很大）通常比[特征值](@entry_id:154894)[均匀分布](@entry_id:194597)在很大区间内（即使[条件数](@entry_id:145150)相同）的收敛情况要好得多。

#### 高级[预处理](@entry_id:141204)技术一瞥：[代数多重网格](@entry_id:140593)

像不完全 Cholesky 分解（IC）这样的简单预条件子通常无法做到网格无关。最优的预条件子通常基于更深刻的物理或数学思想，其中**[多重网格](@entry_id:172017)（Multigrid, MG）**方法是最强大的技术之一。**[代数多重网格](@entry_id:140593)（Algebraic Multigrid, AMG）**是其一个重要变种，它试图仅从矩阵 $K$ 本身的代数信息出发，自动构建[多重网格](@entry_id:172017)所需的层次结构（粗网格和层间传递算子）。

AMG 的一个核心概念是**连接强度（strength of connection）** [@problem_id:2596903]。对于一个变量 $i$，它与其他变量 $j$ 的连接强度由[矩阵元](@entry_id:186505)素 $|A_{ij}|$ 的大小来衡量。在一个典型的 AMG 算法中，如果 $-A_{ij} \ge \theta \max_{k \neq i}(-A_{ik})$，则称 $j$ 与 $i$ 是**强连接**的，其中 $\theta \in (0,1]$ 是一个可调的强度阈值。这个概念对于处理各向异性问题至关重要。例如，在一个[扩散](@entry_id:141445)系数为 $\mathrm{diag}(1, \epsilon)$（其中 $\epsilon \ll 1$）的各向异性问题中，变量在 $x$ 方向的耦合远强于 $y$ 方向。通过选择一个合适的阈值（例如 $\theta > \epsilon$），AMG 算法可以正确地识别出只有 $x$ 方向的连接是强的。基于此，它会执行**[半粗化](@entry_id:754677)（semi-coarsening）**，即只在强连接方向上构建粗网格。这种与问题物理特性相匹配的策略，尽管可能导致更高的算子复杂度，但其收敛效率远高于未能识别各向异性的标准粗化策略。

#### [不定系统](@entry_id:750604)的求解

最后，回到由拉格朗日乘子法等产生的对称不定[鞍点系统](@entry_id:754480)。如前所述，CG 不再适用。必须使用如 **[MINRES](@entry_id:752003)** 或 **GMRES** 这样的 Krylov 方法。这些系统的[预处理](@entry_id:141204)也更具挑战性。一个有效的方法是设计**[分块预条件子](@entry_id:163449)**，它分别近似[鞍点](@entry_id:142576)矩阵的对角块。例如，一个理想的分[块对角预条件子](@entry_id:746868)会近似 $K$ 块和**舒尔补（Schur complement）**块 $S = C K^{-1} C^{\top}$ [@problem_id:2596886]。

[舒尔补](@entry_id:142780) $S$ 的性质至关重要。要使整个[鞍点系统](@entry_id:754480)良态，必须满足一个称为 **LBB（Ladyzhenskaya-Babuška-Brezzi）**或 **inf-sup** 的稳定性条件。这个条件在代数上保证了舒尔补 $S$ 是一致可逆的（即其[最小特征值](@entry_id:177333)有远离零的下界）。如果 LBB 条件不满足或“弱”满足， $S$ 将是奇[异或](@entry_id:172120)严重病态的，导致整个增广系统也严重病态。在这种情况下，即使对 $K$ 块使用很好的预处理，[迭代求解器](@entry_id:136910)也可能停滞不前。因此，在设计有限元方法和求解策略时，确保 LBB 稳定性是处理约束问题和[混合问题](@entry_id:634383)的核心。