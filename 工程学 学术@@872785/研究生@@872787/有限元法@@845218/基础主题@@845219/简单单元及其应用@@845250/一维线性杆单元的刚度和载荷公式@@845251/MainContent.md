## 引言
[一维杆单元](@entry_id:171268)是有限元方法（FEM）学习路径中的基石，也是理解复杂[结构分析](@entry_id:153861)的起点。尽管其形式简单，但其背后蕴含的数学原理和建模思想贯穿于整个[计算力学](@entry_id:174464)领域。然而，许多工程师和学生在应用有限元软件时，常常对“刚度矩阵”和“荷载向量”这些核心概念的来源感到困惑，缺乏从连续介质力学的基本物理定律到最终离散代数方程组的清晰认识。本文旨在填补这一知识鸿沟，系统性地揭示[一维杆单元](@entry_id:171268)公式的完整推导过程及其广泛应用。

在接下来的内容中，我们将通过三个层次递进的章节来构建完整的知识体系。首先，在“原理与机制”一章中，我们将从控制[微分方程](@entry_id:264184)的强形式出发，深入探讨弱形式的转换、形函数的构建以及单元矩阵的推导，为读者奠定坚实的理论基础。接着，在“应用与交叉学科联系”一章中，我们将展示这一基本单元如何被扩展和应用于处理桁架、热力、动力学及[非线性](@entry_id:637147)等更复杂的前沿问题。最后，“动手实践”部分将提供具体的计算案例，帮助读者将理论知识转化为实践能力。

让我们首先进入“原理与机制”的探讨，从最基本的物理平衡方程开始，一步步构建起[有限元法](@entry_id:749389)的宏伟大厦。

## 原理与机制

本章旨在系统地阐述一维线性杆单元刚度和荷载公式的推导过程，从[连续介质力学](@entry_id:155125)的基本方程出发，逐步过渡到有限元法的离散代数体系。我们将深入探讨控制方程的强形式与弱形式、形函数的构造、单元矩阵的推导、全局系统的组装以及边界条件的处理等核心概念。本章的目标是为读者构建一个坚实而完整的理论框架，使其不仅能够应用这些公式，更能深刻理解其背后的物理原理和数学机制。

### 从强形式到弱形式：[有限元法](@entry_id:749389)的基础

在[连续介质力学](@entry_id:155125)中，一个物理问题的数学模型通常由一个或一组[偏微分方程](@entry_id:141332)以及相应的边界条件构成。这个[微分方程](@entry_id:264184)描述了在问题域内每一点都必须满足的物理定律（如[平衡方程](@entry_id:172166)），我们称之为问题的**强形式 (strong form)**。

考虑一根沿 $x$ 轴放置的直杆，其占据区间 $[0, L]$。我们假设杆的[杨氏模量](@entry_id:140430) $E(x)$ 和[横截面](@entry_id:154995)积 $A(x)$ 可能随空间位置 $x$ 变化。杆件受到一个沿轴向[分布](@entry_id:182848)的[体力](@entry_id:174230) $b(x)$（单位体积的力）。在小应变假设下，轴向[位移场](@entry_id:141476)为 $u(x)$，[轴向应变](@entry_id:160811)为 $\varepsilon(x) = u'(x)$，轴向应力为 $\sigma(x) = E(x)\varepsilon(x)$，轴向[内力](@entry_id:167605)（或称轴力）为 $N(x) = \sigma(x)A(x)$。

为了推导控制杆件行为的[微分方程](@entry_id:264184)，我们考察一个从 $x$ 到 $x+dx$ 的微元段。根据牛顿定律，在准静态（忽略[惯性力](@entry_id:169104)）条件下，作用在该微元上的所有力的合力必须为零。这些力包括：
1.  在[截面](@entry_id:154995) $x$ 处的内力：$-N(x)$
2.  在[截面](@entry_id:154995) $x+dx$ 处的[内力](@entry_id:167605)：$N(x+dx)$
3.  作用在微元体积上的[体力](@entry_id:174230)：$b(x) \cdot (A(x) dx)$

力的[平衡方程](@entry_id:172166)为：
$N(x+dx) - N(x) + A(x)b(x)dx = 0$

将上式两边同除以 $dx$ 并取极限 $dx \to 0$，我们得到[平衡方程](@entry_id:172166)的[微分形式](@entry_id:146747)：
$\dfrac{dN}{dx} + A(x)b(x) = 0$

将[内力](@entry_id:167605) $N(x)$ 用位移 $u(x)$ 表示，即 $N(x) = E(x)A(x)u'(x)$，代入[平衡方程](@entry_id:172166)，我们便得到了描述一维杆件问题的[二阶常微分方程](@entry_id:204212)：
$-\dfrac{d}{dx}\big(E(x)A(x)u'(x)\big) = A(x)b(x)$

这个方程就是该问题的**强形式**。要完全确定一个问题，我们还必须在定义域的边界，即 $x=0$ 和 $x=L$ 处，施加边界条件。边界条件分为两类 [@problem_id:2538065]：

*   **[本质边界条件](@entry_id:173524) (Essential Boundary Conditions)**，也称为**狄利克雷 (Dirichlet) 条件**。这类条件直接对基本未知量（在此问题中为位移 $u(x)$）进行约束，例如，指定杆端位移 $u(0) = \bar{u}_0$ 或 $u(L) = \bar{u}_L$。
*   **自然边界条件 (Natural Boundary Conditions)**，也称为**诺伊曼 (Neumann) 条件**。这类条件涉及到基本未知量的导数，在本问题中表现为对杆端内力（或牵[引力](@entry_id:175476)）的约束。例如，在杆端 $x=L$ 处施加一个已知的拉力 $\bar{N}_L$。力的平衡要求内部轴力等于外部施加的力。根据惯例，我们定义边界上的外法向向量为 $n(0)=-1$ 和 $n(L)=+1$。则在 $x=L$ 处的自然边界条件可以写作 $N(L)n(L) = E(L)A(L)u'(L) \cdot (+1) = \bar{N}_L$。

强形式要求解 $u(x)$ 具有足够的连续性和可微性（在本例中为二阶可微），以便[微分方程](@entry_id:264184)在域内每一点都有意义。然而，对于许多工程问题，尤其当材料属性 $E(x)$ 或几何尺寸 $A(x)$ 出现突变时，寻找满足强形式的光滑解十分困难甚至不可能。

[有限元法](@entry_id:749389)的出发点，正是将强形式转化为等价的**[弱形式](@entry_id:142897) (weak form)**。弱形式放宽了对解的[光滑性](@entry_id:634843)要求，是后续离散化的基础。转化的标准流程是**[加权余量法](@entry_id:165159)**，其中最常用的是**[伽辽金法](@entry_id:749698) (Galerkin method)**。其核心思想是：如果一个函数是强形式的解，那么它乘以任意一个满足特定条件的**权函数 (weight function)** 或 **检验函数 (test function)** $v(x)$ 并在整个定义域上积分后，结果必然为零。

我们将强形式方程乘以一个[检验函数](@entry_id:166589) $v(x)$，并在定义域 $[0, L]$ 上积分：
$\int_{0}^{L} v(x) \left[ -\dfrac{d}{dx}\big(E(x)A(x)u'(x)\big) - A(x)b(x) \right] dx = 0$

整理后得到：
$\int_{0}^{L} v(x) \dfrac{d}{dx}\big(E(x)A(x)u'(x)\big) dx + \int_{0}^{L} v(x) A(x)b(x) dx = 0$

这里的关键步骤是对第一项进行**[分部积分](@entry_id:136350) (integration by parts)**。这么做的目的有两个：一是将位移 $u(x)$ 的最[高阶导数](@entry_id:140882)从二阶降为一阶，从而降低对解的光滑性要求；二是在此过程中自然地引出边界项，为施加自然边界条件提供途径 [@problem_id:2538113]。

对第一项应用[分部积分公式](@entry_id:145262) $\int u \, dv = uv - \int v \, du$，令 $u_{ip} = v(x)$ 和 $dv_{ip} = \frac{d}{dx}(EA u') dx$，则：
$\int_{0}^{L} v(x) \dfrac{d}{dx}\big(EAu'\big) dx = \left[ v(x) EAu' \right]_{0}^{L} - \int_{0}^{L} v'(x) EAu' dx$

代回原积分方程，我们得到：
$\int_{0}^{L} v'(x) E(x)A(x)u'(x) dx = \int_{0}^{L} v(x) A(x)b(x) dx + \left[ v(x) EAu' \right]_{0}^{L}$

这个积分方程就是原问题的弱形式，也称为**[变分形式](@entry_id:166033) (variational form)**。它通常被解释为**[虚功原理](@entry_id:138749) (Principle of Virtual Work)**：左侧代表系统在[虚位移](@entry_id:168781)场 $v(x)$ 下的**内力[虚功](@entry_id:176403)**，右侧代表相应的外力[虚功](@entry_id:176403)。方程的含义是，对于一个处于平衡状态的系统，[内力](@entry_id:167605)[虚功](@entry_id:176403)等于外力[虚功](@entry_id:176403)。

边界项 $\left[ v(x) EAu' \right]_{0}^{L} = v(L)N(L) - v(0)N(0)$ 的处理方式完美地揭示了两种边界条件的本质区别：

*   如果某边界（例如 $x=0$）施加的是**[本质边界条件](@entry_id:173524)** $u(0) = \bar{u}_0$，那么为了保证[解的唯一性](@entry_id:143619)，我们要求所有容许的检验函数在该点必须为零，即 $v(0)=0$。这样，边界项 $v(0)N(0)$ 自动消失。[本质边界条件](@entry_id:173524)是通过对[解空间](@entry_id:200470)和检验函数空间施加约束来**强行满足**的。
*   如果某边界（例如 $x=L$）施加的是**自然边界条件** $N(L) = \bar{N}_L$，那么位移 $u(L)$ 是未知的，[检验函数](@entry_id:166589) $v(L)$ 也是任意的。此时，我们将已知的力 $\bar{N}_L$ 代入边界项，得到 $v(L)\bar{N}_L$。这一项作为外力[虚功](@entry_id:176403)的一部分，被包含在[弱形式](@entry_id:142897)方程中。因此，自然边界条件是通过[变分方程](@entry_id:635018)本身**自然满足**的。

至此，我们完成了从强形式到弱形式的转换。[弱形式](@entry_id:142897)要求我们寻找一个仅需一阶可导的[位移场](@entry_id:141476) $u(x)$，它满足[本质边界条件](@entry_id:173524)，并且对于所有满足齐次本质边界条件的[检验函数](@entry_id:166589) $v(x)$，上述[积分方程](@entry_id:138643)都成立。

### 离散化：有限元概念

解析地求解[弱形式](@entry_id:142897)方程通常仍然很困难。有限元法的核心思想是用一个分片多项式函数来近似真实的解。为此，我们将连续的定义域 $[0, L]$ 分割成若干个互不重叠的子域，即**单元 (elements)**。在每个单元内部，我们用简单的多项式来插值位移场。

#### [等参映射](@entry_id:173239)与形函数

为了方便地在任意形状和大小的单元上进行计算，我们引入一个标准的**参考单元 (reference element)**，或称**母单元 (parent element)**。对于一维问题，通常选择区间 $\xi \in [-1, 1]$ 作为[参考单元](@entry_id:168425) [@problem_id:2538104]。物理[坐标系](@entry_id:156346)中的任意一个单元（例如，从 $x_1$ 到 $x_2$）都可以通过一个映射关系与[参考单元](@entry_id:168425)建立联系。

这个映射关系本身也可以用[插值函数](@entry_id:262791)来构造。假设一个单元有两个节点，分别位于 $x_1$ 和 $x_2$。在参考单元中，这两个节点对应于 $\xi_1 = -1$ 和 $\xi_2 = 1$。我们构造两个线性多项式 $N_1(\xi)$ 和 $N_2(\xi)$，称为**形函数 (shape functions)**，它们具有**克罗内克-德尔塔 (Kronecker delta)** 性质：
$N_i(\xi_j) = \delta_{ij} = \begin{cases} 1  \text{if } i=j \\ 0  \text{if } i \neq j \end{cases}$

对于线性插值，形函数 $N_i(\xi)$ 是一次多项式。通过求解简单的[代数方程](@entry_id:272665)，我们可以得到 [@problem_id:2538097]：
$N_1(\xi) = \dfrac{1-\xi}{2}$
$N_2(\xi) = \dfrac{1+\xi}{2}$

这两个形函数具有**[单位分解](@entry_id:150115) (partition of unity)** 的重要性质，即 $N_1(\xi) + N_2(\xi) = 1$ 对所有 $\xi \in [-1, 1]$ 成立。

**等参 (isoparametric)** 概念指的是，我们使用相同的形函数来插值几何坐标和物理场变量（位移）。因此，物理坐标 $x$ 和参考坐标 $\xi$ 之间的映射关系可以表示为：
$x(\xi) = N_1(\xi)x_1 + N_2(\xi)x_2 = \dfrac{1-\xi}{2}x_1 + \dfrac{1+\xi}{2}x_2$

这个映射是一个**[仿射映射](@entry_id:746332) (affine map)**。为了在[积分变换](@entry_id:186209)中使用，我们需要计算映射的**[雅可比](@entry_id:264467) (Jacobian)** $J$：
$J = \dfrac{dx}{d\xi} = \dfrac{d}{d\xi} \left( \dfrac{1-\xi}{2}x_1 + \dfrac{1+\xi}{2}x_2 \right) = -\dfrac{x_1}{2} + \dfrac{x_2}{2} = \dfrac{x_2 - x_1}{2}$

令单元长度为 $L_e = x_2 - x_1$，则雅可比 $J = L_e/2$。对于线性单元，雅可比是一个常数，这极大地简化了计算。

同样，单元内的[位移场](@entry_id:141476) $u_h(x)$ 也可以用相同的形函数和节点位移 $u_1, u_2$ 来近似：
$u_h(\xi) = N_1(\xi)u_1 + N_2(\xi)u_2$
用矩阵形式表示为 $u_h = \mathbf{N} \mathbf{d}^{(e)}$，其中 $\mathbf{N} = \begin{pmatrix} N_1  N_2 \end{pmatrix}$ 是形函数行向量，$\mathbf{d}^{(e)} = \begin{pmatrix} u_1 \\ u_2 \end{pmatrix}$ 是单元节点位移列向量。

### 单元矩阵的推导

有了位移场的近似表达式，我们就可以将[弱形式](@entry_id:142897)中的各项离散化，从而推导出单元的**[刚度矩阵](@entry_id:178659) (stiffness matrix)** 和**荷载向量 (load vector)**。

#### 单元[应变-位移矩阵](@entry_id:163451) (B 矩阵)

弱形式中包含应变项 $u'(x)$。我们需要将其用节点位移 $\mathbf{d}^{(e)}$ 表示。利用链式法则和[雅可比](@entry_id:264467)，我们可以将对物理坐标 $x$ 的导数转换为对参考坐标 $\xi$ 的导数：
$\dfrac{d}{dx} = \dfrac{d\xi}{dx} \dfrac{d}{d\xi} = \left(\dfrac{dx}{d\xi}\right)^{-1} \dfrac{d}{d\xi} = \dfrac{1}{J} \dfrac{d}{d\xi}$

因此，单元内的应变可以表示为：
$\varepsilon(x) = \dfrac{du_h}{dx} = \dfrac{1}{J} \dfrac{d}{d\xi} \left( N_1(\xi)u_1 + N_2(\xi)u_2 \right) = \dfrac{1}{J} \left( \dfrac{dN_1}{d\xi}u_1 + \dfrac{dN_2}{d\xi}u_2 \right)$

计算形函数对 $\xi$ 的导数：
$\dfrac{dN_1}{d\xi} = -\dfrac{1}{2}, \quad \dfrac{dN_2}{d\xi} = \dfrac{1}{2}$

代入应变表达式：
$\varepsilon(x) = \dfrac{1}{L_e/2} \left( -\dfrac{1}{2}u_1 + \dfrac{1}{2}u_2 \right) = \dfrac{u_2 - u_1}{L_e}$

这个结果表明，对于线性两节点杆单元，其内部的应变是常数。我们可以将上式写成矩阵形式 $\varepsilon = \mathbf{B} \mathbf{d}^{(e)}$，其中 $\mathbf{B}$ 矩阵被称为**[应变-位移矩阵](@entry_id:163451)**。
$\mathbf{B} = \begin{pmatrix} -\dfrac{1}{L_e}  \dfrac{1}{L_e} \end{pmatrix}$

值得注意的是，$\mathbf{B}$ 矩阵的各分量正是形函数对物理坐标 $x$ 的导数，即 $B_i = \frac{dN_i}{dx}$ [@problem_id:2538130]。

#### [单元刚度矩阵](@entry_id:139369) ($k^{(e)}$)

现在我们来处理弱形式的左侧，即内力[虚功](@entry_id:176403)项，但仅限于单个单元的范围 $\Omega_e = [x_1, x_2]$：
$\delta W_{\text{int}}^{(e)} = \int_{x_1}^{x_2} v'(x) EA u'(x) dx$

将[有限元近似](@entry_id:166278)代入，其中 $u'(x) = \mathbf{B} \mathbf{d}^{(e)}$，检验函数 $v(x)$ 也采用相同的近似形式，因此 $v'(x) = \mathbf{B} \delta \mathbf{d}^{(e)}$，其中 $\delta \mathbf{d}^{(e)}$ 是任意的虚节点位移。
$\delta W_{\text{int}}^{(e)} = \int_{x_1}^{x_2} (\mathbf{B} \delta \mathbf{d}^{(e)})^T EA (\mathbf{B} \mathbf{d}^{(e)}) dx$

由于节点位移向量与积分无关，可以提出积分号：
$\delta W_{\text{int}}^{(e)} = (\delta \mathbf{d}^{(e)})^T \left( \int_{x_1}^{x_2} \mathbf{B}^T E A \mathbf{B} dx \right) \mathbf{d}^{(e)}$

括号内的积分项定义了**[单元刚度矩阵](@entry_id:139369)** $k^{(e)}$：
$k^{(e)} = \int_{x_1}^{x_2} \mathbf{B}^T E A \mathbf{B} dx$

对于材料和几何属性在单元内恒定的情况（$E$ 和 $A$ 为常数），且 $\mathbf{B}$ 矩阵也为常数，积分变得非常简单 [@problem_id:2538026]：
$k^{(e)} = \mathbf{B}^T E A \mathbf{B} \int_{x_1}^{x_2} dx = \mathbf{B}^T E A \mathbf{B} \cdot L_e$
$k^{(e)} = \begin{pmatrix} -1/L_e \\ 1/L_e \end{pmatrix} EA \begin{pmatrix} -1/L_e  1/L_e \end{pmatrix} L_e = \dfrac{EA}{L_e^2} \begin{pmatrix} 1  -1 \\ -1  1 \end{pmatrix} L_e = \dfrac{EA}{L_e} \begin{pmatrix} 1  -1 \\ -1  1 \end{pmatrix}$

这个 $2 \times 2$ 矩阵是[结构分析](@entry_id:153861)中最基本的[单元刚度矩阵](@entry_id:139369)之一。

#### [一致荷载向量](@entry_id:163156) ($f^{(e)}$)

[弱形式](@entry_id:142897)的右侧代表外力[虚功](@entry_id:176403)，它构成了荷载向量的来源。主要包括[体力](@entry_id:174230)项和边界力项 [@problem_id:2538029]。

**1. [体力](@entry_id:174230)荷载**

体力项的[虚功](@entry_id:176403)为 $\delta W_{\text{ext, body}}^{(e)} = \int_{x_1}^{x_2} v(x) b(x) dx$（这里假设 $b(x)$ 是单位长度的力）。代入 $v(x) = \mathbf{N}(x) \delta \mathbf{d}^{(e)}$：
$\delta W_{\text{ext, body}}^{(e)} = \int_{x_1}^{x_2} (\mathbf{N} \delta \mathbf{d}^{(e)}) b(x) dx = (\delta \mathbf{d}^{(e)})^T \left( \int_{x_1}^{x_2} \mathbf{N}^T b(x) dx \right)$

因此，由[体力](@entry_id:174230)产生的单元荷载向量为：
$f_b^{(e)} = \int_{x_1}^{x_2} \mathbf{N}^T b(x) dx$

这种通过与形函数加权积分得到的荷载向量称为**[一致荷载向量](@entry_id:163156) (consistent load vector)**，因为它与位移场的插值方式保持一致，保证了功的等价性。为了计算这个积分，我们通常需要转换到参考[坐标系](@entry_id:156346)：
$f_b^{(e)} = \int_{-1}^{1} \mathbf{N}(\xi)^T b(x(\xi)) J d\xi$

作为一个具体的例子 [@problem_id:2538097]，如果体力是线性[分布](@entry_id:182848)的 $b(x) = \beta_0 + \beta_1 x$，并且[横截面](@entry_id:154995)积为常数 $A$，则作用于节点1的体力荷载分量为：
$f_{b,1}^{(e)} = \int_{-1}^{1} N_1(\xi) A (\beta_0 + \beta_1 x(\xi)) J d\xi = \dfrac{A(x_2 - x_1)}{6} (3\beta_0 + 2\beta_1 x_1 + \beta_1 x_2)$

**2. 边界牵[引力](@entry_id:175476)荷载**

当单元的某个节点（例如节点2）恰好处在施加了自然边界条件的全局边界上时，例如 $N(x_2) = \bar{N}_2$，该边界力做的[虚功](@entry_id:176403)为 $v(x_2)\bar{N}_2$。
将 $v(x_2) = \mathbf{N}(x_2) \delta \mathbf{d}^{(e)}$ 代入，得到：
$\delta W_{\text{ext, traction}}^{(e)} = (\mathbf{N}(x_2) \delta \mathbf{d}^{(e)}) \bar{N}_2 = (\delta \mathbf{d}^{(e)})^T (\mathbf{N}(x_2)^T \bar{N}_2)$

因此，边界牵[引力](@entry_id:175476)产生的**一致端点力 (consistent end force)** 向量为 [@problem_id:2538115]：
$f_t^{(e)} = \mathbf{N}(x_2)^T \bar{N}_2$

由于形函数的克罗内克-德尔[塔性质](@entry_id:273153)，$\mathbf{N}(x_2) = \begin{pmatrix} N_1(x_2)  N_2(x_2) \end{pmatrix} = \begin{pmatrix} 0  1 \end{pmatrix}$。所以：
$f_t^{(e)} = \begin{pmatrix} 0 \\ 1 \end{pmatrix} \bar{N}_2 = \begin{pmatrix} 0 \\ \bar{N}_2 \end{pmatrix}$

这意味着对于线性单元，节点上的集中力被完全分配给了该节点。这个结论会随着单元阶次的提高而改变。例如，对于一个三节点二次单元，其节点分别在 $\xi = -1, 0, 1$，若在右端点 $\xi=1$ 处施加力，则[一致荷载向量](@entry_id:163156)为 $\mathbf{N}(1)^T \bar{N} = \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix} \bar{N}$。

综上，单元的离散平衡方程为 $k^{(e)} \mathbf{d}^{(e)} = f^{(e)}$，其中 $f^{(e)} = f_b^{(e)} + f_t^{(e)}$。

### 从单元到全局系统

#### 组装

推导出每个单元的刚度矩阵和荷载向量后，下一步是将它们**组装 (assemble)** 成一个描述整个结构行为的全局线性方程组 $K \mathbf{d} = \mathbf{f}$。

组装过程的物理基础是在共享节点处，位移是连续的，且[内力](@entry_id:167605)是平衡的。在数学上，组装是一个“ scatter-add ”（散布-相加）的过程：将每个单元矩阵的元素，根据其全局节点编号，添加到全局矩阵的相应位置。

这个过程可以用一个**聚集矩阵 (gather matrix)** $P^{(e)}$ 来形式化地描述 [@problem_id:2538028]。对于单元 $e$，其局部节点位移向量 $\mathbf{d}^{(e)}$ 可以从全局位移向量 $\mathbf{d}$ 中通过 $P^{(e)}$ 提取出来，即 $\mathbf{d}^{(e)} = P^{(e)} \mathbf{d}$。基于能量相加原理，可以推导出[全局刚度矩阵](@entry_id:138630) $K$ 和全局荷载向量 $\mathbf{f}$ 的组装公式：
$K = \sum_{e} (P^{(e)})^T k^{(e)} P^{(e)}$
$\mathbf{f} = \sum_{e} (P^{(e)})^T f^{(e)}$

这里的[转置](@entry_id:142115)矩阵 $(P^{(e)})^T$ 执行了“散布”操作，将局部贡献映射回全局自由度。

#### [全局刚度矩阵](@entry_id:138630)的性质

组装完成但尚未施加任何位移约束时，[全局刚度矩阵](@entry_id:138630) $K$ 是**对称半正定 (symmetric positive semidefinite)** 的 [@problem_id:2538138]。其“半正定”而非“正定”的原因在于系统存在**[刚体模态](@entry_id:754366) (rigid body modes)**。对于一维杆件，[刚体模态](@entry_id:754366)是整个结构的平移，即所有节点的位移相同，$d_i = c$（常数）。在这种位移模式下，杆件不产生任何应变，因此应变能为零，即 $\mathbf{d}^T K \mathbf{d} = 0$。这意味着 $K$ 存在一个非零的[零空间](@entry_id:171336)，因此是奇异的，[线性方程组](@entry_id:148943) $K\mathbf{d}=\mathbf{f}$ 没有唯一解。

为了获得唯一解，我们必须通过施加足够的边界条件来消除所有[刚体模态](@entry_id:754366)。
*   **施加本质边界条件**：固定至少一个节点的位移（例如 $u_1 = 0$）。这直接消除了刚体平移的可能性。在代数上，这对应于从系统中移除一个自由度，得到的约化刚度矩阵是**[对称正定](@entry_id:145886) (symmetric positive definite)** 的，保证了[方程组](@entry_id:193238)有唯一解。
*   **使用弹性支撑**：如果在杆的至少一个端点连接一个刚度为 $k>0$ 的弹簧，即使没有固定的位移约束，系统也能抵抗刚体平移。此时，刚体平移会引起弹簧的变形，产生应变能，因此 $\mathbf{d}^T K \mathbf{d} > 0$。此时整个系统的刚度矩阵也是[对称正定](@entry_id:145886)的。

如果一个结构由多个（例如 $m$ 个）[相互独立](@entry_id:273670)的子结构组成，那么在未施加任何约束时，每个子结构都有一个独立的[刚体模态](@entry_id:754366)。因此，总的刚度[矩阵的[零空](@entry_id:152429)间](@entry_id:171336)维数为 $m$。

#### 施加本质边界条件

在获得奇异的全局系统 $K \mathbf{d} = \mathbf{f}$ 后，最后一步是施加[本质边界条件](@entry_id:173524)，例如 $u_i = \bar{u}$。这是一个至关重要的步骤，有多种实现方法 [@problem_id:2538035]：

1.  **直接消元法**：这是最直接的方法。将已知位移 $u_i = \bar{u}$ 代入[方程组](@entry_id:193238)，然后将第 $i$ 个方程从系统中移除。这会形成一个针对未知自由度的、规模更小的、[对称正定](@entry_id:145886)的[线性系统](@entry_id:147850)。这种方法精确，且不会引入[数值病态](@entry_id:169044)问题。

2.  **[罚函数法](@entry_id:636090) (Penalty Method)**：这种方法通过在总势能中增加一个惩罚项 $\frac{1}{2}\alpha(u_i - \bar{u})^2$ 来近似施加约束，其中 $\alpha$ 是一个很大的正数（罚参数）。在代数上，这等效于在刚度矩阵的对角[线元](@entry_id:196833)素 $K_{ii}$ 上加上 $\alpha$，并在荷载向量的第 $i$ 项 $f_i$ 上加上 $\alpha\bar{u}$。优点是保持了原系统的规模和对称性。缺点是：(1) 约束是近似满足的，精度与 $\alpha$ 的大小有关；(2) 当 $\alpha$ 非常大时，会导致系统[矩阵的[条件](@entry_id:150947)数](@entry_id:145150)急剧增大，从而引发数值求解的困难。

3.  **拉格朗日乘子法 (Lagrange Multiplier Method)**：该方法引入一个新的未知量——拉格朗日乘子 $\lambda$，并将约束方程 $u_i = \bar{u}$ 添加到原[方程组](@entry_id:193238)中，形成一个增广的[鞍点系统](@entry_id:754480)。优点是能够精确地满足约束，且无需选择大的参数。缺点是增广后的系统矩阵虽然对称，但却是**不定 (indefinite)** 的（既有正[特征值](@entry_id:154894)也有负[特征值](@entry_id:154894)），因此不能使用标准的[共轭梯度法](@entry_id:143436)等为正定系统设计的求解器。

在实践中，各种方法的选择取决于问题的具体情况、求解器的能力以及对精度和计算效率的权衡。通过这些步骤，我们最终得到一个良态的、具有唯一解的线性[代数方程](@entry_id:272665)组，其求解便可得到结构在给定荷载下的节点位移。