{"hands_on_practices": [{"introduction": "将微分方程的强形式转化为弱（或变分）形式是有限元方法的第一步。这个练习将指导你完成这一基本过程，从一个一般的二阶椭圆偏微分方程出发，通过分部积分将微分算子从未知解转移到检验函数上。这个过程不仅能让你熟练掌握核心技巧，还能揭示问题的内在数学结构，例如微分算子的对称性如何直接转化为双线性形式的对称性，这对后续的理论分析和数值求解至关重要。[@problem_id:2603817]", "problem": "考虑一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$，其中 $d \\geq 1$，其在 $\\partial \\Omega$ 上的外单位法向量为 $\\boldsymbol{n}$。设 $f \\in L^{2}(\\Omega)$，并设 $\\kappa:\\Omega \\to \\mathbb{R}^{d \\times d}$ 是一个可测、一致椭圆且本质有界的矩阵场，这意味着存在常数 $\\alpha, \\beta \\in \\mathbb{R}$ 满足 $0  \\alpha \\leq \\beta  \\infty$，使得对于几乎所有的 $x \\in \\Omega$ 和每一个 $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$，都有 $\\alpha |\\boldsymbol{\\xi}|^{2} \\leq \\boldsymbol{\\xi}^{\\top}\\kappa(x)\\boldsymbol{\\xi} \\leq \\beta |\\boldsymbol{\\xi}|^{2}$。假设对于几乎所有的 $x \\in \\Omega$，$\\kappa(x)$ 是对称的。考虑二阶线性椭圆偏微分方程(PDE)\n$$\n-\\nabla \\cdot \\big( \\kappa(x) \\nabla u(x) \\big) = f(x) \\quad \\text{在 } \\Omega \\text{ 内}, \\qquad u(x)=0 \\quad \\text{在 } \\partial \\Omega \\text{ 上}.\n$$\n从上述强形式出发，仅使用微积分的基本结果（如 Gauss-Green 散度定理和 Sobolev 空间的定义），完成以下任务：\n\n$1.$ 通过确定合适的试验空间和测试空间，利用分部积分将未知解的导数转移到测试函数上，并说明边界项为何消失，从而推导出该边值问题的弱形式。\n\n$2.$ 确定与弱形式相关的双线性形式和线性泛函，并陈述它们的定义域。\n\n$3.$ 仅利用 $\\kappa(x)$ 的对称性以及点积和转置的基本性质，明确展示 $\\kappa(x)$ 的对称性如何导出双线性形式的对称性。\n\n$4.$ 最后，对于在第 1 部分中得到的测试空间中的任意 $u,v$，计算表达式 $a(u,v) - a(v,u)$，并给出最终的简化表达式。你的最终答案必须是单一的封闭形式表达式。无需四舍五入，也无需报告单位。", "solution": "首先对问题陈述进行验证。\n\n**问题验证**\n\n步骤 1：提取已知条件。\n- 域：一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$，其中 $d \\geq 1$。\n- 边界单位法向量：$\\boldsymbol{n}$ 是在 $\\partial \\Omega$ 上的外单位法向量。\n- 源项：$f \\in L^{2}(\\Omega)$。\n- 扩散张量：$\\kappa:\\Omega \\to \\mathbb{R}^{d \\times d}$ 是一个可测、一致椭圆且本质有界的矩阵场。\n- 椭圆性和有界性常数：$0  \\alpha \\leq \\beta  \\infty$。\n- 一致椭圆性条件：对于几乎所有的 $x \\in \\Omega$ 和每一个 $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$，$\\alpha |\\boldsymbol{\\xi}|^{2} \\leq \\boldsymbol{\\xi}^{\\top}\\kappa(x)\\boldsymbol{\\xi} \\leq \\beta |\\boldsymbol{\\xi}|^{2}$。\n- 张量的对称性：对于几乎所有的 $x \\in \\Omega$，$\\kappa(x)$ 是对称的。\n- 偏微分方程（强形式）：$-\\nabla \\cdot \\big( \\kappa(x) \\nabla u(x) \\big) = f(x)$ 在 $\\Omega$ 内。\n- 边界条件：$u(x)=0$ 在 $\\partial \\Omega$ 上。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，是适定的、客观的且自洽的。它提出了一个带有齐次 Dirichlet 边界条件的标准二阶线性椭圆边值问题。关于域 $\\Omega$、扩散张量 $\\kappa$ 和源项 $f$ 的条件，正是应用 Lax-Milgram 定理所需的标准假设，该定理保证了在 Sobolev 空间 $H_0^1(\\Omega)$ 中弱解的存在性和唯一性。该问题没有科学不准确之处、歧义或任何主观或非形式化的内容。这些任务是偏微分方程理论和有限元方法中的一个标准且基本的练习。\n\n步骤 3：结论与行动。\n该问题有效。我将继续提供完整解答。\n\n**解答**\n\n$1.$ 弱形式的推导。\n\n我们从偏微分方程的强形式开始：\n$$\n-\\nabla \\cdot \\big( \\kappa(x) \\nabla u(x) \\big) = f(x) \\quad \\text{在 } \\Omega \\text{ 内}.\n$$\n为推导弱形式，我们将方程乘以一个在边界 $\\partial \\Omega$ 上为零的足够光滑的测试函数 $v(x)$，并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} -\\nabla \\cdot \\big( \\kappa \\nabla u \\big) v \\, dx = \\int_{\\Omega} f v \\, dx.\n$$\n核心思想是将导数从未知解 $u$ 转移到测试函数 $v$ 上。我们应用散度的乘积法则，可表示为 $\\nabla \\cdot (\\boldsymbol{F} \\phi) = (\\nabla \\cdot \\boldsymbol{F}) \\phi + \\boldsymbol{F} \\cdot \\nabla \\phi$。令 $\\boldsymbol{F} = \\kappa \\nabla u$ 且 $\\phi=v$，我们有 $\\nabla \\cdot (v \\kappa \\nabla u) = (\\nabla \\cdot(\\kappa \\nabla u)) v + (\\kappa \\nabla u) \\cdot \\nabla v$。这意味着 $-(\\nabla \\cdot(\\kappa \\nabla u)) v = (\\kappa \\nabla u) \\cdot \\nabla v - \\nabla \\cdot (v \\kappa \\nabla u)$。将此代入积分方程得到：\n$$\n\\int_{\\Omega} \\left( (\\kappa \\nabla u) \\cdot \\nabla v - \\nabla \\cdot (v \\kappa \\nabla u) \\right) \\, dx = \\int_{\\Omega} f v \\, dx.\n$$\n根据积分的线性性质，我们分离左侧的各项：\n$$\n\\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\Omega} \\nabla \\cdot (v \\kappa \\nabla u) \\, dx = \\int_{\\Omega} f v \\, dx.\n$$\n我们对第二项应用 Gauss-Green 散度定理，该定理指出对于一个足够正则的向量场 $\\boldsymbol{G}$，有 $\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{G} \\, dx = \\int_{\\partial \\Omega} \\boldsymbol{G} \\cdot \\boldsymbol{n} \\, dS$。在这里，我们的向量场是 $\\boldsymbol{G} = v \\kappa \\nabla u$：\n$$\n\\int_{\\Omega} \\nabla \\cdot (v \\kappa \\nabla u) \\, dx = \\int_{\\partial \\Omega} v (\\kappa \\nabla u) \\cdot \\boldsymbol{n} \\, dS.\n$$\n这将方程转化为：\n$$\n\\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\partial \\Omega} v (\\kappa \\nabla u) \\cdot \\boldsymbol{n} \\, dS = \\int_{\\Omega} f v \\, dx.\n$$\n现在我们必须定义合适的函数空间。为使弱形式良定义，我们需要积分是有限的。$\\int_{\\Omega} (\\nabla u) \\cdot (\\nabla v) \\, dx$ 和 $\\int_{\\Omega} f v \\, dx$ 这两项表明 $u$、$v$ 及其一阶导数应属于 $L^2(\\Omega)$，且已知 $f$ 属于 $L^2(\\Omega)$。这引出了 Sobolev 空间 $H^1(\\Omega) = \\{w \\in L^2(\\Omega) : \\nabla w \\in [L^2(\\Omega)]^d\\}$。边界条件 $u=0$ on $\\partial \\Omega$ 通过在子空间 $H_0^1(\\Omega)$ 中寻求解 $u$ 来强制实施，$H_0^1(\\Omega)$ 是 $C_c^\\infty(\\Omega)$（在 $\\Omega$ 中具有紧支集的无穷可微函数）在 $H^1(\\Omega)$ 范数下的闭包。$H_0^1(\\Omega)$ 中的函数在边界 $\\partial \\Omega$ 上的迹为零。这个空间 $H_0^1(\\Omega)$ 作为解 $u$ 的**试验空间**。我们也选择它作为 $v$ 的**测试空间**。\n\n由于 $v \\in H_0^1(\\Omega)$，其在边界上的迹为零，即在 $\\partial \\Omega$ 上 $v=0$。因此，边界积分消失：\n$$\n\\int_{\\partial \\Omega} v (\\kappa \\nabla u) \\cdot \\boldsymbol{n} \\, dS = 0.\n$$\n最终的弱形式为：求 $u \\in H_0^1(\\Omega)$，使得对于所有 $v \\in H_0^1(\\Omega)$，下式成立：\n$$\n\\int_{\\Omega} (\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) \\, dx = \\int_{\\Omega} f(x) v(x) \\, dx.\n$$\n\n$2.$ 双线性形式和线性泛函的确定。\n\n弱形式是一个抽象形式为 $a(u,v) = L(v)$ 的方程。通过与推导出的方程进行比较，我们确定以下内容：\n\n- **双线性形式** $a(\\cdot, \\cdot)$ 由下式给出：\n$$\na(u,v) = \\int_{\\Omega} (\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) \\, dx.\n$$\n其定义域为 $H_0^1(\\Omega) \\times H_0^1(\\Omega)$，因此 $a: H_0^1(\\Omega) \\times H_0^1(\\Omega) \\to \\mathbb{R}$。\n\n- **线性泛函** $L(\\cdot)$ 由下式给出：\n$$\nL(v) = \\int_{\\Omega} f(x) v(x) \\, dx.\n$$\n其定义域为 $H_0^1(\\Omega)$，因此 $L: H_0^1(\\Omega) \\to \\mathbb{R}$。\n\n$3.$ 双线性形式的对称性。\n\n我们的任务是证明张量 $\\kappa(x)$ 的对称性意味着双线性形式 $a(u,v)$ 的对称性，即对于所有 $u, v \\in H_0^1(\\Omega)$，有 $a(u,v) = a(v,u)$。\n\n令 $\\boldsymbol{\\xi} = \\nabla u$ 和 $\\boldsymbol{\\eta} = \\nabla v$。双线性形式为 $a(u,v) = \\int_{\\Omega} (\\kappa \\boldsymbol{\\xi}) \\cdot \\boldsymbol{\\eta} \\, dx$。\n两个向量 $\\boldsymbol{a}$ 和 $\\boldsymbol{b}$ 的点积可以写为 $\\boldsymbol{a} \\cdot \\boldsymbol{b} = \\boldsymbol{a}^\\top \\boldsymbol{b}$。\n利用这一点，$a(u,v)$ 的被积函数为 $(\\kappa \\boldsymbol{\\xi}) \\cdot \\boldsymbol{\\eta} = \\boldsymbol{\\eta}^\\top (\\kappa \\boldsymbol{\\xi})$。\n由于该表达式是一个标量，它等于其自身的转置：\n$$\n\\boldsymbol{\\eta}^\\top (\\kappa \\boldsymbol{\\xi}) = (\\boldsymbol{\\eta}^\\top \\kappa \\boldsymbol{\\xi})^\\top.\n$$\n利用乘积的转置性质 $(ABC)^\\top = C^\\top B^\\top A^\\top$，我们得到：\n$$\n(\\boldsymbol{\\eta}^\\top \\kappa \\boldsymbol{\\xi})^\\top = \\boldsymbol{\\xi}^\\top \\kappa^\\top (\\boldsymbol{\\eta}^\\top)^\\top = \\boldsymbol{\\xi}^\\top \\kappa^\\top \\boldsymbol{\\eta}.\n$$\n因此，我们证明了对于任何向量 $\\boldsymbol{\\xi}, \\boldsymbol{\\eta}$ 和矩阵 $\\kappa$，都有 $\\boldsymbol{\\eta}^\\top \\kappa \\boldsymbol{\\xi} = \\boldsymbol{\\xi}^\\top \\kappa^\\top \\boldsymbol{\\eta}$。\n\n问题陈述中说明矩阵场 $\\kappa(x)$ 对于几乎所有的 $x \\in \\Omega$ 都是对称的。这意味着对于几乎处处的 $x \\in \\Omega$，$\\kappa(x)^\\top = \\kappa(x)$。代入这个性质，我们得到：\n$$\n\\boldsymbol{\\xi}(x)^\\top \\kappa(x)^\\top \\boldsymbol{\\eta}(x) = \\boldsymbol{\\xi}(x)^\\top \\kappa(x) \\boldsymbol{\\eta}(x) \\quad \\text{对于几乎处处的 } x \\in \\Omega.\n$$\n所以，对于几乎处处的 $x \\in \\Omega$，被积函数相等：\n$$\n(\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) = (\\nabla v(x))^\\top \\kappa(x) \\nabla u(x) = (\\nabla u(x))^\\top \\kappa(x)^\\top \\nabla v(x) = (\\nabla u(x))^\\top \\kappa(x) \\nabla v(x).\n$$\n右侧的表达式 $(\\nabla u(x))^\\top \\kappa(x) \\nabla v(x)$ 是 $a(v,u)$ 的被积函数：\n$$\na(v,u) = \\int_{\\Omega} (\\kappa(x) \\nabla v(x)) \\cdot \\nabla u(x) \\, dx = \\int_{\\Omega} (\\nabla u(x))^\\top \\kappa(x) \\nabla v(x) \\,dx.\n$$\n由于被积函数在 $\\Omega$ 上几乎处处相等，它们在 $\\Omega$ 上的积分也相等：\n$$\na(u,v) = \\int_{\\Omega} (\\nabla v)^\\top \\kappa \\nabla u \\, dx = \\int_{\\Omega} (\\nabla u)^\\top \\kappa \\nabla v \\, dx = a(v,u).\n$$\n这明确地证明了 $\\kappa$ 的对称性导出了双线性形式 $a(\\cdot,\\cdot)$ 的对称性。\n\n$4.$ 计算 $a(u,v) - a(v,u)$。\n\n我们被要求计算对于任意 $u,v \\in H_0^1(\\Omega)$ 的表达式 $a(u,v) - a(v,u)$。\n根据第 3 部分的推导，我们已经证明在给定的问题条件下（包括 $\\kappa(x)$ 的对称性），$a(u,v) = a(v,u)$。\n因此，对于任意选择的 $u, v \\in H_0^1(\\Omega)$：\n$$\na(u,v) - a(v,u) = a(u,v) - a(u,v) = 0.\n$$\n为明确起见，我们写出积分：\n$$\na(u,v) - a(v,u) = \\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\Omega} (\\kappa \\nabla v) \\cdot \\nabla u \\, dx.\n$$\n将各项合并到单个积分下：\n$$\n= \\int_{\\Omega} \\left( (\\kappa \\nabla u) \\cdot \\nabla v - (\\kappa \\nabla v) \\cdot \\nabla u \\right) \\, dx.\n$$\n如第 3 部分所示，$\\kappa$ 的对称性意味着被积函数中的两项几乎处处相等。为清晰起见，我们将被积函数写为 $\\mathcal{I}(x) = (\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) - (\\kappa(x) \\nabla v(x)) \\cdot \\nabla u(x)$。使用矩阵表示法，即为 $(\\nabla v)^\\top \\kappa (\\nabla u) - (\\nabla u)^\\top \\kappa (\\nabla v)$。由于 $(\\nabla u)^\\top \\kappa (\\nabla v)$ 是一个标量，它等于其转置，即 $(\\nabla v)^\\top \\kappa^\\top (\\nabla u)$。因此，被积函数为 $(\\nabla v)^\\top \\kappa (\\nabla u) - (\\nabla v)^\\top \\kappa^\\top (\\nabla u) = (\\nabla v)^\\top (\\kappa - \\kappa^\\top) (\\nabla u)$。\n给定 $\\kappa = \\kappa^\\top$，则 $\\kappa - \\kappa^\\top$ 是零矩阵。因此，对于几乎所有的 $x \\in \\Omega$，被积函数 $\\mathcal{I}(x)$ 恒为零。\n一个几乎处处为零的函数的积分是零。\n$$\na(u,v) - a(v,u) = \\int_{\\Omega} 0 \\, dx = 0.\n$$\n最终的简化表达式是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "2603817"}, {"introduction": "弱形式的真正威力在于它能够处理强形式在经典函数空间中无意义的问题，例如带有集中载荷或点源的问题。本练习通过一个经典例子——由狄拉克（Dirac）分布 $\\delta_{x_0}$ 代表的点源所驱动的泊松（Poisson）方程，来具体展示这一点。你将证明拉普拉斯（Laplace）算子的基本解（它在源点是奇异的）如何精确地满足该方程的弱形式，从而深刻理解弱解如何自然地推广了经典解的概念。[@problem_id:2603885]", "problem": "设 $n \\geq 2$ 且 $x_{0} \\in \\mathbb{R}^{n}$ 为一个固定点。考虑在全空间中，在 $x_{0}$ 处有一个点源的泊松方程，\n$$\n- \\Delta u = \\delta_{x_{0}} \\quad \\text{在 } \\mathbb{R}^{n} \\text{ 中},\n$$\n其中 $\\delta_{x_{0}}$ 是集中在 $x_{0}$ 的狄拉克分布，$\\Delta$ 是拉普拉斯算子。设 $u$ 由以 $x_{0}$ 为中心的基解给出，即 $u(x) = \\Phi(x - x_{0})$，其中\n$$\n\\Phi(x) =\n\\begin{cases}\n\\dfrac{1}{(n-2)\\,\\sigma_{n}}\\,|x|^{2-n},  n \\geq 3, \\\\[1.2ex]\n\\dfrac{1}{2\\pi}\\,\\ln\\!\\left(\\dfrac{1}{|x|}\\right),  n = 2,\n\\end{cases}\n$$\n且 $\\sigma_{n}$ 表示 $\\mathbb{R}^{n}$ 中单位球面的 $(n-1)$ 维表面测度。对于任意检验函数 $v \\in C_{c}^{\\infty}(\\mathbb{R}^{n})$（具有紧支集的光滑函数），定义泛函\n$$\nI(v) := \\int_{\\mathbb{R}^{n}} \\nabla u(x) \\cdot \\nabla v(x)\\, \\mathrm{d}x.\n$$\n仅使用基本原理（狄拉克分布的性质、散度定理以及 $v$ 的光滑性/紧支集性质），以 $v$ 和 $x_{0}$ 的形式计算 $I(v)$ 的闭式解。将你的最终答案表示为一个精确的解析表达式。无需四舍五入，也不涉及物理单位。", "solution": "所述问题是有效的。这是一个关于带分布源的泊松方程弱形式的偏微分方程理论中的标准、适定问题。所有术语都有明确的数学定义，且问题具有科学依据。我们开始求解。\n\n目标是计算如下定义的泛函 $I(v)$：\n$$\nI(v) := \\int_{\\mathbb{R}^{n}} \\nabla u(x) \\cdot \\nabla v(x)\\, \\mathrm{d}x,\n$$\n其中 $u(x) = \\Phi(x - x_0)$ 是满足 $-\\Delta u = \\delta_{x_0}$ 的拉普拉斯算子的基本解，而 $v \\in C_{c}^{\\infty}(\\mathbb{R}^{n})$ 是一个具有紧支集的光滑检验函数。\n\n被积函数涉及梯度的乘积，这提示我们使用分部积分法，或者更一般地，使用作为散度定理推论的格林第一恒等式。然而，函数 $u(x)$ 在 $x = x_0$ 处有一个奇点，其梯度 $\\nabla u(x)$ 也是如此。因此，我们不能直接在整个空间 $\\mathbb{R}^n$ 上应用格林恒等式。\n\n为了正确地进行计算，我们必须挖掉这个奇点。设 $B_{\\epsilon}(x_0)$ 是一个以点 $x_0$ 为中心、半径为 $\\epsilon  0$ 的开球。由于检验函数 $v(x)$ 具有紧支集，存在一个半径 $R  0$ 使得 $v$ 的支集包含在球 $B_R(0)$ 内。我们选择足够大的 $R$ 和足够小的 $\\epsilon$ 使得 $x_0 \\in B_R(0)$ 且 $B_\\epsilon(x_0) \\subset B_R(0)$。我们定义区域 $\\Omega_{R,\\epsilon} := B_R(0) \\setminus \\overline{B_{\\epsilon}(x_0)}$。在这个区域中，$u$ 和 $v$ 都是光滑的。\n\n在区域 $\\Omega_{R,\\epsilon}$ 上对 $u$ 和 $v$ 应用格林第一恒等式：\n$$\n\\int_{\\Omega_{R,\\epsilon}} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = -\\int_{\\Omega_{R,\\epsilon}} v (\\Delta u) \\, \\mathrm{d}x + \\int_{\\partial \\Omega_{R,\\epsilon}} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S,\n$$\n其中 $\\mathbf{n}$ 是边界 $\\partial \\Omega_{R,\\epsilon}$ 的单位外法向量。\n\n让我们分析这个恒等式中的每一项。\n在区域 $\\Omega_{R,\\epsilon}$ 内部，我们有 $x \\neq x_0$。函数 $u$ 是基本解，对于所有 $x \\neq x_0$ 都满足 $\\Delta u = 0$。因此，体积分消失了：\n$$\n-\\int_{\\Omega_{R,\\epsilon}} v (\\Delta u) \\, \\mathrm{d}x = 0.\n$$\n边界 $\\partial \\Omega_{R,\\epsilon}$ 由两个部分组成：外球面 $\\partial B_R(0)$ 和内球面 $\\partial B_\\epsilon(x_0)$。\n边界积分变为：\n$$\n\\int_{\\partial \\Omega_{R,\\epsilon}} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S = \\int_{\\partial B_R(0)} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S + \\int_{\\partial B_\\epsilon(x_0)} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S.\n$$\n在外边界 $\\partial B_R(0)$ 上，函数 $v$ 恒为零，因为 $v$ 的支集包含在 $B_R(0)$ 内。因此，在 $\\partial B_R(0)$ 上的积分为零。\n$$\n\\int_{\\partial B_R(0)} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S = 0.\n$$\n在内边界 $\\partial B_\\epsilon(x_0)$ 上，区域 $\\Omega_{R,\\epsilon}$ 的单位外法向量 $\\mathbf{n}$ 指向中心 $x_0$。如果我们用 $\\mathbf{n}_\\epsilon$ 表示球 $B_\\epsilon(x_0)$ 的标准单位外法向量，那么 $\\mathbf{n} = -\\mathbf{n}_\\epsilon$。法向导数的表达式是 $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} = \\nabla u \\cdot \\mathbf{n}_\\epsilon$。因此，内边界上的积分为：\n$$\n\\int_{\\partial B_\\epsilon(x_0)} v (\\nabla u \\cdot (-\\mathbf{n}_\\epsilon)) \\, \\mathrm{d}S = - \\int_{\\partial B_\\epsilon(x_0)} v \\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} \\, \\mathrm{d}S.\n$$\n综合这些结果，对于任何有效的 $R$ 和 $\\epsilon$，我们有：\n$$\n\\int_{\\Omega_{R,\\epsilon}} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon}(x) \\, \\mathrm{d}S.\n$$\n为了求得 $I(v)$ 的值，我们必须取极限 $\\epsilon \\to 0$ 和 $R \\to \\infty$。当 $R \\to \\infty$ 时，左边积分的区域变为 $\\mathbb{R}^n \\setminus \\overline{B_\\epsilon(x_0)}$。然后取极限 $\\epsilon \\to 0$ 即可得到所求的积分 $I(v)$（作为一个收敛的反常积分）。\n$$\nI(v) = \\lim_{\\epsilon \\to 0} \\left( - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon}(x) \\, \\mathrm{d}S \\right).\n$$\n我们现在必须计算法向导数 $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon}$。设 $y = x - x_0$，则 $u(x) = \\Phi(y)$。在球面 $|y|=\\epsilon$ 上的法向导数是径向导数 $\\frac{\\partial \\Phi}{\\partial r}$，其中 $r = |y|$。\n\n情况 $n \\geq 3$：\n$u(x) = \\Phi(x-x_0) = \\frac{1}{(n-2)\\sigma_n}|x-x_0|^{2-n}$。用 $r = |x-x_0|$ 表示，即为 $\\Phi(r) = \\frac{1}{(n-2)\\sigma_n} r^{2-n}$。\n径向导数为：\n$$\n\\frac{\\partial \\Phi}{\\partial r} = \\frac{(2-n)}{(n-2)\\sigma_n} r^{1-n} = -\\frac{1}{\\sigma_n} r^{1-n}.\n$$\n在球面 $\\partial B_\\epsilon(x_0)$ 上，我们有 $r = \\epsilon$，所以 $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} = -\\frac{1}{\\sigma_n} \\epsilon^{1-n}$。\n将此代入 $I(v)$ 的极限表达式中：\n$$\nI(v) = \\lim_{\\epsilon \\to 0} \\left( - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\left(-\\frac{1}{\\sigma_n \\epsilon^{n-1}}\\right) \\, \\mathrm{d}S \\right) = \\lim_{\\epsilon \\to 0} \\frac{1}{\\sigma_n \\epsilon^{n-1}} \\int_{\\partial B_\\epsilon(x_0)} v(x) \\, \\mathrm{d}S.\n$$\n量 $\\sigma_n \\epsilon^{n-1}$ 是半径为 $\\epsilon$ 的 $(n-1)$ 维球面的表面积。极限下的表达式正是 $v(x)$ 在球面 $\\partial B_\\epsilon(x_0)$ 上的平均值。由于 $v$ 是一个连续函数（实际上是 $C^\\infty$），当球面收缩到点 $x_0$ 时，其平均值的极限就是该点处的函数值。\n$$\nI(v) = v(x_0).\n$$\n\n情况 $n=2$：\n$u(x) = \\Phi(x-x_0) = \\frac{1}{2\\pi}\\ln\\left(\\frac{1}{|x-x_0|}\\right)$。用 $r = |x-x_0|$ 表示，即为 $\\Phi(r) = -\\frac{1}{2\\pi}\\ln(r)$。\n径向导数为：\n$$\n\\frac{\\partial \\Phi}{\\partial r} = -\\frac{1}{2\\pi r}.\n$$\n在圆周 $\\partial B_\\epsilon(x_0)$ 上，我们有 $r=\\epsilon$，所以 $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} = -\\frac{1}{2\\pi \\epsilon}$。\n$I(v)$ 的极限表达式变为：\n$$\nI(v) = \\lim_{\\epsilon \\to 0} \\left( - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\left(-\\frac{1}{2\\pi\\epsilon}\\right) \\, \\mathrm{d}S \\right) = \\lim_{\\epsilon \\to 0} \\frac{1}{2\\pi\\epsilon} \\int_{\\partial B_\\epsilon(x_0)} v(x) \\, \\mathrm{d}S.\n$$\n量 $2\\pi\\epsilon$ 是半径为 $\\epsilon$ 的圆的周长（表面测度）。同样，该表达式是 $v(x)$ 在该圆周上的平均值。根据 $v$ 的连续性，此极限为 $v(x_0)$。\n$$\nI(v) = v(x_0).\n$$\n\n在所有维度 $n \\geq 2$ 中，结果都是相同的。计算表明，方程 $-\\Delta u = \\delta_{x_0}$ 的弱形式等价于以下陈述：对于任意检验函数 $v$，梯度的积分等于源分布作用于该检验函数的结果。最终结果是在狄拉克源所在点处对检验函数的求值。", "answer": "$$\n\\boxed{v(x_{0})}\n$$", "id": "2603885"}, {"introduction": "在许多实际工程问题中，尤其是当对流效应占主导地位时，标准的伽辽金（Galerkin）弱形式可能会导致数值解出现非物理振荡。为了解决这一问题，研究人员发展了多种稳定化方法，它们通过修改原始的弱形式来增强数值格式的稳定性。本练习将引导你构造一种广泛应用的稳定化技术——伽辽金/最小二乘法（Galerkin/Least-Squares, GLS），它通过在弱形式中添加一个惩罚单元内残差的项来实现。通过这个练习，你将理解稳定化方法的设计思想、一致性要求以及它对问题性质（如对称性）的影响。[@problem_id:2603889]", "problem": "考虑在开区间 $\\Omega=(0,1)$ 上的具有齐次狄利克雷边界条件的一维稳态对流-扩散-反应边值问题：\n$$\n-\\varepsilon\\,u''(x) + \\beta\\,u'(x) + \\sigma\\,u(x) = f(x)\\quad\\text{for } x\\in(0,1),\\qquad u(0)=u(1)=0,\n$$\n其中 $\\varepsilon0$，$\\beta\\in\\mathbb{R}$，$\\sigma\\ge 0$ 是常系数，且 $f\\in L^{2}(\\Omega)$。令 $V:=H_{0}^{1}(\\Omega)$ 为试探和检验空间。定义微分算子 $L:V\\to L^{2}(\\Omega)$ 为 $L u := -\\varepsilon\\,u'' + \\beta\\,u' + \\sigma\\,u$。\n\n任务：\n- 从加权余量法原理和基本定义出发，推导该问题的标准伽辽金弱形式。\n- 然后，构建伽辽金/最小二乘 (GLS) 稳定化弱形式，该形式逐单元地惩罚强形式残差的 $L^{2}$ 范数。假设 $\\Omega$ 被任意协调剖分 $\\mathcal{T}_{h}$ 为若干单元 $K$，且在每个 $K\\in\\mathcal{T}_{h}$ 上有一个逐单元常数稳定化参数 $\\tau_{K}0$。用 $\\varepsilon$、$\\beta$、$\\sigma$、残差 $L u - f$ 和 $\\{\\tau_{K}\\}_{K\\in\\mathcal{T}_{h}}$ 显式地给出稳定化双线性形式和线性泛函。\n- 证明稳定化方法的相容性，即强形式的任何满足 $u\\in V$ 的足够光滑的精确解 $u$ 也对 $V$ 中所有的检验函数满足稳定化弱形式。\n- 分析 GLS 稳定化对总双线性形式对称性的影响。确定对于任意选择的 $\\varepsilon0$、$\\sigma\\ge 0$ 和逐单元常数 $\\{\\tau_{K}\\}_{K\\in\\mathcal{T}_{h}}$，使得总稳定化双线性形式在 $V$ 上对称的关于 $\\beta$ 的充要条件。\n\n答案规格：\n- 只报告使总稳定化双线性形式在 $V$ 上对称的 $\\beta$ 值。\n- 你的最终答案必须是一个实数。", "solution": "所给问题是一个标准的一维稳态对流-扩散-反应边值问题。它在数学上是适定的，并有科学依据。所有必要的数据和定义都已提供，没有不一致之处。该问题是有效的。我们开始求解。\n\n该边值问题的强形式是找到一个函数 $u(x)$，使得：\n$$\n-\\varepsilon\\,u''(x) + \\beta\\,u'(x) + \\sigma\\,u(x) = f(x)\\quad\\text{for } x\\in\\Omega=(0,1)\n$$\n具有齐次狄利克雷边界条件 $u(0)=u(1)=0$。试探函数和检验函数的函数空间均为 $V:=H_{0}^{1}(\\Omega)$。系数 $\\varepsilon0$、$\\beta\\in\\mathbb{R}$ 和 $\\sigma\\ge 0$ 是常数，强迫项函数 $f\\in L^{2}(\\Omega)$。微分算子定义为 $L u := -\\varepsilon\\,u'' + \\beta\\,u' + \\sigma\\,u$。\n\n**1. 标准伽辽金弱形式的推导**\n\n弱形式由加权余量法原理推导而来，该原理要求方程的残差 $R(u) = Lu - f$ 与检验空间 $V$ 中的每个检验函数 $v$ 正交。\n$$\n\\int_{\\Omega} (Lu - f)v \\, dx = 0 \\quad \\forall v \\in V\n$$\n代入算子 $L$ 的表达式：\n$$\n\\int_{0}^{1} (-\\varepsilon\\,u''(x) + \\beta\\,u'(x) + \\sigma\\,u(x)) v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx\n$$\n为了降低微分阶数，我们对二阶导数项应用分部积分：\n$$\n\\int_{0}^{1} (-\\varepsilon\\,u'' v) \\, dx = -\\left[\\varepsilon u' v\\right]_{0}^{1} + \\int_{0}^{1} \\varepsilon u' v' \\, dx\n$$\n由于检验函数 $v$ 属于空间 $V = H_{0}^{1}(\\Omega)$，它们满足边界条件 $v(0)=0$ 和 $v(1)=0$。因此，边界项为零：$-\\left[\\varepsilon u'(1) v(1) - \\varepsilon u'(0) v(0)\\right] = 0$。\n将此结果代回加权余量方程，得到标准伽辽金弱形式：求 $u \\in V$，使得\n$$\n\\int_{0}^{1} (\\varepsilon u'(x)v'(x) + \\beta u'(x)v(x) + \\sigma u(x)v(x)) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx \\quad \\forall v \\in V\n$$\n这可以写成抽象形式 $B(u,v) = F(v)$，其中双线性形式 $B:V\\times V \\to \\mathbb{R}$ 和线性泛函 $F:V \\to \\mathbb{R}$ 定义如下：\n$$\nB(u,v) := \\int_{0}^{1} (\\varepsilon u'v' + \\beta u'v + \\sigma uv) \\, dx\n$$\n$$\nF(v) := \\int_{0}^{1} fv \\, dx\n$$\n\n**2. 伽辽金/最小二乘 (GLS) 稳定化弱形式的构建**\n\nGLS 方法在标准伽辽金形式上增加一项，该项惩罚强形式残差的逐单元 $L^2$ 范数。稳定化问题是通过在标准弱形式的两边同时添加一个稳定化项来构建的。GLS 稳定化弱问题的一般形式是：求 $u \\in V$，使得对于所有 $v \\in V$：\n$$\nB(u,v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK = F(v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK\n$$\n其中 $\\mathcal{T}_{h}$ 是 $\\Omega$ 到单元 $K$ 的一个剖分，$\\tau_{K}0$ 是在每个单元 $K$ 上的常数稳定化参数。$(Lu)(Lv)$ 项源于用一个包含 $Lv$ 倍数的修正检验函数来惩罚残差 $Lu-f$。\n\n这导出了稳定化双线性形式 $B_{\\text{total}}(u,v)$ 和稳定化线性泛函 $F_{\\text{total}}(v)$ 的定义。\n稳定化双线性形式为：\n$$\nB_{\\text{total}}(u, v) = B(u,v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK\n$$\n代入 $B(u,v)$ 和 $L$ 的定义：\n$$\nB_{\\text{total}}(u, v) = \\int_{0}^{1} (\\varepsilon u'v' + \\beta u'v + \\sigma uv) \\, dx + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (-\\varepsilon u'' + \\beta u' + \\sigma u)(-\\varepsilon v'' + \\beta v' + \\sigma v) \\, dK\n$$\n稳定化线性泛函为：\n$$\nF_{\\text{total}}(v) = F(v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK\n$$\n代入 $F(v)$ 和 $L$ 的定义：\n$$\nF_{\\text{total}}(v) = \\int_{0}^{1} fv \\, dx + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(-\\varepsilon v'' + \\beta v' + \\sigma v) \\, dK\n$$\n稳定化弱形式是：求 $u \\in V$，使得对于所有 $v \\in V$ 都有 $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$。\n\n**3. 相容性证明**\n\n如果强形式的精确解 $u$ 也满足离散（或稳定化）弱形式，则该数值方法是相容的。设 $u$ 为精确解，这意味着 $u$ 足够光滑，满足边界条件 $u(0)=u(1)=0$，并且对于所有 $x \\in (0,1)$ 满足微分方程 $Lu=f$。\n\n我们必须证明对于这个精确解 $u$，等式 $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$ 对所有 $v \\in V$ 都成立。\n让我们用精确解 $u$ 来检验稳定化形式的左侧 (LHS) 和右侧 (RHS)。\n左侧：$B_{\\text{total}}(u,v) = B(u,v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK$。\n右侧：$F_{\\text{total}}(v) = F(v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK$。\n\n由于 $u$ 是精确解，$Lu=f$ 在 $\\Omega$ 中处处成立。因此我们可以在左侧的稳定化项中用 $f$ 代替 $Lu$：\n$$\n\\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK\n$$\n这正是右侧的稳定化项。由于两边的稳定化项相等，等式 $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$ 成立当且仅当标准伽辽金部分相等：$B(u,v) = F(v)$。\n如本解答第一部分所示，等式 $B(u,v)=F(v)$ 是标准弱形式，它是由强形式 $Lu=f$ 推导出来的。因此，精确解 $u$ 满足 $B(u,v)=F(v)$。\n由于对于精确解，伽辽金项和稳定化项都相等，我们证明了 $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$。GLS 方法是相容的。\n\n**4. 对称性分析**\n\n如果对于函数空间 $V$ 中的所有 $u,v$ 都有 $A(u,v)=A(v,u)$，则双线性形式 $A(u,v)$ 是对称的。我们必须找到使 $B_{\\text{total}}(u,v)$ 对称的关于 $\\beta$ 的充要条件。\n总双线性形式为 $B_{\\text{total}}(u, v) = B(u,v) + S(u,v)$，其中 $S(u,v) = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK$。\n\n首先，我们检验稳定化项 $S(u,v)$ 的对称性。\n$$\nS(u,v) = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK\n$$\n由于标量乘法是可交换的，$(Lu)(Lv) = (Lv)(Lu)$。因此，\n$$\nS(u,v) = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lv)(Lu) \\, dK = S(v,u)\n$$\n稳定化双线性形式 $S(u,v)$ 总是对称的，无论 $\\varepsilon$、$\\beta$、$\\sigma$ 和 $\\tau_K$ 的值如何。\n\n要使总双线性形式 $B_{\\text{total}}(u,v)$ 对称，我们需要 $B_{\\text{total}}(u,v) = B_{\\text{total}}(v,u)$。\n$$\nB(u,v) + S(u,v) = B(v,u) + S(v,u)\n$$\n由于 $S(u,v)=S(v,u)$，该条件简化为要求标准伽辽金双线性形式 $B(u,v)$ 是对称的：\n$$\nB(u,v) = B(v,u)\n$$\n我们来分析 $B(u,v) = \\int_{0}^{1} (\\varepsilon u'v' + \\beta u'v + \\sigma uv) \\, dx$。\n扩散项 $\\int_{0}^{1} \\varepsilon u'v' \\, dx$ 和反应项 $\\int_{0}^{1} \\sigma uv \\, dx$ 显然是对称的。\n对流项是 $A(u,v) = \\int_{0}^{1} \\beta u'v \\, dx$。我们来检验其转置 $A(v,u) = \\int_{0}^{1} \\beta v'u \\, dx$。\n对 $A(v,u)$ 使用分部积分，并回顾 $u,v \\in H_0^1(\\Omega)$ (所以 $u(0)=u(1)=v(0)=v(1)=0$)：\n$$\nA(v,u) = \\int_{0}^{1} \\beta v'u \\, dx = \\left[\\beta vu \\right]_{0}^{1} - \\int_{0}^{1} \\beta v u' \\, dx = 0 - \\int_{0}^{1} \\beta u'v \\, dx = -A(u,v)\n$$\n对流项是反对称的。要使 $B(u,v)$ 对称，其反对称分量必须为零。$B(u,v)$ 唯一的反对称分量是对流项。\n因此，对称性要求 $A(u,v) = -A(u,v)$，这意味着 $2A(u,v)=0$。\n$$\n2 \\beta \\int_{0}^{1} u'v \\, dx = 0 \\quad \\forall u, v \\in V\n$$\n这个条件必须对空间 $V=H_{0}^{1}(\\Omega)$ 中的所有函数 $u,v$ 成立。对于 $u, v \\in V$ 的所有选择，积分 $\\int_{0}^{1} u'v \\, dx$ 并非恒为零。例如，可以构造出使该积分为非零的函数 $u,v \\in V$。\n因此，为了使等式对任意的 $u,v$ 都成立，系数必须为零。\n$B(u,v)$ 对称的充要条件，也即 $B_{\\text{total}}(u,v)$ 对称的充要条件，是 $\\beta=0$。\nGLS 稳定化为双线性形式增加了一个对称部分，但它没有改变来自原始算子对流项的反对称贡献。因此，对称性条件不受稳定化的影响。使总稳定化双线性形式对称的 $\\beta$ 值为 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "2603889"}]}