{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的练习开始。在处理线弹性材料时，一个核心任务是能够计算其在给定变形状态下储存的应变能。这项练习将指导您推导并应用各向同性材料的应变能密度函数 [@problem_id:2687942]，通过一个具体的数值算例，固化您对公式中各项物理意义的理解。", "problem": "一个各向同性、均匀、超弹性固体承受小变形。令小应变张量为对称二阶张量 $\\varepsilon$，其笛卡尔分量为 $\\varepsilon_{ij}$，并令 Cauchy 应力张量为 $\\sigma$。假设以下基本依据：\n- 小应变运动学：$\\varepsilon$ 是位移梯度的对称部分，因此是与 Cauchy 应力张量功共轭的应变度量。\n- 功共轭与超弹性：单位体积的增量内功为 $\\delta w = \\sigma : \\delta \\varepsilon$，且存在一个应变能密度 $\\psi(\\varepsilon)$，使得对于所有容许的增量 $d\\varepsilon$，都有 $d\\psi = \\sigma : d\\varepsilon$。\n- 线性、各向同性、小应变弹性：应力-应变关系是线性的、各向同性的和框架无关的，由 Lamé 参数 $\\lambda$ 和 $\\mu$ 表征。\n\n仅从这些基本依据出发，推导应变能密度 $\\psi(\\varepsilon)$ 的形式（不计一个附加常数），并通过要求 $\\psi(\\varepsilon=\\mathbf{0})=0$ 来确定该常数。然后，根据以下数据计算 $\\psi$ 的值：\n- Lamé 参数：$\\lambda = 60$ GPa 和 $\\mu = 30$ GPa。\n- 应变张量（笛卡尔分量）：\n$$\n\\varepsilon = \n\\begin{pmatrix}\n1.2\\times 10^{-3} & -0.8\\times 10^{-3} & 0.5\\times 10^{-3}\\\\\n-0.8\\times 10^{-3} & -0.4\\times 10^{-3} & 0.9\\times 10^{-3}\\\\\n0.5\\times 10^{-3} & 0.9\\times 10^{-3} & 0.2\\times 10^{-3}\n\\end{pmatrix}.\n$$\n将最终的能量密度以 kJ/m$^{3}$ 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "所述问题在科学上是合理的、自洽的且提法恰当。它提出了一个线性弹性理论中的标准任务，我们现在将为其提供严谨的推导和解答。\n\n目标是推导线性、各向同性、超弹性材料在小应变下的应变能密度函数 $\\psi$，然后针对给定的应变状态进行求值。\n\n我们从线性各向同性弹性材料的基本本构关系开始，该关系将 Cauchy 应力张量 $\\sigma$ 与小应变张量 $\\varepsilon$ 联系起来：\n$$\n\\sigma_{ij} = \\lambda \\varepsilon_{kk} \\delta_{ij} + 2\\mu \\varepsilon_{ij}\n$$\n此处，$\\sigma_{ij}$ 和 $\\varepsilon_{ij}$ 分别是应力张量和应变张量的笛卡尔分量。参数 $\\lambda$ 和 $\\mu$ 是材料的 Lamé 常数。项 $\\varepsilon_{kk}$ 代表应变张量的迹，$\\text{tr}(\\varepsilon)$，而 $\\delta_{ij}$ 是 Kronecker δ。此处隐含了对重复指标的 Einstein 求和约定。这个关系式是从一个对称二阶张量到另一个对称二阶张量的最一般的线性和各向同性映射。\n\n材料被规定为超弹性的，这意味着存在一个标量势函数，即应变能密度 $\\psi(\\varepsilon)$，使得应力张量可以由它导出。单位体积的增量内功 $d\\psi$ 由应力张量与应变张量增量的缩并给出：\n$$\nd\\psi = \\sigma : d\\varepsilon = \\sigma_{ij} d\\varepsilon_{ij}\n$$\n将 $\\sigma_{ij}$ 的本构关系代入 $d\\psi$ 的表达式中，得到：\n$$\nd\\psi = (\\lambda \\varepsilon_{kk} \\delta_{ij} + 2\\mu \\varepsilon_{ij}) d\\varepsilon_{ij}\n$$\n我们分配各项：\n$$\nd\\psi = \\lambda \\varepsilon_{kk} (\\delta_{ij} d\\varepsilon_{ij}) + 2\\mu \\varepsilon_{ij} d\\varepsilon_{ij}\n$$\n第一项可以简化，因为 $\\delta_{ij} d\\varepsilon_{ij} = d\\varepsilon_{ii} = d(\\text{tr}(\\varepsilon))$。令应变第一不变量为 $I_1 = \\text{tr}(\\varepsilon) = \\varepsilon_{kk}$。表达式变为：\n$$\nd\\psi = \\lambda I_1 dI_1 + 2\\mu \\varepsilon_{ij} d\\varepsilon_{ij}\n$$\n这个表达式是一个全微分。我们可以对其积分以求得 $\\psi(\\varepsilon)$。对于超弹性材料，储存的能量与应变路径无关。我们从零应变状态 $\\varepsilon = \\mathbf{0}$ 积分到最终状态 $\\varepsilon$：\n$$\n\\psi(\\varepsilon) - \\psi(\\mathbf{0}) = \\int_{\\mathbf{0}}^{\\varepsilon} d\\psi = \\int_{0}^{I_1} \\lambda I'_1 dI'_1 + \\int_{\\mathbf{0}}^{\\varepsilon} 2\\mu \\varepsilon'_{ij} d\\varepsilon'_{ij}\n$$\n积分是直接的：\n$$\n\\int_{0}^{I_1} \\lambda I'_1 dI'_1 = \\frac{1}{2} \\lambda I_1^2 = \\frac{1}{2} \\lambda (\\text{tr}(\\varepsilon))^2\n$$\n$$\n\\int_{\\mathbf{0}}^{\\varepsilon} 2\\mu \\varepsilon'_{ij} d\\varepsilon'_{ij} = \\mu \\varepsilon_{ij} \\varepsilon_{ij} = \\mu (\\varepsilon : \\varepsilon)\n$$\n因此，应变能密度为：\n$$\n\\psi(\\varepsilon) = \\frac{1}{2} \\lambda (\\text{tr}(\\varepsilon))^2 + \\mu (\\varepsilon : \\varepsilon) + C\n$$\n其中 $C = \\psi(\\mathbf{0})$ 是参考构型中的应变能密度。问题指定了条件 $\\psi(\\varepsilon=\\mathbf{0})=0$，这将积分常数 $C$ 置为零。因此，应变能密度函数的最终形式是：\n$$\n\\psi(\\varepsilon) = \\frac{1}{2} \\lambda (\\text{tr}(\\varepsilon))^2 + \\mu (\\varepsilon : \\varepsilon)\n$$\n\n我们现在使用所提供的数据来计算该函数的值：\n- Lamé 参数：$\\lambda = 60$ GPa, $\\mu = 30$ GPa。\n- 应变张量：\n$$\n\\varepsilon = \n\\begin{pmatrix}\n1.2\\times 10^{-3} & -0.8\\times 10^{-3} & 0.5\\times 10^{-3}\\\\\n-0.8\\times 10^{-3} & -0.4\\times 10^{-3} & 0.9\\times 10^{-3}\\\\\n0.5\\times 10^{-3} & 0.9\\times 10^{-3} & 0.2\\times 10^{-3}\n\\end{pmatrix}\n$$\n首先，我们计算应变张量的迹，$I_1 = \\text{tr}(\\varepsilon)$：\n$$\n\\text{tr}(\\varepsilon) = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33} = (1.2 - 0.4 + 0.2) \\times 10^{-3} = 1.0 \\times 10^{-3}\n$$\n迹的平方则为 $(\\text{tr}(\\varepsilon))^2 = (1.0 \\times 10^{-3})^2 = 1.0 \\times 10^{-6}$。\n\n接下来，我们计算双点积，$\\varepsilon : \\varepsilon = \\varepsilon_{ij} \\varepsilon_{ij} = \\sum_{i,j=1}^{3} \\varepsilon_{ij}^2$。由于应变张量的对称性（$\\varepsilon_{ij} = \\varepsilon_{ji}$），该和为：\n$$\n\\varepsilon : \\varepsilon = \\varepsilon_{11}^2 + \\varepsilon_{22}^2 + \\varepsilon_{33}^2 + 2(\\varepsilon_{12}^2 + \\varepsilon_{13}^2 + \\varepsilon_{23}^2)\n$$\n代入分量值：\n$$\n\\varepsilon : \\varepsilon = \\left[ (1.2)^2 + (-0.4)^2 + (0.2)^2 + 2 \\left( (-0.8)^2 + (0.5)^2 + (0.9)^2 \\right) \\right] \\times (10^{-3})^2\n$$\n$$\n\\varepsilon : \\varepsilon = \\left[ (1.44 + 0.16 + 0.04) + 2 \\left( 0.64 + 0.25 + 0.81 \\right) \\right] \\times 10^{-6}\n$$\n$$\n\\varepsilon : \\varepsilon = \\left[ 1.64 + 2(1.70) \\right] \\times 10^{-6} = (1.64 + 3.40) \\times 10^{-6} = 5.04 \\times 10^{-6}\n$$\n我们现在将这些量代入 $\\psi$ 的表达式中。保持单位一致至关重要。Lamé 参数的单位是 GPa（$10^9$ Pa），而应变是无量纲的。$\\psi$ 的结果单位将是 GPa，这等价于 $10^9$ J/m$^3$。\n$$\n\\psi = \\frac{1}{2} (60 \\text{ GPa}) (1.0 \\times 10^{-6}) + (30 \\text{ GPa}) (5.04 \\times 10^{-6})\n$$\n$$\n\\psi = (30 \\times 10^{-6} + 151.2 \\times 10^{-6}) \\text{ GPa}\n$$\n$$\n\\psi = 181.2 \\times 10^{-6} \\text{ GPa}\n$$\n问题要求答案以 kJ/m$^3$ 为单位。我们使用换算关系 $1$ GPa $= 10^9$ J/m$^3 = 10^6$ kJ/m$^3$：\n$$\n\\psi = (181.2 \\times 10^{-6}) \\times (10^6 \\text{ kJ/m}^3) = 181.2 \\text{ kJ/m}^3\n$$\n值 $181.2$ 有四位有效数字，满足四舍五入的要求。", "answer": "$$\\boxed{181.2}$$", "id": "2687942"}, {"introduction": "并非所有变形对能量的贡献都相同。这项练习将引导您超越单纯的公式计算，深入探究应变能密度函数背后的物理直觉 [@problem_id:2687943]。通过对比两种截然不同的应变状态——纯体积变形和纯剪切变形——您将揭示材料是如何区分并抵抗体积改变与形状扭曲，从而对能量储存做出不同响应的。", "problem": "考虑一个处于无穷小应变状态下的均匀、各向同性、线性弹性固体，其特征由 Lamé 参数 $\\lambda$ 和 $\\mu$ 描述。设小应变张量用 $\\varepsilon$ 表示，Cauchy 应力张量用 $\\sigma$ 表示。单位参考体积的应变能密度是一个标量函数 $\\psi(\\varepsilon)$，它与 $\\sigma$ 和 $\\varepsilon$ 之间的功共轭关系相一致。\n\n给定三维空间中的两种应变状态：\n- 一个纯静水压状态 $\\varepsilon^{(1)} = a\\,\\mathbf{I}$，其中 $a>0$，$\\mathbf{I}$ 是二阶单位张量。\n- 一个无迹偏应变状态 $\\varepsilon^{(2)} = \\operatorname{diag}\\!\\big(\\sqrt{3/2}\\,a,\\,-\\sqrt{3/2}\\,a,\\,0\\big)$。\n\n任务：\n1. 仅从 $\\sigma$ 和 $\\varepsilon$ 之间的线性各向同性本构关系以及定义 $\\psi$ 的能量功共轭要求出发，推导 $\\psi(\\varepsilon)$ 关于 $\\lambda$、$\\mu$、$\\varepsilon:\\varepsilon$ 和 $\\operatorname{tr}\\varepsilon$ 的显式表达式。\n2. 验证 $\\varepsilon^{(1)}:\\varepsilon^{(1)}=\\varepsilon^{(2)}:\\varepsilon^{(2)}$，同时 $\\operatorname{tr}\\varepsilon^{(1)}\\neq \\operatorname{tr}\\varepsilon^{(2)}$。\n3. 使用任务1的结果，计算应变能密度 $\\psi\\big(\\varepsilon^{(1)}\\big)$ 和 $\\psi\\big(\\varepsilon^{(2)}\\big)$，然后计算比值 $R=\\dfrac{\\psi\\big(\\varepsilon^{(1)}\\big)}{\\psi\\big(\\varepsilon^{(2)}\\big)}$。将 $R$ 表示为仅含 $\\lambda$ 和 $\\mu$ 的闭式解析表达式（即振幅 $a$ 必须被消去）。\n4. 根据 $\\psi$ 的体积和偏量贡献，简要解释为何这两种状态尽管具有相同的 $\\varepsilon:\\varepsilon$ 值，却有不同的能量密度。\n\n你的最终答案必须是 $R$ 的单个表达式。不需要进行数值取整，且由于 $R$ 是无量纲的，因此不需要单位。", "solution": "所述问题在连续介质力学和线性弹性的既定框架内具有科学依据、内容自洽且提法适定。所有提供的信息都是一致且充分的，足以得到唯一解。我们将直接开始执行所需任务。\n\n任务1：应变能密度函数 $\\psi(\\varepsilon)$ 的推导。\n应变能密度 $\\psi$ 是 Cauchy 应力张量 $\\sigma$ 的一个标量势，使得本构关系由功共轭要求 $\\sigma = \\frac{\\partial\\psi}{\\partial\\varepsilon}$ 给出。用指标记法表示为 $\\sigma_{ij} = \\frac{\\partial\\psi}{\\partial\\varepsilon_{ij}}$。对于均匀、各向同性、线性弹性材料，其本构关系（也称为 Hooke 定律）为：\n$$\n\\sigma_{ij} = \\lambda (\\operatorname{tr}\\varepsilon) \\delta_{ij} + 2\\mu\\varepsilon_{ij}\n$$\n其中 $\\operatorname{tr}(\\varepsilon) = \\varepsilon_{kk}$ 是应变张量 $\\varepsilon$ 的迹，$\\delta_{ij}$ 是 Kronecker delta。\n\n对于各向同性材料，标量函数 $\\psi$ 只能是其自变量（张量 $\\varepsilon$）的标量不变量的函数。对于适用于线性弹性的二次势，$\\psi$ 可以由 $\\varepsilon$ 的第一和第二基本不变量构造，我们选择它们为 $(\\operatorname{tr}\\varepsilon)$ 和 $(\\varepsilon:\\varepsilon) = \\varepsilon_{ij}\\varepsilon_{ij}$。因此，$\\psi$ 最一般的二次形式为：\n$$\n\\psi(\\varepsilon) = A (\\operatorname{tr}\\varepsilon)^2 + B (\\varepsilon:\\varepsilon)\n$$\n其中 $A$ 和 $B$ 是待定的材料常数。我们计算此表达式关于应变张量分量 $\\varepsilon_{ij}$ 的导数：\n$$\n\\frac{\\partial\\psi}{\\partial\\varepsilon_{ij}} = \\frac{\\partial}{\\partial\\varepsilon_{ij}} \\left( A (\\varepsilon_{kk})^2 + B (\\varepsilon_{kl}\\varepsilon_{kl}) \\right)\n$$\n使用不变量导数的恒等式 $\\frac{\\partial\\varepsilon_{kk}}{\\partial\\varepsilon_{ij}} = \\delta_{ij}$ 和 $\\frac{\\partial(\\varepsilon_{kl}\\varepsilon_{kl})}{\\partial\\varepsilon_{ij}} = 2\\varepsilon_{ij}$，我们得到：\n$$\n\\frac{\\partial\\psi}{\\partial\\varepsilon_{ij}} = A \\cdot 2(\\varepsilon_{kk}) \\frac{\\partial\\varepsilon_{kk}}{\\partial\\varepsilon_{ij}} + B \\frac{\\partial(\\varepsilon_{kl}\\varepsilon_{kl})}{\\partial\\varepsilon_{ij}} = 2A (\\operatorname{tr}\\varepsilon) \\delta_{ij} + 2B \\varepsilon_{ij}\n$$\n将此结果与已知的 $\\sigma_{ij}$ 本构关系相等，我们有：\n$$\n2A (\\operatorname{tr}\\varepsilon) \\delta_{ij} + 2B \\varepsilon_{ij} = \\lambda (\\operatorname{tr}\\varepsilon) \\delta_{ij} + 2\\mu\\varepsilon_{ij}\n$$\n匹配独立张量项 $(\\operatorname{tr}\\varepsilon)\\delta_{ij}$ 和 $\\varepsilon_{ij}$ 的系数，可得出常数 $A$ 和 $B$ 的值：\n$$\n2A = \\lambda \\implies A = \\frac{\\lambda}{2}\n$$\n$$\n2B = 2\\mu \\implies B = \\mu\n$$\n将这些常数代入我们关于 $\\psi$ 的表达式中，即可得到应变能密度函数的显式形式：\n$$\n\\psi(\\varepsilon) = \\frac{\\lambda}{2}(\\operatorname{tr}\\varepsilon)^2 + \\mu(\\varepsilon:\\varepsilon)\n$$\n\n任务2：验证 $\\varepsilon^{(1)}$ 和 $\\varepsilon^{(2)}$ 的性质。\n首先，考虑纯静水压状态 $\\varepsilon^{(1)} = a\\,\\mathbf{I}$。其分量形式为 $\\varepsilon^{(1)}_{ij} = a\\delta_{ij}$。\n该张量的迹为：\n$$\n\\operatorname{tr}\\varepsilon^{(1)} = \\varepsilon^{(1)}_{kk} = a\\delta_{kk} = a(1+1+1) = 3a\n$$\n该张量与其自身的内积为：\n$$\n\\varepsilon^{(1)}:\\varepsilon^{(1)} = \\varepsilon^{(1)}_{ij}\\varepsilon^{(1)}_{ij} = (a\\delta_{ij})(a\\delta_{ij}) = a^2\\delta_{ij}\\delta_{ij} = a^2\\delta_{ii} = a^2(1+1+1) = 3a^2\n$$\n其次，考虑无迹偏应变状态 $\\varepsilon^{(2)} = \\operatorname{diag}\\!\\big(\\sqrt{3/2}\\,a,\\,-\\sqrt{3/2}\\,a,\\,0\\big)$。\n该张量的迹为：\n$$\n\\operatorname{tr}\\varepsilon^{(2)} = \\sqrt{\\frac{3}{2}}\\,a - \\sqrt{\\frac{3}{2}}\\,a + 0 = 0\n$$\n该张量与其自身的内积是其分量的平方和：\n$$\n\\varepsilon^{(2)}:\\varepsilon^{(2)} = \\sum_{i,j=1}^3 (\\varepsilon^{(2)}_{ij})^2 = \\left(\\sqrt{\\frac{3}{2}}\\,a\\right)^2 + \\left(-\\sqrt{\\frac{3}{2}}\\,a\\right)^2 + 0^2 = \\frac{3}{2}a^2 + \\frac{3}{2}a^2 = 3a^2\n$$\n通过直接比较，我们验证了 $\\varepsilon^{(1)}:\\varepsilon^{(1)} = 3a^2 = \\varepsilon^{(2)}:\\varepsilon^{(2)}$，并且由于 $a>0$，我们还验证了 $\\operatorname{tr}\\varepsilon^{(1)} = 3a \\neq 0 = \\operatorname{tr}\\varepsilon^{(2)}$。\n\n任务3：能量比 $R$ 的计算。\n使用任务1中推导出的 $\\psi(\\varepsilon)$ 表达式和任务2中计算出的不变量，我们现在求每种状态下的应变能密度。\n对于状态 $\\varepsilon^{(1)}$：\n$$\n\\psi\\big(\\varepsilon^{(1)}\\big) = \\frac{\\lambda}{2}(\\operatorname{tr}\\varepsilon^{(1)})^2 + \\mu(\\varepsilon^{(1)}:\\varepsilon^{(1)}) = \\frac{\\lambda}{2}(3a)^2 + \\mu(3a^2) = \\frac{9\\lambda a^2}{2} + 3\\mu a^2 = a^2\\left(\\frac{9\\lambda}{2} + 3\\mu\\right)\n$$\n对于状态 $\\varepsilon^{(2)}$：\n$$\n\\psi\\big(\\varepsilon^{(2)}\\big) = \\frac{\\lambda}{2}(\\operatorname{tr}\\varepsilon^{(2)})^2 + \\mu(\\varepsilon^{(2)}:\\varepsilon^{(2)}) = \\frac{\\lambda}{2}(0)^2 + \\mu(3a^2) = 3\\mu a^2\n$$\n比值 $R$ 计算如下：\n$$\nR = \\frac{\\psi\\big(\\varepsilon^{(1)}\\big)}{\\psi\\big(\\varepsilon^{(2)}\\big)} = \\frac{a^2\\left(\\frac{9\\lambda}{2} + 3\\mu\\right)}{3\\mu a^2}\n$$\n振幅因子 $a^2$ 按要求被消去，得到一个仅用 Lamé 参数表示的闭式表达式：\n$$\nR = \\frac{\\frac{9\\lambda}{2} + 3\\mu}{3\\mu} = \\frac{9\\lambda}{6\\mu} + \\frac{3\\mu}{3\\mu} = \\frac{3\\lambda}{2\\mu} + 1\n$$\n\n任务4：关于能量差异的物理解释。\n应变能密度 $\\psi$ 可以迭加分解为一个由体积变化（体积）引起的部分和一个由形状变化（偏量或畸变）引起的部分。这对应于应变张量 $\\varepsilon$ 分解为其体积部分 $\\varepsilon_v = \\frac{1}{3}(\\operatorname{tr}\\varepsilon)\\mathbf{I}$ 和其偏量部分 $\\varepsilon_d = \\varepsilon - \\varepsilon_v$。应变能密度于是可以表示为：\n$$\n\\psi(\\varepsilon) = \\frac{1}{2}K(\\operatorname{tr}\\varepsilon)^2 + \\mu(\\varepsilon_d:\\varepsilon_d) = \\psi_v + \\psi_d\n$$\n此处，$K = \\lambda + \\frac{2}{3}\\mu$ 是体积模量，它量化了对体积变化的抵抗能力；$\\mu$ 是剪切模量，它量化了对形状变化的抵抗能力。\n\n应变状态 $\\varepsilon^{(1)} = a\\,\\mathbf{I}$ 是纯体积性的；其偏量部分为零，即 $\\varepsilon^{(1)}_d = a\\mathbf{I} - \\frac{1}{3}(3a)\\mathbf{I} = 0$。因此，其应变能是纯体积性的：$\\psi\\big(\\varepsilon^{(1)}\\big) = \\psi_v = \\frac{1}{2}K(3a)^2$。\n相反，应变状态 $\\varepsilon^{(2)}$ 是纯偏量性的；其迹为零，这意味着其体积部分为零，即 $\\varepsilon^{(2)}_v=0$。因此，其应变能是纯偏量性的：$\\psi\\big(\\varepsilon^{(2)}\\big) = \\psi_d = \\mu(\\varepsilon^{(2)}_d:\\varepsilon^{(2)}_d) = \\mu(\\varepsilon^{(2)}:\\varepsilon^{(2)})$。\n\n尽管两种状态具有相同的 Frobenius 范数的平方，即 $\\varepsilon^{(1)}:\\varepsilon^{(1)} = \\varepsilon^{(2)}:\\varepsilon^{(2)} = 3a^2$，但这个量被不同地分配。对于 $\\varepsilon^{(1)}$，该范数完全来自于体积部分（$\\varepsilon^{(1)}:\\varepsilon^{(1)} = \\varepsilon^{(1)}_v:\\varepsilon^{(1)}_v$）。对于 $\\varepsilon^{(2)}$，它完全来自于偏量部分（$\\varepsilon^{(2)}:\\varepsilon^{(2)} = \\varepsilon^{(2)}_d:\\varepsilon^{(2)}_d$）。不同的能量密度反映了这样一个事实：材料以不同的刚度（分别由 $K$ 和 $\\mu$ 表征）来抵抗体积变化和形状变化。一个纯体积变形和一个纯偏量变形，即使具有相同的“大小”（在 Frobenius 范数的意义上），也会储存不同量的能量，因为它们调用了材料内部不同的物理抵抗机制，而这些机制的能量成本通常是不相等的。", "answer": "$$\n\\boxed{\\frac{3\\lambda}{2\\mu} + 1}\n$$", "id": "2687943"}, {"introduction": "我们如何从实验测量中确定材料的内在对称性？最后一个练习将理论与实际应用相结合，挑战您扮演材料科学家的角色 [@problem_id:2687993]。您将利用应变能密度函数在对称变换下的不变性这一基本原理，通过编写程序从一组离散的“实验”数据中推断出材料的对称类别。", "problem": "给定一个线性弹性固体在小应变情况下的离散弹性应变能密度函数测量值。在小应变范畴内，应变张量为 $ \\varepsilon \\in \\mathbb{R}^{3 \\times 3} $，且满足 $ \\varepsilon = \\varepsilon^{\\mathsf{T}} $。对于一种固定材料，其应变能密度函数是一个二次型 $ \\psi(\\varepsilon) $，可以写作 $ \\psi(\\varepsilon) = \\tfrac{1}{2} \\, \\varepsilon : \\mathbb{C} : \\varepsilon $，其中 $ \\mathbb{C} $ 是一个具有标准次对称性的四阶刚度张量。材料对称性对应于一个旋转 $ \\mathbf{Q} \\in \\mathrm{SO}(3) $，在该旋转下，对于所有 $ \\varepsilon $，均满足 $ \\psi(\\varepsilon) = \\psi(\\mathbf{Q} \\, \\varepsilon \\, \\mathbf{Q}^{\\mathsf{T}}) $。材料类别及其对称群如下：\n- 各向同性：在所有 $ \\mathbf{Q} \\in \\mathrm{SO}(3) $ 旋转下保持不变。\n- 横观各向同性：在围绕某一固定轴的所有旋转下保持不变（$ \\mathrm{SO}(3) $ 的一个无限子群）。\n- 正交各向异性：至少在围绕三个相互正交轴旋转 $ \\pi $ 角时保持不变。\n\n你的任务是实现一个程序，根据给定的应变状态和相应测量能量密度的列表配对 $ \\{ (\\varepsilon^{(k)}, \\psi^{(k)}) \\}_{k=1}^N $，判断该材料是各向同性、横观各向同性、正交各向异性，还是根据给定数据无法确定。该决策必须通过直接测试 $ \\psi $ 在一组有限的诊断旋转下的不变性属性来做出，且仅当旋转后的应变状态也出现在提供的数据集中时才进行测试。具体来说：\n- 各向同性测试：要求在集合 $ \\{ \\mathbf{R}_x(\\pi/2), \\mathbf{R}_y(\\pi/2), \\mathbf{R}_z(\\pi/2) \\} $ 下保持不变。对于此集合中的每次旋转 $ \\mathbf{Q} $，对于每个 $ \\varepsilon^{(k)} $，如果其旋转后的对应项 $ \\mathbf{Q} \\, \\varepsilon^{(k)} \\, \\mathbf{Q}^{\\mathsf{T}} $ 出现在给定的应变中且不与 $ \\varepsilon^{(k)} $ 相同，则相应的测量能量必须在规定的容差范围内匹配。此外，对于这三个 $ \\pi/2 $ 旋转中的每一个，都必须至少存在一个这样的非平凡匹配对。\n- 横观各向同性测试：对于每个轴 $ \\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z $，要求在绕该轴旋转 $ \\mathbf{R}_\\alpha(\\pi/2) $（其中 $ \\alpha \\in \\{x,y,z\\} $）时保持不变，其意义与上文相同，且至少有一个轴存在至少两个不同的非平凡匹配对。此测试仅在各向同性测试失败时应用。\n- 正交各向异性测试：要求在 $ \\{ \\mathbf{R}_x(\\pi), \\mathbf{R}_y(\\pi), \\mathbf{R}_z(\\pi) \\} $ 旋转下保持不变，且三个轴中的每一个都至少存在一个不同的非平凡匹配对。此测试仅在各向同性和横观各向同性测试均失败时应用。\n- 如果根据可用数据无法通过上述任何测试，则返回“无法得出结论”。\n\n比较匹配对的测量能量时，使用绝对容差 $ \\delta = 10^{-9} $。如果 $ \\mathbf{Q} \\, \\varepsilon^{(k)} \\, \\mathbf{Q}^{\\mathsf{T}} \\neq \\varepsilon^{(k)} $，则该匹配对是“非平凡”的。\n\n程序必须为以下四个数据集实现这些测试。在每个数据集中，应变以 $ 3 \\times 3 $ 对称矩阵的形式明确给出（为简洁起见，在明确的情况下省略了零），测量的能量密度 $ \\psi $ 以实数形式给出。这些数据集的构建旨在使其对于线性弹性是物理上合理的，并用于检验分类逻辑。\n\n数据集 $ A $（意在为各向同性；Lamé 参数 $ \\lambda = 2 $，$ \\mu = 3 $；能量 $ \\psi(\\varepsilon) = \\tfrac{1}{2} \\lambda (\\mathrm{tr}\\,\\varepsilon)^2 + \\mu \\, \\varepsilon : \\varepsilon $）：\n- $ \\varepsilon^{(1)} = \\mathrm{diag}(1,0,0) $，$ \\psi^{(1)} = 4 $。\n- $ \\varepsilon^{(2)} = \\mathrm{diag}(0,1,0) $，$ \\psi^{(2)} = 4 $。\n- $ \\varepsilon^{(3)} = \\mathrm{diag}(0,0,1) $，$ \\psi^{(3)} = 4 $。\n- $ \\varepsilon^{(4)} $ 其中 $ \\varepsilon_{12} = \\varepsilon_{21} = 0.5 $，$ \\psi^{(4)} = 1.5 $。\n- $ \\varepsilon^{(5)} $ 其中 $ \\varepsilon_{12} = \\varepsilon_{21} = -0.5 $，$ \\psi^{(5)} = 1.5 $。\n- $ \\varepsilon^{(6)} $ 其中 $ \\varepsilon_{23} = \\varepsilon_{32} = 0.5 $，$ \\psi^{(6)} = 1.5 $。\n- $ \\varepsilon^{(7)} $ 其中 $ \\varepsilon_{13} = \\varepsilon_{31} = 0.5 $，$ \\psi^{(7)} = 1.5 $。\n\n数据集 $ B $（意在为绕 $ z $ 轴横观各向同性；能量 $ \\psi(\\varepsilon) = B (\\varepsilon_{11}^2 + \\varepsilon_{22}^2 + 2 \\varepsilon_{12}^2) + C \\varepsilon_{33}^2 + D (\\varepsilon_{13}^2 + \\varepsilon_{23}^2) + E (\\varepsilon_{11} + \\varepsilon_{22}) \\varepsilon_{33} $，其中 $ B = 3 $，$ C = 5 $，$ D = 2 $，$ E = 1 $）：\n- $ \\varepsilon^{(1)} = \\mathrm{diag}(1,0,0) $，$ \\psi^{(1)} = 3 $。\n- $ \\varepsilon^{(2)} = \\mathrm{diag}(0,1,0) $，$ \\psi^{(2)} = 3 $。\n- $ \\varepsilon^{(3)} = \\mathrm{diag}(0,0,1) $，$ \\psi^{(3)} = 5 $。\n- $ \\varepsilon^{(4)} $ 其中 $ \\varepsilon_{12} = \\varepsilon_{21} = 0.5 $，$ \\psi^{(4)} = 1.5 $。\n- $ \\varepsilon^{(5)} $ 其中 $ \\varepsilon_{12} = \\varepsilon_{21} = -0.5 $，$ \\psi^{(5)} = 1.5 $。\n- $ \\varepsilon^{(6)} $ 其中 $ \\varepsilon_{13} = \\varepsilon_{31} = 0.5 $，$ \\psi^{(6)} = 0.5 $。\n- $ \\varepsilon^{(7)} $ 其中 $ \\varepsilon_{23} = \\varepsilon_{32} = 0.5 $，$ \\psi^{(7)} = 0.5 $。\n- $ \\varepsilon^{(8)} = \\mathrm{diag}(1,1,0) $，$ \\psi^{(8)} = 6 $。\n- $ \\varepsilon^{(9)} = \\mathrm{diag}(1,0,1) $，$ \\psi^{(9)} = 9 $。\n- $ \\varepsilon^{(10)} = \\mathrm{diag}(0,1,1) $，$ \\psi^{(10)} = 9 $。\n\n数据集 $ C $（意在为正交各向异性，主轴与 $ x,y,z $ 轴对齐；能量 $ \\psi(\\varepsilon) = a \\varepsilon_{11}^2 + b \\varepsilon_{22}^2 + c \\varepsilon_{33}^2 + d \\varepsilon_{12}^2 + e \\varepsilon_{13}^2 + f \\varepsilon_{23}^2 + g \\varepsilon_{11} \\varepsilon_{22} + h \\varepsilon_{11} \\varepsilon_{33} + k \\varepsilon_{22} \\varepsilon_{33} $，其中 $ a = 2 $，$ b = 3 $，$ c = 4 $，$ d = 5 $，$ e = 6 $，$ f = 7 $，$ g = 1 $，$ h = 0.5 $，$ k = 0.25 $）：\n- $ \\varepsilon^{(1)} = \\mathrm{diag}(1,0,0) $，$ \\psi^{(1)} = 2 $。\n- $ \\varepsilon^{(2)} = \\mathrm{diag}(0,1,0) $，$ \\psi^{(2)} = 3 $。\n- $ \\varepsilon^{(3)} = \\mathrm{diag}(0,0,1) $，$ \\psi^{(3)} = 4 $。\n- $ \\varepsilon^{(4)} $ 其中 $ \\varepsilon_{12} = \\varepsilon_{21} = 0.5 $，$ \\psi^{(4)} = 1.25 $。\n- $ \\varepsilon^{(5)} $ 其中 $ \\varepsilon_{12} = \\varepsilon_{21} = -0.5 $，$ \\psi^{(5)} = 1.25 $。\n- $ \\varepsilon^{(6)} $ 其中 $ \\varepsilon_{13} = \\varepsilon_{31} = 0.5 $，$ \\psi^{(6)} = 1.5 $。\n- $ \\varepsilon^{(7)} $ 其中 $ \\varepsilon_{13} = \\varepsilon_{31} = -0.5 $，$ \\psi^{(7)} = 1.5 $。\n- $ \\varepsilon^{(8)} $ 其中 $ \\varepsilon_{23} = \\varepsilon_{32} = 0.5 $，$ \\psi^{(8)} = 1.75 $。\n- $ \\varepsilon^{(9)} $ 其中 $ \\varepsilon_{23} = \\varepsilon_{32} = -0.5 $，$ \\psi^{(9)} = 1.75 $。\n- $ \\varepsilon^{(10)} = \\mathrm{diag}(1,1,0) $，$ \\psi^{(10)} = 6 $。\n- $ \\varepsilon^{(11)} = \\mathrm{diag}(1,0,1) $，$ \\psi^{(11)} = 6.5 $。\n- $ \\varepsilon^{(12)} = \\mathrm{diag}(0,1,1) $，$ \\psi^{(12)} = 7.25 $。\n\n数据集 $ D $（数据不足以分类）：\n- $ \\varepsilon^{(1)} = \\mathrm{diag}(1,0,0) $，$ \\psi^{(1)} = 0.7 $。\n\n分类代码：\n- 如果是各向同性，输出 $ 0 $。\n- 如果是横观各向同性（但非各向同性），输出 $ 1 $。\n- 如果是正交各向异性（但既非各向同性也非横观各向同性），输出 $ 2 $。\n- 如果根据所提供的数据无法得出结论，输出 $ 3 $。\n\n最终输出格式：你的程序应生成单行输出，其中包含四个数据集的结果，形式为方括号括起的逗号分隔的整数列表（例如，$ [r_1,r_2,r_3,r_4] $）。\n\n角度单位为弧度。输出不需要物理单位，因为它是一个无量纲的分类代码。比较匹配对应能量时，使用绝对容差 $ \\delta = 10^{-9} $。", "solution": "该问题要求基于一组离散的测量应变能密度，将一种线性弹性材料分为四类之一——各向同性、横观各向同性、正交各向异性或无法得出结论。分类将通过在特定旋转下测试应变能密度函数 $ \\psi(\\varepsilon) $ 的不变性来进行，并且仅使用所提供的数据点。\n\n基本原理是材料对称性。如果当材料受到旋转 $ \\mathbf{Q} \\in \\mathrm{SO}(3) $ 时，其应变能密度保持不变，则该材料具有此旋转所描述的对称性。对于一个应变张量 $ \\varepsilon $，旋转后的应变张量由 $ \\varepsilon' = \\mathbf{Q} \\, \\varepsilon \\, \\mathbf{Q}^{\\mathsf{T}} $ 给出。因此，不变性条件为 $ \\psi(\\varepsilon) = \\psi(\\varepsilon') $。问题提供了一组离散的测量值 $ \\{ (\\varepsilon^{(k)}, \\psi^{(k)}) \\}_{k=1}^N $，并要求对一组有限的诊断旋转验证此不变性属性。\n\n总体方法是实现一个分层分类算法，该算法依次测试各向同性、然后是横观各向同性，最后是正交各向异性。如果通过了某项测试，则指定相应的分类。如果所有测试都失败，则结果为无法得出结论。\n\n首先，我们定义测试所需的旋转矩阵。旋转是围绕笛卡尔坐标轴 $ \\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z $进行的。\n绕 x 轴旋转角度 $ \\theta $ 的旋转矩阵是 $ \\mathbf{R}_x(\\theta) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos\\theta & -\\sin\\theta \\\\ 0 & \\sin\\theta & \\cos\\theta \\end{pmatrix} $。\n类似地，对于 y 轴，$ \\mathbf{R}_y(\\theta) = \\begin{pmatrix} \\cos\\theta & 0 & \\sin\\theta \\\\ 0 & 1 & 0 \\\\ -\\sin\\theta & 0 & \\cos\\theta \\end{pmatrix} $，对于 z 轴，$ \\mathbf{R}_z(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta & 0 \\\\ \\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $。\n\n对于各向同性和横观各向同性测试，我们需要旋转 $ \\theta = \\pi/2 $：\n$ \\mathbf{R}_x(\\pi/2) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & -1 \\\\ 0 & 1 & 0 \\end{pmatrix} $，$ \\mathbf{R}_y(\\pi/2) = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & 0 \\\\ -1 & 0 & 0 \\end{pmatrix} $，$ \\mathbf{R}_z(\\pi/2) = \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $。\n\n对于正交各向异性测试，我们需要旋转 $ \\theta = \\pi $：\n$ \\mathbf{R}_x(\\pi) = \\mathrm{diag}(1, -1, -1) $，$ \\mathbf{R}_y(\\pi) = \\mathrm{diag}(-1, 1, -1) $，$ \\mathbf{R}_z(\\pi) = \\mathrm{diag}(-1, -1, 1) $。\n\n算法的核心是一个函数，对于给定的旋转 $ \\mathbf{Q} $，它会遍历数据集中的所有可用应变张量 $ \\varepsilon^{(k)} $。对于每个 $ \\varepsilon^{(k)} $，它计算旋转后的应变 $ \\varepsilon' = \\mathbf{Q} \\, \\varepsilon^{(k)} \\, \\mathbf{Q}^{\\mathsf{T}} $。然后在数据集的应变列表中搜索 $ \\varepsilon' $。如果在某个索引 $ l $ 处找到了 $ \\varepsilon' $，则执行检查。\n1.  **违规检查**：如果找到了 $ \\varepsilon^{(l)} $，能量必须匹配。如果 $ |\\psi^{(l)} - \\psi^{(k)}| > \\delta $（其中 $ \\delta = 10^{-9} $ 是规定的容差），则发生对称性违规。对于给定的对称群测试，只要存在一个这样的违规，就意味着材料不属于该对称类别。\n2.  **非平凡匹配对计数**：如果能量匹配且旋转后的应变与原始应变不同（$ \\varepsilon' \\neq \\varepsilon^{(k)} $，或更准确地说，$ l \\neq k $），这就构成了一个“非平凡匹配对”。我们计算此类不同配对的数量，用索引集合 $ \\{k, l\\} $ 表示，以避免重复计数。\n\n分类逻辑如下：\n\n**1. 各向同性测试 (代码 $0$)**：\n-   测试旋转：$ \\{ \\mathbf{R}_x(\\pi/2), \\mathbf{R}_y(\\pi/2), \\mathbf{R}_z(\\pi/2) \\} $。\n-   条件：如果对于这组旋转，没有违规情况，并且 $3$ 个旋转中的**每一个**都至少有 $1$ 个不同的非平凡匹配对，则该材料被分类为各向同性。\n-   如果满足这些条件，则分类为各向同性（代码 $0$），并终止对此数据集的处理。\n\n**2. 横观各向同性测试 (代码 $1$)**：\n-   此测试仅在各向同性测试失败时执行。\n-   它分别检查关于三个轴 $ \\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z $ 中每一个的对称性。\n-   对于每个轴，测试旋转是相应的 $ \\pi/2 $ 旋转。例如，对于 $ \\mathbf{e}_z $ 轴，测试旋转是 $ \\mathbf{R}_z(\\pi/2) $。\n-   条件：如果对于三个轴中的**至少一个**，在相应的 $ \\pi/2 $ 旋转下没有违规，并且至少有 $2$ 个不同的非平凡匹配对，则该材料被分类为横观各向同性。\n-   如果任何一个轴满足此条件，则分类为横观各向同性（代码 $1$），并终止处理。\n\n**3. 正交各向异性测试 (代码 $2$)**：\n-   此测试仅在各向同性和横观各向同性测试均失败时执行。\n-   测试旋转：$ \\{ \\mathbf{R}_x(\\pi), \\mathbf{R}_y(\\pi), \\mathbf{R}_z(\\pi) \\} $。\n-   条件：如果对于这组旋转，没有违规情况，并且 $3$ 个旋转中的**每一个**都至少有 $1$ 个不同的非平凡匹配对，则该材料被分类为正交各向异性。\n-   如果满足这些条件，则分类为正交各向异性（代码 $2$）。\n\n**4. 无法得出结论 (代码 $3$)**：\n-   如果上述测试均未通过，则给定数据不足以根据指定规则进行分类。结果为无法得出结论（代码 $3$）。\n\n为提供的四个数据集中的每一个都实现了这种顺序和分层的测试程序。为了进行数据管理，应变张量 $ \\varepsilon^{(k)} $ 存储为 NumPy 数组。通过遍历列表并使用 `numpy.allclose` 进行鲁棒的浮点矩阵比较，来在现有应变列表中搜索旋转后的应变。\n数据集的预期结果如下：\n-   **数据集 A**：通过各向同性测试。分类：$0$。\n-   **数据集 B**：由于能量不匹配而未通过各向同性测试，但通过了关于 $z$ 轴的横观各向同性测试。分类：$1$。\n-   **数据集 C**：由于能量不匹配而未通过各向同性和横观各向同性测试，但通过了正交各向异性测试。分类：$2$。\n-   **数据集 D**：未通过所有测试，因为它只包含一个数据点，无法形成任何非平凡匹配对。分类：$3$。\n\n最终程序将以整数列表的形式输出这些分类代码。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process all datasets and print the final results.\n    \"\"\"\n    \n    # Define rotation matrices\n    # Rotations by pi/2\n    R_x_90 = np.array([[1, 0, 0], [0, 0, -1], [0, 1, 0]])\n    R_y_90 = np.array([[0, 0, 1], [0, 1, 0], [-1, 0, 0]])\n    R_z_90 = np.array([[0, -1, 0], [1, 0, 0], [0, 0, 1]])\n    rots_90 = [R_x_90, R_y_90, R_z_90]\n\n    # Rotations by pi\n    R_x_180 = np.array([[1, 0, 0], [0, -1, 0], [0, 0, -1]])\n    R_y_180 = np.array([[-1, 0, 0], [0, 1, 0], [0, 0, -1]])\n    R_z_180 = np.array([[-1, 0, 0], [0, -1, 0], [0, 0, 1]])\n    rots_180 = [R_x_180, R_y_180, R_z_180]\n\n    # --- Datasets Definition ---\n\n    # Dataset A\n    strains_A = [\n        np.array([[1, 0, 0], [0, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, 0], [0, 1, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, 0], [0, 0, 0], [0, 0, 1]], dtype=float),\n        np.array([[0, 0.5, 0], [0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, -0.5, 0], [-0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, 0], [0, 0, 0.5], [0, 0.5, 0]], dtype=float),\n        np.array([[0, 0, 0.5], [0, 0, 0], [0.5, 0, 0]], dtype=float),\n    ]\n    energies_A = [4.0, 4.0, 4.0, 1.5, 1.5, 1.5, 1.5]\n    dataset_A = (strains_A, energies_A)\n    \n    # Dataset B\n    strains_B = [\n        np.diag([1, 0, 0]).astype(float),\n        np.diag([0, 1, 0]).astype(float),\n        np.diag([0, 0, 1]).astype(float),\n        np.array([[0, 0.5, 0], [0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, -0.5, 0], [-0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, 0.5], [0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, 0], [0, 0, 0.5], [0, 0.5, 0]], dtype=float),\n        np.diag([1, 1, 0]).astype(float),\n        np.diag([1, 0, 1]).astype(float),\n        np.diag([0, 1, 1]).astype(float),\n    ]\n    energies_B = [3.0, 3.0, 5.0, 1.5, 1.5, 0.5, 0.5, 6.0, 9.0, 9.0]\n    dataset_B = (strains_B, energies_B)\n\n    # Dataset C\n    strains_C = [\n        np.diag([1, 0, 0]).astype(float),\n        np.diag([0, 1, 0]).astype(float),\n        np.diag([0, 0, 1]).astype(float),\n        np.array([[0, 0.5, 0], [0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, -0.5, 0], [-0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, 0.5], [0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, -0.5], [-0.5, 0, 0], [0, 0, 0]], dtype=float),\n        np.array([[0, 0, 0], [0, 0, 0.5], [0, 0.5, 0]], dtype=float),\n        np.array([[0, 0, 0], [0, 0, -0.5], [0, -0.5, 0]], dtype=float),\n        np.diag([1, 1, 0]).astype(float),\n        np.diag([1, 0, 1]).astype(float),\n        np.diag([0, 1, 1]).astype(float),\n    ]\n    energies_C = [2.0, 3.0, 4.0, 1.25, 1.25, 1.5, 1.5, 1.75, 1.75, 6.0, 6.5, 7.25]\n    dataset_C = (strains_C, energies_C)\n\n    # Dataset D\n    strains_D = [np.diag([1, 0, 0]).astype(float)]\n    energies_D = [0.7]\n    dataset_D = (strains_D, energies_D)\n\n    all_datasets = [dataset_A, dataset_B, dataset_C, dataset_D]\n    \n    results = [classify_material(ds, rots_90, rots_180) for ds in all_datasets]\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\ndef find_strain_index(strain_to_find, all_strains, abs_tol=1e-9):\n    \"\"\"\n    Finds the index of a strain tensor in a list of strains.\n    Returns the index or None if not found.\n    \"\"\"\n    for i, strain in enumerate(all_strains):\n        if np.allclose(strain_to_find, strain, atol=abs_tol):\n            return i\n    return None\n\ndef check_invariance(strains, energies, rotations, energy_tol=1e-9):\n    \"\"\"\n    Checks for symmetry violations and counts nontrivial pairs for a set of rotations.\n    Returns a tuple: (has_violation, list_of_pair_counts).\n    \"\"\"\n    num_violations = 0\n    pairs_per_rotation = [set() for _ in rotations]\n\n    for k, eps_k in enumerate(strains):\n        for rot_idx, Q in enumerate(rotations):\n            eps_prime = Q @ eps_k @ Q.T\n            l = find_strain_index(eps_prime, strains)\n            \n            if l is not None:\n                if abs(energies[l] - energies[k]) > energy_tol:\n                    num_violations += 1\n                elif k != l:\n                    # Found a nontrivial matched pair.\n                    # Use frozenset to count unique pairs {k, l}.\n                    pairs_per_rotation[rot_idx].add(frozenset([k, l]))\n\n    has_violation = num_violations > 0\n    pair_counts = [len(s) for s in pairs_per_rotation]\n    return has_violation, pair_counts\n\ndef classify_material(dataset, rots_90, rots_180):\n    \"\"\"\n    Classifies the material based on the provided dataset and rotation matrices.\n    \"\"\"\n    strains, energies = dataset\n\n    # 1. Isotropy Test\n    has_violation_iso, pairs_iso = check_invariance(strains, energies, rots_90)\n    if not has_violation_iso and all(p >= 1 for p in pairs_iso):\n        return 0  # Isotropic\n\n    # 2. Transverse Isotropy Test\n    is_ti = False\n    for i in range(3):\n        # Test each axis individually\n        has_violation_ti, pairs_ti = check_invariance(strains, energies, [rots_90[i]])\n        if not has_violation_ti and pairs_ti[0] >= 2:\n            is_ti = True\n            break\n    if is_ti:\n        return 1  # Transversely Isotropic\n\n    # 3. Orthotropy Test\n    has_violation_ortho, pairs_ortho = check_invariance(strains, energies, rots_180)\n    if not has_violation_ortho and all(p >= 1 for p in pairs_ortho):\n        return 2  # Orthotropic\n\n    # 4. Inconclusive\n    return 3\n\n# Execute the main function\nsolve()\n```", "id": "2687993"}]}