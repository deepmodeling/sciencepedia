{"hands_on_practices": [{"introduction": "混合边值问题常常在数学上显得抽象。这个练习旨在通过一个具体的物理模型——一根一端连接有弹簧的弹性杆——来揭示其内在的物理意义。通过求解这个问题 [@problem_id:2662862]，你将亲手推导出一个Robin边界条件，并分析当弹簧刚度 $k$ 趋向于零或无穷大时，该解是如何自然地过渡到经典的Neumann和Dirichlet边界条件的。", "problem": "一根长度为 $L$、横截面积为常数 $A$ 的细长、均匀、线性弹性、等截面杆沿 $x$ 轴放置，其范围为 $x \\in (0,L)$。该材料的杨氏模量为 $E$，且适用小应变运动学。左端 $x=0$ 处被刚性固定，因此 $u(0)=0$，其中 $u(x)$ 是轴向位移场。在右端 $x=L$ 处，一个大小为 $P$ 的轴向静载荷沿 $x$ 轴正方向施加。此外，$x=L$ 的端点连接到一个刚度为 $k$ 的线性轴向弹簧，该弹簧固定在一个位移为零的刚性支座上。假设 $E0$，$A0$，$k \\ge 0$，且 $P$ 为有限值。\n\n仅从一维线性动量平衡（局部力平衡）、小应变运动学关系以及单轴应力下的胡克定律出发，推导 $u(x)$ 的控制常微分方程以及该物理结构所对应的边界条件。求解所得的混合边值问题，以获得在 $(0,L)$ 上轴向位移 $u(x)$ 的闭式解。然后，通过渐近推理，讨论该解如何在 $k \\to 0^{+}$ 和 $k \\to \\infty$ 的极限情况下简化为在 $x=L$ 处我们所熟知的诺伊曼 (Neumann) 和狄利克雷 (Dirichlet) 边界模型。\n\n将最终答案表示为用 $E$、$A$、$L$、$k$、$P$ 和 $x$ 表示的 $u(x)$ 的精确解析公式。无需进行数值四舍五入。最终表达式中不应包含物理单位。", "solution": "所述问题是有效的。这是一个在一维线性弹性力学中的适定问题，基于固体力学的基本原理，并且没有任何科学或逻辑上的缺陷。我们将进行其形式化的推导和求解。\n\n推导从连续介质力学的基本原理开始。\n首先，考虑线性动量平衡，在无体力的一维静态情况下，该平衡简化为局部力平衡。设 $\\sigma(x)$ 为轴向正应力场，$A$ 为常数横截面积。在任意横截面 $x$ 处的轴向力为 $F(x) = A\\sigma(x)$。对于杆在 $x$ 和 $x+dx$ 之间的一个微分单元，平衡要求力的总和为零。因此，$F(x+dx) - F(x) = 0$。两边除以 $dx$ 并取 $dx \\to 0$ 的极限，得到平衡的微分形式：\n$$\n\\frac{dF}{dx} = 0 \\implies \\frac{d}{dx}(A\\sigma(x)) = 0\n$$\n由于面积 $A$ 是常数，这简化为 $\\frac{d\\sigma}{dx} = 0$。\n\n其次，我们采用线性弹性材料的本构关系，即胡克定律。对于单轴应力，其形式为：\n$$\n\\sigma(x) = E \\varepsilon(x)\n$$\n其中 $E$ 是杨氏模量，$\\varepsilon(x)$ 是轴向应变。\n\n第三，我们使用小应变的运动学关系，它将应变场 $\\varepsilon(x)$ 与位移场 $u(x)$ 联系起来：\n$$\n\\varepsilon(x) = \\frac{du}{dx}\n$$\n\n将运动学关系和本构关系代入平衡方程，得到位移 $u(x)$ 的控制常微分方程 (ODE)。\n$$\n\\frac{d}{dx} \\left( E \\frac{du}{dx} \\right) = 0\n$$\n由于杆是均匀的，$E$ 是常数。乘积 $EA$ 是常数轴向刚度。因此，在 $x \\in (0,L)$ 上的控制常微分方程为：\n$$\nEA \\frac{d^2u}{dx^2} = 0 \\implies \\frac{d^2u}{dx^2} = 0\n$$\n\n接下来，我们必须建立边界条件。\n在左端 $x=0$ 处，杆被刚性固定。这意味着该点的位移为零。这构成了一个狄利克雷 (Dirichlet) 边界条件：\n$$\nu(0) = 0\n$$\n在右端 $x=L$ 处，我们必须进行力平衡分析。杆在该边界处施加的内力为 $A\\sigma(L)$。该内力必须与外部施加的力平衡。外力包括沿 $x$ 轴正方向作用的大小为 $P$ 的静载荷，以及来自线性弹簧的力。弹簧的伸长量等于杆端点的位移 $u(L)$，因此它在 $x$ 轴负方向上施加一个恢复力 $F_{spring} = k u(L)$。在 $x=L$ 处的力平衡方程为：\n$$\nA\\sigma(L) = P - k u(L)\n$$\n代入 $\\sigma(L) = E \\varepsilon(L) = E \\frac{du}{dx}\\big|_{x=L}$，我们得到在 $x=L$ 处的边界条件：\n$$\nAE \\frac{du}{dx}\\bigg|_{x=L} = P - k u(L)\n$$\n这可以重写为混合（或罗宾 (Robin)）边界条件的标准形式：\n$$\nAE \\frac{du}{dx}\\bigg|_{x=L} + k u(L) = P\n$$\n\n我们现在求解该边值问题，该问题由常微分方程 $\\frac{d^2u}{dx^2} = 0$ 和两个边界条件组成。\n对常微分方程关于 $x$ 积分两次，得到位移场的通解：\n$$\n\\frac{du}{dx} = C_1\n$$\n$$\nu(x) = C_1 x + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n应用第一个边界条件 $u(0)=0$：\n$$\nu(0) = C_1(0) + C_2 = 0 \\implies C_2 = 0\n$$\n解简化为 $u(x) = C_1 x$。其导数为 $\\frac{du}{dx} = C_1$。\n现在，我们应用在 $x=L$ 处的第二个边界条件：\n$$\nAE (C_1) + k (C_1 L) = P\n$$\n提取公因子 $C_1$：\n$$\nC_1 (AE + k L) = P\n$$\n求解 $C_1$：\n$$\nC_1 = \\frac{P}{AE + k L}\n$$\n将此常数代回 $u(x)$ 的表达式中，我们得到轴向位移的最终闭式解：\n$$\nu(x) = \\frac{P x}{AE + k L}\n$$\n\n最后，我们考察该解的渐近行为。\n情况1：弹簧极弱的极限，即 $k \\to 0^{+}$。\n在此极限下，解变为：\n$$\n\\lim_{k \\to 0^{+}} u(x) = \\lim_{k \\to 0^{+}} \\frac{P x}{AE + k L} = \\frac{P x}{AE}\n$$\n在 $x=L$ 处的边界条件变换为：\n$$\n\\lim_{k \\to 0^{+}} \\left( AE \\frac{du}{dx}\\bigg|_{x=L} + k u(L) = P \\right) \\implies AE \\frac{du}{dx}\\bigg|_{x=L} = P\n$$\n这是一个诺伊曼 (Neumann) 边界条件，它指定内力 $A\\sigma(L)$ 必须等于所施加的外力 $P$。我们推导出的解 $u(x) = Px/(AE)$ 正确地满足了这一点，因为 $du/dx = P/(AE)$，因此 $AE (P/(AE)) = P$。这对应于一端固定、另一端承受轴向力的杆的标准解。\n\n情况2：弹簧无限刚度的极限，即 $k \\to \\infty$。\n为了正确分析这个极限，我们考察边界处的位移 $u(L)$：\n$$\nu(L) = \\frac{P L}{AE + k L}\n$$\n当 $k \\to \\infty$ 时，分母无限增大，所以：\n$$\n\\lim_{k \\to \\infty} u(L) = 0\n$$\n这意味着对于任何有限的 $x \\in [0,L]$，位移 $u(x) = \\frac{x}{L} u(L)$ 也趋近于零：\n$$\n\\lim_{k \\to \\infty} u(x) = 0\n$$\n在 $x=L$ 处的边界条件可以重写为 $\\frac{AE}{k}\\frac{du}{dx}\\big|_{x=L} + u(L) = \\frac{P}{k}$。当 $k \\to \\infty$ 时，$\\frac{AE}{k}$ 和 $\\frac{P}{k}$ 都趋于零，条件简化为：\n$$\nu(L) = 0\n$$\n这是一个狄利克雷 (Dirichlet) 边界条件，代表一个刚性固定。对于 $x \\in [0,L]$，解 $u(x)=0$ 正确地描述了一根两端固定（$u(0)=0$ 和 $u(L)=0$）的杆，其中力 $P$ 直接作用在 $x=L$ 处的固定支座上。力 $P$ 完全传递到 $x=L$ 处的支座，杆本身保持不变形。\n\n因此，推导出的 $u(x)$ 解正确地概括了问题的物理实质，并且在适当的渐近极限下平滑地过渡到众所周知的更简单的边界模型。", "answer": "$$\n\\boxed{\\frac{P x}{E A + k L}}\n$$", "id": "2662862"}, {"introduction": "混合边值问题的一个重要特征是在边界条件类型改变的角点处可能产生应力奇异性。本练习 [@problem_id:2662895] 引导你使用渐近分析这一强大的解析工具，来研究反平面剪切下一个楔形体角点处的应力场。通过计算应力奇异性指数 $\\mu$，你将深入理解几何形状和混合边界条件是如何共同决定局部应力集中的，这是断裂力学和结构完整性评估中的一个核心概念。", "problem": "考虑一个各向同性、均匀的线弹性固体，它在极坐标 $(r,\\theta)$ 中占据一个无限的二维楔形区域，该区域由 $0  r  \\infty$ 和 $0  \\theta  \\omega$ 定义，楔形张角 $\\omega = \\frac{2\\pi}{3}$（弧度）。该物体承受反平面剪切（III 型）：唯一非零的位移分量是平面外位移 $w(r,\\theta)$，且不存在体力。$\\theta=0$ 处的楔形面在反平面意义上是固定的（即，在 $\\theta=0$ 上 $w=0$），而另一个楔形面 $\\theta=\\omega$ 处是无牵引力的。无牵引力条件意味着在 $\\theta=\\omega$ 上，平面外牵引力分量 $t_{z} = \\tau_{i z} n_{i}$ 为零，其中 $n_{i}$ 是边界的外法线单位向量，$\\tau_{i z}$ 是剪应力。\n\n从平衡方程和微小应变下的线弹性理论出发，确定当 $r \\to 0^{+}$ 时，剪应力 $\\tau_{r z}(r,\\theta)$ 和 $\\tau_{\\theta z}(r,\\theta)$ 的近角点主导阶渐近行为。特别地，通过当 $r \\to 0^{+}$ 时的主导阶标度关系 $\\tau_{r z}, \\tau_{\\theta z} \\sim C(\\theta)\\, r^{\\mu}$（其中 $C(\\theta)$ 为某个非零的角度函数）来定义指数 $\\mu$，并计算在给定的楔形和边界条件下 $\\mu$ 的精确值。\n\n仅报告 $\\mu$ 的值作为最终答案。不需要四舍五入。整个问题中角度均以弧度为单位，指数 $\\mu$ 不需要物理单位。", "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n- **已知条件**：\n    - 几何：极坐标 $(r, \\theta)$ 中的一个无限楔形区域，由 $r \\in (0, \\infty)$ 和 $\\theta \\in (0, \\omega)$ 定义。\n    - 楔形角：$\\omega = \\frac{2\\pi}{3}$。\n    - 物理：各向同性、均匀、线弹性固体，承受反平面剪切（III型），无体力。\n    - 位移场：$u_r = 0$，$u_\\theta = 0$，$w = w(r, \\theta)$。\n    - 边界条件 (BCs)：\n        1. 在 $\\theta=0$ 上：固定，$w(r, 0) = 0$。\n        2. 在 $\\theta=\\omega$ 上：无牵引力，$t_z = 0$。\n- **验证结论**：该问题是线弹性理论中的一个标准、适定问题，具体涉及混合边界条件下角点的应力分析。它具有科学依据，并包含足够的信息来唯一求解所要求的指数。该问题被认为是有效的。\n\n解题过程如下。\n\n对于反平面剪切变形，唯一非零的位移分量是 $z$ 方向的 $w(r, \\theta)$。在极坐标中，相应的非零应变分量为：\n$$\n\\gamma_{rz} = \\frac{\\partial w}{\\partial r}, \\quad \\gamma_{\\theta z} = \\frac{1}{r} \\frac{\\partial w}{\\partial \\theta}\n$$\n对于线弹性各向同性材料，剪切的本构关系（胡克定律）为：\n$$\n\\tau_{rz} = G \\gamma_{rz} = G \\frac{\\partial w}{\\partial r}, \\quad \\tau_{\\theta z} = G \\gamma_{\\theta z} = \\frac{G}{r} \\frac{\\partial w}{\\partial \\theta}\n$$\n其中 $G$ 是剪切模量。\n\n在没有体力的情况下，极坐标中的平衡方程简化为：\n$$\n\\frac{1}{r}\\frac{\\partial (r \\tau_{rz})}{\\partial r} + \\frac{1}{r}\\frac{\\partial \\tau_{\\theta z}}{\\partial \\theta} = 0\n$$\n将本构关系代入平衡方程，得到位移 $w(r, \\theta)$ 的控制偏微分方程：\n$$\n\\frac{1}{r}\\frac{\\partial}{\\partial r} \\left(r G \\frac{\\partial w}{\\partial r}\\right) + \\frac{1}{r}\\frac{\\partial}{\\partial \\theta} \\left(\\frac{G}{r} \\frac{\\partial w}{\\partial \\theta}\\right) = 0\n$$\n假设材料是均匀的（$G$ 是常数），我们可以将其简化为极坐标下的拉普拉斯方程：\n$$\n\\nabla^2 w = \\frac{\\partial^2 w}{\\partial r^2} + \\frac{1}{r}\\frac{\\partial w}{\\partial r} + \\frac{1}{r^2}\\frac{\\partial^2 w}{\\partial \\theta^2} = 0\n$$\n我们寻求当 $r \\to 0^{+}$ 时解在角点附近的渐近行为。这可以通过分离变量法来实现。我们假设解的形式为：\n$$\nw(r, \\theta) = R(r) \\Theta(\\theta)\n$$\n将此形式代入拉普拉斯方程并分离变量，我们得到两个常微分方程，由一个分离常数 $\\lambda^2$ 连接：\n$$\nr^2 R''(r) + r R'(r) - \\lambda^2 R(r) = 0 \\quad (\\text{径向方程})\n$$\n$$\n\\Theta''(\\theta) + \\lambda^2 \\Theta(\\theta) = 0 \\quad (\\text{角向方程})\n$$\n角向方程的通解为 $\\Theta(\\theta) = A \\cos(\\lambda \\theta) + B \\sin(\\lambda \\theta)$。我们必须应用楔形面上的边界条件来确定常数 $A$、$B$ 和特征值 $\\lambda$。\n\n第一个边界条件是 $\\theta=0$ 处的固定条件：\n$$\nw(r, 0) = R(r) \\Theta(0) = 0\n$$\n对于非平凡解（$R(r) \\not\\equiv 0$），我们必须有 $\\Theta(0) = 0$。\n$$\n\\Theta(0) = A \\cos(0) + B \\sin(0) = A = 0\n$$\n这将角向解简化为 $\\Theta(\\theta) = B \\sin(\\lambda \\theta)$。\n\n第二个边界条件是 $\\theta=\\omega$ 处的无牵引力条件。在常数 $\\theta$ 的表面上，牵引力分量 $t_z$ 由 $t_z = \\tau_{\\theta z}$ 给出。因此，条件是：\n$$\n\\tau_{\\theta z}(r, \\omega) = 0\n$$\n使用本构关系，这变成：\n$$\n\\left. \\frac{G}{r} \\frac{\\partial w}{\\partial \\theta} \\right|_{\\theta=\\omega} = \\frac{G}{r} R(r) \\Theta'(\\omega) = 0\n$$\n对于非平凡解，这要求 $\\Theta'(\\omega) = 0$。从 $\\Theta(\\theta) = B \\sin(\\lambda \\theta)$，我们计算其导数：\n$$\n\\Theta'(\\theta) = B \\lambda \\cos(\\lambda \\theta)\n$$\n在 $\\theta=\\omega$ 处应用该条件：\n$$\n\\Theta'(\\omega) = B \\lambda \\cos(\\lambda \\omega) = 0\n$$\n为避免平凡解（$B=0$ 或 $\\lambda=0$），我们必须有 $\\cos(\\lambda \\omega) = 0$。这给出了 $\\lambda$ 的特征值方程：\n$$\n\\lambda \\omega = \\frac{(2n+1)\\pi}{2}, \\quad n = 0, 1, 2, \\dots\n$$\n因此，特征值为：\n$$\n\\lambda_n = \\frac{(2n+1)\\pi}{2\\omega}\n$$\n位移的通解是所有可能模式的叠加：\n$$\nw(r, \\theta) = \\sum_{n=0}^{\\infty} (C_n r^{\\lambda_n} + D_n r^{-\\lambda_n}) \\sin(\\lambda_n \\theta)\n$$\n其中径向部分的解 $R(r) = C_n r^{\\lambda_n} + D_n r^{-\\lambda_n}$ 是柯西-欧拉径向方程的通解。为了使解具有物理意义，原点周围任何有限区域内储存的应变能必须是有限的。这要求 $\\lambda_n  0$。由于 $\\omega  0$，我们的特征值都是正的。在原点附近（$r \\to 0^{+}$）的行为由代数上最小指数的项主导。这对应于最小的正特征值，它出现在 $n=0$ 时：\n$$\n\\lambda_0 = \\frac{\\pi}{2\\omega}\n$$\n因此，当 $r \\to 0^{+}$ 时，位移场的主导阶项为：\n$$\nw(r, \\theta) \\sim A_0 r^{\\lambda_0} \\sin(\\lambda_0 \\theta)\n$$\n其中 $A_0$ 是一个由远场加载条件决定的常数。\n\n现在我们可以计算剪应力的主导阶项：\n$$\n\\tau_{rz}(r, \\theta) = G \\frac{\\partial w}{\\partial r} \\sim G \\frac{\\partial}{\\partial r} [A_0 r^{\\lambda_0} \\sin(\\lambda_0 \\theta)] = G A_0 \\lambda_0 r^{\\lambda_0 - 1} \\sin(\\lambda_0 \\theta)\n$$\n$$\n\\tau_{\\theta z}(r, \\theta) = \\frac{G}{r} \\frac{\\partial w}{\\partial \\theta} \\sim \\frac{G}{r} \\frac{\\partial}{\\partial \\theta} [A_0 r^{\\lambda_0} \\sin(\\lambda_0 \\theta)] = \\frac{G}{r} [A_0 r^{\\lambda_0} \\lambda_0 \\cos(\\lambda_0 \\theta)] = G A_0 \\lambda_0 r^{\\lambda_0 - 1} \\cos(\\lambda_0 \\theta)\n$$\n两个应力分量都表现出 $r^{\\lambda_0 - 1}$ 形式的径向依赖性。问题将应力奇异性指数 $\\mu$ 定义为应力按 $r^\\mu$ 标度。通过比较，我们确定：\n$$\n\\mu = \\lambda_0 - 1\n$$\n代入 $\\lambda_0$ 的表达式：\n$$\n\\mu = \\frac{\\pi}{2\\omega} - 1\n$$\n问题指定了楔形张角 $\\omega = \\frac{2\\pi}{3}$。我们代入这个值来求 $\\mu$ 的数值：\n$$\n\\mu = \\frac{\\pi}{2 \\left(\\frac{2\\pi}{3}\\right)} - 1 = \\frac{\\pi}{\\frac{4\\pi}{3}} - 1 = \\frac{3}{4} - 1\n$$\n这导致：\n$$\n\\mu = -\\frac{1}{4}\n$$\n$\\mu$ 的负值表明应力在角点尖端 $r=0$ 处是奇异的，这对于当 $\\omega  \\frac{\\pi}{2}$ 时的混合边值问题是预期的。对于给定的 $\\omega = \\frac{2\\pi}{3}$，此条件得到满足。", "answer": "$$\n\\boxed{-\\frac{1}{4}}\n$$", "id": "2662895"}, {"introduction": "理论模型与实际工程应用之间的一大鸿沟在于边界条件的未知性。本练习 [@problem_id:2662835] 将引导你进入一个更贴近实际的逆问题场景，即如何从带噪声的内部位移测量数据中反演出未知的边界牵引力。你将通过实现一个正则化最小二乘估计器，亲身体验解决这类不适定问题所面临的挑战以及正则化方法在稳定解和抑制噪声方面的关键作用。", "problem": "考虑一根长度为 $L$、恒定横截面积为 $A$、杨氏模量为 $E$ 的直棱柱形一维弹性杆。该杆与 $x$ 轴对齐，位于区间 $x \\in [0,L]$ 上。轴向位移场为 $u(x)$。一个单位长度上的恒定体力 $b$ 沿轴线作用。该杆受到混合边值条件的约束：左端为本质（Dirichlet）边界条件 $u(0)=0$，右端 $x=L$ 为由（未知的）牵引力 $T$ 定义的自然（Neumann）边界条件，其中牵引力被理解为轴向单位面积上的柯西牵引力。假设为小应变和线性弹性。\n\n你的任务是基于第一性原理实现一个正向模型，然后求解一个逆混合边值问题：使用 Tikhonov 正则化最小二乘估计器，从带有加性噪声的位移场 $u(x)$ 的内部测量值中恢复未知的牵引力 $T$。你必须分析正则化参数对恢复出的牵引力的影响。\n\n使用的基本原理：\n$$\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(A \\sigma(x)\\big) + b = 0.$$\n- 线性弹性本构关系：$$\\sigma(x) = E \\varepsilon(x), \\quad \\varepsilon(x) = \\frac{\\mathrm{d}u}{\\mathrm{d}x}.$$\n- 混合边界条件：$$u(0) = 0, \\quad \\sigma(L) = T.$$\n\n由此推导正向模型 $u(x;T)$，并为一组内部点 $\\{x_i\\}_{i=1}^m$（其中 $x_i \\in (0,L)$）表示出测量模型\n$$y_i = u(x_i;T) + \\eta_i,$$\n其中 $\\eta_i$ 是独立同分布的零均值高斯噪声样本，其已知标准差为 $\\sigma_u$（单位：米）。\n\n逆问题与正则化：\n- 给定测量值 $y_i$，通过最小化 Tikhonov 正则化目标函数来估计 $T$\n$$J(T) = \\sum_{i=1}^{m} \\left(u(x_i;T) - y_i \\right)^2 + \\lambda\\, T^2,$$\n其中 $\\lambda \\ge 0$ 是正则化参数。参数 $\\lambda$ 的物理单位是 $\\text{meter}^2/\\text{Pascal}^2$，以匹配数据失配项的单位。\n\n实现细节：\n1. 使用上述基本原理所蕴含的模型，获得满足混合边界条件的 $u(x;T)$ 的显式表达式。\n2. 使用此模型，根据已知的真实牵引力 $T_{\\text{true}}$ 和已知参数 $(E,A,L,b)$，为下面的每个测试用例生成合成测量数据，添加指定标准差 $\\sigma_u$ 的高斯噪声，并通过最小化 $J(T)$ 来估计 $T$。本问题不涉及角度。\n3. 为保证可复现性，对每个测试用例，使用具有指定整数种子的伪随机数生成器，抽取均值为零、标准差为 $\\sigma_u$ 的独立高斯样本，以扰动指定内部点的无噪声位移。\n4. 所有物理量必须以国际单位制（SI）处理。最终报告的牵引力估计值必须以帕斯卡（Pascals）为单位，表示为十进制浮点数值。不要在打印输出中包含单位；每个条目的单位都默认为帕斯卡。\n\n测试套件：\n实现五个测试用例，以涵盖一系列条件，包括适定的测量、噪声效应和不适定的配置。对每个测试用例，生成含噪声的测量值并计算 Tikhonov 估计值 $\\widehat{T}$。\n\n所有测试用例的共享参数（除非明确更改）：\n- $E = 2.10 \\times 10^{11}$ （帕斯卡），\n- $A = 1.00 \\times 10^{-4}$ （平方米），\n- $L = 1.00$ （米），\n- $b = 1.00 \\times 10^{3}$ （牛顿每米），\n- $T_{\\text{true}} = 5.00 \\times 10^{7}$ （帕斯卡）。\n\n对每个测试用例，指定 $(\\{x_i\\}_{i=1}^m, \\sigma_u, \\lambda, \\text{seed})$：\n- 测试用例 1（适定，低噪声，无正则化）：\n  - $\\{x_i\\} = \\{0.20, 0.35, 0.50, 0.70, 0.90\\}$，\n  - $\\sigma_u = 1.00 \\times 10^{-6}$ （米），\n  - $\\lambda = 0.00$ （平方米每帕斯卡平方），\n  - $\\text{seed} = 202401$。\n- 测试用例 2（适定，低噪声，弱正则化）：\n  - $\\{x_i\\} = \\{0.20, 0.35, 0.50, 0.70, 0.90\\}$，\n  - $\\sigma_u = 1.00 \\times 10^{-6}$ （米），\n  - $\\lambda = 1.00 \\times 10^{-24}$ （平方米每帕斯卡平方），\n  - $\\text{seed} = 202402$。\n- 测试用例 3（适定，较高噪声，强正则化）：\n  - $\\{x_i\\} = \\{0.20, 0.35, 0.50, 0.70, 0.90\\}$，\n  - $\\sigma_u = 1.00 \\times 10^{-5}$ （米），\n  - $\\lambda = 1.00 \\times 10^{-22}$ （平方米每帕斯卡平方），\n  - $\\text{seed} = 202403$。\n- 测试用例 4（不适定几何，低噪声，无正则化）：\n  - $\\{x_i\\} = \\{0.001, 0.002, 0.003, 0.004\\}$，\n  - $\\sigma_u = 1.00 \\times 10^{-6}$ （米），\n  - $\\lambda = 0.00$ （平方米每帕斯卡平方），\n  - $\\text{seed} = 202404$。\n- 测试用例 5（不适定几何，低噪声，强正则化）：\n  - $\\{x_i\\} = \\{0.001, 0.002, 0.003, 0.004\\}$，\n  - $\\sigma_u = 1.00 \\times 10^{-6}$ （米），\n  - $\\lambda = 1.00 \\times 10^{-22}$ （平方米每帕斯卡平方），\n  - $\\text{seed} = 202405$。\n\n要求的最终输出格式：\n- 你的程序必须生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中包含五个估计的牵引力，顺序与上述测试用例完全一致。每个数字必须以科学记数法打印，小数点后恰好有六位数字。例如，输出应如下所示\n  - $[t_1,t_2,t_3,t_4,t_5]$\n其中每个 $t_k$ 是测试用例 $k$ 的牵引力估计值（单位为帕斯卡），以 $a.bbbbbbe\\pm cc$ 的形式打印。\n\n没有用户输入。所有常量和测试用例均已在上面指定，程序必须运行至完成并打印所需的单行输出。", "solution": "我们从横截面积恒定的棱柱形杆的一维线性弹性基本方程开始。无穷小段上的轴向力平衡得出\n$$\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(A \\sigma(x)\\big) + b = 0,$$\n其中 $A$ 是恒定横截面积，$\\sigma(x)$ 是轴向柯西应力，$b$ 是单位长度上的恒定体力。线性弹性本构定律通过以下关系将应力与应变联系起来\n$$\\sigma(x) = E \\varepsilon(x), \\quad \\varepsilon(x) = \\frac{\\mathrm{d}u}{\\mathrm{d}x},$$\n其中 $E$ 是杨氏模量，$u(x)$ 是轴向位移。由于 $A$ 和 $E$ 是常数，平衡方程简化为\n$$A \\frac{\\mathrm{d}\\sigma}{\\mathrm{d}x} + b = 0 \\quad \\Longrightarrow \\quad A E \\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} + b = 0.$$\n这是一个关于 $u(x)$ 的具有常系数和常数力项的二阶常微分方程。积分两次得到\n$$u(x) = -\\frac{b}{2 A E} x^2 + C_1 x + C_0,$$\n其中 $C_0$ 和 $C_1$ 是由混合边界条件决定的常数。本质边界条件是\n$$u(0) = 0 \\quad \\Longrightarrow \\quad C_0 = 0.$$\n在 $x=L$ 处的自然边界条件规定了单位面积上的牵引力，它等于轴向应力：\n$$\\sigma(L) = E \\frac{\\mathrm{d}u}{\\mathrm{d}x}(L) = T.$$\n$u$ 的导数是\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}x}(x) = -\\frac{b}{A E} x + C_1.$$\n在 $x=L$ 处施加牵引力条件得到\n$$E\\left(-\\frac{b}{A E} L + C_1 \\right) = T \\quad \\Longrightarrow \\quad C_1 = \\frac{T}{E} + \\frac{b L}{A E}.$$\n将 $C_0$ 和 $C_1$ 代回，我们得到正向模型\n$$u(x;T) = -\\frac{b}{2 A E} x^2 + \\left(\\frac{T}{E} + \\frac{b L}{A E}\\right) x.$$\n该表达式是关于未知牵引力 $T$ 的线性表达式，可以写成\n$$u(x;T) = a(x)\\, T + u_0(x),$$\n其中\n$$a(x) = \\frac{x}{E}, \\qquad u_0(x) = -\\frac{b}{2 A E} x^2 + \\frac{b L}{A E} x.$$\n\n现在考虑在内部点 $\\{x_i\\}_{i=1}^m \\subset (0,L)$ 处的测量。在这些点上的无噪声模型响应是 $u(x_i;T) = a(x_i) T + u_0(x_i)$。测量模型包含了加性噪声：\n$$y_i = u(x_i;T_{\\text{true}}) + \\eta_i, \\quad \\eta_i \\sim \\mathcal{N}(0,\\sigma_u^2), \\quad i=1,\\dots,m,$$\n其中噪声样本是标准差为 $\\sigma_u$ 的独立同分布高斯噪声。\n\n为了从测量数据 $\\{(x_i,y_i)\\}$ 估计 $T$，我们建立 Tikhonov 正则化最小二乘目标函数\n$$J(T) = \\sum_{i=1}^{m} \\left(a(x_i) T + u_0(x_i) - y_i \\right)^2 + \\lambda T^2,$$\n其中 $\\lambda \\ge 0$ 是正则化参数，单位为 $\\text{meter}^2/\\text{Pascal}^2$。由于 $T$ 是标量且模型关于 $T$ 是线性的，$J(T)$ 是 $T$ 的一个凸二次函数，通过将其导数设为零，可以得到唯一的全局极小值点：\n$$\\frac{\\mathrm{d}J}{\\mathrm{d}T} = 2 \\sum_{i=1}^{m} a(x_i)\\left(a(x_i) T + u_0(x_i) - y_i\\right) + 2 \\lambda T = 0.$$\n整理后得到\n$$\\left(\\sum_{i=1}^{m} a(x_i)^2 + \\lambda\\right) \\widehat{T} = \\sum_{i=1}^{m} a(x_i)\\left(y_i - u_0(x_i)\\right),$$\n因此得到闭式 Tikhonov 估计\n$$\\widehat{T} = \\frac{\\sum_{i=1}^{m} a(x_i)\\left(y_i - u_0(x_i)\\right)}{\\sum_{i=1}^{m} a(x_i)^2 + \\lambda}.$$\n量纲一致性得到保证，因为 $a(x_i)$ 的单位是 $\\text{meter}/\\text{Pascal}$，$u_0(x_i)$ 和 $y_i$ 的单位是 $\\text{meter}$，而 $\\lambda$ 的单位是 $\\text{meter}^2/\\text{Pascal}^2$。\n\n程序算法设计：\n- 对每个测试用例，使用上面推导的正向模型计算无噪声位移 $u(x_i;T_{\\text{true}})$。\n- 使用指定的伪随机种子，抽取独立噪声样本 $\\eta_i \\sim \\mathcal{N}(0,\\sigma_u^2)$ 并构成测量数据 $y_i = u(x_i;T_{\\text{true}}) + \\eta_i$。\n- 对所有 $i$ 计算 $a(x_i)$ 和 $u_0(x_i)$，并如上所述计算 $\\widehat{T}$ 的分子和分母。\n- 对每个测试用例输出 $\\widehat{T}$。\n\n正则化效应分析：\n- 当内部点 $\\{x_i\\}$ 跨越杆的大部分区域时，灵敏度系数 $a(x_i) = x_i/E$ 得到的和 $\\sum_i a(x_i)^2$ 具有中等大小。在低噪声和 $\\lambda = 0$ 的情况下，估计值 $\\widehat{T}$ 接近 $T_{\\text{true}}$。\n- 引入一个小的正 $\\lambda$ 可以抑制噪声放大，但也会引入一个收缩因子\n$$\\widehat{T} \\approx \\frac{\\sum_i a(x_i)^2}{\\sum_i a(x_i)^2 + \\lambda} T_{\\text{true}} + \\frac{\\sum_i a(x_i)\\eta_i}{\\sum_i a(x_i)^2 + \\lambda},$$\n这体现了偏差-方差权衡：较大的 $\\lambda$ 会增加偏差（将 $\\widehat{T}$ 拉向零），同时减少噪声项的贡献。\n- 在不适定配置中，所有 $x_i$ 都非常接近于零，由于 $a(x_i) = x_i/E$，$\\sum_i a(x_i)^2$ 会变得极小。在没有正则化（$\\lambda = 0$）的情况下，分母非常小，噪声被严重放大，导致巨大的估计误差。使用强正则化（$\\lambda$ 相对于 $\\sum_i a(x_i)^2$ 较大）时，噪声放大被抑制，但估计值会严重偏向零。\n\n程序精确地遵循这些步骤，为保证可复现性而使用指定的种子，并以要求的单行格式打印出五个以帕斯卡为单位的估计牵引力。", "answer": "```python\nimport numpy as np\n\ndef forward_u(x, E, A, L, b, T):\n    \"\"\"\n    Compute the displacement u(x; T) for the 1D bar with\n    u(x;T) = -(b/(2 A E)) x^2 + ((T/E) + (b L)/(A E)) x\n    \"\"\"\n    x = np.asarray(x, dtype=float)\n    return (-(b / (2.0 * A * E)) * x**2) + (((T / E) + (b * L) / (A * E)) * x)\n\ndef a_of_x(x, E):\n    \"\"\"Sensitivity a(x) = x / E.\"\"\"\n    x = np.asarray(x, dtype=float)\n    return x / E\n\ndef u0_of_x(x, E, A, L, b):\n    \"\"\"Bias term u0(x) = -(b/(2 A E)) x^2 + (b L/(A E)) x.\"\"\"\n    x = np.asarray(x, dtype=float)\n    return (-(b / (2.0 * A * E)) * x**2) + ((b * L) / (A * E)) * x\n\ndef estimate_T(x_pts, y_meas, E, A, L, b, lam):\n    \"\"\"\n    Tikhonov estimate for scalar T:\n    T_hat = [sum_i a(x_i)*(y_i - u0(x_i))] / [sum_i a(x_i)^2 + lam]\n    \"\"\"\n    x_pts = np.asarray(x_pts, dtype=float)\n    y_meas = np.asarray(y_meas, dtype=float)\n    a = a_of_x(x_pts, E)\n    u0 = u0_of_x(x_pts, E, A, L, b)\n    numer = np.dot(a, (y_meas - u0))\n    denom = np.dot(a, a) + lam\n    # Safe handling if denom is zero (should not happen with given tests)\n    if denom == 0.0:\n        return np.nan\n    return numer / denom\n\ndef synthesize_measurements(x_pts, E, A, L, b, T_true, sigma_u, seed):\n    \"\"\"\n    Generate noisy measurements y_i = u(x_i; T_true) + eta_i\n    where eta_i ~ N(0, sigma_u^2), using a fixed seed for reproducibility.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    noiseless = forward_u(np.asarray(x_pts, dtype=float), E, A, L, b, T_true)\n    noise = rng.normal(loc=0.0, scale=sigma_u, size=len(x_pts))\n    return noiseless + noise\n\ndef solve():\n    # Shared parameters\n    E = 2.10e11       # Pa\n    A = 1.00e-4       # m^2\n    L = 1.00          # m\n    b = 1.00e3        # N/m\n    T_true = 5.00e7   # Pa\n\n    # Test cases: (x_pts, sigma_u, lambda, seed)\n    test_cases = [\n        ( [0.20, 0.35, 0.50, 0.70, 0.90], 1.00e-6, 0.00,         202401 ),\n        ( [0.20, 0.35, 0.50, 0.70, 0.90], 1.00e-6, 1.00e-24,     202402 ),\n        ( [0.20, 0.35, 0.50, 0.70, 0.90], 1.00e-5, 1.00e-22,     202403 ),\n        ( [0.001, 0.002, 0.003, 0.004],   1.00e-6, 0.00,         202404 ),\n        ( [0.001, 0.002, 0.003, 0.004],   1.00e-6, 1.00e-22,     202405 ),\n    ]\n\n    results = []\n    for x_pts, sigma_u, lam, seed in test_cases:\n        y_meas = synthesize_measurements(x_pts, E, A, L, b, T_true, sigma_u, seed)\n        T_hat = estimate_T(x_pts, y_meas, E, A, L, b, lam)\n        results.append(f\"{T_hat:.6e}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2662835"}]}