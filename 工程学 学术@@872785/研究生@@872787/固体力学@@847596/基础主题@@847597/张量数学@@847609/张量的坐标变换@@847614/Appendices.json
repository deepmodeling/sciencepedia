{"hands_on_practices": [{"introduction": "对称二阶张量（如柯西应力张量）完全由其主值（特征值）和主方向（特征向量）所定义。本练习 [@problem_id:2625090] 将通常求解特征值的问题反向而行；您将利用给定的主应力数据，在特定的实验室坐标系中重构张量的分量。此练习旨在强化谱分解的基本概念，并演示张量的表示如何随坐标系而改变。", "problem": "一个均匀的三维（3D）弹性固体，在由一个对称二阶张量表示的柯西（Cauchy）应力状态下处于静力平衡。在实验室笛卡尔基 $\\left(\\mathbf{e}_x,\\mathbf{e}_y,\\mathbf{e}_z\\right)$ 中，已知该应力张量具有三个主应力，其大小分别为 $\\sigma_1 = 120$ 兆帕（MPa），$\\sigma_2 = 60$ MPa 和 $\\sigma_3 = -30$ MPa，它们作用于相互正交的主方向上。这些主方向在实验室坐标系中的分量由下式给出：\n$$\\mathbf{n}_1 = \\begin{pmatrix} \\tfrac{2}{3} \\\\ \\tfrac{2}{3} \\\\ \\tfrac{1}{3} \\end{pmatrix}, \\quad \\mathbf{n}_2 = \\begin{pmatrix} -\\tfrac{2}{3} \\\\ \\tfrac{1}{3} \\\\ \\tfrac{2}{3} \\end{pmatrix}, \\quad \\mathbf{n}_3 = \\begin{pmatrix} \\tfrac{1}{3} \\\\ -\\tfrac{2}{3} \\\\ \\tfrac{2}{3} \\end{pmatrix}.$$\n仅使用主基、对称二阶张量的特征值和特征向量的核心定义，以及张量在正交基下的表示，确定实验室坐标系中的剪应力分量 $\\sigma_{xy}$。\n\n请以兆帕（MPa）为单位表示您的最终结果，并将答案四舍五入到四位有效数字。最终答案必须是一个实数。", "solution": "所述问题具有科学依据，是自洽且适定的。所提供的主方向构成了一个有效的标准正交基，且主应力在物理上是合理的。问题没有矛盾或含糊之处。因此，我们开始求解。\n\n问题要求确定柯西（Cauchy）应力张量 $\\boldsymbol{\\sigma}$ 在实验室笛卡尔基 $\\{\\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z\\}$ 中的剪应力分量 $\\sigma_{xy}$。我们已知该张量的主应力（特征值）$\\sigma_1$、$\\sigma_2$、$\\sigma_3$ 及其对应的（归一化）主方向（特征向量）$\\mathbf{n}_1$、$\\mathbf{n}_2$、$\\mathbf{n}_3$。\n\n线性代数和连续介质力学中的一个基本结果是对称二阶张量的谱分解。张量 $\\boldsymbol{\\sigma}$ 可以用其不变量，即并矢形式表示为：\n$$\n\\boldsymbol{\\sigma} = \\sum_{i=1}^{3} \\sigma_i (\\mathbf{n}_i \\otimes \\mathbf{n}_i)\n$$\n这里，$\\otimes$ 表示两个向量的张量积（并矢积）。这种表示形式与基的选择无关。\n\n为了求出 $\\boldsymbol{\\sigma}$ 在实验室基中的分量，我们将此方程在该基中表示。设 $\\boldsymbol{\\sigma}$ 在实验室基中的分量矩阵为 $\\mathbf{S}$，其元素为 $S_{ij} = \\sigma_{ij}$。并矢积 $\\mathbf{n}_i \\otimes \\mathbf{n}_i$ 的矩阵表示是代表 $\\mathbf{n}_i$ 的列向量与其转置的外积，即 $\\mathbf{n}_i \\mathbf{n}_i^T$。因此，分量矩阵 $\\mathbf{S}$ 由下式给出：\n$$\n\\mathbf{S} = \\sigma_1 (\\mathbf{n}_1 \\mathbf{n}_1^T) + \\sigma_2 (\\mathbf{n}_2 \\mathbf{n}_2^T) + \\sigma_3 (\\mathbf{n}_3 \\mathbf{n}_3^T)\n$$\n我们需要求分量 $\\sigma_{xy}$，它对应于矩阵 $\\mathbf{S}$ 的元素 $S_{12}$。根据上面的求和，分量 $S_{ij}$ 可以写为：\n$$\nS_{ij} = \\sum_{k=1}^{3} \\sigma_k (\\mathbf{n}_k \\mathbf{n}_k^T)_{ij}\n$$\n外积 $\\mathbf{n}_k \\mathbf{n}_k^T$ 的 $(i,j)$ 分量是向量 $\\mathbf{n}_k$ 的第 $i$ 个分量和第 $j$ 个分量的乘积。设 $\\mathbf{n}_k$ 在实验室基中的分量为 $(n_{kx}, n_{ky}, n_{kz})$。那么，分量 $\\sigma_{xy} = S_{12}$ 是：\n$$\n\\sigma_{xy} = \\sum_{k=1}^{3} \\sigma_k n_{kx} n_{ky} = \\sigma_1 n_{1x}n_{1y} + \\sigma_2 n_{2x}n_{2y} + \\sigma_3 n_{3x}n_{3y}\n$$\n已知条件如下：\n主应力：$\\sigma_1 = 120$ MPa, $\\sigma_2 = 60$ MPa, $\\sigma_3 = -30$ MPa。\n实验室基中的主方向（特征向量）：\n$$\n\\mathbf{n}_1 = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{2}{3} \\\\ \\frac{1}{3} \\end{pmatrix}, \\quad \\mathbf{n}_2 = \\begin{pmatrix} -\\frac{2}{3} \\\\ \\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix}, \\quad \\mathbf{n}_3 = \\begin{pmatrix} \\frac{1}{3} \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix}\n$$\n从这些向量中，我们提取所需的分量：\n对于 $\\mathbf{n}_1$：$n_{1x} = \\frac{2}{3}$，$n_{1y} = \\frac{2}{3}$。\n对于 $\\mathbf{n}_2$：$n_{2x} = -\\frac{2}{3}$，$n_{2y} = \\frac{1}{3}$。\n对于 $\\mathbf{n}_3$：$n_{3x} = \\frac{1}{3}$，$n_{3y} = -\\frac{2}{3}$。\n\n现在我们将这些值代入 $\\sigma_{xy}$ 的表达式中：\n$$\n\\sigma_{xy} = (120) \\left(\\frac{2}{3}\\right)\\left(\\frac{2}{3}\\right) + (60) \\left(-\\frac{2}{3}\\right)\\left(\\frac{1}{3}\\right) + (-30) \\left(\\frac{1}{3}\\right)\\left(-\\frac{2}{3}\\right)\n$$\n进行乘法运算：\n$$\n\\sigma_{xy} = 120 \\left(\\frac{4}{9}\\right) + 60 \\left(-\\frac{2}{9}\\right) - 30 \\left(-\\frac{2}{9}\\right)\n$$\n$$\n\\sigma_{xy} = \\frac{120 \\times 4}{9} - \\frac{60 \\times 2}{9} + \\frac{30 \\times 2}{9}\n$$\n$$\n\\sigma_{xy} = \\frac{480 - 120 + 60}{9}\n$$\n$$\n\\sigma_{xy} = \\frac{360 + 60}{9} = \\frac{420}{9}\n$$\n化简分数得到：\n$$\n\\sigma_{xy} = \\frac{140}{3}\n$$\n问题要求一个四舍五入到四位有效数字的数值。以小数形式表示：\n$$\n\\sigma_{xy} = 46.666... \\text{ MPa}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\sigma_{xy} \\approx 46.67 \\text{ MPa}\n$$\n这就是实验室坐标系中所需的剪应力分量。", "answer": "$$\n\\boxed{46.67}\n$$", "id": "2625090"}, {"introduction": "尽管张量的分量随坐标系而变化，但其分量的某些组合（称为不变量）却保持恒定。本练习 [@problem_id:2625086] 将引导您通过偏应力-球应力分解以及计算第二偏应力不变量 $J_2$，来探索这一关键概念。理解这些不变量至关重要，因为它们是许多材料模型（包括塑性理论和失效准则）的基础。", "problem": "一个均匀的线性弹性固体占据三维欧几里得空间中的一个区域，并受到一个静态Cauchy应力张量作用，该张量在一个标准正交笛卡尔基中表示为如下对称二阶张量：\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120  30  -20\\\\\n30  80  25\\\\\n-20  25  60\n\\end{pmatrix}\n\\ \\text{(MPa)}.\n$$\n考虑一个由正常正交旋转表示的标准正交基变换。仅从正常正交基变换下二阶张量的坐标变换法则以及迹和二阶张量上的欧几里得(Frobenius)内积的定义出发，完成以下任务：\n\n1) 推导$\\boldsymbol{\\sigma}$的球-偏分解，将其分解为其球量部分和偏量部分，并证明由偏量部分与其自身的欧几里得内积形成的标量在所有正常正交基变换下是不变的。\n\n2) 使用你的推导，计算与$\\boldsymbol{\\sigma}$相关的偏应力第二不变量，得到一个标量值。用$\\text{MPa}^2$单位表示最终的标量，并将你的答案四舍五入到四位有效数字。\n\n你的最终答案必须是与所求标量对应的单个实数。不要在最终答案中提供中间结果。本问题不需要角度。", "solution": "我们的任务是分析给定的Cauchy应力张量$\\boldsymbol{\\sigma}$。该问题分为理论推导和数值计算两部分。该问题提法恰当，科学上合理，并包含获得唯一解所需的所有信息。我们直接进行求解。\n\n问题包括两个部分。首先，我们必须推导应力张量的球-偏分解，并证明一个特定标量的旋转不变性。其次，我们必须计算偏应力的第二不变量。\n\n第1部分：分解与不变性证明\n\n一个普通的二阶张量，例如Cauchy应力张量$\\boldsymbol{\\sigma}$，可以唯一地分解为一个球量部分和一个偏量部分。球量部分是一个与单位张量$\\mathbf{I}$成比例的各向同性张量，而偏量部分是一个无迹张量。\n\n该分解由下式给出：\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}_{\\text{spherical}} + \\mathbf{s}\n$$\n其中 $\\boldsymbol{\\sigma}_{\\text{spherical}}$ 是球量部分，$\\mathbf{s}$ 是偏量部分。\n\n球量部分定义为 $\\boldsymbol{\\sigma}_{\\text{spherical}} = p\\mathbf{I}$，其中 $p$ 是平均应力，定义为应力张量迹的三分之一：\n$$\np = \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3} \\sigma_{kk}\n$$\n这里，我们对重复指标使用求和约定。\n\n偏应力张量$\\mathbf{s}$则定义为剩余部分：\n$$\n\\mathbf{s} = \\boldsymbol{\\sigma} - p\\mathbf{I} = \\boldsymbol{\\sigma} - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) \\mathbf{I}\n$$\n根据构造，偏量张量是无迹的。我们可以验证这一点：\n$$\n\\text{tr}(\\mathbf{s}) = \\text{tr}\\left( \\boldsymbol{\\sigma} - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) \\mathbf{I} \\right) = \\text{tr}(\\boldsymbol{\\sigma}) - \\text{tr}\\left( \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) \\mathbf{I} \\right)\n$$\n利用迹算子的线性性质以及在三维空间中$\\text{tr}(\\mathbf{I}) = 3$这一事实：\n$$\n\\text{tr}(\\mathbf{s}) = \\text{tr}(\\boldsymbol{\\sigma}) - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) \\text{tr}(\\mathbf{I}) = \\text{tr}(\\boldsymbol{\\sigma}) - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) \\cdot 3 = \\text{tr}(\\boldsymbol{\\sigma}) - \\text{tr}(\\boldsymbol{\\sigma}) = 0\n$$\n\n现在，我们必须证明由偏量部分与其自身的欧几里得内积形成的标量在所有正常正交基变换下是不变的。设基变换由一个正常正交张量$\\mathbf{Q}$表示，它满足$\\mathbf{Q}^T \\mathbf{Q} = \\mathbf{Q} \\mathbf{Q}^T = \\mathbf{I}$和$\\det(\\mathbf{Q})=1$。\n\n二阶张量$\\boldsymbol{\\sigma}$的变换法则是：\n$$\n\\boldsymbol{\\sigma}' = \\mathbf{Q} \\boldsymbol{\\sigma} \\mathbf{Q}^T\n$$\n其中$\\boldsymbol{\\sigma}'$是张量在新基下的表示。\n\n首先，我们证明张量的迹是一个标量不变量。利用迹的循环性质$\\text{tr}(\\mathbf{A}\\mathbf{B}\\mathbf{C}) = \\text{tr}(\\mathbf{B}\\mathbf{C}\\mathbf{A})$：\n$$\n\\text{tr}(\\boldsymbol{\\sigma}') = \\text{tr}(\\mathbf{Q} \\boldsymbol{\\sigma} \\mathbf{Q}^T) = \\text{tr}(\\mathbf{Q}^T \\mathbf{Q} \\boldsymbol{\\sigma}) = \\text{tr}(\\mathbf{I} \\boldsymbol{\\sigma}) = \\text{tr}(\\boldsymbol{\\sigma})\n$$\n由于迹是不变的，所以平均应力$p$也是不变的。\n\n新基下的偏量张量$\\mathbf{s}'$为：\n$$\n\\mathbf{s}' = \\boldsymbol{\\sigma}' - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}') \\mathbf{I}\n$$\n单位张量$\\mathbf{I}$是各向同性的，意味着它在旋转下是不变的：$\\mathbf{I}' = \\mathbf{Q} \\mathbf{I} \\mathbf{Q}^T = \\mathbf{Q} \\mathbf{Q}^T = \\mathbf{I}$。\n代入$\\boldsymbol{\\sigma}'$的变换规则以及迹和$\\mathbf{I}$的不变性：\n$$\n\\mathbf{s}' = \\mathbf{Q} \\boldsymbol{\\sigma} \\mathbf{Q}^T - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) \\mathbf{I} = \\mathbf{Q} \\boldsymbol{\\sigma} \\mathbf{Q}^T - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) (\\mathbf{Q} \\mathbf{I} \\mathbf{Q}^T) = \\mathbf{Q} \\left( \\boldsymbol{\\sigma} - \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) \\mathbf{I} \\right) \\mathbf{Q}^T = \\mathbf{Q} \\mathbf{s} \\mathbf{Q}^T\n$$\n这表明偏量张量$\\mathbf{s}$按照二阶张量的方式进行变换。\n\n$\\mathbf{s}$与其自身的欧几里得(Frobenius)内积定义为$\\mathbf{s} : \\mathbf{s} = \\text{tr}(\\mathbf{s}^T \\mathbf{s})$。由于Cauchy应力张量$\\boldsymbol{\\sigma}$是对称的，其偏量部分$\\mathbf{s}$也是对称的($\\mathbf{s}^T=\\mathbf{s}$)。因此，内积简化为$\\mathbf{s} : \\mathbf{s} = \\text{tr}(\\mathbf{s}^2)$。\n\n我们必须证明$\\mathbf{s}' : \\mathbf{s}' = \\mathbf{s} : \\mathbf{s}$。\n$$\n\\mathbf{s}' : \\mathbf{s}' = \\text{tr}((\\mathbf{s}')^2) = \\text{tr}\\left( (\\mathbf{Q} \\mathbf{s} \\mathbf{Q}^T) (\\mathbf{Q} \\mathbf{s} \\mathbf{Q}^T) \\right)\n$$\n利用张量乘法的结合律和性质$\\mathbf{Q}^T\\mathbf{Q} = \\mathbf{I}$：\n$$\n\\text{tr}\\left( \\mathbf{Q} \\mathbf{s} (\\mathbf{Q}^T \\mathbf{Q}) \\mathbf{s} \\mathbf{Q}^T \\right) = \\text{tr}(\\mathbf{Q} \\mathbf{s} \\mathbf{I} \\mathbf{s} \\mathbf{Q}^T) = \\text{tr}(\\mathbf{Q} \\mathbf{s}^2 \\mathbf{Q}^T)\n$$\n再次应用迹的循环性质：\n$$\n\\text{tr}(\\mathbf{Q} \\mathbf{s}^2 \\mathbf{Q}^T) = \\text{tr}(\\mathbf{Q}^T \\mathbf{Q} \\mathbf{s}^2) = \\text{tr}(\\mathbf{I} \\mathbf{s}^2) = \\text{tr}(\\mathbf{s}^2)\n$$\n由于$\\mathbf{s} : \\mathbf{s} = \\text{tr}(\\mathbf{s}^2)$，我们证明了：\n$$\n\\mathbf{s}' : \\mathbf{s}' = \\mathbf{s} : \\mathbf{s}\n$$\n该标量确实在正常正交变换下是不变的。\n\n第2部分：偏应力第二不变量的计算\n\n偏应力的第二不变量，记为$J_2$，是根据我们刚才讨论的不变标量来定义的：\n$$\nJ_2 = \\frac{1}{2} (\\mathbf{s} : \\mathbf{s}) = \\frac{1}{2} s_{ij} s_{ji}\n$$\n给定应力张量：\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120  30  -20\\\\\n30  80  25\\\\\n-20  25  60\n\\end{pmatrix}\n\\ \\text{(MPa)}\n$$\n首先，我们计算$\\boldsymbol{\\sigma}$的迹：\n$$\n\\text{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33} = 120 + 80 + 60 = 260\\ \\text{MPa}\n$$\n平均应力$p$为：\n$$\np = \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma}) = \\frac{260}{3}\\ \\text{MPa}\n$$\n现在，我们计算偏应力张量$\\mathbf{s} = \\boldsymbol{\\sigma} - p \\mathbf{I}$的分量。非对角分量保持不变：$s_{12} = 30$，$s_{13} = -20$，$s_{23} = 25$。对角分量为：\n$$\ns_{11} = \\sigma_{11} - p = 120 - \\frac{260}{3} = \\frac{360-260}{3} = \\frac{100}{3}\\ \\text{MPa}\n$$\n$$\ns_{22} = \\sigma_{22} - p = 80 - \\frac{260}{3} = \\frac{240-260}{3} = -\\frac{20}{3}\\ \\text{MPa}\n$$\n$$\ns_{33} = \\sigma_{33} - p = 60 - \\frac{260}{3} = \\frac{180-260}{3} = -\\frac{80}{3}\\ \\text{MPa}\n$$\n偏量张量为：\n$$\n\\mathbf{s} = \\begin{pmatrix}\n\\frac{100}{3}  30  -20 \\\\\n30  -\\frac{20}{3}  25 \\\\\n-20  25  -\\frac{80}{3}\n\\end{pmatrix}\n\\ \\text{MPa}\n$$\n我们现在计算不变量$\\mathbf{s} : \\mathbf{s} = \\sum_{i,j} s_{ij}^2$。对于一个对称张量，这等于对角线元素平方和加上非对角线元素平方和的两倍：\n$$\n\\mathbf{s} : \\mathbf{s} = s_{11}^2 + s_{22}^2 + s_{33}^2 + 2(s_{12}^2 + s_{13}^2 + s_{23}^2)\n$$\n代入我们计算出的分量值：\n$$\n\\mathbf{s} : \\mathbf{s} = \\left(\\frac{100}{3}\\right)^2 + \\left(-\\frac{20}{3}\\right)^2 + \\left(-\\frac{80}{3}\\right)^2 + 2\\left(30^2 + (-20)^2 + 25^2\\right)\n$$\n$$\n\\mathbf{s} : \\mathbf{s} = \\frac{10000 + 400 + 6400}{9} + 2(900 + 400 + 625)\n$$\n$$\n\\mathbf{s} : \\mathbf{s} = \\frac{16800}{9} + 2(1925) = \\frac{5600}{3} + 3850 = \\frac{5600 + 11550}{3} = \\frac{17150}{3}\n$$\n最后，根据定义计算$J_2$：\n$$\nJ_2 = \\frac{1}{2}(\\mathbf{s}:\\mathbf{s}) = \\frac{1}{2} \\left(\\frac{17150}{3}\\right) = \\frac{8575}{3} \\approx 2858.333... \\ \\text{MPa}^2\n$$\n将结果四舍五入到四位有效数字，我们得到 $2858\\ \\text{MPa}^2$。", "answer": "$$\\boxed{2858}$$", "id": "2625086"}, {"introduction": "将张量变换理论转化为正确的数值代码需要对细节一丝不苟。本练习 [@problem_id:2625094] 旨在解决张量旋转的实际编程挑战，将严谨的、基于定义的方法与一种使用 Voigt 记法但存在缺陷的常见捷径进行对比。通过量化“朴素”方法的误差，此练习揭示了计算力学中的一个关键陷阱，并强调了遵循基本变换法则的重要性。", "problem": "给定一个场景，其中一个表示柯西应力的对称二阶张量必须在不同的标准正交基之间进行旋转。任务是根据二阶张量作为双线性映射的定义来实现正确的张量旋转，并将其与一种在 Voigt 记法中常用但错误的“朴素”旋转方法进行比较。所有角度均以弧度为单位。\n\n用作基本依据的定义：\n- 一个二阶张量 $\\sigma$ 是一个将两个向量映射为一个标量的双线性映射。在由旋转矩阵 $Q$（其中 $Q^{\\mathsf T} Q = I$ 且 $\\det Q = 1$）给出的标准正交基变换下，$\\sigma$ 在新基中的分量由应用于变换后基向量的双线性形式定义。\n- 一个对称的 $3 \\times 3$ 张量可以使用类 Voigt 排序映射为一个 6 维向量：$[\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{23}, \\sigma_{13}, \\sigma_{12}]^{\\mathsf T}$。\n- 在数值工作中，一个常见的陷阱是尝试使用一个由方向余弦的成对乘积构成的 $6 \\times 6$ 矩阵来旋转这个 6 维向量，而没有进行适当的对称化，也没有遵循所选的同构关系（例如，工程剪切应变与 Mandel 标度的约定）。\n\n实现要求：\n- 通过罗德里格斯公式为给定的轴-角 $(\\mathbf{n}, \\theta)$ 构建标准正交旋转矩阵 $Q$，并利用张量的双线性定义来获得新基中的旋转后分量，从而实现对称张量的严格旋转。\n- 实现一种“朴素 Voigt 旋转”：构造一个 $6 \\times 6$ 矩阵 $N(Q)$，其元素为 $N_{\\alpha\\beta} = Q_{i p} Q_{j q}$，其中 Voigt 指数到下标对的映射为 $(11) \\rightarrow \\alpha=1$, $(22) \\rightarrow \\alpha=2$, $(33) \\rightarrow \\alpha=3$, $(23) \\rightarrow \\alpha=4$, $(13) \\rightarrow \\alpha=5$, $(12) \\rightarrow \\alpha=6$，对于 $\\beta$ 也类似，$(i,j)$ 和 $(p,q)$ 是对应的下标对。将 $N(Q)$ 应用于由原始张量形成的 6 维向量，并从结果中重构一个对称张量。众所周知，这种操作通常是错误的，因为它忽略了非对角线分量所需的双线性对称化以及剪切分量的任何标度约定。\n\n测试套件：\n对于下面的每个测试用例，计算指定的量。所有数值常数都是无量纲的，所有角度都以弧度为单位。\n\n- 测试用例 A（一般旋转）：\n  - 张量 $\\sigma^{(A)} = \\begin{bmatrix} 120  30  -20 \\\\ 30  80  25 \\\\ -20  25  60 \\end{bmatrix}$。\n  - 旋转轴 $\\mathbf{n}^{(A)} = \\dfrac{1}{\\sqrt{14}} [1, 2, 3]^{\\mathsf T}$ 及角度 $\\theta^{(A)} = 0.67$。\n  - 输出 $e_A$：严格旋转后的张量与朴素 Voigt 旋转后的张量之差的弗罗贝尼乌斯范数。\n\n- 测试用例 B（单位旋转边界）：\n  - 张量 $\\sigma^{(B)} = \\sigma^{(A)}$。\n  - 旋转轴 $\\mathbf{n}^{(B)} = \\mathbf{n}^{(A)}$ 及角度 $\\theta^{(B)} = 0$。\n  - 输出 $e_B$：严格旋转后的张量与朴素 Voigt 旋转后的张量之差的弗罗贝尼乌斯范数。\n\n- 测试用例 C（特殊剪切情况）：\n  - 张量 $\\sigma^{(C)} = \\begin{bmatrix} 0  50  0 \\\\ 50  0  0 \\\\ 0  0  0 \\end{bmatrix}$。\n  - 绕 $z$ 轴旋转角度 $\\theta^{(C)} = \\dfrac{\\pi}{4}$。\n  - 输出 $e_C$：严格旋转后的张量与朴素 Voigt 旋转后的张量之差的弗罗贝尼乌斯范数。\n\n- 测试用例 D（正确旋转下的不变量，针对测试用例 A 进行评估）：\n  - 输出 $b_{D,1}$：一个布尔值，指示在 $10^{-10}$ 的容差内，迹在正确旋转下是否保持不变。\n  - 输出 $b_{D,2}$：一个布尔值，指示在 $10^{-10}$ 的容差内，主应力（特征值）集合在正确旋转下是否保持不变。\n\n- 测试用例 E（复合小角度旋转的数值正交性检查）：\n  - 构造 $Q^{(E)} = R_z(\\gamma) R_y(\\beta) R_x(\\alpha)$，其中 $\\alpha = 3\\times 10^{-8}$, $\\beta = -2\\times 10^{-8}$, $\\gamma = 1\\times 10^{-8}$，$R_x$, $R_y$, $R_z$ 是绕坐标轴的精确旋转矩阵。\n  - 输出 $e_E$：弗罗贝尼乌斯范数 $\\| (Q^{(E)})^{\\mathsf T} Q^{(E)} - I \\|_F$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[e_A, e_B, e_C, b_{D,1}, b_{D,2}, e_E]$。", "solution": "所述问题已经过验证，并被认定为有效。它在科学上基于连续介质力学和线性代数的原理，问题设定良好、客观，并包含得出唯一且有意义解所需的所有信息。不存在矛盾或逻辑谬误。我们可以继续。\n\n此问题的核心在于二阶张量（例如柯西应力张量 $\\sigma$）的正确坐标变换。根据定义，二阶张量是一个双线性映射。这个定义规定了它在标准正交基变换下的变换法则。如果基向量的变换方式为 $\\mathbf{e}'_i = Q_{ji} \\mathbf{e}_j$（其中 $Q$ 是旋转矩阵），那么张量在新基中的分量 $\\sigma'_{ij}$ 与在旧基中的分量 $\\sigma_{kl}$ 通过以下法则相关：\n$$\n\\sigma'_{ij} = \\sum_{k=1}^3 \\sum_{l=1}^3 Q_{ik} Q_{jl} \\sigma_{kl}\n$$\n对于标准的右手笛卡尔坐标系，这可以用矩阵表示法紧凑地表示为：\n$$\n\\sigma' = Q \\sigma Q^{\\mathsf{T}}\n$$\n其中 $\\sigma$ 和 $\\sigma'$ 分别是张量在旧基和新基中的 $3 \\times 3$ 矩阵表示，$Q$ 是一个满足 $Q^{\\mathsf{T}} Q = I$ 和 $\\det(Q)=1$ 的标准正交旋转矩阵。这个变换法则是基础性的，不可随意修改。任何偏离此法则的程序都不代表有效的张量旋转。\n\n该问题要求将这种严格的变换与一种“朴素”方法进行比较。这种朴素方法源于将对称的 $3 \\times 3$ 张量 $\\sigma$ 表示为 Voigt 记法中的一个 6 元素向量 $v_\\sigma = [\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{23}, \\sigma_{13}, \\sigma_{12}]^{\\mathsf{T}}$，然后尝试使用一个朴素构造的 $6 \\times 6$ 矩阵 $N(Q)$ 来变换该向量。该矩阵的元素由 $N_{\\alpha\\beta} = Q_{ip} Q_{jq}$ 给出，其中 Voigt 指数 $\\alpha, \\beta$ 分别映射到矩阵下标对 $(i,j)$ 和 $(p,q)$。\n\n这种朴素方法存在根本性缺陷。它未能正确地考虑张量的双线性特性，特别是对于非对角线（剪切）分量。例如，一个法向分量 $\\sigma'_{11}$ 的变换涉及原始张量的所有分量项，包括剪切分量 $\\sigma_{kl}$（其中 $k \\neq l$）。$\\sigma'_{ij}$ 的正确变换需要对所有的 $k,l \\in \\{1,2,3\\}$ 求和。而朴素方法通过构造一个作用于 $6 \\times 1$ 向量的 $6 \\times 6$ 矩阵，隐含地将这个求和限制在 Voigt 记法中出现的六个分量对上。此外，它没有考虑到对于剪切项，$\\sigma_{kl}$ 和 $\\sigma_{lk}$ 都对求和有贡献。对于对称张量，其中 $\\sigma_{kl} = \\sigma_{lk}$，这导致变换后的剪切分量中缺少了因子 2。这个错误表明了对底层数学结构的误解。\n\n解决方案将按以下步骤实现：\n\n1.  **旋转矩阵的构建**：对于给定的旋转轴 $\\mathbf{n}$ 和角度 $\\theta$，旋转矩阵 $Q$ 使用罗德里格斯旋转公式构建：\n    $$\n    Q(\\mathbf{n}, \\theta) = I + (\\sin\\theta) K + (1 - \\cos\\theta) K^2\n    $$\n    其中 $K$ 是单位向量 $\\mathbf{n} = [n_x, n_y, n_z]^{\\mathsf T}$ 的斜对称叉积矩阵：\n    $$\n    K = \\begin{bmatrix} 0  -n_z  n_y \\\\ n_z  0  -n_x \\\\ -n_y  n_x  0 \\end{bmatrix}\n    $$\n\n2.  **严格的张量旋转**：正确旋转后的张量 $\\sigma'_{\\text{correct}}$ 使用表达式 $\\sigma'_{\\text{correct}} = Q \\sigma Q^{\\mathsf{T}}$ 计算。\n\n3.  **朴素 Voigt 旋转**：为了进行比较，此不正确的程序将严格按照问题陈述中的定义来实现。\n    a. 将原始张量 $\\sigma$ 转换为其 6 元素 Voigt 向量表示 $v$。\n    b. 使用从 Voigt 指数 $\\alpha \\in \\{1,...,6\\}$ 到矩阵下标 $(i,j)$ 的指定映射，构造朴素的 $6 \\times 6$ 变换矩阵 $N$，其元素为 $N_{\\alpha\\beta} = Q_{ip} Q_{jq}$。\n    c. 计算变换后的 Voigt 向量 $v'_{\\text{naive}} = N v$。\n    d. 从 $v'_{\\text{naive}}$ 重构一个对称张量 $\\sigma'_{\\text{naive}}$。\n\n4.  **误差计算与不变量检查**：计算差值的弗罗贝尼乌斯范数 $\\| \\sigma'_{\\text{correct}} - \\sigma'_{\\text{naive}} \\|_F$ 以量化朴素方法的误差。此外，验证迹和特征值集合（主应力）在正确旋转下的不变性，因为这些是任何有效张量变换的基本属性。\n\n5.  **数值稳定性检查**：通过计算 $\\| Q^{\\mathsf{T}}Q - I \\|_F$ 来检查由几个小角度基本旋转的乘积形成的复合旋转矩阵的正交性。在精确算术中，此范数应为零。其非零值量化了浮点数值误差。\n\n对给定的测试用例执行这些步骤将得出所需的结果。", "answer": "[38.2863953530819,0.0,70.71067811865476,True,True,5.551115123125783e-16]", "id": "2625094"}]}