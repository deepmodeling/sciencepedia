{"hands_on_practices": [{"introduction": "在连续介质力学中，不可压缩性是质量守恒定律在密度恒定材料中的直接体现。这项实践旨在探究这一物理约束带来的深刻数学后果。通过引入拉格朗日乘子来施加不可压缩性约束，我们将揭示静水压力场如何在控制方程中自然产生，并探讨其解的唯一性问题[@problem_id:2623910]。这一练习对于理解不可压缩材料本构模型的数学结构至关重要。", "problem": "考虑一个准静态、小应变、超弹性固体，占据有界域 $\\Omega \\subset \\mathbb{R}^3$，其边界为 $\\partial \\Omega$。设 $\\mathbf{u}(\\mathbf{x})$ 为位移场，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top)$ 为无穷小应变。该固体是等温的，具有恒定的质量密度，且体力 $\\mathbf{b}(\\mathbf{x})$ 作用在体积内。假设应变能密度 $W(\\boldsymbol{\\varepsilon})$ 是光滑且框架无关的。在不可压缩极限下，质量守恒意味着一个局部运动学约束，即材料在变形过程中局部体积不能改变。\n\n在能量或虚功率原理中强制施加该局部约束的一种方法是引入一个空间变化的乘子场 $p(\\mathbf{x})$ 来施加逐点约束。从第一性原理出发，以质量守恒的局部形式、应变和虚功的定义为起点，推断该乘子如何进入平衡方程和应力响应，并判断该乘子是否唯一。然后选择最准确地描述该乘子的数学作用及其唯一性属性的陈述。\n\nA. 在约束提法中，关于 $\\mathbf{u}$ 的平稳性得到柯西应力形式为 $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\,\\mathbf{I}$；乘子 $p$ 作为强制施加不可压缩约束的各向同性压力场，除非在 $\\partial \\Omega$ 的某一部分上规定了压力值或等效的法向牵引条件，否则它只能被确定至一个附加常数。\n\nB. 该约束引入一个矢量值乘子 $\\mathbf{p}$，它给应力增加一个螺线分量，因此应力变为 $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} + \\nabla \\times \\mathbf{p}$；因为 $\\mathbf{p}$ 的任何常数平移都会改变 $\\nabla \\cdot \\boldsymbol{\\sigma}$，所以该乘子是逐点唯一的。\n\nC. 乘子 $p$ 是一个标量，它只改变应力的偏量部分，而保持球量部分不变；仅质量守恒就能在没有边界数据的情况下唯一地确定整个 $\\Omega$ 中的 $p$。\n\nD. 标量乘子仅通过平衡方程中一个类体力的项 $\\nabla p$ 出现；因此，将 $p$ 平移一个常数会改变平衡，并通过给定的体力 $\\mathbf{b}$ 来固定该附加常数，而与边界条件无关。", "solution": "问题陈述提出了一个关于拉格朗日乘子场 $p(\\mathbf{x})$ 的作用和唯一性的问题，该乘子场用于在准静态、小应变、超弹性固体中强制施加不可压缩约束。\n\n首先，需要验证问题陈述的有效性。\n\n**步骤1：提取已知条件**\n-   域：位于有界域 $\\Omega \\subset \\mathbb{R}^3$ 中的准静态、小应变、超弹性固体。\n-   运动学：位移场为 $\\mathbf{u}(\\mathbf{x})$；无穷小应变为 $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top)$。\n-   材料属性：等温、恒定质量密度、光滑且框架无关的应变能密度 $W(\\boldsymbol{\\varepsilon})$。\n-   载荷：体积内的体力 $\\mathbf{b}(\\mathbf{x})$。\n-   约束：对于恒定密度材料，质量守恒意味着局部体积守恒，在小应变极限下即为运动学约束 $\\nabla \\cdot \\mathbf{u} = 0$。\n-   方法：引入一个空间变化的乘子场 $p(\\mathbf{x})$，以在能量或虚功率原理中强制施加该逐点约束。\n-   问题：描述该乘子在平衡方程和应力响应中的数学作用，并确定其唯一性属性。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。它描述了连续介质力学中一个标准且基本的问题：不可压缩超弹性的提法。使用拉格朗日乘子来强制施加不可压缩约束是一种典型技术。所有概念——超弹性、小应变、质量守恒和虚功——都得到了正确的陈述和应用。该问题作为一个概念性问题是适定的，为推导控制方程的一般结构提供了足够的信息。它在连续介质力学的理想化范围内是客观的、条件充分的、物理上现实的，并且并非一个简单问题。该问题是有效的。\n\n**步骤3：结论与行动**\n问题陈述是有效的。我将继续推导解答。\n\n**从第一性原理推导**\n\n超弹性体的平衡状态是通过寻求总势能的驻点来找到的。对于无约束体，势能泛函为：\n$$ \\Pi[\\mathbf{u}] = \\int_{\\Omega} W(\\boldsymbol{\\varepsilon}(\\mathbf{u})) \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{u} \\,dV - \\int_{\\partial\\Omega_t} \\mathbf{t}_{\\text{pre}} \\cdot \\mathbf{u} \\,dA $$\n其中 $\\mathbf{t}_{\\text{pre}}$ 是在边界部分 $\\partial\\Omega_t$ 上给定的牵引力。\n\n该固体是不可压缩的，对于小应变，这施加了运动学约束：\n$$ \\nabla \\cdot \\mathbf{u} = \\text{tr}(\\boldsymbol{\\varepsilon}) = 0 $$\n这个约束必须在 $\\Omega$ 中的每一点 $\\mathbf{x}$ 上都成立。为了在变分框架内强制施加这个逐点约束，我们引入一个拉格朗日乘子场，记为 $p(\\mathbf{x})$。我们通过将约束乘以 $p$ 加到势能泛函上，构造一个增广泛函，即拉格朗日量 $\\mathcal{L}$。一个标准的约定是：\n$$ \\mathcal{L}[\\mathbf{u}, p] = \\Pi[\\mathbf{u}] - \\int_{\\Omega} p(\\mathbf{x}) (\\nabla \\cdot \\mathbf{u}) \\,dV $$\n解 $(\\mathbf{u}, p)$ 是 $\\mathcal{L}$ 关于 $\\mathbf{u}$ 和 $p$ 的独立变分的驻点。\n\n首先，我们对位移场 $\\mathbf{u}$ 进行变分。我们考虑一个虚位移 $\\delta\\mathbf{u}$，它在任何具有给定 C位移的边界部分上为零。$\\mathcal{L}$ 关于 $\\mathbf{u}$ 的一阶变分必须为零：\n$$ \\delta_{\\mathbf{u}}\\mathcal{L} = \\delta_{\\mathbf{u}}\\Pi - \\int_{\\Omega} p (\\nabla \\cdot \\delta\\mathbf{u}) \\,dV = 0 $$\n势能的变分为：\n$$ \\delta_{\\mathbf{u}}\\Pi = \\int_{\\Omega} \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} : \\delta\\boldsymbol{\\varepsilon} \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\delta\\mathbf{u} \\,dV $$\n回顾 $\\delta\\boldsymbol{\\varepsilon} = \\text{symm}(\\nabla(\\delta\\mathbf{u}))$ 且 $\\nabla \\cdot \\delta\\mathbf{u} = \\text{tr}(\\delta\\boldsymbol{\\varepsilon}) = \\mathbf{I} : \\delta\\boldsymbol{\\varepsilon}$，平稳性条件变为：\n$$ \\int_{\\Omega} \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} : \\delta\\boldsymbol{\\varepsilon} - p (\\mathbf{I} : \\delta\\boldsymbol{\\varepsilon}) \\right) \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\delta\\mathbf{u} \\,dV = 0 $$\n$$ \\int_{\\Omega} \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\mathbf{I} \\right) : \\delta\\boldsymbol{\\varepsilon} \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\delta\\mathbf{u} \\,dV = 0 $$\n虚功原理指出，内虚功等于外虚功。乘以 $\\delta\\boldsymbol{\\varepsilon}$ 的项被确定为柯西应力张量 $\\boldsymbol{\\sigma}$。因此，我们得到了总应力的本构关系：\n$$ \\boldsymbol{\\sigma} = \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\mathbf{I} $$\n拉格朗日乘子 $p$ 对总应力贡献了一个静水应力分量 $-p\\mathbf{I}$。这个分量是一个反作用应力，用于强制施加不可压缩约束。$p$ 的物理解释是压力。\n\n为了推导局部平衡方程，我们将散度定理应用于虚功方程中的应力项：\n$$ \\int_{\\Omega} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\,dV = \\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla(\\delta\\mathbf{u}) \\,dV = -\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\delta\\mathbf{u} \\,dV + \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\delta\\mathbf{u} \\,dA $$\n将此代入平稳性条件，并考虑在 $\\Omega$ 内任意的虚位移 $\\delta\\mathbf{u}$（即在 $\\partial\\Omega$ 上为零），我们得到平衡方程的强形式：\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = 0 $$\n代入 $\\boldsymbol{\\sigma}$ 的表达式：\n$$ \\nabla \\cdot \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\mathbf{I} \\right) + \\mathbf{b} = 0 \\implies \\nabla \\cdot \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} \\right) - \\nabla p + \\mathbf{b} = 0 $$\n这个方程，连同约束 $\\nabla \\cdot \\mathbf{u} = 0$，构成了场 $\\mathbf{u}(\\mathbf{x})$ 和 $p(\\mathbf{x})$ 的控制偏微分方程组。\n\n现在，我们来检验乘子场 $p$ 的唯一性。观察到平衡方程只涉及 $p$ 的梯度，即 $\\nabla p$。如果 $p(\\mathbf{x})$ 是一个解，那么对于任意常数 $c$，$p(\\mathbf{x}) + c$ 也是一个解，因为 $\\nabla(p+c) = \\nabla p$。域 $\\Omega$ 内的控制方程在这种常数平移下是不变的。因此，压力场 $p$ 只能被系统确定至一个附加常数。为了获得 $p$ 的唯一解，这个常数必须被固定。这通常通过指定一个涉及 $p$ 的边界条件来完成。例如，可以在域中或边界上的某一点规定 $p$ 的值。或者，关于牵引力的边界条件 $\\boldsymbol{\\sigma}\\mathbf{n} = \\mathbf{t}_{\\text{pre}}$ 可以固定该常数。该牵引力的法向分量是 $\\mathbf{n} \\cdot (\\boldsymbol{\\sigma}\\mathbf{n}) = \\mathbf{n} \\cdot ((\\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}})\\mathbf{n} - p\\mathbf{n}) = \\mathbf{n} \\cdot ((\\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}})\\mathbf{n}) - p$。在边界的某一部分上规定法向牵引力为 $p$ 提供了边界条件，这有助于确定该任意常数。\n\n**逐项分析**\n\nA. **在约束提法中，关于 $\\mathbf{u}$ 的平稳性得到柯西应力形式为 $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\,\\mathbf{I}$；乘子 $p$ 作为强制施加不可压缩约束的各向同性压力场，除非在 $\\partial \\Omega$ 的某一部分上规定了压力值或等效的法向牵引条件，否则它只能被确定至一个附加常数。**\n这个陈述与我们的推导完全一致。在拉格朗日乘子的标准符号约定下，应力张量的形式是正确的。$p$ 作为各向同性压力场的作用被正确地识别。关于非唯一性以及固定附加常数所需条件的陈述也是正确的。\n结论：**正确**。\n\nB. **该约束引入一个矢量值乘子 $\\mathbf{p}$，它给应力增加一个螺线分量，因此应力变为 $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} + \\nabla \\times \\mathbf{p}$；因为 $\\mathbf{p}$ 的任何常数平移都会改变 $\\nabla \\cdot \\boldsymbol{\\sigma}$，所以该乘子是逐点唯一的。**\n不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$ 是一个标量方程。相应的拉格朗日乘子必须是一个标量场 $p(\\mathbf{x})$，而不是一个矢量场 $\\mathbf{p}(\\mathbf{x})$。所提出的应力形式和关于唯一性的推理都是根本错误的。\n结论：**错误**。\n\nC. **乘子 $p$ 是一个标量，它只改变应力的偏量部分，而保持球量部分不变；仅质量守恒就能在没有边界数据的情况下唯一地确定整个 $\\Omega$ 中的 $p$。**\n乘子以 $-p\\mathbf{I}$ 项的形式进入应力。这是一个纯球形（静水）张量；其偏量部分为零。因此，与该陈述相反，它只改变应力的球量部分。此外，关于唯一性的主张是错误的；质量守恒提供了运动学约束，但压力场是由整个平衡方程组决定的，并且仅在一个附加常数的范围内是唯一的，这需要边界数据来固定。\n结论：**错误**。\n\nD. **标量乘子仅通过平衡方程中一个类体力的项 $\\nabla p$ 出现；因此，将 $p$ 平移一个常数会改变平衡，并通过给定的体力 $\\mathbf{b}$ 来固定该附加常数，而与边界条件无关。**\n第一部分是正确的：乘子在局部平衡方程中以 $-\\nabla p$ 项的形式出现，这在形式上类似于从一个势导出的体力。然而，由此得出的结论是错误的。将 $p$ 平移一个常数 $c$ 不会改变平衡方程，因为 $\\nabla(p+c) = \\nabla p$。因此，体力 $\\mathbf{b}$ 不会也不能固定该附加常数。唯一性需要一个边界条件。\n结论：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2623910"}, {"introduction": "守恒律的威力在于它们能够预测系统的动态行为。本练习将质量守恒与动量守恒相结合，展示如何推导出控制弹性固体中扰动传播的基本方程——弹性动力学波动方程。通过分析平面波解，我们将提取出与材料属性（如拉梅常数 $\\lambda$ 和 $\\mu$）直接相关的纵波波速[@problem_id:2623893]，从而将抽象的守恒原理与可测量的物理现象联系起来。", "problem": "一个处于小应变状态下的均匀各向同性固体占据一个无界域。令 $\\rho$、$\\mathbf{v}$ 和 $\\boldsymbol{\\sigma}$ 分别表示当前质量密度、速度和 Cauchy 应力。假设以下基本定律和定义成立：\n- 质量守恒：$\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$。\n- 线性动量平衡（忽略体力）：$\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$。\n- 位移为 $\\mathbf{u}$ 的小应变运动学：$\\mathbf{v} = \\dot{\\mathbf{u}}$ 和 $\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$。\n- 各向同性线弹性本构行为：$\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$，其中 $\\lambda$ 和 $\\mu$ 为 Lamé 模量。\n\n围绕恒定参考密度 $\\rho_{0}$ 对质量守恒方程进行线性化，并将其与线性动量平衡方程结合，得到关于 $\\mathbf{u}$ 和 $\\rho$ 的封闭系统。对可压缩固体和不可压缩极限情况下的所得系统进行分类，并陈述在每种情况下使初值问题适定的参数条件。\n\n最后，考虑平面波解并提取纵向特征波速。设 $\\mathbf{u}(\\mathbf{x},t) = \\Re\\{\\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)\\}$，其中波矢量 $\\mathbf{k} \\neq \\mathbf{0}$，角频率为 $\\omega$，极化方向为 $\\mathbf{a} \\neq \\mathbf{0}$。定义与平行于 $\\mathbf{k}$ 的极化方向相关的纵向特征波速 $c_{\\mathrm{L}}$ 为 $c_{\\mathrm{L}} = \\omega/\\|\\mathbf{k}\\|$。用 $\\lambda$、$\\mu$ 和 $\\rho_{0}$ 表示的 $c_{\\mathrm{L}}^{2}$ 的闭式解析表达式是什么？请以单一解析表达式的形式提供最终答案；不要进行数值计算。", "solution": "在尝试求解之前，对问题陈述进行严格的验证。\n\n步骤1：提取已知条件\n- 域：一个处于小应变状态下的均匀各向同性固体占据一个无界域。\n- 状态变量：当前质量密度 $\\rho$，速度 $\\mathbf{v}$，Cauchy 应力 $\\boldsymbol{\\sigma}$，位移 $\\mathbf{u}$。\n- 基本定律：\n    - 质量守恒：$\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$。\n    - 线性动量平衡（忽略体力）：$\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$。\n- 定义和本构关系：\n    - 小应变运动学：$\\mathbf{v} = \\dot{\\mathbf{u}}$ 和 $\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$。\n    - 各向同性线弹性本构行为：$\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$，其中 $\\lambda$ 和 $\\mu$ 为 Lamé 模量。\n- 分析任务：\n    - 围绕恒定参考密度 $\\rho_{0}$ 对质量守恒进行线性化。\n    - 与线性化的动量平衡方程结合，得到关于 $\\mathbf{u}$ 和 $\\rho$ 的封闭系统。\n    - 对所得系统进行分类，并陈述可压缩和不可压缩情况下的适定性条件。\n    - 考虑平面波解 $\\mathbf{u}(\\mathbf{x},t) = \\Re\\{\\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)\\}$，其中波矢量 $\\mathbf{k} \\neq \\mathbf{0}$，角频率为 $\\omega$，极化方向为 $\\mathbf{a} \\neq \\mathbf{0}$。\n    - 提取平行于 $\\mathbf{k}$ 的极化方向的纵向特征波速 $c_{\\mathrm{L}} = \\omega/\\|\\mathbf{k}\\|$，并求出 $c_{\\mathrm{L}}^{2}$ 的表达式。\n\n步骤2：验证\n该问题具有科学依据，完全基于连续介质力学和线弹性学的基本原理。该问题是适定的、客观的、自洽的，提供了推导所要求结果所需的所有方程和定义。该问题需要在弹性动力学中进行一个标准但非平凡的推导。不存在逻辑矛盾、事实错误或含糊不清之处。\n\n步骤3：结论\n问题有效。将构建解答。\n\n按要求从第一性原理开始推导。\n\n首先，我们对控制方程进行线性化。我们考虑从静止状态（$\\rho = \\rho_{0}$, $\\mathbf{v} = \\mathbf{0}$, $\\mathbf{u} = \\mathbf{0}$）的微小扰动。我们令 $\\rho = \\rho_0 + \\rho'$，其中 $\\rho'$ 和 $\\mathbf{v} = \\dot{\\mathbf{u}}$ 是一阶小量。\n\n质量守恒方程为 $\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$。物质导数为 $\\dfrac{\\mathrm{D}}{\\mathrm{D}t} = \\dfrac{\\partial}{\\partial t} + \\mathbf{v} \\cdot \\nabla$。\n展开此式：\n$$\n\\frac{\\partial (\\rho_{0} + \\rho')}{\\partial t} + \\mathbf{v} \\cdot \\nabla (\\rho_{0} + \\rho') + (\\rho_{0} + \\rho') \\nabla \\cdot \\mathbf{v} = 0\n$$\n由于 $\\rho_0$ 是一个常数，此式简化为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\rho' + \\rho_{0} \\nabla \\cdot \\mathbf{v} + \\rho' \\nabla \\cdot \\mathbf{v} = 0\n$$\n忽略二阶项（如 $\\mathbf{v} \\cdot \\nabla \\rho'$ 和 $\\rho' \\nabla \\cdot \\mathbf{v}$ 等小量的乘积），线性化的质量守恒方程为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{v} = 0\n$$\n由于 $\\mathbf{v} = \\dot{\\mathbf{u}} = \\dfrac{\\partial \\mathbf{u}}{\\partial t}$，此式变为 $\\dfrac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\left(\\dfrac{\\partial \\mathbf{u}}{\\partial t}\\right) = 0$。\n\n接下来，我们对线性动量平衡方程进行线性化：$\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$。\n左侧为 $(\\rho_0 + \\rho') \\left( \\dfrac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right)$。对流加速度 $(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$ 是二阶的。项 $\\rho' \\dfrac{\\partial \\mathbf{v}}{\\partial t}$ 也是二阶的。唯一的一阶项是 $\\rho_0 \\dfrac{\\partial \\mathbf{v}}{\\partial t}$。由于 $\\mathbf{v} = \\dot{\\mathbf{u}}$，此项为 $\\rho_0 \\ddot{\\mathbf{u}}$。\n应力张量 $\\boldsymbol{\\sigma}$ 已经是一阶量，因为它与应变 $\\boldsymbol{\\varepsilon}$ 呈线性关系，而应变又与一阶位移 $\\mathbf{u}$ 的梯度呈线性关系。因此，线性化的动量方程为：\n$$\n\\rho_{0} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = \\nabla \\cdot \\boldsymbol{\\sigma}\n$$\n现在，代入本构关系 $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$ 和应变定义 $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$。注意到 $\\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$。\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\nabla \\cdot \\left( \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon} \\right) = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + 2\\mu \\nabla \\cdot \\boldsymbol{\\varepsilon}\n$$\n$$\n2\\mu \\nabla \\cdot \\boldsymbol{\\varepsilon} = \\mu \\nabla \\cdot (\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})\n$$\n使用矢量恒等式 $\\nabla \\cdot (\\nabla \\mathbf{u}) = \\nabla^2 \\mathbf{u}$（矢量拉普拉斯算子）和 $\\nabla \\cdot (\\nabla \\mathbf{u}^{\\mathsf{T}}) = \\nabla(\\nabla \\cdot \\mathbf{u})$，我们得到：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu (\\nabla^2 \\mathbf{u} + \\nabla(\\nabla \\cdot \\mathbf{u})) = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\n因此，位移场 $\\mathbf{u}$ 的控制方程为：\n$$\n\\rho_{0} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\n这就是弹性动力学波动方程，也称为 Navier 方程。该封闭系统由这个关于 $\\mathbf{u}$ 的方程和将 $\\rho'$ 与 $\\mathbf{u}$ 联系起来的线性化质量守恒方程组成。\n\n对于可压缩固体，这是一个二阶双曲型偏微分方程组。如果材料参数能确保物理稳定性，即应变能密度是正定的，那么初值问题就是适定的。这要求 Lamé 参数满足 $\\mu  0$ 和 $\\lambda + \\frac{2}{3}\\mu  0$（正体积模量）。一个更严格的条件，确保所有传播方向的波速都是实数，是 $\\mu  0$ 和 $\\lambda + 2\\mu  0$。\n\n在不可压缩极限下，我们施加约束 $\\nabla \\cdot \\mathbf{v} = 0$，对于从静止开始的变形，这意味着 $\\nabla \\cdot \\mathbf{u} = 0$。质量守恒 $\\dot{\\rho'} + \\rho_0 \\nabla \\cdot \\mathbf{v}=0$ 则意味着 $\\dot{\\rho'} = 0$，因此密度保持恒定。应力中的 $\\lambda (\\nabla \\cdot \\mathbf{u})$ 项变得不确定，并被一个标量压力场 $-p$ 所取代，该压力场作为拉格朗日乘子来强制施加不可压缩约束。本构定律变为 $\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}$。动量方程变为：\n$$\n\\rho_{0} \\ddot{\\mathbf{u}} = \\nabla \\cdot (-p\\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}) = -\\nabla p + \\mu \\nabla^2\\mathbf{u}\n$$\n对此方程取散度并使用 $\\nabla \\cdot \\mathbf{u} = 0$，得到 $\\nabla^2 p = 0$。压力场由一个椭圆型 Laplace 方程控制，而速度场的无散部分的演化则由一个波动方程控制。该系统是混合椭圆-双曲型的。如果 $\\mu  0$，则初值问题是适定的。\n\n为了求纵向波速，我们使用可压缩弹性动力学方程并代入平面波拟设 $\\mathbf{u}(\\mathbf{x},t) = \\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)$。所需的导数为：\n$$\n\\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = -\\omega^2 \\mathbf{u}\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{u}) = \\nabla(\\mathrm{i}\\mathbf{k} \\cdot \\mathbf{u}) = \\mathrm{i}\\mathbf{k}(\\mathrm{i}\\mathbf{k} \\cdot \\mathbf{u}) = -(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} \\exp(\\dots)\n$$\n$$\n\\nabla^2 \\mathbf{u} = \\nabla \\cdot (\\nabla \\mathbf{u}) = \\nabla \\cdot (\\mathrm{i}\\mathbf{k}\\mathbf{u}) = \\mathrm{i}\\mathbf{k} \\cdot (\\mathrm{i}\\mathbf{k}\\mathbf{u}) = -(\\mathbf{k} \\cdot \\mathbf{k})\\mathbf{u} = -\\|\\mathbf{k}\\|^2 \\mathbf{u}\n$$\n将这些代入 Navier 方程：\n$$\n\\rho_{0}(-\\omega^2 \\mathbf{a}) \\exp(\\dots) = (\\lambda + \\mu)( -(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k}) \\exp(\\dots) + \\mu(-\\|\\mathbf{k}\\|^2 \\mathbf{a}) \\exp(\\dots)\n$$\n消去指数项和负号，得到 Christoffel 方程：\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + \\mu)(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} + \\mu\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\n对于纵波，极化矢量 $\\mathbf{a}$ 平行于波矢量 $\\mathbf{k}$。因此，$\\mathbf{a}$ 是该张量算子的一个特征矢量。在这种情况下，$\\mathbf{a}$ 可以写成 $\\mathbf{k}$ 的标量倍。关系式 $\\mathbf{k} \\cdot \\mathbf{a} = \\|\\mathbf{k}\\| \\|\\mathbf{a}\\|$ 成立。那么 $(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} = (\\|\\mathbf{k}\\| \\|\\mathbf{a}\\|) \\frac{\\mathbf{k}}{\\|\\mathbf{k}\\|} \\|\\mathbf{k}\\| = \\|\\mathbf{k}\\|^2 \\|\\mathbf{a}\\| \\frac{\\mathbf{a}}{\\|\\mathbf{a}\\|} = \\|\\mathbf{k}\\|^2 \\mathbf{a}$。\n将此代入 Christoffel 方程：\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + \\mu)\\|\\mathbf{k}\\|^2 \\mathbf{a} + \\mu\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + 2\\mu)\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\n由于 $\\mathbf{a} \\neq \\mathbf{0}$，我们可以除以矢量 $\\mathbf{a}$：\n$$\n\\rho_{0} \\omega^2 = (\\lambda + 2\\mu)\\|\\mathbf{k}\\|^2\n$$\n纵向特征波速 $c_{\\mathrm{L}}$ 定义为 $\\omega/\\|\\mathbf{k}\\|$。我们要求的是 $c_{\\mathrm{L}}^{2}$：\n$$\nc_{\\mathrm{L}}^{2} = \\frac{\\omega^2}{\\|\\mathbf{k}\\|^2} = \\frac{\\lambda + 2\\mu}{\\rho_{0}}\n$$\n这是最终的表达式。这个结果证实了可压缩固体的适定性条件 $\\lambda+2\\mu  0$，因为要发生实波传播，波速的平方必须为正。", "answer": "$$\n\\boxed{\\frac{\\lambda + 2\\mu}{\\rho_{0}}}\n$$", "id": "2623893"}, {"introduction": "在现代工程中，数值模拟是分析复杂变形不可或缺的工具，但确保这些模拟的物理真实性至关重要。这项实践将理论与计算相结合，指导您如何设计一个验证测试，以检验大变形有限元模拟是否精确遵守了质量守恒定律。我们将从最基本的物质描述下的质量守恒关系 $\\rho_0 = \\rho J$ 出发，构建全局和局部误差度量，并将其应用于具体的数值算例中[@problem_id:2623914]。", "problem": "一个可压缩固体占据一个参考构型 $\\Omega_0 \\subset \\mathbb{R}^3$，其物质坐标为 $\\mathbf{X} \\in \\Omega_0$，并变形到当前构型 $\\Omega_t$，其空间坐标为 $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$。变形梯度定义为 $\\mathbf{F}(\\mathbf{X},t) = \\partial \\mathbf{x}/\\partial \\mathbf{X}$，雅可比行列式为 $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$，且 $J(\\mathbf{X},t)  0$。设 $\\rho_0(\\mathbf{X})$ 表示时间 $t=0$ 时的参考质量密度场，设 $\\rho(\\mathbf{X},t)$ 表示在时间 $t$ 时、在映射点 $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$ 处评估的空间质量密度。仅从“任何物质区域的总质量不随时间变化”这一基本陈述，以及 $\\mathbf{F}$ 和 $J$ 的定义出发，您必须：\n\n- 推导适用于验证的表达式，用以量化：\n  - 整个物体的全局质量守恒误差，表示为基于在 $\\Omega_0$ 上积分比值的无量纲标量。\n  - 在 $\\Omega_0$ 中表示的局部质量守恒误差场，以及基于在 $\\Omega_0$ 上范数的相应无量纲标量度量。\n\n- 设计一个数值程序，从给定的场 $\\rho_0(\\mathbf{X})$, $\\mathbf{F}(\\mathbf{X})$ 和 $\\rho(\\mathbf{X})$ 计算上述误差度量，而不使用任何非基本陈述所蕴含的性质。该数值程序必须：\n  - 在 $\\Omega_0 = [0,1]^3$ 的六面体剖分上工作，该剖分为一个具有 $N_e \\times N_e \\times N_e$ 个全等单元的结构化网格，其中 $N_e$ 是任意正整数。对于此任务，您必须取 $N_e = 8$。\n  - 通过张量积高斯积分来近似 $\\Omega_0$ 上的积分，每个单元使用 $2 \\times 2 \\times 2$ 个积分点。在 $[-1,1]$ 上的一维积分规则使用点 $\\{-1/\\sqrt{3},+1/\\sqrt{3}\\}$ 和单位权重 $\\{1,1\\}$。将这些点仿射映射到参考域中大小为 $h \\times h \\times h$（其中 $h = 1/N_e$）的每个单元。\n  - 在积分点上逐点计算 $J(\\mathbf{X}) = \\det \\mathbf{F}(\\mathbf{X})$。\n  - 生成全局误差，作为无量纲的绝对比值；以及局部误差，作为无量纲的范数比值，两者均在 $\\Omega_0$ 上进行评估。\n\n- 将此程序实现为一个程序，为以下四个测试用例评估误差度量，其中所有场都以闭合形式给出。在每个用例中，$\\mathbf{X} = (X_1,X_2,X_3)$ 且 $X_1,X_2,X_3 \\in [0,1]$。所有坐标单位为米 (m)。所有密度单位为千克/立方米 (kg/m$^3$)。输出为无量纲十进制数（无百分号）。将 $\\pi$ 定义为通常的圆周率常数。\n\n测试套件：\n- 用例 A（运动学兼容密度）：\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1 + 0.2\\,X_1\\big)\\big(1 + 0.1\\,X_2\\big)\\big(1 - 0.05\\,X_3\\big)}$.\n- 用例 B（空间密度的小局部扰动）：\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1 + 0.2\\,X_1\\big)\\big(1 + 0.1\\,X_2\\big)\\big(1 - 0.05\\,X_3\\big)}\\Big(1 + 10^{-3}\\,\\sin(2\\pi X_1)\\sin(2\\pi X_2)\\sin(2\\pi X_3)\\Big)$.\n- 用例 C（带全局偏差的均匀膨胀）：\n  - $\\mathbf{F}(\\mathbf{X}) = \\alpha\\,\\mathbf{I}$，其中 $\\alpha = 1.5$，$\\mathbf{I}$ 是单位张量。\n  - $\\rho_0(\\mathbf{X}) = 7800$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\alpha^3}\\,(1 + 0.05)$.\n- 用例 D（带局部缺陷的强变化体积拉伸）：\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1,\\; 1,\\; 0.2 + 0.1\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 900 + 100\\,\\cos(2\\pi X_1)\\cos(2\\pi X_2)\\cos(2\\pi X_3)$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1\\big)\\big(1\\big)\\big(0.2 + 0.1\\,X_3\\big)} + 10\\,\\exp\\!\\Big(-\\dfrac{(X_1 - 0.5)^2 + (X_2 - 0.5)^2 + (X_3 - 0.5)^2}{0.02}\\Big)$.\n\n您的程序必须：\n- 使用 $N_e = 8$ 以及指定的每个单元 $2 \\times 2 \\times 2$ 高斯积分。\n- 对于每个用例，计算：\n  - 全局质量误差，定义为两个积分之差的绝对值除以一个参考积分，所有积分都在 $\\Omega_0$ 上进行。\n  - 局部质量误差范数，定义为一个平方残差积分的平方根除以一个平方参考场积分的平方根，所有积分都在 $\\Omega_0$ 上进行。\n- 将四个用例的结果汇总为8个浮点数，顺序为 $\\big[\\text{global}_A,\\text{local}_A,\\text{global}_B,\\text{local}_B,\\text{global}_C,\\text{local}_C,\\text{global}_D,\\text{local}_D\\big]$。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3]$）。每个浮点数必须四舍五入到恰好 $8$ 位小数。\n\n所有最终答案都以纯十进制数表示（无百分号）。不需要用户输入；程序必须是自包含的，并在执行时产生单行输出。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n### 步骤 1：提取给定信息\n- **构型**：参考构型 $\\Omega_0 \\subset \\mathbb{R}^3$，物质坐标为 $\\mathbf{X}$；当前构型 $\\Omega_t$，空间坐标为 $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$。\n- **运动学**：变形梯度 $\\mathbf{F}(\\mathbf{X},t) = \\partial \\mathbf{x}/\\partial \\mathbf{X}$；雅可比行列式 $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t) > 0$。\n- **密度场**：参考质量密度 $\\rho_0(\\mathbf{X})$；在映射点 $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X},t)$ 处评估的空间质量密度表示为 $\\rho(\\mathbf{X},t)$。\n- **基本原理**：任何物质区域的总质量不随时间变化。\n- **域**：$\\Omega_0 = [0,1]^3 \\subset \\mathbb{R}^3$。\n- **数值离散化**：一个由 $N_e \\times N_e \\times N_e$ 个全等六面体单元组成的结构化网格，其中 $N_e = 8$。单元尺寸为 $h = 1/N_e = 1/8$。\n- **数值积分**：张量积高斯积分，每个单元有 $2 \\times 2 \\times 2$ 个点。在 $[-1,1]$ 上的一维规则使用点 $\\{\\pm 1/\\sqrt{3}\\}$ 和权重 $\\{1,1\\}$。\n- **任务**：推导全局质量守恒误差、局部质量守恒误差场及其范数的表达式。实现一个数值程序，为四个指定的测试用例评估这些误差。\n- **测试用例**：\n    - 用例 A：$\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$，$\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$，$\\rho(\\mathbf{X}) = \\rho_0(\\mathbf{X}) / J(\\mathbf{X})$。\n    - 用例 B：与用例A相同的 $\\mathbf{F}$ 和 $\\rho_0$，$\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{J(\\mathbf{X})}\\Big(1 + 10^{-3}\\,\\sin(2\\pi X_1)\\sin(2\\pi X_2)\\sin(2\\pi X_3)\\Big)$。\n    - 用例 C：$\\mathbf{F}(\\mathbf{X}) = 1.5\\,\\mathbf{I}$，$\\rho_0(\\mathbf{X}) = 7800$，$\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{1.5^3}\\,(1 + 0.05)$。\n    - 用例 D：$\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1,\\; 1,\\; 0.2 + 0.1\\,X_3\\big)$，$\\rho_0(\\mathbf{X}) = 900 + 100\\,\\cos(2\\pi X_1)\\cos(2\\pi X_2)\\cos(2\\pi X_3)$，$\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{J(\\mathbf{X})} + 10\\,\\exp\\!\\Big(-\\frac{(X_1 - 0.5)^2 + (X_2 - 0.5)^2 + (X_3 - 0.5)^2}{0.02}\\Big)$。\n- **输出要求**：一个包含8个十进制数的列表（每个用例的全局和局部误差），四舍五入到8位小数。\n\n### 步骤 2：使用提取的给定信息进行验证\n根据指定的有效性标准检查问题。\n- **科学基础**：该问题基于质量守恒原理，这是连续介质力学的基石。所有定义和概念（$\\mathbf{F}$, $J$, $\\rho_0$, $\\rho$）都是标准的。所要求的推导是该领域的一项基本练习。条件 $J>0$ 是变形物理可容许性的标准要求，并且在域 $\\Omega_0 = [0,1]^3$ 内的所有测试用例中都得到满足。该问题在科学上是合理的。\n- **适定性**：该问题要求推导误差度量，并实现一个特定的、定义明确的数值算法，以计算给定解析函数的这些度量。所有数值参数（域、网格尺寸、积分规则）都已精确指定。这种结构保证了存在唯一、稳定且有意义的数值结果。\n- **客观性**：该问题使用精确、客观的数学语言陈述。测试用例由显式的闭合形式函数定义，没有主观解释的余地。\n- **完整性和一致性**：该问题提供了继续进行所需的所有必要信息。没有缺失数据或矛盾的约束。\n- **其他缺陷**：该问题没有无关紧要、伪深刻或任何其他列出的无效性缺陷。它构成了计算固体力学中的一个标准验证问题。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供一个解决方案。\n\n### 基于原理的设计与解决方案\n\n解决方案分两个阶段进行：理论推导和数值实现设计。\n\n#### 质量守恒误差度量的推导\n\n基本公理是任意物质体积 $V_0 \\subset \\Omega_0$ 的质量在变形过程中是守恒的。设 $V_t = \\boldsymbol{\\varphi}(V_0, t)$ 是当前构型中的相同物质体积。时间 $t=0$ 时的质量由参考密度 $\\rho_0(\\mathbf{X})$ 在 $V_0$ 上的积分给出：\n$$ M = \\int_{V_0} \\rho_0(\\mathbf{X}) \\, dV_0 $$\n时间 $t$ 时的质量由空间密度 $\\rho(\\mathbf{x}, t)$ 在 $V_t$ 上的积分给出：\n$$ M = \\int_{V_t} \\rho(\\mathbf{x}, t) \\, dV_t $$\n质量守恒要求这两个 $M$ 的表达式相等。为了在单个积分内比较它们，我们对第二个积分进行变量变换，将其映射回参考域 $V_0$。当前构型中的微分体积元 $dV_t$ 与参考构型中的微分体积元 $dV_0$ 之间的关系由 $dV_t = J(\\mathbf{X},t) \\, dV_0$ 给出，其中 $J = \\det(\\mathbf{F})$。代入此关系并将点 $\\mathbf{x}(\\mathbf{X},t)$ 处的空间密度表示为 $\\rho(\\mathbf{X},t)$（根据问题的符号表示），得到：\n$$ \\int_{V_0} \\rho_0(\\mathbf{X}) \\, dV_0 = \\int_{V_0} \\rho(\\mathbf{X},t) J(\\mathbf{X},t) \\, dV_0 $$\n由于此等式必须对物质体积 $V_0 \\subseteq \\Omega_0$ 的任何任意选择都成立，因此被积函数必须相等。这给出了物质描述中质量守恒的局部形式：\n$$ \\rho_0(\\mathbf{X}) = \\rho(\\mathbf{X},t) J(\\mathbf{X},t) $$\n在本文的其余部分，我们省略对时间 $t$ 的显式依赖，因为我们考虑的是变形的一个静态快照。因此，守恒方程为 $\\rho_0(\\mathbf{X}) = \\rho(\\mathbf{X}) J(\\mathbf{X})$。\n\n与此等式的任何偏离都代表对质量守恒的违反。我们在参考域 $\\Omega_0$ 上定义一个局部质量残差场 $R(\\mathbf{X})$：\n$$ R(\\mathbf{X}) = \\rho_0(\\mathbf{X}) - \\rho(\\mathbf{X}) J(\\mathbf{X}) $$\n完美的质量守恒意味着对于所有 $\\mathbf{X} \\in \\Omega_0$，都有 $R(\\mathbf{X}) = 0$。现在我们可以构建所需的误差度量。\n\n1.  **全局质量守恒误差 ($E_{global}$)**：此度量量化了整个物体的净质量不平衡。它定义为总质量残差的绝对值，通过总初始质量进行归一化。\n    $$ E_{global} = \\frac{\\left| \\int_{\\Omega_0} \\big(\\rho_0(\\mathbf{X}) - \\rho(\\mathbf{X}) J(\\mathbf{X})\\big) \\, dV_0 \\right|}{\\int_{\\Omega_0} \\rho_0(\\mathbf{X}) \\, dV_0} = \\frac{\\left| \\int_{\\Omega_0} R(\\mathbf{X}) \\, dV_0 \\right|}{\\int_{\\Omega_0} \\rho_0(\\mathbf{X}) \\, dV_0} $$\n    这是一个无量纲标量，表示总质量的分数误差。\n\n2.  **局部质量守恒误差范数 ($E_{local}$)**：此度量量化了物体上局部残差场的大小。一个合适的度量是残差场 $R(\\mathbf{X})$ 的 $L_2$ 范数，通过参考密度场 $\\rho_0(\\mathbf{X})$ 的 $L_2$ 范数进行归一化。\n    $$ E_{local} = \\frac{\\sqrt{\\int_{\\Omega_0} [R(\\mathbf{X})]^2 \\, dV_0}}{\\sqrt{\\int_{\\Omega_0} [\\rho_0(\\mathbf{X})]^2 \\, dV_0}} $$\n    这提供了一个无量纲的均方根度量，用于衡量局部质量守恒误差。\n\n#### 数值程序\n\n误差度量需要评估在域 $\\Omega_0 = [0,1]^3$ 上的积分。我们采用指定的数值积分方案。\n\n该域被划分为 $N_e^3 = 8^3 = 512$ 个六面体单元，每个单元的大小为 $h \\times h \\times h$，其中 $h=1/8$。$\\Omega_0$ 上的积分是每个单元 $\\Omega^{(e)}$ 上积分的总和：\n$$ \\int_{\\Omega_0} f(\\mathbf{X}) \\, dV_0 = \\sum_{e=1}^{N_e^3} \\int_{\\Omega^{(e)}} f(\\mathbf{X}) \\, dV_0 $$\n每个单元积分使用 $2 \\times 2 \\times 2$ 张量积高斯积分规则来近似。在规范区间 $[-1,1]$ 上的一维规则使用点 $\\xi_k \\in \\{-1/\\sqrt{3}, 1/\\sqrt{3}\\}$ 和权重 $w_k=1$。\n\n规范单元 $[-1,1]^3$ 中的一个点 $\\boldsymbol{\\xi} = (\\xi_1, \\xi_2, \\xi_3)$ 通过仿射映射映射到物理单元 $\\Omega^{(e)}$ 中的一个点 $\\mathbf{X}$：$\\mathbf{X}(\\boldsymbol{\\xi}) = \\mathbf{X}_c^{(e)} + \\frac{h}{2}\\boldsymbol{\\xi}$，其中 $\\mathbf{X}_c^{(e)}$ 是单元的中心。此映射的微分体积为 $dV_0 = \\det(\\partial\\mathbf{X}/\\partial\\boldsymbol{\\xi}) dV_\\xi = (h/2)^3 dV_\\xi$。\n\n因此，单个单元上的积分近似为：\n$$ \\int_{\\Omega^{(e)}} f(\\mathbf{X}) \\, dV_0 \\approx \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 f(\\mathbf{X}_{ijk}) \\, (w_i w_j w_k) \\left(\\frac{h}{2}\\right)^3 $$\n其中 $\\mathbf{X}_{ijk}$ 是物理单元中的积分点。由于所有 $w_k=1$，单元内8个积分点中每个点的权重都是一个常数 $W_{qp} = (h/2)^3 = (1/16)^3$。\n\n整个域 $\\Omega_0$ 上的总积分点数为 $N_{total\\_qp} = N_e^3 \\times 2^3 = 512 \\times 8 = 4096$。在 $\\Omega_0$ 上积分的数值近似是所有这些点的总和：\n$$ \\int_{\\Omega_0} f(\\mathbf{X}) \\, dV_0 \\approx \\sum_{p=1}^{N_{total\\_qp}} f(\\mathbf{X}_p) W_{qp} $$\n其中 $\\mathbf{X}_p$ 是第 $p$ 个全局积分点的坐标。\n\n由于所有点的积分权重 $W_{qp}$ 都是常数，因此可以在误差度量 $E_{global}$ 和 $E_{local}$ 的分子和分母中提出，然后消去。计算简化为对所有积分点上的函数值求和：\n$$ E_{global} \\approx \\frac{\\left| \\sum_p R(\\mathbf{X}_p) \\right|}{\\sum_p \\rho_0(\\mathbf{X}_p)} $$\n$$ E_{local} \\approx \\frac{\\sqrt{\\sum_p [R(\\mathbf{X}_p)]^2}}{\\sqrt{\\sum_p [\\rho_0(\\mathbf{X}_p)]^2}} $$\n该算法包括生成所有4096个积分点的坐标，在这些点上评估场 $\\rho_0$、$\\mathbf{F}$、$\\rho$，计算雅可比行列式 $J$ 和残差 $R$，最后计算总和以获得每个测试用例的误差度量。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the continuum mechanics problem by deriving and calculating mass conservation errors.\n    \"\"\"\n\n    # Define the four test cases with their respective field functions.\n    test_cases = [\n        # Case A: Kinematically compatible density. Expected error is zero.\n        {\n            \"name\": \"A\",\n            \"F_func\": lambda X, Y, Z: (\n                1 + 0.2 * X,\n                1 + 0.1 * Y,\n                1 - 0.05 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z),\n            \"rho_func\": lambda X, Y, Z, J: (1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z)) / J\n        },\n        # Case B: Small local perturbation to spatial density.\n        {\n            \"name\": \"B\",\n            \"F_func\": lambda X, Y, Z: (\n                1 + 0.2 * X,\n                1 + 0.1 * Y,\n                1 - 0.05 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z),\n            \"rho_func\": lambda X, Y, Z, J: (\n                (1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z)) / J *\n                (1 + 1e-3 * np.sin(2*np.pi * X) * np.sin(2*np.pi * Y) * np.sin(2*np.pi * Z))\n            )\n        },\n        # Case C: Uniform dilation with global bias. Expected error is 0.05.\n        {\n            \"name\": \"C\",\n            \"F_func\": lambda X, Y, Z: 1.5,\n            \"rho0_func\": lambda X, Y, Z: 7800.0,\n            \"rho_func\": lambda X, Y, Z, J: (7800.0 / J) * 1.05\n        },\n        # Case D: Strongly varying stretch with localized defect.\n        {\n            \"name\": \"D\",\n            \"F_func\": lambda X, Y, Z: (\n                1.0,\n                1.0,\n                0.2 + 0.1 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 900 + 100 * np.cos(2*np.pi*X)*np.cos(2*np.pi*Y)*np.cos(2*np.pi*Z),\n            \"rho_func\": lambda X, Y, Z, J: (\n                (900 + 100 * np.cos(2*np.pi*X)*np.cos(2*np.pi*Y)*np.cos(2*np.pi*Z)) / J +\n                10 * np.exp(-((X-0.5)**2 + (Y-0.5)**2 + (Z-0.5)**2) / 0.02)\n            )\n        }\n    ]\n\n    # Numerical parameters\n    Ne = 8  # Number of elements per dimension\n    h = 1.0 / Ne  # Element size\n\n    # Generate 1D quadrature points in the canonical element [-1, 1]\n    canon_pts_1d = np.array([-1.0, 1.0]) / np.sqrt(3.0)\n\n    # Map canonical points to physical coordinates for all elements\n    cell_centers_1d = (np.arange(Ne) + 0.5) * h\n    # Offsets from cell centers to quadrature points\n    offsets = (h / 2.0) * canon_pts_1d\n    # Generate all 1D quadrature point coordinates\n    phys_pts_1d = (cell_centers_1d[:, None] + offsets[None, :]).flatten()\n\n    # Create a 3D grid of all quadrature points in the domain [0,1]^3\n    X_qp, Y_qp, Z_qp = np.meshgrid(phys_pts_1d, phys_pts_1d, phys_pts_1d, indexing='ij')\n\n    results = []\n\n    for case in test_cases:\n        # Evaluate reference density at all quadrature points\n        rho0_vals = case[\"rho0_func\"](X_qp, Y_qp, Z_qp)\n\n        # Evaluate deformation gradient components and Jacobian\n        F_diag = case[\"F_func\"](X_qp, Y_qp, Z_qp)\n        # For diagonal F, J is the product of diagonal entries.\n        if isinstance(F_diag, tuple):\n             J_vals = F_diag[0] * F_diag[1] * F_diag[2]\n        else: # For Case C with constant F\n             J_vals = F_diag**3\n        \n        # Evaluate spatial density\n        rho_vals = case[\"rho_func\"](X_qp, Y_qp, Z_qp, J_vals)\n\n        # Calculate the local mass residual field\n        R_vals = rho0_vals - rho_vals * J_vals\n\n        # The constant quadrature weight (h/2)^3 cancels in the ratios,\n        # so we can use sums directly.\n\n        # Calculate global error\n        # Sum of residuals (proportional to net mass change)\n        numerator_global = np.sum(R_vals)\n        # Sum of reference densities (proportional to total reference mass)\n        denominator_global = np.sum(rho0_vals)\n        E_global = np.abs(numerator_global) / denominator_global if denominator_global != 0 else 0.0\n\n        # Calculate local error norm\n        # Sum of squared residuals (proportional to L2 norm squared of R)\n        numerator_local_sq = np.sum(R_vals**2)\n        # Sum of squared reference densities (proportional to L2 norm squared of rho0)\n        denominator_local_sq = np.sum(rho0_vals**2)\n        \n        E_local = (np.sqrt(numerator_local_sq) / np.sqrt(denominator_local_sq) \n                   if denominator_local_sq > 0 else 0.0)\n\n        results.extend([E_global, E_local])\n\n    # Format the final output string\n    output_str = f\"[{','.join(f'{x:.8f}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2623914"}]}