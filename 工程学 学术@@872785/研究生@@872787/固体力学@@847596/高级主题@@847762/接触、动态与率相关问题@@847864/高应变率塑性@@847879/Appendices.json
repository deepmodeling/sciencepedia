{"hands_on_practices": [{"introduction": "在高应变率下常见的大变形过程中，工程应力/应变与真实应力/应变之间的区别不仅仅是学术上的，而是至关重要的。本练习 [@problem_id:2646979] 将指导你转换这些度量单位，并更深入地理解为何真实应力与真实应变构成了功共轭对（work-conjugate pair）。理解这一点对于精确模拟能量耗散和温升等热效应至关重要。", "problem": "一个淬火钢圆柱形试样采用分离式霍普金森压杆（SHPB）进行动态压缩测试。试样的初始长度为$L_{0}$，初始横截面积为$A_{0}$。在波达到平衡后，通过试样的力是均匀的，变形是均匀的。在测试的某一特定时刻，从压杆信号推断出的工程应变和工程应力分别为$\\varepsilon_{\\mathrm{eng}}=-0.30$和$\\sigma_{\\mathrm{eng}}=1.20\\ \\mathrm{GPa}$，平均应变率约为$\\dot{\\varepsilon}\\approx 3\\times 10^{3}\\ \\mathrm{s^{-1}}$。假设：\n- 试样内为单轴应力，\n- 动态力平衡，\n- 塑性不可压缩性（等容塑性流动）且鼓形效应可忽略，\n- 在此阶段，弹性应变与塑性应变相比可忽略不计，\n- 变形是绝热的，因此塑性功导致温度升高，泰勒-奎尼系数$\\beta\\approx 0.9$，质量密度$\\rho\\approx 7.8\\times 10^{3}\\ \\mathrm{kg/m^{3}}$，比热容$c\\approx 460\\ \\mathrm{J/(kg\\cdot K)}$。\n\n从工程应变（长度变化量与初始长度之比）、真实（对数）应变（长度增量与当前长度之比的积分）、工程应力（力除以初始面积）和真实应力（力除以瞬时面积）的基本定义出发，结合塑性不可压缩性$A\\,L=\\mathrm{const}$，确定在此状态下工程量和真实量之间的适当关系，并数值化地量化两种应力和应变量度之间的差异。然后，利用真实应力与真实塑性应变的功共轭关系，解释Johnson–Cook粘塑性模型是否应使用从动态实验中简化得到的真实应力-真实应变数据进行标定。\n\n下列陈述中哪些是正确的？选择所有适用的选项。\n\nA. 对于给定的压缩状态，在塑性不可压缩性条件下的一致转换关系为$\\varepsilon_{\\mathrm{true}} = \\ln(1+\\varepsilon_{\\mathrm{eng}}) \\approx -0.357$和$\\sigma_{\\mathrm{true}} = \\sigma_{\\mathrm{eng}}\\,(1+\\varepsilon_{\\mathrm{eng}}) \\approx 0.84\\ \\mathrm{GPa}$。由于塑性功$w_{p}=\\int \\sigma_{\\mathrm{true}}\\,\\mathrm{d}\\varepsilon_{p}$在高应变率下主导绝热温升，因此Johnson–Cook模型应根据从SHPB数据中简化得到并参考演化温度的真实应力-真实塑性应变曲线进行标定。\n\nB. 在高应变率下，时间增量很小，因此即使在大变形情况下，工程量和真实量之间的差异也可以忽略不计；因此可以安全地使用工程应力-工程应变曲线来标定Johnson–Cook模型，而无需进行热修正。\n\nC. 在压缩状态下，当$\\varepsilon_{\\mathrm{eng}}=-0.30$时，适用转换关系$\\sigma_{\\mathrm{true}}=\\sigma_{\\mathrm{eng}}/(1+\\varepsilon_{\\mathrm{eng}})$，得出$\\sigma_{\\mathrm{true}}\\approx 1.71\\ \\mathrm{GPa}$，且$\\varepsilon_{\\mathrm{true}}$的量值与$\\varepsilon_{\\mathrm{eng}}$相等。因此，Johnson–Cook模型天然地以工程量来表述。\n\nD. 此状态下的真实应变为$\\varepsilon_{\\mathrm{true}}=\\varepsilon_{\\mathrm{eng}}/(1+\\varepsilon_{\\mathrm{eng}})\\approx -0.429$，真实应力为$\\sigma_{\\mathrm{true}}=\\sigma_{\\mathrm{eng}}\\,(1+\\varepsilon_{\\mathrm{eng}})\\approx 0.84\\ \\mathrm{GPa}$。由于Johnson–Cook流动法则是应力的对数形式但应变的代数形式，因此工程应力-真实应变数据是标定的适当基础。\n\nE. 在标定中优先选择真实量的一个关键原因是，对数应变增量是可加的，并且与Cauchy（真实）应力是功共轭的，这确保了塑性功密度$w_{p}=\\int \\sigma:\\mathrm{d}\\varepsilon_{p}$得到一致的表示；这在考虑用于标定Johnson–Cook模型的动态测试中的绝热温升和应变率效应时至关重要。", "solution": "首先将对问题的科学性和逻辑一致性进行验证。\n\n**第1步：提取给定条件**\n- 试样：圆柱形淬火钢。\n- 测试：通过分离式霍普金森压杆（SHPB）进行的动态压缩。\n- 初始几何形状：长度$L_{0}$，横截面积$A_{0}$。\n- 关注的状态：\n    - 工程应变：$\\varepsilon_{\\mathrm{eng}} = -0.30$。\n    - 工程应力：$\\sigma_{\\mathrm{eng}} = 1.20\\ \\mathrm{GPa}$。\n    - 平均应变率：$\\dot{\\varepsilon} \\approx 3\\times 10^{3}\\ \\mathrm{s^{-1}}$。\n- 假设：\n    - 单轴应力。\n    - 动态力平衡。\n    - 塑性不可压缩性（等容流动）：$A\\,L = \\mathrm{const}$。\n    - 鼓形效应可忽略。\n    - 与塑性应变相比，弹性应变可忽略不计。\n    - 绝热变形。\n    - 泰勒-奎尼系数：$\\beta \\approx 0.9$。\n    - 质量密度：$\\rho \\approx 7.8\\times 10^{3}\\ \\mathrm{kg/m^{3}}$。\n    - 比热容：$c \\approx 460\\ \\mathrm{J/(kg\\cdot K)}$。\n- 要求的定义：\n    - 工程应变：$\\varepsilon_{\\mathrm{eng}} = (L - L_{0}) / L_{0}$。\n    - 真实（对数）应变：$\\varepsilon_{\\mathrm{true}} = \\int_{L_{0}}^{L} \\frac{\\mathrm{d}l}{l} = \\ln(L/L_{0})$。\n    - 工程应力：$\\sigma_{\\mathrm{eng}} = F / A_{0}$。\n    - 真实应力：$\\sigma_{\\mathrm{true}} = F / A$。\n- 问题：确定工程量和真实量之间的关系，量化它们之间的差异，并基于功共轭关系论证为标定Johnson–Cook模型选择何种量度。\n\n**第2步：使用提取的给定条件进行验证**\n问题陈述描述了实验固体力学中的一个标准场景，特别是金属的高应变率测试。\n- **科学基础：** 工程应力/应变和真实应力/应变、塑性不可压缩性、绝热温升以及Johnson–Cook模型的概念是连续介质力学和材料科学的基本原理。所提供的数据（$\\varepsilon_{\\mathrm{eng}} = -0.30$，$\\sigma_{\\mathrm{eng}}=1.20\\ \\mathrm{GPa}$，$\\dot{\\varepsilon} \\approx 3\\times 10^{3}\\ \\mathrm{s^{-1}}$）对于淬火钢的动态压缩在物理上是现实的。\n- **适定性：** 问题定义清晰。它提供了进行所需计算和就本构模型标定形成逻辑论证所需的所有必要定义、假设和数据。数值转换的唯一解可以确定。\n- **客观性：** 语言是技术性的、精确的，没有主观或模糊的术语。\n\n问题是自洽且一致的。它没有违反任何物理定律，不是基于错误的前提，并且其设置是可形式化的，并且与所述主题相关。\n\n**第3步：结论与行动**\n问题陈述是**有效的**。将推导一个完整的解。\n\n**应力和应变关系的推导**\n\n工程量和真实量之间的关系直接从提供的定义和塑性不可压缩性假设中推导得出。\n\n1.  **应变转换**：\n    工程应变的定义是 $\\varepsilon_{\\mathrm{eng}} = \\frac{L - L_{0}}{L_{0}}$。整理后得到当前长度 $L$ 与初始长度 $L_{0}$ 的比值：\n    $$ \\frac{L}{L_{0}} = 1 + \\varepsilon_{\\mathrm{eng}} $$\n    真实应变的定义是 $\\varepsilon_{\\mathrm{true}} = \\ln\\left(\\frac{L}{L_{0}}\\right)$。代入 $L/L_{0}$ 的表达式，得到直接关系：\n    $$ \\varepsilon_{\\mathrm{true}} = \\ln(1 + \\varepsilon_{\\mathrm{eng}}) $$\n\n2.  **应力转换**：\n    工程应力和真实应力的定义是 $\\sigma_{\\mathrm{eng}} = \\frac{F}{A_{0}}$ 和 $\\sigma_{\\mathrm{true}} = \\frac{F}{A}$，其中 $F$ 是压缩力，$A_{0}$ 是初始面积，$A$ 是当前的瞬时面积。在任何给定时刻，两个定义中的力 $F$ 是相同的。因此，我们可以写出：\n    $$ F = \\sigma_{\\mathrm{eng}} A_{0} = \\sigma_{\\mathrm{true}} A $$\n    这给出了关系 $\\sigma_{\\mathrm{true}} = \\sigma_{\\mathrm{eng}} \\frac{A_{0}}{A}$。\n    塑性不可压缩性（等容流动）的假设指出，试样的体积保持不变：$V = A L = A_{0} L_{0} = \\mathrm{const}$。由此可得：\n    $$ \\frac{A_{0}}{A} = \\frac{L}{L_{0}} $$\n    将此代入应力关系中，并使用应变关系 $\\frac{L}{L_{0}} = 1 + \\varepsilon_{\\mathrm{eng}}$，我们得到：\n    $$ \\sigma_{\\mathrm{true}} = \\sigma_{\\mathrm{eng}} \\left(\\frac{L}{L_{0}}\\right) = \\sigma_{\\mathrm{eng}} (1 + \\varepsilon_{\\mathrm{eng}}) $$\n\n**数值量化**\n\n使用给定值 $\\varepsilon_{\\mathrm{eng}} = -0.30$ 和 $\\sigma_{\\mathrm{eng}} = 1.20\\ \\mathrm{GPa}$：\n- 真实应变为：\n  $$ \\varepsilon_{\\mathrm{true}} = \\ln(1 + (-0.30)) = \\ln(0.70) \\approx -0.35667 $$\n  保留三位有效数字，$\\varepsilon_{\\mathrm{true}} \\approx -0.357$。\n- 真实应力为：\n  $$ \\sigma_{\\mathrm{true}} = (1.20\\ \\mathrm{GPa}) \\times (1 + (-0.30)) = (1.20\\ \\mathrm{GPa}) \\times 0.70 = 0.84\\ \\mathrm{GPa} $$\n\n数值差异是显著的。真实应变的大小（$|-0.357|$）大于工程应变的大小（$|-0.30|$）。真实应力（$0.84\\ \\mathrm{GPa}$）远低于工程应力（$1.20\\ \\mathrm{GPa}$），这在压缩中是预期的，因为横截面积增加了（$A > A_{0}$）。\n\n**标定量度的理由（Johnson-Cook模型）**\n\n像Johnson-Cook模型这样的本构模型描述了材料的物理响应。这种响应由热力学原理支配。单位体积的塑性功耗散率 $\\dot{w}_{p}$ 是绝热温升的源项。这个功耗散率由真实（Cauchy）应力张量 $\\sigma$ 和塑性应变率张量 $\\dot{\\varepsilon}_{p}$ 的标量积给出。对于单轴情况，这简化为：\n$$ \\dot{w}_{p} = \\sigma_{\\mathrm{true}} \\dot{\\varepsilon}_{\\mathrm{true},p} $$\n总塑性功密度为 $w_{p} = \\int \\sigma_{\\mathrm{true}} \\mathrm{d}\\varepsilon_{\\mathrm{true},p}$。这部分功的一部分 $\\beta$ 转化为热量，导致温度升高 $\\Delta T$，其关系为：\n$$ \\Delta T = \\frac{\\beta}{\\rho c} w_{p} = \\frac{\\beta}{\\rho c} \\int \\sigma_{\\mathrm{true}} \\mathrm{d}\\varepsilon_{\\mathrm{true},p} $$\nJohnson-Cook模型明确包含一个温度软化项 $[1 - (T^*)^m]$，其中温度 $T$ 是一个状态变量。为了正确捕捉材料的行为，必须基于物理上正确的、功共轭的对：真实应力和真实塑性应变来计算温度。使用工程量将导致塑性功的计算不正确，从而导致不正确的温度演化，并因此导致模型参数的标定有缺陷。\n此外，真实应变是根据增量比 $\\mathrm{d}L/L$ 定义的，在有限变形步骤中是可加的。这一性质对于塑性理论中材料状态演化的一致性描述至关重要。工程应变不具备这种可加性。\n因此，对于大变形塑性问题，如Johnson–Cook模型等本构模型，必须在真实应力-真实应变数据中制定和标定。\n\n**选项评估**\n\n**A. 对于给定的压缩状态，在塑性不可压缩性条件下的一致转换关系为$\\varepsilon_{\\mathrm{true}} = \\ln(1+\\varepsilon_{\\mathrm{eng}}) \\approx -0.357$和$\\sigma_{\\mathrm{true}} = \\sigma_{\\mathrm{eng}}\\,(1+\\varepsilon_{\\mathrm{eng}}) \\approx 0.84\\ \\mathrm{GPa}$。由于塑性功$w_{p}=\\int \\sigma_{\\mathrm{true}}\\,\\mathrm{d}\\varepsilon_{p}$在高应变率下主导绝热温升，因此Johnson–Cook模型应根据从SHPB数据中简化得到并参考演化温度的真实应力-真实塑性应变曲线进行标定。**\n转换公式是正确的。数值结果是正确的。将功共轭关系（$\\int \\sigma_{\\mathrm{true}}\\,\\mathrm{d}\\varepsilon_{p}$）、绝热温升以及使用真实应力-真实塑性应变数据进行Johnson-Cook模型标定的必要性联系起来的理由是物理上合理的且描述准确。问题中已说明总应变约等于塑性应变。\n**结论：正确。**\n\n**B. 在高应变率下，时间增量很小，因此即使在大变形情况下，工程量和真实量之间的差异也可以忽略不计；因此可以安全地使用工程应力-工程应变曲线来标定Johnson–Cook模型，而无需进行热修正。**\n这个陈述从根本上是错误的。应变的大小（$\\varepsilon_{\\mathrm{eng}} = -0.30$）是大的，而不是无穷小。在这种应变下，初始构型和当前构型之间的几何差异是巨大的，导致工程量和真实量之间存在显著差异，如上计算所示。变形率与这种几何上的区别无关。因此，使用工程量且不进行热修正的结论是不正确的，会导致一个物理上无效的模型。\n**结论：错误。**\n\n**C. 在压缩状态下，当$\\varepsilon_{\\mathrm{eng}}=-0.30$时，适用转换关系$\\sigma_{\\mathrm{true}}=\\sigma_{\\mathrm{eng}}/(1+\\varepsilon_{\\mathrm{eng}})$，得出$\\sigma_{\\mathrm{true}}\\approx 1.71\\ \\mathrm{GPa}$，且$\\varepsilon_{\\mathrm{true}}$的量值与$\\varepsilon_{\\mathrm{eng}}$相等。因此，Johnson–Cook模型天然地以工程量来表述。**\n应力转换公式 $\\sigma_{\\mathrm{true}}=\\sigma_{\\mathrm{eng}}/(1+\\varepsilon_{\\mathrm{eng}})$ 是不正确的；它与给定的定义和塑性不可压缩性原理不一致。得到的数值是不正确的，并且对于压缩情况在物理上是不合理的（它表明真实应力高于工程应力）。$|\\varepsilon_{\\mathrm{true}}| = |\\varepsilon_{\\mathrm{eng}}|$ 的说法对于有限应变是错误的；我们计算出 $|-0.357| \\neq |-0.30|$。结论是基于多个错误的前提。\n**结论：错误。**\n\n**D. 此状态下的真实应变为$\\varepsilon_{\\mathrm{true}}=\\varepsilon_{\\mathrm{eng}}/(1+\\varepsilon_{\\mathrm{eng}})\\approx -0.429$，真实应力为$\\sigma_{\\mathrm{true}}=\\sigma_{\\mathrm{eng}}\\,(1+\\varepsilon_{\\mathrm{eng}})\\approx 0.84\\ \\mathrm{GPa}$。由于Johnson–Cook流动法则是应力的对数形式但应变的代数形式，因此工程应力-真实应变数据是标定的适当基础。**\n真实应变的公式 $\\varepsilon_{\\mathrm{true}}=\\varepsilon_{\\mathrm{eng}}/(1+\\varepsilon_{\\mathrm{eng}})$ 是不正确的；正确的定义是对数形式。虽然真实应力的计算是正确的，但该陈述包含多个错误。其理由是无稽之谈：Johnson-Cook模型是应变率的对数形式，不是应力，并且对应变具有幂律依赖性。使用混合的“工程应力-真实应变”数据的提议没有物理基础，因为它违反了功共轭原理。\n**结论：错误。**\n\n**E. 在标定中优先选择真实量的一个关键原因是，对数应变增量是可加的，并且与Cauchy（真实）应力是功共轭的，这确保了塑性功密度$w_{p}=\\int \\sigma:\\mathrm{d}\\varepsilon_{p}$得到一致的表示；这在考虑用于标定Johnson–Cook模型的动态测试中的绝热温升和应变率效应时至关重要。**\n该陈述为使用真实量提供了正确的基本理由。它正确地指出了对数应变的可加性和真实（Cauchy）应力与真实应变之间的功共轭关系是主要原因。它准确地将这些原则与在像Johnson-Cook这样的动态塑性模型中为热效应（绝热温升）进行一致能量核算的实际必要性联系起来。使用通用张量符号 $w_{p}=\\int \\sigma:\\mathrm{d}\\varepsilon_{p}$ 是恰当且正确的。\n**结论：正确。**", "answer": "$$\\boxed{AE}$$", "id": "2646979"}, {"introduction": "建立了正确的力学框架后，下一步是在数值上实现本构模型。本练习 [@problem_id:2646978] 聚焦于返回映射算法（return-mapping algorithm），这是计算塑性力学的基石。你将为 Johnson-Cook 模型推导应力与内部变量的隐式更新格式，从而具体了解在模拟的单个时间步内，复杂的材料模型是如何求解的。", "problem": "一根由率相关和温度相关的金属制成的细长杆，在小应变条件下承受单轴拉伸载荷。其本构结构为应变的加法分解，其中弹性部分遵循线性弹性。塑性流动与一维情况下的 von Mises 屈服函数相关联，因此等效应力是柯西应力的绝对值。流动应力遵循 Johnson–Cook (JC) 模型。假设在低温下为等温条件，因此 JC 热软化因子为 1。\n\n考虑从时间 $t^{n}$ 到 $t^{n+1}=t^{n}+\\Delta t$ 的单个时间步，并施加指定的总应变增量。从 小应变弹塑性的基本原理（应变加法分解、线性弹性、关联流动和一致性条件）出发，推导在恒定总应变增量下单轴应力的隐式返回映射更新，并明确说明 Johnson–Cook 模型中的应变率项如何进入标量一致性条件。然后，推导塑性乘子增量的 Newton–Raphson 迭代法。\n\n该时间步的数据：\n- 杨氏模量 $E = 210 \\times 10^{3}$ MPa。\n- Johnson–Cook 参数（等温因子 $=1$）：$A = 300$ MPa, $B = 400$ MPa, $n = 0.5$, $C = 0.02$, $\\dot{\\varepsilon}_{0} = 1$ s$^{-1}$。\n- 时间步长 $\\Delta t = 1.0 \\times 10^{-4}$ s。\n- 上一步的塑性应变 $\\varepsilon_{p}^{n} = 0$。\n- 时间步结束时的总应变 $\\varepsilon_{n+1} = 0.003$（单轴拉伸）。\n\n任务：\n1) 从加法分解 $\\varepsilon = \\varepsilon_{e} + \\varepsilon_{p}$、线性弹性 $\\sigma = E \\varepsilon_{e}$ 以及一维 von Mises 塑性模型的关联流动和一致性条件出发，推导塑性应变增量 $\\Delta \\gamma = \\varepsilon_{p}^{n+1} - \\varepsilon_{p}^{n}$ 的标量非线性方程，该方程强制在 $t^{n+1}$ 时刻满足一致性。您的推导必须明确说明 Johnson–Cook 率相关项以及塑性应变率是如何离散化的。\n2) 通过提供残差 $r(\\Delta \\gamma)$ 及其导数 $r'(\\Delta \\gamma)$ 的解析表达式，推导 Newton–Raphson 迭代式 $\\Delta \\gamma^{(k+1)} = \\Delta \\gamma^{(k)} - r(\\Delta \\gamma^{(k)}) / r'(\\Delta \\gamma^{(k)})$。\n3) 使用牛顿迭代法对该标量方程进行数值求解，以获得收敛的 $\\Delta \\gamma$，然后计算更新后的应力 $\\sigma_{n+1}$。以 MPa 为单位表示最终应力，并将您的答案四舍五入至四位有效数字。\n\n答案格式要求：最终答案必须是一个实数值（方框中不带单位）。问题陈述中报告的单位是 MPa，并需四舍五入到四位有效数字。", "solution": "所述问题具有科学依据，提法恰当且客观。这是一个计算非弹性力学中的标准问题，基于连续介质力学的既定原理，并使用了一个明确的本构模型（Johnson-Cook）。所提供的数据是完整的、一致的且物理上合理的。因此，该问题被认为是有效的，并将提供完整的解答。\n\n分析基于一维、小应变、率相关弹塑性的框架。控制关系如下：\n1.  总应变 ($\\varepsilon$) 分解为弹性 ($\\varepsilon_e$) 和塑性 ($\\varepsilon_p$) 部分的加法分解：\n    $$ \\varepsilon = \\varepsilon_e + \\varepsilon_p $$\n2.  关联柯西应力 ($\\sigma$) 与弹性应变的线性弹性（胡克定律）：\n    $$ \\sigma = E \\varepsilon_e $$\n    其中 $E$ 是杨氏模量。\n3.  定义弹性域边界的流动应力 ($\\sigma_Y$) 的 Johnson-Cook (JC) 模型。在指定的等温条件下，模型为：\n    $$ \\sigma_Y(\\varepsilon_p, \\dot{\\varepsilon}_p) = \\left( A + B (\\varepsilon_p)^n \\right) \\left( 1 + C \\ln\\left(\\frac{\\dot{\\varepsilon}_p}{\\dot{\\varepsilon}_0}\\right) \\right) $$\n    其中 $A$、$B$、$n$、$C$ 和 $\\dot{\\varepsilon}_0$ 是材料参数，$\\varepsilon_p$ 是等效塑性应变，$\\dot{\\varepsilon}_p$ 是等效塑性应变率。对于当前的一维拉伸情况，有 $|\\sigma| = \\sigma$，等效塑性应变等于累积塑性应变，等效塑性应变率为 $\\dot{\\varepsilon}_p$。\n\n系统从时间 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的时间演化采用隐式返回映射算法求解。这是一种预测-校正方法。\n\n首先，假设整个应变增量是弹性的，计算弹性试探状态：\n$$ \\sigma_{n+1}^{\\text{trial}} = E (\\varepsilon_{n+1} - \\varepsilon_p^n) $$\n然后，在该试探状态下检查屈服条件。由于这是从未加载状态开始的第一个加载步，$\\varepsilon_p^n = 0$。初始准静态屈服强度为 $\\sigma_Y(\\varepsilon_p=0, \\dot{\\varepsilon}_p \\rightarrow 0) = A$。如果试探应力超过初始屈服强度，则发生塑性流动。\n给定数据：$E = 210 \\times 10^3$ MPa，$\\varepsilon_{n+1} = 0.003$，$\\varepsilon_p^n = 0$。\n$$ \\sigma_{n+1}^{\\text{trial}} = (210 \\times 10^3 \\text{ MPa}) \\times (0.003 - 0) = 630 \\text{ MPa} $$\n初始 JC 屈服应力为 $A = 300$ MPa。由于 $\\sigma_{n+1}^{\\text{trial}} = 630 \\text{ MPa} > A = 300 \\text{ MPa}$，发生了塑性变形，需要进行塑性校正步。\n\n塑性校正步必须强制在 $t^{n+1}$ 时刻满足一致性条件，即最终应力必须位于更新后的屈服面上：\n$$ |\\sigma_{n+1}| - \\sigma_Y(\\varepsilon_{p, n+1}, \\dot{\\varepsilon}_{p, n+1}) = 0 $$\n对于单轴拉伸，这简化为 $\\sigma_{n+1} - \\sigma_Y(\\varepsilon_{p, n+1}, \\dot{\\varepsilon}_{p, n+1}) = 0$。\n\n状态变量按如下方式更新：\n塑性应变增量记为 $\\Delta\\gamma = \\varepsilon_{p, n+1} - \\varepsilon_p^n$。由于我们处于拉伸状态，$\\Delta\\gamma > 0$。\n$t^{n+1}$ 时刻的塑性应变为：$\\varepsilon_{p, n+1} = \\varepsilon_p^n + \\Delta\\gamma$。\n$t^{n+1}$ 时刻的应力通过校正试探应力得到：\n$$ \\sigma_{n+1} = E (\\varepsilon_{e, n+1}) = E (\\varepsilon_{n+1} - \\varepsilon_{p, n+1}) = E (\\varepsilon_{n+1} - \\varepsilon_p^n - \\Delta\\gamma) = \\sigma_{n+1}^{\\text{trial}} - E \\Delta\\gamma $$\n塑性应变率 $\\dot{\\varepsilon}_{p, n+1}$ 使用后向欧拉离散进行近似，这是隐式格式的标准做法：\n$$ \\dot{\\varepsilon}_{p, n+1} = \\frac{\\Delta\\gamma}{\\Delta t} $$\n\n**任务 1: $\\Delta \\gamma$ 的标量非线性方程推导**\n\n将 $\\sigma_{n+1}$、$\\varepsilon_{p, n+1}$ 和 $\\dot{\\varepsilon}_{p, n+1}$ 的表达式代入一致性条件，得到关于未知数 $\\Delta\\gamma$ 的单个非线性标量方程：\n$$ (\\sigma_{n+1}^{\\text{trial}} - E \\Delta\\gamma) - \\left( A + B (\\varepsilon_p^n + \\Delta\\gamma)^n \\right) \\left( 1 + C \\ln\\left(\\frac{\\Delta\\gamma / \\Delta t}{\\dot{\\varepsilon}_0}\\right) \\right) = 0 $$\n该方程是必须求解 $\\Delta\\gamma$ 的残差函数 $r(\\Delta\\gamma)$：\n$$ r(\\Delta\\gamma) = \\sigma_{n+1}^{\\text{trial}} - E \\Delta\\gamma - \\left( A + B (\\varepsilon_p^n + \\Delta\\gamma)^n \\right) \\left( 1 + C \\ln\\left(\\frac{\\Delta\\gamma}{\\Delta t \\dot{\\varepsilon}_0}\\right) \\right) = 0 $$\n此推导明确显示了涉及 $\\ln(\\dot{\\varepsilon}_p/\\dot{\\varepsilon}_0)$ 的 Johnson-Cook 率相关项如何通过离散化 $\\dot{\\varepsilon}_{p, n+1} = \\Delta\\gamma / \\Delta t$ 进入标量一致性条件。\n\n**任务 2: Newton-Raphson 迭代法推导**\n\n使用 Newton-Raphson 方法求解 $r(\\Delta\\gamma)=0$。迭代更新公式为：\n$$ \\Delta\\gamma^{(k+1)} = \\Delta\\gamma^{(k)} - \\frac{r(\\Delta\\gamma^{(k)})}{r'(\\Delta\\gamma^{(k)})} $$\n其中 $r'(\\Delta\\gamma) = \\frac{dr}{d(\\Delta\\gamma)}$。我们必须求出该导数的解析表达式。\n让我们对 $r(\\Delta\\gamma)$ 关于 $\\Delta\\gamma$ 求导：\n$$ r'(\\Delta\\gamma) = \\frac{d}{d(\\Delta\\gamma)} \\left( \\sigma_{n+1}^{\\text{trial}} - E \\Delta\\gamma \\right) - \\frac{d}{d(\\Delta\\gamma)} \\left[ \\left( A + B (\\varepsilon_p^n + \\Delta\\gamma)^n \\right) \\left( 1 + C \\ln\\left(\\frac{\\Delta\\gamma}{\\Delta t \\dot{\\varepsilon}_0}\\right) \\right) \\right] $$\n第一项就是 $-E$。第二项需要使用乘法法则。设 $u(\\Delta\\gamma) = A + B (\\varepsilon_p^n + \\Delta\\gamma)^n$ 且 $v(\\Delta\\gamma) = 1 + C \\ln(\\frac{\\Delta\\gamma}{\\Delta t \\dot{\\varepsilon}_0})$。\n导数为：\n$$ u'(\\Delta\\gamma) = B n (\\varepsilon_p^n + \\Delta\\gamma)^{n-1} $$\n$$ v'(\\Delta\\gamma) = C \\frac{1}{\\Delta\\gamma/(\\Delta t \\dot{\\varepsilon}_0)} \\frac{1}{\\Delta t \\dot{\\varepsilon}_0} = \\frac{C}{\\Delta\\gamma} $$\n应用乘法法则 $(uv)' = u'v + uv'$：\n$$ \\frac{d}{d(\\Delta\\gamma)} (uv) = B n (\\varepsilon_p^n + \\Delta\\gamma)^{n-1} \\left( 1 + C \\ln\\left(\\frac{\\Delta\\gamma}{\\Delta t \\dot{\\varepsilon}_0}\\right) \\right) + \\left( A + B (\\varepsilon_p^n + \\Delta\\gamma)^n \\right) \\frac{C}{\\Delta\\gamma} $$\n综合所有项，残差的导数为：\n$$ r'(\\Delta\\gamma) = -E - B n (\\varepsilon_p^n + \\Delta\\gamma)^{n-1} \\left( 1 + C \\ln\\left(\\frac{\\Delta\\gamma}{\\Delta t \\dot{\\varepsilon}_0}\\right) \\right) - \\frac{C}{\\Delta\\gamma} \\left( A + B (\\varepsilon_p^n + \\Delta\\gamma)^n \\right) $$\n这为 Newton-Raphson 迭代法提供了所需的导数解析表达式。\n\n**任务 3: 数值求解**\n\n现在我们使用给定数据求解 $\\Delta\\gamma$，然后计算 $\\sigma_{n+1}$。\n数据：$E = 210 \\times 10^3$ MPa, $A = 300$ MPa, $B = 400$ MPa, $n = 0.5$, $C = 0.02$, $\\dot{\\varepsilon}_0 = 1$ s$^{-1}$, $\\Delta t = 10^{-4}$ s, $\\varepsilon_p^n = 0$, $\\varepsilon_{n+1} = 0.003$。\n我们已求得 $\\sigma_{n+1}^{\\text{trial}} = 630$ MPa。\n\n当 $\\varepsilon_p^n=0$ 时，残差方程为：\n$$ r(\\Delta\\gamma) = 630 - 210000 \\Delta\\gamma - \\left( 300 + 400 (\\Delta\\gamma)^{0.5} \\right) \\left( 1 + 0.02 \\ln\\left(\\frac{\\Delta\\gamma}{10^{-4}}\\right) \\right) $$\n导数为：\n$$ r'(\\Delta\\gamma) = -210000 - 400(0.5)(\\Delta\\gamma)^{-0.5} \\left( 1 + 0.02 \\ln\\left(\\frac{\\Delta\\gamma}{10^{-4}}\\right) \\right) - \\frac{0.02}{\\Delta\\gamma} \\left( 300 + 400 (\\Delta\\gamma)^{0.5} \\right) $$\n\n我们初始化 Newton-Raphson 迭代。对 $\\Delta\\gamma$ 的弹性理想塑性估计提供了一个良好的初始猜测：$\\Delta\\gamma^{(0)} \\approx (\\sigma^{\\text{trial}} - A) / E = (630-300)/210000 \\approx 0.00157$。让我们从一个稍简单的值开始，$\\Delta\\gamma^{(0)} = 0.0014$。\n\n迭代 $k=0$：$\\Delta\\gamma^{(0)} = 0.0014$。\n$$ \\ln\\left(\\frac{0.0014}{10^{-4}}\\right) = \\ln(14) \\approx 2.63906 $$\n$$ r(0.0014) = 630 - 210000(0.0014) - (300 + 400\\sqrt{0.0014})(1 + 0.02 \\times 2.63906) $$\n$$ r(0.0014) = 630 - 294 - (300 + 14.9666)(1.05278) \\approx 336 - 314.9666(1.05278) \\approx 336 - 331.583 = 4.417 $$\n$$ r'(0.0014) = -210000 - \\frac{200}{\\sqrt{0.0014}}(1.05278) - \\frac{0.02}{0.0014}(314.9666) $$\n$$ r'(0.0014) \\approx -210000 - 5345.2(1.05278) - 14.2857(314.9666) \\approx -210000 - 5627.5 - 4499.5 = -220127 $$\n校正量：$\\Delta(\\Delta\\gamma)^{(0)} = - \\frac{r}{r'} = - \\frac{4.417}{-220127} \\approx 0.000020066$。\n新猜测值：$\\Delta\\gamma^{(1)} = 0.0014 + 0.000020066 = 0.001420066$。\n\n迭代 $k=1$：$\\Delta\\gamma^{(1)} = 0.001420066$。\n$$ \\ln\\left(\\frac{0.001420066}{10^{-4}}\\right) = \\ln(14.20066) \\approx 2.65329 $$\n$$ r(0.001420066) = 630 - 210000(0.001420066) - (300 + 400\\sqrt{0.001420066})(1 + 0.02 \\times 2.65329) $$\n$$ r(0.001420066) \\approx 630 - 298.214 - (300 + 15.0735)(1.05307) \\approx 331.786 - 315.0735(1.05307) \\approx 331.786 - 331.803 \\approx -0.017 $$\n该残差非常接近于零，表明已经收敛。塑性应变增量的收敛值为 $\\Delta\\gamma \\approx 0.001420$。\n\n最后，计算 $t^{n+1}$ 时刻的更新应力：\n$$ \\sigma_{n+1} = \\sigma_{n+1}^{\\text{trial}} - E \\Delta\\gamma = 630 \\text{ MPa} - (210 \\times 10^3 \\text{ MPa}) \\times 0.001420 $$\n$$ \\sigma_{n+1} = 630 - 298.2 = 331.8 \\text{ MPa} $$\n作为检验，我们可以计算最终状态下的流动应力：\n$$ \\varepsilon_{p, n+1} = 0.001420 $$\n$$ \\dot{\\varepsilon}_{p, n+1} = \\frac{0.001420}{10^{-4}} = 14.2 \\text{ s}^{-1} $$\n$$ \\sigma_Y = (300 + 400(0.001420)^{0.5}) (1 + 0.02 \\ln(\\frac{14.2}{1})) \\approx (300 + 15.0665)(1 + 0.02 \\times 2.6532) $$\n$$ \\sigma_Y \\approx (315.0665)(1.05306) \\approx 331.80 \\text{ MPa} $$\n计算出的应力 $\\sigma_{n+1} = 331.8$ MPa 与流动应力相匹配，证实满足了一致性条件。\n将最终应力四舍五入到四位有效数字，得到 $331.8$ MPa。", "answer": "$$\\boxed{331.8}$$", "id": "2646978"}, {"introduction": "高应变率塑性变形通常是材料失效的前兆。本练习 [@problem_id:2646937] 将框架扩展到延性断裂的建模，介绍了一个类 Johnson-Cook 损伤模型。你将学习如何根据应力、应变率和温度的历史来积分损伤变量的演化，最终通过一个实际的编程任务来预测断裂时间。", "problem": "您需要编写一个完整且可运行的程序，该程序在给定一个经历大变形的缺口拉伸试样随时间变化的场的情况下，计算 Johnson–Cook (JC) 型损伤累积，并确定标量损伤变量达到1时的首次断裂时间。损伤变量被建模为一个瞬时累积速率的时间积分，该速率取决于等效塑性应变率、应力三轴度和同系温度。程序必须是自包含的，并为一组给定的连续函数和材料常数的测试套件计算结果。\n\n基本原理：\n- 令等效塑性应变为 $\\varepsilon_p(t)$，其时间导数为 $\\dot{\\varepsilon}_p(t) = d\\varepsilon_p/dt$。\n- 令应力三轴度为 $\\eta(t)$，定义为平均应力与 von Mises 等效应力之比，它是无量纲的，并在非均匀场下随时间演化，但在此问题中，它被视为一个给定的时间函数。\n- 令同系温度为 $T^\\ast(t)$，定义为 $T^\\ast = (T - T_{\\mathrm{room}})/(T_{\\mathrm{melt}} - T_{\\mathrm{room}})$，它是无量纲的，在物理上现实的条件下位于 $[0,1]$ 区间内。\n- 损伤变量 $D(t)$ 根据以下形式的积分被建模为一个累积的标量\n$$\nD(t) \\equiv \\int_0^t \\frac{\\dot{\\varepsilon}_p(\\tau)}{\\varepsilon_f\\!\\big(\\eta(\\tau), \\dot{\\varepsilon}(\\tau), T^\\ast(\\tau)\\big)} \\, d\\tau,\n$$\n其中 $\\dot{\\varepsilon}(t)$ 是一个代表性等效应变率，在高塑性区域，可以接受取 $\\dot{\\varepsilon}(t) \\equiv \\dot{\\varepsilon}_p(t)$。\n- 断裂被定义为最早的时间 $t_f \\in (0, t_{\\max}]$，使得 $D(t_f) = 1$。如果对于所有 $t \\in [0, t_{\\max}]$ 都有 $D(t)  1$，则返回一个哨兵值。\n\n推导失效应变函数的假设：\n- 假设失效应变 $\\varepsilon_f(\\eta, \\dot{\\varepsilon}, T^\\ast)$ 允许乘法可分离性，即可以分解为三个单调因子的乘积，每个因子分别对应应力三轴度、应变率和同系温度的影响，并由一组材料常数进行缩放。具体地，假设：\n  - 一个三轴度因子 $g_1(\\eta)$，它随着 $\\eta$ 的增加近似指数衰减，并带有一个偏移量以确保在高三轴度下有一个正的下界。\n  - 一个应变率因子 $g_2(\\dot{\\varepsilon}/\\dot{\\varepsilon}_0)$，它与 $\\ln(\\dot{\\varepsilon}/\\dot{\\varepsilon}_0)$ 近似线性变化，以符合量纲不变性和观测到的应变率敏感性，其中 $\\dot{\\varepsilon}_0$ 是一个参考应变率，单位为 $1/\\mathrm{s}$。\n  - 一个温度因子 $g_3(T^\\ast)$，它在 $T^\\ast$ 中近似线性变化，以表示随温度的软化或硬化。\n- 令材料常数为 $D_1, D_2, D_3, D_4, D_5 \\in \\mathbb{R}$ 和 $\\dot{\\varepsilon}_0 > 0$，这些将在下面的测试套件中指定。\n- 使用上述可分离结构和在参考应变率变化下由 $\\ln(\\cdot)$ 编码的不变性，推导一个与这些假设一致的 $\\varepsilon_f(\\eta, \\dot{\\varepsilon}, T^\\ast)$ 的公式。您的算法必须使用此 $\\varepsilon_f$ 来评估损伤累积速率。\n\n数学和数值任务：\n- 实现常微分方程\n$$\n\\frac{dD}{dt} = \\frac{\\dot{\\varepsilon}_p(t)}{\\varepsilon_f\\!\\big(\\eta(t), \\dot{\\varepsilon}_p(t), T^\\ast(t)\\big)}, \\quad D(0) = 0,\n$$\n并确定第一个使得 $D(t_f) = 1$ 的时间 $t_f$。使用带有事件检测（或等效逻辑）的稳健数值积分来精确地分离出首次穿过 $D=1$ 的点。\n- 如果 $\\varepsilon_f(\\eta, \\dot{\\varepsilon}, T^\\ast)$ 由于极端输入而变为非正，则将其限制在一个小的正下界（例如，用一个小的正常数替换它），以确保被积函数的物理容许性。\n- 单位和输出：\n  - 时间 $t$ 的单位必须是秒，$\\mathrm{s}$。\n  - 应变率 $\\dot{\\varepsilon}$ 和 $\\dot{\\varepsilon}_p$ 的单位必须是 $1/\\mathrm{s}$。\n  - 最终结果必须是断裂时间 $t_f$，单位为秒，四舍五入到六位小数。如果在指定的时间范围 $[0, t_{\\max}]$ 内没有发生断裂，则该测试用例返回 $-1.0$。\n\n测试套件：\n对于每个测试用例，程序必须完全按照所述使用提供的函数和常数。在以下所有情况下，代表性等效应变率应取为 $\\dot{\\varepsilon}(t) \\equiv \\dot{\\varepsilon}_p(t)$。\n\n- 测试用例 A（名义缺口、中等应变率、加热）：\n  - 材料常数：$D_1 = 0.05$, $D_2 = 0.30$, $D_3 = -0.5$, $D_4 = 0.02$, $D_5 = 1.0$, $\\dot{\\varepsilon}_0 = 1.0 \\,\\mathrm{s}^{-1}$。\n  - 函数：$\\eta(t) = 0.45 + 0.05 \\sin(120\\, t)$，$\\dot{\\varepsilon}_p(t) = 1500 + 500\\sin(800\\, t)$， $T^\\ast(t) = 0.2 + 0.6 \\left(1 - e^{-t/0.004}\\right)$。\n  - 时间范围：$t_{\\max} = 0.01\\,\\mathrm{s}$。\n\n- 测试用例 B（高三轴度和高应变率、冷态）：\n  - 材料常数：$D_1 = 0.05$, $D_2 = 0.30$, $D_3 = -0.5$, $D_4 = 0.02$, $D_5 = 1.0$, $\\dot{\\varepsilon}_0 = 1.0 \\,\\mathrm{s}^{-1}$。\n  - 函数：$\\eta(t) = 0.6$，$\\dot{\\varepsilon}_p(t) = 10000$， $T^\\ast(t) = 0.0$。\n  - 时间范围：$t_{\\max} = 0.002\\,\\mathrm{s}$。\n\n- 测试用例 C（低三轴度和极低应变率、温和温度、在时间范围内预计不会断裂）：\n  - 材料常数：$D_1 = 0.05$, $D_2 = 0.30$, $D_3 = -0.5$, $D_4 = 0.02$, $D_5 = 1.0$, $\\dot{\\varepsilon}_0 = 1.0 \\,\\mathrm{s}^{-1}$。\n  - 函数：$\\eta(t) = 0.1$，$\\dot{\\varepsilon}_p(t) = 0.2 + 0.05 \\sin(10\\, t)$， $T^\\ast(t) = 0.1$。\n  - 时间范围：$t_{\\max} = 1.0\\,\\mathrm{s}$。\n\n- 测试用例 D（衰减的应变率和三轴度、与温度无关的失效应变、不同的参考应变率）：\n  - 材料常数：$D_1 = 0.10$, $D_2 = 0.20$, $D_3 = -1.0$, $D_4 = 0.01$, $D_5 = 0.0$, $\\dot{\\varepsilon}_0 = 10.0 \\,\\mathrm{s}^{-1}$。\n  - 函数：$\\eta(t) = 0.3 + 0.2 e^{-t/0.005}$，$\\dot{\\varepsilon}_p(t) = 5000 e^{-t/0.003} + 200$， $T^\\ast(t) = 0.5$。\n  - 时间范围：$t_{\\max} = 0.02\\,\\mathrm{s}$。\n\n程序输出规范：\n- 您的程序必须计算每个测试用例的断裂时间 $t_f$，如上定义。\n- 如果对于所有 $t \\in [0,t_{\\max}]$ 都有 $D(t) \\lt 1$，则报告 $-1.0$。\n- 程序必须生成一行输出，其中包含测试用例 A、B、C 和 D 的断裂时间，按此顺序，以逗号分隔的列表形式，并用方括号括起来，每个值以秒为单位四舍五入到恰好六位小数，例如：$[0.000123,0.000045,-1.000000,0.001234]$。", "solution": "问题陈述已经过评估，并被认为是有效的。它在科学上是合理的，在数学上是适定的，并包含了一个唯一且有意义的解所需的所有必要组成部分。我们现在将进行推导和计算。\n\n该问题要求构建一个 Johnson-Cook (JC) 型损伤模型来确定断裂时间。损伤变量 $D(t)$ 根据以下微分方程累积：\n$$\n\\frac{dD}{dt} = \\frac{\\dot{\\varepsilon}_p(t)}{\\varepsilon_f(\\eta(t), \\dot{\\varepsilon}_p(t), T^\\ast(t))}, \\quad D(0) = 0\n$$\n断裂发生在 $t_f \\in (0, t_{\\max}]$ 中使得 $D(t_f) = 1$ 的第一个时间点。中心任务是首先建立失效应变 $\\varepsilon_f$ 的解析形式。\n\n问题假设 $\\varepsilon_f$ 是应力三轴度 $\\eta$、归一化塑性应变率 $\\dot{\\varepsilon}_p/\\dot{\\varepsilon}_0$ 和同系温度 $T^\\ast$ 的乘法可分离函数。根据所提供的定性描述，我们如下构建该函数：\n$\\varepsilon_f(\\eta, \\dot{\\varepsilon}_p, T^\\ast) = g_1(\\eta) \\cdot g_2(\\dot{\\varepsilon}_p/\\dot{\\varepsilon}_0) \\cdot g_3(T^\\ast)$。\n\n$1$. 三轴度因子 $g_1(\\eta)$ 被描述为“随着 $\\eta$ 的增加近似指数衰减，并带有一个偏移量”。这种行为可以通过使用常数 $D_1$、$D_2$ 和 $D_3$ 的标准 JC 形式来捕捉：\n$$\ng_1(\\eta) = D_1 + D_2 \\exp(D_3 \\eta)\n$$\n在这里，$D_1$ 代表偏移量（高三轴度下失效应变的下限），而 $D_2 \\exp(D_3 \\eta)$ 项提供了指数依赖性。对于韧性断裂，通常 $D_3  0$，以确保随着 $\\eta$ 的增加而衰减。\n\n$2$. 应变率因子 $g_2(\\dot{\\varepsilon}_p/\\dot{\\varepsilon}_0)$ 被描述为“与 $\\ln(\\dot{\\varepsilon}_p/\\dot{\\varepsilon}_0)$ 近似线性变化”。这是标准应变率依赖项的直接陈述，其中包含常数 $D_4$：\n$$\ng_2(\\dot{\\varepsilon}_p/\\dot{\\varepsilon}_0) = 1 + D_4 \\ln\\left(\\frac{\\dot{\\varepsilon}_p}{\\dot{\\varepsilon}_0}\\right)\n$$\n无量纲参数 $\\dot{\\varepsilon}_p/\\dot{\\varepsilon}_0$ 和对数形式是许多材料中应变率效应的特征。\n\n$3$. 温度因子 $g_3(T^\\ast)$ 被描述为“在 $T^\\ast$ 中近似线性变化”。这通过常数 $D_5$ 来建模：\n$$\ng_3(T^\\ast) = 1 + D_5 T^\\ast\n$$\n这个线性项解释了热软化或硬化。\n\n结合这些因子，得到失效应变的完整表达式：\n$$\n\\varepsilon_f(\\eta, \\dot{\\varepsilon}_p, T^\\ast) = \\left[ D_1 + D_2 \\exp(D_3 \\eta) \\right] \\left[ 1 + D_4 \\ln\\left(\\frac{\\dot{\\varepsilon}_p}{\\dot{\\varepsilon}_0}\\right) \\right] \\left[ 1 + D_5 T^\\ast \\right]\n$$\n这是公认的 JC 失效模型，我们将用它来进行数值求解。问题要求如果此表达式产生非正值，必须将其限制在一个小的正常数 $\\epsilon_{\\min}$，以维持损伤率的物理容许性。我们将选择 $\\epsilon_{\\min} = 10^{-12}$。\n\n数值解法涉及将 $D(t)$ 的常微分方程从 $t=0$ 积分到 $t=t_{\\max}$。断裂时间 $t_f$ 是积分解 $D(t)$ 达到值 1 的特定时间。这是一个叠加在初值问题上的求根问题。完成此任务的一种高效且稳健的方法是使用具有事件检测功能的常微分方程（ODE）求解器。我们将使用 `scipy.integrate` 库中的 `solve_ivp` 函数。\n\n步骤如下：\n$1$. 对于每个测试用例，定义材料常数（$D_1$ 到 $D_5$，$\\dot{\\varepsilon}_0$）和随时间变化的函数，包括三轴度 $\\eta(t)$、塑性应变率 $\\dot{\\varepsilon}_p(t)$ 和同系温度 $T^\\ast(t)$。\n$2$. 定义常微分方程的右侧，即 $f(t, D) = dD/dt$。该函数以时间 $t$ 为输入，计算 $\\eta(t)$、$\\dot{\\varepsilon}_p(t)$ 和 $T^\\ast(t)$，使用上面推导的公式评估 $\\varepsilon_f$，在必要时进行限制，并返回损伤率 $\\dot{\\varepsilon}_p(t)/\\varepsilon_f$。\n$3$. 定义一个事件函数 `event(t, D) = D[0] - 1`，当满足断裂条件时该函数返回零。我们配置求解器以检测此函数在正方向上穿过零点（$D(t)$ 是单调递增的），并在第一次此类事件发生时终止积分。\n$4$. 在时间跨度 $[0, t_{\\max}]$ 上，以初始条件 $D(0)=0$ 调用 `solve_ivp`。\n$5$. 如果求解器识别出一个事件，该事件的发生时间即为断裂时间 $t_f$。如果积分在没有发生任何事件的情况下完成到 $t_{\\max}$，则表示在整个时间范围内对于所有的 $t$ 都有 $D(t)  1$，该用例的结果报告为 $-1.0$。\n$6$. 所有测试用例的计算断裂时间被收集并按指定格式报告，四舍五入到六位小数。\n这种系统化的方法确保了对所述问题的准确且可验证的解决方案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the Johnson-Cook damage accumulation and determines the fracture time\n    for a suite of test cases.\n    \"\"\"\n    \n    # Small positive constant for clipping the failure strain to ensure physical admissibility.\n    EPSILON_F_MIN = 1e-12\n\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"constants\": {\"D1\": 0.05, \"D2\": 0.30, \"D3\": -0.5, \"D4\": 0.02, \"D5\": 1.0, \"edot0\": 1.0},\n            \"functions\": {\n                \"eta\": lambda t: 0.45 + 0.05 * np.sin(120 * t),\n                \"edot_p\": lambda t: 1500 + 500 * np.sin(800 * t),\n                \"Tstar\": lambda t: 0.2 + 0.6 * (1 - np.exp(-t / 0.004)),\n            },\n            \"t_max\": 0.01,\n        },\n        {\n            \"name\": \"B\",\n            \"constants\": {\"D1\": 0.05, \"D2\": 0.30, \"D3\": -0.5, \"D4\": 0.02, \"D5\": 1.0, \"edot0\": 1.0},\n            \"functions\": {\n                \"eta\": lambda t: 0.6,\n                \"edot_p\": lambda t: 10000.0,\n                \"Tstar\": lambda t: 0.0,\n            },\n            \"t_max\": 0.002,\n        },\n        {\n            \"name\": \"C\",\n            \"constants\": {\"D1\": 0.05, \"D2\": 0.30, \"D3\": -0.5, \"D4\": 0.02, \"D5\": 1.0, \"edot0\": 1.0},\n            \"functions\": {\n                \"eta\": lambda t: 0.1,\n                \"edot_p\": lambda t: 0.2 + 0.05 * np.sin(10 * t),\n                \"Tstar\": lambda t: 0.1,\n            },\n            \"t_max\": 1.0,\n        },\n        {\n            \"name\": \"D\",\n            \"constants\": {\"D1\": 0.10, \"D2\": 0.20, \"D3\": -1.0, \"D4\": 0.01, \"D5\": 0.0, \"edot0\": 10.0},\n            \"functions\": {\n                \"eta\": lambda t: 0.3 + 0.2 * np.exp(-t / 0.005),\n                \"edot_p\": lambda t: 5000 * np.exp(-t / 0.003) + 200,\n                \"Tstar\": lambda t: 0.5,\n            },\n            \"t_max\": 0.02,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        const = case[\"constants\"]\n        funcs = case[\"functions\"]\n        t_max = case[\"t_max\"]\n\n        def dD_dt(t, D):\n            \"\"\"\n            ODE function for damage accumulation rate dD/dt.\n            \"\"\"\n            eta_val = funcs[\"eta\"](t)\n            edot_p_val = funcs[\"edot_p\"](t)\n            Tstar_val = funcs[\"Tstar\"](t)\n\n            # Triaxiality term\n            g1 = const[\"D1\"] + const[\"D2\"] * np.exp(const[\"D3\"] * eta_val)\n            \n            # Strain rate term\n            # Ensure argument of log is positive (edot_p is positive for all cases)\n            edot_ratio = edot_p_val / const[\"edot0\"]\n            g2 = 1.0 + const[\"D4\"] * np.log(edot_ratio)\n            \n            # Temperature term\n            g3 = 1.0 + const[\"D5\"] * Tstar_val\n\n            # Failure strain\n            epsilon_f = g1 * g2 * g3\n\n            # Clip if non-positive\n            epsilon_f_clipped = max(epsilon_f, EPSILON_F_MIN)\n            \n            # Damage rate\n            return edot_p_val / epsilon_f_clipped\n\n        # Event function to detect fracture (D=1)\n        def fracture_event(t, D):\n            return D[0] - 1.0\n\n        fracture_event.terminal = True  # Stop integration at fracture\n        fracture_event.direction = 1     # Event only when D is increasing through 1\n\n        # Solve ODE\n        sol = solve_ivp(\n            fun=dD_dt,\n            t_span=(0, t_max),\n            y0=[0.0],\n            method='RK45',\n            events=fracture_event,\n            dense_output=True,\n            rtol=1e-8,\n            atol=1e-8\n        )\n\n        # Check for fracture event\n        if sol.t_events[0].size > 0:\n            fracture_time = sol.t_events[0][0]\n            results.append(fracture_time)\n        else:\n            results.append(-1.0)\n\n    # Format output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2646937"}]}