{"hands_on_practices": [{"introduction": "在深入研究复杂的偏微分方程之前，通过量纲分析和特征时间尺度来把握耦合现象的本质是至关重要的一步。本练习旨在通过比较机械加载的特征时间尺度与热扩散的特征时间尺度，来判断一个过程是更接近绝热过程还是等温过程。这项练习 [@problem_id:2625916] 为我们提供了一个简单而强大的工具，用于快速分类和理解热力学系统的行为。", "problem": "一个特征长度为 $L$ 的均匀、各向同性、线性热弹性固体，在角频率为 $\\omega$ 的条件下，受到空间均匀、时谐的单轴应变作用。材料属性包括热导率 $k$、质量密度 $\\rho$ 和恒定构型下的比热容 $c$。假设在均匀参考温度附近存在小扰动，因此线性化方法适用。\n\n从为具有傅里叶热传导的热弹性固体所写的局部能量守恒方程出发：瞬态储热与热传导之间的主导阶热平衡由形式为 $\\rho c\\,\\dot{T} = k \\nabla^{2} T + \\text{(热机源)}$ 的方程控制。此处，绝热假设被定义为在一次机械振荡期间热传导可以忽略的状态，因此由机械过程引起的局部温度变化在该时间内不会显著扩散。\n\n仅使用量纲分析和基于以下特征尺度：\n- 机械时间尺度 $t_{\\text{mech}} = 1/\\omega$，\n- 热扩散时间尺度 $t_{\\text{th}} = L^{2}\\rho c/k$，\n\n推导在动态加载期间绝热假设有效性的判据，并通过条件 $t_{\\text{mech}} = t_{\\text{th}}$ 定义划分绝热与非绝热（扩散）行为边界的临界角频率 $\\omega_{c}$。\n\n你的最终答案必须是临界角频率 $\\omega_{c}$ 的闭合形式解析表达式。以弧度/秒为单位表达最终答案。不要在最终的方框表达式中包含单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n首先，逐字提取已知条件：\n- 均匀、各向同性、线性热弹性固体。\n- 特征长度 $L$。\n- 在角频率 $\\omega$ 下的空间均匀、时谐单轴应变。\n- 材料属性：热导率 $k$、质量密度 $\\rho$ 和恒定构型下的比热容 $c$。\n- 均匀参考温度附近的小扰动。\n- 局部能量守恒：$\\rho c\\,\\dot{T} = k \\nabla^{2} T + \\text{(热机源)}$。\n- 绝热假设定义：在一次机械振荡期间，热传导可以忽略。\n- 机械时间尺度：$t_{\\text{mech}} = 1/\\omega$。\n- 热扩散时间尺度：$t_{\\text{th}} = L^{2}\\rho c/k$。\n- 任务：推导绝热假设的有效性判据，并通过条件 $t_{\\text{mech}} = t_{\\text{th}}$ 定义划分绝热与非绝热行为边界的临界角频率 $\\omega_{c}$。\n\n第二，验证问题：\n该问题在科学上植根于连续介质力学和热传导的原理，特别是在已建立的动态热弹性理论框架内。所提供的能量平衡方程是一个标准公式。机械和热时间尺度的定义是正确的，并且对于此类耦合问题的量纲分析至关重要。这是一个适定的问题，提供了清晰明确的指令和定义，可以导出一个唯一的解。所有术语都有客观的定义，前提条件是自洽且一致的。该问题没有违反任何无效性标准；它是物理学和工程学中一个标准的、基本的问题，旨在检验对特征时间尺度的理解。\n\n因此，该问题被认定为有效。将构建解答。\n\n目标是推导临界角频率 $\\omega_{c}$ 的表达式，该频率标志着动态加载下热弹性固体中绝热与非绝热（扩散）热响应之间的过渡。该推导将基于问题陈述中提供的两个特征时间尺度的比较。\n\n机械时间尺度 $t_{\\text{mech}}$ 代表单个机械周期的特征持续时间。它由施加应变的角频率的倒数给出：\n$$t_{\\text{mech}} = \\frac{1}{\\omega}$$\n热扩散时间尺度 $t_{\\text{th}}$ 代表热量在固体的特征长度 $L$ 上扩散所需的特征时间。它由下式给出：\n$$t_{\\text{th}} = \\frac{L^{2}\\rho c}{k}$$\n该时间尺度由瞬态热传导方程 $\\rho c\\,\\dot{T} = k \\nabla^{2} T$ 的量纲分析得出，其中量 $\\alpha = k/(\\rho c)$ 是热扩散率。\n\n如前所述，绝热假设适用于在一次机械振荡期间热传导可以忽略的情况。这意味着由机械应变引起的温度变化在一个周期内没有足够的时间扩散开来并与周围环境达到平衡。要实现这一点，热扩散所需的时间必须显著长于机械过程的时间。在数学上，该条件表示为：\n$$t_{\\text{th}} \\gg t_{\\text{mech}}$$\n代入时间尺度的定义，得到绝热状态的判据：\n$$\\frac{L^{2}\\rho c}{k} \\gg \\frac{1}{\\omega}$$\n这个不等式可以重新整理，用角频率来表示该条件：\n$$\\omega \\gg \\frac{k}{L^{2}\\rho c}$$\n这表明绝热状态对应于高频振荡。\n\n相反，当机械过程足够慢，以至于在一个周期内发生显著的热扩散时，就会出现非绝热或扩散状态。这使得系统能够与其周围环境保持或接近热平衡。该条件描述为：\n$$t_{\\text{th}} \\ll t_{\\text{mech}}$$\n这对应于低频振荡：\n$$\\omega \\ll \\frac{k}{L^{2}\\rho c}$$\n\n问题要求定义一个临界角频率 $\\omega_{c}$，它划分了这两种状态之间的边界。这个边界自然地由两个特征时间尺度相等的条件定义：\n$$t_{\\text{th}} = t_{\\text{mech}}$$\n通过在此临界频率 $\\omega = \\omega_{c}$ 处代入 $t_{\\text{th}}$ 和 $t_{\\text{mech}}$ 的表达式，我们得到 $\\omega_{c}$ 的定义方程：\n$$\\frac{L^{2}\\rho c}{k} = \\frac{1}{\\omega_{c}}$$\n对此方程求解临界角频率 $\\omega_{c}$ 是一个代数重排的问题：\n$$\\omega_{c} = \\frac{k}{L^{2}\\rho c}$$\n该表达式代表了机械加载的特征时间等于热量穿过物体的热扩散特征时间时的角频率。它在动态热弹性理论中作为一个基本参数，经常出现在一个无量纲频率（如用于振荡流的佩克莱特数）的分母中，该频率控制着从等温到绝热行为的过渡。该表达式的单位是秒的倒数（$\\text{s}^{-1}$），这对于角频率是正确的。", "answer": "$$\n\\boxed{\\frac{k}{L^{2} \\rho c}}\n$$", "id": "2625916"}, {"introduction": "在掌握了系统行为的一般分类方法之后，本练习将挑战您将基本原理应用于一个具体的边界值问题。您需要推导在一个受热且受到机械约束的各向异性杆件内部的应力状态。这项练习 [@problem_id:2625954] 展示了如何通过系统地应用平衡方程、运动学关系、本构定律和边界条件，将一个看似复杂的问题简化，并最终得到一个简洁而富有洞察力的结果。", "problem": "一根半径为 $R$、长度为 $L$ 的均质实心圆柱杆由线性热弹性、横观各向同性固体材料制成，其材料对称轴与圆柱轴线（取为 $z$ 轴）重合。该材料的特性由以下参数描述：沿轴线的杨氏模量 $E_{L}$、横观平面内的杨氏模量 $E_{T}$、泊松比 $\\nu_{TL}$（由轴向应力引起的横向应变）和 $\\nu_{TT}$（由正交平面内方向的应力引起的某一平面内方向的横向应变），以及热膨胀系数 $\\alpha_{L}$（轴向）和 $\\alpha_{T}$（横向）。互易条件 $\\nu_{TL}/E_{L}=\\nu_{LT}/E_{T}$ 成立，其中 $\\nu_{LT}$ 表示由横向应力引起的轴向应变。该杆从无应力参考状态经历均匀温升 $\\Delta T$。不存在体力。\n\n$r=R$ 处的圆柱侧表面无面力。该杆受到轴向约束，使得端部支撑强制其宏观轴向伸长为零。该杆足够细长，可以忽略端部效应，并且内部应力和应变场可视为在轴向上均匀且在横截面上轴对称。假设小应变、小转动和线性热弹性。\n\n仅从线性动量平衡、小应变运动学关系以及横观各向同性固体的线性各向异性热弹性柔度形式的定义出发，确定内部的轴向应力 $\\sigma_{z}$ 和横截面上的径向应力 $\\sigma_{r}(r)$。将最终结果表示为包含给定材料常数和温升的解析表达式。将轴向应力和径向应力报告为一个双元素行矩阵 $\\big[\\sigma_{z}\\ \\sigma_{r}\\big]$。在国际单位制（SI）中，以帕斯卡表示应力。如果任何简化消除了对某些给定常数的依赖，请在最终表达式中反映出来。最终答案必须是单一的解析表达式；不要提供不等式或方程式。", "solution": "用户希望我扮演一位严格的俄罗斯理工科教授，并解决一个固体力学问题。\n\n这是我的计划：\n1.  **验证问题陈述：**\n    *   **第 1 步：提取已知条件：** 我将逐字列出所有提供的信息。\n        *   几何形状：均质实心圆柱杆，半径 $R$，长度 $L$。\n        *   材料：线性热弹性、横观各向同性。\n        *   对称轴：与圆柱轴线（$z$ 轴）重合。\n        *   材料常数：$E_{L}$、 $E_{T}$、 $\\nu_{TL}$、 $\\nu_{TT}$、 $\\alpha_{L}$、 $\\alpha_{T}$。\n        *   互易条件：$\\nu_{TL}/E_{L}=\\nu_{LT}/E_{T}$。\n        *   载荷：从无应力参考状态开始的均匀温升 $\\Delta T$。\n        *   体力：无。\n        *   边界条件：\n            *   侧表面（$r=R$）无面力。\n            *   端部支撑强制宏观轴向伸长为零。\n        *   假设：\n            *   细长杆，忽略端部效应。\n            *   应力和应变场在轴向（$z$）上均匀。\n            *   应力和应变场在横截面上轴对称。\n            *   小应变、小转动。\n            *   线性热弹性。\n    *   **第 2 步：使用提取的已知条件进行验证：** 我将根据标准检查问题的有效性。\n        *   **科学依据：** 该问题涉及横观各向同性材料的线性热弹性，这是连续介质力学和固体力学中的一个标准课题。相关概念（杨氏模量、泊松比、热膨胀系数、应力、应变、动量平衡）都是基础性的。该设置在物理上是现实的。它是科学合理的。\n        *   **适定性：** 问题提供了足够的材料属性、几何信息、边界条件和载荷来确定应力状态。$z$ 向均匀性和轴对称性的假设将问题简化为径向坐标上的一维问题，这对于此类设置是标准的。“宏观轴向伸长为零”是一个明确定义的约束条件。问题似乎是适定的。\n        *   **客观性：** 语言技术性强且精确。没有主观陈述。\n        *   **不完整或矛盾：** 所提供的信息似乎是完整的。互易关系是各向异性材料的标准一致性条件。约束条件似乎是一致的。\n        *   **不切实际或不可行：** 这些条件是工程分析中的标准理想化。“足够细长”是一个定性但标准的假设，用于证明忽略端部效应的合理性（圣维南原理）。“宏观轴向伸长为零”是一个标准的边界条件。问题似乎是可行的。\n        *   **不适定或结构不良：** 问题以逻辑方式构建，在给定假设下可以得出应力场的唯一解。\n        *   **伪深奥、琐碎、同义反复：** 问题要求从第一性原理（动量平衡、运动学、本构律）推导，这在固体力学中是一个不平凡的练习。它不是伪深奥的。\n        *   **超出科学可验证性：** 该问题是弹性理论中标准的教科书式问题，完全可以通过数学推导进行验证。\n    *   **第 3 步：结论和行动：** 问题有效。我将着手解决它。\n\n2.  **解决问题（如果有效）：**\n    *   **控制方程：**\n        *   **线性动量平衡：** 在柱坐标系 $(r, \\theta, z)$ 中，无体力且处于平衡状态（$\\partial/\\partial t = 0$），方程为：\n            $$ \\frac{\\partial \\sigma_{rr}}{\\partial r} + \\frac{1}{r}\\frac{\\partial \\sigma_{r\\theta}}{\\partial \\theta} + \\frac{\\partial \\sigma_{rz}}{\\partial z} + \\frac{\\sigma_{rr} - \\sigma_{\\theta\\theta}}{r} = 0 $$\n            $$ \\frac{\\partial \\sigma_{r\\theta}}{\\partial r} + \\frac{1}{r}\\frac{\\partial \\sigma_{\\theta\\theta}}{\\partial \\theta} + \\frac{\\partial \\sigma_{\\theta z}}{\\partial z} + \\frac{2\\sigma_{r\\theta}}{r} = 0 $$\n            $$ \\frac{\\partial \\sigma_{rz}}{\\partial r} + \\frac{1}{r}\\frac{\\partial \\sigma_{\\theta z}}{\\partial \\theta} + \\frac{\\partial \\sigma_{zz}}{\\partial z} + \\frac{\\sigma_{rz}}{r} = 0 $$\n        *   **运动学关系（应变-位移）：** 对于柱坐标系中的小应变，位移矢量为 $\\mathbf{u} = u_r(r, \\theta, z) \\mathbf{e}_r + u_\\theta(r, \\theta, z) \\mathbf{e}_\\theta + u_z(r, \\theta, z) \\mathbf{e}_z$：\n            $$ \\epsilon_{rr} = \\frac{\\partial u_r}{\\partial r} $$\n            $$ \\epsilon_{\\theta\\theta} = \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{u_r}{r} $$\n            $$ \\epsilon_{zz} = \\frac{\\partial u_z}{\\partial z} $$\n            $$ \\epsilon_{r\\theta} = \\frac{1}{2} \\left( \\frac{1}{r}\\frac{\\partial u_r}{\\partial \\theta} + \\frac{\\partial u_\\theta}{\\partial r} - \\frac{u_\\theta}{r} \\right) $$\n            $$ \\epsilon_{\\theta z} = \\frac{1}{2} \\left( \\frac{\\partial u_\\theta}{\\partial z} + \\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta} \\right) $$\n            $$ \\epsilon_{rz} = \\frac{1}{2} \\left( \\frac{\\partial u_r}{\\partial z} + \\frac{\\partial u_z}{\\partial r} \\right) $$\n        *   **本构律（横观各向同性热弹性）：** 问题指定了柔度形式。对称轴是 $z$ 轴。横观平面是 $r-\\theta$ 平面。应变张量 $\\boldsymbol{\\epsilon}$ 与应力张量 $\\boldsymbol{\\sigma}$ 和温度变化 $\\Delta T$ 相关。在矩阵形式中（使用 Voigt 记法，其中 $1 \\to rr, 2 \\to \\theta\\theta, 3 \\to zz, 4 \\to \\theta z, 5 \\to rz, 6 \\to r\\theta$）：\n            $$ \\begin{pmatrix} \\epsilon_{rr} \\\\ \\epsilon_{\\theta\\theta} \\\\ \\epsilon_{zz} \\\\ 2\\epsilon_{\\theta z} \\\\ 2\\epsilon_{rz} \\\\ 2\\epsilon_{r\\theta} \\end{pmatrix} = \\begin{pmatrix} 1/E_T  -\\nu_{TT}/E_T  -\\nu_{LT}/E_T  0  0  0 \\\\ -\\nu_{TT}/E_T  1/E_T  -\\nu_{LT}/E_T  0  0  0 \\\\ -\\nu_{TL}/E_L  -\\nu_{TL}/E_L  1/E_L  0  0  0 \\\\ 0  0  0  1/G_{LT}  0  0 \\\\ 0  0  0  0  1/G_{LT}  0 \\\\ 0  0  0  0  0  1/G_{TT} \\end{pmatrix} \\begin{pmatrix} \\sigma_{rr} \\\\ \\sigma_{\\theta\\theta} \\\\ \\sigma_{zz} \\\\ \\sigma_{\\theta z} \\\\ \\sigma_{rz} \\\\ \\sigma_{r\\theta} \\end{pmatrix} + \\begin{pmatrix} \\alpha_T \\\\ \\alpha_T \\\\ \\alpha_L \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\Delta T $$\n            其中 $G_{TT} = E_T / (2(1+\\nu_{TT}))$ 是横向剪切模量。$G_{LT}$ 是纵向平面内的剪切模量。我应该写出各个方程。\n            $$ \\epsilon_{rr} = \\frac{1}{E_T}(\\sigma_{rr} - \\nu_{TT}\\sigma_{\\theta\\theta}) - \\frac{\\nu_{LT}}{E_T}\\sigma_{zz} + \\alpha_T \\Delta T $$\n            $$ \\epsilon_{\\theta\\theta} = \\frac{1}{E_T}(\\sigma_{\\theta\\theta} - \\nu_{TT}\\sigma_{rr}) - \\frac{\\nu_{LT}}{E_T}\\sigma_{zz} + \\alpha_T \\Delta T $$\n            $$ \\epsilon_{zz} = \\frac{1}{E_L}\\sigma_{zz} - \\frac{\\nu_{TL}}{E_L}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) + \\alpha_L \\Delta T $$\n            问题给出了互易性 $\\nu_{TL}/E_L = \\nu_{LT}/E_T$。我可以用它来简化前两个方程：\n            $$ \\epsilon_{rr} = \\frac{1}{E_T}(\\sigma_{rr} - \\nu_{TT}\\sigma_{\\theta\\theta}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T $$\n            $$ \\epsilon_{\\theta\\theta} = \\frac{1}{E_T}(\\sigma_{\\theta\\theta} - \\nu_{TT}\\sigma_{rr}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T $$\n\n    *   **应用假设进行简化：**\n        *   **轴对称性：** 所有量都与 $\\theta$ 无关。$\\partial/\\partial\\theta = 0$。这意味着 $u_\\theta = 0$（无扭转），并且所有涉及 $\\theta$ 的剪切应力和应变为零：$\\sigma_{r\\theta} = \\sigma_{\\theta z} = \\epsilon_{r\\theta} = \\epsilon_{\\theta z} = 0$。\n        *   **$z$向均匀性：** 所有量都与 $z$ 无关。$\\partial/\\partial z = 0$。\n        *   **推论：**\n            *   由 $z$ 向均匀性可知：$\\partial \\sigma_{rz}/\\partial z = 0$ 和 $\\partial \\sigma_{zz}/\\partial z = 0$。\n            *   动量平衡方程简化为：\n                1.  $\\frac{d \\sigma_{rr}}{d r} + \\frac{\\sigma_{rr} - \\sigma_{\\theta\\theta}}{r} = 0$（径向平衡）\n                2.  $0=0$（切向平衡）\n                3.  $\\frac{d \\sigma_{rz}}{d r} + \\frac{\\sigma_{rz}}{r} = 0$（轴向平衡）\n            *   运动学关系变为：\n                *   $\\epsilon_{rr} = \\frac{d u_r}{d r}$\n                *   $\\epsilon_{\\theta\\theta} = \\frac{u_r}{r}$\n                *   $\\epsilon_{zz} = \\frac{\\partial u_z}{\\partial z}$\n                *   $\\epsilon_{rz} = \\frac{1}{2} (\\frac{\\partial u_r}{\\partial z} + \\frac{\\partial u_z}{\\partial r}) = \\frac{1}{2}\\frac{d u_z}{d r}$（因为 $u_r$ 只是 $r$ 的函数）。\n            *   第三个平衡方程 $\\frac{d \\sigma_{rz}}{d r} + \\frac{\\sigma_{rz}}{r} = 0$可以改写为 $\\frac{1}{r}\\frac{d(r\\sigma_{rz})}{dr} = 0$。积分得到 $r\\sigma_{rz} = C_1$。对于实心圆柱体， $r=0$ 处的应力必须是有限的，所以 $C_1=0$，这意味着 $\\sigma_{rz} = 0$ 在各处都成立。\n            *   由于 $\\sigma_{rz}=0$，我们有 $\\epsilon_{rz}=0$。从运动学角度看，这意味着 $\\frac{d u_z}{d r} = 0$，所以 $u_z$ 不是 $r$ 的函数。\n            *   由于我们假设了 $z$ 向均匀性，$u_z$ 不能以局部变化的方式依赖于 $z$。位移 $u_z$ 只能是 $u_z(z) = C_2 z + C_3$ 的形式。\n            *   然后，轴向应变 $\\epsilon_{zz} = \\frac{d u_z}{d z} = C_2$。这意味着 $\\epsilon_{zz}$ 在整个杆上是一个常数。\n\n    *   **简化状态总结：**\n        *   应力分量：$\\sigma_{rr}(r)$, $\\sigma_{\\theta\\theta}(r)$, $\\sigma_{zz}$。剪应力为零。\n        *   应变分量：$\\epsilon_{rr}(r)$, $\\epsilon_{\\theta\\theta}(r)$, $\\epsilon_{zz} = \\text{const}$。剪应变为零。\n        *   位移场：$u_r(r)$, $u_z(z)$, $u_\\theta=0$。\n        *   控制方程：\n            1.  平衡方程：$\\frac{d \\sigma_{rr}}{d r} + \\frac{\\sigma_{rr} - \\sigma_{\\theta\\theta}}{r} = 0$\n            2.  协调方程：从运动学可知，$\\epsilon_{rr} = \\frac{d u_r}{d r}$ 和 $\\epsilon_{\\theta\\theta} = \\frac{u_r}{r}$。这意味着存在一个协调关系：$\\epsilon_{rr} = \\frac{d}{dr}(r\\epsilon_{\\theta\\theta}) = \\epsilon_{\\theta\\theta} + r\\frac{d\\epsilon_{\\theta\\theta}}{dr}$。\n            3.  本构关系：\n                $$ \\epsilon_{rr} = \\frac{1}{E_T}(\\sigma_{rr} - \\nu_{TT}\\sigma_{\\theta\\theta}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T $$\n                $$ \\epsilon_{\\theta\\theta} = \\frac{1}{E_T}(\\sigma_{\\theta\\theta} - \\nu_{TT}\\sigma_{rr}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T $$\n                $$ \\epsilon_{zz} = \\frac{1}{E_L}\\sigma_{zz} - \\frac{\\nu_{TL}}{E_L}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) + \\alpha_L \\Delta T $$\n\n    *   **边界和全局条件：**\n        1.  无面力的侧表面：$\\sigma_{rr}(R) = 0$。\n        2.  宏观轴向伸长为零：总长度变化为零。\n            $$ \\int_0^L \\epsilon_{zz} dz = u_z(L) - u_z(0) = 0 $$\n            由于 $\\epsilon_{zz}$ 是常数，这意味着 $\\epsilon_{zz} L = 0$。因为 $L \\ne 0$，我们必须有 $\\epsilon_{zz} = 0$。\n\n    *   **求解系统：**\n        *   我们有 $\\epsilon_{zz} = 0$。第三个本构方程变为：\n            $$ 0 = \\frac{1}{E_L}\\sigma_{zz} - \\frac{\\nu_{TL}}{E_L}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) + \\alpha_L \\Delta T $$\n            让我们求解 $\\sigma_{zz}$：\n            $$ \\sigma_{zz} = \\nu_{TL}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) - E_L \\alpha_L \\Delta T \\quad (*)$$\n            这表明 $\\sigma_{zz}$ 是通过 $\\sigma_{rr}$ 和 $\\sigma_{\\theta\\theta}$ 成为 $r$ 的函数。然而，问题陈述说“应力和应变场可视为在轴向上均匀”，这意味着 $\\sigma_{zz}$ 必须相对于 $z$ 是常数。那么关于 $r$ 呢？“轴向均匀”的假设通常被解释为类平面应变条件，其中场仅依赖于 $r, \\theta$。但在这种情况下，$\\sigma_{zz}$ 是否也与 $r$ 无关？\n            让我们将 $\\sigma_{zz}$ 代入其他两个本构方程中。\n            让我们首先用应变 $\\epsilon_{rr}$ 和 $\\epsilon_{\\theta\\theta}$ 来表示 $\\sigma_{rr}$ 和 $\\sigma_{\\theta\\theta}$。\n            从前两个应变本构方程：\n            $\\epsilon_{rr} + \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} - \\alpha_T \\Delta T = \\frac{1}{E_T}(\\sigma_{rr} - \\nu_{TT}\\sigma_{\\theta\\theta})$\n            $\\epsilon_{\\theta\\theta} + \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} - \\alpha_T \\Delta T = \\frac{1}{E_T}(\\sigma_{\\theta\\theta} - \\nu_{TT}\\sigma_{rr})$\n            \n            这变得很 messy。一个更好的方法是求解应力。让我们使用应变。\n            我们有 $\\epsilon_{rr} = d(r\\epsilon_{\\theta\\theta})/dr$。\n            将 $\\epsilon_{rr}$ 和 $\\epsilon_{\\theta\\theta}$ 的本构律代入这个协调关系中。\n            $$ \\frac{1}{E_T}(\\sigma_{rr} - \\nu_{TT}\\sigma_{\\theta\\theta}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T = \\frac{d}{dr} \\left[ r \\left( \\frac{1}{E_T}(\\sigma_{\\theta\\theta} - \\nu_{TT}\\sigma_{rr}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T \\right) \\right] $$\n            \n            现在，我们对 $\\sigma_{zz}$ 了解多少？让我们非常仔细地重读问题陈述。“内部应力和应变场可视为在轴向上均匀，在横截面上轴对称”。\n            这意味着 $\\sigma_{ij} = \\sigma_{ij}(r)$ 和 $\\epsilon_{ij} = \\epsilon_{ij}(r)$。\n            所以我推断 $\\epsilon_{zz}$ 是常数是正确的。结论 $\\epsilon_{zz}=0$ 也是正确的。\n            如果 $\\sigma_{zz}$ 依赖于 $r$，那么 $u_z$ 必须依赖于 $r$。让我们检查 $\\epsilon_{rz} = \\frac{1}{2}\\frac{\\partial u_z}{\\partial r} = 0$。这意味着 $u_z$ 只是 $z$ 的函数。所以 $u_z = u_z(z)$。\n            但从 $\\epsilon_{zz} = \\partial u_z / \\partial z = 0$ 可得 $u_z(z) = \\text{const}$。比方说 $u_z=0$（通过固定一端）。\n            现在，让我们再次看一下 $\\epsilon_{zz}=0$ 的第三个本构方程：\n            $$ 0 = \\frac{1}{E_L}\\sigma_{zz} - \\frac{\\nu_{TL}}{E_L}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) + \\alpha_L \\Delta T $$\n            如果 $\\sigma_{rr}$ 和 $\\sigma_{\\theta\\theta}$ 依赖于 $r$，那么 $\\sigma_{zz}$ 也必须依赖于 $r$。\n            让我们重新检查平衡方程。\n            $\\frac{\\partial \\sigma_{zz}}{\\partial z} = 0$。好的。\n            $\\frac{\\partial \\sigma_{rz}}{\\partial r} + \\frac{\\sigma_{rz}}{r} + \\frac{\\partial \\sigma_{\\theta z}}{\\partial \\theta} + \\frac{\\partial \\sigma_{zz}}{\\partial z} = 0$。\n            在轴对称和应力 $\\partial/\\partial z=0$ 的条件下，这简化为 $\\frac{d\\sigma_{rz}}{dr} + \\frac{\\sigma_{rz}}{r} = 0$，这给出 $\\sigma_{rz}=0$。这是一致的。\n            现在 $\\epsilon_{rz}$ 的运动学关系是 $\\epsilon_{rz} = \\frac{1}{2}(\\frac{\\partial u_r}{\\partial z} + \\frac{\\partial u_z}{\\partial r})$。\n            由于应力不依赖于 $z$，应变也不依赖于 $z$（对于均匀温升），所以位移必须是 $u_r(r)$, $u_\\theta=0$, $u_z = C z + D(r)$ 的形式。为了使应变不依赖于 $z$，我们需要 $\\epsilon_{zz} = C$ 和 $\\epsilon_{rz} = \\frac{1}{2} \\frac{dD}{dr}$。\n            轴向约束 $\\int_0^L \\epsilon_{zz} dz = 0$ 意味着 $C \\cdot L = 0$，所以 $C=0$ 且 $\\epsilon_{zz}=0$。\n            条件 $\\sigma_{rz}=0$ 意味着 $\\epsilon_{rz}$ 也为零（因为 $G_{LT} \\ne 0$）。所以 $\\frac{dD}{dr} = 0$，这意味着 $D$ 是一个常数。我们可以将 $D=0$ 设为一个刚体运动。\n            所以 $u_z=0$ 在各处都成立。\n            而 $u_r = u_r(r)$。\n            所以我的简化状态是正确的。所有应力（$\\sigma_{rr}, \\sigma_{\\theta\\theta}, \\sigma_{zz}$）都只是 $r$ 的函数。\n            \n            让我们回到系统求解。\n            该问题本质上是一个 $\\epsilon_z=0$ 的广义平面应变问题。\n            让我们使用平衡方程：$\\sigma_{\\theta\\theta} = \\sigma_{rr} + r \\frac{d\\sigma_{rr}}{dr} = \\frac{d(r\\sigma_{rr})}{dr}$。\n            将此代入径向和环向应变的本构方程。\n            首先，让我们将其代入从 $\\epsilon_{zz}=0$ 得到的 $\\sigma_{zz}$ 表达式中：\n            $$ \\sigma_{zz} = \\nu_{TL}(\\sigma_{rr} + \\frac{d(r\\sigma_{rr})}{dr}) - E_L \\alpha_L \\Delta T $$\n            现在，让我们使用以应力表示的协调方程。使用位移通常更容易。\n            令 $u_r(r)$ 为径向位移。\n            $\\epsilon_{rr} = \\frac{du_r}{dr}$，$\\epsilon_{\\theta\\theta} = \\frac{u_r}{r}$。\n            让我们用 $u_r$ 和 $\\sigma_{zz}$ 来表示应力。\n            从前两个应变本构方程：\n            $$ \\epsilon_{rr} = \\frac{du_r}{dr} = \\frac{1}{E_T}(\\sigma_{rr} - \\nu_{TT}\\sigma_{\\theta\\theta}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T $$\n            $$ \\epsilon_{\\theta\\theta} = \\frac{u_r}{r} = \\frac{1}{E_T}(\\sigma_{\\theta\\theta} - \\nu_{TT}\\sigma_{rr}) - \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + \\alpha_T \\Delta T $$\n            让我们解这个关于 $\\sigma_{rr}$ 和 $\\sigma_{\\theta\\theta}$ 的系统。\n            将它们相加：\n            $(\\frac{du_r}{dr} + \\frac{u_r}{r}) = \\frac{1-\\nu_{TT}}{E_T}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) - 2\\frac{\\nu_{TL}}{E_L}\\sigma_{zz} + 2\\alpha_T \\Delta T$\n            将它们相减：\n            $(\\frac{du_r}{dr} - \\frac{u_r}{r}) = \\frac{1+\\nu_{TT}}{E_T}(\\sigma_{rr} - \\sigma_{\\theta\\theta})$\n            \n            平衡方程是 $\\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr}-\\sigma_{\\theta\\theta}}{r}=0$。\n            所以 $\\sigma_{rr} - \\sigma_{\\theta\\theta} = -r \\frac{d\\sigma_{rr}}{dr}$。\n            将此代入相减后的应变方程中：\n            $\\frac{du_r}{dr} - \\frac{u_r}{r} = \\frac{1+\\nu_{TT}}{E_T} (-r \\frac{d\\sigma_{rr}}{dr})$\n            \n            这似乎又变得复杂了。一定有一条更简单的路径。\n            问题结构与各向同性圆柱体非常相似，所以让我们尝试模仿那种解法。\n            让我们假设 $\\sigma_{zz}$ 是常数。看看这个假设是否一致。如果 $\\sigma_{zz}$ 是常数，那么从方程（*）可知，$(\\sigma_{rr}+\\sigma_{\\theta\\theta})$ 也必须是常数。\n            令 $\\sigma_{rr} + \\sigma_{\\theta\\theta} = K$（一个常数）。\n            从平衡方程，$\\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr} - (K-\\sigma_{rr})}{r} = 0 \\implies \\frac{d\\sigma_{rr}}{dr} + \\frac{2\\sigma_{rr} - K}{r} = 0$。\n            这是关于 $\\sigma_{rr}(r)$ 的一阶线性常微分方程：\n            $r \\frac{d\\sigma_{rr}}{dr} + 2\\sigma_{rr} = K \\implies \\frac{d(r^2 \\sigma_{rr})}{dr} = K r$。\n            积分得到 $r^2 \\sigma_{rr} = \\frac{K}{2} r^2 + A$，其中 A 是积分常数。\n            所以，$\\sigma_{rr} = \\frac{K}{2} + \\frac{A}{r^2}$。\n            并且 $\\sigma_{\\theta\\theta} = K - \\sigma_{rr} = \\frac{K}{2} - \\frac{A}{r^2}$。\n            \n            对于实心圆柱体，应力在 $r=0$ 处必须是有限的。这要求 $A=0$。\n            如果 $A=0$，那么 $\\sigma_{rr} = \\sigma_{\\theta\\theta} = K/2$。解是在横截面内的一个均匀应力状态。\n            \n            现在让我们检查这是否与所有方程和条件一致。\n            如果 $\\sigma_{rr} = \\sigma_{\\theta\\theta} = \\text{constant}$：\n            1.  平衡方程：$\\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr}-\\sigma_{\\theta\\theta}}{r} = 0 + 0 = 0$。成立。\n            2.  边界条件：$\\sigma_{rr}(R)=0$。这意味着常数必须为零。所以 $\\sigma_{rr}=0$。那么 $\\sigma_{\\theta\\theta}=0$。\n            3.  如果 $\\sigma_{rr}=\\sigma_{\\theta\\theta}=0$，那么从方程（*）：\n                $\\sigma_{zz} = \\nu_{TL}(0+0) - E_L \\alpha_L \\Delta T = -E_L \\alpha_L \\Delta T$。\n            4.  让我们检查应变的本构方程。当 $\\sigma_{rr}=\\sigma_{\\theta\\theta}=0$ 且 $\\sigma_{zz} = -E_L \\alpha_L \\Delta T$ 时：\n                $\\epsilon_{rr} = \\frac{1}{E_T}(0) - \\frac{\\nu_{LT}}{E_T}(-E_L \\alpha_L \\Delta T) + \\alpha_T \\Delta T = \\frac{\\nu_{LT}E_L}{E_T}\\alpha_L \\Delta T + \\alpha_T \\Delta T$。\n                使用互易性 $\\nu_{LT}/E_T = \\nu_{TL}/E_L$，这变成 $\\epsilon_{rr} = \\nu_{TL} \\alpha_L \\Delta T + \\alpha_T \\Delta T$。\n                $\\epsilon_{\\theta\\theta} = \\epsilon_{rr} = (\\nu_{TL} \\alpha_L + \\alpha_T) \\Delta T$。\n            5.  让我们检查运动学。\n                这些应变是协调的吗？我们需要 $\\epsilon_{rr} = \\frac{d(r\\epsilon_{\\theta\\theta})}{dr}$。\n                由于 $\\epsilon_{rr}$ 和 $\\epsilon_{\\theta\\theta}$ 是常数，我们需要 $\\epsilon_{rr} = \\epsilon_{\\theta\\theta} + r \\frac{d\\epsilon_{\\theta\\theta}}{dr} = \\epsilon_{\\theta\\theta} + 0$。\n                所以协调性要求 $\\epsilon_{rr} = \\epsilon_{\\theta\\theta}$。我们的解答满足这一点。这是一致的。\n            \n            所以，解是 $\\sigma_{rr} = 0$，$\\sigma_{\\theta\\theta}=0$，以及 $\\sigma_{zz} = -E_L \\alpha_L \\Delta T$。\n            问题要求的是 $\\sigma_z$ 和 $\\sigma_r(r)$。\n            所以，$\\sigma_z = -E_L \\alpha_L \\Delta T$ 和 $\\sigma_r(r) = 0$。\n            \n            让我们再次仔细重读问题陈述，确保我没有遗漏任何东西。\n            “均质实心圆柱杆...”\n            “线性热弹性、横观各向同性固体...材料对称轴与圆柱轴线重合”\n            “从无应力参考状态经历均匀温升 $\\Delta T$”\n            “无体力”\n            “$r=R$ 处的圆柱侧表面无面力”\n            “杆受到轴向约束，使得端部支撑强制其宏观轴向伸长为零。”\n            “足够细长...忽略端部效应...应力和应变场可视为在轴向上均匀且在横截面上轴对称”\n            \n            这似乎太简单了。我关于 $\\sigma_{zz}$ 是常数的假设是否正确？\n            这个论证依赖于 $(\\sigma_{rr}+\\sigma_{\\theta\\theta})$ 是一个常数的假设。让我们追溯一下这个逻辑。\n            我使用了位移协调关系 $\\epsilon_{rr} = \\frac{d}{dr}(r\\epsilon_{\\theta\\theta})$。\n            让我们使用本构关系：\n            $ \\epsilon_{rr} = C_1 \\sigma_{rr} + C_2 \\sigma_{\\theta\\theta} + f(r) $\n            $ \\epsilon_{\\theta\\theta} = C_2 \\sigma_{rr} + C_1 \\sigma_{\\theta\\theta} + f(r) $\n            其中 $C_1 = 1/E_T$，$C_2 = -\\nu_{TT}/E_T$，且 $f(r) = -\\frac{\\nu_{TL}}{E_L}\\sigma_{zz}(r) + \\alpha_T \\Delta T$。\n            \n            $C_1 \\sigma_{rr} + C_2 \\sigma_{\\theta\\theta} + f(r) = \\frac{d}{dr}[r(C_2 \\sigma_{rr} + C_1 \\sigma_{\\theta\\theta} + f(r))]$\n            使用 $\\sigma_{\\theta\\theta} = \\frac{d}{dr}(r\\sigma_{rr})$：\n            $C_1 \\sigma_{rr} + C_2 \\frac{d(r\\sigma_{rr})}{dr} + f(r) = \\frac{d}{dr}[r(C_2 \\sigma_{rr} + C_1 \\frac{d(r\\sigma_{rr})}{dr} + f(r))]$\n            这将导致一个关于 $\\sigma_{rr}$ 的微分方程。并且 $f(r)$ 包含 $\\sigma_{zz}(r)$，而它本身又依赖于 $\\sigma_{rr}$ 和 $\\sigma_{\\theta\\theta}$。\n            完整的系统是：\n            1. $\\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr}-\\sigma_{\\theta\\theta}}{r}=0$\n            2. $ \\sigma_{zz} = \\nu_{TL}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) - E_L \\alpha_L \\Delta T $\n            3. 协调方程：$\\frac{d}{dr}(r\\epsilon_{\\theta\\theta}) - \\epsilon_{rr} = 0$。\n            \n            让我们将（1）和（2）代入 $\\epsilon_{rr}, \\epsilon_{\\theta\\theta}$ 的本构律，以用 $\\sigma_{rr}$ 及其导数表示它们。\n            \n            $\\sigma_{\\theta\\theta} = \\sigma_{rr} + r \\frac{d\\sigma_{rr}}{dr}$。\n            $\\sigma_{rr} + \\sigma_{\\theta\\theta} = 2\\sigma_{rr} + r \\frac{d\\sigma_{rr}}{dr}$。\n            \n            $\\sigma_{zz} = \\nu_{TL}(2\\sigma_{rr} + r\\frac{d\\sigma_{rr}}{dr}) - E_L \\alpha_L \\Delta T$。\n            \n            现在，将这些代入 $\\epsilon_{rr}$ 和 $\\epsilon_{\\theta\\theta}$ 的表达式中：\n            \n            $$ \\epsilon_{rr} = \\frac{1}{E_T}(\\sigma_{rr} - \\nu_{TT}(\\sigma_{rr} + r\\frac{d\\sigma_{rr}}{dr})) - \\frac{\\nu_{TL}}{E_L} \\sigma_{zz} + \\alpha_T \\Delta T $$\n            $$ \\epsilon_{\\theta\\theta} = \\frac{1}{E_T}((\\sigma_{rr} + r\\frac{d\\sigma_{rr}}{dr}) - \\nu_{TT}\\sigma_{rr}) - \\frac{\\nu_{TL}}{E_L} \\sigma_{zz} + \\alpha_T \\Delta T $$\n            \n            并代入 $\\sigma_{zz}$ 的表达式：\n            \n            $$ \\frac{\\nu_{TL}}{E_L}\\sigma_{zz} = \\frac{\\nu_{TL}^2}{E_L}(2\\sigma_{rr} + r\\frac{d\\sigma_{rr}}{dr}) - \\nu_{TL}\\alpha_L \\Delta T $$\n            \n            所以,\n            $$ \\epsilon_{rr} = \\frac{1-\\nu_{TT}}{E_T}\\sigma_{rr} - \\frac{\\nu_{TT}}{E_T}r\\frac{d\\sigma_{rr}}{dr} - \\left[\\frac{\\nu_{TL}^2}{E_L}(2\\sigma_{rr} + r\\frac{d\\sigma_{rr}}{dr}) - \\nu_{TL}\\alpha_L \\Delta T\\right] + \\alpha_T \\Delta T $$\n            $$ \\epsilon_{\\theta\\theta} = \\frac{1-\\nu_{TT}}{E_T}\\sigma_{rr} + \\frac{1}{E_T}r\\frac{d\\sigma_{rr}}{dr} - \\left[\\frac{\\nu_{TL}^2}{E_L}(2\\sigma_{rr} + r\\frac{d\\sigma_{rr}}{dr}) - \\nu_{TL}\\alpha_L \\Delta T\\right] + \\alpha_T \\Delta T $$\n            \n            让我们收集关于 $\\sigma_{rr}$ 及其导数的项：\n            令 $C_A = \\frac{1-\\nu_{TT}}{E_T} - \\frac{2\\nu_{TL}^2}{E_L}$ 和 $C_B = -\\frac{\\nu_{TT}}{E_T} - \\frac{\\nu_{TL}^2}{E_L}$。\n            令 $C_D = \\frac{1-\\nu_{TT}}{E_T} - \\frac{2\\nu_{TL}^2}{E_L}$ 和 $C_E = \\frac{1}{E_T} - \\frac{\\nu_{TL}^2}{E_L}$。\n            令 $K_T = \\nu_{TL}\\alpha_L \\Delta T + \\alpha_T \\Delta T$。\n            \n            $ \\epsilon_{rr} = C_A \\sigma_{rr} + C_B r\\frac{d\\sigma_{rr}}{dr} + K_T $\n            $ \\epsilon_{\\theta\\theta} = C_D \\sigma_{rr} + C_E r\\frac{d\\sigma_{rr}}{dr} + K_T $\n            注意 $C_A=C_D$。\n            \n            现在使用协调方程：$\\epsilon_{rr} = \\epsilon_{\\theta\\theta} + r \\frac{d\\epsilon_{\\theta\\theta}}{dr}$。\n            \n            $ C_A \\sigma_{rr} + C_B r\\frac{d\\sigma_{rr}}{dr} + K_T = (C_A \\sigma_{rr} + C_E r\\frac{d\\sigma_{rr}}{dr} + K_T) + r \\frac{d}{dr}(C_A \\sigma_{rr} + C_E r\\frac{d\\sigma_{rr}}{dr} + K_T) $\n            \n            $ (C_B - C_E) r\\frac{d\\sigma_{rr}}{dr} = r \\frac{d}{dr}(C_A \\sigma_{rr} + C_E r\\frac{d\\sigma_{rr}}{dr}) $\n            \n            $ (C_B - C_E) \\frac{d\\sigma_{rr}}{dr} = \\frac{d}{dr}(C_A \\sigma_{rr} + C_E r\\frac{d\\sigma_{rr}}{dr}) = C_A \\frac{d\\sigma_{rr}}{dr} + C_E \\frac{d}{dr}(r\\frac{d\\sigma_{rr}}{dr}) $\n            \n            $ (C_B - C_E - C_A) \\frac{d\\sigma_{rr}}{dr} = C_E (r\\frac{d^2\\sigma_{rr}}{dr^2} + \\frac{d\\sigma_{rr}}{dr}) $\n            \n            $ C_E r^2\\frac{d^2\\sigma_{rr}}{dr^2} + C_E r\\frac{d\\sigma_{rr}}{dr} - (C_B - C_E - C_A) r\\frac{d\\sigma_{rr}}{dr} = 0 $ (除以 $r \\ne 0$)\n            \n            让我们计算系数：\n            $C_B - C_E = (-\\frac{\\nu_{TT}}{E_T} - \\frac{\\nu_{TL}^2}{E_L}) - (\\frac{1}{E_T} - \\frac{\\nu_{TL}^2}{E_L}) = -\\frac{1+\\nu_{TT}}{E_T}$。\n            $C_B - C_E - C_A = -\\frac{1+\\nu_{TT}}{E_T} - (\\frac{1-\\nu_{TT}}{E_T} - \\frac{2\\nu_{TL}^2}{E_L}) = -\\frac{2}{E_T} + \\frac{2\\nu_{TL}^2}{E_L}$。\n            \n            所以常微分方程是：\n            $C_E r^2 \\frac{d^2\\sigma_{rr}}{dr^2} + (C_E - (C_B-C_E-C_A)) r \\frac{d\\sigma_{rr}}{dr} = 0$\n            $C_E r^2 \\frac{d^2\\sigma_{rr}}{dr^2} + (C_E - C_B + C_E + C_A) r \\frac{d\\sigma_{rr}}{dr} = 0$\n            $C_E r^2 \\frac{d^2\\sigma_{rr}}{dr^2} + (2C_E - C_B + C_A) r \\frac{d\\sigma_{rr}}{dr} = 0$\n            \n            让我们检查新系数：\n            $2C_E - C_B + C_A = 2(\\frac{1}{E_T} - \\frac{\\nu_{TL}^2}{E_L}) - (-\\frac{\\nu_{TT}}{E_T} - \\frac{\\nu_{TL}^2}{E_L}) + (\\frac{1-\\nu_{TT}}{E_T} - \\frac{2\\nu_{TL}^2}{E_L})$\n            $= \\frac{2}{E_T} - \\frac{2\\nu_{TL}^2}{E_L} + \\frac{\\nu_{TT}}{E_T} + \\frac{\\nu_{TL}^2}{E_L} + \\frac{1-\\nu_{TT}}{E_T} - \\frac{2\\nu_{TL}^2}{E_L}$\n            $= \\frac{3}{E_T} - \\frac{3\\nu_{TL}^2}{E_L} = 3(\\frac{1}{E_T} - \\frac{\\nu_{TL}^2}{E_L}) = 3C_E$。\n            \n            所以常微分方程变为：\n            $ C_E r^2 \\frac{d^2\\sigma_{rr}}{dr^2} + 3C_E r \\frac{d\\sigma_{rr}}{dr} = 0 $\n            \n            假设 $C_E \\ne 0$，我们可以除以它：\n            $ r^2 \\frac{d^2\\sigma_{rr}}{dr^2} + 3r \\frac{d\\sigma_{rr}}{dr} = 0 $\n            令 $S(r) = \\frac{d\\sigma_{rr}}{dr}$。方程是 $r^2 S' + 3r S = 0$，或者对于 $r \\ne 0$，$r S' + 3S = 0$。\n            这可以写成 $\\frac{d(r^3 S)}{dr} = 0$。\n            所以 $r^3 S = A_1$（常数）。\n            $S = \\frac{d\\sigma_{rr}}{dr} = \\frac{A_1}{r^3}$。\n            再次积分：\n            $\\sigma_{rr}(r) = -\\frac{A_1}{2r^2} + A_2$。\n            \n            这是应力结构的一般解。让我们称常数为 $B_1$ 和 $B_2$：\n            $\\sigma_{rr}(r) = B_1 + \\frac{B_2}{r^2}$。\n            \n            从平衡方程，$\\sigma_{\\theta\\theta} = \\sigma_{rr} + r \\frac{d\\sigma_{rr}}{dr} = (B_1 + \\frac{B_2}{r^2}) + r(-\\frac{2B_2}{r^3}) = B_1 - \\frac{B_2}{r^2}$。\n            \n            这是经典的 Lamé 解的形式。它在这里也适用。所以我之前关于 $\\sigma_{rr}+\\sigma_{\\theta\\theta}$ 是常数的假设是正确的。\n            （$\\sigma_{rr}+\\sigma_{\\theta\\theta} = (B_1+B_2/r^2)+(B_1-B_2/r^2) = 2B_1$，这是一个常数）。\n            形式推导证实了解的结构。\n            \n            现在我可以应用边界条件来找到 $B_1$ 和 $B_2$。\n            1.  对于实心圆柱体，应力在 $r=0$ 处必须是有限的。$\\sigma_{rr}(0)$ 和 $\\sigma_{\\theta\\theta}(0)$ 必须是有限的。这迫使 $B_2 = 0$。\n            2.  所以，$\\sigma_{rr}(r) = B_1$ 和 $\\sigma_{\\theta\\theta}(r) = B_1$。径向应力和环向应力在整个横截面上是均匀的。\n            3.  侧表面 $r=R$ 是无面力的。所以，$\\sigma_{rr}(R) = 0$。\n            4.  这意味着 $B_1 = 0$。\n            \n            因此，对于所有 $r$，$\\sigma_{rr}(r) = 0$ 和 $\\sigma_{\\theta\\theta}(r) = 0$。\n            \n            这似乎是一个坚实的结论。推导现在更加严谨了。\n            唯一剩下的应力分量是 $\\sigma_{zz}$。\n            从条件 $\\epsilon_{zz}=0$：\n            $$ 0 = \\frac{1}{E_L}\\sigma_{zz} - \\frac{\\nu_{TL}}{E_L}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) + \\alpha_L \\Delta T $$\n            代入 $\\sigma_{rr}=0$ 和 $\\sigma_{\\theta\\theta}=0$：\n            $$ 0 = \\frac{1}{E_L}\\sigma_{zz} - 0 + \\alpha_L \\Delta T $$\n            $$ \\sigma_{zz} = -E_L \\alpha_L \\Delta T $$\n            \n            结果是 $\\sigma_{zz}$ 确实是一个常数，而 $\\sigma_{rr}$ 处处为零。\n            解似乎是 $\\sigma_{z} = -E_L \\alpha_L \\Delta T$ 和 $\\sigma_{r}(r) = 0$。\n            \n            让我们再次检查所有方面。\n            - 所有方程都满足吗？是的。平衡、协调和本构方程都由 $\\sigma_{rr}=0, \\sigma_{\\theta\\theta}=0, \\sigma_{zz} = -E_L \\alpha_L \\Delta T$ 满足。\n            - 所有边界条件都满足吗？是的。$\\sigma_{rr}(R)=0$ 满足。$\\epsilon_{zz}=0$ 满足。\n            - 产生的应变是什么？\n                $\\epsilon_{zz}=0$。\n                $\\epsilon_{rr} = \\frac{1}{E_T}(0 - \\nu_{TT} \\cdot 0) - \\frac{\\nu_{TL}}{E_L}(-E_L \\alpha_L \\Delta T) + \\alpha_T \\Delta T = \\nu_{TL}\\alpha_L \\Delta T + \\alpha_T \\Delta T$。\n                $\\epsilon_{\\theta\\theta} = \\frac{1}{E_T}(0 - \\nu_{TT} \\cdot 0) - \\frac{\\nu_{TL}}{E_L}(-E_L \\alpha_L \\Delta T) + \\alpha_T \\Delta T = \\nu_{TL}\\alpha_L \\Delta T + \\alpha_T \\Delta T$。\n            - 所以 $\\epsilon_{rr} = \\epsilon_{\\theta\\theta}$ 是一个常数。这与位移场 $u_r = C r$ 是协调的。实际上，$\\epsilon_{\\theta\\theta} = u_r/r = C$ 且 $\\epsilon_{rr} = du_r/dr = C$。\n            - 圆柱体径向膨胀或收缩，但长度不变。轴向应力的产生是因为这种热膨胀被阻止了。在横向方向上，没有约束。物体可以自由膨胀。加热（$\\Delta T0$）会导致膨胀。如果 $\\alpha_L  0$，杆想要变长。约束会向回推，导致压应力 $\\sigma_{zz}0$。这在物理上是合理的。\n            - 横向的自由热膨胀是 $(\\alpha_T \\Delta T)$。轴向约束导致应力 $\\sigma_{zz}$，这反过来通过泊松效应引起横向应变。泊松应变为 $-\\frac{\\nu_{TL}}{E_L} \\sigma_{zz} = -\\frac{\\nu_{TL}}{E_L} (-E_L \\alpha_L \\Delta T) = \\nu_{TL} \\alpha_L \\Delta T$。\n            - 总横向应变 $\\epsilon_{rr}=\\epsilon_{\\theta\\theta}$ 是直接热应变和轴向应力引起的泊松应变之和：$\\epsilon_{rr} = \\alpha_T \\Delta T + \\nu_{TL} \\alpha_L \\Delta T$。这与我的应变计算相符。\n            - 由于侧表面是自由的，没有什么可以产生径向应力。所以 $\\sigma_{rr}=0$ 非常合理。\n            \n            结果似乎是正确且自洽的。\n            解：\n            $\\sigma_{z} = -E_L \\alpha_L \\Delta T$\n            $\\sigma_{r}(r) = 0$\n            \n            问题要求最终结果是一个双元素行矩阵 $[\\sigma_z \\ \\sigma_r]$。\n            所以答案是 $[-E_L \\alpha_L \\Delta T \\ \\ 0]$。\n            \n            最后检查一下给定的常数。\n            给定：$E_L, E_T, \\nu_{TL}, \\nu_{TT}, \\alpha_L, \\alpha_T$。\n            我的答案使用了 $E_L$ 和 $\\alpha_L$。它没有使用 $E_T, \\nu_{TL}, \\nu_{TT}, \\alpha_T$。\n            这很有趣。问题陈述说：“如果任何简化消除了对某些给定常数的依赖，请在最终表达式中反映出来。”我的表达式做到了这一点。这种简化的原因在于问题是单轴约束的（仅在z方向），而在横向平面上是无约束的。在这种特定的应力状态下，轴向行为与横向行为是解耦的。\n            让我们重新验证一下。\n            轴向应变由下式给出\n            $\\epsilon_{zz} = \\frac{1}{E_L}\\sigma_{zz} - \\frac{\\nu_{TL}}{E_L}(\\sigma_{rr} + \\sigma_{\\theta\\theta}) + \\alpha_L \\Delta T$。\n            由于问题导致 $\\sigma_{rr} = \\sigma_{\\theta\\theta} = 0$，这简化为\n            $\\epsilon_{zz} = \\frac{1}{E_L}\\sigma_{zz} + \\alpha_L \\Delta T$。\n            约束是 $\\epsilon_{zz}=0$。\n            $0 = \\frac{1}{E_L}\\sigma_{zz} + \\alpha_L \\Delta T \\implies \\sigma_{zz} = -E_L \\alpha_L \\Delta T$。\n            这个推导只依赖于 $\\sigma_{rr}=\\sigma_{\\theta\\theta}=0$ 这个事实。\n            而我关于 $\\sigma_{rr}=\\sigma_{\\theta\\theta}=0$ 的推导是稳健的。它来自一般的 Lamé 解形式，结合了实心圆柱体自由表面的边界条件。\n            $\\sigma_{rr}(r) = B_1 + B_2/r^2$。$r=0$ 处的有限性 $\\implies B_2=0$。自由表面 $\\sigma_{rr}(R)=0 \\implies B_1=0$。\n            所以 $\\sigma_{rr}=0$。\n            然后平衡方程 $\\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr}-\\sigma_{\\theta\\theta}}{r}=0$ 意味着 $0 + \\frac{0-\\sigma_{\\theta\\theta}}{r}=0 \\implies \\sigma_{\\theta\\theta}=0$。\n            这是可靠的。\n            物理意义很清楚：在侧表面上没有外部压力，也没有径向应力的内部来源（如径向温度梯度），因此没有理由产生径向或环向应力。该问题在应力上实际上是一维的，但在应变上是三维的。\n            \n            最终答案的结构应该是一个有两个元素的 LaTeX `pmatrix`。\n            `\\begin{pmatrix} -E_L \\alpha_L \\Delta T  0 \\end{pmatrix}`。\n            \n            最后一个细节：“在国际单位制（SI）中，以帕斯卡表示应力”。这是一个关于单位的一般说明，而不是要求一个数值。如果输入是基本国际单位，我的解析表达式也隐含地使用基本国际单位。\n            \n            逻辑似乎是健全的。我将按照要求的结构写出解答。\n            \n            **推导步骤回顾：**\n            1.  陈述柱坐标系下的控制方程：平衡方程、运动学关系以及横观各向同性材料的本构律。\n            2.  应用问题的简化假设：轴对称性、场的轴向均匀性、无体力。这将问题简化为仅依赖于径向坐标 $r$。\n            3.  证明剪切应力和应变（$\\sigma_{rz}, \\epsilon_{rz}$ 等）为零。\n            4.  确定轴向应变 $\\epsilon_{zz}$ 必须是一个常数。\n            5.  应用宏观轴向伸长为零的全局约束，证明 $\\epsilon_{zz} = 0$。\n            6.  使用径向平衡方程和运动学协调方程推导出径向和环向应力的一般形式，即 Lamé 解的形式：$\\sigma_{rr} = B_1 + B_2/r^2$ 和 $\\sigma_{\\theta\\theta} = B_1 - B_2/r^2$。\n            7.  应用圆柱中心（$r=0$）应力有限的物理条件，证明 $B_2=0$。\n            8.  应用无面力侧表面（$\\sigma_{rr}(R)=0$）的边界条件，证明 $B_1=0$。\n            9.  得出结论，径向应力 $\\sigma_{rr}$ 和环向应力 $\\sigma_{\\theta\\theta}$ 在杆内处处为零。\n            10. 使用轴向应变 $\\epsilon_{zz}$ 的本构方程，结合已得结果（$\\epsilon_{zz}=0$, $\\sigma_{rr}=0$, $\\sigma_{\\theta\\theta}=0$），求解轴向应力 $\\sigma_{zz}$。\n            11. 结果为 $\\sigma_{zz} = -E_L \\alpha_L \\Delta T$。\n            12. 按要求将最终答案组装起来。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-E_{L} \\alpha_{L} \\Delta T  0\n\\end{pmatrix}\n}\n$$", "id": "2625954"}, {"introduction": "尽管解析解非常强大，但大多数真实的工程问题都需要借助数值方法来求解。最后的这个练习将引导您从零开始构建一个用于求解瞬态热弹性问题的计算工具。通过推导并实现一个完全耦合的有限元公式 [@problem_id:2625915]，您将深入理解控制物理定律如何被转化为适用于计算机模拟的离散系统，这是现代工程分析的基石。", "problem": "要求您为瞬态、小应变、一维热弹性杆建立和实现一个整体式时间离散和空间离散方法。任务是推导、编程和验证在后向欧拉时间积分格式下，位移场和温度场的完全耦合离散残差向量及其雅可比矩阵，并以整体式（完全耦合）方式求解。\n\n从以下基本原理出发：\n- 线性动量平衡（准静态）：应力散度加体力为零。在一维情况下，表示为 $\\,\\partial_x \\sigma + b = 0\\,$。\n- 能量平衡（热力学第一定律），包含傅里叶热传导和热弹性耦合：内能的变化率等于传导功率和热源。在一维情况下，对于与克劳修斯-杜亨不等式一致的可逆热弹性本构选择，该方程可表示为 $\\,\\rho c \\,\\dot{T} + \\mathcal{B}\\,\\dot{\\varepsilon} - \\partial_x\\!\\left(k\\,\\partial_x T\\right) - r = 0\\,$，其中 $\\,\\mathcal{B}\\,$ 是由您的本构拟设所隐含的能量热弹性耦合系数（将在您的推导中明确说明）。\n- 小应变运动学：在一维情况下 $\\,\\varepsilon = \\partial_x u\\,$。\n- 线性热弹性本构响应，该响应从一个自由能密度函数导出，此函数被假设为关于参考温度的应变和温度增量的二次函数。请确保您的力学本构定律和能量方程中的耦合项是热力学共轭的（即，它们由同一个自由能导出，从而在连续介质层面保证麦克斯韦对称性）。\n\n您的空间离散必须在长度为 $\\,L\\,$、横截面积恒为 $\\,A\\,$ 的杆的均匀网格上使用标准的两节点线性有限元。在每个单元上使用等参形函数 $\\,N_1(x)\\,$ 和 $\\,N_2(x)\\,$，其中对于长度为 $\\,h\\,$ 的单元，$\\,\\partial_x N_a\\,$ 是一个常数。所有单元级积分必须精确计算（您可以利用这样一个事实：对于所选单元，相关被积函数最多是关于 $\\,x\\,$ 的线性函数）。\n\n您的时间离散必须是在时间步长为 $\\,\\Delta t\\,$ 上从时间层 $\\,n\\,$ 到 $\\,n+1\\,$ 的后向欧拉法，并整体式地应用于该耦合系统。将时间层 $\\,n\\,$ 和 $\\,n+1\\,$ 的节点位移和温度向量分别表示为 $\\,\\mathbf{u}^n\\,$, $\\,\\mathbf{u}^{n+1}\\,$, $\\,\\mathbf{T}^n\\,$ 和 $\\,\\mathbf{T}^{n+1}\\,$。采用准静态力学（无惯性项），并在能量平衡中包含一致的热弹性耦合项。\n\n您的任务是：\n1) 从所述基本原理出发，推导一个关于参考温度 $\\,T_0\\,$ 的热力学一致的一维线性热弹性自由能密度 $\\,\\psi(\\varepsilon, T)\\,$，该函数能导出力学线性的本构律 $\\,\\sigma(\\varepsilon, T)\\,$ 和一个带有耦合项 $\\,\\mathcal{B}\\,\\dot{\\varepsilon}\\,$ 的能量方程。明确写出由您的选择所隐含的 $\\,\\sigma(\\varepsilon, T)\\,$ 和耦合系数 $\\,\\mathcal{B}\\,$。\n2) 针对单个时间步内的整体式问题，写出其有限元弱形式，并推导关于叠加未知向量 $\\,\\mathbf{y} = \\begin{bmatrix}\\mathbf{u}^{n+1}\\\\ \\mathbf{T}^{n+1}\\end{bmatrix}\\,$ 的组装后全局离散残差向量 $\\,\\mathbf{R}(\\mathbf{y})\\,$ 及其雅可比矩阵 $\\,\\mathbf{J} = \\partial \\mathbf{R} / \\partial \\mathbf{y}\\,$。您的表达式必须用可以通过加法组装的标准单元矩阵和向量来表示。除非指定了狄利克雷数据，否则施加零体力 $\\,b=0\\,$、零热源 $\\,r=0\\,$ 和绝热边界。对位移和温度使用下方测试套件中指定的本质（狄利克雷）边界条件。\n3) 实现一个程序，为以下测试用例组装全局残差和雅可比矩阵，通过消元法施加狄利克雷边界条件（即，为自由度构建缩减后的残差和雅可比矩阵），在给定的试探状态 $(\\mathbf{u}^{n+1}, \\mathbf{T}^{n+1})$ 下评估残差，并在缩减系统上通过有限差分法对雅可比矩阵进行数值验证。对每个测试用例，计算：\n   - 缩减残差向量 $\\,\\lVert \\mathbf{R}_\\text{red} \\rVert_2\\,$ 的欧几里得范数（平方和的平方根）。\n   - 解析缩减雅可比矩阵与有限差分近似之间的差的弗罗贝尼乌斯范数，$\\,\\lVert \\mathbf{J}_\\text{red} - \\mathbf{J}_\\text{FD} \\rVert_F\\,$，使用前向差分步长 $\\,h = 10^{-8}\\,$，并逐分量地应用于缩减未知向量。\n   在其中一个测试用例中，您还必须报告缩减雅可比矩阵的非对角耦合块的弗罗贝尼乌斯范数 $\\,\\lVert \\mathbf{J}_{uT} \\rVert_F\\,$ 和 $\\,\\lVert \\mathbf{J}_{Tu} \\rVert_F\\,$，并返回它们的组合欧几里得范数 $\\,\\sqrt{\\lVert \\mathbf{J}_{uT} \\rVert_F^2 + \\lVert \\mathbf{J}_{Tu} \\rVert_F^2}\\,$。\n\n使用以下测试套件，每个套件中的参数均采用国际单位制（SI）。在每个测试用例中，所有物理参数在空间和时间上均为常数。杆具有均匀网格和恒定横截面。时间层 $\\,n\\,$ 的初始条件为 $\\,\\mathbf{u}^n = \\mathbf{0}\\,$ 和 $\\,\\mathbf{T}^n = T_0 \\,\\mathbf{1}\\,$。时间层 $\\,n+1\\,$ 的试探状态为 $\\,\\mathbf{u}^{n+1} = \\mathbf{0}\\,$，$\\,\\mathbf{T}^{n+1}\\,$ 等于两端指定温度之间的线性插值。对于所有情况，施加位移狄利克雷数据 $\\,u(0) = 0\\,\\mathrm{m}\\,$ 和 $\\,u(L) = 0\\,\\mathrm{m}\\,$ 以及温度狄利克雷数据 $\\,T(0) = T_L\\,\\mathrm{K}\\,$ 和 $\\,T(L) = T_R\\,\\mathrm{K}\\,$.\n\n- 测试用例 A (正常路径)：$\\,L = 1\\,\\mathrm{m}\\,$, $\\,A = 1\\,\\mathrm{m}^2\\,$, $\\,N = 3\\,$ 节点, $\\,E = 210\\times 10^9\\,\\mathrm{Pa}\\,$, $\\,\\alpha = 1.2\\times 10^{-5}\\,\\mathrm{K}^{-1}\\,$, $\\,\\rho = 7800\\,\\mathrm{kg/m^3}\\,$, $\\,c = 500\\,\\mathrm{J/(kg\\cdot K)}\\,$, $\\,k = 45\\,\\mathrm{W/(m\\cdot K)}\\,$, $\\,T_0 = 293\\,\\mathrm{K}\\,$, $\\,\\Delta t = 0.25\\,\\mathrm{s}\\,$, $\\,T_L = 300\\,\\mathrm{K}\\,$, $\\,T_R = 280\\,\\mathrm{K}\\,$.\n- 测试用例 B (解耦边界情况)：与测试用例 A 相同，但 $\\,\\alpha = 0\\,$。对于此用例，除了上述两个量之外，您还必须计算并返回缩减雅可比矩阵的非对角耦合块的组合欧几里得范数 $\\,\\sqrt{\\lVert \\mathbf{J}_{uT} \\rVert_F^2 + \\lVert \\mathbf{J}_{Tu} \\rVert_F^2}\\,$。\n- 测试用例 C (传导受限和参数变化)：$\\,L = 1\\,\\mathrm{m}\\,$, $\\,A = 0.01\\,\\mathrm{m}^2\\,$, $\\,N = 4\\,$ 节点, $\\,E = 70\\times 10^9\\,\\mathrm{Pa}\\,$, $\\,\\alpha = 2.0\\times 10^{-5}\\,\\mathrm{K}^{-1}\\,$, $\\,\\rho = 2700\\,\\mathrm{kg/m^3}\\,$, $\\,c = 900\\,\\mathrm{J/(kg\\cdot K)}\\,$, $\\,k = 10^{-6}\\,\\mathrm{W/(m\\cdot K)}\\,$, $\\,T_0 = 300\\,\\mathrm{K}\\,$, $\\,\\Delta t = 10\\,\\mathrm{s}\\,$, $\\,T_L = 400\\,\\mathrm{K}\\,$, $\\,T_R = 350\\,\\mathrm{K}\\,$.\n\n不涉及角度单位。数值答案应报告为不带单位字符串的实数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：对于测试用例 A，首先是残差范数，然后是雅可比矩阵差异范数；对于测试用例 B，首先是残差范数，然后是雅可比矩阵差异范数，然后是组合的非对角范数；对于测试用例 C，首先是残差范数，然后是雅可比矩阵差异范数。例如，输出格式必须严格遵循 $\\,\\left[\\text{A\\_res},\\text{A\\_jac},\\text{B\\_res},\\text{B\\_jac},\\text{B\\_off},\\text{C\\_res},\\text{C\\_jac}\\right]\\,$ 的形式，其中每个占位符是如上定义的浮点数。", "solution": "该问题是有效的。它构成了计算固体力学领域，特别是耦合热弹性力学领域中的一个标准的、适定的问题。所有必要的数据、边界条件和材料属性均已提供，任务定义清晰且具有科学依据。我们将进行完整的推导和求解。\n\n求解过程包括四个主要阶段：\n1.  从亥姆霍兹自由能势推导热力学一致的本构关系。\n2.  建立耦合控制偏微分方程的弱形式。\n3.  使用带有线性元的有限元法（FEM）对弱形式进行空间离散，并使用后向欧拉格式进行时间离散。\n4.  推导离散的整体式残差向量及其相应的雅可比矩阵，这是牛顿-拉弗森求解过程所必需的。\n\n### 第一部分：热力学一致的本构模型\n\n我们首先假设一个单位体积的亥姆霍兹自由能密度 $\\psi$，它是其状态变量的二次函数，这些状态变量是小应变 $\\varepsilon$ 和相对于参考温度 $T_0$ 的温差 $\\Delta T = T - T_0$。对于线性热弹性，一个标准的选择是：\n$$ \\psi(\\varepsilon, T) = \\psi_0 - s_0(T - T_0) + \\frac{1}{2}E\\varepsilon^2 - E\\alpha\\varepsilon(T-T_0) - \\frac{1}{2}\\frac{\\rho c}{T_0}(T-T_0)^2 $$\n其中 $E$ 是杨氏模量，$\\alpha$ 是热膨胀系数，$\\rho$ 是质量密度，$c$ 是定应变比热容，$\\psi_0, s_0$ 是在参考状态 $(\\varepsilon=0, T=T_0)$ 下的自由能和熵。\n\n应力 $\\sigma$ 和熵密度 $s$ 的本构关系作为应变和温度的热力学共轭导出：\n$$ \\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon} \\quad , \\quad s = -\\frac{\\partial \\psi}{\\partial T} $$\n将这些定义应用于我们选择的 $\\psi$：\n$$ \\sigma(\\varepsilon, T) = E\\varepsilon - E\\alpha(T - T_0) = E(\\varepsilon - \\alpha(T-T_0)) $$\n这是线性热弹性本构律的杜安-诺伊曼形式。\n$$ s(\\varepsilon, T) = s_0 + E\\alpha\\varepsilon + \\frac{\\rho c}{T_0}(T-T_0) $$\n热力学第一定律，结合熵平衡 $T\\dot{s} = -\\partial_x q + r$（其中 $q$ 是热通量，$r$ 是热源），给出了能量方程。通过在参考温度附近对 $T\\dot{s}$ 项进行线性化，$T\\dot{s} \\approx T_0\\dot{s}$，我们得到：\n$$ T_0 \\dot{s} = T_0 \\left( E\\alpha\\dot{\\varepsilon} + \\frac{\\rho c}{T_0}\\dot{T} \\right) = \\rho c \\dot{T} + T_0 E \\alpha \\dot{\\varepsilon} $$\n使用傅里叶热传导定律 $q = -k\\,\\partial_x T$，能量平衡方程变为：\n$$ \\rho c \\dot{T} + T_0 E \\alpha \\dot{\\varepsilon} - \\partial_x(k\\,\\partial_x T) - r = 0 $$\n将其与问题陈述中的形式 $\\rho c \\dot{T} + \\mathcal{B}\\dot{\\varepsilon} - \\partial_x(k\\,\\partial_x T) - r = 0$ 进行比较，我们确定热力学一致的耦合系数为：\n$$ \\mathcal{B} = T_0 E \\alpha $$\n\n### 第二和第三部分：弱形式与离散化\n\n对于横截面积为 $A$、体力为零（$b=0$）且热源为零（$r=0$）的一维杆，其耦合系统的强形式为：\n1.  **动量平衡：** $\\partial_x \\sigma = 0 \\quad \\forall x \\in (0, L)$\n2.  **能量平衡：** $\\rho c \\dot{T} + T_0 E \\alpha \\dot{\\varepsilon} - \\partial_x(k\\,\\partial_x T) = 0 \\quad \\forall x \\in (0, L)$\n\n我们为各自的方程引入检验函数 $w_u$ 和 $w_T$，并在整个域上积分，应用分部积分来降低空间导数的阶数。这得到了弱形式：\n$$ \\int_0^L (\\partial_x w_u) \\sigma A \\, dx = \\left[ w_u \\sigma A \\right]_0^L $$\n$$ \\int_0^L w_T(\\rho c \\dot{T} + T_0 E \\alpha \\dot{\\varepsilon}) A \\, dx + \\int_0^L (\\partial_x w_T) k (\\partial_x T) A \\, dx = \\left[ -w_T q A \\right]_0^L $$\n边界项通过本质（狄利克雷）边界条件满足，或对应于自然边界条件（牵引力和热通量）。\n\n我们使用两节点线性有限元在空间上进行离散。单元 $e$ 内的位移场 $u$ 和温度场 $T$ 使用形函数 $\\mathbf{N}(x)$ 从节点值 $\\mathbf{u}^e$ 和 $\\mathbf{T}^e$ 插值得到：\n$$ u(x) = \\mathbf{N}(x) \\mathbf{u}^e \\quad , \\quad T(x) = \\mathbf{N}(x) \\mathbf{T}^e $$\n应变为 $\\varepsilon = \\partial_x u = (\\partial_x \\mathbf{N}) \\mathbf{u}^e = \\mathbf{B}^e \\mathbf{u}^e$。对于长度为 $h$ 的线性单元，$\\mathbf{B}^e = \\frac{1}{h}[-1, 1]$。\n\n对于时间离散，我们应用后向欧拉格式。时间导数在时间 $t_{n+1}$ 处近似为 $\\dot{f} \\approx (f^{n+1} - f^n)/\\Delta t$。\n将有限元近似代入在时间 $t_{n+1}$ 处评估的弱形式中，即可得到关于未知状态 $(\\mathbf{u}^{n+1}, \\mathbf{T}^{n+1})$ 的全离散方程组。\n\n### 第四部分：离散残差和雅可比矩阵\n\n该整体式系统是针对叠加的未知向量 $\\mathbf{y}^{n+1} = [\\mathbf{u}^{n+1}, \\mathbf{T}^{n+1}]^T$ 求解的。我们构建残差向量 $\\mathbf{R}(\\mathbf{y}^{n+1})$，对于一个解，该向量必须为零。全局残差由单元级贡献组装而成。\n\n**单元级贡献**：对于具有节点 $(1, 2)$ 的单元 $e$，其残差和矩阵为：\n-   **力学残差** $\\mathbf{R}_u^e$：\n    $$ \\mathbf{R}_u^e = \\mathbf{K}_{uu}^e \\mathbf{u}^{n+1, e} + \\mathbf{K}_{uT}^e \\mathbf{T}^{n+1, e} + \\mathbf{f}_{u,th}^e $$\n    其中 $\\mathbf{K}_{uu}^e = \\frac{AE}{h}\\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$ 是刚度矩阵，$\\mathbf{K}_{uT}^e = -\\frac{AE\\alpha}{2}\\begin{bmatrix}-1  -1 \\\\ 1  1\\end{bmatrix}$ 是力-热耦合矩阵，$\\mathbf{f}_{u,th}^e = AE\\alpha T_0\\begin{bmatrix}-1\\\\1\\end{bmatrix}$ 是恒定热力向量。\n-   **热学残差** $\\mathbf{R}_T^e$：\n    $$ \\mathbf{R}_T^e = \\left(\\frac{1}{\\Delta t}\\mathbf{C}_{TT}^e + \\mathbf{K}_{TT}^e\\right)\\mathbf{T}^{n+1, e} + \\frac{1}{\\Delta t}\\mathbf{K}_{Tu}^e \\mathbf{u}^{n+1, e} - \\frac{1}{\\Delta t}\\left(\\mathbf{C}_{TT}^e\\mathbf{T}^{n, e} + \\mathbf{K}_{Tu}^e\\mathbf{u}^{n, e}\\right) $$\n    其中 $\\mathbf{C}_{TT}^e = \\frac{A\\rho c h}{6}\\begin{bmatrix}2  1 \\\\ 1  2\\end{bmatrix}$ 是热容矩阵，$\\mathbf{K}_{TT}^e = \\frac{Ak}{h}\\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$ 是热导率矩阵，$\\mathbf{K}_{Tu}^e = \\frac{AT_0E\\alpha}{2}\\begin{bmatrix}-1  1 \\\\ -1  1\\end{bmatrix}$ 是热-力耦合矩阵。\n\n**雅可比矩阵**，$\\mathbf{J} = \\partial \\mathbf{R}/\\partial \\mathbf{y}^{n+1}$，对牛顿法至关重要。它是一个由单元雅可比矩阵组装而成的 $2 \\times 2$ 分块矩阵：\n$$ \\mathbf{J} = \\begin{bmatrix} \\mathbf{J}_{uu}  \\mathbf{J}_{uT} \\\\ \\mathbf{J}_{Tu}  \\mathbf{J}_{TT} \\end{bmatrix} $$\n全局分块矩阵由以下单元级矩阵组装而成：\n-   $\\mathbf{J}_{uu}^e = \\frac{\\partial \\mathbf{R}_u^e}{\\partial \\mathbf{u}^{n+1, e}} = \\mathbf{K}_{uu}^e$\n-   $\\mathbf{J}_{uT}^e = \\frac{\\partial \\mathbf{R}_u^e}{\\partial \\mathbf{T}^{n+1, e}} = \\mathbf{K}_{uT}^e$\n-   $\\mathbf{J}_{Tu}^e = \\frac{\\partial \\mathbf{R}_T^e}{\\partial \\mathbf{u}^{n+1, e}} = \\frac{1}{\\Delta t}\\mathbf{K}_{Tu}^e$\n-   $\\mathbf{J}_{TT}^e = \\frac{\\partial \\mathbf{R}_T^e}{\\partial \\mathbf{T}^{n+1, e}} = \\frac{1}{\\Delta t}\\mathbf{C}_{TT}^e + \\mathbf{K}_{TT}^e$\n\n注意耦合矩阵的物理解释：$\\mathbf{K}_{uT}$ 表示由温度场引起的机械应力/力的产生，而 $\\mathbf{K}_{Tu}$ 表示由机械变形速率（应变率）引起的生热。对于此标准提法，雅可比矩阵通常是非对称的（$\\mathbf{J}_{uT} \\neq \\mathbf{J}_{Tu}^T$）。\n\n该实现将执行以下步骤：为每个测试用例从单元贡献组装全局残差 $\\mathbf{R}$ 和雅可比矩阵 $\\mathbf{J}$，通过将系统划分为自由度和固定自由度来施加狄利克雷边界条件，并在得到的缩减系统上计算所需的范数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases for the coupled thermoelastic problem.\n    \"\"\"\n\n    test_cases = [\n        # Test Case A (happy path)\n        {\n            'L': 1.0, 'A': 1.0, 'N_nodes': 3, 'E': 210e9, 'alpha': 1.2e-5,\n            'rho': 7800.0, 'c': 500.0, 'k': 45.0, 'T0': 293.0, 'dt': 0.25,\n            'TL': 300.0, 'TR': 280.0, 'case_id': 'A'\n        },\n        # Test Case B (decoupling edge case)\n        {\n            'L': 1.0, 'A': 1.0, 'N_nodes': 3, 'E': 210e9, 'alpha': 0.0,\n            'rho': 7800.0, 'c': 500.0, 'k': 45.0, 'T0': 293.0, 'dt': 0.25,\n            'TL': 300.0, 'TR': 280.0, 'case_id': 'B'\n        },\n        # Test Case C (conduction-limited and parameter variation)\n        {\n            'L': 1.0, 'A': 0.01, 'N_nodes': 4, 'E': 70e9, 'alpha': 2.0e-5,\n            'rho': 2700.0, 'c': 900.0, 'k': 1e-6, 'T0': 300.0, 'dt': 10.0,\n            'TL': 400.0, 'TR': 350.0, 'case_id': 'C'\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        case_results = run_case(**params)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_case(L, A, N_nodes, E, alpha, rho, c, k, T0, dt, TL, TR, case_id):\n    \"\"\"\n    Assembles and evaluates the residual and Jacobian for a single test case.\n    \"\"\"\n    N_el = N_nodes - 1\n    h = L / N_el\n    total_dofs = 2 * N_nodes\n\n    # --- Initialize global matrices and vectors ---\n    K_uu = np.zeros((N_nodes, N_nodes))\n    K_uT = np.zeros((N_nodes, N_nodes))\n    K_Tu = np.zeros((N_nodes, N_nodes))\n    C_TT = np.zeros((N_nodes, N_nodes))\n    K_TT = np.zeros((N_nodes, N_nodes))\n    f_u_th = np.zeros(N_nodes)\n\n    # --- Assembly loop over elements ---\n    for i in range(N_el):\n        nodes = [i, i + 1]\n        \n        # Element matrices\n        K_uu_e = (A * E / h) * np.array([[1, -1], [-1, 1]])\n        K_uT_e = -(A * E * alpha / 2) * np.array([[-1, -1], [1, 1]])\n        f_u_th_e = A * E * alpha * T0 * np.array([-1, 1])\n        C_TT_e = (A * rho * c * h / 6) * np.array([[2, 1], [1, 2]])\n        K_TT_e = (A * k / h) * np.array([[1, -1], [-1, 1]])\n        K_Tu_e = (A * T0 * E * alpha / 2) * np.array([[-1, 1], [-1, 1]])\n\n        # Assemble into global matrices/vectors\n        ix = np.ix_(nodes, nodes)\n        K_uu[ix] += K_uu_e\n        K_uT[ix] += K_uT_e\n        f_u_th[nodes] += f_u_th_e\n        C_TT[ix] += C_TT_e\n        K_TT[ix] += K_TT_e\n        K_Tu[ix] += K_Tu_e\n    \n    # --- Form global Jacobian matrix J ---\n    J = np.zeros((total_dofs, total_dofs))\n    J[0:N_nodes, 0:N_nodes] = K_uu\n    J[0:N_nodes, N_nodes:total_dofs] = K_uT\n    J[N_nodes:total_dofs, 0:N_nodes] = (1 / dt) * K_Tu\n    J[N_nodes:total_dofs, N_nodes:total_dofs] = (1 / dt) * C_TT + K_TT\n\n    # --- Define state vectors (initial and trial) ---\n    u_n = np.zeros(N_nodes)\n    T_n = np.full(N_nodes, T0)\n\n    u_n1_trial = np.zeros(N_nodes) # u(0)=0, u(L)=0\n    x_coords = np.linspace(0, L, N_nodes)\n    T_n1_trial = TL + (TR - TL) * x_coords / L\n    \n    # --- Calculate global residual vector R at trial state ---\n    R = np.zeros(total_dofs)\n    # Mechanical residual R_u\n    R[0:N_nodes] = K_uu @ u_n1_trial + K_uT @ T_n1_trial + f_u_th\n    # Thermal residual R_T\n    R[N_nodes:total_dofs] = ((1 / dt) * C_TT + K_TT) @ T_n1_trial \\\n                           + ((1 / dt) * K_Tu) @ u_n1_trial \\\n                           - ((1 / dt) * C_TT @ T_n + (1 / dt) * K_Tu @ u_n)\n\n    # --- Apply BCs by elimination to get reduced system ---\n    fixed_dofs = [0, N_nodes - 1, N_nodes, total_dofs - 1]\n    free_dofs = sorted(list(set(range(total_dofs)) - set(fixed_dofs)))\n    \n    R_red = R[free_dofs]\n    J_red = J[np.ix_(free_dofs, free_dofs)]\n\n    # --- Compute norm of the reduced residual ---\n    res_norm = np.linalg.norm(R_red)\n\n    # --- Numerically verify the reduced Jacobian using finite differences ---\n    h_fd = 1.0e-8\n    y_red_trial = np.concatenate([u_n1_trial[1:-1], T_n1_trial[1:-1]])\n    n_free = len(free_dofs)\n    J_fd = np.zeros((n_free, n_free))\n    \n    y_n1_full_trial = np.concatenate([u_n1_trial, T_n1_trial])\n    \n    def get_reduced_residual(y_f_trial):\n        y_full = np.copy(y_n1_full_trial)\n        y_full[free_dofs] = y_f_trial\n        u_f, T_f = y_full[:N_nodes], y_full[N_nodes:]\n        \n        R_full = np.zeros(total_dofs)\n        R_full[:N_nodes] = K_uu @ u_f + K_uT @ T_f + f_u_th\n        R_full[N_nodes:] = ((1 / dt) * C_TT + K_TT) @ T_f \\\n                           + ((1 / dt) * K_Tu) @ u_f \\\n                           - ((1 / dt) * C_TT @ T_n + (1 / dt) * K_Tu @ u_n)\n        return R_full[free_dofs]\n\n    for i in range(n_free):\n        y_red_pert = np.copy(y_red_trial)\n        y_red_pert[i] += h_fd\n        R_red_pert = get_reduced_residual(y_red_pert)\n        J_fd[:, i] = (R_red_pert - R_red) / h_fd\n\n    jac_diff_norm = np.linalg.norm(J_red - J_fd, 'fro')\n\n    # --- Handle case-specific outputs ---\n    output = [res_norm, jac_diff_norm]\n    if case_id == 'B':\n        n_u_free = N_nodes - 2\n        n_t_free = N_nodes - 2\n        \n        J_uT_red_block = J_red[0:n_u_free, n_u_free:(n_u_free + n_t_free)]\n        J_Tu_red_block = J_red[n_u_free:(n_u_free + n_t_free), 0:n_u_free]\n        \n        norm_J_uT_F = np.linalg.norm(J_uT_red_block, 'fro')\n        norm_J_Tu_F = np.linalg.norm(J_Tu_red_block, 'fro')\n        off_diag_norm = np.sqrt(norm_J_uT_F**2 + norm_J_Tu_F**2)\n        output.append(off_diag_norm)\n\n    return output\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2625915"}]}