{"hands_on_practices": [{"introduction": "在应用近似方法求解微分方程之前，我们必须首先将其转化为一种称为“弱形式”的积分形式。本练习将指导你完成这一关键步骤，从经典的欧拉-伯努利梁方程出发，通过分部积分推导出其弱形式 [@problem_id:2679319]。这个过程不仅是伽辽金方法的核心，还能帮助我们理解基本边界条件和自然边界条件的物理本质。", "problem": "一根长度为 $L$ 的细长棱柱梁在欧拉-伯努利（EB）运动学假设下建模，其中横向挠度为 $w(x)$，$x \\in [0,L]$。该梁具有空间变化的抗弯刚度 $E I(x)$（其中 $E I(x) \\gt 0$），并承受静态分布的横向载荷 $q(x)$，两者在 $[0,L]$ 上均足够光滑。使用第一性原理的变分基础：运动学关系 $\\,\\kappa(x)=w''(x)\\,$，线性弹性本构响应 $\\,M(x)=E I(x)\\kappa(x)\\,$，以及在虚功原理（PVW）下的内外虚功静态平衡，来推导控制四阶平衡方程的弱（伽辽金）形式。为此，将强形式乘以一个容许的测试函数 $v(x)$，并应用两次分部积分，以降低作用于 $w(x)$ 的导数阶数。\n\n然后，识别出现的边界项，并根据其在边界上的物理意义进行解释。利用这些边界项，针对 $x=0$ 和 $x=L$ 处的以下常见端部支座，指明哪些量是本质的（狄利克雷型），哪些是自然的（诺伊曼型）：固定端、简支端和自由端。\n\n您的推导必须从虚功原理（PVW）和基本定义开始，而不是从任何预先给定的梁场方程开始。假设所有场对于您执行的操作都足够光滑。作为最终答案，请将双线性形式 $a(w,v)$ 表示为包含 $E I(x)$、$w(x)$ 和 $v(x)$ 的单一积分表达式。不需要进行数值计算，最终表达式中也不应包含单位。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- **模型**：欧拉-伯努利（EB）梁运动学。\n- **域**：$x \\in [0,L]$。\n- **长度**：$L$。\n- **横向挠度**：$w(x)$。\n- **抗弯刚度**：$E I(x)$，其中 $E I(x) > 0$ 且在 $[0,L]$ 上光滑。\n- **横向载荷**：$q(x)$，静态且在 $[0,L]$ 上光滑。\n- **运动学定义**：曲率 $\\kappa(x) = w''(x)$。\n- **本构定律**：弯矩 $M(x) = E I(x) \\kappa(x)$。\n- **控制原理**：虚功原理（PVW）。\n- **任务1**：通过将强形式乘以测试函数 $v(x)$ 并应用两次分部积分，推导控制方程的弱（伽辽金）形式。推导必须源于第一性原理（PVW）。\n- **任务2**：识别并解释所产生的边界项。\n- **任务3**：对固定端、简支端和自由端的边界条件进行分类（本质边界条件 vs. 自然边界条件）。\n- **最终答案要求**：给出双线性形式 $a(w,v)$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，基于经典且基础的欧拉-伯努利梁理论和虚功原理，这些都是固体力学和结构分析的核心内容。该问题是适定的，提供了执行所需推导的所有必要定义和变量（$L$、$EI(x)$、$q(x)$）。语言客观而精确。\n\n在说明中存在潜在的误解。问题要求通过对强形式进行操作来推导弱形式，但又声明推导必须从虚功原理（PVW）开始。标准的推导过程是从虚功原理出发建立弱形式，然后在此基础上，在足够的光滑性假设下，可以推导出强形式。反向路径，即从强形式到弱形式，是一个常见的教学练习，用以引入弱形式并正确识别边界项。该问题被解释为要求进行完整的理论阐述：首先，从虚功原理建立强形式以展示其第一性原理基础；其次，执行指定程序，即通过将强形式乘以测试函数来推导弱形式并分析边界条件。这种解释解决了明显的程序冲突，使问题自洽且逻辑一致。因此，该问题是有效的。\n\n**步骤3：结论与行动**\n问题有效。将开始求解。\n\n推导从虚功原理（PVW）开始，该原理指出，对于处于静态平衡的物体，对于任何运动学上容许的虚位移，由应力所做的内虚功等于由施加载荷所做的外虚功。在给定梁的背景下，这表示为 $\\delta W_{\\text{int}} = \\delta W_{\\text{ext}}$。\n\n内虚功 $\\delta W_{\\text{int}}$ 是由内弯矩 $M(x)$ 通过虚曲率变化 $\\delta\\kappa(x)$ 所做的功：\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} M(x) \\delta\\kappa(x) \\, dx $$\n外虚功 $\\delta W_{\\text{ext}}$ 是由分布载荷 $q(x)$ 通过虚位移 $\\delta w(x)$ 所做的功：\n$$ \\delta W_{\\text{ext}} = \\int_{0}^{L} q(x) \\delta w(x) \\, dx $$\n我们不在 $\\delta W_{\\text{ext}}$ 的初始表达式中包含边界载荷；它们将从对 $\\delta W_{\\text{int}}$ 的分析中自然产生。\n\n令任意的、运动学上容许的虚位移用测试函数表示为 $v(x) = \\delta w(x)$。这些虚量通过运动学定义相关联：$\\delta\\kappa(x) = \\delta(w''(x)) = (\\delta w(x))'' = v''(x)$。代入本构关系 $M(x) = EI(x) w''(x)$，虚功原理变为：\n$$ \\int_{0}^{L} EI(x) w''(x) v''(x) \\, dx = \\int_{0}^{L} q(x) v(x) \\, dx $$\n这是平衡方程的弱（或变分）形式，假设边界条件使得在边界上没有功产生（例如，对于两端固定的梁，其中 $v(0)=v'(0)=v(L)=v'(L)=0$）。\n\n为了由此推导强形式，我们对左侧应用分部积分，将导数从测试函数 $v(x)$ 转移到试探函数 $w(x)$。\n$$ \\int_{0}^{L} EI(x) w''(x) v''(x) \\, dx = \\left[ EI(x) w''(x) v'(x) \\right]_{0}^{L} - \\int_{0}^{L} (EI(x) w''(x))' v'(x) \\, dx $$\n再次应用分部积分：\n$$ = \\left[ EI(x) w''(x) v'(x) \\right]_{0}^{L} - \\left( \\left[ (EI(x) w''(x))' v(x) \\right]_{0}^{L} - \\int_{0}^{L} (EI(x) w''(x))'' v(x) \\, dx \\right) $$\n$$ = \\int_{0}^{L} (EI(x) w''(x))'' v(x) \\, dx + \\left[ EI(x) w''(x) v'(x) - (EI(x) w''(x))' v(x) \\right]_{0}^{L} $$\n将此结果与外虚功积分相等，得到：\n$$ \\int_{0}^{L} (EI(x) w''(x))'' v(x) \\, dx - \\int_{0}^{L} q(x) v(x) \\, dx = \\left[ (EI(x) w''(x))' v(x) - EI(x) w''(x) v'(x) \\right]_{0}^{L} $$\n根据变分法的基本引理，如果对于所有在边界上为零的足够光滑的测试函数 $v(x)$（即 $v(0)=v'(0)=v(L)=v'(L)=0$），该等式必须成立，则边界项为零，且积分必须为零。这意味着被积函数在域 $(0,L)$ 内必须处处为零：\n$$ (EI(x) w''(x))'' = q(x) $$\n这就是作为欧拉-伯努利梁方程强形式的四阶常微分方程。\n\n现在，根据明确的指示，我们从此强形式开始，乘以一个容许的测试函数 $v(x)$，并在域 $[0,L]$上积分：\n$$ \\int_{0}^{L} (EI(x) w''(x))'' v(x) \\, dx = \\int_{0}^{L} q(x) v(x) \\, dx $$\n我们对左侧（LHS）应用分部积分，以降低作用于 $w(x)$ 的导数阶数。\n第一次分部积分：\n$$ \\int_{0}^{L} (EI w'')'' v \\, dx = \\left[ (EI w'')' v \\right]_{0}^{L} - \\int_{0}^{L} (EI w'')' v' \\, dx $$\n对剩余积分进行第二次分部积分：\n$$ -\\int_{0}^{L} (EI w'')' v' \\, dx = -\\left( \\left[ (EI w'') v' \\right]_{0}^{L} - \\int_{0}^{L} (EI w'') v'' \\, dx \\right) = \\int_{0}^{L} EI w'' v'' \\, dx - \\left[ EI w'' v' \\right]_{0}^{L} $$\n结合这些结果，LHS 变为：\n$$ \\text{LHS} = \\int_{0}^{L} EI(x) w''(x) v''(x) \\, dx + \\left[ (EI w'')' v \\right]_{0}^{L} - \\left[ EI w'' v' \\right]_{0}^{L} $$\n将其与加权余量陈述中的右侧相等，得到包含边界项的完整弱形式：\n$$ \\int_{0}^{L} EI(x) w''(x) v''(x) \\, dx + \\left[ (EI(x) w''(x))' v(x) \\right]_{0}^{L} - \\left[ EI(x) w''(x) v'(x) \\right]_{0}^{L} = \\int_{0}^{L} q(x) v(x) \\, dx $$\n这是控制方程的伽辽金形式。在边界 $x=0$ 和 $x=L$ 处计算的项是边界项。\n\n我们识别这些项中的物理量。弯矩是 $M(x) = EI(x) w''(x)$，横向剪力是 $V(x) = (EI(x) w''(x))'$。因此，边界项为：\n$$ \\left[ V(x) v(x) - M(x) v'(x) \\right]_{0}^{L} $$\n弱形式可以重新排列为：\n$$ \\int_{0}^{L} EI(x) w''(x) v''(x) \\, dx = \\int_{0}^{L} q(x) v(x) \\, dx + \\left[ V(x) v(x) - M(x) v'(x) \\right]_{L} - \\left[ V(x) v(x) - M(x) v'(x) \\right]_{0} $$\n该方程必须对任何容许的测试函数 $v(x)$ 都成立。边界条件根据指定的内容进行分类。\n\n**本质（或几何）边界条件**是施加在试探函数 $w(x)$ 本身上的条件，特别是关于主变量 $w$（挠度）和 $w'$（转角）的条件。为了维持一个有效的函数空间，测试函数 $v(x)$ 必须满足这些条件的齐次形式。\n**自然（或动力）边界条件**是涉及试探函数导数的条件，特别是关于次变量 $M=EIw''$（弯矩）和 $V=(EIw'')'$（剪力）的条件。这些条件不是施加在试探函数空间上的，而是由变分问题的解“自然”满足的。\n\n我们来分析在边界（例如 $x=L$ 处）的常见支座类型：\n1. **固定端**：物理条件是无挠度和无转角。\n    - $w(L)=0$ 和 $w'(L)=0$。\n    - 这些是对主变量的规定，因此两者都是**本质**条件。\n    - 对于该形式，试探函数必须满足 $w(L)=0, w'(L)=0$。测试函数必须满足 $v(L)=0, v'(L)=0$。因此，在 $x=L$ 处的边界项 $V(L)v(L)$ 和 $M(L)v'(L)$ 自动消失。\n\n2. **简支（铰接）端**：物理条件是无挠度和无弯矩。\n    - $w(L)=0$ 和 $M(L)=EI(L)w''(L)=0$。\n    - $w(L)=0$ 是对主变量的规定，因此它是一个**本质**条件。试探函数必须满足它，测试函数必须满足 $v(L)=0$。\n    - $M(L)=0$ 是对次变量的规定，因此它是一个**自然**条件。\n    - 在边界 $x=L$ 处，项 $V(L)v(L)$ 因为 $v(L)=0$ 而消失。项 $M(L)v'(L)$ 因为问题条件规定 $M(L)=0$ 而消失。\n\n3. **自由端**：物理条件是无弯矩和无剪力。\n    - $M(L)=EI(L)w''(L)=0$ 和 $V(L)=(EIw'')'(L)=0$。\n    - 两个条件都是关于次变量的，因此两者都是**自然**条件。\n    - 没有对试探函数的主变量 $w(L)$ 和 $w'(L)$ 施加条件。因此，测试函数的值 $v(L)$ 和 $v'(L)$ 是任意的。为了使边界项 $V(L)v(L) - M(L)v'(L)$ 对于任意的 $v(L)$ 和 $v'(L)$ 都消失，解 $w(x)$ 必须满足 $V(L)=0$ 和 $M(L)=0$。\n\n弱形式通常写为 $a(w,v) = \\mathcal{L}(v)$，其中 $a(w,v)$ 是一个对称双线性形式，$\\mathcal{L}(v)$ 是 $v$ 的一个线性泛函。根据我们的推导：\n$$ a(w,v) = \\int_{0}^{L} EI(x) w''(x) v''(x) \\, dx $$\n$$ \\mathcal{L}(v) = \\int_{0}^{L} q(x) v(x) \\, dx + \\left[ Vv - Mv' \\right]_{L} - \\left[ Vv - Mv' \\right]_{0} $$\n问题明确要求给出双线性形式 $a(w,v)$。", "answer": "$$\n\\boxed{\\int_{0}^{L} EI(x) w''(x) v''(x) \\, dx}\n$$", "id": "2679319"}, {"introduction": "掌握了变分原理后，瑞利-里兹法为我们提供了一套将连续体问题转化为离散代数问题的系统性方法。本练习将带你亲手实践这一过程，为一个简单的杆件问题选择合适的试函数，并推导和求解最终的线性方程组 [@problem_id:2679345]。通过计算刚度矩阵和载荷向量，你将深刻体会到如何将一个抽象的能量最小化问题转化为具体的数值解。", "problem": "考虑一根占据区间 $x \\in [0,1]$ 的等截面线性弹性杆，其模量-面积乘积 $E A = 1$。令 $u(x)$ 表示轴向位移场。在体力密度 $f(x)$ 和齐次本质边界条件 $u(0)=0$ 和 $u(1)=0$ 下，总势能为\n$$\n\\Pi[u] \\;=\\; \\frac{1}{2}\\int_{0}^{1} \\big(u'(x)\\big)^{2}\\, \\mathrm{d}x \\;-\\; \\int_{0}^{1} f(x)\\,u(x)\\,\\mathrm{d}x.\n$$\n双线性形式 $a(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$ 在满足齐次本质边界条件的容许函数集上是对称正定的 (SPD)。\n\n使用瑞利-里兹法，在由以下两个函数张成的有限维试探子空间中近似 $u(x)$：\n$$\n\\phi_{1}(x) = x(1-x), \\qquad \\phi_{2}(x) = x(1-x)(1-2x),\n$$\n使得 $u^{(2)}(x) = a_{1}\\,\\phi_{1}(x) + a_{2}\\,\\phi_{2}(x)$，其中 $a_{1}$ 和 $a_{2}$ 是未知系数。\n\n任务：\n$1.$ 从最小总势能原理出发，推导瑞利-里兹系数 $\\{a_{i}\\}$ 必须满足的代数方程组。你的推导过程必须将 $u^{(2)}$ 代入 $\\Pi[u]$，将 $\\Pi$ 视为系数的二次型，并对每个系数强制施加驻值条件。用一个由涉及 $\\{\\phi_{i}\\}$ 和 $f$ 的积分定义的刚度矩阵和载荷向量来表示该方程组。\n\n$2.$ 特别地，对于体力密度 $f(x) = x$ 的情况，明确计算给定 $\\{\\phi_{i}\\}$ 的刚度矩阵项和载荷向量分量，求解瑞利-里兹系数 $\\{a_{1}, a_{2}\\}$，并计算在驻点 $a^{\\star}$ 处的最小化近似能量 $\\Pi\\!\\left[u^{(2)}(a^{\\star})\\right]$。\n\n仅报告最小化后的近似能量值 $\\Pi\\!\\left[u^{(2)}(a^{\\star})\\right]$ 作为最终答案，以精确有理数形式表示。能量是无量纲的；不包括单位。无需四舍五入。", "solution": "首先验证该问题具有科学依据、是适定的、客观且完整的。一个有效问题的所有条件均已满足。瑞利-里兹法是求解给定边值问题的合适变分方法，该问题由总势能泛函的最小化定义。\n\n根据要求，分析分为两部分进行。\n\n第1部分：瑞利-里兹系统的推导。\n\n总势能泛函由下式给出\n$$\n\\Pi[u] = \\frac{1}{2}\\int_{0}^{1} (u'(x))^2 \\, \\mathrm{d}x - \\int_{0}^{1} f(x)u(x) \\, \\mathrm{d}x.\n$$\n近似解 $u^{(2)}(x)$ 位于一个由函数 $\\phi_{1}(x) = x(1-x)$ 和 $\\phi_{2}(x) = x(1-x)(1-2x)$ 张成的二维试探子空间中。两个试探函数都满足在 $x=0$ 和 $x=1$ 处的齐次本质边界条件。近似解表示为线性组合：\n$$\nu^{(2)}(x) = a_{1}\\phi_{1}(x) + a_{2}\\phi_{2}(x) = \\sum_{j=1}^{2} a_{j}\\phi_{j}(x).\n$$\n近似解的导数是\n$$\n\\frac{\\mathrm{d}u^{(2)}}{\\mathrm{d}x} = u^{(2)'}(x) = a_{1}\\phi_{1}'(x) + a_{2}\\phi_{2}'(x) = \\sum_{j=1}^{2} a_{j}\\phi_{j}'(x).\n$$\n将 $u^{(2)}(x)$ 及其导数代入势能泛函 $\\Pi[u]$，得到一个关于未知系数 $\\{a_{1}, a_{2}\\}$ 的函数：\n$$\n\\Pi(a_1, a_2) = \\frac{1}{2}\\int_{0}^{1} \\left(\\sum_{i=1}^{2} a_{i}\\phi_{i}'(x)\\right)\\left(\\sum_{j=1}^{2} a_{j}\\phi_{j}'(x)\\right) \\, \\mathrm{d}x - \\int_{0}^{1} f(x)\\left(\\sum_{j=1}^{2} a_{j}\\phi_{j}(x)\\right) \\, \\mathrm{d}x.\n$$\n通过交换求和与积分的顺序，我们可以将其表示为系数 $a_i$ 的二次型：\n$$\n\\Pi(a_1, a_2) = \\frac{1}{2} \\sum_{i=1}^{2}\\sum_{j=1}^{2} a_{i}a_{j} \\left(\\int_{0}^{1} \\phi_{i}'(x)\\phi_{j}'(x) \\, \\mathrm{d}x\\right) - \\sum_{j=1}^{2} a_{j} \\left(\\int_{0}^{1} f(x)\\phi_{j}(x) \\, \\mathrm{d}x\\right).\n$$\n我们如下定义刚度矩阵 $\\mathbf{K}$ 的分量和载荷向量 $\\mathbf{F}$ 的分量：\n$$\nK_{ij} = \\int_{0}^{1} \\phi_{i}'(x)\\phi_{j}'(x) \\, \\mathrm{d}x \\quad \\text{对于 } i,j \\in \\{1,2\\},\n$$\n$$\nF_{j} = \\int_{0}^{1} f(x)\\phi_{j}(x) \\, \\mathrm{d}x \\quad \\text{对于 } j \\in \\{1,2\\}.\n$$\n利用这些定义，势能可以紧凑地写为\n$$\n\\Pi(\\mathbf{a}) = \\frac{1}{2}\\sum_{i=1}^{2}\\sum_{j=1}^{2} a_{i}K_{ij}a_{j} - \\sum_{j=1}^{2} a_{j}F_{j} = \\frac{1}{2}\\mathbf{a}^{T}\\mathbf{K}\\mathbf{a} - \\mathbf{a}^{T}\\mathbf{F},\n$$\n其中 $\\mathbf{a} = [a_{1}, a_{2}]^{T}$。瑞利-里兹法通过最小化该势能来找到最优系数 $\\mathbf{a}^{\\star}$。最小值的必要条件是 $\\Pi$ 关于系数的梯度为零。我们通过将偏导数设为零来强制施加驻值条件：\n$$\n\\frac{\\partial \\Pi}{\\partial a_{k}} = 0 \\quad \\text{对于 } k=1, 2.\n$$\n对二次型求导，并利用刚度矩阵的对称性（$K_{ij} = K_{ji}$），我们得到：\n$$\n\\frac{\\partial \\Pi}{\\partial a_{k}} = \\sum_{j=1}^{2} K_{kj}a_{j} - F_{k} = 0.\n$$\n这给出了一个关于两个未知系数 $\\{a_{1}, a_{2}\\}$ 的包含两个线性代数方程的方程组，其矩阵形式为\n$$\n\\mathbf{K}\\mathbf{a} = \\mathbf{F}.\n$$\n这就是所求的代数方程组。\n\n第2部分：针对 $f(x) = x$ 的具体计算。\n\n我们给定的试探函数为 $\\phi_{1}(x) = x-x^{2}$ 和 $\\phi_{2}(x) = x-3x^{2}+2x^{3}$。它们的导数是：\n$$\n\\phi_{1}'(x) = 1-2x,\n$$\n$$\n\\phi_{2}'(x) = 1-6x+6x^{2}.\n$$\n首先，我们计算 $2 \\times 2$ 刚度矩阵 $\\mathbf{K}$ 的各项：\n$$\nK_{11} = \\int_{0}^{1} (\\phi_{1}'(x))^2 \\, \\mathrm{d}x = \\int_{0}^{1} (1-2x)^2 \\, \\mathrm{d}x = \\int_{0}^{1} (1-4x+4x^2) \\, \\mathrm{d}x = \\left[x - 2x^2 + \\frac{4}{3}x^3\\right]_{0}^{1} = 1-2+\\frac{4}{3} = \\frac{1}{3}.\n$$\n$$\nK_{12} = K_{21} = \\int_{0}^{1} \\phi_{1}'(x)\\phi_{2}'(x) \\, \\mathrm{d}x = \\int_{0}^{1} (1-2x)(1-6x+6x^2) \\, \\mathrm{d}x = \\int_{0}^{1} (1-8x+18x^2-12x^3) \\, \\mathrm{d}x = \\left[x - 4x^2 + 6x^3 - 3x^4\\right]_{0}^{1} = 1-4+6-3 = 0.\n$$\n$$\nK_{22} = \\int_{0}^{1} (\\phi_{2}'(x))^2 \\, \\mathrm{d}x = \\int_{0}^{1} (1-6x+6x^2)^2 \\, \\mathrm{d}x = \\int_{0}^{1} (1-12x+48x^2-72x^3+36x^4) \\, \\mathrm{d}x = \\left[x - 6x^2 + 16x^3 - 18x^4 + \\frac{36}{5}x^5\\right]_{0}^{1} = 1-6+16-18+\\frac{36}{5} = \\frac{1}{5}.\n$$\n所以刚度矩阵是 $\\mathbf{K} = \\begin{pmatrix} 1/3  0 \\\\ 0  1/5 \\end{pmatrix}$。\n\n接下来，我们计算体力 $f(x)=x$ 对应的载荷向量 $\\mathbf{F}$ 的分量：\n$$\nF_{1} = \\int_{0}^{1} x\\,\\phi_{1}(x) \\, \\mathrm{d}x = \\int_{0}^{1} x(x-x^2) \\, \\mathrm{d}x = \\int_{0}^{1} (x^2-x^3) \\, \\mathrm{d}x = \\left[\\frac{x^3}{3} - \\frac{x^4}{4}\\right]_{0}^{1} = \\frac{1}{3}-\\frac{1}{4} = \\frac{1}{12}.\n$$\n$$\nF_{2} = \\int_{0}^{1} x\\,\\phi_{2}(x) \\, \\mathrm{d}x = \\int_{0}^{1} x(x-3x^2+2x^3) \\, \\mathrm{d}x = \\int_{0}^{1} (x^2-3x^3+2x^4) \\, \\mathrm{d}x = \\left[\\frac{x^3}{3} - \\frac{3x^4}{4} + \\frac{2x^5}{5}\\right]_{0}^{1} = \\frac{1}{3}-\\frac{3}{4}+\\frac{2}{5} = \\frac{20-45+24}{60} = -\\frac{1}{60}.\n$$\n所以载荷向量是 $\\mathbf{F} = [1/12, -1/60]^{T}$。\n\n线性系统 $\\mathbf{K}\\mathbf{a} = \\mathbf{F}$ 为：\n$$\n\\begin{pmatrix} 1/3  0 \\\\ 0  1/5 \\end{pmatrix} \\begin{pmatrix} a_{1} \\\\ a_{2} \\end{pmatrix} = \\begin{pmatrix} 1/12 \\\\ -1/60 \\end{pmatrix}.\n$$\n由于 $\\mathbf{K}$ 是对角矩阵，解是平凡的：\n$$\na_{1} = \\frac{1/12}{1/3} = \\frac{3}{12} = \\frac{1}{4},\n$$\n$$\na_{2} = \\frac{-1/60}{1/5} = -\\frac{5}{60} = -\\frac{1}{12}.\n$$\n最优系数向量为 $\\mathbf{a}^{\\star} = [1/4, -1/12]^{T}$。\n\n最后，我们计算最小化后的近似能量 $\\Pi[u^{(2)}(a^{\\star})]$。对于从最小化二次泛函导出的线性系统，泛函的最小值由简化表达式 $\\Pi(\\mathbf{a}^{\\star}) = -\\frac{1}{2}\\mathbf{a}^{\\star T}\\mathbf{F}$ 给出。\n$$\n\\Pi[u^{(2)}(a^{\\star})] = -\\frac{1}{2} \\left( a_{1}F_{1} + a_{2}F_{2} \\right) = -\\frac{1}{2} \\left( \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{12}\\right) + \\left(-\\frac{1}{12}\\right)\\left(-\\frac{1}{60}\\right) \\right).\n$$\n$$\n\\Pi[u^{(2)}(a^{\\star})] = -\\frac{1}{2} \\left( \\frac{1}{48} + \\frac{1}{720} \\right).\n$$\n为了将分数相加，我们找到一个公分母。由于 $720 = 15 \\times 48$，公分母是 $720$。\n$$\n\\Pi[u^{(2)}(a^{\\star})] = -\\frac{1}{2} \\left( \\frac{15}{720} + \\frac{1}{720} \\right) = -\\frac{1}{2} \\left( \\frac{16}{720} \\right).\n$$\n化简分数 $\\frac{16}{720}$:\n$$\n\\frac{16}{720} = \\frac{1}{45}.\n$$\n因此，最小化的能量是：\n$$\n\\Pi[u^{(2)}(a^{\\star})] = -\\frac{1}{2} \\left( \\frac{1}{45} \\right) = -\\frac{1}{90}.\n$$\n该值表示系统在所选的二维试探函数空间内的最小势能。", "answer": "$$\\boxed{-\\frac{1}{90}}$$", "id": "2679345"}, {"introduction": "为什么伽辽金法在众多加权余量法中脱颖而出，成为有限元分析的基石？本练习通过一个包含高频振荡载荷的算例，将伽辽金法与更直观的配点法进行直接对比 [@problem_id:2679442]。你将通过推导发现，伽辽金法的积分形式能够有效“过滤”掉解中的高频误差，展现出其在处理复杂问题时的卓越稳定性和准确性。", "problem": "考虑一根占据区域 $x \\in [0,1]$ 的直棱、线弹性轴向杆，其轴向刚度 $EA$ 为常数。在静态和小变形条件下，其强形式的控制方程为 $-(EA)\\,u''(x)=p(x)$，其中 $u(x)$ 是轴向位移，$p(x)$ 是分布轴向载荷。为简化起见，设 $EA=1$，并施加本质（Dirichlet）边界条件 $u(0)=0$ 和 $u(1)=0$。设载荷为一个光滑分量和一个高频振荡分量之和，\n$$\np(x)=1 + A \\,\\sin(n\\pi x),\n$$\n其中 $A \\in \\mathbb{R}$ 是给定的振幅，$n \\in \\mathbb{N}$ 是一个正整数。\n\n采用单参数试探空间 $u_h(x)=a\\,\\phi(x)$，其中 $a \\in \\mathbb{R}$ 是未知标量，形函数为 $\\phi(x)=x(1-x)$，该形函数满足本质边界条件。将强形式的残差定义为 $R(x;a)=-u_h''(x)-p(x)$。\n\n现比较两种近似求解策略：\n\n- 点配置法：在单个配置点 $x_c=1/2$ 处强制 $R(x_c;a)=0$。\n\n- Galerkin方法：作为加权残值法（WRM）的一个特例，使用 Galerkin 权重 $w(x)=\\phi(x)$，强制 $\\int_0^1 w(x)\\,R(x;a)\\,dx=0$。\n\n从基本原理出发，推导系数 $a_C$（配置法）和 $a_G$（Galerkin法）作为 $A$ 和 $n$ 的函数表达式，并分析对于大的 $n$ 以及 $n$ 的奇偶性（偶数与奇数），每种方法如何响应振荡载荷分量。然后选择能够正确描述点配置法对振荡残差的敏感性，并解释 Galerkin 的积分加权如何减轻这种敏感性的选项，该选项需包含 $a_C$ 和 $a_G$ 对 $A$ 和 $n$ 的正确显式依赖关系。\n\n选项：\n\nA. 对于偶数 $n$，两种方法都得到 $a=1/2$。对于奇数 $n$，配置法得到 $a_C=\\tfrac{1}{2}+\\tfrac{A}{2}\\,\\sin\\!\\big(n\\pi/2\\big)$，而 Galerkin 方法得到 $a_G=\\tfrac{1}{2}+\\dfrac{12A}{(n\\pi)^3}$。因此，点配置法对振荡载荷的响应可以是 $O(1)$ 级别，具体取决于其对残差的采样位置，而 Galerkin 的积分加权将高频敏感度抑制到 $O(n^{-3})$。\n\nB. 对于所有 $n$，配置法总是得到 $a_C=1/2$，而 Galerkin 方法得到 $a_G=\\tfrac{1}{2}+\\dfrac{12A}{(n\\pi)}$，因此 Galerkin 方法比配置法对高频载荷更敏感。\n\nC. 对于奇数 $n$，Galerkin 方法得到 $a_G=1/2$，而配置法得到 $a_C=\\tfrac{1}{2}+\\dfrac{12A}{(n\\pi)^3}$；因此，在高频下，配置法比 Galerkin 方法对振荡载荷更不敏感。\n\nD. 对于偶数 $n$，由于与二次权重的正交性，Galerkin 方法得到 $a_G=\\tfrac{1}{2}+\\dfrac{6A}{(n\\pi)^2}$，而配置法得到 $a_C=\\tfrac{1}{2}+\\tfrac{A}{2}$，这表明配置法受到振荡的均匀偏置。\n\nE. 对于所有 $n$，两种方法都得到相同的 $a$，因为试探空间中只有一个参数；因此，权重选择对计算出的系数没有影响。", "solution": "问题陈述在科学上是合理的，且提法恰当。所有必要信息均已提供，目标明确。我们着手进行推导。\n\n轴向杆的控制方程为 $-u''(x) = p(x)$，作用于 $x \\in [0,1]$，边界条件为 $u(0)=0$ 和 $u(1)=0$。分布载荷为 $p(x)=1 + A \\,\\sin(n\\pi x)$。\n我们使用单参数试探解 $u_h(x) = a\\,\\phi(x)$，其中形函数为 $\\phi(x)=x(1-x)=x-x^2$。该形函数正确地满足了本质边界条件：$\\phi(0)=0$ 和 $\\phi(1)=0$。\n\n首先，我们计算试探解的二阶导数：\n$$ u_h(x) = a(x-x^2) $$\n$$ u_h'(x) = a(1-2x) $$\n$$ u_h''(x) = -2a $$\n强形式的残差定义为 $R(x;a) = -u_h''(x) - p(x)$。代入 $u_h''(x)$ 和 $p(x)$ 的表达式：\n$$ R(x;a) = -(-2a) - (1 + A\\,\\sin(n\\pi x)) = 2a - 1 - A\\,\\sin(n\\pi x) $$\n\n现在我们用两种指定的方法推导系数 $a$。\n\n**1. 点配置法**\n\n该方法要求残差在特定点 $x_c = 1/2$ 处为零。我们设 $R(x_c; a_C) = 0$。\n$$ R(1/2; a_C) = 2a_C - 1 - A\\,\\sin(n\\pi \\cdot 1/2) = 0 $$\n求解系数 $a_C$：\n$$ 2a_C = 1 + A\\,\\sin\\left(\\frac{n\\pi}{2}\\right) $$\n$$ a_C = \\frac{1}{2} + \\frac{A}{2}\\,\\sin\\left(\\frac{n\\pi}{2}\\right) $$\n我们根据整数 $n$ 的奇偶性分析这个结果：\n- 如果 $n$ 是偶数（$n=2k$，$k \\in \\mathbb{N}$），则 $\\sin(n\\pi/2) = \\sin(k\\pi) = 0$。在这种情况下，$a_C = 1/2$。\n- 如果 $n$ 是奇数（$n=2k-1$，$k \\in \\mathbb{N}$），则 $\\sin(n\\pi/2)$ 在 $1$ 和 $-1$ 之间交替。对 $a_C$ 的振荡贡献的量级为 $|A/2|$，属于 $O(1)$ 阶，并且不会随着频率参数 $n$ 的增加而衰减。\n\n**2. Galerkin 方法**\n\nGalerkin 方法强制残差与试探函数空间正交。对于我们的单参数问题，这意味着残差必须与形函数 $\\phi(x)$ 正交。权重函数为 $w(x)=\\phi(x)=x-x^2$。条件是 $\\int_0^1 w(x)\\,R(x;a_G)\\,dx = 0$。\n$$ \\int_0^1 (x-x^2)\\left[2a_G - 1 - A\\,\\sin(n\\pi x)\\right]dx = 0 $$\n我们可以分离各项：\n$$ (2a_G - 1) \\int_0^1 (x-x^2)dx - A \\int_0^1 (x-x^2)\\sin(n\\pi x)dx = 0 $$\n我们计算这两个积分。\n第一个积分是初等的：\n$$ \\int_0^1 (x-x^2)dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_0^1 = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6} $$\n第二个积分，我们记为 $I_n$，需要两次分部积分：\n$$ I_n = \\int_0^1 (x-x^2)\\sin(n\\pi x)dx $$\n第一次分部积分（$u=x-x^2$, $dv=\\sin(n\\pi x)dx$）：\n$$ I_n = \\left[-(x-x^2)\\frac{\\cos(n\\pi x)}{n\\pi}\\right]_0^1 - \\int_0^1 \\left(-\\frac{\\cos(n\\pi x)}{n\\pi}\\right)(1-2x)dx $$\n边界项为零，因为 $(x-x^2)$ 在 $x=0$ 和 $x=1$ 处为零。\n$$ I_n = \\frac{1}{n\\pi} \\int_0^1 (1-2x)\\cos(n\\pi x)dx $$\n第二次分部积分（$u=1-2x$, $dv=\\cos(n\\pi x)dx$）：\n$$ I_n = \\frac{1}{n\\pi} \\left( \\left[(1-2x)\\frac{\\sin(n\\pi x)}{n\\pi}\\right]_0^1 - \\int_0^1 \\frac{\\sin(n\\pi x)}{n\\pi}(-2)dx \\right) $$\n边界项为零，因为 $\\sin(n\\pi)$ 和 $\\sin(0)$ 为零。\n$$ I_n = \\frac{2}{(n\\pi)^2} \\int_0^1 \\sin(n\\pi x)dx = \\frac{2}{(n\\pi)^2}\\left[-\\frac{\\cos(n\\pi x)}{n\\pi}\\right]_0^1 $$\n$$ I_n = -\\frac{2}{(n\\pi)^3}(\\cos(n\\pi) - \\cos(0)) = -\\frac{2}{(n\\pi)^3}((-1)^n-1) = \\frac{2}{(n\\pi)^3}(1-(-1)^n) $$\n现在，我们将其代回 Galerkin 方程：\n$$ (2a_G - 1) \\left(\\frac{1}{6}\\right) - A \\left(\\frac{2}{(n\\pi)^3}(1-(-1)^n)\\right) = 0 $$\n$$ \\frac{2a_G - 1}{6} = A \\frac{2(1-(-1)^n)}{(n\\pi)^3} $$\n$$ a_G = \\frac{1}{2} + \\frac{6A}{(n\\pi)^3}(1-(-1)^n) $$\n我们根据 $n$ 的奇偶性分析这个结果：\n- 如果 $n$ 是偶数，则 $1-(-1)^n = 1-1=0$。在这种情况下，$a_G = 1/2$。这是因为对称的检验函数 $\\phi(x)=x(1-x)$ 在区间 $[0,1]$ 上与关于 $x=1/2$ 反对称的载荷分量 $\\sin(n\\pi x)$（对于偶数 $n$）正交。\n- 如果 $n$ 是奇数，则 $1-(-1)^n = 1-(-1)=2$。在这种情况下，\n$$ a_G = \\frac{1}{2} + \\frac{6A}{(n\\pi)^3}(2) = \\frac{1}{2} + \\frac{12A}{(n\\pi)^3} $$\n对于大的 $n$，来自振荡载荷的贡献以 $O(n^{-3})$ 的速度快速衰减。\n\n**结果总结**\n- **配置法：** $a_C = \\frac{1}{2} + \\frac{A}{2}\\,\\sin\\left(\\frac{n\\pi}{2}\\right)$。对于偶数 $n$，$a_C=\\frac{1}{2}$。对于奇数 $n$，$a_C$ 以一个不随 $n$ 衰减的振幅振荡。\n- **Galerkin法：** 对于偶数 $n$，$a_G=\\frac{1}{2}$。对于奇数 $n$，$a_G = \\frac{1}{2} + \\frac{12A}{(n\\pi)^3}$。\n\n点配置法对配置点处振荡载荷的局部值敏感，这可能导致一个巨大的、不衰减的误差贡献。Galerkin 方法通过其积分形式，有效地滤除了残差的高频分量，从而在存在此类振荡时，能够得到一个更稳健、更精确的近似解。其敏感度以 $O(n^{-3})$ 的速度快速衰减。\n\n**选项评估**\n\n**A. 对于偶数 $n$，两种方法都得到 $a=1/2$。对于奇数 $n$，配置法得到 $a_C=\\tfrac{1}{2}+\\tfrac{A}{2}\\,\\sin\\!\\big(n\\pi/2\\big)$，而 Galerkin 方法得到 $a_G=\\tfrac{1}{2}+\\dfrac{12A}{(n\\pi)^3}$。因此，点配置法对振荡载荷的响应可以是 $O(1)$ 级别，具体取决于其对残差的采样位置，而 Galerkin 的积分加权将高频敏感度抑制到 $O(n^{-3})$。**\n- 关于偶数 $n$ 的陈述：正确。我们的推导表明 $a_C=a_G=1/2$。\n- 关于奇数 $n$ 的 $a_C$ 的陈述：正确。我们的推导得出 $a_C = \\frac{1}{2} + \\frac{A}{2}\\,\\sin\\left(\\frac{n\\pi}{2}\\right)$。\n- 关于奇数 $n$ 的 $a_G$ 的陈述：正确。我们的推导得出 $a_G = \\frac{1}{2} + \\frac{12A}{(n\\pi)^3}$。\n- 对敏感度的解释：正确。配置法的响应是 $O(1)$，而 Galerkin 法的响应是 $O(n^{-3})$。\n结论：**正确**。\n\n**B. 对于所有 $n$，配置法总是得到 $a_C=1/2$，而 Galerkin 方法得到 $a_G=\\tfrac{1}{2}+\\dfrac{12A}{(n\\pi)}$，因此 Galerkin 方法比配置法对高频载荷更敏感。**\n- $a_C$ 的表达式不正确。它不总是 $1/2$。\n- $a_G$ 的表达式不正确。衰减是 $O(n^{-3})$，而不是 $O(n^{-1})$。\n- 结论不正确。\n结论：**不正确**。\n\n**C. 对于奇数 $n$，Galerkin 方法得到 $a_G=1/2$，而配置法得到 $a_C=\\tfrac{1}{2}+\\dfrac{12A}{(n\\pi)^3}$；因此，在高频下，配置法比 Galerkin 方法对振荡载荷更不敏感。**\n- 对于奇数 $n$，$a_G$ 的表达式不正确。\n- $a_C$ 的表达式不正确；它与 Galerkin 的结果混淆了。\n- 结论不正确。\n结论：**不正确**。\n\n**D. 对于偶数 $n$，由于与二次权重的正交性，Galerkin 方法得到 $a_G=\\tfrac{1}{2}+\\dfrac{6A}{(n\\pi)^2}$，而配置法得到 $a_C=\\tfrac{1}{2}+\\tfrac{A}{2}$，这表明配置法受到振荡的均匀偏置。**\n- 对于偶数 $n$，$a_G$ 的表达式不正确。它恰好是 $1/2$。\n- 对于偶数 $n$，$a_C$ 的表达式不正确。它也恰好是 $1/2$。\n结论：**不正确**。\n\n**E. 对于所有 $n$，两种方法都得到相同的 $a$，因为试探空间中只有一个参数；因此，权重选择对计算出的系数没有影响。**\n- 这个说法从根本上是错误的。我们的推导明确表明，对于奇数 $n$，$a_C \\neq a_G$。权重方案的选择（配置法使用狄拉克δ函数，Galerkin 法使用形函数本身）至关重要，并产生不同的结果。\n结论：**不正确**。\n\n只有选项 A 与我们的严格推导一致。", "answer": "$$\\boxed{A}$$", "id": "2679442"}]}