{"hands_on_practices": [{"introduction": "掌握有限元方法的第一步是理解单元的行为如何被其数学公式所编码。本练习将聚焦于最简单的二维单元——T3单元，即常应变三角形单元。我们将从第一性原理出发，推导其应变-位移矩阵（$B$ 矩阵），并探究这一基本公式如何决定其特性，例如常应变特性及其在“patch test”中的表现。[@problem_id:2639920]", "problem": "考虑一个二维、小应变、基于位移的有限元法 (FEM) 对线性弹性问题的离散化，该离散化在一个具有直边的三节点三角形单元上进行。设该三角形的物理坐标由节点 $1$ 位于 $(0,0)$、节点 $2$ 位于 $(4,0)$、节点 $3$ 位于 $(1,3)$ 给出，所有坐标单位均为 $\\mathrm{m}$。将节点位移向量记为\n$$\n\\mathbf{d}_{e}=\\begin{bmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{bmatrix}^{\\mathsf{T}},\n$$\n其中 $u_{i}$ 和 $v_{i}$ 是节点 $i$ 处的笛卡尔位移分量。小应变张量定义为\n$$\n\\boldsymbol{\\varepsilon}=\\frac{1}{2}\\left(\\nabla \\mathbf{u} + \\left(\\nabla \\mathbf{u}\\right)^{\\mathsf{T}}\\right),\n$$\n且该单元在物理 $(x,y)$ 平面中使用线性形函数。\n\n任务：\n$1.$ 仅从 小应变的运动学定义 和 使用单元形函数进行的位移线性插值出发，推导该三角形单元的应变-位移矩阵 $\\mathbf{B}$ 的显式表达式，使得 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}_{e}$。您的推导必须清楚地表明 $\\mathbf{B}$ 如何依赖于节点坐标。\n\n$2.$ 证明该单元产生的应变在整个单元域上是恒定的，并解释其几何原因。然后，利用多项式完备性和平衡论证，推断这对单元在 Irons–Razzaque 斑块检验中的性能意味着什么：精确说明哪一阶的位移场或应力场可以被精确再现，哪一阶不能。\n\n$3.$ 对于给定的三角形，定义标量\n$$\nS=\\|\\mathbf{B}\\|_{F}^{2}=\\sum_{i=1}^{3}\\sum_{j=1}^{6}\\left(B_{ij}\\right)^{2},\n$$\n即 $\\mathbf{B}$ 的弗罗贝尼乌斯范数的平方。精确计算 $S$。将 $S$ 的最终值以 $\\mathrm{m}^{-2}$ 表示，且不要四舍五入；提供一个精确值。\n\n答案规格：最终答案必须是一个实数（方框内的答案不带单位）。如果您进行任何中间数值运算，请不要四舍五入；将精确算术运算进行到底。", "solution": "所述问题具有科学依据、适定且客观。这是固体力学有限元法研究中的一个标准问题，具体涉及三节点线性三角形单元的性质，该单元通常被称为常应变三角形 (Constant Strain Triangle, CST) 或 T3 单元。所有必要信息均已提供，任务定义明确。因此，该问题是有效的，将提供解答。\n\n分析从基于位移的有限元列式的基本原理开始。\n\n**任务1：应变-位移矩阵 $\\mathbf{B}$ 的推导**\n\n单元内的位移场 $\\mathbf{u}(x,y) = \\begin{pmatrix} u(x,y) & v(x,y) \\end{pmatrix}^{\\mathsf{T}}$ 是通过使用线性形函数 $N_i(x,y)$ 从节点位移 $\\mathbf{d}_e$ 插值得到的。\n$$\nu(x,y) = \\sum_{i=1}^{3} N_i(x,y) u_i\n$$\n$$\nv(x,y) = \\sum_{i=1}^{3} N_i(x,y) v_i\n$$\n这可以写成矩阵形式 $\\mathbf{u} = \\mathbf{N} \\mathbf{d}_e$，其中 $\\mathbf{N}$ 是形函数矩阵：\n$$\n\\mathbf{N} = \\begin{pmatrix} N_1 & 0 & N_2 & 0 & N_3 & 0 \\\\ 0 & N_1 & 0 & N_2 & 0 & N_3 \\end{pmatrix}\n$$\n节点 $i$ 的线性形函数具有 $N_i(x,y) = \\alpha_i + \\beta_i x + \\gamma_i y$ 的形式。其系数由性质 $N_i(x_j, y_j) = \\delta_{ij}$ 确定，其中 $\\delta_{ij}$ 是克罗内克符号。形函数的空间导数存在一个直接公式，这对于推导应变-位移矩阵更为方便。这些导数取决于节点坐标 $(x_i, y_i)$ 和单元面积 $A$。\n顶点为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的三角形的面积 $A$ 由以下公式给出：\n$$\nA = \\frac{1}{2} \\det \\begin{pmatrix} 1 & x_1 & y_1 \\\\ 1 & x_2 & y_2 \\\\ 1 & x_3 & y_3 \\end{pmatrix} = \\frac{1}{2} \\left[ x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2) \\right]\n$$\n形函数的空间导数是常数，由以下公式给出：\n$$\n\\frac{\\partial N_i}{\\partial x} = \\beta_i = \\frac{1}{2A}(y_j - y_k)\n$$\n$$\n\\frac{\\partial N_i}{\\partial y} = \\gamma_i = \\frac{1}{2A}(x_k - x_j)\n$$\n其中下标 $(i, j, k)$ 是 $(1, 2, 3)$ 的循环置换。\n\n对于二维问题，采用 Voigt 记法的小应变张量分量为 $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} & \\varepsilon_{yy} & \\gamma_{xy} \\end{pmatrix}^{\\mathsf{T}}$，其中 $\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}$，$\\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}$，且 $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。\n\n代入位移插值：\n$$\n\\varepsilon_{xx} = \\frac{\\partial}{\\partial x} \\sum_{i=1}^{3} N_i u_i = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial x} u_i = \\beta_1 u_1 + \\beta_2 u_2 + \\beta_3 u_3\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial}{\\partial y} \\sum_{i=1}^{3} N_i v_i = \\sum_{i=1}^{3} \\frac{\\partial N_i}{\\partial y} v_i = \\gamma_1 v_1 + \\gamma_2 v_2 + \\gamma_3 v_3\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial}{\\partial y} \\sum_{i=1}^{3} N_i u_i + \\frac{\\partial}{\\partial x} \\sum_{i=1}^{3} N_i v_i = \\sum_{i=1}^{3} \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right) = \\sum_{i=1}^{3} (\\gamma_i u_i + \\beta_i v_i)\n$$\n我们将这些关系组合成矩阵方程 $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}_e$：\n$$\n\\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix} = \\begin{pmatrix}\n\\beta_1 & 0 & \\beta_2 & 0 & \\beta_3 & 0 \\\\\n0 & \\gamma_1 & 0 & \\gamma_2 & 0 & \\gamma_3 \\\\\n\\gamma_1 & \\beta_1 & \\gamma_2 & \\beta_2 & \\gamma_3 & \\beta_3\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ v_1 \\\\ u_2 \\\\ v_2 \\\\ u_3 \\\\ v_3 \\end{pmatrix}\n$$\n因此，应变-位移矩阵 $\\mathbf{B}$ 为：\n$$\n\\mathbf{B} = \\begin{pmatrix}\n\\beta_1 & 0 & \\beta_2 & 0 & \\beta_3 & 0 \\\\\n0 & \\gamma_1 & 0 & \\gamma_2 & 0 & \\gamma_3 \\\\\n\\gamma_1 & \\beta_1 & \\gamma_2 & \\beta_2 & \\gamma_3 & \\beta_3\n\\end{pmatrix}\n$$\n代入 $\\beta_i$ 和 $\\gamma_i$ 的表达式，并定义 $y_{ij} = y_i - y_j$ 和 $x_{ij} = x_i - x_j$：\n$$\n\\mathbf{B} = \\frac{1}{2A} \\begin{pmatrix}\ny_{2}-y_{3} & 0 & y_{3}-y_{1} & 0 & y_{1}-y_{2} & 0 \\\\\n0 & x_{3}-x_{2} & 0 & x_{1}-x_{3} & 0 & x_{2}-x_{1} \\\\\nx_{3}-x_{2} & y_{2}-y_{3} & x_{1}-x_{3} & y_{3}-y_{1} & x_{2}-x_{1} & y_{1}-y_{2}\n\\end{pmatrix}\n$$\n该表达式明确地展示了 $\\mathbf{B}$ 如何依赖于节点坐标。\n\n**任务2：常应变及斑块检验的意义**\n\n位移场由空间坐标 $x$ 和 $y$ 的线性函数插值得到。应变分量由位移分量的一阶空间导数定义。线性函数的一阶导数是常数。因此，$\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\gamma_{xy}$ 在整个单元域上是恒定的。\n\n几何上，线性形函数定义了一个从母单元（例如，参考 $(\\xi, \\eta)$ 坐标系中的一个直角三角形）到物理 $(x,y)$ 平面中物理单元的仿射映射。该映射的雅可比矩阵是恒定的。由于形函数对参考坐标的导数是常数，且雅可比矩阵是恒定的，因此形函数对物理坐标的导数也是恒定的。这就是 T3 单元具有常应变特性的根本原因。\n\n这一性质直接影响单元的性能，该性能通过斑块检验进行评估。斑块检验是收敛的一个必要条件。\nT3 单元形函数的多项式完备性意味着它可以精确表示任何在 $x$ 和 $y$ 上是线性多项式的位移场，即 $u(x,y)=a_0+a_1 x+a_2 y$ 和 $v(x,y)=b_0+b_1 x+b_2 y$。这样的位移场对应于常应变状态，其中 $\\varepsilon_{xx}=a_1$, $\\varepsilon_{yy}=b_2$ 且 $\\gamma_{xy}=a_2+b_1$。对于均质线性弹性材料，常应变状态意味着常应力状态。在没有体力的情况下，常应力场 $\\boldsymbol{\\sigma}$ 平凡地满足平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$。因此，当在边界节点上施加适当的线性位移场时，一个由 T3 单元组成的斑块可以精确地再现常应力场。该单元通过了常应力斑块检验。\n\n然而，该单元无法精确表示更高阶的位移场。例如，一个二次位移场会产生线性变化的应变场（如纯弯曲中的情况），该单元无法捕捉到这一点。该单元将用一个分段常数应变场来近似一个线性应变场，这是一个很差的近似。因此，T3 单元未能通过线性应变场的斑块检验。\n总之，T3 单元能精确再现恒定的位移梯度，这对应于常应变和常应力场。它不能精确再现任何更高阶的场。\n\n**任务3：$S = \\|\\mathbf{B}\\|_{F}^{2}$ 的计算**\n\n节点坐标给定为 $1: (0,0)$，$2: (4,0)$，和 $3: (1,3)$，单位为米。\n首先，我们计算三角形的面积 $A$。\n$$\n2A = x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2) = 0(0 - 3) + 4(3 - 0) + 1(0 - 0) = 12 \\, \\mathrm{m}^2\n$$\n所以，$A = 6 \\, \\mathrm{m}^2$。\n\n接下来，我们计算 $\\mathbf{B}$ 矩阵所需的坐标差：\n$y_{23} = y_2 - y_3 = 0 - 3 = -3$\n$y_{31} = y_3 - y_1 = 3 - 0 = 3$\n$y_{12} = y_1 - y_2 = 0 - 0 = 0$\n$x_{32} = x_3 - x_2 = 1 - 4 = -3$\n$x_{13} = x_1 - x_3 = 0 - 1 = -1$\n$x_{21} = x_2 - x_1 = 4 - 0 = 4$\n\n现在我们构造 $\\mathbf{B}$ 矩阵：\n$$\n\\mathbf{B} = \\frac{1}{2A} \\begin{pmatrix} y_{23} & 0 & y_{31} & 0 & y_{12} & 0 \\\\ 0 & x_{32} & 0 & x_{13} & 0 & x_{21} \\\\ x_{32} & y_{23} & x_{13} & y_{31} & x_{21} & y_{12} \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} -3 & 0 & 3 & 0 & 0 & 0 \\\\ 0 & -3 & 0 & -1 & 0 & 4 \\\\ -3 & -3 & -1 & 3 & 4 & 0 \\end{pmatrix}\n$$\n弗罗贝尼乌斯范数的平方是所有元素平方的和：$S = \\sum_{i,j} (B_{ij})^2$。\n$$\nS = \\left(\\frac{1}{12}\\right)^{2} \\left[ (-3)^2 + 3^2 + (-3)^2 + (-1)^2 + 4^2 + (-3)^2 + (-3)^2 + (-1)^2 + 3^2 + 4^2 \\right]\n$$\n对整数矩阵元素的平方求和：\n和 = $9+9+9+1+16+9+9+1+9+16 = 88$\n因此，\n$$\nS = \\frac{1}{144} \\times 88 = \\frac{88}{144}\n$$\n这个分数可以通过分子分母同除以它们的最大公约数 $8$ 来化简。\n$$\nS = \\frac{88 \\div 8}{144 \\div 8} = \\frac{11}{18}\n$$\n系数 $\\beta_i$ 和 $\\gamma_i$ 的单位是 $\\mathrm{m}^{-1}$。量 $S$ 是这些系数的平方和，所以其单位是 $\\mathrm{m}^{-2}$。题目要求一个最终的数值。", "answer": "$$\\boxed{\\frac{11}{18}}$$", "id": "2639920"}, {"introduction": "正确的理论公式是必要的，但并非充分条件；其代码实现也必须正确。本练习将介绍计算科学中的一项关键技能：创建测试框架以验证代码实现是否遵循基本物理原理。我们将为 T3 和 Q4 单元编写刚度矩阵，并验证它们在刚体运动下的不变性——这是任何有效刚度矩阵都必须满足的特性。[@problem_id:2639900]", "problem": "您需要实现一个程序，构建一个有限元测试框架，以验证在线性弹性力学中，常见的二维单元的单元刚度矩阵在刚体平移和旋转下的不变性。该测试框架必须基于固体力学和有限元法的基本原理，而不依赖于预先计算的不变性公式。\n\n使用的基本原理是：\n- 线性动量平衡和小应变线性弹性力学，导出总势能，其二阶变分定义了对称半正定单元刚度矩阵。\n- 对于二维小应变弹性体，单元刚度矩阵由下式给出：\n$$\n\\mathbf{K}_e \\;=\\; \\int_{\\Omega_e} \\mathbf{B}^\\mathsf{T}\\,\\mathbf{D}\\,\\mathbf{B}\\,t\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{B}$ 是从单元形函数导出的应变-位移矩阵，$\\mathbf{D}$ 是各向同性线性弹性在平面应力或平面应变条件下的本构矩阵，$t$ 是厚度，$\\Omega_e$ 是物理坐标系中的单元域。\n- 平面应力的本构矩阵为：\n$$\n\\mathbf{D}_{\\text{ps}} \\;=\\; \\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0\\\\\n\\nu & 1 & 0\\\\\n0 & 0 & \\dfrac{1-\\nu}{2}\n\\end{bmatrix},\n$$\n其中 $E$ 为杨氏模量，$\\nu$ 为泊松比。\n\n您必须：\n- 构建程序来计算3节点线性三角形（$\\mathrm{T3}$）和4节点双线性四边形（$\\mathrm{Q4}$）在平面应力条件下的 $\\mathbf{K}_e$。对于 $\\mathrm{T3}$，使用精确的常数 $\\mathbf{B}$ 矩阵公式。对于 $\\mathrm{Q4}$，使用等参映射和标准的 $2\\times 2$ 高斯积分。\n- 实现节点坐标的刚体变换：通过向量 $\\mathbf{t}\\in\\mathbb{R}^2$ 进行平移，以及绕原点旋转角度 $\\theta$（以弧度为单位），其旋转矩阵为：\n$$\n\\mathbf{R}(\\theta) \\;=\\; \\begin{bmatrix}\\cos\\theta & -\\sin\\theta\\\\ \\sin\\theta & \\cos\\theta\\end{bmatrix}.\n$$\n\n需要编码和测试的科学原理：\n- $\\mathbf{K}_e$ 在刚体平移和旋转下的不变性，源于 $\\mathbf{B}$ 矩阵依赖于形函数的空间导数，而空间导数仅取决于相对几何（度量），不取决于绝对位置或方向。刚体平移不改变雅可比矩阵和度量，刚体旋转保持长度和面积不变，因此 $\\int_{\\Omega_e}\\mathbf{B}^\\mathsf{T}\\mathbf{D}\\mathbf{B}\\,t\\,\\mathrm{d}\\Omega$ 是不变的。在数值计算上，浮点舍入会引入微小差异。\n\n您的测试框架必须：\n1.  为原始节点坐标计算一个参考刚度矩阵 $\\mathbf{K}_e$，并计算两个变换后的刚度矩阵：使用平移后坐标的 $\\mathbf{K}_e^{\\text{trans}}$ 和使用旋转后坐标的 $\\mathbf{K}_e^{\\text{rot}}$。\n2.  使用绝对度量和相对度量来量化差异：\n    -   绝对度量：分量上的最大绝对偏差\n        $$\n        \\Delta_\\infty \\;=\\; \\max_{i,j} \\left| (\\mathbf{K}_e^{\\star} - \\mathbf{K}_e)_{ij} \\right|.\n        $$\n    -   相对度量：弗罗贝尼乌斯范数相对偏差\n        $$\n        \\Delta_{\\mathrm{rel}} \\;=\\; \\frac{\\left\\| \\mathbf{K}_e^{\\star} - \\mathbf{K}_e \\right\\|_F}{\\max\\!\\left(\\left\\|\\mathbf{K}_e\\right\\|_F,\\;\\varepsilon\\right)},\n        $$\n        其中 $\\varepsilon$ 是一个小的正标量，以防止除以零，且 $\\star\\in\\{\\text{trans},\\text{rot}\\}$。\n3.  当且仅当对于给定的容差，$\\Delta_\\infty \\le \\mathrm{abs\\_tol}$ 和 $\\Delta_{\\mathrm{rel}} \\le \\mathrm{rel\\_tol}$ 同时成立时，判定为通过。\n\n可接受的数值容差，由双精度舍入误差（大约为机器精度 $\\approx 2.22\\times 10^{-16}$）和适度的操作次数所决定，为：\n-   对于良态单元：$\\mathrm{abs\\_tol} = 10^{-11}$ 到 $10^{-10}$ 以及 $\\mathrm{rel\\_tol} = 10^{-11}$ 到 $10^{-10}$。\n-   对于近退化或严重扭曲的单元，由于病态条件会放大舍入误差，可能需要更宽松的容差，例如 $\\mathrm{abs\\_tol} = 10^{-6}$ 和 $\\mathrm{rel\\_tol} = 10^{-6}$。\n\n使用的物理单位：\n-   坐标、厚度和位移单位为米（$\\mathrm{m}$）。\n-   杨氏模量单位为帕斯卡（$\\mathrm{Pa}$）。\n-   角度单位为弧度。\n-   输出必须是布尔类型的通过/失败指示符。\n\n需严格按照下述规定实现的测试套件（所有坐标单位为米，厚度单位为米，模量单位为帕斯卡，角度单位为弧度）：\n-   测试用例 #1（$\\mathrm{T3}$，形状良好）：\n    -   节点：$\\big[(0.0,\\,0.0),\\,(1.2,\\,0.3),\\,(0.2,\\,0.9)\\big]$。\n    -   $E = 210\\times 10^{9}$，$\\nu = 0.3$，$t = 0.01$。\n    -   旋转 $\\theta = \\pi/3$，平移 $\\mathbf{t} = (5.0,\\,-3.0)$。\n    -   容差：$\\mathrm{abs\\_tol} = 10^{-10}$，$\\mathrm{rel\\_tol} = 10^{-10}$。\n-   测试用例 #2（$\\mathrm{Q4}$，单位正方形）：\n    -   节点：$\\big[(0.0,\\,0.0),\\,(1.0,\\,0.0),\\,(1.0,\\,1.0),\\,(0.0,\\,1.0)\\big]$。\n    -   $E = 70\\times 10^{9}$，$\\nu = 0.33$，$t = 0.05$。\n    -   旋转 $\\theta = \\pi/4$，平移 $\\mathbf{t} = (0.0,\\,0.0)$。\n    -   容差：$\\mathrm{abs\\_tol} = 10^{-11}$，$\\mathrm{rel\\_tol} = 10^{-11}$。\n-   测试用例 #3（$\\mathrm{Q4}$，大平移和微小旋转的扭曲凸四边形）：\n    -   节点：$\\big[(0.0,\\,0.0),\\,(2.0,\\,0.2),\\,(1.8,\\,1.1),\\,(-0.1,\\,1.0)\\big]$。\n    -   $E = 1.0\\times 10^{5}$，$\\nu = 0.25$，$t = 0.1$。\n    -   旋转 $\\theta = 10^{-6}$，平移 $\\mathbf{t} = (10^{6},\\,-10^{6})$。\n    -   容差：$\\mathrm{abs\\_tol} = 10^{-8}$，$\\mathrm{rel\\_tol} = 10^{-8}$。\n-   测试用例 #4（$\\mathrm{T3}$，近退化）：\n    -   节点：$\\big[(0.0,\\,0.0),\\,(1.0,\\,0.0),\\,(10^{-6},\\,10^{-6})\\big]$。\n    -   $E = 200\\times 10^{9}$，$\\nu = 0.29$，$t = 0.02$。\n    -   旋转 $\\theta = 2.0$，平移 $\\mathbf{t} = (1000.0,\\,-1000.0)$。\n    -   容差：$\\mathrm{abs\\_tol} = 10^{-6}$，$\\mathrm{rel\\_tol} = 10^{-6}$。\n\n算法要求：\n-   直接根据定义实现形函数梯度和雅可比矩阵。对于 $\\mathrm{Q4}$，使用 $2\\times 2$ 高斯积分，积分点位于 $\\xi,\\eta \\in \\{\\pm 1/\\sqrt{3}\\}$ 且权重为单位权重。\n-   使用提供的 $E$ 和 $\\nu$ 的平面应力本构矩阵 $\\mathbf{D}_{\\text{ps}}$。\n-   对于 $\\mathrm{T3}$ 单元，让单元面积为有向面积的绝对值，以避免面积因子中的方向依赖性。在单元域上使用精确的常数 $\\mathbf{B}$ 矩阵。\n\n程序输出规范：\n-   对于每个测试用例，按顺序产生两个布尔结果：平移不变性通过和旋转不变性通过。\n-   将四个测试用例的所有结果汇总到一个 Python 风格的列表字面量中，顺序为 $\\big[\\text{用例1平移},\\text{ 用例1旋转},\\text{ 用例2平移},\\text{ 用例2旋转},\\text{ 用例3平移},\\text{ 用例3旋转},\\text{ 用例4平移},\\text{ 用例4旋转}\\big]$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，\"[True,False,True,True,False,True,True,True]\"）。", "solution": "如问题所述，要求构建一个数值测试框架，以验证有限元刚度矩阵的一个基本性质，即其在刚体运动下的不变性。该性质源于应变（有限元列式所测量的物理量）由相对变形定义，与物体的绝对位置或方向无关。我们将基于第一性原理，为两种常见的二维线性弹性单元——3节点线性三角形（$\\mathrm{T3}$）和4节点双线性四边形（$\\mathrm{Q4}$）——实现刚度矩阵的计算。然后，将对这些实现施加刚体平移和旋转变换，以数值方式测试其不变性。\n\n**1. 刚度矩阵的理论基础**\n\n单元刚度矩阵，记作 $\\mathbf{K}_e$，给出了单元的节点力向量 $\\mathbf{f}_e$ 和节点位移向量 $\\mathbf{d}_e$ 之间的线性关系，表示为 $\\mathbf{f}_e = \\mathbf{K}_e \\mathbf{d}_e$。它正式地由弹性系统总势能的二阶变分导出。对于一个在平面应力条件下经历小变形的恒定厚度 $t$ 的二维物体，该矩阵通过在单元域 $\\Omega_e$ 上的积分计算得出：\n$$\n\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\mathsf{T} \\mathbf{D} \\mathbf{B} \\, t \\, \\mathrm{d}\\Omega\n$$\n该积分的组成部分是：\n-   厚度 $t$，假定在单元上为常数。\n-   本构矩阵 $\\mathbf{D}$，它关联应力与应变。对于各向同性线性弹性材料，在平面应力条件下，它是杨氏模量 $E$ 和泊松比 $\\nu$ 的函数：\n    $$\n    \\mathbf{D} = \\frac{E}{1-\\nu^2}\n    \\begin{bmatrix}\n    1 & \\nu & 0\\\\\n    \\nu & 1 & 0\\\\\n    0 & 0 & \\dfrac{1-\\nu}{2}\n    \\end{bmatrix}\n    $$\n-   应变-位移矩阵 $\\mathbf{B}$，它将节点位移向量 $\\mathbf{d}_e$ 映射到工程应变向量 $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^\\mathsf{T}$。$\\mathbf{B}$ 矩阵由单元形函数 $N_i$ 的空间导数构建而成。\n\n**2. 单元列式**\n\n我们将按规定实现两种不同的单元列式。\n\n**2.1. 3节点线性三角形 (T3)**\n\n对于由节点 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 定义的三角形，使用线性插值函数进行位移插值会导致整个单元内应变状态恒定。因此，应变-位移矩阵 $\\mathbf{B}$ 也是常数。其显式形式为：\n$$\n\\mathbf{B} = \\frac{1}{2 A}\n\\begin{bmatrix}\ny_2 - y_3 & 0 & y_3 - y_1 & 0 & y_1 - y_2 & 0 \\\\\n0 & x_3 - x_2 & 0 & x_1 - x_3 & 0 & x_2 - x_1 \\\\\nx_3 - x_2 & y_2 - y_3 & x_1 - x_3 & y_3 - y_1 & x_2 - x_1 & y_1 - y_2\n\\end{bmatrix}\n$$\n其中 $A$ 是单元的有向面积，计算公式为 $A = \\frac{1}{2} [x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2)]$。该单元从参考域映射的雅可比行列式为常数，等于 $2A$。由于整个被积函数 $\\mathbf{B}^\\mathsf{T} \\mathbf{D} \\mathbf{B}$ 是常数，积分简化为乘以单元面积。为确保积分体积为正，我们使用面积的绝对值：\n$$\n\\mathbf{K}_e = (\\mathbf{B}^\\mathsf{T} \\mathbf{D} \\mathbf{B}) \\cdot |A| \\cdot t\n$$\n\n**2.2. 4节点双线性四边形 (Q4)**\n\n对于等参四边形单元，所有计算都在一个标准化的父域中进行，该父域是一个由 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 定义的正方形。物理坐标 $(x,y)$ 通过双线性形函数从父域坐标映射而来，$N_i(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi_i\\xi)(1 + \\eta_i\\eta)$，其中 $(\\xi_i, \\eta_i)$ 是父域中节点的坐标。\n$\\mathbf{K}_e$ 的被积函数不再是常数，必须使用数值积分进行评估。问题指定了 $2 \\times 2$ 高斯积分方案。积分变换如下：\n$$\n\\mathbf{K}_e = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta)^\\mathsf{T} \\mathbf{D} \\mathbf{B}(\\xi, \\eta) \\, t \\, \\det(\\mathbf{J}(\\xi, \\eta)) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta \\approx t \\sum_{k=1}^{4} w_k \\left[ \\mathbf{B}^\\mathsf{T} \\mathbf{D} \\mathbf{B} \\det(\\mathbf{J}) \\right]_{(\\xi_k, \\eta_k)}\n$$\n积分点 $(\\xi_k, \\eta_k)$ 位于 $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$，相应的权重 $w_k$ 均等于 $1$。雅可比矩阵 $\\mathbf{J}$ 关联了父域中的导数与物理域中的导数。$\\mathbf{B}$ 矩阵在每个积分点使用空间导数 $\\partial N_i / \\partial x$ 和 $\\partial N_i / \\partial y$ 进行组装，而这些空间导数本身是通过雅可比矩阵的逆计算得到的。\n\n**3. 不变性验证**\n\n所要测试的基本原理是，刚体运动（一种等距变换）不引起应变。因此，应变能和刚度矩阵必须是不变的。设 $f$ 为这样的运动。如果节点坐标 $\\mathbf{x}_i$ 变换为 $\\mathbf{x}'_i = f(\\mathbf{x}_i)$，则得到的刚度矩阵 $\\mathbf{K}'_e$ 必须与 $\\mathbf{K}_e$ 相同。\n从数学上讲，坐标映射的雅可比矩阵在平移下不变，在旋转下以一种精确的方式协变地变换，从而使刚度矩阵的最终积分值保持不变。\n然而，在有限精度算术中，这种不变性可能无法完美保持。大的平移可能在计算大浮点数之间的差异时导致有效位数损失。病态的单元几何形状（例如，面积接近于零）会导致病态的雅可比矩阵，这会放大任何计算上的不准确性。\n验证协议如下：\n1.  对于给定单元，使用其原始节点坐标计算参考刚度矩阵 $\\mathbf{K}_e$。\n2.  对节点应用刚体平移 $\\mathbf{t}$，并计算相应的刚度矩阵 $\\mathbf{K}_e^{\\text{trans}}$。\n3.  对原始节点应用刚体旋转 $\\mathbf{R}(\\theta)$，并计算 $\\mathbf{K}_e^{\\text{rot}}$。\n4.  使用两种度量来量化变换后矩阵与参考矩阵的偏差：\n    -   最大绝对分量误差：$\\Delta_\\infty = \\max_{i,j} | (\\mathbf{K}_e^{\\star} - \\mathbf{K}_e)_{ij} |$。\n    -   相对弗罗贝尼乌斯范数误差：$\\Delta_{\\mathrm{rel}} = \\| \\mathbf{K}_e^{\\star} - \\mathbf{K}_e \\|_F / \\max(\\| \\mathbf{K}_e \\|_F, \\varepsilon)$，其中 $\\varepsilon$ 是一个小的常数，以防止除以零。\n5.  如果对于给定的容差，$\\Delta_\\infty \\le \\mathrm{abs\\_tol}$ 和 $\\Delta_{\\mathrm{rel}} \\le \\mathrm{rel\\_tol}$ 同时满足，则测试被宣布为“通过”。\n\n**4. 实现与测试执行**\n\n该测试框架使用 Python 实现，并利用 `numpy` 库进行矩阵运算。创建了用于计算 T3 和 Q4 刚度矩阵的函数。一个主程序负责协调整个过程：它遍历四个指定的测试用例，应用变换，计算参考和变换后的刚度矩阵，根据给定的容差评估通过/失败标准，并汇总布尔结果。\n-   测试用例 #1 和 #2 代表行为良好的单元，预计将在严格的容差下通过，从而确认底层理论的正确实现。\n-   测试用例 #3 探究 Q4 实现在受到大平移时的数值稳定性，大平移可能导致精度损失误差。\n-   测试用例 #4 测试 T3 列式在处理近退化几何形状时的鲁棒性，这种情况会导致一个放大舍入误差的病态问题。\n\n最终输出是一个列表，按指定顺序包含四个测试用例中每个测试的平移和旋转不变性的布尔通过/失败指示符。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_d_plane_stress(E, nu):\n    \"\"\"\n    Computes the constitutive matrix for plane stress.\n    \"\"\"\n    factor = E / (1.0 - nu**2)\n    D = np.array([\n        [1.0, nu, 0.0],\n        [nu, 1.0, 0.0],\n        [0.0, 0.0, (1.0 - nu) / 2.0]\n    ])\n    return factor * D\n\ndef get_ke_t3(nodes, E, nu, t):\n    \"\"\"\n    Computes the stiffness matrix for a 3-node linear triangle (T3).\n    \"\"\"\n    D = get_d_plane_stress(E, nu)\n    \n    x1, y1 = nodes[0]\n    x2, y2 = nodes[1]\n    x3, y3 = nodes[2]\n    \n    # The B matrix formulation relies on the signed area.\n    area_signed = 0.5 * (x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n    \n    # If the element is degenerate, the area is zero.\n    if abs(area_signed)  1e-30:\n        return np.zeros((6, 6))\n\n    # The integration volume must be positive.\n    area = abs(area_signed)\n    \n    B = np.zeros((3, 6))\n    B[0, 0] = y2 - y3; B[0, 2] = y3 - y1; B[0, 4] = y1 - y2\n    B[1, 1] = x3 - x2; B[1, 3] = x1 - x3; B[1, 5] = x2 - x1\n    B[2, 0] = x3 - x2; B[2, 1] = y2 - y3\n    B[2, 2] = x1 - x3; B[2, 3] = y3 - y1\n    B[2, 4] = x2 - x1; B[2, 5] = y1 - y2\n    \n    B /= (2.0 * area_signed)\n    \n    K_e = B.T @ D @ B * area * t\n    return K_e\n\ndef get_ke_q4(nodes, E, nu, t):\n    \"\"\"\n    Computes the stiffness matrix for a 4-node bilinear quadrilateral (Q4)\n    using 2x2 Gaussian quadrature.\n    \"\"\"\n    D = get_d_plane_stress(E, nu)\n    K_e = np.zeros((8, 8))\n    \n    gauss_pt = 1.0 / np.sqrt(3.0)\n    gauss_points = [\n        (-gauss_pt, -gauss_pt),\n        ( gauss_pt, -gauss_pt),\n        ( gauss_pt,  gauss_pt),\n        (-gauss_pt,  gauss_pt)\n    ]\n    # All quadrature weights are 1.0 for this scheme.\n    \n    # Nodal coordinates in parent domain for CCW node ordering from (-1,-1)\n    xi_node_coords = np.array([-1.0, 1.0, 1.0, -1.0])\n    eta_node_coords = np.array([-1.0, -1.0, 1.0, 1.0])\n\n    for xi, eta in gauss_points:\n        # Derivatives of shape functions wrt parent coordinates (d/d_xi, d/d_eta)\n        dNd_parent = np.zeros((4, 2))\n        dNd_parent[:, 0] = 0.25 * xi_node_coords * (1.0 + eta_node_coords * eta)\n        dNd_parent[:, 1] = 0.25 * eta_node_coords * (1.0 + xi_node_coords * xi)\n        \n        # Jacobian matrix\n        J = dNd_parent.T @ nodes\n        \n        detJ = np.linalg.det(J)\n        if detJ = 0:\n            # Invalid element mapping (e.g., concave or twisted)\n            # For this problem, we assume valid convex elements.\n            # In a real code, an error or warning should be raised.\n            return np.zeros((8, 8))\n            \n        invJ = np.linalg.inv(J)\n        \n        # Derivatives of shape functions wrt physical coordinates (d/dx, d/dy)\n        dNd_phys = invJ @ dNd_parent.T\n\n        # Strain-displacement matrix B\n        B = np.zeros((3, 8))\n        for i in range(4):\n            dNi_dx = dNd_phys[0, i]\n            dNi_dy = dNd_phys[1, i]\n            B[0, 2 * i]     = dNi_dx\n            B[1, 2 * i + 1] = dNi_dy\n            B[2, 2 * i]     = dNi_dy\n            B[2, 2 * i + 1] = dNi_dx\n            \n        K_e += B.T @ D @ B * detJ * t\n        \n    return K_e\n\ndef check_pass(K_star, K_ref, abs_tol, rel_tol):\n    \"\"\"\n    Checks if the transformed matrix K_star is close to the reference K_ref.\n    \"\"\"\n    eps = 1e-15 # Small value to prevent division by zero\n    diff = K_star - K_ref\n    \n    # Absolute metric\n    abs_dev = np.max(np.abs(diff))\n    \n    # Relative metric\n    norm_ref = np.linalg.norm(K_ref, 'fro')\n    norm_diff = np.linalg.norm(diff, 'fro')\n    rel_dev = norm_diff / max(norm_ref, eps)\n    \n    return abs_dev = abs_tol and rel_dev = rel_tol\n\ndef solve():\n    \"\"\"\n    Main test harness to run all specified test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"type\": \"T3\", \"nodes\": np.array([[0.0, 0.0], [1.2, 0.3], [0.2, 0.9]]),\n            \"E\": 210e9, \"nu\": 0.3, \"t\": 0.01,\n            \"theta\": np.pi / 3, \"trans\": np.array([5.0, -3.0]),\n            \"abs_tol\": 1e-10, \"rel_tol\": 1e-10\n        },\n        {\n            \"type\": \"Q4\", \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [1.0, 1.0], [0.0, 1.0]]),\n            \"E\": 70e9, \"nu\": 0.33, \"t\": 0.05,\n            \"theta\": np.pi / 4, \"trans\": np.array([0.0, 0.0]),\n            \"abs_tol\": 1e-11, \"rel_tol\": 1e-11\n        },\n        {\n            \"type\": \"Q4\", \"nodes\": np.array([[0.0, 0.0], [2.0, 0.2], [1.8, 1.1], [-0.1, 1.0]]),\n            \"E\": 1.0e5, \"nu\": 0.25, \"t\": 0.1,\n            \"theta\": 1e-6, \"trans\": np.array([1e6, -1e6]),\n            \"abs_tol\": 1e-8, \"rel_tol\": 1e-8\n        },\n        {\n            \"type\": \"T3\", \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [1e-6, 1e-6]]),\n            \"E\": 200e9, \"nu\": 0.29, \"t\": 0.02,\n            \"theta\": 2.0, \"trans\": np.array([1000.0, -1000.0]),\n            \"abs_tol\": 1e-6, \"rel_tol\": 1e-6\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        nodes = case[\"nodes\"]\n        E, nu, t = case[\"E\"], case[\"nu\"], case[\"t\"]\n        \n        get_ke = get_ke_t3 if case[\"type\"] == \"T3\" else get_ke_q4\n        \n        # 1. Compute reference stiffness matrix\n        K_ref = get_ke(nodes, E, nu, t)\n        \n        # 2. Test translation invariance\n        trans_vec = case[\"trans\"]\n        nodes_trans = nodes + trans_vec\n        K_trans = get_ke(nodes_trans, E, nu, t)\n        trans_pass = check_pass(K_trans, K_ref, case[\"abs_tol\"], case[\"rel_tol\"])\n        results.append(trans_pass)\n        \n        # 3. Test rotation invariance\n        theta = case[\"theta\"]\n        c, s = np.cos(theta), np.sin(theta)\n        R = np.array([[c, -s], [s, c]])\n        nodes_rot = (R @ nodes.T).T\n        K_rot = get_ke(nodes_rot, E, nu, t)\n        rot_pass = check_pass(K_rot, K_ref, case[\"abs_tol\"], case[\"rel_tol\"])\n        results.append(rot_pass)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2639900"}, {"introduction": "实用的有限元分析常采用减缩积分等高级技术来提升计算效率和性能，但这可能引入数值伪影。本练习深入探讨了“沙漏”不稳定性这一在欠积分单元中常见的问题。我们将推导这种伪零能模式的形式，然后开发并校准一种 Flanagan-Belytschko 稳定方案来控制它，从而确保单元既高效又稳健。[@problem_id:2639873]", "problem": "在有限元法（FEM）中，一个最低阶拉格朗日族（通常表示为 $Q_1$）的单元，即单个双线性四边形单元，被用于平面应变小变形线性弹性问题。该单元在物理平面上是一个边长为 $a$、厚度为 $t$ 的正方形，其形心位于原点。使用从具有自然坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 的母正方形到物理坐标的等参映射，其由 $x=(a/2)\\,\\xi$ 和 $y=(a/2)\\,\\eta$ 给出。该单元使用减缩积分，在 $(\\xi,\\eta)=(0,0)$ 处仅用单个高斯点，这会引入伪零能“沙漏”模式。\n\n考虑基于假定应变投影的 Flanagan–Belytschko (FB) 沙漏控制方法，该方法惩罚与 $\\xi\\eta$ 成比例的双线性寄生模式。在母域中将节点排序为 $1:(-1,-1)$, $2:(1,-1)$, $3:(1,1)$, $4:(-1,1)$，并将单元节点位移向量堆叠为 $u_e=[u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y},u_{4x},u_{4y}]^{\\mathsf T}$。定义沙漏形状向量 $s=[1,-1,1,-1]^{\\mathsf T}$，并通过以下公式定义两个沙漏广义坐标（每个位移分量一个）：\n$$\nq_x=\\frac{1}{4}\\sum_{i=1}^{4}s_i\\,u_{ix},\\qquad\nq_y=\\frac{1}{4}\\sum_{i=1}^{4}s_i\\,u_{iy}.\n$$\n引入 $2\\times 8$ 的沙漏算子 $G$，使得 $q=[q_x,q_y]^{\\mathsf T}=G\\,u_e$，并设定 FB 形式的稳定化刚度为\n$$\nK_{\\mathrm{hg}}=\\beta\\,\\mu\\,\\frac{t\\,A}{h^2}\\,G^{\\mathsf T}G,\n$$\n其中 $\\mu$ 是剪切模量，$A=a^2$ 是单元面积，$h$ 是选定为 $h=a$ 的特征长度，$\\beta$ 是一个无量纲校准常数。相应的稳定化能为\n$$\n\\Pi_{\\mathrm{hg}}(u_e)=\\frac{1}{2}\\,u_e^{\\mathsf T}K_{\\mathrm{hg}}\\,u_e=\\frac{1}{2}\\,\\beta\\,\\mu\\,\\frac{t\\,A}{h^2}\\,\\|G\\,u_e\\|_2^2=\\frac{1}{2}\\,\\beta\\,\\mu\\,\\frac{t\\,a^2}{a^2}\\,(q_x^2+q_y^2).\n$$\n\n任务：\n- 从虚功原理和在单元形心处计算的减缩积分 $Q_1$ 刚度的定义出发，解释为什么与 $\\xi\\eta$ 成比例的位移场分量不能被单点积分所“看见”，并因此张成沙漏模式。利用这一点来证明选择 $q_x$ 和 $q_y$ 作为 $u_x$ 和 $u_y$ 中 $\\xi\\eta$ 项的系数是合理的，并根据向量 $s$ 推导出算子 $G$。\n- 通过证明对于任何刚体运动和任何常应变线性位移场，都有 $q_x=q_y=0$，从而证明稳定化的一致性，即 $K_{\\mathrm{hg}}$ 不会惩罚这些模式。\n- 通过对连续介质位移场 $u_x(x,y)=c\\,x\\,y$, $u_y(x,y)=0$（其中 $c$ 是实常数）强制能量等效，来校准系数 $\\beta$。使用平面应变的小应变线性弹性理论，计算该场在单元中的精确弹性应变能，其中剪切能量密度为 $W=\\mu\\,\\gamma_{xy}^2/2$（$\\gamma_{xy}=\\partial u_x/\\partial y+\\partial u_y/\\partial x$），能量通过在物理单元面积上积分并乘以厚度 $t$ 得到。然后，计算由该场引起的相应节点值所对应的稳定化能 $\\Pi_{\\mathrm{hg}}$，并确定使两种能量相等的唯一 $\\beta$ 值。\n\n将最终答案表示为 $\\beta$ 的精确值（无量纲）。不需要进行数值舍入。", "solution": "首先根据指定标准验证问题。\n\n**第1步：提取已知条件**\n- **单元类型**: 平面应变中的单个双线性四边形单元 ($Q_1$)。\n- **几何形状**: 正方形，边长 $a$，厚度 $t$，形心在原点。\n- **映射**: 从母正方形 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$到物理域 $(x, y)$ 的等参映射，由 $x=(a/2)\\xi$ 和 $y=(a/2)\\eta$ 给出。\n- **积分**: 减缩积分，在 $(\\xi, \\eta)=(0,0)$ 处的单个高斯点。\n- **沙漏控制**: Flanagan–Belytschko (FB) 稳定化。\n- **节点信息**: 在母域中节点排序为 $1:(-1,-1)$, $2:(1,-1)$, $3:(1,1)$, $4:(-1,1)$。节点位移向量 $u_e=[u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y},u_{4x},u_{4y}]^{\\mathsf T}$。\n- **沙漏定义**: 形状向量 $s=[1,-1,1,-1]^{\\mathsf T}$。广义坐标 $q_x=\\frac{1}{4}\\sum_{i=1}^{4}s_i u_{ix}$，$q_y=\\frac{1}{4}\\sum_{i=1}^{4}s_i u_{iy}$。算子 $G$ 满足 $q=[q_x,q_y]^{\\mathsf T}=G u_e$。\n- **稳定化刚度和能量**: $K_{\\mathrm{hg}}=\\beta \\mu \\frac{t A}{h^2} G^{\\mathsf T}G$，其中 $A=a^2$, $h=a$。能量为 $\\Pi_{\\mathrm{hg}}(u_e)=\\frac{1}{2} \\beta \\mu t (q_x^2+q_y^2)$。\n- **校准场**: $u_x(x,y)=cxy$, $u_y(x,y)=0$。\n- **校准能量**: 基于剪切能量密度 $W=\\mu \\gamma_{xy}^2/2$，其中 $\\gamma_{xy}=\\partial u_x/\\partial y+\\partial u_y/\\partial x$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了计算固体力学中的一个标准且有据可查的程序（针对积分不足单元的沙漏控制）。其表述是适定的，提供了执行所要求任务所需的所有数据和定义。语言客观且无歧义。它没有违反任何无效标准。因此，该问题被视为有效。\n\n**第3步：求解**\n\n求解过程通过解决问题陈述中列出的三个任务来进行。\n\n**任务1：沙漏公式的合理解释**\n\n$Q_1$ 单元内的位移场由节点位移 $u_{ix}, u_{iy}$ 使用双线性形函数 $N_i(\\xi, \\eta)$ 插值得到：\n$$\nu_x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{ix}, \\quad u_y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{iy}\n$$\n其中 $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)$ 且 $(\\xi_i, \\eta_i)$ 是母域中节点 $i$ 的坐标。这个插值空间由基函数 $\\{1, \\xi, \\eta, \\xi\\eta\\}$ 张成。任何位移场都可以写成，例如，$u_x = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta$。\n\n小应变张量分量由位移场的空间导数导出。使用链式法则和给定的等参映射 $x=(a/2)\\xi, y=(a/2)\\eta$，变换的雅可比矩阵是常数：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a/2  0 \\\\ 0  a/2 \\end{pmatrix}\n$$\n空间导数通过以下关系与母域中的导数相关联：\n$$\n\\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 2/a  0 \\\\ 0  2/a \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\frac{2}{a} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n$$\n应变分量，例如 $\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x}$ 和 $\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y}+\\frac{\\partial u_y}{\\partial x}$，取决于形函数的梯度。对于一个与 $\\xi\\eta$ 成比例的项，比如 $u_x = c_3\\xi\\eta$ 和 $u_y=0$，在母域内的梯度为 $\\frac{\\partial u_x}{\\partial \\xi} = c_3\\eta$ 和 $\\frac{\\partial u_x}{\\partial \\eta} = c_3\\xi$。相应的笛卡尔应变为 $\\varepsilon_{xx} = \\frac{2}{a}c_3\\eta$ 和 $\\gamma_{xy} = \\frac{2}{a}c_3\\xi$。\n\n单元刚度矩阵通过对应变能密度进行积分来计算，而应变能密度在各高斯点处求值。对于单点积分，求值点为 $(\\xi, \\eta) = (0,0)$。在该点，对应于 $\\xi\\eta$ 模式的应变为零：$\\varepsilon_{xx}(0,0)=0$ 且 $\\gamma_{xy}(0,0)=0$。因此，这种变形模式产生零应变能，故而是一种伪零能或“沙漏”模式。\n\n为证明 $q_x$ 定义的合理性，我们用节点位移表示 $\\xi\\eta$ 项的系数 $c_3$。通过在四个节点 $(\\xi_i, \\eta_i)$ 处计算 $u_x = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta$ 的值，我们得到一个线性方程组。这些方程的一个特定组合可以得到 $c_3$：\n$$\nu_{1x} - u_{2x} + u_{3x} - u_{4x} = (c_0-c_1-c_2+c_3) - (c_0+c_1-c_2-c_3) + (c_0+c_1+c_2+c_3) - (c_0-c_1+c_2-c_3) = 4c_3\n$$\n因此，$c_3 = \\frac{1}{4}(u_{1x} - u_{2x} + u_{3x} - u_{4x})$。利用沙漏形状向量 $s=[1,-1,1,-1]^{\\mathsf T}$ 及其分量 $s_1=1, s_2=-1, s_3=1, s_4=-1$，这恰好是沙漏坐标 $q_x$ 的定义：\n$$\nq_x = \\frac{1}{4}\\sum_{i=1}^{4} s_i u_{ix}\n$$\n对于 $q_y$ 也存在完全相同的论证。$q_x$ 和 $q_y$ 的定义正确地分离出了非物理的 $\\xi\\eta$ 模式的大小。\n\n算子 $G$ 将 $q=[q_x,q_y]^{\\mathsf T}$ 与 $u_e$ 相关联。基于 $q_x$ 和 $q_y$ 定义的展开：\n$$\nq_x = \\frac{1}{4}(1 \\cdot u_{1x} + 0 \\cdot u_{1y} - 1 \\cdot u_{2x} + 0 \\cdot u_{2y} + 1 \\cdot u_{3x} + \\dots)\n$$\n$$\nq_y = \\frac{1}{4}(0 \\cdot u_{1x} + 1 \\cdot u_{1y} + 0 \\cdot u_{2x} - 1 \\cdot u_{2y} + 0 \\cdot u_{3x} + \\dots)\n$$\n因此，$2 \\times 8$ 矩阵 $G$ 为：\n$$\nG = \\frac{1}{4} \\begin{pmatrix} 1  0  -1  0  1  0  -1  0 \\\\ 0  1  0  -1  0  1  0  -1 \\end{pmatrix}\n$$\n\n**任务2：稳定化的一致性**\n\n我们必须证明对于刚体运动和常应变场，$q_x=q_y=0$。节点的物理坐标为 $1:(-a/2, -a/2)$, $2:(a/2, -a/2)$, $3:(a/2, a/2)$, $4:(-a/2, a/2)$。\n\n*   **刚体运动 (RBM)**: 一个通用的二维刚体运动由 $u_x(x,y) = c_x - \\omega_z y$ 和 $u_y(x,y) = c_y + \\omega_z x$ 给出。\n    $x$分量的节点位移为：\n    $u_{1x} = c_x - \\omega_z(-a/2) = c_x + \\omega_z a/2$\n    $u_{2x} = c_x - \\omega_z(-a/2) = c_x + \\omega_z a/2$\n    $u_{3x} = c_x - \\omega_z(a/2) = c_x - \\omega_z a/2$\n    $u_{4x} = c_x - \\omega_z(a/2) = c_x - \\omega_z a/2$\n    计算 $q_x$：\n    $q_x = \\frac{1}{4}(u_{1x}-u_{2x}+u_{3x}-u_{4x}) = \\frac{1}{4}[(c_x + \\omega_z a/2) - (c_x + \\omega_z a/2) + (c_x - \\omega_z a/2) - (c_x - \\omega_z a/2)] = 0$。\n    $y$分量的节点位移为：\n    $u_{1y} = c_y + \\omega_z(-a/2) = c_y - \\omega_z a/2$\n    $u_{2y} = c_y + \\omega_z(a/2) = c_y + \\omega_z a/2$\n    $u_{3y} = c_y + \\omega_z(a/2) = c_y + \\omega_z a/2$\n    $u_{4y} = c_y + \\omega_z(-a/2) = c_y - \\omega_z a/2$\n    计算 $q_y$：\n    $q_y = \\frac{1}{4}(u_{1y}-u_{2y}+u_{3y}-u_{4y}) = \\frac{1}{4}[(c_y - \\omega_z a/2) - (c_y + \\omega_z a/2) + (c_y + \\omega_z a/2) - (c_y - \\omega_z a/2)] = \\frac{1}{4}[(-1-1+1+1)\\omega_z a/2] = 0$。\n\n*   **常应变状态**: 常应变场是 $x$ 和 $y$ 的线性函数。叠加刚体运动不会改变结果，因此我们考虑 $u_x = A x + B y$ 和 $u_y = C x + D y$。\n    $x$分量的节点位移：\n    $u_{1x} = A(-a/2) + B(-a/2) = -(A+B)a/2$\n    $u_{2x} = A(a/2) + B(-a/2) = (A-B)a/2$\n    $u_{3x} = A(a/2) + B(a/2) = (A+B)a/2$\n    $u_{4x} = A(-a/2) + B(a/2) = (-A+B)a/2$\n    $q_x = \\frac{1}{4}(u_{1x}-u_{2x}+u_{3x}-u_{4x}) = \\frac{a}{8}[-(A+B) - (A-B) + (A+B) - (-A+B)] = \\frac{a}{8}[(-1-1+1+1)A + (-1+1+1-1)B] = 0$。\n    对 $q_y$ 的计算与系数 $C$ 和 $D$ 完全相同，得到 $q_y=0$。\n\n由于对于刚体运动和常应变状态，$q_x=q_y=0$，因此稳定化项 $\\Pi_{\\mathrm{hg}}$ 对这些模式为零，从而证明了其一致性。\n\n**任务3：系数 $\\beta$ 的校准**\n\n我们通过使指定位移场的精确连续介质弹性应变能 $\\Pi_{\\mathrm{exact}}$ 与稳定化能 $\\Pi_{\\mathrm{hg}}$ 相等来校准 $\\beta$。\n\n*   **连续介质弹性应变能, $\\Pi_{\\mathrm{exact}}$**:\n    位移场为 $u_x(x,y) = cxy$, $u_y(x,y) = 0$。\n    所需的应变分量为 $\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = cx + 0 = cx$。\n    问题指定使用剪切能量密度 $W = \\frac{1}{2}\\mu\\gamma_{xy}^2 = \\frac{1}{2}\\mu(cx)^2 = \\frac{1}{2}\\mu c^2 x^2$。\n    总能量是 $W$ 在单元体积 $V$ 上的积分，其中 $dV = t dA = t dx dy$：\n    $$\n    \\Pi_{\\mathrm{exact}} = \\int_V W dV = t \\int_{A} W dA = t \\int_{-a/2}^{a/2} \\int_{-a/2}^{a/2} \\left( \\frac{1}{2}\\mu c^2 x^2 \\right) dx dy\n    $$\n    $$\n    \\Pi_{\\mathrm{exact}} = \\frac{1}{2} t \\mu c^2 \\left( \\int_{-a/2}^{a/2} dy \\right) \\left( \\int_{-a/2}^{a/2} x^2 dx \\right)\n    $$\n    积分计算结果为：\n    $$\n    \\int_{-a/2}^{a/2} dy = a\n    $$\n    $$\n    \\int_{-a/2}^{a/2} x^2 dx = \\left[ \\frac{x^3}{3} \\right]_{-a/2}^{a/2} = \\frac{1}{3} \\left( \\left(\\frac{a}{2}\\right)^3 - \\left(-\\frac{a}{2}\\right)^3 \\right) = \\frac{2}{3} \\frac{a^3}{8} = \\frac{a^3}{12}\n    $$\n    代入回去，我们得到：\n    $$\n    \\Pi_{\\mathrm{exact}} = \\frac{1}{2} t \\mu c^2 (a) \\left( \\frac{a^3}{12} \\right) = \\frac{t \\mu c^2 a^4}{24}\n    $$\n\n*   **稳定化能, $\\Pi_{\\mathrm{hg}}$**:\n    公式为 $\\Pi_{\\mathrm{hg}} = \\frac{1}{2}\\beta \\mu t (q_x^2 + q_y^2)$。\n    首先，从 $u_x = cxy$ 和 $u_y = 0$ 中求出节点位移：\n    $u_{1x} = c(-a/2)(-a/2) = ca^2/4$\n    $u_{2x} = c(a/2)(-a/2) = -ca^2/4$\n    $u_{3x} = c(a/2)(a/2) = ca^2/4$\n    $u_{4x} = c(-a/2)(a/2) = -ca^2/4$\n    所有的 $u_{iy}$ 均为零，所以 $q_y = \\frac{1}{4}\\sum s_i u_{iy} = 0$。\n    现在，计算 $q_x$：\n    $$\n    q_x = \\frac{1}{4}(u_{1x}-u_{2x}+u_{3x}-u_{4x}) = \\frac{1}{4} \\left[ \\frac{ca^2}{4} - \\left(-\\frac{ca^2}{4}\\right) + \\frac{ca^2}{4} - \\left(-\\frac{ca^2}{4}\\right) \\right]\n    $$\n    $$\n    q_x = \\frac{1}{4} \\left( 4 \\times \\frac{ca^2}{4} \\right) = \\frac{ca^2}{4}\n    $$\n    将 $q_x$ 和 $q_y$ 代入能量表达式：\n    $$\n    \\Pi_{\\mathrm{hg}} = \\frac{1}{2} \\beta \\mu t \\left( \\left( \\frac{ca^2}{4} \\right)^2 + 0^2 \\right) = \\frac{1}{2} \\beta \\mu t \\frac{c^2 a^4}{16} = \\frac{\\beta t \\mu c^2 a^4}{32}\n    $$\n\n*   **令能量相等以求 $\\beta$**:\n    我们令 $\\Pi_{\\mathrm{exact}} = \\Pi_{\\mathrm{hg}}$:\n    $$\n    \\frac{t \\mu c^2 a^4}{24} = \\frac{\\beta t \\mu c^2 a^4}{32}\n    $$\n    消去公因子 $(t \\mu c^2 a^4)$，剩下：\n    $$\n    \\frac{1}{24} = \\frac{\\beta}{32}\n    $$\n    求解 $\\beta$：\n    $$\n    \\beta = \\frac{32}{24} = \\frac{4}{3}\n    $$", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2639873"}]}