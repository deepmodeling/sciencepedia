{"hands_on_practices": [{"introduction": "理论学习的下一步是将其付诸实践。本练习旨在揭开有限元方法的神秘面纱，引导您为一个简单的一维边值问题手动构建系统矩阵。通过亲自计算，您将具体地理解“刚度矩阵”和“力向量”等核心概念是如何从弱形式积分中产生的，从而在连续的数学理论与离散的数值求解之间建立起坚实的桥梁。[@problem_id:2440325]", "problem": "考虑在区间 $\\left(0,1\\right)$ 上的稳态一维扩散边界值问题 (BVP)：\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) \\;=\\; f_0 \\quad \\text{在 } \\left(0,1\\right) \\text{ 内},\n$$\n其本质边界条件为 $u(0)=0$，自然边界条件为 $k\\,u'(1)=t_0$，其中 $k>0$，$f_0$ 和 $t_0$ 是给定的常数。使用标准伽辽金有限元法 (FEM)，在 $\\left[0,1\\right]$ 上使用两个均匀的线性单元（节点位于 $x_0=0$, $x_1=\\tfrac{1}{2}$, $x_2=1$），将此问题的弱形式离散化。在施加本质边界条件 $u(0)=0$ 后，手动构建与未知节点值 $u_1$ 和 $u_2$ 关联的组装后的简化的 $2\\times 2$ 全局刚度矩阵及相应的右侧力向量。\n\n将此组装后的简化的 $2\\times 2$ 刚度矩阵的行列式作为您的最终答案，以仅含 $k$ 的简化解析表达式表示。不包括单位。无需四舍五入。", "solution": "首先将对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- 微分方程：$- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) = f_0$\n- 定义域：$x \\in (0,1)$\n- 边界条件：$u(0)=0$ (本质) 和 $k\\,u'(1)=t_0$ (自然)\n- 常数：$k>0$，$f_0$，$t_0$ 是给定的常数。\n- 离散化：使用两个均匀线性单元的标准伽辽金有限元法 (FEM)。\n- 节点：$x_0=0$, $x_1=\\tfrac{1}{2}$, $x_2=1$。\n- 目标：为未知节点值 $u_1$ 和 $u_2$ 构建简化的 $2\\times 2$ 全局刚度矩阵和力向量，然后求此刚度矩阵的行列式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是一个标准的二阶一维扩散边界值问题。\n- **科学依据：**该问题是稳态热传导或扩散的典型表示，是物理学和工程学中的一个基本概念。它在科学上是合理的。\n- **良态性：**对于二阶椭圆方程，一端的本质边界条件和另一端的自然（诺伊曼）边界条件的组合确保了唯一且稳定解的存在。该问题是良态的。\n- **客观性：**问题使用精确的数学语言陈述，没有主观或含糊的术语。\n- **完整性：**所有必要信息，包括微分方程、定义域、边界条件、离散化方案和所需输出，都已明确提供。该问题是自洽的。\n\n**步骤 3：结论和行动**\n问题有效。将推导一个完整的解。\n\n出发点是边界值问题的强形式：\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) = f_0 \\quad \\text{对于 } x \\in (0,1)\n$$\n边界条件为 $u(0)=0$ 和 $k \\frac{du}{dx}(1) = t_0$。\n\n为了推导弱形式，我们将微分方程乘以一个合适的检验函数 $v(x)$，并在定义域 $\\Omega = (0,1)$ 上积分：\n$$\n-\\int_{0}^{1} v \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) dx = \\int_{0}^{1} v f_0 dx\n$$\n对左侧项应用分部积分法，得到：\n$$\n\\int_{0}^{1} \\frac{dv}{dx} k \\frac{du}{dx} dx - \\left[ v k \\frac{du}{dx} \\right]_{0}^{1} = \\int_{0}^{1} v f_0 dx\n$$\n重新整理并代入边界条件：\n$$\n\\int_{0}^{1} k \\frac{du}{dx} \\frac{dv}{dx} dx = \\int_{0}^{1} f_0 v dx + v(1) \\left(k \\frac{du}{dx}(1)\\right) - v(0) \\left(k \\frac{du}{dx}(0)\\right)\n$$\n本质边界条件是 $u(0)=0$。检验函数 $v$ 必须属于一个函数空间，其中函数满足其齐次形式的该条件，即 $v(0)=0$。这使得包含 $v(0)$ 的项消失。自然边界条件是 $k \\frac{du}{dx}(1) = t_0$。这个值被直接代入。\n\n弱形式为：求 $u(x) \\in V = \\{ w \\in H^1(0,1) | w(0)=0 \\}$，使得对于所有 $v(x) \\in V$：\n$$\n\\int_{0}^{1} k u'(x) v'(x) dx = \\int_{0}^{1} f_0 v(x) dx + t_0 v(1)\n$$\n定义域 $[0,1]$ 被离散化为两个均匀单元，记作 $\\Omega_1 = [0, \\tfrac{1}{2}]$ 和 $\\Omega_2 = [\\tfrac{1}{2}, 1]$。节点位于 $x_0=0$, $x_1=\\tfrac{1}{2}$ 和 $x_2=1$。单元长度为 $h = \\tfrac{1}{2}$。\n\n我们使用线性基（形）函数 $N_i(x)$ 来近似解 $u(x)$：\n$$\nu(x) \\approx u^h(x) = \\sum_{j=0}^{2} u_j N_j(x) = u_0 N_0(x) + u_1 N_1(x) + u_2 N_2(x)\n$$\n其中 $u_j = u(x_j)$ 是节点值。伽辽金法使用基函数作为检验函数，$v(x) = N_i(x)$。\n\n长度为 $h$ 的线性单元的单元刚度矩阵由 $K^{(e)}_{ij} = \\int_{\\Omega_e} k \\frac{dN_j}{dx} \\frac{dN_i}{dx} dx$ 给出。对于常数 $k$ 和单元长度 $h$，它为：\n$$\nK^{(e)} = \\frac{k}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n由于 $h=\\tfrac{1}{2}$，两个单元的刚度矩阵为：\n$$\nK^{(1)} = K^{(2)} = \\frac{k}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\n来自源项 $f_0$ 的单元力向量为 $F^{(e)}_{f,i} = \\int_{\\Omega_e} f_0 N_i dx$。对于常数 $f_0$ 和线性单元，它为：\n$$\nF^{(e)}_f = \\frac{f_0 h}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n由于 $h=\\tfrac{1}{2}$，两个单元的力向量为：\n$$\nF^{(1)}_f = F^{(2)}_f = \\frac{f_0 (1/2)}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/4 \\end{pmatrix}\n$$\n现在，我们组装 $3 \\times 3$ 的全局系统 $K \\mathbf{u} = F$。\n全局刚度矩阵 $K$ 是通过对每个单元的贡献求和来组装的：\n$$\nK_{00} = K^{(1)}_{11} = 2k\n$$\n$$\nK_{11} = K^{(1)}_{22} + K^{(2)}_{11} = 2k + 2k = 4k\n$$\n$$\nK_{22} = K^{(2)}_{22} = 2k\n$$\n$$\nK_{01} = K_{10} = K^{(1)}_{12} = -2k\n$$\n$$\nK_{12} = K_{21} = K^{(2)}_{12} = -2k\n$$\n所以，全局刚度矩阵是：\n$$\nK = \\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix}\n$$\n全局力向量 $F$ 包含来自源项 $f_0$ 和自然边界条件 $t_0$ 的贡献。总力向量为 $F_i = \\int_0^1 f_0 N_i dx + t_0 N_i(1)$。\n$$\nF_0 = \\int_{\\Omega_1} f_0 N_0 dx + t_0 N_0(1) = f_0/4 + t_0(0) = f_0/4\n$$\n$$\nF_1 = \\int_{\\Omega_1} f_0 N_1 dx + \\int_{\\Omega_2} f_0 N_1 dx + t_0 N_1(1) = f_0/4 + f_0/4 + t_0(0) = f_0/2\n$$\n$$\nF_2 = \\int_{\\Omega_2} f_0 N_2 dx + t_0 N_2(1) = f_0/4 + t_0(1) = f_0/4 + t_0\n$$\n组装后的系统是：\n$$\n\\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\n接下来，我们施加本质边界条件 $u(0)=u_0=0$。这将系统简化为关于未知节点值 $u_1$ 和 $u_2$ 的 $2 \\times 2$ 系统。我们考虑完整系统的第二行和第三行，并代入 $u_0=0$：\n$$\n-2k(u_0) + 4k u_1 - 2k u_2 = f_0/2 \\implies 4k u_1 - 2k u_2 = f_0/2\n$$\n$$\n0(u_0) - 2k u_1 + 2k u_2 = f_0/4 + t_0 \\implies -2k u_1 + 2k u_2 = f_0/4 + t_0\n$$\n得到的简化的 $2 \\times 2$ 系统是：\n$$\n\\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\n问题要求计算组装后的简化的 $2 \\times 2$ 全局刚度矩阵的行列式，该矩阵为：\n$$\nK_{reduced} = \\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\n行列式计算如下：\n$$\n\\det(K_{reduced}) = (4k)(2k) - (-2k)(-2k) = 8k^2 - 4k^2 = 4k^2\n$$\n这就是所要求的表达式。", "answer": "$$\\boxed{4k^{2}}$$", "id": "2440325"}, {"introduction": "本练习旨在探索弱形式的优越性与强大功能，特别是在处理复杂载荷情况时。现实世界中的问题常常涉及难以用强形式直接处理的集中力或点源，而本例中的点热源就属于这种情况。通过这个实践，您将看到弱形式的积分特性如何自然且严谨地处理这类奇异性，展示其在解决实际工程问题中的独特优势。[@problem_id:2440379]", "problem": "一根长度为 $L$、横截面积恒为 $A$ 的细杆在稳态下导热，其热导率 $k$ 为常数。杆内没有分布式的体积热源，但在位置 $x_p$ 处施加了一个总速率为 $Q$ (单位：瓦特) 的集中点热源，其中 $0 < x_p < a < L$。边界温度给定为 $u(0) = 0$ 和 $u(L) = 0$。你需要推导此边值问题的强形式和弱形式，然后使用有限元法 (FEM) 对解进行近似。有限元网格由两个线性单元和三个节点 ($x_0 = 0$, $x_1 = a$, $x_2 = L$) 构成，并特意选择 $x_p \\neq x_i$ (对于任意节点)，以使点热源严格位于左侧单元内部。\n\n仅从能量守恒和傅里叶定律出发，不使用任何简便公式：\n\n- 推导描述该情况的温度场 $u(x)$ 在 $(0,L)$ 上的强形式，包括所有边界条件。\n- 将强形式乘以一个满足本质边界条件的光滑试函数 $v(x)$，并进行一次分部积分，从而推导弱形式，同时指明所涉及的函数空间。\n- 在每个单元上构建双节点线性形函数，并利用弱形式得到关于三个节点温度 $u_0$, $u_1$, $u_2$ 的单元级和组装后的全局有限元平衡方程。\n- 施加本质边界条件 $u_0 = 0$ 和 $u_2 = 0$，并求解得到的简化方程组，以得到内部节点温度 $u_1$ 关于 $Q$, $k$, $A$, $L$, $a$ 和 $x_p$ 的闭式解。\n\n将你的最终结果表示为 $u_1$ 的单个闭式解析表达式。温度单位为开尔文。", "solution": "在尝试任何求解之前，将对问题进行验证。这不是可选项，而是严谨科学工作的必要步骤。\n\n步骤 1：提取已知条件。\n- 一根长度为 $L$、横截面积恒为 $A$ 的细杆。\n- 导热过程处于稳态。\n- 热导率 $k$ 为常数。\n- 无分布式体积热源。\n- 在位置 $x_p$ 处施加一个总速率为 $Q$ 的集中点热源。\n- 热源位置满足 $0 < x_p < a < L$。\n- 给定的边界温度：$u(0) = 0$ 和 $u(L) = 0$。\n- 解将使用有限元法 (FEM) 和一个包含两个线性单元的网格进行近似。\n- 三个节点位于 $x_0 = 0$, $x_1 = a$ 和 $x_2 = L$。\n- 点热源严格位于第一个单元内部，因为对于任意节点 $i$，$x_p \\neq x_i$。\n- 节点温度 $u_1$ 的最终结果必须是单个闭式解析表达式。\n- 温度以开尔文表示。\n\n步骤 2：使用提取的已知条件进行验证。\n根据有效性标准对问题进行评估。\n- **科学依据**：该问题基于热传递的基本原理，即能量守恒和傅里叶热传导定律。使用点热源，并通过狄拉克δ函数进行数学表示，是物理学和工程分析中一种标准且有效的理想化方法。该问题在科学上是合理的。\n- **适定性**：该问题描述了一个二阶常微分方程，并在两端给定了狄利克雷边界条件。这构成了一个适定的边值问题，预期存在唯一解。\n- **客观性**：问题陈述使用了精确、无歧义的技术语言，不包含主观或基于观点的内容。\n- **完整性与一致性**：所有必要的参数（$L, A, k, Q, x_p, a$）、边界条件和几何约束均已提供。这些条件内部是一致的（例如，$0 < x_p < a < L$ 准确地将热源置于所定义网格的第一个单元内）。\n- **物理真实性**：虽然 $u(0) = 0$ 开尔文的边界条件在物理上是不可能实现的，但它在理论问题中是一种常见的数学简化，通常表示相对于某个参考温度的温差。我们将基于这是一种数学理想化的理解继续进行。\n\n步骤 3：结论与行动。\n问题是有效的。将推导解答。\n\n推导将按要求的四个阶段进行。\n\n首先，我们推导边值问题的强形式。\n控制原理是稳态下的能量守恒。对于杆内不包含热源 $x_p$ 的任意段 $[x_a, x_b]$，在 $x_a$ 处流入的热量速率必须等于在 $x_b$ 处流出的热量速率。热流率由热通量 $q(x)$ 与面积 $A$ 的乘积给出。因此，$q(x_a)A - q(x_b)A = 0$。\n傅里叶定律指出 $q(x) = -k \\frac{du}{dx}$。将其代入能量平衡方程，得到 $-kA\\frac{du}{dx}|_{x_a} - (-kA\\frac{du}{dx}|_{x_b}) = 0$。由于这对任意区间 $[x_a, x_b]$ 都成立，这意味着量 $-kA \\frac{du}{dx}$ 是一个常数。对 $x$ 求导，得到无源区域的控制微分方程：\n$$\n\\frac{d}{dx}\\left(-kA\\frac{du}{dx}\\right) = 0\n$$\n由于 $k$ 和 $A$ 是常数，该方程简化为 $\\frac{d^2u}{dx^2} = 0$，适用于 $x \\in (0, L)$ 且 $x \\neq x_p$。\n\n在点热源位置 $x_p$ 处，我们对一个无穷小控制体积 $[x_p - \\epsilon, x_p + \\epsilon]$（当 $\\epsilon \\to 0$ 时）进行能量平衡。平衡关系为：（在 $x_p-\\epsilon$ 处流入的热量）-（在 $x_p+\\epsilon$ 处流出的热量）+（热源项）= $0$。\n$$\n\\left(-kA\\frac{du}{dx}\\right)\\bigg|_{x_p-\\epsilon} - \\left(-kA\\frac{du}{dx}\\right)\\bigg|_{x_p+\\epsilon} + Q = 0\n$$\n这表示热通量存在一个不连续性。我们可以使用狄拉克δ函数 $\\delta(x-x_p)$ 来表示分布在整个域上的源项 $Q$。整个域 $(0,L)$ 的控制方程变为：\n$$\n-kA\\frac{d^2u}{dx^2} = Q \\delta(x-x_p)\n$$\n强形式是求解满足此微分方程和给定的狄利克雷边界条件 $u(0)=0$ 及 $u(L)=0$ 的温度场 $u(x)$。\n\n第二，我们推导弱形式。\n我们将强形式的微分方程乘以一个光滑的试函数 $v(x)$，并在域 $\\Omega = (0, L)$ 上积分。试函数 $v(x)$ 必须属于函数空间 $V$，该空间中的函数满足本质边界条件的齐次形式，即 $v(0)=0$ 和 $v(L)=0$。\n$$\n\\int_0^L \\left(-kA\\frac{d^2u}{dx^2} - Q \\delta(x-x_p)\\right) v(x) \\,dx = 0\n$$\n此式必须对所有 $v \\in V$ 成立。我们分离各项：\n$$\n-\\int_0^L kA\\frac{d^2u}{dx^2} v(x) \\,dx - \\int_0^L Q \\delta(x-x_p) v(x) \\,dx = 0\n$$\n第二个积分利用狄拉克δ函数的筛选性质进行计算：$\\int_0^L Q \\delta(x-x_p) v(x) \\,dx = Q v(x_p)$。\n我们对第一项使用分部积分法，$\\int u''v = [u'v] - \\int u'v'$：\n$$\n-\\int_0^L kA\\frac{d^2u}{dx^2} v(x) \\,dx = -kA \\left[ \\frac{du}{dx} v(x) \\right]_0^L + \\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx\n$$\n边界项 $-kA \\left( \\frac{du}{dx}|_L v(L) - \\frac{du}{dx}|_0 v(0) \\right)$ 为零，因为对于任何试函数 $v \\in V$，都有 $v(L)=0$ 和 $v(0)=0$。\n代回原式，方程变为：\n$$\n\\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx - Q v(x_p) = 0\n$$\n弱形式为：寻找 $u \\in U = \\{u \\in H^1(0,L) \\mid u(0)=0, u(L)=0\\}$，使得对于所有 $v \\in V = \\{v \\in H^1(0,L) \\mid v(0)=0, v(L)=0\\}$，以下关系成立：\n$$\n\\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx = Q v(x_p)\n$$\n此处，$H^1(0,L)$ 是定义在 $(0,L)$ 上且其一阶导数平方可积的函数所构成的索博列夫空间。\n\n第三，我们构建有限元近似。\n域 $[0, L]$ 被节点 $x_0=0, x_1=a, x_2=L$ 离散化，形成两个单元：单元1覆盖 $[0,a]$，单元2覆盖 $[a,L]$。\n温度场 $u(x)$ 和试函数 $v(x)$ 使用线性形函数 $N_i(x)$ 进行近似：\n$u(x) \\approx u_h(x) = \\sum_{i=0}^{2} u_i N_i(x)$ 和 $v(x) \\approx v_h(x) = \\sum_{j=0}^{2} c_j N_j(x)$，其中 $u_i$ 是未知的节点温度，$c_j$ 是任意系数。\n\n全局形函数 $N_i(x)$ 是分段线性的。\n对于单元1（$x \\in [0, a]$，长度 $L_e^{(1)}=a$）：\n$N_0^{(1)}(x) = 1 - \\frac{x}{a}$， $N_1^{(1)}(x) = \\frac{x}{a}$。\n它们的导数为 $\\frac{dN_0^{(1)}}{dx} = -\\frac{1}{a}$， $\\frac{dN_1^{(1)}}{dx} = \\frac{1}{a}$。\n\n对于单元2（$x \\in [a, L]$，长度 $L_e^{(2)}=L-a$）：\n$N_1^{(2)}(x) = 1 - \\frac{x-a}{L-a} = \\frac{L-x}{L-a}$， $N_2^{(2)}(x) = \\frac{x-a}{L-a}$。\n它们的导数为 $\\frac{dN_1^{(2)}}{dx} = -\\frac{1}{L-a}$， $\\frac{dN_2^{(2)}}{dx} = \\frac{1}{L-a}$。\n\n将这些近似代入弱形式，得到代数方程组 $[K]\\{u\\}=\\{F\\}$。\n刚度矩阵的分量为 $K_{ji} = \\int_0^L kA \\frac{dN_j}{dx} \\frac{dN_i}{dx} dx$。\n力向量的分量为 $F_j = Q N_j(x_p)$。\n\n长度为 $L_e$ 的一维线性单元的单元刚度矩阵为 $k^{(e)} = \\frac{kA}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n对于单元1（节点0, 1），$L_e=a$：$k^{(1)} = \\frac{kA}{a} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n对于单元2（节点1, 2），$L_e=L-a$：$k^{(2)} = \\frac{kA}{L-a} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n\n由于 $0 < x_p < a$，位于 $x_p$ 处的热源 $Q$ 在单元1内部。\n单元力向量为 $F^{(e)}_j = \\int_{L_e} Q \\delta(x-x_p) N_j^{(e)}(x) dx = Q N_j^{(e)}(x_p)$。\n对于单元1（节点0, 1）：$F^{(1)} = \\begin{pmatrix} Q N_0^{(1)}(x_p) \\\\ Q N_1^{(1)}(x_p) \\end{pmatrix} = Q \\begin{pmatrix} 1-x_p/a \\\\ x_p/a \\end{pmatrix}$。\n对于单元2，没有热源：$F^{(2)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n组装节点 (0, 1, 2) 的全局系统：\n$K_{00} = k^{(1)}_{00} = \\frac{kA}{a}$\n$K_{11} = k^{(1)}_{11} + k^{(2)}_{11} = \\frac{kA}{a} + \\frac{kA}{L-a}$\n$K_{22} = k^{(2)}_{22} = \\frac{kA}{L-a}$\n$K_{01}=K_{10} = k^{(1)}_{01} = -\\frac{kA}{a}$\n$K_{12}=K_{21} = k^{(2)}_{12} = -\\frac{kA}{L-a}$\n$K_{02}=K_{20} = 0$\n全局刚度矩阵为 $K = kA \\begin{pmatrix} \\frac{1}{a} & -\\frac{1}{a} & 0 \\\\ -\\frac{1}{a} & \\frac{1}{a} + \\frac{1}{L-a} & -\\frac{1}{L-a} \\\\ 0 & -\\frac{1}{L-a} & \\frac{1}{L-a} \\end{pmatrix}$。\n\n全局力向量为 $F = \\begin{pmatrix} F^{(1)}_0 \\\\ F^{(1)}_1 + F^{(2)}_1 \\\\ F^{(2)}_2 \\end{pmatrix} = \\begin{pmatrix} Q(1-x_p/a) \\\\ Q(x_p/a) \\\\ 0 \\end{pmatrix}$。\n\n完整的方程组为：\n$$\nkA \\begin{pmatrix} \\frac{1}{a} & -\\frac{1}{a} & 0 \\\\ -\\frac{1}{a} & \\frac{1}{a} + \\frac{1}{L-a} & -\\frac{1}{L-a} \\\\ 0 & -\\frac{1}{L-a} & \\frac{1}{L-a} \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = Q \\begin{pmatrix} 1 - \\frac{x_p}{a} \\\\ \\frac{x_p}{a} \\\\ 0 \\end{pmatrix}\n$$\n\n第四，我们施加边界条件并求解 $u_1$。\n本质边界条件是 $u_0 = 0$ 和 $u_2 = 0$。这些节点是受约束的。唯一的未知数是自由节点 $x_1=a$ 处的温度 $u_1$。我们只需要与此自由度相对应的方程，即矩阵系统的第二行：\n$$\nkA \\left[ -\\frac{1}{a} u_0 + \\left(\\frac{1}{a} + \\frac{1}{L-a}\\right)u_1 - \\frac{1}{L-a} u_2 \\right] = Q \\frac{x_p}{a}\n$$\n代入 $u_0 = 0$ 和 $u_2 = 0$：\n$$\nkA \\left(\\frac{1}{a} + \\frac{1}{L-a}\\right)u_1 = Q \\frac{x_p}{a}\n$$\n我们简化括号中的项：\n$$\n\\frac{1}{a} + \\frac{1}{L-a} = \\frac{L-a+a}{a(L-a)} = \\frac{L}{a(L-a)}\n$$\n关于 $u_1$ 的方程变为：\n$$\nkA \\frac{L}{a(L-a)} u_1 = Q \\frac{x_p}{a}\n$$\n最后，我们求解 $u_1$：\n$$\nu_1 = \\frac{Q x_p/a}{kA L / (a(L-a))} = \\frac{Q x_p}{a} \\cdot \\frac{a(L-a)}{kA L}\n$$\n$$\nu_1 = \\frac{Q x_p (L-a)}{kA L}\n$$\n这是节点 $x_1=a$ 处温度的闭式解。单位分析 $\\frac{[W][m][m]}{[W/(m \\cdot K)][m^2][m]} = [K]$ 证实了结果是温度，与问题要求一致。", "answer": "$$\n\\boxed{\\frac{Q x_p (L-a)}{k A L}}\n$$", "id": "2440379"}, {"introduction": "在掌握了基本概念后，我们需要处理更贴近实际的工程场景。许多教科书示例都使用齐次（零）边界条件，但工程问题几乎总是涉及非零的指定位移。本练习引入了一种处理非齐次本质边界条件的关键技巧——“提升函数”法。这种方法能将复杂的非齐次问题转化为我们熟悉的标准变分形式，是有限元理论分析中的一个重要工具。[@problem_id:2711090]", "problem": "考虑一根一维轴向受载杆，占据开区间 $\\Omega = (0,L)$，其中 $L>0$。设轴向刚度场为 $k(x)$，分布轴向载荷为 $f(x)$，两者在 $\\Omega$ 上均足够光滑。在小应变、静力平衡且无惯性效应的条件下，位移场 $u(x)$ 满足具有本质（狄利克雷）边界条件 $u(0)=0$ 和 $u(L)=\\delta$ 的强形式边值问题，其中 $\\delta$ 是一个给定的非零位移。在此背景下，您的任务是：\n- 从轴向变形的虚功原理以及应变和轴向力的定义出发，通过引入一个满足 $w(0)=0$ 和 $w(L)=\\delta$ 的提升函数 $w(x)$，并令 $v(x) \\coloneqq u(x)-w(x) \\in H_{0}^{1}(0,L)$，推导出在索博列夫空间 $H^{1}(0,L)$ 上具有齐次本质数据的弱（变分）形式。在您为 $v$ 导出的弱形式中，明确指出双线性形式和线性泛函。\n- 将问题具体化到以下数据：$k(x) = k_{0}\\left(1+\\alpha x\\right)$，其中 $k_{0}>0$ 且 $\\alpha$ 为实数；以及 $f(x)= f_{0}\\, x$，其中 $f_{0}$ 为实数。选择线性提升函数 $w(x)=\\delta\\, x/L$，以满足 $w(0)=0$ 和 $w(L)=\\delta$。对于特定的测试函数 $\\varphi(x) = \\dfrac{x\\,(L-x)}{L} \\in H_{0}^{1}(0,L)$，计算在您的 $v$ 的弱形式右侧出现的线性泛函 $\\ell(\\varphi)$ 的闭式解。\n\n请用符号 $k_{0}$、$\\alpha$、$f_{0}$、$L$ 和 $\\delta$ 以单一闭式解析表达式的形式给出您的最终答案。最终表达式中不要包含单位。不需要进行数值取整。", "solution": "该问题要求推导具有非齐次狄利克雷边界条件的轴向受载杆的弱形式，然后基于此形式进行特定计算。解题过程首先从验证问题陈述开始。经审查，该问题具有科学依据，是适定的、客观的且内部一致的，包含了求解所需的所有信息。它代表了变分原理在固体力学中的一个标准应用。因此，我将继续进行求解。\n\n一维杆的静力平衡强形式由以下微分方程给出：\n$$\n\\frac{d}{dx}\\left( N(x) \\right) + f(x) = 0 \\quad \\text{for } x \\in \\Omega = (0,L)\n$$\n其中 $N(x)$ 是内轴向力，$f(x)$ 是分布轴向载荷。小应变下线性弹性的本构关系通过轴向刚度 $k(x) = E(x)A(x)$ 将轴向力与位移梯度（应变, $\\varepsilon$）联系起来，其中 $E(x)$ 是杨氏模量，$A(x)$ 是横截面积。应变为 $\\varepsilon(x) = \\frac{du}{dx}$。因此，$N(x) = k(x) \\frac{du}{dx}$。将此代入平衡方程，得到位移 $u(x)$ 的强形式边值问题：\n$$\n\\frac{d}{dx}\\left( k(x) \\frac{du}{dx} \\right) + f(x) = 0, \\quad u(0)=0, \\quad u(L)=\\delta\n$$\n\n为了推导弱形式，我们采用虚功原理。该原理指出，对于任何运动学上容许的虚位移 $\\varphi(x)$，内虚功等于外虚功。对于这个问题，本质边界条件在 $x=0$ 和 $x=L$ 处指定。因此，任何容许的虚位移必须在这些点上为零，即 $\\varphi(0)=0$ 和 $\\varphi(L)=0$。这类测试函数的空间是索博列夫空间 $H_{0}^{1}(0,L)$。\n\n内虚功是应力对虚应变所做的功：\n$$\n\\delta W_{\\text{int}} = \\int_{0}^{L} N(x) \\delta \\varepsilon(x) \\, dx = \\int_{0}^{L} \\left( k(x) \\frac{du}{dx} \\right) \\left( \\frac{d\\varphi}{dx} \\right) \\, dx\n$$\n外虚功是所施加的体力所做的功：\n$$\n\\delta W_{\\text{ext}} = \\int_{0}^{L} f(x) \\varphi(x) \\, dx\n$$\n令内虚功等于外虚功，我们得到位移 $u(x)$ 的弱形式：求 $u \\in H^{1}(0,L)$，使得 $u(0)=0$ 和 $u(L)=\\delta$，并满足\n$$\n\\int_{0}^{L} k(x) \\frac{du}{dx} \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx \\quad \\forall \\varphi \\in H_{0}^{1}(0,L)\n$$\n\n该问题指定通过将解 $u(x)$ 分解为 $u(x) = v(x) + w(x)$ 来处理非齐次边界条件 $u(L)=\\delta$。这里，$w(x)$ 是 $H^{1}(0,L)$ 中的一个已知“提升”函数，它满足非齐次边界条件 $w(0)=0$ 和 $w(L)=\\delta$。新的未知量 $v(x)$ 则必须满足齐次边界条件，$v(0)=u(0)-w(0)=0-0=0$ 和 $v(L)=u(L)-w(L)=\\delta-\\delta=0$。这意味着新的未知函数 $v(x)$ 属于与测试函数相同的空间，即 $v \\in H_{0}^{1}(0,L)$。\n\n我们将分解式 $u(x) = v(x) + w(x)$ 代入弱形式。其导数为 $\\frac{du}{dx} = \\frac{dv}{dx} + \\frac{dw}{dx}$。这得到：\n$$\n\\int_{0}^{L} k(x) \\left( \\frac{dv}{dx} + \\frac{dw}{dx} \\right) \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx\n$$\n利用积分的线性性质，我们展开左侧：\n$$\n\\int_{0}^{L} k(x) \\frac{dv}{dx} \\frac{d\\varphi}{dx} \\, dx + \\int_{0}^{L} k(x) \\frac{dw}{dx} \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx\n$$\n为了得到关于 $v$ 的标准变分问题，我们将所有涉及已知函数 $w(x)$ 和 $f(x)$ 的项移到右侧。未知量 $v(x)$ 留在左侧。\n$$\n\\int_{0}^{L} k(x) \\frac{dv}{dx} \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx - \\int_{0}^{L} k(x) \\frac{dw}{dx} \\frac{d\\varphi}{dx} \\, dx\n$$\n这就是 $v(x)$ 的弱形式。其形式为 $a(v, \\varphi) = \\ell(\\varphi)$，其中：\n- 双线性形式为 $a(v, \\varphi) = \\int_{0}^{L} k(x) v'(x) \\varphi'(x) \\, dx$。\n- 线性泛函为 $\\ell(\\varphi) = \\int_{0}^{L} f(x) \\varphi(x) \\, dx - \\int_{0}^{L} k(x) w'(x) \\varphi'(x) \\, dx$。\n\n现在，我们针对给定的数据，并为指定的测试函数计算 $\\ell(\\varphi)$。\n给定的函数是：\n- 刚度：$k(x) = k_{0}(1+\\alpha x)$\n- 载荷：$f(x)= f_{0}x$\n- 提升函数：$w(x)=\\delta x/L$，所以其导数为 $w'(x) = \\delta/L$。\n- 测试函数：$\\varphi(x) = \\frac{x(L-x)}{L} = x - \\frac{x^2}{L}$，所以其导数为 $\\varphi'(x) = 1 - \\frac{2x}{L}$。\n\n线性泛函 $\\ell(\\varphi)$ 是两个积分之和，我们分别计算它们。\n$$\n\\ell(\\varphi) = \\underbrace{\\int_{0}^{L} f_{0}x \\left( \\frac{x(L-x)}{L} \\right) \\, dx}_{I_1} - \\underbrace{\\int_{0}^{L} k_{0}(1+\\alpha x) \\left(\\frac{\\delta}{L}\\right) \\left(1 - \\frac{2x}{L}\\right) \\, dx}_{I_2}\n$$\n第一个积分 $I_1$ 是：\n$$\nI_1 = \\frac{f_{0}}{L} \\int_{0}^{L} (Lx^2 - x^3) \\, dx = \\frac{f_{0}}{L} \\left[ L\\frac{x^3}{3} - \\frac{x^4}{4} \\right]_{0}^{L} = \\frac{f_{0}}{L} \\left( \\frac{L^4}{3} - \\frac{L^4}{4} \\right) = \\frac{f_{0}}{L} \\left( \\frac{L^4}{12} \\right) = \\frac{f_{0}L^3}{12}\n$$\n第二个积分 $I_2$ 是：\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\int_{0}^{L} (1+\\alpha x)\\left(1 - \\frac{2x}{L}\\right) \\, dx = \\frac{k_{0}\\delta}{L} \\int_{0}^{L} \\left(1 - \\frac{2x}{L} + \\alpha x - \\frac{2\\alpha x^2}{L}\\right) \\, dx\n$$\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\left[ x - \\frac{x^2}{L} + \\frac{\\alpha x^2}{2} - \\frac{2\\alpha x^3}{3L} \\right]_{0}^{L}\n$$\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\left( (L - \\frac{L^2}{L} + \\frac{\\alpha L^2}{2} - \\frac{2\\alpha L^3}{3L}) - (0) \\right) = \\frac{k_{0}\\delta}{L} \\left( L - L + \\frac{\\alpha L^2}{2} - \\frac{2\\alpha L^2}{3} \\right)\n$$\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\left( \\frac{3\\alpha L^2 - 4\\alpha L^2}{6} \\right) = \\frac{k_{0}\\delta}{L} \\left( -\\frac{\\alpha L^2}{6} \\right) = -\\frac{k_{0}\\alpha\\delta L}{6}\n$$\n最后，我们计算 $\\ell(\\varphi) = I_1 - I_2$：\n$$\n\\ell(\\varphi) = \\frac{f_{0}L^3}{12} - \\left(-\\frac{k_{0}\\alpha\\delta L}{6}\\right) = \\frac{f_{0}L^3}{12} + \\frac{k_{0}\\alpha\\delta L}{6}\n$$\n这就是在给定测试函数 $\\varphi(x)$ 下，线性泛函的闭式表达式。", "answer": "$$\n\\boxed{\\frac{f_{0}L^{3}}{12} + \\frac{k_{0}\\alpha\\delta L}{6}}\n$$", "id": "2711090"}]}