{"hands_on_practices": [{"introduction": "理论学习之后，通过实践来巩固理解是至关重要的。这项练习将引导您完整地体验一次标准的伽辽金有限元分析流程，从一个典型的一维扩散问题出发，推导其弱形式，计算单元刚度矩阵，并最终组装成全局系统。通过这项实践[@problem_id:2698892]，您将掌握将偏微分方程转化为可解代数系统的核心技能，并理解全局矩阵的稀疏性、对称性和正定性等重要性质的物理和数学根源。", "problem": "一个在无量纲域 $\\Omega = [0,1]$ 上的一维稳态扩散问题由强形式 $- \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) = f(x)$ 控制，并带有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。考虑材料传导系数 $k(x) = 2(1+x)$ 和零源项 $f(x) = 0$。使用节点位于 $x_0 = 0$、$x_1 = \\frac{1}{4}$、$x_2 = \\frac{3}{4}$ 和 $x_3 = 1$ 的非均匀网格对 $\\Omega$ 进行离散化，并使用每个单元上的连续 Lagrange 形函数通过分段线性有限元展开来近似 $u(x)$。使用带有伽辽金权函数（即检验函数等于试探形函数）的加权余量法，完成以下任务：\n\n1. 从强形式和通量守恒出发，通过乘以一个容许权函数 $w(x)$ 并在 $\\Omega$ 上积分，然后应用分部积分将导数从 $u(x)$ 上移开，来推导弱形式。明确指出双线性形式和线性泛函。\n\n2. 对于一个端节点位于 $x_i$ 和 $x_{i+1}$、单元尺寸为 $h_e = x_{i+1}-x_i$ 的通用单元 $e$，写出刚度矩阵项 $k^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} k(x)\\,\\frac{dN_a}{dx}\\,\\frac{dN_b}{dx}\\,dx$（其中 $a,b \\in \\{1,2\\}$）的单元级伽辽金表达式，其中 $N_1$ 和 $N_2$ 是单元 $e$ 上的局部线性形函数。在求值之前明确写出积分表达式。\n\n3. 对给定网格的每个单元精确计算这些积分，并计算在 $[x_0,x_1]$、$[x_1,x_2]$ 和 $[x_2,x_3]$ 上的单元的显式 $2\\times 2$ 单元刚度矩阵。\n\n4. 组装与四节点网格对应的全局刚度矩阵。然后通过消除边界自由度来施加本质边界条件 $u(0)=0$ 和 $u(1)=0$，从而生成与内部节点 $x_1$ 和 $x_2$ 相关联的简化后的 $2\\times 2$ 全局矩阵。\n\n5. 使用与伽辽金方法相关的离散能量恒等式，论证为何在给定的边界条件和 $k(x)>0$ 的情况下，简化后的全局矩阵是对称正定的。\n\n6. 最后，对于内部向量 $\\widehat{\\boldsymbol{u}} = \\begin{pmatrix}1  1\\end{pmatrix}^{\\mathsf T}$，计算离散能量 $E_h = \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$，其中 $\\mathbf{K}$ 是第4步得到的简化全局矩阵。只报告 $E_h$ 的标量值作为最终答案。无需四舍五入；以纯数字（无量纲）形式提供精确值。", "solution": "所述问题具有科学依据、是适定的、客观且自洽的。它描述了伽辽金有限元法在连续介质力学中一个一维边值问题上的标准应用。所有必要的数据，包括控制方程、域、边界条件、材料属性和网格离散化，都已无歧义、无矛盾地给出。因此，该问题是有效的，可以构建一个严谨的解。\n\n解决方案按顺序处理六个任务中的每一个。\n\n1. 弱形式的推导。\n控制方程的强形式为\n$$- \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) = f(x) \\quad \\text{for } x \\in (0,1)$$\n带有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。\n为推导弱形式，我们将强形式乘以一个容许权函数 $w(x)$ 并在域 $\\Omega = [0,1]$ 上积分。一个容许权函数必须足够光滑，并且必须满足所有本质（狄利克雷）边界条件的齐次形式。因此，我们要求 $w(0)=0$ 和 $w(1)=0$。\n\n加权积分表达式为：\n$$ - \\int_{0}^{1} w(x) \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) \\,dx = \\int_{0}^{1} w(x) f(x) \\,dx $$\n我们对左侧项应用分部积分。使用公式 $\\int_{a}^{b} v \\, du' \\, dx = [vu]_{a}^{b} - \\int_{a}^{b} v' u \\, dx$，我们识别出 $v=w(x)$ 和 $u' = \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right)$。这意味着 $u=k(x)\\frac{du}{dx}$ 和 $v'=\\frac{dw}{dx}$。左侧变为：\n$$ \\int_{0}^{1} \\frac{dw}{dx} k(x) \\frac{du}{dx} \\,dx - \\left[ w(x) k(x) \\frac{du}{dx} \\right]_{0}^{1} = \\int_{0}^{1} w(x) f(x) \\,dx $$\n边界项 $\\left[ w(x) k(x) \\frac{du}{dx} \\right]_{0}^{1} = w(1) k(1) \\frac{du}{dx}(1) - w(0) k(0) \\frac{du}{dx}(0)$ 为零，因为权函数选自一个满足 $w(0)=0$ 和 $w(1)=0$ 的函数空间。\n\n这就得到了最终的弱形式：找到一个满足本质边界条件的函数 $u(x)$，使得对于所有容许权函数 $w(x)$，以下方程成立：\n$$ \\int_{0}^{1} k(x) \\frac{du}{dx} \\frac{dw}{dx} \\,dx = \\int_{0}^{1} f(x) w(x) \\,dx $$\n双线性形式 $B(u,w)$ 是弱形式中对 $u$ 和 $w$ 都是线性的部分：\n$$ B(u,w) = \\int_{0}^{1} k(x) \\frac{du}{dx} \\frac{dw}{dx} \\,dx $$\n线性泛函 $L(w)$ 是对 $w$ 呈线性的部分：\n$$ L(w) = \\int_{0}^{1} f(x) w(x) \\,dx $$\n\n2. 单元级伽辽金表达式。\n对于一个跨越区间 $[x_i, x_{i+1}]$ 且长度为 $h_e = x_{i+1}-x_i$ 的通用单元 $e$，近似解 $u_h(x)$ 使用局部线性形函数 $N_1(x)$ 和 $N_2(x)$ 进行插值：\n$$ u_h(x)|_{e} = u_i^{(e)} N_1(x) + u_{i+1}^{(e)} N_2(x) $$\n形函数的定义为 $N_1(x) = \\frac{x_{i+1}-x}{h_e}$ 和 $N_2(x) = \\frac{x-x_i}{h_e}$。它们关于 $x$ 的导数在单元上是常数：\n$$ \\frac{dN_1}{dx} = -\\frac{1}{h_e}, \\quad \\frac{dN_2}{dx} = \\frac{1}{h_e} $$\n在伽辽金方法中，权函数 $w(x)$ 与试探函数选自同一组函数，即 $w(x) = N_a(x)$，其中 $a \\in \\{1,2\\}$。然后通过在单元域上对形函数对计算双线性形式来给出单元刚度矩阵项 $k^{(e)}_{ab}$：\n$$ k^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} k(x)\\,\\frac{dN_a}{dx}\\,\\frac{dN_b}{dx}\\,dx $$\n为 $a,b \\in \\{1,2\\}$ 显式写出这些积分：\n$$ k^{(e)}_{11} = \\int_{x_i}^{x_{i+1}} k(x) \\left( -\\frac{1}{h_e} \\right) \\left( -\\frac{1}{h_e} \\right) dx = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{12} = \\int_{x_i}^{x_{i+1}} k(x) \\left( -\\frac{1}{h_e} \\right) \\left( \\frac{1}{h_e} \\right) dx = -\\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{21} = \\int_{x_i}^{x_{i+1}} k(x) \\left( \\frac{1}{h_e} \\right) \\left( -\\frac{1}{h_e} \\right) dx = -\\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{22} = \\int_{x_i}^{x_{i+1}} k(x) \\left( \\frac{1}{h_e} \\right) \\left( \\frac{1}{h_e} \\right) dx = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n\n3. 单元刚度矩阵的求值与计算。\n材料传导系数为 $k(x) = 2(1+x)$。$k(x)$ 在一个通用单元上的积分为：\n$$ \\int_{x_i}^{x_{i+1}} 2(1+x) \\,dx = \\left[ 2x + x^2 \\right]_{x_i}^{x_{i+1}} = (2x_{i+1} + x_{i+1}^2) - (2x_i + x_i^2) = 2(x_{i+1}-x_i) + (x_{i+1}^2-x_i^2) = h_e(2 + x_i + x_{i+1}) $$\n单元矩阵的标量系数为 $C_e = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx = \\frac{h_e(2+x_i+x_{i+1})}{h_e^2} = \\frac{2+x_i+x_{i+1}}{h_e}$。\n\n网格节点为 $x_0 = 0$、$x_1 = \\frac{1}{4}$、$x_2 = \\frac{3}{4}$ 和 $x_3 = 1$。\n\n单元 1 ($e=1$): $[x_0, x_1] = [0, \\frac{1}{4}]$。\n$h_1 = x_1 - x_0 = \\frac{1}{4}$。\n$C_1 = \\frac{2+0+\\frac{1}{4}}{\\frac{1}{4}} = \\frac{9/4}{1/4} = 9$。\n$\\mathbf{K}^{(1)} = 9 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 9  -9 \\\\ -9  9 \\end{pmatrix}$。\n\n单元 2 ($e=2$): $[x_1, x_2] = [\\frac{1}{4}, \\frac{3}{4}]$。\n$h_2 = x_2 - x_1 = \\frac{3}{4} - \\frac{1}{4} = \\frac{1}{2}$。\n$C_2 = \\frac{2+\\frac{1}{4}+\\frac{3}{4}}{\\frac{1}{2}} = \\frac{2+1}{\\frac{1}{2}} = \\frac{3}{\\frac{1}{2}} = 6$。\n$\\mathbf{K}^{(2)} = 6 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 6  -6 \\\\ -6  6 \\end{pmatrix}$。\n\n单元 3 ($e=3$): $[x_2, x_3] = [\\frac{3}{4}, 1]$。\n$h_3 = x_3 - x_2 = 1 - \\frac{3}{4} = \\frac{1}{4}$。\n$C_3 = \\frac{2+\\frac{3}{4}+1}{\\frac{1}{4}} = \\frac{3+\\frac{3}{4}}{\\frac{1}{4}} = \\frac{15/4}{1/4} = 15$。\n$\\mathbf{K}^{(3)} = 15 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 15  -15 \\\\ -15  15 \\end{pmatrix}$。\n\n4. 全局刚度矩阵的组装与简化。\n$4 \\times 4$ 的全局刚度矩阵 $\\mathbf{K}_{global}$ 是通过在相应的全局自由度（节点 0, 1, 2, 3）上对每个单元矩阵的贡献求和来组装的。\n$K_{11} = K^{(1)}_{11} = 9$\n$K_{22} = K^{(1)}_{22} + K^{(2)}_{11} = 9 + 6 = 15$\n$K_{33} = K^{(2)}_{22} + K^{(3)}_{11} = 6 + 15 = 21$\n$K_{44} = K^{(3)}_{22} = 15$\n$K_{12} = K_{21} = K^{(1)}_{12} = -9$\n$K_{23} = K_{32} = K^{(2)}_{12} = -6$\n$K_{34} = K_{43} = K^{(3)}_{12} = -15$\n$$ \\mathbf{K}_{global} = \\begin{pmatrix}\n9  -9  0  0 \\\\\n-9  15  -6  0 \\\\\n0  -6  21  -15 \\\\\n0  0  -15  15\n\\end{pmatrix} $$\n本质边界条件是 $u(0)=u_0=0$ 和 $u(1)=u_3=0$。为了获得关于内部未知数 $u_1$ 和 $u_2$ 的简化系统，我们消除了对应于自由度 0 和 3 的行和列。这就得到了与内部节点 1 和 2 相关联的 $2 \\times 2$ 简化全局矩阵 $\\mathbf{K}$：\n$$ \\mathbf{K} = \\begin{pmatrix}\n15  -6 \\\\\n-6  21\n\\end{pmatrix} $$\n\n5. 对称正定（SPD）性质的论证。\n对于一个近似解 $u_h(x)$，系统的离散能量由 $\\frac{1}{2}B(u_h, u_h)$ 给出。对于自由自由度的位移向量 $\\widehat{\\boldsymbol{u}}$，这对应于二次型 $\\frac{1}{2}\\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$。\n\n对称性：双线性形式 $B(u,w) = \\int_{0}^{1} k \\frac{du}{dx}\\frac{dw}{dx} dx$ 是对称的，因为标量乘法是可交换的，即 $B(u,w)=B(w,u)$。刚度矩阵 $\\mathbf{K}$ 是此双线性形式的离散表示，其项为 $K_{ij} = B(N_j, N_i)$。因此，$K_{ij} = B(N_j, N_i) = B(N_i, N_j) = K_{ji}$，证明了 $\\mathbf{K}$ 是对称的。这一点由计算出的矩阵得到证实。\n\n正定性：我们必须证明对于任何非零向量 $\\widehat{\\boldsymbol{u}} \\neq \\mathbf{0}$，都有 $\\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}} > 0$。该二次型对应于积分：\n$$ \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}} = B(u_h, u_h) = \\int_{0}^{1} k(x) \\left( \\frac{du_h}{dx} \\right)^2 dx $$\n其中 $u_h(x)$ 是由向量 $\\widehat{\\boldsymbol{u}}$ 构建并满足 $u_h(0)=0$ 和 $u_h(1)=0$ 的分段线性函数。\n问题陈述 $k(x) = 2(1+x)$，对于所有 $x \\in [0,1]$ 都是严格为正的。项 $(\\frac{du_h}{dx})^2$ 总是非负的。因此，被积函数 $k(x)(\\frac{du_h}{dx})^2$ 在域上处处非负。积分可以为零当且仅当被积函数几乎处处为零。由于 $k(x)>0$，这要求对于所有 $x \\in (0,1)$，$\\frac{du_h}{dx} = 0$。这意味着 $u_h(x)$ 必须是一个常数函数。然而，任何对应于简化系统的函数 $u_h(x)$ 都必须满足边界条件 $u_h(0)=0$。一个在 $x=0$ 处为零的常数函数必须恒等于零，$u_h(x)=0$。这对应于一个所有项都为零的节点位移向量，即 $\\widehat{\\boldsymbol{u}}=\\mathbf{0}$。\n因此，对于任何非零向量 $\\widehat{\\boldsymbol{u}}$，对应的函数 $u_h(x)$ 不恒等于零，其导数 $\\frac{du_h}{dx}$ 也不恒等于零，并且该积分严格为正。这证明了简化矩阵 $\\mathbf{K}$ 是正定的。\n\n6. 离散能量的计算。\n我们被要求计算离散能量 $E_h = \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$，其中内部位移向量为 $\\widehat{\\boldsymbol{u}} = \\begin{pmatrix}1  1\\end{pmatrix}^{\\mathsf T}$，简化矩阵为 $\\mathbf{K} = \\begin{pmatrix} 15  -6 \\\\ -6  21 \\end{pmatrix}$。\n$$ E_h = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 15  -6 \\\\ -6  21 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n首先，我们计算乘积 $\\mathbf{K}\\widehat{\\boldsymbol{u}}$：\n$$ \\begin{pmatrix} 15  -6 \\\\ -6  21 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 15 \\cdot 1 - 6 \\cdot 1 \\\\ -6 \\cdot 1 + 21 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 15 \\end{pmatrix} $$\n然后，我们计算与 $\\widehat{\\boldsymbol{u}}^{\\mathsf T}$ 的点积：\n$$ E_h = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 9 \\\\ 15 \\end{pmatrix} = 1 \\cdot 9 + 1 \\cdot 15 = 24 $$\n离散能量是 $24$。", "answer": "$$\n\\boxed{24}\n$$", "id": "2698892"}, {"introduction": "加权残值法，特别是伽辽金法，其强大之处在于它能在给定的函数空间内找到“最佳”近似解。这项练习[@problem_id:2698887]将通过一个精巧的算例，向您揭示一个深刻的结论：如果所选的试探函数空间恰好包含了问题的精确解，伽辽金法便能准确无误地找到它。亲手验证这一过程，将帮助您更深入地理解该方法的收敛性和最优性，以及选择合适函数空间的策略意义。", "problem": "一根长度为 $L$、恒定横截面积为 $A$、杨氏模量为 $E$ 的直棱柱杆沿 $x$ 轴放置，其范围为 $x \\in [0,L]$。杆的左端固定，因此轴向位移满足本质边界条件 $u(0)=0$。右端 $x=L$ 处为无牵引力。杆身承受沿轴线方向的均布轴向体力，单位长度上的力为 $p$（在 $x$ 方向上为常数）。\n\n从由线动量平衡和小应变胡克定律导出的一维轴向平衡强形式出发，\n$$-\\,\\frac{d}{dx}\\!\\left(EA\\,\\frac{du}{dx}\\right) \\;=\\; p \\quad \\text{in } (0,L),$$\n结合本质边界条件 $u(0)=0$ 和自然边界条件 $EA\\,u'(L)=0$，使用加权余量法（MWR），特别是权函数等于试函数的布勃诺夫-伽辽金（Bubnov–Galerkin）法，在覆盖整个杆的单个二次单元上构建并求解离散方程。\n\n在单个单元上采用二次拉格朗日（Lagrange）试探空间，插值节点位于 $x=0$、$x=L/2$ 和 $x=L$。在 $x=0$ 处直接施加本质边界条件。使用与无约束自由度相关的二次拉格朗日形函数作为权函数。组装得到的代数系统并求解节点未知数，以获得近似位移场 $u_h(x)$。\n\n然后，通过对给定边界条件的强形式进行直接积分，求得精确解 $u_{\\text{exact}}(x)$，并将其与 $u_h(x)$ 进行比较。请提供近似位移场 $u_h(x)$ 关于 $p$、$E$、$A$、$L$ 和 $x$ 的完全简化的封闭形式表达式作为最终答案。不要进行任何数值代入；无需四舍五入。最终答案以无单位形式表示。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **系统**：一根长度为 $L$、恒定横截面积为 $A$、杨氏模量为 $E$ 的直棱柱杆。\n- **区域**：杆占据的空间域为 $x \\in [0,L]$。\n- **控制方程（强形式）**：$-\\frac{d}{dx}\\left(EA\\,\\frac{du}{dx}\\right) = p$ 在 $(0,L)$ 内，其中 $p$ 为常数。\n- **边界条件**：\n  - 本质边界条件 (EBC)：$u(0)=0$（固定端）。\n  - 自然边界条件 (NBC)：$EA\\,u'(L)=0$（无牵引力端）。\n- **方法**：加权余量法 (MWR)，具体为布勃诺夫-伽辽金法。\n- **离散化**：一个覆盖区域 $[0,L]$ 的单个二次单元。\n- **试探空间**：二次拉格朗日试探函数，插值节点位于 $x=0$、$x=L/2$ 和 $x=L$。\n- **边界条件施加**：直接施加本质边界条件 $u(0)=0$。\n- **权函数**：与无约束自由度对应的二次拉格朗日形函数。\n- **目标**：\n  1. 构建并求解离散代数系统，求得近似位移场 $u_h(x)$。\n  2. 求得精确解 $u_{\\text{exact}}(x)$。\n  3. 比较 $u_h(x)$ 和 $u_{\\text{exact}}(x)$。\n  4. 提供 $u_h(x)$ 的最终表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题植根于一维线弹性力学，这是固体力学的一个基石。控制微分方程是承受体力的轴向杆的标准平衡方程。\n- **适定性**：该问题是一个二阶边值问题，具有一个本质边界条件和一个自然边界条件，这构成了适定提法。伽辽金法是解决此类问题的标准而稳健的数值技术。\n- **目标**：问题以精确、无歧义的科学语言陈述。\n- **完整性与一致性**：所有必要数据，包括控制方程、边界条件、材料属性、载荷和具体的数值方法，均已提供。不存在内部矛盾。\n\n**步骤3：结论与行动**\n该问题科学上合理，提法适定，且已完全指定。因此，判定其为**有效**。现在开始求解过程。\n\n求解从建立控制方程的弱形式开始。我们将强形式乘以一个合适的权函数 $w(x)$，并在区域 $[0, L]$ 上积分：\n$$ \\int_0^L -w(x) \\frac{d}{dx}\\left(EA\\,\\frac{du}{dx}\\right) dx = \\int_0^L w(x) p \\,dx $$\n对左侧应用分部积分：\n$$ \\int_0^L \\frac{dw}{dx} EA \\frac{du}{dx} dx - \\left[ w(x) EA \\frac{du}{dx} \\right]_0^L = \\int_0^L w(x) p \\,dx $$\n边界项为 $\\left[ w EA u' \\right]_0^L = w(L) (EA u'(L)) - w(0) (EA u'(0))$。自然边界条件为 $EA u'(L)=0$。为满足本质边界条件 $u(0)=0$，权函数 $w(x)$ 必须从 $w(0)=0$ 的函数空间中选择。因此，边界项完全消失。因此弱形式为：求 $u(x)$，使得 $u(0)=0$ 且对于所有容许的权函数 $w(x)$，\n$$ \\int_0^L EA u'(x) w'(x) dx = \\int_0^L p w(x) dx $$\n对于布勃诺夫-伽辽金法，近似解 $u_h(x)$ 和权函数 $w(x)$ 来自同一有限维函数空间。我们使用一个节点位于 $x_1=0$、$x_2=L/2$ 和 $x_3=L$ 的单个二次单元。近似位移由下式给出\n$$ u_h(x) = \\sum_{j=1}^3 N_j(x) u_j $$\n其中 $u_j$ 是节点 $x_j$ 处的节点位移，$N_j(x)$ 是二次拉格朗日形函数。它们是：\n$$ N_1(x) = \\frac{(x-L/2)(x-L)}{(0-L/2)(0-L)} = \\frac{2(x-L/2)(x-L)}{L^2} = \\frac{(2x-L)(x-L)}{L^2} $$\n$$ N_2(x) = \\frac{(x-0)(x-L)}{(L/2-0)(L/2-L)} = \\frac{x(x-L)}{-L^2/4} = \\frac{4x(L-x)}{L^2} $$\n$$ N_3(x) = \\frac{(x-0)(x-L/2)}{(L-0)(L-L/2)} = \\frac{x(x-L/2)}{L^2/2} = \\frac{2x(x-L/2)}{L^2} = \\frac{x(2x-L)}{L^2} $$\n本质边界条件 $u(0)=0$ 意味着 $u_1=0$。位移的近似表达式简化为：\n$$ u_h(x) = N_2(x) u_2 + N_3(x) u_3 $$\n权函数是与无约束自由度相关的基函数，因此我们依次取 $w(x)$ 为 $N_2(x)$ 和 $N_3(x)$。这产生一个 $2 \\times 2$ 的线性代数方程组 $\\mathbf{K} \\mathbf{d} = \\mathbf{f}$，其中 $\\mathbf{d} = \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix}$。刚度矩阵 $\\mathbf{K}$ 和力向量 $\\mathbf{f}$ 的分量为：\n$$ K_{ij} = \\int_0^L EA N_i'(x) N_j'(x) dx \\quad \\text{和} \\quad f_i = \\int_0^L p N_i(x) dx \\quad \\text{对于 } i,j \\in \\{2,3\\} $$\n相关形函数的导数为：\n$$ N_2'(x) = \\frac{d}{dx}\\left(\\frac{4x}{L} - \\frac{4x^2}{L^2}\\right) = \\frac{4}{L} - \\frac{8x}{L^2} $$\n$$ N_3'(x) = \\frac{d}{dx}\\left(\\frac{2x^2}{L^2} - \\frac{x}{L}\\right) = \\frac{4x}{L^2} - \\frac{1}{L} $$\n现在我们计算矩阵和向量的分量。对于常数 $E$ 和 $A$：\n$$ K_{22} = EA \\int_0^L \\left(\\frac{4}{L} - \\frac{8x}{L^2}\\right)^2 dx = \\frac{16EA}{L^2} \\int_0^L \\left(1 - \\frac{2x}{L}\\right)^2 dx = \\frac{16EA}{L^2} \\left[\\frac{L}{3}\\right] = \\frac{16EA}{3L} $$\n$$ K_{33} = EA \\int_0^L \\left(\\frac{4x}{L^2} - \\frac{1}{L}\\right)^2 dx = \\frac{EA}{L^2} \\int_0^L \\left(\\frac{4x}{L} - 1\\right)^2 dx = \\frac{EA}{L^2} \\left[\\frac{7L}{3}\\right] = \\frac{7EA}{3L} $$\n$$ K_{23} = K_{32} = EA \\int_0^L \\left(\\frac{4}{L} - \\frac{8x}{L^2}\\right)\\left(\\frac{4x}{L^2} - \\frac{1}{L}\\right) dx = \\frac{EA}{L^3}\\int_0^L (4L-8x)(4x-L) dx = -\\frac{8EA}{3L} $$\n力向量的分量为：\n$$ f_2 = p \\int_0^L N_2(x) dx = p \\int_0^L \\frac{4x(L-x)}{L^2} dx = p \\frac{4}{L^2} \\left[\\frac{Lx^2}{2} - \\frac{x^3}{3}\\right]_0^L = \\frac{2pL}{3} $$\n$$ f_3 = p \\int_0^L N_3(x) dx = p \\int_0^L \\frac{x(2x-L)}{L^2} dx = p \\frac{1}{L^2} \\left[\\frac{2x^3}{3} - \\frac{Lx^2}{2}\\right]_0^L = \\frac{pL}{6} $$\n代数系统为：\n$$ \\frac{EA}{3L} \\begin{pmatrix} 16  -8 \\\\ -8  7 \\end{pmatrix} \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 2pL/3 \\\\ pL/6 \\end{pmatrix} $$\n求解节点位移：\n$$ \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\frac{3L}{EA} \\begin{pmatrix} 16  -8 \\\\ -8  7 \\end{pmatrix}^{-1} \\begin{pmatrix} 2pL/3 \\\\ pL/6 \\end{pmatrix} $$\n该矩阵的逆矩阵是 $\\frac{1}{16(7) - (-8)^2} \\begin{pmatrix} 7  8 \\\\ 8  16 \\end{pmatrix} = \\frac{1}{48} \\begin{pmatrix} 7  8 \\\\ 8  16 \\end{pmatrix}$。\n$$ \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\frac{3L}{EA} \\frac{1}{48} \\begin{pmatrix} 7  8 \\\\ 8  16 \\end{pmatrix} \\begin{pmatrix} 2pL/3 \\\\ pL/6 \\end{pmatrix} = \\frac{L}{16EA} \\begin{pmatrix} 7(2pL/3) + 8(pL/6) \\\\ 8(2pL/3) + 16(pL/6) \\end{pmatrix} $$\n$$ \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\frac{L}{16EA} \\begin{pmatrix} 14pL/3 + 4pL/3 \\\\ 16pL/3 + 8pL/3 \\end{pmatrix} = \\frac{L}{16EA} \\begin{pmatrix} 6pL \\\\ 8pL \\end{pmatrix} = \\frac{pL^2}{16EA} \\begin{pmatrix} 6 \\\\ 8 \\end{pmatrix} = \\frac{pL^2}{EA} \\begin{pmatrix} 3/8 \\\\ 1/2 \\end{pmatrix} $$\n因此，$u_2 = \\frac{3pL^2}{8EA}$ 且 $u_3 = \\frac{pL^2}{2EA}$。\n将这些值代回 $u_h(x)$ 的表达式中，构建近似位移场：\n$$ u_h(x) = \\left(\\frac{3pL^2}{8EA}\\right) N_2(x) + \\left(\\frac{pL^2}{2EA}\\right) N_3(x) $$\n$$ u_h(x) = \\frac{3pL^2}{8EA} \\frac{4x(L-x)}{L^2} + \\frac{pL^2}{2EA} \\frac{x(2x-L)}{L^2} $$\n$$ u_h(x) = \\frac{p}{EA} \\left[ \\frac{3}{2}x(L-x) + \\frac{1}{2}x(2x-L) \\right] $$\n$$ u_h(x) = \\frac{p}{2EA} \\left[ 3(Lx-x^2) + (2x^2-Lx) \\right] = \\frac{p}{2EA} [3Lx - 3x^2 + 2x^2 - Lx] $$\n$$ u_h(x) = \\frac{p}{2EA} (2Lx - x^2) = \\frac{px(2L-x)}{2EA} $$\n为了比较，通过直接对 $-EAu''=p$ 积分来求得精确解 $u_{\\text{exact}}(x)$。\n$$ u''(x) = -\\frac{p}{EA} $$\n$$ u'(x) = -\\frac{px}{EA} + C_1 $$\n$$ u(x) = -\\frac{px^2}{2EA} + C_1 x + C_2 $$\n应用边界条件：\n- $u(0)=0 \\implies C_2=0$。\n- $EAu'(L)=0 \\implies EA(-\\frac{pL}{EA} + C_1)=0 \\implies C_1 = \\frac{pL}{EA}$。\n精确解为：\n$$ u_{\\text{exact}}(x) = -\\frac{px^2}{2EA} + \\frac{pLx}{EA} = \\frac{p}{2EA}(2Lx - x^2) = \\frac{px(2L-x)}{2EA} $$\n近似解 $u_h(x)$ 与精确解 $u_{\\text{exact}}(x)$ 完全相同。这是因为精确解是一个二次多项式，它位于为近似所选择的试探函数空间之内。伽辽金法保证了在能量范数下的最佳逼近，当精确解在试探空间中可用时，该方法将精确地恢复它。\n最终答案是 $u_h(x)$ 的表达式。", "answer": "$$\n\\boxed{\\frac{p x (2L-x)}{2 E A}}\n$$", "id": "2698887"}, {"introduction": "加权残值法的应用远不止于线性问题，它在非线性固体力学中扮演着更为关键的角色。这项高级练习[@problem_id:2698927]将带您进入非线性领域，处理一个超弹性杆的几何非线性问题。您将学习如何基于虚功原理建立非线性系统的残值方程，并推导其一致线性化的切线刚度矩阵，这是应用牛顿-拉弗森法求解非线性有限元问题的两个核心要素。", "problem": "考虑一根细长的超弹性杆，其未变形长度为 $L$，恒定横截面积为 $A$，占据参考区间 $X \\in [0,L]$。该杆在 $X = 0$ 处固定，并在 $X = L$ 处承受集中轴向载荷 $P_{\\mathrm{ext}}$。假设材料为具有拉梅参数 $\\lambda$ 和 $\\mu$ 的 Saint Venant–Kirchhoff 材料，并采用全拉格朗日描述。设运动为 $\\varphi(X) = X + u(X)$，其中 $u(X)$ 是参考构型中的轴向位移场。格林-拉格朗日应变定义为 $E = \\frac{1}{2}\\left(F^{2} - 1\\right)$，其中变形梯度为 $F = \\frac{d\\varphi}{dX} = 1 + \\frac{du}{dX}$。第二皮奥拉-基尔霍夫应力由 $S = \\mathbb{C} : E$ 给出，其中 $\\mathbb{C}$ 是四阶弹性张量。对于一维 Saint Venant–Kirchhoff 材料，$S = (\\lambda + 2\\mu)\\,E$。第一皮奥拉-基尔霍夫应力为 $P = F\\,S$。\n\n使用加权余量法，并采用伽辽金选择，即权函数等于试探形函数，通过一个在 $X=L$ 处具有单个自由度 $a$ 的双节点线性有限元来近似位移：$u_{h}(X) = a\\,N_{2}(X)$，其中 $N_{2}(X) = X/L$，且 $u_{h}(0) = 0$。设权函数为 $w(X) = N_{2}(X)$。\n\n从参考构型中线性动量平衡的弱形式和上述定义出发，执行以下操作：\n\n1. 在全拉格朗日形式下应用加权余量法，推导与单个自由度 $a$ 相关的标量残差 $r(a)$，并清楚地标明内虚功和外虚功的贡献。\n2. 通过一致线性化，推导精确的雅可比矩阵（切线）$K(a) = \\frac{dr}{da}$。\n3. 使用 Newton–Kantorovich 理论，简要解释对于此问题，使用第2项中的精确切线与使用近似切线（例如，取在 $a=0$ 处计算的恒定小应变切线）相比，如何影响牛顿迭代的局部收敛速度。\n\n以 $A$、$L$、$\\lambda$、$\\mu$ 和 $a$ 的形式，给出 $K(a)$ 的精确闭式解析表达式。不要代入数值。最终答案中不要包含单位。", "solution": "所述问题具有科学依据，是适定的、客观的。提供了唯一解所需的所有信息。它代表了非线性有限元方法在超弹性问题中的一个标准应用。因此，我将着手解决该问题。\n\n该问题要求使用加权余量法（特别是伽辽金法）对具有单个自由度的超弹性杆进行分析。\n\n1. 标量残差 $r(a)$ 的推导\n\n控制方程是参考构型中的线性动量平衡。其弱形式，也称为虚功原理，表明对于任何运动学容许的虚位移，内虚功必须等于外虚功。对于一维物体，这表示为：\n$$ \\delta \\mathcal{W} = \\delta \\mathcal{W}_{\\text{int}} - \\delta \\mathcal{W}_{\\text{ext}} = 0 $$\n其中 $\\delta \\mathcal{W}_{\\text{int}}$ 是内虚功，$\\delta \\mathcal{W}_{\\text{ext}}$ 是外虚功。\n\n内虚功由第二皮奥拉-基尔霍夫应力 $S$ 与格林-拉格朗日应变变分 $\\delta E$ 在参考体积 $V_0$ 上的积分给出：\n$$ \\delta \\mathcal{W}_{\\text{int}} = \\int_{V_0} S : \\delta E \\, dV_0 = \\int_0^L S \\, \\delta E \\, A \\, dX $$\n外虚功由施加的载荷 $P_{\\text{ext}}$ 在其作用点上所做，对应于该点的虚位移：\n$$ \\delta \\mathcal{W}_{\\text{ext}} = P_{\\text{ext}} \\delta u(L) $$\n位移场由 $u_h(X) = a\\,N_2(X) = a \\frac{X}{L}$ 近似。单个自由度是 $a$，代表杆末端的位移 $u_h(L) = a$。\n虚位移是 $u_h$ 关于 $a$ 的变分：\n$$ \\delta u(X) = \\frac{\\partial u_h}{\\partial a} \\delta a = \\frac{X}{L} \\delta a $$\n伽辽金法的权函数选择为 $w(X) = \\frac{\\partial u_h}{\\partial a} = \\frac{X}{L}$。\n变形梯度 $F$ 为：\n$$ F = 1 + \\frac{du_h}{dX} = 1 + \\frac{a}{L} $$\n由于 $F$ 在整个杆上是恒定的，格林-拉格朗日应变 $E$ 也是恒定的：\n$$ E = \\frac{1}{2}(F^2 - 1) = \\frac{1}{2}\\left(\\left(1 + \\frac{a}{L}\\right)^2 - 1\\right) = \\frac{a}{L} + \\frac{a^2}{2L^2} $$\n应变的变分 $\\delta E$ 为：\n$$ \\delta E = \\frac{\\partial E}{\\partial a} \\delta a = \\left(\\frac{1}{L} + \\frac{a}{L^2}\\right)\\delta a = \\frac{1}{L}\\left(1 + \\frac{a}{L}\\right)\\delta a = \\frac{F}{L}\\delta a $$\n对于 Saint Venant–Kirchhoff 材料，第二皮奥拉-基尔霍夫应力 $S$ 为：\n$$ S = (\\lambda + 2\\mu)E = (\\lambda + 2\\mu)\\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) $$\n现在，我们构建内虚功的贡献：\n$$ \\delta \\mathcal{W}_{\\text{int}} = \\int_0^L S \\, \\delta E \\, A \\, dX = \\int_0^L (\\lambda + 2\\mu)\\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\left(\\frac{F}{L}\\delta a\\right) A \\, dX $$\n由于所有涉及 $a$ 的项相对于 $X$ 都是常数，我们可以将它们移到积分之外：\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\frac{F}{L} \\delta a \\int_0^L dX $$\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\left(1 + \\frac{a}{L}\\right) \\frac{1}{L} L \\delta a $$\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L}+\\frac{a^2}{2L^2}\\right)\\left(1+\\frac{a}{L}\\right) \\delta a $$\n展开表达式：\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{L^2} + \\frac{a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\delta a = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\delta a $$\n外虚功为：\n$$ \\delta \\mathcal{W}_{\\text{ext}} = P_{\\text{ext}} \\delta u(L) = P_{\\text{ext}} \\delta a $$\n通过设置 $\\delta \\mathcal{W} = 0$ 得到残差方程：\n$$ (\\delta \\mathcal{W}_{\\text{int}} - \\delta \\mathcal{W}_{\\text{ext}}) = \\left[ A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) - P_{\\text{ext}} \\right] \\delta a = 0 $$\n由于这对任意非零的 $\\delta a$ 都必须成立，因此标量残差 $r(a)$ 是方括号中的项。\n内力向量（在此情况下为标量）是 $F_{\\text{int}}(a) = A (\\lambda + 2\\mu) (\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3})$，外力向量是 $F_{\\text{ext}} = P_{\\text{ext}}$。\n因此，残差为 $r(a) = F_{\\text{int}}(a) - F_{\\text{ext}}$：\n$$ r(a) = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) - P_{\\text{ext}} $$\n\n2. 精确雅可比矩阵（切线）$K(a)$ 的推导\n\n精确的雅可比矩阵，或称切线刚度，是通过对残差 $r(a)$ 关于自由度 $a$ 求导得到的。这个过程称为一致线性化。\n$$ K(a) = \\frac{dr(a)}{da} $$\n对 $r(a)$ 的表达式关于 $a$ 求导，并注意到 $P_{\\text{ext}}$ 是一个恒定载荷：\n$$ K(a) = \\frac{d}{da} \\left[ A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\right] $$\n$$ K(a) = A (\\lambda + 2\\mu) \\left(\\frac{1}{L} + \\frac{3(2a)}{2L^2} + \\frac{3a^2}{2L^3}\\right) $$\n$$ K(a) = A (\\lambda + 2\\mu) \\left(\\frac{1}{L} + \\frac{3a}{L^2} + \\frac{3a^2}{2L^3}\\right) $$\n该表达式代表了杆的单单元近似的精确切线刚度。它由初始线性刚度 $A(\\lambda+2\\mu)/L$ 和依赖于位移 $a$ 的非线性项组成，这些非线性项考虑了几何非线性。\n\n3. 收敛速度解释\n\n非线性方程 $r(a) = 0$ 的解是通过迭代格式找到的。此问题的标准 Newton-Raphson 方法是：\n$$ a_{k+1} = a_k - [K(a_k)]^{-1} r(a_k) $$\n其中 $k$ 是迭代指数，$K(a_k)$ 是在当前估计值 $a_k$ 处计算的精确切线刚度。\n\n根据 Newton–Kantorovich 理论，如果初始猜测 $a_0$ 足够接近真实解 $a^*$，并且解处的雅可比矩阵 $K(a^*)$ 是非奇异的，那么 Newton-Raphson 方法将**二次收敛**。二次收敛意味着误差 $\\epsilon_k = |a_k - a^*|$ 根据关系式 $\\epsilon_{k+1} \\leq C \\epsilon_k^2$ 减小，其中 $C>0$ 是某个常数。这意味着解的正确位数在每次迭代中大约会翻倍，这是一个非常快的收敛速度。\n\n如果使用近似切线代替精确切线 $K(a_k)$，收敛行为会发生变化。问题建议使用在 $a=0$ 处计算的恒定切线，即线弹性（小应变）刚度：\n$$ K_0 = K(a=0) = A (\\lambda + 2\\mu) \\frac{1}{L} $$\n迭代格式变成了修正牛顿法（或常刚度法）：\n$$ a_{k+1} = a_k - [K_0]^{-1} r(a_k) $$\n该方法的收敛速度由其迭代映射 $g(a) = a - [K_0]^{-1}r(a)$ 在解 $a^*$ 处的导数决定。导数为 $g'(a) = 1 - [K_0]^{-1}K(a)$。在解处，$g'(a^*) = 1 - [K_0]^{-1}K(a^*)$。除非问题是线性的或者解恰好是 $a^*=0$，否则 $K(a^*) \\neq K_0$，因此 $g'(a^*) \\neq 0$。如果 $|g'(a^*)| < 1$，该方法收敛，但收敛速度仅为**线性**的。线性收敛意味着误差在每一步都减少一个大致恒定的因子：$\\epsilon_{k+1} \\leq c \\epsilon_k$，其中收敛因子为 $c = |g'(a^*)|$。\n\n总之，使用精确切线 $K(a)$ 会产生二次收敛，这明显快于使用像 $K_0$ 这样的近似恒定切线所获得的线性收敛。修正牛顿法的计算优势在于切线刚度只需计算和分解一次，这对于大型系统可能是有利的，但其代价是收敛速度要慢得多。", "answer": "$$\\boxed{A(\\lambda+2\\mu) \\left(\\frac{1}{L} + \\frac{3a}{L^2} + \\frac{3a^2}{2L^3}\\right)}$$", "id": "2698927"}]}