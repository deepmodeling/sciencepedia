{"hands_on_practices": [{"introduction": "在有限元方法中，形函数是插值单元内物理场（如位移）的基础。这项练习将带你从最基本的节点插值定义出发，为一个一维二次单元推导其拉格朗日形函数。通过亲自完成这个过程，你将深刻理解形函数必须满足的核心性质，例如单位分解性和多项式再生性，这些性质是保证有限元解收敛性和准确性的理论基石。[@problem_id:2635745]", "problem": "在有限元法（FEM）中，使用一维杆单元来近似轴向位移场。考虑父（等参）坐标 $\\xi \\in [-1,1]$，其上设有三个节点，分别位于 $\\xi_1=-1$、$\\xi_2=0$ 和 $\\xi_3=1$。设近似位移由三个二次 Lagrange 形函数 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 插值得到，每个函数都是至多二次的多项式，且满足 Kronecker-delta 插值条件 $N_i(\\xi_j)=\\delta_{ij}$（对于 $i,j\\in\\{1,2,3\\}$）。\n\n从节点插值和多项式完备性的核心定义出发，通过施加节点条件和二次多项式要求，推导 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 的显式表达式。然后，验证此种插值应具备的两个基本性质：\n- 最高二次的多项式再生能力：对于任意二次多项式位移场 $u(\\xi)=a_0+a_1\\,\\xi+a_2\\,\\xi^2$，证明其插值函数 $u^h(\\xi)=\\sum_{i=1}^3 N_i(\\xi)\\,u(\\xi_i)$ 对于所有 $\\xi\\in[-1,1]$ 恒等于 $u(\\xi)$。\n- 单位分解性：证明对于所有 $\\xi\\in[-1,1]$，均有 $\\sum_{i=1}^3 N_i(\\xi)=1$。\n\n将您的最终答案以单个行向量 $\\left[N_1(\\xi)\\;N_2(\\xi)\\;N_3(\\xi)\\right]$ 的形式给出，其中包含关于 $\\xi$ 的闭式解析表达式。无需进行数值取整。最终答案中不包含单位。", "solution": "所给问题是有限元法理论中的一个标准练习。它具有科学依据、是适定的、客观且完整的，不包含任何矛盾或谬误。因此，我将着手解答此问题。\n\n任务是推导一维三节点父单元的二次 Lagrange 形函数，并验证它们的两个基本性质。该单元定义在等参坐标域 $\\xi \\in [-1, 1]$ 上，节点位于 $\\xi_1 = -1$、$\\xi_2 = 0$ 和 $\\xi_3 = 1$。\n\n形函数（对于 $i \\in \\{1, 2, 3\\}$ 记为 $N_i(\\xi)$）是至多二次的多项式。它们由在节点位置的 Kronecker-delta 性质定义：\n$$ N_i(\\xi_j) = \\delta_{ij} = \\begin{cases} 1  \\text{if } i=j \\\\ 0  \\text{if } i \\neq j \\end{cases} $$\n我们将通过假设一个一般二次形式 $N(\\xi) = a\\xi^2 + b\\xi + c$，并施加这些节点条件来求解系数 $a$、$b$ 和 $c$，从而推导每个函数。\n\n推导 $N_1(\\xi)$：\n$N_1(\\xi)$ 需满足的条件是 $N_1(\\xi_1) = 1$，$N_1(\\xi_2) = 0$ 和 $N_1(\\xi_3) = 0$。\n设 $N_1(\\xi) = a_1\\xi^2 + b_1\\xi + c_1$。\n1.  在节点 $\\xi_2=0$ 处：$N_1(0) = a_1(0)^2 + b_1(0) + c_1 = c_1 = 0$。\n2.  在节点 $\\xi_3=1$ 处：$N_1(1) = a_1(1)^2 + b_1(1) + c_1 = a_1 + b_1 + 0 = 0$。这意味着 $b_1 = -a_1$。\n3.  在节点 $\\xi_1=-1$ 处：$N_1(-1) = a_1(-1)^2 + b_1(-1) + c_1 = a_1 - b_1 + 0 = 1$。\n将 $b_1 = -a_1$ 代入第三个方程，得到 $a_1 - (-a_1) = 2a_1 = 1$，解得 $a_1 = \\frac{1}{2}$。因此，$b_1 = -\\frac{1}{2}$。\n因此，$N_1(\\xi)$ 的表达式为：\n$$ N_1(\\xi) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi = \\frac{1}{2}\\xi(\\xi-1) $$\n\n推导 $N_2(\\xi)$：\n$N_2(\\xi)$ 需满足的条件是 $N_2(\\xi_1) = 0$，$N_2(\\xi_2) = 1$ 和 $N_2(\\xi_3) = 0$。\n设 $N_2(\\xi) = a_2\\xi^2 + b_2\\xi + c_2$。\n1.  在节点 $\\xi_2=0$ 处：$N_2(0) = a_2(0)^2 + b_2(0) + c_2 = c_2 = 1$。\n2.  在节点 $\\xi_3=1$ 处：$N_2(1) = a_2(1)^2 + b_2(1) + c_2 = a_2 + b_2 + 1 = 0$。\n3.  在节点 $\\xi_1=-1$ 处：$N_2(-1) = a_2(-1)^2 + b_2(-1) + c_2 = a_2 - b_2 + 1 = 0$。\n我们得到一个关于 $a_2$ 和 $b_2$ 的二元一次方程组：\n$$ a_2 + b_2 = -1 $$\n$$ a_2 - b_2 = -1 $$\n将这两个方程相加，得到 $2a_2 = -2$，所以 $a_2 = -1$。将此结果代入第一个方程，得到 $-1 + b_2 = -1$，所以 $b_2 = 0$。\n因此，$N_2(\\xi)$ 的表达式为：\n$$ N_2(\\xi) = (-1)\\xi^2 + (0)\\xi + 1 = 1 - \\xi^2 $$\n\n推导 $N_3(\\xi)$：\n$N_3(\\xi)$ 需满足的条件是 $N_3(\\xi_1) = 0$，$N_3(\\xi_2) = 0$ 和 $N_3(\\xi_3) = 1$。\n设 $N_3(\\xi) = a_3\\xi^2 + b_3\\xi + c_3$。\n1.  在节点 $\\xi_2=0$ 处：$N_3(0) = a_3(0)^2 + b_3(0) + c_3 = c_3 = 0$。\n2.  在节点 $\\xi_1=-1$ 处：$N_3(-1) = a_3(-1)^2 + b_3(-1) + c_3 = a_3 - b_3 + 0 = 0$。这意味着 $b_3 = a_3$。\n3.  在节点 $\\xi_3=1$ 处：$N_3(1) = a_3(1)^2 + b_3(1) + c_3 = a_3 + b_3 + 0 = 1$。\n将 $b_3 = a_3$ 代入第三个方程，得到 $a_3 + a_3 = 2a_3 = 1$，解得 $a_3 = \\frac{1}{2}$。因此，$b_3 = \\frac{1}{2}$。\n因此，$N_3(\\xi)$ 的表达式为：\n$$ N_3(\\xi) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\frac{1}{2}\\xi(\\xi+1) $$\n\n现在，我们验证所要求的两个性质。\n\n验证单位分解性：\n我们必须证明对于所有 $\\xi \\in [-1, 1]$，都有 $\\sum_{i=1}^3 N_i(\\xi) = 1$。\n$$ \\sum_{i=1}^3 N_i(\\xi) = N_1(\\xi) + N_2(\\xi) + N_3(\\xi) $$\n$$ = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) $$\n合并 $\\xi$ 的同次幂项：\n$$ = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1 $$\n$$ = (0)\\xi^2 + (0)\\xi + 1 = 1 $$\n单位分解性对于所有 $\\xi$ 恒成立。\n\n验证多项式再生能力：\n我们必须证明对于任意二次多项式 $u(\\xi) = a_0 + a_1\\xi + a_2\\xi^2$，其插值函数 $u^h(\\xi) = \\sum_{i=1}^3 N_i(\\xi)u(\\xi_i)$ 与 $u(\\xi)$ 恒等。\n首先，计算 $u(\\xi)$ 在节点处的值：\n$u(\\xi_1) = u(-1) = a_0 - a_1 + a_2$\n$u(\\xi_2) = u(0) = a_0$\n$u(\\xi_3) = u(1) = a_0 + a_1 + a_2$\n现在，构建插值函数 $u^h(\\xi)$：\n$$ u^h(\\xi) = N_1(\\xi)(a_0 - a_1 + a_2) + N_2(\\xi)(a_0) + N_3(\\xi)(a_0 + a_1 + a_2) $$\n通过提取系数 $a_0$、$a_1$ 和 $a_2$ 来重新整理表达式：\n$$ u^h(\\xi) = a_0 [N_1(\\xi)+N_2(\\xi)+N_3(\\xi)] + a_1 [-N_1(\\xi)+N_3(\\xi)] + a_2 [N_1(\\xi)+N_3(\\xi)] $$\n我们来分析每个 $a_k$ 的系数：\n$a_0$ 的系数是 $\\sum_{i=1}^3 N_i(\\xi)$，我们已经证明其值为 $1$。\n$a_1$ 的系数是 $-N_1(\\xi)+N_3(\\xi)$：\n$$ -N_1(\\xi)+N_3(\\xi) = -\\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = -\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi + \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\xi $$\n$a_2$ 的系数是 $N_1(\\xi)+N_3(\\xi)$：\n$$ N_1(\\xi)+N_3(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = \\xi^2 $$\n将这些结果代回 $u^h(\\xi)$ 的表达式中：\n$$ u^h(\\xi) = a_0(1) + a_1(\\xi) + a_2(\\xi^2) = a_0 + a_1\\xi + a_2\\xi^2 $$\n这与 $u(\\xi)$ 恒等。再生任意二次多项式的能力得到了证实。这是基函数 $\\{N_i(\\xi)\\}$ 能够表示单项式 $\\{1, \\xi, \\xi^2\\}$ 的直接结果，而我们刚刚已经证明了这一点。\n\n推导和验证均已完成。最终答案是形函数的显式表达式集合。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}\\xi(\\xi-1)  1-\\xi^2  \\frac{1}{2}\\xi(\\xi+1) \\end{pmatrix} } $$", "id": "2635745"}, {"introduction": "掌握了形函数的定义后，下一步是将其应用于描述单元的变形。本练习的核心任务是推导应变-位移矩阵（即 $B$ 矩阵），它建立了节点位移与单元内任意点应变之间的代数关系。完成这项推导将帮助你理解形函数的导数如何将离散的节点自由度转化为连续的应变场，这是计算单元刚度矩阵和进行应力分析的关键环节。[@problem_id:2635683]", "problem": "考虑一个用于等参四节点双线性四边形 (Q4) 有限元的二维、小变形、平面应变设定。设单元内的位移场通过其节点值，使用标量形函数 $N_{i}(x,y)$，$i=1,2,3,4$，进行插值，表示为\n$u(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,u_{i}$ 和 $v(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,v_{i}$，\n其中 $u$ 和 $v$ 分别是 $x$ 和 $y$ 方向上的笛卡尔位移分量，而 $u_{i}$ 和 $v_{i}$ 是节点 $i$ 处的节点位移自由度。采用小应变运动学中的无穷小应变张量定义，并使用平面应变的工程应变向量\n$\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix}$，\n其中 $\\varepsilon_{xx} = \\partial u/\\partial x$，$\\varepsilon_{yy} = \\partial v/\\partial y$，且 $\\gamma_{xy} = \\partial u/\\partial y + \\partial v/\\partial x$。设单元节点位移向量排列为\n$\\mathbf{d} = \\begin{pmatrix} u_{1}  v_{1}  u_{2}  v_{2}  u_{3}  v_{3}  u_{4}  v_{4} \\end{pmatrix}^{\\mathsf{T}}$。\n仅从这些定义出发，推导应变-位移矩阵 $\\mathbf{B}$，使得 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\,\\mathbf{d}$ 成立，并将 $\\mathbf{B}$ 完全用空间导数 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$（$i=1,2,3,4$）表示。您的最终答案必须是 $\\mathbf{B}$ 的一个单一闭合形式解析表达式。不要计算任何数值。不要引入任何本构关系。仅提供最终的 $\\mathbf{B}$ 矩阵表达式；最终答案中不应出现任何中间步骤。最终答案不需要单位。", "solution": "推导从二维无穷小应变的基本运动学开始。在小变形理论中，无穷小应变张量 $\\boldsymbol{\\epsilon}$ 是位移向量场 $\\mathbf{u} = (u,v)^{\\mathsf{T}}$ 的对称梯度，具体为\n$$\n\\epsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\epsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right).\n$$\n工程剪应变定义为 $ \\gamma_{xy} = 2\\,\\epsilon_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。因此，平面问题的工程应变向量为\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix}\n= \\begin{pmatrix} \\dfrac{\\partial u}{\\partial x} \\\\ \\dfrac{\\partial v}{\\partial y} \\\\ \\dfrac{\\partial u}{\\partial y} + \\dfrac{\\partial v}{\\partial x} \\end{pmatrix}.\n$$\n\n接下来，我们使用在 Q4 单元上的位移场的有限元插值。使用标量形函数 $N_{i}(x,y)$ 和节点位移分量 $u_{i}$ 和 $v_{i}$（$i=1,2,3,4$），位移分量插值如下\n$$\nu(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,u_{i}, \\qquad\nv(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,v_{i}.\n$$\n求空间导数可得\n$$\n\\frac{\\partial u}{\\partial x} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial x}\\,u_{i}, \\qquad\n\\frac{\\partial v}{\\partial y} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial y}\\,v_{i},\n$$\n以及\n$$\n\\frac{\\partial u}{\\partial y} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial y}\\,u_{i}, \\qquad\n\\frac{\\partial v}{\\partial x} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial x}\\,v_{i}.\n$$\n将这些代入工程应变分量，我们得到\n$$\n\\varepsilon_{xx} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial x}\\,u_{i}, \\qquad\n\\varepsilon_{yy} = \\sum_{i=1}^{4} \\frac{\\partial N_{i}}{\\partial y}\\,v_{i}, \\qquad\n\\gamma_{xy} = \\sum_{i=1}^{4} \\left( \\frac{\\partial N_{i}}{\\partial y}\\,u_{i} + \\frac{\\partial N_{i}}{\\partial x}\\,v_{i} \\right).\n$$\n\n我们现在根据排列如下的节点位移向量来收集各项\n$$\n\\mathbf{d} = \\begin{pmatrix} u_{1}  v_{1}  u_{2}  v_{2}  u_{3}  v_{3}  u_{4}  v_{4} \\end{pmatrix}^{\\mathsf{T}}.\n$$\n映射关系 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\,\\mathbf{d}$ 确定了应变-位移矩阵 $\\mathbf{B}$。从以上表达式中，$(u_{i}, v_{i})$ 对各应变分量的贡献如下：\n- 对 $\\varepsilon_{xx}$：$u_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial x}$，$v_{i}$ 的系数是 $0$。\n- 对 $\\varepsilon_{yy}$：$u_{i}$ 的系数是 $0$，$v_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial y}$。\n- 对 $\\gamma_{xy}$：$u_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial y}$，$v_{i}$ 的系数是 $\\dfrac{\\partial N_{i}}{\\partial x}$。\n\n按照指定的自由度顺序，将这四个节点的系数汇集起来，得到 $3 \\times 8$ 矩阵\n$$\n\\mathbf{B} =\n\\begin{pmatrix}\n\\dfrac{\\partial N_{1}}{\\partial x}  0  \\dfrac{\\partial N_{2}}{\\partial x}  0  \\dfrac{\\partial N_{3}}{\\partial x}  0  \\dfrac{\\partial N_{4}}{\\partial x}  0 \\\\\n0  \\dfrac{\\partial N_{1}}{\\partial y}  0  \\dfrac{\\partial N_{2}}{\\partial y}  0  \\dfrac{\\partial N_{3}}{\\partial y}  0  \\dfrac{\\partial N_{4}}{\\partial y} \\\\\n\\dfrac{\\partial N_{1}}{\\partial y}  \\dfrac{\\partial N_{1}}{\\partial x}  \\dfrac{\\partial N_{2}}{\\partial y}  \\dfrac{\\partial N_{2}}{\\partial x}  \\dfrac{\\partial N_{3}}{\\partial y}  \\dfrac{\\partial N_{3}}{\\partial x}  \\dfrac{\\partial N_{4}}{\\partial y}  \\dfrac{\\partial N_{4}}{\\partial x}\n\\end{pmatrix}.\n$$\n这个 $\\mathbf{B}$ 矩阵完全用物理导数 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$ 来表示。在等参格式中，这些物理导数是通过映射的雅可比矩阵从母坐标导数中获得的；然而，这里不需要这些细节，因为所要求的结果已明确要求用 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$ 表示。相同的运动学矩阵 $\\mathbf{B}$ 既适用于平面应力问题也适用于平面应变问题；这两种情况之间的区别在于本构矩阵，而不在于 $\\mathbf{B}$。", "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{\\partial N_{1}}{\\partial x}  0  \\dfrac{\\partial N_{2}}{\\partial x}  0  \\dfrac{\\partial N_{3}}{\\partial x}  0  \\dfrac{\\partial N_{4}}{\\partial x}  0 \\\\\n0  \\dfrac{\\partial N_{1}}{\\partial y}  0  \\dfrac{\\partial N_{2}}{\\partial y}  0  \\dfrac{\\partial N_{3}}{\\partial y}  0  \\dfrac{\\partial N_{4}}{\\partial y} \\\\\n\\dfrac{\\partial N_{1}}{\\partial y}  \\dfrac{\\partial N_{1}}{\\partial x}  \\dfrac{\\partial N_{2}}{\\partial y}  \\dfrac{\\partial N_{2}}{\\partial x}  \\dfrac{\\partial N_{3}}{\\partial y}  \\dfrac{\\partial N_{3}}{\\partial x}  \\dfrac{\\partial N_{4}}{\\partial y}  \\dfrac{\\partial N_{4}}{\\partial x}\n\\end{pmatrix}}$$", "id": "2635683"}, {"introduction": "为了将形函数的理论应用于实际工程问题，我们必须将在规则的“父”单元上定义的形函数映射到物理空间中任意形状的单元上。这项练习将引导你完成一个关键的“等参映射”过程，并计算其中的核心——雅可比（Jacobian）矩阵 $\\boldsymbol{J}$。通过这个实践，你将学会如何处理坐标变换、计算物理梯度，并评估单元的几何质量，这些都是确保有限元分析结果准确性和可靠性的重要技能。[@problem_id:2635676]", "problem": "在一个小应变固体力学分析中，使用了一个二维线性三角形有限元，该分析在有限元法（FEM）的等参框架内进行。考虑父域中的参考三角形，其坐标为 $(\\xi,\\eta)$，顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。设此参考三角形上的线性 Lagrange 形函数为典型的重心多项式 $N_{1}(\\xi,\\eta)$、$N_{2}(\\xi,\\eta)$ 和 $N_{3}(\\xi,\\eta)$，它们在参考顶点处满足克罗内克-德尔塔（Kronecker-delta）性质。物理三角形的顶点坐标为\n$$\n\\boldsymbol{x}_{1}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix},\\quad\n\\boldsymbol{x}_{2}=\\begin{pmatrix}2.3 \\\\ 0.1\\end{pmatrix},\\quad\n\\boldsymbol{x}_{3}=\\begin{pmatrix}0.2 \\\\ 1.8\\end{pmatrix}.\n$$\n从第一性原理（形函数插值和链式法则）出发，完成以下任务：\n1) 推导该线性单元的等参映射 $\\boldsymbol{x}(\\xi,\\eta)$ 和常数雅可比矩阵 $\\boldsymbol{J}=\\partial\\boldsymbol{x}/\\partial(\\xi,\\eta)$。\n2) 在物理 $(x,y)$ 坐标系中，计算雅可比行列式 $\\det\\boldsymbol{J}$ 和物理形函数的梯度 $\\nabla N_{i}$，$i\\in\\{1,2,3\\}$。\n3) 仅使用欧几里得内积和边向量的范数，计算物理三角形的三个内角，并找出最大内角。为评估网格质量，根据此处定义的最大角条件（要求最大内角严格小于 $2\\pi/3$）来评价该单元。\n\n最终答案仅报告该单元最大内角的数值，以弧度为单位，并四舍五入到四位有效数字。最终角度以弧度表示。", "solution": "对问题陈述进行验证。\n**已知条件提取：**\n- 单元类型：$2$ 维线性三角形有限元。\n- 框架：等参，小应变固体力学。\n- 父域（参考三角形）顶点：$(\\xi, \\eta)$ 坐标为 $(0,0)$、$(1,0)$ 和 $(0,1)$。\n- 形函数：满足克罗内克-德尔塔性质的线性 Lagrange 多项式 $N_{1}(\\xi,\\eta)$、$N_{2}(\\xi,\\eta)$、$N_{3}(\\xi,\\eta)$。\n- 物理域顶点：$\\boldsymbol{x}_{1}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，$\\boldsymbol{x}_{2}=\\begin{pmatrix}2.3 \\\\ 0.1\\end{pmatrix}$，$\\boldsymbol{x}_{3}=\\begin{pmatrix}0.2 \\\\ 1.8\\end{pmatrix}$。\n- 任务：\n  1. 推导等参映射 $\\boldsymbol{x}(\\xi,\\eta)$ 和雅可比矩阵 $\\boldsymbol{J}$。\n  2. 计算行列式 $\\det\\boldsymbol{J}$ 和物理梯度 $\\nabla N_{i}$。\n  3. 根据边向量计算物理三角形的内角，并根据最大角小于 $2\\pi/3$ 的条件进行评估。\n- 最终答案要求：最大内角，以弧度为单位，四舍五入到四位有效数字。\n\n**验证结论：**\n该问题具有科学依据，提法恰当且客观。这是有限元法中的一个标准练习。所有必要数据均已提供且自洽。该问题有效。我们开始求解。\n\n按要求从第一性原理展开求解。\n\n对于顶点为 $(\\xi_1, \\eta_1) = (0,0)$、$(\\xi_2, \\eta_2) = (1,0)$ 和 $(\\xi_3, \\eta_3) = (0,1)$ 的指定参考三角形，其线性 Lagrange 形函数即为重心坐标：\n$$N_{1}(\\xi, \\eta) = 1 - \\xi - \\eta$$\n$$N_{2}(\\xi, \\eta) = \\xi$$\n$$N_{3}(\\xi, \\eta) = \\eta$$\n这些函数正确地满足了克罗内克-德尔塔性质，$N_{i}(\\xi_{j}, \\eta_{j}) = \\delta_{ij}$。\n\n**1) 等参映射与雅可比矩阵**\n\n等参映射利用形函数和节点物理坐标 $\\boldsymbol{x}_i=\\begin{pmatrix}x_i \\\\ y_i\\end{pmatrix}$ 来插值物理坐标 $(x,y)$：\n$$\\boldsymbol{x}(\\xi, \\eta) = \\sum_{i=1}^{3} N_{i}(\\xi, \\eta) \\boldsymbol{x}_{i}$$\n代入给定的形函数和节点坐标：\n$$\\boldsymbol{x}(\\xi, \\eta) = (1 - \\xi - \\eta) \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} + \\xi \\begin{pmatrix}2.3 \\\\ 0.1\\end{pmatrix} + \\eta \\begin{pmatrix}0.2 \\\\ 1.8\\end{pmatrix}$$\n这可以简化为线性坐标映射：\n$$x(\\xi, \\eta) = 2.3 \\xi + 0.2 \\eta$$\n$$y(\\xi, \\eta) = 0.1 \\xi + 1.8 \\eta$$\n\n此映射的雅可比矩阵 $\\boldsymbol{J}$ 定义为 $\\boldsymbol{J} = \\frac{\\partial\\boldsymbol{x}}{\\partial(\\xi,\\eta)}$。对于此线性映射，其分量是常数：\n$$\\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 2.3  0.2 \\\\ 0.1  1.8 \\end{pmatrix}$$\n\n**2) 雅可比行列式与形函数梯度**\n\n雅可比矩阵的行列式为：\n$$\\det\\boldsymbol{J} = (2.3)(1.8) - (0.2)(0.1) = 4.14 - 0.02 = 4.12$$\n物理三角形的面积为 $A = \\frac{1}{2}|\\det\\boldsymbol{J}| = \\frac{4.12}{2} = 2.06$。行列式为正表示单元映射保持了方向性。\n\n为了求得物理域中的形函数梯度 $\\nabla N_{i} = \\begin{pmatrix} \\partial N_{i}/\\partial x \\\\ \\partial N_{i}/\\partial y \\end{pmatrix}$，我们使用链式法则，其表述如下：\n$$\\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} \\implies \\nabla_{\\xi}N_{i} = \\boldsymbol{J}^{T} \\nabla N_{i}$$\n因此，物理梯度可通过 $\\nabla N_{i} = (\\boldsymbol{J}^{T})^{-1} \\nabla_{\\xi}N_{i}$ 求得。\n首先，我们求雅可比矩阵的逆矩阵：\n$$\\boldsymbol{J}^{-1} = \\frac{1}{\\det\\boldsymbol{J}} \\begin{pmatrix} 1.8  -0.2 \\\\ -0.1  2.3 \\end{pmatrix} = \\frac{1}{4.12} \\begin{pmatrix} 1.8  -0.2 \\\\ -0.1  2.3 \\end{pmatrix}$$\n然后我们求所需的矩阵 $(\\boldsymbol{J}^{T})^{-1} = (\\boldsymbol{J}^{-1})^{T}$：\n$$(\\boldsymbol{J}^{T})^{-1} = \\frac{1}{4.12} \\begin{pmatrix} 1.8  -0.1 \\\\ -0.2  2.3 \\end{pmatrix}$$\n父域中的梯度为：\n$$\\nabla_{\\xi}N_{1} = \\begin{pmatrix}-1 \\\\ -1\\end{pmatrix}, \\quad \\nabla_{\\xi}N_{2} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}, \\quad \\nabla_{\\xi}N_{3} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$$\n现在我们可以计算物理梯度：\n$$\\nabla N_{1} = \\frac{1}{4.12} \\begin{pmatrix} 1.8  -0.1 \\\\ -0.2  2.3 \\end{pmatrix} \\begin{pmatrix}-1 \\\\ -1\\end{pmatrix} = \\frac{1}{4.12} \\begin{pmatrix}-1.7 \\\\ -2.1\\end{pmatrix}$$\n$$\\nabla N_{2} = \\frac{1}{4.12} \\begin{pmatrix} 1.8  -0.1 \\\\ -0.2  2.3 \\end{pmatrix} \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} = \\frac{1}{4.12} \\begin{pmatrix}1.8 \\\\ -0.2\\end{pmatrix}$$\n$$\\nabla N_{3} = \\frac{1}{4.12} \\begin{pmatrix} 1.8  -0.1 \\\\ -0.2  2.3 \\end{pmatrix} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = \\frac{1}{4.12} \\begin{pmatrix}-0.1 \\\\ 2.3\\end{pmatrix}$$\n作为一致性检验，$\\nabla N_{1} + \\nabla N_{2} + \\nabla N_{3} = \\nabla(N_{1}+N_{2}+N_{3}) = \\nabla(1) = \\boldsymbol{0}$，我们计算出的梯度满足此条件。\n\n**3) 内角与网格质量**\n\n内角通过边向量的点积来计算。顶点为 $\\boldsymbol{x}_1 = (0,0)$、$\\boldsymbol{x}_2 = (2.3, 0.1)$ 和 $\\boldsymbol{x}_3 = (0.2, 1.8)$。\n\n设 $\\theta_1$ 为顶点 $\\boldsymbol{x}_1$ 处的角。相关的边向量为 $\\boldsymbol{v}_{12} = \\boldsymbol{x}_2 - \\boldsymbol{x}_1 = \\begin{pmatrix}2.3 \\\\ 0.1\\end{pmatrix}$ 和 $\\boldsymbol{v}_{13} = \\boldsymbol{x}_3 - \\boldsymbol{x}_1 = \\begin{pmatrix}0.2 \\\\ 1.8\\end{pmatrix}$。\n$$\\cos(\\theta_1) = \\frac{\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{13}}{\\|\\boldsymbol{v}_{12}\\| \\|\\boldsymbol{v}_{13}\\|}$$\n点积为 $\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{13} = (2.3)(0.2) + (0.1)(1.8) = 0.46 + 0.18 = 0.64$。\n范数的平方为 $\\|\\boldsymbol{v}_{12}\\|^2 = 2.3^2 + 0.1^2 = 5.30$ 和 $\\|\\boldsymbol{v}_{13}\\|^2 = 0.2^2 + 1.8^2 = 3.28$。\n$$\\cos(\\theta_1) = \\frac{0.64}{\\sqrt{5.30} \\sqrt{3.28}} = \\frac{0.64}{\\sqrt{17.384}}$$\n$$\\theta_1 = \\arccos\\left(\\frac{0.64}{\\sqrt{17.384}}\\right) \\approx 1.416828 \\text{ rad}$$\n\n设 $\\theta_2$ 为顶点 $\\boldsymbol{x}_2$ 处的角。边向量为 $\\boldsymbol{v}_{21} = \\boldsymbol{x}_1 - \\boldsymbol{x}_2 = \\begin{pmatrix}-2.3 \\\\ -0.1\\end{pmatrix}$ 和 $\\boldsymbol{v}_{23} = \\boldsymbol{x}_3 - \\boldsymbol{x}_2 = \\begin{pmatrix}0.2-2.3 \\\\ 1.8-0.1\\end{pmatrix} = \\begin{pmatrix}-2.1 \\\\ 1.7\\end{pmatrix}$。\n$$\\cos(\\theta_2) = \\frac{\\boldsymbol{v}_{21} \\cdot \\boldsymbol{v}_{23}}{\\|\\boldsymbol{v}_{21}\\| \\|\\boldsymbol{v}_{23}\\|}$$\n点积为 $\\boldsymbol{v}_{21} \\cdot \\boldsymbol{v}_{23} = (-2.3)(-2.1) + (-0.1)(1.7) = 4.83 - 0.17 = 4.66$。\n范数的平方为 $\\|\\boldsymbol{v}_{21}\\|^2 = 5.30$ 和 $\\|\\boldsymbol{v}_{23}\\|^2 = (-2.1)^2 + 1.7^2 = 4.41 + 2.89 = 7.30$。\n$$\\cos(\\theta_2) = \\frac{4.66}{\\sqrt{5.30} \\sqrt{7.30}} = \\frac{4.66}{\\sqrt{38.69}}$$\n$$\\theta_2 = \\arccos\\left(\\frac{4.66}{\\sqrt{38.69}}\\right) \\approx 0.723849 \\text{ rad}$$\n\n设 $\\theta_3$ 为顶点 $\\boldsymbol{x}_3$ 处的角。边向量为 $\\boldsymbol{v}_{31} = \\boldsymbol{x}_1 - \\boldsymbol{x}_3 = \\begin{pmatrix}-0.2 \\\\ -1.8\\end{pmatrix}$ 和 $\\boldsymbol{v}_{32} = \\boldsymbol{x}_2 - \\boldsymbol{x}_3 = \\begin{pmatrix}2.3-0.2 \\\\ 0.1-1.8\\end{pmatrix} = \\begin{pmatrix}2.1 \\\\ -1.7\\end{pmatrix}$。\n$$\\cos(\\theta_3) = \\frac{\\boldsymbol{v}_{31} \\cdot \\boldsymbol{v}_{32}}{\\|\\boldsymbol{v}_{31}\\| \\|\\boldsymbol{v}_{32}\\|}$$\n点积为 $\\boldsymbol{v}_{31} \\cdot \\boldsymbol{v}_{32} = (-0.2)(2.1) + (-1.8)(-1.7) = -0.42 + 3.06 = 2.64$。\n范数的平方为 $\\|\\boldsymbol{v}_{31}\\|^2 = 3.28$ 和 $\\|\\boldsymbol{v}_{32}\\|^2 = 7.30$。\n$$\\cos(\\theta_3) = \\frac{2.64}{\\sqrt{3.28} \\sqrt{7.30}} = \\frac{2.64}{\\sqrt{23.944}}$$\n$$\\theta_3 = \\arccos\\left(\\frac{2.64}{\\sqrt{23.944}}\\right) \\approx 1.000918 \\text{ rad}$$\n\n角度之和为 $\\theta_1 + \\theta_2 + \\theta_3 \\approx 1.416828 + 0.723849 + 1.000918 \\approx 3.141595$，约等于 $\\pi$，这证实了其几何一致性。\n这些角度约等于 $\\theta_1 \\approx 1.417$ rad，$\\theta_2 \\approx 0.724$ rad，以及 $\\theta_3 \\approx 1.001$ rad。\n\n最大内角为 $\\theta_{max} = \\theta_1 \\approx 1.416828$ 弧度。\n为评估网格质量，我们将其与最大角条件的限制值进行比较：$2\\pi/3 \\approx 2.094395$ 弧度。由于 $1.416828  2.094395$，该单元满足此条件。\n\n问题要求此最大角的数值，并四舍五入到四位有效数字。\n$\\theta_{max} \\approx 1.417$ 弧度。", "answer": "$$\n\\boxed{1.417}\n$$", "id": "2635676"}]}