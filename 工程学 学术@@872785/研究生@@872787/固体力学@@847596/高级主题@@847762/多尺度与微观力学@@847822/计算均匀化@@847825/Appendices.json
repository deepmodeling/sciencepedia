{"hands_on_practices": [{"introduction": "一阶计算均匀化的基石在于将宏观量定义为其微观对应量的体积平均。这个练习提供了一个直接而具体的计算，要求学生从代表性体积单元（RVE）内给定的分片常数微观应力场计算宏观应力。通过这个实践，学生可以巩固对均匀化基本假设物理意义的理解。[@problem_id:2623558]", "problem": "在一个平方有限元 (FE²) 计算均匀化框架中，使用了一个处于二维平面应力设置下的代表性体积单元 (RVE)。该 RVE 被划分为 $3$ 个不相交的子域 $\\Omega_{\\mu}^{(k)}$（$k=1,2,3$），每个子域都具有恒定的微观柯西应力 $\\boldsymbol{\\sigma}_{k}$ 和已知的体积 $V_k$。假设微观场满足无体力的静力平衡、适当的容许边界条件，并且强制执行 Hill–Mandel 宏观均匀性条件。\n\n子域的体积分别为 $V_1 = 2$ mm$^3$，$V_2 = 3$ mm$^3$ 和 $V_3 = 5$ mm$^3$。微观应力张量（单位：兆帕）为\n$$\n\\boldsymbol{\\sigma}_1=\\begin{pmatrix}120  30\\\\ 30  60\\end{pmatrix},\\quad\n\\boldsymbol{\\sigma}_2=\\begin{pmatrix}-40  20\\\\ 20  100\\end{pmatrix},\\quad\n\\boldsymbol{\\sigma}_3=\\begin{pmatrix}80  -10\\\\ -10  40\\end{pmatrix}.\n$$\n\n使用此类 RVE 的宏观柯西应力的一阶均匀化定义，计算宏观应力张量 $\\boldsymbol{\\Sigma}$。以 Voigt 序 $[\\Sigma_{11},\\,\\Sigma_{22},\\,\\Sigma_{12}]$ 报告您的最终答案（注意：不应用工程剪切因子），单位为兆帕。将各分量四舍五入至四位有效数字。以单行矩阵的形式提供您的最终答案。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n- 在二维平面应力设置中的一个代表性体积单元 (RVE)。\n- 框架为平方有限元 (FE²)。\n- RVE 被划分为 $3$ 个不相交的子域 $\\Omega_{\\mu}^{(k)}$，其中 $k=1,2,3$。\n- 每个子域具有恒定的微观柯西应力 $\\boldsymbol{\\sigma}_{k}$。\n- 每个子域具有已知的体积 $V_k$。\n- 微观场满足无体力的静力平衡和容许边界条件。\n- Hill–Mandel 宏观均匀性条件被强制执行。\n- 子域体积：$V_1 = 2$ mm$^3$，$V_2 = 3$ mm$^3$，以及 $V_3 = 5$ mm$^3$。\n- 微观应力张量，单位为兆帕 (MPa)：\n$$\n\\boldsymbol{\\sigma}_1=\\begin{pmatrix}120  30\\\\ 30  60\\end{pmatrix},\\quad\n\\boldsymbol{\\sigma}_2=\\begin{pmatrix}-40  20\\\\ 20  100\\end{pmatrix},\\quad\n\\boldsymbol{\\sigma}_3=\\begin{pmatrix}80  -10\\\\ -10  40\\end{pmatrix}.\n$$\n- 任务：计算宏观应力张量 $\\boldsymbol{\\Sigma}$。\n- 报告格式：Voigt 序 $[\\Sigma_{11},\\,\\Sigma_{22},\\,\\Sigma_{12}]$，四舍五入至四位有效数字，单位为 MPa。\n\n验证结论：\n该问题是连续介质力学中一个有效且适定的问题。它在科学上基于一阶计算均匀化理论。所有必要数据均已提供，不存在内部矛盾或歧义。微观应力张量是对称的，这符合柯西应力张量的要求。给定的条件，如静力平衡和 Hill-Mandel 条件，在 FE² 方法中是标准的，并确保了均匀化拟设的有效性。该问题是宏观应力基本定义的直接应用。\n\n解题过程如下。\n\n在一阶均匀化理论中，宏观柯西应力张量（表示为 $\\boldsymbol{\\Sigma}$）被定义为微观柯西应力张量 $\\boldsymbol{\\sigma}$ 在代表性体积单元 (RVE) 域 $\\Omega$ 上的体积平均值。RVE 的总体积为 $V$。该定义以积分形式表示为：\n$$\n\\boldsymbol{\\Sigma} = \\frac{1}{V} \\int_{\\Omega} \\boldsymbol{\\sigma}(\\mathbf{x}) \\, dV\n$$\n该定义是 Hill-Mandel 宏观均匀性条件的直接推论，该条件将宏观应力功率与微观应力功率的体积平均值等同起来。\n\n问题陈述 RVE 被划分为 3 个不相交的子域 $\\Omega_k$（其中 $k \\in \\{1, 2, 3\\}$），使得 $\\Omega = \\cup_{k=1}^{3} \\Omega_k$ 且当 $i \\neq j$ 时 $\\Omega_i \\cap \\Omega_j = \\emptyset$。总体积 $V$ 是各子域体积 $V_k$ 的和：\n$$\nV = V_1 + V_2 + V_3\n$$\n$\\boldsymbol{\\Sigma}$ 的积分可以分解为在这些子域上的积分之和：\n$$\n\\boldsymbol{\\Sigma} = \\frac{1}{V} \\left( \\int_{\\Omega_1} \\boldsymbol{\\sigma}(\\mathbf{x}) \\, dV + \\int_{\\Omega_2} \\boldsymbol{\\sigma}(\\mathbf{x}) \\, dV + \\int_{\\Omega_3} \\boldsymbol{\\sigma}(\\mathbf{x}) \\, dV \\right)\n$$\n提供了一个关键的简化条件：微观应力张量在每个子域内是恒定的，即对于 $\\mathbf{x} \\in \\Omega_k$，有 $\\boldsymbol{\\sigma}(\\mathbf{x}) = \\boldsymbol{\\sigma}_k$。因此，每个子域上的积分简化为常数应力张量与子域体积的乘积：\n$$\n\\int_{\\Omega_k} \\boldsymbol{\\sigma}_k \\, dV = \\boldsymbol{\\sigma}_k \\int_{\\Omega_k} \\, dV = \\boldsymbol{\\sigma}_k V_k\n$$\n将此结果代入 $\\boldsymbol{\\Sigma}$ 的表达式，得到微观应力张量的体积加权平均值：\n$$\n\\boldsymbol{\\Sigma} = \\frac{1}{V} \\sum_{k=1}^{3} \\boldsymbol{\\sigma}_k V_k = \\sum_{k=1}^{3} \\frac{V_k}{V} \\boldsymbol{\\sigma}_k\n$$\n令 $f_k = V_k / V$ 为第 $k$ 个子域的体积分数。则宏观应力为：\n$$\n\\boldsymbol{\\Sigma} = f_1 \\boldsymbol{\\sigma}_1 + f_2 \\boldsymbol{\\sigma}_2 + f_3 \\boldsymbol{\\sigma}_3\n$$\n现在我们代入给定的数值。首先，计算总体积 $V$：\n$$\nV = V_1 + V_2 + V_3 = 2 \\, \\text{mm}^3 + 3 \\, \\text{mm}^3 + 5 \\, \\text{mm}^3 = 10 \\, \\text{mm}^3\n$$\n接下来，我们计算体积分数：\n$$\nf_1 = \\frac{V_1}{V} = \\frac{2}{10} = 0.2\n$$\n$$\nf_2 = \\frac{V_2}{V} = \\frac{3}{10} = 0.3\n$$\n$$\nf_3 = \\frac{V_3}{V} = \\frac{5}{10} = 0.5\n$$\n体积分数之和为 $f_1+f_2+f_3 = 0.2+0.3+0.5 = 1$，符合预期。\n\n现在，我们计算宏观应力张量 $\\boldsymbol{\\Sigma}$ 的分量。\n分量 $\\Sigma_{11}$ 为：\n$$\n\\Sigma_{11} = f_1 \\sigma_{1,11} + f_2 \\sigma_{2,11} + f_3 \\sigma_{3,11} = (0.2)(120) + (0.3)(-40) + (0.5)(80)\n$$\n$$\n\\Sigma_{11} = 24 - 12 + 40 = 52 \\, \\text{MPa}\n$$\n分量 $\\Sigma_{22}$ 为：\n$$\n\\Sigma_{22} = f_1 \\sigma_{1,22} + f_2 \\sigma_{2,22} + f_3 \\sigma_{3,22} = (0.2)(60) + (0.3)(100) + (0.5)(40)\n$$\n$$\n\\Sigma_{22} = 12 + 30 + 20 = 62 \\, \\text{MPa}\n$$\n分量 $\\Sigma_{12}$ 为：\n$$\n\\Sigma_{12} = f_1 \\sigma_{1,12} + f_2 \\sigma_{2,12} + f_3 \\sigma_{3,12} = (0.2)(30) + (0.3)(20) + (0.5)(-10)\n$$\n$$\n\\Sigma_{12} = 6 + 6 - 5 = 7 \\, \\text{MPa}\n$$\n由于所有微观应力张量都是对称的，因此得到的宏观应力张量也是对称的，故 $\\Sigma_{21} = \\Sigma_{12} = 7 \\, \\text{MPa}$。完整的宏观应力张量为：\n$$\n\\boldsymbol{\\Sigma} = \\begin{pmatrix} 52  7 \\\\ 7  62 \\end{pmatrix} \\, \\text{MPa}\n$$\n题目要求答案以 Voigt 记法 $[\\Sigma_{11}, \\Sigma_{22}, \\Sigma_{12}]$ 给出，且分量需四舍五入至四位有效数字。\n计算出的分量为 $52$，$62$ 和 $7$。用四位有效数字表示，它们是：\n$$\n\\Sigma_{11} = 52.00\n$$\n$$\n\\Sigma_{22} = 62.00\n$$\n$$\n\\Sigma_{12} = 7.000\n$$\n因此，以所要求格式表示的最终答案是一个包含这些值的行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 52.00  62.00  7.000 \\end{pmatrix}}\n$$", "id": "2623558"}, {"introduction": "希尔-曼德尔条件确保了宏观尺度所做的功与微观尺度耗散的能量在能量上是共轭的，这是保证多尺度模型热力学一致性的关键。本思想实验通过展示违反此条件所带来的后果，揭示了其在 FE² 框架中的核心作用。通过推导能量不匹配项，学生可以更深刻地体会为何在 RVE 上施加恰当的边界条件是至关重要的。[@problem_id:2623560]", "problem": "考虑一个一维（$1$D）线性弹性代表性体积单元（RVE），其长度为 $L$，横截面积为常数 $A$，由杨氏模量为 $E$ 的均匀各向同性材料制成。假设小应变、无体力且处于准静态条件下。此RVE被用于一种称为平方有限元（$FE^{2}$）的双尺度有限元方法中，其中宏观尺度意图通过运动学一致的微观边界条件施加一个预设的宏观轴向应变历史 $\\bar{\\varepsilon}(t)$。\n\n由于微观边界控制器存在缺陷，RVE右端的微观位移边界条件被一个未在宏观尺度上体现的额外偏移量所污染：控制器施加的不是与 $\\bar{\\varepsilon}(t)$ 一致的纯仿射位移场，而是\n$$\nu(0,t)=0, \\qquad u(L,t)=\\bar{\\varepsilon}(t)\\,L+\\Delta(t),\n$$\n其中 $\\Delta(t)$ 是一个光滑、非零的时间函数，代表一个未包含在宏观运动学描述中的不相容微观边界位移。在这些边界条件下，RVE内部达到静力平衡。\n\n将瞬时微观内功率密度定义为 $p(x,t)=\\sigma(x,t)\\,\\dot{\\varepsilon}(x,t)$，其中 $\\varepsilon(x,t)$ 是小应变，$\\sigma(x,t)$ 是满足一维线性弹性关系的柯西应力。宏观应力通过均匀化定义为体积平均值 $\\overline{\\sigma}(t)=\\langle \\sigma(\\cdot,t)\\rangle$，而宏观求解器使用的宏观应变率仍为声明的 $\\dot{\\overline{\\varepsilon}}(t)=\\dot{\\bar{\\varepsilon}}(t)$，该值忽略了偏移量 $\\Delta(t)$。\n\n从“小应变运动学”、“无体力的线性动量平衡”和“线性弹性”出发，求解微观边值问题，并推导瞬时宏观功率失配\n$$\nD(t)\\equiv \\overline{\\sigma}(t)\\,\\dot{\\overline{\\varepsilon}}(t)-\\langle p(\\cdot,t)\\rangle\n$$\n的闭式解析表达式，该表达式需用 $E$、$L$、$\\bar{\\varepsilon}(t)$、$\\Delta(t)$ 及其时间导数表示。你的最终答案必须是关于 $D(t)$ 的单个解析表达式。不要引入任何数值。将你的最终结果表示为单个表达式；最终答案中不要包含单位。", "solution": "所述问题在科学上是合理的、自洽的，并且在线性弹性和计算均匀化的框架内是适定的。它基于可验证的原则提出了一个明确的目标。因此，我将着手解决该问题。\n\n目标是推导宏观功率失配 $D(t)$ 的表达式，其定义为：\n$$\nD(t) \\equiv \\overline{\\sigma}(t)\\,\\dot{\\overline{\\varepsilon}}(t)-\\langle p(\\cdot,t)\\rangle\n$$\n这需要求解一维微观边值问题以确定代表性体积单元（RVE）内部的场，然后计算宏观平均值。\n\n首先，我们求解微观尺度问题。\n对于无体力的准静态问题，线性动量平衡方程为：\n$$\n\\frac{\\partial \\sigma(x,t)}{\\partial x} = 0\n$$\n该方程意味着柯西应力 $\\sigma$ 在任一给定时间 $t$ 内在RVE中是空间均匀的。因此，我们可以写作 $\\sigma(x,t) = \\sigma(t)$。\n\n该材料遵循一维线性弹性关系（胡克定律）：\n$$\n\\sigma(t) = E \\, \\varepsilon(x,t)\n$$\n其中 $E$ 是杨氏模量，$\\varepsilon(x,t)$ 是轴向应变。由于 $E$ 是常数且 $\\sigma(t)$ 是空间均匀的，应变 $\\varepsilon(x,t)$ 也必须是空间均匀的。我们写作 $\\varepsilon(x,t) = \\varepsilon(t)$。\n\n小应变由位移场 $u(x,t)$ 的空间导数定义：\n$$\n\\varepsilon(t) = \\frac{\\partial u}{\\partial x}(x,t)\n$$\n对该关系式关于空间坐标 $x$ 进行积分，得到位移场：\n$$\nu(x,t) = \\int_{0}^{x} \\varepsilon(t) \\, d\\xi + C(t) = \\varepsilon(t)x + C(t)\n$$\n其中 $C(t)$ 是一个随时间变化的积分常数。\n\n未知函数 $\\varepsilon(t)$ 和 $C(t)$ 通过施加给定的微观边界条件来确定：\n$$\nu(0,t)=0, \\qquad u(L,t)=\\bar{\\varepsilon}(t)\\,L+\\Delta(t)\n$$\n在 $x=0$ 处施加第一个条件：\n$$\nu(0,t) = \\varepsilon(t)(0) + C(t) = 0 \\implies C(t) = 0\n$$\n因此，位移场简化为 $u(x,t) = \\varepsilon(t)x$。\n\n在 $x=L$ 处施加第二个条件：\n$$\nu(L,t) = \\varepsilon(t)L = \\bar{\\varepsilon}(t)L+\\Delta(t)\n$$\n由此，我们求解RVE内部实际的均匀应变 $\\varepsilon(t)$：\n$$\n\\varepsilon(t) = \\frac{\\bar{\\varepsilon}(t)L+\\Delta(t)}{L} = \\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\n$$\n相应的均匀应力场 $\\sigma(t)$ 为：\n$$\n\\sigma(t) = E\\varepsilon(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right)\n$$\n这些是在微观结构内部实际物理实现的场。\n\n接下来，我们计算功率失配 $D(t)$ 所需的各项。\n宏观应力 $\\overline{\\sigma}(t)$ 定义为微观应力的体积平均值：\n$$\n\\overline{\\sigma}(t) = \\langle \\sigma(\\cdot,t)\\rangle = \\frac{1}{L}\\int_{0}^{L} \\sigma(t) \\, dx = \\sigma(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right)\n$$\n根据问题陈述，宏观应变率 $\\dot{\\overline{\\varepsilon}}(t)$ 定义为预设宏观应变 $\\bar{\\varepsilon}(t)$ 的时间导数：\n$$\n\\dot{\\overline{\\varepsilon}}(t) = \\frac{d}{dt}\\bar{\\varepsilon}(t) = \\dot{\\bar{\\varepsilon}}(t)\n$$\n因此，$D(t)$ 表达式中的第一项是：\n$$\n\\overline{\\sigma}(t)\\,\\dot{\\overline{\\varepsilon}}(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\dot{\\bar{\\varepsilon}}(t)\n$$\n微观内功率密度为 $p(x,t) = \\sigma(x,t)\\,\\dot{\\varepsilon}(x,t)$。由于应力和应变都是均匀的，功率密度也是均匀的：$p(x,t) = p(t) = \\sigma(t)\\dot{\\varepsilon}(t)$。我们必须求出实际应变 $\\varepsilon(t)$ 的时间导数：\n$$\n\\dot{\\varepsilon}(t) = \\frac{d}{dt}\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) = \\dot{\\bar{\\varepsilon}}(t) + \\frac{\\dot{\\Delta}(t)}{L}\n$$\n于是，微观功率密度为：\n$$\np(t) = \\sigma(t)\\dot{\\varepsilon}(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\left(\\dot{\\bar{\\varepsilon}}(t) + \\frac{\\dot{\\Delta}(t)}{L}\\right)\n$$\n微观功率密度的体积平均值 $\\langle p(\\cdot,t)\\rangle$ 就是 $p(t)$ 本身，因为它是均匀的：\n$$\n\\langle p(\\cdot,t)\\rangle = p(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\left(\\dot{\\bar{\\varepsilon}}(t) + \\frac{\\dot{\\Delta}(t)}{L}\\right)\n$$\n最后，我们组装宏观功率失配 $D(t)$ 的表达式：\n$$\nD(t) = \\overline{\\sigma}(t)\\,\\dot{\\overline{\\varepsilon}}(t) - \\langle p(\\cdot,t)\\rangle\n$$\n$$\nD(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\dot{\\bar{\\varepsilon}}(t) - E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\left(\\dot{\\bar{\\varepsilon}}(t) + \\frac{\\dot{\\Delta}(t)}{L}\\right)\n$$\n我们可以提出公因式 $E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right)$：\n$$\nD(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\left[ \\dot{\\bar{\\varepsilon}}(t) - \\left(\\dot{\\bar{\\varepsilon}}(t) + \\frac{\\dot{\\Delta}(t)}{L}\\right) \\right]\n$$\n简化方括号内的表达式：\n$$\nD(t) = E\\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\left[ -\\frac{\\dot{\\Delta}(t)}{L} \\right]\n$$\n这就得出了功率失配的最终闭式表达式：\n$$\nD(t) = -\\frac{E}{L} \\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\dot{\\Delta}(t)\n$$\n这个结果表明，功率失配源于真实应力 $\\sigma(t) = E(\\bar{\\varepsilon}(t) + \\Delta(t)/L)$ 在未被计入的应变分量率 $\\dot{\\Delta}(t)/L$ 上所做的功。这是由有缺陷的边界控制器引入的运动学不相容性造成的直接后果。", "answer": "$$\n\\boxed{-\\frac{E}{L} \\left(\\bar{\\varepsilon}(t) + \\frac{\\Delta(t)}{L}\\right) \\dot{\\Delta}(t)}\n$$", "id": "2623560"}, {"introduction": "对于任何像 FE² 这样的数值方法，验证其实现能够准确再现已知的解析解是至关重要的一步。这个练习要求学生为均匀材料设计一个“补丁测试”（patch test），在此测试中，微观场应保持均匀。它促使学生系统地思考一个成功的测试所必需的要素：正确的 RVE 属性、恰当的边界条件以及一套完整的诊断检查，以确认代码的正确性。[@problem_id:2623524]", "problem": "考虑一种称为平方有限元(FE²)的小应变线性弹性双尺度计算均匀化方案。设微观域，称为代表性体积单元(RVE)，表示为$\\Omega_{\\mu} \\subset \\mathbb{R}^{d}$，其边界为$\\partial \\Omega_{\\mu}$，外单位法向量为$\\mathbf{n}$。微观本构关系是线性弹性的，具有一个恒定的四阶弹性张量$\\mathbb{C}$，体力$\\mathbf{b}=\\mathbf{0}$，且小应变运动学关系$\\boldsymbol{\\varepsilon}=\\operatorname{sym}\\nabla \\mathbf{u}$成立。宏观单元承受一个均匀、恒定的宏观应变张量$\\overline{\\boldsymbol{E}}$（在空间上是常数），该应变张量通过与Hill–Mandel宏观均匀性条件一致的合适边界条件传递给RVE。目标是设计一个斑贴检验（patch test），当施加这个均匀的宏观应变时，能够在RVE上精确地产生均匀的微观应力和零波动场，并指定一套完整的诊断性检查，必须满足这些检查才能断言FE²实现通过了斑贴检验。\n\n以下哪个选项给出了这样一个斑贴检验的正确而完整的设计，包括必需的微观边界条件和一套最小且充分的诊断集？\n\nA. 选择$\\Omega_{\\mu}$为任意具有均匀线性弹性材料的单连通域，即$\\mathbb{C}$在$\\Omega_{\\mu}$中是常数。施加运动学一致边界条件(KUBC)：在$\\partial \\Omega_{\\mu}$上指定一个仿射位移$\\mathbf{u}(\\mathbf{x})=\\overline{\\boldsymbol{H}}\\,\\mathbf{x}$，其中$\\operatorname{sym}(\\overline{\\boldsymbol{H}})=\\overline{\\boldsymbol{E}}$。等效地，求解波动场$\\widetilde{\\mathbf{u}}=\\mathbf{u}-\\overline{\\boldsymbol{H}}\\,\\mathbf{x}$，在$\\partial \\Omega_{\\mu}$上有$\\widetilde{\\mathbf{u}}=\\mathbf{0}$。如果在严格的数值容差范围内满足以下条件，则宣布斑贴检验通过：\n- 波动场范数可忽略不计，例如，在无量纲单位下，$\\|\\widetilde{\\mathbf{u}}\\|_{H^{1}(\\Omega_{\\mu})} \\le \\varepsilon$，其中$\\varepsilon \\approx 10^{-12}$。\n- 微观应力是均匀的，并等于对宏观应变的本构响应，即$\\operatorname{Var}_{\\Omega_{\\mu}}[\\boldsymbol{\\sigma}]=0$且逐点满足$\\boldsymbol{\\sigma}(\\mathbf{x})=\\mathbb{C}:\\overline{\\boldsymbol{E}}$。\n- Hill–Mandel能量一致性达到机器精度，即$\\overline{\\boldsymbol{\\sigma}}:\\overline{\\boldsymbol{E}}=\\frac{1}{|\\Omega_{\\mu}|}\\int_{\\Omega_{\\mu}}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\,\\mathrm{d}\\Omega$，其中$\\overline{\\boldsymbol{\\sigma}}=\\frac{1}{|\\Omega_{\\mu}|}\\int_{\\Omega_{\\mu}}\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega$。\n- 从微观问题计算出的宏观一致性切线等于$\\mathbb{C}$，即在一个小的范数容差内，$\\mathbb{C}^{\\text{hom}}=\\mathbb{C}$。\n- 离散微观平衡残差范数在非线性求解器容差内消失，并且边界反力对应于由均匀应力引起的$\\boldsymbol{\\sigma}\\,\\mathbf{n}$。\n\nB. 选择$\\Omega_{\\mu}$为具有分段常数张量$\\mathbb{C}_{1}$和$\\mathbb{C}_{2}$的强非均匀两相复合材料。在平行六面体RVE上施加周期性边界条件(PBC)，强制周期性位移和反周期性牵引力。如果体积平均满足$\\langle \\boldsymbol{\\varepsilon} \\rangle=\\overline{\\boldsymbol{E}}$和$\\langle \\boldsymbol{\\sigma} \\rangle=\\overline{\\boldsymbol{\\sigma}}$，并且Hill–Mandel等式在平均意义上成立，则宣布斑贴检验通过，无论波动场是否为零以及微观应力是否非均匀。\n\nC. 选择$\\Omega_{\\mu}$为均匀介质。在整个$\\partial \\Omega_{\\mu}$上施加均匀牵引力边界条件$\\mathbf{t}=\\overline{\\boldsymbol{\\sigma}}\\,\\mathbf{n}$，其中$\\overline{\\boldsymbol{\\sigma}}=\\mathbb{C}:\\overline{\\boldsymbol{E}}$。如果反力之和为零，平均微观应变等于$\\overline{\\boldsymbol{E}}$，且从反力计算出的宏观应力等于$\\overline{\\boldsymbol{\\sigma}}$，则宣布斑贴检验通过。\n\nD. 选择$\\Omega_{\\mu}$为均匀的矩形域。施加具有仿射部分$\\overline{\\boldsymbol{H}}\\,\\mathbf{x}$和周期性位移波动的周期性边界条件(PBC)。如果Hill–Mandel条件成立且体积平均微观应变等于$\\overline{\\boldsymbol{E}}$，则宣布斑贴检验通过，而不检查波动场的消失、应力均匀性或一致性切线与$\\mathbb{C}$的相等性。\n\n选择正确的选项。", "solution": "问题陈述要求为小应变线性弹性背景下的双尺度计算均匀化(FE²)方案设计一个斑贴检验。这种检验的目标是验证数值实现能够正确地再现一个已知的、简单的解析解。需要再现的具体情况是均匀材料的情况，其中均匀的宏观应变应导致均匀的微观场。\n\n首先，我们必须验证问题陈述。\n\n**第1步：提取已知条件**\n- **方案：** 双尺度计算均匀化(FE²)。\n- **物理背景：** 小应变线性弹性。\n- **RVE：** $\\Omega_{\\mu} \\subset \\mathbb{R}^{d}$，边界为$\\partial \\Omega_{\\mu}$，外单位法向量为$\\mathbf{n}$。\n- **本构关系：** 线性弹性，具有一个恒定的四阶弹性张量$\\mathbb{C}$。\n- **体力：** $\\mathbf{b}=\\mathbf{0}$。\n- **运动学：** $\\boldsymbol{\\varepsilon}=\\operatorname{sym}\\nabla \\mathbf{u}$。\n- **宏观加载：** 一个均匀、恒定的宏观应变张量$\\overline{\\boldsymbol{E}}$。\n- **耦合：** 边界条件与Hill–Mandel宏观均匀性条件一致。\n- **目标：** 设计一个斑贴检验，施加$\\overline{\\boldsymbol{E}}$时产生：\n    1. 均匀的微观应力。\n    2. RVE上的零波动场。\n- **任务：** 指定测试设计和一套完整的诊断性检查，以判定测试是否通过。\n\n**第2步：使用提取的已知条件进行验证**\n问题陈述在科学上是合理的、适定的和客观的。它基于计算多尺度力学的既定理论。斑贴检验的概念是数值方法中，特别是有限元分析中，一个标准且必要的验证过程。问题要求设计这样一个检验，这是一个基于所提供的物理和数学框架的、定义明确的概念性任务。给定的条件是自洽的，并且足以制定一个有效的斑贴检验的要求。未发现任何缺陷。\n\n**结论：** 问题是**有效的**。\n\n我们现在进行解的推导和选项的评估。\n\n**基于原理的推导**\n在FE²的背景下，斑贴检验用于验证实现是否能精确恢复对应于均匀材料的平凡解。\n\n在没有体力的情况下，微观问题的控制方程是平衡方程：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0} \\quad \\text{in } \\Omega_{\\mu}\n$$\n本构和运动学关系为：\n$$\n\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}\n$$\n$$\n\\boldsymbol{\\varepsilon} = \\operatorname{sym}(\\nabla \\mathbf{u}) = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)\n$$\n由于材料是均匀的，弹性张量$\\mathbb{C}$在整个$\\Omega_{\\mu}$中是常数。我们假设一个均匀应变场$\\boldsymbol{\\varepsilon}(\\mathbf{x}) = \\overline{\\boldsymbol{E}}$，其中$\\overline{\\boldsymbol{E}}$是一个常数张量。这导致一个均匀应力场$\\boldsymbol{\\sigma}(\\mathbf{x}) = \\mathbb{C}:\\overline{\\boldsymbol{E}}$。一个常数应力张量的散度为零，即$\\nabla \\cdot (\\mathbb{C}:\\overline{\\boldsymbol{E}}) = \\mathbf{0}$，因此平衡方程在域内恒等地满足。\n\n产生均匀应变$\\overline{\\boldsymbol{E}}$的位移场$\\mathbf{u}(\\mathbf{x})$必须满足$\\operatorname{sym}(\\nabla \\mathbf{u}) = \\overline{\\boldsymbol{E}}$。$\\nabla\\mathbf{u}$的通解是$\\nabla\\mathbf{u} = \\overline{\\boldsymbol{E}} + \\overline{\\mathbf{W}}$，其中$\\overline{\\mathbf{W}}$是代表刚体旋转的任意常数反对称张量。对此积分得到一个仿射位移场：\n$$\n\\mathbf{u}(\\mathbf{x}) = (\\overline{\\boldsymbol{E}} + \\overline{\\mathbf{W}})\\mathbf{x} + \\mathbf{c} = \\overline{\\boldsymbol{H}}\\mathbf{x} + \\mathbf{c}\n$$\n其中$\\overline{\\boldsymbol{H}} = \\overline{\\boldsymbol{E}} + \\overline{\\mathbf{W}}$是一个常数张量，$\\mathbf{c}$是代表刚体平移的常数向量。\n\n波动场$\\widetilde{\\mathbf{u}}$通常通过分解$\\mathbf{u}(\\mathbf{x}) = \\overline{\\boldsymbol{E}}\\mathbf{x} + \\widetilde{\\mathbf{u}}(\\mathbf{x})$来定义。为了使问题产生零波动场，我们需要$\\widetilde{\\mathbf{u}}(\\mathbf{x}) = \\mathbf{0}$。这对应于一个位移场$\\mathbf{u}(\\mathbf{x}) = \\overline{\\boldsymbol{E}}\\mathbf{x}$（忽略必须由边界条件约束的刚体运动）。\n\n为确保$\\mathbf{u}(\\mathbf{x}) = \\overline{\\boldsymbol{E}}\\mathbf{x}$是微尺度边值问题(BVP)的唯一解，我们必须施加合适的边界条件。任何与Hill–Mandel条件一致的边界条件集（例如，运动学一致边界条件(KUBC)、周期性边界条件(PBC)或静态均匀边界条件(SUBC)），对于一个均匀的RVE，都应该产生这种均匀状态。\n\n一套完整的诊断性检查必须验证数值代码再现了此解析解的所有方面，并满足基本的一致性条件。这些检查应包括：\n1. 计算出的位移场必须对应于零波动，即$\\|\\widetilde{\\mathbf{u}}\\|$应接近机器精度。\n2. 计算出的应力场和应变场必须是均匀的，其值分别为$\\boldsymbol{\\sigma} = \\mathbb{C}:\\overline{\\boldsymbol{E}}$和$\\boldsymbol{\\varepsilon} = \\overline{\\boldsymbol{E}}$。\n3. 微观应力的体积平均值$\\overline{\\boldsymbol{\\sigma}} = \\frac{1}{|\\Omega_{\\mu}|}\\int_{\\Omega_{\\mu}}\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega$必须等于$\\mathbb{C}:\\overline{\\boldsymbol{E}}$。\n4. Hill–Mandel条件，$\\overline{\\boldsymbol{\\sigma}}:\\overline{\\boldsymbol{E}} = \\frac{1}{|\\Omega_{\\mu}|}\\int_{\\Omega_{\\mu}}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\,\\mathrm{d}\\Omega$，必须达到机器精度。\n5. 计算出的均匀化切线模量$\\mathbb{C}^{\\text{hom}} = \\partial \\overline{\\boldsymbol{\\sigma}} / \\partial \\overline{\\boldsymbol{E}}$必须等于微观切线模量$\\mathbb{C}$。\n6. 标准的有限元求解检查，如平衡残差消失和正确的边界反力，必须通过。\n\n现在我们基于这个框架评估给定的选项。\n\n**逐项分析选项**\n\n**A. 选择$\\Omega_{\\mu}$为任意具有均匀线性弹性材料的单连通域...**\n- **测试设置：** 正确地选择了均匀材料（$\\mathbb{C}$为常数）。KUBC，指定为在$\\partial \\Omega_{\\mu}$上的仿射位移$\\mathbf{u}(\\mathbf{x})=\\overline{\\boldsymbol{H}}\\,\\mathbf{x}$（其中$\\operatorname{sym}(\\overline{\\boldsymbol{H}})=\\overline{\\boldsymbol{E}}$），是一个有效的边界条件，它强制施加了所需的宏观应变，并且其精确解就是仿射场本身，从而导致零波动场$\\widetilde{\\mathbf{u}}=\\mathbf{0}$（假设$\\overline{\\mathbf{H}}=\\overline{\\boldsymbol{E}}$或波动场的定义适当）。\n- **诊断：** 检查列表是全面且正确的。\n    - 检查波动场范数$\\|\\widetilde{\\mathbf{u}}\\|_{H^{1}(\\Omega_{\\mu})}$可忽略不计，验证了正确的位移场被恢复。\n    - 检查应力的方差为零且其值为$\\mathbb{C}:\\overline{\\boldsymbol{E}}$，验证了应力场。\n    - 检查Hill–Mandel条件，验证了多尺度耦合的基本能量一致性。\n    - 检查$\\mathbb{C}^{\\text{hom}}=\\mathbb{C}$，验证了宏观切线的正确实现，这对宏观问题的收敛至关重要。\n    - 检查平衡残差和边界反力，确认了底层求解器工作正常。\n这套诊断既充分又最简，因为每项检查都测试了FE²算法的一个独特而关键的部分。\n**结论：正确。**\n\n**B. 选择$\\Omega_{\\mu}$为强非均匀两相复合材料...**\n- **测试设置：** 这个选项建议使用一个非均匀的RVE。在非均匀材料中，一个均匀的宏观应变$\\overline{\\boldsymbol{E}}$会引起非均匀的微观应力场和应变场，以及一个非零的波动场$\\widetilde{\\mathbf{u}}$。斑贴检验的目的恰恰是验证代码在*均匀*介质中再现已知的*均匀*解的能力。使用非均匀材料构成了一种不同类型的验证问题，而不是其基本意义上的斑贴检验。\n- **诊断：** 检查仅限于平均量和Hill-Mandel条件，明确忽略了场的非均匀性。这错过了斑贴检验的主要目的。\n**结论：不正确。**\n\n**C. 选择$\\Omega_{\\mu}$为均匀介质。施加均匀牵引力边界条件...**\n- **测试设置：** 正确地选择了均匀材料。均匀牵引力边界条件(SUBC)，$\\mathbf{t}=\\overline{\\boldsymbol{\\sigma}}\\,\\mathbf{n}$，其中$\\overline{\\boldsymbol{\\sigma}}=\\mathbb{C}:\\overline{\\boldsymbol{E}}$，是KUBC的一个有效替代方案。对于这个BVP，均匀应力状态$\\boldsymbol{\\sigma}=\\overline{\\boldsymbol{\\sigma}}$和均匀应变状态$\\boldsymbol{\\varepsilon}=\\overline{\\boldsymbol{E}}$构成一个有效的解。\n- **诊断：** 这套检查存在严重缺陷。它提到检查反力之和为零（这对于指定的牵引力来说定义不清），平均微观应变等于$\\overline{\\boldsymbol{E}}$（正确），以及从反力计算出的宏观应力等于$\\overline{\\boldsymbol{\\sigma}}$（循环论证）。最重要的是，它未能指定对所得应力场和应变场的*均匀性*、波动场（相对于仿射解）的消失，以及均匀化切线$\\mathbb{C}^{\\text{hom}} = \\mathbb{C}$的正确性的检查。一个不验证精确局部场恢复的斑贴检验是不充分的。\n**结论：不正确。**\n\n**D. 选择$\\Omega_{\\mu}$为均匀的矩形域。施加周期性边界条件(PBC)...**\n- **测试设置：** 正确地选择了均匀材料。周期性边界条件是斑贴检验的另一个有效选择。对于一个均匀的RVE，PBC也应该导致均匀的场和零波动场（在一个刚体运动的差异内）。\n- **诊断：** 这个选项存在明确且致命的缺陷，因为它声称测试通过“而不检查波动场的消失、应力均匀性或一致性切线与$\\mathbb{C}$的相等性”。省略这些检查完全违背了斑贴检验的初衷。仅验证平均量和Hill-Mandel条件不足以保证实现的正确性，因为场解中的局部误差或切线计算中的误差将无法被检测到。\n**结论：不正确。**\n\n**总结**\n选项A提供了FE²实现斑贴检验的唯一正确和完整的描述。它正确地指定了一个有效的设置（具有KUBC的均匀RVE）和一套最小且充分的诊断性检查，这些检查覆盖了数值实现的所有关键方面：解场、本构响应、跨尺度能量条件和宏观切线刚度。", "answer": "$$\\boxed{A}$$", "id": "2623524"}]}