{"hands_on_practices": [{"introduction": "理解涡量矢量的第一步是掌握其计算方法。本练习将引导您从基本定义出发，为一个给定的速度场计算涡量矢量 $\\boldsymbol{\\omega}$，并解释其物理意义。通过解决一个具体的反平面剪切问题 [@problem_id:2700506]，您不仅能熟练掌握从速度梯度 $\\mathbf{L}$ 到自旋张量 $\\mathbf{W}$ 再到涡量 $\\boldsymbol{\\omega}$ 的完整计算流程，还能建立起关于涡量方向和大小的几何直观认识。", "problem": "考虑一个均匀各向同性固体的小变形反平面剪切，其中，平面外位移为 $w(x,y,t)$，质点速度为 $\\mathbf{v}(x,y,t)=\\left(0,\\,0,\\,\\dot{w}(x,y,t)\\right)$。在某个固定但任意的时刻 $t$ 进行分析，并假设 $\\dot{w}$ 在 $x$ 和 $y$ 方向上足够光滑。仅使用连续介质力学中的运动学定义，即速度梯度 $\\mathbf{L}$（其分量为 $L_{ij}=\\partial v_{i}/\\partial x_{j}$）、自旋张量 $\\mathbf{W}=\\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}\\right)$ 以及定义为 $\\mathbf{W}$ 的轴矢量的两倍的涡量矢量 $\\boldsymbol{\\omega}$，推导该反平面剪切场的 $\\boldsymbol{\\omega}(x,y)$ 的显式表达式。\n\n然后，解释 $\\boldsymbol{\\omega}$ 相对于 $\\dot{w}$ 的平面内梯度的方向，并以 $\\dot{w}(x,y)$ 的空间导数形式，给出模长 $\\|\\boldsymbol{\\omega}\\|$ 和沿 $\\boldsymbol{\\omega}$ 方向的单位矢量 $\\mathbf{n}_{\\omega}$ 的闭合形式表达式。你可以假设在所关注的点上 $\\nabla\\dot{w}(x,y)\\neq \\mathbf{0}$，因此 $\\mathbf{n}_{\\omega}$ 是良定义的。\n\n以逆时间单位 $\\mathrm{s}^{-1}$ 表示涡量分量及其模长。对于最终报告的答案，不要包含单位。将你的最终结果表示为一个单行矢量，按顺序包含 $\\boldsymbol{\\omega}$ 的三个分量、标量 $\\|\\boldsymbol{\\omega}\\|$ 和 $\\mathbf{n}_{\\omega}$ 的三个分量。无需进行数值计算或四舍五入；用 $\\partial \\dot{w}/\\partial x$ 和 $\\partial \\dot{w}/\\partial y$ 的符号形式表示你的答案。", "solution": "问题陈述经评估有效。这是一个定义明确的连续介质力学运动学问题，基于标准定义，没有科学或逻辑上的缺陷。我们开始求解。\n\n反平面剪切的质点速度场由 $\\mathbf{v}(x,y,t)$ 给出。在固定时刻 $t$，我们将其写成对应于空间坐标 $(x_1, x_2, x_3) = (x, y, z)$ 的笛卡尔分量 $(v_1, v_2, v_3)$：\n$$ v_1(x_1, x_2) = 0 $$\n$$ v_2(x_1, x_2) = 0 $$\n$$ v_3(x_1, x_2) = \\dot{w}(x_1, x_2) $$\n注意，速度分量仅依赖于 $x_1$ 和 $x_2$。\n\n第一步是计算速度梯度张量 $\\mathbf{L}$，其分量定义为 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$。\n\n各分量计算如下：\n$\\mathbf{L}$ 的第一行：\n$L_{11} = \\frac{\\partial v_1}{\\partial x_1} = 0$, $L_{12} = \\frac{\\partial v_1}{\\partial x_2} = 0$, $L_{13} = \\frac{\\partial v_1}{\\partial x_3} = 0$.\n$\\mathbf{L}$ 的第二行：\n$L_{21} = \\frac{\\partial v_2}{\\partial x_1} = 0$, $L_{22} = \\frac{\\partial v_2}{\\partial x_2} = 0$, $L_{23} = \\frac{\\partial v_2}{\\partial x_3} = 0$.\n$\\mathbf{L}$ 的第三行：\n$L_{31} = \\frac{\\partial v_3}{\\partial x_1} = \\frac{\\partial \\dot{w}}{\\partial x_1}$, $L_{32} = \\frac{\\partial v_3}{\\partial x_2} = \\frac{\\partial \\dot{w}}{\\partial x_2}$, $L_{33} = \\frac{\\partial v_3}{\\partial x_3} = 0$ (因为 $\\dot{w}$ 不是 $x_3$ 的函数).\n\n因此，速度梯度张量为：\n$$ \\mathbf{L} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ \\frac{\\partial \\dot{w}}{\\partial x_1}  \\frac{\\partial \\dot{w}}{\\partial x_2}  0 \\end{pmatrix} $$\n\n接下来，我们计算自旋张量 $\\mathbf{W}$，它是 $\\mathbf{L}$ 的反对称部分：\n$$ \\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}}) $$\n$\\mathbf{L}$ 的转置为：\n$$ \\mathbf{L}^{\\mathsf{T}} = \\begin{pmatrix} 0  0  \\frac{\\partial \\dot{w}}{\\partial x_1} \\\\ 0  0  \\frac{\\partial \\dot{w}}{\\partial x_2} \\\\ 0  0  0 \\end{pmatrix} $$\n两者的差为：\n$$ \\mathbf{L} - \\mathbf{L}^{\\mathsf{T}} = \\begin{pmatrix} 0  0  -\\frac{\\partial \\dot{w}}{\\partial x_1} \\\\ 0  0  -\\frac{\\partial \\dot{w}}{\\partial x_2} \\\\ \\frac{\\partial \\dot{w}}{\\partial x_1}  \\frac{\\partial \\dot{w}}{\\partial x_2}  0 \\end{pmatrix} $$\n因此，自旋张量为：\n$$ \\mathbf{W} = \\frac{1}{2}\\begin{pmatrix} 0  0  -\\frac{\\partial \\dot{w}}{\\partial x_1} \\\\ 0  0  -\\frac{\\partial \\dot{w}}{\\partial x_2} \\\\ \\frac{\\partial \\dot{w}}{\\partial x_1}  \\frac{\\partial \\dot{w}}{\\partial x_2}  0 \\end{pmatrix} $$\n以分量形式表示：$W_{13} = -W_{31} = -\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_1}$，$W_{23} = -W_{32} = -\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_2}$，所有其他分量均为零。\n\n问题将涡量矢量 $\\boldsymbol{\\omega}$ 定义为 $\\mathbf{W}$ 的轴矢量的两倍。反对称张量 $\\mathbf{W}$ 的轴矢量的分量由 $w_{\\text{axial},i} = -\\frac{1}{2}\\epsilon_{ijk}W_{jk}$ 给出。这得到 $w_{\\text{axial},1} = W_{32}$，$w_{\\text{axial},2} = -W_{31}$，以及 $w_{\\text{axial},3} = W_{21}$。使用我们得到的 $\\mathbf{W}$ 的分量：\n$w_{\\text{axial},1} = W_{32} = \\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_2}$\n$w_{\\text{axial},2} = -W_{31} = -(\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_1}) = -\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_1}$\n$w_{\\text{axial},3} = W_{21} = 0$\n涡量矢量 $\\boldsymbol{\\omega}$ 是该轴矢量的 $2$ 倍：\n$$ \\boldsymbol{\\omega} = 2 \\mathbf{w}_{\\text{axial}} = \\left( \\frac{\\partial \\dot{w}}{\\partial x_2}, -\\frac{\\partial \\dot{w}}{\\partial x_1}, 0 \\right) $$\n该表达式等价于标准定义 $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$。为了清晰起见，切换回 $(x,y,z)$ 标记法，涡量矢量的显式表达式为：\n$$ \\boldsymbol{\\omega}(x,y) = \\left( \\frac{\\partial \\dot{w}}{\\partial y}, -\\frac{\\partial \\dot{w}}{\\partial x}, 0 \\right) $$\n这是第一个要求的结果。\n\n为了进行解释，我们考虑 $\\dot{w}$ 的平面内梯度，它是一个在 $xy$ 平面内的矢量场：\n$$ \\nabla_{\\text{2D}} \\dot{w} = \\left( \\frac{\\partial \\dot{w}}{\\partial x}, \\frac{\\partial \\dot{w}}{\\partial y} \\right) $$\n涡量矢量 $\\boldsymbol{\\omega}$ 也位于 $xy$ 平面内。我们通过计算它们的点积来检验这两个矢量之间的关系：\n$$ (\\nabla_{\\text{2D}} \\dot{w}) \\cdot \\boldsymbol{\\omega} = \\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)\\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right) + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)\\left(-\\frac{\\partial \\dot{w}}{\\partial x}\\right) = 0 $$\n点积为零意味着 $\\boldsymbol{\\omega}$ 与 $\\nabla_{\\text{2D}}\\dot{w}$ 正交。对于一个矢量 $(a,b)$，矢量 $(b, -a)$ 对应于顺时针旋转 $\\frac{\\pi}{2}$ 弧度（$90$ 度）。因此，涡量矢量 $\\boldsymbol{\\omega}$ 位于剪切平面内，并与平面外速度率 $\\dot{w}$ 的平面内梯度成直角，方向为顺时针。\n\n接下来，我们推导模长 $\\|\\boldsymbol{\\omega}\\|$：\n$$ \\|\\boldsymbol{\\omega}\\| = \\sqrt{\\omega_x^2 + \\omega_y^2 + \\omega_z^2} = \\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2 + \\left(-\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + 0^2} $$\n$$ \\|\\boldsymbol{\\omega}\\| = \\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2} $$\n这表明涡量的模长等于 $\\dot{w}$ 的平面内梯度的模长。\n\n最后，沿 $\\boldsymbol{\\omega}$ 方向的单位矢量 $\\mathbf{n}_{\\omega}$ 计算为 $\\mathbf{n}_{\\omega} = \\frac{\\boldsymbol{\\omega}}{\\|\\boldsymbol{\\omega}\\|}$。问题陈述中说明 $\\nabla\\dot{w} \\neq \\mathbf{0}$，这确保了 $\\|\\boldsymbol{\\omega}\\| \\neq 0$。\n$$ \\mathbf{n}_{\\omega} = \\frac{1}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} \\left( \\frac{\\partial \\dot{w}}{\\partial y}, -\\frac{\\partial \\dot{w}}{\\partial x}, 0 \\right) $$\n该单位矢量的三个分量是：\n$$ n_{\\omega,x} = \\frac{\\frac{\\partial \\dot{w}}{\\partial y}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} $$\n$$ n_{\\omega,y} = \\frac{-\\frac{\\partial \\dot{w}}{\\partial x}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} $$\n$$ n_{\\omega,z} = 0 $$\n\n综合这些结果，我们将最终答案组合成一个包含七个所求量的单行矢量。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\partial \\dot{w}}{\\partial y}  -\\frac{\\partial \\dot{w}}{\\partial x}  0  \\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}  \\frac{\\frac{\\partial \\dot{w}}{\\partial y}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}}  \\frac{-\\frac{\\partial \\dot{w}}{\\partial x}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}}  0 \\end{pmatrix} } $$", "id": "2700506"}, {"introduction": "为了深刻理解涡量所代表的“旋转”部分，一个有效的方法是研究其不存在的情形。本练习旨在通过构建一个无涡量但有变形的运动场，来阐明变形与旋转的本质区别。通过构造一个无旋流场 [@problem_id:2700488]，您将证实运动的运动学分解——即应变率代表的纯变形与涡量代表的刚体旋转——是各自独立的，这对于理解材料本构关系至关重要。", "problem": "在连续介质（固体）中，三维均匀变形率可以用一个不随时间变化且与空间坐标呈线性的速度场来建模。从适用于固体力学的第一性原理出发，具体利用空间梯度和旋度的分量定义，构建一个光滑速度场 $\\mathbf{v}(\\mathbf{x})$，使得其涡量矢量 $\\boldsymbol{\\omega}$ 处处为零，而变形率张量 $\\mathbf{D}$ 不为零。然后，通过将此运动学与刚体自旋的缺失联系起来，将其解释为无旋纯应变。\n\n按以下步骤进行：\n- 从基本定义开始：速度梯度 $\\mathbf{L}$ 是 $\\mathbf{v}$ 的空间梯度，变形率张量是其对称部分 $\\mathbf{D} = (\\mathbf{L} + \\mathbf{L}^{T})/2$，涡量矢量是其旋度 $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$。未经证明，请勿引用矢量微积分恒等式；使用分量形式的推导来验证您的主张。\n- 提出一类满足 $\\boldsymbol{\\omega}=\\mathbf{0}$ 且 $\\mathbf{D}\\neq\\mathbf{0}$ 的速度场，并直接从定义出发证明这些性质。\n- 提供一个具体示例，取标量势 $\\phi(\\mathbf{x}) = \\tfrac{1}{2}\\,\\mathbf{x}^{T}\\mathbf{A}\\mathbf{x}$，其中 $\\mathbf{A}$ 是一个常对称矩阵\n$$\n\\mathbf{A}=\\begin{pmatrix}\na  m  n\\\\\nm  b  p\\\\\nn  p  c\n\\end{pmatrix},\n$$\n其中 $a$、 $b$、 $c$、 $m$、 $n$ 和 $p$ 是实常数，且至少有一个不为零。\n\n对于此具体示例，计算变形率张量的第二不变量，其定义为\n$$\nJ_{2} = \\tfrac{1}{2}\\Big[(\\operatorname{tr}\\mathbf{D})^{2} - \\operatorname{tr}(\\mathbf{D}^{2})\\Big],\n$$\n将结果用 $a$、 $b$、 $c$、 $m$、 $n$ 和 $p$ 表示。将 $\\mathbf{A}$ 的元素视为具有时间的倒数单位，因此 $J_{2}$ 的单位为 $\\mathrm{s}^{-2}$。用 $\\mathrm{s}^{-2}$ 表示您的最终答案。在加框的最终答案中不要包含单位。您的最终答案必须是单一的闭式解析表达式。", "solution": "所述问题具有科学依据、适定且客观。它植根于连续介质力学的基本原理，没有矛盾或歧义。因此，可以构建一个严谨的解。\n\n我们从固体力学运动学的第一性原理开始。速度场表示为 $\\mathbf{v}(\\mathbf{x})$，其中 $\\mathbf{x}$ 是分量为 $(x_1, x_2, x_3)$ 的位置矢量。空间速度梯度张量 $\\mathbf{L}$ 由其分量 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$ 定义。该张量可以分解为其对称部分和反对称部分：\n$$\n\\mathbf{L} = \\mathbf{D} + \\mathbf{W}\n$$\n其中 $\\mathbf{D}$ 是变形率张量，$\\mathbf{W}$ 是自旋张量。它们的分量定义为：\n$$\nD_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} + \\frac{\\partial v_j}{\\partial x_i} \\right) = \\frac{1}{2} (L_{ij} + L_{ji})\n$$\n$$\nW_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} - \\frac{\\partial v_j}{\\partial x_i} \\right) = \\frac{1}{2} (L_{ij} - L_{ji})\n$$\n根据定义，$\\mathbf{D}$ 是对称的（$D_{ij} = D_{ji}$），而 $\\mathbf{W}$ 是反对称的（$W_{ij} = -W_{ji}$）。\n\n涡量矢量 $\\boldsymbol{\\omega}$ 定义为速度场的旋度：$\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$。使用 Levi-Civita 符号 $\\epsilon_{kij}$，其分量形式为：\n$$\n\\omega_k = \\epsilon_{kij} \\frac{\\partial v_j}{\\partial x_i}\n$$\n涡量矢量的分量与自旋张量的分量相关。例如，\n$$\n\\omega_3 = \\epsilon_{3ij} \\frac{\\partial v_j}{\\partial x_i} = \\epsilon_{312} \\frac{\\partial v_2}{\\partial x_1} + \\epsilon_{321} \\frac{\\partial v_1}{\\partial x_2} = \\frac{\\partial v_2}{\\partial x_1} - \\frac{\\partial v_1}{\\partial x_2} = -2 W_{12}\n$$\n一般来说，关系式为 $\\omega_k = -2 \\epsilon_{kij} W_{ij}$。由此可见，条件 $\\boldsymbol{\\omega} = \\mathbf{0}$ 等价于自旋张量的所有分量均为零的条件，即 $\\mathbf{W} = \\mathbf{0}$。\n\n如果一个运动的自旋张量为零（$\\mathbf{W}=\\mathbf{0}$），但其变形率张量不为零（$\\mathbf{D} \\neq \\mathbf{0}$），则该运动是无旋纯应变。条件 $\\mathbf{W} = \\mathbf{0}$ 意味着 $\\mathbf{L} - \\mathbf{L}^T = \\mathbf{0}$，这表示速度梯度张量 $\\mathbf{L}$ 必须是对称的：$L_{ij} = L_{ji}$。此条件为\n$$\n\\frac{\\partial v_i}{\\partial x_j} = \\frac{\\partial v_j}{\\partial x_i}\n$$\n这恰好是矢量场 $\\mathbf{v}$ 为保守场的条件，在单连通域上，这保证了存在一个标量势 $\\phi(\\mathbf{x})$ 使得 $\\mathbf{v} = \\nabla \\phi$。为验证这一点，我们假设存在这样一个势。速度的分量为 $v_i = \\frac{\\partial \\phi}{\\partial x_i}$。那么速度梯度的分量为：\n$$\nL_{ij} = \\frac{\\partial v_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( \\frac{\\partial \\phi}{\\partial x_i} \\right) = \\frac{\\partial^2 \\phi}{\\partial x_j \\partial x_i}\n$$\n对于一个足够光滑的势 $\\phi$，偏导数的顺序无关紧要（Clairaut 定理），因此 $L_{ij} = \\frac{\\partial^2 \\phi}{\\partial x_i \\partial x_j} = L_{ji}$。于是，$\\mathbf{L}$ 是对称的。这证实了从标量势 $\\mathbf{v} = \\nabla \\phi$ 导出的这类速度场是无旋的。对于这类运动，$\\mathbf{L}$ 是对称的，因此 $\\mathbf{W} = \\mathbf{0}$ 且 $\\mathbf{D} = \\mathbf{L}$。条件 $\\mathbf{D} \\neq \\mathbf{0}$ 仅仅要求势 $\\phi$ 的 Hessian 矩阵（由 $H_{ij} = \\frac{\\partial^2 \\phi}{\\partial x_i \\partial x_j}$ 给出）不是零矩阵。\n\n我们现在来看所提供的具体示例。标量势以二次型的形式给出：\n$$\n\\phi(\\mathbf{x}) = \\frac{1}{2} \\mathbf{x}^T \\mathbf{A} \\mathbf{x} = \\frac{1}{2} x_i A_{ij} x_j\n$$\n其中 $\\mathbf{A}$ 是一个常对称矩阵。我们计算速度场 $\\mathbf{v} = \\nabla \\phi$。其第 $k$ 个分量是：\n$$\nv_k = \\frac{\\partial \\phi}{\\partial x_k} = \\frac{1}{2} \\frac{\\partial}{\\partial x_k} (x_i A_{ij} x_j) = \\frac{1}{2} \\left[ (\\delta_{ik} A_{ij} x_j) + (x_i A_{ij} \\delta_{jk}) \\right] = \\frac{1}{2} (A_{kj} x_j + x_i A_{ik})\n$$\n由于 $\\mathbf{A}$ 是对称的，$A_{ik} = A_{ki}$。因此，$x_i A_{ik} = x_i A_{ki} = A_{ki} x_i$。将哑求和指标 $i$ 重命名为 $j$ 可得 $A_{kj} x_j$。因此：\n$$\nv_k = \\frac{1}{2} (A_{kj} x_j + A_{kj} x_j) = A_{kj} x_j\n$$\n以矩阵形式表示，即 $\\mathbf{v}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}$。这是一个所指定的线性速度场。速度梯度为 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j}(A_{ik}x_k) = A_{ik}\\delta_{jk} = A_{ij}$。所以，$\\mathbf{L} = \\mathbf{A}$。\n由于 $\\mathbf{A}$ 是对称的，所以 $\\mathbf{L}$ 也是对称的。这直接意味着自旋张量 $\\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^T) = \\frac{1}{2}(\\mathbf{A} - \\mathbf{A}^T) = \\mathbf{0}$，因此涡量 $\\boldsymbol{\\omega} = \\mathbf{0}$。\n变形率张量为 $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^T) = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^T) = \\mathbf{A}$。问题陈述 $\\mathbf{A}$ 中至少有一个常数不为零，所以 $\\mathbf{A} \\neq \\mathbf{0}$，这意味着 $\\mathbf{D} \\neq \\mathbf{0}$。因此，该速度场正确地模拟了无旋纯应变。\n\n最后的任务是计算 $\\mathbf{D}$ 的第二不变量，即 $J_2 = \\frac{1}{2}[(\\operatorname{tr}\\mathbf{D})^2 - \\operatorname{tr}(\\mathbf{D}^2)]$。当 $\\mathbf{D}=\\mathbf{A}$ 时，我们有：\n$$\nJ_2 = \\frac{1}{2}[(\\operatorname{tr}\\mathbf{A})^2 - \\operatorname{tr}(\\mathbf{A}^2)]\n$$\n矩阵 $\\mathbf{A}$ 由下式给出：\n$$\n\\mathbf{A}=\\begin{pmatrix}\na  m  n\\\\\nm  b  p\\\\\nn  p  c\n\\end{pmatrix}\n$$\n$\\mathbf{A}$ 的迹是其对角元素之和：\n$$\n\\operatorname{tr}\\mathbf{A} = a + b + c\n$$\n接下来，我们计算 $\\mathbf{A}^2$：\n$$\n\\mathbf{A}^2 = \\begin{pmatrix}\na  m  n\\\\\nm  b  p\\\\\nn  p  c\n\\end{pmatrix} \\begin{pmatrix}\na  m  n\\\\\nm  b  p\\\\\nn  p  c\n\\end{pmatrix} = \\begin{pmatrix}\na^2+m^2+n^2  am+mb+np  an+mp+nc \\\\\nma+bm+pn  m^2+b^2+p^2  mn+bp+pc \\\\\nna+pm+cn  nm+pb+cp  n^2+p^2+c^2\n\\end{pmatrix}\n$$\n$\\mathbf{A}^2$ 的迹是其对角元素之和：\n$$\n\\operatorname{tr}(\\mathbf{A}^2) = (a^2+m^2+n^2) + (m^2+b^2+p^2) + (n^2+p^2+c^2)\n$$\n$$\n\\operatorname{tr}(\\mathbf{A}^2) = a^2+b^2+c^2+2m^2+2n^2+2p^2\n$$\n现在，我们将这些迹代入 $J_2$ 的表达式中：\n$$\nJ_2 = \\frac{1}{2} \\left[ (a+b+c)^2 - (a^2+b^2+c^2+2m^2+2n^2+2p^2) \\right]\n$$\n展开平方项得到 $(a+b+c)^2 = a^2+b^2+c^2+2ab+2ac+2bc$。\n$$\nJ_2 = \\frac{1}{2} \\left[ (a^2+b^2+c^2+2ab+2ac+2bc) - (a^2+b^2+c^2+2m^2+2n^2+2p^2) \\right]\n$$\n通过消去项来简化表达式：\n$$\nJ_2 = \\frac{1}{2} \\left[ 2ab+2ac+2bc - 2m^2 - 2n^2 - 2p^2 \\right]\n$$\n$$\nJ_2 = ab+ac+bc - m^2 - n^2 - p^2\n$$\n$\\mathbf{A}$ 的元素单位为 $\\mathrm{s}^{-1}$，因此 $J_2$ 最终表达式中的每一项（例如，$ab$、$m^2$）的单位都是 $\\mathrm{s}^{-2}$，符合要求。", "answer": "$$\n\\boxed{ab+ac+bc - m^{2} - n^{2} - p^{2}}\n$$", "id": "2700488"}, {"introduction": "涡量的概念在现代计算固体力学中扮演着核心角色，特别是在确保本构模型客观性方面。这个动手实践将理论付诸实践，要求您设计一个数值更新算法来处理依赖于自旋的内部变量。通过在随动坐标系中应用本构定律并使用局部角速度矢量来执行旋转更新 [@problem_id:2700502]，您将掌握保证模拟结果物理真实性的关键技术——客观时间积分算法。", "problem": "您的任务是在有限变形固体力学中，设计并实现一个有原则的时间步进算法，用于更新一个自旋相关的内向量值变量，同时保持储存能的标架无关性（客观性）。目标是从第一性原理出发，推导出一个使用局部角速度矢量的稳健更新方案。您的最终程序必须为指定的测试套件计算结果，并以单一规定的格式打印它们。\n\n考虑一个空间速度场，其空间速度梯度为 $\\mathbf{L} = \\nabla \\mathbf{v}$。将自旋张量定义为反对称部分 $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$，其轴矢量为局部角速度矢量 $\\mathbf{w}$，它等于 $\\mathbf{w} = \\tfrac{1}{2}(\\nabla \\times \\mathbf{v})$。令 $\\mathbf{a}(t) \\in \\mathbb{R}^{3}$ 表示一个空间内向量，其演化可能依赖于局部自旋；假设储存能密度仅通过二次型 $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$ 依赖于 $\\mathbf{a}$，其中 $k  0$ 为常数。标架无关性（客观性）要求叠加的刚体运动不改变储存能；等效地，如果 $\\mathbf{S}(t)$ 是任意纯正正交张量，则叠加的刚性旋转 $\\mathbf{a} \\mapsto \\mathbf{S}\\mathbf{a}$ 必须使 $\\psi$ 保持不变。您的任务是，仅从第一性原理和核心定义出发，推导出一个在单个时间步内对 $\\mathbf{a}$ 的算法更新，该更新使用局部角速度矢量 $\\mathbf{w}$，并保证 $\\psi$ 在任意叠加的刚性旋转下保持不变。\n\n具体而言，在一个时长为 $\\Delta t$ 的单个时间步内，假设步长内的自旋由与局部角速度矢量 $\\mathbf{w}$ 相关的反对称生成元表示，并且 $\\mathbf{a}$ 的内在（耗散）演化在一个共旋标架中通过线性松弛 $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$ 发生，其中 $\\lambda \\ge 0$ 为常数，$\\widehat{\\mathbf{a}}$ 表示在共旋标架中表达的内变量。您的推导应从 $\\mathbf{W}$、$\\mathbf{w}$ 和客观性的定义开始；必须使用由自旋（从反对称生成元获得）引出的物理上合理的、在步长内的有限转动，并且必须阐明如何进行共旋标架的变换，以确保储存能密度 $\\psi$ 不受叠加的刚体运动影响。不要假设任何“捷径”式的本构更新公式；相反，要从基本运动学定义和客观性要求出发，论证每一步的合理性。\n\n实现要求：\n- 使用在步长内由与 $\\mathbf{w}$ 对应的反对称算子（在步长内保持恒定）所产生的、由自旋引出的精确有限转动。角度必须以弧度为单位。\n- 使用与客观性要求一致的共旋更新，其中耗散模型 $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$ 在共旋标架中作用。\n- 储存能为 $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$。在适当的情况下，数值验证能量不变性。\n- 所有输入都是无量纲的；不需要进行物理单位转换。\n\n需要实现和评估的测试套件：\n1. 纯刚体自旋，无耗散（能量守恒）：\n   - 初始内向量 $\\mathbf{a}_{0} = [\\,1.2,\\,-0.7,\\,0.3\\,]^{\\mathsf{T}}$。\n   - 局部角速度矢量 $\\mathbf{w} = [\\,0,\\,0,\\,10\\,]^{\\mathsf{T}}$。\n   - 时间步长 $\\Delta t = 0.01$。\n   - 松弛参数 $\\lambda = 0$。\n   - 刚度 $k = 2.0$。\n   - 输出一个布尔值，表示在一个步长内能量是否在 $10^{-10}$ 的容差内守恒。\n\n2. 叠加刚性旋转下的标架无关性（客观性检查）：\n   - 初始内向量 $\\mathbf{a}_{0} = [\\,0.3,\\,0.5,\\,-1.1\\,]^{\\mathsf{T}}$。\n   - 局部角速度矢量 $\\mathbf{w} = [\\,2.0,\\,-1.0,\\,0.5\\,]^{\\mathsf{T}}$。\n   - 时间步长 $\\Delta t = 0.02$。\n   - 松弛参数 $\\lambda = 0$。\n   - 刚度 $k = 3.0$。\n   - 叠加的刚性旋转 $\\mathbf{S}$：绕 $x$ 轴旋转角度 $\\theta_{\\mathrm{s}} = 0.8$ 弧度（即对应于此轴-角的纯正正交矩阵）。\n   - 在一个步长内用两种方式计算更新：（A）在原始标架中；（B）在旋转后的标架中，从 $\\mathbf{a}'_{0} = \\mathbf{S}\\mathbf{a}_{0}$ 和 $\\mathbf{w}' = \\mathbf{S}\\mathbf{w}$ 开始，然后将结果通过 $\\mathbf{S}^{\\mathsf{T}}$ 映射回去。输出一个布尔值，如果两个更新后的向量在 $10^{-10}$ 的容差内满足 $\\mathbf{a}_{1} = \\mathbf{S}^{\\mathsf{T}} \\mathbf{a}'_{1}$ 且最终能量在 $10^{-10}$ 的容差内匹配，则该值为真。\n\n3. 零自旋带耗散（能量比）：\n   - 初始内向量 $\\mathbf{a}_{0} = [\\,1.0,\\,2.0,\\,-1.0\\,]^{\\mathsf{T}}$。\n   - 局部角速度矢量 $\\mathbf{w} = [\\,0,\\,0,\\,0\\,]^{\\mathsf{T}}$。\n   - 时间步长 $\\Delta t = 0.02$。\n   - 松弛参数 $\\lambda = 5.0$。\n   - 刚度 $k = 1.5$。\n   - 输出一步之后浮点数比率 $\\psi(\\mathbf{a}_{1})/\\psi(\\mathbf{a}_{0})$。\n\n4. 自旋与耗散结合（旋转下能量变化的客观性）：\n   - 初始内向量 $\\mathbf{a}_{0} = [\\,0.2,\\,-0.3,\\,0.4\\,]^{\\mathsf{T}}$。\n   - 局部角速度矢量 $\\mathbf{w} = [\\,4.0,\\,3.0,\\,0.0\\,]^{\\mathsf{T}}$。\n   - 时间步长 $\\Delta t = 0.005$。\n   - 松弛参数 $\\lambda = 20.0$。\n   - 刚度 $k = 0.7$。\n   - 输出一个布尔值，如果能量比 $\\psi(\\mathbf{a}_{1})/\\psi(\\mathbf{a}_{0})$ 与仅由共旋标架中的耗散所预测的值 $(1-\\lambda \\Delta t)^{2}$ 在 $10^{-12}$ 的容差内匹配，则该值为真。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述四个测试用例的顺序排列。例如，格式必须与 $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$ 完全一样，其中第一、第二和第四个条目是布尔值，第三个是浮点数。", "solution": "目标是为自旋相关的内向量 $\\mathbf{a} \\in \\mathbb{R}^{3}$ 构建一个时间离散化方案，该方案能保持二次型储存能 $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$ 的标架无关性（客观性），并从基本定义出发。\n\n基本运动学：\n- 空间速度梯度为 $\\mathbf{L} = \\nabla \\mathbf{v}$。其反对称部分是自旋张量 $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$。\n- 局部角速度矢量 $\\mathbf{w}$ 是 $\\mathbf{W}$ 的轴矢量，即 $\\mathbf{w} = \\operatorname{ax}(\\mathbf{W})$，且 $\\mathbf{w} = \\frac{1}{2}(\\nabla \\times \\mathbf{v})$。映射 $\\mathbf{w} \\mapsto \\mathbf{W}$ 为 $\\mathbf{W} = \\operatorname{skew}(\\mathbf{w})$，其中对于 $\\mathbf{w} = [\\,w_{x},\\,w_{y},\\,w_{z}\\,]^{\\mathsf{T}}$，\n$$\n\\operatorname{skew}(\\mathbf{w}) \\equiv\n\\begin{bmatrix}\n0  -w_{z}  w_{y} \\\\\nw_{z}  0  -w_{x} \\\\\n-w_{y}  w_{x}  0\n\\end{bmatrix}.\n$$\n\n客观性与共旋率：\n- 标架无关性要求叠加的刚体运动不影响物理响应。对于任意纯正正交张量 $\\mathbf{S}(t)$，如果 $\\mathbf{a}$ 变换为 $\\mathbf{a} \\mapsto \\mathbf{S}\\mathbf{a}$，那么储存能必须满足 $\\psi(\\mathbf{a}) = \\psi(\\mathbf{S}\\mathbf{a})$。二次型 $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$ 已经满足这种不变性，因为 $\\lVert \\mathbf{S}\\mathbf{a} \\rVert = \\lVert \\mathbf{a} \\rVert$。\n- 为确保 $\\mathbf{a}$ 的演化律是客观的，其变化率必须是共旋的。引入一个旋转张量 $\\mathbf{R}(t)$，它在一个步长内遵循材料自旋，即 $\\dot{\\mathbf{R}}(t) = \\mathbf{W}(t)\\mathbf{R}(t)$ 且 $\\mathbf{R}(t_{n}) = \\mathbf{I}$，定义共旋内变量 $\\widehat{\\mathbf{a}}(t) = \\mathbf{R}(t)^{\\mathsf{T}}\\mathbf{a}(t)$。求导可得\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\widehat{\\mathbf{a}} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left(\\mathbf{R}^{\\mathsf{T}} \\mathbf{a}\\right)\n= \\dot{\\mathbf{R}}^{\\mathsf{T}} \\mathbf{a} + \\mathbf{R}^{\\mathsf{T}} \\dot{\\mathbf{a}}\n= -\\mathbf{R}^{\\mathsf{T}}\\mathbf{W}^{\\mathsf{T}}\\mathbf{a} + \\mathbf{R}^{\\mathsf{T}} \\dot{\\mathbf{a}}\n= \\mathbf{R}^{\\mathsf{T}}(\\dot{\\mathbf{a}} - \\mathbf{W}\\mathbf{a}),\n$$\n因为对于反对称的 $\\mathbf{W}$，有 $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$。一个客观的本构法则是将内在演化在共旋标架中建模为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\widehat{\\mathbf{a}} = G(\\widehat{\\mathbf{a}}),\n$$\n其中 $G$ 独立于叠加的刚性旋转。对于本测试，我们取 $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$，其中 $\\lambda \\ge 0$。\n\n一个时间步内的有限转动更新：\n- 在一个时间步 $[\\,t_{n}, t_{n} + \\Delta t\\,]$ 内，将 $\\mathbf{W}$ 近似为常数（一阶保持），其生成元为 $\\mathbf{W}_{n} = \\operatorname{skew}(\\mathbf{w}_{n})$。由自旋在该步长内引出的精确有限转动是纯正正交张量\n$$\n\\mathbf{Q} = \\exp(\\Delta t \\, \\mathbf{W}_{n}),\n$$\n即一个反对称矩阵的矩阵指数，其结果为一个旋转。如果 $\\theta = \\lVert \\mathbf{w}_{n} \\rVert \\Delta t$ 且 $\\widehat{\\boldsymbol{k}} = \\mathbf{w}_{n}/\\lVert \\mathbf{w}_{n} \\rVert$（对于 $\\lVert \\mathbf{w}_{n} \\rVert  0$），则 $\\mathbf{Q}$ 是绕轴 $\\widehat{\\boldsymbol{k}}$ 旋转角度 $\\theta$ 的旋转。这可以通过 Rodrigues 公式稳健地计算；对于非常小的 $\\theta$，级数展开提供了数值上稳定的近似。\n\n客观时间步进算法：\n1. 构建 $\\mathbf{W}_{n} = \\operatorname{skew}(\\mathbf{w}_{n})$ 并计算 $\\mathbf{Q} = \\exp(\\Delta t \\, \\mathbf{W}_{n})$。\n2. 通过 $\\widehat{\\mathbf{a}}_{n} = \\mathbf{Q}^{\\mathsf{T}} \\mathbf{a}_{n}$ 变换到 $t_{n}$ 时刻的共旋标架（因为 $\\mathbf{Q}$ 近似 $\\mathbf{R}(t_{n} + \\Delta t)$ 且 $\\mathbf{R}(t_{n}) = \\mathbf{I}$，逆映射为 $\\mathbf{Q}^{\\mathsf{T}}$）。\n3. 在共旋标架中显式推进内在演化：\n$$\n\\widehat{\\mathbf{a}}_{n+1} = \\widehat{\\mathbf{a}}_{n} + \\Delta t \\, G(\\widehat{\\mathbf{a}}_{n}) = (1 - \\lambda \\Delta t)\\, \\widehat{\\mathbf{a}}_{n}.\n$$\n4. 旋转回空间标架：\n$$\n\\mathbf{a}_{n+1} = \\mathbf{Q} \\, \\widehat{\\mathbf{a}}_{n+1}.\n$$\n此更新对于旋转和内在演化都是时间上一阶精确的，并且精确满足有限转动与共旋标架中线性松弛的复合。\n\n客观性为何成立：\n- 在任何叠加的刚性旋转 $\\mathbf{S}$ 下，自旋和内向量变换为 $\\mathbf{W} \\mapsto \\mathbf{S} \\mathbf{W} \\mathbf{S}^{\\mathsf{T}}$ 和 $\\mathbf{a} \\mapsto \\mathbf{S} \\mathbf{a}$。步长旋转遵循 $\\mathbf{Q} \\mapsto \\mathbf{Q}' = \\exp(\\Delta t \\, \\mathbf{S}\\mathbf{W}\\mathbf{S}^{\\mathsf{T}}) = \\mathbf{S}\\, \\exp(\\Delta t \\mathbf{W}) \\, \\mathbf{S}^{\\mathsf{T}} = \\mathbf{S}\\mathbf{Q}\\mathbf{S}^{\\mathsf{T}}$，这是由于指数函数在相似变换下的不变性。共旋变量变换为 $\\widehat{\\mathbf{a}}_{n}' = \\mathbf{Q}'^{\\mathsf{T}} \\mathbf{a}_{n}' = (\\mathbf{S}\\mathbf{Q}\\mathbf{S}^{\\mathsf{T}})^{\\mathsf{T}} \\mathbf{S} \\mathbf{a}_{n} = \\mathbf{S} \\widehat{\\mathbf{a}}_{n}$。因为 $G$ 是在共旋标架中定义的，并且在这里是各向同性的（$G = -\\lambda \\widehat{\\mathbf{a}}$），所以有 $\\widehat{\\mathbf{a}}_{n+1}' = (1 - \\lambda \\Delta t) \\widehat{\\mathbf{a}}_{n}' = \\mathbf{S} \\widehat{\\mathbf{a}}_{n+1}$。旋转回去得到 $\\mathbf{a}_{n+1}' = \\mathbf{Q}' \\widehat{\\mathbf{a}}_{n+1}' = \\mathbf{S} \\mathbf{Q} \\mathbf{S}^{\\mathsf{T}} \\mathbf{S} \\widehat{\\mathbf{a}}_{n+1} = \\mathbf{S} \\mathbf{a}_{n+1}$。因此，$\\lVert \\mathbf{a}_{n+1}' \\rVert = \\lVert \\mathbf{a}_{n+1} \\rVert$，$\\psi$ 不受叠加旋转的影响，从而保证了客观性。\n- 特别地，对于 $\\lambda = 0$ 的纯自旋，更新简化为 $\\mathbf{a}_{n+1} = \\mathbf{Q} \\mathbf{a}_{n}$，这是一个空间中的刚性旋转；因此 $\\lVert \\mathbf{a}_{n+1} \\rVert = \\lVert \\mathbf{a}_{n} \\rVert$，$\\psi$ 精确守恒（在数值舍入误差范围内）。\n- 对于非零的 $\\lambda$，模长仅通过共旋标架中的因子 $(1 - \\lambda \\Delta t)$ 改变，意味着 $\\lVert \\mathbf{a}_{n+1} \\rVert = |1 - \\lambda \\Delta t| \\, \\lVert \\mathbf{a}_{n} \\rVert$，这与自旋无关。因此，能量比为\n$$\n\\frac{\\psi(\\mathbf{a}_{n+1})}{\\psi(\\mathbf{a}_{n})} = \\frac{\\tfrac{1}{2} k \\lVert \\mathbf{a}_{n+1} \\rVert^{2}}{\\tfrac{1}{2} k \\lVert \\mathbf{a}_{n} \\rVert^{2}} = (1 - \\lambda \\Delta t)^{2}.\n$$\n\n计算的算法细节：\n- 通过轴向映射从 $\\mathbf{w}$ 构建 $\\mathbf{W}$。\n- 计算 $\\mathbf{Q} = \\exp(\\Delta t \\, \\mathbf{W})$。为保证数值稳健性，当 $\\theta = \\lVert \\mathbf{w} \\rVert \\Delta t$ 不极小时，使用 Rodrigues 公式；当 $\\theta$ 非常小时，使用截断级数 $\\mathbf{Q} \\approx \\mathbf{I} + \\Delta t \\, \\mathbf{W} + \\tfrac{1}{2} (\\Delta t \\, \\mathbf{W})^{2}$。\n- 在共旋标架中执行共旋显式欧拉更新，然后如上所述旋转回去。\n\n测试套件预期结果：\n1. 对于 $\\mathbf{a}_{0} = [\\,1.2,\\,-0.7,\\,0.3\\,]^{\\mathsf{T}}$，$\\mathbf{w} = [\\,0,\\,0,\\,10\\,]^{\\mathsf{T}}$，$\\Delta t = 0.01$，$\\lambda = 0$，$k = 2.0$，能量守恒，在 $10^{-10}$ 容差内得到布尔值 $\\mathrm{True}$。\n2. 对于 $\\mathbf{a}_{0} = [\\,0.3,\\,0.5,\\,-1.1\\,]^{\\mathsf{T}}$，$\\mathbf{w} = [\\,2.0,\\,-1.0,\\,0.5\\,]^{\\mathsf{T}}$，$\\Delta t = 0.02$，$\\lambda = 0$，$k = 3.0$，以及绕 $x$ 轴叠加旋转 $\\theta_{\\mathrm{s}} = 0.8$，客观性条件 $\\mathbf{a}_{1}' = \\mathbf{S}\\mathbf{a}_{1}$ 成立且能量匹配，在 $10^{-10}$ 容差内得到布尔值 $\\mathrm{True}$。\n3. 对于 $\\mathbf{a}_{0} = [\\,1.0,\\,2.0,\\,-1.0\\,]^{\\mathsf{T}}$，$\\mathbf{w} = [\\,0,\\,0,\\,0\\,]^{\\mathsf{T}}$，$\\Delta t = 0.02$，$\\lambda = 5.0$，$k = 1.5$，能量比为 $(1 - \\lambda \\Delta t)^{2} = (1 - 5.0 \\times 0.02)^{2} = 0.81$，输出为浮点数。\n4. 对于 $\\mathbf{a}_{0} = [\\,0.2,\\,-0.3,\\,0.4\\,]^{\\mathsf{T}}$，$\\mathbf{w} = [\\,4.0,\\,3.0,\\,0.0\\,]^{\\mathsf{T}}$，$\\Delta t = 0.005$，$\\lambda = 20.0$，$k = 0.7$，能量比应等于 $(1 - \\lambda \\Delta t)^{2} = (1 - 20.0 \\times 0.005)^{2} = 0.81$，因此将计算出的比率与 $0.81$ 在 $10^{-12}$ 容差内比较的布尔测试应为 $\\mathrm{True}$。\n\n程序必须实现该算法，并按指定顺序和格式将四个测试的结果作为单个列表打印在单行上。", "answer": "```python\nimport numpy as np\n\ndef skew_from_vec(omega):\n    ox, oy, oz = omega\n    return np.array([[0.0, -oz, oy],\n                     [oz,  0.0, -ox],\n                     [-oy, ox,  0.0]], dtype=float)\n\ndef rotation_from_omega_dt(omega, dt, tol=1e-12):\n    # Construct proper orthogonal rotation Q = exp(dt * W(omega))\n    omega = np.asarray(omega, dtype=float).reshape(3)\n    wnorm = np.linalg.norm(omega)\n    if wnorm  tol:\n        # Small-angle series: Q ≈ I + dt*W + 0.5*(dt*W)^2\n        Wdt = skew_from_vec(omega) * dt\n        return np.eye(3) + Wdt + 0.5 * (Wdt @ Wdt)\n    # Axis-angle Rodrigues\n    k = omega / wnorm\n    K = skew_from_vec(k)\n    theta = wnorm * dt\n    s = np.sin(theta)\n    c = np.cos(theta)\n    return np.eye(3) + s * K + (1.0 - c) * (K @ K)\n\ndef objective_update_a(a_n, omega, dt, lam):\n    # One-step objective update using corotational explicit Euler with linear relaxation\n    Q = rotation_from_omega_dt(omega, dt)\n    # Corotational transform\n    a_hat_n = Q.T @ a_n\n    # Intrinsic evolution in corotating frame: a_hat_{n+1} = (1 - lam*dt) a_hat_n\n    a_hat_np1 = (1.0 - lam * dt) * a_hat_n\n    # Rotate back\n    a_np1 = Q @ a_hat_np1\n    return a_np1\n\ndef energy(a, k):\n    return 0.5 * k * float(a @ a)\n\ndef test_case_1():\n    a0 = np.array([1.2, -0.7, 0.3], dtype=float)\n    omega = np.array([0.0, 0.0, 10.0], dtype=float)\n    dt = 0.01\n    lam = 0.0\n    k = 2.0\n    E0 = energy(a0, k)\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    return abs(E1 - E0) = 1e-10\n\ndef rotation_about_x(theta):\n    c = np.cos(theta)\n    s = np.sin(theta)\n    return np.array([[1.0, 0.0, 0.0],\n                     [0.0, c,   -s ],\n                     [0.0, s,    c ]], dtype=float)\n\ndef test_case_2():\n    a0 = np.array([0.3, 0.5, -1.1], dtype=float)\n    omega = np.array([2.0, -1.0, 0.5], dtype=float)\n    dt = 0.02\n    lam = 0.0\n    k = 3.0\n    # Frame A\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    # Superposed rotation S about x by 0.8 rad\n    theta_s = 0.8\n    S = rotation_about_x(theta_s)\n    # Transform to frame B\n    a0p = S @ a0\n    omegap = S @ omega\n    # Update in frame B\n    a1p = objective_update_a(a0p, omegap, dt, lam)\n    # Map back to frame A\n    a1_back = S.T @ a1p\n    E1p = energy(a1p, k)  # energy is frame-invariant with same k\n    same_vec = np.allclose(a1_back, a1, atol=1e-10, rtol=0.0)\n    same_energy = abs(E1p - E1) = 1e-10\n    return bool(same_vec and same_energy)\n\ndef test_case_3():\n    a0 = np.array([1.0, 2.0, -1.0], dtype=float)\n    omega = np.array([0.0, 0.0, 0.0], dtype=float)\n    dt = 0.02\n    lam = 5.0\n    k = 1.5\n    E0 = energy(a0, k)\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    ratio = E1 / E0\n    return float(ratio)\n\ndef test_case_4():\n    a0 = np.array([0.2, -0.3, 0.4], dtype=float)\n    omega = np.array([4.0, 3.0, 0.0], dtype=float)\n    dt = 0.005\n    lam = 20.0\n    k = 0.7\n    E0 = energy(a0, k)\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    ratio = E1 / E0\n    expected = (1.0 - lam * dt) ** 2\n    return abs(ratio - expected) = 1e-12\n\ndef solve():\n    results = []\n    results.append(test_case_1())\n    results.append(test_case_2())\n    results.append(test_case_3())\n    results.append(test_case_4())\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2700502"}]}