{"hands_on_practices": [{"introduction": "复杂的晶体取向通常通过一系列简单的旋转操作来实现。这个练习 [@problem_id:1807429] 将演示如何运用矩阵乘法，为一个连续的旋转序列找到等效的单次旋转，这是欧拉旋转定理的一个直接应用。这项技能对于理解取向关系和测角仪等实验装置至关重要。", "problem": "在材料科学实验室中，一名研究人员正在使用测角仪来为一个表征实验定向一个单晶样品。测角仪平台由一个固定在实验室上的右手笛卡尔坐标系 $(x, y, z)$ 描述。该样品经历两个连续的旋转。首先，它绕固定的 $z$ 轴旋转 $90^{\\circ}$。紧接着，它绕固定的 $x$ 轴旋转 $90^{\\circ}$。当从轴的正方向朝向原点看时，两次旋转均以逆时针方向进行。\n\n根据欧拉旋转定理，这两个连续的旋转等效于绕一个由单位向量 $\\hat{n}$ 表示的固定轴的单一旋转，旋转角度为 $\\theta$。下列哪个选项正确地指出了旋转轴 $\\hat{n}$ 和旋转角 $\\theta$？\n\nA. 旋转轴: $\\frac{1}{\\sqrt{3}}(1, 1, 1)$, 旋转角: $90^{\\circ}$\n\nB. 旋转轴: $\\frac{1}{\\sqrt{3}}(1, 1, 1)$, 旋转角: $120^{\\circ}$\n\nC. 旋转轴: $\\frac{1}{\\sqrt{3}}(1, -1, 1)$, 旋转角: $90^{\\circ}$\n\nD. 旋转轴: $\\frac{1}{\\sqrt{3}}(1, -1, 1)$, 旋转角: $120^{\\circ}$\n\nE. 旋转轴: $\\frac{1}{\\sqrt{3}}(1, 1, -1)$, 旋转角: $120^{\\circ}$", "solution": "设固定的实验室坐标轴为 $(x,y,z)$。绕固定的 $z$ 轴逆时针旋转角度 $\\beta$ 的旋转矩阵（作用于列向量）为\n$$\nR_{z}(\\beta)=\\begin{pmatrix}\n\\cos\\beta & -\\sin\\beta & 0\\\\\n\\sin\\beta & \\cos\\beta & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n绕固定的 $x$ 轴逆时针旋转角度 $\\alpha$ 的旋转矩阵为\n$$\nR_{x}(\\alpha)=\\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & \\cos\\alpha & -\\sin\\alpha\\\\\n0 & \\sin\\alpha & \\cos\\alpha\n\\end{pmatrix}.\n$$\n第一次旋转为绕 $z$ 轴旋转 $\\beta=\\frac{\\pi}{2}$，第二次旋转为绕 $x$ 轴旋转 $\\alpha=\\frac{\\pi}{2}$。由于两个轴都是固定的（外在旋转），总旋转矩阵为\n$$\nR=R_{x}\\!\\left(\\frac{\\pi}{2}\\right)R_{z}\\!\\left(\\frac{\\pi}{2}\\right).\n$$\n代入 $\\cos\\left(\\frac{\\pi}{2}\\right)=0$ 和 $\\sin\\left(\\frac{\\pi}{2}\\right)=1$ 进行计算，\n$$\nR_{z}\\!\\left(\\frac{\\pi}{2}\\right)=\\begin{pmatrix}\n0 & -1 & 0\\\\\n1 & 0 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix},\\qquad\nR_{x}\\!\\left(\\frac{\\pi}{2}\\right)=\\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 0 & -1\\\\\n0 & 1 & 0\n\\end{pmatrix},\n$$\n因此\n$$\nR= \\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 0 & -1\\\\\n0 & 1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & -1 & 0\\\\\n1 & 0 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}\n=\\begin{pmatrix}\n0 & -1 & 0\\\\\n0 & 0 & -1\\\\\n1 & 0 & 0\n\\end{pmatrix}.\n$$\n\n根据欧拉旋转定理，任何一个真旋转矩阵 $R$ 都等效于绕某个单位轴 $\\hat{n}$ 旋转某个角度 $\\theta$。该角度满足\n$$\n\\operatorname{tr}(R)=1+2\\cos\\theta.\n$$\n此处 $\\operatorname{tr}(R)=0$，所以\n$$\n0=1+2\\cos\\theta\\quad\\Rightarrow\\quad \\cos\\theta=-\\frac{1}{2}\\quad\\Rightarrow\\quad \\theta=\\frac{2\\pi}{3}\\ \\text{(即 120 度)}.\n$$\n\n旋转轴是 $R$ 对应于特征值 $1$ 的特征向量，即求解 $(R-I)\\hat{n}=0$。计算\n$$\nR-I=\\begin{pmatrix}\n-1 & -1 & 0\\\\\n0 & -1 & -1\\\\\n1 & 0 & -1\n\\end{pmatrix}.\n$$\n设 $\\hat{n}=(n_{x},n_{y},n_{z})^{\\top}$。方程组\n$$\n\\begin{cases}\n-n_{x}-n_{y}=0,\\\\\n-n_{y}-n_{z}=0,\\\\\nn_{x}-n_{z}=0\n\\end{cases}\n$$\n给出 $n_{x}=-n_{y}$，$n_{y}=-n_{z}$ 和 $n_{x}=n_{z}$，这些方程是相容的，并得出 $\\hat{n}\\propto(1,-1,1)$。\n归一化后，\n$$\n\\hat{n}=\\frac{1}{\\sqrt{3}}(1,-1,1).\n$$\n\n因此，等效的单一旋转是绕轴 $\\hat{n}=\\frac{1}{\\sqrt{3}}(1,-1,1)$ 旋转角度 $\\theta=\\frac{2\\pi}{3}$，这对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1807429"}, {"introduction": "为了精确描述晶体结构，我们需要从笛卡尔坐标系转换到分数坐标系，这是晶体学的标准语言。这个问题 [@problem_id:1807456] 提供了对复合对称操作——螺旋轴——的实践，它结合了旋转和平移。掌握这一操作对于解读空间群符号和预测原子位置至关重要。", "problem": "在一种假设材料的晶体学分析中，一个原子位于晶胞内由分数坐标 $(u, v, w) = (0.2, 0.3, 0.4)$ 描述的位置。该晶体结构具有一个 $2_1$ 螺旋轴对称操作。该轴平行于晶体学 c 轴，并穿过晶胞的原点 $(0, 0, 0)$。\n\n一个 $2_1$ 螺旋轴是一个复合对称操作，定义为绕轴旋转 $180^{\\circ}$，然后沿轴方向平移二分之一个晶格矢量。\n\n确定在应用此 $2_1$ 螺旋轴操作后，原子的新分数坐标 $(u', v', w')$。根据惯例，所有最终分数坐标都应表示在范围 $[0, 1)$ 内。", "solution": "一个平行于晶体学 $c$ 轴的 $2_{1}$ 螺旋轴定义为绕 $c$ 轴旋转 $180^{\\circ}$，然后沿 $c$ 轴方向平移二分之一个晶格矢量。在分数坐标中，将初始位置表示为列向量\n$$\n\\mathbf{r}=\\begin{pmatrix} u \\\\ v \\\\ w \\end{pmatrix}.\n$$\n绕 $c$ 轴旋转 $180^{\\circ}$ 的操作由矩阵表示\n$$\nR=\\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix},\n$$\n螺旋平移为\n$$\n\\mathbf{t}=\\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix}.\n$$\n因此，变换后的分数坐标由仿射操作给出\n$$\n\\mathbf{r}'=R\\,\\mathbf{r}+\\mathbf{t}.\n$$\n代入 $(u,v,w)=(0.2,0.3,0.4)$ 得\n$$\n\\mathbf{r}'=\\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\\begin{pmatrix} 0.2 \\\\ 0.3 \\\\ 0.4 \\end{pmatrix}+\\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix}=\\begin{pmatrix} -0.2 \\\\ -0.3 \\\\ 0.4 \\end{pmatrix}+\\begin{pmatrix} 0 \\\\ 0 \\\\ 0.5 \\end{pmatrix}=\\begin{pmatrix} -0.2 \\\\ -0.3 \\\\ 0.9 \\end{pmatrix}.\n$$\n根据晶体学惯例，分数坐标通过对 1 取模约化到区间 $[0,1)$ 内。对每个分量应用此操作，\n$$\n-0.2 \\mod 1=0.8,\\quad -0.3 \\mod 1=0.7,\\quad 0.9 \\mod 1=0.9.\n$$\n因此，新的分数坐标为 $(0.8,\\,0.7,\\,0.9)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.8 & 0.7 & 0.9 \\end{pmatrix}}$$", "id": "1807456"}, {"introduction": "本节将理论与现代计算实践联系起来。这个高级练习 [@problem_id:2864749] 要求你编写一个算法来应用对称操作，并识别出晶胞内的所有不等效原子位置。这项任务模拟了许多材料科学软件包的核心逻辑，并要求你仔细处理周期性和数值精度问题。", "problem": "实现一个算法，将一组有限的塞茨操作应用于一个以分数坐标表示的种子位置，并识别出在晶格平移下等价的不同像。一个塞茨操作由一对 $\\left(R \\mid \\mathbf{t}\\right)$ 定义，作用于位置向量 $\\mathbf{r}$ 的结果为 $\\mathbf{r}' = R \\mathbf{r} + \\mathbf{t}$。背景是一个由基底定义的布拉维晶格，分数坐标是相对于该基底定义的，因此两个位置 $\\mathbf{r}_{1}$ 和 $\\mathbf{r}_{2}$ 等价当且仅当 $\\mathbf{r}_{1} - \\mathbf{r}_{2} = \\mathbf{n}$，其中 $\\mathbf{n} \\in \\mathbb{Z}^{3}$ 是某个整数向量。在实际计算中，如果两个分数坐标位置 $\\mathbf{x}, \\mathbf{y} \\in \\mathbb{R}^{3}$ 的差 $\\mathbf{x}-\\mathbf{y}$ 与某个整数向量的差异在每个分量上最多为 $\\epsilon = 10^{-8}$，则将它们视为等价。您必须完全在分数坐标下操作；晶格基底是隐式的，而模晶格平移的约化对应于将每个分量取模 $1$ 以映射到半开区间 $\\left[0,1\\right)$ 内。\n\n使用的基本原理：\n- 欧几里得空间中线性等距同构与平移的群作用，由塞茨对 $\\left(R \\mid \\mathbf{t}\\right)$ 编码，其定义为 $\\mathbf{r}' = R \\mathbf{r} + \\mathbf{t}$。\n- 晶格的周期性：$\\mathbf{r}$ 和 $\\mathbf{r} + \\mathbf{n}$（其中 $\\mathbf{n} \\in \\mathbb{Z}^{3}$）标记了晶体中相同的物理点。\n- 在晶格平移下的位置等价类构成了商空间 $\\mathbb{R}^{3}/\\mathbb{Z}^{3}$，由分量逐一模 $1$ 约化后的分数坐标表示。\n\n您的程序必须：\n- 对于每个测试用例，将每个给定的塞茨操作 $\\left(R \\mid \\mathbf{t}\\right)$ 应用于种子分数坐标位置 $\\mathbf{r}$ 来计算 $\\mathbf{r}' = R \\mathbf{r} + \\mathbf{t}$，然后通过模 $1$ 操作将 $\\mathbf{r}'$ 的每个分量约化到 $\\left[0,1\\right)$ 区间内。\n- 实现模晶格平移的等价性：如果存在 $\\mathbf{n} \\in \\mathbb{Z}^{3}$ 使得 $\\left\\lVert \\left(\\mathbf{x} - \\mathbf{y}\\right) - \\mathbf{n} \\right\\rVert_{\\infty} \\le \\epsilon$（其中 $\\epsilon = 10^{-8}$），则两个约化后的分数坐标位置 $\\mathbf{x}$ 和 $\\mathbf{y}$ 被认为是相同的。\n- 对于每个测试用例，计算由给定的一组塞茨操作从种子位置生成的不同像的数量。\n\n重要实现细节：\n- 所有坐标都是无单位的分数坐标；无需报告物理单位。\n- 在您的等价性检查中，始终使用指定的容差 $\\epsilon = 10^{-8}$。\n- 输入中不出现角度；所有旋转矩阵 $R$ 都被明确指定。\n- 您必须确保边界处的数值稳定性，例如，一个分量在四舍五入后等于 $1$ 应被映射为 $0$。\n\n测试套件：\n提供以下五个测试用例的结果。在每个案例中，操作和坐标都以分数坐标表示法给出。\n\n- 测试用例 1：简单的单位操作。\n  - 种子 $\\mathbf{r} = \\left(0.1, 0.2, 0.3\\right)$。\n  - 操作：$\\left(I \\mid \\left(0, 0, 0\\right)\\right)$，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n- 测试用例 2：绕 z 轴的二重旋转。\n  - 种子 $\\mathbf{r} = \\left(0.3, 0.1, 0.0\\right)$。\n  - 操作：$\\left(I \\mid \\left(0, 0, 0\\right)\\right)$ 和 $\\left(R_{2z} \\mid \\left(0, 0, 0\\right)\\right)$，其中 $R_{2z} = \\mathrm{diag}\\left(-1, -1, 1\\right)$。\n- 测试用例 3：沿 z 方向的二重螺旋轴。\n  - 种子 $\\mathbf{r} = \\left(0.25, 0.25, 0.25\\right)$。\n  - 操作：$\\left(I \\mid \\left(0, 0, 0\\right)\\right)$ 和 $\\left(R_{2z} \\mid \\left(0, 0, 0.5\\right)\\right)$，其中 $R_{2z} = \\mathrm{diag}\\left(-1, -1, 1\\right)$。\n- 测试用例 4：将绕 z 轴的四重旋转应用于一个高对称点。\n  - 种子 $\\mathbf{r} = \\left(0, 0, 0\\right)$。\n  - 操作：$\\left(R_{k} \\mid \\left(0, 0, 0\\right)\\right)$ 对于 $k \\in \\left\\{0,1,2,3\\right\\}$，其中\n    $$\n    R_{0} = \\begin{bmatrix} 1 & 0 & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix},\\;\n    R_{1} = \\begin{bmatrix} 0 & -1 & 0\\\\ 1 & 0 & 0\\\\ 0 & 0 & 1 \\end{bmatrix},\\;\n    R_{2} = \\begin{bmatrix} -1 & 0 & 0\\\\ 0 & -1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix},\\;\n    R_{3} = \\begin{bmatrix} 0 & 1 & 0\\\\ -1 & 0 & 0\\\\ 0 & 0 & 1 \\end{bmatrix}.\n    $$\n- 测试用例 5：由于纯晶格平移被嵌入为塞茨操作而产生的冗余。\n  - 种子 $\\mathbf{r} = \\left(0.4, 0.6, 0.7\\right)$。\n  - 操作：$\\left(I \\mid \\left(0, 0, 0\\right)\\right)$ 和 $\\left(I \\mid \\left(1, 0, 0\\right)\\right)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个整数列表，其中第 $j$ 个整数是测试用例 $j$ 的不同像的数量。\n- 格式必须是严格的一行，由方括号包围的逗号分隔列表，例如 $\\left[\\text{result}_{1},\\text{result}_{2},\\ldots\\right]$。", "solution": "该问题要求实现一个算法，以确定在一组对称操作应用于晶格内的初始种子位置后所生成的唯一原子位置的数量。整个分析都在分数坐标下进行，其中周期性和等价性通过模晶格平移来处理。\n\n晶体中的对称操作在数学上由一个塞茨对 $\\left(R \\mid \\mathbf{t}\\right)$ 描述，它包含一个旋转部分 $R$（一个 $3 \\times 3$ 矩阵）和一个平移部分 $\\mathbf{t}$（一个 $3 \\times 1$ 向量）。此操作对位置向量 $\\mathbf{r}$ 的作用是一个仿射变换，由下式给出：\n$$\n\\mathbf{r}' = R \\mathbf{r} + \\mathbf{t}\n$$\n所有向量和矩阵都在基于晶格向量的分数坐标系中表示。在此系统中，晶体的周期性意味着如果两个位置 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 的差是一个具有整数分量的向量，则它们在物理上是等价的。也就是说，如果 $\\mathbf{r}_1 - \\mathbf{r}_2 = \\mathbf{n}$ 对于某个 $\\mathbf{n} \\in \\mathbb{Z}^3$ 成立，则 $\\mathbf{r}_1 \\sim \\mathbf{r}_2$。\n\n这种等价关系将所有位置的空间划分为等价类。每个等价类的规范代表可以在主晶胞中找到，该晶胞由半开区间 $\\left[0, 1\\right)$ 内的分数坐标定义。任何位置向量 $\\mathbf{r}'$ 都可以通过对其每个分量取模 $1$ 来映射到该晶胞内。对于分量 $v$，其约化值 $v''$ 由 $v'' = v - \\lfloor v \\rfloor$ 给出。此操作记为 $\\mathbf{r}'' = \\mathbf{r}' \\pmod 1$，确保所有结果坐标都位于 $\\left[0, 1\\right)$ 内。\n\n解决该问题的算法对每个测试用例按以下步骤进行：\n1. 初始化一个空列表 `distinct_images`，用于存储找到的唯一位置。\n2. 对于每个给定的塞茨操作 $\\left(R_i \\mid \\mathbf{t}_i\\right)$：\n   a. 将操作应用于种子位置 $\\mathbf{r}$ 以生成新位置 $\\mathbf{r}'_i = R_i \\mathbf{r} + \\mathbf{t}_i$。\n   b. 将新位置 $\\mathbf{r}'_i$ 约化到主晶胞中，得到 $\\mathbf{r}''_i = \\mathbf{r}'_i \\pmod 1$。在计算上，这是逐分量执行的，例如，使用 `numpy.mod(vector, 1.0)`。对数值上接近 $1.0$ 的值进行特殊检查，将其映射为 $0.0$，以严格执行 $\\left[0, 1\\right)$ 区间。\n   c. 检查这个约化后的位置 $\\mathbf{r}''_i$ 是否与 `distinct_images` 中已存储的任何位置等价。\n\n问题的核心在于对两个约化后位置 $\\mathbf{x}$ 和 $\\mathbf{y}$（均在 $\\left[0, 1\\right)^3$ 范围内）之间等价性检查的数值实现。根据问题陈述，如果它们的差 $\\mathbf{x} - \\mathbf{y}$ 在每个分量上都与一个整数向量 $\\mathbf{n}$ 的差值在容差 $\\epsilon = 10^{-8}$ 以内，则它们是等价的。\n令 $\\mathbf{d} = \\mathbf{x} - \\mathbf{y}$。由于 $\\mathbf{x}, \\mathbf{y} \\in \\left[0, 1\\right)^3$，差向量 $\\mathbf{d}$ 的每个分量 $d_j$ 位于区间 $\\left(-1, 1\\right)$ 内。可能与 $\\mathbf{d}$ 接近的整数向量 $\\mathbf{n}$ 的分量必须在 $\\{-1, 0, 1\\}$ 中。\n等价的条件是，对于每个分量 $j \\in \\{1, 2, 3\\}$，$x_j$ 和 $y_j$ 之间的周期性距离必须小于 $\\epsilon$。在周长为 $1$ 的圆上的周期性距离由 $\\min(\\left|x_j - y_j\\right|, 1 - \\left|x_j - y_j\\right|)$ 给出。\n因此，如果对于所有分量 $j$：\n$$\n\\min(\\left|x_j - y_j\\right|, 1 - \\left|x_j - y_j\\right|) < \\epsilon\n$$\n则两个约化后的位置 $\\mathbf{x}$ 和 $\\mathbf{y}$ 被认为是等价的。\n如果发现 $\\mathbf{r}''_i$ 与 `distinct_images` 中的任何现有位置都不等价，则将其作为新的唯一像添加到列表中。\n\n3. 应用所有操作后，不同像的总数是 `distinct_images` 列表的最终大小。为每个测试用例计算此数量。\n\n此过程正确地枚举了种子位置在给定对称操作集作用下的轨道，同时遵守了晶格周期性并使用适当的容差处理了数值比较。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Applies Seitz operations to a seed position and counts distinct images\n    modulo lattice translations.\n    \"\"\"\n    epsilon = 1e-8\n\n    # Define the test cases from the problem statement.\n    I = np.identity(3)\n    R2z = np.diag([-1., -1., 1.])\n    R4z_0 = np.array([[1., 0., 0.], [0., 1., 0.], [0., 0., 1.]])\n    R4z_1 = np.array([[0., -1., 0.], [1., 0., 0.], [0., 0., 1.]])\n    R4z_2 = np.array([[-1., 0., 0.], [0., -1., 0.], [0., 0., 1.]])\n    R4z_3 = np.array([[0., 1., 0.], [-1., 0., 0.], [0., 0., 1.]])\n\n    test_cases = [\n        # Test case 1: Simple identity\n        {\n            \"seed\": np.array([0.1, 0.2, 0.3]),\n            \"operations\": [\n                (I, np.array([0., 0., 0.])),\n            ]\n        },\n        # Test case 2: Twofold rotation about the z-axis\n        {\n            \"seed\": np.array([0.3, 0.1, 0.0]),\n            \"operations\": [\n                (I, np.array([0., 0., 0.])),\n                (R2z, np.array([0., 0., 0.])),\n            ]\n        },\n        # Test case 3: Twofold screw axis along the z-direction\n        {\n            \"seed\": np.array([0.25, 0.25, 0.25]),\n            \"operations\": [\n                (I, np.array([0., 0., 0.])),\n                (R2z, np.array([0., 0., 0.5])),\n            ]\n        },\n        # Test case 4: Fourfold rotations about the z-axis on a high-symmetry point\n        {\n            \"seed\": np.array([0., 0., 0.]),\n            \"operations\": [\n                (R4z_0, np.array([0., 0., 0.])),\n                (R4z_1, np.array([0., 0., 0.])),\n                (R4z_2, np.array([0., 0., 0.])),\n                (R4z_3, np.array([0., 0., 0.])),\n            ]\n        },\n        # Test case 5: Redundancy due to a pure lattice translation\n        {\n            \"seed\": np.array([0.4, 0.6, 0.7]),\n            \"operations\": [\n                (I, np.array([0., 0., 0.])),\n                (I, np.array([1., 0., 0.])),\n            ]\n        }\n    ]\n\n    results = []\n    \n    def are_equivalent(p1, p2):\n        \"\"\"\n        Check if two reduced fractional positions are equivalent modulo\n        lattice translations within the given tolerance.\n        \"\"\"\n        diff = np.abs(p1 - p2)\n        periodic_dist = np.minimum(diff, 1.0 - diff)\n        return np.all(periodic_dist  epsilon)\n\n    for case in test_cases:\n        seed = case[\"seed\"]\n        operations = case[\"operations\"]\n        distinct_images = []\n\n        for R, t in operations:\n            # Apply Seitz operation: r' = R*r + t\n            new_pos = R @ seed + t\n            \n            # Reduce to the unit cell [0, 1)\n            reduced_pos = np.mod(new_pos, 1.0)\n            \n            # Handle boundary cases where a value is numerically 1.0\n            reduced_pos[np.isclose(reduced_pos, 1.0, atol=epsilon, rtol=0)] = 0.0\n\n            # Check if this position is a new distinct image\n            is_new = True\n            for existing_pos in distinct_images:\n                if are_equivalent(reduced_pos, existing_pos):\n                    is_new = False\n                    break\n            \n            if is_new:\n                distinct_images.append(reduced_pos)\n\n        results.append(len(distinct_images))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2864749"}]}