{"hands_on_practices": [{"introduction": "推导出能带色散关系是紧束缚模型分析的第一步，但模型的真正价值在于从能带中提取可观测量。本练习将从最基础的一维单原子链出发，指导你计算能带底部电子的有效质量 [@problem_id:2866069]。这个计算将能带的曲率与电子在晶体中对外场的响应联系起来，是连接理论模型与半导体物理实验的关键一步。", "problem": "考虑一个一维布拉菲晶格，其晶格常数为 $a$，每个格点（位置为 $x_{n}=n a$，其中 $n\\in\\mathbb{Z}$）上有一个单一的正交归一轨道 $\\{|n\\rangle\\}$。在紧束缚近似（TBA）下，单电子哈密顿量包括在位能和仅限于最近邻的跃迁，其跃迁振幅为实数 $t0$：\n$$\n\\hat{H}=\\varepsilon_{0}\\sum_{n}|n\\rangle\\langle n| - t \\sum_{n}\\Big(|n\\rangle\\langle n+1|+|n+1\\rangle\\langle n|\\Big).\n$$\n使用布洛赫定理和能带极值点处有效质量的半经典定义，推导能带色散关系 $E(k)$，然后确定能带底部的有效质量 $m^{\\ast}$。请仅用 $t$、$a$ 和基本常数表示 $m^{\\ast}$ 的最终结果。提供一个单一的闭合解析表达式；不要在最终表达式后附加单位。如果代入数值，有效质量应以千克为单位表示。无需四舍五入。", "solution": "所给问题是基础固体理论中的一个标准练习题，需进行验证。\n\n**问题验证：**\n\n*   **已知条件：** 一个一维布拉菲晶格，晶格常数为 $a$。格点位置为 $x_n = na$，其中 $n \\in \\mathbb{Z}$。每个格点上存在一个单一的正交归一轨道 $\\{|n\\rangle\\}$。紧束缚近似（TBA）下的哈密顿量为 $\\hat{H}=\\varepsilon_{0}\\sum_{n}|n\\rangle\\langle n| - t \\sum_{n}\\Big(|n\\rangle\\langle n+1|+|n+1\\rangle\\langle n|\\Big)$，其中在位能为 $\\varepsilon_0$，最近邻跃迁振幅为实数且大于零 $t0$。\n*   **任务：** 推导能带色散关系 $E(k)$ 和能带底部的有效质量 $m^*$。\n*   **验证结论：** 该问题是**有效的**。这是一个有科学依据、提法恰当且客观的问题，是紧束缚近似主题下的一个典型范例。它没有不一致、歧义或事实错误。所有必要的信息都已提供。\n\n**求解过程：**\n\n求解过程分两个阶段：首先，推导能量色散关系 $E(k)$，然后计算能带最小值处的有效质量 $m^*$。\n\n**1. 推导能带色散 $E(k)$**\n\n根据布洛赫定理，周期性势场中的本征态可以写成布洛赫态。对于一维晶格，布洛赫态 $|\\psi_k\\rangle$ 是局域原子轨道 $|n\\rangle$ 的叠加，并由一个依赖于晶体动量 $k$ 的相位因子加权：\n$$\n|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikx_n} |n\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} |n\\rangle\n$$\n其中 $N$ 是晶格中的格点数，$n$ 是标记格点位置的整数，$k$ 是波矢。\n\n能量本征值 $E(k)$ 可通过求解定态薛定谔方程得到：\n$$\n\\hat{H}|\\psi_k\\rangle = E(k)|\\psi_k\\rangle\n$$\n我们将给定的哈密顿量 $\\hat{H}$ 作用于布洛赫态 $|\\psi_k\\rangle$。在计算上，先确定 $\\hat{H}$ 对单个局域轨道 $|n\\rangle$ 的作用会更简单：\n$$\n\\hat{H}|n\\rangle = \\left(\\varepsilon_{0}\\sum_{m}|m\\rangle\\langle m| - t \\sum_{m}\\Big(|m\\rangle\\langle m+1|+|m+1\\rangle\\langle m|\\Big)\\right)|n\\rangle\n$$\n利用基的正交归一性 $\\langle m|n\\rangle = \\delta_{mn}$，我们得到：\n$$\n\\hat{H}|n\\rangle = \\varepsilon_0|n\\rangle - t(|n-1\\rangle + |n+1\\rangle)\n$$\n现在，我们将 $\\hat{H}$ 作用于完整的布洛赫态：\n$$\n\\hat{H}|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} \\hat{H}|n\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} \\Big(\\varepsilon_0|n\\rangle - t|n-1\\rangle - t|n+1\\rangle\\Big)\n$$\n为了找到本征值 $E(k)$，我们可以将其投影到其中一个基矢上，例如 $\\langle m|$：\n$$\n\\langle m|\\hat{H}|\\psi_k\\rangle = E(k)\\langle m|\\psi_k\\rangle\n$$\n等式右边是：\n$$\nE(k)\\langle m|\\psi_k\\rangle = E(k) \\left\\langle m \\left| \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} |n\\rangle \\right. \\right\\rangle = \\frac{E(k)}{\\sqrt{N}} \\sum_{n} e^{ikan} \\delta_{mn} = \\frac{E(k)}{\\sqrt{N}}e^{ikam}\n$$\n等式左边是：\n$$\n\\langle m|\\hat{H}|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} \\langle m| \\Big(\\varepsilon_0|n\\rangle - t|n-1\\rangle - t|n+1\\rangle\\Big) = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} (\\varepsilon_0 \\delta_{mn} - t \\delta_{m,n+1} - t \\delta_{m,n-1})\n$$\n仅当 $n=m$、$n=m-1$ 和 $n=m+1$ 时，求和项才有非零贡献。计算这些项：\n$$\n\\langle m|\\hat{H}|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\Big( e^{ikam}\\varepsilon_0 - e^{ik a (m+1)}t - e^{ik a (m-1)}t \\Big) = \\frac{e^{ikam}}{\\sqrt{N}} \\Big( \\varepsilon_0 - t(e^{ika} + e^{-ika}) \\Big)\n$$\n令等式左右两边相等，得到：\n$$\n\\frac{E(k)}{\\sqrt{N}}e^{ikam} = \\frac{e^{ikam}}{\\sqrt{N}} \\Big( \\varepsilon_0 - t(e^{ika} + e^{-ika}) \\Big)\n$$\n这就给出了能量色散关系。使用欧拉恒等式 $2\\cos(x) = e^{ix} + e^{-ix}$：\n$$\nE(k) = \\varepsilon_0 - 2t\\cos(ka)\n$$\n\n**2. 计算有效质量 $m^*$**\n\n在能带极值点附近的半经典有效质量 $m^*$ 由能带的曲率定义。在一维情况下，其公式为：\n$$\nm^* = \\hbar^2 \\left( \\frac{d^2E}{dk^2} \\right)^{-1}\n$$\n其中 $\\hbar$ 是约化普朗克常数。\n\n首先，我们必须确定能带底的位置。当 $-2t\\cos(ka)$ 项取其最小值时，能量 $E(k)$ 达到最小值。由于 $t>0$，这发生在 $\\cos(ka)$ 取最大值时，即 $\\cos(ka)=1$。在第一布里渊区 $k \\in [-\\pi/a, \\pi/a]$ 内，该条件在布里渊区中心 $k=0$ 处满足。该点对应于能带的底部。\n\n接下来，我们计算 $E(k)$ 对 $k$ 的二阶导数。一阶导数为：\n$$\n\\frac{dE}{dk} = \\frac{d}{dk} \\Big( \\varepsilon_0 - 2t\\cos(ka) \\Big) = -2t(-\\sin(ka) \\cdot a) = 2ta \\sin(ka)\n$$\n二阶导数为：\n$$\n\\frac{d^2E}{dk^2} = \\frac{d}{dk} \\Big( 2ta \\sin(ka) \\Big) = 2ta (\\cos(ka) \\cdot a) = 2ta^2 \\cos(ka)\n$$\n我们在能带底 $k=0$ 处计算这个二阶导数：\n$$\n\\left. \\frac{d^2E}{dk^2} \\right|_{k=0} = 2ta^2 \\cos(0) = 2ta^2\n$$\n由于这个量是正的（因为 $t>0$ 且 $a>0$），它正确地描述了一个能带最小值。\n\n最后，我们将此结果代入有效质量的公式中：\n$$\nm^* = \\hbar^2 \\left( 2ta^2 \\right)^{-1}\n$$\n这就得出了能带底有效质量的最终表达式。\n$$\nm^* = \\frac{\\hbar^2}{2ta^2}\n$$\n该表达式用跃迁参数 $t$、晶格常数 $a$ 和基本常数 $\\hbar$ 表示，符合题目要求。", "answer": "$$\n\\boxed{\\frac{\\hbar^2}{2ta^2}}\n$$", "id": "2866069"}, {"introduction": "简单的单原子链模型通常得到没有带隙的连续能带，但这无法描述绝缘体或半导体。通过引入一个交错的在位势，我们可以在保持晶格周期性的同时，改变元胞内部的对称性，从而在能带中打开一个带隙 [@problem_id:1822021]。这个练习是理解能隙工程（band gap engineering）和更高级的拓扑模型（如Su-Schrieffer-Heeger模型）的一个重要入门实践。", "problem": "考虑一个由间距为 $a$ 的全同原子组成的一维链。该链的电子性质由一个紧束缚模型描述。电子的状态被描述为原子轨道 $|n\\rangle$ 的线性组合，其中 $|n\\rangle$ 是以格点 $n$ 上的原子为中心的原子轨道。在此基矢下，系统的哈密顿量 $H$ 具有以下矩阵元：\n\n- 格点 $n$ 处的在位能由一个交错势给出：$\\langle n|H|n \\rangle = \\epsilon_n = \\epsilon_0 + (-1)^n \\Delta$，其中 $\\epsilon_0$ 和 $\\Delta$ 是实数能量常数，且 $\\Delta  0$。\n- 最近邻格点 $n$ 和 $n \\pm 1$ 之间的跃迁能为 $\\langle n|H|n \\pm 1 \\rangle = -t$，其中 $t$ 是一个实数正常数。\n- 哈密顿量的所有其他矩阵元均为零。\n\n这种交错势在电子能谱中产生一个带隙。确定直接带隙的大小，其定义为在所有波矢上，上能带和下能带之间的最小能量差。将您的答案表示为关于给定参数的符号表达式。", "solution": "由于在位能 $\\epsilon_n = \\epsilon_0 + (-1)^n \\Delta$ 交错，晶格的周期性变为 $2a$。我们选择一个包含A格点（偶数位，在位能 $\\epsilon_A = \\epsilon_0 + \\Delta$）和B格点（奇数位，在位能 $\\epsilon_B = \\epsilon_0 - \\Delta$）的原胞。\n\n在倒空间中，哈密顿量是一个 $2 \\times 2$ 矩阵。对角元是在位能 $\\epsilon_A$ 和 $\\epsilon_B$。非对角元 $H_{AB}(k)$ 连接A格点和其最近邻的B格点，通过傅里叶变换得到 $H_{AB}(k) = -t(e^{ika} + e^{-ika}) = -2t\\cos(ka)$。因此，布洛赫哈密顿量为：\n$$\nH(k) = \\begin{pmatrix}\n\\epsilon_{0}+\\Delta  -2t\\cos(ka) \\\\\n-2t\\cos(ka)  \\epsilon_{0}-\\Delta\n\\end{pmatrix}\n$$\n求解其本征值，得到能带色散关系：\n$$\nE_{\\pm}(k) = \\epsilon_0 \\pm \\sqrt{\\Delta^2 + 4t^2\\cos^2(ka)}\n$$\n在波矢 $k$ 处的直接带隙为：\n$$\nE_{+}(k)-E_{-}(k)=2\\sqrt{\\Delta^{2}+4t^{2}\\cos^{2}(ka)}.\n$$\n为了求得直接带隙的大小，需要对此表达式求最小值。当 $\\cos(ka)=0$ 时，即在布里渊区边界 $k=\\pm\\frac{\\pi}{2a}$ 时，出现最小值。最小值为：\n$$\nE_{gap} = 2\\sqrt{\\Delta^{2}} = 2\\Delta\n$$\n其中我们使用了 $\\Delta > 0$。因此，直接带隙的大小为 $2\\Delta$。", "answer": "$$\\boxed{2\\Delta}$$", "id": "1822021"}, {"introduction": "虽然解析推导对于理解物理图像至关重要，但在处理复杂材料或多轨道模型时，数值计算是不可或缺的工具。本练习旨在搭建理论与计算之间的桥梁，要求你编写代码来构建和对角化布洛赫哈密顿量，并与你推导的一维和二维晶格的解析解进行比对 [@problem_id:2866058]。完成这项练习不仅能巩固你对理论的理解，还能为你提供一个可靠的计算工具，以应对未来更复杂的研究课题。", "problem": "要求您通过复现一维链和二维正方晶格（每个晶格点位一个轨道和最近邻跃迁）的解析能带色散，并通过量化数值误差范数，来验证一个通用紧束缚（TB）近似的实现。此验证必须是自洽的，并基于第一性原理推导，不得使用问题陈述中预先引用的色散公式。\n\n在您的推导中应使用的基本原理：\n- 晶体晶格的周期性与Bloch定理：周期性势场中的电子本征态可以由布里渊区（BZ）中的晶体动量 $k$ 来标记。\n- 紧束缚（TB）近似：从以晶格点位为中心的正交归一、局域的类原子轨道出发，保留在位能和有限的一组点位间跃迁积分，并利用晶格平移对称性将哈密顿量写在倒易空间中。\n- 对于数值比较，当晶格常数为 $a$ 时，周期性边界条件意味着一维的第一布里渊区为 $[-\\pi/a, \\pi/a]$，二维为 $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$。\n\n任务：\n1. 从每个点位单轨道且仅有最近邻跃迁的TB哈密顿量出发，在以下晶格上：\n   - 一维布拉维晶格，\n   - 二维正方布拉维晶格，\n   使用Bloch定理和晶格和的傅里叶表示，推导能带能量 $E(k)$ 和 $E(k_x, k_y)$ 的解析表达式。您的推导必须从TB哈密顿量和Bloch态的基本定义开始，并证明每一步的合理性，以获得封闭形式的解析表达式。\n\n2. 实现一个程序，该程序能够：\n   - 利用晶格平移对称性，从在位能和最近邻跃迁矢量构建Bloch哈密顿量 $H(k)$（或 $H(k_x, k_y)$）。\n   - 通过对覆盖第一布里渊区（BZ）的均匀网格上的每个 $k$ 点对角化 $H(k)$ 来计算数值能带能量。\n   - 独立地使用您在任务1中推导的表达式计算解析能带能量（不要硬编码问题陈述中的任何公式，因为没有给出任何公式；您必须编码您自己推导的表达式）。\n   - 计算在采样的布里渊区上的两种绝对误差范数：\n     - 均匀范数（也称为 $L_\\infty$ 范数）：$\\max |E_{\\text{num}} - E_{\\text{ana}}|$。\n     - 均方根（RMS）范数：$\\sqrt{\\langle (E_{\\text{num}} - E_{\\text{ana}})^2 \\rangle}$，其中平均值是在采样的布里渊区网格点上计算的。\n\n3. 使用以下参数集测试套件来检验您实现的不同方面：\n   - 测试用例1（一维链，一般情况）：晶格常数 $a = 0.246 \\times 10^{-9}\\,\\text{m}$，在位能 $\\varepsilon_0 = 0.3\\,\\text{eV}$，最近邻跃迁 $t = -2.7\\,\\text{eV}$，在闭区间 $[-\\pi/a, \\pi/a]$ 上均匀间隔的 $k$ 点数量 $N_k = 257$。\n   - 测试用例2（一维链，边界情况）：晶格常数 $a = 0.5 \\times 10^{-9}\\,\\text{m}$，在位能 $\\varepsilon_0 = 1.0\\,\\text{eV}$，最近邻跃迁 $t = 0.0\\,\\text{eV}$，$k$ 点数量 $N_k = 1$（解释为仅在 $k = 0$ 处采样）。\n   - 测试用例3（二维正方晶格，一般情况）：晶格常数 $a = 0.35 \\times 10^{-9}\\,\\text{m}$，在位能 $\\varepsilon_0 = -0.2\\,\\text{eV}$，最近邻跃迁 $t = 1.1\\,\\text{eV}$，在闭合矩形 $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$ 上均匀间隔的网格点数量 $N_{k_x} = 129$ 和 $N_{k_y} = 127$。\n   - 测试用例4（二维正方晶格，对称性与符号检查）：晶格常数 $a = 0.3 \\times 10^{-9}\\,\\text{m}$，在位能 $\\varepsilon_0 = 0.0\\,\\text{eV}$，最近邻跃迁 $t = -3.33\\,\\text{eV}$，在闭合矩形 $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$ 上的网格点数量 $N_{k_x} = 31$ 和 $N_{k_y} = 31$。\n\n角度单位和物理单位：\n- 晶体动量必须以弧度处理，即标量积 $k \\cdot R$ 和 $k_x a$，$k_y a$ 均以弧度为单位。\n- 晶格常数 $a$ 必须以米为单位处理。\n- 能量必须以电子伏特（eV）表示。\n- 数值误差范数必须以电子伏特（eV）报告。\n\n数值协议：\n- 对于一维情况下的 $N_k = 1$，仅使用 $k = 0$。\n- 对于一维情况下的 $N_k \\ge 2$，在 $[-\\pi/a, \\pi/a]$ 上均匀采样 $k$，包括两个端点。\n- 对于二维情况，如果 $N_{k_x}, N_{k_y} \\ge 2$，则在每个方向上对笛卡尔积网格 $k_x \\in [-\\pi/a, \\pi/a]$, $k_y \\in [-\\pi/a, \\pi/a]$ 进行采样，包括两个端点；如果 $N_{k_x} = 1$ 或 $N_{k_y} = 1$，则在该方向上使用单点 $0$。\n- 在全部采样点上计算两个范数。将每个范数四舍五入到小数点后12位。\n\n要求的最终输出格式：\n- 对于每个测试用例，生成一个包含两个浮点数的列表 $[L_\\infty, L_2]$，单位为电子伏特，每个数都四舍五入到小数点后12位。\n- 将四个测试用例的结果汇总到一个Python风格的列表中，并仅作为一行打印，除了有效的逗号分隔外，不插入任何多余的空格。例如：$[[x_{11},x_{12}],[x_{21},x_{22}],[x_{31},x_{32}],[x_{41},x_{42}]]$。\n\n您的程序必须是一个完整、可运行的程序，无需用户输入即可执行所有计算，并严格按照上述格式打印一行输出。", "solution": "该问题被认定是有效的。这是一个来自基础固态物理学的、提法恰当且有科学依据的任务，要求推导和数值验证简单晶格的紧束缚能带结构。所有必需的参数均已提供，任务明确无歧义。\n\n解决方案分两个阶段进行。首先，从第一性原理出发，为一维（1D）链和二维（2D）正方晶格推导解析色散关系。其次，利用这些推导来构建一个自洽的数值验证程序。\n\n**解析能带色散的推导**\n\n紧束缚模型始于一组以每个晶格点位 $\\mathbf{R}$ 为中心的局域类原子轨道 $|\\phi_{\\mathbf{R}}\\rangle$ 作为基矢。这些轨道被假定构成一个正交归一集合：$\\langle \\phi_{\\mathbf{R}} | \\phi_{\\mathbf{R}'} \\rangle = \\delta_{\\mathbf{R}\\mathbf{R}'}$。哈密顿量 $H$ 由其在该基矢下的矩阵元定义。对于每个点位单个（1）轨道、在位能为 $\\varepsilon_0$、且仅在最近邻之间存在跃迁积分 $t$ 的模型，矩阵元为：\n$$\n\\langle \\phi_{\\mathbf{R}'} | H | \\phi_{\\mathbf{R}} \\rangle =\n\\begin{cases}\n\\varepsilon_0  \\text{if } \\mathbf{R}' = \\mathbf{R} \\\\\nt  \\text{if } \\mathbf{R}' \\text{ and } \\mathbf{R} \\text{ are nearest neighbors} \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n\n根据Bloch定理，周期性系统的本征态可以写成Bloch波的形式，它们是局域轨道的叠加，由来自第一布里渊区的晶体动量矢量 $\\mathbf{k}$ 加以区分。对于一个有 $N$ 个点位的晶格，Bloch态为：\n$$\n|\\psi_{\\mathbf{k}}\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}} e^{i\\mathbf{k} \\cdot \\mathbf{R}} |\\phi_{\\mathbf{R}}\\rangle\n$$\n由于每个点位有1个轨道，对于给定的 $\\mathbf{k}$，本征态的基矢是一维的。因此，Bloch哈密顿量 $H(\\mathbf{k})$ 是一个 $1 \\times 1$ 矩阵，其唯一的元素就是能量本征值 $E(\\mathbf{k})$。这通过计算哈密顿量在Bloch态中的期望值来得到：\n$$\nE(\\mathbf{k}) = \\langle \\psi_{\\mathbf{k}} | H | \\psi_{\\mathbf{k}} \\rangle = \\frac{1}{N} \\sum_{\\mathbf{R}, \\mathbf{R}'} e^{-i\\mathbf{k} \\cdot \\mathbf{R}'} e^{i\\mathbf{k} \\cdot \\mathbf{R}} \\langle \\phi_{\\mathbf{R}'} | H | \\phi_{\\mathbf{R}} \\rangle\n$$\n利用晶格的平移不变性，我们可以不失一般性地将一个求和指标（比如 $\\mathbf{R}'$）设为原点，然后对位移矢量 $\\boldsymbol{\\delta} = \\mathbf{R} - \\mathbf{R}'$ 进行求和。这将表达式简化为对邻居的求和：\n$$\nE(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} H_{\\mathbf{0}, \\boldsymbol{\\delta}}\n$$\n其中 $H_{\\mathbf{0}, \\boldsymbol{\\delta}} = \\langle \\phi_{\\mathbf{0}} | H | \\phi_{\\boldsymbol{\\delta}} \\rangle$ 是连接原点点位与位于 $\\boldsymbol{\\delta}$ 处点位的哈密顿量矩阵元。该表达式是实空间哈密顿量矩阵元的离散傅里叶变换，代表了构建Bloch哈密顿量的通用方法。\n\n**一维（1D）链**\n\n对于晶格常数为 $a$ 的一维链，晶格点位位于整数 $n$ 的位置 $R_n = na$。晶体动量是一个标量 $k$。位于 $na$ 的点位的最近邻位于 $(n \\pm 1)a$。因此，从原点出发的位移矢量 $\\boldsymbol{\\delta}$ 为 $\\delta = 0$（点位自身）、$\\delta = +a$ 和 $\\delta = -a$。\n应用 $E(k)$ 的通用公式：\n- 对于 $\\delta = 0$：项为 $e^{ik \\cdot 0} H_{0,0} = 1 \\cdot \\varepsilon_0 = \\varepsilon_0$。\n- 对于 $\\delta = +a$：项为 $e^{ik a} H_{0,a} = e^{ika} t$。\n- 对于 $\\delta = -a$：项为 $e^{ik (-a)} H_{0,-a} = e^{-ika} t$。\n\n将这些贡献相加，得到一维链的能量色散关系：\n$$\nE(k) = \\varepsilon_0 + t(e^{ika} + e^{-ika})\n$$\n使用欧拉公式 $e^{ix} + e^{-ix} = 2\\cos(x)$，我们得到最终的解析表达式：\n$$\nE(k) = \\varepsilon_0 + 2t \\cos(ka)\n$$\n\n**二维（2D）正方晶格**\n\n对于晶格常数为 $a$ 的二维正方晶格，点位位于位置 $\\mathbf{R} = (n_x a, n_y a)$。晶体动量是一个矢量 $\\mathbf{k} = (k_x, k_y)$。一个点位的最近邻位于位移 $\\boldsymbol{\\delta} \\in \\{ (a, 0), (-a, 0), (0, a), (0, -a) \\}$ 处。\n我们再次应用对位移矢量 $\\boldsymbol{\\delta}$ 的求和：\n- 对于 $\\boldsymbol{\\delta} = (0, 0)$：项为 $e^{i\\mathbf{k} \\cdot \\mathbf{0}} H_{\\mathbf{0},\\mathbf{0}} = 1 \\cdot \\varepsilon_0 = \\varepsilon_0$。\n- 对于 $\\boldsymbol{\\delta} = (a, 0)$：项为 $e^{i\\mathbf{k} \\cdot (a,0)} H_{\\mathbf{0},(a,0)} = e^{ik_xa} t$。\n- 对于 $\\boldsymbol{\\delta} = (-a, 0)$：项为 $e^{i\\mathbf{k} \\cdot (-a,0)} H_{\\mathbf{0},(-a,0)} = e^{-ik_xa} t$。\n- 对于 $\\boldsymbol{\\delta} = (0, a)$：项为 $e^{i\\mathbf{k} \\cdot (0,a)} H_{\\mathbf{0},(0,a)} = e^{ik_ya} t$。\n- 对于 $\\boldsymbol{\\delta} = (0, -a)$：项为 $e^{i\\mathbf{k} \\cdot (0,-a)} H_{\\mathbf{0},(0,-a)} = e^{-ik_ya} t$。\n\n将所有贡献相加：\n$$\nE(\\mathbf{k}) = \\varepsilon_0 + t(e^{ik_xa} + e^{-ik_xa}) + t(e^{ik_ya} + e^{-ik_ya})\n$$\n对 $x$ 和 $y$ 分量都使用欧拉公式，我们得到二维正方晶格的最终解析表达式：\n$$\nE(k_x, k_y) = \\varepsilon_0 + 2t (\\cos(k_x a) + \\cos(k_y a))\n$$\n\n**数值验证与误差分析**\n\n问题要求一个程序来执行自洽验证。这涉及在第一布里渊区内的 $\\mathbf{k}$ 点网格上进行两种能量色散的计算。\n1.  **数值能量 ($E_{\\text{num}}$)**：通过直接实现离散傅里叶变换 $E(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} H_{\\mathbf{0}, \\boldsymbol{\\delta}}$ 来计算。对于单轨道情况，此和给出了 $1 \\times 1$ 的Bloch哈密顿量，它本身就是能量。在代码中，这对应于对复指数项求和。\n2.  **解析能量 ($E_{\\text{ana}}$)**：使用上面推导出的、涉及余弦函数的简化实值表达式来计算。\n\n理论上，这两种方法之间的差异应为零。在实践中，由于有限精度的浮点运算，可能会存在机器精度量级的微小差异。此计算的目的是验证这两个计算路径在该精度范围内产生相同的结果，从而用特定的解析解来验证通用数值方案的实现。\n\n在 $M$ 个采样的 $\\mathbf{k}$ 点集合上计算两种误差范数：\n- 均匀范数或 $L_\\infty$ 范数，用于衡量最大绝对偏差：\n$$\nL_\\infty = \\max_{i=1 \\dots M} |E_{\\text{num}}(\\mathbf{k}_i) - E_{\\text{ana}}(\\mathbf{k}_i)|\n$$\n- 均方根（RMS）范数或 $L_2$ 范数，用于衡量平均偏差：\n$$\nL_2 = \\sqrt{\\frac{1}{M} \\sum_{i=1}^{M} (E_{\\text{num}}(\\mathbf{k}_i) - E_{\\text{ana}}(\\mathbf{k}_i))^2}\n$$\n鉴于两种能量表达式在数学上是等价的，两种范数都预期接近于0。要求四舍五入到小数点后12位，对于所有测试用例，结果应恰好为0.0。这证实了物理实现和推导的正确性。所提供的代码为指定的测试用例实现了此验证过程。", "answer": "```python\nimport numpy as np\n\ndef calculate_norms(case):\n    \"\"\"\n    Calculates numerical and analytical energies and their error norms for a given test case.\n    \"\"\"\n    dim, a, eps0, t, Nk_x, Nk_y = case['dim'], case['a'], case['eps0'], case['t'], case['Nk_x'], case.get('Nk_y')\n\n    if dim == 1:\n        # Generate 1D k-point grid\n        if Nk_x == 1:\n            k_vals = np.array([0.0])\n        else:\n            k_vals = np.linspace(-np.pi / a, np.pi / a, Nk_x)\n        \n        # \"Numerical\" E_num from summing complex exponentials (Fourier transform of H_ij)\n        # For a single orbital model, the 1x1 Bloch Hamiltonian is the energy.\n        # H(k) = sum_{delta} exp(i*k*delta) * H_{0,delta}\n        # H_{0,0} = eps0, H_{0,a} = t, H_{0,-a} = t\n        H_k = eps0 + t * (np.exp(1j * k_vals * a) + np.exp(-1j * k_vals * a))\n        # Energy must be real since Hamiltonian is Hermitian.\n        E_num = np.real(H_k)\n\n        # \"Analytical\" E_ana from the derived simplified formula\n        E_ana = eps0 + 2 * t * np.cos(k_vals * a)\n        \n        diff = E_num - E_ana\n        \n    elif dim == 2:\n        # Generate 2D k-point grid\n        if Nk_x == 1:\n            kx_vals = np.array([0.0])\n        else:\n            kx_vals = np.linspace(-np.pi / a, np.pi / a, Nk_x)\n        \n        if Nk_y == 1:\n            ky_vals = np.array([0.0])\n        else:\n            ky_vals = np.linspace(-np.pi / a, np.pi / a, Nk_y)\n        \n        kx_grid, ky_grid = np.meshgrid(kx_vals, ky_vals)\n        \n        # \"Numerical\" E_num from summing complex exponentials\n        # H(k) = eps0 + t*exp(i*kx*a) + t*exp(-i*kx*a) + t*exp(i*ky*a) + t*exp(-i*ky*a)\n        term_x = t * (np.exp(1j * kx_grid * a) + np.exp(-1j * kx_grid * a))\n        term_y = t * (np.exp(1j * ky_grid * a) + np.exp(-1j * ky_grid * a))\n        H_k = eps0 + term_x + term_y\n        E_num = np.real(H_k)\n\n        # \"Analytical\" E_ana from the derived simplified formula\n        E_ana = eps0 + 2 * t * (np.cos(kx_grid * a) + np.cos(ky_grid * a))\n        \n        diff = E_num - E_ana\n\n    else:\n        raise ValueError(\"Dimension must be 1 or 2.\")\n        \n    # Calculate norms\n    l_inf_norm = np.max(np.abs(diff))\n    rms_norm = np.sqrt(np.mean(diff**2))\n    \n    # Round to 12 decimal places as required\n    return [round(l_inf_norm, 12), round(rms_norm, 12)]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Test Case 1 (1D general)\n        {'dim': 1, 'a': 0.246e-9, 'eps0': 0.3, 't': -2.7, 'Nk_x': 257},\n        # Test Case 2 (1D boundary)\n        {'dim': 1, 'a': 0.5e-9, 'eps0': 1.0, 't': 0.0, 'Nk_x': 1},\n        # Test Case 3 (2D general)\n        {'dim': 2, 'a': 0.35e-9, 'eps0': -0.2, 't': 1.1, 'Nk_x': 129, 'Nk_y': 127},\n        # Test Case 4 (2D symmetry/sign check)\n        {'dim': 2, 'a': 0.3e-9, 'eps0': 0.0, 't': -3.33, 'Nk_x': 31, 'Nk_y': 31},\n    ]\n\n    results = []\n    for case in test_cases:\n        norms = calculate_norms(case)\n        results.append(norms)\n\n    # Format the final output string to be exactly as requested, with no extra spaces.\n    # The str() representation of a list of lists has spaces after commas.\n    # str(results) -> '[[0.0, 0.0], [0.0, 0.0], ...]'\n    # We remove these spaces for exact formatting compliance.\n    output_str = str(results).replace(' ', '')\n    print(output_str)\n\nsolve()\n```", "id": "2866058"}]}