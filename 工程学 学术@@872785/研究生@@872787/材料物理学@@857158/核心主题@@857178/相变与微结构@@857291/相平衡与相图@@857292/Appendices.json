{"hands_on_practices": [{"introduction": "相图的拓扑结构并非随意的，而是受到热力学基本定律的严格约束。本练习将通过从第一性原理推导吉布斯相律，来探索这些约束。通过计算一个二元体系中三相共存时的自由度 [@problem_id:2847130]，您将掌握为何某些相平衡（如共晶或共析反应）仅在特定的不变温度下发生，从而深刻理解相图的几何特征。", "problem": "在固定压力 $p$ 的等压条件下，研究一个具有 $C=2$ 个组分的封闭、宏观均匀的二元体系。在某一温度下，有 $P=3$ 个不同的相处于热力学平衡共存状态。严格地从化学势 $\\mu_{i}^{\\phi}$ 作为偏摩尔吉布斯自由能的定义、多相平衡的条件，以及在固定 $T$ 和 $p$ 下各相中独立组成变量的计算出发，推导出一个用于完全确定一个普遍的 $C$ 组分、$P$ 相体系状态所需的独立强度变量数量的表达式。然后，将此表达式应用于固定压力 $p$ 下 $C=2$、$P=3$ 的给定情况，并计算自由度的数值。\n\n此外，解释在固定压力 $p$ 下，三相点无穷小邻域内温度-组成（$T$–$x$）相图的局部拓扑结构：说明在固定 $p$ 的 $T$–$x$ 截面上，三相轨迹是呈现为点、线还是面，并说明有多少条两相边界从其延伸出来，以及这对任意接近恒变温度时的连接线和组成约束意味着什么。您最终报告的答案必须是计算出的自由度，以一个无单位的实数形式给出。无需四舍五入。", "solution": "本题要求推导吉布斯相律并将其应用于一个特定的二元体系，然后解释三相平衡点附近的相图拓扑结构。我们从化学热力学的第一性原理出发，严谨地解决这个问题。\n\n首先，我们推导处于热力学平衡的体系的自由度 $F$ 的一般表达式。自由度代表了在不改变存在的相数的情况下，可以同时改变的独立强度变量的数量。\n\n考虑一个包含 $C$ 个化学独立组分分布在 $P$ 个不同相中的非均相体系。每个相的状态由其温度 $T$、压力 $p$ 和其组分的摩尔分数定义。\n\n描述整个体系所需的总强度变量数确定如下：\n1.  温度 $T$ 和压力 $p$ 是体系范围的变量，对于处于热平衡和力学平衡的所有相都是共同的。这构成了 $2$ 个变量。\n2.  在每个相内部，组成由组分的摩尔分数 $x_{i}^{\\phi}$ 指定，其中 $i$ 表示组分（$1, 2, ..., C$），$\\phi$ 表示相（$1, 2, ..., P$）。对于每个相，摩尔分数之和必须为1：$\\sum_{i=1}^{C} x_{i}^{\\phi} = 1$。因此，对于 $P$ 个相中的每一个，我们只需要指定 $C-1$ 个摩尔分数就能完全定义其组成。\n3.  因此，所有 $P$ 个相的独立组成变量总数为 $P(C-1)$。\n\n综合这些，可能需要指定的强度变量总数为 $V = P(C-1) + 2$。\n\n接下来，我们考虑热力学平衡条件所施加的约束。要使多相平衡共存，每个组分 $i$ 的化学势 $\\mu_{i}^{\\phi}$ 在每个相 $\\phi$ 中都必须相等。化学势定义为偏摩尔吉布斯自由能，即 $\\mu_{i}^{\\phi} = \\left(\\frac{\\partial G^{\\phi}}{\\partial n_{i}^{\\phi}}\\right)_{T, p, n_{j \\neq i}}$。\n\n平衡条件为：\n$$\\mu_{1}^{1} = \\mu_{1}^{2} = \\dots = \\mu_{1}^{P}$$\n$$\\mu_{2}^{1} = \\mu_{2}^{2} = \\dots = \\mu_{2}^{P}$$\n$$\\vdots$$\n$$\\mu_{C}^{1} = \\mu_{C}^{2} = \\dots = \\mu_{C}^{P}$$\n\n对于每个组分 $i$，有 $P-1$ 个独立方程关联其在 $P$ 个相中的化学势。由于有 $C$ 个组分，约束性平衡方程的总数为 $E = C(P-1)$。\n\n自由度 $F$ 是总变量数与约束数之差：\n$$F = V - E = [P(C-1) + 2] - [C(P-1)]$$\n$$F = PC - P + 2 - PC + C$$\n$$F = C - P + 2$$\n这就是当温度和压力均被视为潜在变量时的吉布斯相律。\n\n题目指定了一个处于等压条件下的体系，意味着压力 $p$ 保持恒定。这给体系施加了一个额外的约束，或者等效地，从考虑中移除了一个变量。由此产生的自由度，通常称为简化或凝聚相自由度 $F'$，为：\n$$F' = F - 1 = (C - P + 2) - 1$$\n$$F' = C - P + 1$$\n这个简化相律适用于凝聚体系或任何压力固定、剩余变量为温度和组成的体系。\n\n现在我们将其应用于题目给定的情况：一个在固定压力 $p$ 下处于平衡状态的、有三相（$P=3$）的二元体系（$C=2$）。应用简化相律：\n$$F' = 2 - 3 + 1$$\n$$F' = 0$$\n\n自由度数为零。\n\n对此结果的解释如下。$F'=0$ 的值表示一个恒变平衡。在恒定压力下构建的温度-组成（$T-x$）相图的背景下，这意味着这三个相只能在一个单一、唯一确定的温度，即恒变温度 $T_{inv}$下共存。此外，在此温度下，三个共存相各自的组成也是固定的。\n\n设三个相为 $\\alpha$、$\\beta$ 和 $\\gamma$。在 $T_{inv}$ 时，它们的组成固定为 $x_{\\alpha}$、$x_{\\beta}$ 和 $x_{\\gamma}$。在 $T-x$ 图上，这个恒变平衡由一条位于 $T=T_{inv}$ 的水平线段表示。这条线通常被称为三相连接线或恒变反应线。该线段的端点及其内部的一个点对应于这三个相的固定组成。在此温度下，任何总组成位于 $\\{x_{\\alpha}, x_{\\beta}, x_{\\gamma}\\}$ 的最小值和最大值之间的体系都将分解为这三相的混合物。因此，在 $T-x$ 截面上，三相平衡的轨迹是一条线。\n\n这条恒变线是相邻两相区的边界。对于任意两相处于平衡状态（例如 $\\alpha+\\beta$），简化相律给出 $F' = C - P + 1 = 2 - 2 + 1 = 1$。这意味着在恒定压力下，二元体系中的两相平衡有一个自由度；它可以在一个温度范围内存在，相的组成沿着相界线（固溶线、固相线、液相线）变化。\n\n由这三个相可以形成 $\\binom{3}{2} = \\frac{3!}{2!1!} = 3$ 种可能的两相平衡：$\\alpha+\\beta$、$\\beta+\\gamma$ 和 $\\alpha+\\gamma$。这三个两相区在恒变水平线上交汇。因此，定义这些两相区的相界线必须从恒变线上对应于组成 $x_{\\alpha}$、$x_{\\beta}$ 和 $x_{\\gamma}$ 的三个点发出。在任意接近但不等于恒变温度时，体系将处于这些两相区之一。在这些区域内，两个平衡相的组成由该温度下的水平连接线与相界线的交点给出。当温度接近 $T_{inv}$ 时，这些连接线收敛于单一的恒变三相线，相组成也趋近于其固定值 $x_{\\alpha}$、$x_{\\beta}$ 和 $x_{\\gamma}$。", "answer": "$$\\boxed{0}$$", "id": "2847130"}, {"introduction": "在掌握了相平衡的基本规则后，下一步是利用热力学模型来预测材料的行为。本练习将引导您使用经典的规整溶体模型，通过分析吉布斯混合自由能的曲率来确定相稳定性的边界 [@problem_id:2847127]。通过解析求解对称混合模型的临界点，您将亲身体验如何从一个简洁的数学表达式中，预测出材料发生相分离的临界条件，这是连接理论与材料设计实践的关键一步。", "problem": "一种由组分 $\\mathrm{A}$ 和 $\\mathrm{B}$ 构成的二元置换合金在随机晶格上表现出对称混合行为。假设在正规溶体模型下，其摩尔混合吉布斯自由能为\n$$\nG_m(x,T)=\\Omega\\,x(1-x)+R\\,T\\big[x\\ln x+(1-x)\\ln(1-x)\\big],\n$$\n其中 $x$ 是组分 $\\mathrm{A}$ 的摩尔分数，$T$ 是绝对温度，$\\Omega$ 是一个与温度无关的相互作用参数，单位为能量/摩尔，$R$ 是普适气体常数。表达式 $G_m(x,T)$ 的定义允许相差一个不影响平衡的加性常数。\n\n仅使用基于平衡热力学的原理以及根据吉布斯自由能曲率定义的相稳定性，确定此对称正规溶体的液-液相分离的临界点。具体来说：\n\n- 推导用 $G_m(x,T)$ 对 $x$ 的导数所定义的临界点条件，并用它们求出以 $\\Omega$ 和 $R$ 表示的临界成分和临界温度的闭式表达式。\n- 阐述在何种关于 $\\Omega$ 的条件下，有限温度的临界点和相分离才可能发生。\n\n将临界温度以 $\\mathrm{K}$ 为单位表示，临界成分以无量纲的摩尔分数表示。不要进行任何数值代入。以单行向量 $\\big(T_c,\\;x_c\\big)$ 的顺序提供临界温度和临界成分的最终答案。无需四舍五入。", "solution": "所述问题在科学上是合理的、良定的，并包含了获得唯一解所需的所有信息。这是材料热力学中的一个标准问题。我们应开始推导。\n\n均相二元溶体抵抗成分无穷小涨落的稳定性由摩尔混合吉布斯自由能 $G_m$ 相对于摩尔分数 $x$ 的曲率决定。如果自由能曲线是凸的，即其二阶导数为正，则溶体是稳定的。当自由能曲线出现负曲率区域时，相分离便可能发生。稳定区和不稳定区之间的边界是旋节线，其定义为二阶导数为零的条件：\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = 0\n$$\n临界点 $(x_c, T_c)$ 是这条旋节线的顶点。它代表了可以发生相分离的最高温度。在这个特定点上，曲率不仅为零，而且处于极值。这意味着吉布斯自由能对成分的三阶导数也必须为零：\n$$\n\\frac{\\partial^3 G_m}{\\partial x^3} = 0\n$$\n因此，临界点通过求解这个关于 $x$ 和 $T$ 的二元联立方程组唯一确定。\n\n给定的摩尔混合吉布斯自由能为：\n$$\nG_m(x,T) = \\Omega\\,x(1-x)+R\\,T\\big[x\\ln x+(1-x)\\ln(1-x)\\big]\n$$\n我们计算所需的关于 $x$ 的偏导数。\n\n首先，一阶导数：\n$$\n\\frac{\\partial G_m}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\Omega x - \\Omega x^2 + R T \\left[x \\ln x + (1-x) \\ln(1-x)\\right] \\right)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = \\Omega - 2\\Omega x + R T \\left( \\left[ \\ln x + x \\cdot \\frac{1}{x} \\right] + \\left[ (-1)\\ln(1-x) + (1-x) \\cdot \\frac{-1}{1-x} \\right] \\right)\n$$\n$$\n\\frac{\\partial G_m}{\\partial x} = \\Omega(1 - 2x) + R T \\left( \\ln x + 1 - \\ln(1-x) - 1 \\right) = \\Omega(1 - 2x) + R T \\ln\\left(\\frac{x}{1-x}\\right)\n$$\n\n接下来，我们计算二阶导数，它定义了旋节线：\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ \\Omega(1 - 2x) + R T \\ln\\left(\\frac{x}{1-x}\\right) \\right]\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = -2\\Omega + R T \\left( \\frac{1}{x} - \\frac{-1}{1-x} \\right) = -2\\Omega + R T \\left( \\frac{1}{x} + \\frac{1}{1-x} \\right)\n$$\n$$\n\\frac{\\partial^2 G_m}{\\partial x^2} = -2\\Omega + \\frac{R T}{x(1-x)}\n$$\n将此导数设为零，得到临界点的第一个条件：\n$$\n-2\\Omega + \\frac{R T}{x(1-x)} = 0 \\quad \\quad (1)\n$$\n\n现在，我们计算三阶导数：\n$$\n\\frac{\\partial^3 G_m}{\\partial x^3} = \\frac{\\partial}{\\partial x} \\left[ -2\\Omega + R T \\left(x^{-1} + (1-x)^{-1}\\right) \\right]\n$$\n$$\n\\frac{\\partial^3 G_m}{\\partial x^3} = R T \\left( -x^{-2} - (-1)(1-x)^{-2} \\right) = R T \\left( -\\frac{1}{x^2} + \\frac{1}{(1-x)^2} \\right)\n$$\n$$\n\\frac{\\partial^3 G_m}{\\partial x^3} = R T \\frac{-(1-x)^2 + x^2}{x^2 (1-x)^2} = R T \\frac{-(1-2x+x^2) + x^2}{x^2 (1-x)^2} = R T \\frac{2x-1}{x^2 (1-x)^2}\n$$\n将三阶导数设为零，得到临界点的第二个条件：\n$$\nR T \\frac{2x-1}{x^2 (1-x)^2} = 0 \\quad \\quad (2)\n$$\n对于一个物理上有意义的解，$T > 0$ 且 $x \\in (0,1)$，因此 $R T \\neq 0$ 且分母不为零。该方程只有在分子为零时才成立：\n$$\n2x - 1 = 0 \\implies x = \\frac{1}{2}\n$$\n这就是临界成分 $x_c$。\n$$\nx_c = \\frac{1}{2}\n$$\n由于所给吉布斯自由能函数的对称性，这个结果是符合预期的。\n\n为了求出临界温度 $T_c$，我们将临界成分 $x_c = \\frac{1}{2}$ 代入方程(1)：\n$$\n-2\\Omega + \\frac{R T_c}{x_c(1-x_c)} = 0\n$$\n$$\n-2\\Omega + \\frac{R T_c}{\\frac{1}{2}\\left(1-\\frac{1}{2}\\right)} = 0\n$$\n$$\n-2\\Omega + \\frac{R T_c}{\\frac{1}{4}} = 0\n$$\n$$\n-2\\Omega + 4 R T_c = 0\n$$\n解出 $T_c$：\n$$\n4 R T_c = 2\\Omega\n$$\n$$\nT_c = \\frac{2\\Omega}{4R} = \\frac{\\Omega}{2R}\n$$\n\n因此，临界点为 $(T_c, x_c) = \\left(\\frac{\\Omega}{2R}, \\frac{1}{2}\\right)$。\n\n最后，为了存在有限温度的临界点且相分离在物理上是可能的，临界温度 $T_c$ 必须为正。由于普适气体常数 $R$ 是一个正的物理常数（$R > 0$），$T_c > 0$ 的条件意味着：\n$$\n\\frac{\\Omega}{2R} > 0\n$$\n这要求相互作用参数 $\\Omega$ 必须为正：\n$$\n\\Omega > 0\n$$\n正的 $\\Omega$ 值表示混合焓为正，意味着同类原子间的键（A-A和B-B）在能量上比异类原子间的键（A-B）更有利。这种混合的焓罚是在足够低的温度下驱动相分离的原因，此时焓罚效应足以克服有利的混合熵。如果 $\\Omega \\le 0$，则溶体在所有温度和成分下都是稳定的，不会发生相分离。", "answer": "$$\n\\boxed{\\left(\\frac{\\Omega}{2R}, \\frac{1}{2}\\right)}\n$$", "id": "2847127"}, {"introduction": "真实的材料体系往往比理想化的模型更为复杂，其自由能曲线通常是非对称的，难以进行解析求解。本练习将引导您从理论走向实践，学习如何应用数值方法来解决这类复杂问题 [@problem_id:2847129]。您将通过编写一个数值求解器，来实现用于确定双节线（相平衡边界）的公切线构造和用于确定亚稳区边界的旋节线条件，这是现代计算材料科学（如CALPHAD方法）中的一项核心技能。", "problem": "给定一个二元溶液模型，用于描述在绝对温度 $T$ 下，组分 $\\mathrm{A}$ 的组分为 $x \\in (0,1)$ 时的摩尔混合吉布斯自由能，其定义为\n$$\ng(x;T,L_0,L_1) \\equiv R T \\left[x \\ln x + (1-x) \\ln(1-x)\\right] + x(1-x)\\left[L_0 + L_1\\left(2x - 1\\right)\\right],\n$$\n其中 $R$ 是普适气体常数，$L_0$ 和 $L_1$ 是以焦耳/摩尔表示的 Redlich–Kister 参数。假设压力固定，因此可以忽略 $g$ 对压力的依赖性。双节线组分是序对 $\\{x_1,x_2\\}$，其中 $0  x_1  x_2  1$，在该组分下两相共存平衡，并且它们满足公切线构造（两组分的化学势相等）。旋节线组分界定了局部不稳定区域，并满足不稳定性开始的二阶导数条件。\n\n从二元混合物相平衡的基本原理出发：\n- 在恒定 $T$ 和压力下，两相平衡时两组分的化学势相等，这等价于 $g(x)$ 的公切线构造。\n- 局部稳定性要求 $g(x)$ 满足曲率条件；局部稳定性的丧失（旋节线）发生在二阶导数对 $x$ 为零的地方。\n\n您的任务是实现一个数值求解器，对于给定的参数 $T$、$L_0$ 和 $L_1$，计算：\n1. 通过求解公切线平衡条件来计算双节线组分，不假设对称性。\n2. 通过求解二阶导数条件 $d^2 g/dx^2 = 0$ 来计算旋节线组分。\n\n使用的定义：\n- 双节线组分是在固定 $T$ 下满足 $g(x)$ 的公切线构造的组分 $\\{x_1,x_2\\}$，其中 $0  x_1  x_2  1$。如果不混溶间隙不存在，则返回一个空列表作为双节线组分。\n- 旋节线组分是方程 $d^2 g/dx^2 = 0$ 在 $x \\in (0,1)$ 内的根。如果有两个不同的根，则返回两者并按 $[x_{\\mathrm{left}}, x_{\\mathrm{right}}]$ 排序。如果只有一个（临界）根，则返回一个单元素列表 $[x_{\\mathrm{crit}}]$。如果没有物理旋节线（函数是严格凸的），则返回一个空列表。\n\n物理常数和单位：\n- 使用 $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 所有的 $L_0$ 和 $L_1$ 值单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$T$ 的单位为 $\\mathrm{K}$。\n- 所有组分均以区间 $(0,1)$ 内的无量纲数报告。\n- 将报告的每个组分精确到小数点后六位。\n\n数值要求：\n- 仅使用上述定义，通过公切线构造实现双节线计算。不要假设对称性，也不要对方程进行线性化。您可以使用稳健的数值方法求解未知数 $\\{x_1,x_2\\}$（如果有用，还可包括切线斜率）的方程组。如果直接非线性求解失败，您可以退而求其次，在足够密集的网格上对 $g(x)$ 进行凸包络构造，以识别与公切线定义一致的连接线端点。\n- 通过在 $x \\in (0,1)$ 上使用稳健的求根方法求解 $d^2 g/dx^2 = 0$ 来实现旋节线计算。处理两个根在临界点合并的边缘情况；在这种情况下，返回单个组分。如果在 $(0,1)$ 内没有实根，则返回一个空列表。\n\n角度单位不相关。不涉及百分比。\n\n测试套件：\n计算以下四种情况的双节线和旋节线组分：\n- 情况 1：$T = 400\\,\\mathrm{K}$，$L_0 = 12000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$L_1 = 0\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 情况 2：$T = T_{\\mathrm{c}}$，其中 $T_{\\mathrm{c}} \\equiv \\dfrac{L_0}{2R}$，且 $L_0 = 12000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 和 $L_1 = 0\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 情况 3：$T = 1000\\,\\mathrm{K}$，$L_0 = 12000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$L_1 = 0\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 情况 4：$T = 400\\,\\mathrm{K}$，$L_0 = 12000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，$L_1 = 2000\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个由方括号括起来的逗号分隔列表，且无空格。对于每种情况，输出一个双元素列表 $[\\mathrm{binodal},\\mathrm{spinodal}]$，其中每个元素可以是空列表、单元素列表或双元素列表，如上文所定义。因此，最终输出的结构为\n$$\n\\big[ [\\mathrm{binodal}_1,\\mathrm{spinodal}_1], [\\mathrm{binodal}_2,\\mathrm{spinodal}_2], [\\mathrm{binodal}_3,\\mathrm{spinodal}_3], [\\mathrm{binodal}_4,\\mathrm{spinodal}_4] \\big],\n$$\n所有组分均四舍五入到小数点后六位。例如，一个有效的输出可能看起来像\n$$\n[[[0.100000,0.900000],[0.250000,0.750000]],[[],[0.500000]],\\ldots].\n$$", "solution": "所提出的问题是材料热力学中的一个标准练习，具体涉及二元类正则溶液模型中的相平衡。该问题具有科学依据，提法明确，并包含解决问题所需的所有信息。因此，该问题被认为是**有效的**。\n\n该解决方案要求确定二元混合物的双节线和旋节线组分，其摩尔混合吉布斯自由能 $g(x)$ 由 Redlich-Kister 展开式给出：\n$$\ng(x;T,L_0,L_1) = R T \\left[x \\ln x + (1-x) \\ln(1-x)\\right] + x(1-x)\\left[L_0 + L_1\\left(2x - 1\\right)\\right]\n$$\n其中 $x$ 是组分 A 的摩尔分数，$T$ 是绝对温度，$R$ 是普适气体常数，$L_0$ 和 $L_1$ 是相互作用参数。\n\n我们从基本原理出发。\n\n**1. 旋节线组分**\n\n如果吉布斯自由能曲线是凸的（即其关于组分的二阶导数为正），则均相相对于无穷小的组分涨落是局部稳定的。这种局部稳定性的极限是旋节线，此时曲率消失。因此，旋节线组分是以下方程的解：\n$$\n\\frac{d^2 g}{dx^2} = 0\n$$\n为了求这个导数，我们将 $g(x)$ 对 $x$ 求两次导数。\n理想混合项为 $g_{id}(x) = RT[x \\ln x + (1-x) \\ln(1-x)]$。其二阶导数为：\n$$\n\\frac{d^2 g_{id}}{dx^2} = RT\\left(\\frac{1}{x} + \\frac{1}{1-x}\\right) = \\frac{RT}{x(1-x)}\n$$\n超额自由能项为 $g_{ex}(x) = x(1-x)[L_0 + L_1(2x-1)] = (x-x^2)(L_0 - L_1 + 2L_1x) = (L_0-L_1)x + (3L_1-L_0)x^2 - 2L_1x^3$。\n其二阶导数为：\n$$\n\\frac{d^2 g_{ex}}{dx^2} = 2(3L_1-L_0) - 12L_1x = -2L_0 + 6L_1 - 12L_1x = -2L_0 + 6L_1(1-2x)\n$$\n将它们结合起来，旋节线条件是：\n$$\n\\frac{d^2 g}{dx^2} = \\frac{RT}{x(1-x)} - 2L_0 + 6L_1(1-2x) = 0\n$$\n这是一个关于 $x$ 的非线性方程。其在物理上有意义的区间 $x \\in (0,1)$ 内的根就是旋节线组分。根据参数 $(T, L_0, L_1)$，该方程在 $(0,1)$ 内可能有零个、一个（在临界点）或两个实根。这些根将使用数值求根算法找到。一种稳健的方法是细分区间 $(0,1)$，并在任何出现符号变化的子区间上应用像 Brent 方法这样的区间法。\n\n**2. 双节线组分**\n\n如果每个组分在两个相中的化学势相等，则组分为 $x_1$ 和 $x_2$ 的两相处于热力学平衡状态。设 $\\mu_A(x)$ 和 $\\mu_B(x)$ 分别为组分 A 和 B 在组分 $x$ 时的化学势。平衡条件是：\n$$\n\\mu_A(x_1) = \\mu_A(x_2)\n$$\n$$\n\\mu_B(x_1) = \\mu_B(x_2)\n$$\n化学势可以从摩尔混合吉布斯自由能 $g(x)$ 作为偏摩尔量导出。对于组分 A（摩尔分数为 $x$）和组分 B（摩尔分数为 $1-x$）：\n$$\n\\mu_A(x) = g(x) + (1-x)\\frac{dg}{dx}\n$$\n$$\n\\mu_B(x) = g(x) - x\\frac{dg}{dx}\n$$\n（注意：这些关系是从总摩尔吉布斯能量 $G_m = (1-x)G^0_A + x G^0_B + g(x)$ 和吉布斯-杜亥姆关系推导出来的，其中纯组分项 $G^0_i$ 在平衡条件中被消掉）。\n\n将这些代入平衡条件，得到两个联立方程。从第一个方程中减去第二个方程，得到：\n$$\n\\left(\\mu_A(x_1)-\\mu_B(x_1)\\right) = \\left(\\mu_A(x_2)-\\mu_B(x_2)\\right) \\implies \\frac{dg}{dx}\\bigg|_{x_1} = \\frac{dg}{dx}\\bigg|_{x_2}\n$$\n这表明 $g(x)$ 曲线在两个双节线组分处的斜率必须相等。\n将此结果代回 $\\mu_A$ 的条件，得到：\n$$\ng(x_1) + (1-x_1)\\frac{dg}{dx}\\bigg|_{x_1} = g(x_2) + (1-x_2)\\frac{dg}{dx}\\bigg|_{x_1}\n$$\n整理后得到第二个条件：\n$$\ng(x_2) - g(x_1) = (x_2-x_1)\\frac{dg}{dx}\\bigg|_{x_1} \\quad \\text{或} \\quad \\frac{g(x_2)-g(x_1)}{x_2-x_1} = \\frac{dg}{dx}\\bigg|_{x_1}\n$$\n这两个方程代表了“公切线构造”：存在一条直线，它同时与 $g(x)$ 曲线在 $x_1$ 和 $x_2$ 处相切。一个不混溶间隙，以及因此的一对双节线组分 $\\{x_1, x_2\\}$（其中 $x_1  x_2$），仅在 $g(x)$ 曲线不是全局凸的情况下存在。这要求存在一个区域，其中 $d^2g/dx^2  0$，这反过来又意味着存在两个不同的旋节线组分。因此，只有在找到两个旋节线点时才进行双节线计算。\n\n这个关于两个未知数 $(x_1, x_2)$ 的非线性方程组，使用诸如信赖域法或 Levenberg-Marquardt 法等稳健算法进行数值求解，这些算法在 `scipy.optimize.root` 中有实现。求解器的良好初始猜测可以从旋节线组分估计得出，因为已知 $0  x_1  x_{s1}  x_{s2}  x_2  1$。\n\n**3. 实现**\n\n数值解是使用 Python 的 `numpy` 和 `scipy` 库实现的。\n- 定义了 $g(x)$、$dg/dx$ 和 $d^2g/dx^2$ 的函数。\n- `solve_spinodal` 函数在区间 $(0,1)$ 内找到 $d^2g/dx^2=0$ 的根。它能处理零个、一个或两个根的情况。\n- `solve_binodal` 函数首先检查是否存在两个旋节线根。如果存在，它会建立并求解公切线条件的两个方程组。它使用旋节线根来生成一个合理的初始猜测。如果求解器成功并且结果在物理上有效，则返回组分。\n- 主函数遍历测试用例，调用求解器，将结果格式化为六位小数，并按指定格式打印最终输出。", "answer": "[[[0.057703,0.942297],[0.166170,0.833830]],[[],[0.500000]],[[],[]],[[0.050518,0.923880],[0.161390,0.767980]]]", "id": "2847129"}]}