{"hands_on_practices": [{"introduction": "我们如何定量地描述像金属玻璃这样无序材料的结构？本练习介绍了 Voronoi 分析法，这是一种强大的几何工具，用于定义每个原子的局域环境和配位数。通过分析不同局域结构的数量分布，我们可以计算出平均配位数和堆积效率等宏观性质，从而将微观原子排列与材料的整体特征联系起来 [@problem_id:2799722]。", "problem": "一种单原子金属玻璃展现出一种由沃罗诺伊指数表征的局域原子环境分布。对于一个原子，其沃罗诺伊指数写作 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$，其中 $n_{k}$ 是具有 $k$ 条边的沃罗诺伊面的数量。根据定义，配位数是沃罗诺伊多面体上的总面数。\n\n考虑样品中以下五种最常见的结构基元及其占比：\n- $\\langle 0,0,12,0 \\rangle$，占比 $f_{1} = 0.42$，\n- $\\langle 0,1,10,2 \\rangle$，占比 $f_{2} = 0.18$，\n- $\\langle 0,2,8,2 \\rangle$，占比 $f_{3} = 0.15$，\n- $\\langle 0,3,6,0 \\rangle$，占比 $f_{4} = 0.12$，\n- $\\langle 0,0,10,2 \\rangle$，占比 $f_{5} = 0.13$。\n\n独立的结构分析表明，对于半径为 $r$ 的等径原子，在这些结构基元中的原子的平均沃罗诺伊胞体积（以单原子体积 $v_{\\mathrm{atom}} = \\frac{4}{3} \\pi r^{3}$ 为单位）分别为：\n- $V_{1} = 1.52 \\, v_{\\mathrm{atom}}$，\n- $V_{2} = 1.58 \\, v_{\\mathrm{atom}}$，\n- $V_{3} = 1.56 \\, v_{\\mathrm{atom}}$，\n- $V_{4} = 1.72 \\, v_{\\mathrm{atom}}$，\n- $V_{5} = 1.54 \\, v_{\\mathrm{atom}}$。\n\n从第一性原理出发，完成以下任务：\n1. 使用沃罗诺伊多面体配位数的定义，计算样品的平均配位数。\n2. 使用堆积分数的定义（原子占据的空间分数）以及沃罗诺伊镶嵌作为一种为每个原子分配唯一体积的空间填充划分的解释，推导出一个用结构基元分数、各结构基元分辨的沃罗诺伊体积和 $v_{\\mathrm{atom}}$ 表示的宏观堆积分数表达式。利用给定数据对该表达式进行数值计算。\n\n仅报告堆积分数作为最终答案，表示为无量纲小数并四舍五入到四位有效数字。", "solution": "该问题要求分析单原子金属玻璃的结构特性，具体而言，基于给定的由沃罗诺伊指数描述的局域原子环境分布，计算其平均配位数和宏观堆积分数。\n\n首先，需要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **沃罗诺伊指数：** $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$，其中 $n_k$ 是具有 $k$ 条边的沃罗诺伊面的数量。\n- **配位数 ($CN$)：** 定义为沃罗诺伊多面体的总面数，因此 $CN = \\sum_k n_k$。\n- **结构基元占比：**\n  - 基元 1: $\\langle 0,0,12,0 \\rangle$，占比 $f_{1} = 0.42$\n  - 基元 2: $\\langle 0,1,10,2 \\rangle$，占比 $f_{2} = 0.18$\n  - 基元 3: $\\langle 0,2,8,2 \\rangle$，占比 $f_{3} = 0.15$\n  - 基元 4: $\\langle 0,3,6,0 \\rangle$，占比 $f_{4} = 0.12$\n  - 基元 5: $\\langle 0,0,10,2 \\rangle$，占比 $f_{5} = 0.13$\n- **单原子体积：** 对于半径为 $r$ 的原子， $v_{\\mathrm{atom}} = \\frac{4}{3} \\pi r^{3}$。\n- **平均沃罗诺伊胞体积 ($V_i$)：**\n  - $V_{1} = 1.52 \\, v_{\\mathrm{atom}}$\n  - $V_{2} = 1.58 \\, v_{\\mathrm{atom}}$\n  - $V_{3} = 1.56 \\, v_{\\mathrm{atom}}$\n  - $V_{4} = 1.72 \\, v_{\\mathrm{atom}}$\n  - $V_{5} = 1.54 \\, v_{\\mathrm{atom}}$\n- **堆积分数 ($\\phi$)：** 定义为原子占据的空间分数。\n- **任务：**\n  1. 计算平均配位数 $\\overline{CN}$。\n  2. 推导并计算宏观堆积分数 $\\phi$ 的表达式。\n- **最终答案：** 仅报告堆积分数的数值，四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了材料物理学中的标准概念，例如使用沃罗诺伊分析来表征非晶结构。所提供的数据是一致的；结构基元分数之和为 $f_1+f_2+f_3+f_4+f_5 = 0.42 + 0.18 + 0.15 + 0.12 + 0.13 = 1.00$，使得该问题是自洽的。提供的沃罗诺伊指数对应于已知的稳定多面体（例如，$\\langle 0,0,12,0 \\rangle$ 是二十面体）。定义清晰明确。该问题是适定的和客观的。\n\n**步骤3：结论与行动**\n该问题有效。将制定解决方案。\n\n按照要求，解答过程分为两部分，尽管只有第二部分的结果构成最终答案。\n\n**第一部分：平均配位数**\n\n对于结构基元 $i$ 中的原子，其配位数 $CN_i$ 是其沃罗诺伊指数中整数的总和，即 $CN_i = n_3 + n_4 + n_5 + n_6$。\n对于每个结构基元：\n- $\\langle 0,0,12,0 \\rangle$ 的 $CN_1$ 为 $0+0+12+0 = 12$。\n- $\\langle 0,1,10,2 \\rangle$ 的 $CN_2$ 为 $0+1+10+2 = 13$。\n- $\\langle 0,2,8,2 \\rangle$ 的 $CN_3$ 为 $0+2+8+2 = 12$。\n- $\\langle 0,3,6,0 \\rangle$ 的 $CN_4$ 为 $0+3+6+0 = 9$。\n- $\\langle 0,0,10,2 \\rangle$ 的 $CN_5$ 为 $0+0+10+2 = 12$。\n\n样品的平均配位数 $\\overline{CN}$ 是各个配位数的加权平均值，权重为结构基元分数 $f_i$：\n$$\n\\overline{CN} = \\sum_{i=1}^{5} f_i CN_i\n$$\n代入给定值：\n$$\n\\overline{CN} = (0.42)(12) + (0.18)(13) + (0.15)(12) + (0.12)(9) + (0.13)(12)\n$$\n$$\n\\overline{CN} = 5.04 + 2.34 + 1.80 + 1.08 + 1.56 = 11.82\n$$\n这个结果对于致密的金属玻璃来说是物理上合理的。然而，它不是所要求的最终答案。\n\n**第二部分：宏观堆积分数**\n\n宏观堆积分数 $\\phi$ 定义为原子占据的总體积除以系统的总体积。\n$$\n\\phi = \\frac{V_{\\text{atoms}}}{V_{\\text{total}}}\n$$\n考虑一个包含大量原子（$N$个）的系统。由于所有原子都相同，原子的总体积为 $V_{\\text{atoms}} = N \\cdot v_{\\mathrm{atom}}$。\n沃罗诺伊镶嵌将系统总体积划分为 $N$ 个胞，每个原子一个。总体积是这些胞的体积之和。这个和可以按结构基元类型分组。类型为 $i$ 的结构基元的原子数为 $N_i = f_i N$。结构基元 $i$ 的平均沃罗诺伊胞体积为 $V_i$。因此，系统的总体积为：\n$$\nV_{\\text{total}} = \\sum_{i=1}^{5} N_i V_i = \\sum_{i=1}^{5} (f_i N) V_i = N \\sum_{i=1}^{5} f_i V_i\n$$\n那么堆积分数为：\n$$\n\\phi = \\frac{N \\cdot v_{\\mathrm{atom}}}{N \\sum_{i=1}^{5} f_i V_i} = \\frac{v_{\\mathrm{atom}}}{\\sum_{i=1}^{5} f_i V_i}\n$$\n问题以单原子体积为单位提供了平均沃罗诺伊胞体积，即 $V_i = c_i v_{\\mathrm{atom}}$，其中 $c_i$ 是给定的无量纲常数（$c_1=1.52$，$c_2=1.58$ 等）。将此代入 $\\phi$ 的表达式中：\n$$\n\\phi = \\frac{v_{\\mathrm{atom}}}{\\sum_{i=1}^{5} f_i (c_i v_{\\mathrm{atom}})} = \\frac{v_{\\mathrm{atom}}}{v_{\\mathrm{atom}} \\sum_{i=1}^{5} f_i c_i} = \\frac{1}{\\sum_{i=1}^{5} f_i c_i}\n$$\n这就是推导出的解析表达式。堆积分数是以 $v_{\\mathrm{atom}}$ 为单位表示的平均沃罗诺伊胞体积的倒数。\n\n现在，我们对此表达式进行数值计算。分母是平均无量纲体积 $\\bar{c}$。\n$$\n\\bar{c} = \\sum_{i=1}^{5} f_i c_i = f_1 c_1 + f_2 c_2 + f_3 c_3 + f_4 c_4 + f_5 c_5\n$$\n代入给定值：\n$$\n\\bar{c} = (0.42)(1.52) + (0.18)(1.58) + (0.15)(1.56) + (0.12)(1.72) + (0.13)(1.54)\n$$\n$$\n\\bar{c} = 0.6384 + 0.2844 + 0.2340 + 0.2064 + 0.2002 = 1.5634\n$$\n堆积分数是该值的倒数：\n$$\n\\phi = \\frac{1}{1.5634} \\approx 0.63963157...\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\phi \\approx 0.6396\n$$\n该值与球体随机密堆积的典型堆积分数一致。", "answer": "$$\\boxed{0.6396}$$", "id": "2799722"}, {"introduction": "网络玻璃（如硫系玻璃）的性质与其网络拓扑结构密切相关。由 J.C. Phillips 和 M.F. Thorpe 发展的拓扑约束理论（Topological Constraint Theory）提供了一个简洁而强大的框架，可以根据材料的化学成分和原子连接性来预测其网络的机械稳定性。本练习将通过计算键伸缩和键弯曲约束的数量，来判断一个玻璃网络是柔性的、刚性（应力）的，还是处于理想的等静定状态 [@problem_id:2799773]。", "problem": "考虑一种宏观均匀、化学有序的锗-砷-硒体系硫系玻璃，其原子分数组成为 $\\mathrm{Ge}_{0.17}\\mathrm{As}_{0.19}\\mathrm{Se}_{0.64}$。假设在大$N$极限下，这是一个完全聚合的三维共价网络，没有悬空键，也没有冗余环约束。使用八隅体（$8-N$）规则来确定局域配位数：锗为四配位（$r_{\\mathrm{Ge}}=4$），砷为三配位（$r_{\\mathrm{As}}=3$），硒为二配位（$r_{\\mathrm{Se}}=2$）。假设所有中心力键伸缩和键弯曲相互作用都是完整且独立的。\n\n使用拓扑约束理论（TCT），从三维空间中的自由度和约束的麦克斯韦计数法出发，从第一性原理确定：\n- 该组分下每个原子的键伸缩约束数 $n_s$，\n- 每个原子的键弯曲约束数 $n_b$，\n- 以及每个原子的总约束数 $n_c=n_s+n_b$。\n\n根据您计算出的 $n_c$ 值，使用“在三维空间中，当每个原子的约束数等于每个原子的平动自由度数时，达到机械等静定”这一判据，说明该网络是柔性的、等静定的还是应力刚性的。\n\n最终答案仅需提供每个原子的总约束数 $n_c$ 这一个无量纲数。将您的最终答案四舍五入到 $4$ 位有效数字。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 体系：宏观均匀、化学有序的锗-砷-硒体系硫系玻璃。\n- 组分：原子分数为 $\\mathrm{Ge}_{x}\\mathrm{As}_{y}\\mathrm{Se}_{z}$，其中 $x=0.17$，$y=0.19$，$z=0.64$。\n- 网络假设：在大 N 极限下，完全聚合的三维（$d=3$）共价网络，无悬空键，无冗余环约束。\n- 配位数：根据八隅体（$8-N$）规则，$r_{\\mathrm{Ge}}=4$，$r_{\\mathrm{As}}=3$，$r_{\\mathrm{Se}}=2$。\n- 相互作用：所有中心力键伸缩和键弯曲相互作用均完整且独立。\n- 理论框架：使用麦克斯韦计数法的拓扑约束理论（TCT）。\n- 目标：确定每个原子的键伸缩约束数（$n_s$）、每个原子的键弯曲约束数（$n_b$）和每个原子的总约束数（$n_c$），并对网络的刚性进行分类。\n- 等静定判据：在三维空间中，当 $n_c=3$ 时，达到机械等静定。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。它涉及拓扑约束理论的应用，该理论是凝聚态物理中描述硫系玻璃等非晶网络性质的标准且成熟的模型。其组分和配位规则是此类材料的标准。\n- 该问题提法得当且内容自洽。它提供了进行计算所需的所有必要参数（原子分数、配位数、维度）。目标清晰明确。\n- 该问题是客观的。语言精确、定量，没有任何推测性或主观性陈述。\n- 原子分数之和为 $0.17 + 0.19 + 0.64 = 1.00$，确认了组分的一致性。\n\n步骤3：结论与行动。\n该问题被认为是有效的，因为它科学合理、提法得当、客观且完整。可以构建一个严谨的解答。\n\n拓扑约束理论的基本原理是将每个原子的机械约束数 $n_c$ 与每个原子的平动自由度数 $d$ 进行比较。对于指定的三维网络，$d=3$。网络的稳定性由差值 $d - n_c$ 的符号决定。\n\n第一步是计算网络的平均配位数，记为 $\\langle r \\rangle$。这是组成原子的配位数的加权平均值，权重为其原子分数。\n给定组成为 $\\mathrm{Ge}_{0.17}\\mathrm{As}_{0.19}\\mathrm{Se}_{0.64}$，配位数为 $r_{\\mathrm{Ge}}=4$、$r_{\\mathrm{As}}=3$ 和 $r_{\\mathrm{Se}}=2$，则平均配位数为：\n$$\n\\langle r \\rangle = x \\cdot r_{\\mathrm{Ge}} + y \\cdot r_{\\mathrm{As}} + z \\cdot r_{\\mathrm{Se}}\n$$\n代入给定值：\n$$\n\\langle r \\rangle = (0.17)(4) + (0.19)(3) + (0.64)(2) = 0.68 + 0.57 + 1.28 = 2.53\n$$\n\n接下来，我们确定每个原子的约束数，即每个原子的键伸缩约束数和键弯曲约束数之和，$n_c = n_s + n_b$。\n\n每个原子的键伸缩约束数 $n_s$ 由化学键的数量决定。在一个由 $N$ 个原子组成的网络中，由于每个键连接两个原子，总键数为 $\\frac{1}{2} N \\langle r \\rangle$。由于每个键代表一个中心力约束，因此每个原子的伸缩约束数为：\n$$\nn_s = \\frac{\\frac{1}{2} N \\langle r \\rangle}{N} = \\frac{\\langle r \\rangle}{2}\n$$\n使用计算出的 $\\langle r \\rangle$ 值：\n$$\nn_s = \\frac{2.53}{2} = 1.265\n$$\n\n每个原子的键弯曲约束数 $n_b$ 来自每个原子处的角度约束。对于一个在三维空间中配位数为 $r_i \\geq 2$ 的中心原子，存在 $2r_i - 3$ 个独立的键弯曲约束。配位数 $r_i  2$ 的原子不产生弯曲约束。在本问题中，所有原子种类的配位数均满足 $r_i \\geq 2$。每个原子的总键弯曲约束数是组分的平均值：\n$$\nn_b = \\sum_{i} x_i (2r_i - 3) = x(2r_{\\mathrm{Ge}} - 3) + y(2r_{\\mathrm{As}} - 3) + z(2r_{\\mathrm{Se}} - 3)\n$$\n该表达式可以用平均配位数简化为：\n$$\nn_b = 2 \\left( \\sum_{i} x_i r_i \\right) - 3 \\left( \\sum_{i} x_i \\right) = 2\\langle r \\rangle - 3\n$$\n代入 $\\langle r \\rangle$ 的值：\n$$\nn_b = 2(2.53) - 3 = 5.06 - 3 = 2.06\n$$\n\n每个原子的总约束数 $n_c$ 是伸缩约束和弯曲约束之和：\n$$\nn_c = n_s + n_b = \\frac{\\langle r \\rangle}{2} + (2\\langle r \\rangle - 3) = \\frac{5}{2}\\langle r \\rangle - 3\n$$\n使用计算出的值：\n$$\nn_c = 1.265 + 2.06 = 3.325\n$$\n或者，使用最终公式：\n$$\nn_c = \\frac{5}{2}(2.53) - 3 = 6.325 - 3 = 3.325\n$$\n结果一致。\n\n最后，我们根据三维空间中的麦克斯韦等静定判据（即 $n_c = d = 3$）对网络进行分类。\n- 若 $n_c  3$，网络是柔性的（欠约束）。\n- 若 $n_c = 3$，网络是等静定的（最佳约束）。\n- 若 $n_c > 3$，网络是应力刚性的（过约束）。\n\n在本例中，我们得到 $n_c = 3.325$。由于 $n_c > 3$，该网络被分类为应力刚性。\n\n题目要求以一个无量纲数的形式给出每个原子的总约束数 $n_c$，并四舍五入到4位有效数字。计算值为 $3.325$，该值已经具有4位有效数字。", "answer": "$$\\boxed{3.325}$$", "id": "2799773"}, {"introduction": "当过冷液体接近玻璃化转变温度 $T_g$ 时，其动力学行为会急剧减慢。本练习将探讨时间-温度叠加原理和描述高分子中这一现象的关键经验模型——Williams-Landel-Ferry (WLF) 方程。您将把这些概念应用于实际数据，以提取基本的材料参数，并计算脆性指数 $m$，这是一个量化动力学随温度变化快慢的关键指标 [@problem_id:2799721]。", "problem": "考虑一个以时温叠加原理 (TTS) 为特征的高分子玻璃形成体，其水平位移因子 $a_T$ 关联了粘弹性响应函数的温度依赖性。在玻璃化转变附近，一个广泛用于描述位移因子常用对数的经验关系式是 Williams–Landel–Ferry (WLF) 方程，该方程通过两个材料特定常数 $C_1$ 和 $C_2$ 表达了 $a_T$ 相对于参考温度 $T_{\\mathrm{ref}}$ 的温度依赖性。动态脆性指数 $m$ 量化了在玻璃化转变温度 $T_g$ 处特征弛豫时间（或粘度）的温度依赖性的陡峭程度，其定义为弛豫时间的常用对数 $\\log_{10}$ 相对于 $T_g/T$ 在 $T=T_g$ 处的斜率。\n\n从上述定义出发，并将 WLF 方程视为一个适用于玻璃化转变附近聚合物且经过充分检验的经验定律，编写一个程序，对下面的每个测试用例执行以下任务：\n\n- 使用非线性最小二乘法，将 WLF 参数 $C_1$ 和 $C_2$ 拟合到所提供的、相对于指定参考温度 $T_{\\mathrm{ref}}$ 的 $\\log_{10} a_T$ 随温度 $T$ 变化的测量值。\n- 根据拟合出的参数以及脆性指数 $m$（定义为特征时间的常用对数 $\\log_{10}$ 相对于 $T_g/T$ 在 $T=T_g$ 处的斜率），使用微积分和 WLF 拟合结果推导并计算 $m$。假设测量的 $\\log_{10} a_T$ 通过 TTS 捕捉了特征时间的温度依赖性，因此 $\\log_{10} a_T$ 的斜率控制着脆性。\n- 对每个测试用例，以浮点数形式返回 $m$。\n\n所有温度都必须以开尔文（即 $\\mathrm{K}$）为单位进行处理和报告。脆性指数 $m$ 是无量纲的。您的程序应计算每个测试用例的 $m$ 值，并将结果四舍五入到三位小数后报告。\n\n测试套件（每个用例提供 $T_{\\mathrm{ref}}$、$T_g$、一个以 $\\mathrm{K}$ 为单位的温度列表 $T_i$ 以及测量的 $\\log_{10} a_T(T_i)$）：\n\n- 用例 A（理想路径；数据分布适中，实验噪声小）：\n  - $T_{\\mathrm{ref}} = 373\\,\\mathrm{K}$，$T_g = 373\\,\\mathrm{K}$。\n  - 温度：$[353,363,373,383,393]\\,\\mathrm{K}$。\n  - 测量的 $\\log_{10} a_T$：$[11.058,4.182,0.000,-2.821,-4.893]$。\n- 用例 B（强玻璃形成体；较低的脆性；实验噪声小）：\n  - $T_{\\mathrm{ref}} = 323\\,\\mathrm{K}$，$T_g = 323\\,\\mathrm{K}$。\n  - 温度：$[303,313,323,333,343]\\,\\mathrm{K}$。\n  - 测量的 $\\log_{10} a_T$：$[4.970,2.020,0.000,-1.439,-2.470]$。\n- 用例 C（覆盖 $T_{\\mathrm{ref}} \\neq T_g$ 的情况；与 WLF 精确一致的数据）：\n  - $T_{\\mathrm{ref}} = 333\\,\\mathrm{K}$，$T_g = 348\\,\\mathrm{K}$。\n  - 温度：$[313,323,333,343,353]\\,\\mathrm{K}$。\n  - 测量的 $\\log_{10} a_T$：$[5.000,2.142857,0.000,-1.666667,-3.000]$。\n\n算法要求：\n\n- 对每个用例，使用非线性最小二乘拟合，根据数据 $\\{(T_i, \\log_{10} a_T(T_i))\\}$ 估计 $C_1$ 和 $C_2$，并施加 $C_10$ 和 $C_20$ 的约束。\n- 从定义 $m = \\left.\\dfrac{d \\log_{10} \\tau(T)}{d \\left(T_g/T\\right)}\\right|_{T=T_g}$ 推导 $m$，其中根据 TTS 原理，在 $T_g$ 附近可以认为 $\\tau(T) \\propto a_T(T)$（相差一个与温度无关的乘法常数）。使用基于 WLF 的拟合在 $T=T_g$ 处计算该导数。\n\n输出要求：\n\n- 将 $m$ 表示为无量纲浮点数，四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[m_{\\mathrm{A}}, m_{\\mathrm{B}}, m_{\\mathrm{C}}]$。\n\n不需要用户输入；程序必须是完全自包含的，并且必须完全按照上面给出的方式使用测试套件。", "solution": "所述问题已根据既定的科学和数学原理进行了验证，并被证实是有效的。该问题在科学上基于无定形材料的既定物理学，是适定的、无歧义的，并为得出唯一解提供了所有必要信息。因此，我们可以进行正式求解。\n\n目标是根据给定的粘弹性响应数据，计算高分子玻璃形成体的动态脆性指数 $m$。该解决方案基于两个关键概念：Williams–Landel–Ferry (WLF) 方程和脆性的定义。\n\nWLF 方程描述了粘弹性位移因子 $a_T$ 相对于参考温度 $T_{\\mathrm{ref}}$ 的温度依赖性：\n$$ \\log_{10} a_T(T) = -\\frac{C_1 (T - T_{\\mathrm{ref}})}{C_2 + (T - T_{\\mathrm{ref}})} $$\n此处，$C_1$ 和 $C_2$ 是正的材料常数。\n\n动态脆性指数 $m$ 定义为在玻璃化转变温度 $T_g$ 处弛豫动力学的陡峭程度：\n$$ m = \\left. \\frac{d (\\log_{10} \\tau)}{d (T_g/T)} \\right|_{T=T_g} $$\n其中 $\\tau(T)$ 是特征结构弛豫时间。问题假定，时温叠加原理 (TTS) 适用，该原理通过 $\\tau(T) = \\tau(T_{\\mathrm{ref}}) a_T(T)$ 将 $\\tau(T)$ 与位移因子 $a_T$ 联系起来。因此，$\\log_{10} \\tau(T) = \\log_{10} \\tau(T_{\\mathrm{ref}}) + \\log_{10} a_T(T)$。由于 $\\tau(T_{\\mathrm{ref}})$ 是一个常数，$\\log_{10} \\tau(T)$ 相对于任何变量的导数都与 $\\log_{10} a_T(T)$ 的导数相同。因此，$m$ 的定义可以根据 $a_T$ 重写为：\n$$ m = \\left. \\frac{d (\\log_{10} a_T)}{d (T_g/T)} \\right|_{T=T_g} $$\n为了推导 $m$ 的解析表达式，我们应用链式法则。令 $f(T) = \\log_{10} a_T(T)$ 且 $x(T) = T_g/T$。我们需要计算 $df/dx$ 在 $T=T_g$ 处的值。\n$$ \\frac{df}{dx} = \\frac{df/dT}{dx/dT} $$\n首先，我们使用 WLF 方程和微分学的商法则，计算 $f(T)$ 相对于温度 $T$ 的导数：\n$$ \\frac{df}{dT} = \\frac{d}{dT} \\left( -\\frac{C_1 (T - T_{\\mathrm{ref}})}{C_2 + (T - T_{\\mathrm{ref}})} \\right) = -C_1 \\left[ \\frac{(1)(C_2 + T - T_{\\mathrm{ref}}) - (T - T_{\\mathrm{ref}})(1)}{(C_2 + T - T_{\\mathrm{ref}})^2} \\right] $$\n$$ \\frac{df}{dT} = -\\frac{C_1 C_2}{(C_2 + T - T_{\\mathrm{ref}})^2} $$\n其次，我们计算 $x(T)$ 相对于温度 $T$ 的导数：\n$$ \\frac{dx}{dT} = \\frac{d}{dT} \\left( \\frac{T_g}{T} \\right) = -\\frac{T_g}{T^2} $$\n综合这些结果，我们得到斜率的表达式：\n$$ \\frac{df}{dx} = \\frac{-C_1 C_2 / (C_2 + T - T_{\\mathrm{ref}})^2}{-T_g / T^2} = \\frac{C_1 C_2 T^2}{T_g (C_2 + T - T_{\\mathrm{ref}})^2} $$\n为了求得脆性 $m$，我们在 $T = T_g$ 处计算该表达式的值：\n$$ m = \\left. \\frac{df}{dx} \\right|_{T=T_g} = \\frac{C_1 C_2 T_g^2}{T_g (C_2 + T_g - T_{\\mathrm{ref}})^2} $$\n这可以简化为基于 WLF 参数的脆性指数的最终解析公式：\n$$ m = \\frac{C_1 C_2 T_g}{(C_2 + T_g - T_{\\mathrm{ref}})^2} $$\n当参考温度被选为玻璃化转变温度，即 $T_{\\mathrm{ref}} = T_g$ 时，会出现一种特殊情况。该公式简化为：\n$$ m = \\frac{C_1 C_2 T_g}{(C_2)^2} = \\frac{C_1 T_g}{C_2} $$\n\n每个测试用例的计算过程包括两个步骤：\n1. 将 WLF 参数 $C_1$ 和 $C_2$ 拟合到提供的实验数据对 $(T_i, \\log_{10} a_T(T_i))$。这是一个非线性回归问题，使用最小二乘算法求解。必须强制执行 $C_1  0$ 和 $C_2  0$ 的约束，因为这是物理上要求的。\n2. 将拟合的参数 $C_1$ 和 $C_2$ 以及给定的 $T_g$ 和 $T_{\\mathrm{ref}}$ 代入推导出的 $m$ 的解析表达式中，以计算脆性指数。\n\n提供的程序实现了这一过程。对于每个用例，它将 WLF 模型定义为一个函数，并利用 `scipy.optimize.curve_fit` 例程来执行非线性最小二乘拟合。`bounds` 参数用于强制 $C_1$ 和 $C_2$ 的正性。然后使用得到的最优参数来计算 $m$。最终结果四舍五入到三位小数并按要求进行格式化。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits WLF parameters to viscoelastic data and computes the fragility index.\n    \"\"\"\n    test_cases = [\n        {\n            \"id\": \"A\",\n            \"T_ref\": 373.0,\n            \"T_g\": 373.0,\n            \"T_data\": np.array([353.0, 363.0, 373.0, 383.0, 393.0]),\n            \"log_aT_data\": np.array([11.058, 4.182, 0.000, -2.821, -4.893])\n        },\n        {\n            \"id\": \"B\",\n            \"T_ref\": 323.0,\n            \"T_g\": 323.0,\n            \"T_data\": np.array([303.0, 313.0, 323.0, 333.0, 343.0]),\n            \"log_aT_data\": np.array([4.970, 2.020, 0.000, -1.439, -2.470])\n        },\n        {\n            \"id\": \"C\",\n            \"T_ref\": 333.0,\n            \"T_g\": 348.0,\n            \"T_data\": np.array([313.0, 323.0, 333.0, 343.0, 353.0]),\n            \"log_aT_data\": np.array([5.000, 2.142857, 0.000, -1.666667, -3.000])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T_ref = case[\"T_ref\"]\n        T_g = case[\"T_g\"]\n        T_data = case[\"T_data\"]\n        log_aT_data = case[\"log_aT_data\"]\n        \n        # Define the WLF model function. T_ref is captured from the outer scope.\n        def wlf_model(T, C1, C2):\n            \"\"\"Williams-Landel-Ferry (WLF) equation.\"\"\"\n            return -C1 * (T - T_ref) / (C2 + (T - T_ref))\n\n        # Initial guess for the parameters [C1, C2].\n        # These are typical values for many polymers.\n        initial_guess = [10.0, 50.0]\n        \n        # Define bounds for the parameters, C1 > 0 and C2 > 0.\n        bounds = ([0, 0], [np.inf, np.inf])\n\n        # Perform nonlinear least-squares fitting.\n        try:\n            popt, _ = curve_fit(\n                wlf_model,\n                T_data,\n                log_aT_data,\n                p0=initial_guess,\n                bounds=bounds\n            )\n        except RuntimeError:\n            # If fit fails, append a placeholder and continue.\n            # This is for robustness, though not expected for the given test cases.\n            results.append(float('nan'))\n            continue\n\n        C1_fit, C2_fit = popt\n\n        # Derived formula for fragility index m:\n        # m = (C1 * C2 * T_g) / (C2 + T_g - T_ref)^2\n        numerator = C1_fit * C2_fit * T_g\n        denominator = (C2_fit + T_g - T_ref)**2\n        \n        fragility_m = numerator / denominator\n\n        results.append(fragility_m)\n\n    # Format the results for final output\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2799721"}]}