{"hands_on_practices": [{"introduction": "理解晶界运动的基本原理是掌握晶粒长大与粗化现象的关键。本练习从最简单的理想化系统——一个二维空间中孤立的圆形晶粒——入手，旨在从第一性原理出发，推导其收缩动力学方程。通过求解这个经典问题 [@problem_id:2826936]，你将深入理解曲率如何作为驱动力，并掌握将物理定律 ($v_n = M\\gamma\\kappa$) 与几何关系相结合来建立和求解描述微观结构演化的微分方程的基本方法。", "problem": "一个二维多晶体中的孤立单相圆形晶粒因曲率驱动的晶界迁移而收缩。单位长度的晶界能是各向同性且恒定的，记为 $\\gamma$。晶界迁移率是恒定的，记为 $M$。其动力学由曲率流控制，因此晶界的法向速度满足 $v_{n} = M \\gamma \\kappa$，其中 $\\kappa$ 是标量曲率。约定单位法向量指向晶粒内部，因此对于瞬时半径为 $R(t)$ 的圆形晶粒，有 $\\kappa(t) = 1/R(t)$，且 $v_{n} > 0$ 对应于收缩。在时间 $t = 0$ 时，半径为 $R(0) = R_{0}$，其中 $R_{0} > 0$。假设晶粒在其整个演化过程中保持圆形，并忽略三重结、储存能差、溶质拖曳和任何各向异性。\n\n仅从给定的动力学定律和圆的曲率的几何定义出发，推导出 $R(t)$ 的控制常微分方程，并对其进行积分，以求得晶粒消失的坍塌时间 $t_{c}$，作为 $R_{0}$、$M$ 和 $\\gamma$ 的函数。\n\n在国际单位制（SI）中，假设 $\\gamma$ 的单位是焦耳/米，$M$ 的单位是米³/（焦耳·秒），请用秒表示你对 $t_{c}$ 的最终答案。不需要进行数值四舍五入；请提供一个闭式解析表达式。", "solution": "首先必须验证所述问题的正确性和可解性。\n\n步骤1：提取已知条件。\n- 该系统是一个二维多晶体中的孤立单相圆形晶粒。\n- 该过程是曲率驱动的晶界迁移导致的收缩。\n- 单位长度的晶界能是一个各向同性的常数 $\\gamma$。\n- 晶界迁移率是一个常数 $M$。\n- 控制动力学定律为 $v_{n} = M \\gamma \\kappa$，其中 $v_n$ 是晶界的法向速度，$\\kappa$ 是标量曲率。\n- 单位法向量指向晶粒内部。\n- 对于半径为 $R(t)$ 的圆形晶粒，其曲率为 $\\kappa(t) = \\frac{1}{R(t)}$。\n- 正的法向速度 $v_{n} > 0$ 对应于收缩。\n- 初始条件为 $R(t=0) = R_{0}$，其中 $R_{0} > 0$。\n- 假设晶粒在其整个演化过程中保持圆形。\n- 所有其他物理效应，如三重结、储存能、溶质拖曳和各向异性，均被忽略。\n- 任务是推导出 $R(t)$ 的常微分方程（ODE），并求解总坍塌时间 $t_{c}$。\n\n步骤2：验证。\n该问题具有科学依据。动力学关系 $v_{n} \\propto \\kappa$ 是曲率驱动晶界运动的经典模型，由 Mullins 首次提出。该问题是材料物理学中的一个经典理想化模型，用于建立晶粒粗化的基本标度律。该问题是适定的，提供了明确的动力学定律、几何形状和初始条件，从而可以得到唯一解。语言客观而精确。所有必需的常数和关系都已提供。给定的单位在量纲上是一致的：乘积 $M\\gamma$ 的单位是 $(\\frac{\\mathrm{m}^3}{\\mathrm{J}\\cdot\\mathrm{s}}) \\cdot (\\frac{\\mathrm{J}}{\\mathrm{m}}) = \\frac{\\mathrm{m}^2}{\\mathrm{s}}$。那么乘积 $M \\gamma \\kappa$ 的单位是 $(\\frac{\\mathrm{m}^2}{\\mathrm{s}}) \\cdot (\\frac{1}{\\mathrm{m}}) = \\frac{\\mathrm{m}}{\\mathrm{s}}$，这是速度的正确单位。因此，该问题被验证为物理学中一个有效、自洽且可解的问题。\n\n步骤3：求解。\n目标是找到初始半径为 $R_{0}$ 的晶粒完全消失的时间 $t_{c}$。\n\n晶界的法向速度 $v_n$ 是晶界沿其法线方向移动的速率。问题陈述单位法向量指向晶粒内部。收缩意味着半径 $R(t)$ 随时间减小。因此，正的速度 $v_{n}$ 对应于半径变化率为负值。这个几何关系表示为：\n$$\nv_{n} = -\\frac{dR(t)}{dt}\n$$\n这里的负号是必不可少的；它正确地将晶界的向内运动（$v_{n} > 0$）与晶粒半径的减小（$\\frac{dR}{dt}  0$）联系起来。\n\n问题给出了控制该速度的动力学定律：\n$$\nv_{n} = M \\gamma \\kappa\n$$\n对于半径为 $R(t)$ 的二维圆形晶粒，曲率 $\\kappa$ 如下所示：\n$$\n\\kappa(t) = \\frac{1}{R(t)}\n$$\n将 $v_n$ 和 $\\kappa(t)$ 的表达式代入动力学定律，我们得到半径 $R(t)$ 的控制常微分方程：\n$$\n-\\frac{dR}{dt} = M \\gamma \\frac{1}{R}\n$$\n该方程可以重写为更标准的形式：\n$$\n\\frac{dR}{dt} = -\\frac{M\\gamma}{R}\n$$\n这是一个一阶可分离微分方程。我们通过分离变量 $R$ 和 $t$ 来求解它：\n$$\nR \\, dR = -M \\gamma \\, dt\n$$\n现在，我们对该方程两边进行积分。半径 $R$ 的积分区间是从其在时间 $t=0$ 时的初始值 $R(0) = R_{0}$ 到在任意时间 $t$ 时的值 $R(t)$。时间的积分区间是从 $t=0$ 到 $t$。\n$$\n\\int_{R_{0}}^{R(t)} R' \\, dR' = \\int_{0}^{t} -M \\gamma \\, dt'\n$$\n常数 $M$ 和 $\\gamma$ 可以移到右侧积分号的外面。\n$$\n\\int_{R_{0}}^{R(t)} R' \\, dR' = -M \\gamma \\int_{0}^{t} dt'\n$$\n进行积分得到：\n$$\n\\left[ \\frac{(R')^2}{2} \\right]_{R_{0}}^{R(t)} = -M \\gamma \\left[ t' \\right]_{0}^{t}\n$$\n$$\n\\frac{R(t)^2}{2} - \\frac{R_{0}^2}{2} = -M \\gamma (t - 0)\n$$\n$$\nR(t)^2 - R_{0}^2 = -2 M \\gamma t\n$$\n这给出了半径的平方随时间的变化关系。求解 $R(t)^2$：\n$$\nR(t)^2 = R_{0}^2 - 2 M \\gamma t\n$$\n坍塌时间 $t_{c}$ 定义为晶粒消失的时间，即其半径变为零的时间。我们设 $R(t_{c}) = 0$。\n$$\n0^2 = R_{0}^2 - 2 M \\gamma t_{c}\n$$\n现在我们解这个代数方程求 $t_{c}$：\n$$\n2 M \\gamma t_{c} = R_{0}^2\n$$\n$$\nt_{c} = \\frac{R_{0}^2}{2 M \\gamma}\n$$\n这是坍塌时间的最终解析表达式。问题要求在给定 $\\gamma$ 和 $M$ 的SI单位的情况下，答案应以秒为单位。我们之前的量纲分析已经证实，得到的结果单位确实是秒。", "answer": "$$\n\\boxed{\\frac{R_{0}^{2}}{2 M \\gamma}}\n$$", "id": "2826936"}, {"introduction": "在理解了单个晶粒的动力学行为之后，我们将目光投向由大量晶粒组成的真实多晶体材料。这个练习 [@problem_id:2522862] 引导我们运用标度律分析，将微观的晶界运动定律推广至宏观尺度，从而推导出描述平均晶粒尺寸随时间演化的唯象模型。掌握这种从微观物理到宏观材料行为的“升尺度”思想，是材料科学家分析和预测材料性能演变的核心技能。", "problem": "一种致密的、单相的、多晶陶瓷在恒定温度下进行等温退火，在此温度下，晶界能是各向同性且恒定的，晶界迁移率也是恒定的。正常晶粒长大以统计自相似的方式进行。使用以下基本原理：\n\n- 晶界迁移的驱动压力是曲率引起的毛细管压力，其法向速度由 $v_{n} = M_{b}\\,\\gamma\\,\\kappa$ 给出，其中 $M_{b}$ 是晶界迁移率，$\\gamma$ 是单位面积的晶界能，$\\kappa$ 是平均曲率。\n- 在一个自相似的、各向同性的晶粒网络中，特征平均曲率与特征晶粒尺寸成反比，因此 $\\kappa \\sim \\alpha/G$，其中 $\\alpha$ 是一个量级为1的无量纲几何因子。\n- 特征晶粒尺寸 $G$ 的变化率与法向晶界速度成正比，即 $dG/dt \\sim \\beta\\,v_{n}$，其中 $\\beta$ 是一个量级为1的无量纲几何因子，它包含了拓扑和形状因素。\n\n严格地从这些基本原理出发，推导由迁移率限制的正常晶粒长大过程中特征晶粒尺寸 $G(t)$ 的时间依赖关系，并证明其可以写成一种定义了有效晶粒长大常数 $K$ 的形式（该常数可用 $M_{b}$、$\\gamma$ 和几何因子表示）。然后，在一个固定的退火温度下，测得有效晶粒长大常数为 $K = 2 \\times 10^{-18}\\,\\mathrm{m^{2}/s}$，求平均晶粒尺寸从 $G_{0} = 5\\,\\mu\\mathrm{m}$ 增长到 $G = 10\\,\\mu\\mathrm{m}$ 所需的时间。\n\n用秒表示您的最终数值答案，并四舍五入到三位有效数字。", "solution": "问题陈述已经过验证，被认为是科学上合理、表述清晰且客观的。它提出了一个材料科学动力学中的标准问题。\n\n推导从所提供的三个基本原理开始：\n1. 晶界法向速度 $v_{n}$ 与平均曲率 $\\kappa$ 成正比：\n$$v_{n} = M_{b}\\,\\gamma\\,\\kappa$$\n其中 $M_{b}$ 是晶界迁移率，$\\gamma$ 是单位面积的晶界能。\n\n2. 对于统计自相似的晶粒结构，特征平均曲率 $\\kappa$ 与特征晶粒尺寸 $G$ 成反比：\n$$\\kappa = \\frac{\\alpha}{G}$$\n其中 $\\alpha$ 是一个量级为1的无量纲几何常数。\n\n3. 特征晶粒尺寸的变化率与晶界速度成正比：\n$$\\frac{dG}{dt} = \\beta\\,v_{n}$$\n其中 $\\beta$ 是另一个量级为1的无量纲几何和拓扑常数。\n\n我们结合这些关系来推导晶粒长大的控制微分方程。首先，将第二个基本原理中 $\\kappa$ 的表达式代入第一个原理中：\n$$v_{n} = M_{b}\\,\\gamma\\,\\left(\\frac{\\alpha}{G}\\right) = \\frac{\\alpha M_{b} \\gamma}{G}$$\n\n接下来，将这个 $v_{n}$ 的表达式代入第三个基本原理中：\n$$\\frac{dG}{dt} = \\beta \\left( \\frac{\\alpha M_{b} \\gamma}{G} \\right) = \\frac{\\alpha \\beta M_{b} \\gamma}{G}$$\n\n该方程描述了平均晶粒尺寸的变化率作为其自身尺寸的函数。为了求出时间依赖关系 $G(t)$，我们必须解这个可分离的一阶常微分方程。我们重新排列各项以分离变量 $G$ 和 $t$：\n$$G \\, dG = (\\alpha \\beta M_{b} \\gamma) \\, dt$$\n\n我们对该方程两边进行积分。晶粒尺寸从时间 $t=0$ 时的初始尺寸 $G_{0}$ 演变到稍后时间 $t$ 时的尺寸 $G$。\n$$\\int_{G_{0}}^{G} G' \\, dG' = \\int_{0}^{t} (\\alpha \\beta M_{b} \\gamma) \\, dt'$$\n\n鉴于 $M_{b}$ 和 $\\gamma$ 是常数，并且对于自相似的生长过程，几何因子 $\\alpha$ 和 $\\beta$ 也是常数，因此右侧项是一个常数。积分得到：\n$$\\left[ \\frac{1}{2} (G')^{2} \\right]_{G_{0}}^{G} = (\\alpha \\beta M_{b} \\gamma) [t']_{0}^{t}$$\n$$\\frac{1}{2} G^{2} - \\frac{1}{2} G_{0}^{2} = (\\alpha \\beta M_{b} \\gamma) t$$\n\n这个方程可以重写为：\n$$G^{2} - G_{0}^{2} = 2 (\\alpha \\beta M_{b} \\gamma) t$$\n\n这就是典型的抛物线型晶粒长大定律，其中晶粒长大指数 $n=2$。题目要求定义一个有效的晶粒长大常数 $K$。通常将该定律写为 $G^{2} - G_{0}^{2} = K t$。通过将此形式与我们推导出的结果进行比较，我们可以将有效晶粒长大常数 $K$ 定义为：\n$$K = 2 \\alpha \\beta M_{b} \\gamma$$\n$K$ 的单位是长度的平方除以时间（例如 $\\mathrm{m^{2}/s}$），这与题目中提供的值一致。\n\n现在，我们进行计算。题目要求我们求出在有效晶粒长大常数 $K = 2 \\times 10^{-18}\\,\\mathrm{m^{2}/s}$ 的条件下，平均晶粒尺寸从 $G_{0} = 5\\,\\mu\\mathrm{m}$ 增长到 $G = 10\\,\\mu\\mathrm{m}$ 所需的时间 $t$。\n\n我们重新整理晶粒长大方程以求解 $t$：\n$$t = \\frac{G^{2} - G_{0}^{2}}{K}$$\n\n在代入数值之前，我们必须确保单位一致。常数 $K$ 的单位是国际单位制单位（$\\mathrm{m^{2}/s}$），因此我们必须将晶粒尺寸从微米（$\\mu\\mathrm{m}$）转换为米（$\\mathrm{m}$）。\n$$G_{0} = 5\\,\\mu\\mathrm{m} = 5 \\times 10^{-6}\\,\\mathrm{m}$$\n$$G = 10\\,\\mu\\mathrm{m} = 10 \\times 10^{-6}\\,\\mathrm{m} = 1 \\times 10^{-5}\\,\\mathrm{m}$$\n\n现在我们将这些值代入 $t$ 的方程中：\n$$t = \\frac{(1 \\times 10^{-5}\\,\\mathrm{m})^{2} - (5 \\times 10^{-6}\\,\\mathrm{m})^{2}}{2 \\times 10^{-18}\\,\\mathrm{m^{2}/s}}$$\n$$t = \\frac{1 \\times 10^{-10}\\,\\mathrm{m^{2}} - 25 \\times 10^{-12}\\,\\mathrm{m^{2}}}{2 \\times 10^{-18}\\,\\mathrm{m^{2}/s}}$$\n为了简化分子，我们将两项表示为相同的10的幂：\n$$1 \\times 10^{-10}\\,\\mathrm{m^{2}} = 100 \\times 10^{-12}\\,\\mathrm{m^{2}}$$\n$$t = \\frac{100 \\times 10^{-12}\\,\\mathrm{m^{2}} - 25 \\times 10^{-12}\\,\\mathrm{m^{2}}}{2 \\times 10^{-18}\\,\\mathrm{m^{2}/s}}$$\n$$t = \\frac{75 \\times 10^{-12}\\,\\mathrm{m^{2}}}{2 \\times 10^{-18}\\,\\mathrm{m^{2}/s}}$$\n$$t = 37.5 \\times 10^{6}\\,\\mathrm{s}$$\n\n题目要求答案以科学记数法表示，并四舍五入到三位有效数字。我们将结果表示为标准科学记数法：\n$$t = 3.75 \\times 10^{7}\\,\\mathrm{s}$$\n这个值已经用三位有效数字表示。", "answer": "$$\n\\boxed{3.75 \\times 10^{7}}\n$$", "id": "2522862"}, {"introduction": "真实的材料微观结构并非由单一尺寸的晶粒构成，而是呈现出一定的尺寸分布。本练习 [@problem_id:2826919] 将我们带入计算材料科学的前沿，要求你将理论分布模型与模拟数据进行拟合。你将学习如何运用最大似然估计以及赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 等统计学工具，来严谨地判断哪种理论模型能更好地描述晶粒尺寸分布，这是现代材料表征与分析中的一项关键实践。", "problem": "您在材料物理学领域接到一个关于晶粒长大和粗化的任务，需要将两个相互竞争的参数模型拟合到归一化晶粒尺寸的直方图上，并使用有原则的统计标准来决定哪个模型是更好的描述符。归一化晶粒尺寸定义为 $x = r / \\langle r \\rangle$，其中 $r$ 是晶粒尺寸，$\\langle r \\rangle$ 是系综平均值。两个候选模型是：\n\n- 一个均值为1的对数正态分布，以及\n- 一个受正常晶粒长大自相似稳态启发的 Hillert 型有限支撑分布，此处建模为一个同样强制单位均值的缩放 Beta 族。\n\n您的程序必须：\n\n1) 通过最大化分箱数据似然（等效于最小化负对数似然），将每个模型拟合到提供的 $x$ 值直方图，并遵循每个模型的单位均值约束。\n\n2) 为每个拟合模型计算赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC)。\n\n3) 根据每个准则分别判断哪个模型更优，并报告每个直方图的结果。\n\n使用的基本定义和约束：\n\n- 对数正态模型。令 $X$ 为对数正态分布，$X \\sim \\mathrm{Lognormal}(\\mu,\\sigma)$，其概率密度函数为\n$$\nf_{\\mathrm{LN}}(x \\mid \\mu,\\sigma) = \\frac{1}{x \\,\\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(\\ln x - \\mu)^2}{2\\sigma^2}\\right), \\quad x0.\n$$\n其均值为 $\\mathbb{E}[X] = \\exp(\\mu + \\tfrac{1}{2}\\sigma^2)$。强制单位均值约束 $\\mathbb{E}[X]=1$，这意味着 $\\mu = -\\tfrac{1}{2}\\sigma^2$。因此，对数正态模型只有一个自由参数 $\\sigma  0$。其累积分布函数为\n$$\nF_{\\mathrm{LN}}(x \\mid \\sigma) = \\tfrac{1}{2}\\left[1 + \\operatorname{erf}\\!\\left(\\frac{\\ln x + \\tfrac{1}{2}\\sigma^2}{\\sigma \\sqrt{2}}\\right)\\right], \\quad x  0,\n$$\n且对于 $x \\le 0$，$F_{\\mathrm{LN}}(x \\mid \\sigma) = 0$。\n\n- Hillert 型模型。受 Hillert 的稳态正常晶粒长大理论启发，该理论具有紧支撑且在低 $x$ 区域的行为与 $x^2$ 成正比，我们考虑一个缩放的 Beta 族，其低 $x$ 指数固定，尾部指数可调，\n$$\nf_{\\mathrm{HT}}(x \\mid \\gamma) = \\frac{1}{x_c\\, B(3,\\gamma)} \\left(\\frac{x}{x_c}\\right)^{3-1}\\!\\left(1 - \\frac{x}{x_c}\\right)^{\\gamma-1}, \\quad 0  x  x_c,\n$$\n在其他情况下 $f_{\\mathrm{HT}}(x \\mid \\gamma)=0$。此处 $B(\\cdot,\\cdot)$ 是贝塔函数，形状参数 $\\gamma  0$ 控制接近截断值的尾部行为，$x_c$ 是截断值。通过选择以下方式强制单位均值约束\n$$\nx_c = \\frac{3 + \\gamma}{3},\n$$\n因为对于区间 $[0,x_c]$ 上参数为 $(3,\\gamma)$ 的贝塔分布，其均值为 $x_c \\cdot \\frac{3}{3+\\gamma}$。因此，Hillert 型模型只有一个自由参数 $\\gamma  0$。其累积分布函数可以通过正则化不完全贝塔函数 $I_y(a,b)$ 写为\n$$\nF_{\\mathrm{HT}}(x \\mid \\gamma) = \n\\begin{cases}\n0,  x \\le 0,\\\\\nI_{x/x_c}(3,\\gamma),  0  x  x_c,\\\\\n1,  x \\ge x_c.\n\\end{cases}\n$$\n\n- 分箱数据似然。设直方图有 $K$ 个分箱，其边界为 $\\{e_0,\\ldots,e_K\\}$，整数计数为 $\\{n_0,\\ldots,n_{K-1}\\}$。对于一个累积分布函数为 $F(x \\mid \\theta)$ 的模型，定义分箱概率\n$$\np_i(\\theta) = F(e_{i+1}\\mid \\theta) - F(e_i \\mid \\theta), \\quad i=0,\\ldots,K-1.\n$$\n假设计数是由总数为 $N=\\sum_i n_i$ 的多项模型生成的独立同分布样本，则对数似然（不考虑在信息准则比较中会抵消的加性组合常数）为\n$$\n\\ell(\\theta) = \\sum_{i=0}^{K-1} n_i \\ln p_i(\\theta).\n$$\n您必须通过相对于每个模型的单个参数 $\\theta$ 最大化 $\\ell(\\theta)$ 来计算最大似然估计 (MLE)：对于对数正态模型，$\\theta=\\sigma$ 且 $\\sigma > 0$；对于 Hillert 型模型，$\\theta=\\gamma$ 且 $\\gamma > 0$。\n\n- 模型选择准则。对于一个具有 $k$ 个自由参数（此处两个模型均为 $k=1$）且在 MLE 处的对数似然等于 $\\ell^\\star$ 的拟合模型，定义\n$$\n\\mathrm{AIC} = 2k - 2\\ell^\\star, \\quad \\mathrm{BIC} = k \\ln N - 2\\ell^\\star.\n$$\n值越小表示模型越优。您必须分别根据 AIC 和 BIC 选择更优的模型。\n\n测试套件和直方图构建：\n\n- 所有测试用例使用相同的分箱边界。设 $K = 60$，$e_0 = 10^{-3}$，$e_K = 5$，并定义均匀边界\n$$\ne_j = e_0 + j \\Delta, \\quad \\Delta = \\frac{e_K - e_0}{K}, \\quad j=0,1,\\ldots,K.\n$$\n\n- 对于每个测试用例，按规定生成 $N$ 个独立的 $x$ 样本，使用边界 $\\{e_j\\}$ 形成直方图计数 $\\{n_i\\}$，然后丢弃原始样本（只保留计数）。底层的生成器是：\n\n1. 测试用例 A（理想情况，对数正态）：从参数为 $\\sigma = 0.4$ 和 $\\mu = -\\tfrac{1}{2}\\sigma^2$（以强制 $\\mathbb{E}[X]=1$）的对数正态模型中抽取 $N = 200{,}000$ 个样本。使用固定的伪随机种子 $s = 1337$。\n\n2. 测试用例 B（理想情况，Hillert 型）：从参数为 $\\gamma = 4.0$ 和 $x_c = \\tfrac{3+\\gamma}{3}$ 的 Hillert 型模型中抽取 $N = 200{,}000$ 个样本。使用种子 $s = 2023$。\n\n3. 测试用例 C（边界条件：非常窄的对数正态）：从参数为 $\\sigma = 0.15$ 和 $\\mu = -\\tfrac{1}{2}\\sigma^2$ 的对数正态模型中抽取 $N = 200{,}000$ 个样本。使用种子 $s = 2468$。\n\n4. 测试用例 D（边缘案例：软尾 Hillert 型）：从参数为 $\\gamma = 1.0$ 和 $x_c = \\tfrac{3+\\gamma}{3}$ 的 Hillert 型模型中抽取 $N = 200{,}000$ 个样本。使用种子 $s = 86420$。\n\n所有 $x$ 都是无量纲的（它们通过均值进行了归一化），因此输出中不需要物理单位。\n\n对于每个测试用例，您的程序必须通过最大化分箱数据对数似然来拟合两个模型（相对于各自的单个自由参数），计算 $\\mathrm{AIC}$ 和 $\\mathrm{BIC}$，然后为每个测试用例输出一对整数 $[a,b]$，定义如下：\n\n- 如果对数正态模型的 $\\mathrm{AIC}$ 更小，则 $a = 0$，否则 $a = 1$。\n- 如果对数正态模型的 $\\mathrm{BIC}$ 更小，则 $b = 0$，否则 $b = 1$。\n\n最终输出格式：\n\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应测试用例的 $[a,b]$ 对，顺序为 A、B、C、D。例如：$[[0,1],[0,0],[0,1],[1,1]]$。\n\n注意：\n\n- 所有决策都必须源于分箱数据的最大似然框架。不允许使用启发式曲线拟合。\n- 不使用角度；无需指定角度单位。\n- 通过避免 $\\ln 0$ 的贡献来确保数值稳定性；这可以通过从对数求和中排除计数为零的分箱，或通过将分箱概率的下界设为一个小的正常数来实现。", "solution": "该问题要求使用分箱实验数据，对归一化晶粒尺寸分布的两个竞争模型（对数正态模型和 Hillert 型模型）进行统计比较。主要任务是根据赤池信息准则（$\\mathrm{AIC}$）和贝叶斯信息准则（$\\mathrm{BIC}$），确定哪个模型能更好地描述四个不同的数据集。该问题是良定义的、有科学依据的，并为得出唯一解提供了所有必要信息。\n\n解决方案的核心是分箱数据的最大似然估计（$\\mathrm{MLE}$）原理。每个测试用例的数据包含一个有 $K$ 个分箱的直方图，其计数为 $\\{n_0, n_1, \\ldots, n_{K-1}\\}$，观测总数为 $N = \\sum_{i=0}^{K-1} n_i$。此设置可被多项分布正确建模。对数似然函数（不考虑与优化和模型比较无关的常数项）由下式给出\n$$\n\\ell(\\theta) = \\sum_{i=0}^{K-1} n_i \\ln p_i(\\theta),\n$$\n其中 $\\theta$ 表示模型参数，$p_i(\\theta)$ 是一个观测值落入第 $i$ 个分箱的概率，定义为 $p_i(\\theta) = F(e_{i+1} \\mid \\theta) - F(e_i \\mid \\theta)$。此处，$F(x \\mid \\theta)$ 是模型的累积分布函数（$\\mathrm{CDF}$），$\\{e_i\\}$ 是分箱边界。$n_i=0$ 的项对求和没有贡献，因此在计算中被忽略。\n\n该过程对每个数据集包括以下步骤：\n\n1.  **模型设定**：两个候选模型都约束为均值为1，这使每个模型都简化为单参数族。\n    *   **对数正态模型**：单位均值约束 $\\mathbb{E}[X]=1$ 对对数正态分布 $X \\sim \\mathrm{Lognormal}(\\mu, \\sigma)$ 意味着关系 $\\mu = -\\frac{1}{2}\\sigma^2$。因此，该模型由单个自由参数 $\\sigma  0$ 描述。其 $\\mathrm{CDF}$ 为\n        $$\n        F_{\\mathrm{LN}}(x \\mid \\sigma) = \\frac{1}{2}\\left[1 + \\operatorname{erf}\\!\\left(\\frac{\\ln x + \\frac{1}{2}\\sigma^2}{\\sigma \\sqrt{2}}\\right)\\right].\n        $$\n    *   **Hillert 型模型**：此模型是一个缩放的 Beta 分布。单位均值约束通过 $x_c = (3 + \\gamma)/3$ 将其截断参数 $x_c$ 与其形状参数 $\\gamma$ 联系起来。该模型由单个自由参数 $\\gamma  0$ 描述。其 $\\mathrm{CDF}$ 由正则化不完全贝塔函数 $I_y(a,b)$ 给出：\n        $$\n        F_{\\mathrm{HT}}(x \\mid \\gamma) = I_{x/x_c}(3, \\gamma).\n        $$\n\n2.  **最大似然估计**：对于每个模型，我们必须找到参数值（$\\sigma_{\\mathrm{MLE}}$ 或 $\\gamma_{\\mathrm{MLE}}$）以最大化对数似然函数 $\\ell(\\theta)$。这等效于最小化负对数似然 $-\\ell(\\theta)$。这是一个一维数值优化问题，将使用有界优化算法（带方法 `'bounded'` 的 `scipy.optimize.minimize_scalar`）来求解，以找到最大似然估计和相应的最大对数似然值 $\\ell^\\star$。参数域为 $\\sigma  0$ 和 $\\gamma  0$。\n\n3.  **模型选择**：在为每个模型确定了最大化对数似然 $\\ell^\\star$ 后，我们计算 $\\mathrm{AIC}$ 和 $\\mathrm{BIC}$。这些准则对模型复杂性进行惩罚以防止过拟合。对于一个有 $k$ 个自由参数的模型，定义如下：\n    $$\n    \\mathrm{AIC} = 2k - 2\\ell^\\star \\\\\n    \\mathrm{BIC} = k \\ln N - 2\\ell^\\star\n    $$\n    在这个问题中，两个模型都只有一个自由参数，因此对于对数正态和 Hillert 型模型，都有 $k=1$。$\\mathrm{AIC}$ 或 $\\mathrm{BIC}$ 值较小的模型被认为是更优的。\n\n一个关键的观察是，当比较两个具有相同参数数量（$k_1=k_2$）的模型时，$\\mathrm{AIC}$ 提供的排序将与 $\\mathrm{BIC}$ 提供的排序完全相同。具体来说，$\\mathrm{AIC}_1  \\mathrm{AIC}_2 \\iff 2k - 2\\ell_1^\\star  2k - 2\\ell_2^\\star \\iff \\ell_1^\\star > \\ell_2^\\star$。同样地，$\\mathrm{BIC}_1  \\mathrm{BIC}_2 \\iff k \\ln N - 2\\ell_1^\\star  k \\ln N - 2\\ell_2^\\star \\iff \\ell_1^\\star > \\ell_2^\\star$。因此，选择更优的模型完全取决于哪个模型能获得更高的最大化对数似然 $\\ell^\\star$。因此，每个测试用例的输出对 $[a,b]$ 必须是 $[0,0]$ 或 $[1,1]$。\n\n实现过程首先按规定生成四个数据集，使用给定的种子以确保可复现性。为每个数据集计算一个计数直方图。然后，对每个直方图，最小化两个模型的负对数似然函数以找到 $\\ell_{\\mathrm{LN}}^\\star$ 和 $\\ell_{\\mathrm{HT}}^\\star$。最后，比较这些似然值以确定两个准则的获胜模型，并按要求格式化输出。所需的特殊函数，即误差函数 `erf` 和正则化不完全贝塔函数 `betainc`，可在 `scipy.special` 中找到。", "answer": "```\n[[0,0],[1,1],[0,0],[1,1]]\n```", "id": "2826919"}]}