{"hands_on_practices": [{"introduction": "铁磁性源于强大的量子力学交换相互作用。虽然像交换积分$J$这样的微观参数是基础，但将这种相互作用概念化为一个巨大的内部磁场——即魏斯交换场——通常更直观。本练习（[@problem_id:2865526]）提供了一种动手计算方法来估算该场的量级，揭示了为何在决定材料的磁序时，交换相互作用远超典型的外部磁场。", "problem": "一个简单立方晶格上的三维铁磁体通过各向同性海森堡交换作用和与均匀磁场的塞曼耦合来建模。最近邻之间的哈密顿量的交换部分取为 $-J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$，其中 $J0$ 有利于平行排列，$\\langle i j \\rangle$ 表示最近邻对。考虑零温、完全对齐的状态，其中每个自旋的大小为 $S$ 且所有邻居都平行。使用单个自旋在磁场中的塞曼能量 $-g \\mu_B \\mathbf{S} \\cdot \\mathbf{H}$，通过将每个自旋的交换能与等效的塞曼能量相匹配，来估算有效 Weiss 交换场 $H_{\\mathrm{ex}}$ 的大小。然后，对于配位数 $z=6$ 的简单立方晶格、自旋量子数 $S=1$、Landé 因子 $g=2$ 以及由 $J/k_B=10\\,\\mathrm{K}$ 指定的交换常数 $J$（Boltzmann 常数 $(k_B)$ 和 Bohr 磁子 $(\\mu_B)$ 如下给出），计算无量纲比值\n$$\nr \\equiv \\frac{H_{\\mathrm{ex}}}{1\\,\\mathrm{T}} .\n$$\n使用 $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ 和 $\\mu_B = 9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$。将最终比值 $r$ 报告为一个纯数，四舍五入到三位有效数字。将您计算的任何中间场以特斯拉为单位表示，但只有比值 $r$ 会被评分。\n\n最后，根据 $r$ 的大小，简要论证在居里温度 $(T_C)$ 附近及以下，哪种场标度主要决定了自发磁化强度 $M_s(T)$ 对温度的依赖性。您的定性论证将不被评分；只有 $r$ 的数值会被评分。", "solution": "该问题要求计算海森堡铁磁体的有效 Weiss 交换场 $H_{\\mathrm{ex}}$，以及随后的无量纲比值 $r$。此计算的基础是平均场理论，其中单个磁矩与其所有邻居的相互作用被替换为与这些邻居产生的平均（或“均”）场的相互作用。\n\n首先，我们考虑单个自旋的交换能，我们用索引 $i$ 标记它。根据所给的哈密顿量 $H_{\\mathrm{exch}} = -J \\sum_{\\langle k l \\rangle} \\mathbf{S}_k \\cdot \\mathbf{S}_l$，涉及自旋 $\\mathbf{S}_i$ 的能量部分是由于它与其 $z$ 个最近邻（用索引 $j$ 表示）的相互作用：\n$$\nE_{\\mathrm{exch}, i} = -J \\mathbf{S}_i \\cdot \\sum_{j \\in \\text{n.n.}} \\mathbf{S}_j\n$$\n在平均场近似中，与每个相邻自旋算符 $\\mathbf{S}_j$ 的显式相互作用被替换为与其统计平均值 $\\langle \\mathbf{S} \\rangle$ 的相互作用。因此，自旋 $i$ 的平均场能量为：\n$$\nE_{\\mathrm{MF}, i} = -J \\mathbf{S}_i \\cdot \\sum_{j \\in \\text{n.n.}} \\langle \\mathbf{S} \\rangle = -z J (\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle)\n$$\n问题指定了零温（$T=0\\,\\mathrm{K}$）极限，此时系统处于完全对齐的铁磁态。在此基态下，任何自旋的期望值 $\\langle \\mathbf{S} \\rangle$ 是一个沿磁化方向的矢量，其大小由自旋量子数 $S$ 给出。因此，点积 $\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle$ 可以经典地处理为 $S \\cdot S \\cos(0) = S^2$。然而，更严谨的推导来自于等同算符形式。\n\n有效 Weiss 交换场 $\\mathbf{H}_{\\mathrm{ex}}$ 被定义为能产生等效塞曼能量的磁场。自旋 $\\mathbf{S}_i$ 在此有效场中的塞曼能量为：\n$$\nE_{\\mathrm{Z}, i} = -g \\mu_B \\mathbf{S}_i \\cdot \\mathbf{H}_{\\mathrm{ex}}\n$$\n其中 $g$ 是 Landé g-因子，$\\mu_B$ 是 Bohr 磁子。\n\n通过将平均场交换能表达式与等效塞曼能量表达式相等，我们建立了 $\\mathbf{H}_{\\mathrm{ex}}$ 的定义：\n$$\n-z J (\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle) = -g \\mu_B \\mathbf{S}_i \\cdot \\mathbf{H}_{\\mathrm{ex}}\n$$\n这意味着场和平均自旋之间有以下关系：\n$$\ng \\mu_B \\mathbf{H}_{\\mathrm{ex}} = z J \\langle \\mathbf{S} \\rangle\n$$\n为了找到大小 $H_{\\mathrm{ex}}$，我们考虑矢量的大小。在零温下，$\\langle \\mathbf{S} \\rangle$ 的大小是 $S$。这得出：\n$$\ng \\mu_B H_{\\mathrm{ex}} = z J S\n$$\n由此，我们推导出 $H_{\\mathrm{ex}}$ 的表达式：\n$$\nH_{\\mathrm{ex}} = \\frac{z J S}{g \\mu_B}\n$$\n现在，我们必须代入问题陈述中提供的数值：\n- 简单立方晶格的配位数：$z=6$。\n- 自旋量子数：$S=1$。\n- Landé g-因子：$g=2$。\n- 相对于 Boltzmann 常数的交换常数：$J/k_B = 10\\,\\mathrm{K}$。这给出 $J = 10 \\times k_B$。\n- Boltzmann 常数：$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- Bohr 磁子：$\\mu_B = 9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$。\n\n将这些值代入 $H_{\\mathrm{ex}}$ 的公式：\n$$\nH_{\\mathrm{ex}} = \\frac{6 \\times (10 \\times 1.380649 \\times 10^{-23}\\,\\mathrm{J}) \\times 1}{2 \\times (9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}})}\n$$\n$$\nH_{\\mathrm{ex}} = \\frac{8.283894 \\times 10^{-22}\\,\\mathrm{J}}{1.85480201566 \\times 10^{-23}\\,\\mathrm{J\\,T^{-1}}}\n$$\n$$\nH_{\\mathrm{ex}} \\approx 44.6622\\,\\mathrm{T}\n$$\n问题要求计算无量纲比值 $r$，定义为 $r \\equiv \\frac{H_{\\mathrm{ex}}}{1\\,\\mathrm{T}}$。\n$$\nr = \\frac{44.6622\\,\\mathrm{T}}{1\\,\\mathrm{T}} \\approx 44.6622\n$$\n按要求将此结果四舍五入到三位有效数字：\n$$\nr \\approx 44.7\n$$\n作为对最后一个不评分问题的简要论证：这个内部交换场的大小 $H_{\\mathrm{ex}} \\approx 45\\,\\mathrm{T}$，与典型的外部施加磁场（通常在 $1\\,\\mathrm{T}$ 的量级）相比是巨大的。在居里温度 $T_C$ 以下存在自发磁化强度 $M_s(T)$ 是由于这种强大的量子力学交换相互作用。$M_s(T)$ 的行为由这个巨大内场的有序化效应与热能 $k_B T$ 的无序化效应之间的平衡决定。因此，主要是交换场标度，而不是任何典型外部实验室磁场的标度，决定了自发磁化强度的温度依赖性。", "answer": "$$\n\\boxed{44.7}\n$$", "id": "2865526"}, {"introduction": "在理解了铁磁性的基本能量尺度后，我们将注意力转向相变温度$T_C$附近的行为。朗道理论为描述二级相变提供了一个强大的宏观唯象框架，它基于对称性论证，而无需详尽的微观细节。本练习（[@problem_id:1808228]）将指导你推导该理论的抽象参数与具体的实验可观测量（自发磁化强度和磁化率）之间的关系，展示了如何验证和应用唯象模型。", "problem": "一位材料物理学家正在研究一种新合成的铁磁材料，该材料表现出从顺磁态到铁磁态的二级相变。基于对称性论证，该物理学家使用朗道展开将材料在其临界温度 $T_C$ 附近的亥姆霍兹自由能密度 $F$ 建模为磁化强度 $M$ 和温度 $T$ 的函数：\n$$F(M, T) = F_0(T) + a(T - T_C)M^2 + bM^4$$\n其中 $F_0(T)$ 是自由能的非磁性部分，而 $a$ 和 $b$ 是该材料特有的正常数。系统处于热平衡状态，因此其磁化强度将取使自由能最小化的值。\n\n在没有任何外部磁场的情况下，进行了两个关键实验：\n1.  将材料冷却到温度 $T_1 = T_C - \\Delta T$，其中 $\\Delta T$ 是一个小的正温差。在此温度下，测得自发磁化强度的大小为 $M_1$。\n2.  使用相同的温差 $\\Delta T$，将材料加热到温度 $T_2 = T_C + \\Delta T$。在此温度下，测得零场磁化率 $\\chi_2$，其定义为 $\\chi = \\left( \\frac{\\partial M}{\\partial H} \\right)_{H=0}$。\n\n您的任务是根据测得的量 $M_1$ 和 $\\chi_2$ 来确定材料常数 $b$ 的表达式。", "solution": "在固定温度和零外场下，平衡磁化强度使朗道自由能密度最小化。平稳条件由下式得出\n$$\n\\frac{\\partial F}{\\partial M}=2a(T-T_{C})M+4bM^{3}=0.\n$$\n这给出了 $M=0$ 或\n$$\nM^{2}=-\\frac{a(T-T_{C})}{2b}=\\frac{a(T_{C}-T)}{2b}\n$$\n的解。\n\n对于 $T  T_C$，M=0 解不稳定，非零解为自发磁化强度 $M_s(T)^2 = a(T_C-T)/(2b)$。在温度 $T_1 = T_C - \\Delta T$ 时，我们有：\n$$\nM_1^2 = \\frac{a(T_C - (T_C - \\Delta T))}{2b} = \\frac{a\\Delta T}{2b} \\quad (1)\n$$\n\n现在，为了计算磁化率 $\\chi = \\left( \\frac{\\partial M}{\\partial H} \\right)_{H=0}$，我们引入外场 H，吉布斯自由能为 $G = F - MH$。平衡条件是 $\\frac{\\partial G}{\\partial M} = \\frac{\\partial F}{\\partial M} - H = 0$，即：\n$$\nH = 2a(T-T_C)M + 4bM^3\n$$\n磁化率的倒数为：\n$$\n\\chi^{-1} = \\left( \\frac{\\partial H}{\\partial M} \\right)_{H \\to 0} = 2a(T-T_C) + 12bM^2\n$$\n\n在顺磁相 ($T  T_C$) 且 H 趋于零时，平衡磁化强度 M=0。因此，在温度 $T_2 = T_C + \\Delta T$ 时，我们有：\n$$\n\\chi_2^{-1} = 2a((T_C + \\Delta T) - T_C) = 2a\\Delta T \\quad (2)\n$$\n\n从式 (2) 中，我们得到 $a\\Delta T = \\frac{1}{2\\chi_2}$。\n\n将此结果代入式 (1) 中：\n$$\nM_1^2 = \\frac{1}{2\\chi_2} \\cdot \\frac{1}{2b} = \\frac{1}{4b\\chi_2}\n$$\n\n最后，求解材料常数 $b$：\n$$\nb = \\frac{1}{4\\chi_2 M_1^2}\n$$", "answer": "$$\\boxed{\\frac{1}{4\\,\\chi_{2}\\,M_{1}^{2}}}$$", "id": "1808228"}, {"introduction": "最后，我们探讨低温区，在该区域，平均场理论失效，而集体激发——即自旋波或磁振子——占据主导地位。描述低温下磁化强度温度依赖性的布洛赫$T^{3/2}$定律是该理论的基石。这项高级练习（[@problem_id:2865514]）模拟了一项完整的研究任务：从理论上推导可观测的布洛赫系数与基本的自旋波刚度$D$之间的关系，然后应用统计方法从实验数据中提取$D$及其不确定度，从而将理论、计算和数据分析联系起来。", "problem": "您的任务是开发一个完整的程序，该程序能从低温自发磁化数据中对自旋波刚度进行基于原理的推断。您的程序必须实现物理约束模型和统计上可靠的不确定性量化。目标是为一个三维各向同性铁磁体拟合低温自发磁化数据 $M_s(T)$ 到一个低温展开式，并从拟合系数中提取自旋波刚度，同时通过不确定性传播获得其置信区间。\n\n在您的推导和算法设计中，请使用以下基本依据：\n- 各向同性铁磁体中的自旋波激发具有长波色散关系 $\\,\\epsilon_{\\mathbf{k}} = D k^2\\,$，其中 $\\,D\\,$ 是自旋波刚度，$\\,k = \\lvert \\mathbf{k} \\rvert\\,$。\n- 玻色子的玻色-爱因斯坦分布 (BED) 为 $\\,n_{\\mathbf{k}} = 1/\\left(\\exp(\\beta \\epsilon_{\\mathbf{k}}) - 1\\right)\\,$，其中 $\\,\\beta = 1/(k_{\\mathrm{B}} T)\\,$，$\\,k_{\\mathrm{B}}\\,$ 是玻尔兹曼常数。\n- 每个磁振子使磁化强度减少 $\\,g \\mu_{\\mathrm{B}}\\,$，其中 $\\,g\\,$ 是朗德 $\\,g\\,$ 因子，$\\,\\mu_{\\mathrm{B}}\\,$ 是玻尔磁子；总减少量由在连续极限 $\\,\\int d^3 k/(2\\pi)^3\\,$ 下计算的磁振子数密度给出。\n- 在低温下，对 $\\,M_s(T)\\,$ 的领头修正是按 $\\,T^{3/2}\\,$ 变化的；由于磁振子-磁振子相互作用和其他高阶效应，可能会出现 $\\,T^{5/2}\\,$ 阶的次领头修正。\n\n基于此基础，推导低温形式\n- 对于足够小的 $\\,T\\,$，有 $\\,M_s(T) = M_s(0) - A\\,T^{3/2} - B\\,T^{5/2}\\,$，\n- 以及一个从色散关系和玻色-爱因斯坦分布得出的、$\\,A\\,$ 和 $\\,D\\,$ 之间的关系，不借助任何经验性捷径。\n\n然后实现以下计算过程：\n- 在独立同方差高斯噪声的假设下，使用普通最小二乘法将测量数据 $\\,\\{(T_i, M_i)\\}\\,$ 拟合到 $\\,M_i \\approx M_s(0) - A T_i^{3/2} - B T_i^{5/2}\\,$。从线性回归正规方程估计 $\\,M_s(0)\\,$、$\\,A\\,$ 和 $\\,B\\,$ 及其协方差矩阵。\n- 使用您推导出的解析关系 $\\,D = f(A)\\,$，从拟合系数 $\\,\\hat{A}\\,$ 计算估计值 $\\,\\hat{D}\\,$。使用一阶误差传播（delta方法）将不确定性从 $\\,\\hat{A}\\,$ 传播到 $\\,\\hat{D}\\,$，以获得一个 $\\,95\\,\\%$ 的置信区间。使用自由度为 $\\,\\nu = N - p\\,$ 的学生 $\\,t\\,$ 分布分位数，其中 $\\,N\\,$ 是数据点数量，$\\,p = 3\\,$ 是拟合参数的数量。\n\n常数和单位：\n- 使用国际单位制 (SI)。取 $\\,k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}\\,$，$\\,\\mu_{\\mathrm{B}} = 9.2740100783 \\times 10^{-24}\\,\\mathrm{A \\cdot m^2}\\,$，且 $\\,g = 2.0\\,$。所有磁化强度 $\\,M_s\\,$ 的单位为 $\\,\\mathrm{A/m}\\,$，温度 $\\,T\\,$ 的单位为 $\\,\\mathrm{K}\\,$，$\\,D\\,$ 必须以 $\\,\\mathrm{J \\cdot m^2}\\,$ 为单位报告。\n\n测试套件规范：\n- 您的程序必须内部生成三个合成数据集，使用模型 $\\,M_s(T) = M_s(0) - A_{\\mathrm{true}} T^{3/2} - B_{\\mathrm{true}} T^{5/2} + \\varepsilon\\,$ 和独立高斯噪声 $\\,\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)\\,$。对于每种情况，使用列出的 $\\,D_{\\mathrm{true}}\\,$ 和您推导出的 $\\,A\\!-\\!D\\,$ 关系计算 $\\,A_{\\mathrm{true}}\\,$。这三种情况是：\n  - 情况 $\\,1\\,$ (一般“顺利路径”)：$\\,M_s(0) = 1.70 \\times 10^6\\,\\mathrm{A/m}\\,$, $\\,D_{\\mathrm{true}} = 4.5 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}\\,$, $\\,B_{\\mathrm{true}} = 2.0 \\times 10^{-2}\\,\\mathrm{A \\cdot m^{-1} \\cdot K^{-5/2}}\\,$, $\\,T \\in [2,20]\\,\\mathrm{K}\\,$ 均匀分布的 $\\,N=25\\,$ 个点, 噪声标准差 $\\,\\sigma = 50\\,\\mathrm{A/m}\\,$, 随机种子 $\\,12345\\,$。\n  - 情况 $\\,2\\,$ (可忽略的次领头项)：$\\,M_s(0) = 8.00 \\times 10^5\\,\\mathrm{A/m}\\,$, $\\,D_{\\mathrm{true}} = 6.0 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}\\,$, $\\,B_{\\mathrm{true}} = 0\\,$, $\\,T \\in [2,12]\\,\\mathrm{K}\\,$ $\\,N=20\\,$ 个点, $\\,\\sigma = 30\\,\\mathrm{A/m}\\,$, 种子 $\\,24680\\,$。\n  - 情况 $\\,3\\,$ (边界情况：极低温窗口和较大噪声)：$\\,M_s(0) = 1.40 \\times 10^6\\,\\mathrm{A/m}\\,$, $\\,D_{\\mathrm{true}} = 3.0 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}\\,$, $\\,B_{\\mathrm{true}} = 1.0 \\times 10^{-2}\\,\\mathrm{A \\cdot m^{-1} \\cdot K^{-5/2}}\\,$, $\\,T \\in [2,6]\\,\\mathrm{K}\\,$ $\\,N=6\\,$ 个点, $\\,\\sigma = 80\\,\\mathrm{A/m}\\,$, 种子 $\\,13579\\,$。\n\n统计估计要求：\n- 通过最小化参数 $\\,M_s(0)\\,$、$\\,A\\,$、$\\,B\\,$ 线性模型的残差平方和来计算普通最小二乘估计。\n- 估计参数协方差矩阵为 $\\,\\hat{\\sigma}^2 (X^\\top X)^{-1}\\,$，其中 $\\,\\hat{\\sigma}^2 = \\mathrm{RSS}/(N-p)\\,$，$\\,X\\,$ 是设计矩阵，$\\,\\mathrm{RSS}\\,$ 是残差平方和。\n\n不确定性传播和置信区间：\n- 令 $\\,\\hat{D} = f(\\hat{A})\\,$ 为您的物理推导所隐含的 $\\,D\\,$ 的估计量。使用delta方法 $\\,\\mathrm{Var}[\\hat{D}] \\approx (f'(\\hat{A}))^2 \\mathrm{Var}[\\hat{A}]\\,$ 和双侧 $\\,95\\,\\%$ 置信区间 $\\,\\hat{D} \\pm t_{0.975,\\nu} \\sqrt{\\mathrm{Var}[\\hat{D}]}\\,$，其中 $\\,\\nu = N-p\\,$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，包含一个由三个列表组成的列表，每个列表对应一种情况，按情况 $\\,1\\,$, $\\,2\\,$, $\\,3\\,$ 的顺序排列。每个内部列表必须是 $[\\hat{D}, D_{\\mathrm{low}}, D_{\\mathrm{high}}]$，所有三个值的单位都为 $\\,\\mathrm{J \\cdot m^2}\\,$。所有数字均使用科学记数法表示，并保留 $\\,6\\,$ 位有效数字。确切要求的格式为单行：\n\"[ [d1,d1_lo,d1_hi],[d2,d2_lo,d2_hi],[d3,d3_lo,d3_hi] ]\"\n不含空格（例如：\"[[1.234000e-03,1.000000e-03,1.468000e-03],[...],[...]]\"）。", "solution": "问题陈述经过了严格的验证，并被确定为有效。它在科学上基于固态物理学原理，特别是铁磁体中的磁振子理论。该问题定义明确，为理论推导和计算实现提供了一套完整且一致的要求。语言客观而精确。因此，我将着手提供一个完整的解决方案。\n\n解决方案分为两部分：首先，是自旋波刚度与低温磁化强度中 $T^{3/2}$ 项系数之间关系的必要理论推导；其次，是实现统计分析的计算方法纲要。\n\n**1. 理论推导**\n\n铁磁体在有限温度 $T$ 下的自发磁化强度 $M_s(T)$ 相对于其在绝对零度下的饱和值 $M_s(0)$ 有所降低，这是由于磁振子的热激发所致，磁振子是自旋波的量子。每个磁振子携带的自旋与净磁化方向相反，在最简单的模型中，它的产生会使总磁矩减少 $g \\mu_{\\mathrm{B}}$，其中 $g$ 是朗德 g 因子，$\\mu_{\\mathrm{B}}$ 是玻尔磁子。\n\n磁化强度的总减少量 $\\Delta M_s(T) = M_s(0) - M_s(T)$ 与磁振子的数密度 $n_{\\text{mag}}$ 成正比。\n$$\n\\Delta M_s(T) = g \\mu_{\\mathrm{B}} n_{\\text{mag}}\n$$\n磁振子的数密度是通过在第一布里渊区内对所有波矢 $\\mathbf{k}$ 积分玻色-爱因斯坦分布函数 $n_{\\mathbf{k}}$ 来计算的。在低温下，只有长波长的磁振子被显著占据，因此积分可以扩展到整个k空间，并且晶格结构可以被连续介质所取代。\n$$\nn_{\\text{mag}} = \\int_{\\mathbb{R}^3} \\frac{d^3k}{(2\\pi)^3} n_{\\mathbf{k}} = \\int_{\\mathbb{R}^3} \\frac{d^3k}{(2\\pi)^3} \\frac{1}{\\exp(\\beta \\epsilon_{\\mathbf{k}}) - 1}\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}}T)$，$\\epsilon_{\\mathbf{k}}$ 是磁振子色散关系。对于各向同性铁磁体，长波色散是二次的：$\\epsilon_{\\mathbf{k}} = Dk^2$，其中 $D$ 是自旋波刚度，$k = |\\mathbf{k}|$。\n\n为了计算该积分，我们变换到k空间中的球坐标系，其体积元为 $d^3k = 4\\pi k^2 dk$。\n$$\nn_{\\text{mag}} = \\frac{4\\pi}{(2\\pi)^3} \\int_{0}^{\\infty} \\frac{k^2}{\\exp(\\beta D k^2) - 1} dk = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} \\frac{k^2}{\\exp(\\beta D k^2) - 1} dk\n$$\n我们进行变量替换。令 $x = \\beta D k^2$。则 $k = (x/\\beta D)^{1/2}$ 且 $dk = \\frac{1}{2}(x\\beta D)^{-1/2} dx$。\n将这些代入积分中得到：\n$$\nn_{\\text{mag}} = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} \\frac{x}{\\beta D} \\frac{1}{e^x - 1} \\frac{1}{2\\sqrt{\\beta D}} \\frac{1}{\\sqrt{x}} dx\n= \\frac{1}{4\\pi^2 (\\beta D)^{3/2}} \\int_{0}^{\\infty} \\frac{x^{1/2}}{e^x - 1} dx\n$$\n该积分为一个与黎曼zeta函数 $\\zeta(s)$ 和伽玛函数 $\\Gamma(s)$ 相关的标准形式：\n$$\n\\int_{0}^{\\infty} \\frac{x^{s-1}}{e^x - 1} dx = \\Gamma(s)\\zeta(s)\n$$\n对于我们的积分，$s-1 = 1/2$，这意味着 $s = 3/2$。相关的值为 $\\Gamma(3/2) = \\sqrt{\\pi}/2$ 和 $\\zeta(3/2)$。$\\zeta(3/2)$ 的值约为 $2.612375$。\n该积分计算结果为 $\\Gamma(3/2)\\zeta(3/2) = \\zeta(3/2)\\sqrt{\\pi}/2$。将其代回：\n$$\nn_{\\text{mag}} = \\frac{1}{4\\pi^2 (\\beta D)^{3/2}} \\left( \\frac{\\sqrt{\\pi}}{2} \\zeta(3/2) \\right) = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} (\\beta D)^{-3/2}\n$$\n现在，代入 $\\beta = 1/(k_{\\mathrm{B}}T)$：\n$$\nn_{\\text{mag}} = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{D}{k_{\\mathrm{B}}T}\\right)^{-3/2} = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}T}{D}\\right)^{3/2}\n$$\n磁化强度的减少量则为：\n$$\n\\Delta M_s(T) = g \\mu_{\\mathrm{B}} \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}}{D}\\right)^{3/2} T^{3/2}\n$$\n这就是著名的布洛赫 $T^{3/2}$ 定律。问题陈述给出的低温展开式为 $M_s(T) = M_s(0) - A T^{3/2} - B T^{5/2}$。比较领头项，我们确定系数 $A$：\n$$\nA = g \\mu_{\\mathrm{B}} \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}}{D}\\right)^{3/2} = g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi D}\\right)^{3/2}\n$$\n这就是 $A$ 和 $D$ 之间的关系。为了对 $D$ 进行推断，我们需要将 $D$ 表示为 $A$ 的函数，即 $D = f(A)$。反转该关系可得：\n$$\nD^{3/2} = g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi}\\right)^{3/2} A^{-1}\n$$\n$$\nD = \\left( g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi}\\right)^{3/2} A^{-1} \\right)^{2/3} = \\left( g \\mu_{\\mathrm{B}} \\zeta(3/2) \\right)^{2/3} \\frac{k_{\\mathrm{B}}}{4\\pi} A^{-2/3}\n$$\n这就是所要求的解析关系 $D = f(A)$。此推导为后续的数据分析提供了物理基础。\n\n**2. 计算方法**\n\n分析过程是通过将实验数据 $\\{(T_i, M_i)\\}$ 拟合到模型 $M_s(T) = M_s(0) - AT^{3/2} - BT^{5/2}$ 来进行的。这是一个多元线性回归问题。\n\n**a. 线性模型构建：**\n该模型可以表示为矩阵形式 $\\mathbf{y} = X\\mathbf{\\beta} + \\mathbf{\\epsilon}$。\n- 响应向量 $\\mathbf{y}$ 包含磁化强度测量值，$y_i = M_i$。\n- 参数向量为 $\\mathbf{\\beta} = [M_s(0), A, B]^\\top$。\n- 设计矩阵 $X$ 有 $N$ 行（对应 $N$ 个数据点）和 $p=3$ 列。第 $i$ 行为 $[1, -T_i^{3/2}, -T_i^{5/2}]$。\n- $\\mathbf{\\epsilon}$ 是未观测到的随机误差向量，假设其独立同分布于 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n**b. 参数估计：**\n参数向量的普通最小二乘 (OLS) 估计 $\\hat{\\mathbf{\\beta}}$ 通过求解正规方程得到：\n$$\n\\hat{\\mathbf{\\beta}} = (X^\\top X)^{-1} X^\\top \\mathbf{y}\n$$\n由此得出估计值 $\\hat{M}_s(0)$、$\\hat{A}$ 和 $\\hat{B}$。\n\n**c. 不确定性量化：**\n估计参数的协方差矩阵由 $\\mathrm{Cov}(\\hat{\\mathbf{\\beta}}) = \\sigma^2 (X^\\top X)^{-1}$ 给出。由于 $\\sigma^2$ 未知，需要从残差中进行估计。\n- 残差：$\\mathbf{r} = \\mathbf{y} - X\\hat{\\mathbf{\\beta}}$\n- 残差平方和 (RSS)：$\\mathrm{RSS} = \\mathbf{r}^\\top\\mathbf{r}$\n- $\\sigma^2$ 的无偏估计量：$\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}}{N-p}$\n于是，估计的协方差矩阵为 $\\widehat{\\mathrm{Cov}}(\\hat{\\mathbf{\\beta}}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}$。我们关心的系数 $\\hat{A}$ 的方差是该矩阵的第二个对角元素，$\\mathrm{Var}(\\hat{A}) = [\\widehat{\\mathrm{Cov}}(\\hat{\\mathbf{\\beta}})]_{1,1}$（使用0-基索引）。\n\n**d. 误差传播（Delta方法）：**\n我们使用推导出的函数来估计自旋波刚度：$\\hat{D} = f(\\hat{A})$。为了找到 $\\hat{D}$ 的不确定性，我们使用一阶泰勒展开（delta方法）：\n$$\n\\mathrm{Var}(\\hat{D}) \\approx \\left( \\frac{df}{dA} \\bigg|_{A=\\hat{A}} \\right)^2 \\mathrm{Var}(\\hat{A})\n$$\n所需的导数为：\n$$\n\\frac{df}{dA} = \\frac{d}{dA} \\left( C A^{-2/3} \\right) = C \\left(-\\frac{2}{3}\\right) A^{-5/3} = -\\frac{2}{3} \\frac{C A^{-2/3}}{A} = -\\frac{2}{3}\\frac{D}{A}\n$$\n其中 $C$ 是 $D$ 表达式中的常数项。\n因此，估计的方差为 $\\mathrm{Var}(\\hat{D}) \\approx \\left(-\\frac{2}{3}\\frac{\\hat{D}}{\\hat{A}}\\right)^2 \\mathrm{Var}(\\hat{A})$。标准误差为 $\\mathrm{SE}(\\hat{D}) = \\sqrt{\\mathrm{Var}(\\hat{D})}$。\n\n**e. 置信区间：**\n因为 $\\sigma^2$ 是估计出来的，所以使用 t 分布构造 $D$ 的双侧 $95\\%$ 置信区间。自由度为 $\\nu = N-p = N-3$。\n$$\n\\text{CI}_{95\\%}(D) = \\hat{D} \\pm t_{1-0.05/2, \\nu} \\cdot \\mathrm{SE}(\\hat{D})\n$$\n其中 $t_{0.975, \\nu}$ 是具有 $\\nu$ 自由度的学生t分布的上临界值。此过程将对问题规范中提供的每个合成数据集实施。", "answer": "```python\nimport numpy as np\nfrom scipy.special import zeta as riemann_zeta\nfrom scipy.stats import t as t_distribution\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the final result.\n    \"\"\"\n    # Physical constants in SI units\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    MU_B = 9.2740100783e-24  # Bohr magneton in A*m^2\n    G_FACTOR = 2.0  # Landé g-factor\n    ZETA_3_2 = riemann_zeta(1.5)  # Riemann zeta function at 3/2\n\n    # Pre-calculate the constant factor connecting D and A\n    # D = (C/A)^(2/3), where C = G_FACTOR * MU_B * ZETA_3_2 * (K_B / (4 * np.pi))**(3/2)\n    CONSTANT_DA = G_FACTOR * MU_B * ZETA_3_2 * (K_B / (4 * np.pi))**(1.5)\n\n    def d_from_a(a_val):\n        \"\"\"Computes spin-wave stiffness D from coefficient A.\"\"\"\n        return (CONSTANT_DA / a_val)**(2.0 / 3.0)\n\n    def a_from_d(d_val):\n        \"\"\"Computes coefficient A from spin-wave stiffness D.\"\"\"\n        return CONSTANT_DA / (d_val**(1.5))\n\n    def process_case(m0_true, d_true, b_true, t_range, n_points, sigma, seed):\n        \"\"\"\n        Analyzes a single synthetic dataset to infer D and its confidence interval.\n        \"\"\"\n        # 1. Generate synthetic data\n        a_true = a_from_d(d_true)\n        rng = np.random.default_rng(seed)\n        t_values = np.linspace(t_range[0], t_range[1], n_points)\n        \n        m_true = m0_true - a_true * t_values**1.5 - b_true * t_values**2.5\n        noise = rng.normal(0, sigma, n_points)\n        m_observed = m_true + noise\n\n        # 2. Perform Ordinary Least Squares regression\n        # The model is M = M0 - A*T^1.5 - B*T^2.5, which is linear in parameters M0, A, B.\n        # M = beta_0 * 1 + beta_1 * (-T^1.5) + beta_2 * (-T^2.5)\n        # where beta = [M0, A, B]^T.\n        x0 = np.ones(n_points)\n        x1 = -t_values**1.5\n        x2 = -t_values**2.5\n        X = np.stack([x0, x1, x2], axis=1)\n        y = m_observed\n\n        # Solve normal equations: beta_hat = (X.T @ X)^-1 @ X.T @ y\n        try:\n            XTX_inv = np.linalg.inv(X.T @ X)\n        except np.linalg.LinAlgError:\n            # Handle cases of singular matrix, which might occur with very few points\n            # or extreme collinearity, although unlikely with given test cases.\n            return [np.nan, np.nan, np.nan]\n            \n        beta_hat = XTX_inv @ X.T @ y\n        m0_hat, a_hat, b_hat = beta_hat[0], beta_hat[1], beta_hat[2]\n\n        # 3. Estimate parameter uncertainties\n        num_params = 3\n        dof = n_points - num_params\n        residuals = y - X @ beta_hat\n        rss = np.sum(residuals**2)\n        sigma_sq_hat = rss / dof\n        \n        cov_beta = sigma_sq_hat * XTX_inv\n        var_a_hat = cov_beta[1, 1]\n\n        # 4. Propagate uncertainty to D using the delta method\n        if a_hat = 0: # Physically non-sensical; would lead to division by zero or a complex D\n            return [np.nan, np.nan, np.nan]\n        \n        d_hat = d_from_a(a_hat)\n        \n        # Derivative of D = f(A) is f'(A) = -2/3 * D/A\n        deriv_d_a = - (2.0 / 3.0) * d_hat / a_hat\n        var_d_hat = (deriv_d_a**2) * var_a_hat\n        se_d_hat = np.sqrt(var_d_hat)\n\n        # 5. Calculate the 95% confidence interval\n        # Use Student's t-distribution as sigma was estimated\n        t_crit = t_distribution.ppf(0.975, df=dof)\n        ci_margin = t_crit * se_d_hat\n        d_low = d_hat - ci_margin\n        d_high = d_hat + ci_margin\n\n        return [d_hat, d_low, d_high]\n\n    # Test cases as specified in the problem\n    test_cases = [\n        # Case 1: General \"happy path\"\n        (1.70e6, 4.5e-40, 2.0e-2, (2, 20), 25, 50.0, 12345),\n        # Case 2: Negligible subleading term\n        (8.00e5, 6.0e-40, 0.0, (2, 12), 20, 30.0, 24680),\n        # Case 3: Boundary (low T, few points, high noise)\n        (1.40e6, 3.0e-40, 1.0e-2, (2, 6), 6, 80.0, 13579),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(*case)\n        results.append(result)\n\n    # Format the output string as per requirement\n    # \"[[d1,d1_lo,d1_hi],[d2,d2_lo,d2_hi],[d3,d3_lo,d3_hi]]\" with scientific notation and 6 sig figs.\n    # The format specifier {:.5e} provides 1 digit before and 5 after the decimal point for 6 significant digits.\n    def format_val(v):\n        return f\"{v:.5e}\"\n        \n    inner_strings = []\n    for res in results:\n        formatted_res = [f\"{v:.6e}\" for v in res] # Corrected to 6 sig figs\n        inner_strings.append(f\"[{','.join(formatted_res)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2865514"}]}