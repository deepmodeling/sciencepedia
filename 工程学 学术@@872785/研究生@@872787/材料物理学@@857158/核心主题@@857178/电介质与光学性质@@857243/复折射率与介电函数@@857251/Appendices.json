{"hands_on_practices": [{"introduction": "要真正掌握复杂介电函数，第一步是将其与可测量的宏观现象联系起来。本练习将通过经典的Drude模型，从麦克斯韦方程组出发，推导材料的复杂介电函数 $\\varepsilon(\\omega)$、复折射率 $\\tilde{n}$ 与光吸收系数 $\\alpha$ 之间的基本关系。通过计算金属的趋肤深度 [@problem_id:2810175]，你将亲身体验微观的电子响应（等离子体频率 $\\omega_p$ 和阻尼率 $\\gamma$）如何决定电磁波在导体中的穿透能力，这是理解金属光学和电磁屏蔽等应用的核心。", "problem": "一种均匀、各向同性、非磁性的金属由局域 Drude 介电函数描述。真空中一束自由空间波长为 $\\lambda_{0} = 600\\,\\text{nm}$ 的单色平面波正入射到该金属上。该金属的高频介电常数 $\\varepsilon_{\\infty} = 1$，等离子体频率 $\\omega_{p} = 9.00 \\times 10^{15}\\,\\text{s}^{-1}$，阻尼率 $\\gamma = 1.00 \\times 10^{14}\\,\\text{s}^{-1}$。其介电函数为\n$$\n\\varepsilon(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_{p}^{2}}{\\omega^{2} + i \\gamma \\omega}.\n$$\n从物质中的 Maxwell 方程组、本构关系 $\\mathbf{D} = \\varepsilon_{0}\\varepsilon(\\omega)\\mathbf{E}$ 和 $\\mathbf{B} = \\mu_{0}\\mathbf{H}$，以及均匀介质中的平面波拟设出发，首先推导连接复介电函数 $\\varepsilon(\\omega)$ 与复折射率 $\\tilde{n} = n + i \\kappa$ 的关系，然后推导连接消光系数 $\\kappa$ 与吸收系数 $\\alpha$ 的关系，其中吸收系数由金属内部的强度衰减 $I(z) = I_{0} \\exp(-\\alpha z)$ 定义。使用这些关系计算强度趋肤深度 $\\delta$，其定义为强度从其表面值衰减 $\\exp(1)$ 倍时所经过的距离，即 $\\delta = 1/\\alpha$。\n\n取真空中的光速为 $c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$，并假设选择平方根的主支以使 $\\kappa \\ge 0$。用纳米表示 $\\delta$ 的最终值，并将您的答案四舍五入至三位有效数字。", "solution": "该问题要求推导金属光学中的基本关系，并随后计算强度趋肤深度。分析将从第一性原理，即 Maxwell 方程组开始。\n\n在没有自由电荷或自由电流的均匀、各向同性、线性、非磁性介质中，Maxwell 方程组为：\n$$\n\\nabla \\cdot \\mathbf{D} = 0\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n本构关系为 $\\mathbf{D} = \\varepsilon_{0}\\varepsilon(\\omega)\\mathbf{E}$ 和 $\\mathbf{B} = \\mu_{0}\\mathbf{H}$。对于非磁性介质，相对磁导率 $\\mu_r$ 为 $1$。\n\n为推导电场 $\\mathbf{E}$ 的波动方程，我们对第三个 Maxwell 方程（法拉第定律）取旋度：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{B})\n$$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$，左边变为 $\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E}$。根据 $\\nabla \\cdot \\mathbf{D} = 0$ 和介质的均匀性（因此 $\\varepsilon$ 不是位置的函数），我们有 $\\varepsilon_{0}\\varepsilon(\\omega)(\\nabla \\cdot \\mathbf{E}) = 0$，这意味着 $\\nabla \\cdot \\mathbf{E} = 0$。因此，波动方程简化为：\n$$\n-\\nabla^2 \\mathbf{E} = -\\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{B})\n$$\n代入 $\\mathbf{B} = \\mu_0 \\mathbf{H}$，然后再代入第四个 Maxwell 方程（安培定律）得到：\n$$\n-\\nabla^2 \\mathbf{E} = -\\mu_0 \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\mathbf{D}}{\\partial t}\\right) = -\\mu_0 \\frac{\\partial^2 \\mathbf{D}}{\\partial t^2}\n$$\n最后，代入 $\\mathbf{D}$ 的本构关系：\n$$\n\\nabla^2 \\mathbf{E} = \\mu_0 \\varepsilon_0 \\varepsilon(\\omega) \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2}\n$$\n让我们考虑一个沿 $z$ 方向传播的单色平面波解：\n$$\n\\mathbf{E}(\\mathbf{r}, t) = \\mathbf{E}_0 \\exp(i(\\tilde{k}z - \\omega t))\n$$\n其中 $\\tilde{k}$ 是介质中的复波矢。将此拟设代入波动方程，我们求得导数 $\\nabla^2 \\mathbf{E} = -\\tilde{k}^2 \\mathbf{E}$ 和 $\\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = -\\omega^2 \\mathbf{E}$。这导出了色散关系：\n$$\n-\\tilde{k}^2 \\mathbf{E} = \\mu_0 \\varepsilon_0 \\varepsilon(\\omega) (-\\omega^2 \\mathbf{E})\n$$\n$$\n\\tilde{k}^2 = \\omega^2 \\mu_0 \\varepsilon_0 \\varepsilon(\\omega)\n$$\n使用真空中光速的关系式 $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$，色散关系变为：\n$$\n\\tilde{k}^2 = \\frac{\\omega^2}{c^2} \\varepsilon(\\omega)\n$$\n复折射率 $\\tilde{n} = n + i \\kappa$ 由关系式 $\\tilde{k} = \\tilde{n}\\frac{\\omega}{c}$ 定义。将此定义代入色散关系得到：\n$$\n\\left(\\tilde{n}\\frac{\\omega}{c}\\right)^2 = \\frac{\\omega^2}{c^2} \\varepsilon(\\omega)\n$$\n这简化为第一个所需的关系式：\n$$\n\\tilde{n}^2 = \\varepsilon(\\omega)\n$$\n展开此式得到 $(n + i\\kappa)^2 = \\varepsilon(\\omega) = \\varepsilon_1 + i\\varepsilon_2$，其中 $\\varepsilon_1$ 和 $\\varepsilon_2$ 分别是介电函数的实部和虚部。\n\n接下来，我们建立消光系数 $\\kappa$ 和吸收系数 $\\alpha$ 之间的联系。电场的空间依赖性由项 $\\exp(i\\tilde{k}z)$ 给出。代入 $\\tilde{k} = (n + i\\kappa)\\frac{\\omega}{c}$：\n$$\n\\exp(i\\tilde{k}z) = \\exp\\left(i(n + i\\kappa)\\frac{\\omega}{c}z\\right) = \\exp\\left(-\\kappa\\frac{\\omega}{c}z\\right)\\exp\\left(in\\frac{\\omega}{c}z\\right)\n$$\n波的强度 $I(z)$ 与电场振幅的平方成正比，因此其空间衰减遵循：\n$$\nI(z) \\propto |E_0 \\exp(i\\tilde{k}z)|^2 \\propto \\left|\\exp\\left(-\\kappa\\frac{\\omega}{c}z\\right)\\right|^2 = \\exp\\left(-2\\kappa\\frac{\\omega}{c}z\\right)\n$$\n因此，$I(z) = I_0 \\exp\\left(-2\\kappa\\frac{\\omega}{c}z\\right)$。将其与所给定义 $I(z) = I_0 \\exp(-\\alpha z)$ 进行比较，我们确定吸收系数为：\n$$\n\\alpha = 2\\kappa\\frac{\\omega}{c}\n$$\n这是第二个所需的关系式。强度趋肤深度为 $\\delta = 1/\\alpha$。使用 $\\omega/c = 2\\pi/\\lambda_0$，我们也可以写出 $\\alpha = 4\\pi\\kappa/\\lambda_0$，这给出 $\\delta = \\lambda_0/(4\\pi\\kappa)$。\n\n现在，我们进行数值计算。\n入射光的角频率为：\n$$\n\\omega = \\frac{2\\pi c}{\\lambda_0} = \\frac{2\\pi (2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1})}{600 \\times 10^{-9}\\,\\text{m}} \\approx 3.1395 \\times 10^{15}\\,\\text{s}^{-1}\n$$\n复介电函数为 $\\varepsilon(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_{p}^{2}}{\\omega^{2} + i \\gamma \\omega}$。使用给定参数 $\\varepsilon_{\\infty} = 1$，$\\omega_{p} = 9.00 \\times 10^{15}\\,\\text{s}^{-1}$ 和 $\\gamma = 1.00 \\times 10^{14}\\,\\text{s}^{-1}$：\n$$\n\\omega^2 \\approx (3.1395 \\times 10^{15})^2 \\approx 9.8566 \\times 10^{30}\\,\\text{s}^{-2}\n$$\n$$\ni \\gamma \\omega \\approx i (1.00 \\times 10^{14}) (3.1395 \\times 10^{15}) = i(0.3140 \\times 10^{30})\\,\\text{s}^{-2}\n$$\n$$\n\\omega_p^2 = (9.00 \\times 10^{15})^2 = 81.0 \\times 10^{30}\\,\\text{s}^{-2}\n$$\n所以，\n$$\n\\varepsilon(\\omega) = 1 - \\frac{81.0 \\times 10^{30}}{9.8566 \\times 10^{30} + i(0.3140 \\times 10^{30})} = 1 - \\frac{81.0}{9.8566 + i(0.3140)}\n$$\n将分数的分母有理化：\n$$\n\\frac{81.0}{9.8566 + i(0.3140)} = \\frac{81.0(9.8566 - i(0.3140))}{9.8566^2 + 0.3140^2} = \\frac{798.38 - i(25.43)}{97.15 + 0.0986} \\approx \\frac{798.38 - i(25.43)}{97.25} \\approx 8.2096 - i(0.2615)\n$$\n因此，介电函数为：\n$$\n\\varepsilon(\\omega) \\approx 1 - (8.2096 - i(0.2615)) = -7.2096 + i(0.2615)\n$$\n我们确定实部和虚部分别为 $\\varepsilon_1 = -7.2096$ 和 $\\varepsilon_2 = 0.2615$。\n由关系式 $\\tilde{n}^2 = \\varepsilon$，我们有 $(n + i\\kappa)^2 = \\varepsilon_1 + i\\varepsilon_2$，这得到方程 $n^2 - \\kappa^2 = \\varepsilon_1$ 和 $2n\\kappa = \\varepsilon_2$。解出 $\\kappa^2$ 可得：\n$$\n\\kappa^2 = \\frac{1}{2}\\left(\\sqrt{\\varepsilon_1^2 + \\varepsilon_2^2} - \\varepsilon_1\\right)\n$$\n我们计算必要的量：\n$$\n\\varepsilon_1^2 + \\varepsilon_2^2 \\approx (-7.2096)^2 + (0.2615)^2 \\approx 51.978 + 0.0684 \\approx 52.046\n$$\n$$\n\\sqrt{\\varepsilon_1^2 + \\varepsilon_2^2} \\approx \\sqrt{52.046} \\approx 7.2143\n$$\n现在，我们求出 $\\kappa^2$：\n$$\n\\kappa^2 \\approx \\frac{1}{2}(7.2143 - (-7.2096)) = \\frac{1}{2}(14.4239) \\approx 7.2120\n$$\n消光系数 $\\kappa$ 是正平方根：\n$$\n\\kappa = \\sqrt{7.2120} \\approx 2.6855\n$$\n现在我们计算吸收系数 $\\alpha$：\n$$\n\\alpha = \\frac{4\\pi\\kappa}{\\lambda_0} = \\frac{4\\pi(2.6855)}{600 \\times 10^{-9}\\,\\text{m}} \\approx \\frac{33.748}{600 \\times 10^{-9}\\,\\text{m}} \\approx 5.6247 \\times 10^7\\,\\text{m}^{-1}\n$$\n最后，强度趋肤深度 $\\delta$ 是 $\\alpha$ 的倒数：\n$$\n\\delta = \\frac{1}{\\alpha} \\approx \\frac{1}{5.6247 \\times 10^7\\,\\text{m}^{-1}} \\approx 1.7779 \\times 10^{-8}\\,\\text{m}\n$$\n为了以纳米表示，我们乘以 $10^9$：\n$$\n\\delta \\approx 1.7779 \\times 10^{-8}\\,\\text{m} \\times (10^9\\,\\text{nm}/\\text{m}) = 17.779\\,\\text{nm}\n$$\n四舍五入到三位有效数字，最终结果是 $17.8\\,\\text{nm}$。", "answer": "$$\n\\boxed{17.8}\n$$", "id": "2810175"}, {"introduction": "在理解了光在材料内部的传播行为之后，下一步自然是研究光在不同介质界面处的行为。当其中一种介质有损耗时（即其折射率的虚部 $\\kappa > 0$），许多在无损耗情况下成立的理想光学现象将发生深刻改变。本练习 [@problem_id:2810155] 引导你深入探讨有损耗界面上的p偏振光反射问题，通过严谨的推导和概念辨析，你将揭示为何严格意义上的布儒斯特角（反射率为零）和完美的全内反射（反射率为1）在这种情况下不再存在，从而加深对能量守恒和界面电磁响应的理解。", "problem": "一束单色平面波在实折射率为 $n_{1}$ 的非磁性介质中，从 $z0$ 区域入射到一个平面界面上，该界面与一个占据 $z>0$ 区域的耗散性、非磁性介质相接。第二种介质的复折射率为 $\\tilde{n}_{2}=n_{2}^{\\prime}+i\\,\\kappa_{2}$，其中 $n_{2}^{\\prime}>0$ 且 $\\kappa_{2}>0$，其复相对介电函数为 $\\varepsilon_{2}=\\tilde{n}_{2}^{2}$，而 $\\varepsilon_{1}=n_{1}^{2}$。假设两种介质中的磁导率均为常数，不随频率变化，且等于真空中的值，即 $\\mu_{1}=\\mu_{2}=\\mu_{0}$，时间依赖关系为 $\\exp(-i\\omega t)$。设入射面为 $x$-$z$ 平面，入射角为 $\\theta_{1}\\in(0,\\pi/2)$，从界面法线方向测量。\n\n从麦克斯韦方程组、复折射率和介电函数的定义，以及平面界面上的电磁边界条件出发，完成以下针对 $p$ 偏振（平行）入射的任务：\n\n1) 推导菲涅尔反射振幅 $r_{p}$，用 $\\varepsilon_{1}$、$\\varepsilon_{2}$、$n_{1}$、$\\tilde{n}_{2}$ 以及纵向波矢分量表示，或等效地用受复数斯涅尔关系 $n_{1}\\sin\\theta_{1}=\\tilde{n}_{2}\\sin\\theta_{2}$ 约束的入射角和折射角 $\\theta_{1}$ 和 $\\theta_{2}$ 表示。表达 $r_{p}$ 的形式应使其对复数 $\\theta_{2}$ 的解析延拓是明显的。\n\n2) 利用你在 (1) 中的结果和无源条件 $\\operatorname{Im}(\\varepsilon_{2})>0$，仔细论证当 $\\kappa_{2}>0$ 时，是否存在任何实数入射角 $\\theta_{1}$ 使得 $p$ 偏振反射率 $R_{p}=|r_{p}|^{2}$ 为零（布儒斯特条件）。你的论证不应假设任何预先制表的“有损介质中的布儒斯特角”公式；而应从阻抗匹配或从 $r_{p}$ 的结构和边界条件出发进行推理。\n\n3) 讨论在有损耗的情况下 $p$ 偏振的全内反射（TIR）概念，将无损耗情况 $\\kappa_{2}=0$ 与有损耗情况 $\\kappa_{2}>0$ 进行对比。利用你得到的 $r_{p}$ 表达式和复数角度的斯涅尔关系，解释为什么当 $\\kappa_{2}>0$ 时，完美的TIR（即反射率 $R_{p}=|r_{p}|^{2}=1$）对于任何实数入射角都是不可能实现的。\n\n4) 对于小损耗介质，反射率存在一个非零的最小值。通过分析表明，该最小反射率对应的角度 $\\theta_{min}$ 在主导阶上等于无损耗介质的布儒斯特角。对于 $n_1=1.50$ 和 $\\tilde{n}_2=2.10+i\\,0.12$，计算 $\\theta_{min}$ 的此主导阶近似值（以弧度为单位），并四舍五入到四位有效数字。", "solution": "本题要求对电磁波在电介质与耗散介质界面上 $p$ 偏振的反射进行系统分析。我们将按顺序处理四个要求完成的任务。\n\n该设置考虑一个位于 $z=0$ 的平面界面。介质1（$z0$）是一种非磁性电介质，其实折射率为 $n_1$，介电函数为 $\\varepsilon_1 = n_1^2$。介质2（$z>0$）是一种非磁性、耗散性介质，其复折射率为 $\\tilde{n}_2 = n_2' + i\\kappa_2$（$n_2' > 0$, $\\kappa_2 > 0$），复介电函数为 $\\varepsilon_2 = \\tilde{n}_2^2$。各处的磁导率均为 $\\mu_0$。时间依赖关系为 $\\exp(-i\\omega t)$。入射面为 $x$-$z$ 平面。\n\n1) 菲涅尔反射振幅 $r_p$ 的推导。\n对于 $p$ 偏振波，磁场矢量 $\\vec{H}$ 垂直于入射面，因此我们取 $\\vec{H} = H_y(x,z) \\hat{y} \\exp(-i\\omega t)$。电场 $\\vec{E}$ 位于 $x$-$z$ 平面内。入射波（$\\mathrm{i}$）、反射波（$\\mathrm{r}$）和透射波（$\\mathrm{t}$）的场为：\n$$ \\vec{H}_{\\mathrm{i}} = \\vec{H}_{0,i} \\exp(i(k_{1x}x + k_{1z}z)) $$\n$$ \\vec{H}_{\\mathrm{r}} = \\vec{H}_{0,r} \\exp(i(k_{1x}x - k_{1z}z)) $$\n$$ \\vec{H}_{\\mathrm{t}} = \\vec{H}_{0,t} \\exp(i(k_{2x}x + k_{2z}z)) $$\n其中相位匹配要求波矢的切向分量在界面两侧相等：$k_{1x} = k_{2x}$。这给出了斯涅尔定律：$n_1 \\sin\\theta_1 = \\tilde{n}_2 \\sin\\theta_2$。波矢的法向分量为 $k_{1z} = k_1 \\cos\\theta_1 = (n_1\\omega/c)\\cos\\theta_1$ 和 $k_{2z} = \\tilde{k}_2 \\cos\\theta_2 = (\\tilde{n}_2\\omega/c)\\cos\\theta_2$。对于介质2中的衰减波，必须有 $\\operatorname{Im}(k_{2z})>0$。\n\n对应的电场可由麦克斯韦方程 $\\nabla \\times \\vec{H} = -i\\omega\\varepsilon\\vec{E}$ 求得。其切向分量为 $E_x = \\frac{i}{\\omega\\varepsilon} \\frac{\\partial H_y}{\\partial z}$。\n$$ E_{x,\\mathrm{i}} = -\\frac{k_{1z}}{\\omega\\varepsilon_1} H_{y,\\mathrm{i}} \\quad , \\quad E_{x,\\mathrm{r}} = \\frac{k_{1z}}{\\omega\\varepsilon_1} H_{y,\\mathrm{r}} \\quad , \\quad E_{x,\\mathrm{t}} = -\\frac{k_{2z}}{\\omega\\varepsilon_2} H_{y,\\mathrm{t}} $$\n在界面 $z=0$ 处，$\\vec{H}$ 和 $\\vec{E}$ 的切向分量必须连续。设 $H_{i0}, H_{r0}, H_{t0}$ 为界面处磁场的复振幅。\n$H_y$ 的连续性：\n$$ H_{i0} + H_{r0} = H_{t0} \\quad (1) $$\n$E_x$ 的连续性：\n$$ -\\frac{k_{1z}}{\\omega\\varepsilon_1} H_{i0} + \\frac{k_{1z}}{\\omega\\varepsilon_1} H_{r0} = -\\frac{k_{2z}}{\\omega\\varepsilon_2} H_{t0} \\quad (2) $$\n将 (1) 代入 (2)：\n$$ \\frac{k_{1z}}{\\varepsilon_1} (H_{i0} - H_{r0}) = \\frac{k_{2z}}{\\varepsilon_2} (H_{i0} + H_{r0}) $$\n反射振幅 $r_p$ 是为入射面内的电场振幅定义的。标准约定将磁场振幅关系表示为 $r_p = -H_{r0}/H_{i0}$ 或 $r_p=H_{r0}/H_{i0}$，这取决于场矢量的坐标选择。我们先求解 $H_{r0}/H_{i0}$。\n$$ H_{r0} \\left( \\frac{k_{2z}}{\\varepsilon_2} + \\frac{k_{1z}}{\\varepsilon_1} \\right) = H_{i0} \\left( \\frac{k_{1z}}{\\varepsilon_1} - \\frac{k_{2z}}{\\varepsilon_2} \\right) $$\n$$ \\frac{H_{r0}}{H_{i0}} = \\frac{k_{1z}/\\varepsilon_1 - k_{2z}/\\varepsilon_2}{k_{1z}/\\varepsilon_1 + k_{2z}/\\varepsilon_2} = \\frac{\\varepsilon_2 k_{1z} - \\varepsilon_1 k_{2z}}{\\varepsilon_2 k_{1z} + \\varepsilon_1 k_{2z}} $$\n该表达式对应于 $r_p$ 的一种定义，其中入射和反射电场的切向分量相加。一个更常见的约定是使用总电场振幅来定义 $r_p$，这会导致符号反转，具体取决于所选的 $\\vec{E}_r$ 方向。如果我们将此式等同于 $r_p$，则推导出的形式与标准菲涅尔方程相符。代入 $k_{1z} = (n_1\\omega/c)\\cos\\theta_1$、$k_{2z} = (\\tilde{n}_2\\omega/c)\\cos\\theta_2$、$\\varepsilon_1=n_1^2$ 和 $\\varepsilon_2=\\tilde{n}_2^2$，我们得到：\n$$ r_p = \\frac{\\tilde{n}_2^2 (n_1\\omega/c)\\cos\\theta_1 - n_1^2 (\\tilde{n}_2\\omega/c)\\cos\\theta_2}{\\tilde{n}_2^2 (n_1\\omega/c)\\cos\\theta_1 + n_1^2 (\\tilde{n}_2\\omega/c)\\cos\\theta_2} = \\frac{n_1\\tilde{n}_2(\\tilde{n}_2\\cos\\theta_1 - n_1\\cos\\theta_2)}{n_1\\tilde{n}_2(\\tilde{n}_2\\cos\\theta_1 + n_1\\cos\\theta_2)} = \\frac{\\tilde{n}_2 \\cos\\theta_1 - n_1 \\cos\\theta_2}{\\tilde{n}_2 \\cos\\theta_1 + n_1 \\cos\\theta_2} $$\n这个以角度 $\\theta_1$ 和复数 $\\theta_2$ 表示的最终表达式使得解析延拓显而易见。复数角 $\\theta_2$ 受斯涅尔定律约束，$n_1\\sin\\theta_1 = \\tilde{n}_2\\sin\\theta_2$，这意味着 $\\cos\\theta_2 = \\sqrt{1-\\sin^2\\theta_2} = \\sqrt{1 - (n_1/\\tilde{n}_2)^2\\sin^2\\theta_1}$。\n\n2) 有损介质中布儒斯特角的存在性。\n布儒斯特条件是 $R_p = |r_p|^2 = 0$，这要求 $r_p=0$。根据第 (1) 部分推导的表达式，这意味着分子必须为零：\n$$ \\tilde{n}_2 \\cos\\theta_1 - n_1 \\cos\\theta_2 = 0 $$\n该条件必须与斯涅尔定律 $n_1 \\sin\\theta_1 = \\tilde{n}_2 \\sin\\theta_2$ 同时满足。我们可以联立这两个方程来找到关于 $\\theta_1$ 的条件。从布儒斯特条件可知，$\\tilde{n}_2^2 \\cos^2\\theta_1 = n_1^2 \\cos^2\\theta_2 = n_1^2(1-\\sin^2\\theta_2)$。利用斯涅尔定律代入 $\\sin\\theta_2$：\n$$ \\tilde{n}_2^2 \\cos^2\\theta_1 = n_1^2 \\left(1 - \\frac{n_1^2}{\\tilde{n}_2^2} \\sin^2\\theta_1\\right) $$\n使用 $\\cos^2\\theta_1 = 1-\\sin^2\\theta_1$ 并整理以求解 $\\sin^2\\theta_1$：\n$$ \\tilde{n}_2^2 (1-\\sin^2\\theta_1) = n_1^2 - \\frac{n_1^4}{\\tilde{n}_2^2} \\sin^2\\theta_1 $$\n$$ \\sin^2\\theta_1 \\left( \\frac{n_1^4}{\\tilde{n}_2^2} - \\tilde{n}_2^2 \\right) = n_1^2 - \\tilde{n}_2^2 $$\n$$ \\sin^2\\theta_1 \\frac{n_1^4 - \\tilde{n}_2^4}{\\tilde{n}_2^2} = n_1^2 - \\tilde{n}_2^2 $$\n假设 $n_1^2 \\neq \\tilde{n}_2^2$（如果 $\\kappa_2>0$，则该条件必须成立），我们可以除以 $n_1^2 - \\tilde{n}_2^2$：\n$$ \\sin^2\\theta_1 \\frac{(n_1^2-\\tilde{n}_2^2)(n_1^2+\\tilde{n}_2^2)}{\\tilde{n}_2^2} = n_1^2 - \\tilde{n}_2^2 \\implies \\sin^2\\theta_1 = \\frac{\\tilde{n}_2^2}{n_1^2 + \\tilde{n}_2^2} $$\n要使 $\\theta_1$ 为实数入射角，$\\sin^2\\theta_1$ 必须是范围在 $[0, 1]$ 内的实数。让我们检查右边是否为实数。设 $\\varepsilon_1 = n_1^2$（实数）和 $\\varepsilon_2 = \\tilde{n}_2^2$。\n$$ \\sin^2\\theta_1 = \\frac{\\varepsilon_2}{\\varepsilon_1 + \\varepsilon_2} $$\n该介质是耗散的，因此 $\\operatorname{Im}(\\varepsilon_2) = \\operatorname{Im}((n_2' + i\\kappa_2)^2) = 2n_2'\\kappa_2  0$。设 $\\varepsilon_2 = \\varepsilon_2' + i\\varepsilon_2''$，其中 $\\varepsilon_2''  0$。\n$$ \\sin^2\\theta_1 = \\frac{\\varepsilon_2' + i\\varepsilon_2''}{(\\varepsilon_1 + \\varepsilon_2') + i\\varepsilon_2''} $$\n该表达式的虚部是：\n$$ \\operatorname{Im}(\\sin^2\\theta_1) = \\frac{\\varepsilon_2''(\\varepsilon_1 + \\varepsilon_2') - \\varepsilon_2'(\\varepsilon_2'')}{(\\varepsilon_1 + \\varepsilon_2')^2 + (\\varepsilon_2'')^2} = \\frac{\\varepsilon_1 \\varepsilon_2''}{(\\varepsilon_1 + \\varepsilon_2')^2 + (\\varepsilon_2'')^2} $$\n因为 $\\varepsilon_1 = n_1^2  0$ 且 $\\varepsilon_2'' = 2n_2'\\kappa_2  0$，所以分子严格为正。分母也严格为正。因此，$\\operatorname{Im}(\\sin^2\\theta_1)  0$。\n实数角 $\\theta_1$ 必须有一个实数的 $\\sin^2\\theta_1$。而所要求的 $\\sin^2\\theta_1$ 是复数这一事实导致了矛盾。因此，没有实数入射角 $\\theta_1$ 能满足条件 $r_p=0$。反射率 $R_p = |r_p|^2$ 可以有最小值，但对于耗散介质，它永远不能为零。\n\n3) 有损耗情况下的全内反射（TIR）。\n在无损耗情况（$\\kappa_2=0$）下，当 $n_1 > n_2$ 且入射角 $\\theta_1$ 大于临界角 $\\theta_c = \\arcsin(n_2/n_1)$ 时，发生TIR。对于 $\\theta_1  \\theta_c$，$\\sin\\theta_2 = (n_1/n_2)\\sin\\theta_1  1$，使得 $\\cos\\theta_2 = \\sqrt{1-\\sin^2\\theta_2}$ 为纯虚数，即 $\\cos\\theta_2 = i\\beta$（对于某个实数 $\\beta$）。反射系数变为 $r_p = \\frac{n_2\\cos\\theta_1 - in_1\\beta}{n_2\\cos\\theta_1 + in_1\\beta}$，这是一个复数与其共轭复数的比值。其幅度为 $|r_p|=1$，意味着全反射。\n\n在有损耗情况（$\\kappa_20$）下，完美TIR对应于条件 $|r_p|=1$。这意味着没有能量传输到第二种介质中。在介质2中，单位体积内的时间平均耗散功率由 $\\frac{1}{2}\\omega \\operatorname{Im}(\\varepsilon_2) |\\vec{E_t}|^2$ 给出。由于我们假设 $\\kappa_2  0$，我们有 $\\operatorname{Im}(\\varepsilon_2) = 2n_2'\\kappa_2  0$。除非透射场 $\\vec{E_t}$ 恒等于零，否则在介质2内部必定有能量耗散。如果 $\\vec{E_t}=0$，则边界条件将要求入射场也为零，这是一个平凡解。因此，非零的入射场意味着 $\\vec{E_t}$ 非零，并且有功率被耗散。\n\n这部分耗散的能量必须由入射波提供。界面处的能量平衡要求入射功率流等于反射功率流与吸收功率流之和。如果 $|r_p|=1$，则反射率 $R_p=1$，意味着所有入射功率都被反射。这就没有功率可以传输到介质2中，以解释那里必须发生的耗散。这是一个物理上的矛盾。因此，必须有能量的净流入到有损介质中，这意味着吸收率大于零，因此，反射率 $R_p$ 必须严格小于 $1$。\n因此，当从耗散介质反射时，完美的全内反射（$|r_p|=1$）是不可能的。\n\n4) 最小反射率的小损耗分析。\n题目要求我们找到使 $R_p = |r_p|^2$ 最小的角度 $\\theta_{min}$，对于 $n_1=1.50$ 和 $\\tilde{n}_2=2.10+i\\,0.12$。如第 (2) 部分所示，反射率的最小值非零。题目指出，小损耗分析显示 $\\theta_{min}$ 与无损耗布儒斯特角 $\\theta_{B,0}$ 的差异仅在 $\\kappa_2$ 的二阶上。我们可以通过考虑复数布儒斯特角 $\\theta_B$（其中 $r_p(\\theta_B) = 0$）来证明这一点。\n如第 (2) 部分所求，$\\sin^2\\theta_B = \\tilde{n}_2^2 / (n_1^2 + \\tilde{n}_2^2)$。\n对于实数 $\\theta_1$，使 $R_p$ 最小的角度，记为 $\\theta_{min}$，可以很好地由 $\\operatorname{Re}(\\theta_B)$ 近似。我们对小的 $\\kappa_2$ 展开 $\\sin^2\\theta_B$。设 $n_2' = 2.10$ 和 $\\kappa_2=0.12$。\n在 $\\kappa_2$ 的一阶近似下，$\\tilde{n}_2^2 = (n_2'+i\\kappa_2)^2 \\approx n_2'^2 + 2in_2'\\kappa_2$。\n$$ \\sin^2\\theta_B \\approx \\frac{n_2'^2 + 2in_2'\\kappa_2}{n_1^2 + n_2'^2 + 2in_2'\\kappa_2} = \\left(\\frac{n_2'^2}{n_1^2 + n_2'^2}\\right) \\frac{1 + 2i\\kappa_2/n_2'}{1 + 2in_2'\\kappa_2/(n_1^2+n_2'^2)} $$\n无损耗布儒斯特角 $\\theta_{B,0}$ 满足 $\\tan\\theta_{B,0} = n_2'/n_1$，这给出 $\\sin^2\\theta_{B,0} = \\frac{(n_2'/n_1)^2}{1+(n_2'/n_1)^2} = \\frac{n_2'^2}{n_1^2+n_2'^2}$。\n$$ \\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} \\left(1 + \\frac{2i\\kappa_2}{n_2'}\\right) \\left(1 - \\frac{2in_2'\\kappa_2}{n_1^2+n_2'^2}\\right) $$\n$$ \\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} \\left(1 + 2i\\kappa_2 \\left(\\frac{1}{n_2'} - \\frac{n_2'}{n_1^2+n_2'^2}\\right)\\right) + O(\\kappa_2^2) $$\n$$ \\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} + i \\cdot 2\\kappa_2 \\sin^2\\theta_{B,0} \\left(\\frac{n_1^2+n_2'^2 - n_2'^2}{n_2'(n_1^2+n_2'^2)}\\right) = \\sin^2\\theta_{B,0} + i \\frac{2\\kappa_2 n_1^2 n_2'}{(n_1^2+n_2'^2)^2} $$\n设 $\\theta_B = \\theta_{B,0} + \\Delta\\theta$。对于小的 $\\Delta\\theta$，$\\sin^2\\theta_B \\approx \\sin^2\\theta_{B,0} + \\Delta\\theta \\sin(2\\theta_{B,0})$。\n比较这两个表达式，$\\Delta\\theta \\sin(2\\theta_{B,0})$ 是一个 $\\kappa_2$ 量级的纯虚数项。这意味着 $\\Delta\\theta$ 本身在 $\\kappa_2$ 的一阶上是纯虚数。\n因此，$\\operatorname{Re}(\\theta_B) = \\theta_{B,0} + O(\\kappa_2^2)$。由于 $\\theta_{min} \\approx \\operatorname{Re}(\\theta_B)$，最小化角度与无损耗布儒斯特角的差异仅在 $\\kappa_2$ 的二阶上。在主导阶上，最小化角度是无损耗布儒斯特角：\n$$ \\theta_{min} \\approx \\theta_{B,0} = \\arctan\\left(\\frac{n_2'}{n_1}\\right) $$\n使用给定值 $n_1=1.50$ 和 $n_2'=2.10$：\n$$ \\theta_{B,0} = \\arctan\\left(\\frac{2.10}{1.50}\\right) = \\arctan(1.40) $$\n以弧度计算该值：\n$$ \\theta_{B,0} \\approx 0.950546... \\text{ rad} $$\n四舍五入到四位有效数字，主导阶的最小化角度是 $0.9505$ 弧度。", "answer": "$$\\boxed{0.9505}$$", "id": "2810155"}, {"introduction": "理论学习的最终目的是应用于实际。在材料科学中，我们常常需要通过外部测量来确定材料未知的内在光学常数，这是一个典型的“反问题”。本练习 [@problem_id:2810177] 将理论与强大的实验技术——椭圆偏振光谱法（ellipsometry）——联系起来。你不仅需要从菲涅尔方程出发，推导出从椭偏参数 $\\rho$ 反演计算材料复介电函数 $\\varepsilon$ 的精确解析表达式，还需要通过编程实现这一算法。这个过程将让你全面体验从理论推导到数据处理的完整流程，这是现代光学材料表征的关键技能。", "problem": "您的任务是反演椭偏测量数据，以求取各向同性、半无限体材料的复介电函数。椭偏术测量 p 偏振和 s 偏振的 Fresnel 反射系数的复数比，定义为 $\\rho = \\tan(\\Psi)\\,\\exp(\\mathrm{i}\\Delta) = r_p / r_s$，其中 $r_p$ 和 $r_s$ 分别是 p 偏振和 s 偏振的复反射系数，$\\Psi$ 是椭偏振幅比，$\\Delta$ 是椭偏相位差。对于一个非磁性环境介质（折射率为 $n_0$，实数，非吸收）和一个以复介电函数 $\\varepsilon$（无量纲）为特征的非磁性样品之间的平面界面，在入射角为 $\\theta$（单位为度）的情况下进行照射，并假设衬底为半无限大（无背面反射）。\n\n请从基本电磁边界条件和 Fresnel 方程出发，依据第一性原理推导一个关于 $\\rho$、$n_0$ 和 $\\theta$ 的 $\\varepsilon$ 的显式表达式，过程中不使用任何额外的捷径。然后，实现一个程序，使用您推导的表达式为以下测试套件计算 $\\varepsilon$。\n\n使用以下精确的测试用例。每个测试用例提供一个入射角 $\\theta$（单位为度）、一个环境折射率 $n_0$（无量纲）和一个复数椭偏比 $\\rho$（无量纲）。虚数单位用 $\\mathrm{i}$ 表示。\n\n- 测试用例 1：$\\theta = 60$，$n_0 = 1.0$，$\\rho = 0.5 + 0.2\\,\\mathrm{i}$。\n- 测试用例 2：$\\theta = 75$，$n_0 = 1.0$，$\\rho = 0.2 - 0.8\\,\\mathrm{i}$。\n- 测试用例 3：$\\theta = 65$，$n_0 = 1.33$，$\\rho = 0.3 + 0.1\\,\\mathrm{i}$。\n- 测试用例 4：$\\theta = 85$，$n_0 = 1.0$，$\\rho = -0.2 + 0.05\\,\\mathrm{i}$。\n\n要求和约定：\n- 角度必须以度为单位进行解释。\n- 介电函数 $\\varepsilon$ 是无量纲的。\n- 您的程序必须为每个测试用例计算复介电函数 $\\varepsilon = \\varepsilon_1 + \\mathrm{i}\\,\\varepsilon_2$，并为每个用例返回两个浮点数：$\\varepsilon_1$ 和 $\\varepsilon_2$。\n- 数值格式：将实部和虚部都四舍五入到 $6$ 位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，列表中的每个元素是一个包含两个元素的列表，形式为 $[\\varepsilon_1,\\varepsilon_2]$，两个条目都四舍五入到 $6$ 位小数。例如，输出必须类似于 $[[x_1,y_1],[x_2,y_2],\\dots]$，不含多余的空格或文本。\n\n交付内容：\n- 一个完整、可运行的程序，该程序对所提供的测试套件进行计算，并以要求的精确单行格式打印结果。", "solution": "问题要求从椭偏数据中推导各向同性、半无限体材料的复介电函数 $\\varepsilon$ 的显式表达式。提供的数据为复反射比 $\\rho$、入射角 $\\theta$ 以及非吸收环境介质的折射率 $n_0$。推导必须从第一性原理出发，在此背景下，这意味着从 Fresnel 反射系数开始，而这些系数本身是在界面上应用电磁边界条件的直接结果。\n\n该物理系统是两种介质之间的一个平面界面。介质 $0$ 是环境介质，其折射率为实数 $n_0$。介质 $1$ 是衬底，其复折射率为 $n_1$，复介电函数为 $\\varepsilon$。对于非磁性材料，这些量之间的关系是 $\\varepsilon = n_1^2$。波从介质 $0$ 以角度 $\\theta_0 = \\theta$ 入射，并以一个复数角 $\\theta_1$ 折射进入介质 $1$。\n\n界面处 s 偏振光 ($r_s$) 和 p 偏振光 ($r_p$) 的 Fresnel 反射系数由下式给出：\n$$r_s = \\frac{n_0 \\cos\\theta_0 - n_1 \\cos\\theta_1}{n_0 \\cos\\theta_0 + n_1 \\cos\\theta_1}$$\n$$r_p = \\frac{n_1 \\cos\\theta_0 - n_0 \\cos\\theta_1}{n_1 \\cos\\theta_0 + n_0 \\cos\\theta_1}$$\n\n椭偏术的基本方程定义了复数比 $\\rho$：\n$$\\rho = \\frac{r_p}{r_s}$$\n\n我们的目标是通过反演此方程来找到 $\\varepsilon = n_1^2$ 的表达式。一个有效的代数策略是处理量 $(1-\\rho)/(1+\\rho)$：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{1 - r_p/r_s}{1 + r_p/r_s} = \\frac{r_s - r_p}{r_s + r_p}$$\n现在让我们计算反射系数的和与差。为简洁起见，设 $c_0 = \\cos\\theta_0$ 和 $c_1 = \\cos\\theta_1$。\n$$r_s + r_p = \\frac{n_0 c_0 - n_1 c_1}{n_0 c_0 + n_1 c_1} + \\frac{n_1 c_0 - n_0 c_1}{n_1 c_0 + n_0 c_1}$$\n$$r_s + r_p = \\frac{(n_0 c_0 - n_1 c_1)(n_1 c_0 + n_0 c_1) + (n_1 c_0 - n_0 c_1)(n_0 c_0 + n_1 c_1)}{(n_0 c_0 + n_1 c_1)(n_1 c_0 + n_0 c_1)}$$\n分子展开为：\n$$(n_0 n_1 c_0^2 + n_0^2 c_0 c_1 - n_1^2 c_0 c_1 - n_0 n_1 c_1^2) + (n_1 n_0 c_0^2 + n_1^2 c_0 c_1 - n_0^2 c_0 c_1 - n_0 n_1 c_1^2) = 2 n_0 n_1 (c_0^2 - c_1^2)$$\n差 $r_s - r_p$ 为：\n$$r_s - r_p = \\frac{(n_0 c_0 - n_1 c_1)(n_1 c_0 + n_0 c_1) - (n_1 c_0 - n_0 c_1)(n_0 c_0 + n_1 c_1)}{(n_0 c_0 + n_1 c_1)(n_1 c_0 + n_0 c_1)}$$\n分子展开为：\n$$(n_0 n_1 c_0^2 + n_0^2 c_0 c_1 - n_1^2 c_0 c_1 - n_0 n_1 c_1^2) - (n_1 n_0 c_0^2 + n_1^2 c_0 c_1 - n_0^2 c_0 c_1 - n_0 n_1 c_1^2) = 2 c_0 c_1 (n_0^2 - n_1^2)$$\n将这些代入 $(1-\\rho)/(1+\\rho)$ 的表达式中：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{2 c_0 c_1 (n_0^2 - n_1^2)}{2 n_0 n_1 (c_0^2 - c_1^2)} = \\frac{\\cos\\theta_0 \\cos\\theta_1 (n_0^2 - n_1^2)}{n_0 n_1 (\\cos^2\\theta_0 - \\cos^2\\theta_1)}$$\n使用恒等式 $\\cos^2 x = 1 - \\sin^2 x$，项 $(\\cos^2\\theta_0 - \\cos^2\\theta_1)$ 变为 $(\\sin^2\\theta_1 - \\sin^2\\theta_0)$。\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{\\cos\\theta_0 \\cos\\theta_1 (n_0^2 - n_1^2)}{n_0 n_1 (\\sin^2\\theta_1 - \\sin^2\\theta_0)}$$\n现在，我们使用 Snell 定律 $n_0 \\sin\\theta_0 = n_1 \\sin\\theta_1$，这意味着 $\\sin^2\\theta_1 = (n_0/n_1)^2 \\sin^2\\theta_0$。我们将其代入分母：\n$$n_0 n_1 (\\sin^2\\theta_1 - \\sin^2\\theta_0) = n_0 n_1 \\left( \\frac{n_0^2}{n_1^2}\\sin^2\\theta_0 - \\sin^2\\theta_0 \\right) = n_0 n_1 \\sin^2\\theta_0 \\left( \\frac{n_0^2 - n_1^2}{n_1^2} \\right) = \\frac{n_0}{n_1} \\sin^2\\theta_0 (n_0^2 - n_1^2)$$\n将其代回主表达式：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{\\cos\\theta_0 \\cos\\theta_1 (n_0^2 - n_1^2)}{\\frac{n_0}{n_1} \\sin^2\\theta_0 (n_0^2 - n_1^2)} = \\frac{n_1 \\cos\\theta_0 \\cos\\theta_1}{n_0 \\sin^2\\theta_0}$$\n这个表达式仍然包含未知角度 $\\theta_1$。我们可以再次使用 Snell 定律来表示 $\\cos\\theta_1$，从而消去它：\n$$\\cos\\theta_1 = \\sqrt{1 - \\sin^2\\theta_1} = \\sqrt{1 - \\frac{n_0^2 \\sin^2\\theta_0}{n_1^2}} = \\frac{\\sqrt{n_1^2 - n_0^2 \\sin^2\\theta_0}}{n_1}$$\n将此代入我们关于 $(1-\\rho)/(1+\\rho)$ 的方程中：\n$$\\frac{1-\\rho}{1+\\rho} = \\frac{n_1 \\cos\\theta_0}{n_0 \\sin^2\\theta_0} \\left( \\frac{\\sqrt{n_1^2 - n_0^2 \\sin^2\\theta_0}}{n_1} \\right) = \\frac{\\cos\\theta_0 \\sqrt{n_1^2 - n_0^2 \\sin^2\\theta_0}}{n_0 \\sin^2\\theta_0}$$\n我们现在可以求解 $n_1^2 = \\varepsilon$。设 $\\theta_0=\\theta$。\n$$\\left( \\frac{1-\\rho}{1+\\rho} \\right) \\frac{n_0 \\sin^2\\theta}{\\cos\\theta} = \\sqrt{n_1^2 - n_0^2 \\sin^2\\theta}$$\n两边平方得到：\n$$\\left( \\frac{1-\\rho}{1+\\rho} \\right)^2 \\frac{n_0^2 \\sin^4\\theta}{\\cos^2\\theta} = n_1^2 - n_0^2 \\sin^2\\theta$$\n$$n_1^2 = n_0^2 \\sin^2\\theta + n_0^2 \\frac{\\sin^4\\theta}{\\cos^2\\theta} \\left( \\frac{1-\\rho}{1+\\rho} \\right)^2$$\n提出公因式 $n_0^2 \\sin^2\\theta$ 并使用 $\\tan^2\\theta = \\sin^2\\theta/\\cos^2\\theta$：\n$$n_1^2 = n_0^2 \\sin^2\\theta \\left[ 1 + \\tan^2\\theta \\left( \\frac{1-\\rho}{1+\\rho} \\right)^2 \\right]$$\n最后，根据 $\\varepsilon = n_1^2$，我们得到了复介电函数的显式表达式：\n$$\\varepsilon = n_0^2 \\sin^2\\theta \\left[ 1 + \\tan^2\\theta \\left( \\frac{1-\\rho}{1+\\rho} \\right)^2 \\right]$$\n这就是所要求的公式。程序将实现此方程，为给定的测试用例计算 $\\varepsilon = \\varepsilon_1 + \\mathrm{i}\\,\\varepsilon_2$。角度 $\\theta$ 必须从度转换为弧度，以便在三角函数中使用。复数运算通过使用 Python 的原生 `complex` 类型和 `numpy` 函数来处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the complex dielectric function from ellipsometric data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (theta_degrees, n0, rho_complex)\n    test_cases = [\n        (60, 1.0, 0.5 + 0.2j),\n        (75, 1.0, 0.2 - 0.8j),\n        (65, 1.33, 0.3 + 0.1j),\n        (85, 1.0, -0.2 + 0.05j),\n    ]\n\n    results = []\n    for case in test_cases:\n        theta_deg, n0, rho = case\n\n        # Convert angle of incidence from degrees to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n\n        # Pre-calculate trigonometric values\n        sin_theta = np.sin(theta_rad)\n        tan_theta = np.tan(theta_rad)\n        \n        # Calculate the dielectric function epsilon using the derived formula:\n        # epsilon = n0^2 * sin^2(theta) * [1 + tan^2(theta) * ((1-rho)/(1+rho))^2]\n        \n        # Calculate the term involving rho\n        rho_term = (1 - rho) / (1 + rho)\n        \n        # Calculate epsilon\n        epsilon = (n0 * sin_theta)**2 * (1 + (tan_theta * rho_term)**2)\n        \n        # Extract real (e1) and imaginary (e2) parts\n        e1 = epsilon.real\n        e2 = epsilon.imag\n        \n        # Round the results to 6 decimal places as required\n        e1_rounded = round(e1, 6)\n        e2_rounded = round(e2, 6)\n        \n        results.append([e1_rounded, e2_rounded])\n\n    # Format the final output string according to the problem specification.\n    # Example format: [[x1,y1],[x2,y2],...]\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n\n    # The final print statement must produce only the specified single-line format.\n    print(output_str)\n\nsolve()\n```", "id": "2810177"}]}