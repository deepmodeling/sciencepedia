{"hands_on_practices": [{"introduction": "理解材料的介电特性需要我们确定单个原子所经历的实际电场，即“局域场”。其中一个关键组成部分是洛伦兹场，它源于周围介质的极化。第一个练习 [@problem_id:1818309] 为给定的宏观极化强度提供了一个直接的、定量的洛伦兹场计算，为该场在典型电介质中的量级建立一个基准。", "problem": "一种具有简单立方晶格的非极性各向同性电介质材料被置于均匀外电场中。该过程在整个材料中诱导产生均匀的净电极化。为了模拟电介质的行为，我们考虑单个原子位置处的局域电场。对该局域电场的一个重要贡献，即所谓的洛伦兹场，来自于以原子为中心的假想球形空腔表面上的束缚电荷。\n\n假设该材料产生了大小为 $P = 0.0150 \\text{ C/m}^2$ 的均匀极化。计算该材料内部洛伦兹场的大小。使用真空介电常数值 $\\epsilon_0 = 8.854 \\times 10^{-12} \\text{ F/m}$。\n\n答案以伏特每米 (V/m) 为单位，并四舍五入到三位有效数字。", "solution": "在均匀极化的各向同性电介质中，以原子为中心、半径为 $a$ 的球形空腔表面上的束缚面电荷密度为 $\\sigma_{b} = P \\cos\\theta$，其中 $\\theta$ 是相对于极化方向的极角。空腔中心的洛伦兹场由该表面电荷产生。来自面元 $dA = a^{2}\\sin\\theta\\,d\\theta\\,d\\phi$ 对沿极化轴（$z$轴）方向电场的贡献为\n$$\ndE_{z} = \\frac{1}{4\\pi\\epsilon_{0}} \\frac{\\sigma_{b}\\cos\\theta\\,dA}{a^{2}} = \\frac{1}{4\\pi\\epsilon_{0}} P\\cos^{2}\\theta \\sin\\theta\\, d\\theta\\, d\\phi.\n$$\n对整个球面进行积分，\n$$\nE_{L} = \\frac{1}{4\\pi\\epsilon_{0}} P \\int_{0}^{2\\pi}\\!\\!\\int_{0}^{\\pi} \\cos^{2}\\theta \\sin\\theta\\, d\\theta\\, d\\phi = \\frac{1}{4\\pi\\epsilon_{0}} P \\cdot 2\\pi \\int_{0}^{\\pi} \\cos^{2}\\theta \\sin\\theta\\, d\\theta.\n$$\n使用换元法 $u=\\cos\\theta$, $du=-\\sin\\theta\\,d\\theta$，该积分的计算结果为\n$$\n\\int_{0}^{\\pi} \\cos^{2}\\theta \\sin\\theta\\, d\\theta = -\\int_{1}^{-1} u^{2}\\, du = \\int_{-1}^{1} u^{2}\\, du = \\left[\\frac{u^{3}}{3}\\right]_{-1}^{1} = \\frac{2}{3}.\n$$\n因此，洛伦兹场的大小为\n$$\nE_{L} = \\frac{1}{4\\pi\\epsilon_{0}} P \\cdot 2\\pi \\cdot \\frac{2}{3} = \\frac{P}{3\\epsilon_{0}}.\n$$\n代入给定的数值以得到数值结果，\n$$\nE_{L} = \\frac{0.0150}{3 \\times 8.854 \\times 10^{-12}} = \\frac{0.0150}{2.6562 \\times 10^{-11}} \\approx 5.647 \\times 10^{8} \\text{ V/m}.\n$$\n四舍五入到三位有效数字，其大小为\n$$\n5.65 \\times 10^{8} \\text{ V/m}.\n$$", "answer": "$$\\boxed{5.65 \\times 10^{8}}$$", "id": "1818309"}, {"introduction": "著名的洛伦兹场公式 $E_L = P/(3\\epsilon_0)$ 仅对具有立方晶格对称性或各向同性的材料严格有效。在现实中，局域场的结构与晶体的具体原子排列密切相关。这个实践问题 [@problem_id:1818305] 通过要求您计算各向异性的四方晶格中最近邻原子对局域场的贡献，来探索这种依赖关系，从而展示场是如何变得与方向相关的。", "problem": "一个假设的介电晶体由排列在简单四方晶格上的原子组成，其晶格常数为 $a=b$ 和 $c$，其中 $a \\neq c$。当施加外部电场时，每个原子都会产生一个感应偶极矩 $\\vec{p}$，该偶极矩与其所在位置的局域电场方向一致。\n\n任何给定原子处的局域电场是外部电场与晶体中所有其他原子的偶极子产生的电场之和。为了分析周围偶极子的贡献，我们关注位于原点 $(0,0,0)$ 的原子其最近邻原子产生的电场。对于一个简单四方晶格，这些最近邻位于六个位置：$(\\pm a, 0, 0)$、$(0, \\pm a, 0)$ 和 $(0, 0, \\pm c)$。\n\n我们将研究感应偶极子的取向如何影响这个最近邻电场贡献，我们将其表示为 $\\vec{E}_{nn}$。\n\n考虑两种不同的情况：\n1.  晶体中所有原子都具有偶极矩 $\\vec{p} = p\\hat{k}$，其中 $p$ 是一个恒定的模，$\\hat{k}$ 是沿 z 轴（平行于 c 轴）的单位矢量。设 $(E_{nn})_z$ 是最近邻电场 $\\vec{E}_{nn}$ 在原点处沿 z 轴的分量。\n2.  晶体中所有原子都具有偶极矩 $\\vec{p} = p\\hat{i}$，其中 $\\hat{i}$ 是沿 x 轴（平行于其中一个 a 轴）的单位矢量。设 $(E_{nn})_x$ 是最近邻电场 $\\vec{E}_{nn}$ 在原点处沿 x 轴的分量。\n\n计算差值 $(E_{nn})_z - (E_{nn})_x$。请用偶极矩大小 $p$、晶格常数 $a$ 和 $c$ 以及自由空间介电常数 $\\epsilon_0$ 来表示你的最终答案的解析表达式。", "solution": "由点偶极子 $\\vec{p}$ 在距离偶极子 $\\vec{r}$ 处产生的位置的电场 $\\vec{E}$ 为：\n$$ \\vec{E}(\\vec{r}) = \\frac{1}{4\\pi\\epsilon_0} \\left( \\frac{3(\\vec{p} \\cdot \\vec{r})\\vec{r}}{r^5} - \\frac{\\vec{p}}{r^3} \\right) $$\n原点处的电场 $\\vec{E}_{nn}$ 是来自六个最近邻的电场的矢量和。\n\n**步骤 1：计算情况 1 的 $(E_{nn})_z$**\n\n在这种情况下，所有偶极子为 $\\vec{p} = p\\hat{k}$。我们需要计算原点处总电场的 z 分量，$(E_{nn})_z = \\vec{E}_{nn} \\cdot \\hat{k}$。\n\n六个最近邻位于：\n- 两个邻居位于 $\\vec{r}_{1,2} = \\pm a\\hat{i}$。对于这些， $r=a$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{k}) \\cdot (\\pm a\\hat{i}) = 0$。\n这两个偶极子各自产生的电场为 $\\vec{E}_{1,2} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{k}}{a^3})$。其 z 分量为 $-\\frac{p}{4\\pi\\epsilon_0 a^3}$。\n- 两个邻居位于 $\\vec{r}_{3,4} = \\pm a\\hat{j}$。对于这些， $r=a$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{k}) \\cdot (\\pm a\\hat{j}) = 0$。\n各自产生的电场为 $\\vec{E}_{3,4} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{k}}{a^3})$。其 z 分量为 $-\\frac{p}{4\\pi\\epsilon_0 a^3}$。\n- 两个邻居位于 $\\vec{r}_{5,6} = \\pm c\\hat{k}$。对于这些， $r=c$。对于 $\\vec{r}_5 = c\\hat{k}$，$\\vec{p} \\cdot \\vec{r}_5 = (p\\hat{k}) \\cdot (c\\hat{k}) = pc$。\n这个偶极子产生的电场为 $\\vec{E}_5 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(pc)(c\\hat{k})}{c^5} - \\frac{p\\hat{k}}{c^3}) = \\frac{p}{4\\pi\\epsilon_0 c^3}(3\\hat{k} - \\hat{k}) = \\frac{2p}{4\\pi\\epsilon_0 c^3}\\hat{k}$。\n其 z 分量为 $\\frac{2p}{4\\pi\\epsilon_0 c^3}$。\n对于 $\\vec{r}_6 = -c\\hat{k}$，$\\vec{p} \\cdot \\vec{r}_6 = (p\\hat{k}) \\cdot (-c\\hat{k}) = -pc$。\n电场为 $\\vec{E}_6 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(-pc)(-c\\hat{k})}{c^5} - \\frac{p\\hat{k}}{c^3}) = \\frac{p}{4\\pi\\epsilon_0 c^3}(3\\hat{k} - \\hat{k}) = \\frac{2p}{4\\pi\\epsilon_0 c^3}\\hat{k}$。\n其 z 分量也为 $\\frac{2p}{4\\pi\\epsilon_0 c^3}$。\n\n将所有六个邻居的 z 分量相加：\n$$ (E_{nn})_z = 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( \\frac{2p}{4\\pi\\epsilon_0 c^3} \\right) $$\n$$ (E_{nn})_z = \\frac{p}{4\\pi\\epsilon_0} \\left( -\\frac{4}{a^3} + \\frac{4}{c^3} \\right) = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n\n**步骤 2：计算情况 2 的 $(E_{nn})_x$**\n\n在这种情况下，所有偶极子为 $\\vec{p} = p\\hat{i}$。我们需要计算总电场的 x 分量，$(E_{nn})_x = \\vec{E}_{nn} \\cdot \\hat{i}$。\n\n- 两个邻居位于 $\\vec{r}_{1,2} = \\pm a\\hat{i}$。对于这些， $r=a$。对于 $\\vec{r}_1=a\\hat{i}$，$\\vec{p}\\cdot\\vec{r}_1 = (p\\hat{i})\\cdot(a\\hat{i}) = pa$。\n这个偶极子产生的电场为 $\\vec{E}_1 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(pa)(a\\hat{i})}{a^5} - \\frac{p\\hat{i}}{a^3}) = \\frac{2p}{4\\pi\\epsilon_0 a^3}\\hat{i}$。其 x 分量为 $\\frac{2p}{4\\pi\\epsilon_0 a^3}$。根据对称性，位于 $\\vec{r}_2=-a\\hat{i}$ 的偶极子产生相同的电场。\n- 两个邻居位于 $\\vec{r}_{3,4} = \\pm a\\hat{j}$。对于这些， $r=a$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{i}) \\cdot (\\pm a\\hat{j}) = 0$。\n各自产生的电场为 $\\vec{E}_{3,4} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{i}}{a^3})$。其 x 分量为 $-\\frac{p}{4\\pi\\epsilon_0 a^3}$。\n- 两个邻居位于 $\\vec{r}_{5,6} = \\pm c\\hat{k}$。对于这些， $r=c$ 且 $\\vec{p} \\cdot \\vec{r} = (p\\hat{i}) \\cdot (\\pm c\\hat{k}) = 0$。\n各自产生的电场为 $\\vec{E}_{5,6} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{i}}{c^3})$。其 x 分量为 $-\\frac{p}{4\\pi\\epsilon_0 c^3}$。\n\n将所有六个邻居的 x 分量相加：\n$$ (E_{nn})_x = 2 \\left( \\frac{2p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 c^3} \\right) $$\n$$ (E_{nn})_x = \\frac{p}{4\\pi\\epsilon_0} \\left( \\frac{4}{a^3} - \\frac{2}{a^3} - \\frac{2}{c^3} \\right) = \\frac{p}{4\\pi\\epsilon_0} \\left( \\frac{2}{a^3} - \\frac{2}{c^3} \\right) = \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{a^3} - \\frac{1}{c^3} \\right) $$\n\n**步骤 3：计算差值 $(E_{nn})_z - (E_{nn})_x$**\n\n现在我们从 $(E_{nn})_z$ 的表达式中减去 $(E_{nn})_x$ 的表达式：\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) - \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{a^3} - \\frac{1}{c^3} \\right) $$\n为了合并这些项，我们提出公因式 $\\frac{p}{2\\pi\\epsilon_0}$ 并重写第二项：\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) + \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{2\\pi\\epsilon_0} \\left[ 2\\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) + \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) \\right] $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{2\\pi\\epsilon_0} \\left[ 3\\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) \\right] $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{3p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n这个结果表明，内场贡献是各向异性的（即，它依赖于方向），并且只有当 $a=c$ 时，这种各向异性才会消失，这对应于立方晶格的情况。", "answer": "$$\\boxed{\\frac{3p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right)}$$", "id": "1818305"}, {"introduction": "洛伦兹场是通过将一个假想空腔外的极化材料视作连续介质而推导出来的。但是，当处理由分立原子构成的真实晶格时，这种连续介质近似的准确性如何？这个计算练习 [@problem_id:2836909] 直面这个基本问题。通过编写程序对分立偶极子阵列的电场进行求和，您将直接把结果与连续介质模型进行比较，从而深入了解有限空腔修正的性质和量级。", "problem": "你的任务是通过显式求和在晶格点周围挖出的球形腔外的离散偶极子场，来计算晶体电介质中洛伦兹局域场的有限腔修正。请从以下基本依据开始：\n\n- 极化的定义：对于均匀极化 $\\mathbf{P} = P \\,\\hat{\\mathbf{z}}$，每个格点的偶极矩为 $\\boldsymbol{\\mu} = \\mu \\,\\hat{\\mathbf{z}}$，其中 $\\mu = P \\, V_{\\text{site}}$，$V_{\\text{site}}$ 是每个晶格点的体积。\n- 点偶极子的静电场：位于原点的点偶极子 $\\boldsymbol{\\mu}$ 在位置 $\\mathbf{r}$ 处产生的电场为\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[\\frac{3(\\boldsymbol{\\mu}\\cdot \\hat{\\mathbf{r}})\\,\\hat{\\mathbf{r}} - \\boldsymbol{\\mu}}{r^3}\\right],\n$$\n其中 $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ 且 $r=\\|\\mathbf{r}\\|$。\n- 对于嵌入均匀极化连续介质中的球形腔，由于腔外极化物质在中心产生的场沿 $\\hat{\\mathbf{z}}$ 方向等于 $E_{z}^{\\text{cont}} = P/(3\\varepsilon_0)$。在 $1/(4\\pi\\varepsilon_0)=1$ 的单位制中，此参考值等于 $E_{z}^{\\text{cont}} = 4\\pi P/3$。\n\n你将为三种立方晶格建模：简单立方 (SC)、体心立方 (BCC) 和面心立方 (FCC)。取一个晶格常数为 $a$ 的常规立方晶胞，其基矢为：\n- SC：一个位于分数坐标 $(0,0,0)$ 的格点，因此 $n_{\\text{site}}=1$，\n- BCC：位于 $(0,0,0)$ 和 $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$ 的格点，因此 $n_{\\text{site}}=2$，\n- FCC：位于 $(0,0,0)$、$(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$(\\tfrac{1}{2},0,\\tfrac{1}{2})$ 和 $(\\tfrac{1}{2},\\tfrac{1}{2},0)$ 的格点，因此 $n_{\\text{site}}=4$。\n\n设 $\\mathbf{P}=P\\,\\hat{\\mathbf{z}}$，其中 $P$ 为常数。对于每种晶格类型，构建一个由整数索引 $(i,j,k)$（$-N \\le i,j,k \\le N$）界定的常规晶胞有限立方阵列，形成一个边长为 $(2N+1)a$ 的超胞。对于所选晶格中的每个基矢 $(\\xi,\\eta,\\zeta)$，在位置 $\\mathbf{r} = a\\,(i+\\xi, j+\\eta, k+\\zeta)$ 处放置偶极子。通过排除所有 $r  R_c$ 的格点，移除中心位于以原点为中心的半径为 $R_c$ 的球形腔内的偶极子。如果原点处存在中心格点，也应排除。为每个格点赋予与均匀极化一致的偶极矩 $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$，其中 $\\mu = P a^3 / n_{\\text{site}}$。\n\n计算所有包含在内的偶极子在原点产生的场的 $z$ 分量的离散估计值，\n$$\nE_{z}^{\\text{disc}}(R_c,N;\\text{lattice}) = \\sum_{\\mathbf{r}} \\left[\\frac{1}{4\\pi \\varepsilon_0}\\left(\\frac{3(\\boldsymbol{\\mu}\\cdot\\mathbf{r})\\,z}{r^5} - \\frac{\\mu}{r^3}\\right)\\right],\n$$\n其中 $z$ 是 $\\mathbf{r}$ 的 $z$ 坐标，求和遍及有限阵列中所有包含的偶极子。\n\n采用无量纲单位制，其中 $1/(4\\pi \\varepsilon_0)=1$ 且 $P=1$，因此 $E_{z}^{\\text{cont}}=4\\pi/3$ 且 $\\mu = a^3/n_{\\text{site}}$。\n\n定义无量纲有限腔修正为\n$$\n\\delta(R_c,N;\\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c,N;\\text{lattice})}{E_{z}^{\\text{cont}}} - 1.\n$$\n\n你的任务是实现一个程序，该程序能够：\n- 构建指定的晶格和基矢。\n- 对半径为 $R_c$ 的球形腔外且由 $N$ 设定的立方截断内的离散偶极子贡献进行求和。\n- 为每个测试用例计算 $\\delta(R_c,N;\\text{lattice})$。\n\n所有输出必须是无量纲实数（浮点数）。如果在内部出现角度，必须以弧度处理。由于选择了单位归一化，输出中不出现国际单位制 (SI) 的量纲。\n\n用于评估覆盖率的测试套件：\n- 情况1：lattice $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（一般收敛情况）。\n- 情况2：lattice $\\in\\{\\textSC\\}$，$a=1.0$，$R_c=0.51$，$N=10$（小腔半径，接近最近邻格点排除）。\n- 情况3：lattice $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=1.2$，$N=3$（小截断，探测不完整壳层收敛）。\n- 情况4：lattice $\\in\\{\\text{BCC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（不同基矢密度）。\n- 情况5：lattice $\\in\\{\\text{FCC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（密堆积基矢）。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3]”）。列表元素按顺序对应上述情况，并且必须是为每个情况定义的 $\\delta$ 的数值。所有中间选择必须遵循上述定义，且不允许外部输入。", "solution": "所给出的问题陈述是计算物理学中一个明确定义的练习。它要求通过直接求和离散偶极子晶格的电场来计算局域场修正，这是研究电介质的一个基本概念。该问题具有科学依据，内部逻辑一致，且所有参数均已指定。因此，该问题被认为是有效的，可以构建严谨的解决方案。\n\n任务是计算对洛伦兹局域场的有限腔修正。给定晶格点上的局域场 $\\mathbf{E}_{\\text{local}}$ 是除该点偶极子外所有源产生的总电场。P. A. M. Lorentz 提出了一种计算方法，即在概念上围绕该点挖出一个小的球形腔。然后将场分解为腔内偶极子的贡献（“近场”）和腔外极化介质的贡献（“远场”）。\n\n在标准的洛伦兹模型中，来自球体外部均匀极化连续介质的远场在腔中心的贡献为 $\\mathbf{E}_{\\text{cont}} = \\mathbf{P}/(3\\varepsilon_0)$。然后对腔内离散偶极子进行近场求和。对于具有高等对称性（如立方对称性）的晶格，这个近场和为零，从而导出著名的洛伦兹关系。\n\n本问题重新审视了远场的贡献。我们不将其视为连续介质，而是通过对半径为 $R_c$ 的腔外、边长为 $(2N+1)a$ 的较大有限立方体内的格点上的偶极子场进行直接的离散求和来计算它。这个离散和与连续介质值的偏差即为有限腔修正 $\\delta$。\n\n位于位置 $\\mathbf{r}$ 的点偶极子 $\\boldsymbol{\\mu}$ 在原点产生的电场由下式给出：\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[ \\frac{3(\\boldsymbol{\\mu} \\cdot \\mathbf{r})\\mathbf{r}}{r^5} - \\frac{\\boldsymbol{\\mu}}{r^3} \\right]\n$$\n问题指定了均匀极化 $\\mathbf{P} = P \\hat{\\mathbf{z}}$，因此每个偶极矩为 $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$。对于位置矢量 $\\mathbf{r} = (x, y, z)$，点积为 $\\boldsymbol{\\mu} \\cdot \\mathbf{r} = \\mu z$。来自这个单一偶极子的电场的 z 分量是：\n$$\nE_z = \\frac{\\mu}{4\\pi \\varepsilon_0} \\left( \\frac{3z^2}{r^5} - \\frac{1}{r^3} \\right)\n$$\n我们采用无量纲单位制，使得 $1/(4\\pi\\varepsilon_0) = 1$ 且极化强度 $P=1$。每个格点的偶极矩为 $\\mu = P V_{\\text{site}}$。对于一个边长为 $a$、包含 $n_{\\text{site}}$ 个基元原子的常规立方晶胞，每个格点的体积为 $V_{\\text{site}} = a^3/n_{\\text{site}}$。因此，在这些单位中，偶极矩为 $\\mu = a^3/n_{\\text{site}}$。\n\n场的 z 分量的离散和 $E_z^{\\text{disc}}$ 是对所有满足两个条件的晶格点 $\\mathbf{r}_{i,j,k,\\beta}$ 进行的：\n1. 它们位于由整数索引 $-N \\le i, j, k \\le N$ 定义的计算超胞内。\n2. 它们位于半径为 $R_c$ 的球形腔外，即 $\\|\\mathbf{r}_{i,j,k,\\beta}\\| \\ge R_c$。\n一个格点的位置由 $\\mathbf{r}_{i,j,k,\\beta} = a((i, j, k) + (\\xi, \\eta, \\zeta)_{\\beta})$ 给出，其中 $(i,j,k)$ 是晶胞索引，$(\\xi, \\eta, \\zeta)_{\\beta}$ 是基元格点 $\\beta$ 的分数坐标。位于原点 $(\\mathbf{r} = \\mathbf{0})$ 的格点被明确排除。\n\n总离散场是以下求和：\n$$\nE_{z}^{\\text{disc}}(R_c, N; \\text{lattice}) = \\sum_{i,j,k,\\beta \\text{ s.t. } r \\ge R_c, r \\ne 0} \\mu \\left( \\frac{3z_{i,j,k,\\beta}^2}{r_{i,j,k,\\beta}^5} - \\frac{1}{r_{i,j,k,\\beta}^3} \\right)\n$$\n在我们选择的单位中，参考连续介质场为 $E_z^{\\text{cont}} = 4\\pi P/3$。当 $P=1$ 时，即为 $E_z^{\\text{cont}} = 4\\pi/3$。\n\n然后，无量纲有限腔修正 $\\delta$ 计算如下：\n$$\n\\delta(R_c, N; \\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c, N; \\text{lattice})}{E_{z}^{\\text{cont}}} - 1\n$$\n这个量度量了用均匀连续介质替代腔外离散晶格所引起的相对误差。这个误差源于晶格的颗粒性以及求和体积的有限立方体形状。对于一个无限的、球形求和的晶格，这个修正将消失。\n\n待实现的算法如下：\n1. 对于每个测试用例，根据指定的晶格类型（SC、BCC 或 FCC）、晶格常数 $a$、腔半径 $R_c$ 和超胞尺寸参数 $N$，我们将总离散场 $E_{z}^{\\text{disc}}$ 初始化为 $0$。\n2. 我们为所选晶格定义基矢 $(\\xi, \\eta, \\zeta)$ 和格点数 $n_{\\text{site}}$。我们计算偶极矩 $\\mu = a^3/n_{\\text{site}}$。\n3. 我们遍历所有从 $-N$ 到 $N$ 的晶胞索引 $(i, j, k)$。\n4. 在每个晶胞内，我们遍历所有基矢。对于每个格点，我们计算其位置矢量 $\\mathbf{r} = (x, y, z)$。\n5. 我们检查格点是否在原点 ($r=0$)。如果是，则跳过。\n6. 我们检查格点是否在球形腔内 ($r  R_c$)。如果是，则跳过。\n7. 如果格点被包括在内，我们计算它对场的贡献 $\\Delta E_z = \\mu (3z^2/r^5 - 1/r^3)$，并将其加到 $E_{z}^{\\text{disc}}$ 上。\n8. 在对所有包含的格点求和后，我们计算参考场 $E_z^{\\text{cont}} = 4\\pi/3$。\n9. 最后，我们计算修正 $\\delta = E_{z}^{\\text{disc}}/E_z^{\\text{cont}} - 1$ 并报告结果。\n\n这个过程构成了对所述问题的直接数值评估。", "answer": "```python\nimport numpy as np\n\ndef calculate_delta(lattice_type: str, a: float, Rc: float, N: int) - float:\n    \"\"\"\n    Computes the finite-cavity correction to the Lorentz local field.\n\n    Args:\n        lattice_type: The type of cubic lattice ('SC', 'BCC', 'FCC').\n        a: The lattice constant.\n        Rc: The radius of the spherical exclusion cavity.\n        N: The half-size of the cubic supercell in units of conventional cells.\n\n    Returns:\n        The dimensionless finite-cavity correction delta.\n    \"\"\"\n    # Define lattice basis vectors in fractional coordinates and number of sites per conventional cell.\n    bases = {\n        'SC': np.array([[0.0, 0.0, 0.0]]),\n        'BCC': np.array([[0.0, 0.0, 0.0], [0.5, 0.5, 0.5]]),\n        'FCC': np.array([[0.0, 0.0, 0.0], [0.0, 0.5, 0.5], [0.5, 0.0, 0.5], [0.5, 0.5, 0.0]]),\n    }\n    nsites = {\n        'SC': 1,\n        'BCC': 2,\n        'FCC': 4,\n    }\n\n    n_site = nsites[lattice_type]\n    basis_vectors = bases[lattice_type]\n    \n    # In dimensionless units, P=1, so mu = V_site = a^3 / n_site.\n    mu = a**3 / n_site\n    \n    E_z_disc = 0.0\n    \n    # Loop over conventional cells indexed by (i, j, k) from -N to N.\n    cell_indices = np.arange(-N, N + 1)\n    for i in cell_indices:\n        for j in cell_indices:\n            for k in cell_indices:\n                # Loop over basis sites within the cell.\n                for basis_vec in basis_vectors:\n                    pos_vec = a * (np.array([i, j, k]) + basis_vec)\n                    \n                    r_sq = np.sum(pos_vec**2)\n                    \n                    # Exclude the site at the origin where the field is calculated.\n                    # A small tolerance is used for floating-point comparison to zero.\n                    if r_sq  1e-12:\n                        continue\n                    \n                    r = np.sqrt(r_sq)\n                    \n                    # Include only dipoles outside the cavity radius Rc.\n                    if r >= Rc:\n                        z = pos_vec[2]\n                        # The z-component of the field from a single dipole, with 1/(4*pi*eps_0) = 1.\n                        # E_z = mu * (3*z^2/r^5 - 1/r^3)\n                        r_cubed = r**3\n                        r_fifth = r_cubed * r**2 # Computationally cheaper than r**5\n                        E_z_single = mu * (3 * z**2 / r_fifth - 1 / r_cubed)\n                        E_z_disc += E_z_single\n\n    # The continuum field at the center of a spherical cavity, with P=1 and 1/(4*pi*eps_0)=1.\n    E_z_cont = 4 * np.pi / 3.0\n    \n    # Calculate the dimensionless finite-cavity correction.\n    delta = E_z_disc / E_z_cont - 1.0\n    \n    return delta\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 0.51, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 3},\n        {'lattice': 'BCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'FCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n    ]\n\n    results = []\n    for case in test_cases:\n        delta = calculate_delta(case['lattice'], case['a'], case['R_c'], case['N'])\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2836909"}]}