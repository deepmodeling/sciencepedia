{"hands_on_practices": [{"introduction": "理解固态电解质中的离子输运，首先要掌握其基础的数学描述。本练习将引导你从第一性原理出发，推导出稳态下一维离子输运的能斯特-普朗克方程，并将微观的离子扩散与宏观的电流联系起来。通过这个推导，你将阐明离子电导率 $\\sigma$ 的物理意义，并为分析更复杂的输运现象打下坚实的理论基础。[@problem_id:2859384]", "problem": "一块致密的单离子传导固体电解质被制成厚度为 $L$、横截面积为 $A$ 的平板。可移动离子的化合价为 $z$，数浓度为 $c$（假设空间均匀），在绝对温度 $T$ 下的自扩散系数为 $D$。在 $x=0$ 和 $x=L$ 的两个面之间施加了静态电势差 $\\Delta \\phi \\equiv \\phi(L)-\\phi(0)$。假设沿 $x$ 方向为一维输运，无对流，无界面反应，且主体基质为刚性、电中性。\n\n仅从基本定律和核心定义出发——特别是菲克扩散定律、连接迁移率和扩散的爱因斯坦关系式，以及电场和电势之间的关系——推导该离子的稳态一维能斯特-普朗克通量，然后在浓度保持均匀的特殊情况下，求出通过该平板的稳态离子电流密度。您可以假设电场在整个平板上是空间均匀的。确定有效离子电导率。简要讨论对应于纯迁移输运、纯扩散输运的极限情况，以及诸如 $D \\to 0$、$c \\to 0$ 和 $L \\to \\infty$ 等渐近参数极限。\n\n请以单个封闭形式的解析表达式给出稳态电流密度 $i$ 的最终答案，该表达式应由 $D$、$c$、$z$、元电荷 $e$、玻尔兹曼常数 $k_B$、$T$、$\\Delta \\phi$ 和 $L$ 表示。最终的方框答案中不要包含单位。如果您选择同时表达总电流 $I$，请使用 $I = i A$ 并在推导中说明，但最终的方框答案必须仅为 $i$ 的表达式。", "solution": "目标是从第一性原理出发，推导稳态一维离子电流密度。我们首先将粒子通量分解为扩散和迁移两部分贡献，然后使用爱因斯坦关系式将迁移率和扩散联系起来。\n\n1. 基本要素：\n- 菲克定律（扩散）：在一维情况下，扩散粒子通量由下式给出\n$$\nJ_{\\text{diff}}(x) \\;=\\; - D \\,\\frac{\\partial c}{\\partial x}.\n$$\n- 电场下的漂移：电荷为 $z e$ 的离子在电场 $E(x)$ 作用下，会产生一个与电场成正比的漂移速度 $v_{\\text{d}}(x)$，\n$$\nv_{\\text{d}}(x) \\;=\\; \\mu \\, z e \\, E(x),\n$$\n其中 $\\mu$ 是迁移率。\n- 爱因斯坦关系式：对于稀疏载流子，在热平衡状态下，\n$$\n\\mu \\;=\\; \\frac{D}{k_B T}.\n$$\n- 电场和电势：电场与静电势 $\\phi(x)$ 的关系为\n$$\nE(x) \\;=\\; - \\frac{\\partial \\phi}{\\partial x}.\n$$\n\n2. 迁移粒子通量：\n对粒子通量的迁移贡献是数浓度与漂移速度的乘积，\n$$\nJ_{\\text{mig}}(x) \\;=\\; c(x)\\, v_{\\text{d}}(x) \\;=\\; c(x)\\, \\mu \\, z e \\, E(x).\n$$\n使用 $E(x) = - \\partial \\phi / \\partial x$ 和 $\\mu = D/(k_B T)$ 可得\n$$\nJ_{\\text{mig}}(x) \\;=\\; - \\frac{D\\, z e}{k_B T}\\, c(x)\\, \\frac{\\partial \\phi}{\\partial x}.\n$$\n\n3. 能斯特-普朗克粒子通量：\n将扩散和迁移的贡献相加，得到一维能斯特-普朗克粒子通量，\n$$\nJ(x) \\;=\\; J_{\\text{diff}}(x) + J_{\\text{mig}}(x)\n\\;=\\; - D \\,\\frac{\\partial c}{\\partial x} \\;-\\; \\frac{D\\, z e}{k_B T}\\, c(x)\\, \\frac{\\partial \\phi}{\\partial x}.\n$$\n\n4. 离子电流密度：\n电流密度是单位粒子的电荷乘以粒子通量，\n$$\ni(x) \\;=\\; z e \\, J(x) \\;=\\; - z e \\, D \\,\\frac{\\partial c}{\\partial x} \\;-\\; \\frac{(z e)^2 D}{k_B T}\\, c(x)\\, \\frac{\\partial \\phi}{\\partial x}.\n$$\n在所述的稳态条件下，浓度是均匀的，因此 $\\partial c / \\partial x = 0$，扩散项消失。假设平板内的电场在空间上是均匀的，则电势呈线性变化，且\n$$\n\\frac{\\partial \\phi}{\\partial x} \\;=\\; \\frac{\\phi(L)-\\phi(0)}{L} \\;=\\; \\frac{\\Delta \\phi}{L}.\n$$\n因此，稳态电流密度为\n$$\ni \\;=\\; - \\frac{(z e)^2 D}{k_B T}\\, c \\, \\frac{\\Delta \\phi}{L}.\n$$\n\n5. 有效离子电导率：\n与一维欧姆定律 $i = - \\sigma \\, \\Delta \\phi / L$ 比较，我们确定离子电导率为\n$$\n\\sigma \\;=\\; \\frac{(z e)^2 D}{k_B T}\\, c.\n$$\n\n6. 极限情况与讨论：\n- 纯迁移输运（均匀浓度）：这是当前的情况，得到 $i = - \\sigma \\, \\Delta \\phi / L$，其中 $\\sigma$ 如上所述。在 $D$ 和 $c$ 不依赖于电场且爱因斯坦关系式成立的范围内，响应与 $\\Delta \\phi$ 呈线性关系。\n- 纯扩散输运（无电场）：设 $\\Delta \\phi = 0$，则 $i = - z e \\, D \\, \\partial c / \\partial x$。如果如此处所设定的浓度是均匀的，那么当 $\\Delta \\phi = 0$ 时，$i = 0$。\n- 渐近参数极限：如果 $D \\to 0$（离子不可移动）、$c \\to 0$（无载流子）或 $L \\to \\infty$（在固定的 $\\Delta \\phi$ 下宏观分离），则 $i \\to 0$。在固定的 $\\Delta \\phi$ 下将 $L$ 减半会使 $|i|$ 加倍，这反映了欧姆传导中的反比厚度依赖性。总电流为 $I = i A$，因此与面积 $A$ 呈线性关系。\n\n这些结果在爱因斯坦关系式和常数 $D$ 所隐含的稀疏载流子、等温和线性响应范围内有效。在非常高的电场下，或者当浓差极化产生显著的 $\\partial c / \\partial x$ 时，可能会出现偏差，在这种情况下，必须保留包含两项的完整能斯特-普朗克表达式。", "answer": "$$\\boxed{-\\frac{(z e)^{2} D c}{k_{B} T} \\frac{\\Delta \\phi}{L}}$$", "id": "2859384"}, {"introduction": "理论与实验的结合是材料科学研究的核心。在掌握了离子电导率的基本理论后，下一步是学习如何从实验数据中提取关键的物理参数。本练习模拟了一个典型的实验数据分析任务，你将通过分析电导率和缺陷浓度随温度变化的阿伦尼乌斯行为，来分离总活化能中的缺陷形成焓 $H_f$ 和迁移焓 $H_m$。[@problem_id:2859378] 这项技能对于从宏观测量结果中揭示材料的微观输运机理至关重要。", "problem": "一种致密的单晶固体电解质，其本征离子输运由亚晶格上单一的带负电的空位种类主导，该亚晶格的格点密度在研究的温度范围内不随温度变化。其微观输运机制是最近邻格点间的热激活跳跃，缺陷热力学遵循具有明确形成焓的平衡统计规律。在单一机制占主导地位，且所有相关因子和几何因子均可视为与温度无关的温度区间内，我们测量了离子电导率 $\\,\\sigma(T)\\,$ 和可移动空位浓度 $\\,n(T)\\,$。在此范围内，通过线性回归确定了以下实验阿伦尼乌斯斜率：\n- $\\ln\\!\\big(\\sigma(T)\\,T\\big)$ 对 $1/T$ 的作图斜率为 $-1.75 \\times 10^{4} \\ \\mathrm{K}$。\n- $\\ln n(T)$ 对 $1/T$ 的作图斜率为 $-9.00 \\times 10^{3} \\ \\mathrm{K}$。\n\n仅使用热激活缺陷形成与迁移以及平衡随机输运的基本关系，分离形成和迁移的贡献，并确定可移动缺陷的迁移焓 $\\,H_{m}\\,$。取玻尔兹曼常数为 $\\,k_{B} = 8.617333262 \\times 10^{-5} \\ \\mathrm{eV\\,K^{-1}}$。以电子伏特为单位报告 $\\,H_{m}\\,$ 的值。将答案四舍五入到三位有效数字。", "solution": "该问题陈述经过严格评估，被认为是有效的。它具有科学依据，提法得当，客观，并包含足够的信息来确定一个唯一且有意义的解。该问题需要应用缺陷热力学和固体中离子输运的基本原理。\n\n离子电导率 $\\sigma$ 由可移动载流子浓度 $n$、载流子电荷 $q$ 和载流子迁移率 $\\mu$ 的乘积给出。\n$$\n\\sigma = n |q| \\mu\n$$\n问题指明载流子是带负电的空位，因此其浓度 $n(T)$ 受缺陷形成热力学的支配。对于具有单一主导缺陷的本征固体，其浓度是热激活的，并遵循阿伦尼乌斯关系：\n$$\nn(T) = N_0 \\exp\\left(-\\frac{H_f}{k_B T}\\right)\n$$\n其中 $H_f$ 是空位的形成焓，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$N_0$ 是一个与亚晶格上可用格点密度相关的指前因子，该因子被说明为与温度无关。\n\n迁移率 $\\mu$ 通过能斯特-爱因斯坦关系与扩散系数 $D$ 相关：\n$$\n\\mu(T) = \\frac{|q| D(T)}{k_B T}\n$$\n输运机制是热激活跳跃，因此扩散系数也遵循阿伦尼乌斯定律：\n$$\nD(T) = D_0 \\exp\\left(-\\frac{H_m}{k_B T}\\right)\n$$\n其中 $H_m$ 是迁移焓，$D_0$ 是一个与温度无关的指前因子，它包括跳跃距离和尝试频率等参数。问题指出，所有几何和相关因子都可以视为与温度无关，这与此公式一致。\n\n将 $n(T)$、$\\mu(T)$ 和 $D(T)$ 的表达式代入电导率方程，得到：\n$$\n\\sigma(T) = \\left(N_0 \\exp\\left(-\\frac{H_f}{k_B T}\\right)\\right) |q| \\left(\\frac{|q| D_0 \\exp\\left(-\\frac{H_m}{k_B T}\\right)}{k_B T}\\right)\n$$\n$$\n\\sigma(T) = \\frac{N_0 q^2 D_0}{k_B T} \\exp\\left(-\\frac{H_f + H_m}{k_B T}\\right)\n$$\n电导率的总激活能是形成焓和迁移焓之和，$E_a = H_f + H_m$。\n\n问题提供了来自两个独立阿伦尼乌斯图的数据。我们来逐一分析。\n\n首先，考虑 $\\ln(\\sigma(T)T)$ 对 $1/T$ 的作图。我们重排电导率表达式：\n$$\n\\sigma(T)T = \\frac{N_0 q^2 D_0}{k_B} \\exp\\left(-\\frac{H_f + H_m}{k_B T}\\right)\n$$\n取两边的自然对数：\n$$\n\\ln(\\sigma(T)T) = \\ln\\left(\\frac{N_0 q^2 D_0}{k_B}\\right) - \\frac{H_f + H_m}{k_B} \\frac{1}{T}\n$$\n该方程的形式为 $y = c + mx$，其中 $y = \\ln(\\sigma(T)T)$，$x = 1/T$。这条线的斜率，我们记作 $S_1$，是：\n$$\nS_1 = \\frac{d(\\ln(\\sigma T))}{d(1/T)} = -\\frac{H_f + H_m}{k_B}\n$$\n根据问题陈述，该斜率给定为 $S_1 = -1.75 \\times 10^4 \\ \\mathrm{K}$。因此，我们得到第一个方程：\n$$\n-\\frac{H_f + H_m}{k_B} = -1.75 \\times 10^4 \\ \\mathrm{K} \\implies \\frac{H_f + H_m}{k_B} = 1.75 \\times 10^4 \\ \\mathrm{K}\n$$\n\n其次，考虑 $\\ln n(T)$ 对 $1/T$ 的作图。我们使用空位浓度的表达式：\n$$\nn(T) = N_0 \\exp\\left(-\\frac{H_f}{k_B T}\\right)\n$$\n取自然对数：\n$$\n\\ln n(T) = \\ln(N_0) - \\frac{H_f}{k_B} \\frac{1}{T}\n$$\n这也是一个线性关系。这条线的斜率 $S_2$ 是：\n$$\nS_2 = \\frac{d(\\ln n)}{d(1/T)} = -\\frac{H_f}{k_B}\n$$\n问题提供了该斜率为 $S_2 = -9.00 \\times 10^3 \\ \\mathrm{K}$。这给了我们第二个方程：\n$$\n-\\frac{H_f}{k_B} = -9.00 \\times 10^3 \\ \\mathrm{K} \\implies \\frac{H_f}{k_B} = 9.00 \\times 10^3 \\ \\mathrm{K}\n$$\n\n现在我们有一个包含两个未知数 $H_f$ 和 $H_m$ 的方程组，可以求解它们。\n1. $\\frac{H_f}{k_B} + \\frac{H_m}{k_B} = 1.75 \\times 10^4 \\ \\mathrm{K}$\n2. $\\frac{H_f}{k_B} = 9.00 \\times 10^3 \\ \\mathrm{K}$\n\n将第二个方程中的 $\\frac{H_f}{k_B}$ 的值代入第一个方程：\n$$\n(9.00 \\times 10^3 \\ \\mathrm{K}) + \\frac{H_m}{k_B} = 1.75 \\times 10^4 \\ \\mathrm{K}\n$$\n求解 $\\frac{H_m}{k_B}$：\n$$\n\\frac{H_m}{k_B} = (1.75 \\times 10^4 - 9.00 \\times 10^3) \\ \\mathrm{K} = (17.5 \\times 10^3 - 9.00 \\times 10^3) \\ \\mathrm{K} = 8.50 \\times 10^3 \\ \\mathrm{K}\n$$\n为了以电子伏特 (eV) 为单位求得迁移焓 $H_m$，我们将此结果乘以玻尔兹曼常数 $k_B$：\n$$\nH_m = (8.50 \\times 10^3 \\ \\mathrm{K}) \\times k_B\n$$\n使用给定的值 $k_B = 8.617333262 \\times 10^{-5} \\ \\mathrm{eV\\,K^{-1}}$：\n$$\nH_m = (8.50 \\times 10^3) \\times (8.617333262 \\times 10^{-5}) \\ \\mathrm{eV}\n$$\n$$\nH_m \\approx 0.7324733 \\ \\mathrm{eV}\n$$\n问题要求将答案四舍五入到三位有效数字。输入数据，如 $1.75$ 和 $9.00$，有三位有效数字。减法的结果 $8.50$ 也有三位有效数字。因此，最终结果必须以三位有效数字报告。\n$$\nH_m \\approx 0.732 \\ \\mathrm{eV}\n$$", "answer": "$$\n\\boxed{0.732}\n$$", "id": "2859378"}, {"introduction": "除了理论推导和实验测量，计算模拟已成为材料科学研究的第三大支柱。本练习提供了一个处理第一性原理分子动力学（AIMD）模拟原始数据的实践指南。你将学习如何从离子的均方位移（MSD）计算扩散系数 $D$，应用必要的有限尺寸修正，并最终通过阿伦尼乌斯拟合提取输运活化能 $E_a$。[@problem_id:2859400] 这个练习完整地再现了现代计算材料研究中分析输运性质的标准流程。", "problem": "提供给您的是固态导体中移动离子的示踪剂均方位移（MSD）的从头算分子动力学（AIMD）轨迹摘要，这些数据是人工合成但科学上一致的，涵盖了多个温度。您的任务是：使用第一性原理从 MSD 计算示踪剂扩散系数，对立方超胞中的周期性边界条件应用适当的流体动力学有限尺寸校正，然后通过拟合阿伦尼乌斯关系式提取活化能和指前因子。所有量和步骤都必须以单位一致的方式处理。\n\n使用以下基本且经过充分检验的基础：\n- 在 $d$ 维空间中，示踪剂扩散的爱因斯坦关系式在长时间极限下给出 $D = \\frac{1}{2 d}\\frac{d\\langle \\Delta r^2(t)\\rangle}{dt}$，其中 $D$ 是示踪剂扩散系数，$\\langle \\Delta r^2(t)\\rangle$ 是均方位移。\n- 对于线性尺寸为 $L$ 的立方周期性模拟盒子，可以将一个领先阶的流体动力学有限尺寸校正（Yeh–Hummer）添加到周期性边界条件下的扩散系数 $D_{\\mathrm{PBC}}$ 中，以估计无限尺寸下的扩散系数 $D_{\\infty}$：$D_{\\infty} = D_{\\mathrm{PBC}} + \\frac{k_{\\mathrm{B}} T \\,\\xi}{6\\pi \\eta L}$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\eta$ 是剪切粘度，对于立方晶胞 $\\xi \\approx 2.837297$。\n- 一个热激活的示踪剂扩散系数近似服从阿伦尼乌斯形式 $D_{\\infty}(T) = D_0 \\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right)$，其中 $D_0$ 是指前因子，$E_{\\mathrm{a}}$ 是活化能。\n\n需遵循的计算指令：\n1. 对于每个温度，在指定的长时间窗口 $[t_{\\min}, t_{\\max}]$ 内，对 $\\langle \\Delta r^2(t)\\rangle$ 与 $t$ 进行最小二乘线性回归，其中 $d=3$，以获得斜率 $s = \\frac{d\\langle \\Delta r^2\\rangle}{dt}$。然后计算 $D_{\\mathrm{PBC}} = \\frac{s}{2 d}$。\n2. 单位和转换：\n   - 时间数据 $t$ 以皮秒（picoseconds）为单位提供。MSD 数据 $\\langle \\Delta r^2\\rangle$ 以平方埃（square ångströms）为单位提供。使用 $1~\\text{Å}^2 = 10^{-20}~\\text{m}^2$ 和 $1~\\text{ps} = 10^{-12}~\\text{s}$ 将斜率单位（平方埃/皮秒）转换为平方米/秒。因此，如果 $s$ 是以 $\\text{Å}^2/\\text{ps}$ 为单位的斜率，则 $D_{\\mathrm{PBC}}~[\\text{m}^2\\!/\\text{s}] = \\frac{s}{6}\\times 10^{-8}$。\n   - 使用 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}~\\text{J/K}$。\n   - 使用 $\\xi = 2.837297$。\n   - 剪切粘度 $\\eta$ 以 $\\text{Pa}\\cdot\\text{s}$ 为单位提供，盒子长度 $L$ 以 $\\text{m}$ 为单位提供。\n3. 使用上述公式对每个温度应用有限尺寸校正，以获得 $D_{\\infty}(T)$。\n4. 对 $\\ln D_{\\infty}$ 与 $1/T$ 进行线性回归，以提取斜率和截距。根据线性模型 $\\ln D_{\\infty} = \\ln D_0 - \\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}}} \\frac{1}{T}$，确定 $E_{\\mathrm{a}}$ 和 $D_0$。使用转换因子 $1~\\text{eV} = 1.602176634\\times 10^{-19}~\\text{J}$ 将 $E_{\\mathrm{a}}$ 表示为电子伏特（electronvolts），并将 $D_0$ 表示为 $\\text{m}^2/\\text{s}$。\n5. 数值拟合细节：\n   - 对 MSD-时间拟合和阿伦尼乌斯拟合均使用普通最小二乘法。\n   - 对于 MSD 拟合，仅使用下面指定的 $t \\ge t_{\\min}$ 的数据点；将 $t_{\\max}$ 取为可用的最大时间。\n   - 取空间维度 $d=3$。\n\n测试套件：\n- 所有测试的物理常数：$k_{\\mathrm{B}} = 1.380649\\times 10^{-23}$ J/K, $\\xi = 2.837297$, $e = 1.602176634\\times 10^{-19}$ J/eV。\n\n- 测试用例 1（立方盒子，较小尺寸，较强有限尺寸效应）：\n  - 盒子长度：$L = 1.2\\times 10^{-9}$ m。\n  - 粘度：$\\eta = 2.5\\times 10^{-3}$ Pa·s。\n  - 温度 (K)：$T \\in \\{600, 800, 1000\\}$。\n  - 时间网格 $t$（皮秒）（所有三个温度相同）：$[0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]$。\n  - $T=600$ K 时的 MSD (Å$^2$)：$[0, 0.4129329434, 0.6763368722, 0.9195042496, 1.1599329074, 1.39999092, 1.63999877116, 1.8799998336942, 2.119999977493, 2.359999996954, 2.599999999588]$。\n  - $T=800$ K 时的 MSD (Å$^2$)：$[0, 0.9729329434, 1.7963368722, 2.5995042496, 3.3999329074, 4.19999092, 4.99999877116, 5.7999998336942, 6.599999977493, 7.399999996954, 8.199999999588]$。\n  - $T=1000$ K 时的 MSD (Å$^2$)：$[0, 1.8229329434, 3.4963368722, 5.1495042496, 6.7999329074, 8.44999092, 10.09999877116, 11.7499998336942, 13.399999977493, 15.049999996954, 16.699999999588]$。\n  - 使用 $t_{\\min} = 15$ ps；将 $t_{\\max}$ 取为列表中的最大时间。\n\n- 测试用例 2（立方盒子，较大尺寸，较弱有限尺寸效应）：\n  - 盒子长度：$L = 2.4\\times 10^{-9}$ m。\n  - 粘度：$\\eta = 2.0\\times 10^{-3}$ Pa·s。\n  - 温度 (K)：$T \\in \\{500, 700, 900\\}$。\n  - 时间网格 $t$（皮秒）（所有三个温度相同）：$[0, 4, 8, 12, 16, 20, 24]$。\n  - $T=500$ K 时的 MSD (Å$^2$)：$[0, 0.1664664717, 0.2581684361, 0.339752124, 0.4199664537, 0.49999546, 0.5799993858]$。\n  - $T=700$ K 时的 MSD (Å$^2$)：$[0, 0.3264664717, 0.5781684361, 0.819752124, 1.0599664537, 1.29999546, 1.5399993858]$。\n  - $T=900$ K 时的 MSD (Å$^2$)：$[0, 0.5664664717, 1.0581684361, 1.539752124, 2.0199664537, 2.49999546, 2.9799993858]$。\n  - 使用 $t_{\\min} = 8$ ps；将 $t_{\\max}$ 取为列表中的最大时间。\n\n要求的输出：\n- 对于两个测试用例中的每一个，计算：\n  - 活化能 $E_{\\mathrm{a}}$（单位：电子伏特 eV）。\n  - 扩散指前因子 $D_0$（单位：$\\text{m}^2/\\text{s}$）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[E_{\\mathrm{a},1}~(\\text{eV}), D_{0,1}~(\\text{m}^2/\\text{s}), E_{\\mathrm{a},2}~(\\text{eV}), D_{0,2}~(\\text{m}^2/\\text{s})]$。将 $E_{\\mathrm{a}}$（以 eV 为单位）和 $D_0$（以 $\\text{m}^2/\\text{s}$ 为单位）表示为浮点数。", "solution": "所呈现的问题是计算材料物理学中一个标准的、适定性良好的练习。它要求分析模拟的离子输运数据，以提取基本的动力学参数。该问题在科学上基于统计力学和凝聚态物理的原理，提供了所有必要的数据和常数，并遵循一个逻辑上合理且明确的程序。因此，它被认为是一个有效的问题。\n\n解决方案系统地进行，基于三个基本的物理关系。\n\n首先，示踪剂扩散系数 $D$ 通过爱因斯坦关系式与粒子的均方位移（MSD）（记为 $\\langle \\Delta r^2(t)\\rangle$）相关联。在三维空间（$d=3$）中，该关系式为：\n$$\nD = \\lim_{t\\to\\infty} \\frac{1}{6t} \\langle \\Delta r^2(t)\\rangle\n$$\n在实践中，我们在 MSD 图的长时间线性（扩散）区域内确定斜率 $s = \\frac{d\\langle \\Delta r^2(t)\\rangle}{dt}$。然后扩散系数为 $D = s/6$。从周期性边界条件（PBC）模拟中提供的数据得到原始的、依赖于尺寸的系数 $D_{\\mathrm{PBC}}$。\n\n其次，有限周期性盒子中的分子动力学模拟会引入人为效应。离子的迁移率会因其自身周期性镜像之间的流体动力学相互作用而被人为地增强。对于边长为 $L$ 的立方晶胞，在 PBC 下计算的扩散系数 $D_{\\mathrm{PBC}}$ 的领先阶校正通过 Yeh-Hummer 公式将其与无限系统扩散系数 $D_{\\infty}$ 关联起来：\n$$\nD_{\\infty} = D_{\\mathrm{PBC}} + \\frac{k_{\\mathrm{B}} T \\xi}{6\\pi \\eta L}\n$$\n这里，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\eta$ 是介质的剪切粘度，$\\xi$ 是一个无量纲常数（$\\xi \\approx 2.837297$），它取决于模拟晶胞的几何形状。必须应用此校正才能获得代表体材料物理上有意义的扩散系数。\n\n第三，固体中的离子扩散是一个热激活过程。扩散系数的温度依赖性可以通过阿伦尼乌斯关系式很好地描述：\n$$\nD_{\\infty}(T) = D_0 \\exp\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right)\n$$\n其中 $E_{\\mathrm{a}}$ 是离子跳跃的活化能，$D_0$ 是指前因子。为了提取这些参数，我们通过取自然对数来线性化该方程：\n$$\n\\ln D_{\\infty}(T) = \\ln D_0 - \\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}}} \\left(\\frac{1}{T}\\right)\n$$\n该方程具有直线形式 $y = c + mx$，其中 $y = \\ln D_{\\infty}$，$x = 1/T$，截距为 $c = \\ln D_0$，斜率为 $m = -E_{\\mathrm{a}}/k_{\\mathrm{B}}$。\n\n计算过程如下：\n\n1.  对于给定测试用例中的每个温度 $T$，我们对提供的 MSD 数据 $\\langle \\Delta r^2(t)\\rangle$ 与时间 $t$ 进行普通最小二乘线性回归。此拟合被限制在指定的“长时间”窗口 $t \\in [t_{\\min}, t_{\\max}]$ 内，以确保我们处于扩散区域。此拟合的斜率 $s$ 以 $\\text{Å}^2/\\text{ps}$ 为单位获得。\n\n2.  从斜率 $s$ 计算原始扩散系数 $D_{\\mathrm{PBC}}$，并将其转换为国际单位制（SI）单位（$\\text{m}^2/\\text{s}$）。给定 $d=3$，以及转换因子 $1\\,\\text{Å} = 10^{-10}\\,\\text{m}$ 和 $1\\,\\text{ps} = 10^{-12}\\,\\text{s}$，我们有：\n    $$\n    D_{\\mathrm{PBC}}~[\\text{m}^2/\\text{s}] = \\frac{s~[\\text{Å}^2/\\text{ps}]}{6} \\times \\frac{(10^{-10}\\,\\text{m})^2/\\text{Å}^2}{10^{-12}\\,\\text{s}/\\text{ps}} = \\frac{s}{6} \\times 10^{-8}\n    $$\n\n3.  使用为每个温度提供的参数计算有限尺寸校正项 $\\Delta D = \\frac{k_{\\mathrm{B}} T \\xi}{6\\pi \\eta L}$。将此值加到 $D_{\\mathrm{PBC}}$ 上以获得校正后的扩散系数 $D_{\\infty}(T) = D_{\\mathrm{PBC}} + \\Delta D$。在此计算中，所有参数（$k_{\\mathrm{B}}, T, \\xi, \\eta, L$）都必须使用国际单位制。\n\n4.  在计算出测试用例中所有温度下的 $D_{\\infty}(T)$ 后，我们生成一组数据点 $(\\frac{1}{T}, \\ln D_{\\infty})$。对这些点进行第二次线性回归。\n\n5.  从阿伦尼乌斯拟合的斜率 $m$ 和截距 $c$ 中提取活化能 $E_{\\mathrm{a}}$ 和指前因子 $D_0$：\n    $$\n    E_{\\mathrm{a}} = -m \\cdot k_{\\mathrm{B}}\n    $$\n    $$\n    D_0 = \\exp(c)\n    $$\n    以焦耳计算的活化能，然后使用给定的转换因子 $1\\,\\text{eV} = 1.602176634\\times 10^{-19}\\,\\text{J}$ 转换为电子伏特（eV）。指前因子 $D_0$ 已经是正确的单位 $\\text{m}^2/\\text{s}$。\n\n将此程序应用于两个测试用例，以确定所需的物理参数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing MSD data to find activation energy and\n    diffusion prefactor for two test cases.\n    \"\"\"\n    \n    # Define physical constants\n    KB_J_K = 1.380649e-23  # Boltzmann constant in J/K\n    XI_CUBIC = 2.837297      # Yeh-Hummer constant for a cubic cell\n    E_J_EV = 1.602176634e-19 # Conversion factor from Joules to eV\n\n    # Test Case 1 Data\n    case1_data = {\n        \"L\": 1.2e-9,  # meters\n        \"eta\": 2.5e-3, # Pa·s\n        \"t_min\": 15,  # ps\n        \"t_coords\": [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50], # ps\n        \"temperatures\": [600, 800, 1000],  # K\n        \"msd_list\": [\n            [0, 0.4129329434, 0.6763368722, 0.9195042496, 1.1599329074, 1.39999092, 1.63999877116, 1.8799998336942, 2.119999977493, 2.359999996954, 2.599999999588],\n            [0, 0.9729329434, 1.7963368722, 2.5995042496, 3.3999329074, 4.19999092, 4.99999877116, 5.7999998336942, 6.599999977493, 7.399999996954, 8.199999999588],\n            [0, 1.8229329434, 3.4963368722, 5.1495042496, 6.7999329074, 8.44999092, 10.09999877116, 11.7499998336942, 13.399999977493, 15.049999996954, 16.699999999588]\n        ] # Å^2\n    }\n\n    # Test Case 2 Data\n    case2_data = {\n        \"L\": 2.4e-9,  # meters\n        \"eta\": 2.0e-3, # Pa·s\n        \"t_min\": 8,   # ps\n        \"t_coords\": [0, 4, 8, 12, 16, 20, 24], # ps\n        \"temperatures\": [500, 700, 900],  # K\n        \"msd_list\": [\n            [0, 0.1664664717, 0.2581684361, 0.339752124, 0.4199664537, 0.49999546, 0.5799993858],\n            [0, 0.3264664717, 0.5781684361, 0.819752124, 1.0599664537, 1.29999546, 1.5399993858],\n            [0, 0.5664664717, 1.0581684361, 1.539752124, 2.0199664537, 2.49999546, 2.9799993858]\n        ] # Å^2\n    }\n    \n    test_cases = [case1_data, case2_data]\n    results = []\n\n    def process_case(case):\n        \"\"\"\n        Calculates Ea and D0 for a single test case.\n        \"\"\"\n        L = case[\"L\"]\n        eta = case[\"eta\"]\n        t_min = case[\"t_min\"]\n        \n        inv_T_values = []\n        D_infinity_values = []\n        \n        t_all = np.array(case[\"t_coords\"])\n        \n        for i, T in enumerate(case[\"temperatures\"]):\n            msd_all = np.array(case[\"msd_list\"][i])\n            \n            # 1. MSD vs t fit\n            # Filter data to lie within the fitting window [t_min, t_max]\n            fit_mask = t_all >= t_min\n            t_fit = t_all[fit_mask]\n            msd_fit = msd_all[fit_mask]\n            \n            # Perform linear regression to get the slope s in Å^2/ps\n            slope_msd, _, _, _, _ = linregress(t_fit, msd_fit)\n            \n            # 2. Compute D_pbc in m^2/s\n            # D [m^2/s] = (s [Å^2/ps] / 6) * 1e-8\n            D_pbc = (slope_msd / 6.0) * 1e-8\n            \n            # 3. Apply finite-size correction\n            # delta_D = (kB * T * xi) / (6 * pi * eta * L)\n            correction_term = (KB_J_K * T * XI_CUBIC) / (6 * np.pi * eta * L)\n            D_infinity = D_pbc + correction_term\n            \n            inv_T_values.append(1.0 / T)\n            D_infinity_values.append(D_infinity)\n\n        # 4. Arrhenius fit: ln(D_inf) vs 1/T\n        inv_T_arr = np.array(inv_T_values)\n        ln_D_inf_arr = np.log(D_infinity_values)\n        \n        # Perform linear regression\n        # y = intercept + slope*x  =>  ln(D) = ln(D0) - (Ea/kB)* (1/T)\n        slope_arr, intercept_arr, _, _, _ = linregress(inv_T_arr, ln_D_inf_arr)\n\n        # 5. Extract Ea and D0\n        # Ea = -slope_arr * kB\n        Ea_J = -slope_arr * KB_J_K\n        Ea_eV = Ea_J / E_J_EV\n\n        # D0 = exp(intercept_arr)\n        D0_m2_s = np.exp(intercept_arr)\n        \n        return Ea_eV, D0_m2_s\n\n    for case in test_cases:\n        Ea, D0 = process_case(case)\n        results.append(Ea)\n        results.append(D0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2859400"}]}