{"hands_on_practices": [{"introduction": "非常规超导性常常源于电子间的排斥相互作用，这与传统BCS理论中的吸引相互作用形成鲜明对比。一个关键的机制是自旋涨落介导的配对，其中在特定动量转移下的排斥作用可以在某些配对通道（例如d波）中产生有效的吸引力。这项实践将指导您在一个简化的“热点”模型中求解线性化的能隙方程，从而具体地理解具有符号变化的能隙函数（这是非常规超导体的特征）是如何作为系统的主要不稳定性而出现的 [@problem_id:2869544]。", "problem": "考虑一个二维金属，其费米面近似为圆形，并存在低能反铁磁自旋涨落。该涨落集中在单一波矢 $\\mathbf{Q}$ 处，此波矢连接了费米面上两个对跖的热点区域。由这些自旋涨落媒介的有效单重态配对相互作用由以下模型描述\n\n$$\nV(\\mathbf{q}) \\;=\\; \\frac{3}{2} \\, U^{2} \\, \\chi(\\mathbf{q}), \\qquad \\chi(\\mathbf{q}) \\;=\\; \\frac{\\chi_{0}}{1 + \\xi^{2} |\\mathbf{q}-\\mathbf{Q}|^{2}},\n$$\n\n其中 $U0$，$\\chi_{0}0$，且相干长度 $\\xi \\gg k_{F}^{-1}$。在一个只保留以动量 $\\mathbf{k}_{F}$ 和 $\\mathbf{k}_{F}+\\mathbf{Q}$ 为中心的两个热点区域的二区域简化模型中，假设如下：\n\n$$\nV_{11} \\approx 0, \\quad V_{22} \\approx 0, \\quad V_{12} = V_{21} \\approx \\frac{3}{2} \\, U^{2} \\, \\chi_{0},\n$$\n\n即，在 $1/\\xi$ 的领头阶下，区域间散射远强于区域内散射。设费米能级上每个区域的态密度为常数 $N_{p}$，并对库珀通道使用一个标准的弱耦合紫外频率截断 $\\omega_{c}$。\n\n从超导转变温度 $T_{c}$ 处的 Bardeen–Cooper–Schrieffer (BCS) 线性化能隙方程出发，\n\n$$\n\\Delta_{i} \\;=\\; - \\sum_{j\\in\\{1,2\\}} \\int d\\xi \\, N_{p} \\, V_{ij} \\, \\frac{\\tanh\\!\\big(\\xi/(2T_{c})\\big)}{2\\xi} \\, \\Delta_{j},\n$$\n\n将问题简化为热点区域上的一个 $2\\times 2$ 本征值方程，并求解以得到：\n\n$$\n\\text{(i) 归一化的领头本征函数 } (\\Delta_{1},\\Delta_{2}) \\text{，满足 } |\\Delta_{1}|^{2}+|\\Delta_{2}|^{2}=1, \n$$\n\n\n$$\n\\text{(ii) 用 } \\omega_{c},\\, U,\\, \\chi_{0},\\, N_{p} \\text{ 表示的超导转变温度 } T_{c}。\n$$\n\n采用玻尔兹曼常数 $k_{B}=1$ 的单位制，因此 $T_{c}$ 是一个能量。用 $\\omega_{c}$ 表示最终的 $T_{c}$，除了对数库珀积分自然产生的结果外，不要引入任何额外的数值前因子。将你的最终答案以包含 $\\Delta_{1}$、$\\Delta_{2}$ 和 $T_{c}$ 的单个行向量形式给出。不需要四舍五入；请给出封闭形式的解析表达式。", "solution": "所述问题具有科学依据，提法恰当，并包含在指定理论模型内获得唯一解的充分信息。这是非规超导理论中的一个标准问题。因此，我将开始推导。\n\n出发点是给定的线性化 Bardeen–Cooper–Schrieffer (BCS) 能隙方程：\n$$\n\\Delta_{i} \\;=\\; - \\sum_{j\\in\\{1,2\\}} \\int d\\xi \\, N_{p} \\, V_{ij} \\, \\frac{\\tanh\\!\\big(\\xi/(2T_{c})\\big)}{2\\xi} \\, \\Delta_{j}\n$$\n对单粒子能量 $\\xi$ 的积分在区间 $[-\\omega_{c}, \\omega_{c}]$ 上进行，其中 $\\omega_{c}$ 是紫外截断。这个积分与区域指标 $i$ 和 $j$ 无关。我们将这个积分因子定义为 $L(T_c)$：\n$$\nL(T_{c}) = \\int_{-\\omega_{c}}^{\\omega_{c}} d\\xi \\, N_{p} \\, \\frac{\\tanh(\\xi/(2T_{c}))}{2\\xi}\n$$\n被积函数是 $\\xi$ 的偶函数，所以积分可以简化为：\n$$\nL(T_{c}) = 2 N_{p} \\int_{0}^{\\omega_{c}} d\\xi \\, \\frac{\\tanh(\\xi/(2T_{c}))}{2\\xi} = N_{p} \\int_{0}^{\\omega_{c}} \\frac{d\\xi}{\\xi} \\tanh\\left(\\frac{\\xi}{2T_{c}}\\right)\n$$\n在弱耦合极限下，转变温度 $T_c$ 远小于截断 $\\omega_c$，即 $T_c \\ll \\omega_c$，该积分由一个对数项主导。根据问题要求不引入额外的数值前因子，我们采用库珀积分的标准领头对数近似：\n$$\nL(T_{c}) \\approx N_{p} \\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right)\n$$\n将此代回能隙方程，得到关于能隙分量 $\\Delta_1$ 和 $\\Delta_2$ 的线性方程组：\n$$\n\\Delta_{i} = - L(T_{c}) \\sum_{j\\in\\{1,2\\}} V_{ij} \\Delta_{j}\n$$\n这可以表示为一个矩阵本征值方程：\n$$\n\\begin{pmatrix} V_{11}  V_{12} \\\\ V_{21}  V_{22} \\end{pmatrix} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix} = -\\frac{1}{L(T_{c})} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix}\n$$\n设 $\\mathbf{V}$ 为相互作用矩阵，$\\lambda_{V}$ 为其一个本征值。能隙向量 $(\\Delta_{1}, \\Delta_{2})$ 存在非平凡解的条件是：\n$$\n\\lambda_{V} = -\\frac{1}{L(T_{c})}\n$$\n为了在有限温度 $T_c  0$ 下形成超导态，我们需要 $L(T_c) = N_p \\ln(\\omega_c/T_c)  0$。这意味着只有当相互作用矩阵拥有一个负（吸引）本征值 $\\lambda_{V}  0$ 时，才可能有解。最高的转变温度由最负的本征值 $\\lambda_{V, \\text{min}}$ 决定。\n\n问题给出了二区域模型的相互作用矩阵元：$V_{11} \\approx 0$，$V_{22} \\approx 0$，以及 $V_{12} = V_{21} \\approx \\frac{3}{2} U^{2} \\chi_{0}$。我们用 $V_{0} = \\frac{3}{2} U^{2} \\chi_{0}$ 表示排斥性的区域间相互作用强度，其中 $V_{0}  0$。因此，相互作用矩阵 $\\mathbf{V}$ 为：\n$$\n\\mathbf{V} = \\begin{pmatrix} 0  V_{0} \\\\ V_{0}  0 \\end{pmatrix}\n$$\n我们通过求解特征方程 $\\det(\\mathbf{V} - \\lambda_{V}\\mathbf{I}) = 0$ 来找到 $\\mathbf{V}$ 的本征值：\n$$\n\\det \\begin{pmatrix} -\\lambda_{V}  V_{0} \\\\ V_{0}  -\\lambda_{V} \\end{pmatrix} = (-\\lambda_{V})^{2} - V_{0}^{2} = \\lambda_{V}^{2} - V_{0}^{2} = 0\n$$\n本征值为 $\\lambda_{V, \\pm} = \\pm V_{0}$。领头不稳定性对应于具有最负本征值 $\\lambda_{V, \\text{min}} = -V_{0}$ 的吸引通道。\n\n(i) 我们首先确定归一化的领头本征函数 $(\\Delta_1, \\Delta_2)$。这是对应于本征值 $\\lambda_{V, \\text{min}} = -V_{0}$ 的本征向量。\n$$\n\\begin{pmatrix} 0  V_{0} \\\\ V_{0}  0 \\end{pmatrix} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix} = -V_{0} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix}\n$$\n该矩阵方程给出的条件是 $V_{0}\\Delta_{2} = -V_{0}\\Delta_{1}$ 和 $V_{0}\\Delta_{1} = -V_{0}\\Delta_{2}$，两者均可简化为 $\\Delta_{2} = -\\Delta_{1}$。这表明能隙结构是变号的，这是类 d 波配对的特征。为了找到具体的分量，我们应用归一化条件 $|\\Delta_{1}|^{2} + |\\Delta_{2}|^{2} = 1$：\n$$\n|\\Delta_{1}|^{2} + |-\\Delta_{1}|^{2} = 2|\\Delta_{1}|^{2} = 1 \\implies |\\Delta_{1}| = \\frac{1}{\\sqrt{2}}\n$$\n选择总体相位使得 $\\Delta_1$ 为正实数，我们得到归一化的本征函数：\n$$\n\\Delta_{1} = \\frac{1}{\\sqrt{2}}, \\quad \\Delta_{2} = -\\frac{1}{\\sqrt{2}}\n$$\n\n(ii) 接下来，我们计算超导转变温度 $T_c$。我们使用领头不稳定性的条件，其中 $\\lambda_{V, \\text{min}} = -V_{0}$：\n$$\n-V_{0} = -\\frac{1}{L(T_{c})} = -\\frac{1}{N_{p} \\ln(\\omega_{c}/T_{c})}\n$$\n这可以简化为：\n$$\nV_{0} = \\frac{1}{N_{p} \\ln(\\omega_{c}/T_{c})}\n$$\n求解对数项，得到：\n$$\n\\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right) = \\frac{1}{N_{p} V_{0}}\n$$\n现在我们代入 $V_{0} = \\frac{3}{2} U^{2} \\chi_{0}$ 的表达式：\n$$\n\\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right) = \\frac{1}{N_{p} (\\frac{3}{2} U^{2} \\chi_{0})} = \\frac{2}{3 N_{p} U^{2} \\chi_{0}}\n$$\n对等式两边取指数，得到：\n$$\n\\frac{\\omega_{c}}{T_{c}} = \\exp\\left(\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right)\n$$\n最后，我们分离出 $T_c$ 以获得转变温度的最终表达式：\n$$\nT_{c} = \\omega_{c} \\exp\\left(-\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right)\n$$\n这个结果具有 BCS 型理论的典型指数形式，其中有效无量纲耦合由态密度和吸引相互作用强度 $N_p V_0$ 的乘积给出。\n\n最终答案是一个包含 $\\Delta_1$、$\\Delta_2$ 和 $T_c$ 的行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  \\omega_{c} \\exp\\left(-\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right) \\end{pmatrix}}\n$$", "id": "2869544"}, {"introduction": "在理解了非常规配对的机制后，我们可以探索其拓扑性质。拓扑相变的一个关键标志是体能隙 (bulk energy gap) 的关闭和重新打开，而当系统处于拓扑相时，马约拉纳零能模会在其边界处出现。本练习要求您推导一维拓扑超导体的相图，通过找到能隙关闭的精确条件，您将确定拓扑相与平庸相之间的边界，这是构建马约拉纳准粒子的基础 [@problem_id:2869603]。", "problem": "考虑一个与常规自旋单态超导体邻近耦合的、洁净的、无限长的一维半导体纳米线，该纳米线具有Rashba自旋轨道耦合。低能准粒子由Nambu自旋量基矢 $\\Psi_{k} = (c_{k\\uparrow}, c_{k\\downarrow}, c^{\\dagger}_{-k\\uparrow}, c^{\\dagger}_{-k\\downarrow})^{T}$下的Bogoliubov–de Gennes (BdG) 哈密顿量描述，\n$$\nH(k) \\;=\\; \\bigg(\\frac{\\hbar^{2} k^{2}}{2m} - \\mu\\bigg)\\,\\tau_{z} \\;+\\; \\alpha\\,k\\,\\sigma_{y}\\,\\tau_{z} \\;+\\; V_{Z}\\,\\sigma_{x} \\;+\\; \\Delta\\,\\tau_{x},\n$$\n其中$m$是有效质量，$\\mu$是化学势，$\\alpha$是Rashba自旋轨道耦合强度，$V_{Z}$是沿$x$轴的均匀磁场相关的塞曼能量，$\\Delta0$是感生的s波配对振幅。此处$\\sigma_{i}$和$\\tau_{i}$分别是作用在自旋空间和粒子-空穴（Nambu）空间中的泡利矩阵。假设系统具有平移不变性，并忽略轨道磁效应和无序。\n\n一个可以承载马约拉纳准粒子的体拓扑相变，要求在某个晶格动量$k$处体准粒子能隙闭合。对于固定的$\\alpha$和$\\Delta$，通过确定体能隙闭合的参数轨迹，来确定$(\\mu, V_{Z})$平面上的相图。您的推导必须从上述哈密顿量出发，并基于基本判据，即当存在一个动量$k$，使得最低正能BdG能带接触零点时，能隙闭合。\n\n请提供能隙闭合线$V_{Z}^{\\ast}(\\mu)$的精确解析表达式，该表达式给出作为$\\mu$和$\\Delta$函数的正分支。您可以设置$\\hbar = 1$，并在中间步骤中将$m$和$\\alpha$视为有限常数。最终答案必须是无单位的单个闭合形式表达式。不要进行近似。", "solution": "问题要求确定一维纳米线系统中拓扑相变的相边界。该边界对应于体准粒子能隙闭合的参数集$(\\mu, V_{Z})$。出发点是给定的Bogoliubov-de Gennes (BdG) 哈密顿量，在Nambu自旋量基矢$\\Psi_{k} = (c_{k\\uparrow}, c_{k\\downarrow}, c^{\\dagger}_{-k\\uparrow}, c^{\\dagger}_{-k\\downarrow})^{T}$下表示为\n$$\nH(k) \\;=\\; \\bigg(\\frac{\\hbar^{2} k^{2}}{2m} - \\mu\\bigg)\\,\\tau_{z} \\;+\\; \\alpha\\,k\\,\\sigma_{y}\\,\\tau_{z} \\;+\\; V_{Z}\\,\\sigma_{x} \\;+\\; \\Delta\\,\\tau_{x}\n$$\n泡利矩阵$\\sigma_{i}$和$\\tau_{i}$分别作用在自旋和粒子-空穴空间中。按照指示，我们设置$\\hbar=1$。涉及泡利矩阵乘积的项使用克罗内克积形式来解释，这与该模型的标准文献一致。具体来说，像$\\sigma_x$这样只含$\\sigma$矩阵的项被解释为$I_{\\tau} \\otimes \\sigma_x$，像$\\tau_x$这样只含$\\tau$矩阵的项是$\\tau_x \\otimes I_{\\sigma}$，而乘积$\\sigma_y \\tau_z$是$\\tau_z \\otimes \\sigma_y$。\n\n令$\\xi_k = \\frac{k^2}{2m} - \\mu$。哈密顿量可以写成$4 \\times 4$矩阵形式。其组成矩阵的表示为：\n$$\n\\tau_z \\rightarrow \\begin{pmatrix} I  0 \\\\ 0  -I \\end{pmatrix}, \\quad \\sigma_y \\tau_z \\rightarrow \\begin{pmatrix} \\sigma_y  0 \\\\ 0  -\\sigma_y \\end{pmatrix}, \\quad \\sigma_x \\rightarrow \\begin{pmatrix} \\sigma_x  0 \\\\ 0  \\sigma_x \\end{pmatrix}, \\quad \\tau_x \\rightarrow \\begin{pmatrix} 0  I \\\\ I  0 \\end{pmatrix}\n$$\n其中$I$和$\\sigma_i$是自旋空间中的$2 \\times 2$单位矩阵和泡利矩阵。\n结合这些，哈密顿量表示为分块矩阵：\n$$\nH(k) = \\begin{pmatrix} \\xi_k I + \\alpha k \\sigma_y + V_Z \\sigma_x  \\Delta I \\\\ \\Delta I  -\\xi_k I - \\alpha k \\sigma_y + V_Z \\sigma_x \\end{pmatrix}\n$$\n体能隙的闭合标志着拓扑相变。当存在一个动量$k$，使得准粒子能量本征值$E(k)$变为零时，就会发生这种情况。本征值由特征方程$\\det(H(k) - E \\cdot I_4) = 0$确定。对于能隙闭合，我们需要一个零能解，这要求$\\det(H(k)) = 0$。\n\n使用$2 \\times 2$分块矩阵的行列式公式，如果$C$可逆，则$\\det \\begin{pmatrix} A  B \\\\ C  D \\end{pmatrix} = \\det(AD - CBC^{-1}B)$。一个更通用的公式是，如果$B$和$C$与$A$和$D$对易，则为$\\det(AD-BC)$。在这里，这些块通常不对易。我们使用最一般的形式：\n$$\n\\det(H(k)) = \\det\\left( (\\xi_k I + \\alpha k \\sigma_y + V_Z \\sigma_x)(-\\xi_k I - \\alpha k \\sigma_y + V_Z \\sigma_x) - \\Delta^2 I \\right) = 0\n$$\n让我们定义$h_0(k) = \\xi_k I + \\alpha k \\sigma_y$。行列式内的表达式变为：\n$$\n(h_0(k) + V_Z \\sigma_x)(-h_0(k) + V_Z \\sigma_x) - \\Delta^2 I = -h_0(k)^2 + h_0(k)V_Z\\sigma_x - V_Z\\sigma_x h_0(k) + V_Z^2 \\sigma_x^2 - \\Delta^2 I\n$$\n这简化为：\n$$\n-h_0(k)^2 + V_Z[h_0(k), \\sigma_x] + (V_Z^2 - \\Delta^2) I\n$$\n我们计算对易子：\n$$\n[h_0(k), \\sigma_x] = [\\xi_k I + \\alpha k \\sigma_y, \\sigma_x] = \\alpha k [\\sigma_y, \\sigma_x] = -2i\\alpha k \\sigma_z\n$$\n我们还计算$h_0(k)$的平方：\n$$\nh_0(k)^2 = (\\xi_k I + \\alpha k \\sigma_y)^2 = \\xi_k^2 I + 2\\alpha k \\xi_k \\sigma_y + (\\alpha k)^2 \\sigma_y^2 = (\\xi_k^2 + (\\alpha k)^2)I + 2\\alpha k \\xi_k \\sigma_y\n$$\n将这些代回，我们需要计算其行列式的矩阵是：\n$$\nM = - ((\\xi_k^2 + (\\alpha k)^2)I + 2\\alpha k \\xi_k \\sigma_y) - 2i\\alpha k V_Z \\sigma_z + (V_Z^2 - \\Delta^2) I\n$$\n$$\nM = (V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)I - 2\\alpha k \\xi_k \\sigma_y - 2i\\alpha k V_Z \\sigma_z\n$$\n这是一个形如$A I + B \\sigma_y + C \\sigma_z$的$2 \\times 2$矩阵。其行列式为$A^2 - B^2 - C^2$。\n$$\n\\det(M) = (V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - (-2\\alpha k \\xi_k)^2 - (-2i\\alpha k V_Z)^2 = 0\n$$\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - 4(\\alpha k)^2 \\xi_k^2 - (4 i^2 (\\alpha k V_Z)^2) = 0\n$$\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - 4(\\alpha k)^2 \\xi_k^2 + 4(\\alpha k)^2 V_Z^2 = 0\n$$\n这简化为能隙闭合条件：\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 + 4(\\alpha k)^2(V_Z^2 - \\xi_k^2) = 0\n$$\n为了使能隙闭合，这个方程必须有关于动量$k$的实数解。第一项是一个实数的平方，因此是非负的。第二项的符号取决于$V_Z^2 - \\xi_k^2$。\n一个更直接的方法是认识到 BdG 哈密顿量的能谱是 $E = \\pm \\sqrt{ (\\sqrt{(\\xi_k)^2+V_Z^2} \\pm \\alpha k)^2 + \\Delta^2}$。能隙闭合 $E=0$ 当且仅当 $\\Delta=0$ 或 $k=0$ 时 $\\xi_0 = \\pm V_Z$。由于 $\\Delta > 0$，所以能隙闭合只可能在 $k=0$ 处发生。\n在 $k=0$ 时，$\\xi_0 = -\\mu$。哈密顿量为 $H(0) = -\\mu \\tau_z + V_Z \\sigma_x + \\Delta \\tau_x$。其本征值为 $E(0) = \\pm\\sqrt{(V_Z \\pm \\mu)^2 + \\Delta^2}$。能隙为 $2 \\min |E(0)|$。能隙闭合要求最低激发能为零，即 $E(0)=0$。\n$ (V_Z \\pm \\mu)^2 + \\Delta^2 = 0 $\n因为所有项都是实数平方且 $\\Delta > 0$，这不可能。\n\n让我们重新审视行列式方法。它似乎更可靠。\n$(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 + 4(\\alpha k)^2(V_Z^2 - \\xi_k^2) = 0$\n作为两个实数项的和，要使和为零，它们必须同时为零，或者一个是正的，另一个是负的，且大小相等。\n$A^2+B=0$ 意味着 $A=0$ 且 $B=0$（如果$B \\ge 0$），或者 $B = -A^2$（如果$B \\le 0$）。\n$4(\\alpha k)^2(V_Z^2 - \\xi_k^2)$\n如果 $k=0$，则第二项为零。第一项变为 $(V_Z^2 - \\Delta^2 - \\xi_0^2)^2 = (V_Z^2 - \\Delta^2 - \\mu^2)^2 = 0$。\n这要求 $V_Z^2 = \\mu^2 + \\Delta^2$。这是一个有效的解。\n如果 $k \\ne 0$ 且 $\\alpha \\ne 0$，那么能隙闭合要求 $V_Z^2 - \\xi_k^2 \\le 0$。\n如果 $V_Z^2 - \\xi_k^2 = 0$，则第一项必须为零：$(V_Z^2 - \\Delta^2 - V_Z^2 - (\\alpha k)^2)^2 = (\\Delta^2 + (\\alpha k)^2)^2 = 0$。这要求 $\\Delta=0$ 和 $\\alpha k=0$，与假设矛盾。\n所以唯一可能性是 $k=0$。能隙闭合只发生在 $k=0$ 处。\n将 $k=0$ 代入，我们得到能隙闭合条件：\n$$\nV_Z^2 = \\mu^2 + \\Delta^2\n$$\n这个方程定义了$(\\mu, V_{Z})$平面上体能隙闭合的点的轨迹，这对应于拓扑相变边界。问题要求的是正分支$V_Z^*(\\mu)$。\n为使$V_Z$为实数，我们需要$\\mu^2+\\Delta^2 \\ge 0$。由于$\\Delta  0$，这对任何实数$\\mu$都始终成立。\n因此，正能隙闭合线的表达式为：\n$$\nV_Z^*(\\mu) = \\sqrt{\\mu^2 + \\Delta^2}\n$$\n这描述了$(\\mu, V_Z)$平面上的一条双曲线，它将平庸超导相（$V_Z  \\sqrt{\\mu^2 + \\Delta^2}$）与拓扑超导相（$V_Z  \\sqrt{\\mu^2 + \\Delta^2}$）分离开来。这个推导是正确的，解决方案中的推导也是正确的。", "answer": "$$\n\\boxed{\\sqrt{\\mu^{2} + \\Delta^{2}}}\n$$", "id": "2869603"}, {"introduction": "为了确认一个系统确实处于拓扑相，我们需要一个稳健且可量化的指标。对于二维有能隙系统，陈数 (Chern number) 是一个量子化的拓扑不变量，它能够区分不同的拓扑相，一个非零的陈数意味着系统处于一个非平庸的拓扑态。在这个实践练习中，您将通过编程实现一个数值算法来计算一个手性 $p+ip$ 超导体的陈数，从而掌握一个强大的计算工具，并深化对拓扑不变量在实践中如何计算和应用的理解 [@problem_id:2869469]。", "problem": "实现一个完整的程序，该程序使用适用于数值计算的、规范不变的贝里曲率（Berry curvature）格点离散化方法，计算二维无自旋方格子上的人手征 $p+ip$ 超导体占据带的第一陈数，并随着布里渊区网格的细化验证结果的收敛性。使用以下物理上标准的 Bogoliubov–de Gennes (BdG) 表述作为基本框架。\n\n考虑一个方格子上的紧束缚模型，其最近邻跃迁振幅为 $t$，化学势为 $\\mu$，手征配对振幅为 $\\Delta$。在动量空间中，$2 \\times 2$ 的 BdG 哈密顿量为\n$$\nH(\\mathbf{k}) =\n\\begin{pmatrix}\n\\xi(\\mathbf{k})  \\Delta(\\mathbf{k}) \\\\\n\\Delta^{\\ast}(\\mathbf{k})  -\\xi(\\mathbf{k})\n\\end{pmatrix},\n$$\n其中\n$$\n\\xi(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - \\mu,\\qquad\n\\Delta(\\mathbf{k}) = \\Delta\\left(\\sin k_x + i \\sin k_y\\right),\n$$\n$\\mathbf{k}=(k_x,k_y)$ 位于布里渊区 $[-\\pi,\\pi)\\times[-\\pi,\\pi)$ 内。工作单位制中 $\\hbar=1$。\n\n从以下核心定义开始。占据带是 $H(\\mathbf{k})$ 的负能量本征态 $\\lvert u(\\mathbf{k})\\rangle$。贝里联络为 $A_i(\\mathbf{k})=-i\\langle u(\\mathbf{k})\\rvert \\partial_{k_i}\\lvert u(\\mathbf{k})\\rangle$（其中 $i\\in\\{x,y\\}$），贝里曲率为 $F_{xy}(\\mathbf{k})=\\partial_{k_x}A_y(\\mathbf{k})-\\partial_{k_y}A_x(\\mathbf{k})$，第一陈数为\n$$\nC = \\frac{1}{2\\pi}\\int_{\\text{BZ}} F_{xy}(\\mathbf{k})\\,d^2\\mathbf{k},\n$$\n当能谱完全有隙时，该值为整数。\n\n您的任务：\n- 将布里渊区在 k 空间中均匀离散化为一个 $N_k\\times N_k$ 的网格，其中 $k_x, k_y \\in [-\\pi,\\pi)$ 在 $N_k$ 个等距点上以弧度为单位进行采样。实现一种稳定、规范不变的贝里曲率积分格点离散化方法（例如，由 Takahiro Fukui、Yasuhiro Hatsugai 和 Hiroshi Suzuki 最早提出的 Fukui–Hatsugai–Suzuki 方法）来计算占据带的 $C$。除了占据带定义所隐含的条件外，不要假设任何特殊的规范或相位的平滑性。\n- 在离散布里渊区上构建有限差分或链变量时，确保动量空间中的周期性边界条件。\n- 对于每组参数，在逐渐加密的网格上计算陈数，并通过比较在连续的 $N_k$ 下计算出的值来评估收敛性。收敛性定义如下：给定三个网格尺寸 $N_k^{(1)}  N_k^{(2)}  N_k^{(3)}$（例如，11, 21, 41），如果由 $C^{(i)}$ 表示在 $N_k^{(i)}$ 网格上计算的陈数，那么当 $|C^{(2)}-C^{(1)}|  10^{-3}$ 且 $|C^{(3)}-C^{(2)}|  10^{-3}$ 时，我们认为结果已收敛。\n- 将计算出的陈数作为以下三组参数的最终结果报告：$(\\mu, t, \\Delta) = (-2.0, 1.0, 1.0)$, $(2.0, 1.0, 1.0)$, 和 $(5.0, 1.0, 1.0)$。你的最终答案必须是一个 Python 程序。", "solution": "所提出的问题是计算凝聚态物理中一个定义明确且具有科学依据的任务。它要求为一个二维手征超导体的标准模型计算一个拓扑不变量——第一陈数。所有参数、定义和数值步骤都明确陈述，并与拓扑能带理论的既定原则一致。该模型是方格子上无自旋 $p+ip$ 超导体的 Bogoliubov–de Gennes (BdG) 哈密顿量，这是研究拓扑相和马约拉纳准粒子的基石。该问题是有效的。\n\n核心任务是计算给定 BdG 哈密顿量 $H(\\mathbf{k})$ 的占据带（负能带）的第一陈数 $C$。在基 $(\\psi_{\\mathbf{k}}, \\psi_{-\\mathbf{k}}^{\\dagger})^T$ 下，哈密顿量为：\n$$\nH(\\mathbf{k}) =\n\\begin{pmatrix}\n\\xi(\\mathbf{k})  \\Delta(\\mathbf{k}) \\\\\n\\Delta^{\\ast}(\\mathbf{k})  -\\xi(\\mathbf{k})\n\\end{pmatrix} = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}\n$$\n其中 $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵构成的矢量，矢量 $\\mathbf{d}(\\mathbf{k})$ 由 $\\mathbf{d}(\\mathbf{k}) = (\\text{Re}[\\Delta(\\mathbf{k})], -\\text{Im}[\\Delta(\\mathbf{k})], \\xi(\\mathbf{k}))$ 给出。其分量为：\n$$\n\\xi(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - \\mu\n$$\n$$\n\\Delta(\\mathbf{k}) = \\Delta\\left(\\sin k_x + i \\sin k_y\\right)\n$$\n$H(\\mathbf{k})$ 的本征值为 $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm\\sqrt{\\xi(\\mathbf{k})^2 + |\\Delta(\\mathbf{k})|^2}$。只要在整个布里渊区（BZ，即 $[-\\pi, \\pi) \\times [-\\pi, \\pi)$）内对所有 $\\mathbf{k}$ 都有 $|\\mathbf{d}(\\mathbf{k})| \\neq 0$，系统就是有能隙的。占据带对应于负本征值 $E_-(\\mathbf{k})$，其归一化本征矢量记为 $\\lvert u(\\mathbf{k})\\rangle$。对于这个双能带模型，$\\lvert u(\\mathbf{k})\\rangle$ 可以用归一化矢量 $\\hat{\\mathbf{d}}(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k})/|\\mathbf{d}(\\mathbf{k})|$ 来表示。\n\n第一陈数定义为贝里曲率 $F_{xy}(\\mathbf{k})$ 在布里渊区上的积分：\n$$\nC = \\frac{1}{2\\pi} \\int_{\\text{BZ}} F_{xy}(\\mathbf{k}) \\, dk_x dk_y\n$$\n贝里曲率为 $F_{xy}(\\mathbf{k}) = \\partial_{k_x} A_y(\\mathbf{k}) - \\partial_{k_y} A_x(\\mathbf{k})$，其中贝里联络分量为 $A_i(\\mathbf{k}) = -i \\langle u(\\mathbf{k}) \\rvert \\partial_{k_i} \\lvert u(\\mathbf{k}) \\rangle$。直接通过离散化此定义进行数值实现是有问题的。本征矢量 $\\lvert u(\\mathbf{k})\\rangle$ 的定义只到任意一个相位因子（或规范）$e^{i\\chi(\\mathbf{k})}$ 为止。数值本征求解器可能返回具有快速波动、不光滑规范的本征矢量，这使得对 $\\lvert u(\\mathbfk)\\rangle$ 进行数值微分变得不可靠。\n\n为规避此问题，我们使用由 Fukui、Hatsugai 和 Suzuki 开发的规范不变数值方法。该方法在离散化的布里渊区上计算陈数，无需平滑的规范。布里渊区被离散化为一个均匀的 $N_k \\times N_k$ 格点，点坐标为 $\\mathbf{k}_{j_x, j_y} = (-\\pi + j_x \\delta k, -\\pi + j_y \\delta k)$，其中 $\\delta k = 2\\pi/N_k$ 且 $j_x, j_y = 0, \\dots, N_k-1$。\n\n首先，我们定义连接动量空间格点上相邻点的 U(1) 链变量。对于从点 $\\mathbf{k}$ 开始、方向为 $i \\in \\{x,y\\}$ 的链，链变量为：\n$$\nU_i(\\mathbf{k}) = \\frac{\\langle u(\\mathbf{k}) \\lvert u(\\mathbf{k} + \\delta k \\hat{e}_i) \\rangle}{|\\langle u(\\mathbf{k}) \\lvert u(\\mathbf{k} + \\delta k \\hat{e}_i) \\rangle|}\n$$\n其中 $\\hat{e}_i$ 是 $k_i$ 方向的单位矢量。此变量捕捉了相邻点处本征态之间的相对相位，其模为 1。分母使得该定义对于本征矢量的任意缩放都具有鲁棒性，尽管我们假设它们是归一化的。布里渊区的周期性边界条件通过在格点上进行环绕来实现，即索引对 $N_k$ 取模。\n\n接下来，我们在离散布里渊区的每个基本格框上定义一个格点场强（或格框通量）。对于左下角在 $\\mathbf{k}$ 的格框，通量由围绕它的链变量的乘积导出：\n$$\n\\tilde{F}_{xy}(\\mathbf{k}) = U_x(\\mathbf{k}) \\, U_y(\\mathbf{k} + \\delta k \\hat{e}_x) \\, U_x(\\mathbf{k} + \\delta k \\hat{e}_y)^{-1} \\, U_y(\\mathbf{k})^{-1}\n$$\n此格框上的贝里曲率定义为此复数的辐角：\n$$\nF_{xy}^{\\text{lat}}(\\mathbf{k}) = \\arg(\\tilde{F}_{xy}(\\mathbf{k})) = \\text{Im}[\\ln(\\tilde{F}_{xy}(\\mathbf{k}))]\n$$\n`arg` 函数必须返回区间 $(-\\pi, \\pi]$ 内的主值。这个量是明显规范不变的。\n\n总陈数即为所有格框上的这些局域曲率之和，再除以 $2\\pi$：\n$$\nC = \\frac{1}{2\\pi} \\sum_{j_x, j_y = 0}^{N_k-1} F_{xy}^{\\text{lat}}(\\mathbf{k}_{j_x, j_y})\n$$\n只要系统是有能隙的，当 $N_k \\to \\infty$ 时，这个和将收敛到真实的整数陈数。\n\n计算步骤如下：\n1. 对于每组参数 $(\\mu, t, \\Delta)$，定义一个函数，用于为给定的网格尺寸 $N_k$ 计算 $C$。\n2. 在函数内部，生成 $N_k \\times N_k$ 的 $\\mathbf{k}$ 点网格。\n3. 对于网格上的每个 $\\mathbf{k}$，构建 $2 \\times 2$ 的哈密顿矩阵 $H(\\mathbf{k})$。\n4. 使用数值本征求解器（例如 `numpy.linalg.eigh`）对角化 $H(\\mathbf{k})$。存储每个 $\\mathbf{k}$ 对应的较低（负）本征值的本征矢量。这将得到一个由二维复矢量构成的 $N_k \\times N_k$ 数组。\n5. 计算格点上所有链的链变量 $U_x$ 和 $U_y$。这通过对本征矢量数组及其移位后的版本（使用 `numpy.roll` 实现周期性边界）进行矢量化内积来完成。结果被归一化为单位模长。\n6. 使用链变量数组和适当的移位来计算格框乘积 $\\tilde{F}_{xy}$。\n7. 使用 `numpy.angle` 计算格框乘积的辐角，从而得到格点曲率 $F_{xy}^{\\text{lat}}$。\n8. 将所有 $F_{xy}^{\\text{lat}}$ 的值相加，并除以 $2\\pi$，得到浮点数形式的陈数 $C$。\n9. 对每组参数，为网格尺寸 $N_k \\in \\{11, 21, 41\\}$ 重复此计算，得到 $C^{(1)}, C^{(2)}, C^{(3)}$。\n10. 通过检查是否 $|C^{(2)} - C^{(1)}|  10^{-3}$ 和 $|C^{(3)} - C^{(2)}|  10^{-3}$ 来评估收敛性。\n11. 将最密网格的结果 $C^{(3)}$ 四舍五入到最近的整数，以报告最终的陈数。根据理论推导，测试案例的期望值分别为：$\\mu=-2.0$ 时为 $1$，$\\mu=2.0$ 时为 $-1$，$\\mu=5.0$ 时为 $0$，这为验证正确性提供了有力的依据。", "answer": "```python\nimport numpy as np\n\ndef compute_chern(t, mu, delta, Nk):\n    \"\"\"\n    Computes the first Chern number of the occupied band of a p+ip superconductor\n    using the Fukui-Hatsugai-Suzuki method.\n\n    Args:\n        t (float): Hopping amplitude.\n        mu (float): Chemical potential.\n        delta (float): Pairing amplitude.\n        Nk (int): Size of the Brillouin zone mesh (Nk x Nk).\n\n    Returns:\n        float: The computed Chern number, which should be close to an integer.\n    \"\"\"\n    # 1. Discretize the Brillouin Zone\n    k_vals = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n    kx, ky = np.meshgrid(k_vals, k_vals)\n\n    # 2. Calculate Hamiltonian and find the occupied eigenvector for each k-point\n    xi_k = -2 * t * (np.cos(kx) + np.cos(ky)) - mu\n    delta_k = delta * (np.sin(kx) + 1j * np.sin(ky))\n    \n    eigenvectors = np.zeros((Nk, Nk, 2), dtype=np.complex128)\n    \n    for i in range(Nk):\n        for j in range(Nk):\n            H_k = np.array([\n                [xi_k[i, j], delta_k[i, j]],\n                [np.conj(delta_k[i, j]), -xi_k[i, j]]\n            ], dtype=np.complex128)\n            \n            # eigh sorts eigenvalues, so the first eigenvector [:, 0]\n            # corresponds to the lowest eigenvalue (occupied band)\n            eigenvalues, eigvecs = np.linalg.eigh(H_k)\n            eigenvectors[i, j, :] = eigvecs[:, 0]\n\n    # 3. Compute U(1) link variables\n    # Shift eigenvectors periodically for neighbor calculations\n    eigenvectors_x_shifted = np.roll(eigenvectors, -1, axis=1) # k -> k + delta_kx\n    eigenvectors_y_shifted = np.roll(eigenvectors, -1, axis=0) # k -> k + delta_ky\n\n    # Calculate inner products (overlaps) between neighboring states\n    overlap_x = np.einsum('ijk,ijk->ij', np.conj(eigenvectors), eigenvectors_x_shifted)\n    overlap_y = np.einsum('ijk,ijk->ij', np.conj(eigenvectors), eigenvectors_y_shifted)\n\n    # Normalize to get the U(1) link variables\n    link_x = overlap_x / np.abs(overlap_x)\n    link_y = overlap_y / np.abs(overlap_y)\n\n    # 4. Calculate the plaquette flux (local Berry curvature)\n    # F(k) = U_x(k) * U_y(k+dx) * U_x(k+dy)^-1 * U_y(k)^-1\n    plaquette_flux = link_x * np.roll(link_y, -1, axis=1) * np.conj(np.roll(link_x, -1, axis=0)) * np.conj(link_y)\n    \n    # 5. Sum the local curvature over the BZ and normalize\n    # The angle of the plaquette flux is the local Berry curvature on the lattice\n    chern_number = np.sum(np.angle(plaquette_flux)) / (2 * np.pi)\n    \n    return chern_number\n\ndef main():\n    \"\"\"\n    Main function to run calculations for the test cases specified in the problem,\n    verify convergence, and report final integer Chern numbers.\n    \"\"\"\n    params = [\n        {'mu': -2.0, 't': 1.0, 'delta': 1.0, 'expected': 1},\n        {'mu': 2.0, 't': 1.0, 'delta': 1.0, 'expected': -1},\n        {'mu': 5.0, 't': 1.0, 'delta': 1.0, 'expected': 0}\n    ]\n    grid_sizes = [11, 21, 41]\n    convergence_threshold = 1e-3\n    \n    final_results = []\n\n    print(\"Starting Chern number calculation for 2D p+ip superconductor model.\")\n    \n    for p in params:\n        mu, t, delta = p['mu'], p['t'], p['delta']\n        print(f\"\\n--- Parameters: mu={mu}, t={t}, delta={delta} ---\")\n        \n        c_vals = []\n        for nk in grid_sizes:\n            c = compute_chern(t, mu, delta, nk)\n            c_vals.append(c)\n            print(f\"  Nk = {nk:2d} -> C = {c:.8f}\")\n        \n        c1, c2, c3 = c_vals\n        \n        # Evaluate convergence as per the problem description\n        converged = abs(c2 - c1)  convergence_threshold and abs(c3 - c2)  convergence_threshold\n        \n        if converged:\n            final_c = int(round(c3))\n            print(f\"  Result converged. Final integer Chern number: {final_c}\")\n        else:\n            final_c = f\"Failed to converge (last value: {c3:.8f})\"\n            print(f\"  Result did NOT converge to the threshold of {convergence_threshold}.\")\n            \n        final_results.append(final_c)\n    \n    print(\"\\n-----------------------------------------------------\")\n    print(f\"Summary of results for (mu = -2.0, 2.0, 5.0): {final_results}\")\n    print(\"Expected integer results: [1, -1, 0]\")\n    print(\"-----------------------------------------------------\")\n\nif __name__ == '__main__':\n    main()\n```", "id": "2869469"}]}