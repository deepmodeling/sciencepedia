{"hands_on_practices": [{"introduction": "在我们研究表面等离激元（Surface Plasmon Polaritons, SPPs）的应用之前，我们必须首先验证它们存在的物理条件。这项练习将引导你应用金属的 Drude 模型来计算金在特定波长下的介电常数，并检验在金-水界面上支持 SPP 的基本条件是否得到满足 [@problem_id:2864084]。通过这个计算，你将能够把金属的微观自由电子理论与产生等离激元现象所需的宏观电磁学要求（即 $\\mathrm{Re}(\\epsilon_m) + \\epsilon_d \\lt 0$）直接联系起来。", "problem": "如果金属介电常数的实部与电介质介电常数之和为负，则金属与电介质之间的平面界面可以支持表面等离激元极化子（SPP）。考虑用自由电子Drude模型描述的金，该模型忽略了带间跃迁，并假设背景介电常数为1。金属与水接触，在可见光频率下，水的相对介电常数可近似视为常数，$\\epsilon_{d} \\simeq 1.77$。在自由空间波长 $\\lambda = 633\\ \\mathrm{nm}$ 处，利用Drude模型，根据给定的金属等离子体频率 $\\omega_{p} = 1.37 \\times 10^{16}\\ \\mathrm{s}^{-1}$ 和唯象阻尼率 $\\gamma = 1.05 \\times 10^{14}\\ \\mathrm{s}^{-1}$，从第一性原理计算金属的复介电常数 $\\epsilon_{m}(\\omega)$。使用光速 $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m/s}$ 和角频率 $\\omega = 2\\pi c/\\lambda$。\n\n然后，计算量 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$ 的值，并根据其符号判断在 $\\lambda = 633\\ \\mathrm{nm}$ 时，金-水界面是否满足SPP的存在条件。将最终数值答案表示为一个等于 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$ 的纯数（无量纲），并四舍五入到三位有效数字。", "solution": "该问题陈述已经过验证，被认为是科学上合理、定义明确、客观且自洽的。它提出了一个材料物理学中的标准问题，可以使用既定原理解决。因此，我将继续进行解答。\n\n该问题要求使用自由电子Drude模型计算金的复介电常数 $\\epsilon_{m}(\\omega)$，然后利用此结果检验金-水界面上表面等离激元极化子（SPP）的存在条件。在金属（介电常数为 $\\epsilon_m$）和电介质（介电常数为 $\\epsilon_d  0$）的界面上，SPP的存在条件是金属介电常数的实部必须为负，且其绝对值大于电介质的介电常数，即 $\\mathrm{Re}(\\epsilon_m)   -\\epsilon_d$，这等价于条件 $\\mathrm{Re}(\\epsilon_{m}) + \\epsilon_{d}   0$。\n\n在Drude模型的框架下，假设背景介电常数为1（$\\epsilon_{\\infty} = 1$），金属的复相对介电常数 $\\epsilon_{m}(\\omega)$ 由以下表达式给出：\n$$ \\epsilon_{m}(\\omega) = 1 - \\frac{\\omega_{p}^{2}}{\\omega(\\omega + i\\gamma)} $$\n其中 $\\omega$ 是电磁场的角频率，$\\omega_{p}$ 是金属的等离子体频率，$\\gamma$ 是唯象阻尼率。\n\n首先，我们必须计算与给定自由空间波长 $\\lambda = 633 \\ \\mathrm{nm} = 633 \\times 10^{-9} \\ \\mathrm{m}$ 对应的角频率 $\\omega$。使用光速 $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m/s}$，我们有：\n$$ \\omega = \\frac{2\\pi c}{\\lambda} = \\frac{2\\pi (2.99792458 \\times 10^{8}\\ \\mathrm{m/s})}{633 \\times 10^{-9}\\ \\mathrm{m}} \\approx 2.9759235 \\times 10^{15}\\ \\mathrm{s}^{-1} $$\n\n接下来，为了评估SPP的存在条件，我们需要 $\\epsilon_{m}(\\omega)$ 的实部。我们首先对Drude公式中与频率相关的项的分母进行有理化：\n$$ \\frac{\\omega_{p}^{2}}{\\omega(\\omega + i\\gamma)} = \\frac{\\omega_{p}^{2}}{\\omega^{2} + i\\gamma\\omega} = \\frac{\\omega_{p}^{2}(\\omega^{2} - i\\gamma\\omega)}{(\\omega^{2} + i\\gamma\\omega)(\\omega^{2} - i\\gamma\\omega)} = \\frac{\\omega_{p}^{2}(\\omega^{2} - i\\gamma\\omega)}{\\omega^{4} + \\gamma^{2}\\omega^{2}} = \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} - i \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} $$\n将此结果代回到 $\\epsilon_{m}(\\omega)$ 的表达式中：\n$$ \\epsilon_{m}(\\omega) = 1 - \\left( \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} - i \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} \\right) = \\left( 1 - \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} \\right) + i \\left( \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} \\right) $$\n由此，其实部被确定为：\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) = 1 - \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} $$\n\n给定的金的Drude模型参数为：$\\omega_{p} = 1.37 \\times 10^{16}\\ \\mathrm{s}^{-1}$ 和 $\\gamma = 1.05 \\times 10^{14}\\ \\mathrm{s}^{-1}$。现在我们将这些值以及计算出的 $\\omega$ 值代入 $\\mathrm{Re}(\\epsilon_{m}(\\omega))$ 的表达式中。让我们计算频率的平方：\n$$ \\omega_{p}^{2} = (1.37 \\times 10^{16}\\ \\mathrm{s}^{-1})^{2} = 1.8769 \\times 10^{32}\\ \\mathrm{s}^{-2} $$\n$$ \\omega^{2} \\approx (2.9759235 \\times 10^{15}\\ \\mathrm{s}^{-1})^{2} \\approx 8.856116 \\times 10^{30}\\ \\mathrm{s}^{-2} $$\n$$ \\gamma^{2} = (1.05 \\times 10^{14}\\ \\mathrm{s}^{-1})^{2} = 1.1025 \\times 10^{28}\\ \\mathrm{s}^{-2} $$\n因此分母为：\n$$ \\omega^{2} + \\gamma^{2} \\approx 8.856116 \\times 10^{30}\\ \\mathrm{s}^{-2} + 1.1025 \\times 10^{28}\\ \\mathrm{s}^{-2} \\approx 8.867141 \\times 10^{30}\\ \\mathrm{s}^{-2} $$\n现在，我们计算介电常数的实部：\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) = 1 - \\frac{1.8769 \\times 10^{32}\\ \\mathrm{s}^{-2}}{8.867141 \\times 10^{30}\\ \\mathrm{s}^{-2}} \\approx 1 - 21.16733 = -20.16733 $$\n\n最后，我们计算量 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$。已知水的介电常数为 $\\epsilon_{d} = 1.77$，我们有：\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d} \\approx -20.16733 + 1.77 = -18.39733 $$\n结果是强负值，这证实在指定的Drude模型的简化下，对于波长 $\\lambda = 633 \\ \\mathrm{nm}$，金-水界面上表面等离激元极化子的存在条件是满足的。\n\n问题要求将 $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$ 的最终数值答案四舍五入到三位有效数字。\n$$ -18.39733 \\approx -18.4 $$\n这就是所要求的值。", "answer": "$$ \\boxed{-18.4} $$", "id": "2864084"}, {"introduction": "表面等离激元共振（SPR）最重要的应用之一是无标记生物传感，它通过测量传感器表面的质量浓度变化来探测分子结合事件。本练习提供了一个实际的生物化学场景，你将计算一个小分子抑制剂与一个大酶结合时所能产生的最大理论信号 [@problem_id:1478750]。这项计算不仅能让你对 SPR 技术的灵敏度有一个定量的认识，还能帮助你理解在实际应用中检测小分子分析物所面临的挑战。", "problem": "一位生物化学家正在使用表面等离子体共振（SPR）仪器研究一种大分子酶与一种小分子抑制剂之间的结合相互作用。该酶作为配体，首先被固定在传感器芯片的表面上。这个固定过程导致了$RU_L = 12,000$共振单位（RU）的稳定基线增加。该酶的摩尔质量为$M_L = 250 \\text{ kDa}$，而作为分析物的抑制剂的摩尔质量为$M_A = 80 \\text{ Da}$。\n\n该SPR仪器的基本原理是，以RU为单位测量的响应信号与传感器表面的质量浓度成正比。对于这种特定设置，已知1.0 RU的信号变化对应于1.0 pg/mm$^2$的表面质量浓度变化。\n\n假设理想的1:1结合化学计量比（一个抑制剂分子与一个酶分子结合），并且100%的固定化酶分子都具有活性且可用于结合，计算当抑制剂流过表面并结合至饱和时，将观察到的理论最大SPR信号变化。\n\n答案以共振单位表示，并四舍五入到三位有效数字。", "solution": "SPR响应与表面质量密度成正比。令$k$为RU响应与表面质量密度之间的比例常数；此处$k=1\\,\\text{RU}/(\\text{pg}/\\text{mm}^{2})$，但我们以符号形式使用它，以便后续可以消掉。\n\n令$n_{L}$为固定化配体的表面数密度（每单位面积的分子数）。每单位面积的固定化配体质量为\n$$\nm_{L}^{\\text{area}}=n_{L}\\frac{M_{L}}{N_{A}},\n$$\n其中$M_{L}$是配体的摩尔质量，$N_{A}$是阿伏伽德罗常数。相应的固定化响应为\n$$\nRU_{L}=k\\,m_{L}^{\\text{area}}=k\\,n_{L}\\frac{M_{L}}{N_{A}}.\n$$\n对于理想的$1{:}1$结合且所有配体位点都有活性的情况，饱和时结合的分析物的表面数密度等于$n_{L}$。饱和时每单位面积的分析物质量为\n$$\nm_{A}^{\\text{area}}=n_{L}\\frac{M_{A}}{N_{A}},\n$$\n因此，饱和时结合引起的响应为\n$$\n\\Delta RU_{\\max}=k\\,m_{A}^{\\text{area}}=k\\,n_{L}\\frac{M_{A}}{N_{A}}.\n$$\n取二者之比，\n$$\n\\frac{\\Delta RU_{\\max}}{RU_{L}}=\\frac{k\\,n_{L}\\frac{M_{A}}{N_{A}}}{k\\,n_{L}\\frac{M_{L}}{N_{A}}}=\\frac{M_{A}}{M_{L}}.\n$$\n因此，\n$$\n\\Delta RU_{\\max}=RU_{L}\\frac{M_{A}}{M_{L}}.\n$$\n已知$RU_{L}=12000$，$M_{L}=250\\,\\text{kDa}=2.5\\times 10^{5}\\,\\text{Da}$，以及$M_{A}=80\\,\\text{Da}$，\n$$\n\\frac{M_{A}}{M_{L}}=\\frac{80}{2.5\\times 10^{5}}=3.2\\times 10^{-4},\n$$\n于是\n$$\n\\Delta RU_{\\max}=12000\\times 3.2\\times 10^{-4}=3.84.\n$$\n四舍五入到三位有效数字，理论最大SPR信号变化为$3.84$ RU。", "answer": "$$\\boxed{3.84}$$", "id": "1478750"}, {"introduction": "一个真实的 SPR 实验会产生一条随角度变化的反射率曲线，并在共振角处呈现一个特征性的深谷。本练习模拟了科研工作中的数据分析过程，要求你通过对反射率曲线进行理论模型拟合，来提取表面等离激元的内禀传播长度 $L_{\\mathrm{int}}$ [@problem_id:2864092]。通过区分材料固有的欧姆损耗与棱镜耦合引入的辐射损耗，这项实践展示了如何从原始实验数据中提炼出关键的物理参数，这是实验物理学中的一项核心技能。", "problem": "给定在棱镜耦合表面等离激元 (SPP) 激发（Kretschmann 结构）下产生的角分辨反射率数据，其中，由于与 SPP 的耦合，反射率在相位匹配角附近表现出一个凹陷。您的任务是编写一个完整的程序，对每个提供的数据集，通过拟合凹陷宽度来提取内禀 SPP 传播长度，同时考虑已知的棱镜辐射损耗。\n\n将使用的基本原理和建模假设：\n- 从麦克斯韦方程组和平面界面的边界条件出发，证明在金属-电介质界面上存在束缚的 SPP 模式。面内 SPP 波矢表示为 $k_{\\mathrm{sp}} = \\beta = \\mathrm{Re}(\\beta) + i\\,\\mathrm{Im}(\\beta)$，其中 $\\mathrm{Im}(\\beta)  0$ 代表损耗。\n- 沿界面的内禀 SPP 传播长度由指数振幅衰减 $e^{-\\mathrm{Im}(\\beta) x}$ 定义，并由 $L_{\\mathrm{int}} = 1/(2\\,\\mathrm{Im}(\\beta))$ 给出。\n- 在棱镜耦合实验中，入射光波矢的面内分量为 $k_x(\\theta) = n_p\\,k_0\\,\\sin(\\theta)$，其中 $n_p$ 是棱镜的折射率，$\\theta$ 是棱镜内的入射角， $k_0 = 2\\pi/\\lambda_0$ 是波长为 $\\lambda_0$ 的自由空间波数。\n- 在谐振附近，作为 $k_x$ 函数的反射率凹陷可以由一个洛伦兹线型来建模，这是由于单个主导模式与一个连续谱耦合所致。在面内波矢域中，总半宽表示为 $\\,\\Gamma_{\\mathrm{tot}}\\,$，是内禀损耗贡献 $\\,\\Gamma_{\\mathrm{int}}\\,$（欧姆损耗）和由于泄漏回棱镜而产生的外部辐射贡献 $\\,\\Gamma_{\\mathrm{rad}}\\,$ 之和：$\\Gamma_{\\mathrm{tot}} = \\Gamma_{\\mathrm{int}} + \\Gamma_{\\mathrm{rad}}$。这种可加性是动量域中与时间耦合模理论中衰减率可加性相类似的概念。\n- 因此，内禀传播长度为 $L_{\\mathrm{int}} = 1/\\left(2\\,\\Gamma_{\\mathrm{int}}\\right) = 1/\\left(2\\,(\\Gamma_{\\mathrm{tot}} - \\Gamma_{\\mathrm{rad}})\\right)$。\n\n需要实现的算法规范：\n1. 将给定的反射率-角度数据 $R(\\theta)$ 转换为面内波矢的函数 $k_x(\\theta) = n_p\\,k_0\\,\\sin(\\theta)$，其中 $\\theta$ 以弧度为单位， $k_0 = 2\\pi/\\lambda_0$。\n2. 在角度域中使用以下模型拟合测量的凹陷，该模型隐式地表示了 $k_x$ 域中的洛伦兹函数：\n   $$R_{\\mathrm{model}}(\\theta) = R_{\\mathrm{bg}} - \\frac{A}{1 + \\left(\\dfrac{k_x(\\theta) - k_{\\mathrm{res}}}{\\Gamma_{\\mathrm{tot}}}\\right)^2},$$\n   其中 $R_{\\mathrm{bg}}$ 是基线反射率，$A$ 是凹陷深度，$k_{\\mathrm{res}}$ 是谐振面内波矢，$\\Gamma_{\\mathrm{tot}}$ 是面内波矢域中的总半宽。参数 $R_{\\mathrm{bg}}$, $A$, $k_{\\mathrm{res}}$ 和 $\\Gamma_{\\mathrm{tot}}$ 应通过对所提供的数据进行非线性最小二乘拟合来获得。\n3. 使用已知的棱镜辐射半宽 $\\Gamma_{\\mathrm{rad}}$（每个案例均已给出），计算 $\\Gamma_{\\mathrm{int}} = \\Gamma_{\\mathrm{tot}} - \\Gamma_{\\mathrm{rad}}$，然后计算 $L_{\\mathrm{int}} = 1/\\left(2\\,\\Gamma_{\\mathrm{int}}\\right)$。\n4. 将 $L_{\\mathrm{int}}$ 以微米表示，方法是乘以 $10^{6}$，并将结果四舍五入到三位小数。\n\n您的程序必须处理以下测试套件。对于每个案例，使用上述模型在指定的角度网格上合成反射率数据 $R(\\theta)$（不添加噪声），然后执行拟合并计算 $L_{\\mathrm{int}}$。\n\n对于每个测试案例，数据生成参数如下：\n- 案例 1：\n  - $\\lambda_0 = 6.33\\times 10^{-7}\\,\\mathrm{m}$， $n_p = 1.515$\n  - 真实谐振角 $\\theta_{\\mathrm{res}} = 43.5\\,\\mathrm{deg}$\n  - 辐射半宽 $\\Gamma_{\\mathrm{rad}} = 2.0\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - 总半宽 $\\Gamma_{\\mathrm{tot}} = 7.0\\times 10^{4}\\,\\mathrm{m}^{-1}$ （意味着内禀半宽 $\\Gamma_{\\mathrm{int}} = 5.0\\times 10^{4}\\,\\mathrm{m}^{-1}$）\n  - 基线 $R_{\\mathrm{bg}} = 0.85$，凹陷深度 $A = 0.25$\n  - 角度网格：$\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$，采样间隔为 $0.02\\,\\mathrm{deg}$\n- 案例 2：\n  - $\\lambda_0 = 7.85\\times 10^{-7}\\,\\mathrm{m}$， $n_p = 1.6$\n  - 真实谐振角 $\\theta_{\\mathrm{res}} = 41.0\\,\\mathrm{deg}$\n  - 辐射半宽 $\\Gamma_{\\mathrm{rad}} = 5.0\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - 总半宽 $\\Gamma_{\\mathrm{tot}} = 2.1666666667\\times 10^{5}\\,\\mathrm{m}^{-1}$ （意味着内禀半宽 $\\Gamma_{\\mathrm{int}} \\approx 1.6666666667\\times 10^{5}\\,\\mathrm{m}^{-1}$）\n  - 基线 $R_{\\mathrm{bg}} = 0.90$，凹陷深度 $A = 0.20$\n  - 角度网格：$\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$，采样间隔为 $0.02\\,\\mathrm{deg}$\n- 案例 3：\n  - $\\lambda_0 = 5.32\\times 10^{-7}\\,\\mathrm{m}$， $n_p = 1.7$\n  - 真实谐振角 $\\theta_{\\mathrm{res}} = 44.0\\,\\mathrm{deg}$\n  - 辐射半宽 $\\Gamma_{\\mathrm{rad}} = 1.5\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - 总半宽 $\\Gamma_{\\mathrm{tot}} = 2.5\\times 10^{4}\\,\\mathrm{m}^{-1}$ （意味着内禀半宽 $\\Gamma_{\\mathrm{int}} = 1.0\\times 10^{4}\\,\\mathrm{m}^{-1}$）\n  - 基线 $R_{\\mathrm{bg}} = 0.75$，凹陷深度 $A = 0.15$\n  - 角度网格：$\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$，采样间隔为 $0.02\\,\\mathrm{deg}$\n\n在所有案例中，计算 $k_{\\mathrm{res}} = n_p\\,k_0\\,\\sin(\\theta_{\\mathrm{res}})$，然后使用上面给出的模型以及声明的 $R_{\\mathrm{bg}}$、$A$、$\\Gamma_{\\mathrm{tot}}$ 和 $k_{\\mathrm{res}}$ 在角度网格上合成反射率数据。将这些合成数据用作拟合程序的“测量”输入。\n\n角度单位和输出单位要求：\n- 模型中所有角度 $\\theta$ 内部必须以弧度处理，但提供的网格以度为单位，因此使用 $\\theta_{\\mathrm{rad}} = \\theta_{\\mathrm{deg}} \\times \\pi/180$ 将度转换为弧度。\n- 将最终的内禀 SPP 传播长度 $L_{\\mathrm{int}}$ 以微米表示，并四舍五入到三位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含案例 1、2 和 3 的三个 $L_{\\mathrm{int}}$ 值（单位为微米）。例如，包含三个值的输出应类似于 $[x_1,x_2,x_3]$，其中每个 $x_i$ 是一个四舍五入到三位小数的十进制数。", "solution": "所呈现的问题是一个关于分析源自 Kretschmann-Raether 棱镜耦合结构的表面等离激元共振 (SPR) 数据的直接计算练习。它要求通过将理论模型拟合到合成数据来提取表面等离激元 (SPP) 的内禀传播长度。该问题具有科学依据、内部一致且定义明确。尽管将模型拟合到由该模型本身生成的理想、无噪声数据的任务有些微不足道，并且仅用于验证算法的实现，而非一个真正的科学问题，但我们将以预期的严谨性执行所要求的程序。\n\n首先，我们必须建立物理原理。表面等离激元是横磁 (TM) 电磁表面波，沿着介电常数实部为负的导体（如金属）与电介质之间的界面传播。它们的存在是麦克斯韦方程组在界面边界条件下的直接结果。连接频率 $\\omega$ 与波矢 $k$ 的 SPP 色散关系，不与周围电介质中的光线相交。这意味着 SPP 不能由直接入射到界面上的光激发。\n\nKretschmann 结构规避了这种动量失配。一个高折射率棱镜 ($n_p$) 被放置在紧邻金属膜的位置。P 偏振光以大于全内反射临界角的角度 $\\theta$ 入射到棱镜基底上，产生一个穿透金属膜的消逝场。入射光波矢的面内分量由下式给出：\n$$k_x(\\theta) = n_p k_0 \\sin(\\theta)$$\n其中 $k_0 = 2\\pi/\\lambda_0$ 是给定真空波长 $\\lambda_0$ 的自由空间波数。在特定的谐振角 $\\theta_{\\mathrm{res}}$ 下，该波矢与 SPP 波矢的实部相匹配，即 $k_x(\\theta_{\\mathrm{res}}) \\approx \\mathrm{Re}(k_{\\mathrm{sp}})$。这种相位匹配条件允许能量从入射光有效耦合到 SPP 模式中，导致在衰减全反射 (ATR) 谱 $R(\\theta)$ 中出现一个尖锐的凹陷。\n\nSPP 波矢是一个复数， $k_{\\mathrm{sp}} = \\beta = \\mathrm{Re}(\\beta) + i\\,\\mathrm{Im}(\\beta)$，其中虚部 $\\mathrm{Im}(\\beta)$ 代表由损耗引起的阻尼。在动量 ($k$) 空间域中，谐振具有有限宽度，可以用洛伦兹线型进行建模。这个洛伦兹线型的总半高半宽 (HWHM)，表示为 $\\Gamma_{\\mathrm{tot}}$，源于两个主要的衰减通道：\n1. 内禀阻尼 $\\Gamma_{\\mathrm{int}}$，由金属内部的欧姆损耗（吸收）引起。\n2. 辐射阻尼 $\\Gamma_{\\mathrm{rad}}$，由 SPP 能量再辐射或“泄漏”回棱镜引起。\n\n根据耦合模理论，这些损耗率是可加的：\n$$\\Gamma_{\\mathrm{tot}} = \\Gamma_{\\mathrm{int}} + \\Gamma_{\\mathrm{rad}}$$\n内禀传播长度 $L_{\\mathrm{int}}$ 是指 SPP *强度* 仅因欧姆损耗而衰减到其初始值的 $1/e$ 时所传播的距离。这与内禀阻尼常数的关系如下：\n$$L_{\\mathrm{int}} = \\frac{1}{2\\Gamma_{\\mathrm{int}}}$$\n因子 $2$ 的出现是因为强度与场振幅的平方成正比，而场振幅按 $e^{-\\Gamma_{\\mathrm{int}} x}$ 衰减。\n\n问题要求我们将模拟的反射率数据 $R(\\theta)$ 拟合到以下模型：\n$$R_{\\mathrm{model}}(\\theta) = R_{\\mathrm{bg}} - \\frac{A}{1 + \\left(\\dfrac{k_x(\\theta) - k_{\\mathrm{res}}}{\\Gamma_{\\mathrm{tot}}}\\right)^2}$$\n在这里，$R_{\\mathrm{bg}}$ 是远离谐振的背景反射率，$A$ 是凹陷深度，$k_{\\mathrm{res}}$ 是谐振面内波矢，$\\Gamma_{\\mathrm{tot}}$ 是波矢域中的总半高半宽。\n\n每个测试案例的程序如下：\n1. 对于一组给定的参数（$\\lambda_0, n_p, \\theta_{\\mathrm{res}}, \\Gamma_{\\mathrm{rad}}, \\Gamma_{\\mathrm{tot}}, R_{\\mathrm{bg}}, A$），我们首先合成“测量”的反射率数据。我们在真实谐振角 $\\theta_{\\mathrm{res}}$ 周围定义一个角度网格 $\\theta$。角度必须从度转换为弧度以用于三角函数。我们计算真实的谐振波矢 $k_{\\mathrm{res}} = n_p (2\\pi/\\lambda_0) \\sin(\\theta_{\\mathrm{res}})$。然后，对于网格中的每个角度 $\\theta_i$，我们计算 $k_x(\\theta_i)$ 并随后计算模型反射率 $R(\\theta_i)$。\n2. 然后，我们使用 `scipy.optimize.curve_fit` 函数对这些合成数据进行非线性最小二乘拟合。待拟合的函数正是上面定义的 $R_{\\mathrm{model}}(\\theta)$，其中 $R_{\\mathrm{bg}}, A, k_{\\mathrm{res}}$ 和 $\\Gamma_{\\mathrm{tot}}$ 是自由参数。\n3. 从拟合结果中，我们提取总宽度 $\\Gamma_{\\mathrm{tot,fit}}$ 的优化值。\n4. 我们通过减去已知的辐射宽度来计算内禀宽度：$\\Gamma_{\\mathrm{int}} = \\Gamma_{\\mathrm{tot,fit}} - \\Gamma_{\\mathrm{rad}}$。\n5. 最后，我们计算内禀传播长度：$L_{\\mathrm{int}} = 1 / (2\\Gamma_{\\mathrm{int}})$。这个结果最初以米为单位，通过乘以 $10^6$ 转换为微米，然后按要求四舍五入到三位小数。\n\n由于数据是在没有噪声的情况下从用于拟合的同一模型生成的，因此拟合过程预计将高精度地恢复原始参数，这使得本次任务成为对正确实现的一次测试。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the surface plasmon resonance analysis problem for three test cases.\n    For each case, it synthesizes reflectivity data and then fits a model to\n    extract the intrinsic SPP propagation length.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (lambda_0, n_p, theta_res_deg, Gamma_rad, Gamma_tot, R_bg, A)\n    test_cases = [\n        # Case 1\n        (6.33e-7, 1.515, 43.5, 2.0e4, 7.0e4, 0.85, 0.25),\n        # Case 2\n        (7.85e-7, 1.6, 41.0, 5.0e4, 2.1666666667e5, 0.90, 0.20),\n        # Case 3\n        (5.32e-7, 1.7, 44.0, 1.5e4, 2.5e4, 0.75, 0.15),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        lambda_0, n_p, theta_res_deg, Gamma_rad, Gamma_tot_true, R_bg_true, A_true = case\n\n        # --- 1. Synthesize Reflectivity Data ---\n\n        # Calculate free-space wavenumber\n        k0 = 2 * np.pi / lambda_0\n        \n        # Convert resonance angle to radians\n        theta_res_rad = np.deg2rad(theta_res_deg)\n        \n        # Calculate the true resonant in-plane wavevector\n        k_res_true = n_p * k0 * np.sin(theta_res_rad)\n        \n        # Define the model function for data generation and fitting.\n        # It takes angle theta (in radians) as the independent variable.\n        # This wrapper handles the conversion from angle to k_x internally.\n        def reflectivity_model(theta_rad, R_bg, A, k_res, Gamma_tot):\n            k_x = n_p * k0 * np.sin(theta_rad)\n            lorentzian_term = 1 + ((k_x - k_res) / Gamma_tot)**2\n            return R_bg - A / lorentzian_term\n            \n        # Generate the angle grid for the synthetic data\n        theta_grid_deg = np.arange(theta_res_deg - 2.0, theta_res_deg + 2.0, 0.02)\n        theta_grid_rad = np.deg2rad(theta_grid_deg)\n        \n        # Generate synthetic reflectivity data without noise\n        R_synthetic = reflectivity_model(theta_grid_rad, R_bg_true, A_true, k_res_true, Gamma_tot_true)\n\n        # --- 2. Fit the Model to the Data ---\n\n        # Provide initial guesses for the fitting parameters.\n        # Using the true values is a good strategy for this verification task.\n        initial_guesses = [R_bg_true, A_true, k_res_true, Gamma_tot_true]\n        \n        # Perform non-linear least-squares fitting\n        try:\n            popt, _ = optimize.curve_fit(reflectivity_model, theta_grid_rad, R_synthetic, p0=initial_guesses)\n        except RuntimeError:\n            # Handle cases where the fit might fail, although unlikely with noise-free data\n            results.append(np.nan)\n            continue\n            \n        # Extract the fitted total width\n        _R_bg_fit, _A_fit, _k_res_fit, Gamma_tot_fit = popt\n        \n        # --- 3. Compute Intrinsic Propagation Length ---\n        \n        # Calculate the intrinsic width\n        Gamma_int = Gamma_tot_fit - Gamma_rad\n        \n        # Calculate the intrinsic propagation length\n        # L_int = 1 / (2 * Gamma_int)\n        # Check for division by zero or negative Gamma_int, although not expected here\n        if Gamma_int  0:\n            L_int_meters = 1.0 / (2.0 * Gamma_int)\n        else:\n            L_int_meters = np.inf\n        \n        # Convert from meters to micrometers\n        L_int_micrometers = L_int_meters * 1e6\n        \n        # Round to three decimal places\n        L_int_rounded = round(L_int_micrometers, 3)\n        \n        results.append(L_int_rounded)\n        \n    # Final print statement in the exact required format.\n    # Using format specifier to ensure three decimal places, e.g., 10.0 becomes 10.000\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2864092"}]}