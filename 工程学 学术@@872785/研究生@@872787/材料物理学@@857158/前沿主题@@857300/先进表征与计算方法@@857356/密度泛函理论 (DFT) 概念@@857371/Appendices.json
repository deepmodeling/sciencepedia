{"hands_on_practices": [{"introduction": "将密度泛函理论从抽象理论转化为实际计算的第一步，是掌握其核心近似方法。本练习 [@problem_id:2813517] 将引导您实践最基础的近似之一——局域密度近似（LDA）。您将通过推导局域密度近似（LDA）的交换能泛函并将其数值化实现，来深入理解如何使用均匀电子气的已知性质来近似真实非均匀体系的交换能，从而将抽象的理论公式与具体的代码实现联系起来。", "problem": "您需要实现一个程序，该程序能为一组给定的一维电子数密度分布，计算其仅交换的局域密度近似（LDA）能量以及在空间中点处对应的Kohn-Sham交换势。目标是从均匀电子气的基本描述出发，推导出LDA交换能量密度及其泛函导数，然后将该泛函离散化，并将其应用于所提供的密度分布。\n\n请从以下基本原理和经过充分检验的事实出发：\n- 在密度泛函理论（DFT）中，Hohenberg-Kohn定理保证了存在一个电子数密度 $n(\\mathbf{r})$ 的普适泛函。在Kohn-Sham（KS）构造中，交换相关贡献可以使用均匀电子气作为局域参考进行近似。\n- 对于自旋非极化的均匀电子气（密度均匀为 $n$），费米波矢为 $k_{\\mathrm{F}} = (3\\pi^{2} n)^{1/3}$，并且在该模型下可以精确计算Hartree-Fock交换能。\n\n任务：\n1) 推导自旋非极化电子气的仅交换LDA能量密度，作为局域密度 $n$ 的函数，然后通过对 $n$ 求泛函导数，得到相关的Kohn-Sham交换势。\n2) 在一维空间维度 $x \\in [0,L]$ 上，使用一个包含 $N$ 个点、间距为 $\\Delta x = L/(N-1)$ 的均匀网格，构建一个数值积分方法，以近似计算第一项中针对非均匀密度 $n(x) \\ge 0$ 的交换能泛函。假设单位横截面积，以使一维积分具有正确的体积量纲。\n3) 使用哈特里原子单位（a.u.）进行计算，其中玻尔半径 $a_0$ 为长度单位，哈特里为能量单位。您必须以哈特里表示能量，以哈特里表示势。不涉及任何角度量。\n4) 对每个给定的测试用例，计算：\n   - 总交换能 $E_{\\mathrm{x}}$（单位：哈特里）。\n   - 在空间中点 $x = L/2$ 处计算的交换势 $v_{\\mathrm{x}}$（单位：哈特里）。\n   使用梯形法则进行积分。如果 $n$ 在任何位置为0，请以一致且无奇异点的方式处理。\n\n测试套件（请精确使用这些参数值）：\n- 用例 1 (高斯包):\n  - 域长度 $L = 20\\,a_0$，网格大小 $N = 10001$。\n  - 密度 $n(x) = n_0 \\exp\\left(-\\frac{(x - L/2)^2}{2\\sigma^2}\\right)$，其中 $n_0 = 0.020\\,a_0^{-3}$ 且 $\\sigma = 2.000\\,a_0$。\n- 用例 2 (方顶厚板):\n  - 域长度 $L = 20\\,a_0$，网格大小 $N = 10001$。\n  - 当 $x \\in [0.4L,\\,0.6L]$ 时，密度 $n(x) = n_{\\mathrm{c}}$；其他情况下 $n(x) = 0$，其中 $n_{\\mathrm{c}} = 0.030\\,a_0^{-3}$。\n- 用例 3 (指数衰减):\n  - 域长度 $L = 20\\,a_0$，网格大小 $N = 10001$。\n  - 密度 $n(x) = n_0 \\exp(-x/\\alpha)$，其中 $n_0 = 0.040\\,a_0^{-3}$ 且 $\\alpha = 3.000\\,a_0$。\n- 用例 4 (真空):\n  - 域长度 $L = 20\\,a_0$，网格大小 $N = 10001$。\n  - 对所有 $x$，密度 $n(x) = 0$。\n\n数值和输出要求：\n- 全程使用哈特里原子单位。以哈特里表示 $E_{\\mathrm{x}}$，以哈特里表示 $v_{\\mathrm{x}}$。\n- 对每个用例，使用均匀网格梯形法则计算序对 $\\{E_{\\mathrm{x}}, v_{\\mathrm{x}}(L/2)\\}$。\n- 您的程序必须输出一行，其中包含一个扁平列表，按顺序包含八个结果：\n  $[E_{\\mathrm{x}}^{(1)}, v_{\\mathrm{x}}^{(1)}, E_{\\mathrm{x}}^{(2)}, v_{\\mathrm{x}}^{(2)}, E_{\\mathrm{x}}^{(3)}, v_{\\mathrm{x}}^{(3)}, E_{\\mathrm{x}}^{(4)}, v_{\\mathrm{x}}^{(4)}]$，\n  其中上标表示用例编号。每个数字必须四舍五入到恰好 $10$ 位小数。输出必须是方括号内以逗号分隔的列表，不得包含其他文本。\n\n您的任务是编写一个完整、可运行的程序，执行此计算并按上述指定的确切格式打印结果。不需要用户输入，也不应读取外部数据。实现语言和库在最终答案规范中受到限制。", "solution": "该问题是计算电子结构理论中的一个标准练习，具体涉及密度泛函理论（DFT）框架内的局域密度近似（LDA）。它在科学上基础扎实，算法上定义明确，并包含了获得唯一解所需的所有信息。因此，该问题被认为是有效的，我将着手解决它。\n\n核心任务是为几个一维电子密度分布 $n(x)$ 计算交换能泛函 $E_{\\mathrm{x}}[n]$ 和相应的交换势 $v_{\\mathrm{x}}(\\mathbf{r})$。我们从必要的理论推导开始。\n\n**步骤1：LDA交换能量密度和势的推导**\n\n局域密度近似建立在均匀电子气（HEG）的性质之上，这是一个具有恒定电子数密度 $n$ 的模型系统。对于自旋非极化的HEG，可以使用Hartree-Fock方法精确计算单粒子交换能 $\\epsilon_{\\mathrm{x}}$。在哈特里原子单位（$\\hbar = m_e = e = 4\\pi\\epsilon_0 = 1$）中，该能量由下式给出：\n$$\n\\epsilon_{\\mathrm{x}}(n) = -\\frac{3}{4\\pi} k_{\\mathrm{F}}(n)\n$$\n其中 $k_{\\mathrm{F}}$ 是费米波矢。对于三维HEG，$k_{\\mathrm{F}}$ 与密度 $n$ 的关系为：\n$$\nk_{\\mathrm{F}}(n) = (3\\pi^2 n)^{1/3}\n$$\n交换能量密度 $\\varepsilon_{\\mathrm{x}}$ 是单位体积的交换能。它通过将单粒子能量乘以单位体积内的粒子数（即密度 $n$）得到：\n$$\n\\varepsilon_{\\mathrm{x}}(n) = n \\cdot \\epsilon_{\\mathrm{x}}(n) = n \\left(-\\frac{3}{4\\pi} k_{\\mathrm{F}}(n)\\right)\n$$\n代入 $k_{\\mathrm{F}}(n)$ 的表达式，我们得到HEG的交换能量密度：\n$$\n\\varepsilon_{\\mathrm{x}}(n) = -\\frac{3n}{4\\pi} (3\\pi^2 n)^{1/3} = -\\frac{3}{4\\pi} (3\\pi^2)^{1/3} n^{1+1/3} = -\\frac{3}{4\\pi} (3\\pi^2)^{1/3} n^{4/3}\n$$\n这个表达式可以简化为标准形式 $\\varepsilon_{\\mathrm{x}}(n) = C_{\\mathrm{x}} n^{4/3}$，其中 $C_{\\mathrm{x}}$ 是Slater交换常数：\n$$\nC_{\\mathrm{x}} = -\\frac{3}{4\\pi} (3\\pi^2)^{1/3} = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\n在LDA中，我们通过对具有相同密度的均匀系统的局域能量密度进行积分，来近似一个密度为 $n(\\mathbf{r})$ 的非均匀系统的总交换能：\n$$\nE_{\\mathrm{x}}^{\\mathrm{LDA}}[n] = \\int \\varepsilon_{\\mathrm{x}}(n(\\mathbf{r})) \\, d^3\\mathbf{r} = \\int C_{\\mathrm{x}} [n(\\mathbf{r})]^{4/3} \\, d^3\\mathbf{r}\n$$\n相应的Kohn-Sham交换势 $v_{\\mathrm{x}}(\\mathbf{r})$ 是交换能泛函相对于密度的泛函导数：\n$$\nv_{\\mathrm{x}}(\\mathbf{r}) = \\frac{\\delta E_{\\mathrm{x}}^{\\mathrm{LDA}}[n]}{\\delta n(\\mathbf{r})}\n$$\n对于形式为 $E[n] = \\int f(n(\\mathbf{r})) \\, d^3\\mathbf{r}$ 的局域泛函，其泛函导数就是被积函数对其参数的普通导数：$\\frac{df(n)}{dn}$。因此，交换势是密度的局域函数：\n$$\nv_{\\mathrm{x}}(n(\\mathbf{r})) = \\frac{d\\varepsilon_{\\mathrm{x}}(n)}{dn} \\bigg|_{n=n(\\mathbf{r})} = \\frac{d}{dn} (C_{\\mathrm{x}} n^{4/3}) \\bigg|_{n=n(\\mathbf{r})} = \\frac{4}{3} C_{\\mathrm{x}} [n(\\mathbf{r})]^{1/3}\n$$\n值得注意的是，对于任何密度 $n \\ge 0$，$\\varepsilon_{\\mathrm{x}}(n)$ 和 $v_{\\mathrm{x}}(n)$ 都是良定义的。如果 $n=0$，则 $\\varepsilon_{\\mathrm{x}}(0)=0$ 且 $v_{\\mathrm{x}}(0)=0$。这确保了在真空区域不会出现奇异点。\n\n**步骤2：数值实现**\n\n问题定义在一维空间 $x$ 上，域为 $[0, L]$。我们被指示假设一个单位横截面积，因此体积元 $d^3\\mathbf{r}$ 变为 $dx$。总交换能为：\n$$\nE_{\\mathrm{x}}[n] = \\int_0^L C_{\\mathrm{x}} [n(x)]^{4/3} \\, dx\n$$\n该积分将在一个包含 $N$ 个点的均匀网格上进行数值计算，网格点为 $x_i = i \\cdot \\Delta x$（$i=0, 1, \\ldots, N-1$），其中网格间距为 $\\Delta x = L/(N-1)$。我们将使用梯形法则进行数值积分：\n$$\n\\int_0^L f(x) \\, dx \\approx \\Delta x \\left( \\frac{f(x_0) + f(x_{N-1})}{2} + \\sum_{i=1}^{N-2} f(x_i) \\right)\n$$\n要积分的函数是沿网格的交换能量密度，$f(x_i) = C_{\\mathrm{x}} [n(x_i)]^{4/3}$。\n\n交换势 $v_{\\mathrm{x}}(x)$ 在空间中点 $x = L/2$ 处进行计算。鉴于 $N=10001$ 是一个奇数，域的中点恰好与一个网格点重合。该中点的索引是 $i_{\\mathrm{mid}} = (N-1)/2 = 5000$。势的计算公式为：\n$$\nv_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} [n(x_{i_{\\mathrm{mid}}})]^{1/3}\n$$\n\n**步骤3：应用于测试用例**\n\n我们现在将使用提供的参数，将这些公式应用于四个指定的密度分布。所有计算均在哈特里原子单位中进行。常数 $C_{\\mathrm{x}}$ 只需计算一次。参数为 $L=20\\,a_0$ 和 $N=10001$。\n\n-   **用例 1 (高斯包):**\n    -   密度: $n(x) = n_0 \\exp\\left(-\\frac{(x - L/2)^2}{2\\sigma^2}\\right)$，其中 $n_0 = 0.020\\,a_0^{-3}$ 且 $\\sigma = 2.000\\,a_0$。\n    -   在网格上生成密度分布。为每个网格点 $i$ 计算被积函数 $C_{\\mathrm{x}}[n(x_i)]^{4/3}$。使用梯形法则求得 $E_{\\mathrm{x}}$。\n    -   势在 $x = L/2$ 处计算，此时 $n(L/2) = n_0 = 0.020$。所以，$v_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} (0.020)^{1/3}$。\n\n-   **用例 2 (方顶厚板):**\n    -   密度: 当 $x \\in [0.4L, 0.6L]$（即 $[8, 12]$）时，$n(x) = n_{\\mathrm{c}} = 0.030\\,a_0^{-3}$；其他情况下 $n(x) = 0$。\n    -   构建分段密度分布。被积函数仅在区域 $[8, 12]$ 内非零。通过梯形法则计算 $E_{\\mathrm{x}}$。\n    -   中点 $x=L/2=10$ 位于厚板内，因此 $n(L/2) = n_{\\mathrm{c}} = 0.030$。势为 $v_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} (0.030)^{1/3}$。\n\n-   **用例 3 (指数衰减):**\n    -   密度: $n(x) = n_0 \\exp(-x/\\alpha)$，其中 $n_0 = 0.040\\,a_0^{-3}$ 且 $\\alpha = 3.000\\,a_0$。\n    -   生成密度分布。通过对 $C_{\\mathrm{x}}[n(x_i)]^{4/3}$ 进行数值积分来计算 $E_{\\mathrm{x}}$。\n    -   势在中点密度 $n(L/2) = n(10) = 0.040 \\exp(-10/3)$ 处计算。然后，$v_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} [n(10)]^{1/3}$。\n\n-   **用例 4 (真空):**\n    -   密度: 对所有 $x$，$n(x) = 0$。\n    -   这是一个平凡的用例。由于密度处处为零，被积函数也为零。因此，总交换能 $E_{\\mathrm{x}}$ 恰好为 $0$。\n    -   中点的密度为 $n(L/2) = 0$，所以交换势 $v_{\\mathrm{x}}(L/2)$ 也为 $0$。\n\n以下程序精确地实现了这一过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the LDA exchange energy and potential for given 1D density profiles.\n    \"\"\"\n    # Define physical constants and simulation parameters in Hartree atomic units.\n    L = 20.0  # Domain length in a_0\n    N = 10001  # Number of grid points\n    \n    # Slater exchange constant C_x = -(3/4)*(3/pi)^(1/3)\n    C_x = -(3.0 / 4.0) * (3.0 / np.pi)**(1.0 / 3.0)\n\n    # Define the spatial grid\n    x_grid = np.linspace(0, L, N)\n    \n    # Midpoint index for potential evaluation\n    mid_idx = (N - 1) // 2\n    if x_grid[mid_idx] != L / 2.0:\n        # This should not happen for odd N\n        raise ValueError(\"Midpoint is not on the grid.\")\n\n    # Define test cases\n    test_cases = [\n        # Case 1: Gaussian bump\n        {'type': 'gaussian', 'n0': 0.020, 'sigma': 2.000},\n        # Case 2: Top-hat slab\n        {'type': 'tophat', 'nc': 0.030, 'xmin_frac': 0.4, 'xmax_frac': 0.6},\n        # Case 3: Exponential decay\n        {'type': 'exponential', 'n0': 0.040, 'alpha': 3.000},\n        # Case 4: Vacuum\n        {'type': 'vacuum'},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        case_type = params['type']\n        n_x = np.zeros_like(x_grid)\n\n        if case_type == 'gaussian':\n            n0 = params['n0']\n            sigma = params['sigma']\n            L_half = L / 2.0\n            n_x = n0 * np.exp(-((x_grid - L_half)**2) / (2 * sigma**2))\n        \n        elif case_type == 'tophat':\n            nc = params['nc']\n            xmin = params['xmin_frac'] * L\n            xmax = params['xmax_frac'] * L\n            mask = (x_grid >= xmin) & (x_grid <= xmax)\n            n_x[mask] = nc\n\n        elif case_type == 'exponential':\n            n0 = params['n0']\n            alpha = params['alpha']\n            n_x = n0 * np.exp(-x_grid / alpha)\n\n        elif case_type == 'vacuum':\n            # n_x is already an array of zeros\n            pass\n        \n        # Calculate total exchange energy E_x using the trapezoidal rule\n        # Integrand is C_x * n(x)^(4/3)\n        # We need to be careful with n=0 to avoid warnings, although n**(4/3) is 0.\n        # np.power handles this correctly.\n        integrand = C_x * np.power(n_x, 4.0 / 3.0)\n        E_x = np.trapz(integrand, x_grid)\n\n        # Calculate exchange potential v_x at the midpoint x = L/2\n        # v_x(n) = (4/3) * C_x * n^(1/3)\n        n_mid = n_x[mid_idx]\n        v_x_mid = (4.0 / 3.0) * C_x * np.power(n_mid, 1.0 / 3.0)\n\n        # Append results, rounded to 10 decimal places\n        results.append(round(E_x, 10))\n        results.append(round(v_x_mid, 10))\n\n    # Format output as a single comma-separated list in brackets\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2813517"}, {"introduction": "在学习了如何实现局域密度近似（LDA）之后，我们必须理解其内在的局限性。本练习 [@problem_id:2813500] 聚焦于一个关键概念：自相互作用误差（Self-Interaction Error, SIE），即在近似泛函中，一个电子会与其自身的电荷密度发生虚假的相互作用。通过对单电子氢原子体系进行精确的解析计算，您将对这一根本性缺陷获得深刻的、定量的理解，并认识到发展更高级泛函的必要性。", "problem": "考虑一个核电荷为 $Z$ 的单电子类氢离子，采用原子单位制（哈特里原子单位制，其中 $a_{0}=1$，$e=1$，$\\hbar=1$）。其基态 Kohn–Sham 自旋密度是完全自旋极化的，由 $n(\\mathbf{r})=\\left|\\psi_{1s}(\\mathbf{r})\\right|^{2}$ 给出，其中归一化的类氢 $1s$ 轨道为 $\\psi_{1s}(\\mathbf{r})=\\left(Z^{3}/\\pi\\right)^{1/2}\\exp(-Z r)$。对于给定近似泛函中的单电子，其自相互作用误差（SIE）在此定义为其哈特里（Hartree）静电能与其近似交换能之和，即 $E_{\\mathrm{SIE}}[n]=E_{H}[n]+E_{x}^{\\mathrm{approx}}[n]$。使用以下基本定义：\n- 哈特里能量 $E_{H}[n]=\\frac{1}{2}\\int d^{3}r\\int d^{3}r'\\,\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$。\n- 对于完全自旋极化的密度 $n(\\mathbf{r})$，局域自旋密度近似（LSDA）的交换能为 $E_{x}^{\\mathrm{LSDA}}[n]=- \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int d^{3}r\\,n(\\mathbf{r})^{4/3}$。\n假设只有交换作用（忽略相关作用）。从这些定义和给定的 $n(\\mathbf{r})$ 出发，推导 $E_{\\mathrm{SIE}}(Z)=E_{H}[n]+E_{x}^{\\mathrm{LSDA}}[n]$ 作为 $Z$ 的函数的闭式解析表达式。请用原子单位表示你的最终答案，不要近似或四舍五入；提供一个用 $Z$、$\\pi$ 和有理数表示的精确表达式。你的最终答案必须是单个解析表达式。", "solution": "问题陈述经评估有效。它在密度泛函理论的框架内具有科学依据，问题提法恰当且客观。它提供了推导唯一解析解所需的所有必要定义和数据。任务是计算单电子类氢系统的自相互作用误差，该误差定义为哈特里能量和近似交换能之和。计算将分两个阶段进行：首先，计算哈特里能量 $E_{H}[n]$；其次，计算局域自旋密度近似（LSDA）的交换能 $E_{x}^{\\mathrm{LSDA}}[n]$。\n\n类氢离子基态的电子密度由下式给出：\n$$n(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^2 = \\left| \\left(\\frac{Z^3}{\\pi}\\right)^{1/2}\\exp(-Z r) \\right|^2 = \\frac{Z^3}{\\pi}\\exp(-2Zr)$$\n由于密度是球对称的，我们将其表示为 $n(r)$。总电子数为 $\\int n(r) d^3r = \\int_0^\\infty 4\\pi r^2 \\frac{Z^3}{\\pi} \\exp(-2Zr) dr = 1$，正如预期。\n\n第一部分：计算哈特里能量 $E_{H}[n]$。\n哈特里能量是电荷分布 $n(r)$ 的经典静电自能：\n$$E_{H}[n]=\\frac{1}{2}\\int d^{3}r\\int d^{3}r'\\,\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$$\n这可以表示为 $E_H[n] = \\frac{1}{2}\\int d^3r \\, n(r) \\phi(r)$，其中 $\\phi(r)$ 是由密度 $n(r)$ 产生的静电势。对于球对称密度，半径 $r$ 处的电势由下式给出：\n$$\\phi(r) = \\frac{1}{r} \\int_0^r 4\\pi r'^2 n(r') dr' + \\int_r^\\infty 4\\pi r' n(r') dr'$$\n首先，我们计算涉及 $n(r')$ 的所需积分。\n半径 $r$ 以内包含的电荷：\n$$Q(r) = \\int_0^r 4\\pi r'^2 n(r') dr' = 4\\pi \\int_0^r r'^2 \\frac{Z^3}{\\pi} \\exp(-2Zr') dr' = 4Z^3 \\int_0^r r'^2 \\exp(-2Zr') dr'$$\n使用标准积分公式，可得：\n$$Q(r) = 4Z^3 \\left[ -\\frac{\\exp(-2Zr')}{2Z} \\left( r'^2 + \\frac{r'}{Z} + \\frac{1}{2Z^2} \\right) \\right]_0^r = 1 - (2Z^2r^2 + 2Zr + 1)\\exp(-2Zr)$$\n电势的第二部分是：\n$$\\int_r^\\infty 4\\pi r' n(r') dr' = 4Z^3 \\int_r^\\infty r' \\exp(-2Zr') dr' = 4Z^3 \\left[ -\\frac{\\exp(-2Zr')}{2Z} \\left(r' + \\frac{1}{2Z}\\right) \\right]_r^\\infty = Z(2Zr+1)\\exp(-2Zr)$$\n结合这些项，电势为：\n$$\\phi(r) = \\frac{Q(r)}{r} + Z(2Zr+1)\\exp(-2Zr) = \\frac{1 - (2Z^2r^2 + 2Zr + 1)\\exp(-2Zr)}{r} + Z(2Zr+1)\\exp(-2Zr) = \\frac{1}{r} - \\left(\\frac{1}{r}+Z\\right)\\exp(-2Zr)$$\n现在我们计算哈特里能量：\n$$E_H[n] = \\frac{1}{2} \\int_0^\\infty 4\\pi r^2 n(r) \\phi(r) dr = 2\\pi \\int_0^\\infty r^2 \\left(\\frac{Z^3}{\\pi}\\exp(-2Zr)\\right) \\left(\\frac{1}{r} - \\left(\\frac{1}{r}+Z\\right)\\exp(-2Zr)\\right) dr$$\n$$E_H[n] = 2Z^3 \\int_0^\\infty \\left(r\\exp(-2Zr) - (r+Zr^2)\\exp(-4Zr)\\right) dr$$\n该积分可以分解为三个形如 $\\int_0^\\infty x^k e^{-ax} dx = k!/a^{k+1}$ 的标准伽马型积分：\n$$ \\int_0^\\infty r\\exp(-2Zr) dr = \\frac{1!}{(2Z)^{2}} = \\frac{1}{4Z^2} $$\n$$ \\int_0^\\infty r\\exp(-4Zr) dr = \\frac{1!}{(4Z)^{2}} = \\frac{1}{16Z^2} $$\n$$ \\int_0^\\infty r^2\\exp(-4Zr) dr = \\frac{2!}{(4Z)^{3}} = \\frac{2}{64Z^3} = \\frac{1}{32Z^3} $$\n将这些结果代入 $E_H[n]$ 的表达式中：\n$$E_H[n] = 2Z^3 \\left( \\frac{1}{4Z^2} - \\frac{1}{16Z^2} - Z\\frac{1}{32Z^3} \\right) = 2Z^3 \\left( \\frac{1}{4Z^2} - \\frac{1}{16Z^2} - \\frac{1}{32Z^2} \\right)$$\n$$E_H[n] = 2Z \\left( \\frac{8}{32} - \\frac{2}{32} - \\frac{1}{32} \\right) = 2Z \\left( \\frac{5}{32} \\right) = \\frac{5}{16}Z$$\n\n第二部分：计算 LSDA 交换能 $E_{x}^{\\mathrm{LSDA}}[n]$。\n问题为 LSDA 交换泛函提供了一个特定的定义：\n$$E_{x}^{\\mathrm{LSDA}}[n] = - C_x \\int n(\\mathbf{r})^{4/3} d^{3}r \\quad \\text{with} \\quad C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$$\n我们必须计算 $n(r)^{4/3}$ 的积分：\n$$n(r)^{4/3} = \\left(\\frac{Z^3}{\\pi}\\exp(-2Zr)\\right)^{4/3} = \\frac{Z^4}{\\pi^{4/3}}\\exp\\left(-\\frac{8Zr}{3}\\right)$$\n空间积分是：\n$$\\int n(r)^{4/3} d^3r = \\int_0^\\infty 4\\pi r^2 \\left(\\frac{Z^4}{\\pi^{4/3}}\\exp\\left(-\\frac{8Zr}{3}\\right)\\right) dr$$\n$$ = 4\\pi^{-1/3} Z^4 \\int_0^\\infty r^2 \\exp\\left(-\\frac{8Zr}{3}\\right) dr = 4\\pi^{-1/3} Z^4 \\int_0^\\infty r^2 \\exp\\left(-\\frac{8Zr}{3}\\right) dr$$\n再次使用伽马型积分，其中 $k=2$ 且 $a = 8Z/3$：\n$$\\int_0^\\infty r^2 \\exp\\left(-\\frac{8Zr}{3}\\right) dr = \\frac{2!}{\\left(\\frac{8Z}{3}\\right)^3} = \\frac{2 \\cdot 3^3}{8^3 Z^3} = \\frac{54}{512 Z^3} = \\frac{27}{256 Z^3}$$\n将此结果代入空间积分的表达式中：\n$$\\int n(r)^{4/3} d^3r = 4\\pi^{-1/3} Z^4 \\left(\\frac{27}{256 Z^3}\\right) = \\frac{108}{256} \\frac{Z}{\\pi^{1/3}} = \\frac{27}{64} \\frac{Z}{\\pi^{1/3}}$$\n现在，LSDA 交换能为：\n$$E_{x}^{\\mathrm{LSDA}}[n] = - \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64} \\frac{Z}{\\pi^{1/3}}\\right) = - \\frac{3 \\cdot 3^{1/3}}{4 \\cdot \\pi^{1/3}} \\frac{27 Z}{64 \\pi^{1/3}} = - \\frac{3 \\cdot 3^{1/3} \\cdot 3^3}{256 \\pi^{2/3}} Z = - \\frac{3^{4+1/3}}{256 \\pi^{2/3}} Z = - \\frac{3^{13/3}}{256 \\pi^{2/3}} Z$$\n\n第三部分：总自相互作用误差 $E_{\\mathrm{SIE}}(Z)$。\n自相互作用误差是计算出的两个分量的和：\n$$E_{\\mathrm{SIE}}(Z) = E_{H}[n] + E_{x}^{\\mathrm{LSDA}}[n] = \\frac{5}{16}Z - \\frac{3^{13/3}}{256 \\pi^{2/3}}Z$$\n提取因子 $Z$：\n$$E_{\\mathrm{SIE}}(Z) = \\left(\\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\\right)Z$$\n这就是自相互作用误差作为 $Z$ 的函数的最终闭式解析表达式。", "answer": "$$\\boxed{Z \\left(\\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\\right)}$$", "id": "2813500"}, {"introduction": "标准的密度泛函理论近似，如局域密度近似（LDA），无法描述在分子间相互作用和材料凝聚中至关重要的长程范德华力。本练习 [@problem_id:2813503] 将带您探索非局域关联的物理，这正是范德华力的来源。您将基于绝热连接涨落-耗散定理（ACFDT），推导并实现一个描述色散相互作用的模型，从而揭示密度泛函理论如何超越半局域近似的范畴，以捕捉更复杂的物理现象。", "problem": "考虑两个在真空中充分分离的各向同性片段，在密度泛函理论 (DFT) 的框架内进行建模。负责色散（范德华）相互作用的非局域相关能可以从绝热连接涨落-耗散定理 (ACFDT) 推导得出。从相关能的 ACFDT 表达式出发，在偶极-偶极近似下，对片段间库仑耦合进行二阶展开，推导片段间相互作用能的前导渐近形式，该形式用它们在虚频率轴上计算的频率依赖偶极极化率表示。然后，假设每个片段的各向同性极化率遵循单振子（Drude）模型，由 $\\alpha(i\\omega) = \\dfrac{\\alpha_0}{1 + (\\omega/\\omega_0)^2}$ 给出，其中 $\\alpha_0$ 是静态极化率，$\\omega_0$ 是特征激发频率。从第一性原理出发，以原子单位获得渐近相互作用系数的闭合形式表达式，并由此得到作为质心间距 $R$ 函数的渐近相互作用能。\n\n为了在保持正确的长程极限的同时，对非物理的短程发散进行正则化，对色散项采用六阶 Tang-Toennies 阻尼因子，定义为\n$$\nf_6(x) = 1 - e^{-x} \\sum_{k=0}^{6} \\frac{x^k}{k!},\n$$\n其中 $x = b R$，$b$ 是一个正常数阻尼参数。阻尼相互作用能应通过将渐近色散项乘以 $f_6(bR)$ 来构建。\n\n在整个过程中使用原子单位，其中距离以玻尔半径 ($a_0$) 衡量，能量以哈特里 ($E_h$) 衡量，实现一个程序，该程序：\n- 在上述 Drude 模型假设下，推导渐近相互作用系数的闭合形式。\n- 计算以下每个测试用例的阻尼非局域相关（色散）能，单位为哈特里 ($E_h$)。\n- 将每个能量值四舍五入到小数点后 $12$ 位。\n- 生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n\n测试套件（每个用例是一个有序六元组 $(\\alpha_{A0}, \\omega_A, \\alpha_{B0}, \\omega_B, R, b)$，其中 $\\alpha$ 的单位是 $a_0^3$，$\\omega$ 的单位是 $E_h$，$R$ 的单位是 $a_0$，$b$ 的单位是 $a_0^{-1}$）：\n- 用例 1：$(\\alpha_{A0} = 10.0, \\omega_A = 0.3, \\alpha_{B0} = 10.0, \\omega_B = 0.3, R = 10.0, b = 1.0)$。\n- 用例 2：$(\\alpha_{A0} = 5.0, \\omega_A = 0.5, \\alpha_{B0} = 12.0, \\omega_B = 0.2, R = 8.0, b = 1.5)$。\n- 用例 3：$(\\alpha_{A0} = 20.0, \\omega_A = 0.25, \\alpha_{B0} = 15.0, \\omega_B = 0.35, R = 30.0, b = 0.7)$。\n- 用例 4：$(\\alpha_{A0} = 40.0, \\omega_A = 0.2, \\alpha_{B0} = 30.0, \\omega_B = 0.25, R = 2.0, b = 2.0)$。\n- 用例 5：$(\\alpha_{A0} = 2.0, \\omega_A = 1.5, \\alpha_{B0} = 1.5, \\omega_B = 2.0, R = 12.0, b = 1.0)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序与测试套件相同，每个值以 $E_h$ 为单位，四舍五入到小数点后 $12$ 位，例如 $[r_1,r_2,r_3,r_4,r_5]$。", "solution": "问题陈述在科学上是合理的、适定的，并为获得唯一解提供了所有必要信息。所涉及的概念，如绝热连接涨落-耗散定理 (ACFDT)、用于色散相互作用的 Casimir-Polder 公式、极化率的 Drude 模型以及 Tang-Toennies 阻尼，都是材料物理和量子化学领域的标准且成熟的概念。因此，该问题是有效的，并且可以构建一个解决方案。\n\n相互作用能的推导始于两个片段 A 和 B 之间的范德华色散能表达式，该表达式在 ACFDT 框架下由二阶微扰理论产生。对于两个充分分离、不重叠的片段，此相互作用能 $E_{\\text{disp}}^{(2)}$ 由虚频率 $\\omega$ 上的积分给出：\n$$\nE_{\\text{disp}}^{(2)} = -\\frac{1}{2\\pi} \\int_0^\\infty d\\omega \\, \\text{Tr} \\left[ \\chi_A(i\\omega) v_{AB} \\chi_B(i\\omega) v_{BA} \\right]\n$$\n在此，$\\chi_A(i\\omega)$ 和 $\\chi_B(i\\omega)$ 分别是孤立片段 A 和 B 在虚频率 $i\\omega$ 下计算的密度-密度响应函数。项 $v_{AB}$ 表示片段 A 和片段 B 电子之间的库仑相互作用算符。\n\n对于大的质心间距 $R$，库仑算符 $v_{AB}$ 可以展开为多极级数。前导且占主导地位的项是偶极-偶极相互作用。在此近似下，相互作用算符被偶极-偶极相互作用张量 $\\mathbf{T}_{AB}$ 所取代。对于具有各向同性频率依赖偶极极化率 $\\alpha_A(i\\omega)$ 和 $\\alpha_B(i\\omega)$ 的片段，能量表达式中的迹会显著简化。各向同性片段的极化率张量为 $\\boldsymbol{\\alpha}(i\\omega) = \\alpha(i\\omega)\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。迹变为：\n$$\n\\text{Tr} \\left[ \\chi_A v_{AB} \\chi_B v_{BA} \\right] \\rightarrow \\text{Tr} \\left[ \\boldsymbol{\\alpha}_A(i\\omega) \\mathbf{T}_{AB} \\boldsymbol{\\alpha}_B(i\\omega) \\mathbf{T}_{BA} \\right] = \\alpha_A(i\\omega)\\alpha_B(i\\omega) \\text{Tr}\\left(\\mathbf{T}_{AB}^2\\right)\n$$\n偶极-偶极相互作用张量 $\\mathbf{T}_{AB}$ 的平方的迹与片段的取向无关，其计算结果为 $\\text{Tr}\\left(\\mathbf{T}_{AB}^2\\right) = 6/R^6$。将此结果代回能量表达式，得到著名的 Casimir-Polder 渐近色散能公式：\n$$\nE_{\\text{disp}}^{asym}(R) = -\\frac{3}{\\pi R^6} \\int_0^\\infty d\\omega \\, \\alpha_A(i\\omega) \\alpha_B(i\\omega)\n$$\n该表达式的形式为 $E_{\\text{disp}}^{asym}(R) = -C_6/R^6$，其中伦敦色散系数 $C_6$ 由以下积分给出：\n$$\nC_6 = \\frac{3}{\\pi} \\int_0^\\infty d\\omega \\, \\alpha_A(i\\omega) \\alpha_B(i\\omega)\n$$\n问题为每个片段的各向同性极化率提供了单振子（Drude）模型：\n$$\n\\alpha_A(i\\omega) = \\frac{\\alpha_{A0}}{1 + (\\omega/\\omega_A)^2}, \\quad \\alpha_B(i\\omega) = \\frac{\\alpha_{B0}}{1 + (\\omega/\\omega_B)^2}\n$$\n其中 $\\alpha_{A0}$ 和 $\\alpha_{B0}$ 分别是片段 A 和 B 的静态极化率，$\\omega_A$ 和 $\\omega_B$ 是它们的特征激发频率。所有量均以原子单位表示。\n\n将这些模型极化率代入 $C_6$ 的表达式中，得到：\n$$\nC_6 = \\frac{3 \\alpha_{A0} \\alpha_{B0}}{\\pi} \\int_0^\\infty \\frac{d\\omega}{\\left(1 + (\\omega/\\omega_A)^2\\right)\\left(1 + (\\omega/\\omega_B)^2\\right)}\n$$\n这个积分可以使用部分分式分解法解析求解。定积分的结果是：\n$$\n\\int_0^\\infty \\frac{d\\omega}{\\left(1 + (\\omega/\\omega_A)^2\\right)\\left(1 + (\\omega/\\omega_B)^2\\right)} = \\frac{\\pi}{2} \\frac{\\omega_A \\omega_B}{\\omega_A + \\omega_B}\n$$\n将此结果代回 $C_6$ 的表达式，我们得到 Drude 模型下渐近相互作用系数的闭合形式表达式：\n$$\nC_6 = \\frac{3 \\alpha_{A0} \\alpha_{B0}}{\\pi} \\left( \\frac{\\pi}{2} \\frac{\\omega_A \\omega_B}{\\omega_A + \\omega_B} \\right) = \\frac{3}{2} \\frac{\\alpha_{A0} \\alpha_{B0} \\omega_A \\omega_B}{\\omega_A + \\omega_B}\n$$\n因此，渐近相互作用能为 $E_{\\text{disp}}^{asym}(R) = -C_6/R^6$。当 $R \\rightarrow 0$ 时，这个表达式会非物理地发散。为了在保持正确的长程渐近极限的同时修正这种短程行为，应用了一个阻尼函数。问题指定了一个六阶 Tang-Toennies 阻尼因子 $f_6(x)$：\n$$\nf_6(x) = 1 - e^{-x} \\sum_{k=0}^{6} \\frac{x^k}{k!}\n$$\n其中自变量为 $x = bR$，$b$ 是一个阻尼参数。然后，通过将渐近能量乘以该阻尼因子来构建阻尼相互作用能：\n$$\nE_{\\text{disp}}^{damped}(R) = E_{\\text{disp}}^{asym}(R) \\cdot f_6(bR) = -\\frac{C_6}{R^6} f_6(bR)\n$$\n注意，函数 $f_6(x)$ 等价于正则化的下不完全伽马函数，$f_6(x) = P(7, x) = \\gamma(7, x)/\\Gamma(7)$。\n\n下面的 Python 程序实现了这个最终公式，用于计算所提供测试用例的阻尼色散能。首先，它计算 $C_6$ 系数。然后，它使用 Tang-Toennies 函数 $f_6(bR)$ 计算阻尼能量，并按要求将结果四舍五入到小数点后 $12$ 位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.special\n\ndef solve():\n    \"\"\"\n    Derives and computes the damped nonlocal correlation (dispersion) energy between two fragments\n    using a Drude model for polarizability and a Tang-Toennies damping function, based on DFT principles.\n    \"\"\"\n    \n    # Test cases: (alpha_A0, omega_A, alpha_B0, omega_B, R, b)\n    # alpha in a_0^3, omega in E_h, R in a_0, b in a_0^-1\n    test_cases = [\n        (10.0, 0.3, 10.0, 0.3, 10.0, 1.0),\n        (5.0, 0.5, 12.0, 0.2, 8.0, 1.5),\n        (20.0, 0.25, 15.0, 0.35, 30.0, 0.7),\n        (40.0, 0.2, 30.0, 0.25, 2.0, 2.0),\n        (2.0, 1.5, 1.5, 2.0, 12.0, 1.0),\n    ]\n\n    results = []\n\n    def tang_toennies_f6(x):\n        \"\"\"\n        Calculates the sixth-order Tang-Toennies damping factor f_6(x).\n        f_6(x) = 1 - exp(-x) * sum_{k=0 to 6} (x^k / k!)\n        This is equivalent to the regularized lower incomplete gamma function P(7, x).\n        \"\"\"\n        # The sum is for k from 0 to n=6. The first argument to gammainc is n+1.\n        return scipy.special.gammainc(6 + 1, x)\n\n    for case in test_cases:\n        alpha_A0, omega_A, alpha_B0, omega_B, R, b = case\n\n        # Calculate the C6 coefficient in atomic units.\n        # C6 = (3/2) * (alpha_A0 * alpha_B0 * omega_A * omega_B) / (omega_A + omega_B)\n        c6 = 1.5 * (alpha_A0 * alpha_B0 * omega_A * omega_B) / (omega_A + omega_B)\n\n        # Calculate the asymptotic dispersion energy.\n        # E_asym = -C6 / R^6\n        e_asym = -c6 / (R**6)\n\n        # Calculate the argument for the damping function.\n        x = b * R\n\n        # Calculate the damping factor.\n        damping_factor = tang_toennies_f6(x)\n        \n        # Calculate the damped interaction energy.\n        e_damped = e_asym * damping_factor\n\n        # Round the result to 12 decimal places and store it.\n        results.append(round(e_damped, 12))\n\n    # Format and print the final output as a single-line string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2813503"}]}