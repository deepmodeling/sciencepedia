{"hands_on_practices": [{"introduction": "在密度泛函理论的“Jacob's Ladder”模型中，从局域密度近似（LDA）到广义梯度近似（GGA）是提升交换相关泛函精度的第一步。这个实践练习提供了一个具体的、可解析计算的机会，让您亲身体验梯度校正项是如何运作的[@problem_id:2821030]。通过对一个简单的指数衰减电子密度模型进行计算，您将直接量化由约化密度梯度 $s$ 决定的交换能贡献，从而将抽象的泛函公式与可触摸的能量变化联系起来。", "problem": "考虑一个与材料物理中的凝胶模型表面相关的自旋非极化平面电子密度。该电子密度仅依赖于垂直于表面的坐标 $x$，并在横向单位面积上是均匀的。模型密度为\n$$\nn(x) \\;=\\; n_{0}\\,\\exp\\!\\big(-\\alpha\\,|x|\\big), \\quad \\alpha>0,\\; n_{0}>0,\n$$\n积分范围为 $x \\in (-\\infty,\\infty)$。在 Kohn-Sham 密度泛函理论的框架内进行计算，并仅关注交换贡献（忽略关联）。从以下基本要素出发：\n\n- 源自均匀电子气的局域密度近似 (LDA) 交换能量密度，表示为每单位体积 $e_{x}^{\\mathrm{LDA}}(n) = -C_{x}\\,n^{4/3}$，其中 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。\n- 用于交换的约化密度梯度，定义为 $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$，对于自旋非极化体系，局域费米波矢为 $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2}n(\\mathbf{r})\\big)^{1/3}$。\n- 与 Perdew–Burke–Ernzerhof (PBE) 类型的交换广义梯度近似 (GGA) 一致的小 $s$ 值二阶梯度展开，其中增强因子为 $F_{x}(s) \\approx 1 + \\mu\\, s^{2}$，$\\mu$ 是标准的 PBE 交换梯度系数。假设此二阶形式对当前模型密度有效。\n\n任务：\n1) 使用这些定义，写出 LDA 中每单位面积的交换能 $E_{x}^{\\mathrm{LDA}}$，以及由 PBE 形式所蕴含的二阶 GGA 修正 $E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}$，用 $n(x)$ 和 $s(x)$ 表示。\n2) 对于给定的 $n(x)$，精确计算所得积分，以获得每单位面积的差值\n$$\n\\Delta E_{x} \\;=\\; E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}\n$$\n的闭合形式解析表达式，该表达式是 $n_{0}$、$\\alpha$、$\\mu$ 和基本常数的函数。\n3) 用一两句话简要解释，对于此密度分布，$s(x)$ 的空间依赖性如何控制 $\\Delta E_{x}$ 的符号和大小。\n\n将最终答案表示为每单位面积 $\\Delta E_{x}$ 的单一闭合形式解析表达式。不要代入常数的数值。不需要四舍五入。最终答案框中不要包含单位。", "solution": "问题陈述已经过验证，被认为是科学上合理、良构且客观的。它在密度泛函理论的框架内提出了一个标准的理论计算，利用了已确立的定义和一个有效的模型体系。因此，我们可以着手进行严格的解答推导。\n\n该问题要求计算在特定的一维电子密度分布下，广义梯度近似 (GGA) 和局域密度近似 (LDA) 交换能之间的差值。各项任务将按顺序解决。\n\n1) 首先，我们构建每单位面积交换能的通用表达式。总交换能 $E_x$ 是交换能量密度 $e_x$ 的空间积分。对于一个密度为 $n(x)$ 且在横向单位面积上均匀的体系，这由一个关于坐标 $x$ 的积分给出。\n\n每单位面积的 LDA 交换能 $E_{x}^{\\mathrm{LDA}}$ 是通过对 LDA 交换能量密度 $e_{x}^{\\mathrm{LDA}}(n) = -C_{x}n^{4/3}$ 积分得到的：\n$$\nE_{x}^{\\mathrm{LDA}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) \\,dx = -C_{x} \\int_{-\\infty}^{\\infty} n(x)^{4/3} \\,dx\n$$\nGGA 交换能由 $E_{x}^{\\mathrm{GGA}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) F_{x}(s(x)) \\,dx$ 给出。使用所提供的 PBE 类型增强因子的二阶展开式 $F_{x}(s) \\approx 1 + \\mu s^{2}$，相应的每单位面积交换能 $E_{x}^{\\mathrm{PBE}}$ 变为：\n$$\nE_{x}^{\\mathrm{PBE}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) \\left(1 + \\mu s(x)^{2}\\right) \\,dx\n$$\n因此，代表二阶梯度修正的差值 $\\Delta E_{x} = E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}$ 为：\n$$\n\\Delta E_{x} = \\int_{-\\infty}^{\\infty} \\left[ e_{x}^{\\mathrm{LDA}}(n(x))(1 + \\mu s(x)^{2}) - e_{x}^{\\mathrm{LDA}}(n(x)) \\right] \\,dx = \\mu \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) s(x)^{2} \\,dx\n$$\n代入 $e_{x}^{\\mathrm{LDA}}(n)$ 的表达式，我们得到修正项所要求的表达式：\n$$\n\\Delta E_{x} = -\\mu C_{x} \\int_{-\\infty}^{\\infty} n(x)^{4/3} s(x)^{2} \\,dx\n$$\n\n2) 接下来，我们对给定的密度分布 $n(x) = n_{0}\\exp(-\\alpha|x|)$ 计算这个积分。第一步是计算约化密度梯度 $s(x)$。密度的梯度为 $\\nabla n(x) = \\frac{dn}{dx}\\mathbf{\\hat{x}}$。对于 $x \\neq 0$，导数为 $\\frac{dn}{dx} = -\\alpha \\, \\mathrm{sgn}(x) \\, n_{0}\\exp(-\\alpha|x|) = -\\alpha \\, \\mathrm{sgn}(x) \\, n(x)$。梯度的模为 $|\\nabla n(x)| = \\alpha n(x)$。\n\n约化梯度 $s(x)$ 定义为 $s(x) = \\frac{|\\nabla n(x)|}{2k_{F}(x)n(x)}$，其中 $k_{F}(x) = (3\\pi^{2}n(x))^{1/3}$。代入 $|\\nabla n(x)|$ 和 $k_{F}(x)$ 的表达式：\n$$\ns(x) = \\frac{\\alpha n(x)}{2\\left(3\\pi^{2}n(x)\\right)^{1/3}n(x)} = \\frac{\\alpha}{2(3\\pi^{2})^{1/3}n(x)^{1/3}}\n$$\n现在我们可以计算被积函数 $n(x)^{4/3} s(x)^{2}$：\n$$\nn(x)^{4/3} s(x)^{2} = n(x)^{4/3} \\left( \\frac{\\alpha}{2(3\\pi^{2})^{1/3}n(x)^{1/3}} \\right)^{2} = n(x)^{4/3} \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}n(x)^{2/3}} = \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}} n(x)^{2/3}\n$$\n将此简化结果代入 $\\Delta E_{x}$ 的表达式中：\n$$\n\\Delta E_{x} = -\\mu C_{x} \\int_{-\\infty}^{\\infty} \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}} n(x)^{2/3} \\,dx = -\\frac{\\mu C_{x} \\alpha^{2}}{4(3\\pi^{2})^{2/3}} \\int_{-\\infty}^{\\infty} n(x)^{2/3} \\,dx\n$$\n我们现在计算剩余的积分。被积函数是偶函数，因此我们可以从 $0$ 积分到 $\\infty$ 再乘以 $2$。\n$$\n\\int_{-\\infty}^{\\infty} n(x)^{2/3} \\,dx = \\int_{-\\infty}^{\\infty} \\left(n_{0}\\exp(-\\alpha|x|)\\right)^{2/3} \\,dx = n_{0}^{2/3} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2\\alpha|x|}{3}\\right) \\,dx\n$$\n$$\n= 2 n_{0}^{2/3} \\int_{0}^{\\infty} \\exp\\left(-\\frac{2\\alpha x}{3}\\right) \\,dx = 2 n_{0}^{2/3} \\left[ -\\frac{3}{2\\alpha} \\exp\\left(-\\frac{2\\alpha x}{3}\\right) \\right]_{0}^{\\infty} = 2 n_{0}^{2/3} \\left( 0 - \\left(-\\frac{3}{2\\alpha}\\right) \\right) = \\frac{3 n_{0}^{2/3}}{\\alpha}\n$$\n将此结果代回 $\\Delta E_{x}$ 的表达式中：\n$$\n\\Delta E_{x} = -\\frac{\\mu C_{x} \\alpha^{2}}{4(3\\pi^{2})^{2/3}} \\left( \\frac{3 n_{0}^{2/3}}{\\alpha} \\right) = -\\frac{3 \\mu C_{x} \\alpha n_{0}^{2/3}}{4(3\\pi^{2})^{2/3}}\n$$\n最后，我们代入常数 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$ 的定义：\n$$\n\\Delta E_{x} = -\\frac{3 \\mu \\alpha n_{0}^{2/3}}{4(3\\pi^{2})^{2/3}} \\left( \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\right) = -\\frac{9}{16} \\frac{\\mu \\alpha n_{0}^{2/3}}{(3^{2/3}\\pi^{4/3})} (3^{1/3}\\pi^{-1/3})\n$$\n$$\n= -\\frac{9}{16} \\mu \\alpha n_{0}^{2/3} (3^{1/3-2/3}) (\\pi^{-1/3-4/3}) = -\\frac{9}{16} \\mu \\alpha n_{0}^{2/3} 3^{-1/3} \\pi^{-5/3}\n$$\n因为 $9 = 3^{2}$，我们有 $9 \\cdot 3^{-1/3} = 3^{2 - 1/3} = 3^{5/3}$。最终表达式为：\n$$\n\\Delta E_{x} = -\\frac{3^{5/3}}{16} \\mu \\alpha n_{0}^{2/3} \\pi^{-5/3} = -\\frac{\\mu \\alpha n_{0}^{2/3}}{16} \\left(\\frac{3}{\\pi}\\right)^{5/3}\n$$\n\n3) $\\Delta E_{x}$ 的符号和大小由被积函数 $\\mu s(x)^2 e_{x}^{\\mathrm{LDA}}(n(x))$ 控制。由于交换梯度系数 $\\mu$ 和 $s(x)^2$ 是正的，而对于任何非零密度，LDA 能量密度 $e_{x}^{\\mathrm{LDA}}(n(x))$ 是负的，因此被积函数处处为负，导致能量修正 $\\Delta E_{x}$ 严格为负。局域贡献的大小由约化梯度 $s(x)$（它随着离中心的距离指数增加）和密度 $n(x)$（它指数衰减）之间的竞争决定；对于这个特定的分布，它们的综合效应产生一个与 $n(x)^{2/3}$ 成正比的被积函数，其对总能量的贡献在密度最大处（$x=0$）最大，并向外对称衰减。", "answer": "$$\n\\boxed{-\\frac{\\mu \\alpha n_{0}^{2/3}}{16} \\left(\\frac{3}{\\pi}\\right)^{5/3}}\n$$", "id": "2821030"}, {"introduction": "离域误差（或自相互作用误差）是标准LDA和GGA泛函的一个主要缺陷，它会导致对拉伸的化学键或带有分数电荷的体系做出错误的预测。本练习将使用经典的拉伸氢分子阳离子（H₂⁺）模型，指导您设计一个计算实验来量化这一误差[@problem_id:2821091]。通过这个实践，您不仅能深刻理解离域误差的来源，还将看到通过混入一部分精确交换的杂化泛函是如何系统性地改善计算结果的。", "problem": "考虑一个基于氢分子阳离子建模的拉伸单电子双原子体系，其中核间距足够大，以至于电子密度可以近似为片段密度的非重叠总和。设总电子数固定为 $N=1$，并设电子的一部分（比例为 $\\lambda \\in [0,1]$）局域在左侧片段（中心 $A$），剩余的 $1-\\lambda$ 局域在右侧片段（中心 $B$）。每个片段都由一个归一化的类氢 $1s$ 密度描述，单位为原子单位（长度为玻尔，能量为哈特里），沿 $z$ 轴中心位于 $\\pm R/2$：\n$$\n\\rho_{1s}(r) = \\frac{1}{\\pi} e^{-2 r}, \\quad \\int \\rho_{1s}(\\mathbf{r}) \\, d^3 r = 1.\n$$\n在较大 $R$ 下的可忽略重叠假设下，取总自旋密度在自旋向上通道中完全自旋极化，\n$$\nn_{\\uparrow}(\\mathbf{r}; \\lambda) = \\lambda \\, \\rho_{1s}(|\\mathbf{r}-\\mathbf{R}_A|) + (1-\\lambda) \\, \\rho_{1s}(|\\mathbf{r}-\\mathbf{R}_B|), \\quad n_{\\downarrow}(\\mathbf{r}; \\lambda) = 0,\n$$\n并将所有密度非线性的积分近似为两个中心独立贡献的总和。\n\n对于单电子密度，精确的总Kohn-Sham交换能等于哈特里能量的负值，且精确相关能为零。近似的交换相关泛函通常会破坏这种抵消，从而引入离域误差。在本问题中，您将为三种仅交换近似量化这种离域误差：局域密度近似（LDA）、Perdew–Burke–Ernzerhof广义梯度近似（PBE），以及一个全局杂化泛函，该泛函将比例为 $\\alpha$ 的精确交换（类Hartree-Fock）与PBE交换混合。在整个过程中，忽略相关能（设为零），因此任何与精确分段线性的偏差都源于交换近似的自相互作用和离域行为。\n\n使用以下基本定义和事实作为您的出发点：\n\n- 对于给定的密度 $n(\\mathbf{r})$，哈特里能量为\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2} \\iint \\frac{n(\\mathbf{r}) \\, n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} \\, d^3 r \\, d^3 r'.\n$$\n对于模型密度 $n_{\\uparrow}(\\mathbf{r}; \\lambda)$ 和较大的 $R$，近似为\n$$\nE_{\\mathrm{H}}(\\lambda;R) \\approx \\frac{1}{2} J \\left[\\lambda^2 + (1-\\lambda)^2 \\right] + \\lambda (1-\\lambda) \\, J_{AB}(R),\n$$\n其中 $J$ 是单位归一化类氢 $1s$ 密度的库仑自相互作用，$J_{AB}(R)$ 是位于不同中心、相距为 $R$ 的两个单位归一化 $1s$ 电荷分布之间的库仑相互作用。使用经过充分检验的结果 $J = 5/8$（哈特里）以及对于大 $R$ 时 $J_{AB}(R) \\approx 1/R$。\n\n- 对于广义梯度近似（GGA），包括作为特例的LDA，交换的自旋标度为\n$$\nE_{x}^{\\mathrm{GGA}}[n_{\\uparrow}, n_{\\downarrow}] = \\frac{1}{2} E_{x}^{\\mathrm{GGA,unpol}}[2 n_{\\uparrow}] + \\frac{1}{2} E_{x}^{\\mathrm{GGA,unpol}}[2 n_{\\downarrow}],\n$$\n其中 $E_{x}^{\\mathrm{GGA,unpol}}[n]$ 是为非极化密度 $n(\\mathbf{r})$ 定义的。\n\n- 局域密度近似（仅交换，非极化）：\n$$\nE_{x}^{\\mathrm{LDA,unpol}}[n] = - C_{x} \\int n(\\mathbf{r})^{4/3} \\, d^3 r, \\quad C_{x} = \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\n\n- Perdew–Burke–Ernzerhof（仅交换，非极化）：使用相对于LDA的标准PBE交换增强因子，\n$$\nE_{x}^{\\mathrm{PBE,unpol}}[n] = - C_{x} \\int n(\\mathbf{r})^{4/3} \\, F_{x}(s(\\mathbf{r})) \\, d^3 r,\n$$\n其中约化梯度为\n$$\ns(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r}) \\, n(\\mathbf{r})}, \\quad k_{F}(\\mathbf{r}) = \\left(3 \\pi^{2} n(\\mathbf{r}) \\right)^{1/3},\n$$\n交换增强因子为\n$$\nF_{x}(s) = 1 + \\kappa - \\frac{\\kappa}{1 + \\mu \\, s^{2}/\\kappa}, \\quad \\kappa = 0.804, \\quad \\mu = 0.21951.\n$$\n\n- 对于类氢 $1s$ 密度，$|\\nabla \\rho_{1s}(r)| = 2 \\rho_{1s}(r)$，对于非极化密度 $n(\\mathbf{r}) = 2 q \\, \\rho_{1s}(r)$（其中 $q \\in [0,1]$），约化梯度简化为 $s(\\mathbf{r}) = \\left(3 \\pi^{2} n(\\mathbf{r})\\right)^{-1/3}$。\n\n- 定义一个全局杂化仅交换泛函\n$$\nE_{x}^{\\mathrm{hyb}} = \\alpha \\, E_{x}^{\\mathrm{EXX}} + (1-\\alpha) \\, E_{x}^{\\mathrm{PBE}},\n$$\n其中对于单电子密度，$E_{x}^{\\mathrm{EXX}} = -E_{\\mathrm{H}}$ 是精确的。将相关能设为零，总能量中交换加哈特里的贡献为\n$$\nE_{\\mathrm{H}x}^{\\mathrm{hyb}}(\\lambda;R,\\alpha) = E_{\\mathrm{H}}(\\lambda;R) + E_{x}^{\\mathrm{hyb}}(\\lambda;R,\\alpha).\n$$\n\n您必须实现一个程序，对于每个指定的泛函和间距，计算一个标量离域误差度量，该度量定义为 $E_{\\mathrm{H}x}$ 在半分配点处的曲率：\n$$\n\\Delta(R;\\mathrm{func}) = E_{\\mathrm{H}x}(\\lambda=\\tfrac{1}{2};R) - \\frac{1}{2} \\left[ E_{\\mathrm{H}x}(\\lambda=0;R) + E_{\\mathrm{H}x}(\\lambda=1;R) \\right].\n$$\n在精确（无自相互作用且分段线性）的情况下，对于所有 $R$，$\\Delta = 0$。负值表示凸性（离域误差）。\n\n您的任务是：\n- 使用上述假设，推导出在可忽略重叠极限下，$E_{\\mathrm{H}}(\\lambda;R)$、$E_{x}^{\\mathrm{LDA}}(\\lambda)$、$E_{x}^{\\mathrm{PBE}}(\\lambda)$ 和 $E_{x}^{\\mathrm{hyb}}(\\lambda; \\alpha)$ 作为 $\\lambda$ 的函数的可计算表达式。对于LDA，您可以解析地化简所需的对 $\\rho_{1s}^{4/3}$ 的积分。对于PBE，对形式为 $n(r)=2 q \\, \\rho_{1s}(r)$ 且 $q \\in \\{1, \\tfrac{1}{2}\\}$ 的非极化密度，在球坐标中数值计算径向积分，并使用自旋标度和可忽略重叠来组合得到 $E_{x}^{\\mathrm{PBE}}(\\lambda)$。\n- 对所有泛函，将相关能设置为零。\n- 为下面的测试套件计算 $\\Delta(R;\\mathrm{func})$。\n\n所有能量必须以哈特里表示。不需要角度。不使用百分比。\n\n测试套件（每个测试用例是一个元组，指明泛函、间距，以及对于杂化泛函的混合分数 $\\alpha$）：\n1. $($\"LDA\"$, R=6.0, \\alpha=\\text{不适用})$\n2. $($\"PBE\"$, R=6.0, \\alpha=\\text{不适用})$\n3. $($\"HYB\"$, R=6.0, \\alpha=0.25)$\n4. $($\"LDA\"$, R=12.0, \\alpha=\\text{不适用})$\n5. $($\"PBE\"$, R=12.0, \\alpha=\\text{不适用})$\n6. $($\"HYB\"$, R=12.0, \\alpha=0.25)$\n7. $($\"HYB\"$, R=8.0, \\alpha=1.0)$\n\n最终输出格式：\n- 您的程序应生成单行输出，包含七个曲率值，单位为哈特里，每个值四舍五入到八位小数，形式为用方括号括起来的逗号分隔列表。例如，一个语法正确的输出将类似于\n$$\n[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5,\\delta_6,\\delta_7],\n$$\n其中每个 $\\delta_i$ 是一个四舍五入到八位小数的浮点数。\n\n您的程序必须是一个完整的、可运行的脚本，不需要用户输入，也不需要外部文件。它必须实现上述定义，执行必要的积分，并以指定的确切格式输出列表。", "solution": "该问题是有效的，因为它具有科学依据、自洽且定义明确。它描述了密度泛函理论中用于分析离域误差的标准模型。所有必要的物理量、常数和泛函形式都已明确给出，并与现有文献一致。我现在开始推导解决方案。\n\n目标是计算离域误差度量，该度量定义为哈特里-交换能量 $E_{\\mathrm{H}x}$ 相对于电子分配分数 $\\lambda$ 的曲率：\n$$\n\\Delta(R;\\mathrm{func}) = E_{\\mathrm{H}x}(\\lambda=\\tfrac{1}{2};R) - \\frac{1}{2} \\left[ E_{\\mathrm{H}x}(\\lambda=0;R) + E_{\\mathrm{H}x}(\\lambda=1;R) \\right]\n$$\n该体系由一个在两个相同且不重叠的片段之间分配的单电子组成。根据对称性，电子完全在左片段（$\\lambda=1$）上的能量与电子完全在右片段（$\\lambda=0$）上的能量相同。因此，$E_{\\mathrm{H}x}(\\lambda=0;R) = E_{\\mathrm{H}x}(\\lambda=1;R)$。曲率简化为：\n$$\n\\Delta(R;\\mathrm{func}) = E_{\\mathrm{H}x}(\\lambda=\\tfrac{1}{2};R) - E_{\\mathrm{H}x}(\\lambda=1;R)\n$$\n由于相关能设为零，总能量为 $E_{\\mathrm{H}x} = E_{\\mathrm{H}} + E_x$。曲率可以分解为来自哈特里能量和交换能量的贡献：\n$$\n\\Delta(R;\\mathrm{func}) = \\Delta_{\\mathrm{H}}(R) + \\Delta_{x}(\\mathrm{func})\n$$\n其中 $\\Delta_{\\mathrm{H}}(R) = E_{\\mathrm{H}}(\\lambda=\\tfrac{1}{2};R) - E_{\\mathrm{H}}(\\lambda=1;R)$ 且 $\\Delta_{x}(\\mathrm{func}) = E_{x}(\\lambda=\\tfrac{1}{2}) - E_{x}(\\lambda=1)$。请注意，对于所考虑的仅交换泛函，由于可忽略重叠近似，该模型中的交换能量不依赖于间距 $R$。\n\n首先，我们使用提供的 $E_{\\mathrm{H}}(\\lambda;R)$ 表达式来推导哈特里贡献 $\\Delta_{\\mathrm{H}}(R)$：\n$$\nE_{\\mathrm{H}}(\\lambda;R) \\approx \\frac{1}{2} J \\left[\\lambda^2 + (1-\\lambda)^2 \\right] + \\lambda (1-\\lambda) \\, \\frac{1}{R}\n$$\n其中 $J = 5/8$。\n对于 $\\lambda=1$：$E_{\\mathrm{H}}(1;R) = \\frac{1}{2} J [1^2 + 0^2] + 0 = \\frac{1}{2} J$。\n对于 $\\lambda=\\tfrac{1}{2}$：$E_{\\mathrm{H}}(\\tfrac{1}{2};R) = \\frac{1}{2} J [(\\tfrac{1}{2})^2 + (\\tfrac{1}{2})^2] + \\tfrac{1}{2}\\tfrac{1}{2} \\frac{1}{R} = \\frac{1}{4} J + \\frac{1}{4R}$。\n因此，对曲率的哈特里贡献为：\n$$\n\\Delta_{\\mathrm{H}}(R) = \\left(\\frac{1}{4} J + \\frac{1}{4R}\\right) - \\frac{1}{2} J = \\frac{1}{4R} - \\frac{1}{4} J\n$$\n对于精确泛函，$E_x = -E_{\\mathrm{H}}$，这意味着 $E_{\\mathrm{H}x}=0$ 且 $\\Delta^{\\mathrm{exact}}=0$。这要求交换曲率 $\\Delta_x^{\\mathrm{exact}}$ 为 $-\\Delta_{\\mathrm{H}}(R) = \\frac{1}{4} J - \\frac{1}{4R}$。在近似泛函中，任何与此值的偏差都会导致非零的总曲率，这表示存在离域误差。\n\n接下来，我们为每个泛函推导交换贡献 $\\Delta_x$。该体系是完全自旋极化的，其自旋向上密度为 $n_{\\uparrow}(\\mathbf{r}; \\lambda) = \\lambda \\rho_A(\\mathbf{r}) + (1-\\lambda) \\rho_B(\\mathbf{r})$，而 $n_{\\downarrow}(\\mathbf{r})=0$。GGA（包括LDA）的自旋标度由以下公式给出：\n$$\nE_{x}^{\\mathrm{GGA}}[n_{\\uparrow}, n_{\\downarrow}] = \\frac{1}{2} E_{x}^{\\mathrm{GGA,unpol}}[2 n_{\\uparrow}] + \\frac{1}{2} E_{x}^{\\mathrm{GGA,unpol}}[2 n_{\\downarrow}]\n$$\n由于 $n_{\\downarrow}=0$，这简化为 $E_{x}^{\\mathrm{GGA}}(\\lambda) = \\frac{1}{2} E_{x}^{\\mathrm{GGA,unpol}}[2n_{\\uparrow}(\\lambda)]$。密度 $2n_{\\uparrow}(\\lambda) = 2\\lambda\\rho_A + 2(1-\\lambda)\\rho_B$ 是两个不重叠项的和。由于密度非线性的积分被近似为各项贡献之和，我们得到：\n$$\nE_{x}^{\\mathrm{GGA}}(\\lambda) \\approx \\frac{1}{2} \\left( E_{x}^{\\mathrm{GGA,unpol}}[2\\lambda\\rho_{1s}] + E_{x}^{\\mathrm{GGA,unpol}}[2(1-\\lambda)\\rho_{1s}] \\right)\n$$\n我们定义 $\\mathcal{E}_x^{\\mathrm{unpol}}(q) = E_{x}^{\\mathrm{unpol}}[2q\\rho_{1s}]$。那么交换能量为 $E_{x}^{\\mathrm{GGA}}(\\lambda) = \\frac{1}{2} [\\mathcal{E}_x^{\\mathrm{unpol}}(\\lambda) + \\mathcal{E}_x^{\\mathrm{unpol}}(1-\\lambda)]$。\n单个局域电子（$\\lambda=1$）的能量为 $E_{x}^{\\mathrm{GGA}}(1) = \\frac{1}{2}[\\mathcal{E}_x^{\\mathrm{unpol}}(1) + \\mathcal{E}_x^{\\mathrm{unpol}}(0)] = \\frac{1}{2}\\mathcal{E}_x^{\\mathrm{unpol}}(1)$。我们将此量表示为 $E_{x,H}^{\\mathrm{GGA}}$，即一个类氢片段的交换能量。\n在半分配点（$\\lambda=\\tfrac{1}{2}$）的能量是 $E_{x}^{\\mathrm{GGA}}(\\tfrac{1}{2}) = \\frac{1}{2}[\\mathcal{E}_x^{\\mathrm{unpol}}(\\tfrac{1}{2}) + \\mathcal{E}_x^{\\mathrm{unpol}}(\\tfrac{1}{2})] = \\mathcal{E}_x^{\\mathrm{unpol}}(\\tfrac{1}{2})$。\n交换曲率为 $\\Delta_x^{\\mathrm{GGA}} = E_{x}^{\\mathrm{GGA}}(\\tfrac{1}{2}) - E_{x}^{\\mathrm{GGA}}(1) = \\mathcal{E}_x^{\\mathrm{unpol}}(\\tfrac{1}{2}) - \\frac{1}{2}\\mathcal{E}_x^{\\mathrm{unpol}}(1)$。\n\n**局域密度近似（LDA）**\n对于LDA，$\\mathcal{E}_x^{\\mathrm{LDA,unpol}}(q) = -C_x \\int (2q\\rho_{1s})^{4/3} d^3 r = q^{4/3} (-C_x 2^{4/3} \\int \\rho_{1s}^{4/3} d^3 r)$。这表明 $\\mathcal{E}_x^{\\mathrm{LDA,unpol}}(q) = q^{4/3} \\mathcal{E}_x^{\\mathrm{LDA,unpol}}(1)$。\n所以，$E_{x,H}^{\\mathrm{LDA}} = \\frac{1}{2}\\mathcal{E}_x^{\\mathrm{LDA,unpol}}(1)$ 且 $E_{x}^{\\mathrm{LDA}}(\\tfrac{1}{2}) = (\\tfrac{1}{2})^{4/3} \\mathcal{E}_x^{\\mathrm{LDA,unpol}}(1) = (\\tfrac{1}{2})^{4/3} (2 E_{x,H}^{\\mathrm{LDA}}) = 2^{-1/3} E_{x,H}^{\\mathrm{LDA}}$。\n交换曲率为 $\\Delta_x^{\\mathrm{LDA}} = (2^{-1/3} - 1)E_{x,H}^{\\mathrm{LDA}}$。$E_{x,H}^{\\mathrm{LDA}}$ 的值可以通过解析积分 $\\int \\rho_{1s}^{4/3} d^3r = \\frac{27}{64\\pi^{1/3}}$ 计算得出。\n$E_{x,H}^{\\mathrm{LDA}} = \\frac{1}{2} \\left(-C_x 2^{4/3} \\frac{27}{64\\pi^{1/3}}\\right) = -C_x 2^{1/3} \\frac{27}{64\\pi^{1/3}}$。\nLDA的总曲率为 $\\Delta^{\\mathrm{LDA}}(R) = \\frac{1}{4R} - \\frac{J}{4} + (2^{-1/3}-1)E_{x,H}^{\\mathrm{LDA}}$。\n\n**Perdew–Burke–Ernzerhof (PBE) GGA**\n对于PBE，适用相同的逻辑，但 $\\mathcal{E}_x^{\\mathrm{PBE,unpol}}(q)$ 的积分必须对 $q=1$ 和 $q=\\frac{1}{2}$ 进行数值计算。\n$\\mathcal{E}_x^{\\mathrm{PBE,unpol}}(q) = -C_x \\int (2q\\rho_{1s})^{4/3} F_x(s) d^3r$，其中 $s(\\mathbf{r}) = (3\\pi^2 n(\\mathbf{r}))^{-1/3}$ 且 $n=2q\\rho_{1s}$。\n我们通过数值积分计算 $E_{x,H}^{\\mathrm{PBE}} = \\frac{1}{2}\\mathcal{E}_x^{\\mathrm{PBE,unpol}}(1)$ 和 $E_{x}^{\\mathrm{PBE}}(\\tfrac{1}{2}) = \\mathcal{E}_x^{\\mathrm{PBE,unpol}}(\\tfrac{1}{2})$。交换曲率则为 $\\Delta_x^{\\mathrm{PBE}} = E_{x}^{\\mathrm{PBE}}(\\tfrac{1}{2}) - E_{x,H}^{\\mathrm{PBE}}$。\n总曲率为 $\\Delta^{\\mathrm{PBE}}(R) = \\frac{1}{4R} - \\frac{J}{4} + \\Delta_x^{\\mathrm{PBE}}$。\n\n**杂化泛函（HYB）**\n杂化泛函的能量为 $E_{x}^{\\mathrm{hyb}} = \\alpha E_x^{\\mathrm{EXX}} + (1-\\alpha)E_x^{\\mathrm{PBE}}$。对于单电子体系，$E_x^{\\mathrm{EXX}} = -E_{\\mathrm{H}}$。\n总哈特里-交换能量为：\n$E_{\\mathrm{H}x}^{\\mathrm{hyb}}(\\lambda) = E_{\\mathrm{H}}(\\lambda) + \\alpha(-E_{\\mathrm{H}}(\\lambda)) + (1-\\alpha)E_x^{\\mathrm{PBE}}(\\lambda) = (1-\\alpha)(E_{\\mathrm{H}}(\\lambda) + E_x^{\\mathrm{PBE}}(\\lambda))$。\n这意味着 $E_{\\mathrm{H}x}^{\\mathrm{hyb}}(\\lambda) = (1-\\alpha)E_{\\mathrm{H}x}^{\\mathrm{PBE}}(\\lambda)$。\n因此，曲率是线性缩放的：\n$$\n\\Delta^{\\mathrm{hyb}}(R;\\alpha) = (1-\\alpha)\\Delta^{\\mathrm{PBE}}(R)\n$$\n当 $\\alpha=1$ 时，对于这个单电子问题，该泛函是精确的，曲率为 $\\Delta = 0$。\n\n以下程序实现了这些推导出的表达式，以计算所需的值。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the DFT delocalization error problem for a stretched H2+ model.\n    \"\"\"\n    \n    # Define physical and functional constants in atomic units (Hartree)\n    J_HARTREE = 5.0 / 8.0  # Coulomb self-interaction of a 1s density\n    C_X = 0.75 * (3.0 / np.pi)**(1.0 / 3.0)  # LDA exchange constant\n    KAPPA_PBE = 0.804  # PBE exchange parameter\n    MU_PBE = 0.21951   # PBE exchange parameter\n\n    # Cache for computationally expensive and reusable results\n    calculation_cache = {}\n\n    def get_delta_lda(R):\n        \"\"\"Calculates the delocalization error for LDA at separation R.\"\"\"\n        # The calculation is analytic, so we compute constants once and cache them.\n        if \"delta_x_lda\" in calculation_cache:\n            delta_x_lda = calculation_cache[\"delta_x_lda\"]\n        else:\n            # Exchange energy for a single H atom within LDA:\n            # E_x,H^LDA = -C_x * 2^(1/3) * integral(rho_1s^(4/3) dV)\n            # The integral is analytically known to be 27 / (64 * pi^(1/3))\n            integral_rho43 = 27.0 / (64.0 * np.pi**(1.0 / 3.0))\n            e_xh_lda = -C_X * 2.0**(1.0 / 3.0) * integral_rho43\n            \n            # Curvature of the exchange energy component\n            delta_x_lda = (2.0**(-1.0 / 3.0) - 1.0) * e_xh_lda\n            calculation_cache[\"delta_x_lda\"] = delta_x_lda\n\n        # Curvature of the Hartree energy component\n        delta_h = 1.0 / (4.0 * R) - J_HARTREE / 4.0\n        return delta_h + delta_x_lda\n\n    def pbe_enhancement_factor(s):\n        \"\"\"Standard PBE exchange enhancement factor F_x(s).\"\"\"\n        return 1.0 + KAPPA_PBE - KAPPA_PBE / (1.0 + MU_PBE * s**2 / KAPPA_PBE)\n\n    def pbe_unpol_integrand(r, q):\n        \"\"\"\n        Integrand for the PBE unpolarized exchange energy for a scaled density n=2*q*rho_1s.\n        The integral is over r from 0 to infinity.\n        \"\"\"\n        # Hydrogenic 1s density\n        rho_1s = (1.0 / np.pi) * np.exp(-2.0 * r)\n        # Unpolarized density for the integral\n        n_unpol = 2.0 * q * rho_1s\n\n        # For very large r, density is numerically zero, so integrand is zero.\n        if n_unpol  1e-150:\n            return 0.0\n\n        # Reduced gradient s(r) = (3*pi^2*n(r))^(-1/3) as per problem statement\n        s_val = (3.0 * np.pi**2 * n_unpol)**(-1.0 / 3.0)\n        \n        # PBE enhancement factor F_x(s)\n        fx = pbe_enhancement_factor(s_val)\n        \n        # Full integrand: e_x,unpol(n) * 4*pi*r^2 = -C_x * n^(4/3) * F_x(s) * (4*pi*r^2)\n        return -C_X * n_unpol**(4.0 / 3.0) * fx * 4.0 * np.pi * r**2\n\n    def get_epbe_unpol(q):\n        \"\"\"\n        Computes the PBE unpolarized exchange energy, E_x,unpol[2*q*rho_1s],\n        by numerical integration.\n        \"\"\"\n        if q in calculation_cache:\n            return calculation_cache[q]\n        \n        # Use SciPy's quad for numerical integration from r=0 to infinity\n        result, _ = quad(pbe_unpol_integrand, 0, np.inf, args=(q,))\n        calculation_cache[q] = result\n        return result\n\n    def get_delta_pbe(R):\n        \"\"\"Calculates the delocalization error for PBE at separation R.\"\"\"\n        if f\"delta_x_pbe_{R}\" in calculation_cache:\n            return calculation_cache[f\"delta_x_pbe_{R}\"]\n        \n        if \"delta_x_pbe_const\" in calculation_cache:\n            delta_x_pbe_const = calculation_cache[\"delta_x_pbe_const\"]\n        else:\n            # E_x for H atom: E_x,H^PBE = (1/2) * E_x,unpol^PBE[2*rho_1s]\n            # This corresponds to q=1 for the unpolarized density 2*q*rho_1s\n            e_xh_pbe = 0.5 * get_epbe_unpol(1.0)\n\n            # E_x at lambda=1/2: E_x^PBE(1/2) = E_x,unpol^PBE[rho_1s]\n            # This corresponds to q=1/2 for the unpolarized density 2*q*rho_1s\n            e_x_half_pbe = get_epbe_unpol(0.5)\n            \n            delta_x_pbe_const = e_x_half_pbe - e_xh_pbe\n            calculation_cache[\"delta_x_pbe_const\"] = delta_x_pbe_const\n\n        # Curvature of the Hartree component\n        delta_h = 1.0 / (4.0 * R) - J_HARTREE / 4.0\n        result = delta_h + delta_x_pbe_const\n        calculation_cache[f\"delta_x_pbe_{R}\"] = result\n        return result\n\n    def get_delta_hyb(R, alpha):\n        \"\"\"Calculates the delocalization error for a global hybrid functional.\"\"\"\n        # For alpha=1 (exact exchange), error is zero for this 1-electron system.\n        if alpha == 1.0:\n            return 0.0\n        # Otherwise, the error scales linearly with (1-alpha)\n        delta_pbe = get_delta_pbe(R)\n        return (1.0 - alpha) * delta_pbe\n\n    # Test suite from the problem description\n    test_cases = [\n        (\"LDA\", 6.0, None),\n        (\"PBE\", 6.0, None),\n        (\"HYB\", 6.0, 0.25),\n        (\"LDA\", 12.0, None),\n        (\"PBE\", 12.0, None),\n        (\"HYB\", 12.0, 0.25),\n        (\"HYB\", 8.0, 1.0),\n    ]\n\n    results = []\n    for func, R, alpha in test_cases:\n        if func == \"LDA\":\n            delta = get_delta_lda(R)\n        elif func == \"PBE\":\n            delta = get_delta_pbe(R)\n        elif func == \"HYB\":\n            delta = get_delta_hyb(R, alpha)\n        results.append(round(delta, 8))\n    \n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2821091"}, {"introduction": "当DFT计算结果与实验值不符时，理解误差的来源至关重要。本练习介绍了一种强大的分析技术，它能将计算性质（此处为电子亲和能）的总误差分解为“泛函驱动”和“密度驱动”两个部分[@problem_id:2821151]。前者源于近似泛函公式本身的不精确，而后者则是因为该泛函产生了有缺陷的电子密度。掌握这种分解方法是成为高级DFT用户的关键一步，它能帮助您批判性地评估计算结果的可靠性。", "problem": "使用第一性原理定义，在密度泛函理论中，针对一个固定的原子体系，计算并分析多种交换相关近似下的电子亲和能。从以下基本依据出发：(i) Hohenberg–Kohn 定理断言，基态电子密度与所有基态可观测量之间存在一一对应关系；(ii) 在 Kohn–Sham 密度泛函理论 (Kohn–Sham DFT) 中，总基态能量是电子密度的泛函，记作 $E[n]$；(iii) 电子亲和能定义为中性体系与其阴离子之间的基态能量差。将含有 $N$ 个电子的中性氯原子记作 $\\mathrm{Cl}$，含有 $N+1$ 个电子的氯阴离子记作 $\\mathrm{Cl}^{-}$。精确的电子亲和能由下式给出\n$$\n\\mathrm{EA}_{\\mathrm{ref}} \\equiv E_{\\mathrm{ref}}(N) - E_{\\mathrm{ref}}(N+1),\n$$\n其中 $E_{\\mathrm{ref}}$ 表示对应电子数的参考总能量（例如，来自高精度方法）。\n\n在近似的交换相关泛函设定下，将近似能量泛函记作 $E_{\\mathrm{approx}}[n]$。该泛函的自洽（变分）密度 $n_{\\mathrm{scf}}$ 使 $E_{\\mathrm{approx}}[n]$ 最小化，从而得到自洽能量 $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)]$ 和 $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)]$。非自洽能量评估 $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}]$ 使用一个固定的、高质量的参考密度 $n_{\\mathrm{ref}}$，而不是变分密度。定义相应的电子亲和能\n$$\n\\mathrm{EA}_{\\mathrm{scf}} \\equiv E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)],\n\\quad\n\\mathrm{EA}_{\\mathrm{nscf}} \\equiv E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N+1)].\n$$\n\n将总电子亲和能误差、泛函驱动分量和密度驱动分量定义为\n$$\n\\Delta \\mathrm{EA}_{\\mathrm{total}} \\equiv \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{ref}},\n\\quad\n\\Delta \\mathrm{EA}_{\\mathrm{func}} \\equiv \\mathrm{EA}_{\\mathrm{nscf}} - \\mathrm{EA}_{\\mathrm{ref}},\n\\quad\n\\Delta \\mathrm{EA}_{\\mathrm{den}} \\equiv \\Delta \\mathrm{EA}_{\\mathrm{total}} - \\Delta \\mathrm{EA}_{\\mathrm{func}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{nscf}}.\n$$\n使用以下判据：当且仅当 $|\\Delta \\mathrm{EA}_{\\mathrm{den}}|  |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$ 时，电子亲和能误差是密度驱动的。\n\n实现一个程序，在给定三种交换相关近似——局域密度近似 (LDA)、Perdew–Burke–Ernzerhof 广义梯度近似 (PBE) 和强约束和适当范数化元广义梯度近似 (SCAN)——下中性和阴离子态的自洽与非自洽总能量后，为氯阴离子计算上述各量，并对主要误差来源进行分类。\n\n所有能量均以电子伏特 (eV) 为单位。所有输出均以电子伏特 (eV) 表示，并四舍五入到三位小数。不涉及角度。您的程序不得读取任何输入，必须使用下述固定的测试套件。\n\n测试套件数据（所有能量单位均为电子伏特）：\n- 参考能量：$E_{\\mathrm{ref}}(N) = -1250.000$, $E_{\\mathrm{ref}}(N+1) = -1253.613$，因此 $\\mathrm{EA}_{\\mathrm{ref}} = 3.613$。\n- LDA:\n  - 自洽能量：$E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1248.600$, $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1251.000$。\n  - 非自洽（参考密度）能量：$E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1248.700$, $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1252.200$。\n- PBE:\n  - 自洽能量：$E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1249.500$, $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1252.500$。\n  - 非自洽（参考密度）能量：$E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1249.600$, $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1252.880$。\n- SCAN:\n  - 自洽能量：$E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1249.800$, $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1253.390$。\n  - 非自洽（参考密度）能量：$E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1249.820$, $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1253.420$。\n\n需要实现的任务：\n1. 对每种泛函 (LDA, PBE, SCAN)，计算 $\\mathrm{EA}_{\\mathrm{scf}}$, $\\mathrm{EA}_{\\mathrm{nscf}}$, $\\Delta \\mathrm{EA}_{\\mathrm{total}}$, $\\Delta \\mathrm{EA}_{\\mathrm{func}}$ 和 $\\Delta \\mathrm{EA}_{\\mathrm{den}}$，单位为 eV，均四舍五入到三位小数。\n2. 使用严格不等式 $|\\Delta \\mathrm{EA}_{\\mathrm{den}}|  |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$ 判断电子亲和能误差是否为密度驱动；为此分类输出一个布尔值。\n\n最终输出格式：\n生成单行输出，其中包含一个按 $[\\mathrm{LDA}, \\mathrm{PBE}, \\mathrm{SCAN}]$ 顺序排列的、含三个子列表的列表。每个子列表必须是\n$\n[\\mathrm{EA}_{\\mathrm{scf}},\\ \\mathrm{EA}_{\\mathrm{nscf}},\\ \\Delta \\mathrm{EA}_{\\mathrm{total}},\\ \\Delta \\mathrm{EA}_{\\mathrm{func}},\\ \\Delta \\mathrm{EA}_{\\mathrm{den}},\\ \\text{density\\_driven}],\n$\n其中前五个条目是单位为 eV 并四舍五入到三位小数的浮点数，最后一个条目是如上定义的布尔值。例如，输出可能如下所示\n$\n[[x_1,x_2,x_3,x_4,x_5,\\mathrm{True}],[\\dots],[\\dots]].\n$", "solution": "该问题要求在密度泛函理论框架内，使用三种不同的交换相关泛函，计算并分析氯原子的电子亲和能。该分析涉及将电子亲和能的总误差分解为可归因于泛函近似和所产生的电子密度的分量。\n\n提供的基本定义如下。参考电子亲和能为\n$$\n\\mathrm{EA}_{\\mathrm{ref}} = E_{\\mathrm{ref}}(N) - E_{\\mathrm{ref}}(N+1)\n$$\n其中 $E_{\\mathrm{ref}}(M)$ 是含有 $M$ 个电子的体系的精确总基态能量。中性氯原子 $\\mathrm{Cl}$ 的电子数为 $N$。\n\n对于一个近似泛函，定义了两种亲和能：\n1.  自洽电子亲和能 $\\mathrm{EA}_{\\mathrm{scf}}$ 是根据给定近似泛函下，通过对密度进行变分最小化得到的总能量计算的：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf}} = E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)]\n    $$\n2.  非自洽电子亲和能 $\\mathrm{EA}_{\\mathrm{nscf}}$ 是通过在固定的高质量参考密度 $n_{\\mathrm{ref}}$ 上评估近似能量泛函计算的：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf}} = E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N+1)]\n    $$\n\n误差分量定义如下：\n-   总误差：$\\Delta \\mathrm{EA}_{\\mathrm{total}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{ref}}$\n-   泛函驱动误差：$\\Delta \\mathrm{EA}_{\\mathrm{func}} = \\mathrm{EA}_{\\mathrm{nscf}} - \\mathrm{EA}_{\\mathrm{ref}}$\n-   密度驱动误差：$\\Delta \\mathrm{EA}_{\\mathrm{den}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{nscf}}$\n\n根据这些定义，可以得出 $\\Delta \\mathrm{EA}_{\\mathrm{total}} = \\Delta \\mathrm{EA}_{\\mathrm{func}} + \\Delta \\mathrm{EA}_{\\mathrm{den}}$。如果密度驱动误差的绝对值超过泛函驱动误差的绝对值，即 $|\\Delta \\mathrm{EA}_{\\mathrm{den}}|  |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$，则该误差被归类为密度驱动的。\n\n我们得到了以下以电子伏特 ($\\mathrm{eV}$) 为单位的能量值：\n-   参考能量：$E_{\\mathrm{ref}}(N) = -1250.000\\ \\mathrm{eV}$，$E_{\\mathrm{ref}}(N+1) = -1253.613\\ \\mathrm{eV}$。\n-   LDA 能量：$E_{\\mathrm{scf}}(N) = -1248.600$, $E_{\\mathrm{scf}}(N+1) = -1251.000$；$E_{\\mathrm{nscf}}(N) = -1248.700$, $E_{\\mathrm{nscf}}(N+1) = -1252.200$。\n-   PBE 能量：$E_{\\mathrm{scf}}(N) = -1249.500$, $E_{\\mathrm{scf}}(N+1) = -1252.500$；$E_{\\mathrm{nscf}}(N) = -1249.600$, $E_{\\mathrm{nscf}}(N+1) = -1252.880$。\n-   SCAN 能量：$E_{\\mathrm{scf}}(N) = -1249.800$, $E_{\\mathrm{scf}}(N+1) = -1253.390$；$E_{\\mathrm{nscf}}(N) = -1249.820$, $E_{\\mathrm{nscf}}(N+1) = -1253.420$。\n\n首先，我们计算参考电子亲和能：\n$$\n\\mathrm{EA}_{\\mathrm{ref}} = (-1250.000\\ \\mathrm{eV}) - (-1253.613\\ \\mathrm{eV}) = 3.613\\ \\mathrm{eV}\n$$\n\n现在，我们对每种泛函进行分析。\n\n**1. 局域密度近似 (LDA)**\n-   自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, LDA}} = (-1248.600\\ \\mathrm{eV}) - (-1251.000\\ \\mathrm{eV}) = 2.400\\ \\mathrm{eV}\n    $$\n-   非自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, LDA}} = (-1248.700\\ \\mathrm{eV}) - (-1252.200\\ \\mathrm{eV}) = 3.500\\ \\mathrm{eV}\n    $$\n-   误差分量：\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, LDA}} = 2.400 - 3.613 = -1.213\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, LDA}} = 3.500 - 3.613 = -0.113\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, LDA}} = 2.400 - 3.500 = -1.100\\ \\mathrm{eV}\n    $$\n-   分类：我们比较 $|\\Delta \\mathrm{EA}_{\\mathrm{den, LDA}}| = |-1.100| = 1.100$ 和 $|\\Delta \\mathrm{EA}_{\\mathrm{func, LDA}}| = |-0.113| = 0.113$。由于 $1.100  0.113$，LDA 的误差是**密度驱动**的。\n\n**2. Perdew–Burke–Ernzerhof (PBE) 广义梯度近似 (GGA)**\n-   自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, PBE}} = (-1249.500\\ \\mathrm{eV}) - (-1252.500\\ \\mathrm{eV}) = 3.000\\ \\mathrm{eV}\n    $$\n-   非自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, PBE}} = (-1249.600\\ \\mathrm{eV}) - (-1252.880\\ \\mathrm{eV}) = 3.280\\ \\mathrm{eV}\n    $$\n-   误差分量：\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, PBE}} = 3.000 - 3.613 = -0.613\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, PBE}} = 3.280 - 3.613 = -0.333\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, PBE}} = 3.000 - 3.280 = -0.280\\ \\mathrm{eV}\n    $$\n-   分类：我们比较 $|\\Delta \\mathrm{EA}_{\\mathrm{den, PBE}}| = |-0.280| = 0.280$ 和 $|\\Delta \\mathrm{EA}_{\\mathrm{func, PBE}}| = |-0.333| = 0.333$。由于 $0.280 \\ngtr 0.333$，PBE 的误差**不是**密度驱动的；它是泛函驱动的。\n\n**3. 强约束和适当范数化 (SCAN) 元-GGA**\n-   自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, SCAN}} = (-1249.800\\ \\mathrm{eV}) - (-1253.390\\ \\mathrm{eV}) = 3.590\\ \\mathrm{eV}\n    $$\n-   非自洽电子亲和能：\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, SCAN}} = (-1249.820\\ \\mathrm{eV}) - (-1253.420\\ \\mathrm{eV}) = 3.600\\ \\mathrm{eV}\n    $$\n-   误差分量：\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, SCAN}} = 3.590 - 3.613 = -0.023\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, SCAN}} = 3.600 - 3.613 = -0.013\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, SCAN}} = 3.590 - 3.600 = -0.010\\ \\mathrm{eV}\n    $$\n-   分类：我们比较 $|\\Delta \\mathrm{EA}_{\\mathrm{den, SCAN}}| = |-0.010| = 0.010$ 和 $|\\Delta \\mathrm{EA}_{\\mathrm{func, SCAN}}| = |-0.013| = 0.013$。由于 $0.010 \\ngtr 0.013$，SCAN 的误差**不是**密度驱动的；它是泛函驱动的。\n\n以下程序实现了这些计算，并按指定格式提供输出。结果必须四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron affinities and error components for different DFT functionals.\n    \"\"\"\n    # Reference energies in eV.\n    E_ref_N = -1250.000\n    E_ref_N1 = -1253.613\n\n    # Test suite data: (name, E_scf(N), E_scf(N+1), E_nscf(N), E_nscf(N+1))\n    test_cases = [\n        (\"LDA\", -1248.600, -1251.000, -1248.700, -1252.200),\n        (\"PBE\", -1249.500, -1252.500, -1249.600, -1252.880),\n        (\"SCAN\", -1249.800, -1253.390, -1249.820, -1253.420),\n    ]\n\n    # Calculate the reference electron affinity.\n    EA_ref = E_ref_N - E_ref_N1\n\n    all_results = []\n    for name, e_scf_n, e_scf_n1, e_nscf_n, e_nscf_n1 in test_cases:\n        # Calculate self-consistent and non-self-consistent electron affinities.\n        EA_scf = e_scf_n - e_scf_n1\n        EA_nscf = e_nscf_n - e_nscf_n1\n\n        # Calculate the error components.\n        Delta_EA_total = EA_scf - EA_ref\n        Delta_EA_func = EA_nscf - EA_ref\n        Delta_EA_den = EA_scf - EA_nscf\n\n        # Classify the error source.\n        is_density_driven = abs(Delta_EA_den) > abs(Delta_EA_func)\n\n        # Store the results for this functional.\n        sublist = [\n            EA_scf,\n            EA_nscf,\n            Delta_EA_total,\n            Delta_EA_func,\n            Delta_EA_den,\n            is_density_driven\n        ]\n        all_results.append(sublist)\n\n    # Format the final output string to match the problem specification exactly.\n    # The format is a list of lists, with no spaces and floats formatted to 3 decimal places.\n    sublist_strs = []\n    for sublist in all_results:\n        item_strs = []\n        # First 5 elements are floats and must be formatted to 3 decimal places.\n        for i in range(5):\n            item_strs.append(f\"{sublist[i]:.3f}\")\n        # The last element is a boolean.\n        item_strs.append(str(sublist[5]))\n        \n        sublist_strs.append(f\"[{','.join(item_strs)}]\")\n    \n    final_output_str = f\"[{','.join(sublist_strs)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "2821151"}]}