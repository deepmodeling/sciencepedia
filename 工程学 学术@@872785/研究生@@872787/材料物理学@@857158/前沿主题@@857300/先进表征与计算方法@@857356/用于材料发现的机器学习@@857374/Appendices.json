{"hands_on_practices": [{"introduction": "在机器学习模型能够从材料数据中学习之前，我们必须将每种材料的原子结构转化为一种数值“指纹”，即所谓的描述符（descriptor）。库仑矩阵是这类描述符的一个基础范例，它基于基本的静电学原理，将系统的几何结构和元素构成编码为机器学习算法可以处理的输入特征。通过这项实践，您将亲手构建一个经典且直观的材料表征，从而深入理解如何将物理信息转化为机器学习模型能够识别的语言。[@problem_id:2837947]", "problem": "在用于材料发现的机器学习中，库仑矩阵是一种广泛使用的表示方法，它将原子核之间的成对库仑相互作用编码为预测模型的特征。考虑一个中性双原子体系，其原子序数分别为 $Z_{1}$ 和 $Z_{2}$，两个原子核相距为 $d$。在原子单位下进行计算，因此库仑常数为1。采用常规的库仑矩阵约定，其中非对角元素由成对库仑相互作用给出，对角元素则设为一个与核电荷的幂成正比的经验自能正则化项，具体为 $C_{ii}=c\\,Z_{i}^{\\alpha}$，其中 $c=\\tfrac{1}{2}$ 且 $\\alpha=2.4$。从成对库仑相互作用能的定义和标准线性代数出发，推导该体系的 $2\\times 2$ 库仑矩阵，计算其特征值，并按降序排列以获得排序后的特征值谱。然后，基于第一性原理，评论当 $d\\to\\infty$ 时这些排序后的特征值的极限行为。\n\n将最终排序后的特征值谱以一个关于 $Z_{1}$、$Z_{2}$ 和 $d$ 的单一解析表达式的形式提供，使用 $\\texttt{pmatrix}$ 环境写成一行。提供精确表达式，不要四舍五入。由于计算是在原子单位下进行的，因此无需报告物理单位。", "solution": "首先对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n- 体系：一个中性双原子体系。\n- 原子核：由原子序数 $Z_{1}$ 和 $Z_{2}$ 表征。\n- 核间距：距离 $d$。\n- 物理单位：原子单位，其中库仑常数为 $1$。\n- 库仑矩阵 ($C$)：一个 $2 \\times 2$ 的矩阵表示。\n- 非对角元素 ($C_{ij}$, $i \\neq j$)：由成对库仑相互作用 $\\frac{Z_i Z_j}{R_{ij}}$ 定义。\n- 对角元素 ($C_{ii}$): 由经验自能正则化项 $C_{ii} = c\\,Z_{i}^{\\alpha}$ 定义。\n- 正则化项常数：$c = \\frac{1}{2}$ 且 $\\alpha = 2.4$。\n- 任务：\n  1. 推导 $2 \\times 2$ 的库仑矩阵 $C$。\n  2. 计算其特征值。\n  3. 将特征值按降序排列。\n  4. 分析当 $d \\to \\infty$ 时排序后的特征值的极限行为。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于计算化学和材料科学。库仑矩阵是一种已知的、尽管是简化的描述符，用于机器学习模型中预测分子性质。矩阵元素的形式基于基础静电学（非对角项）和经验建模（对角项），这是该领域的常见做法。该问题不违反任何科学定律。\n- **适定性**：该问题提供了构建矩阵和计算其特征值所需的所有必要定义和常数。指令清晰，任务导向一个唯一的数学解。\n- **客观性**：该问题使用精确、客观的技术语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n该问题是有效的。它在科学上是合理的、适定的、客观的，并且与材料物理和机器学习的特定领域直接相关。现在将推导完整的解决方案。\n\n双原子体系的库仑矩阵是一个 $2 \\times 2$ 矩阵，我们记为 $C$。下标 $1$ 和 $2$ 对应于这两个原子。\n\n对角元素 $C_{11}$ 和 $C_{22}$ 由自能正则化项公式 $C_{ii} = c Z_{i}^{\\alpha}$ 给出。当 $c = \\frac{1}{2}$ 且 $\\alpha = 2.4$ 时，我们有：\n$$\nC_{11} = \\frac{1}{2} Z_{1}^{2.4}\n$$\n$$\nC_{22} = \\frac{1}{2} Z_{2}^{2.4}\n$$\n非对角元素 $C_{12}$ 和 $C_{21}$ 表示两个原子核之间的成对库仑相互作用能。在原子单位下，对于相距为 $d$ 的两个点电荷 $Z_1$ 和 $Z_2$，该能量为 $\\frac{Z_1 Z_2}{d}$。该矩阵是对称的，因此 $C_{12} = C_{21}$。\n$$\nC_{12} = C_{21} = \\frac{Z_{1} Z_{2}}{d}\n$$\n因此，该双原子体系的库仑矩阵为：\n$$\nC = \\begin{pmatrix} \\frac{1}{2} Z_{1}^{2.4}  \\frac{Z_{1} Z_{2}}{d} \\\\ \\frac{Z_{1} Z_{2}}{d}  \\frac{1}{2} Z_{2}^{2.4} \\end{pmatrix}\n$$\n为了求特征值 $\\lambda$，我们求解特征方程 $\\det(C - \\lambda I) = 0$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det \\begin{pmatrix} \\frac{1}{2} Z_{1}^{2.4} - \\lambda  \\frac{Z_{1} Z_{2}}{d} \\\\ \\frac{Z_{1} Z_{2}}{d}  \\frac{1}{2} Z_{2}^{2.4} - \\lambda \\end{pmatrix} = 0\n$$\n这得到一个二次方程：\n$$\n\\left( \\frac{1}{2} Z_{1}^{2.4} - \\lambda \\right) \\left( \\frac{1}{2} Z_{2}^{2.4} - \\lambda \\right) - \\left( \\frac{Z_{1} Z_{2}}{d} \\right)^2 = 0\n$$\n对于一个一般的 $2 \\times 2$ 对称矩阵 $M = \\begin{pmatrix} a  b \\\\ b  c \\end{pmatrix}$，其特征值由以下公式给出：\n$$\n\\lambda_{\\pm} = \\frac{a+c}{2} \\pm \\sqrt{\\left(\\frac{a-c}{2}\\right)^2 + b^2}\n$$\n在我们的例子中，我们进行替换：\n$a = C_{11} = \\frac{1}{2} Z_{1}^{2.4}$\n$c = C_{22} = \\frac{1}{2} Z_{2}^{2.4}$\n$b = C_{12} = \\frac{Z_{1} Z_{2}}{d}$\n\n首先，我们计算特征值公式中的各项：\n对角元素的平均值：\n$$\n\\frac{a+c}{2} = \\frac{1}{2} \\left( \\frac{1}{2} Z_{1}^{2.4} + \\frac{1}{2} Z_{2}^{2.4} \\right) = \\frac{1}{4} \\left( Z_{1}^{2.4} + Z_{2}^{2.4} \\right)\n$$\n对角元素差的一半：\n$$\n\\frac{a-c}{2} = \\frac{1}{2} \\left( \\frac{1}{2} Z_{1}^{2.4} - \\frac{1}{2} Z_{2}^{2.4} \\right) = \\frac{1}{4} \\left( Z_{1}^{2.4} - Z_{2}^{2.4} \\right)\n$$\n将这些代入特征值公式：\n$$\n\\lambda_{\\pm} = \\frac{1}{4} \\left( Z_{1}^{2.4} + Z_{2}^{2.4} \\right) \\pm \\sqrt{\\left(\\frac{Z_{1}^{2.4} - Z_{2}^{2.4}}{4}\\right)^2 + \\left(\\frac{Z_{1} Z_{2}}{d}\\right)^2}\n$$\n化简平方根下的项：\n$$\n\\lambda_{\\pm} = \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} \\pm \\sqrt{\\frac{\\left(Z_{1}^{2.4} - Z_{2}^{2.4}\\right)^2}{16} + \\frac{Z_{1}^{2} Z_{2}^{2}}{d^2}}\n$$\n问题要求将特征值按降序排列。由于平方根项始终为非负数，带有加号的特征值 $\\lambda_{+}$ 总是大于或等于带有减号的特征值 $\\lambda_{-}$。我们将排序后的特征值记为 $\\lambda_1$ 和 $\\lambda_2$，其中 $\\lambda_1 \\ge \\lambda_2$。\n$$\n\\lambda_{1} = \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} + \\sqrt{\\frac{\\left(Z_{1}^{2.4} - Z_{2}^{2.4}\\right)^2}{16} + \\frac{Z_{1}^{2} Z_{2}^{2}}{d^2}}\n$$\n$$\n\\lambda_{2} = \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} - \\sqrt{\\frac{\\left(Z_{1}^{2.4} - Z_{2}^{2.4}\\right)^2}{16} + \\frac{Z_{1}^{2} Z_{2}^{2}}{d^2}}\n$$\n这就给出了排序后的特征值谱。\n\n最后，我们评论当核间距 $d \\to \\infty$ 时的极限行为。在此极限下，表示原子核之间相互作用的项消失了：\n$$\n\\lim_{d\\to\\infty} \\frac{Z_{1}^{2} Z_{2}^{2}}{d^2} = 0\n$$\n特征值变为：\n$$\n\\lim_{d\\to\\infty} \\lambda_{\\pm} = \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} \\pm \\sqrt{\\frac{\\left(Z_{1}^{2.4} - Z_{2}^{2.4}\\right)^2}{16}}\n$$\n$$\n\\lim_{d\\to\\infty} \\lambda_{\\pm} = \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} \\pm \\frac{|Z_{1}^{2.4} - Z_{2}^{2.4}|}{4}\n$$\n不失一般性，假设 $Z_1 \\ge Z_2$。那么 $Z_{1}^{2.4} \\ge Z_{2}^{2.4}$，所以 $|Z_{1}^{2.4} - Z_{2}^{2.4}| = Z_{1}^{2.4} - Z_{2}^{2.4}$。排序后的特征值的极限为：\n$$\n\\lambda_1 \\to \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} + \\frac{Z_{1}^{2.4} - Z_{2}^{2.4}}{4} = \\frac{2 Z_{1}^{2.4}}{4} = \\frac{1}{2} Z_{1}^{2.4}\n$$\n$$\n\\lambda_2 \\to \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} - \\frac{Z_{1}^{2.4} - Z_{2}^{2.4}}{4} = \\frac{2 Z_{2}^{2.4}}{4} = \\frac{1}{2} Z_{2}^{2.4}\n$$\n从物理上看，当 $d \\to \\infty$ 时，库仑矩阵变为对角矩阵，因为非对角的相互作用项趋于零：\n$$\n\\lim_{d\\to\\infty} C = \\begin{pmatrix} \\frac{1}{2} Z_{1}^{2.4}  0 \\\\ 0  \\frac{1}{2} Z_{2}^{2.4} \\end{pmatrix}\n$$\n对角矩阵的特征值就是其对角线上的元素。因此，在无限分离的极限下，体系解离成两个不相互作用的原子，库仑矩阵的特征值正确地约化为单个原子的自能项 $C_{11}$ 和 $C_{22}$。这证实了该表示方法的物理一致性。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} + \\sqrt{\\frac{\\left(Z_{1}^{2.4} - Z_{2}^{2.4}\\right)^{2}}{16} + \\frac{Z_{1}^{2} Z_{2}^{2}}{d^{2}}}  \\frac{Z_{1}^{2.4} + Z_{2}^{2.4}}{4} - \\sqrt{\\frac{\\left(Z_{1}^{2.4} - Z_{2}^{2.4}\\right)^{2}}{16} + \\frac{Z_{1}^{2} Z_{2}^{2}}{d^{2}}} \\end{pmatrix}}\n$$", "id": "2837947"}, {"introduction": "材料发现的一个核心目标是预测一个假想的化合物是否是热力学稳定的。机器学习模型可以预测生成能，但这些预测值必须在严格的热力学框架内进行解释，以判断其稳定性。生成能的凸包（convex hull）正是提供了这样一个框架，它定义了在任意给定组分下的基态能量。本练习将指导您计算“距凸包距离”（hull distance），这是一个量化化合物稳定性的关键指标，从而将机器学习的预测与可实验验证的热力学原理联系起来。[@problem_id:2837952]", "problem": "在用于材料发现的机器学习（ML）热力学稳定性筛选的背景下，形成能关于组分的下凸包编码了在近零温度下的一组热力学稳定相，此时相关的热力学势简化为内能，并且在固定组分 $\\mathbf{x} = (x_A, x_B, x_C)$ 下的稳定混合物在所有可用相的凸组合中能量最低。考虑一个三元 $A$–$B$–$C$ 体系，其组分由满足 $x_A + x_B + x_C = 1$ 的重心坐标 $(x_A, x_B, x_C)$ 参数化。给定一组候选相及其每原子的形成能（单位为电子伏特/原子），这些数据来自高保真度来源，如密度泛函理论（DFT）或精准校准的代理模型：\n\n- 纯 $A$：$\\mathbf{x}_A = (1, 0, 0)$，能量 $E_A = 0$。\n- 纯 $B$：$\\mathbf{x}_B = (0, 1, 0)$，能量 $E_B = 0$。\n- 纯 $C$：$\\mathbf{x}_C = (0, 0, 1)$，能量 $E_C = 0$。\n- 二元 $AB$：$\\mathbf{x}_{AB} = \\left(\\frac{1}{2}, \\frac{1}{2}, 0\\right)$，能量 $E_{AB} = -0.40$。\n- 二元 $AC$：$\\mathbf{x}_{AC} = \\left(\\frac{1}{2}, 0, \\frac{1}{2}\\right)$，能量 $E_{AC} = -0.30$。\n- 二元 $BC$：$\\mathbf{x}_{BC} = \\left(0, \\frac{1}{2}, \\frac{1}{2}\\right)$，能量 $E_{BC} = -0.35$。\n- 三元 $T$：$\\mathbf{x}_{T} = \\left(\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}\\right)$，能量 $E_{T} = -0.48$。\n- 等原子比三元 $E$：$\\mathbf{x}_{E} = \\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right)$，能量 $E_{E} = -0.45$。\n\n一个独立的机器学习模型（例如，高斯过程回归 (GPR)）预测在查询组分 $\\mathbf{x}_q = (0.2, 0.5, 0.3)$ 处的形成能为 $E_{\\text{ML}}(\\mathbf{x}_q) = -0.44$。\n\n从组分空间上的下凸包络的热力学定义和组分单纯形上的重心坐标定义出发，确定在 $\\mathbf{x}_q$ 处决定最小能量的相关下凸包面，通过对该凸包面顶点的重心插值计算 $\\mathbf{x}_q$ 处对应的凸包能量，并最终计算凸包距离 $\\Delta E = E_{\\text{ML}}(\\mathbf{x}_q) - E_{\\text{hull}}(\\mathbf{x}_q)$。\n\n以 eV/原子为单位表示最终的凸包距离。无需四舍五入；将精确的小数值作为单个数字报告。", "solution": "该问题要求确定一个假设相在组分 $\\mathbf{x}_q = (0.2, 0.5, 0.3)$ 处的热力学稳定性，其机器学习预测的形成能为 $E_{\\text{ML}}(\\mathbf{x}_q) = -0.44$ eV/atom。稳定性由凸包距离 $\\Delta E$ 量化，该值是预测能量与该组分下已知稳定相的下凸包能量 $E_{\\text{hull}}(\\mathbf{x}_q)$ 之间的能量差。\n\n在任意组分 $\\mathbf{x}$ 下的任何相混合物的形成能必须大于或等于基态能量，基态能量由所有已知相的形成能的下凸包定义。在零温度下，三元体系中的凸包由多个三角面组成，其顶点为稳定相。一个凸包面内任意一点的能量由其三个顶点相的能量通过线性插值确定。\n\n任务是识别出查询组分 $\\mathbf{x}_q$ 所在的下凸包的具体凸包面。这需要找到三个相，我们称其组分为 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3$，能量为 $E_1, E_2, E_3$，使得：\n1. 查询组分 $\\mathbf{x}_q$ 可以表示为顶点组分的凸组合：$\\mathbf{x}_q = c_1\\mathbf{x}_1 + c_2\\mathbf{x}_2 + c_3\\mathbf{x}_3$，其中系数 $c_1, c_2, c_3 \\ge 0$ 且 $\\sum_i c_i = 1$。\n2. 在组分-能量空间中，由这三个相定义的平面位于所有其他已知相的下方或与之共面。对于任何其他具有组分 $\\mathbf{x}_i$ 和能量 $E_i$ 的相 $i$，在该凸包面平面上于 $\\mathbf{x}_i$ 处插值得到的能量必须小于或等于 $E_i$。\n\n我们首先识别一个候选凸包面。根据 $\\mathbf{x}_q = (0.2, 0.5, 0.3)$ 的坐标，具有相似组分的相很可能是顶点。我们假设相关的凸包面是由相 $T = \\left(\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}\\right)$、$BC = \\left(0, \\frac{1}{2}, \\frac{1}{2}\\right)$ 和 $B = (0, 1, 0)$ 对应的顶点所形成的三角形。\n\n为验证此假设，我们定义穿过这三点的能量平面。该平面上的能量 $E$ 是组分的线性函数，即 $E(\\mathbf{x}) = \\mu_A x_A + \\mu_B x_B + \\mu_C x_C$，其中 $\\mu_A, \\mu_B, \\mu_C$ 是定义该平面的化学势。我们利用顶点相的能量来求解这些化学势：\n$E_T = \\mu_A x_{A,T} + \\mu_B x_{B,T} + \\mu_C x_{C,T} \\implies 0.25\\mu_A + 0.5\\mu_B + 0.25\\mu_C = -0.48$\n$E_{BC} = \\mu_A x_{A,BC} + \\mu_B x_{B,BC} + \\mu_C x_{C,BC} \\implies 0.5\\mu_B + 0.5\\mu_C = -0.35$\n$E_B = \\mu_A x_{A,B} + \\mu_B x_{B,B} + \\mu_C x_{C,B} \\implies \\mu_B = 0$\n\n从第三个方程可知，$\\mu_B=0$。代入第二个方程：$0.5(0) + 0.5\\mu_C = -0.35 \\implies \\mu_C = -0.7$。\n将 $\\mu_B$ 和 $\\mu_C$ 代入第一个方程：$0.25\\mu_A + 0.5(0) + 0.25(-0.7) = -0.48 \\implies 0.25\\mu_A - 0.175 = -0.48 \\implies 0.25\\mu_A = -0.305 \\implies \\mu_A = -1.22$。\n该平面由 $(\\mu_A, \\mu_B, \\mu_C) = (-1.22, 0, -0.7)$ 定义。此平面上的能量为 $E_{\\text{plane}}(\\mathbf{x}) = -1.22 x_A - 0.7 x_C$。\n\n现在，我们验证所有其他给定相都位于此平面之上或与之共面：\n- 对于 $A=(1,0,0)$，$E_{\\text{plane}}(A) = -1.22(1) - 0.7(0) = -1.22$。已知 $E_A = 0$。$E_A  E_{\\text{plane}}(A)$。\n- 对于 $C=(0,0,1)$，$E_{\\text{plane}}(C) = -1.22(0) - 0.7(1) = -0.7$。已知 $E_C = 0$。$E_C  E_{\\text{plane}}(C)$。\n- 对于 $AB=(\\frac{1}{2},\\frac{1}{2},0)$，$E_{\\text{plane}}(AB) = -1.22(\\frac{1}{2}) - 0.7(0) = -0.61$。已知 $E_{AB} = -0.40$。$E_{AB}  E_{\\text{plane}}(AB)$。\n- 对于 $AC=(\\frac{1}{2},0,\\frac{1}{2})$，$E_{\\text{plane}}(AC) = -1.22(\\frac{1}{2}) - 0.7(\\frac{1}{2}) = -0.61 - 0.35 = -0.96$。已知 $E_{AC} = -0.30$。$E_{AC}  E_{\\text{plane}}(AC)$。\n- 对于 $E=(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$，$E_{\\text{plane}}(E) = -1.22(\\frac{1}{3}) - 0.7(\\frac{1}{3}) = \\frac{-1.92}{3} = -0.64$。已知 $E_E = -0.45$。$E_E  E_{\\text{plane}}(E)$。\n\n由于所有相都位于此平面之上（或对顶点而言，位于其上），由 $T$、$BC$ 和 $B$ 形成的三角形是下凸包的一个凸包面。\n\n接下来，我们将查询组分 $\\mathbf{x}_q$ 表示为顶点组分 $\\mathbf{x}_T$、$\\mathbf{x}_{BC}$ 和 $\\mathbf{x}_B$ 的凸组合：\n$\\mathbf{x}_q = c_T \\mathbf{x}_T + c_{BC} \\mathbf{x}_{BC} + c_B \\mathbf{x}_B$\n这对应于求解重心坐标的线性方程组：\n$x_A$ 坐标：$0.2 = c_T(0.25) + c_{BC}(0) + c_B(0) \\implies c_T = \\frac{0.2}{0.25} = 0.8$。\n$x_C$ 坐标：$0.3 = c_T(0.25) + c_{BC}(0.5) + c_B(0) \\implies 0.3 = (0.8)(0.25) + 0.5c_{BC} \\implies 0.3 = 0.2 + 0.5c_{BC} \\implies 0.1 = 0.5c_{BC} \\implies c_{BC} = 0.2$。\n系数之和必须为 1：$c_T + c_{BC} + c_B = 1 \\implies 0.8 + 0.2 + c_B = 1 \\implies c_B = 0$。\n系数 $(c_T, c_{BC}, c_B) = (0.8, 0.2, 0)$ 均为非负，证实了 $\\mathbf{x}_q$ 位于该凸包面内（具体来说，是位于连接 $T$ 和 $BC$ 的边上）。\n\n在 $\\mathbf{x}_q$ 处的凸包能量是通过使用这些系数和顶点相的能量进行线性插值得到的：\n$$E_{\\text{hull}}(\\mathbf{x}_q) = c_T E_T + c_{BC} E_{BC} + c_B E_B$$\n$$E_{\\text{hull}}(\\mathbf{x}_q) = (0.8)(-0.48) + (0.2)(-0.35) + (0)(0)$$\n$$E_{\\text{hull}}(\\mathbf{x}_q) = -0.384 - 0.070 = -0.454 \\text{ eV/atom}$$\n\n最后，凸包距离 $\\Delta E$ 是机器学习预测能量与凸包能量之差：\n$$\\Delta E = E_{\\text{ML}}(\\mathbf{x}_q) - E_{\\text{hull}}(\\mathbf{x}_q)$$\n$$\\Delta E = -0.44 - (-0.454) = -0.44 + 0.454 = 0.014 \\text{ eV/atom}$$\n正的凸包距离表明，在 $\\mathbf{x}_q$ 处预测的相相对于分解成定义下凸包的相（在本例中为 T 和 BC 的混合物）是热力学不稳定的。", "answer": "$$\\boxed{0.014}$$", "id": "2837952"}, {"introduction": "我们无需在浩如烟海的材料空间中进行随机搜索，而是可以利用机器学习来高效地指导发现过程。贝叶斯优化（Bayesian optimization）是一种强大的策略，它能智能地选择下一个最值得研究的材料。这种选择由一个“采集函数”（acquisition function）指导，例如“期望提升”（Expected Improvement, EI），它巧妙地在探索不确定区域（exploration）和利用高潜区域（exploitation）之间取得平衡。通过推导并应用EI公式，本练习将揭示主动学习的核心逻辑，展示模型的预测和不确定性如何被结合起来，以在自动化发现流程中做出最优决策。[@problem_id:2838007]", "problem": "一个研究团队正在使用带有高斯过程（GP）代理模型的贝叶斯优化，来最小化一种新型四元合金的每个原子的形成能。对于任何候选输入 $x$，其形成能的 GP 预测分布被建模为高斯分布，其后验均值为 $\\mu(x)$，后验标准差为 $\\sigma(x)$。当前观测到的最佳（最低）形成能为 $f_{\\min}$（越低越好）。在两个新的候选成分 $x_{A}$ 和 $x_{B}$ 处，GP 预测为：\n- 在 $x_{A}$ 处：$\\mu(x_{A}) = -0.45$ eV/atom 且 $\\sigma(x_{A}) = 0.12$ eV/atom。\n- 在 $x_{B}$ 处：$\\mu(x_{B}) = -0.40$ eV/atom 且 $\\sigma(x_{B}) = 0.05$ eV/atom。\n当前观测到的最佳形成能为 $f_{\\min} = -0.48$ eV/atom。\n\n从最小化问题的期望提升的定义出发，即随机提升量 $I(x) = \\max\\{f_{\\min} - Y(x), 0\\}$（其中 $Y(x)$ 是 $x$ 点的 GP 预测随机变量），利用正态分布及其累积分布函数，推导出一个关于 $\\mu(x)$、$\\sigma(x)$ 和 $f_{\\min}$ 的通用点 $x$ 处的期望提升（EI）的解析表达式。然后，使用您推导出的表达式计算在 $x_{A}$ 和 $x_{B}$ 处的 EI。\n\n根据您的结果，确定在期望提升采集准则下，哪一个候选者更优。已知 $x_{B}$ 的预测方差比 $x_{A}$ 低，但预测均值比 $x_{A}$ 高。\n\n最后，计算差值 $\\Delta = \\mathrm{EI}(x_{A}) - \\mathrm{EI}(x_{B})$。将 $\\Delta$ 以电子伏特（eV）为单位表示，并将您的答案四舍五入到四位有效数字。最终答案必须仅为 $\\Delta$ 的单个数值。", "solution": "必须首先严格验证问题陈述。\n\n步骤1：提取已知条件。\n所提供的信息如下：\n- 在候选输入 $x$ 处，形成能 $Y(x)$ 的高斯过程（GP）预测分布为 $Y(x) \\sim \\mathcal{N}(\\mu(x), \\sigma(x)^2)$，其中 $\\mu(x)$ 是后验均值，$\\sigma(x)$ 是后验标准差。\n- 在候选点 $x_{A}$ 处：$\\mu(x_{A}) = -0.45$ eV/atom 且 $\\sigma(x_{A}) = 0.12$ eV/atom。\n- 在候选点 $x_{B}$ 处：$\\mu(x_{B}) = -0.40$ eV/atom 且 $\\sigma(x_{B}) = 0.05$ eV/atom。\n- 当前观测到的最小形成能为 $f_{\\min} = -0.48$ eV/atom。\n- 对于最小化问题，提升量被定义为随机变量 $I(x) = \\max\\{f_{\\min} - Y(x), 0\\}$。\n- 任务是推导期望提升 $\\mathrm{EI}(x) = E[I(x)]$ 的解析表达式。\n- 任务是计算 $\\mathrm{EI}(x_A)$ 和 $\\mathrm{EI}(x_B)$。\n- 任务是确定在 EI 准则下，候选点 $x_A$ 和 $x_B$ 哪个更优。\n- 任务是计算差值 $\\Delta = \\mathrm{EI}(x_{A}) - \\mathrm{EI}(x_{B})$ 并四舍五入到四位有效数字。\n\n步骤2：使用提取的已知条件进行验证。\n根据验证标准对问题进行评估：\n- **科学性：** 该问题基于贝叶斯优化的既定原则，特别是使用高斯过程代理模型和期望提升采集函数。这些是机器学习在材料发现领域的标准和广泛使用的方法。物理量、形成能及其给定值都是现实的。该问题在科学上是合理的。\n- **适定性：** 问题提供了推导所求公式和计算所需量所需的所有必要定义和数值。存在唯一解，并由给定数据确定。\n- **客观性：** 问题以精确、定量的术语陈述，没有任何主观或模棱两可的语言。\n- **其他标准：** 问题是完整的、一致的，并且需要进行重要的推导和计算。它不包含任何列出的缺陷。\n\n步骤3：结论与行动。\n问题有效。我将继续进行完整的推导和解答。\n\n期望提升 $\\mathrm{EI}(x)$ 是提升随机变量 $I(x) = \\max\\{f_{\\min} - Y(x), 0\\}$ 的期望值，其中形成能 $Y(x)$ 的预测分布是正态分布 $Y(x) \\sim \\mathcal{N}(\\mu(x), \\sigma(x)^2)$。设 $Y(x)$ 的概率密度函数（PDF）为 $f_{Y(x)}(y)$。期望由以下积分给出：\n$$ \\mathrm{EI}(x) = E[I(x)] = \\int_{-\\infty}^{\\infty} \\max\\{f_{\\min} - y, 0\\} f_{Y(x)}(y) \\, dy $$\n积分内的项仅在 $y  f_{\\min}$ 时非零。因此，积分的上限可以更改为 $f_{\\min}$，并且可以移除 $\\max$ 函数：\n$$ \\mathrm{EI}(x) = \\int_{-\\infty}^{f_{\\min}} (f_{\\min} - y) f_{Y(x)}(y) \\, dy $$\n我们可以将其分解为两个积分：\n$$ \\mathrm{EI}(x) = f_{\\min} \\int_{-\\infty}^{f_{\\min}} f_{Y(x)}(y) \\, dy - \\int_{-\\infty}^{f_{\\min}} y f_{Y(x)}(y) \\, dy $$\n为了计算这些积分，我们引入一个标准化正态变量 $Z = \\frac{Y(x) - \\mu(x)}{\\sigma(x)}$，它遵循标准正态分布 $Z \\sim \\mathcal{N}(0, 1)$。其概率密度函数（PDF）为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-\\frac{z^2}{2})$，其累积分布函数（CDF）为 $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t) \\, dt$。变量变换为 $y = \\mu(x) + z\\sigma(x)$，且有 $dy = \\sigma(x)dz$。积分上限 $y = f_{\\min}$ 对应于 $z = \\frac{f_{\\min} - \\mu(x)}{\\sigma(x)}$。我们将此标准化值定义为 $z_{\\min}$。\n\n第一项是：\n$$ f_{\\min} \\int_{-\\infty}^{f_{\\min}} f_{Y(x)}(y) \\, dy = f_{\\min} P(Y(x) \\le f_{\\min}) = f_{\\min} P(Z \\le z_{\\min}) = f_{\\min} \\Phi(z_{\\min}) $$\n第二项是部分期望：\n$$ \\int_{-\\infty}^{f_{\\min}} y f_{Y(x)}(y) \\, dy = \\int_{-\\infty}^{z_{\\min}} (\\mu(x) + z\\sigma(x)) \\phi(z) \\, dz $$\n$$ = \\mu(x) \\int_{-\\infty}^{z_{\\min}} \\phi(z) \\, dz + \\sigma(x) \\int_{-\\infty}^{z_{\\min}} z \\phi(z) \\, dz $$\n此表达式的第一部分是 $\\mu(x) \\Phi(z_{\\min})$。第二部分可以通过直接积分求解：\n$$ \\int_{-\\infty}^{z_{\\min}} z \\phi(z) \\, dz = \\int_{-\\infty}^{z_{\\min}} \\frac{z}{\\sqrt{2\\pi}}\\exp(-\\frac{z^2}{2}) \\, dz = \\frac{1}{\\sqrt{2\\pi}} \\left[ -\\exp(-\\frac{z^2}{2}) \\right]_{-\\infty}^{z_{\\min}} = -\\frac{1}{\\sqrt{2\\pi}}\\exp(-\\frac{z_{\\min}^2}{2}) = -\\phi(z_{\\min}) $$\n因此，$\\mathrm{EI}(x)$ 的第二项变为：\n$$ \\int_{-\\infty}^{f_{\\min}} y f_{Y(x)}(y) \\, dy = \\mu(x) \\Phi(z_{\\min}) - \\sigma(x) \\phi(z_{\\min}) $$\n将所有部分组合起来，期望提升的解析表达式为：\n$$ \\mathrm{EI}(x) = f_{\\min} \\Phi(z_{\\min}) - (\\mu(x) \\Phi(z_{\\min}) - \\sigma(x) \\phi(z_{\\min})) $$\n$$ \\mathrm{EI}(x) = (f_{\\min} - \\mu(x)) \\Phi(z_{\\min}) + \\sigma(x) \\phi(z_{\\min}) $$\n其中 $z_{\\min} = \\frac{f_{\\min} - \\mu(x)}{\\sigma(x)}$。至此推导完成。\n\n现在，我们计算当 $f_{\\min} = -0.48$ 时，候选点 $x_{A}$ 和 $x_{B}$ 的 EI。\n\n对于候选点 $x_{A}$：\n$\\mu_{A} = -0.45$，$\\sigma_{A} = 0.12$。\n标准化的提升阈值为：\n$$ z_A = \\frac{f_{\\min} - \\mu_A}{\\sigma_A} = \\frac{-0.48 - (-0.45)}{0.12} = \\frac{-0.03}{0.12} = -0.25 $$\n期望提升为：\n$$ \\mathrm{EI}(x_A) = (f_{\\min} - \\mu_A) \\Phi(z_A) + \\sigma_A \\phi(z_A) = (-0.03) \\Phi(-0.25) + (0.12) \\phi(-0.25) $$\n使用标准正态分布表或计算器：\n$\\Phi(-0.25) \\approx 0.401294$\n$\\phi(-0.25) = \\phi(0.25) \\approx 0.386668$\n$$ \\mathrm{EI}(x_A) \\approx (-0.03)(0.401294) + (0.12)(0.386668) \\approx -0.01203882 + 0.04640016 \\approx 0.03436134 \\, \\text{eV/atom} $$\n\n对于候选点 $x_{B}$：\n$\\mu_{B} = -0.40$，$\\sigma_{B} = 0.05$。\n标准化的提升阈值为：\n$$ z_B = \\frac{f_{\\min} - \\mu_B}{\\sigma_B} = \\frac{-0.48 - (-0.40)}{0.05} = \\frac{-0.08}{0.05} = -1.6 $$\n期望提升为：\n$$ \\mathrm{EI}(x_B) = (f_{\\min} - \\mu_B) \\Phi(z_B) + \\sigma_B \\phi(z_B) = (-0.08) \\Phi(-1.6) + (0.05) \\phi(-1.6) $$\n使用标准正态分布表或计算器：\n$\\Phi(-1.6) \\approx 0.054799$\n$\\phi(-1.6) = \\phi(1.6) \\approx 0.110921$\n$$ \\mathrm{EI}(x_B) \\approx (-0.08)(0.054799) + (0.05)(0.110921) \\approx -0.00438392 + 0.00554605 \\approx 0.00116213 \\, \\text{eV/atom} $$\n\n期望提升准则要求选择具有最高 EI 值的候选点。比较这两个值：\n$$ \\mathrm{EI}(x_A) \\approx 0.03436 \\, \\text{eV/atom} $$\n$$ \\mathrm{EI}(x_B) \\approx 0.00116 \\, \\text{eV/atom} $$\n由于 $\\mathrm{EI}(x_A)  \\mathrm{EI}(x_B)$，候选点 $x_{A}$ 会是更优的选择。尽管其均值预测比当前最优值差（$ -0.45  -0.48 $），但其较高的不确定性（$\\sigma_A = 0.12$）意味着有很大可能性发现一个更低的形成能。这个选择代表了探索。相比之下，$x_B$ 的不确定性较低，且其均值（$ -0.40 $）与当前最优值相差甚远，导致期望提升非常低。\n\n最后，我们计算差值 $\\Delta = \\mathrm{EI}(x_{A}) - \\mathrm{EI}(x_{B})$：\n$$ \\Delta = 0.03436134 - 0.00116213 = 0.03319921 $$\n将此结果四舍五入到四位有效数字，得到 $0.03320$。", "answer": "$$\n\\boxed{0.03320}\n$$", "id": "2838007"}]}