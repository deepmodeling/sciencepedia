{"hands_on_practices": [{"introduction": "弹跳球是混合系统的经典范例，它将连续运动（重力作用下的飞行）与离散事件（与地面碰撞）结合在一起。这个练习将指导您使用流方程和重置映射来为这一物理现象建模，并分析其最引人入胜的特性之一：Zeno行为，即在有限时间内发生无限次事件。通过推导Zeno时间[@problem_id:2712042]，您将从分析层面深刻理解这种现象是如何从连续与离散动态的相互作用中产生的。", "problem": "考虑状态空间 $\\mathbb{R}^{2}$ 上的理想化弹跳球混合系统，其状态为 $x = (x_{1}, x_{2})$，其中 $x_{1}$ 是高度，$x_{2}$ 是垂直速度。连续流由常微分方程 (ODE) $\\dot{x}_{1} = x_{2}$ 和 $\\dot{x}_{2} = -g$ 控制，其中常数重力加速度 $g \\in \\mathbb{R}_{0}$。与地面的碰撞发生在保护集 $x_{1} = 0$ 处，碰撞后速度由重置映射 $x_{2}^{+} = -e x_{2}$ 决定，其中常数恢复系数 $e \\in (0,1)$。假设定义域约束为 $x_{1} \\ge 0$，并且只考虑物理上一致的碰撞，即在达到保护集时满足 $x_{2} \\le 0$。在 $t = 0$ 时初始化系统，初始条件为 $x_{1}(0) = 0$ 和一个向上的碰撞后速度 $x_{2}(0) = v_{0}$，其中 $v_{0} \\in \\mathbb{R}_{0}$。\n\n仅从这些定义和常微分方程所蕴含的基本运动学关系出发，完成以下任务：\n- 推导两次碰撞之间的飞行时间序列以及相应的碰撞前和碰撞后速度。\n- 通过明确证明两次碰撞之间的时间总和收敛，来证明碰撞时间在有限时间内累积（即系统表现出芝诺行为）。\n- 将芝诺时间 $T_{Z}$ 定义为碰撞时间序列的极限，并计算出 $T_{Z}$ 关于 $e$、$g$ 和 $v_{0}$ 的闭式解析表达式。\n\n以秒为单位表示最终的芝诺时间。您的最终答案必须是单个闭式解析表达式，且不得包含单位。", "solution": "所述问题是有效的。这是一个在混合动力系统分析中适定且有科学依据的问题。我们将进行完整的推导。\n\n系统动力学由两个部分描述：连续流和离散重置。\n\n连续流由以下线性时不变常微分方程组控制：\n$$\n\\dot{x}_{1} = x_{2} \\\\\n\\dot{x}_{2} = -g\n$$\n其中 $x_1$ 是高度，$x_2$ 是垂直速度，$g \\in \\mathbb{R}_{0}$ 是常数重力加速度。对这些方程关于时间 $t$ 积分，可以得到恒定加速度下物体的标准运动学关系：\n$$\nx_{2}(t) = x_{2}(t_0) - g(t-t_0) \\\\\nx_{1}(t) = x_{1}(t_0) + x_{2}(t_0)(t-t_0) - \\frac{1}{2}g(t-t_0)^2\n$$\n其中 $(x_1(t_0), x_2(t_0))$ 是在初始时间 $t_0$ 的状态。\n\n当状态轨迹到达由 $x_1=0$ 定义的保护集时，发生离散事件（碰撞）。系统状态随后根据重置映射 $x_2^+ = -e x_2^-$ 瞬时改变，其中 $x_2^-$ 是碰撞前速度，$x_2^+$ 是碰撞后速度，$e \\in (0,1)$ 是恢复系数。高度状态 $x_1$ 保持不变，仍为 $x_1=0$。只有当 $x_2^- \\le 0$ 时，碰撞才是物理上一致的。\n\n令 $T_k$ 为第 $k$ 次碰撞的时间，其中 $k \\in \\{1, 2, 3, \\dots\\}$。我们定义 $T_0 = 0$。令 $v_k^-$ 为第 $k$ 次碰撞前的瞬时速度，$v_k^+$ 为第 $k$ 次碰撞后的瞬时速度。初始条件在 $t=0$ 时给出，为 $x_1(0)=0$ 和一个向上的速度 $x_2(0)=v_0  0$。我们将此解释为在 $t=0$ 时一次假设性碰撞后立即的状态，因此我们定义 $v_0^+ \\equiv v_0$。\n\n我们将迭代地分析系统运动，从一次碰撞到下一次碰撞。\n\n考虑第 $k$ 个飞行阶段，该阶段发生在时间区间 $(T_{k-1}, T_k)$ 内，其中 $k \\ge 1$。在此阶段开始时，即时间 $t=T_{k-1}$，状态为 $(x_1, x_2) = (0, v_{k-1}^+)$。使用积分后的运动方程，并设 $t_0 = T_{k-1}$，则对于 $t \\in [T_{k-1}, T_k]$ 的状态为：\n$$\nx_2(t) = v_{k-1}^+ - g(t - T_{k-1}) \\\\\nx_1(t) = 0 + v_{k-1}^+(t - T_{k-1}) - \\frac{1}{2}g(t - T_{k-1})^2\n$$\n第 $k$ 次碰撞发生在时间 $t=T_k$ 时，此时 $x_1(T_k) = 0$ 且 $T_k > T_{k-1}$。令 $\\Delta_k = T_k - T_{k-1}$ 为第 $k$ 次飞行的持续时间。\n$$\nv_{k-1}^+\\Delta_k - \\frac{1}{2}g\\Delta_k^2 = 0\n$$\n提出因子 $\\Delta_k$，我们得到 $\\Delta_k \\left( v_{k-1}^+ - \\frac{1}{2}g\\Delta_k \\right) = 0$。由于对于非平凡飞行有 $\\Delta_k > 0$，我们求得两次碰撞之间的时间：\n$$\n\\Delta_k = \\frac{2v_{k-1}^+}{g}\n$$\n第 $k$ 次碰撞前的瞬时速度 $v_k^-$ 是 $x_2(t)$ 在 $t=T_k$ 时的值：\n$$\nv_k^- = x_2(T_k) = v_{k-1}^+ - g(T_k - T_{k-1}) = v_{k-1}^+ - g\\Delta_k = v_{k-1}^+ - g\\left(\\frac{2v_{k-1}^+}{g}\\right) = -v_{k-1}^+\n$$\n由于 $v_0^+ = v_0 > 0$ 并且我们将证明所有的 $v_k^+ > 0$，碰撞前速度 $v_k^-$ 总是负的，满足了在保护集上 $x_2 \\le 0$ 的物理一致性条件。\n\n碰撞后速度 $v_k^+$ 由重置映射决定：\n$$\nv_k^+ = -e v_k^- = -e(-v_{k-1}^+) = e v_{k-1}^+\n$$\n这为我们提供了碰撞后速度序列的递推关系：对于 $k \\ge 1$，有 $v_k^+ = e v_{k-1}^+$，初始值为 $v_0^+ = v_0$。这是一个几何级数，其显式解为：\n$$\nv_k^+ = e^k v_0^+ = e^k v_0\n$$\n现在我们可以写出对于 $k \\ge 1$ 的碰撞前速度和两次碰撞之间的时间序列的显式表达式：\n$$\nv_k^- = -v_{k-1}^+ = -e^{k-1}v_0 \\\\\n\\Delta_k = \\frac{2v_{k-1}^+}{g} = \\frac{2e^{k-1}v_0}{g}\n$$\n这就完成了任务的第一部分。\n\n为了证明系统表现出芝诺行为，我们必须证明碰撞时间序列 $T_N = \\sum_{k=1}^N \\Delta_k$ 在 $N \\to \\infty$ 时收敛到一个有限极限。这个极限就是芝诺时间 $T_Z$。\n$$\nT_Z = \\lim_{N \\to \\infty} T_N = \\sum_{k=1}^{\\infty} \\Delta_k = \\sum_{k=1}^{\\infty} \\frac{2e^{k-1}v_0}{g}\n$$\n我们可以提出常数项：\n$$\nT_Z = \\frac{2v_0}{g} \\sum_{k=1}^{\\infty} e^{k-1}\n$$\n令求和指数为 $j = k-1$。当 $k$ 从 $1$ 趋于 $\\infty$ 时，$j$ 从 $0$ 趋于 $\\infty$。\n$$\nT_Z = \\frac{2v_0}{g} \\sum_{j=0}^{\\infty} e^{j}\n$$\n这是一个公比为 $e$ 的标准几何级数。问题规定 $e \\in (0,1)$，这意味着 $|e|  1$。几何级数收敛的充要条件是其公比的绝对值小于 $1$。因此，该级数收敛，其和由公式 $\\sum_{j=0}^{\\infty} r^j = \\frac{1}{1-r}$ 给出。\n$$\n\\sum_{j=0}^{\\infty} e^{j} = \\frac{1}{1-e}\n$$\n由于两次碰撞之间的时间总和收敛到一个有限值，所以在有限的时间跨度内发生了无限次碰撞。这证明了系统表现出芝诺行为。\n\n最后，我们将级数的和代入 $T_Z$ 的表达式中，计算出芝诺时间 $T_Z$ 的显式闭式表达式：\n$$\nT_Z = \\frac{2v_0}{g} \\left( \\frac{1}{1-e} \\right)\n$$\n这可以简化为芝诺时间的最终表达式。", "answer": "$$\\boxed{\\frac{2v_{0}}{g(1-e)}}$$", "id": "2712042"}, {"introduction": "一个由多个独立稳定子系统构成的切换系统，其整体稳定性并非理所当然。这个练习探讨了一个核心且反直觉的概念：一个精心设计的切换策略可以使原本稳定的系统变得不稳定。通过一个动手编程实践[@problem_id:2712004]，您将通过计算和观察状态转移矩阵的谱半径，亲眼见证这种失稳现象，从而深刻体会到切换律在系统整体行为中的决定性作用。", "problem": "考虑定义在 $\\mathbb{R}^2$ 上的连续时间切换线性系统，该系统由一族模式 $\\dot{x}(t) = A_{\\sigma(t)} x(t)$ 给出，其中 $\\sigma(t) \\in \\{1,2\\}$ 是一个分段常数切换信号。对于参数 $L > 0$，定义两个模式矩阵\n$$\nA_1(L) = \\begin{bmatrix} -1   L \\\\ 0   -1 \\end{bmatrix}, \\qquad\nA_2(L) = \\begin{bmatrix} -1   0 \\\\ L   -1 \\end{bmatrix}.\n$$\n每个 $A_i(L)$ 都是上三角或下三角矩阵，对角线元素为 $-1$，因此两者都是赫尔维茨（Hurwitz）矩阵（所有特征值都严格位于开左半平面）。\n\n您将分析在模式1和模式2之间以固定的驻留时间 $\\tau > 0$ 严格交替的周期性切换所产生的影响。也就是说，对于 $k \\in \\mathbb{N}$，系统在 $[2k\\tau,(2k+1)\\tau)$ 上使用模式1，在 $[(2k+1)\\tau,(2k+2)\\tau)$ 上使用模式2。设 $x(0)=x_0 \\in \\mathbb{R}^2$。仅使用基本定义，即 (i) $\\dot{x} = A x$ 在长度为 $t$ 的时间区间上的解由 $x(t) = \\mathrm{e}^{A t} x(0)$ 给出，以及 (ii) 在连续模式下的演化通过矩阵乘法复合，则在切换时刻采样的状态满足\n$$\nx(2k\\tau) \\;=\\; \\left(\\mathrm{e}^{A_2(L)\\,\\tau} \\, \\mathrm{e}^{A_1(L)\\,\\tau}\\right)^k \\, x_0 \\;\\triangleq\\; P(L,\\tau)^k \\, x_0,\n$$\n其中 $P(L,\\tau) \\in \\mathbb{R}^{2\\times 2}$ 是单周期状态转移矩阵。方阵 $P$ 的谱半径 $\\rho(P)$ 定义为其特征值绝对值的最大值。如果 $\\rho(P) > 1$，则存在某个初始条件 $x_0 \\neq 0$，使得当 $k \\to \\infty$ 时，$\\lVert P^k x_0 \\rVert_2$ 无界增长；如果 $\\rho(P)  1$，则对于所有 $x_0$，都有 $\\lVert P^k x_0 \\rVert_2 \\to 0$。\n\n您的任务是构建并论证一个例子，其中每个模式单独是稳定的（Hurwitz），但周期性切换会使系统失稳。具体来说，您必须：\n\n- 实现一个程序，对于每个给定的参数集 $(L,\\tau,N,x_0)$，执行以下操作：\n  1. 构建 $A_1(L)$ 和 $A_2(L)$。\n  2. 通过检查所有特征值的实部是否为负，来验证 $A_1(L)$ 和 $A_2(L)$ 都是 Hurwitz 矩阵。\n  3. 使用矩阵指数形成单周期矩阵 $P(L,\\tau) = \\mathrm{e}^{A_2(L)\\,\\tau} \\, \\mathrm{e}^{A_1(L)\\,\\tau}$。\n  4. 计算谱半径 $\\rho\\!\\left(P(L,\\tau)\\right)$。\n  5. 计算 $N$ 个周期后的增长因子，\n     $$\n     g_N(L,\\tau,x_0) \\;=\\; \\frac{\\left\\lVert P(L,\\tau)^N \\, x_0 \\right\\rVert_2}{\\lVert x_0 \\rVert_2}.\n     $$\n- 使用这些计算结果，通过展示 $\\rho(P)>1$ 和较大的 $g_N$ 的情况，来论证切换下的不稳定性，尽管两种模式都是 Hurwitz 的。解释为什么这必然排除了一个对两种模式都严格递减的公共 Lyapunov 函数的存在。\n\n测试套件。您的程序必须评估以下四组参数集，它们分别测试一个典型的不稳定情况、一个明确的稳定情况、一个接近边界的情况，以及另一个具有不同初始条件的不稳定情况：\n\n- 情况1：$L = 100.0$，$\\tau = 0.1$， $N = 5$， $x_0 = \\begin{bmatrix} 1.0 \\\\ 0.0 \\end{bmatrix}$。\n- 情况2：$L = 1.0$， $\\tau = 0.5$， $N = 20$， $x_0 = \\begin{bmatrix} 1.0 \\\\ 0.0 \\end{bmatrix}$。\n- 情况3：$L = 2.0$， $\\tau = 0.01$， $N = 1000$， $x_0 = \\begin{bmatrix} 1.0 \\\\ 0.0 \\end{bmatrix}$。\n- 情况4：$L = 50.0$， $\\tau = 0.05$， $N = 10$， $x_0 = \\begin{bmatrix} 0.3 \\\\ -0.7 \\end{bmatrix}$。\n\n数值规格和输出格式：\n\n- 对于每种情况，按顺序输出一个包含三个条目的列表：一个布尔值，指示 $A_1(L)$ 和 $A_2(L)$ 是否都是 Hurwitz 矩阵；谱半径 $\\rho(P)$，作为一个四舍五入到六位小数的浮点数；以及增长因子 $g_N$，作为一个四舍五入到六位小数的浮点数。\n- 将所有四种情况的结果汇总到一行中，该行包含一个由逗号分隔的四个单例列表的列表，并用方括号括起来，例如\n$$\n[\\,[\\text{true},\\,1.234000,\\,5.678900],\\,[\\text{true},\\,0.987650,\\,0.123450],\\,[\\text{true},\\,\\dots],\\,[\\text{true},\\,\\dots]\\,].\n$$\n对于布尔值，请使用小写的字面词 true/false。\n- 不涉及物理单位。在您的实现中出现的任何角度（如果有的话）都应以弧度为单位。您的程序必须是完全自包含的，不需要任何输入，并且必须严格按照上述格式打印一行输出。", "solution": "问题陈述已被解析和验证。它具有科学依据，是自包含的，并且是适定的。它提出了切换系统理论领域的一个标准、经典的例子，该例子表明，由单独稳定的线性时不变模式组成的切换系统，可以通过特定的切换律变得不稳定。该问题是有效的，并将提供一个解决方案。\n\n分析始于切换线性系统的两种模式，由以下矩阵控制：\n$$\nA_1(L) = \\begin{bmatrix} -1   L \\\\ 0   -1 \\end{bmatrix}, \\qquad\nA_2(L) = \\begin{bmatrix} -1   0 \\\\ L   -1 \\end{bmatrix}\n$$\n对于某个参数 $L > 0$。两个矩阵都是三角矩阵，因此它们的特征值就是其对角线元素。$A_1(L)$ 和 $A_2(L)$ 的特征值均为 $\\lambda_1 = -1$ 和 $\\lambda_2 = -1$。由于所有特征值的实部都严格为负（$\\mathrm{Re}(\\lambda_i) = -1  0$），因此对于任何 $L > 0$ 的选择，这两个矩阵都是 Hurwitz 矩阵。这意味着，如果系统在模式1或模式2下连续运行，任何轨迹 $x(t)$ 都会收敛到原点，即 $\\lim_{t\\to\\infty} x(t) = 0$。\n\n问题指定了一个周期性切换信号，每个模式具有固定的驻留时间 $\\tau > 0$。系统在模式1下演化持续时间 $\\tau$，然后是模式2下演化持续时间 $\\tau$。这完成了一个周期为 $2\\tau$ 的完整循环。为了分析切换系统的稳定性，我们考察一个这样的周期内的状态演化。线性系统 $\\dot{x} = Ax$ 在时间间隔 $t$ 上的状态转移矩阵是矩阵指数 $\\mathrm{e}^{At}$。周期结束时的状态是通过复合每个分段的状态转移得到的。对于初始状态 $x_0$，第一段（模式1，时间 $\\tau$）后的状态是 $x_1 = \\mathrm{e}^{A_1(L)\\tau} x_0$。第二段（模式2，时间 $\\tau$）后的状态是 $x_2 = \\mathrm{e}^{A_2(L)\\tau} x_1$。将它们结合起来，一个完整周期内的状态转移由矩阵 $P(L, \\tau)$ 描述：\n$$\nx(2\\tau) = \\left(\\mathrm{e}^{A_2(L)\\tau} \\, \\mathrm{e}^{A_1(L)\\tau}\\right) x(0) \\triangleq P(L,\\tau) x(0)\n$$\n离散时间系统 $x((k+1)2\\tau) = P(L,\\tau) x(k2\\tau)$ 的稳定性由谱半径 $\\rho(P(L,\\tau))$ 决定，即 $P(L,\\tau)$ 特征值绝对值的最大值。如果 $\\rho(P)  1$，系统是稳定的；如果 $\\rho(P) > 1$，系统是不稳定的。\n\n为了计算 $P(L, \\tau)$，我们首先求矩阵指数。矩阵 $A_i(L)$ 的形式为 $A = -\\lambda I + N$，其中 $N$ 是一个幂零矩阵。具体来说，$A_1(L) = -I + N_1$，其中 $N_1 = \\begin{bmatrix} 0   L \\\\ 0   0 \\end{bmatrix}$；以及 $A_2(L) = -I + N_2$，其中 $N_2 = \\begin{bmatrix} 0   0 \\\\ L   0 \\end{bmatrix}$。由于 $-I$ 与任何矩阵都可交换，所以 $\\mathrm{e}^{A\\tau} = \\mathrm{e}^{(-I+N)\\tau} = \\mathrm{e}^{-I\\tau}\\mathrm{e}^{N\\tau} = \\mathrm{e}^{-\\tau}I \\cdot \\mathrm{e}^{N\\tau}$。矩阵 $N_1$ 和 $N_2$ 是2阶幂零矩阵，即 $N_1^2 = N_2^2 = 0$。因此，矩阵指数的级数展开会截断：$\\mathrm{e}^{N\\tau} = I + N\\tau + \\frac{(N\\tau)^2}{2!} + \\dots = I + N\\tau$。\n这给出：\n$$\n\\mathrm{e}^{A_1(L)\\tau} = \\mathrm{e}^{-\\tau}(I + N_1\\tau) = \\mathrm{e}^{-\\tau} \\begin{bmatrix} 1   L\\tau \\\\ 0   1 \\end{bmatrix}\n$$\n$$\n\\mathrm{e}^{A_2(L)\\tau} = \\mathrm{e}^{-\\tau}(I + N_2\\tau) = \\mathrm{e}^{-\\tau} \\begin{bmatrix} 1   0 \\\\ L\\tau   1 \\end{bmatrix}\n$$\n现在，我们计算它们的乘积以形成 $P(L,\\tau)$：\n$$\nP(L,\\tau) = \\left(\\mathrm{e}^{-\\tau} \\begin{bmatrix} 1   0 \\\\ L\\tau   1 \\end{bmatrix}\\right) \\left(\\mathrm{e}^{-\\tau} \\begin{bmatrix} 1   L\\tau \\\\ 0   1 \\end{bmatrix}\\right) = \\mathrm{e}^{-2\\tau} \\begin{bmatrix} 1   L\\tau \\\\ L\\tau   1 + (L\\tau)^2 \\end{bmatrix}\n$$\n为了求谱半径，我们计算 $P(L,\\tau)$ 的特征值。令 $s = L\\tau$。特征方程为 $\\det(P - \\lambda I) = 0$。令 $\\mu = \\lambda \\mathrm{e}^{2\\tau}$，则矩阵部分的特征值方程为：\n$$\n\\det \\begin{bmatrix} 1 - \\mu   s \\\\ s   1+s^2 - \\mu \\end{bmatrix} = (1-\\mu)(1+s^2-\\mu) - s^2 = 0\n$$\n$$\n\\mu^2 - (2+s^2)\\mu + 1 = 0\n$$\n根为 $\\mu_{\\pm} = \\frac{2+s^2 \\pm \\sqrt{(2+s^2)^2-4}}{2} = \\frac{2+s^2 \\pm s\\sqrt{4+s^2}}{2}$。\n由于 $s=L\\tau > 0$，两个根 $\\mu_{\\pm}$ 都是实数且为正。较大的根是 $\\mu_+$。$P(L,\\tau)$ 的特征值是 $\\lambda_{\\pm} = \\mathrm{e}^{-2\\tau}\\mu_{\\pm}$。谱半径为 $\\rho(P) = \\lambda_+ = \\mathrm{e}^{-2\\tau} \\frac{2+(L\\tau)^2 + L\\tau\\sqrt{4+(L\\tau)^2}}{2}$。\n如果 $\\rho(P) > 1$，系统是不稳定的。对于足够大的乘积 $L\\tau$ 值，这个条件可以满足。例如，如果 $L$ 很大而 $\\tau$ 很小，项 $\\mathrm{e}^{-2\\tau}$ 接近 1，而涉及 $L\\tau$ 的项可能很大，从而导致 $\\rho(P) > 1$。这表明即使每个模式都是独立稳定的，切换系统也可能是不稳定的。在物理上，状态向量被交替方向的剪切变换迅速“踢动”，导致其范数增长。\n\n这一结果对于公共 Lyapunov 函数的存在性具有深远的影响。切换系统中的一个关键定理指出，如果存在一个公共二次 Lyapunov 函数 $V(x) = x^T Q x$（其中 $Q=Q^T \\succ 0$），使得其时间导数 $\\dot{V}(x) = x^T(A_i^T Q + Q A_i)x$ 对所有模式 $i$ 都是负定的，那么该切换系统在任意切换信号下都是渐近稳定的。存在一个使系统不稳定的切换信号（在本例中是具有特定 $L$ 和 $\\tau$ 的周期信号），这为“不存在适用于这对矩阵 $A_1(L)$ 和 $A_2(L)$ 的公共 Lyapunov 函数”提供了直接的反证法证明。\n\n所提供的程序将为四个测试用例实现定义的计算。对于每个用例 $(L,\\tau,N,x_0)$，它将：\n1. 构建矩阵 $A_1(L)$ 和 $A_2(L)$。\n2. 通过计算它们的特征值来数值上确认它们是 Hurwitz 矩阵。\n3. 使用库函数计算矩阵指数，以形成 $P(L,\\tau) = \\mathrm{e}^{A_2(L)\\tau} \\mathrm{e}^{A_1(L)\\tau}$。\n4. 计算 $P(L,\\tau)$ 的特征值以求其谱半径 $\\rho(P)$。\n5. 计算增长因子 $g_N = \\lVert P^N x_0 \\rVert_2 / \\lVert x_0 \\rVert_2$。\n结果将定量地展示不稳定（情况1和4）和稳定（情况2和3）的场景，从而加强理论分析。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Analyzes a switched linear system for stability under periodic switching.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (100.0, 0.1, 5, np.array([1.0, 0.0])),\n        (1.0, 0.5, 20, np.array([1.0, 0.0])),\n        (2.0, 0.01, 1000, np.array([1.0, 0.0])),\n        (50.0, 0.05, 10, np.array([0.3, -0.7]))\n    ]\n    \n    results = []\n\n    for L, tau, N, x0 in test_cases:\n        # 1. Construct A1(L) and A2(L).\n        A1 = np.array([[-1.0, L], [0.0, -1.0]])\n        A2 = np.array([[-1.0, 0.0], [L, -1.0]])\n\n        # 2. Verify that both A1 and A2 are Hurwitz.\n        # A matrix is Hurwitz if the real parts of all its eigenvalues are negative.\n        eigvals_A1 = np.linalg.eigvals(A1)\n        eigvals_A2 = np.linalg.eigvals(A2)\n        are_hurwitz = np.all(np.real(eigvals_A1)  0) and np.all(np.real(eigvals_A2)  0)\n        \n        # 3. Form the one-cycle matrix P(L,tau).\n        # P = e^(A2*tau) * e^(A1*tau)\n        expm_A1_tau = expm(A1 * tau)\n        expm_A2_tau = expm(A2 * tau)\n        P = expm_A2_tau @ expm_A1_tau\n        \n        # 4. Compute the spectral radius of P.\n        # The spectral radius is the maximum of the absolute values of the eigenvalues.\n        eigvals_P = np.linalg.eigvals(P)\n        spectral_radius = np.max(np.abs(eigvals_P))\n\n        # 5. Compute the growth factor after N cycles.\n        # g_N = || P^N * x0 ||_2 / || x0 ||_2\n        if np.linalg.norm(x0) == 0:\n            growth_factor = 1.0 # By definition or as a special case\n        else:\n            P_N = np.linalg.matrix_power(P, N)\n            x_final = P_N @ x0\n            growth_factor = np.linalg.norm(x_final) / np.linalg.norm(x0)\n\n        # Store the formatted results for this case.\n        # Booleans are output as lowercase 'true'/'false'.\n        # Floats are rounded to six decimal places.\n        case_result = [\n            str(are_hurwitz).lower(),\n            f\"{spectral_radius:.6f}\",\n            f\"{growth_factor:.6f}\"\n        ]\n        results.append(case_result)\n\n    # Format the final output string as a list of lists.\n    # e.g., [[true,1.234000,5.678900],[true,0.987650,0.123450]]\n    output_str = \"[\" + \",\".join([f\"[{','.join(res)}]\" for res in results]) + \"]\"\n    \n    # Print the final output in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2712004"}, {"introduction": "既然某些切换律可能导致系统失稳，我们如何才能确保系统在任意切换下的稳定性呢？此问题的答案通常在于寻找一个“公共李雅普诺夫函数”(Common Lyapunov Function)。本练习[@problem_id:2712026]将引导您完成寻找这样一个函数的分析过程，该函数能够证明系统所有模式的能量都在衰减，从而保证了全局稳定性。这不仅加深了您对李雅普诺夫理论在切换系统中应用的理解，也为您提供了求解相关线性矩阵不等式(LMI)的实用技巧。", "problem": "考虑一个连续时间切换线性系统，其微分方程定义为 $\\dot{x}(t)=A_{\\sigma(t)}x(t)$，其中 $x(t)\\in\\mathbb{R}^{2}$，切换信号 $\\sigma(t)$ 在有限索引集 $\\{1,2\\}$ 中取值。模态矩阵为\n$$\nA_{1}=\\begin{bmatrix}-2  0\\\\0  -1\\end{bmatrix},\\qquad A_{2}=\\begin{bmatrix}-1  1\\\\-3  -2\\end{bmatrix}.\n$$\n一个共同二次李雅普诺夫函数 (CQLF) 是形如 $V(x)=x^{\\top}Px$ 的函数，其中 $P\\in\\mathbb{R}^{2\\times 2}$ 是对称矩阵且 $P\\succ 0$，使得对于每个模态 $i\\in\\{1,2\\}$ 和每个非零状态 $x\\in\\mathbb{R}^{2}$， $V(x)$ 沿着轨迹 $\\dot{x}=A_{i}x$ 的导数满足 $\\dot{V}(x)0$。根据线性系统的标准李雅普诺夫特性，如果对于 $i\\in\\{1,2\\}$ 有 $A_{i}^{\\top}P+PA_{i}\\prec 0$，则该条件得到保证，这是一个线性矩阵不等式 (LMI) 的可行性条件。\n\n仅使用李雅普诺夫函数及其沿系统轨迹导数的基本定义，确定一个满足 $A_{i}^{\\top}P+PA_{i}\\prec 0$（对于 $i=1,2$）的显式对称矩阵 $P\\succ 0$。请以实数项的精确矩阵形式提供答案；无需四舍五入。不要包含任何单位。", "solution": "该问题陈述构成了切换线性系统稳定性分析中的一个标准的、适定的问题。它具有科学依据，内容自洽，没有任何歧义或矛盾。因此，我们可以着手求解。\n\n目标是找到一个对称正定矩阵 $P \\in \\mathbb{R}^{2\\times 2}$，作为给定切换系统两种模态的共同二次李雅普诺夫函数。这样的矩阵必须满足以下三个条件：\n$1.$ $P = P^{\\top}$ 且 $P \\succ 0$（对称且正定）。\n$2.$ $A_1^{\\top}P + PA_1 \\prec 0$。\n$3.$ $A_2^{\\top}P + PA_2 \\prec 0$。\n\n设对称矩阵 $P$ 表示为\n$$\nP = \\begin{pmatrix} p_1  p_2 \\\\ p_2  p_3 \\end{pmatrix}\n$$\n其中 $p_1, p_2, p_3 \\in \\mathbb{R}$。\n\n第一个条件 $P \\succ 0$ 成立，当且仅当其所有顺序主子式均为正。这导出以下不等式：\n$$p_1 > 0$$\n$$p_1 p_3 - p_2^2 > 0$$\n\n第二个条件是针对模态 $i=1$，其中 $A_1 = \\begin{pmatrix} -2  0 \\\\ 0  -1 \\end{pmatrix}$。令 $Q_1 = A_1^{\\top}P + PA_1$。\n$$\nQ_1 = \\begin{pmatrix} -2  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} p_1  p_2 \\\\ p_2  p_3 \\end{pmatrix} + \\begin{pmatrix} p_1  p_2 \\\\ p_2  p_3 \\end{pmatrix} \\begin{pmatrix} -2  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n$$\nQ_1 = \\begin{pmatrix} -2p_1  -2p_2 \\\\ -p_2  -p_3 \\end{pmatrix} + \\begin{pmatrix} -2p_1  -p_2 \\\\ -2p_2  -p_3 \\end{pmatrix} = \\begin{pmatrix} -4p_1  -3p_2 \\\\ -3p_2  -2p_3 \\end{pmatrix}\n$$\n要使 $Q_1 \\prec 0$，矩阵 $-Q_1$ 必须是正定的。\n$$\n-Q_1 = \\begin{pmatrix} 4p_1  3p_2 \\\\ 3p_2  2p_3 \\end{pmatrix} \\succ 0\n$$\n这给出不等式：$4p_1 > 0$（等价于 $p_1 > 0$）和 $\\det(-Q_1) = 8p_1 p_3 - 9p_2^2 > 0$。\n\n第三个条件是针对模态 $i=2$，其中 $A_2 = \\begin{pmatrix} -1  1 \\\\ -3  -2 \\end{pmatrix}$。令 $Q_2 = A_2^{\\top}P + PA_2$。\n$$\nQ_2 = \\begin{pmatrix} -1  -3 \\\\ 1  -2 \\end{pmatrix} \\begin{pmatrix} p_1  p_2 \\\\ p_2  p_3 \\end{pmatrix} + \\begin{pmatrix} p_1  p_2 \\\\ p_2  p_3 \\end{pmatrix} \\begin{pmatrix} -1  1 \\\\ -3  -2 \\end{pmatrix}\n$$\n$$\nQ_2 = \\begin{pmatrix} -p_1 - 3p_2  -p_2 - 3p_3 \\\\ p_1 - 2p_2  p_2 - 2p_3 \\end{pmatrix} + \\begin{pmatrix} -p_1 - 3p_2  p_1 - 2p_2 \\\\ -p_2 - 3p_3  p_2 - 2p_3 \\end{pmatrix}\n$$\n$$\nQ_2 = \\begin{pmatrix} -2p_1 - 6p_2  p_1 - 3p_2 - 3p_3 \\\\ p_1 - 3p_2 - 3p_3  2p_2 - 4p_3 \\end{pmatrix}\n$$\n要使 $Q_2 \\prec 0$，矩阵 $-Q_2$ 必须是正定的。条件是其顺序主子式为正：\n$$ -(-2p_1 - 6p_2) = 2p_1 + 6p_2 > 0 $$\n$$ \\det(-Q_2) = (2p_1 + 6p_2)(4p_3 - 2p_2) - (p_1 - 3p_2 - 3p_3)^2 > 0 $$\n注意，$-Q_2$ 的第二个对角元素 $4p_3 - 2p_2$ 也必须为正。\n\n我们必须找到一组满足此不等式系统的参数 $(p_1, p_2, p_3)$。为了简化寻找可行解的过程，我们可以研究一类受限的矩阵。让我们测试对角矩阵 $P$，这对应于设置 $p_2=0$。\n在此假设下，不等式系统显著简化：\n$1.$ 从 $P \\succ 0$：$p_1 > 0$ 和 $p_1 p_3 > 0$，这意味着 $p_3 > 0$。\n$2.$ 从 $A_1^{\\top}P+PA_1 \\prec 0$：$p_1 > 0$ 和 $8p_1 p_3 > 0$，这已被覆盖。\n$3.$ 从 $A_2^{\\top}P+PA_2 \\prec 0$：\n$$ 2p_1 > 0 $$\n$$ (2p_1)(4p_3) - (p_1 - 3p_3)^2 > 0 $$\n第一部分是多余的。第二个不等式是：\n$$ 8p_1 p_3 - (p_1^2 - 6p_1 p_3 + 9p_3^2) > 0 $$\n$$ -p_1^2 + 14p_1 p_3 - 9p_3^2 > 0 $$\n$$ p_1^2 - 14p_1 p_3 + 9p_3^2  0 $$\n由于 $p_3 > 0$，我们可以两边除以 $p_3^2$ 来得到关于比率 $r = p_1/p_3$ 的不等式：\n$$ r^2 - 14r + 9  0 $$\n二次方程 $r^2 - 14r + 9 = 0$ 的根是 $r = 7 \\pm 2\\sqrt{10}$。当 $r$ 在这两个根之间时，不等式成立：\n$$ 7 - 2\\sqrt{10}  \\frac{p_1}{p_3}  7 + 2\\sqrt{10} $$\n数值上，这个范围大约是 $(0.675, 13.325)$。此区间内的任何比率都将产生一个有效的对角解。最简单的选择是 $p_1/p_3 = 1$，这表明可以设置 $p_1 = p_3$。我们选择 $p_1=p_3=1$。这给出了候选矩阵 $P=I$，即 $2 \\times 2$ 单位矩阵。\n\n我们现在严格验证这个候选解 $P = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n1.  $P = I$ 是对称的。它的特征值均为 $1$，因此是正定的。第一个条件满足。\n\n2.  检查 $A_1^{\\top}P + PA_1 \\prec 0$：\n$$ A_1^{\\top}I + IA_1 = A_1^{\\top} + A_1 = \\begin{pmatrix} -2  0 \\\\ 0  -1 \\end{pmatrix} + \\begin{pmatrix} -2  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} -4  0 \\\\ 0  -2 \\end{pmatrix} $$\n该矩阵是对角矩阵，特征值为 $-4$ 和 $-2$。由于两者都为负，该矩阵是负定的。第二个条件满足。\n\n3.  检查 $A_2^{\\top}P + PA_2 \\prec 0$：\n$$ A_2^{\\top}I + IA_2 = A_2^{\\top} + A_2 = \\begin{pmatrix} -1  -3 \\\\ 1  -2 \\end{pmatrix} + \\begin{pmatrix} -1  1 \\\\ -3  -2 \\end{pmatrix} = \\begin{pmatrix} -2  -2 \\\\ -2  -4 \\end{pmatrix} $$\n为了检查这个矩阵（我们称之为 $Q$）是否是负定的，我们使用西尔维斯特准则检查其顺序主子式，以判断 $-Q$ 是否是正定的。\n$$ -Q = \\begin{pmatrix} 2  2 \\\\ 2  4 \\end{pmatrix} $$\n第一个主子式是 $2 > 0$。\n第二个主子式是 $\\det(-Q) = (2)(4) - (2)(2) = 8 - 4 = 4 > 0$。\n由于所有顺序主子式都为正，$-Q$ 是正定的，这意味着 $Q$ 是负定的。第三个条件满足。\n\n所有必需条件均已满足。因此，$P = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$ 是一个有效的共同二次李雅普诺夫函数矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}}\n$$", "id": "2712026"}]}