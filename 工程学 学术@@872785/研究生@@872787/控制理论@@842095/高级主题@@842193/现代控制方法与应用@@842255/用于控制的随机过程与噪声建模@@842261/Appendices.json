{"hands_on_practices": [{"introduction": "奥恩斯坦-乌伦贝克（Ornstein-Uhlenbeck）过程是随机过程理论中的一个基石模型，它完美地描述了一个受持续白噪声扰动的稳定一阶系统。这个练习将带你深入该过程的核心，通过应用伊藤积分和伊藤乘积法则，你不仅能推导出其解析解，还能计算其均值和方差的动态演变。掌握这一过程的稳态特性对于理解噪声如何在稳定系统中达到能量平衡至关重要，这是噪声建模与控制设计的基础。[@problem_id:2750107]", "problem": "考虑用于控制中噪声建模的连续时间线性时不变 (LTI) 随机状态模型，\n$$\ndX_t = -a\\,X_t\\,dt + \\sigma\\,dW_t,\\quad t \\ge 0,\n$$\n其中 $a0$, $\\sigma0$, $X_0$ 与 Wiener 过程 (Brownian 运动) $W_t$ 独立，并且 $\\mathbb{E}[X_0^2]  \\infty$。这是一个标准的一维 Ornstein–Uhlenbeck 过程，用于建模由过程噪声驱动的稳定一阶模态。\n\n1) 仅从 It\\^o 乘积法则和 It\\^o 积分的定义出发，推导 $X_t$ 关于 $X_0$ 和 $W_t$ 的显式解。\n\n2) 利用 It\\^o 积分的性质和独立性假设，计算对所有 $t\\ge 0$ 的 $\\mathbb{E}[X_t]$ 和 $\\mathbb{E}[X_t^2]$。\n\n3) 确定极限\n$$\n\\lim_{t\\to\\infty}\\mathbb{E}[X_t^2],\n$$\n并解释为什么这个极限代表了该稳定噪声驱动模态在宽平稳意义下的稳态方差。\n\n将您的最终答案表示为关于 $a$ 和 $\\sigma$ 的单个闭式解析表达式。无需四舍五入，也无需单位。", "solution": "我们使用 It\\^o 微积分的基本工具来分析给定的随机微分方程。方程\n$$\ndX_t = -a\\,X_t\\,dt + \\sigma\\,dW_t,\\quad a0,\\ \\sigma0,\n$$\n是线性的。求解线性随机微分方程的一种标准方法是使用积分因子并结合 It\\^o 乘积法则。定义确定性积分因子 $M_t = \\exp(a t)$。根据应用于 $M_t X_t$ 的 It\\^o 乘积法则，\n$$\nd\\big(M_t X_t\\big) = M_t\\,dX_t + X_t\\,dM_t + d\\langle M, X\\rangle_t.\n$$\n因为 $M_t=\\exp(a t)$ 是有界变差的，所以 $d\\langle M, X\\rangle_t=0$，且 $dM_t = a\\,M_t\\,dt$。代入 $dX_t$ 可得\n$$\nd\\big(M_t X_t\\big) = M_t\\big(-a\\,X_t\\,dt + \\sigma\\,dW_t\\big) + X_t\\,a\\,M_t\\,dt\n= \\sigma\\,M_t\\,dW_t.\n$$\n从 $0$ 到 $t$ 积分，\n$$\nM_t X_t - M_0 X_0 = \\sigma \\int_0^t M_s\\,dW_s.\n$$\n由于 $M_0=\\exp(0)=1$，我们得到显式解\n$$\nX_t = \\exp(-a t)\\,X_0 + \\sigma \\int_0^t \\exp\\big(-a (t-s)\\big)\\,dW_s.\n$$\n\n我们现在计算一阶矩和二阶矩。利用期望的线性性质以及 It\\^o 积分的均值为零这一事实，\n$$\n\\mathbb{E}[X_t] = \\exp(-a t)\\,\\mathbb{E}[X_0] + \\sigma\\,\\mathbb{E}\\!\\left[\\int_0^t \\exp\\big(-a (t-s)\\big)\\,dW_s\\right]\n= \\exp(-a t)\\,\\mathbb{E}[X_0].\n$$\n\n对于二阶矩，我们写出\n$$\nX_t = A_t + B_t,\\quad A_t \\coloneqq \\exp(-a t)\\,X_0,\\quad B_t \\coloneqq \\sigma \\int_0^t \\exp\\big(-a (t-s)\\big)\\,dW_s.\n$$\n那么\n$$\n\\mathbb{E}[X_t^2] = \\mathbb{E}[A_t^2] + 2\\,\\mathbb{E}[A_t B_t] + \\mathbb{E}[B_t^2].\n$$\n我们分别处理每一项：\n\n- 对于 $A_t^2$，\n$$\n\\mathbb{E}[A_t^2] = \\exp(-2 a t)\\,\\mathbb{E}[X_0^2].\n$$\n\n- 对于交叉项，利用 $X_0$ 和 $(W_s)_{s\\ge 0}$ 的独立性，以及在给定 $X_0$ 的条件下 It\\^o 积分的均值为零这一事实：\n$$\n\\mathbb{E}[A_t B_t] = \\exp(-a t)\\,\\sigma\\,\\mathbb{E}\\!\\left[X_0 \\int_0^t \\exp\\big(-a (t-s)\\big)\\,dW_s\\right]\n= \\exp(-a t)\\,\\sigma\\,\\mathbb{E}\\!\\left[ X_0\\,\\mathbb{E}\\!\\left[\\left.\\int_0^t \\exp\\big(-a (t-s)\\big)\\,dW_s\\,\\right|\\,X_0\\right]\\right] = 0.\n$$\n\n- 对于 $B_t^2$，应用 It\\^o 等距性：\n$$\n\\mathbb{E}[B_t^2] = \\sigma^2\\,\\mathbb{E}\\!\\left[\\left(\\int_0^t \\exp\\big(-a (t-s)\\big)\\,dW_s\\right)^2\\right]\n= \\sigma^2 \\int_0^t \\exp\\big(-2 a (t-s)\\big)\\,ds.\n$$\n通过变量替换 $u=t-s$ 来计算该积分：\n$$\n\\int_0^t \\exp\\big(-2 a (t-s)\\big)\\,ds = \\int_0^t \\exp(-2 a u)\\,du = \\frac{1 - \\exp(-2 a t)}{2 a}.\n$$\n\n合并各项，\n$$\n\\mathbb{E}[X_t^2] = \\exp(-2 a t)\\,\\mathbb{E}[X_0^2] + \\sigma^2\\,\\frac{1 - \\exp(-2 a t)}{2 a}.\n$$\n\n现在取 $t\\to\\infty$ 的极限。因为 $a0$，所以 $\\exp(-2 a t)\\to 0$，因此\n$$\n\\lim_{t\\to\\infty} \\mathbb{E}[X_t^2] = \\sigma^2\\,\\frac{1}{2 a}.\n$$\n\n在控制背景下对平稳性的解释：漂移系数 $a0$ 意味着底层确定性模态的指数稳定性。强度为 $\\sigma$ 的加性白噪声输入驱动着持续的波动，其能量受到速率为 $a$ 的耗散所限制。极限二阶矩是稳态方差，即唯一不变 Gaussian 分布下的方差。更准确地说，该过程依分布收敛于一个均值为零、方差为 $\\sigma^2/(2 a)$ 的 Gaussian 分布，并且协方差函数变为时移不变的，其极限形式为 $\\mathrm{Cov}(X_{t},X_{t+\\tau}) = (\\sigma^2/(2 a))\\exp(-a|\\tau|)$。因此，$\\mathbb{E}[X_t^2]$ 的有限极限验证了稳态下的二阶平稳性，所需的稳态方差为 $\\sigma^2/(2 a)$。", "answer": "$$\\boxed{\\frac{\\sigma^2}{2 a}}$$", "id": "2750107"}, {"introduction": "从分析单个随机模式，我们现在转向评估整个线性时不变（LTI）系统对噪声的响应。一个核心的性能指标是当系统受到白噪声输入时，其稳态输出的方差大小。这个练习将理论与实践相结合，它揭示了系统传递函数的$H_{2}$范数与输出方差之间的深刻联系，并指导你使用状态空间方法——特别是通过求解李雅普诺夫（Lyapunov）方程来计算可控性格拉姆（Gramian）矩阵——来精确量化这一关键性能指标。[@problem_id:2750143]", "problem": "考虑一个稳定的、严格真分数的、单输入单输出 (SISO) 连续时间线性时不变 (LTI) 系统，其传递函数为 $G(s)$。输入 $w(t)$ 是一个零均值、宽平稳的单位强度白高斯噪声。采用角频率约定，其中平稳过程 $x(t)$ 的功率谱密度 $S_{x}(\\omega)$ 是其自相关函数 $R_{x}(\\tau)$ 的傅里叶变换（无归一化因子），因此 $R_{x}(0) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} S_{x}(\\omega)\\, d\\omega$。\n\n1. 从谱量的线性时不变性定义和 Wiener–Khinchin 定理出发，当输入是给定的白噪声时，推导稳态输出方差 $\\sigma_{y}^{2}$ 关于 $G(\\mathrm{j}\\omega)$ 的表达式。利用此推导，用 $|G(\\mathrm{j}\\omega)|^{2}$ 的积分来确定 $G(s)$ 的 Hardy 空间 $H_{2}$ 范数 $\\lVert G\\rVert_{2}$，并解释在所述约定下为什么 $\\sigma_{y}^{2} = \\lVert G\\rVert_{2}^{2}$。\n\n2. 现在考虑具体的最小实现\n$$\nA=\\begin{bmatrix}-2  -1\\\\ 1  -3\\end{bmatrix},\\quad\nB=\\begin{bmatrix}1\\\\ 2\\end{bmatrix},\\quad\nC=\\begin{bmatrix}1  0\\end{bmatrix},\\quad\nD=\\begin{bmatrix}0\\end{bmatrix},\n$$\n其定义了 $G(s)=C(sI-A)^{-1}B+D$。仅使用第一性原理和关于能控性 Gramian 矩阵及其与稳定 LTI 系统输出能量关系的成熟结论，计算单位强度白噪声输入下的稳态输出方差 $\\sigma_{y}^{2}$ 的精确值。\n\n将最终数值答案表示为一个精确的、无单位的既约分数。无需进行四舍五入。", "solution": "**第 1 部分：输出方差的推导及其与 $H_{2}$ 范数的关系**\n\n输入 $w(t)$ 是一个单位强度的宽平稳白噪声过程。根据定义，其自相关函数是一个 Dirac δ函数：\n$$\nR_{w}(\\tau) = E[w(t+\\tau)w(t)] = 1 \\cdot \\delta(\\tau) = \\delta(\\tau)\n$$\n功率谱密度 $S_{w}(\\omega)$ 是自相关函数的傅里叶变换。所采用的约定使用角频率 $\\omega$。\n$$\nS_{w}(\\omega) = \\int_{-\\infty}^{\\infty} R_{w}(\\tau) \\exp(-\\mathrm{j}\\omega\\tau) \\,d\\tau = \\int_{-\\infty}^{\\infty} \\delta(\\tau) \\exp(-\\mathrm{j}\\omega\\tau) \\,d\\tau = 1\n$$\n对于一个传递函数为 $G(s)$ 的稳定 LTI 系统，输出的功率谱密度 $S_{y}(\\omega)$ 与输入的功率谱密度 $S_{w}(\\omega)$ 通过以下公式相关联：\n$$\nS_{y}(\\omega) = |G(\\mathrm{j}\\omega)|^{2} S_{w}(\\omega)\n$$\n代入 $S_{w}(\\omega) = 1$，我们得到输出功率谱密度：\n$$\nS_{y}(\\omega) = |G(\\mathrm{j}\\omega)|^{2}\n$$\n输入噪声 $w(t)$ 是零均值的。由于系统是线性的，输出 $y(t)$ 也是零均值的。因此，稳态输出方差 $\\sigma_{y}^{2}$ 等于输出的均方值 $E[y(t)^{2}]$，也就是零延迟时的输出自相关值 $R_{y}(0)$。\n$$\n\\sigma_{y}^{2} = E[y(t)^{2}] = R_{y}(0)\n$$\n根据指定约定下的 Wiener-Khinchin 定理，自相关函数是功率谱密度的傅里叶逆变换，并乘以比例因子 $\\frac{1}{2\\pi}$：\n$$\nR_{y}(\\tau) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{y}(\\omega) \\exp(\\mathrm{j}\\omega\\tau) \\,d\\omega\n$$\n令 $\\tau=0$ 得到方差：\n$$\n\\sigma_{y}^{2} = R_{y}(0) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{y}(\\omega) \\,d\\omega\n$$\n代入 $S_{y}(\\omega)$ 的表达式：\n$$\n\\sigma_{y}^{2} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |G(\\mathrm{j}\\omega)|^{2} \\,d\\omega\n$$\n对于一个稳定的真分数系统 $G(s)$，Hardy 空间 $H_{2}$ 范数定义为：\n$$\n\\lVert G\\rVert_{2} = \\sqrt{\\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |G(\\mathrm{j}\\omega)|^{2} \\,d\\omega}\n$$\n通过比较 $\\sigma_{y}^{2}$ 和 $\\lVert G\\rVert_{2}$ 的表达式，可以立即看出，稳态输出方差是系统传递函数 $H_{2}$ 范数的平方：\n$$\n\\sigma_{y}^{2} = \\lVert G\\rVert_{2}^{2}\n$$\n\n**第 2 部分：使用 Gramian 矩阵计算输出方差**\n\n该问题要求使用关于给定状态空间实现 $(A, B, C, D)$ 的能控性 Gramian 矩阵的结论来计算 $\\sigma_{y}^{2} = \\lVert G\\rVert_{2}^{2}$。对于一个 $D=0$ 的稳定 LTI 系统，$H_{2}$ 范数的平方可以使用能控性 Gramian 矩阵 $W_{c}$ 或能观性 Gramian 矩阵 $W_{o}$ 来计算。本题指定使用能控性 Gramian 矩阵。相关公式为：\n$$\n\\sigma_{y}^{2} = \\lVert G\\rVert_{2}^{2} = \\mathrm{Tr}(C W_{c} C^{T})\n$$\n其中 $W_{c}$ 是能控性 Lyapunov 方程的唯一、对称、正定解：\n$$\nA W_{c} + W_{c} A^{T} + B B^{T} = 0\n$$\n系统矩阵为：\n$$\nA=\\begin{bmatrix}-2  -1\\\\ 1  -3\\end{bmatrix}, \\quad B=\\begin{bmatrix}1\\\\ 2\\end{bmatrix}, \\quad C=\\begin{bmatrix}1  0\\end{bmatrix}\n$$\n首先，我们计算 $B B^{T}$：\n$$\nB B^{T} = \\begin{bmatrix}1\\\\ 2\\end{bmatrix} \\begin{bmatrix}1  2\\end{bmatrix} = \\begin{bmatrix}1  2\\\\ 2  4\\end{bmatrix}\n$$\n设对称矩阵 $W_{c}$ 参数化为：\n$$\nW_{c} = \\begin{bmatrix}q_{1}  q_{2}\\\\ q_{2}  q_{3}\\end{bmatrix}\n$$\n代入 Lyapunov 方程：\n$$\n\\begin{bmatrix}-2  -1\\\\ 1  -3\\end{bmatrix} \\begin{bmatrix}q_{1}  q_{2}\\\\ q_{2}  q_{3}\\end{bmatrix} + \\begin{bmatrix}q_{1}  q_{2}\\\\ q_{2}  q_{3}\\end{bmatrix} \\begin{bmatrix}-2  1\\\\ -1  -3\\end{bmatrix} + \\begin{bmatrix}1  2\\\\ 2  4\\end{bmatrix} = \\begin{bmatrix}0  0\\\\ 0  0\\end{bmatrix}\n$$\n进行矩阵乘法：\n$$\n\\begin{bmatrix}-2q_{1}-q_{2}  -2q_{2}-q_{3}\\\\ q_{1}-3q_{2}  q_{2}-3q_{3}\\end{bmatrix} + \\begin{bmatrix}-2q_{1}-q_{2}  q_{1}-3q_{2}\\\\ -2q_{2}-q_{3}  q_{2}-3q_{3}\\end{bmatrix} + \\begin{bmatrix}1  2\\\\ 2  4\\end{bmatrix} = \\begin{bmatrix}0  0\\\\ 0  0\\end{bmatrix}\n$$\n逐元素相加矩阵：\n$$\n\\begin{bmatrix}-4q_{1}-2q_{2}+1  q_{1}-5q_{2}-q_{3}+2\\\\ q_{1}-5q_{2}-q_{3}+2  2q_{2}-6q_{3}+4\\end{bmatrix} = \\begin{bmatrix}0  0\\\\ 0  0\\end{bmatrix}\n$$\n这产生了一个关于 $q_{1}$、$q_{2}$ 和 $q_{3}$ 的三元线性方程组：\n1. $-4q_{1} - 2q_{2} + 1 = 0$\n2. $q_{1} - 5q_{2} - q_{3} + 2 = 0$\n3. $2q_{2} - 6q_{3} + 4 = 0$\n\n从方程 (3) 中，我们简化得到 $q_{2} - 3q_{3} + 2 = 0$，即 $q_{2} = 3q_{3} - 2$。\n将此代入方程 (1)：\n$-4q_{1} - 2(3q_{3} - 2) + 1 = 0 \\implies -4q_{1} - 6q_{3} + 4 + 1 = 0 \\implies 4q_{1} + 6q_{3} = 5$。\n将 $q_{2}$ 代入方程 (2)：\n$q_{1} - 5(3q_{3} - 2) - q_{3} + 2 = 0 \\implies q_{1} - 15q_{3} + 10 - q_{3} + 2 = 0 \\implies q_{1} - 16q_{3} + 12 = 0 \\implies q_{1} = 16q_{3} - 12$。\n现在将 $q_{1}$ 的这个表达式代入方程 $4q_{1} + 6q_{3} = 5$ 中：\n$4(16q_{3} - 12) + 6q_{3} = 5 \\implies 64q_{3} - 48 + 6q_{3} = 5 \\implies 70q_{3} = 53 \\implies q_{3} = \\frac{53}{70}$。\n现在我们可以求出 $q_{1}$：\n$q_{1} = 16\\left(\\frac{53}{70}\\right) - 12 = \\frac{8 \\cdot 53}{35} - 12 = \\frac{424}{35} - \\frac{420}{35} = \\frac{4}{35}$。\n我们在最终计算中不需要 $q_{2}$，但为了完整起见，$q_{2} = 3\\left(\\frac{53}{70}\\right) - 2 = \\frac{159}{70} - \\frac{140}{70} = \\frac{19}{70}$。\n\n能控性 Gramian 矩阵为 $W_{c} = \\begin{bmatrix}4/35  19/70\\\\ 19/70  53/70\\end{bmatrix}$。\n输出方差为 $\\sigma_{y}^{2} = \\mathrm{Tr}(C W_{c} C^{T})$。\n$$\nC W_{c} C^{T} = \\begin{bmatrix}1  0\\end{bmatrix} \\begin{bmatrix}4/35  19/70\\\\ 19/70  53/70\\end{bmatrix} \\begin{bmatrix}1\\\\ 0\\end{bmatrix} = \\begin{bmatrix}4/35  19/70\\end{bmatrix} \\begin{bmatrix}1\\\\ 0\\end{bmatrix} = \\frac{4}{35}\n$$\n这个 $1 \\times 1$ 矩阵（一个标量）的迹就是它本身的值。\n$$\n\\sigma_{y}^{2} = \\mathrm{Tr}\\left(\\frac{4}{35}\\right) = \\frac{4}{35}\n$$\n稳态输出方差是一个精确的既约分数，符合要求。", "answer": "$$\\boxed{\\frac{4}{35}}$$", "id": "2750143"}, {"introduction": "理论模型是优雅的，但实际的控制器和估计器（如卡尔曼滤波器）都在数字计算机上以离散时间方式运行。将连续时间随机微分方程（SDE）转化为离散时间模型是实现中的关键一步，而简单的方法可能引入系统性偏差。这个动手编码练习将让你直面这一挑战，通过比较常用的欧拉-丸山（Euler-Maruyama）法与精确离散化，你将量化过程噪声协方差的偏差，并理解这对状态估计精度的影响，这对于开发高保真度的控制与估计算法至关重要。[@problem_id:2750135]", "problem": "考虑一个过程 $x(t)$ 在连续时间下的标量线性随机微分方程（SDE）：\n$$\ndx(t) = A\\,x(t)\\,dt + G\\,dW(t),\n$$\n其中 $A \\in \\mathbb{R}$ 是严格稳定的（即 $A  0$），$G \\in \\mathbb{R}$ 是一个恒定的标量输入增益，$W(t)$ 是一个标量维纳过程，其扩散强度建模为 $\\mathbb{E}[dW(t)\\,dW(t)] = q_c\\,dt$，其中 $q_c \\ge 0$ 是一个给定的常数。在采样时间 $h  0$ 下的精确离散时间等价形式为\n$$\nx_{k+1} = \\Phi\\,x_k + v_k,\\quad \\Phi = e^{A h},\\quad v_k \\sim \\mathcal{N}(0,Q_d),\n$$\n其中\n$$\nQ_d = \\int_0^h e^{A \\tau}\\,G\\,q_c\\,G\\,e^{A \\tau}\\,d\\tau = G^2\\,q_c\\,\\frac{e^{2Ah}-1}{2A}\\quad \\text{当 }A \\ne 0,\n$$\n当 $A=0$ 时，$Q_d = G^2 q_c\\,h$。相比之下，欧拉-丸山（Euler–Maruyama）离散化得到\n$$\nx_{k+1} = F\\,x_k + \\sqrt{h}\\,G\\,\\eta_k,\\quad F = 1 + hA,\\quad \\eta_k \\sim \\mathcal{N}(0,q_c),\n$$\n这对应于一个离散时间过程噪声协方差\n$$\nQ_d^{\\mathrm{EM}} = h\\,G^2\\,q_c.\n$$\n对于给定的先验协方差 $P_k \\ge 0$，精确传播和欧拉-丸山传播的一步协方差传播公式分别为\n$$\nP_{k+1}^{\\mathrm{exact}} = \\Phi^2\\,P_k + Q_d,\\qquad P_{k+1}^{\\mathrm{EM}} = F^2\\,P_k + Q_d^{\\mathrm{EM}}.\n$$\n您的任务是，对于标量稳定系统（即 $A$ 为稳定的标量），比较步长为 $h$ 的欧拉-丸山离散化与精确离散化所引起的协方差传播误差，并量化 $Q_d$ 中的偏差。具体来说，对于每个具有参数 $(A,h,G,q_c,P_k)$ 的测试用例，计算：\n- 过程噪声偏差\n$$\n\\Delta Q \\equiv Q_d^{\\mathrm{EM}} - Q_d,\n$$\n- 一步协方差传播误差\n$$\n\\Delta P \\equiv P_{k+1}^{\\mathrm{EM}} - P_{k+1}^{\\mathrm{exact}} = \\left(F^2 - \\Phi^2\\right)P_k + \\Delta Q,\n$$\n- 归一化一阶偏差比\n$$\n\\rho \\equiv \\frac{\\Delta Q}{h^2\\,(-A)\\,G^2\\,q_c}\\quad \\text{当 }A \\ne 0,\n$$\n并当 $A=0$ 时定义 $\\rho = \\mathrm{NaN}$。比率 $\\rho$ 用于检验当 $h \\to 0$ 时的渐近偏差预测 $\\Delta Q \\approx -A\\,G^2\\,q_c\\,h^2$。\n\n仅使用此处给出的标量公式和随机微积分的标准定义。推导必须从连续时间SDE开始，通过严格的离散化和协方差传播进行，避免使用任何未经证明的捷径。\n\n测试套件：\n- 用例1（一般情况）：$(A,h,G,q_c,P_k) = (-0.7,\\,0.2,\\,1.5,\\,0.8,\\,1.1)$。\n- 用例2（小步长渐近性）：$(A,h,G,q_c,P_k) = (-0.7,\\,10^{-4},\\,1.5,\\,0.8,\\,1.1)$。\n- 用例3（近零漂移）：$(A,h,G,q_c,P_k) = (-10^{-10},\\,0.2,\\,1.5,\\,0.8,\\,1.1)$。\n- 用例4（刚性动力学）：$(A,h,G,q_c,P_k) = (-5.0,\\,0.05,\\,0.7,\\,2.0,\\,3.0)$。\n\n要求：\n- 实现一个程序，对每个测试用例，使用精确的 $Q_d$（并安全地处理 $A \\to 0$ 的极限情况）计算三元组 $[\\Delta Q,\\,\\Delta P,\\,\\rho]$。\n- 输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身也是 $[\\Delta Q, \\Delta P, \\rho]$ 形式的列表。例如，一个有效的输出形式为 “[[a,b,c],[d,e,f],[g,h,i],[j,k,l]]”，其中包含数值条目。\n- 在此问题中，所有量均为无量纲标量。", "solution": "该问题要求对一个标量线性随机微分方程（SDE）在两种离散化方案下的协方差传播进行定量比较：精确方法和一阶欧拉-丸山（Euler-Maruyama）方法。我们需要评估过程噪声协方差的差异以及由此产生的一步状态协方差传播误差。\n\n连续时间动力学由以下SDE给出：\n$$\ndx(t) = A\\,x(t)\\,dt + G\\,dW(t)\n$$\n其中 $A  0$ 是一个稳定的漂移系数，$G$ 是一个输入增益，$W(t)$ 是一个维纳过程，其扩散强度为 $q_c$，使得增量方差为 $\\mathbb{E}[(dW(t))^2] = q_c\\,dt$。\n\n首先，我们考虑在时间步长 $h$ 上的精确离散化。SDE的齐次部分 $dx(t) = A\\,x(t)\\,dt$ 的解是 $x(t) = e^{A(t-t_0)} x(t_0)$。对完整的SDE使用常数变易法，给定 $t_k$ 时刻的状态，在 $t_k+h$ 时刻的解为：\n$$\nx(t_k+h) = e^{Ah} x(t_k) + \\int_{t_k}^{t_k+h} e^{A(t_k+h - \\tau)} G\\,dW(\\tau)\n$$\n令 $x_k \\equiv x(t_k)$。那么我们得到离散时间模型：\n$$\nx_{k+1} = \\Phi\\,x_k + v_k\n$$\n其中状态转移为 $\\Phi = e^{Ah}$，过程噪声项为 $v_k = \\int_{0}^{h} e^{A(h - s)} G\\,dW(t_k+s)$。噪声过程 $v_k$ 是一个零均值高斯随机变量，因为它是高斯过程的线性变换。其协方差 $Q_d$ 通过伊藤等距定理（Itō isometry）计算：\n$$\nQ_d = \\mathbb{E}[v_k^2] = \\mathbb{E}\\left[\\left(\\int_0^h e^{A(h-\\tau)} G\\,dW(\\tau)\\right)^2\\right] = \\int_0^h \\left(e^{A(h-\\tau)} G\\right)^2 q_c\\,d\\tau\n$$\n由于所有项都是标量，这可以简化。令 $s = h-\\tau$，则 $ds = -d\\tau$。积分限从 $\\tau=0 \\to h$ 变为 $s=h \\to 0$。\n$$\nQ_d = G^2 q_c \\int_h^0 e^{2As} (-ds) = G^2 q_c \\int_0^h e^{2As}\\,ds\n$$\n对于 $A \\ne 0$，该积分的计算结果为：\n$$\nQ_d = G^2 q_c \\left[ \\frac{e^{2As}}{2A} \\right]_0^h = G^2 q_c \\frac{e^{2Ah}-1}{2A}\n$$\n在 $A \\to 0$ 的极限情况下，我们使用洛必达法则（L'Hôpital's rule）或指数的泰勒级数展开 $e^{2Ah} \\approx 1 + 2Ah$。这得到：\n$$\n\\lim_{A \\to 0} Q_d = G^2 q_c \\lim_{A \\to 0} \\frac{2h e^{2Ah}}{2} = G^2 q_c h\n$$\n这对应于随机游走积分的情况。\n\n接下来，我们分析欧拉-丸山离散化。该方法通过将系数在区间 $[t_k, t_k+h]$ 上视为常数来近似SDE：\n$$\nx_{k+1} \\approx x_k + (A x_k) h + G (W(t_{k+1}) - W(t_k))\n$$\n这给出了离散时间模型：\n$$\nx_{k+1} = F\\,x_k + w_k^{\\mathrm{EM}}\n$$\n其中近似的状态转移为 $F = 1 + Ah$，噪声项为 $w_k^{\\mathrm{EM}} = G\\,\\Delta W_k$，其中 $\\Delta W_k = W(t_{k+1}) - W(t_k)$。该噪声项的协方差 $Q_d^{\\mathrm{EM}}$ 是：\n$$\nQ_d^{\\mathrm{EM}} = \\mathbb{E}[(w_k^{\\mathrm{EM}})^2] = G^2 \\mathbb{E}[(\\Delta W_k)^2] = G^2 q_c h\n$$\n这是真实离散过程噪声协方差的一阶近似。\n\n有了这些公式，我们就可以处理所要求的具体量了。\n\n过程噪声偏差 $\\Delta Q$ 是近似离散噪声协方差与精确离散噪声协方差之差：\n$$\n\\Delta Q \\equiv Q_d^{\\mathrm{EM}} - Q_d = G^2 q_c h - G^2 q_c \\frac{e^{2Ah}-1}{2A} = G^2 q_c \\left(h - \\frac{e^{2Ah}-1}{2A}\\right)\n$$\n此公式在 $A \\ne 0$ 时有效。当 $A=0$ 时，两个协方差均为 $G^2 q_c h$，因此 $\\Delta Q = 0$。为了在 $A$ 接近零时保持数值稳定性，必须使用能够精确计算小 $x$ 的 $e^x-1$ 的库函数。\n\n一步协方差传播误差 $\\Delta P$ 比较了使用两种方法从先验 $P_k$ 更新的状态协方差。传播方程为：\n$$\nP_{k+1}^{\\mathrm{exact}} = \\Phi^2 P_k + Q_d = (e^{Ah})^2 P_k + Q_d\n$$\n$$\nP_{k+1}^{\\mathrm{EM}} = F^2 P_k + Q_d^{\\mathrm{EM}} = (1+Ah)^2 P_k + Q_d^{\\mathrm{EM}}\n$$\n误差是其差值：\n$$\n\\Delta P = P_{k+1}^{\\mathrm{EM}} - P_{k+1}^{\\mathrm{exact}} = \\left( (1+Ah)^2 - (e^{Ah})^2 \\right) P_k + (Q_d^{\\mathrm{EM}} - Q_d)\n$$\n$$\n\\Delta P = \\left( F^2 - \\Phi^2 \\right) P_k + \\Delta Q\n$$\n\n最后，我们分析归一化一阶偏差比 $\\rho$。该比率的目的是验证噪声偏差 $\\Delta Q$ 在小 $h$ 下的渐近行为。对 $\\Delta Q$ 中的指数项使用泰勒级数展开：\n$$\ne^{2Ah} = 1 + 2Ah + \\frac{(2Ah)^2}{2!} + \\frac{(2Ah)^3}{3!} + O(h^4) = 1 + 2Ah + 2A^2h^2 + \\frac{4}{3}A^3h^3 + O(h^4)\n$$\n将此代入 $Q_d$ 的表达式中：\n$$\nQ_d = G^2 q_c \\frac{(1 + 2Ah + 2A^2h^2 + O(h^3)) - 1}{2A} = G^2 q_c (h + Ah^2 + O(h^3))\n$$\n那么偏差 $\\Delta Q$ 是：\n$$\n\\Delta Q = G^2 q_c h - G^2 q_c (h + Ah^2 + O(h^3)) = -A G^2 q_c h^2 + O(h^3)\n$$\n问题指出，对于小 $h$，该偏差近似为 $\\Delta Q \\approx -A\\,G^2\\,q_c\\,h^2$。我们的推导证实了这一主阶项。比率 $\\rho$ 被定义为对该偏差进行归一化：\n$$\n\\rho \\equiv \\frac{\\Delta Q}{h^2\\,(-A)\\,G^2\\,q_c}\n$$\n当 $h \\to 0$ 时，我们预期 $\\rho \\to 1$。对于 $A=0$，分母为零，因此 $\\rho$ 未定义，此处指定为非数值（NaN）。\n\n实现时需要小心处理 $A \\approx 0$ 的情况，以避免分数分子中的灾难性抵消和除以一个小数。使用 `numpy.expm1(2*A*h)` 是正确的数值处理方法。\n\n将对每个测试用例执行以下计算：\n1.  计算 $\\Phi = e^{Ah}$ 和 $F = 1+Ah$。\n2.  计算 $Q_d^{\\mathrm{EM}} = h G^2 q_c$。\n3.  计算 $Q_d$：如果 $A=0$，$Q_d = Q_d^{\\mathrm{EM}}$；否则，$Q_d = G^2 q_c (e^{2Ah}-1)/(2A)$。\n4.  计算 $\\Delta Q = Q_d^{\\mathrm{EM}} - Q_d$。\n5.  计算 $\\Delta P = (F^2 - \\Phi^2)P_k + \\Delta Q$。\n6.  计算 $\\rho$：如果 $A=0$，$\\rho=\\text{NaN}$；否则，$\\rho = \\Delta Q / (h^2 (-A) G^2 q_c)$。\n\n这些计算将为指定的测试用例提供所需的三元组 $[\\Delta Q, \\Delta P, \\rho]$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the covariance propagation error between exact and Euler-Maruyama\n    discretizations for a scalar linear SDE.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general happy path): (A, h, G, q_c, P_k)\n        (-0.7, 0.2, 1.5, 0.8, 1.1),\n        # Case 2 (small-step asymptotics): (A, h, G, q_c, P_k)\n        (-0.7, 1e-4, 1.5, 0.8, 1.1),\n        # Case 3 (near-zero drift): (A, h, G, q_c, P_k)\n        (-1e-10, 0.2, 1.5, 0.8, 1.1),\n        # Case 4 (stiff dynamics): (A, h, G, q_c, P_k)\n        (-5.0, 0.05, 0.7, 2.0, 3.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        A, h, G, q_c, P_k = case\n\n        # Exact discretization parameters\n        Phi = np.exp(A * h)\n\n        # Euler-Maruyama discretization parameters\n        F = 1.0 + A * h\n        Qd_EM = h * (G**2) * q_c\n\n        # Calculate exact discrete noise covariance Qd\n        # Use a safe method for A approaching zero to avoid numerical instability.\n        if A == 0.0:\n            # The limit as A approaches 0\n            Qd = h * (G**2) * q_c\n        else:\n            # Use np.expm1 for precision with small arguments\n            # expm1(x) computes exp(x) - 1\n            # Qd = G^2 * q_c * (exp(2*A*h) - 1) / (2*A)\n            Qd = (G**2) * q_c * np.expm1(2 * A * h) / (2 * A)\n\n        # 1. Compute the process noise bias\n        delta_Q = Qd_EM - Qd\n\n        # 2. Compute the one-step covariance propagation error\n        delta_P = (F**2 - Phi**2) * P_k + delta_Q\n\n        # 3. Compute the normalized first-order bias ratio\n        # Denominator for rho can be zero if A=0, G=0, or q_c=0. Problem states A  0.\n        if A == 0.0:\n            rho = np.nan\n        else:\n            denominator_rho = (h**2) * (-A) * (G**2) * q_c\n            if denominator_rho == 0:\n                # This case happens if G or qc are zero, resulting in a 0/0 form if delta_Q is also 0.\n                # If delta_Q has higher order terms, the limit might be non-trivial.\n                # Given problem constraints A != 0, h  0, qc = 0, G!=0 (implicitly),\n                # we consider the ratio to be undefined if the expected leading term is zero.\n                rho = np.nan\n            else:\n                rho = delta_Q / denominator_rho\n        \n        results.append([delta_Q, delta_P, rho])\n\n    # Format the final output string as specified\n    # The format \"[a,b,c]\" for each result can be achieved by f-string formatting\n    # of the inner list directly, but list-comprehension with str() is safer.\n    result_strings = [f\"[{','.join(map(str, res))}]\" for res in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2750135"}]}