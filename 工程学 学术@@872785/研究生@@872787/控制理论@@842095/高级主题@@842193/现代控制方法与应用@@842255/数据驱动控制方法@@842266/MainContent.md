## 引言
在数据无处不在的时代，我们如何能够直接利用海量的运行数据来控制复杂的动态系统，而无需事先构建一个精确的数学模型？[数据驱动控制](@entry_id:178277)方法为这一根本性问题提供了革命性的答案，它标志着从传统“基于模型”[范式](@entry_id:161181)向“基于数据”[范式](@entry_id:161181)的重要转变。传统控制理论的成功往往依赖于一个精确的、预先辨识的系统模型，但对于许多现代工程系统而言，建立这样的模型既昂贵又耗时，有时甚至是不可能的。[数据驱动控制](@entry_id:178277)旨在弥合这一鸿沟，探索直接从输入输出数据中设计高效、[鲁棒控制](@entry_id:260994)器的理论与方法。

本文将带领读者系统性地探索[数据驱动控制](@entry_id:178277)的核心世界。我们将从**第一章“原理与机制”**开始，深入挖掘该领域的理论基石——Jan C. Willems的基本引理，揭示其如何将数据矩阵转化为系统的“行为字典”。在此基础上，我们将学习其旗舰应用“数据使能的[预测控制](@entry_id:265552)（DeePC）”，并直面现实世界中不可避免的噪声与不确定性问题。接着，在**第二章“应用与交叉学科联系”**中，我们将视野拓宽至更广阔的应用场景，展示这些原理如何被用于高级[系统辨识](@entry_id:201290)、直接[控制器设计](@entry_id:274982)以及鲁棒与安[全控制](@entry_id:275827)。更进一步，我们将跨越学科边界，见证数据驱动思想如何在[材料科学](@entry_id:152226)、[过程控制](@entry_id:271184)和[生物工程](@entry_id:270890)等领域催生创新。最后，**“动手实践”**部分将提供一系列精心设计的练习，让您将理论付诸实践，加深理解。

让我们首先深入第一章，探究那些让数据本身成为模型的迷人原理。

## 原理与机制

本章旨在深入探讨[数据驱动控制](@entry_id:178277)方法的核心原理与基本机制。在前一章对该领域进行了概述之后，我们将在此系统性地构建其理论基础，从根本上阐明如何仅利用输入输出数据来表征、预测和控制未知动态系统的行为。我们将从Willems的基本引理出发，揭示其作为连接数据与系统行为的桥梁作用，并逐步探讨如何将这一理论原理应用于实际的[控制器设计](@entry_id:274982)，以及如何处理现实世界中不可避免的噪声和不确定性。最后，我们会将视野拓宽至超越轨迹预测的范畴，展示如何利用数据直接分析系统的内在属性，如耗散性。

### 基本原理：作为系统表示的数据

传统控制理论通常始于一个明确的数学模型，例如[状态空间方程](@entry_id:266994)或[传递函数](@entry_id:273897)。然而，行为系统理论（behavioral systems theory）提供了一个更为根本的视角：一个动态系统本质上是由其所有可能的输入输出轨迹（即其“行为”）所定义的集合。从这个角度看，核心问题转变为：我们能否仅通过一次实验观测到的有限数据，来完全刻画这个无限的行为集合？Jan C. Willems提出的基本引理对一类重要的系统——线性时不变（LTI）系统——给出了一个肯定的、且极其深刻的回答。

#### Willems基本引理

基本引理揭示了一个惊人的事实：对于一个可控的[LTI系统](@entry_id:271946)，其任何一段有限长度的轨迹，都可以通过对单次实验中记录的足够丰富的数据片段进行线性组合来精确复现。这一结论是[数据驱动控制](@entry_id:178277)的理论基石。

为了精确地陈述该引理，我们首先需要引入**Hankel矩阵**的概念。给定一个长度为$T$的离散时间序列$\{z_k\}_{k=0}^{T-1}$，其中$z_k \in \mathbb{R}^r$，其深度为$L$的Hankel矩阵$H_L(z)$是一个将该序列中所有长度为$L$的连续窗口作为列向量堆叠而成的矩阵：
$$
H_L(z) \triangleq 
\begin{pmatrix}
z_0 & z_1 & \cdots & z_{T-L} \\
z_1 & z_2 & \cdots & z_{T-L+1} \\
\vdots & \vdots & \ddots & \vdots \\
z_{L-1} & z_{L} & \cdots & z_{T-1}
\end{pmatrix} \in \mathbb{R}^{rL \times (T-L+1)}
$$
每一列都是原始数据的一个“快照”。现在，考虑一个未知的[离散时间LTI系统](@entry_id:188941)，其最小阶次为$n$，输入$u_k \in \mathbb{R}^m$，输出$y_k \in \mathbb{R}^p$。我们进行一次实验，记录下长度为$T$的输入输出轨迹$\{(u_k, y_k)\}_{k=0}^{T-1}$。

**Willems基本引理** [@problem_id:2698755] 指出：若输入序列$\{u_k\}_{k=0}^{T-1}$是**[持续激励](@entry_id:263834)（persistently exciting, PE）**的，且阶次至少为$L+n$，那么该系统所有长度为$L$的输入输出轨迹所构成的集合（即行为$\mathfrak{B}_L$），恰好等于由实验数据构建的Hankel矩阵$\begin{pmatrix} H_L(u) \\ H_L(y) \end{pmatrix}$的[列空间](@entry_id:156444)。

换言之，对于任意一对合法的、长度为$L$的系统轨迹$(u_d, y_d)$，都存在一个系数向量$g \in \mathbb{R}^{T-L+1}$，使得：
$$
\begin{pmatrix} u_d \\ y_d \end{pmatrix} = \begin{pmatrix} H_L(u) \\ H_L(y) \end{pmatrix} g
$$
这个向量$g$本质上是对数据矩阵的列（即历史轨迹片段）进行[线性组合](@entry_id:154743)的权重。这一非凡的性质意味着，数据矩阵$\begin{pmatrix} H_L(u) \\ H_L(y) \end{pmatrix}$构成了一个能够生成系统所有有限长度行为的“数据字典”。

#### [持续激励](@entry_id:263834)性与数据信息度

基本引理的核心条件是输入的**[持续激励](@entry_id:263834)性**。一个输入信号被称为$s$阶[持续激励](@entry_id:263834)的，如果其深度为$s$的Hankel矩阵$H_s(u)$是行满秩的，即$\operatorname{rank}(H_s(u)) = ms$。

引理要求PE阶次为$L+n$的直观解释在于，该条件保证了输入信号的“丰富度”足以探测系统的所有动态模式。长度为$L$的轨迹不仅取决于同期输入，还受到初始状态$x_0 \in \mathbb{R}^n$的影响。为了能够复现由任意初始状态引发的行为，输入信号必须有能力在$L$步内“抵消”这$n$维[状态空间](@entry_id:177074)带来的任意影响。因此，激励的阶次需要同时覆盖轨迹长度$L$和系统阶次$n$ [@problem_id:2698779]。

这一秩条件也对实验数据的长度$T$提出了要求。一个$ms \times (T-s+1)$的矩阵要实现行满秩$ms$，其列数必须不少于行数，即$T-s+1 \ge ms$。代入$s=L+n$，我们得到一个进行有效[数据驱动控制](@entry_id:178277)所必需的最短数据长度的下界 [@problem_id:2698822] [@problem_id:2698753]：
$$
T \ge m(L+n) + (L+n) - 1 = (m+1)(L+n) - 1
$$
这个不等式量化了数据驱动方法的“数据成本”，它与输入维度$m$、任务视界$L$和系统复杂度$n$直接相关。

基本引理最强大的推论在于，它实现了**对显式[模型辨识](@entry_id:139651)的绕越**。我们不再需要从数据中辨识出[状态空间](@entry_id:177074)矩阵$(A,B,C,D)$，而是可以直接利用数据矩阵本身作为系统的隐式、非参数化模型。任何关于系统未来行为的预测或控制问题，都可以转化为一个寻找合适系数向量$g$的代数问题 [@problem_id:2698779]。

### 从原理到应用：数据使能的[预测控制](@entry_id:265552)（DeePC）

数据使能的[预测控制](@entry_id:265552)（Data-enabled Predictive Control, DeePC）是Willems基本引理最直接和成功的应用之一。它将数据驱动的行为表示[范式](@entry_id:161181)与[模型预测控制](@entry_id:146965)（MPC）的框架相结合。

在一个典型的[预测控制](@entry_id:265552)问题中，我们根据系统在过去$T_{\text{ini}}$个时间步的轨迹$(u_{\text{ini}}, y_{\text{ini}})$，来规划未来$T_{\text{f}}$个时间步的控制输入$u_{\text{f}}$，以优化某个性能指标（例如，跟踪参考信号、最小化能耗）。

DeePC的构想非常巧妙。它将待求解的完整轨迹——已知的过去$(u_{\text{ini}}, y_{\text{ini}})$和未知的未来$(u_{\text{f}}, y_{\text{f}})$——视为一个总长度为$L = T_{\text{ini}} + T_{\text{f}}$的系统行为。根据基本引理，只要用于构建数据矩阵的原始输入满足$L+n$阶[持续激励](@entry_id:263834)条件，这个待求解轨迹必定位于数据Hankel矩阵的[列空间](@entry_id:156444)中。这可以用以下方程来表示：
$$
\begin{pmatrix}
U_p \\
Y_p \\
\hline
U_f \\
Y_f
\end{pmatrix}
g
=
\begin{pmatrix}
u_{\text{ini}} \\
y_{\text{ini}} \\
\hline
u_{\text{f}} \\
y_{\text{f}}
\end{pmatrix}
$$
其中，$U_p, Y_p$是与过去窗口$T_{\text{ini}}$对应的Hankel矩阵，而$U_f, Y_f$是与未来窗口$T_{\text{f}}$对应的部分。

DeePC的[优化问题](@entry_id:266749)可以表述为：
$$
\min_{g, u_{\text{f}}, y_{\text{f}}} J(u_{\text{f}}, y_{\text{f}})
$$
subject to:
$$
\begin{cases}
U_p g = u_{\text{ini}} \\
Y_p g = y_{\text{ini}} \\
U_f g = u_{\text{f}} \\
Y_f g = y_{\text{f}} \\
(u_{\text{f}}, y_{\text{f}}) \in \mathcal{C}
\end{cases}
$$
这里的决策变量是系数向量$g$以及未来的输入输出序列。前两个等式将模型与已知的初始轨迹“锚定”，后两个等式利用相同的线性组合$g$来预测未来，从而保证了预测的动态一致性。$\mathcal{C}$代表对未来轨迹的约束（例如，输入或输出的幅值限制）。

在理想条件下（无噪声、数据满足PE条件、初始状态能被唯一确定等），这种数据驱动的控制方法与基于精确模型的控制方法是等价的。例如，可以证明，在满足特定条件时，DeePC与一种称为[系统级综合](@entry_id:175144)（System Level Synthesis, SLS）的现代模型化控制设计框架所产生的最优控制序列完全相同 [@problem_id:2698824]。这揭示了一个深刻的联系：DeePC和SLS可以被看作是解决同一个潜在[优化问题](@entry_id:266749)的不同参数化方法——DeePC使用数据系数$g$作为参数，而SLS使用系统响应映射作为参数。

### 应对现实之一：噪声与不确定性

Willems基本引理的理论美感建立在无噪声的理想世界之上。在现实应用中，测量数据总是受到[噪声污染](@entry_id:188797)，这给直接应用数据驱动方法带来了两大挑战：
1.  **可行性丧失**：由于噪声的存在，测量的轨迹$(u_{\text{ini}}, y_{\text{ini}})$通常不精确地位于由无噪声数据构建的Hankel矩阵的[列空间](@entry_id:156444)中，导致约束$Y_p g = y_{\text{ini}}$无解。
2.  **过拟合**：如果强行要求模型完美拟合含噪数据，会导致控制器对特定的噪声实现过度敏感，从而降低其在未来数据上的表现，即高[方差](@entry_id:200758)问题。

为了使[数据驱动控制](@entry_id:178277)变得实用，必须引入处理不确定性的机制。主流思想主要分为两大类：随机方法和确定性有界方法。

#### 随机不确定性与正则化

当我们将噪声视为[随机过程](@entry_id:159502)（例如，零均值高斯噪声）时，控制问题就具备了统计性质。

**正则化DeePC**
处理噪声的一种有效策略是放宽硬约束，代之以在优化目标中加入惩罚项。这引出了正则化DeePC [@problem_id:2698809]。
1.  **[松弛变量](@entry_id:268374)**：我们引入一个[松弛变量](@entry_id:268374)$\sigma_y$来吸收过去输出轨迹的拟合误差，约束变为$Y_p g + \sigma_y = y_{\text{ini}}$，并在[目标函数](@entry_id:267263)中加入一项$\lambda_{\sigma} \|\sigma_y\|_2^2$来惩罚误差的大小。这等价于最小化拟合残差$\|y_{\text{ini}} - Y_p g\|_2^2$。
2.  **[Tikhonov正则化](@entry_id:140094)**：为了防止系数向量$g$的范数过大（这是过拟合的典型症状），可以在目标函数中再加入一项[Tikhonov正则化](@entry_id:140094)项$\lambda_g \|g\|_2^2$。

正则化后的DeePC[优化问题](@entry_id:266749)（以$g$为变量）大致形式如下：
$$
\min_{g} J(U_f g, Y_f g) + \lambda_{\sigma} \|y_{\text{ini}} - Y_p g\|_2^2 + \lambda_g \|g\|_2^2
$$
这两个[正则化参数](@entry_id:162917)$\lambda_{\sigma}$和$\lambda_g$的引入，在[估计理论](@entry_id:268624)中对应着经典的**[偏差-方差权衡](@entry_id:138822)（bias-variance trade-off）**。
- 增大$\lambda_g$会使解$g$趋向于更小的值，降低其对噪声的敏感度，从而**减小[方差](@entry_id:200758)**，但同时会使解偏离真实值（如果真实值非零），从而**增大偏差**。
- 增大$\lambda_{\sigma}$会让模型更努力地去拟合含噪的过去数据，可能导致[过拟合](@entry_id:139093)和高[方差](@entry_id:200758)。反之，减小$\lambda_{\sigma}$则会使模型对拟合误差更加宽容，可能导致[欠拟合](@entry_id:634904)和高偏差 [@problem_id:2698809]。

从贝叶斯统计的视角看，这种[正则化方法](@entry_id:150559)等价于一个[最大后验概率](@entry_id:268939)（MAP）估计问题。假设$g$服从一个零均值的[高斯先验](@entry_id:749752)[分布](@entry_id:182848)，而[测量噪声](@entry_id:275238)也是高斯分布，那么最小化上述正则化[目标函数](@entry_id:267263)就等价于寻找[后验概率](@entry_id:153467)最大的$g$ [@problem_id:2698809]。这个解释为正则化提供了深刻的[概率论基础](@entry_id:158925)。

**概率保证**
在随机设定下，追求对所有可能噪声实现的[绝对安全](@entry_id:262916)（例如，约束永远不被违反）通常是不可能的。一个更现实的目标是提供**概率保证**。例如，我们可以尝试估计或[上界](@entry_id:274738)约束违规的概率。

考虑一个场景，我们无法知道噪声的精确边界，但可以进行多次独立的闭环实验。对于每次实验（episode），我们可以记录它是否发生了约束违规。假设我们进行了$N$次实验，观察到$v$次违规，经验违规频率为$\widehat{p}_N = v/N$。这个经验值只是真实违规概率$p$的一个估计。我们能否给出一个高置信度的$p$的上界？

利用诸如**[Hoeffding不等式](@entry_id:262658)**这样的浓度不等式，我们可以推导出一个在$1-\delta$[置信水平](@entry_id:182309)下成立的概率上界。对于$N$次独立的[伯努利试验](@entry_id:268355)，真实概率$p$的[上界](@entry_id:274738)$\overline{p}_N(\delta)$可以表示为 [@problem_id:2698768]：
$$
p \le \overline{p}_N(\delta) = \widehat{p}_N + \sqrt{\frac{\ln(1/\delta)}{2N}}
$$
这个公式清晰地表明，通过增加实验次数$N$，我们可以以更高的置信度（更小的$\delta$）获得对真实风险更紧的估计。这种方法放弃了确定性的绝对保证，转而提供了可量化的、有统计意义的风险评估。

#### 集员不确定性

与将噪声视为[随机变量](@entry_id:195330)不同，**集员（set-membership）辨识**方法假设噪声$v_k$是未知的，但其取值被限定在一个已知的集合内，例如$|v_k| \le \varepsilon$。

在这种“未知但有界”的设定下，数据不再指向一个唯一的模型参数，而是定义了一个与观测数据和噪声界限相容的**可行参数集（feasible parameter set）**。

以一个简单的[一阶自回归模型](@entry_id:265801)$y_k = a y_{k-1} + v_k$为例，其中$|v_k| \le \varepsilon$ [@problem_id:2698786]。每一次的测量$(y_{k-1}, y_k)$都对未知参数$a$施加了一个约束：
$$
|y_k - a y_{k-1}| \le \varepsilon
$$
这个不等式定义了参数$a$的一个可行区间。随着我们收集更多的数据点，每一个点都会贡献一个新的约束区间。与所有数据都相容的参数$a$必须位于所有这些区间的交集之中。因此，可行参数集$\mathcal{S}$是这些区间的交集：
$$
\mathcal{S} = \bigcap_{k=1}^N \left[ \frac{y_k - \varepsilon}{y_{k-1}}, \frac{y_k + \varepsilon}{y_{k-1}} \right]
$$
这个交集本身也是一个区间（或空集）。这种方法不产生单一的[点估计](@entry_id:174544)，而是给出了[参数不确定性](@entry_id:264387)的一个严格边界。基于这个可行集进行的控制设计，例如鲁棒控制，旨在保证系统在参数集内的任何可能取值下都能满足性能和安全要求。

### 应对现实之二：数据驱动的系统性质分析

数据驱动方法的威力不仅限于轨迹预测和控制。它们还可以被用来直接从数据中验证系统的内在属性，如稳定性或[耗散性](@entry_id:162959)，而无需辨识完整的模型。

#### 数据驱动的耗散性检验

一个系统被称为关于某个供给率$w(u,y)$是**耗散的**，如果存在一个非负的**[储能函数](@entry_id:197811)**$V(x)$，使得沿着系统的任意轨迹，[储能](@entry_id:264866)的增加量不超过外部供给的能量。对于离散时间系统，这表现为增量形式：
$$
V(x_{k+1}) - V(x_k) \le w(u_k, y_k)
$$
耗散性是许多重要系统属性（如稳定性、无源性）的推广。例如，当供给率为$w(u,y) = u^\top y$时，耗散性就对应于**无源性（passivity）**，这是网络和机器人系统中一个关键的稳定性属性。

有趣的是，我们可以直接利用数据来检验一个系统是否关于某个候选[储能函数](@entry_id:197811)是耗散的。假设我们猜测[储能函数](@entry_id:197811)具有二次型形式$V(x) = x^\top P x$，其中$P \succeq 0$是待定矩阵。如果我们能直接测量状态（即$y_k = x_k$），那么耗散性不等式就变成 [@problem_id:2698805]：
$$
x_{k+1}^\top P x_{k+1} - x_k^\top P x_k \le w(u_k, x_k)
$$
这个不等式对于未知的矩阵$P$是线性的。收集到的每一个状态转移数据点$(u_k, x_k, x_{k+1})$都提供了一个关于$P$的[线性矩阵不等式](@entry_id:174484)（LMI）约束。因此，检验系统是否耗散的问题，就转化为求解一个关于$P$的LMI可行性问题。如果存在一个$P \succeq 0$满足所有由数据产生的不等式，那么我们就获得了系统[耗散性](@entry_id:162959)的一个数据驱动的凭证。

#### 连接[时域与频域](@entry_id:268132)：[KYP引理](@entry_id:173727)

耗散性在[频域](@entry_id:160070)中有着深刻的[对偶表示](@entry_id:146263)。对于[LTI系统](@entry_id:271946)，时域中的无源性（$w(u,y)=u^\top y$）等价于其[传递函数矩阵](@entry_id:271746)$G(s)$在[频域](@entry_id:160070)中是**正实（positive real）**的，即对于所有实数频率$\omega$，满足$G(j\omega) + G(j\omega)^* \succeq 0$。

在模型已知的世界里，连接时域耗散性（[储能函数](@entry_id:197811)的存在性）和[频域](@entry_id:160070)性质（如正实性）的桥梁是著名的**Kalman-Yakubovich-Popov (KYP)引理** [@problem_id:2698787]。它指出，对于一个稳定的[LTI系统](@entry_id:271946)，[频域](@entry_id:160070)不等式在整个频率轴上成立，当且仅当存在一个二次[储能函数](@entry_id:197811)满足某个特定的LMI。

这一联系为[数据驱动分析](@entry_id:635929)开辟了另一条途径。如果我们无法直接进行时域实验，但可以测量系统的[频率响应](@entry_id:183149)$G(j\omega_k)$（例如，通过[频谱分析仪](@entry_id:184248)），我们就可以在[采样频率](@entry_id:264884)点$\omega_k$上检验正实性条件。如果数据在密集的频率点上都满足$G(j\omega_k) + G(j\omega_k)^* \succeq 0$，由于有理[函数的连续性](@entry_id:193744)，我们可以推断系统是正实的 [@problem_id:2698787]。

在处理实际的、含噪的、且仅在有限频带内有效的[频域](@entry_id:160070)数据时，这一思想可以被推广。通过[鲁棒控制](@entry_id:260994)和优化的工具，特别是**广义KYP (GKYP)引理**，可以为[不确定系统](@entry_id:177709)在有限频带内的[耗散性](@entry_id:162959)提供严格的、数据驱动的证书 [@problem_id:2698787]。这代表了数据驱动方法在[系统分析](@entry_id:263805)领域的先进应用，它将经典控制理论与现代优化和数据科学紧密地结合在一起。