{"hands_on_practices": [{"introduction": "模型预测控制 (MPC) 的核心是在每个时间步求解一个有限时域优化问题。本练习将引导您完成一个至关重要的步骤：将抽象的 MPC 问题，包括其系统动力学、成本函数和约束条件，转化为标准的二次规划 (QP) 形式。掌握这一转化过程是实现 MPC 的基础，因为它在控制理论和数值优化求解器之间架起了桥梁。[@problem_id:2736366]", "problem": "考虑在模型预测控制 (MPC)（也称为滚动时域控制 (RHC)）中使用的离散时间线性时不变系统，其状态更新方程为 $x_{k+1}=A x_k + B u_k$，其中 $A=\\begin{bmatrix}1 & 1\\\\0 & 1\\end{bmatrix}$ 和 $B=\\begin{bmatrix}0\\\\1\\end{bmatrix}$，状态 $x_k\\in\\mathbb{R}^2$，输入 $u_k\\in\\mathbb{R}$。设阶段成本为 $x_k^{\\top} Q x_k + u_k^{\\top} R u_k$，其中 $Q=I_2$ 且 $R=1$；终端成本为 $x_N^{\\top} P x_N$，其中 $P=I_2$，$I_2$ 表示 $2\\times 2$ 单位矩阵。预测时域为 $N=3$。硬约束为输入幅值界限 $|u_k|\\le 1$ 和状态无穷范数界限 $\\lVert x_k\\rVert_{\\infty}\\le 5$，适用于所有 $k\\in\\{0,1,2\\}$。假设初始条件 $x_0=\\begin{bmatrix}x_{01}\\\\x_{02}\\end{bmatrix}$ 已知，并满足 $k=0$ 时的状态界限。使用标准堆叠决策变量 $U=[u_0, u_1, u_2]^\\top$。\n\n从仿射输入序列下的预测状态和二次性能指标的基本定义出发，推导标准二次规划 (QP) 形式的显式有限时域优化问题\n$$\n\\min_{U}\\ \\frac{1}{2} U^{\\top} H U + f(x_0)^{\\top} U + c(x_0)\\quad\\text{subject to}\\quad G U \\le h(x_0),\n$$\n其中 $H\\in\\mathbb{R}^{3\\times 3}$，$f(x_0)\\in\\mathbb{R}^{3}$，$c(x_0)\\in\\mathbb{R}$，$G\\in\\mathbb{R}^{m\\times 3}$，以及 $h(x_0)\\in\\mathbb{R}^{m}$（对于某个适当的 m）。您的推导过程必须明确说明预测状态 $x_1$、$x_2$ 和 $x_3$ 如何依赖于 $x_0$ 和 $U$，以及状态和输入约束如何映射为关于 $U$ 的线性不等式。\n\n在您将优化问题写成这种带有显式数值矩阵和向量（在适当之处表达对 $x_0$ 的依赖关系）的标准 QP 形式后，计算 Hessian 矩阵 $H$ 的行列式。请提供行列式的确切值作为最终答案，不要四舍五入。最终答案必须是一个无单位的单个实数。", "solution": "我们从离散时间线性动力学 $x_{k+1}=A x_k + B u_k$ 开始，其中 $A=\\begin{bmatrix}1 & 1\\\\0 & 1\\end{bmatrix}$，$B=\\begin{bmatrix}0\\\\1\\end{bmatrix}$。预测时域为 $N=3$。成本是二次性能指标\n$$\nJ=\\sum_{k=0}^{N-1}\\big(x_k^{\\top} Q x_k + u_k^{\\top} R u_k\\big) + x_N^{\\top} P x_N,\n$$\n其中 $Q=I_2$，$R=1$，$P=I_2$。约束为 $|u_k|\\le 1$ 和 $\\lVert x_k\\rVert_{\\infty}\\le 5$，适用于 $k\\in\\{0,1,2\\}$。\n\n我们首先将预测状态构建为决策向量 $U=[u_0, u_1, u_2]^\\top$ 和初始条件 $x_0=\\begin{bmatrix}x_{01}\\\\x_{02}\\end{bmatrix}$ 的仿射函数。利用 $A$ 的幂（对于此处的 $A$ 满足 $A^n=\\begin{bmatrix}1 & n\\\\0 & 1\\end{bmatrix}$）以及传播的输入效应 $A^j B$，我们得到\n$$\nx_1 = A x_0 + B u_0,\\qquad\nx_2 = A^2 x_0 + A B\\, u_0 + B u_1,\\qquad\nx_3 = A^3 x_0 + A^2 B\\, u_0 + A B\\, u_1 + B u_2.\n$$\n我们计算所需的矩阵：\n$$\nA^2=\\begin{bmatrix}1 & 2\\\\0 & 1\\end{bmatrix},\\quad A^3=\\begin{bmatrix}1 & 3\\\\0 & 1\\end{bmatrix},\\quad\nB=\\begin{bmatrix}0\\\\1\\end{bmatrix},\\quad A B=\\begin{bmatrix}1\\\\1\\end{bmatrix},\\quad A^2 B=\\begin{bmatrix}2\\\\1\\end{bmatrix}.\n$$\n因此，\n$$\nx_1 = \\begin{bmatrix}x_{01}+x_{02}\\\\ x_{02}\\end{bmatrix} + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_0,\\quad\nx_2 = \\begin{bmatrix}x_{01}+2x_{02}\\\\ x_{02}\\end{bmatrix} + \\begin{bmatrix}1\\\\1\\end{bmatrix} u_0 + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_1,\n$$\n$$\nx_3 = \\begin{bmatrix}x_{01}+3x_{02}\\\\ x_{02}\\end{bmatrix} + \\begin{bmatrix}2\\\\1\\end{bmatrix} u_0 + \\begin{bmatrix}1\\\\1\\end{bmatrix} u_1 + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_2.\n$$\n引入仿射分解 $x_k = c_k + D_k U$，其中 $c_1=A x_0$，$c_2=A^2 x_0$，$c_3=A^3 x_0$，以及\n$$\nD_1=\\begin{bmatrix}0 & 0 & 0\\\\ 1 & 0 & 0\\end{bmatrix},\\quad\nD_2=\\begin{bmatrix}1 & 0 & 0\\\\ 1 & 1 & 0\\end{bmatrix},\\quad\nD_3=\\begin{bmatrix}2 & 1 & 0\\\\ 1 & 1 & 1\\end{bmatrix}.\n$$\n目标函数可以写为\n$$\nJ(U) = x_0^{\\top} Q x_0 + \\sum_{k=1}^{3} \\big\\|c_k + D_k U\\big\\|_2^2 + \\sum_{k=0}^{2} u_k^2.\n$$\n展开二次项得到\n$$\nJ(U) = U^{\\top}\\!\\Big(I_3 + \\sum_{k=1}^{3} D_k^{\\top} D_k\\Big) U + 2 \\sum_{k=1}^{3} c_k^{\\top} D_k\\, U + \\Big(x_0^{\\top} Q x_0 + \\sum_{k=1}^{3} \\|c_k\\|_2^2\\Big),\n$$\n其中 $I_3$ 是 $3\\times 3$ 单位矩阵。因此，在标准二次规划 (QP) 形式\n$$\n\\min_{U}\\ \\frac{1}{2} U^{\\top} H U + f(x_0)^{\\top} U + c(x_0),\n$$\n中，Hessian 矩阵为 $H=2\\Big(I_3 + \\sum_{k=1}^{3} D_k^{\\top} D_k\\Big)$，线性项为 $f(x_0)=2\\sum_{k=1}^{3} D_k^{\\top} c_k$，常数项为 $c(x_0)=x_0^{\\top} Q x_0 + \\sum_{k=1}^{3} \\|c_k\\|_2^2$。\n\n我们现在计算矩阵 $D_k^{\\top} D_k$：\n$$\nD_1^{\\top} D_1=\\begin{bmatrix}1 & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0\\end{bmatrix},\\quad\nD_2^{\\top} D_2=\\begin{bmatrix}2 & 1 & 0\\\\ 1 & 1 & 0\\\\ 0 & 0 & 0\\end{bmatrix},\\quad\nD_3^{\\top} D_3=\\begin{bmatrix}5 & 3 & 1\\\\ 3 & 2 & 1\\\\ 1 & 1 & 1\\end{bmatrix}.\n$$\n求和并加上 $I_3$ 得到\n$$\nI_3 + \\sum_{k=1}^{3} D_k^{\\top} D_k\n= \\begin{bmatrix}1 & 0 & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1\\end{bmatrix}\n+ \\begin{bmatrix}1 & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0\\end{bmatrix}\n+ \\begin{bmatrix}2 & 1 & 0\\\\ 1 & 1 & 0\\\\ 0 & 0 & 0\\end{bmatrix}\n+ \\begin{bmatrix}5 & 3 & 1\\\\ 3 & 2 & 1\\\\ 1 & 1 & 1\\end{bmatrix}\n= \\begin{bmatrix}9 & 4 & 1\\\\ 4 & 4 & 1\\\\ 1 & 1 & 2\\end{bmatrix}.\n$$\n因此 Hessian 矩阵为\n$$\nH=2\\begin{bmatrix}9 & 4 & 1\\\\ 4 & 4 & 1\\\\ 1 & 1 & 2\\end{bmatrix}\n= \\begin{bmatrix}18 & 8 & 2\\\\ 8 & 8 & 2\\\\ 2 & 2 & 4\\end{bmatrix}.\n$$\n接下来，计算线性项 $f(x_0)=2\\sum_{k=1}^{3} D_k^{\\top} c_k$，其中 $c_1=A x_0=\\begin{bmatrix}x_{01}+x_{02}\\\\ x_{02}\\end{bmatrix}$，$c_2=A^2 x_0=\\begin{bmatrix}x_{01}+2x_{02}\\\\ x_{02}\\end{bmatrix}$，$c_3=A^3 x_0=\\begin{bmatrix}x_{01}+3x_{02}\\\\ x_{02}\\end{bmatrix}$。使用 $D_1^{\\top}=\\begin{bmatrix}0 & 1\\\\ 0 & 0\\\\ 0 & 0\\end{bmatrix}$，$D_2^{\\top}=\\begin{bmatrix}1 & 1\\\\ 1 & 1\\\\ 0 & 0\\end{bmatrix}$，$D_3^{\\top}=\\begin{bmatrix}2 & 1\\\\ 1 & 1\\\\ 0 & 1\\end{bmatrix}$，我们得到\n$$\nD_1^{\\top} c_1=\\begin{bmatrix}x_{02}\\\\ 0\\\\ 0\\end{bmatrix},\\quad\nD_2^{\\top} c_2=\\begin{bmatrix}x_{01}+3x_{02}\\\\ x_{02}\\\\ 0\\end{bmatrix},\\quad\nD_3^{\\top} c_3=\\begin{bmatrix}2x_{01}+7x_{02}\\\\ x_{01}+4x_{02}\\\\ x_{02}\\end{bmatrix},\n$$\n于是\n$$\n\\sum_{k=1}^{3} D_k^{\\top} c_k=\\begin{bmatrix}3x_{01}+11x_{02}\\\\ x_{01}+5x_{02}\\\\ x_{02}\\end{bmatrix},\\qquad\nf(x_0)=2\\begin{bmatrix}3x_{01}+11x_{02}\\\\ x_{01}+5x_{02}\\\\ x_{02}\\end{bmatrix}=\\begin{bmatrix}6x_{01}+22x_{02}\\\\ 2x_{01}+10x_{02}\\\\ 2x_{02}\\end{bmatrix}.\n$$\n常数项 $c(x_0)$ 收集了所有与 $U$ 无关的部分：\n$$\nc(x_0)=x_0^{\\top} x_0 + \\|A x_0\\|_2^2 + \\|A^2 x_0\\|_2^2 + \\|A^3 x_0\\|_2^2\n= \\sum_{k=0}^{3}\\big((x_{01}+k x_{02})^2 + x_{02}^2\\big).\n$$\n\n我们现在将约束 $|u_k|\\le 1$ 和 $\\lVert x_k\\rVert_{\\infty}\\le 5$（对于 $k\\in\\{0,1,2\\}$）表示为线性不等式 $G U\\le h(x_0)$。输入约束得出\n$$\n\\begin{bmatrix}\n1 & 0 & 0\\\\ -1 & 0 & 0\\\\ 0 & 1 & 0\\\\ 0 & -1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & -1\n\\end{bmatrix}\n\\begin{bmatrix}u_0\\\\ u_1\\\\ u_2\\end{bmatrix}\n\\le\n\\begin{bmatrix}1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\end{bmatrix}.\n$$\n对于 $k=0$ 时的状态约束，$\\lVert x_0\\rVert_{\\infty}\\le 5$ 是关于 $x_0$ 的一个可行性条件，可以表示为 $G$ 中具有零行的常数不等式：\n$$\n\\begin{bmatrix}\n0 & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0\n\\end{bmatrix}\nU \\le\n\\begin{bmatrix}\n5 - x_{01}\\\\ 5 + x_{01}\\\\ 5 - x_{02}\\\\ 5 + x_{02}\n\\end{bmatrix}.\n$$\n对于 $k=1$，我们有 $x_1=\\begin{bmatrix}x_{01}+x_{02}\\\\ x_{02}\\end{bmatrix}+\\begin{bmatrix}0\\\\1\\end{bmatrix} u_0$，因此\n$$\n\\begin{aligned}\n-5 \\le x_{01}+x_{02} \\le 5 \\quad\\Rightarrow\\quad \\begin{bmatrix}0 & 0 & 0\\\\ 0 & 0 & 0\\end{bmatrix} U \\le \\begin{bmatrix}5-(x_{01}+x_{02})\\\\ 5+(x_{01}+x_{02})\\end{bmatrix},\\\\\n-5 \\le x_{02}+u_0 \\le 5 \\quad\\Rightarrow\\quad \\begin{bmatrix}1 & 0 & 0\\\\ -1 & 0 & 0\\end{bmatrix} U \\le \\begin{bmatrix}5 - x_{02}\\\\ 5 + x_{02}\\end{bmatrix}.\n\\end{aligned}\n$$\n对于 $k=2$，我们有 $x_2=\\begin{bmatrix}x_{01}+2x_{02}\\\\ x_{02}\\end{bmatrix}+\\begin{bmatrix}1\\\\1\\end{bmatrix} u_0 + \\begin{bmatrix}0\\\\1\\end{bmatrix} u_1$，因此\n$$\n\\begin{aligned}\n-5 \\le x_{01}+2x_{02}+u_0 \\le 5 \\ \\Rightarrow\\\n\\begin{bmatrix}1 & 0 & 0\\\\ -1 & 0 & 0\\end{bmatrix} U \\le \\begin{bmatrix}5 - x_{01} - 2x_{02}\\\\ 5 + x_{01} + 2x_{02}\\end{bmatrix},\\\\\n-5 \\le x_{02}+u_0+u_1 \\le 5 \\ \\Rightarrow\\\n\\begin{bmatrix}1 & 1 & 0\\\\ -1 & -1 & 0\\end{bmatrix} U \\le \\begin{bmatrix}5 - x_{02}\\\\ 5 + x_{02}\\end{bmatrix}.\n\\end{aligned}\n$$\n堆叠所有不等式可得到 $G\\in\\mathbb{R}^{18\\times 3}$ 和 $h(x_0)\\in\\mathbb{R}^{18}$：\n$$\nG=\n\\begin{bmatrix}\n1 & 0 & 0\\\\ -1 & 0 & 0\\\\ 0 & 1 & 0\\\\ 0 & -1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & -1\\\\\n0 & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0\\\\\n0 & 0 & 0\\\\ 0 & 0 & 0\\\\ 1 & 0 & 0\\\\ -1 & 0 & 0\\\\\n1 & 0 & 0\\\\ -1 & 0 & 0\\\\ 1 & 1 & 0\\\\ -1 & -1 & 0\n\\end{bmatrix},\\quad\nh(x_0)=\n\\begin{bmatrix}\n1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\\\ 1\\\\\n5 - x_{01}\\\\ 5 + x_{01}\\\\ 5 - x_{02}\\\\ 5 + x_{02}\\\\\n5 - (x_{01}+x_{02})\\\\ 5 + (x_{01}+x_{02})\\\\ 5 - x_{02}\\\\ 5 + x_{02}\\\\\n5 - x_{01} - 2x_{02}\\\\ 5 + x_{01} + 2x_{02}\\\\ 5 - x_{02}\\\\ 5 + x_{02}\n\\end{bmatrix}.\n$$\n这就得到了所要求的以 $U$ 为决策变量的显式 QP 形式。\n\n最后，我们计算 Hessian 矩阵 $H$ 的行列式。回顾\n$$\nH=\\begin{bmatrix}18 & 8 & 2\\\\ 8 & 8 & 2\\\\ 2 & 2 & 4\\end{bmatrix}\n= 2 \\begin{bmatrix}9 & 4 & 1\\\\ 4 & 4 & 1\\\\ 1 & 1 & 2\\end{bmatrix}.\n$$\n令 $M=\\begin{bmatrix}9 & 4 & 1\\\\ 4 & 4 & 1\\\\ 1 & 1 & 2\\end{bmatrix}$。则 $\\det(H)=2^3 \\det(M)=8\\,\\det(M)$。通过沿第一行进行余子式展开来计算 $\\det(M)$：\n$$\n\\det(M)=9\\begin{vmatrix}4 & 1\\\\ 1 & 2\\end{vmatrix} - 4\\begin{vmatrix}4 & 1\\\\ 1 & 2\\end{vmatrix} + 1\\begin{vmatrix}4 & 4\\\\ 1 & 1\\end{vmatrix}\n= 9(8-1) - 4(8-1) + 1(4-4) = 9\\cdot 7 - 4\\cdot 7 + 0 = 35.\n$$\n因此，\n$$\n\\det(H)=8\\times 35 = 280.\n$$\n这是一个精确整数，因此无需四舍五入。", "answer": "$$\\boxed{280}$$", "id": "2736366"}, {"introduction": "在 MPC 中，确保递归可行性和稳定性通常依赖于一个精心设计的终端集。本练习将介绍“前驱集”(predecessor set) 的概念，这是一个分析状态如何被引导至目标区域的强大工具。您将应用这一概念，在一个简单的一维系统中推导出有效终端集所需满足的条件。通过这个一维示例，您将对终端集设计和不变性的核心原理建立清晰直观的理解。[@problem_id:2736381]", "problem": "考虑离散时间线性系统 $x_{k+1} = a x_k + b u_k$，其中 $a = 1.3$ 且 $b = 0.7$。状态受限于紧集 $\\mathcal{X} = \\{ x \\in \\mathbb{R} : |x| \\leq x_{\\max} \\}$，其中 $x_{\\max} = 0.6$；控制输入受限于紧集 $\\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\leq u_{\\max} \\}$，其中 $u_{\\max} = 0.9$。将集合 $\\mathcal{S} \\subset \\mathbb{R}$ 的单步前溯算子定义为 $\\mathrm{Pre}(\\mathcal{S}) = \\{ x \\in \\mathbb{R} : \\exists u \\in \\mathcal{U} \\text{ such that } a x + b u \\in \\mathcal{S} \\}$。令 $\\mathcal{S}_{\\alpha} = \\{ x \\in \\mathbb{R} : |x| \\leq \\alpha \\}$ 表示一个半径为 $\\alpha \\geq 0$ 的对称区间。\n\n1. 从 $\\mathrm{Pre}(\\mathcal{S})$ 的定义和给定的约束出发，推导用 $\\alpha$、$a$、$b$ 和 $u_{\\max}$ 表示的 $\\mathrm{Pre}(\\mathcal{S}_{\\alpha})$ 的显式表达式。\n\n2. 对于模型预测控制 (MPC)，一种常见的终端集构造方法是选择一个线性局部控制律 $u = K x$，并强制终端集在该控制律下是正不变的，同时满足输入和状态约束。考虑镇定反馈 $K = -2$。使用针对闭环映射 $x^{+} = (a + b K) x$ 特化的前溯概念，推导关于 $\\alpha$ 的条件，使得集合 $\\mathcal{X}_{f} = \\{ x \\in \\mathbb{R} : |x| \\leq \\alpha \\}$ 满足：\n   - 闭环正不变性：对所有 $x \\in \\mathcal{X}_{f}$，下一状态满足 $(a + b K) x \\in \\mathcal{X}_{f}$，\n   - 输入容许性：对所有 $x \\in \\mathcal{X}_{f}$，输入满足 $K x \\in \\mathcal{U}$，\n   - 状态容许性：$\\mathcal{X}_{f} \\subseteq \\mathcal{X}$。\n\n3. 计算满足所有这些条件的最大 $\\alpha$。将 $\\alpha$ 的最终数值答案四舍五入到四位有效数字。不要包含单位。", "solution": "该问题分为三个部分。我们将依次解决每个部分。\n\n第 1 部分：前溯集 $\\mathrm{Pre}(\\mathcal{S}_{\\alpha})$ 的推导\n\n系统动态由 $x_{k+1} = a x_k + b u_k$ 给出。状态 $x_k$ 和输入 $u_k$ 分别受限于 $|x_k| \\leq x_{\\max}$ 和 $|u_k| \\leq u_{\\max}$。集合 $\\mathcal{S}_{\\alpha}$ 被定义为 $\\mathcal{S}_{\\alpha} = \\{ x \\in \\mathbb{R} : |x| \\leq \\alpha \\}$，其中 $\\alpha \\geq 0$。\n\n单步前溯集 $\\mathrm{Pre}(\\mathcal{S}_{\\alpha})$ 是所有状态 $x$ 的集合，从这些状态出发，系统状态可以通过某个容许的控制输入 $u \\in \\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\leq u_{\\max} \\}$ 在一步内被驱动到 $\\mathcal{S}_{\\alpha}$ 中。\n形式上，一个状态 $x$ 属于 $\\mathrm{Pre}(\\mathcal{S}_{\\alpha})$，如果存在一个 $u \\in \\mathcal{U}$ 使得 $a x + b u \\in \\mathcal{S}_{\\alpha}$。这可以表示为：\n$$ x \\in \\mathrm{Pre}(\\mathcal{S}_{\\alpha}) \\iff \\exists u \\in \\mathbb{R} \\text{ such that } |u| \\leq u_{\\max} \\text{ and } |ax+bu| \\leq \\alpha $$\n条件 $|ax+bu| \\leq \\alpha$ 等价于区间隶属关系 $ax+bu \\in [-\\alpha, \\alpha]$。\n因为 $b=0.7 \\neq 0$，我们可以将所需输入 $u$ 的范围表示为：\n$$ \\frac{-\\alpha-ax}{b} \\leq u \\leq \\frac{\\alpha-ax}{b} $$\n为了使这样一个 $u$ 存在于容许集 $\\mathcal{U} = [-u_{\\max}, u_{\\max}]$ 内，区间 $\\left[ \\frac{-\\alpha-ax}{b}, \\frac{\\alpha-ax}{b} \\right]$ 必须与区间 $[-u_{\\max}, u_{\\max}]$ 有非空交集。\n两个闭区间 $[c_{1}, d_{1}]$ 和 $[c_{2}, d_{2}]$ 的交集非空，当且仅当 $c_{1} \\leq d_{2}$ 且 $c_{2} \\leq d_{1}$。\n应用这个条件，且 $b=0.7 > 0$，我们得到：\n1. $\\frac{-\\alpha-ax}{b} \\leq u_{\\max} \\implies -\\alpha-ax \\leq b u_{\\max} \\implies -ax \\leq \\alpha+b u_{\\max} \\implies ax \\geq -(\\alpha+b u_{\\max})$\n2. $-u_{\\max} \\leq \\frac{\\alpha-ax}{b} \\implies -b u_{\\max} \\leq \\alpha-ax \\implies ax \\leq \\alpha+b u_{\\max}$\n这两个不等式可以合并为一个表达式：\n$$ |ax| \\leq \\alpha+b u_{\\max} $$\n因为 $a=1.3 > 0$，我们可以写成 $|a||x| = a|x|$，因此：\n$$ |x| \\leq \\frac{\\alpha+b u_{\\max}}{a} $$\n因此，前溯集的显式表达式为：\n$$ \\mathrm{Pre}(\\mathcal{S}_{\\alpha}) = \\left\\{ x \\in \\mathbb{R} : |x| \\leq \\frac{\\alpha + b u_{\\max}}{a} \\right\\} $$\n\n第 2 部分：关于终端集 $\\mathcal{X}_{f}$ 的 $\\alpha$ 的条件\n\n终端集被定义为 $\\mathcal{X}_{f} = \\{x \\in \\mathbb{R} : |x| \\leq \\alpha\\}$。局部控制律是 $u = Kx$，其中 $K = -2$。$\\mathcal{X}_f$ 成为一个有效终端集的条件分析如下。\n\n条件 1：闭环正不变性。\n如果对任意 $x \\in \\mathcal{X}_{f}$，其后继状态 $x_{k+1}$ 也在 $\\mathcal{X}_{f}$ 中，则集合 $\\mathcal{X}_{f}$ 在闭环动态 $x_{k+1} = (a+bK)x_k$ 下是正不变的。这意味着如果 $|x| \\leq \\alpha$，那么 $|(a+bK)x| \\leq \\alpha$。\n这个不等式可以写成 $|a+bK| \\cdot |x| \\leq \\alpha$。它必须对所有 $|x| \\leq \\alpha$ 都成立。最严格的情况是当 $|x|$ 达到其最大值 $|x|=\\alpha$ 时。将此代入不等式得到：\n$$ |a+bK|\\alpha \\leq \\alpha $$\n对于 $\\alpha > 0$，我们可以两边同除以 $\\alpha$ 得到标准稳定性条件 $|a+bK| \\leq 1$。如果 $\\alpha=0$，不等式 $0 \\leq 0$ 平凡成立。\n我们使用给定的参数 $a=1.3$、$b=0.7$ 和 $K=-2$ 计算闭环极点 $a_{cl} = a+bK$ 的值：\n$$ a_{cl} = 1.3 + (0.7)(-2) = 1.3 - 1.4 = -0.1 $$\n条件变为 $|-0.1| \\leq 1$，即 $0.1 \\leq 1$。这是成立的。因此，正不变性条件对所有 $\\alpha \\geq 0$ 都成立。\n\n条件 2：输入容许性。\n对于任意状态 $x \\in \\mathcal{X}_{f}$，控制输入 $u = Kx$ 必须是容许的，即 $u \\in \\mathcal{U}$。这转化为条件 $|Kx| \\leq u_{\\max}$，对所有满足 $|x| \\leq \\alpha$ 的 $x$ 都成立。\n这等价于 $|K| \\cdot |x| \\leq u_{\\max}$。该不等式必须对所有 $|x| \\leq \\alpha$ 都成立，所以我们必须检查最坏的情况，即 $|x|=\\alpha$。条件是：\n$$ |K|\\alpha \\leq u_{\\max} $$\n代入值 $K=-2$ 和 $u_{\\max}=0.9$：\n$$ |-2|\\alpha \\leq 0.9 \\implies 2\\alpha \\leq 0.9 $$\n这给出了对 $\\alpha$ 的约束：\n$$ \\alpha \\leq \\frac{0.9}{2} = 0.45 $$\n\n条件 3：状态容许性。\n终端集 $\\mathcal{X}_{f}$ 必须是状态约束集 $\\mathcal{X}$ 的一个子集。即 $\\mathcal{X}_{f} \\subseteq \\mathcal{X}$。\n给定 $\\mathcal{X}_{f} = \\{ x \\in \\mathbb{R} : |x| \\leq \\alpha \\}$ 和 $\\mathcal{X} = \\{ x \\in \\mathbb{R} : |x| \\leq x_{\\max} \\}$，子集条件 $\\mathcal{X}_{f} \\subseteq \\mathcal{X}$ 成立当且仅当 $\\alpha \\leq x_{\\max}$。\n代入值 $x_{\\max}=0.6$：\n$$ \\alpha \\leq 0.6 $$\n\n第 3 部分：计算最大 $\\alpha$\n\n为了找到使 $\\mathcal{X}_{f}$ 成为一个有效终端集的最大可能 $\\alpha$ 值，我们必须找到同时满足所有三个条件的最大 $\\alpha$。推导出的条件是：\n1. $\\alpha \\geq 0$\n2. $\\alpha \\leq 0.45$\n3. $\\alpha \\leq 0.6$\n结合这些条件得到 $0 \\leq \\alpha \\leq \\min(0.45, 0.6)$。因此，我们有：\n$$ 0 \\leq \\alpha \\leq 0.45 $$\n满足此条件的 $\\alpha$ 的最大值是该区间的上界。\n$$ \\alpha_{\\max} = 0.45 $$\n题目要求答案保留四位有效数字。因此，结果是 $0.4500$。", "answer": "$$\n\\boxed{0.4500}\n$$", "id": "2736381"}, {"introduction": "在掌握了终端集设计的基础概念之后，我们现在将这些知识应用于一个更实际的多维系统。本练习要求您为一个二维系统构建一个多胞体终端集。您需要将状态约束、输入约束以及不变性条件转化为一组可解的线性不等式。这个问题将通过展示如何系统性地推导出满足所有必要约束的最大终端集，来巩固您在实际 MPC 应用中的设计技能。[@problem_id:2736411]", "problem": "考虑由状态更新方程 $x^{+} = A x + B u$ 给出的离散时间线性时不变系统，其中\n$$\nA = \\begin{pmatrix}\n0.4  & 0.1 \\\\\n-0.2 & 0.3\n\\end{pmatrix}, \n\\quad\nB = \\begin{pmatrix}\n1 \\\\\n0.5\n\\end{pmatrix}.\n$$\n容许的状态和输入集合是多面体：\n$$\n\\mathcal{X} = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq 2, \\, |x_{2}| \\leq 1 \\},\n\\quad\n\\mathcal{U} = \\{ u \\in \\mathbb{R} \\mid |u| \\leq \\tfrac{1}{2} \\}.\n$$\n一个固定的线性反馈 $u = K x$（其中\n$$\nK = \\begin{pmatrix}\n-0.5  & 0.2\n\\end{pmatrix}\n$$\n）在后退时域控制器中实现，以在终端阶段强制满足约束。设终端成本为二次形式 $V(x) = x^{\\top} P x$，其中 $P \\succ 0$ 是离散时间李雅普诺夫方程\n$$\n(A + B K)^{\\top} P (A + B K) - P = -\\left(Q + K^{\\top} R K\\right),\n$$\n的解，且 $Q = I_{2}$，$R = 1$。该选择确保了在终端反馈下，闭环系统 $x^{+} = (A + B K) x$ 具有严格的二次李雅普诺夫递减性。\n\n定义一个由标量 $\\alpha > 0$ 参数化的多面体（超矩形）终端集族为\n$$\n\\mathcal{X}_{f}(\\alpha) = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq \\alpha, \\, |x_{2}| \\leq \\alpha \\}.\n$$\n通过求解由约束 $x \\in \\mathcal{X}$ 和 $K x \\in \\mathcal{U}$ 导出的线性不等式，并进行收紧以保证该集合对于闭环映射 $x^{+} = (A + B K) x$ 是正不变的，来构造 $\\mathcal{X}_{f}(\\alpha)$，同时利用二次李雅普诺夫递减条件。具体来说，确定最大的标量 $\\alpha^{\\star}$，使得：\n1. $\\mathcal{X}_{f}(\\alpha^{\\star}) \\subseteq \\mathcal{X}$，\n2. 对于所有 $x \\in \\mathcal{X}_{f}(\\alpha^{\\star})$，都有 $K x \\in \\mathcal{U}$，\n3. $\\mathcal{X}_{f}(\\alpha^{\\star})$ 在 $x^{+} = (A + B K) x$ 下是正不变的（因此李雅普诺夫递减条件对于所有 $x \\in \\mathcal{X}_{f}(\\alpha^{\\star})$ 沿终端动态成立）。\n\n将您的最终答案表示为 $\\alpha^{\\star}$ 的精确值（无单位）。无需四舍五入。", "solution": "系统由状态更新方程 $x^{+} = A x + B u$ 定义，其矩阵为\n$$\nA = \\begin{pmatrix} 0.4  & 0.1 \\\\ -0.2 & 0.3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix}.\n$$\n状态和输入约束由以下集合给出\n$$\n\\mathcal{X} = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq 2, \\, |x_{2}| \\leq 1 \\}, \\quad \\mathcal{U} = \\{ u \\in \\mathbb{R} \\mid |u| \\leq \\tfrac{1}{2} \\}.\n$$\n终端反馈律为 $u = K x$，增益为 $K = \\begin{pmatrix} -0.5  & 0.2 \\end{pmatrix}$。\n终端集族为 $\\mathcal{X}_{f}(\\alpha) = \\{ x \\in \\mathbb{R}^{2} \\mid |x_{1}| \\leq \\alpha, \\, |x_{2}| \\leq \\alpha \\}$，其中 $\\alpha > 0$。\n\n我们必须找到最大的标量 $\\alpha^{\\star}$，使得 $\\mathcal{X}_{f}(\\alpha^{\\star})$ 满足三个条件。每个条件都会对 $\\alpha$ 的值施加一个约束。\n\n1. 条件 1：$\\mathcal{X}_{f}(\\alpha) \\subseteq \\mathcal{X}$\n对于任何状态 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\in \\mathcal{X}_{f}(\\alpha)$，我们有 $|x_{1}| \\leq \\alpha$ 和 $|x_{2}| \\leq \\alpha$。为使该状态也属于 $\\mathcal{X}$，它必须满足 $|x_{1}| \\leq 2$ 和 $|x_{2}| \\leq 1$。\n为确保 $\\mathcal{X}_{f}(\\alpha)$ 中的每个点也都在 $\\mathcal{X}$ 中，定义 $\\mathcal{X}_{f}(\\alpha)$ 的边界必须至少与定义 $\\mathcal{X}$ 的边界一样紧。这导出了两个不等式：\n$$\n\\alpha \\leq 2\n$$\n$$\n\\alpha \\leq 1\n$$\n为了同时满足两者，我们必须遵守更严格的那个。因此，此条件施加了约束：\n$$\n\\alpha \\leq 1\n$$\n\n2. 条件 2：对于所有 $x \\in \\mathcal{X}_{f}(\\alpha)$，都有 $K x \\in \\mathcal{U}$\n控制输入为 $u = Kx = -0.5 x_1 + 0.2 x_2$。对输入的约束是 $|u| \\leq \\frac{1}{2}$。\n我们必须确保对于所有 $x \\in \\mathcal{X}_{f}(\\alpha)$，不等式 $|-0.5 x_1 + 0.2 x_2| \\leq \\frac{1}{2}$ 成立。\n我们在集合 $\\mathcal{X}_{f}(\\alpha)$ 上找到 $Kx$ 的最大绝对值。根据三角不等式，对于任何 $x \\in \\mathcal{X}_{f}(\\alpha)$：\n$$\n|Kx| = |-0.5 x_1 + 0.2 x_2| \\leq |-0.5||x_1| + |0.2||x_2| = 0.5|x_1| + 0.2|x_2|\n$$\n由于 $|x_1| \\leq \\alpha$ 且 $|x_2| \\leq \\alpha$，我们有：\n$$\n|Kx| \\leq 0.5\\alpha + 0.2\\alpha = 0.7\\alpha\n$$\n这个最大值在方形集合 $\\mathcal{X}_{f}(\\alpha)$ 的顶点处取得，例如在 $x = \\begin{pmatrix} -\\alpha \\\\ \\alpha \\end{pmatrix}$。\n约束条件是这个最大值不能超过输入限制：\n$$\n0.7\\alpha \\leq \\frac{1}{2}\n$$\n求解 $\\alpha$，我们得到：\n$$\n\\alpha \\leq \\frac{1/2}{0.7} = \\frac{0.5}{0.7} = \\frac{5}{7}\n$$\n\n3. 条件 3：$\\mathcal{X}_{f}(\\alpha)$ 在 $x^{+} = (A + B K) x$ 下是正不变的\n正不变性要求对于任何 $x(k) \\in \\mathcal{X}_{f}(\\alpha)$，下一个状态 $x(k+1) = x^{+}$ 也位于 $\\mathcal{X}_{f}(\\alpha)$ 中。\n闭环系统矩阵是 $A_{cl} = A + BK$：\n$$\nA_{cl} = \\begin{pmatrix} 0.4  & 0.1 \\\\ -0.2 & 0.3 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix} \\begin{pmatrix} -0.5  & 0.2 \\end{pmatrix} = \\begin{pmatrix} 0.4  & 0.1 \\\\ -0.2 & 0.3 \\end{pmatrix} + \\begin{pmatrix} -0.5 & 0.2 \\\\ -0.25 & 0.1 \\end{pmatrix} = \\begin{pmatrix} -0.1 & 0.3 \\\\ -0.45 & 0.4 \\end{pmatrix}\n$$\n集合 $\\mathcal{X}_{f}(\\alpha)$ 可以使用无穷范数描述为 $\\{x \\in \\mathbb{R}^2 \\mid \\|x\\|_{\\infty} \\leq \\alpha \\}$。\n不变性条件是，对于任何满足 $\\|x\\|_{\\infty} \\leq \\alpha$ 的 $x$，我们必须有 $\\|A_{cl}x\\|_{\\infty} \\leq \\alpha$。\n我们知道 $\\|A_{cl}x\\|_{\\infty} \\leq \\|A_{cl}\\|_{\\infty} \\|x\\|_{\\infty}$，其中 $\\|A_{cl}\\|_{\\infty}$ 是诱导矩阵范数，计算为最大绝对行和。\n$$\n\\|A_{cl}\\|_{\\infty} = \\max \\left( |-0.1| + |0.3|, |-0.45| + |0.4| \\right) = \\max(0.1 + 0.3, 0.45 + 0.4) = \\max(0.4, 0.85) = 0.85\n$$\n所以，如果 $\\|x\\|_{\\infty} \\leq \\alpha$，那么 $\\|x^{+}\\|_{\\infty} = \\|A_{cl}x\\|_{\\infty} \\leq 0.85 \\|x\\|_{\\infty} \\leq 0.85\\alpha$。\n为了满足不变性，我们需要 $\\|x^{+}\\|_{\\infty} \\leq \\alpha$。这给出了不等式 $0.85\\alpha \\leq \\alpha$。由于 $\\alpha > 0$，这可以简化为 $0.85 \\leq 1$，该式恒成立。\n因此，集合 $\\mathcal{X}_{f}(\\alpha)$ 对于任何 $\\alpha > 0$ 都是正不变的。此条件没有对 $\\alpha$ 施加上限。提及李雅普诺夫函数是为了确认这对于 RHC 是一种有效的终端集构造方法，但对于计算 $\\alpha^{\\star}$ 本身而言并非必需。\n\n综合这些约束：\n为了找到可能的最大值 $\\alpha^{\\star}$，我们必须满足所有导出的关于 $\\alpha$ 的约束：\n$$\n\\alpha \\leq 1 \\quad \\text{(来自条件 1)}\n$$\n$$\n\\alpha \\leq \\frac{5}{7} \\quad \\text{(来自条件 2)}\n$$\n$\\alpha$ 的值必须小于或等于这些上界中的最小值：\n$$\n\\alpha^{\\star} = \\min\\left(1, \\frac{5}{7}\\right)\n$$\n由于 $1 > \\frac{5}{7}$，最严格的约束是 $\\alpha \\leq \\frac{5}{7}$。\n因此，最大的精确标量是：\n$$\n\\alpha^{\\star} = \\frac{5}{7}\n$$", "answer": "$$\\boxed{\\frac{5}{7}}$$", "id": "2736411"}]}