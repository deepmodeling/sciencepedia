{"hands_on_practices": [{"introduction": "扩展卡尔曼滤波器（EKF）的核心思想是在每个时间步用一个线性系统来近似一个非线性系统。这种近似是通过雅可比矩阵实现的。本练习将通过解析和数值两种方法计算雅可比矩阵，让您在实践中掌握这一关键工具，并理解精确的数学导数与其在实际计算中近似之间的关系。[@problem_id:2705944]", "problem": "在扩展卡尔曼滤波器 (EKF) 中，非线性函数在某个工作点附近的线性化使用雅可比矩阵来传播协方差。考虑一个非线性映射 $f:\\mathbb{R}^{2}\\to\\mathbb{R}^{2}$，其定义为 $f(x)=\\begin{pmatrix}x_{1}\\cos x_{2}\\\\ x_{1}^{2}\\end{pmatrix}$。设工作点为 $x^{\\star}=\\begin{pmatrix}1\\\\0\\end{pmatrix}$。EKF 需要雅可比矩阵 $F=\\left.\\frac{\\partial f}{\\partial x}\\right|_{x^{\\star}}$。\n\n仅使用导数的基本定义和泰勒展开，完成以下任务：\n- 从基本原理出发，推导在 $x^{\\star}$ 处的解析雅可比矩阵 $F$。\n- 使用中心差分法，沿每个坐标方向取对称步长 $\\epsilon=10^{-5}$，逐分量地应用于 $f$，以近似计算在 $x^{\\star}$ 处的雅可比矩阵。\n- 使用由 $\\frac{\\|F_{\\mathrm{fd}}-F\\|_{F}}{\\|F\\|_{F}}$ 定义的相对弗罗贝尼乌斯范数误差，量化有限差分近似 $F_{\\mathrm{fd}}$ 与解析雅可比矩阵 $F$ 之间的差异。\n\n将等于相对误差的单个实数作为最终答案报告。不需要单位。以小数形式表示最终答案。", "solution": "对问题陈述进行了严格审查，并确认其有效。该问题是自洽的，其科学基础在于多变量微积分和数值分析，并且是适定的。尽管函数和工作点的选择导致有限差分近似得到一个精确结果，但这是指定计算的有效结果，并不会使问题本身失效。这是一个测试原理严谨应用的特定实例，而非一个关于数值误差的一般情况。\n\n非线性函数给定为 $f(x) = \\begin{pmatrix} f_1(x) \\\\ f_2(x) \\end{pmatrix} = \\begin{pmatrix} x_{1}\\cos x_{2}\\\\ x_{1}^{2}\\end{pmatrix}$，其中 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。工作点为 $x^{\\star}=\\begin{pmatrix}1\\\\0\\end{pmatrix}$。\n\n首先，我们推导解析雅可比矩阵 $F = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x^{\\star}}$。雅可比矩阵是一个由一阶偏导数组成的矩阵：\n$$\nF(x) = \\frac{\\partial f}{\\partial x} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1}  \\frac{\\partial f_1}{\\partial x_2} \\\\ \\frac{\\partial f_2}{\\partial x_1}  \\frac{\\partial f_2}{\\partial x_2} \\end{pmatrix}\n$$\n我们从基本原理出发计算每个偏导数：\n$\\frac{\\partial f_1}{\\partial x_1} = \\frac{\\partial}{\\partial x_1}(x_1 \\cos x_2) = \\cos x_2$\n$\\frac{\\partial f_1}{\\partial x_2} = \\frac{\\partial}{\\partial x_2}(x_1 \\cos x_2) = -x_1 \\sin x_2$\n$\\frac{\\partial f_2}{\\partial x_1} = \\frac{\\partial}{\\partial x_1}(x_1^2) = 2x_1$\n$\\frac{\\partial f_2}{\\partial x_2} = \\frac{\\partial}{\\partial x_2}(x_1^2) = 0$\n\n因此，作为 $x$ 的函数的雅可比矩阵是：\n$$\nF(x) = \\begin{pmatrix} \\cos x_2  -x_1 \\sin x_2 \\\\ 2x_1  0 \\end{pmatrix}\n$$\n在工作点 $x^{\\star}=\\begin{pmatrix}1\\\\0\\end{pmatrix}$ 处进行求值：\n$$\nF = F(x^{\\star}) = \\begin{pmatrix} \\cos(0)  -1 \\cdot \\sin(0) \\\\ 2 \\cdot 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 2  0 \\end{pmatrix}\n$$\n\n接下来，我们使用中心差分法（步长 $\\epsilon = 10^{-5}$）来近似计算雅可比矩阵。近似雅可比矩阵 $F_{\\mathrm{fd}}$ 的各列由应用于 $f(x)$ 的中心差分公式给出：\n$$\n[F_{\\mathrm{fd}}]_{:, j} = \\frac{f(x^{\\star} + \\epsilon e_j) - f(x^{\\star} - \\epsilon e_j)}{2\\epsilon}\n$$\n其中 $e_j$ 是 $\\mathbb{R}^2$ 中的标准基向量，即 $e_1 = \\begin{pmatrix}1\\\\0\\end{pmatrix}$ 和 $e_2 = \\begin{pmatrix}0\\\\1\\end{pmatrix}$。\n\n对于第一列（$j=1$）：\n我们在 $x^{\\star} + \\epsilon e_1 = \\begin{pmatrix}1+\\epsilon\\\\0\\end{pmatrix}$ 和 $x^{\\star} - \\epsilon e_1 = \\begin{pmatrix}1-\\epsilon\\\\0\\end{pmatrix}$ 处计算 $f$ 的值：\n$f(1+\\epsilon, 0) = \\begin{pmatrix} (1+\\epsilon)\\cos(0) \\\\ (1+\\epsilon)^2 \\end{pmatrix} = \\begin{pmatrix} 1+\\epsilon \\\\ 1+2\\epsilon+\\epsilon^2 \\end{pmatrix}$\n$f(1-\\epsilon, 0) = \\begin{pmatrix} (1-\\epsilon)\\cos(0) \\\\ (1-\\epsilon)^2 \\end{pmatrix} = \\begin{pmatrix} 1-\\epsilon \\\\ 1-2\\epsilon+\\epsilon^2 \\end{pmatrix}$\n第一列为：\n$$\n[F_{\\mathrm{fd}}]_{:, 1} = \\frac{1}{2\\epsilon} \\left( \\begin{pmatrix} 1+\\epsilon \\\\ 1+2\\epsilon+\\epsilon^2 \\end{pmatrix} - \\begin{pmatrix} 1-\\epsilon \\\\ 1-2\\epsilon+\\epsilon^2 \\end{pmatrix} \\right) = \\frac{1}{2\\epsilon} \\begin{pmatrix} 2\\epsilon \\\\ 4\\epsilon \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n\n对于第二列（$j=2$）：\n我们在 $x^{\\star} + \\epsilon e_2 = \\begin{pmatrix}1\\\\\\epsilon\\end{pmatrix}$ 和 $x^{\\star} - \\epsilon e_2 = \\begin{pmatrix}1\\\\-\\epsilon\\end{pmatrix}$ 处计算 $f$ 的值：\n$f(1, \\epsilon) = \\begin{pmatrix} 1 \\cdot \\cos(\\epsilon) \\\\ 1^2 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\epsilon) \\\\ 1 \\end{pmatrix}$\n$f(1, -\\epsilon) = \\begin{pmatrix} 1 \\cdot \\cos(-\\epsilon) \\\\ 1^2 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\epsilon) \\\\ 1 \\end{pmatrix}$，利用了余弦函数的偶函数性质 $\\cos(-\\epsilon) = \\cos(\\epsilon)$。\n第二列为：\n$$\n[F_{\\mathrm{fd}}]_{:, 2} = \\frac{1}{2\\epsilon} \\left( \\begin{pmatrix} \\cos(\\epsilon) \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} \\cos(\\epsilon) \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{2\\epsilon} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n\n合并各列，雅可比矩阵的有限差分近似为：\n$$\nF_{\\mathrm{fd}} = \\begin{pmatrix} 1  0 \\\\ 2  0 \\end{pmatrix}\n$$\n\n这个结果与解析雅可比矩阵 $F$ 完全相同。能够得到精确结果的原因是中心差分格式的截断误差取决于三阶及更高阶的导数。对于给定的函数 $f(x)$ 和点 $x^{\\star}$，这些误差项恒等于零。导数 $g'(x)$ 的中心差分近似的误差与 $g'''(x)$ 成正比。对于关于 $x_1$ 的微分，分量 $f_1$ 和 $f_2$ 都是次数最高为 2 的多项式，因此它们关于 $x_1$ 的三阶导数为零。对于关于 $x_2$ 的微分，分量 $f_2=x_1^2$ 是常数，而分量 $f_1=x_1 \\cos(x_2)$ 关于 $x_2$ 的导数是一个奇函数；因此，在对称点 $x_2=0$ 处的中心差分计算是精确的。\n\n最后，我们使用相对弗罗贝尼乌斯范数误差来量化差异。差分矩阵为：\n$$\nF_{\\mathrm{fd}} - F = \\begin{pmatrix} 1  0 \\\\ 2  0 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 2  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n矩阵 $A$ 的弗罗贝尼乌斯范数是 $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$。\n差分矩阵的范数是：\n$$\n\\|F_{\\mathrm{fd}} - F\\|_F = \\sqrt{0^2 + 0^2 + 0^2 + 0^2} = 0\n$$\n解析雅可比矩阵的范数是：\n$$\n\\|F\\|_F = \\sqrt{1^2 + 0^2 + 2^2 + 0^2} = \\sqrt{1 + 4} = \\sqrt{5}\n$$\n因此，相对误差为：\n$$\n\\frac{\\|F_{\\mathrm{fd}}-F\\|_{F}}{\\|F\\|_{F}} = \\frac{0}{\\sqrt{5}} = 0\n$$\n题目要求答案以小数形式表示。", "answer": "$$\n\\boxed{0.0}\n$$", "id": "2705944"}, {"introduction": "在掌握了线性化的基本工具后，我们将它应用于扩展卡尔曼滤波器完整的测量更新步骤中。通过一个仅有方位角信息的传感器这一经典案例，您将具体地看到雅可比矩阵如何与预测的状态和协方差相结合，用于计算卡尔曼增益，并最终根据新的测量值来校正状态估计。这个练习是理解EKF算法如何融合信息的关键。[@problem_id:2705967]", "problem": "考虑一个平面纯方位传感器，它测量状态为 $x_k = \\begin{bmatrix}x_{1,k}  x_{2,k}\\end{bmatrix}^{\\top}$ 的目标相对于位于原点的传感器的方位角。测量模型是一个非线性函数 $h:\\mathbb{R}^2 \\to \\mathbb{R}$，由 $h(x) = \\arctan\\!\\big(x_2/x_1\\big)$ 给出，角度以弧度为单位。假设加性零均值高斯测量噪声的协方差为 $R = 0.01$。在时刻 $k$，一个扩展卡尔曼滤波器 (EKF) 使用单个标量测量值 $y_k = 0.3$ 弧度、预测状态均值 $\\mu_k^{-} = \\begin{bmatrix}1.0  0.5\\end{bmatrix}^{\\top}$ 和预测协方差\n$$\nP_k^{-} = \\begin{bmatrix} 0.1  0.02 \\\\ 0.02  0.05 \\end{bmatrix}\n$$\n来执行一次测量更新。\n从 EKF 围绕预测均值将测量模型线性化并将线性卡尔曼滤波器更新应用于线性化模型的核心定义出发，完成以下任务：\n1) 从基本原理推导测量雅可比矩阵 $H_k = \\left.\\dfrac{\\partial h}{\\partial x}\\right|_{x=\\mu_k^{-}}$，并在 $\\mu_k^{-}$ 处求值。\n2) 使用线性化贝叶斯更新的基本原理，计算新息协方差 $S_k$、卡尔曼增益 $K_k$、更新后均值 $\\mu_k$ 和更新后协方差 $P_k$。您可以使用任何代数上等价且保持半正定性的协方差更新形式。\n尽可能精确地表示所有中间量（例如，使用有理数和基本常数），并保持角度单位为弧度。作为您的最终答案，仅报告更新后均值的第一个分量，即 $\\mu_k$ 的第一个条目，形式为单个闭式解析表达式，不进行数值舍入。", "solution": "所述问题在科学上是合理的、自洽的，并且在数学上是适定的。它为执行扩展卡尔曼滤波器的单次测量更新步骤提供了所有必要的组成部分。我们将从基本原理出发进行推导和计算。\n\n状态向量为 $x_k = \\begin{bmatrix} x_{1,k}  x_{2,k} \\end{bmatrix}^{\\top}$。非线性测量函数由 $h(x) = \\arctan(x_2/x_1)$ 给出。为了执行 EKF 更新，我们必须围绕预测状态均值 $\\mu_k^{-} = \\begin{bmatrix}1.0  0.5\\end{bmatrix}^{\\top}$ 对此函数进行线性化。\n\n**1) 测量雅可比矩阵 $H_k$**\n\n测量雅可比矩阵 $H$ 是测量函数 $h(x)$ 的一阶偏导数矩阵。对于向量 $x = \\begin{bmatrix} x_1  x_2 \\end{bmatrix}^{\\top}$ 的标量函数，雅可比矩阵是一个行向量。\n\n$h(x)$ 对 $x_1$ 的偏导数为：\n$$\n\\frac{\\partial h}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left( \\arctan\\left(\\frac{x_2}{x_1}\\right) \\right) = \\frac{1}{1 + \\left(\\frac{x_2}{x_1}\\right)^2} \\cdot \\left(-\\frac{x_2}{x_1^2}\\right) = \\frac{-x_2}{x_1^2 + x_2^2}\n$$\n$h(x)$ 对 $x_2$ 的偏导数为：\n$$\n\\frac{\\partial h}{\\partial x_2} = \\frac{\\partial}{\\partial x_2} \\left( \\arctan\\left(\\frac{x_2}{x_1}\\right) \\right) = \\frac{1}{1 + \\left(\\frac{x_2}{x_1}\\right)^2} \\cdot \\left(\\frac{1}{x_1}\\right) = \\frac{x_1}{x_1^2 + x_2^2}\n$$\n因此，雅可比矩阵为行向量：\n$$\nH(x) = \\frac{\\partial h}{\\partial x} = \\begin{bmatrix} \\frac{-x_2}{x_1^2 + x_2^2}  \\frac{x_1}{x_1^2 + x_2^2} \\end{bmatrix}\n$$\n我们在预测均值 $\\mu_k^{-} = \\begin{bmatrix} 1 \\\\ 0.5 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{1}{2} \\end{bmatrix}$ 处计算该雅可比矩阵的值。令 $\\mu_k^{-} = \\begin{bmatrix} \\mu_1^{-}  \\mu_2^{-} \\end{bmatrix}^{\\top}$。\n分母为 $(\\mu_1^{-})^2 + (\\mu_2^{-})^2 = 1^2 + (\\frac{1}{2})^2 = 1 + \\frac{1}{4} = \\frac{5}{4}$。\n雅可比矩阵 $H_k = H(\\mu_k^{-})$ 的分量为：\n$$\n\\frac{\\partial h}{\\partial x_1}\\bigg|_{x=\\mu_k^{-}} = \\frac{-\\mu_2^{-}}{(\\mu_1^{-})^2 + (\\mu_2^{-})^2} = \\frac{-1/2}{5/4} = -\\frac{1}{2} \\cdot \\frac{4}{5} = -\\frac{2}{5}\n$$\n$$\n\\frac{\\partial h}{\\partial x_2}\\bigg|_{x=\\mu_k^{-}} = \\frac{\\mu_1^{-}}{(\\mu_1^{-})^2 + (\\mu_2^{-})^2} = \\frac{1}{5/4} = \\frac{4}{5}\n$$\n所以，求得的测量雅可比矩阵为：\n$$\nH_k = \\begin{bmatrix} -\\frac{2}{5}  \\frac{4}{5} \\end{bmatrix}\n$$\n\n**2) EKF 测量更新**\n\nEKF 均值和协方差的测量更新方程为：\n$$\n\\mu_k = \\mu_k^{-} + K_k (y_k - h(\\mu_k^{-}))\n$$\n$$\nP_k = (I - K_k H_k) P_k^{-}\n$$\n其中 $K_k$ 是卡尔曼增益，定义为：\n$$\nK_k = P_k^{-} H_k^{\\top} S_k^{-1}\n$$\n而 $S_k$ 是新息协方差：\n$$\nS_k = H_k P_k^{-} H_k^{\\top} + R\n$$\n给定以下量，为精确起见，我们用有理数表示：\n$$\n\\mu_k^{-} = \\begin{bmatrix} 1 \\\\ \\frac{1}{2} \\end{bmatrix}, \\quad P_k^{-} = \\begin{bmatrix} \\frac{1}{10}  \\frac{1}{50} \\\\ \\frac{1}{50}  \\frac{1}{20} \\end{bmatrix}, \\quad y_k = \\frac{3}{10}, \\quad R = \\frac{1}{100}\n$$\n\n首先，我们计算**新息协方差 $S_k$**。\n$$\nH_k P_k^{-} = \\begin{bmatrix} -\\frac{2}{5}  \\frac{4}{5} \\end{bmatrix} \\begin{bmatrix} \\frac{1}{10}  \\frac{1}{50} \\\\ \\frac{1}{50}  \\frac{1}{20} \\end{bmatrix} = \\begin{bmatrix} -\\frac{2}{50}+\\frac{4}{250}  -\\frac{2}{250}+\\frac{4}{100} \\end{bmatrix} = \\begin{bmatrix} -\\frac{10}{250}+\\frac{4}{250}  -\\frac{2}{250}+\\frac{10}{250} \\end{bmatrix} = \\begin{bmatrix} -\\frac{6}{250}  \\frac{8}{250} \\end{bmatrix} = \\begin{bmatrix} -\\frac{3}{125}  \\frac{4}{125} \\end{bmatrix}\n$$\n$$\nH_k P_k^{-} H_k^{\\top} = \\begin{bmatrix} -\\frac{3}{125}  \\frac{4}{125} \\end{bmatrix} \\begin{bmatrix} -\\frac{2}{5} \\\\ \\frac{4}{5} \\end{bmatrix} = \\frac{6}{625} + \\frac{16}{625} = \\frac{22}{625}\n$$\n$$\nS_k = \\frac{22}{625} + R = \\frac{22}{625} + \\frac{1}{100} = \\frac{88}{2500} + \\frac{25}{2500} = \\frac{113}{2500}\n$$\n\n接下来，我们计算**卡尔曼增益 $K_k$**。\n$$\nP_k^{-} H_k^{\\top} = \\begin{bmatrix} \\frac{1}{10}  \\frac{1}{50} \\\\ \\frac{1}{50}  \\frac{1}{20} \\end{bmatrix} \\begin{bmatrix} -\\frac{2}{5} \\\\ \\frac{4}{5} \\end{bmatrix} = \\begin{bmatrix} -\\frac{2}{50} + \\frac{4}{250} \\\\ -\\frac{2}{250} + \\frac{4}{100} \\end{bmatrix} = \\begin{bmatrix} -\\frac{6}{250} \\\\ \\frac{8}{250} \\end{bmatrix} = \\begin{bmatrix} -\\frac{3}{125} \\\\ \\frac{4}{125} \\end{bmatrix}\n$$\n$$\nK_k = P_k^{-} H_k^{\\top} S_k^{-1} = \\begin{bmatrix} -\\frac{3}{125} \\\\ \\frac{4}{125} \\end{bmatrix} \\left(\\frac{2500}{113}\\right) = \\begin{bmatrix} -\\frac{3 \\cdot 20}{113} \\\\ \\frac{4 \\cdot 20}{113} \\end{bmatrix} = \\begin{bmatrix} -\\frac{60}{113} \\\\ \\frac{80}{113} \\end{bmatrix}\n$$\n\n现在，我们计算**更新后均值 $\\mu_k$**。\n新息（或残差）为 $\\tilde{y}_k = y_k - h(\\mu_k^{-})$。\n预测测量值为 $h(\\mu_k^{-}) = \\arctan(\\frac{1/2}{1}) = \\arctan(\\frac{1}{2})$。\n新息为 $\\tilde{y}_k = \\frac{3}{10} - \\arctan(\\frac{1}{2})$。\n$$\n\\mu_k = \\mu_k^{-} + K_k \\tilde{y}_k = \\begin{bmatrix} 1 \\\\ \\frac{1}{2} \\end{bmatrix} + \\begin{bmatrix} -\\frac{60}{113} \\\\ \\frac{80}{113} \\end{bmatrix} \\left(\\frac{3}{10} - \\arctan\\left(\\frac{1}{2}\\right)\\right)\n$$\n更新后均值的第一个分量 $\\mu_{1,k}$ 为：\n$$\n\\mu_{1,k} = 1 - \\frac{60}{113} \\left(\\frac{3}{10} - \\arctan\\left(\\frac{1}{2}\\right)\\right) = 1 - \\frac{18}{113} + \\frac{60}{113}\\arctan\\left(\\frac{1}{2}\\right) = \\frac{113-18}{113} + \\frac{60}{113}\\arctan\\left(\\frac{1}{2}\\right)\n$$\n$$\n\\mu_{1,k} = \\frac{95}{113} + \\frac{60}{113}\\arctan\\left(\\frac{1}{2}\\right) = \\frac{95 + 60 \\arctan(\\frac{1}{2})}{113}\n$$\n第二个分量为 $\\mu_{2,k} = \\frac{1}{2} + \\frac{80}{113} (\\frac{3}{10} - \\arctan(\\frac{1}{2})) = \\frac{1}{2} + \\frac{24}{113} - \\frac{80}{113}\\arctan(\\frac{1}{2}) = \\frac{113+48}{226} - \\frac{80}{113}\\arctan(\\frac{1}{2}) = \\frac{161}{226} - \\frac{80}{113}\\arctan(\\frac{1}{2})$。\n更新后的状态均值为 $\\mu_k = \\begin{bmatrix} \\frac{95 + 60 \\arctan(\\frac{1}{2})}{113} \\\\ \\frac{161 - 160 \\arctan(\\frac{1}{2})}{226} \\end{bmatrix}$。\n\n最后，我们计算**更新后协方差 $P_k$**。\n$$\nK_k H_k = \\begin{bmatrix} -\\frac{60}{113} \\\\ \\frac{80}{113} \\end{bmatrix} \\begin{bmatrix} -\\frac{2}{5}  \\frac{4}{5} \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} (-60)(-\\frac{2}{5})  (-60)(\\frac{4}{5}) \\\\ (80)(-\\frac{2}{5})  (80)(\\frac{4}{5}) \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} 24  -48 \\\\ -32  64 \\end{bmatrix}\n$$\n$$\nI - K_k H_k = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\frac{1}{113}\\begin{bmatrix} 24  -48 \\\\ -32  64 \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} 113-24  48 \\\\ 32  113-64 \\end{bmatrix} = \\frac{1}{113} \\begin{bmatrix} 89  48 \\\\ 32  49 \\end{bmatrix}\n$$\n$$\nP_k = (I - K_k H_k) P_k^{-} = \\frac{1}{113} \\begin{bmatrix} 89  48 \\\\ 32  49 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{10}  \\frac{1}{50} \\\\ \\frac{1}{50}  \\frac{1}{20} \\end{bmatrix} = \\frac{1}{11300} \\begin{bmatrix} 89  48 \\\\ 32  49 \\end{bmatrix} \\begin{bmatrix} 10  2 \\\\ 2  5 \\end{bmatrix}\n$$\n$$\nP_k = \\frac{1}{11300} \\begin{bmatrix} 890+96  178+240 \\\\ 320+98  64+245 \\end{bmatrix} = \\frac{1}{11300} \\begin{bmatrix} 986  418 \\\\ 418  309 \\end{bmatrix}\n$$\n至此完成所有必需的计算。所要求的最终答案是更新后均值的第一个分量 $\\mu_{1,k}$。", "answer": "$$\n\\boxed{\\frac{95 + 60 \\arctan\\left(\\frac{1}{2}\\right)}{113}}\n$$", "id": "2705967"}, {"introduction": "EKF的性能取决于其线性近似的质量。这个高级练习将深入探讨该滤波器的内在局限性，通过估算泰勒展开中被忽略的高阶项来量化近似误差。这种分析对于理解EKF在何种条件下可能表现不佳，以及何时需要考虑使用无迹卡尔曼滤波器（Unscented Kalman Filter）等替代方案至关重要。[@problem_id:2705986]", "problem": "考虑在扩展卡尔曼滤波器（EKF）的背景下的一个非线性变换，其中状态是高斯分布的。设 $x \\in \\mathbb{R}^{2}$ 服从分布 $x \\sim \\mathcal{N}(\\mu, P)$，其均值为 $\\mu = [\\,0.1,\\,0.1\\,]^{\\top}$，协方差为 $P = \\mathrm{diag}(0.04,\\,0.09)$。逐分量定义函数 $f:\\mathbb{R}^{2}\\to \\mathbb{R}^{2}$ 为 $f_{1}(x) = \\sin(x_{1})$ 和 $f_{2}(x) = \\exp(x_{2})$。在EKF的预测步骤中，一阶均值更新使用 $f$ 在 $x=\\mu$ 处的线性化，从而忽略了高阶项。\n\n使用关于 $x=\\mu$ 的二阶泰勒展开以及高斯随机向量的标准矩恒等式（即 $\\mathbb{E}[x-\\mu] = 0$ 和 $\\mathbb{E}[(x-\\mu)(x-\\mu)^{\\top}] = P$），推导 $f(x)$ 均值的二阶修正项表达式，该表达式用在 $\\mu$ 处求值的每个分量 $f_{i}$ 的海森矩阵表示。然后，仅使用每个海森矩阵的对角线元素（即，忽略交叉导数项），为给定的 $\\mu$ 和 $P$ 计算被忽略的二阶均值修正向量的欧几里得范数。\n\n所有角度均以弧度为单位。将最终数值答案四舍五入到四位有效数字。报告一个不带单位的实数。", "solution": "首先将验证问题的科学性和逻辑合理性。\n\n**步骤1：提取已知条件**\n- 状态向量：$x \\in \\mathbb{R}^{2}$。\n- 状态分布：$x \\sim \\mathcal{N}(\\mu, P)$。\n- 均值向量：$\\mu = [\\,0.1,\\,0.1\\,]^{\\top}$。\n- 协方差矩阵：$P = \\mathrm{diag}(0.04,\\,0.09)$，即 $P = \\begin{pmatrix} 0.04  0 \\\\ 0  0.09 \\end{pmatrix}$。\n- 非线性函数：$f:\\mathbb{R}^{2}\\to \\mathbb{R}^{2}$，其分量为 $f_{1}(x) = \\sin(x_{1})$ 和 $f_{2}(x) = \\exp(x_{2})$。\n- 高斯分布的矩恒等式：$\\mathbb{E}[x-\\mu] = 0$ 和 $\\mathbb{E}[(x-\\mu)(x-\\mu)^{\\top}] = P$。\n- 近似方法：关于 $x=\\mu$ 的 $f(x)$ 的二阶泰勒展开。\n- 约束条件：计算中仅使用每个分量海森矩阵的对角线元素。\n- 最终目标：计算二阶均值修正向量的欧几里得范数，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及随机变量非线性变换的数学分析，这是随机系统和滤波理论中的一个基本课题（具体来说，是分析扩展卡尔曼滤波器中的近似误差）。该问题是适定的，提供了所有必要的函数、参数和明确的目标。语言精确客观。没有内部矛盾或信息缺失。函数和参数是标准且合理的。因此，该问题被认定为有效。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n目标是求当 $x \\sim \\mathcal{N}(\\mu, P)$ 时 $f(x)$ 均值的二阶修正项。EKF中使用的一阶均值近似为 $\\mathbb{E}[f(x)] \\approx f(\\mu)$。我们寻求使用二阶泰勒展开来改进此近似。\n\n我们考虑向量函数 $f(x)$ 的单个分量 $f_{i}(x)$。$f_{i}(x)$ 在均值 $\\mu$ 附近的二阶泰勒展开式为：\n$$ f_{i}(x) \\approx f_{i}(\\mu) + \\nabla f_{i}(\\mu)^{\\top}(x-\\mu) + \\frac{1}{2}(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu) $$\n其中 $\\nabla f_{i}(\\mu)$ 是 $f_{i}$ 的梯度，$H_{f_{i}}(\\mu)$ 是 $f_{i}$ 的海森矩阵，两者都在 $x=\\mu$ 处求值。\n\n为了求 $f_{i}(x)$ 的期望值，我们对展开式取期望：\n$$ \\mathbb{E}[f_{i}(x)] \\approx \\mathbb{E}\\left[f_{i}(\\mu) + \\nabla f_{i}(\\mu)^{\\top}(x-\\mu) + \\frac{1}{2}(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)\\right] $$\n根据期望算子的线性性质：\n$$ \\mathbb{E}[f_{i}(x)] \\approx \\mathbb{E}[f_{i}(\\mu)] + \\mathbb{E}[\\nabla f_{i}(\\mu)^{\\top}(x-\\mu)] + \\mathbb{E}\\left[\\frac{1}{2}(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)\\right] $$\n由于 $f_{i}(\\mu)$、$\\nabla f_{i}(\\mu)$ 和 $H_{f_{i}}(\\mu)$ 是在 $\\mu$ 处求值的常数，我们可以写成：\n$$ \\mathbb{E}[f_{i}(x)] \\approx f_{i}(\\mu) + \\nabla f_{i}(\\mu)^{\\top}\\mathbb{E}[x-\\mu] + \\frac{1}{2}\\mathbb{E}\\left[(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)\\right] $$\n使用给定的恒等式 $\\mathbb{E}[x-\\mu] = 0$，一阶项消失：\n$$ \\mathbb{E}[f_{i}(x)] \\approx f_{i}(\\mu) + \\frac{1}{2}\\mathbb{E}\\left[(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)\\right] $$\n项 $(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)$ 是一个标量。我们可以使用迹的性质，对于标量 $A$ 有 $\\mathrm{Tr}(A) = A$，以及迹的循环性质 $\\mathrm{Tr}(ABC) = \\mathrm{Tr}(BCA)$。\n$$ \\mathbb{E}\\left[(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)\\right] = \\mathbb{E}\\left[\\mathrm{Tr}\\left((x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)\\right)\\right] = \\mathbb{E}\\left[\\mathrm{Tr}\\left(H_{f_{i}}(\\mu) (x-\\mu) (x-\\mu)^{\\top}\\right)\\right] $$\n将期望移到迹算子内部：\n$$ = \\mathrm{Tr}\\left(\\mathbb{E}\\left[H_{f_{i}}(\\mu) (x-\\mu) (x-\\mu)^{\\top}\\right]\\right) = \\mathrm{Tr}\\left(H_{f_{i}}(\\mu) \\mathbb{E}\\left[(x-\\mu) (x-\\mu)^{\\top}\\right]\\right) $$\n使用第二个恒等式 $\\mathbb{E}[(x-\\mu)(x-\\mu)^{\\top}] = P$，我们得到：\n$$ \\mathbb{E}\\left[(x-\\mu)^{\\top} H_{f_{i}}(\\mu) (x-\\mu)\\right] = \\mathrm{Tr}\\left(H_{f_{i}}(\\mu) P\\right) $$\n因此，均值的二阶近似为：\n$$ \\mathbb{E}[f_{i}(x)] \\approx f_{i}(\\mu) + \\frac{1}{2}\\mathrm{Tr}\\left(H_{f_{i}}(\\mu) P\\right) $$\n项 $\\frac{1}{2}\\mathrm{Tr}\\left(H_{f_{i}}(\\mu) P\\right)$ 是第 $i$ 个分量均值的二阶修正项。我们记为 $\\delta\\mu_{f}$ 的修正向量是：\n$$ \\delta\\mu_{f} = \\begin{pmatrix} \\frac{1}{2}\\mathrm{Tr}\\left(H_{f_{1}}(\\mu) P\\right) \\\\ \\frac{1}{2}\\mathrm{Tr}\\left(H_{f_{2}}(\\mu) P\\right) \\end{pmatrix} $$\n现在，我们为给定的函数和参数计算这个值。\n状态为 $x=[x_{1}, x_{2}]^{\\top}$。均值为 $\\mu = [\\,0.1,\\,0.1\\,]^{\\top}$。协方差为 $P = \\begin{pmatrix} 0.04  0 \\\\ 0  0.09 \\end{pmatrix}$。\n\n对于第一个分量 $f_{1}(x) = \\sin(x_{1})$：\n一阶偏导数为 $\\frac{\\partial f_{1}}{\\partial x_{1}} = \\cos(x_{1})$ 和 $\\frac{\\partial f_{1}}{\\partial x_{2}} = 0$。\n二阶偏导数为 $\\frac{\\partial^{2} f_{1}}{\\partial x_{1}^{2}} = -\\sin(x_{1})$、$\\frac{\\partial^{2} f_{1}}{\\partial x_{2}^{2}} = 0$ 和 $\\frac{\\partial^{2} f_{1}}{\\partial x_{1} \\partial x_{2}} = 0$。\n$f_{1}$ 的海森矩阵是：\n$$ H_{f_{1}}(x) = \\begin{pmatrix} -\\sin(x_{1})  0 \\\\ 0  0 \\end{pmatrix} $$\n在 $\\mu=[0.1, 0.1]^{\\top}$ 处求值：\n$$ H_{f_{1}}(\\mu) = \\begin{pmatrix} -\\sin(0.1)  0 \\\\ 0  0 \\end{pmatrix} $$\n\n对于第二个分量 $f_{2}(x) = \\exp(x_{2})$：\n一阶偏导数为 $\\frac{\\partial f_{2}}{\\partial x_{1}} = 0$ 和 $\\frac{\\partial f_{2}}{\\partial x_{2}} = \\exp(x_{2})$。\n二阶偏导数为 $\\frac{\\partial^{2} f_{2}}{\\partial x_{1}^{2}} = 0$、$\\frac{\\partial^{2} f_{2}}{\\partial x_{2}^{2}} = \\exp(x_{2})$ 和 $\\frac{\\partial^{2} f_{2}}{\\partial x_{1} \\partial x_{2}} = 0$。\n$f_{2}$ 的海森矩阵是：\n$$ H_{f_{2}}(x) = \\begin{pmatrix} 0  0 \\\\ 0  \\exp(x_{2}) \\end{pmatrix} $$\n在 $\\mu=[0.1, 0.1]^{\\top}$ 处求值：\n$$ H_{f_{2}}(\\mu) = \\begin{pmatrix} 0  0 \\\\ 0  \\exp(0.1) \\end{pmatrix} $$\n问题要求忽略交叉导数项，这一点已经得到满足，因为两个海森矩阵都是对角矩阵。\n\n现在我们计算每个分量的修正项。\n对于第一个分量：\n$$ [\\delta\\mu_{f}]_{1} = \\frac{1}{2}\\mathrm{Tr}(H_{f_{1}}(\\mu) P) = \\frac{1}{2}\\mathrm{Tr}\\left(\\begin{pmatrix} -\\sin(0.1)  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0.04  0 \\\\ 0  0.09 \\end{pmatrix}\\right) $$\n$$ [\\delta\\mu_{f}]_{1} = \\frac{1}{2}\\mathrm{Tr}\\begin{pmatrix} -0.04\\sin(0.1)  0 \\\\ 0  0 \\end{pmatrix} = \\frac{1}{2}(-0.04\\sin(0.1)) = -0.02\\sin(0.1) $$\n\n对于第二个分量：\n$$ [\\delta\\mu_{f}]_{2} = \\frac{1}{2}\\mathrm{Tr}(H_{f_{2}}(\\mu) P) = \\frac{1}{2}\\mathrm{Tr}\\left(\\begin{pmatrix} 0  0 \\\\ 0  \\exp(0.1) \\end{pmatrix} \\begin{pmatrix} 0.04  0 \\\\ 0  0.09 \\end{pmatrix}\\right) $$\n$$ [\\delta\\mu_{f}]_{2} = \\frac{1}{2}\\mathrm{Tr}\\begin{pmatrix} 0  0 \\\\ 0  0.09\\exp(0.1) \\end{pmatrix} = \\frac{1}{2}(0.09\\exp(0.1)) = 0.045\\exp(0.1) $$\n二阶均值修正向量为：\n$$ \\delta\\mu_{f} = \\begin{pmatrix} -0.02\\sin(0.1) \\\\ 0.045\\exp(0.1) \\end{pmatrix} $$\n最后一步是计算该向量的欧几里得范数 $||\\delta\\mu_{f}||_{2}$：\n$$ ||\\delta\\mu_{f}||_{2} = \\sqrt{\\left(-0.02\\sin(0.1)\\right)^{2} + \\left(0.045\\exp(0.1)\\right)^{2}} $$\n$$ ||\\delta\\mu_{f}||_{2} = \\sqrt{0.0004\\sin^{2}(0.1) + 0.002025\\exp(0.2)} $$\n现在，我们计算数值。\n$\\sin(0.1) \\approx 0.0998334166$\n$\\exp(0.1) \\approx 1.105170918$\n$$ [\\delta\\mu_{f}]_{1} \\approx -0.02 \\times 0.0998334166 = -0.0019966683 $$\n$$ [\\delta\\mu_{f}]_{2} \\approx 0.045 \\times 1.105170918 = 0.0497326913 $$\n$$ ||\\delta\\mu_{f}||_{2} \\approx \\sqrt{(-0.0019966683)^{2} + (0.0497326913)^{2}} $$\n$$ ||\\delta\\mu_{f}||_{2} \\approx \\sqrt{0.00000398668 + 0.00247334058} = \\sqrt{0.00247732726} \\approx 0.049772755 $$\n将结果四舍五入到四位有效数字，得到 $0.04977$。", "answer": "$$\n\\boxed{0.04977}\n$$", "id": "2705986"}]}