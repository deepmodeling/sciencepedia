{"hands_on_practices": [{"introduction": "残差生成是故障检测的第一步，其核心目标是构造一个在理想无故障情况下为零的信号。本练习将通过一个具体的案例，带您实践如何使用被称为“校验关系法”的代数方法，从系统的状态空间模型出发，构建一个对未知初始状态和已知控制输入解耦的残差信号。通过这个过程，您将掌握将系统动态关系转化为可用于故障检测的代数约束的关键技术。 [@problem_id:2706941]", "problem": "考虑一个带有加性传感器故障的离散时间单输入单输出（SISO）线性时不变系统，其形式如下：\n$$\nx_{k+1}=A x_k + B u_k, \\quad y_k = C x_k + D u_k + f_k,\n$$\n其中\n$$\nA=\\begin{pmatrix}0.6 & 1.0\\\\ 0 & 0.3\\end{pmatrix},\\quad\nB=\\begin{pmatrix}1\\\\ 0\\end{pmatrix},\\quad\nC=\\begin{pmatrix}1 & 0\\end{pmatrix},\\quad\nD=0.2,\n$$\n而 $f_k$ 是一个未知的传感器故障。矩阵对 $\\left(A,C\\right)$ 是可观测的。定义堆叠的水平-$N$ 向量\n$$\nY=\\begin{pmatrix}y_0\\\\ y_1\\\\ y_2\\\\ y_3\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_0\\\\ u_1\\\\ u_2\\\\ u_3\\end{pmatrix},\\quad\nf=\\begin{pmatrix}f_0\\\\ f_1\\\\ f_2\\\\ f_3\\end{pmatrix},\n$$\n其中 $N=4$。从第一性原理（状态递归和输出方程）出发，显式地构建堆叠数据方程\n$$\nY=\\mathcal{T}_U\\,U+\\mathcal{T}_X\\,x_0+\\mathcal{T}_F\\,F\\,f,\n$$\n通过构建 $4\\times 4$ 的下块托普利兹输入矩阵 $\\mathcal{T}_U$、$4\\times 2$ 的扩展可观测矩阵 $\\mathcal{T}_X$ 以及 $4\\times 4$ 的故障分布矩阵 $\\mathcal{T}_F$ 和故障特征 $F$。然后，仅利用这些矩阵的线性代数性质，推导出一个显式的非平凡奇偶校验矩阵，该矩阵可以消除未知的初始条件 $x_0$ 和测量的输入 $U$。具体来说，构造矩阵 $Q_y\\in\\mathbb{R}^{2\\times 4}$ 和 $Q_u\\in\\mathbb{R}^{2\\times 4}$ 使得\n$$\nQ_y\\,\\mathcal{T}_X=0,\\qquad Q_y\\,\\mathcal{T}_U+Q_u=0,\n$$\n因此残差\n$$\nr = Q_y\\,Y + Q_u\\,U\n$$\n仅取决于故障。提供块奇偶校验矩阵 $\\Pi=\\big[\\,Q_y\\;\\;Q_u\\,\\big]\\in\\mathbb{R}^{2\\times 8}$ 的一个显式数值选择。你的最终答案必须是这个 $\\Pi$ 的单个解析表达式。不需要四舍五入，也不涉及单位。", "solution": "起点是状态递归和输出映射，\n$$\nx_{k+1}=A x_k + B u_k,\\qquad y_k = C x_k + D u_k + f_k,\n$$\n以及水平 $N=4$ 的堆叠向量的定义，\n$$\nY=\\begin{pmatrix}y_0\\\\ y_1\\\\ y_2\\\\ y_3\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_0\\\\ u_1\\\\ u_2\\\\ u_3\\end{pmatrix},\\quad\nf=\\begin{pmatrix}f_0\\\\ f_1\\\\ f_2\\\\ f_3\\end{pmatrix}.\n$$\n通过将状态更新方程反复代入输出方程，可以从递归中获得众所周知的在时间域上的输出表达式：\n$$\n\\begin{aligned}\ny_0 &= C x_0 + D u_0 + f_0,\\\\\ny_1 &= C A x_0 + C B u_0 + D u_1 + f_1,\\\\\ny_2 &= C A^2 x_0 + C A B u_0 + C B u_1 + D u_2 + f_2,\\\\\ny_3 &= C A^3 x_0 + C A^2 B u_0 + C A B u_1 + C B u_2 + D u_3 + f_3.\n\\end{aligned}\n$$\n将这四个方程堆叠起来得到\n$$\nY=\\underbrace{\\begin{pmatrix}\nD & 0 & 0 & 0\\\\\nC B & D & 0 & 0\\\\\nC A B & C B & D & 0\\\\\nC A^2 B & C A B & C B & D\n\\end{pmatrix}}_{\\mathcal{T}_U}\\,U+\n\\underbrace{\\begin{pmatrix}\nC\\\\\nC A\\\\\nC A^2\\\\\nC A^3\n\\end{pmatrix}}_{\\mathcal{T}_X}\\,x_0+\n\\underbrace{I_4}_{\\mathcal{T}_F}\\,\\underbrace{1}_{F}\\,f.\n$$\n因此，对于加性传感器故障，有 $\\mathcal{T}_F=I_4$ 和 $F=1$。\n\n接下来，计算所需的马尔可夫参数和 $A$ 的幂，以显式构造 $\\mathcal{T}_U$ 和 $\\mathcal{T}_X$。已知\n$$\nA=\\begin{pmatrix}0.6 & 1.0\\\\ 0 & 0.3\\end{pmatrix},\\quad\nB=\\begin{pmatrix}1\\\\ 0\\end{pmatrix},\\quad\nC=\\begin{pmatrix}1 & 0\\end{pmatrix},\\quad\nD=0.2,\n$$\n可以得到\n$$\nA^2=\\begin{pmatrix}0.36 & 0.9\\\\ 0 & 0.09\\end{pmatrix},\\qquad\nA^3=\\begin{pmatrix}0.216 & 0.63\\\\ 0 & 0.027\\end{pmatrix}.\n$$\n因此，\n$$\n\\begin{aligned}\nC &= \\begin{pmatrix}1 & 0\\end{pmatrix},\\\\\nC A &= \\begin{pmatrix}0.6 & 1\\end{pmatrix},\\\\\nC A^2 &= \\begin{pmatrix}0.36 & 0.9\\end{pmatrix},\\\\\nC A^3 &= \\begin{pmatrix}0.216 & 0.63\\end{pmatrix},\n\\end{aligned}\n$$\n于是\n$$\n\\mathcal{T}_X=\\begin{pmatrix}\n1 & 0\\\\\n0.6 & 1\\\\\n0.36 & 0.9\\\\\n0.216 & 0.63\n\\end{pmatrix}.\n$$\n对于输入托普利兹矩阵，马尔可夫参数为\n$$\ng_0 = D = 0.2,\\quad g_1 = C B = 1,\\quad g_2 = C A B = 0.6,\\quad g_3 = C A^2 B = 0.36,\n$$\n从而得到\n$$\n\\mathcal{T}_U=\\begin{pmatrix}\n0.2 & 0 & 0 & 0\\\\\n1 & 0.2 & 0 & 0\\\\\n0.6 & 1 & 0.2 & 0\\\\\n0.36 & 0.6 & 1 & 0.2\n\\end{pmatrix}.\n$$\n\n为了消除对未知初始条件 $x_0$ 和测量输入 $U$ 的依赖，我们构造一个形式如下的奇偶校验残差\n$$\nr = Q_y\\,Y + Q_u\\,U,\n$$\n其中 $Q_y\\in\\mathbb{R}^{2\\times 4}$ 和 $Q_u\\in\\mathbb{R}^{2\\times 4}$ 的选择需满足\n$$\nQ_y\\,\\mathcal{T}_X=0,\\qquad Q_y\\,\\mathcal{T}_U+Q_u=0.\n$$\n第一个条件要求 $Q_y$ 的行向量位于 $\\mathcal{T}_X$ 的左零空间中。通过寻找满足 $\\mathcal{T}_X^{\\top} q=0$ 的 $q\\in\\mathbb{R}^4$ 来求解 $Q_y\\,\\mathcal{T}_X=0$。记 $q=\\begin{pmatrix}q_0 & q_1 & q_2 & q_3\\end{pmatrix}^{\\top}$，方程组为\n$$\n\\begin{aligned}\nq_0\\cdot 1 + q_1\\cdot 0.6 + q_2\\cdot 0.36 + q_3\\cdot 0.216 &= 0,\\\\\nq_0\\cdot 0 + q_1\\cdot 1 + q_2\\cdot 0.9 + q_3\\cdot 0.63 &= 0,\n\\end{aligned}\n$$\n得到一个双参数族\n$$\n\\begin{pmatrix}q_0\\\\ q_1\\\\ q_2\\\\ q_3\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.18c + 0.162d\\\\\n-0.9c - 0.63d\\\\\nc\\\\\nd\n\\end{pmatrix},\n\\quad c,d\\in\\mathbb{R}.\n$$\n选择对应于 $(c,d)=(1,0)$ 和 $(c,d)=(0,1)$ 的基向量，我们得到两个独立的左零向量\n$$\nq^{(1)}=\\begin{pmatrix}0.18\\\\ -0.9\\\\ 1\\\\ 0\\end{pmatrix},\\qquad\nq^{(2)}=\\begin{pmatrix}0.162\\\\ -0.63\\\\ 0\\\\ 1\\end{pmatrix}.\n$$\n将它们作为行向量堆叠起来得到\n$$\nQ_y=\\begin{pmatrix}\n0.18 & -0.9 & 1 & 0\\\\\n0.162 & -0.63 & 0 & 1\n\\end{pmatrix},\n$$\n根据构造，该矩阵满足 $Q_y\\,\\mathcal{T}_X=0$。\n\n第二个条件 $Q_y\\,\\mathcal{T}_U+Q_u=0$ 唯一地确定了与此 $Q_y$ 对应的 $Q_u$：\n$$\nQ_u = -\\,Q_y\\,\\mathcal{T}_U.\n$$\n显式计算 $Q_y\\,\\mathcal{T}_U$。对于 $Q_y$ 的第一行，其与 $\\mathcal{T}_U$ 的乘积为\n$$\n\\begin{pmatrix}-0.264 & 0.82 & 0.2 & 0\\end{pmatrix}.\n$$\n对于 $Q_y$ 的第二行，其与 $\\mathcal{T}_U$ 的乘积为\n$$\n\\begin{pmatrix}-0.2376 & 0.474 & 1 & 0.2\\end{pmatrix}.\n$$\n因此，\n$$\nQ_u=-Q_y\\,\\mathcal{T}_U=\n\\begin{pmatrix}\n0.264 & -0.82 & -0.2 & 0\\\\\n0.2376 & -0.474 & -1 & -0.2\n\\end{pmatrix}.\n$$\n通过这些选择，残差\n$$\nr = Q_y\\,Y + Q_u\\,U\n= Q_y\\left(\\mathcal{T}_U\\,U+\\mathcal{T}_X\\,x_0+\\mathcal{T}_F\\,F\\,f\\right)+Q_u\\,U\n= \\underbrace{Q_y\\,\\mathcal{T}_X}_{0}\\,x_0+\\underbrace{\\big(Q_y\\,\\mathcal{T}_U+Q_u\\big)}_{0}\\,U+Q_y\\,\\mathcal{T}_F\\,F\\,f,\n$$\n简化为\n$$\nr = Q_y\\,f,\n$$\n因为 $\\mathcal{T}_F=I_4$ 且 $F=1$。因此，作用于扩展数据向量 $\\begin{pmatrix}Y^{\\top} & U^{\\top}\\end{pmatrix}^{\\top}$ 的块奇偶校验矩阵为\n$$\n\\Pi=\\big[\\,Q_y\\;\\;Q_u\\,\\big]\n=\n\\begin{pmatrix}\n0.18 & -0.9 & 1 & 0 & \\;\\;0.264 & -0.82 & -0.2 & 0\\\\\n0.162 & -0.63 & 0 & 1 & \\;\\;0.2376 & -0.474 & -1 & -0.2\n\\end{pmatrix},\n$$\n该矩阵从残差中消除了未知的初始状态 $x_0$ 和测量的输入 $U$。", "answer": "$$\\boxed{\\begin{pmatrix}\n0.18 & -0.9 & 1 & 0 & \\;\\;0.264 & -0.82 & -0.2 & 0\\\\\n0.162 & -0.63 & 0 & 1 & \\;\\;0.2376 & -0.474 & -1 & -0.2\n\\end{pmatrix}}$$", "id": "2706941"}, {"introduction": "获得残差信号后，我们需要一个明确的规则来判断它是否预示着故障。本练习将引导您应用统计决策理论中的奈曼-皮尔逊准则，来设计一个有效的检测阈值。您将学习如何在给定的虚警率 $ \\alpha $ 约束下确定决策边界，并计算出该检测器能够可靠发现的最小故障幅值 $f_{\\min}$，从而深刻理解检测性能与统计风险之间的权衡。 [@problem_id:2706769]", "problem": "针对一个离散时间线性时不变系统，用于故障检测与隔离（FDI）的残差生成器产生一个标量残差序列 $ r_k $。在无故障假设 $ \\mathcal{H}_0 $ 下，假设 $ r_k $ 是独立同分布的高斯变量，其均值为零，方差 $ \\sigma^2 $ 未知。一次标定实验得到了一个无偏方差估计 $ \\hat{\\sigma}^2 = 0.09 $，由于标定数据集很大，在设计检测器时可以将其视为已知。\n\n你需要设计一个单边瞬时检测器，用于检测残差中的正均值偏差故障。在故障假设 $ \\mathcal{H}_1 $ 下，该故障模型为 $ r_k \\sim \\mathcal{N}(f, \\sigma^2) $，其中 $ f > 0 $，且方差与 $ \\mathcal{H}_0 $ 下的方差相同。决策规则是 Neyman–Pearson 类型的：如果在时刻 $ k $ 有 $ r_k > \\gamma $，则宣告故障，其中 $ \\gamma $ 是一个待确定的阈值。\n\n设计要求如下：\n- 在 $ \\mathcal{H}_0 $ 下，单样本误报概率必须等于 $ \\alpha = 1.0 \\times 10^{-3} $。\n- 当均值偏移为其最小可检测幅值 $ f_{\\min} $ 时，在 $ \\mathcal{H}_1 $ 下，单样本检测概率必须等于 $ \\beta = 0.95 $。\n\n从高斯假设检验的基本原理出发，不使用任何预先给定的目标公式，推导：\n1. 满足误报要求的阈值 $ \\gamma $（用 $ \\hat{\\sigma} $ 和 $ \\alpha $ 表示），然后计算其数值。\n2. 对于阈值 $ \\gamma $，能达到目标检测概率 $ \\beta $ 的最小可检测正均值偏移 $ f_{\\min} $，然后计算其数值。\n\n将 $ \\gamma $ 和 $ f_{\\min} $ 均以与 $ r_k $ 相同的无量纲归一化残差单位表示。将最终答案表示为行向量 $ [\\gamma, f_{\\min}] $。将每个条目四舍五入到四位有效数字。所有概率必须按小数处理，而不是百分比。", "solution": "所给问题是假设检验中的一个标准练习，这是用于故障检测与隔离（FDI）的统计信号处理的核心组成部分。该问题提法恰当，有科学依据，并为获得唯一解提供了所有必要信息。我们将从基本原理出发进行推导。\n\n问题为任意时间步 $k$ 观测到的残差 $r_k$ 定义了两个假设：\n零假设 $\\mathcal{H}_0$ 对应于无故障情况：\n$$r_k \\sim \\mathcal{N}(0, \\sigma^2)$$\n备择假设 $\\mathcal{H}_1$ 对应于存在正均值偏差故障的情况：\n$$r_k \\sim \\mathcal{N}(f, \\sigma^2), \\quad \\text{with } f > 0$$\n方差 $\\sigma^2$ 作为已知值给出，即 $\\hat{\\sigma}^2 = 0.09$。因此，标准差为 $\\sigma = \\sqrt{0.09} = 0.3$。\n决策规则是，如果观测到的残差 $r_k$ 超过阈值 $\\gamma$，即 $r_k > \\gamma$，则宣告故障。\n\n首先，我们确定阈值 $\\gamma$。\n误报概率 $\\alpha$ 是指在没有故障时（即 $\\mathcal{H}_0$ 为真时）宣告故障的概率。设计规范要求 $\\alpha = 1.0 \\times 10^{-3}$。\n根据定义，\n$$\\alpha = P(\\text{declare fault} | \\mathcal{H}_0) = P(r_k > \\gamma | r_k \\sim \\mathcal{N}(0, \\sigma^2))$$\n为计算此概率，我们将随机变量 $r_k$ 标准化。令 $Z = \\frac{r_k - \\mu}{\\sigma}$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。在 $\\mathcal{H}_0$ 下，均值 $\\mu$ 为 $0$。\n不等式 $r_k > \\gamma$ 可以用标准正态变量 $Z$ 重写：\n$$\\frac{r_k}{\\sigma} > \\frac{\\gamma}{\\sigma} \\implies Z > \\frac{\\gamma}{\\sigma}$$\n因此，误报概率为 $\\alpha = P(Z > \\frac{\\gamma}{\\sigma})$。\n令 $\\Phi(z)$ 为标准正态分布的累积分布函数（CDF），定义为 $\\Phi(z) = P(Z \\le z)$。那么，$P(Z > z) = 1 - \\Phi(z)$。\n所以，我们有关系式：\n$$\\alpha = 1 - \\Phi\\left(\\frac{\\gamma}{\\sigma}\\right)$$\n对 CDF 进行整理，得到 $\\Phi(\\frac{\\gamma}{\\sigma}) = 1 - \\alpha$。\n为了求出 $\\Phi$ 的参数，我们使用其逆累积分布函数 $\\Phi^{-1}$：\n$$\\frac{\\gamma}{\\sigma} = \\Phi^{-1}(1 - \\alpha)$$\n这给出了阈值 $\\gamma$ 的解析表达式：\n$$\\gamma = \\sigma \\Phi^{-1}(1 - \\alpha)$$\n给定 $\\sigma = 0.3$ 和 $\\alpha = 0.001$。我们代入这些值：\n$$\\gamma = 0.3 \\times \\Phi^{-1}(1 - 0.001) = 0.3 \\times \\Phi^{-1}(0.999)$$\n值 $\\Phi^{-1}(0.999)$ 对应于尾部概率为 $0.001$ 的 z-score。从标准正态分布表或计算器可知，$\\Phi^{-1}(0.999) \\approx 3.09023$。\n$$\\gamma \\approx 0.3 \\times 3.09023 \\approx 0.927069$$\n四舍五入到四位有效数字，阈值为 $\\gamma \\approx 0.9271$。\n\n接下来，我们确定最小可检测正均值偏移 $f_{\\min}$。\n检测概率 $\\beta$ 是指在存在故障时（即 $\\mathcal{H}_1$ 为真时）正确宣告故障的概率。对于最小可检测幅值 $f_{\\min}$，问题指定 $\\beta = 0.95$。\n根据定义，\n$$\\beta = P(\\text{declare fault} | \\mathcal{H}_1 \\text{ with } f=f_{\\min}) = P(r_k > \\gamma | r_k \\sim \\mathcal{N}(f_{\\min}, \\sigma^2))$$\n再次，我们将随机变量 $r_k$ 标准化，这次是在 $\\mathcal{H}_1$ 下。现在的均值是 $\\mu=f_{\\min}$。\n$$Z = \\frac{r_k - f_{\\min}}{\\sigma} \\sim \\mathcal{N}(0, 1)$$\n不等式 $r_k > \\gamma$ 变为：\n$$r_k - f_{\\min} > \\gamma - f_{\\min} \\implies \\frac{r_k - f_{\\min}}{\\sigma} > \\frac{\\gamma - f_{\\min}}{\\sigma} \\implies Z > \\frac{\\gamma - f_{\\min}}{\\sigma}$$\n因此，检测概率为：\n$$\\beta = P\\left(Z > \\frac{\\gamma - f_{\\min}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\gamma - f_{\\min}}{\\sigma}\\right)$$\n对 CDF 进行整理，得到 $\\Phi(\\frac{\\gamma - f_{\\min}}{\\sigma}) = 1 - \\beta$。\n应用逆 CDF：\n$$\\frac{\\gamma - f_{\\min}}{\\sigma} = \\Phi^{-1}(1 - \\beta)$$\n现在，我们求解 $f_{\\min}$：\n$$\\gamma - f_{\\min} = \\sigma \\Phi^{-1}(1 - \\beta)$$\n$$f_{\\min} = \\gamma - \\sigma \\Phi^{-1}(1 - \\beta)$$\n我们可以代入之前推导出的 $\\gamma$ 的表达式，$\\gamma = \\sigma \\Phi^{-1}(1 - \\alpha)$：\n$$f_{\\min} = \\sigma \\Phi^{-1}(1 - \\alpha) - \\sigma \\Phi^{-1}(1 - \\beta) = \\sigma \\left( \\Phi^{-1}(1 - \\alpha) - \\Phi^{-1}(1 - \\beta) \\right)$$\n注意标准正态分布的一个性质：$\\Phi^{-1}(p) = -\\Phi^{-1}(1-p)$。这使我们可以写出 $\\Phi^{-1}(1-\\beta) = -\\Phi^{-1}(\\beta)$。\n$$f_{\\min} = \\sigma \\left( \\Phi^{-1}(1 - \\alpha) + \\Phi^{-1}(\\beta) \\right)$$\n给定 $\\sigma = 0.3$，$\\alpha = 0.001$ 和 $\\beta = 0.95$。\n$$f_{\\min} = 0.3 \\times \\left( \\Phi^{-1}(0.999) + \\Phi^{-1}(0.95) \\right)$$\n使用之前得到的 $\\Phi^{-1}(0.999) \\approx 3.09023$ 的值，并求得 $\\Phi^{-1}(0.95) \\approx 1.64485$：\n$$f_{\\min} \\approx 0.3 \\times (3.09023 + 1.64485) = 0.3 \\times 4.73508$$\n$$f_{\\min} \\approx 1.420524$$\n四舍五入到四位有效数字，最小可检测故障为 $f_{\\min} \\approx 1.421$。\n\n所需的值为 $\\gamma \\approx 0.9271$ 和 $f_{\\min} \\approx 1.421$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.9271 & 1.421 \\end{pmatrix}}$$", "id": "2706769"}, {"introduction": "在实际应用中，系统不仅受测量噪声影响，还面临各种未知外部扰动。本练习将介绍一种更为先进的鲁棒残差设计方法，即 $H_{\\infty}$ 最优控制。您将学习如何设计一个观测器，使其在最大程度上抑制扰动对残差的影响（最小化 $||T_{dr}||_{\\infty}$），同时保持对故障的敏感性（评估 $||T_{fr}||_{\\infty}$），这是现代FDI系统设计的核心挑战之一。 [@problem_id:2706757]", "problem": "为带有扰动和故障通道的连续时间单输入单输出线性时不变系统设计一个残差生成器。该对象由以下状态空间方程建模：\n$$\n\\dot{x}(t)=a\\,x(t)+b_w\\,w(t)+b_f\\,f(t),\\quad y(t)=c\\,x(t)+v(t),\n$$\n其中 $x(t)\\in\\mathbb{R}$ 是状态，$y(t)\\in\\mathbb{R}$ 是测量输出，$w(t)\\in\\mathbb{R}$ 是外源扰动（未测量），$f(t)\\in\\mathbb{R}$ 是故障输入（未测量），$v(t)\\in\\mathbb{R}$ 是测量噪声（未测量）。残差生成器是一个Luenberger型观测器，定义如下：\n$$\n\\dot{\\hat{x}}(t)=a\\,\\hat{x}(t)+L\\left(y(t)-c\\,\\hat{x}(t)\\right),\\quad r(t)=y(t)-c\\,\\hat{x}(t),\n$$\n其中 $L\\in\\mathbb{R}$ 是待合成的观测器增益。令估计误差为 $e(t)=x(t)-\\hat{x}(t)$。则误差和残差动态为：\n$$\n\\dot{e}(t)=\\left(a-L\\,c\\right)e(t)+b_w\\,w(t)+b_f\\,f(t)-L\\,v(t),\\quad r(t)=c\\,e(t)+v(t).\n$$\n定义扰动向量 $d(t)=\\begin{bmatrix}w(t)\\\\ v(t)\\end{bmatrix}$。从 $d(t)$ 到 $r(t)$ 的闭环传递函数记为 $T_{dr}(s)$，从 $f(t)$ 到 $r(t)$ 的传递函数记为 $T_{fr}(s)$。合成目标是最小化 $T_{dr}(s)$ 的诱导$\\mathcal{H}_{\\infty}$范数，即最小化\n$$\n\\gamma=\\left\\|T_{dr}\\right\\|_{\\infty}=\\sup_{\\omega\\in\\mathbb{R}}\\;\\overline{\\sigma}\\!\\left(T_{dr}(\\mathrm{j}\\omega)\\right),\n$$\n同时受限于观测器误差动态的内部稳定性。使用有界实引理推导$\\mathcal{H}_{\\infty}$最优观测器增益 $L^{\\star}$ 的构造性表达式以及相应的最小值 $\\gamma^{\\star}=\\left\\|T_{dr}\\right\\|_{\\infty}$。然后计算所实现的故障到残差的诱导$\\mathcal{H}_{\\infty}$范数：\n$$\ng_f=\\left\\|T_{fr}\\right\\|_{\\infty}.\n$$\n您的程序必须实现该合成，并为以下每个由元组 $\\left(a,b_w,b_f,c\\right)$ 指定的测试用例计算 $\\left(L^{\\star},\\gamma^{\\star},g_f\\right)$：\n- 测试 $1$：$\\left(a,b_w,b_f,c\\right)=\\left(-1.0,1.0,1.0,1.0\\right)$。\n- 测试 $2$：$\\left(a,b_w,b_f,c\\right)=\\left(1.0,0.5,2.0,2.0\\right)$。\n- 测试 $3$：$\\left(a,b_w,b_f,c\\right)=\\left(-2.0,0.0,0.5,1.5\\right)$。\n- 测试 $4$：$\\left(a,b_w,b_f,c\\right)=\\left(0.3,1.1,0.7,-1.2\\right)$。\n\n对于每个测试，您必须假设 $c\\neq 0$ 并返回实数。最终输出必须是包含结果列表的单行，其中每个结果是包含三个浮点数 $\\left[L^{\\star},\\gamma^{\\star},g_f\\right]$ 的列表，每个数字都四舍五入到小数点后恰好六位。例如，输出格式必须是\n$$\n\\left[\\left[L^{\\star}_1,\\gamma^{\\star}_1,g_{f,1}\\right],\\left[L^{\\star}_2,\\gamma^{\\star}_2,g_{f,2}\\right],\\ldots\\right],\n$$\n以单行打印，不含任何附加文本。不涉及物理单位。不涉及角度。所有输出都必须是十进制浮点数。您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表，格式完全如下：\n$$\n\\left[\\left[L_1,\\gamma_1,g_1\\right],\\left[L_2,\\gamma_2,g_2\\right],\\left[L_3,\\gamma_3,g_3\\right],\\left[L_4,\\gamma_4,g_4\\right]\\right].\n$$", "solution": "所述问题需进行验证。\n\n**步骤1：提取已知条件**\n-   对象模型：$\\dot{x}(t)=a\\,x(t)+b_w\\,w(t)+b_f\\,f(t)$, $y(t)=c\\,x(t)+v(t)$。\n-   输入：$x,y,w,f,v \\in \\mathbb{R}$。$d(t) = [w(t), v(t)]^T$ 是扰动向量。\n-   参数：$a, b_w, b_f, c \\in \\mathbb{R}$，且有约束 $c \\neq 0$。\n-   残差生成器：$\\dot{\\hat{x}}(t)=a\\,\\hat{x}(t)+L\\left(y(t)-c\\,\\hat{x}(t)\\right)$, $r(t)=y(t)-c\\,\\hat{x}(t)$。\n-   误差动态：$\\dot{e}(t)=\\left(a-L\\,c\\right)e(t)+b_w\\,w(t)+b_f\\,f(t)-L\\,v(t)$, $r(t)=c\\,e(t)+v(t)$。\n-   目标1：求解 $\\min_{L} \\gamma = \\left\\|T_{dr}\\right\\|_{\\infty}$，找到观测器增益 $L^{\\star}$ 和最小范数 $\\gamma^{\\star}$，同时满足误差动态的稳定性，其中 $T_{dr}(s)$ 是从 $d(t)$ 到 $r(t)$ 的传递函数。\n-   目标2：对于得到的 $L^{\\star}$，计算 $g_f=\\left\\|T_{fr}\\right\\|_{\\infty}$，其中 $T_{fr}(s)$ 是从 $f(t)$ 到 $r(t)$ 的传递函数。\n-   方法论：使用有界实引理辅助推导。\n-   测试用例：提供了四个 $(a, b_w, b_f, c)$ 的元组。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 这是一个鲁棒控制理论中的标准练习，具体涉及用于故障检测与隔离的$\\mathcal{H}_{\\infty}$最优观测器设计。其模型、方法（有界实引理）和目标都是该领域的基本概念。\n-   **适定性：** 问题定义清晰，具有特定的数学目标。系统的标量性质简化了分析，并且提供了所有必要的参数使其可解。约束 $c \\neq 0$ 至关重要，因为它确保了状态能从输出中被观测到，这是设计功能正常的观测器的必要条件。\n-   **客观性：** 问题以精确的数学术语陈述，没有歧义或主观内容。\n\n**步骤3：结论与行动**\n该问题是有效的。这是一个在控制系统工程中适定且科学合理的问题。将推导其解决方案。\n\n**最优残差生成器的推导**\n\n**1. 扰动到残差的传递函数**\n首先，我们在拉普拉斯域中将误差系统形式化。误差动态可以表示为：\n$$\n\\dot{e}(t) = (a-Lc)e(t) + \\begin{bmatrix} b_w & -L \\end{bmatrix} d(t)\n$$\n$$\nr(t) = c e(t) + \\begin{bmatrix} 0 & 1 \\end{bmatrix} d(t)\n$$\n从扰动输入 $d(s)$ 到残差输出 $r(s)$ 的传递函数 $T_{dr}(s)$ 由 $C_{cl}(sI-A_{cl})^{-1}B_{cl}+D_{cl}$ 给出，其中 $A_{cl} = a-Lc$, $B_{cl} = \\begin{bmatrix} b_w & -L \\end{bmatrix}$, $C_{cl} = c$, $D_{cl} = \\begin{bmatrix} 0 & 1 \\end{bmatrix}$。对于这个标量系统，这变成：\n$$\nr(s) = c(s-(a-Lc))^{-1}(b_w w(s) - L v(s)) + v(s)\n$$\n$$\nr(s) = \\left( \\frac{c b_w}{s-a+Lc} \\right) w(s) + \\left( 1 - \\frac{c L}{s-a+Lc} \\right) v(s)\n$$\n$$\nr(s) = \\frac{1}{s-a+Lc} \\left( (c b_w) w(s) + (s-a) v(s) \\right)\n$$\n因此，从 $d(s)=\\begin{bmatrix}w(s)\\\\v(s)\\end{bmatrix}$ 到 $r(s)$ 的传递函数是 $1 \\times 2$ 矩阵：\n$$\nT_{dr}(s) = \\frac{1}{s-a+Lc} \\begin{bmatrix} c b_w & s-a \\end{bmatrix}\n$$\n\n**2. $\\mathcal{H}_{\\infty}$范数分析与优化**\n合成目标是在误差动态稳定性的约束下最小化 $\\gamma = \\left\\|T_{dr}\\right\\|_{\\infty}$，对于这个标量系统，这要求极点 $a-Lc$ 位于开左半复平面，即 $a-Lc  0$。$\\mathcal{H}_{\\infty}$范数是频率响应矩阵在所有频率 $\\omega$ 上的最大奇异值的上确界。对于一个 $1 \\times 2$ 矩阵，这是其欧几里得范数。\n$$\n\\gamma^2 = \\sup_{\\omega \\in \\mathbb{R}} \\|T_{dr}(j\\omega)\\|_2^2 = \\sup_{\\omega \\in \\mathbb{R}} T_{dr}(j\\omega) T_{dr}(j\\omega)^H\n$$\n代入 $s=j\\omega$：\n$$\n\\|T_{dr}(j\\omega)\\|_2^2 = \\left( \\frac{1}{j\\omega-a+Lc} \\begin{bmatrix} c b_w  j\\omega-a \\end{bmatrix} \\right) \\left( \\frac{1}{-j\\omega-a+Lc} \\begin{bmatrix} c b_w \\\\ -j\\omega-a \\end{bmatrix} \\right)\n$$\n$$\n\\|T_{dr}(j\\omega)\\|_2^2 = \\frac{(cb_w)^2 + (j\\omega-a)(-j\\omega-a)}{ (j\\omega-a+Lc)(-j\\omega-a+Lc) } = \\frac{(cb_w)^2 + \\omega^2+a^2}{ \\omega^2+(Lc-a)^2 }\n$$\n令 $K_1 = a^2 + (cb_w)^2$ 且 $K_2 = (Lc-a)^2$。该表达式为 $g(\\omega^2) = \\frac{\\omega^2+K_1}{\\omega^2+K_2}$。这个关于 $\\omega^2$ 的函数的上确界出现在 $\\omega^2=0$ 或 $\\omega^2 \\to \\infty$ 时。\n-   在 $\\omega^2=0$ 时的值：$K_1/K_2$。\n-   当 $\\omega^2 \\to \\infty$ 时的值：$\\lim_{\\omega^2\\to\\infty} g(\\omega^2) = 1$。\n因此，$\\mathcal{H}_{\\infty}$范数的平方为 $\\gamma^2 = \\max\\left(1, \\frac{K_1}{K_2}\\right) = \\max\\left(1, \\frac{a^2+(cb_w)^2}{(Lc-a)^2}\\right)$。\n\n我们必须在稳定性约束 $Lc-a0$ 下，关于 $L$ 最小化这个 $\\gamma^2$。表达式 $\\frac{a^2+(cb_w)^2}{(Lc-a)^2}$ 总是非负的。为了最小化 $\\max(1, \\cdot)$，我们应使第二项尽可能小。该项的最小值为0，在 $|Lc-a| \\to \\infty$ 时趋近于0。在此极限下，$\\gamma^2 \\to \\max(1,0) = 1$。因此，范数的下确界值为 $\\gamma^\\star = 1$。\n\n**3. 最优增益合成**\n最优范数 $\\gamma^\\star=1$ 可由任何同时满足稳定性（$Lc-a  0$）和性能条件 $\\frac{a^2+(cb_w)^2}{(Lc-a)^2} \\le 1$ 的增益 $L$ 实现。后一个不等式等价于 $(Lc-a)^2 \\ge a^2+(cb_w)^2$。结合稳定性，这要求：\n$$\nLc-a \\ge \\sqrt{a^2+(cb_w)^2}\n$$\n问题要求一个单一的最优增益 $L^\\star$。在这种存在一组等优解的情况下，标准方法是选择在某种意义上是“最小”的那个解。我们选择将误差极点置于此条件边界上的增益，这对应于实现最优性能的最慢误差动态。这产生了一个唯一解：\n$$\nL^\\star c - a = \\sqrt{a^2+(cb_w)^2}\n$$\n求解 $L^\\star$（使用给定条件 $c \\neq 0$）：\n$$\nL^{\\star} = \\frac{a + \\sqrt{a^2 + (c b_w)^2}}{c}\n$$\n通过这个选择，我们有 $(L^\\star c - a)^2 = a^2+(cb_w)^2$，这使得 $\\gamma^2 = \\max(1,1)=1$。所以，最优范数为 $\\gamma^{\\star}=1$。对于所有提供的测试用例，$a^2+(cb_w)^2  0$，确保极点 $a-L^\\star c = -\\sqrt{a^2+(cb_w)^2}$ 严格位于左半平面。\n\n**4. 故障到残差的传递函数分析**\n接下来，我们评估实现的对故障的灵敏度，由 $g_f = \\|T_{fr}\\|_{\\infty}$ 量化。相关动态为 $\\dot{e}(t) = (a-L^\\star c) e(t) + b_f f(t)$ 和 $r(t) = c e(t)$。从故障 $f(s)$ 到残差 $r(s)$ 的传递函数是：\n$$\nT_{fr}(s) = c(s-(a-L^\\star c))^{-1}b_f = \\frac{c b_f}{s - a + L^\\star c}\n$$\n这是一个稳定的一阶系统。它的$\\mathcal{H}_{\\infty}$范数是其频率响应幅值的最大值，该最大值出现在 $\\omega=0$ 时：\n$$\ng_f = \\|T_{fr}\\|_{\\infty} = |T_{fr}(0)| = \\left|\\frac{c b_f}{-a+L^\\star c}\\right|\n$$\n代入分母的表达式 $-a+L^\\star c = \\sqrt{a^2+(cb_w)^2}$，我们得到：\n$$\ng_f = \\frac{|c b_f|}{\\sqrt{a^2 + (c b_w)^2}}\n$$\n这为每个测试用例提供了解决问题所需的完整公式集。", "answer": "$$\\boxed{\\begin{pmatrix} 0.414214  1.000000  0.707107 \\\\ 1.207107  1.000000  2.828427 \\\\ 0.000000  1.000000  0.375000 \\\\ -1.378052  1.000000  0.620550 \\end{pmatrix}}$$", "id": "2706757"}]}