{"hands_on_practices": [{"introduction": "第一个练习是理解卡尔曼滤波器长期行为的基石。通过从第一性原理出发，为一个简单的标量系统推导稳态误差协方差和卡尔曼增益，我们将深入理解滤波器如何平衡模型预测与新的测量数据。[@problem_id:2733975] 这项实践将培养求解代数Riccati方程这一核心技能，该方程在滤波器设计和分析中至关重要。", "problem": "考虑标量线性时不变随机系统\n$$x_{k+1}=a\\,x_k+w_k,\\qquad y_k=x_k+v_k,$$\n其中 $a\\in\\mathbb{R}$，过程噪声 $w_k$ 是零均值、白、高斯噪声，其方差为 $Q>0$；测量噪声 $v_k$ 是零均值、白、高斯噪声，其方差为 $R>0$；且 $\\{w_k\\}$、$\\{v_k\\}$ 和 $x_0$ 相互独立。在保证离散时间卡尔曼滤波器（Kalman filter, KF）存在唯一稳定稳态解的标准假设下，存在一个稳态后验误差方差 $P_\\infty$ 和一个稳态卡尔曼增益 $K_\\infty$。\n\n从高斯系统的线性最小方差估计的基本定义和相关的误差协方差递推公式出发，推导稳态后验误差方差 $P_\\infty$ 和稳态卡尔曼增益 $K_\\infty$ 作为 $a$、$Q$ 和 $R$ 函数的闭式表达式。你的推导应明确论证为何选择稳定根。然后，从第一性原理分析当 $a$、$Q$ 和 $R$ 变化时，$P_\\infty$ 和 $K_\\infty$ 如何变化，解释其变化方向以及在极端参数值下的任何极限行为。最后，以单行矩阵的形式给出你的答案，其中包含 $P_\\infty$ 和 $K_\\infty$ 的闭式表达式，仅用 $a$、$Q$ 和 $R$ 的符号表示。不需要进行数值计算，也不需要四舍五入。最终答案不得包含单位。", "solution": "本题要求推导一个标量线性时不变系统的稳态后验误差方差 $P_\\infty$ 和卡尔曼增益 $K_\\infty$，并进行参数分析。推导必须从第一性原理出发。\n\n系统由状态方程和测量方程定义：\n$$x_{k+1} = a x_k + w_k$$\n$$y_k = x_k + v_k$$\n其中 $w_k \\sim \\mathcal{N}(0, Q)$ 且 $v_k \\sim \\mathcal{N}(0, R)$，且 $Q > 0$，$R > 0$。系统矩阵为 $F=a$ 和 $H=1$。\n\n误差协方差的卡尔曼滤波器方程由预测和更新步骤给出。设 $P_{k|k}$ 为步骤 $k$ 的后验误差方差，$P_{k|k-1}$ 为先验误差方差。\n\n协方差的预测步骤为：\n$$P_{k|k-1} = F P_{k-1|k-1} F^T + Q = a^2 P_{k-1|k-1} + Q$$\n\n卡尔曼增益 $K_k$ 和后验协方差 $P_{k|k}$ 的更新步骤方程为：\n$$K_k = P_{k|k-1} H^T (H P_{k|k-1} H^T + R)^{-1} = \\frac{P_{k|k-1}}{P_{k|k-1} + R}$$\n$$P_{k|k} = (I - K_k H) P_{k|k-1} = (1 - K_k) P_{k|k-1}$$\n\n将 $K_k$ 的表达式代入协方差更新方程，得到：\n$$P_{k|k} = \\left(1 - \\frac{P_{k|k-1}}{P_{k|k-1} + R}\\right) P_{k|k-1} = \\frac{R}{P_{k|k-1} + R} P_{k|k-1}$$\n这个关系可以通过信息滤波器形式 $P_{k|k}^{-1} = P_{k|k-1}^{-1} + R^{-1}$ 来表示。\n\n为了找到后验方差的单一递推关系，我们将预测方程代入更新方程。令 $P_k \\equiv P_{k|k}$：\n$$P_k = \\frac{R (a^2 P_{k-1} + Q)}{a^2 P_{k-1} + Q + R}$$\n这是后验方差的离散时间黎卡提方程。\n\n在稳态下，方差收敛到一个常数值，$P_k = P_{k-1} = P_\\infty$。黎卡提方程变为离散代数黎卡提方程 (DARE)：\n$$P_\\infty = \\frac{R (a^2 P_\\infty + Q)}{a^2 P_\\infty + Q + R}$$\n整理该方程可得到关于 $P_\\infty$ 的一个二次方程：\n$$P_\\infty (a^2 P_\\infty + Q + R) = R (a^2 P_\\infty + Q)$$\n$$a^2 P_\\infty^2 + Q P_\\infty + R P_\\infty = a^2 R P_\\infty + Q R$$\n$$a^2 P_\\infty^2 + (Q + R - a^2 R) P_\\infty - Q R = 0$$\n\n我们使用二次求根公式 $x = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 来解这个关于 $P_\\infty$ 的二次方程，其中 $A = a^2$，$B = Q + R - a^2 R$，$C = -Q R$。\n$$P_\\infty = \\frac{-(Q + R - a^2 R) \\pm \\sqrt{(Q + R - a^2 R)^2 - 4(a^2)(-Q R)}}{2a^2}$$\n$$P_\\infty = \\frac{a^2 R - Q - R \\pm \\sqrt{(a^2 R - (Q+R))^2 + 4a^2 Q R}}{2a^2}$$\n判别式 $\\Delta = (a^2 R - (Q+R))^2 + 4a^2 Q R$ 严格为正，因为 $Q > 0, R > 0$。因此，存在两个不同的实根。由于 $A=a^2>0$ 且 $C=-QR  0$，两根之积为 $C/A  0$，这意味着一个根为正，一个根为负。因为 $P_\\infty$ 是误差方差，它必须是非负的，$P_\\infty \\ge 0$。因此，我们必须选择正根，这需要在分子中选择“$+$”号，因为 $\\sqrt{B^2-4AC} > |B|$。\n\n唯一的、具有物理意义的解是：\n$$P_\\infty = \\frac{a^2 R - Q - R + \\sqrt{(Q + R - a^2 R)^2 + 4a^2 Q R}}{2a^2}$$\n题目保证了存在唯一的稳定解。这个非负根就是该解。滤波器的稳定性由误差动态的极点 $\\lambda_{\\text{cl}} = a(1-K_\\infty)$ 决定。稳定的滤波器要求 $|\\lambda_{\\text{cl}}|  1$。选择 $P_\\infty$ 的正根确保了这一稳定性条件得到满足。\n\n接下来，我们推导稳态卡尔曼增益 $K_\\infty$。从更新方程中，我们有关系式 $P_\\infty^{-1} = P_{\\infty|\\infty-1}^{-1} + R^{-1}$ 和 $K_\\infty = P_{\\infty|\\infty-1}/(P_{\\infty|\\infty-1}+R)$。由第一个关系式可得 $P_{\\infty|\\infty-1} = \\frac{P_\\infty R}{R-P_\\infty}$。将其代入第二个关系式得到：\n$$K_\\infty = \\frac{\\frac{P_\\infty R}{R-P_\\infty}}{\\frac{P_\\infty R}{R-P_\\infty} + R} = \\frac{P_\\infty R}{P_\\infty R + R(R-P_\\infty)} = \\frac{P_\\infty R}{R^2} = \\frac{P_\\infty}{R}$$\n对于这个标量系统，简单的关系式 $K_\\infty = P_\\infty / R$ 成立。使用 $P_\\infty$ 的表达式：\n$$K_\\infty = \\frac{a^2 R - Q - R + \\sqrt{(Q + R - a^2 R)^2 + 4a^2 Q R}}{2a^2 R}$$\n\n最后，我们分析 $P_\\infty$ 和 $K_\\infty$ 相对于参数 $a$、$Q$ 和 $R$ 的行为。\n\n1.  **对过程噪声方差 $Q$ 的依赖性**：\n    -   $P_\\infty$：当 $Q$ 增加时，状态预测的不确定性增大。滤波器必须更多地依赖测量，但总体的估计误差方差 $P_\\infty$ 会增加。因此，$\\frac{\\partial P_\\infty}{\\partial Q} > 0$。\n        在极限情况 $Q \\to 0$ 时，对于稳定的开环系统（$|a|1$），状态收敛到零并且可以被完美估计，所以 $P_\\infty \\to 0$。对于不稳定的系统（$|a| \\ge 1$），估计仍然是必要的，且 $P_\\infty \\to R(1-1/a^2)$。\n        在极限情况 $Q \\to \\infty$ 时，状态预测变得无用。后验方差仅受限于测量质量，因此 $P_\\infty \\to R$。\n    -   $K_\\infty$：$Q$ 的增加意味着模型预测的可靠性降低。因此，滤波器会给予测量新息更大的权重，所以增益增加。$\\frac{\\partial K_\\infty}{\\partial Q} > 0$。当 $Q \\to \\infty$ 时，$K_\\infty \\to 1$。\n\n2.  **对测量噪声方差 $R$ 的依赖性**：\n    -   $P_\\infty$：当 $R$ 增加时，测量的可靠性降低。这直接削弱了滤波器修正其估计的能力，导致更高的后验误差方差。因此，$\\frac{\\partial P_\\infty}{\\partial R} > 0$。\n        在极限情况 $R \\to 0$（完美测量）时，误差方差趋于零，$P_\\infty \\to 0$。\n        在极限情况 $R \\to \\infty$（无有效测量）时，滤波器执行开环预测。对于稳定的系统（$|a|1$），误差方差收敛于过程方差，$P_\\infty \\to \\frac{Q}{1-a^2}$。对于不稳定的系统（$|a| \\ge 1$），误差方差无界增长。\n    -   $K_\\infty$：当 $R$ 增加时，滤波器对带噪声的测量的信任度降低，因此增益减小。$\\frac{\\partial K_\\infty}{\\partial R}  0$。\n        在极限情况 $R \\to 0$ 时，$K_\\infty \\to 1$（完全信任完美测量）。\n        在极限情况 $R \\to \\infty$ 时，$K_\\infty \\to 0$（不信任无用的测量）。\n\n3.  **对系统参数 $a$ 的依赖性**：\n    -   $P_\\infty$：当 $|a|$ 增加时，系统动态变得更快或更不稳定，使得状态更难预测和估计。这导致更大的估计误差。因此，$\\frac{\\partial P_\\infty}{\\partial |a|} > 0$。\n        在极限情况 $a \\to 0$ 时，系统变为 $x_{k+1}=w_k$，且 $P_\\infty \\to \\frac{QR}{Q+R}$。\n        在极限情况 $|a| \\to \\infty$ 时，预测值 $a\\hat{x}_{k-1|k-1}$ 变得极大且不确定。先验方差 $P_{\\infty|\\infty-1}$ 实际上变为无穷大，导致滤波器放弃预测而完全依赖于测量。后验误差变为测量误差，因此 $P_\\infty \\to R$。\n    -   $K_\\infty$：由于 $K_\\infty=P_\\infty/R$，其对 $a$ 的依赖性与 $P_\\infty$ 相同。$\\frac{\\partial K_\\infty}{\\partial |a|} > 0$。当 $|a| \\to \\infty$ 时，$P_\\infty \\to R$，因此 $K_\\infty \\to 1$。\n\n$P_\\infty$ 和 $K_\\infty$ 的闭式表达式构成了最终答案。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{a^2 R - Q - R + \\sqrt{(Q + R - a^2 R)^2 + 4a^2 Q R}}{2a^2}  \\frac{a^2 R - Q - R + \\sqrt{(Q + R - a^2 R)^2 + 4a^2 Q R}}{2a^2 R} \\end{pmatrix}}$$", "id": "2733975"}, {"introduction": "一个最优估计器不仅能追踪当前状态，还能预测未来并修正过去。这项练习将通过为一个随机游走模型计算并比较一步预测、实时滤波和事后平滑的误差方差，来扩展我们的视野。[@problem_id:2733966] 解决这个问题将揭示与每种估计类型相关的基本权衡以及明确的不确定性层级关系，从而深化对信息如何随时间整合以减少不确定性的理解。", "problem": "考虑一个在加性噪声中观测到的离散时间标量随机游走。状态演化为 $x_{k+1} = x_{k} + w_{k}$，其中 $w_{k} \\sim \\mathcal{N}(0, Q)$ 是独立同分布的高斯过程扰动，其方差为 $Q \\in \\mathbb{R}_{0}$。测量值为 $y_{k} = x_{k} + v_{k}$，其中 $v_{k} \\sim \\mathcal{N}(0, R)$ 是独立同分布的高斯测量扰动，其方差为 $R \\in \\mathbb{R}_{0}$，且与 $\\{w_{k}\\}$ 独立。假设系统已运行足够长的时间，以至于稳态误差协方差存在。\n\n仅使用卡尔曼滤波器和 Rauch–Tung–Striebel (RTS) 平滑器的定义递归式，从第一性原理推导以下各项的稳态误差方差：\n- 先验一步预测（测量更新前预测误差的方差），\n- 后验滤波估计（在同一时间点上，紧随测量更新后的估计误差的方差），\n- 任意内部时间的固定区间无限时域平滑估计（给定整个双无限测量序列的估计误差的方差）。\n\n将这些稳态方差中的每一个都表示为仅含 $Q$ 和 $R$ 的闭式解析函数。将你的最终答案以单行矩阵的形式报告，其条目依次为稳态预测方差、滤波方差和平滑方差。无需数值近似；请提供精确的符号表达式。最终答案中不要包含单位。", "solution": "该问题陈述已经过验证，被认为是科学上可靠、适定且客观的。它代表了最优估计理论中的一个典型问题。我们可以进行正式推导。\n\n该系统是一个离散时间线性时不变（LTI）标量系统，描述如下：\n状态方程：$x_{k+1} = A x_{k} + w_{k}$\n测量方程：$y_{k} = H x_{k} + v_{k}$\n对于给定的随机游走模型，系统矩阵为 $A=1$ 和 $H=1$。过程噪声 $w_k$ 和测量噪声 $v_k$ 是零均值、白色、高斯且相互独立的，其方差分别为 $E[w_k^2] = Q$ 和 $E[v_k^2] = R$，其中 $Q>0$ 和 $R>0$。\n\n卡尔曼滤波器提供状态 $x_k$ 的最优估计。与这些估计相关的误差方差由以下递归式控制：\n令 $P_{k|k-1}$ 为估计值 $\\hat{x}_{k|k-1} = E[x_k | y_1, ..., y_{k-1}]$ 的先验误差方差（预测方差）。\n令 $P_{k|k}$ 为估计值 $\\hat{x}_{k|k} = E[x_k | y_1, ..., y_k]$ 的后验误差方差（滤波方差）。\n\n这些方差的滤波器递归式为：\n1. 时间更新（预测）：$P_{k|k-1} = A P_{k-1|k-1} A^T + Q$。对于我们的系统，这变为 $P_{k|k-1} = P_{k-1|k-1} + Q$。\n2. 测量更新（校正）：\n   卡尔曼增益为 $K_k = P_{k|k-1} H^T (H P_{k|k-1} H^T + R)^{-1}$。对于我们的系统，$K_k = \\frac{P_{k|k-1}}{P_{k|k-1} + R}$。\n   后验方差为 $P_{k|k} = (I - K_k H) P_{k|k-1}$。对于我们的系统，$P_{k|k} = \\left(1 - \\frac{P_{k|k-1}}{P_{k|k-1} + R}\\right) P_{k|k-1} = \\frac{R}{P_{k|k-1} + R} P_{k|k-1}$。\n\n问题假设系统已达到稳态，意味着方差不随时间变化。令 $P_{pred} = \\lim_{k\\to\\infty} P_{k|k-1}$ 和 $P_{filt} = \\lim_{k\\to\\infty} P_{k|k}$。递归式变为代数方程：\n(1) $P_{pred} = P_{filt} + Q$\n(2) $P_{filt} = \\frac{R}{P_{pred} + R} P_{pred}$\n\n通过将(1)代入(2)，我们可以求解 $P_{filt}$，但更直接的方法是求解 $P_{pred}$ 的离散代数 Riccati 方程 (DARE)。将两个更新步骤合并为关于 $P_{k|k-1}$ 的一个方程：\n$P_{k|k-1} = A \\left((I - K_{k-1}H)P_{k-1|k-2}\\right) A^T + Q$。\n在稳态下，$P_{k|k-1} = P_{k-1|k-2} = P_{pred}$，因此 $P_{pred}$ 的 DARE 为：\n$P_{pred} = A \\left( (I - K H) P_{pred} \\right) A^T + Q$，其中 $K = \\frac{P_{pred}}{P_{pred}+R}$。\n代入系统参数 $A=1$, $H=1$：\n$P_{pred} = 1 \\cdot \\left( \\left(1 - \\frac{P_{pred}}{P_{pred}+R}\\right) P_{pred} \\right) \\cdot 1 + Q$\n$P_{pred} = \\left( \\frac{R}{P_{pred}+R} \\right) P_{pred} + Q$\n$P_{pred} (P_{pred}+R) = R P_{pred} + Q (P_{pred}+R)$\n$P_{pred}^2 + R P_{pred} = R P_{pred} + Q P_{pred} + QR$\n$P_{pred}^2 - Q P_{pred} - QR = 0$\n\n这是一个关于 $P_{pred}$ 的二次方程。其解由二次公式给出：\n$P_{pred} = \\frac{-(-Q) \\pm \\sqrt{(-Q)^2 - 4(1)(-QR)}}{2(1)} = \\frac{Q \\pm \\sqrt{Q^2 + 4QR}}{2}$。\n由于方差必须为非负值（$P_{pred} \\ge 0$），并且给定 $Q>0, R>0$，我们必须选择正根：\n$P_{pred} = \\frac{Q + \\sqrt{Q^2 + 4QR}}{2}$。\n这是稳态预测误差方差。\n\n现在，我们使用方程(1)来求稳态滤波方差 $P_{filt}$：\n$P_{filt} = P_{pred} - Q = \\frac{Q + \\sqrt{Q^2 + 4QR}}{2} - Q = \\frac{-Q + \\sqrt{Q^2 + 4QR}}{2}$。\n这是稳态滤波误差方差。\n\n接下来，我们推导稳态平滑误差方差。Rauch-Tung-Striebel (RTS) 平滑器在给定一批截至时间 $N  k$ 的测量值的情况下，提供最优估计 $\\hat{x}_{k|N}$。相应的误差方差 $P_{k|N}$ 由以下递归式给出：\n$P_{k|N} = P_{k|k} + C_k (P_{k+1|N} - P_{k+1|k}) C_k^T$，其中 $C_k = P_{k|k} A^T P_{k+1|k}^{-1}$。\n\n对于在稳态系统上运行的无限时域平滑器，我们考虑 $N \\to \\infty$ 的极限。所有方差都变为常数：$P_{k|N} \\to P_{smooth}$，$P_{k|k} \\to P_{filt}$，$P_{k+1|k} \\to P_{pred}$。平滑器增益变为 $C_s = P_{filt} A^T P_{pred}^{-1} = \\frac{P_{filt}}{P_{pred}}$。\nRTS 方差递归式变为关于 $P_{smooth}$ 的一个代数方程：\n$P_{smooth} = P_{filt} + C_s (P_{smooth} - P_{pred}) C_s^T = P_{filt} + \\left(\\frac{P_{filt}}{P_{pred}}\\right)^2 (P_{smooth} - P_{pred})$。\n我们求解 $P_{smooth}$：\n$P_{smooth} \\left(1 - \\frac{P_{filt}^2}{P_{pred}^2}\\right) = P_{filt} - \\frac{P_{filt}^2}{P_{pred}}$\n$P_{smooth} \\left(\\frac{P_{pred}^2 - P_{filt}^2}{P_{pred}^2}\\right) = \\frac{P_{filt} P_{pred} - P_{filt}^2}{P_{pred}}$\n$P_{smooth} \\frac{(P_{pred}-P_{filt})(P_{pred}+P_{filt})}{P_{pred}^2} = \\frac{P_{filt}(P_{pred}-P_{filt})}{P_{pred}}$。\n由(1)可知，$P_{pred}-P_{filt} = Q$。因为 $Q>0$，该项非零，可以消去：\n$P_{smooth} \\frac{P_{pred}+P_{filt}}{P_{pred}^2} = \\frac{P_{filt}}{P_{pred}}$。\n$P_{smooth} = \\frac{P_{filt} P_{pred}}{P_{pred} + P_{filt}}$。\n\n为了用 $Q$ 和 $R$ 表示此式，我们代入 $P_{pred}$ 和 $P_{filt}$ 的表达式。\n乘积 $P_{filt} P_{pred}$ 可以从 DARE $P_{pred}^2 - Q P_{pred} - QR = 0$ 得到，这意味着 $P_{pred}(P_{pred}-Q) = QR$。由于 $P_{filt}=P_{pred}-Q$，我们有 $P_{filt}P_{pred} = QR$。\n和为 $P_{pred} + P_{filt} = \\left(\\frac{Q + \\sqrt{Q^2 + 4QR}}{2}\\right) + \\left(\\frac{-Q + \\sqrt{Q^2 + 4QR}}{2}\\right) = \\frac{2\\sqrt{Q^2 + 4QR}}{2} = \\sqrt{Q^2 + 4QR}$。\n代入这些结果：\n$P_{smooth} = \\frac{QR}{\\sqrt{Q^2 + 4QR}}$。\n这是稳态平滑误差方差。\n\n所求的三个方差为：\n预测方差：$\\frac{Q + \\sqrt{Q^2 + 4QR}}{2}$\n滤波方差：$\\frac{-Q + \\sqrt{Q^2 + 4QR}}{2}$\n平滑方差：$\\frac{QR}{\\sqrt{Q^2 + 4QR}}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Q + \\sqrt{Q^2 + 4QR}}{2}  \\frac{-Q + \\sqrt{Q^2 + 4QR}}{2}  \\frac{QR}{\\sqrt{Q^2 + 4QR}}\n\\end{pmatrix}\n}\n$$", "id": "2733966"}, {"introduction": "理论上的最优性在面对有限精度计算时可能很脆弱。这最后一个实践探讨了一个关键的现实问题：协方差更新步骤的数值稳定性。[@problem_id:2733957] 通过一个精心设计的病态条件例子，您将看到一个理论上正确的公式在实践中如何失效，并发现为什么像Joseph形式这样的替代形式对于实现鲁棒的滤波器至关重要，确保了协方差矩阵的正定性得以保持。", "problem": "考虑以下线性高斯估计问题，该问题说明了不当的坐标选择如何在朴素的协方差更新中导致数值计算上正半定性 (PSD) 的丢失。设先验状态 $x \\in \\mathbb{R}^{2}$ 的均值为零，先验协方差为\n$$\nP^{-} \\;=\\; \\begin{pmatrix}\n1  1-\\varepsilon\\\\\n1-\\varepsilon  1\n\\end{pmatrix},\n$$\n其中 $0  \\varepsilon \\ll 1$。进行一次标量测量，\n$$\ny \\;=\\; H x + v,\\quad H \\;=\\; \\begin{pmatrix} 1  -1 \\end{pmatrix},\\quad v \\sim \\mathcal{N}(0,\\rho),\n$$\n其中 $0  \\rho \\ll 1$。所有量均为无量纲。这种坐标选择使得两个状态分量几乎相等，导致测量提取的是微小的差值 $x_{1}-x_{2}$，从而造成一个高度病态的新息。\n\n从线性最小均方误差估计器和正交性原理的第一性原理出发进行推导（不要先验地假设任何教科书上的协方差“更新公式”）。按以下步骤进行。\n\n1) 推导最小化后验均方误差的唯一线性估计器 $\\hat{x}^{+} = \\hat{x}^{-} + K\\,(y - H \\hat{x}^{-})$，并将得到的后验误差协方差 $P^{+}$ 仅用 $P^{-}$、$H$、$K$ 和 $\\rho$ 表示成一种能使其正半定性（PSD）属性显而易见的形式。\n\n2) 将您的结果应用于给定的 $P^{-}$、$H$ 和 $\\rho$，并在标准正交基 $u = \\frac{1}{\\sqrt{2}}(1,1)^{\\top}$ 和 $v=\\frac{1}{\\sqrt{2}}(1,-1)^{\\top}$ 中对角化 $P^{-}$。仅使用上述定义，计算沿 $v$ 方向的后验方差，记为 $\\lambda_{v}^{+}$。\n\n3) 现在，在原始坐标系中对一个朴素的协方差更新进行建模，即 $P_{\\mathrm{naive}}^{+} = (I - K H) P^{-}$。假设由于在这个病态基下的有限精度舍入，沿 $v$ 方向的后验方差被一个大小为 $\\delta > 0$ 的扰动所减小。换句话说，沿 $v$ 方向的方差变为 $\\lambda_{v}^{+} - \\delta$。确定使 $P_{\\mathrm{naive}}^{+}$ 失去正半定性的最小扰动大小 $\\delta_{c}$，即沿 $v$ 方向的后验方差变为非正的阈值。\n\n4) 根据您在第 1 部分得到的表达式，简要论证为什么当协方差以明确的正半定项之和的形式更新时，同样的舍入效应不会破坏其正半定性，并解释坐标变换在加剧新息计算的病态性中所起的作用。\n\n对于具体值 $\\varepsilon = 10^{-8}$ 和 $\\rho = 10^{-12}$，计算您的最终表达式 $\\delta_{c}$ 的值，并将数值结果四舍五入到四位有效数字。以纯数（无单位）形式表示您的最终答案。", "solution": "所述问题具有科学依据、适定、客观且自洽。它是估计理论中的一个典范例子，展示了某些协方差更新公式的数值陷阱。所有必要的数据和定义均已提供。先验协方差矩阵 $P^{-}$ 的特征值为 $2-\\varepsilon$ 和 $\\varepsilon$。由于 $0  \\varepsilon \\ll 1$，两者均为正，因此 $P^{-}$ 是一个有效的正定协方差矩阵。该问题是有效的，可以求解。\n\n1) 最优估计器和后验协方差的推导。\n\n我们的任务是找到线性估计器 $\\hat{x}^{+} = \\hat{x}^{-} + K(y - H\\hat{x}^{-})$ 以最小化后验均方误差，即后验误差协方差 $P^{+} = E[(x-\\hat{x}^{+})(x-\\hat{x}^{+})^\\top]$ 的迹。给定先验均值 $\\hat{x}^{-} = E[x] = 0$。估计器形式简化为 $\\hat{x}^{+} = Ky$。\n\n后验估计误差为 $\\tilde{x}^{+} = x - \\hat{x}^{+} = x - Ky$。代入测量模型 $y = Hx+v$，我们得到：\n$$\n\\tilde{x}^{+} = x - K(Hx+v) = (I-KH)x - Kv\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。状态 $x$ 和噪声 $v$ 不相关，因此 $E[xv^\\top] = 0$。那么后验协方差为：\n$$\nP^{+} = E[\\tilde{x}^{+}(\\tilde{x}^{+})^\\top] = E[((I-KH)x - Kv)((I-KH)x - Kv)^\\top]\n$$\n$$\nP^{+} = E[(I-KH)xx^\\top(I-KH)^\\top - (I-KH)xv^\\top K^\\top - Kvx^\\top(I-KH)^\\top + Kvv^\\top K^\\top]\n$$\n利用期望的线性性质以及 $x$ 和 $v$ 的不相关性：\n$$\nP^{+} = (I-KH)E[xx^\\top](I-KH)^\\top - 0 - 0 + KE[vv^\\top]K^\\top\n$$\n根据定义 $P^{-} = E[xx^\\top]$ 和 $E[vv^\\top] = \\rho$（因为 $v$ 是标量），我们得到：\n$$\nP^{+} = (I-KH)P^{-}(I-KH)^\\top + K\\rho K^\\top\n$$\n这是协方差更新的 Joseph 形式。这种形式使得正半定（PSD）属性显而易见，因为它是两个正半定矩阵的和。$P^{-}$ 是 PSD 的，所以 $(I-KH)P^{-}(I-KH)^\\top$ 是 PSD 的。由于 $\\rho > 0$，$K\\rho K^\\top$ 也是 PSD 的。因此，它们的和保证是 PSD 的。\n\n为了找到最小化均方误差的最优增益矩阵 $K$，我们应用正交性原理，该原理指出估计误差必须与数据正交。对于线性估计器，这意味着 $E[\\tilde{x}^{+}y^\\top] = 0$。由于 $y$ 是标量，这即是 $E[\\tilde{x}^{+}y] = 0$。\n$$\nE[(x-Ky)y] = 0 \\implies E[xy] - KE[y^2] = 0\n$$\n这给出了最优增益 $K = E[xy](E[y^2])^{-1}$。我们计算这两个期望：\n$$\nE[xy] = E[x(Hx+v)^\\top] = E[xx^\\top H^\\top + xv^\\top] = E[xx^\\top]H^\\top = P^{-}H^\\top\n$$\n$$\nE[y^2] = E[(Hx+v)^2] = E[Hxx^\\top H^\\top + 2Hxv + v^2] = HE[xx^\\top]H^\\top + E[v^2] = HP^{-}H^\\top + \\rho\n$$\n项 $S = HP^{-}H^\\top + \\rho$ 是新息协方差。最优增益，即卡尔曼增益，为：\n$$\nK = P^{-}H^\\top (HP^{-}H^\\top + \\rho)^{-1}\n$$\n\n2) 对问题的具体化及后验方差的计算。\n\n给定 $P^{-} = \\begin{pmatrix} 1  1-\\varepsilon\\\\ 1-\\varepsilon  1 \\end{pmatrix}$、$H = \\begin{pmatrix} 1  -1 \\end{pmatrix}$ 和 $\\rho$。\n首先，我们计算增益 $K$ 所需的分量：\n$$\nHP^{-} = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} 1  1-\\varepsilon\\\\ 1-\\varepsilon  1 \\end{pmatrix} = \\begin{pmatrix} 1-(1-\\varepsilon)  (1-\\varepsilon)-1 \\end{pmatrix} = \\begin{pmatrix} \\varepsilon  -\\varepsilon \\end{pmatrix}\n$$\n$$\nHP^{-}H^\\top = \\begin{pmatrix} \\varepsilon  -\\varepsilon \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\varepsilon - (-\\varepsilon) = 2\\varepsilon\n$$\n新息协方差为 $S = 2\\varepsilon + \\rho$。\n$$\nP^{-}H^\\top = (HP^{-})^\\top = \\begin{pmatrix} \\varepsilon \\\\ -\\varepsilon \\end{pmatrix}\n$$\n最优增益为：\n$$\nK = \\frac{1}{2\\varepsilon+\\rho} \\begin{pmatrix} \\varepsilon \\\\ -\\varepsilon \\end{pmatrix}\n$$\n标准正交向量为 $u = \\frac{1}{\\sqrt{2}}(1,1)^{\\top}$ 和 $v=\\frac{1}{\\sqrt{2}}(1,-1)^{\\top}$。让我们验证它们是 $P^{-}$ 的特征向量：\n$$\nP^{-}u = \\begin{pmatrix} 1  1-\\varepsilon\\\\ 1-\\varepsilon  1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1+1-\\varepsilon \\\\ 1-\\varepsilon+1 \\end{pmatrix} = (2-\\varepsilon)\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = (2-\\varepsilon)u\n$$\n$$\nP^{-}v = \\begin{pmatrix} 1  1-\\varepsilon\\\\ 1-\\varepsilon  1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1-(1-\\varepsilon) \\\\ 1-\\varepsilon-1 \\end{pmatrix} = \\varepsilon\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\varepsilon v\n$$\n特征值为 $\\lambda_{u} = 2-\\varepsilon$ 和 $\\lambda_{v} = \\varepsilon$。这些是沿 $u$ 和 $v$ 方向的先验方差。\n沿 $v$ 方向的后验方差是 $\\lambda_{v}^{+} = v^\\top P^{+} v$。我们使用标准更新公式 $P^{+} = P^{-} - KHP^{-}$，这在代数上与 Joseph 形式等价。\n$$\n\\lambda_{v}^{+} = v^\\top (P^{-} - KHP^{-}) v = v^\\top P^{-} v - v^\\top K H P^{-} v\n$$\n由于 $v$ 是 $P^{-}$ 的一个特征向量，对应的特征值为 $\\varepsilon$，我们有 $P^{-}v = \\varepsilon v$。因此，$v^\\top P^{-} v = v^\\top(\\varepsilon v) = \\varepsilon (v^\\top v) = \\varepsilon$。\n第二项是 $v^\\top K (H P^{-} v) = v^\\top K H (\\varepsilon v) = \\varepsilon (v^\\top K) (Hv)$。\n让我们计算各个分量：\n$$\nHv = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}(1+1) = \\sqrt{2}\n$$\n$$\nv^\\top K = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  -1 \\end{pmatrix} \\left( \\frac{1}{2\\varepsilon+\\rho} \\begin{pmatrix} \\varepsilon \\\\ -\\varepsilon \\end{pmatrix} \\right) = \\frac{\\varepsilon}{2\\varepsilon+\\rho} \\frac{1}{\\sqrt{2}} (1 - (-1)) = \\frac{\\varepsilon\\sqrt{2}}{2\\varepsilon+\\rho}\n$$\n将这些代入 $\\lambda_v^+$ 的表达式中：\n$$\n\\lambda_{v}^{+} = \\varepsilon - \\left(\\frac{\\varepsilon\\sqrt{2}}{2\\varepsilon+\\rho}\\right) (\\sqrt{2}\\varepsilon) = \\varepsilon - \\frac{2\\varepsilon^2}{2\\varepsilon+\\rho} = \\frac{\\varepsilon(2\\varepsilon+\\rho) - 2\\varepsilon^2}{2\\varepsilon+\\rho} = \\frac{2\\varepsilon^2 + \\varepsilon\\rho - 2\\varepsilon^2}{2\\varepsilon+\\rho} = \\frac{\\varepsilon\\rho}{2\\varepsilon+\\rho}\n$$\n\n3) 朴素更新与正半定性的丢失。\n\n朴素更新公式 $P_{\\mathrm{naive}}^{+} = (I - K H) P^{-}$ 在代数上是正确的，但在数值上可能不稳定。问题陈述，此计算中的舍入误差导致沿 $v$ 方向的后验方差减小了 $\\delta > 0$。得到的矩阵，我们称之为 $P_{\\text{pert}}$，在 $v$ 方向上的方差将为 $\\lambda_{v}^{+} - \\delta$。要使 $P_{\\text{pert}}$ 为正半定矩阵，其所有特征值必须为非负。\n\n$P^{+}$ 的特征向量也是 $u$ 和 $v$。对应于 $u$ 的特征值为 $\\lambda_u^{+} = u^\\top P^{+} u = u^\\top (P^{-} - KHP^{-}) u$。由于 $Hu=0$，第二项消失，剩下 $\\lambda_u^{+} = u^\\top P^{-} u = \\lambda_u = 2-\\varepsilon$。对于 $\\varepsilon \\ll 1$，该特征值为正。$P^{+}$ 的特征值为 $2-\\varepsilon$ 和 $\\frac{\\varepsilon\\rho}{2\\varepsilon+\\rho}$。\n\n受扰矩阵沿 $v$ 方向的特征值实际上减小了。当其最小特征值变为非正时，该矩阵失去正半定性。由于 $2-\\varepsilon > 0$，临界条件取决于另一个特征值：\n$$\n\\lambda_{v}^{+} - \\delta \\le 0\n$$\n因此，使矩阵失去正半定性（即，使特征值恰好为零）的最小扰动 $\\delta_c$ 为：\n$$\n\\delta_{c} = \\lambda_{v}^{+} = \\frac{\\varepsilon\\rho}{2\\varepsilon+\\rho}\n$$\n\n4) 论证与坐标系的作用。\n\n如第 1 部分所推导，协方差更新的 Joseph 形式为 $P^{+} = (I-KH)P^{-}(I-KH)^\\top + K\\rho K^\\top$。该表达式是两个本身保证为正半定的矩阵之和。正半定矩阵的和总是正半定的。遵循此结构的数值实现将保持正半定属性，因为小的舍入误差不太可能使其中任何一个求和项变为具有大的负特征值的非正半定矩阵。这种形式在数值上是稳健的。\n\n相比之下，$P_{\\mathrm{naive}}^{+} = (I - K H) P^{-}$ 的形式涉及矩阵乘法，可能发生灾难性抵消。项 $I-KH$ 可以以一定的精度计算，但当它乘以近奇异的 $P^{-}$（其行列式为 $\\varepsilon(2-\\varepsilon)$）时，舍入误差可能被放大。具体来说，当 $\\rho \\ll \\varepsilon$ 时，我们有 $K \\approx \\frac{1}{2}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，且 $KH \\approx \\frac{1}{2}\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。那么 $I-KH \\approx \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$。将其乘以 $P^{-} = \\begin{pmatrix} 1  1-\\varepsilon \\\\ 1-\\varepsilon  1 \\end{pmatrix}$ 大约得到 $\\begin{pmatrix} 1-\\varepsilon/2  1-\\varepsilon/2 \\\\ 1-\\varepsilon/2  1-\\varepsilon/2 \\end{pmatrix}$，这是一个特征值为 0 的奇异矩阵。真正的特征值 $\\lambda_{v}^{+}$ 是一个非常小的正数，$\\frac{\\varepsilon\\rho}{2\\varepsilon+\\rho} \\approx \\rho/2$。这种朴素的计算涉及两个大而相近的数相减，由于有限精度，很容易导致最终结果为 0 甚至为负，从而破坏了正半定性。\n\n坐标系的选择加剧了这种病态性。原始状态分量 $x_1$ 和 $x_2$ 高度相关（相关系数为 $1-\\varepsilon \\approx 1$）。测量 $y = x_1 - x_2 + v$ 提取了这两个大而相近的状态之间的微小差异。这是数值敏感性的典型设置。通过变换到由 $P^{-}$ 的特征向量 $u$ 和 $v$ 定义的坐标系，状态变得解耦。在这些坐标中，测量 $y = \\sqrt{2}x_v + v$ 仅提供关于 $x_v$ 分量的信息，更新过程变得干净，只影响 $x_v$ 的方差，而没有任何大的抵消。\n\n最后，我们计算当 $\\varepsilon = 10^{-8}$ 和 $\\rho = 10^{-12}$ 时 $\\delta_c$ 的值：\n$$\n\\delta_{c} = \\frac{(10^{-8})(10^{-12})}{2(10^{-8}) + 10^{-12}} = \\frac{10^{-20}}{2 \\times 10^{-8} + 0.0001 \\times 10^{-8}} = \\frac{10^{-20}}{(2.0001) \\times 10^{-8}}\n$$\n$$\n\\delta_{c} = \\frac{1}{2.0001} \\times 10^{-12} \\approx 0.499975001 \\times 10^{-12} = 4.99975001 \\times 10^{-13}\n$$\n四舍五入到四位有效数字，我们得到 $5.000 \\times 10^{-13}$。", "answer": "$$\\boxed{5.000 \\times 10^{-13}}$$", "id": "2733957"}]}