{"hands_on_practices": [{"introduction": "本练习将引导你探讨网络化控制系统（NCS）中一个最基本的问题：对于一个开环不稳定的系统，需要多大的控制成功概率才能实现均方意义下的稳定。通过推导一个简单的标量系统的稳定性条件[@problem_id:2727000]，你将亲身体会到在丢包期间系统状态的发散趋势与控制成功时系统的收敛趋势之间的根本性制衡。这个练习是理解随机丢包对闭环系统性能影响的绝佳起点。", "problem": "考虑一个网络化控制系统（NCS）中的标量离散时间对象，其驱动数据包丢失被建模为一个乘性伯努利过程。该对象演化为 $x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,u_k$，其中 $x_k \\in \\mathbb{R}$ 是状态，$u_k \\in \\mathbb{R}$ 是控制输入，$a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}\\setminus\\{0\\}$ 是固定参数，而 $\\{\\gamma_k\\}_{k \\ge 0}$ 是一个独立同分布（i.i.d.）序列，其中 $\\gamma_k \\in \\{0,1\\}$ 表示在时间 $k$ 发送的控制数据包是否成功应用于执行器。成功概率为 $\\mathbb{P}\\{\\gamma_k = 1\\} = p$，丢包概率为 $\\mathbb{P}\\{\\gamma_k = 0\\} = 1-p$，其中 $0 \\le p \\le 1$。控制器具有完美、瞬时的状态信息，并应用静态状态反馈 $u_k = K x_k$，其中 $K \\in \\mathbb{R}$ 是一个常数增益。目标是均方镇定，即 $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$。\n\n给定具体的对象参数为 $a = 2$ 和 $b = 1$。在确定性意义下（无丢包），由于 $b \\ne 0$，状态对 $(a,b)$ 是可控的。然而，在有损的驱动信道上，尽管具有确定性可控性，对于某些 $p$ 值，均方能镇定性可能无法实现。\n\n任务：\n- 从均方稳定性的定义和全期望定律出发，推导在反馈 $u_k = K x_k$ 和上述 i.i.d. 伯努利数据包模型下，$\\mathbb{E}[x_{k+1}^2]$ 的单步二阶矩递推式。说明得到的关于 $\\mathbb{E}[x_k^2]$ 的乘性因子如何依赖于 $a$、$b$、$K$ 和 $p$，并确定使该因子最小化的 $K$ 的选择。\n- 从此推导中，获得关于 $p$ 的条件（用 $a$ 和 $b$ 表示），该条件是存在一个实现均方稳定性的静态增益 $K$ 的充要条件。\n- 将您的表达式应用于给定的对象（$a = 2$，$b = 1$），并计算临界成功概率 $p^{\\star}$（即可以实现均方镇定的 $p$ 的下确界）。然后使用 $p = 0.70$ 简要论证为何这提供了一个确定性可控性成立但均方能镇定性不成立的反例，并从丢包期间的开环增长与成功传输期间的控制作用之间的竞争效应角度解释其根本原因。\n\n给出 $a = 2$ 和 $b = 1$ 时临界成功概率 $p^{\\star}$ 的精确值作为最终答案。无需四舍五入。最终答案中不要包含单位。", "solution": "首先验证问题陈述。\n\n**第1步：提取已知条件**\n- 对象动态：$x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,u_k$\n- 状态：$x_k \\in \\mathbb{R}$\n- 控制输入：$u_k \\in \\mathbb{R}$\n- 对象参数：$a \\in \\mathbb{R}$，$b \\in \\mathbb{R}\\setminus\\{0\\}$\n- 数据包丢失模型：$\\{\\gamma_k\\}_{k \\ge 0}$ 是一个独立同分布（i.i.d.）伯努利序列，其中 $\\gamma_k \\in \\{0,1\\}$。\n- 概率：$\\mathbb{P}\\{\\gamma_k = 1\\} = p$ 且 $\\mathbb{P}\\{\\gamma_k = 0\\} = 1-p$，其中 $0 \\le p \\le 1$。\n- 控制器：静态状态反馈 $u_k = K x_k$，其中 $K \\in \\mathbb{R}$ 是一个常数增益。\n- 目标：均方镇定，即 $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$。\n- 特定参数：$a = 2$ 和 $b = 1$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是网络化控制系统（NCS）理论和随机控制中的一个标准基础问题。用于数据包丢失的伯努利模型是一种广泛使用且被接受的简化模型。\n- **适定性：** 问题定义明确，目标清晰，并提供了足够的信息来推导出临界概率的唯一解。\n- **客观性：** 问题使用精确的数学语言陈述，没有主观或含糊的术语。\n- **结论：** 该问题是有效的，因为它科学合理、适定、客观，并且不包含内部矛盾或缺失信息。\n\n**第3步：判断与行动**\n问题有效。将提供完整的解决方案。\n\n**二阶矩递推的推导**\n我们从闭环系统动态开始，将控制律 $u_k = K x_k$ 代入对象方程：\n$$x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,(K x_k) = (a + b K \\gamma_k) x_k$$\n目标是均方稳定性，这关系到状态二阶矩 $\\mathbb{E}[x_k^2]$ 的演化。我们推导这个量的单步递推关系。\n$$x_{k+1}^2 = ((a + b K \\gamma_k) x_k)^2 = (a + b K \\gamma_k)^2 x_k^2$$\n为了计算期望 $\\mathbb{E}[x_{k+1}^2]$，我们使用全期望定律，对时间 $k$ 可用的信息（我们用滤子 $\\mathcal{F}_k$ 表示）取条件。状态 $x_k$ 是 $\\mathcal{F}_k$-可测的，而由于 i.i.d. 假设，随机变量 $\\gamma_k$ 独立于 $\\mathcal{F}_k$。\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[\\mathbb{E}[x_{k+1}^2 | \\mathcal{F}_k]] = \\mathbb{E}[\\mathbb{E}[(a + b K \\gamma_k)^2 x_k^2 | \\mathcal{F}_k]]$$\n由于给定 $\\mathcal{F}_k$ 时 $x_k$ 是已知的，因此在内层期望中可以将其视为常数：\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[x_k^2 \\mathbb{E}[(a + b K \\gamma_k)^2 | \\mathcal{F}_k]]$$\n因为 $\\gamma_k$ 独立于 $\\mathcal{F}_k$，所以条件期望不影响其期望值：\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[x_k^2 \\mathbb{E}[(a + b K \\gamma_k)^2]] = \\mathbb{E}[(a + b K \\gamma_k)^2] \\mathbb{E}[x_k^2]$$\n项 $\\mathbb{E}[(a + b K \\gamma_k)^2]$ 是二阶矩的乘性因子。我们可以使用伯努利随机变量 $\\gamma_k$ 的定义来展开这个期望：\n\\begin{align*} \\mathbb{E}[(a + b K \\gamma_k)^2] = (a + b K \\cdot 1)^2 \\mathbb{P}\\{\\gamma_k = 1\\} + (a + b K \\cdot 0)^2 \\mathbb{P}\\{\\gamma_k = 0\\} \\\\ = (a + b K)^2 p + a^2 (1-p) \\end{align*}\n因此，单步二阶矩递推式为：\n$$\\mathbb{E}[x_{k+1}^2] = \\left[ p(a + bK)^2 + (1-p)a^2 \\right] \\mathbb{E}[x_k^2]$$\n为了使系统均方稳定，我们需要 $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$，这当且仅当乘性因子严格小于 $1$ 时成立：\n$$p(a + bK)^2 + (1-p)a^2  1$$\n\n**最优增益和能镇定性条件**\n为了找到一个镇定增益 $K$ *存在*的条件，我们必须找到使该因子最小化的增益 $K$，并检查该最小值是否能小于 $1$。令 $f(K) = p(a + bK)^2 + (1-p)a^2$。这是一个关于 $K$ 的二次函数。我们通过对 $K$ 求导并令其为零来找到最小值。\n$$\\frac{df}{dK} = \\frac{d}{dK} \\left[ p(a^2 + 2abK + b^2K^2) + (1-p)a^2 \\right] = p(2ab + 2b^2K)$$\n假设 $p > 0$ 且 $b \\ne 0$（如题所设），我们将导数设为 $0$：\n$$2ab + 2b^2K = 0 \\implies K = -\\frac{2ab}{2b^2} = -\\frac{a}{b}$$\n这个最优增益，我们称之为 $K^{\\star} = -a/b$，使该因子最小化。二阶导数 $\\frac{d^2f}{dK^2} = 2pb^2 > 0$，确认了这是一个最小值。\n将 $K^{\\star}$ 代回因子中，得到可能的最小值：\n$$\\min_K f(K) = p\\left(a + b\\left(-\\frac{a}{b}\\right)\\right)^2 + (1-p)a^2 = p(a-a)^2 + (1-p)a^2 = a^2(1-p)$$\n系统是均方能镇定的，当且仅当这个最小因子小于 $1$。注意，如果开环对象本身已经是均方稳定的（即 $|a|1$），那么对于任何 $p \\in [0,1]$ 它都是稳定的（当 $K=0$ 时，因子为 $a^2  1$）。有趣的情况是当 $|a| \\ge 1$ 时。能镇定性的充要条件是：\n$$a^2(1-p)  1$$\n求解成功概率 $p$：\n$$1-p  \\frac{1}{a^2} \\implies p > 1 - \\frac{1}{a^2}$$\n\n**特例化与反例**\n给定具体的对象参数 $a=2$ 和 $b=1$。由于 $|a| = 2 > 1$，开环系统是不稳定的。均方能镇定性的条件是：\n$$p > 1 - \\frac{1}{2^2} = 1 - \\frac{1}{4} = \\frac{3}{4}$$\n临界成功概率 $p^{\\star}$ 是所有能实现镇定的概率 $p$ 集合的下确界。因此：\n$$p^{\\star} = \\frac{3}{4} = 0.75$$\n现在我们考虑 $p=0.70$ 的情况。\n由于 $0.70  0.75$，我们推导出的条件 $p > p^{\\star}$ 不满足。这意味着对于 $p=0.70$ 的成功概率，系统不能通过任何静态状态反馈增益 $K$ 实现均方镇定。\n这为“确定性可控性意味着在随机丢包下仍能镇定”这一观点提供了一个反例。状态对 $(a,b)=(2,1)$ 是可控的，因为可控性矩阵 $[b]$ 的秩为 $1$。如果没有数据包丢失（$p=1$），我们可以选择 $K=-2$ 使闭环极点 $a+bK = 2-2=0$，从而实现零拍镇定。\n然而，当 $p=0.70$ 时，二阶矩放大因子的最小可能值为 $a^2(1-p) = 2^2(1-0.70) = 4(0.30) = 1.2$。由于这个最小因子大于 $1$，对于任何 $K$ 的选择，$\\mathbb{E}[x_k^2]$ 都会发散。\n其根本原因在于两种效应之间的竞争。在发生概率为 $1-p$ 的数据包丢失期间，系统根据其不稳定的开环动态 $x_{k+1} = ax_k$ 演化。状态的平方幅值被放大 $a^2$ 倍。在发生概率为 $p$ 的成功传输期间，控制器可以通过 $x_{k+1} = (a+bK)x_k$ 来减小状态的幅值。最有效的控制作用（使用 $K^{\\star}=-a/b$）能完全消除状态。均方稳定性取决于这两种结果的加权平均。条件 $a^2(1-p)1$ 表明，即使有一个以概率 $p$ 工作的完美控制器，丢包期间的期望增长 $a^2(1-p)$ 本身也必须小于1。如果数据包丢失过于频繁（即 $p$ 太小），则在无控制步骤中的爆炸性增长将压倒在有控制步骤中采取的任何镇定作用。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2727000"}, {"introduction": "在掌握了均方稳定性的基本概念后，下一个练习将带你深入探索随机系统稳定性的微妙之处。稳定性并非一个单一的概念；本练习[@problem_id:2726974]通过对比样本路径稳定性（几乎必然收敛）和二阶矩有界性，揭示了系统“典型”轨迹的行为与其统计矩（如方差）的行为之间可能存在的差异。这项实践有助于理解为何一个系统的状态轨迹几乎总是趋于零，但其能量（二阶矩）却可能因为罕见但影响巨大的丢包事件而发散。", "problem": "考虑一个离散时间的标量网络化控制系统 (NCS)，其执行器通道存在独立同分布 (i.i.d.) 的丢包。受控对象在每个整数时间步 $k \\in \\mathbb{Z}_{\\ge 0}$ 被采样和控制。当控制包成功到达时，闭环更新是稳定的收缩；当丢包时，受控对象在开环下演化并扩张。这导致了如下的乘性随机递推关系\n$$\nx_{k+1} = g_k \\, x_k,\n$$\n其中 $\\{g_k\\}_{k \\ge 0}$ 是独立同分布的随机变量，对于一个固定的丢包概率 $p \\in [0,1]$，它们以 $1-p$ 的概率取值 $g_c \\in (0,1)$（控制更新成功），以 $p$ 的概率取值 $g_o \\in (1,\\infty)$（丢包）。系统中没有外部噪声。\n\n我们关注两种稳定性概念：\n- 样本路径稳定性，理解为几乎必然指数收敛到零，即 $\\lim_{k \\to \\infty} |x_k|^{1/k} = \\rho$ 几乎必然存在且 $\\rho  1$（等价地，最大李雅普诺夫指数为负）。\n- 二阶矩有界性，理解为二阶矩随时间有界，即在给定 $x_0$ 为确定且有限的情况下，$\\sup_{k \\ge 0} \\mathbb{E}[x_k^2]  \\infty$。\n\n从针对独立同分布随机变量乘积的概率论基本原理出发，完成以下任务：\n1. 推导样本路径稳定性（几乎必然指数稳定性）成立的关于 $p$、$g_c$ 和 $g_o$ 的充分必要条件。\n2. 推导二阶矩有界性成立的关于 $p$、$g_c$ 和 $g_o$ 的充分必要条件。\n3. 将问题具体化到 $g_c = \\tfrac{1}{2}$ 和 $g_o = 3$ 的情况。计算两个临界丢包概率 $p_{\\mathrm{as}}$ 和 $p_{\\mathrm{ms}}$，它们分别界定了样本路径稳定性和二阶矩有界性成立的最大 $p$ 值。\n4. 解释为何存在一个非空的丢包概率区间 $p$，在此区间上样本路径稳定性成立而二阶矩有界性不成立，并给出该区间中的一个具体 $p$ 值。\n\n您最终报告的量必须是差值\n$$\n\\Delta \\equiv p_{\\mathrm{as}} - p_{\\mathrm{ms}}\n$$\n在 $g_c = \\tfrac{1}{2}$ 和 $g_o = 3$ 情况下的精确符号表达式。不要进行近似计算；请使用自然对数提供精确的解析表达式。最终答案无需单位。", "solution": "所述问题是有效的。这是一个在随机控制理论领域中适定的、有科学依据的问题，它探讨了对于具有乘性噪声的系统，样本路径稳定性与矩稳定性之间的根本区别。我们将进行形式化的推导。\n\n系统动态由随机递推关系 $x_{k+1} = g_k x_k$ 给出，其中初始状态 $x_0$ 是一个有限的确定值。通过递推代入，时刻 $k$ 的状态由下式给出\n$$\nx_k = \\left( \\prod_{i=0}^{k-1} g_i \\right) x_0.\n$$\n随机变量 $\\{g_k\\}_{k \\ge 0}$ 是独立同分布的 (i.i.d.)，以概率 $1-p$ 取值 $g_c \\in (0,1)$，以概率 $p$ 取值 $g_o \\in (1,\\infty)$。由于 $g_c > 0$ 和 $g_o > 0$，对所有 $k$ 都有 $|g_k| = g_k$。\n\n1. 样本路径稳定性条件的推导：\n样本路径稳定性定义为 $\\lim_{k \\to \\infty} |x_k|^{1/k}  1$ 几乎必然成立。我们来考察这个极限：\n$$\n|x_k|^{1/k} = \\left| \\left( \\prod_{i=0}^{k-1} g_i \\right) x_0 \\right|^{1/k} = |x_0|^{1/k} \\left( \\prod_{i=0}^{k-1} g_i \\right)^{1/k}.\n$$\n当 $k \\to \\infty$ 时，由于 $x_0$ 是一个有限的非零常数，所以 $|x_0|^{1/k} \\to 1$。因此，稳定性由增益的几何平均值的渐进行为决定。为分析此问题，我们考虑其对数：\n$$\n\\ln\\left( \\left( \\prod_{i=0}^{k-1} g_i \\right)^{1/k} \\right) = \\frac{1}{k} \\sum_{i=0}^{k-1} \\ln(g_i).\n$$\n$\\ln(g_i)$ 这些项是独立同分布的随机变量。根据大数强定律，当 $k \\to \\infty$ 时，样本均值几乎必然收敛于真实均值：\n$$\n\\lim_{k \\to \\infty} \\frac{1}{k} \\sum_{i=0}^{k-1} \\ln(g_i) = \\mathbb{E}[\\ln(g)] \\quad \\text{a.s.}\n$$\n这个极限是系统的最大李雅普诺夫指数。要使系统几乎必然指数稳定，我们需要 $\\lim_{k \\to \\infty} |x_k|^{1/k}  1$，这等价于其对数为负。因此，充分必要条件是 $\\mathbb{E}[\\ln(g)]  0$。\n\n期望是根据 $g$ 的分布计算的：\n$$\n\\mathbb{E}[\\ln(g)] = (1-p) \\ln(g_c) + p \\ln(g_o).\n$$\n因此，样本路径稳定性的条件是 $(1-p) \\ln(g_c) + p \\ln(g_o)  0$。\n\n2. 二阶矩有界性条件的推导：\n二阶矩有界性要求 $\\sup_{k \\ge 0} \\mathbb{E}[x_k^2]  \\infty$。我们来推导二阶矩 $\\mathbb{E}[x_k^2]$ 的动态。\n$$\nx_{k+1}^2 = (g_k x_k)^2 = g_k^2 x_k^2.\n$$\n对两边取期望，我们得到：\n$$\n\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[g_k^2 x_k^2].\n$$\n因为 $g_k$ 与 $x_k$（它是 $g_0, g_1, \\dots, g_{k-1}$ 的函数）独立，我们可以分离期望：\n$$\n\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[g_k^2] \\mathbb{E}[x_k^2].\n$$\n这是一个关于二阶矩序列 $m_k \\equiv \\mathbb{E}[x_k^2]$ 的确定性线性递推关系。其解为\n$$\nm_k = (\\mathbb{E}[g^2])^k m_0 = (\\mathbb{E}[g^2])^k x_0^2,\n$$\n其中 $\\mathbb{E}[g^2]$ 是一般增益 $g$ 的二阶矩。要使序列 $\\{m_k\\}_{k \\ge 0}$ 对任何有限初始条件 $x_0 \\neq 0$ 保持有界，其充分必要条件是乘子小于或等于 1，即 $\\mathbb{E}[g^2] \\le 1$。\n\n期望是根据 $g$ 的分布计算的：\n$$\n\\mathbb{E}[g^2] = (1-p) g_c^2 + p g_o^2.\n$$\n因此，二阶矩有界性的条件是 $(1-p) g_c^2 + p g_o^2 \\le 1$。\n\n3. 对于 $g_c = \\frac{1}{2}$ 和 $g_o = 3$ 情况下的临界概率计算：\n样本路径稳定性的临界概率 $p_{\\mathrm{as}}$ 是使稳定性成立的 $p$ 值的上确界。这对应于李雅普诺夫指数为零的边界情况：\n$$\n(1-p_{\\mathrm{as}}) \\ln\\left(\\frac{1}{2}\\right) + p_{\\mathrm{as}} \\ln(3) = 0\n$$\n$$\n-(1-p_{\\mathrm{as}}) \\ln(2) + p_{\\mathrm{as}} \\ln(3) = 0\n$$\n$$\np_{\\mathrm{as}} (\\ln(3) + \\ln(2)) = \\ln(2)\n$$\n$$\np_{\\mathrm{as}} \\ln(6) = \\ln(2) \\implies p_{\\mathrm{as}} = \\frac{\\ln(2)}{\\ln(6)}.\n$$\n二阶矩有界性的临界概率 $p_{\\mathrm{ms}}$ 对应于二阶矩增长因子为 1 的边界情况：\n$$\n(1-p_{\\mathrm{ms}}) \\left(\\frac{1}{2}\\right)^2 + p_{\\mathrm{ms}} (3)^2 = 1\n$$\n$$\n(1-p_{\\mathrm{ms}}) \\frac{1}{4} + 9p_{\\mathrm{ms}} = 1\n$$\n$$\n\\frac{1}{4} - \\frac{1}{4}p_{\\mathrm{ms}} + 9p_{\\mathrm{ms}} = 1\n$$\n$$\n\\left(9 - \\frac{1}{4}\\right) p_{\\mathrm{ms}} = 1 - \\frac{1}{4}\n$$\n$$\n\\frac{35}{4} p_{\\mathrm{ms}} = \\frac{3}{4} \\implies p_{\\mathrm{ms}} = \\frac{3}{35}.\n$$\n\n4. 稳定性间隔的解释：\n存在一个非空区间 $(p_{\\mathrm{ms}}, p_{\\mathrm{as}})$，在此区间上样本路径稳定性成立而二阶矩有界性不成立，这是琴生不等式 (Jensen's inequality) 的一个推论。样本路径稳定性的条件与增益的几何平均值有关，而二阶矩稳定性的条件与增益平方的算术平均值有关。\n令 $Z = \\ln(g^2) = 2 \\ln(g)$。函数 $\\phi(z) = \\exp(z)$ 是严格凸函数。根据琴生不等式：\n$$\n\\mathbb{E}[g^2] = \\mathbb{E}[\\exp(Z)] > \\exp(\\mathbb{E}[Z]) = \\exp(\\mathbb{E}[2 \\ln(g)]) = (\\exp(\\mathbb{E}[\\ln(g)]))^2.\n$$\n不等式是严格的，因为随机变量 $g$ 不是确定性的。\n如果一个系统具有二阶矩稳定性，则 $1 \\ge \\mathbb{E}[g^2]$。从该不等式可知，这意味着 $1 > (\\exp(\\mathbb{E}[\\ln(g)]))^2$，即 $1 > \\exp(\\mathbb{E}[\\ln(g)])$，取对数得到 $0 > \\mathbb{E}[\\ln(g)]$。因此，二阶矩稳定性意味着样本路径稳定性。\n然而，反之则不成立。严格不等式允许存在一种情况，其中 $\\mathbb{E}[\\ln(g)]  0$（因此 $\\exp(\\mathbb{E}[\\ln(g)])  1$），而 $\\mathbb{E}[g^2] > 1$。这发生在 $p \\in (p_{\\mathrm{ms}}, p_{\\mathrm{as}})$ 时。对于给定的数值，这个区间是 $(\\frac{3}{35}, \\frac{\\ln(2)}{\\ln(6)})$。这个区间是非空的，因为 $p_{\\mathrm{ms}} \\approx 0.0857$ 且 $p_{\\mathrm{as}} \\approx 0.3869$。\n从物理上看，这意味着虽然状态轨迹 $x_k$ 几乎必然收敛到零，但由丢包（乘以 $g_o$）引起的罕见但巨大的增长，在二阶矩中被平方运算赋予了很高的权重，导致 $\\mathbb{E}[x_k^2]$ 发散到无穷大。\n该区间中的一个具体 $p$ 值是，例如，$p = \\frac{1}{5} = 0.2$。该值满足 $\\frac{3}{35}  \\frac{1}{5}  \\frac{\\ln(2)}{\\ln(6)}$。\n\n最后，我们计算所需的差值 $\\Delta \\equiv p_{\\mathrm{as}} - p_{\\mathrm{ms}}$：\n$$\n\\Delta = \\frac{\\ln(2)}{\\ln(6)} - \\frac{3}{35}.\n$$\n这是最终的符号表达式。", "answer": "$$\\boxed{\\frac{\\ln(2)}{\\ln(6)} - \\frac{3}{35}}$$", "id": "2726974"}, {"introduction": "理论分析为我们提供了深刻的洞见，而将这些理论应用于更复杂的现实场景则需要借助计算工具。本练习[@problem_id:2726946]将指导你从理论走向实践，分析一个同时存在控制抖动和数据包丢失的网络化控制系统。你将学习如何为这样一个混合系统建立增广状态模型，基于李雅普诺夫理论推导出其均方稳定性的条件，并最终通过数值计算方法来精确确定系统能够容忍的最大抖动和丢包概率。", "problem": "考虑一个离散时间网络化控制系统 (NCS)，其状态动力学由以下线性时不变对象给出：\n$$\nx_{k+1} = A x_k + B u_k,\n$$\n其中 $x_k \\in \\mathbb{R}^n$, $u_k \\in \\mathbb{R}^m$, $A \\in \\mathbb{R}^{n \\times n}$ 且 $B \\in \\mathbb{R}^{n \\times m}$。一个静态状态反馈控制器通过给定的增益 $K \\in \\mathbb{R}^{m \\times n}$ 计算 $u_k^{\\mathrm{cmd}} = K x_k$。由于通信网络的存在，在时间步 $k$ 施加到对象的控制输入（记作 $u_k^{\\mathrm{app}}$）受到驱动抖动和数据包丢失的影响，具体如下：\n- 以概率 $r \\in [0,1]$（抖动），施加的输入延迟一个步长，即 $u_k^{\\mathrm{app}} = K x_{k-1}$。\n- 以概率 $q \\in [0,1]$（丢包），施加的输入为零，即 $u_k^{\\mathrm{app}} = 0$。\n- 否则，以概率 $1 - r - q$，输入被立即施加，即 $u_k^{\\mathrm{app}} = K x_k$。\n\n假设这些事件随时间独立同分布，并且在每个步长上是互斥的。同时假设 $r \\ge 0$，$q \\ge 0$ 且 $r + q \\le 1$。引入增广状态 $s_k = \\begin{bmatrix} x_k^\\top  x_{k-1}^\\top \\end{bmatrix}^\\top \\in \\mathbb{R}^{2n}$，将闭环动力学写成一个具有三种模态的随机跳变线性系统，对应于上述三种网络结果。\n\n您的任务是，对于每个给定的 $(A,B,K)$，确定在没有丢包（即 $q=0$）时允许的最大抖动概率 $r_{\\max}$，以及在没有抖动（即 $r=0$）时允许的最大丢包概率 $q_{\\max}$，使得闭环 NCS 是二次均方稳定的。具体来说，二次均方稳定性定义为存在一个正定矩阵 $P \\in \\mathbb{R}^{2n \\times 2n}$，对于该矩阵，二次 Lyapunov 函数的期望单步下降条件对所有非零状态都严格成立。您的程序必须在每种情况下，求解满足此二次稳定性条件的正确线性矩阵不等式 (LMI) 的最大 $r \\in [0,1]$（当 $q=0$ 时）和最大 $q \\in [0,1]$（当 $r=0$ 时）。该 LMI 应从第一性原理出发，基于离散时间 Lyapunov 稳定性的基本定义和应用于该跳变系统的全期望定律推导得出。\n\n请使用以下对象和反馈增益的测试套件：\n- 测试用例 1 (正常情况):\n  - $A = \\begin{bmatrix} 1.05  0.1 \\\\ 0  0.98 \\end{bmatrix}$,\n    $B = \\begin{bmatrix} 0.1 \\\\ 0.05 \\end{bmatrix}$,\n    $K = \\begin{bmatrix} -1.2  -0.4 \\end{bmatrix}$。\n- 测试用例 2 (近边界动力学):\n  - $A = \\begin{bmatrix} 1.2  0.15 \\\\ 0  1.05 \\end{bmatrix}$,\n    $B = \\begin{bmatrix} 0.2 \\\\ 0.1 \\end{bmatrix}$,\n    $K = \\begin{bmatrix} -2.0  -0.8 \\end{bmatrix}$。\n- 测试用例 3 (标量边界情况):\n  - $A = \\begin{bmatrix} 1.1 \\end{bmatrix}$,\n    $B = \\begin{bmatrix} 1.0 \\end{bmatrix}$,\n    $K = \\begin{bmatrix} -0.5 \\end{bmatrix}$。\n\n输出规格：\n- 对于每个测试用例，计算当 $q=0$ 时的 $r_{\\max}$ 和当 $r=0$ 时的 $q_{\\max}$。\n- 将每个值报告为四舍五入到六位小数的浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为\n  $[r_{\\max}^{(1)}, q_{\\max}^{(1)}, r_{\\max}^{(2)}, q_{\\max}^{(2)}, r_{\\max}^{(3)}, q_{\\max}^{(3)}]$,\n  其中上标表示测试用例编号。\n\n注意：\n- 您必须以纯数学术语处理此问题。不要假设任何物理单位。\n- 不涉及角度。\n- 最终的数值输出必须是浮点数。", "solution": "该问题要求分析一个离散时间网络化控制系统 (NCS) 在遭受随机控制输入抖动和数据包丢失时的二次均方稳定性。该分析必须分别得出这两种网络引起的损伤各自的最大可容忍概率。\n\n首先，对问题陈述进行验证。给定条件包括一个线性时不变对象模型、一个状态反馈控制律以及一个网络效应的概率模型。任务是使用一个明确定义的准则——二次均方稳定性——来寻找稳定性边界。该问题在科学上植根于跳变线性系统理论，这是对具有随机参数变化的系统进行建模的标准框架。该问题是适定的、客观的，并包含了进行求解所需的所有信息。所有术语在控制理论中都是标准的，并且提供的数值数据是一致的。该问题被认为是有效的。\n\n解题过程从第一性原理出发，如下所示。\n\n对象动力学由以下公式给出：\n$$\nx_{k+1} = A x_k + B u_k^{\\mathrm{app}}\n$$\n其中 $x_k \\in \\mathbb{R}^n$ 是状态， $u_k^{\\mathrm{app}} \\in \\mathbb{R}^m$ 是施加的控制输入，矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和 $B \\in \\mathbb{R}^{n \\times m}$ 定义了对象模型。控制器使用静态增益 $K \\in \\mathbb{R}^{m \\times n}$ 计算指令输入 $u_k^{\\mathrm{cmd}} = K x_k$。\n\n网络在施加的输入 $u_k^{\\mathrm{app}}$ 中引入了不确定性。令 $\\theta_k$ 为一个随机变量，表示在时间步 $k$ 的网络状态。问题描述了 $u_k^{\\mathrm{app}}$ 的三种互斥结果：\n$1$. **模态 1 (正常)**: $u_k^{\\mathrm{app}} = K x_k$。此情况以概率 $p_1 = 1-r-q$ 发生。\n$2$. **模态 2 (抖动)**: $u_k^{\\mathrm{app}} = K x_{k-1}$。此情况以概率 $p_2 = r$ 发生。\n$3$. **模态 3 (丢包)**: $u_k^{\\mathrm{app}} = 0$。此情况以概率 $p_3 = q$ 发生。\n\n由于在时间 $k$ 的输入可能依赖于时间 $k-1$ 的状态，该系统具有记忆性。为了构建一个马尔可夫状态模型，我们按照规定定义一个增广状态向量 $s_k \\in \\mathbb{R}^{2n}$：\n$$\ns_k = \\begin{bmatrix} x_k \\\\ x_{k-1} \\end{bmatrix}\n$$\n该增广状态的动力学可以写成一个跳变线性系统 $s_{k+1} = \\mathcal{A}_{\\theta_k} s_k$，其中 $\\mathcal{A}_{\\theta_k}$ 是对应于网络模态的三个系统矩阵之一。\n\n对于每种模态，我们推导相应的矩阵 $\\mathcal{A}_i$：\n- **模态 1 (正常, $\\theta_k=1$):**\n  $x_{k+1} = A x_k + B(K x_k) = (A+BK)x_k$。增广动力学为：\n  $$\n  s_{k+1} = \\begin{bmatrix} x_{k+1} \\\\ x_k \\end{bmatrix} = \\begin{bmatrix} (A+BK)x_k \\\\ I_n x_k \\end{bmatrix} = \\begin{bmatrix} A+BK  0_{n \\times n} \\\\ I_n  0_{n \\times n} \\end{bmatrix} \\begin{bmatrix} x_k \\\\ x_{k-1} \\end{bmatrix} = \\mathcal{A}_1 s_k\n  $$\n- **模态 2 (抖动, $\\theta_k=2$):**\n  $x_{k+1} = A x_k + B(K x_{k-1})$。增广动力学为：\n  $$\n  s_{k+1} = \\begin{bmatrix} x_{k+1} \\\\ x_k \\end{bmatrix} = \\begin{bmatrix} A x_k + BK x_{k-1} \\\\ I_n x_k \\end{bmatrix} = \\begin{bmatrix} A  BK \\\\ I_n  0_{n \\times n} \\end{bmatrix} \\begin{bmatrix} x_k \\\\ x_{k-1} \\end{bmatrix} = \\mathcal{A}_2 s_k\n  $$\n- **模态 3 (丢包, $\\theta_k=3$):**\n  $x_{k+1} = A x_k + B(0) = A x_k$。增广动力学为：\n  $$\n  s_{k+1} = \\begin{bmatrix} x_{k+1} \\\\ x_k \\end{bmatrix} = \\begin{bmatrix} A x_k \\\\ I_n x_k \\end{bmatrix} = \\begin{bmatrix} A  0_{n \\times n} \\\\ I_n  0_{n \\times n} \\end{bmatrix} \\begin{bmatrix} x_k \\\\ x_{k-1} \\end{bmatrix} = \\mathcal{A}_3 s_k\n  $$\n这里，$I_n$ 是 $n \\times n$ 的单位矩阵，$0_{n \\times n}$ 是 $n \\times n$ 的零矩阵。\n\n系统被定义为二次均方稳定，如果存在一个公共正定矩阵 $P = P^\\top > 0$, $P \\in \\mathbb{R}^{2n \\times 2n}$，使得二次 Lyapunov 函数 $V(s_k) = s_k^\\top P s_k$ 对任何非零状态都满足期望下降条件：\n$$\n\\mathbb{E}[V(s_{k+1}) | s_k] - V(s_k)  0 \\quad \\forall s_k \\neq 0\n$$\n我们使用全期望定律对三种模态展开期望项：\n$$\n\\mathbb{E}[V(s_{k+1}) | s_k] = \\mathbb{E}[s_{k+1}^\\top P s_{k+1} | s_k] = \\mathbb{E}[(\\mathcal{A}_{\\theta_k}s_k)^\\top P (\\mathcal{A}_{\\theta_k}s_k) | s_k]\n$$\n$$\n= s_k^\\top \\left( \\mathbb{E}[\\mathcal{A}_{\\theta_k}^\\top P \\mathcal{A}_{\\theta_k}] \\right) s_k = s_k^\\top \\left( \\sum_{i=1}^3 p_i \\mathcal{A}_i^\\top P \\mathcal{A}_i \\right) s_k\n$$\n稳定性条件变为对所有 $s_k \\neq 0$ 都有 $s_k^\\top \\left( \\sum_{i=1}^3 p_i \\mathcal{A}_i^\\top P \\mathcal{A}_i - P \\right) s_k  0$。这等价于线性矩阵不等式 (LMI)：\n$$\n\\sum_{i=1}^3 p_i \\mathcal{A}_i^\\top P \\mathcal{A}_i - P \\prec 0\n$$\n这个 LMI 必须对于某个 $P \\succ 0$ 是可行的。令 $\\mathcal{L}(P) = \\sum_{i=1}^3 p_i \\mathcal{A}_i^\\top P \\mathcal{A}_i$。条件是 $P - \\mathcal{L}(P) \\succ 0$。算子 $\\mathcal{L}$ 是对称矩阵空间上的一个正线性算子。对于这类算子，存在满足该不等式的 $P \\succ 0$ 等价于该算子的谱半径 $\\rho(\\mathcal{L})$ 严格小于 $1$。\n\n为了计算谱半径，我们可以将算子 $\\mathcal{L}$ 表示为一个作用于 $P$ 的向量化形式的矩阵。使用克罗内克积恒等式 $\\mathrm{vec}(CXD) = (D^\\top \\otimes C) \\mathrm{vec}(X)$，算子 $\\mathcal{L}$ 的向量化表示是一个大矩阵 $\\mathbb{L} \\in \\mathbb{R}^{(2n)^2 \\times (2n)^2}$：\n$$\n\\mathbb{L} = \\sum_{i=1}^3 p_i (\\mathcal{A}_i^\\top \\otimes \\mathcal{A}_i^\\top)\n$$\n因此，稳定性条件为 $\\rho(\\mathbb{L})  1$。\n\n我们的任务是找到最大概率 $r_{\\max}$ (当 $q=0$ 时) 和 $q_{\\max}$ (当 $r=0$ 时)。这可以通过对每个参数在区间 $[0,1]$ 上进行二分搜索来实现。\n\n**情况 1: 抖动分析 ($r_{\\max}$ 当 $q=0$ 时)**\n概率为 $p_1 = 1-r$, $p_2 = r$, $p_3 = 0$。矩阵算子为：\n$$\n\\mathbb{L}_r = (1-r)(\\mathcal{A}_1^\\top \\otimes \\mathcal{A}_1^\\top) + r(\\mathcal{A}_2^\\top \\otimes \\mathcal{A}_2^\\top)\n$$\n我们必须找到 $r_{\\max} = \\sup\\{ r \\in [0,1] \\mid \\rho(\\mathbb{L}_r)  1 \\}$。对 $r$ 在 $[0,1]$ 上执行二分搜索。对于每个候选值 $r$，我们计算 $\\mathbb{L}_r$，找到其特征值，并检查它们的最大模是否小于 $1$。该搜索确定了 $\\rho(\\mathbb{L}_r)=1$ 的边界。\n\n**情况 2: 丢包分析 ($q_{\\max}$ 当 $r=0$ 时)**\n概率为 $p_1 = 1-q$, $p_2 = 0$, $p_3 = q$。矩阵算子为：\n$$\n\\mathbb{L}_q = (1-q)(\\mathcal{A}_1^\\top \\otimes \\mathcal{A}_1^\\top) + q(\\mathcal{A}_3^\\top \\otimes \\mathcal{A}_3^\\top)\n$$\n类似地，我们通过二分搜索找到 $q_{\\max} = \\sup\\{ q \\in [0,1] \\mid \\rho(\\mathbb{L}_q)  1 \\}$。\n\n两种情况的算法如下：\n$1$. 检查标称点 ($r=0$ 或 $q=0$) 的稳定性。这要求 $\\rho(\\mathcal{A}_1^\\top \\otimes \\mathcal{A}_1^\\top)  1$，可简化为 $\\rho(\\mathcal{A}_1)  1$。如果标称系统不稳定，则最大概率为 $0$。$\\mathcal{A}_1$ 的特征值是 $A+BK$ 的特征值与 $n$ 个零特征值的并集，因此此检查简化为 $\\rho(A+BK)  1$。\n$2$. 如果标称系统稳定，则执行二分搜索。设置搜索区间 $[low, high] = [0, 1]$。\n$3$. 在每次迭代中，取中点 `mid = (low + high) / 2`。构建相应的矩阵 $\\mathbb{L}_{mid}$ 并计算其谱半径 $\\rho(\\mathbb{L}_{mid})$。\n$4$. 如果 $\\rho(\\mathbb{L}_{mid})  1$，系统在此概率下是稳定的。我们可能可以容忍更高的值，因此设置 $low = mid$。\n$5$. 如果 $\\rho(\\mathbb{L}_{mid}) \\ge 1$，系统是不稳定的。必须降低概率，因此设置 $high = mid$。\n$6$. 经过足够多的迭代次数 (例如 $100$ 次) 后，$low$ 的值是最大允许概率的高精度近似。\n为每个提供的测试用例实现此过程。", "answer": "[0.370337,0.110595,0.082711,0.013222,0.482094,0.301653]", "id": "2726946"}]}