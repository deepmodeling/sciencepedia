{"hands_on_practices": [{"introduction": "基于能量的分析是端口哈密尔顿（pH）系统理论的核心优势，它允许我们通过确保能量耗散来保证稳定性。这个练习探讨了这一原理的边界：当一个无源的pH系统与一个可能注入能量的非无源设备（如负反馈）互联时，系统的稳定性如何保证？通过这个练习，你将学会量化一个无源系统的鲁棒性，即它能承受多大的外部能量注入而不失稳，这是无源性控制中的一个基本概念。", "problem": "考虑一个线性时不变端口哈密顿 (pH) 系统，其状态为 $x \\in \\mathbb{R}^{2}$，储能函数 (哈密顿量) 为 $H(x) = \\tfrac{1}{2} x^{\\top} Q x$，其中 $Q \\in \\mathbb{R}^{2 \\times 2}$ 是对称正定矩阵，其结构由下式给出：\n$$\\dot{x} = \\big(J - R\\big)\\nabla H(x) + G u,\\qquad y = G^{\\top}\\nabla H(x),$$\n其中 $J = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$ 是斜对称矩阵，$R = \\mathrm{diag}(r_{1}, r_{2})$ 且 $r_{1} > 0, r_{2} > 0$ 是对称正定矩阵，以及 $G = \\begin{bmatrix} g_{1} \\\\ g_{2} \\end{bmatrix}$ 且 $g_{1} > 0, g_{2} > 0$。该系统在其端口 $(u,y)$ 处与一个静态单端口设备互联，该设备由本构关系描述：\n$$u = -\\alpha\\, y,$$\n其中 $\\alpha \\in \\mathbb{R}$ 是一个常数。当 $\\alpha > 0$ 时，该设备是非无源的 (其行为类似于一个负电阻)。\n\n仅使用端口哈密顿系统的储能函数、功率平衡和无源性的基本定义，推导关于 $\\alpha$ 的条件，使得对于所有轨迹，哈密顿量都满足\n$$\\dot{H}(x) \\le 0 \\quad \\text{for all } x \\in \\mathbb{R}^{2}.$$\n以精确的闭式形式，确定最小实数值 $\\alpha_{\\min}$，使得上述不等式对所有 $x$ 均成立。您的最终答案必须是仅包含 $r_{1}$、$r_{2}$、$g_{1}$ 和 $g_{2}$ 的单个解析表达式。", "solution": "控制端口哈密顿系统中能量演化的基本原理是功率平衡方程。我们通过计算哈密顿量 $H(x)$ 的时间导数来推导此方程。根据链式法则，我们有：\n$$ \\dot{H}(x) = \\frac{d}{dt} H(x) = \\left(\\nabla H(x)\\right)^{\\top} \\dot{x} $$\n将系统动力学 $\\dot{x} = \\big(J - R\\big)\\nabla H(x) + G u$ 代入此表达式：\n$$ \\dot{H}(x) = \\left(\\nabla H(x)\\right)^{\\top} \\left[ \\big(J - R\\big)\\nabla H(x) + G u \\right] $$\n展开此表达式可得：\n$$ \\dot{H}(x) = \\left(\\nabla H(x)\\right)^{\\top} J \\nabla H(x) - \\left(\\nabla H(x)\\right)^{\\top} R \\nabla H(x) + \\left(\\nabla H(x)\\right)^{\\top} G u $$\n第一项 $\\left(\\nabla H(x)\\right)^{\\top} J \\nabla H(x)$ 是一个标量。标量等于其转置。由于矩阵 $J$ 是斜对称的 ($J^{\\top} = -J$)，我们发现：\n$$ \\left(\\nabla H(x)\\right)^{\\top} J \\nabla H(x) = \\left(\\left(\\nabla H(x)\\right)^{\\top} J \\nabla H(x)\\right)^{\\top} = \\left(\\nabla H(x)\\right)^{\\top} J^{\\top} \\nabla H(x) = -\\left(\\nabla H(x)\\right)^{\\top} J \\nabla H(x) $$\n这意味着 $2\\left(\\nabla H(x)\\right)^{\\top} J \\nabla H(x) = 0$，所以该项为零。此项代表内部能量守恒的功率流。\n\n第二项 $-\\left(\\nabla H(x)\\right)^{\\top} R \\nabla H(x)$ 代表系统内部耗散的功率。由于 $R$ 是正定的，该项总是不为正。\n\n第三项 $\\left(\\nabla H(x)\\right)^{\\top} G u$ 可以使用输出方程 $y = G^{\\top}\\nabla H(x)$ 重写。输出方程的转置是 $y^{\\top} = \\left(\\nabla H(x)\\right)^{\\top} G$。因此，该项等于 $y^{\\top} u$，即通过其端口供给系统的功率。\n\n功率平衡方程简化为：\n$$ \\dot{H}(x) = -\\left(\\nabla H(x)\\right)^{\\top} R \\nabla H(x) + y^{\\top} u $$\n现在，我们应用互联设备的本构关系 $u = -\\alpha y$：\n$$ \\dot{H}(x) = -\\left(\\nabla H(x)\\right)^{\\top} R \\nabla H(x) + y^{\\top} (-\\alpha y) = -\\left(\\nabla H(x)\\right)^{\\top} R \\nabla H(x) - \\alpha y^{\\top} y $$\n为了对所有 $x$ 分析此条件，我们将 $y$ 用 $\\nabla H(x)$ 表示：\n$$ \\dot{H}(x) = -\\left(\\nabla H(x)\\right)^{\\top} R \\nabla H(x) - \\alpha \\left(G^{\\top}\\nabla H(x)\\right)^{\\top} \\left(G^{\\top}\\nabla H(x)\\right) $$\n$$ \\dot{H}(x) = -\\left(\\nabla H(x)\\right)^{\\top} R \\nabla H(x) - \\alpha \\left(\\nabla H(x)\\right)^{\\top} G G^{\\top} \\nabla H(x) $$\n令向量 $z = \\nabla H(x) = Qx$。由于 $Q$ 是对称正定矩阵，它是可逆的。这意味着对于任意 $z \\in \\mathbb{R}^{2}$，都存在唯一的 $x = Q^{-1}z$。因此，对所有 $x \\in \\mathbb{R}^{2}$ 都有 $\\dot{H}(x) \\le 0$ 的条件等价于以下不等式对所有 $z \\in \\mathbb{R}^{2}$ 均成立的条件：\n$$ -z^{\\top} R z - \\alpha z^{\\top} G G^{\\top} z \\le 0 $$\n这可以重写为：\n$$ -z^{\\top} \\left(R + \\alpha G G^{\\top}\\right) z \\le 0 $$\n这个不等式必须对所有 $z \\in \\mathbb{R}^{2}$ 成立。这等价于要求矩阵 $M(\\alpha) = R + \\alpha G G^{\\top}$ 是半正定的。\n\n让我们构建矩阵 $M(\\alpha)$。给定：\n$R = \\begin{pmatrix} r_{1}  0 \\\\ 0  r_{2} \\end{pmatrix}$ 和 $G G^{\\top} = \\begin{pmatrix} g_{1} \\\\ g_{2} \\end{pmatrix} \\begin{pmatrix} g_{1}  g_{2} \\end{pmatrix} = \\begin{pmatrix} g_{1}^{2}  g_{1}g_{2} \\\\ g_{1}g_{2}  g_{2}^{2} \\end{pmatrix}$。\n所以，矩阵 $M(\\alpha)$ 是：\n$$ M(\\alpha) = \\begin{pmatrix} r_{1} + \\alpha g_{1}^{2}  \\alpha g_{1}g_{2} \\\\ \\alpha g_{1}g_{2}  r_{2} + \\alpha g_{2}^{2} \\end{pmatrix} $$\n对于一个 $2 \\times 2$ 的对称矩阵，要使其为半正定，其所有主子式必须非负。这导致以下条件：\n1.  左上角元素必须非负：$r_{1} + \\alpha g_{1}^{2} \\ge 0$。\n2.  右下角元素必须非负：$r_{2} + \\alpha g_{2}^{2} \\ge 0$。\n3.  行列式必须非负：$\\det(M(\\alpha)) \\ge 0$。\n\n让我们用 $\\alpha$ 来分析这三个不等式：\n根据条件1，由于 $g_{1}^{2} > 0$: $\\alpha g_{1}^{2} \\ge -r_{1} \\implies \\alpha \\ge -\\frac{r_{1}}{g_{1}^{2}}$。\n根据条件2，由于 $g_{2}^{2} > 0$: $\\alpha g_{2}^{2} \\ge -r_{2} \\implies \\alpha \\ge -\\frac{r_{2}}{g_{2}^{2}}$。\n根据条件3，我们展开行列式：\n$$ \\det(M(\\alpha)) = (r_{1} + \\alpha g_{1}^{2})(r_{2} + \\alpha g_{2}^{2}) - (\\alpha g_{1}g_{2})^{2} \\ge 0 $$\n$$ r_{1}r_{2} + \\alpha r_{1}g_{2}^{2} + \\alpha r_{2}g_{1}^{2} + \\alpha^{2} g_{1}^{2}g_{2}^{2} - \\alpha^{2} g_{1}^{2}g_{2}^{2} \\ge 0 $$\n$$ r_{1}r_{2} + \\alpha(r_{1}g_{2}^{2} + r_{2}g_{1}^{2}) \\ge 0 $$\n由于 $r_{1}, r_{2}, g_{1}, g_{2}$ 均为正，项 $(r_{1}g_{2}^{2} + r_{2}g_{1}^{2})$ 严格为正。我们可以解出 $\\alpha$：\n$$ \\alpha \\ge -\\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} $$\n为了使矩阵 $M(\\alpha)$ 为半正定，$\\alpha$ 必须同时满足所有三个不等式。这意味着 $\\alpha$ 必须大于或等于三个下界中的最大值：\n$$ \\alpha \\ge \\max\\left( -\\frac{r_{1}}{g_{1}^{2}}, -\\frac{r_{2}}{g_{2}^{2}}, -\\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\right) $$\n因此，最小值 $\\alpha_{\\min}$ 就是这个最大值。让我们比较这些项。设第三项为 $C = -\\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}}$。\n通过比较它们的正数对应部分来比较 $C$ 和 $-\\frac{r_{1}}{g_{1}^{2}}$：\n$$ \\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\quad \\text{vs.} \\quad \\frac{r_{1}}{g_{1}^{2}} $$\n由于 $r_{1} > 0$，我们可以比较：\n$$ \\frac{r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\quad \\text{vs.} \\quad \\frac{1}{g_{1}^{2}} $$\n通过正分母交叉相乘得到：\n$$ r_{2}g_{1}^{2} \\le r_{1}g_{2}^{2} + r_{2}g_{1}^{2} $$\n$$ 0 \\le r_{1}g_{2}^{2} $$\n这个不等式总是成立的，因为 $r_{1} > 0$ 和 $g_{2}^{2} > 0$。因此，$\\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\le \\frac{r_{1}}{g_{1}^{2}}$，这意味着 $-\\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\ge -\\frac{r_{1}}{g_{1}^{2}}$。所以，$C$ 大于或等于第一个下界。\n\n通过对称性，我们可以将 $C$ 与 $-\\frac{r_{2}}{g_{2}^{2}}$ 进行比较：\n$$ \\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\le \\frac{r_{2}}{g_{2}^{2}} \\implies \\frac{r_{1}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\le \\frac{1}{g_{2}^{2}} \\implies r_{1}g_{2}^{2} \\le r_{1}g_{2}^{2} + r_{2}g_{1}^{2} \\implies 0 \\le r_{2}g_{1}^{2} $$\n这也总是成立的。因此，$-\\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} \\ge -\\frac{r_{2}}{g_{2}^{2}}$。所以，$C$ 也大于或等于第二个下界。\n第三个下界是三者中最大的。$\\dot{H}(x) \\le 0$ 的条件简化为要求 $\\alpha$ 大于或等于这一个下界。最小值 $\\alpha_{\\min}$ 就是这个下界本身。\n$$ \\alpha_{\\min} = -\\frac{r_{1}r_{2}}{r_{1}g_{2}^{2} + r_{2}g_{1}^{2}} $$\n这也可以写成 $\\alpha_{\\min} = - \\left( \\frac{g_2^2}{r_2} + \\frac{g_1^2}{r_1} \\right)^{-1}$，即每个通道“有效电导”之和的倒数的负值。", "answer": "$$ \\boxed{-\\frac{r_{1} r_{2}}{r_{1} g_{2}^{2} + r_{2} g_{1}^{2}}} $$", "id": "2733260"}, {"introduction": "在设计控制器之后，我们常常需要分析系统的内在属性，例如我们是否能仅通过可测量的输出来推断系统的完整能量状态。本练习将经典控制理论中的可观测性概念应用于端口哈密尔顿系统，让你能够识别系统的哪些能量状态是“隐藏”的。理解可观测性与可检测性对于设计状态观测器和实现高级输出反馈控制至关重要，而pH框架为这些抽象概念提供了清晰的物理诠释。", "problem": "考虑标准形式的线性时不变端口哈密顿 (pH) 系统\n$$\\dot{x} = \\left(J - R\\right) Q\\,x + G\\,u,\\quad y = G^{\\top} Q\\,x,$$\n其中 $x \\in \\mathbb{R}^{4}$ 是状态，$u \\in \\mathbb{R}^{2}$ 是输入，$y \\in \\mathbb{R}^{2}$ 是测量输出，$Q \\in \\mathbb{R}^{4 \\times 4}$ 是对称正定矩阵，$J \\in \\mathbb{R}^{4 \\times 4}$ 是斜对称矩阵，$R \\in \\mathbb{R}^{4 \\times 4}$ 是对称半正定矩阵。设哈密顿量为 $H(x) = \\frac{1}{2} x^{\\top} Q x$。取\n$$Q = I_{4},\\quad J = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  0  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  0\n\\end{bmatrix},\\quad R = \\operatorname{diag}\\!\\left(0,\\,2,\\,0,\\,r_{4}\\right),\\quad r_{4} > 0,$$\n且\n$$G = \\begin{bmatrix}\n1  0\\\\\n0  1\\\\\n0  0\\\\\n0  0\n\\end{bmatrix},\\quad \\text{使得}\\; y = \\begin{bmatrix} x_{1}\\\\ x_{2} \\end{bmatrix}.$$\n定义 $A := (J-R)Q$ 和 $C := G^{\\top} Q$，使得无强迫输出为 $y = C x$。仅使用基本定义和性质来推断能观性和能检性：通过经典能观性矩阵判断 $(A,C)$ 对的能观性，当 $u \\equiv 0$ 时的哈密顿能量平衡 $\\dot{H}(x) = -(\\nabla H(x))^{\\top} R\\, (\\nabla H(x))$，以及能检性（其要求是所有不可观测模式都是渐近稳定的）。\n\n任务：确定 $(A,C)$ 对的最大不可观测子空间的维数 $d$，以及局限于此不可观测子空间内的轨迹的渐近衰减率 $\\alpha$（定义为使这些轨迹按比例 $\\exp(-\\alpha t)$ 衰减的正数）。将最终答案表示为一个行矩阵 $\\begin{pmatrix} d  \\alpha \\end{pmatrix}$ 中的两个元素。无需四舍五入。", "solution": "首先，我们根据所提供的数据构建状态空间矩阵 $A$ 和 $C$。\n矩阵 $Q$ 是单位矩阵 $I_4$，所以哈密顿量为 $H(x) = \\frac{1}{2} x^{\\top} I_{4} x = \\frac{1}{2} x^{\\top} x$。\n系统矩阵 $A$ 由 $A = (J-R)Q = (J-R)I_{4} = J-R$ 给出。\n代入给定的矩阵 $J$ 和 $R$：\n$$A = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  0  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  0\n\\end{bmatrix} - \\begin{bmatrix}\n0  0  0  0\\\\\n0  2  0  0\\\\\n0  0  0  0\\\\\n0  0  0  r_{4}\n\\end{bmatrix} = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  -2  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  -r_{4}\n\\end{bmatrix}.$$\n输出矩阵 $C$ 由 $C = G^{\\top}Q = G^{\\top}I_{4} = G^{\\top}$ 给出。\n$$C = \\begin{bmatrix}\n1  0\\\\\n0  1\\\\\n0  0\\\\\n0  0\n\\end{bmatrix}^{\\top} = \\begin{bmatrix}\n1  0  0  0\\\\\n0  1  0  0\n\\end{bmatrix}.$$\n不可观测子空间是能观性矩阵 $\\mathcal{O}$ 的零空间，定义为\n$$\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^{2} \\\\ CA^{3} \\end{bmatrix}.$$\n一个状态向量 $x$ 属于不可观测子空间，当且仅当 $x \\in \\ker(\\mathcal{O})$，这等价于对所有整数 $k \\ge 0$ 都有 $CA^{k}x = 0$。\n设 $x = \\begin{pmatrix} x_{1}  x_{2}  x_{3}  x_{4} \\end{pmatrix}^{\\top}$ 是一个不可观测状态。\n第一个条件是 $Cx = 0$：\n$$Cx = \\begin{bmatrix}\n1  0  0  0\\\\\n0  1  0  0\n\\end{bmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\\\ x_{4} \\end{pmatrix} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\n这意味着任何不可观测状态都必须满足 $x_{1}=0$ 和 $x_{2}=0$，所以它必须具有形式 $x = \\begin{pmatrix} 0  0  x_{3}  x_{4} \\end{pmatrix}^{\\top}$。\n\n现在我们考虑条件 $CAx = 0$。首先，我们计算 $Ax$：\n$$Ax = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  -2  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  -r_{4}\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ x_{3} \\\\ x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ x_{3} \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix}.$$\n然后，我们应用 $C$：\n$$CAx = \\begin{bmatrix}\n1  0  0  0\\\\\n0  1  0  0\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ x_{3} \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ x_{3} \\end{pmatrix}.$$\n为了使 $x$ 不可观测，我们要求 $CAx = 0$，这意味着 $x_{3} = 0$。\n因此，一个不可观测状态必须具有形式 $x = \\begin{pmatrix} 0  0  0  x_{4} \\end{pmatrix}^{\\top}$。\n\n我们必须通过检查对所有 $k \\ge 0$ 都有 $CA^{k}x = 0$ 来验证任何这样的状态确实是不可观测的。设 $x = \\begin{pmatrix} 0  0  0  x_{4} \\end{pmatrix}^{\\top}$。我们已经证明了 $Cx=0$ 和 $CAx=0$。\n让我们计算 $A^{2}x$：\n$$A^{2}x = A(Ax) = A \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -r_{4}x_{4} \\end{pmatrix} = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  -2  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  -r_{4}\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ (-r_{4})^{2} x_{4} \\end{pmatrix}.$$\n那么 $CA^{2}x = C \\begin{pmatrix} 0  0  0  (-r_{4})^{2} x_{4} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n通过归纳法，很明显对于任何 $k \\ge 1$，$A^{k}x = \\begin{pmatrix} 0  0  0  (-r_{4})^{k} x_{4} \\end{pmatrix}^{\\top}$，因此 $CA^{k}x = 0$。\n因此，不可观测子空间是所有形如 $\\begin{pmatrix} 0  0  0  x_{4} \\end{pmatrix}^{\\top}$ 的向量的集合。这个子空间由向量 $\\begin{pmatrix} 0  0  0  1 \\end{pmatrix}^{\\top}$ 张成。\n这个子空间的维数 $d$ 是 $1$。所以，$d=1$。\n\n接下来，我们必须确定局限于此不可观测子空间内的轨迹的渐近衰减率 $\\alpha$。如果一条轨迹 $x(t)$ 的初始状态 $x(0)$ 在该子空间内，即对于某个常数 $x_{4,0}$ 有 $x(0) = \\begin{pmatrix} 0  0  0  x_{4,0} \\end{pmatrix}^{\\top}$，那么这条轨迹就局限于该子空间内。\n零输入（$u=0$）系统的动态为 $\\dot{x} = Ax$。对于不可观测子空间中的状态 $x$，即 $x(t) = \\begin{pmatrix} 0  0  0  x_{4}(t) \\end{pmatrix}^{\\top}$，其动态简化为第四个分量：\n$$\\dot{x}_{4}(t) = [A x(t)]_{4} = -r_{4} x_{4}(t).$$\n这是一个一阶线性常微分方程。其解为：\n$$x_{4}(t) = x_{4}(0) \\exp(-r_{4} t).$$\n完整的状态轨迹是 $x(t) = \\begin{pmatrix} 0  0  0  x_{4}(0) \\exp(-r_{4}t) \\end{pmatrix}^{\\top}$。\n问题将 $\\alpha$ 定义为使这些轨迹按比例 $\\exp(-\\alpha t)$ 衰减的正数。通过将 $x_4(t)$ 与此定义进行比较，我们确定了衰减率。\n因为 $r_{4} > 0$，轨迹确实在衰减。衰减率为 $\\alpha = r_{4}$。\n这证实了系统是能检的，因为对应于特征值 $\\lambda = -r_{4}$ 的不可观测模式是渐近稳定的。\n\n不可观测子空间的维数是 $d=1$，其轨迹的渐近衰减率是 $\\alpha = r_{4}$。问题要求将这两个值放在一个行矩阵中。", "answer": "$$\\boxed{\\begin{pmatrix} 1  r_{4} \\end{pmatrix}}$$", "id": "2733257"}, {"introduction": "现实世界中的许多物理系统，特别是机器人和多体系统，都受到几何约束（即完整约束）的限制。本练习将引导你学习一种在pH框架内处理此类约束的系统性方法——投影法。你将通过推导拉格朗日乘子来计算维持系统在约束流形上运动所需的约束力，这是将几何约束融入动力学模型和控制设计的关键技能，对于高级机械系统的建模与控制具有重要意义。", "problem": "考虑以下有限维端口哈密顿（port-Hamiltonian, pH）模型，该模型描述了两个通过线性弹簧和阻尼器连接到地面的点质量。构型向量为 $q \\in \\mathbb{R}^{2}$，其分量为 $q_{1}$ 和 $q_{2}$；共轭动量向量为 $p \\in \\mathbb{R}^{2}$，其分量为 $p_{1}$ 和 $p_{2}$。设质量矩阵为 $M = \\mathrm{diag}(m_{1}, m_{2})$，其中 $m_{1} > 0$ 且 $m_{2} > 0$；刚度矩阵为 $K = \\mathrm{diag}(k_{1}, k_{2})$，其中 $k_{1} > 0$ 且 $k_{2} > 0$；粘性阻尼矩阵为 $D = \\mathrm{diag}(d_{1}, d_{2})$，其中 $d_{1} \\ge 0$ 且 $d_{2} \\ge 0$。外部控制力 $u \\in \\mathbb{R}$ 仅作为力作用于第二个质量块，因此输入分布为 $B = \\begin{bmatrix} 0 \\\\ b \\end{bmatrix}$，其中 $b \\neq 0$。哈密顿量为\n$$\nH(q,p) = \\frac{1}{2} p^{\\top} M^{-1} p \\;+\\; \\frac{1}{2} q^{\\top} K q,\n$$\n带线性耗散的无约束 pH 演化由 pH 形式的哈密顿方程给出：\n$$\n\\dot{q} \\;=\\; \\frac{\\partial H}{\\partial p}, \n\\qquad\n\\dot{p} \\;=\\; -\\,\\frac{\\partial H}{\\partial q} \\;-\\; D\\,\\frac{\\partial H}{\\partial p} \\;+\\; B\\,u.\n$$\n假设要施加一个完整约束，\n$$\nA\\,q \\;=\\; 0, \\qquad A \\;=\\; \\begin{bmatrix} 1  1 \\end{bmatrix},\n$$\n其表示 $q_{1} + q_{2} = 0$。在端口哈密顿系统中，施加此类约束的两种标准策略是：\n- 使用 Lagrange 乘子进行投影（即，通过约束端口 $A^{\\top} \\lambda$ 增广动量动态，并选择 $\\lambda$ 以使约束流形保持不变）。\n- 惩罚法，通过向哈密顿量中添加二次惩罚项 $\\frac{k_{p}}{2}\\,|A q|^{2}$，其中刚度 $k_{p} > 0$。\n\n仅从上述定义和 pH 方程的基本形式出发，推导基于投影的 Lagrange 乘子 $\\lambda(q,p,u)$，该乘子可确保约束流形 $A q = 0$ 在所有时间内保持不变。将您的最终结果表示为包含变量和参数 $m_{1}, m_{2}, k_{1}, k_{2}, d_{1}, d_{2}, b, q_{1}, q_{2}, p_{1}, p_{2}, u$ 的单一闭式解析表达式。不要进行任何数值代入，也不要四舍五入。您的最终答案必须是一个不带单位且不含不等号的单一解析表达式。", "solution": "目标是找到 Lagrange 乘子 $\\lambda(q,p,u)$，以确保完整约束 $Aq=0$ 在系统动力学下保持不变。系统由状态向量 $x = \\begin{pmatrix} q \\\\ p \\end{pmatrix}$ 和哈密顿量 $H(q,p) = \\frac{1}{2} p^{\\top} M^{-1} p + \\frac{1}{2} q^{\\top} K q$ 描述。包含约束力的增广动力学由以下方程给出：\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} - D \\frac{\\partial H}{\\partial p} + B u + A^{\\top} \\lambda $$\n完整约束定义为 $c_1(q) = Aq = 0$，其中 $A = \\begin{bmatrix} 1  1 \\end{bmatrix}$。为了使该约束在所有时间 $t \\ge 0$ 内保持不变，任何从约束流形上开始的轨迹都必须保持在该流形上。这要求在系统状态已经处于流形上的假设下，约束方程的时间导数为零。\n约束的一阶时间导数为：\n$$ \\dot{c}_1(q,p) = \\frac{d}{dt}(Aq) = A \\dot{q} $$\n代入 pH 动力学中的 $\\dot{q}$ 方程，我们得到：\n$$ \\dot{c}_1(q,p) = A \\frac{\\partial H}{\\partial p} $$\n为了保持不变性，必须有 $\\dot{c}_1(q,p) = 0$。这导致了对动量的二级（或隐藏）约束：\n$$ c_2(q,p) = A \\frac{\\partial H}{\\partial p} = 0 $$\n因此，必须使其保持不变的完整约束流形为 $\\mathcal{M} = \\{ (q,p) \\in \\mathbb{R}^4 \\mid c_1(q)=0 \\text{ 且 } c_2(q,p)=0 \\}$。为了使轨迹保持在 $\\mathcal{M}$ 中，对于任何状态 $(q,p) \\in \\mathcal{M}$，$c_2(q,p)$ 的时间导数也必须为零。\n$$ \\dot{c}_2(q,p,u) = \\frac{d}{dt}\\left(A \\frac{\\partial H}{\\partial p}\\right) = 0 $$\n项 $\\frac{\\partial H}{\\partial p}$ 是 $p$ 的函数，而 $p$ 是时间的函数。使用链式法则以及 $M$ 是常数这一事实：\n$$ \\dot{c}_2 = A \\frac{d}{dt}(M^{-1}p) = A M^{-1} \\dot{p} $$\n选择 Lagrange 乘子 $\\lambda$ 正是为了满足这个条件。我们代入 $\\dot{p}$ 的增广动力学方程：\n$$ A M^{-1} \\left( -\\frac{\\partial H}{\\partial q} - D\\frac{\\partial H}{\\partial p} + B u + A^{\\top} \\lambda \\right) = 0 $$\n这个方程对于标量 $\\lambda$ 是线性的，可以直接求解。\n$$ A M^{-1} A^{\\top} \\lambda = - A M^{-1} \\left( -\\frac{\\partial H}{\\partial q} - D\\frac{\\partial H}{\\partial p} + B u \\right) $$\n$$ A M^{-1} A^{\\top} \\lambda = A M^{-1} \\left( \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u \\right) $$\n这就得到了 $\\lambda$ 的形式解：\n$$ \\lambda = (A M^{-1} A^{\\top})^{-1} A M^{-1} \\left( \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u \\right) $$\n现在我们使用给定的参数计算每一项。矩阵为：\n$M^{-1} = \\begin{pmatrix} 1/m_1  0 \\\\ 0  1/m_2 \\end{pmatrix}$, $K = \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix}$, $D = \\begin{pmatrix} d_1  0 \\\\ 0  d_2 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ b \\end{pmatrix}$, $A = \\begin{pmatrix} 1  1 \\end{pmatrix}$, $A^{\\top} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n哈密顿量的偏导数为：\n$$ \\frac{\\partial H}{\\partial q} = Kq = \\begin{pmatrix} k_1 q_1 \\\\ k_2 q_2 \\end{pmatrix} $$\n$$ \\frac{\\partial H}{\\partial p} = M^{-1}p = \\begin{pmatrix} p_1/m_1 \\\\ p_2/m_2 \\end{pmatrix} $$\n\n首先，计算可逆标量项 $(A M^{-1} A^{\\top})$：\n$$ A M^{-1} A^{\\top} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1/m_1  0 \\\\ 0  1/m_2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/m_1  1/m_2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{m_1} + \\frac{1}{m_2} = \\frac{m_1+m_2}{m_1 m_2} $$\n由于 $m_1 > 0$ 且 $m_2 > 0$，该项非零，其逆为 $(A M^{-1} A^{\\top})^{-1} = \\frac{m_1 m_2}{m_1 + m_2}$。\n\n接下来，计算括号中的向量项：\n$$ \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u = \\begin{pmatrix} k_1 q_1 \\\\ k_2 q_2 \\end{pmatrix} + \\begin{pmatrix} d_1  0 \\\\ 0  d_2 \\end{pmatrix} \\begin{pmatrix} p_1/m_1 \\\\ p_2/m_2 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ b \\end{pmatrix}u $$\n$$ = \\begin{pmatrix} k_1 q_1 + d_1 p_1/m_1 \\\\ k_2 q_2 + d_2 p_2/m_2 - bu \\end{pmatrix} $$\n\n最后，用 $A M^{-1}$ 左乘该向量：\n$$ A M^{-1} = \\begin{pmatrix} 1/m_1  1/m_2 \\end{pmatrix} $$\n$$ A M^{-1} \\left( \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u \\right) = \\frac{1}{m_1}(k_1 q_1 + \\frac{d_1 p_1}{m_1}) + \\frac{1}{m_2}(k_2 q_2 + \\frac{d_2 p_2}{m_2} - bu) $$\n$$ = \\frac{k_1 q_1}{m_1} + \\frac{d_1 p_1}{m_1^2} + \\frac{k_2 q_2}{m_2} + \\frac{d_2 p_2}{m_2^2} - \\frac{bu}{m_2} $$\n\n将所有部分组合起来，我们得到 $\\lambda$ 的最终表达式：\n$$ \\lambda = \\left(\\frac{m_1 m_2}{m_1 + m_2}\\right) \\left( \\frac{k_1 q_1}{m_1} + \\frac{d_1 p_1}{m_1^2} + \\frac{k_2 q_2}{m_2} + \\frac{d_2 p_2}{m_2^2} - \\frac{bu}{m_2} \\right) $$\n这是 Lagrange 乘子作为系统状态 $(q,p)$、外部输入 $u$ 和系统参数的函数的闭式解析表达式。当通过约束端口 $A^{\\top}$ 将此乘子作为力施加时，可确保约束流形 $\\mathcal{M}$ 是闭环系统动力学的一个不变集。", "answer": "$$\n\\boxed{\\frac{m_1 m_2}{m_1 + m_2} \\left( \\frac{k_1 q_1}{m_1} + \\frac{d_1 p_1}{m_1^2} + \\frac{k_2 q_2}{m_2} + \\frac{d_2 p_2}{m_2^2} - \\frac{b u}{m_2} \\right)}\n$$", "id": "2733287"}]}