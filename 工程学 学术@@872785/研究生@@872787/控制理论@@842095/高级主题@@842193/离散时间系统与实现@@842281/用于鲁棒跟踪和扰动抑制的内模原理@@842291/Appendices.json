{"hands_on_practices": [{"introduction": "在我们设计控制器来处理外部信号之前，我们必须首先对这些信号进行数学描述。本练习聚焦于“内模原理”中的“模型”部分，通过构建一个“外部系统”（exosystem）——一个其输出恰好是我们的被控过程需要跟踪或抑制的参考或扰动信号的线性系统[@problem_id:2752883]。理解如何为多项式和正弦信号建立这种模型是应用该原理的一项基本技能。", "problem": "考虑线性时不变 (LTI) 控制设计中的内模原理 (IMP)。设参考/扰动信号族为\n$$\\{1,\\, t,\\, \\ldots,\\, t^{k},\\, \\sin(\\omega_{1} t),\\, \\cos(\\omega_{1} t),\\, \\ldots,\\, \\sin(\\omega_{m} t),\\, \\cos(\\omega_{m} t)\\},$$\n其中 $k \\in \\mathbb{N}_{0}$，$m \\in \\mathbb{N}$，且 $\\omega_{1},\\ldots,\\omega_{m} \\in \\mathbb{R}_{>0}$ 是两两互不相同的。你需要构建一个有限维 LTI 外系统\n$$\\dot{w} = S w,\\quad r = F w,$$\n该系统具有状态 $w \\in \\mathbb{R}^{n}$，对于合适的初始条件 $w(0)$，其输出 $r(t)$ 恰好能生成上述信号的线性张成空间。请以分块对角形式显式地给出矩阵 $S$ 和 $F$，要求只使用实常数项，并且各分块的尺寸为实现所需信号的最小尺寸。然后，确定使得这样一个外系统存在的最小可能状态维度 $n$（即 $w$ 的最小维度）。请将最终答案表示为一个关于 $k$ 和 $m$ 的闭式符号表达式。最终答案必须是一个不带单位的单一解析表达式。", "solution": "首先将对问题陈述进行严格的验证程序。\n\n## 问题验证\n\n### 步骤 1：提取已知条件\n- **主题**：线性时不变 (LTI) 控制设计中的内模原理 (IMP)。\n- **信号族**：$\\{1,\\, t,\\, \\ldots,\\, t^{k},\\, \\sin(\\omega_{1} t),\\, \\cos(\\omega_{1} t),\\, \\ldots,\\, \\sin(\\omega_{m} t),\\, \\cos(\\omega_{m} t)\\}$ 的线性张成。\n- **参数**：$k \\in \\mathbb{N}_{0}$，$m \\in \\mathbb{N}$，以及 $\\omega_{1},\\ldots,\\omega_{m} \\in \\mathbb{R}_{>0}$ 是两两互不相同的正实数。\n- **外系统模型**：一个由 $\\dot{w} = S w$，$r = F w$ 给出的有限维 LTI 系统，其状态为 $w \\in \\mathbb{R}^{n}$。\n- **任务 1**：显式地构建矩阵 $S$ 和 $F$。$S$ 必须是分块对角形式，使用实常数项和最小尺寸的分块。\n- **任务 2**：确定最小可能的状态维度 $n$，表示为关于 $k$ 和 $m$ 的闭式符号表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行分析。\n\n1.  **科学依据**：该问题是现代控制理论中的一个标准练习。构建一个外系统以生成一类特定信号，是内模原理背后的一个基本概念。这些信号——多项式和正弦波——是此背景下使用的典型例子。该问题完全基于线性系统和微分方程的既定原理。\n2.  **适定性**：问题是适定的。它要求一个线性系统的最小实现，该系统能生成一个特定的、定义明确的函数空间。线性系统理论保证了这种最小实现存在且其维度是唯一的。对矩阵的约束（$S$ 为实数分块对角矩阵）是标准且可实现的。\n3.  **客观性**：问题以精确的数学语言陈述，没有任何主观性、模糊性或观点。\n4.  **完整性与一致性**：问题是自洽的。所有参数（$k, m, \\omega_j$）都定义了各自的域。频率 $\\omega_j$ 为正且互不相同的条件是至关重要的，并且被正确地指定，以避免由重复或零频率正弦模态引起的不必要复杂性。没有矛盾之处。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、适定的、客观的和完整的。它是一个有效的控制系统工程问题。我将继续进行解答。\n\n## 解\n\n构建一个能生成一族信号的外系统 $\\dot{w} = Sw$ 的核心原理是，矩阵 $S$ 的特征值必须与信号的模态相对应。这些模态由信号空间基函数的拉普拉斯变换的极点确定。\n\n给定的信号族是两类函数的线性张成：\n1.  多项式：$\\{1, t, \\ldots, t^{k}\\}$\n2.  正弦波：$\\{\\sin(\\omega_{j} t), \\cos(\\omega_{j} t)\\}$，对于 $j \\in \\{1, \\ldots, m\\}$\n\n根据线性系统的叠加原理，我们可以通过组合生成这些信号类型的最小阶子系统来构建总的外系统。\n\n**第 1 部分：生成多项式信号**\n信号集 $\\{1, t, \\ldots, t^{k}\\}$ 构成了常系数齐次线性微分方程的解空间：\n$$ \\frac{d^{k+1}r}{dt^{k+1}} = 0 $$\n其特征方程为 $\\lambda^{k+1} = 0$，它有一个单根 $\\lambda = 0$，代数重数为 $k+1$。对于一个要生成这些信号的 LTI 系统，其动态矩阵必须有一个位于 $0$ 的特征值，且其对应的若尔当块尺寸至少为 $k+1$。通过一个尺寸恰好为 $k+1$ 的单个若尔当块可以实现最小实现。\n我们可以用状态空间形式来表示。设该子系统的状态向量为 $w_p \\in \\mathbb{R}^{k+1}$。一个最小实现由能控标准型给出：\n$$ \\dot{w}_p = S_p w_p $$\n其中 $S_p$ 是与特征值 $\\lambda=0$ 相关联的 $(k+1) \\times (k+1)$ 若尔当块：\n$$ S_p = \\begin{pmatrix} 0  1  0  \\cdots  0 \\\\ 0  0  1  \\cdots  0 \\\\ \\vdots  \\vdots  \\ddots  \\ddots  \\vdots \\\\ 0  0  0  \\cdots  1 \\\\ 0  0  0  \\cdots  0 \\end{pmatrix} $$\n为确保输出能张成整个多项式空间，我们必须选择一个输出矩阵 $F_p$，使得矩阵对 $(F_p, S_p)$ 是能观的。一个标准的选择是 $F_p = \\begin{pmatrix} 1  0  \\cdots  0 \\end{pmatrix}$，这使得输出 $r_p(t)$ 等于第一个状态变量 $w_{p,1}(t)$。在此选择下，$w_{p,2} = \\dot{w}_{p,1}$，$w_{p,3} = \\ddot{w}_{p,1}$，依此类推，直到 $w_{p, k+1} = w_{p,1}^{(k)}$。动态方程 $\\dot{w}_{p,k+1}=0$ 意味着 $w_{p,1}^{(k+1)}=0$，这正是所期望的微分方程。通过为 $w_p(0)$ 选择合适的初始条件，输出 $r_p(t) = w_{p,1}(t)$ 可以是任何次数最高为 $k$ 的多项式。这个多项式生成子系统的最小维度是 $n_p = k+1$。\n\n**第 2 部分：生成正弦信号**\n对于每个 $j \\in \\{1, \\ldots, m\\}$，信号对 $\\{\\sin(\\omega_j t), \\cos(\\omega_j t)\\}$ 构成了微分方程的解空间：\n$$ \\frac{d^2 r}{dt^2} + \\omega_j^2 r = 0 $$\n其特征方程为 $\\lambda^2 + \\omega_j^2 = 0$，根为 $\\lambda = \\pm i\\omega_j$。一个能生成这些信号的最小 LTI 系统必须有一对共轭复数特征值 $\\pm i\\omega_j$。对于一个实值矩阵的系统，这需要至少 2 维的状态。\n设第 $j$ 对正弦信号的状态子向量为 $w_j \\in \\mathbb{R}^2$。一个最小实值实现由以下给出：\n$$ \\dot{w}_j = S_j w_j $$\n其中 $S_j$ 是对应于特征值 $\\pm i\\omega_j$ 的 $2 \\times 2$ 实标准型矩阵：\n$$ S_j = \\begin{pmatrix} 0  \\omega_j \\\\ -\\omega_j  0 \\end{pmatrix} $$\n该系统的解具有 $w_{j,1}(t) = A\\cos(\\omega_j t) + B\\sin(\\omega_j t)$ 的形式。为了生成所需的信号空间，我们可以选择输出矩阵 $F_j = \\begin{pmatrix} 1  0 \\end{pmatrix}$。由于 $\\omega_j > 0$，矩阵对 $(F_j, S_j)$ 是能观的。每个这样的正弦子系统的最小维度是 $n_j = 2$。\n\n**第 3 部分：组装总外系统**\n信号基函数是具有互不相同的非零频率的多项式和正弦波。这些函数是线性无关的。与这些信号相对应的特征值是多项式的 $\\{0\\}$ 和正弦波的 $\\{\\pm i\\omega_1, \\ldots, \\pm i\\omega_m\\}$。由于所有的 $\\omega_j$ 都是正数且互不相同，所以这些特征值也都互不相同。\n因此，总的最小外系统可以构建为各个最小子系统的直和。总状态向量是 $w = (w_p^T, w_1^T, \\ldots, w_m^T)^T$。系统矩阵 $S$ 和 $F$ 呈分块结构。\n\n矩阵 $S$ 是一个分块对角矩阵：\n$$ S = \\text{diag}(S_p, S_1, S_2, \\ldots, S_m) = \\begin{pmatrix} S_p  \\mathbf{0}  \\cdots  \\mathbf{0} \\\\ \\mathbf{0}  S_1   \\mathbf{0} \\\\ \\vdots   \\ddots  \\vdots \\\\ \\mathbf{0}  \\mathbf{0}  \\cdots  S_m \\end{pmatrix} $$\n其中 $S_p$ 是前面定义的 $(k+1) \\times (k+1)$ 矩阵，每个 $S_j$ 是 $j=1, \\ldots, m$ 对应的 $2 \\times 2$ 矩阵。零矩阵 $\\mathbf{0}$ 具有适当的维度。\n\n输出矩阵 $F$ 是一个行向量，它组合了来自每个子系统的输出：\n$$ F = \\begin{pmatrix} F_p  F_1  F_2  \\cdots  F_m \\end{pmatrix} $$\n其中 $F_p = \\begin{pmatrix} 1  0  \\cdots  0 \\end{pmatrix}$ 是 $1 \\times (k+1)$，每个 $F_j = \\begin{pmatrix} 1  0 \\end{pmatrix}$ 是 $1 \\times 2$。\n输出 $r(t) = F w(t)$ 是每个分块输出的总和。由于这些分块是解耦的，并且每个分块对于输出矩阵 $F$ 的相应部分都是能观的，因此通过选择合适的初始条件向量 $w(0)$，可以生成基函数张成空间中的任何信号。\n\n**第 4 部分：确定最小维度**\n状态向量 $w$ 的最小维度 $n$ 是各最小子系统维度的总和。\n- 多项式部分 $\\{1, t, \\ldots, t^k\\}$ 的维度是 $n_p = k+1$。\n- 每对正弦信号 $\\{\\sin(\\omega_j t), \\cos(\\omega_j t)\\}$ 的维度是 $n_j=2$。因为有 $m$ 对这样的信号，它们对总维度的贡献是 $2m$。\n\n因此，总的最小维度 $n$ 是：\n$$ n = n_p + \\sum_{j=1}^{m} n_j = (k+1) + 2m $$\n\n此表达式给出了生成指定信号族的 LTI 外系统的最小可能状态维度。", "answer": "$$\n\\boxed{k + 1 + 2m}\n$$", "id": "2752883"}, {"introduction": "定义了外部系统之后，我们就可以确定实现完美调节所需的理论稳态对象行为。本练习介绍被称为“调节器方程”的核心代数约束[@problem_id:2752873]。通过求解给定系统的这些方程，您将计算出精确的前馈状态和控制映射（$ \\Pi $ 和 $ \\Gamma $），以确保跟踪误差在稳态下恒为零。", "problem": "考虑标准输出调节设置中的线性时不变对象和外系统：\n- 对象动态：$\\dot{x} = A x + B u + P w$，测量/调节误差为 $e = C x + D u + Q w$。\n- 外系统动态：$\\dot{w} = S w$。\n这里 $x \\in \\mathbb{R}^{2}$，$u \\in \\mathbb{R}$，且 $w \\in \\mathbb{R}$。矩阵为\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  0 \\end{pmatrix}, \\quad\nD = \\begin{pmatrix} 0 \\end{pmatrix},\n$$\n$$\nP = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nQ = \\begin{pmatrix} -1 \\end{pmatrix}, \\quad\nS = \\begin{pmatrix} 0 \\end{pmatrix}.\n$$\n从稳态跟踪和内模原理（IMP）的基本定义出发：假设稳态信号的形式为 $x_{\\mathrm{ss}}(t) = \\Pi w(t)$ 和 $u_{\\mathrm{ss}}(t) = \\Gamma w(t)$，对于由外系统 $\\dot{w} = S w$ 生成的所有轨迹 $w(\\cdot)$，稳态误差 $e_{\\mathrm{ss}}(t) \\equiv 0$。使用这些定义以及对象和外系统的方程，推导调节器方程，该方程将未知矩阵 $\\Pi \\in \\mathbb{R}^{2 \\times 1}$ 和 $\\Gamma \\in \\mathbb{R}^{1 \\times 1}$ 与给定数据 $(A,B,C,D,P,Q,S)$ 联系起来。然后，对于上述具体的数值数据，求解 $\\Pi$ 和 $\\Gamma$ 并直接验证调节器方程成立。\n\n将 $\\Gamma$ 的值作为最终答案。请以精确实数形式表示答案（无需四舍五入）。不需要物理单位。", "solution": "该问题要求推导用于输出调节的调节器方程，并为一组给定的系统矩阵求解这些方程。我们首先验证问题陈述。\n\n**问题验证**\n\n步骤 1：提取已知条件\n给定系统是一个线性时不变对象及其关联的外系统，由以下方程和矩阵描述：\n对象动态：$\\dot{x} = A x + B u + P w$\n调节误差：$e = C x + D u + Q w$\n外系统动态：$\\dot{w} = S w$\n\n状态、输入和外系统状态的维度分别为 $x \\in \\mathbb{R}^{2}$，$u \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$。给定矩阵如下：\n$A = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}$，$B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$C = \\begin{pmatrix} 1  0 \\end{pmatrix}$，$D = \\begin{pmatrix} 0 \\end{pmatrix}$。\n$P = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$Q = \\begin{pmatrix} -1 \\end{pmatrix}$，$S = \\begin{pmatrix} 0 \\end{pmatrix}$。\n\n问题假设存在形为 $x_{\\mathrm{ss}}(t) = \\Pi w(t)$ 和 $u_{\\mathrm{ss}}(t) = \\Gamma w(t)$ 的稳态解，其中 $\\Pi \\in \\mathbb{R}^{2 \\times 1}$ 和 $\\Gamma \\in \\mathbb{R}^{1 \\times 1}$ 是常数矩阵，使得对于由外系统生成的所有轨迹 $w(t)$，稳态误差 $e_{\\mathrm{ss}}(t)$ 恒等于零。\n\n步骤 2：使用提取的已知条件进行验证\n该问题是在控制理论的标准数学框架内提出的，特别是输出调节理论。\n- **科学性：** 问题使用了标准的状态空间表示和内模原理的核心概念。它不含科学谬误或伪科学。\n- **适定性：** 问题提供了一整套矩阵，并要求推导和求解代数方程。$\\Pi$ 和 $\\Gamma$ 解的存在性和唯一性取决于由给定系统矩阵构造的特定矩阵的可逆性。初步检查表明该条件得到满足，因此问题是适定的。\n- **客观性：** 问题使用精确的数学语言陈述，没有主观或含糊的术语。\n该问题是自洽、一致且科学合理的。\n\n步骤 3：结论与行动\n该问题被判定为**有效**。我们现在开始求解。\n\n**调节器方程的推导**\n\n目标是找到矩阵 $\\Pi$ 和 $\\Gamma$，使得当 $x(t) = x_{\\mathrm{ss}}(t) = \\Pi w(t)$ 且 $u(t) = u_{\\mathrm{ss}}(t) = \\Gamma w(t)$ 时，对于由 $\\dot{w} = S w$ 生成的任何 $w(t)$，对象的动态方程得以满足且误差 $e(t)$ 为零。\n\n首先，我们将稳态信号代入对象动态方程：\n$\\dot{x}_{\\mathrm{ss}} = A x_{\\mathrm{ss}} + B u_{\\mathrm{ss}} + P w$。\n$x_{\\mathrm{ss}}(t)$ 的时间导数由链式法则给出：$\\dot{x}_{\\mathrm{ss}}(t) = \\frac{d}{dt} (\\Pi w(t)) = \\Pi \\dot{w}(t)$。\n使用外系统动态 $\\dot{w} = S w$，我们得到 $\\dot{x}_{\\mathrm{ss}} = \\Pi S w$。\n将所有稳态表达式代入对象方程得到：\n$\\Pi S w = A (\\Pi w) + B (\\Gamma w) + P w$。\n该方程必须对所有由外系统生成的 $w(t)$ 成立。因此，我们可以写出：\n$(\\Pi S - A \\Pi - B \\Gamma - P)w = 0$。\n为了使该式对任何非平凡的 $w$ 都成立，乘以 $w$ 的矩阵必须为零。这给出了第一个调节器方程：\n$\\Pi S = A \\Pi + B \\Gamma + P$，或者，整理后得：\n$A \\Pi + B \\Gamma - \\Pi S = -P$。\n\n其次，我们强制稳态误差为零的条件，$e_{\\mathrm{ss}}(t) \\equiv 0$。误差由 $e = C x + D u + Q w$ 给出。在稳态下：\n$e_{\\mathrm{ss}} = C x_{\\mathrm{ss}} + D u_{\\mathrm{ss}} + Q w = C(\\Pi w) + D(\\Gamma w) + Q w = (C \\Pi + D \\Gamma + Q)w$。\n为了使 $e_{\\mathrm{ss}}(t)$ 对任何 $w(t)$ 都为零，矩阵因子必须为零。这给出了第二个调节器方程：\n$C \\Pi + D \\Gamma + Q = 0$，或者，整理后得：\n$C \\Pi + D \\Gamma = -Q$。\n\n这对矩阵方程\n$$\n\\begin{cases}\nA \\Pi + B \\Gamma - \\Pi S = -P \\\\\nC \\Pi + D \\Gamma = -Q\n\\end{cases}\n$$\n是通用的调节器方程。\n\n**针对给定数据的求解**\n\n我们现在使用提供的数值矩阵来解这些方程。\n矩阵 $S$ 被给出为 $S = \\begin{pmatrix} 0 \\end{pmatrix}$，这将第一个调节器方程简化为：\n$A \\Pi + B \\Gamma = -P$。\n矩阵 $D$ 被给出为 $D = \\begin{pmatrix} 0 \\end{pmatrix}$，这将第二个调节器方程简化为：\n$C \\Pi = -Q$。\n\n设未知矩阵表示为 $\\Pi = \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix}$ 和 $\\Gamma = \\begin{pmatrix} \\gamma_1 \\end{pmatrix}$。\n\n我们从第二个更简单的方程开始：$C \\Pi = -Q$。\n代入矩阵：\n$$\n\\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix} = - \\begin{pmatrix} -1 \\end{pmatrix}\n$$\n执行矩阵乘法得到：\n$$\n\\begin{pmatrix} \\pi_1 \\end{pmatrix} = \\begin{pmatrix} 1 \\end{pmatrix}\n$$\n因此，我们得到 $\\pi_1 = 1$。\n\n接下来，我们使用第一个方程：$A \\Pi + B \\Gamma = -P$。\n代入矩阵和已知的 $\\pi_1$ 值：\n$$\n\\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\pi_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} \\gamma_1 \\end{pmatrix} = - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n展开矩阵乘积：\n$$\n\\begin{pmatrix} \\pi_2 \\\\ -2 - 3\\pi_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\gamma_1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\n这个向量方程产生了一个由两个线性方程组成的方程组：\n1. $\\pi_2 + 0 = 0 \\implies \\pi_2 = 0$。\n2. $-2 - 3\\pi_2 + \\gamma_1 = -1$。\n\n将 $\\pi_2 = 0$ 代入第二个方程：\n$-2 - 3(0) + \\gamma_1 = -1$\n$-2 + \\gamma_1 = -1$\n$\\gamma_1 = 1$。\n\n因此，解为 $\\Pi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\Gamma = \\begin{pmatrix} 1 \\end{pmatrix}$。\n\n**验证**\n\n按照要求，我们将 $\\Pi$ 和 $\\Gamma$ 代回调节器方程进行验证。\n方程 1：$A \\Pi + B \\Gamma = -P$。\n左侧 (LHS)：\n$$\n\\text{LHS} = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\n右侧 (RHS)：\n$$\n\\text{RHS} = -P = -\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\nLHS = RHS。第一个方程成立。\n\n方程 2：$C \\Pi = -Q$。\n左侧 (LHS)：\n$$\n\\text{LHS} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\end{pmatrix}\n$$\n右侧 (RHS)：\n$$\n\\text{RHS} = -Q = -\\begin{pmatrix} -1 \\end{pmatrix} = \\begin{pmatrix} 1 \\end{pmatrix}\n$$\nLHS = RHS。第二个方程成立。\n验证成功。$\\Gamma$ 的值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2752873"}, {"introduction": "最后一个练习将所有概念融合到一个综合性的控制设计问题中。您将超越纯粹的代数求解，设计一个动态反馈控制器，该控制器不仅包含用于跟踪和扰动抑制所必需的内部模型，而且还确保整个闭环系统的稳定性[@problem_id:2752843]。本练习包括通过极点配置来稳定增广系统以及设计状态观测器，真实反映了一个完整且实用的调节器设计流程。", "problem": "考虑以下带输入加性扰动和待跟踪正弦参考的单输入单输出线性时不变 (LTI) 对象：\n$$\n\\dot{x}(t) = -2\\,x(t) + u(t) + d(t), \\quad y(t) = x(t),\n$$\n其中 $x(t) \\in \\mathbb{R}$ 是对象状态，$u(t) \\in \\mathbb{R}$ 是控制输入，$d(t) \\in \\mathbb{R}$ 是未知常数扰动，$y(t) \\in \\mathbb{R}$ 是测量输出。待跟踪的参考信号 $r(t)$ 是一个满足以下条件的二维外系统状态 $w_{r}(t) \\in \\mathbb{R}^{2}$ 的第一个分量：\n$$\n\\dot{w}_{r}(t) = S_{r}\\,w_{r}(t), \n\\quad \nr(t) = F_{r}\\,w_{r}(t), \n\\quad \nS_{r} = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}, \n\\quad \nF_{r} = \\begin{bmatrix} 1  0 \\end{bmatrix},\n$$\n因此 $r(t)$ 是一个相位和幅值未知、单位弧度频率的正弦波。（未知）常数扰动满足：\n$$\n\\dot{w}_{d}(t) = 0, \\quad d(t) = w_{d}(t) \\in \\mathbb{R}.\n$$\n\n您将设计一个动态输出反馈调节器，该调节器实现内模原理以进行鲁棒跟踪和扰动抑制。使用调节误差 $e(t) \\triangleq y(t) - r(t)$，并包含一个最小内模，该内模嵌入了用于常数扰动的积分器副本和用于正弦波的振荡器副本：\n$$\n\\dot{\\eta}(t) = S\\,\\eta(t) + G\\,e(t), \n\\quad \nu(t) = -k_{x}\\,\\hat{x}(t) - k_{\\eta}^{\\top}\\,\\eta(t),\n$$\n其中 $\\eta(t) \\in \\mathbb{R}^{3}$ 汇集了内模状态，\n$$\nS = \\operatorname{diag}\\!\\big(0, S_{r}\\big) \n= \\begin{bmatrix}\n0  0  0 \\\\\n0  0  1 \\\\\n0  -1  0\n\\end{bmatrix}, \n\\quad \nG = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix},\n$$\n并使用一个对象状态观测器：\n$$\n\\dot{\\hat{x}}(t) = -2\\,\\hat{x}(t) + u(t) + \\ell\\,\\big(y(t) - \\hat{x}(t)\\big).\n$$\n\n任务：\n- 从内模原理和输出调节框架出发，论证所选内模 $(S,G)$ 的合理性，并推导全状态反馈情况 $u(t) = -k_{x}\\,x(t) - k_{\\eta}^{\\top}\\,\\eta(t)$ 下带误差注入 $\\dot{\\eta} = S\\eta + G(y-r)$ 的增广闭环动力学。\n- 计算状态反馈增益 $k_{x} \\in \\mathbb{R}$ 和 $k_{\\eta} \\in \\mathbb{R}^{3}$，使得状态对 $(x,\\eta)$ 的增广闭环矩阵的特征多项式等于 $(s+1)(s+2)(s+3)(s+4)$。\n- 计算观测器增益 $\\ell \\in \\mathbb{R}$，使得对象状态的观测器误差动力学在 $s=-6$ 处有一个极点。\n- 通过符号化推导特征多项式并匹配系数来验证特征值配置。\n- 使用调节器方程或基于内模原理的等效稳态论证，证明对于给定的外系统类别，系统可实现调节，并计算当 $r(t)$ 是单位频率的正弦波且 $d(t)$ 是任意常数时的精确稳态调节误差 $e_{\\infty}$。\n\n作为最终答案，仅提供稳态调节误差 $e_{\\infty}$ 的精确值，不带单位。无需四舍五入。", "solution": "问题陈述经审查有效。这是一个在线性控制理论，特别是输出调节和内模原理的既定框架内，一个定义明确的问题。所有必要的数据和条件都已提供，不存在科学、逻辑或数学上的不一致之处。我们可以开始求解。\n\n问题的核心是设计一个控制器，迫使对象的输出 $y(t)$ 在抑制扰动 $d(t)$ 的同时跟踪参考信号 $r(t)$。内模原理指出，为了实现渐近跟踪和扰动抑制，控制器必须包含一个能生成外源信号（$r(t)$ 和 $d(t)$）的动力学模型。\n\n扰动是一个常数，$d(t) = d_0$，由系统 $\\dot{w}_d = 0$ 和 $d=w_d$ 生成。其动态模式与特征值 $\\lambda = 0$ 相关。\n参考信号 $r(t)$ 是一个单位弧度频率的正弦波，由外系统 $\\dot{w}_r = S_r w_r$ 生成，其中 $S_r = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$。$S_r$ 的特征值为 $\\pm i$。\n其根包含所有外系统模式的最小多项式是 $p(s) = s(s-i)(s+i) = s(s^2+1) = s^3+s$。内模必须复制这些动力学。所选的内模矩阵 $S = \\operatorname{diag}(0, S_r)$ 的特征值为 $\\{0, \\pm i\\}$，因此正确地嵌入了扰动和参考信号的动力学。\n\n为了使内模 $\\dot{\\eta} = S\\eta + Ge$ 有效，误差信号 $e(t)$ 必须能够影响其所有状态。这要求对 $(S, G)$ 是能控的。能控性矩阵为 $\\mathcal{C} = [G, SG, S^2 G]$。\n给定 $S = \\begin{bmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  -1  0 \\end{bmatrix}$ 和 $G = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$，我们计算：\n$SG = \\begin{bmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  -1  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}$。\n$S^2G = S(SG) = \\begin{bmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  -1  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ -1 \\end{bmatrix}$。\n能控性矩阵是 $\\mathcal{C} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 1  0  -1 \\end{bmatrix}$。\n行列式为 $\\det(\\mathcal{C}) = 1(-1-0) = -1 \\neq 0$。对 $(S,G)$ 是能控的，所以 $G$ 的选择是合理的。\n\n首先，我们假设全状态 $x$ 可用于反馈，来设计状态反馈增益 $k_x$ 和 $k_\\eta$。控制律为 $u(t) = -k_x x(t) - k_\\eta^\\top \\eta(t)$。增广系统由对象状态 $x$ 和内模状态 $\\eta$ 组成。误差为 $e(t)=y(t)-r(t)=x(t)-r(t)$。\n动力学方程为：\n$\\dot{x} = -2x + u + d = -2x - k_x x - k_\\eta^\\top \\eta + d$\n$\\dot{\\eta} = S\\eta + G(x-r)$\n增广状态 $\\begin{pmatrix} x \\\\ \\eta \\end{pmatrix}$ 的闭环动力学齐次部分由下式给出：\n$$\n\\frac{d}{dt} \\begin{pmatrix} x \\\\ \\eta \\end{pmatrix} = A_{cl} \\begin{pmatrix} x \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} -2-k_x  -k_\\eta^\\top \\\\ G  S \\end{pmatrix} \\begin{pmatrix} x \\\\ \\eta \\end{pmatrix}\n$$\n设 $k_\\eta = \\begin{pmatrix} k_{\\eta,1}  k_{\\eta,2}  k_{\\eta,3} \\end{pmatrix}^\\top$。闭环矩阵为：\n$$\nA_{cl} = \\begin{pmatrix} -2 - k_x  -k_{\\eta,1}  -k_{\\eta,2}  -k_{\\eta,3} \\\\ 1  0  0  0 \\\\ 0  0  0  1 \\\\ 1  0  -1  0 \\end{pmatrix}\n$$\n特征多项式为 $P(s) = \\det(sI - A_{cl})$：\n$$\nP(s) = \\det \\begin{pmatrix} s+2+k_x  k_{\\eta,1}  k_{\\eta,2}  k_{\\eta,3} \\\\ -1  s  0  0 \\\\ 0  0  s  -1 \\\\ -1  0  1  s \\end{pmatrix}\n$$\n例如，沿第二行展开行列式，得到：\n$P(s) = 1 \\cdot \\det \\begin{pmatrix} k_{\\eta,1}  k_{\\eta,2}  k_{\\eta,3} \\\\ 0  s  -1 \\\\ 0  1  s \\end{pmatrix} + s \\cdot \\det \\begin{pmatrix} s+2+k_x  k_{\\eta,2}  k_{\\eta,3} \\\\ 0  s  -1 \\\\ -1  1  s \\end{pmatrix}$\n$P(s) = k_{\\eta,1}(s^2+1) + s[(s+2+k_x)(s^2+1) + k_{\\eta,2} + s k_{\\eta,3}]$\n$P(s) = s^4 + (2+k_x)s^3 + (1+k_{\\eta,1}+k_{\\eta,3})s^2 + (2+k_x+k_{\\eta,2})s + k_{\\eta,1}$\n期望的特征多项式是 $P_{des}(s) = (s+1)(s+2)(s+3)(s+4) = s^4 + 10s^3 + 35s^2 + 50s + 24$。\n通过系数匹配：\n$s^0: k_{\\eta,1} = 24$\n$s^3: 2+k_x = 10 \\implies k_x = 8$\n$s^2: 1+k_{\\eta,1}+k_{\\eta,3} = 35 \\implies 1+24+k_{\\eta,3} = 35 \\implies k_{\\eta,3} = 10$\n$s^1: 2+k_x+k_{\\eta,2} = 50 \\implies 2+8+k_{\\eta,2} = 50 \\implies k_{\\eta,2} = 40$\n增益为 $k_x = 8$ 和 $k_\\eta = \\begin{pmatrix} 24  40  10 \\end{pmatrix}^\\top$。\n\n接下来，我们设计观测器增益 $\\ell$。对象状态 $x$ 的观测器由 $\\dot{\\hat{x}} = -2\\hat{x} + u + \\ell(y-\\hat{x})$ 给出。观测器误差为 $\\tilde{x} = x - \\hat{x}$。其动力学为：\n$\\dot{\\tilde{x}} = \\dot{x} - \\dot{\\hat{x}} = (-2x+u+d) - (-2\\hat{x}+u+\\ell(x-\\hat{x})) = -2\\tilde{x} - \\ell\\tilde{x} + d = -(2+\\ell)\\tilde{x} + d$。\n误差动力学齐次部分的特征方程为 $s + (2+\\ell) = 0$。为了将极点置于 $s=-6$，我们设 $2+\\ell = 6$，得到 $\\ell = 4$。\n\n分离原理适用。使用控制律 $u = -k_x\\hat{x} - k_\\eta^\\top\\eta = -k_x(x-\\tilde{x}) - k_\\eta^\\top\\eta$ 的完整闭环系统动力学是稳定的。闭环系统的特征值是控制器特征值 $\\{-1, -2, -3, -4\\}$ 和观测器特征值 $\\{-6\\}$ 的并集。所有特征值都在严格的左半平面。\n\n最后，我们证明调节成立并计算稳态误差 $e_\\infty = \\lim_{t\\to\\infty} e(t)$。内模原理保证了如果闭环系统是稳定的，并且控制器包含了外系统的内模，那么调节误差将收敛到零。我们已经确定闭环系统是稳定的，并且内模是正确的。另一个条件是对于外系统的每个特征值 $\\lambda$，矩阵 $\\begin{pmatrix} A-\\lambda I  B \\\\ C  0 \\end{pmatrix}$ 具有满列秩，其中 $A=-2, B=1, C=1$。\n对于 $\\lambda=0$：$\\det\\begin{pmatrix} -2  1 \\\\ 1  0 \\end{pmatrix} = -1 \\neq 0$。\n对于 $\\lambda=\\pm i$：$\\det\\begin{pmatrix} -2\\mp i  1 \\\\ 1  0 \\end{pmatrix} = -1 \\neq 0$。\n内模原理的所有条件都满足。因此，对于任何常数扰动 $d(t)$ 和任何单位频率的正弦参考 $r(t)$，跟踪误差 $e(t) = y(t) - r(t)$ 必须收敛到零。\n\n为了用直接的稳态论证来证实这一点，我们分析系统对外部输入的响应。闭环系统是线性和稳定的。稳态响应是扰动响应和参考响应之和。\n1. 对于常数扰动 $d(t)=d_0$ 和 $r(t)=0$，我们寻找一个常数稳态解 $(x_{ss}, \\eta_{ss}, \\tilde{x}_{ss})$。将导数设为零：\n    $0 = (-2-k_x)x_{ss} - k_\\eta^\\top \\eta_{ss} + k_x \\tilde{x}_{ss} + d_0$\n    $0 = S\\eta_{ss} + Gx_{ss}$\n    $0 = -(2+\\ell)\\tilde{x}_{ss} + d_0$\n    从第二个方程，$S\\eta_{ss} = -Gx_{ss}$，其分量为 $0 = -x_{ss}$，$\\eta_{ss,3} = 0$，以及 $-\\eta_{ss,2} = -x_{ss}$。这意味着 $x_{ss}=0, \\eta_{ss,2}=0, \\eta_{ss,3}=0$。\n    因为 $y_{ss}=x_{ss}$，所以输出为零，误差 $e_{ss}=y_{ss}-r_{ss}=0-0=0$。扰动被抑制。\n2. 对于正弦参考 $r(t) = \\text{Re}\\{R e^{it}\\}$ 和 $d(t)=0$，我们寻找形式为 $x(t)=\\text{Re}\\{X e^{it}\\}$ 的解。动力学方程变成关于复相量 $(X, \\mathbf{H}, \\tilde{X})$ 的线性方程组。\n    关键方程是内模状态的方程：\n    $(iI-S)\\mathbf{H} = G(X-R)$\n    矩阵 $(iI-S)$ 是奇异的，因为 $i$ 是 $S$ 的一个特征值。为了使解 $\\mathbf{H}$ 存在，向量 $G(X-R)$ 必须位于 $(iI-S)$ 的像空间中，这要求它与 $(iI-S)$ 的左零空间正交。$S$ 对应于特征值 $i$ 的左特征向量是 $v_L = \\begin{pmatrix} 0  1  i \\end{pmatrix}^\\top$。条件是 $v_L^\\top G(X-R) = 0$。\n    $v_L^\\top G = \\begin{pmatrix} 0  1  i \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = i$。\n    条件变为 $i(X-R) = 0$，这意味着 $X=R$。\n    在稳态下，输出 $y_{ss}$（即 $x_{ss}$）的相量等于参考 $r(t)$ 的相量，意味着 $y_{ss}(t) = r(t)$。稳态误差 $e_{ss}(t) = y_{ss}(t) - r(t)$ 恒等于零。\n\n扰动抑制误差和参考跟踪误差都收敛到零。根据线性叠加原理，组合输入的总稳态误差也为零。\n\n因此，精确的稳态调节误差为 $e_\\infty = 0$。", "answer": "$$\\boxed{0}$$", "id": "2752843"}]}