{"hands_on_practices": [{"introduction": "对偶原理揭示了系统控制与状态估计之间深刻的对称性。这意味着，如果您掌握了一种状态反馈控制器的设计方法，对偶原理就能为您提供一个设计状态观测器的直接“配方”。本练习将引导您完成这一精确的转换过程，要求您基于其对偶的控制器设计方法来构建观测器设计流程，并将其应用于一个具体实例中。[@problem_id:2693646]", "problem": "考虑一个线性时不变系统，其状态空间模型由 $\\dot{x} = A x + B u$ 和 $y = C x$ 给出，其中 $A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$，$C \\in \\mathbb{R}^{p \\times n}$。假设 $(A,B)$ 是可控的，且 $(A,C)$ 是可观的。在状态反馈控制问题 $u = -K x$ 中，针对单输入情况，一种设计 $K$ 的标准方法是选择 $K$，使得 $A-BK$ 的特征多项式通过系数匹配与一个期望的首一多项式相匹配，从而根据所选多项式保证闭环稳定性和瞬态性能。\n\n任务：\n1. 应用对偶原理，为状态估计问题 $\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$ 构造观测器增益 $L$ 的对偶估计方法。明确地将估计器增益 $L$ 与一个在适当的对偶系统上使用相同系数匹配原理计算出的状态反馈增益联系起来。\n\n2. 将你的对偶构造方法应用于以下特定系统，并验证其正确性：\n   - 令 $A = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}$，$B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，且 $C = \\begin{bmatrix} 1  0 \\end{bmatrix}$。\n   - 使用基于特征多项式匹配的状态反馈控制器设计方法，将控制器极点配置在 $s = -2$ 和 $s = -5$。\n   - 使用你的对偶估计器设计方法，将观测器误差动态极点配置在 $s = -6$ 和 $s = -7$。\n   - 验证所设计的估计器增益 $L$ 能够得到具有指定极点的观测器误差动态 $\\dot{e} = (A - L C) e$，并且在使用输出反馈律 $u = -K \\hat{x}$ 时，整体闭环增广系统展现出分离结构，其特征值为控制器极点和观测器极点的并集。\n\n将你的最终答案表示为估计器增益 $L$ 的元素排列成的一个单行向量，即，按顺序将 $L$ 的分量写成一个行矩阵。无需四舍五入，不涉及单位。最终答案必须仅为该行向量。", "solution": "该问题提法得当，且基于线性控制理论的基本原理，特别是关于状态空间设计方法。问题是完整、一致的，并且需要应用对偶原理——一个标准且可验证的概念。因此，该问题是有效的，我将着手解答。\n\n解答按要求分为两部分。首先，给出对偶估计方法的理论构造。其次，将此方法应用于给定系统，并验证结果。\n\n**1. 观测器增益的对偶构造**\n\n对于线性时不变系统 $\\dot{x} = A x + B u$ 的状态反馈控制问题，其核心是寻找一个状态反馈增益矩阵 $K$，使得控制律 $u = -K x$ 将闭环系统矩阵 $A - B K$ 的特征值配置在复平面内的期望位置。闭环系统的特征多项式由 $\\det(sI - (A - B K))$ 给出。这种极点配置是可能的，当且仅当系统对 $(A, B)$ 是可控的。\n\n状态估计问题，或称观测器设计，是利用系统输出 $y$ 来构造状态 $x$ 的一个估计 $\\hat{x}$。Luenberger 观测器由动态方程 $\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$ 描述，其中 $L$ 是观测器增益矩阵。状态估计误差定义为 $e = x - \\hat{x}$。该误差的动态可以通过从系统动态中减去观测器动态得到：\n$$ \\dot{e} = \\dot{x} - \\dot{\\hat{x}} = (A x + B u) - (A \\hat{x} + B u + L(C x - C \\hat{x})) = A(x - \\hat{x}) - L C (x - \\hat{x}) = (A - L C)e $$\n观测器设计的目标是选择 $L$，使得误差 $e(t)$ 收敛到零。这可以通过将误差动态矩阵 $A - L C$ 的特征值配置在期望的稳定位置来实现。误差动态的特征多项式为 $\\det(sI - (A - L C))$。这种极点配置是可能的，当且仅当系统对 $(A, C)$ 是可观的。\n\n控制理论中的对偶原理将状态反馈问题与观测器设计问题联系起来。一个矩阵的特征值与其转置矩阵的特征值相同。因此，$A - L C$ 的特征值与 $(A - L C)^T = A^T - C^T L^T$ 的特征值相同。\n\n现在，考虑一个由状态空间对 $(A_{dual}, B_{dual}) = (A^T, C^T)$ 描述的“对偶”系统。对于此对偶系统，状态反馈极点配置问题是寻找一个增益 $K_{dual}$，使得对偶闭环矩阵 $A_{dual} - B_{dual} K_{dual} = A^T - C^T K_{dual}$ 的特征值位于期望的位置。\n\n通过比较观测器误差特征方程的矩阵 $A^T - C^T L^T$ 与对偶控制问题的矩阵 $A^T - C^T K_{dual}$，我们可以建立一个直接的对应关系。如果我们设置观测器增益 $L$ 使得 $L^T = K_{dual}$，那么观测器极点（$A - L C$ 的特征值）将与对偶系统的闭环极点（$A^T - C^T K_{dual}$ 的特征值）相同。\n\n因此，对偶估计方法如下：要找到将 $(A - L C)$ 的特征值配置在一组期望位置 $\\{p_1, \\dots, p_n\\}$ 的观测器增益 $L$，可以求解对偶系统 $(A^T, C^T)$ 的等效状态反馈极点配置问题。即，找到反馈增益 $K_{dual}$，将 $(A^T - C^T K_{dual})$ 的特征值配置在相同的位置 $\\{p_1, \\dots, p_n\\}$。然后，所需的观测器增益由 $L = K_{dual}^T$ 给出。\n\n存在这样一个 $K_{dual}$ 的条件是系统对 $(A^T, C^T)$ 必须是可控的。线性系统的一个基本定理指出，$(A, C)$ 是可观的当且仅当 $(A^T, C^T)$ 是可控的。这证实了对偶原理的一致性。\n\n**2. 应用与验证**\n\n给定系统矩阵如下：\n$$ A = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1  0 \\end{bmatrix} $$\n\n首先，作为一个预备步骤，我们设计状态反馈控制器增益 $K = \\begin{bmatrix} k_1  k_2 \\end{bmatrix}$，将极点配置在 $s = -2$ 和 $s = -5$。期望的特征多项式是 $p_c(s) = (s+2)(s+5) = s^2 + 7s + 10$。\n闭环矩阵为 $A - BK$：\n$$ A - BK = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1  k_2 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ -2 - k_1  -3 - k_2 \\end{bmatrix} $$\n特征多项式为 $\\det(sI - (A-BK)) = s(s+3+k_2) - (-(2+k_1)) = s^2 + (3+k_2)s + (2+k_1)$。\n与 $s^2 + 7s + 10$ 进行系数匹配：\n$3+k_2 = 7 \\implies k_2 = 4$。\n$2+k_1 = 10 \\implies k_1 = 8$。\n所以，控制器增益为 $K = \\begin{bmatrix} 8  4 \\end{bmatrix}$。\n\n接下来，我们使用对偶方法设计观测器增益 $L$。期望的观测器误差极点位于 $s = -6$ 和 $s = -7$。期望的观测器特征多项式是 $p_o(s) = (s+6)(s+7) = s^2 + 13s + 42$。\n我们构建对偶系统 $(A^T, C^T)$:\n$$ A^T = \\begin{bmatrix} 0  -2 \\\\ 1  -3 \\end{bmatrix}, \\quad C^T = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} $$\n我们寻找一个对偶反馈增益 $K_{dual} = \\begin{bmatrix} k_{d1}  k_{d2} \\end{bmatrix}$ 将对偶系统的极点配置在 $s = -6$ 和 $s = -7$。\n对偶闭环矩阵为 $A^T - C^T K_{dual}$:\n$$ A^T - C^T K_{dual} = \\begin{bmatrix} 0  -2 \\\\ 1  -3 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} k_{d1}  k_{d2} \\end{bmatrix} = \\begin{bmatrix} -k_{d1}  -2-k_{d2} \\\\ 1  -3 \\end{bmatrix} $$\n其特征多项式为 $\\det(sI - (A^T-C^T K_{dual})) = (s+k_{d1})(s+3) - (-(2+k_{d2})) = s^2 + (3+k_{d1})s + (3k_{d1} + 2 + k_{d2})$。\n与 $p_o(s) = s^2 + 13s + 42$ 进行系数匹配：\n$s^1$: $3+k_{d1} = 13 \\implies k_{d1} = 10$。\n$s^0$: $3k_{d1} + 2 + k_{d2} = 42 \\implies 3(10) + 2 + k_{d2} = 42 \\implies 32 + k_{d2} = 42 \\implies k_{d2} = 10$。\n对偶增益为 $K_{dual} = \\begin{bmatrix} 10  10 \\end{bmatrix}$。\n观测器增益为 $L = K_{dual}^T = \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix}$。\n\n**验证：**\n我们验证增益 $L$ 能否正确配置观测器极点。误差动态矩阵为 $A-LC$：\n$$ A - LC = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix} - \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix} - \\begin{bmatrix} 10  0 \\\\ 10  0 \\end{bmatrix} = \\begin{bmatrix} -10  1 \\\\ -12  -3 \\end{bmatrix} $$\n特征多项式为 $\\det(sI - (A-LC)) = \\det \\begin{bmatrix} s+10  -1 \\\\ 12  s+3 \\end{bmatrix} = (s+10)(s+3) - (-12) = s^2 + 13s + 30 + 12 = s^2 + 13s + 42$。\n该多项式的根为 $s = -6$ 和 $s = -7$，这正是期望的观测器极点。验证成功。\n\n最后，我们验证组合系统的分离原理，该系统使用基于估计状态的状态反馈 $u = -K\\hat{x}$。由对象状态 $x$ 和估计误差 $e$ 组成的增广系统的状态方程为：\n$$ \\dot{x} = A x + B u = A x - B K \\hat{x} = A x - B K(x - e) = (A - B K)x + B K e $$\n$$ \\dot{e} = (A - L C)e $$\n写成矩阵形式：\n$$ \\frac{d}{dt} \\begin{bmatrix} x \\\\ e \\end{bmatrix} = \\begin{bmatrix} A-BK  BK \\\\ 0  A-LC \\end{bmatrix} \\begin{bmatrix} x \\\\ e \\end{bmatrix} $$\n系统矩阵是分块上三角矩阵。因此，其特征值集合是对角块 $A - BK$ 和 $A - LC$ 的特征值的并集。$A-BK$ 的特征值是控制器极点 $\\{-2, -5\\}$，$A-LC$ 的特征值是观测器极点 $\\{-6, -7\\}$。完整的输出反馈系统的特征值确实是 $\\{-2, -5, -6, -7\\}$。这证实了分离结构。\n\n要求的最终答案是表示为行向量的估计器增益 $L$。我们求得 $L = \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix}$。对应的行向量是 $\\begin{pmatrix} 10  10 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10  10\n\\end{pmatrix}\n}\n$$", "id": "2693646"}, {"introduction": "任意配置观测器极点的能力赋予了我们巨大的设计自由，但它也引出了一个关键问题：这些极点的*最佳*位置在哪里？本练习通过对比两种基本的设计哲学来深入探讨这个问题。您将首先使用极点配置技术来实现指定的确定性响应，然后推导在噪声存在下能最小化估计误差的最优卡尔曼滤波器增益，从而突显在指定性能和随机最优性之间的权衡。[@problem_id:2748160]", "problem": "考虑一个连续时间线性时不变系统，其状态空间矩阵为 $A \\in \\mathbb{R}^{n \\times n}$ 和 $C \\in \\mathbb{R}^{m \\times n}$。在静态输出注入增益 $L \\in \\mathbb{R}^{n \\times m}$ 的作用下，状态观测器的误差动态由矩阵 $A - L C$ 决定。\n\n第 1 部分。仅从可观测性和可控性的定义以及 Popov–Belevitch–Hautus 检验出发，推导为什么对于任意可观测对 $(A,C)$ 和任意根严格位于开左半平面的首一多项式 $p(\\lambda) = \\lambda^{n} + \\alpha_{n-1} \\lambda^{n-1} + \\cdots + \\alpha_{1} \\lambda + \\alpha_{0}$，都存在一个输出注入矩阵 $L$，使得 $A - L C$ 的特征多项式等于 $p(\\lambda)$。您的推导必须从第一性原理和基本定义出发，不得引用现成的公式。\n\n第 2 部分。考虑一个特定的二阶系统，其矩阵为\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n选择 $A - L C$ 的期望特征值为 $\\lambda_{1} = -2$ 和 $\\lambda_{2} = -5$。通过直接计算 $A - L C$ 的特征多项式并进行系数匹配，明确确定实现这些特征值的 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$ 的元素。\n\n第 3 部分。对于第 2 部分中的同一系统，考虑随机状态空间模型\n$$\n\\dot{x}(t) = A x(t) + w(t), \\quad y(t) = C x(t) + v(t),\n$$\n其中 $w(t)$ 为零均值白高斯过程噪声，$v(t)$ 为测量噪声，两者相互独立，其协方差分别为 $\\mathbb{E}[w(t) w(\\tau)^{\\top}] = Q \\delta(t - \\tau)$ 和 $\\mathbb{E}[v(t) v(\\tau)] = R \\delta(t - \\tau)$，其中\n$$\nQ = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad R = 1.\n$$\n通过求解误差协方差 $P \\in \\mathbb{R}^{2 \\times 2}$ 的连续时间代数 Riccati 方程，计算稳态卡尔曼滤波器增益 $L_{\\mathrm{KF}} \\in \\mathbb{R}^{2 \\times 1}$，并计算 $L_{\\mathrm{KF}} = P C^{\\top} R^{-1}$。然后，用文字对比第 2 部分中的特征值配置增益与此处推导的稳态卡尔曼增益在概念基础上的差异。\n\n答案格式要求：将最终答案以包含四个元素 $\\ell_{1}$、$\\ell_{2}$、$k_{1}$、$k_{2}$ 的行矩阵形式报告，其中 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$ 是第 2 部分的特征值配置增益，$L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$ 是第 3 部分的卡尔曼增益。提供精确值，不要四舍五入。", "solution": "该问题已经过验证，被认为是适定的、科学上合理的且内部一致的。这是线性系统理论和最优估计中的一个标准问题。我们将开始解答。\n\n第 1 部分：观测器极点配置的推导\n目标是证明对于一个可观测对 $(A,C)$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 和 $C \\in \\mathbb{R}^{m \\times n}$，总是可以找到一个输出注入增益 $L \\in \\mathbb{R}^{n \\times m}$，使得观测器误差动态矩阵 $A-LC$ 的特征多项式与任意指定的 $n$ 次首一多项式 $p(\\lambda)$ 相匹配。这一性质被称为观测器的极点配置或极点分配。推导将依赖于控制理论中的对偶原理。\n\n观测器的极点是矩阵 $A-LC$ 的特征值。$A-LC$ 的特征多项式由 $\\det(\\lambda I - (A-LC))$ 给出。行列式的一个基本性质是，对于任意方阵 $M$，$\\det(M) = \\det(M^{\\top})$。因此，$A-LC$ 的特征值与其转置 $(A-LC)^{\\top} = A^{\\top} - C^{\\top}L^{\\top}$ 的特征值相同。\n\n让我们定义一个“对偶”系统。对于由矩阵 $(A, C)$ 控制的原系统，我们定义一个对偶系统，其状态矩阵为 $A' = A^{\\top}$，输入矩阵为 $B' = C^{\\top}$。我们还为该对偶系统定义一个状态反馈增益 $K' = L^{\\top}$。在该状态反馈下，此对偶系统的闭环矩阵为 $A' - B'K' = A^{\\top} - C^{\\top}L^{\\top}$。\n\n从这个构造中可以明显看出，寻找一个观测器增益 $L$ 以将 $A-LC$ 的特征值配置在期望位置的问题，在数学上等价于寻找一个状态反馈增益 $K' = L^{\\top}$ 以将 $A^{\\top} - C^{\\top}L^{\\top}$ 的特征值配置在相同位置的问题。后者是系统 $(A', B') = (A^{\\top}, C^{\\top})$ 的标准状态反馈极点配置问题。\n\n控制理论的一个基石定理指出，当且仅当系统是可控的，通过状态反馈进行任意极点配置才是可能的。因此，如果我们能证明对偶系统 $(A^{\\top}, C^{\\top})$ 是可控的，那么我们总能找到一个增益 $K'$（从而得到一个 $L$）来实现任何期望的特征多项式。原系统的可观测性与对偶系统的可控性之间的联系是通过 Popov–Belevitch–Hautus (PBH) 检验建立的。\n\nPBH 可观测性检验指出，当且仅当对于所有复数 $\\lambda \\in \\mathbb{C}$，矩阵\n$$\n\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}\n$$\n具有满列秩 $n$ 时，对 $(A, C)$ 是可观测的。\n\n问题陈述假设对 $(A,C)$ 是可观测的。因此，对于任意 $\\lambda \\in \\mathbb{C}$，\n$$\n\\mathrm{rank} \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} = n.\n$$\n由于一个矩阵的秩等于其转置的秩，我们有\n$$\n\\mathrm{rank} \\left( \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}^{\\top} \\right) = \\mathrm{rank} \\begin{pmatrix} (A - \\lambda I)^{\\top}  C^{\\top} \\end{pmatrix} = \\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I  C^{\\top} \\end{pmatrix} = n.\n$$\n这最后一个条件，即对于所有 $\\lambda \\in \\mathbb{C}$，$\\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I  C^{\\top} \\end{pmatrix} = n$，正是对 $(A^{\\top}, C^{\\top})$ 的 PBH 可控性检验。\n\n因此，如果对 $(A,C)$ 是可观测的，那么对 $(A^{\\top}, C^{\\top})$ 就是可控的。根据状态反馈极点配置定理，对于一个可控系统，可以找到一个增益矩阵 $K'$，将闭环系统 $A^{\\top}-C^{\\top}K'$ 的特征值分配到任何期望的位置集合。这些位置就是指定的首一多项式 $p(\\lambda)$ 的根。通过令 $K'=L^{\\top}$，我们找到了观测器增益 $L$，它将观测器动态矩阵 $A-LC$ 的极点配置在这些相同的位置。要求 $p(\\lambda)$ 的根位于开左半平面，确保了观测器的稳定性，这是实际的目标。推导至此完成。\n\n第 2 部分：特征值配置增益的计算\n我们给定的系统矩阵为\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n输出注入增益为 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$。矩阵 $A-LC$ 计算如下：\n$$\nA - LC = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1}  0 \\\\ \\ell_{2}  0 \\end{pmatrix} = \\begin{pmatrix} -\\ell_{1}  1 \\\\ -\\ell_{2}  0 \\end{pmatrix}.\n$$\n$A-LC$ 的特征多项式为\n$$\n\\det(\\lambda I - (A-LC)) = \\det \\begin{pmatrix} \\lambda + \\ell_{1}  -1 \\\\ \\ell_{2}  \\lambda \\end{pmatrix} = \\lambda(\\lambda + \\ell_{1}) - (-1)(\\ell_{2}) = \\lambda^{2} + \\ell_{1}\\lambda + \\ell_{2}.\n$$\n期望的特征值为 $\\lambda_{1} = -2$ 和 $\\lambda_{2} = -5$。期望的特征多项式为\n$$\np(\\lambda) = (\\lambda - \\lambda_{1})(\\lambda - \\lambda_{2}) = (\\lambda + 2)(\\lambda + 5) = \\lambda^{2} + 7\\lambda + 10.\n$$\n通过匹配计算出的特征多项式和期望的特征多项式的系数，我们得到：\n$$\n\\ell_{1} = 7, \\quad \\ell_{2} = 10.\n$$\n因此，所需的增益矩阵为 $L = \\begin{pmatrix} 7 \\\\ 10 \\end{pmatrix}$。\n\n第 3 部分：稳态卡尔曼增益的计算与概念对比\n我们已知过程噪声和测量噪声的协方差强度为 $Q=I$ 和 $R=1$。稳态卡尔曼滤波器增益 $L_{\\mathrm{KF}}$ 由 $L_{\\mathrm{KF}} = PC^{\\top}R^{-1}$ 给出，其中 $P$ 是连续时间代数 Riccati 方程 (CARE) 的对称正定解：\n$$\nAP + PA^{\\top} - PC^{\\top}R^{-1}CP + Q = 0.\n$$\n设 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$。代入给定的矩阵 $A, C, Q, R$：\n$$\n\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} - \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n计算每一项：\n$$\n\\begin{pmatrix} p_{12}  p_{22} \\\\ 0  0 \\end{pmatrix} + \\begin{pmatrix} p_{12}  0 \\\\ p_{22}  0 \\end{pmatrix} - \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 2p_{12}  p_{22} \\\\ p_{22}  0 \\end{pmatrix} - \\begin{pmatrix} p_{11}^{2}  p_{11}p_{12} \\\\ p_{11}p_{12}  p_{12}^{2} \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n这个矩阵方程产生了一个关于 $P$ 的元素的代数方程组：\n1. $2p_{12} - p_{11}^{2} + 1 = 0$\n2. $p_{22} - p_{11}p_{12} = 0$\n3. $-p_{12}^{2} + 1 = 0$\n\n从方程（3）中，我们发现 $p_{12}^{2} = 1$，这给出 $p_{12} = \\pm 1$。为了保证稳定性，卡尔曼滤波器误差动态矩阵 $A - L_{\\mathrm{KF}}C = \\begin{pmatrix} -p_{11}  1 \\\\ -p_{12}  0 \\end{pmatrix}$ 的特征值必须位于开左半平面。其特征多项式为 $\\lambda^{2} + p_{11}\\lambda + p_{12} = 0$。对于稳定根，Routh-Hurwitz 稳定性判据要求所有系数为正。因此，我们必须有 $p_{11} > 0$ 和 $p_{12} > 0$。所以我们必须选择 $p_{12} = 1$。\n\n将 $p_{12}=1$ 代入方程（1）：\n$$\n2(1) - p_{11}^{2} + 1 = 0 \\implies p_{11}^{2} = 3.\n$$\n由于我们要求 $p_{11} > 0$，所以 $p_{11} = \\sqrt{3}$。\n\n将 $p_{11}=\\sqrt{3}$ 和 $p_{12}=1$ 代入方程（2）：\n$$\np_{22} - (\\sqrt{3})(1) = 0 \\implies p_{22} = \\sqrt{3}.\n$$\n稳态误差协方差是 $P = \\begin{pmatrix} \\sqrt{3}  1 \\\\ 1  \\sqrt{3} \\end{pmatrix}$。我们验证该矩阵是正定的：$p_{11}=\\sqrt{3} > 0$ 且 $\\det(P) = (\\sqrt{3})(\\sqrt{3}) - 1^{2} = 3-1=2>0$。\n\n那么稳态卡尔曼增益 $L_{\\mathrm{KF}}$ 为：\n$$\nL_{\\mathrm{KF}} = PC^{\\top}R^{-1} = \\begin{pmatrix} \\sqrt{3}  1 \\\\ 1  \\sqrt{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) = \\begin{pmatrix} \\sqrt{3} \\\\ 1 \\end{pmatrix}.\n$$\n设 $L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$，我们有 $k_{1} = \\sqrt{3}$ 和 $k_{2} = 1$。\n\n概念对比：\n第 2 部分中的特征值配置增益 $L$ 是确定性地选择的，以实现任意的、用户指定的观测器误差动态响应。极点的选择（此处为 $-2$ 和 $-5$）由设计规范（如期望的镇定时间或阻尼）决定，但在其他方面是任意的。这种方法完全忽略了系统的任何随机方面，例如过程噪声或测量噪声。\n\n与此形成鲜明对比的是，第 3 部分的稳态卡尔曼增益 $L_{\\mathrm{KF}}$ 不是任意的。它是作为最小化状态估计误差方差的最优增益而被唯一确定的，其依据是系统的统计特性，即过程噪声协方差 $Q$ 和测量噪声协方差 $R$。所得的观测器极点不是由设计者直接指定的，而是这种优化的结果。卡尔曼滤波器通过系统地平衡对系统模型的置信度与对测量值的置信度，提供了均方意义下的最佳估计。极点配置方法强制实现一种期望的行为，而卡尔曼滤波器则从系统潜在的随机现实中推导出一种最优行为。", "answer": "$$\n\\boxed{\\begin{pmatrix} 7  10  \\sqrt{3}  1 \\end{pmatrix}}\n$$", "id": "2748160"}, {"introduction": "对已经测量的状态进行估计是低效的。本练习将超越标准的全阶观测器，转向设计一种更实用的降维观测器，它只估计未被测量的状态。这项练习将挑战您从第一性原理出发推导观测器动态，并证明强大的对偶原理同样可以优雅地扩展到这些更高级、更高效的估计结构中。[@problem_id:2703165]", "problem": "考虑一个单输入单输出线性时不变系统，其状态空间模型为\n$$\n\\dot{x} = A x + b u,\\qquad y = c^{\\top} x,\n$$\n其中\n$$\nA = \\begin{pmatrix}\n2  1  0\\\\\n0  3  1\\\\\n0  0  4\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix},\\quad\nc = \\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}.\n$$\n假设测量输出的时间导数 $\\dot{y}$ 可用且无噪声。您将设计一个最小阶（2阶）观测器，利用测量输出和已知输入来重构未测量的状态分量。\n\n从基本的状态方程和状态估计的定义出发，不要调用任何现成的观测器设计公式。按以下步骤进行：(i) 根据已测量和未测量的分量对状态进行划分，(ii) 推导使用 $y$、$\\dot{y}$ 和 $u$ 的降阶观测器动力学，以及 (iii) 显式地获得观测器误差动力学。所期望的观测器误差特征多项式为\n$$\np_{\\text{des}}(s) = s^{2} + s + 1.\n$$\n设 $L \\in \\mathbb{R}^{2 \\times 1}$ 表示您推导的降阶观测器动力学中出现的注入增益。用 $\\alpha$ 表示 $L$ 的第一个分量。\n\n通过援引状态估计和状态反馈之间的对偶性，解释为什么同一个标量 $\\alpha$ 也决定了对偶降阶控制器的增益的第一个分量，该控制器为输入通道与 $c$ 对齐的转置系统配置了相同的内部特征多项式。不要数值计算对偶控制器的增益；仅使用对偶性来证明第一个分量的对应关系。\n\n$\\alpha$ 的精确值是多少？请以精确数值形式提供答案，无需四舍五入。", "solution": "对问题陈述进行验证。\n\n已知条件：\n一个线性时不变系统由状态空间模型描述\n$$\n\\dot{x} = Ax + bu, \\qquad y = c^{\\top}x\n$$\n其矩阵为\n$$\nA = \\begin{pmatrix}\n2  1  0\\\\\n0  3  1\\\\\n0  0  4\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix},\\quad\nc = \\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}.\n$$\n状态向量为 $x \\in \\mathbb{R}^3$。输入 $u$ 和输出 $y$ 是标量。输出的时间导数 $\\dot{y}$ 是可用的。需要设计一个2阶的最小阶观测器。所期望的观测器误差动力学特征多项式为 $p_{\\text{des}}(s) = s^{2} + s + 1$。观测器增益为 $L \\in \\mathbb{R}^{2 \\times 1}$，其第一个分量用 $\\alpha$ 表示。\n\n验证：\n该问题在控制理论领域有科学依据，特别涉及状态估计和对偶原理。该系统是三阶（$n=3$）单输出（$p=1$）系统，其最小阶观测器的阶数应为 $n-p = 2$。给定的矩阵定义了一个既能控又能观的系统，这分别是设计状态反馈控制器和状态观测器的必要条件。系统参数已完全指定。目标陈述清晰。$\\dot{y}$ 可用的假设是一个明确的条件，而不是一个缺陷，并且是设计某些类型观测器的标准出发点。该问题是自洽的、一致的且适定的。该问题被认为是有效的。\n\n解：\n系统输出为 $y = c^\\top x = x_1$。由于 $y$ 是可测量的，因此状态 $x_1$ 是已知的。未测量的状态是 $x_2$ 和 $x_3$。我们将状态向量划分为 $x = \\begin{pmatrix} x_1 \\\\ x_u \\end{pmatrix}$，其中 $x_1$ 是已测量的分量，$x_u = \\begin{pmatrix} x_2 \\\\ x_3 \\end{pmatrix}$ 是未测量分量的向量。\n\n我们相应地划分系统矩阵 $A$ 和 $b$：\n$$\n\\dot{x} =\n\\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_u \\end{pmatrix}\n=\n\\begin{pmatrix} A_{11}  A_{12} \\\\ A_{21}  A_{22} \\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_u \\end{pmatrix}\n+\n\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}\nu\n$$\n从给定的矩阵中，我们识别出以下分块：\n$$\nA_{11} = 2, \\quad A_{12} = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n$$\nA_{21} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\quad A_{22} = \\begin{pmatrix} 3  1 \\\\ 0  4 \\end{pmatrix}\n$$\n$$\nb_1 = 0, \\quad b_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\n分块形式的状态方程为：\n$$\n\\dot{x}_1 = A_{11} x_1 + A_{12} x_u + b_1 u = 2x_1 + x_2\n$$\n$$\n\\dot{x}_u = A_{21} x_1 + A_{22} x_u + b_2 u = A_{22} x_u + b_2 u\n$$\n未测量状态 $x_u$ 的动力学由 $x_u$ 自身和已知输入 $u$ 驱动。为了估计 $x_u$，我们需要该子系统的一个“输出”。第一个方程可以重新整理为：\n$$\nA_{12} x_u = \\dot{x}_1 - A_{11} x_1 - b_1 u\n$$\n由于 $y = x_1$，我们有 $\\dot{y} = \\dot{x}_1$。问题陈述中指出 $\\dot{y}$ 是可用的。因此，我们可以为未测量子系统构造一个伪输出 $y_u$：\n$$\ny_u = \\dot{y} - A_{11} y - b_1 u = \\dot{y} - 2y\n$$\n这个信号 $y_u$ 通过 $y_u = A_{12} x_u$ 与未测量状态相关联。令 $C_u = A_{12} = \\begin{pmatrix} 1  0 \\end{pmatrix}$。\n\n我们现在为由以下方程描述的子系统设计一个 Luenberger 观测器：\n$$\n\\dot{x}_u = A_{22} x_u + b_2 u, \\quad y_u = C_u x_u\n$$\n设 $\\hat{x}_u$ 是 $x_u$ 的估计值。降阶观测器的动力学由下式给出：\n$$\n\\dot{\\hat{x}}_u = A_{22} \\hat{x}_u + b_2 u + L(y_u - \\hat{y}_u)\n$$\n其中 $\\hat{y}_u = C_u \\hat{x}_u$ 且 $L \\in \\mathbb{R}^{2 \\times 1}$ 是观测器注入增益。该观测器按要求使用了信号 $y$、$\\dot{y}$（通过 $y_u$）和 $u$。\n\n估计误差为 $e_u = x_u - \\hat{x}_u$。其动力学推导如下：\n$$\n\\dot{e}_u = \\dot{x}_u - \\dot{\\hat{x}}_u = (A_{22} x_u + b_2 u) - (A_{22} \\hat{x}_u + b_2 u + L(y_u - C_u \\hat{x}_u))\n$$\n$$\n\\dot{e}_u = A_{22}(x_u - \\hat{x}_u) - L(C_u x_u - C_u \\hat{x}_u) = A_{22}e_u - L C_u e_u = (A_{22} - L C_u)e_u\n$$\n观测器的稳定性由矩阵 $A_{obs} = A_{22} - L C_u$ 的特征值决定。误差动力学的特征多项式是 $\\det(sI - A_{obs})$。\n设 $L = \\begin{pmatrix} \\alpha \\\\ l_2 \\end{pmatrix}$。那么\n$$\nLC_u = \\begin{pmatrix} \\alpha \\\\ l_2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} \\alpha  0 \\\\ l_2  0 \\end{pmatrix}\n$$\n$$\nA_{obs} = A_{22} - LC_u = \\begin{pmatrix} 3  1 \\\\ 0  4 \\end{pmatrix} - \\begin{pmatrix} \\alpha  0 \\\\ l_2  0 \\end{pmatrix} = \\begin{pmatrix} 3-\\alpha  1 \\\\ -l_2  4 \\end{pmatrix}\n$$\n特征多项式为：\n$$\np(s) = \\det \\begin{pmatrix} s-(3-\\alpha)  -1 \\\\ l_2  s-4 \\end{pmatrix} = (s-3+\\alpha)(s-4) + l_2\n$$\n$$\np(s) = s^2 - 4s - 3s + 12 + \\alpha s - 4\\alpha + l_2 = s^2 + (\\alpha-7)s + (12-4\\alpha+l_2)\n$$\n这必须等于期望的多项式 $p_{\\text{des}}(s) = s^2+s+1$。通过比较系数：\n1.  $s$ 的系数：$\\alpha - 7 = 1 \\implies \\alpha = 8$。\n2.  常数项：$12 - 4\\alpha + l_2 = 1 \\implies 12 - 4(8) + l_2 = 1 \\implies 12 - 32 + l_2 = 1 \\implies -20 + l_2 = 1 \\implies l_2 = 21$。\n观测器增益为 $L = \\begin{pmatrix} 8 \\\\ 21 \\end{pmatrix}$。第一个分量是 $\\alpha = 8$。\n\n现在，我们来讨论对偶性方面。LTI系统中的对偶原理将一个系统 $(A, C)$ 的状态估计问题（观测器设计）与对偶系统 $(A^\\top, C^\\top)$ 的状态反馈控制问题联系起来。\n降阶观测器的设计涉及配置矩阵 $A_{22} - L C_u$ 的特征值。相关的系统对是 $(A_{22}, C_u)$。\n对偶控制问题对应于动力学矩阵为 $A_{22}^\\top$、输入矩阵为 $C_u^\\top$ 的系统。设此对偶子系统为 $\\dot{\\zeta} = A_{22}^\\top \\zeta + C_u^\\top v_{sub}$。该系统的状态反馈控制器形式为 $v_{sub} = -K_{dual}^\\top \\zeta$，从而得到闭环矩阵 $A_{22}^\\top - C_u^\\top K_{dual}^\\top$。\n\n问题中提到了“转置系统的对偶降阶控制器”。转置系统为 $\\dot{z} = A^\\top z + c v$。我们对 $z$ 进行与 $x$ 对偶的划分，即 $z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix}$，其中 $z_1$ 是标量，$z_2 \\in \\mathbb{R}^2$。划分后的对偶动力学方程为：\n$$\n\\begin{pmatrix} \\dot{z}_1 \\\\ \\dot{z}_2 \\end{pmatrix} = \\begin{pmatrix} A_{11}^\\top  A_{21}^\\top \\\\ A_{12}^\\top  A_{22}^\\top \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} + \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} v\n$$\n当 $A_{21}^\\top = \\begin{pmatrix} 0  0 \\end{pmatrix}$，$c_1 = 1$ 且 $c_2 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 时，方程变为：\n$$\n\\dot{z}_1 = A_{11}^\\top z_1 + c_1 v = 2z_1 + v\n$$\n$$\n\\dot{z}_2 = A_{12}^\\top z_1 + A_{22}^\\top z_2\n$$\n这种结构代表一个级联系统，其中 $z_2$ 的动力学由 $z_1$ 驱动。系统对 $(A_{22}^\\top, A_{12}^\\top)$ 是能控的，因为它的对偶，即系统对 $(A_{22}, A_{12}) = (A_{22}, C_u)$，是能观的（这是设计观测器的先决条件）。“降阶控制器”可以解释为通过将 $z_1$ 视为控制输入来为 $z_2$ 子系统设计反馈律。具体来说，我们可以通过将 $z_1$ 设置为 $z_2$ 的线性函数来稳定 $z_2$ 子系统：$z_1 = -K_2^\\top z_2$。这得到了该子系统的闭环动力学：\n$$\n\\dot{z}_2 = (A_{22}^\\top - A_{12}^\\top K_2^\\top)z_2\n$$\n该子系统的特征值是其特征多项式 $\\det(sI - (A_{22}^\\top - A_{12}^\\top K_2^\\top))$ 的根。\n观测器误差动力学的特征多项式是 $\\det(sI - (A_{22} - L C_u))$。\n使用性质 $\\det(M) = \\det(M^\\top)$，观测器的多项式可以写为：\n$$\n\\det(sI - (A_{22} - L C_u)) = \\det((sI - (A_{22} - L C_u))^\\top) = \\det(sI - (A_{22}^\\top - C_u^\\top L^\\top))\n$$\n我们有 $C_u = A_{12}$。为了使对偶控制器的内部特征多项式与观测器误差特征多项式相同，我们必须有：\n$$\n\\det(sI - (A_{22}^\\top - A_{12}^\\top K_2^\\top)) = \\det(sI - (A_{22}^\\top - A_{12}^\\top L^\\top))\n$$\n如果我们选择控制器增益 $K_2$ 等于观测器增益 $L$，则此等式成立。因此，$K_2=L$。\n观测器增益 $L$ 的第一个分量是 $\\alpha$。因此，对偶控制器增益 $K_2$ 的第一个分量也必须是 $\\alpha$。这种对应关系是对偶原理的直接结果，无需数值计算 $K_2$。\n\n$\\alpha$ 的值先前已计算为 $8$。", "answer": "$$\n\\boxed{8}\n$$", "id": "2703165"}]}