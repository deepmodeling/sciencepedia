{"hands_on_practices": [{"introduction": "理论学习的最佳起点往往是一个可以完全解析的简单模型。这个练习将引导你分析一个标量非线性系统，通过基本原理精确地确定其所有平衡点各自的吸引域。通过这个过程，你将加深对平衡点、稳定性以及吸引域边界这些基本概念的理解。[@problem_id:2738256]", "problem": "考虑定义在 $\\mathbb{R}$ 上的标量自治非线性系统，其常微分方程为 $\\dot{x}=x-x^{3}$。从动力系统与控制的第一性原理出发，完成以下任务：找出所有平衡点，使用线性化方法对其局部稳定性进行分类，然后仅使用不变性、Lipschitz 向量场解的唯一性以及源于第一性原理的李雅普诺夫论证等基础工具，严格证明每个平衡点的全局吸引域。明确描述吸引盆的边界，并解释为何不存在其他边界。最后，确定每个平衡点的吸引域 (ROA) 作为 $\\mathbb{R}$ 的子集。最后，报告平衡点 $x^{\\star}=1$ 的吸引域与区间 $[-2,2]$ 的交集的勒贝格测度作为你的最终答案。将最终答案表示为一个实数。要求提供精确值，无需四舍五入。", "solution": "本题要求对定义在 $\\mathbb{R}$ 上的标量自治系统进行完整分析，该系统由常微分方程 $\\dot{x} = f(x) = x - x^{3}$ 给出。此分析将从第一性原理出发，首先辨识和分类平衡点，然后严格确定它们各自的吸引域，最终计算一个指定的勒贝格测度。\n\n首先，我们通过求解方程 $\\dot{x} = 0$ 来辨识系统的平衡点。\n$$x - x^{3} = 0$$\n$$x(1 - x^{2}) = 0$$\n$$x(1 - x)(1 + x) = 0$$\n这得到了三个不同的平衡点：$x_{1}^{\\star} = -1$，$x_{2}^{\\star} = 0$ 和 $x_{3}^{\\star} = 1$。\n\n接下来，我们通过线性化来研究每个平衡点的局部稳定性。向量场为 $f(x) = x - x^{3}$。这个一维系统的雅可比矩阵是 $f(x)$ 关于 $x$ 的导数：\n$$J(x) = \\frac{df}{dx} = 1 - 3x^{2}$$\n根据 Hartman-Grobman 定理，双曲平衡点（其特征值的实部非零）的稳定性由在该点计算的雅可比矩阵的特征值的符号决定。\n- 对于平衡点 $x_{1}^{\\star} = -1$：\n$$J(-1) = 1 - 3(-1)^{2} = 1 - 3 = -2$$\n由于特征值 $\\lambda = -2  0$，位于 $x^{\\star} = -1$ 的平衡点是局部渐近稳定的（一个汇点）。\n- 对于平衡点 $x_{2}^{\\star} = 0$：\n$$J(0) = 1 - 3(0)^{2} = 1$$\n由于特征值 $\\lambda = 1 > 0$，位于 $x^{\\star} = 0$ 的平衡点是不稳定的（一个源点）。\n- 对于平衡点 $x_{3}^{\\star} = 1$：\n$$J(1) = 1 - 3(1)^{2} = 1 - 3 = -2$$\n由于特征值 $\\lambda = -2  0$，位于 $x^{\\star} = 1$ 的平衡点是局部渐近稳定的（一个汇点）。\n\n我们现在进行全局分析以确定吸引域。向量场 $f(x) = x - x^{3}$ 是一个多项式，因此在 $\\mathbb{R}$ 上是连续可微的（$C^{\\infty}$）。这确保了 $f(x)$ 在 $\\mathbb{R}$ 的任何紧区间上都是局部利普希茨的，根据 Picard-Lindelöf 定理，这保证了对于任何给定的初始条件 $x(0) = x_{0}$，解都存在且唯一。\n\n通过检查由平衡点定义的区间上 $\\dot{x} = x(1-x)(1+x)$ 的符号，可以定性地理解轨迹的行为：\n- 对于 $x \\in (1, \\infty)$，我们测试 $x=2$：$\\dot{x} = 2(1-2)(1+2) = -6  0$。轨迹向左移动，朝向 $x=1$。\n- 对于 $x \\in (0, 1)$，我们测试 $x=0.5$：$\\dot{x} = 0.5(1-0.5)(1+0.5) > 0$。轨迹向右移动，朝向 $x=1$。\n- 对于 $x \\in (-1, 0)$，我们测试 $x=-0.5$：$\\dot{x} = -0.5(1-(-0.5))(1+(-0.5))  0$。轨迹向左移动，朝向 $x=-1$。\n- 对于 $x \\in (-\\infty, -1)$，我们测试 $x=-2$：$\\dot{x} = -2(1-(-2))(1+(-2)) > 0$。轨迹向右移动，朝向 $x=-1$。\n\n这种相线分析表明，$x^{\\star}=1$ 的吸引域是 $(0, \\infty)$，$x^{\\star}=-1$ 的吸引域是 $(-\\infty, 0)$，而点 $x^{\\star}=0$ 是分隔这两个吸引盆的边界。\n\n我们必须严格证明这些结论。\n令 $A(x^{\\star})$ 表示平衡点 $x^{\\star}$ 的吸引域（或吸引盆）。\n对于平衡点 $x^{\\star}=1$：\n设初始条件 $x(0) = x_{0} \\in (0, 1)$。由于在此区间内 $\\dot{x} > 0$，解 $x(t)$ 是时间的单调递增函数。由于 $x=1$ 是一个平衡点，解的唯一性阻止 $x(t)$ 穿过 $1$。因此，$x(t)$ 是一个有上界 $1$ 的单调递增函数。根据单调收敛定理，极限 $\\lim_{t \\to \\infty} x(t)$ 必定存在，并且必定是一个平衡点。在区间 $(0, 1]$ 内唯一的平衡点是 $x=1$。因此，$\\lim_{t \\to \\infty} x(t) = 1$。\n现在，设 $x(0) = x_{0} \\in (1, \\infty)$。由于在此区间内 $\\dot{x}  0$，解 $x(t)$ 是单调递减的，且有下界 $1$。通过类似的论证，$\\lim_{t \\to \\infty} x(t) = 1$。\n显然，如果 $x(0)=1$，那么对于所有 $t \\geq 0$ 都有 $x(t)=1$。\n综合这些情况，我们严格地确定了 $x^{\\star}=1$ 的吸引域是 $A(1) = (0, \\infty)$。\n\n对于平衡点 $x^{\\star}=-1$：\n向量场 $f(x)=x-x^3$ 是一个奇函数，即 $f(-x)=-f(x)$。这意味着如果 $x(t)$ 是 $\\dot{x}=f(x)$ 的一个解，那么 $y(t) = -x(t)$ 也是一个解，因为 $\\dot{y}(t) = -\\dot{x}(t) = -f(x(t)) = -f(-y(t)) = f(y(t))$。因此，相图关于原点对称。$x^{\\star}=-1$ 的吸引域必定是 $x^{\\star}=1$ 吸引域的负集。因此，$A(-1) = (-\\infty, 0)$。\n\n对于平衡点 $x^{\\star}=0$：\n这是一个不稳定的平衡点。任何不等于 $0$ 的初始条件 $x_{0}$，无论多接近 $0$，都会产生一条远离 $0$ 并收敛到 $1$ 或 $-1$ 的轨迹。因此，$x^{\\star}=0$ 的吸引域只包含该点本身：$A(0) = \\{0\\}$。\n\n吸引盆的边界是吸引域之间的界面。状态空间 $\\mathbb{R}$ 被划分为三个不相交的集合：$A(-1) = (-\\infty, 0)$，$A(0) = \\{0\\}$ 和 $A(1) = (0, \\infty)$。$A(1)$ 的边界是 $\\partial A(1) = \\{0\\}$，$A(-1)$ 的边界是 $\\partial A(-1) = \\{0\\}$。点 $x=0$ 是一个不稳定的平衡点，它的稳定流形（在这个标量情况下就是该点本身）构成了两个稳定平衡点吸引盆之间的边界。由于对于任何大的 $|x|$，都有 $\\dot{x} \\approx -x^3$，这会将轨迹推向原点，所以没有轨迹可以逃逸到无穷远。因此，$\\mathbb{R}$ 中的每一点都必须收敛到三个平衡点之一。这个划分是完整的，不存在其他边界。\n\n最后，我们被要求计算平衡点 $x^{\\star}=1$ 的吸引域与区间 $[-2, 2]$ 的交集的勒贝格测度。\n$x^{\\star}=1$ 的吸引域是 $A(1) = (0, \\infty)$。\n区间是 $I = [-2, 2]$。\n这两个集合的交集是：\n$$S = A(1) \\cap I = (0, \\infty) \\cap [-2, 2] = (0, 2]$$\n区间 $(a, b]$ 的勒贝格测度 $\\mu$ 由 $b-a$ 给出。\n因此，交集的测度是：\n$$\\mu(S) = \\mu((0, 2]) = 2 - 0 = 2$$\n最终答案是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2738256"}, {"introduction": "对于高维系统，精确求解吸引域通常是不可能的，因此我们转而寻找其内估计。本练习将介绍一种核心的分析技术，即李雅普诺夫直接法与拉萨尔不变性原理的结合，来为一个二维系统寻找一个经过验证的吸引域子集。这个方法是现代非线性控制理论中估计稳定区域的基石。[@problem_id:2738234]", "problem": "考虑$\\mathbb{R}^{2}$中的非线性系统 $\\dot{x}_{1}=-x_{1}+x_{1}x_{2}$ 和 $\\dot{x}_{2}=-x_{2}$，该系统在原点有一个平衡点。令 $V(x)=x_{1}^{2}+x_{2}^{2}$，对于 $c>0$，定义闭子水平集 $\\Omega_{c}=\\{x\\in\\mathbb{R}^{2}:V(x)\\leq c\\}$。仅使用李雅普诺夫稳定性的基本原理和拉萨尔不变性原理，确定最大的实数 $c^{\\star}>0$，使得以下两个性质都成立：\n1) 对于所有保持在 $\\Omega_{c^{\\star}}$ 内的轨迹，$V$ 是非增的，并且 $\\Omega_{c^{\\star}}$ 在系统动力学下是正不变的。\n2) $\\{x\\in\\Omega_{c^{\\star}}:\\dot{V}(x)=0\\}$ 的最大不变子集是 $\\{0\\}$，因此从 $\\Omega_{c^{\\star}}$ 开始的每条轨迹都收敛到原点，从而 $\\Omega_{c^{\\star}}$ 是原点吸引域（ROA）的一个经过验证的子集。\n\n您的最终答案必须是 $c^{\\star}$ 的精确值，以单个实数表示。不需要单位，也不需要四舍五入。请精确表达您的最终答案。", "solution": "对该问题的分析必须严谨进行。我们首先验证问题陈述。\n\n**步骤1：提取已知条件**\n- 系统动力学：$\\dot{x}_{1}=-x_{1}+x_{1}x_{2}$ 和 $\\dot{x}_{2}=-x_{2}$。\n- 状态空间：$x = (x_{1}, x_{2}) \\in \\mathbb{R}^{2}$。\n- 平衡点：原点 $(0,0)$。\n- 候选李雅普诺夫函数：$V(x)=x_{1}^{2}+x_{2}^{2}$。\n- 子水平集：$\\Omega_{c}=\\{x\\in\\mathbb{R}^{2}:V(x)\\leq c\\}$，对于常数 $c>0$。\n- 目标：找到最大的值 $c^{\\star}>0$ 使得：\n    1. 对于 $\\Omega_{c^{\\star}}$ 内的所有轨迹，$V(x)$ 是非增的，并且 $\\Omega_{c^{\\star}}$ 是一个正不变集。\n    2. $\\{x\\in\\Omega_{c^{\\star}}:\\dot{V}(x)=0\\}$ 的最大不变子集是原点 $\\{0\\}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是适定的并且有科学依据。这是一个应用李雅普诺夫和拉萨尔不变性原理来估计非线性系统平衡点吸引域（ROA）的标准案例。系统、候选李雅普诺夫函数以及所有条件都以数学上的精确性进行了定义。不存在矛盾、歧义或事实错误。该问题是有效的。\n\n**步骤3：进行求解**\n该问题要求找到函数 $V(x)$ 的最大子水平集 $\\Omega_{c^{\\star}}$，该集合可作为原点的一个经过验证的吸引域。这涉及分析 $V(x)$ 沿着系统轨迹的时间导数。\n\n候选李雅普诺夫函数为 $V(x) = x_{1}^{2} + x_{2}^{2}$。其时间导数 $\\dot{V}(x)$ 使用链式法则计算：\n$$ \\dot{V}(x) = \\frac{\\partial V}{\\partial x_{1}}\\dot{x}_{1} + \\frac{\\partial V}{\\partial x_{2}}\\dot{x}_{2} $$\n代入给定的表达式，我们得到：\n$$ \\dot{V}(x) = (2x_{1})(-x_{1} + x_{1}x_{2}) + (2x_{2})(-x_{2}) $$\n$$ \\dot{V}(x) = -2x_{1}^{2} + 2x_{1}^{2}x_{2} - 2x_{2}^{2} $$\n这可以通过组合与 $V(x)$ 相关的项来重写：\n$$ \\dot{V}(x) = -2(x_{1}^{2} + x_{2}^{2}) + 2x_{1}^{2}x_{2} = -2V(x) + 2x_{1}^{2}x_{2} $$\n\n为使条件1成立，$V(x)$ 必须在 $\\Omega_{c^{\\star}}$ 内的轨迹上非增，并且 $\\Omega_{c^{\\star}}$ 必须是正不变的。这两者的一个充分条件是对于所有 $x \\in \\Omega_{c^{\\star}}$ 都有 $\\dot{V}(x) \\leq 0$。因此，我们必须找到最大的 $c^{\\star} > 0$，使得集合 $\\Omega_{c^{\\star}} = \\{x : V(x) \\leq c^{\\star}\\}$ 是 $\\dot{V}(x) \\leq 0$ 区域的一个子集。\n\n条件 $\\dot{V}(x) \\leq 0$ 为：\n$$ -2(x_{1}^{2} + x_{2}^{2}) + 2x_{1}^{2}x_{2} \\leq 0 $$\n$$ x_{1}^{2}x_{2} \\leq x_{1}^{2} + x_{2}^{2} $$\n$$ x_{1}^{2} + x_{2}^{2} - x_{1}^{2}x_{2} \\geq 0 $$\n$$ x_{1}^{2}(1-x_{2}) + x_{2}^{2} \\geq 0 $$\n为了找到满足此不等式的最大子水平集 $\\Omega_{c^{\\star}}$，我们必须确保 $\\Omega_{c^{\\star}}$ 中没有任何点位于 $\\dot{V}(x) > 0$ 的区域。这等价于在 $\\dot{V}(x) > 0$ 的区域中找到 $V(x)$ 的最小值。这个最小值将定义最大容许子水平集的边界，因此 $c^{\\star}$ 就是这个最小值。\n\n$\\dot{V}(x) > 0$ 的区域由以下不等式定义：\n$$ x_{1}^{2}(1-x_{2}) + x_{2}^{2}  0 $$\n这等价于：\n$$ x_{1}^{2}(x_{2}-1) - x_{2}^{2} > 0 $$\n为使此不等式成立，必须有 $x_{2}-1 > 0$，这意味着 $x_{2} > 1$。然后，我们可以写出：\n$$ x_{1}^{2} > \\frac{x_{2}^{2}}{x_{2}-1} $$\n我们寻求在约束条件 $x_{2} > 1$ 和 $x_{1}^{2} > \\frac{x_{2}^{2}}{x_{2}-1}$ 下最小化 $V(x) = x_{1}^{2} + x_{2}^{2}$。$V(x)$ 的最小值将出现在该区域的边界上，即 $x_{1}^{2} = \\frac{x_{2}^{2}}{x_{2}-1}$。\n将此代入 $V(x)$ 的表达式中，我们得到一个仅关于 $x_{2}$ 的函数，我们称之为 $h(x_{2})$：\n$$ h(x_{2}) = \\frac{x_{2}^{2}}{x_{2}-1} + x_{2}^{2} = x_{2}^{2}\\left(\\frac{1}{x_{2}-1} + 1\\right) = x_{2}^{2}\\left(\\frac{1 + x_{2}-1}{x_{2}-1}\\right) = \\frac{x_{2}^{3}}{x_{2}-1} $$\n为了找到当 $x_{2} > 1$ 时 $h(x_{2})$ 的最小值，我们计算它关于 $x_{2}$ 的导数：\n$$ h'(x_{2}) = \\frac{(3x_{2}^{2})(x_{2}-1) - (x_{2}^{3})(1)}{(x_{2}-1)^{2}} = \\frac{3x_{2}^{3} - 3x_{2}^{2} - x_{2}^{3}}{(x_{2}-1)^{2}} = \\frac{2x_{2}^{3} - 3x_{2}^{2}}{(x_{2}-1)^{2}} = \\frac{x_{2}^{2}(2x_{2}-3)}{(x_{2}-1)^{2}} $$\n令导数为零，$h'(x_{2})=0$，得出 $x_{2}^{2}(2x_{2}-3)=0$。因为 $x_{2}>1$，唯一的解是 $2x_{2}-3=0$，即 $x_{2} = \\frac{3}{2}$。\n当 $1  x_2  \\frac{3}{2}$ 时，$h'(x_2)$ 的符号为负，当 $x_2 > \\frac{3}{2}$ 时为正，这证实了 $x_2 = \\frac{3}{2}$ 是一个最小值点。最小值为：\n$$ h\\left(\\frac{3}{2}\\right) = \\frac{(\\frac{3}{2})^{3}}{\\frac{3}{2}-1} = \\frac{\\frac{27}{8}}{\\frac{1}{2}} = \\frac{27}{4} $$\n在区域 $\\dot{V}(x) > 0$ 中，$V(x)$ 的这个最小值为 $\\frac{27}{4}$。因此，使得对所有 $x \\in \\Omega_{c^{\\star}}$ 都有 $\\dot{V}(x) \\leq 0$ 成立的最大 $c^{\\star}$ 是 $c^{\\star} = \\frac{27}{4}$。这满足条件1。\n\n现在，我们用 $c^{\\star} = \\frac{27}{4}$ 来验证条件2。我们必须找到 $E = \\{x \\in \\Omega_{27/4} : \\dot{V}(x) = 0\\}$ 的最大不变子集。\n$\\dot{V}(x)=0$ 的点集由 $x_{1}^{2}(x_{2}-1) - x_{2}^{2} = 0$ 给出。这个方程在原点 $(0,0)$ 处成立。对于其他点，它可以写成 $x_{1}^{2} = \\frac{x_{2}^{2}}{x_{2}-1}$，这同样要求 $x_{2}>1$。\n集合 $E$ 由满足 $\\dot{V}(x)=0$ 和 $V(x) \\leq \\frac{27}{4}$ 的点组成。对于曲线 $x_{1}^{2} = \\frac{x_{2}^{2}}{x_{2}-1}$ 上的任意点，李雅普诺夫函数的值为 $V(x) = h(x_{2}) = \\frac{x_{2}^{3}}{x_{2}-1}$。我们已经确定 $h(x_{2})$ 的最小值为 $\\frac{27}{4}$。\n因此，对于 $\\dot{V}(x)=0$（且 $x \\neq 0$）的点，条件 $V(x) \\leq \\frac{27}{4}$ 只能在 $V(x) = \\frac{27}{4}$ 处满足。这仅发生在最小值点，即 $x_{2} = \\frac{3}{2}$。\n在 $x_{2} = \\frac{3}{2}$ 处，我们发现 $x_{1}^{2} = \\frac{(\\frac{3}{2})^{2}}{\\frac{3}{2}-1} = \\frac{\\frac{9}{4}}{\\frac{1}{2}} = \\frac{9}{2}$。这给出 $x_{1} = \\pm\\sqrt{\\frac{9}{2}} = \\pm\\frac{3}{\\sqrt{2}}$。\n因此，集合 $E$ 由恰好三个点组成：\n$$ E = \\left\\{ (0,0), \\left(\\frac{3}{\\sqrt{2}}, \\frac{3}{2}\\right), \\left(-\\frac{3}{\\sqrt{2}}, \\frac{3}{2}\\right) \\right\\} $$\n根据拉萨尔不变性原理，任何从 $\\Omega_{27/4}$ 开始的轨迹都必须收敛到包含在 $E$ 中的最大不变集。一个不变集是轨迹的并集。\n原点 $(0,0)$ 是系统的一个平衡点，因此 $\\{(0,0)\\}$ 是一个不变集。\n让我们检查点 $p = (\\frac{3}{\\sqrt{2}}, \\frac{3}{2})$。要使 $\\{p\\}$ 成为一个不变集，$p$ 必须是一个平衡点。我们检查 $p$ 点的动力学：\n$$ \\dot{x}_{1} = x_{1}(-1+x_{2}) = \\frac{3}{\\sqrt{2}}\\left(-1+\\frac{3}{2}\\right) = \\frac{3}{2\\sqrt{2}} \\neq 0 $$\n$$ \\dot{x}_{2} = -x_{2} = -\\frac{3}{2} \\neq 0 $$\n由于 $\\dot{x}(p) \\neq 0$，$p$ 不是一个平衡点，没有轨迹能停留在 $p$。根据对称性，点 $(-\\frac{3}{\\sqrt{2}}, \\frac{3}{2})$ 的情况也相同。\n因此，包含在 $E$ 中的唯一不变集是只包含原点的集合 $\\{(0,0)\\}$。这满足条件2。\n\n对于 $c^{\\star} = \\frac{27}{4}$，两个条件都得到满足，并且根据构造，这是最大的此类值。", "answer": "$$\\boxed{\\frac{27}{4}}$$", "id": "2738234"}, {"introduction": "理论分析得出的吸引域估计往往是保守的，而数值仿真是探索实际边界并验证理论的强大工具。这个综合性练习要求你设计并实现一个数值实验，将基于李雅普诺夫理论的解析推导与计算机仿真相结合。通过这项实践，你将学会如何量化理论界限，并用系统化的仿真来评估这些界限的有效性，从而真正连接起理论与工程应用。[@problem_id:2721989]", "problem": "考虑一个连续时间下的自治非线性常微分方程 (ODE)，由 $\\dot{x} = f(x)$ 给出，其中状态 $x \\in \\mathbb{R}^2$ 且\n$$\nf(x) = A x + g(x), \\quad A = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix},\n$$\n以及\n$$\ng(x) = \\begin{bmatrix}\nc_1 x_1^3 + c_2 x_1 x_2^2 \\\\\nc_3 x_1^2 x_2 + c_4 x_2^3\n\\end{bmatrix}.\n$$\n请基于以下控制理论的基础进行分析：\n- $\\dot{x} = f(x)$ 在平衡点 $x = 0$ 处的雅可比线性化由 $A = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=0}$ 给出，且李雅普诺夫间接法指出：如果 $A$ 是赫尔维茨矩阵（所有特征值都具有严格为负的实部），则该平衡点是局部渐近稳定的。\n- 对于任何对称正定矩阵 $Q \\in \\mathbb{S}_{++}^2$，当 $A$ 是赫尔维茨矩阵时，连续时间李雅普诺夫方程 $A^\\top P + P A = -Q$ 具有唯一的解 $P \\in \\mathbb{S}_{++}^2$。\n- 可取二次李雅普诺夫候选函数为 $V(x) = x^\\top P x$，沿轨迹的导数为 $\\dot{V}(x) = \\nabla V(x)^\\top f(x)$。\n- 使用欧几里得范数和柯西-施瓦茨不等式，以及诸如 $\\lvert x_i \\rvert \\le \\lVert x \\rVert_2$（对于 $i \\in \\{1,2\\}$）的基本界。\n\n你的任务是形式化并实现一个数值实验，通过模拟从二次水平集边界开始的轨迹，来估计上述系统在原点附近的一个局部吸引域。你必须将数值结果与一个理论推导出的、保证 $\\dot{V}$ 在一个二次水平集内为负的充分界关联起来。\n\n执行以下任务，不使用任何预先给出的简化公式。\n\n- 证明 $A$ 是赫尔维茨矩阵，并选择 $Q = I_2$，然后从 $A^\\top P + P A = -Q$ 计算 $P \\succ 0$。\n- 定义 $V(x) = x^\\top P x$。对于非线性项 $g(x)$，推导一个形式为 $\\lVert g(x) \\rVert_2 \\le c \\lVert x \\rVert_2^3$ 的范数界，其中可计算的常数 $c$ 仅用系数 $c_1, c_2, c_3, c_4$ 表示。\n- 仅使用上述基础工具，推导一个充分条件，保证在二次子水平集 $\\{x \\in \\mathbb{R}^2 \\mid V(x) \\le \\rho\\}$ 中的所有 $x$ 都满足 $\\dot{V}(x)  0$。将你的条件表示为一个显式上界 $\\rho_\\star$，使得如果选择 $\\rho \\in (0,\\rho_\\star)$，则在该子水平集中的所有 $x$ 都满足 $\\dot{V}(x)  0$。\n- 设计一个数值实验：对于给定的 $\\rho$，在椭圆 $\\{x \\in \\mathbb{R}^2 \\mid V(x) = \\rho\\}$ 上采样初始条件，在固定时间范围内模拟 $\\dot{x} = f(x)$ 下的轨迹，如果状态在数值上趋近于原点，则将该次试验标记为成功。使用以下规范：\n  - 使用 $Q = I_2$。\n  - 使用固定时间范围 $T = 20$。\n  - 使用 $N = 24$ 个初始条件，这些条件通过从欧几里得圆到该椭圆的精确变换，在椭圆 $V(x) = \\rho$ 上按角度均匀选取。\n  - 在数值积分器中使用绝对容差 $\\mathrm{atol} = 10^{-12}$ 和相对容差 $\\mathrm{rtol} = 10^{-9}$。\n  - 如果欧几里得范数满足 $\\lVert x(T) \\rVert_2 \\le 10^{-3}$，或者如果在任何更早的时刻，有事件检测到轨迹进入了原点周围半径为 $10^{-3}$ 的球内，则宣告数值收敛。\n  - 如果在任何时刻，有事件检测到欧几里得范数超过 $10$，则宣告数值发散。\n- 对于下述每个测试用例，首先从你推导的充分条件计算 $\\rho_\\star$。然后使用测试用例中的比例因子 $s$ 设置 $\\rho = s \\rho_\\star$。使用此 $\\rho$ 运行上述模拟实验。为每个测试用例返回一个布尔值，当且仅当来自 $N$ 个初始条件的所有模拟轨迹都如上文定义的那样数值收敛时，该值为 $\\mathrm{True}$；否则返回 $\\mathrm{False}$。\n\n使用以下参数值测试套件：\n- 测试用例 1: $(c_1,c_2,c_3,c_4) = (0.5,0.5,0.5,0.5)$ 且 $s = 0.5$。\n- 测试用例 2: $(c_1,c_2,c_3,c_4) = (1,1,1,1)$ 且 $s = 0.99$。\n- 测试用例 3: $(c_1,c_2,c_3,c_4) = (2,2,2,2)$ 且 $s = 20$。\n\n所有量均为无量纲且无单位。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例的顺序给出结果，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是一个布尔值。不得打印任何额外文本。", "solution": "问题陈述已经过仔细审查，并被认定为有效。它在科学上基于李雅普诺夫稳定性理论的原理，问题提法得当，提供了所有必要信息，并且其表述是客观的。不存在矛盾、歧义或事实上的不健全之处。我们将继续进行推导和求解。\n\n该问题要求进行两部分分析：首先，对给定非线性系统的吸引域进行理论估计；其次，通过数值实验来测试该理论估计的边界。\n\n系统动力学由 $\\dot{x} = f(x)$ 给出，其中 $x \\in \\mathbb{R}^2$，且 $f(x) = A x + g(x)$,\n$$\nA = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}, \\quad g(x) = \\begin{bmatrix}\nc_1 x_1^3 + c_2 x_1 x_2^2 \\\\\nc_3 x_1^2 x_2 + c_4 x_2^3\n\\end{bmatrix}.\n$$\n原点 $x=0$ 是一个平衡点，因为 $f(0) = 0$。$f(x)$ 在原点的雅可比矩阵是 $A$。\n\n首先，我们确定线性化系统 $\\dot{x} = Ax$ 的平衡点的局部渐近稳定性。这由 $A$ 的特征值决定。特征方程是 $\\det(A - \\lambda I) = 0$，即\n$$\n\\det \\begin{bmatrix} -\\lambda  1 \\\\ -2  -3-\\lambda \\end{bmatrix} = (-\\lambda)(-3-\\lambda) - (1)(-2) = \\lambda^2 + 3\\lambda + 2 = 0.\n$$\n该方程可因式分解为 $(\\lambda+1)(\\lambda+2) = 0$，得到特征值 $\\lambda_1 = -1$ 和 $\\lambda_2 = -2$。由于两个特征值都具有严格为负的实部，矩阵 $A$ 是赫尔维茨矩阵。根据李雅普诺夫间接法，非线性系统的平衡点 $x=0$ 是局部渐近稳定的。\n\n接下来，我们构造一个二次李雅普诺夫函数 $V(x) = x^\\top P x$ 来分析吸引域。我们必须通过求解连续时间李雅普诺夫方程 $A^\\top P + P A = -Q$ 来找到对称正定矩阵 $P$。问题指定使用 $Q=I_2$，即 $2 \\times 2$ 单位矩阵。设 $P = \\begin{bmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{bmatrix}$。该方程变为：\n$$\n\\begin{bmatrix} 0  -2 \\\\ 1  -3 \\end{bmatrix} \\begin{bmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{bmatrix} + \\begin{bmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix} = \\begin{bmatrix} -1  0 \\\\ 0  -1 \\end{bmatrix}.\n$$\n执行矩阵乘法和求和得到：\n$$\n\\begin{bmatrix} -4p_{12}  p_{11}-3p_{12}-2p_{22} \\\\ p_{11}-3p_{12}-2p_{22}  2p_{12}-6p_{22} \\end{bmatrix} = \\begin{bmatrix} -1  0 \\\\ 0  -1 \\end{bmatrix}.\n$$\n令各元素相等，得到一个关于 $P$ 中各项的线性方程组：\n1. $\\quad -4p_{12} = -1 \\implies p_{12} = \\frac{1}{4}$。\n2. $\\quad 2p_{12}-6p_{22} = -1 \\implies 2(\\frac{1}{4}) - 6p_{22} = -1 \\implies \\frac{1}{2} - 6p_{22} = -1 \\implies p_{22} = \\frac{1}{4}$。\n3. $\\quad p_{11}-3p_{12}-2p_{22} = 0 \\implies p_{11} = 3(\\frac{1}{4}) + 2(\\frac{1}{4}) = \\frac{5}{4}$。\n因此，解为 $P = \\frac{1}{4} \\begin{bmatrix} 5  1 \\\\ 1  1 \\end{bmatrix}$。为确认 $P$ 是正定的，我们检查其主子式：$p_{11} = \\frac{5}{4} > 0$ 和 $\\det(P) = (\\frac{5}{4})(\\frac{1}{4}) - (\\frac{1}{4})^2 = \\frac{4}{16} = \\frac{1}{4} > 0$。两者均为正，因此 $P \\succ 0$。\n\n现在，我们推导李雅普诺夫函数的时间导数 $\\dot{V}(x)$ 为负的充分条件。沿非线性系统轨迹的导数是：\n$$\n\\dot{V}(x) = \\nabla V(x)^\\top f(x) = (2Px)^\\top (Ax + g(x)) = x^\\top(A^\\top P + PA)x + 2x^\\top P g(x).\n$$\n使用 $A^\\top P + PA = -I_2$，这简化为：\n$$\n\\dot{V}(x) = -x^\\top I_2 x + 2x^\\top P g(x) = -\\lVert x \\rVert_2^2 + 2x^\\top P g(x).\n$$\n要使 $\\dot{V}(x)$ 为负，我们需要 $2x^\\top P g(x)  \\lVert x \\rVert_2^2$。我们对包含 $g(x)$ 的项进行界定。首先，我们找到 $g(x)$ 范数的一个界。使用不等式 $|x_i| \\le \\lVert x \\rVert_2$：\n$$\n\\lvert g_1(x) \\rvert = \\lvert c_1 x_1^3 + c_2 x_1 x_2^2 \\rvert \\le \\lvert c_1 \\rvert \\lvert x_1 \\rvert^3 + \\lvert c_2 \\rvert \\lvert x_1 \\rvert \\lvert x_2 \\rvert^2 \\le (\\lvert c_1 \\rvert + \\lvert c_2 \\rvert) \\lVert x \\rVert_2^3.\n$$\n$$\n\\lvert g_2(x) \\rvert = \\lvert c_3 x_1^2 x_2 + c_4 x_2^3 \\rvert \\le \\lvert c_3 \\rvert \\lvert x_1 \\rvert^2 \\lvert x_2 \\rvert + \\lvert c_4 \\rvert \\lvert x_2 \\rvert^3 \\le (\\lvert c_3 \\rvert + \\lvert c_4 \\rvert) \\lVert x \\rVert_2^3.\n$$\n因此，$g(x)$ 的欧几里得范数有界，界为：\n$$\n\\lVert g(x) \\rVert_2 = \\sqrt{\\lvert g_1(x) \\rvert^2 + \\lvert g_2(x) \\rvert^2} \\le \\sqrt{(\\lvert c_1 \\rvert + \\lvert c_2 \\rvert)^2 \\lVert x \\rVert_2^6 + (\\lvert c_3 \\rvert + \\lvert c_4 \\rvert)^2 \\lVert x \\rVert_2^6} = c \\lVert x \\rVert_2^3,\n$$\n其中 $c = \\sqrt{(\\lvert c_1 \\rvert + \\lvert c_2 \\rvert)^2 + (\\lvert c_3 \\rvert + \\lvert c_4 \\rvert)^2}$。\n\n使用这个界和柯西-施瓦茨不等式，我们对 $2x^\\top P g(x)$ 进行界定：\n$$\n2x^\\top P g(x) \\le 2 \\lvert x^\\top P g(x) \\rvert \\le 2 \\lVert Px \\rVert_2 \\lVert g(x) \\rVert_2.\n$$\n由于 $P$ 是对称正定的，其诱导 $2$-范数是它的最大特征值，$\\lVert P \\rVert_2 = \\lambda_{\\max}(P)$。因此，$\\lVert Px \\rVert_2 \\le \\lVert P \\rVert_2 \\lVert x \\rVert_2 = \\lambda_{\\max}(P) \\lVert x \\rVert_2$。代入这些界：\n$$\n2x^\\top P g(x) \\le 2 (\\lambda_{\\max}(P) \\lVert x \\rVert_2) (c \\lVert x \\rVert_2^3) = 2c\\lambda_{\\max}(P) \\lVert x \\rVert_2^4.\n$$\n因此，如果 $-\\lVert x \\rVert_2^2 + 2c\\lambda_{\\max}(P) \\lVert x \\rVert_2^4  0$，则能保证条件 $\\dot{V}(x)  0$ 成立。对于 $x \\ne 0$，这简化为 $2c\\lambda_{\\max}(P) \\lVert x \\rVert_2^2  1$，或 $\\lVert x \\rVert_2^2  \\frac{1}{2c\\lambda_{\\max}(P)}$。\n\n我们需要找到 $\\rho$ 的一个上界 $\\rho_\\star$，使得对于子水平集 $\\{x \\mid V(x) \\le \\rho\\}$ 中的任何 $x$，条件 $\\dot{V}(x)  0$ 都成立。对于该集合中的任何 $x$，我们有不等式 $V(x) \\ge \\lambda_{\\min}(P) \\lVert x \\rVert_2^2$，这意味着 $\\lVert x \\rVert_2^2 \\le \\frac{V(x)}{\\lambda_{\\min}(P)} \\le \\frac{\\rho}{\\lambda_{\\min}(P)}$。为满足子水平集中所有 $x$ 的负性条件，我们需要其边界在保证负性的区域内。我们施加严格不等式：\n$$\n\\frac{\\rho}{\\lambda_{\\min}(P)}  \\frac{1}{2c\\lambda_{\\max}(P)} \\implies \\rho  \\frac{\\lambda_{\\min}(P)}{2c\\lambda_{\\max}(P)}.\n$$\n这给出了所需的显式上界 $\\rho_\\star = \\frac{\\lambda_{\\min}(P)}{2c\\lambda_{\\max}(P)}$。$P$ 的特征值由特征方程 $4\\lambda^2 - 6\\lambda + 1 = 0$ 求得，得出 $\\lambda = \\frac{3 \\pm \\sqrt{5}}{4}$。因此，$\\lambda_{\\min}(P) = \\frac{3-\\sqrt{5}}{4}$ 且 $\\lambda_{\\max}(P) = \\frac{3+\\sqrt{5}}{4}$。\n该界为 $\\rho_\\star = \\frac{(3-\\sqrt{5})/4}{2c(3+\\sqrt{5})/4} = \\frac{3-\\sqrt{5}}{2c(3+\\sqrt{5})} = \\frac{(3-\\sqrt{5})^2}{2c(9-5)} = \\frac{14 - 6\\sqrt{5}}{8c} = \\frac{7 - 3\\sqrt{5}}{4c}$。\n\n对于数值实验，我们在椭圆 $x^\\top P x = \\rho$ 上生成初始条件。此椭圆上的一个点 $x$ 可以通过线性变换从半径为 $\\sqrt{\\rho}$ 的圆上的一个点 $y$ 生成。设 $P=LL^\\top$ 是 $P$ 的 Cholesky 分解。那么 $x^\\top P x = x^\\top L L^\\top x = (L^\\top x)^\\top (L^\\top x) = \\lVert L^\\top x \\rVert_2^2 = \\rho$。我们定义 $y = L^\\top x$，使得 $\\lVert y \\rVert_2 = \\sqrt{\\rho}$。变换为 $x = (L^\\top)^{-1}y$。我们将采样 $N=24$ 个点 $y_k = \\sqrt{\\rho} [\\cos \\theta_k, \\sin \\theta_k]^\\top$，其中 $\\theta_k = 2\\pi k/N$ for $k=0, \\dots, N-1$，并将它们转换为用于数值积分的初始条件 $x_k$。\n\n对于每个 $x_k$，将使用具有指定容差的数值积分器，在时间范围 $T=20$ 内执行 $\\dot{x}=f(x)$ 的模拟。如果轨迹进入原点周围半径为 $10^{-3}$ 的小球内，则宣告收敛。如果轨迹范数超过 $10$，则宣告发散。如果来自椭圆 $V(x) = \\rho = s \\rho_\\star$ 上初始条件的所有 $N=24$ 条轨迹都收敛，则该测试用例成功。\n\n这就完成了形式化的分析推导和数值实验的设计。实现将基于这些结果进行。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the specified numerical experiment and print results.\n    \"\"\"\n    # Define test cases: ((c1, c2, c3, c4), s)\n    test_cases = [\n        ((0.5, 0.5, 0.5, 0.5), 0.5),\n        ((1.0, 1.0, 1.0, 1.0), 0.99),\n        ((2.0, 2.0, 2.0, 2.0), 20.0),\n    ]\n\n    results = []\n    for c_coeffs, s in test_cases:\n        results.append(run_experiment(c_coeffs, s))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_experiment(c_coeffs, s_factor):\n    \"\"\"\n    Computes the theoretical bound rho_star, sets up the simulation radius rho,\n    and runs the simulation for N initial conditions.\n\n    Returns:\n        bool: True if all trajectories converge, False otherwise.\n    \"\"\"\n    # --- Theoretical Analysis ---\n    # Matrix A\n    A = np.array([[0, 1], [-2, -3]])\n    \n    # Solution P to A^T P + P A = -I\n    P = np.array([[5/4, 1/4], [1/4, 1/4]])\n    \n    # Eigenvalues of P\n    lambda_min_P = (3 - np.sqrt(5)) / 4\n    lambda_max_P = (3 + np.sqrt(5)) / 4\n    \n    # Constant c for the bound on g(x)\n    c1, c2, c3, c4 = c_coeffs\n    c = np.sqrt((abs(c1) + abs(c2))**2 + (abs(c3) + abs(c4))**2)\n    \n    # Theoretical bound rho_star\n    rho_star = (7 - 3 * np.sqrt(5)) / (4 * c)\n    \n    # Simulation level set parameter rho\n    rho = s_factor * rho_star\n\n    # --- Numerical Experiment ---\n    N_samples = 24\n    time_horizon = 20.0\n    \n    # Transformation matrix to map circle to ellipse V(x)=rho\n    # P = L L^T, x = (L^T)^-1 y\n    # L_inv_T = inv(L.T) where L is the Cholesky factor of P\n    L_inv_T = np.array([[2/np.sqrt(5), -1/np.sqrt(5)], [0, np.sqrt(5)]])\n    \n    # Generate initial conditions on the ellipse x^T P x = rho\n    thetas = np.linspace(0, 2 * np.pi, N_samples, endpoint=False)\n    radius = np.sqrt(rho)\n    y_coords = radius * np.vstack([np.cos(thetas), np.sin(thetas)])\n    initial_conditions = L_inv_T @ y_coords\n    \n    # --- Simulation Loop ---\n    all_converged = True\n    for i in range(N_samples):\n        x0 = initial_conditions[:, i]\n        converged = simulate_trajectory(A, c_coeffs, x0, time_horizon)\n        if not converged:\n            all_converged = False\n            break\n            \n    return all_converged\n\ndef simulate_trajectory(A, c_coeffs, x0, T):\n    \"\"\"\n    Integrates the ODE for one initial condition and checks for convergence.\n    \"\"\"\n    # Define the nonlinear system dynamics: dx/dt = f(x)\n    def ode_func(t, x, A_mat, coeffs):\n        c1, c2, c3, c4 = coeffs\n        gx = np.array([\n            c1 * x[0]**3 + c2 * x[0] * x[1]**2,\n            c3 * x[0]**2 * x[1] + c4 * x[1]**3\n        ])\n        return A_mat @ x + gx\n\n    # Event for numerical convergence\n    def convergence_event(t, x, A_mat, coeffs):\n        return np.linalg.norm(x) - 1e-3\n    convergence_event.terminal = True\n    convergence_event.direction = -1\n\n    # Event for numerical divergence\n    def divergence_event(t, x, A_mat, coeffs):\n        return np.linalg.norm(x) - 10.0\n    divergence_event.terminal = True\n    divergence_event.direction = 1\n\n    sol = solve_ivp(\n        fun=ode_func,\n        t_span=(0, T),\n        y0=x0,\n        method='RK45',\n        args=(A, c_coeffs),\n        rtol=1e-9,\n        atol=1e-12,\n        events=[convergence_event, divergence_event]\n    )\n    \n    # Check for convergence\n    # 1. Did the convergence event trigger?\n    if sol.t_events[0].size > 0:\n        return True\n    # 2. Did the simulation finish at T? Check final state norm.\n    if sol.status == 0 and np.linalg.norm(sol.y[:, -1]) = 1e-3:\n        return True\n    \n    # If neither of the above, it's considered not to have converged.\n    # This includes divergence event or finishing at T with norm > 1e-3.\n    return False\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "2721989"}]}