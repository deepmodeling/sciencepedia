{"hands_on_practices": [{"introduction": "第一个练习将聚焦于控制李雅普诺夫函数的一个基本应用：设计控制器使非线性系统跟踪期望轨迹。通过应用反馈线性化技术，我们可以抵消系统的非线性部分，并赋予系统稳定的线性误差动态。这个动手计算练习将引导您从第一性原理出发，推导出所需的控制律，从而巩固对期望系统行为与实现该行为的控制器之间联系的理解。[@problem_id:2695616]", "problem": "考虑控制仿射的二阶非线性系统\n$$\n\\dot{x}_{1} = x_{2}, \\qquad \\dot{x}_{2} = -x_{1}^{3} - x_{2} + u,\n$$\n以及跟踪正弦参考信号的目标\n$$\nr(t) = \\sin(2 t),\n$$\n其中角度以弧度为单位。定义跟踪误差为\n$$\ne_{1} := x_{1} - r(t), \\qquad e_{2} := x_{2} - \\dot{r}(t).\n$$\n使用控制李雅普诺夫函数 (Control Lyapunov Function, CLF) 的定义，其中 CLF 是任意一个连续可微的正定函数，其沿着闭环轨迹的时间导数是负定的。基于此，设计一个光滑、时变的状态反馈控制器，以保证上述系统跟踪误差的全局指数收敛。您的设计必须从第一性原理出发：明确地建立误差动力学，设定一个 Hurwitz 线性误差模型，并通过李雅普诺夫方程的一个对称正定矩阵解来证明 CLF 的下降。\n\n设期望的线性误差动力学由下式给出\n$$\n\\dot{e}_{1} = e_{2}, \\qquad \\dot{e}_{2} = -3 e_{1} - 4 e_{2},\n$$\n从而使得闭环误差矩阵是 Hurwitz 的。计算给定非线性对象和参考信号 $r(t)$ 所对应的基于 CLF 的输入 $u(x,t)$，其应为关于 $x_{1}$、$x_{2}$ 和 $t$ 的显式表达式。请提供 $u(x,t)$ 的精确、简化的解析表达式作为最终答案。无需进行数值四舍五入，且不涉及物理单位。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- **系统动力学：**\n$$\n\\dot{x}_{1} = x_{2}, \\qquad \\dot{x}_{2} = -x_{1}^{3} - x_{2} + u\n$$\n- **参考信号：**\n$$\nr(t) = \\sin(2 t)\n$$\n- **跟踪误差定义：**\n$$\ne_{1} := x_{1} - r(t), \\qquad e_{2} := x_{2} - \\dot{r}(t)\n$$\n- **期望线性误差动力学：**\n$$\n\\dot{e}_{1} = e_{2}, \\qquad \\dot{e}_{2} = -3 e_{1} - 4 e_{2}\n$$\n- **目标：** 计算实现这些误差动力学的控制输入 $u(x,t)$。该设计必须使用控制李雅普诺夫函数 (CLF) 的概念来证明其合理性。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是非线性控制理论中的一个标准练习，具体涉及使用反馈线性化方法对控制仿射系统进行跟踪控制。所有提供的信息在科学上是合理的、自洽的，并且在数学上是一致的。系统和参考信号定义明确。目标清晰。该问题是适定的，并允许求解出唯一的控制律 $u(x, t)$。不存在矛盾、歧义或违反科学原理之处。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n**求解推导**\n目标是设计一个状态反馈控制律 $u(x,t)$，它能使跟踪误差向量 $e(t) = \\begin{pmatrix} e_{1}(t)  e_{2}(t) \\end{pmatrix}^T$ 收敛到零。所采用的方法是反馈线性化，即通过抵消非线性动力学并用期望的线性误差动力学取而代之。\n\n首先，我们计算参考信号 $r(t)$ 的时间导数：\n$$\nr(t) = \\sin(2 t)\n$$\n$$\n\\dot{r}(t) = \\frac{d}{dt} \\sin(2 t) = 2 \\cos(2 t)\n$$\n$$\n\\ddot{r}(t) = \\frac{d}{dt} \\left( 2 \\cos(2 t) \\right) = -4 \\sin(2 t)\n$$\n\n接下来，我们通过对误差变量 $e_{1}$ 和 $e_{2}$ 关于时间求导来建立误差动力学：\n$$\n\\dot{e}_{1} = \\frac{d}{dt} (x_{1} - r(t)) = \\dot{x}_{1} - \\dot{r}(t)\n$$\n代入系统动力学 $\\dot{x}_{1} = x_{2}$ 可得：\n$$\n\\dot{e}_{1} = x_{2} - \\dot{r}(t)\n$$\n根据定义，$e_{2} = x_{2} - \\dot{r}(t)$，因此我们得到：\n$$\n\\dot{e}_{1} = e_{2}\n$$\n这个结果与期望线性误差动力学的第一个方程一致。\n\n现在，我们对第二个误差变量 $e_{2}$ 求导：\n$$\n\\dot{e}_{2} = \\frac{d}{dt} (x_{2} - \\dot{r}(t)) = \\dot{x}_{2} - \\ddot{r}(t)\n$$\n代入 $\\dot{x}_{2}$ 的系统动力学可得：\n$$\n\\dot{e}_{2} = (-x_{1}^{3} - x_{2} + u) - \\ddot{r}(t)\n$$\n这是 $\\dot{e}_{2}$ 的实际动力学，其中包含控制输入 $u$。为了实现跟踪目标，我们将此表达式设为等于给定的 $\\dot{e}_{2}$ 的期望动力学 $-3 e_{1} - 4 e_{2}$：\n$$\n-x_{1}^{3} - x_{2} + u - \\ddot{r}(t) = -3 e_{1} - 4 e_{2}\n$$\n现在我们可以求解控制输入 $u$：\n$$\nu(x,t) = x_{1}^{3} + x_{2} + \\ddot{r}(t) - 3 e_{1} - 4 e_{2}\n$$\n这是控制律的一般形式。为了得到关于状态变量 $x_1, x_2$ 和时间 $t$ 的显式表达式，我们代入 $e_1$，$e_2$ 的定义以及 $\\ddot{r}(t)$ 的表达式：\n$$\nu(x_1, x_2, t) = x_{1}^{3} + x_{2} + (-4 \\sin(2 t)) - 3(x_{1} - r(t)) - 4(x_{2} - \\dot{r}(t))\n$$\n$$\nu(x_1, x_2, t) = x_{1}^{3} + x_{2} - 4 \\sin(2 t) - 3(x_{1} - \\sin(2 t)) - 4(x_{2} - 2 \\cos(2 t))\n$$\n展开各项，我们得到：\n$$\nu(x_1, x_2, t) = x_{1}^{3} + x_{2} - 4 \\sin(2 t) - 3 x_{1} + 3 \\sin(2 t) - 4 x_{2} + 8 \\cos(2 t)\n$$\n最后，我们合并同类项，得到控制律的简化表达式：\n$$\nu(x_{1}, x_{2}, t) = x_{1}^{3} - 3 x_{1} - 3 x_{2} - \\sin(2 t) + 8 \\cos(2 t)\n$$\n这是一个光滑、时变的状态反馈控制器。\n\n**通过控制李雅普诺夫函数 (CLF) 进行论证**\n问题要求通过 CLF 原理来论证控制器设计的合理性。根据构造，控制律 $u(x,t)$ 强制系统遵循以下线性时不变的误差动力学：\n$$\n\\dot{e} = A e, \\quad \\text{其中} \\quad e = \\begin{pmatrix} e_{1} \\\\ e_{2} \\end{pmatrix}, \\quad A = \\begin{pmatrix} 0  1 \\\\ -3  -4 \\end{pmatrix}\n$$\n原点 $e=0$ 的稳定性由矩阵 $A$ 的特征值决定。特征方程为 $\\det(A - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix} -\\lambda  1 \\\\ -3  -4-\\lambda \\end{pmatrix} = (-\\lambda)(-4-\\lambda) - (1)(-3) = 4\\lambda + \\lambda^2 + 3 = 0\n$$\n$$\n\\lambda^2 + 4\\lambda + 3 = (\\lambda + 1)(\\lambda + 3) = 0\n$$\n特征值为 $\\lambda_{1} = -1$ 和 $\\lambda_{2} = -3$。由于两个特征值都具有负实部，矩阵 $A$ 是 Hurwitz 矩阵，因此误差动力学是全局指数稳定的。\n\n为了使用李雅普诺夫函数来将其形式化，我们考虑一个二次候选函数 $V(e) = e^T P e$，其中 $P$ 是一个对称正定矩阵。要使 $V(e)$ 成为一个严格的李雅普诺夫函数，其沿着系统轨迹的时间导数必须是负定的。\n$$\n\\dot{V}(e) = \\frac{d}{dt}(e^T P e) = \\dot{e}^T P e + e^T P \\dot{e} = (A e)^T P e + e^T P (A e) = e^T (A^T P + P A) e\n$$\n根据线性系统的李雅普诺夫定理，由于 $A$ 是 Hurwitz 矩阵，对于任意给定的对称正定矩阵 $Q$，存在一个唯一的对称正定矩阵 $P$ 解李雅普诺夫方程：\n$$\nA^T P + P A = -Q\n$$\n选择 $Q=I$ (单位矩阵)，我们有 $\\dot{V}(e) = -e^T Q e = -e^T I e = -e_{1}^{2} - e_{2}^{2}$。由于 $P$ 是正定的，$V(e)$ 是正定的；又由于 $Q$ 是正定的，对于所有 $e \\neq 0$，$\\dot{V}(e)$ 是负定的。\n\n因此，$V(e)$ 是一个有效的李雅普诺夫函数，它证明了误差动力学的全局指数稳定性。这个相同的函数 $V(e(x,t))$ 也可作为原始跟踪问题的控制李雅普诺夫函数 (CLF)。控制律 $u$ 是专门设计用来使 $\\dot{V}$ 负定的。这满足了问题的要求。\n所推导出的控制输入 $u(x,t)$ 确保了跟踪误差全局且指数地收敛到零。", "answer": "$$\n\\boxed{x_{1}^{3} - 3 x_{1} - 3 x_{2} - \\sin(2 t) + 8 \\cos(2 t)}\n$$", "id": "2695616"}, {"introduction": "虽然解析设计方法功能强大，但许多复杂系统需要借助计算工具来综合控制李雅普诺夫函数。本练习将介绍一种现代方法，该方法使用半定规划（SDP）（在此近似为线性规划（LP））来为一个多项式系统寻找二次 CLF。您需要将 CLF 的理论条件转化为一组线性约束，并使用优化器找到一个有效的函数，从而架起控制理论与实际计算实现之间的桥梁。[@problem_id:2695549]", "problem": "给定一个二维标量输入的控制仿射非线性多项式系统。该系统由常微分方程定义\n$$\n\\dot{x} = f(x) + g(x)\\,u,\n$$\n其中 $x = [x_1, x_2]^\\top \\in \\mathbb{R}^2$，$u \\in \\mathbb{R}$，且\n$$\nf(x) = \\begin{bmatrix} -x_1 + 0.2\\,x_1^3 \\\\ -2\\,x_2 + 0.5\\,x_1 x_2 \\end{bmatrix}, \\quad\ng(x) = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\n假设控制输入有界，满足 $|u| \\leq u_{\\max}$。\n\n对于一个控制仿射系统，其控制李雅普诺夫函数 (CLF) $V:\\mathbb{R}^2 \\to \\mathbb{R}_{\\ge 0}$ 是一个连续可微函数，满足 $V(0)=0$、对于所有 $x \\neq 0$ 有 $V(x)0$，并具有以下性质：存在一个反馈 $u(x)$，使得 $V$ 沿着闭环轨迹的导数满足\n$$\n\\dot{V}(x) = \\nabla V(x)^\\top \\left(f(x) + g(x)\\,u(x)\\right) \\le -\\alpha\\,V(x)\n$$\n对于某个 $\\alpha  0$ 以及在指定关心区域内的所有 $x$。对于有界控制 $|u|\\le u_{\\max}$，存在此类反馈的一个充分条件是鲁棒不等式\n$$\nL_f V(x) - u_{\\max}\\,\\big| L_g V(x) \\big| \\le -\\alpha\\,V(x),\n$$\n在区域内对所有 $x$ 成立，其中 $L_f V(x) := \\nabla V(x)^\\top f(x)$ 和 $L_g V(x) := \\nabla V(x)^\\top g(x)$ 表示李导数。\n\n考虑一个二次候选函数 $V(x) = x^\\top P x$，其中 $P \\in \\mathbb{R}^{2\\times 2}$ 是一个对称矩阵。要求对于所有 $x \\neq 0$ 都有 $V(x)0$ 等价于 $P \\succ 0$（正定）。这类二次CLF的综合问题可以构建为一个半定规划 (SDP)：寻找 $P \\succ 0$，使得鲁棒耗散不等式在区域 $\\mathcal{R}$ 内对所有 $x$ 成立。为了在没有专门的半定规划求解器的编程练习中使其计算上可行，通过对状态空间和方向进行采样来近似无限约束集，从而将问题转化为SDP的一个线性规划 (LP) 外近似，具体如下。\n\n1. 选择一个方形区域 $\\mathcal{R}_\\infty(r) := \\{x \\in \\mathbb{R}^2 : \\|x\\|_\\infty \\le r\\}$。\n2. 通过要求 $d_k^\\top P d_k \\ge \\varepsilon_{\\text{pd}}$ 来施加正定性的离散代理，其中 $d_k = [\\cos\\theta_k, \\sin\\theta_k]^\\top$ 是一组有限的单位方向，$\\theta_k$ 是在 $[0, 2\\pi)$ 中均匀分布的角度，$\\varepsilon_{\\text{pd}}  0$ 是一个小的正常数。\n3. 在 $\\mathcal{R}_\\infty(r)$ 内的网格点 $x_i$ 上强制执行鲁棒耗散不等式，通过引入松弛变量 $s_i \\ge |L_g V(x_i)|$ 来线性化绝对值，并施加\n$$\nL_f V(x_i) - u_{\\max}\\, s_i + \\alpha\\, V(x_i) \\le 0,\\quad s_i \\ge L_g V(x_i),\\quad s_i \\ge -L_g V(x_i).\n$$\n对于 $V(x) = x^\\top P x$ 和给定的 $f,g$，当 $x$ 固定时，表达式 $V(x)$、$L_f V(x)$ 和 $L_g V(x)$ 是关于 $P$ 的元素线性的。因此，上述约束是关于决策变量 $\\{p_{11}, p_{12}, p_{22}\\}$ 和 $\\{s_i\\}$ 的线性不等式。\n\n你的任务是：\n\n- 构建并求解线性规划，最小化 $\\operatorname{trace}(P) = p_{11} + p_{22}$，并满足上述描述的线性约束，这些约束近似于原始的半定规划。在你的实现中，使用以下固定值，除非测试另有规定：一个包含16个均匀分布角度的方向集用于强制 $d_k^\\top P d_k \\ge \\varepsilon_{\\text{pd}}$，其中 $\\varepsilon_{\\text{pd}} = 0.05$；以及一个 $n_{\\text{synth}}\\times n_{\\text{synth}}$ 点的综合网格，其中 $n_{\\text{synth}} = 9$，在 $\\mathcal{R}_\\infty(r)$ 的每个维度上均匀分布。\n- 一旦找到对称矩阵 $P$，在一个更精细的 $n_{\\text{verify}}\\times n_{\\text{verify}}$ 点的网格上（其中 $n_{\\text{verify}} = 41$）数值验证鲁棒耗散不等式\n$$\nL_f V(x) - u_{\\max}\\,|L_g V(x)| \\le -\\alpha\\,V(x)\n$$\n在 $\\mathcal{R}_\\infty(r)$ 内的所有网格点 $x$ 上成立（在右侧添加一个小的数值容差 $10^{-7}$，以避免因舍入误差导致的假阴性）。\n- 如果线性规划不可行，或者不等式在任何验证网格点上不成立，则该测试用例返回布尔结果false；否则返回true。\n\n使用以下参数元组 $(r, \\alpha, u_{\\max})$ 的测试套件来评估不同情况：\n\n- 测试A（基线“理想路径”）：$(0.6, 0.5, 1.0)$。\n- 测试B（具有中等控制权限的较大区域）：$(1.0, 0.3, 1.5)$。\n- 测试C（因弱控制和快速衰减而具有挑战性）：$(0.8, 0.8, 0.3)$。\n- 测试D（具有温和衰减和中等控制的大区域）：$(1.2, 0.2, 0.8)$。\n\n你的程序必须生成单行输出，其中包含按顺序排列的结果，形式为方括号括起来的逗号分隔列表，例如，“[true,false,true,true]”。Python中的布尔字面量是“True”和“False”；你的输出必须使用Python列表打印出的确切布尔格式。\n\n方向的角度值必须以弧度为单位。不涉及物理单位。\n\n最终代码必须是一个完整的、可运行的程序，该程序实现了半定规划的线性规划外近似，并按规定执行验证，且仅使用允许的库。", "solution": "所提出的问题是计算控制理论中一个有效且适定的练习。它要求为一个特定的二维非线性系统综合并验证一个二次控制李雅普诺夫函数（CLF）。该过程涉及通过离散化状态空间，将半定规划（SDP）近似为线性规划（LP），这是控制工程中一种常用且实用的技术。所有参数和条件都已明确指定，可以直接进行可验证的实现。该问题在科学上基于李雅普诺夫稳定性和最优控制的原理。\n\n该系统动力学由控制仿射常微分方程 $\\dot{x} = f(x) + g(x)u$ 给出，其中状态为 $x = [x_1, x_2]^\\top$，控制为 $u \\in \\mathbb{R}$，向量场为\n$$\nf(x) = \\begin{bmatrix} -x_1 + 0.2\\,x_1^3 \\\\ -2\\,x_2 + 0.5\\,x_1 x_2 \\end{bmatrix}, \\quad\ng(x) = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\n我们寻求一个二次CLF候选函数 $V(x) = x^\\top P x$，其中 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$ 是一个对称正定矩阵。综合目标是找到这样一个 $P$，使其对于有界控制 $|u| \\le u_{\\max}$ 满足鲁棒耗散不等式：\n$$\nL_f V(x) - u_{\\max}\\,|L_g V(x)| \\le -\\alpha V(x)\n$$\n对于区域 $\\mathcal{R}_\\infty(r) = \\{x \\in \\mathbb{R}^2 : \\|x\\|_\\infty \\le r\\}$ 内的所有状态 $x$ 成立。项 $L_f V(x)$ 和 $L_g V(x)$ 分别是 $V$ 沿着 $f$ 和 $g$ 的李导数。\n\n任务的核心是将此问题构建为一个LP。LP的决策变量是还包括对称矩阵 $P$ 的唯一元素，即 $\\{p_{11}, p_{12}, p_{22}\\}$，以及一组松弛变量 $\\{s_i\\}$，每个综合网格点 $x_i$ 对应一个。\n\n首先，我们将耗散不等式中的项表示为决策变量的线性函数。\nCLF候选函数为 $V(x) = p_{11}x_1^2 + 2p_{12}x_1x_2 + p_{22}x_2^2$。\n其梯度为 $\\nabla V(x) = \\begin{bmatrix} 2p_{11}x_1 + 2p_{12}x_2 \\\\ 2p_{12}x_1 + 2p_{22}x_2 \\end{bmatrix}$。\n\n李导数计算为 $L_f V(x) = \\nabla V(x)^\\top f(x)$ 和 $L_g V(x) = \\nabla V(x)^\\top g(x)$：\n$L_g V(x) = (2p_{11}x_1 + 2p_{12}x_2)(1) + (2p_{12}x_1 + 2p_{22}x_2)(0) = 2p_{11}x_1 + 2p_{12}x_2$。\n$L_f V(x) = (2p_{11}x_1 + 2p_{12}x_2)(-x_1 + 0.2x_1^3) + (2p_{12}x_1 + 2p_{22}x_2)(-2x_2 + 0.5x_1x_2)$。\n收集 $P$ 的元素的系数：\n$L_f V(x) = p_{11}(-2x_1^2 + 0.4x_1^4) + p_{12}(-6x_1x_2 + 0.4x_1^3x_2 + x_1^2x_2) + p_{22}(-4x_2^2 + x_1x_2^2)$。\n很明显，对于一个固定的状态 $x$，函数 $V(x)$、$L_f V(x)$ 和 $L_g V(x)$ 都是关于 $p_{11}, p_{12}, p_{22}$ 的线性函数。\n\nLP的构建如下：\n目标函数：最小化 $\\operatorname{trace}(P) = p_{11} + p_{22}$。这是一个线性目标函数。\n\n约束条件：\n1. 正定性代理：条件 $P \\succ 0$ 通过要求 $d_k^\\top P d_k \\ge \\varepsilon_{\\text{pd}}$ 对一组16个单位方向向量 $d_k = [\\cos\\theta_k, \\sin\\theta_k]^\\top$ 来近似。写出这个条件可以得到16个线性不等式：\n$$\n-p_{11}\\cos^2\\theta_k - 2p_{12}\\cos\\theta_k\\sin\\theta_k - p_{22}\\sin^2\\theta_k \\le -\\varepsilon_{\\text{pd}} \\quad \\text{对于 } k=1, \\dots, 16.\n$$\n给定值为 $\\varepsilon_{\\text{pd}} = 0.05$。\n\n2. 离散化耗散不等式：通过为 $N_{\\text{synth}} = 9 \\times 9 = 81$ 个综合网格点 $x_i$ 中的每一个引入松弛变量 $s_i \\ge |L_g V(x_i)|$ 来线性化绝对值项 $|L_g V(x)|$。这导致每个点 $x_i$ 都有三组线性不等式：\n$$\nL_f V(x_i) - u_{\\max}s_i + \\alpha V(x_i) \\le 0\n$$\n$$\nL_g V(x_i) - s_i \\le 0\n$$\n$$\n-L_g V(x_i) - s_i \\le 0\n$$\n代入 $V, L_fV, L_gV$ 的表达式，得到总共 $3 \\times 81 = 243$ 个涉及变量 $p_{11}, p_{12}, p_{22}$ 和松弛变量 $s_i$ 的线性不等式。变量 $p_{11}, p_{12}, p_{22}$ 是无界的，而松弛变量 $s_i$ 被约束为非负，这个条件由后两个不等式隐式满足。\n\n决策变量总数为 $3 + 81 = 84$。线性不等式约束总数为 $16 + 243 = 259$。该系统使用 `scipy.optimize.linprog` 函数求解。\n\n如果LP求解器找到一个可行解，它会返回一个矩阵 $P$。然后，该矩阵将在一个更精细的 $N_{\\text{verify}} = 41 \\times 41 = 1681$ 个点的网格上进行验证测试。在每个验证点 $x_v$ 上，检查原始的鲁棒耗散不等式：\n$$\nL_f V(x_v) - u_{\\max}|L_g V(x_v)| + \\alpha V(x_v) \\le 10^{-7}\n$$\n其中加入了一个小的容差 $10^{-7}$ 以防止浮点算术误差导致的假阴性。如果不等式对所有验证点都成立，则认为该测试用例成功（True）。如果LP不可行或验证在任何点失败，则测试用例失败（False）。对所提供的四个参数集中的每一个重复整个过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to run the CLF synthesis and verification for all test cases.\n    \"\"\"\n    # Test cases: (r, alpha, u_max)\n    test_cases = [\n        (0.6, 0.5, 1.0),   # Test A\n        (1.0, 0.3, 1.5),   # Test B\n        (0.8, 0.8, 0.3),   # Test C\n        (1.2, 0.2, 0.8),   # Test D\n    ]\n\n    results = []\n    for r, alpha, u_max in test_cases:\n        result = process_case(r, alpha, u_max)\n        results.append(result)\n\n    # Format the final output as a Python-style list of booleans\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef process_case(r, alpha, u_max):\n    \"\"\"\n    Formulates and solves the LP for a single test case, then runs verification.\n    \n    Args:\n        r (float): Radius of the infinity-norm ball for state space region.\n        alpha (float): Desired exponential decay rate for the CLF.\n        u_max (float): Maximum control input magnitude.\n\n    Returns:\n        bool: True if a valid CLF is found and verified, False otherwise.\n    \"\"\"\n    # --- 1. Define constants and generate grids/directions ---\n    n_synth = 9\n    n_verify = 41\n    eps_pd = 0.05\n    n_dir = 16\n    n_p_vars = 3  # p11, p12, p22\n    n_synth_pts = n_synth * n_synth\n    n_vars = n_p_vars + n_synth_pts\n\n    # Synthesis grid\n    synth_coords = np.linspace(-r, r, n_synth)\n    sx, sy = np.meshgrid(synth_coords, synth_coords)\n    synth_grid = np.vstack([sx.ravel(), sy.ravel()]).T\n\n    # Positive definiteness directions\n    thetas = np.linspace(0, 2 * np.pi, n_dir, endpoint=False)\n    directions = np.vstack([np.cos(thetas), np.sin(thetas)]).T\n\n    # --- 2. Construct the Linear Program ---\n    # Objective: min(p11 + p22)\n    c = np.zeros(n_vars)\n    c[0] = 1.0  # p11\n    c[2] = 1.0  # p22\n\n    # Inequality constraints A_ub * x = b_ub\n    n_pd_cons = n_dir\n    n_diss_cons = n_synth_pts\n    n_slack_cons = 2 * n_synth_pts\n    n_cons = n_pd_cons + n_diss_cons + n_slack_cons\n    \n    A_ub = np.zeros((n_cons, n_vars))\n    b_ub = np.zeros(n_cons)\n\n    # Constraint 1: Positive definiteness surrogate\n    for k in range(n_dir):\n        d1, d2 = directions[k]\n        A_ub[k, 0] = -d1**2\n        A_ub[k, 1] = -2 * d1 * d2\n        A_ub[k, 2] = -d2**2\n        b_ub[k] = -eps_pd\n    \n    # Constraints 2  3: Dissipation inequality and slack variables\n    for i in range(n_synth_pts):\n        x1, x2 = synth_grid[i]\n        \n        # V(x) coefficients\n        v_c11 = x1**2\n        v_c12 = 2 * x1 * x2\n        v_c22 = x2**2\n        \n        # LfV(x) coefficients\n        lfv_c11 = -2 * x1**2 + 0.4 * x1**4\n        lfv_c12 = -6 * x1 * x2 + 0.4 * x1**3 * x2 + x1**2 * x2\n        lfv_c22 = -4 * x2**2 + x1 * x2**2\n        \n        # LgV(x) coefficients\n        lgv_c11 = 2 * x1\n        lgv_c12 = 2 * x2\n\n        s_idx = n_p_vars + i\n        \n        # Dissipation constraint: LfV - u_max*s + alpha*V = 0\n        diss_row_idx = n_pd_cons + i\n        A_ub[diss_row_idx, 0] = lfv_c11 + alpha * v_c11\n        A_ub[diss_row_idx, 1] = lfv_c12 + alpha * v_c12\n        A_ub[diss_row_idx, 2] = lfv_c22 + alpha * v_c22\n        A_ub[diss_row_idx, s_idx] = -u_max\n        b_ub[diss_row_idx] = 0.0\n\n        # Slack constraint 1: LgV - s = 0\n        slack1_row_idx = n_pd_cons + n_diss_cons + i\n        A_ub[slack1_row_idx, 0] = lgv_c11\n        A_ub[slack1_row_idx, 1] = lgv_c12\n        A_ub[slack1_row_idx, s_idx] = -1.0\n        b_ub[slack1_row_idx] = 0.0\n\n        # Slack constraint 2: -LgV - s = 0\n        slack2_row_idx = n_pd_cons + n_diss_cons + n_synth_pts + i\n        A_ub[slack2_row_idx, 0] = -lgv_c11\n        A_ub[slack2_row_idx, 1] = -lgv_c12\n        A_ub[slack2_row_idx, s_idx] = -1.0\n        b_ub[slack2_row_idx] = 0.0\n\n    # Variable bounds: p_ij unbounded, s_i non-negative\n    bounds = [(None, None)] * n_p_vars + [(0, None)] * n_synth_pts\n\n    # --- 3. Solve the LP ---\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method='highs')\n\n    if not res.success:\n        return False\n        \n    # --- 4. Verify the solution ---\n    p_sol = res.x[:n_p_vars]\n    p11, p12, p22 = p_sol[0], p_sol[1], p_sol[2]\n\n    # Verification grid\n    verify_coords = np.linspace(-r, r, n_verify)\n    vx, vy = np.meshgrid(verify_coords, verify_coords)\n    verify_grid = np.vstack([vx.ravel(), vy.ravel()]).T\n    \n    for i in range(verify_grid.shape[0]):\n        x1, x2 = verify_grid[i]\n        \n        # V(x)\n        V_val = p11 * x1**2 + 2 * p12 * x1 * x2 + p22 * x2**2\n        \n        # LfV(x)\n        LfV_val = p11 * (-2 * x1**2 + 0.4 * x1**4) + \\\n                  p12 * (-6 * x1 * x2 + 0.4 * x1**3 * x2 + x1**2 * x2) + \\\n                  p22 * (-4 * x2**2 + x1 * x2**2)\n                  \n        # LgV(x)\n        LgV_val = p11 * (2 * x1) + p12 * (2 * x2)\n\n        # Robust dissipation inequality check\n        dissipation_val = LfV_val - u_max * np.abs(LgV_val)\n        required_decay = -alpha * V_val\n        \n        # Add tolerance to avoid false negatives due to floating point error\n        if dissipation_val  required_decay + 1e-7:\n            return False\n\n    return True\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2695549"}, {"introduction": "控制李雅普诺夫函数的存在保证了镇定控制律的存在，但并不一定保证该控制律是*连续*的。本练习将深入探讨这一关键的微妙之处，通过分析一个违反“小控制特性”（Small Control Property, SCP）的系统。通过分析系统在原点附近所需的控制量，您将揭示为何某些系统尽管存在 CLF，却无法被任何连续反馈所镇定，从而深化对非线性控制理论基础的理解。[@problem_id:2695614]", "problem": "考虑标量控制仿射非线性系统，其形式为\n$$\\dot{x} = f(x) + g(x) u,$$\n其中\n$$f(x) = x \\quad \\text{and} \\quad g(x) = x^{2},$$\n以及候选的控制李雅普诺夫函数 (Control Lyapunov Function, CLF) $V(x) = \\tfrac{1}{2} x^{2}$。从控制理论的核心定义出发：一个控制李雅普诺夫函数 (CLF) 是一个正定且正常的函数 $V$，使得对于每一个 $x \\neq 0$，都存在一个控制输入 $u \\in \\mathbb{R}$ 使得 $\\dot{V}(x,u)  0$。小控制性质 (small control property, SCP) 要求对于任意 $\\varepsilon  0$，存在一个 $\\delta  0$，使得对于所有满足 $0  |x|  \\delta$ 的 $x$，都存在一个满足 $|u|  \\varepsilon$ 的控制 $u$ 使得 $\\dot{V}(x,u)  0$。仅使用这些基本定义和标准的微积分事实。\n\n任务：\n- 使用第一性原理，通过对每个 $x \\neq 0$ 显式地找出一个能使 $\\dot{V}(x,u)  0$ 的控制 $u$，来验证 $V(x)$ 是给定系统的一个CLF。\n- 固定任意 $\\alpha \\in (0,1)$，并将最小控制幅值函数 $m(x)$ 定义为满足以下条件的最小 $|u|$：\n$$\\dot{V}(x,u) \\leq -\\alpha x^{2} \\quad \\text{for a given} \\quad x \\neq 0.$$\n推导 $m(x)$ 关于 $x$ 和 $\\alpha$ 的精确闭式表达式。\n- 计算极限\n$$L(\\alpha) = \\lim_{x \\to 0} \\, |x| \\, m(x).$$\n- 仅使用连接CLF、SCP和连续镇定器的标准定义和著名定理，简要解释您的结果对原点处的小控制性质 (SCP) 以及连续镇定状态反馈存在性的影响。\n\n答案规格：\n作为最终答案，提供 $L(\\alpha)$ 作为 $\\alpha$ 的函数的精确闭式表达式。无需四舍五入，也不涉及物理单位。最终答案必须是单个解析表达式。", "solution": "本问题将以顺序、演绎的方式进行分析和求解，严格遵守所提供的定义和第一性原理。\n\n首先，我们必须验证问题的陈述。问题提供了一个标量非线性控制系统、一个候选的控制李雅普诺夫函数 (CLF) 以及一组基于基本控制理论定义的分析任务。\n已知条件如下：\n- 系统动态：$\\dot{x} = f(x) + g(x) u$，其中 $x \\in \\mathbb{R}$ 是状态， $u \\in \\mathbb{R}$ 是控制输入。\n- 系统函数：$f(x) = x$ 和 $g(x) = x^{2}$。\n- 候选CLF：$V(x) = \\frac{1}{2} x^{2}$。\n- CLF定义：$V$ 是一个正定且正常的函数，使得对于每一个 $x \\neq 0$，都存在一个控制 $u$ 使得 $\\dot{V}(x,u)  0$。\n- 小控制性质 (SCP) 定义：对于任意 $\\varepsilon > 0$，存在一个 $\\delta > 0$，使得对于所有满足 $0  |x|  \\delta$ 的 $x$，都有一个满足 $|u|  \\varepsilon$ 的控制 $u$ 使得 $\\dot{V}(x,u)  0$。\n- 最小控制幅值 $m(x)$：对于给定的 $x \\neq 0$ 和固定的常数 $\\alpha \\in (0,1)$，使得 $\\dot{V}(x,u) \\leq -\\alpha x^{2}$ 的最小 $|u|$。\n- 待计算的极限：$L(\\alpha) = \\lim_{x \\to 0} \\, |x| \\, m(x)$。\n\n该问题在非线性控制理论领域有科学依据，问题设定良好，提供了所有必要信息，并使用客观、明确的数学语言进行表述。陈述不违反任何科学原理，不相互矛盾，并且任务结构逻辑清晰。因此，该问题被认为是有效的，可以构建一个形式化的解。\n\n第一个任务是验证 $V(x) = \\frac{1}{2} x^{2}$ 是系统 $\\dot{x} = x + x^{2} u$ 的一个CLF。\n函数 $V(x)$ 是正定的，因为对于所有 $x \\neq 0$ 都有 $V(x) > 0$ 且 $V(0) = 0$。它也是正常的（径向无界的），因为当 $|x| \\to \\infty$ 时 $V(x) \\to \\infty$。我们现在必须沿着系统轨迹分析其时间导数 $\\dot{V}$。\n使用链式法则，$V(x)$ 的时间导数为：\n$$ \\dot{V}(x,u) = \\frac{\\partial V}{\\partial x} \\dot{x} = \\frac{\\partial}{\\partial x} \\left(\\frac{1}{2} x^{2}\\right) (f(x) + g(x) u) $$\n代入给定的函数：\n$$ \\dot{V}(x,u) = x (x + x^{2} u) = x^{2} + x^{3} u $$\n用李导数的语言来说，即 $\\dot{V} = L_f V + (L_g V) u$，其中 $L_f V = \\frac{\\partial V}{\\partial x} f(x) = x \\cdot x = x^{2}$ 且 $L_g V = \\frac{\\partial V}{\\partial x} g(x) = x \\cdot x^{2} = x^{3}$。\n要使 $V(x)$ 成为一个CLF，对于任意状态 $x \\neq 0$，我们必须能够找到一个控制 $u$ 使得 $\\dot{V}(x,u)  0$。该条件为：\n$$ x^{2} + x^{3} u  0 $$\n对于任意 $x \\neq 0$，项 $L_g V = x^{3}$ 不为零。这是保证控制权限的关键性质。因此我们可以解出 $u$：\n$$ x^{3} u  -x^{2} $$\n如果 $x > 0$，则 $x^{3} > 0$，不等式变为 $u  -\\frac{x^{2}}{x^{3}} = -\\frac{1}{x}$。例如，可以选择 $u = -\\frac{2}{x}$。这得到 $\\dot{V} = x^2 + x^3(-\\frac{2}{x}) = x^2 - 2x^2 = -x^2  0$。\n如果 $x  0$，则 $x^{3}  0$，除以一个负数会反转不等号：$u > -\\frac{x^{2}}{x^{3}} = -\\frac{1}{x}$。例如，选择 $u = -\\frac{2}{x}$ 仍然有效。因为 $x0$，所以 $-\\frac{2}{x}>0$ 且 $-\\frac{1}{x}>0$。条件 $u > -\\frac{1}{x}$ 是满足的，因为当 $x0$ 时有 $-\\frac{2}{x} > -\\frac{1}{x}$。导数同样为 $\\dot{V} = -x^2  0$。\n因为对于任意 $x \\neq 0$，我们都可以显式地找到一个使 $\\dot{V}$ 为负的控制 $u$，所以函数 $V(x) = \\frac{1}{2} x^{2}$ 是给定系统的一个有效CLF。\n\n第二个任务是推导满足条件 $\\dot{V}(x,u) \\leq -\\alpha x^{2}$ 的最小控制幅值 $m(x)$，其中 $\\alpha \\in (0,1)$ 是一个固定值，且 $x \\neq 0$。\n该不等式为：\n$$ x^{2} + x^{3} u \\leq -\\alpha x^{2} $$\n整理各项，我们得到：\n$$ x^{3} u \\leq -x^{2} - \\alpha x^{2} = -(1+\\alpha) x^{2} $$\n我们必须找到满足此不等式且具有最小可能绝对值 $|u|$ 的控制 $u$。\n情况1：$x > 0$。则 $x^{3} > 0$。不等式为：\n$$ u \\leq -\\frac{(1+\\alpha)x^{2}}{x^{3}} = -\\frac{1+\\alpha}{x} $$\n容许控制的集合是 $u \\in (-\\infty, -\\frac{1+\\alpha}{x}]$。因为 $x > 0$ 且 $1+\\alpha > 0$，所以上界 $-\\frac{1+\\alpha}{x}$ 是负的。绝对值 $|u|$ 在该集合的边界处（即 $u$ 最接近零的地方）取最小值。因此，最小的 $|u|$ 是 $|-\\frac{1+\\alpha}{x}| = \\frac{1+\\alpha}{x}$。\n情况2：$x  0$。则 $x^{3}  0$。除以 $x^3$ 会反转不等号：\n$$ u \\geq -\\frac{(1+\\alpha)x^{2}}{x^{3}} = -\\frac{1+\\alpha}{x} $$\n容许控制的集合是 $u \\in [-\\frac{1+\\alpha}{x}, \\infty)$。因为 $x  0$ 且 $1+\\alpha > 0$，所以下界 $-\\frac{1+\\alpha}{x}$ 是正的。绝对值 $|u|$ 在此下界处取最小值。最小的 $|u|$ 是 $|-\\frac{1+\\alpha}{x}| = -\\frac{1+\\alpha}{x}$。\n结合两种情况，我们可以将最小控制幅值表示为 $x$ 的单一函数：\n$$ m(x) = \\begin{cases} \\frac{1+\\alpha}{x}  \\text{if } x>0 \\\\ -\\frac{1+\\alpha}{x}  \\text{if } x0 \\end{cases} $$\n这等价于紧凑表达式：\n$$ m(x) = \\frac{1+\\alpha}{|x|} $$\n\n第三个任务是计算极限 $L(\\alpha) = \\lim_{x \\to 0} \\, |x| \\, m(x)$。\n代入推导出的 $m(x)$ 表达式：\n$$ L(\\alpha) = \\lim_{x \\to 0} \\, |x| \\left(\\frac{1+\\alpha}{|x|}\\right) $$\n对于任意 $x \\neq 0$，分子和分母中的 $|x|$ 项相互抵消。\n$$ L(\\alpha) = \\lim_{x \\to 0} (1+\\alpha) $$\n表达式 $(1+\\alpha)$ 是一个关于 $x$ 的常数。因此，极限就是：\n$$ L(\\alpha) = 1+\\alpha $$\n\n最后一个任务是解释此结果对小控制性质 (SCP) 和连续镇定反馈存在性的影响。\n为达到指定衰减率所需的最小控制幅值 $m(x)$，在 $x$ 趋近于 $0$ 时表现为 $\\frac{1+\\alpha}{|x|}$。这意味着当 $x \\to 0$ 时 $m(x) \\to \\infty$。镇定系统所需的控制力在原点附近会趋于无穷大。\nSCP要求对于任意小的控制界限 $\\varepsilon > 0$，都存在原点的一个邻域（由 $\\delta > 0$ 定义），在该邻域内可以找到一个满足 $|u|  \\varepsilon$ 的镇定控制 $u$。\n我们对刚好使 $\\dot{V}  0$ 所需的最小控制的分析表明，必须有 $|u| > \\frac{1}{|x|}$。要找到一个控制 $|u|  \\varepsilon$，就必须有 $\\frac{1}{|x|}  \\varepsilon$，这意味着 $|x| > \\frac{1}{\\varepsilon}$。这个条件在邻域 $0  |x|  \\delta$ 内不可能对所有 $x$ 都成立，因为任何这样的邻域都包含 $|x|$ 任意接近于 $0$ 的点。因此，对于任何给定的 $\\varepsilon$，我们都找不到一个合适的 $\\delta$。小控制性质在原点处被违反。\nSontag 的一个基石性定理指出，一个系统能被连续状态反馈律 $u=k(x)$（其中 $k(0)=0$）渐近镇定的充要条件是，存在一个满足SCP的光滑CLF。\n由于我们的CLF——实际上是该系统的任何CLF——在原点处都不能满足SCP，我们得出结论，没有任何连续反馈律可以渐近镇定该系统的原点。这是一个更普遍原理的体现，通常与 Brockett 连续镇定必要条件有关，该条件在此处被违反，因为控制向量场 $g(x)=x^2$ 在原点处的消失速度快于漂移向量场 $f(x)=x$，从而无法提供足够的控制权限。$L(\\alpha)$ 的非零值是这种失效的定量指标。", "answer": "$$ \\boxed{1+\\alpha} $$", "id": "2695614"}]}