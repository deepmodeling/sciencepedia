## 引言
在[非线性系统](@entry_id:168347)控制理论中，[李雅普诺夫第二方法](@entry_id:168377)是分析[系统稳定性](@entry_id:273248)的基石。然而，该方法的应用面临一个核心挑战：如何为给定的[非线性系统](@entry_id:168347)找到一个合适的李雅普诺夫函数。这通常被认为是一门艺术而非科学，因为它缺乏通用的、系统性的构造法则。[克拉索夫斯基方法](@entry_id:172704)（Krasovskii's method）正是为了应对这一挑战而提出的一种强大而直观的构造性工具。它通过一种特定的函数形式，将寻找[李雅普诺夫函数](@entry_id:273986)的问题转化为一个更具结构性的[矩阵分析](@entry_id:204325)问题，极大地简化了[稳定性分析](@entry_id:144077)过程。

本文旨在系统性地介绍[克拉索夫斯基方法](@entry_id:172704)。读者将通过以下三个章节，从理论到实践全面掌握这一重要工具：
- 在“原理与机制”一章中，我们将深入探讨该方法的核心构造、数学推导、几何直观以及其[适用范围](@entry_id:636189)与内在局限。
- 在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示该方法如何在定量分析（如[吸引域估计](@entry_id:178734)）、鲁棒控制设计以及与最优化、收缩分析等理论的[交叉](@entry_id:147634)领域中发挥作用。
- 最后，在“动手实践”部分，通过一系列精心设计的问题，读者将亲手应用所学知识，巩固对核心概念的理解。

现在，让我们从[克拉索夫斯基方法](@entry_id:172704)的基本原理出发，进入第一章的学习。

## 原理与机制

继前一章对[李雅普诺夫稳定性理论](@entry_id:177166)的介绍之后，本章将深入探讨一种构造李雅普诺夫函数的系统性方法——[克拉索夫斯基方法](@entry_id:172704)（Krasovskii's method）。该方法为分析非线性系统 $\dot{x} = f(x)$ 的稳定性提供了一种强大而直观的工具。我们将从其核心构造出发，系统地阐述其基本原理、推导过程、几何直观以及适用范围与局限性。

### 克拉索夫斯基候选函数：定义与性质

对于一个自治[非线性系统](@entry_id:168347) $\dot{x} = f(x)$，其中 $x \in \mathbb{R}^n$ 是状态向量，且 $f: \mathbb{R}^n \to \mathbb{R}^n$ 在原点附近是连续可微的，并满足 $f(0)=0$（即原点是一个[平衡点](@entry_id:272705)），[克拉索夫斯基方法](@entry_id:172704)提出了一类特定的李雅普诺夫候选函数：

$V(x) = f(x)^{\top} P f(x)$

其中，$P \in \mathbb{R}^{n \times n}$ 是一个待选择的常数矩阵。为了使该函数成为一个有效的[李雅普诺夫函数](@entry_id:273986)，我们需要对 $f(x)$ 和 $P$ 施加一些基本假设。

首先，为了保证 $V(x)$ 的光滑性，从而能够计算其导数，我们需要 $f(x)$ 至少是 **连续可微** 的（即属于 $C^1$ 类）。由于 $V(x)$ 是 $f(x)$ 的二次型，而二次型本身是光滑的，根据复合函数[求导法则](@entry_id:145443)，$f(x)$ 的 $C^1$ 性质确保了 $V(x)$ 也是 $C^1$ 的 [@problem_id:2716041]。

其次，矩阵 $P$ 的选择至关重要。在构造中，我们通常要求 $P$ 是一个 **对称正定矩阵** ($P = P^{\top} \succ 0$)。这一要求的理由如下 [@problem_id:2716046]：

1.  **对称性**：对于任何向量 $y$ 和矩阵 $P$，二次型 $y^{\top} P y$ 的值等同于 $y^{\top} \left(\frac{P + P^{\top}}{2}\right) y$。这意味着二次型的值仅取决于 $P$ 的对称部分。因此，从一开始就假设 $P$ 是对称的，并不会损失[一般性](@entry_id:161765)，反而简化了分析。

2.  **[正定性](@entry_id:149643)**：为了使 $V(x)$ 成为一个李雅普诺夫函数，它必须是正定的。当 $P$ 是正定矩阵时，根据[正定矩阵](@entry_id:155546)的定义，$y^{\top} P y > 0$ 对所有非[零向量](@entry_id:156189) $y$ 成立。将 $y$ 替换为 $f(x)$，我们得到 $V(x) = f(x)^{\top} P f(x) \ge 0$。等号成立的唯一条件是 $f(x) = 0$。

综合以上两点，一个正定的 $P$ 确保了 $V(x)$ 是 **正半定** 的。然而，[李雅普诺夫函数](@entry_id:273986)需要关于状态 $x$ 是正定的，即 $V(0)=0$ 且对于所关注的区域中的所有 $x \neq 0$，$V(x) > 0$。这引出了对向量场 $f(x)$ 自身的一个关键要求：在所考虑的邻域 $\mathcal{D}$ 内，方程 $f(x)=0$ 的唯一解是 $x=0$。换言之，原点是该邻域内唯一的[平衡点](@entry_id:272705)。只有满足这个条件，我们才能确保当 $x \neq 0$ 时 $f(x) \neq 0$，进而保证 $V(x) = f(x)^{\top} P f(x) > 0$，从而使 $V(x)$ 成为一个关于状态 $x$ 的正定函数 [@problem_id:2716025] [@problem_id:2716046]。

### 时间导数：推导与稳定性条件

确定了候选函数 $V(x)$ 的[正定性](@entry_id:149643)之后，下一步是计算其沿着系统轨迹的时间导数 $\dot{V}(x)$，并分析其符号。根据链式[求导法则](@entry_id:145443)，我们有：

$\dot{V}(x) = \frac{d}{dt} \left( f(x(t))^{\top} P f(x(t)) \right) = \left(\frac{d f(x)}{dt}\right)^{\top} P f(x) + f(x)^{\top} P \left(\frac{d f(x)}{dt}\right)$

其中，$x(t)$ 是系统 $\dot{x}=f(x)$ 的一条轨迹。对 $f(x(t))$ 关于时间 $t$ 求导，再次使用链式法则，并注意到 $\dot{x} = f(x)$：

$\frac{d f(x)}{dt} = \frac{\partial f}{\partial x} \frac{dx}{dt} = Df(x) f(x)$

这里 $Df(x)$ (有时也记为 $J(x)$) 是 $f(x)$ 在点 $x$ 的雅可比矩阵。将此结果代入 $\dot{V}(x)$ 的表达式中，我们得到：

$\dot{V}(x) = (Df(x)f(x))^{\top} P f(x) + f(x)^{\top} P (Df(x)f(x))$

$\dot{V}(x) = f(x)^{\top} Df(x)^{\top} P f(x) + f(x)^{\top} P Df(x) f(x)$

整理后得到一个关于 $f(x)$ 的二次型：

$\dot{V}(x) = f(x)^{\top} \left( Df(x)^{\top} P + P Df(x) \right) f(x)$

为了简化表达，我们定义一个对称矩阵场 $S(x) = Df(x)^{\top} P + P Df(x)$。于是，$\dot{V}(x)$ 的最终形式为：

$\dot{V}(x) = f(x)^{\top} S(x) f(x)$

这个表达式是[克拉索夫斯基方法](@entry_id:172704)的核心。$\dot{V}(x)$ 的符号完全由矩阵 $S(x)$ 的性质和向量 $f(x)$ 决定 [@problem_id:2715982]。

-   **严格负定情况**：如果我们可以选择一个 $P \succ 0$，使得 $S(x)$ 在我们关心的区域内（除原点外）是 **负定** 的 ($S(x) \prec 0$)，那么对于任何使得 $f(x) \neq 0$ 的 $x$，我们都有 $\dot{V}(x)  0$。结合之前 $V(x)$ 正定的条件（即 $f(x)=0 \iff x=0$），这意味着 $\dot{V}(x)$ 是一个关于 $x$ 的负定函数。根据[李雅普诺夫第二方法](@entry_id:168377)，这直接证明了原点的（局部）[渐近稳定性](@entry_id:149743)，无需更复杂的分析 [@problem_id:2716007] [@problem_id:2721563]。

-   **半负定情况**：在许多情况下，要找到一个使 $S(x)$ 严格负定的 $P$ 是困难的，或者是不可能的。我们可能只能确保 $S(x)$ 是 **半负定** 的 ($S(x) \preceq 0$)。在这种情况下，我们只能得到 $\dot{V}(x) \le 0$。这意味着 $V(x)$ 沿着轨迹是单调不增的，这只能保证原点的（李雅普诺夫）稳定性，但不能直接断定[渐近稳定性](@entry_id:149743) [@problem_id:2716007]。因为系统轨迹可能收敛到一个使 $\dot{V}(x) = 0$ 但 $x \neq 0$ 的点或集合。

为了在半负定情况下证明[渐近稳定性](@entry_id:149743)，我们必须借助 **[拉萨尔不变性原理](@entry_id:266201) (LaSalle's Invariance Principle)**。该原理指出，如果轨迹保持在一个紧集中，它将收敛到集合 $E = \{x \mid \dot{V}(x) = 0\}$ 内的最大的[不变集](@entry_id:275226) $M$。在我们的构造中，$\dot{V}(x) = f(x)^{\top} S(x) f(x) = 0$ 的条件可以由 $f(x) = 0$ 满足。如果 $S(x)$ 在我们感兴趣的区域是负定的，则 $\dot{V}(x) = 0$ 的充要条件就是 $f(x)=0$。因此，集合 $E$ 就是系统的[平衡点](@entry_id:272705)集 $\{x \mid f(x) = 0\}$ [@problem_id:2715982]。如果该集合中最大的[不变集](@entry_id:275226)仅包含原点（例如，如果原点是唯一的[平衡点](@entry_id:272705)），那么所有从该邻域出发的轨迹都将收敛到原点，从而证明了[渐近稳定性](@entry_id:149743) [@problem_id:2716025]。

一个简单的例子可以阐明[不变集](@entry_id:275226)分析的必要性：考虑[线性系统](@entry_id:147850) $\dot{x} = Ax$，其中 $A = \mathrm{diag}(-1, 0)$。使用[克拉索夫斯基方法](@entry_id:172704)，可以证明 $\dot{V}(x) = -2p_{11}x_1^2 \le 0$（假设 $P$ 是对角的）。这里 $\dot{V}(x)=0$ 的集合是整个 $x_2$ 轴 ($x_1=0$)。由于[系统动力学](@entry_id:136288)为 $\dot{x}_1=-x_1, \dot{x}_2=0$， $x_2$ 轴本身就是一个[不变集](@entry_id:275226)（事实上，它由无穷多个[平衡点](@entry_id:272705)构成）。因此，从非原点的 $x_2$ 轴上一点出发的轨迹将永远停留在那里，不会收敛到原点。所以系统只是稳定的，而不是渐近稳定的 [@problem_id:2716007]。

### 几何直观与局部性分析

理解不同李雅普诺夫函数形式的几何意义对于培养直觉至关重要。让我们比较克拉索夫斯[基函数](@entry_id:170178) $V(x) = f(x)^{\top} P f(x)$ 与更经典的二次型李雅普诺夫函数 $W(x) = x^{\top} P x$ [@problem_id:2715977]。

-   $W(x)$ 的[等值面](@entry_id:196027) $\{x \mid W(x) = c\}$ 是状态空间 $\mathbb{R}^n$ 中以原点为中心的椭球。这些椭球直接界定了[状态向量](@entry_id:154607) $x$ 的范数（在由 $P$ 定义的加权范数 $\|x\|_P$ 意义下）大小的区域。
-   $V(x)$ 的[等值面](@entry_id:196027) $\{x \mid V(x) = c\}$ 则具有不同的几何意义。它界定的是向量场 $f(x)$ 范数大小的区域。具体来说，该[等值面](@entry_id:196027)是速度空间（$f$ 的值域）中椭球 $\{y \mid y^{\top} P y = c\}$ 在函数 $f$ 下的原像 (preimage)。这意味着 $V(x)$ 小的区域是系统“速度” $f(x)$ 慢的区域。这些区域可能并不局限于原点附近，特别是当系统存在多个[平衡点](@entry_id:272705)时。

这两[类函数](@entry_id:146970)在原点附近的联系尤为重要。如果 $f(x)$ 在原点的[雅可比矩阵](@entry_id:264467) $J(0) = Df(0)$ 是非奇异的，那么根据泰勒展开，$f(x) \approx J(0)x$ 对于小的 $x$ 成立。此时，$V(x) = f(x)^{\top} P f(x) \approx (J(0)x)^{\top} P (J(0)x) = x^{\top} (J(0)^{\top} P J(0)) x$。这是一个关于 $x$ 的新二次型。由于 $J(0)$ 和 $P$ 都是正定的，可以证明在原点附近，$V(x)$ 和 $W(x)$ 是等价的，即存在正常数 $\alpha_1, \alpha_2$ 使得 $\alpha_1 W(x) \le V(x) \le \alpha_2 W(x)$ 成立。这意味着在局部，它们的[等值面](@entry_id:196027)具有相似的几何形状，都表现为椭球 [@problem_id:2715977]。

这种局部等价性引出了[克拉索夫斯基方法](@entry_id:172704)与 **线性化原理** 之间的深刻联系。我们如何能保证存在一个 $P \succ 0$ 使得稳定性条件成立呢？考虑在原点 $x=0$ 处，$S(0) = Df(0)^{\top} P + P Df(0)$。如果这个矩阵是负定的，那么根据连续性，在原点的一个小邻域内 $S(x)$ 也将是负定的。这确保了 $\dot{V}(x)$ 在该邻域内是负定的，从而证明了局部[渐近稳定性](@entry_id:149743)。

问题转化为：对于给定的 $Df(0)$，是否存在一个 $P \succ 0$ 使得 $Df(0)^{\top} P + P Df(0) \prec 0$？这正是[线性系统理论](@entry_id:172825)中著名的 **[李雅普诺夫方程](@entry_id:165178)**。一个核心结论是：这样的 $P \succ 0$ 存在的充分必要条件是矩阵 $Df(0)$ **赫尔维茨 (Hurwitz)**，即其所有[特征值](@entry_id:154894)的实部都为负。因此，如果系统的线性化矩阵 $Df(0)$ 是稳定的，[克拉索夫斯基方法](@entry_id:172704)保证了能够找到一个局部的李雅普诺夫函数来证明原非线性系统的局部[渐近稳定性](@entry_id:149743) [@problem_id:2716015]。

### 全局稳定性与方法局限性

[克拉索夫斯基方法](@entry_id:172704)同样可以用于分析 **[全局渐近稳定性](@entry_id:187629) (GAS)**。为此，除了 $V(x)$ 正定和 $\dot{V}(x)$ 负定之外，我们还需要 $V(x)$ 是 **径向无界 (radially unbounded)** 的，即当 $\|x\| \to \infty$ 时，$V(x) \to \infty$。

对于 $V(x) = f(x)^{\top} P f(x)$，由于 $V(x) \ge \lambda_{\min}(P) \|f(x)\|^2$，要使其径向无界，一个充分条件是 $\|f(x)\|$ 随着 $\|x\|$ 的增长而无限增长。更形式化地说，如果 $f$ 是一个 **[正常映射](@entry_id:158587) (proper map)**，即当 $\|x\| \to \infty$ 时，$\|f(x)\| \to \infty$，则 $V(x)$ 是径向无界的。这个条件也可以用一个 $\mathcal{K}_\infty$ 类函数 $\gamma$ 来描述，即存在 $\gamma$ 使得 $\|f(x)\| \ge \gamma(\|x\|)$ 对所有 $x$ 成立。若同时满足原点是唯一[平衡点](@entry_id:272705)且 $\dot{V}(x)$ 在全局负定，则可以证明系统的[全局渐近稳定性](@entry_id:187629) [@problem_id:2716034]。

尽管[克拉索夫斯基方法](@entry_id:172704)非常强大，但理解其 **局限性** 也同样重要。它是一种 **构造性** 方法，提供了一种特定的函数形式。然而，并非所有稳定的系统都能用这种形式的函数来证明其稳定性。这与 **李雅普诺夫逆定理 (converse Lyapunov theorems)** 形成了对比，后者是 **存在性** 定理，它保证对于一个（渐近）稳定的系统，一定存在一个（光滑的）李雅普诺夫函数，但并不指明其具体形式。

一个经典的例子是系统 $\dot{x} = -\frac{x}{1+x^2}$。我们可以用 $V_0(x) = \frac{1}{2}x^2$ 轻松证明其[全局渐近稳定性](@entry_id:187629)。然而，如果我们尝试使用克拉索夫斯基候选函数 $V(x) = p f(x)^2 = p \frac{x^2}{(1+x^2)^2}$（其中 $p>0$），计算其导数会发现 $\dot{V}(x) = -\frac{2p x^2(1-x^2)}{(1+x^2)^4}$。当 $|x|>1$ 时，$\dot{V}(x)>0$，这意味着 $V(x)$ 在该区域是增加的，因此它不能作为全局李雅普诺夫函数。这个例子清晰地表明，[克拉索夫斯基方法](@entry_id:172704)（在常数 $P$ 的形式下）的失败并不意味着系统不稳定，而仅仅是这种特定的函数形式不适用 [@problem_id:2716018]。

这种失败的根源在于，该方法的成功依赖于雅可比矩阵 $Df(x)$ 的性质。在上述例子中，$Df(x) = \frac{x^2-1}{(1+x^2)^2}$ 的符号是变化的，导致 $\dot{V}(x)$ 的符号也随之变化。

值得一提的是，对于[线性时不变 (LTI) 系统](@entry_id:178866) $\dot{x}=Ax$，如果系统稳定（即 $A$ 是赫尔维茨矩阵），[克拉索夫斯基方法](@entry_id:172704)总是有效的。在这种情况下，$f(x)=Ax$，$V(x) = x^{\top}(A^{\top}PA)x$ 本身就是一个标准的二次型李雅普诺夫函数，其稳定性条件与标准的[李雅普诺夫方程](@entry_id:165178)完全一致，因此该方法对于[LTI系统](@entry_id:271946)而言并无局限性 [@problem_id:2716018]。此外，为了克服常数 $P$ 的局限性，研究者们也发展了使用状态依赖矩阵 $P(x)$ 的更广义的方法，但这超出了本章的基础范围。