{"hands_on_practices": [{"introduction": "归一化互质分解（Normalized Coprime Factorization, NCF）是现代鲁棒控制理论的基石，尤其在 $H_\\infty$ 回路成形设计中至关重要。[@problem_id:2711277]该练习将指导你通过谱分解方法，为一个简单的系统推导出其具体的因子。这项实践有助于你巩固对NCF数学结构的理解，并为后续更复杂的鲁棒性分析打下坚实的基础。", "problem": "考虑连续时间单输入单输出 (SISO) 的实有理、稳定且真的传递函数 $G(s) = \\dfrac{s+1}{s+2}$。在 $\\mathcal{RH}_{\\infty}$（具有有限哈代空间H-无穷大（$H_\\infty$）范数的实有理、真且内部稳定的传递函数集合）中，$G$ 的一个归一化左互质分解是一对 $(\\tilde{M},\\tilde{N})$，其中 $\\tilde{M},\\tilde{N}\\in\\mathcal{RH}_{\\infty}$，使得 $G = \\tilde{M}^{-1}\\tilde{N}$ 且 $\\tilde{M}^{\\sim}\\tilde{M} + \\tilde{N}^{\\sim}\\tilde{N} = 1$。其中，伴随对合对于SISO实有理函数定义为 $X^{\\sim}(s) \\equiv X(-s)$。请从第一性原理推导并计算给定 $G(s)$ 的一个显式归一化左互质分解 $G = \\tilde{M}^{-1}\\tilde{N}$，并验证归一化条件成立。请以闭合形式的单行矩阵 $\\begin{pmatrix} \\tilde{M}(s)  \\tilde{N}(s) \\end{pmatrix}$ 提供你的最终答案。无需四舍五入，也不涉及单位。", "solution": "该问题经过审查，被认定为有效。这是一个在现代控制理论既定框架内的良态问题，具体涉及稳定传递函数的归一化互质分解，这是$\\mathcal{H}_{\\infty}$控制和鲁棒系统设计中的一个基本概念。所有提供的信息都是完整、一致且科学上合理的。我们现在开始推导。\n\n问题要求计算给定传递函数 $G(s) = \\dfrac{s+1}{s+2}$ 的归一化左互质分解。一对传递函数 $(\\tilde{M}(s), \\tilde{N}(s))$ 构成这样一个分解，需满足以下三个条件：\n1. 稳定性和真性：$\\tilde{M}, \\tilde{N} \\in \\mathcal{RH}_{\\infty}$，其中 $\\mathcal{RH}_{\\infty}$ 是实有理、真且稳定的传递函数集合。\n2. 分解：$G(s) = \\tilde{M}(s)^{-1}\\tilde{N}(s)$，或等价地，$\\tilde{N}(s) = \\tilde{M}(s)G(s)$。\n3. 归一化：$\\tilde{M}^{\\sim}(s)\\tilde{M}(s) + \\tilde{N}^{\\sim}(s)\\tilde{N}(s) = 1$，其中伴随定义为 $X^{\\sim}(s) = X(-s)$。\n\n给定的系统 $G(s)$ 是稳定的，因为其唯一的极点在 $s = -2$，位于开左半复平面。对于一个稳定的系统 $G(s)$，一个左互质分解可以构造成 $(\\tilde{M}, \\tilde{N}) = (U, UG)$ 的形式，其中 $U$ 必须是 $\\mathcal{RH}_{\\infty}$ 中的一个所谓*单位*。单位是一个函数 $U \\in \\mathcal{RH}_{\\infty}$，其逆 $U^{-1}$ 也属于 $\\mathcal{RH}_{\\infty}$。对于有理传递函数，这意味着 $U(s)$ 必须是稳定的、真的，并且在闭合右半平面没有零点（即，它必须是最小相位的）。\n\n我们将 $\\tilde{N}(s) = \\tilde{M}(s)G(s)$ 代入归一化条件。由于我们处理的是单输入单输出 (SISO) 系统，所有传递函数都是标量，因此它们的乘法是可交换的。\n$$ \\tilde{M}^{\\sim}\\tilde{M} + (\\tilde{M}G)^{\\sim}(\\tilde{M}G) = 1 $$\n$$ \\tilde{M}^{\\sim}\\tilde{M} + G^{\\sim}\\tilde{M}^{\\sim}G\\tilde{M} = 1 $$\n$$ \\tilde{M}^{\\sim}\\tilde{M} + G^{\\sim}G\\tilde{M}^{\\sim}\\tilde{M} = 1 $$\n$$ \\tilde{M}^{\\sim}\\tilde{M}(1 + G^{\\sim}G) = 1 $$\n由此，我们推导出乘积 $\\tilde{M}^{\\sim}\\tilde{M}$ 的表达式：\n$$ \\tilde{M}^{\\sim}(s)\\tilde{M}(s) = \\left(1 + G^{\\sim}(s)G(s)\\right)^{-1} $$\n现在我们来计算 $1 + G^{\\sim}(s)G(s)$ 这一项。给定 $G(s) = \\frac{s+1}{s+2}$，其伴随为 $G^{\\sim}(s) = G(-s) = \\frac{-s+1}{-s+2} = \\frac{1-s}{2-s}$。\n乘积 $G^{\\sim}(s)G(s)$ 为：\n$$ G^{\\sim}(s)G(s) = \\left(\\frac{1-s}{2-s}\\right)\\left(\\frac{s+1}{s+2}\\right) = \\frac{-(s-1)(s+1)}{-(s-2)(s+2)} = \\frac{s^2-1}{s^2-4} $$\n现在我们计算 $1 + G^{\\sim}(s)G(s)$：\n$$ 1 + G^{\\sim}(s)G(s) = 1 + \\frac{s^2-1}{s^2-4} = \\frac{(s^2-4) + (s^2-1)}{s^2-4} = \\frac{2s^2-5}{s^2-4} $$\n因此，关于 $\\tilde{M}(s)$ 的方程变为：\n$$ \\tilde{M}^{\\sim}(s)\\tilde{M}(s) = \\left(\\frac{2s^2-5}{s^2-4}\\right)^{-1} = \\frac{s^2-4}{2s^2-5} $$\n为了求得 $\\tilde{M}(s)$，我们必须对右侧进行谱分解。函数 $\\tilde{M}(s)$ 对应于我们最初将其表述为单位 $U$ 的 $\\tilde{M}$。因此，$\\tilde{M}(s)$ 必须是稳定且最小相位的。首先，我们求表达式 $\\frac{s^2-4}{2s^2-5}$ 的极点和零点：\n- 零点由 $s^2-4 = 0$ 给出，得到 $s = \\pm 2$。\n- 极点由 $2s^2-5 = 0$ 给出，得到 $s^2 = \\frac{5}{2}$，所以 $s = \\pm\\sqrt{\\frac{5}{2}}$。\n\n我们可以将表达式写为：\n$$ \\tilde{M}^{\\sim}(s)\\tilde{M}(s) = \\frac{(s-2)(s+2)}{2\\left(s-\\sqrt{\\frac{5}{2}}\\right)\\left(s+\\sqrt{\\frac{5}{2}}\\right)} $$\n为了使 $\\tilde{M}(s)$ 稳定，其极点必须在开左半复平面内。$\\tilde{M}^{\\sim}\\tilde{M}$ 的极点在 $\\pm\\sqrt{\\frac{5}{2}}$。因此，稳定极点是 $s = -\\sqrt{\\frac{5}{2}}$，这必须是 $\\tilde{M}(s)$ 的极点。\n为了使 $\\tilde{M}(s)$ 是最小相位的，其零点必须在开左半平面内。$\\tilde{M}^{\\sim}\\tilde{M}$ 的零点在 $\\pm 2$。左半平面零点是 $s = -2$，这必须是 $\\tilde{M}(s)$ 的零点。\n\n基于此，$\\tilde{M}(s)$ 的结构必须是 $c \\frac{s+2}{s+\\sqrt{5/2}}$ 的形式，其中 $c$ 为某个常数。为了确定 $c$，我们可以计算当 $s \\to \\infty$ 时的极限：\n$$ \\lim_{s\\to\\infty} \\tilde{M}^{\\sim}(s)\\tilde{M}(s) = \\lim_{s\\to\\infty} \\frac{s^2-4}{2s^2-5} = \\frac{1}{2} $$\n对于我们选择的 $\\tilde{M}(s)$ 形式：\n$$ \\lim_{s\\to\\infty} \\left(c \\frac{-s+2}{-s+\\sqrt{5/2}}\\right)\\left(c \\frac{s+2}{s+\\sqrt{5/2}}\\right) = \\lim_{s\\to\\infty} c^2 \\left(\\frac{s-2}{s-\\sqrt{5/2}}\\right)\\left(\\frac{s+2}{s+\\sqrt{5/2}}\\right) = c^2 $$\n令两者相等得到 $c^2 = \\frac{1}{2}$，这意味着 $c = \\frac{1}{\\sqrt{2}}$。按照惯例，我们选择正实根。\n因此，我们求得 $\\tilde{M}(s)$：\n$$ \\tilde{M}(s) = \\frac{1}{\\sqrt{2}} \\frac{s+2}{s+\\sqrt{\\frac{5}{2}}} = \\frac{s+2}{\\sqrt{2}s+\\sqrt{5}} $$\n现在我们使用关系式 $\\tilde{N}(s) = \\tilde{M}(s)G(s)$ 来求 $\\tilde{N}(s)$：\n$$ \\tilde{N}(s) = \\left(\\frac{s+2}{\\sqrt{2}s+\\sqrt{5}}\\right) \\left(\\frac{s+1}{s+2}\\right) $$\n项 $(s+2)$ 被消去，得到：\n$$ \\tilde{N}(s) = \\frac{s+1}{\\sqrt{2}s+\\sqrt{5}} $$\n我们必须验证这对 $(\\tilde{M}, \\tilde{N})$ 满足所有条件。\n1.  $\\tilde{M}(s) = \\frac{s+2}{\\sqrt{2}s+\\sqrt{5}}$ 和 $\\tilde{N}(s) = \\frac{s+1}{\\sqrt{2}s+\\sqrt{5}}$ 都在 $s = -\\frac{\\sqrt{5}}{\\sqrt{2}} = -\\sqrt{\\frac{5}{2}}$ 处有一个单极点，该极点位于左半平面。两者都是真的（分子阶数等于分母阶数）。因此，$\\tilde{M}, \\tilde{N} \\in \\mathcal{RH}_{\\infty}$。\n2.  分解式 $G=\\tilde{M}^{-1}\\tilde{N}$ 根据构造过程成立。\n3.  互质条件得到满足，因为 $\\tilde{M}(s)$ 和 $\\tilde{N}(s)$ 在闭合右半平面没有公共零点。$\\tilde{M}(s)$ 的零点在 $s=-2$，$\\tilde{N}(s)$ 的零点在 $s=-1$。没有公共零点。\n4.  归一化条件 $\\tilde{M}^{\\sim}\\tilde{M} + \\tilde{N}^{\\sim}\\tilde{N} = 1$ 由我们最初的谱分解所保证。\n\n最终结果是这对传递函数 $(\\tilde{M}(s), \\tilde{N}(s))$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{s+2}{\\sqrt{2}s+\\sqrt{5}}  \\frac{s+1}{\\sqrt{2}s+\\sqrt{5}} \\end{pmatrix}}\n$$", "id": "2711277"}, {"introduction": "在掌握了如何计算归一化互质因子后，理解这种表示为何如此重要是关键的一步。[@problem_id:2711266]本练习旨在直接比较NCF框架所保证的鲁棒稳定裕度与经典乘性不确定性模型下的裕度。通过这个例子，你将对不同不确定性模型的保守性有一个定量的认识，并能更好地体会NCF方法的全面性。", "problem": "考虑在 $H_\\infty$ 回路成形设计框架下的单位负反馈互联结构，其中包含一个单输入/单输出 (SISO) 标称对象和一个控制器。设标称对象为 $G(s) = \\dfrac{1}{s+1}$，控制器为静态增益 $K(s) = 1$。假设不存在外部输入（调节问题）。\n\n考虑两种不确定性描述：\n\n1. 乘性输出不确定性：真实对象为 $G_{\\Delta}(s) = \\bigl(1 + \\Delta(s)\\bigr) G(s)$，其中 $\\Delta(s)$ 是稳定的且满足 $\\|\\Delta\\|_{\\infty} \\leq \\delta$，$H_\\infty$-范数定义为 $\\|F\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}\\bigl(F(\\mathrm{j}\\omega)\\bigr)$，其中 $\\bar{\\sigma}$ 表示最大奇异值。互补灵敏度为 $T(s) = G(s)K(s)\\bigl(I + G(s)K(s)\\bigr)^{-1}$。以小增益定理为基本出发点，求出保证此描述下鲁棒内部稳定性的最大容许半径 $\\delta$，并用 $T(s)$ 表示。\n\n2. 归一化右互质因式 (NCF) 对象不确定性：标称对象有一个归一化右互质分解 $G(s) = N(s)M(s)^{-1}$，其中 $M(s)$ 和 $N(s)$ 是稳定的且满足标准归一化条件。真实对象为 $(N(s) + \\Delta_{N}(s))\\bigl(M(s) + \\Delta_{M}(s)\\bigr)^{-1}$，其中 $\\Delta_{N}(s)$ 和 $\\Delta_{M}(s)$ 是稳定的，并堆叠为 $\\Delta(s) = \\begin{bmatrix} \\Delta_{M}(s)  \\Delta_{N}(s) \\end{bmatrix}$，其约束为 $\\|\\Delta\\|_{\\infty} \\leq \\varepsilon$。从小的增益定理和归一化互质不确定性互联结构出发，用一个仅依赖于 $G(s)$ 和 $K(s)$ 的闭环传递矩阵来表示保证鲁棒内部稳定性的最大容许半径 $\\varepsilon$（最终表达式中不应显式依赖于互质因式的具体选择）。\n\n将这两个鲁棒性裕度针对给定的 $G(s)$ 和 $K(s)$ 进行特化，计算它们的精确值，然后通过计算比值\n$$\nR \\equiv \\frac{\\text{乘性裕度}}{\\text{NCF 裕度}}.\n$$\n来量化归一化互质因式鲁棒性相对于乘性输出不确定性的保守性。\n请给出 $R$ 的最终答案，形式为一个精确的实数（无单位）。不要引入任何额外的权重；取乘性输出权重为单位矩阵 ($W(s) = 1$)。不要进行近似；无需四舍五入。", "solution": "所述问题经过严格验证。\n\n步骤1：提取已知条件。\n-   系统配置：单位负反馈，单输入/单输出 (SISO)。\n-   标称对象：$G(s) = \\dfrac{1}{s+1}$。\n-   控制器：$K(s) = 1$。\n-   输入：零外部输入。\n-   不确定性模型1（乘性输出）：\n    -   扰动对象：$G_{\\Delta}(s) = \\bigl(1 + \\Delta(s)\\bigr) G(s)$。\n    -   不确定性：$\\Delta(s)$ 是稳定的且 $\\|\\Delta\\|_{\\infty} \\leq \\delta$。\n    -   目标：找到保证鲁棒稳定性的最大 $\\delta$。\n-   不确定性模型2（归一化右互质因式 - NCF）：\n    -   标称分解：$G(s) = N(s)M(s)^{-1}$，其中 $N(s)$、$M(s)$ 是稳定的且满足归一化条件。\n    -   扰动对象：$(N(s) + \\Delta_{N}(s))\\bigl(M(s) + \\Delta_{M}(s)\\bigr)^{-1}$。\n    -   不确定性：$\\Delta(s) = \\bigl[\\Delta_{M}(s)\\ \\ \\Delta_{N}(s)\\bigr]$ 是稳定的且 $\\|\\Delta\\|_{\\infty} \\leq \\varepsilon$。\n    -   目标：找到保证鲁棒稳定性的最大 $\\varepsilon$。\n-   最终计算：计算比值 $R = \\frac{\\delta}{\\varepsilon}$。\n\n步骤2：验证。\n-   **科学依据**：该问题基于鲁棒控制理论的基本概念，即小增益定理、乘性不确定性和归一化互质因式不确定性。这些都是标准且成熟的课题。该问题在科学上是合理的。\n-   **适定性**：该问题提供了一个完全指定的标称系统 ($G(s)$, $K(s)$) 和两种明确定义的不确定性结构。它要求计算唯一且有意义的量（鲁棒性裕度 $\\delta$ 和 $\\varepsilon$）及其比值。\n-   **客观性**：语言精确、技术性强，且不含主观内容。\n\n步骤3：结论。\n该问题在科学上是有效的、适定的和客观的。它包含一套完整且一致的数据和约束。将提供解答。\n\n解答过程分三部分进行：首先，计算乘性不确定性裕度；其次，计算归一化互质因式不确定性裕度；第三，计算它们的比值。\n\n第一部分：乘性输出不确定性裕度\n包含扰动对象 $G_{\\Delta}(s) = (1+\\Delta(s))G(s)$ 和控制器 $K(s)$ 的单位负反馈回路必须进行鲁棒稳定性分析。标准方法是重排框图以分离出不确定性 $\\Delta(s)$。这种布置导致在稳定的标称闭环传递函数和不确定性模块 $\\Delta(s)$ 之间形成一个反馈连接。不确定性模块从其输出到其输入所“看到”的传递函数是互补灵敏度函数 $T(s) = G(s)K(s)\\bigl(1 + G(s)K(s)\\bigr)^{-1}$。\n\n根据小增益定理，对于所有满足 $\\|\\Delta\\|_{\\infty} \\leq \\delta$ 的稳定不确定性 $\\Delta(s)$，闭环系统保持内部稳定的充要条件是 $\\|T(s)\\Delta(s)\\|_{\\infty}  1$。如果 $\\|T\\|_{\\infty} \\|\\Delta\\|_{\\infty}  1$，则该条件得到保证。因此，最大容许半径 $\\delta$ 由互补灵敏度函数的 $H_{\\infty}$-范数的倒数给出：\n$$\n\\delta = \\frac{1}{\\|T(s)\\|_{\\infty}}\n$$\n对于给定的标称对象 $G(s) = \\frac{1}{s+1}$ 和控制器 $K(s) = 1$，回路传递函数为 $L(s) = G(s)K(s) = \\frac{1}{s+1}$。\n互补灵敏度函数为：\n$$\nT(s) = \\frac{L(s)}{1+L(s)} = \\frac{\\frac{1}{s+1}}{1+\\frac{1}{s+1}} = \\frac{1}{(s+1)+1} = \\frac{1}{s+2}\n$$\n$H_{\\infty}$-范数是频率响应的峰值幅度：\n$$\n\\|T\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |T(j\\omega)| = \\sup_{\\omega \\in \\mathbb{R}} \\left|\\frac{1}{j\\omega+2}\\right| = \\sup_{\\omega \\in \\mathbb{R}} \\frac{1}{\\sqrt{\\omega^2 + 2^2}} = \\sup_{\\omega \\in \\mathbb{R}} \\frac{1}{\\sqrt{\\omega^2 + 4}}\n$$\n当分母最小时达到上确界，这发生在 $\\omega = 0$ 处。\n$$\n\\|T\\|_{\\infty} = \\frac{1}{\\sqrt{0^2+4}} = \\frac{1}{2}\n$$\n因此，乘性不确定性裕度为：\n$$\n\\delta = \\frac{1}{1/2} = 2\n$$\n\n第二部分：归一化互质因式 (NCF) 不确定性裕度\n对于 NCF 不确定性，鲁棒稳定性的条件也来自于将小增益定理应用于此不确定性结构的标准互联形式。问题要求结果以一种不依赖于任何特定互质分解的形式表示。最大容许不确定性半径 $\\varepsilon$ 的标准结果是：\n$$\n\\varepsilon = \\left\\| \\begin{pmatrix} K(s) \\\\ I \\end{pmatrix} \\bigl(I+G(s)K(s)\\bigr)^{-1} \\bigl( I \\ \\ G(s) \\bigr) \\right\\|_{\\infty}^{-1}\n$$\n我们定义传递矩阵 $\\mathcal{M}(s)$：\n$$\n\\mathcal{M}(s) = \\begin{pmatrix} K(s) \\\\ 1 \\end{pmatrix} \\frac{1}{1+G(s)K(s)} \\begin{pmatrix} 1  G(s) \\end{pmatrix} = \\frac{1}{1+L(s)} \\begin{pmatrix} K(s)  K(s)G(s) \\\\ 1  G(s) \\end{pmatrix}\n$$\n使用灵敏度函数 $S(s) = (1+L(s))^{-1}$ 和互补灵敏度函数 $T(s) = L(s)(1+L(s))^{-1}$ 的定义，该矩阵可以写为：\n$$\n\\mathcal{M}(s) = \\begin{pmatrix} K(s)S(s)  T(s) \\\\ S(s)  G(s)S(s) \\end{pmatrix}\n$$\n对于给定的 $G(s) = \\frac{1}{s+1}$ 和 $K(s) = 1$：\n$$\nS(s) = \\frac{1}{1+\\frac{1}{s+1}} = \\frac{s+1}{s+2}\n$$\n$$\nT(s) = \\frac{\\frac{1}{s+1}}{1+\\frac{1}{s+1}} = \\frac{1}{s+2}\n$$\n且 $G(s)S(s) = \\frac{1}{s+1} \\frac{s+1}{s+2} = \\frac{1}{s+2} = T(s)$。\n将这些代入 $\\mathcal{M}(s)$ 的表达式中：\n$$\n\\mathcal{M}(s) = \\begin{pmatrix} S(s)  T(s) \\\\ S(s)  T(s) \\end{pmatrix} = \\begin{pmatrix} \\frac{s+1}{s+2}  \\frac{1}{s+2} \\\\ \\frac{s+1}{s+2}  \\frac{1}{s+2} \\end{pmatrix}\n$$\n$\\mathcal{M}(s)$ 的 $H_{\\infty}$-范数是 $\\sup_{\\omega} \\bar{\\sigma}(\\mathcal{M}(j\\omega))$，其中 $\\bar{\\sigma}$ 是最大奇异值。频率相关的矩阵是：\n$$\n\\mathcal{M}(j\\omega) = \\begin{pmatrix} \\frac{j\\omega+1}{j\\omega+2}  \\frac{1}{j\\omega+2} \\\\ \\frac{j\\omega+1}{j\\omega+2}  \\frac{1}{j\\omega+2} \\end{pmatrix}\n$$\n这是一个秩为 1 的矩阵，可以表示为两个向量的外积 $u = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $v^H = \\begin{pmatrix} \\frac{j\\omega+1}{j\\omega+2}  \\frac{1}{j\\omega+2} \\end{pmatrix}^*$。我们使用 $u v^T$ 的形式，其中 $v^T = \\begin{pmatrix} \\frac{j\\omega+1}{j\\omega+2}  \\frac{1}{j\\omega+2} \\end{pmatrix}$。最大奇异值由 $\\bar{\\sigma} = \\|u\\|_2 \\|v\\|_2$ 给出。\n$$\n\\|u\\|_2 = \\sqrt{1^2+1^2} = \\sqrt{2}\n$$\n$$\n\\|v\\|_2^2 = \\left|\\frac{j\\omega+1}{j\\omega+2}\\right|^2 + \\left|\\frac{1}{j\\omega+2}\\right|^2 = \\frac{|j\\omega+1|^2}{|j\\omega+2|^2} + \\frac{|1|^2}{|j\\omega+2|^2} = \\frac{\\omega^2+1}{\\omega^2+4} + \\frac{1}{\\omega^2+4} = \\frac{\\omega^2+2}{\\omega^2+4}\n$$\n因此，作为 $\\omega$ 函数的最大奇异值是：\n$$\n\\bar{\\sigma}(\\mathcal{M}(j\\omega)) = \\sqrt{2} \\sqrt{\\frac{\\omega^2+2}{\\omega^2+4}} = \\sqrt{\\frac{2\\omega^2+4}{\\omega^2+4}}\n$$\n为了求得 $H_{\\infty}$-范数，我们必须求此函数在所有 $\\omega \\in \\mathbb{R}$ 上的上确界。设 $x = \\omega^2$，其中 $x \\ge 0$。我们需要求 $f(x) = \\sqrt{\\frac{2x+4}{x+4}}$ 的上确界。平方根内函数的导数是 $g'(x) = \\frac{d}{dx}\\left(\\frac{2x+4}{x+4}\\right) = \\frac{2(x+4) - (2x+4)}{(x+4)^2} = \\frac{4}{(x+4)^2}  0$ 对于所有 $x \\ge 0$。因此，该函数是单调递增的。其上确界是当 $x \\to \\infty$ 时的极限。\n$$\n\\|\\mathcal{M}\\|_{\\infty}^2 = \\lim_{x \\to \\infty} \\frac{2x+4}{x+4} = 2\n$$\n因此，$\\|\\mathcal{M}\\|_{\\infty} = \\sqrt{2}$。NCF 不确定性裕度为：\n$$\n\\varepsilon = \\frac{1}{\\|\\mathcal{M}\\|_{\\infty}} = \\frac{1}{\\sqrt{2}}\n$$\n\n第三部分：裕度之比\n问题要求计算乘性裕度与 NCF 裕度之比。\n$$\nR = \\frac{\\delta}{\\varepsilon} = \\frac{2}{1/\\sqrt{2}} = 2\\sqrt{2}\n$$\n该比值量化了对于此特定对象和控制器，NCF 不确定性模型相对于乘性输出不确定性模型的相对保守性。大于 1 的值表示 NCF 稳定性裕度更小（更保守）。", "answer": "$$\n\\boxed{2\\sqrt{2}}\n$$", "id": "2711266"}, {"introduction": "现在，我们将从基本概念转向回路成形在多输入多输出（MIMO）系统中的实际应用。[@problem_id:2711299]这个计算练习展示了如何使用加权函数来重塑开环系统的奇异值，以提升系统的性能和鲁棒性。你将通过计算和比较成形前后的关键指标，清晰地看到在解决实际控制问题时所面临的设计权衡。", "problem": "考虑一个连续时间、线性时不变、严格真、稳定的多输入多输出对象，其具有两个输入和两个输出。该对象的传递矩阵由下式给出\n$$\nG(s) \\;=\\; \\begin{bmatrix}\n\\dfrac{1}{s + 1}  \\dfrac{0.5}{s + 2} \\\\\n\\dfrac{-0.3}{s + 3}  \\dfrac{1.5}{s + 1}\n\\end{bmatrix}.\n$$\n对于每个角频率 $\\,\\omega \\in \\mathbb{R}_{\\ge 0}\\,$（单位为弧度/秒），定义开环传递矩阵为 $\\,L(j\\omega) = G(j\\omega)\\,$。为了进行整形，考虑稳定、最小相位的对角前置和后置补偿器 $\\,W_1(s)\\in\\mathbb{C}^{2\\times 2}\\,$ 和 $\\,W_2(s)\\in\\mathbb{C}^{2\\times 2}\\,$，并定义整形后的开环传递矩阵\n$$\nL_s(j\\omega) \\;=\\; W_2(j\\omega)\\,G(j\\omega)\\,W_1(j\\omega).\n$$\n对于任意复方阵 $\\,M\\,$，令 $\\,\\bar{\\sigma}(M)\\,$ 表示其最大奇异值，$\\,\\underline{\\sigma}(M)\\,$ 表示其最小奇异值。定义灵敏度矩阵 $\\,S(j\\omega) = \\big(I + L(j\\omega)\\big)^{-1}\\,$ 和互补灵敏度矩阵 $\\,T(j\\omega) = L(j\\omega)\\big(I + L(j\\omega)\\big)^{-1}\\,$，并类似地定义 $\\,S_s(j\\omega)\\,$ 和 $\\,T_s(j\\omega)\\,$，其中 $\\,L\\,$ 被替换为 $\\,L_s\\,$。在 $\\mathcal{H}_{\\infty}$ (H-无穷大) 回路整形设计的背景下，以下频域标量是关注的重点：\n- 低频回路增益代理：$\\,g_{\\mathrm{low}} = \\bar{\\sigma}\\big(L(j\\omega_{\\min})\\big)\\,$ 和 $\\,g_{\\mathrm{low},s} = \\bar{\\sigma}\\big(L_s(j\\omega_{\\min})\\big)\\,$，其中 $\\,\\omega_{\\min}\\,$ 是最小的频率样本。\n- 返回差裕度代理：$\\,m_{\\mathrm{rd}} = \\displaystyle \\min_{\\omega\\in\\Omega}\\,\\underline{\\sigma}\\big(I + L(j\\omega)\\big)\\,$ 和 $\\,m_{\\mathrm{rd},s} = \\displaystyle \\min_{\\omega\\in\\Omega}\\,\\underline{\\sigma}\\big(I + L_s(j\\omega)\\big)\\,$。\n- 互补灵敏度峰值：$\\,\\|T\\|_{\\infty,\\mathrm{grid}} = \\displaystyle \\max_{\\omega\\in\\Omega}\\,\\bar{\\sigma}\\big(T(j\\omega)\\big)\\,$ 和 $\\,\\|T_s\\|_{\\infty,\\mathrm{grid}} = \\displaystyle \\max_{\\omega\\in\\Omega}\\,\\bar{\\sigma}\\big(T_s(j\\omega)\\big)\\,$，在一个有限频率网格 $\\,\\Omega\\,$ 上进行评估。\n\n您的任务是使用以下规范，计算并比较对象 $\\,G(s)\\,$ 在整形前后这些量的变化。\n\n需要使用的基本定义：\n- 频率响应评估：对于任何真有理传递函数 $\\,H(s) = \\dfrac{b_0 s^n + b_1 s^{n-1} + \\cdots + b_n}{a_0 s^m + a_1 s^{m-1} + \\cdots + a_m}\\,$，其中 $\\,m \\ge n\\,$，在 $\\,j\\omega\\,$ 处的频率响应通过复数求值 $\\,H(j\\omega) = \\dfrac{b_0 (j\\omega)^n + \\cdots + b_n}{a_0 (j\\omega)^m + \\cdots + a_m}\\,$ 获得。\n- 奇异值：对于任何复矩阵 $\\,M\\,$，奇异值是 $\\,M^* M\\,$ 的特征值的非负平方根。\n- 灵敏度和互补灵敏度：$\\,S(j\\omega) = \\big(I + L(j\\omega)\\big)^{-1}\\,$ 和 $\\,T(j\\omega) = L(j\\omega)\\big(I + L(j\\omega)\\big)^{-1}\\,$。\n\n频率网格：\n- 使用一个对数间隔的网格 $\\,\\Omega\\,$，包含从 $\\,\\omega_{\\min} = 10^{-2}\\,$ 到 $\\,\\omega_{\\max} = 10^{3}\\,$ 弧度/秒的 $\\,N = 400\\,$ 个点。\n\n测试套件：\n对于每个测试用例，计算未整形回路 $\\,L(j\\omega)\\,$ 和整形回路 $\\,L_s(j\\omega)\\,$ 的以下标量：\n- $\\,g_{\\mathrm{low}}\\,$, $\\,g_{\\mathrm{low},s}\\,$,\n- $\\,m_{\\mathrm{rd}}\\,$, $\\,m_{\\mathrm{rd},s}\\,$,\n- $\\,\\|T\\|_{\\infty,\\mathrm{grid}}\\,$, $\\,\\|T_s\\|_{\\infty,\\mathrm{grid}}\\,$.\n\n然后评估：\n- 性能提升布尔值 $\\,b_{\\mathrm{perf}} = 1\\,$ 如果 $\\,g_{\\mathrm{low},s} > g_{\\mathrm{low}}\\,$，否则为 $\\,0\\,$.\n- 鲁棒性提升布尔值 $\\,b_{\\mathrm{rob}} = 1\\,$ 如果 $\\,m_{\\mathrm{rd},s} > m_{\\mathrm{rd}}\\,$ 且 $\\,\\|T_s\\|_{\\infty,\\mathrm{grid}}  \\|T\\|_{\\infty,\\mathrm{grid}}\\,$，否则为 $\\,0\\,$.\n\n使用以下三种针对 $\\,W_1(s)\\,$ 和 $\\,W_2(s)\\,$ 的整形配置：\n- 测试用例 $\\,1\\,$：\n  - $\\,W_1(s) = \\mathrm{diag}\\!\\left(\\dfrac{50}{s + 5},\\,\\dfrac{40}{s + 5}\\right)\\,$,\n  - $\\,W_2(s) = \\mathrm{diag}\\!\\left(\\dfrac{20}{s + 20},\\,\\dfrac{30}{s + 30}\\right)\\,$.\n- 测试用例 $\\,2\\,$：\n  - $\\,W_1(s) = \\mathrm{diag}\\!\\left(\\dfrac{100}{s + 5},\\,\\dfrac{75}{s + 5}\\right)\\,$,\n  - $\\,W_2(s) = \\mathrm{diag}\\!\\left(\\dfrac{10}{s + 10},\\,\\dfrac{15}{s + 15}\\right)\\,$.\n- 测试用例 $\\,3\\,$：\n  - $\\,W_1(s) = \\mathrm{diag}\\!\\left(1,\\,1\\right)\\,$,\n  - $\\,W_2(s) = \\mathrm{diag}\\!\\left(1,\\,1\\right)\\,$.\n\n数值和输出要求：\n- 所有频域量必须使用上面指定的以弧度/秒为单位的网格 $\\,\\Omega\\,$ 进行计算。\n- 对于每个测试用例，生成列表\n$$\n\\Big[ g_{\\mathrm{low}},\\, g_{\\mathrm{low},s},\\, m_{\\mathrm{rd}},\\, m_{\\mathrm{rd},s},\\, \\|T\\|_{\\infty,\\mathrm{grid}},\\, \\|T_s\\|_{\\infty,\\mathrm{grid}},\\, b_{\\mathrm{perf}},\\, b_{\\mathrm{rob}} \\Big],\n$$\n其中浮点数结果必须四舍五入到三位小数。布尔值必须报告为整数 $\\,0\\,$ 或 $\\,1\\,$。最终程序输出必须是单行，包含三个此类列表的列表，以逗号分隔，并用一对单独的方括号括起来，不含任何额外的空格或文本，例如\n$$\n\\big[ [\\cdots], [\\cdots], [\\cdots] \\big].\n$$", "solution": "所提出的问题是有效的。这是一个在多输入多输出 (MIMO) 控制理论领域内定义明确、具有科学依据的问题。所有必要的数据、模型和度量定义都已提供，并且没有内部矛盾或逻辑缺陷。任务是对一个控制系统的属性在应用回路整形前后进行数值分析，这是鲁棒控制系统设计中的一个标准程序。我们将继续提供一个完整、合理的解决方案。\n\n该任务的核心是通过比较频域性能和鲁棒性度量，来评估回路整形对给定线性时不变 (LTI) 对象 $G(s)$ 的影响。分析是在一个指定的频率网格 $\\Omega$ 上进行的。对于三个测试用例中的每一个，该方法都包括以下步骤。\n\n首先，我们建立频域上下文。分析基于系统的频率响应，这是通过在一系列角频率 $\\omega$ 上评估系统的传递函数矩阵在 $s = j\\omega$ 处的值来获得的。指定的频率网格 $\\Omega$ 由从 $\\omega_{\\min} = 10^{-2}$ 到 $\\omega_{\\max} = 10^{3}$ 弧度/秒的 $N=400$ 个对数间隔的点组成。选择对数尺度是标准做法，因为它允许在几个数量级的频率范围内详细检查系统行为，从而捕捉低频（性能）和高频（鲁棒性、噪声敏感性）现象。\n\n对于每个频率 $\\omega \\in \\Omega$，我们计算复值传递矩阵。未整形的开环系统由 $L(j\\omega) = G(j\\omega)$ 给出，其中对象为\n$$\nG(s) = \\begin{bmatrix} \\dfrac{1}{s + 1}  \\dfrac{0.5}{s + 2} \\\\ \\dfrac{-0.3}{s + 3}  \\dfrac{1.5}{s + 1} \\end{bmatrix}.\n$$\n回路整形通过稳定、最小相位对角前置补偿器 $W_1(s)$ 和后置补偿器 $W_2(s)$ 引入。它们对开环奇异值进行整形，以达到期望的性能和鲁棒性特性。整形后的开环系统则为 $L_s(j\\omega) = W_2(j\\omega)G(j\\omega)W_1(j\\omega)$。该分析将比较从 $L(j\\omega)$ 导出的属性与从 $L_s(j\\omega)$ 导出的属性。\n\n评估系统的关键量源于奇异值分解 (SVD)。对于由矩阵 $M$ 表示的 MIMO 系统，最大奇异值 $\\bar{\\sigma}(M)$ 和最小奇异值 $\\underline{\\sigma}(M)$ 提供了系统在所有输入方向上的最大和最小“增益”的度量。\n\n计算以下度量：\n$1$. 低频性能代理：度量 $g_{\\mathrm{low}} = \\bar{\\sigma}\\big(L(j\\omega_{\\min})\\big)$ 近似了系统的直流增益。低频下的高开环增益对于良好的指令跟随和低频扰动抑制至关重要。整形旨在增加此增益，因此当 $g_{\\mathrm{low},s} = \\bar{\\sigma}\\big(L_s(j\\omega_{\\min})\\big)  g_{\\mathrm{low}}$ 时，表示有改进。此条件决定了布尔标志 $b_{\\mathrm{perf}}$。\n\n$2$. 鲁棒性度量：对不确定性的鲁棒性使用两个主要量进行评估。\n   - 返回差裕度代理，$m_{\\mathrm{rd}} = \\min_{\\omega\\in\\Omega}\\,\\underline{\\sigma}\\big(I + L(j\\omega)\\big)$，与稳定裕度相关。$m_{\\mathrm{rd}}$ 的值越大，意味着针对对象输入的非结构化乘性不确定性的稳定裕度越大。\n   - 互补灵敏度峰值，$\\|T\\|_{\\infty,\\mathrm{grid}} = \\max_{\\omega\\in\\Omega}\\,\\bar{\\sigma}\\big(T(j\\omega)\\big)$。矩阵 $T(j\\omega) = L(j\\omega)\\big(I + L(j\\omega)\\big)^{-1}$ 是互补灵敏度函数，表示从参考到输出的闭环传递函数。其最大奇异值的较大峰值表示阻尼差和对建模误差的敏感性高。\n   - 如果整形后的系统表现出更大的稳定裕度 ($m_{\\mathrm{rd},s}  m_{\\mathrm{rd}}$) 和更小的灵敏度峰值 ($\\|T_s\\|_{\\infty,\\mathrm{grid}}  \\|T\\|_{\\infty,\\mathrm{grid}}$)，则实现了鲁棒性的同时提升。这个联合条件决定了布尔标志 $b_{\\mathrm{rob}}$。\n\n算法按以下步骤进行。对于三个测试用例中的每一个，我们遍历网格 $\\Omega$ 中的每个频率 $\\omega_k$。在每个频率下，我们：\n- 评估复矩阵 $G(j\\omega_k)$、$W_1(j\\omega_k)$ 和 $W_2(j\\omega_k)$。\n- 构建未整形回路 $L_k = G(j\\omega_k)$ 和整形回路 $L_{s,k} = W_2(j\\omega_k)G(j\\omega_k)W_1(j\\omega_k)$。\n- 计算互补灵敏度矩阵 $T_k$ 和 $T_{s,k}$。这是通过求解数值稳定的线性系统 $(I+L_k)T_k = L_k$ 和 $(I+L_{s,k})T_{s,k} = L_{s,k}$ 来完成的，而不是通过显式矩阵求逆。\n- 使用标准 SVD 算法计算 $L_k, L_{s,k}, (I+L_k), (I+L_{s,k}), T_k$ 和 $T_{s,k}$ 的奇异值。\n- 根据度量定义的要求，存储最大和最小奇异值。\n\n频率扫描完成后，使用存储的奇异值数组计算最终度量。低频增益 ($g_{\\mathrm{low}}, g_{\\mathrm{low},s}$) 取自第一个频率点 $\\omega_{\\min}$。鲁棒性裕度 ($m_{\\mathrm{rd}}, m_{\\mathrm{rd},s}$) 和灵敏度峰值 ($\\|T\\|_{\\infty,\\mathrm{grid}}, \\|T_s\\|_{\\infty,\\mathrm{grid}}$) 分别通过在整个频率网格上取最小值或最大值来找到。最后，根据指定的条件评估布尔标志 $b_{\\mathrm{perf}}$ 和 $b_{\\mathrm{rob}}$。然后将每个测试用例得到的八个值的集合进行格式化并呈现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the H-infinity loop shaping analysis problem for three test cases.\n    \"\"\"\n    # 1. Setup\n    N = 400\n    omega_min = 1e-2\n    omega_max = 1e3\n    omega_grid = np.logspace(np.log10(omega_min), np.log10(omega_max), N)\n    \n    # Define Plant G(s)\n    def G_func(s: complex) - np.ndarray:\n        \"\"\"Evaluates the plant transfer matrix G(s) at a given complex frequency s.\"\"\"\n        return np.array([\n            [1.0 / (s + 1.0), 0.5 / (s + 2.0)],\n            [-0.3 / (s + 3.0), 1.5 / (s + 1.0)]\n        ], dtype=complex)\n\n    # Define Test Cases for Compensators W1(s), W2(s)\n    test_cases = [\n        {  # Case 1\n            \"W1\": lambda s: np.diag([50.0 / (s + 5.0), 40.0 / (s + 5.0)]),\n            \"W2\": lambda s: np.diag([20.0 / (s + 20.0), 30.0 / (s + 30.0)])\n        },\n        {  # Case 2\n            \"W1\": lambda s: np.diag([100.0 / (s + 5.0), 75.0 / (s + 5.0)]),\n            \"W2\": lambda s: np.diag([10.0 / (s + 10.0), 15.0 / (s + 15.0)])\n        },\n        {  # Case 3\n            \"W1\": lambda s: np.eye(2, dtype=complex),\n            \"W2\": lambda s: np.eye(2, dtype=complex)\n        }\n    ]\n\n    all_results = []\n    I = np.eye(2, dtype=complex)\n\n    # 2. Main Loop over test cases\n    for case_spec in test_cases:\n        W1_func = case_spec[\"W1\"]\n        W2_func = case_spec[\"W2\"]\n\n        # Storage for frequency-dependent singular values\n        sigma_bar_L_list = np.zeros(N)\n        sigma_bar_Ls_list = np.zeros(N)\n        sigma_under_I_L_list = np.zeros(N)\n        sigma_under_I_Ls_list = np.zeros(N)\n        sigma_bar_T_list = np.zeros(N)\n        sigma_bar_Ts_list = np.zeros(N)\n\n        # 3. Frequency Sweep\n        for i, omega in enumerate(omega_grid):\n            s = 1j * omega\n            \n            # Evaluate matrices at s=j*omega\n            Gm = G_func(s)\n            W1m = W1_func(s)\n            W2m = W2_func(s)\n\n            # Unshaped loop calculations\n            L = Gm\n            I_plus_L = I + L\n            T = np.linalg.solve(I_plus_L, L)\n\n            # Shaped loop calculations\n            Ls = W2m @ Gm @ W1m\n            I_plus_Ls = I + Ls\n            Ts = np.linalg.solve(I_plus_Ls, Ls)\n\n            # Singular value computations\n            sv_L = np.linalg.svd(L, compute_uv=False)\n            sv_Ls = np.linalg.svd(Ls, compute_uv=False)\n            sv_I_L = np.linalg.svd(I_plus_L, compute_uv=False)\n            sv_I_Ls = np.linalg.svd(I_plus_Ls, compute_uv=False)\n            sv_T = np.linalg.svd(T, compute_uv=False)\n            sv_Ts = np.linalg.svd(Ts, compute_uv=False)\n\n            # Store the required singular values\n            sigma_bar_L_list[i] = sv_L[0]\n            sigma_bar_Ls_list[i] = sv_Ls[0]\n            sigma_under_I_L_list[i] = sv_I_L[-1]\n            sigma_under_I_Ls_list[i] = sv_I_Ls[-1]\n            sigma_bar_T_list[i] = sv_T[0]\n            sigma_bar_Ts_list[i] = sv_Ts[0]\n\n        # 4. Post-processing to calculate final metrics\n        g_low = sigma_bar_L_list[0]\n        g_low_s = sigma_bar_Ls_list[0]\n\n        m_rd = np.min(sigma_under_I_L_list)\n        m_rd_s = np.min(sigma_under_I_Ls_list)\n\n        T_inf_grid = np.max(sigma_bar_T_list)\n        Ts_inf_grid = np.max(sigma_bar_Ts_list)\n\n        # 5. Boolean flags evaluation\n        b_perf = 1 if g_low_s  g_low else 0\n        b_rob = 1 if (m_rd_s  m_rd and Ts_inf_grid  T_inf_grid) else 0\n\n        # 6. Format and store results for this case\n        case_result = [\n            round(g_low, 3),\n            round(g_low_s, 3),\n            round(m_rd, 3),\n            round(m_rd_s, 3),\n            round(T_inf_grid, 3),\n            round(Ts_inf_grid, 3),\n            b_perf,\n            b_rob,\n        ]\n        all_results.append(case_result)\n\n    # 7. Final output formatting\n    output_parts = []\n    for res in all_results:\n        part = \"[\" + \",\".join(map(str, res)) + \"]\"\n        output_parts.append(part)\n    final_string = \"[\" + \",\".join(output_parts) + \"]\"\n    \n    print(final_string)\n\nsolve()\n```", "id": "2711299"}]}