{"hands_on_practices": [{"introduction": "对结构化奇异值（$\\mu$）的理解始于其形式化定义，这个定义可能初看起来有些抽象。第一个练习旨在通过将该定义应用于一个简单而典型的系统来建立直观认识。通过完成这些步骤，我们将看到对于一种特定的不确定性结构，$\\mu$ 值如何优雅地简化为一个我们更熟悉的概念：矩阵的光谱半径 $\\rho(M)$。[@problem_id:2758646]", "problem": "设 $M \\in \\mathbb{C}^{2 \\times 2}$ 由 $M = \\begin{bmatrix} 0 & a \\\\ b & 0 \\end{bmatrix}$ 给出，其中 $a,b \\in \\mathbb{C}$。考虑一个反馈互连，其具有在两个通道上重复的单个复标量不确定性，因此容许不确定性集为 $\\Delta = \\{ \\delta I_{2} : \\delta \\in \\mathbb{C} \\}$，其中 $I_{2}$ 是 $2 \\times 2$ 单位矩阵。关于 $\\Delta$ 的结构化奇异值（也称为μ值），记作 $\\mu_{\\Delta}(M)$，定义为\n$$\n\\mu_{\\Delta}(M) \\;=\\; \\frac{1}{\\inf\\{\\, \\|\\Delta\\| \\;:\\; \\Delta \\in \\Delta,\\ \\det(I - M \\Delta) = 0 \\,\\}} \\,,\n$$\n其中 $\\|\\cdot\\|$ 是算子2-范数，而 $I$ 是维度为2的单位矩阵。此定义是鲁棒控制中主回路定理 (MLT) 的一个核心要素，该定理证明了反馈互连的鲁棒稳定性当且仅当对于所有实频率 $\\omega$ 都有 $\\mu_{\\Delta}(M(\\mathrm{j}\\omega)) < 1$。\n\n仅从上述定义出发，计算 $\\mu_{\\Delta}(M)$ 关于 $a$ 和 $b$ 的显式闭式表达式，并解释它如何依赖于 $|ab|$。您的最终答案必须是关于 $a$ 和 $b$ 的单个简化解析表达式（不需要数值）。不要包含任何单位。", "solution": "该问题陈述已经过验证，被认为是有效的。在鲁棒控制理论的既定数学框架内，这是一个适定问题。所有定义都是标准的，所提供的数据是自洽且一致的。我们可以开始求解。\n\n问题要求计算特定矩阵 $M$ 和不确定性结构 $\\Delta$ 的结构化奇异值 $\\mu_{\\Delta}(M)$。所提供的定义是：\n$$\n\\mu_{\\Delta}(M) = \\frac{1}{\\inf\\{\\, \\|\\Delta\\| \\;:\\; \\Delta \\in \\Delta,\\ \\det(I - M \\Delta) = 0 \\,\\}}\n$$\n我们必须仅从此定义推导出解。\n\n首先，让我们描述集合 $\\Delta$ 的元素及其范数。不确定性结构给定为 $\\Delta = \\{ \\delta I_{2} : \\delta \\in \\mathbb{C} \\}$，其中 $I_2$ 是 $2 \\times 2$ 单位矩阵。$\\Delta \\in \\Delta$ 中的一个元素形式为 $\\Delta = \\delta I_2 = \\begin{bmatrix} \\delta & 0 \\\\ 0 & \\delta \\end{bmatrix}$，其中 $\\delta$ 是某个复标量。指定的范数是算子2-范数。矩阵 $\\delta I_2$ 的奇异值均等于 $|\\delta|$。算子2-范数是最大的奇异值，因此我们有 $\\|\\Delta\\| = |\\delta|$。\n\n将此代入 $\\mu_{\\Delta}(M)$ 的定义，我们得到：\n$$\n\\mu_{\\Delta}(M) = \\frac{1}{\\inf\\{\\, |\\delta| \\;:\\; \\delta \\in \\mathbb{C},\\ \\det(I - M (\\delta I_2)) = 0 \\,\\}}\n$$\n下确界的条件是 $\\det(I - \\delta M) = 0$。该方程意味着矩阵 $I - \\delta M$ 是奇异的。这等价于存在一个非零向量 $v$ 使得 $(I - \\delta M)v = 0$，可以重写为 $\\delta M v = v$。如果 $\\delta \\ne 0$，这等价于 $Mv = \\frac{1}{\\delta} v$。这意味着 $\\frac{1}{\\delta}$ 是矩阵 $M$ 的一个特征值。反之，如果 $\\lambda$ 是 $M$ 的一个特征值，那么令 $\\delta = \\frac{1}{\\lambda}$ (对于 $\\lambda \\neq 0$) 可确保 $\\det(I - \\delta M) = 0$。\n\n因此，使得 $\\det(I - \\delta M) = 0$ 的复数 $\\delta$ 的集合是 $M$ 的非零特征值的倒数集合。我们正在寻找这些 $\\delta$ 值的模的下确界。\n$$\n\\inf\\{|\\delta|\\} = \\inf\\left\\{ \\left|\\frac{1}{\\lambda}\\right| : \\lambda \\text{ 是 } M \\text{ 的非零特征值} \\right\\}\n$$\n这个下确界可以用 $M$ 的谱半径来表示，谱半径定义为 $\\rho(M) = \\max_i |\\lambda_i|$，其中 $\\lambda_i$ 是 $M$ 的特征值。\n$$\n\\inf\\left\\{ \\frac{1}{|\\lambda|} \\right\\} = \\frac{1}{\\max\\{|\\lambda|\\}} = \\frac{1}{\\rho(M)}\n$$\n这个结论在 $\\rho(M) \\neq 0$ 的条件下成立。如果 $\\rho(M)=0$，则所有特征值都为零。在这种情况下，不存在 $\\delta$ 使得 $\\delta \\cdot 0 = 1$，因此失稳的 $\\delta$ 值集合为空集。空集的下确界定义为 $+\\infty$。因此，如果 $\\rho(M)=0$，我们有 $\\inf\\{|\\delta|\\} = \\infty$，这导致 $\\mu_{\\Delta}(M) = 1/\\infty = 0$。这与公式 $\\mu_{\\Delta}(M) = \\rho(M)$ 一致。\n\n所以，我们已经确定，对于这种特定的重复标量不确定性结构，$\\mu_{\\Delta}(M) = \\rho(M)$。\n\n下一步是计算给定矩阵 $M = \\begin{bmatrix} 0 & a \\\\ b & 0 \\end{bmatrix}$ 的谱半径。特征值 $\\lambda$ 是特征多项式 $\\det(\\lambda I - M) = 0$ 的根。\n$$\n\\det\\left(\\begin{bmatrix} \\lambda & 0 \\\\ 0 & \\lambda \\end{bmatrix} - \\begin{bmatrix} 0 & a \\\\ b & 0 \\end{bmatrix}\\right) = \\det\\begin{bmatrix} \\lambda & -a \\\\ -b & \\lambda \\end{bmatrix} = \\lambda^2 - ab = 0\n$$\n$\\lambda$ 的解是 $\\lambda_{1,2} = \\pm\\sqrt{ab}$。项 $\\sqrt{ab}$ 表示复数 $ab$ 的两个复平方根之一。\n\n谱半径 $\\rho(M)$ 是这些特征值模的最大值：\n$$\n\\rho(M) = \\max\\left( |\\sqrt{ab}|, |-\\sqrt{ab}| \\right)\n$$\n因为 $|-1|=1$，所以我们有 $|-\\sqrt{ab}| = |\\sqrt{ab}|$。对于任何复数 $z$，其平方根的模等于其模的平方根：$|\\sqrt{z}| = \\sqrt{|z|}$。应用此性质，我们得到：\n$$\n|\\sqrt{ab}| = \\sqrt{|ab|}\n$$\n因此，$M$ 的谱半径为：\n$$\n\\rho(M) = \\sqrt{|ab|}\n$$\n最后，我们可以陈述结构化奇异值的表达式：\n$$\n\\mu_{\\Delta}(M) = \\rho(M) = \\sqrt{|ab|}\n$$\n此表达式表明 $\\mu_{\\Delta}(M)$ 仅依赖于非对角线元素乘积的模 $|ab|$。它具体是这个模的平方根。复数 $a$ 和 $b$ 的相位影响特征值 $\\lambda_{1,2}$，但它们对谱半径以及因此对 $\\mu_{\\Delta}(M)$ 的综合影响完全由其乘积的模所概括。", "answer": "$$\n\\boxed{\\sqrt{|ab|}}\n$$", "id": "2758646"}, {"introduction": "在对 $\\mu$ 有了基本理解之后，下一步是探究它的实用价值。为何 $\\mu$ 分析优于更简单的非结构化小增益定理？本练习提供了一个直接的比较，要求您为一个具有混合不确定性的系统计算并对比两种方法所能保证的稳定性裕度。[@problem_id:2758609] 您将量化保守性的降低程度，亲眼见证 $\\mu$ 分析如何为鲁棒稳定性提供一个更不保守、更精确的评估。", "problem": "考虑一个带有结构化不确定性的反馈互连系统的鲁棒稳定性认证，通过主回路定理进行分析。设从不确定性输入到输出的互连为一个稳定的、真分数的、复数值传递矩阵 $M(s) \\in \\mathbb{C}^{3 \\times 3}$，并考虑一个混合块对角不确定性结构，其包含一个复标量块和一个维度为 $2$ 的复全块，即 $\\Delta = \\operatorname{diag}(\\delta_1, \\Delta_2)$，其中 $\\delta_1 \\in \\mathbb{C}$ 且 $\\Delta_2 \\in \\mathbb{C}^{2 \\times 2}$。当且仅当结构化奇异值（通常表示为 $\\mu$ 值）满足 $\\sup_{\\omega \\in \\mathbb{R}} \\mu_{\\Delta}(M(j\\omega)) < 1$ 时，鲁棒稳定性得到认证。非结构化小增益界用非结构化诱导 $2$-范数替代 $\\mu_{\\Delta}$。$\\mu_{\\Delta}$ 的一个标准上界使用遵循分块结构的对角 $D$ 缩放。您的任务是针对指定的测试用例，计算基于 (i) 非结构化小增益界和 (ii) 块对角 $D$ 缩放界的认证稳定性裕度，然后量化使用 $D$ 缩放界时保守性的降低程度。\n\n用作基本基础的定义：\n- 对于一个稳定的、真分数的传递矩阵 $H(s)$，其 $\\mathcal{H}_{\\infty}$ 范数定义为 $\\lVert H \\rVert_{\\infty} := \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(H(j\\omega))$，其中 $\\bar{\\sigma}$ 表示最大奇异值。\n- 主回路定理认证，若 $\\sup_{\\omega \\in \\mathbb{R}} \\mu_{\\Delta}(M(j\\omega)) < 1$，则系统鲁棒稳定。一个充分条件是非结构化小增益条件 $\\lVert M \\rVert_{\\infty} < 1$。\n- 对于块对角结构，$\\mu_{\\Delta}(M(j\\omega))$ 的一个标准可计算上界是通过在块对角缩放 $D$ 上最小化相似性缩放互连的诱导 $2$-范数来给出，即 $D = \\operatorname{diag}(d, \\alpha I_2)$，其中 $d > 0$ 且 $\\alpha > 0$，从而得到上界 $\\inf_{D \\in \\mathcal{D}} \\lVert D M D^{-1} \\rVert_{\\infty}$，其中 $\\mathcal{D}$ 是遵循不确定性划分的块对角正缩放集合。因为在 $D M D^{-1}$ 中，一个公共的正标量因子会消去，所以可以不失一般性地通过比率 $\\rho := d / \\alpha$ 来参数化 $D$，并写作 $D(\\rho) = \\operatorname{diag}(\\rho, 1, 1)$。\n\n数值模型和测试套件：\n- 在所有情况下，令 $M(s) = \\frac{1}{s + a} M_0$，其中 $a = 1$，常数矩阵 $M_0 \\in \\mathbb{R}^{3 \\times 3}$ 在下面的每个测试用例中给出。这一选择使 $M(s)$ 成为严格真分数、稳定的，并确保非结构化范数的峰值出现在 $\\omega = 0$ 处。\n- 块结构固定为一个复标量块（维度 $1$）和一个复全块（维度 $2$），分别对应于 $M(s)$ 的第一个通道和最后两个通道。\n- 频率网格：在集合 $\\Omega = \\{ 0 \\} \\cup \\{ \\omega_k \\}_{k=1}^{N_\\omega}$ 上进行评估，其中 $N_\\omega = 1000$，$\\{ \\omega_k \\}$ 是在 $10^{-3}$ 到 $10^{3}$ 弧度/秒之间对数间隔分布的。角度单位为弧度。\n- $D$-缩放网格：限制为 $D(\\rho) = \\operatorname{diag}(\\rho, 1, 1)$，其中 $\\rho$ 在 $[10^{-3}, 10^{3}]$ 上使用 $N_\\rho = 601$ 个点进行对数间隔分布。\n- 对于每个测试用例，计算：\n  1. 非结构化小增益界 $\\lVert M \\rVert_{\\infty} = \\sup_{\\omega \\in \\Omega} \\bar{\\sigma}(M(j\\omega))$，及其认证的稳定性裕度 $\\gamma_{\\mathrm{SG}} := 1 / \\lVert M \\rVert_{\\infty}$。\n  2. 通过 $\\rho$ 的网格近似的 $D$-缩放界 $\\inf_{\\rho} \\lVert D(\\rho) M D(\\rho)^{-1} \\rVert_{\\infty}$，及其认证的稳定性裕度 $\\gamma_{D} := 1 / \\left( \\inf_{\\rho} \\lVert D(\\rho) M D(\\rho)^{-1} \\rVert_{\\infty} \\right)$。\n  3. 保守性的降低，量化为使用 $D$-缩放界而非小增益界时认证裕度的相对增加：$r := \\left( \\gamma_{D} - \\gamma_{\\mathrm{SG}} \\right) / \\gamma_{\\mathrm{SG}}$。将 $r$ 以十进制数形式报告。\n\n测试套件矩阵 $M_0$：\n- 情况 A（有利于 $D$-缩放的各向异性耦合）：\n  $$\n  M_{0,A} =\n  \\begin{bmatrix}\n  0.05 & 0.20 & 0.10 \\\\\n  3.00 & 0.30 & 0.20 \\\\\n  2.00 & 0.10 & 0.20\n  \\end{bmatrix}.\n  $$\n- 情况 B（近各向同性，预期从 $D$-缩放中获益较弱）：\n  $$\n  M_{0,B} =\n  \\begin{bmatrix}\n  0.60 & 0.20 & 0.20 \\\\\n  0.20 & 0.60 & 0.20 \\\\\n  0.20 & 0.20 & 0.60\n  \\end{bmatrix}.\n  $$\n- 情况 C（块对角互连与不确定性划分对齐；预期无 $D$-缩放收益）：\n  $$\n  M_{0,C} =\n  \\begin{bmatrix}\n  0.50 & 0.00 & 0.00 \\\\\n  0.00 & 0.30 & 0.10 \\\\\n  0.00 & 0.20 & 0.40\n  \\end{bmatrix}.\n  $$\n\n计算和输出要求：\n- 使用指定的网格为每种情况计算如上定义的 $\\gamma_{\\mathrm{SG}}$ 和 $\\gamma_{D}$。然后计算每种情况的 $r$。\n- 所有答案都是无单位的实数。\n- 您的程序必须生成单行输出，其中包含情况 A、B 和 C 的三个 $r$ 值列表（按此顺序），格式为用方括号括起来的逗号分隔列表（例如，$[0.123456,0.000000,0.000000]$）。每个值必须四舍五入到小数点后六位。", "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于鲁棒控制理论的原理，特别是 $\\mu$-分析和主回路定理。该问题是适定的、客观的，并为唯一的数值解提供了一套完整且一致的数据和定义。计算任务是这些原理的标准应用，并且完全可行。因此，我们将进行严谨的求解。\n\n目标是计算对于一个给定的具有结构化不确定性的反馈系统，使用结构化 $D$-缩放分析相对于非结构化小增益分析所实现的保守性降低量 $r$。系统的传递矩阵为 $M(s) = \\frac{1}{s + a} M_0$，其中 $a=1$，$M_0$ 是一个常数 $3 \\times 3$ 矩阵。不确定性结构为 $\\Delta = \\operatorname{diag}(\\delta_1, \\Delta_2)$，其中 $\\delta_1 \\in \\mathbb{C}$ 且 $\\Delta_2 \\in \\mathbb{C}^{2 \\times 2}$。\n\n首先，我们建立两个稳定性裕度 $\\gamma_{\\mathrm{SG}}$ 和 $\\gamma_{D}$ 的计算公式。\n\n非结构化小增益稳定性裕度 $\\gamma_{\\mathrm{SG}}$ 定义为互连矩阵 $M(s)$ 的 $\\mathcal{H}_{\\infty}$ 范数的倒数。\n$$\n\\gamma_{\\mathrm{SG}} := \\frac{1}{\\lVert M \\rVert_{\\infty}} = \\frac{1}{\\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(M(j\\omega))}\n$$\n其中 $\\bar{\\sigma}(\\cdot)$ 表示最大奇异值。对于给定的 $M(s)$ 形式，频率响应为 $M(j\\omega) = \\frac{1}{j\\omega + a} M_0$。因此，最大奇异值为：\n$$\n\\bar{\\sigma}(M(j\\omega)) = \\bar{\\sigma}\\left(\\frac{1}{j\\omega + a} M_0\\right) = \\left|\\frac{1}{j\\omega + a}\\right| \\bar{\\sigma}(M_0) = \\frac{1}{\\sqrt{\\omega^2 + a^2}} \\bar{\\sigma}(M_0)\n$$\n由于 $\\bar{\\sigma}(M_0)$ 是一个关于频率 $\\omega$ 的常数，当项 $1/\\sqrt{\\omega^2 + a^2}$ 最大化时，该表达式的上确界得以实现，这发生在 $\\omega = 0$ 时。这证实了问题陈述中的断言。因此，$\\mathcal{H}_{\\infty}$ 范数可简化为：\n$$\n\\lVert M \\rVert_{\\infty} = \\frac{1}{\\sqrt{0^2 + a^2}} \\bar{\\sigma}(M_0) = \\frac{1}{a} \\bar{\\sigma}(M_0)\n$$\n当 $a=1$ 时，我们有 $\\lVert M \\rVert_{\\infty} = \\bar{\\sigma}(M_0)$。小增益裕度为：\n$$\n\\gamma_{\\mathrm{SG}} = \\frac{1}{\\bar{\\sigma}(M_0)}\n$$\n\n接下来，我们讨论 $D$-缩放稳定性裕度 $\\gamma_{D}$。该裕度基于结构化奇异值 $\\mu_{\\Delta}(M(j\\omega))$ 的一个上界，由 $\\inf_{D \\in \\mathcal{D}} \\bar{\\sigma}(D M(j\\omega) D^{-1})$ 给出。与不确定性结构 $\\Delta$ 可交换的缩放矩阵集合 $\\mathcal{D}$ 的形式为 $D = \\operatorname{diag}(d I_1, \\alpha I_2)$，其中标量 $d > 0, \\alpha > 0$。如前所述，该集合可以通过单个比率 $\\rho = d/\\alpha$ 进行参数化，不失一般性地得到形式 $D(\\rho) = \\operatorname{diag}(\\rho, 1, 1)$。\n$D$-缩放裕度定义为：\n$$\n\\gamma_{D} := \\frac{1}{\\inf_{\\rho} \\lVert D(\\rho) M D(\\rho)^{-1} \\rVert_{\\infty}} = \\frac{1}{\\inf_{\\rho} \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(D(\\rho) M(j\\omega) D(\\rho)^{-1})}\n$$\n矩阵 $D(\\rho)$ 是关于频率的常数。我们可以分析内部项：\n$$\n\\bar{\\sigma}(D(\\rho) M(j\\omega) D(\\rho)^{-1}) = \\bar{\\sigma}\\left(D(\\rho) \\frac{1}{j\\omega + a} M_0 D(\\rho)^{-1}\\right) = \\left|\\frac{1}{j\\omega + a}\\right| \\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1})\n$$\n对于任何固定的 $\\rho$，项 $\\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1})$ 关于 $\\omega$ 是常数。对 $\\omega$ 的上确界再次由标量传递函数决定，并在 $\\omega = 0$ 时达到。这显著简化了嵌套优化：\n$$\n\\inf_{\\rho} \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(D(\\rho) M(j\\omega) D(\\rho)^{-1}) = \\inf_{\\rho} \\left[ \\frac{1}{a} \\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1}) \\right] = \\frac{1}{a} \\inf_{\\rho} \\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1})\n$$\n当 $a=1$ 时，$\\mu$ 的 $D$-缩放界是 $\\inf_{\\rho} \\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1})$。$D$-缩放裕度为：\n$$\n\\gamma_{D} = \\frac{1}{\\inf_{\\rho} \\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1})}\n$$\n矩阵 $D(\\rho) M_0 D(\\rho)^{-1}$ 计算如下：\n$$\nD(\\rho) M_0 D(\\rho)^{-1} = \\begin{bmatrix} \\rho & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} M_0 \\begin{bmatrix} 1/\\rho & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\begin{bmatrix} M_{0,11} & \\rho M_{0,12} & \\rho M_{0,13} \\\\ (1/\\rho) M_{0,21} & M_{0,22} & M_{0,23} \\\\ (1/\\rho) M_{0,31} & M_{0,32} & M_{0,33} \\end{bmatrix}\n$$\n问题指定了在 $\\rho \\in [10^{-3}, 10^{3}]$ 的 $N_\\rho = 601$ 个对数间隔值的离散网格上进行数值搜索。\n\n最后，保守性降低量 $r$ 定义为认证稳定性裕度的相对增加：\n$$\nr := \\frac{\\gamma_{D} - \\gamma_{\\mathrm{SG}}}{\\gamma_{\\mathrm{SG}}} = \\frac{\\gamma_{D}}{\\gamma_{\\mathrm{SG}}} - 1\n$$\n代入 $\\gamma_{D}$ 和 $\\gamma_{\\mathrm{SG}}$ 的表达式：\n$$\nr = \\frac{1 / (\\inf_{\\rho} \\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1}))}{1 / \\bar{\\sigma}(M_0)} - 1 = \\frac{\\bar{\\sigma}(M_0)}{\\inf_{\\rho} \\bar{\\sigma}(D(\\rho) M_0 D(\\rho)^{-1})} - 1\n$$\n这个最终的、简洁的公式表明，降低比率仅取决于 $M_0$ 的未缩放最大奇异值与在给定缩放结构下可达到的最小最大奇异值之比。\n\n每个测试用例的计算过程如下：\n1. 给定矩阵 $M_0$，计算其最大奇异值 $\\sigma_{\\mathrm{SG}} = \\bar{\\sigma}(M_0)$。\n2. 定义在 $[10^{-3}, 10^{3}]$ 中对数间隔分布的 $N_\\rho = 601$ 个缩放因子 $\\rho_k$ 的网格。\n3. 对于网格中的每个 $\\rho_k$，构建缩放矩阵 $M_{0,D}(\\rho_k) = D(\\rho_k) M_0 D(\\rho_k)^{-1}$。\n4. 计算每个 $M_{0,D}(\\rho_k)$ 的最大奇异值。\n5. 在网格上找到这些最大奇异值的最小值：$\\sigma_D = \\min_k \\bar{\\sigma}(M_{0,D}(\\rho_k))$。\n6. 计算保守性降低量 $r = (\\sigma_{\\mathrm{SG}} / \\sigma_D) - 1$。\n7. 对所有三个测试用例重复此过程，并报告四舍五入到小数点后六位的 $r$ 值。\n\n将实施此程序以获得最终的数值答案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reduction in conservatism by using D-scaling for robust stability analysis.\n    \"\"\"\n    # Define test cases: constant matrices M_0 for the transfer function M(s) = M_0 / (s+a)\n    M0_A = np.array([\n        [0.05, 0.20, 0.10],\n        [3.00, 0.30, 0.20],\n        [2.00, 0.10, 0.20]\n    ])\n    \n    M0_B = np.array([\n        [0.60, 0.20, 0.20],\n        [0.20, 0.60, 0.20],\n        [0.20, 0.20, 0.60]\n    ])\n    \n    M0_C = np.array([\n        [0.50, 0.00, 0.00],\n        [0.00, 0.30, 0.10],\n        [0.00, 0.20, 0.40]\n    ])\n    \n    test_cases = [M0_A, M0_B, M0_C]\n\n    # Define numerical parameters from the problem statement\n    N_rho = 601\n    rho_grid = np.logspace(-3, 3, N_rho)\n\n    results_r = []\n\n    for M0 in test_cases:\n        # Step 1: Compute the unstructured bound based on the H-infinity norm.\n        # As derived, for M(s) = M_0 / (s+a), the H-infinity norm is (1/a) * sigma_bar(M_0).\n        # We need sigma_bar(M_0) for the ratio r.\n        # numpy.linalg.svd returns singular values in descending order.\n        sigma_SG = np.linalg.svd(M0, compute_uv=False)[0]\n\n        # Step 2: Compute the D-scaled bound.\n        # This involves finding the minimum largest singular value over the rho grid.\n        min_sigma_D = np.inf\n        \n        for rho in rho_grid:\n            # Construct the D-scaled matrix M_0_D = D(rho) * M_0 * D(rho)^-1\n            # D(rho) = diag(rho, 1, 1)\n            # M_0_D[i,j] = M_0[i,j] * rho**(delta_i - delta_j) where delta = [1, 0, 0]\n            M0_D = M0.copy()\n            # Row 0 is multiplied by rho, then Col 0 is divided by rho.\n            # This is equivalent to M_0_D[0,:] *= rho; M_0_D[:,0] /= rho\n            # More explicitly:\n            # M_0_D[0,1:] *= rho\n            # M_0_D[1:,0] /= rho\n            M0_D[0, 1] *= rho\n            M0_D[0, 2] *= rho\n            M0_D[1, 0] /= rho\n            M0_D[2, 0] /= rho\n\n            # Calculate the largest singular value for this rho\n            sigma_D_at_rho = np.linalg.svd(M0_D, compute_uv=False)[0]\n            \n            # Update the minimum\n            if sigma_D_at_rho < min_sigma_D:\n                min_sigma_D = sigma_D_at_rho\n        \n        sigma_D = min_sigma_D\n\n        # Step 3: Compute the conservatism reduction, r.\n        # r = (gamma_D - gamma_SG) / gamma_SG = (sigma_SG / sigma_D) - 1\n        # Handle the case where sigma_D might be zero to avoid division by zero,\n        # though it's highly unlikely for these matrices.\n        if sigma_D > 1e-12:\n            r = (sigma_SG / sigma_D) - 1.0\n        else:\n            # If sigma_D is zero, it implies infinite improvement, but for a non-zero\n            # sigma_SG, this case is physically and numerically improbable.\n            # if sigma_SG is also zero, r is 0.\n            r = np.inf if sigma_SG > 1e-12 else 0.0\n\n        results_r.append(r)\n        \n    # Final print statement in the exact required format.\n    # Each value must be rounded to exactly six digits after the decimal point.\n    formatted_results = [f\"{val:.6f}\" for val in results_r]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2758609"}, {"introduction": "我们已经了解了 $\\mu$ 是什么以及它为何有用，现在我们转向“如何计算”的问题。精确计算 $\\mu$ 值是一个NP难问题，因此我们依赖于可高效计算的界。本练习聚焦于最常用的方法：计算 $D$ 缩放上界。[@problem_id:2758619] 您将通过搜索缩放参数来实现优化算法，以找到最紧的上界，这是鲁棒控制领域的一项核心计算技能。", "problem": "在固定的角频率 $\\omega_0$下，考虑一个线性时不变(LTI)系统与一个不确定性集合的标准反馈互联，该互联在频率 $\\omega_0$ 处由复数矩阵 $M(j\\omega_0)$ 表示，此处简记为 $M\\in\\mathbb{C}^{n\\times n}$。不确定性结构由两个重复的复标量块组成，因此容许的不确定性形式为 $\\Delta=\\operatorname{diag}(\\delta_1 I_{r_1},\\,\\delta_2 I_{r_2})$，其中 $\\delta_1,\\delta_2\\in\\mathbb{C}$ 且 $|\\delta_1|\\le 1$, $|\\delta_2|\\le 1$。在 $\\omega_0$ 处的结构奇异值 (SSV) $\\mu_\\Delta(M)$ 通过主回路定理为鲁棒稳定性提供了一个逐频率的充要条件。一个广泛使用的可计算上界采用与 $\\Delta$ 交换的块对角缩放 $D$。对于两个重复的复标量块，此类缩放具有形式 $D=\\operatorname{diag}(d_1 I_{r_1},\\,d_2 I_{r_2})$，其中 $d_1>0$ 且 $d_2>0$。\n\n从第一性原理出发，即结构奇异值的定义和诱导 $2$-范数的次乘性，推导出在单个频率 $\\omega_0$ 处 $\\mu_\\Delta(M)$ 的块对角缩放上界，该上界为在所有与 $\\Delta$ 交换的正定 $D$ 上，相似性缩放互联 $DMD^{-1}$ 的诱导 $2$-范数的下确界。将此构造具体化到两个重复复标量块的情况，以证明在不失一般性的情况下，该界仅取决于比率 $\\rho=d_1/d_2>0$，并且缩放后的互联为\n$$\nM_\\rho \\;=\\;\\begin{bmatrix}\nA & \\rho\\,B\\\\\n\\rho^{-1}\\,C & D\n\\end{bmatrix},\n$$\n其中 $M=\\begin{bmatrix}A & B\\\\ C & D\\end{bmatrix}$ 根据块大小 $r_1$ 和 $r_2$ 进行一致地分块。您的程序必须为下面的每个测试用例计算在 $\\omega_0$ 处的最紧块对角缩放上界，即\n$$\n\\inf_{\\rho>0}\\, \\overline{\\sigma}\\!\\left(M_\\rho\\right),\n$$\n其中 $\\overline{\\sigma}(\\cdot)$ 表示最大奇异值（诱导 $2$-范数）。使用数值稳健的程序，将计算实现为对 $\\rho>0$（等效于对 $t=\\log \\rho\\in\\mathbb{R}$）的一维搜索。\n\n测试套件。对于每种情况，$M$ 是数值给定的，不确定性结构具有指定大小的两个重复复标量块。所有矩阵都是复数矩阵的实值实例。\n\n- 情况 $1$（一般耦合情况，$r_1=r_2=2$）：\n$$\nM_1 \\;=\\;\n\\begin{bmatrix}\n0.2 & 0.0 & 5.0 & 0.0\\\\\n0.0 & 0.2 & 0.0 & 4.0\\\\\n0.2 & 0.0 & 0.2 & 0.0\\\\\n0.0 & 0.1 & 0.0 & 0.2\n\\end{bmatrix}.\n$$\n\n- 情况 $2$（块对角边界情况，$r_1=1,\\,r_2=3$）：\n$$\nM_2 \\;=\\;\n\\begin{bmatrix}\n1.5 & 0.0 & 0.0 & 0.0\\\\\n0.0 & 0.5 & 0.0 & 0.0\\\\\n0.0 & 0.0 & 0.6 & 0.0\\\\\n0.0 & 0.0 & 0.0 & 0.4\n\\end{bmatrix}.\n$$\n\n- 情况 $3$（秩-1互联对称性，$r_1=3,\\,r_2=1$）：\n$$\nM_3 \\;=\\;\n\\begin{bmatrix}\n0.1 & 0.0 & 0.0 & 2.0\\\\\n0.0 & 0.1 & 0.0 & -1.0\\\\\n0.0 & 0.0 & 0.1 & 0.5\\\\\n2.0 & -1.0 & 0.5 & 0.1\n\\end{bmatrix}.\n$$\n\n程序要求。\n\n- 对于每种情况，如上所述计算D-缩放上界 $\\inf_{\\rho>0}\\overline{\\sigma}(M_\\rho)$。仅使用诱导 $2$-范数（最大奇异值）。\n- 在 $t=\\log\\rho\\in\\mathbb{R}$上使用鲁棒数值优化；等效地，在 $\\rho>0$上搜索。\n- 每个情况返回一个浮点值，四舍五入到恰好 $6$ 位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3]$），顺序为 $[\\text{情况 }1,\\,\\text{情况 }2,\\,\\text{情况 }3]$。\n\n不涉及物理单位。不涉及角度。所有百分比（如有）必须表示为小数；此处没有出现。最终答案必须是一个完整的、可运行的程序。", "solution": "该问题要求基于块对角缩放推导结构奇异值 ($\\mu$) 的上界，然后通过数值实现为几个测试用例计算此界。推导和求解将遵循控制理论的既定原则。\n\n首先，问题陈述的验证是成功的。该问题在科学上植根于鲁棒控制理论和$\\mu$-分析，问题设定良好，提供了所有必要信息，并以客观、正式的语言表述。没有矛盾、歧义或伪科学的主张。该问题是有效的，并且可以解决。\n\n推导始于结构奇异值 $\\mu_\\Delta(M)$ 的定义，针对一个复数矩阵 $M \\in \\mathbb{C}^{n \\times n}$ 和给定的不确定性结构 $\\boldsymbol{\\Delta}$：\n$$ \\mu_\\Delta(M) := \\left( \\min_{\\Delta \\in \\boldsymbol{\\Delta}} \\{ \\overline{\\sigma}(\\Delta) : \\det(I - M\\Delta) = 0 \\} \\right)^{-1} $$\n如果存在一个 $\\Delta \\in \\boldsymbol{\\Delta}$ 使得 $\\det(I - M\\Delta) = 0$，否则 $\\mu_\\Delta(M) := 0$。这里，$\\overline{\\sigma}(\\cdot)$ 是最大奇异值，代表诱导 $2$-范数。条件 $\\det(I - M\\Delta) = 0$ 对应于闭环系统在 $s=0$ 处出现一个极点（在连续时间中的特定频率下），表示不稳定。\n\n$\\mu$-分析中的一个关键技术涉及缩放矩阵。设 $\\mathcal{D}$ 是一组可逆矩阵的集合，此处表示为 $D_{scale}$，它们与每个不确定性矩阵 $\\Delta \\in \\boldsymbol{\\Delta}$ 交换（即，$D_{scale}\\Delta = \\Delta D_{scale}$）。对于任何 $D_{scale} \\in \\mathcal{D}$，不稳定性条件在相似性变换下是不变的：\n$$ \\det(I - M\\Delta) = 0 \\iff \\det(I - D_{scale}MD_{scale}^{-1} \\Delta) = 0 $$\n这个等价性源于 $\\det(I - M\\Delta) = \\det(D_{scale}(I-M\\Delta)D_{scale}^{-1}) = \\det(I - D_{scale}M\\Delta D_{scale}^{-1})$。由于 $D_{scale}$ 和 $\\Delta$ 可交换，所以 $\\Delta D_{scale}^{-1} = D_{scale}^{-1}\\Delta$，这导出了所述的等价性。这意味着结构奇异值在这种变换下也是不变的：\n$$ \\mu_\\Delta(M) = \\mu_\\Delta(D_{scale}MD_{scale}^{-1}) \\quad \\forall D_{scale} \\in \\mathcal{D} $$\n\n一个基本界将 $\\mu$ 与矩阵范数联系起来：对于任何矩阵 $A$，$\\mu_\\Delta(A) \\le \\overline{\\sigma}(A)$。这是因为如果对于某个 $\\Delta$ 有 $\\det(I - A\\Delta) = 0$，则存在一个非零向量 $x$ 使得 $A\\Delta x = x$。取范数可得 $1 \\le \\overline{\\sigma}(A)\\overline{\\sigma}(\\Delta)$，这意味着 $\\overline{\\sigma}(\\Delta) \\ge 1/\\overline{\\sigma}(A)$。根据 $\\mu$ 的定义，可以得出 $\\mu_\\Delta(A) \\le \\overline{\\sigma}(A)$。\n\n结合这些事实得到 $\\mu_\\Delta(M) = \\mu_\\Delta(D_{scale}MD_{scale}^{-1}) \\le \\overline{\\sigma}(D_{scale}MD_{scale}^{-1})$。这个不等式对所有有效的缩放矩阵都成立。为了获得最紧的上界，我们对所有 $D_{scale} \\in \\mathcal{D}$ 取下确界：\n$$ \\mu_\\Delta(M) \\le \\inf_{D_{scale} \\in \\mathcal{D}} \\overline{\\sigma}(D_{scale}MD_{scale}^{-1}) $$\n\n对于问题中特定的2个重复复标量块的不确定性结构 $\\Delta = \\operatorname{diag}(\\delta_1 I_{r_1}, \\delta_2 I_{r_2})$，与之交换的正定缩放矩阵集合 $\\mathcal{D}$ 给出为：\n$$ D_{scale} = \\operatorname{diag}(d_1 I_{r_1}, d_2 I_{r_2}) \\quad \\text{其中 } d_1 > 0, d_2 > 0 $$\n设 $M$ 被一致地分块：$M = \\begin{bmatrix} A & B \\\\ C & D \\end{bmatrix}$，其块大小对应于 $r_1$ 和 $r_2$。相似性变换产生：\n$$ D_{scale}MD_{scale}^{-1} = \\begin{bmatrix} d_1 I_{r_1} & 0 \\\\ 0 & d_2 I_{r_2} \\end{bmatrix} \\begin{bmatrix} A & B \\\\ C & D \\end{bmatrix} \\begin{bmatrix} d_1^{-1} I_{r_1} & 0 \\\\ 0 & d_2^{-1} I_{r_2} \\end{bmatrix} = \\begin{bmatrix} A & (d_1/d_2)B \\\\ (d_2/d_1)C & D \\end{bmatrix} $$\n缩放后的矩阵仅取决于比率 $\\rho = d_1/d_2 > 0$。设这个缩放后的矩阵为 $M_\\rho$：\n$$ M_\\rho = \\begin{bmatrix} A & \\rho B \\\\ \\rho^{-1} C & D \\end{bmatrix} $$\n优化问题简化为对正标量 $\\rho$ 的一维搜索：\n$$ \\inf_{\\rho > 0} \\overline{\\sigma}(M_\\rho) $$\n为了进行数值求解，我们进行变量替换 $t = \\log \\rho$，将搜索域从 $\\rho \\in (0, \\infty)$ 转换为对 $t \\in \\mathbb{R}$ 的无约束搜索。对于此问题结构，目标函数 $f(t) = \\overline{\\sigma}(M_{e^t})$ 是关于 $t$ 的凸函数，这确保了局部最小值就是全局最小值。实现将利用数值优化器为每个测试用例找到这个最小值。\n对于情况 2，非对角块 $B$ 和 $C$ 是零矩阵，这使得对于所有 $\\rho>0$ 都有 $M_\\rho = M$。优化变得微不足道；结果就是 $\\overline{\\sigma}(M)$。对于其他情况，则需要进行数值搜索。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\nimport scipy\n\ndef solve():\n    \"\"\"\n    Main function to solve the given problem for all test cases.\n    It computes the mu-upper bound by optimizing over the scaling parameter rho.\n    \"\"\"\n\n    def compute_mu_upper_bound(M, r1):\n        \"\"\"\n        Computes the infimum of the block-diagonal D-scaling upper bound for mu.\n        This is inf_{rho>0} overline_sigma(M_rho), where M_rho is the scaled matrix.\n        \n        Args:\n            M (np.ndarray): The complex matrix M at frequency omega_0.\n            r1 (int): The size of the first block in the uncertainty structure.\n        \n        Returns:\n            float: The computed upper bound.\n        \"\"\"\n        n = M.shape[0]\n        r2 = n - r1\n\n        # Partition matrix M into A, B, C, D blocks\n        A = M[0:r1, 0:r1]\n        B = M[0:r1, r1:n]\n        C = M[r1:n, 0:r1]\n        D_block = M[r1:n, r1:n]\n\n        # Handle the trivial case where off-diagonal coupling blocks are zero.\n        # This is the case for M2, where M_rho is independent of rho.\n        if np.allclose(B, 0) and np.allclose(C, 0):\n            # The result is simply the largest singular value of the original matrix.\n            s = np.linalg.svd(M, compute_uv=False)\n            return np.max(s)\n\n        def objective_func(t):\n            \"\"\"\n            Objective function for the optimizer.\n            The variable t is log(rho).\n            \"\"\"\n            rho = np.exp(t)\n            \n            # Construct the scaled matrix M_rho\n            M_rho = np.block([\n                [A,           rho * B],\n                [1.0/rho * C, D_block]\n            ])\n            \n            # The value to minimize is the largest singular value (induced 2-norm).\n            # np.linalg.svd returns singular values in descending order.\n            s = np.linalg.svd(M_rho, compute_uv=False)\n            return s[0]\n\n        # Use a robust 1D optimizer. The search space for t is (-inf, inf).\n        # minimize_scalar's default (Brent) method is well-suited for this\n        # convex optimization problem.\n        result = minimize_scalar(objective_func)\n\n        return result.fun\n\n    # Define the test cases from the problem statement.\n    \n    # Case 1: r1=2, r2=2\n    M1 = np.array([\n        [0.2, 0.0, 5.0, 0.0],\n        [0.0, 0.2, 0.0, 4.0],\n        [0.2, 0.0, 0.2, 0.0],\n        [0.0, 0.1, 0.0, 0.2]\n    ])\n    r1_1 = 2\n\n    # Case 2: r1=1, r2=3\n    M2 = np.array([\n        [1.5, 0.0, 0.0, 0.0],\n        [0.0, 0.5, 0.0, 0.0],\n        [0.0, 0.0, 0.6, 0.0],\n        [0.0, 0.0, 0.0, 0.4]\n    ])\n    r1_2 = 1\n\n    # Case 3: r1=3, r2=1\n    M3 = np.array([\n        [0.1, 0.0, 0.0, 2.0],\n        [0.0, 0.1, 0.0, -1.0],\n        [0.0, 0.0, 0.1, 0.5],\n        [2.0, -1.0, 0.5, 0.1]\n    ])\n    r1_3 = 3\n\n    test_cases = [\n        (M1, r1_1),\n        (M2, r1_2),\n        (M3, r1_3)\n    ]\n\n    results = []\n    for M, r1 in test_cases:\n        bound = compute_mu_upper_bound(M, r1)\n        # Format the result to exactly 6 decimal places.\n        results.append(f\"{bound:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2758619"}]}