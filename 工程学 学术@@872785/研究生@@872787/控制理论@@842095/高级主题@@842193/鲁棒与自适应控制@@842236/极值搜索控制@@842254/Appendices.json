{"hands_on_practices": [{"introduction": "掌握任何控制策略的第一步都是理解其核心工作原理。本练习将引导您从第一性原理出发，分析一个经典的单输入单输出 (SISO) 极值搜寻控制 (ESC) 回路。通过推导其平均化慢速动力学，您将揭示正弦扰动和解调过程如何巧妙地协同作用，以估算出未知成本函数的梯度，从而为理解ESC为何有效奠定基石 ([@problem_id:2706287])。", "problem": "考虑一个经典的单输入单输出极值搜寻控制（ESC）回路，用于最小化一个未知的平滑静态映射。对象输出建模为 $y(t) = J(\\theta(t))$，其中 $J \\in C^{3}(\\mathbb{R}, \\mathbb{R})$ 在 $\\theta^{\\star}$ 处有唯一的非退化极小值点，满足 $J'(\\theta^{\\star}) = 0$ 和 $J''(\\theta^{\\star})  0$。ESC 回路在对象输入端注入一个正弦抖动信号，并按如下方式解调输出：\n- 对象输入为 $\\theta(t) = u(t) + a \\sin(\\omega t)$，其中 $a  0$ 且 $\\omega  0$。\n- 对象输出 $y(t)$ 通过一个高通滤波器 $F(s) = \\dfrac{s}{s + \\omega_{h}}$（其中 $\\omega_{h}  0$），生成 $r(t)$。\n- 信号 $r(t)$ 乘以参考信号 $\\sin(\\omega t + \\phi)$，其中 $\\phi \\in \\mathbb{R}$ 是一个以弧度为单位的恒定解调相位。\n- 乘积通过一个低通滤波器 $G(s) = \\dfrac{\\omega_{\\ell}}{s + \\omega_{\\ell}}$（其中 $\\omega_{\\ell}  0$），生成 $v(t)$。\n- 自适应律为积分器 $\\dot{u}(t) = -k\\,v(t)$，其中 $k  0$。\n\n假设存在标准的 ESC 尺度分离：$a$ 足够小，$\\omega$ 足够大以致平均法有效，$\\omega_{\\ell} \\ll \\omega$ 使得 $G(s)$ 能通过直流分量并衰减 $\\omega$ 附近及以上的谐波，且高通滤波器 $F(s)$ 在抖动频率处具有良好定义的稳态正弦频率响应值 $F(\\mathrm{j}\\omega)$。\n\n仅使用第一性原理（泰勒展开、线性时不变系统的正弦稳态响应、三角恒等式和平均法），推导形如\n$$\n\\dot{\\bar{u}}(t) \\;=\\; -k\\,K_{\\mathrm{eff}}\\,J'\\big(\\bar{u}(t)\\big) \\;+\\; \\text{关于 } a \\text{ 的高阶项},\n$$\n的主阶平均慢动态，并确定等效标量增益 $K_{\\mathrm{eff}}$ 作为 $a$、$\\omega$、$\\omega_{h}$ 和 $\\phi$ 的函数的闭式表达式。你可以将 $G(s)$ 的直流增益视为 $1$，即 $G(0)=1$。在平均化之后，忽略所有关于 $a$ 的高于一阶的贡献项。请将 $K_{\\mathrm{eff}}$ 的最终结果以单一的简化解析表达式形式给出。不需要进行数值近似。", "solution": "我们首先对问题陈述进行形式化验证。\n\n首先，我们逐字提取已知条件：\n- 对象输出模型：$y(t) = J(\\theta(t))$\n- 静态映射的性质：$J \\in C^{3}(\\mathbb{R}, \\mathbb{R})$ 在 $\\theta^{\\star}$ 处有唯一的非退化极小值点，满足 $J'(\\theta^{\\star}) = 0$ 和 $J''(\\theta^{\\star})  0$。\n- 对象输入信号：$\\theta(t) = u(t) + a \\sin(\\omega t)$，其中 $a  0$ 且 $\\omega  0$。\n- 高通滤波器：$F(s) = \\dfrac{s}{s + \\omega_{h}}$，其中 $\\omega_{h}  0$。输出为 $r(t)$。\n- 解调信号：$\\sin(\\omega t + \\phi)$，其中 $\\phi \\in \\mathbb{R}$。\n- 低通滤波器：$G(s) = \\dfrac{\\omega_{\\ell}}{s + \\omega_{\\ell}}$，其中 $\\omega_{\\ell}  0$。输出为 $v(t)$。\n- 自适应律：$\\dot{u}(t) = -k\\,v(t)$，其中 $k  0$。\n- 假设：$a$ 足够小，$\\omega$ 足够大，$\\omega_{\\ell} \\ll \\omega$，$G(s)$ 的直流增益为 $G(0)=1$，且 $F(\\mathrm{j}\\omega)$ 有良好定义。\n- 目标：推导平均慢动态 $\\dot{\\bar{u}}(t) = -k\\,K_{\\mathrm{eff}}\\,J'(\\bar{u}(t)) + \\text{h.o.t.}$ 并求出 $K_{\\mathrm{eff}}$ 的闭式表达式。\n\n接下来，我们验证该问题。\n该问题具有科学依据，描述了一个标准的极值搜寻控制回路，这是控制理论中一个成熟的课题。其组成部分（滤波器、抖动信号、自适应律）和分析方法（平均法）都是经典的。该问题是适定的；尺度分离的假设是标准的，并且是使平均法分析易于处理并产生唯一的主阶动态模型所必需的。语言客观且数学上精确。问题设定是自洽的，没有矛盾。该问题没有违反任何指定的无效性标准。\n\n因此，该问题被认为是有效的。我们可以开始求解。\n\n分析的关键在于平均法原理，为此我们假设存在时间尺度分离，即与高频抖动信号 $\\sin(\\omega t)$ 相比，$u(t)$ 是一个慢变信号，记为 $\\bar{u}(t)$。\n\n首先，我们将对象输出 $y(t) = J(\\theta(t))$ 在慢变分量 $\\bar{u}(t)$ 附近进行泰勒级数展开。\n$$\ny(t) = J(\\bar{u}(t) + a \\sin(\\omega t)) = J(\\bar{u}(t)) + J'(\\bar{u}(t)) [a \\sin(\\omega t)] + \\frac{1}{2} J''(\\bar{u}(t)) [a \\sin(\\omega t)]^2 + O(a^3)\n$$\n使用恒等式 $\\sin^2(x) = \\frac{1}{2}(1 - \\cos(2x))$，展开式变为：\n$$\ny(t) = J(\\bar{u}(t)) + a J'(\\bar{u}(t)) \\sin(\\omega t) + \\frac{a^2}{4} J''(\\bar{u}(t)) (1 - \\cos(2\\omega t)) + O(a^3)\n$$\n$$\ny(t) = \\left( J(\\bar{u}(t)) + \\frac{a^2}{4} J''(\\bar{u}(t)) \\right) + a J'(\\bar{u}(t)) \\sin(\\omega t) - \\frac{a^2}{4} J''(\\bar{u}(t)) \\cos(2\\omega t) + O(a^3)\n$$\n这个输出信号 $y(t)$ 由一个直流（或慢变）部分、一个在抖动频率 $\\omega$ 的分量、一个在频率 $2\\omega$ 的分量，以及更高阶的项组成。\n\n第二，该信号通过高通滤波器 $F(s) = \\frac{s}{s+\\omega_h}$。由于 $F(0)=0$，直流分量被阻断。我们分析滤波器对频率为 $\\omega$ 的正弦分量 $a J'(\\bar{u}(t)) \\sin(\\omega t)$ 的稳态响应。滤波器的频率响应为 $F(\\mathrm{j}\\omega)$。我们将其表示为极坐标形式：\n$$\nF(\\mathrm{j}\\omega) = \\frac{\\mathrm{j}\\omega}{\\mathrm{j}\\omega + \\omega_h}\n$$\n幅值为 $|F(\\mathrm{j}\\omega)| = \\frac{|\\mathrm{j}\\omega|}{|\\mathrm{j}\\omega + \\omega_h|} = \\frac{\\omega}{\\sqrt{\\omega^2 + \\omega_h^2}}$。\n相位为 $\\angle F(\\mathrm{j}\\omega) = \\angle(\\mathrm{j}\\omega) - \\angle(\\omega_h + \\mathrm{j}\\omega) = \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{\\omega_h}\\right)$。\n\n因此，滤波器输出 $r(t)$ 在频率 $\\omega$ 处的分量为：\n$$\nr_{\\omega}(t) = a J'(\\bar{u}(t)) |F(\\mathrm{j}\\omega)| \\sin(\\omega t + \\angle F(\\mathrm{j}\\omega))\n$$\n在频率 $2\\omega$ 及更高的项也会通过，但它们将被后续的低通滤波和平均化过程去除，因此我们在主阶分析中无需追踪它们。\n\n第三，信号 $r(t)$ 与解调信号 $\\sin(\\omega t + \\phi)$ 相乘。我们关心的是这个乘积的直流分量。设 $p(t) = r(t) \\sin(\\omega t + \\phi)$。对平均值有贡献的主导项来自 $r_{\\omega}(t)$：\n$$\np(t) \\approx r_{\\omega}(t) \\sin(\\omega t + \\phi) = a J'(\\bar{u}(t)) |F(\\mathrm{j}\\omega)| \\sin(\\omega t + \\angle F(\\mathrm{j}\\omega)) \\sin(\\omega t + \\phi)\n$$\n使用三角恒等式 $\\sin(A)\\sin(B) = \\frac{1}{2}[\\cos(A-B) - \\cos(A+B)]$：\n$$\np(t) = \\frac{a}{2} J'(\\bar{u}(t)) |F(\\mathrm{j}\\omega)| \\left[ \\cos(\\angle F(\\mathrm{j}\\omega) - \\phi) - \\cos(2\\omega t + \\angle F(\\mathrm{j}\\omega) + \\phi) \\right]\n$$\n这个乘积信号 $p(t)$ 有一个直流分量和一个在 $2\\omega$ 处的高频分量。\n\n第四，该信号 $p(t)$ 通过低通滤波器 $G(s) = \\frac{\\omega_{\\ell}}{s+\\omega_{\\ell}}$。根据假设 $\\omega_{\\ell} \\ll \\omega$，该滤波器会衰减在 $2\\omega$ 处的高频分量，并通过直流分量。滤波器的直流增益给定为 $G(0)=1$。低通滤波器的输出 $v(t)$ 近似为其输入 $p(t)$ 的直流分量。根据平均法原理，$v(t)$ 的慢变部分，记为 $\\bar{v}(t)$，是 $p(t)$ 的平均值：\n$$\n\\bar{v}(t) = \\text{avg}[p(t)] = \\frac{a}{2} J'(\\bar{u}(t)) |F(\\mathrm{j}\\omega)| \\cos(\\angle F(\\mathrm{j}\\omega) - \\phi)\n$$\n所有其他源于 $y(t)$ 泰勒展开的项，要么是关于 $a$ 的更高阶项，要么是处于高频段，其平均值为零。\n\n最后，我们求出 $\\bar{u}(t)$ 的平均动态。自适应律为 $\\dot{u}(t) = -k v(t)$。应用平均法定理，慢变量 $\\bar{u}(t)$ 的演化由以下方程支配：\n$$\n\\dot{\\bar{u}}(t) = -k \\bar{v}(t) = -k \\left[ \\frac{a}{2} |F(\\mathrm{j}\\omega)| \\cos(\\angle F(\\mathrm{j}\\omega) - \\phi) \\right] J'(\\bar{u}(t))\n$$\n该方程符合所需形式 $\\dot{\\bar{u}}(t) = -k K_{\\mathrm{eff}} J'(\\bar{u}(t))$，其中等效增益 $K_{\\mathrm{eff}}$ 为：\n$$\nK_{\\mathrm{eff}} = \\frac{a}{2} |F(\\mathrm{j}\\omega)| \\cos(\\angle F(\\mathrm{j}\\omega) - \\phi)\n$$\n现在，我们代入 $F(\\mathrm{j}\\omega)$ 的幅值和相位的表达式：\n$$\nK_{\\mathrm{eff}} = \\frac{a}{2} \\frac{\\omega}{\\sqrt{\\omega^2 + \\omega_h^2}} \\cos\\left(\\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{\\omega_h}\\right) - \\phi\\right)\n$$\n我们使用恒等式 $\\cos(\\frac{\\pi}{2} - A) = \\sin(A)$，令 $A = \\arctan(\\frac{\\omega}{\\omega_h}) + \\phi$：\n$$\nK_{\\mathrm{eff}} = \\frac{a}{2} \\frac{\\omega}{\\sqrt{\\omega^2 + \\omega_h^2}} \\sin\\left(\\arctan\\left(\\frac{\\omega}{\\omega_h}\\right) + \\phi\\right)\n$$\n使用正弦和角公式 $\\sin(X+Y) = \\sin(X)\\cos(Y) + \\cos(X)\\sin(Y)$，其中 $X = \\arctan(\\frac{\\omega}{\\omega_h})$ 且 $Y=\\phi$：\n$$\n\\sin\\left(\\arctan\\left(\\frac{\\omega}{\\omega_h}\\right)\\right) = \\frac{\\omega}{\\sqrt{\\omega^2 + \\omega_h^2}} \\quad \\text{且} \\quad \\cos\\left(\\arctan\\left(\\frac{\\omega}{\\omega_h}\\right)\\right) = \\frac{\\omega_h}{\\sqrt{\\omega^2 + \\omega_h^2}}\n$$\n将这些代入正弦和角公式：\n$$\n\\sin\\left(\\arctan\\left(\\frac{\\omega}{\\omega_h}\\right) + \\phi\\right) = \\frac{\\omega}{\\sqrt{\\omega^2 + \\omega_h^2}}\\cos(\\phi) + \\frac{\\omega_h}{\\sqrt{\\omega^2 + \\omega_h^2}}\\sin(\\phi) = \\frac{\\omega\\cos(\\phi) + \\omega_h\\sin(\\phi)}{\\sqrt{\\omega^2 + \\omega_h^2}}\n$$\n最后，我们将此结果代回 $K_{\\mathrm{eff}}$ 的表达式中：\n$$\nK_{\\mathrm{eff}} = \\frac{a}{2} \\frac{\\omega}{\\sqrt{\\omega^2 + \\omega_h^2}} \\left( \\frac{\\omega\\cos(\\phi) + \\omega_h\\sin(\\phi)}{\\sqrt{\\omega^2 + \\omega_h^2}} \\right)\n$$\n化简此表达式得到等效增益的最终结果：\n$$\nK_{\\mathrm{eff}} = \\frac{a \\omega (\\omega \\cos(\\phi) + \\omega_h \\sin(\\phi))}{2 (\\omega^2 + \\omega_h^2)}\n$$\n这就是等效标量增益 $K_{\\mathrm{eff}}$ 作为 $a$、$\\omega$、$\\omega_h$ 和 $\\phi$ 的函数的闭式表达式。", "answer": "$$\n\\boxed{\\frac{a \\omega (\\omega \\cos(\\phi) + \\omega_h \\sin(\\phi))}{2 (\\omega^2 + \\omega_h^2)}}\n$$", "id": "2706287"}, {"introduction": "理论模型与实际应用之间往往存在差距，而系统动态特性是关键因素之一。本练习在理想ESC模型的基础上，引入了常见的挑战性动态——时间延迟和非最小相位零点。通过分析这些动态如何引入相位滞后，进而破坏梯度估计并可能导致系统失稳，您将深入理解ESC在实际应用中的稳定边界，并认识到相位管理的重要性 ([@problem_id:2706305])。", "problem": "考虑一个极值搜寻控制（ESC）回路，其设计目的是最小化一个未知的、二次连续可微的成本函数 $J(u)$。该函数在 $u^{\\star}$ 处有一个唯一的严格局部最小值，其中 $J'(u^{\\star}) = 0$ 且 $J''(u^{\\star})  0$。该 ESC 使用一个小的正弦扰动来探测成本梯度，同时调整一个缓慢变化的输入。信号定义如下，所有角度单位为弧度，所有频率单位为 $\\mathrm{rad/s}$：\n- 可调输入为 $x(t)$，被控对象输入为 $u(t) = x(t) + a \\sin(\\omega t)$，其中 $a  0$ 是抖动幅值，$\\omega  0$ 是抖动频率。\n- 测量信号是通过将 $J(u(t))$ 通过一个线性时不变通道生成的，该通道的传递函数为 $H(s) = \\left(1 - \\frac{s}{z}\\right)\\exp(-s \\tau)$，其中 $z  0$ 模拟了位于 $s = +z$ 的单个右半平面（非最小相位）零点，$\\tau \\ge 0$ 是一个输入延迟。\n- ESC 解调器将测量信号乘以 $\\sin(\\omega t)$，然后将其通过一个理想低通滤波器。该滤波器在零频率处具有单位增益且无相位失真，其截止频率严格低于 $2\\omega$，以便滤除高次谐波。\n- 自适应律为 $\\dot{x}(t) = -\\kappa\\,q(t)$，其中 $\\kappa  0$ 很小，而 $q(t)$ 是低通滤波后的解调输出。\n\n假设 $a$ 和 $\\kappa$ 足够小，以支持一阶泰勒展开和一次谐波平均：将 $J(x(t) + a \\sin(\\omega t))$ 在 $x(t)$ 周围对 $a$ 进行一阶展开，在通过 $H(s)$ 的响应中仅保留基波分量，并对一个周期内的调制乘积进行平均。假设除了 $H(s)$ 和理想低通滤波器之外，回路中所有其他动态在频率 $\\omega$ 处均可忽略（特别是，低通滤波器是理想的，并且在平均保留的任何频率上都不产生相位偏移）。\n\n仅使用线性时不变系统的正弦稳态响应、三角函数的积化和差恒等式以及平均法，推导 $x(t)$ 在 $u^{\\star}$ 附近的平均慢动态，并确定在频率 $\\omega$ 处的总相位 $\\phi$ 需满足的条件，以保证平均后的自适应是 $J$ 的局部下降。然后，针对 $H(s) = \\left(1 - \\frac{s}{z}\\right)\\exp(-s \\tau)$ 的特定情况，计算最大输入延迟 $\\tau_{\\max}$（单位为秒），将其表示为 $\\omega$ 和 $z$ 的显式符号函数，使得平均后的 ESC 动态在 $u^{\\star}$ 的一个邻域内保持为局部下降方向。\n\n将你的最终答案表示为 $\\tau_{\\max}(\\omega,z)$ 关于 $\\omega$ 和 $z$ 的闭式解析表达式。最终表达式中不要包含单位。所有角度必须以弧度表示。", "solution": "该问题要求推导极值搜寻控制（ESC）系统的稳定性条件，并针对给定的被控对象通道动态，找出最大可容忍输入延迟 $\\tau_{\\max}$。分析将通过对系统的慢动态应用平均法来进行。\n\n未知成本函数 $J(u)$ 的输入为 $u(t) = x(t) + a \\sin(\\omega t)$，其中 $x(t)$ 是最优输入 $u^{\\star}$ 的缓慢变化估计值，而 $a \\sin(\\omega t)$ 是一个幅值为 $a  0$、频率为 $\\omega  0$ 的小抖动信号。成本函数的输出为 $y(t) = J(u(t))$。\n\n由于 $x(t)$ 相对于抖动频率 $\\omega$ 变化缓慢，且抖动幅值 $a$ 很小，我们可以通过对 $J(u(t))$ 在 $x(t)$ 周围进行泰勒级数展开来分析该系统。我们展开到二阶，以捕捉对极值搜寻至关重要的局部曲率信息。\n$$J(x(t) + a \\sin(\\omega t)) \\approx J(x(t)) + J'(x(t)) a \\sin(\\omega t) + \\frac{1}{2} J''(x(t)) (a \\sin(\\omega t))^2$$\n使用三角恒等式 $\\sin^2(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$， $y(t)$ 的表达式变为：\n$$y(t) \\approx J(x(t)) + J'(x(t)) a \\sin(\\omega t) + \\frac{a^2}{4} J''(x(t)) (1 - \\cos(2\\omega t))$$\n$$y(t) \\approx \\left( J(x(t)) + \\frac{a^2}{4} J''(x(t)) \\right) + a J'(x(t)) \\sin(\\omega t) - \\frac{a^2}{4} J''(x(t)) \\cos(2\\omega t)$$\n该信号 $y(t)$ 是具有传递函数 $H(s)$ 的线性时不变（LTI）通道的输入。问题陈述要求在响应中只保留基波分量。然而，更完整的分析会考虑所有分量，并在之后将它们滤除。信号 $y(t)$ 包含一个直流分量、一个在基频 $\\omega$ 上的分量，以及一个在二次谐波 $2\\omega$ 上的分量。通道的输出 $y_m(t)$ 是通过考虑对每个分量的稳态响应得到的。令 $\\phi(\\Omega) = \\angle H(j\\Omega)$ 为通道在频率 $\\Omega$ 处的相位。\n测量信号 $y_m(t)$ 由下式给出：\n$$y_m(t) \\approx H(0) \\left( J(x) + \\frac{a^2}{4} J''(x) \\right) + |H(j\\omega)| a J'(x) \\sin(\\omega t + \\phi(\\omega)) - |H(j2\\omega)| \\frac{a^2}{4} J''(x) \\cos(2\\omega t + \\phi(2\\omega))$$\n给定 $H(s) = (1 - \\frac{s}{z})\\exp(-s\\tau)$，我们有 $H(0) = 1$。令 $\\phi \\equiv \\phi(\\omega) = \\angle H(j\\omega)$。$y_m(t)$ 的表达式简化为：\n$$y_m(t) \\approx J(x) + \\frac{a^2}{4} J''(x) + a |H(j\\omega)| J'(x) \\sin(\\omega t + \\phi) - \\dots$$\n其中省略号代表更高频率的项。\n\n解调步骤将 $y_m(t)$ 乘以 $\\sin(\\omega t)$。所得信号随后通过一个理想低通滤波器（LPF），该滤波器提取直流（平均）分量。LPF 的输出是 $q(t)$。\n$$q(t) = \\text{LPF}\\{ y_m(t) \\sin(\\omega t) \\}$$\n为了求 $q(t)$ 的平均值，我们计算乘积 $y_m(t) \\sin(\\omega t)$ 在一个周期 $T = 2\\pi/\\omega$ 内的平均值。对于整数 $k \\ge 1$，任何形如 $\\sin(k\\omega t + \\theta)$ 或 $\\cos(k\\omega t + \\theta)$ 的项的平均值均为零。我们使用积化和差恒等式 $\\sin(A)\\sin(B) = \\frac{1}{2}(\\cos(A-B) - \\cos(A+B))$。\n解调信号的平均值为：\n$$q_{avg} = \\left\\langle \\left( J(x) + \\frac{a^2}{4} J''(x) + \\dots \\right) \\sin(\\omega t) \\right\\rangle + \\left\\langle a |H(j\\omega)| J'(x) \\sin(\\omega t + \\phi) \\sin(\\omega t) \\right\\rangle - \\dots$$\n涉及直流分量和 $\\sin(\\omega t)$ 乘积的项平均值为零。来自二次谐波的项平均值也为零，因为 $\\langle \\cos(2\\omega t + \\phi(2\\omega))\\sin(\\omega t) \\rangle = 0$。唯一产生非零平均值的项是来自基波分量的项：\n$$q_{avg} = \\left\\langle a |H(j\\omega)| J'(x) \\frac{1}{2} (\\cos(\\phi) - \\cos(2\\omega t + \\phi)) \\right\\rangle$$\n$$q_{avg} = \\frac{a}{2} |H(j\\omega)| \\cos(\\phi) J'(x)$$\n慢变量 $x(t)$ 的自适应律是 $\\dot{x}(t) = -\\kappa q(t)$。使用平均法，平均系统的动态为：\n$$\\dot{x}_{avg} = -\\kappa q_{avg} = -\\kappa \\frac{a}{2} |H(j\\omega)| \\cos(\\phi) J'(x)$$\n为了使 ESC 成为成本函数 $J(x)$ 的局部下降，系统必须表现得像梯度下降算法，即 $\\dot{x}_{avg}$ 必须与梯度 $J'(x)$ 的符号相反。这确保了如果 $x(t)$ 不在最小值处，它会向最小值移动。为了分析最优值 $u^\\star$ 附近的局部稳定性，我们在 $u^{\\star}$ 周围对动态进行线性化。令 $x(t) = u^{\\star} + \\delta_x(t)$。对于小的 $\\delta_x$，我们使用泰勒展开 $J'(x) \\approx J'(u^{\\star}) + J''(u^{\\star})(x-u^{\\star})$。由于 $J'(u^{\\star}) = 0$，我们有 $J'(x) \\approx J''(u^{\\star})\\delta_x$。\n偏差 $\\delta_x(t)$ 的动态为：\n$$\\dot{\\delta}_{x,avg} = -\\left( \\frac{\\kappa a}{2} |H(j\\omega)| \\cos(\\phi) J''(u^{\\star}) \\right) \\delta_x$$\n为了保证局部稳定性，$\\delta_x$ 的系数必须为负，从而使得 $\\delta_x \\to 0$。考虑到 $\\kappa  0$，$a  0$，$|H(j\\omega)|  0$，并且 $J''(u^\\star)  0$（因为 $u^\\star$ 是一个严格的局部最小值），稳定性条件简化为：\n$$\\cos(\\phi)  0$$\n这是保证局部下降的相位 $\\phi = \\angle H(j\\omega)$ 的通用条件。该条件意味着 $-\\frac{\\pi}{2}  \\phi  \\frac{\\pi}{2}$（模 $2\\pi$）。\n\n现在我们针对给定的传递函数 $H(s) = \\left(1 - \\frac{s}{z}\\right)\\exp(-s \\tau)$ 进行分析。我们计算它在 $s = j\\omega$ 处的相位：\n$$H(j\\omega) = \\left(1 - j\\frac{\\omega}{z}\\right)\\exp(-j\\omega \\tau)$$\n相位 $\\phi$ 是两个因子相位的和：\n$$\\phi = \\angle\\left(1 - j\\frac{\\omega}{z}\\right) + \\angle(\\exp(-j\\omega \\tau))$$\n第一项对应一个复数，其实部为正（$1$），虚部为负（$-\\omega/z$，因为 $\\omega, z  0$）。其相位由 $\\arctan(-\\omega/z) = -\\arctan(\\omega/z)$ 给出。第二项，即纯延迟，贡献了 $-\\omega\\tau$ 的相位。\n因此，总相位为：\n$$\\phi = -\\arctan\\left(\\frac{\\omega}{z}\\right) - \\omega \\tau$$\n为了使平均动态成为局部下降，我们必须满足 $\\cos(\\phi)  0$。由于 $\\omega0, z0, \\tau \\ge 0$，项 $-\\arctan(\\omega/z)$ 位于区间 $(-\\frac{\\pi}{2}, 0)$ 内，并且 $-\\omega\\tau \\le 0$。因此，总相位 $\\phi$ 始终是非正的。对于一个非正角度 $\\phi$，条件 $\\cos(\\phi)0$ 等价于 $\\phi  -\\frac{\\pi}{2}$。\n$$-\\arctan\\left(\\frac{\\omega}{z}\\right) - \\omega \\tau  -\\frac{\\pi}{2}$$\n我们求解延迟 $\\tau$：\n$$\\omega \\tau  \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{z}\\right)$$\n$$\\tau  \\frac{1}{\\omega} \\left(\\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{z}\\right)\\right)$$\n使该条件成立的最大输入延迟 $\\tau_{\\max}$ 是使不等式变为等式的值。\n$$\\tau_{\\max} = \\frac{1}{\\omega} \\left(\\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{z}\\right)\\right)$$\n该表达式给出了最大可容忍延迟作为抖动频率 $\\omega$ 和非最小相位零点位置 $z$ 的函数。", "answer": "$$\\boxed{\\frac{1}{\\omega} \\left(\\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{z}\\right)\\right)}$$", "id": "2706305"}, {"introduction": "许多现实世界的最优化问题都涉及多个可调参数，这就要求我们将ESC从单变量扩展到多变量系统。本练习将向您介绍一种强大的技术：使用正交扰动信号来同时独立地估计多变量成本函数的各个偏导数。通过推导多变量ESC系统的平均化误差动力学，您将学会如何分析其稳定性和性能，为解决更复杂的优化问题做好准备 ([@problem_id:2706364])。", "problem": "考虑一个静态成本图 $J:\\mathbb{R}^2 \\to \\mathbb{R}$，由下式给出\n$$\nJ(u) \\;=\\; \\frac{1}{2}\\,(u - u^\\star)^\\top H\\,(u - u^\\star),\n$$\n其中 $u = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$，$u^\\star = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$，且\n$$\nH \\;=\\; \\begin{pmatrix} 6  2 \\\\ 2  4 \\end{pmatrix},\n$$\n该矩阵是对称正定的。您实现了一个双通道极值搜寻控制（Extremum Seeking Control, ESC）方案，其正交抖动信号定义如下。被控对象输入为\n$$\nu_i(t) \\;=\\; \\hat u_i(t) \\;+\\; a_i\\, d_i(t), \\quad i \\in \\{1,2\\},\n$$\n其中 $\\hat u(t) \\in \\mathbb{R}^2$ 是待自适应的慢变估计值，$a_1, a_2  0$ 是恒定的抖动幅值，抖动信号为\n$$\nd_1(t) \\;=\\; \\sin(\\omega t), \\qquad d_2(t) \\;=\\; \\cos(\\omega t),\n$$\n其中 $\\omega  0$。测量输出为 $y(t) = J(u(t))$。每个通道使用同步解调，后接理想低通滤波器，该滤波器建模为在一个抖动周期 $T = 2\\pi/\\omega$ 上的理想平均：\n$$\nz_i(t) \\;=\\; \\frac{1}{T} \\int_{t}^{t+T} y(\\tau)\\, d_i(\\tau)\\, \\mathrm{d}\\tau, \\quad i \\in \\{1,2\\}.\n$$\n自适应律为\n$$\n\\dot{\\hat u}_i(t) \\;=\\; -\\,k_i\\, z_i(t), \\quad k_1, k_2  0.\n$$\n假设处于标准的小信号、高频率条件下：$a_1, a_2$ 足够小且 $\\omega$ 足够大，使得一阶平均能准确捕捉慢速自适应动态，且高阶项可以忽略。\n\n任务：从上述定义出发，仅使用泰勒展开和抖动信号在一个周期内的正交性等第一性原理，推导 $e(t) \\coloneqq \\hat u(t) - u^\\star$ 的平均闭环误差动态。然后，对于具体的参数值 $a_1 = a_2 = 1$ 和 $k_1 = k_2 = 4$，精确计算平均线性误差动态矩阵的两个特征值。使用 $\\texttt{pmatrix}$ 环境，将您的最终答案表示为一个包含两个特征值的单行矩阵。最终答案无需四舍五入，也无需物理单位。", "solution": "在尝试任何解答之前，需对问题进行验证。\n\n步骤1：提取已知条件。\n提供的信息如下：\n- 成本图：$J(u) = \\frac{1}{2}(u - u^\\star)^\\top H (u - u^\\star)$，其中 $u = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} \\in \\mathbb{R}^2$。\n- 最优点：$u^\\star = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。\n- 海森矩阵：$H = \\begin{pmatrix} 6  2 \\\\ 2  4 \\end{pmatrix}$，已知其为对称正定。\n- 被控对象输入：$u_i(t) = \\hat u_i(t) + a_i d_i(t)$ 对于 $i \\in \\{1, 2\\}$，其中 $\\hat u(t)$ 是估计值。\n- 抖动幅值：$a_1, a_2  0$。\n- 抖动信号：$d_1(t) = \\sin(\\omega t)$，$d_2(t) = \\cos(\\omega t)$，频率为 $\\omega  0$。\n- 测量输出：$y(t) = J(u(t))$。\n- 解调：$z_i(t) = \\frac{1}{T} \\int_{t}^{t+T} y(\\tau) d_i(\\tau) \\mathrm{d}\\tau$，周期为 $T = 2\\pi/\\omega$。\n- 自适应律：$\\dot{\\hat u}_i(t) = -k_i z_i(t)$，增益为 $k_1, k_2  0$。\n- 假设：小抖动幅值和高抖动频率，这使得一阶平均法合理。\n- 任务：推导误差 $e(t) \\coloneqq \\hat u(t) - u^\\star$ 的平均闭环动态。\n- 用于最终计算的特定参数：$a_1 = a_2 = 1$，$k_1 = k_2 = 4$。\n- 最终目标：计算所得平均线性误差动态矩阵的两个特征值。\n\n步骤2：使用提取的已知条件进行验证。\n该问题是多变量极值搜寻控制分析中的一个标准练习。\n- **科学依据**：该问题基于控制理论的既定原理，特别是应用于极值搜寻系统的平均法理论。成本函数是二次型，是优化的一个典型模型。海森矩阵 $H$ 的行列式为 $\\det(H) = (6)(4) - (2)(2) = 20  0$，迹为 $\\text{tr}(H)=6+4=10  0$，证实其如所述为正定。因此，$J(u)$ 有唯一的最小值。该设置在科学上是合理的。\n- **适定性**：该问题提供了推导唯一解所需的所有必要函数、参数和假设。目标定义清晰明确。\n- **客观性**：该问题使用精确的数学语言陈述，不含任何主观或非形式化元素。\n\n步骤3：结论与行动。\n问题有效。它自成体系、一致，并基于既定的控制理论。将推导解答。\n\n分析首先将系统输出 $y(t)$ 表示为慢变估计值 $\\hat u(t)$ 和快变抖动信号的函数。我们利用成本函数 $J(u)$ 在估计值 $\\hat u(t)$ 附近进行的二阶泰勒级数展开。输入为 $u(t) = \\hat u(t) + \\delta(t)$，其中 $\\delta(t) = \\begin{pmatrix} a_1 d_1(t) \\\\ a_2 d_2(t) \\end{pmatrix}$。\n\n展开式为：\n$$\nJ(u(t)) = J(\\hat u(t) + \\delta(t)) \\approx J(\\hat u(t)) + \\nabla J(\\hat u(t))^\\top \\delta(t) + \\frac{1}{2} \\delta(t)^\\top \\nabla^2 J(\\hat u(t)) \\delta(t)\n$$\n对于给定的二次成本函数，其梯度和海森矩阵为：\n$$\n\\nabla J(u) = H(u - u^\\star)\n$$\n$$\n\\nabla^2 J(u) = H\n$$\n将这些代入展开式并在 $\\hat u(t)$ 处求值：\n$$\n\\nabla J(\\hat u(t)) = H(\\hat u(t) - u^\\star) = H e(t)\n$$\n$$\ny(t) = J(u(t)) \\approx J(\\hat u(t)) + e(t)^\\top H \\delta(t) + \\frac{1}{2} \\delta(t)^\\top H \\delta(t)\n$$\n这里，$e(t) = \\hat u(t) - u^\\star$ 是误差向量，假设其相对于抖动频率 $\\omega$ 是慢变的。\n\n接下来，我们计算解调信号 $z_i(t)$。在高频假设下，低通滤波器（建模为理想平均器）会移除所有高频分量。我们将 $e(t)$ 和 $\\hat u(t)$ 在积分区间 $[t, t+T]$ 上视为常数。\n$$\nz_i(t) \\approx \\frac{1}{T} \\int_{t}^{t+T} \\left( J(\\hat u) + e^\\top H \\delta(\\tau) + \\frac{1}{2} \\delta(\\tau)^\\top H \\delta(\\tau) \\right) d_i(\\tau) \\mathrm{d}\\tau\n$$\n我们分析积分的每一项：\n\n1.  项 $\\frac{1}{T} \\int_{t}^{t+T} J(\\hat u) d_i(\\tau) \\mathrm{d}\\tau = J(\\hat u) \\frac{1}{T} \\int_{t}^{t+T} d_i(\\tau) \\mathrm{d}\\tau = 0$，因为 $\\sin(\\omega \\tau)$ 和 $\\cos(\\omega \\tau)$ 在一个周期内的平均值为零。\n\n2.  涉及梯度的项是 $\\frac{1}{T} \\int_{t}^{t+T} (e^\\top H \\delta(\\tau)) d_i(\\tau) \\mathrm{d}\\tau$。\n    令 $(e^\\top H)_j$ 为行向量 $e^\\top H$ 的第 $j$ 个分量。则 $e^\\top H \\delta(\\tau) = \\sum_{j=1}^2 (e^\\top H)_j a_j d_j(\\tau)$。\n    积分为 $\\sum_{j=1}^2 (e^\\top H)_j a_j \\left( \\frac{1}{T} \\int_{t}^{t+T} d_j(\\tau) d_i(\\tau) \\mathrm{d}\\tau \\right)$。\n    我们使用抖动信号在一个周期 $T=2\\pi/\\omega$ 上的正交性质：\n    $$\n    \\frac{1}{T} \\int_{t}^{t+T} d_1^2(\\tau) \\mathrm{d}\\tau = \\frac{1}{T} \\int_{t}^{t+T} \\sin^2(\\omega\\tau) \\mathrm{d}\\tau = \\frac{1}{2}\n    $$\n    $$\n    \\frac{1}{T} \\int_{t}^{t+T} d_2^2(\\tau) \\mathrm{d}\\tau = \\frac{1}{T} \\int_{t}^{t+T} \\cos^2(\\omega\\tau) \\mathrm{d}\\tau = \\frac{1}{2}\n    $$\n    $$\n    \\frac{1}{T} \\int_{t}^{t+T} d_1(\\tau)d_2(\\tau) \\mathrm{d}\\tau = \\frac{1}{T} \\int_{t}^{t+T} \\sin(\\omega\\tau)\\cos(\\omega\\tau) \\mathrm{d}\\tau = 0\n    $$\n    这可以总结为 $\\frac{1}{T} \\int_{t}^{t+T} d_j(\\tau)d_i(\\tau) \\mathrm{d}\\tau = \\frac{1}{2}\\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克（Kronecker）delta。\n    因此，求和简化为 $\\frac{1}{2} (e^\\top H)_i a_i$。由于 $H$ 是对称的，$(e^\\top H)_i = (H e)_i$。所以这一项是 $\\frac{a_i}{2} (H e)_i$。\n\n3.  涉及海森矩阵的项是 $\\frac{1}{T} \\int_{t}^{t+T} \\frac{1}{2} (\\delta(\\tau)^\\top H \\delta(\\tau)) d_i(\\tau) \\mathrm{d}\\tau$。此项包含三个抖动信号的乘积，如 $d_1^3(\\tau)$、$d_2^3(\\tau)$、$d_1^2(\\tau)d_2(\\tau)$ 等。任何此类三阶三角单项式在一个完整周期内的积分都为零。例如，$\\int_{t}^{t+T} \\sin^3(\\omega\\tau)\\mathrm{d}\\tau = 0$。因此，这整个项的平均值为零。\n\n综合这些结果，得到平均解调信号，我们记作 $z_{i, \\text{avg}}$：\n$$\nz_{i, \\text{avg}}(t) = \\frac{a_i}{2} (H e(t))_i\n$$\n自适应律为 $\\dot{\\hat u}_i(t) = -k_i z_i(t)$。应用平均法理论，平均估计值 $\\hat u_{\\text{avg}}(t)$ 的动态由以下公式决定：\n$$\n\\dot{\\hat u}_{i, \\text{avg}}(t) = -k_i z_{i, \\text{avg}}(t) = - k_i \\frac{a_i}{2} (H e(t))_i\n$$\n以向量形式，令 $K = \\text{diag}(k_1, k_2)$ 和 $A = \\text{diag}(a_1, a_2)$。平均动态为：\n$$\n\\dot{\\hat u}_{\\text{avg}}(t) = -\\frac{1}{2} K A H e(t)\n$$\n通过对 $e(t) = \\hat u(t) - u^\\star$ 求导得到误差动态。由于 $u^\\star$ 是常数，$\\dot{e}(t) = \\dot{\\hat u}(t)$。因此，平均误差动态为：\n$$\n\\dot{e}_{\\text{avg}}(t) = -\\frac{1}{2} K A H e(t)\n$$\n这是一个线性时不变系统 $\\dot{e}_{\\text{avg}}(t) = M e(t)$，其中系统矩阵为 $M = -\\frac{1}{2} K A H$。\n\n现在，我们代入给定的特定参数值：$a_1 = a_2 = 1$，$k_1 = k_2 = 4$ 和 $H = \\begin{pmatrix} 6  2 \\\\ 2  4 \\end{pmatrix}$。\n增益和幅值矩阵变为：\n$$\nK = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix} = 4I\n$$\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I\n$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n误差动态矩阵 $M$ 为：\n$$\nM = -\\frac{1}{2} (4I)(I) H = -2H = -2 \\begin{pmatrix} 6  2 \\\\ 2  4 \\end{pmatrix} = \\begin{pmatrix} -12  -4 \\\\ -4  -8 \\end{pmatrix}\n$$\n为了找到 $M$ 的特征值，我们求解特征方程 $\\det(M - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix} -12 - \\lambda  -4 \\\\ -4  -8 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-12 - \\lambda)(-8 - \\lambda) - (-4)(-4) = 0\n$$\n$$\n(12 + \\lambda)(8 + \\lambda) - 16 = 0\n$$\n$$\n96 + 20\\lambda + \\lambda^2 - 16 = 0\n$$\n$$\n\\lambda^2 + 20\\lambda + 80 = 0\n$$\n我们使用求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a=1, b=20, c=80$：\n$$\n\\lambda = \\frac{-20 \\pm \\sqrt{20^2 - 4(1)(80)}}{2}\n$$\n$$\n\\lambda = \\frac{-20 \\pm \\sqrt{400 - 320}}{2}\n$$\n$$\n\\lambda = \\frac{-20 \\pm \\sqrt{80}}{2}\n$$\n简化平方根：$\\sqrt{80} = \\sqrt{16 \\times 5} = 4\\sqrt{5}$。\n$$\n\\lambda = \\frac{-20 \\pm 4\\sqrt{5}}{2}\n$$\n$$\n\\lambda = -10 \\pm 2\\sqrt{5}\n$$\n平均线性误差动态矩阵的两个特征值是 $\\lambda_1 = -10 - 2\\sqrt{5}$ 和 $\\lambda_2 = -10 + 2\\sqrt{5}$。\n两个特征值均为负，证实了在 $e=0$ 处的平衡点是稳定的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-10 - 2\\sqrt{5}  -10 + 2\\sqrt{5}\n\\end{pmatrix}\n}\n$$", "id": "2706364"}]}