{"hands_on_practices": [{"introduction": "在基于观测器的控制中，分离原理是一个核心基石。本练习将引导您从第一性原理出发，针对一个具体案例推导出这一关键结果[@problem_id:2755501]。通过计算参考输入到系统输出的传递函数，您将亲眼见证观测器动态在该理想条件下如何被神奇地抵消，从而加深对这一基本概念的理解。", "problem": "考虑一个单输入单输出线性时不变系统，其状态空间方程描述为\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\n其中\n$$A = \\begin{pmatrix} 0  & 1 \\\\ -3  & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  & 0 \\end{pmatrix}, \\quad D = 0.$$\n该系统由一个动态输出反馈控制器控制，该控制器由一个全状态观测器（Luenberger 观测器）和一个状态反馈律构成。观测器为\n$$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - \\hat{y}(t)\\big), \\quad \\hat{y}(t) = C \\hat{x}(t),$$\n观测器增益为\n$$L = \\begin{pmatrix} 46 \\\\ 413 \\end{pmatrix},$$\n控制输入为\n$$u(t) = -K \\hat{x}(t) + N r(t), \\quad K = \\begin{pmatrix} 7  & 3 \\end{pmatrix},$$\n其中 $r(t)$ 是参考输入，$N$ 是一个标量预滤波器，其选择是为了在理想条件下对阶跃参考实现单位稳态跟踪。假设初始条件为零，即 $x(0) = 0$ 和 $\\hat{x}(0) = 0$。\n\n仅使用线性时不变系统的拉普拉斯变换定义以及控制器-观测器互联的状态空间表示，完成以下任务：\n\n1. 显式地根据给定的矩阵和增益推导闭环参考到输出的传递函数 $T_{yr}(s) = \\frac{Y(s)}{R(s)}$，并确定预滤波器 $N$ 的值，使得对于单位阶跃参考 $r(t) = 1$（$t \\ge 0$），系统能获得单位稳态增益。\n2. 通过对 $T_{yr}(s)\\frac{1}{s}$ 进行拉普拉斯逆变换，计算系统对单位阶跃参考的时域响应 $y(t)$（$t \\ge 0$）。\n3. 从闭环状态空间公式的第一性原理出发，简要讨论为什么在初始条件指定的理想情况下，观测器极点不影响此参考跟踪响应。\n\n请以 $t \\ge 0$ 的单个闭式表达式形式提供 $y(t)$ 的最终答案。不需要进行数值舍入，也不需要物理单位。", "solution": "所述问题具有科学依据，提法得当，且客观公正。这是线性控制理论中的一个标准问题，并包含足够的信息以获得唯一、可验证的解。我们将进行推导和计算。\n\n该系统由以下系统方程描述：\n$$ \\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t) $$\n以及基于观测器的控制器：\n$$ \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C\\hat{x}(t)) $$\n$$ u(t) = -K \\hat{x}(t) + N r(t) $$\n为了分析闭环系统，我们引入状态估计误差 $e(t) = x(t) - \\hat{x}(t)$。误差的导数为：\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = [A x(t) + B u(t)] - [A \\hat{x}(t) + B u(t) + L(C x(t) - C \\hat{x}(t))] $$\n$$ \\dot{e}(t) = A(x(t) - \\hat{x}(t)) - LC(x(t) - \\hat{x}(t)) = (A - LC)e(t) $$\n控制输入 $u(t)$ 可以用 $x(t)$ 和 $e(t)$ 表示：\n$$ u(t) = -K \\hat{x}(t) + N r(t) = -K(x(t) - e(t)) + N r(t) = -K x(t) + K e(t) + N r(t) $$\n将此代入系统状态方程可得：\n$$ \\dot{x}(t) = A x(t) + B(-K x(t) + K e(t) + N r(t)) = (A - BK)x(t) + BK e(t) + BN r(t) $$\n现在我们可以使用增广状态向量 $\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$ 来写出完整的闭环动态方程：\n$$ \\frac{d}{dt} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} = \\begin{pmatrix} A-BK  & BK \\\\ 0  & A-LC \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} + \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix} r(t) $$\n$$ y(t) = \\begin{pmatrix} C  & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} $$\n系统矩阵是块上三角矩阵，这体现了分离原理：闭环特征值是状态反馈调节器特征值（由 $\\det(sI - (A-BK)) = 0$ 给出）和观测器特征值（由 $\\det(sI - (A-LC)) = 0$ 给出）的并集。\n\n对增广系统进行拉普拉斯变换，初始条件为 $x(0)=0$ 和 $\\hat{x}(0)=0$（这意味着 $e(0) = x(0) - \\hat{x}(0) = 0$），我们得到：\n$$ s \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = \\begin{pmatrix} A-BK  & BK \\\\ 0  & A-LC \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} + \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix} R(s) $$\n这可以解耦为两个方程：\n$$ s X(s) = (A-BK)X(s) + BK E(s) + BN R(s) $$\n$$ s E(s) = (A-LC)E(s) $$\n由第二个方程 $(sI - (A-LC))E(s) = e(0)$，因为 $e(0)=0$，所以对于所有使 $(sI-(A-LC))$ 可逆的 $s$，都有 $E(s)=0$。这意味着误差状态在所有时间内都保持为零。\n因此，第一个方程简化为：\n$$ s X(s) = (A-BK)X(s) + BN R(s) $$\n$$ (sI - (A-BK))X(s) = BN R(s) \\implies X(s) = (sI - (A-BK))^{-1} BN R(s) $$\n输出为 $Y(s) = C X(s)$。因此，传递函数 $T_{yr}(s) = Y(s)/R(s)$ 是：\n$$ T_{yr}(s) = N C(sI - (A-BK))^{-1} B $$\n这回答了问题中关于传递函数形式的第一部分。现在我们代入给定的矩阵：\n$A = \\begin{pmatrix} 0  & 1 \\\\ -3  & -4 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1  & 0 \\end{pmatrix}$, $K = \\begin{pmatrix} 7  & 3 \\end{pmatrix}$。\n首先，计算 $A-BK$：\n$$ BK = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 7  & 3 \\end{pmatrix} = \\begin{pmatrix} 0  & 0 \\\\ 7  & 3 \\end{pmatrix} $$\n$$ A-BK = \\begin{pmatrix} 0  & 1 \\\\ -3  & -4 \\end{pmatrix} - \\begin{pmatrix} 0  & 0 \\\\ 7  & 3 \\end{pmatrix} = \\begin{pmatrix} 0  & 1 \\\\ -10  & -7 \\end{pmatrix} $$\n现在，求 $(sI - (A-BK))^{-1}$：\n$$ sI - (A-BK) = \\begin{pmatrix} s  & -1 \\\\ 10  & s+7 \\end{pmatrix} $$\n$$ \\det(sI - (A-BK)) = s(s+7) - (10)(-1) = s^2 + 7s + 10 $$\n$$ (sI - (A-BK))^{-1} = \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7  & 1 \\\\ -10  & s \\end{pmatrix} $$\n现在，我们计算 $C(sI - (A-BK))^{-1} B$：\n$$ C(sI - (A-BK))^{-1} B = \\begin{pmatrix} 1  & 0 \\end{pmatrix} \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7  & 1 \\\\ -10  & s \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n$$ = \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7  & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{s^2+7s+10} $$\n传递函数为 $T_{yr}(s) = \\frac{N}{s^2+7s+10}$。\n为了实现对阶跃输入的单位稳态增益，直流增益必须为 $1$。我们使用终值定理，该定理指出，对于一个稳定系统，稳态值为 $\\lim_{s \\to 0} s Y(s) = \\lim_{s \\to 0} s T_{yr}(s) \\frac{1}{s} = T_{yr}(0)$。\n$$ T_{yr}(0) = \\frac{N}{0^2+7(0)+10} = \\frac{N}{10} $$\n令 $T_{yr}(0) = 1$ 得到 $\\frac{N}{10} = 1$，所以 $N=10$。\n闭环传递函数为 $T_{yr}(s) = \\frac{10}{s^2+7s+10}$。\n\n对于第二个任务，我们计算对单位阶跃参考 $r(t)=1$（$t \\ge 0$）的时域响应 $y(t)$，这意味着 $R(s) = \\frac{1}{s}$。\n$$ Y(s) = T_{yr}(s) R(s) = \\frac{10}{s^2+7s+10} \\cdot \\frac{1}{s} = \\frac{10}{s(s+2)(s+5)} $$\n我们使用部分分式展开：\n$$ Y(s) = \\frac{A_{pfe}}{s} + \\frac{B_{pfe}}{s+2} + \\frac{C_{pfe}}{s+5} $$\n系数通过留数法求得：\n$$ A_{pfe} = \\lim_{s \\to 0} s Y(s) = \\lim_{s \\to 0} \\frac{10}{(s+2)(s+5)} = \\frac{10}{(2)(5)} = 1 $$\n$$ B_{pfe} = \\lim_{s \\to -2} (s+2) Y(s) = \\lim_{s \\to -2} \\frac{10}{s(s+5)} = \\frac{10}{(-2)(3)} = -\\frac{5}{3} $$\n$$ C_{pfe} = \\lim_{s \\to -5} (s+5) Y(s) = \\lim_{s \\to -5} \\frac{10}{s(s+2)} = \\frac{10}{(-5)(-3)} = \\frac{10}{15} = \\frac{2}{3} $$\n因此，\n$$ Y(s) = \\frac{1}{s} - \\frac{5}{3} \\frac{1}{s+2} + \\frac{2}{3} \\frac{1}{s+5} $$\n进行拉普拉斯逆变换，得到 $t \\ge 0$ 时的时域响应：\n$$ y(t) = 1 - \\frac{5}{3}\\exp(-2t) + \\frac{2}{3}\\exp(-5t) $$\n\n最后，对于第三个任务，我们解释为什么观测器极点不影响参考跟踪响应。系统对输入和初始条件的响应由状态方程的完整解给出。在拉普拉斯域中，对于增广系统 $(x, e)$，这表示为：\n$$ \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = (sI - \\mathcal{A}_{cl})^{-1} \\left( \\begin{pmatrix} x(0) \\\\ e(0) \\end{pmatrix} + \\mathcal{B}_{cl} R(s) \\right) $$\n其中 $\\mathcal{A}_{cl} = \\begin{pmatrix} A-BK  & BK \\\\ 0  & A-LC \\end{pmatrix}$ 且 $\\mathcal{B}_{cl} = \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix}$。\n输出为 $Y(s) = \\begin{pmatrix} C  & 0 \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = C X(s)$。我们只需要求解 $X(s)$:\n$$ \\begin{pmatrix} sI-(A-BK)  & -BK \\\\ 0  & sI-(A-LC) \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = \\begin{pmatrix} x(0)+BNR(s) \\\\ e(0) \\end{pmatrix} $$\n这得到 $(sI-(A-LC))E(s) = e(0)$ 和 $(sI-(A-BK))X(s) - BK E(s) = x(0)+BNR(s)$。\n求解 $E(s)$ 和 $X(s)$:\n$$ E(s) = (sI-(A-LC))^{-1} e(0) $$\n$$ X(s) = (sI-(A-BK))^{-1} (x(0) + BNR(s)) + (sI-(A-BK))^{-1} BK (sI-(A-LC))^{-1} e(0) $$\n输出为 $Y(s) = C X(s)$。$Y(s)$ 的表达式包含三个部分：对 $R(s)$ 的响应、对 $x(0)$ 的响应以及对 $e(0)$ 的响应。观测器极点，即 $(sI-(A-LC))^{-1}$ 的极点，只出现在乘以初始估计误差 $e(0)$ 的项中。\n问题指定了理想情况，即系统和观测器都从静止开始：$x(0)=0$ 和 $\\hat{x}(0)=0$。这意味着 $e(0) = x(0) - \\hat{x}(0) = 0$。当 $x(0)=0$ 和 $e(0)=0$ 时，$X(s)$ 的表达式简化为：\n$$ X(s) = (sI-(A-BK))^{-1} BNR(s) $$\n得到的输出响应 $Y(s) = C(sI-(A-BK))^{-1} BNR(s)$ 仅取决于调节器极点（$A-BK$ 的特征值），而不取决于观测器极点（$A-LC$ 的特征值）。由于初始估计误差为零，观测器模态未被激励。这是分离原理和指定的零初始条件的直接结果。", "answer": "$$\n\\boxed{1 - \\frac{5}{3}\\exp(-2t) + \\frac{2}{3}\\exp(-5t)}\n$$", "id": "2755501"}, {"introduction": "尽管参考跟踪性能与观测器增益无关，但这并非对所有信号都成立。本练习将揭示一个重要的实际问题：测量噪声的影响[@problem_id:2755436]。您将推导从噪声到输出的传递函数，并分析它如何明确地依赖于观测器增益 $L$，从而阐明观测器设计中的一个关键工程权衡。", "problem": "考虑一个严格真有理的单输入单输出 (SISO) 线性时不变 (LTI) 受控对象，其状态空间形式由以下方程给出：\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\n其中\n$$A = \\begin{pmatrix} 0  & 1 \\\\ -4  & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  & 0 \\end{pmatrix}.$$\n系统实现了一个基于观测器的状态反馈控制器，该控制器包含一个全阶 Luenberger 观测器和静态状态反馈。控制器使用测量输出\n$$y_{m}(t) = y(t) + v(t),$$\n其中 $v(t)$ 是附加的测量噪声。控制律和观测器为\n$$u(t) = -K \\hat{x}(t), \\quad \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big),$$\n增益为\n$$K = \\begin{pmatrix} 6  & 4 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}.$$\n假设 $x(t)$ 和 $\\hat{x}(t)$ 的初始条件均为零。仅使用基本的状态空间关系和 Luenberger 观测器的定义，推导从测量噪声输入 $v(t)$ 到受控对象输出 $y(t)$ 的闭环传递函数。将您的最终答案表示为拉普拉斯变量 $s$ 的单个实有理函数，记作 $G_{v \\to y}(s)$，其中在零初始条件下 $Y(s) = G_{v \\to y}(s) V(s)$。然后，通过分析推导出的表达式，识别由观测器动态引入的任何有限零点，并定性解释其位置如何依赖于观测器增益 $L$。\n\n您的最终答案必须是 $G_{v \\to y}(s)$ 的单一闭式解析表达式。不需要进行数值四舍五入，也不需要单位。", "solution": "问题陈述已通过验证。\n\n逐字提取给定条件：\n- 受控对象模型：$\\dot{x}(t) = A x(t) + B u(t)$，$y(t) = C x(t)$\n- 受控对象矩阵：$A = \\begin{pmatrix} 0  & 1 \\\\ -4  & -3 \\end{pmatrix}$，$B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$C = \\begin{pmatrix} 1  & 0 \\end{pmatrix}$\n- 测量输出：$y_{m}(t) = y(t) + v(t)$\n- 控制律：$u(t) = -K \\hat{x}(t)$\n- 观测器动态：$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big)$\n- 增益矩阵：$K = \\begin{pmatrix} 6  & 4 \\end{pmatrix}$，$L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}$\n- 初始条件：$x(0)=0$ 和 $\\hat{x}(0)=0$。\n- 目标：推导传递函数 $G_{v \\to y}(s) = Y(s)/V(s)$ 并分析由观测器引入的零点。\n\n验证已执行。该问题在科学上基于线性控制理论的既定原则，特别是基于观测器的状态反馈控制器的设计。问题提法恰当，为推导唯一解提供了所有必要的数据和定义。问题是客观的，并使用了精确的标准术语。不存在矛盾、歧义或事实上的不健全之处。因此，该问题被认为是有效的，并将提供解答。\n\n推导将从第一性原理出发，使用状态空间分析，这是最严谨的方法。整个闭环系统的动态由受控对象状态 $x(t)$ 和观测器状态 $\\hat{x}(t)$ 描述。使用受控对象状态 $x(t)$ 和估计误差 $e(t) = x(t) - \\hat{x}(t)$ 可以获得更具洞察力的表示。\n\n首先，我们推导估计误差 $e(t)$ 的动态特性。\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\n代入给定的 $\\dot{x}(t)$ 和 $\\dot{\\hat{x}}(t)$ 方程：\n$$ \\dot{e}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(y_m(t) - C\\hat{x}(t))\\big) $$\n项 $B u(t)$ 消去。我们代入 $y_m(t) = y(t) + v(t) = C x(t) + v(t)$：\n$$ \\dot{e}(t) = A x(t) - A \\hat{x}(t) - L\\big(C x(t) + v(t) - C\\hat{x}(t)\\big) $$\n将含 $x(t)$ 和 $\\hat{x}(t)$ 的项分组：\n$$ \\dot{e}(t) = A \\big(x(t) - \\hat{x}(t)\\big) - L C \\big(x(t) - \\hat{x}(t)\\big) - L v(t) $$\n识别出 $e(t) = x(t) - \\hat{x}(t)$，我们得到误差动态：\n$$ \\dot{e}(t) = (A - LC) e(t) - L v(t) $$\n该方程表明，误差动态由测量噪声 $v(t)$ 驱动，且独立于状态 $x(t)$，这是 Luenberger 观测器的一个关键特性。\n\n接下来，我们推导反馈下受控对象状态 $x(t)$ 的动态。控制律为 $u(t) = -K \\hat{x}(t)$。我们将 $\\hat{x}(t)$ 表示为 $x(t) - e(t)$。\n$$ u(t) = -K (x(t) - e(t)) $$\n将其代入受控对象状态方程：\n$$ \\dot{x}(t) = A x(t) + B u(t) = A x(t) - B K (x(t) - e(t)) $$\n$$ \\dot{x}(t) = (A - BK) x(t) + BK e(t) $$\n状态动态同时依赖于状态 $x(t)$ 和估计误差 $e(t)$。\n\n我们现在有一个关于状态向量 $\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$ 的组合状态空间系统：\n$$ \\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{pmatrix} = \\begin{pmatrix} A-BK  & BK \\\\ 0  & A-LC \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -L \\end{pmatrix} v(t) $$\n输出方程为 $y(t) = C x(t) = \\begin{pmatrix} C  & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$。\n\n系统矩阵的块三角结构展示了分离原理：闭环系统的极点是控制器极点（$A-BK$ 的特征值）和观测器极点（$A-LC$ 的特征值）的并集。\n\n我们对这些方程应用拉普拉斯变换，初始条件为零：\n$$ sX(s) = (A-BK)X(s) + BKE(s) $$\n$$ sE(s) = (A-LC)E(s) - LV(s) $$\n$$ Y(s) = CX(s) $$\n\n从第二个方程，我们求解 $E(s)$：\n$$ (sI - (A-LC))E(s) = -LV(s) \\implies E(s) = -(sI - A + LC)^{-1} L V(s) $$\n从第一个方程，我们求解 $X(s)$：\n$$ (sI - (A-BK))X(s) = BKE(s) \\implies X(s) = (sI - A + BK)^{-1} BKE(s) $$\n将 $E(s)$ 的表达式代入 $X(s)$ 的表达式中：\n$$ X(s) = -(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\n最后，我们求得输出 $Y(s)$：\n$$ Y(s) = CX(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\n因此，传递函数 $G_{v \\to y}(s) = Y(s)/V(s)$ 为：\n$$ G_{v \\to y}(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L $$\n现在，我们代入给定的数值矩阵。\n\n首先，计算控制器矩阵 $A_c = A-BK$：\n$$ BK = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 6  & 4 \\end{pmatrix} = \\begin{pmatrix} 0  & 0 \\\\ 6  & 4 \\end{pmatrix} $$\n$$ A_c = A - BK = \\begin{pmatrix} 0  & 1 \\\\ -4  & -3 \\end{pmatrix} - \\begin{pmatrix} 0  & 0 \\\\ 6  & 4 \\end{pmatrix} = \\begin{pmatrix} 0  & 1 \\\\ -10  & -7 \\end{pmatrix} $$\n控制器的特征多项式为 $\\det(sI - A_c) = \\det\\begin{pmatrix} s  & -1 \\\\ 10  & s+7 \\end{pmatrix} = s(s+7) + 10 = s^2 + 7s + 10$。\n\n接下来，计算观测器矩阵 $A_o = A-LC$：\n$$ LC = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} \\begin{pmatrix} 1  & 0 \\end{pmatrix} = \\begin{pmatrix} 10  & 0 \\\\ 8  & 0 \\end{pmatrix} $$\n$$ A_o = A - LC = \\begin{pmatrix} 0  & 1 \\\\ -4  & -3 \\end{pmatrix} - \\begin{pmatrix} 10  & 0 \\\\ 8  & 0 \\end{pmatrix} = \\begin{pmatrix} -10  & 1 \\\\ -12  & -3 \\end{pmatrix} $$\n观测器的特征多项式为 $\\det(sI - A_o) = \\det\\begin{pmatrix} s+10  & -1 \\\\ 12  & s+3 \\end{pmatrix} = (s+10)(s+3) + 12 = s^2 + 13s + 30 + 12 = s^2 + 13s + 42$。\n\n$G_{v \\to y}(s)$ 的分母是这两个特征多项式的乘积：\n$$ D(s) = (s^2 + 7s + 10)(s^2 + 13s + 42) = s^4 + 20s^3 + 143s^2 + 424s + 420 $$\n分子是 $N(s) = -C \\cdot \\text{adj}(sI - A_c) \\cdot BK \\cdot \\text{adj}(sI - A_o) \\cdot L$。\n要计算分子，我们可以使用一个更简单的方法：$G_{v \\to y}(s) = T_{yu}(s) G_{uv}(s)$，其中 $T_{yu}(s) = C(sI-A_c)^{-1}B$ 和 $G_{uv}(s) = -K(sI-A_o)^{-1}L$ 是不正确的，因为 $u$ 依赖 $e$。\n正确的方法是通过代数计算分子。\n我们有 $Y(s)/V(s) = -C(sI-A_c)^{-1}BK(sI-A_o)^{-1}L$。\n$C(sI-A_c)^{-1} = \\frac{C \\cdot \\text{adj}(sI-A_c)}{\\det(sI-A_c)} = \\frac{\\begin{pmatrix} 1 & 0 \\end{pmatrix}\\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix}}{s^2+7s+10} = \\frac{\\begin{pmatrix} s+7 & 1 \\end{pmatrix}}{s^2+7s+10}$\n$(sI-A_o)^{-1}L = \\frac{\\text{adj}(sI-A_o)L}{\\det(sI-A_o)} = \\frac{\\begin{pmatrix} s+3 & 1 \\\\ -12 & s+10 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}}{s^2+13s+42} = \\frac{\\begin{pmatrix} 10(s+3)+8 \\\\ -120+8(s+10) \\end{pmatrix}}{s^2+13s+42} = \\frac{\\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix}}{s^2+13s+42}$\n将这些项组合起来：\n$G_{v \\to y}(s) = - \\frac{\\begin{pmatrix} s+7 & 1 \\end{pmatrix}}{s^2+7s+10} BK \\frac{\\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix}}{s^2+13s+42}$\n$BK = \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix}$\n中间项是 $\\begin{pmatrix} s+7 & 1 \\end{pmatrix} BK \\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix}$。\n$\\begin{pmatrix} s+7 & 1 \\end{pmatrix} BK = \\begin{pmatrix} s+7 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 6 & 4 \\end{pmatrix}$\n所以，分子是 $- \\begin{pmatrix} 6 & 4 \\end{pmatrix} \\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix} = -(6(10s+38) + 4(8s-40)) = -(60s + 228 + 32s - 160) = -(92s + 68)$。\n因此，传递函数为：\n$$ G_{v \\to y}(s) = \\frac{-(92s+68)}{(s^2+7s+10)(s^2+13s+42)} = \\frac{-92s-68}{s^4 + 20s^3 + 143s^2 + 424s + 420} $$\n\n对于问题的第二部分，我们分析这个表达式。传递函数在分子多项式的根处有一个有限零点 $s_z$，其中 $92s_z + 68 = 0$，解得 $s_z = -68/92 = -17/23$。\n这个零点在原始受控对象中是不存在的，原始受控对象的传递函数为 $P(s) = C(sI-A)^{-1}B = \\frac{1}{s^2+3s+4}$，没有有限零点。该零点是由控制器-观测器组合引入的。\n我们可以通过查看分子 `- (92s+68)` 的一般形式来分析其对 $L$ 的依赖性。我们推导出分子为 $-K \\cdot \\text{adj}(sI-A_o) \\cdot L$ 是不正确的。正确的分子是 $ -C \\cdot \\text{adj}(sI - A_c) \\cdot BK \\cdot \\text{adj}(sI - A_o) \\cdot L$。\n然而，我们的中间计算 $\\begin{pmatrix} s+7 & 1 \\end{pmatrix} BK = \\begin{pmatrix} 6 & 4 \\end{pmatrix}$ 表明，对于这个特定的 $C$ 矩阵，左边的项不依赖于 $s$。$K=\\begin{pmatrix} k_1 & k_2 \\end{pmatrix} = \\begin{pmatrix} 6 & 4 \\end{pmatrix}$。\n更一般地，分子是 $- \\left( C \\cdot \\text{adj}(sI-A_c) \\cdot B \\right) \\cdot \\left( K \\cdot \\text{adj}(sI-A_o) \\cdot L \\right)$。这也不对。\n让我们回到 $-(C\\cdot \\text{adj}(sI-A_c)\\cdot BK\\cdot \\text{adj}(sI-A_o)\\cdot L)$。这个表达式的系数同时依赖于 $K$ 和 $L$ 的元素。\n我们推导出的分子是 `-(92s+68)`。其中 $92 = 60+32 = k_1 l_1 + k_2 l_2$ （不，这是错的，6 和 4 来自K，10和8来自L... 让我再检查一遍）\n分子 $= -(6(10s+38) + 4(8s-40)) = -( (6 \\cdot 10 + 4 \\cdot 8)s + (6 \\cdot 38 - 4 \\cdot 40) ) = -((60+32)s + (228-160)) = -(92s+68)$。\n$k_1=6, k_2=4$. $l_1=10, l_2=8$.\n`6(10s+38) + 4(8s-40)` 来自 `[6,4] * [[10s+38], [8s-40]]`。\n`[6,4]` 来自 `[s+7, 1] * [[0,0],[6,4]]`。\n`[10s+38], [8s-40]` 来自 `adj(sI-A_o) * L`。\n所以零点的位置 $s_z = -68/92$ 确实依赖于 $K$ 和 $L$ 的所有元素。例如，如果 $L$ 改变，那么 $A_o = A-LC$ 会改变，其伴随矩阵 `adj(sI-A_o)` 也会改变，最终导致分子多项式改变，从而移动零点的位置。因此，这个由观测器引入的零点的位置，是可以通过选择观测器增益 $L$ 来调整的。", "answer": "$$ \\boxed{\\frac{-92s-68}{s^4 + 20s^3 + 143s^2 + 424s + 420}} $$", "id": "2755436"}, {"introduction": "理论的优雅需要在实践的熔炉中得到检验。最后的这个练习将挑战您像一名实验科学家一样思考[@problem_id:2755556]。在回顾了参考传递函数独立于观测器增益的理论之后，您必须设计一个严谨的实验方案来验证这一特性，同时还要考虑噪声和初始瞬态等现实世界中的复杂因素。", "problem": "考虑一个由状态空间方程描述的线性时不变（LTI）被控对象\n$$\\dot{x}(t)=A x(t)+B u(t), \\quad y(t)=C x(t),$$\n其中没有直接馈通项，即 $D=0$。一个全阶 Luenberger 观测器与静态状态反馈和一个参考预滤波器一同使用。控制器-观测器的互连结构为\n$$u(t)=-K \\hat{x}(t)+N r(t),$$\n$$\\dot{\\hat{x}}(t)=A \\hat{x}(t)+B u(t)+L\\big(y(t)-C \\hat{x}(t)\\big),$$\n其中 $x(t)\\in\\mathbb{R}^n$，$u(t)\\in\\mathbb{R}^m$，$y(t)\\in\\mathbb{R}^p$，$r(t)\\in\\mathbb{R}^q$。假设 $(A,B)$ 是可镇定的，$(A,C)$ 是可检测的，$A-BK$ 是赫尔维茨矩阵（Hurwitz），并且 $A-LC$ 是赫尔维茨矩阵。选择预滤波器 $N$ 以实现期望的稳态跟踪特性，且其不依赖于 $L$。\n\n从这些第一性原理出发，并根据传递函数作为零初始条件下的输入-输出映射的标准定义，证明从 $r$ 到 $y$ 的闭环传递函数（记为 $T_{yr}(s)$）与观测器增益 $L$ 无关。你的推导必须消除内部变量，并且只能基于上述的互连关系以及状态空间到传递函数的映射定义，不得引用任何预先记下的分离定理。\n\n然后，请你设计一种无需知道 $(A,B,C)$ 即可通过经验检验的验证方法来验证这种无关性。你需要在保持 $K$（和 $N$）固定的情况下，通过改变 $L$ 来重复对 $T_{yr}(s)$ 进行频域辨识，并且必须考虑到由测量噪声和 $\\hat{x}(t)$ 的初始暂态引起的辨识偏差。\n\n以下哪种实验方案提供了一种可靠的方法来验证 $T_{yr}(s)$ 对 $L$ 的无关性？\n\nA. 保持 $K$ 和 $N$ 固定。选择几个具有不同谱的稳定化增益 $L$。对于每个 $L$，要么将初始条件重置为 0，要么舍弃一个足够长的初始时间窗口，以使由 $A-LC$ 控制的观测器误差暂态可以忽略不计。施加相同的持续激励信号 $r(t)$（例如，滤波白噪声），该信号与测量噪声不相关。使用闭环互谱方法 $\\widehat{T}_{yr}(\\mathrm{j}\\omega)=\\widehat{S}_{yr}(\\omega)/\\widehat{S}_{rr}(\\omega)$ 并结合 Welch 平均法来估计非参数频率响应函数（FRF）$\\widehat{T}_{yr}(\\mathrm{j}\\omega)$，并计算渐近 95% 置信区间。如果在激励频带内，不同 $L$ 对应的 FRF 在置信区间内一致，则得出无关性的结论。\n\nB. 保持 $K$ 固定并改变 $L$。对每个 $L$ 使用单个阶跃输入 $r(t)$，并为每次实验将一个二阶输出误差模型拟合到 $(r,y)$。如果两个估计的自然频率在 5% 以内匹配，则得出无关性的结论。\n\nC. 保持 $K$ 固定并改变 $L$。不施加 $r(t)$；而是依赖进入 $y(t)$ 的环境测量噪声来激励回路，并通过将 $r(t)\\equiv 0$ 并使用工具变量估计器从 $(r,y)$ 中辨识 $T_{yr}(s)$。如果辨识出的模型匹配，则得出无关性的结论。\n\nD. 保持 $K$ 固定并改变 $L$。在每次实验中施加相同的白噪声信号 $r(t)$。辨识从 $r$ 到 $u$ 的传递函数，如果对于不同的 $L$，从 $r\\to u$ 的传递函数都匹配，则得出 $T_{yr}(s)$ 对 $L$ 无关的结论。\n\n选择唯一的最佳选项。", "solution": "这个问题包含两部分。第一部分是理论推导，以证明一个控制器-观测器系统的特性。第二部分是评估用于验证此特性的实验方法。在验证问题陈述后，我将依次解决每个部分。\n\n问题陈述是有效的。它提出了线性控制理论中的一个标准配置——一个带有 Luenberger 观测器的状态反馈控制下的被控对象——并要求推导一个已知属性，然后评估系统辨识方案。前提条件科学合理、定义明确且客观。所有假设，如可镇定性、可检测性以及闭环极点的赫尔维茨稳定性，都是标准且恰当的。我将继续进行解答。\n\n**第一部分：传递函数 $T_{yr}(s)$ 的推导**\n\n目标是推导从参考输入 $r(t)$ 到被控对象输出 $y(t)$ 的传递函数 $T_{yr}(s)$。传递函数的定义假设所有初始条件均为零。\n\n给定的系统方程为：\n1. 被控对象：$\\dot{x}(t) = A x(t) + B u(t)$\n2. 输出：$y(t) = C x(t)$\n3. 控制律：$u(t) = -K \\hat{x}(t) + N r(t)$\n4. 观测器：$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))$\n\n我们对这些方程应用拉普拉斯变换，假设初始条件为零，即 $x(0)=0$ 和 $\\hat{x}(0)=0$。设 $X(s)$、$Y(s)$、$U(s)$、$\\hat{X}(s)$ 和 $R(s)$ 分别是 $x(t)$、$y(t)$、$u(t)$、$\\hat{x}(t)$ 和 $r(t)$ 的拉普拉斯变换。\n\n变换后的方程为：\n1. $sX(s) = AX(s) + BU(s)$\n2. $Y(s) = CX(s)$\n3. $U(s) = -K\\hat{X}(s) + NR(s)$\n4. $s\\hat{X}(s) = A\\hat{X}(s) + BU(s) + L(Y(s) - C\\hat{X}(s))$\n\n为了分析真实状态 $x(t)$ 和估计状态 $\\hat{x}(t)$ 之间的关系，我们定义观测器误差 $e(t) = x(t) - \\hat{x}(t)$。该误差的动态特性通过对 $e(t)$ 求导得出：\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\n代入 $\\dot{x}(t)$ 和 $\\dot{\\hat{x}}(t)$ 的表达式：\n$$ \\dot{e}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))\\big) $$\n$B u(t)$ 项相互抵消。我们代入 $y(t) = C x(t)$：\n$$ \\dot{e}(t) = A x(t) - A \\hat{x}(t) - L(C x(t) - C \\hat{x}(t)) $$\n$$ \\dot{e}(t) = (A - LC)\\big(x(t) - \\hat{x}(t)\\big) = (A - LC)e(t) $$\n这就是观测器误差动态方程。它是一个仅由自身状态驱动的线性系统。参考输入 $r(t)$ 未出现在此方程中，意味着误差动态与参考指令是解耦的。\n\n对误差动态方程进行拉普拉斯变换，初始条件为零，即 $e(0) = x(0) - \\hat{x}(0) = 0 - 0 = 0$，我们得到：\n$$ sE(s) = (A - LC)E(s) $$\n$$ \\big(sI - (A - LC)\\big)E(s) = 0 $$\n问题陈述中指出 $A-LC$ 是赫尔维茨矩阵，意味着其所有特征值的实部都严格为负。仅当 $s$ 是 $A-LC$ 的特征值时，矩阵 $\\big(sI - (A - LC)\\big)$ 才是奇异的。对于闭合右半复平面（$\\text{Re}(s) \\ge 0$）中的任何 $s$，该矩阵是可逆的。该方程必须对所有定义了变换的 $s$ 成立。由于 $E(s)$ 是一个有理函数向量，要使其在复平面的一个区域上为零，它必须恒等于零。因此，对于所有 $s$，$E(s)=0$。\n\n这意味着 $X(s) - \\hat{X}(s) = 0$，即 $X(s) = \\hat{X}(s)$。这是一个至关重要的中间结果。它意味着，在零初始状态和无噪声的理想条件下，状态估计的拉普拉斯变换与真实状态的变换是相同的。\n\n现在，我们将 $\\hat{X}(s) = X(s)$ 代入控制律（3）：\n$$ U(s) = -KX(s) + NR(s) $$\n接下来，将这个 $U(s)$ 的表达式代入被控对象的状态空间方程（1）：\n$$ sX(s) = AX(s) + B\\big(-KX(s) + NR(s)\\big) $$\n$$ sX(s) = (A - BK)X(s) + BNR(s) $$\n我们现在可以解出 $X(s)$ 关于 $R(s)$ 的表达式：\n$$ \\big(sI - (A - BK)\\big)X(s) = BNR(s) $$\n$$ X(s) = (sI - A + BK)^{-1}BNR(s) $$\n问题陈述中指出 $A-BK$ 是赫尔维茨矩阵，因此对于 $\\text{Re}(s) \\ge 0$，逆矩阵 $(sI - A + BK)^{-1}$ 存在。\n\n最后，我们使用方程（2）找到输出 $Y(s)$：\n$$ Y(s) = CX(s) = C(sI - A + BK)^{-1}BNR(s) $$\n从 $r$ 到 $y$ 的传递函数矩阵是 $T_{yr}(s)$，满足 $Y(s) = T_{yr}(s)R(s)$。因此，\n$$ T_{yr}(s) = C(sI - A + BK)^{-1}BN $$\n这个传递函数 $T_{yr}(s)$ 的最终表达式依赖于被控对象矩阵 $A$、$B$、$C$ 和控制器增益 $K$、$N$。它不依赖于观测器增益矩阵 $L$。推导到此完成。\n\n**第二部分：实验方案评估**\n\n任务是选择最佳的实验方案，以在不知道 $A$、$B$ 和 $C$ 的情况下验证 $T_{yr}(s)$ 对 $L$ 的无关性。\n\n**选项 A 分析**\n该方案建议保持 $K$ 和 $N$ 固定，选择几个不同的稳定化增益 $L$，并对每个 $L$ 辨识频率响应函数（FRF）$\\widehat{T}_{yr}(\\mathrm{j}\\omega)$ 并比较结果。\n- **处理暂态**：该方案正确地建议要么重置初始条件，要么舍弃初始时间窗口。这一点至关重要，因为非零初始条件 $e(0)$ 会在观测器误差中引起暂态 $e(t) = e^{(A-LC)t}e(0)$。该暂态的动态特性依赖于 $L$。为了测量稳态传递函数，必须消除这种暂态效应。\n- **激励信号**：它指定了持续激励输入 $r(t)$（例如，滤波白噪声）。这对于获取足够的信息以在宽频率范围内辨识 FRF 是必要的。\n- **辨识方法**：它提出了互谱方法 $\\widehat{T}_{yr}(\\mathrm{j}\\omega) = \\widehat{S}_{yr}(\\omega)/\\widehat{S}_{rr}(\\omega)$。在现实环境中，测量的输出 $y_m(t)$ 会受到噪声污染，$y_m(t) = y(t) + v(t)$。这种测量噪声 $v(t)$ 会通过观测器传播，影响 $\\hat{x}(t)$ 和 $u(t)$。然而，只要外部参考信号 $r(t)$ 与测量噪声 $v(t)$ 不相关，互谱 $S_{y_m r}(\\omega)$ 就不会受到 $v(t)$ 的影响。因此，该估计器能得到真实 FRF $T_{yr}(\\mathrm{j}\\omega)$ 的渐近无偏估计。\n- **统计比较**：它建议计算置信区间并检查是否在这些界限内一致。这为判断所辨识的函数是否相同提供了统计上严谨的基础。\n该方案是全面的、方法上合理的，并遵循了系统辨识的最佳实践。\n**结论：正确。**\n\n**选项 B 分析**\n该方案使用阶跃输入并拟合一个二阶模型。\n- **激励信号**：阶跃输入不是持续激励的。其能量集中在低频，不适合用于辨识完整的频率响应。\n- **模型结构**：真实系统的阶数是未知的，并且很可能不是 2 阶。强加一个不正确的低阶模型结构（模型阶次错误指定）将导致对传递函数的估计产生偏差和不准确。\n- **比较指标**：仅仅比较一个结构错误的模型的几个参数（如自然频率），不足以作为判断两个传递函数是否相等的充分检验。\n该方案存在严重缺陷，不大可能得出可靠的结论。\n**结论：不正确。**\n\n**选项 C 分析**\n该方案建议不施加外部参考信号 $r(t)$，并依赖环境噪声进行激励。\n- **无输入**：需要辨识的量是 $T_{yr}(s)$，即从 $r$ 到 $y$ 的传递函数。如果输入 $r(t)$ 恒等于零，则无法辨识此传递函数。没有因果关系可以测量。\n- **激励源**：系统动态将由测量噪声 $v(t)$ 驱动。人们可以尝试辨识从 $v(t)$ 到 $y_m(t)$ 的传递函数。如初步分析所示，这个传递函数 $T_{y_m v}(s)$ *确实* 依赖于 $L$。实验会表明系统的噪声响应随 $L$ 变化，这是预期的，并且与关于 $T_{yr}(s)$ 的理论并不矛盾。该方案从根本上就是误导的。\n**结论：不正确。**\n\n**选项 D 分析**\n该方案建议辨识从 $r$ 到 $u$ 的传递函数 $T_{ur}(s)$，并检查它是否与 $L$ 无关。\n- **理论基础**：理论上的传递函数是 $T_{ur}(s) = N - K(sI-A+BK)^{-1}BN$。这个传递函数确实与 $L$ 无关。所以，基本思想是有效的。\n- **方案完整性**：该方案的陈述过于简单。它只说“辨识传递函数”，而没有指定方法或考虑实际问题。在 $y(t)$ 上存在测量噪声 $v(t)$ 的情况下，观测器误差 $e(t)$ 是非零的，并且是 $v(t)$ 和 $L$ 的函数。控制信号为 $u(t) = -K(x(t)-e(t)) + Nr(t)$。因此，$u(t)$ 被一个依赖于 $L$ 的噪声项所污染。一个简单的辨识方法（例如，基于普通最小二乘法）将产生一个有偏的 $T_{ur}(s)$ 估计，并且这个偏差将是依赖于 $L$ 的。这将导致错误的结论，即 $T_{ur}(s)$ 依赖于 $L$。\n- **与 A 的比较**：选项 A 明确规定了一种方法（互谱分析），该方法克服了噪声引起的偏差这个问题。选项 D 则没有。因此，选项 A 是一个完整而稳健的方案，而选项 D 是一个不完整且脆弱的方案。\n**结论：不正确。**\n\n**总结**\n选项 A 描述了一个严谨且切实可行的实验设计，它正确地考虑了闭环系统辨识中的主要挑战，即初始暂态和测量噪声。它是唯一代表了为所提议的验证任务设计的合理科学方法的选项。", "answer": "$$\\boxed{A}$$", "id": "2755556"}]}