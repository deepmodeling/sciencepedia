{"hands_on_practices": [{"introduction": "状态观测器的核心任务是使估计误差收敛于零。我们可以通过配置误差动态系统的特征值（极点）来控制其收敛速度。本练习探讨了两种基本的设计哲学：确定性的极点配置与随机最优的卡尔曼滤波。通过这个对比，我们将深入理解不同观测器设计方法背后的基本原理及其适用场景。[@problem_id:2748160]", "problem": "考虑一个连续时间线性时不变系统，其状态空间矩阵为 $A \\in \\mathbb{R}^{n \\times n}$ 和 $C \\in \\mathbb{R}^{m \\times n}$。在静态输出注入增益 $L \\in \\mathbb{R}^{n \\times m}$ 下，状态观测器误差动态由矩阵 $A - L C$ 控制。\n\n第1部分。仅从能观测性和能控性的定义以及 Popov–Belevitch–Hautus 检验出发，推导为什么对于任何能观测对 $(A,C)$ 和任何根严格位于开左半平面的首一多项式 $p(\\lambda) = \\lambda^{n} + \\alpha_{n-1} \\lambda^{n-1} + \\cdots + \\alpha_{1} \\lambda + \\alpha_{0}$，都存在一个输出注入矩阵 $L$，使得 $A - L C$ 的特征多项式等于 $p(\\lambda)$。您的推导必须从第一性原理和基本定义出发，不援引任何现成的公式。\n\n第2部分。具体到一个二阶系统，其矩阵为\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n选择 $A - L C$ 的期望特征值为 $\\lambda_{1} = -2$ 和 $\\lambda_{2} = -5$。通过直接计算 $A - L C$ 的特征多项式并进行系数匹配，显式地确定实现这些特征值的 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$ 的元素。\n\n第3部分。对于第2部分中的相同系统，考虑随机状态空间模型\n$$\n\\dot{x}(t) = A x(t) + w(t), \\quad y(t) = C x(t) + v(t),\n$$\n其中 $w(t)$ 是零均值高斯白过程噪声，$v(t)$ 是测量噪声，两者相互独立，其协方差为 $\\mathbb{E}[w(t) w(\\tau)^{\\top}] = Q \\delta(t - \\tau)$ 和 $\\mathbb{E}[v(t) v(\\tau)] = R \\delta(t - \\tau)$，其中\n$$\nQ = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad R = 1.\n$$\n通过求解误差协方差 $P \\in \\mathbb{R}^{2 \\times 2}$ 的连续时间代数黎卡提方程，并计算 $L_{\\mathrm{KF}} = P C^{\\top} R^{-1}$，来计算稳态卡尔曼滤波器增益 $L_{\\mathrm{KF}} \\in \\mathbb{R}^{2 \\times 1}$。然后，用文字对比第2部分中的特征值配置增益与此处推导的稳态卡尔曼增益在概念基础上的差异。\n\n答案说明：将您的最终答案以一个行矩阵的形式报告，该矩阵包含四个元素 $\\ell_{1}$、$\\ell_{2}$、$k_{1}$、$k_{2}$，其中 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$ 是第2部分中的特征值配置增益，$L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$ 是第3部分中的卡尔曼增益。请提供精确值，不要四舍五入。", "solution": "该问题已经过验证，被认为是适定的、科学上合理的且内部一致的。这是线性系统理论和最优估计中的一个标准问题。我们将开始求解。\n\n第1部分：观测器极点配置的推导\n目标是证明对于一个能观测对 $(A,C)$（其中 $A \\in \\mathbb{R}^{n \\times n}$ 和 $C \\in \\mathbb{R}^{m \\times n}$），总是可以找到一个输出注入增益 $L \\in \\mathbb{R}^{n \\times m}$，使得观测器误差动态矩阵 $A-LC$ 的特征多项式与任何指定的 $n$ 次首一多项式 $p(\\lambda)$ 相匹配。这个性质被称为观测器的极点配置或极点分配。推导将依赖于控制理论中的对偶原理。\n\n观测器的极点是矩阵 $A-LC$ 的特征值。$A-LC$ 的特征多项式由 $\\det(\\lambda I - (A-LC))$ 给出。行列式的一个基本性质是，对于任何方阵 $M$，都有 $\\det(M) = \\det(M^{\\top})$。因此，$A-LC$ 的特征值与其转置 $(A-LC)^{\\top} = A^{\\top} - C^{\\top}L^{\\top}$ 的特征值相同。\n\n我们来定义一个“对偶”系统。对于由矩阵 $(A, C)$ 控制的原系统，我们定义一个对偶系统，其状态矩阵为 $A' = A^{\\top}$，输入矩阵为 $B' = C^{\\top}$。我们还为这个对偶系统定义一个状态反馈增益 $K' = L^{\\top}$。这个对偶系统在状态反馈下的闭环矩阵是 $A' - B'K' = A^{\\top} - C^{\\top}L^{\\top}$。\n\n从这个构造中可以明显看出，寻找一个观测器增益 $L$ 以将 $A-LC$ 的特征值配置在期望位置的问题，在数学上等价于寻找一个状态反馈增益 $K' = L^{\\top}$ 以将 $A^{\\top} - C^{\\top}L^{\\top}$ 的特征值配置在相同位置的问题。后者是针对系统 $(A', B') = (A^{\\top}, C^{\\top})$ 的标准状态反馈极点配置问题。\n\n控制理论的一个基石定理指出，当且仅当系统是能控的，通过状态反馈进行任意极点配置才是可能的。因此，如果我们能证明对偶系统 $(A^{\\top}, C^{\\top})$ 是能控的，那么我们总能找到一个增益 $K'$（从而得到 $L$）来实现任何期望的特征多项式。原系统的能观测性与对偶系统的能控性之间的联系是通过 Popov–Belevitch–Hautus (PBH) 检验建立的。\n\n能观测性的 PBH 检验指出，当且仅当对于所有复数 $\\lambda \\in \\mathbb{C}$，矩阵\n$$\n\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}\n$$\n具有满列秩 $n$ 时，系统对 $(A, C)$ 是能观测的。\n\n问题陈述假设系统对 $(A,C)$ 是能观测的。因此，对于任何 $\\lambda \\in \\mathbb{C}$，\n$$\n\\mathrm{rank} \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} = n.\n$$\n由于一个矩阵的秩等于其转置的秩，我们有\n$$\n\\mathrm{rank} \\left( \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}^{\\top} \\right) = \\mathrm{rank} \\begin{pmatrix} (A - \\lambda I)^{\\top}  C^{\\top} \\end{pmatrix} = \\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I  C^{\\top} \\end{pmatrix} = n.\n$$\n这最后一个条件，即对于所有 $\\lambda \\in \\mathbb{C}$ 都有 $\\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I  C^{\\top} \\end{pmatrix} = n$，正是系统对 $(A^{\\top}, C^{\\top})$ 能控性的 PBH 检验。\n\n因此，如果系统对 $(A,C)$ 是能观测的，那么系统对 $(A^{\\top}, C^{\\top})$ 就是能控的。根据状态反馈极点配置定理，对于一个能控系统，可以找到一个增益矩阵 $K'$，将闭环系统 $A^{\\top}-C^{\\top}K'$ 的特征值分配到任何期望的位置集合。这些位置是指定的首一多项式 $p(\\lambda)$ 的根。通过设置 $K'=L^{\\top}$，我们找到了观测器增益 $L$，它将观测器动态矩阵 $A-LC$ 的极点配置在这些相同的位置。要求 $p(\\lambda)$ 的根位于开左半平面，确保了观测器的稳定性，这是实际目标。推导至此完成。\n\n第2部分：特征值配置增益的计算\n我们给定的系统矩阵为\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n输出注入增益为 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$。矩阵 $A-LC$ 计算如下：\n$$\nA - LC = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1}  0 \\\\ \\ell_{2}  0 \\end{pmatrix} = \\begin{pmatrix} -\\ell_{1}  1 \\\\ -\\ell_{2}  0 \\end{pmatrix}.\n$$\n$A-LC$ 的特征多项式为\n$$\n\\det(\\lambda I - (A-LC)) = \\det \\begin{pmatrix} \\lambda + \\ell_{1}  -1 \\\\ \\ell_{2}  \\lambda \\end{pmatrix} = \\lambda(\\lambda + \\ell_{1}) - (-1)(\\ell_{2}) = \\lambda^{2} + \\ell_{1}\\lambda + \\ell_{2}.\n$$\n期望的特征值为 $\\lambda_{1} = -2$ 和 $\\lambda_{2} = -5$。期望的特征多项式为\n$$\np(\\lambda) = (\\lambda - \\lambda_{1})(\\lambda - \\lambda_{2}) = (\\lambda + 2)(\\lambda + 5) = \\lambda^{2} + 7\\lambda + 10.\n$$\n通过匹配计算出的和期望的特征多项式的系数，我们得到：\n$$\n\\ell_{1} = 7, \\quad \\ell_{2} = 10.\n$$\n因此，所需的增益矩阵为 $L = \\begin{pmatrix} 7 \\\\ 10 \\end{pmatrix}$。\n\n第3部分：稳态卡尔曼增益的计算与概念对比\n我们给定的过程噪声和测量噪声的协方差强度为 $Q=I$ 和 $R=1$。稳态卡尔曼滤波器增益 $L_{\\mathrm{KF}}$ 由 $L_{\\mathrm{KF}} = PC^{\\top}R^{-1}$ 给出，其中 $P$ 是连续时间代数黎卡提方程 (CARE) 的对称正定解：\n$$\nAP + PA^{\\top} - PC^{\\top}R^{-1}CP + Q = 0.\n$$\n设 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$。代入给定的矩阵 $A, C, Q, R$：\n$$\n\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} - \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n计算每一项：\n$$\n\\begin{pmatrix} p_{12}  p_{22} \\\\ 0  0 \\end{pmatrix} + \\begin{pmatrix} p_{12}  0 \\\\ p_{22}  0 \\end{pmatrix} - \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 2p_{12}  p_{22} \\\\ p_{22}  0 \\end{pmatrix} - \\begin{pmatrix} p_{11}^{2}  p_{11}p_{12} \\\\ p_{11}p_{12}  p_{12}^{2} \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n这个矩阵方程产生了一个关于 $P$ 的元素的代数方程组：\n1. $2p_{12} - p_{11}^{2} + 1 = 0$\n2. $p_{22} - p_{11}p_{12} = 0$\n3. $-p_{12}^{2} + 1 = 0$\n\n从方程($3$)，我们得到 $p_{12}^{2} = 1$，即 $p_{12} = \\pm 1$。为了保证稳定性，卡尔曼滤波器误差动态矩阵 $A - L_{\\mathrm{KF}}C = \\begin{pmatrix} -p_{11}  1 \\\\ -p_{12}  0 \\end{pmatrix}$ 的特征值必须位于开左半平面。特征多项式为 $\\lambda^{2} + p_{11}\\lambda + p_{12} = 0$。为了根的稳定性，Routh-Hurwitz 稳定性判据要求所有系数都为正。因此，我们必须有 $p_{11} > 0$ 和 $p_{12} > 0$。所以我们必须选择 $p_{12} = 1$。\n\n将 $p_{12}=1$ 代入方程($1$)：\n$$\n2(1) - p_{11}^{2} + 1 = 0 \\implies p_{11}^{2} = 3.\n$$\n由于我们要求 $p_{11} > 0$，所以有 $p_{11} = \\sqrt{3}$。\n\n将 $p_{11}=\\sqrt{3}$ 和 $p_{12}=1$ 代入方程($2$)：\n$$\np_{22} - (\\sqrt{3})(1) = 0 \\implies p_{22} = \\sqrt{3}.\n$$\n稳态误差协方差为 $P = \\begin{pmatrix} \\sqrt{3}  1 \\\\ 1  \\sqrt{3} \\end{pmatrix}$。我们验证该矩阵是正定的：$p_{11}=\\sqrt{3} > 0$ 且 $\\det(P) = (\\sqrt{3})(\\sqrt{3}) - 1^{2} = 3-1=2>0$。\n\n那么，稳态卡尔曼增益 $L_{\\mathrm{KF}}$ 为：\n$$\nL_{\\mathrm{KF}} = PC^{\\top}R^{-1} = \\begin{pmatrix} \\sqrt{3}  1 \\\\ 1  \\sqrt{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) = \\begin{pmatrix} \\sqrt{3} \\\\ 1 \\end{pmatrix}.\n$$\n设 $L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$，我们有 $k_{1} = \\sqrt{3}$ 和 $k_{2} = 1$。\n\n概念对比：\n第2部分中的特征值配置增益 $L$ 是确定性地选择的，以实现观测器误差的任意的、用户指定的动态响应。极点（此处为 $-2$ 和 $-5$）的选择是由设计规范（如期望的镇定时间或阻尼）决定的，但在其他方面是任意的。这种方法完全忽略了系统的任何随机方面，例如过程噪声或测量噪声。\n\n形成鲜明对比的是，第3部分中的稳态卡尔曼增益 $L_{\\mathrm{KF}}$ 不是任意的。它是根据系统的统计特性（即过程噪声协方差 $Q$ 和测量噪声协方差 $R$）唯一确定的最优增益，该增益最小化了状态估计误差的方差。最终的观测器极点不是由设计者直接指定的，而是这种优化的结果。卡尔曼滤波器通过系统地平衡对系统模型的置信度和对测量的置信度，提供了均方意义上的最佳可能估计。极点配置方法强制实现一种期望的行为，而卡尔曼滤波器则从系统潜在的随机现实中推导出一种最优行为。", "answer": "$$\n\\boxed{\\begin{pmatrix} 7  10  \\sqrt{3}  1 \\end{pmatrix}}\n$$", "id": "2748160"}, {"introduction": "卡尔曼滤波器的最优性并非普适的，而是相对于给定的过程噪声协方差 $Q$ 和测量噪声协方差 $R$ 而言的。一个自然的问题是：滤波器的性能究竟如何依赖于这些统计参数？本练习将通过一个具体案例，定量分析当噪声统计特性发生变化时，作为滤波器性能直接度量的稳态估计误差协方差会如何响应，从而揭示一个清晰且富有洞察力的缩放关系。[@problem_id:2748182]", "problem": "考虑连续时间线性时不变（LTI）随机系统\n$$\\dot{x}(t)=A\\,x(t)+w(t),\\quad y(t)=C\\,x(t)+v(t),$$\n其矩阵为\n$$A=\\begin{pmatrix}1  0 \\\\ 0  -2\\end{pmatrix},\\quad C=\\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix},$$\n且白高斯过程噪声和测量噪声由协方差\n$$Q=q\\,I_2,\\quad R=r\\,I_2,$$\n表征，其中 $q=1$ 且 $r=1$。假设标准的可检测性和可镇定性条件成立，因此卡尔曼-布西滤波器的稳态误差协方差 $P\\succ 0$ 存在，其中 $P$ 是稳态估计误差协方差方程的唯一正定解。将主方差定义为 $P$ 的特征值。\n\n分别考虑对噪声统计特性的两种扰动：\n- 将测量噪声协方差加倍至 $R_{\\mathrm{d}}=2\\,R$，同时保持 $Q$ 不变。\n- 将过程噪声协方差减半至 $Q_{\\mathrm{h}}=\\tfrac{1}{2}\\,Q$，同时保持 $R$ 不变。\n\n令 $P_{\\mathrm{d}}$ 和 $P_{\\mathrm{h}}$ 分别表示在 $R_{\\mathrm{d}}$ 和 $Q_{\\mathrm{h}}$ 条件下对应的稳态误差协方差矩阵。使用连续时间状态估计的基本原理，并且除了核心定义之外不使用任何捷径结果，推导这些变化如何影响主方差，并计算标量比\n$$\\Gamma=\\frac{\\det\\!\\big(P_{\\mathrm{d}}\\big)}{\\det\\!\\big(P_{\\mathrm{h}}\\big)}.$$\n将最终答案表示为一个无单位的实数。无需四舍五入。", "solution": "我们从连续时间卡尔曼-布西滤波器框架开始。对于随机系统\n$$\\dot{x}(t)=A\\,x(t)+w(t),\\quad y(t)=C\\,x(t)+v(t),$$\n其中过程噪声协方差为 $Q$，测量噪声协方差为 $R$，稳态估计误差协方差 $P$ 满足连续时间代数黎卡提方程\n$$A\\,P+P\\,A^{\\top}+Q-P\\,C^{\\top}R^{-1}C\\,P=0.$$\n这是连续时间状态估计中一个核心且经过充分检验的结果。\n\n根据给定的数据，\n$$A=\\begin{pmatrix}1  0 \\\\ 0  -2\\end{pmatrix},\\quad C=I_2,\\quad Q=q\\,I_2,\\quad R=r\\,I_2,$$\n且 $q=1$, $r=1$。由于 $A$, $C$, $Q$, 和 $R$ 都是对角矩阵（其中 $C=I_2$），黎卡提方程解耦为两个独立的标量方程，每个坐标一个。令 $a_1=1$ 和 $a_2=-2$ 表示 $A$ 的对角线元素，并令 $p_i$ 表示 $P$ 的第 $i$ 个主方差（特征值）。对于一个具有漂移 $a$ 和标量协方差 $q$ 和 $r$ 的一般标量模式，稳态标量黎卡提方程为\n$$2\\,a\\,p+q-\\frac{p^2}{r}=0.$$\n重写为，\n$$\\frac{p^2}{r}-2\\,a\\,p-q=0,$$\n这是一个关于 $p$ 的二次方程，其解为\n$$p=r\\left(a\\pm \\sqrt{a^2+\\frac{q}{r}}\\right).$$\n通过要求估计误差动态矩阵 $A-K\\,C$ 是赫尔维茨（Hurwitz）矩阵来选择物理上相关的（稳定的）解，其中稳态卡尔曼增益为 $K=P\\,C^{\\top}R^{-1}=\\frac{p}{r}$。在标量形式下，这要求 $a-\\frac{p}{r}0$。选择正号得到\n$$\\frac{p}{r}=a+\\sqrt{a^2+\\frac{q}{r}},$$\n使得\n$$a-\\frac{p}{r}=a-\\left(a+\\sqrt{a^2+\\frac{q}{r}}\\right)=-\\sqrt{a^2+\\frac{q}{r}}0,$$\n确保了稳定性。负号会得到 $a-\\frac{p}{r}=+\\sqrt{a^2+\\frac{q}{r}}0$，这是不稳定的。因此，对于任何标量模式，\n$$p=r\\left(a+\\sqrt{a^2+\\frac{q}{r}}\\right).$$\n\n我们现在将此应用于两种扰动。\n\n1) 将测量噪声协方差加倍：$R_{\\mathrm{d}}=2\\,r\\,I_2$ 且 $q$ 不变。对于具有漂移 $a$ 的标量模式，对应的主方差 $p_{\\mathrm{d}}$ 满足\n$$p_{\\mathrm{d}}=2\\,r\\left(a+\\sqrt{a^2+\\frac{q}{2\\,r}}\\right).$$\n\n2) 将过程噪声协方差减半：$Q_{\\mathrm{h}}=\\tfrac{1}{2}\\,q\\,I_2$ 且 $r$ 不变。对于具有相同漂移 $a$ 的同一标量模式，对应的主方差 $p_{\\mathrm{h}}$ 满足\n$$p_{\\mathrm{h}}=r\\left(a+\\sqrt{a^2+\\frac{q/2}{r}}\\right)=r\\left(a+\\sqrt{a^2+\\frac{q}{2\\,r}}\\right).$$\n\n对具有相同 $a$ 的任意标量模式比较这两个表达式，我们得到精确的比例关系\n$$p_{\\mathrm{d}}=2\\,p_{\\mathrm{h}}.$$\n这种比例关系对每个解耦的模式都独立成立，因此对 $2\\times 2$ 协方差矩阵的两个主方差都成立。因此，如果 $P_{\\mathrm{h}}$ 的特征值为 $p_{\\mathrm{h},1}$ 和 $p_{\\mathrm{h},2}$，那么 $P_{\\mathrm{d}}$ 的特征值为 $p_{\\mathrm{d},1}=2\\,p_{\\mathrm{h},1}$ 和 $p_{\\mathrm{d},2}=2\\,p_{\\mathrm{h},2}$。因此，\n$$\\det\\!\\big(P_{\\mathrm{d}}\\big)=(2\\,p_{\\mathrm{h},1})\\,(2\\,p_{\\mathrm{h},2})=4\\,p_{\\mathrm{h},1}\\,p_{\\mathrm{h},2}=4\\,\\det\\!\\big(P_{\\mathrm{h}}\\big).$$\n所以，所求的比率为\n$$\\Gamma=\\frac{\\det\\!\\big(P_{\\mathrm{d}}\\big)}{\\det\\!\\big(P_{\\mathrm{h}}\\big)}=4.$$\n\n这个结论与 $a_1$ 和 $a_2$ 的具体值无关，因此适用于给定的 $A=\\mathrm{diag}(1,-2)$ 和 $C=I_2$ 以及 $q=1$ 和 $r=1$ 的情况。", "answer": "$$\\boxed{4}$$", "id": "2748182"}, {"introduction": "在实际应用中，我们通常无法精确获知系统真实的噪声统计特性，这导致了所谓的“模型失配”问题。本练习直面这一挑战，模拟了一个常见场景：卡尔曼滤波器在设计时采用了不正确的测量噪声方差。我们的目标是推导在这种模型失配情况下，滤波器真实的稳态性能，从而量化由于模型不精确所带来的性能损失。[@problem_id:2748176]", "problem": "考虑标量、离散时间、时不变的状态空间模型\n$x_{k+1} = x_{k} + w_{k}$ 和 $y_{k} = x_{k} + v_{k}$，其中 $\\{w_{k}\\}$ 和 $\\{v_{k}\\}$ 是相互独立、零均值的高斯白噪声序列，其真实方差为 $\\mathbb{E}[w_{k}^{2}] = Q$ 和 $\\mathbb{E}[v_{k}^{2}] = 2R$，对于固定的标量 $Q0$ 和 $R0$。一个稳态卡尔曼滤波器 (KF) 被实现，其动态特性和过程噪声方差被正确建模（它使用了正确的 $Q$），但其测量噪声方差不匹配：它是在测量噪声方差等于 $R$ 而不是真实值 $2R$ 的假设下设计的。该滤波器使用一个与噪声无关的无偏估计进行初始化。\n\n仅使用线性估计的基本原理，即关于假设统计量的线性最小方差估计器的卡尔曼滤波器更新定义、估计误差及其传播的定义，以及独立零均值随机变量在线性变换下的期望和方差的标准性质，推导由这个不匹配的稳态卡尔曼滤波器产生的估计误差 $e_{k} \\triangleq x_{k} - \\hat{x}_{k|k}$ 的稳态偏差和稳态方差。用纯粹由 $Q$ 和 $R$ 构成的封闭形式表示你的最终答案。将这两个量作为一个单行向量 $[\\,\\text{偏差}\\ \\ \\text{方差}\\,]$ 提供。不需要进行数值计算，也不需要四舍五入。", "solution": "该问题要求推导一个具有不匹配卡尔曼滤波器的标量系统的估计误差的稳态偏差和方差。该滤波器是使用不正确的测量噪声方差设计的。\n\n系统由状态方程和测量方程描述：\n$$x_{k+1} = x_{k} + w_{k}$$\n$$y_{k} = x_{k} + v_{k}$$\n过程噪声 $\\{w_k\\}$ 和测量噪声 $\\{v_k\\}$ 是相互独立、零均值的高斯白噪声序列，其真实方差为 $\\mathbb{E}[w_{k}^{2}] = Q$ 和 $\\mathbb{E}[v_{k}^{2}] = 2R$。\n\n卡尔曼滤波器是基于以下假设参数设计的：\n状态转移矩阵 $A=1$。\n观测矩阵 $C=1$。\n假设的过程噪声方差 $Q_{assumed} = Q$。\n假设的测量噪声方差 $R_{assumed} = R$。\n\n首先，我们确定这个不匹配滤波器使用的稳态卡尔曼增益 $K_{ss}$。该增益是基于滤波器的内部（假设）模型计算的。我们记为 $P_{a}$ 的假设稳态后验误差方差的代数黎卡提方程 (ARE) 是：\n$$P_{a} = (A P_{a} A^T + Q) - (A P_{a} A^T + Q) C^T (C(A P_{a} A^T + Q)C^T + R_{assumed})^{-1} C (A P_{a} A^T + Q)$$\n代入标量值 $A=1$，$C=1$，$Q_{assumed}=Q$ 和 $R_{assumed}=R$：\n$$P_{a} = (P_{a}+Q) - (P_{a}+Q) (1) ((1)(P_{a}+Q)(1) + R)^{-1} (1) (P_{a}+Q)$$\n$$P_{a} = (P_{a}+Q) - \\frac{(P_{a}+Q)^2}{P_{a}+Q+R} = \\frac{(P_{a}+Q)(P_{a}+Q+R) - (P_{a}+Q)^2}{P_{a}+Q+R}$$\n$$P_{a} = \\frac{(P_{a}+Q)(R)}{P_{a}+Q+R}$$\n这得到了关于 $P_{a}$ 的二次方程：\n$$P_{a}(P_{a}+Q+R) = R(P_{a}+Q)$$\n$$P_{a}^2 + P_{a}Q + P_{a}R = P_{a}R + RQ$$\n$$P_{a}^2 + Q P_{a} - QR = 0$$\n求解 $P_{a}$（其必须为非负）：\n$$P_{a} = \\frac{-Q + \\sqrt{Q^2 - 4(1)(-QR)}}{2} = \\frac{-Q + \\sqrt{Q^2 + 4QR}}{2}$$\n稳态卡尔曼增益 $K_{ss}$ 由下式给出：\n$$K_{ss} = \\frac{P_{a}^{-}}{P_{a}^{-} + R_{assumed}} = \\frac{P_{a}+Q}{P_{a}+Q+R}$$\n增益的另一个更简单的表达式是 $K_{ss} = P_{a} C^T R_{assumed}^{-1} = P_{a}/R$。使用这个表达式，ARE 变为 $(K_{ss}R)^2 + Q(K_{ss}R) - QR = 0$。除以 $R$（因为 $R0$）：\n$$K_{ss}^2 R + QK_{ss} - Q = 0$$\n设 $\\gamma = Q/R$。再次除以 $R$ 得到 $K_{ss}^2 + \\gamma K_{ss} - \\gamma = 0$。\n\n接下来，我们分析真实估计误差 $e_k \\triangleq x_k - \\hat{x}_{k|k}$ 的传播。该滤波器使用增益 $K_{ss}$ 运行。\n状态估计通过以下方式更新：\n$$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_{ss}(y_k - \\hat{x}_{k|k-1})$$\n当 $A=1$ 时，预测为 $\\hat{x}_{k|k-1} = \\hat{x}_{k-1|k-1}$。\n$$\\hat{x}_{k|k} = \\hat{x}_{k-1|k-1} + K_{ss}(y_k - \\hat{x}_{k-1|k-1})$$\n代入真实测量值 $y_k = x_k + v_k$：\n$$\\hat{x}_{k|k} = \\hat{x}_{k-1|k-1} + K_{ss}(x_k + v_k - \\hat{x}_{k-1|k-1})$$\n误差为 $e_k = x_k - \\hat{x}_{k|k}$：\n$$e_k = x_k - [\\hat{x}_{k-1|k-1} + K_{ss}(x_k + v_k - \\hat{x}_{k-1|k-1})]$$\n$$e_k = (1-K_{ss})x_k - (1-K_{ss})\\hat{x}_{k-1|k-1} - K_{ss}v_k = (1-K_{ss})(x_k - \\hat{x}_{k-1|k-1})$$\n使用真实的状态动态 $x_k = x_{k-1} + w_{k-1}$：\n$$e_k = (1-K_{ss})(x_{k-1} + w_{k-1} - \\hat{x}_{k-1|k-1}) - K_{ss}v_k$$\n$$e_k = (1-K_{ss})(e_{k-1} + w_{k-1}) - K_{ss}v_k$$\n这是真实估计误差的递推式。\n\n稳态偏差为 $b_{ss} = \\lim_{k\\to\\infty} \\mathbb{E}[e_k]$。对误差递推式取期望：\n$$\\mathbb{E}[e_k] = (1-K_{ss})\\mathbb{E}[e_{k-1}] + (1-K_{ss})\\mathbb{E}[w_{k-1}] - K_{ss}\\mathbb{E}[v_k]$$\n由于 $w_k$ 和 $v_k$ 是零均值的，$\\mathbb{E}[w_{k-1}]=0$ 且 $\\mathbb{E}[v_k]=0$。\n$$b_k = (1-K_{ss})b_{k-1}$$\n滤波器使用无偏估计进行初始化，所以 $b_0 = \\mathbb{E}[e_0] = 0$。因此，对于所有 $k \\ge 0$，有 $b_k = 0$。所以稳态偏差为 $0$。\n\n由于偏差为零，稳态方差为 $P_{ss}^{true} = \\lim_{k\\to\\infty} \\mathbb{E}[e_k^2]$。我们将误差递推式平方并取期望：\n$$P_k^{true} = \\mathbb{E}[e_k^2] = \\mathbb{E}[((1-K_{ss})e_{k-1} + (1-K_{ss})w_{k-1} - K_{ss}v_k)^2]$$\n噪声项 $w_{k-1}$ 和 $v_k$ 彼此独立，并且与过去的误差 $e_{k-1}$ 独立。因此，交叉乘积项的期望为零。\n$$P_k^{true} = (1-K_{ss})^2\\mathbb{E}[e_{k-1}^2] + (1-K_{ss})^2\\mathbb{E}[w_{k-1}^2] + K_{ss}^2\\mathbb{E}[v_k^2]$$\n代入真实方差 $\\mathbb{E}[w_{k-1}^2] = Q$ 和 $\\mathbb{E}[v_k^2] = 2R$：\n$$P_k^{true} = (1-K_{ss})^2 P_{k-1}^{true} + (1-K_{ss})^2 Q + 2R K_{ss}^2$$\n在稳态下，$P_k^{true} = P_{k-1}^{true} = P_{ss}^{true}$：\n$$P_{ss}^{true} = (1-K_{ss})^2 P_{ss}^{true} + (1-K_{ss})^2 Q + 2R K_{ss}^2$$\n$$P_{ss}^{true}(1 - (1-K_{ss})^2) = (1-K_{ss})^2 Q + 2R K_{ss}^2$$\n$$P_{ss}^{true}(1 - (1-2K_{ss}+K_{ss}^2)) = (1-K_{ss})^2 Q + 2R K_{ss}^2$$\n$$P_{ss}^{true}(2K_{ss}-K_{ss}^2) = (1-K_{ss})^2 Q + 2R K_{ss}^2$$\n$$P_{ss}^{true} = \\frac{(1-K_{ss})^2 Q + 2R K_{ss}^2}{K_{ss}(2-K_{ss})}$$\n为了简化，我们使用关系式 $K_{ss}^2 R + QK_{ss} - Q = 0$，其中 $\\gamma=Q/R$。这意味着 $K_{ss}^2 = \\gamma(1-K_{ss})$。\n分子是：\n$$(1-K_{ss})^2 Q + 2R K_{ss}^2 = (1-K_{ss})^2 Q + 2R \\gamma(1-K_{ss})$$\n因为 $R\\gamma = R(Q/R) = Q$：\n$$(1-K_{ss})^2 Q + 2Q(1-K_{ss}) = Q(1-K_{ss})(1-K_{ss}+2) = Q(1-K_{ss})(3-K_{ss})$$\n分母是：\n$$K_{ss}(2-K_{ss}) = 2K_{ss}-K_{ss}^2 = 2K_{ss} - \\gamma(1-K_{ss}) = (2+\\gamma)K_{ss} - \\gamma$$\n所以，$P_{ss}^{true} = Q \\frac{(1-K_{ss})(3-K_{ss})}{(2+\\gamma)K_{ss}-\\gamma}$。\n令 $\\beta = \\sqrt{\\gamma^2+4\\gamma}$。$K_{ss}^2+\\gamma K_{ss}-\\gamma = 0$ 的正解是 $K_{ss} = (-\\gamma+\\beta)/2$。\n分母变为 $\\frac{\\beta}{2}(2+\\gamma-\\beta)$。\n分子变为 $\\frac{Q}{4}(2+\\gamma-\\beta)(6+\\gamma-\\beta)$。\n$$P_{ss}^{true} = \\frac{\\frac{Q}{4}(2+\\gamma-\\beta)(6+\\gamma-\\beta)}{\\frac{\\beta}{2}(2+\\gamma-\\beta)} = \\frac{Q}{2}\\frac{6+\\gamma-\\beta}{\\beta} = \\frac{Q}{2}\\left(\\frac{6+\\gamma}{\\beta}-1\\right)$$\n代入 $\\gamma=Q/R$ 和 $\\beta = \\sqrt{(Q/R)^2+4(Q/R)} = \\frac{\\sqrt{Q^2+4QR}}{R}$：\n$$P_{ss}^{true} = \\frac{Q}{2}\\left(\\frac{6+Q/R}{\\sqrt{Q^2+4QR}/R}-1\\right) = \\frac{Q}{2}\\left(\\frac{6R+Q}{\\sqrt{Q^2+4QR}}-1\\right)$$\n\n最终结果是一个包含稳态偏差和方差的行向量。\n偏差：$0$。\n方差：$\\frac{Q}{2}\\left(\\frac{Q+6R}{\\sqrt{Q^2+4QR}}-1\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0  \\frac{Q}{2} \\left( \\frac{Q+6R}{\\sqrt{Q^2+4QR}} - 1 \\right) \\end{pmatrix}}$$", "id": "2748176"}]}