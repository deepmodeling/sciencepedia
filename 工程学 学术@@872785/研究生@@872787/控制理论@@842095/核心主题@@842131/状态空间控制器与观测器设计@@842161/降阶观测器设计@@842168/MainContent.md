## 引言
在[现代控制系统](@entry_id:269478)中，精确的状态信息是实现高性能控制的基础。然而，在许多实际应用中，由于物理或经济限制，我们往往只能测量系统的一部分状态。[状态观测器](@entry_id:268642)为此提供了解决方案，但传统的全阶观测器在部分状态已知时显得冗余且效率不高。[降阶观测器](@entry_id:178703)（Reduced-order Observer）应运而生，它专注于估计那些真正未知的状态，旨在以更低的计算成本和更少的动态阶次实现高效的[状态估计](@entry_id:169668)。

本文将系统地引导您掌握[降阶观测器](@entry_id:178703)的设计与应用。在“原理与机制”一章，我们将深入探讨其数学基础，包括状态划分、误差动态分析和基于[对偶原理](@entry_id:276615)的增益设计。接着，在“应用与[交叉](@entry_id:147634)学科联系”中，我们将展示其在机电系统、[过程控制](@entry_id:271184)、故障诊断乃至生物医学等多个领域的实际效用。最后，“动手实践”部分将通过具体的编程练习，帮助您将理论知识转化为解决实际问题的能力。

通过这三个层次的递进学习，您将能够全面理解[降阶观测器](@entry_id:178703)为何以及如何成为控制工程师工具箱中的一件利器。让我们首先从其核心的“原理与机制”开始探索。

## 原理与机制

在[状态反馈控制](@entry_id:271611)系统的设计中，我们通常假设所有[状态变量](@entry_id:138790)都是可测量的。然而，在实际工程应用中，由于成本限制或物理条件的约束，往往只能测量一部分状态。观测器（Observer）作为一种动态系统，其作用就是利用已知的系统输入 $u(t)$ 和输出 $y(t)$ 来估计那些无法直接测量的状态变量。全阶观测器（Full-order observer）旨在估计系统全部的 $n$ 个状态变量，但当系统输出 $y(t) = Cx(t)$ 已经提供了 $p$ 个关于状态的[线性无关](@entry_id:148207)信息时，再用一个 $n$ 阶的动态系统去估计全部状态就显得有些冗余。为了提升[计算效率](@entry_id:270255)并降低实现成本，我们可以设计一个阶次低于 $n$ 的[降阶观测器](@entry_id:178703)（Reduced-order observer）。本章将深入探讨[降阶观测器](@entry_id:178703)的核心原理、设计方法及其内在机制。

### [降阶观测器](@entry_id:178703)的基本原理

[降阶观测器](@entry_id:178703)的核心思想在于：我们无需对整个[状态向量](@entry_id:154607)进行动态估计，而应将估计的[焦点](@entry_id:174388)集中在那些未被直接测量的状态分量上。系统的输出 $y(t) \in \mathbb{R}^p$ 提供了 $p$ 个状态变量的线性组合，这意味着有 $p$ 维度的状态信息是“代数已知”的，而非“动态未知”的。因此，我们只需要设计一个动态系统来估计剩下 $n-p$ 维的未知状态信息。

一个[降阶观测器](@entry_id:178703)的阶次因此为 $n-p$。与需要实现 $n$ 个动态[状态变量](@entry_id:138790)的全阶观测器相比，当测量输出的维度 $p$ 较大时，[降阶观测器](@entry_id:178703)能显著降低实现的复杂性。例如，在一个描述大型土木[结构振动](@entry_id:174415)的 $n=10$ 阶模型中，如果工程师能够负担得起测量其中 $p=9$ 个[状态变量](@entry_id:138790)的传感器，那么全阶观测器需要模拟一个10阶的动态系统，而[降阶观测器](@entry_id:178703)仅需模拟一个 $n-p = 10 - 9 = 1$ 阶的系统。在这种情况下，观测器所需实现的动态状态数量的减少比例为 $(n - (n-p))/n = p/n = 9/10 = 0.9$，即实现了90%的降阶，这在计算资源受限的嵌入式控制器中具有极大的吸[引力](@entry_id:175476) [@problem_id:1604212]。

### 状态划分：构建观测器框架

设计[降阶观测器](@entry_id:178703)的第一步是将[状态向量](@entry_id:154607)进行战略性划分。我们的目标是将[状态向量](@entry_id:154607) $x \in \mathbb{R}^n$ 分解为“已测量”和“未测量”两个部分。

从根本上说，任何具有满行秩（秩为 $p$）输出矩阵 $C$ 的系统都可以通过一个非奇异[坐标变换](@entry_id:172727) $z(t) = T x(t)$ 来实现状态划分。我们可以构造变换矩阵 $T = \begin{pmatrix} C \\ M \end{pmatrix}$，其中 $M \in \mathbb{R}^{(n-p) \times n}$ 的行向量与 $C$ 的行向量[线性无关](@entry_id:148207)，从而保证 $T$ 是可逆的。在这个新的[坐标系](@entry_id:156346)下，状态 $z(t)$ 被自然地划分为两部分：$z_1(t) = C x(t) = y(t)$，这是直接从系统输出中获得的已测量部分；以及 $z_2(t) = M x(t)$，这是需要被估计的未测量部分 [@problem_id:2737319]。

为了教学上的清晰，我们常常假设系统已经处于一个方便的[坐标系](@entry_id:156346)中，使得状态向量 $x$可以直接划分为 $x = \begin{pmatrix} x_a \\ x_b \end{pmatrix}$，其中 $x_a \in \mathbb{R}^p$ 是可测量的部分，而 $x_b \in \mathbb{R}^{n-p}$ 是需要估计的未测量部分。在这种情况下，系统的输出方程简化为 $y(t) = x_a(t)$，对应的输出矩阵形式为 $C = \begin{pmatrix} I_p & 0 \end{pmatrix}$。

相应地，系统的状态空间矩阵 $A$ 和 $B$ 也需要进行分块：
$$
\dot{x}(t) = \begin{pmatrix} \dot{x}_a(t) \\ \dot{x}_b(t) \end{pmatrix} = \begin{pmatrix} A_{aa} & A_{ab} \\ A_{ba} & A_{bb} \end{pmatrix} \begin{pmatrix} x_a(t) \\ x_b(t) \end{pmatrix} + \begin{pmatrix} B_a \\ B_b \end{pmatrix} u(t)
$$
其中，$A_{aa} \in \mathbb{R}^{p \times p}$，$A_{ab} \in \mathbb{R}^{p \times (n-p)}$，$A_{ba} \in \mathbb{R}^{(n-p) \times p}$，$A_{bb} \in \mathbb{R}^{(n-p) \times (n-p)}$，$B_a \in \mathbb{R}^{p \times m}$ 以及 $B_b \in \mathbb{R}^{(n-p) \times m}$。

例如，考虑一个三阶[LTI系统](@entry_id:271946)，其矩阵为 [@problem_id:1604264]：
$$
A = \begin{pmatrix} 0 & 1 & 0 \\ -5 & -2 & 1 \\ 3 & 0 & -4 \end{pmatrix}, \quad B = \begin{pmatrix} 0 \\ 1 \\ 2 \end{pmatrix}, \quad C = \begin{pmatrix} 1 & 0 & 0 \end{pmatrix}
$$
由于 $y = x_1$，我们选择 $x_a = x_1$ 作为已测量部分，$x_b = \begin{pmatrix} x_2 \\ x_3 \end{pmatrix}$ 作为未测量部分。按照这个划分，我们可以将 $A$ 和 $B$ 矩阵分块：
$A_{aa}=0, A_{ab}=\begin{pmatrix} 1 & 0 \end{pmatrix}, A_{ba}=\begin{pmatrix} -5 \\ 3 \end{pmatrix}, A_{bb}=\begin{pmatrix} -2 & 1 \\ 0 & -4 \end{pmatrix}$
$B_a = 0, B_b = \begin{pmatrix} 1 \\ 2 \end{pmatrix}$
这种划分是后续推导和设计的基础。

### 误差动态与观测器方程推导

状态划分之后，我们的目标是估计 $x_b$。让我们考察分块后的[状态方程](@entry_id:274378)：
1. $\dot{x}_a(t) = A_{aa} x_a(t) + A_{ab} x_b(t) + B_a u(t)$
2. $\dot{x}_b(t) = A_{ba} x_a(t) + A_{bb} x_b(t) + B_b u(t)$

第二个方程描述了未测量状态 $x_b$ 的动态演化。我们可以将其视为一个以 $x_b$ 为状态，以已知的 $x_a(=y)$ 和 $u$ 为外部输入的系统。第一个方程则隐含了关于 $x_b$ 的“测量信息”。我们可以将其改写为：
$$
A_{ab} x_b(t) = \dot{x}_a(t) - A_{aa} x_a(t) - B_a u(t)
$$
这表明，我们可以通过对测量值 $y=x_a$求导，来构造一个与 $x_b$ 相关的“伪输出”。因此，估计 $x_b$ 的问题可以看作是为动态系统 $\dot{x}_b = A_{bb}x_b + \dots$ 设计一个观测器，其“系统矩阵”为 $A_{bb}$，而“输出矩阵”为 $A_{ab}$。

基于这一思想，我们可以构建一个Luenberger风格的观测器来估计 $x_b$。定义[估计误差](@entry_id:263890)为 $\tilde{x}_b(t) = x_b(t) - \hat{x}_b(t)$。通过引入一个待设计的[观测器增益](@entry_id:267562)矩阵 $L \in \mathbb{R}^{(n-p) \times p}$，可以证明误差的动态方程为 [@problem_id:1604227]：
$$
\dot{\tilde{x}}_b(t) = (A_{bb} - L A_{ab}) \tilde{x}_b(t)
$$
这个简洁而优美的结果是[降阶观测器](@entry_id:178703)设计的核心。我们的任务就是选择 $L$，使得矩阵 $(A_{bb} - L A_{ab})$ 成为一个Hurwitz矩阵，即其所有[特征值](@entry_id:154894)的实部都为负。这样，估计误差 $\tilde{x}_b(t)$ 将会渐近收敛到零。

然而，上述推导过程中隐含地使用了 $\dot{y}$，这在实际应用中是需要避免的，因为对含有噪声的测量信号进行[微分](@entry_id:158718)会极大地放大噪声。为了设计一个可实现的观测器，我们引入一个辅助[状态变量](@entry_id:138790) $z(t) \in \mathbb{R}^{n-p}$，其定义为：
$$
z(t) = \hat{x}_b(t) - L y(t)
$$
这个变量 $z(t)$ 将成为我们[降阶观测器](@entry_id:178703)的内部状态。对 $z(t)$ 求导并经过一系列代数运算，我们可以得到一个不含 $y(t)$ 导数项的动态方程：
$$
\dot{z}(t) = F z(t) + G y(t) + H u(t)
$$
其中，矩阵 $F, G, H$ 定义如下：
- $F = A_{bb} - L A_{ab}$
- $H = B_b - L B_a$
- $G = F L + A_{ba} - L A_{aa} = (A_{bb} - L A_{ab})L + A_{ba} - L A_{aa}$

这组方程定义了一个完整的 $(n-p)$ 阶动态系统。它以系统的输入 $u(t)$ 和输出 $y(t)$ 作为输入，其内部状态为 $z(t)$。一旦 $z(t)$ 被求出，未测量状态的估计值 $\hat{x}_b(t)$ 就可以通过代数关系 $\hat{x}_b(t) = z(t) + L y(t)$ 得到。

### [观测器增益](@entry_id:267562)设计与[对偶原理](@entry_id:276615)

[降阶观测器](@entry_id:178703)的设计关键在于选择增益矩阵 $L$，以确保误差动态矩阵 $F = A_{bb} - L A_{ab}$ 具有期望的稳定性。我们不仅希望[误差收敛](@entry_id:137755)，还常常希望控制其[收敛速度](@entry_id:636873)，即任意配置 $F$ 的[特征值](@entry_id:154894)（极点）。

一个基本的理论结果是：矩阵 $(A_{bb} - L A_{ab})$ 的[特征值](@entry_id:154894)可以通过选择 $L$ 来任意配置的充分必要条件是矩阵对 $(A_{bb}, A_{ab})$ 是**能观测的**（Observable）[@problem_id:1604245]。如果该矩阵对只是**能检测的**（Detectable，即所有[不可观测模式](@entry_id:168628)都是稳定的），我们仍然可以设计一个稳定的观测器，但不能任意配置所有误差动态的极点。

在求解增益 $L$ 时，我们可以利用控制理论中一个深刻而优美的概念——**[对偶原理](@entry_id:276615)**（Duality Principle）。该原理指出，[状态观测器设计](@entry_id:168017)问题与[状态反馈控制器设计](@entry_id:270917)问题在数学上是对偶的。具体来说，为系统 $(A, C)$ 设计[观测器增益](@entry_id:267562) $L$ 以配置 $(A-LC)$ 的[特征值](@entry_id:154894)，等价于为对偶系统 $(A^T, C^T)$ 设计[状态反馈](@entry_id:151441)增益 $K$ 以配置 $(A^T - C^T K)$ 的[特征值](@entry_id:154894)，两者之间的关系是 $L = K^T$。

对于[降阶观测器](@entry_id:178703)，这个原理同样适用。设计增益 $L$ 来配置误差动态矩阵 $(A_{bb} - L A_{ab})$ 的[特征值](@entry_id:154894)，与为对偶系统（[系统矩阵](@entry_id:172230)为 $A_{bb}^T$，输入矩阵为 $A_{ab}^T$）设计[状态反馈](@entry_id:151441)增益 $K$ 来配置闭环矩阵 $(A_{bb}^T - A_{ab}^T K)$ 的[特征值](@entry_id:154894)是完[全等](@entry_id:273198)价的。这两个闭环矩阵的[特征值](@entry_id:154894)是相同的，并且增益关系为 $L=K^T$。

这一原理极大地简化了设计过程，特别是当相关的[控制器设计](@entry_id:274982)问题已经解决时。例如，考虑一个系统 [@problem_id:1604273]，其子矩阵为 $A_{bb} = \begin{pmatrix} 0 & 1 \\ -6 & -5 \end{pmatrix}$ 和 $A_{ab} = \begin{pmatrix} 1 & 0 \end{pmatrix}$。假设另一个团队已经为对偶系统 $\dot{z} = A_{bb}^T z + A_{ab}^T u$ 设计了[状态反馈控制器](@entry_id:203349) $u=-K_{reg}z$，并得到最优增益 $K_{reg} = \begin{pmatrix} 13 & 9 \end{pmatrix}$。利用[对偶原理](@entry_id:276615)，我们可以立即确定[降阶观测器](@entry_id:178703)的增益 $L$：
$$
L = K_{reg}^T = \begin{pmatrix} 13 \\ 9 \end{pmatrix}
$$
这样，我们就无需重新进行[极点配置](@entry_id:155523)计算，直接得到了 $L$ 的值。其中第二个分量 $l_2$ 即为 $9$。

### 完整状态估计的重构

[降阶观测器](@entry_id:178703)运行后，我们得到了未测量部分的估计 $\hat{x}_b(t)$。为了实现全[状态反馈](@entry_id:151441)，我们需要重构完整的[状态估计](@entry_id:169668)向量 $\hat{x}(t)$。这个过程非常直接：
- 已测量部分的最佳估计就是测量值本身：$\hat{x}_a(t) = y(t)$。
- 未测量部分的估计值由观测器的内部状态 $z(t)$ 和测量值 $y(t)$ 代数合成：$\hat{x}_b(t) = z(t) + L y(t)$。

将这两部分组合起来，便得到完整的状态估计：
$$
\hat{x}(t) = \begin{pmatrix} \hat{x}_a(t) \\ \hat{x}_b(t) \end{pmatrix} = \begin{pmatrix} y(t) \\ z(t) + L y(t) \end{pmatrix}
$$
这个重构过程可以优雅地表示为一个[矩阵变换](@entry_id:156789)。我们可以将完整的[状态估计](@entry_id:169668) $\hat{x}(t)$ 写成关于测量值 $y(t)$ 和观测器状态 $z(t)$ 的线性组合 [@problem_id:1604234]：
$$
\hat{x}(t) = P \begin{pmatrix} y(t) \\ z(t) \end{pmatrix}
$$
通过展开上式并与分块形式对比，可以确定重构矩阵 $P$ 的结构：
$$
\hat{x}(t) = \begin{pmatrix} I_p & 0 \\ L & I_{n-p} \end{pmatrix} \begin{pmatrix} y(t) \\ z(t) \end{pmatrix}
$$
所以，$P = \begin{pmatrix} I_p & 0 \\ L & I_{n-p} \end{pmatrix}$。例如，在一个三阶系统中，如果 $p=1$，$L = \begin{pmatrix} 5 \\ -2 \end{pmatrix}$，那么重构矩阵为：
$$
P = \begin{pmatrix} 1 & 0 & 0 \\ 5 & 1 & 0 \\ -2 & 0 & 1 \end{pmatrix}
$$
这个矩阵 $P$ 将观测器的输出（内部状态 $z$）和系统的直接测量（$y$）映射回原始[状态空间](@entry_id:177074)，完成了整个估计过程。

### 设计实例分析

下面我们通过一个具体的例子来贯穿整个设计流程。考虑一个[二阶系统](@entry_id:276555) [@problem_id:1604223]：
$$
A = \begin{bmatrix} -1 & 3 \\ 2 & -4 \end{bmatrix}, \quad B = \begin{bmatrix} 1 \\ 0 \end{bmatrix}, \quad C = \begin{bmatrix} 1 & 0 \end{bmatrix}
$$
这里 $n=2, p=1$。$y=x_1$ 是测量状态，$x_2$ 是未测量状态。我们需要设计一个一阶观测器来估计 $x_2$，并要求误差动态的极点位于 $s = -10$。

为了展示方法的多样性，我们不直接套用[分块矩阵](@entry_id:148435)公式，而是从第一性原理出发。定义一个辅助变量 $\eta(t) = x_2(t) - L x_1(t)$，其中 $L$ 是待定标量增益。我们的目标是设计一个动态系统来估计 $\eta(t)$。对 $\eta(t)$ 求导：
$$
\dot{\eta}(t) = \dot{x}_2(t) - L \dot{x}_1(t)
$$
代入系统动态方程 $\dot{x}_1 = -x_1 + 3x_2 + u$ 和 $\dot{x}_2 = 2x_1 - 4x_2$：
$$
\dot{\eta}(t) = (2x_1 - 4x_2) - L(-x_1 + 3x_2 + u) = (2+L)x_1 - (4+3L)x_2 - Lu
$$
用 $\eta$ 和 $y=x_1$ 来替换 $x_2$，即 $x_2 = \eta + L x_1 = \eta + L y$：
$$
\dot{\eta}(t) = (2+L)y - (4+3L)(\eta + Ly) - Lu = -(4+3L)\eta + (2+L - 4L - 3L^2)y - Lu
$$
$$
\dot{\eta}(t) = -(4+3L)\eta + (2 - 3L - 3L^2)y - Lu
$$
我们设计的观测器 $\dot{\hat{\eta}} = F\hat{\eta} + Gy + Hu$ 应该模仿这个动态。[估计误差](@entry_id:263890) $e(t) = \eta(t) - \hat{\eta}(t)$ 的动态将是 $\dot{e}(t) = -(4+3L)e(t)$，只要我们选择观测器参数 $F=-(4+3L), G=2-3L-3L^2, H=-L$。

为了将误差[极点配置](@entry_id:155523)在 $s=-10$，我们需要误差动态矩阵（这里是标量）等于 $-10$：
$$
-(4+3L) = -10 \implies 4+3L=10 \implies 3L=6 \implies L=2
$$
找到了增益 $L=2$ 后，我们就可以确定观测器方程中的其他参数。问题要求的是 $G$ 的值：
$$
G = 2 - 3L - 3L^2 \Big|_{L=2} = 2 - 3(2) - 3(2)^2 = 2 - 6 - 12 = -16
$$
这样，我们就完成了一个[降阶观测器](@entry_id:178703)的完整设计。

### 基本前提与设计局限

最后，必须强调的是，并非所有系统都能成功设计出稳定的[降阶观测器](@entry_id:178703)。设计成功的根本前提在于原系统 $(A,C)$ 的[可检测性](@entry_id:265305)（Detectability）。一个系统是可检测的，如果其所有不可观测的状态模式本质上都是稳定的。

如果系统 $(A,C)$ 本身就是不可检测的——例如，它有一个不稳定或临界稳定的模式，而这个模式在输出 $y(t)$ 中完全不可见——那么任何观测器，无论是全阶还是降阶，都无法保证估计误差收斂至零。坐标变换或状态划分并不能修复系统固有的不[可检测性](@entry_id:265305)。

一个有启发性的例子是 [@problem_id:1604209]，其中系统 $(A,C)$ 有一个位于 $s=0$ 的[不可观测模式](@entry_id:168628)，因此是不可检测的。当对该系统进行坐标变换和划分后，得到的子系统对 $(\bar{A}_{22}, \bar{A}_{12})$ 也表现出不[可检测性](@entry_id:265305)。这揭示了一个深刻的联系：用于[降阶观测器](@entry_id:178703)设计的子系统对 $(A_{bb}, A_{ab})$ 的[可检测性](@entry_id:265305)，本质上继承自原始系统 $(A,C)$ 的[可检测性](@entry_id:265305)。如果 $(A,C)$ 可检测，那么 $(A_{bb}, A_{ab})$ 也必然可检测，从而保证了稳定的[降阶观测器](@entry_id:178703)设计的可能性 [@problem_id:2737319]。

总之，[降阶观测器](@entry_id:178703)是一种高效、优美的[状态估计](@entry_id:169668)工具。它通过代数方式利用已知测量信息，并构建一个低阶动态系统来估计未知的状态部分，其设计根植于状态划分、[极点配置](@entry_id:155523)和[对偶原理](@entry_id:276615)，而其存在的根本前提，则是原系统本身的[可检测性](@entry_id:265305)。