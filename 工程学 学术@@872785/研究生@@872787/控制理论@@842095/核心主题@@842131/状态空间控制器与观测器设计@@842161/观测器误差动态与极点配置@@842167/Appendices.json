{"hands_on_practices": [{"introduction": "理论学习的最佳方式莫过于动手实践。本节的第一个练习将引导你完成一个典型的观测器极点配置任务。通过为一个二阶连续时间系统设计观测器增益 $L$，你将直接体验如何通过匹配特征多项式系数的方法，精确地将误差动态的极点配置到期望位置。这个基本练习旨在巩固观测器增益 $L$ 与误差收敛性能之间的核心联系，是后续更复杂设计的基础。[@problem_id:2729569]", "problem": "考虑一个连续时间线性时不变 (LTI) 系统，其状态空间实现由状态矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 2}$ 表征，具体如下：\n$$\nA=\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix}, \\quad C=\\begin{bmatrix}1  0\\end{bmatrix}.\n$$\n你需要仅使用该系统的状态方程和输出方程，以及观测器结构，来构建一个增益为 $L \\in \\mathbb{R}^{2 \\times 1}$ 的全阶 Luenberger 观测器。从观测器和估计误差的定义出发，推导误差自治动态。利用此结果，确定 $L$ 需满足的条件，使得误差动态具有等于以下形式的首一特征多项式：\n$$\ns^{2}+4 s+13.\n$$\n计算满足此要求的增益 $L \\in \\mathbb{R}^{2 \\times 1}$。以 $[l_1, l_2]$ 顺序的单个行矩阵形式给出你的最终答案。无需四舍五入，也无需单位。", "solution": "所给问题是线性控制理论中的一个标准练习，涉及 Luenberger 观测器的设计。与往常一样，第一步是严格验证问题陈述的有效性。\n\n**问题验证**\n\n已知条件如下：\n- 一个连续时间 LTI 系统模型。\n- 状态矩阵: $A=\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix} \\in \\mathbb{R}^{2 \\times 2}$。\n- 输出矩阵: $C=\\begin{bmatrix}1  0\\end{bmatrix} \\in \\mathbb{R}^{1 \\times 2}$。\n- 任务：设计一个全阶 Luenberger 观测器。\n- 观测器增益: $L \\in \\mathbb{R}^{2 \\times 1}$。\n- 期望的误差动态特征多项式: $p(s) = s^{2}+4s+13$。\n\n该问题在科学上基于状态估计和控制理论的原理。这是一个适定的问题，为求得唯一解提供了所有必要信息。观测器误差动态能够任意配置极点的一个关键先决条件是矩阵对 $(A, C)$ 的能观性。能观性矩阵由 $\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}$ 给出。我们计算该矩阵以验证此条件。\n$C = \\begin{bmatrix} 1  0 \\end{bmatrix}$。\n乘积 $CA$ 为：\n$CA = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\end{bmatrix}$。\n因此，能观性矩阵为：\n$$\n\\mathcal{O} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}\n$$\n$\\mathcal{O}$ 的秩为 $2$，等于状态空间的维数。因此，该系统是完全能观的，可以通过选择合适的增益矩阵 $L$ 来任意配置观测器误差动态的极点。问题有效。我们开始求解。\n\n**求解推导**\n\n系统动态由状态方程 $\\dot{x}(t) = Ax(t) + Bu(t)$ 和输出方程 $y(t) = Cx(t)$ 给出。为了一般性，我们包含了输入项 $Bu(t)$，尽管稍后会证明它与误差动态无关。\n\n全阶 Luenberger 观测器生成状态向量 $x(t)$ 的一个估计 $\\hat{x}(t)$。观测器的动态定义为：\n$$\n\\dot{\\hat{x}}(t) = A\\hat{x}(t) + Bu(t) + L(y(t) - \\hat{y}(t))\n$$\n其中 $\\hat{y}(t) = C\\hat{x}(t)$ 是估计输出，$L$ 是待确定的观测器增益矩阵。代入 $\\hat{y}(t)$ 和 $y(t)$，观测器方程变为：\n$$\n\\dot{\\hat{x}}(t) = A\\hat{x}(t) + Bu(t) + L(Cx(t) - C\\hat{x}(t))\n$$\n整理各项，我们得到：\n$$\n\\dot{\\hat{x}}(t) = (A - LC)\\hat{x}(t) + Bu(t) + LCx(t)\n$$\n估计误差定义为 $e(t) = x(t) - \\hat{x}(t)$。该误差的动态可以通过对 $e(t)$ 关于时间求导来得到：\n$$\n\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t)\n$$\n代入 $\\dot{x}(t)$ 和 $\\dot{\\hat{x}}(t)$ 的表达式：\n$$\n\\dot{e}(t) = (Ax(t) + Bu(t)) - ((A - LC)\\hat{x}(t) + Bu(t) + LCx(t))\n$$\n$$\n\\dot{e}(t) = Ax(t) + Bu(t) - A\\hat{x}(t) + LC\\hat{x}(t) - Bu(t) - LCx(t)\n$$\n输入项 $Bu(t)$ 相消，表明误差动态与系统输入无关。我们简化剩余的项：\n$$\n\\dot{e}(t) = A(x(t) - \\hat{x}(t)) - LC(x(t) - \\hat{x}(t))\n$$\n$$\n\\dot{e}(t) = (A - LC)e(t)\n$$\n这就是描述误差动态的自治线性系统。误差的稳定性和响应由矩阵 $A - LC$ 的特征值决定。这些特征值是特征多项式 $p(s) = \\det(sI - (A - LC))$ 的根。\n\n问题要求该特征多项式为 $s^2 + 4s + 13$。我们必须找到实现这一目标的增益矩阵 $L = \\begin{bmatrix} l_1 \\\\ l_2 \\end{bmatrix}$。首先，我们计算矩阵 $A - LC$：\n$$\nL C = \\begin{bmatrix} l_1 \\\\ l_2 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} l_1  0 \\\\ l_2  0 \\end{bmatrix}\n$$\n$$\nA - LC = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix} - \\begin{bmatrix} l_1  0 \\\\ l_2  0 \\end{bmatrix} = \\begin{bmatrix} -l_1  1 \\\\ -2-l_2  -3 \\end{bmatrix}\n$$\n接下来，我们计算特征多项式 $\\det(sI - (A - LC))$：\n$$\nsI - (A - LC) = s\\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\begin{bmatrix} -l_1  1 \\\\ -2-l_2  -3 \\end{bmatrix} = \\begin{bmatrix} s+l_1  -1 \\\\ 2+l_2  s+3 \\end{bmatrix}\n$$\n行列式为：\n$$\n\\det(sI - (A - LC)) = (s+l_1)(s+3) - (-1)(2+l_2)\n$$\n$$\n= s^2 + 3s + l_1s + 3l_1 + 2 + l_2\n$$\n$$\n= s^2 + (3+l_1)s + (3l_1 + l_2 + 2)\n$$\n我们将此多项式的系数与期望多项式 $s^2 + 4s + 13$ 的系数进行等同。\n$$\ns^2 + (3+l_1)s + (3l_1 + l_2 + 2) = s^2 + 4s + 13\n$$\n比较 $s$ 的同次幂系数：\n对于 $s^1$ 项：\n$$\n3 + l_1 = 4 \\implies l_1 = 1\n$$\n对于 $s^0$ 项 (常数项)：\n$$\n3l_1 + l_2 + 2 = 13\n$$\n将 $l_1 = 1$ 的值代入第二个方程：\n$$\n3(1) + l_2 + 2 = 13\n$$\n$$\n3 + l_2 + 2 = 13\n$$\n$$\nl_2 + 5 = 13 \\implies l_2 = 8\n$$\n所需的观测器增益矩阵为 $L = \\begin{bmatrix} 1 \\\\ 8 \\end{bmatrix}$。其分量为 $l_1=1$ 和 $l_2=8$。最终答案必须以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  8 \\end{pmatrix}}\n$$", "id": "2729569"}, {"introduction": "在掌握了基本的极点配置方法后，我们来探讨一个更深入的问题。仅仅配置特征值（极点）的位置有时并不能完全决定系统的动态行为，尤其是在存在重根的情况下。这个练习引入了与重根相关的约旦块（Jordan block）结构的概念，要求你不仅要配置极点，还要确保闭环系统矩阵具有特定的结构。通过解决这个问题，你将深入理解状态观测器设计与状态反馈控制器设计之间的对偶性（duality），并体会到系统结构在控制设计中的重要性。[@problem_id:2729578]", "problem": "考虑由状态空间对 $(A,C)$ 给出的连续时间线性时不变系统，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n1  0  2 \\\\\n0  1  1 \\\\\n-3  0  0\n\\end{pmatrix}, \n\\quad\nC \\;=\\; \\begin{pmatrix} 1  2  1 \\end{pmatrix}.\n$$\n一个全阶 Luenberger 观测器的估计误差动态为 $\\dot{e} = (A - L C)\\, e$，其中 $L \\in \\mathbb{R}^{3 \\times 1}$ 是观测器增益。从可观测性的核心定义、观测器增益设计与状态反馈极点配置之间的对偶性，以及友矩阵与最小多项式之间的关系出发，解决以下问题。\n\n1) 通过计算可观测性矩阵及其秩，判断对 $(A,C)$ 是否可观测。\n\n2) 期望的估计误差动态应具有位于 $-2$（代数重数为 $2$）和 $-5$（代数重数为 $1$）的特征值，并且在 $A - L C$ 的 Jordan 标准型中，通过一个大小为 $2$ 的单一 Jordan 块来实现位于 $-2$ 的重根。从第一性原理出发，论证对于一个可观测的单输出系统，通过输出注入是否可以实现这样的 Jordan 结构。\n\n3) 如果可实现，计算一个显式的实数观测器增益 $L \\in \\mathbb{R}^{3 \\times 1}$，使得 $A - L C$ 的特征多项式为\n$$\np_{\\mathrm{d}}(s) \\;=\\; (s+2)^{2}(s+5)\n$$\n并且以一个大小为 $2$ 的单一 Jordan 块实现特征值 $-2$。以包含 $L^{\\top}$ 各项的行向量 $(\\ell_{1},\\ell_{2},\\ell_{3})$ 的形式提供你的最终答案，各项为精确的有理数。不需要四舍五入，也不涉及单位。最终答案必须是单个行向量。", "solution": "该问题将按要求分三部分解决：可观测性验证、指定 Jordan 结构可实现性的论证，以及观测器增益 $L$ 的计算。\n\n### 第一部分：可观测性分析\n\n一个由对 $(A, C)$ 描述的线性时不变系统是可观测的，当且仅当其可观测性矩阵 $\\mathcal{O}$ 满秩，对于该系统即秩为 $3$。对于一个 $n$ 维系统，其可观测性矩阵由下式给出：\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix}\n$$\n在本例中，$n=3$，因此我们必须计算 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}$。给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n1  0  2 \\\\\n0  1  1 \\\\\n-3  0  0\n\\end{pmatrix}, \n\\quad\nC = \\begin{pmatrix} 1  2  1 \\end{pmatrix}\n$$\n首先，我们计算乘积 $CA$：\n$$\nCA = \\begin{pmatrix} 1  2  1 \\end{pmatrix} \\begin{pmatrix}\n1  0  2 \\\\\n0  1  1 \\\\\n-3  0  0\n\\end{pmatrix} = \\begin{pmatrix} 1-3  2  2+2 \\end{pmatrix} = \\begin{pmatrix} -2  2  4 \\end{pmatrix}\n$$\n接下来，我们计算 $A^2$，然后计算 $CA^2$：\n$$\nA^2 = A \\cdot A = \\begin{pmatrix}\n1  0  2 \\\\\n0  1  1 \\\\\n-3  0  0\n\\end{pmatrix} \\begin{pmatrix}\n1  0  2 \\\\\n0  1  1 \\\\\n-3  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n1-6  0  2 \\\\\n-3  1  1 \\\\\n-3  0  -6\n\\end{pmatrix} = \\begin{pmatrix}\n-5  0  2 \\\\\n-3  1  1 \\\\\n-3  0  -6\n\\end{pmatrix}\n$$\n$$\nCA^2 = \\begin{pmatrix} 1  2  1 \\end{pmatrix} \\begin{pmatrix}\n-5  0  2 \\\\\n-3  1  1 \\\\\n-3  0  -6\n\\end{pmatrix} = \\begin{pmatrix} -5-6-3  2  2+2-6 \\end{pmatrix} = \\begin{pmatrix} -14  2  -2 \\end{pmatrix}\n$$\n现在，我们构建可观测性矩阵 $\\mathcal{O}$：\n$$\n\\mathcal{O} = \\begin{pmatrix}\n1  2  1 \\\\\n-2  2  4 \\\\\n-14  2  -2\n\\end{pmatrix}\n$$\n为了确定秩，我们计算 $\\mathcal{O}$ 的行列式：\n$$\n\\det(\\mathcal{O}) = 1(2(-2) - 4(2)) - 2((-2)(-2) - 4(-14)) + 1((-2)(2) - 2(-14))\n$$\n$$\n\\det(\\mathcal{O}) = 1(-4 - 8) - 2(4 + 56) + 1(-4 + 28) = -12 - 2(60) + 24 = -12 - 120 + 24 = -108\n$$\n由于 $\\det(\\mathcal{O}) = -108 \\neq 0$，矩阵 $\\mathcal{O}$ 的秩为 $3$。由于状态维数是 $n=3$，该系统是完全可观测的。\n\n### 第二部分：Jordan 结构的可实现性\n\n为对 $(A, C)$ 设计观测器增益 $L$，与为对 $(A^\\top, C^\\top)$ 设计状态反馈控制器增益 $K$ 是对偶的。观测器误差矩阵 $A - LC$ 的特征值与其转置 $(A-LC)^\\top = A^\\top - C^\\top L^\\top$ 的特征值相同。\n令 $K = L^\\top$，这是一个 $1 \\times 3$ 的矩阵。问题就等价于为状态矩阵为 $F=A^\\top$、输入矩阵为 $G=C^\\top$ 的系统设计一个状态反馈增益 $K$，以将 $F-GK$ 的特征值配置在期望的位置。\n对偶系统由下式给出：\n$$\nA^\\top = \\begin{pmatrix} 1  0  -3 \\\\ 0  1  0 \\\\ 2  1  0 \\end{pmatrix}, \\quad C^\\top = \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n这是一个单输入系统，因为输入矩阵 $C^\\top$ 是一个列向量。$(A, C)$ 的可观测性意味着对偶对 $(A^\\top, C^\\top)$ 的可控性。\n线性控制理论中的一个基本结果（Wonham 极点配置定理）指出，对于一个可控的单输入系统，任何自共轭的极点集合都可以被配置。此外，对于单输入系统，闭环矩阵 $A^\\top - C^\\top K$ 的任何特征值 $\\lambda$ 的几何重数总是等于 $1$。几何重数是与 $\\lambda$ 相关联的线性无关特征向量的数量，它对应于该特征值的 Jordan 块的数量。\n问题要求特征值 $\\lambda = -2$ 的代数重数为 $2$，并以一个大小为 $2$ 的单一 Jordan 块实现。这对应于几何重数为 $1$。对于单输出系统（对偶于单输入系统），这不仅是一个可实现的条件，而且是一个强制性的条件。任何重根特征值都必须形成一个单一的 Jordan 块。因此，指定的 Jordan 结构是可实现的。\n\n### 第三部分：观测器增益 $L$ 的计算\n\n由于系统是可观测的，我们可以使用 Ackermann 公式进行观测器设计，以将 $A-LC$ 的极点配置在期望的位置。观测器增益 $L$ 的公式为：\n$$\nL = p_{\\mathrm{d}}(A) \\mathcal{O}^{-1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n其中 $p_{\\mathrm{d}}(s)$ 是期望的特征多项式。期望的特征值为 $-2$（重数为 $2$）和 $-5$。因此，期望的特征多项式为：\n$$\np_{\\mathrm{d}}(s) = (s+2)^2(s+5) = (s^2 + 4s + 4)(s+5) = s^3 + 9s^2 + 24s + 20\n$$\n我们需要计算矩阵多项式 $p_{\\mathrm{d}}(A) = A^3 + 9A^2 + 24A + 20I$。我们已经计算了 $A^2$。现在我们计算 $A^3$：\n$$\nA^3 = A^2 \\cdot A = \\begin{pmatrix} -5  0  2 \\\\ -3  1  1 \\\\ -3  0  -6 \\end{pmatrix} \\begin{pmatrix} 1  0  2 \\\\ 0  1  1 \\\\ -3  0  0 \\end{pmatrix} = \\begin{pmatrix} -11  0  -10 \\\\ -6  1  -5 \\\\ 15  0  -6 \\end{pmatrix}\n$$\n现在我们计算 $p_{\\mathrm{d}}(A)$：\n$$\np_{\\mathrm{d}}(A) = \\begin{pmatrix} -11  0  -10 \\\\ -6  1  -5 \\\\ 15  0  -6 \\end{pmatrix} + 9 \\begin{pmatrix} -5  0  2 \\\\ -3  1  1 \\\\ -3  0  -6 \\end{pmatrix} + 24 \\begin{pmatrix} 1  0  2 \\\\ 0  1  1 \\\\ -3  0  0 \\end{pmatrix} + 20 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\np_{\\mathrm{d}}(A) = \\begin{pmatrix} -11-45+24+20  0  -10+18+48 \\\\ -6-27  1+9+24+20  -5+9+24 \\\\ 15-27-72  0  -6-54+20 \\end{pmatrix} = \\begin{pmatrix} -12  0  56 \\\\ -33  54  28 \\\\ -84  0  -40 \\end{pmatrix}\n$$\n接下来，我们需要可观测性矩阵的逆 $\\mathcal{O}^{-1}$。利用 $\\det(\\mathcal{O}) = -108$：\n$$\n\\mathcal{O}^{-1} = \\frac{1}{\\det(\\mathcal{O})} \\text{adj}(\\mathcal{O}) = \\frac{1}{-108} \\begin{pmatrix}\n-12  6  6 \\\\\n-60  12  -6 \\\\\n24  -30  6\n\\end{pmatrix}\n$$\n项 $\\mathcal{O}^{-1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 就是 $\\mathcal{O}^{-1}$ 的最后一列：\n$$\n\\mathcal{O}^{-1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{-108} \\begin{pmatrix} 6 \\\\ -6 \\\\ 6 \\end{pmatrix} = \\frac{1}{-18} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n最后，我们计算 $L$：\n$$\nL = p_{\\mathrm{d}}(A) \\left( \\frac{1}{-18} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{-18} \\begin{pmatrix} -12  0  56 \\\\ -33  54  28 \\\\ -84  0  -40 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nL = \\frac{1}{-18} \\begin{pmatrix} -12(1) + 0(-1) + 56(1) \\\\ -33(1) + 54(-1) + 28(1) \\\\ -84(1) + 0(-1) - 40(1) \\end{pmatrix} = \\frac{1}{-18} \\begin{pmatrix} 44 \\\\ -59 \\\\ -124 \\end{pmatrix}\n$$\n$$\nL = \\begin{pmatrix} -44/18 \\\\ 59/18 \\\\ 124/18 \\end{pmatrix} = \\begin{pmatrix} -22/9 \\\\ 59/18 \\\\ 62/9 \\end{pmatrix}\n$$\n所需的观测器增益为 $L = \\begin{pmatrix} \\ell_1 \\\\ \\ell_2 \\\\ \\ell_3 \\end{pmatrix} = \\begin{pmatrix} -22/9 \\\\ 59/18 \\\\ 62/9 \\end{pmatrix}$。问题要求以行向量 $L^\\top = (\\ell_1, \\ell_2, \\ell_3)$ 的形式给出答案。\n$$\nL^\\top = \\begin{pmatrix} -\\frac{22}{9}  \\frac{59}{18}  \\frac{62}{9} \\end{pmatrix}\n$$", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{22}{9}  \\frac{59}{18}  \\frac{62}{9} \\end{pmatrix} } $$", "id": "2729578"}, {"introduction": "精确的极点配置是理论上的一个完美目标，但在工程实践中，我们更关心的是将系统极点置于复平面内的一个特定区域，以保证像阻尼比和调节时间这样的性能指标。这个高级练习将你的视野从“点”配置扩展到“区域”配置。你将学习如何设计观测器增益，以确保所有误差动态极点都位于一个预设的圆盘区域内，并运用线性矩阵不等式（LMI）和李雅普诺夫（Lyapunov）理论这一强大工具来验证设计是否满足约束。这项实践连接了经典的极点配置理论与现代鲁棒控制的设计思想。[@problem_id:2729577]", "problem": "考虑一个连续时间线性时不变系统，其状态矩阵为 $A \\in \\mathbb{R}^{n \\times n}$，输出矩阵为 $C \\in \\mathbb{R}^{p \\times n}$。对于一个 Luenberger 观测器，其估计误差动态由 $\\dot{e}(t) = \\left(A - L C\\right) e(t)$ 给出，其中 $L \\in \\mathbb{R}^{n \\times p}$ 是待设计的观测器增益。\n\n您的任务是设计一个观测器增益 $L$，使得 $A - L C$ 的所有特征值都严格位于复左半平面内一个预设的圆盘区域中，并使用作用于李雅普诺夫矩阵的线性矩阵不等式 (LMI) 来验证此圆盘约束。\n\n推导与验证的基础理论：\n- 根据 Luenberger 观测器的定义，估计误差动态矩阵为 $A - L C$。\n- 如果矩阵对 $\\left(A, C\\right)$ 是可观测的，那么根据与状态反馈设计的对偶性，通过适当地选择 $L$，可以任意配置 $A - L C$ 的特征值。\n- 对于任意具有实数中心 $c \\in \\mathbb{R}$ 和半径 $r \\in \\mathbb{R}_{0}$ 的圆盘区域 $\\mathcal{D}(c, r) = \\left\\{ s \\in \\mathbb{C} \\,:\\, \\left| s - c \\right|  r \\right\\}$，谱包含关系 $\\sigma\\!\\left(A - L C\\right) \\subset \\mathcal{D}(c, r)$ 等价于对仿射变换矩阵\n$$\nZ \\;=\\; \\frac{ \\left( A - L C \\right) - c I }{ r } .\n$$\n的谱半径条件 $\\rho\\!\\left(Z\\right)  1$。\n- 离散时间李雅普诺夫定理指出，$\\rho\\!\\left(Z\\right)  1$ 当且仅当存在一个对称正定矩阵 $P \\in \\mathbb{R}^{n \\times n}$，使得李雅普诺夫不等式\n$$\nZ^{\\mathsf{T}} P Z \\;-\\; P \\;\\prec\\; 0\n$$\n成立。这是一个关于未知矩阵 $P$ 的线性矩阵不等式 (LMI)。一种构造性的验证方法是求解离散李雅普诺夫方程\n$$\nZ^{\\mathsf{T}} P Z \\;-\\; P \\;=\\; -Q ,\n$$\n其中 $Q$ 是一个选定的对称正定矩阵，满足 $Q \\succ 0$（例如，$Q = I$）。当 $\\rho\\!\\left(Z\\right)  1$ 时，该方程的唯一解 $P$ 是对称正定的。\n\n设计要求：\n- 对于每个测试用例，您必须选择一组严格位于 $\\mathcal{D}(c, r)$ 内部的期望特征值 $\\left\\{ \\lambda_i \\right\\}_{i=1}^{n}$。\n- 利用与状态反馈的对偶性，通过将 $A - L C$ 的特征值配置在指定位置来计算 $L$。具体而言，为对偶对 $\\left( A^{\\mathsf{T}}, C^{\\mathsf{T}} \\right)$ 计算一个状态反馈增益 $K$，使得 $A^{\\mathsf{T}} - C^{\\mathsf{T}} K$ 的特征值为 $\\left\\{ \\lambda_i \\right\\}$，然后令 $L = K^{\\mathsf{T}}$。\n- 通过计算 $Z = \\left( \\left(A - L C\\right) - c I \\right) / r$ 并求解离散李雅普诺夫方程 $Z^{\\mathsf{T}} P Z - P = -I$ 来验证圆盘约束。当且仅当 $P \\succ 0$ 且 $Z^{\\mathsf{T}} P Z - P \\prec 0$（通过数值验证）时，判定为成功，这证明了 $\\rho\\!\\left(Z\\right)  1$，并因此证明了 $\\sigma\\!\\left(A - L C\\right) \\subset \\mathcal{D}(c, r)$。\n\n测试套件：\n对于每个测试用例，给定 $\\left( A, C, c, r, \\{\\lambda_i\\}_{i=1}^{n} \\right)$。\n\n- 测试用例 1：\n  - $A_1 = \\begin{bmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -6  -11  -6 \\end{bmatrix}$,\n    $C_1 = \\begin{bmatrix} 1  0  0 \\end{bmatrix}$,\n    $c_1 = -2.0$, $r_1 = 0.8$,\n    期望极点 $\\left\\{ \\lambda_i \\right\\}_1 = \\left\\{ -2.4,\\, -2 + 0.5 \\, \\mathrm{i},\\, -2 - 0.5 \\, \\mathrm{i} \\right\\}$。\n- 测试用例 2：\n  - $A_2 = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}$,\n    $C_2 = \\begin{bmatrix} 1  0 \\end{bmatrix}$,\n    $c_2 = -1.5$, $r_2 = 0.49$,\n    期望极点 $\\left\\{ \\lambda_i \\right\\}_2 = \\left\\{ -1.5 + 0.45 \\, \\mathrm{i},\\, -1.5 - 0.45 \\, \\mathrm{i} \\right\\}$。\n- 测试用例 3：\n  - $A_3 = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\\\ -24  -50  -35  -10 \\end{bmatrix}$,\n    $C_3 = \\begin{bmatrix} 1  0  0  0 \\end{bmatrix}$,\n    $c_3 = -3.0$, $r_3 = 1.2$,\n    期望极点 $\\left\\{ \\lambda_i \\right\\}_3 = \\left\\{ -3.2,\\, -2.1,\\, -3 + 1.1 \\, \\mathrm{i},\\, -3 - 1.1 \\, \\mathrm{i} \\right\\}$。\n- 测试用例 4：\n  - $A_4 = \\begin{bmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -0.75  -2.75  -3.0 \\end{bmatrix}$,\n    $C_4 = \\begin{bmatrix} 1  0  0 \\end{bmatrix}$,\n    $c_4 = -1.0$, $r_4 = 0.51$,\n    期望极点 $\\left\\{ \\lambda_i \\right\\}_4 = \\left\\{ -1.49,\\, -1 + 0.499 \\, \\mathrm{i},\\, -1 - 0.499 \\, \\mathrm{i} \\right\\}$。\n\n数值验证细节：\n- 对圆盘使用严格的内部检查，即要求 $\\max_i \\left| \\lambda_i \\left( A - L C \\right) - c \\right|  r$。\n- 对于 LMI 验证，求解离散李雅普诺夫方程 $Z^{\\mathsf{T}} P Z - P = -I$，并数值验证 $P$ 的最小特征值严格为正，以及 $Z^{\\mathsf{T}} P Z - P$ 的最大特征值严格为负。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的结果，格式为一个由方括号括起来的逗号分隔列表。每个条目必须是一个布尔值，指示该测试用例的极点配置和 LMI 验证是否均成功。例如，如果所有测试都成功，输出应如 $\\left[ \\mathrm{True}, \\mathrm{True}, \\mathrm{True}, \\mathrm{True} \\right]$。\n\n本问题不涉及物理单位或角度。所有计算都是无量纲的。唯一可接受的输出是如上所述的布尔值。程序不得读取任何输入；它必须计算此处定义的测试套件的结果，并打印所需的单行输出。", "solution": "问题要求为由状态和输出矩阵 $(A, C)$ 指定的线性时不变系统设计一个 Luenberger 观测器增益 $L$。设计目标是将观测器误差动态矩阵 $A_{cl} = A - LC$ 的所有特征值配置到复左半平面中一个预设的圆形区域 $\\mathcal{D}(c, r)$ 内，该区域定义为 $\\mathcal{D}(c, r) = \\{ s \\in \\mathbb{C} \\,:\\, |s - c|  r \\}$。此谱配置的验证必须使用基于李雅普诺夫的线性矩阵不等式 (LMI) 方法来执行。\n\n解决方法论主要分两个阶段进行：首先，通过极点配置设计观测器增益 $L$；其次，使用离散时间李雅普诺夫方程验证区域极点约束。\n\n**1. 通过对偶性和极点配置设计观测器增益**\n\n误差动态矩阵 $A - LC$ 的特征值与其转置 $(A - LC)^{\\mathsf{T}} = A^{\\mathsf{T}} - C^{\\mathsf{T}}L^{\\mathsf{T}}$ 的特征值相同。此公式揭示了其与标准状态反馈控制问题的结构等价性。具体来说，为系统 $(A, C)$ 设计观测器增益 $L$ 的问题，与为由矩阵对 $(A^{\\mathsf{T}}, C^{\\mathsf{T}})$ 描述的系统设计状态反馈控制器增益 $K$ 的问题是对偶的。\n\n令对偶系统由状态矩阵 $A' = A^{\\mathsf{T}}$ 和输入矩阵 $B' = C^{\\mathsf{T}}$ 定义。目标是找到一个反馈增益 $K$，使得闭环矩阵 $A' - B'K$ 的特征值位于一组期望位置 $\\{\\lambda_i\\}_{i=1}^n$。如果矩阵对 $(A', B')$ 是可控的，这等价于原始矩阵对 $(A, C)$ 是可观测的，那么这样的增益 $K$ 总是可以找到。对于所提供的单输出系统（$p=1$），对于给定的一组不同极点，这个增益 $K \\in \\mathbb{R}^{1 \\times n}$ 是唯一的。\n\n一旦计算出状态反馈增益 $K$，观测器增益 $L$ 就通过关系式 $L^{\\mathsf{T}} = K$ 或 $L = K^{\\mathsf{T}}$ 获得。对于单输出系统，其中 $C \\in \\mathbb{R}^{1 \\times n}$ 且 $L \\in \\mathbb{R}^{n \\times 1}$，对偶增益 $K$ 是一个行向量，$K \\in \\mathbb{R}^{1 \\times n}$，因此 $L$ 是一个列向量。$K$ 的计算是控制理论中的一个标准程序，通常使用像 Ackermann 公式或科学计算库中提供的更具数值鲁棒性的算法来完成。\n\n**2. 通过 LMI 进行区域极点配置验证**\n\n核心要求是验证设计出的误差矩阵谱 $\\sigma(A - LC)$ 严格位于圆盘 $\\mathcal{D}(c, r)$ 内部。这个条件 $\\sigma(A - LC) \\subset \\mathcal{D}(c, r)$ 可以转化为一个相关的离散时间系统的等价稳定性条件。\n\n令 $A_{cl} = A - LC$。极点区域约束要求对于每个特征值 $\\lambda \\in \\sigma(A_{cl})$，不等式 $|s - c|  r$ 成立。通过定义一个变换矩阵\n$$\nZ = \\frac{A_{cl} - cI}{r}\n$$\n区域极点约束等价于 $Z$ 的所有特征值都必须位于复平面的单位圆内。这等价于说 $Z$ 的谱半径 $\\rho(Z) = \\max_i |\\lambda_i(Z)|$ 必须严格小于 1。满足 $\\rho(Z)  1$ 的矩阵被称为舒尔（Schur）稳定。\n\n根据离散时间李雅普诺夫定理，一个矩阵 $Z$ 是舒尔稳定的，当且仅当存在一个对称正定矩阵 $P \\in \\mathbb{R}^{n \\times n}$ ($P=P^\\mathsf{T} \\succ 0$) 满足以下线性矩阵不等式 (LMI)：\n$$\nZ^{\\mathsf{T}} P Z - P \\prec 0\n$$\n其中 $\\prec 0$ 表示该矩阵是负定的。\n\n为了构造性地验证这个条件，我们可以求解离散时间李雅普诺夫方程：\n$$\nZ^{\\mathsf{T}} P Z - P = -Q\n$$\n其中 $Q \\succ 0$ 是一个选定的对称正定矩阵。一个常见且方便的选择是 $Q = I$，即单位矩阵。如果矩阵 $Z$ 确实是舒尔稳定的，该方程保证有唯一的、对称的、正定的解 $P$。\n\n因此，验证过程如下：\n1.  在计算 $L$ 并构成 $A_{cl} = A - LC$ 后，计算变换矩阵 $Z = r^{-1}(A_{cl} - cI)$。\n2.  求解离散李雅普诺夫方程 $Z^{\\mathsf{T}} P Z - P = -I$ 以找到矩阵 $P$。\n3.  检查所得矩阵 $P$ 是否为正定。这通常通过计算其特征值并确保它们都严格为正来完成。\n\n如果找到了一个正定解 $P$，它就作为一个凭证，证明 $\\rho(Z)  1$，这反过来又证明了观测器误差动态的所有特征值都严格包含在指定的圆盘 $\\mathcal{D}(c, r)$ 内。每个测试用例的成功结果要求在期望位置的数值极点配置成功，并且通过正定李雅普诺夫矩阵 $P$ 的基于 LMI 的验证也成功。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import place_poles\nfrom scipy.linalg import solve_discrete_lyapunov\n\ndef solve():\n    \"\"\"\n    Solves a series of observer design problems with LMI verification.\n\n    For each test case, an observer gain L is designed to place the poles of A-LC\n    at specified locations. The design is then verified to ensure poles lie\n    within a prescribed disk using a Lyapunov-based LMI approach.\n    \"\"\"\n    test_cases = [\n        {\n            \"A\": np.array([[0, 1, 0], [0, 0, 1], [-6, -11, -6]]),\n            \"C\": np.array([[1, 0, 0]]),\n            \"c\": -2.0,\n            \"r\": 0.8,\n            \"poles\": [-2.4, -2 + 0.5j, -2 - 0.5j],\n        },\n        {\n            \"A\": np.array([[0, 1], [-2, -3]]),\n            \"C\": np.array([[1, 0]]),\n            \"c\": -1.5,\n            \"r\": 0.49,\n            \"poles\": [-1.5 + 0.45j, -1.5 - 0.45j],\n        },\n        {\n            \"A\": np.array([[0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1], [-24, -50, -35, -10]]),\n            \"C\": np.array([[1, 0, 0, 0]]),\n            \"c\": -3.0,\n            \"r\": 1.2,\n            \"poles\": [-3.2, -2.1, -3 + 1.1j, -3 - 1.1j],\n        },\n        {\n            \"A\": np.array([[0, 1, 0], [0, 0, 1], [-0.75, -2.75, -3.0]]),\n            \"C\": np.array([[1, 0, 0]]),\n            \"c\": -1.0,\n            \"r\": 0.51,\n            \"poles\": [-1.49, -1 + 0.499j, -1 - 0.499j],\n        },\n    ]\n\n    results = []\n    \n    # Numerical tolerance for floating point comparisons\n    TOL = 1e-9\n\n    for case in test_cases:\n        A, C, c, r, desired_poles = case[\"A\"], case[\"C\"], case[\"c\"], case[\"r\"], case[\"poles\"]\n        n = A.shape[0]\n\n        try:\n            # Step 1: Design L using duality and pole placement\n            # The dual system is (A.T, C.T)\n            A_dual = A.T\n            B_dual = C.T\n\n            # `place_poles` finds K such that A_dual - B_dual @ K has desired poles\n            placement_result = place_poles(A_dual, B_dual, desired_poles)\n            K = placement_result.gain_matrix\n\n            # The observer gain L is the transpose of the dual feedback gain K\n            L = K.T\n\n            # Step 2: Form the observer error dynamics matrix A_cl = A - L*C\n            A_cl = A - L @ C\n\n            # Step 3: Verify Pole Placement\n            # Check if the actual eigenvalues are close to the desired ones.\n            # Sort complex numbers by real part, then imaginary part for consistent comparison.\n            actual_poles = np.linalg.eigvals(A_cl)\n            sorted_actual = sorted(actual_poles, key=lambda x: (x.real, x.imag))\n            sorted_desired = sorted(desired_poles, key=lambda x: (x.real, x.imag))\n            pole_placement_ok = np.allclose(sorted_actual, sorted_desired, atol=TOL)\n\n            # Also perform the strict interior check as requested\n            disk_constraint_ok = np.max(np.abs(actual_poles - c))  r\n\n            # Step 4: Verify Regional Constraint via LMI\n            # Form the transformed matrix Z\n            Z = (A_cl - c * np.eye(n)) / r\n\n            # Solve the discrete Lyapunov equation Z.T * P * Z - P = -I\n            # scipy.linalg.solve_discrete_lyapunov solves A*X*A.H - X = -Q\n            # We map our equation by setting A -> Z.T, X -> P, Q -> I\n            P = solve_discrete_lyapunov(Z.T, np.eye(n))\n\n            # LMI Check 1: Verify P is positive definite\n            # For a symmetric matrix, positive definiteness means all eigenvalues are positive.\n            eigvals_P = np.linalg.eigvalsh(P)\n            P_is_pd = np.min(eigvals_P) > TOL\n\n            # LMI Check 2: Numerically verify Z.T*P*Z - P is negative definite\n            # The result should be very close to -I\n            LMI_matrix = Z.T @ P @ Z - P\n            eigvals_LMI = np.linalg.eigvalsh(LMI_matrix)\n            LMI_is_nd = np.max(eigvals_LMI)  -TOL\n\n            # The overall test case succeeds if pole placement was accurate\n            # and the LMI verification (P > 0) passes.\n            # disk_constraint_ok and LMI_is_nd are redundant checks if theory holds\n            # and numerical precision is perfect, but are included for robustness.\n            success = pole_placement_ok and disk_constraint_ok and P_is_pd and LMI_is_nd\n            results.append(success)\n\n        except Exception:\n            # Any failure in the process (e.g., pole placement, Lyapunov solver)\n            # means the test case fails.\n            results.append(False)\n\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\nsolve()\n```", "id": "2729577"}]}