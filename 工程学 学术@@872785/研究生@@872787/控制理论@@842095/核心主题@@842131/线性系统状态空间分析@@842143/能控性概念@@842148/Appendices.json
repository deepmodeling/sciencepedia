{"hands_on_practices": [{"introduction": "要判断一个线性系统是否可控，我们首先想到的工具就是卡尔曼（Kalman）秩条件。该测试通过构建可控性矩阵来实现，该矩阵的列向量张成了从原点出发所有可达状态的集合。通过计算该矩阵的秩，我们可以明确地确定可达子空间的维度，从而判断系统是否完全可控。[@problem_id:2694383]", "problem": "考虑一个由微分方程 $\\dot{x}(t)=A x(t)+B u(t)$ 定义的连续时间线性时不变 (LTI) 状态空间系统，其中 $x(t) \\in \\mathbb{R}^{2}$ 且 $u(t) \\in \\mathbb{R}$。令\n$$\nA=\\begin{bmatrix}1  0 \\\\ 0  2\\end{bmatrix}, \\quad B=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}.\n$$\n使用能控性的定义（即任何状态都可以通过某个容许输入在有限时间内从原点到达的性质），以及关于由 $A$ 对 $B$ 的重复作用生成的子空间的标准线性代数知识，来显式地构造可达子空间的一个基。根据此构造，组建能控性矩阵 $C$ 来张成该子空间，并通过计算 $C$ 的秩来确定系统是否能控。将 $C$ 的秩值 $r$ 作为最终答案报告。无需四舍五入，也不涉及单位。你的最终答案必须是一个实数。", "solution": "所考虑的系统是一个连续时间线性时不变 (LTI) 系统，由状态空间方程 $\\dot{x}(t) = A x(t) + B u(t)$ 描述。状态向量 $x(t)$ 在 $\\mathbb{R}^{2}$ 中，这意味着状态空间的维度是 $n=2$。输入 $u(t)$ 是一个标量， $u(t) \\in \\mathbb{R}$。系统矩阵如下所示：\n$$\nA = \\begin{bmatrix} 1  0 \\\\ 0  2 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n问题要求我们确定系统的能控性。控制理论中的一个基本结果，即卡尔曼秩条件，指出，一个LTI系统是完全状态能控的，当且仅当其能控性矩阵具有满秩，即 $\\text{rank}(C) = n$。\n\n问题引导我们首先构造可达子空间的一个基。可达子空间 $\\mathcal{R}$ 是所有可以从原点在有限时间内到达的状态的集合。对于一个 LTI 系统，该子空间由能控性矩阵的列向量张成。该子空间也被描述为包含 $B$ 的像（记作 $\\text{Im}(B)$）的最小 $A$-不变子空间。它由通过对 $B$ 的列向量重复应用 $A$ 所生成的向量的张成空间给出：\n$$\n\\mathcal{R} = \\text{span}\\{B, AB, A^2B, \\dots, A^{n-1}B\\}\n$$\n对于这个问题，状态空间的维度是 $n=2$。因此，可达子空间由 $B$ 和 $AB$ 的列向量张成。让我们来计算这些向量。\n\n第一个向量是矩阵 $B$ 的列：\n$$\nv_1 = B = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n第二个向量是通过将状态矩阵 $A$ 应用于向量 $v_1$ 得到的：\n$$\nv_2 = AB = \\begin{bmatrix} 1  0 \\\\ 0  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} (1)(1) + (0)(1) \\\\ (0)(1) + (2)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\n$$\n因此，可达子空间 $\\mathcal{R}$ 是 $\\text{span}\\{v_1, v_2\\} = \\text{span}\\left\\{ \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}, \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} \\right\\}$。\n\n为了构成这个子空间的一个基，我们必须验证向量 $v_1$ 和 $v_2$ 是线性无关的。我们检查是否存在一个非零标量 $k$ 使得 $v_2 = k v_1$。\n$$\n\\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} = k \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n这个向量方程产生一个包含两个线性方程的方程组：\n$1 = k \\cdot 1 \\implies k=1$\n$2 = k \\cdot 1 \\implies k=2$\n要求 $k=1$ 和 $k=2$ 同时成立是一个矛盾。因此，向量 $v_1$ 和 $v_2$ 是线性无关的。由于我们在二维空间 $\\mathbb{R}^2$ 中有一组两个线性无关的向量，它们构成了 $\\mathbb{R}^2$ 的一个基。这意味着可达子空间是整个状态空间，即 $\\mathcal{R} = \\mathbb{R}^2$。\n\n能控性矩阵 $C$ 是通过拼接这些基向量来构造的：\n$$\nC = \\begin{bmatrix} B  AB \\end{bmatrix} = \\begin{bmatrix} v_1  v_2 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 1  2 \\end{bmatrix}\n$$\n最后的任务是确定 $C$ 的秩，我们记为 $r$。矩阵的秩是其列向量所张成的空间的维度。正如我们已经确定的，$2 \\times 2$ 矩阵 $C$ 的两个列向量是线性无关的，所以 $C$ 的秩必须是 $2$。\n\n确定方阵秩的另一种方法是计算其行列式。一个矩阵具有满秩，当且仅当其行列式不为零。\n$$\n\\det(C) = \\det\\left(\\begin{bmatrix} 1  1 \\\\ 1  2 \\end{bmatrix}\\right) = (1)(2) - (1)(1) = 2 - 1 = 1\n$$\n因为 $\\det(C) = 1 \\neq 0$，所以矩阵 $C$ 是满秩的。$C$ 的秩为 $r=2$。因为能控性矩阵的秩 ($r=2$) 等于状态空间的维度 ($n=2$)，所以该系统是完全能控的。问题要求的是秩值 $r$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2694383"}, {"introduction": "卡尔曼秩条件告诉我们一个系统是否可控，而波波夫-别列维奇-霍特斯（Popov-Belevitch-Hautus, PBH）测试则为我们揭示了其背后的深层原因。该频域判据将可控性与系统的特征结构联系起来，揭示了不可控性源于输入无法影响系统的一个或多个动态模态。此练习将运用PBH测试的基本原理——即左特征向量与输入矩阵之间的正交性——来诊断不可控的模态。[@problem_id:2694430]", "problem": "考虑由矩阵对 $\\left(A,B\\right)$ 定义的线性时不变状态空间系统，其中\n$$\nA=\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix},\\quad B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix}.\n$$\n从线性时不变系统 $\\dot{x}=Ax+Bu$ 的能控性定义出发，并使用作为 Popov–Belevitch–Hautus (PBH) 检验基础的基于特征结构的判据，确定矩阵对 $\\left(A,B\\right)$ 的能控子空间的维数。将最终答案表示为一个不带单位的整数。", "solution": "对于一个 LTI 系统，能控性的概念关系到外部输入 $u(t)$ 是否有能力在有限时间内将内部状态 $x(t)$ 从任意初始状态转移到任意最终状态。能控子空间是所有可从原点到达的状态的集合。其维数衡量了这种能控性的程度。\n\nPopov–Belevitch–Hautus (PBH) 检验提供了一个基于系统特征结构的能控性判据。一个系统是完全能控的，当且仅当对于矩阵 $A$ 的每一个特征值 $\\lambda$，矩阵 $[A - \\lambda I, B]$ 的秩等于状态空间的维数 $n$。\n\n本题要求使用该检验所依据的基本判据。该判据指出，一个 LTI 系统是不能控的，当且仅当存在一个矩阵 $A$ 的左特征向量，它与矩阵 $B$ 的所有列向量正交。对应于特征值 $\\lambda$ 的左特征向量 $v$ 满足关系式 $v^H A = \\lambda v^H$，其中 $v^H$ 是 $v$ 的共轭转置。对于实矩阵，这简化为 $v^T A = \\lambda v^T$，等价于 $A^T v = \\lambda v$。与 $\\lambda$ 相关的不能控模态存在的充要条件是，存在一个非零向量 $v$，使得 $A^T v = \\lambda v$ 且 $v^T B = 0$。\n\n能控子空间的维数是 $n - k$，其中 $n$ 是状态空间的维数，$k$ 是与 $B$ 的列向量正交的 $A$ 的线性无关左特征向量的数量。\n\n首先，我们确定状态空间的维数。状态矩阵 $A$ 是一个 $2 \\times 2$ 矩阵，因此状态维数为 $n=2$。\n\n接下来，我们求解矩阵 $A$ 的特征值。特征方程为 $\\det(A - \\lambda I) = 0$。\n$$\n\\det\\left(\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix} - \\lambda\\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}\\right) = \\det\\begin{bmatrix}-\\lambda  1\\\\ -2  -3-\\lambda\\end{bmatrix} = 0\n$$\n$$\n(-\\lambda)(-3-\\lambda) - (1)(-2) = 0\n$$\n$$\n\\lambda^2 + 3\\lambda + 2 = 0\n$$\n对这个二次方程进行因式分解得到：\n$$\n(\\lambda+1)(\\lambda+2) = 0\n$$\n$A$ 的特征值为 $\\lambda_1 = -1$ 和 $\\lambda_2 = -2$。\n\n现在，我们必须为每个特征值找到对应的左特征向量。特征值 $\\lambda$ 的左特征向量 $v$ 是 $A^T$ 对应于相同特征值 $\\lambda$ 的特征向量。$A$ 的转置是：\n$$\nA^T = \\begin{bmatrix}0  -2\\\\ 1  -3\\end{bmatrix}\n$$\n\n对于 $\\lambda_1 = -1$，我们寻找一个向量 $v_1$ 使得 $(A^T - \\lambda_1 I)v_1 = 0$：\n$$\n(A^T + 1 \\cdot I)v_1 = \\begin{bmatrix}0+1  -2\\\\ 1  -3+1\\end{bmatrix}\\begin{bmatrix}v_{11}\\\\ v_{12}\\end{bmatrix} = \\begin{bmatrix}1  -2\\\\ 1  -2\\end{bmatrix}\\begin{bmatrix}v_{11}\\\\ v_{12}\\end{bmatrix} = \\begin{bmatrix}0\\\\ 0\\end{bmatrix}\n$$\n这得到方程 $v_{11} - 2v_{12} = 0$，即 $v_{11} = 2v_{12}$。一个代表性的左特征向量是 $v_1 = \\begin{bmatrix}2\\\\ 1\\end{bmatrix}$。\n\n对于 $\\lambda_2 = -2$，我们寻找一个向量 $v_2$ 使得 $(A^T - \\lambda_2 I)v_2 = 0$：\n$$\n(A^T + 2 \\cdot I)v_2 = \\begin{bmatrix}0+2  -2\\\\ 1  -3+2\\end{bmatrix}\\begin{bmatrix}v_{21}\\\\ v_{22}\\end{bmatrix} = \\begin{bmatrix}2  -2\\\\ 1  -1\\end{bmatrix}\\begin{bmatrix}v_{21}\\\\ v_{22}\\end{bmatrix} = \\begin{bmatrix}0\\\\ 0\\end{bmatrix}\n$$\n这得到方程 $v_{21} - v_{22} = 0$，即 $v_{21} = v_{22}$。一个代表性的左特征向量是 $v_2 = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$。\n\n下一步是为每个左特征向量检验其正交条件 $v^T B = 0$。输入矩阵是 $B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix}$。\n\n对于 $v_1 = \\begin{bmatrix}2\\\\ 1\\end{bmatrix}$：\n$$\nv_1^T B = \\begin{bmatrix}2  1\\end{bmatrix}\\begin{bmatrix}1\\\\ 0\\end{bmatrix} = (2)(1) + (1)(0) = 2\n$$\n因为 $v_1^T B \\neq 0$，所以与特征值 $\\lambda_1 = -1$ 相关的模态是能控的。\n\n对于 $v_2 = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$：\n$$\nv_2^T B = \\begin{bmatrix}1  1\\end{bmatrix}\\begin{bmatrix}1\\\\ 0\\end{bmatrix} = (1)(1) + (1)(0) = 1\n$$\n因为 $v_2^T B \\neq 0$，所以与特征值 $\\lambda_2 = -2$ 相关的模态是能控的。\n\n$A$ 的两个左特征向量都与输入矩阵 $B$ 不正交。因此，不存在不能控的模态。不能控子空间的维数是 $k=0$。\n\n能控子空间的维数是 $n - k = 2 - 0 = 2$。这意味着系统是完全能控的，并且能控子空间张成了整个状态空间 $\\mathbb{R}^2$。", "answer": "$$\\boxed{2}$$", "id": "2694430"}, {"introduction": "可控性不仅是一个分析性质，它也是控制器综合（synthesis）的基本前提。对于一个完全可控的系统，我们总能找到一个状态变换，将其转换为一种称为“可控性标准型”（Controllability Canonical Form）的标准化结构。这种形式对于设计状态反馈控制器（例如通过极点配置）非常有用，使该变换成为连接理论与实践的关键桥梁。[@problem_id:2694418]", "problem": "考虑连续时间线性时不变 (LTI) 系统 $\\dot{x} = A x + B u$，其状态维度为 $n = 3$，单输入为 $m = 1$，其中\n$$\nA = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n-1  -2  -3\n\\end{pmatrix},\n\\quad\nB = \\begin{pmatrix}\n0 \\\\\n1 \\\\\n1\n\\end{pmatrix}.\n$$\n仅从核心定义（即可控性、可控性矩阵和可达子空间）出发，并且不使用任何现成的变换公式，完成以下操作：\n\n1. 使用由输入向量生成的可控性链的概念，构造一个相似变换 $T \\in \\mathbb{R}^{3 \\times 3}$ 和一个输入变换 $U \\in \\mathbb{R}$，将可控对 $(A,B)$ 转换为可控性规范（可控伴随）形式，并将输入置于第一个状态，即转换为一对 $(\\bar{A},\\bar{B})$，其中\n$$\n\\bar{B} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix},\n\\qquad\n\\bar{A} = \\begin{pmatrix}\n0  0  \\star \\\\\n1  0  \\star \\\\\n0  1  \\star\n\\end{pmatrix},\n$$\n其中 $\\star$ 项由您根据第一性原理的构建过程确定。\n\n2. 通过直接乘法验证您的构造，即证明 $T^{-1} A T = \\bar{A}$ 和 $T^{-1} B U = \\bar{B}$。\n\n3. 报告 $\\det(T)$ 的精确值。\n\n将最终答案表示为 $\\det(T)$ 的精确整数值。无需四舍五入，不涉及单位。最终答案必须是单个实数。", "solution": "进行此变换的一个先决条件是系统必须是可控的。可控性通过可控性矩阵 $\\mathcal{C} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix}$ 的秩来评估。\n我们计算 $\\mathcal{C}$ 的列向量：\n$$\nB = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nAB = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -1  -2  -3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -5 \\end{pmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -1  -2  -3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -5 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -5 \\\\ -1 - 2 + 15 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -5 \\\\ 12 \\end{pmatrix}\n$$\n因此，可控性矩阵为：\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  1  1 \\\\ 1  1  -5 \\\\ 1  -5  12 \\end{pmatrix}\n$$\n$\\mathcal{C}$ 的行列式为：\n$$\n\\det(\\mathcal{C}) = 0 \\cdot (12 - 25) - 1 \\cdot (12 - (-5)) + 1 \\cdot (-5 - 1) = -1(17) + 1(-6) = -23\n$$\n由于 $\\det(\\mathcal{C}) = -23 \\neq 0$，该矩阵满秩 $n=3$，因此系统是可控的。\n\n问题要求基于“由输入向量生成的可控性链”进行构建。这是一个直接的指令，要求使用向量 $B, AB, A^2B, \\dots$ 来构成变换的基。最直接的解释是使用这些向量作为其列来构建变换矩阵 $T$。设 $T$ 的列为 $t_1, t_2, t_3$。\n$$\nT = \\begin{pmatrix} t_1  t_2  t_3 \\end{pmatrix} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix} = \\mathcal{C}\n$$\n因此，我们将相似变换矩阵定义为：\n$$\nT = \\begin{pmatrix} 0  1  1 \\\\ 1  1  -5 \\\\ 1  -5  12 \\end{pmatrix}\n$$\n变换关系为 $\\bar{A} = T^{-1}AT$ 和 $\\bar{B} = T^{-1}BU$。在 $T$ 已固定的情况下，我们确定输入变换 $U$。关系式为 $\\bar{B} = T^{-1}BU$，目标是 $\\bar{B} = e_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$$\ne_1 = \\mathcal{C}^{-1}BU\n$$\n根据可控性矩阵 $\\mathcal{C}$ 的构造方式，其第一列就是 $B$。因此，$\\mathcal{C}e_1 = B$。从左侧乘以 $\\mathcal{C}^{-1}$ 可得 $\\mathcal{C}^{-1}B = e_1$。\n将此代入关于 $U$ 的方程可得：\n$$\ne_1 = (e_1)U\n$$\n由于 $U$ 是一个标量 ($m=1$)，这直接意味着 $U=1$。\n\n现在，我们验证该变换并确定 $\\bar{A}$ 中的未知项。\n变换后的状态矩阵为 $\\bar{A} = T^{-1}AT = \\mathcal{C}^{-1}A\\mathcal{C}$。\n我们有：\n$$\nA\\mathcal{C} = A \\begin{pmatrix} B  AB  A^2B \\end{pmatrix} = \\begin{pmatrix} AB  A^2B  A^3B \\end{pmatrix}\n$$\n为了求得 $A^3B$，我们使用凯莱-哈密顿定理 (Cayley-Hamilton theorem)。$A$ 的特征多项式是 $p_A(\\lambda)=\\det(\\lambda I - A)$。\n$$\np_A(\\lambda) = \\det \\begin{pmatrix} \\lambda  -1  0 \\\\ 0  \\lambda  -1 \\\\ 1  2  \\lambda+3 \\end{pmatrix} = \\lambda(\\lambda(\\lambda+3) - (-2)) - (-1)(0 - (-1)) = \\lambda(\\lambda^2+3\\lambda+2) - 1\n$$\n$$\np_A(\\lambda) = \\lambda^3 + 3\\lambda^2 + 2\\lambda - 1\n$$\n根据凯莱-哈密顿定理，$p_A(A) = 0$，所以 $A^3 + 3A^2 + 2A - I = 0$，这意味着 $A^3 = -3A^2 - 2A + I$。\n将此应用于 $B$：\n$$\nA^3B = (-3A^2 - 2A + I)B = -3A^2B - 2AB + B\n$$\n我们可以用 $\\mathcal{C}$ 的列向量来表示 $A\\mathcal{C}$：\n$$\nA\\mathcal{C} = \\begin{pmatrix} AB  A^2B  B - 2AB - 3A^2B \\end{pmatrix} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 1  0  -2 \\\\ 0  1  -3 \\end{pmatrix}\n$$\n这表明 $A\\mathcal{C} = \\mathcal{C} \\bar{A}_{computed}$，其中\n$$\n\\bar{A}_{computed} = \\begin{pmatrix} 0  0  1 \\\\ 1  0  -2 \\\\ 0  1  -3 \\end{pmatrix}\n$$\n从左侧乘以 $\\mathcal{C}^{-1}$ 可得 $\\bar{A} = \\mathcal{C}^{-1}A\\mathcal{C} = \\bar{A}_{computed}$。该矩阵完全符合所要求的结构 $\\bar{A} = \\begin{pmatrix} 0  0  \\star \\\\ 1  0  \\star \\\\ 0  1  \\star \\end{pmatrix}$，其中星号项被确定为 $1, -2, -3$。\n因此，该构造得到验证。\n\n最后一步是报告变换矩阵 $T$ 的行列式。\n$$\n\\det(T) = \\det(\\mathcal{C}) = -23\n$$\n这是一个符合要求的精确整数值。", "answer": "$$\\boxed{-23}$$", "id": "2694418"}]}