{"hands_on_practices": [{"introduction": "要真正理解不可观测子空间，我们必须回到它的核心定义：包含在输出矩阵 $C$ 的核空间 $\\ker C$ 内的最大 $A$-不变子空间。该练习 [@problem_id:2756462] 将引导您通过一个分步迭代过程，从第一性原理出发计算这个子空间。通过亲手实践，您将对这一基本理论概念的构造方式建立起具体而深刻的认识。", "problem": "考虑一个连续时间线性时不变（LTI）系统，其状态方程为 $\\dot{x} = A x$，输出方程为 $y = C x$，其中 $x \\in \\mathbb{R}^{4}$，$y \\in \\mathbb{R}$，且\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0  0\\\\\n0  0  0  0\\\\\n0  0  0  1\\\\\n0  0  0  0\n\\end{pmatrix}, \n\\qquad\nC \\;=\\; \\begin{pmatrix}\n1  0  1  0\n\\end{pmatrix}.\n$$\n仅使用可观测性和 $A$-不变性的核心定义，显式计算不可观测子空间 $\\mathcal{N}_{o}$ 的一组基。$\\mathcal{N}_{o}$ 定义为包含在 $\\ker C$ 中的最大 $A$-不变子空间。您必须从第一性原理出发，论证每一步，并展示收敛到 $\\ker C$ 内最大 $A$-不变子空间的逻辑迭代过程。\n\n最后，将 $\\mathcal{N}_{o}$ 的维数作为您的答案。您的最终答案必须是一个实数值。不需要四舍五入，也不涉及单位。", "solution": "用户提供了一个需要验证的问题陈述。\n\n**第一步：提取已知条件**\n-   系统模型：连续时间线性时不变（LTI）系统，状态方程为 $\\dot{x} = A x$，输出方程为 $y = C x$。\n-   状态向量：$x \\in \\mathbb{R}^{4}$。\n-   输出向量：$y \\in \\mathbb{R}$。\n-   状态矩阵：$A = \\begin{pmatrix} 0  1  0  0\\\\ 0  0  0  0\\\\ 0  0  0  1\\\\ 0  0  0  0 \\end{pmatrix}$。\n-   输出矩阵：$C = \\begin{pmatrix} 1  0  1  0 \\end{pmatrix}$。\n-   不可观测子空间 $\\mathcal{N}_{o}$ 的定义：包含在 $\\ker C$ 中的最大 $A$-不变子空间。\n-   任务：使用第一性原理计算 $\\mathcal{N}_{o}$ 的一组基，并说明其维数。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学性：** 该问题是线性控制理论中的一个标准练习，涉及可观测性的基本概念。对于一个 LTI 系统，其定义和矩阵在数学上和物理上都是合理的。\n-   **适定性：** 该问题是适定的。任务是找到一个特定的子空间，线性系统理论保证了其存在性和唯一性。所提供的数据（$A$ 和 $C$ 矩阵）足以确定该子空间。\n-   **客观性：** 问题以精确、客观的数学语言陈述，没有任何主观或含糊的说法。\n-   **完整性和一致性：** 该问题是自洽且内部一致的。它提供了所有必要的矩阵和定义。\n-   **可行性：** 所需的计算是标准的线性代数运算，完全可行。\n\n**第三步：结论与行动**\n该问题是 **有效的**。将提供解答。\n\n该问题要求计算给定 LTI 系统的不可观测子空间 $\\mathcal{N}_{o}$。根据定义，$\\mathcal{N}_{o}$ 是状态空间 $\\mathbb{R}^{4}$ 的最大子空间 $\\mathcal{V}$，满足 $\\mathcal{V}$ 包含在 $C$ 的零空间中（$\\mathcal{V} \\subseteq \\ker C$）且 $\\mathcal{V}$ 是 $A$-不变的（$A\\mathcal{V} \\subseteq \\mathcal{V}$）。\n\n我们将使用从第一性原理推导出的迭代算法来找到这个子空间。该算法以最大的可能候选子空间进行初始化，并迭代地进行优化，直到满足 $A$-不变性为止。\n\n该算法流程如下：\n1.  用子空间 $\\mathcal{V}_0 = \\ker C$ 初始化。\n2.  使用关系 $\\mathcal{V}_{k+1} = \\mathcal{V}_k \\cap \\{x \\in \\mathbb{R}^4 \\mid Ax \\in \\mathcal{V}_k\\}$ 进行迭代。\n子空间序列 $\\mathcal{V}_0 \\supseteq \\mathcal{V}_1 \\supseteq \\mathcal{V}_2 \\supseteq \\dots$ 保证在有限步内收敛到包含在 $\\ker C$ 中的最大 $A$-不变子空间。\n\n**第一步：初始化**\n首先，我们计算初始子空间 $\\mathcal{V}_0 = \\ker C$。如果 $Cx = 0$，则向量 $x = \\begin{pmatrix} x_1  x_2  x_3  x_4 \\end{pmatrix}^T$ 属于 $\\ker C$。\n$$\nCx = \\begin{pmatrix} 1  0  1  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = x_1 + x_3 = 0\n$$\n该条件意味着 $x_1 = -x_3$。$\\ker C$ 中的一个一般向量可以写为：\n$$\nx = \\begin{pmatrix} -x_3 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = x_2 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} + x_3 \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix} + x_4 \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n因此，$\\mathcal{V}_0 = \\ker C$ 的一组基由以下向量集合给出：\n$$\n\\left\\{ \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}\n$$\n$\\mathcal{V}_0$ 的维数是 $3$。\n\n**第二步：第一次迭代**\n我们计算 $\\mathcal{V}_1 = \\mathcalV_0 \\cap \\{x \\mid Ax \\in \\mathcal{V}_0\\}$。这是 $x \\in \\mathcal{V}_0$ 且 $Ax$ 也在 $\\mathcal{V}_0$ 中的向量构成的子空间。\n设 $x \\in \\mathcal{V}_0$。我们已经知道其分量满足 $x_1 + x_3 = 0$。现在我们施加额外条件 $Ax \\in \\mathcal{V}_0$。\n首先，计算 $Ax$：\n$$\nAx = \\begin{pmatrix} 0  1  0  0\\\\ 0  0  0  0\\\\ 0  0  0  1\\\\ 0  0  0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = \\begin{pmatrix} x_2 \\\\ 0 \\\\ x_4 \\\\ 0 \\end{pmatrix}\n$$\n要使 $Ax$ 属于 $\\mathcal{V}_0 = \\ker C$，其分量必须满足 $\\ker C$ 的条件。设 $z = Ax$。条件是 $z_1 + z_3 = 0$，即 $x_2 + x_4 = 0$。\n所以，$\\mathcal{V}_1$ 中的向量必须满足两个条件：\n1.  $x_1 + x_3 = 0$ (因为 $x \\in \\mathcal{V}_0$)\n2.  $x_2 + x_4 = 0$ (为了使 $Ax \\in \\mathcal{V}_0$)\n$\\mathcal{V}_1$ 中的一个一般向量 $x$ 具有 $x_3 = -x_1$ 和 $x_4 = -x_2$ 的形式。\n$$\nx = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ -x_1 \\\\ -x_2 \\end{pmatrix} = x_1 \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix} + x_2 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$\\mathcal{V}_1$ 的一组基是：\n$$\n\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\right\\}\n$$\n$\\mathcal{V}_1$ 的维数是 $2$。由于 $\\mathcal{V}_1$ 是 $\\mathcal{V}_0$ 的一个真子空间，算法尚未收敛。\n\n**第三步：第二次迭代**\n我们计算 $\\mathcal{V}_2 = \\mathcal{V}_1 \\cap \\{x \\mid Ax \\in \\mathcal{V}_1\\}$。这是 $x \\in \\mathcal{V}_1$ 且 $Ax$ 也在 $\\mathcal{V}_1$ 中的向量构成的子空间。\n设 $x \\in \\mathcal{V}_1$。其分量满足 $x_1 + x_3 = 0$ 和 $x_2 + x_4 = 0$。\n我们检查 $Ax$ 是否属于 $\\mathcal{V}_1$。\n$$\nAx = \\begin{pmatrix} x_2 \\\\ 0 \\\\ x_4 \\\\ 0 \\end{pmatrix}\n$$\n要使 $Ax$ 属于 $\\mathcal{V}_1$，其分量（我们称之为 $z_i$）必须满足 $\\mathcal{V}_1$ 的两个条件：\n1.  $z_1 + z_3 = 0 \\implies x_2 + x_4 = 0$。根据定义，对于任何 $x \\in \\mathcal{V}_1$ 该条件都成立。\n2.  $z_2 + z_4 = 0 \\implies 0 + 0 = 0$。该条件是平凡满足的。\n由于对于任何 $x \\in \\mathcal{V}_1$ 两个条件都成立，因此可以得出，如果 $x \\in \\mathcal{V}_1$，那么 $Ax \\in \\mathcal{V}_1$。这意味着 $A\\mathcal{V}_1 \\subseteq \\mathcal{V}_1$，所以 $\\mathcal{V}_1$ 是一个 $A$-不变子空间。\n因此，迭代得到 $\\mathcal{V}_2 = \\{x \\in \\mathcal{V}_1 \\mid Ax \\in \\mathcal{V}_1\\} = \\mathcal{V}_1$。\n由于 $\\mathcal{V}_2 = \\mathcal{V}_1$，算法已经收敛。\n\n**结论**\n包含在 $\\ker C$ 中的最大 $A$-不变子空间是 $\\mathcal{N}_o = \\mathcal{V}_1$。$\\mathcal{N}_o$ 的一组基是：\n$$\n\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\right\\}\n$$\n子空间的维数是其基中向量的数量。$\\mathcal{N}_o$ 的基包含两个向量。因此，不可观测子空间 $\\mathcal{N}_o$ 的维数是 $2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2756462"}, {"introduction": "可检测性是设计稳定状态观测器的前提条件，而理解其反面——不可检测性——同样重要。本练习 [@problem_id:2756426] 探讨了一个经典的不可检测系统，其核心问题在于存在一个既不稳定又无法被观测到的模式。您将通过分析证明，为何该不稳定模式的特征值在任何输出反馈下都保持不变，从而深刻理解为何在这种情况下无法设计出能稳定跟踪系统状态的观测器。", "problem": "考虑一个线性时不变（LTI）系统，其状态空间表示为 $\\dot{x} = A x$, $y = C x$，其中 $x \\in \\mathbb{R}^{2}$，$y \\in \\mathbb{R}$，且\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0  1 \\end{pmatrix}.\n$$\n从不可观子空间和能检测性的基本定义出发，完成以下任务：\n1) 确定给定矩阵对 $(A,C)$ 的不可观子空间，并找出其特征向量位于该子空间内的所有 $A$ 的特征值。从基本原理出发论证所有步骤。\n2) 仅使用不变子空间和线性算子的基本性质，解释为什么与不可观子空间中的特征向量相关联的任何 $A$ 的特征值都不能通过形式为 $A - L C$ 的输出注入来改变，其中 $L \\in \\mathbb{R}^{2 \\times 1}$ 是任意的。\n3) 基于能检测性的定义（即根据不可观模式的稳定性），通过严谨的论证，判断 $(A,C)$ 是否是能检测的。\n4) 设方阵 $M$ 的谱横坐标定义为 $\\alpha(M) \\triangleq \\max \\{\\operatorname{Re}(\\lambda) : \\lambda \\text{ 是 } M \\text{ 的一个特征值}\\}$。计算下式的确切值\n$$\n\\inf_{L \\in \\mathbb{R}^{2 \\times 1}} \\, \\alpha(A - L C).\n$$\n给出你的最终答案，它是一个没有单位的精确数字。不需要四舍五入。", "solution": "我们从基本定义开始。对于线性时不变（LTI）系统 $\\dot{x} = A x$, $y = C x$，不可观子空间 $\\mathcal{N}_{\\mathrm{obs}}$ 是包含在输出映射 $C$ 的核（kernel）中的最大 $A$-不变子空间，对于有限维系统，它可以计算为\n$$\n\\mathcal{N}_{\\mathrm{obs}} = \\bigcap_{k=0}^{n-1} \\ker\\!\\left(C A^{k}\\right),\n$$\n其中 $n$ 是系统阶数。$(A,C)$ 的能检测性意味着每一条不可观的轨迹都随着 $t \\to \\infty$ 收敛到原点，等价地，其特征向量位于不可观子空间中的每个 $A$ 的特征值都具有严格为负的实部。\n\n第 1 步：计算不可观子空间并确定相关特征值。对于给定的矩阵\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0  1 \\end{pmatrix},\n$$\n我们有\n$$\nC = \\begin{pmatrix} 0  1 \\end{pmatrix}, \\quad C A = C \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} = \\begin{pmatrix} 0  -2 \\end{pmatrix}.\n$$\n于是\n$$\n\\ker(C) = \\left\\{ x \\in \\mathbb{R}^{2} : \\begin{pmatrix} 0  1 \\end{pmatrix} x = 0 \\right\\} = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\},\n$$\n和\n$$\n\\ker(CA) = \\left\\{ x \\in \\mathbb{R}^{2} : \\begin{pmatrix} 0  -2 \\end{pmatrix} x = 0 \\right\\} = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\}.\n$$\n因此\n$$\n\\mathcal{N}_{\\mathrm{obs}} = \\ker(C) \\cap \\ker(CA) = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\}.\n$$\n向量 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 是 $A$ 的一个特征向量，因为\n$$\nA \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n所以它对应于特征值 $\\lambda = 1$。因此，$A$ 的特征值 $\\lambda = 1$ 是不可观的。因为 $\\operatorname{Re}(1) = 1 > 0$，它是一个不稳定的特征值。\n\n第 2 步：证明不可观特征值在输出注入下是不可移动的。考虑任意一个输出注入增益 $L \\in \\mathbb{R}^{2 \\times 1}$ 和修改后的矩阵 $A - L C$。设 $x \\in \\mathcal{N}_{\\mathrm{obs}}$。根据不可观子空间的定义，$C x = 0$。因此，\n$$\n(A - L C) x = A x - L (C x) = A x - L \\cdot 0 = A x.\n$$\n因此，$\\mathcal{N}_{\\mathrm{obs}}$ 对于 $A$ 和 $A - L C$ 都是不变子空间，并且 $A - L C$ 在 $\\mathcal{N}_{\\mathrm{obs}}$ 上的作用与 $A$ 在 $\\mathcal{N}_{\\mathrm{obs}}$ 上的作用相同。因此，与 $\\mathcal{N}_{\\mathrm{obs}}$ 中特征向量相关联的每个 $A$ 的特征值，也同样是 $A - L C$ 的特征值，且值相同。特别地，对于任意 $L$，不可观特征值 $\\lambda = 1$ 在 $A - L C$ 中持续存在。\n\n第 3 步：能检测性结论。根据能检测性的定义，如果每个不可观特征值都具有严格为负的实部，则 $(A,C)$ 是能检测的。我们已经确定了一个实部为正的不可观特征值 $\\lambda = 1$。因此，$(A,C)$ 不是能检测的。等价地，由于对于所有 $L$，$\\lambda = 1$ 都保留在 $A - L C$ 的谱中，因此没有任何 $L$ 的选择可以使 $A - L C$ 成为一个 Hurwitz 矩阵，所以通过输出注入实现镇定是不可能的。\n\n第 4 步：计算 $\\inf_{L} \\alpha(A - L C)$。设 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$。那么\n$$\nL C = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  \\ell_{1} \\\\ 0  \\ell_{2} \\end{pmatrix},\n$$\n因此\n$$\nA - L C = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} - \\begin{pmatrix} 0  \\ell_{1} \\\\ 0  \\ell_{2} \\end{pmatrix} = \\begin{pmatrix} 1  -\\ell_{1} \\\\ 0  -2 - \\ell_{2} \\end{pmatrix}.\n$$\n这个矩阵是上三角矩阵，所以它的特征值就是对角线上的元素：\n$$\n\\lambda_{1} = 1, \\quad \\lambda_{2} = -2 - \\ell_{2}.\n$$\n因此，谱横坐标为\n$$\n\\alpha(A - L C) = \\max \\{ \\operatorname{Re}(1), \\operatorname{Re}(-2 - \\ell_{2}) \\} = \\max \\{ 1, -2 - \\ell_{2} \\}.\n$$\n对 $\\ell_{2} \\in \\mathbb{R}$ 进行最小化可得\n$$\n\\inf_{\\ell_{2} \\in \\mathbb{R}} \\max \\{ 1, -2 - \\ell_{2} \\} = 1,\n$$\n因为 $\\lambda_{1} = 1$ 是固定的，并且不能通过任何 $L$ 的选择来减小。因此，\n$$\n\\inf_{L \\in \\mathbb{R}^{2 \\times 1}} \\alpha(A - L C) = 1.\n$$\n这既证实了通过输出注入实现镇定的不可能性，也提供了所要求的确切值。", "answer": "$$\\boxed{1}$$", "id": "2756426"}, {"introduction": "当一个系统被证实为可检测时，即便其自身含有不稳定动态，我们仍有能力为其设计一个稳定的状态估计器。这个综合性练习 [@problem_id:2756420] 旨在展示从理论到应用的完整工作流程。您将首先运用强大的 Popov-Belevitch-Hautus (PBH) 测试来验证系统的可检测性，随后利用这一关键性质设计一个 Luenberger 观测器，将所有可观测模式的误差动态配置到期望的稳定位置，从而体验可检测性在现代控制设计中的实际价值。", "problem": "考虑一个连续时间线性时不变 (LTI) 系统，其状态矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 4}$ 如下所示：\n$$\nA \\;=\\; \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  -1  0 \\\\\n0  0  0  -2\n\\end{bmatrix},\n\\qquad\nC \\;=\\; \\begin{bmatrix} 1  0  0  0 \\end{bmatrix}.\n$$\n仅使用基本定义和广泛接受的表征，按以下步骤进行。\n1) 从可检测性的定义和限制在闭合右半平面（即，对于所有满足 $\\Re(\\lambda) \\ge 0$ 的复数 $\\lambda$）的 Popov–Belevitch–Hautus (PBH) 测试表征出发，判断矩阵对 $(A,C)$ 是否是可检测的。你的推理过程必须考察与 $\\Re(\\lambda) \\ge 0$ 相关的特征结构，并应用 PBH 秩条件，不得使用任何未经证明的捷径。\n2) 确定 $(A,C)$ 的不可观测子空间，并解释任何存在的不可观测模态是否是稳定的，同时明确其与可检测性的关系。\n3) 设计一个 Luenberger 观测器增益 $L \\in \\mathbb{R}^{4 \\times 1}$，使得观测器误差动态矩阵 $A - L C$ 在可观测子空间上的特征值为 $\\{-3,\\,-4,\\,-5\\}$，同时保持任何内在的不可观测模态不变。通过匹配目标特征值所对应的特征多项式来构造 $L$。\n4) 最后，为你所设计的 $L$ 计算最终的观测器误差动态矩阵 $A - L C$ 的行列式。将此行列式作为最终答案报告。最终答案是一个无单位的实数值。无需四舍五入。", "solution": "问题陈述已提交验证。\n\n步骤1：提取已知条件。\n该连续时间线性时不变 (LTI) 系统由状态矩阵 $A$ 和输出矩阵 $C$ 描述。\n状态矩阵：$A = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  -1  0 \\\\ 0  0  0  -2 \\end{bmatrix} \\in \\mathbb{R}^{4 \\times 4}$。\n输出矩阵：$C = \\begin{bmatrix} 1  0  0  0 \\end{bmatrix} \\in \\mathbb{R}^{1 \\times 4}$。\n任务1：使用 Popov–Belevitch–Hautus (PBH) 测试，对所有满足 $\\Re(\\lambda) \\ge 0$ 的复数 $\\lambda$，判断矩阵对 $(A,C)$ 是否是可检测的。\n任务2：确定 $(A,C)$ 的不可观测子空间及其相关模态，并将其与可检测性的定义联系起来。\n任务3：设计一个观测器增益 $L \\in \\mathbb{R}^{4 \\times 1}$，将可观测子空间的观测器特征值配置在 $\\{-3, -4, -5\\}$，同时保持任何不可观测模态不变。\n任务4：计算得到的观测器误差动态矩阵 $A - L C$ 的行列式。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，植根于线性系统和控制理论的标准原理，特别是可观测性、可检测性和 Luenberger 观测器设计。该问题是适定的，提供了所有必要的矩阵和清晰定义的顺序目标。语言客观、精确。该问题不违反任何无效性标准。这是一个控制工程领域中完整、一致且可形式化的练习。\n\n步骤3：结论与行动。\n该问题是 **有效的**。将构建一个解答。\n\n解答按顺序处理四个指定的任务。\n\n1) 矩阵对 $(A,C)$ 的可检测性。\n对于一个 LTI 系统，可检测性的定义是：矩阵对 $(A,C)$ 是可检测的，当且仅当系统的所有不可观测模态都是稳定的。一个等价的表征是用于可检测性的 Popov–Belevitch–Hautus (PBH) 测试，该测试要求矩阵 $\\begin{bmatrix} A - \\lambda I \\\\ C \\end{bmatrix}$ 对于所有满足 $\\Re(\\lambda) \\ge 0$ 的 $\\lambda \\in \\mathbb{C}$ 都具有满列秩。此处，状态维数 $n=4$，因此我们必须检查对于所有这样的 $\\lambda$，是否有 $\\text{rank}\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} = 4$。\n\n首先，我们求 $A$ 的特征值。矩阵 $A$ 是分块上三角矩阵：\n$$\nA = \\begin{bmatrix} A_{11}  A_{12} \\\\ 0  A_{22} \\end{bmatrix} = \\begin{bmatrix} \\begin{matrix} 0  1  0 \\\\ 0  0  1 \\\\ 0  0  -1 \\end{matrix}  \\begin{matrix} 0 \\\\ 0 \\\\ 0 \\end{matrix} \\\\ \\begin{matrix} 0  0  0 \\end{matrix}  -2 \\end{bmatrix}\n$$\n$A$ 的特征值是对角块 $A_{11}$ 和 $A_{22}$ 特征值的并集。左上 $3 \\times 3$ 块的特征值是其对角线元素，即 $\\{0, 0, -1\\}$。右下 $1 \\times 1$ 块的特征值是 $\\{-2\\}$。因此，$A$ 的谱为 $\\sigma(A) = \\{0, 0, -1, -2\\}$。\n\n$A$ 的特征值中唯一满足 $\\Re(\\lambda) \\ge 0$ 的是 $\\lambda=0$。用于可观测性的 PBH 测试指出，一个特征值 $\\lambda$ 是不可观测的，当且仅当 $\\text{rank}\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}  n$。对于可检测性，我们只需对闭合右半平面内的特征值验证此条件。我们测试 $\\lambda=0$：\n$$\n\\begin{bmatrix} A - 0 \\cdot I \\\\ C \\end{bmatrix} = \\begin{bmatrix} A \\\\ C \\end{bmatrix} = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  -1  0 \\\\ 0  0  0  -2 \\\\ 1  0  0  0 \\end{bmatrix}\n$$\n这是一个 $5 \\times 4$ 矩阵。我们检查其是否为满列秩，即秩为 $4$。选择该矩阵的第 5、1、2、4 行，得到一个 $4 \\times 4$ 的子矩阵：\n$$\n\\begin{bmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  -2 \\end{bmatrix}\n$$\n该子矩阵的行列式为 $1 \\cdot 1 \\cdot 1 \\cdot (-2) = -2 \\ne 0$。由于我们找到了一个满秩的 $4 \\times 4$ 子矩阵，因此 $5 \\times 4$ 矩阵 $\\begin{pmatrix} A \\\\ C \\end{pmatrix}$ 的秩为 $4$。因此，PBH 秩条件对 $\\lambda=0$ 成立。由于这是闭合右半平面内唯一的特征值，所以矩阵对 $(A,C)$ 是可检测的。\n\n2) 不可观测子空间和模态。\n不可观测子空间是可观测性矩阵 $\\mathcal{O}$ 的零空间。\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\end{bmatrix}\n$$\n我们计算各行：\n$C = \\begin{bmatrix} 1  0  0  0 \\end{bmatrix}$\n$CA = \\begin{bmatrix} 1  0  0  0 \\end{bmatrix} A = \\begin{bmatrix} 0  1  0  0 \\end{bmatrix}$\n$CA^2 = (CA)A = \\begin{bmatrix} 0  1  0  0 \\end{bmatrix} A = \\begin{bmatrix} 0  0  1  0 \\end{bmatrix}$\n$CA^3 = (CA^2)A = \\begin{bmatrix} 0  0  1  0 \\end{bmatrix} A = \\begin{bmatrix} 0  0  -1  0 \\end{bmatrix}$\n可观测性矩阵为：\n$$\n\\mathcal{O} = \\begin{bmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  -1  0 \\end{bmatrix}\n$$\n第四行是第三行的 $-1$ 倍，因此各行线性相关。前三行是线性无关的。因此，$\\text{rank}(\\mathcal{O}) = 3$。由于 $\\text{rank}(\\mathcal{O})  4$，该系统是不可观测的。\n不可观测子空间是 $\\mathcal{N}(\\mathcal{O})$。我们寻找一个向量 $x = [x_1, x_2, x_3, x_4]^T$ 使得 $\\mathcal{O}x = 0$。这导出一个方程组 $x_1=0$, $x_2=0$, 和 $x_3=0$。变量 $x_4$ 是自由的。因此，不可观测子空间由向量 $v = [0, 0, 0, 1]^T$ 张成。\n$$\n\\mathcal{N}(\\mathcal{O}) = \\text{span}\\left\\{ \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\right\\}\n$$\n不可观测模态是与不可观测子空间中的特征向量相关联的 $A$ 的特征值。我们检查 $v$ 是否是 $A$ 的一个特征向量：\n$$\nAv = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  -1  0 \\\\ 0  0  0  -2 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -2 \\end{bmatrix} = -2 \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = -2v\n$$\n向量 $v$ 确实是 $A$ 的一个特征向量，其对应的特征值为 $\\lambda = -2$。这个特征值是系统的不可观测模态。\n对于可检测性，所有不可观测模态都必须是稳定的，这意味着它们对应的特征值必须有严格为负的实部。在这里，唯一的不可观测模态是 $\\lambda = -2$，并且 $\\Re(-2) = -2  0$。因此，该模态是稳定的。这证实了矩阵对 $(A,C)$ 是可检测的。\n\n3) Luenberger 观测器增益设计。\n我们设计一个增益 $L = [l_1, l_2, l_3, l_4]^T$，使得观测器误差动态矩阵 $A-LC$ 具有指定的特征值。矩阵 $A-LC$ 是：\n$$\nA - LC = A - \\begin{bmatrix} l_1 \\\\ l_2 \\\\ l_3 \\\\ l_4 \\end{bmatrix} \\begin{bmatrix} 1  0  0  0 \\end{bmatrix} = \\begin{bmatrix} -l_1  1  0  0 \\\\ -l_2  0  1  0 \\\\ -l_3  0  -1  0 \\\\ -l_4  0  0  -2 \\end{bmatrix}\n$$\n特征多项式为 $p(s) = \\det(sI - (A-LC))$。\n$$\nsI - (A-LC) = \\begin{bmatrix} s+l_1  -1  0  0 \\\\ l_2  s  -1  0 \\\\ l_3  0  s+1  0 \\\\ l_4  0  0  s+2 \\end{bmatrix}\n$$\n由于其分块三角结构，行列式是对角块行列式的乘积：\n$$\n\\det(sI - (A-LC)) = (s+2) \\cdot \\det \\begin{bmatrix} s+l_1  -1  0 \\\\ l_2  s  -1 \\\\ l_3  0  s+1 \\end{bmatrix}\n$$\n这表明不可观测的特征值 $s=-2$ 是固定的，与 $L$ 的选择无关。观测器增益只能影响可观测的特征值。这个 $3 \\times 3$ 块的行列式是：\n$\\det(\\cdot) = (s+l_1)[s(s+1) - 0] - (-1)[l_2(s+1) - (-l_3)] = (s+l_1)(s^2+s) + l_2(s+1) + l_3 = s^3 + s^2 + l_1s^2 + l_1s + l_2s + l_2 + l_3 = s^3 + (1+l_1)s^2 + (l_1+l_2)s + (l_2+l_3)$。\n可观测部分所期望的特征多项式由目标特征值 $\\{-3, -4, -5\\}$ 指定：\n$p_{des}(s) = (s+3)(s+4)(s+5) = (s^2+7s+12)(s+5) = s^3+5s^2+7s^2+35s+12s+60 = s^3+12s^2+47s+60$。\n通过对比系数，我们求得增益 $l_1, l_2, l_3$：\n$s^2: 1+l_1 = 12 \\implies l_1 = 11$。\n$s^1: l_1+l_2 = 47 \\implies 11+l_2 = 47 \\implies l_2 = 36$。\n$s^0: l_2+l_3 = 60 \\implies 36+l_3 = 60 \\implies l_3 = 24$。\n增益 $l_4$ 对特征值没有影响。在特征多项式计算中，$l_4$ 只出现在项 $l_4 \\det(\\text{含零列的矩阵}) = 0$ 中。为简单起见，我们可以设 $l_4=0$。\n设计的观测器增益是 $L = \\begin{bmatrix} 11  36  24  0 \\end{bmatrix}^T$。\n\n4) 最终观测器误差动态矩阵的行列式。\n一个矩阵的行列式是其所有特征值的乘积。设计的观测器误差动态矩阵 $A-LC$ 的特征值是配置的特征值与固定的不可观测特征值的并集：$\\{-3, -4, -5, -2\\}$。\n因此，行列式为：\n$$\n\\det(A-LC) = (-3) \\cdot (-4) \\cdot (-5) \\cdot (-2) = (12) \\cdot (10) = 120\n$$\n或者，我们直接用设计的增益从矩阵 $A-LC$ 计算行列式：\n$$\nA-LC = \\begin{bmatrix} -11  1  0  0 \\\\ -36  0  1  0 \\\\ -24  0  -1  0 \\\\ 0  0  0  -2 \\end{bmatrix}\n$$\n沿第四行进行代数余子式展开：\n$$\n\\det(A-LC) = (-2) \\cdot \\det \\begin{bmatrix} -11  1  0 \\\\ -36  0  1 \\\\ -24  0  -1 \\end{bmatrix}\n$$\n现在，沿这个 $3 \\times 3$ 矩阵的第二列进行代数余子式展开：\n$$\n\\det(A-LC) = (-2) \\cdot \\left( -1 \\cdot \\det \\begin{bmatrix} -36  1 \\\\ -24  -1 \\end{bmatrix} \\right) = (-2) \\cdot \\left( -1 \\cdot [(-36)(-1) - (1)(-24)] \\right)\n$$\n$$\n\\det(A-LC) = (-2) \\cdot (-1 \\cdot [36 + 24]) = (-2) \\cdot (-1 \\cdot 60) = (-2) \\cdot (-60) = 120\n$$\n两种方法得到相同的结果。计算是正确的。", "answer": "$$\n\\boxed{120}\n$$", "id": "2756420"}]}