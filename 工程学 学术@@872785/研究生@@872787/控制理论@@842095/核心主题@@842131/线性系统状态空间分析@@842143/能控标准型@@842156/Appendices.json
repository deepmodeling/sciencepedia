{"hands_on_practices": [{"introduction": "从系统的传递函数出发，是构建其状态空间表示的最直接方法之一。能控规范型为此提供了一个标准的“配方”，能够系统性地将输入-输出描述转化为内部状态动态。这项练习将从第一性原理出发，为一个给定的传递函数构建能控规范型，从而巩固传递函数系数与标准型中 $A$ 和 $C$ 矩阵元素之间的直接联系。[@problem_id:2697097] 此外，本练习还将状态空间模型与一个可测量的系统特性——脉冲响应——联系起来，展示了如何利用该模型来分析系统的瞬时行为。", "problem": "考虑一个三阶、实系数、单输入单输出 (SISO) 的严格真传递函数，\n$$\nG(s)=\\frac{b_{0}s^{2}+b_{1}s+b_{2}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}},\n$$\n其真实参数为 $a_{0},a_{1},a_{2},b_{0},b_{1},b_{2}$。从状态空间实现和传递函数的基本定义出发，并且不借助预先记忆的规范型模板，构建一个实现 $G(s)$ 的最小能控规范型实现 $(A,B,C,D)$，其状态矩阵为友矩阵形式。然后，仅使用此实现和脉冲响应的定义，确定脉冲响应 $h(t)$ 在零点的二阶导数的精确闭式表达式，即 $h''(0^{+})$，并完全用 $a_{0},a_{1},a_{2},b_{0},b_{1},b_{2}$ 表示。你的最终答案必须是单一的解析表达式。不需要数值四舍五入，也不需要单位。", "solution": "本问题要求为一个给定的单输入单输出 (SISO) 传递函数推导一个最小能控规范型实现，然后利用该实现求出脉冲响应在时间 $t=0^{+}$ 处的二阶导数。\n\n给定的传递函数为\n$$ G(s) = \\frac{Y(s)}{U(s)} = \\frac{b_{0}s^{2}+b_{1}s+b_{2}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}} $$\n这对应于拉普拉斯域中的输入-输出关系：\n$$ (s^{3}+a_{2}s^{2}+a_{1}s+a_{0})Y(s) = (b_{0}s^{2}+b_{1}s+b_{2})U(s) $$\n\n为了从基本原理构造一个形如 $\\dot{\\mathbf{x}} = A\\mathbf{x} + Bu$ 和 $y = C\\mathbf{x} + Du$ 的状态空间实现，我们必须避免在状态方程中出现输入 $u(t)$ 的导数。我们引入一个辅助变量 $X(s)$，使得：\n$$ s^{3}+a_{2}s^{2}+a_{1}s+a_{0} = \\frac{U(s)}{X(s)} $$\n和\n$$ b_{0}s^{2}+b_{1}s+b_{2} = \\frac{Y(s)}{X(s)} $$\n从第一个方程，我们得到一个关于辅助变量 $x(t) = \\mathcal{L}^{-1}\\{X(s)\\}$ 的微分方程，该方程只涉及输入 $u(t)$：\n$$ U(s) = (s^{3}+a_{2}s^{2}+a_{1}s+a_{0})X(s) $$\n在时域中，这变成：\n$$ \\frac{d^{3}x}{dt^{3}} + a_{2}\\frac{d^{2}x}{dt^{2}} + a_{1}\\frac{dx}{dt} + a_{0}x = u(t) $$\n我们可以自由选择状态变量。为了获得能控规范型，我们定义状态向量 $\\mathbf{x}$ 的分量为：\n$$ x_{1}(t) = x(t) $$\n$$ x_{2}(t) = \\frac{dx}{dt}(t) $$\n$$ x_{3}(t) = \\frac{d^{2}x}{dt^{2}}(t) $$\n状态方程由这些定义导出：\n$$ \\dot{x}_{1} = x_{2} $$\n$$ \\dot{x}_{2} = x_{3} $$\n并从 $x(t)$ 的微分方程得到：\n$$ \\dot{x}_{3} = \\frac{d^{3}x}{dt^{3}} = -a_{0}x_{1} - a_{1}x_{2} - a_{2}x_{3} + u(t) $$\n这些方程可以写成矩阵形式 $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$：\n$$ \\begin{pmatrix} \\dot{x}_{1} \\\\ \\dot{x}_{2} \\\\ \\dot{x}_{3} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -a_{0} & -a_{1} & -a_{2} \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} u(t) $$\n因此，状态矩阵 $A$ 和输入矩阵 $B$ 分别为：\n$$ A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -a_{0} & -a_{1} & -a_{2} \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n矩阵 $A$ 是友矩阵形式，这正是能控规范型的要求。该实现保证是能控的。为了使其最小化，它还必须是能观的，这等价于传递函数没有极点-零点对消。我们假设情况如此，这对于符号定义的问题是标准做法。\n\n接下来，我们推导输出方程。根据我们的辅助变量定义，$Y(s) = (b_{0}s^{2}+b_{1}s+b_{2})X(s)$。进行拉普拉斯逆变换得到：\n$$ y(t) = b_{0}\\frac{d^{2}x}{dt^{2}} + b_{1}\\frac{dx}{dt} + b_{2}x $$\n代入状态变量的定义，我们得到输出方程：\n$$ y(t) = b_{0}x_{3}(t) + b_{1}x_{2}(t) + b_{2}x_{1}(t) $$\n这可以写成矩阵形式 $y = C\\mathbf{x} + Du$：\n$$ y(t) = \\begin{pmatrix} b_{2} & b_{1} & b_{0} \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} $$\n所以输出矩阵 $C$ 是：\n$$ C = \\begin{pmatrix} b_{2} & b_{1} & b_{0} \\end{pmatrix} $$\n给定的传递函数是严格真的，因为分子阶数（2）小于分母阶数（3）。这意味着直接馈通项 $D$ 必须为零，即 $D=0$。我们的推导证实了这一点。\n\n所构造的最小能控规范型实现为 $(A, B, C, D)$，其矩阵如上所定义。\n\n现在，我们继续计算 $h''(0^{+})$，即脉冲响应在 $t=0^{+}$ 处的二阶导数。脉冲响应 $h(t)$ 是当输入为狄拉克δ函数 $u(t) = \\delta(t)$ 且初始状态为零 $\\mathbf{x}(0^{-}) = \\mathbf{0}$ 时系统的输出 $y(t)$。\n状态方程为 $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\delta(t)$。从 $t=0^{-}$ 到 $t=0^{+}$ 积分：\n$$ \\int_{0^{-}}^{0^{+}} \\dot{\\mathbf{x}}(t) dt = \\int_{0^{-}}^{0^{+}} A\\mathbf{x}(t) dt + \\int_{0^{-}}^{0^{+}} B\\delta(t) dt $$\n$$ \\mathbf{x}(0^{+}) - \\mathbf{x}(0^{-}) = \\mathbf{0} + B $$\n由于 $\\mathbf{x}(0^{-}) = \\mathbf{0}$，系统在 $t>0$ 时自由演化的初始状态为 $\\mathbf{x}(0^{+}) = B$。\n\n当 $t>0$ 时，输入 $u(t)$ 为零，因此系统动力学由 $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t)$ 给出。这个齐次方程的解是 $\\mathbf{x}(t) = e^{At}\\mathbf{x}(0^{+})$。因此，对于 $t>0$ 的脉冲响应是：\n$$ h(t) = y(t) = C\\mathbf{x}(t) = C e^{At} \\mathbf{x}(0^{+}) = C e^{At} B $$\n为了求导数，我们对 $h(t)$ 关于时间求导：\n$$ h'(t) = \\frac{d}{dt}(C e^{At} B) = C \\frac{d}{dt}(e^{At}) B = C (A e^{At}) B = CAe^{At}B $$\n$$ h''(t) = \\frac{d}{dt}(CA e^{At} B) = CA \\frac{d}{dt}(e^{At}) B = CA(A e^{At}) B = CA^{2}e^{At}B $$\n我们在 $t=0^{+}$ 处计算这些导数。由于 $e^{A \\cdot 0} = I$ (单位矩阵)，我们有：\n$$ h''(0^{+}) = CA^{2}e^{A\\cdot 0}B = CA^{2}B $$\n现在我们必须计算这个矩阵乘积。首先，我们求 $A^{2}B$：\n$$ AB = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -a_{0} & -a_{1} & -a_{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -a_{2} \\end{pmatrix} $$\n$$ A^{2}B = A(AB) = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -a_{0} & -a_{1} & -a_{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -a_{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -a_{2} \\\\ -a_{1} + a_2^{2} \\end{pmatrix} $$\n最后，我们左乘 $C$ 来求得 $h''(0^{+})$：\n$$ h''(0^{+}) = CA^{2}B = \\begin{pmatrix} b_{2} & b_{1} & b_{0} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -a_{2} \\\\ a_2^{2} - a_{1} \\end{pmatrix} $$\n$$ h''(0^{+}) = b_{2}(1) + b_{1}(-a_{2}) + b_{0}(a_2^{2} - a_{1}) $$\n$$ h''(0^{+}) = b_{2} - a_{2}b_{1} + b_{0}a_2^{2} - b_{0}a_{1} $$\n这就是脉冲响应在 $t=0^{+}$ 处的二阶导数的最终解析表达式。", "answer": "$$ \\boxed{b_{0}a_2^{2} - b_{0}a_{1} - b_{1}a_{2} + b_{2}} $$", "id": "2697097"}, {"introduction": "在实践中，状态空间模型通常是根据物理定律（如牛顿定律或基尔霍夫定律）推导出来的，其状态变量具有明确的物理意义，例如位置、速度或电流。这些“物理”状态变量构成的模型通常不具备能控规范型的结构。这项练习旨在阐明一个核心概念：任何一个能控的线性系统，无论其最初的状态变量如何选择，都可以通过坐标变换转化为能控规范型。[@problem_id:2697134] 你将通过构建一个关键的相似变换矩阵 $T$ 来完成这一过程，而该矩阵本身就是由系统的能控性矩阵构成的，这是现代控制理论的基石之一。", "problem": "考虑一个单输入单输出（SISO）线性时不变机电模型，该模型由一个通过齿轮齿条机构由直流电机驱动的单位质量小车组成，并带有粘性阻尼。物理状态变量为小车位置 $x$、电机电枢电流 $i$ 和小车速度 $v$。设输入电压为 $u$，选择状态向量的朴素排序为 $s = [\\,x,\\ i,\\ v\\,]^{\\top}$（而不是常用的相变量排序）。当参数值为 $m = 1$、粘性系数 $b = 2$、反电动势常数 $k_{e} = 1$、转矩常数 $k_{t} = 1$、电枢电感 $L = 1$ 和电枢电阻 $R = 1$ 时，在这种朴素排序下的线性化状态空间模型为\n$$\n\\dot{s} = A s + b\\, u,\\quad \nA = \\begin{pmatrix}\n0 & 0 & 1\\\\\n0 & -1 & -1\\\\\n0 & 1 & -2\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}\n0\\\\\n1\\\\\n0\n\\end{pmatrix}.\n$$\n在任何平凡的坐标置换下，该矩阵 $A$ 都不呈伴随（能控规范）形式，因为执行器状态 $i$ 被插入到了 $x$ 和 $v$ 之间。\n\n仅使用线性系统和能控性的基本定义，完成以下任务：\n- 证明系统对 $(A,b)$ 是能控的。\n- 构造一个精确的相似变换 $T$，将 $(A,b)$ 映射到能控规范型，其输入向量为 $\\bar{b} = e_{1}$，系统矩阵 $\\bar{A}$ 的次对角线元素为1（即能控 Frobenius 伴随型）。\n- 你的构造必须从第一性原理出发：能控性的定义、能控子空间和基变换。不要假设任何预先记好的 $T$ 的公式；要通过从定义出发进行推导得出。\n- 最后，计算 $\\det(T)$ 的精确值。\n\n答案格式要求：提供单个实数 $\\det(T)$ 作为最终答案。无需四舍五- 完。", "solution": "我们从基本定义开始。对于一个维度为 $n$ 的单输入单输出系统对 $(A,b)$，其能控性矩阵定义为\n$$\n\\mathcal{C} \\equiv \\begin{pmatrix} b & A b & \\cdots & A^{n-1} b \\end{pmatrix}.\n$$\n系统对 $(A,b)$ 是能控的，当且仅当 $\\operatorname{rank}(\\mathcal{C}) = n$。此外，当 $(A,b)$ 是能控的时，有序集 $\\{b, A b, \\dots, A^{n-1} b\\}$ 是 $\\mathbb{R}^{n}$ 的一个基。在此基下表示 $A$ 会得到一个次对角线元素为1的矩阵，其最后一列由 $A^{n} b$ 在该基下的唯一坐标确定。当该单输入单输出（SISO）系统对是能控的（能控性指数等于 $n$），这就是能控 Frobenius 伴随型，并且相关的相似变换可以取为基变换矩阵，其列向量即为该基。\n\n步骤1：计算能控性矩阵并验证能控性。\n我们依次计算：\n$$\nb = \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix},\\quad\nA b = A \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix}.\n$$\n接着，\n$$\nA^{2} b = A (A b) = A \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix}\n= -\\,\\text{col}_{2}(A) + \\text{col}_{3}(A)\n= - \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1\\\\ -1\\\\ -2 \\end{pmatrix}\n= \\begin{pmatrix} 1\\\\ 0\\\\ -3 \\end{pmatrix}.\n$$\n因此，能控性矩阵为\n$$\n\\mathcal{C} = \\begin{pmatrix} b & A b & A^{2} b \\end{pmatrix}\n= \\begin{pmatrix}\n0 & 0 & 1\\\\\n1 & -1 & 0\\\\\n0 & 1 & -3\n\\end{pmatrix}.\n$$\n计算其行列式：\n$$\n\\det(\\mathcal{C}) = \n\\begin{vmatrix}\n0 & 0 & 1\\\\\n1 & -1 & 0\\\\\n0 & 1 & -3\n\\end{vmatrix}\n= 0 \\cdot \\begin{vmatrix} -1 & 0\\\\ 1 & -3 \\end{vmatrix}\n- 0 \\cdot \\begin{vmatrix} 1 & 0\\\\ 0 & -3 \\end{vmatrix}\n+ 1 \\cdot \\begin{vmatrix} 1 & -1\\\\ 0 & 1 \\end{vmatrix}\n= 1.\n$$\n因此 $\\operatorname{rank}(\\mathcal{C}) = 3$，系统对 $(A,b)$ 是能控的。\n\n步骤2：从第一性原理构造相似变换 $T$。\n因为 $\\{b, A b, A^{2} b\\}$ 是一个基，我们将该有序集作为新的能控基。令 $T$ 的列为这些基向量：\n$$\nT \\equiv \\mathcal{C} = \\begin{pmatrix}\n0 & 0 & 1\\\\\n1 & -1 & 0\\\\\n0 & 1 & -3\n\\end{pmatrix}.\n$$\n通过 $s = T z$ 定义新坐标 $z$，即 $z = T^{-1} s$。在此基下，线性映射 $A$ 的矩阵为 $A_{c} = T^{-1} A T$，其列是 $A$ 作用在基向量上的坐标。使用 $v_{1} = b$，$v_{2} = A b$，$v_{3} = A^{2} b$，我们有\n- $A v_{1} = v_{2}$，所以 $A_{c}$ 的第一列是 $e_{2}$。\n- $A v_{2} = v_{3}$，所以 $A_{c}$ 的第二列是 $e_{3}$。\n- $A v_{3} = A^{3} b$ 必须用基 $\\{v_{1}, v_{2}, v_{3}\\}$ 来表示。\n\n为从基本原理出发找到 $A^{3} b$ 在此基下的表示，我们引用关于 $A$ 的 Cayley–Hamilton 定理。首先计算 $A$ 的特征多项式：\n$$\np(\\lambda) = \\det(\\lambda I - A) \n= \\det \\begin{pmatrix}\n\\lambda & 0 & -1\\\\\n0 & \\lambda + 1 & 1\\\\\n0 & -1 & \\lambda + 2\n\\end{pmatrix}\n= \\lambda \\big((\\lambda + 1)(\\lambda + 2) + 1\\big) \n= \\lambda \\left(\\lambda^{2} + 3 \\lambda + 3\\right)\n= \\lambda^{3} + 3 \\lambda^{2} + 3 \\lambda.\n$$\n根据 Cayley–Hamilton 定理，$A^{3} + 3 A^{2} + 3 A = 0$，因此\n$$\nA^{3} b = -3 A^{2} b - 3 A b.\n$$\n在关于基 $\\{v_{1}, v_{2}, v_{3}\\} = \\{b, A b, A^{2} b\\}$ 的坐标下，这可以写成\n$$\nA v_{3} = 0 \\cdot v_{1} - 3 v_{2} - 3 v_{3},\n$$\n所以 $A_{c}$ 的第三列是 $\\begin{pmatrix} 0\\\\ -3\\\\ -3 \\end{pmatrix}$。因此，\n$$\nA_{c} = T^{-1} A T\n= \\begin{pmatrix}\n0 & 0 & 0\\\\\n1 & 0 & -3\\\\\n0 & 1 & -3\n\\end{pmatrix},\n\\quad\nb_{c} = T^{-1} b = e_{1},\n$$\n这正是能控 Frobenius 伴随型，其特点是次对角线上为1，最后一列由 $p(\\lambda)$ 的系数的相反数构成，即 $(-a_{0}, -a_{1}, -a_{2})^{\\top} = (0, -3, -3)^{\\top}$。\n\n因此，精确的相似变换是 $T = \\mathcal{C}$。\n\n步骤3：计算 $\\det(T)$。\n根据步骤1的计算，$\\det(T) = \\det(\\mathcal{C}) = 1$。\n\n因此，$\\det(T)$ 的精确值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2697134"}, {"introduction": "在掌握了如何构建相似变换将任意能控系统化为标准型的代数方法后，我们必须面对一个实际工程问题：数值稳定性。理论上完美的变换，在计算机上执行时可能因为舍入误差而被放大，导致结果严重失真，这个现象由变换矩阵的“条件数”来量化。这项高级练习将深入探讨数值鲁棒性这一关键领域，它连接了优雅的控制理论与可靠的工程实践。[@problem_id:2697100] 通过分析一个参数化的例子并动手编程实现，你将学习到为何理论上的变换矩阵可能“病态”，以及如何通过如“列平衡”这样的简单而有效的技术来显著提高计算的可靠性。", "problem": "考虑一个单输入线性时不变状态空间系统，其状态矩阵为 $A \\in \\mathbb{R}^{n \\times n}$，输入向量为 $b \\in \\mathbb{R}^{n}$。能控性矩阵定义为 $C(A,b) = [\\,b,\\,Ab,\\,A^{2}b,\\,\\dots,\\,A^{n-1}b\\,]$。一种将系统映射到能控性基的标准相似变换使用 $C(A,b)$ 的列作为基，即变换矩阵 $T \\in \\mathbb{R}^{n \\times n}$ 取为 $T_{\\mathrm{raw}} = C(A,b)$（假设 $\\operatorname{rank} C(A,b) = n$）。在此能控性基中，变换后的状态矩阵 $A_{c} = T_{\\mathrm{raw}}^{-1} A T_{\\mathrm{raw}}$ 呈现为能控伴随型。\n\n在构造变换之前，定义一个列平衡（也称为列缩放）步骤，方法是构造一个对角矩阵 $D \\in \\mathbb{R}^{n \\times n}$，其对角元等于 $T_{\\mathrm{raw}}$ 各列的欧几里得范数，即若 $T_{\\mathrm{raw}} = [\\,c_{1},\\dots,c_{n}\\,]$ 且 $c_{k} \\in \\mathbb{R}^{n}$，则 $D = \\operatorname{diag}(\\,\\lVert c_{1} \\rVert_{2},\\dots,\\lVert c_{n} \\rVert_{2}\\,)$。令平衡后的变换为 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}} D^{-1}$。$T_{\\mathrm{raw}}$ 和 $T_{\\mathrm{bal}}$ 都是生成能控性基的容许相似变换；它们之间的差异在于基向量的对角重缩放。\n\n你的任务是：\n\n1) 仅从能控性、相似变换和导出算子范数的基本定义出发，解释为什么 $T$ 的条件数对坐标变换的数值鲁棒性至关重要，以及为什么通过右乘一个使列范数相等的对角矩阵是降低谱范数下的条件数 $\\kappa_{2}(T)$ 的一种有原则的尝试。除此处给定的结构外，不要假设任何特殊结构。\n\n2) 考虑由正实数参数 $\\alpha \\in \\mathbb{R}_{>0}$ 和整数 $n \\in \\mathbb{N}$ 索引的参数化族，其\n$$\nA(\\alpha) = \\operatorname{diag}\\big(1,\\alpha,\\alpha^{2},\\dots,\\alpha^{n-1}\\big),\\quad b(\\alpha) = \\mathbf{1}_{n}.\n$$\n证明对于 $\\alpha \\neq 1$，系统对 $(A(\\alpha), b(\\alpha))$ 是能控的，方法是证明能控性矩阵 $C\\big(A(\\alpha), b(\\alpha)\\big)$ 是非奇异的。明确表示出 $C\\big(A(\\alpha), b(\\alpha)\\big)$ 的元素，并使用范德蒙行列式论证其可逆性。\n\n3) 对于第2部分中的族，推导 $C\\big(A(\\alpha), b(\\alpha)\\big)$ 第 $k$ 列的欧几里得范数平方的闭式表达式，作为 $\\alpha$、 $n$ 和 $k \\in \\{1,\\dots,n\\}$ 的函数。证明当 $\\alpha > 1$ 时，此范数随 $k$ 和 $n$ 几何级数增长；当 $0 < \\alpha < 1$ 时，它几何级数衰减，从而在 $\\alpha$ 远离 $1$ 时，在各列之间造成巨大差异。\n\n4) 基于第1)至3)部分的结论，论证对于此参数化族，当 $\\alpha$ 显著偏离 $1$ 时，通过乘以 $D^{-1}$ 来构造 $T_{\\mathrm{bal}}$ 预计会降低谱条件数，而当 $\\alpha$ 接近 $1$ 时，这种降低应该是微小的。\n\n5) 实现一个程序，对于固定的维度 $n$和几个 $\\alpha$ 的测试值，构造所描述的 $T_{\\mathrm{raw}}$ 和 $T_{\\mathrm{bal}}$，计算它们的谱条件数 $\\kappa_{2}\\big(T_{\\mathrm{raw}}\\big)$ 和 $\\kappa_{2}\\big(T_{\\mathrm{bal}}\\big)$，并输出一个定义为\n$$\n\\rho(\\alpha) = \\frac{\\kappa_{2}\\big(T_{\\mathrm{raw}}(\\alpha)\\big)}{\\kappa_{2}\\big(T_{\\mathrm{bal}}(\\alpha)\\big)}.\n$$\n的定量改进因子。值 $\\rho(\\alpha) > 1$ 表示平衡操作降低了条件数。\n\n使用以下测试套件，其设计旨在以数值稳定的方式探测不同的区间和边界情况：\n\n- 维度 $n = 5$。\n- 测试值 $\\alpha \\in \\{\\,1.1,\\,2.0,\\,5.0,\\,10.0,\\,0.5\\,\\}$。\n\n你的程序必须为上述每个 $\\alpha$ 计算 $\\rho(\\alpha)$，并打印所有五个值，保留6位小数。\n\n最终输出格式要求：你的程序应生成单行输出，包含5个结果，以逗号分隔并用方括号括起，顺序与上面列出的 $\\alpha$ 顺序相同，例如，形如 $[r_{1},r_{2},r_{3},r_{4},r_{5}]$ 的一行，其中每个 $r_{i}$ 是一个最多有6位小数的十进制数。\n\n本问题中所有数值均为无量纲，因此不需要物理单位。唯一允许的数值线性代数运算是标准数值库中提供的运算；不要假设进行符号计算。", "solution": "该问题经评估为有效。这是一个在数值控制理论领域内适定的、有科学依据的问题，没有矛盾或含糊之处。我现在将提供一个完整的解答。\n\n解答分为四个部分，对应于理论任务，随后是实现部分。\n\n**第1部分：相似变换的条件数**\n\n相似变换 $x = Tz$ 是从状态向量 $x$到新状态向量 $z$ 的坐标变换。其逆变换为 $z = T^{-1}x$。此运算的数值稳定性由矩阵 $T$ 的条件数决定。非奇异矩阵 $T$ 在谱范数（或2-范数）下的条件数定义为 $\\kappa_2(T) = \\lVert T \\rVert_2 \\lVert T^{-1} \\rVert_2$。该数值量化了求解线性系统时相对误差的最大放大率。对于坐标变换 $z = T^{-1}x$，$x$ 中的小扰动 $\\Delta x$ 可能导致 $z$ 中的扰动 $\\Delta z$，其边界由以下不等式给出：\n$$ \\frac{\\lVert \\Delta z \\rVert_2}{\\lVert z \\rVert_2} \\le \\kappa_2(T) \\frac{\\lVert \\Delta x \\rVert_2}{\\lVert x \\rVert_2} $$\n一个大的条件数，$\\kappa_2(T) \\gg 1$，表示一个病态变换。在这种情况下，$x$ 中的微小数值误差（例如，来自测量噪声或浮点表示的误差）可能被放大为变换后坐标 $z$ 中非常大的误差。这会损害在新基中执行的任何计算的数值可靠性，包括计算变换后的状态矩阵 $A_c = T^{-1}AT$。计算 $A_c$ 的误差也会被一个与 $\\kappa_2(T)$ 成比例的因子放大。\n\n条件数 $\\kappa_2(T)$ 也等于 $T$ 的最大奇异值与最小奇异值之比，即 $\\kappa_2(T) = \\sigma_{\\max}(T) / \\sigma_{\\min}(T)$。奇异值的巨大差异会导致病态。虽然奇异值不像列范数那样容易检查，但一个各列数量级差异巨大的矩阵是病态的强力指标。直观地看，这样的矩阵在空间中对某些方向进行极端拉伸，而对其他方向进行极端压缩，这是病态的几何根源。\n\n所提出的列平衡是一种有原则的启发式方法，用以改善条件数。矩阵 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}} D^{-1}$ 是通过将 $T_{\\mathrm{raw}}$ 右乘一个对角矩阵 $D = \\operatorname{diag}(\\lVert c_1 \\rVert_2, \\dots, \\lVert c_n \\rVert_2)$ 的逆矩阵而构成的。此操作将 $T_{\\mathrm{raw}}$ 的每一列 $c_k$ 缩放至单位欧几里得范数，即 $T_{\\mathrm{bal}}$ 的列为 $c'_k = c_k / \\lVert c_k \\rVert_2$。这个过程称为列平衡，它直接解决了基向量数量级上的巨大差异。通过使所有基向量具有相同的“尺度”，我们减少了病态最常见的来源之一。Van der Sluis 的定理为此提供了形式化的理由，该定理指出，对于一个矩阵 $A$，最优列缩放后矩阵的条件数在所有可能的列缩放中可达到的最小条件数的 $\\sqrt{n}$ 因子范围内。因此，在这类预处理中，使列范数相等是一种近似最优的策略。\n\n**第2部分：参数化族的能控性**\n\n给定状态矩阵 $A(\\alpha) = \\operatorname{diag}(1, \\alpha, \\alpha^2, \\dots, \\alpha^{n-1})$ 和输入向量 $b(\\alpha) = \\mathbf{1}_n$，其中 $\\mathbf{1}_n$ 是 $n \\times 1$ 的全1向量。如果能控性矩阵 $C(A,b) = [\\,b, Ab, \\dots, A^{n-1}b\\,]$ 满秩，即非奇异，则系统是能控的。\n\n让我们构造 $C(A,b)$ 的各列。第 $k$ 列是 $c_k = A^{k-1}b$，其中 $k \\in \\{1, \\dots, n\\}$。\n由于 $A$ 是一个对角矩阵，所以 $A^m = \\operatorname{diag}(1^m, \\alpha^m, (\\alpha^2)^m, \\dots, (\\alpha^{n-1})^m)$。\n我们用下标 $i$ 表示向量的第 $i$ 个分量，其中 $i \\in \\{1, \\dots, n\\}$。\n第 $k$ 列向量 $c_k$ 的第 $i$ 个分量是：\n$$ (c_k)_i = (A^{k-1}b)_i = (A_{ii})^{k-1} b_i $$\n给定 $A_{ii} = \\alpha^{i-1}$ 和 $b_i=1$，我们有：\n$$ (c_k)_i = (\\alpha^{i-1})^{k-1} \\cdot 1 = \\alpha^{(i-1)(k-1)} $$\n这是能控性矩阵的第 $i$ 行、第 $k$ 列的元素 $C_{ik}$。\n完整的矩阵是：\n$$ C(A(\\alpha), b(\\alpha)) = \\begin{pmatrix}\n1 & 1 & 1 & \\dots & 1 \\\\\n1 & \\alpha & \\alpha^2 & \\dots & \\alpha^{n-1} \\\\\n1 & \\alpha^2 & (\\alpha^2)^2 & \\dots & (\\alpha^2)^{n-1} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & \\alpha^{n-1} & (\\alpha^{n-1})^2 & \\dots & (\\alpha^{n-1})^{n-1}\n\\end{pmatrix} $$\n这是一个范德蒙矩阵。令节点为 $x_i = \\alpha^{i-1}$，其中 $i \\in \\{1, \\dots, n\\}$。则矩阵为 $C_{ik} = (x_i)^{k-1}$。这种矩阵的行列式由其节点差的乘积给出：\n$$ \\det(C) = \\prod_{1 \\le i < j \\le n} (x_j - x_i) = \\prod_{1 \\le i < j \\le n} (\\alpha^{j-1} - \\alpha^{i-1}) $$\n行列式非零当且仅当所有节点 $x_i$ 都互不相同。节点为 $x_1 = \\alpha^0 = 1$, $x_2 = \\alpha^1$, $x_3 = \\alpha^2$, ..., $x_n = \\alpha^{n-1}$。为了使这些节点互不相同，需要对于任何 $0 \\le p < q \\le n-1$ 都有 $\\alpha^p \\neq \\alpha^q$。由于问题规定 $\\alpha \\in \\mathbb{R}_{>0}$，仅当 $\\alpha=1$ 时此条件才不满足。问题指定了 $\\alpha \\neq 1$。\n因此，对于任何 $\\alpha > 0$ 且 $\\alpha \\neq 1$，所有节点 $x_i$ 均不相同，$\\det(C) \\neq 0$，且矩阵 $C(A(\\alpha), b(\\alpha))$ 是非奇异的。这证明了系统对 $(A(\\alpha), b(\\alpha))$ 是能控的。\n\n**第3部分：列范数的闭式表达式**\n\n我们寻求 $C(A(\\alpha), b(\\alpha))$ 第 $k$ 列的欧几里得范数平方 $\\lVert c_k \\rVert_2^2$ 的闭式表达式。\n如前所述，$c_k$ 的第 $i$ 个分量是 $(c_k)_i = \\alpha^{(i-1)(k-1)}$。\n范数平方是其分量的平方和：\n$$ \\lVert c_k \\rVert_2^2 = \\sum_{i=1}^{n} \\left( \\alpha^{(i-1)(k-1)} \\right)^2 = \\sum_{i=1}^{n} \\alpha^{2(i-1)(k-1)} = \\sum_{j=0}^{n-1} \\left( \\alpha^{2(k-1)} \\right)^j $$\n这是一个公比为 $r = \\alpha^{2(k-1)}$ 的几何级数。我们分析两种情况：\n\n情况1：$k = 1$。指数为 $k-1 = 0$，所以 $r = \\alpha^0 = 1$。和为 $\\sum_{j=0}^{n-1} 1^j = n$。\n因此，$\\lVert c_1 \\rVert_2^2 = n$。这是正确的，因为 $c_1=b=\\mathbf{1}_n$。\n\n情况2：$k \\in \\{2, \\dots, n\\}$。由于 $\\alpha \\neq 1$，公比 $r = \\alpha^{2(k-1)} \\neq 1$。\n有限几何级数的和为 $\\sum_{j=0}^{n-1} r^j = \\frac{r^n - 1}{r - 1}$。代入 $r$：\n$$ \\lVert c_k \\rVert_2^2 = \\frac{(\\alpha^{2(k-1)})^n - 1}{\\alpha^{2(k-1)} - 1} = \\frac{\\alpha^{2n(k-1)} - 1}{\\alpha^{2(k-1)} - 1} $$\n结合两种情况，闭式表达式为：\n$$ \\lVert c_k \\rVert_2^2 = \\begin{cases} n & \\text{若 } k=1 \\\\ \\frac{\\alpha^{2n(k-1)} - 1}{\\alpha^{2(k-1)} - 1} & \\text{若 } k > 1 \\end{cases} $$\n现在我们分析其行为。\n- 如果 $\\alpha > 1$：公比 $r = \\alpha^{2(k-1)} > 1$。随着 $k$ 的增加，$r$ 增加，和式 $\\sum_{j=0}^{n-1}r^j$ 中的每一项都增长。因此，$\\lVert c_k \\rVert_2^2$ 随 $k$ 几何级数增长。对于大的 $\\alpha$、$n$ 和 $k$，$\\lVert c_k \\rVert_2^2 \\approx \\alpha^{2(n-1)(k-1)}$。这在第一列的范数 $\\sqrt{n}$ 和最后一列的范数之间造成了巨大的差异。\n- 如果 $0 < \\alpha < 1$：公比 $r = \\alpha^{2(k-1)}$ 在区间 $(0, 1)$ 内。随着 $k$ 的增加，$r$ 减小并趋近于 $0$。对于 $r \\in (0,1)$，和式 $\\sum_{j=0}^{n-1}r^j$ 是 $r$ 的递减函数，因此 $\\lVert c_k \\rVert_2^2$ 随 $k$ 的增加而衰减。范数从 $\\lVert c_1 \\rVert_2 = \\sqrt{n}$ 衰减到 $\\lVert c_n \\rVert_2 \\approx 1$。同样，对于大的 $n$，这是一个显著的差异。\n\n**第4部分：平衡有效性的论证**\n\n前面部分的结果为为什么列平衡对该系统应是有效的提供了清晰的论证。\n1. 在第1部分，我们确定了列范数差异巨大的变换矩阵很可能是病态的，而对列进行归一化是改善条件数的一种有原则的方法。\n2. 在第3部分，我们证明了对于族 $(A(\\alpha), b(\\alpha))$，只要参数 $\\alpha$ 显著不为 $1$（即 $\\alpha \\gg 1$ 或 $0 < \\alpha \\ll 1$），变换矩阵 $T_{\\mathrm{raw}} = C(A,b)$ 的列范数就会呈现出巨大的几何级数差异。\n3. 平衡过程构造了 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}} D^{-1}$，其各列保证具有单位欧几里得范数。这个过程直接解决了我们为 $T_{\\mathrm{raw}}$ 识别出的特定病态特征——列范数的巨大差异。因此，当 $\\alpha$ 远离 $1$ 时，预计 $\\kappa_2(T_{\\mathrm{bal}})$ 将远小于 $\\kappa_2(T_{\\mathrm{raw}})$，从而导致改进因子 $\\rho(\\alpha) > 1$。\n\n反之，当 $\\alpha$ 接近 $1$ 时，设 $\\alpha = 1 + \\epsilon$ 对于小的 $\\epsilon$。公比 $r = \\alpha^{2(k-1)} \\approx 1 + 2(k-1)\\epsilon$。使用几何级数求和公式，并在 $r \\to 1$ 时应用洛必达法则或泰勒展开，我们发现 $\\frac{r^n-1}{r-1} \\to n$。因此，对于 $\\alpha \\approx 1$，我们有 $\\lVert c_k \\rVert_2^2 \\approx n$ 对于所有 $k \\in \\{1, \\dots, n\\}$。\n在这种情况下，$T_{\\mathrm{raw}}$ 的各列已经近似平衡。缩放矩阵 $D$ 接近一个标量矩阵，$D \\approx \\sqrt{n}I$。平衡后的矩阵 $T_{\\mathrm{bal}} = T_{\\mathrm{raw}}D^{-1} \\approx \\frac{1}{\\sqrt{n}} T_{\\mathrm{raw}}$。由于条件数对于标量乘法是不变的，所以 $\\kappa_2(T_{\\mathrm{bal}}) \\approx \\kappa_2(T_{\\mathrm{raw}})$。改进因子 $\\rho(\\alpha)$ 将接近 $1$，表明条件数的降低是微小或可以忽略的，正如预期的那样。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the condition number improvement factor rho for a parametrized\n    family of LTI systems after column-balancing the controllability matrix.\n    \"\"\"\n    n = 5\n    alphas = [1.1, 2.0, 5.0, 10.0, 0.5]\n    \n    results = []\n    \n    for alpha in alphas:\n        # Construct the raw transformation matrix T_raw.\n        # The entry at (i, k) is (alpha**i)**k for 0-based indices i, k.\n        # This can be vectorized as alpha**(i_vec * k_vec).\n        i_vec = np.arange(n, dtype=float).reshape(n, 1)\n        k_vec = np.arange(n, dtype=float).reshape(1, n)\n        T_raw = np.power(alpha, i_vec * k_vec)\n        \n        # Compute the spectral condition number of T_raw.\n        # The condition number is the ratio of the largest to smallest singular values.\n        cond_raw = np.linalg.cond(T_raw)\n        \n        # Construct the balanced transformation matrix T_bal.\n        # 1. Compute the Euclidean norm of each column of T_raw.\n        col_norms = np.linalg.norm(T_raw, axis=0)\n        \n        # 2. Scale each column to have unit norm.\n        # Avoid division by zero, although it won't happen here since b is non-zero\n        # and A is nonsingular.\n        # The broadcasting T_raw / col_norms is equivalent to T_raw @ diag(1/col_norms).\n        T_bal = T_raw / col_norms\n        \n        # Compute the spectral condition number of T_bal.\n        cond_bal = np.linalg.cond(T_bal)\n        \n        # Calculate the improvement factor rho.\n        if cond_bal > 0:\n            rho = cond_raw / cond_bal\n        else:\n            # Handle cases of extremely well-conditioned or singular matrices,\n            # though not expected for this problem's parameters.\n            rho = np.inf if cond_raw > 0 else 1.0\n\n        results.append(rho)\n        \n    # Format the final output string as per requirements.\n    # Each result is rounded to 6 decimal places.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2697100"}]}