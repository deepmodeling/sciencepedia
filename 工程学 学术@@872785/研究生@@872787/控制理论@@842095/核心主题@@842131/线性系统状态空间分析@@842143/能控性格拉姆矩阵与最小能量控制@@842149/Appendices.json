{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，以建立对可控性格拉姆矩阵的直观理解。通过为简单的一阶稳定系统推导无限时域可控性格拉姆矩阵 [@problem_id:2696864]，我们将清晰地看到这个数学工具如何量化地捕捉系统的物理特性。这个实践将阐明格拉姆矩阵、系统的固有稳定性、输入耦合强度以及最小控制能量之间的直接关系。", "problem": "考虑由 $\\dot{x}(t)=-a\\,x(t)+b\\,u(t)$ 给出的标量线性时不变（LTI）系统，其中 $a>0$ 且 $b \\neq 0$。仅使用第一性原理和控制理论的核心定义，推导与该系统相关的无穷时域能控性格拉姆矩阵 $W_{c}$。您的推导必须从有限时域能控性格拉姆矩阵和状态转移算子的定义出发，然后在适当之处取无穷时域极限，并证明其存在性条件。然后，根据时间范围增长时达到给定状态所需的最小能量，解释 $W_{c}$ 如何依赖于 $a$ 和 $b$，并说明为何您所得到的依赖关系与系统的稳定性和输入耦合特性相符。\n\n请以关于 $a$ 和 $b$ 的闭式表达式形式，提供您最终的能控性格拉姆矩阵答案。不需要数值近似，也不需要单位。最终答案必须是单个闭式表达式。", "solution": "该问题陈述经评估确定为有效。它在科学上基于线性控制理论的原理，具有充分且一致的条件，是一个适定问题，并且陈述客观。该问题要求推导一个稳定、标量、线性时不变系统的无穷时域能控性格拉姆矩阵并对结果进行解释，这是该领域中一个标准且有意义的练习。\n\n该系统由以下标量线性时不变（LTI）微分方程描述：\n$$ \\dot{x}(t) = -a \\, x(t) + b \\, u(t) $$\n其中状态为 $x(t) \\in \\mathbb{R}$，控制输入为 $u(t) \\in \\mathbb{R}$，参数满足 $a > 0$ 和 $b \\neq 0$。这对应于标准的状态空间形式 $\\dot{x}(t) = Ax(t) + Bu(t)$，其中标量矩阵为 $A = -a$ 和 $B = b$。\n\nLTI系统的状态转移算子（在此标量情况下为矩阵）由矩阵指数 $\\Phi(t) = \\exp(At)$ 给出。对于该系统，由于 $A = -a$，状态转移算子为：\n$$ \\Phi(t) = \\exp(-at) $$\n\n在时间区间 $[0, t_f]$ 上的有限时域能控性格拉姆矩阵 $W_c(t_f)$ 由以下积分定义：\n$$ W_c(t_f) = \\int_0^{t_f} \\exp(A\\tau) B B^T \\exp(A^T\\tau) \\, d\\tau $$\n由于系统是标量的，矩阵 $A$ 和 $B$ 与其转置相等，即 $A^T = A = -a$ 且 $B^T = B = b$。将这些代入定义中得到：\n$$ W_c(t_f) = \\int_0^{t_f} \\exp(-a\\tau) (b)(b) \\exp(-a\\tau) \\, d\\tau $$\n$$ W_c(t_f) = \\int_0^{t_f} b^2 \\exp(-2a\\tau) \\, d\\tau $$\n$b^2$ 项是常数，可以提到积分外面：\n$$ W_c(t_f) = b^2 \\int_0^{t_f} \\exp(-2a\\tau) \\, d\\tau $$\n计算这个基本积分得到：\n$$ W_c(t_f) = b^2 \\left[ \\frac{\\exp(-2a\\tau)}{-2a} \\right]_0^{t_f} $$\n$$ W_c(t_f) = b^2 \\left( \\frac{\\exp(-2at_f)}{-2a} - \\frac{\\exp(0)}{-2a} \\right) $$\n$$ W_c(t_f) = \\frac{b^2}{-2a} (\\exp(-2at_f) - 1) = \\frac{b^2}{2a} (1 - \\exp(-2at_f)) $$\n\n无穷时域能控性格拉姆矩阵（记为 $W_c$）通过取时间范围 $t_f$ 趋于无穷时 $W_c(t_f)$ 的极限得到：\n$$ W_c = \\lim_{t_f \\to \\infty} W_c(t_f) = \\lim_{t_f \\to \\infty} \\left[ \\frac{b^2}{2a} (1 - \\exp(-2at_f)) \\right] $$\n该极限的存在性取决于 $\\exp(-2at_f)$ 项的收敛性。问题陈述中指出 $a > 0$。由于 $t_f \\to \\infty$，指数 $-2at_f$ 趋向于 $-\\infty$。因此，指数项收敛到零：\n$$ \\lim_{t_f \\to \\infty} \\exp(-2at_f) = 0 $$\n因为系统是稳定的，所以这个收敛性得到保证。如果矩阵 $A$ 的所有特征值都具有负实部，则系统 $\\dot{x}=Ax$ 是稳定的。此处，$A=-a$ 的单个特征值恰好是 $-a$，因为 $a > 0$，所以该特征值为负。对于任何能控系统，当且仅当系统稳定时，无穷时域能控性格拉姆矩阵才存在。\n代入指数项的极限，我们得到无穷时域格拉姆矩阵：\n$$ W_c = \\frac{b^2}{2a} (1 - 0) = \\frac{b^2}{2a} $$\n该结果可以通过求解 $W_c$ 的连续时间代数李雅普诺夫方程 $AW_c + W_cA^T = -BB^T$ 来验证。对于该系统，方程变为 $(-a)W_c + W_c(-a) = -(b)(b)$，化简为 $-2aW_c = -b^2$，得到 $W_c = \\frac{b^2}{2a}$，这证实了我们的推导。\n\n现在，我们来解释这个结果。能控性格拉姆矩阵对于确定将系统从原点驱动到目标状态 $x_f$ 所需的最小控制能量至关重要。对于一个一般的LTI系统，在无穷时域上的最小能量由 $E_{min} = x_f^T W_c^{-1} x_f$ 给出。对于我们的标量系统，这变为：\n$$ E_{min} = x_f W_c^{-1} x_f = x_f^2 W_c^{-1} $$\n使用我们推导出的 $W_c$ 表达式，其逆为：\n$$ W_c^{-1} = \\left(\\frac{b^2}{2a}\\right)^{-1} = \\frac{2a}{b^2} $$\n因此，达到状态 $x_f$ 所需的最小能量为：\n$$ E_{min} = x_f^2 \\left( \\frac{2a}{b^2} \\right) $$\n\n我们分析其对 $a$ 和 $b$ 的依赖关系：\n1.  **对 $b$ 的依赖性（输入耦合）：** 最小能量 $E_{min}$ 与 $b^2$ 成反比。参数 $b$ 量化了控制输入 $u(t)$ 对状态动态的影响强度。$b$ 的量值越大，意味着控制能力越强。这意味着对于一个更大的 $|b|$，系统“更容易”控制，因此将状态驱动到期望值 $x_f$ 所需的能量更少。推导出的关系 $E_{min} \\propto 1/b^2$ 与这种物理直觉完全一致。\n\n2.  **对 $a$ 的依赖性（系统稳定性）：** 最小能量 $E_{min}$ 与 $a$ 成正比。参数 $a$ 决定了系统的固有稳定性；系统极点位于 $s = -a$。$a$ 值越大，对应的系统越稳定，这意味着它有更强的自然趋势返回到平衡状态 $x=0$。为了将状态驱动到一个非零值 $x_f$，控制输入必须对抗这种强大的恢复“力”（由项 $-ax(t)$ 表示）。因此，一个更稳定的系统（更大的 $a$）“更难”从原点推开，需要消耗更多的控制能量。正比关系 $E_{min} \\propto a$ 正确地反映了这一物理特性。\n\n总之，$W_c = \\frac{b^2}{2a}$ 这个表达式以及由此产生的能量依赖关系，与系统稳定性和输入耦合的基本特性精确一致。", "answer": "$$ \\boxed{\\frac{b^2}{2a}} $$", "id": "2696864"}, {"introduction": "从连续时间系统转向离散时间系统，是理解现代数字控制的关键一步。这个练习 [@problem_id:2696874] 将处理一个离散积分器的有限时域格拉姆矩阵计算，这是数字系统中的一个基本模型。你将从第一性原理出发，推导在固定步数内达到特定状态所需的最小能量，从而在格拉姆矩阵与约束优化问题之间建立起坚实的联系。", "problem": "考虑由 $x_{k+1}=x_{k}+u_{k}$ 给出的标量、离散时间、线性时不变 (LTI) 系统，其初始条件为 $x_{0}=0$。设 $N \\in \\mathbb{N}$ 为一个固定的有限时域，并设 $x_{f} \\in \\mathbb{R}$ 为时刻 $k=N$ 时的指定终端状态值。该时域内的输入能量由二次代价 $J=\\sum_{k=0}^{N-1} u_{k}^{2}$ 定义。仅使用有限时域可达性和有限时域能控性格拉姆矩阵的基本定义，完成以下任务：\n- 计算有限时域能控性格拉姆矩阵 $W_{c}(N)$。\n- 从第一性原理出发，确定在恰好 $N$ 步内从 $x_{0}=0$ 达到 $x_{N}=x_{f}$ 所需的最小能量 $J$。\n\n将您的最终结果表示为包含两个闭式表达式的单行：首先是 $W_{c}(N)$，其次是作为 $x_{f}$ 和 $N$ 函数的最小能量。本问题不需要数值近似，最终答案中也不需要单位。", "solution": "我们对问题陈述进行了审慎分析，认定其有效。这是一个在离散时间线性控制理论领域内提法恰当、具有科学依据的问题。所有必要的数据和条件均已提供，不存在内部矛盾或歧义。该问题要求应用基本原理，这是一项严谨且有意义的练习。我们可以开始求解。\n\n所考虑的系统是由以下状态方程描述的标量、离散时间、线性时不变 (LTI) 系统：\n$$x_{k+1} = x_{k} + u_{k}$$\n该系统属于一般形式 $x_{k+1} = Ax_{k} + Bu_{k}$，其中状态 $x_{k}$ 和输入 $u_{k}$ 均为标量。通过比较，我们确定系统矩阵为 $A=1$ 和 $B=1$。给定的初始条件为 $x_{0}=0$。\n\n第一个目标是计算给定有限时域 $N \\in \\mathbb{N}$ 下的能控性格拉姆矩阵 $W_{c}(N)$。在 $N$ 步时域内的离散时间能控性格拉姆矩阵的定义为：\n$$W_{c}(N) = \\sum_{k=0}^{N-1} A^{N-k-1} B B^{T} (A^{N-k-1})^{T}$$\n将标量值 $A=1$ 和 $B=1$ 代入此定义，我们注意到转置没有影响。表达式变为：\n$$W_{c}(N) = \\sum_{k=0}^{N-1} (1)^{N-k-1} (1) (1) ((1)^{N-k-1})$$\n$$W_{c}(N) = \\sum_{k=0}^{N-1} 1^{2(N-k-1)}$$\n由于 $N$ 和 $k$ 是整数，指数 $2(N-k-1)$ 是一个整数。1的任何整数次幂都等于1。因此，求和中的每一项都是1。该和由 $N$ 个这样的项组成（从 $k=0$ 到 $k=N-1$）。\n$$W_{c}(N) = \\sum_{k=0}^{N-1} 1 = N$$\n因此，能控性格拉姆矩阵就是时域长度 $N$。\n\n第二个目标是确定在恰好 $N$ 步内将系统从初始状态 $x_{0}=0$ 驱动到指定终端状态 $x_{N}=x_{f}$ 所需的最小能量 $J = \\sum_{k=0}^{N-1} u_{k}^{2}$。我们将从第一性原理推导这个结果。\n\n首先，我们将终端状态 $x_{N}$ 表示为控制输入序列 $\\{u_{k}\\}_{k=0}^{N-1}$ 的函数。我们可以递归地展开状态方程：\n$$x_{1} = x_{0} + u_{0} = u_{0}$$\n$$x_{2} = x_{1} + u_{1} = u_{0} + u_{1}$$\n$$x_{3} = x_{2} + u_{2} = u_{0} + u_{1} + u_{2}$$\n通过归纳法，时刻 $k=N$ 的状态是直到时刻 $k=N-1$ 所施加的所有控制输入的总和：\n$$x_{N} = \\sum_{k=0}^{N-1} u_{k}$$\n问题指定了终端约束 $x_{N}=x_{f}$。这给了我们可达性约束：\n$$\\sum_{k=0}^{N-1} u_{k} = x_{f}$$\n我们必须找到满足此线性约束并使代价函数 $J = \\sum_{k=0}^{N-1} u_{k}^{2}$ 最小化的控制序列 $\\{u_{k}\\}$。这是一个约束优化问题。我们采用拉格朗日乘子法。拉格朗日函数 $\\mathcal{L}$ 定义为：\n$$\\mathcal{L}(u_{0}, u_{1}, \\dots, u_{N-1}, \\lambda) = \\sum_{k=0}^{N-1} u_{k}^{2} - \\lambda \\left( \\left( \\sum_{k=0}^{N-1} u_{k} \\right) - x_{f} \\right)$$\n为求极值，$\\mathcal{L}$ 对每个控制输入 $u_{k}$ 的偏导数必须为零。对于任何 $j \\in \\{0, 1, \\dots, N-1\\}$：\n$$\\frac{\\partial \\mathcal{L}}{\\partial u_{j}} = 2u_{j} - \\lambda = 0$$\n这意味着 $u_{j} = \\frac{\\lambda}{2}$。这对所有 $j$ 都必须成立，也就是说最优控制输入彼此相等：\n$$u_{0}^{*} = u_{1}^{*} = \\dots = u_{N-1}^{*} = \\frac{\\lambda}{2}$$\n现在，我们使用约束来确定拉格朗日乘子 $\\lambda$ 的值。将最优控制形式代入约束方程：\n$$\\sum_{k=0}^{N-1} \\frac{\\lambda}{2} = x_{f}$$\n$$N \\left( \\frac{\\lambda}{2} \\right) = x_{f}$$\n求解 $\\lambda$，我们得到：\n$$\\lambda = \\frac{2x_{f}}{N}$$\n将此结果代回最优控制输入的表达式中，得到：\n$$u_{k}^{*} = \\frac{1}{2} \\left( \\frac{2x_{f}}{N} \\right) = \\frac{x_{f}}{N} \\quad \\text{for } k=0, 1, \\dots, N-1$$\n最后，我们将此最优控制序列代入代价函数，计算最小能量 $J_{min}$：\n$$J_{min} = \\sum_{k=0}^{N-1} (u_{k}^{*})^{2} = \\sum_{k=0}^{N-1} \\left( \\frac{x_{f}}{N} \\right)^{2}$$\n由于求和内的项相对于索引 $k$ 是常数，我们有：\n$$J_{min} = N \\left( \\frac{x_{f}}{N} \\right)^{2} = N \\frac{x_{f}^{2}}{N^{2}} = \\frac{x_{f}^{2}}{N}$$\n这个结果与最小能量控制的通用公式 $J_{min} = x_{f}^{T} W_{c}(N)^{-1} x_{f}$ 一致。在我们的标量情况下，$x_{f}^{T}$ 就是 $x_{f}$，且 $W_{c}(N)^{-1} = N^{-1} = \\frac{1}{N}$，得出 $x_{f} (\\frac{1}{N}) x_{f} = \\frac{x_{f}^{2}}{N}$。\n\n所需的两个表达式是 $W_{c}(N) = N$ 和最小能量 $J_{min} = \\frac{x_{f}^{2}}{N}$。", "answer": "$$\\boxed{N, \\quad \\frac{x_f^2}{N}}$$", "id": "2696874"}, {"introduction": "现实世界中的系统往往不是完全可控的。这个实践 [@problem_id:2696846] 深入探讨了这种关键情况，通过分析一个具有不可控模式的系统，其可控性格拉姆矩阵是奇异的。你将学习如何精确地确定可达状态集，然后将最小能量控制框架应用于一个位于此受限子空间内的目标，从而揭示格拉姆矩阵在实践中的威力与局限。", "problem": "考虑一个状态维数为 $3$、单输入的线性时不变 (LTI) 系统，其描述如下\n$$\n\\dot{x}(t) = A\\,x(t) + b\\,u(t), \\quad x(0)=0,\n$$\n其中\n$$\nA=\\begin{pmatrix}\n0  0  0\\\\\n0  -1  0\\\\\n0  0  2\n\\end{pmatrix},\n\\qquad\nb=\\begin{pmatrix}\n1\\\\\n1\\\\\n0\n\\end{pmatrix},\n$$\n控制 $u$ 在固定时域 $[0,T]$ 上是平方可积的。设 $T=\\ln 2$。本题旨在研究有限时间可达子空间以及在时间 $T$ 将系统转移到指定终端状态的最小能量问题。\n\n仅使用线性系统中可达性和能量的基本定义，不假定任何关于可控性格拉姆矩阵或最优控制的预先给定的公式，完成以下任务：\n\n1. 判断系统在 $[0,T]$ 上是否可控。如果不可控，请确定在时域 $T$ 上的一个非平凡有限时间可达子空间，并从第一性原理证明您的论断。\n\n2. 推导在时间 $T$ 的有限时域可控性格拉姆矩阵，并通过刻画其值域来严格证明您在第1部分中的结论。解释为什么在此示例中，该格拉姆矩阵是奇异但非零的。\n\n3. 在所有能将系统从 $x(0)=0$ 驱动到终端状态\n$$\nx(T)=x_f=\\begin{pmatrix}1\\\\ 0\\\\ 0\\end{pmatrix}\n$$\n的、在 $[0,T]$ 上的平方可积输入 $u$ 中，计算最小输入能量\n$$\n\\int_{0}^{T} u(t)^{2}\\,dt\n$$\n的精确闭合形式。\n\n将您的最终答案表示为单一的精确解析表达式，不带单位。请勿对最终表达式进行近似或四舍五入。", "solution": "在尝试解答之前，将对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题为一个线性时不变 (LTI) 系统提供了以下信息：\n- 状态方程：$\\dot{x}(t) = A\\,x(t) + b\\,u(t)$\n- 系统矩阵：\n  $$A=\\begin{pmatrix} 0  0  0\\\\ 0  -1  0\\\\ 0  0  2 \\end{pmatrix}, \\qquad b=\\begin{pmatrix} 1\\\\ 1\\\\ 0 \\end{pmatrix}$$\n- 状态维数：$n=3$，单输入：$m=1$。\n- 初始条件：$x(0)=0$。\n- 控制输入：$u(t)$ 是在 $[0,T]$ 上的平方可积函数。\n- 时间范围：$T = \\ln 2$。\n- 第3部分的终端状态：\n  $$x_f = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$$\n- 第3部分的目标：计算最小输入能量 $\\int_{0}^{T} u(t)^{2}\\,dt$。\n- 约束：推导过程必须仅使用基本定义，且不得假定关于格拉姆矩阵或最优控制的预先给定的公式。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学合理性**：该问题是线性控制理论中的一个标准练习，基于微分方程和系统动力学的基本原理。所有数学对象都有明确的定义。该问题是科学有效的。\n- **适定性**：问题的结构旨在测试对一个不可控系统的可达性、可控性格拉姆矩阵和最小能量控制的理解。第1部分要求刻画可达子空间。第2部分要求计算格拉姆矩阵，这是进行此种刻画的工具。第3部分要求计算到达特定状态 $x_f$ 的最小能量。只有当 $x_f$ 位于可达子空间内时，这部分才是适定的。这一条件必须作为解答的一部分进行验证，这是一个标准程序，并不会使问题陈述本身无效。\n- **客观性**：问题以精确、客观的数学语言陈述。\n- **完整性与一致性**：系统被完全指定（矩阵 $A, b$，初始状态 $x(0)$），并给定了时间范围 $T$。没有缺失或矛盾的条件。\n- **其他缺陷**：该问题不是隐喻性的、无关紧要的，也不在科学验证的范围之外。它直接探讨了可控性和最小能量的主题。\n\n**步骤3：结论与行动**\n\n该问题被认定为**有效**。这是一个形式良好的控制理论问题，要求从第一性原理进行推导。现在将提供完整的解答。\n\n### 解答\n\n对于给定的初始条件为 $x(0)=0$ 的 LTI 系统，其解由常数变易法公式给出：\n$$x(t) = \\int_{0}^{t} e^{A(t-\\tau)} b u(\\tau) d\\tau$$\n在时间 $T$ 可达的所有状态的集合称为在时间 $T$ 的可达子空间 $\\mathcal{R}_T$。\n\n**1. 可控性与可达子空间**\n\n如果 $\\mathcal{R}_T = \\mathbb{R}^3$，则系统在 $[0,T]$ 上是可控的。为了确定 $\\mathcal{R}_T$，我们必须首先计算状态转移矩阵 $e^{At}$。由于 $A$ 是一个对角矩阵，其矩阵指数可以通过对其对角元素求指数得到：\n$$A = \\begin{pmatrix} 0  0  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\end{pmatrix} \\implies e^{At} = \\begin{pmatrix} e^{0t}  0  0 \\\\ 0  e^{-t}  0 \\\\ 0  0  e^{2t} \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  e^{-t}  0 \\\\ 0  0  e^{2t} \\end{pmatrix}$$\n从原点可达的状态 $x(T)$ 为\n$$x(T) = \\int_{0}^{T} e^{A(T-\\tau)} b u(\\tau) d\\tau$$\n项 $e^{A(T-\\tau)}b$ 为\n$$e^{A(T-\\tau)}b = \\begin{pmatrix} 1  0  0 \\\\ 0  e^{-(T-\\tau)}  0 \\\\ 0  0  e^{2(T-\\tau)} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ e^{-(T-\\tau)} \\\\ 0 \\end{pmatrix}$$\n因此，任何可达状态 $x(T)$ 都具有以下形式：\n$$x(T) = \\int_{0}^{T} \\begin{pmatrix} 1 \\\\ e^{-(T-\\tau)} \\\\ 0 \\end{pmatrix} u(\\tau) d\\tau = \\begin{pmatrix} \\int_{0}^{T} u(\\tau) d\\tau \\\\ \\int_{0}^{T} e^{-(T-\\tau)} u(\\tau) d\\tau \\\\ 0 \\end{pmatrix}$$\n对于任何平方可积控制 $u(t)$ 的选择，任何可达状态 $x(T)$ 的第三个分量恒为零。这意味着可达子空间 $\\mathcal{R}_T$ 是 $\\mathbb{R}^3$ 的一个真子空间。具体来说，任何可达状态都必须位于由向量 $e_1 = (1,0,0)^T$ 和 $e_2 = (0,1,0)^T$ 张成的平面内。\n因此，可达子空间为 $\\mathcal{R}_T = \\text{span} \\{e_1, e_2\\}$。由于 $\\mathcal{R}_T \\neq \\mathbb{R}^3$，该系统是**不可控的**。在时域 $T$ 内的非平凡有限时间可达子空间是所有形如 $(c_1, c_2, 0)^T$ 的向量集合，其中 $c_1, c_2 \\in \\mathbb{R}$。\n\n**2. 可控性格拉姆矩阵**\n\n有限时域可控性格拉姆矩阵根据第一性原理定义为 $W_c(T) = \\int_{0}^{T} e^{At} b b^T e^{A^T t} dt$。由于 $A$ 是对称的（$A=A^T$），这等价于 $W_c(T) = \\int_{0}^{T} e^{At} b b^T e^{At} dt$。\n首先，我们计算乘积 $b b^T$：\n$$b b^T = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\\\ 1  1  0 \\\\ 0  0  0 \\end{pmatrix}$$\n接下来，我们计算被积函数 $e^{At} b b^T e^{At}$：\n$$e^{At} b b^T e^{At} = \\begin{pmatrix} 1  0  0 \\\\ 0  e^{-t}  0 \\\\ 0  0  e^{2t} \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 1  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  e^{-t}  0 \\\\ 0  0  e^{2t} \\end{pmatrix} = \\begin{pmatrix} 1  e^{-t}  0 \\\\ e^{-t}  e^{-2t}  0 \\\\ 0  0  0 \\end{pmatrix}$$\n现在，我们将此矩阵从 $t=0$ 积分到 $T=\\ln 2$：\n$$W_c(T) = \\int_{0}^{T} \\begin{pmatrix} 1  e^{-t}  0 \\\\ e^{-t}  e^{-2t}  0 \\\\ 0  0  0 \\end{pmatrix} dt = \\begin{pmatrix} \\int_{0}^{T} 1 dt  \\int_{0}^{T} e^{-t} dt  0 \\\\ \\int_{0}^{T} e^{-t} dt  \\int_{0}^{T} e^{-2t} dt  0 \\\\ 0  0  0 \\end{pmatrix}$$\n我们计算 $T=\\ln 2$ 时的积分值：\n- $\\int_{0}^{\\ln 2} 1 dt = [t]_{0}^{\\ln 2} = \\ln 2$\n- $\\int_{0}^{\\ln 2} e^{-t} dt = [-e^{-t}]_{0}^{\\ln 2} = -e^{-\\ln 2} - (-e^0) = -1/2 + 1 = 1/2$\n- $\\int_{0}^{\\ln 2} e^{-2t} dt = [-\\frac{1}{2}e^{-2t}]_{0}^{\\ln 2} = -\\frac{1}{2}e^{-2\\ln 2} - (-\\frac{1}{2}e^0) = -\\frac{1}{2}(1/4) + 1/2 = 3/8$\n代入这些值，格拉姆矩阵为：\n$$W_c(\\ln 2) = \\begin{pmatrix} \\ln 2  1/2  0 \\\\ 1/2  3/8  0 \\\\ 0  0  0 \\end{pmatrix}$$\n格拉姆矩阵的值域 $\\text{Range}(W_c(T))$ 即为可达子空间 $\\mathcal{R}_T$。$W_c(\\ln 2)$ 的列向量是 $(\\ln 2, 1/2, 0)^T$, $(1/2, 3/8, 0)^T$ 和 $(0, 0, 0)^T$。这些向量张成了 $xy$-平面，这正是在第1部分中找到的可达子空间 $\\mathcal{R}_T$。\n格拉姆矩阵是奇异的，因为其行列式明显为 $0$（由于存在零行和零列）。奇异的格拉姆矩阵表明系统是不可控的。格拉姆矩阵是非零的，因为可达子空间的维数（其秩）是 $2$，而不是 $0$。\n\n**3. 最小能量控制**\n\n我们希望找到将系统从 $x(0)=0$ 驱动到 $x_f = (1, 0, 0)^T$ 所需的最小能量 $J = \\int_{0}^{T} u(t)^2 dt$。首先，我们确认 $x_f$ 位于可达子空间 $\\mathcal{R}_T$ 中。由于 $x_f$ 的第三个分量为 $0$，它确实是可达的。\n\n该问题是在约束条件 $x_f = \\int_{0}^{T} e^{A(T-t)} b u(t) dt$ 下最小化范数 $\\|u\\|_{L^2}^2$。这是一个希尔伯特空间中的最小范数问题。解 $u^*(t)$ 必须是定义约束的函数的线性组合。该向量约束对应于两个标量约束：\n$$x_f = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\int_{0}^{T} \\begin{pmatrix} 1 \\\\ e^{-(T-t)} \\\\ 0 \\end{pmatrix} u(t) dt$$\n最优控制 $u^*(t)$ 必须位于由函数 $g_1(t)=1$ 和 $g_2(t)=e^{-(T-t)}$ 张成的子空间中。因此，其形式为：\n$$u^*(t) = c_1 \\cdot 1 + c_2 \\cdot e^{-(T-t)}$$\n其中 $c_1, c_2$ 为实常数。我们将其代入状态方程以求解 $c_1$ 和 $c_2$：\n$$\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\int_{0}^{T} \\begin{pmatrix} 1 \\\\ e^{-(T-t)} \\end{pmatrix} (c_1 + c_2 e^{-(T-t)}) dt$$\n$$\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} c_1 \\int_{0}^{T} dt + c_2 \\int_{0}^{T} e^{-(T-t)} dt \\\\ c_1 \\int_{0}^{T} e^{-(T-t)} dt + c_2 \\int_{0}^{T} e^{-2(T-t)} dt \\end{pmatrix}$$\n通过变量代换 $\\tau=T-t$，这些积分与为格拉姆矩阵计算的积分相同。方程组为：\n$$\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\ln 2  1/2 \\\\ 1/2  3/8 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$$\n我们只需要求解 $c_1$ 和 $c_2$。我们可以解这个方程组。由第二个方程， $c_1/2 + 3c_2/8 = 0 \\implies c_1 = -3c_2/4$。代入第一个方程：\n$$1 = (\\ln 2)(-\\frac{3}{4}c_2) + \\frac{1}{2}c_2 = c_2 (\\frac{1}{2} - \\frac{3}{4}\\ln 2) = c_2 \\frac{2 - 3\\ln 2}{4}$$\n因此， $c_2 = \\frac{4}{2 - 3\\ln 2}$，且 $c_1 = -\\frac{3}{4} \\left(\\frac{4}{2 - 3\\ln 2}\\right) = \\frac{-3}{2 - 3\\ln 2} = \\frac{3}{3\\ln 2 - 2}$。\n\n最小能量为 $J^* = \\int_{0}^{T} (u^*(t))^2 dt$：\n$$J^* = \\int_{0}^{T} (c_1 + c_2 e^{-(T-t)})^2 dt = \\int_{0}^{T} (c_1^2 + 2c_1c_2e^{-(T-t)} + c_2^2e^{-2(T-t)}) dt$$\n$$J^* = c_1^2 \\int_{0}^{T} dt + 2 c_1 c_2 \\int_{0}^{T} e^{-(T-t)} dt + c_2^2 \\int_{0}^{T} e^{-2(T-t)} dt$$\n这可以紧凑地写为：\n$$J^* = c_1 \\left( c_1 \\int_{0}^{T} dt + c_2 \\int_{0}^{T} e^{-(T-t)} dt \\right) + c_2 \\left( c_1 \\int_{0}^{T} e^{-(T-t)} dt + c_2 \\int_{0}^{T} e^{-2(T-t)} dt \\right)$$\n利用关于 $c_1, c_2$ 的线性系统，括号中的项分别为 $1$ 和 $0$：\n$$J^* = c_1(1) + c_2(0) = c_1$$\n因此，最小输入能量恰好是 $c_1$ 的值：\n$$J^* = \\frac{3}{3\\ln 2 - 2}$$\n分母 $3\\ln 2 - 2 = \\ln(8) - \\ln(e^2) = \\ln(8/e^2)$。由于 $e \\approx 2.718$，$e^2 \\approx 7.389$，所以 $8/e^2 > 1$ 且 $\\ln(8/e^2) > 0$。能量是正的，符合要求。", "answer": "$$\\boxed{\\frac{3}{3\\ln(2) - 2}}$$", "id": "2696846"}]}