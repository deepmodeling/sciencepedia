{"hands_on_practices": [{"introduction": "掌握矩阵指数的计算是理解线性动力系统的基础。此练习将引导您使用强大的 Cayley-Hamilton 定理，将矩阵指数 $e^{tA}$ 表示为一个关于矩阵 $A$ 的多项式，从而精确求解。这个方法不仅是一个重要的解析工具，尤其是在处理具有重根特征值的矩阵时，而且它也深刻地揭示了矩阵的代数结构与其指数函数之间的内在联系。[@problem_id:1156702]", "problem": "一个物理系统的状态由向量 $\\mathbf{x}(t) \\in \\mathbb{R}^3$ 描述，其随时间的演化遵循线性常微分方程组 $\\frac{d\\mathbf{x}}{dt} = A\\mathbf{x}$，其中 $A$ 是一个常数 $3 \\times 3$ 矩阵。该系统的解为 $\\mathbf{x}(t) = e^{tA}\\mathbf{x}(0)$，其中 $e^{tA}$ 是矩阵指数。\n\n计算 $n \\times n$ 矩阵 $A$ 的矩阵指数 $e^{tA}$ 的一种强大方法依赖于凯莱-哈密顿定理，该定理指出任何方阵都满足其自身的特征方程。该定理的一个推论是，$e^{tA}$ 可以表示为 $A$ 的一个次数最多为 $n-1$ 的多项式：\n$$e^{tA} = \\sum_{j=0}^{n-1} \\alpha_j(t) A^j$$\n标量系数 $\\alpha_j(t)$ 通过求解一个线性方程组来确定。这些方程是通过在上述表达式中将矩阵 $A$ 替换为其特征值 $\\lambda$ 生成的，即 $e^{t\\lambda} = \\sum_{j=0}^{n-1} \\alpha_j(t) \\lambda^j$。如果一个特征值 $\\lambda_k$ 的代数重数 $m_k  1$，则通过对 $\\lambda$ 求导（最高到 $m_k-1$ 阶）可以获得额外的方程。\n\n考虑一个由矩阵控制的系统：\n$$A = \\begin{pmatrix} 2  1  c \\\\ 0  2  d \\\\ 0  0  1 \\end{pmatrix}$$\n其中 $c$ 和 $d$ 是任意实数参数。\n\n使用凯莱-哈密顿定理方法，推导出状态转移矩阵 $e^{tA}$。", "solution": "问题是计算矩阵 $A = \\begin{pmatrix} 2  1  c \\\\ 0  2  d \\\\ 0  0  1 \\end{pmatrix}$ 的矩阵指数 $e^{tA}$。\n\n**步骤1：求 A 的特征值**\n\n特征多项式为 $p(\\lambda) = \\det(A - \\lambda I)$。\n$$p(\\lambda) = \\det \\begin{pmatrix} 2-\\lambda  1  c \\\\ 0  2-\\lambda  d \\\\ 0  0  1-\\lambda \\end{pmatrix} = (2-\\lambda)^2 (1-\\lambda)$$\n特征值是 $p(\\lambda)=0$ 的根。因此，我们有一个代数重数 $m_1 = 2$ 的特征值 $\\lambda_1 = 2$，以及一个代数重数 $m_2 = 1$ 的单特征值 $\\lambda_2 = 1$。\n\n**步骤2：建立系数 $\\alpha_j(t)$ 的方程组**\n\n由于 $A$ 是一个 $3 \\times 3$ 矩阵，$e^{tA}$ 可以写成 $A$ 的一个二次多项式：\n$$e^{tA} = \\alpha_0(t)I + \\alpha_1(t)A + \\alpha_2(t)A^2$$\n对应的标量方程是：\n$$e^{t\\lambda} = \\alpha_0(t) + \\alpha_1(t)\\lambda + \\alpha_2(t)\\lambda^2$$\n我们使用特征值来生成关于 $\\alpha_0, \\alpha_1, \\alpha_2$ 的方程组。\n\n对于单特征值 $\\lambda_2 = 1$：\n$$e^{t\\cdot 1} = \\alpha_0 + \\alpha_1(1) + \\alpha_2(1)^2 \\implies e^t = \\alpha_0 + \\alpha_1 + \\alpha_2 \\quad (1)$$\n\n对于重特征值 $\\lambda_1 = 2$（重数为2），我们得到两个方程。首先，使用特征值本身：\n$$e^{t\\cdot 2} = \\alpha_0 + \\alpha_1(2) + \\alpha_2(2)^2 \\implies e^{2t} = \\alpha_0 + 2\\alpha_1 + 4\\alpha_2 \\quad (2)$$\n其次，我们将标量方程对 $\\lambda$ 求导，然后在 $\\lambda=2$ 处求值：\n$$\\frac{d}{d\\lambda}(e^{t\\lambda}) = \\frac{d}{d\\lambda}(\\alpha_0 + \\alpha_1\\lambda + \\alpha_2\\lambda^2)$$\n$$t e^{t\\lambda} = \\alpha_1 + 2\\alpha_2\\lambda$$\n在 $\\lambda=2$ 处求值：\n$$t e^{2t} = \\alpha_1 + 2\\alpha_2(2) \\implies t e^{2t} = \\alpha_1 + 4\\alpha_2 \\quad (3)$$\n\n**步骤3：求解 $\\alpha_0(t)$、$\\alpha_1(t)$ 和 $\\alpha_2(t)$**\n\n我们得到一个三元线性方程组：\n1. $\\alpha_0 + \\alpha_1 + \\alpha_2 = e^t$\n2. $\\alpha_0 + 2\\alpha_1 + 4\\alpha_2 = e^{2t}$\n3. $\\alpha_1 + 4\\alpha_2 = t e^{2t}$\n\n从(3)式，我们可以用 $\\alpha_2$ 表示 $\\alpha_1$：\n$$\\alpha_1 = t e^{2t} - 4\\alpha_2$$\n将此式代入(1)和(2)。\n代入(2)式：\n$$\\alpha_0 + 2(t e^{2t} - 4\\alpha_2) + 4\\alpha_2 = e^{2t}$$\n$$\\alpha_0 + 2t e^{2t} - 8\\alpha_2 + 4\\alpha_2 = e^{2t} \\implies \\alpha_0 - 4\\alpha_2 = e^{2t} - 2t e^{2t} \\quad (4)$$\n代入(1)式：\n$$\\alpha_0 + (t e^{2t} - 4\\alpha_2) + \\alpha_2 = e^t$$\n$$\\alpha_0 - 3\\alpha_2 = e^t - t e^{2t} \\quad (5)$$\n\n现在我们求解由(4)和(5)组成的关于 $\\alpha_0$ 和 $\\alpha_2$ 的方程组。(5)式减去(4)式：\n$$(\\alpha_0 - 3\\alpha_2) - (\\alpha_0 - 4\\alpha_2) = (e^t - t e^{2t}) - (e^{2t} - 2t e^{2t})$$\n$$\\alpha_2 = e^t - e^{2t} + t e^{2t} = e^t + (t-1)e^{2t}$$\n现在求 $\\alpha_1$：\n$$\\alpha_1 = t e^{2t} - 4\\alpha_2 = t e^{2t} - 4(e^t + (t-1)e^{2t}) = t e^{2t} - 4e^t - 4t e^{2t} + 4e^{2t}$$\n$$\\alpha_1 = -4e^t + (4-3t)e^{2t}$$\n最后，使用(1)式求 $\\alpha_0$：\n$$\\alpha_0 = e^t - \\alpha_1 - \\alpha_2 = e^t - (-4e^t + (4-3t)e^{2t}) - (e^t + (t-1)e^{2t})$$\n$$\\alpha_0 = e^t + 4e^t - (4-3t)e^{2t} - e^t - (t-1)e^{2t} = 4e^t - (4-3t+t-1)e^{2t}$$\n$$\\alpha_0 = 4e^t - (3-2t)e^{2t}$$\n\n**步骤4：计算 A²**\n$$A^2 = A \\cdot A = \\begin{pmatrix} 2  1  c \\\\ 0  2  d \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 2  1  c \\\\ 0  2  d \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 4  2+2  2c+d+c \\\\ 0  4  2d+d \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 4  4  3c+d \\\\ 0  4  3d \\\\ 0  0  1 \\end{pmatrix}$$\n\n**步骤5：组装 $e^{tA}$**\n$$e^{tA} = \\alpha_0 I + \\alpha_1 A + \\alpha_2 A^2$$\n$$e^{tA} = \\alpha_0 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\alpha_1 \\begin{pmatrix} 2  1  c \\\\ 0  2  d \\\\ 0  0  1 \\end{pmatrix} + \\alpha_2 \\begin{pmatrix} 4  4  3c+d \\\\ 0  4  3d \\\\ 0  0  1 \\end{pmatrix}$$\n$$e^{tA} = \\begin{pmatrix} \\alpha_0 + 2\\alpha_1 + 4\\alpha_2  \\alpha_1 + 4\\alpha_2  c\\alpha_1 + (3c+d)\\alpha_2 \\\\ 0  \\alpha_0 + 2\\alpha_1 + 4\\alpha_2  d\\alpha_1 + 3d\\alpha_2 \\\\ 0  0  \\alpha_0 + \\alpha_1 + \\alpha_2 \\end{pmatrix}$$\n\n让我们使用我们已用来定义方程组的 $\\alpha_j$ 组合来计算矩阵元素：\n- $(1,1)$ 和 $(2,2)$ 元素：$\\alpha_0 + 2\\alpha_1 + 4\\alpha_2 = e^{2t}$，来自(2)式。\n- $(3,3)$ 元素：$\\alpha_0 + \\alpha_1 + \\alpha_2 = e^t$，来自(1)式。\n- $(1,2)$ 元素：$\\alpha_1 + 4\\alpha_2 = te^{2t}$，来自(3)式。\n\n现在计算剩余的非对角元素：\n- $(2,3)$ 元素：$d\\alpha_1 + 3d\\alpha_2 = d(\\alpha_1 + 3\\alpha_2)$。\n  $\\alpha_1 + 3\\alpha_2 = (-4e^t + (4-3t)e^{2t}) + 3(e^t + (t-1)e^{2t}) = -e^t + (4-3t+3t-3)e^{2t} = e^{2t}-e^t$。\n  所以 $(2,3)$ 元素是 $d(e^{2t}-e^t)$。\n- $(1,3)$ 元素：$c\\alpha_1 + (3c+d)\\alpha_2 = c(\\alpha_1 + 3\\alpha_2) + d\\alpha_2$。\n  使用 $\\alpha_1+3\\alpha_2$ 和 $\\alpha_2$ 的表达式：\n  $c(e^{2t}-e^t) + d(e^t + (t-1)e^{2t}) = c e^{2t} - c e^t + d e^t + dt e^{2t} - d e^{2t} = (c-d+dt)e^{2t} + (d-c)e^t$。\n\n最后，组装矩阵 $e^{tA}$：\n$$e^{tA} = \\begin{pmatrix} e^{2t}  t e^{2t}  (c-d+dt)e^{2t} + (d-c)e^t \\\\ 0  e^{2t}  d(e^{2t} - e^t) \\\\ 0  0  e^t \\end{pmatrix}$$", "answer": "$$\n\\boxed{\\begin{pmatrix} e^{2t}  t e^{2t}  (c-d+dt)e^{2t} + (d-c)e^t \\\\ 0  e^{2t}  d(e^{2t} - e^t) \\\\ 0  0  e^t \\end{pmatrix}}\n$$", "id": "1156702"}, {"introduction": "仅仅了解系统的特征值并不足以完全预测其动态行为。此练习通过一个精心设计的非正规矩阵例子，揭示了即使在系统渐近稳定的情况下（所有特征值均具有负实部），其状态范数也可能经历巨大的瞬时增长。通过亲手推导并分析这种瞬时增长现象，您将深刻理解为什么对于非正规系统，仅靠谱分析（eigenvalue analysis）可能具有误导性，而必须考虑更精细的性质。[@problem_id:2753706]", "problem": "考虑由 $0  \\varepsilon \\leq 1$ 参数化的实上三角矩阵族，\n$$\nA_{\\varepsilon} \\;=\\; \\begin{pmatrix}\n-1  \\dfrac{1}{\\varepsilon} \\\\\n0  -(1+\\varepsilon)\n\\end{pmatrix}.\n$$\n对于每个固定的 $\\varepsilon > 0$，该矩阵族是渐近稳定的，并且当 $\\varepsilon\\to 0^{+}$ 时变得近乎亏损，因为 $A_{\\varepsilon}\\to \\begin{pmatrix}-1  \\infty\\\\ 0  -1\\end{pmatrix}$，其意义在于其特征值汇聚于 $-1$，而其特征向量变得病态。在状态空间术语中，状态转移矩阵是矩阵指数 $\\exp(t A_{\\varepsilon})$，它是齐次线性时不变系统 $\\dot{x}(t)=A_{\\varepsilon} x(t)$ 在 $x(0)=I$ 条件下的解。\n\n仅从矩阵指数作为 $\\dot{\\Phi}(t)=A_{\\varepsilon}\\Phi(t)$ 在 $\\Phi(0)=I$ 条件下的唯一解 $\\Phi(t)=\\exp(tA_{\\varepsilon})$ 的定义性质出发，完成以下任务：\n\n1. 推导 $\\exp(t A_{\\varepsilon})$ 的显式表达式。\n2. 使用诱导欧几里得算子范数（即谱范数）定义\n$$\nM(\\varepsilon) \\;=\\; \\sup_{t\\geq 0} \\left\\| \\exp\\!\\big(t A_{\\varepsilon}\\big) \\right\\|_{2}.\n$$\n3. 证明尽管是渐近稳定的，但当 $\\varepsilon\\to 0^{+}$ 时，$M(\\varepsilon)$ 表现出大的瞬态增长，并通过计算极限来求出主阶增长的精确常数\n$$\nL \\;=\\; \\lim_{\\varepsilon\\to 0^{+}} \\; \\varepsilon \\, M(\\varepsilon).\n$$\n\n请提供 $L$ 的最终答案，形式为精确的符号表达式（无数值四舍五入）。无需单位。", "solution": "用户提供了一个必须首先被验证的问题陈述。\n\n### 步骤 1：提取已知条件\n-   矩阵族由 $A_{\\varepsilon} = \\begin{pmatrix} -1  \\frac{1}{\\varepsilon} \\\\ 0  -(1+\\varepsilon) \\end{pmatrix}$ 给出，其中 $0  \\varepsilon \\leq 1$。\n-   相关的线性时不变系统是 $\\dot{x}(t) = A_{\\varepsilon} x(t)$。\n-   状态转移矩阵是 $\\Phi(t) = \\exp(t A_{\\varepsilon})$，它被定义为 $\\dot{\\Phi}(t) = A_{\\varepsilon} \\Phi(t)$ 在初始条件 $\\Phi(0) = I$ 下的唯一解，其中 $I$ 是单位矩阵。\n-   量 $M(\\varepsilon)$ 被定义为状态转移矩阵谱范数在非负时间上的上确界：$M(\\varepsilon) = \\sup_{t \\geq 0} \\| \\exp(t A_{\\varepsilon}) \\|_{2}$。\n-   任务是计算极限 $L = \\lim_{\\varepsilon\\to 0^{+}} \\varepsilon M(\\varepsilon)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学基础：** 该问题牢固地植根于控制理论和线性代数领域，特别是关于线性系统的稳定性和瞬态行为。矩阵 $A_{\\varepsilon}$ 是一个非正规矩阵的典型例子，其指数的范数表现出瞬态增长，这是一个与伪谱相关的被充分研究的现象。矩阵指数、谱范数和稳定性的概念都是标准的且严格定义的。\n-   **适定性：** 这个问题是适定的。每个任务都是一个清晰的数学指令。矩阵指数的存在性和唯一性得到保证。范数、上确界和极限的定义是明确的。预期存在一个唯一的、有意义的解。\n-   **客观性：** 问题陈述使用精确、客观的数学语言进行表述，不含任何主观或推测性内容。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、适定的、客观的和完整的。它是应用数学中一个有效且非平凡的问题。我现在将着手解决。\n\n解答将按照问题的要求分为三个主要部分构建。\n\n**第 1 部分：矩阵指数 $\\exp(t A_{\\varepsilon})$ 的推导**\n\n我们必须通过求解矩阵微分方程 $\\dot{\\Phi}(t) = A_{\\varepsilon} \\Phi(t)$ 在 $\\Phi(0) = I$ 的条件下，找到矩阵 $\\Phi(t) = \\exp(t A_{\\varepsilon})$。设 $\\Phi(t) = \\begin{pmatrix} \\phi_{11}(t)  \\phi_{12}(t) \\\\ \\phi_{21}(t)  \\phi_{22}(t) \\end{pmatrix}$。方程变为：\n$$\n\\begin{pmatrix} \\dot{\\phi}_{11}(t)  \\dot{\\phi}_{12}(t) \\\\ \\dot{\\phi}_{21}(t)  \\dot{\\phi}_{22}(t) \\end{pmatrix} = \\begin{pmatrix} -1  \\frac{1}{\\varepsilon} \\\\ 0  -(1+\\varepsilon) \\end{pmatrix} \\begin{pmatrix} \\phi_{11}(t)  \\phi_{12}(t) \\\\ \\phi_{21}(t)  \\phi_{22}(t) \\end{pmatrix}\n$$\n来自 $\\Phi(0) = I$ 的初始条件是 $\\phi_{11}(0) = 1$，$\\phi_{12}(0) = 0$，$\\phi_{21}(0) = 0$，以及 $\\phi_{22}(0) = 1$。\n\n对于第二行，方程是解耦的：\n-   $\\dot{\\phi}_{21}(t) = -(1+\\varepsilon) \\phi_{21}(t)$，其中 $\\phi_{21}(0) = 0$。唯一解是 $\\phi_{21}(t) = 0$。\n-   $\\dot{\\phi}_{22}(t) = -(1+\\varepsilon) \\phi_{22}(t)$，其中 $\\phi_{22}(0) = 1$。解是 $\\phi_{22}(t) = \\exp(-(1+\\varepsilon)t)$。\n\n对于第一行，我们有：\n-   $\\dot{\\phi}_{11}(t) = -\\phi_{11}(t) + \\frac{1}{\\varepsilon}\\phi_{21}(t)$。由于 $\\phi_{21}(t) = 0$，这简化为 $\\dot{\\phi}_{11}(t) = -\\phi_{11}(t)$。在 $\\phi_{11}(0) = 1$ 的条件下，解是 $\\phi_{11}(t) = \\exp(-t)$。\n-   $\\dot{\\phi}_{12}(t) = -\\phi_{12}(t) + \\frac{1}{\\varepsilon}\\phi_{22}(t)$。代入 $\\phi_{22}(t)$，我们得到一阶线性常微分方程：\n    $$\n    \\dot{\\phi}_{12}(t) + \\phi_{12}(t) = \\frac{1}{\\varepsilon} \\exp(-(1+\\varepsilon)t)\n    $$\n    我们使用积分因子来求解，积分因子为 $\\exp(\\int 1 \\, dt) = \\exp(t)$。\n    $$\n    \\frac{d}{dt} \\left(\\exp(t) \\phi_{12}(t)\\right) = \\exp(t) \\left( \\frac{1}{\\varepsilon} \\exp(-(1+\\varepsilon)t) \\right) = \\frac{1}{\\varepsilon} \\exp(-\\varepsilon t)\n    $$\n    对 $t$ 积分：\n    $$\n    \\exp(t) \\phi_{12}(t) = \\int \\frac{1}{\\varepsilon} \\exp(-\\varepsilon t) \\, dt = \\frac{1}{\\varepsilon} \\left(-\\frac{1}{\\varepsilon} \\exp(-\\varepsilon t)\\right) + C = -\\frac{1}{\\varepsilon^2} \\exp(-\\varepsilon t) + C\n    $$\n    使用初始条件 $\\phi_{12}(0) = 0$：\n    $$\n    \\exp(0) \\phi_{12}(0) = 0 = -\\frac{1}{\\varepsilon^2}\\exp(0) + C \\implies C = \\frac{1}{\\varepsilon^2}\n    $$\n    因此，$\\exp(t) \\phi_{12}(t) = \\frac{1}{\\varepsilon^2}(1 - \\exp(-\\varepsilon t))$，这给出：\n    $$\n    \\phi_{12}(t) = \\frac{1}{\\varepsilon^2}(\\exp(-t) - \\exp(-(1+\\varepsilon)t))\n    $$\n收集各分量，矩阵指数为：\n$$\n\\exp(t A_{\\varepsilon}) = \\begin{pmatrix} \\exp(-t)  \\frac{1}{\\varepsilon^2} (\\exp(-t) - \\exp(-(1+\\varepsilon)t)) \\\\ 0  \\exp(-(1+\\varepsilon)t) \\end{pmatrix}\n$$\n\n**第 2 和 3 部分：瞬态增长分析与极限评估**\n\n我们被要求计算 $L = \\lim_{\\varepsilon\\to 0^{+}} \\varepsilon M(\\varepsilon) = \\lim_{\\varepsilon\\to 0^{+}} \\varepsilon \\sup_{t\\geq 0} \\| \\exp(t A_{\\varepsilon}) \\|_{2}$。\n这等价于 $L = \\lim_{\\varepsilon\\to 0^{+}} \\sup_{t\\geq 0} (\\varepsilon \\| \\exp(t A_{\\varepsilon}) \\|_{2})$。令 $h_{\\varepsilon}(t) = \\varepsilon \\| \\exp(t A_{\\varepsilon}) \\|_{2}$。我们希望计算 $\\lim_{\\varepsilon\\to 0^{+}} \\sup_{t\\geq 0} h_{\\varepsilon}(t)$。\n\n分析学中一个已知的结果是，如果一个函数序列一致收敛，则极限和上确界算子可以互换。我们将证明 $h_{\\varepsilon}(t)$ 对于 $t \\in [0, \\infty)$ 一致收敛于一个函数 $h(t)$，这证明了可以写成 $L = \\sup_{t\\geq 0} \\lim_{\\varepsilon\\to 0^{+}} h_{\\varepsilon}(t)$。\n\n让我们首先找到 $h_{\\varepsilon}(t)$ 的逐点极限。我们需要 $\\| \\exp(t A_{\\varepsilon}) \\|_{2}$ 在 $\\varepsilon$ 很小时的渐近表达式。谱范数的平方 $\\| \\cdot \\|_{2}^2$ 是 $\\Phi(t)^T \\Phi(t)$ 的最大特征值。\n令 $\\Phi(t) = \\exp(t A_{\\varepsilon})$。那么\n$$\n\\Phi(t)^T \\Phi(t) = \\begin{pmatrix} \\exp(-2t)  \\exp(-t)f(t) \\\\ \\exp(-t)f(t)  f(t)^2 + \\exp(-2(1+\\varepsilon)t) \\end{pmatrix}\n$$\n其中 $f(t) = \\phi_{12}(t) = \\frac{1}{\\varepsilon^2}(\\exp(-t) - \\exp(-(1+\\varepsilon)t))$。对于小的 $\\varepsilon$，我们展开 $f(t)$：\n$$\nf(t) = \\frac{\\exp(-t)}{\\varepsilon^2}(1 - \\exp(-\\varepsilon t)) = \\frac{\\exp(-t)}{\\varepsilon^2}\\left(1 - \\left(1 - \\varepsilon t + \\frac{(\\varepsilon t)^2}{2} - \\dots\\right)\\right) = \\frac{t\\exp(-t)}{\\varepsilon} - \\frac{t^2\\exp(-t)}{2} + O(\\varepsilon)\n$$\n主导项是 $1/\\varepsilon$ 阶，所以 $f(t)^2$ 是 $1/\\varepsilon^2$ 阶。\n$\\Phi(t)^T \\Phi(t)$ 的特征值 $\\lambda$ 由特征方程 $\\lambda^2 - \\text{Tr}(\\Phi(t)^T \\Phi(t))\\lambda + \\det(\\Phi(t)^T \\Phi(t)) = 0$ 的解给出。\n范数的平方是较大的特征值，$\\lambda_{\\max} = \\frac{1}{2}\\left(\\text{Tr} + \\sqrt{\\text{Tr}^2 - 4\\det}\\right)$。让我们为小的 $\\varepsilon$ 分析这些项：\n$$\n\\text{Tr}(\\Phi(t)^T \\Phi(t)) = f(t)^2 + \\exp(-2t) + \\exp(-2(1+\\varepsilon)t) = \\frac{t^2\\exp(-2t)}{\\varepsilon^2} - \\frac{t^3\\exp(-2t)}{\\varepsilon} + O(1)\n$$\n$$\n\\det(\\Phi(t)^T \\Phi(t)) = (\\det \\Phi(t))^2 = (\\exp(-t)\\exp(-(1+\\varepsilon)t))^2 = \\exp(-2(2+\\varepsilon)t) = O(1)\n$$\n平方根下的项是 $\\text{Tr}^2 - 4\\det$。渐近地，它由 $\\text{Tr}^2$ 主导：\n$$\n\\sqrt{\\text{Tr}^2 - 4\\det} = \\text{Tr} \\sqrt{1 - \\frac{4\\det}{\\text{Tr}^2}} = \\text{Tr} \\left(1 - \\frac{2\\det}{\\text{Tr}^2} + \\dots\\right) \\approx \\text{Tr}\n$$\n更精确地说，一个类似于对 $\\text{Tr}$ 所做的仔细展开会得到：\n$$\n\\sqrt{\\text{Tr}^2 - 4\\det} = \\frac{t^2\\exp(-2t)}{\\varepsilon^2} - \\frac{t^3\\exp(-2t)}{\\varepsilon} + O(1)\n$$\n因此，\n$$\n\\|\\exp(t A_{\\varepsilon})\\|_{2}^2 = \\lambda_{\\max} \\approx \\frac{1}{2}(\\text{Tr} + \\text{Tr}) = \\text{Tr} = \\frac{t^2\\exp(-2t)}{\\varepsilon^2} - \\frac{t^3\\exp(-2t)}{\\varepsilon} + O(1)\n$$\n现在我们可以分析 $h_{\\varepsilon}(t)^2$：\n$$\nh_{\\varepsilon}(t)^2 = \\varepsilon^2 \\|\\exp(t A_{\\varepsilon})\\|_{2}^2 = t^2\\exp(-2t) - \\varepsilon t^3\\exp(-2t) + O(\\varepsilon^2)\n$$\n取平方根：\n$$\nh_{\\varepsilon}(t) = \\sqrt{t^2\\exp(-2t) - \\varepsilon t^3\\exp(-2t) + O(\\varepsilon^2)} = t\\exp(-t)\\sqrt{1 - \\varepsilon t + O(\\varepsilon^2)}\n$$\n使用泰勒展开 $\\sqrt{1-x} = 1 - \\frac{x}{2} + O(x^2)$：\n$$\nh_{\\varepsilon}(t) = t\\exp(-t)\\left(1 - \\frac{1}{2}\\varepsilon t + O(\\varepsilon^2)\\right) = t\\exp(-t) - \\frac{1}{2}\\varepsilon t^2\\exp(-t) + O(\\varepsilon^2)\n$$\n逐点极限是明确的：$h(t) = \\lim_{\\varepsilon\\to 0^{+}} h_{\\varepsilon}(t) = t\\exp(-t)$。\n为了证明极限和上确界可以互换，我们考察收敛性。误差为\n$$\n|h_{\\varepsilon}(t) - h(t)| = \\left| -\\frac{1}{2}\\varepsilon t^2\\exp(-t) + O(\\varepsilon^2) \\right|\n$$\n对于给定的小的 $\\varepsilon > 0$，我们必须找到这个误差在 $t \\geq 0$ 上的上确界。函数 $g(t) = t^2\\exp(-t)$ 在 $t \\ge 0$ 上是有界的。其导数 $g'(t) = (2t-t^2)\\exp(-t)$ 在 $t=0$ 和 $t=2$ 处为零。最大值是 $g(2) = 4\\exp(-2)$。因此，\n$$\n\\sup_{t\\ge 0} |h_{\\varepsilon}(t) - h(t)| \\le \\frac{1}{2}\\varepsilon (4\\exp(-2)) + O(\\varepsilon^2)\n$$\n当 $\\varepsilon \\to 0^{+}$ 时，这个上确界趋于 $0$，这证明了 $h_{\\varepsilon}(t)$ 到 $h(t)$ 的收敛在 $[0, \\infty)$ 上是一致的。因此，极限和上确界的互换是合理的。\n$$\nL = \\lim_{\\varepsilon\\to 0^{+}} \\sup_{t\\geq 0} h_{\\varepsilon}(t) = \\sup_{t\\geq 0} \\lim_{\\varepsilon\\to 0^{+}} h_{\\varepsilon}(t) = \\sup_{t\\geq 0} (t\\exp(-t))\n$$\n为了找到这个上确界，我们将 $h(t) = t\\exp(-t)$ 对 $t$ 求导，并令导数为零：\n$$\n\\frac{dh}{dt} = \\exp(-t) - t\\exp(-t) = (1-t)\\exp(-t)\n$$\n导数在 $t=1$ 时为零。在这一点，函数达到其最大值：\n$$\nh(1) = 1 \\cdot \\exp(-1) = \\frac{1}{e}\n$$\n因此，极限的值为 $L = \\exp(-1)$。", "answer": "$$\\boxed{\\exp(-1)}$$", "id": "2753706"}, {"introduction": "从理论走向实践，我们必须面对有限精度计算带来的挑战。此练习将您置于数值软件设计者的角色，探讨在计算矩阵指数时广泛使用的 Padé 逼近方法的数值稳定性问题。您将分析在矩阵范数较小时，不同的计算策略如何影响舍入误差和避免灾难性抵消（catastrophic cancellation），从而学会选择在实际应用中兼具效率与精度的鲁棒算法。[@problem_id:2753724]", "problem": "考虑使用缩放平方框架（scaling-and-squaring framework）结合 Padé 近似式来计算方阵 $A \\in \\mathbb{C}^{n \\times n}$ 的矩阵指数 $\\exp(A)$。矩阵指数由绝对收敛的幂级数 $\\exp(A) = \\sum_{k=0}^{\\infty} \\frac{A^{k}}{k!}$ 定义。缩放平方框架利用了恒等式 $\\exp(A) = \\left(\\exp\\left(A / 2^{s}\\right)\\right)^{2^{s}}$，其中 $s \\ge 0$ 为整数。使用 $[m/m]$ 型的有理 Padé 近似式来逼近 $\\exp(\\cdot)$，从而近似计算 $\\exp\\left(A / 2^{s}\\right)$。\n\n有多种代数上等价的方法来计算 $[m/m]$ 型 Padé 近似式。两种常见的形式是：(i) 计算分子多项式 $p_{m}(\\cdot)$ 和分母多项式 $q_{m}(\\cdot)$，然后构成 $q_{m}(X)^{-1} p_{m}(X)$；(ii) 奇偶分裂法，将近似式写成 $\\left(V_{m}(X)+U_{m}(X)\\right)\\left(V_{m}(X)-U_{m}(X)\\right)^{-1}$ 的形式，其中 $V_{m}$ 聚合了偶次幂项，$U_{m}$ 聚合了奇次幂项（等价地，对于某些具有正系数的多项式 $\\widehat{U}_{m}$ 和 $\\widehat{V}_{m}$，有 $U_{m}(X) = X \\,\\widehat{U}_{m}(X^{2})$ 和 $V_{m}(X) = \\widehat{V}_{m}(X^{2})$）。假设浮点运算满足标准模型 $\\operatorname{fl}(a \\,\\circ\\, b) = (a \\,\\circ\\, b)(1 + \\delta)$，其中对于 $\\circ \\in \\{+, -, \\times\\}$ 有 $|\\delta| \\le u$，$u$ 是单位舍入误差（例如，在 binary64 中 $u \\approx 2^{-53}$）。\n\n假设 $\\lVert A \\rVert$（在某个相容的次乘矩阵范数下）很小，例如 $\\lVert A \\rVert \\le 10^{-8}$，并且您希望分析在计算 Padé 多项式时发生灾难性抵消的风险，并提出参数选择以避免之。特别地，考虑缩放参数 $s$、近似阶数 $m$ 以及计算形式（分子/分母形式与奇偶分裂法）的选择如何影响抵消和舍入误差的放大。\n\n对于如此小的 $\\lVert A \\rVert$，下列哪些策略是合理的，可以最小化抵消并保持高精度？\n\nA. 设置 $s = 0$（不缩放），并以奇偶分裂形式 $\\left(V_{m}(A)+U_{m}(A)\\right)\\left(V_{m}(A)-U_{m}(A)\\right)^{-1}$ 计算 $[m/m]$ 型 Padé 近似式，其中 $U_{m}$ 和 $V_{m}$ 通过 Horner 法则在 $A^{2}$ 中计算（或通过 Paterson–Stockmeyer 方案在 $A^{2}$ 中计算）。这可以避免大的减法抵消，因为当 $\\lVert A \\rVert$ 很小时，$V_{m}(A) \\approx I$ 且 $U_{m}(A)$ 很小。\n\nB. 选择足够大的 $s$ 使得 $\\lVert A/2^{s} \\rVert \\lesssim u$。这样 $U_{m}(A/2^{s})$ 可以忽略不计，因此可以无抵消地形成 $\\left(V_{m} \\pm U_{m}\\right)$，并且重复平方可以精确地恢复缺失的项。\n\nC. 对于足够小的 $\\lVert A \\rVert$，切换到截断的 Taylor 多项式 $\\sum_{k=0}^{K} \\frac{A^{k}}{k!}$，其中 $K$ 通过不等式 $\\lVert A \\rVert^{K+1}/(K+1)! \\le \\text{tol}$（对于预设的容差）来选择。这避免了形成近似抵消的分子/分母多项式，并利用了所有 Taylor 系数均为正数的特点。\n\nD. 通过使用 Paterson–Stockmeyer 方案分别构造 $p_{m}(A)$ 和 $q_{m}(A)$，然后计算 $q_{m}(A)^{-1} p_{m}(A)$ 来评估 Padé 近似式。因为 $\\lVert A \\rVert$ 很小，$q_{m}$ 中的交替符号不会在浮点运算中导致抵消，所以这比奇偶分裂法更可取。\n\nE. 为减少 $\\left(V_{m} \\pm U_{m}\\right)$ 中的抵消，无论 $\\lVert A \\rVert$ 大小，都选择尽可能大的 $m$（例如，$m = 13$），因为在实践中，对于小的 $\\lVert A \\rVert$，更高的阶数总能减少抵消。\n\n选择所有适用项。", "solution": "问题陈述经过验证。\n\n步骤 1：提取已知条件\n- 计算对象是方阵 $A \\in \\mathbb{C}^{n \\times n}$ 的矩阵指数 $\\exp(A)$。\n- 矩阵指数的定义是幂级数 $\\exp(A) = \\sum_{k=0}^{\\infty} \\frac{A^{k}}{k!}$。\n- 计算框架是基于恒等式 $\\exp(A) = \\left(\\exp\\left(A / 2^{s}\\right)\\right)^{2^{s}}$ 的缩放平方（scaling-and-squaring），其中 $s \\ge 0$ 为整数。\n- 对 $\\exp\\left(A / 2^{s}\\right)$ 的近似方法是 $[m/m]$ 型 Padé 近似式，记为 $R_{m,m}(\\cdot)$。\n- 给出了 Padé 近似式的两种计算形式：\n    1. 分子/分母形式：$q_{m}(X)^{-1} p_{m}(X)$。\n    2. 奇偶分裂形式：$\\left(V_{m}(X)+U_{m}(X)\\right)\\left(V_{m}(X)-U_{m}(X)\\right)^{-1}$，其中 $V_{m}$ 包含偶次幂项，$U_{m}$ 包含奇次幂项。由 $U_{m}(X) = X \\,\\widehat{U}_{m}(X^{2})$ 和 $V_{m}(X) = \\widehat{V}_{m}(X^{2})$ 定义的多项式 $\\widehat{U}_{m}$ 和 $\\widehat{V}_{m}$ 具有正系数。\n- 浮点运算模型是 $\\operatorname{fl}(a \\,\\circ\\, b) = (a \\,\\circ\\, b)(1 + \\delta)$，其中对于 $\\circ \\in \\{+, -, \\times\\}$ 有 $|\\delta| \\le u$。\n- 给出了一个特定条件：矩阵范数 $\\lVert A \\rVert$ 很小，具体为 $\\lVert A \\rVert \\le 10^{-8}$。\n- 目标是在此条件下，找出最小化抵消并保持高精度的合理策略。\n\n步骤 2：使用提取的已知条件进行验证\n- **科学性**：该问题牢固地基于数值线性代数和矩阵函数理论中的标准、成熟概念。矩阵指数、缩放平方和 Padé 近似式的定义都是正确的。所描述的数值稳定性问题，如抵消，是该领域的核心主题。\n- **适定性**：该问题是适定的。它要求在明确定义的条件（$\\lVert A \\rVert \\le 10^{-8}$）下评估特定的数值策略。可以根据数值分析的原理确定一组唯一的正确策略。\n- **客观性**：该问题以精确、客观、技术性的语言陈述。没有主观或含糊的术语。\n- **其他缺陷**：问题陈述是自洽的、一致的，并且不包含说明中列出的任何使之无效的缺陷。它代表了在设计用于计算矩阵指数的鲁棒软件时的一个现实且重要的问题。\n\n步骤 3：结论与行动\n问题陈述有效。将提供完整的解答和选项评估。\n\n问题的核心在于，当计算范数很小的矩阵 $A$（$\\lVert A \\rVert \\le 10^{-8}$）的指数 $\\exp(A)$ 时，分析舍入误差，特别是灾难性抵消。灾难性抵消发生在两个几乎相等的数相减时，可能导致相对精度的损失。\n\n联系 Padé 形式的恒等式是 $p_m(X) = V_m(X) + U_m(X)$ 和 $q_m(X) = p_m(-X) = V_m(-X) + U_m(-X) = V_m(X) - U_m(X)$，因为 $V_m$ 是偶函数，$U_m$ 是奇函数。对于小的 $\\lVert A \\rVert$，我们有泰勒级数 $\\exp(A) = I + A + \\frac{A^2}{2} + O(\\lVert A \\rVert^3)$。任何好的近似式都必须接近这个级数。对于 Padé 近似式 $R_{m,m}(A)$，其主项为 $V_m(A) \\approx I$ 和 $U_m(A) \\approx \\frac{1}{2}A$。因此，$\\lVert V_m(A) \\rVert \\approx 1$ 且 $\\lVert U_m(A) \\rVert \\approx \\frac{1}{2}\\lVert A \\rVert \\le 5 \\times 10^{-9}$。\n\nA. **设置 $s = 0$（不缩放），并以奇偶分裂形式 $\\left(V_{m}(A)+U_{m}(A)\\right)\\left(V_{m}(A)-U_{m}(A)\\right)^{-1}$ 计算 $[m/m]$ 型 Padé 近似式，其中 $U_{m}$ 和 $V_{m}$ 通过 Horner 法则在 $A^{2}$ 中计算（或通过 Paterson–Stockmeyer 方案在 $A^{2}$ 中计算）。这可以避免大的减法抵消，因为当 $\\lVert A \\rVert$ 很小时，$V_{m}(A) \\approx I$ 且 $U_{m}(A)$ 很小。**\n\n由于 $\\lVert A \\rVert \\le 10^{-8}$ 已经很小，通常不需要进一步缩放（即选择 $s > 0$），因为这会在平方阶段引入其自身的舍入误差。因此，设置 $s=0$ 是一个合理的起点。奇偶分裂法是计算 Padé 近似式的一种高效方法，因为它涉及 $A^2$ 的多项式。多项式 $\\widehat{V}_m(Y)$ 和 $\\widehat{U}_m(Y)$（其中 $Y=A^2$）具有正系数。计算这类多项式在数值上非常稳定，因为它主要涉及量值递减的项的加法。\n涉及抵消的关键步骤是减法 $V_m(A) - U_m(A)$。如前所述，对于小的 $\\lVert A \\rVert$，$V_m(A) \\approx I$ 且 $U_m(A) \\approx \\frac{1}{2}A$。由于 $\\lVert U_m(A) \\rVert \\ll \\lVert V_m(A) \\rVert$，这两个矩阵并不近似相等。从一个接近单位矩阵的矩阵中减去一个小的矩阵不会引起灾难性抵消。此选项中提供的理由是合理的。对于小的 $\\lVert A \\rVert$，该策略在数值上是稳定且高效的。\n\n结论：**正确**。\n\nB. **选择足够大的 $s$ 使得 $\\lVert A/2^{s} \\rVert \\lesssim u$。这样 $U_{m}(A/2^{s})$ 可以忽略不计，因此可以无抵消地形成 $\\left(V_{m} \\pm U_{m}\\right)$，并且重复平方可以精确地恢复缺失的项。**\n\n这种策略被称为“过度缩放”（overscaling）。令 $X = A/2^s$。如果 $\\lVert X \\rVert \\lesssim u$，则 $X$ 与单位舍入误差在同一数量级。Padé 近似式将非常精确：$R_{m,m}(X) \\approx \\exp(X) \\approx I + X$。由于浮点运算，像 $X^2$ 这样的高阶项在与 $I$ 相加时会丢失。例如，$\\operatorname{fl}((I+X)^2) = \\operatorname{fl}(I+2X+X^2) \\approx I+2X$，因为 $\\lVert X^2 \\rVert \\lesssim u^2 \\ll u$。经过 $s$ 次平方后，计算结果将约等于 $I + 2^s X = I + A$。而真实值是 $\\exp(A) = I + A + A^2/2! + A^3/3! + \\dots$。这种近似的误差是 $A^2/2! + \\dots$，这个误差丢失了。\n声称“重复平方可以精确地恢复缺失的项”是根本错误的。相反，在这种情况下，重复平方会*丢失*高阶信息。这是实现缩放平方方法时一个众所知的陷阱。虽然对于如此小的参数，在形成 $V_m \\pm U_m$ 时没有抵消，但整个方法由于平方运算会引入显著的截断误差。\n\n结论：**错误**。\n\nC. **对于足够小的 $\\lVert A \\rVert$，切换到截断的 Taylor 多项式 $\\sum_{k=0}^{K} \\frac{A^{k}}{k!}$，其中 $K$ 通过不等式 $\\lVert A \\rVert^{K+1}/(K+1)! \\le \\text{tol}$（对于预设的容差）来选择。这避免了形成近似抵消的分子/分母多项式，并利用了所有 Taylor 系数均为正数的特点。**\n\n对于小矩阵范数，使用截断的 Taylor 级数是一种标准且高效的策略。用于 `expm` 的最新算法在范数低于某个阈值时，会从 Padé 近似式切换到 Taylor 级数。主要原因有：\n1.  **数值稳定性**：Taylor 级数的系数 $1/k!$ 都是正的。计算 $T_K(A) = \\sum_{k=0}^K \\frac{A^k}{k!}$ 只涉及矩阵项的加法（为简单起见，假设矩阵项为非负，但原理更具普适性），这在数值上是有利的，并避免了计算 $q_m(A)$ 或 $V_m(A) - U_m(A)$ 时存在的减法，尽管对于小范数而言这些减法可能是良性的。\n2.  **计算成本**：对于给定的精度要求，计算 Taylor 多项式可能比计算 Padé 近似式更便宜，后者需要解一个线性方程组（$q_m(A) Y = p_m(A)$）。\n条件 $\\lVert A \\rVert \\le 10^{-8}$ 完全处于这种切换有利的区域内。所提供的理由完全正确。该策略是现代 `expm` 实现的基石。\n\n结论：**正确**。\n\nD. **通过使用 Paterson–Stockmeyer 方案分别构造 $p_{m}(A)$ 和 $q_{m}(A)$，然后计算 $q_{m}(A)^{-1} p_{m}(A)$ 来评估 Padé 近似式。因为 $\\lVert A \\rVert$ 很小，$q_{m}$ 中的交替符号不会在浮点运算中导致抵消，所以这比奇偶分裂法更可取。**\n\n多项式 $q_m(A) = \\sum_{j=0}^m c_j (-1)^j A^j$ 的项具有交替符号。对于小的 $\\lVert A \\rVert$，我们有 $q_m(A) \\approx I - \\frac{1}{2}A$。如前所述，计算这个式子不涉及减去几乎相等的量，因此灾难性抵消不是问题。推理的第一部分是正确的。\n然而，该方法“比奇偶分裂法更可取”的结论是错误的。\n从计算成本的角度来看，计算 $p_m(A)$ 和 $q_m(A)$ 的最佳方法是先计算 $U_m(A)$ 和 $V_m(A)$（它们是 $A^2$ 的多项式），然后再求和与差。这正是奇偶分裂法。不利用奇偶结构从头计算 $p_m(A)$ 和 $q_m(A)$ 会效率较低。\n从数值稳定性的角度来看，奇偶分裂法计算具有正系数的多项式（$\\widehat{V}_m$ 和 $\\widehat{U}_m$），这是最稳定的，然后执行一次加法和一次减法。直接计算 $q_m(A)$ 涉及一个贯穿始终的带交替符号的求和，这通常被认为稳定性稍差，即使在本例中不会引起灾难性抵消。因此，奇偶分裂法在效率和稳定性上通常被认为更优越。\n\n结论：**错误**。\n\nE. **为减少 $\\left(V_{m} \\pm U_{m}\\right)$ 中的抵消，无论 $\\lVert A \\rVert$ 大小，都选择尽可能大的 $m$（例如，$m = 13$），因为在实践中，对于小的 $\\lVert A \\rVert$，更高的阶数总能减少抵消。**\n\n这个策略是不可取的。阶数 $m$ 和缩放参数 $s$ 的选择是相互关联的。对于给定的期望精度，应选择它们以最小化计算成本。对于像 $\\lVert A \\rVert \\le 10^{-8}$ 这样非常小的范数，一个非常小的阶数 $m$ 就足以达到完全的机器精度。例如，当 $m=1$ 时，近似误差约为 $\\lVert A^3 \\rVert \\approx 10^{-24}$ 的量级，这已经可以忽略不计。使用像 $m=13$ 这样的大阶数在计算上是浪费的，需要更多的矩阵乘法。\n此外，“更高的阶数总能减少抵消”这个前提不是一个健全的普遍原则。在这个具体案例中，抵消从一开始就不是问题。$m$ 的选择是由近似式的截断误差驱动的，而不是为了减轻不存在的抵消。使用不必要的高阶数在精度上不会带来任何实际好处，因为误差已经被其他浮点舍入误差所主导。\n\n结论：**错误**。", "answer": "$$\\boxed{AC}$$", "id": "2753724"}]}