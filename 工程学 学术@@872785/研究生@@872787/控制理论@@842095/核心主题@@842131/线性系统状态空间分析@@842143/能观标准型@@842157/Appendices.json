{"hands_on_practices": [{"introduction": "我们的实践练习始于一项基本技能：将给定的传递函数转换为其可观测规范型状态空间表示。该练习 ([@problem_id:2729169]) 将引导您完成一个严格真分系统的系统化转换过程。通过从第一性原理出发并匹配分子多项式，您将巩固对系统的极点和零点如何编码在状态空间矩阵 $(A_o, B_o, C_o)$ 中的理解。", "problem": "考虑单输入单输出（SISO）线性时不变（LTI）传递函数\n$$\nG(s) \\;=\\; \\frac{2s^{2}+3s+5}{s^{3}+4s^{2}+6s+3}.\n$$\n使用与分母多项式相关的可观测规范型，构建一个实现 $G(s)$ 的最小状态空间实现，其矩阵为 $(A_{o},B,C,D)$，其中 $A_{o}$ 是可观测伴随形式，且由于系统是严格真分的，$D=0$。从基本的状态空间到传递函数的恒等式\n$$\nG(s) \\;=\\; C\\,(sI - A)^{-1} B \\;+\\; D,\n$$\n出发，从分母多项式确定 $A_{o}$，然后通过 $C\\operatorname{adj}(sI-A_{o})B$ 匹配分子多项式来显式计算输入向量 $B$。最后，通过从已实现的 $(A_{o},B,C,D)$ 直接计算 $G(s)$ 来验证你的 $B$。\n\n最终答案仅报告向量 $B$ 的元素，形式为单行矩阵 $(b_{1}\\;\\;b_{2}\\;\\;b_{3})$，使用精确整数。无需四舍五入，不涉及物理单位。", "solution": "我们从单输入单输出（SISO）线性时不变（LTI）系统的状态空间到传递函数的恒等式开始，\n$$\nG(s) \\;=\\; C\\,(sI - A)^{-1} B \\;+\\; D,\n$$\n该恒等式是通过在状态空间描述 $\\dot{x}(t)=A x(t) + B u(t)$，$y(t)=C x(t) + D u(t)$ 中消去状态 $x(t)$，并在零初始条件下进行拉普拉斯变换得到的。对于严格真分传递函数，我们有 $D=0$。\n\n分母多项式为\n$$\nD(s) \\;=\\; s^{3} + 4 s^{2} + 6 s + 3 \\;=\\; s^{3} + a_{2} s^{2} + a_{1} s + a_{0},\n$$\n其系数为 $a_{2}=4$，$a_{1}=6$，$a_{0}=3$。可观测规范（伴随）型具有\n$$\nA_{o} \\;=\\;\n\\begin{bmatrix}\n0  0  -a_{0} \\\\\n1  0  -a_{1} \\\\\n0  1  -a_{2}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\n0  0  -3 \\\\\n1  0  -6 \\\\\n0  1  -4\n\\end{bmatrix},\n\\qquad\nC \\;=\\; \\begin{bmatrix} 0  0  1 \\end{bmatrix},\n\\qquad\nD \\;=\\; 0,\n$$\n以及一个待通过分子匹配确定的未知向量 $B \\in \\mathbb{R}^{3}$。\n\n根据伴随矩阵恒等式，\n$$\n(sI - A_{o})^{-1} \\;=\\; \\frac{\\operatorname{adj}(sI - A_{o})}{\\det(sI - A_{o})},\n$$\n因此\n$$\nG(s) \\;=\\; \\frac{C\\,\\operatorname{adj}(sI - A_{o})\\,B}{\\det(sI - A_{o})}.\n$$\n首先，我们验证 $\\det(sI - A_{o})$ 等于给定的分母。计算\n$$\nsI - A_{o} \\;=\\;\n\\begin{bmatrix}\ns  0  3 \\\\\n-1  s  6 \\\\\n0  -1  s+4\n\\end{bmatrix}.\n$$\n其行列式为\n\\begin{align*}\n\\det(sI - A_{o})\n= s\\,\\det\\!\\begin{bmatrix} s  6 \\\\ -1  s+4 \\end{bmatrix}\n\\;+\\; 3\\,\\det\\!\\begin{bmatrix} -1  s \\\\ 0  -1 \\end{bmatrix} \\\\\n= s\\,(s(s+4) - 6(-1)) \\;+\\; 3\\,((-1)(-1) - 0\\cdot s) \\\\\n= s\\,(s^{2} + 4s + 6) \\;+\\; 3 \\\\\n= s^{3} + 4 s^{2} + 6 s + 3 \\;=\\; D(s),\n\\end{align*}\n符合要求。\n\n因此 $G(s)$ 的分子必须等于 $C\\,\\operatorname{adj}(sI - A_{o})\\,B$。由于 $C=\\begin{bmatrix}0  0  1\\end{bmatrix}$，只有 $\\operatorname{adj}(sI - A_{o})$ 的第三行有贡献。因为 $\\operatorname{adj}(M)$ 是 $M$ 的代数余子式矩阵的转置，所以 $\\operatorname{adj}(sI - A_{o})$ 的第三行由 $sI - A_{o}$ 的代数余子式的第三列给出。为简洁起见，记 $M = sI - A_{o}$。相关的代数余子式为：\n\\begin{align*}\nC_{1,3} = (-1)^{1+3}\\,\\det\\!\\begin{bmatrix} -1  s \\\\ 0  -1 \\end{bmatrix}\n= (+1)\\,( (-1)(-1) - s\\cdot 0 ) \\;=\\; 1, \\\\\nC_{2,3} = (-1)^{2+3}\\,\\det\\!\\begin{bmatrix} s  0 \\\\ 0  -1 \\end{bmatrix}\n= (-1)\\,( s(-1) - 0\\cdot 0 ) \\;=\\; s, \\\\\nC_{3,3} = (-1)^{3+3}\\,\\det\\!\\begin{bmatrix} s  0 \\\\ -1  s \\end{bmatrix}\n= (+1)\\,( s\\cdot s - 0\\cdot (-1) ) \\;=\\; s^{2}.\n\\end{align*}\n因此，\n$$\nC\\,\\operatorname{adj}(sI - A_{o}) \\;=\\; \\begin{bmatrix} C_{1,3}  C_{2,3}  C_{3,3} \\end{bmatrix}\n\\;=\\; \\begin{bmatrix} 1  s  s^{2} \\end{bmatrix}.\n$$\n设 $B = \\begin{bmatrix} b_{1} \\\\ b_{2} \\\\ b_{3} \\end{bmatrix}$。则分子多项式为\n$$\nC\\,\\operatorname{adj}(sI - A_{o})\\,B \\;=\\; \\begin{bmatrix} 1  s  s^{2} \\end{bmatrix}\n\\begin{bmatrix} b_{1} \\\\ b_{2} \\\\ b_{3} \\end{bmatrix} \\;=\\; b_{1} + b_{2}\\,s + b_{3}\\,s^{2}.\n$$\n与给定的分子 $2 s^{2} + 3 s + 5$ 匹配，得到\n$$\nb_{3} \\;=\\; 2, \\qquad b_{2} \\;=\\; 3, \\qquad b_{1} \\;=\\; 5,\n$$\n因此\n$$\nB \\;=\\; \\begin{bmatrix} 5 \\\\ 3 \\\\ 2 \\end{bmatrix}.\n$$\n\n通过直接计算进行验证：给定\n$$\nA_{o} \\;=\\;\n\\begin{bmatrix}\n0  0  -3 \\\\\n1  0  -6 \\\\\n0  1  -4\n\\end{bmatrix},\\quad\nB \\;=\\; \\begin{bmatrix} 5 \\\\ 3 \\\\ 2 \\end{bmatrix},\\quad\nC \\;=\\; \\begin{bmatrix} 0  0  1 \\end{bmatrix},\\quad\nD \\;=\\; 0,\n$$\n我们有\n\\begin{align*}\nG(s) = \\frac{C\\,\\operatorname{adj}(sI - A_{o})\\,B}{\\det(sI - A_{o})}\n= \\frac{\\begin{bmatrix} 1  s  s^{2} \\end{bmatrix} \\begin{bmatrix} 5 \\\\ 3 \\\\ 2 \\end{bmatrix}}{s^{3} + 4 s^{2} + 6 s + 3} \\\\\n= \\frac{5 + 3 s + 2 s^{2}}{s^{3} + 4 s^{2} + 6 s + 3}\n= \\frac{2 s^{2} + 3 s + 5}{s^{3} + 4 s^{2} + 6 s + 3},\n\\end{align*}\n这与给定的 $G(s)$ 相匹配。这证实了 $B$ 和该实现的正确性。", "answer": "$$\\boxed{\\begin{pmatrix}5  3  2\\end{pmatrix}}$$", "id": "2729169"}, {"introduction": "在之前练习的基础上，我们现在来处理更一般的情况：分子和分母阶数相同的真分传递函数，这导致了非零的直接馈通项 $D$。这个问题 ([@problem_id:2729213]) 要求您修改实现过程以计入 $D$ 的影响，展示它如何对总传递函数的分子做出贡献。这种实践对于处理具有瞬时输入到输出路径的现实世界系统至关重要。", "problem": "考虑一个单输入单输出 (SISO) 线性时不变 (LTI) 状态空间模型，其处于可观测规范型，状态矩阵为 $A_{o} \\in \\mathbb{R}^{3 \\times 3}$，输出矩阵为 $C \\in \\mathbb{R}^{1 \\times 3}$，输入矩阵为 $B \\in \\mathbb{R}^{3 \\times 1}$，以及直接项 $D \\in \\mathbb{R}$。传递函数定义为 $G(s) = C(sI - A_{o})^{-1}B + D$。该系统为可观测规范型，其特征多项式为 $\\det(sI - A_{o}) = (s+1)^{3} = s^{3} + 3s^{2} + 3s + 1$，且该实现由下式指定\n$$\nA_{o} = \\begin{pmatrix}\n0  0  -1 \\\\\n1  0  -3 \\\\\n0  1  -3\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  0  0 \\end{pmatrix}.\n$$\n已知所期望的真传递函数具有非零直接项，其表达式为\n$$\nG(s) = \\frac{2s^{3} - s^{2} + 5s + 4}{(s+1)^{3}}.\n$$\n\n从基本定义出发，即从状态空间方程定义的传递函数 $G(s)$ 以及当 $M$ 可逆时成立的伴随矩阵恒等式 $M^{-1} = \\operatorname{adj}(M)/\\det(M)$，推导连接 $G(s)$ 的分子多项式与矩阵 $A_{o}$、$B$、$C$ 及标量 $D$ 的分子匹配方程。特别地，请解释与严格真分情况相比，一个非零的 $D$ 是如何改变这些方程的。然后，利用你的推导，计算出在给定的 $A_{o}$ 和 $C$ 条件下，实现给定传递函数 $G(s)$ 的唯一 $B = \\begin{pmatrix} b_{1} \\\\ b_{2} \\\\ b_{3} \\end{pmatrix}$ 和 $D$。\n\n将你的最终答案表示为一个单行矩阵，按顺序包含 $b_{1}$、$b_{2}$、$b_{3}$ 和 $D$，所有值为精确整数。无需四舍五入，不涉及单位。", "solution": "一个线性时不变 (LTI) 状态空间系统的传递函数 $G(s)$ 定义为\n$$\nG(s) = C(sI - A)^{-1}B + D\n$$\n其中 $A$、$B$、$C$ 和 $D$ 分别是状态矩阵、输入矩阵、输出矩阵和直接馈通矩阵。对于一个可逆矩阵 $M$，其逆由伴随矩阵恒等式 $M^{-1} = \\frac{\\operatorname{adj}(M)}{\\det(M)}$ 给出。将此恒等式应用于矩阵 $(sI - A_{o})$，我们可以将传递函数表示为\n$$\nG(s) = \\frac{C \\operatorname{adj}(sI - A_{o}) B}{\\det(sI - A_{o})} + D\n$$\n为了将这些项合并成一个有理函数，我们将它们通分，分母为 $\\det(sI - A_{o})$：\n$$\nG(s) = \\frac{C \\operatorname{adj}(sI - A_{o}) B + D \\det(sI - A_{o})}{\\det(sI - A_{o})}\n$$\n该表达式的分母是矩阵 $A_{o}$ 的特征多项式。分子（我们将其记为 $N(s)$）是一个关于 $s$ 的多项式，由下式给出\n$$\nN(s) = C \\operatorname{adj}(sI - A_{o}) B + D \\det(sI - A_{o})\n$$\n这组方程将传递函数的分子多项式与系统矩阵联系起来。\n\n一个关键的观察点是关于直接项 $D$ 的作用。矩阵 $\\operatorname{adj}(sI - A_{o})$ 是一个由 $s$ 的多项式组成的矩阵。对于一个 $n \\times n$ 矩阵 $A_{o}$，$\\operatorname{adj}(sI - A_{o})$ 的元素是阶数至多为 $n-1$ 的多项式。因此，乘积 $C \\operatorname{adj}(sI - A_{o}) B$ 的结果是一个阶数至多为 $n-1$ 的多项式。\n在严格真分传递函数的情况下，$D=0$，分子多项式 $N(s) = C \\operatorname{adj}(sI - A_{o}) B$ 的阶数严格小于分母的阶数 $n$。\n然而，当 $D \\neq 0$ 时，传递函数是真分但非严格真分。项 $D \\det(sI - A_{o})$ 为分子增加了一个 $n$ 阶多项式。此时，假设特征多项式是首一的（即其首项系数为 1），分子多项式的首项系数恰好是 $D$。这一点可以通过取极限 $s \\to \\infty$ 来明显看出，即 $D = \\lim_{s\\to\\infty} G(s)$。因此，一个非零 $D$ 的存在通过将特征多项式的各项（由 $D$ 缩放）加到 $s^{n-1}, s^{n-2}, \\dots, s^0$ 的系数方程中，从而修改了分子匹配方程。\n\n我们现在将此框架应用于具体问题。给定的可观测规范型状态矩阵为\n$$\nA_{o} = \\begin{pmatrix} 0  0  -1 \\\\ 1  0  -3 \\\\ 0  1  -3 \\end{pmatrix}\n$$\n特征多项式已知为 $\\det(sI - A_{o}) = s^{3} + 3s^{2} + 3s + 1$。我们首先计算矩阵 $(sI - A_o)$ 及其伴随矩阵。\n$$\nsI - A_{o} = \\begin{pmatrix} s  0  1 \\\\ -1  s  3 \\\\ 0  -1  s+3 \\end{pmatrix}\n$$\n伴随矩阵 $\\operatorname{adj}(sI - A_{o})$ 是代数余子式矩阵的转置。各代数余子式为：\n$C_{11} = s(s+3) - (3)(-1) = s^2+3s+3$\n$C_{12} = -[(-1)(s+3) - (3)(0)] = s+3$\n$C_{13} = (-1)(-1) - (s)(0) = 1$\n$C_{21} = -[(0)(s+3) - (1)(-1)] = -1$\n$C_{22} = s(s+3) - (1)(0) = s^2+3s$\n$C_{23} = -[s(-1) - (0)(0)] = s$\n$C_{31} = (0)(3) - (1)(s) = -s$\n$C_{32} = -[s(3) - (1)(-1)] = -3s-1$\n$C_{33} = s(s) - (0)(-1) = s^2$\n代数余子式矩阵是\n$$\n\\begin{pmatrix} s^2+3s+3  s+3  1 \\\\ -1  s^2+3s  s \\\\ -s  -3s-1  s^2 \\end{pmatrix}\n$$\n伴随矩阵是该矩阵的转置：\n$$\n\\operatorname{adj}(sI - A_{o}) = \\begin{pmatrix} s^2+3s+3  -1  -s \\\\ s+3  s^2+3s  -3s-1 \\\\ 1  s  s^2 \\end{pmatrix}\n$$\n现在，我们计算多项式 $C \\operatorname{adj}(sI - A_{o}) B$。给定 $C = \\begin{pmatrix} 1  0  0 \\end{pmatrix}$ 和 $B = \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix}$：\n$$\nC \\operatorname{adj}(sI - A_{o}) = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} s^2+3s+3  -1  -s \\\\ s+3  s^2+3s  -3s-1 \\\\ 1  s  s^2 \\end{pmatrix} = \\begin{pmatrix} s^2+3s+3  -1  -s \\end{pmatrix}\n$$\n$$\nC \\operatorname{adj}(sI - A_{o}) B = \\begin{pmatrix} s^2+3s+3  -1  -s \\end{pmatrix} \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix} = b_1(s^2+3s+3) - b_2 - b_3 s\n$$\n按 $s$ 的幂次重新整理，得到：\n$$\nb_1 s^2 + (3b_1 - b_3)s + (3b_1 - b_2)\n$$\n完整的分子多项式为 $N(s) = C \\operatorname{adj}(sI - A_{o}) B + D \\det(sI - A_{o})$：\n$$\nN(s) = [b_1 s^2 + (3b_1 - b_3)s + (3b_1 - b_2)] + D(s^3 + 3s^2 + 3s + 1)\n$$\n按 $s$ 的幂次合并同类项：\n$$\nN(s) = D s^3 + (b_1 + 3D)s^2 + (3b_1 - b_3 + 3D)s + (3b_1 - b_2 + D)\n$$\n期望的传递函数是 $G(s) = \\frac{2s^{3} - s^{2} + 5s + 4}{(s+1)^{3}}$，所以目标分子是 $N_{target}(s) = 2s^{3} - s^{2} + 5s + 4$。\n我们将推导出的分子多项式的系数与目标分子多项式的系数相等：\n\\begin{itemize}\n    \\item $s^3$ 的系数：$D = 2$\n    \\item $s^2$ 的系数：$b_1 + 3D = -1$\n    \\item $s^1$ 的系数：$3b_1 - b_3 + 3D = 5$\n    \\item $s^0$ 的系数：$3b_1 - b_2 + D = 4$\n\\end{itemize}\n我们得到一个关于 $b_1, b_2, b_3$ 和 $D$ 的线性方程组需要求解。\n从 $s^3$ 的系数，我们立即得出 $D = 2$。\n将 $D=2$ 代入 $s^2$ 系数的方程中：\n$b_1 + 3(2) = -1 \\implies b_1 + 6 = -1 \\implies b_1 = -7$。\n将 $D=2$ 和 $b_1=-7$ 代入 $s^1$ 系数的方程中：\n$3(-7) - b_3 + 3(2) = 5 \\implies -21 - b_3 + 6 = 5 \\implies -15 - b_3 = 5 \\implies b_3 = -20$。\n将 $D=2$ 和 $b_1=-7$ 代入 $s^0$ 系数的方程中：\n$3(-7) - b_2 + 2 = 4 \\implies -21 - b_2 + 2 = 4 \\implies -19 - b_2 = 4 \\implies b_2 = -23$。\n因此，实现给定传递函数的唯一参数是 $b_1 = -7$，$b_2 = -23$，$b_3 = -20$ 和 $D=2$。\n输入矩阵为 $B = \\begin{pmatrix} -7 \\\\ -23 \\\\ -20 \\end{pmatrix}$，直接项为 $D=2$。\n最终结果以一个行矩阵的形式给出，按指定顺序包含这些值。", "answer": "$$\n\\boxed{\\begin{pmatrix} -7  -23  -20  2 \\end{pmatrix}}\n$$", "id": "2729213"}, {"introduction": "作为我们实践的总结，我们将理论分析与计算实现联系起来。该练习 ([@problem_id:2729219]) 将指导您以编程方式为给定的传递函数构建可观测和可控制两种规范型，然后通过数值方法验证它们的等价性。通过计算连接这两种基本实现的相似变换矩阵 $T$，您将对状态空间等价性的概念以及可控性与可观测性之间深刻的结构对偶性获得实践性的见解。", "problem": "给定单输入单输出线性时不变系统，由严格真传递函数 $G(s) = \\dfrac{N(s)}{D(s)}$ 指定，其中 $D(s)$ 是 $n$ 阶的首一多项式，$N(s)$ 的阶数最多为 $n-1$。设 $D(s) = s^n + a_{n-1} s^{n-1} + \\cdots + a_1 s + a_0$ 和 $N(s) = b_0 + b_1 s + \\cdots + b_{n-1} s^{n-1}$。其系数在数组 $[a_0, a_1, \\ldots, a_{n-1}]$ 和 $[b_0, b_1, \\ldots, b_{n-1}]$ 中按升幂顺序提供。\n\n从状态空间中传递函数的基本定义 $G(s) = C (s I - A)^{-1} B + D$ 以及状态空间模型能控性和能观性的核心定义出发，您必须：\n\n- 为每个提供的测试用例，构建能控规范型实现 $(A_c, B_c, C_c, D_c)$ 和能观规范型实现 $(A_o, B_o, C_o, D_o)$，它们实现相同的 $G(s)$。这些规范型实现必须与给定的多项式以及由分母多项式 $D(s)$（首一）和分子多项式 $N(s)$ 所隐含的标准友伴形式结构相一致，且 $D_c = 0$ 和 $D_o = 0$。\n- 计算一个相似变换矩阵 $T \\in \\mathbb{R}^{n \\times n}$，该矩阵满足最小实现之间等价性的三个定义方程：\n  1. $A_o \\, T = T \\, A_c$，\n  2. $B_o = T \\, B_c$，\n  3. $C_o = C_c \\, T^{-1}$。\n- 通过检查这三个方程的残差的弗罗贝尼乌斯范数是否严格小于容差 $\\tau = 10^{-9}$ 来数值验证等价性。\n- 您的程序必须为每个测试用例输出一个布尔值，指示所有三个条件是否在容差 $\\tau$ 内同时得到满足。\n\n测试套件和格式要求：\n\n- 使用以下测试套件，其中每一项都是一对数组，用于指定 $[a_0, a_1, \\ldots, a_{n-1}]$ 和 $[b_0, b_1, \\ldots, b_{n-1}]$：\n  - 案例 1（正常路径，4 阶）：$a = [4.0, 3.0, 5.0, 2.0]$，$b = [1.0, 0.0, 2.0, 3.0]$。\n  - 案例 2（相对阶大于 1，4 阶）：$a = [2.0, 1.0, 0.25, 0.5]$，$b = [1.0, 1.0, 0.0, 0.0]$。\n  - 案例 3（$a_2$ 系数为零，3 阶）：$a = [0.5, 2.0, 0.0]$，$b = [0.75, 0.0, 1.25]$。\n  - 案例 4（更高阶，5 阶）：$a = [1.0, 0.0, 3.0, 0.0, 1.0]$，$b = [0.0, 1.0, 0.0, 2.0, 1.0]$。\n  - 案例 5（常数项 $a_0$ 为零，3 阶）：$a = [0.0, 0.5, 2.0]$，$b = [1.0, -0.5, 0.25]$。\n- 所有计算都是无量纲的；没有物理单位。\n- 最终输出格式必须是单行，包含所有案例的结果，形式为方括号括起来的逗号分隔列表，例如 $[{\\tt True},{\\tt False},\\ldots]$。\n\n您的程序必须按照指定顺序，只输出一行包含布尔值结果的内容。不允许有其他输出。", "solution": "该问题要求验证一个线性时不变（LTI）系统的两种标准状态空间实现——能控规范型和能观规范型——之间的等价性。该系统由一个严格真单输入单输出（SISO）传递函数 $G(s) = \\dfrac{N(s)}{D(s)}$ 定义。\n\n分析必须从第一性原理开始。给定分母多项式 $D(s) = s^n + \\sum_{k=0}^{n-1} a_k s^k$ 和分子多项式 $N(s) = \\sum_{k=0}^{n-1} b_k s^k$，我们构建状态空间实现。其系数在数组 $[a_0, a_1, \\ldots, a_{n-1}]$ 和 $[b_0, b_1, \\ldots, b_{n-1}]$ 中提供。\n\n能控规范型实现 $(A_c, B_c, C_c, D_c)$ 定义如下。状态空间的维数是 $n$，即 $D(s)$ 的阶数。矩阵为：\n$$\nA_c = \\begin{pmatrix}\n0  1  0  \\cdots  0 \\\\\n0  0  1  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n0  0  0  \\cdots  1 \\\\\n-a_0  -a_1  -a_2  \\cdots  -a_{n-1}\n\\end{pmatrix} \\in \\mathbb{R}^{n \\times n}\n$$\n$$\nB_c = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} \\in \\mathbb{R}^{n \\times 1}\n$$\n$$\nC_c = \\begin{pmatrix} b_0  b_1  \\cdots  b_{n-1} \\end{pmatrix} \\in \\mathbb{R}^{1 \\times n}\n$$\n由于传递函数是严格真的，直接馈通项为零，因此 $D_c = 0$。顾名思义，该实现被构造成始终是能控的。\n\n能观规范型实现 $(A_o, B_o, C_o, D_o)$ 是能控规范型的对偶。其矩阵为：\n$$\nA_o = A_c^T = \\begin{pmatrix}\n0  0  \\cdots  0  -a_0 \\\\\n1  0  \\cdots  0  -a_1 \\\\\n0  1  \\cdots  0  -a_2 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  \\cdots  1  -a_{n-1}\n\\end{pmatrix} \\in \\mathbb{R}^{n \\times n}\n$$\n$$\nB_o = C_c^T = \\begin{pmatrix} b_0 \\\\ b_1 \\\\ \\vdots \\\\ b_{n-1} \\end{pmatrix} \\in \\mathbb{R}^{n \\times 1}\n$$\n$$\nC_o = B_c^T = \\begin{pmatrix} 0  0  \\cdots  0  1 \\end{pmatrix} \\in \\mathbb{R}^{1 \\times n}\n$$\n同样地，$D_o = 0$。该实现被构造成始终是能观的。\n\n如果存在一个非奇异的相似变换矩阵 $T$，使得以下关系成立，则两个状态空间实现 $(A_1, B_1, C_1)$ 和 $(A_2, B_2, C_2)$ 是等价的：\n$1. A_2 = T A_1 T^{-1} \\iff A_2 T = T A_1$\n$2. B_2 = T B_1$\n$3. C_2 = C_1 T^{-1} \\iff C_2 T = C_1$\n\n问题要求我们找到这样一个 $T$ 矩阵，它能将 $(A_c, B_c, C_c)$ 变换为 $(A_o, B_o, C_o)$，并数值验证这三个关系。\n\n矩阵 $T$ 可以从两个系统的能控性矩阵确定。对于一对 $(A, B)$，其能控性矩阵由 $\\mathcal{C}(A,B) = [B, AB, A^2B, \\ldots, A^{n-1}B]$ 给出。从等价关系中，我们可以推导出能控性矩阵之间的关系：\n$A_o T = T A_c$\n$B_o = T B_c$\n由此可得 $A_o B_o = A_o T B_c = T A_c B_c$，并且通常对于任何整数 $k \\ge 0$，都有 $A_o^k B_o = T A_c^k B_c$。\n构建能控性矩阵 $\\mathcal{C}_c = \\mathcal{C}(A_c, B_c)$ 和 $\\mathcal{C}_o = \\mathcal{C}(A_o, B_o)$，可以得到以下矩阵方程：\n$$\n\\mathcal{C}_o = [B_o, A_o B_o, \\ldots, A_o^{n-1} B_o] = [T B_c, T A_c B_c, \\ldots, T A_c^{n-1} B_c] = T [B_c, A_c B_c, \\ldots, A_c^{n-1} B_c] = T \\mathcal{C}_c\n$$\n因此，我们有 $\\mathcal{C}_o = T \\mathcal{C}_c$。\n\n对于能控规范型，矩阵 $\\mathcal{C}_c$ 总是非奇异的。因此，我们可以解出 $T$：\n$$\nT = \\mathcal{C}_o (\\mathcal{C}_c)^{-1}\n$$\n这种构造在代数上保证了前两个等价条件 $A_o T = T A_c$ 和 $B_o = T B_c$ 得到满足。第三个条件 $C_o = C_c T^{-1}$ 以及 $T$ 本身的非奇异性，仅在两个实现都是最小实现时才能得到保证。一个实现当且仅当它既是能控的又是能观的，才是最小实现。当传递函数 $G(s)$ 中存在极点-零点对消时，即多项式 $N(s)$ 和 $D(s)$ 不互质时，就会出现非最小实现。\n如果系统不是最小的，能观实现的能控性矩阵 $\\mathcal{C}_o$ 会变为奇异矩阵。因此，$T = \\mathcal{C}_o (\\mathcal{C}_c)^{-1}$ 也将是奇异的。在这种情况下，$T^{-1}$ 不存在，第三个等价条件不满足。\n\n计算步骤如下：\n1. 对于给定的案例 $([a_k], [b_k])$，构建大小为 $n = \\text{length}([a_k])$ 的矩阵 $A_c, B_c, C_c, A_o, B_o, C_o$。\n2. 通过迭代矩阵-向量乘法计算能控性矩阵 $\\mathcal{C}_c$ 和 $\\mathcal{C}_o$。\n3. 计算 $T = \\mathcal{C}_o (\\mathcal{C}_c)^{-1}$。\n4. 关键一步是检查 $T$ 的非奇异性。一种数值稳健的方法是检查其条件数 $\\text{cond}(T)$。如果 $\\text{cond}(T)$ 过大，则该矩阵是数值奇异的，意味着系统非最小。在这种情况下，等价变换不存在，验证必须失败。\n5. 如果 $T$ 是非奇异的，计算其逆矩阵 $T^{-1}$。\n6. 通过计算残差的弗罗贝尼乌斯范数来验证三个等价条件。如果所有三个范数都低于指定的容差 $\\tau = 10^{-9}$，则结果被视为有效。\n- 残差 $R_1$: $\\| A_o T - T A_c \\|_F  \\tau$\n- 残差 $R_2$: $\\| B_o - T B_c \\|_F  \\tau$\n- 残差 $R_3$: $\\| C_o - C_c T^{-1} \\|_F  \\tau$\n每个案例的最终输出是一个布尔值，指示这三个条件是否同时满足。鉴于理论框架确定了这些方程当且仅当系统是最小时才成立，并且提供的测试用例似乎没有极点-零点对消，我们预计所有案例的验证都将通过。数值检查的作用是确认这一点，并考虑到浮点运算的限制。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    \n    # Test cases as specified in the problem statement\n    test_cases = [\n        # Case 1: happy path, degree 4\n        {'a': np.array([4.0, 3.0, 5.0, 2.0]), 'b': np.array([1.0, 0.0, 2.0, 3.0])},\n        # Case 2: relative degree > 1, degree 4\n        {'a': np.array([2.0, 1.0, 0.25, 0.5]), 'b': np.array([1.0, 1.0, 0.0, 0.0])},\n        # Case 3: zero coefficient in a_2, degree 3\n        {'a': np.array([0.5, 2.0, 0.0]), 'b': np.array([0.75, 0.0, 1.25])},\n        # Case 4: higher order, degree 5\n        {'a': np.array([1.0, 0.0, 3.0, 0.0, 1.0]), 'b': np.array([0.0, 1.0, 0.0, 2.0, 1.0])},\n        # Case 5: zero constant term a_0, degree 3\n        {'a': np.array([0.0, 0.5, 2.0]), 'b': np.array([1.0, -0.5, 0.25])},\n    ]\n\n    results = []\n    for case in test_cases:\n        a_coeffs = case['a']\n        b_coeffs = case['b']\n        result = verify_equivalence(a_coeffs, b_coeffs)\n        results.append(result)\n\n    # Format the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef verify_equivalence(a, b, tol=1e-9):\n    \"\"\"\n    Constructs canonical forms, computes similarity transform T, and verifies equivalence.\n\n    Args:\n        a (np.ndarray): Coefficients [a_0, a_1, ..., a_{n-1}] of the denominator polynomial.\n        b (np.ndarray): Coefficients [b_0, b_1, ..., b_{n-1}] of the numerator polynomial.\n        tol (float): Tolerance for numerical checks.\n\n    Returns:\n        bool: True if the three equivalence conditions are met, False otherwise.\n    \"\"\"\n    n = len(a)\n    if n == 0:\n        return True # Trivial case\n\n    # 1. Construct Controllable Canonical Form (Ac, Bc, Cc)\n    Ac = np.diag(np.ones(n - 1), k=1)\n    Ac[-1, :] = -a\n    \n    Bc = np.zeros((n, 1))\n    Bc[-1, 0] = 1.0\n    \n    Cc = b.reshape(1, n)\n\n    # 2. Construct Observable Canonical Form (Ao, Bo, Co)\n    Ao = Ac.T\n    Bo = b.reshape(n, 1)\n    Co = Bc.T\n\n    # 3. Compute Controllability Matrices Cc_matrix and Co_matrix\n    Cc_matrix = np.zeros((n, n))\n    Co_matrix = np.zeros((n, n))\n    \n    # Initial columns\n    Cc_matrix[:, 0] = Bc.flatten()\n    Co_matrix[:, 0] = Bo.flatten()\n\n    for i in range(1, n):\n        Cc_matrix[:, i] = (Ac @ Cc_matrix[:, i-1]).flatten()\n        Co_matrix[:, i] = (Ao @ Co_matrix[:, i-1]).flatten()\n\n    # 4. Compute Transformation Matrix T\n    try:\n        Cc_inv = np.linalg.inv(Cc_matrix)\n        T = Co_matrix @ Cc_inv\n    except np.linalg.LinAlgError:\n        # Cc_matrix is always invertible for this form, so this is unlikely.\n        return False\n\n    # 5. Verify non-singularity of T\n    # A large condition number indicates numerical singularity.\n    if np.linalg.cond(T) > 1 / tol:\n        return False\n\n    # 6. Compute T_inv and verify the three conditions\n    try:\n        T_inv = np.linalg.inv(T)\n    except np.linalg.LinAlgError:\n        return False\n\n    # Condition 1: Ao*T - T*Ac = 0\n    res1 = np.linalg.norm(Ao @ T - T @ Ac, 'fro')\n    \n    # Condition 2: Bo - T*Bc = 0\n    res2 = np.linalg.norm(Bo - T @ Bc, 'fro')\n    \n    # Condition 3: Co - Cc*T_inv = 0\n    res3 = np.linalg.norm(Co - Cc @ T_inv, 'fro')\n    \n    cond1_ok = res1  tol\n    cond2_ok = res2  tol\n    cond3_ok = res3  tol\n\n    return cond1_ok and cond2_ok and cond3_ok\n\n# Execute the main function\nsolve()\n```", "id": "2729219"}]}