{"hands_on_practices": [{"introduction": "在我们能够控制或抑制谐振之前，我们必须能够精确地量化它。本练习将引导您从基本原理出发，为经典的二阶系统推导谐振的关键指标——谐振频率和谐振峰值，从而为后续更复杂的任务建立坚实的分析基础。通过这个过程，您将深化对频率响应、阻尼和系统动态之间内在联系的理解。[@problem_id:2740189]", "problem": "一个单输入单输出的线性时不变二阶闭环系统具有传递函数\n$$\nT(s) \\;=\\; \\frac{\\omega_n^{2}}{s^{2} + 2 \\zeta \\,\\omega_n\\, s + \\omega_n^{2}},\n$$\n其中 $\\zeta \\in (0,1)$ 是阻尼比，$\\omega_n  0$ 是自然频率。在角频率 $\\omega$ 下的稳态正弦响应幅值由 $\\left|T(\\mathrm{j}\\omega)\\right|$ 给出。\n\n定义谐振频率 $\\omega_r$ 为使 $\\left|T(\\mathrm{j}\\omega)\\right|$ 最大化的角频率，定义谐振峰值 $M_r$ 为 $M_r = \\max_{\\omega \\ge 0} \\left|T(\\mathrm{j}\\omega)\\right|$。谐振峰值附近的 $-3$ dB 带宽定义为 $\\Delta \\omega = \\omega_{+} - \\omega_{-}$，其中 $\\omega_{\\pm}$ 是满足 $\\left|T(\\mathrm{j}\\omega_{\\pm})\\right| = M_r / \\sqrt{2}$ 的两个频率。\n\n从上述定义和频率响应的标准微积分出发，从第一性原理推导出 $\\omega_r$ 和 $M_r$（不使用预先记忆的谐振公式）。然后，利用一个由 $\\left|T(\\mathrm{j}\\omega)\\right|$ 在 $\\omega_r$ 附近的局部曲率所支持的小阻尼二阶近似，估计小 $\\zeta$ 情况下的 $-3$ dB 带宽 $\\Delta \\omega$。\n\n对特定的参数值 $\\zeta = 0.1$ 和 $\\omega_n = 10$ 计算您的最终表达式，并提供 $\\omega_r$（单位 rad/s）、$M_r$（无量纲）和估计的 $\\Delta \\omega$（单位 rad/s）的数值。将您的答案四舍五入到四位有效数字。角频率以弧度/秒 (rad/s) 表示。", "solution": "所提出的问题是二阶线性时不变系统分析中的一个标准练习。它有科学依据、适定、客观且内部一致。因此，将提供一个解答。\n\n闭环传递函数由下式给出\n$$\nT(s) = \\frac{\\omega_n^{2}}{s^{2} + 2\\zeta\\omega_n s + \\omega_n^{2}}\n$$\n其中阻尼比 $\\zeta$ 的范围是 $(0,1)$，自然频率 $\\omega_n  0$。\n\n为了求得频率响应，我们代入 $s = \\mathrm{j}\\omega$：\n$$\nT(\\mathrm{j}\\omega) = \\frac{\\omega_n^{2}}{(\\mathrm{j}\\omega)^{2} + 2\\zeta\\omega_n(\\mathrm{j}\\omega) + \\omega_n^{2}} = \\frac{\\omega_n^{2}}{(\\omega_n^{2} - \\omega^{2}) + \\mathrm{j}(2\\zeta\\omega_n\\omega)}\n$$\n频率响应的幅度平方为\n$$\n|T(\\mathrm{j}\\omega)|^{2} = \\frac{(\\omega_n^{2})^{2}}{(\\omega_n^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_n\\omega)^{2}}\n$$\n谐振频率 $\\omega_r$ 是使 $|T(\\mathrm{j}\\omega)|$ 最大的频率 $\\omega \\ge 0$。这等价于最小化分母，我们将其表示为 $D(\\omega)$：\n$$\nD(\\omega) = (\\omega_n^{2} - \\omega^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2} = \\omega^{4} - 2\\omega_n^{2}\\omega^{2} + \\omega_n^{4} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2} = \\omega^{4} + 2(2\\zeta^{2}-1)\\omega_n^{2}\\omega^{2} + \\omega_n^{4}\n$$\n为了找到 $\\omega  0$ 时 $D(\\omega)$ 的最小值，我们对 $\\omega$ 求导并令导数等于零：\n$$\n\\frac{dD}{d\\omega} = 4\\omega^{3} + 4(2\\zeta^{2}-1)\\omega_n^{2}\\omega = 0\n$$\n由于我们关心 $\\omega  0$ 时的非平凡峰值，我们可以除以 $4\\omega$：\n$$\n\\omega^{2} + (2\\zeta^{2}-1)\\omega_n^{2} = 0 \\quad \\implies \\quad \\omega^{2} = (1-2\\zeta^{2})\\omega_n^{2}\n$$\n仅当 $1-2\\zeta^{2}  0$（即 $\\zeta  1/\\sqrt{2}$）时，$\\omega_r$ 存在实数正解。对于 $\\zeta \\ge 1/\\sqrt{2}$，导数对所有 $\\omega \\ge 0$ 都是非负的，因此 $|T(\\mathrm{j}\\omega)|$ 的最大值出现在 $\\omega=0$ 处。给定用于数值计算的 $\\zeta=0.1$，该条件得到满足。\n因此，谐振频率为：\n$$\n\\omega_r = \\omega_n \\sqrt{1 - 2\\zeta^{2}}\n$$\n谐振峰值 $M_r$ 是 $|T(\\mathrm{j}\\omega)|$ 在 $\\omega=\\omega_r$ 处的值。我们通过将 $\\omega_r^2$ 代入 $|T(\\mathrm{j}\\omega)|^2$ 的表达式来计算幅度平方 $|T(\\mathrm{j}\\omega_r)|^{2}$：\n$$\n|T(\\mathrm{j}\\omega_r)|^{2} = \\frac{\\omega_n^{4}}{(\\omega_n^{2} - \\omega_r^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega_r^{2}}\n$$\n使用 $\\omega_r^{2} = (1-2\\zeta^{2})\\omega_n^{2}$，我们有 $\\omega_n^{2} - \\omega_r^{2} = 2\\zeta^{2}\\omega_n^{2}$。将此代入分母：\n$$\n(\\omega_n^{2} - \\omega_r^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega_r^{2} = (2\\zeta^{2}\\omega_n^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}(\\omega_n^{2}(1-2\\zeta^{2})) \\\\\n= 4\\zeta^{4}\\omega_n^{4} + 4\\zeta^{2}\\omega_n^{4}(1-2\\zeta^{2}) \\\\\n= 4\\zeta^{4}\\omega_n^{4} + 4\\zeta^{2}\\omega_n^{4} - 8\\zeta^{4}\\omega_n^{4} \\\\\n= 4\\zeta^{2}\\omega_n^{4}(1-\\zeta^{2})\n$$\n所以，峰值幅度的平方为：\n$$\nM_r^{2} = |T(\\mathrm{j}\\omega_r)|^{2} = \\frac{\\omega_n^{4}}{4\\zeta^{2}\\omega_n^{4}(1-\\zeta^{2})} = \\frac{1}{4\\zeta^{2}(1-\\zeta^{2})}\n$$\n谐振峰值为：\n$$\nM_r = \\frac{1}{2\\zeta\\sqrt{1-\\zeta^{2}}}\n$$\n接下来，我们求带宽 $\\Delta \\omega = \\omega_{+} - \\omega_{-}$。频率 $\\omega_{\\pm}$ 由条件 $|T(\\mathrm{j}\\omega_{\\pm})| = M_r/\\sqrt{2}$ 定义，这等价于 $|T(\\mathrm{j}\\omega_{\\pm})|^2 = M_r^2/2$。\n$$\n\\frac{\\omega_n^{4}}{(\\omega_n^{2} - \\omega^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2}} = \\frac{1}{2} \\left(\\frac{1}{4\\zeta^{2}(1-\\zeta^{2})}\\right) = \\frac{1}{8\\zeta^{2}(1-\\zeta^{2})}\n$$\n令 $x = \\omega^2$。分母方程变为：\n$$\n(\\omega_n^{2} - x)^{2} + 4\\zeta^{2}\\omega_n^{2}x = 8\\zeta^{2}(1-\\zeta^{2})\\omega_n^{4}\n$$\n展开并重新整理各项，得到关于 $x$ 的二次方程：\n$$\n\\omega_n^{4} - 2\\omega_n^{2}x + x^{2} + 4\\zeta^{2}\\omega_n^{2}x = 8\\zeta^{2}\\omega_n^{4} - 8\\zeta^{4}\\omega_n^{4} \\\\\nx^{2} + (4\\zeta^{2}-2)\\omega_n^{2}x + (\\omega_n^{4} - 8\\zeta^{2}\\omega_n^{4} + 8\\zeta^{4}\\omega_n^{4}) = 0\n$$\n解 $x_{\\pm} = \\omega_{\\pm}^2$ 由二次求根公式给出：\n$$\nx_{\\pm} = \\frac{-(4\\zeta^{2}-2)\\omega_n^{2} \\pm \\sqrt{((4\\zeta^{2}-2)\\omega_n^{2})^{2} - 4(\\omega_n^{4} - 8\\zeta^{2}\\omega_n^{4} + 8\\zeta^{4}\\omega_n^{4})}}{2} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{(4\\zeta^{2}-2)^{2} - 4(1 - 8\\zeta^{2} + 8\\zeta^{4})} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{16\\zeta^{4}-16\\zeta^{2}+4 - 4 + 32\\zeta^{2} - 32\\zeta^{4}} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{16\\zeta^{2}-16\\zeta^{4}} = (1-2\\zeta^{2})\\omega_n^{2} \\pm 2\\zeta\\omega_n^{2}\\sqrt{1-\\zeta^{2}}\n$$\n问题要求估计小 $\\zeta$ 情况下的 $\\Delta \\omega = \\omega_{+} - \\omega_{-}$。我们有 $\\omega_{\\pm} = \\sqrt{x_{\\pm}}$。\n$$\n\\omega_{\\pm} = \\omega_n \\sqrt{(1-2\\zeta^{2}) \\pm 2\\zeta\\sqrt{1-\\zeta^{2}}}\n$$\n对于小 $\\zeta$，我们使用泰勒展开 $\\sqrt{1-u} \\approx 1 - u/2$：\n$$\n\\sqrt{1-\\zeta^{2}} \\approx 1 - \\frac{\\zeta^{2}}{2}\n$$\n$$\nx_{\\pm} \\approx \\omega_n^{2}\\left(1-2\\zeta^{2} \\pm 2\\zeta(1-\\frac{\\zeta^{2}}{2})\\right) = \\omega_n^{2}(1-2\\zeta^{2} \\pm (2\\zeta - \\zeta^{3}))\n$$\n现在我们使用 $\\sqrt{1+\\epsilon} \\approx 1+\\epsilon/2$ 来求 $\\omega_{\\pm} = \\sqrt{x_{\\pm}}$：\n$$\n\\omega_{+} \\approx \\omega_n \\sqrt{1 + 2\\zeta - 2\\zeta^{2}} \\approx \\omega_n \\left(1 + \\frac{1}{2}(2\\zeta - 2\\zeta^{2})\\right) = \\omega_n(1+\\zeta-\\zeta^{2})\n$$\n$$\n\\omega_{-} \\approx \\omega_n \\sqrt{1 - 2\\zeta - 2\\zeta^{2}} \\approx \\omega_n \\left(1 - \\frac{1}{2}(2\\zeta + 2\\zeta^{2})\\right) = \\omega_n(1-\\zeta-\\zeta^{2})\n$$\n那么带宽 $\\Delta\\omega$ 估计为：\n$$\n\\Delta\\omega = \\omega_{+} - \\omega_{-} \\approx \\omega_n(1+\\zeta-\\zeta^{2}) - \\omega_n(1-\\zeta-\\zeta^{2}) = 2\\zeta\\omega_n\n$$\n这是轻阻尼系统谐振峰值附近 $-3\\,\\text{dB}$ 带宽的标准一阶近似。\n\n现在我们对 $\\zeta=0.1$ 和 $\\omega_n=10\\,\\text{rad/s}$ 计算这些表达式。\n\n谐振频率：\n$$\n\\omega_r = 10 \\sqrt{1 - 2(0.1)^{2}} = 10 \\sqrt{1 - 0.02} = 10 \\sqrt{0.98} \\approx 9.8994949\\,\\text{rad/s}\n$$\n四舍五入到四位有效数字，得到 $\\omega_r = 9.899\\,\\text{rad/s}$。\n\n谐振峰值：\n$$\nM_r = \\frac{1}{2(0.1)\\sqrt{1-(0.1)^{2}}} = \\frac{1}{0.2\\sqrt{0.99}} = \\frac{5}{\\sqrt{0.99}} \\approx 5.025189...\n$$\n四舍五入到四位有效数字，得到 $M_r = 5.025$。\n\n估计带宽：\n$$\n\\Delta \\omega \\approx 2\\zeta\\omega_n = 2(0.1)(10) = 2 \\,\\text{rad/s}\n$$\n四舍五入到四位有效数字，得到 $\\Delta\\omega = 2.000\\,\\text{rad/s}$。\n\n所求的值是 $\\omega_r$、$M_r$ 和估计的 $\\Delta \\omega$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 9.899  5.025  2.000 \\end{pmatrix}}\n$$", "id": "2740189"}, {"introduction": "掌握了谐振的分析方法后，下一步自然是主动抑制不希望的谐振。陷波滤波器是实现这一目标的常用工具，但在数字化实现时会遇到一个关键挑战：频率畸变。本练习将探讨双线性变换引入的非线性频率映射关系，并要求您推导出“频率预畸变”(frequency pre-warping)法则，这是确保数字滤波器精确调谐到目标频率的关键步骤，也是连接连续时间设计与离散时间实现的重要桥梁。[@problem_id:2740191]", "problem": "一个连续时间单输入单输出系统在角频率 $\\,\\omega_{r}\\,$ (单位：弧度/秒) 处有一个轻阻尼谐振。您将设计一个数字陷波滤波器来抑制此谐振，方法是首先指定一个中心频率为 $\\,\\omega_{n}\\,$ 的连续时间二阶陷波器，然后使用采样周期为 $\\,T\\,$ 的双线性变换 (BLT) 对其进行离散化。假设 $0  \\omega_{r}T  \\pi$，以使谐振在采样时不会产生混叠，并且阻尼足够小，陷波器的中心频率决定了抑制效果。\n\n请仅使用以下基本定义来指导您的推导：\n\n- 连续时间频率响应评估：代入 $\\,s=j\\omega\\,$。\n- 离散时间频率响应评估：代入 $\\,z=\\exp(j\\Omega)\\,$，其中 $\\,\\Omega\\,$ 是离散时间弧度频率 (单位：弧度/采样点)。\n- 双线性变换 (BLT) 映射：$\\,s=\\dfrac{2}{T}\\dfrac{z-1}{z+1}\\,$。\n\n任务：\n1. 从这些定义出发，推导由双线性变换产生的连续时间频率变量 $\\,\\omega\\,$ 与离散时间频率变量 $\\,\\Omega\\,$ 之间的映射关系。\n2. 使用此映射关系解释，在不引用任何其他公式的情况下，为什么直接将连续时间陷波中心频率设置为 $\\,\\omega_{n}=\\omega_{r}\\,$ 然后进行离散化，所产生的数字陷波中心与离散频率 $\\,\\Omega_{r}=\\omega_{r}T\\,$ 处的采样谐振不重合。\n3. 推导一个预畸变规则，该规则选择一个连续时间陷波中心频率 $\\,\\omega_{n}^{\\star}\\,$ 作为 $\\,\\omega_{r}\\,$ 和 $\\,T\\,$ 的函数，使得经过双线性离散化后，数字陷波器的中心能精确对准离散频率 $\\,\\Omega_{r}=\\omega_{r}T\\,$ 处的采样谐振。\n\n答案规格：请提供 $\\,\\omega_{n}^{\\star}\\,$ 关于 $\\,\\omega_{r}\\,$ 和 $\\,T\\,$ 的单个闭式表达式作为最终答案。不要在最终答案框中包含任何单位，也不要四舍五入；需要一个精确的解析表达式。", "solution": "所述问题是有效的。它在科学上基于数字控制理论的原理，提法得当且客观。它不包含任何逻辑矛盾、缺失信息或伪科学主张。我将进行完整的推导。\n\n该问题要求进行一个三部分的推导，涉及通过双线性变换 (BLT) 设计数字陷波滤波器。问题的核心在于双线性变换引入的连续时间频率轴与离散时间频率轴之间的非线性关系，即“畸变”。我们将按顺序完成每个任务。\n\n首先，我们推导连续时间频率变量 $\\omega$ 和离散时间频率变量 $\\Omega$ 之间的映射关系。问题提供了必要的基本定义：通过代入 $s=j\\omega$ 求得连续时间频率响应，通过代入 $z=\\exp(j\\Omega)$ 求得离散时间频率响应，而双线性变换映射本身为 $s=\\frac{2}{T}\\frac{z-1}{z+1}$。\n\n我们首先将 $s$ 和 $z$ 的频域表示代入双线性变换方程：\n$$\nj\\omega = \\frac{2}{T} \\frac{\\exp(j\\Omega) - 1}{\\exp(j\\Omega) + 1}\n$$\n为简化右侧的表达式，我们从分子和分母中提出一个因子 $\\exp(j\\Omega/2)$：\n$$\nj\\omega = \\frac{2}{T} \\frac{\\exp(j\\Omega/2) \\left( \\exp(j\\Omega/2) - \\exp(-j\\Omega/2) \\right)}{\\exp(j\\Omega/2) \\left( \\exp(j\\Omega/2) + \\exp(-j\\Omega/2) \\right)}\n$$\n$\\exp(j\\Omega/2)$ 项被消去。现在我们使用正弦和余弦函数的欧拉公式：\n$$\n\\sin(x) = \\frac{\\exp(jx) - \\exp(-jx)}{2j} \\implies 2j\\sin(x) = \\exp(jx) - \\exp(-jx)\n$$\n$$\n\\cos(x) = \\frac{\\exp(jx) + \\exp(-jx)}{2} \\implies 2\\cos(x) = \\exp(jx) + \\exp(-jx)\n$$\n将这些恒等式以 $x = \\Omega/2$ 代入我们的方程，得到：\n$$\nj\\omega = \\frac{2}{T} \\frac{2j\\sin(\\Omega/2)}{2\\cos(\\Omega/2)}\n$$\n这可以简化为：\n$$\nj\\omega = \\frac{2}{T} j\\tan(\\frac{\\Omega}{2})\n$$\n两边同除以虚数单位 $j$，我们便得到连续频率 $\\omega$ 和离散频率 $\\Omega$ 之间的解析映射关系：\n$$\n\\omega = \\frac{2}{T} \\tan\\left(\\frac{\\Omega}{2}\\right)\n$$\n这种关系是非线性的，是频率畸变现象的根源。\n\n其次，我们用这个映射来解释为什么将连续时间陷波中心频率 $\\omega_n$ 设置为系统谐振频率 $\\omega_r$ 的朴素方法未能将数字陷波器置于正确的位置。陷波器的目标离散频率是采样谐振频率 $\\Omega_r = \\omega_r T$。朴素方法假设通过设置 $\\omega_n = \\omega_r$，得到的离散陷波中心频率（我们称之为 $\\Omega_n$）将等于 $\\Omega_r$。\n\n我们来检验这个假设。我们取已推导出的频率映射关系，并代入连续时间陷波中心 $\\omega_n$ 和由此产生的离散时间陷波中心 $\\Omega_n$：\n$$\n\\omega_n = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\n应用朴素选择 $\\omega_n = \\omega_r$，我们有：\n$$\n\\omega_r = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\n现在我们求解由此产生的离散频率 $\\Omega_n$：\n$$\n\\frac{\\omega_r T}{2} = \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\n$$\n\\Omega_n = 2 \\arctan\\left(\\frac{\\omega_r T}{2}\\right)\n$$\n预期的目标频率是 $\\Omega_r = \\omega_r T$。问题是 $\\Omega_n$ 是否等于 $\\Omega_r$。我们必须比较 $2 \\arctan(x)$ 和 $2x$，其中 $x = \\frac{\\omega_r T}{2}$。反正切函数的一个基本性质是，对于任何正自变量 $x0$，不等式 $\\arctan(x)  x$ 恒成立。问题陈述中规定 $0  \\omega_r T  \\pi$，这确保了 $x = \\frac{\\omega_r T}{2}$ 是正数。\n因此：\n$$\n\\arctan\\left(\\frac{\\omega_r T}{2}\\right)  \\frac{\\omega_r T}{2}\n$$\n两边乘以 2：\n$$\n2 \\arctan\\left(\\frac{\\omega_r T}{2}\\right)  \\omega_r T\n$$\n这意味着 $\\Omega_n  \\Omega_r$。这种朴素设计将数字陷波器置于一个严格低于目标谐振频率的频率上。发生这种情况是因为非线性畸变在将连续频率映射到离散频率范围时，对较高频率的压缩程度大于对较低频率的压缩程度。简单的线性缩放是不正确的。\n\n第三，我们推导预畸变规则。目标是选择一个特定的连续时间陷波中心频率，我们称之为 $\\omega_n^{\\star}$，使得通过双线性变换离散化后，得到的数字陷波器精确地以目标频率 $\\Omega_r = \\omega_r T$ 为中心。\n\n我们使用我们的频率映射方程，这次左边是预畸变的连续频率 $\\omega_n^{\\star}$，右边是期望的目标离散频率 $\\Omega_r$。根据设计，该方程必须得到满足：\n$$\n\\omega_n^{\\star} = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_r}{2}\\right)\n$$\n现在我们代入目标频率的定义 $\\Omega_r = \\omega_r T$：\n$$\n\\omega_n^{\\star} = \\frac{2}{T} \\tan\\left(\\frac{\\omega_r T}{2}\\right)\n$$\n该表达式给出了在模拟原型滤波器中需要使用的连续时间中心频率 $\\omega_n^{\\star}$。当一个以该频率 $\\omega_n^{\\star}$ 为中心的连续时间陷波滤波器使用采样周期为 $T$ 的双线性变换进行离散化时，得到的数字陷波滤波器的中心将精确地位于期望的离散频率 $\\Omega_r = \\omega_r T$ 处，从而正确地抑制系统的谐振。这个过程被称为频率预畸变。", "answer": "$$\n\\boxed{\\frac{2}{T} \\tan\\left(\\frac{\\omega_{r} T}{2}\\right)}\n$$", "id": "2740191"}, {"introduction": "本章的最后一个练习将我们带入鲁棒控制的领域，以应对现实世界中的挑战。实际系统的参数并非精确已知，而是存在不确定性。这个高级练习要求设计一个控制器，它不仅能为单个名义系统，而且能为整个具有不确定参数的系统族，保证其谐振峰值低于一个给定的水平。您将通过现代计算综合方法来解决这个小型但具有代表性的 $\\mathcal{H}_{\\infty}$ 优化问题，体验鲁棒性能设计的核心思想。[@problem_id:2740224]", "problem": "为带有二阶谐振对象族的单位反馈单输入单输出控制回路，设计并验证互补灵敏度峰值的鲁棒界。考虑严格真分对象\n$$\nP(s;\\,\\omega_n,\\zeta) \\;=\\; \\frac{\\omega_n^2}{s^2 + 2\\,\\zeta\\,\\omega_n\\,s + \\omega_n^2},\n$$\n其中不确定的自然频率和阻尼比满足\n$$\n\\omega_n \\in [\\,\\omega_{n,\\min},\\,\\omega_{n,\\max}\\,], \\quad \\zeta \\in [\\,\\zeta_{\\min},\\,\\zeta_{\\max}\\,], \\quad \\zeta  0.\n$$\n使用静态控制器\n$$\nK(s) \\;=\\; k, \\quad k \\in \\mathbb{R}.\n$$\n令回路传递函数为\n$$\nL(s;\\,\\omega_n,\\zeta,k) \\;=\\; P(s;\\,\\omega_n,\\zeta)\\,K(s) \\;=\\; k\\,P(s;\\,\\omega_n,\\zeta).\n$$\n互补灵敏度函数定义为\n$$\nT(s;\\,\\omega_n,\\zeta,k) \\;=\\; \\frac{L(s;\\,\\omega_n,\\zeta,k)}{1 + L(s;\\,\\omega_n,\\zeta,k)}.\n$$\n目标是综合一个控制器增益 $k$，以保证在整个对象族上，互补灵敏度函数的频率响应幅值具有一致的界。此界在虚轴上根据 $\\mathcal{H}_{\\infty}$ (H-无穷大) 诱导范数定义：\n$$\n\\sup_{\\omega \\in [\\,\\omega_{\\min},\\,\\omega_{\\max}\\,]} \\;\\sup_{\\omega_n \\in [\\,\\omega_{n,\\min},\\,\\omega_{n,\\max}\\,],\\; \\zeta \\in [\\,\\zeta_{\\min},\\,\\zeta_{\\max}\\,]} \\; \\left|\\,T(j\\omega;\\,\\omega_n,\\zeta,k)\\,\\right| \\;\\le\\; \\gamma,\n$$\n对于尽可能小的 $\\gamma$，并受到强制非平凡回路增益的严格低频跟踪要求的约束：\n$$\n\\text{unit-step steady-state error} \\;\\; e_{\\mathrm{ss}} \\;=\\; \\frac{1}{1 + k\\,P(0;\\,\\omega_n,\\zeta)} \\;=\\; \\frac{1}{1+k} \\;\\le\\; \\varepsilon_{\\max}.\n$$\n此不等式必须对不确定性集合中的所有 $(\\omega_n,\\zeta)$ 成立，注意对于所有容许的 $\\omega_n,\\zeta$，$P(0;\\,\\omega_n,\\zeta)=1$。因此控制器增益必须满足\n$$\nk \\;\\ge\\; k_{\\mathrm{req}} \\;\\triangleq\\; \\frac{1 - \\varepsilon_{\\max}}{\\varepsilon_{\\max}}.\n$$\n只允许使用稳定增益；给定 $\\zeta0$，如果 $k  -1$，则对于所有对象，闭环系统保持渐近稳定，并且搜索范围被限制在 $k \\ge k_{\\mathrm{req}} \\ge 0$。\n\n您必须编写一个完整的、可运行的程序，该程序：\n- 强制执行稳态跟踪约束 $k \\ge k_{\\mathrm{req}}$。\n- 在指定区间 $[\\,k_{\\mathrm{req}},\\,k_{\\max}\\,]$ 内的控制器增益 $k$ 的有限网格上进行搜索，以最小化最差情况下的界 $\\gamma$。\n- 使用网格化频域分析来近似最差情况下的界：\n  - 频率网格：在 $[\\,\\omega_{\\min},\\,\\omega_{\\max}\\,]$ 上对数间隔分布的 $N_{\\omega}$ 个点。\n  - 不确定性网格：在 $[\\,\\omega_{n,\\min},\\,\\omega_{n,\\max}\\,]$ 和 $[\\,\\zeta_{\\min},\\,\\zeta_{\\max}\\,]$ 上为每个参数均匀间隔分布的 $N_{u}$ 个点（形成 $N_u \\times N_u$ 个对象的笛卡爾积）。\n  - 对于每个候选 $k$，计算\n    $$\n    \\gamma(k) \\;=\\; \\max_{(\\omega_n,\\zeta)\\in\\mathcal{U}} \\;\\max_{\\omega\\in\\Omega} \\; \\left|\\,T(jomega;\\,\\omega_n,\\zeta,k)\\,\\right|,\n    $$\n    其中 $\\mathcal{U}$ 和 $\\Omega$ 表示所选的网格。\n  - 选择在 $k$-网格上最小化 $\\gamma(k)$ 的控制器增益 $k^\\star$，并报告相应的 $\\gamma^\\star$。\n\n所有角度和频率的单位必须是弧度/秒。为确保可测试性，程序必须遵守以下离散化和格式化要求：\n- 在 $\\omega_{\\min}$ 和 $\\omega_{\\max}$ 之間使用 $N_{\\omega} = 600$ 个对数间隔的频率点。\n- 为 $\\omega_n$ 和 $\\zeta$ 各使用 $N_u = 7$ 个均匀间隔的网格点，包括区间端点。\n- 在 $[\\,k_{\\mathrm{req}},\\,k_{\\max}\\,]$ 中使用 $N_k = 121$ 个均匀间隔的控制器增益，包括端点。\n- 对于每个测试用例，将最小界 $\\gamma^\\star$ 输出为精确到小数点后 $6$ 位的浮点小数。\n\n测试套件。您的程序必须解决以下三种情况的综合与验证任务，并将结果报告在一行中：\n- 情况 1：$\\omega_{n,\\min}=0.8$, $\\omega_{n,\\max}=1.2$, $\\zeta_{\\min}=0.05$, $\\zeta_{\\max}=0.20$, $\\varepsilon_{\\max}=0.10$, $\\omega_{\\min}=0.01$, $\\omega_{\\max}=100.0$, $k_{\\max}=40.0$。\n- 情况 2：$\\omega_{n,\\min}=1.0$, $\\omega_{n,\\max}=1.0$, $\\zeta_{\\min}=0.30$, $\\zeta_{\\max}=0.30$, $\\varepsilon_{\\max}=0.20$, $\\omega_{\\min}=0.01$, $\\omega_{\\max}=100.0$, $k_{\\max}=40.0$。\n- 情况 3：$\\omega_{n,\\min}=0.5$, $\\omega_{n,\\max}=2.0$, $\\zeta_{\\min}=0.05$, $\\zeta_{\\max}=0.30$, $\\varepsilon_{\\max}=0.10$, $\\omega_{\\min}=0.01$, $\\omega_{\\max}=200.0$, $k_{\\max}=40.0$。\n\n最终输出格式。您的程序应生成单行输出，其中包含案例 1 到 3 的三个 $\\gamma^\\star$ 值，按顺序排列，形式为方括号括起来的逗号分隔列表，例如，\n\"[0.000000,0.000000,0.000000]\"。", "solution": "问题陈述经过严格验证，并被认定为有效。它构成了鲁棒控制理论中的一个适定问题，具有科学依据，且无矛盾或歧义。唯一数值解所需的所有必要参数和约束均已提供。因此，我们可以着手推导和实现解决方案。\n\n该问题要求为一系列不确定的二阶谐振对象族综合一个静态比例控制器 $K(s) = k$。目标是在满足稳态跟踪性能约束的条件下，最小化互补灵敏度函数的最差情况峰值幅值。\n\n首先，我们将控制系统的组成部分形式化。对象由传递函数描述：\n$$\nP(s;\\,\\omega_n,\\zeta) \\;=\\; \\frac{\\omega_n^2}{s^2 + 2\\,\\zeta\\,\\omega_n\\,s + \\omega_n^2}\n$$\n参数 $\\omega_n$（自然频率）和 $\\zeta$（阻尼比）是不确定的，并且位于指定的区间内：\n$$\n\\omega_n \\in [\\,\\omega_{n,\\min},\\,\\omega_{n,\\max}\\,], \\quad \\zeta \\in [\\,\\zeta_{\\min},\\,\\zeta_{\\max}\\,], \\quad \\zeta  0\n$$\n控制器是一个简单的增益 $K(s) = k$。对于单位反馈配置，回路传递函数为 $L(s) = K(s)P(s) = kP(s)$。互补灵敏度函数 $T(s)$，也是从参考到输出的闭环传递函数，由下式给出：\n$$\nT(s) \\;=\\; \\frac{L(s)}{1 + L(s)} \\;=\\; \\frac{k\\,P(s)}{1 + k\\,P(s)}\n$$\n代入 $P(s)$ 的表达式，我们得到：\n$$\nT(s;\\,k,\\omega_n,\\zeta) \\;=\\; \\frac{k \\frac{\\omega_n^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}}{1 + k \\frac{\\omega_n^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}} \\;=\\; \\frac{k\\,\\omega_n^2}{s^2 + 2\\zeta\\omega_n s + (1+k)\\omega_n^2}\n$$\n控制器增益 $k$ 必须滿足两个基本约束。\n1.  **闭环稳定性：** $T(s)$ 的极点是特征方程 $s^2 + 2\\zeta\\omega_n s + (1+k)\\omega_n^2 = 0$ 的根。为保证渐近稳定性，鉴于 $\\zeta  0$ 且 $\\omega_n  0$，所有系数必须为正。这要求 $1+k  0$，即 $k  -1$。\n2.  **稳态跟踪性能：** 单位阶跃输入的稳态误差为 $e_{\\mathrm{ss}} = \\frac{1}{1+L(0)}$。由于 $P(0) = 1$，我们有 $L(0) = k$。约束条件是 $e_{\\mathrm{ss}} = \\frac{1}{1+k} \\le \\varepsilon_{\\max}$。假设 $\\varepsilon_{\\max} \\in (0, 1)$，这意味着 $1 \\le \\varepsilon_{\\max}(1+k)$，整理后得到 $k \\ge \\frac{1}{\\varepsilon_{\\max}} - 1$。我们将此最小所需增益定义为：\n    $$\n    k_{\\mathrm{req}} \\;\\triangleq\\; \\frac{1 - \\varepsilon_{\\max}}{\\varepsilon_{\\max}}\n    $$\n    由于 $\\varepsilon_{\\max}$ 通常小于 $1$，$k_{\\mathrm{req}}$ 是正数，因此稳定性约束 $k  -1$ 自动得到满足。\n\n综合目标是在允许范围 $[\\,k_{\\mathrm{req}}, k_{\\max}\\,]$ 内找到增益 $k$，以最小化在整个不确定对象集合上评估的互补灵敏度函数的 $\\mathcal{H}_{\\infty}$ 范数。在此背景下，$\\mathcal{H}_{\\infty}$ 范数是频率响应的峰值幅值：\n$$\n\\gamma(k) \\;=\\; \\sup_{\\omega, \\omega_n, \\zeta} \\; \\left|\\,T(j\\omega;\\,k,\\omega_n,\\zeta)\\,\\right|\n$$\n最优增益 $k^\\star$ 和相应的最小保证性能界 $\\gamma^\\star$ 为：\n$$\nk^\\star = \\arg\\min_{k \\ge k_{\\mathrm{req}}} \\gamma(k), \\quad \\gamma^\\star = \\gamma(k^\\star)\n$$\n这个极小化极大问题的解析解是棘手的。因此，我们采用指定的数值方法，该方法依赖于将连续参数空间离散化。搜索在 $N_k$ 个控制器增益的网格上进行。对于每个候选增益 $k$，性能界 $\\gamma(k)$ 通过在频率离散网格 $\\Omega$ 和对象参数离散网格 $\\mathcal{U}$ 上评估 $|T(j\\omega)|$ 来近似：\n$$\n\\gamma(k) \\approx \\max_{(\\omega_n,\\zeta)\\in\\mathcal{U}} \\;\\max_{\\omega\\in\\Omega} \\; \\left|\\,T(j\\omega;\\,k,\\omega_n,\\zeta)\\,\\right|\n$$\n该计算的核心是 $T(s)$ 频率响应的幅值。通过代入 $s = j\\omega$，我们发现：\n$$\n|T(j\\omega;\\,k,\\omega_n,\\zeta)| \\;=\\; \\frac{|k\\,\\omega_n^2|}{|((1+k)\\omega_n^2 - \\omega^2) + j(2\\zeta\\omega_n\\omega)|} \\;=\\; \\frac{k\\,\\omega_n^2}{\\sqrt{((1+k)\\omega_n^2 - \\omega^2)^2 + (2\\zeta\\omega_n\\omega)^2}}\n$$\n该表达式针对由网格定义的 4 维参数空间 $(k, \\omega_n, \\zeta, \\omega)$ 中的每个点进行评估。\n-   控制器网格: $k \\in \\{k_1, ..., k_{N_k}\\} \\subset [k_{\\mathrm{req}}, k_{\\max}]$。\n-   不确定性网格: $(\\omega_n, \\zeta) \\in \\{\\omega_{n,1},...,\\omega_{n,N_u}\\} \\times \\{\\zeta_1,...,\\zeta_{N_u}\\}$。\n-   频率网格: $\\omega \\in \\{\\omega_1,...,\\omega_{N_\\omega}\\} \\subset [\\omega_{\\min}, \\omega_{\\max}]$。\n\n对于每个 $k_i$，我们通过在 $\\omega$、$\\omega_n$ 和 $\\zeta$ 的网格上找到最大幅值来计算 $\\gamma(k_i)$。最终解 $\\gamma^\\star$ 是在所有 $\\gamma(k_i)$ 中找到的最小值。该实现利用 NumPy 库的矢量化计算来高效处理多维网格评估。网格被扩展为 4D 结构，允许对所有参数组合进行 $|T(j\\omega)|^2$ 的单次计算，然后通过一系列最大化操作找到每个 $k$ 的 $\\gamma(k)$，最后找到关于 $k$ 的最小值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the robust control synthesis and verification problem for three test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"omega_n_min\": 0.8, \"omega_n_max\": 1.2,\n            \"zeta_min\": 0.05, \"zeta_max\": 0.20,\n            \"epsilon_max\": 0.10, \"omega_min\": 0.01,\n            \"omega_max\": 100.0, \"k_max\": 40.0\n        },\n        {\n            \"omega_n_min\": 1.0, \"omega_n_max\": 1.0,\n            \"zeta_min\": 0.30, \"zeta_max\": 0.30,\n            \"epsilon_max\": 0.20, \"omega_min\": 0.01,\n            \"omega_max\": 100.0, \"k_max\": 40.0\n        },\n        {\n            \"omega_n_min\": 0.5, \"omega_n_max\": 2.0,\n            \"zeta_min\": 0.05, \"zeta_max\": 0.30,\n            \"epsilon_max\": 0.10, \"omega_min\": 0.01,\n            \"omega_max\": 200.0, \"k_max\": 40.0\n        }\n    ]\n\n    # Discretization parameters\n    N_omega = 600\n    N_u = 7\n    N_k = 121\n\n    results = []\n\n    for case in test_cases:\n        # Extract parameters for the current case\n        omega_n_min, omega_n_max = case[\"omega_n_min\"], case[\"omega_n_max\"]\n        zeta_min, zeta_max = case[\"zeta_min\"], case[\"zeta_max\"]\n        epsilon_max = case[\"epsilon_max\"]\n        omega_min, omega_max = case[\"omega_min\"], case[\"omega_max\"]\n        k_max = case[\"k_max\"]\n\n        # Calculate the required gain from the steady-state error constraint\n        k_req = (1.0 - epsilon_max) / epsilon_max\n\n        # Create the discrete grids for all parameters\n        k_grid = np.linspace(k_req, k_max, N_k)\n        omega_n_grid = np.linspace(omega_n_min, omega_n_max, N_u)\n        zeta_grid = np.linspace(zeta_min, zeta_max, N_u)\n        omega_grid = np.logspace(np.log10(omega_min), np.log10(omega_max), N_omega)\n        \n        # Reshape grids to enable broadcasting for vectorized computation.\n        # Dimensions: (omega, omega_n, zeta, k)\n        w = omega_grid[:, np.newaxis, np.newaxis, np.newaxis]\n        wn = omega_n_grid[np.newaxis, :, np.newaxis, np.newaxis]\n        z = zeta_grid[np.newaxis, np.newaxis, :, np.newaxis]\n        k = k_grid[np.newaxis, np.newaxis, np.newaxis, :]\n\n        # Calculate the squared magnitude of the complementary sensitivity function T(jw)\n        # |T(jw)|^2 = (k * wn^2)^2 / ( ((1+k)*wn^2 - w^2)^2 + (2*z*wn*w)^2 )\n        # To prevent potential division by zero if a denominator is zero,\n        # a small epsilon is added. Given the problem constraints, this is unlikely.\n        \n        numerator_sq = (k * wn**2)**2\n        \n        real_part_den = ((1 + k) * wn**2 - w**2)\n        imag_part_den = (2 * z * wn * w)\n        denominator_sq = real_part_den**2 + imag_part_den**2\n\n        # Avoid division by zero, although it is not expected for this problem.\n        denominator_sq[denominator_sq == 0] = 1e-18\n        \n        T_mag_sq = numerator_sq / denominator_sq\n\n        # For each k, find the maximum magnitude over the omega, omega_n, and zeta grids.\n        # This gives gamma(k)^2 for each k in the grid.\n        # The axes to maximize over are 0 (omega), 1 (omega_n), and 2 (zeta).\n        gamma_sq_per_k = np.max(T_mag_sq, axis=(0, 1, 2))\n        \n        # Calculate gamma(k)\n        gamma_per_k = np.sqrt(gamma_sq_per_k)\n\n        # Find the minimum gamma value across all controller gains k.\n        min_gamma_star = np.min(gamma_per_k)\n        \n        results.append(min_gamma_star)\n    \n    # Format the final output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2740224"}]}