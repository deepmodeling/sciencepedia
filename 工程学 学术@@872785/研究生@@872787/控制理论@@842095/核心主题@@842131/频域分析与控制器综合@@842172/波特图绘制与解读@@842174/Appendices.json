{"hands_on_practices": [{"introduction": "非最小相位（NMP）系统在控制理论中提出了一项独特的挑战。它们的频率响应幅值图可能与一个稳定、易于控制的最小相位系统完全相同，但其相位特性却截然不同，通常会引入显著的相位滞后，从而限制了可实现的性能并使控制设计复杂化。本练习旨在通过一个具体的计算任务，揭示右半平面零点对系统相位裕度的影响，从而帮助您从根本上理解为什么仅凭幅值图不足以评估系统的动态行为。[@problem_id:2690779]", "problem": "考虑单输入单输出开环传递函数\n$$\nL(s) \\;=\\; K\\,G(s), \\qquad G(s) \\;=\\; \\frac{1 - s/z}{1 + s/p},\n$$\n其中 $z0$，$p0$，且实数增益 $K0$。分子零点位于右半平面（RHP），在 $s=z$ 处；极点位于左半平面（LHP），在 $s=-p$ 处。仅使用频率响应的正弦稳态定义、复数的模与幅角以及基本的代数变换。\n\n任务：\n- 从频率响应 $G(\\mathrm{j}\\omega)$ 的定义出发，推导增益交越频率 $\\omega_{gc}$ 的精确解析表达式，该频率由条件 $|L(\\mathrm{j}\\omega_{gc})|=1$ 定义，表达式应以 $K$、$z$ 和 $p$ 表示。明确说明存在正实数解 $\\omega_{gc}$ 的所有条件。\n- 将您的解析表达式应用于参数值 $K=0.5$，$z=2$ rad/s 和 $p=10$ rad/s，并数值计算 $\\omega_{gc}$。\n- 使用 $G(\\mathrm{j}\\omega)$ 的精确相位，确定给定 RHP 零点时的开环相位 $\\angle L(\\mathrm{j}\\omega_{gc})$，并将其与一个假设的最小相位对应系统的相位进行比较，该最小相位系统的分子被替换为 $1 + s/z$，同时保持相同的 $K$、$z$ 和 $p$。从基本原理出发，解释 RHP 零点如何相对于最小相位对应系统改变在 $\\omega_{gc}$ 处的相位裕度。所有角度均以度表示。\n\n答案规格：\n- 仅报告当 $K=0.5$，$z=2$ rad/s，$p=10$ rad/s 时增益交越频率 $\\omega_{gc}$ 的数值。\n- 以 rad/s 为单位表示 $\\omega_{gc}$。\n- 将您的答案四舍五入到 $4$ 位有效数字。", "solution": "所提出的问题表述清晰、科学严谨且自成体系。这是线性控制理论中的一个标准问题，适合进行分析。我们将着手进行推导和求解。\n\n开环传递函数由下式给出\n$$\nL(s) = K \\frac{1 - s/z}{1 + s/p}\n$$\n其中 $K  0$，$z  0$ 且 $p  0$。位于 $s = z$ 的零点在右半平面（RHP），因此这是一个非最小相位系统。\n\n首先，我们推导增益交越频率 $\\omega_{gc}$ 的表达式。根据定义，这是频率响应幅值为1时对应的频率 $\\omega  0$。通过代入 $s = \\mathrm{j}\\omega$ 获得频率响应：\n$$\nL(\\mathrm{j}\\omega) = K \\frac{1 - \\mathrm{j}\\omega/z}{1 + \\mathrm{j}\\omega/p}\n$$\n其幅值由该复变函数的模给出：\n$$\n|L(\\mathrm{j}\\omega)| = |K| \\frac{|1 - \\mathrm{j}\\omega/z|}{|1 + \\mathrm{j}\\omega/p|}\n$$\n由于 $K$ 是正实数增益，所以 $|K|=K$。分子的模为 $|1 - \\mathrm{j}\\omega/z| = \\sqrt{1^2 + (-\\omega/z)^2} = \\sqrt{1 + (\\omega/z)^2}$。分母的模为 $|1 + \\mathrm{j}\\omega/p| = \\sqrt{1^2 + (\\omega/p)^2} = \\sqrt{1 + (\\omega/p)^2}$。因此，幅值为：\n$$\n|L(\\mathrm{j}\\omega)| = K \\sqrt{\\frac{1 + \\omega^2/z^2}{1 + \\omega^2/p^2}}\n$$\n增益交越条件为 $|L(\\mathrm{j}\\omega_{gc})|=1$。\n$$\n1 = K \\sqrt{\\frac{1 + \\omega_{gc}^2/z^2}{1 + \\omega_{gc}^2/p^2}}\n$$\n为了求解 $\\omega_{gc}$，我们将方程两边平方并重新整理：\n$$\n\\frac{1}{K^2} = \\frac{1 + \\omega_{gc}^2/z^2}{1 + \\omega_{gc}^2/p^2}\n$$\n$$\n1 + \\frac{\\omega_{gc}^2}{p^2} = K^2 \\left(1 + \\frac{\\omega_{gc}^2}{z^2}\\right) = K^2 + \\frac{K^2 \\omega_{gc}^2}{z^2}\n$$\n我们合并包含 $\\omega_{gc}^2$ 的项：\n$$\n\\omega_{gc}^2 \\left(\\frac{1}{p^2} - \\frac{K^2}{z^2}\\right) = K^2 - 1\n$$\n$$\n\\omega_{gc}^2 \\left(\\frac{z^2 - K^2 p^2}{p^2 z^2}\\right) = K^2 - 1\n$$\n求解 $\\omega_{gc}^2$ 可得：\n$$\n\\omega_{gc}^2 = \\frac{p^2 z^2 (K^2 - 1)}{z^2 - K^2 p^2}\n$$\n为了使正实数解 $\\omega_{gc}$ 存在，$\\omega_{gc}^2$ 的表达式必须为正。由于 $p^2 z^2$ 总是正的，此条件等价于：\n$$\n\\frac{K^2 - 1}{z^2 - K^2 p^2}  0\n$$\n该不等式成立的充要条件是分子和分母同号。\n情况1：$K^2 - 1  0$ 且 $z^2 - K^2 p^2  0$。这意味着 $K  1$ 且 $z  Kp$，或 $K  z/p$。\n情况2：$K^2 - 1  0$ 且 $z^2 - K^2 p^2  0$。这意味着 $0  K  1$ 且 $z  Kp$，或 $K  z/p$。\n这两个条件可以通过观察直流增益 $|L(0)| = K$ 和高频增益 $\\lim_{\\omega \\to \\infty} |L(\\mathrm{j}\\omega)| = K(p/z)$ 来进行总结。唯一交越频率存在的充要条件是，增益幅值图穿过单位1，这意味着单位增益必须位于直流增益和高频增益之间。即 $(|L(0)|-1)(|L(\\mathrm{j}\\infty)|-1)  0$，或 $(K-1)(Kp/z - 1)  0$。这恰好等价于上面推导出的两种情况。\n\n现在，我们将问题具体化到给定的参数值：$K=0.5$，$z=2 \\text{ rad/s}$ 和 $p=10 \\text{ rad/s}$。\n我们检查解存在的条件。这里，$K=0.5  1$。我们必须属于情况2，该情况要求 $K  z/p$。\n$z/p = 2/10 = 0.2$。条件是 $0.5  0.2$，这是成立的。因此，$\\omega_{gc}$ 存在唯一的正实数解。\n我们将这些值代入推导出的 $\\omega_{gc}^2$ 表达式中：\n$$\n\\omega_{gc}^2 = \\frac{10^2 \\cdot 2^2 \\cdot (0.5^2 - 1)}{2^2 - 0.5^2 \\cdot 10^2} = \\frac{100 \\cdot 4 \\cdot (0.25 - 1)}{4 - 0.25 \\cdot 100} = \\frac{400(-0.75)}{4 - 25} = \\frac{-300}{-21} = \\frac{100}{7}\n$$\n增益交越频率为：\n$$\n\\omega_{gc} = \\sqrt{\\frac{100}{7}} = \\frac{10}{\\sqrt{7}} \\approx 3.7796447... \\text{ rad/s}\n$$\n四舍五入到4位有效数字，我们得到 $\\omega_{gc} \\approx 3.780$ rad/s。\n\n接下来，我们分析相位。开环系统的相位是：\n$$\n\\angle L(\\mathrm{j}\\omega) = \\angle(1 - \\mathrm{j}\\omega/z) - \\angle(1 + \\mathrm{j}\\omega/p) = -\\arctan(\\omega/z) - \\arctan(\\omega/p)\n$$\n在 $\\omega_{gc} = 10/\\sqrt{7}$ 处，相位是：\n$$\n\\angle L(\\mathrm{j}\\omega_{gc}) = -\\arctan\\left(\\frac{10/\\sqrt{7}}{2}\\right) - \\arctan\\left(\\frac{10/\\sqrt{7}}{10}\\right) = -\\arctan\\left(\\frac{5}{\\sqrt{7}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{7}}\\right)\n$$\n数值上，$\\arctan(5/\\sqrt{7}) \\approx 62.10^\\circ$ 且 $\\arctan(1/\\sqrt{7}) \\approx 20.70^\\circ$。\n所以，$\\angle L(\\mathrm{j}\\omega_{gc}) \\approx -62.10^\\circ - 20.70^\\circ = -82.80^\\circ$。\n\n假设的最小相位（MP）对应系统的传递函数为 $L_{MP}(s) = K \\frac{1 + s/z}{1 + s/p}$。其幅值为 $|L_{MP}(\\mathrm{j}\\omega)| = K \\sqrt{\\frac{1 + (\\omega/z)^2}{1 + (\\omega/p)^2}}$，与 $|L(\\mathrm{j}\\omega)|$ 相同。因此，其增益交越频率也是 $\\omega_{gc} = 10/\\sqrt{7}$ rad/s。\n然而，最小相位系统的相位是不同的：\n$$\n\\angle L_{MP}(\\mathrm{j}\\omega) = \\angle(1 + \\mathrm{j}\\omega/z) - \\angle(1 + \\mathrm{j}\\omega/p) = \\arctan(\\omega/z) - \\arctan(\\omega/p)\n$$\n在 $\\omega_{gc}$ 处，最小相位系统的相位为：\n$$\n\\angle L_{MP}(\\mathrm{j}\\omega_{gc}) = \\arctan\\left(\\frac{5}{\\sqrt{7}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{7}}\\right) \\approx 62.10^\\circ - 20.70^\\circ = 41.40^\\circ\n$$\n\nRHP 零点的影响现在很清楚了。对于任何频率 $\\omega$，无论是 $1-s/z$ 还是 $1+s/z$ 的零点项，其幅值贡献都是相同的：$\\sqrt{1+(\\omega/z)^2}$。这就是为什么 $\\omega_{gc}$ 不变的原因。\n相位的贡献则有根本的不同。一个最小相位零点 $1+s/z$ 贡献一个正相位（相位超前），大小为 $\\arctan(\\omega/z)$，从 $0$ 增加到 $90^\\circ$。一个非最小相位零点 $1-s/z$ 贡献一个负相位（相位滞后），大小为 $-\\arctan(\\omega/z)$，从 $0$ 减小到 $-90^\\circ$。\n在增益交越频率 $\\omega_{gc}$ 处，RHP 零点贡献了 $-\\arctan(\\omega_{gc}/z)$ 的相位滞后，而其最小相位对应系统则会贡献 $\\arctan(\\omega_{gc}/z)$ 的相位超前。因此，RHP 系统和最小相位系统之间的相位差为 $-2\\arctan(\\omega_{gc}/z)$。对于给定的参数，这个额外的相位滞后是 $-2 \\times 62.10^\\circ = -124.2^\\circ$。\n相位裕度 $PM = 180^\\circ + \\angle L(\\mathrm{j}\\omega_{gc})$ 受到了直接影响。\n对于 RHP 系统，$PM_{RHP} = 180^\\circ - 82.80^\\circ = 97.2^\\circ$。\n对于 MP 系统，$PM_{MP} = 180^\\circ + 41.40^\\circ = 221.4^\\circ$。\n与最小相位对应系统相比，RHP 零点使相位裕度减小了 $2\\arctan(\\omega_{gc}/z) = 124.2^\\circ$。这证明了 RHP 零点的性能限制特性：它们在增加增益的同时引入相位滞后，这种组合会降低稳定性裕度。\n问题只要求 $\\omega_{gc}$ 的数值。", "answer": "$$\n\\boxed{3.780}\n$$", "id": "2690779"}, {"introduction": "在实际系统中，并非所有动态特性都像教科书中的例子那样清晰可见。近似的极零点对消便是一个典型例子，它在标准的波特图上可能只留下微弱的痕迹，容易被测量噪声掩盖，但却可能对系统的鲁棒性产生重要影响。这项练习将引导您超越基本的波特图分析，探索如何利用群延迟和希尔伯特变换等高级技术来识别这些“脆弱”或隐藏的动态，这是系统辨识和鲁棒控制设计的关键技能。[@problem_id:2690786]", "problem": "一个单输入单输出 (SISO) 线性时不变 (LTI) 对象 $G(s)$ 已知在频率 $z0$ 附近包含一个几乎对消的实数极点-零点对。具体地，写作\n$$\nG(s) \\;=\\; K\\,\\frac{1 + s/z}{1 + s/p}\\,H(s),\n$$\n其中 $K0$ 是一个实常数，$H(s)$ 是最小相位的，并且是平滑的，在 $z$ 的一个十倍频程内没有极点或零点，且极点和零点相近但不相等：$p = z\\,(1+\\varepsilon)$，其中 $0  |\\varepsilon| \\ll 1$。在包含 $z$ 的一个频率窗口内，可以获得 $G(j\\omega)$ 的高分辨率波特图测量数据。\n\n从第一性原理出发（频率响应的定义、一阶因子的幅值和相位、以及波特图的性质），论证这种近似的极点-零点对消在幅频和相频波特图中是如何体现的，包括任何残余特征在尺度上如何用 $\\varepsilon$ 表示。然后，考虑即使当残余特征接近测量噪声基底时，也能可靠地检测这种脆弱对消的方法。\n\n下列哪些陈述是有效的？选择所有适用的选项。\n\nA. 在幅频波特图中，几乎对消的极零点对贡献了一个几乎平坦的响应，在 $\\omega\\approx z$ 附近的转折区产生一个量级为 $\\mathcal{O}(\\varepsilon)$ 分贝的微小净阶跃，并且相位表现出一个小的残余超前或滞后凸起，其峰值在 $\\omega\\approx z$ 附近约为 $\\varepsilon/2$ 弧度。一种实用的检测器是估计群延迟 $-\\mathrm{d}\\angle G(j\\omega)/\\mathrm{d}\\omega$ 或对数幅值相对于 $\\log \\omega$ 的局部曲率，这两种方法都能放大这个微小的频率局部化残余特征。\n\nB. 近似对消会完全消除极点和零点在幅频和相频中的任何痕迹，因此从波特图数据中检测是不可能的；只有时域阶跃响应才能揭示它。\n\nC. 即使对于任意小的 $|\\varepsilon|$，在公共转折点的两侧，幅频斜率也会变化约 $\\pm 20$ dB/十倍频程，并且在 $\\omega\\approx z$ 附近相移会跳跃近 $90^\\circ$；最可靠的检测器是在多个十倍频程上对幅值进行平均以抑制噪声。\n\nD. 一个近似的实数极点-零点对消的特征是在 $\\omega=\\sqrt{zp}$ 处幅值出现一个精确的零点，并伴有 $180^\\circ$ 的相位包裹；检测简化为定位这个陷波点。\n\nE. 对于小的 $|\\varepsilon|$，几乎对消的极零点对的残余效应可以建模为两个重合的一阶转折贡献之差，它们沿 $\\ln \\omega$ 轴相隔 $|\\ln(p/z)|\\approx|\\varepsilon|$，因此局部上它类似于单个转折形状的缩放导数（相对于 $\\ln \\omega$）。一个可靠的检测器是在转折点附近的局部窗口内将数据拟合到参数模板 $(1+s/z)/(1+s/p)$，或者通过在 $\\log|G(j\\omega)|$ 和 $\\angle G(j\\omega)$ 之间进行希尔伯特变换一致性检验来强制执行波特增益-相位关系；统计上显著的不一致性表明存在脆弱对消。", "solution": "首先将对问题陈述进行严格验证。\n\n### 第 1 步：提取已知条件\n- 对象是一个单输入单输出 (SISO) 线性时不变 (LTI) 系统，$G(s)$。\n- 传递函数由 $G(s) = K\\,\\frac{1 + s/z}{1 + s/p}\\,H(s)$ 给出。\n- $K  0$ 是一个实常数。\n- $z  0$ 是一个实数零点的频率。\n- $p = z\\,(1+\\varepsilon)$ 是一个实数极点的频率。\n- 参数 $\\varepsilon$ 满足 $0  |\\varepsilon| \\ll 1$。\n- $H(s)$ 是一个最小相位传递函数。\n- $H(s)$ 是“平滑的”，并且在频率 $z$ 的一个十倍频程内没有极点或零点。\n- 可以获得 $G(j\\omega)$ 的高分辨率波特图测量数据。\n- 任务是分析近似极点-零点对消的波特图特征，并评估其检测方法。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题陈述的有效性进行审查。\n- **科学依据**：该问题在经典控制理论和系统辨识方面有充分的依据。近似极点-零点对消的模型是标准的。所引用的概念，如波特图、最小相位系统、群延迟和波特增益-相位关系（希尔伯特变换），都是这些领域的基本原理。\n- **适定性**：该问题是适定的。系统定义清晰，假设（例如，$H(s)$ 在 $z$ 附近的平滑性）适合用于分离出感兴趣的现象。问题要求进行定性和半定量分析，并为此提供了足够的信息。可以推导出一个唯一的逻辑结论。\n- **客观性**：语言技术性强、精确且客观。没有会妨碍严谨分析的主观或模糊术语。\n- **其他缺陷**：该问题没有违反任何其他有效性标准。对具有小参数 ($\\varepsilon$) 的系统进行分析是工程和物理学中一个标准且重要的课题，需要仔细的近似处理。\n\n### 第 3 步：结论和行动\n问题是有效的。将推导一个完整的解决方案。\n\n### 推导\n分析将集中在极点-零点对项上，我们将其定义为 $G_{pz}(s) = \\frac{1 + s/z}{1 + s/p}$。由于问题陈述指出背景传递函数 $H(s)$ 在 $\\omega=z$ 附近的频率区域内是平滑的，其波特图在该局部区域内将贡献一个基本恒定的增益和线性相位（恒定的群延迟）。因此，近似对消的特征签名完全包含在 $G_{pz}(j\\omega)$ 的频率响应中。\n\n该项的频率响应为 $G_{pz}(j\\omega) = \\frac{1 + j\\omega/z}{1 + j\\omega/p}$。\n\n**幅值分析**\n以分贝表示的幅值为：\n$$M_{pz}(\\omega) = 20 \\log_{10} |G_{pz}(j\\omega)| = 20 \\log_{10}\\left(\\frac{\\sqrt{1+(\\omega/z)^2}}{\\sqrt{1+(\\omega/p)^2}}\\right)$$\n我们考察其渐近行为：\n- 对于低频，$\\omega \\ll z$（因此 $\\omega \\ll p$），$|G_{pz}(j\\omega)| \\approx 1$，所以 $M_{pz}(\\omega) \\approx 0$ dB。\n- 对于高频，$\\omega \\gg p$（因此 $\\omega \\gg z$），$|G_{pz}(j\\omega)| \\approx \\frac{\\omega/z}{\\omega/p} = \\frac{p}{z}$。\n因此，跨越转折区的渐近增益差（阶跃）为：\n$$\\Delta M = 20 \\log_{10}\\left(\\frac{p}{z}\\right) = 20 \\log_{10}(1+\\varepsilon)$$\n使用自然对数的泰勒级数展开 $\\ln(1+x) \\approx x$（对于小的 $x$）以及恒等式 $\\log_{10}(x) = \\frac{\\ln(x)}{\\ln(10)}$，我们发现：\n$$\\Delta M \\approx 20 \\frac{\\varepsilon}{\\ln(10)} \\approx 8.686\\,\\varepsilon \\text{ dB}$$\n这证实了幅值阶跃非常小，量级为 $\\mathcal{O}(\\varepsilon)$。\n\n**相位分析**\n$G_{pz}(j\\omega)$ 的相位是：\n$$\\phi_{pz}(\\omega) = \\angle(1+j\\omega/z) - \\angle(1+j\\omega/p) = \\arctan(\\omega/z) - \\arctan(\\omega/p)$$\n为了找到最大相位偏差的频率，我们对 $\\omega$ 求导并令结果为零：\n$$\\frac{d\\phi_{pz}}{d\\omega} = \\frac{1/z}{1+(\\omega/z)^2} - \\frac{1/p}{1+(\\omega/p)^2} = 0$$\n这得出 $\\omega^2 = zp$。峰值相位出现在 $\\omega_{peak} = \\sqrt{zp}$。\n代入 $p = z(1+\\varepsilon)$，我们得到 $\\omega_{peak} = \\sqrt{z^2(1+\\varepsilon)} = z\\sqrt{1+\\varepsilon} \\approx z(1+\\varepsilon/2)$。峰值确实非常接近 $\\omega=z$。\n在该峰值处的相位值为：\n$$\\phi_{peak} = \\arctan(\\omega_{peak}/z) - \\arctan(\\omega_{peak}/p) = \\arctan(\\sqrt{p/z}) - \\arctan(\\sqrt{z/p})$$\n令 $x = \\sqrt{p/z} = \\sqrt{1+\\varepsilon}$。对于小的 $\\varepsilon$，$x \\approx 1+\\varepsilon/2$。峰值相位是 $\\phi_{peak} = \\arctan(x) - \\arctan(1/x)$。使用恒等式 $\\arctan(x) + \\arctan(1/x) = \\pi/2$（对于 $x0$），这变为 $\\phi_{peak} = 2\\arctan(x) - \\pi/2$。\n使用 $\\arctan(1+y)$ 在 $y=0$ 附近的泰勒展开，即 $\\arctan(1+y) \\approx \\pi/4 + y/2$，其中 $y = x-1 \\approx \\varepsilon/2$：\n$$\\arctan(x) = \\arctan(\\sqrt{1+\\varepsilon}) \\approx \\arctan(1+\\varepsilon/2) \\approx \\frac{\\pi}{4} + \\frac{1}{2}\\left(\\frac{\\varepsilon}{2}\\right) = \\frac{\\pi}{4} + \\frac{\\varepsilon}{4}$$\n将此代入 $\\phi_{peak}$ 的表达式中：\n$$\\phi_{peak} \\approx 2\\left(\\frac{\\pi}{4} + \\frac{\\varepsilon}{4}\\right) - \\frac{\\pi}{2} = \\left(\\frac{\\pi}{2} + \\frac{\\varepsilon}{2}\\right) - \\frac{\\pi}{2} = \\frac{\\varepsilon}{2} \\text{ radians}$$\n峰值相位偏差是一个小的“凸起”（如果 $\\varepsilon  0$ 则为超前，如果 $\\varepsilon  0$ 则为滞后），其大小约为 $|\\varepsilon|/2$ 弧度。\n\n**检测方法**\n残余特征的量级为 $\\mathcal{O}(\\varepsilon)$，很容易被测量噪声所掩盖。需要更灵敏的检测方案。\n- **基于导数的方法**：涉及对频率（或对数频率）求导的运算可以放大局部的、微小的特征。\n  1. **群延迟**：$\\tau_g(\\omega) = -d\\phi/d\\omega$。来自极点-零点对的贡献是 $\\tau_{g,pz}(\\omega) = -\\frac{d\\phi_{pz}}{d\\omega}$。该函数将在 $\\omega=z$ 附近呈现一个特征性的双极性形状，其振幅与 $\\varepsilon$ 成正比，使其比平缓的相位凸起更为显著。\n  2. **幅值曲率**：对数幅值相对于对数频率的二阶导数 $d^2(20\\log_{10}|G|)/d(\\ln \\omega)^2$ 也将显示一个与 $\\varepsilon$ 成正比的特征性（三极）签名。\n\n- **基于模型和一致性的方法**：\n  1. **参数拟合**：可以在一个频率窗口内，将包含项 $\\frac{1+s/z}{1+s/p}$ 的参数模型拟合到测量数据上。如果拟合在统计上是显著的，并且得出 $p \\approx z$，则检测并量化了该对消。\n  2. **希尔伯特变换（波特增益-相位关系）**：对于一个最小相位系统（$G(s)$ 就是，因为 $H(s)$ 是最小相位的，且极点和零点都在左半平面），相位由对数幅值响应通过希尔伯特变换唯一确定。可以从测量的幅值 $|G_{meas}(j\\omega)|$ 计算出预期的相位 $\\phi_{calc}(\\omega)$，并将其与测量的相位 $\\angle G_{meas}(j\\omega)$ 进行比较。两者之间系统性的、局部的偏差 $\\angle G_{meas} - \\phi_{calc}$，如果大于噪声所能解释的范围，则强烈表明存在一个微小的特征，如近似的极点-零点对消，而该特征未在幅值数据中被完全捕捉（可能由于噪声）。\n\n### 逐项分析\n\n**A. 在幅频波特图中，几乎对消的极零点对贡献了一个几乎平坦的响应，在 $\\omega\\approx z$ 附近的转折区产生一个量级为 $\\mathcal{O}(\\varepsilon)$ 分贝的微小净阶跃，并且相位表现出一个小的残余超前或滞后凸起，其峰值在 $\\omega\\approx z$ 附近约为 $\\varepsilon/2$ 弧度。一种实用的检测器是估计群延迟 $-\\mathrm{d}\\angle G(j\\omega)/\\mathrm{d}\\omega$ 或对数幅值相对于 $\\log \\omega$ 的局部曲率，这两种方法都能放大这个微小的频率局部化残余特征。**\n该陈述与上述推导完全一致。幅值阶跃为 $\\mathcal{O}(\\varepsilon)$ dB。峰值相位约为 $\\varepsilon/2$ 弧度。群延迟和幅值曲率确实是基于导数的方法，用于放大此类微小、局部的特征。\n**结论：正确。**\n\n**B. 近似对消会完全消除极点和零点在幅频和相频中的任何痕迹，因此从波特图数据中检测是不可能的；只有时域阶跃响应才能揭示它。**\n这是不正确的。“近似”对消意味着 $\\varepsilon \\ne 0$。对于任何非零的 $\\varepsilon$，如前所推导，在幅频和相频波特图中都有一个虽小但非零的特征。检测是困难的，但并非不可能。此外，时域特征（一个具有与 $\\varepsilon$ 成正比的小残差的慢模态）也很小，不一定更适合检测。\n**结论：不正确。**\n\n**C. 即使对于任意小的 $|\\varepsilon|$，在公共转折点的两侧，幅频斜率也会变化约 $\\pm 20$ dB/十倍频程，并且在 $\\omega\\approx z$ 附近相移会跳跃近 $90^\\circ$；最可靠的检测器是在多个十倍频程上对幅值进行平均以抑制噪声。**\n这描述的是单个、孤立的极点或零点的行为，而不是几乎对消的极零点对。对于一对极零点，这些效应在很大程度上相互抵消，留下一个量级为 $\\mathcal{O}(\\varepsilon)$ 的残余。该陈述根本上是错误的。所提出的检测器，即在多个十倍频程上进行平均，会破坏局部信息，因此对于此目的毫无意义。\n**结论：不正确。**\n\n**D. 一个近似的实数极点-零点对消的特征是在 $\\omega=\\sqrt{zp}$ 处幅值出现一个精确的零点，并伴有 $180^\\circ$ 的相位包裹；检测简化为定位这个陷波点。**\n这描述的是虚轴上的一对零点（例如，来自反谐振）的特征，而不是一个实数左半平面极点-零点对。幅值 $|G_{pz}(j\\omega)| = \\frac{\\sqrt{1 + (\\omega/z)^2}}{\\sqrt{1 + (\\omega/p)^2}}$ 对所有实数 $\\omega$ 都是严格为正的，没有零点。相移也很小，不是 $180^\\circ$。\n**结论：不正确。**\n\n**E. 对于小的 $|\\varepsilon|$，几乎对消的极零点对的残余效应可以建模为两个重合的一阶转折贡献之差，它们沿 $\\ln \\omega$ 轴相隔 $|\\ln(p/z)|\\approx|\\varepsilon|$，因此局部上它类似于单个转折形状的缩放导数（相对于 $\\ln \\omega$）。一个可靠的检测器是在转折点附近的局部窗口内将数据拟合到参数模板 $(1+s/z)/(1+s/p)$，或者通过在 $\\log|G(j\\omega)|$ 和 $\\angle G(j\\omega)$ 之间进行希尔伯特变换一致性检验来强制执行波特增益-相位关系；统计上显著的不一致性表明存在脆弱对消。**\n这个陈述是复杂且正确的。将残余效应描述为近似缩放导数的有限差分，是一个准确且有见地的模型。所提出的两种检测方法是系统辨识中用于解决此类问题的标准而强大的技术。参数模板拟合直接检验该假设。希尔伯特变换检验是一种鲁棒的方法，用于检测与平滑后的幅值图相一致的最简单最小相位模型的偏差，从而揭示微小的动态特性。\n**结论：正确。**", "answer": "$$\\boxed{AE}$$", "id": "2690786"}, {"introduction": "本节将理论付诸实践，提供一个全面的控制器设计挑战。您将面对一个固有的不稳定对象，任务是设计一个控制器，不仅要使其闭环稳定，还要同时满足一系列现代控制设计中常见的性能和鲁棒性指标，例如对灵敏度函数 $S$ 和补灵敏度函数 $T$ 的塑形。这个计算实践模拟了一个从指标设定到设计验证的完整工程任务，旨在综合运用您在频率域分析和设计方面的所有知识。[@problem_id:2690827]", "problem": "给定一个开环装置，其带有一个右半平面（RHP）极点。该装置的传递函数为\n$$\nP(s) \\;=\\; \\frac{s + 1}{(s - 1)(s + 3)} \\, ,\n$$\n它在 $s = +1$ 处有一个不稳定极点。您将通过将 $P(s)$ 与一个形式如下的控制器 $C(s)$ 相乘来构成环路传递函数 $L(s)$\n$$\nC(s) \\;=\\; k \\cdot \\frac{s/z + 1}{s/p + 1} \\cdot \\frac{1}{s/\\omega_f + 1} \\;=\\; k \\cdot \\frac{s + z}{s + p} \\cdot \\frac{\\omega_f}{s + \\omega_f} \\, ,\n$$\n其中 $k \\in \\mathbb{R}$ 是一个标量增益，$z$、$p$、$\\omega_f$ 是正常数（所有频率单位均为 $\\mathrm{rad/s}$）。因此\n$$\nL(s) \\;=\\; C(s) P(s) \\, ,\\quad S(s) \\;=\\; \\frac{1}{1 + L(s)} \\, ,\\quad T(s) \\;=\\; \\frac{L(s)}{1 + L(s)} \\, .\n$$\n\n您的任务是为 $L(j\\omega)$ 构建波特幅值和相位数据，然后，仅使用第一性原理和基于波特图的鲁棒性度量的核心定义，计算并验证以下性能和鲁棒性指标：\n\n- 闭环内部稳定性：$1 + L(s)$ 的特征多项式的所有极点必须具有严格为负的实部。\n- 灵敏度峰值：在对数间隔的频率网格上，$\\lvert S(j\\omega)\\rvert$ 的最大值不得超过 $2.0$。\n- 高频噪声衰减：在 $\\omega_{\\mathrm{na}} = 100$ $\\mathrm{rad/s}$ 处，$\\lvert T(j\\omega_{\\mathrm{na}})\\rvert$ 的值必须小于或等于 $0.5$。\n- 相位裕度（单位：度）：在最低的正单位增益穿越频率 $\\omega_{\\mathrm{gc}}$（其中 $\\lvert L(j\\omega_{\\mathrm{gc}})\\rvert = 1$）处，计算标准波特相位裕度为 $180 + \\angle L(j\\omega_{\\mathrm{gc}})$。相位裕度必须大于或等于 $35$ 度。角度必须以度表示。\n- 增益裕度（单位：分贝）：在任何相位穿越频率（其中 $\\angle L(j\\omega) = -180^\\circ + 360^\\circ m$，m为某个整数）处，计算增益裕度为幅值的倒数，并以分贝表示为 $20 \\log_{10}(\\mathrm{GM})$。如果不存在这样的相位穿越点，则增益裕度视为 $+\\infty$ 分贝。增益裕度必须大于或等于 $6$ 分贝，其中无限大的增益裕度被认为是可接受的。\n\n使用的基本依据和定义：\n\n- 波特幅值和相位是根据复频率响应 $L(j\\omega)$逐点定义的。\n- 灵敏度和互补灵敏度是逐点定义的，分别为 $S(j\\omega) = 1/(1 + L(j\\omega))$ 和 $T(j\\omega) = L(j\\omega)/(1 + L(j\\omega))$。\n- 单位增益穿越频率是任何满足 $\\lvert L(j\\omega_{\\mathrm{gc}})\\rvert = 1$ 的 $\\omega_{\\mathrm{gc}}  0$；如果存在多个，则使用最低的那个频率。\n- 在 $\\omega_{\\mathrm{gc}}$ 处的相位裕度是 $180$ 度加上以度表示的 $L(j\\omega_{\\mathrm{gc}})$ 的相位。\n- 增益裕度是在任何相位为 $-180$ 度模 $360$ 度的频率 $\\omega$ 处计算的；它是该频率下幅值的倒数，以分贝表示。如果不存在这样的穿越点，则增益裕度为 $+\\infty$ 分贝。\n\n实现要求：\n\n- 使用一个在 $\\omega \\in [10^{-3}, 10^{3}]$ $\\mathrm{rad/s}$ 范围内，至少包含 $4096$ 个点的对数间隔频率网格来近似所有频域量。\n- 角度必须以度为单位计算和报告。频率单位为 $\\mathrm{rad/s}$。\n- 必须通过构建 $1 + L(s)$ 的闭环特征多项式并验证其所有根的实部都严格为负来检查稳定性。\n- 在定位穿越频率时，在合适的尺度上进行线性插值。\n\n测试套件：\n\n评估以下三组控制器参数集 $(k, z, p, \\omega_f)$：\n\n- 情况 A (理想路径): $(k, z, p, \\omega_f) = (-20.0, 0.5, 5.0, 50.0)$。\n- 情况 B (近边界): $(k, z, p, \\omega_f) = (-8.0, 0.5, 5.0, 80.0)$。\n- 情况 C (边缘情况): $(k, z, p, \\omega_f) = (50.0, 0.5, 5.0, 50.0)$。\n\n对于每种情况，您的程序必须输出一个布尔值，指示是否同时满足所有接受条件：\n- 闭环内部稳定性为真，\n- $\\max_{\\omega} \\lvert S(j\\omega)\\rvert \\le 2.0$,\n- $\\lvert T(j100)\\rvert \\le 0.5$,\n- 相位裕度 $\\ge 35$ 度且有定义，\n- 增益裕度 $\\ge 6$ 分贝（无限大增益裕度可接受）。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含 A、B、C 三种情况的布尔结果，以逗号分隔并用方括号括起（例如，“[True,False,True]”）。不得打印任何其他文本。所有角度单位必须为度，所有频率单位必须为 $\\mathrm{rad/s}$，但输出仅包含指定的布尔值。", "solution": "所提出的问题是经典控制理论中一个明确定义的练习。它具有科学依据，是客观的，并包含了进行严谨分析所需的所有必要信息。因此，该问题被认为是有效的。\n\n任务是根据五个性能和鲁棒性标准，为给定的装置 $P(s)$ 评估三组控制器参数 $(k, z, p, \\omega_f)$。该装置被指定为 $P(s) = \\frac{s + 1}{(s - 1)(s + 3)}$，在 $s = 1$ 处有一个不稳定极点。控制器形式为 $C(s) = k \\cdot \\frac{s + z}{s + p} \\cdot \\frac{\\omega_f}{s + \\omega_f}$。开环传递函数为 $L(s) = C(s)P(s)$。\n\n设计了一个系统化的程序来根据指定要求验证每个参数集。每种情况的最终判定为真，当且仅当所有五个条件同时满足。\n\n步骤 1：闭环内部稳定性分析\n基本要求是闭环系统的稳定性。闭环系统的极点是特征方程 $1 + L(s) = 0$ 的根。这等同于求 $1 + L(s)$ 分子式的根。设该特征多项式为 $D_{CL}(s)$。\n$$\n1 + L(s) = 1 + k \\omega_f \\frac{(s+z)(s+1)}{(s+p)(s+\\omega_f)(s-1)(s+3)} = 0\n$$\n$$\nD_{CL}(s) = (s+p)(s+\\omega_f)(s-1)(s+3) + k \\omega_f (s+z)(s+1) = 0\n$$\n这是一个关于 $s$ 的四阶多项式，$D_{CL}(s) = c_4s^4 + c_3s^3 + c_2s^2 + c_1s + c_0$，其系数为：\n$$\n\\begin{align*}\nc_4 = 1 \\\\\nc_3 = p + \\omega_f + 2 \\\\\nc_2 = 2p + 2\\omega_f + p\\omega_f + k\\omega_f - 3 \\\\\nc_1 = 2p\\omega_f - 3p - 3\\omega_f + k\\omega_f(z+1) \\\\\nc_0 = k\\omega_f z - 3p\\omega_f\n\\end{align*}\n$$\n对于每组参数 $(k, z, p, \\omega_f)$，计算这些系数，并数值求解多项式的根。当且仅当 $D_{CL}(s)$ 的所有根 $\\lambda$ 的实部都严格为负，即 $\\mathrm{Re}(\\lambda)  0$ 时，系统是内部稳定的。\n\n步骤 2：频率响应生成\n所有频域指标都源自复频率响应 $L(j\\omega)$。在区间 $[10^{-3}, 10^3]$ $\\mathrm{rad/s}$ 上生成一个包含 $4096$ 个点的对数间隔频率网格 $\\omega$。在该网格的每个频率 $\\omega_i$ 处，计算复数值 $L(j\\omega_i)$。由此得到幅值 $|L(j\\omega_i)|$ 和相位 $\\angle L(j\\omega_i)$。相位经过数值解缠绕以确保在 $\\pm 180^\\circ$ 边界上的连续性，这对于正确识别相位穿越点至关重要。\n\n步骤 3：性能指标验证\n检查以下性能指标：\n- 灵敏度峰值：灵敏度函数逐点计算为 $S(j\\omega) = 1/(1 + L(j\\omega))$。峰值灵敏度是其幅值在频率网格上的最大值，$M_S = \\max_{\\omega} |S(j\\omega)|$。条件是 $M_S \\le 2.0$。\n- 高频噪声衰减：互补灵敏度函数是 $T(j\\omega) = L(j\\omega)/(1 + L(j\\omega))$。在指定的噪声衰减频率 $\\omega_{\\mathrm{na}} = 100$ $\\mathrm{rad/s}$ 处评估其幅值。条件是 $|T(j100)| \\le 0.5$。\n\n步骤 4：鲁棒性裕度验证\n计算并检查标准波特裕度：\n- 相位裕度 (PM)：单位增益穿越频率 $\\omega_{\\mathrm{gc}}$ 是 $|L(j\\omega_{\\mathrm{gc}})| = 1$ 的最低频率。通过在网格上搜索第一个使分贝幅值 $20\\log_{10}|L(j\\omega)|$ 穿越 $0$ 的区间 $[\\omega_i, \\omega_{i+1}]$ 来找到该频率。$\\omega_{\\mathrm{gc}}$ 的精确值通过对 $\\log_{10}(\\omega)$ 与分贝幅值进行线性插值得到。然后，通过对 $\\log_{10}(\\omega)$ 与解缠绕后的度数相位进行线性插值，找到该穿越频率处的相位 $\\angle L(j\\omega_{\\mathrm{gc}})$。相位裕度定义为 $PM = 180^\\circ + \\angle L(j\\omega_{\\mathrm{gc}})$。条件是 $PM \\ge 35^\\circ$。如果不存在单位增益穿越点，则 PM 未定义，条件不满足。\n- 增益裕度 (GM)：相位穿越频率 $\\omega_{\\mathrm{pc}}$ 是任何相位为 $\\angle L(j\\omega_{\\mathrm{pc}}) = -180^\\circ + m \\cdot 360^\\circ$（m为任意整数）的频率。在网格上找到所有这样的穿越点。对于每个穿越点，通过对 $\\log_{10}(\\omega)$ 与相位进行线性插值来确定精确的 $\\omega_{\\mathrm{pc}}$。然后通过在 $\\omega_{\\mathrm{pc}}$ 处对幅值（以分贝计）进行插值来找到幅值 $|L(j\\omega_{\\mathrm{pc}})|$。该穿越点的增益裕度（以分贝计）为 $GM_{dB} = -20\\log_{10}|L(j\\omega_{\\mathrm{pc}})|$。如果存在多个相位穿越点，系统增益裕度是所有计算出的裕度中的最小值，因为它代表了最严格的稳定性边界。条件是该最小 $GM \\ge 6$ $\\mathrm{dB}$。如果未找到相位穿越点，则增益裕度视为 $+\\infty$，这满足条件。\n\n步骤 5：最终评估\n对于三个测试用例中的每一个，都如上所述评估所有五个标准——稳定性、灵敏度峰值、噪声衰减、相位裕度和增益裕度。如果所有五个条件都通过，则给定案例的最终结果为 `True`，否则为 `False`。整个过程在提供的程序中实现。", "answer": "[False,False,False]", "id": "2690827"}]}