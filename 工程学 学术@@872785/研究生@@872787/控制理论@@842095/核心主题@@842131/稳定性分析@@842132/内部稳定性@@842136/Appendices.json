{"hands_on_practices": [{"introduction": "理论是指导，但实践是检验真理的唯一标准。本练习将带你从理论走向实践，要求你基于李雅普诺夫稳定性定理，设计一个数值程序来验证线性系统的内部稳定性。通过这个练习，你将掌握连接理论与计算的关键技能，这对于依赖软件工具分析复杂系统的现代控制工程师至关重要。[@problem_id:2713243]", "problem": "给定形式为 $\\dot{x}(t) = A x(t)$ 的连续时间线性时不变系统，其中 $A \\in \\mathbb{R}^{n \\times n}$。一个系统是内部渐近稳定的，当且仅当对于任意初始条件 $x(0) \\in \\mathbb{R}^{n}$，其轨迹 $x(t)$ 在 $t \\to \\infty$ 时收敛于 $0$。您的任务是严格基于第一性原理和公认事实，设计并实现一个使用二次 Lyapunov 函数方法来验证内部渐近稳定性的数值程序。\n\n从以下基本事实出发：\n- 对于系统 $\\dot{x} = A x$，一个形式为 $V(x) = x^{\\top} P x$ 的连续可微候选 Lyapunov 函数（其中 $P$ 为对称矩阵）可通过检验其沿轨迹的导数来证明稳定性。\n- 如果存在一个对称矩阵 $P \\in \\mathbb{R}^{n \\times n}$，该矩阵是正定的，并且满足与对称正定矩阵 $Q \\in \\mathbb{R}^{n \\times n}$ 相关联的连续时间 Lyapunov 等式，则系统 $\\dot{x} = A x$ 是内部渐近稳定的；反之，如果系统 $\\dot{x} = A x$ 是内部渐近稳定的，那么对于任意给定的对称正定矩阵 $Q$，都存在这样一个矩阵 $P$。\n\n设计一个数值程序，对于每个给定的矩阵 $A$ 和 $Q$ 的测试用例，该程序执行以下步骤：\n1. 计算满足与 $A$ 和 $Q$ 相关联的连续时间 Lyapunov 条件的对称矩阵 $P$。\n2. 通过验证 $P$ 的最小特征值严格大于一个正容差，来检查 $P$ 是否为正定矩阵。\n3. 构造对称矩阵 $S = A^{\\top} P + P A$，并通过验证 $S$ 的最大特征值严格小于一个负容差，来检查 $S$ 是否为负定矩阵。\n4. 检查 Lyapunov 等式的残差 $\\lVert S + Q \\rVert_{\\mathrm{F}}$，并要求其小于一个小的正容差，以验证数值解的有效性。\n\n实现要求：\n- 在步骤 2 和 3 中使用特征值计算来评估定性。您必须使用以下容差：正定性阈值 $\\tau_{+} = 10^{-8}$，负定性阈值 $\\tau_{-} = 10^{-8}$，以及残差阈值 $\\tau_{\\mathrm{res}} = 10^{-7}$。\n- 一个测试用例的判定规则必须是布尔值“true”，当且仅当所有三个检查都满足：$P$ 的最小特征值大于 $\\tau_{+}$，$S$ 的最大特征值小于 $- \\tau_{-}$，并且残差范数小于 $\\tau_{\\mathrm{res}}$；否则为“false”。\n- 测试套件中的所有矩阵 $Q$ 在构造上都是对称正定的。所有矩阵和计算都是无单位的；不涉及任何物理单位。\n\n测试套件：\n在以下六个案例上评估您的程序，每个案例由 $(A_i,Q_i)$ 指定。\n\n- 案例 1：$A_1 = \\begin{bmatrix} -1  0.5 \\\\ -2  -3 \\end{bmatrix}$, $Q_1 = I_2$。\n- 案例 2：$A_2 = \\begin{bmatrix} 0.2  1 \\\\ 0  -0.1 \\end{bmatrix}$, $Q_2 = I_2$。\n- 案例 3：$A_3 = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$, $Q_3 = I_2$。\n- 案例 4：$A_4 = \\begin{bmatrix} -10^{-3}  100 \\\\ 0  -10^{-3} \\end{bmatrix}$, $Q_4 = \\begin{bmatrix} 2  0.5 \\\\ 0.5  1 \\end{bmatrix}$。\n- 案例 5：$A_5 = \\begin{bmatrix} -2  1  0 \\\\ 0  -1  2 \\\\ 0  0  -0.5 \\end{bmatrix}$, $Q_5 = I_3$。\n- 案例 6：$A_6 = \\begin{bmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{bmatrix}$, $Q_6 = I_3$。\n\n您的程序应生成单行输出，其中包含按上述案例顺序排列的六个布尔结果，形式为方括号内以逗号分隔的列表（例如，“[True,False,True,True,False,True]”）。不应打印任何额外文本。\n\n注意：以上所有矩阵条目和所有容差都必须严格按照规定处理。不涉及角度，任何地方都不使用百分比；所有输出都只是布尔值。算法的实现必须具有数值鲁棒性，在适当的时候对计算出的矩阵进行对称化，以抵消浮点不对称性。", "solution": "问题陈述已被解析和验证。我们发现该问题具有科学依据、提法明确、客观且自成体系。它坚实地建立在线性时不变系统的 Lyapunov 稳定性理论的基本原理之上。任务是实现一个用于验证渐近稳定性的特定数值程序，并且所有必要的参数、数据和标准都已明确提供。因此，该问题是有效的，我们着手构建解决方案。\n\n由状态空间方程 $\\dot{x}(t) = A x(t)$（其中 $x \\in \\mathbb{R}^n$ 且 $A \\in \\mathbb{R}^{n \\times n}$）描述的连续时间线性时不变系统的稳定性，可以使用 Lyapunov 直接法来确定。核心定理指出，系统是渐近稳定的，当且仅当对于任何给定的对称正定矩阵 $Q$，存在一个唯一的对称正定矩阵 $P$，满足连续时间 Lyapunov 方程：\n$$\nA^{\\top} P + P A = -Q\n$$\n该定理为稳定性分析提供了一种构造性方法。我们的任务是基于此原理设计并实现一个数值程序。该程序通过求解 $P$ 并验证解的性质来评估给定的系统 $(A, Q)$。\n\n针对每个测试用例 $(A_i, Q_i)$ 的数值程序如下：\n\n1.  **求解 Lyapunov 方程**：第一步是求解 Lyapunov 方程 $A^{\\top} P + P A = -Q$ 以获得未知矩阵 $P$。这是一个关于 $P$ 中元素的线性方程组。标准的数值库为此任务提供了鲁棒的求解器。我们将利用这样的求解器。一个关键点是，唯一的正定解 $P$ 仅在矩阵 $A$ 是 Hurwitz 矩阵时存在，即其所有特征值的实部都严格为负。如果 $A$ 不是 Hurwitz 矩阵，数值求解器预计会失败，这正确地表明系统不是渐近稳定的。在我们的实现中，此类失败（例如，异常）将导致给定测试用例的结果为 `false`。\n\n2.  **验证 $P$ 的正定性**：如果找到了解 $P$，它必须是对称且正定的。由于浮点运算，计算出的 $P$ 可能存在微小的不对称性。我们通过计算 $P \\leftarrow \\frac{1}{2}(P + P^{\\top})$ 来强制对称。一个对称矩阵是正定的，当且仅当其所有特征值都严格为正。因此，我们计算对称化后 $P$ 的特征值，并验证最小特征值 $\\lambda_{\\min}(P)$ 满足条件 $\\lambda_{\\min}(P) > \\tau_{+}$，其中 $\\tau_{+} = 10^{-8}$ 是指定的正定性容差。\n\n3.  **验证 Lyapunov 项的负定性**：Lyapunov 函数 $V(x) = x^{\\top} P x$ 沿系统轨迹的时间导数为 $\\dot{V}(x) = x^{\\top} (A^{\\top} P + P A) x$。为保证渐近稳定性，$\\dot{V}(x)$ 必须是负定的。令 $S = A^{\\top} P + P A$。我们必须验证 $S$ 是一个负定矩阵。理论上，$S$ 应等于 $-Q$，而 $-Q$ 在构造上是负定的。在数值上，我们对计算出的 $S$ 进行此属性的检查。与 $P$ 一样，我们首先对称化 $S \\leftarrow \\frac{1}{2}(S + S^{\\top})$。一个对称矩阵是负定的，当且仅当其所有特征值都严格为负。我们通过验证最大特征值 $\\lambda_{\\max}(S)$ 满足 $\\lambda_{\\max}(S)  -\\tau_{-}$ 来确认这一点，其中 $\\tau_{-} = 10^{-8}$ 是指定的负定性容差。\n\n4.  **验证数值残差**：为确保计算出的 $P$ 是 Lyapunov 方程的精确解，我们检查残差。残差矩阵定义为 $R = S + Q = (A^{\\top} P + P A) + Q$。对于精确解，$R$ 应为零矩阵。我们通过计算残差的弗罗贝尼乌斯范数（Frobenius norm）$\\lVert R \\rVert_{\\mathrm{F}}$ 来量化误差，并验证其小于指定的容差：$\\lVert R \\rVert_{\\mathrm{F}}  \\tau_{\\mathrm{res}}$，其中 $\\tau_{\\mathrm{res}} = 10^{-7}$。\n\n一个测试用例被分类为渐近稳定（`true`），当且仅当所有这三个数值检查都通过。如果 Lyapunov 求解器失败或任何检查失败，结果为 `false`。这个严格的多阶段验证过程确保了根据指定标准对稳定性进行鲁棒的评估。现在将为提供的测试套件详细说明实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_lyapunov, LinAlgError\n\ndef solve():\n    \"\"\"\n    Solves the problem by applying a Lyapunov-based stability check to a suite of test cases.\n    \"\"\"\n    \n    # Tolerances as specified in the problem statement\n    tau_p = 1e-8  # Positive definiteness threshold\n    tau_n = 1e-8  # Negative definiteness threshold\n    tau_res = 1e-7  # Residual norm threshold\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (np.array([[-1.0, 0.5], \n                   [-2.0, -3.0]]), \n         np.identity(2)),\n        # Case 2\n        (np.array([[0.2, 1.0], \n                   [0.0, -0.1]]), \n         np.identity(2)),\n        # Case 3\n        (np.array([[0.0, 1.0], \n                   [-1.0, 0.0]]), \n         np.identity(2)),\n        # Case 4\n        (np.array([[-1e-3, 100.0], \n                   [0.0, -1e-3]]), \n         np.array([[2.0, 0.5], \n                   [0.5, 1.0]])),\n        # Case 5\n        (np.array([[-2.0, 1.0, 0.0], \n                   [0.0, -1.0, 2.0], \n                   [0.0, 0.0, -0.5]]), \n         np.identity(3)),\n        # Case 6\n        (np.array([[0.0, 1.0, 0.0], \n                   [0.0, 0.0, 1.0], \n                   [0.0, 0.0, 0.0]]), \n         np.identity(3)),\n    ]\n\n    def check_stability(A, Q):\n        \"\"\"\n        Performs the numerical stability check for a given system (A, Q).\n\n        Returns:\n            bool: True if stable, False otherwise.\n        \"\"\"\n        try:\n            # Step 1: Solve the continuous-time Lyapunov equation A.T*P + P*A = -Q.\n            # a = A.T, q = Q -> scipy solves (A.T)*P + P*(A.T).T = -Q  =>  A.T*P + P*A = -Q\n            P = solve_lyapunov(A.T, Q)\n            \n            # Symmetrize P to counteract numerical errors, as recommended.\n            P = (P + P.T) / 2.0\n\n            # Step 2: Check that P is positive definite.\n            # Use eigvalsh for symmetric matrices for better performance and stability.\n            eigenvalues_P = np.linalg.eigvalsh(P)\n            check_p = np.min(eigenvalues_P) > tau_p\n\n            # Step 3: Form S and check that it is negative definite.\n            S = A.T @ P + P @ A\n            # Symmetrize S for numerical robustness.\n            S = (S + S.T) / 2.0\n            \n            eigenvalues_S = np.linalg.eigvalsh(S)\n            check_s = np.max(eigenvalues_S)  -tau_n\n\n            # Step 4: Check the Lyapunov equality residual norm.\n            residual_norm = np.linalg.norm(S + Q, 'fro')\n            check_res = residual_norm  tau_res\n\n            # The final decision is True if and only if all three checks pass.\n            return check_p and check_s and check_res\n\n        except LinAlgError:\n            # solve_lyapunov raises an error if A is not stable (or marginally stable),\n            # so P cannot be found. This correctly implies the system is not\n            # asymptotically stable.\n            return False\n\n    results = []\n    for A, Q in test_cases:\n        is_stable = check_stability(A, Q)\n        results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    # Convert boolean to string \"True\" or \"False\" with capitalized first letter.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2713243"}, {"introduction": "一个系统的输出表现稳定，并不意味着其内部不存在“暗流涌动”的隐患。本练习将展示一个经典案例：一个系统满足有界输入有界输出（BIBO）稳定，但其内部却是不稳定的。通过分析其状态空间表示，你将揭示一个不可控的不稳定模式，从而深刻理解为何内部稳定性是确保系统可靠性的一个更强、更根本的要求。[@problem_id:2713315]", "problem": "考虑由以下状态空间方程描述的连续时间、单输入单输出线性时不变系统：\n$$\n\\dot{x}(t)=A\\,x(t)+B\\,u(t),\\quad y(t)=C\\,x(t)+D\\,u(t),\n$$\n其中\n$$\nA=\\begin{pmatrix}1  0\\\\0  -2\\end{pmatrix},\\quad\nB=\\begin{pmatrix}0\\\\1\\end{pmatrix},\\quad\nC=\\begin{pmatrix}0  1\\end{pmatrix},\\quad\nD=0.\n$$\n从线性系统与控制的核心定义（自治动态的内部渐近稳定性、线性时不变对的能控性，以及基于传递函数极点的有界输入有界输出稳定性）出发，完成以下任务：\n- 通过分析自治动态，判断该实现是否为内部渐近稳定，并从基本原理出发解释你的推理。\n- 判断该实现是否能控，并识别出任何不能控的不稳定模态。\n- 直接从状态空间表示推导与给定实现相关的传递函数，将其化为最简形式，并判断其是否为严格真以及有界输入有界输出稳定。\n\n你最终报告的答案必须是关于复拉普拉斯变量 $s$ 的单一解析表达式，形式为最简有理函数。不要包含单位。最终答案不要提供不等式或集合。无需四舍五入。", "solution": "所提出的问题是线性时不变（LTI）系统分析中的一个标准练习。它要求基于给定的状态空间实现，评估其内部稳定性、能控性和输入输出性质。该问题定义明确，具有科学依据，并为进行完整分析提供了所有必要信息。因此，这是一个有效的问题。\n\n给定连续时间LTI系统：\n$$\n\\dot{x}(t) = A x(t) + B u(t)\n$$\n$$\ny(t) = C x(t) + D u(t)\n$$\n其矩阵为：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0  1 \\end{pmatrix}, \\quad D = 0\n$$\n\n根据要求，分析将分三步进行：内部稳定性、能控性和传递函数分析。\n\n**1. 内部渐近稳定性**\n\n内部（或状态）稳定性关注的是自治系统的行为，该系统通过将外部输入 $u(t)$ 设置为零来描述：\n$$\n\\dot{x}(t) = A x(t)\n$$\n如果对于任何初始条件 $x(0)$，当时间 $t$ 趋于无穷大时，状态向量 $x(t)$ 收敛到零向量，即 $\\lim_{t \\to \\infty} x(t) = 0$，则称线性时不变系统是内部渐近稳定的。\n\n根据线性常微分方程理论，该自治系统的解的形式为 $x(t) = \\exp(At) x(0)$。$x(t)$ 是否收敛到 $0$ 完全由状态矩阵 $A$ 的特征值决定。系统是渐近稳定的当且仅当 $A$ 的所有特征值都具有严格为负的实部。\n\n给定的状态矩阵为：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix}\n$$\n由于 $A$ 是一个对角矩阵，其特征值就是其对角线上的元素。特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -2$。\n\n特征值的实部分别为 $\\text{Re}(\\lambda_1) = 1$ 和 $\\text{Re}(\\lambda_2) = -2$。特征值 $\\lambda_1 = 1$ 具有正实部。存在具有正实部的特征值意味着系统有一个模态随时间呈指数增长（$\\exp(1t)$）。因此，该系统不是渐近稳定的，它是不稳定的。\n\n**2. 能控性分析**\n\n$(A, B)$对的能控性决定了是否可以使用某个控制输入 $u(t)$ 在有限时间间隔内将系统状态从任意初始状态驱动到任意最终状态。对于一个状态维数为 $n$ 的LTI系统，其能控的充要条件是能控性矩阵 $\\mathcal{C}$ 满秩，即 $\\text{rank}(\\mathcal{C}) = n$。\n\n状态维数为 $n=2$。能控性矩阵构造如下：\n$$\n\\mathcal{C} = \\begin{pmatrix} B  AB \\end{pmatrix}\n$$\n我们有 $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。我们计算乘积 $AB$：\n$$\nAB = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (0)(1) \\\\ (0)(0) + (-2)(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix}\n$$\n现在，我们构成能控性矩阵 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  0 \\\\ 1  -2 \\end{pmatrix}\n$$\n为检查 $\\mathcal{C}$ 是否满秩，我们可以计算其行列式。\n$$\n\\det(\\mathcal{C}) = (0)(-2) - (0)(1) = 0\n$$\n由于行列式为零，矩阵 $\\mathcal{C}$ 是秩亏的（其秩为1，而不是2）。因此，该实现是**不能控**的。\n\n为识别不能控的模态，我们使用 Popov-Hautus-Belevitch (PBH) 判据。与 $A$ 的某个特征值 $\\lambda$ 相关的模态是不能控的，当且仅当 $\\text{rank}\\begin{pmatrix} A - \\lambda I  B \\end{pmatrix}  n$。\n\n对于特征值 $\\lambda_1 = 1$：\n$$\n\\begin{pmatrix} A - 1 \\cdot I  B \\end{pmatrix} = \\begin{pmatrix} 1-1  0  0 \\\\ 0  -2-1  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  -3  1 \\end{pmatrix}\n$$\n这个 $2 \\times 3$ 矩阵的秩为 $1$，小于 $n=2$。因此，与不稳定特征值 $\\lambda_1 = 1$ 相关的模态是不能控的。\n\n对于特征值 $\\lambda_2 = -2$：\n$$\n\\begin{pmatrix} A - (-2) \\cdot I  B \\end{pmatrix} = \\begin{pmatrix} 1-(-2)  0  0 \\\\ 0  -2-(-2)  1 \\end{pmatrix} = \\begin{pmatrix} 3  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n该矩阵的秩为 $2$，等于 $n$。因此，与稳定特征值 $\\lambda_2 = -2$ 相关的模态是能控的。\n\n分析结论是，系统的不稳定模态是不能控的。\n\n**3. 传递函数与有界输入有界输出（BIBO）稳定性**\n\nLTI系统的传递函数 $G(s)$ 在零初始条件的假设下，将输出的拉普拉斯变换 $Y(s)$ 与输入的拉普拉斯变换 $U(s)$ 联系起来。它由以下公式给出：\n$$\nG(s) = C (sI - A)^{-1} B + D\n$$\n首先，我们计算矩阵 $(sI - A)$：\n$$\nsI - A = s \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} = \\begin{pmatrix} s-1  0 \\\\ 0  s+2 \\end{pmatrix}\n$$\n接下来，我们求其逆矩阵 $(sI - A)^{-1}$：\n$$\n(sI - A)^{-1} = \\frac{1}{\\det(sI-A)} \\text{adj}(sI-A) = \\frac{1}{(s-1)(s+2)} \\begin{pmatrix} s+2  0 \\\\ 0  s-1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{s-1}  0 \\\\ 0  \\frac{1}{s+2} \\end{pmatrix}\n$$\n现在，我们可以计算传递函数 $G(s)$，注意 $D=0$：\n$$\nG(s) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{s-1}  0 \\\\ 0  \\frac{1}{s+2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n进行矩阵乘法：\n$$\nG(s) = \\begin{pmatrix} (0)\\frac{1}{s-1} + (1)(0)  (0)(0) + (1)\\frac{1}{s+2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\nG(s) = \\begin{pmatrix} 0  \\frac{1}{s+2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\nG(s) = (0)(0) + \\left(\\frac{1}{s+2}\\right)(1) = \\frac{1}{s+2}\n$$\n化为最简形式的传递函数为 $G(s) = \\frac{1}{s+2}$。\n\n如果分母多项式的阶数严格大于分子多项式的阶数，则有理传递函数是严格真的。此处，分母阶数为 $1$，分子阶数为 $0$。由于 $1 > 0$，该传递函数是严格真的。\n\n有界输入有界输出（BIBO）稳定性要求对于每一个有界输入 $u(t)$，输出 $y(t)$ 也是有界的。对于LTI系统，这等价于传递函数 $G(s)$ 的所有极点都位于复平面的开左半平面（即，具有严格为负的实部）。\n\n传递函数是 $G(s) = \\frac{1}{s+2}$。它在 $s = -2$ 处有一个单极点。由于该极点的实部为 $-2$（为负），因此该系统是BIBO稳定的。\n\n关键要注意的是，系统位于 $s=1$ 的不稳定极点没有出现在传递函数中。这是因为该模态是不能控的直接后果。输入 $u(t)$ 对与特征值 $\\lambda_1 = 1$ 相关的状态分量没有影响，因此这种不稳定的内部动态在输入输出关系中被“隐藏”了。这个系统是一个内部不稳定但外部（BIBO）稳定的经典例子。", "answer": "$$\n\\boxed{\\frac{1}{s+2}}\n$$", "id": "2713315"}, {"introduction": "在反馈控制设计中，仅仅关注最终的输入-输出传递函数可能会产生误导。本练习探讨了一个关键的设计陷阱：被控对象与控制器之间的不稳定极点-零点对消。你将证明这种对消如何能够“伪造”一个看似稳定的闭环系统，而该系统实际上是内部不稳定的，这在实际应用中可能导致灾难性的后果。[@problem_id:2739244]", "problem": "考虑一个标准的单位反馈互联结构，其中包含一个单输入单输出的连续时间线性时不变（LTI）被控对象和一个控制器。被控对象的传递函数为 $P(s)$，控制器的传递函数为 $K(s)$。参考输入为 $r(t)$，测量输出为 $y(t)$。误差信号为 $e(t) = r(t) - y(t)$，控制器输出为 $u(t)$，同时也是被控对象的输入。在本题中，我们选用以下特定的函数：\n$$\nP(s) = \\frac{s-1}{s+1} \\quad \\text{and} \\quad K(s) = \\frac{s+1}{s-1}.\n$$\n您可以采用将直接馈通和严格真动力学明确分开的状态空间实现，例如：\n$$\nP(s) = 1 - \\frac{2}{s+1}, \\qquad K(s) = 1 + \\frac{2}{s-1},\n$$\n以及相应的实现：\n$$\n\\begin{aligned}\n\\dot{x}_{p}(t) = -x_{p}(t) - 2u(t), \\quad y(t) = x_{p}(t) + u(t),\\\\\n\\dot{x}_{k}(t) = x_{k}(t) + 2e(t), \\quad u(t) = x_{k}(t) + e(t),\n\\end{aligned}\n$$\n其中 $e(t) = r(t) - y(t)$。\n\n任务：\n- 仅从有界输入有界输出（BIBO）稳定性和LTI系统内部（Lyapunov）稳定性的定义出发，推导闭环状态方程以及从 $r$ 到 $y$ 的输入输出关系。\n- 确定闭环内部模态（特征值），并判断该反馈互联是否内部稳定。\n- 确定从参考到输出的传递函数 $T_{ry}(s)$，并判断闭环输入输出映射是否BIBO稳定。\n- 解释此处为何闭环输入输出映射可以是BIBO稳定的，而内部动态却是不稳定的，并在您的解释中，明确地将其与 $P(s)$ 和 $K(s)$ 之间存在一个精确的不稳定极点-零点对消联系起来。\n\n答案格式要求：\n- 作为您的最终答案，仅报告简化后的闭环传递函数 $T_{ry}(s)$ 的单一闭合形式表达式。无需单位。最终答案中不要包含任何中间结果。", "solution": "所给问题是线性控制理论中的一个标准练习，旨在阐明内部稳定性与有界输入有界输出（BIBO）稳定性之间的关键区别。所提供的传递函数及其状态空间实现是自洽且数学上合理的。该问题提法恰当且有科学依据，因此是有效的，我们将提供解答。\n\n我们首先推导闭环状态空间模型。该系统由以下方程描述：\n被控对象动态：\n$$ \\dot{x}_{p}(t) = -x_{p}(t) - 2u(t) $$\n$$ y(t) = x_{p}(t) + u(t) $$\n控制器动态：\n$$ \\dot{x}_{k}(t) = x_{k}(t) + 2e(t) $$\n$$ u(t) = x_{k}(t) + e(t) $$\n反馈互联：\n$$ e(t) = r(t) - y(t) $$\n\n我们必须用状态变量 $x_{p}(t)$ 和 $x_{k}(t)$ 以及外部参考输入 $r(t)$ 来表示状态导数 $\\dot{x}_{p}(t)$ 和 $\\dot{x}_{k}(t)$ 以及输出 $y(t)$。我们通过代数代换来消去内部信号 $u(t)$ 和 $e(t)$。\n\n首先，用状态和 $r(t)$ 表示 $u(t)$。\n$$ u(t) = x_{k}(t) + e(t) = x_{k}(t) + (r(t) - y(t)) $$\n代入 $y(t) = x_{p}(t) + u(t)$:\n$$ u(t) = x_{k}(t) + r(t) - (x_{p}(t) + u(t)) $$\n$$ 2u(t) = -x_{p}(t) + x_{k}(t) + r(t) $$\n$$ u(t) = -\\frac{1}{2}x_{p}(t) + \\frac{1}{2}x_{k}(t) + \\frac{1}{2}r(t) $$\n\n接下来，求 $e(t)$ 的表达式：\n$$ e(t) = u(t) - x_{k}(t) = \\left(-\\frac{1}{2}x_{p}(t) + \\frac{1}{2}x_{k}(t) + \\frac{1}{2}r(t)\\right) - x_{k}(t) $$\n$$ e(t) = -\\frac{1}{2}x_{p}(t) - \\frac{1}{2}x_{k}(t) + \\frac{1}{2}r(t) $$\n\n现在我们将 $u(t)$ 和 $e(t)$ 的这些表达式代入状态导数方程中：\n对于 $\\dot{x}_{p}(t)$:\n$$ \\dot{x}_{p}(t) = -x_{p}(t) - 2u(t) = -x_{p}(t) - 2\\left(-\\frac{1}{2}x_{p}(t) + \\frac{1}{2}x_{k}(t) + \\frac{1}{2}r(t)\\right) $$\n$$ \\dot{x}_{p}(t) = -x_{p}(t) + x_{p}(t) - x_{k}(t) - r(t) = -x_{k}(t) - r(t) $$\n对于 $\\dot{x}_{k}(t)$:\n$$ \\dot{x}_{k}(t) = x_{k}(t) + 2e(t) = x_{k}(t) + 2\\left(-\\frac{1}{2}x_{p}(t) - \\frac{1}{2}x_{k}(t) + \\frac{1}{2}r(t)\\right) $$\n$$ \\dot{x}_{k}(t) = x_{k}(t) - x_{p}(t) - x_{k}(t) + r(t) = -x_{p}(t) + r(t) $$\n\n闭环状态方程的矩阵形式，其状态向量为 $x_{cl}(t) = \\begin{pmatrix} x_{p}(t) \\\\ x_{k}(t) \\end{pmatrix}$，是：\n$$ \\dot{x}_{cl}(t) = \\begin{pmatrix} \\dot{x}_{p}(t) \\\\ \\dot{x}_{k}(t) \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} x_{p}(t) \\\\ x_{k}(t) \\end{pmatrix} + \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} r(t) $$\n这定义了闭环状态矩阵 $A_{cl} = \\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix}$ 和输入矩阵 $B_{cl} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。\n\n最后，我们求出 $y(t)$ 的闭环输出方程：\n$$ y(t) = x_{p}(t) + u(t) = x_{p}(t) + \\left(-\\frac{1}{2}x_{p}(t) + \\frac{1}{2}x_{k}(t) + \\frac{1}{2}r(t)\\right) $$\n$$ y(t) = \\frac{1}{2}x_{p}(t) + \\frac{1}{2}x_{k}(t) + \\frac{1}{2}r(t) $$\n其矩阵形式为：\n$$ y(t) = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} x_{p}(t) \\\\ x_{k}(t) \\end{pmatrix} + \\frac{1}{2}r(t) $$\n这定义了闭环输出矩阵 $C_{cl} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}$ 和馈通矩阵 $D_{cl} = \\frac{1}{2}$。\n\n为了确定内部稳定性，我们分析闭环状态矩阵 $A_{cl}$ 的特征值。对于连续时间LTI系统，其内部（或Lyapunov）稳定性要求其状态矩阵的所有特征值都具有严格为负的实部。特征方程为 $\\det(\\lambda I - A_{cl}) = 0$。\n$$ \\det \\begin{pmatrix} \\lambda  1 \\\\ 1  \\lambda \\end{pmatrix} = \\lambda^2 - 1 = 0 $$\n代表闭环系统内部模态的特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -1$。由于存在一个特征值 $\\lambda_1 = 1$ 位于复平面右半部分（$\\Re(\\lambda_1) > 0$），因此闭环系统是内部不稳定的。\n\n为了确定BIBO稳定性，我们推导从参考输入 $r$ 到测量输出 $y$ 的传递函数 $T_{ry}(s)$。一个LTI系统是BIBO稳定的，当且仅当其传递函数的所有极点都位于复平面开左半部分。我们可以用两种方法计算 $T_{ry}(s)$。\n\n方法1：使用闭环状态空间模型 $T_{ry}(s) = C_{cl}(sI - A_{cl})^{-1}B_{cl} + D_{cl}$。\n$$ (sI - A_{cl})^{-1} = \\begin{pmatrix} s  1 \\\\ 1  s \\end{pmatrix}^{-1} = \\frac{1}{s^2-1} \\begin{pmatrix} s  -1 \\\\ -1  s \\end{pmatrix} $$\n$$ T_{ry}(s) = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix} \\frac{1}{s^2-1} \\begin{pmatrix} s  -1 \\\\ -1  s \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} + \\frac{1}{2} $$\n$$ T_{ry}(s) = \\frac{1}{2(s^2-1)} \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} s  -1 \\\\ -1  s \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} + \\frac{1}{2} $$\n$$ T_{ry}(s) = \\frac{1}{2(s^2-1)} \\begin{pmatrix} s-1  s-1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} + \\frac{1}{2} $$\n$$ T_{ry}(s) = \\frac{1}{2(s^2-1)} \\left( -(s-1) + (s-1) \\right) + \\frac{1}{2} = 0 + \\frac{1}{2} = \\frac{1}{2} $$\n\n方法2：使用框图代数 $T_{ry}(s) = \\frac{P(s)K(s)}{1+P(s)K(s)}$。\n环路增益为 $L(s) = P(s)K(s) = \\left(\\frac{s-1}{s+1}\\right)\\left(\\frac{s+1}{s-1}\\right) = 1$。\n$$ T_{ry}(s) = \\frac{L(s)}{1+L(s)} = \\frac{1}{1+1} = \\frac{1}{2} $$\n两种方法都得到 $T_{ry}(s) = \\frac{1}{2}$。该传递函数是一个常数，没有极点。因此，其所有极点均位于开左半平面的条件自然成立。所以，该输入输出映射是BIBO稳定的。\n\n内部不稳定性与BIBO稳定性之间的差异可由一个不稳定模态的极点-零点对消来解释。在频域中，控制器 $K(s)$ 在 $s=1$ 处的-不稳定极点被被控对象 $P(s)$ 在 $s=1$ 处的零点所抵消。这种对消使得不稳定的动态特性在输入输出传递函数 $T_{ry}(s)$ 中被隐藏了。\n\n为了更严谨地分析，我们考察闭环系统的能控性和能观性。\n能控性矩阵为 $\\mathcal{C} = \\begin{pmatrix} B_{cl}  A_{cl}B_{cl} \\end{pmatrix}$。\n$$ A_{cl}B_{cl} = \\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} $$\n$$ \\mathcal{C} = \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix} $$\n由于 $\\det(\\mathcal{C})=0$，该系统是不能控的。\n能观性矩阵为 $\\mathcal{O} = \\begin{pmatrix} C_{cl} \\\\ C_{cl}A_{cl} \\end{pmatrix}$。\n$$ C_{cl}A_{cl} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}\\begin{pmatrix} 0  -1 \\\\ -1  0 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2}  -\\frac{1}{2} \\end{pmatrix} $$\n$$ \\mathcal{O} = \\begin{pmatrix} 1/2  1/2 \\\\ -1/2  -1/2 \\end{pmatrix} $$\n由于 $\\det(\\mathcal{O})=0$，该系统是不能观的。\n\n我们来识别具体的模态。$A_{cl}$ 的右特征向量对于 $\\lambda_1 = 1$ 是 $v_1 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，对于 $\\lambda_2 = -1$ 是 $v_2 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n我们检查模态的可观测性。如果一个模态对应的特征向量位于能观性矩阵 $\\mathcal{O}$ 的零空间中，则该模态是不可观测的。\n对于不稳定模态 $\\lambda_1 = 1$：\n$$ \\mathcal{O}v_1 = \\begin{pmatrix} 1/2  1/2 \\\\ -1/2  -1/2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n特征向量 $v_1$ 位于 $\\mathcal{O}$ 的零空间中。因此，位于 $s=1$ 的不稳定模态对于输出 $y(t)$ 是不可观测的。由于其不可观测，它不会作为极点出现在传递函数 $T_{ry}(s)$ 中。这正是产生差异的精确原因。尽管有界的参考输入 $r(t)$ 会产生有界的输出 $y(t)$，但内部状态 $x_p(t)$ 和 $x_k(t)$ 将会无界增长，与 $\\exp(t)$ 成正比，因为不稳定的模態仍然存在于系统的内部动态中。这一现象是一个经典例子，说明了为何在控制系统设计中，内部稳定性是比BIBO稳定性更强、更基本的要求。", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "2739244"}]}