{"hands_on_practices": [{"introduction": "理解MIMO系统的第一步通常是掌握其数学表示。第一个练习旨在连接描述系统内部动态的状态空间模型与描述其输入输出行为的传递矩阵。通过从一个分块的状态空间表示出发，推导传递矩阵的分块结构 [@problem_id:2713773]，你将具体地理解每个子系统传递函数是如何将特定的输入组映射到输出组的，这是分析互联系统的基础技能。", "problem": "考虑一个连续时间线性时不变 (LTI) 多输入多输出 (MIMO) 系统，其状态、输入和输出由以下方程描述：\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t) + D u(t),$$\n其中 $x(t) \\in \\mathbb{R}^{n}$，$u(t) \\in \\mathbb{R}^{m}$，$y(t) \\in \\mathbb{R}^{p}$。输入和输出各自分为两个子系统，因此\n$$u(t) = \\begin{pmatrix} u_{1}(t) \\\\ u_{2}(t) \\end{pmatrix}, \\quad y(t) = \\begin{pmatrix} y_{1}(t) \\\\ y_{2}(t) \\end{pmatrix},$$\n其中 $u_{1}(t) \\in \\mathbb{R}^{m_{1}}$，$u_{2}(t) \\in \\mathbb{R}^{m_{2}}$，$y_{1}(t) \\in \\mathbb{R}^{p_{1}}$，$y_{2}(t) \\in \\mathbb{R}^{p_{2}}$，且 $m_{1} + m_{2} = m$，$p_{1} + p_{2} = p$。矩阵 $B$、$C$ 和 $D$ 也相应地分块为\n$$B = \\begin{pmatrix} B_{1}  B_{2} \\end{pmatrix}, \\quad C = \\begin{pmatrix} C_{1} \\\\ C_{2} \\end{pmatrix}, \\quad D = \\begin{pmatrix} D_{11}  D_{12} \\\\ D_{21}  D_{22} \\end{pmatrix},$$\n其中对于 $i \\in \\{1,2\\}$ 和 $j \\in \\{1,2\\}$，$B_{j} \\in \\mathbb{R}^{n \\times m_{j}}$，$C_{i} \\in \\mathbb{R}^{p_{i} \\times n}$，$D_{ij} \\in \\mathbb{R}^{p_{i} \\times m_{j}}$。\n\n从基本原理出发，利用零初始条件下状态方程的拉普拉斯变换，以及传递矩阵作为拉普拉斯变换 $U(s)$ 和 $Y(s)$ 之间映射的定义，推导输入-输出传递矩阵 $G(s)$，并说明输入和输出的分组如何导出一个 $2 \\times 2$ 的分块结构。将 $G(s)$ 明确地表示为由 $A$、$B_{1}$、$B_{2}$、$C_{1}$、$C_{2}$、$D_{ij}$ 和复拉普拉斯变量 $s$ 构成的单个 $2 \\times 2$ 分块矩阵。你的推导应清楚地说明哪个子块将哪个输入组映射到哪个输出组，并解释原因。\n\n请将最终结果以单个闭式解析表达式的形式给出 $2 \\times 2$ 分块传递矩阵 $G(s)$。不需要进行数值计算，也无需四舍五入。不要包含单位。", "solution": "在尝试求解之前，首先检查问题陈述的有效性。\n\n首先，我们提取问题的已知条件。\n该系统是一个连续时间线性时不变 (LTI) 多输入多输出 (MIMO) 系统，由以下状态空间方程描述：\n$$\n\\dot{x}(t) = A x(t) + B u(t)\n$$\n$$\ny(t) = C x(t) + D u(t)\n$$\n状态、输入和输出向量的维度分别为 $x(t) \\in \\mathbb{R}^{n}$，$u(t) \\in \\mathbb{R}^{m}$ 和 $y(t) \\in \\mathbb{R}^{p}$。\n初始条件指定为零：$x(0) = 0$。\n输入和输出向量分块如下：\n$$\nu(t) = \\begin{pmatrix} u_{1}(t) \\\\ u_{2}(t) \\end{pmatrix}, \\quad y(t) = \\begin{pmatrix} y_{1}(t) \\\\ y_{2}(t) \\end{pmatrix}\n$$\n这些分块的维度为 $u_{1}(t) \\in \\mathbb{R}^{m_{1}}$，$u_{2}(t) \\in \\mathbb{R}^{m_{2}}$，$y_{1}(t) \\in \\mathbb{R}^{p_{1}}$，$y_{2}(t) \\in \\mathbb{R}^{p_{2}}$，且 $m_{1} + m_{2} = m$，$p_{1} + p_{2} = p$。\n系统矩阵 $B$、$C$ 和 $D$ 相应地分块为：\n$$\nB = \\begin{pmatrix} B_{1}  B_{2} \\end{pmatrix}, \\quad C = \\begin{pmatrix} C_{1} \\\\ C_{2} \\end{pmatrix}, \\quad D = \\begin{pmatrix} D_{11}  D_{12} \\\\ D_{21}  D_{22} \\end{pmatrix}\n$$\n矩阵分块的维度为 $B_{j} \\in \\mathbb{R}^{n \\times m_{j}}$，$C_{i} \\in \\mathbb{R}^{p_{i} \\times n}$，$D_{ij} \\in \\mathbb{R}^{p_{i} \\times m_{j}}$，其中 $i \\in \\{1,2\\}$，$j \\in \\{1,2\\}$。\n任务是从基本原理出发，推导输入-输出传递矩阵 $G(s)$，并将其表示为由给定的分块矩阵和拉普拉斯变量 $s$ 构成的 $2 \\times 2$ 分块矩阵。\n\n接下来，我们验证问题陈述的有效性。\n该问题具有科学依据，根植于线性系统和控制理论的基本原理。状态空间表示法和通过拉普拉斯变换推导传递函数是标准的、成熟的程序。该问题是适定的，提供了推导传递矩阵唯一数学表达式所需的所有必要信息（方程、分块、零初始条件）。语言客观且数学上精确。问题设置是完整的且内部一致的，所有矩阵和向量的维度对于指定的操作都是相容的。该问题是 MIMO 系统分析中一个可形式化且相关的练习。它没有违反任何无效性标准。\n\n问题被认定为有效。我们继续进行求解。\n\n推导过程始于对状态空间方程应用拉普拉斯变换。设 $X(s)$、$U(s)$ 和 $Y(s)$ 分别是 $x(t)$、$u(t)$ 和 $y(t)$ 的拉普拉斯变换。对状态方程进行变换，得到：\n$$\n\\mathcal{L}\\{\\dot{x}(t)\\} = \\mathcal{L}\\{A x(t) + B u(t)\\}\n$$\n利用拉普拉斯变换的微分性质，$\\mathcal{L}\\{\\dot{x}(t)\\} = sX(s) - x(0)$。给定零初始状态的条件，$x(0)=0$，这可以简化为 $sX(s)$。方程变为：\n$$\nsX(s) = AX(s) + BU(s)\n$$\n这是一个在拉普拉斯域中的代数方程。我们必须求解状态向量的变换 $X(s)$，用输入变换 $U(s)$ 来表示。\n$$\nsX(s) - AX(s) = BU(s)\n$$\n提出 $X(s)$ 的公因子需要使用维度为 $n \\times n$ 的单位矩阵 $I$：\n$$\n(sI - A)X(s) = BU(s)\n$$\n假设 $s$ 不是 $A$ 的特征值，则矩阵 $(sI - A)$ 是可逆的。我们可以用其逆矩阵 $(sI - A)^{-1}$（即矩阵 $A$ 的预解矩阵）进行左乘。\n$$\nX(s) = (sI - A)^{-1} B U(s)\n$$\n现在，我们对输出方程应用拉普拉斯变换：\n$$\n\\mathcal{L}\\{y(t)\\} = \\mathcal{L}\\{C x(t) + D u(t)\\}\n$$\n$$\nY(s) = CX(s) + DU(s)\n$$\n将 $X(s)$ 的表达式代入变换后的输出方程：\n$$\nY(s) = C(sI - A)^{-1} B U(s) + D U(s)\n$$\n通过在右侧提出 $U(s)$ 的公因子，我们得到输入变换和输出变换之间的关系：\n$$\nY(s) = \\left[ C(sI - A)^{-1} B + D \\right] U(s)\n$$\n根据定义，传递矩阵 $G(s)$ 是将输入变换 $U(s)$ 与输出变换 $Y(s)$ 联系起来的矩阵，即 $Y(s) = G(s)U(s)$。因此，我们确定传递矩阵为：\n$$\nG(s) = C(sI - A)^{-1} B + D\n$$\n为了揭示由输入和输出分块引起的 $2 \\times 2$ 分块结构，我们将矩阵 $B$、$C$ 和 $D$ 的分块形式代入此表达式。\n$$\nG(s) = \\begin{pmatrix} C_{1} \\\\ C_{2} \\end{pmatrix} (sI - A)^{-1} \\begin{pmatrix} B_{1}  B_{2} \\end{pmatrix} + \\begin{pmatrix} D_{11}  D_{12} \\\\ D_{21}  D_{22} \\end{pmatrix}\n$$\n分块矩阵的乘积根据分块矩阵乘法规则进行计算：\n$$\n\\begin{pmatrix} C_{1} \\\\ C_{2} \\end{pmatrix} (sI - A)^{-1} \\begin{pmatrix} B_{1}  B_{2} \\end{pmatrix} = \\begin{pmatrix} C_{1}(sI - A)^{-1}B_{1}  C_{1}(sI - A)^{-1}B_{2} \\\\ C_{2}(sI - A)^{-1}B_{1}  C_{2}(sI - A)^{-1}B_{2} \\end{pmatrix}\n$$\n现在，我们加上分块的前馈矩阵 $D$：\n$$\nG(s) = \\begin{pmatrix} C_{1}(sI - A)^{-1}B_{1}  C_{1}(sI - A)^{-1}B_{2} \\\\ C_{2}(sI - A)^{-1}B_{1}  C_{2}(sI - A)^{-1}B_{2} \\end{pmatrix} + \\begin{pmatrix} D_{11}  D_{12} \\\\ D_{21}  D_{22} \\end{pmatrix}\n$$\n两个相容分块的矩阵之和是其对应子块的逐块相加。这得到了传递矩阵 $G(s)$ 的最终 $2 \\times 2$ 分块结构：\n$$\nG(s) = \\begin{pmatrix} C_{1}(sI - A)^{-1}B_{1} + D_{11}  C_{1}(sI - A)^{-1}B_{2} + D_{12} \\\\ C_{2}(sI - A)^{-1}B_{1} + D_{21}  C_{2}(sI - A)^{-1}B_{2} + D_{22} \\end{pmatrix}\n$$\n此表达式显示了系统传递矩阵的显式 $2 \\times 2$ 分块形式。如果我们将 $G(s)$ 表示为 $G(s) = \\begin{pmatrix} G_{11}(s)  G_{12}(s) \\\\ G_{21}(s)  G_{22}(s) \\end{pmatrix}$，那么输入-输出关系 $Y(s) = G(s)U(s)$ 可以写成：\n$$\n\\begin{pmatrix} Y_{1}(s) \\\\ Y_{2}(s) \\end{pmatrix} = \\begin{pmatrix} G_{11}(s)  G_{12}(s) \\\\ G_{21}(s)  G_{22}(s) \\end{pmatrix} \\begin{pmatrix} U_{1}(s) \\\\ U_{2}(s) \\end{pmatrix}\n$$\n由此可见，每个子块 $G_{ij}(s)$ 将输入组 $j$ 映射到输出组 $i$。具体来说：\n$G_{11}(s) = C_{1}(sI - A)^{-1}B_{1} + D_{11}$ 将 $U_{1}(s)$ 映射到 $Y_{1}(s)$。\n$G_{12}(s) = C_{1}(sI - A)^{-1}B_{2} + D_{12}$ 将 $U_{2}(s)$ 映射到 $Y_{1}(s)$。\n$G_{21}(s) = C_{2}(sI - A)^{-1}B_{1} + D_{21}$ 将 $U_{1}(s)$ 映射到 $Y_{2}(s)$。\n$G_{22}(s) = C_{2}(sI - A)^{-1}B_{2} + D_{22}$ 将 $U_{2}(s)$ 映射到 $Y_{2}(s)$。\n这完成了所要求的推导。最终的表达式是 $2 \\times 2$ 分块传递矩阵的单个闭式解析表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nC_{1}(sI - A)^{-1}B_{1} + D_{11}  C_{1}(sI - A)^{-1}B_{2} + D_{12} \\\\\nC_{2}(sI - A)^{-1}B_{1} + D_{21}  C_{2}(sI - A)^{-1}B_{2} + D_{22}\n\\end{pmatrix}\n}\n$$", "id": "2713773"}, {"introduction": "从系统表示转向闭环分析，本练习聚焦于反馈控制的核心：回路传递矩阵和返回差阵。对于一个给定的二输入二输出系统，你将进行必要的矩阵计算，以求得回路传递矩阵 $L(s)$ 和返回差阵 $I+L(s)$ [@problem_id:2713799]。这项练习至关重要，因为这两个矩阵是评估任何多变量反馈系统稳定性和性能的核心。", "problem": "考虑一个双输入双输出线性时不变系统，其传递矩阵为\n$$\nG(s)=\\begin{pmatrix}\n\\dfrac{1}{s+1}  \\dfrac{1}{s+2} \\\\[6pt]\n0  \\dfrac{2}{s+3}\n\\end{pmatrix},\n$$\n以及一个静态多变量控制器\n$$\nK=\\begin{pmatrix}\nk_{1}  0\\\\\nk_{2}  k_{3}\n\\end{pmatrix},\n$$\n其中 $k_{1}$、$k_{2}$ 和 $k_{3}$ 是实常数。该系统与控制器以标准负反馈形式互连，其中控制器作用于跟踪误差 $e=r-y$ 以产生控制输入 $u=K e$，系统输出为 $y=G u$，测量值从参考信号中减去。\n\n从负反馈的基本框图关系和多变量反馈中回路传递的定义出发，完成以下任务：\n\n- 推导回路传递矩阵 $L(s)$ 和回差矩阵 $I+L(s)$。\n- 计算两者在 $s=0$ 时的值。\n- 然后，仅使用矩阵代数，计算 $s=0$ 时回差矩阵的行列式，并将其简化为关于 $k_{1}$、$k_{2}$ 和 $k_{3}$ 的闭式解析表达式。\n\n此外，请（定性地，不借助任何未引入的简化公式）解释为什么回路传递和回差矩阵在量化多变量增益和相位裕度方面起着核心作用，特别是通过它们与灵敏度和余灵敏度函数的联系来解释。\n\n你最终报告的答案必须是 $\\det(I+L(0))$ 关于 $k_{1}$、$k_{2}$ 和 $k_{3}$ 的简化闭式表达式。不需要进行数值代入，也无需四舍五入。最终答案中不要包含单位。", "solution": "所述问题定义明确，具有科学依据，并包含完整求解所需的所有信息。这是多变量控制理论中的一个标准练习。我们将开始推导。\n\n负反馈系统的基本关系式如下：\n$$\n\\mathbf{y}(s) = \\mathbf{G}(s) \\mathbf{u}(s)\n$$\n$$\n\\mathbf{u}(s) = \\mathbf{K} \\mathbf{e}(s)\n$$\n$$\n\\mathbf{e}(s) = \\mathbf{r}(s) - \\mathbf{y}(s)\n$$\n其中 $\\mathbf{y}(s)$ 是系统输出，$\\mathbf{u}(s)$ 是控制输入，$\\mathbf{e}(s)$ 是跟踪误差，$\\mathbf{r}(s)$ 是参考信号。\n\n首先，我们推导回路传递矩阵 $\\mathbf{L}(s)$。回路传递矩阵是从误差信号 $\\mathbf{e}(s)$ 到系统输出 $\\mathbf{y}(s)$ 的传递函数矩阵，该输出随后被反馈回求和点。结合前两个方程，我们得到：\n$$\n\\mathbf{y}(s) = \\mathbf{G}(s) (\\mathbf{K} \\mathbf{e}(s)) = (\\mathbf{G}(s)\\mathbf{K}) \\mathbf{e}(s)\n$$\n因此，回路传递矩阵定义为 $\\mathbf{L}(s) = \\mathbf{G}(s)\\mathbf{K}$。\n\n给定系统传递矩阵 $\\mathbf{G}(s)$ 和控制器矩阵 $\\mathbf{K}$：\n$$\n\\mathbf{G}(s)=\\begin{pmatrix}\n\\frac{1}{s+1}  \\frac{1}{s+2} \\\\\n0  \\frac{2}{s+3}\n\\end{pmatrix}, \\quad \\mathbf{K}=\\begin{pmatrix}\nk_{1}  0\\\\\nk_{2}  k_{3}\n\\end{pmatrix}\n$$\n我们计算乘积 $\\mathbf{L}(s) = \\mathbf{G}(s)\\mathbf{K}$：\n$$\n\\mathbf{L}(s) = \\begin{pmatrix}\n\\frac{1}{s+1}  \\frac{1}{s+2} \\\\\n0  \\frac{2}{s+3}\n\\end{pmatrix} \\begin{pmatrix}\nk_{1}  0\\\\\nk_{2}  k_{3}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{s+1} \\cdot k_{1} + \\frac{1}{s+2} \\cdot k_{2}  \\frac{1}{s+1} \\cdot 0 + \\frac{1}{s+2} \\cdot k_{3} \\\\\n0 \\cdot k_{1} + \\frac{2}{s+3} \\cdot k_{2}  0 \\cdot 0 + \\frac{2}{s+3} \\cdot k_{3}\n\\end{pmatrix}\n$$\n$$\n\\mathbf{L}(s) = \\begin{pmatrix}\n\\frac{k_{1}}{s+1} + \\frac{k_{2}}{s+2}  \\frac{k_{3}}{s+2} \\\\\n\\frac{2k_{2}}{s+3}  \\frac{2k_{3}}{s+3}\n\\end{pmatrix}\n$$\n回差矩阵定义为 $\\mathbf{I}+\\mathbf{L}(s)$，其中 $\\mathbf{I}$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\mathbf{I}+\\mathbf{L}(s) = \\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix} + \\begin{pmatrix}\n\\frac{k_{1}}{s+1} + \\frac{k_{2}}{s+2}  \\frac{k_{3}}{s+2} \\\\\n\\frac{2k_{2}}{s+3}  \\frac{2k_{3}}{s+3}\n\\end{pmatrix} = \\begin{pmatrix}\n1 + \\frac{k_{1}}{s+1} + \\frac{k_{2}}{s+2}  \\frac{k_{3}}{s+2} \\\\\n\\frac{2k_{2}}{s+3}  1 + \\frac{2k_{3}}{s+3}\n\\end{pmatrix}\n$$\n下一步是计算这些矩阵在 $s=0$ 时的值。首先，我们计算 $\\mathbf{L}(0)$：\n$$\n\\mathbf{L}(0) = \\begin{pmatrix}\n\\frac{k_{1}}{0+1} + \\frac{k_{2}}{0+2}  \\frac{k_{3}}{0+2} \\\\\n\\frac{2k_{2}}{0+3}  \\frac{2k_{3}}{0+3}\n\\end{pmatrix} = \\begin{pmatrix}\nk_{1} + \\frac{k_{2}}{2}  \\frac{k_{3}}{2} \\\\\n\\frac{2k_{2}}{3}  \\frac{2k_{3}}{3}\n\\end{pmatrix}\n$$\n以及在 $s=0$ 时的回差矩阵：\n$$\n\\mathbf{I}+\\mathbf{L}(0) = \\begin{pmatrix}\n1 + k_{1} + \\frac{k_{2}}{2}  \\frac{k_{3}}{2} \\\\\n\\frac{2k_{2}}{3}  1 + \\frac{2k_{3}}{3}\n\\end{pmatrix}\n$$\n现在，我们按要求计算 $s=0$ 时回差矩阵的行列式。\n$$\n\\det(\\mathbf{I}+\\mathbf{L}(0)) = \\left(1 + k_{1} + \\frac{k_{2}}{2}\\right) \\left(1 + \\frac{2k_{3}}{3}\\right) - \\left(\\frac{k_{3}}{2}\\right) \\left(\\frac{2k_{2}}{3}\\right)\n$$\n我们展开乘积：\n$$\n\\det(\\mathbf{I}+\\mathbf{L}(0)) = 1\\left(1 + \\frac{2k_{3}}{3}\\right) + k_{1}\\left(1 + \\frac{2k_{3}}{3}\\right) + \\frac{k_{2}}{2}\\left(1 + \\frac{2k_{3}}{3}\\right) - \\frac{2k_{2}k_{3}}{6}\n$$\n$$\n\\det(\\mathbf{I}+\\mathbf{L}(0)) = 1 + \\frac{2k_{3}}{3} + k_{1} + \\frac{2k_{1}k_{3}}{3} + \\frac{k_{2}}{2} + \\frac{2k_{2}k_{3}}{6} - \\frac{k_{2}k_{3}}{3}\n$$\n注意到 $\\frac{2k_{2}k_{3}}{6} = \\frac{k_{2}k_{3}}{3}$，最后两项相互抵消。这留下了简化后的表达式：\n$$\n\\det(\\mathbf{I}+\\mathbf{L}(0)) = 1 + k_{1} + \\frac{k_{2}}{2} + \\frac{2k_{3}}{3} + \\frac{2k_{1}k_{3}}{3}\n$$\n这就是所要求的闭式解析表达式。\n\n此外，还需要一个定性解释。闭环系统的稳定性由其极点的位置决定，这些极点是特征方程 $\\det(\\mathbf{I}+\\mathbf{L}(s)) = 0$ 的根。对于单输入单输出（SISO）情况，这简化为 $1+L(s)=0$。奈奎斯特稳定性判据检查频率响应 $L(j\\omega)$ 对临界点 $-1$ 的包围情况。距离 $|1+L(j\\omega)|$ 是鲁棒性的一个度量；一个较小的值表示接近不稳定。\n\n在多输入多输出（MIMO）情况下，回差矩阵 $\\mathbf{I}+\\mathbf{L}(s)$ 扮演着类似的角色。广义奈奎斯特判据指出，对于一个稳定的开环系统，如果当 $\\omega \\in [-\\infty, \\infty]$ 时，$\\det(\\mathbf{I}+\\mathbf{L}(j\\omega))$ 的轨迹不包围原点，则闭环稳定性得到保证。$\\det(\\mathbf{I}+\\mathbf{L}(j\\omega))$ 的值是标量距离 $1+L(j\\omega)$ 与临界点距离的多变量等价物。一个接近零的值表明系统正在接近不稳定状态。因此，像 $\\mathbf{I}+\\mathbf{L}(j\\omega)$ 的最小奇异值 $\\sigma_{\\min}(\\mathbf{I}+\\mathbf{L}(j\\omega))$ 这样的量，通过量化矩阵 $\\mathbf{I}+\\mathbf{L}(j\\omega)$ 离奇异的接近程度，为多变量增益和相位裕度提供了鲁棒的度量。\n\n此外，回差矩阵通过灵敏度函数 $\\mathbf{S}(s) = (\\mathbf{I}+\\mathbf{L}(s))^{-1}$ 和余灵敏度函数 $\\mathbf{T}(s) = \\mathbf{L}(s)(\\mathbf{I}+\\mathbf{L}(s))^{-1}$ 与系统性能有着根本的联系。灵敏度函数 $\\mathbf{S}(s)$ 将参考指令和输出扰动映射到跟踪误差。为了获得良好的性能（跟踪和扰动抑制），$\\mathbf{S}(s)$ 在低频时必须很小，这要求 $\\mathbf{L}(s)$ “大”。余灵敏度函数 $\\mathbf{T}(s)$ 将传感器噪声映射到系统输出。为了抵抗噪声和模型不确定性，$\\mathbf{T}(s)$ 在高频时必须很小，这要求 $\\mathbf{L}(s)$ “小”。因此，$\\mathbf{I}+\\mathbf{L}(s)$ 在所有频率上的行为决定了性能与鲁棒性之间的基本权衡，其行列式决定了闭环系统的绝对稳定性。", "answer": "$$\n\\boxed{1 + k_{1} + \\frac{k_{2}}{2} + \\frac{2k_{3}}{3} + \\frac{2k_{1}k_{3}}{3}}\n$$", "id": "2713799"}, {"introduction": "最后的这个练习将理论与现代计算实践相结合，旨在解决由通道间相互作用引起的性能下降这一关键问题。你将使用奇异值分析——这是鲁棒MIMO控制的基石——通过灵敏度 ($S$) 和互补灵敏度 ($T$) 函数来量化反馈系统的性能 [@problem_id:2713822]。这个练习将让你亲手体验如何用数值方法评估非对角线耦合项如何损害系统的稳定性和性能，而这种现象在简单的单回路分析中是无法察觉的。", "problem": "考虑一个双输入双输出被控对象与一个对角控制器构成的标准负反馈互联系统。设被控对象在拉普拉斯域中由传递矩阵 $G(s) \\in \\mathbb{C}^{2 \\times 2}$ 给出，其元素为\n- $g_{11}(s) = \\dfrac{2}{(s+1)(0.5\\,s+1)}$,\n- $g_{22}(s) = \\dfrac{3}{(s+2)(0.2\\,s+1)}$,\n- $g_{12}(s) = c \\cdot \\dfrac{0.5}{s+1}$,\n- $g_{21}(s) = -\\,c \\cdot \\dfrac{0.4}{s+0.2}$,\n其中 $c \\in \\mathbb{R}$ 是一个控制非对角线相互作用水平的标量。控制器是对角阵，\n$K(s) = \\mathrm{diag}(k_1, k_2)$,\n其中 $k_1 = 1.5$ 且 $k_2 = 1.2$。假设单位负反馈，并且所有互联都是适定的。\n\n仅使用负反馈和频率响应评估的基本闭环定义，完成以下任务：\n- 从框图方程和代数消元出发，推导灵敏度矩阵 $S(j\\omega)$ 和互补灵敏度矩阵 $T(j\\omega)$ 关于 $G(j\\omega)$ 和 $K(j\\omega)$ 的表达式。除已声明的特殊结构外，不要假定任何其他结构，也不要从预先记忆的闭环公式开始。\n- 对于每个频率 $\\omega$，将 $S(j\\omega)$ 和 $T(j\\omega)$ 解释为复数矩阵，并量化它们的最大奇异值，该值定义为诱导2-范数，即 $M(j\\omega)^{*} M(j\\omega)$（对于 $M \\in \\{S, T\\}$）最大特征值的平方根，其中 $(\\cdot)^{*}$ 表示共轭转置。\n\n定义角频率的分析网格为在每秒弧度单位下，从 $\\omega \\in [10^{-2}, 10^{3}]$ 区间内对数间隔的 $N = 2000$ 个点。对于下面指定的每个 $c$ 值，计算：\n- $S(j\\omega)$ 最大奇异值的峰值（在 $\\omega$ 上的最大值），记为 $\\max_{\\omega}\\,\\bar{\\sigma}(S(j\\omega))$。\n- $T(j\\omega)$ 最大奇异值的峰值（在 $\\omega$ 上的最大值），记为 $\\max_{\\omega}\\,\\bar{\\sigma}(T(j\\omega))$。\n\n为分析相互作用引起的峰值，使用仅对角线参考对象 $G_{\\mathrm{diag}}(s)$，该对象通过设置 $c = 0$ 同时保持相同的对角线元素和相同的控制器获得。对于每个 $c$，定义比率\n- $R_S(c) = \\dfrac{\\max_{\\omega}\\,\\bar{\\sigma}(S_{\\mathrm{MIMO}}(j\\omega;c))}{\\max_{\\omega}\\,\\bar{\\sigma}(S_{\\mathrm{diag}}(j\\omega))}$,\n- $R_T(c) = \\dfrac{\\max_{\\omega}\\,\\bar{\\sigma}(T_{\\mathrm{MIMO}}(j\\omega;c))}{\\max_{\\omega}\\,\\bar{\\sigma}(T_{\\mathrm{diag}}(j\\omega))}$,\n并报告布尔标志\n- 如果 $R_S(c)  \\tau$，则 $\\text{peakS}(c) = \\text{True}$，否则为 $\\text{False}$，\n- 如果 $R_T(c)  \\tau$，则 $\\text{peakT}(c) = \\text{True}$，否则为 $\\text{False}$，\n阈值为 $\\tau = 1.05$。\n\n测试组：\n- 使用三个值 $c \\in \\{0.0, 0.3, 0.8\\}$。\n\n数值和输出要求：\n- 通过将 $s = j\\omega$ 代入每个标量元素来评估 $G(j\\omega)$。\n- 将每个测试案例的两个峰值表示为四舍五入到六位小数的实数。\n- 布尔标志必须根据上述比率与 $\\tau = 1.05$ 进行比较计算。\n- 您的程序应生成单行输出，其中包含一个用逗号分隔并用方括号括起来的结果列表。对于每个 $c$ 值（按 $c = 0.0, c = 0.3, c = 0.8$ 的顺序），该列表必须连接四个项 $[\\max_{\\omega}\\,\\bar{\\sigma}(S), \\max_{\\omega}\\,\\bar{\\sigma}(T), \\text{peakS}, \\text{peakT}]$，每个峰值四舍五入到六位小数，每个布尔值作为不带引号的字面量，最终形成一个长度为 12 的扁平列表。例如，输出格式必须为 $[\\text{val}_{1},\\text{val}_{2},\\text{bool}_{1},\\text{bool}_{2},\\ldots]$，不含任何附加文本。", "solution": "此问题已经过验证。所有给定条件，包括被控对象传递矩阵 $G(s)$、对角控制器 $K(s)$、反馈配置和分析任务，都已明确说明。该问题在科学上基于标准的多输入多输出（MIMO）控制理论，利用了灵敏度函数、频率响应和奇异值分析等概念。该问题是适定的、客观的，并包含足够的信息以获得唯一解。不存在矛盾、歧义或事实不准确之处。因此，该问题被视为**有效**，我将继续提供解决方案。\n\n该问题的基础在于对线性时不变（LTI）负反馈系统进行代数分析。系统的行为由被控对象 $G(s)$ 和控制器 $K(s)$ 的互联描述。我们给出了参考信号 $R(s)$、误差信号 $E(s)$、控制器输出 $U(s)$ 和被控对象输出 $Y(s)$ 的向量信号，所有信号均在拉普拉斯域中。系统动态由以下方程控制：\n$$Y(s) = G(s)U(s) \\quad (\\text{被控对象})$$\n$$U(s) = K(s)E(s) \\quad (\\text{控制器})$$\n$$E(s) = R(s) - Y(s) \\quad (\\text{负反馈误差})$$\n任务要求从第一性原理推导闭环传递矩阵。\n\n首先，我们推导互补灵敏度矩阵 $T(s)$，它是从参考输入 $R(s)$ 到被控对象输出 $Y(s)$ 的闭环传递函数。我们通过代数代换来消除内部信号 $E(s)$ 和 $U(s)$ 来实现这一目标：\n$$Y(s) = G(s)U(s) = G(s)K(s)E(s)$$\n代入误差 $E(s)$ 的表达式：\n$$Y(s) = G(s)K(s)(R(s) - Y(s))$$\n我们展开此表达式，并将包含 $Y(s)$ 的项组合在一起：\n$$Y(s) = G(s)K(s)R(s) - G(s)K(s)Y(s)$$\n$$IY(s) + G(s)K(s)Y(s) = G(s)K(s)R(s)$$\n这里，$I$ 是适当维度的单位矩阵，本例中为 $2 \\times 2$。提出 $Y(s)$ 因子得到：\n$$(I + G(s)K(s))Y(s) = G(s)K(s)R(s)$$\n为了分离出 $Y(s)$，我们用 $(I + G(s)K(s))$ 的逆矩阵进行左乘：\n$$Y(s) = (I + G(s)K(s))^{-1}G(s)K(s)R(s)$$\n根据定义，$Y(s) = T(s)R(s)$，所以互补灵敏度矩阵为：\n$$T(s) = (I + L(s))^{-1}L(s)$$\n其中 $L(s) = G(s)K(s)$ 是环路传递矩阵。\n\n接下来，我们推导灵敏度矩阵 $S(s)$，它是从参考信号 $R(s)$ 到误差信号 $E(s)$ 的闭环传递函数。从误差定义开始：\n$$E(s) = R(s) - Y(s)$$\n代入 $Y(s) = T(s)R(s)$：\n$$E(s) = R(s) - T(s)R(s) = (I - T(s))R(s)$$\n因此，我们得到恒等式 $S(s) = I - T(s)$。我们可以通过代入 $T(s)$ 的表达式，用环路矩阵 $L(s)$ 来表示 $S(s)$：\n$$S(s) = I - (I + L(s))^{-1}L(s)$$\n为简化，我们将 $I$ 写为 $(I + L(s))^{-1}(I + L(s))$：\n$$S(s) = (I + L(s))^{-1}(I + L(s)) - (I + L(s))^{-1}L(s)$$\n$$S(s) = (I + L(s))^{-1}(I + L(s) - L(s))$$\n这简化为灵敏度矩阵的规范形式：\n$$S(s) = (I + L(s))^{-1}$$\n\n分析在频域中进行，通过设置 $s = j\\omega$，其中 $j$ 是虚数单位，$\\omega$ 是角频率。在每个频率下，所得复数矩阵 $S(j\\omega)$ 和 $T(j\\omega)$ 的“大小”由其最大奇异值 $\\bar{\\sigma}(\\cdot)$ 来量化，该值对应于诱导2-范数。最大奇异值定义为 $\\bar{\\sigma}(M) = \\sqrt{\\lambda_{\\max}(M^*M)}$，其中 $M^*$ 是 $M$ 的共轭转置，$\\lambda_{\\max}$ 表示最大特征值。\n\n数值计算步骤如下。我们给定的被控对象是：\n$$G(s) = \\begin{pmatrix} \\frac{2}{(s+1)(0.5s+1)}  c \\cdot \\frac{0.5}{s+1} \\\\ -c \\cdot \\frac{0.4}{s+0.2}  \\frac{3}{(s+2)(0.2s+1)} \\end{pmatrix}$$\n和控制器：\n$$K(s) = \\begin{pmatrix} 1.5  0 \\\\ 0  1.2 \\end{pmatrix}$$\n创建一个由 $N=2000$ 个频率 $\\omega_k$ 组成的网格，这些频率在 $10^{-2}$ 到 $10^3$ rad/s 的范围内对数间隔。对于每个 $c \\in \\{0.0, 0.3, 0.8\\}$ 值，以及网格中的每个频率 $\\omega_k$：\n1. 计算复数值 $s_k = j\\omega_k$。\n2. 通过代入 $s_k$ 来构建复数矩阵 $G(j\\omega_k)$。\n3. 计算环路传递矩阵 $L(j\\omega_k) = G(j\\omega_k)K$。\n4. 使用数值稳定的矩阵求逆方法计算灵敏度矩阵 $S(j\\omega_k) = (I + L(j\\omega_k))^{-1}$ 和互补灵敏度矩阵 $T(j\\omega_k) = S(j\\omega_k)L(j\\omega_k)$。\n5. 通过奇异值分解（SVD）计算最大奇异值 $\\bar{\\sigma}(S(j\\omega_k))$ 和 $\\bar{\\sigma}(T(j\\omega_k))$。\n6. 这些奇异值在所有频率上的最大值被记录为 $\\max_{\\omega} \\bar{\\sigma}(S)$ 和 $\\max_{\\omega} \\bar{\\sigma}(T)$。\n\n$c=0$ 的情况为解耦系统建立了基准性能，得到 $\\max_{\\omega}\\bar{\\sigma}(S_{\\text{diag}})$ 和 $\\max_{\\omega}\\bar{\\sigma}(T_{\\text{diag}})$。对于每个 $c$，通过以下比率评估由耦合引起的性能下降：\n$$R_S(c) = \\frac{\\max_{\\omega}\\bar{\\sigma}(S_{\\mathrm{MIMO}}(j\\omega; c))}{\\max_{\\omega}\\bar{\\sigma}(S_{\\mathrm{diag}}(j\\omega))}, \\quad R_T(c) = \\frac{\\max_{\\omega}\\bar{\\sigma}(T_{\\mathrm{MIMO}}(j\\omega; c))}{\\max_{\\omega}\\bar{\\sigma}(T_{\\mathrm{diag}}(j\\omega))}$$\n将这些比率与阈值 $\\tau = 1.05$ 进行比较，以生成布尔标志 $\\text{peakS}(c)$ 和 $\\text{peakT}(c)$，用以指示显著的峰值。收集最终结果并按规定格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the MIMO sensitivity analysis problem.\n    \"\"\"\n    # Define system parameters and analysis grid\n    k1 = 1.5\n    k2 = 1.2\n    K = np.diag([k1, k2])\n    N = 2000\n    omega_grid = np.logspace(-2, 3, N)\n    c_values = [0.0, 0.3, 0.8]\n    tau = 1.05\n    I = np.identity(2)\n    \n    test_cases = c_values\n    \n    # Dictionary to store the peak singular values for each c\n    peak_results = {}\n\n    # Iterate over each test case for the coupling parameter c\n    for c in test_cases:\n        max_sigma_S = 0.0\n        max_sigma_T = 0.0\n        \n        # Iterate over each frequency in the grid\n        for w in omega_grid:\n            s = 1j * w\n            \n            # Evaluate the plant transfer matrix G(jw)\n            g11 = 2 / ((s + 1) * (0.5 * s + 1))\n            g22 = 3 / ((s + 2) * (0.2 * s + 1))\n            g12 = c * 0.5 / (s + 1)\n            g21 = -c * 0.4 / (s + 0.2)\n            G = np.array([[g11, g12], [g21, g22]], dtype=complex)\n            \n            # Compute the loop transfer matrix L(jw)\n            L = G @ K\n            \n            # Compute sensitivity S(jw) and complementary sensitivity T(jw)\n            # Using np.linalg.solve for numerical stability (solves (I+L)X = I for X)\n            S = np.linalg.solve(I + L, I)\n            T = S @ L\n            \n            # Compute singular values using SVD. svd returns them in descending order.\n            sigma_S = np.linalg.svd(S, compute_uv=False)\n            sigma_T = np.linalg.svd(T, compute_uv=False)\n            \n            # The largest singular value is the first element\n            current_max_sigma_S = sigma_S[0]\n            current_max_sigma_T = sigma_T[0]\n            \n            # Update the peak values found so far\n            if current_max_sigma_S  max_sigma_S:\n                max_sigma_S = current_max_sigma_S\n            \n            if current_max_sigma_T  max_sigma_T:\n                max_sigma_T = current_max_sigma_T\n                \n        # Store the peak values for the current c\n        peak_results[c] = (max_sigma_S, max_sigma_T)\n\n    # Get the baseline (diagonal) results from c = 0.0\n    peak_S_diag, peak_T_diag = peak_results[0.0]\n\n    all_results = []\n    # Process each test case to compute ratios and flags\n    for c in test_cases:\n        peak_S_mimo, peak_T_mimo = peak_results[c]\n        \n        # Calculate ratios relative to the diagonal case\n        # Guard against division by zero, although not expected in this problem\n        if peak_S_diag != 0:\n            R_S = peak_S_mimo / peak_S_diag\n        else:\n            R_S = float('inf') if peak_S_mimo  0 else 1.0\n\n        if peak_T_diag != 0:\n            R_T = peak_T_mimo / peak_T_diag\n        else:\n            R_T = float('inf') if peak_T_mimo  0 else 1.0\n\n        # Determine boolean flags based on the threshold tau\n        peakS_flag = R_S  tau\n        peakT_flag = R_T  tau\n        \n        # Append formatted results to the final list\n        all_results.extend([\n            f\"{peak_S_mimo:.6f}\",\n            f\"{peak_T_mimo:.6f}\",\n            str(peakS_flag),\n            str(peakT_flag)\n        ])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2713822"}]}