## 引言
[状态空间表示](@entry_id:147149)法是现代控制理论的基石，它通过一组一阶[微分](@entry_id:158718)或[差分方程](@entry_id:262177)，为描述复杂动态系统的内部机理提供了一个强大而系统的框架。通过将系统抽象为状态、输入和输出之间的关系，我们能够深入分析和设计控制策略。然而，一个根本性的问题随之产生：如果我们仅能观测一个系统的外部行为——即其输入与输出之间的关系——我们能在多大程度上唯一地确定其内部的状态空间模型？这个问题的答案，即[状态空间实现](@entry_id:166670)的非唯一性，是理解状态空间方法精髓的关键。

本文旨在系统地揭示这一核心概念。我们将从第一性原理出发，探索为何同一个输入-输出行为可以对应无限多个内部[状态表示](@entry_id:141201)。通过本文的学习，你将掌握连接不同实现的数学工具，并理解这种非唯一性在理论和实践中的深远影响。

文章分为三个部分。在“原理与机制”一章中，我们将建立从[状态空间到传递函数](@entry_id:268082)的数学桥梁，并证明[相似变换](@entry_id:152935)是导致实现非唯一性的根本原因。我们将引入能控性、能观性和[最小实现](@entry_id:176932)等关键概念，并利用[卡尔曼分解](@entry_id:144281)来剖析非[最小实现](@entry_id:176932)中的隐藏动态。接下来，在“应用与交叉学科联系”一章中，我们将探讨这一原理在[控制工程](@entry_id:149859)、[系统辨识](@entry_id:201290)、机器学习以及计量经济学和[化学动力学](@entry_id:144961)等多个领域的实际意义，展示它如何既是设计的自由度，也是建模的挑战。最后，“动手实践”部分将提供一系列练习，让你通过具体计算来巩固对理论的理解，亲手构造和分析不同的[状态空间实现](@entry_id:166670)。

## 原理与机制

在上一章中，我们介绍了将动态系统描述为状态空间模型的概念。一个线性时不变（LTI）系统可以通过一组一阶[微分](@entry_id:158718)或[差分方程](@entry_id:262177)来表示，其通用形式为：

-   **[连续时间系统](@entry_id:276553)**: $\dot{x}(t) = Ax(t) + Bu(t)$, $y(t) = Cx(t) + Du(t)$
-   **离散时间系统**: $x_{k+1} = Ax_k + Bu_k$, $y_k = Cx_k + Du_k$

其中 $x$ 是[状态向量](@entry_id:154607)，$u$ 是输入向量，$y$ 是输出向量，而 $(A, B, C, D)$ 是描述系统内部动态、输入如何影响状态、状态如何产生输出以及输入如何直接馈通到输出的矩阵四元组。

一个自然而然的问题是：系统的外部行为，即其输入-输出关系，与这个内部[状态空间表示](@entry_id:147149)有何关联？本章将深入探讨这一关系，并揭示一个核心概念：对于任何给定的输入-输出行为，存在无限多个等效的[状态空间实现](@entry_id:166670)。理解这种非唯一性的结构是现代控制理论的基石。

### 从[状态空间到传递函数](@entry_id:268082)

为了分析[LTI系统](@entry_id:271946)的输入-输出行为，我们通常在变换域中工作。对于[连续时间系统](@entry_id:276553)，我们使用[拉普拉斯变换](@entry_id:159339)；对于离散时间系统，我们使用[Z变换](@entry_id:157804)。假设系统的[初始条件](@entry_id:152863)为零（即 $x(0) = \mathbf{0}$ 或 $x_0 = \mathbf{0}$），我们可以推导出系统的[传递函数](@entry_id:273897)（或[传递矩阵](@entry_id:145510)）$G$。

让我们以[连续时间系统](@entry_id:276553)为例。对[状态方程](@entry_id:274378)进行[拉普拉斯变换](@entry_id:159339)，我们得到：
$sX(s) = AX(s) + BU(s)$

整理 $X(s)$ 的项，我们有：
$(sI - A)X(s) = BU(s)$

只要矩阵 $(sI - A)$ 是可逆的，我们就可以解出 $X(s)$：
$X(s) = (sI - A)^{-1}BU(s)$

现在，我们将这个表达式代入输出方程的[拉普拉斯变换](@entry_id:159339) $Y(s) = CX(s) + DU(s)$ 中：
$Y(s) = C(sI - A)^{-1}BU(s) + DU(s) = (C(sI - A)^{-1}B + D)U(s)$

因此，从输入 $U(s)$ 到输出 $Y(s)$ 的传递矩阵 $G(s)$ 就由[状态空间](@entry_id:177074)四元组 $(A, B, C, D)$ 唯一确定：
$G(s) = C(sI - A)^{-1}B + D$

这个关系式构成了[状态空间](@entry_id:177074)理论与经典[频域分析](@entry_id:265642)之间的桥梁。值得注意的是，这个表达式仅在 $sI - A$ 可逆时有定义，即当 $s$ 不是矩阵 $A$ 的[特征值](@entry_id:154894)时。$A$ 的[特征值](@entry_id:154894)对应于系统的“模态”或“极点”[@problem_id:2727820]。此外，对于一个物理上可实现的（或“真”的）系统，[传递函数](@entry_id:273897) $G(s)$ 在 $s \to \infty$ 时的极限必须存在。这个极限恰好是矩阵 $D$：
$\lim_{s \to \infty} G(s) = \lim_{s \to \infty} (C(sI - A)^{-1}B + D) = D$
因为当 $|s|$ 很大时，$(sI - A)^{-1} \approx \frac{1}{s}I$，因此 $C(sI - A)^{-1}B$ 项趋于零。如果 $D=0$，系统被称为**严格真**的；否则，它是**真**的。

完全相同的代数推导也适用于[离散时间系统](@entry_id:263935)，只需将拉普拉斯变量 $s$ 替换为[Z变换](@entry_id:157804)变量 $z$ 即可[@problem_id:2727834]：
$G(z) = C(zI - A)^{-1}B + D$

### 核心原理：相似变换下的不变性

我们已经看到，一个给定的[状态空间实现](@entry_id:166670) $(A,B,C,D)$ 会产生一个唯一的[传递函数](@entry_id:273897) $G(s)$。然而，反过来是否成立呢？一个给定的 $G(s)$ 是否对应一个唯一的 $(A,B,C,D)$？答案是否定的，这也是本章的核心主题。

状态向量 $x$ 的选择在某种意义上是任意的。它是一个内部变量，其物理意义取决于我们如何建模。我们可以通过任何可逆矩阵 $T$ 对[状态向量](@entry_id:154607)进行[线性变换](@entry_id:149133)，定义一个新的状态向量 $\tilde{x} = Tx$。这个变换仅仅是改变了[状态空间](@entry_id:177074)的[坐标基](@entry_id:270149)，而不应改变系统的外部输入-输出行为。让我们看看这个[坐标变换](@entry_id:172727)如何影响 $(A,B,C,D)$ 矩阵。

从 $\tilde{x} = Tx$ 可得 $x = T^{-1}\tilde{x}$。将其代入连续时间[状态方程](@entry_id:274378)：
$\dot{\tilde{x}}(t) = T\dot{x}(t) = T(Ax(t) + Bu(t)) = T(AT^{-1}\tilde{x}(t) + Bu(t))$
$\dot{\tilde{x}}(t) = (TAT^{-1})\tilde{x}(t) + (TB)u(t)$

同样，输出方程变为：
$y(t) = Cx(t) + Du(t) = (CT^{-1})\tilde{x}(t) + Du(t)$

因此，在新的[坐标系](@entry_id:156346)下，系统由一个新的四元组 $(\tilde{A}, \tilde{B}, \tilde{C}, \tilde{D})$ 描述，其中：
$\tilde{A} = TAT^{-1}, \quad \tilde{B} = TB, \quad \tilde{C} = CT^{-1}, \quad \tilde{D} = D$

这个变换被称为**相似变换**。现在，我们来计算新实现的[传递函数](@entry_id:273897) $\tilde{G}(s)$：
$\tilde{G}(s) = \tilde{C}(sI - \tilde{A})^{-1}\tilde{B} + \tilde{D} = (CT^{-1})(sI - TAT^{-1})^{-1}(TB) + D$

利用关键的矩阵恒等式 $(sI - TAT^{-1})^{-1} = T(sI - A)^{-1}T^{-1}$ [@problem_id:2727834]，我们得到：
$\tilde{G}(s) = (CT^{-1})[T(sI - A)^{-1}T^{-1}](TB) + D$
$= C(T^{-1}T)(sI - A)^{-1}(T^{-1}T)B + D$
$= C(sI - A)^{-1}B + D = G(s)$

这个结果至关重要：**任何通过[相似变换](@entry_id:152935)关联的[状态空间实现](@entry_id:166670)都具有完全相同的[传递函数](@entry_id:273897)** [@problem_id:2727823]。由于对于任何给定的维数 $n \ge 1$，存在无限多个可逆矩阵 $T$（它们构成了所谓的[一般线性群](@entry_id:141275) $GL_n(\mathbb{R})$），因此对于任何一个[状态空间实现](@entry_id:166670)，都存在无限多个与之等效的实现。这些等效实现构成了在相似变换群作用下的一个**[轨道](@entry_id:137151)（orbit）**[@problem_id:2727861]。

这种非唯一性意味着，仅从外部测量（即输入-输出数据）我们无法确定系统内部状态变量的具体选择。我们可以确定[传递函数](@entry_id:273897) $G(s)$，但不能唯一地确定实现 $(A,B,C,D)$。

### 变换下的[不变量](@entry_id:148850)

既然 $(A,B,C)$ 矩阵不是唯一的，那么哪些量是系统输入-输出行为的内在属性，并且在[相似变换](@entry_id:152935)下保持不变呢？

首先，我们已经证明了**[传递函数](@entry_id:273897) $G(s)$** 本身是一个[不变量](@entry_id:148850)。

另一个等效的[不变量](@entry_id:148850)是系统的**马尔可夫参数**序列。对于一个离散时间系统（或一个离散化的[连续时间系统](@entry_id:276553)），其脉冲响应序列由马尔可夫参数给出。对于一个严格真的系统（$D=0$），当输入是在第0时刻的[单位脉冲](@entry_id:272155)时，$x_0=0, u_0=1, u_k=0 \text{ for } k>0$，输出序列为：
$y_0 = 0$
$y_1 = CBu_0 = CB$
$y_2 = CAx_1 = CABu_0 = CAB$
$y_3 = CAx_2 = CA^2Bu_0 = CA^2B$
...
$y_k = CA^{k-1}B$

这些量 $g_k = CA^{k-1}B$ ($k \ge 1$) 被称为马尔可夫参数。它们在相似变换下也是不变的。让我们来验证 $g_k' = \tilde{C}\tilde{A}^{k-1}\tilde{B}$：
$g_k' = (CT^{-1})(TAT^{-1})^{k-1}(TB)$
由于 $(TAT^{-1})^{k-1} = TA^{k-1}T^{-1}$，我们有：
$g_k' = (CT^{-1})(TA^{k-1}T^{-1})(TB) = C(T^{-1}T)A^{k-1}(T^{-1}T)B = CA^{k-1}B = g_k$

因此，整个马尔可夫参数序列都是系统输入-输出行为的内在特征，与状态坐标的选择无关 [@problem_id:2727859]。

### [最小实现](@entry_id:176932)与唯一性定理

到目前为止，我们已经确定了[状态空间实现](@entry_id:166670)的非唯一性。然而，这种非唯一性并非完全没有结构。为了引入序，我们需要定义**能控性 (controllability)** 和**能观性 (observability)** 的概念。

-   一个系统（或状态）是**能控的**，如果可以通过选择合适的输入信号，在有限时间内将系统从任意初始状态驱动到任意最终状态。
-   一个系统（或状态）是**能观的**，如果通过观测有限时间内的输出信号，可以唯一地确定系统的初始状态（在零输入下）。

如果一个[状态空间实现](@entry_id:166670)既是完全能控的又是完全能观的，它被称为**[最小实现](@entry_id:176932) (minimal realization)**。[最小实现](@entry_id:176932)具有一个至关重要的特性：它的状态维数 $n$ 是所有能产生给定[传递函数](@entry_id:273897) $G(s)$ 的实现中最低的。这个最小的维数被称为 $G(s)$ 的**麦克米伦阶 (McMillan degree)** [@problem_id:2727840]。

有了最小性的概念，我们就可以陈述一个关于唯一性的基本定理：
**定理：** 对于一个给定的[传递函数](@entry_id:273897) $G(s)$，其任何两个[最小实现](@entry_id:176932) $(\tilde{A}, \tilde{B}, \tilde{C}, \tilde{D})$ 和 $(A, B, C, D)$ 必定通过一个唯一的相似变换相关联。

这意味着，尽管对于一个给定的 $G(s)$ 仍然存在无限多个[最小实现](@entry_id:176932)，但它们不再是任意的。它们都具有相同的维数（麦克米伦阶），并且都属于同一个由[相似变换](@entry_id:152935)定义的等价类 [@problem_id:2727823]。

### 理解非[最小实现](@entry_id:176932)：[卡尔曼分解](@entry_id:144281)

如果一个实现不是最小的，那意味着它包含了一些“多余”的动态。这些动态要么是输入无法影响的（不能控），要么是对输出没有贡献的（不能观），或者两者兼有。[卡尔曼分解定理](@entry_id:169379)提供了一个清晰的结构化视角来理解这些“隐藏模态”。

任何一个[LTI系统](@entry_id:271946)都可以通过一个[相似变换](@entry_id:152935)（即选择一个合适的[坐标基](@entry_id:270149)）分解为四个子系统：
1.  **能控且能观 (co)** 的部分
2.  **能控但不能观 (cuo)** 的部分
3.  **不能控但能观 (uco)** 的部分
4.  **既不能控也不能观 (ucuo)** 的部分

在这个特殊的[坐标系](@entry_id:156346)下，[系统矩阵](@entry_id:172230)呈现出特定的块状结构[@problem_id:2727862]：
$\bar{A} = \begin{bmatrix} A_{co}  & 0  & A_{13}  & 0 \\ A_{21}  & A_{cuo}  & A_{23}  & A_{24} \\ 0  & 0  & A_{uco}  & 0 \\ 0  & 0  & A_{43}  & A_{ucuo} \end{bmatrix}, \quad \bar{B} = \begin{bmatrix} B_{co} \\ B_{cuo} \\ 0 \\ 0 \end{bmatrix}, \quad \bar{C} = \begin{bmatrix} C_{co}  & 0  & C_{uco}  & 0 \end{bmatrix}$

零块的出现并非偶然，而是由能控性和能观性[子空间](@entry_id:150286)的定义直接决定的。例如，$B$ 矩阵的下面两个块为零，因为输入只能影响能控[子空间](@entry_id:150286)。同样，$C$ 矩阵的第二和第四列块为零，因为不能观[子空间](@entry_id:150286)的状态对输出没有贡献。

最关键的结论来自于计算这个分解后系统的[传递函数](@entry_id:273897)。经过代数推导可以证明[@problem_id:2727862]：
$G(s) = C_{co}(sI - A_{co})^{-1}B_{co} + D$

这个结果揭示了一个深刻的真理：**系统的输入-输出行为完全由其能控且能观的子系统决定**。其他三个子系统（$cuo, uco, ucuo$）的动态，即所谓的**隐藏模态 (hidden modes)**，对[传递函数](@entry_id:273897)没有任何贡献。它们的[特征值](@entry_id:154894)（即 $A_{cuo}, A_{uco}, A_{ucuo}$ 的[特征值](@entry_id:154894)）虽然是原[系统矩阵](@entry_id:172230) $A$ 的[特征值](@entry_id:154894)，但不会出现在[传递函数](@entry_id:273897) $G(s)$ 的极点中。

我们可以通过具体的例子来理解这一点。考虑一个目标[传递函数](@entry_id:273897) $G(s) = \frac{1}{s+1}$。它的[最小实现](@entry_id:176932)是一维的，例如 $(A,B,C) = (-1, 1, 1)$。然而，我们可以构造出具有任意隐藏模态的非[最小实现](@entry_id:176932)。

-   **例子1：增加一个不能观的模态**
    考虑一个二维系统，其状态矩阵为 $A = \operatorname{diag}(-1, \lambda)$，其中 $\lambda$ 是任意实数。如果我们选择 $B = \begin{pmatrix} 1 \\ 1 \end{pmatrix}$ 和 $C = \begin{pmatrix} 1  & 0 \end{pmatrix}$，那么与[特征值](@entry_id:154894) $\lambda$ 相关的模态是能控的（因为 $B$ 的第二个分量非零）但是不能观的（因为 $C$ 的第二个分量为零）。该系统的[传递函数](@entry_id:273897)为：
    $G(s) = \begin{pmatrix} 1  & 0 \end{pmatrix} \begin{pmatrix} \frac{1}{s+1}  & 0 \\ 0  & \frac{1}{s-\lambda} \end{pmatrix} \begin{pmatrix} 1 \\ 1 \end{pmatrix} = \frac{1}{s+1}$
    无论 $\lambda$ 取何值，[传递函数](@entry_id:273897)都保持不变。因此，极点 $\lambda$ 是一个从外部无法探测到的隐藏模态 [@problem_id:2727822]。

-   **例子2：增加一个既不能控也不能观的模态**
    如果我们选择 $A = \operatorname{diag}(-1, \lambda)$, $B = \begin{pmatrix} 1 \\ 0 \end{pmatrix}$, $C = \begin{pmatrix} 1  & 0 \end{pmatrix}$，那么模态 $\lambda$ 既不能控也不能观。[传递函数](@entry_id:273897)显然也只是 $\frac{1}{s+1}$ [@problem_id:2727822]。

### 后果与澄清

#### 非[最小实现](@entry_id:176932)的非唯一性
[最小实现](@entry_id:176932)[唯一性定理](@entry_id:166861)的美妙之处在于它对“最小”的严格要求。如果两个实现不是最小的，它们即使具有相同的[传递函数](@entry_id:273897)，也**不一定**能通过[相似变换](@entry_id:152935)相关联。这是因为它们可以包含不同维数或不同动态特性的隐藏部分。

例如，对于 $G(s) = \frac{1}{s+1}$，考虑以下两个非[最小实现](@entry_id:176932)[@problem_id:2727855]：
-   $\Sigma_{1}: A_{1} = \begin{pmatrix} -1  & 0 \\ 0  & 0 \end{pmatrix}, B_{1} = \begin{pmatrix} 1 \\ 0 \end{pmatrix}, C_{1} = \begin{pmatrix} 1  & 0 \end{pmatrix}$
-   $\Sigma_{2}: A_{2} = \begin{pmatrix} -1  & 0 \\ 0  & 2 \end{pmatrix}, B_{2} = \begin{pmatrix} 1 \\ 0 \end{pmatrix}, C_{2} = \begin{pmatrix} 1  & 0 \end{pmatrix}$

这两个实现都具有[传递函数](@entry_id:273897) $\frac{1}{s+1}$。然而，$A_1$ 的[特征值](@entry_id:154894)集是 $\{-1, 0\}$，而 $A_2$ 的[特征值](@entry_id:154894)集是 $\{-1, 2\}$。由于[相似变换](@entry_id:152935)保持矩阵的[特征值](@entry_id:154894)不变，所以 $A_1$ 和 $A_2$ 不可能是相似的。因此，这两个实现 $\Sigma_1$ 和 $\Sigma_2$ 也不是相似的。这清晰地表明，一旦放弃最小性，唯一性定理就不再成立。

#### 规范型（Canonical Forms）的作用
在文献中，我们经常遇到诸如**能控规范型**或**能观规范型**等术语。一个常见的误解是，这些规范型解决了非唯一性的问题。事实并非如此。

一个规范型，本质上是一种通过选择一个特定的状态[坐标基](@entry_id:270149)，使得 $(A,B,C)$ 矩阵呈现出一种非常标准和简化的结构。对于任何一个[最小实现](@entry_id:176932)，我们总能找到一个相似变换 $T$，将其转换为指定的规范型。因此，规范型并没有消除非唯一性；相反，它恰恰是利用了[相似变换](@entry_id:152935)所提供的自由度，从无限多个等效的实现中挑选出一个方便分析的**代表**。从一个规范型出发，应用任何非单位阵的[相似变换](@entry_id:152935)，我们又可以得到无限多个非规范型的、但完[全等](@entry_id:273198)效的实现 [@problem_id:2727827]。规范型是处理非唯一性的一种实用工具，而非其终结者。

综上所述，从[状态空间实现](@entry_id:166670)到[传递函数](@entry_id:273897)的映射是“多对一”的。这种非唯一性的核心机制是状态空间的[坐标变换](@entry_id:172727)自由度，由[相似变换](@entry_id:152935)群来精确描述。对于[最小实现](@entry_id:176932)，这种自由度被约束在一个固定维数的[等价类](@entry_id:156032)中。而对于非[最小实现](@entry_id:176932)，系统可以包含任意的、与外部行为解耦的隐藏动态，从而打破了这种简单的等价关系。理解这种微妙的结构对于系统辨识、[控制器设计](@entry_id:274982)和模型降阶等高级主题至关重要。