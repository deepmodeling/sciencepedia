{"hands_on_practices": [{"introduction": "在现代控制系统中，我们通常处理的是通过数字计算机采集到的离散时间数据。因此，一项至关重要的技能是从这些采样数据中准确地辨识出底层连续时间系统的物理参数。本练习 [@problem_id:2698490] 将引导您从离散时间极点的极坐标表示 $(\\rho, \\theta)$ 出发，推导出恢复连续时间系统阻尼比 $\\zeta$ 和自然频率 $\\omega_n$ 的关键关系，从而在理论与实践之间架起一座桥梁。", "problem": "一个实的、严格真的二阶线性时不变（LTI）连续时间系统具有共轭复极点。该系统以采样周期 $T$ 进行精确采样，得到一个离散时间模型，其单个样本内的状态转移是该连续时间生成元的矩阵指数。从一个数据集中，主导的离散时间极点对已被估计为极坐标形式 $z=\\rho \\exp(\\pm j \\theta)$，其中 $0  \\rho  1$ 且 $\\theta \\in (0,\\pi)$，$\\theta$ 的单位是弧度。\n\n仅从 (i) 具有实系数的连续时间二阶特征方程和 (ii) 连续时间生成元与离散时间生成元之间的精确采样关系出发，完成以下任务：\n\n1. 推导连续时间自然频率 $\\omega_{n}$ 和阻尼比 $\\zeta$ 关于 $\\rho$、$\\theta$ 和 $T$ 的显式表达式。陈述您在推导过程中所作的任何分支假设，并根据给定的 $\\theta$ 范围证明其合理性。\n\n2. 对于数值 $\\rho=0.8$，$\\theta=0.6$（弧度）和 $T=0.05$ 秒，使用您推导的公式计算阻尼比。将您的答案四舍五入到 $4$ 位有效数字。\n\n以阻尼比 $\\zeta$ 的单个数值（无单位）作为您的最终答案。", "solution": "该问题是适定的，并且在科学上是合理的，其依据是控制理论的既定原理。我们可以进行形式推导。\n\n第一步是将连续时间系统参数与其在复 $s$ 平面中的极点联系起来。一个实的、二阶线性时不变（LTI）连续时间系统具有以下形式的特征方程：\n$$s^2 + 2\\zeta\\omega_{n}s + \\omega_{n}^2 = 0$$\n此处，$\\zeta$ 是阻尼比，$\\omega_{n}$ 是无阻尼自然频率。问题陈述该系统具有共轭复极点，这对应于一个欠阻尼系统，其中 $0  \\zeta  1$。作为该特征方程根的极点由下式给出：\n$$s_{1,2} = \\frac{-2\\zeta\\omega_{n} \\pm \\sqrt{(2\\zeta\\omega_{n})^2 - 4(1)(\\omega_{n}^2)}}{2} = -\\zeta\\omega_{n} \\pm \\omega_{n}\\sqrt{\\zeta^2 - 1}$$\n由于 $0  \\zeta  1$，项 $\\zeta^2 - 1$ 为负。我们可以将极点写为：\n$$s_{1,2} = -\\zeta\\omega_{n} \\pm j\\omega_{n}\\sqrt{1 - \\zeta^2}$$\n我们定义阻尼自然频率 $\\omega_{d}$ 为 $\\omega_{d} = \\omega_{n}\\sqrt{1 - \\zeta^2}$。因此，连续时间极点可简洁地表示为：\n$$s_{1,2} = -\\zeta\\omega_{n} \\pm j\\omega_{d}$$\n\n第二步是使用连续时间系统与其离散时间对应物之间的指定关系。系统以周期 $T$ 进行采样。离散时间系统的极点 $z$ 与连续时间系统的极点 $s$ 通过以下精确映射关系相关联：\n$$z = \\exp(sT)$$\n将连续时间极点 $s_{1,2}$ 的表达式代入此映射函数，得到离散时间极点：\n$$z_{1,2} = \\exp( (-\\zeta\\omega_{n} \\pm j\\omega_{d}) T ) = \\exp(-\\zeta\\omega_{n}T) \\exp(\\pm j\\omega_{d}T)$$\n该表达式是极坐标形式，其中模为 $\\exp(-\\zeta\\omega_{n}T)$，相角为 $\\pm \\omega_{d}T$。\n\n问题陈述，估计的离散时间极点以极坐标形式给出为 $z = \\rho \\exp(\\pm j\\theta)$，其中 $0  \\rho  1$ 且 $\\theta \\in (0, \\pi)$。通过比较离散时间极点的这两种形式，我们可以使其模和辐角相等：\n模：$\\rho = \\exp(-\\zeta\\omega_{n}T)$\n辐角：$\\theta = \\omega_{d}T + 2\\pi k$，对于某个整数 $k$。\n\n我们必须证明对辐角选择分支的合理性，这等价于为整数 $k$ 选择一个值。从 $z$ 到 $s$ 的逆映射是多值的：$s = \\frac{1}{T}\\ln(z) = \\frac{1}{T}(\\ln|z| + j(\\arg(z)+2\\pi k))$。问题中提到的“主导”离散时间极点对，在从采样数据进行系统辨识的背景下，通常被假定对应于具有最低可能频率（主混叠）的连续时间极点。这对应于设置 $k=0$。指定的离散时间角度范围 $\\theta \\in (0, \\pi)$ 意味着相应的阻尼自然频率 $\\omega_{d} = \\theta/T$ 在范围 $(0, \\pi/T)$ 内。这是低于奈奎斯特频率 $\\omega_{Nyq} = \\pi/T$ 的基带频率范围，并且是唯一地恢复连续时间参数的标准假设。因此，我们作出 $k=0$ 的分支假设，并继续使用：\n$$\\theta = \\omega_{d}T$$\n\n我们现在有一个包含两个未知数 $\\zeta$ 和 $\\omega_{n}$ 的方程组：\n(1) $\\rho = \\exp(-\\zeta\\omega_{n}T)$\n(2) $\\theta = \\omega_{d}T = (\\omega_{n}\\sqrt{1 - \\zeta^2})T$\n\n从方程（1），我们对两边取自然对数：\n$$\\ln(\\rho) = -\\zeta\\omega_{n}T \\implies \\zeta\\omega_{n} = -\\frac{\\ln(\\rho)}{T}$$\n从方程（2），我们分离出包含 $\\omega_{n}$ 的项：\n$$\\omega_{n}\\sqrt{1 - \\zeta^2} = \\frac{\\theta}{T}$$\n为了解出 $\\zeta$，我们将得到的第二个方程除以第一个方程：\n$$\\frac{\\omega_{n}\\sqrt{1 - \\zeta^2}}{\\zeta\\omega_{n}} = \\frac{\\theta/T}{-\\ln(\\rho)/T} \\implies \\frac{\\sqrt{1 - \\zeta^2}}{\\zeta} = -\\frac{\\theta}{\\ln(\\rho)}$$\n对两边进行平方以消除根号，得到：\n$$\\frac{1 - \\zeta^2}{\\zeta^2} = \\left(-\\frac{\\theta}{\\ln(\\rho)}\\right)^2 = \\frac{\\theta^2}{(\\ln(\\rho))^2}$$\n我们可以将左边重写为 $\\frac{1}{\\zeta^2} - 1$。解出 $\\frac{1}{\\zeta^2}$：\n$$\\frac{1}{\\zeta^2} = 1 + \\frac{\\theta^2}{(\\ln(\\rho))^2} = \\frac{(\\ln(\\rho))^2 + \\theta^2}{(\\ln(\\rho))^2}$$\n对此表达式求倒数，得到 $\\zeta^2$：\n$$\\zeta^2 = \\frac{(\\ln(\\rho))^2}{(\\ln(\\rho))^2 + \\theta^2}$$\n由于对于欠阻尼振荡系统，阻尼比 $\\zeta$ 是一个正量，我们取正平方根：\n$$\\zeta = \\sqrt{\\frac{(\\ln(\\rho))^2}{(\\ln(\\rho))^2 + \\theta^2}} = \\frac{|\\ln(\\rho)|}{\\sqrt{(\\ln(\\rho))^2 + \\theta^2}}$$\n已知 $0  \\rho  1$，我们有 $\\ln(\\rho)  0$，所以 $|\\ln(\\rho)| = -\\ln(\\rho)$。阻尼比的最终表达式是：\n$$\\zeta = \\frac{-\\ln(\\rho)}{\\sqrt{(\\ln(\\rho))^2 + \\theta^2}}$$\n至此，完成了问题的第一部分。\n\n对于第二部分，我们必须为给定的参数 $\\rho=0.8$，$\\theta=0.6$ 弧度，和 $T=0.05$ 秒计算 $\\zeta$ 的数值。计算 $\\zeta$ 不需要 $T$ 的值，只有计算 $\\omega_n$ 才需要。我们将给定的值代入推导出的公式：\n$$\\zeta = \\frac{-\\ln(0.8)}{\\sqrt{(\\ln(0.8))^2 + (0.6)^2}}$$\n我们计算各项的值：\n$$\\ln(0.8) \\approx -0.22314355$$\n$$(\\ln(0.8))^2 \\approx (-0.22314355)^2 \\approx 0.04979210$$\n$$(0.6)^2 = 0.36$$\n将这些值代入 $\\zeta$ 的表达式：\n$$\\zeta \\approx \\frac{-(-0.22314355)}{\\sqrt{0.04979210 + 0.36}} = \\frac{0.22314355}{\\sqrt{0.40979210}}$$\n$$\\zeta \\approx \\frac{0.22314355}{0.64015006} \\approx 0.3485799$$\n按照问题的要求，将结果四舍五入到 $4$ 位有效数字，我们得到：\n$$\\zeta \\approx 0.3486$$", "answer": "$$\\boxed{0.3486}$$", "id": "2698490"}, {"introduction": "频域分析为系统辨识提供了另一种强大的视角，尤其是在处理振动系统和电子滤波器时。通过分析系统对不同频率正弦输入的响应，我们可以揭示其内在的动态特性。本练习 [@problem_id:2698430] 将让您实践一种常用技术：将一个标准的二阶模型拟合到给定的频率响应幅值数据上，通过最小化误差来估计系统的 $\\zeta$ 和 $\\omega_n$。", "problem": "您的任务是根据谐振点附近的频率响应数据，辨识一个二阶线性系统的阻尼比和固有频率。请从基本原理出发：一个稳定的、因果的、线性时不变（LTI）的二阶单输入单输出系统的输入输出行为，可以在拉普拉斯域中通过一个有理传递函数进行建模。该传递函数的分母是一个实系数二次多项式，对应于一个齐次线性常系数常微分方程。对于角频率为 $\\omega$（单位：弧度/秒）的正弦稳态输入，其频率响应可通过将传递函数在 $s = j \\omega$ 处求值得到，其幅值是该复数值的欧几里得范数。在您的推理和实现中，请基于这些原理推导所有必需的表达式。\n\n您的模型是具有静态增益的规范严格真分二阶形式：\n- 传递函数由未知增益 $K  0$、未知阻尼比 $0  \\zeta  1$ 和未知固有频率 $\\omega_n  0$ 参数化。\n- 任务是通过最小化测量幅值 $|H(j \\omega)|$ 与模型幅值之间的平方误差和，将此模型拟合到频域测量数据，并获取 $\\zeta$ 和 $\\omega_n$ 的估计值。\n\n您必须在一个程序中实现以下任务：\n- 根据模型的基本原理，推导出以 $K$、$\\zeta$、$\\omega_n$ 和 $\\omega$ 表示的频率响应幅值 $|H(j \\omega)|$。\n- 针对测量幅值，构建一个最小二乘代价函数，当模型幅值与数据匹配时，该代价函数达到最小值。您必须妥善处理未知增益 $K$。对于每个候选的 $(\\zeta,\\omega_n)$，您可以使用标准的线性最小二乘原理，解析地确定最优的 $K$。\n- 将搜索范围限制在 $0  \\zeta  1$ 和 $\\omega_n  0$。\n- 实现一个数值稳定的求解器，返回使幅值误差最小化的估计值 $\\zeta$ 和 $\\omega_n$。\n\n单位与数值约定：\n- 角频率单位必须是弧度/秒。\n- 阻尼比 $\\zeta$ 是无量纲的。\n- 最终报告的 $\\omega_n$ 单位必须是弧度/秒。\n- 所有最终数值输出必须四舍五入到 $6$ 位小数。\n- 角度单位为弧度。\n\n测试套件与数据生成：\n- 使用以下三个测试用例。对于每个用例，给定真实的参数 $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}})$ 和一组有限的角频率 $\\{\\omega_i\\}$（单位：弧度/秒）。使用真实参数构建无噪声的测量幅值；即，对于每个 $\\omega_i$，计算真实系统的精确 $|H(j \\omega_i)|$，并将这些值作为待拟合的测量数据。除了生成数据外，不要在拟合过程中使用真实参数。\n- 用例 A:\n  - $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}}) = (\\,2.5\\,,\\,0.05\\,,\\,20.0\\,)$\n  - 频率 $\\{\\omega_i\\} = \\{\\,10.0,\\,14.0,\\,17.0,\\,19.0,\\,20.0,\\,21.0,\\,23.0,\\,26.0,\\,30.0\\,\\}$，单位：弧度/秒。\n- 用例 B:\n  - $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}}) = (\\,1.2\\,,\\,0.2\\,,\\,50.0\\,)$\n  - 频率 $\\{\\omega_i\\} = \\{\\,20.0,\\,35.0,\\,45.0,\\,49.0,\\,50.0,\\,51.0,\\,55.0,\\,60.0,\\,80.0\\,\\}$，单位：弧度/秒。\n- 用例 C:\n  - $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}}) = (\\,0.8\\,,\\,0.7\\,,\\,12.0\\,)$\n  - 频率 $\\{\\omega_i\\} = \\{\\,4.0,\\,6.0,\\,8.0,\\,10.0,\\,11.5,\\,12.0,\\,13.0,\\,16.0,\\,20.0\\,\\}$，单位：弧度/秒。\n\n要求的输出格式：\n- 您的程序应通过最小化给定频率集上的幅值最小二乘误差，为每个测试用例估计 $(\\widehat{\\zeta}, \\widehat{\\omega}_n)$。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。其中，每个用例的结果是一个双元素列表 $[\\,\\widehat{\\zeta},\\,\\widehat{\\omega}_n\\,]$，四舍五入到 $6$ 位小数，并按用例 A、B、C 的顺序排列。例如：\"[[0.123456,45.678901],[...],[...]]\"。", "solution": "此问题要求根据一个规范二阶线性时不变（LTI）系统在一组离散频率点上的频率响应幅值，辨识其阻尼比 $\\zeta$ 和固有频率 $\\omega_n$。解决方案必须从第一性原理推导得出。\n\n该系统由以下传递函数描述：\n$$\nH(s) = \\frac{K \\omega_n^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}\n$$\n其中，$K  0$ 是静态增益，$0  \\zeta  1$ 是阻尼比（表示这是一个欠阻尼系统），$\\omega_n  0$ 是无阻尼固有频率。\n\n**步骤 1：频率响应幅值**\n\n系统的频率响应 $H(j\\omega)$ 是通过将传递函数 $H(s)$ 在 $s = j\\omega$ 处求值得到的，其中 $\\omega$ 是角频率，单位为弧度/秒。\n$$\nH(j\\omega) = \\frac{K \\omega_n^2}{(j\\omega)^2 + 2\\zeta\\omega_n (j\\omega) + \\omega_n^2} = \\frac{K \\omega_n^2}{-\\omega^2 + j(2\\zeta\\omega_n \\omega) + \\omega_n^2}\n$$\n这可以通过对分母的实部和虚部进行分组来重新整理：\n$$\nH(j\\omega) = \\frac{K \\omega_n^2}{(\\omega_n^2 - \\omega^2) + j(2\\zeta\\omega_n \\omega)}\n$$\n频率响应的幅值 $|H(j\\omega)|$ 是此复数的欧几里得范数。由于 $K  0$ 且 $\\omega_n  0$，分子 $K \\omega_n^2$ 是一个正实数。\n$$\n|H(j\\omega)| = \\frac{|K \\omega_n^2|}{|(\\omega_n^2 - \\omega^2) + j(2\\zeta\\omega_n \\omega)|} = \\frac{K \\omega_n^2}{\\sqrt{(\\omega_n^2 - \\omega^2)^2 + (2\\zeta\\omega_n \\omega)^2}}\n$$\n该表达式给出了对于频率为 $\\omega$ 的正弦输入，系统输出相对于其输入的理论幅值。\n\n**步骤 2：最小二乘误差公式**\n\n给定一组在相应频率 $\\{\\omega_i\\}$ 上的 $N$ 个测量幅值 $\\{y_i\\}$。目标是找到参数 $(\\widehat{\\zeta}, \\widehat{\\omega}_n)$，使模型与这些数据点最佳拟合。我们采用最小二乘法，该方法最小化测量幅值与模型预测幅值之间的平方误差和（SSE）。代价函数 $J$ 为：\n$$\nJ(K, \\zeta, \\omega_n) = \\sum_{i=1}^{N} \\left( y_i - |H(j\\omega_i; K, \\zeta, \\omega_n)| \\right)^2\n$$\n幅值模型可以表示为关于未知增益 $K$ 的线性形式：\n$$\n|H(j\\omega_i; K, \\zeta, \\omega_n)| = K \\cdot M(\\omega_i; \\zeta, \\omega_n)\n$$\n其中 $M(\\omega; \\zeta, \\omega_n)$ 是幅值函数中不依赖于 $K$ 的部分：\n$$\nM(\\omega; \\zeta, \\omega_n) = \\frac{\\omega_n^2}{\\sqrt{(\\omega_n^2 - \\omega^2)^2 + (2\\zeta\\omega_n \\omega)^2}}\n$$\n令 $M_i = M(\\omega_i; \\zeta, \\omega_n)$，则代价函数变为：\n$$\nJ(K, \\zeta, \\omega_n) = \\sum_{i=1}^{N} (y_i - K \\cdot M_i)^2\n$$\n\n**步骤 3：解析地消去增益 $K$**\n\n对于任意给定的 $(\\zeta, \\omega_n)$ 对，基函数 $M_i$ 是固定的。此时代价函数 $J$ 是关于 $K$ 的一个简单二次函数。我们可以通过将其关于 $K$ 的偏导数设为零，来找到最小化此代价的最优增益 $K^*$。\n$$\n\\frac{\\partial J}{\\partial K} = \\sum_{i=1}^{N} 2(y_i - K M_i)(-M_i) = -2 \\left( \\sum_{i=1}^{N} y_i M_i - K \\sum_{i=1}^{N} M_i^2 \\right) = 0\n$$\n求解 $K$ 可得到作为 $\\zeta$ 和 $\\omega_n$ 函数的最优增益 $K^*$：\n$$\nK^*(\\zeta, \\omega_n) = \\frac{\\sum_{i=1}^{N} y_i M_i}{\\sum_{i=1}^{N} M_i^2}\n$$\n在向量表示法中，如果 $\\mathbf{y} = [y_1, \\dots, y_N]^T$ 且 $\\mathbf{M}(\\zeta, \\omega_n) = [M_1, \\dots, M_N]^T$，则 $K^* = \\frac{\\mathbf{y}^T \\mathbf{M}}{\\mathbf{M}^T \\mathbf{M}}$。\n\n**步骤 4：简化的优化问题**\n\n通过将 $K^*(\\zeta, \\omega_n)$ 代回代价函数，我们消去了 $K$ 并得到了一个只依赖于 $\\zeta$ 和 $\\omega_n$ 的简化代价函数 $J_{\\text{reduced}}$：\n$$\nJ_{\\text{reduced}}(\\zeta, \\omega_n) = \\sum_{i=1}^{N} \\left( y_i - K^*(\\zeta, \\omega_n) \\cdot M_i(\\zeta, \\omega_n) \\right)^2\n$$\n我们现在的任务是解决以下二维非线性优化问题：\n$$\n(\\widehat{\\zeta}, \\widehat{\\omega}_n) = \\arg\\min_{\\zeta, \\omega_n} J_{\\text{reduced}}(\\zeta, \\omega_n)\n$$\n约束条件为 $0  \\zeta  1$ 和 $\\omega_n  0$。\n\n**步骤 5：数值求解策略**\n\n此优化问题通常没有闭式解，必须通过数值方法求解。我们将使用一种拟牛顿算法，特别是 L-BFGS-B，它非常适合处理带有箱型约束的问题。\n\n每个测试用例的实现步骤如下：\n1.  **数据生成**：使用真实参数 $(K_{\\text{true}}, \\zeta_{\\text{true}}, \\omega_{n,\\text{true}})$ 和给定的频率 $\\{\\omega_i\\}$ 构建“测量”的幅值数据向量 $\\mathbf{y}$。由于数据是无噪声的，代价函数的最小值预计在真实参数值处为 $0$。\n2.  **目标函数**：定义一个 Python 函数，对于给定的参数向量 $[\\zeta, \\omega_n]$、频率向量 $\\mathbf{\\omega}$ 和数据向量 $\\mathbf{y}$，计算 $J_{\\text{reduced}}(\\zeta, \\omega_n)$。\n3.  **初始猜测**：一个有效的初始猜测 $(\\zeta_0, \\omega_{n,0})$ 对优化器的收敛至关重要。欠阻尼系统的谐振峰值出现在 $\\omega_n$ 附近。因此，一个合理的 $\\omega_n$ 猜测值是测量幅值达到最大值时的频率。对于表现出谐振峰值的系统，一个通用的 $\\zeta$ 初始值（如 $0.1$）是合适的。\n4.  **优化**：使用 `scipy.optimize.minimize` 和 'L-BFGS-B' 方法，提供目标函数、初始猜测以及 $\\zeta$ 和 $\\omega_n$ 的边界（例如，$\\zeta \\in [10^{-9}, 1-10^{-9}]$ 和 $\\omega_n \\in [10^{-9}, \\infty)$ 以严格执行问题约束）。\n5.  **结果提取**：优化器将返回使代价函数最小化的估计参数 $(\\widehat{\\zeta}, \\widehat{\\omega}_n)$。这些就是期望的结果。\n该过程从基本原理系统地推导出解决方案，并使用标准的数值优化技术加以实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Identifies the damping ratio (zeta) and natural frequency (omega_n)\n    of a second-order LTI system from frequency response magnitude data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"true_params\": (2.5, 0.05, 20.0),\n            \"freqs\": np.array([10.0, 14.0, 17.0, 19.0, 20.0, 21.0, 23.0, 26.0, 30.0])\n        },\n        {\n            \"true_params\": (1.2, 0.2, 50.0),\n            \"freqs\": np.array([20.0, 35.0, 45.0, 49.0, 50.0, 51.0, 55.0, 60.0, 80.0])\n        },\n        {\n            \"true_params\": (0.8, 0.7, 12.0),\n            \"freqs\": np.array([4.0, 6.0, 8.0, 10.0, 11.5, 12.0, 13.0, 16.0, 20.0])\n        }\n    ]\n\n    results = []\n\n    def calculate_magnitude(freqs, K, zeta, omega_n):\n        \"\"\"\n        Calculates the magnitude of the second-order system's frequency response.\n        |H(jw)| = K * omega_n^2 / sqrt((omega_n^2 - w^2)^2 + (2*zeta*omega_n*w)^2)\n        \"\"\"\n        omega_sq = freqs**2\n        omega_n_sq = omega_n**2\n        \n        # Ensure denominator is not zero\n        denom_sq_term1 = (omega_n_sq - omega_sq)**2\n        denom_sq_term2 = (2 * zeta * omega_n * freqs)**2\n        \n        magnitude = (K * omega_n_sq) / np.sqrt(denom_sq_term1 + denom_sq_term2)\n        return magnitude\n\n    for case in test_cases:\n        K_true, zeta_true, wn_true = case[\"true_params\"]\n        freqs = case[\"freqs\"]\n\n        # 1. Generate noiseless measurement data\n        measured_magnitudes = calculate_magnitude(freqs, K_true, zeta_true, wn_true)\n\n        # 2. Define the objective function (reduced sum of squared errors)\n        def objective_function(params, freqs_data, magnitudes_data):\n            \"\"\"\n            Calculates the sum of squared errors for a given (zeta, omega_n).\n            The optimal gain K is calculated analytically and substituted.\n            \"\"\"\n            zeta, omega_n = params\n            \n            # The basis function M(w; zeta, omega_n)\n            # M = omega_n^2 / sqrt((omega_n^2 - w^2)^2 + (2*zeta*omega_n*w)^2)\n            omega_sq = freqs_data**2\n            omega_n_sq = omega_n**2\n            denom_sq_term1 = (omega_n_sq - omega_sq)**2\n            denom_sq_term2 = (2 * zeta * omega_n * freqs_data)**2\n            # Add a small epsilon to prevent division by zero in sqrt if both terms are zero\n            M = omega_n_sq / np.sqrt(denom_sq_term1 + denom_sq_term2 + 1e-30)\n\n            # Analytically determine the optimal gain K*\n            # K* = (y^T M) / (M^T M)\n            K_opt = np.dot(magnitudes_data, M) / np.dot(M, M)\n\n            # Calculate the model predictions with the optimal gain\n            predicted_magnitudes = K_opt * M\n\n            # Calculate sum of squared errors\n            sse = np.sum((magnitudes_data - predicted_magnitudes)**2)\n            \n            return sse\n\n        # 3. Set up initial guess and bounds for optimization\n        # Initial guess for omega_n: frequency of maximum response\n        wn_initial_guess = freqs[np.argmax(measured_magnitudes)]\n        # Initial guess for zeta: a generic value for an underdamped system\n        zeta_initial_guess = 0.1\n        \n        initial_guess = [zeta_initial_guess, wn_initial_guess]\n\n        # Bounds: 0  zeta  1 and omega_n > 0\n        bounds = [(1e-9, 1.0 - 1e-9), (1e-9, None)]\n\n        # 4. Perform optimization\n        res = minimize(\n            objective_function,\n            initial_guess,\n            args=(freqs, measured_magnitudes),\n            method='L-BFGS-B',\n            bounds=bounds,\n            options={'ftol': 1e-12, 'gtol': 1e-12} # Tight tolerances for precision\n        )\n\n        # 5. Store the estimated parameters\n        estimated_zeta, estimated_wn = res.x\n        results.append([estimated_zeta, estimated_wn])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{zeta:.6f},{wn:.6f}]\" for zeta, wn in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2698430"}, {"introduction": "虽然粘性阻尼模型在数学上非常方便，但许多真实世界的系统表现出更为复杂的非线性阻尼行为。这个思想实验 [@problem_id:2698443] 探讨了一种包含恒定大小的干摩擦（库仑摩擦）的振荡器，这是一种常见的非线性现象。通过分析其能量耗散机制，您将发现其振幅衰减包络与粘性阻尼有显著不同，并揭示了基于对数衰减率来估计“等效”阻尼比 $\\zeta$ 时所固有的偏见和局限性。", "problem": "一个单自由度 (SDOF) 的质量-弹簧系统遵循牛顿第二定律，具有线性恢复力和大小恒定的干（库仑）摩擦力。其自由振动下的运动方程为\n$$\nm\\,\\ddot{x}(t) + k\\,x(t) + F_{c}\\,\\mathrm{sgn}\\!\\big(\\dot{x}(t)\\big) \\;=\\; 0,\n$$\n其中 $m$ 是质量，$k$ 是刚度，$F_{c}  0$ 是库仑摩擦水平，$\\mathrm{sgn}(\\cdot)$ 是符号函数。粘性阻尼可以忽略，即 $c = 0$。系统在 $t = 0$ 时从静止状态释放，初始条件为 $x(0) = A_{0}  0$ 和 $\\dot{x}(0) = 0$。假设 $A_{0}$ 足够大，以至于在多个周期内 $F_{c} \\ll k\\,A$ 成立，其中 $A$ 表示瞬时峰值振幅。考虑一个衰减测试，其中测量连续的峰值 $A_{n}$。\n\n目标是确定相对于纯粘性模型，库仑摩擦如何改变衰减包络线，以及这如何影响基于对数衰减率的阻尼比估计。仅使用第一性原理和核心定义作为出发点：\n\n- 牛顿第二定律 $F = m\\,\\ddot{x}$。\n- 包含非保守力做功的能量守恒：机械能的变化等于非保守力所做的功。\n- 无阻尼固有频率的定义 $\\omega_{n} = \\sqrt{k/m}$。\n- 对数衰减率的核心定义为 $\\delta = \\ln\\!\\big(A_{n}/A_{n+1}\\big)$，针对相隔一个周期的峰值。\n\n任务：\n\n- 从连续转折点（其中 $\\dot{x} = 0$）之间的能量平衡出发，推导由库仑摩擦引起的 $A_{n+1}$ 对 $A_{n}$ 的函数依赖关系。用此关系来描述振幅包络线相对于峰值指数的定性形状，并将其与纯粘性阻尼产生的包络线进行对比。\n- 使用上述结果，用瞬时振幅 $A$ 及参数 $k$ 和 $F_{c}$ 表示库仑摩擦的单周期对数衰减率 $\\delta$，并确定在 $F_{c} \\ll k\\,A$ 时它对 $A$ 的依赖性。\n- 通过将库仑摩擦每个周期耗散的能量与相同振幅下假设的粘性阻尼器耗散的能量相等，推导出一个依赖于振幅的“能量等效”粘性阻尼比 $\\zeta_{\\mathrm{eq}}(A)$。\n- 使用对数衰减率的核心定义以及从 $\\delta$ 到粘性阻尼比 $\\zeta$ 的微阻尼映射（不要先验地假设 $\\zeta$ 的任何特定值），讨论在库仑摩擦下基于单周期对数衰减率的“朴素”粘性估计值 $\\hat{\\zeta}(A)$ 相对于 $\\zeta_{\\mathrm{eq}}(A)$ 是无偏还是有偏的，并指出偏差如何随振幅变化。\n- 假设 $m = 1$ 千克，$k = 1000$ 牛顿/米，$F_{c} = 1$ 牛顿，并考虑在 $A = 0.100$ 米附近的一个峰值。计算两个正峰值之间的单周期对数衰减率 $\\delta$、相应的朴素粘性估计值 $\\hat{\\zeta}$ 和能量等效值 $\\zeta_{\\mathrm{eq}}(A)$；并进行数值比较。\n\n下列哪个陈述是正确的？\n\nA. 在纯库仑摩擦下，峰值振幅与周期指数的衰减包络线是分段线性的，每个周期的衰减量是与振幅无关的常数；相比之下，纯粘性模型产生指数包络线。将单周期对数衰减率映射到粘性阻尼比会产生一个依赖于振幅的估计值，该估计值随振幅减小而增大，并且在一阶近似 $F_{c}/(kA)$ 下，与能量等效粘性阻尼比相匹配。\n\nB. 在纯库仑摩擦下，衰减包络线是指数型的，具有恒定的对数衰减率，因此基于对数衰减率的粘性阻尼比估计是无偏且与振幅无关的。\n\nC. 在纯库仑摩擦下，从连续正峰值计算的单周期对数衰减率随着振幅的减小而单调减小；因此，对后期数据进行指数拟合会低估阻尼。\n\nD. 只要在观测范围内 $F_{c} \\ll kA$，振荡周期就近似保持为具有固有频率 $\\omega_{n} = \\sqrt{k/m}$ 的无阻尼振荡器的周期；因此，库仑摩擦下基于对数衰减率的阻尼估计偏差的主要来源是非指数包络线，而不是周期的显著变化。", "solution": "问题陈述需要经过验证。\n\n**步骤1：提取已知条件**\n- 运动方程：$m\\,\\ddot{x}(t) + k\\,x(t) + F_{c}\\,\\mathrm{sgn}\\!\\big(\\dot{x}(t)\\big) \\;=\\; 0$\n- 系统参数：质量 $m$，刚度 $k$，库仑摩擦水平 $F_{c}  0$。\n- 阻尼：粘性阻尼可以忽略，$c = 0$。\n- 初始条件：$x(0) = A_{0}  0$，$\\dot{x}(0) = 0$。\n- 假设：$A_{0}$ 足够大，以至于在多个周期内 $F_{c} \\ll kA$ 成立。\n- 核心原理/定义：\n    - 牛顿第二定律：$F = m\\,\\ddot{x}$。\n    - 功能定理：$\\Delta E_{\\text{mech}} = W_{\\text{nc}}$。\n    - 无阻尼固有频率：$\\omega_{n} = \\sqrt{k/m}$。\n    - 对数衰减率：$\\delta = \\ln\\!\\big(A_{n}/A_{n+1}\\big)$，针对相隔一个完整周期的峰值。\n- 特定情况的数值：$m = 1$ kg，$k = 1000$ N/m，$F_{c} = 1$ N，峰值振幅 $A = 0.100$ m。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该模型是带干摩擦的振荡器的标准表示，是经典力学和振动理论中的一个基本问题。所有引用的原理都是正确的。\n- **良态问题**：该问题是一个二阶非线性常微分方程的良态初值问题。任务定义清晰且可解。\n- **客观性**：语言精确且无偏见。\n- **缺陷检查**：问题陈述没有科学不健全、信息缺失、矛盾或任何其他列出的缺陷。这是一个完整而严谨的问题陈述。\n\n**步骤3：结论与行动**\n问题是有效的。我将进行完整的推导和分析。\n\n**分析**\n\n我们将解决问题陈述中提出的任务。\n\n**任务1：振幅衰减和包络线形状**\n\n我们分析一个半周期内的能量平衡，从 $x = A_{n}$ 处的正峰值（此时 $\\dot{x}=0$）到随后的 $x = -A_{n+1/2}$ 处的负峰值（此时 $\\dot{x}=0$）。\n在位移为 $x$、速度为 $\\dot{x}$ 的点，机械能为 $E = \\frac{1}{2}m\\dot{x}^2 + \\frac{1}{2}kx^2$。在峰值处，动能为零。\n在 $x=A_n$ 处的初始能量：$E_{n} = \\frac{1}{2}kA_{n}^2$。\n在 $x=-A_{n+1/2}$ 处的最终能量：$E_{n+1/2} = \\frac{1}{2}k(-A_{n+1/2})^2 = \\frac{1}{2}kA_{n+1/2}^2$。\n\n在这个半周期（$\\dot{x}  0$）内，非保守的库仑摩擦力 $F_f = -F_c\\,\\mathrm{sgn}(\\dot{x})$ 所做的功是：\n$$W_{nc} = \\int_{A_n}^{-A_{n+1/2}} F_f dx = \\int_{A_n}^{-A_{n+1/2}} -F_c\\,\\mathrm{sgn}(\\dot{x}) dx$$\n由于 $\\dot{x}  0$，所以 $\\mathrm{sgn}(\\dot{x}) = -1$。\n$$W_{nc} = \\int_{A_n}^{-A_{n+1/2}} -F_c(-1) dx = F_c \\int_{A_n}^{-A_{n+1/2}} dx = F_c(-A_{n+1/2} - A_n) = -F_c(A_n + A_{n+1/2})$$\n根据功能定理，$\\Delta E = E_{n+1/2} - E_n = W_{nc}$：\n$$\\frac{1}{2}kA_{n+1/2}^2 - \\frac{1}{2}kA_n^2 = -F_c(A_n + A_{n+1/2})$$\n$$\\frac{1}{2}k(A_{n+1/2} - A_n)(A_{n+1/2} + A_n) = -F_c(A_n + A_{n+1/2})$$\n假设运动发生，则 $A_n + A_{n+1/2}  0$，所以我们可以除以这一项：\n$$\\frac{1}{2}k(A_{n+1/2} - A_n) = -F_c \\implies A_{n+1/2} = A_n - \\frac{2F_c}{k}$$\n类似地，在从 $x = -A_{n+1/2}$ 到 $x = A_{n+1}$ 的下一个半周期中，速度为正（$\\dot{x}0$），摩擦力做的功为 $W_{nc} = -F_c(A_{n+1/2} + A_{n+1})$。能量平衡得出 $A_{n+1} = A_{n+1/2} - \\frac{2F_c}{k}$。\n合并一个完整周期（两个连续正峰值之间）的结果：\n$$A_{n+1} = \\left(A_n - \\frac{2F_c}{k}\\right) - \\frac{2F_c}{k} = A_n - \\frac{4F_c}{k}$$\n每个周期的振幅减少量 $\\Delta A = A_n - A_{n+1} = \\frac{4F_c}{k}$ 是一个常数。这意味着峰值振幅 $A_n$ 形成一个等差数列。峰值振幅 $A_n$ 与周期指数 $n$ 的关系图上的点位于一条直线上：$A_n = A_0 - n \\frac{4F_c}{k}$。当达到一个峰值振幅 $A_N$，使得恢复力 $kA_N$ 不足以克服静摩擦力时，即 $kA_N \\le F_c$，运动停止。因此，$A_n$ 对 $n$ 的图像由一个线性段和一个常数（或零）段组成，这是一个分段线性函数。\n\n相比之下，对于纯粘性阻尼（$m\\ddot{x} + c\\dot{x} + kx = 0$），解表明连续峰值的比率是恒定的，$A_{n+1}/A_n = e^{-\\delta}$，其中 $\\delta$ 是恒定的对数衰减率。这导致了一个指数衰减包络线，$A_n = A_0 e^{-n\\delta}$。\n\n**任务2：库仑摩擦的对数衰减率**\n\n使用定义 $\\delta = \\ln(A_n/A_{n+1})$ 和任务1的结果：\n$$\\delta_n = \\ln\\left(\\frac{A_n}{A_{n+1}}\\right) = \\ln\\left(\\frac{A_n}{A_n - 4F_c/k}\\right) = -\\ln\\left(1 - \\frac{4F_c}{kA_n}\\right)$$\n这个对数衰减率 $\\delta_n$ 依赖于振幅 $A_n$。我们用 $\\delta(A)$ 表示通用峰值振幅 $A$ 的情况。随着 $A$ 减小，$4F_c/(kA)$ 项增大，并且由于 $-\\ln(1-z)$ 在 $z \\in [0, 1)$ 上是增函数，所以对数衰减率 $\\delta(A)$ 随着振幅的减小而增大。\n对于 $F_c \\ll kA$ 的情况，我们可以使用泰勒展开 $-\\ln(1-z) \\approx z + z^2/2 + \\dots$：\n$$\\delta(A) \\approx \\frac{4F_c}{kA}$$\n在一阶近似下，对数衰减率与振幅成反比。\n\n**任务3：能量等效粘性阻尼比 $\\zeta_{\\mathrm{eq}}(A)$**\n\n我们将库仑摩擦每个周期耗散的能量与一个假设的粘性阻尼器耗散的能量相等。\n库仑摩擦在一个周期内耗散的能量是 $\\Delta E_{\\text{Coulomb}}$。假设 $F_c \\ll kA$，运动近似为正弦运动，$x(t) \\approx A\\cos(\\omega_n t)$，一个周期内走过的总距离是 $4A$。大小恒定的摩擦力 $F_c$ 所做的功是：\n$$\\Delta E_{\\text{Coulomb}} = F_c \\times (\\text{总距离}) = 4F_c A$$\n具有阻尼系数 $c_{\\text{eq}}$ 的粘性阻尼器每个周期耗散的能量与阻尼比 $\\zeta_{\\mathrm{eq}} = c_{\\text{eq}}/(2m\\omega_n)$ 的关系如下：\n$$\\Delta E_{\\text{viscous}} = \\pi c_{\\text{eq}} \\omega_n A^2 = \\pi (2m\\omega_n \\zeta_{\\mathrm{eq}}) \\omega_n A^2 = 2\\pi m\\omega_n^2 \\zeta_{\\mathrm{eq}} A^2$$\n使用 $\\omega_n^2 = k/m$，我们得到：\n$$\\Delta E_{\\text{viscous}} = 2\\pi k \\zeta_{\\mathrm{eq}} A^2$$\n令两个耗散表达式相等，$\\Delta E_{\\text{Coulomb}} = \\Delta E_{\\text{viscous}}$：\n$$4F_c A = 2\\pi k \\zeta_{\\mathrm{eq}}(A) A^2$$\n求解等效粘性阻尼比 $\\zeta_{\\mathrm{eq}}(A)$：\n$$\\zeta_{\\mathrm{eq}}(A) = \\frac{4F_c A}{2\\pi k A^2} = \\frac{2F_c}{\\pi k A}$$\n这个等效阻尼比与振幅 $A$ 成反比。\n\n**任务4：朴素粘性估计值 $\\hat{\\zeta}(A)$ 的偏差**\n\n朴素估计值 $\\hat{\\zeta}(A)$ 是通过将微粘性阻尼的标准公式 $\\delta \\approx 2\\pi\\zeta$ 应用于测得的对数衰减率而得到的：\n$$\\hat{\\zeta}(A) = \\frac{\\delta(A)}{2\\pi} = \\frac{-\\ln(1 - 4F_c/(kA))}{2\\pi}$$\n让我们对小的 $z = 4F_c/(kA)$ 进行展开，使用 $-\\ln(1-z) = z + z^2/2 + O(z^3)$：\n$$\\hat{\\zeta}(A) = \\frac{1}{2\\pi} \\left[ \\left(\\frac{4F_c}{kA}\\right) + \\frac{1}{2}\\left(\\frac{4F_c}{kA}\\right)^2 + \\dots \\right] = \\frac{2F_c}{\\pi k A} + \\frac{4F_c^2}{\\pi k^2 A^2} + \\dots$$\n将此与任务3中的能量等效阻尼比 $\\zeta_{\\mathrm{eq}}(A) = \\frac{2F_c}{\\pi k A}$ 进行比较：\n$$\\hat{\\zeta}(A) = \\zeta_{\\mathrm{eq}}(A) + \\frac{4F_c^2}{\\pi k^2 A^2} + \\dots$$\n朴素估计值 $\\hat{\\zeta}(A)$ 相对于能量等效比 $\\zeta_{\\mathrm{eq}}(A)$ 是有偏的。偏差项 $\\hat{\\zeta}(A) - \\zeta_{\\mathrm{eq}}(A) \\approx \\frac{4F_c^2}{\\pi k^2 A^2}$ 是正的，意味着估计值偏高。偏差与 $A^2$ 成反比，因此随着振幅减小而增大。在一阶近似 $F_c/(kA)$ 下，$\\hat{\\zeta}(A)$ 与 $\\zeta_{\\mathrm{eq}}(A)$ 相匹配。\n\n**振荡周期分析**\n运动方程是分段线性的。\n- 对于 $\\dot{x}  0$：$m\\ddot{x} + kx = -F_c \\implies m\\ddot{x} + k(x+F_c/k) = 0$。这描述了围绕平衡点 $x_{eq} = -F_c/k$ 的简谐运动，角频率为 $\\omega_n=\\sqrt{k/m}$。\n- 对于 $\\dot{x}  0$：$m\\ddot{x} + kx = F_c \\implies m\\ddot{x} + k(x-F_c/k) = 0$。这描述了围绕平衡点 $x_{eq} = +F_c/k$ 的简谐运动，角频率同样为 $\\omega_n$。\n一个完整的运动周期由两个半周期组成，每个半周期对应于从一个峰值到下一个峰值的过程。每个半周期的时长恰好是固有周期的一半，即 $\\pi/\\omega_n$。因此，振荡周期恰好是 $T = 2\\pi/\\omega_n$，即无阻尼固有周期。只要运动持续，这个结果就是精确的，不依赖于任何小振幅假设。\n\n**选项评估**\n\n**A. 在纯库仑摩擦下，峰值振幅与周期指数的衰减包络线是分段线性的，每个周期的衰减量是与振幅无关的常数；相比之下，纯粘性模型产生指数包络线。将单周期对数衰减率映射到粘性阻尼比会产生一个依赖于振幅的估计值，该估计值随振幅减小而增大，并且在一阶近似 $F_{c}/(kA)$ 下，与能量等效粘性阻尼比相匹配。**\n- 关系式 $A_n = A_0 - n(4F_c/k)$ 表明峰值振幅随周期指数 $n$ 线性减小。当 $kA_n \\le F_c$ 时运动停止。此行为使得 $A_n$ 对 $n$ 的图像成为一个分段线性函数（一条线段后跟一个常数值）。每个周期的算术衰减量 $\\Delta A = 4F_c/k$ 是常数且与振幅无关。这是正确的。\n- 粘性模型产生指数包络线 $A_n = A_0 e^{-n\\delta}$。这是正确的。\n- 对数衰减率 $\\delta(A) = -\\ln(1 - 4F_c/kA)$ 和估计值 $\\hat{\\zeta}(A) = \\delta(A)/(2\\pi)$ 都随着振幅 $A$ 的减小而增大。这是正确的。\n- 我们已经证明，在一阶近似下，$\\hat{\\zeta}(A) \\approx \\frac{2F_c}{\\pi kA}$，这等于 $\\zeta_{\\mathrm{eq}}(A)$。这是正确的。\n该陈述的所有部分都是正确的。\n结论：**正确**。\n\n**B. 在纯库仑摩擦下，衰减包络线是指数型的，具有恒定的对数衰减率，因此基于对数衰减率的粘性阻尼比估计是无偏且与振幅无关的。**\n- 衰减包络线是线性的，不是指数的。对数衰减率是依赖于振幅的，不是恒定的。该陈述的第一部分是错误的。\n- 因此，等效粘性阻尼的估计值是依赖于振幅的。\n结论：**不正确**。\n\n**C. 在纯库仑摩擦下，从连续正峰值计算的单周期对数衰减率随着振幅的减小而单调减小；因此，对后期数据进行指数拟合会低估阻尼。**\n- 我们推导出 $\\delta(A) = -\\ln(1 - 4F_c/kA)$。这个函数随着振幅 $A$ 的减小而单调*增大*。该陈述在事实上是错误的。\n结论：**不正确**。\n\n**D. 只要在观测范围内 $F_{c} \\ll kA$，振荡周期就近似保持为具有固有频率 $\\omega_{n} = \\sqrt{k/m}$ 的无阻尼振荡器的周期；因此，库仑摩擦下基于对数衰减率的阻尼估计偏差的主要来源是非指数包络线，而不是周期的显著变化。**\n- 我们证明了振荡周期*恰好*是无阻尼固有周期 $T_n = 2\\pi/\\omega_n$。因此，陈述其“近似”为此值是正确的，尽管这是一种保守的说法。\n- 朴素阻尼估计值 $\\hat{\\zeta}(A)$ 中的“偏差”（指振幅依赖性以及与简单常数的偏离）源于对数衰减率 $\\delta(A)$ 不是常数。这是振幅线性（非指数）衰减的直接结果。由于周期完全没有变化，整个效应确实可以归因于非指数包络线。这是一个正确的物理结论。\n结论：**正确**。\n\n陈述 A 和 D 都是正确的。它们描述了系统行为的不同但同样有效的方面。陈述 A 提供了定量分析的全面总结，而陈述 D 提供了关键的物理洞见，解释了当使用为粘性阻尼设计的工具进行分析时，这种特征行为的起源。", "answer": "$$\\boxed{AD}$$", "id": "2698443"}]}