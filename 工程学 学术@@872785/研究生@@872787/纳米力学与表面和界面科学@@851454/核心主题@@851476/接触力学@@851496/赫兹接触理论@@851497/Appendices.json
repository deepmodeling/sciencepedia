{"hands_on_practices": [{"introduction": "赫兹接触理论最重要的应用之一是通过压痕实验来表征材料的力学性能。这个练习将指导你分析载荷-压深曲线，这是从纳米压痕等技术中获得的核心数据。通过利用赫兹理论预测的载荷 $P$ 与压痕深度 $\\delta$ 之间的 $P \\propto \\delta^{3/2}$ 标度律，你将学习如何从实验数据中提取关键的材料参数——有效模量 $E^*$ ([@problem_id:2892005])。", "problem": "一个有效半径为 $R^{*}$ 的刚性球形压头在无摩擦、无粘附的条件下压入一个各向同性、均匀的线弹性半空间。测得的载荷-压深数据 $\\{(P_{i},\\delta_{i})\\}$ 在以10为底的对数尺度上通过线性回归进行分析，其中 $P$ 以牛顿为单位，$\\delta$ 以米为单位，得到\n$$\n\\log_{10} P = \\hat{\\alpha} + \\hat{\\beta}\\,\\log_{10} \\delta,\n$$\n其中 $\\hat{\\alpha}=9.900$，$\\hat{\\beta}=1.497$，斜率的估计标准误差为 $s_{\\hat{\\beta}}=0.015$。已知有效半径为 $R^{*}=3\\,\\mathrm{mm}$。\n\n从线弹性中轴对称法向接触的 Hertzian 理论的基本论述出发，并仅使用经典弹性力学中经过充分检验的结果（无经验捷径），推导 $P$ 和 $\\delta$ 之间的预期标度关系，用它来解释回归斜率，然后根据截距计算有效平面应变模量 $E^{*}$。明确陈述并论证你从经典弹性力学和量纲一致性中引用的任何中间关系。\n\n验证测得的 $\\hat{\\beta}$ 与 Hertzian 预测一致，然后根据 $\\hat{\\alpha}$ 和 $R^{*}$ 计算 $E^{*}$。将 $E^{*}$ 的最终数值答案四舍五入到三位有效数字，并以吉帕斯卡（GPa）为单位表示。最终答案必须是一个数字。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n逐字提取已知条件：\n- 一个有效半径为 $R^{*}$ 的刚性球形压头。\n- 基底是一个各向同性、均匀的线弹性半空间。\n- 接触是无摩擦且无粘附的。\n- 对载荷-压深数据 $\\{(P_{i},\\delta_{i})\\}$ 进行分析。\n- $P$ 的单位是牛顿，$\\delta$ 的单位是米。\n- 回归模型为 $\\log_{10} P = \\hat{\\alpha} + \\hat{\\beta}\\,\\log_{10} \\delta$。\n- 估计的截距为 $\\hat{\\alpha}=9.900$。\n- 估计的斜率为 $\\hat{\\beta}=1.497$。\n- 斜率的估计标准误差为 $s_{\\hat{\\beta}}=0.015$。\n- 有效半径为 $R^{*}=3\\,\\mathrm{mm}$。\n\n验证结论：\n该问题具有科学依据，植根于经典的 Hertzian 弹性接触理论，这是连续介质力学的一个基本组成部分。这是一个适定问题，提供了充分且一致的信息来确定所要求的材料参数。语言客观而精确。对于金属或陶瓷材料的微米或宏观压痕实验，其数值是物理上现实的。该问题不违反任何无效性标准。因此，该问题被认为是有效的，并将推导求解。\n\n核心任务是建立施加载荷 $P$ 与压入深度 $\\delta$ 之间的关系。这种关系是 Hertzian 接触力学的核心。对于指定的构型——球体压入平坦半空间——在半径为 $a$ 的圆形接触区域上的压力分布 $p(r)$ 是椭球形的：\n$$\np(r) = p_0 \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2}\n$$\n其中 $p_0$ 是接触中心（$r=0$）处的最大压力。总施加载荷 $P$ 是该压力分布在接触面积上的积分：\n$$\nP = \\int_{0}^{a} p(r) \\, 2\\pi r \\, dr = 2\\pi p_0 \\int_{0}^{a} r \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2} dr = \\frac{2}{3} \\pi a^2 p_0\n$$\n经典弹性理论为此接触问题提供了另外两个关键关系。首先，接触半径 $a$ 通过小变形的几何约束与压入深度 $\\delta$ 和有效曲率半径 $R^*$ 相关联：\n$$\n\\delta = \\frac{a^2}{R^*} \\quad \\implies \\quad a = \\sqrt{\\delta R^*}\n$$\n其次，接触半径 $a$ 通过有效模量 $E^*$ 与载荷 $P$ 和材料属性相关联：\n$$\na^3 = \\frac{3PR^*}{4E^*}\n$$\n该关系是在 Hertzian 压力分布下，对 Boussinesq 解的表面位移进行积分的直接结果。有效模量 $E^*$ 定义为\n$$\n\\frac{1}{E^*} = \\frac{1-\\nu_1^2}{E_1} + \\frac{1-\\nu_2^2}{E_2}\n$$\n其中 ($E_1, \\nu_1$) 是压头的属性，而 ($E_2, \\nu_2$) 是半空间的属性。由于压头是刚性的，其杨氏模量 $E_1 \\to \\infty$，这使得第一项 $\\frac{1-\\nu_1^2}{E_1} \\to 0$。因此，$E^*$ 简化为基底的平面应变模量，$E^* = \\frac{E_2}{1-\\nu_2^2}$。问题要求我们计算这个量 $E^*$。\n\n为了推导 $P$ 和 $\\delta$ 之间的关系，我们组合已建立的方程。我们将几何关系 $a = \\sqrt{\\delta R^*}$ 代入载荷-半径关系 $a^3 = \\frac{3PR^*}{4E^*}$：\n$$\n(\\sqrt{\\delta R^*})^3 = \\frac{3PR^*}{4E^*}\n$$\n$$\n(\\delta R^*)^{3/2} = \\frac{3PR^*}{4E^*}\n$$\n解出载荷 $P$：\n$$\nP = \\frac{4E^*}{3R^*} (\\delta R^*)^{3/2} = \\frac{4E^*}{3R^*} \\delta^{3/2} (R^*)^{3/2}\n$$\n这简化为 Hertzian 载荷-压深方程：\n$$\nP = \\frac{4}{3} E^* \\sqrt{R^*} \\delta^{3/2}\n$$\n该方程建立了载荷和压深之间的理论标度律。\n\n我们现在在所提供的对数回归模型 $\\log_{10} P = \\hat{\\alpha} + \\hat{\\beta}\\,\\log_{10} \\delta$ 的背景下分析此结果。对理论 Hertzian 方程取以10为底的对数，得到：\n$$\n\\log_{10} P = \\log_{10}\\left( \\frac{4}{3} E^* \\sqrt{R^*} \\delta^{3/2} \\right) = \\log_{10}\\left( \\frac{4 E^* \\sqrt{R^*}}{3} \\right) + \\log_{10}(\\delta^{3/2})\n$$\n$$\n\\log_{10} P = \\log_{10}\\left( \\frac{4 E^* \\sqrt{R^*}}{3} \\right) + \\frac{3}{2} \\log_{10} \\delta\n$$\n通过将此理论形式与经验回归模型进行比较，我们可以做出以下识别：\n理论斜率为 $\\beta = \\frac{3}{2} = 1.5$。\n理论截距为 $\\alpha = \\log_{10}\\left( \\frac{4 E^* \\sqrt{R^*}}{3} \\right)$。\n\n首先，我们验证测量斜率 $\\hat{\\beta} = 1.497$ 的一致性。给定的标准误差为 $s_{\\hat{\\beta}} = 0.015$。一个简单的检查是观察理论值和测量值之间的差异（以标准误差表示）：$|\\hat{\\beta} - \\beta| = |1.497 - 1.5| = 0.003$。这个偏差仅为 $0.003 / 0.015 = 0.2$ 个标准误差，表明符合得非常好。测量斜率在统计上与理论 Hertzian 指数 $1.5$ 没有区别。\n\n接下来，我们使用截距来计算 $E^*$。测得的截距为 $\\hat{\\alpha} = 9.900$。\n$$\n\\hat{\\alpha} = \\log_{10}\\left( \\frac{4 E^* \\sqrt{R^*}}{3} \\right)\n$$\n我们求解 $E^*$。对两边取以10为底的指数：\n$$\n10^{\\hat{\\alpha}} = \\frac{4 E^* \\sqrt{R^*}}{3}\n$$\n$$\nE^* = \\frac{3 \\times 10^{\\hat{\\alpha}}}{4 \\sqrt{R^*}}\n$$\n问题陈述所有量均采用国际单位制（SI）。载荷 $P$ 的单位是牛顿，深度 $\\delta$ 的单位是米。因此，$E^*$ 将以帕斯卡（Pa）为单位计算。我们必须使用以米为单位的 $R^*$。\n给定 $R^* = 3\\,\\mathrm{mm} = 3 \\times 10^{-3}\\,\\mathrm{m}$ 和 $\\hat{\\alpha} = 9.900$。\n$$\nE^* = \\frac{3 \\times 10^{9.900}}{4 \\sqrt{3 \\times 10^{-3}}}\n$$\n我们进行数值计算：\n$$\n\\sqrt{3 \\times 10^{-3}} = \\sqrt{0.003} \\approx 0.05477225575\\,\\mathrm{m}^{1/2}\n$$\n$$\n10^{9.900} \\approx 7.943282347 \\times 10^9\n$$\n代入这些值：\n$$\nE^* = \\frac{3 \\times (7.943282347 \\times 10^9)}{4 \\times 0.05477225575} = \\frac{2.382984704 \\times 10^{10}}{0.219089023} \\approx 1.08767 \\times 10^{11}\\,\\mathrm{Pa}\n$$\n结果的单位是帕斯卡。我们必须将其转换为吉帕斯卡（GPa），其中 $1\\,\\mathrm{GPa} = 10^9\\,\\mathrm{Pa}$。\n$$\nE^* \\approx 108.767\\,\\mathrm{GPa}\n$$\n问题要求将最终答案四舍五入到三位有效数字。\n$$\nE^* \\approx 109\\,\\mathrm{GPa}\n$$\n对于许多工程材料，例如某些铝合金或玻璃，这是一个合理的有效模量值。", "answer": "$$\n\\boxed{109}\n$$", "id": "2892005"}, {"introduction": "任何一次测量，如果没有对其不确定性的说明，都是不完整的。在前一个练习的基础上，本实践将引导你进行更严谨的实验数据分析。你将学习如何应用测量不确定度表示指南（GUM）中的一阶不确定性传播定律，将原始测量值（如载荷、曲率半径和压痕深度）的不确定性，传递到最终计算出的物理量（有效模量 $E^*$）中 ([@problem_id:2891954])。这项练习将教会你量化测量结果置信度的关键技能，并揭示了不同测量值之间的相关性如何影响最终结果的可靠性。", "problem": "从两个由线性弹性材料制成的各向同性球体之间的无摩擦、无粘附、小应变弹性接触中，获取了单次载荷-压痕测量数据。经典的赫兹解将法向载荷、趋近量（压入深度）、等效几何半径和等效弹性模量联系起来。设实验测得的量为等效半径 $R^{*}$、施加的法向载荷 $P$ 和趋近量 $\\delta$。假设等效弹性模量 $E^{*}$ 是通过两个球体弹性接触的赫兹关系从这些可观测量中推断出来的。\n\n要求您为被视为可微函数 $E^{*}=f(P,R^{*},\\delta)$ 的 $E^{*}$ 设计并执行一阶不确定度传播分析（也称为不确定度传播定律，与《测量不确定度表示指南》（GUM）一致）。使用关于测量值的线性化方法，并包含协方差项。然后，假设近似正态分布，覆盖因子 $k=1.96$，计算 $E^{*}$ 的双侧 $95\\,\\%$ 置信区间（CI）。\n\n使用以下数据（所有值均为名义估计值及其相关的标准不确定度，即一个标准差）：\n- 等效半径：$R^{*}=8.00\\,\\mathrm{mm}$，标准不确定度 $u_{R^{*}}=0.02\\,\\mathrm{mm}$。\n- 载荷：$P=130.0\\,\\mathrm{N}$，标准不确定度 $u_{P}=0.8\\,\\mathrm{N}$。\n- 趋近量：$\\delta=5.00\\,\\mu\\mathrm{m}$，标准不确定度 $u_{\\delta}=0.05\\,\\mu\\mathrm{m}$。\n- $P$ 和 $\\delta$ 之间的相关系数：$\\rho_{P,\\delta}=0.25$；所有其他成对相关性均可忽略不计。\n\n任务：\n1. 从两个弹性球体的经典赫兹解出发，将 $E^{*}$ 表示为 $P$, $R^{*}$ 和 $\\delta$ 的显式函数，并说明线性化传播有效的可微性条件。\n2. 解析推导梯度 $\\nabla f=\\left(\\frac{\\partial E^{*}}{\\partial P},\\frac{\\partial E^{*}}{\\partial R^{*}},\\frac{\\partial E^{*}}{\\partial \\delta}\\right)$。\n3. 使用给定的标准不确定度和相关信息，构建 $(P,R^{*},\\delta)$ 的协方差矩阵，并通过梯度与协方差矩阵的二次型计算标准不确定度 $u(E^{*})$。\n4. 以 $E^{*}\\pm k\\,u(E^{*})$ 的形式（其中 $k=1.96$）构建 $E^{*}$ 的对称 $95\\,\\%$ 置信区间（CI）。\n\n以 $\\mathrm{GPa}$ 为单位表示 $95\\,\\%$ 置信区间的最终下限和上限。将每个界限四舍五入至四位有效数字。最终答案必须仅为这对界限值。", "solution": "问题陈述经过严格验证。\n\n逐字提取的已知条件如下：\n- 等效半径：$R^{*}=8.00\\,\\mathrm{mm}$，标准不确定度 $u_{R^{*}}=0.02\\,\\mathrm{mm}$。\n- 载荷：$P=130.0\\,\\mathrm{N}$，标准不确定度 $u_{P}=0.8\\,\\mathrm{N}$。\n- 趋近量：$\\delta=5.00\\,\\mu\\mathrm{m}$，标准不确定度 $u_{\\delta}=0.05\\,\\mu\\mathrm{m}$。\n- $P$ 和 $\\delta$ 之间的相关系数：$\\rho_{P,\\delta}=0.25$；所有其他成对相关性均可忽略不计。\n- $95\\,\\%$ 置信区间（CI）的覆盖因子：$k=1.96$。\n- 该系统涉及两个由线性弹性材料制成的各向同性球体之间的无摩擦、无粘附、小应变弹性接触。\n- 等效弹性模量 $E^{*}$ 被视为可微函数 $E^{*}=f(P,R^{*},\\delta)$。\n\n验证结论：\n该问题在科学上基于经典的赫兹接触力学和不确定度传播的计量标准（GUM）。问题提法明确，所有必要的数据和条件均已提供。没有逻辑矛盾、科学谬误或含糊之处。所给数值在物理上是合理的。因此，该问题被认定为有效，并将提供完整解答。\n\n解答过程通过完成四个指定的任务来进行。\n\n任务1：$E^{*}$ 的表达式和可微性条件\n两个球体之间弹性接触的经典赫兹解通过以下方程将法向载荷 $P$ 与趋近量 $\\delta$ 联系起来：\n$$\nP = \\frac{4}{3} E^{*} \\sqrt{R^{*}} \\delta^{3/2}\n$$\n其中 $E^{*}$ 是等效弹性模量，$R^{*}$ 是等效曲率半径。\n为了将 $E^{*}$ 表示为可观测量 $P$、$R^{*}$ 和 $\\delta$ 的显式函数，我们重新整理这个方程：\n$$\nE^{*} = \\frac{3P}{4 \\sqrt{R^{*}} \\delta^{3/2}} = \\frac{3}{4} P (R^{*})^{-1/2} \\delta^{-3/2}\n$$\n这定义了函数 $E^{*} = f(P, R^{*}, \\delta)$。一阶不确定度传播分析依赖于该函数的泰勒级数展开，这要求该函数在由测量值定义的点上对其变量是可微的。函数 $f(P, R^{*}, \\delta)$ 是幂函数的乘积。只要 $R^{*} > 0$ 且 $\\delta > 0$，其关于 $P$、$R^{*}$ 和 $\\delta$ 的偏导数就存在且连续。在物理接触问题的背景下，$P$、$R^{*}$ 和 $\\delta$ 都必须为正，因此这些条件得到满足。\n\n任务2：$E^{*}$ 的梯度\n函数 $E^{*} = f(P, R^{*}, \\delta)$ 的梯度是其偏导数的向量，$\\nabla f = \\left( \\frac{\\partial E^{*}}{\\partial P}, \\frac{\\partial E^{*}}{\\partial R^{*}}, \\frac{\\partial E^{*}}{\\partial \\delta} \\right)$。我们计算每个分量：\n$$\n\\frac{\\partial E^{*}}{\\partial P} = \\frac{\\partial}{\\partial P} \\left( \\frac{3}{4} P (R^{*})^{-1/2} \\delta^{-3/2} \\right) = \\frac{3}{4} (R^{*})^{-1/2} \\delta^{-3/2} = \\frac{1}{P} \\left( \\frac{3}{4} P (R^{*})^{-1/2} \\delta^{-3/2} \\right) = \\frac{E^{*}}{P}\n$$\n$$\n\\frac{\\partial E^{*}}{\\partial R^{*}} = \\frac{\\partial}{\\partial R^{*}} \\left( \\frac{3}{4} P (R^{*})^{-1/2} \\delta^{-3/2} \\right) = \\frac{3}{4} P \\left( -\\frac{1}{2} \\right) (R^{*})^{-3/2} \\delta^{-3/2} = -\\frac{1}{2R^{*}} \\left( \\frac{3}{4} P (R^{*})^{-1/2} \\delta^{-3/2} \\right) = -\\frac{E^{*}}{2R^{*}}\n$$\n$$\n\\frac{\\partial E^{*}}{\\partial \\delta} = \\frac{\\partial}{\\partial \\delta} \\left( \\frac{3}{4} P (R^{*})^{-1/2} \\delta^{-3/2} \\right) = \\frac{3}{4} P (R^{*})^{-1/2} \\left( -\\frac{3}{2} \\right) \\delta^{-5/2} = -\\frac{3}{2\\delta} \\left( \\frac{3}{4} P (R^{*})^{-1/2} \\delta^{-3/2} \\right) = -\\frac{3E^{*}}{2\\delta}\n$$\n因此梯度为：\n$$\n\\nabla f = \\left( \\frac{E^{*}}{P}, -\\frac{E^{*}}{2R^{*}}, -\\frac{3E^{*}}{2\\delta} \\right)\n$$\n\n任务3：协方差矩阵和标准不确定度 $u(E^{*})$\n函数 $y=f(x_1, x_2, \\dots, x_N)$ 的不确定度传播定律的一阶近似形式为：\n$$\nu^2(y) = \\sum_{i=1}^{N} \\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 u^2(x_i) + 2 \\sum_{i=1}^{N-1} \\sum_{j=i+1}^{N} \\frac{\\partial f}{\\partial x_i} \\frac{\\partial f}{\\partial x_j} u(x_i, x_j)\n$$\n其中 $u(x_i)$ 是 $x_i$ 的标准不确定度，$u(x_i, x_j) = \\rho_{x_i, x_j} u(x_i) u(x_j)$ 是 $x_i$ 和 $x_j$ 之间的协方差。我们的变量是 $x_1=P$，$x_2=R^{*}$ 和 $x_3=\\delta$。给定只有 $\\rho_{P,\\delta}$ 非零，所以 $u(P,R^{*})=0$ 且 $u(R^{*},\\delta)=0$。\n\n$E^{*}$ 的方差为：\n$$\nu^2(E^{*}) = \\left(\\frac{\\partial E^{*}}{\\partial P}\\right)^2 u_P^2 + \\left(\\frac{\\partial E^{*}}{\\partial R^{*}}\\right)^2 u_{R^{*}}^2 + \\left(\\frac{\\partial E^{*}}{\\partial \\delta}\\right)^2 u_{\\delta}^2 + 2 \\left(\\frac{\\partial E^{*}}{\\partial P}\\right) \\left(\\frac{\\partial E^{*}}{\\partial \\delta}\\right) u(P, \\delta)\n$$\n代入偏导数：\n$$\nu^2(E^{*}) = \\left(\\frac{E^{*}}{P}\\right)^2 u_P^2 + \\left(-\\frac{E^{*}}{2R^{*}}\\right)^2 u_{R^{*}}^2 + \\left(-\\frac{3E^{*}}{2\\delta}\\right)^2 u_{\\delta}^2 + 2 \\left(\\frac{E^{*}}{P}\\right) \\left(-\\frac{3E^{*}}{2\\delta}\\right) \\rho_{P,\\delta} u_P u_{\\delta}\n$$\n使用相对不确定度进行计算更为方便。除以 $(E^{*})^2$：\n$$\n\\left(\\frac{u(E^{*})}{E^{*}}\\right)^2 = \\left(\\frac{u_P}{P}\\right)^2 + \\frac{1}{4}\\left(\\frac{u_{R^{*}}}{R^{*}}\\right)^2 + \\frac{9}{4}\\left(\\frac{u_{\\delta}}{\\delta}\\right)^2 - 3 \\rho_{P,\\delta} \\left(\\frac{u_P}{P}\\right) \\left(\\frac{u_{\\delta}}{\\delta}\\right)\n$$\n现在，我们进行数值计算。首先，计算 $E^{*}$ 的名义值：\n$P = 130.0\\,\\mathrm{N}$，$R^{*} = 8.00 \\times 10^{-3}\\,\\mathrm{m}$，$\\delta = 5.00 \\times 10^{-6}\\,\\mathrm{m}$。\n$$\nE^{*} = \\frac{3 \\times 130.0}{4 \\sqrt{8.00 \\times 10^{-3}} (5.00 \\times 10^{-6})^{3/2}} = \\frac{390}{4 \\times \\sqrt{0.008} \\times (5\\sqrt{5} \\times 10^{-9})} \\approx 97.5 \\times 10^9\\,\\mathrm{Pa} = 97.5\\,\\mathrm{GPa}\n$$\n接下来，计算相对不确定度的平方：\n$$\n\\left(\\frac{u_P}{P}\\right)^2 = \\left(\\frac{0.8}{130.0}\\right)^2 \\approx 3.78698 \\times 10^{-5}\n$$\n$$\n\\frac{1}{4}\\left(\\frac{u_{R^{*}}}{R^{*}}\\right)^2 = \\frac{1}{4}\\left(\\frac{0.02}{8.00}\\right)^2 = \\frac{1}{4}(0.0025)^2 = 1.5625 \\times 10^{-6}\n$$\n$$\n\\frac{9}{4}\\left(\\frac{u_{\\delta}}{\\delta}\\right)^2 = \\frac{9}{4}\\left(\\frac{0.05}{5.00}\\right)^2 = \\frac{9}{4}(0.01)^2 = 2.25 \\times 10^{-4}\n$$\n协方差项：\n$$\n-3 \\rho_{P,\\delta} \\left(\\frac{u_P}{P}\\right) \\left(\\frac{u_{\\delta}}{\\delta}\\right) = -3 \\times 0.25 \\times \\left(\\frac{0.8}{130.0}\\right) \\times \\left(\\frac{0.05}{5.00}\\right) \\approx -0.75 \\times (0.0061538) \\times (0.01) \\approx -4.61538 \\times 10^{-5}\n$$\n将各项相加，求 $E^{*}$ 的相对方差：\n$$\n\\left(\\frac{u(E^{*})}{E^{*}}\\right)^2 \\approx (3.78698 \\times 10^{-5}) + (1.5625 \\times 10^{-6}) + (2.25 \\times 10^{-4}) - (4.61538 \\times 10^{-5})\n$$\n$$\n\\left(\\frac{u(E^{*})}{E^{*}}\\right)^2 \\approx (0.378698 + 0.015625 + 2.25 - 0.461538) \\times 10^{-4} = 2.182785 \\times 10^{-4}\n$$\n相对标准不确定度是平方根：\n$$\n\\frac{u(E^{*})}{E^{*}} = \\sqrt{2.182785 \\times 10^{-4}} \\approx 0.01477425\n$$\n标准不确定度 $u(E^{*})$ 为：\n$$\nu(E^{*}) = E^{*} \\times \\frac{u(E^{*})}{E^{*}} \\approx (97.5 \\times 10^9\\,\\mathrm{Pa}) \\times 0.01477425 \\approx 1.44049 \\times 10^9\\,\\mathrm{Pa} = 1.44049\\,\\mathrm{GPa}\n$$\n\n任务4：$E^{*}$ 的置信区间\n$E^{*}$ 的 $95\\,\\%$ 置信区间由 $E^{*} \\pm k \\cdot u(E^{*})$ 给出，其中 $k=1.96$。\n扩展不确定度 $U(E^{*})$ 为：\n$$\nU(E^{*}) = k \\cdot u(E^{*}) = 1.96 \\times 1.44049\\,\\mathrm{GPa} \\approx 2.82336\\,\\mathrm{GPa}\n$$\n置信区间的下限和上限分别为：\n下限：$E_{LB} = E^{*} - U(E^{*}) = 97.5\\,\\mathrm{GPa} - 2.82336\\,\\mathrm{GPa} = 94.67664\\,\\mathrm{GPa}$\n上限：$E_{UB} = E^{*} + U(E^{*}) = 97.5\\,\\mathrm{GPa} + 2.82336\\,\\mathrm{GPa} = 100.32336\\,\\mathrm{GPa}$\n\n按照指示，将每个界限四舍五入至四位有效数字：\n下限 $\\approx 94.68\\,\\mathrm{GPa}$\n上限 $\\approx 100.3\\,\\mathrm{GPa}$\n最终结果是这对以 GPa 为单位的界限值 $(94.68, 100.3)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 94.68 & 100.3 \\end{pmatrix}}\n$$", "id": "2891954"}, {"introduction": "我们将挑战从单个理想接触扩展到更接近真实的粗糙表面接触问题。真实的工程表面并非完美光滑，其接触行为是由大量微观粗糙峰的集体响应决定的。本实践是一个综合性的计算项目，要求你基于赫兹理论，构建一个多粗糙峰接触模型 ([@problem_id:2773593])。你将实现一个完整的工作流程：从处理原子显微镜（AFM）测得的表面形貌数据，到校准粗糙峰的几何参数，最终预测并验证整个接触面的宏观刚度，从而搭建起从单个粗糙峰的纳米力学行为到宏观接触响应的桥梁。", "problem": "您的任务是使用原子力显微镜（AFM）形貌数据，为赫兹多粗糙峰接触模型设计并实现一个完整的校准与验证工作流程，并满足以下要求。物理设置为一个刚性平面与一个粗糙弹性半空间之间的无粘附、无摩擦、小应变弹性法向接触。单个峰顶尺度上的接触行为假设遵循经典的赫兹弹性接触理论。您的任务是实现一个程序，该程序能够 (i) 从AFM形貌数据中校准粗糙峰顶点的半径和面密度，以及 (ii) 预测总法向接触刚度作为刚性平面间隙的函数，并将其与提供的合成“测量”刚度进行比较。\n\n用于推导和建模的基本原理：\n- 各向同性固体的线性小应变弹性理论，使用一个有效平面应变弹性模量 $E^{\\ast}$ 来整合接触体的弹性响应。\n- 球形峰顶与刚性平面接触的压痕运动学，其中几何干涉为 $\\delta$，圆形接触区域的半径为 $a$。\n- 用于将粗糙峰级别的刚度组合成净法向刚度的并联法向弹簧叠加原理。\n\n问题陈述中禁止使用：任何关于赫兹载荷-压痕或刚度定律的简便公式。您必须在解决方案中基于上述基本原理推导出所有所需的关系式。\n\n需实现的校准方法：\n1. 从AFM形貌中识别峰顶：\n   - AFM形貌是一个高度图 $z(x,y)$，在 $N_x \\times N_y$ 像素的规则网格上采样，像素尺寸为 $s$（$N_x$ 和 $N_y$ 均为整数，$s$ 是一个长度）。峰顶被定义为其高度相对于其8个邻居像素为局部最大值，且高度严格大于给定阈值 $h_{\\mathrm{thr}}$ 的像素。\n2. 在每个峰顶处估计局部曲率和半径：\n   - 在每个峰顶周围，以该峰顶为中心，在一个 $5 \\times 5$ 像素的方形区域上拟合一个二次高度函数：\n     $$\n     z(x,y) \\approx \\alpha x^2 + \\beta x y + \\gamma y^2 + p x + q y + r,\n     $$\n     其中 $(x,y)$ 以米为单位，原点位于峰顶像素中心。从拟合的黑塞矩阵\n     $$\n     \\mathbf{H} = \\begin{bmatrix} z_{xx} & z_{xy} \\\\ z_{xy} & z_{yy} \\end{bmatrix} = \\begin{bmatrix} 2\\alpha & \\beta \\\\ \\beta & 2\\gamma \\end{bmatrix},\n     $$\n     通过其迹提取各向同性的有效峰顶半径：\n     $$\n     R = \\frac{-2}{\\operatorname{tr}(\\mathbf{H})},\n     $$\n     前提是 $\\operatorname{tr}(\\mathbf{H}) < 0$，以确保峰顶是局部向下凸的；否则，将该峰顶从校准集中丢弃。在输出中以纳米为单位表示 $R$。\n3. 面密度：\n   - 如果在可以进行 $5 \\times 5$ 拟合的内部区域中识别出 $N_{\\mathrm{sum}}$ 个有效峰顶，则面密度为\n     $$\n     \\rho = \\frac{N_{\\mathrm{sum}}}{A_{\\mathrm{fit}}},\n     $$\n     其中 $A_{\\mathrm{fit}}$ 是内部分析区域的面积，输出时以 $\\mu \\mathrm{m}^2$ 为单位表示。用于接触建模的峰顶高度取峰顶像素处的形貌值。\n\n需实现的验证方法：\n- 给定一系列刚性平面间隙 $\\{c_j\\}$（从形貌的平均平面测量；较大的 $c$ 意味着离表面更远），通过对所有具有正干涉量 $\\delta_i(c_j) = h_i - c_j$ 的峰顶的单个粗糙峰刚度求和，构建预测的总法向接触刚度 $K_{\\mathrm{pred}}(c_j)$，其中 $h_i$ 是峰顶高度。单个粗糙峰的刚度必须在您的解决方案推导中从赫兹弹性解导出。总刚度是各个刚度的并联和。\n\n用于可测试性的测量刚度构建：\n- 对于每个案例，需要使用相同的赫兹多粗糙峰模型，从用于生成形貌的真实峰顶数据中，确定性地（不使用随机数）构建一个合成的“测量”刚度数组 $K_{\\mathrm{meas}}(c_j)$。通过在相同的间隙下对真实峰顶刚度求和来定义真实刚度值 $K_{\\mathrm{true}}(c_j)$。定义平均刚度 $\\bar{K} = \\frac{1}{N_c} \\sum_{j=1}^{N_c} K_{\\mathrm{true}}(c_j)$，其中 $N_c$ 是间隙的数量。然后添加一个确定性的小振幅测量扰动：\n  $$\n  K_{\\mathrm{meas}}(c_j) = K_{\\mathrm{true}}(c_j) + 0.02 \\bar{K} \\, \\sin(j),\n  $$\n  其中，在正弦函数的参数中，$j$ 是从1开始计数的。\n\n实现细节、单位和要求输出：\n- 所有赫兹接触的计算必须在国际单位制（SI）中进行：长度单位为米，刚度单位为牛顿/米，模量单位为帕斯卡。\n- AFM形貌输入的像素尺寸和高度以纳米为单位；计算时需转换为米。\n- 有效模量 $E^{\\ast}$ 以吉帕斯卡（GPa）为单位；计算时需转换为帕斯卡。\n- 间隙 $\\{c_j\\}$ 以纳米为单位；计算时需转换为米。\n- 每个测试案例的最终要求输出：\n  - 校准的平均峰顶半径 $\\overline{R}$，单位为纳米。\n  - 校准的面密度 $\\rho$，单位为 $\\mu \\mathrm{m}^{-2}$。\n  - 预测刚度与测量刚度之间的均方根误差，\n    $$\n    \\operatorname{RMSE} = \\sqrt{\\frac{1}{N_c} \\sum_{j=1}^{N_c} \\left(K_{\\mathrm{pred}}(c_j) - K_{\\mathrm{meas}}(c_j)\\right)^2},\n    $$\n    单位为 $\\mathrm{N}/\\mathrm{m}$。\n  - 报告 $\\overline{R}$ 保留两位小数，$\\rho$ 保留三位小数，$\\operatorname{RMSE}$ 保留三位小数。\n\n测试套件（三个案例）：\n- 案例A（理想路径）：\n  - 网格：$N_x = 128$, $N_y = 128$，像素尺寸 $s = 5\\,\\mathrm{nm}$。\n  - 粗糙峰数量：$M = 40$，排列在 $G_x \\times G_y = 8 \\times 5$ 中心的规则网格上。\n  - 中心位置：设边界 $m = 4$ 像素；$x$ 坐标索引是在 $m$ 和 $N_x-1-m$ (含)之间等间距分布的 $G_x$ 个位置的整数部分；$y$ 坐标索引类似，使用 $G_y$ 个位置分布在 $m$ 和 $N_y-1-m$ 之间。中心点按行主序排列。\n  - 峰顶高度：对于 $i = 0,1,\\ldots,M-1$（按上述行主序），$h_i$ 从 $h_{\\min} = 1.0\\,\\mathrm{nm}$ 线性增加到 $h_{\\max} = 3.0\\,\\mathrm{nm}$。\n  - 半径：对所有 $i$，$R_i = 40\\,\\mathrm{nm}$。\n  - 阈值：$h_{\\mathrm{thr}} = 0.3\\,\\mathrm{nm}$。\n  - 有效模量：$E^{\\ast} = 80\\,\\mathrm{GPa}$。\n  - 间隙：$\\{c_j\\} = [2.5, 2.0, 1.5, 1.0, 0.5]\\,\\mathrm{nm}$。\n- 案例B（稀疏粗糙峰）：\n  - 网格：$N_x = 96$, $N_y = 96$，像素尺寸 $s = 10\\,\\mathrm{nm}$。\n  - $M = 10$，排列在 $G_x \\times G_y = 5 \\times 2$ 中心的网格上，边界和位置规则同上。\n  - $h_i$ 从 $h_{\\min} = 1.0\\,\\mathrm{nm}$ 线性增加到 $h_{\\max} = 4.0\\,\\mathrm{nm}$，按上述方式对 $i$ 进行。\n  - 半径：对所有 $i$，$R_i = 100\\,\\mathrm{nm}$。\n  - 阈值：$h_{\\mathrm{thr}} = 0.5\\,\\mathrm{nm}$。\n  - $E^{\\ast} = 120\\,\\mathrm{GPa}$。\n  - 间隙：$\\{c_j\\} = [3.5, 3.0, 2.0, 1.0]\\,\\mathrm{nm}$。\n- 案例C（混合半径）：\n  - 网格：$N_x = 64$, $N_y = 64$，像素尺寸 $s = 8\\,\\mathrm{nm}$。\n  - $M = 20$，排列在 $G_x \\times G_y = 5 \\times 4$ 中心的网格上，边界和位置规则同上。\n  - $h_i$ 从 $h_{\\min} = 0.8\\,\\mathrm{nm}$ 线性增加到 $h_{\\max} = 2.2\\,\\mathrm{nm}$，按上述方式对 $i$ 进行。\n  - 半径交替出现：对于偶数 $i$，$R_i = 30\\,\\mathrm{nm}$；对于奇数 $i$，$R_i = 60\\,\\mathrm{nm}$。\n  - 阈值：$h_{\\mathrm{thr}} = 0.4\\,\\mathrm{nm}$。\n  - $E^{\\ast} = 60\\,\\mathrm{GPa}$。\n  - 间隙：$\\{c_j\\} = [1.8, 1.2, 0.6, 0.2]\\,\\mathrm{nm}$。\n\n所有案例的形貌合成：\n- 在给定网格上，AFM高度图是 $M$ 个球形抛物面帽的逐点最大值：\n  $$\n  z_i(x,y) = \\max\\!\\left(0,\\, h_i - \\frac{x_i^2+y_i^2}{2 R_i}\\right),\n  $$\n  其中 $(x_i,y_i)$ 是相对于第 $i$ 个峰顶中心的局部坐标，以米为单位表示，$h_i$ 和 $R_i$ 也被转换为米。总高度为 $z(x,y) = \\max_i z_i(x,y)$。\n\n验证指标和最终输出格式：\n- 对于每个案例，计算三元组 $[\\overline{R}_{\\mathrm{nm}}, \\rho_{\\mu \\mathrm{m}^{-2}}, \\mathrm{RMSE}_{\\mathrm{N}/\\mathrm{m}}]$ 并进行指定舍入。您的程序应生成单行输出，其中包含三个案例的结果，格式为逗号分隔的列表的列表，并用方括号括起来，例如：\n  $$\n  [[r_A,\\rho_A,\\mathrm{rmse}_A],[r_B,\\rho_B,\\mathrm{rmse}_B],[r_C,\\rho_C,\\mathrm{rmse}_C]].\n  $$\n不需要也不允许用户输入；所有数据均已在上方定义。请确保在所有计算和输出中严格按照规定进行单位转换。", "solution": "问题陈述经评估有效。这是一个在计算接触力学领域具有科学依据、提法恰当且客观的问题。所有必要的参数和程序都已明确定义，从而可以得到一个唯一的、确定性的解。该问题要求从基本原理推导赫兹接触关系，并将其应用于真实的数据分析工作流程，这是一项实质性的、有挑战性的任务。满足有效问题的所有条件。我现在将开始提供解决方案。\n\n解决方案分为两部分：首先，按要求从基本原理推导单个粗糙峰的刚度模型；其次，概述用于实现校准和验证工作流程的计算算法。\n\n### 1. 单个粗糙峰法向刚度的推导\n\n问题要求推导单个半径为 $R$ 的弹性球形峰顶压入刚性平面时的法向接触刚度 $K$。这基于经典的赫兹接触理论。推导过程分三步进行。\n\n首先，我们建立施加的法向载荷 $P$ 与产生的圆形接触区域半径 $a$ 之间的关系。对于球形压头，压力分布是椭球形的：\n$$\np(r) = p_0 \\sqrt{1 - (r/a)^2}\n$$\n其中 $r$ 是距接触中心的径向距离，$p_0$ 是峰值压力。总载荷 $P$ 是该压力在接触区域上的积分：\n$$\nP = \\int_0^{2\\pi} \\int_0^a p(r) \\, r \\, dr \\, d\\theta = 2\\pi \\int_0^a p_0 \\sqrt{1 - (r/a)^2} \\, r \\, dr = \\frac{2}{3}\\pi a^2 p_0\n$$\n线性弹性理论将表面位移与压力联系起来。对于这种压力分布，位移轮廓是抛物线形的，中心位移（即压痕深度 $\\delta$）与峰值压力 $p_0$ 的关系为：\n$$\n\\delta = \\frac{\\pi a p_0}{2 E^*}\n$$\n其中 $E^*$ 是平面应变有效弹性模量。结合这两个弹性关系式以消除 $p_0$，得到载荷 $P$、接触半径 $a$ 和压痕深度 $\\delta$ 之间的关系：\n$$\nP = \\frac{4}{3} E^* a \\delta\n$$\n\n其次，我们陈述压痕深度 $\\delta$、球体半径 $R$ 和接触半径 $a$ 之间的几何关系。对于 $\\delta \\ll R$ 的小压痕，接触的几何形状由下式描述：\n$$\na^2 = R\\delta\n$$\n这假设峰顶在其顶点附近的未变形轮廓可以很好地用抛物线 $z(r) \\approx r^2/(2R)$ 来近似，对于球体而言情况正是如此。\n\n第三，我们结合弹性和几何关系来找到载荷-压痕定律 $P(\\delta)$，然后对其求导以找到刚度 $K(\\delta)$。我们将 $a = \\sqrt{R\\delta}$ 代入 $P$ 的表达式中：\n$$\nP(\\delta) = \\frac{4}{3} E^* (\\sqrt{R\\delta}) \\delta = \\frac{4}{3} E^* \\sqrt{R} \\delta^{3/2}\n$$\n这就是著名的球体-平面接触的赫兹载荷-压痕定律。法向接触刚度 $K$ 定义为载荷相对于压痕的变化率：\n$$\nK(\\delta) = \\frac{dP}{d\\delta} = \\frac{d}{d\\delta} \\left( \\frac{4}{3} E^* \\sqrt{R} \\delta^{3/2} \\right) = \\frac{4}{3} E^* \\sqrt{R} \\left( \\frac{3}{2} \\delta^{1/2} \\right)\n$$\n简化后得到单个粗糙峰刚度的最终表达式：\n$$\nK(\\delta) = 2 E^* \\sqrt{R\\delta}\n$$\n认识到 $a = \\sqrt{R\\delta}$，刚度也可以用接触半径优雅地表示为：\n$$\nK = 2 E^* a\n$$\n这个推导出的公式将用于计算接触模型中每个粗糙峰的刚度。\n\n### 2. 计算工作流程\n\n实现过程遵循问题陈述中为每个测试案例指定的步骤序列。所有物理量都被转换并以国际单位制（米、帕斯卡、牛顿）进行计算，以确保一致性。\n\n**步骤 2.1：形貌合成**\n对于每个测试案例，必须首先生成一个合成的AFM形貌图 $z(x,y)$。\n_a._ 根据案例参数确定真实峰顶的中心位置（以像素索引表示）、高度和半径。中心像素索引 $\\{ (i_k, j_k) \\}_{k=1}^M$ 通过在指定区间上使用 `np.linspace` 并使用 `itertools.product` 来确保行主序来计算。\n_b._ 创建一个与每个像素中心对应的坐标网格 $(x,y)$。\n_c._ 对于 $M$ 个真实粗糙峰中的每一个，在整个网格上计算一个球帽高度轮廓 $z_k(x,y) = \\max(0, h_k - ( (x-x_{c,k})^2 + (y-y_{c,k})^2 ) / (2 R_k) )$。\n_d._ 最终的形貌 $z(x,y)$ 是这 $M$ 个轮廓的逐点最大值：$z(x,y) = \\max_k z_k(x,y)$。\n\n**步骤 2.2：从形貌进行模型校准**\n_a._ **峰顶识别**：算法迭代遍历形貌图的内部区域，具体地，对于像素索引 $(i,j)$，其中可以居中放置一个 $5 \\times 5$ 的区域，即 $i \\in [2, N_x-3]$ 和 $j \\in [2, N_y-3]$。如果一个像素的高度 $z(i,j)$ 严格大于其八个直接邻居的高度，并且也严格大于阈值高度 $h_{\\mathrm{thr}}$，则该像素被识别为峰顶。\n_b._ **局部曲率拟合**：对于每个识别出的峰顶，提取以其为中心的 $5 \\times 5$ 像素区域。使用线性最小二乘法 (`numpy.linalg.lstsq`) 将二次函数 $z_{\\mathrm{fit}}(x,y) = \\alpha x^2 + \\beta xy + \\gamma y^2 + px + qy + r$ 拟合到该区域中的25个高度值。局部坐标 $(x,y)$ 是相对于峰顶中心的，并按像素尺寸 $s$ 进行缩放。\n_c._ **半径计算**：从拟合系数 $\\alpha$ 和 $\\gamma$ 计算黑塞矩阵的迹为 $\\operatorname{tr}(\\mathbf{H}) = 2\\alpha + 2\\gamma$。如果 $\\operatorname{tr}(\\mathbf{H}) < 0$（表示向下凸的形状），则计算各向同性有效峰顶半径为 $R = -2/\\operatorname{tr}(\\mathbf{H})$。不满足此条件的峰顶将被丢弃。有效峰顶的高度为其像素高度 $z(i,j)$。\n_d._ **参数聚合**：平均半径 $\\overline{R}$ 是所有有效校准半径的平均值。面密度为 $\\rho = N_{\\mathrm{sum}} / A_{\\mathrm{fit}}$，其中 $N_{\\mathrm{sum}}$ 是有效峰顶的数量，$A_{\\mathrm{fit}} = (N_x-4)(N_y-4)s^2$ 是可以识别和拟合峰顶的总区域。\n\n**步骤 2.3：刚度验证**\n_a._ **预测刚度**：对于给定列表中的每个间隙值 $c_j$，计算聚合的预测刚度 $K_{\\mathrm{pred}}(c_j)$。这是通过对所有*校准*峰顶的贡献求和来完成的。对于每个高度为 $h_i$、半径为 $R_i$ 的校准峰顶 $i$，干涉量为 $\\delta_i = h_i - c_j$。如果 $\\delta_i > 0$，其刚度贡献为 $K_i = 2 E^* \\sqrt{R_i \\delta_i}$。否则，其贡献为0。\n_b._ **测量刚度**：构建一个合成的“测量”刚度数组 $K_{\\mathrm{meas}}(c_j)$。首先，使用与计算 $K_{\\mathrm{pred}}$ 相同的求和方法，但使用*真实*峰顶参数来计算“真实”刚度 $K_{\\mathrm{true}}(c_j)$。然后，添加一个确定性扰动：$K_{\\mathrm{meas}}(c_j) = K_{\\mathrm{true}}(c_j) + 0.02 \\bar{K} \\sin(j)$，其中 $\\bar{K}$ 是真实刚度值的平均值，$j$ 是间隙值的基于1的索引。\n_c._ **误差计算**：预测刚度数组和测量刚度数组之间的均方根误差（RMSE）计算为 $\\operatorname{RMSE} = \\sqrt{\\frac{1}{N_c} \\sum_j (K_{\\mathrm{pred}}(c_j) - K_{\\mathrm{meas}}(c_j))^2}$。\n\n每个案例的最终输出（$\\overline{R}$ 以 nm 为单位，$\\rho$ 以 $\\mu \\mathrm{m}^{-2}$ 为单位，RMSE 以 N/m 为单位）按指定的小数位数进行格式化。", "answer": "```python\nimport numpy as np\nfrom itertools import product\n\ndef solve():\n    \"\"\"\n    Solves the Hertzian multi-asperity contact problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A\n        {\n            'Nx': 128, 'Ny': 128, 's_nm': 5.0, 'M': 40, 'Gx': 8, 'Gy': 5,\n            'margin': 4, 'h_min_nm': 1.0, 'h_max_nm': 3.0, 'R_nm': [40.0],\n            'h_thr_nm': 0.3, 'E_star_gpa': 80.0,\n            'c_j_nm': np.array([2.5, 2.0, 1.5, 1.0, 0.5])\n        },\n        # Case B\n        {\n            'Nx': 96, 'Ny': 96, 's_nm': 10.0, 'M': 10, 'Gx': 5, 'Gy': 2,\n            'margin': 4, 'h_min_nm': 1.0, 'h_max_nm': 4.0, 'R_nm': [100.0],\n            'h_thr_nm': 0.5, 'E_star_gpa': 120.0,\n            'c_j_nm': np.array([3.5, 3.0, 2.0, 1.0])\n        },\n        # Case C\n        {\n            'Nx': 64, 'Ny': 64, 's_nm': 8.0, 'M': 20, 'Gx': 5, 'Gy': 4,\n            'margin': 4, 'h_min_nm': 0.8, 'h_max_nm': 2.2, 'R_nm': [30.0, 60.0],\n            'h_thr_nm': 0.4, 'E_star_gpa': 60.0,\n            'c_j_nm': np.array([1.8, 1.2, 0.6, 0.2])\n        }\n    ]\n    \n    results = []\n    for params in test_cases:\n        result_triple = solve_case(params)\n        results.append(result_triple)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_case(params):\n    \"\"\"\n    Processes a single test case from calibration to validation.\n    \"\"\"\n    # Unpack and convert units to SI\n    Nx, Ny = params['Nx'], params['Ny']\n    s = params['s_nm'] * 1e-9\n    M, Gx, Gy = params['M'], params['Gx'], params['Gy']\n    margin = params['margin']\n    h_min, h_max = params['h_min_nm'] * 1e-9, params['h_max_nm'] * 1e-9\n    R_nm_list = params['R_nm']\n    h_thr = params['h_thr_nm'] * 1e-9\n    E_star = params['E_star_gpa'] * 1e9\n    c_j = params['c_j_nm'] * 1e-9\n\n    # 1. Generate Ground Truth Summits\n    ground_truth_summits = generate_ground_truth(Nx, Ny, margin, Gx, Gy, M, h_min, h_max, R_nm_list)\n\n    # 2. Synthesize AFM Topography\n    z_map = synthesize_topography(Nx, Ny, s, ground_truth_summits)\n    \n    # 3. Calibrate Model from Topography\n    calibrated_summits = find_and_calibrate_summits(z_map, s, h_thr, Nx, Ny)\n    \n    # 4. Calculate Calibrated Parameters\n    if calibrated_summits:\n        mean_R_cal = np.mean([s['R'] for s in calibrated_summits])\n    else:\n        mean_R_cal = 0.0\n\n    A_fit = (Nx - 4) * (Ny - 4) * s**2\n    A_fit_um2 = A_fit * 1e12\n    rho = len(calibrated_summits) / A_fit_um2 if A_fit_um2 > 0 else 0.0\n    \n    # 5. Predict Stiffness\n    K_pred = calculate_stiffness_curve(calibrated_summits, c_j, E_star)\n    \n    # 6. Create Measured Stiffness\n    K_meas = create_measured_stiffness_curve(ground_truth_summits, c_j, E_star)\n    \n    # 7. Calculate RMSE\n    rmse = np.sqrt(np.mean((K_pred - K_meas)**2))\n    \n    # 8. Format results\n    mean_R_nm = mean_R_cal * 1e9\n    return [round(mean_R_nm, 2), round(rho, 3), round(rmse, 3)]\n\ndef generate_ground_truth(Nx, Ny, margin, Gx, Gy, M, h_min, h_max, R_nm_list):\n    \"\"\"Generates the list of ground-truth summits.\"\"\"\n    x_indices = np.linspace(margin, Nx - 1 - margin, Gx, dtype=int)\n    y_indices = np.linspace(margin, Ny - 1 - margin, Gy, dtype=int)\n    centers_pix = list(product(y_indices, x_indices))\n\n    heights = np.linspace(h_min, h_max, M)\n    radii_m = [r * 1e-9 for r in R_nm_list]\n\n    summits = []\n    for i in range(M):\n        summit = {\n            'center_pix': centers_pix[i],\n            'h': heights[i],\n            'R': radii_m[i % len(radii_m)]\n        }\n        summits.append(summit)\n    return summits\n\ndef synthesize_topography(Nx, Ny, s, summits):\n    \"\"\"Generates the AFM height map from ground-truth summits.\"\"\"\n    x_pix, y_pix = np.arange(Nx), np.arange(Ny)\n    xx_pix, yy_pix = np.meshgrid(x_pix, y_pix)\n    z_map = np.zeros_like(xx_pix, dtype=float)\n\n    for summit in summits:\n        center_y, center_x = summit['center_pix']\n        h, R = summit['h'], summit['R']\n\n        local_x = (xx_pix - center_x) * s\n        local_y = (yy_pix - center_y) * s\n        r_sq = local_x**2 + local_y**2\n        \n        z_i = h - r_sq / (2 * R)\n        z_i[z_i < 0] = 0\n        z_map = np.maximum(z_map, z_i)\n        \n    return z_map\n\ndef find_and_calibrate_summits(z_map, s, h_thr, Nx, Ny):\n    \"\"\"Identifies and characterizes summits from the topography map.\"\"\"\n    calibrated_summits = []\n    \n    # Prepare for least-squares fitting\n    patch_coords_1d = np.arange(-2, 3) * s\n    xv, yv = np.meshgrid(patch_coords_1d, patch_coords_1d)\n    A_fit_matrix = np.vstack([\n        xv.ravel()**2, xv.ravel()*yv.ravel(), yv.ravel()**2,\n        xv.ravel(), yv.ravel(), np.ones(25)\n    ]).T\n\n    # Iterate over the interior region where a 5x5 patch fits\n    istart, iend = 2, Nx - 2\n    jstart, jend = 2, Ny - 2\n    for j in range(jstart, jend):\n        for i in range(istart, iend):\n            val = z_map[j, i]\n            if val <= h_thr:\n                continue\n\n            # Check if local maximum relative to 8 neighbors\n            is_max = True\n            for dj in range(-1, 2):\n                for di in range(-1, 2):\n                    if di == 0 and dj == 0:\n                        continue\n                    if val <= z_map[j + dj, i + di]:\n                        is_max = False\n                        break\n                if not is_max:\n                    break\n            \n            if is_max:\n                # Perform quadratic fit on a 5x5 patch\n                patch_5x5 = z_map[j-2:j+3, i-2:i+3]\n                b_fit_vector = patch_5x5.ravel()\n                \n                try:\n                    coeffs, _, _, _ = np.linalg.lstsq(A_fit_matrix, b_fit_vector, rcond=None)\n                    alpha, gamma = coeffs[0], coeffs[2]\n                    \n                    tr_H = 2 * (alpha + gamma)\n                    if tr_H < 0:\n                        R_cal = -2.0 / tr_H\n                        h_cal = val\n                        calibrated_summits.append({'h': h_cal, 'R': R_cal})\n                except np.linalg.LinAlgError:\n                    continue  # Fitting failed, discard summit\n                    \n    return calibrated_summits\n\ndef calculate_stiffness_curve(summits, clearances, E_star):\n    \"\"\"Calculates aggregate stiffness vs. clearance.\"\"\"\n    K_total = []\n    for c in clearances:\n        K_c = 0.0\n        for summit in summits:\n            h, R = summit['h'], summit['R']\n            delta = h - c\n            if delta > 0:\n                # K = 2 * E* * a = 2 * E* * sqrt(R*delta)\n                K_i = 2 * E_star * np.sqrt(R * delta)\n                K_c += K_i\n        K_total.append(K_c)\n    return np.array(K_total)\n\ndef create_measured_stiffness_curve(ground_truth_summits, clearances, E_star):\n    \"\"\"Constructs the synthetic measured stiffness data.\"\"\"\n    K_true = calculate_stiffness_curve(ground_truth_summits, clearances, E_star)\n    if K_true.size > 0:\n        K_mean = np.mean(K_true)\n    else:\n        K_mean = 0.0\n    \n    # j is 1-based in the sin argument\n    j_indices = np.arange(1, len(clearances) + 1)\n    perturbation = 0.02 * K_mean * np.sin(j_indices)\n    \n    K_meas = K_true + perturbation\n    return K_meas\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2773593"}]}