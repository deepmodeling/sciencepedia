{"hands_on_practices": [{"introduction": "要掌握准连续介质 (QC) 方法，第一步是理解其核心假设：柯西-玻恩法则 (Cauchy-Born rule)。这个基本练习将指导您完成一个关键的推导过程，即如何从原子间的相互作用势直接推导出宏观的弹性模量。通过这个一维链条模型的计算 [@problem_id:2780454]，您将亲手建立起微观原子势能形貌与宏观连续介质弹性理论之间的桥梁，从而深刻理解多尺度建模的基石。", "problem": "一个具有最近邻相互作用的一维Bravais晶格由对势 $\\phi(r)$ 建模，其中 $r$ 是键长。设参考晶格间距为 $a_0$，它对应于无应力平衡状态下的键长。考虑一个由一维形变梯度 $F$ 表征的均匀宏观形变，使得当前间距为 $a = F a_0$。根据Cauchy–Born假设（该假设也用于准连续介质(QuasiContinuum, QC)方法），单位参考长度上的连续储存能密度是通过将均匀形变下原子链的原子能进行回拉来定义的。\n\n从第一性原理出发，即(i)一维最近邻原子链的总势能定义，(ii)Cauchy–Born运动学关系 $a = F a_0$，(iii)第一Piola–Kirchhoff应力作为储存能密度对 $F$ 的导数的定义，以及(iv)一维Cauchy应力的定义，在线性化平衡构型 $F = 1$（即平衡间距 $a_0$）附近的应力-应变关系。将小应变模量 $E$ 定义为Cauchy应力 $\\sigma$ 相对于工程应变 $\\varepsilon = F - 1$ 在 $\\varepsilon = 0$ 处的斜率 $\\mathrm{d}\\sigma/\\mathrm{d}\\varepsilon$。\n\n用 $\\phi'(a_0)$ 和 $\\phi''(a_0)$ 将您的最终答案表示为 $E$ 的单个闭式解析表达式。以符号表达式的形式提供最终答案；不要包含单位。", "solution": "所提出的问题要求从第一性原理出发，应用Cauchy–Born法则，推导一维原子链的小应变弹性模量。这是将原子尺度描述与连续介质力学联系起来的一个基础练习，是多尺度建模和准连续介质(Quasicontinuum, QC)方法中的一个核心概念。\n\n首先，需要对问题陈述进行严格的验证。\n\n**步骤1：提取已知条件**\n-   系统：一维Bravais晶格。\n-   相互作用：由最近邻对势 $\\phi(r)$ 决定，其中 $r$ 是键长。\n-   参考状态：晶格间距为 $a_0$，即无应力平衡键长。\n-   形变运动学：通过Cauchy–Born关系 $a = F a_0$，一个均匀的形变梯度 $F$ 将参考间距 $a_0$ 映射到当前间距 $a$。\n-   能量定义：单位参考长度上的连续储存能密度 $W(F)$ 由原子势能推导而来。\n-   应力定义1：第一Piola–Kirchhoff应力为 $P = \\frac{\\mathrm{d}W}{\\mathrm{d}F}$。\n-   应力定义2：一维情况下第一Piola-Kirchhoff应力 $P$ 和Cauchy应力 $\\sigma$ 之间的关系。\n-   应变定义：工程应变为 $\\varepsilon = F - 1$。\n-   模量定义：小应变模量为 $E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}$。\n-   目标：用势的导数 $\\phi'(a_0)$ 和 $\\phi''(a_0)$ 推导 $E$ 的表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是固体力学和材料科学中的一个标准推导。它是一个适定问题，具有清晰的定义和明确的目标。其语言客观、正式。该问题与QC方法的主题直接相关。所有提供的信息都是一致且充分的。关于 $a_0$ 对应于“无应力平衡”的陈述是一个关键信息，它意味着在 $a_0$ 处势的导数满足一个特定条件。这不是一个模糊不清之处，而是一个将在推导中使用的物理约束。\n\n**步骤3：结论与行动**\n该问题是有效的。将提供完整的解答。\n\n**推导**\n\n1.  **储存能密度, $W(F)$**\n    我们考虑一个无限长的原子链以忽略边界效应。势能与原子间的键相关。在参考构型中，每单位长度 $a_0$ 有一个原子（因此也有一根键）。单位参考长度上的原子数密度为 $1/a_0$。在均匀形变 $F$ 下，每个键的长度为 $a = F a_0$，储存的能量为 $\\phi(a) = \\phi(F a_0)$。单位参考长度上的总储存能是每根键的能量乘以单位参考长度上的键数。\n    因此，作为形变梯度 $F$ 的函数的储存能密度 $W$ 为：\n    $$W(F) = \\frac{1}{a_0}\\phi(F a_0)$$\n\n2.  **第一Piola–Kirchhoff应力, $P(F)$**\n    根据问题定义，第一Piola–Kirchhoff (P-K)应力 $P$ 是储存能密度 $W$ 相对于形变梯度 $F$ 的导数。\n    $$P(F) = \\frac{\\mathrm{d}W}{\\mathrm{d}F} = \\frac{\\mathrm{d}}{\\mathrm{d}F}\\left(\\frac{1}{a_0}\\phi(F a_0)\\right)$$\n    应用链式法则，其中 $\\phi$ 的自变量是 $u(F) = F a_0$，因此 $\\frac{\\mathrm{d}u}{\\mathrm{d}F} = a_0$：\n    $$P(F) = \\frac{1}{a_0} \\cdot \\phi'(F a_0) \\cdot \\frac{\\mathrm{d}(F a_0)}{\\mathrm{d}F} = \\frac{1}{a_0} \\cdot \\phi'(F a_0) \\cdot a_0$$\n    $$P(F) = \\phi'(F a_0)$$\n    在此一维背景下，P-K应力表示作用在参考构型中横截面上的力。\n\n3.  **Cauchy应力, $\\sigma(F)$**\n    在一维中，第一P-K应力 $P$ 和Cauchy应力 $\\sigma$ 之间的关系由 $P = F \\sigma$ 给出。这个关系将力从参考构型的面积元变换到当前构型的面积元。\n    求解Cauchy应力 $\\sigma$：\n    $$\\sigma(F) = \\frac{P(F)}{F} = \\frac{\\phi'(F a_0)}{F}$$\n\n4.  **线性化与弹性模量, $E$**\n    任务是求取相对于工程应变 $\\varepsilon = F-1$ 的模量 $E$，这意味着 $F = 1+\\varepsilon$。我们必须首先将Cauchy应力表示为应变 $\\sigma(\\varepsilon)$ 的函数。\n    $$\\sigma(\\varepsilon) = \\frac{\\phi'((1+\\varepsilon) a_0)}{1+\\varepsilon}$$\n    模量 $E$ 是应力-应变曲线在零应变处的斜率：$E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}$。我们使用商法则 $\\left(\\frac{u}{v}\\right)' = \\frac{u'v - uv'}{v^2}$ 来计算导数：\n    $$\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = \\frac{\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}[\\phi'((1+\\varepsilon)a_0)] \\cdot (1+\\varepsilon) - \\phi'((1+\\varepsilon)a_0) \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}[1+\\varepsilon]}{(1+\\varepsilon)^2}$$\n    分子项的导数需要再次应用链式法则：\n    $$\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}[\\phi'((1+\\varepsilon)a_0)] = \\phi''((1+\\varepsilon)a_0) \\cdot a_0$$\n    将此代入 $\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}$ 的表达式中：\n    $$\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = \\frac{a_0 \\phi''((1+\\varepsilon)a_0)(1+\\varepsilon) - \\phi'((1+\\varepsilon)a_0)}{(1+\\varepsilon)^2}$$\n    现在，我们在 $\\varepsilon=0$ 处计算此表达式的值，这对应于 $F=1$ 和 $a=a_0$ 的参考构型：\n    $$E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\frac{a_0 \\phi''(a_0)(1+0) - \\phi'(a_0)}{(1+0)^2}$$\n    $$E = a_0 \\phi''(a_0) - \\phi'(a_0)$$\n\n5.  **应用平衡条件**\n    问题陈述指明，间距为 $a_0$ 的参考构型是“无应力”的。在力学术语中，无应力状态意味着Cauchy应力 $\\sigma$ 为零。这发生在参考状态，即 $F=1$ 时。\n    使用我们得到的Cauchy应力表达式：\n    $$\\sigma(F=1) = \\frac{\\phi'(1 \\cdot a_0)}{1} = \\phi'(a_0)$$\n    因此，无应力条件 $\\sigma(F=1)=0$ 直接意味着：\n    $$\\phi'(a_0) = 0$$\n    这是最近邻势的平衡条件的数学表述：力（与 $-\\phi'(r)$ 成正比）在平衡间距 $a_0$ 处为零。\n    将此结果代入模量 $E$ 的表达式中：\n    $$E = a_0 \\phi''(a_0) - 0$$\n    $$E = a_0 \\phi''(a_0)$$\n    这个最终表达式代表了小应变弹性模量。项 $\\phi''(a_0)$ 是势能阱在平衡位置的曲率，它描述了原子间键的“刚度”。模量是这个内在刚度乘以平衡分离距离，这与问题的一维公式相符。", "answer": "$$\\boxed{a_0 \\phi''(a_0)}$$", "id": "2780454"}, {"introduction": "一个真正的多尺度方法必须能够无缝地耦合不同分辨率的区域，但这在实践中会带来独特的挑战。这个练习将带您从理想的连续介质模型进入更现实的耦合系统，直面全原子区域与粗粒化区域界面处的关键问题。通过在一维链中显式推导“鬼力”（ghost force）[@problem_id:2780470]，您将具体地理解为何像“补丁测试”（patch test）这样的一致性条件不仅是理论上的要求，更是保证物理模拟结果正确性的必要条件。", "problem": "考虑一个一维（$1$D）布拉菲链，其参考晶格间距为 $a>0$，对相互作用达到次近邻。一个完全解析系统的原子总势能为\n$$\n\\mathcal{E}_{\\mathrm{at}}(\\{y_i\\}) \\;=\\; \\sum_{i\\in\\mathbb{Z}} \\Big[ \\phi_{1}\\big(|y_{i+1}-y_i|\\big) \\;+\\; \\phi_{2}\\big(|y_{i+2}-y_i|\\big) \\Big],\n$$\n其中 $\\phi_{1}$ 和 $\\phi_{2}$ 分别是最近邻和次近邻的光滑对势，$\\{y_i\\}$ 是初始位于 $X_i=ia$ 的原子的变形后位置。在拉伸比为 $F>0$ 的均匀变形下，变形为 $y_i = F X_i = F a i$。\n\n采用基于能量的准连续介质（QC）耦合方法，将一个完全原子区域和一个粗化区域（使用柯西-玻恩法则）耦合起来。设原子集为 $\\mathcal{A}=\\{i\\in\\mathbb{Z}: i \\le 0\\}$，粗化区域为 $\\mathcal{C}=\\{i\\in\\mathbb{Z}: i \\ge 1\\}$。QC耦合定义如下：\n- 完全位于 $\\mathcal{A}$ 内部的所有键都以完全权重进行原子化计算。\n- 跨越界面并连接到界面原子 $i=0$ 上的键以一定的权重计入：最近邻键 $(0,1)$ 的权重为 $\\gamma_{1}\\in[0,1]$，次近邻键 $(0,2)$ 的权重为 $\\gamma_{2}\\in[0,1]$。\n- 粗化区域的能量通过连续介质的柯西-玻恩能量密度来计算剩余能量，但仅取决于 $F$（而不取决于 $y_0$）。\n\n将界面原子上的鬼力定义为均匀变形下的残余内力，即 $g(F):=f_0(F)$，其中\n$$\nf_0(F) \\;=\\; -\\,\\frac{\\partial \\mathcal{E}_{\\mathrm{QC}}}{\\partial y_0}\\Big|_{y_i=Fa\\,i},\n$$\n其中 $\\mathcal{E}_{\\mathrm{QC}}$ 是上述的QC耦合能量。从力的定义（势能的负梯度）出发，并仅使用均匀性 $y_i=Fai$ 以及 $\\phi_1$ 和 $\\phi_2$ 的光滑性，推导一个关于 $g(F)$ 的闭合形式表达式，该表达式用 $\\gamma_{1}$、$\\gamma_{2}$、$a$ 以及在均匀键长处计算的导数 $\\phi_1'$ 和 $\\phi_2'$ 表示。然后，确定在何种 $(\\gamma_{1},\\gamma_{2})$ 条件下，面片检验（对于任何均匀变形 $F$，鬼力为零）得以满足，并证明在该条件下 $g(F)$ 为零。\n\n以一个关于 $\\gamma_1$、$\\gamma_2$、$a$、$\\phi_1'$ 和 $\\phi_2'$ 的单一解析表达式报告您的最终答案 $g(F)$。最终表达式中不要包含单位。不需要进行数值取整。", "solution": "我们从内力的基本定义开始，即势能相对于原子坐标的负梯度。在静态平衡中，原子 $i$ 上的内力为\n$$\nf_i \\;=\\; -\\,\\frac{\\partial \\mathcal{E}}{\\partial y_i}.\n$$\n对于对势项 $\\phi\\big(|y_j-y_i|\\big)$，其关于 $y_i$ 的导数可通过链式法则得到：\n$$\n\\frac{\\partial}{\\partial y_i}\\,\\phi\\big(|y_j-y_i|\\big) \\;=\\; \\phi'\\big(|y_j-y_i|\\big)\\,\\frac{\\partial |y_j-y_i|}{\\partial y_i}.\n$$\n在一维拉伸 $F>0$ 的情况下，当 $j>i$ 时，我们有 $y_j-y_i>0$，因此 $|y_j-y_i|=y_j-y_i$，于是\n$$\n\\frac{\\partial}{\\partial y_i}\\,\\phi\\big(y_j-y_i\\big) \\;=\\; -\\,\\phi'\\big(y_j-y_i\\big),\\qquad\n\\frac{\\partial}{\\partial y_j}\\,\\phi\\big(y_j-y_i\\big) \\;=\\; \\phi'\\big(y_j-y_i\\big).\n$$\n因此，每个键 $(i,j)$ 对原子 $i$ 和 $j$ 施加大小相等、方向相反的对力，其大小为 $\\phi'(y_j-y_i)$。\n\n现在我们来确定准连续介质（QC）耦合能量。根据其构造，总QC能量可以划分为\n$$\n\\mathcal{E}_{\\mathrm{QC}} \\;=\\; \\mathcal{E}_{\\mathcal{A}} \\;+\\; \\mathcal{E}_{\\mathrm{cross}} \\;+\\; \\mathcal{E}_{\\mathcal{C}}(F),\n$$\n其中：\n- $\\mathcal{E}_{\\mathcal{A}}$ 包括完全包含在原子集 $\\mathcal{A}=\\{i\\le 0\\}$ 中的所有对相互作用，\n- $\\mathcal{E}_{\\mathrm{cross}}$ 包括带有指定权重的跨界面键，以及\n- $\\mathcal{E}_{\\mathcal{C}}(F)$ 是柯西-玻恩粗化区域的贡献，它只依赖于 $F$ 而不依赖于 $y_0$。\n\n只有依赖于 $y_0$ 的项对 $f_0=-\\partial \\mathcal{E}_{\\mathrm{QC}}/\\partial y_0$ 有贡献。这些项来自于连接到 $i=0$ 的键：\n- 在 $\\mathcal{A}$ 内部，键 $(-1,0)$ 和 $(-2,0)$ 被完全计入。\n- 跨越界面，键 $(0,1)$ 和 $(0,2)$ 分别以权重 $\\gamma_1$ 和 $\\gamma_2$ 计入。\n没有其他对势项依赖于 $y_0$。\n\n因此，记 $r_1:=y_{i+1}-y_i$ 和 $r_2:=y_{i+2}-y_i$，$\\mathcal{E}_{\\mathrm{QC}}$ 中依赖于 $y_0$ 的部分是\n$$\n\\mathcal{E}_{\\mathrm{QC}}(y_0;\\,F)\\;=\\;\\phi_1\\big(y_0-y_{-1}\\big)\\;+\\;\\phi_2\\big(y_0-y_{-2}\\big)\\;+\\;\\gamma_1\\,\\phi_1\\big(y_1-y_0\\big)\\;+\\;\\gamma_2\\,\\phi_2\\big(y_2-y_0\\big)\\;+\\;\\text{（不依赖于 $y_0$ 的项）}.\n$$\n在均匀变形 $y_i=F a i$ 下，相关的键长为\n$$\ny_0-y_{-1}=F a,\\qquad y_0-y_{-2}=2F a,\\qquad y_1-y_0=F a,\\qquad y_2-y_0=2F a.\n$$\n对 $y_0$ 求导并为力加上负号，我们得到各项的贡献：\n- 来自 $(-1,0)$：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\phi_1\\big(y_0-y_{-1}\\big) \\;=\\; \\phi_1'\\big(F a\\big)\\cdot 1,\\qquad\n\\Rightarrow\\quad f_0^{(-1,0)} \\;=\\; -\\,\\phi_1'\\big(F a\\big).\n$$\n- 来自 $(-2,0)$：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\phi_2\\big(y_0-y_{-2}\\big) \\;=\\; \\phi_2'\\big(2F a\\big)\\cdot 1,\\qquad\n\\Rightarrow\\quad f_0^{(-2,0)} \\;=\\; -\\,\\phi_2'\\big(2F a\\big).\n$$\n- 来自 $(0,1)$（权重为 $\\gamma_1$）：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\gamma_1\\,\\phi_1\\big(y_1-y_0\\big) \\;=\\; \\gamma_1\\,\\phi_1'\\big(F a\\big)\\cdot(-1),\\qquad\n\\Rightarrow\\quad f_0^{(0,1)} \\;=\\; +\\,\\gamma_1\\,\\phi_1'\\big(F a\\big).\n$$\n- 来自 $(0,2)$（权重为 $\\gamma_2$）：\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\gamma_2\\,\\phi_2\\big(y_2-y_0\\big) \\;=\\; \\gamma_2\\,\\phi_2'\\big(2F a\\big)\\cdot(-1),\\qquad\n\\Rightarrow\\quad f_0^{(0,2)} \\;=\\; +\\,\\gamma_2\\,\\phi_2'\\big(2F a\\big).\n$$\n将这些贡献相加，并注意到 $\\mathcal{E}_{\\mathcal{C}}(F)$ 不依赖于 $y_0$，我们得到均匀变形下界面原子上的鬼力：\n$$\ng(F)\\;=\\;f_0(F)\\;=\\;\\big(\\gamma_1-1\\big)\\,\\phi_1'\\big(F a\\big)\\;+\\;\\big(\\gamma_2-1\\big)\\,\\phi_2'\\big(2F a\\big).\n$$\n\n面片检验条件与鬼力消失。面片检验要求对于任何均匀变形 $F>0$，残余内力都为零。由于 $\\phi_1'$ 和 $\\phi_2'$ 是其变量的任意函数（取决于材料），要使 $g(F)=0$ 对所有 $F$ 成立的唯一方法是强制要求\n$$\n\\gamma_1=1,\\qquad \\gamma_2=1,\n$$\n这会得到\n$$\ng(F)\\;=\\;0\\quad \\text{对于所有 }F>0.\n$$\n这对应于将连接到界面原子的跨界面键以完全原子权重计入，同时在粗化区域中一致地计算剩余能量，以免重复计算。在这些权重下，均匀变形通过了面片检验，鬼力消失。", "answer": "$$\\boxed{(\\gamma_{1}-1)\\,\\phi_{1}'(F a)\\;+\\;(\\gamma_{2}-1)\\,\\phi_{2}'(2 F a)}$$", "id": "2780470"}, {"introduction": "准连续介质方法的真正威力在于其自适应性——即仅在最需要的地方投入高分辨率计算资源。这最后一个练习将挑战您设计一种智能的自适应加密策略，它建立在您对柯西-玻恩法则和补丁测试一致性理解的基础上。通过确定一个基于物理原理的误差指标来驱动网格的加密和粗化 [@problem_id:2780409]，您将学会如何构建一个既高效又准确的 QC 模型，以模拟材料中的缺陷等复杂现象。", "problem": "一个原子晶格通过准连续介质 (Quasicontinuum, QC) 方法进行粗粒化，以模拟表面和缺陷附近的纳米力学响应。考虑一个一维原子链，其参考晶格间距为 $a_0$，通过在有限截断距离 $r_c$ 处截断的光滑对势 $\\phi(r)$ 实现最近邻和次近邻相互作用，其储存能为\n$$\n\\Pi^{\\mathrm{a}}(y) \\;=\\; \\sum_{i \\in \\mathbb{Z}} \\sum_{j \\in \\mathcal{N}_i} \\tfrac{1}{2}\\,\\phi\\big(|y_j - y_i|\\big),\n$$\n其中 $y_i$ 是当前原子位置，$\\mathcal{N}_i$ 表示在截断距离 $r_c$ 内原子 $i$ 的邻居原子。在基于能量的准连续介质方法 (QC) 中，会选取一个称为代表性原子 (repatoms) 的原子子集，并约束变形在代表性原子之间是分段仿射的。QC 总能量通过一个求和规则进行组合，该规则为采样的格点或键能分配整数权重 $w_k$，以近似完整的原子总和。Cauchy–Born 法则定义了一个连续介质储存能密度 $W(F)$，使得对于均匀变形梯度 $F$，单位参考体积的原子能量等于 $W(F)$。\n\n一个被称为分片检验的关键要求是，在任何均匀变形 $F$ 下，QC 模型必须精确地再现原子能量和力（无伪力）：如果 $y_i = F\\,x_i$ 且 $x_i = i a_0$，那么代表性原子上的 QC 内力必须为零，并且 QC 能量必须等于原子能量。\n\n请您确定一种自适应加密策略，用于选择和更新代表性原子集，该策略 (i) 在剧烈的变形梯度或缺陷附近局部地提高分辨率，并且 (ii) 始终保持分片检验一致性。该策略应从第一性原理出发进行论证，从 Cauchy–Born 法则下的能量等价性和维里应力的定义开始。设局部维里应力 $\\sigma^{\\mathrm{vir}}$ 由控制体积内的原子间力定义，而 Cauchy–Born 应力 $\\sigma^{\\mathrm{CB}}(F)$ 由 $\\sigma^{\\mathrm{CB}}(F) = \\partial W(F)/\\partial F$ 定义。\n\n以下哪种策略同时满足这两个要求？\n\nA. 使用基于能量的 QC 和精确求和规则，该规则计算穿过每个粗网格单元的键，从而对于任何分段仿射变形，QC 能量都等于原子能量。在每个粗网格单元 $T$ 上定义一个残差型误差指示器\n$$\n\\eta_T^2 \\;=\\; \\big\\|\\sigma^{\\mathrm{vir}}(u_h)\\,-\\,\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|^2\\,|T| \\;+\\; c\\,h_T^2\\,\\|\\nabla(\\nabla u_h)\\|^2,\n$$\n其中 $u_h$ 是 QC 位移场，$h_T$ 是单元尺寸，$|T|$ 是单元测度，$c>0$ 是一个常数。通过插入额外的代表性原子来加密满足 $\\eta_T > \\theta_{\\mathrm{ref}}\\max_{K}\\eta_K$ 的单元，粗化满足 $\\eta_T  \\theta_{\\mathrm{crs}}\\max_{K}\\eta_K$ 的单元，并通过在缺陷周围和原子-连续介质边界上维持一个厚度至少为 $r_c$ 的原子缓冲层来强制执行一个考虑相互作用的界面。在每次网格变化后，保留分段仿射运动学和精确求和规则。\n\nB. 使用基于力的 QC，在原子力和连续介质力之间进行线性混合。取每个单元的指示器为 $\\eta_T = \\|\\nabla u_h\\|$，并在 $\\eta_T > \\theta_{\\mathrm{ref}}\\max_K \\eta_K$ 的地方进行加密。对于求和，每个单元采样一个代表性原子，其权重等于该单元的原子数（集总求积）。不强制执行任何特殊的界面缓冲层；允许代表性原子的间距在原子-连续介质界面上突然改变。\n\nC. 使用基于能量的 QC，在所有地方都采用 Cauchy–Born 能量密度，没有原子区域。设指示器为 $\\eta_T = \\|\\nabla(\\nabla u_h)\\|$。在 $\\eta_T$ 较大的地方进行加密，否则保持粗网格。对连续介质能量使用标准高斯求积，不使用基于键的精确求和。在缺陷附近不使用特殊处理。\n\nD. 使用基于能量的 QC 和精确求和规则，以及指示器 $\\eta_T = \\big\\|\\sigma^{\\mathrm{vir}}(u_h)-\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|$。在 $\\eta_T$ 较大时进行加密，但当 $\\eta_T$ 低于阈值时，允许粗化以将原子缓冲层消除至零厚度，即使范围为 $r_c$ 的相互作用跨越了界面。保持运动学为分段仿射，并且仅按单元体积更新权重。\n\n选择与第一性原理一致并满足两个目标的选项。基于 Cauchy–Born 关系、维里应力和分片检验的定义提供推理；并说明所选的求和、运动学和界面处理方法如何消除伪力，以及指示器如何在剧烈梯度或缺陷附近触发加密。用唯一的最佳选项作答。", "solution": "首先必须确定问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **系统**：一维原子链。\n- **晶格间距（参考）**：$a_0$。\n- **相互作用**：通过在有限截断距离 $r_c$ 处截断的光滑对势 $\\phi(r)$ 实现最近邻和次近邻相互作用。\n- **原子储存能**：$\\Pi^{\\mathrm{a}}(y) = \\sum_{i \\in \\mathbb{Z}} \\sum_{j \\in \\mathcal{N}_i} \\frac{1}{2}\\,\\phi(|y_j - y_i|)$，其中 $y_i$ 是当前位置，$\\mathcal{N}_i$ 是 $r_c$ 内的邻居。\n- **QC 方法**：基于能量，选择代表性原子 (repatoms)，变形在代表性原子之间是分段仿射的。\n- **QC 能量近似**：一个带有整数权重 $w_k$ 的求和规则来近似完整的原子总和。\n- **Cauchy–Born (CB) 法则**：定义了一个连续介质储存能密度 $W(F)$，使得对于均匀变形梯度 $F$，单位参考体积的原子能量等于 $W(F)$。\n- **分片检验要求**：对于任何均匀变形 $y_i = F\\,x_i$（其中 $x_i = i a_0$），QC 模型必须精确再现原子能量和力，从而导致代表性原子上的净内力为零（无伪力）。\n- **任务**：确定一种用于选择代表性原子的自适应加密策略，该策略 (i) 在剧烈变形梯度或缺陷附近提高分辨率，并且 (ii) 保持分片检验一致性。\n- **定义**：\n    - 局部维里应力：$\\sigma^{\\mathrm{vir}}$，由原子间力定义。\n    - Cauchy–Born 应力：$\\sigma^{\\mathrm{CB}}(F) = \\partial W(F)/\\partial F$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题陈述描述了计算材料科学领域中一个标准且成熟的问题，特别是在使用准连续介质 (QC) 方法进行多尺度建模方面。\n- **科学基础（关键）**：该问题坚实地基于固体力学和统计力学的原理。QC 方法、Cauchy–Born 法则、维里应力和分片检验都是该领域中标准、严格定义的概念。能量公式在物理上是正确的。该问题是科学上现实的。它不基于任何伪科学或有争议的主张。\n- **适定的**：该问题是适定的。它要求根据一套清晰的物理和数学要求，从几个选项中确定一个有效的策略。通过分析每个选项与给定原则的一致性，可以确定唯一的正确答案。\n- **客观性（关键）**：语言精确、技术性强，且没有主观或基于观点的陈述。所有术语（$\\Pi^{\\mathrm{a}}(y)$、$W(F)$、分片检验等）在该领域的背景下都有精确的数学或物理意义。\n- 该设置是自洽且一致的。它提供了评估选项所需的所有必要定义。它不是琐碎或同义反复的，因为它需要对多尺度建模的微妙之处有深刻的理解，特别是“伪力”的来源和分片检验一致性的条件。该问题与纳米力学和 QC 方法的主题直接相关。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。它在科学上是合理的、适定的、客观的和自洽的。我将继续解决该问题。\n\n### 求解推导\n问题的核心在于满足自适应 QC 方法的两个同时要求：(i) 精确的局部解析度和 (ii) 分片检验一致性。\n\n首先，我们分析分片检验要求。分片检验要求对于任何均匀变形，即位移场 $u(x) = (F-1)x$ 是线性的，变形映射 $y(x) = Fx$ 是仿射的，QC 模型必须是精确的。这意味着两件事：QC 能量必须等于完整的原子能量，并且每个代表性原子上的力必须为零（就像在完美、均匀变形的晶格中一样）。\n\n在基于能量的 QC 方法中，力是由势能 $f_k = -\\partial \\Pi^{\\mathrm{qc}} / \\partial y_k$ 推导出来的，零力条件是能量精确的直接结果。如果对于包括均匀变形在内的一系列变形，$\\Pi^{\\mathrm{qc}}(y) = \\Pi^{\\mathrm{a}}(y)$，那么它们的导数也将匹配。对于一个均匀变形的无限晶格，根据对称性，任何原子上的力都为零。因此，QC 模型必须再现这一点。由不一致的公式产生的非零力被称为“伪力”。\n\n伪力通常出现在原子区域（每个原子都是代表性原子）和连续介质区域（代表性原子稀疏分布）之间的界面处。它们是能量求和不正确的结果。具体来说，对于具有截断半径 $r_c$ 的势，连续介质区域中靠近界面的原子可能在原子区域中有邻居。如果对这些连续介质原子的能量计算没有正确地考虑 $r_c$ 半径内的所有相互作用，总能量就是错误的，从而产生虚假力。标准的补救措施是双重的：\n1.  **精确求和规则**：使用一个（如基于团簇的规则）求和规则，正确计算所有原子键，包括那些穿过由代表性原子定义的有限元边界的键。\n2.  **界面缓冲层**：在任何连续介质区域周围维持一个厚度至少为 $r_c$ 的完整原子区域（缓冲层）。这确保了任何由连续介质假设处理的原子，其完整的相互作用邻域也得到明确处理，从而防止界面处的“断键”。\n\n接下来，我们分析加密准则。目标是在连续介质近似较差的地方加密网格（即增加代表性原子）。QC 中使用的连续介质近似是 Cauchy–Born 法则。CB 法则仅对均匀变形是精确的。因此，一个好的误差指示器应该衡量对均匀变形状态的局部偏离。\n\n在梯度为 $F$ 的均匀变形状态下，原子维里应力 $\\sigma^{\\mathrm{vir}}$ 等于连续介质 Cauchy–Born 应力 $\\sigma^{\\mathrm{CB}}(F)$。也就是说，$\\sigma^{\\mathrm{vir}} - \\sigma^{\\mathrm{CB}}(F) = 0$。当变形不均匀时，如在缺陷或裂纹尖端附近，这个等式不再成立。因此，量 $\\|\\sigma^{\\mathrm{vir}}(u_h) - \\sigma^{\\mathrm{CB}}(\\nabla u_h)\\|$ 是一个优秀的、物理驱动的局部误差指示器。它直接衡量了连续介质模型基本物理假设的失效。一个大的值表明局部变形高度不均匀，不能用单个变形梯度 $F = \\nabla y_h$ 来准确描述，因此需要原子级别的分辨率。像 $\\|\\nabla(\\nabla u_h)\\|$（或 $\\|\\nabla^2 y_h\\|$）这样的项，它衡量位移场的曲率，也是一个有效的指示器，因为高曲率意味着变形梯度快速变化，但基于应力的指示器与能量学和 CB 假设的联系更直接。\n\n有了这些原则，我们就可以评估这些选项了。\n\n### 逐项分析\n\n**A. 使用基于能量的 QC 和精确求和规则，该规则计算穿过每个粗网格单元的键，从而对于任何分段仿射变形，QC 能量都等于原子能量。在每个粗网格单元 $T$ 上定义一个残差型误差指示器 $\\eta_T^2 = \\big\\|\\sigma^{\\mathrm{vir}}(u_h)\\,-\\,\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|^2\\,|T| \\;+\\; c\\,h_T^2\\,\\|\\nabla(\\nabla u_h)\\|^2$，其中 $u_h$ 是 QC 位移场，$h_T$ 是单元尺寸，$|T|$ 是单元测度，$c>0$ 是一个常数。通过插入额外的代表性原子来加密满足 $\\eta_T > \\theta_{\\mathrm{ref}}\\max_{K}\\eta_K$ 的单元，粗化满足 $\\eta_T  \\theta_{\\mathrm{crs}}\\max_{K}\\eta_K$ 的单元，并通过在缺陷周围和原子-连续介质边界上维持一个厚度至少为 $r_c$ 的原子缓冲层来强制执行一个考虑相互作用的界面。在每次网格变化后，保留分段仿射运动学和精确求和规则。**\n\n-   **分片检验一致性**：该策略明确使用“精确求和规则”并维持一个“厚度至少为 $r_c$ 的原子缓冲层”。如上所述，这种组合正是消除伪力并确保即使在自适应之后分片检验始终通过所需要的。\n-   **加密准则**：指示器 $\\eta_T$ 有两个组成部分。主要组成部分 $\\big\\|\\sigma^{\\mathrm{vir}}(u_h)\\,-\\,\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|$ 是对 Cauchy-Born 近似局部失效的直接物理度量，这正是指示器所期望的行为。它在缺陷和剧烈梯度附近会很大。第二项 $c\\,h_T^2\\,\\|\\nabla(\\nabla u_h)\\|^2$ 是数值分析中的一个标准项，它惩罚高曲率，也表明存在剧烈梯度。这种双项指示器是鲁棒且理由充分的。\n-   **结论**：该选项为自适应 QC 提供了一个完整且正确的框架。它正确地解决了分片检验一致性和需要一个物理驱动的加密指示器的问题。\n\n**结论：正确**\n\n**B. 使用基于力的 QC，在原子力和连续介质力之间进行线性混合。取每个单元的指示器为 $\\eta_T = \\|\\nabla u_h\\|$，并在 $\\eta_T > \\theta_{\\mathrm{ref}}\\max_K \\eta_K$ 的地方进行加密。对于求和，每个单元采样一个代表性原子，其权重等于该单元的原子数（集总求积）。不强制执行任何特殊的界面缓冲层；允许代表性原子的间距在原子-连续介质界面上突然改变。**\n\n-   **分片检验一致性**：该策略在分片检验方面有两个致命缺陷。首先，对于非局域相互作用，“集总求积”（每个单元一个采样点）已知无法通过分片检验，因为它不能正确计算均匀变形状态的能量。其次，更关键的是，它明确指出“不强制执行任何特殊的界面缓冲层”。没有大小为 $r_c$ 的缓冲层，跨越原子/连续介质界面的相互作用就无法正确计算，导致产生巨大的伪力。力混合方案也是众所周知的难以实现分片检验一致性，除非经过精心构建，而这里并未描述。\n-   **加密准则**：指示器 $\\eta_T = \\|\\nabla u_h\\|$ 是局部应变大小。虽然大应变通常与需要加密相关，但它并不是连续介质模型*误差*的直接度量。如果变形是均匀的，即使应变很大，CB 近似也可能有效。这个指示器不如选项 A 中的复杂和可靠。\n-   **结论**：该选项未能满足保持分片检验一致性的关键要求。\n\n**结论：不正确**\n\n**C. 使用基于能量的 QC，在所有地方都采用 Cauchy–Born 能量密度，没有原子区域。设指示器为 $\\eta_T = \\|\\nabla(\\nabla u_h)\\|$。在 $\\eta_T$ 较大的地方进行加密，否则保持粗网格。对连续介质能量使用标准高斯求积，不使用基于键的精确求和。在缺陷附近不使用特殊处理。**\n\n-   **方法论**：这描述了一种使用 CB 推导的本构模型的纯粹的非线性有限元方法 (FEM)。它不是一个多尺度 QC 方法，因为它“没有原子区域”。自适应 QC 的全部目的就是在连续介质模型（即 CB 法则）失效的地方引入原子分辨率，例如在缺陷核心处。这种方法做不到这一点；它假设 CB 法则在任何地方都有效，这对于有缺陷的问题是错误的。\n-   **分片检验一致性**：使用 CB 能量密度的纯 FEM 模型通过构造会通过分片检验，但这无关紧要，因为它不是针对所述问题的正确模型类型。\n-   **加密准则**：指示器 $\\|\\nabla(\\nabla u_h)\\|$ 会触发网格加密（创建更小的有限元），但不会切换到更基础的原子模型。\n-   **结论**：这不是一种能够模拟缺陷的自适应准连续介质方法。它未能满足用原子模型局部提高分辨率的基本要求。\n\n**结论：不正确**\n\n**D. 使用基于能量的 QC 和精确求和规则，以及指示器 $\\eta_T = \\big\\|\\sigma^{\\mathrm{vir}}(u_h)-\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|$。在 $\\eta_T$ 较大时进行加密，但当 $\\eta_T$ 低于阈值时，允许粗化以将原子缓冲层消除至零厚度，即使范围为 $r_c$ 的相互作用跨越了界面。保持运动学为分段仿射，并且仅按单元体积更新权重。**\n\n-   **分片检验一致性**：该选项提议“将原子缓冲层粗化至零厚度……即使范围为 $r_c$ 的相互作用跨越了界面”。这直接违反了分片检验一致性所需的条件。一旦缓冲层被移除，新形成的尖锐界面处的原子将具有不完整的相互作用邻域，它们的能量将被错误计算，并产生显著的伪力。分片检验将失败。关于“仅按单元体积更新权重”的说法也表明在粗化时偏离了“精确求和规则”，这是另一个误差来源。\n-   **加密准则**：指示器 $\\eta_T$ 是物理上正确的、基于应力的指示器。然而，一个好的指示器无法挽救一个根本上不一致的方法。\n-   **结论**：尽管加密指示器选择得很好，但粗化策略和界面处理是不正确的，会重新引入该方法本应消除的伪力，从而未能满足分片检验一致性要求。\n\n**结论：不正确**\n\n基于此分析，只有选项 A 描述了一个理论上合理且完整的自适应准连续介质策略，满足两个既定要求。", "answer": "$$\\boxed{A}$$", "id": "2780409"}]}