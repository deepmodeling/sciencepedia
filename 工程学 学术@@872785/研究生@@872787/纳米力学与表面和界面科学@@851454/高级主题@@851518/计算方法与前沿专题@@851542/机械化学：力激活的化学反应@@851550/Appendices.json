{"hands_on_practices": [{"introduction": "这项实践是理解力激活反应的基础。我们将运用经典的贝尔(Bell)模型，来计算为了使一个力敏化学反应的速率提高一个数量级，需要施加多大的拉力。这个练习能够帮助你直观地理解外力 $F$、过渡态距离 $x^\\ddagger$ 与热能 $k_B T$ 之间的定量关系，这是分析所有力化学系统的基础。[@problem_id:2778944]", "problem": "一个螺环吡喃力致变色分子共价嵌入到聚合物主链中，在单分子拉伸过程中沿链轴方向受到一个恒定的拉伸力。从头算约束计算得出，从反应物势阱到过渡态的距离在拉伸坐标上的标量投影为 $x^{\\ddagger} = 0.18\\,\\text{nm}$。假设在恒定外力作用下，开环反应的活化自由能因沿反应坐标所做的机械功而降低，并且过渡态理论中的指前因子不受力的影响。使用过渡态理论 (TST) 以及外力与反应坐标线性耦合的假设，确定在温度 $T=298\\,\\text{K}$ 时，使开环速率增加 $10$ 倍所需的拉伸力的大小。\n\n将最终答案以纳牛顿 (nN) 为单位表示为一个数字。将您的答案四舍五入到四位有效数字。\n\n使用玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$。您可以假设力的方向与反应坐标完全对齐。", "solution": "在尝试任何解答之前，需对问题进行验证。\n\n**步骤1：提取已知条件**\n- **体系：** 一个共价嵌入聚合物主链的螺环吡喃力致变色分子。\n- **过程：** 在单分子拉伸过程中受到恒定的拉伸力 $F$。\n- **参数：** 从反应物势阱到过渡态的距离在拉伸坐标上的标量投影为 $x^{\\ddagger} = 0.18\\,\\text{nm}$。\n- **假设1：** 开环反应的活化自由能因沿反应坐标所做的机械功而降低。\n- **假设2：** 过渡态理论中的指前因子不受力的影响。\n- **理论框架：** 过渡态理论 (TST)。\n- **假设3：** 施加的力与反应坐标线性耦合。\n- **目标：** 使开环速率增加 $10$ 倍。\n- **条件：** 温度 $T=298\\,\\text{K}$。\n- **常数：** 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$。\n- **假设4：** 力的方向与反应坐标完全对齐。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。它描述了机械化学中的一个典型问题：力致变色分子（螺环吡喃）的力依赖动力学。使用过渡态理论，并结合 Bell 模型（力与反应坐标的线性耦合），是分析此类系统的标准且广为接受的一阶近似方法。所提供的数据，如反应坐标距离 $x^{\\ddagger}$ 和温度 $T$，对于单分子力谱实验是物理上现实的。问题提法得当，提供了足够的信息来确定力 $F$ 的唯一解。语言客观而精确。问题没有科学谬误、模糊不清和内部矛盾。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供解答。\n\n根据过渡态理论 (TST)，化学反应的速率由艾林方程描述。速率常数 $k$ 由下式给出：\n$$k = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{k_B T}\\right)$$\n其中 $A$ 是指前因子（包括诸如 $\\frac{k_B T}{h}$ 和振动配分函数等项），$\\Delta G^{\\ddagger}$ 是吉布斯活化自由能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。问题陈述，$A$ 是一个常数，不受外力影响。\n\n在没有外力的情况下，速率常数表示为 $k(0)$：\n$$k(0) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(0)}{k_B T}\\right)$$\n其中 $\\Delta G^{\\ddagger}(0)$ 是零力时的活化自由能。\n\n当施加恒定的拉伸力 $F$ 时，问题陈述活化能垒会因所做的机械功而降低。如题所述，假设力与反应坐标之间存在线性耦合，则力依赖的活化能 $\\Delta G^{\\ddagger}(F)$ 由 Bell 模型给出：\n$$\\Delta G^{\\ddagger}(F) = \\Delta G^{\\ddagger}(0) - F x^{\\ddagger}$$\n此处，$x^{\\ddagger}$ 是沿反应坐标到过渡态的距离。功项 $F x^{\\ddagger}$ 降低了能垒的高度。\n\n因此，存在力的情况下，速率常数 $k(F)$ 为：\n$$k(F) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(F)}{k_B T}\\right) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(0) - F x^{\\ddagger}}{k_B T}\\right)$$\n这可以重写为：\n$$k(F) = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(0)}{k_B T}\\right) \\exp\\left(\\frac{F x^{\\ddagger}}{k_B T}\\right)$$\n认识到表达式的第一部分是 $k(0)$，我们有：\n$$k(F) = k(0) \\exp\\left(\\frac{F x^{\\ddagger}}{k_B T}\\right)$$\n问题要求找到导致反应速率增加 $10$ 倍的力 $F$。这对应于条件：\n$$\\frac{k(F)}{k(0)} = 10$$\n代入我们推导出的速率比表达式：\n$$10 = \\exp\\left(\\frac{F x^{\\ddagger}}{k_B T}\\right)$$\n为了求解 $F$，我们对等式两边取自然对数：\n$$\\ln(10) = \\frac{F x^{\\ddagger}}{k_B T}$$\n分离出 $F$ 得到所需力的符号表达式：\n$$F = \\frac{k_B T \\ln(10)}{x^{\\ddagger}}$$\n现在，我们将给定的数值代入此表达式。单位必须一致（国际单位制单位）。\n已知：\n- $k_B = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$\n- $T = 298\\,\\text{K}$\n- $x^{\\ddagger} = 0.18\\,\\text{nm} = 0.18 \\times 10^{-9}\\,\\text{m}$\n\n首先，我们计算热能 $k_B T$：\n$$k_B T = (1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}) \\times (298\\,\\text{K}) \\approx 4.114334 \\times 10^{-21}\\,\\text{J}$$\n现在，我们计算力 $F$：\n$$F = \\frac{(4.114334 \\times 10^{-21}\\,\\text{J}) \\times \\ln(10)}{0.18 \\times 10^{-9}\\,\\text{m}}$$\n使用值 $\\ln(10) \\approx 2.302585$:\n$$F \\approx \\frac{(4.114334 \\times 10^{-21}) \\times 2.302585}{0.18 \\times 10^{-9}}\\,\\text{N}$$\n$$F \\approx \\frac{9.47346 \\times 10^{-21}}{1.8 \\times 10^{-10}}\\,\\text{N}$$\n$$F \\approx 5.26303 \\times 10^{-11}\\,\\text{N}$$\n问题要求答案以纳牛顿 (nN) 为单位。我们进行单位转换：\n$$1\\,\\text{nN} = 10^{-9}\\,\\text{N}, \\text{所以 } 1\\,\\text{N} = 10^9\\,\\text{nN}$$\n$$F \\approx (5.26303 \\times 10^{-11}\\,\\text{N}) \\times (10^9\\,\\text{nN}/\\text{N})$$\n$$F \\approx 5.26303 \\times 10^{-2}\\,\\text{nN}$$\n$$F \\approx 0.0526303\\,\\text{nN}$$\n将结果四舍五入到四位有效数字，得到 $0.05263\\,\\text{nN}$。", "answer": "$$\\boxed{0.05263}$$", "id": "2778944"}, {"introduction": "真实的力化学过程往往涉及多个步骤，而不仅仅是越过一个能垒。本练习将引导你分析一个更实际的场景：一个两步串联反应，其中熵驱动的构象变化先于化学键的断裂。通过这个模型，你将推导出系统的表观过渡态距离 $x_{\\text{eff}}^\\ddagger$ 是如何由各步骤的速率动态决定的，并理解反应的限速步骤如何随外力而改变。[@problem_id:2778947]", "problem": "在动态力谱 (DFS) 实验中，一个共价力致变色团键在张力下发生断裂之前，必须先打开一个单个的聚合物环。DFS 测量在绝对温度 $T$ 下的恒力系综中进行。该动力学过程包含两个不可逆的连续步骤，伴随着一个短寿命的中间体和可忽略的逆向速率：(1) 熵致环打开 和 (2) 键断裂。观测速率受限于总平均首过时间。施加的力为 $f$。\n\n将熵致环打开的过程建模为在力 $f$ 的作用下，从蠕虫状链 (WLC) 中释放出一段轮廓长度 $\\Delta L$。在高力 WLC 区间（即 $f \\ell_p \\gg k_B T$），在恒定力 $f$ 下，单位轮廓长度的伸长量 $\\xi(f)$ 可近似表示为\n$$\n\\xi(f) \\approx 1 - \\frac{1}{2} \\left(\\frac{k_B T}{f \\,\\ell_p}\\right)^{1/2},\n$$\n其中 $\\ell_p$ 是持久长度， $k_B$ 是玻尔兹曼常数。将熵致打开步骤到过渡态的距离视为在力 $f$ 下释放 $\\Delta L$ 所获得的机械伸长量，即 $x_e(f) = \\xi(f)\\,\\Delta L$。将键断裂步骤视为一个具有与力无关的过渡态距离 $x_b$ 的能垒。\n\n对每个正向步骤采用过渡态理论和 Kramers-Bell 力激活模型：对于第 $i$ 步，其活化自由能为 $\\Delta G_i^{\\ddagger}(f)$，则 $k_i(f) \\propto \\exp\\!\\left[-\\beta \\Delta G_i^{\\ddagger}(f)\\right]$ 且 $\\frac{d}{df}\\ln k_i(f) = \\beta\\,x_i^{\\ddagger}(f)$，其中 $\\beta = 1/(k_B T)$，$x_i^{\\ddagger}(f) = -\\frac{\\partial \\Delta G_i^{\\ddagger}}{\\partial f}$ 是到过渡态的机械投影距离。设零力下的正向速率为 $k_1(0) = k_1^0$ 和 $k_2(0) = k_2^0$。\n\n仅基于以上基础，推导在 DFS 中可以从 $\\ln k_{\\text{eff}}(f)$ 相对于 $f$ 的斜率推断出的有效过渡态距离 $x_{\\text{eff}}^{\\ddagger}(f)$ 的表达式，其中 $k_{\\text{eff}}(f)$ 是该两步序列观测到的总正向速率。然后，在以下指定条件下对 $x_{\\text{eff}}^{\\ddagger}(f)$ 进行数值计算：\n- $T = 298\\,\\text{K}$,\n- $\\ell_p = 0.80\\,\\text{nm}$,\n- $\\Delta L = 1.00\\,\\text{nm}$,\n- $x_b = 0.25\\,\\text{nm}$,\n- $f = 20.0\\,\\text{pN}$,\n- $k_1^0 = 1.0\\,\\text{s}^{-1}$,\n- $k_2^0 = 1.0\\,\\text{s}^{-1}$.\n\n以纳米为单位表示 $x_{\\text{eff}}^{\\ddagger}$ 的最终答案，并四舍五入到三位有效数字。", "solution": "该问题要求推导在施加力 $f$ 的条件下，一个两步连续化学反应的有效过渡态距离 $x_{\\text{eff}}^{\\ddagger}(f)$。总过程由方案 $A \\xrightarrow{k_1(f)} I \\xrightarrow{k_2(f)} P$ 描述，其中两个步骤都是不可逆的。总速率 $k_{\\text{eff}}(f)$ 由总平均首过时间决定。\n\n对于一个由两个不可逆一级步骤组成的序列，总平均时间 $\\tau_{\\text{eff}}$ 是每一步的平均时间 $\\tau_1$ 和 $\\tau_2$ 的和。对于速率常数为 $k$ 的单个不可逆步骤，其平均时间为 $\\tau = 1/k$。因此，\n$$\n\\tau_{\\text{eff}}(f) = \\tau_1(f) + \\tau_2(f) = \\frac{1}{k_1(f)} + \\frac{1}{k_2(f)}\n$$\n有效速率常数 $k_{\\text{eff}}(f)$ 是总平均时间的倒数：\n$$\nk_{\\text{eff}}(f) = \\frac{1}{\\tau_{\\text{eff}}(f)} = \\left(\\frac{1}{k_1(f)} + \\frac{1}{k_2(f)}\\right)^{-1} = \\frac{k_1(f) k_2(f)}{k_1(f) + k_2(f)}\n$$\n有效过渡态距离 $x_{\\text{eff}}^{\\ddagger}(f)$ 由有效速率常数的力敏感性定义，这类似于 Bell 模型：\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{1}{\\beta} \\frac{d}{df} \\ln k_{\\text{eff}}(f)\n$$\n其中 $\\beta = 1/(k_B T)$。我们首先求出 $\\frac{d}{df} \\ln k_{\\text{eff}}(f)$ 的表达式。对 $k_{\\text{eff}}(f)$ 取自然对数：\n$$\n\\ln k_{\\text{eff}}(f) = \\ln(k_1(f)) + \\ln(k_2(f)) - \\ln(k_1(f) + k_2(f))\n$$\n对力 $f$ 求导：\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\frac{d}{df} \\ln k_1 + \\frac{d}{df} \\ln k_2 - \\frac{1}{k_1 + k_2} \\left( \\frac{dk_1}{df} + \\frac{dk_2}{df} \\right)\n$$\n使用恒等式 $\\frac{dk_i}{df} = k_i \\frac{d}{df} \\ln k_i$：\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\frac{d}{df} \\ln k_1 + \\frac{d}{df} \\ln k_2 - \\frac{1}{k_1 + k_2} \\left( k_1 \\frac{d}{df} \\ln k_1 + k_2 \\frac{d}{df} \\ln k_2 \\right)\n$$\n合并同类项：\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\left(1 - \\frac{k_1}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_1 + \\left(1 - \\frac{k_2}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_2\n$$\n$$\n\\frac{d}{df} \\ln k_{\\text{eff}} = \\left(\\frac{k_2}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_1 + \\left(\\frac{k_1}{k_1 + k_2}\\right) \\frac{d}{df} \\ln k_2\n$$\n问题将单个过渡态距离定义为 $x_i^{\\ddagger}(f) = \\frac{1}{\\beta} \\frac{d}{df} \\ln k_i(f)$。将此代入 $\\frac{d}{df} \\ln k_{\\text{eff}}$ 的表达式中，得到：\n$$\n\\beta x_{\\text{eff}}^{\\ddagger}(f) = \\left(\\frac{k_2(f)}{k_1(f) + k_2(f)}\\right) \\beta x_1^{\\ddagger}(f) + \\left(\\frac{k_1(f)}{k_1(f) + k_2(f)}\\right) \\beta x_2^{\\ddagger}(f)\n$$\n消去 $\\beta$，我们得到有效过渡态距离的通用表达式：\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{k_2(f)}{k_1(f) + k_2(f)} x_1^{\\ddagger}(f) + \\frac{k_1(f)}{k_1(f) + k_2(f)} x_2^{\\ddagger}(f)\n$$\n这表明 $x_{\\text{eff}}^{\\ddagger}(f)$ 是单个距离 $x_1^{\\ddagger}(f)$ 和 $x_2^{\\ddagger}(f)$ 的加权平均值，其中权重取决于在力 $f$ 下速率常数的相对大小。\n\n为了对该表达式进行数值计算，我们必须首先在指定条件下求出 $k_1(f)$、$k_2(f)$ 和 $x_1^{\\ddagger}(f)$。\n第 1 步（熵致环打开）的过渡态距离与力相关：\n$$\nx_1^{\\ddagger}(f) = x_e(f) = \\xi(f)\\,\\Delta L = \\left(1 - \\frac{1}{2} \\left(\\frac{k_B T}{f \\,\\ell_p}\\right)^{1/2}\\right) \\Delta L\n$$\n第 2 步（键断裂）的过渡态距离是恒定的：\n$$\nx_2^{\\ddagger}(f) = x_b\n$$\n通过对其力依赖性从 $f=0$ 开始积分来求得速率常数：\n$k_i(f) = k_i^0 \\exp\\left(\\beta \\int_0^f x_i^{\\ddagger}(f') df'\\right)$。\n对于第 2 步：$\\int_0^f x_b df' = x_b f$。因此，$k_2(f) = k_2^0 \\exp(\\beta f x_b)$。\n对于第 1 步：$\\int_0^f x_1^{\\ddagger}(f') df' = \\int_0^f \\Delta L \\left(1 - \\frac{1}{2} \\sqrt{\\frac{k_B T}{\\ell_p}} (f')^{-1/2} \\right) df' = \\left[ \\Delta L f' - \\Delta L \\sqrt{\\frac{k_B T}{\\ell_p}} (f')^{1/2} \\right]_0^f = \\Delta L f - \\Delta L \\sqrt{\\frac{k_B T f}{\\ell_p}}$。\n所以，$k_1(f) = k_1^0 \\exp\\left(\\beta \\left( \\Delta L f - \\Delta L \\sqrt{\\frac{k_B T f}{\\ell_p}} \\right)\\right)$。\n\n现在，我们使用给定的值进行数值计算：\n$T = 298\\,\\text{K}$，$\\ell_p = 0.80\\,\\text{nm} = 0.80 \\times 10^{-9}\\,\\text{m}$，$\\Delta L = 1.00\\,\\text{nm} = 1.00 \\times 10^{-9}\\,\\text{m}$， $x_b = 0.25\\,\\text{nm} = 0.25 \\times 10^{-9}\\,\\text{m}$， $f = 20.0\\,\\text{pN} = 20.0 \\times 10^{-12}\\,\\text{N}$， $k_1^0 = 1.0\\,\\text{s}^{-1}$， $k_2^0 = 1.0\\,\\text{s}^{-1}$。\n设 $k_B = 1.3806 \\times 10^{-23}\\,\\text{J/K}$。\n热能为 $k_B T = (1.3806 \\times 10^{-23}\\,\\text{J/K})(298\\,\\text{K}) \\approx 4.114 \\times 10^{-21}\\,\\text{J}$。\n热能的倒数为 $\\beta = 1/(k_B T) \\approx 2.4307 \\times 10^{20}\\,\\text{J}^{-1}$。\n\n首先，计算 $x_1^{\\ddagger}(f)$：\n项 $f \\ell_p = (20.0 \\times 10^{-12}\\,\\text{N})(0.80 \\times 10^{-9}\\,\\text{m}) = 1.6 \\times 10^{-20}\\,\\text{J}$。\n$$\nx_1^{\\ddagger}(f) = \\left(1 - \\frac{1}{2} \\sqrt{\\frac{4.114 \\times 10^{-21}\\,\\text{J}}{1.6 \\times 10^{-20}\\,\\text{J}}}\\right) (1.00\\,\\text{nm}) = \\left(1 - \\frac{1}{2} \\sqrt{0.2571}\\right) (1.00\\,\\text{nm}) \\approx (1 - 0.2535) (1.00\\,\\text{nm}) = 0.7465\\,\\text{nm}\n$$\n接下来，计算 $k_2(f)$：\n指数为 $\\beta f x_b = (2.4307 \\times 10^{20}\\,\\text{J}^{-1})(20.0 \\times 10^{-12}\\,\\text{N})(0.25 \\times 10^{-9}\\,\\text{m}) \\approx 1.215$。\n$$\nk_2(f) = (1.0\\,\\text{s}^{-1}) \\exp(1.215) \\approx 3.370\\,\\text{s}^{-1}\n$$\n接下来，计算 $k_1(f)$：\n指数为 $\\beta \\left( \\Delta L f - \\Delta L \\sqrt{\\frac{k_B T f}{\\ell_p}} \\right) = \\beta \\Delta L f \\left(1 - \\sqrt{\\frac{k_B T}{f \\ell_p}}\\right)$。\n项 $\\beta \\Delta L f = (2.4307 \\times 10^{20}\\,\\text{J}^{-1})(1.00 \\times 10^{-9}\\,\\text{m})(20.0 \\times 10^{-12}\\,\\text{N}) \\approx 4.861$。\n项 $\\sqrt{k_B T/(f \\ell_p)} \\approx \\sqrt{0.2571} \\approx 0.5071$。\n指数为 $4.861(1 - 0.5071) \\approx 4.861 \\times 0.4929 \\approx 2.396$。\n$$\nk_1(f) = (1.0\\,\\text{s}^{-1}) \\exp(2.396) \\approx 10.98\\,\\text{s}^{-1}\n$$\n最后，将这些值代入 $x_{\\text{eff}}^{\\ddagger}(f)$ 的表达式中：\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{3.370\\,\\text{s}^{-1}}{10.98\\,\\text{s}^{-1} + 3.370\\,\\text{s}^{-1}} (0.7465\\,\\text{nm}) + \\frac{10.98\\,\\text{s}^{-1}}{10.98\\,\\text{s}^{-1} + 3.370\\,\\text{s}^{-1}} (0.25\\,\\text{nm})\n$$\n$$\nx_{\\text{eff}}^{\\ddagger}(f) = \\frac{3.370}{14.35} (0.7465\\,\\text{nm}) + \\frac{10.98}{14.35} (0.25\\,\\text{nm})\n$$\n$$\nx_{\\text{eff}}^{\\ddagger}(f) \\approx (0.2348)(0.7465\\,\\text{nm}) + (0.7652)(0.25\\,\\text{nm})\n$$\n$$\nx_{\\text{eff}}^{\\ddagger}(f) \\approx 0.1753\\,\\text{nm} + 0.1913\\,\\text{nm} \\approx 0.3666\\,\\text{nm}\n$$\n四舍五入到三位有效数字，有效过渡态距离为 $0.367\\,\\text{nm}$。", "answer": "$$\\boxed{0.367}$$", "id": "2778947"}, {"introduction": "贝尔等解析模型是对真实分子势能面的近似，但这些近似在何种情况下会失效？本计算练习将带领你探索这个问题，通过分析一个模拟的、由第一性原理计算（如DFT）得出的势能面来提取力依赖的能垒。你将有机会比较贝尔模型和更精确的Dudko-Hummer-Szabo (DHS) 模型，并学习如何通过量化指标来诊断力是否改变了能垒的“形状”，而不仅仅是它的高度。[@problem_id:2778981]", "problem": "考虑一个环丁烷力敏团在外部施加的拉伸力作用下发生开环反应的单坐标力化学模型。内部反应坐标是二面角 $\\theta$（单位为弧度），沿拉伸轴的外部耦合分子伸长量为 $x(\\theta)$（单位为纳米）。无外力势能曲线 $U_0(\\theta)$（单位为千焦/摩尔）模拟了约束密度泛函理论 (DFT) 扫描；在恒定外力 $F$（单位为纳牛顿）作用下，总势能为\n$$\nU_F(\\theta) = U_0(\\theta) - F\\,x(\\theta)\\,C,\n$$\n其中 $C$ 是将纳牛顿-纳米转换为千焦/摩尔的转换因子。使用恒等式 $1\\,\\mathrm{nN}\\cdot\\mathrm{nm} = 10^{-18}\\,\\mathrm{J}$ 和阿伏伽德罗常数 $N_\\mathrm{A} = 6.02214076\\times 10^{23}\\,\\mathrm{mol}^{-1}$，我们得到\n$$\nC = \\frac{N_\\mathrm{A}\\times 10^{-18}\\,\\mathrm{J}}{10^{3}\\,\\mathrm{J/kJ}} \\approx 6.02214076 \\times 10^{2}\\,\\mathrm{kJ/mol}.\n$$\n\n您的任务是从 $U_F(\\theta)$ 中通过算法提取依赖于力的势垒高度 $\\Delta G(F)$，并将其与两种经典的力激活势垒降低模型进行比较，以诊断势垒形状的变化：\n\n- Bell 模型：势垒根据力的作用呈线性降低\n$$\n\\Delta G_{\\mathrm{Bell}}(F) = \\Delta G_0 - F\\,\\Delta x_0\\,C,\n$$\n其中 $\\Delta G_0$ 是零力势垒，$\\Delta x_0$ 是零力下反应物最小值与过渡态之间沿 $x(\\theta)$ 的投影距离。\n\n- Dudko–Hummer–Szabo (DHS) 模型：对于形状参数 $\\nu \\in \\{1/2,\\,2/3\\}$，分别对应于尖峰状和线性-立方状势垒，预测的力依赖势垒为\n$$\n\\Delta G_{\\mathrm{DHS}}(F;\\nu) = \\Delta G_0\\left(1 - \\nu\\,\\frac{F\\,\\Delta x_0\\,C}{\\Delta G_0}\\right)^{1/\\nu},\n$$\n在 $0 \\le F  \\frac{\\Delta G_0}{\\nu\\,\\Delta x_0\\,C}$ 时有效，当括号内的表达式不为正时取值为 $0$。\n\n您的推导应基于以下原则：\n- 恒力下的总势能为 $U_F(\\theta)=U_0(\\theta)-F\\,x(\\theta)\\,C$。\n- 势垒高度 $\\Delta G(F)$ 是沿递增的 $\\theta$ 方向，反应物盆地最小值之后的第一个过渡态（局部最大值）处的 $U_F(\\theta)$ 值与该最小值处的 $U_F(\\theta)$ 值之差。\n- 反应物盆地最小值是参考角 $\\theta_m$ 附近的局部最小值，该参考角表征了约束 DFT 扫描的对齐方式。\n\n为模拟三种不同情况下的约束 DFT 扫描，我们为您提供了 $U_0(\\theta)$ 和 $x(\\theta)$ 的参数化形式。对于每种情况，无力能量曲线和伸长映射定义为\n$$\nU_0(\\theta) = A_1\\big(1-\\cos(\\theta-\\theta_m)\\big) + A_2\\big(1-\\cos(2(\\theta-\\theta_m))\\big) + A_3\\big(1-\\cos(3(\\theta-\\theta_m))\\big),\n$$\n$$\nx(\\theta) = r_0\\big(1-\\cos(\\theta-\\theta_m)\\big) + r_1\\sin^2(\\theta-\\theta_m),\n$$\n其中 $\\theta \\in [0,\\pi]$，单位为弧度。\n\n您必须：\n1. 对每种情况和每个指定的力 $F$，通过以下步骤计算 $\\Delta G(F)$：\n   - 将最接近 $\\theta_m$ 的 $U_F(\\theta)$ 的局部最小值确定为反应物最小值 $\\theta_\\mathrm{min}(F)$。\n   - 将 $\\theta^\\ddagger(F)  \\theta_\\mathrm{min}(F)$ 的第一个 $U_F(\\theta)$ 的局部最大值确定为第一个过渡态 $\\theta^\\ddagger(F)$。\n   - 当势垒存在时，设 $\\Delta G(F) = \\max\\{U_F(\\theta^\\ddagger(F)) - U_F(\\theta_\\mathrm{min}(F)),\\,0\\}$，且 $\\Delta x^\\ddagger(F) = x(\\theta^\\ddagger(F)) - x(\\theta_\\mathrm{min}(F))$；否则取 $\\Delta x^\\ddagger(F)=0$。\n2. 对每种情况，计算 $F=0$ 时的 $\\Delta G_0$ 和 $\\Delta x_0$。\n3. 对每种情况，使用步骤2中提取的 $\\Delta G_0$ 和 $\\Delta x_0$，在相同的 $F$ 值集合上计算 Bell 和 DHS 模型的预测值。\n4. 通过计算的 $\\Delta G(F)$ 与每个模型在非零力上的预测值之间的均方根误差 (RMSE) 来量化模型的一致性：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(\\Delta G(F_i) - \\Delta G_{\\mathrm{model}}(F_i)\\right)^2},\n$$\n其中 $F_1,\\dots,F_N$ 是测试套件中的非零力。\n5. 如果以下两个条件都成立，则判定该情况发生了势垒形状变化：\n   - 在集合 $\\{\\mathrm{Bell},\\,\\mathrm{DHS}(\\nu=1/2),\\,\\mathrm{DHS}(\\nu=2/3)\\}$ 中，最佳拟合模型（最小 RMSE）不是 Bell 模型，并且 Bell 模型的 RMSE 超过最佳 RMSE 至少 1.5 倍。\n   - 有效投影距离随力显著变化：设 $\\mathcal{S}=\\{\\Delta x^\\ddagger(F_i) : \\Delta G(F_i)0 \\text{ and } F_i0 \\}$，那么如果 $\\mathcal{S}$ 非空，则要求\n$$\n\\frac{\\max(\\mathcal{S}) - \\min(\\mathcal{S})}{\\max(\\Delta x_0,\\,\\varepsilon)} \\ge 0.1,\n$$\n其中 $\\varepsilon = 10^{-9}$ 纳米以保证数值稳定性；如果 $\\mathcal{S}$ 为空，则不标记形状变化。\n\n角度单位要求：所有角度必须以弧度处理。力必须以纳牛顿为单位。能量差必须在内部报告并以千焦/摩尔为单位进行比较。距离必须以纳米为单位。\n\n测试套件（三种情况；使用通用力集合 $F \\in \\{0.00, 0.05, 0.15, 0.30, 0.45\\}$，单位为纳牛顿）：\n- 情况1（中度非谐，弱耦合）：$A_1=30$，$A_2=40$，$A_3=5$（单位均为千焦/摩尔）；$r_0=0.12$，$r_1=0.02$（单位均为纳米）；$\\theta_m=0.60$（弧度）。\n- 情况2（不对称，强耦合）：$A_1=40$，$A_2=60$，$A_3=20$；$r_0=0.18$，$r_1=0.06$；$\\theta_m=0.50$。\n- 情况3（较浅势垒，接近力致势垒消失）：$A_1=10$，$A_2=15$，$A_3=5$；$r_0=0.15$，$r_1=0.03$；$\\theta_m=0.70$。\n\n最终输出格式：\n- 对于每种情况，输出一个包含两个整数 $[m, s]$ 的子列表：\n  - $m$ 是根据非零力上的 RMSE 得到的最佳模型的索引：$m=0$ 代表 Bell 模型，$m=1$ 代表 $\\nu=1/2$ 的 DHS 模型，$m=2$ 代表 $\\nu=2/3$ 的 DHS 模型。\n  - 如果根据上述标准识别出势垒形状变化，则 $s$ 为 $1$，否则为 $0$。\n- 您的程序应生成单行输出，其中包含这些子列表的逗号分隔列表，并用方括号括起来，例如 $[[2,1],[0,0],[1,1]]$。\n\n约束和实现细节：\n- 在 $\\theta \\in [0,\\pi]$ 上使用足够精细的均匀网格，以稳健地检测局部最小值和最大值。\n- 通过数值导数 $dU_F/d\\theta$ 的符号变化来识别局部最小值和最大值。\n- 始终选择最接近 $\\theta_m$ 的局部最小值作为反应物最小值。\n- 当反应物最小值的右侧不存在局部最大值时，对于该力，将势垒取为 $0$。\n- 所有数值计算必须是自包含的，没有外部输入。\n\n您的程序必须是一个完整的、可运行的实现，它为提供的测试套件执行这些步骤，并以指定的确切格式打印最终列表。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在理论力化学领域提出了一个定义明确的计算练习，其基础是已建立的物理原理。它是自包含的、客观的、科学上合理的，所有参数和程序都得到了明确的规定。其目标是分析一个力激活化学反应的参数模型，并根据经典理论诊断其行为。我们将继续进行解答。\n\n问题的核心是分析单一反应坐标 $\\theta$ 的势能面 $U_F(\\theta) = U_0(\\theta) - F\\,x(\\theta)\\,C$。该分析涉及定位反应物态最小值和随后的过渡态，以确定作为外施力 $F$ 函数的活化能垒 $\\Delta G(F)$。\n\n计算过程实现如下：\n\n1.  **离散化与势能面映射**：连续的反应坐标 $\\theta$ 在其定义域 $\\theta \\in [0, \\pi]$ 上被离散化为一个精细的均匀网格。这使得函数 $U_0(\\theta)$、$x(\\theta)$ 以及因此的 $U_F(\\theta)$ 可以表示为数值数组。选择足够多的网格点以确保势能面的所有相关特征都得到解析。\n\n2.  **定位驻点**：通过分析势能面 $U_F(\\theta)$ 的数值导数 $\\frac{dU_F}{d\\theta}$ 来识别其局部最小值和最大值。具体来说，我们计算势能数组的一阶有限差分。导数符号从负到正的变化表示局部最小值，而从正到负的变化表示局部最大值。该方法能够稳健地识别离散网格上的所有驻点。\n\n3.  **提取势垒参数**：对于给定集合中的每个力值 $F$，我们执行以下步骤：\n    - 反应物态最小值 $\\theta_{\\mathrm{min}}(F)$ 被确定为 $U_F(\\theta)$ 曲面上其坐标 $\\theta$ 最接近每种情况下给出的参考角 $\\theta_m$ 的局部最小值。\n    - 相关的过渡态 $\\theta^\\ddagger(F)$ 被确定为在角度 $\\theta > \\theta_{\\mathrm{min}}(F)$ 处出现的第一个局部最大值。\n    - 如果存在这样的过渡态，则力依赖的活化势垒计算为 $\\Delta G(F) = U_F(\\theta^\\ddagger(F)) - U_F(\\theta_{\\mathrm{min}}(F))$。相应的投影距离是 $\\Delta x^\\ddagger(F) = x(\\theta^\\ddagger(F)) - x(\\theta_{\\mathrm{min}}(F))$。\n    - 如果在反应物最小值之后没有找到过渡态（表明势垒已被力消除），则势垒高度 $\\Delta G(F)$ 取为 $0$，因此 $\\Delta x^\\ddagger(F)$ 也设为 $0$。为确保物理一致性，势垒高度始终取非负值，即 $\\Delta G(F) = \\max\\{U_F(\\theta^\\ddagger(F)) - U_F(\\theta_{\\mathrm{min}}(F)), 0\\}$。\n\n4.  **模型拟合与比较**：上一步中的程序首先应用于零力（$F=0$）情况，以确定内禀势垒高度 $\\Delta G_0$ 和过渡态投影 $\\Delta x_0$。然后使用这两个参数，通过两个模型生成力依赖势垒高度的理论预测：\n    - Bell 模型：$\\Delta G_{\\mathrm{Bell}}(F) = \\max\\{0, \\Delta G_0 - F\\,\\Delta x_0\\,C\\}$。\n    - Dudko–Hummer–Szabo (DHS) 模型：$\\Delta G_{\\mathrm{DHS}}(F;\\nu) = \\Delta G_0\\left(1 - \\nu\\,\\frac{F\\,\\Delta x_0\\,C}{\\Delta G_0}\\right)^{1/\\nu}$，对于势垒形状参数 $\\nu \\in \\{1/2, 2/3\\}$。如果 $F \\ge \\frac{\\Delta G_0}{\\nu\\,\\Delta x_0\\,C}$，则预测势垒为 $0$。\n    \n    通过计算每个模型的预测值与在所有非零力上数值计算的 $\\Delta G(F)$ 值之间的均方根误差 (RMSE) 来评估每个模型的准确性。产生最小 RMSE 的模型被确定为该情况下的最佳拟合模型。\n\n5.  **诊断势垒形状变化**：根据两个特定标准来诊断负载下活化势垒形状的显著变化：\n    - **模型差异**：最佳拟合模型必须是 DHS 模型之一（$\\nu=1/2$ 或 $\\nu=2/3$），并且其 RMSE 必须显著优于 Bell 模型的 RMSE。条件是 Bell 模型的 RMSE 至少是最佳模型 RMSE 的 1.5 倍。\n    - **过渡态位移**：过渡态沿拉伸坐标的位置，由 $\\Delta x^\\ddagger(F)$ 捕捉，必须随力表现出显著变化。这通过条件 $\\frac{\\max(\\mathcal{S}) - \\min(\\mathcal{S})}{\\max(\\Delta x_0,\\,\\varepsilon)} \\ge 0.1$ 来量化，其中 $\\mathcal{S}$ 是在势垒仍然存在的非零力下的 $\\Delta x^\\ddagger(F_i)$ 值集合，而 $\\varepsilon=10^{-9}\\,\\mathrm{nm}$ 是一个用于数值稳定性的小常数。\n\n    仅当两个条件都满足时，才标记形状变化（输出 $s=1$）。否则，不报告显著的形状变化（输出 $s=0$）。这整套方法系统地应用于提供的三个测试案例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the mechanochemistry problem for three test cases.\n    \"\"\"\n    # Define constants\n    N_A = 6.02214076e23  # Avogadro's number, mol^-1\n    C = N_A * 1e-18 / 1e3  # Conversion factor, nN*nm -> kJ/mol\n\n    # Common parameters\n    F_set = np.array([0.00, 0.05, 0.15, 0.30, 0.45])  # Forces in nN\n    theta_grid = np.linspace(0, np.pi, 20000)  # Reaction coordinate grid\n\n    # Test cases: (A1, A2, A3, r0, r1, theta_m)\n    test_cases = [\n        {'params': {'A1': 30, 'A2': 40, 'A3': 5, 'r0': 0.12, 'r1': 0.02, 'theta_m': 0.60}},\n        {'params': {'A1': 40, 'A2': 60, 'A3': 20, 'r0': 0.18, 'r1': 0.06, 'theta_m': 0.50}},\n        {'params': {'A1': 10, 'A2': 15, 'A3': 5, 'r0': 0.15, 'r1': 0.03, 'theta_m': 0.70}}\n    ]\n\n    # Helper functions\n    def U0(theta, p):\n        tm = p['theta_m']\n        return p['A1'] * (1 - np.cos(theta - tm)) + \\\n               p['A2'] * (1 - np.cos(2 * (theta - tm))) + \\\n               p['A3'] * (1 - np.cos(3 * (theta - tm)))\n\n    def x_ext(theta, p):\n        tm = p['theta_m']\n        return p['r0'] * (1 - np.cos(theta - tm)) + p['r1'] * np.sin(theta - tm)**2\n\n    def get_extrema(potential_curve):\n        diffs = np.diff(potential_curve)\n        signs = np.sign(diffs)\n        sign_changes = np.diff(signs)\n        min_indices = np.where(sign_changes == 2)[0] + 1\n        max_indices = np.where(sign_changes == -2)[0] + 1\n        return min_indices, max_indices\n\n    def bell_model(F, dG0, dx0):\n        pred = dG0 - F * dx0 * C\n        return max(0, pred)\n\n    def dhs_model(F, dG0, dx0, nu):\n        if dG0 == 0:\n            return 0.0\n        \n        term = 1 - nu * F * dx0 * C / dG0\n        if term = 0:\n            return 0.0\n        else:\n            return dG0 * term**(1 / nu)\n    \n    final_results = []\n\n    for case in test_cases:\n        p = case['params']\n        theta_m = p['theta_m']\n\n        computed_dG = []\n        computed_dx = []\n\n        U0_curve = U0(theta_grid, p)\n        x_curve = x_ext(theta_grid, p)\n\n        for F in F_set:\n            UF_curve = U0_curve - F * x_curve * C\n            min_indices, max_indices = get_extrema(UF_curve)\n\n            if min_indices.size == 0:\n                final_results.append([0, 0])\n                continue\n\n            # Find reactant minimum (closest to theta_m)\n            min_thetas = theta_grid[min_indices]\n            reactant_min_idx_in_mins = np.argmin(np.abs(min_thetas - theta_m))\n            reactant_min_idx = min_indices[reactant_min_idx_in_mins]\n\n            # Find first transition state after reactant minimum\n            ts_indices = max_indices[max_indices > reactant_min_idx]\n            \n            if ts_indices.size > 0:\n                ts_idx = ts_indices[0]\n                dG_F = UF_curve[ts_idx] - UF_curve[reactant_min_idx]\n                dG_F = max(0, dG_F)\n                \n                if dG_F > 0:\n                    dx_F = x_curve[ts_idx] - x_curve[reactant_min_idx]\n                else:\n                    dx_F = 0.0\n            else:\n                dG_F = 0.0\n                dx_F = 0.0\n\n            computed_dG.append(dG_F)\n            computed_dx.append(dx_F)\n        \n        # Extract zero-force parameters\n        dG0 = computed_dG[0]\n        dx0 = computed_dx[0]\n\n        # Analyze for non-zero forces\n        F_nonzero = F_set[1:]\n        dG_nonzero = np.array(computed_dG[1:])\n        dx_nonzero = np.array(computed_dx[1:])\n        \n        if F_nonzero.size == 0:\n            final_results.append([0, 0])\n            continue\n            \n        # Model predictions\n        pred_bell = np.array([bell_model(F, dG0, dx0) for F in F_nonzero])\n        pred_dhs12 = np.array([dhs_model(F, dG0, dx0, 1/2) for F in F_nonzero])\n        pred_dhs23 = np.array([dhs_model(F, dG0, dx0, 2/3) for F in F_nonzero])\n\n        # RMSE calculations\n        rmse_bell = np.sqrt(np.mean((dG_nonzero - pred_bell)**2))\n        rmse_dhs12 = np.sqrt(np.mean((dG_nonzero - pred_dhs12)**2))\n        rmse_dhs23 = np.sqrt(np.mean((dG_nonzero - pred_dhs23)**2))\n\n        rmses = [rmse_bell, rmse_dhs12, rmse_dhs23]\n        m = np.argmin(rmses) # 0=Bell, 1=DHS(1/2), 2=DHS(2/3)\n\n        # Shape change criteria\n        s = 0\n        cond1 = (m != 0) and (rmses[0] / rmses[m] >= 1.5)\n\n        S_set = dx_nonzero[dG_nonzero > 0]\n        cond2 = False\n        if S_set.size > 0:\n            epsilon = 1e-9\n            dx_spread = (np.max(S_set) - np.min(S_set)) / max(dx0, epsilon)\n            if dx_spread >= 0.1:\n                cond2 = True\n        \n        if cond1 and cond2:\n            s = 1\n        \n        final_results.append([m, s])\n\n    # Format the final output string\n    formatted_results = [f'[{r[0]},{r[1]}]' for r in final_results]\n    print(f'[{\",\".join(formatted_results)}]')\n\nsolve()\n```", "id": "2778981"}]}