{"hands_on_practices": [{"introduction": "本练习回归到第一性原理。我们将从基础热力学出发，建立界面自由能 ($\\gamma$) 的严格定义。理解可逆功与吉布斯自由能之间的这种联系，对于领会界面为何在热力学上具有重要意义，以及如何通过实验测量其能量至关重要 ([@problem_id:2772526])。", "problem": "一个纯金属双晶体通过可逆地解理并重新接合两个晶粒而形成一个平直晶界。该过程在与大型热库和力学库接触的情况下进行，这些库将系统维持在恒定的温度 $T$ 和静水压力 $p$。唯一的非压力机械功是产生新界面面积所需的功。\n\n从适用于含界面系统的基本热力学定义和定律出发，证明在适当条件下，产生界面面积 $A$ 所需的可逆功等于单位面积的界面自由能 $\\gamma$ 与面积的乘积，即证明为何 $W_{\\mathrm{rev}}=\\gamma A$。明确说明此等式对于晶界或相界成立所需的热力学假设。\n\n然后，对于一个可逆双晶体形成实验，其中测得产生界面面积 $A=2.0\\ \\mathrm{cm}^2$ 的功为 $W=0.35\\ \\mathrm{J}$，计算界面自由能 $\\gamma$。将 $\\gamma$ 的最终值以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 为单位表示，并将您的答案四舍五入到两位有效数字。", "solution": "所提出的问题是有效的，因为它基于热力学和材料科学的原理，提法恰当，且陈述客观。我们将首先进行严格的推导，然后进行计算。\n\n问题的第一部分要求我们证明，在特定的热力学条件下，产生界面面积 $A$ 所需的可逆功 $W_{\\mathrm{rev}}$ 等于单位面积的界面自由能 $\\gamma$ 与面积 $A$ 的乘积。\n\n我们从包含界面的多组分系统的基本热力学描述开始。这样一个系统的内能 $U$ 不仅是其熵 $S$、体积 $V$ 和其化学组分摩尔数 $\\{n_i\\}$ 的函数，还是界面面积 $A$ 的函数。$U$ 的基本微分形式为：\n$$dU = TdS - pdV + \\sum_i \\mu_i dn_i + \\gamma_{U} dA$$\n其中 $T$ 是温度，$p$ 是压力，$\\mu_i$ 是组分 $i$ 的化学势，而 $\\gamma_{U} = \\left(\\frac{\\partial U}{\\partial A}\\right)_{S,V,n_i}$ 被定义为比界面能。\n\n实验指定的条件是恒定温度 $T$ 和恒定压力 $p$。在这种情况下，吉布斯自由能 $G$ 是最合适的热力学势。吉布斯自由能通过内能的勒让德变换定义：\n$$G = U - TS + pV$$\n因此，$G$ 的全微分为：\n$$dG = dU - TdS - SdT + pdV + Vdp$$\n将 $dU$ 的表达式代入此方程得到：\n$$dG = (TdS - pdV + \\sum_i \\mu_i dn_i + \\gamma_{U} dA) - TdS - SdT + pdV + Vdp$$\n简化后，我们得到含界面系统的吉布斯自由能基本方程：\n$$dG = -SdT + Vdp + \\sum_i \\mu_i dn_i + \\gamma dA$$\n注意，$dA$ 的系数现在表示为 $\\gamma$，即比界面吉布斯自由能，或简称为界面自由能。根据这个方程，$\\gamma$ 的精确定义是在恒温、恒压和恒定组成下，吉布斯自由能对面积的偏导数：\n$$\\gamma = \\left(\\frac{\\partial G}{\\partial A}\\right)_{T,p,n_i}$$\n对于纯金属，只要物质总量保持不变，组成项 $\\sum_i \\mu_i dn_i$ 就为零。\n\n接下来，我们建立吉布斯自由能变化与可逆功之间的联系。热力学第一定律指出 $dU = \\delta Q + \\delta W$，其中 $\\delta Q$ 是系统吸收的热量，$\\delta W$ 是对系统做的功。\n对于热力学可逆过程，交换的热量为 $\\delta Q_{\\mathrm{rev}} = TdS$。所做的总功 $\\delta W_{\\mathrm{rev}}$ 包括对抗外部压力的体积变化功 $-pdV$ 和任何其他形式的功，我们将其表示为非体积功，$\\delta W_{\\mathrm{rev, non-pV}}$。\n$$\\delta W_{\\mathrm{rev}} = -pdV + \\delta W_{\\mathrm{rev, non-pV}}$$\n将这些代入可逆过程的热力学第一定律：\n$$dU = TdS - pdV + \\delta W_{\\mathrm{rev, non-pV}}$$\n现在，考虑在恒温 $T$ 和恒压 $p$ 下发生的过程的吉布斯自由能变化 $dG = dU - d(TS) + d(pV)$。在这些约束条件下，$d(TS) = TdS$ 且 $d(pV) = pdV$。\n因此，$dG|_{T,p} = dU - TdS + pdV$。\n将来自第一定律的 $dU$ 表达式代入这个 $dG|_{T,p}$ 的方程中：\n$$dG|_{T,p} = (TdS - pdV + \\delta W_{\\mathrm{rev, non-pV}}) - TdS + pdV$$\n这可以简化为一个关键结果：\n$$dG|_{T,p} = \\delta W_{\\mathrm{rev, non-pV}}$$\n该方程表明，对于任何在恒温恒压下进行的可逆过程，系统吉布斯自由能的变化完全等于对系统所做的非体积功。\n\n问题陈述指明，唯一的非$pV$功是产生新界面面积所需的功。因此，$\\delta W_{\\mathrm{rev, non-pV}}$ 是产生无穷小面积 $dA$ 所做的功，我们可以简单地写成 $\\delta W_{\\mathrm{rev}}$。\n$$dG|_{T,p,n_i} = \\delta W_{\\mathrm{rev}}$$\n我们现在有两个在恒定 $T$、$p$ 和组成下吉布斯自由能微分变化的表达式：\n1. 根据其定义：$dG|_{T,p,n_i} = \\gamma dA$\n2. 根据功定理：$dG|_{T,p,n_i} = \\delta W_{\\mathrm{rev}}$\n将两者相等，得到无穷小功与无穷小面积变化之间的关系：\n$$\\delta W_{\\mathrm{rev}} = \\gamma dA$$\n为了求出从零面积开始创建有限界面面积 $A$ 所需的总可逆功 $W_{\\mathrm{rev}}$，我们必须对此表达式进行积分：\n$$W_{\\mathrm{rev}} = \\int_{0}^{A} \\gamma \\, dA'$$\n为使该积分的计算结果为 $W_{\\mathrm{rev}} = \\gamma A$，我们必须假设 $\\gamma$ 是常数，不依赖于面积 $A'$。\n\n因此，等式 $W_{\\mathrm{rev}} = \\gamma A$ 在以下假设下成立：\n1. 创建界面的过程是**热力学可逆的**。\n2. 该过程在**恒定温度**和**恒定压力**下发生。\n3. 除压力-体积功外，对系统所做的唯一功是创建界面的功。\n4. 比界面自由能 $\\gamma$ 相对于所创建的面积是**恒定的**。对于宏观的平直界面，当曲率效应和边缘效应可以忽略不计时，这是一个有效的假设，并且界面的平衡结构与其大小无关。\n\n对于问题的第二部分，我们必须根据给定的实验数据计算界面自由能 $\\gamma$。\n测得创建界面面积 $A = 2.0 \\text{ cm}^2$ 的功为 $W = 0.35 \\text{ J}$。问题指出该过程是可逆的，因此我们将 $W$ 等同于 $W_{\\mathrm{rev}}$。\n从推导出的关系式，我们有 $\\gamma = \\frac{W_{\\mathrm{rev}}}{A}$。\n首先，我们必须用国际单位制单位($\\text{m}^2$)表示面积 $A$，以与功的单位(焦耳)保持一致。\n已知 $1 \\text{ m} = 100 \\text{ cm}$，我们有 $1 \\text{ m}^2 = (100 \\text{ cm})^2 = 10000 \\text{ cm}^2 = 10^4 \\text{ cm}^2$。\n因此，$A = 2.0 \\text{ cm}^2 = 2.0 \\times 10^{-4} \\text{ m}^2$。\n\n现在，我们可以计算 $\\gamma$：\n$$\\gamma = \\frac{0.35 \\text{ J}}{2.0 \\times 10^{-4} \\text{ m}^2} = \\frac{0.35}{2.0} \\times 10^{4} \\text{ J m}^{-2}$$\n$$\\gamma = 0.175 \\times 10^{4} \\text{ J m}^{-2} = 1750 \\text{ J m}^{-2}$$\n问题要求答案四舍五入到两位有效数字，以与输入数据的精度($0.35$ J 和 $2.0$ cm$^2$)保持一致。\n将 $1750 \\text{ J m}^{-2}$ 四舍五入到两位有效数字得到 $1800 \\text{ J m}^{-2}$，最好用科学记数法表示为 $1.8 \\times 10^3 \\text{ J m}^{-2}$。", "answer": "$$\\boxed{1.8 \\times 10^{3}}$$", "id": "2772526"}, {"introduction": "在理解了界面的宏观热力学定义之后，我们现在探索一个具体的物理模型。本练习应用经典的 Read-Shockley 理论，该理论将小角度晶界描述为一个位错阵列，从而将晶界能 ($\\gamma$) 这一宏观性质与位错特性、错向角 ($\\theta$) 等微观参数联系起来。通过这个实践，你将能为一个简单但重要的情形提供能量的定量估算 ([@problem_id:2772513])。", "problem": "一个面心立方 (fcc) 金属中的对称小角度倾斜晶界可以建模为容纳取向差的平行刃型位错的周期性阵列。考虑一个 fcc 金属，其剪切模量 $\\mu=40\\ \\mathrm{GPa}$，泊松比 $\\nu=0.34$，柏氏矢量大小 $b=0.255\\ \\mathrm{nm}$，取向差角 $\\theta=3^\\circ$。使用刃型位错的各向同性线弹性理论和 Frank–Bilby 的小角度倾斜晶界框架，通过将晶界视为单个相同刃型位错阵列来估计单位面积的晶界能 $\\gamma$。采用位错核心截止半径 $r_{0}=b$，并将每个位错的弹性外部截止距离取为阵列中的位错间距。忽略弹性各向异性和任何非对数贡献。\n\n从单个位错的标准弹性理论以及小角度下位错密度与取向差之间的几何关系出发，推导你所使用的表达式。使用给定参数，并以弧度为单位的 $\\theta$ 值，数值计算 $\\gamma$。以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 为单位表示你的最终答案，并将结果四舍五入到三位有效数字。最终答案必须是一个单一的数字。", "solution": "问题陈述经过验证，确认有效。这是一个适定问题，其基础是应用于晶体材料晶界的位错理论和线弹性理论的既定原则。该问题提供了一整套推导唯一、有意义解所需的物理参数和建模假设。所有数据在科学上都是一致的，并且是所描述材料和现象的典型数据。因此，我们可以着手求解。\n\n该问题要求估计对称小角度倾斜晶界的单位面积晶界能 $\\gamma$。根据 Frank–Bilby 框架以及随后由 Read 和 Shockley 发展的模型，这种晶界可以表示为平行刃型位错的周期性阵列。晶界的能量就是这些位错的总弹性应变能，在晶界面积上取平均值。\n\n首先，我们建立取向差角 $\\theta$ 与阵列中位错间距 $D$ 之间的几何关系。考虑两个晶格绕位于晶界平面内的某一轴线发生小角度 $\\theta$ 的取向差。这种倾斜由一堵垂直的刃型位错墙来容纳，所有位错都具有相同大小为 $b$ 的柏氏矢量 $\\mathbf{b}$。从晶界的几何形状可知，相邻位错之间的垂直距离 $D$ 与柏氏矢量大小 $b$ 和取向差角 $\\theta$ 的关系由以下方程给出：\n$$b = 2D \\sin\\left(\\frac{\\theta}{2}\\right)$$\n对于小角度晶界，$\\theta$ 很小，所以我们可以使用小角度近似 $\\sin(\\theta/2) \\approx \\theta/2$。该关系简化为：\n$$b \\approx 2D \\left(\\frac{\\theta}{2}\\right) = D\\theta$$\n因此，位错间距与取向差角成反比：\n$$D = \\frac{b}{\\theta}$$\n需要注意的是，为了使这个近似准确，$\\theta$ 必须以弧度表示。\n\n接下来，我们考虑单个刃型位错的弹性应变能。在各向同性线弹性框架内，单位长度刃型位错储存在弹性场中的应变能 $W_L$ 由下式给出：\n$$W_L = \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{R}{r_{0}}\\right)$$\n此处，$\\mu$ 是剪切模量，$\\nu$ 是泊松比，$b$ 是柏氏矢量的大小，$r_{0}$ 是位错核心截止半径（定义弹性场的内限），$R$ 是外部截止半径（定义应变场的范围）。问题指定我们忽略任何非对数贡献，这通常指储存在高度畸变的核心区域内的能量，因此这个弹性-能表达式是足够的。\n\n单位面积的晶界能 $\\gamma$ 是晶界平面单位面积上的总位错能量。由于位错以间距 $D$ 排列成周期性阵列，沿晶界单位长度（垂直于位错线的方向）的位错线数量为 $1/D$。因此，单位面积的能量是单个位错单位长度的能量除以位错之间的间距：\n$$\\gamma = \\frac{W_L}{D} = \\frac{1}{D} \\left( \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{R}{r_{0}}\\right) \\right)$$\n\n问题对截止半径给出了具体说明。核心内部截止半径取为柏氏矢量的大小，$r_{0} = b$。给定位错应变场的外部截止半径 $R$ 取为到下一个位错的间距，$R = D$。这是一个有物理依据的选择，因为阵列中位错的长程应力场在大于其间距的距离上倾向于相互抵消。\n\n将这些条件 $r_{0}=b$ 和 $R=D$ 代入 $\\gamma$ 的表达式中：\n$$\\gamma = \\frac{1}{D} \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{D}{b}\\right)$$\n现在，我们将几何关系 $D = b/\\theta$ 代入此方程：\n$$\\gamma = \\frac{\\theta}{b} \\frac{\\mu b^{2}}{4\\pi(1-\\nu)} \\ln\\left(\\frac{b/\\theta}{b}\\right)$$\n简化表达式：\n$$\\gamma = \\frac{\\mu b \\theta}{4\\pi(1-\\nu)} \\ln\\left(\\frac{1}{\\theta}\\right)$$\n这就是在指定假设下，著名的小角度倾斜晶界能量的 Read-Shockley 方程。这也可以写成 $\\gamma = -\\frac{\\mu b \\theta}{4\\pi(1-\\nu)} \\ln(\\theta)$。\n\n我们现在进行数值计算。给定参数为：\n剪切模量，$\\mu = 40 \\ \\mathrm{GPa} = 40 \\times 10^{9} \\ \\mathrm{J}\\,\\mathrm{m}^{-3}$。\n泊松比，$\\nu = 0.34$。\n柏氏矢量大小，$b = 0.255 \\ \\mathrm{nm} = 0.255 \\times 10^{-9} \\ \\mathrm{m}$。\n取向差角，$\\theta = 3^\\circ$。\n\n首先，我们必须按照小角度近似的要求，将角度 $\\theta$ 从度数转换为弧度：\n$$\\theta = 3^\\circ \\times \\frac{\\pi}{180^\\circ} = \\frac{\\pi}{60} \\ \\mathrm{rad}$$\n数值上，$\\theta \\approx 0.0523598776 \\ \\mathrm{rad}$。\n\n现在，我们将所有数值代入推导出的 $\\gamma$ 方程中：\n$$\\gamma = \\frac{(40 \\times 10^{9} \\ \\mathrm{J}\\,\\mathrm{m}^{-3}) \\times (0.255 \\times 10^{-9} \\ \\mathrm{m}) \\times (\\frac{\\pi}{60})}{4\\pi(1-0.34)} \\ln\\left(\\frac{1}{\\pi/60}\\right)$$\n$$\\gamma = \\frac{40 \\times 0.255 \\times (\\pi/60)}{4\\pi(0.66)} \\ln\\left(\\frac{60}{\\pi}\\right) \\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n在求值之前，我们先简化表达式：\n$$\\gamma = \\frac{10.2 \\times (\\pi/60)}{4\\pi(0.66)} \\ln\\left(\\frac{60}{\\pi}\\right) = \\frac{10.2}{60 \\times 4 \\times 0.66} \\ln\\left(\\frac{60}{\\pi}\\right)$$\n$$\\gamma = \\frac{10.2}{158.4} \\ln\\left(\\frac{60}{\\pi}\\right)$$\n现在我们计算数值：\n$$\\frac{10.2}{158.4} \\approx 0.064393939$$\n$$\\ln\\left(\\frac{60}{\\pi}\\right) \\approx \\ln(19.09859) \\approx 2.949559$$\n将这些值相乘：\n$$\\gamma \\approx 0.064393939 \\times 2.949559 \\approx 0.189930 \\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n问题要求将结果四舍五入到三位有效数字。\n$$\\gamma \\approx 0.190 \\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n这个值对于小角度晶界的能量来说是物理上合理的。", "answer": "$$\\boxed{0.190}$$", "id": "2772513"}, {"introduction": "真实的晶界结构往往比理想化的位错阵列更为复杂。这个高级计算实践引入了功能强大的“结构单元”模型，它被用来描述更一般晶界的原子结构。通过编程实现一个从模拟数据中识别和评估这些单元能量的协议，你将亲身体验计算材料科学前沿领域中研究界面稳定性的方法 ([@problem_id:2772530])。", "problem": "您在纳米力学以及表面与界面科学领域有一项任务：形式化、实现并测试一个原子尺度协议，该协议能够 (i) 直接从模拟快照中识别一维晶界或相界上的结构单元，以及 (ii) 计算不同结构单元序列的相对稳定性。该协议必须基于原子尺度上被广泛接受的标准定义和假设。\n\n使用以下基础来设计您的方法：\n- 晶界或相界的单位长度过剩能定义为定位于晶界的总能量相对于一个参考值的超出部分，除以一个明确定义的晶界长度。该超出部分的构造方式使得体相的贡献相互抵消，只留下一个定位于晶界的度量。\n- 对于局部原子环境与类体相有序状态的微小偏离，使用总能量相对于局部几何描述符的二阶泰勒展开是合适的。对于由一串相连原子组成的一维晶界，您可以将局部键角畸变视作主要自由度，并将过剩能近似为独立位点贡献之和，外加相邻结构单元类型发生变化时的短程罚项。角度必须以弧度为单位。\n\n您的程序必须对每个提供的快照执行以下操作：\n1. 将输入解释为单个晶界上的一组二维原子坐标。通过按 $x$ 坐标排序（若 $x$ 坐标相同则按 $y$ 坐标排序）将原子排列成链。\n2. 计算晶界长度 $L$，即按顺序连接链中原子的折线弧长。\n3. 对于每个内部原子 $i$（不包括两个端点），计算其与链中最近邻原子所构成向量之间的局部键角 $\\theta_i$。所有角度必须以弧度为单位。\n4. 定义三种典型结构单元类型及其目标角度：\n   - S 型，目标角度 $\\theta_S = \\pi$，\n   - K 型，目标角度 $\\theta_K = 5\\pi/6$，\n   - T 型，目标角度 $\\theta_T = 2\\pi/3$。\n5. 采用以下建模假设和常数：\n   - 内部原子处的局域过剩能贡献由观测角度与该类型目标角度偏差的二阶展开给出。使用单一的角刚度 $k_\\theta$，其值为 $k_\\theta = 5.0$ 电子伏特/弧度平方 (eV/rad$^2$）。\n   - 每当两个连续的内部原子被赋予不同的结构单元类型时，会产生一个以电子伏特 (eV) 为单位的失配罚项 $\\lambda$。使用 $\\lambda = 0.2$。\n   - 在本问题中忽略径向畸变，并视端点的局域贡献为零。\n6. 通过将每个内部原子分配给其目标角度与测量角度 $\\theta_i$ 最接近（在最小化局域二次罚项的意义上）的类型，来构建观测到的结构单元序列。令 $E_{\\text{obs}}$ 为总过剩能，包括局域贡献之和以及该观测序列中连续内部原子间类型变化的失配罚项之和。\n7. 计算相同长度的全局最优结构单元序列（每个内部原子一个类型），该序列在最近邻失配罚项下最小化了相同的总过剩能模型。令相应的最小能量为 $E_{\\text{opt}}$。\n8. 将一个序列的单位长度过剩能定义为 $\\gamma = E/L$。对于每个快照，计算观测序列和最优序列之间单位长度过剩能的差值，\n   $$\\Delta \\gamma = \\frac{E_{\\text{obs}} - E_{\\text{opt}}}{L}.$$\n   以电子伏特/纳米 (eV/nm) 为单位报告 $\\Delta \\gamma$，结果为保留小数点后六位的小数。\n\n角度单位要求：所有角度必须以弧度为单位。能量单位为电子伏特 (eV)。长度单位为纳米 (nm)。报告的 $\\Delta \\gamma$ 必须以 eV/nm 为单位。\n\n测试套件。您的程序必须评估以下四个快照，每个快照由生成原子坐标 $\\{(x_i,y_i)\\}$（单位为纳米）的参数定义：\n- 情况 1（具有弱正弦波动的近直线晶界）：\n  - 原子数 $N = 10$，\n  - 间距 $s = 0.25$，\n  - 振幅 $A = 0.005$，\n  - 坐标：$x_i = i s$, $y_i = A \\sin\\!\\left(2\\pi \\, i / 9\\right)$，对于 $i = 0,1,\\dots,9$。\n- 情况 2（周期性扭折）：\n  - 原子数 $N = 12$，\n  - 间距 $s = 0.25$，\n  - 扭折振幅 $K = 0.04$，\n  - 坐标：$x_i = i s$, $y_i = \\begin{cases} 0  \\text{若 } i \\bmod 3 = 0, \\\\ K  \\text{若 } i \\bmod 3 = 1, \\\\ -K  \\text{若 } i \\bmod 3 = 2,\\end{cases}$ 对于 $i = 0,1,\\dots,11$。\n- 情况 3（单个内部角接近 $120^\\circ$）：\n  - 三个原子：$(0.0, 0.0)$, $(0.25, 0.0)$, $\\left(0.25 + 0.25\\cos(\\pi/3), \\, 0.25\\sin(\\pi/3)\\right)$。\n- 情况 4（无内部角）：\n  - 两个原子：$(0.0, 0.0)$, $(0.25, 0.0)$。\n\n实现要求：\n- 在每个内部原子处，使用归一化邻近向量点积的反余弦来精确实现角度计算。\n- 计算观测序列能量 $E_{\\text{obs}}$，其值为每个位点相对于所赋类型目标角度的二次偏差之和，加上 $\\lambda$ 乘以连续内部原子间类型变化的次数。\n- 通过在所有类型分配上精确最小化相同的一维链能量来计算 $E_{\\text{opt}}$。一个具有最近邻耦合的动态规划解是合适的。\n- 对于每种情况，计算 $\\Delta \\gamma$ 并四舍五入到小数点后六位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按顺序排列的四种情况的 $\\Delta \\gamma$ 值，形式为方括号内以逗号分隔的列表。例如，输出必须类似于 $[\\Delta\\gamma_1,\\Delta\\gamma_2,\\Delta\\gamma_3,\\Delta\\gamma_4]$，每个值均表示为以 eV/nm 为单位、四舍五入到小数点后六位的小数，且无附加文本。", "solution": "所提出的问题是计算材料科学领域一个适定且有科学依据的练习，特别是在一维晶界或相界的建模方面。它要求实现一个原子尺度协议，用以比较由局部准则确定的晶界结构与全局最优结构之间的能量。该问题是有效的，因为它建立在公认的原则之上——即界面的结构单元模型和通过谐波展开近似势能面——并提供了一套完整且一致的定义、参数和测试用例。\n\n解决方案的开发将首先形式化几何和能量模型，然后详细说明计算两个目标能量 $E_{\\text{obs}}$ 和 $E_{\\text{opt}}$ 的算法，最后将这些应用于指定的测试用例。\n\n**1. 几何与能量模型的形式化**\n\n令 $N$ 个原子位置的序列表示为 $\\{\\vec{r}_j\\}_{j=0}^{N-1}$，其中 $\\vec{r}_j = (x_j, y_j) \\in \\mathbb{R}^2$。问题陈述原子已排序，使得 $x_j \\le x_{j+1}$。\n\n晶界的总长度 $L$ 是连接原子的折线的弧长：\n$$L = \\sum_{j=0}^{N-2} |\\vec{r}_{j+1} - \\vec{r}_j|$$\n\n该模型关注于 $M = N-2$ 个内部原子，索引从 $i=1$ 到 $M$。对于每个内部原子 $i$（对应位置 $\\vec{r}_i$），局部键角 $\\theta_i$ 由其邻居 $\\vec{r}_{i-1}$ 和 $\\vec{r}_{i+1}$ 形成。该角度由从原子 $i$ 出发的两个向量的点积计算得出：\n$$\\vec{v}_{i-1} = \\vec{r}_{i-1} - \\vec{r}_i$$\n$$\\vec{v}_{i+1} = \\vec{r}_{i+1} - \\vec{r}_i$$\n$$\\theta_i = \\arccos\\left(\\frac{\\vec{v}_{i-1} \\cdot \\vec{v}_{i+1}}{|\\vec{v}_{i-1}| |\\vec{v}_{i+1}|}\\right) \\in [0, \\pi]$$\n所有角度必须以弧度为单位。\n\n定义了三种典型结构单元类型：S 型 ($\\theta_S = \\pi$)、K 型 ($\\theta_K = 5\\pi/6$)和 T 型 ($\\theta_T = 2\\pi/3$)。可能的类型集合为 $\\mathcal{U} = \\{S, K, T\\}$。\n\n对于给定的结构单元分配序列 $\\{U_i\\}_{i=1}^M$（其中 $U_i \\in \\mathcal{U}$），晶界的总过剩能由局域能量和相互作用能量之和给出：\n$$E\\left(\\{U_i\\}_{i=1}^M\\right) = \\sum_{i=1}^{M} E_{\\text{local}}(i, U_i) + \\sum_{i=1}^{M-1} E_{\\text{int}}(U_i, U_{i+1})$$\n在位点 $i$ 处，对于一个已分配的类型 $U_i$ 的局域能量是关于角度畸变的二次罚项：\n$$E_{\\text{local}}(i, U_i) = k_\\theta (\\theta_i - \\theta_{U_i})^2$$\n其中 $k_\\theta = 5.0 \\, \\text{eV/rad}^2$ 是角刚度，$\\theta_{U_i}$ 是类型 $U_i$ 的目标角度。\n相互作用能是相邻原子具有不同类型时的失配罚项 $\\lambda = 0.2 \\, \\text{eV}$：\n$$E_{\\text{int}}(U_i, U_{i+1}) = \\lambda \\cdot \\delta_{U_i, U_{i+1}}^\\prime = \\begin{cases} \\lambda  \\text{若 } U_i \\neq U_{i+1} \\\\ 0  \\text{若 } U_i = U_{i+1} \\end{cases}$$\n\n**2. 观测序列能量 $E_{\\text{obs}}$ 的计算**\n\n“观测”序列 $\\{U_i^{\\text{obs}}\\}_{i=1}^M$ 由纯粹的局域能量最小化确定。对于每个内部原子 $i$，我们分配使其局域能量贡献最小化的类型：\n$$U_i^{\\text{obs}} = \\arg\\min_{U \\in \\mathcal{U}} E_{\\text{local}}(i, U) = \\arg\\min_{U \\in \\mathcal{U}} k_\\theta (\\theta_i - \\theta_U)^2$$\n这等效于找到与测量角度 $\\theta_i$ 最接近的目标角度 $\\theta_U$。\n\n一旦确定了序列 $\\{U_i^{\\text{obs}}\\}$，其总能量 $E_{\\text{obs}}$ 就使用通用能量公式计算：\n$$E_{\\text{obs}} = E\\left(\\{U_i^{\\text{obs}}\\}\\right) = \\sum_{i=1}^{M} k_\\theta (\\theta_i - \\theta_{U_i^{\\text{obs}}})^2 + \\sum_{i=1}^{M-1} \\lambda \\cdot \\delta_{U_i^{\\text{obs}}, U_{i+1}^{\\text{obs}}}^\\prime$$\n\n**3. 最优序列能量 $E_{\\text{opt}}$ 的计算**\n\n全局最优能量 $E_{\\text{opt}}$ 对应于在所有可能的类型分配序列中使总能量最小化的序列 $\\{U_i^*\\}_{i=1}^M$。\n$$E_{\\text{opt}} = \\min_{\\{U_i\\}_{i=1}^M} E\\left(\\{U_i\\}_{i=1}^M\\right)$$\n这是一个经典的具有最近邻相互作用的一维最小化问题，可以使用动态规划高效求解。令 $D(i, U)$ 为前 $i$ 个内部原子组成的子链的最小能量，其中第 $i$ 个原子被赋予类型 $U$。\n\n动态规划的递推关系如下：\n\n**基准情形 (i=1)：** 对于第一个内部原子，没有先前的相互作用。最小能量就是局域能量。\n$$D(1, U) = E_{\\text{local}}(1, U) \\quad \\text{对于每个 } U \\in \\mathcal{U}$$\n\n**递推步骤 (i  1)：** 对于每个后续原子 $i$ 以及每个可能的类型 $U \\in \\mathcal{U}$，最小能量 $D(i, U)$ 是位点 $i$ 处类型为 $U$ 的局域能量，加上与之相连的长度为 $i-1$ 的链的最小能量。如果 $i-1$ 处的类型与 $U$ 不同，则这包括失配罚项。\n$$D(i, U) = E_{\\text{local}}(i, U) + \\min_{U' \\in \\mathcal{U}} \\left[ D(i-1, U') + E_{\\text{int}}(U', U) \\right]$$\n\n**终止：** 遍历所有内部原子直到 $i=M$ 后，全局最优能量是我们动态规划表的最后一列中的最小值：\n$$E_{\\text{opt}} = \\min_{U \\in \\mathcal{U}} D(M, U)$$\n\n对于原子数 $N  3$ 的情况，内部原子数为 $M = N-2 \\le 0$。在这种情况下，根据定义，$E_{\\text{obs}}$ 和 $E_{\\text{opt}}$ 均为零。\n\n**4. 最终计算**\n\n对于每个测试用例，所需的输出是观测构型和最优构型之间单位长度过剩能的差值 $\\Delta\\gamma$：\n$$\\Delta\\gamma = \\frac{E_{\\text{obs}} - E_{\\text{opt}}}{L}$$\n$\\Delta\\gamma$ 的值保证为非负，因为 $E_{\\text{opt}}$ 是全局最小值，所以 $E_{\\text{obs}} \\ge E_{\\text{opt}}$。结果以 eV/nm 为单位报告，并四舍五入到六位小数。实现过程完全按照这些步骤进行。", "answer": "[0.000000,0.063162,0.000000,0.000000]", "id": "2772530"}]}