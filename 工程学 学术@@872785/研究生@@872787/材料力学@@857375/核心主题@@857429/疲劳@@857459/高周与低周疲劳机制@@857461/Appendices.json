{"hands_on_practices": [{"introduction": "低周疲劳（LCF）和高周疲劳（HCF）之间的区别并非随意的划分，而是基于材料的应变响应。一个关键的量化指标是“过渡寿命”$N_t$，此时弹性应变幅和塑性应变幅相等。本练习将指导你使用标准的Coffin-Manson-Basquin框架，通过解析推导来计算这一关键寿命点[@problem_id:2892536]，从而加深对这两个疲劳区域基本定义的理解。", "problem": "一种沉淀强化马氏体钢在室温下承受零平均应力的完全反向、应变控制的单轴疲劳。高周疲劳 (HCF) 和低周疲劳 (LCF) 之间的过渡寿命定义为弹性应变幅等于塑性应变幅时的疲劳寿命。该材料的稳定循环响应由以下常数表征，这些常数在标准的完全反向应变-寿命框架中定义，该框架将总应变幅划分为弹性和塑性两个分量，并采用常规的半循环表示法：\n- 杨氏模量：$E = 210 \\,\\text{GPa}$，\n- 疲劳强度系数：$\\sigma_{f}' = 1400 \\,\\text{MPa}$，\n- 疲劳强度指数：$b = -0.09$，\n- 疲劳延性系数：$\\varepsilon_{f}' = 0.60$，\n- 疲劳延性指数：$c = -0.55$。\n\n从弹性应变幅通过线性弹性与应力幅相关，以及总应变幅在公认的应变-寿命框架中可以表示为弹性和塑性贡献之和这些基本定义出发，推导过渡寿命 $N_{t}$ 的闭式表达式，其中过渡寿命 $N_{t}$ 定义为弹性应变幅与塑性应变幅相等。使用给定的材料常数对其进行数值计算，注意使用一致的单位。\n\n将最终答案表示为破坏循环次数（无量纲）。将您的答案四舍五入至三位有效数字。", "solution": "首先对问题陈述进行严格验证。\n\n第一步：提取已知条件。\n提供了以下数据和定义：\n- 杨氏模量：$E = 210 \\,\\text{GPa}$\n- 疲劳强度系数：$\\sigma_{f}' = 1400 \\,\\text{MPa}$\n- 疲劳强度指数：$b = -0.09$\n- 疲劳延性系数：$\\varepsilon_{f}' = 0.60$\n- 疲劳延性指数：$c = -0.55$\n- 加载条件：完全反向、应变控制、零平均应力的单轴疲劳。\n- 框架：标准的完全反向应变-寿命框架，将总应变划分为弹性和塑性分量，并使用常规的半循环表示法。\n- 过渡寿命 $N_{t}$ 的定义：弹性应变幅等于塑性应变幅时的疲劳寿命。\n\n第二步：使用提取的已知条件进行验证。\n- 科学依据：该问题基于 Coffin-Manson-Basquin 应变-寿命关系，这是材料力学中用于疲劳分析的一个基本且被普遍接受的模型。所提供的材料常数对于沉淀强化马氏体钢是符合实际的。\n- 适定性：该问题是适定的。它要求推导和计算一个特定量，即过渡寿命 $N_t$，并为该寿命提供了所有必要的材料常数和一个清晰、明确的定义。存在唯一解。\n- 客观性：问题陈述以精确、客观和定量的术语表达。它不含任何主观或基于意见的内容。\n\n第三步：结论与行动。\n该问题在科学上是合理的、自洽的且适定的。它被判定为**有效**。将推导解答。\n\n总应变幅 $\\varepsilon_a$ 由其弹性分量 $\\varepsilon_{e,a}$ 和塑性分量 $\\varepsilon_{p,a}$ 的和给出：\n$$\n\\varepsilon_a = \\varepsilon_{e,a} + \\varepsilon_{p,a}\n$$\n问题陈述中说明，该分析使用常规的半循环表示法，其中疲劳寿命以破坏半循环次数 $2N_f$ 表示。根据 Basquin 关系，弹性应变幅为：\n$$\n\\varepsilon_{e,a} = \\frac{\\sigma_a}{E} = \\frac{\\sigma_f'}{E}(2N_f)^b\n$$\n其中 $\\sigma_a$ 是应力幅。根据 Coffin-Manson 关系，塑性应变幅为：\n$$\n\\varepsilon_{p,a} = \\varepsilon_f'(2N_f)^c\n$$\n过渡疲劳寿命 $N_t$ 定义为弹性应变幅等于塑性应变幅时的寿命。因此，当 $N_f = N_t$ 时，我们有：\n$$\n\\varepsilon_{e,a} = \\varepsilon_{p,a}\n$$\n代入弹性和塑性应变幅的表达式可得：\n$$\n\\frac{\\sigma_f'}{E}(2N_t)^b = \\varepsilon_f'(2N_t)^c\n$$\n为了推导 $N_t$ 的闭式表达式，我们必须求解此方程。我们首先分离含有 $N_t$ 的项：\n$$\n\\frac{(2N_t)^b}{(2N_t)^c} = \\frac{\\varepsilon_f' E}{\\sigma_f'}\n$$\n利用指数性质 $x^m / x^n = x^{m-n}$，我们简化左侧：\n$$\n(2N_t)^{b-c} = \\frac{\\varepsilon_f' E}{\\sigma_f'}\n$$\n接下来，我们将两边都取 $\\frac{1}{b-c}$ 次幂：\n$$\n2N_t = \\left(\\frac{\\varepsilon_f' E}{\\sigma_f'}\\right)^{\\frac{1}{b-c}}\n$$\n最后，求解以循环次数表示的过渡寿命 $N_t$，我们得到闭式表达式：\n$$\nN_t = \\frac{1}{2}\\left(\\frac{\\varepsilon_f' E}{\\sigma_f'}\\right)^{\\frac{1}{b-c}}\n$$\n现在，我们使用给定的材料常数对该表达式进行数值计算。确保单位一致至关重要。我们将杨氏模量从吉帕斯卡（GPa）转换为兆帕斯卡（MPa），以与疲劳强度系数的单位相匹配。\n- $E = 210 \\,\\text{GPa} = 210 \\times 10^3 \\,\\text{MPa}$\n- $\\sigma_f' = 1400 \\,\\text{MPa}$\n- $\\varepsilon_f' = 0.60$ (无量纲)\n- $b = -0.09$\n- $c = -0.55$\n\n首先，我们计算指数项 $b-c$：\n$$\nb - c = -0.09 - (-0.55) = -0.09 + 0.55 = 0.46\n$$\n该指数的倒数是：\n$$\n\\frac{1}{b-c} = \\frac{1}{0.46}\n$$\n接下来，我们计算括号内的无量纲比值：\n$$\n\\frac{\\varepsilon_f' E}{\\sigma_f'} = \\frac{0.60 \\times (210 \\times 10^3 \\,\\text{MPa})}{1400 \\,\\text{MPa}} = \\frac{126000}{1400} = 90\n$$\n将这些值代回 $N_t$ 的表达式中：\n$$\nN_t = \\frac{1}{2}(90)^{\\frac{1}{0.46}}\n$$\n计算该表达式：\n$$\nN_t \\approx \\frac{1}{2}(90)^{2.173913} \\approx \\frac{1}{2}(17725.43) \\approx 8862.715\n$$\n题目要求将答案四舍五入到三位有效数字。\n$$\nN_t \\approx 8860\n$$\n这代表了总应变的弹性和塑性贡献相等的循环次数，标志着从 LCF 区域（由塑性应变主导）到 HCF 区域（由弹性应变主导）的过渡。为清晰表示有效数字，将结果用科学记数法表示为 $8.86 \\times 10^3$。", "answer": "$$\\boxed{8.86 \\times 10^{3}}$$", "id": "2892536"}, {"introduction": "疲劳模型中的系数和指数并非凭空而来，它们必须通过实验数据来确定。本练习将引导你从第一性原理（标度不变性）出发，推导疲劳模型的幂律形式，并运用统计方法（对数变换数据的线性回归）从假设的实验数据中估计HCF和LCF区的模型参数[@problem_id:2892530]。这个实践旨在搭建理论模型与工程数据分析之间的关键桥梁，让你掌握将原始数据转化为预测能力的核心技能。", "problem": "一个工程数据集包含了金属材料循环疲劳实验的测量数据，涵盖了两种机制：一种是高周机制，其中每周期塑性变形可忽略不计；另一种是低周机制，其中每周期塑性变形占主导地位。假设应变很小，弹性响应中胡克定律成立，并且在两种机制中，幅值与寿命之间的关系不存在破坏尺度不变性的内在时间尺度。在这些假设下，仅使用以下依据，从第一性原理推导适用于这两种机制的无标度模型类别和基于统计学原理的参数估计方法：应变的定义、胡克定律、尺度不变性假设以及对数空间中方差恒定的对数正态乘性测量散布假设。使用推导出的模型，根据提供的测试数据估计参数，并计算弹性应变幅与塑性应变幅相等时的过渡寿命。\n\n任务：\n- 根据尺度不变性和不存在内在时间尺度的假设，推导出在每种机制中必须关联幅值与破坏循环次数的函数形式。论证与尺度不变性所隐含的函数方程一致的唯一连续解是关于循环次数的幂律。\n- 将每种机制中的测量值建模为具有恒定方差的对数正态乘性散布。证明相应的最大似然估计量可简化为对数转换变量的最小二乘拟合，并提供对数空间中斜率和截距的显式估计量。\n- 在高周机制中，测量的幅值是应力幅，用 $\\sigma_a$ 表示，单位为兆帕 (MPa)。在低周机制中，测量的幅值是塑性应变幅，用 $\\varepsilon_{p,a}$ 表示，是无量纲的。令破坏循环次数为 $N$（单位：次）。用 $E$ 表示杨氏模量（单位：MPa）。在弹性机制中，使用胡克定律通过 $\\varepsilon_{e,a} = \\sigma_a / E$ 将应力幅转换为弹性应变幅。\n- 对于每个测试用例，使用推导出的幂律模型类别和最大似然解释，估计：\n  1. 根据 $(\\sigma_a, N)$ 对的数据集，估计高周指数 $m_{\\mathrm{hc}}$（无量纲）和系数 $A_{\\mathrm{hc}}$（单位：MPa）。\n  2. 根据 $(\\varepsilon_{p,a}, N)$ 对的数据集，估计低周指数 $c_{\\mathrm{lc}}$（无量纲）和系数 $B_{\\mathrm{lc}}$（无量纲）。\n  3. 过渡寿命 $N_t$（单位：次），由弹性应变幅和塑性应变幅相等的关系隐式定义，即 $\\sigma_a(N_t) / E = \\varepsilon_{p,a}(N_t)$，其中 $\\sigma_a(N)$ 和 $\\varepsilon_{p,a}(N)$ 是由各自机制的拟合模型预测的幅值。\n- 以 MPa 为单位表示 $A_{\\mathrm{hc}}$ 的最终数值答案， $B_{\\mathrm{lc}}$ 为无量纲， $N_t$ 的单位为次。所有指数均为无量纲。将每个报告值四舍五入至六位有效数字。\n\n测试套件：\n为以下三个测试用例提供估计值。每个测试用例提供 $E$ 和两个数据集：一个用于高周机制 $(\\sigma_a, N)$，一个用于低周机制 $(\\varepsilon_{p,a}, N)$。所有 $N$ 的单位均为次。\n\n- 测试用例 1：\n  - $E = 210000$\n  - 高周数据 $(\\sigma_a, N)$:\n    - $(436.515832240166, 1000)$\n    - $(251.188643150958, 100000)$\n    - $(190.546071796324, 1000000)$\n  - 低周数据 $(\\varepsilon_{p,a}, N)$:\n    - $(0.05, 100)$\n    - $(0.0158113883008426, 1000)$\n    - $(0.005, 10000)$\n\n- 测试用例 2：\n  - $E = 70000$\n  - 高周数据 $(\\sigma_a, N)$:\n    - $(261.909499344099, 10000)$\n    - $(173.041890187597, 1000000)$\n  - 低周数据 $(\\varepsilon_{p,a}, N)$:\n    - $(0.0189287203344058, 100)$\n    - $(0.00119432151166049, 10000)$\n\n- 测试用例 3：\n  - $E = 110000$\n  - 高周数据 $(\\sigma_a, N)$:\n    - $(358.296453498147, 10000)$\n    - $(226.069778835862, 1000000)$\n  - 低周数据 $(\\varepsilon_{p,a}, N)$:\n    - $(0.0126191468896039, 100)$\n    - $(0.00316978638492223, 1000)\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含三个测试用例的结果，格式为由方括号括起来的逗号分隔的列表的列表。对于每个测试用例，严格按照 $[m_{\\mathrm{hc}}, A_{\\mathrm{hc}}, c_{\\mathrm{lc}}, B_{\\mathrm{lc}}, N_t]$ 的顺序输出列表，每个值四舍五入至六位有效数字。例如，输出必须如下所示：\n\"[[a1,a2,a3,a4,a5],[b1,b2,b3,b4,b5],[c1,c2,c3,c4,c5]]\"\n其中每个符号代表一个按规定四舍五入的浮点数。所有 $A_{\\mathrm{hc}}$ 必须以 MPa 为单位报告， $B_{\\mathrm{lc}}$ 无量纲， $N_t$ 单位为次。", "solution": "所提出的问题是工程数据分析中的一个标准练习，特别是在材料疲劳领域。它要求推导和应用高周疲劳和低周疲劳的基本模型，然后根据实验数据进行参数估计。该问题在科学上是合理的、良定的，并包含了所有必要的信息。因此，我们可以着手求解。\n\n解决方案的结构如下。首先，我们从尺度不变性原理推导疲劳寿命模型的函数形式。其次，我们基于指定的对数正态误差模型建立统计估计算法，证明其在变换空间中等价于线性最小二乘回归。最后，我们将这些推导出的方法应用于提供的测试用例，以计算所需的参数。\n\n**1. 从尺度不变性推导疲劳模型**\n\n我们的任务是找到循环加载幅值（我们通用地表示为 $S$）与破坏循环次数 $N$ 之间的函数关系。模型形式为 $S = f(N)$。核心物理假设是在给定机制内，疲劳过程中不存在内在的时间尺度（或循环计数尺度）。此性质被称为尺度不变性。\n\n尺度不变性意味着，如果我们将循环次数重新标度一个任意因子 $\\alpha > 0$，即 $N \\to \\alpha N$，相应的幅值 $S$ 也将通过一个仅取决于 $\\alpha$ 的因子（比如 $g(\\alpha)$）进行重新标度。这可以表述为一个函数方程：\n$$f(\\alpha N) = g(\\alpha) f(N)$$\n对于函数定义域内的所有 $N$ 和 $\\alpha$。\n\n为了找到 $f(N)$ 的形式，我们假设 $f$ 是一个连续函数，这是一个最低限度的物理要求。令 $N=1$。方程变为 $f(\\alpha) = g(\\alpha) f(1)$。令 $A = f(1)$ 是一个常数，表示 $N=1$ 时的幅值。那么 $g(\\alpha) = f(\\alpha)/A$。将此代回函数方程得到：\n$$f(\\alpha N) = \\frac{f(\\alpha)}{A} f(N)$$\n为解此方程，我们通过取自然对数来变换方程：\n$$\\ln f(\\alpha N) = \\ln f(\\alpha) + \\ln f(N) - \\ln A$$\n我们定义一个新函数 $F(x) = \\ln f(e^x)$。令 $x = \\ln N$ 和 $y = \\ln \\alpha$。那么 $x+y = \\ln N + \\ln \\alpha = \\ln(\\alpha N)$。方程变换为：\n$$F(x+y) = F(y) + F(x) - \\ln A$$\n令 $G(x) = F(x) - \\ln A$。代入后得到 $G(x+y) + \\ln A = G(y) + \\ln A + G(x) + \\ln A - \\ln A$，简化为：\n$$G(x+y) = G(x) + G(y)$$\n这是柯西函数方程。对于一个连续函数 $G$，唯一的解是 $G(x) = m x$ 的形式，其中 $m$ 是某个常数。\n\n逆转代换：\n$F(x) - \\ln A = m x \\implies F(x) = m x + \\ln A$\n$\\ln f(e^x) = m x + \\ln A$\n最后，令 $N = e^x$，所以 $x = \\ln N$：\n$\\ln f(N) = m(\\ln N) + \\ln A = \\ln(N^m) + \\ln A = \\ln(A N^m)$\n对两边取指数，我们得到唯一的连续解：\n$$S(N) = A N^m$$\n这是一个幂律关系。常数 $m$ 是一个无量纲指数，而 $A$ 是一个与幅值 $S$ 具有相同单位的系数。当 $S$ 是应力幅 $\\sigma_a$ 时，此形式被称为 Basquin 关系；当 $S$ 是塑性应变幅 $\\varepsilon_{p,a}$ 时，它是 Coffin-Manson 关系的一种形式。\n\n**2. 通过最大似然进行参数估计**\n\n问题陈述测量值服从对数空间中方差恒定的对数正态乘性散布。设给定 $N_i$ 下的测量值 $S_i$ 建模为：\n$$S_i = S_{\\text{true}}(N_i) \\cdot \\delta_i = (A N_i^m) \\cdot \\delta_i$$\n其中 $\\delta_i$ 是一个随机乘性误差项。对数正态散布的假设意味着 $\\ln(\\delta_i)$ 服从正态分布。我们假设 $\\ln(\\delta_i) \\sim \\mathcal{N}(0, \\sigma_{\\ln}^2)$，其中均值为零（即 $\\delta_i$ 的中位数为 1），方差 $\\sigma_{\\ln}^2$ 恒定。\n\n对模型方程取自然对数：\n$$\\ln S_i = \\ln(A N_i^m) + \\ln \\delta_i = \\ln A + m \\ln N_i + \\ln \\delta_i$$\n我们定义对数变换变量：$y_i = \\ln S_i$，$x_i = \\ln N_i$。设对数空间中的参数为 $b = \\ln A$ 和 $m$。误差项为 $\\epsilon_i = \\ln \\delta_i \\sim \\mathcal{N}(0, \\sigma_{\\ln}^2)$。模型变成一个简单线性回归模型：\n$$y_i = b + m x_i + \\epsilon_i$$\n最大似然估计（MLE）的目标是找到参数 $(b, m)$，使得观察到给定数据 $\\{(x_i, y_i)\\}_{i=1}^k$ 的似然最大化。单个观测值 $y_i$ 的概率密度函数是：\n$$p(y_i | x_i, b, m, \\sigma_{\\ln}) = \\frac{1}{\\sqrt{2\\pi}\\sigma_{\\ln}} \\exp\\left(-\\frac{(y_i - (b + m x_i))^2}{2\\sigma_{\\ln}^2}\\right)$$\n假设误差是独立的，数据集的似然函数是各个概率的乘积：\n$$L(b, m, \\sigma_{\\ln}) = \\prod_{i=1}^k p(y_i | x_i, b, m, \\sigma_{\\ln})$$\n处理对数似然函数 $\\ell = \\ln L$ 更为方便：\n$$\\ell(b, m, \\sigma_{\\ln}) = \\sum_{i=1}^k \\ln p(y_i) = -\\frac{k}{2}\\ln(2\\pi\\sigma_{\\ln}^2) - \\frac{1}{2\\sigma_{\\ln}^2} \\sum_{i=1}^k (y_i - b - m x_i)^2$$\n为了找到 $b$ 和 $m$ 的最大似然估计量，我们对 $\\ell$ 关于它们进行最大化。这等价于最小化残差平方和项 $SSR(b, m) = \\sum_{i=1}^k (y_i - b - m x_i)^2$。这正是普通最小二乘（OLS）回归的目标函数。\n\n因此，对于具有乘性对数正态噪声的幂律模型，参数的 MLE 等价于对对数变换后的数据进行 OLS 拟合。斜率 $m$ 和截距 $b$ 的标准 OLS 估计量是：\n$$ \\hat{m} = \\frac{\\sum_{i=1}^k (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^k (x_i - \\bar{x})^2} = \\frac{k\\sum x_iy_i - (\\sum x_i)(\\sum y_i)}{k\\sum x_i^2 - (\\sum x_i)^2} $$\n$$ \\hat{b} = \\bar{y} - \\hat{m}\\bar{x} $$\n其中 $\\bar{x} = \\frac{1}{k}\\sum x_i$ 和 $\\bar{y} = \\frac{1}{k}\\sum y_i$。\n原始系数 $A$ 的估计量则为 $\\hat{A} = \\exp(\\hat{b})$。\n\n**3. 在疲劳机制和过渡寿命中的应用**\n\n我们将此框架应用于指定的两种机制：\n\n高周疲劳（HCF）：幅值为应力 $\\sigma_a$。模型是 Basquin 关系：\n$$\\sigma_a(N) = A_{\\mathrm{hc}} N^{m_{\\mathrm{hc}}}$$\n参数 $\\hat{m}_{\\mathrm{hc}}$ 和 $\\hat{A}_{\\mathrm{hc}} = \\exp(\\hat{b}_{\\mathrm{hc}})$ 通过对 $(\\ln N, \\ln \\sigma_a)$ 数据进行线性回归找到。\n\n低周疲劳（LCF）：幅值为塑性应变 $\\varepsilon_{p,a}$。模型是 Coffin-Manson 关系：\n$$\\varepsilon_{p,a}(N) = B_{\\mathrm{lc}} N^{c_{\\mathrm{lc}}}$$\n参数 $\\hat{c}_{\\mathrm{lc}}$ 和 $\\hat{B}_{\\mathrm{lc}} = \\exp(\\hat{b}_{\\mathrm{lc}})$ 通过对 $(\\ln N, \\ln \\varepsilon_{p,a})$ 数据进行线性回归找到。\n\n过渡寿命（$N_t$）：这被定义为弹性应变幅等于塑性应变幅时的循环次数。弹性应变幅 $\\varepsilon_{e,a}$ 由胡克定律给出：$\\varepsilon_{e,a} = \\sigma_a/E$。定义条件是：\n$$\\varepsilon_{e,a}(N_t) = \\varepsilon_{p,a}(N_t) \\implies \\frac{\\sigma_a(N_t)}{E} = \\varepsilon_{p,a}(N_t)$$\n代入拟合的模型：\n$$\\frac{\\hat{A}_{\\mathrm{hc}} N_t^{\\hat{m}_{\\mathrm{hc}}}}{E} = \\hat{B}_{\\mathrm{lc}} N_t^{\\hat{c}_{\\mathrm{lc}}}$$\n求解 $N_t$：\n$$N_t^{\\hat{m}_{\\mathrm{hc}} - \\hat{c}_{\\mathrm{lc}}} = \\frac{E \\hat{B}_{\\mathrm{lc}}}{\\hat{A}_{\\mathrm{hc}}}$$\n$$N_t = \\left( \\frac{E \\hat{B}_{\\mathrm{lc}}}{\\hat{A}_{\\mathrm{hc}}} \\right)^{\\frac{1}{\\hat{m}_{\\mathrm{hc}} - \\hat{c}_{\\mathrm{lc}}}}$$\n此公式允许从杨氏模量 $E$ 和两种疲劳机制的估计参数直接计算过渡寿命。接下来的程序实现了这个完整的过程。", "answer": "```python\nimport numpy as np\n\ndef format_sig(x, sig=6):\n    \"\"\"\n    Rounds a number to a specified number of significant figures and returns a string.\n    \"\"\"\n    if x == 0 or not np.isfinite(x):\n        if x == 0:\n            return \"0.00000\"  # Represent with sig figs as contextually appropriate\n        elif np.isnan(x):\n            return \"nan\"\n        else: # isinf\n            return \"inf\" if x > 0 else \"-inf\"\n            \n    power = -int(np.floor(np.log10(abs(x)))) + (sig - 1)\n    \n    if power  0:\n        # For numbers where rounding occurs to the left of the decimal point\n        val_rounded = round(x, power)\n        return str(int(val_rounded))\n    else:\n        # For numbers where rounding occurs to the right of the decimal point\n        return f\"{x:.{power}f}\"\n\ndef linear_regression(x_pts, y_pts):\n    \"\"\"\n    Performs a simple linear regression and returns slope and intercept.\n    This function implements the OLS estimators.\n    \"\"\"\n    n = len(x_pts)\n    if n  2:\n        raise ValueError(\"Linear regression requires at least two points.\")\n        \n    x = np.array(x_pts, dtype=np.float64)\n    y = np.array(y_pts, dtype=np.float64)\n    \n    sum_x = np.sum(x)\n    sum_y = np.sum(y)\n    sum_xy = np.sum(x * y)\n    sum_x2 = np.sum(x * x)\n    \n    denominator = n * sum_x2 - sum_x**2\n    if denominator == 0:\n        # All x values are the same, indicating a vertical line.\n        # This case should not occur in this problem.\n        return np.inf, np.nan\n        \n    m = (n * sum_xy - sum_x * sum_y) / denominator\n    b = (sum_y - m * sum_x) / n\n    \n    return m, b\n\ndef solve():\n    \"\"\"\n    Main function to solve the fatigue parameter estimation problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"E\": 210000,\n            \"hcf_data\": [\n                (436.515832240166, 1000),\n                (251.188643150958, 100000),\n                (190.546071796324, 1000000)\n            ],\n            \"lcf_data\": [\n                (0.05, 100),\n                (0.0158113883008426, 1000),\n                (0.005, 10000)\n            ]\n        },\n        {\n            \"E\": 70000,\n            \"hcf_data\": [\n                (261.909499344099, 10000),\n                (173.041890187597, 1000000)\n            ],\n            \"lcf_data\": [\n                (0.0189287203344058, 100),\n                (0.00119432151166049, 10000)\n            ]\n        },\n        {\n            \"E\": 110000,\n            \"hcf_data\": [\n                (358.296453498147, 10000),\n                (226.069778835862, 1000000)\n            ],\n            \"lcf_data\": [\n                (0.0126191468896039, 100),\n                (0.00316978638492223, 1000)\n            ]\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        E = case[\"E\"]\n        \n        # High-Cycle Fatigue (HCF) parameter estimation\n        hcf_amplitudes = [p[0] for p in case[\"hcf_data\"]]\n        hcf_lives = [p[1] for p in case[\"hcf_data\"]]\n        \n        log_hcf_N = np.log(hcf_lives)\n        log_hcf_sigma = np.log(hcf_amplitudes)\n        \n        m_hc, log_A_hc = linear_regression(log_hcf_N, log_hcf_sigma)\n        A_hc = np.exp(log_A_hc)\n        \n        # Low-Cycle Fatigue (LCF) parameter estimation\n        lcf_amplitudes = [p[0] for p in case[\"lcf_data\"]]\n        lcf_lives = [p[1] for p in case[\"lcf_data\"]]\n        \n        log_lcf_N = np.log(lcf_lives)\n        log_lcf_eps_p = np.log(lcf_amplitudes)\n        \n        c_lc, log_B_lc = linear_regression(log_lcf_N, log_lcf_eps_p)\n        B_lc = np.exp(log_B_lc)\n        \n        # Transition Life calculation\n        exponent = 1.0 / (m_hc - c_lc)\n        base = (E * B_lc) / A_hc\n        N_t = base**exponent\n        \n        # Format results to six significant figures\n        result_set = [\n            format_sig(m_hc, 6),\n            format_sig(A_hc, 6),\n            format_sig(c_lc, 6),\n            format_sig(B_lc, 6),\n            format_sig(N_t, 6)\n        ]\n        all_results.append(f\"[{','.join(result_set)}]\")\n        \n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2892530"}, {"introduction": "在掌握了基本模型和参数估计之后，我们将挑战一个更接近工程现实的复杂问题：平均应力和表面处理引入的残余应力。本练习将使用Smith-Watson-Topper (SWT)参数，构建一个更全面的寿命预测模型，以计入这些关键因素的影响[@problem_id:2892532]。通过求解疲劳寿命并判断其所属的疲劳区域，你将学会如何将基础概念应用于复杂的设计与分析场景中。", "problem": "一个由金属合金制成的部件承受完全弹性或弹塑性循环载荷。制造商采用了一种表面处理工艺，该工艺会引入随深度衰减的残余压应力。要求您从第一性原理和经过充分检验的关系式出发，推导一个计算程序，用以预测失效循环次数，并为几种载荷和处理配置判断失效属于高周疲劳还是低周疲劳范畴。该程序必须能以程序形式实现，并能为指定的测试组生成数值答案。\n\n仅使用以下基础理论：\n- 单轴弹性胡克定律 (Hooke’s law)：弹性应变幅与应力幅的关系为 $\\,\\epsilon_{e,a} = \\sigma_{a}/E\\,$, 其中 $E$ 是弹性模量。\n- 循环 Ramberg–Osgood 关系，用于描述应变幅下的稳定滞回行为：塑性应变幅的分量为 $\\,\\epsilon_{p,a} = (\\sigma_{a}/K')^{1/n'}\\,$, 其中 $K'$ 是循环强度系数，$n'$ 是循环应变硬化指数。总应变幅为 $\\,\\epsilon_{a} = \\epsilon_{e,a} + \\epsilon_{p,a}\\,$。\n- 包含残余应力的平均应力线性叠加：有效平均应力是施加的平均应力与在材料影响深度上平均的残余应力的代数和。\n- Smith–Watson–Topper (SWT) 临界面参数是最大应力与总应变幅的乘积，其寿命相关的材料依赖性源于将弹塑性应变-寿命关系（Manson–Coffin–Basquin 形式）代入该乘积。请将此视为基于定义的建模步骤；在推导之前，不要预先假设任何简化的寿命公式。\n- 总应变-寿命关系（Manson–Coffin–Basquin 形式）是一个经过充分检验的经验定律，它将应变幅与失效反向次数联系起来。\n\n假设表面处理产生的残余应力分布为压应力，并随深度 $z$ 呈指数衰减：$\\,\\sigma_{\\mathrm{res}}(z) = -\\sigma_{r0}\\,\\exp(-z/\\alpha)\\,$，其中 $\\sigma_{r0}0$ 是表面的应力量值（单位 $\\mathrm{MPa}$），$\\alpha$ 是特征衰减长度（单位 $\\mathrm{mm}$）。为了考虑控制裂纹萌生的近表面工艺区，将有效残余平均应力建模为 $\\sigma_{\\mathrm{res}}(z)$ 在 $z\\in[0,\\infty)$ 上对归一化指数影响函数 $\\,w(z) = \\exp(-z/L)/L\\,$ 的平均值，其中 $L$ 是影响深度（单位 $\\mathrm{mm}$）。因此，有效平均应力为\n$$\n\\sigma_{m,\\mathrm{eff}} = \\sigma_{m} + \\int_{0}^{\\infty} w(z)\\,\\sigma_{\\mathrm{res}}(z)\\,dz,\n$$\n其中 $\\sigma_{m}$ 是施加的平均应力。所有施加应力和残余应力均为单轴且共线。\n\n将载荷侧 SWT 参数定义为最大有效应力与总应变幅的乘积，即 $\\,P_{\\mathrm{load}} = \\sigma_{\\max,\\mathrm{eff}}\\,\\epsilon_{a}\\,$，其中 $\\,\\sigma_{\\max,\\mathrm{eff}} = \\sigma_{m,\\mathrm{eff}} + \\sigma_{a}\\,$ 且 $\\,\\epsilon_{a} = \\sigma_{a}/E + (\\sigma_{a}/K')^{1/n'}\\,$。在材料侧，推导当 Manson–Coffin–Basquin 关系中的总应变幅被代入 SWT 定义后所得到的函数依赖关系 $\\,P_{\\mathrm{mat}}(N)\\,$，其中 $N$ 是失效循环次数，$2N$ 是失效反向次数。然后，对下述每个测试案例，求解标量非线性方程\n$$\nP_{\\mathrm{mat}}(N) = P_{\\mathrm{load}}\n$$\n以得到 $N$。\n\n在求得 $N$ 后，通过比较在预测的 $N$ 值下总应变幅的弹性和塑性分量来确定疲劳范畴。当且仅当\n$$\n\\left(\\frac{\\sigma'_{f}}{E}\\right)(2N)^{b} \\ge \\epsilon'_{f}(2N)^{c},\n$$\n时，判定为高周疲劳，否则为低周疲劳。此处，$\\sigma'_{f}$ 是疲劳强度系数（单位 $\\mathrm{MPa}$），$b$ 是疲劳强度指数，$\\epsilon'_{f}$ 是疲劳延性系数（无量纲），$c$ 是疲劳延性指数。此范畴定义应用于每个案例预测的 $N$ 值。\n\n材料常数（所有测试案例通用）：\n- 弹性模量 $E = 210\\,000\\ \\mathrm{MPa}$。\n- 疲劳强度系数 $\\sigma'_{f} = 1100\\ \\mathrm{MPa}$，疲劳强度指数 $b = -0.09$。\n- 疲劳延性系数 $\\epsilon'_{f} = 0.5$（无量纲），疲劳延性指数 $c = -0.6$。\n- 循环强度系数 $K' = 1000\\ \\mathrm{MPa}$，循环应变硬化指数 $n' = 0.2$。\n\n四个测试案例组，每个案例指定为一个元组 $(\\sigma_{a},\\ \\sigma_{m},\\ \\sigma_{r0},\\ \\alpha,\\ L)$，单位为 $(\\mathrm{MPa},\\ \\mathrm{MPa},\\ \\mathrm{MPa},\\ \\mathrm{mm},\\ \\mathrm{mm})$：\n- 案例 A: $(250,\\ 100,\\ 200,\\ 0.1,\\ 0.05)$。\n- 案例 B: $(700,\\ 200,\\ 300,\\ 0.1,\\ 0.2)$。\n- 案例 C: $(250,\\ 200,\\ 300,\\ 0.2,\\ 0.2)$。\n- 案例 D: $(350,\\ 50,\\ 200,\\ 0.05,\\ 0.1)$。\n\n您的程序必须为每个案例计算：\n1) 通过求解 $\\,P_{\\mathrm{mat}}(N) = P_{\\mathrm{load}}\\,$ 预测的失效循环次数 $N$，以及\n2) 范畴指示符 $H$，如果满足上述高周疲劳准则，则 $H=1$，否则 $H=0$。\n\n最终输出要求：\n- 对每个案例，报告四舍五入到最接近整数的 $N$（无量纲循环次数，无单位）和整数范畴指示符 $H$。\n- 您的程序应生成单行输出，包含结果，格式为一个包含四个项目的逗号分隔列表，每个项目是一个双元素列表 $[N,H]$，顺序为 A, B, C, D；例如，$[[N_A,H_A],[N_B,H_B],[N_C,H_C],[N_D,H_D]]$。", "solution": "所提出的问题要求推导并实现一个计算程序，用于预测一个承受循环载荷并存在表面残余应力场的金属部件的疲劳寿命。该分析必须基于材料力学的既定原理，特别是基于应变的疲劳分析。最终目标是计算失效循环次数 $N$，并为一组给定的测试案例将疲劳范畴划分为高周疲劳或低周疲劳。\n\n解题过程系统地进行。首先，我们通过在特征深度上对残余应力进行平均来确定材料所承受的有效平均应力。其次，我们构建载荷侧的疲劳损伤驱动参数。第三，我们推导相应的作为寿命函数的材料侧抗力参数。第四，我们将这两个参数相等，建立一个关于失效循环次数 $N$ 的非线性方程。最后，我们求解该方程并对失效范畴进行分类。\n\n让我们从有效平均应力开始。问题陈述，残余应力 $\\sigma_{\\mathrm{res}}(z)$ 随深度 $z$ 从表面呈指数衰减：\n$$\n\\sigma_{\\mathrm{res}}(z) = -\\sigma_{r0}\\,\\exp(-z/\\alpha)\n$$\n其中 $\\sigma_{r0}$ 是表面压应力的正量值，$\\alpha$ 是衰减长度。有效残余应力被建模为在近表面区域上的加权平均值，权重函数为指数影响函数 $w(z) = (1/L)\\exp(-z/L)$，其中 $L$ 是影响深度。总有效平均应力 $\\sigma_{m,\\mathrm{eff}}$ 是施加的平均应力 $\\sigma_m$ 与此平均残余应力之和：\n$$\n\\sigma_{m,\\mathrm{eff}} = \\sigma_{m} + \\int_{0}^{\\infty} w(z)\\,\\sigma_{\\mathrm{res}}(z)\\,dz\n$$\n我们计算该积分：\n$$\n\\int_{0}^{\\infty} \\frac{1}{L} e^{-z/L} \\left(-\\sigma_{r0} e^{-z/\\alpha}\\right) dz = -\\frac{\\sigma_{r0}}{L} \\int_{0}^{\\infty} \\exp\\left(-z\\left(\\frac{1}{\\alpha} + \\frac{1}{L}\\right)\\right) dz\n$$\n$\\exp(-ax)$ 从 $0$ 到 $\\infty$ 的积分是 $1/a$。这里，指数中的系数是 $a = \\frac{1}{\\alpha} + \\frac{1}{L} = \\frac{L+\\alpha}{\\alpha L}$。因此，积分的计算结果为 $\\frac{\\alpha L}{\\alpha+L}$。所以，残余应力的贡献为：\n$$\n-\\frac{\\sigma_{r0}}{L} \\left( \\frac{\\alpha L}{\\alpha+L} \\right) = -\\sigma_{r0} \\frac{\\alpha}{\\alpha+L}\n$$\n那么有效平均应力由下式给出：\n$$\n\\sigma_{m,\\mathrm{eff}} = \\sigma_{m} - \\sigma_{r0} \\frac{\\alpha}{\\alpha+L}\n$$\n\n接下来，我们建立载荷侧的 Smith–Watson–Topper (SWT) 参数，$P_{\\mathrm{load}}$。该参数定义为最大有效应力 $\\sigma_{\\max,\\mathrm{eff}}$ 与总应变幅 $\\epsilon_{a}$ 的乘积。最大有效应力是有效平均应力与施加的应力幅 $\\sigma_{a}$ 之和：\n$$\n\\sigma_{\\max,\\mathrm{eff}} = \\sigma_{m,\\mathrm{eff}} + \\sigma_{a}\n$$\n总应变幅 $\\epsilon_{a}$ 是其弹性和塑性部分 $\\epsilon_{e,a}$ 和 $\\epsilon_{p,a}$ 之和，它们分别由胡克定律和循环 Ramberg–Osgood 关系给出：\n$$\n\\epsilon_{a} = \\epsilon_{e,a} + \\epsilon_{p,a} = \\frac{\\sigma_{a}}{E} + \\left(\\frac{\\sigma_{a}}{K'}\\right)^{1/n'}\n$$\n其中 $E$ 是弹性模量，$K'$ 是循环强度系数，$n'$ 是循环应变硬化指数。结合这些表达式，载荷侧参数为：\n$$\nP_{\\mathrm{load}} = \\sigma_{\\max,\\mathrm{eff}} \\cdot \\epsilon_{a} = \\left(\\sigma_{m} - \\sigma_{r0} \\frac{\\alpha}{\\alpha+L} + \\sigma_{a}\\right) \\left(\\frac{\\sigma_{a}}{E} + \\left(\\frac{\\sigma_{a}}{K'}\\right)^{1/n'}\\right)\n$$\n此参数代表了所施加载荷条件的严酷程度。\n\n现在，我们推导材料侧 SWT 参数 $P_{\\mathrm{mat}}(N)$，它量化了材料抵抗疲劳的能力，是失效循环次数 $N$ 的函数。SWT 模型假设，当载荷侧参数等于给定寿命下的材料侧参数时，发生失效。材料侧参数是根据完全反向（$\\sigma_m = 0$）加载条件建立的。其在 $N$ 次循环寿命下的值由总应变-寿命关系（Manson–Coffin–Basquin）确定：\n$$\n\\epsilon_{a}(N) = \\frac{\\sigma'_{f}}{E}(2N)^{b} + \\epsilon'_{f}(2N)^{c}\n$$\n其中 $\\sigma'_f$ 和 $b$ 分别是疲劳强度系数和指数，$\\epsilon'_f$ 和 $c$ 分别是疲劳延性系数和指数。项 $2N$ 代表失效反向次数。对于材料侧，最大应力 $\\sigma_{\\max}$ 对应于应力幅 $\\sigma_a$。对应于寿命 $N$ 的应力幅由应变-寿命关系的弹性项（Basquin 定律）给出：\n$$\n\\sigma_{a}(N) = \\sigma'_{f}(2N)^{b}\n$$\n因此，$P_{\\mathrm{mat}}(N)$ 是该应力幅与寿命为 $N$ 时的总应变幅的乘积：\n$$\nP_{\\mathrm{mat}}(N) = \\sigma_{a}(N) \\cdot \\epsilon_{a}(N) = \\left(\\sigma'_{f}(2N)^{b}\\right) \\left(\\frac{\\sigma'_{f}}{E}(2N)^{b} + \\epsilon'_{f}(2N)^{c}\\right)\n$$\n展开此式可得到材料抗力的最终表达式：\n$$\nP_{\\mathrm{mat}}(N) = \\frac{(\\sigma'_{f})^2}{E}(2N)^{2b} + \\sigma'_{f}\\epsilon'_{f}(2N)^{b+c}\n$$\n\n寿命预测的核心是求解关于 $N$ 的非线性标量方程 $P_{\\mathrm{mat}}(N) = P_{\\mathrm{load}}$：\n$$\n\\frac{(\\sigma'_{f})^2}{E}(2N)^{2b} + \\sigma'_{f}\\epsilon'_{f}(2N)^{b+c} = \\left(\\sigma_{m} - \\sigma_{r0} \\frac{\\alpha}{\\alpha+L} + \\sigma_{a}\\right) \\left(\\frac{\\sigma_{a}}{E} + \\left(\\frac{\\sigma_{a}}{K'}\\right)^{1/n'}\\right)\n$$\n由于指数 $b=-0.09$ 和 $c=-0.6$ 均为负数，确保了 $2b  0$ 和 $b+c  0$，因此方程左侧是 $N$ 的单调递减函数。对于每个给定的测试案例，方程右侧是一个常数。这种结构保证了 $N$ 存在唯一的正解，可以使用数值求根算法找到。\n\n最后，根据在预测寿命 $N$ 时弹性应变和塑性应变对总应变幅的相对贡献来对疲劳范畴进行分类。Manson-Coffin-Basquin 方程中的弹性应变幅分量是 $\\epsilon_{e,a}(N) = (\\sigma'_{f}/E)(2N)^b$，塑性分量是 $\\epsilon_{p,a}(N) = \\epsilon'_{f}(2N)^c$。如果弹性应变分量占主导或相等，则判定为高周疲劳，否则为低周疲劳。指示变量 $H$ 定义为：\n$$\nH=1 \\quad \\text{若} \\quad \\left(\\frac{\\sigma'_{f}}{E}\\right)(2N)^{b} \\ge \\epsilon'_{f}(2N)^{c} \\quad \\text{(高周疲劳)}\n$$\n$$\nH=0 \\quad \\text{若} \\quad \\left(\\frac{\\sigma'_{f}}{E}\\right)(2N)^{b}  \\epsilon'_{f}(2N)^{c} \\quad \\text{(低周疲劳)}\n$$\n\n每个测试案例的计算步骤如下：\n1. 定义所有材料常数：$E=210000 \\ \\mathrm{MPa}$，$\\sigma'_{f}=1100 \\ \\mathrm{MPa}$，$b=-0.09$，$\\epsilon'_{f}=0.5$，$c=-0.6$，$K'=1000 \\ \\mathrm{MPa}$，$n'=0.2$。\n2. 对于给定的测试案例 $(\\sigma_{a}, \\sigma_{m}, \\sigma_{r0}, \\alpha, L)$，计算常数 $P_{\\mathrm{load}}$。\n3. 定义函数 $f(N) = P_{\\mathrm{mat}}(N) - P_{\\mathrm{load}}$。\n4. 数值求解方程 $f(N)=0$ 以找到失效循环次数 $N$。\n5. 将 $N$ 四舍五入到最接近的整数。\n6. 在计算出的 $N$ 值处评估高周疲劳准则，以确定整数指示符 $H$。\n7. 存储结果对 $[N, H]$。\n此过程将对所有指定的测试案例实施。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the fatigue life prediction problem for a suite of test cases.\n    \"\"\"\n    \n    # Material constants (common to all test cases)\n    E = 210000.  # Elastic modulus in MPa\n    sig_f_prime = 1100.  # Fatigue strength coefficient in MPa\n    b = -0.09        # Fatigue strength exponent\n    eps_f_prime = 0.5    # Fatigue ductility coefficient (dimensionless)\n    c = -0.6         # Fatigue ductility exponent\n    K_prime = 1000.  # Cyclic strength coefficient in MPa\n    n_prime = 0.2    # Cyclic strain hardening exponent\n\n    # Test suite: each case is a tuple (sigma_a, sigma_m, sigma_r0, alpha, L)\n    # Units: (MPa, MPa, MPa, mm, mm)\n    test_cases = [\n        (250., 100., 200., 0.1, 0.05),  # Case A\n        (700., 200., 300., 0.1, 0.2),   # Case B\n        (250., 200., 300., 0.2, 0.2),   # Case C\n        (350., 50., 200., 0.05, 0.1),   # Case D\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        sig_a, sig_m, sig_r0, alpha, L = case\n\n        # Step 1: Calculate the effective mean stress\n        sig_m_eff = sig_m - sig_r0 * (alpha / (alpha + L))\n\n        # Step 2: Calculate the load-side SWT parameter, P_load\n        sig_max_eff = sig_m_eff + sig_a\n        \n        # Total strain amplitude from Ramberg-Osgood\n        eps_a = (sig_a / E) + (sig_a / K_prime)**(1 / n_prime)\n        \n        P_load = sig_max_eff * eps_a\n\n        # Step 3: Define the function for the material-side SWT parameter, P_mat(N)\n        # We need to solve P_mat(N) - P_load = 0\n        def p_mat_func(N):\n            reversals = 2. * N\n            if reversals  1.: # Life must be at least half a cycle\n                reversals = 1.\n            \n            p_mat = ((sig_f_prime**2) / E) * (reversals)**(2 * b) + \\\n                    (sig_f_prime * eps_f_prime) * (reversals)**(b + c)\n            return p_mat - P_load\n\n        # Step 4: Solve for N using a numerical root-finder\n        # The equation is well-behaved and monotonic. A wide bracket is sufficient.\n        # Life can range from a few cycles to billions.\n        try:\n            sol = root_scalar(p_mat_func, bracket=[1e0, 1e12], method='brentq')\n            N_predicted = sol.root\n        except ValueError:\n            # Handle cases where P_load might be outside the range of P_mat(N),\n            # which could happen with extreme input values although unlikely here.\n            # If P_load is very high, life is short. If P_load is very low, life is long.\n            if p_mat_func(1e0)  0: # P_load is higher than P_mat at N=0.5\n                N_predicted = 0.5\n            else: # P_load is lower than P_mat at N=1e12\n                N_predicted = 1e12\n        \n        N_rounded = int(round(N_predicted))\n\n        # Step 5: Determine the fatigue regime indicator, H\n        reversals_at_N = 2. * N_predicted\n        \n        # Elastic and plastic strain components from Manson-Coffin-Basquin at life N\n        elastic_strain_comp = (sig_f_prime / E) * (reversals_at_N)**b\n        plastic_strain_comp = eps_f_prime * (reversals_at_N)**c\n\n        if elastic_strain_comp >= plastic_strain_comp:\n            H = 1  # High-cycle fatigue\n        else:\n            H = 0  # Low-cycle fatigue\n            \n        results.append([N_rounded, H])\n    \n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2892532"}]}