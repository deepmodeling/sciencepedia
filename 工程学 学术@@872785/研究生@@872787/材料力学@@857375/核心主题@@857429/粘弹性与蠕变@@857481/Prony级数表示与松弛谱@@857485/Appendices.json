{"hands_on_practices": [{"introduction": "要真正掌握一个模型，首先需要理解其物理根源。本练习将引导你从粘弹性的基本构建单元——麦克斯韦模型（Maxwell element）——出发，一步步推导出松弛模量的普罗尼级数（Prony series）表示。此练习还将建立时间域响应 $G(t)$ 与频率域复数模量 $G^*(\\omega)$ 之间的关键联系，这对于分析振荡测试的实验数据至关重要。通过这个基本推导[@problem_id:2913303]，你将为理解和应用更复杂的粘弹性模型打下坚实的基础。", "problem": "考虑一个一维小应变线性粘弹性固体，其由一个 Maxwell 元件建模：一个模量为 $g$ 的线性弹性弹簧与一个粘度为 $\\eta$ 的牛顿粘壶串联而成。设总应变为 $\\varepsilon(t)$，串联元件中的共同应力为 $\\sigma(t)$。假设系统满足因果性和时不变性。\n\n严格从以下几点出发：\n- 广义标准线性固体的串联规则（串联时应变相加，应力相等），\n- 弹簧和粘壶的本构律（$\\sigma_{\\text{spring}}(t)=g\\,\\varepsilon_{\\text{spring}}(t)$ 和 $\\sigma_{\\text{dashpot}}(t)=\\eta\\,\\dot{\\varepsilon}_{\\text{dashpot}}(t)$），以及\n- 线性粘弹性中的 Boltzmann 叠加原理（因果应力是松弛模量与应变率的卷积），\n\n执行以下步骤：\n\n1) 对于单个 Maxwell 元件，推导联系 $\\sigma(t)$ 和 $\\varepsilon(t)$ 的微分方程，并对一个小的阶跃应变输入 $\\varepsilon(t)=\\varepsilon_{0} H(t)$ 求解该方程，其中 $H(t)$ 是 Heaviside 阶跃函数，$\\varepsilon_{0}$ 是一个常数。用 $g$ 和 $\\eta$ 表示松弛时间 $\\tau$，并由此得到当 $t \\ge 0$ 时的松弛模量 $G(t)$。\n\n2) 考虑 $N$ 个这样的 Maxwell 元件并联，其参数为 $\\{(g_{i},\\eta_{i})\\}_{i=1}^{N}$，因此每个元件的松弛时间为 $\\tau_{i}=\\eta_{i}/g_{i}$。使用并联规则（并联时应力相加，应变相等），推导该组合体的总松弛模量 $G(t)$。将你的结果解释为一个有限离散松弛谱。\n\n3) 对于第 2 部分中的并联组合体，对该固体施加一个形式为 $\\varepsilon(t)=\\Re\\{\\hat{\\varepsilon}\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$ 的稳态振荡应变，其中角频率为 $\\omega>0$，复振幅为 $\\hat{\\varepsilon}$，复数单位为 $\\mathrm{i}$。从线性粘弹性的因果卷积表示出发，推导由 $\\sigma(t)=\\Re\\{G^{\\ast}(\\omega)\\,\\hat{\\varepsilon}\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$ 定义的复模量 $G^{\\ast}(\\omega)$。以 $\\{g_{i}\\}$、$\\{\\tau_{i}\\}$ 和 $\\omega$ 的闭合形式表示你关于 $G^{\\ast}(\\omega)$ 的最终答案。\n\n你的最终答案必须是 $G^{\\ast}(\\omega)$ 作为 $\\omega$、$N$、$\\{g_{i}\\}$ 和 $\\{\\tau_{i}\\}$ 的函数的一个单一解析表达式。最终答案中不要包含中间步骤或任何单位。", "solution": "首先对问题进行验证。给定条件描述了线性粘弹性中的一个标准问题，特别是广义 Maxwell 模型松弛模量及其相应复模量的推导。该问题具有科学依据、适定、客观、自洽且一致。这是一个标准的推导要求，并非微不足道，其解可通过既定理论进行验证。因此，该问题是有效的，将提供解答。\n\n解答按要求分三部分进行。\n\n第 1 部分：单个 Maxwell 元件松弛模量的推导。\n\n一个 Maxwell 元件由一个模量为 $g$ 的线性弹性弹簧和一个粘度为 $\\eta$ 的牛顿粘壶串联而成。对于串联连接，总应变 $\\varepsilon(t)$ 是各个应变之和，而应力 $\\sigma(t)$ 在两个元件中是相同的。\n\n应变相加规则为：\n$$ \\varepsilon(t) = \\varepsilon_{\\text{spring}}(t) + \\varepsilon_{\\text{dashpot}}(t) $$\n应力相等规则为：\n$$ \\sigma(t) = \\sigma_{\\text{spring}}(t) = \\sigma_{\\text{dashpot}}(t) $$\n弹簧和粘壶的本构律为：\n$$ \\sigma_{\\text{spring}}(t) = g \\, \\varepsilon_{\\text{spring}}(t) $$\n$$ \\sigma_{\\text{dashpot}}(t) = \\eta \\, \\frac{d\\varepsilon_{\\text{dashpot}}(t)}{dt} = \\eta \\, \\dot{\\varepsilon}_{\\text{dashpot}}(t) $$\n根据这些关系，我们用共同应力 $\\sigma(t)$ 来表示应变：\n$$ \\varepsilon_{\\text{spring}}(t) = \\frac{\\sigma(t)}{g} $$\n$$ \\dot{\\varepsilon}_{\\text{dashpot}}(t) = \\frac{\\sigma(t)}{\\eta} $$\n将应变相加方程对时间 $t$ 求导，得到：\n$$ \\dot{\\varepsilon}(t) = \\dot{\\varepsilon}_{\\text{spring}}(t) + \\dot{\\varepsilon}_{\\text{dashpot}}(t) $$\n代入本构关系，我们得到联系总应力 $\\sigma(t)$ 和总应变 $\\varepsilon(t)$ 的 Maxwell 元件的控制微分方程：\n$$ \\dot{\\varepsilon}(t) = \\frac{1}{g} \\dot{\\sigma}(t) + \\frac{1}{\\eta} \\sigma(t) $$\n我们被要求对一个小的阶跃应变输入 $\\varepsilon(t) = \\varepsilon_{0} H(t)$ 求解此方程，其中 $H(t)$ 是 Heaviside 阶跃函数，$\\varepsilon_{0}$ 是一个常数。对于 $t > 0$，$\\varepsilon(t) = \\varepsilon_{0}$，因此其时间导数 $\\dot{\\varepsilon}(t) = 0$。该微分方程简化为关于 $\\sigma(t)$ 的一个齐次一阶线性常微分方程：\n$$ 0 = \\frac{1}{g} \\dot{\\sigma}(t) + \\frac{1}{\\eta} \\sigma(t) \\implies \\dot{\\sigma}(t) = -\\frac{g}{\\eta} \\sigma(t) $$\n我们定义松弛时间 $\\tau = \\eta/g$。方程变为：\n$$ \\dot{\\sigma}(t) = -\\frac{1}{\\tau} \\sigma(t) $$\n对于 $t > 0$，通解为 $\\sigma(t) = C \\exp(-t/\\tau)$，其中 $C$ 是一个积分常数。\n为了确定 $C$，我们求解施加阶跃应变后瞬间的初始应力 $\\sigma(0^{+})$。在 $t=0^{+}$ 时，抵抗应变率的粘壶没有时间变形，因此 $\\varepsilon_{\\text{dashpot}}(0^{+}) = 0$。全部瞬时应变由弹簧承担：$\\varepsilon(0^{+}) = \\varepsilon_{\\text{spring}}(0^{+}) = \\varepsilon_{0}$。因此，初始应力完全由弹簧的响应决定：\n$$ \\sigma(0^{+}) = g \\, \\varepsilon_{\\text{spring}}(0^{+}) = g \\, \\varepsilon_{0} $$\n因此，常数 $C$ 是 $g \\varepsilon_{0}$。对于 $t \\ge 0$ 的应力松弛为：\n$$ \\sigma(t) = g \\, \\varepsilon_{0} \\exp(-t/\\tau) $$\n松弛模量 $G(t)$ 定义为对单位阶跃应变的应力响应，即 $\\sigma(t) = G(t) \\varepsilon_{0}$。因此，对于单个 Maxwell 元件，当 $t \\ge 0$ 时的松弛模量为：\n$$ G(t) = g \\exp(-t/\\tau), \\quad \\text{其中} \\quad \\tau = \\frac{\\eta}{g} $$\n\n第 2 部分：并联组合体松弛模量的推导。\n\n现在，考虑 $N$ 个 Maxwell 元件并联。对于并联连接，总应变 $\\varepsilon(t)$ 在所有元件上都相同，而总应力 $\\sigma(t)$ 是每个元件中应力之和。\n\n应变相等规则为：\n$$ \\varepsilon(t) = \\varepsilon_{i}(t) \\quad \\text{对于} \\quad i=1, 2, \\dots, N $$\n应力相加规则为：\n$$ \\sigma(t) = \\sum_{i=1}^{N} \\sigma_{i}(t) $$\n每个元件 $i$ 的参数为 $(g_{i}, \\eta_{i})$，相应的松弛时间为 $\\tau_{i} = \\eta_{i}/g_{i}$。\n当组合体受到阶跃应变 $\\varepsilon(t) = \\varepsilon_{0} H(t)$ 时，每个元件 $i$ 都承受相同的应变。根据第 1 部分，元件 $i$ 的应力响应为：\n$$ \\sigma_{i}(t) = g_{i} \\, \\varepsilon_{0} \\exp(-t/\\tau_{i}) \\quad \\text{对于} \\quad t \\ge 0 $$\n总应力是这些单个应力之和：\n$$ \\sigma(t) = \\sum_{i=1}^{N} \\sigma_{i}(t) = \\sum_{i=1}^{N} g_{i} \\, \\varepsilon_{0} \\exp(-t/\\tau_{i}) $$\n提出 $\\varepsilon_{0}$：\n$$ \\sigma(t) = \\left( \\sum_{i=1}^{N} g_{i} \\exp(-t/\\tau_{i}) \\right) \\varepsilon_{0} $$\n组合体的总松弛模量 $G(t)$ 由 $\\sigma(t) = G(t) \\varepsilon_{0}$ 定义。因此，对于并联组合体，当 $t \\ge 0$ 时的松弛模量为：\n$$ G(t) = \\sum_{i=1}^{N} g_{i} \\exp(-t/\\tau_{i}) $$\n这是一个 Prony 级数表示。参数对集合 $\\{(g_{i}, \\tau_{i})\\}_{i=1}^{N}$ 构成一个有限离散松弛谱，其中 $g_{i}$ 是权重，$\\tau_{i}$ 是松弛时间。\n\n第 3 部分：并联组合体复模量的推导。\n\nBoltzmann 叠加原理指出，对于一个一般的因果应变历史 $\\varepsilon(t)$，应力 $\\sigma(t)$ 由以下卷积积分给出：\n$$ \\sigma(t) = \\int_{-\\infty}^{t} G(t-t') \\frac{d\\varepsilon(t')}{dt'} dt' $$\n我们考虑一个稳态振荡应变，使用复数表示法处理最为方便。设复应变为 $\\varepsilon_{c}(t) = \\hat{\\varepsilon} \\exp(\\mathrm{i} \\omega t)$。物理应变是 $\\varepsilon(t) = \\Re\\{\\varepsilon_{c}(t)\\}$。相应的复应力是 $\\sigma_{c}(t)$。对于线性时不变系统，输出也将以相同频率振荡：$\\sigma_{c}(t) = G^{*}(\\omega) \\varepsilon_{c}(t)$，其中 $G^{*}(\\omega)$ 是复模量。\n复应变率为 $\\dot{\\varepsilon}_{c}(t) = \\mathrm{i} \\omega \\hat{\\varepsilon} \\exp(\\mathrm{i} \\omega t)$。代入卷积积分：\n$$ \\sigma_{c}(t) = \\int_{-\\infty}^{t} G(t-t') \\left( \\mathrm{i} \\omega \\hat{\\varepsilon} \\exp(\\mathrm{i} \\omega t') \\right) dt' $$\n我们引入变量替换 $s = t-t'$，这意味着 $t' = t-s$ 且 $dt' = -ds$。积分限从 $t' \\in (-\\infty, t]$ 变为 $s \\in [0, \\infty)$。\n$$ \\sigma_{c}(t) = \\int_{\\infty}^{0} G(s) \\left( \\mathrm{i} \\omega \\hat{\\varepsilon} \\exp(\\mathrm{i} \\omega (t-s)) \\right) (-ds) $$\n$$ \\sigma_{c}(t) = \\mathrm{i} \\omega \\hat{\\varepsilon} \\int_{0}^{\\infty} G(s) \\exp(\\mathrm{i} \\omega t - \\mathrm{i} \\omega s) ds $$\n$$ \\sigma_{c}(t) = \\left( \\mathrm{i} \\omega \\int_{0}^{\\infty} G(s) \\exp(-\\mathrm{i} \\omega s) ds \\right) \\hat{\\varepsilon} \\exp(\\mathrm{i} \\omega t) $$\n将此与定义 $\\sigma_{c}(t) = G^{*}(\\omega) \\hat{\\varepsilon} \\exp(\\mathrm{i} \\omega t)$ 进行比较，我们确定复模量为：\n$$ G^{*}(\\omega) = \\mathrm{i} \\omega \\int_{0}^{\\infty} G(t) \\exp(-\\mathrm{i} \\omega t) dt $$\n现在，我们将并联组合体的松弛模量 $G(t) = \\sum_{i=1}^{N} g_{i} \\exp(-t/\\tau_{i})$ 代入此表达式。\n$$ G^{*}(\\omega) = \\mathrm{i} \\omega \\int_{0}^{\\infty} \\left( \\sum_{i=1}^{N} g_{i} \\exp(-t/\\tau_{i}) \\right) \\exp(-\\mathrm{i} \\omega t) dt $$\n假设一致收敛，我们可以交换求和与积分的顺序：\n$$ G^{*}(\\omega) = \\sum_{i=1}^{N} g_{i} \\left( \\mathrm{i} \\omega \\int_{0}^{\\infty} \\exp(-t/\\tau_{i}) \\exp(-\\mathrm{i} \\omega t) dt \\right) $$\n$$ G^{*}(\\omega) = \\sum_{i=1}^{N} g_{i} \\left( \\mathrm{i} \\omega \\int_{0}^{\\infty} \\exp\\left(-t\\left(\\frac{1}{\\tau_{i}} + \\mathrm{i} \\omega\\right)\\right) dt \\right) $$\n该积分计算如下：\n$$ \\int_{0}^{\\infty} \\exp\\left(-t\\left(\\frac{1}{\\tau_{i}} + \\mathrm{i} \\omega\\right)\\right) dt = \\left[ \\frac{\\exp\\left(-t\\left(\\frac{1}{\\tau_{i}} + \\mathrm{i} \\omega\\right)\\right)}{-\\left(\\frac{1}{\\tau_{i}} + \\mathrm{i} \\omega\\right)} \\right]_{0}^{\\infty} $$\n由于 $\\tau_{i} > 0$，指数中系数的实部为正，因此表达式在上限 $t=\\infty$ 处计算结果为 0。在下限 $t=0$ 处，值为 1。该积分变为：\n$$ 0 - \\frac{1}{-\\left(\\frac{1}{\\tau_{i}} + \\mathrm{i} \\omega\\right)} = \\frac{1}{\\frac{1}{\\tau_{i}} + \\mathrm{i} \\omega} = \\frac{\\tau_{i}}{1 + \\mathrm{i} \\omega \\tau_{i}} $$\n将此结果代回 $G^{*}(\\omega)$ 的表达式中：\n$$ G^{*}(\\omega) = \\sum_{i=1}^{N} g_{i} \\left( \\mathrm{i} \\omega \\frac{\\tau_{i}}{1 + \\mathrm{i} \\omega \\tau_{i}} \\right) $$\n这就给出了复模量的最终闭合形式表达式：\n$$ G^{*}(\\omega) = \\sum_{i=1}^{N} g_{i} \\frac{\\mathrm{i} \\omega \\tau_{i}}{1 + \\mathrm{i} \\omega \\tau_{i}} $$\n这是所要求的用 $\\{g_{i}\\}$、$\\{\\tau_{i}\\}$ 和 $\\omega$ 表示的表达式。", "answer": "$$\n\\boxed{\\sum_{i=1}^{N} g_{i} \\frac{\\mathrm{i} \\omega \\tau_{i}}{1 + \\mathrm{i} \\omega \\tau_{i}}}\n$$", "id": "2913303"}, {"introduction": "在建立了普罗尼级数模型之后，下一步是应用它来预测和理解材料在不同加载条件下的行为。本练习[@problem_id:2913358]不再局限于简单的阶跃应变，而是挑战你分析材料在更复杂的两步应变历史下的应力响应。这项实践的价值在于，它不仅能加深你对线性粘弹性中玻尔兹曼叠加原理（Boltzmann superposition principle）的理解，还能揭示一个深刻的物理见解：应力的瞬时跳变如何与材料的瞬时模量 $G(0^+)$ 直接关联。", "problem": "一个小应变、等温的线性粘弹性 (LVE) 聚合物在简单剪切作用下的特性由一个具有非零长期模量的双项 Prony 级数表示的松弛模量来表征，\n$$\nG(t) \\;=\\; G_{\\infty} \\;+\\; \\sum_{i=1}^{2} G_{i} \\exp\\!\\big(-t/\\tau_{i}\\big),\n$$\n其中 $G_{\\infty}$、$G_{i}$ 和 $\\tau_{i}$ 是正常数。考虑以下具体参数：\n$$\nG_{\\infty} = 2~\\text{MPa}, \\qquad G_{1} = 8~\\text{MPa}, \\qquad G_{2} = 5~\\text{MPa},\n$$\n$$\n\\tau_{1} = 0.1~\\text{s}, \\qquad \\tau_{2} = 10~\\text{s}.\n$$\n施加一个两步剪切应变历史：\n$$\n\\gamma(t) \\;=\\; \\gamma_{0} H(t) \\;+\\; \\Delta\\gamma\\, H(t - t_{1}),\n$$\n其中 $\\gamma_{0} = 0.02$，$t_{1} = 1~\\text{s}$，$H(t)$ 是 Heaviside 单位阶跃函数，并且第二步选择卸载回零应变，即 $\\Delta\\gamma = -\\gamma_{0}$。仅使用线性粘弹性 Boltzmann 叠加原理和单位应变阶跃下松弛模量的定义，推导在第二步 $t=t_{1}$ 时刻紧接之前和之后的应力表达式，计算瞬时应力跳跃 $\\Delta\\sigma = \\sigma(t_{1}^{+}) - \\sigma(t_{1}^{-})$，并解释在 $t_{1}^{-}$ 和 $t_{1}^{+}$ 测得的值如何分离出差值 $G(0^{+}) - G(t_{1})$。\n\n报告应力跳跃 $\\Delta\\sigma$ 的数值，单位为兆帕斯卡 (MPa)。将您的答案四舍五入至四位有效数字。", "solution": "所述问题具有科学依据、提法恰当且客观。这是线性粘弹性理论中的一个标准问题，可以使用 Boltzmann 叠加原理求解。所有必要的数据均已提供且一致。\n\n线性粘弹性材料在剪切作用下的本构关系由 Boltzmann 叠加积分给出，该积分将时刻 $t$ 的应力 $\\sigma(t)$ 与应变率 $\\dot{\\gamma}(t) = d\\gamma(t)/dt$ 的整个历史联系起来：\n$$\n\\sigma(t) = \\int_{-\\infty}^{t} G(t-s) \\frac{d\\gamma(s)}{ds} ds\n$$\n其中 $G(t)$ 是剪切松弛模量。指定的应变历史是一个两步函数：\n$$\n\\gamma(t) = \\gamma_{0} H(t) + \\Delta\\gamma H(t - t_{1})\n$$\n这里，$H(t)$ 是 Heaviside 单位阶跃函数。通过对 $\\gamma(t)$ 关于时间求导得到应变率，这会产生一系列 Dirac delta 函数：\n$$\n\\frac{d\\gamma(t)}{dt} = \\gamma_{0} \\delta(t) + \\Delta\\gamma \\delta(t - t_{1})\n$$\n将应变率代入叠加积分中，得到：\n$$\n\\sigma(t) = \\int_{-\\infty}^{t} G(t-s) \\left[ \\gamma_{0} \\delta(s) + \\Delta\\gamma \\delta(s - t_{1}) \\right] ds\n$$\n根据 Dirac delta 函数的筛选性质，该积分得以简化。对于 $0 \\le t  t_{1}$，只有 $s=0$ 处的第一个 delta 函数对积分有贡献，结果为：\n$$\n\\sigma(t) = \\gamma_{0} G(t-0) = \\gamma_{0} G(t)\n$$\n对于 $t \\ge t_{1}$，两个 delta 函数都有贡献，应力是每一步响应的总和：\n$$\n\\sigma(t) = \\gamma_{0} G(t-0) + \\Delta\\gamma G(t-t_{1}) = \\gamma_{0} G(t) + \\Delta\\gamma G(t-t_{1})\n$$\n为了求得第二步紧接之前的应力，我们在 $t \\to t_{1}^{-}$ 的极限下计算应力表达式：\n$$\n\\sigma(t_{1}^{-}) = \\lim_{t \\to t_{1}^{-}} \\left[ \\gamma_{0} G(t) \\right] = \\gamma_{0} G(t_{1})\n$$\n松弛模量 $G(t)$ 在 $t0$ 时是连续的，因此极限就是函数在 $t=t_1$ 处的值。\n\n为了求得第二步紧接之后的应力，我们在 $t \\to t_{1}^{+}$ 的极限下计算应力表达式：\n$$\n\\sigma(t_{1}^{+}) = \\lim_{t \\to t_{1}^{+}} \\left[ \\gamma_{0} G(t) + \\Delta\\gamma G(t - t_{1}) \\right]\n$$\n在这个极限下，$t \\to t_{1}$，并且自第二步以来的经过时间 $t-t_{1}$ 从正方向趋近于 0。因此：\n$$\n\\sigma(t_{1}^{+}) = \\gamma_{0} G(t_{1}) + \\Delta\\gamma G(0^{+})\n$$\n其中 $G(0^{+}) = \\lim_{t \\to 0^{+}} G(t)$ 是瞬时剪切模量。\n\n在 $t=t_{1}$ 处的瞬时应力跳跃 $\\Delta\\sigma$ 是应变阶跃之后和之前的应力之差：\n$$\n\\Delta\\sigma = \\sigma(t_{1}^{+}) - \\sigma(t_{1}^{-}) = \\left[ \\gamma_{0} G(t_{1}) + \\Delta\\gamma G(0^{+}) \\right] - \\left[ \\gamma_{0} G(t_{1}) \\right] = \\Delta\\gamma G(0^{+})\n$$\n这个基本结果表明，应变的瞬时变化 $\\Delta\\gamma$ 产生一个瞬时应力变化 $\\Delta\\sigma$，该变化仅由材料的瞬时模量 $G(0^{+})$ 决定。\n\n我们从给定的 Prony 级数计算 $G(0^{+})$：\n$$\nG(t) = G_{\\infty} + \\sum_{i=1}^{2} G_{i} \\exp(-t/\\tau_{i})\n$$\n$$\nG(0^{+}) = \\lim_{t\\to 0^{+}} \\left[ G_{\\infty} + G_{1}\\exp(-t/\\tau_1) + G_{2}\\exp(-t/\\tau_2) \\right] = G_{\\infty} + G_{1} + G_{2}\n$$\n使用所提供的参数：$G_{\\infty} = 2~\\text{MPa}$，$G_{1} = 8~\\text{MPa}$，和 $G_{2} = 5~\\text{MPa}$：\n$$\nG(0^{+}) = 2 + 8 + 5 = 15~\\text{MPa}\n$$\n应变跳跃为 $\\Delta\\gamma = -\\gamma_{0} = -0.02$。因此，应力跳跃为：\n$$\n\\Delta\\sigma = (-0.02) \\times (15~\\text{MPa}) = -0.3~\\text{MPa}\n$$\n问题要求解释如何分离出 $G(0^{+}) - G(t_{1})$。注意，对于连续松弛函数，$G(t_{1}^{-}) = G(t_{1})$。我们从“测得的”应力值得到两个方程：\n$$\n1) \\quad \\sigma(t_{1}^{-}) = \\gamma_{0} G(t_{1})\n$$\n$$\n2) \\quad \\sigma(t_{1}^{+}) = \\gamma_{0} G(t_{1}) + \\Delta\\gamma G(0^{+})\n$$\n从方程 $(2)$，我们可以将 $\\sigma(t_{1}^{+})$ 表示为 $\\sigma(t_{1}^{+}) = \\sigma(t_{1}^{-}) + \\Delta\\gamma G(0^{+})$。使用 $\\Delta\\gamma = -\\gamma_{0}$，这变为 $\\sigma(t_{1}^{+}) = \\sigma(t_{1}^{-}) - \\gamma_{0} G(0^{+})$。\n我们要求解 $G(0^{+}) - G(t_{1})$。从方程 $(1)$，得到 $G(t_1) = \\sigma(t_1^{-}) / \\gamma_0$。从重新整理的方程 $(2)$，得到 $G(0^{+}) = (\\sigma(t_1^{-}) - \\sigma(t_1^{+})) / \\gamma_0$。\n因此，\n$$\nG(0^{+}) - G(t_{1}) = \\frac{\\sigma(t_1^{-}) - \\sigma(t_1^{+})}{\\gamma_0} - \\frac{\\sigma(t_1^{-})}{\\gamma_0} = \\frac{\\sigma(t_1^{-}) - \\sigma(t_1^{+}) - \\sigma(t_1^{-})}{\\gamma_0} = -\\frac{\\sigma(t_1^{+})}{\\gamma_0}\n$$\n这表明瞬时模量与时刻 $t_1$ 的模量之间的差值，仅由第二步应变阶跃后立即测量的应力 $\\sigma(t_{1}^{+})$ 和初始应变阶跃的大小 $\\gamma_{0}$ 决定。\n\n应力跳跃 $\\Delta\\sigma$ 的数值是 $-0.3~\\text{MPa}$。报告到四位有效数字为 $-0.3000~\\text{MPa}$。", "answer": "$$\n\\boxed{-0.3000}\n$$", "id": "2913358"}, {"introduction": "理论模型的最终目的是解释和预测真实世界的现象，这就要求我们能够将模型与实验数据联系起来。这项计算实践[@problem_id:2913322]旨在解决从实验测量的储能模量 $G'(\\omega)$ 和损耗模量 $G''(\\omega)$ 中确定普罗尼级数参数的关键任务。通过将参数拟合问题构建为一个带有非负约束的线性最小二乘问题，本练习展示了一种在材料表征中广泛使用的强大而实用的方法，并为你提供了宝贵的数值实现经验。", "problem": "您的任务是对由具有离散Prony级数弛豫谱的广义麦克斯韦模型描述的线性粘弹性材料的储能模量和损耗模量进行联合拟合的公式化和实现。从玻尔兹曼叠加原理和通过弛豫响应的傅里叶变换 (FT) 定义的复数模量出发。证明对于由一组有限的弛豫时间 $\\{\\tau_{i}\\}_{i=1}^{N}$、非负模态强度 $\\{g_{i}\\}_{i=1}^{N}$ 和一个非负平衡（橡胶态）模量 $G_{\\infty}$ 组成的离散弛豫谱，储能模量 $G'(\\omega)$ 和损耗模量 $G''(\\omega)$ 可以表示为角频率 $\\omega$ 的函数，并且它们对测量数据的联合最小二乘拟合可以转化为一个对所有未知数具有非负约束的单一线性最小二乘问题。未知数是向量 $\\mathbf{x} = [g_{1},\\dots,g_{N},G_{\\infty}]^{\\mathsf{T}}$，并满足约束条件 $g_{i} \\ge 0$ 和 $G_{\\infty} \\ge 0$。您的程序必须通过将储能和损耗关系堆叠成一个线性系统来解决这个联合拟合的非负最小二乘问题，并且必须在一组合成测试套件上验证真实参数的恢复情况。\n\n所有量都必须使用国际单位制 (SI)：模量单位为帕斯卡 $\\text{(Pa)}$，弛豫时间单位为秒 $\\text{(s)}$，角频率单位为弧度/秒 $\\text{(rad/s)}$。输出是无量纲的布尔值，指示每个测试用例的成功或失败。\n\n利用广义麦克斯韦模型和离散Prony级数所隐含的 $G'(\\omega)$ 和 $G''(\\omega)$ 对 $\\{g_{i}\\}$ 和 $G_{\\infty}$ 的线性依赖性来构造设计矩阵。将所有测量角频率 $\\{\\omega_{m}\\}_{m=1}^{M}$ 下的 $G'(\\omega)$ 和 $G''(\\omega)$ 方程堆叠成一个单一的超定系统 $\\mathbf{A}\\mathbf{x} \\approx \\mathbf{b}$，并求解\n$$\n\\min_{\\mathbf{x} \\ge \\mathbf{0}}\\,\\lVert \\mathbf{A}\\mathbf{x} - \\mathbf{b} \\rVert_{2}^{2}.\n$$\n然后通过与真实值进行比较来评估恢复参数的质量。\n\n实现一个程序，为以下三个合成测试套件构建并解决联合非负最小二乘问题。对于每个套件，从真实参数生成无噪声的测量值 $\\widehat{G}'(\\omega_{m})$ 和 $\\widehat{G}''(\\omega_{m})$，使用指定的弛豫时间网格进行拟合，并报告恢复的参数是否满足规定的容差。使用以下测试套件，所有数值均采用SI单位：\n\n- 测试用例 1（典型情况）：\n  - 用于拟合的弛豫时间：$\\boldsymbol{\\tau} = [\\,0.01,\\,0.2,\\,5.0\\,]$.\n  - 真实模态强度：$\\mathbf{g}^{\\mathrm{true}} = [\\,2.5\\times 10^{6},\\,1.0\\times 10^{6},\\,0.5\\times 10^{6}\\,]$.\n  - 真实平衡模量：$G_{\\infty}^{\\mathrm{true}} = 0.8\\times 10^{6}$.\n  - 角频率：$M=25$ 个从 $0.1$ 到 $1000$ 对数均匀分布的值，即 $\\omega_{m}$ 在 $\\log_{10}$ 尺度上均匀跨越 $[\\,10^{-1},\\,10^{3}\\,]$。\n\n- 测试用例 2（包含零平衡模量和零频率的边界条件）：\n  - 用于拟合的弛豫时间：$\\boldsymbol{\\tau} = [\\,0.05,\\,5.0\\,]$.\n  - 真实模态强度：$\\mathbf{g}^{\\mathrm{true}} = [\\,3.0\\times 10^{5},\\,7.0\\times 10^{5}\\,]$.\n  - 真实平衡模量：$G_{\\infty}^{\\mathrm{true}} = 0$.\n  - 角频率：$\\boldsymbol{\\omega} = [\\,0,\\,0.01,\\,0.1,\\,1,\\,10,\\,100\\,]$.\n\n- 测试用例 3（包含额外弛豫时间的过参数化拟合）：\n  - 用于拟合的弛豫时间：$\\boldsymbol{\\tau} = [\\,0.01,\\,0.1,\\,1.0,\\,10.0,\\,100.0\\,]$.\n  - 在此网格上的真实模态强度：$\\mathbf{g}^{\\mathrm{true}} = [\\,0.0,\\,1.2\\times 10^{5},\\,0.0,\\,2.8\\times 10^{5},\\,0.0\\,]$.\n  - 真实平衡模量：$G_{\\infty}^{\\mathrm{true}} = 0$.\n  - 角频率：$M=30$ 个从 $0.01$ 到 $1000$ 对数均匀分布的值，即 $\\omega_{m}$ 在 $\\log_{10}$ 尺度上均匀跨越 $[\\,10^{-2},\\,10^{3}\\,]$。\n\n为每个测试定义成功标准如下。设 $\\mathbf{x}^{\\mathrm{true}} = [\\mathbf{g}^{\\mathrm{true}},\\,G_{\\infty}^{\\mathrm{true}}]^{\\mathsf{T}}$，并设 $\\widehat{\\mathbf{x}}$ 为拟合的非负解。计算相对误差\n$$\n\\varepsilon_{\\mathrm{rel}} = \\frac{\\lVert \\widehat{\\mathbf{x}} - \\mathbf{x}^{\\mathrm{true}} \\rVert_{2}}{\\lVert \\mathbf{x}^{\\mathrm{true}} \\rVert_{2}}.\n$$\n如果 $\\varepsilon_{\\mathrm{rel}} \\le 10^{-8}$，则声明测试通过。\n\n您的程序应生成单行输出，其中包含三个测试的布尔结果，形式为一个用方括号括起来的、逗号分隔的列表（例如，$[\\mathrm{True}, \\mathrm{False}, \\mathrm{True}]$）。不应产生任何其他输出。角度以弧度为单位，如果使用任何三角函数量，必须使用以弧度为单位的角度进行计算。", "solution": "所述问题是有效的，代表了计算流变学中的一项标准任务：根据实验数据确定线性粘弹性模型的材料参数。使用合成的无噪声数据可以直接验证数值方法恢复真实参数的能力。问题中对 $G_\\infty$ 的描述已更正为“平衡模量”，与其在方程中的数学作用一致。\n\n线性粘弹性的基础是玻尔兹曼叠加原理，它将应力 $\\sigma(t)$ 表示为弛豫模量 $G(t)$ 与应变率历史 $\\dot{\\gamma}(t')$ 的卷积：\n$$\n\\sigma(t) = \\int_{-\\infty}^{t} G(t-t') \\dot{\\gamma}(t') dt'\n$$\n对于振荡应变 $\\gamma(t) = \\gamma_0 e^{i\\omega t}$，应力响应也是正弦的，$\\sigma(t) = \\sigma_0 e^{i\\omega t}$，定义了复数模量 $G^*(\\omega) = \\sigma(t)/\\gamma(t)$。将应变历史代入叠加积分，得到复数模量是弛豫模量的傅里叶-拉普拉斯变换：\n$$\nG^*(\\omega) = i\\omega \\int_0^\\infty G(s) e^{-i\\omega s} ds\n$$\n广义麦克斯韦模型用Prony级数描述弛豫模量 $G(t)$。标准形式包含一个平衡模量 $G_e$ (在此问题中记为 $G_\\infty$)，用于描述长时间下的类固体行为：\n$$\nG(t) = G_\\infty + \\sum_{i=1}^{N} g_i e^{-t/\\tau_i}\n$$\n其中 $\\{g_i, \\tau_i\\}$ 是 $N$ 个麦克斯韦单元的强度和弛豫时间。将此式代入 $G^*(\\omega)$ 的变换并进行积分，可得到储能模量 $G'(\\omega) = \\mathrm{Re}[G^*(\\omega)]$ 和损耗模量 $G''(\\omega) = \\mathrm{Im}[G^*(\\omega)]$ 的表达式。在考虑了常数项 $G_\\infty$ 产生的奇点后，标准结果是：\n$$\nG'(\\omega) = G_\\infty + \\sum_{i=1}^{N} g_i \\frac{\\omega^2 \\tau_i^2}{1 + \\omega^2 \\tau_i^2}\n$$\n$$\nG''(\\omega) = \\sum_{i=1}^{N} g_i \\frac{\\omega \\tau_i}{1 + \\omega^2 \\tau_i^2}\n$$\n任务是从一组在频率 $\\{\\omega_m\\}_{m=1}^{M}$ 下测量的 $M$ 个储能模量 $\\widehat{G}'(\\omega_m)$ 和损耗模量 $\\widehat{G}''(\\omega_m)$ 中找到参数向量 $\\mathbf{x} = [g_1, g_2, \\dots, g_N, G_{\\infty}]^{\\mathsf{T}}$。$G'(\\omega)$ 和 $G''(\\omega)$ 都是未知参数 $\\{g_i, G_{\\infty}\\}$ 的线性函数。这使我们能够将联合拟合问题表述为单个线性系统。我们可以将所有测量频率下的方程堆叠成一个矩阵方程 $\\mathbf{A} \\mathbf{x} \\approx \\mathbf{b}$。\n\n观测向量 $\\mathbf{b}$是通过拼接 $M$ 个储能模量测量值和 $M$ 个损耗模量测量值来构造的：\n$$\n\\mathbf{b} = [\\widehat{G}'(\\omega_1), \\dots, \\widehat{G}'(\\omega_M), \\widehat{G}''(\\omega_1), \\dots, \\widehat{G}''(\\omega_M)]^{\\mathsf{T}}\n$$\n该向量的维度为 $2M \\times 1$。设计矩阵 $\\mathbf{A}$ 的维度将为 $2M \\times (N+1)$。$\\mathbf{A}$ 的列是模型预测值相对于 $\\mathbf{x}$ 中参数的偏导数。$\\mathbf{A}$ 的结构如下：\n对于前 $M$ 行，对应于 $G'(\\omega_m)$：\n$$\nA_{m,j} = \\frac{\\omega_m^2 \\tau_j^2}{1 + \\omega_m^2 \\tau_j^2} \\quad \\text{for } j=1, \\dots, N \\quad \\text{ (} g_j \\text{ 的系数)}\n$$\n$$\nA_{m, N+1} = 1 \\quad \\text{ (} G_{\\infty} \\text{ 的系数)}\n$$\n对于接下来的 $M$ 行（即行索引 $M+m$），对应于 $G''(\\omega_m)$：\n$$\nA_{M+m,j} = \\frac{\\omega_m \\tau_j}{1 + \\omega_m^2 \\tau_j^2} \\quad \\text{for } j=1, \\dots, N \\quad \\text{ (} g_j \\text{ 的系数)}\n$$\n$$\nA_{M+m, N+1} = 0 \\quad \\text{ (} G_{\\infty} \\text{ 的系数)}\n$$\n模态强度 $g_i$ 和平衡模量 $G_{\\infty}$ 必须为非负的物理要求施加了约束 $\\mathbf{x} \\ge \\mathbf{0}$。因此，问题变成了一个非负最小二乘 (NNLS) 优化问题：\n$$\n\\min_{\\mathbf{x} \\ge \\mathbf{0}}\\ \\lVert \\mathbf{A}\\mathbf{x} - \\mathbf{b} \\rVert_{2}^{2}\n$$\n这是一个凸优化问题，存在鲁棒且高效的算法，例如 `scipy.optimize.nnls` 中实现的活动集方法。\n\n对于每个测试用例，实现将按以下步骤进行：\n1. 使用真实参数 $\\mathbf{g}^{\\mathrm{true}}$ 和 $G_{\\infty}^{\\mathrm{true}}$ 生成合成的无噪声数据向量 $\\widehat{G}'(\\boldsymbol{\\omega})$ 和 $\\widehat{G}''(\\boldsymbol{\\omega})$，然后将它们堆叠到观测向量 $\\mathbf{b}$ 中。\n2. 基于用于拟合的弛豫时间 $\\boldsymbol{\\tau}$ 和测量频率 $\\boldsymbol{\\omega}$ 构造设计矩阵 $\\mathbf{A}$。\n3. 解决 NNLS 问题以找到估计的参数向量 $\\widehat{\\mathbf{x}}$。\n4. 计算相对误差 $\\varepsilon_{\\mathrm{rel}} = \\lVert \\widehat{\\mathbf{x}} - \\mathbf{x}^{\\mathrm{true}} \\rVert_{2} / \\lVert \\mathbf{x}^{\\mathrm{true}} \\rVert_{2}$。\n5. 如果 $\\varepsilon_{\\mathrm{rel}} \\le 10^{-8}$，则声明成功。\n\n此过程直接测试了 NNLS 公式在没有噪声的情况下正确反演线性模型的能力，包括参数值为零和过参数化的情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Constructs and solves the joint non-negative least-squares problem for\n    fitting a generalized Maxwell model to synthetic viscoelastic data.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"tau_fit\": np.array([0.01, 0.2, 5.0]),\n            \"g_true\": np.array([2.5e6, 1.0e6, 0.5e6]),\n            \"G_inf_true\": 0.8e6,\n            \"omega\": np.logspace(-1, 3, 25),\n        },\n        {\n            \"tau_fit\": np.array([0.05, 5.0]),\n            \"g_true\": np.array([3.0e5, 7.0e5]),\n            \"G_inf_true\": 0.0,\n            \"omega\": np.array([0., 0.01, 0.1, 1., 10., 100.]),\n        },\n        {\n            \"tau_fit\": np.array([0.01, 0.1, 1.0, 10.0, 100.0]),\n            \"g_true\": np.array([0.0, 1.2e5, 0.0, 2.8e5, 0.0]),\n            \"G_inf_true\": 0.0,\n            \"omega\": np.logspace(-2, 3, 30),\n        }\n    ]\n\n    results = []\n    tolerance = 1e-8\n\n    for case in test_cases:\n        tau_fit = case[\"tau_fit\"]\n        g_true = case[\"g_true\"]\n        G_inf_true = case[\"G_inf_true\"]\n        omega = case[\"omega\"]\n\n        N_fit = len(tau_fit)\n        N_true = len(g_true)\n        M = len(omega)\n\n        # 1. Construct the true parameter vector x_true\n        if N_fit == N_true:\n            x_true = np.concatenate([g_true, [G_inf_true]])\n        else: # Over-parameterized case\n            x_true = np.zeros(N_fit + 1)\n            # Find indices of true tau in fit tau\n            tau_true_on_fit_grid = np.array([0.1, 10.0])\n            g_true_values = np.array([1.2e5, 2.8e5])\n            for i, tau_val in enumerate(tau_fit):\n                if tau_val in tau_true_on_fit_grid:\n                    idx = np.where(tau_true_on_fit_grid == tau_val)[0][0]\n                    x_true[i] = g_true_values[idx]\n            x_true[-1] = G_inf_true\n\n\n        # 2. Generate synthetic data (vector b)\n        # Reshape arrays for broadcasting\n        omega_col = omega[:, np.newaxis]\n        \n        # Data generation uses the true tau/g values which may differ from fit grid\n        if N_fit == N_true:\n             tau_row_true = tau_fit[np.newaxis, :]\n             g_row_true = g_true[np.newaxis, :]\n        else:\n             tau_row_true = tau_fit[np.newaxis, :]\n             g_row_true = x_true[:-1][np.newaxis, :]\n\n\n        w_tau = omega_col * tau_row_true\n        w2_tau2 = w_tau**2\n        denom = 1.0 + w2_tau2\n        \n        # Calculate storage and loss moduli from true parameters\n        G_prime_data = G_inf_true + np.sum(g_row_true * w2_tau2 / denom, axis=1)\n        G_double_prime_data = np.sum(g_row_true * w_tau / denom, axis=1)\n        \n        b = np.concatenate([G_prime_data, G_double_prime_data])\n\n        # 3. Construct the design matrix A based on tau_fit\n        tau_row_fit = tau_fit[np.newaxis, :]\n        A = np.zeros((2 * M, N_fit + 1))\n        \n        w_tau_fit = omega_col * tau_row_fit\n        w2_tau2_fit = w_tau_fit**2\n        denom_fit = 1.0 + w2_tau2_fit\n\n        # Coefficients for g_i from G_prime\n        A_prime_coeffs = w2_tau2_fit / denom_fit\n        A[:M, :N_fit] = A_prime_coeffs\n        \n        # Coefficients for g_i from G_double_prime\n        A_double_prime_coeffs = w_tau_fit / denom_fit\n        A[M:, :N_fit] = A_double_prime_coeffs\n        \n        # Column for G_inf\n        A[:M, N_fit] = 1.0\n        # A[M:, N_fit] is already 0.0\n\n        # 4. Solve the Non-Negative Least Squares problem\n        x_hat, _ = nnls(A, b)\n\n        # 5. Assess success based on relative error\n        norm_x_true = np.linalg.norm(x_true)\n        if norm_x_true == 0:\n            rel_error = np.linalg.norm(x_hat)\n        else:\n            rel_error = np.linalg.norm(x_hat - x_true) / norm_x_true\n        \n        success = rel_error = tolerance\n        results.append(success)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2913322"}]}