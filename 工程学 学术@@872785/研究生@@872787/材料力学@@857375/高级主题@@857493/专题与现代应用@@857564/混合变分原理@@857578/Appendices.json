{"hands_on_practices": [{"introduction": "掌握混合变分原理的第一步是理解它如何将固体力学的基本方程统一在一个框架内。本练习将以一个简单的一维杆为模型，应用Hu-Washizu原理，从一个单一的泛函出发，推导出平衡方程、本构关系和运动学关系。这个过程清晰地展示了变分方法的威力和统一性，并证明了它不仅仅是一种数学上的技巧，更是整个方法的理论基石[@problem_id:2903841]。", "problem": "考虑一根长度为 $L>0$、横截面积恒为 $A>0$、杨氏模量为 $E>0$ 的线性弹性棱柱形一维（$1$D）杆。该杆沿 $x$ 轴放置，占据区间 $x \\in [0,L]$，并承受单位长度上均匀分布的轴向体力 $q \\in \\mathbb{R}$（沿 $+x$ 方向为正）。杆的轴向位移被指定为 $u(0)=0$ 和 $u(L)=U$，其中 $U \\in \\mathbb{R}$ 为给定值。假设为小应变和线性弹性。使用胡-鹫津混合变分原理，其中独立的标量场为：轴向位移 $u(x)$、轴向应变 $\\varepsilon(x)$ 和轴力 $n(x)$。\n\n任务：\n1) 从弹性应变能密度和外力功的定义以及虚功原理出发，为该一维杆问题显式地写出胡-鹫津泛函 $\\Pi_{HW}(u,\\varepsilon,n)$，使用标量场 $u(x)$、$\\varepsilon(x)$ 和 $n(x)$。\n2) 推导关于各独立场的驻值条件，并求解满足 $u(x)$ 本质边界条件的驻值场 $(u,\\varepsilon,n)$。\n3) 简要说明所得到的控制方程与原始（仅位移）变分原理及 Hellinger–Reissner 混合变分原理产生的结果相一致。\n4) 从驻值解中，提取 $x=L$ 处的反力，定义为 $R_L := n(L)$。以 $E$、$A$、$L$、$U$ 和 $q$ 的单个闭式符号表达式形式给出最终答案。将最终答案表示为符号表达式；其物理单位为牛顿（N）。不要进行任何数值计算或四舍五入。", "solution": "该问题 ROLEName 已经过有效性审查，被认定为科学上合理、提法明确、客观且自洽。其中不存在矛盾、歧义或违反物理原理之处。该问题是混合变分原理在一维线性弹性中的一个标准应用。我们开始进行解答。\n\n分析过程按照问题陈述中指定的四个任务进行组织。\n\n1) 胡-鹫津泛函 $\\Pi_{HW}(u,\\varepsilon,n)$ 的推导\n\n胡-鹫津原理将位移 $u(x)$、应变 $\\varepsilon(x)$ 和应力（在此由轴力 $n(x)$ 表示）视为独立的场。泛函 $\\Pi_{HW}$ 的构造方式使其驻值条件能够产生一整套控制方程：平衡方程、运动学协调方程和本构律。\n\n胡-鹫津泛函的一般形式为：\n$$ \\Pi_{HW}(u, \\varepsilon, \\sigma) = \\int_{V} W(\\varepsilon) dV - \\int_{V} \\sigma : (\\varepsilon - \\nabla_s u) dV - W_{ext} $$\n其中 $W(\\varepsilon)$ 是应变能密度，$\\sigma$ 和 $\\varepsilon$ 分别是应力张量和应变张量，$u$ 是位移矢量，$\\nabla_s u$ 是位移梯度的对称部分，$W_{ext}$ 是外力势。\n\n对于给定的一维（$1$D）杆问题：\n- 线性弹性的应变能密度为 $W(\\varepsilon) = \\frac{1}{2}E\\varepsilon^2$。其在体积 $V$（横截面积为 $A$，长度为 $L$）上的积分为 $\\int_0^L \\frac{1}{2} A E \\varepsilon(x)^2 dx$。\n- 应力张量由单个分量 $\\sigma_{xx}$ 表示，它与轴力 $n(x)$ 的关系为 $n(x) = A \\sigma_{xx}(x)$。应变张量有一个分量 $\\varepsilon_{xx} = \\varepsilon(x)$。应变-位移关系为 $\\varepsilon(x) = \\frac{du}{dx}$。约束项 $\\int_V \\sigma : (\\varepsilon - \\nabla_s u) dV$ 变为 $\\int_0^L A \\sigma_{xx} (\\varepsilon - \\frac{du}{dx}) dx = \\int_0^L n (\\varepsilon - \\frac{du}{dx}) dx$。\n- 外力势包括体力 $q$ 和任何指定的边界牵引力。体力的势为 $\\int_V b \\cdot u dV = \\int_0^L q u(x) dx$。由于位移 $u(0)$ 和 $u(L)$ 是指定的（本质边界条件），因此没有指定的牵引力，牵引力边界项为零。\n\n结合这些分量，我们构造泛函 $\\Pi_{HW}(u, \\varepsilon, n)$。注意，从应变能项中减去约束项和外力功项以构成总势能。\n$$ \\Pi_{HW}(u, \\varepsilon, n) = \\int_{0}^{L} \\left[ \\frac{1}{2} A E \\varepsilon(x)^2 - n(x) \\left( \\varepsilon(x) - \\frac{du}{dx} \\right) - q u(x) \\right] dx $$\n这就是针对该特定一维杆问题的胡-鹫津泛函的显式形式。\n\n2) 驻值条件与场的求解\n\n泛函的驻值点通过要求其一阶变分 $\\delta \\Pi_{HW}$ 对所有容许的变分 $\\delta u$、$\\delta \\varepsilon$ 和 $\\delta n$ 都为零来找到。主场 $\\delta u$ 的变分在位移指定的边界上必须为零，即 $\\delta u(0) = 0$ 和 $\\delta u(L) = 0$。\n\n一阶变分为：\n$$ \\delta \\Pi_{HW} = \\int_{0}^{L} \\left[ A E \\varepsilon \\delta\\varepsilon - \\delta n \\left( \\varepsilon - \\frac{du}{dx} \\right) - n \\left( \\delta\\varepsilon - \\frac{d(\\delta u)}{dx} \\right) - q \\delta u \\right] dx $$\n对项 $n \\frac{d(\\delta u)}{dx}$ 进行分部积分：$\\int_{0}^{L} n \\frac{d(\\delta u)}{dx} dx = [n \\delta u]_0^L - \\int_0^L \\frac{dn}{dx} \\delta u dx$。\n由于 $\\delta u(0)=\\delta u(L)=0$，边界项 $[n \\delta u]_0^L$ 为零。\n按变分项归集：\n$$ \\delta \\Pi_{HW} = \\int_{0}^{L} \\left( -\\frac{dn}{dx} - q \\right) \\delta u dx + \\int_{0}^{L} (A E \\varepsilon - n) \\delta\\varepsilon dx + \\int_{0}^{L} \\left( -\\varepsilon + \\frac{du}{dx} \\right) \\delta n dx = 0 $$\n为使此式对任意变分都成立，每个被积函数必须为零，从而得到欧拉-拉格朗日方程：\ni. 关于 $u(x)$ 的驻值条件（$\\delta u$）：$\\frac{dn}{dx} + q = 0$ (平衡方程)\nii. 关于 $\\varepsilon(x)$ 的驻值条件（$\\delta \\varepsilon$）：$n(x) = A E \\varepsilon(x)$ (本构律)\niii. 关于 $n(x)$ 的驻值条件（$\\delta n$）：$\\varepsilon(x) = \\frac{du}{dx}$ (几何关系)\n\n我们现在求解这个方程组。\n由 (i)，对 $x$ 积分得到轴力：\n$n(x) = -qx + C_1$，其中 $C_1$ 是一个积分常数。\n\n由 (ii)，应变为：\n$\\varepsilon(x) = \\frac{n(x)}{AE} = \\frac{-qx + C_1}{AE}$。\n\n由 (iii)，我们对应变积分以求得位移：\n$u(x) = \\int \\varepsilon(x) dx = \\int \\frac{-qx + C_1}{AE} dx = \\frac{1}{AE} \\left( -\\frac{qx^2}{2} + C_1 x \\right) + C_2$。\n\n常数 $C_1$ 和 $C_2$ 由本质边界条件 $u(0)=0$ 和 $u(L)=U$ 确定：\n$u(0) = 0 \\implies \\frac{1}{AE}(0) + C_2 = 0 \\implies C_2 = 0$。\n$u(L) = U \\implies \\frac{1}{AE} \\left( -\\frac{qL^2}{2} + C_1 L \\right) = U$。\n求解 $C_1$：\n$C_1 L = A E U + \\frac{qL^2}{2} \\implies C_1 = \\frac{AEU}{L} + \\frac{qL}{2}$。\n\n将 $C_1$ 和 $C_2$ 代回场的表达式中，得到最终解：\n- 轴力：$n(x) = -qx + \\frac{AEU}{L} + \\frac{qL}{2} = \\frac{AEU}{L} + \\frac{q}{2}(L-2x)$\n- 轴向应变：$\\varepsilon(x) = \\frac{n(x)}{AE} = \\frac{U}{L} + \\frac{q}{2AE}(L-2x)$\n- 轴向位移：$u(x) = \\frac{1}{AE} \\left( -\\frac{qx^2}{2} + \\left(\\frac{AEU}{L} + \\frac{qL}{2}\\right)x \\right) = \\frac{U}{L}x + \\frac{q}{2AE}(Lx-x^2)$\n\n3) 与其他变分原理的等价性\n\n我们简要证明这些控制方程与原始变分原理和 Hellinger–Reissner 变分原理得到的结果是一致的。\n\n- **原始（仅位移）原理**：泛函是总势能 $\\Pi_p(u) = \\int_0^L \\left(\\frac{1}{2} AE (\\frac{du}{dx})^2 - qu\\right) dx$。其驻值条件是控制方程的强形式：$\\frac{d}{dx}\\left(AE\\frac{du}{dx}\\right) + q = 0$。从我们的胡-鹫津解中，我们有 $n = AE\\varepsilon$ 和 $\\varepsilon = du/dx$，结合起来得到 $n = AE \\frac{du}{dx}$。将此代入平衡方程 $\\frac{dn}{dx} + q = 0$ 直接得到 $\\frac{d}{dx}\\left(AE\\frac{du}{dx}\\right) + q = 0$。结果完全相同。\n\n- **Hellinger–Reissner 原理**：独立场是位移 $u(x)$ 和力 $n(x)$。泛函是 $\\Pi_{HR}(u,n) = \\int_0^L \\left(n\\frac{du}{dx} - \\frac{n^2}{2AE} - qu\\right)dx$。其驻值条件是：\n  - $\\delta u$：$\\frac{dn}{dx} + q = 0$\n  - $\\delta n$：$\\frac{du}{dx} - \\frac{n}{AE} = 0$\n胡-鹫津原理产生三个方程：(i) $\\frac{dn}{dx} + q = 0$，(ii) $n=AE\\varepsilon$，和 (iii) $\\varepsilon=du/dx$。将 (ii) 代入 (iii) 得到 $\\frac{n}{AE} = \\frac{du}{dx}$。因此，从胡-鹫津原理得到的方程组直接包含了从 Hellinger–Reissner 原理得到的方程组。故这两个原理是一致的。\n\n4) $x=L$ 处的反力\n\n$x=L$ 处的反力，记为 $R_L$，是该点内轴力的值，即 $R_L := n(L)$。使用推导出的 $n(x)$ 表达式：\n$$ n(x) = \\frac{AEU}{L} + \\frac{q}{2}(L-2x) $$\n我们将 $x=L$ 代入此表达式：\n$$ R_L = n(L) = \\frac{AEU}{L} + \\frac{q}{2}(L - 2L) = \\frac{AEU}{L} + \\frac{q}{2}(-L) $$\n因此，$x=L$ 处的反力是：\n$$ R_L = \\frac{AEU}{L} - \\frac{qL}{2} $$\n该表达式在物理上是自洽的。它是由于指定位移 $U$ 引起的力和由于体力载荷 $q$ 引起的力的叠加。对于在均布载荷 $q$ 作用下的两端固定杆（$U=0$），反力为 $-qL/2$，这与对称性的预期相符。对于仅受端部位移作用的杆（$q=0$），力为 $AEU/L$，这与适用于整个杆的胡克定律一致。", "answer": "$$\n\\boxed{\\frac{AEU}{L} - \\frac{qL}{2}}\n$$", "id": "2903841"}, {"introduction": "在理解了混合变分原理的基本推导后，下一步是探索其应用的灵活性。本练习将展示如何利用混合原理构建不同视角下的求解方法，特别是基于应力的补充能量法。通过分析一个由两种不同材料组成的杆，你将学习如何预先施加平衡条件，从而导出一个仅包含应力场的泛函，并用它来解决问题。这揭示了处理特定类型问题（如材料非均质性）的一种有效策略[@problem_id:2903862]。", "problem": "一根横截面积均匀的直棱柱杆沿坐标轴 $x \\in [0,L]$ 放置，它由两段完美粘合的线性弹性材料组成，其杨氏模量 $E(x)$ 为分段常数，由下式给出\n$$\nE(x) \\;=\\; \\begin{cases}\nE_1, & 0 \\le x \\le L_1,\\\\\nE_2, & L_1 < x \\le L,\n\\end{cases}\n$$\n其中 $L = L_1 + L_2$。在准静态条件下，施加一个总的端到端伸长量 $u(L) - u(0) = \\Delta$，且无体力或给定面力。应力场用 $\\sigma(x)$ 表示，轴向应变用 $\\varepsilon(x)$ 表示，位移用 $u(x)$ 表示。假设小应变、线性弹性，并且在界面 $x=L_1$ 处为完美粘合。从混合变分框架出发，使用 Hellinger–Reissner (H–R) 原理或 Hu–Washizu (H–W) 原理，推导出一个仅用应力场表示的、适用于这些位移边界条件的余能泛函。你的推导必须从一维线性弹性的基本本构关系、运动协调性的定义以及无体力下的平衡方程出发，并且不得预先假设任何应力拟设。清楚地展示施加的伸长约束如何进入泛函（例如，通过拉格朗日乘子或通过消除位移场），并说明容许应力场类。然后，确定使余能泛函取驻值的应力场，并验证界面平衡得到满足。\n\n对于具体计算，设 $L_1 = 0.30\\,\\mathrm{m}$，$L_2 = 0.70\\,\\mathrm{m}$，$E_1 = 70\\,\\mathrm{GPa}$，$E_2 = 210\\,\\mathrm{GPa}$，以及 $\\Delta = 1.00\\times 10^{-3}\\,\\mathrm{m}$。计算在给定伸长条件下，使所推导的余能泛函取极值的常数应力值。将最终应力值以兆帕 (MPa) 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 杆件为棱柱形，沿 $x$ 轴从 $x=0$ 到 $x=L$。\n- 横截面积 $A$ 是均匀的。\n- 杨氏模量 $E(x)$ 是分段常数：当 $x \\in [0, L_1]$ 时，$E(x) = E_1$；当 $x \\in (L_1, L]$ 时，$E(x) = E_2$，其中 $L=L_1+L_2$。\n- 边界条件为给定的总伸长量：$u(L) - u(0) = \\Delta$。\n- 无体力或给定面力。\n- 场变量为应力 $\\sigma(x)$、应变 $\\varepsilon(x)$ 和位移 $u(x)$。\n- 假设：小应变、线性弹性、完美粘合。\n- 任务是从混合变分原理（Hellinger–Reissner 或 Hu–Washizu）出发，推导一个纯粹用应力场表示的余能泛函，然后用它来求解应力场。\n- 用于计算的数值：$L_1 = 0.30\\,\\mathrm{m}$，$L_2 = 0.70\\,\\mathrm{m}$，$E_1 = 70\\,\\mathrm{GPa}$，$E_2 = 210\\,\\mathrm{GPa}$，$\\Delta = 1.00 \\times 10^{-3}\\,\\mathrm{m}$。\n\n步骤2：使用提取的已知条件进行验证。\n- 问题在科学上基于线性弹性理论和力学中的变分原理。\n- 问题是适定的。所提供的边界条件和材料属性足以确定唯一的应力状态。\n- 问题是客观的，并使用了精确的术语。\n所有验证标准均已满足。该问题被视为有效。\n\n步骤3：结论与行动。\n问题有效。将提供解答。\n\n在给定假设下，此一维问题的基本场方程为：\n1.  平衡方程（无体力）：$\\frac{d\\sigma}{dx} = 0$。\n2.  运动协调方程（小应变）：$\\varepsilon = \\frac{du}{dx}$。\n3.  本构关系（线性弹性）：$\\sigma = E(x)\\varepsilon$。\n\n问题要求从一个混合变分原理出发进行推导。我们从 Hellinger–Reissner 原理开始，该原理将应力 $\\sigma$ 和位移 $u$ 视为独立的场。对于这个一维系统，相应的泛函 $\\Pi_{HR}[\\sigma, u]$ 由下式给出：\n$$ \\Pi_{HR}[\\sigma, u] = \\int_0^L A \\left( \\sigma \\frac{du}{dx} - W_c(\\sigma) \\right) dx $$\n其中 $A$ 是横截面积，$W_c(\\sigma) = \\frac{\\sigma^2}{2E(x)}$ 是余应变能密度。泛函为：\n$$ \\Pi_{HR}[\\sigma, u] = \\int_0^L A \\left( \\sigma \\frac{du}{dx} - \\frac{\\sigma^2}{2E(x)} \\right) dx $$\n$\\Pi_{HR}$ 的驻值原理导出了控制方程。对位移场 $u$ 的变分给出：\n$$ \\delta_u \\Pi_{HR} = \\int_0^L A \\sigma \\frac{d(\\delta u)}{dx} dx = A \\left[ \\sigma \\delta u \\right]_0^L - \\int_0^L A \\frac{d\\sigma}{dx} \\delta u dx = 0 $$\n对于域 $(0,L)$ 内的任意变分 $\\delta u$，积分项要求 $\\frac{d\\sigma}{dx} = 0$。这就是平衡方程。这个条件意味着静态容许的应力场在材料属性恒定的分段上必须是常数。此外，界面 $x=L_1$ 处的力平衡要求应力连续，即 $\\sigma(L_1^-) = \\sigma(L_1^+)$。因此，容许应力场 $\\sigma(x)$ 在整个域 $[0, L]$ 上必须是一个单一的常数值 $\\sigma_0$。\n因此，容许应力场类是所有常数函数 $\\sigma(x) = \\sigma_0$ 的集合。\n\n为推导余能泛函，我们将此容许应力场形式代入 Hellinger–Reissner 泛函中：\n$$ \\Pi(\\sigma_0, u) = \\int_0^L A \\left( \\sigma_0 \\frac{du}{dx} - \\frac{\\sigma_0^2}{2E(x)} \\right) dx $$\n现在可以进行积分：\n$$ \\Pi(\\sigma_0, u) = A \\sigma_0 \\int_0^L \\frac{du}{dx} dx - \\frac{A \\sigma_0^2}{2} \\int_0^L \\frac{1}{E(x)} dx $$\n$$ \\Pi(\\sigma_0, u) = A \\sigma_0 [u(L) - u(0)] - \\frac{A \\sigma_0^2}{2} \\left( \\int_0^{L_1} \\frac{dx}{E_1} + \\int_{L_1}^{L} \\frac{dx}{E_2} \\right) $$\n$$ \\Pi(\\sigma_0, u) = A \\sigma_0 [u(L) - u(0)] - \\frac{A \\sigma_0^2}{2} \\left( \\frac{L_1}{E_1} + \\frac{L_2}{E_2} \\right) $$\n问题指定了运动学条件 $u(L) - u(0) = \\Delta$。我们通过将 $\\Delta$ 代入泛函来施加此约束。这产生了一个仅用应力场参数 $\\sigma_0$ 和给定问题数据表示的泛函，我们将其记为 $\\Pi_c^*$：\n$$ \\Pi_c^*[\\sigma] \\equiv \\Pi(\\sigma_0) = A \\sigma_0 \\Delta - \\frac{A \\sigma_0^2}{2} \\left( \\frac{L_1}{E_1} + \\frac{L_2}{E_2} \\right) $$\n这就是适用于给定边界条件的所求余能泛函。\n\n解决问题的应力场是使该泛函取驻值的那个场。我们通过将 $\\Pi(\\sigma_0)$ 对 $\\sigma_0$ 的导数设为零来求得这个应力值：\n$$ \\frac{d\\Pi}{d\\sigma_0} = A \\Delta - A \\sigma_0 \\left( \\frac{L_1}{E_1} + \\frac{L_2}{E_2} \\right) = 0 $$\n解出 $\\sigma_0$，我们得到：\n$$ \\sigma_0 = \\frac{\\Delta}{\\frac{L_1}{E_1} + \\frac{L_2}{E_2}} $$\n这个结果给出了整个杆内的常数应力。如前所示，常数应力场自动满足界面处的平衡条件 $\\sigma(L_1^-)=\\sigma(L_1^+)$。\n\n对于具体计算，我们代入给定的数值。所有量必须使用一致的国际单位制单位（米，帕斯卡）。\n$L_1 = 0.30\\,\\mathrm{m}$\n$L_2 = 0.70\\,\\mathrm{m}$\n$E_1 = 70\\,\\mathrm{GPa} = 70 \\times 10^9\\,\\mathrm{Pa}$\n$E_2 = 210\\,\\mathrm{GPa} = 210 \\times 10^9\\,\\mathrm{Pa}$\n$\\Delta = 1.00 \\times 10^{-3}\\,\\mathrm{m}$\n\n首先，我们计算分母：\n$$ \\frac{L_1}{E_1} + \\frac{L_2}{E_2} = \\frac{0.30}{70 \\times 10^9} + \\frac{0.70}{210 \\times 10^9} = \\frac{1}{10^9} \\left( \\frac{0.30}{70} + \\frac{0.70}{210} \\right) $$\n$$ = \\frac{1}{10^9} \\left( \\frac{3 \\times 0.30 + 0.70}{210} \\right) = \\frac{1}{10^9} \\left( \\frac{0.90 + 0.70}{210} \\right) = \\frac{1.60}{210 \\times 10^9} \\, \\frac{\\mathrm{m}}{\\mathrm{Pa}} $$\n现在，我们计算应力 $\\sigma_0$：\n$$ \\sigma_0 = \\frac{1.00 \\times 10^{-3}}{\\frac{1.60}{210 \\times 10^9}} = \\frac{1.00 \\times 10^{-3} \\times 210 \\times 10^9}{1.60} = \\frac{210 \\times 10^6}{1.60} \\,\\mathrm{Pa} $$\n$$ \\sigma_0 = 131.25 \\times 10^6 \\,\\mathrm{Pa} = 131.25 \\,\\mathrm{MPa} $$\n问题要求答案四舍五入到四位有效数字。数值 $131.25$ 四舍五入为 $131.3$。\n最终应力值为 $131.3\\,\\mathrm{MPa}$。", "answer": "$$\n\\boxed{131.3}\n$$", "id": "2903862"}, {"introduction": "理论的最终价值在于其应用，而混合变分原理在计算力学中通过有限元方法（FEM）大放异彩。然而，将连续的理论离散化时，我们必须验证所创造的单元是否可靠。本练习引入了“面片检验”（Patch Test）这一基本基准，它是检验单元性能的“试金石”[@problem_id:2903888]。你将亲自验证一个基于Hellinger-Reissner原理的混合有限元，是否能精确再现常应变状态，这是保证计算结果收敛的必要条件。", "problem": "考虑一个平面应变下的单位方形域 $\\Omega = [0,1]\\times[0,1]$，由杨氏模量为 $E$、泊松比为 $\\nu$ 的均匀、各向同性、线弹性实体构成。设该材料遵循三维线弹性定律，其拉梅参数 (Lamé parameters) 为 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$，因此，在二维平面应变下，使用 Voigt 序的应力 $\\{\\sigma_{xx},\\sigma_{yy},\\tau_{xy}\\}$ 和应变 $\\{\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}\\}$，其本构矩阵为\n$$\n\\mathbf{C} \\;=\\;\n\\begin{bmatrix}\n\\lambda+2\\mu  \\lambda  0 \\\\\n\\lambda  \\lambda+2\\mu  0 \\\\\n0  0  \\mu\n\\end{bmatrix}.\n$$\n通过从 $(0,0)$ 到 $(1,1)$ 的对角线将 $\\Omega$ 离散为两个线性 ($\\mathcal{P}_1$) 三角形单元，节点坐标为\n$$\n\\mathbf{x}_1=(0,0),\\quad \\mathbf{x}_2=(1,0),\\quad \\mathbf{x}_3=(1,1),\\quad \\mathbf{x}_4=(0,1),\n$$\n单元连接关系为 $e=1:\\{1,2,3\\}$ 和 $e=2:\\{1,3,4\\}$。设位移场为全局线性的，\n$$\n\\mathbf{u}(x,y) \\;=\\; \n\\begin{bmatrix}\nu_x(x,y)\\\\[2pt]\nu_y(x,y)\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\na + b\\,x + c\\,y \\\\[2pt]\nd + e\\,x + f\\,y\n\\end{bmatrix},\n$$\n其中常数 $a,b,c,d,e,f\\in\\mathbb{R}$。因此，精确（工程）应变在 $\\Omega$ 上是常数，等于\n$$\n\\boldsymbol{\\varepsilon}^{\\star} \\;=\\; \n\\begin{bmatrix}\n\\varepsilon_{xx}\\\\[2pt]\n\\varepsilon_{yy}\\\\[2pt]\n\\gamma_{xy}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nb\\\\[2pt]\nf\\\\[2pt]\nc+e\n\\end{bmatrix},\n\\quad\n\\boldsymbol{\\sigma}^{\\star} \\;=\\; \\mathbf{C}\\,\\boldsymbol{\\varepsilon}^{\\star}.\n$$\n\n使用 Hellinger–Reissner 混合变分原理（应力和位移为独立场）以及以下离散近似空间：\n\n- 每个单元上为常数应力（分片 $\\mathcal{P}_0$），采用 Voigt 形式，\n- 连续、分片线性的节点位移（全局 $\\mathcal{P}_1$），\n\n请从第一性原理出发，执行以下步骤：\n\n1) 从 Hellinger–Reissner 泛函出发，推导离散平稳性方程。证明单元矩阵可简化为\n$$\n\\mathbf{H}_e \\;=\\; \\int_{\\Omega_e} \\mathbf{C}^{-1}\\,\\mathrm{d}\\Omega \\;=\\; A_e\\,\\mathbf{C}^{-1},\n\\qquad\n\\mathbf{G}_e \\;=\\; \\int_{\\Omega_e} \\mathbf{B}_e\\,\\mathrm{d}\\Omega \\;=\\; A_e\\,\\mathbf{B}_e,\n$$\n其中 $A_e$ 是单元 $e$ 的面积，$\\mathbf{B}_e$ 是由其形函数梯度构成的线性三角形的常应变-位移矩阵。\n\n2) 对应力参数 $\\mathbf{s}=\\begin{bmatrix}\\mathbf{s}_1\\\\ \\mathbf{s}_2\\end{bmatrix}$（其中 $\\mathbf{s}_e$ 是单元 $e$ 上的常应力向量）和全局节点位移向量 $\\mathbf{d}$，组装成块形式的全局混合系统：\n$$\n\\begin{bmatrix}\n\\mathbf{H}  -\\mathbf{G}\\\\[2pt]\n-\\mathbf{G}^{\\mathsf{T}}  \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{s}\\\\[2pt]\n\\mathbf{d}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\n\\mathbf{0}\\\\[2pt]\n\\mathbf{f}\n\\end{bmatrix}.\n$$\n\n3) 构造“应力方程残差”向量\n$$\n\\mathbf{r}_s(\\mathbf{d},\\mathbf{s}) \\;=\\; \\mathbf{H}\\,\\mathbf{s} \\;-\\; \\mathbf{G}\\,\\mathbf{d},\n$$\n通过为给定的双单元网格显式计算 $\\mathbf{H}$ 和 $\\mathbf{G}$，并将 $\\mathbf{d}$ 取为给定线性场在四个网格节点上的插值，以及对 $e=1,2$ 取 $\\mathbf{s}_e=\\boldsymbol{\\sigma}^{\\star}$。\n\n4) 令 $A_{\\Omega}$ 表示网格的总面积。定义无量纲的标量分片检验指标\n$$\nR \\;=\\; \\dfrac{\\|\\mathbf{r}_s\\|_2}{A_{\\Omega}\\,\\|\\boldsymbol{\\varepsilon}^{\\star}\\|_2}.\n$$\n精确计算 $R$。将最终答案表示为一个纯数（无量纲）。无需四舍五入，也不应报告任何物理单位。", "solution": "对于平面应变下的小应变线弹性问题，以应力场 $\\boldsymbol{\\sigma}$ 和位移场 $\\mathbf{u}$ 为独立场，并为清晰起见省略了体力及面力（它们在应力方程残差中不起作用），其 Hellinger–Reissner 泛函为\n$$\n\\Pi_{\\text{HR}}(\\mathbf{u},\\boldsymbol{\\sigma})\n\\;=\\;\n\\int_{\\Omega} \\left( \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}^{\\mathsf{T}}\\mathbf{C}^{-1}\\boldsymbol{\\sigma} \\;-\\; \\boldsymbol{\\sigma}^{\\mathsf{T}}\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}) \\right)\\,\\mathrm{d}\\Omega.\n$$\n分别对 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{u}$ 取平稳性条件，可得\n$$\n\\delta_{\\boldsymbol{\\sigma}} \\Pi_{\\text{HR}}:\\quad \\int_{\\Omega}\\left(\\mathbf{C}^{-1}\\boldsymbol{\\sigma} - \\boldsymbol{\\varepsilon}(\\mathbf{u})\\right)^{\\mathsf{T}}\\delta\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\; \\mathbf{C}^{-1}\\boldsymbol{\\sigma} - \\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\mathbf{0},\n$$\n$$\n\\delta_{\\mathbf{u}} \\Pi_{\\text{HR}}:\\quad -\\int_{\\Omega}\\boldsymbol{\\sigma}^{\\mathsf{T}}\\delta\\boldsymbol{\\varepsilon}(\\mathbf{u})\\,\\mathrm{d}\\Omega \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\; \\nabla\\cdot\\boldsymbol{\\sigma} = \\mathbf{0}\n$$\n在适当的本质边界条件下，经过分部积分得到弱形式。这些分别是本构方程和平衡方程。\n\n对于离散近似，我们为每个单元选择一个常应力向量 $\\boldsymbol{\\sigma}|_{\\Omega_e} \\approx \\mathbf{s}_e\\in\\mathbb{R}^{3}$（采用 Voigt 序 $\\{\\sigma_{xx},\\sigma_{yy},\\tau_{xy}\\}$），以及连续的分片线性位移 $\\mathbf{u}(\\mathbf{x}) \\approx \\mathbf{N}(\\mathbf{x})\\,\\mathbf{d}$，其中 $\\mathbf{N}$ 汇集了节点形函数，$\\mathbf{d}$ 是全局节点位移向量。单元应变-位移矩阵 $\\mathbf{B}_e$ 汇集了单元 $e$ 上线性形函数的常梯度，将单元的节点自由度映射到工程应变向量。对于具有节点 $i=1,2,3$ 和形函数 $N_i$ 的线性三角形，该矩阵为\n$$\n\\mathbf{B}_e \\;=\\;\n\\begin{bmatrix}\n\\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_2}{\\partial x}  0  \\frac{\\partial N_3}{\\partial x}  0\\\\[4pt]\n0  \\frac{\\partial N_1}{\\partial y}  0  \\frac{\\partial N_2}{\\partial y}  0  \\frac{\\partial N_3}{\\partial y}\\\\[4pt]\n\\frac{\\partial N_1}{\\partial y}  \\frac{\\partial N_1}{\\partial x}  \\frac{\\partial N_2}{\\partial y}  \\frac{\\partial N_2}{\\partial x}  \\frac{\\partial N_3}{\\partial y}  \\frac{\\partial N_3}{\\partial x}\n\\end{bmatrix}.\n$$\n根据这些选择，离散的 Hellinger–Reissner 泛函变为\n$$\n\\Pi_{\\text{HR}}^h(\\mathbf{d},\\mathbf{s}) \\;=\\; \\sum_{e=1}^{n_{\\text{el}}} \\int_{\\Omega_e} \\left( \\tfrac{1}{2}\\,\\mathbf{s}_e^{\\mathsf{T}}\\mathbf{C}^{-1}\\mathbf{s}_e \\;-\\; \\mathbf{s}_e^{\\mathsf{T}}\\,\\mathbf{B}_e\\,\\mathbf{d}_e \\right)\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{d}_e$ 是与单元 $e$ 的节点相关联的 $\\mathbf{d}$ 的子向量。分别对 $\\mathbf{s}_e$ 和 $\\mathbf{d}$ 取平稳性条件，可得单元级方程\n$$\n\\underbrace{\\left(\\int_{\\Omega_e}\\mathbf{C}^{-1}\\,\\mathrm{d}\\Omega\\right)}_{\\mathbf{H}_e}\\,\\mathbf{s}_e \\;-\\; \\underbrace{\\left(\\int_{\\Omega_e}\\mathbf{B}_e\\,\\mathrm{d}\\Omega\\right)}_{\\mathbf{G}_e}\\,\\mathbf{d}_e \\;=\\; \\mathbf{0},\n\\qquad\n-\\mathbf{G}_e^{\\mathsf{T}}\\mathbf{s}_e \\;=\\; \\mathbf{0} \\;\\; \\text{（在 } \\Omega_e \\text{ 上无外力的情况下）}.\n$$\n因为 $\\mathbf{C}^{-1}$ 和 $\\mathbf{B}_e$ 在线性三角形上是常数，所以积分简化为面积缩放：\n$$\n\\mathbf{H}_e \\;=\\; A_e\\,\\mathbf{C}^{-1}, \\qquad \\mathbf{G}_e \\;=\\; A_e\\,\\mathbf{B}_e,\n$$\n正如所要求的那样。对所有单元进行组装，得到全局系统\n$$\n\\begin{bmatrix}\n\\mathbf{H}  -\\mathbf{G}\\\\[2pt]\n-\\mathbf{G}^{\\mathsf{T}}  \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{s}\\\\[2pt]\n\\mathbf{d}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\n\\mathbf{0}\\\\[2pt]\n\\mathbf{f}\n\\end{bmatrix},\n$$\n其中 $\\mathbf{H}=\\mathrm{diag}(\\mathbf{H}_1,\\mathbf{H}_2)$，$\\mathbf{G}$ 由 $\\{\\mathbf{G}_e\\}$ 组装而成。\n\n我们现在为给定的两个单元显式计算矩阵。每个单元都是面积为 $A_e=\\tfrac{1}{2}$ 的直角三角形，因为单位正方形被分成了两个全等的三角形。使用节点坐标：\n\n- 对于节点为 $\\{1,2,3\\}$ 的单元 $e=1$，其常形函数梯度（由标准面积坐标公式获得）为\n$$\n\\frac{\\partial N_1}{\\partial x}=-1,\\;\\; \\frac{\\partial N_1}{\\partial y}=0,\\qquad\n\\frac{\\partial N_2}{\\partial x}=1,\\;\\; \\frac{\\partial N_2}{\\partial y}=-1,\\qquad\n\\frac{\\partial N_3}{\\partial x}=0,\\;\\; \\frac{\\partial N_3}{\\partial y}=1,\n$$\n因此\n$$\n\\mathbf{B}_1 \\;=\\;\n\\begin{bmatrix}\n-1  0  1  0  0  0\\\\[2pt]\n0  0  0  -1  0  1\\\\[2pt]\n0  -1  -1  1  1  0\n\\end{bmatrix}.\n$$\n\n- 对于节点为 $\\{1,3,4\\}$ 的单元 $e=2$，其梯度为\n$$\n\\frac{\\partial N_1}{\\partial x}=0,\\;\\; \\frac{\\partial N_1}{\\partial y}=-1,\\qquad\n\\frac{\\partial N_3}{\\partial x}=1,\\;\\; \\frac{\\partial N_3}{\\partial y}=0,\\qquad\n\\frac{\\partial N_4}{\\partial x}=-1,\\;\\; \\frac{\\partial N_4}{\\partial y}=1,\n$$\n因此\n$$\n\\mathbf{B}_2 \\;=\\;\n\\begin{bmatrix}\n0  0  1  0  -1  0\\\\[2pt]\n0  -1  0  0  0  1\\\\[2pt]\n-1  0  0  1  1  -1\n\\end{bmatrix}.\n$$\n\n因此，\n$$\n\\mathbf{H}_1=\\mathbf{H}_2=\\tfrac{1}{2}\\,\\mathbf{C}^{-1}, \\qquad \\mathbf{G}_1 = \\tfrac{1}{2}\\,\\mathbf{B}_1,\\qquad \\mathbf{G}_2 = \\tfrac{1}{2}\\,\\mathbf{B}_2.\n$$\n\n接下来，我们通过在四个节点上对给定的线性场进行采样来构造节点位移向量 $\\mathbf{d}$：\n$$\n\\mathbf{u}(\\mathbf{x}_1) = \\begin{bmatrix} a\\\\ d \\end{bmatrix},\\quad\n\\mathbf{u}(\\mathbf{x}_2) = \\begin{bmatrix} a+b\\\\ d+e \\end{bmatrix},\\quad\n\\mathbf{u}(\\mathbf{x}_3) = \\begin{bmatrix} a+b+c\\\\ d+e+f \\end{bmatrix},\\quad\n\\mathbf{u}(\\mathbf{x}_4) = \\begin{bmatrix} a+c\\\\ d+f \\end{bmatrix}.\n$$\n采用标准的全局排序 $\\mathbf{d}=\\begin{bmatrix}u_{1x}&u_{1y}&u_{2x}&u_{2y}&u_{3x}&u_{3y}&u_{4x}&u_{4y}\\end{bmatrix}^{\\mathsf{T}}$，单元位移子向量为\n$$\n\\mathbf{d}_1 = \\begin{bmatrix}a\\\\ d\\\\ a+b\\\\ d+e\\\\ a+b+c\\\\ d+e+f\\end{bmatrix},\\qquad\n\\mathbf{d}_2 = \\begin{bmatrix}a\\\\ d\\\\ a+b+c\\\\ d+e+f\\\\ a+c\\\\ d+f\\end{bmatrix}.\n$$\n\n我们现在评估由有限元运动学计算出的单元应变：\n$$\n\\boldsymbol{\\varepsilon}_1^h \\;=\\; \\mathbf{B}_1\\,\\mathbf{d}_1\n\\;=\\;\n\\begin{bmatrix}\n-1  0  1  0  0  0\\\\\n0  0  0  -1  0  1\\\\\n0  -1  -1  1  1  0\n\\end{bmatrix}\n\\begin{bmatrix}\na\\\\ d\\\\ a+b\\\\ d+e\\\\ a+b+c\\\\ d+e+f\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nb\\\\ f\\\\ c+e\n\\end{bmatrix}\n\\;=\\; \\boldsymbol{\\varepsilon}^{\\star},\n$$\n类似地，\n$$\n\\boldsymbol{\\varepsilon}_2^h \\;=\\; \\mathbf{B}_2\\,\\mathbf{d}_2\n\\;=\\;\n\\begin{bmatrix}\n0  0  1  0  -1  0\\\\\n0  -1  0  0  0  1\\\\\n-1  0  0  1  1  -1\n\\end{bmatrix}\n\\begin{bmatrix}\na\\\\ d\\\\ a+b+c\\\\ d+e+f\\\\ a+c\\\\ d+f\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nb\\\\ f\\\\ c+e\n\\end{bmatrix}\n\\;=\\; \\boldsymbol{\\varepsilon}^{\\star}.\n$$\n因此，对于一个全局线性的位移场，每个单元都能精确地再现常应变 $\\boldsymbol{\\varepsilon}^{\\star}$，这是分片检验的一个关键要求。\n\n我们选择与本构定律一致的单元应力参数，\n$$\n\\mathbf{s}_1 \\;=\\; \\mathbf{s}_2 \\;=\\; \\boldsymbol{\\sigma}^{\\star} \\;=\\; \\mathbf{C}\\,\\boldsymbol{\\varepsilon}^{\\star}.\n$$\n我们现在可以评估应力方程的残差，\n$$\n\\mathbf{r}_s(\\mathbf{d},\\mathbf{s}) \\;=\\; \n\\begin{bmatrix}\n\\mathbf{H}_1  \\mathbf{0}\\\\\n\\mathbf{0}  \\mathbf{H}_2\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{s}_1\\\\ \\mathbf{s}_2\n\\end{bmatrix}\n\\;-\\;\n\\begin{bmatrix}\n\\mathbf{G}_1\\\\ \\mathbf{G}_2\n\\end{bmatrix}\\mathbf{d}\n\\;=\\;\n\\begin{bmatrix}\n\\mathbf{H}_1\\,\\mathbf{s}_1 - \\mathbf{G}_1\\,\\mathbf{d}_1\\\\[2pt]\n\\mathbf{H}_2\\,\\mathbf{s}_2 - \\mathbf{G}_2\\,\\mathbf{d}_2\n\\end{bmatrix}.\n$$\n使用 $\\mathbf{H}_e = A_e\\mathbf{C}^{-1}$、$\\mathbf{G}_e=A_e\\mathbf{B}_e$、$\\mathbf{s}_e=\\mathbf{C}\\boldsymbol{\\varepsilon}^{\\star}$ 和 $\\mathbf{B}_e\\mathbf{d}_e=\\boldsymbol{\\varepsilon}^{\\star}$，我们对每个单元 $e$ 得到，\n$$\n\\mathbf{H}_e\\,\\mathbf{s}_e - \\mathbf{G}_e\\,\\mathbf{d}_e\n\\;=\\; A_e\\,\\mathbf{C}^{-1}\\,(\\mathbf{C}\\boldsymbol{\\varepsilon}^{\\star}) - A_e\\,\\mathbf{B}_e\\,\\mathbf{d}_e\n\\;=\\; A_e\\,\\boldsymbol{\\varepsilon}^{\\star} - A_e\\,\\boldsymbol{\\varepsilon}^{\\star}\n\\;=\\; \\mathbf{0}.\n$$\n因此，\n$$\n\\mathbf{r}_s(\\mathbf{d},\\mathbf{s}) \\;=\\; \\mathbf{0}.\n$$\n令 $A_{\\Omega}$ 表示网格的总面积，此处 $A_{\\Omega} = 1$。所要求的无量纲标量指标为\n$$\nR \\;=\\; \\dfrac{\\|\\mathbf{r}_s\\|_2}{A_{\\Omega}\\,\\|\\boldsymbol{\\varepsilon}^{\\star}\\|_2}\n\\;=\\; \\dfrac{\\|\\,\\mathbf{0}\\,\\|_2}{A_{\\Omega}\\,\\|\\boldsymbol{\\varepsilon}^{\\star}\\|_2}\n\\;=\\; 0.\n$$\n这验证了在全局线性位移场下，所选的具有常应力和线性位移的 Hellinger–Reissner 混合有限元在双三角形网格上通过了分片检验：应力方程残差精确为零，无量纲指标等于零。", "answer": "$$\\boxed{0}$$", "id": "2903888"}]}