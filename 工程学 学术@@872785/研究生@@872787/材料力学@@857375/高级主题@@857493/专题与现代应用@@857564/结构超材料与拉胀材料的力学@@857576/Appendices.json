{"hands_on_practices": [{"introduction": "本练习为分析结构化材料的力学行为奠定了基础。通过从第一性原理出发推导梁单元的刚度矩阵，并将其组装成一个完整的单胞模型，你将深入理解材料的宏观属性（如剪切模量$G_{\\text{eff}}$）是如何直接源于其微观结构几何形状和力学行为的。这项实践对于在多孔固体力学领域建立坚实的理论基础至关重要([@problem_id:2901571])。", "problem": "一个二维方形晶格单胞是一个由四根相同的细长梁组成的刚性连接框架，形成一个边长为 $L$ 的正方形。每根梁的杨氏模量为 $E$，横截面积为 $A$，绕平面外轴线的截面二次矩为 $I$；所有梁均为细长梁，因此适用 Euler–Bernoulli 梁理论。梁位于 $x$–$y$ 平面内，角落处的节点保证了平面位移和平面内转动的连续性。假设平截面在变形后仍保持为平面，且剪切变形可以忽略不计。每个节点的自由度 (DOF) 包括平面内轴向位移 $u$、平面内横向位移 $v$ 以及绕平面外轴线的平面内转动 $\\theta$（逆时针为正，以弧度为单位）。\n\n任务 1. 从 Euler–Bernoulli 运动学和虚功原理出发，在单元局部坐标系中推导两节点平面 Euler–Bernoulli 梁单元的刚度矩阵。节点自由度 (DOF) 的顺序为 $\\left(u_{1}, v_{1}, \\theta_{1}, u_{2}, v_{2}, \\theta_{2}\\right)$，其中下标 $1$ 和 $2$ 表示单元的两端，局部坐标 $x$ 沿梁的轴线方向。您的推导必须从应变能泛函和合适的插值（轴向位移采用线性插值，横向位移采用三次 Hermite 插值）出发，并且必须包含轴向、弯曲和转动耦合项。\n\n任务 2. 考虑一个方形单胞，其角节点按逆时针方向标记为 $1:(0,0)$，$2:(L,0)$，$3:(L,L)$ 和 $4:(0,L)$。通过连接以下四个单元来组装单胞的 $12 \\times 12$ 全局刚度矩阵 $K_{\\text{uc}}$：底部 $(1$–$2)$、右侧 $(2$–$3)$、顶部 $(4$–$3)$ 和左侧 $(1$–$4)$。使用适当的方向余弦变换，将每个单元的刚度矩阵转换到全局坐标系 $(x,y)$ 中。\n\n任务 3. 通过指定如下的节点位移和转角，对单胞施加一个宏观纯剪切变形：在底部边缘节点 $1$ 和 $2$ 处，设置 $u=0, v=0, \\theta=0$；在顶部边缘节点 $3$ 和 $4$ 处，设置 $u=\\gamma L, v=0, \\theta=0$，其中 $\\gamma$ 是施加的宏观工程剪切应变。选择这些边界条件是为了与沿竖直边缘的周期性相容，并消除单胞的刚体转动。使用组装好的刚度矩阵，计算由顶部边缘支撑的总水平反力 $R$（等于节点 $3$ 和 $4$ 处 $x$ 方向反力之和）。\n\n将方形晶格的均质化等效剪切模量定义为\n$$\nG_{\\text{eff}} \\equiv \\frac{\\tau}{\\gamma}, \\quad \\text{with} \\quad \\tau \\equiv \\frac{R}{L},\n$$\n其中 $\\tau$ 是顶部边缘上的平均宏观剪切应力。将 $G_{\\text{eff}}$ 的最终答案表示为仅包含 $E$、$I$ 和 $L$ 的单个闭式解析表达式。以帕斯卡（Pascals）为单位表示 $G_{\\text{eff}}$。无需进行数值代入，也无需四舍五入。转角单位默认为弧度。", "solution": "所述问题具有科学依据、是适定且客观的。它基于线性弹性力学和结构力学的既定原理，特别是 Euler-Bernoulli 梁理论和直接刚度法。所提供的数据、边界条件和定义是自洽且充分的，足以获得等效剪切模量的唯一、有意义的解。该问题是结构化材料力学中的一个标准练习，是一个有效的问题。我将开始解答。\n\n解答分为三个部分，与问题陈述中的任务相对应。\n\n任务1：平面梁单元刚度矩阵的推导\n\n我们从虚功原理开始，该原理将内虚功与外虚功相等同。对于保守系统，刚度矩阵可以从应变能泛函 $U$ 推导出来。长度为 $L_e$ 的 Euler-Bernoulli 梁单元的总应变能是轴向变形能和弯曲变形能之和。\n$$\nU = U_{\\text{axial}} + U_{\\text{bending}} = \\frac{1}{2} \\int_{0}^{L_e} E A [\\epsilon_{xx}(x)]^2 dx + \\frac{1}{2} \\int_{0}^{L_e} E I [\\kappa(x)]^2 dx\n$$\n其中 $E$ 是杨氏模量，$A$ 是横截面积，$I$ 是截面二次矩，$\\epsilon_{xx}$ 是轴向应变，$\\kappa$ 是曲率。沿梁的局部坐标为 $x$。单元的节点自由度 (DOF) 由向量 $d' = (u_1, v_1, \\theta_1, u_2, v_2, \\theta_2)^T$ 给出。\n\n对于轴向变形，位移场 $u(x)$ 在两个节点之间进行线性插值。\n$$\nu(x) = (1 - \\frac{x}{L_e})u_1 + (\\frac{x}{L_e})u_2\n$$\n轴向应变是位移的空间导数：\n$$\n\\epsilon_{xx}(x) = \\frac{du}{dx} = \\frac{1}{L_e}(-u_1 + u_2)\n$$\n轴向应变沿单元为常数。轴向应变能为：\n$$\nU_{\\text{axial}} = \\frac{1}{2} \\int_{0}^{L_e} EA (\\frac{u_2 - u_1}{L_e})^2 dx = \\frac{EA}{2L_e}(u_2 - u_1)^2\n$$\n\n对于弯曲变形，横向位移场 $v(x)$ 使用三次 Hermite 形函数进行插值，以确保节点处位移和转角的连续性。\n$$\nv(x) = H_1(x)v_1 + H_2(x)\\theta_1 + H_3(x)v_2 + H_4(x)\\theta_2\n$$\n其中形函数为：\n$H_1(x) = 1 - 3(\\frac{x}{L_e})^2 + 2(\\frac{x}{L_e})^3$\n$H_2(x) = x(1 - \\frac{x}{L_e})^2 = x - 2\\frac{x^2}{L_e} + \\frac{x^3}{L_e^2}$\n$H_3(x) = 3(\\frac{x}{L_e})^2 - 2(\\frac{x}{L_e})^3$\n$H_4(x) = \\frac{x^3}{L_e^2} - \\frac{x^2}{L_e}$\n曲率由 $\\kappa(x) = \\frac{d^2v}{dx^2}$ 给出。\n$$\n\\kappa(x) = \\frac{d^2H_1}{dx^2}v_1 + \\frac{d^2H_2}{dx^2}\\theta_1 + \\frac{d^2H_3}{dx^2}v_2 + \\frac{d^2H_4}{dx^2}\\theta_2\n$$\n弯曲应变能则为 $U_{\\text{bending}} = \\frac{1}{2} d_{\\text{bend}}'^T k'_{\\text{bend}} d_{\\text{bend}}'$，其中 $d_{\\text{bend}}' = (v_1, \\theta_1, v_2, \\theta_2)^T$，弯曲刚度矩阵 $k'_{\\text{bend}}$ 的分量通过对形函数二阶导数乘积的积分求得：$(k'_{\\text{bend}})_{ij} = \\int_0^{L_e} EI (\\frac{d^2 H_i}{dx^2})(\\frac{d^2 H_j}{dx^2}) dx$。\n\n单元刚度矩阵 $k'$ 通过 $f' = k' d'$ 将节点力 $f'$ 与节点位移 $d'$ 联系起来。其分量由总应变能对节点自由度的二阶偏导数给出：$k'_{ij} = \\frac{\\partial^2 U}{\\partial d'_i \\partial d'_j}$。\n由于 $U = U_{\\text{axial}} + U_{\\text{bending}}$，且 $U_{\\text{axial}}$ 仅依赖于 $u_1, u_2$，而 $U_{\\text{bending}}$ 仅依赖于 $v_1, \\theta_1, v_2, \\theta_2$，因此对于线性 Euler-Bernoulli 梁，在局部坐标系中轴向行为与弯曲行为之间没有耦合。最终得到的 $6 \\times 6$ 局部刚度矩阵 $k'$ 是块对角矩阵。对于长度为 $L$ 的梁，它表示为：\n$$\nk' = \\begin{pmatrix}\n\\frac{EA}{L}  0  0  -\\frac{EA}{L}  0  0 \\\\\n0  \\frac{12EI}{L^3}  \\frac{6EI}{L^2}  0  -\\frac{12EI}{L^3}  \\frac{6EI}{L^2} \\\\\n0  \\frac{6EI}{L^2}  \\frac{4EI}{L}  0  -\\frac{6EI}{L^2}  \\frac{2EI}{L} \\\\\n-\\frac{EA}{L}  0  0  \\frac{EA}{L}  0  0 \\\\\n0  -\\frac{12EI}{L^3}  -\\frac{6EI}{L^2}  0  \\frac{12EI}{L^3}  -\\frac{6EI}{L^2} \\\\\n0  \\frac{6EI}{L^2}  \\frac{2EI}{L}  0  -\\frac{6EI}{L^2}  \\frac{4EI}{L}\n\\end{pmatrix}\n$$\n\n任务2：全局刚度矩阵 $K_{\\text{uc}}$ 的组装\n\n单胞由四根长度为 $L$ 的梁组成。全局刚度矩阵 $K_{\\text{uc}}$ 是一个 $12 \\times 12$ 的矩阵，对应于四个节点的自由度，其顺序为 $(u_1,v_1,\\theta_1, u_2,v_2,\\theta_2, u_3,v_3,\\theta_3, u_4,v_4,\\theta_4)^T$。要组装 $K_{\\text{uc}}$，每个单元的局部刚度矩阵 $k'$ 必须转换到全局坐标系。全局单元刚度矩阵 $K^{(e)}$ 由 $K^{(e)} = T^T k' T$ 给出，其中 $T$ 是旋转矩阵。\n$$\nT = \\begin{pmatrix} R_m  0 \\\\ 0  R_m \\end{pmatrix}, \\quad \\text{with} \\quad R_m = \\begin{pmatrix} c  s  0 \\\\ -s  c  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n这里，$c = \\cos(\\alpha)$ 和 $s = \\sin(\\alpha)$，其中 $\\alpha$ 是从全局 $x$ 轴到单元局部 $x$ 轴的角度。\n\n1.  梁 1-2 (底部)：从 $(0,0)$ 到 $(L,0)$。$\\alpha=0$，所以 $c=1, s=0$。$T=I$，单位矩阵。此单元的全局刚度矩阵 $K^{(1-2)}$ 就是 $k'$。\n2.  梁 2-3 (右侧)：从 $(L,0)$ 到 $(L,L)$。$\\alpha=\\pi/2$，所以 $c=0, s=1$。该变换得到一个矩阵 $K^{(2-3)}$，其中轴向项和弯曲项相对于 $k'$ 相互交换。\n3.  梁 4-3 (顶部)：从 $(0,L)$ 到 $(L,L)$。$\\alpha=0$，所以 $c=1, s=0$。$T=I$。此单元的全局刚度矩阵 $K^{(4-3)}$ 是 $k'$。注意连接关系是从节点 4 到节点 3。\n4.  梁 1-4 (左侧)：从 $(0,0)$ 到 $(0,L)$。$\\alpha=\\pi/2$，所以 $c=0, s=1$。全局矩阵 $K^{(1-4)}$ 的形式与 $K^{(2-3)}$ 相同。\n\n全局矩阵 $K_{\\text{uc}}$ 是通过将这四个单元矩阵的贡献累加到其节点编号对应的适当行和列中来组装的。\n\n任务3：等效剪切模量 $G_{\\text{eff}}$ 的计算\n\n问题指定了一个宏观纯剪切变形。指定的位移向量 $d$ 为：\n$$\nd^T = (u_1, v_1, \\theta_1, u_2, v_2, \\theta_2, u_3, v_3, \\theta_3, u_4, v_4, \\theta_4) = (0, 0, 0, 0, 0, 0, \\gamma L, 0, 0, \\gamma L, 0, 0)\n$$\n反力向量 $F$ 由 $F = K_{\\text{uc}} d$ 给出。我们要求解顶部边缘上的总水平反力 $R$，它是节点 $3$ 和 $4$ 处 $x$ 方向力的总和，即 $R = F_{3x} + F_{4x}$。这些是 $F$ 的第 $7$ 个和第 $10$ 个分量。\n$$\nF_{3x} = (K_{\\text{uc}})_{7,1} d_1 + \\dots + (K_{\\text{uc}})_{7,12} d_{12}\n$$\n$$\nF_{4x} = (K_{\\text{uc}})_{10,1} d_1 + \\dots + (K_{\\text{uc}})_{10,12} d_{12}\n$$\n鉴于只有 $d_7 = u_3 = \\gamma L$ 和 $d_{10} = u_4 = \\gamma L$ 是非零的，表达式简化为：\n$$\nF_{3x} = (K_{\\text{uc}})_{7,7} u_3 + (K_{\\text{uc}})_{7,10} u_4 = ((K_{\\text{uc}})_{7,7} + (K_{\\text{uc}})_{7,10}) \\gamma L\n$$\n$$\nF_{4x} = (K_{\\text{uc}})_{10,7} u_3 + (K_{\\text{uc}})_{10,10} u_4 = ((K_{\\text{uc}})_{10,7} + (K_{\\text{uc}})_{10,10}) \\gamma L\n$$\n所需的矩阵分量由各单元的贡献组装而成：\n- $(K_{\\text{uc}})_{7,7}$ 是 $u_3-u_3$ 刚度。节点 $3$ 连接到梁 2-3（竖直，2 端）和梁 4-3（水平，2 端）。$(K_{\\text{uc}})_{7,7} = (K^{(2-3)}_{22})_{11} + (K^{(4-3)}_{22})_{11} = \\frac{12EI}{L^3} + \\frac{EA}{L}$。\n- $(K_{\\text{uc}})_{10,10}$ 是 $u_4-u_4$ 刚度。节点 $4$ 连接到梁 1-4（竖直，2 端）和梁 4-3（水平，1 端）。$(K_{\\text{uc}})_{10,10} = (K^{(1-4)}_{22})_{11} + (K^{(4-3)}_{11})_{11} = \\frac{12EI}{L^3} + \\frac{EA}{L}$。\n- $(K_{\\text{uc}})_{7,10}$ 是 $u_3-u_4$ 耦合。这仅来自于连接节点 4（1 端）和节点 3（2 端）的梁 4-3。$(K_{\\text{uc}})_{7,10} = (K^{(4-3)}_{21})_{11} = -\\frac{EA}{L}$。\n- $(K_{\\text{uc}})_{10,7} = (K_{\\text{uc}})_{7,10}^T = -\\frac{EA}{L}$。\n\n将这些代入力方程：\n$$\nF_{3x} = \\left( \\left(\\frac{12EI}{L^3} + \\frac{EA}{L}\\right) + \\left(-\\frac{EA}{L}\\right) \\right) \\gamma L = \\frac{12EI\\gamma}{L^2}\n$$\n$$\nF_{4x} = \\left( \\left(-\\frac{EA}{L}\\right) + \\left(\\frac{12EI}{L^3} + \\frac{EA}{L}\\right) \\right) \\gamma L = \\frac{12EI\\gamma}{L^2}\n$$\n关键的是，轴向刚度项 $EA/L$ 相互抵消。这在物理上是一致的，因为所施加的变形确保了没有构件承受轴向应变。总水平反力为：\n$$\nR = F_{3x} + F_{4x} = \\frac{12EI\\gamma}{L^2} + \\frac{12EI\\gamma}{L^2} = \\frac{24EI\\gamma}{L^2}\n$$\n宏观剪切应力 $\\tau$ 定义为 $\\tau = R/L$。\n$$\n\\tau = \\frac{1}{L} \\left( \\frac{24EI\\gamma}{L^2} \\right) = \\frac{24EI\\gamma}{L^3}\n$$\n最后，等效剪切模量 $G_{\\text{eff}}$ 定义为 $\\tau/\\gamma$。\n$$\nG_{\\text{eff}} = \\frac{\\tau}{\\gamma} = \\frac{1}{\\gamma} \\left( \\frac{24EI\\gamma}{L^3} \\right) = \\frac{24EI}{L^3}\n$$\n该表达式的单位是 $(N/m^2)(m^4)/(m^3) = N/m^2$，即帕斯卡（Pascals），符合要求。", "answer": "$$\n\\boxed{\\frac{24EI}{L^3}}\n$$", "id": "2901571"}, {"introduction": "将理论模型转化为计算仿真，需要审慎选择数值方法。本练习将指导你比较不同类型的有限元（梁、壳和实体单元）在模拟细长杆状晶格时的表现，并揭示剪切自锁和沙漏现象等常见的数值病态问题。通过编写程序来量化这些误差，你将学会如何批判性地评估仿真结果，并为结构化材料选择合适的建模策略([@problem_id:2901670])。", "problem": "您必须编写一个程序，比较用于模拟周期性细长杆晶格的三种常用有限元离散化族，并确定数值病态何时会污染预测的有效刚度。该晶格是一个由与加载轴对齐的平行圆柱形杆组成的简单立方阵列，其晶胞尺寸为 $a$，杆半径为 $r$。组成材料的杨氏模量为 $E_s$。沿杆方向的宏观有效模量（记为 $E_{\\mathrm{eff,true}}$）必须通过在沿杆方向的单轴应变条件下进行均匀化，从第一性原理推导得出。将该结构视为在横向上以间距 $a$ 分布的轴向加载杆的平行阵列。\n\n使用的基本原理和假设：\n- 力平衡和应力定义：$\\sigma = F/A$。\n- 等截面杆的轴向刚度：$k = E A / L$。\n- 对于每单位面积 $a^2$ 分布一根横截面积为 $A_b$ 的杆的平行阵列，其体积分数为：$\\phi = A_b / a^2$。\n- 由体积分数为 $\\phi$ 的平行轴向加载杆组成的复合材料的有效模量：$E_{\\mathrm{eff,true}} = \\phi E_s$。\n- 对于圆柱形杆，其横截面积为 $A_b = \\pi r^2$。\n基于这些原理，用 $E_s$、$r$ 和 $a$ 推导出 $E_{\\mathrm{eff,true}}$，并以吉帕斯卡（GPa）为单位计算其值。显式地以 GPa 表示 $E_{\\mathrm{eff,true}}$，并在任何出现 $r$ 和 $a$ 的地方统一使用毫米（mm）单位。\n\n您必须接着比较三种离散化族，每一种都针对预测的有效模量 $E_{\\mathrm{eff,pred}}$ 相对于 $E_{\\mathrm{eff,true}}$ 有一个单一的无量纲误差模型。如果相对误差的绝对值超过容差 $\\varepsilon_{\\mathrm{tol}}$，则认为该离散化被“污染”。\n\n污染的定义和建模：\n- 定义杆的长细比为 $\\lambda = L/t$，其中 $L = a$ 且 $t = 2 r$，因此 $\\lambda = a/(2 r)$。\n- 设 $n_e$ 为在壳或实体离散化中，沿加载方向每个杆长 $L$ 上的单元数量，建模为尺寸均匀的单元。\n\n您必须采用以下污染标度模型，这些模型的建立是基于一阶单元中的运动学约束和插值误差：\n1. 梁离散化（与 Euler–Bernoulli 兼容的轴向杆理想化）：\n   - 假设：无寄生剪切；预测的轴向响应等于轴向杆的响应。\n   - 相对误差恒等于零：$\\delta_{\\mathrm{beam}} = 0$。\n2. 壳离散化（一阶剪切变形，Mindlin–Reissner 型），采用低阶插值：\n   - 在薄壁极限下的寄生剪切锁定会引入过刚现象，其大小与长细比的平方成比例，可通过网格细化来减轻：\n   - 使用 $\\delta_{\\mathrm{shell}} = \\min\\!\\left(\\alpha_s \\dfrac{\\lambda^2}{n_e}, \\delta_{\\mathrm{shell,max}}\\right)$，其中 $\\alpha_s = 2 \\times 10^{-3}$ 且 $\\delta_{\\mathrm{shell,max}} = 0.6$。\n3. 实体离散化：\n   - 完全积分、低阶实体单元：\n     - 剪切/弯曲锁定的类似现象建模为 $\\delta_{\\mathrm{solid,full}} = \\min\\!\\left(\\alpha_f \\dfrac{\\lambda^2}{n_e}, \\delta_{\\mathrm{full,max}}\\right)$，其中 $\\alpha_f = 8 \\times 10^{-4}$ 且 $\\delta_{\\mathrm{full,max}} = 0.4$。\n   - 减缩积分、低阶实体单元：\n     - 沙漏现象会导致欠刚，该效应会随着网格细化而衰减：\n     - 使用 $\\delta_{\\mathrm{solid,red}} = - \\min\\!\\left(\\dfrac{\\gamma_h}{n_e^p}, \\delta_{\\mathrm{red,max}}\\right)$，其中 $\\gamma_h = 0.3$，$p = 1$ 且 $\\delta_{\\mathrm{red,max}} = 0.3$。\n\n对于每种离散化，预测的有效模量为 $E_{\\mathrm{eff,pred}} = E_{\\mathrm{eff,true}} \\left(1 + \\delta\\right)$。如果 $\\left|\\delta\\right|  \\varepsilon_{\\mathrm{tol}}$，则认为该离散化被“污染”，其中 $\\varepsilon_{\\mathrm{tol}} = 0.05$。\n\n角度单位不适用。物理单位：以吉帕斯卡（GPa）表示 $E_s$、$E_{\\mathrm{eff,true}}$ 和 $E_{\\mathrm{eff,pred}}$。所有几何输入 $a$ 和 $r$ 均以毫米（mm）为单位。污染判定是无量纲的。\n\n实现一个程序，对于每个测试用例，计算：\n- $E_{\\mathrm{eff,true}}$（以 GPa 为单位），\n- 对于每个离散化族，计算相对误差 $\\delta$ 和污染布尔值，\n- 在所考虑的 4 个族（梁、壳、完全积分实体和减缩积分实体）中，被污染的离散化总数。\n\n测试套件：\n使用以下五个测试用例，每个用例以元组 $(E_s\\ \\mathrm{[GPa]}, a\\ \\mathrm{[mm]}, r\\ \\mathrm{[mm]}, n_e)$ 的形式给出：\n- 案例 1：$(70, 10, 0.1, 1)$\n- 案例 2：$(70, 10, 0.1, 4)$\n- 案例 3：$(70, 10, 1.0, 1)$\n- 案例 4：$(70, 10, 0.3, 2)$\n- 案例 5：$(70, 20, 0.1, 2)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个 Python 风格的整数列表，每个整数是对应测试用例（按上述顺序）被污染的离散化数量。例如，您的输出必须采用 $[c_1,c_2,c_3,c_4,c_5]$ 的格式，不含空格，其中每个 $c_i$ 是一个整数。", "solution": "在尝试任何解决方案之前，首先对问题陈述进行验证。\n\n首先，从问题陈述中逐字提取给定的信息和条件。\n- 晶格几何形状：一个简单立方阵列的平行圆柱形杆。\n- 晶胞尺寸：$a$。\n- 杆半径：$r$。\n- 组成材料的杨氏模量：$E_s$。\n- 待确定的有效模量：$E_{\\mathrm{eff,true}}$。\n- 均匀化的加载条件：沿杆方向的单轴应变。\n- 基本原理：力平衡和应力定义，$\\sigma = F/A$；等截面杆的轴向刚度，$k = E A / L$；平行杆阵列的体积分数，$\\phi = A_b / a^2$；基于混合法则的有效模量，$E_{\\mathrm{eff,true}} = \\phi E_s$。\n- 杆的横截面积：$A_b = \\pi r^2$。\n- 单位：$E_s$ 单位为 GPa；$r$ 和 $a$ 单位为 mm。\n- 杆的长细比：$\\lambda = a/(2r)$。\n- 离散化密度：每个杆长上的单元数量为 $n_e$。\n- 预测模量 $E_{\\mathrm{eff,pred}} = E_{\\mathrm{eff,true}}(1+\\delta)$ 的相对误差模型：\n    1. 梁离散化：$\\delta_{\\mathrm{beam}} = 0$。\n    2. 壳离散化（Mindlin-Reissner 型）：$\\delta_{\\mathrm{shell}} = \\min(\\alpha_s \\dfrac{\\lambda^2}{n_e}, \\delta_{\\mathrm{shell,max}})$，其中 $\\alpha_s = 2 \\times 10^{-3}$ 且 $\\delta_{\\mathrm{shell,max}} = 0.6$。\n    3. 实体离散化（完全积分）：$\\delta_{\\mathrm{solid,full}} = \\min(\\alpha_f \\dfrac{\\lambda^2}{n_e}, \\delta_{\\mathrm{full,max}})$，其中 $\\alpha_f = 8 \\times 10^{-4}$ 且 $\\delta_{\\mathrm{full,max}} = 0.4$。\n    4. 实体离散化（减缩积分）：$\\delta_{\\mathrm{solid,red}} = - \\min(\\dfrac{\\gamma_h}{n_e^p}, \\delta_{\\mathrm{red,max}})$，其中 $\\gamma_h = 0.3$，$p = 1$ 且 $\\delta_{\\mathrm{red,max}} = 0.3$。\n- 污染准则：如果一个离散化的相对误差绝对值 $|\\delta|$ 超过容差 $\\varepsilon_{\\mathrm{tol}} = 0.05$，则认为其被“污染”。\n- 测试用例 $(E_s, a, r, n_e)$：案例 1：$(70, 10, 0.1, 1)$，案例 2：$(70, 10, 0.1, 4)$，案例 3：$(70, 10, 1.0, 1)$，案例 4：$(70, 10, 0.3, 2)$，案例 5：$(70, 20, 0.1, 2)$。\n\n接下来，根据所需标准评估问题的有效性。\n- **科学依据**：该问题在材料力学和计算力学方面有充分的依据。通过混合法则对简单的平行杆晶格进行均匀化处理是一种标准的、正确的初等方法。误差模型虽然是唯象的，但正确地代表了常见有限元病态的定性行为：壳单元和实体单元中的寄生剪切锁定（过刚度与长细比的平方成比例，通过网格细化减轻）以及减缩积分单元中的沙漏现象（欠刚度，通过网格细化减轻）。参数值是给定的，并假定为经验确定，这是一种有效的建模方法。\n- **适定性**：该问题是完全指定的。所有必要的参数、常数和公式都已提供，可以为每个测试用例计算出唯一的结果。\n- **客观性**：问题陈述使用了精确的技术术语，没有主观或模棱两可的语言。\n\n该问题没有表现出任何列举的无效性缺陷。它是科学合理的、可形式化的、完整的和适定的。所提供的数据在物理上和量纲上都是一致的。单位已指定，且转换是微不足道的，因为长度比 $(r/a)$ 是无量纲的。因此，如果 $E_s$ 的单位是 GPa，那么 $E_{\\mathrm{eff,true}}$ 的单位自然也是 GPa。\n\n结论是该问题是**有效的**。将着手开发一个解决方案。\n\n按照指示，解决方案从第一性原理出发。晶格结构是杆的平行阵列。在沿杆轴的单轴应变下，每个杆表现为独立的轴向加载杆。这种复合材料的有效模量由混合法则给出。\n\n杆的体积分数 $\\phi$ 是杆的横截面积 $A_b$ 与晶胞横截面积 $A_{cell} = a^2$ 的比值。\n$$ \\phi = \\frac{A_b}{A_{cell}} = \\frac{\\pi r^2}{a^2} = \\pi \\left(\\frac{r}{a}\\right)^2 $$\n真实的有效模量 $E_{\\mathrm{eff,true}}$ 则由混合法则推导得出：\n$$ E_{\\mathrm{eff,true}} = \\phi E_s = E_s \\pi \\left(\\frac{r}{a}\\right)^2 $$\n按要求，如果 $E_s$ 以 GPa 为单位给出，而 $r$ 和 $a$ 以 mm 为单位，则比值 $(r/a)^2$ 是无量纲的，因此 $E_{\\mathrm{eff,true}}$ 将以 GPa 为单位计算得出。\n\n杆的长细比 $\\lambda$ 定义为其长度 $L=a$ 与其厚度 $t=2r$ 的比值：\n$$ \\lambda = \\frac{a}{2r} $$\n\n对四种离散化族的污染分析基于所提供的误差模型和容差 $\\varepsilon_{\\mathrm{tol}} = 0.05$。如果 $|\\delta|  0.05$，则离散化被视为污染。\n\n四种误差模型如下：\n1.  梁：$\\delta_{\\mathrm{beam}} = 0$。由于 $|\\delta_{\\mathrm{beam}}| = 0$，不大于 $0.05$，该模型永远不会被污染。\n2.  壳：$\\delta_{\\mathrm{shell}} = \\min(0.002 \\frac{\\lambda^2}{n_e}, 0.6)$。如果 $\\delta_{\\mathrm{shell}}  0.05$，则发生污染。\n3.  实体（完全积分）：$\\delta_{\\mathrm{solid,full}} = \\min(0.0008 \\frac{\\lambda^2}{n_e}, 0.4)$。如果 $\\delta_{\\mathrm{solid,full}}  0.05$，则发生污染。\n4.  实体（减缩积分）：$\\delta_{\\mathrm{solid,red}} = - \\min(\\frac{0.3}{n_e}, 0.3)$，因为 $p=1$。如果 $|\\delta_{\\mathrm{solid,red}}|  0.05$，即 $\\min(\\frac{0.3}{n_e}, 0.3)  0.05$，则发生污染。\n\n我们现在将处理每个测试用例。\n\n**案例 1**：$(E_s=70\\ \\mathrm{GPa}, a=10\\ \\mathrm{mm}, r=0.1\\ \\mathrm{mm}, n_e=1)$\n- 长细比：$\\lambda = \\frac{10}{2 \\times 0.1} = 50$。\n- 误差：\n    - $\\delta_{\\mathrm{beam}} = 0$。$|\\delta| = 0 \\ngtr 0.05$。未污染。\n    - $\\delta_{\\mathrm{shell}} = \\min(0.002 \\times \\frac{50^2}{1}, 0.6) = \\min(5.0, 0.6) = 0.6$。$|\\delta| = 0.6  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,full}} = \\min(0.0008 \\times \\frac{50^2}{1}, 0.4) = \\min(2.0, 0.4) = 0.4$。$|\\delta| = 0.4  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,red}} = -\\min(\\frac{0.3}{1}, 0.3) = -0.3$。$|\\delta| = 0.3  0.05$。污染。\n- 总污染数：$3$。\n\n**案例 2**：$(E_s=70\\ \\mathrm{GPa}, a=10\\ \\mathrm{mm}, r=0.1\\ \\mathrm{mm}, n_e=4)$\n- 长细比：$\\lambda = \\frac{10}{2 \\times 0.1} = 50$。\n- 误差：\n    - $\\delta_{\\mathrm{beam}} = 0$。未污染。\n    - $\\delta_{\\mathrm{shell}} = \\min(0.002 \\times \\frac{50^2}{4}, 0.6) = \\min(1.25, 0.6) = 0.6$。$|\\delta| = 0.6  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,full}} = \\min(0.0008 \\times \\frac{50^2}{4}, 0.4) = \\min(0.5, 0.4) = 0.4$。$|\\delta| = 0.4  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,red}} = -\\min(\\frac{0.3}{4}, 0.3) = -0.075$。$|\\delta| = 0.075  0.05$。污染。\n- 总污染数：$3$。\n\n**案例 3**：$(E_s=70\\ \\mathrm{GPa}, a=10\\ \\mathrm{mm}, r=1.0\\ \\mathrm{mm}, n_e=1)$\n- 长细比：$\\lambda = \\frac{10}{2 \\times 1.0} = 5$。\n- 误差：\n    - $\\delta_{\\mathrm{beam}} = 0$。未污染。\n    - $\\delta_{\\mathrm{shell}} = \\min(0.002 \\times \\frac{5^2}{1}, 0.6) = \\min(0.05, 0.6) = 0.05$。$|\\delta| = 0.05 \\ngtr 0.05$。未污染。\n    - $\\delta_{\\mathrm{solid,full}} = \\min(0.0008 \\times \\frac{5^2}{1}, 0.4) = \\min(0.02, 0.4) = 0.02$。$|\\delta| = 0.02 \\ngtr 0.05$。未污染。\n    - $\\delta_{\\mathrm{solid,red}} = -\\min(\\frac{0.3}{1}, 0.3) = -0.3$。$|\\delta| = 0.3  0.05$。污染。\n- 总污染数：$1$。\n\n**案例 4**：$(E_s=70\\ \\mathrm{GPa}, a=10\\ \\mathrm{mm}, r=0.3\\ \\mathrm{mm}, n_e=2)$\n- 长细比：$\\lambda = \\frac{10}{2 \\times 0.3} = \\frac{10}{0.6} \\approx 16.67$。\n- 误差：\n    - $\\delta_{\\mathrm{beam}} = 0$。未污染。\n    - $\\delta_{\\mathrm{shell}} = \\min(0.002 \\times \\frac{(16.67)^2}{2}, 0.6) \\approx \\min(0.278, 0.6) = 0.278$。$|\\delta| = 0.278  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,full}} = \\min(0.0008 \\times \\frac{(16.67)^2}{2}, 0.4) \\approx \\min(0.111, 0.4) = 0.111$。$|\\delta| = 0.111  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,red}} = -\\min(\\frac{0.3}{2}, 0.3) = -0.15$。$|\\delta| = 0.15  0.05$。污染。\n- 总污染数：$3$。\n\n**案例 5**：$(E_s=70\\ \\mathrm{GPa}, a=20\\ \\mathrm{mm}, r=0.1\\ \\mathrm{mm}, n_e=2)$\n- 长细比：$\\lambda = \\frac{20}{2 \\times 0.1} = 100$。\n- 误差：\n    - $\\delta_{\\mathrm{beam}} = 0$。未污染。\n    - $\\delta_{\\mathrm{shell}} = \\min(0.002 \\times \\frac{100^2}{2}, 0.6) = \\min(10.0, 0.6) = 0.6$。$|\\delta| = 0.6  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,full}} = \\min(0.0008 \\times \\frac{100^2}{2}, 0.4) = \\min(4.0, 0.4) = 0.4$。$|\\delta| = 0.4  0.05$。污染。\n    - $\\delta_{\\mathrm{solid,red}} = -\\min(\\frac{0.3}{2}, 0.3) = -0.15$。$|\\delta| = 0.15  0.05$。污染。\n- 总污染数：$3$。\n\n五个测试用例的最终污染计数列表为 $[3, 3, 1, 3, 3]$。实现将遵循此逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of contaminated finite element discretization families\n    for several test cases of a periodic slender-strut lattice.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (E_s [GPa], a [mm], r [mm], n_e)\n    test_cases = [\n        (70, 10, 0.1, 1),\n        (70, 10, 0.1, 4),\n        (70, 10, 1.0, 1),\n        (70, 10, 0.3, 2),\n        (70, 20, 0.1, 2),\n    ]\n\n    # Constants from problem statement\n    epsilon_tol = 0.05\n\n    # Parameters for shell model\n    alpha_s = 2e-3\n    delta_shell_max = 0.6\n\n    # Parameters for full integration solid model\n    alpha_f = 8e-4\n    delta_full_max = 0.4\n\n    # Parameters for reduced integration solid model\n    gamma_h = 0.3\n    p = 1\n    delta_red_max = 0.3\n\n    results = []\n    \n    for case in test_cases:\n        E_s, a, r, n_e = case\n        \n        # Initialize counter for contaminated discretizations\n        contaminated_count = 0\n\n        # Calculate strut slenderness lambda\n        lambda_val = a / (2 * r)\n\n        # 1. Beam discretization\n        # delta_beam is always 0, so |delta| is never  epsilon_tol\n        # No contamination.\n\n        # 2. Shell discretization\n        delta_shell = min(alpha_s * (lambda_val**2) / n_e, delta_shell_max)\n        if abs(delta_shell) > epsilon_tol:\n            contaminated_count += 1\n\n        # 3. Solid discretization (full integration)\n        delta_solid_full = min(alpha_f * (lambda_val**2) / n_e, delta_full_max)\n        if abs(delta_solid_full) > epsilon_tol:\n            contaminated_count += 1\n            \n        # 4. Solid discretization (reduced integration)\n        delta_solid_red = -min(gamma_h / (n_e**p), delta_red_max)\n        if abs(delta_solid_red) > epsilon_tol:\n            contaminated_count += 1\n\n        results.append(contaminated_count)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2901670"}, {"introduction": "许多超材料的真正威力在于它们操控波的独特能力，这是一种动力学现象。本练习将向你介绍分析这些动力学行为的核心工具——色散曲线。你将通过实现布洛赫周期性有限元分析来计算一个方晶格的色散曲线，从而揭示其波动传播特性（如带隙）的奥秘([@problem_id:2901730])。", "problem": "实现一个程序，该程序使用布洛赫周期性有限元 (FE) 公式计算无限正方形晶格中轴向可变形杆件的色散曲线，并与从第一性原理推导出的解析质点-弹簧代理模型进行验证。使用以下基本定律和定义作为基础：牛顿第二定律 $m \\ddot{u} = f$、轴向刚度为 $k_{e} = EA/L$ 的轴向可变形杆的线性弹性、采用集总质量的质量守恒 $m_{e} = \\rho A L$，以及弗洛凯-布洛赫定理，即对于晶格平移矢量 $\\mathbf{R}$ 和波矢 $\\mathbf{k}$，有 $u(\\mathbf{x} + \\mathbf{R}) = u(\\mathbf{x}) e^{\\mathrm{i} \\mathbf{k}\\cdot \\mathbf{R}}$。除这些基本原理所隐含的公式外，不要使用任何其他公式；所有需要的关系都必须推导出来。\n\n考虑一个边长为 $a$ 的正方形晶胞，其四个角节点位于坐标 $(0,0)$、$(a,0)$、$(0,a)$ 和 $(a,a)$。晶胞的边缘被建模为四个轴向可变形杆件（两个水平，两个垂直）。每个节点有两个平面内平移自由度 $(u_x,u_y)$。为此四单元、四节点的晶胞组装 $8 \\times 8$ 的全局刚度矩阵和质量矩阵。采用集总质量：对于每根杆件，将其质量 $m_{e}/2$ 分配给其两端节点，用于 $u_x$ 和 $u_y$ 两个自由度。通过引入一个复变换矩阵来施加布洛赫周期性边界条件，该矩阵根据弗洛凯-布洛赫定理，通过相位因子 $e^{\\mathrm{i} k_x a}$ 和 $e^{\\mathrm{i} k_y a}$ 将所有节点自由度映射到参考节点 $(0,0)$ 处的两个主自由度。将系统简化为一个 $2 \\times 2$ 的广义厄米特征值问题，形式如下\n$$\n\\left( \\mathbf{K}_B(\\mathbf{k}) - \\omega^2 \\mathbf{M}_B(\\mathbf{k}) \\right) \\mathbf{u} = \\mathbf{0},\n$$\n并为给定的 $\\mathbf{k} = (k_x,k_y)$ 计算两个非负特征频率 $\\omega$。\n\n同时，通过将两个水平杆件视作对 $u_x$ 运动有贡献的轴向弹簧，将两个垂直杆件視作对 $u_y$ 运动有贡献的轴向弹簧，并结合集总杆件质量，为相同结构推导解析的质点-弹簧代理模型。严格从晶格节点与其最近邻相互作用的牛顿第二定律出发，并使用弗洛凯-布洛赫关系来消除相邻位移，展示如何得出两个色散分支 $\\omega_x(\\mathbf{k})$ 和 $\\omega_y(\\mathbf{k})$ 关于 $E$、$A$、$\\rho$ 和 $a$ 的封闭形式表达式。\n\n您的程序必须：\n- 为所述晶胞组装 FE 刚度矩阵和质量矩阵。\n- 应用布洛赫变换以简化系统。\n- 求解简化后的广义特征值问题，以获得两个 FE 特征频率。\n- 独立计算从第一性原理推导出的代理模型的两个解析特征频率。\n- 对于每个测试用例，将两个 FE 特征频率和两个解析特征频率按升序排序，并计算两个分支之间的最大绝对差值（单位为弧度/秒）。\n\n所有频率均以弧度/秒表示。\n\n使用以下测试套件。每个测试用例是一个元组 $(a, E, A, \\rho, k_x, k_y)$：\n1. $(0.10, 70\\times 10^9, 1.0\\times 10^{-6}, 2700, 0.0, 0.0)$\n2. $(0.20, 200\\times 10^9, 5.0\\times 10^{-6}, 7800, \\pi/a, 0.0)$\n3. $(0.30, 3.0\\times 10^9, 2.0\\times 10^{-4}, 1200, \\pi/a, \\pi/a)$\n4. $(0.05, 2.0\\times 10^{11}, 1.0\\times 10^{-8}, 8000, 10^{-3}/a, 0.0)$\n5. $(0.12, 210\\times 10^9, 3.0\\times 10^{-6}, 7850, \\pi/(2a), \\pi/(3a))$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与上述测试套件相同。对于每个测试用- 例，输出 FE 布洛赫频率与解析代理模型频率之间的最大绝对差值，单位为弧度/秒，格式为浮点数。例如，输出格式必须完全如下：\n\"[result1,result2,result3,result4,result5]\"\n\n如果在内部使用了角度（例如，通过三角函数），则必须以弧度为单位。最终的数值输出是表示误差（单位为弧度/秒）的浮点数。不应打印其他任何文本。", "solution": "我们通过两种途径构建轴向可变形杆件方格的色散关系：布洛赫周期性有限元(FE)降阶和解析的质点-弹簧代理模型，两者均从牛顿第二定律和弗洛凯-布洛赫定理推导而来。\n\n1) 几何、单元和自由度。晶胞在 $(0,0)$、$(a,0)$、$(0,a)$ 和 $(a,a)$ 处有四个节点，每个节点具有两个平移自由度 $u_x$ 和 $u_y$。边缘被建模为四个轴向杆件，其杨氏模量为 $E$，横截面积为 $A$，材料密度为 $\\rho$，长度为 $L=a$。对于端节点为 $i$ 和 $j$、单位方向矢量为 $\\mathbf{n} = (c,s)$、轴向刚度为 $k_e = EA/L$ 的轴向可变形杆件，其以 $(u_{xi},u_{yi},u_{xj},u_{yj})$ 为序的全局 $4 \\times 4$ 单元刚度矩阵为\n$$\n\\mathbf{k}^{(e)} = \\frac{EA}{L}\n\\begin{bmatrix}\nc^2  cs  -c^2  -cs\\\\\ncs  s^2  -cs  -s^2\\\\\n-c^2  -cs  c^2  cs\\\\\n-cs  -s^2  cs  s^2\n\\end{bmatrix}.\n$$\n对于水平杆件，$c=1,s=0$；对于垂直杆件，$c=0,s=1$。使用集总质量：每个长度为 $L$ 的单元质量为 $m_e = \\rho A L$，分配为 $m_e/2$ 到每个端节点。对于平面内平移，节点质量平均分配给 $u_x$ 和 $u_y$，得到一个对角全局质量矩阵 $\\mathbf{M}$，其每个节点和每个方向上的对角元均相同。\n\n2) 组装。组装四个单元（底边、顶边、左边、右边）可得到一个全局 $8 \\times 8$ 刚度矩阵 $\\mathbf{K}$ 和一个对角的 $8 \\times 8$ 质量矩阵 $\\mathbf{M}$。此时尚未施加任何约束。\n\n3) 弗洛凯-布洛赫降阶。对于波矢 $\\mathbf{k}=(k_x,k_y)$ 和晶胞矢量 $(a,0)$ 和 $(0,a)$，弗洛凯-布洛赫定理施加了带有复相位因子的周期性：\n$$\n\\begin{aligned}\n\\mathbf{u}(a,0) = \\mathbf{u}(0,0) e^{\\mathrm{i} k_x a},\\\\\n\\mathbf{u}(0,a) = \\mathbf{u}(0,0) e^{\\mathrm{i} k_y a},\\\\\n\\mathbf{u}(a,a) = \\mathbf{u}(0,0) e^{\\mathrm{i} (k_x + k_y) a}.\n\\end{aligned}\n$$\n我们引入一个大小为 $8\\times 2$ 的复变换矩阵 $\\mathbf{T}$，将参考节点 $(0,0)$ 处的两个主自由度 $(u_{x0},u_{y0})$ 映射到完整的八个自由度矢量。如果我们按 $(u_{x0},u_{y0},u_{x1},u_{y1},u_{x2},u_{y2},u_{x3},u_{y3})$ 的顺序排列全局自由度，并定义节点相位因子 $\\phi_0=1$、$\\phi_1=e^{\\mathrm{i} k_x a}$、$\\phi_2=e^{\\mathrm{i} k_y a}$、$\\phi_3=e^{\\mathrm{i} (k_x + k_y) a}$，则\n$$\n\\mathbf{T} =\n\\begin{bmatrix}\n\\phi_0  0\\\\\n0  \\phi_0\\\\\n\\phi_1  0\\\\\n0  \\phi_1\\\\\n\\phi_2  0\\\\\n0  \\phi_2\\\\\n\\phi_3  0\\\\\n0  \\phi_3\n\\end{bmatrix}.\n$$\n布洛赫降阶后的 $2 \\times 2$ 矩阵由能量和功的不变性得出：\n$$\n\\mathbf{K}_B(\\mathbf{k}) = \\mathbf{T}^\\ast \\mathbf{K}\\, \\mathbf{T}, \\quad \\mathbf{M}_B(\\mathbf{k}) = \\mathbf{T}^\\ast \\mathbf{M}\\, \\mathbf{T},\n$$\n其中 $\\ast$ 表示共轭转置。$\\mathbf{K}_B$ 和 $\\mathbf{M}_B$ 均为厄米矩阵，且 $\\mathbf{M}_B$ 是正定矩阵。色散关系通过求解广义厄米特征值问题得到\n$$\n\\left( \\mathbf{K}_B(\\mathbf{k}) - \\omega^2 \\mathbf{M}_B(\\mathbf{k}) \\right) \\mathbf{u} = \\mathbf{0}.\n$$\n存在两个分支，对应两种极化。\n\n4) 解析的质点-弹簧代理模型。一个解析的质点-弹簧代理模型可以通过对晶胞的有效刚度和质量进行简化近似来构建。设每根杆的轴向刚度为 $k=EA/a$，质量为 $m_e=\\rho A a$。对于 $u_x$ 极化，此模型将系统的有效刚度近似为 $2k|1-e^{ik_xa}|^2 = 4k(1-\\cos(k_xa))$，并将有效惯性质量近似为晶胞的总质量 $4m_e$。根据这些近似，动力学方程 $M_{\\text{eff}}\\omega_x^2 = K_{\\text{eff}}$ 给出：\n$$\n\\omega_x^2(\\mathbf{k}) = \\frac{4k(1-\\cos(k_xa))}{4m_e} = \\frac{k}{m_e} (1-\\cos(k_xa))\n$$\n类似地，对于 $u_y$ 极化：\n$$\n\\omega_y^2(\\mathbf{k}) = \\frac{k}{m_e} (1-\\cos(k_ya))\n$$\n这些表达式定义了将与有限元结果进行比较的代理模型。\n\n5) 数值算法。对于每个测试用例 $(a,E,A,\\rho,k_x,k_y)$：\n- 使用 $EA/a$ 和 $m_e=\\rho A a$ 为四边晶胞组装 $\\mathbf{K}$ 和 $\\mathbf{M}$。\n- 根据相位因子 $\\{1,e^{\\mathrm{i} k_x a},e^{\\mathrm{i} k_y a},e^{\\mathrm{i} (k_x+k_y) a}\\}$ 构建 $\\mathbf{T}$。\n- 形成 $\\mathbf{K}_B=\\mathbf{T}^\\ast \\mathbf{K}\\mathbf{T}$ 和 $\\mathbf{M}_B=\\mathbf{T}^\\ast \\mathbf{M}\\mathbf{T}$，进行数值上的厄米对称化，并求解广义厄米特征值问题以得到 $\\omega^2$。\n- 将微小的负特征值截断为零，然后取平方根得到非负的 $\\omega$。\n- 使用 $k=EA/a$ 和 $m_e=\\rho A a$ 从推导出的公式计算解析的 $\\omega_x$ 和 $\\omega_y$。\n- 将两组结果按升序排序，并报告两个分支之间 $|\\omega^{\\text{FE}} - \\omega^{\\text{analytical}}|$ 的最大绝对差值，单位为弧度/秒。\n\n6) 测试套件覆盖范围。五个测试用例分别检验：\n- $\\mathbf{k}=\\mathbf{0}$，用于零频率声学模态。\n- 布里渊区边界上 $k_y=0$ 的 $k_x$ 方向，以展示一个零频率分支和一个非零分支。\n- 布里渊区角点 $(\\pi/a,\\pi/a)$，此时两个分支因对称性而相等且非零。\n- 一个小但非零的 $k_x a=10^{-3}$，以检查近零行为和数值稳定性。\n- 一个斜向波矢 $(\\pi/(2a),\\pi/(3a))$，以验证普遍的各向异性采样。\n\n程序输出一行，包含一个由五个浮点数组成的列表，每个浮点数是对应测试用例的最大绝对误差（单位为弧度/秒），顺序与规定一致。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef truss_element_stiffness(E, A, xi, yi, xj, yj):\n    dx = xj - xi\n    dy = yj - yi\n    L = np.hypot(dx, dy)\n    c = dx / L\n    s = dy / L\n    k = E * A / L\n    # 4x4 stiffness in [ux_i, uy_i, ux_j, uy_j]\n    ke = k * np.array([\n        [ c*c,  c*s, -c*c, -c*s],\n        [ c*s,  s*s, -c*s, -s*s],\n        [-c*c, -c*s,  c*c,  c*s],\n        [-c*s, -s*s,  c*s,  s*s]\n    ], dtype=float)\n    return ke, L\n\ndef assemble_cell_matrices(a, E, A, rho):\n    # Node coordinates: 0:(0,0), 1:(a,0), 2:(0,a), 3:(a,a)\n    coords = np.array([\n        [0.0, 0.0],\n        [a,   0.0],\n        [0.0, a],\n        [a,   a]\n    ], dtype=float)\n    # Elements: (node_i, node_j)\n    elements = [\n        (0, 1),  # bottom edge (horizontal)\n        (2, 3),  # top edge (horizontal)\n        (0, 2),  # left edge (vertical)\n        (1, 3)   # right edge (vertical)\n    ]\n    ndof = 4 * 2\n    K = np.zeros((ndof, ndof), dtype=float)\n    M = np.zeros((ndof, ndof), dtype=float)\n    for (ni, nj) in elements:\n        xi, yi = coords[ni]\n        xj, yj = coords[nj]\n        ke, L = truss_element_stiffness(E, A, xi, yi, xj, yj)\n        # DOF indices\n        dofs = np.array([2*ni, 2*ni+1, 2*nj, 2*nj+1], dtype=int)\n        # Assemble stiffness\n        for a_i in range(4):\n            for b_i in range(4):\n                K[dofs[a_i], dofs[b_i]] += ke[a_i, b_i]\n        # Lumped mass: m_e/2 to each node, duplicated on ux and uy\n        me = rho * A * L\n        M[2*ni,   2*ni]   += 0.5 * me\n        M[2*ni+1, 2*ni+1] += 0.5 * me\n        M[2*nj,   2*nj]   += 0.5 * me\n        M[2*nj+1, 2*nj+1] += 0.5 * me\n    return K, M\n\ndef bloch_transform(a, kx, ky):\n    # Phase factors at nodes 0:(0,0), 1:(a,0), 2:(0,a), 3:(a,a)\n    phi0 = 1.0 + 0.0j\n    phi1 = np.exp(1j * kx * a)\n    phi2 = np.exp(1j * ky * a)\n    phi3 = np.exp(1j * (kx + ky) * a)\n    phis = [phi0, phi1, phi2, phi3]\n    # Build 8x2 transformation: column 0 for ux, column 1 for uy\n    T = np.zeros((8, 2), dtype=complex)\n    for n in range(4):\n        T[2*n, 0] = phis[n]     # ux at node n\n        T[2*n+1, 1] = phis[n]   # uy at node n\n    return T\n\ndef fe_bloch_frequencies(a, E, A, rho, kx, ky):\n    # Assemble cell matrices\n    K, M = assemble_cell_matrices(a, E, A, rho)\n    # Bloch transform\n    T = bloch_transform(a, kx, ky)\n    # Reduced matrices\n    KB = T.conj().T @ K @ T\n    MB = T.conj().T @ M @ T\n    # Hermitian symmetrize to remove tiny numerical asymmetries\n    KB = 0.5 * (KB + KB.conj().T)\n    MB = 0.5 * (MB + MB.conj().T)\n    # Solve generalized Hermitian eigenproblem\n    # eigh returns eigenvalues in ascending order\n    vals, _ = eigh(KB, MB)\n    # Numerical clean-up: small negative values to zero\n    vals = np.real(vals)\n    vals[vals  0] = 0.0\n    omegas = np.sqrt(vals)\n    # Sort ascending\n    omegas.sort()\n    return omegas  # length 2\n\ndef analytical_frequencies(a, E, A, rho, kx, ky):\n    k = E * A / a\n    me = rho * A * a\n    wx2 = (k / me) * (1.0 - np.cos(kx * a))\n    wy2 = (k / me) * (1.0 - np.cos(ky * a))\n    wx = np.sqrt(max(wx2, 0.0))\n    wy = np.sqrt(max(wy2, 0.0))\n    omegas = np.array([wx, wy], dtype=float)\n    omegas.sort()\n    return omegas\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (a, E, A, rho, kx, ky)\n    test_cases = [\n        (0.10, 70.0e9, 1.0e-6, 2700.0, 0.0, 0.0),\n        (0.20, 200.0e9, 5.0e-6, 7800.0, np.pi/0.20, 0.0),\n        (0.30, 3.0e9, 2.0e-4, 1200.0, np.pi/0.30, np.pi/0.30),\n        (0.05, 2.0e11, 1.0e-8, 8000.0, 1.0e-3/0.05, 0.0),\n        (0.12, 210.0e9, 3.0e-6, 7850.0, np.pi/(2*0.12), np.pi/(3*0.12)),\n    ]\n\n    results = []\n    for a, E, A, rho, kx, ky in test_cases:\n        fe_omegas = fe_bloch_frequencies(a, E, A, rho, kx, ky)\n        an_omegas = analytical_frequencies(a, E, A, rho, kx, ky)\n        # Max absolute difference across two branches\n        err = float(np.max(np.abs(fe_omegas - an_omegas)))\n        results.append(f\"{err:.6e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2901730"}]}