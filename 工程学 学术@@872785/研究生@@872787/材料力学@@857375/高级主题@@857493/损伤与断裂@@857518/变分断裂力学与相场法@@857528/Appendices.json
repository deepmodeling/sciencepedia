{"hands_on_practices": [{"introduction": "相场方法的核心思想是用一个平滑的场变量来近似尖锐的裂纹。这个练习将带你通过变分法，推导出最基本的相场裂纹形态。通过求解给定泛函的欧拉-拉格朗日方程，你将亲自得到在无外部载荷下一维裂纹的特征指数剖面 [@problem_id:2929068]，这是理解相场断裂模型数学结构和行为的基石。", "problem": "考虑一个位于无限弹性体原点的单一尖锐裂纹在一维稳态相场中的表示，该弹性体不受弹性驱动力作用。设裂纹相场由 $d(x)$ 表示，其中 $x \\in \\mathbb{R}$，且 $d(x) \\in [0,1]$，$d(x)=1$ 表示完全断裂，$d(x)=0$ 表示材料完好。在所谓的 Ambrosio–Tortorelli (AT2) 模型中，正则化的裂纹表面密度以归一化形式表示为以下泛函\n$$\n\\Gamma_{\\ell}^{+}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\n其中 $\\ell0$ 是控制弥散裂纹区宽度的内禀长度尺度参数。假设具有物理动机的边界条件为 $d(0)=1$（裂纹尖端位于原点）和 $\\lim_{x\\to\\infty} d(x)=0$（远场完好）。对应于裂纹两个面的总裂纹表面测度由 $S_\\ell[d] \\coloneqq 2\\,\\Gamma_{\\ell}^{+}[d]$ 建模。\n\n仅使用变分法的第一性原理（欧拉-拉格朗日方程和容许边界条件），执行以下操作：\n\n- 推导在 $x\\in(0,\\infty)$ 上与 $\\Gamma_{\\ell}^{+}[d]$ 相关的 $d(x)$ 的稳态条件，并求解所得的常微分方程，其需满足边界条件 $d(0)=1$ 和 $\\lim_{x\\to\\infty} d(x)=0$。\n- 计算下式的精确值\n$$\nS_\\ell[d^{\\star}] \\;=\\; 2\\,\\Gamma_{\\ell}^{+}[d^{\\star}] \\;=\\; 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d^{\\star}(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d^{\\star}{}'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\n其中 $d^{\\star}$ 表示您所求得的稳态（最小化）分布。\n\n将最终答案表示为一个精确的数字。无需四舍五入。根据其构造，$S_\\ell[d^{\\star}]$ 是无量纲的，因此不需要单位。", "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 对于 $x0$，正则化的裂纹表面密度泛函由下式给出：\n$$\n\\Gamma_{\\ell}^{+}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x\n$$\n- 相场变量为 $d(x)$，其中 $d(x) \\in [0,1]$。\n- 内禀长度尺度为 $\\ell  0$。\n- 积分域为 $x \\in [0, \\infty)$。\n- 边界条件为 $d(0)=1$ 和 $\\lim_{x\\to\\infty} d(x)=0$。\n- 总裂纹表面测度为 $S_\\ell[d] \\coloneqq 2\\,\\Gamma_{\\ell}^{+}[d]$。\n- 目标是找到稳态分布 $d^{\\star}(x)$ 并计算 $S_\\ell[d^{\\star}]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用了 Ambrosio–Tortorelli (AT2) 模型，这是断裂相场理论中一个基础且被广泛接受的框架。它是尖锐界面裂纹问题的标准正则化方法。该泛函在数学上和物理上都是合理的。\n- **适定性：** 该问题是适定的。这是一个经典的变分法问题：在明确定义的边界条件下最小化一个凸泛函。这类问题通常有唯一且稳定的解。\n- **客观性：** 问题陈述使用了精确的数学语言，所有术语都有明确的定义。\n- **结论：** 该问题具有科学有效性、适定性、客观性和完整性。这是变分力学中的一个标准练习，没有任何缺陷。\n\n**步骤 3：进行求解**\n该问题要求找到使泛函 $\\Gamma_{\\ell}^{+}[d]$ 最小化的稳态路径 $d^{\\star}(x)$，然后计算总裂纹表面测度 $S_\\ell[d^{\\star}]$。这可以通过使用欧拉-拉格朗日方程来完成。\n\n泛函的被积函数是\n$$\nL(d, d') = \\frac{1}{2\\,\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}\n$$\n其中 $d' \\equiv \\frac{\\mathrm{d}d}{\\mathrm{d}x}$。提供稳态条件的欧拉-拉格朗日方程为\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0\n$$\n我们计算 $L$ 所需的偏导数：\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{1}{2\\,\\ell}\\,(2d) = \\frac{d}{\\ell}\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\frac{\\ell}{2}\\,(2d') = \\ell\\,d'\n$$\n将这些表达式代入欧拉-拉格朗日方程，得到：\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\ell\\,d'\\right) = 0\n$$\n$$\n\\frac{d}{\\ell} - \\ell\\,d'' = 0\n$$\n整理后得到一个二阶线性齐次常系数常微分方程：\n$$\nd'' - \\frac{1}{\\ell^2}\\,d = 0\n$$\n该常微分方程的特征方程是 $r^2 - \\frac{1}{\\ell^2} = 0$。其根为 $r_{1,2} = \\pm\\frac{1}{\\ell}$。因此，通解为\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n其中 $C_1$ 和 $C_2$ 是待定常数，由边界条件确定。\n\n第一个边界条件是 $\\lim_{x\\to\\infty} d(x) = 0$。当 $x \\to \\infty$ 时，项 $\\exp\\left(\\frac{x}{\\ell}\\right)$ 无界增长。为了使 $d(x)$ 的极限为零，其系数必须为零。因此，我们必须有 $C_1 = 0$。解简化为\n$$\nd(x) = C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n第二个边界条件是 $d(0)=1$。应用此条件可得：\n$$\nd(0) = C_2 \\exp(0) = C_2 \\cdot 1 = C_2\n$$\n因此，$C_2 = 1$。满足边界条件的唯一稳态分布 $d^{\\star}(x)$ 是\n$$\nd^{\\star}(x) = \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n现在，我们必须计算总裂纹表面测度 $S_\\ell[d^{\\star}]$：\n$$\nS_\\ell[d^{\\star}] = 2\\,\\Gamma_{\\ell}^{+}[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,(d^{\\star}(x))^{2} + \\frac{\\ell}{2}\\,\\big(d^{\\star}{}'(x)\\big)^{2} \\right)\\,\\mathrm{d}x\n$$\n我们需要 $(d^{\\star}(x))^2$ 和 $(d^{\\star}{}'(x))^2$ 这两项。首先，我们计算导数 $d^{\\star}{}'(x)$：\n$$\nd^{\\star}{}'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right) = -\\frac{1}{\\ell}\\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n现在我们将 $d^{\\star}(x)$ 和 $d^{\\star}{}'(x)$ 两项平方：\n$$\n(d^{\\star}(x))^2 = \\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right)^2 = \\exp\\left(-\\frac{2x}{\\ell}\\right)\n$$\n$$\n(d^{\\star}{}'(x))^2 = \\left(-\\frac{1}{\\ell}\\exp\\left(-\\frac{x}{\\ell}\\right)\\right)^2 = \\frac{1}{\\ell^2}\\exp\\left(-\\frac{2x}{\\ell}\\right)\n$$\n将这些代入 $S_\\ell[d^{\\star}]$ 的积分中：\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) + \\frac{\\ell}{2}\\,\\frac{1}{\\ell^2}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right)\\,\\mathrm{d}x\n$$\n简化被积函数：\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) + \\frac{1}{2\\,\\ell}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right)\\,\\mathrm{d}x\n$$\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x\n$$\n我们可以将常数因子 $\\frac{2}{\\ell}$ 移到积分外：\n$$\nS_\\ell[d^{\\star}] = \\frac{2}{\\ell} \\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x\n$$\n现在我们计算定积分：\n$$\n\\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x = \\left[ -\\frac{\\ell}{2}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right]_{0}^{\\infty}\n$$\n$$\n= \\lim_{x\\to\\infty}\\left(-\\frac{\\ell}{2}\\exp\\left(-\\frac{2x}{\\ell}\\right)\\right) - \\left(-\\frac{\\ell}{2}\\exp(0)\\right)\n$$\n$$\n= 0 - \\left(-\\frac{\\ell}{2}\\right) = \\frac{\\ell}{2}\n$$\n最后，将此结果代回 $S_\\ell[d^{\\star}]$ 的表达式中：\n$$\nS_\\ell[d^{\\star}] = \\frac{2}{\\ell} \\cdot \\left(\\frac{\\ell}{2}\\right) = 1\n$$\n对于最优分布，正则化表面能的值恰好为 $1$，这与长度尺度参数 $\\ell$ 无关。这是一个基本结果，表明 Ambrosio–Tortorelli 泛函能正确地逼近尖锐裂纹的表面能，在本问题设置中，该表面能被归一化为 $1$（对应于单位能量的单个裂纹面）。总测度 $S_\\ell[d^\\star]$ 考虑了两个裂纹面，但积分是在 $x \\in (0,\\infty)$ 上进行的，代表对称裂纹的一侧。公式 $S_\\ell[d] = 2\\,\\Gamma_{\\ell}^{+}[d]$ 正确地捕捉了这一点，最终结果 $1$ 代表了单个（对称的）裂纹的总能量。计算和理解均正确。", "answer": "$$\\boxed{1}$$", "id": "2929068"}, {"introduction": "相场模型不仅是数学工具，更能预测材料的宏观力学性能。本练习旨在建立理论模型与材料强度这一关键工程参数之间的桥梁。你将通过分析材料在拉伸载荷下无损状态的能量稳定性，来确定损伤萌生的临界条件，并由此推导出预测材料拉伸强度的解析表达式 [@problem_id:2929086]。这个过程清晰地展示了如何利用断裂韧度 $G_c$ 等基本参数来预测材料的宏观行为。", "problem": "考虑一根长度为 $L$、单位横截面积的一维细杆，该细杆由线性弹性脆性材料制成，承受均匀拉伸载荷，使得在小应变极限下，轴向格林-拉格朗日应变可等同于工程应变 $ \\varepsilon $。其弹性应变能密度为 $ \\psi_{e}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2} $，其中 $E$ 是杨氏模量。该材料通过 Ambrosio–Tortorelli 类型 (AT1) 的脆性断裂变分相场公式进行建模，其中损伤变量为 $ d \\in [0,1] $，退化函数为 $ g(d) = (1-d)^{2} $，裂纹表面密度泛函由 Griffith 临界能量释放率 $ G_{c} $ 和正则化长度 $ \\ell $ 表征。单位横截面积的总能量为\n$$\n\\Psi[d;\\varepsilon] \\,=\\, \\int_{0}^{L} \\left[ g(d)\\,\\psi_{e}(\\varepsilon) \\;+\\; G_{c}\\left( \\frac{d}{\\ell} \\;+\\; \\frac{\\ell}{2}\\,(d')^{2} \\right) \\right] \\,\\mathrm{d}x.\n$$\n假设 $ L \\gg \\ell $，因此边界层可以忽略不计，并分析未损伤状态的均匀扰动。在单边损伤不可逆约束 $ d \\ge 0 $ 下，使用变分稳定性的第一性原理，确定未损伤状态 $ d=0 $ 因无穷小均匀损伤扰动而失去局部极小性时的临界轴向柯西应力 $ \\sigma_{c} $ 的显式表达式。对于一维小应变弹性，您可以使用 $ \\sigma = E \\varepsilon $。\n\n然后，对于 $ E = 50\\ \\mathrm{GPa} $、$ G_{c} = 2.4\\ \\mathrm{kJ/m^{2}} $ 和 $ \\ell = 0.30\\ \\mathrm{mm} $，对 $ \\sigma_{c} $ 进行数值计算。以 $ \\mathrm{MPa} $ 为单位表示您的最终应力，并将答案四舍五入到四位有效数字。", "solution": "该问题要求确定一维杆中损伤起始的临界应力，该杆使用脆性断裂的相场方法进行建模。分析将在均匀损伤扰动的假设下进行。\n\n系统的单位横截面积总能量由以下泛函给出：\n$$\n\\Psi[d;\\varepsilon] \\,=\\, \\int_{0}^{L} \\left[ g(d)\\,\\psi_{e}(\\varepsilon) \\;+\\; G_{c}\\left( \\frac{d}{\\ell} \\;+\\; \\frac{\\ell}{2}\\,(d')^{2} \\right) \\right] \\,\\mathrm{d}x\n$$\n所给出的本构关系为弹性应变能密度 $\\psi_{e}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2}$ 和退化函数 $g(d) = (1-d)^{2}$。问题指定分析未损伤状态 $d=0$ 的均匀扰动。一个均匀场 $d(x)$ 在空间上是常数，即 $d(x) = \\delta$（其中 $\\delta$ 为某个常数）。因此，其导数项为零，即 $d'(x) = 0$。\n\n在此简化下，被积函数沿杆的长度 $L$ 变为常数。我们可以为均匀应变 $\\varepsilon$ 和均匀损伤 $\\delta$ 的状态定义一个有效能量密度 $\\Phi$（单位体积的能量）：\n$$\n\\Phi(\\delta; \\varepsilon) = g(\\delta)\\psi_e(\\varepsilon) + G_c \\frac{\\delta}{\\ell}\n$$\n代入 $g(d)$ 和 $\\psi_e(\\varepsilon)$ 的给定形式，可得：\n$$\n\\Phi(\\delta; \\varepsilon) = (1-\\delta)^{2} \\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + G_c \\frac{\\delta}{\\ell}\n$$\n未损伤状态对应于 $\\delta=0$。我们必须研究该状态的稳定性。在变分法中，如果对于任何容许的无穷小扰动，能量都会增加，那么该状态就是一个局部极小值。在这里，损伤变量受到单边不可逆约束 $d \\ge 0$ 的限制，对于我们的均匀分析，这意味着 $\\delta \\ge 0$。\n\n为了使状态 $\\delta=0$ 成为局部极小值，能量相对于容许扰动的一阶变分必须为非负。容许的扰动形式为 $\\delta  0$。这要求 $\\Phi$ 在 $\\delta=0$ 处关于 $\\delta$ 的方向导数是非负的。我们计算 $\\Phi$ 关于 $\\delta$ 的一阶导数：\n$$\n\\frac{\\partial \\Phi}{\\partial \\delta} = -2(1-\\delta) \\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + \\frac{G_c}{\\ell} = -(1-\\delta)E \\varepsilon^{2} + \\frac{G_c}{\\ell}\n$$\n在未损伤状态 $\\delta=0$ 处计算该式：\n$$\n\\left. \\frac{\\partial \\Phi}{\\partial \\delta} \\right|_{\\delta=0} = -E \\varepsilon^{2} + \\frac{G_c}{\\ell}\n$$\n因此，状态 $\\delta=0$ 的局部稳定性条件是：\n$$\n\\left. \\frac{\\partial \\Phi}{\\partial \\delta} \\right|_{\\delta=0} \\ge 0 \\quad \\implies \\quad -E \\varepsilon^{2} + \\frac{G_c}{\\ell} \\ge 0\n$$\n这简化为：\n$$\n\\psi_e(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2} \\le \\frac{G_c}{2\\ell}\n$$\n当此条件首次被违反时，未损伤状态 $d=0$ 失去其局部极小性。因此，临界点由等式定义，该等式代表了损伤驱动力与阻力精确平衡的阈值。\n$$\n\\psi_{e,c} = \\frac{G_c}{2\\ell}\n$$\n其中 $\\psi_{e,c}$ 是损伤开始时材料中储存的临界弹性应变能密度。\n\n为了找到临界应力 $\\sigma_c$，我们将弹性应变能密度 $\\psi_e$ 与柯西应力 $\\sigma$ 联系起来。对于一维线性弹性，有 $\\sigma = E\\varepsilon$，这意味着 $\\varepsilon = \\sigma/E$。将此代入 $\\psi_e$ 的表达式中：\n$$\n\\psi_e(\\sigma) = \\frac{1}{2}E \\left(\\frac{\\sigma}{E}\\right)^2 = \\frac{\\sigma^2}{2E}\n$$\n在临界条件下，我们有 $\\psi_e(\\sigma_c) = \\psi_{e,c}$：\n$$\n\\frac{\\sigma_c^2}{2E} = \\frac{G_c}{2\\ell}\n$$\n解出临界应力 $\\sigma_c$ 得到其解析表达式：\n$$\n\\sigma_c^2 = \\frac{E G_c}{\\ell} \\quad \\implies \\quad \\sigma_c = \\sqrt{\\frac{E G_c}{\\ell}}\n$$\n这就是所要求的临界应力的显式表达式。\n\n现在，我们用所提供的数据对该表达式进行数值计算。参数必须首先转换为国际单位制（SI）基本单位。\n杨氏模量：$E = 50\\ \\mathrm{GPa} = 50 \\times 10^9\\ \\mathrm{Pa}$。\nGriffith 临界能量释放率：$G_c = 2.4\\ \\mathrm{kJ/m^2} = 2.4 \\times 10^3\\ \\mathrm{J/m^2}$。\n正则化长度：$\\ell = 0.30\\ \\mathrm{mm} = 0.30 \\times 10^{-3}\\ \\mathrm{m}$。\n\n将这些值代入 $\\sigma_c$ 的表达式中：\n$$\n\\sigma_c = \\sqrt{\\frac{(50 \\times 10^9\\ \\mathrm{Pa}) \\cdot (2.4 \\times 10^3\\ \\mathrm{J/m^2})}{0.30 \\times 10^{-3}\\ \\mathrm{m}}}\n$$\n单位是一致的，因为 $(\\mathrm{Pa} \\cdot \\mathrm{J/m^2}) / \\mathrm{m} = (\\mathrm{N/m^2} \\cdot \\mathrm{N\\cdot m/m^2}) / \\mathrm{m} = (\\mathrm{N/m^2} \\cdot \\mathrm{N/m}) / \\mathrm{m} = \\mathrm{N^2/m^4} = \\mathrm{Pa^2}$。\n$$\n\\sigma_c = \\sqrt{\\frac{120 \\times 10^{12}}{0.30 \\times 10^{-3}}} \\ \\mathrm{Pa} = \\sqrt{400 \\times 10^{15}}\\ \\mathrm{Pa} = \\sqrt{4 \\times 10^{17}}\\ \\mathrm{Pa}\n$$\n$$\n\\sigma_c = 2 \\sqrt{10^{17}}\\ \\mathrm{Pa} = 2 \\sqrt{10 \\times 10^{16}}\\ \\mathrm{Pa} = 2 \\sqrt{10} \\times 10^8\\ \\mathrm{Pa}\n$$\n使用数值 $\\sqrt{10} \\approx 3.16227766$：\n$$\n\\sigma_c \\approx 2 \\times 3.16227766 \\times 10^8\\ \\mathrm{Pa} \\approx 6.32455532 \\times 10^8\\ \\mathrm{Pa}\n$$\n问题要求答案以兆帕（$\\mathrm{MPa}$）为单位，其中 $1\\ \\mathrm{MPa} = 10^6\\ \\mathrm{Pa}$。\n$$\n\\sigma_c \\approx 632.455532\\ \\mathrm{MPa}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\sigma_c = 632.5\\ \\mathrm{MPa}\n$$", "answer": "$$\n\\boxed{632.5}\n$$", "id": "2929086"}, {"introduction": "解析解为我们提供了深刻的洞察，但实际工程问题往往需要数值方法求解。本练习将引导你从解析理论迈向计算实践。你将编写程序，使用有限差分和数值积分等方法来计算一维裂纹剖面的能量，并分析网格密度和计算域大小等离散化参数对计算结果精度的影响 [@problem_id:2929057]。这项实践对于培养数值计算直觉、理解相场模型在计算机中如何工作以及网格分辨率的重要性至关重要。", "problem": "考虑在区域 $x \\in [-L,L]$ 上的一个一维静态裂纹，由标量相场变量 $d(x)$ 表示。在使用二阶Ambrosio-Tortorelli (AT2) 正则化的脆性断裂变分相场框架中，与相场分布 $d(x)$ 相关的断裂表面能由以下泛函建模\n$$\n\\Psi[d] \\;=\\; G_c \\int_{-L}^{L} \\left( \\frac{1}{2\\ell}\\, d(x)^2 \\;+\\; \\frac{\\ell}{2}\\, \\left(\\frac{d\\,d}{dx}\\right)^{\\!2} \\right)\\,dx,\n$$\n其中 $G_c$ 是临界能量释放率 (I型断裂韧性)，$\\ell$ 是控制弥散裂纹宽度的内禀长度尺度。假设一个在 $x=0$ 处居中的完全发展的静态裂纹，其相场满足 $d(0)=1$ 和 $d(\\pm L)\\approx 0$，并且 $d(x)$ 是关于 $x=0$ 非负且对称的。\n\n从变分法出发，静态裂纹分布在所述对称性和边界条件下最小化 $\\Psi[d]$。您的任务是：\n- 推导 $d(x)$ 的控制性欧拉-拉格朗日方程及其在 $(-\\infty,\\infty)$ 上的相应最小化分布。\n- 使用此最小化分布来计算在有限区间 $[-L,L]$ 上归一化断裂能的离散近似值，\n$$\n\\mathcal{E}_\\text{norm} \\;=\\; \\frac{1}{G_c}\\,\\Psi[d],\n$$\n\n程序的数值要求：\n- 在 $[-L,L]$ 上使用均匀网格，间距为 $h$，使得区间数量为整数，即 $N = \\frac{2L}{h} \\in \\mathbb{N}$。如有必要，调整 $h$ 为 $h_\\text{eff}=\\frac{2L}{N}$，其中 $N=\\text{round}\\!\\left(\\frac{2L}{h}\\right)$，以确保精确覆盖该区间。\n- 在网格节点处评估最小化分布 $d(x)$。\n- 使用有限差分在节点处近似空间导数 $\\frac{d\\,d}{dx}$：对内部节点使用中心差分，对边界节点使用单边差分。\n- 使用复合梯形法则在网格上近似 $\\Psi[d]$ 中的积分。\n- 报告下面每个测试用例的归一化能量 $\\mathcal{E}_\\text{norm}$。\n\n物理单位：\n- 使用 $G_c$ 单位为 $\\mathrm{J/m}$，$\\ell$ 和 $L$ 单位为 $\\mathrm{m}$， $h$ 单位为 $\\mathrm{m}$。因为您必须报告归一化能量 $\\mathcal{E}_\\text{norm}=\\Psi[d]/G_c$，最终答案是无量纲的。\n\n本问题不涉及角度单位。\n\n测试组：\n- 用例 A: $G_c = 2.7$, $\\ell = 0.01$, $L = 0.10$, $h = 0.001$.\n- 用例 B: $G_c = 2.7$, $\\ell = 0.01$, $L = 0.005$, $h = 0.0005$.\n- 用例 C: $G_c = 2.7$, $\\ell = 0.02$, $L = 0.20$, $h = 0.02$.\n- 用例 D: $G_c = 2.7$, $\\ell = 0.005$, $L = 0.05$, $h = 0.001$.\n\n覆盖性设计：\n- 用例 A 探讨相对于 $\\ell$ 域较大且解析良好的裂纹。\n- 用例 B 测试由于域相对于 $\\ell$ 较小而产生的截断效应。\n- 用例 C 测试 $h$ 与 $\\ell$ 相当的粗网格分辨率。\n- 用例 D 测试相对于 $\\ell$ 域较大且分辨率适中的情况。\n\n您的程序必须生成单行输出，其中包含四个结果，形式为方括号括起来的逗号分隔列表，每个数字四舍五入到六位小数，例如：\n\"[1.000000,0.950000,0.990000,1.000000]\"\n\n您的程序必须是完全自包含的，并且不得需要任何用户输入或外部文件。结果是无量纲的浮点数。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于变分断裂力学的原理，在数学上是适定的，并为其求解提供了一套完整而明确的数据和指令。任务是推导给定Ambrosio-Tortorelli能量泛函的静态裂纹分布，然后对指定参数进行数值计算归一化能量。该过程并非无足轻重，需要解析推导和数值实现，使其成为一个实质性问题。\n\n分析分为两个阶段：首先，最优相场分布的解析推导；其次，其近似的数值方案描述。\n\n断裂表面能由以下泛函给出：\n$$\n\\Psi[d] \\;=\\; G_c \\int_{-L}^{L} \\left( \\frac{1}{2\\ell}\\, d(x)^2 \\;+\\; \\frac{\\ell}{2}\\, \\left(\\frac{d\\,d}{dx}\\right)^{\\!2} \\right)\\,dx\n$$\n我们寻求找到使该泛函最小化的函数 $d(x)$。被积函数，$\\mathcal{L}(d, d') = G_c \\left( \\frac{1}{2\\ell}\\, d(x)^2 + \\frac{\\ell}{2}\\, (d'(x))^2 \\right)$，其中 $d' = \\frac{d\\,d}{dx}$，是拉格朗日密度。最小化函数必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} - \\frac{d}{dx} \\left( \\frac{\\partial \\mathcal{L}}{\\partial d'} \\right) = 0\n$$\n首先，我们计算拉格朗日量 $\\mathcal{L}$ 的偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} = G_c \\left( \\frac{1}{2\\ell} \\cdot 2d \\right) = G_c \\frac{d}{\\ell}\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d'} = G_c \\left( \\frac{\\ell}{2} \\cdot 2d' \\right) = G_c \\ell d'\n$$\n将这些代入欧拉-拉格朗日方程得出：\n$$\nG_c \\frac{d}{\\ell} - \\frac{d}{dx} \\left( G_c \\ell d' \\right) = 0\n$$\n由于 $G_c$ 和 $\\ell$ 是非零常数，我们可以通过除以 $G_c$ 来简化方程：\n$$\n\\frac{d}{\\ell} - \\ell d'' = 0\n$$\n重新整理得到二阶齐次线性常微分方程：\n$$\nd''(x) - \\frac{1}{\\ell^2} d(x) = 0\n$$\n问题要求在无限域 $(-\\infty, \\infty)$ 上的分布是对称的，满足 $d(0)=1$，并且在无穷远处消失，即当 $|x| \\to \\infty$ 时 $d(x) \\to 0$。为了找到这样的解，由于对称性，我们考虑域 $x \\ge 0$。该常微分方程的通解是 $d(x) = C_1 e^{x/\\ell} + C_2 e^{-x/\\ell}$。\n在 $[0, \\infty)$ 上的边界条件是：\n1. $d(0) = 1$\n2. $\\lim_{x\\to\\infty} d(x) = 0$\n\n根据第二个条件，当 $x \\to \\infty$ 时，项 $e^{x/\\ell}$ 无界增长。为确保极限为零，其系数 $C_1$ 必须为零。因此，解的形式简化为 $d(x) = C_2 e^{-x/\\ell}$。\n应用第一个条件于 $x=0$：\n$$\nd(0) = C_2 e^0 = C_2 = 1\n$$\n所以，对于 $x \\ge 0$，解是 $d(x) = e^{-x/\\ell}$。根据对称性要求 $d(x) = d(-x)$，在所有 $x \\in (-\\infty, \\infty)$ 上的解是：\n$$\nd(x) = e^{-|x|/\\ell}\n$$\n这是最优的一维裂纹分布。注意，该函数在 $x=0$ 处的一阶导数不连续，因此，它是欧拉-拉格朗日方程的一个弱解。\n\n为完整起见，我们可以验证这个在无限域上的理想分布产生的总断裂能为 $G_c$，意味着归一化能量为1。当 $x \\neq 0$ 时，导数为 $d'(x) = -\\frac{1}{\\ell} \\text{sgn}(x) e^{-|x|/\\ell}$。其平方为 $(d'(x))^2 = \\frac{1}{\\ell^2} e^{-2|x|/\\ell}$。\n在 $(-\\infty, \\infty)$ 上的归一化能量为：\n$$\n\\mathcal{E}_\\text{norm} = \\frac{1}{G_c} \\Psi[d] = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2\\ell} (e^{-|x|/\\ell})^2 + \\frac{\\ell}{2} \\left(-\\frac{\\text{sgn}(x)}{\\ell} e^{-|x|/\\ell}\\right)^2 \\right) dx\n$$\n$$\n\\mathcal{E}_\\text{norm} = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2\\ell} e^{-2|x|/\\ell} + \\frac{\\ell}{2\\ell^2} e^{-2|x|/\\ell} \\right) dx = \\int_{-\\infty}^{\\infty} \\frac{1}{\\ell} e^{-2|x|/\\ell} dx\n$$\n利用对称性，这变为：\n$$\n\\mathcal{E}_\\text{norm} = 2 \\int_{0}^{\\infty} \\frac{1}{\\ell} e^{-2x/\\ell} dx = 2 \\left[ -\\frac{1}{2} e^{-2x/\\ell} \\right]_{0}^{\\infty} = 2 \\left( 0 - \\left(-\\frac{1}{2}\\right) \\right) = 1\n$$\n这证实了解析解是正确的。数值任务是使用数值近似在有限域 $[-L, L]$ 上评估该能量。\n\n每个测试用例的数值实现遵循以下步骤：\n1.  **区域离散化**：区间 $[-L, L]$ 被离散为 $N$ 个子区间，其中 $N = \\text{round}(2L/h)$。有效网格间距为 $h_\\text{eff} = \\frac{2L}{N}$。网格点为 $x_i = -L + i \\cdot h_\\text{eff}$，其中 $i=0, 1, \\dots, N$。\n2.  **评估分布**：在每个网格点 $x_i$ 处评估解析解 $d(x) = e^{-|x|/\\ell}$，以获得离散值 $d_i = d(x_i)$。\n3.  **近似导数**：在每个节点 $x_i$ 处近似导数 $d'(x)$ 以获得值 $d'_i$。\n    -   在左边界（$i=0$）：使用一阶向前差分：$d'_0 = \\frac{d_1 - d_0}{h_\\text{eff}}$。\n    -   在内部节点（$i=1, \\dots, N-1$）：使用二阶中心差分：$d'_i = \\frac{d_{i+1} - d_{i-1}}{2 h_\\text{eff}}$。\n    -   在右边界（$i=N$）：使用一阶向后差分：$d'_N = \\frac{d_N - d_{N-1}}{h_\\text{eff}}$。\n4.  **计算积分**：通过使用复合梯形法则近似积分来计算归一化能量 $\\mathcal{E}_\\text{norm}$。被积函数为 $f(x) = \\frac{1}{2\\ell} d(x)^2 + \\frac{\\ell}{2} (d'(x))^2$。在每个节点计算被积函数的离散值 $f_i = \\frac{1}{2\\ell} d_i^2 + \\frac{\\ell}{2} (d'_i)^2$。然后积分近似为：\n$$\n\\mathcal{E}_\\text{norm} = \\int_{-L}^{L} f(x) dx \\approx \\sum_{i=0}^{N-1} \\frac{f_i + f_{i+1}}{2} h_\\text{eff}\n$$\n对每个测试用例将实施此过程，以产生所需的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_normalized_energy(l: float, L: float, h: float) -> float:\n    \"\"\"\n    Computes the discrete approximation of the normalized fracture energy.\n\n    Args:\n        l: The internal length scale.\n        L: The half-width of the domain [-L, L].\n        h: The initial mesh spacing.\n\n    Returns:\n        The computed normalized energy, a unitless float.\n    \"\"\"\n    # Step 1: Mesh Generation\n    # Adjust h to ensure the number of intervals is an integer and covers the domain exactly.\n    if 2 * L == 0:\n        return 0.0\n    num_intervals = round(2 * L / h)\n    \n    # Handle edge case where num_intervals could be zero for very coarse h.\n    if num_intervals == 0:\n        num_intervals = 1\n        \n    h_eff = 2 * L / num_intervals\n    num_points = num_intervals + 1\n    x = np.linspace(-L, L, num_points)\n\n    # Step 2: Evaluate the minimizing profile d(x) = exp(-|x|/l)\n    d = np.exp(-np.abs(x) / l)\n\n    # Step 3: Approximate the spatial derivative d'(x) using finite differences\n    dd_dx = np.zeros_like(x)\n\n    if num_points > 1:\n        # Central difference for interior nodes\n        if num_points > 2:\n            dd_dx[1:-1] = (d[2:] - d[:-2]) / (2 * h_eff)\n        \n        # One-sided forward difference for the left boundary node\n        dd_dx[0] = (d[1] - d[0]) / h_eff\n        \n        # One-sided backward difference for the right boundary node\n        dd_dx[-1] = (d[-1] - d[-2]) / h_eff\n    \n    # Step 4: Evaluate the integrand of the normalized energy functional\n    # Integrand = (1/(2l)) * d^2 + (l/2) * (d')^2\n    integrand = (d**2 / (2 * l)) + (l / 2) * (dd_dx**2)\n\n    # Step 5: Approximate the integral using the composite trapezoidal rule\n    E_norm = np.trapz(integrand, x)\n\n    return E_norm\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test cases: (Gc, l, L, h)\n    # Gc is not needed for the normalized energy calculation.\n    test_cases = [\n        # Case A: Gc = 2.7, l = 0.01, L = 0.10, h = 0.001\n        (0.01, 0.10, 0.001), \n        # Case B: Gc = 2.7, l = 0.01, L = 0.005, h = 0.0005\n        (0.01, 0.005, 0.0005),\n        # Case C: Gc = 2.7, l = 0.02, L = 0.20, h = 0.02\n        (0.02, 0.20, 0.02),\n        # Case D: Gc = 2.7, l = 0.005, L = 0.05, h = 0.001\n        (0.005, 0.05, 0.001)\n    ]\n\n    results = []\n    for case in test_cases:\n        l, L, h = case\n        result = calculate_normalized_energy(l, L, h)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format string \"{:.6f}\" handles rounding to six decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2929057"}]}