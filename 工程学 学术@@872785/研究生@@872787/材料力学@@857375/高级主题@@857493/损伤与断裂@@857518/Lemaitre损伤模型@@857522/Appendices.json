{"hands_on_practices": [{"introduction": "本练习将带你深入勒梅特损伤模型的核心——损伤演化定律。通过从亥姆霍兹自由能出发推导损伤能量释放率 $Y$，并掌握其在数值计算中使用的后向欧拉离散更新格式，你将为理解和应用该模型奠定坚实的基础[@problem_id:2897254]。这是一个将热力学基本原理转化为具体计算步骤的关键实践。", "problem": "考虑一种服从Lemaitre各向同性损伤模型的金属的小应变各向同性弹塑性行为。设标量损伤变量为 $D \\in [0,1)$，并采用应变等效假设，因此Cauchy应力通过 $\\boldsymbol{\\sigma} = (1-D)\\,\\tilde{\\boldsymbol{\\sigma}}$ 与有效（无损）应力相关联，其中 $\\tilde{\\boldsymbol{\\sigma}} = \\mathbb{C}_0 : \\boldsymbol{\\varepsilon}^e$，$\\mathbb{C}_0$ 为无损弹性刚度。单位参考体积的Helmholtz自由能密度取为\n$$\n\\psi(\\boldsymbol{\\varepsilon}^e,D) = (1-D)\\,\\frac{1}{2}\\,\\boldsymbol{\\varepsilon}^e : \\mathbb{C}_0 : \\boldsymbol{\\varepsilon}^e.\n$$\n定义损伤能量释放率为 $Y := -\\partial \\psi/\\partial D \\big|_{\\boldsymbol{\\varepsilon}^e}$。假设一个与塑性流动耦合的幂律形式的各向同性损伤演化，\n$$\n\\dot{D} = \\left(\\frac{Y}{S}\\right)^{s}\\,\\dot{\\bar{\\varepsilon}}^{p},\n$$\n其中 $S0$ 和 $s0$ 是材料参数，$\\bar{\\varepsilon}^p$ 是累积等效塑性应变。在从 $t_n$ 到 $t_{n+1}$ 的时间步上使用后向欧拉时间积分。\n\n任务：\n1) 从上述定义和应变等效假设出发，推导用有效应力 $\\tilde{\\boldsymbol{\\sigma}}$ 和无损刚度 $\\mathbb{C}_0$ 表示的 $Y$ 的显式表达式。然后将您的结果特化到单轴应力状态，以获得用单轴量表示的 $Y$。\n2) 对区间 $[t_n,t_{n+1}]$ 上的损伤演化法则使用隐式（后向欧拉）时间离散化，推导用 $D_n$、$Y_{n+1}$、$S$、$s$ 和 $\\Delta\\bar{\\varepsilon}^p := \\bar{\\varepsilon}^p_{n+1}-\\bar{\\varepsilon}^p_n$ 表示的 $D_{n+1}$ 的单步更新公式。\n3) 在各向同性von Mises塑性（J2塑性）的单轴返回映射步中，步末的有效（无损）应力大小为 $\\tilde{\\sigma}_{n+1} = 800\\,\\text{MPa}$。给定 $E = 210\\,\\text{GPa}$、$D_n = 0.05000$、$S = 5.000\\,\\text{MPa}$、$s = 1.300$ 和 $\\Delta\\bar{\\varepsilon}^p = 0.01000$，使用您在第 (2) 部分得到的更新公式计算 $D_{n+1}$。明确展示您如何以与更新后应力一致的方式计算 $Y_{n+1}$。将 $D_{n+1}$ 报告为一个无量纲数，并四舍五入到四位有效数字。", "solution": "所述问题具有科学依据、是适定的且内部一致。它描述了在连续介质力学和计算塑性力学框架内Lemaitre损伤模型的标准应用。所有必要的数据和定义都已提供，可得到唯一解。我们继续进行推导和计算。\n\n按要求分三部分解决该问题。\n\n首先，我们推导损伤能量释放率 $Y$ 的表达式。根据定义，$Y$ 是与损伤变量 $D$ 共轭的热力学力，由下式给出\n$$\nY := -\\frac{\\partial \\psi}{\\partial D} \\bigg|_{\\boldsymbol{\\varepsilon}^e}\n$$\nHelmholtz自由能密度由 $\\psi = (1-D)\\,\\frac{1}{2}\\,\\boldsymbol{\\varepsilon}^e : \\mathbb{C}_0 : \\boldsymbol{\\varepsilon}^e$ 给出。在保持弹性应变张量 $\\boldsymbol{\\varepsilon}^e$ 不变的情况下，对 $D$ 求偏导数，得到\n$$\n\\frac{\\partial \\psi}{\\partial D} = -\\frac{1}{2}\\,\\boldsymbol{\\varepsilon}^e : \\mathbb{C}_0 : \\boldsymbol{\\varepsilon}^e\n$$\n因此，损伤能量释放率为\n$$\nY = \\frac{1}{2}\\,\\boldsymbol{\\varepsilon}^e : \\mathbb{C}_0 : \\boldsymbol{\\varepsilon}^e\n$$\n该表达式代表无损材料的弹性应变能密度。为用有效应力 $\\tilde{\\boldsymbol{\\sigma}}$ 表示 $Y$，我们使用有效本构关系 $\\tilde{\\boldsymbol{\\sigma}} = \\mathbb{C}_0 : \\boldsymbol{\\varepsilon}^e$。对此关系求逆可得弹性应变为 $\\boldsymbol{\\varepsilon}^e = \\mathbb{C}_0^{-1} : \\tilde{\\boldsymbol{\\sigma}}$，其中 $\\mathbb{C}_0^{-1}$ 是无损弹性柔度张量。我们也可以将 $Y$ 写为\n$$\nY = \\frac{1}{2}\\,\\boldsymbol{\\varepsilon}^e : \\tilde{\\boldsymbol{\\sigma}}\n$$\n将用 $\\tilde{\\boldsymbol{\\sigma}}$ 表示的 $\\boldsymbol{\\varepsilon}^e$ 的表达式代入，我们得到 $Y$ 的通用表达式：\n$$\nY = \\frac{1}{2}\\,\\tilde{\\boldsymbol{\\sigma}} : \\mathbb{C}_0^{-1} : \\tilde{\\boldsymbol{\\sigma}}\n$$\n对于特化到单轴应力状态的情况，我们考虑有效应力张量只有一个非零分量 $\\tilde{\\sigma}_{11} = \\tilde{\\sigma}$，所有其他分量均为零。对于各向同性材料，相应的弹性应变分量为 $\\varepsilon^e_{11} = \\tilde{\\sigma}/E$，其中 $E$ 是无损杨氏模量。其他非零应变分量为 $\\varepsilon^e_{22} = \\varepsilon^e_{33} = -\\nu \\tilde{\\sigma}/E$，其中 $\\nu$ 是泊松比。双点积 $\\tilde{\\boldsymbol{\\sigma}} : \\boldsymbol{\\varepsilon}^e$ 简化为 $\\tilde{\\sigma}_{11}\\varepsilon^e_{11}$。因此，对于单轴情况，$Y$ 变为\n$$\nY = \\frac{1}{2}\\,\\tilde{\\sigma}_{11}\\varepsilon^e_{11} = \\frac{1}{2}\\,\\tilde{\\sigma}\\left(\\frac{\\tilde{\\sigma}}{E}\\right) = \\frac{\\tilde{\\sigma}^2}{2E}\n$$\n这就是所要求的用单轴量表示的 $Y$ 的表达式。\n\n其次，我们使用隐式（后向欧拉）时间离散化来推导损伤变量 $D$ 的单步更新公式。给定的损伤演化法则是\n$$\n\\dot{D} = \\left(\\frac{Y}{S}\\right)^{s}\\,\\dot{\\bar{\\varepsilon}}^{p}\n$$\n使用后向欧拉格式对该速率方程在从 $t_n$ 到 $t_{n+1}$（时长为 $\\Delta t = t_{n+1} - t_n$）的时间步上进行积分，我们通过在步末 $t_{n+1}$ 处计算其速率来近似该积分：\n$$\n\\int_{t_n}^{t_{n+1}} \\dot{D} \\, dt = \\int_{t_n}^{t_{n+1}} \\left(\\frac{Y(t)}{S}\\right)^{s}\\,\\dot{\\bar{\\varepsilon}}^{p}(t) \\, dt\n$$\n$$\nD_{n+1} - D_n \\approx \\left(\\frac{Y_{n+1}}{S}\\right)^{s}\\,(\\bar{\\varepsilon}^p_{n+1} - \\bar{\\varepsilon}^p_{n})\n$$\n使用记法 $\\Delta\\bar{\\varepsilon}^p := \\bar{\\varepsilon}^p_{n+1} - \\bar{\\varepsilon}^p_{n}$，$D_{n+1}$ 的更新法则为\n$$\nD_{n+1} = D_n + \\left(\\frac{Y_{n+1}}{S}\\right)^{s}\\,\\Delta\\bar{\\varepsilon}^p\n$$\n这就是所要求的后向欧拉更新表达式。\n\n第三，我们使用给定的数据计算 $D_{n+1}$ 的值。问题给出以下数值：$\\tilde{\\sigma}_{n+1} = 800\\,\\text{MPa}$，$E = 210\\,\\text{GPa} = 210000\\,\\text{MPa}$，$D_n = 0.05000$，$S = 5.000\\,\\text{MPa}$，$s = 1.300$ 和 $\\Delta\\bar{\\varepsilon}^p = 0.01000$。\n\n首先，我们必须使用第一项任务中得到的单轴状态的结果来计算 $Y_{n+1}$，该结果在时间 $t_{n+1}$ 处进行计算：\n$$\nY_{n+1} = \\frac{\\tilde{\\sigma}_{n+1}^2}{2E} = \\frac{(800\\,\\text{MPa})^2}{2 \\times (210000\\,\\text{MPa})} = \\frac{640000}{420000}\\,\\text{MPa} = \\frac{32}{21}\\,\\text{MPa}\n$$\n$Y_{n+1}$ 的值约为 $1.5238\\,\\text{MPa}$。现在我们将此值和其他给定值代入 $D_{n+1}$ 的更新方程中：\n$$\nD_{n+1} = D_n + \\left(\\frac{Y_{n+1}}{S}\\right)^{s}\\,\\Delta\\bar{\\varepsilon}^p = 0.05000 + \\left(\\frac{32/21\\,\\text{MPa}}{5.000\\,\\text{MPa}}\\right)^{1.300} \\times 0.01000\n$$\n括号内的比率是一个无量纲量：\n$$\n\\frac{Y_{n+1}}{S} = \\frac{32/21}{5} = \\frac{32}{105}\n$$\n现在我们进行数值计算：\n$$\nD_{n+1} = 0.05000 + \\left(\\frac{32}{105}\\right)^{1.300} \\times 0.01000\n$$\n$$\nD_{n+1} \\approx 0.05000 + (0.3047619)^{1.300} \\times 0.01000\n$$\n$$\nD_{n+1} \\approx 0.05000 + (0.2133983) \\times 0.01000\n$$\n$$\nD_{n+1} \\approx 0.05000 + 0.002133983\n$$\n$$\nD_{n+1} \\approx 0.052133983\n$$\n按要求将结果四舍五入到四位有效数字，我们得到 $D_{n+1} = 0.05213$。", "answer": "$$\n\\boxed{0.05213}\n$$", "id": "2897254"}, {"introduction": "这个实践练习旨在建立理论模型与宏观实验现象之间的桥梁。通过分析一个典型的加载-卸载循环，你将学习如何区分并量化材料响应中的两个关键部分：由塑性变形引起的永久应变和由损伤累积引起的刚度退化[@problem_id:2897262]。这项练习能够极大地增强你对损伤力学物理意义的直观理解。", "problem": "一根棱柱杆在小应变下经历一个等温单轴加载-卸载-再加载循环。该材料遵循一维 Lemaitre 各向同性标量损伤模型，总应变运动学分解为 $\\,\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}\\,$，并采用有效应力概念 $\\,\\tilde{\\sigma} = \\sigma/(1-D)\\,$，其中 $\\,\\sigma\\,$ 是 Cauchy 应力，$\\,D \\in [0,1)\\,$ 是标量损伤变量，$\\,\\tilde{\\sigma} = E_0 \\,\\varepsilon^{e}\\,$，其中 $\\,E_0\\,$ 是未损伤弹性骨架的杨氏模量。杆从初始状态（$\\,D=0\\,$, $\\,\\varepsilon^{p}=0\\,$）加载进入伴随损伤增长的塑性区，然后卸载至 $\\,\\sigma=0\\,$，随后弹性地再加载至目标应力 $\\,\\sigma^{\\star}\\,$。在卸载和初始再加载至 $\\,\\sigma^{\\star}\\,$ 的过程中，假设没有进一步的塑性流动和额外的损伤（即 $\\,\\varepsilon^{p}\\,$ 和 $\\,D\\,$ 冻结在加载结束时的值）。\n\n实验测量提供：\n- 未损伤杨氏模量 $\\,E_0 = 200 \\,\\mathrm{GPa}\\,$。\n- 卸载切线刚度 $\\,K_u = 150 \\,\\mathrm{GPa}\\,$。\n- 完全卸载至 $\\,\\sigma=0\\,$ 后的残余应变等于 $\\,\\varepsilon_r = 1.0 \\times 10^{-3}\\,$。\n- 目标再加载应力 $\\,\\sigma^{\\star} = 300 \\,\\mathrm{MPa}\\,$。\n\n定义在应力 $\\,\\sigma^{\\star}\\,$ 时，再加载路径上的应变与初始线弹性路径上的应变之间的总应变差为 $\\,\\Delta \\varepsilon_{\\text{tot}} = \\varepsilon_{\\text{reload}}(\\sigma^{\\star}) - \\varepsilon_{\\text{virgin}}(\\sigma^{\\star})\\,$。将 $\\,\\Delta \\varepsilon_{\\text{tot}}\\,$ 加法分解为一个塑性贡献和一个由损伤引起的刚度降低贡献，并计算 $\\,\\Delta \\varepsilon_{\\text{tot}}\\,$ 中可归因于塑性的比例。将最终比例表示为四位有效数字的小数。在最终报告的数字中不要包含单位。", "solution": "首先对问题陈述进行严格的验证程序。\n\n步骤1：提取已知条件。\n所提供的信息如下：\n- 等温单轴加载-卸载-再加载循环，小应变。\n- 材料模型：Lemaitre 各向同性标量损伤。\n- 总应变分解：$\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n- 有效应力定义：$\\tilde{\\sigma} = \\sigma/(1-D)$。\n- 损伤变量范围：$D \\in [0,1)$。\n- 有效空间中的线弹性：$\\tilde{\\sigma} = E_0 \\,\\varepsilon^{e}$，其中 $E_0$ 是未损伤杨氏模量。\n- 初始状态：原始状态，$D=0$，$\\varepsilon^{p}=0$。\n- 卸载/再加载假设：$\\varepsilon^{p}$ 和 $D$ 冻结在加载结束时的值。\n- 未损伤杨氏模量：$E_0 = 200 \\,\\mathrm{GPa}$。\n- 卸载切线刚度：$K_u = 150 \\,\\mathrm{GPa}$。\n- 完全卸载至 $\\sigma=0$ 后的残余应变：$\\varepsilon_r = 1.0 \\times 10^{-3}$。\n- 目标再加载应力：$\\sigma^{\\star} = 300 \\,\\mathrm{MPa}$。\n- 总应变差的定义：$\\Delta \\varepsilon_{\\text{tot}} = \\varepsilon_{\\text{reload}}(\\sigma^{\\star}) - \\varepsilon_{\\text{virgin}}(\\sigma^{\\star})$。\n- 任务：将 $\\Delta \\varepsilon_{\\text{tot}}$ 加法分解为塑性贡献和损伤贡献，然后计算 $\\Delta \\varepsilon_{\\text{tot}}$ 中可归因于塑性的比例，并四舍五入到四位有效数字。\n\n步骤2：使用提取的已知条件进行验证。\n根据验证标准对问题进行分析：\n- **科学依据**：该问题基于连续介质损伤力学中的经典 Lemaitre 模型，这是材料科学和机械工程领域的一个标准且成熟的理论。所有概念，如有效应力和应变分解，都是该领域的基础。\n- **适定性**：该问题是适定的。给定的数据足以唯一确定内部状态变量（$D$, $\\varepsilon^p$），从而唯一确定所需的应变分解和比例。\n- **客观性**：问题以精确、客观和定量的术语陈述。没有主观或模棱两可的陈述。\n- **其他缺陷**：该问题没有矛盾。给定的物理量（$E_0 = 200 \\,\\mathrm{GPa}$，$K_u = 150 \\,\\mathrm{GPa}$，$\\varepsilon_r = 1.0 \\times 10^{-3}$）对于金属材料是物理上合理的。该设置是计算或理论塑性与损伤力学中的一个标准练习。\n\n步骤3：结论与行动。\n问题被认为是有效的。现在将提供完整的解答。\n\n分析的基础在于所提供的本构关系。Cauchy 应力 $\\sigma$ 与总应变 $\\varepsilon$ 以及内变量 $D$ 和 $\\varepsilon^p$ 相关。在卸载和再加载期间，切线刚度 $K_u$ 是应力相对于总应变的变化率。鉴于在此阶段塑性应变 $\\varepsilon^p$ 和损伤 $D$ 保持不变的假设，我们有 $d\\varepsilon = d\\varepsilon^e$。\n\n损伤材料的应力-应变关系由有效应力概念推导得出：\n$$ \\sigma = (1-D) \\tilde{\\sigma} = (1-D) E_0 \\varepsilon^e $$\n因此，卸载过程中的切线刚度 $K_u$ 为：\n$$ K_u = \\frac{d\\sigma}{d\\varepsilon} = \\frac{d\\sigma}{d\\varepsilon^e} = (1-D)E_0 $$\n该方程允许我们根据给定的模量 $E_0$ 和 $K_u$ 来确定损伤变量 $D$：\n$$ D = 1 - \\frac{K_u}{E_0} $$\n代入给定值：\n$$ D = 1 - \\frac{150 \\,\\mathrm{GPa}}{200 \\,\\mathrm{GPa}} = 1 - 0.75 = 0.25 $$\n在初始加载阶段累积的损伤为 $D=0.25$。\n\n接下来，我们分析应变分量。总应变为 $\\varepsilon = \\varepsilon^e + \\varepsilon^p$。残余应变 $\\varepsilon_r$ 是试样完全卸载至 $\\sigma=0$ 后剩余的总应变。在 $\\sigma=0$ 时，弹性应变 $\\varepsilon^e$ 也为零，因为 $\\varepsilon^e = \\sigma / ((1-D)E_0) = 0$。因此，残余应变必须等于永久塑性应变：\n$$ \\varepsilon_r = \\varepsilon^p = 1.0 \\times 10^{-3} $$\n这就是在卸载点被“冻结”的塑性应变。\n\n现在我们计算在目标应力 $\\sigma^{\\star} = 300 \\,\\mathrm{MPa} = 0.3 \\,\\mathrm{GPa}$ 下计算 $\\Delta\\varepsilon_{\\text{tot}}$ 所需的两种应变。\n\n首先，是初始线弹性路径上的应变 $\\varepsilon_{\\text{virgin}}$。这是未损伤材料的响应，由模量为 $E_0$ 的胡克定律决定：\n$$ \\varepsilon_{\\text{virgin}}(\\sigma^{\\star}) = \\frac{\\sigma^{\\star}}{E_0} $$\n\n其次，是再加载路径上的应变 $\\varepsilon_{\\text{reload}}$。再加载路径遵循卸载线，其特征是恒定的损伤刚度 $K_u = (1-D)E_0$ 和恒定的塑性应变 $\\varepsilon^p = \\varepsilon_r$。总应变是弹性和塑性分量的总和：\n$$ \\varepsilon_{\\text{reload}}(\\sigma^{\\star}) = \\varepsilon^e(\\sigma^{\\star}) + \\varepsilon^p $$\n再加载路径上的弹性应变由损伤模量 $K_u$ 决定：\n$$ \\varepsilon^e(\\sigma^{\\star}) = \\frac{\\sigma^{\\star}}{(1-D)E_0} = \\frac{\\sigma^{\\star}}{K_u} $$\n因此，再加载路径上的总应变为：\n$$ \\varepsilon_{\\text{reload}}(\\sigma^{\\star}) = \\frac{\\sigma^{\\star}}{K_u} + \\varepsilon_r $$\n\n总应变差 $\\Delta\\varepsilon_{\\text{tot}}$ 定义为它们的差值：\n$$ \\Delta\\varepsilon_{\\text{tot}} = \\varepsilon_{\\text{reload}}(\\sigma^{\\star}) - \\varepsilon_{\\text{virgin}}(\\sigma^{\\star}) = \\left(\\frac{\\sigma^{\\star}}{K_u} + \\varepsilon_r\\right) - \\frac{\\sigma^{\\star}}{E_0} $$\n重新整理此表达式可以得到所需的加法分解：\n$$ \\Delta\\varepsilon_{\\text{tot}} = \\varepsilon_r + \\left(\\frac{\\sigma^{\\star}}{K_u} - \\frac{\\sigma^{\\star}}{E_0}\\right) $$\n第一项 $\\varepsilon_r$ 是由塑性变形引起的应变永久偏移。这代表了塑性对总应变差的贡献，我们将其记为 $\\Delta\\varepsilon_p$：\n$$ \\Delta\\varepsilon_p = \\varepsilon_r $$\n第二项代表在应力 $\\sigma^{\\star}$ 下，由于材料刚度因损伤从 $E_0$ 降低到 $K_u$ 而产生的额外弹性应变。这是损伤的贡献，记为 $\\Delta\\varepsilon_D$：\n$$ \\Delta\\varepsilon_D = \\frac{\\sigma^{\\star}}{K_u} - \\frac{\\sigma^{\\star}}{E_0} = \\sigma^{\\star}\\left(\\frac{1}{K_u} - \\frac{1}{E_0}\\right) $$\n因此，我们得到分解式 $\\Delta\\varepsilon_{\\text{tot}} = \\Delta\\varepsilon_p + \\Delta\\varepsilon_D$。\n\n问题要求计算 $\\Delta\\varepsilon_{\\text{tot}}$ 中可归因于塑性的比例。这个比例 $f_p$ 由下式给出：\n$$ f_p = \\frac{\\Delta\\varepsilon_p}{\\Delta\\varepsilon_{\\text{tot}}} = \\frac{\\Delta\\varepsilon_p}{\\Delta\\varepsilon_p + \\Delta\\varepsilon_D} $$\n现在我们代入表达式和数值。\n$$ \\Delta\\varepsilon_p = \\varepsilon_r = 1.0 \\times 10^{-3} $$\n$$ \\Delta\\varepsilon_D = (0.3 \\,\\mathrm{GPa}) \\left(\\frac{1}{150 \\,\\mathrm{GPa}} - \\frac{1}{200 \\,\\mathrm{GPa}}\\right) = 0.3 \\left(\\frac{4 - 3}{600}\\right) = \\frac{0.3}{600} = \\frac{1}{2000} = 0.5 \\times 10^{-3} $$\n总应变差为：\n$$ \\Delta\\varepsilon_{\\text{tot}} = (1.0 \\times 10^{-3}) + (0.5 \\times 10^{-3}) = 1.5 \\times 10^{-3} $$\n可归因于塑性的比例为：\n$$ f_p = \\frac{1.0 \\times 10^{-3}}{1.5 \\times 10^{-3}} = \\frac{1.0}{1.5} = \\frac{2}{3} $$\n作为小数，其值为 $0.6666...$。按要求四舍五入到四位有效数字：\n$$ f_p \\approx 0.6667 $$\n这个结果表明，在再加载过程中观察到的、相对于初始弹性响应的额外应变中，大约三分之二是由永久塑性变形引起的，而三分之一是由材料损伤引起的刚度降低造成的。", "answer": "$$\\boxed{0.6667}$$", "id": "2897262"}, {"introduction": "作为一项综合性实践，本练习要求你将前面学到的概念整合起来，构建一个完整的一维弹塑性损伤耦合的数值模型。你将通过编写代码，实现一个返回映射算法来预测材料在单调加载下的完整应力-应变响应[@problem_id:2897275]。这不仅是对理论知识的综合运用，也是现代材料与结构仿真分析中的一项核心技能。", "problem": "一根由各向同性损伤弹塑性材料制成的一维 (1D) 小应变杆，承受单轴单调拉伸加载。总应变加法分解为 $\\,\\varepsilon = \\varepsilon^e + \\varepsilon^p\\,$，其中 $\\,\\varepsilon^e\\,$ 是弹性应变，$\\,\\varepsilon^p\\,$ 是塑性应变。柯西应力与弹性应变的关系为 $\\,\\sigma = (1 - D) E \\varepsilon^e\\,$，其中 $\\,E\\,$ 是杨氏模量，$\\,D \\in [0,1)\\,$ 是各向同性损伤变量。假设单位体积的亥姆霍兹自由能为 $\\,\\psi = (1 - D)\\,\\dfrac{1}{2} E (\\varepsilon - \\varepsilon^p)^2\\,$，因此与 $\\,D\\,$ 共轭的热力学力是能量释放率 $\\,Y = -\\dfrac{\\partial \\psi}{\\partial D} = \\dfrac{1}{2} E (\\varepsilon - \\varepsilon^p)^2\\,$。\n\n塑性屈服遵循通过有效应力概念特化到一维的 von Mises 准则。定义有效应力为 $\\,\\tilde{\\sigma} = \\dfrac{\\sigma}{1 - D}\\,$。在一维情况下，von Mises 等效应力简化为 $\\,|\\tilde{\\sigma}|\\,$。取屈服条件为 $\\,f = |\\tilde{\\sigma}| - (\\sigma_{y0} + H \\bar{\\varepsilon}^p) \\le 0\\,$，其中 $\\,\\sigma_{y0}\\,$ 是初始屈服应力，$\\,H \\ge 0\\,$ 是线性各向同性硬化模量，$\\,\\bar{\\varepsilon}^p\\,$ 是累积等效塑性应变。在单调拉伸中，$\\,\\bar{\\varepsilon}^p\\,$ 与累积塑性应变一致，且流动法则是相关的，因此对于塑性乘子 $\\,\\dot{\\lambda} \\ge 0\\,$，有 $\\,\\dot{\\varepsilon}^p = \\dot{\\lambda}\\,$ 和 $\\,\\dot{\\bar{\\varepsilon}}^p = \\dot{\\lambda}\\,$。损伤仅在塑性流动过程中根据 Lemaitre 型定律 $\\,\\dot{D} = \\left(\\dfrac{Y}{S}\\right)^{s} \\dot{\\bar{\\varepsilon}}^p\\,$ 进行演化，其中材料参数 $\\,S  0\\,$，指数 $\\,s  0\\,$。\n\n从这些基本定义出发，使用有效应力空间中的后向欧拉返回映射算法和损伤的后向欧拉更新，推导应变驱动的单调加载步 $\\,\\varepsilon_n \\rightarrow \\varepsilon_{n+1}\\,$ 的增量应力更新。说明塑性一致性条件如何确定塑性增量，以及损伤增量如何依赖于更新后的能量释放率。将算法特化到一维，明确指出试探状态、弹性检验以及包含线性各向同性硬化的塑性修正步骤。\n\n你的程序必须实现该算法，以计算以下测试套件的应力响应。对于每个测试用例，都提供了材料参数 $\\,E\\,$, $\\,\\sigma_{y0}\\,$, $\\,H\\,$, $\\,S\\,$, $\\,s\\,$ 以及一个单调递增的总应变列表 $\\,\\{\\varepsilon_k\\}\\,$。假设初始条件为 $\\,\\varepsilon^p_0 = 0\\,$, $\\,\\bar{\\varepsilon}^p_0 = 0\\,$ 和 $\\,D_0 = 0\\,$。在每个应变点，更新 $\\,\\varepsilon^p\\,$, $\\,\\bar{\\varepsilon}^p\\,$, $\\,D\\,$，并计算柯西应力 $\\,\\sigma = (1 - D)\\,E(\\varepsilon - \\varepsilon^p)\\,$。对于每个测试用例，返回列表中最后一个应变对应的最终柯西应力。所有应力必须以帕斯卡 (Pa) 表示。不出现角度。不要使用百分号；任何比率都必须是小数。\n\n测试套件（所有数值均采用国际单位制 (SI)）：\n\n- 用例 1 (纯弹性路径)：\n  - $\\,E = 210 \\times 10^9\\,$, $\\,\\sigma_{y0} = 250 \\times 10^6\\,$, $\\,H = 1 \\times 10^9\\,$, $\\,S = 1 \\times 10^9\\,$, $\\,s = 1.0\\,$,\n  - 应变路径 $\\,\\{\\varepsilon_k\\} = \\{\\,0,\\; 5\\times 10^{-4},\\; 1\\times 10^{-3}\\,\\}\\,$.\n- 用例 2 (塑性伴随可忽略的损伤)：\n  - $\\,E = 210 \\times 10^9\\,$, $\\,\\sigma_{y0} = 250 \\times 10^6\\,$, $\\,H = 1 \\times 10^9\\,$, $\\,S = 1 \\times 10^{12}\\,$, $\\,s = 1.0\\,$,\n  - 应变路径 $\\,\\{\\varepsilon_k\\} = \\{\\,0,\\; 5\\times 10^{-4},\\; 1.2\\times 10^{-3},\\; 5\\times 10^{-3}\\,\\}\\,$.\n- 用例 3 (塑性伴随显著的损伤)：\n  - $\\,E = 210 \\times 10^9\\,$, $\\,\\sigma_{y0} = 250 \\times 10^6\\,$, $\\,H = 1 \\times 10^9\\,$, $\\,S = 1 \\times 10^5\\,$, $\\,s = 1.0\\,$,\n  - 应变路径 $\\,\\{\\varepsilon_k\\} = \\{\\,0,\\; 5\\times 10^{-4},\\; 1.2\\times 10^{-3},\\; 5\\times 10^{-3}\\,\\}\\,$.\n- 用例 4 (初始屈服的边界用例)：\n  - $\\,E = 210 \\times 10^9\\,$, $\\,\\sigma_{y0} = 250 \\times 10^6\\,$, $\\,H = 1 \\times 10^9\\,$, $\\,S = 1 \\times 10^9\\,$, $\\,s = 1.0\\,$,\n  - 应变路径 $\\,\\{\\varepsilon_k\\} = \\left\\{\\,0,\\; \\dfrac{\\sigma_{y0}}{E}\\,\\right\\} = \\left\\{\\,0,\\; \\dfrac{250 \\times 10^6}{210 \\times 10^9}\\,\\right\\}\\,$.\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\,\\left[\\,\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\,\\right]\\,$），列表中的四个条目按顺序分别为用例 1 到 4 的最终柯西应力（单位：Pa）。", "solution": "问题陈述有效。它提出了一个计算非弹性力学领域的标准练习，具体是实现一个基于 Lemaitre 框架的一维耦合弹塑性-损伤模型。所有物理和数学定义均与公认的连续介质力学文献一致，所提供的参数在物理上是合理的。\n\n任务是为一组给定的本构方程推导并实现一个增量应力更新算法。加载是应变控制的单调拉伸。该算法将遵循有效应力空间中的后向欧拉预测-校正方案。\n\n设在一个时间增量开始时（即第 $n$ 步），状态是已知的：总应变 $\\varepsilon_n$、塑性应变 $\\varepsilon^p_n$、累积塑性应变 $\\bar{\\varepsilon}^p_n$ 和损伤变量 $D_n$。加载过程指定了增量结束时的总应变 $\\varepsilon_{n+1}$。目标是计算状态 $(\\varepsilon^p_{n+1}, \\bar{\\varepsilon}^p_{n+1}, D_{n+1})$ 和柯西应力 $\\sigma_{n+1}$。\n\n对于每个增量步 $\\varepsilon_n \\to \\varepsilon_{n+1}$，算法按以下步骤进行。\n\n**1. 弹性预测（试探状态）**\n首先，我们假设应变增量是纯弹性的。内变量（塑性应变和损伤）被冻结在它们上一步的值。这就定义了一个“试探状态”，用上标 'tr' 表示。\n$$ \\varepsilon^{p, \\text{tr}}_{n+1} = \\varepsilon^p_n $$\n$$ \\bar{\\varepsilon}^{p, \\text{tr}}_{n+1} = \\bar{\\varepsilon}^p_n $$\n试探弹性应变为 $\\varepsilon^{e, \\text{tr}}_{n+1} = \\varepsilon_{n+1} - \\varepsilon^{p, \\text{tr}}_{n+1} = \\varepsilon_{n+1} - \\varepsilon^p_n$。该模型是在有效应力空间中建立的，其本构关系为 $\\tilde{\\sigma} = E \\varepsilon^e$。因此，试探有效应力为：\n$$ \\tilde{\\sigma}^{\\text{tr}}_{n+1} = E \\varepsilon^{e, \\text{tr}}_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^p_n) $$\n\n**2. 屈服检验**\n接下来，我们通过计算屈服函数 $f = |\\tilde{\\sigma}| - (\\sigma_{y0} + H \\bar{\\varepsilon}^p) \\le 0$ 来检查这个弹性试探状态是否可接受。对于单调拉伸，$\\tilde{\\sigma}0$，因此条件简化。已知状态 $n$ 的屈服强度为 $\\sigma_{y,n} = \\sigma_{y0} + H\\bar{\\varepsilon}^p_n$。试探状态下的屈服函数计算如下：\n$$ f^{\\text{tr}} = \\tilde{\\sigma}^{\\text{tr}}_{n+1} - (\\sigma_{y0} + H\\bar{\\varepsilon}^{p, \\text{tr}}_{n+1}) = \\tilde{\\sigma}^{\\text{tr}}_{n+1} - \\sigma_{y,n} $$\n- 如果 $f^{\\text{tr}} \\le 0$，则弹性假设有效。增量是纯弹性的。状态变量更新为其试探值，即 $\\varepsilon^p_{n+1} = \\varepsilon^p_n$，$\\bar{\\varepsilon}^p_{n+1} = \\bar{\\varepsilon}^p_n$，且 $D_{n+1} = D_n$。有效应力为 $\\tilde{\\sigma}_{n+1} = \\tilde{\\sigma}^{\\text{tr}}_{n+1}$。柯西应力为 $\\sigma_{n+1} = (1 - D_{n+1}) \\tilde{\\sigma}_{n+1} = (1 - D_n) \\tilde{\\sigma}^{\\text{tr}}_{n+1}$。\n- 如果 $f^{\\text{tr}}  0$，则材料已经屈服，必须执行塑性-损伤校正步骤以强制满足一致性条件。\n\n**3. 塑性-损伤校正**\n当发生塑性变形时，增量结束时的状态必须满足积分后的本构律。后向欧拉法规定所有与率相关的量都在最终时刻 $t_{n+1}$ 进行计算。\n\n离散演化方程如下：\n1.  **塑性应变：** 由于流动是相关的且加载是单调的，塑性应变增量 $\\Delta\\varepsilon^p$ 等于等效塑性应变增量 $\\Delta\\bar{\\varepsilon}^p$。此增量由塑性乘子增量 $\\Delta\\lambda$ 给出，为清晰起见，在一维情况下我们将其表示为 $\\Delta\\bar{\\varepsilon}^p$。\n    $$ \\varepsilon^p_{n+1} = \\varepsilon^p_n + \\Delta\\bar{\\varepsilon}^p $$\n    $$ \\bar{\\varepsilon}^p_{n+1} = \\bar{\\varepsilon}^p_n + \\Delta\\bar{\\varepsilon}^p $$\n2.  **有效应力（返回映射）：** 有效应力根据塑性应变增量进行更新。\n    $$ \\tilde{\\sigma}_{n+1} = E \\varepsilon^e_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^p_{n+1}) = E(\\varepsilon_{n+1} - \\varepsilon^p_n - \\Delta\\bar{\\varepsilon}^p) $$\n    使用试探应力的定义，我们得到返回映射公式：\n    $$ \\tilde{\\sigma}_{n+1} = \\tilde{\\sigma}^{\\text{tr}}_{n+1} - E \\Delta\\bar{\\varepsilon}^p $$\n3.  **一致性条件：** 最终状态必须位于扩展后的屈服面上。\n    $$ f_{n+1} = \\tilde{\\sigma}_{n+1} - (\\sigma_{y0} + H\\bar{\\varepsilon}^p_{n+1}) = 0 $$\n通过将 $\\tilde{\\sigma}_{n+1}$ 和 $\\bar{\\varepsilon}^p_{n+1}$ 的更新法则代入一致性条件，我们可以求解未知的塑性增量 $\\Delta\\bar{\\varepsilon}^p$：\n$$ (\\tilde{\\sigma}^{\\text{tr}}_{n+1} - E \\Delta\\bar{\\varepsilon}^p) - (\\sigma_{y0} + H(\\bar{\\varepsilon}^p_n + \\Delta\\bar{\\varepsilon}^p)) = 0 $$\n重新整理以分离 $\\Delta\\bar{\\varepsilon}^p$：\n$$ \\tilde{\\sigma}^{\\text{tr}}_{n+1} - (\\sigma_{y0} + H\\bar{\\varepsilon}^p_n) = (E + H) \\Delta\\bar{\\varepsilon}^p $$\n左侧是试探屈服函数 $f^{\\text{tr}}$。这为塑性增量提供了一个闭式解：\n$$ \\Delta\\bar{\\varepsilon}^p = \\frac{f^{\\text{tr}}}{E + H} $$\n在 $\\Delta\\bar{\\varepsilon}^p$ 已知后，就可以计算 $n+1$ 时刻的塑性应变和有效应力。\n\n4.  **损伤更新：** 损伤演化与塑性流动相耦合。对 $\\dot{D} = (Y/S)^s \\dot{\\bar{\\varepsilon}}^p$ 使用后向欧拉法则：\n    $$ D_{n+1} = D_n + \\left(\\frac{Y_{n+1}}{S}\\right)^s \\Delta\\bar{\\varepsilon}^p $$\n    能量释放率 $Y_{n+1}$ 在步末状态下计算：\n    $$ Y_{n+1} = \\frac{1}{2} E (\\varepsilon^e_{n+1})^2 = \\frac{1}{2E} (\\tilde{\\sigma}_{n+1})^2 $$\n    由于 $\\tilde{\\sigma}_{n+1}$ 已经通过塑性校正确定，因此可以计算 $Y_{n+1}$，然后顺序更新 $D_{n+1}$。\n\n5.  **最终柯西应力：** 最后，使用更新后的有效应力和损伤变量计算柯西应力：\n    $$ \\sigma_{n+1} = (1 - D_{n+1}) \\tilde{\\sigma}_{n+1} $$\n对给定应变路径中的每个增量步应用此顺序更新程序，以确定最终的应力状态。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the final Cauchy stress in a 1D bar under monotonic tension using a\n    Lemaitre-type coupled damage-plasticity model. It iterates through a suite\n    of test cases, computes the stress response for each strain path, and\n    prints the final stress values in the required format.\n    \"\"\"\n\n    def compute_final_stress(E, sig_y0, H, S, s, strains):\n        \"\"\"\n        Implements the incremental stress update algorithm for a single test case.\n\n        This function simulates the material response over a given strain path\n        using a backward-Euler return-mapping algorithm for plasticity and damage.\n\n        Args:\n            E (float): Young's modulus in Pa.\n            sig_y0 (float): Initial yield stress in Pa.\n            H (float): Linear isotropic hardening modulus in Pa.\n            S (float): Damage strength parameter in Pa.\n            s (float): Damage exponent parameter (dimensionless).\n            strains (list of float): The monotonically increasing strain path.\n\n        Returns:\n            float: The final Cauchy stress in Pa at the end of the strain path.\n        \"\"\"\n        # Initial state at strain = 0\n        ep_p = 0.0  # Plastic strain\n        ep_bar_p = 0.0  # Accumulated equivalent plastic strain\n        D = 0.0  # Damage variable\n        sigma_tilde = 0.0 # Effective stress\n\n        # The state at the end of the previous increment (n)\n        ep_p_n = ep_p\n        ep_bar_p_n = ep_bar_p\n        D_n = D\n\n        for i in range(1, len(strains)):\n            # Load the total strain for the current increment (n+1)\n            eps_n1 = strains[i]\n\n            # 1. Elastic Predictor:\n            sigma_tilde_tr = E * (eps_n1 - ep_p_n)\n\n            # 2. Yield Check:\n            sigma_y_n = sig_y0 + H * ep_bar_p_n\n            f_tr = sigma_tilde_tr - sigma_y_n\n\n            if f_tr = 0:\n                # Elastic step\n                ep_p = ep_p_n\n                ep_bar_p = ep_bar_p_n\n                D = D_n\n                sigma_tilde = sigma_tilde_tr\n            else:\n                # 3. Plastic-Damage Corrector:\n                # a. Plastic update (return mapping)\n                delta_ep_bar_p = f_tr / (E + H)\n                ep_p = ep_p_n + delta_ep_bar_p\n                ep_bar_p = ep_bar_p_n + delta_ep_bar_p\n                sigma_tilde = sigma_tilde_tr - E * delta_ep_bar_p\n\n                # b. Damage update\n                Y_n1 = (sigma_tilde**2) / (2.0 * E)\n                D = D_n + (Y_n1 / S)**s * delta_ep_bar_p\n                \n                # Practical limit to prevent D >= 1\n                if D >= 1.0:\n                    D = 0.9999999999\n\n            # Update state for the next increment\n            ep_p_n = ep_p\n            ep_bar_p_n = ep_bar_p\n            D_n = D\n\n        # Final Cauchy stress calculation after the last increment\n        sigma_cauchy = (1.0 - D_n) * sigma_tilde\n        return sigma_cauchy\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Purely elastic path\n        {\"E\": 210e9, \"sig_y0\": 250e6, \"H\": 1e9, \"S\": 1e9, \"s\": 1.0, \"strains\": [0.0, 5e-4, 1e-3]},\n        # Case 2: Plasticity with negligible damage\n        {\"E\": 210e9, \"sig_y0\": 250e6, \"H\": 1e9, \"S\": 1e12, \"s\": 1.0, \"strains\": [0.0, 5e-4, 1.2e-3, 5e-3]},\n        # Case 3: Plasticity with noticeable damage\n        {\"E\": 210e9, \"sig_y0\": 250e6, \"H\": 1e9, \"S\": 1e5, \"s\": 1.0, \"strains\": [0.0, 5e-4, 1.2e-3, 5e-3]},\n        # Case 4: Boundary case at first yield\n        {\"E\": 210e9, \"sig_y0\": 250e6, \"H\": 1e9, \"S\": 1e9, \"s\": 1.0, \"strains\": [0.0, 250e6 / 210e9]},\n    ]\n\n    results = []\n    for case in test_cases:\n        final_stress = compute_final_stress(\n            case[\"E\"], case[\"sig_y0\"], case[\"H\"], case[\"S\"], case[\"s\"], case[\"strains\"]\n        )\n        results.append(final_stress)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2897275"}]}