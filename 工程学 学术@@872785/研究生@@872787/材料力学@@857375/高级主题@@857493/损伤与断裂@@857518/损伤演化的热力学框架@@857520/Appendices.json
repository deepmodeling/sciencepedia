{"hands_on_practices": [{"introduction": "此练习是热力学方法的基础。我们将从一个简单的单轴情形出发，推导与损伤变量共轭的热力学力，即损伤驱动力或能量释放率。这项实践旨在巩固亥姆霍兹自由能势与控制材料退化的演化定律之间的联系，这是理解和构建任何损伤模型的关键第一步 [@problem_id:2924554]。", "problem": "考虑一个发生小应变、等温的单轴连续体，其具有一个内标量损伤变量 $d \\in [0,1)$，该变量会降低刚度。设 Helmholtz 自由能密度具有可分离形式 $\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}(\\varepsilon)$，其中 $\\varepsilon$ 是单轴应变，$\\psi_{0}(\\varepsilon)$ 是未损伤时的储存能量密度，$g(d)$ 是满足 $g(0)=1$ 和 $g(1)=0$ 的退化函数。假设未损伤储存能量为 $\\psi_{0}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2}$，其中 $E0$ 是杨氏模量，且退化函数为 $g(d) = (1-d)^{m}$，其中指数 $m0$。\n\n从热力学第二定律的局部形式（通过 Clausius-Duhem 不等式）出发，将 $d$ 视为一个内变量及其热力学共轭力，推导损伤驱动力 $Y(\\varepsilon,d)$（用 $\\varepsilon$、$d$、$E$ 和 $m$ 表示）。然后，通过对数灵敏度 $S_{m}(\\varepsilon,d) \\equiv \\dfrac{\\partial}{\\partial m}\\ln Y(\\varepsilon,d)$（在固定的 $\\varepsilon$ 和 $d$ 下计算）来量化 $Y$ 对指数 $m$ 的灵敏度。\n\n以 $Y(\\varepsilon,d)$ 和 $S_{m}(\\varepsilon,d)$ 的闭式表达式对的形式给出您的最终答案。虽然结果是符号形式的，但请注意，如果 $E$ 的单位是帕斯卡 (Pascals)，$\\varepsilon$ 是无量纲的，则 $Y$ 的单位是焦耳/立方米 (Joules per cubic meter)；灵敏度 $S_{m}$ 是无量纲的。不要代入数值。将您的最终答案表示为单行矩阵 $\\bigl[Y(\\varepsilon,d),\\,S_{m}(\\varepsilon,d)\\bigr]$。最终的方框答案中不要包含单位。", "solution": "该问题在连续介质损伤力学框架内被验证为自洽、有科学依据且适定的。推导过程直接源于热力学原理。\n\n推导的起点是等温过程的 Clausius-Duhem 不等式的局部形式，该不等式表明单位体积的机械耗散 $\\mathcal{D}$ 必须为非负：\n$$\n\\mathcal{D} = \\sigma \\dot{\\varepsilon} - \\dot{\\psi} \\ge 0\n$$\n此处，$\\sigma$ 是单轴应力，$\\varepsilon$ 是单轴应变，$\\psi$ 是 Helmholtz 自由能密度。上方的点表示材料时间导数。\n\nHelmholtz 自由能密度是可观测变量应变 $\\varepsilon$ 和内变量损伤 $d$ 的状态函数。因此，$\\psi = \\psi(\\varepsilon, d)$。应用链式法则，其时间导数为：\n$$\n\\dot{\\psi} = \\frac{\\partial \\psi}{\\partial \\varepsilon} \\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial d} \\dot{d}\n$$\n将此表达式代入 Clausius-Duhem 不等式，得到：\n$$\n\\sigma \\dot{\\varepsilon} - \\left( \\frac{\\partial \\psi}{\\partial \\varepsilon} \\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial d} \\dot{d} \\right) \\ge 0\n$$\n根据速率重新整理各项，得到：\n$$\n\\left( \\sigma - \\frac{\\partial \\psi}{\\partial \\varepsilon} \\right) \\dot{\\varepsilon} - \\frac{\\partial \\psi}{\\partial d} \\dot{d} \\ge 0\n$$\n根据 Coleman-Noll 程序，此不等式必须对所有容许的热力学过程成立，即对速率 $\\dot{\\varepsilon}$ 的任何任意选择都成立。为此，$\\dot{\\varepsilon}$ 的系数必须为零，因为 $\\dot{\\varepsilon}$ 可以为正或为负。这导出了应力的本构关系：\n$$\n\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon}\n$$\n根据此状态定律，该不等式简化为耗散不等式：\n$$\n- \\frac{\\partial \\psi}{\\partial d} \\dot{d} \\ge 0\n$$\n与内变量 $d$ 共轭的热力学力定义为自由能对该变量的负偏导数。这就是损伤驱动力，记为 $Y$。\n$$\nY \\equiv - \\frac{\\partial \\psi}{\\partial d}\n$$\n耗散不等式现在可以紧凑地写为 $Y \\dot{d} \\ge 0$。由于损伤是一个不可逆过程，其演化特征为 $\\dot{d} \\ge 0$，因此损伤驱动力必须为非负，即 $Y \\ge 0$。\n\nHelmholtz 自由能密度的具体形式为 $\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}(\\varepsilon)$，其中未损伤储存能量密度为 $\\psi_{0}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2}$，退化函数为 $g(d) = (1-d)^{m}$。完整的表达式是：\n$$\n\\psi(\\varepsilon,d) = \\left( \\frac{1}{2} E \\varepsilon^{2} \\right) (1-d)^{m}\n$$\n其中 $E > 0$ 且 $m > 0$。\n\n我们通过对 $\\psi$ 求关于 $d$ 的偏导数来计算损伤驱动力 $Y$：\n$$\nY(\\varepsilon,d) = - \\frac{\\partial}{\\partial d} \\left[ \\left( \\frac{1}{2} E \\varepsilon^{2} \\right) (1-d)^{m} \\right]\n$$\n在此微分中，项 $\\tfrac{1}{2} E \\varepsilon^{2}$ 被视为常数。\n$$\nY(\\varepsilon,d) = - \\left( \\frac{1}{2} E \\varepsilon^{2} \\right) \\frac{\\partial}{\\partial d} \\left[ (1-d)^{m} \\right]\n$$\n使用链式法则进行微分，其中 $\\frac{d}{dx} u(x)^n = n u(x)^{n-1} u'(x)$:\n$$\n\\frac{\\partial}{\\partial d} (1-d)^{m} = m(1-d)^{m-1} \\cdot (-1) = -m(1-d)^{m-1}\n$$\n将此结果代回 $Y$ 的表达式中：\n$$\nY(\\varepsilon,d) = - \\left( \\frac{1}{2} E \\varepsilon^{2} \\right) \\left[ -m(1-d)^{m-1} \\right]\n$$\n这简化为第一个所求的表达式：\n$$\nY(\\varepsilon,d) = \\frac{1}{2} m E \\varepsilon^{2} (1-d)^{m-1}\n$$\n接下来，我们必须求出 $Y$ 关于指数 $m$ 的对数灵敏度，定义为 $S_{m}(\\varepsilon,d) \\equiv \\frac{\\partial}{\\partial m}\\ln Y(\\varepsilon,d)$。首先，我们求 $Y$ 的自然对数：\n$$\n\\ln Y(\\varepsilon,d) = \\ln \\left( \\frac{1}{2} m E \\varepsilon^{2} (1-d)^{m-1} \\right)\n$$\n利用对数性质 $\\ln(a \\cdot b) = \\ln(a) + \\ln(b)$ 和 $\\ln(a^b) = b \\ln(a)$，我们展开表达式：\n$$\n\\ln Y(\\varepsilon,d) = \\ln\\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + \\ln(m) + \\ln\\left((1-d)^{m-1}\\right)\n$$\n$$\n\\ln Y(\\varepsilon,d) = \\ln\\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + \\ln(m) + (m-1)\\ln(1-d)\n$$\n现在，我们对此表达式关于 $m$ 求导，同时保持 $\\varepsilon$ 和 $d$ 不变。\n$$\nS_{m}(\\varepsilon,d) = \\frac{\\partial}{\\partial m} \\left[ \\ln\\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + \\ln(m) + (m-1)\\ln(1-d) \\right]\n$$\n各项分别求导：\n$$\n\\frac{\\partial}{\\partial m} \\left[ \\ln\\left(\\frac{1}{2} E \\varepsilon^{2}\\right) \\right] = 0\n$$\n$$\n\\frac{\\partial}{\\partial m} \\left[ \\ln(m) \\right] = \\frac{1}{m}\n$$\n$$\n\\frac{\\partial}{\\partial m} \\left[ (m-1)\\ln(1-d) \\right] = \\ln(1-d) \\cdot \\frac{\\partial}{\\partial m}(m-1) = \\ln(1-d) \\cdot 1 = \\ln(1-d)\n$$\n结合这些结果，得到对数灵敏度的最终表达式：\n$$\nS_{m}(\\varepsilon,d) = \\frac{1}{m} + \\ln(1-d)\n$$\n两个所求的表达式是 $Y(\\varepsilon,d) = \\frac{1}{2} m E \\varepsilon^{2} (1-d)^{m-1}$ 和 $S_{m}(\\varepsilon,d) = \\frac{1}{m} + \\ln(1-d)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} m E \\varepsilon^{2} (1-d)^{m-1}  \\frac{1}{m} + \\ln(1-d) \\end{pmatrix}}\n$$", "id": "2924554"}, {"introduction": "许多工程材料在拉伸和压缩下的力学行为存在显著差异。本实践引入一个更复杂的模型，通过分解应变能来捕捉这种不对称性。你将把这一概念应用于一个二维纯剪切案例，这个练习将展示如何在热力学框架内分析复杂应力状态，并理解拉压不对称性如何影响材料在多轴载荷下的响应 [@problem_id:2924539]。", "problem": "考虑一个在二维平面应力下承受小应变的均匀、各向同性、线性弹性固体，该固体增添了一个不可逆演化的标量损伤变量 $d \\in [0,1]$。设亥姆霍兹自由能密度仅在受拉时退化，通过将其分解为可加和的拉伸部分和压缩部分来实现，使得\n- 弹性的基准（未损伤）能量由 $\\,\\psi_{0}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\, \\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}\\,$ 给出，其中 $\\lambda$ 和 $\\mu$ 为拉梅常数，\n- 应变张量允许谱分解 $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{2} \\varepsilon_{i}\\,\\boldsymbol{n}_{i}\\otimes\\boldsymbol{n}_{i}$，其中 $\\varepsilon_{1},\\varepsilon_{2}$ 为主应变，$\\boldsymbol{n}_{i}$ 为标准正交的特征向量，\n- 拉伸和压缩自由能部分 $\\psi^{+}$ 和 $\\psi^{-}$，是通过使用麦考利括号 $\\langle x\\rangle_{+}=\\max(x,0)$ 和 $\\langle x\\rangle_{-}=\\min(x,0)$ 将主应变替换为其正部和负部，并通过 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{\\pm}$ 分解体积贡献来构建的，\n- 总自由能密度表示为 $\\,\\psi(\\boldsymbol{\\varepsilon},d) = g(d)\\,\\psi^{+}(\\boldsymbol{\\varepsilon}) + \\psi^{-}(\\boldsymbol{\\varepsilon})\\,$，其中 $\\,g(d)=(1-d)^{2}$。\n\nA部分。从这些要素以及线性弹性和谱分解的基本原理出发，推导 $\\,\\psi^{+}\\,$ 和 $\\,\\psi^{-}\\,$ 关于主应变 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$、$\\lambda$ 和 $\\mu$ 的闭式表达式。\n\nB部分。使用小应变的热力学应力共轭关系 $\\,\\boldsymbol{\\sigma} = \\partial \\psi / \\partial \\boldsymbol{\\varepsilon}\\,$，将您的结果应用于具有工程剪应变 $\\gamma$ 的二维纯剪切试验，即：\n$$\n\\boldsymbol{\\varepsilon} \\;=\\;\n\\begin{pmatrix}\n0  \\gamma/2\\\\\n\\gamma/2  0\n\\end{pmatrix},\n$$\n并计算剪应力分量 $\\,\\sigma_{12}\\,$ 作为 $\\,d,\\,\\mu,\\,$ 和 $\\,\\gamma\\,$ 的函数。将您的最终答案表示为 $\\,\\sigma_{12}(d,\\gamma,\\mu)\\,$ 的单个闭式解析表达式。不要代入数值。最终表达式中不要包含单位。", "solution": "该问题要求推导连续介质损伤模型的组成部分，并将其应用于特定的载荷情况。问题陈述具有科学依据，是适定的、客观的。不存在使其无效的矛盾或信息缺失。我们将首先解决A部分，然后解决B部分。\n\nA部分：拉伸和压缩自由能部分的推导。\n\n在二维情况下，均匀、各向同性、线性弹性固体的基准弹性自由能密度由下式给出：\n$$ \\psi_{0}(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\lambda (\\operatorname{tr}\\boldsymbol{\\varepsilon})^{2} + \\mu\\, \\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} $$\n其中 $\\lambda$ 和 $\\mu$ 是拉梅常数。在应变张量 $\\boldsymbol{\\varepsilon}$ 的主基中，其中主应变为 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$，迹和双点积由下式给出：\n$$ \\operatorname{tr}\\boldsymbol{\\varepsilon} = \\varepsilon_{1} + \\varepsilon_{2} $$\n$$ \\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} = \\varepsilon_{1}^{2} + \\varepsilon_{2}^{2} $$\n将这些代入 $\\psi_{0}$ 的表达式，得到以主应变表示的能量密度：\n$$ \\psi_{0}(\\varepsilon_{1}, \\varepsilon_{2}) = \\frac{1}{2}\\lambda (\\varepsilon_{1}+\\varepsilon_{2})^{2} + \\mu (\\varepsilon_{1}^{2}+\\varepsilon_{2}^{2}) $$\n问题陈述能量被分解为拉伸部分 $\\psi^{+}$ 和压缩部分 $\\psi^{-}$。这种分解是通过对类偏量部分的主应变和对体积部分的应变迹使用麦考利括号 $\\langle x \\rangle_{+} = \\max(x,0)$ 和 $\\langle x \\rangle_{-} = \\min(x,0)$ 来构建的。一个确保 $\\psi_{0} = \\psi^{+} + \\psi^{-}$ 的一致解释是如下定义这种分解：\n$$ \\psi^{+}(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\lambda \\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu \\sum_{i=1}^{2} \\langle \\varepsilon_{i} \\rangle_{+}^{2} $$\n$$ \\psi^{-}(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\lambda \\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{-}^{2} + \\mu \\sum_{i=1}^{2} \\langle \\varepsilon_{i} \\rangle_{-}^{2} $$\n该公式是一致的，因为对于任何实数 $x$，有 $x = \\langle x \\rangle_{+} + \\langle x \\rangle_{-}$ 和 $x^2 = (\\langle x \\rangle_{+})^2 + (\\langle x \\rangle_{-})^2$。将此应用于能量表达式中的各项，证实了加和分解 $\\psi_0 = \\psi^+ + \\psi^-$。\n\n以主应变 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$ 表示，$\\psi^{+}$ 和 $\\psi^{-}$ 的显式闭式表达式为：\n$$ \\psi^{+}(\\varepsilon_{1}, \\varepsilon_{2}) = \\frac{1}{2}\\lambda \\langle \\varepsilon_{1}+\\varepsilon_{2} \\rangle_{+}^{2} + \\mu (\\langle \\varepsilon_{1} \\rangle_{+}^{2} + \\langle \\varepsilon_{2} \\rangle_{+}^{2}) $$\n$$ \\psi^{-}(\\varepsilon_{1}, \\varepsilon_{2}) = \\frac{1}{2}\\lambda \\langle \\varepsilon_{1}+\\varepsilon_{2} \\rangle_{-}^{2} + \\mu (\\langle \\varepsilon_{1} \\rangle_{-}^{2} + \\langle \\varepsilon_{2} \\rangle_{-}^{2}) $$\n这些是A部分所要求的表达式。\n\nB部分：纯剪切试验中剪应力的计算。\n\n包含损伤的总亥姆霍兹自由能密度由下式给出：\n$$ \\psi(\\boldsymbol{\\varepsilon},d) = g(d)\\,\\psi^{+}(\\boldsymbol{\\varepsilon}) + \\psi^{-}(\\boldsymbol{\\varepsilon}) $$\n其中退化函数为 $g(d) = (1-d)^{2}$。柯西应力张量 $\\boldsymbol{\\sigma}$ 是通过热力学共轭关系 $\\boldsymbol{\\sigma} = \\frac{\\partial \\psi}{\\partial \\boldsymbol{\\varepsilon}}$ 获得的。对于一个能量函数仅依赖于主应变的各向同性材料，主应力 $\\sigma_i$ 由 $\\sigma_{i} = \\frac{\\partial \\psi}{\\partial \\varepsilon_{i}}$ 给出。应力张量则为 $\\boldsymbol{\\sigma} = \\sum_{i=1}^{2} \\sigma_{i} \\boldsymbol{n}_{i} \\otimes \\boldsymbol{n}_{i}$。\n\n让我们计算 $\\psi$ 对主应变 $\\varepsilon_1$ 和 $\\varepsilon_2$ 的导数。利用性质 $\\frac{d}{dx} \\langle x \\rangle_{\\pm}^2 = 2 \\langle x \\rangle_{\\pm}$，我们求得主应力：\n$$ \\sigma_{1} = \\frac{\\partial \\psi}{\\partial \\varepsilon_{1}} = (1-d)^{2} \\left[ \\lambda \\langle \\varepsilon_{1}+\\varepsilon_{2} \\rangle_{+} + 2\\mu \\langle \\varepsilon_{1} \\rangle_{+} \\right] + \\left[ \\lambda \\langle \\varepsilon_{1}+\\varepsilon_{2} \\rangle_{-} + 2\\mu \\langle \\varepsilon_{1} \\rangle_{-} \\right] $$\n$$ \\sigma_{2} = \\frac{\\partial \\psi}{\\partial \\varepsilon_{2}} = (1-d)^{2} \\left[ \\lambda \\langle \\varepsilon_{1}+\\varepsilon_{2} \\rangle_{+} + 2\\mu \\langle \\varepsilon_{2} \\rangle_{+} \\right] + \\left[ \\lambda \\langle \\varepsilon_{1}+\\varepsilon_{2} \\rangle_{-} + 2\\mu \\langle \\varepsilon_{2} \\rangle_{-} \\right] $$\n问题指定了纯剪切状态，其应变张量为：\n$$ \\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0  \\gamma/2 \\\\ \\gamma/2  0 \\end{pmatrix} $$\n主应变是该矩阵的特征值，通过求解特征方程 $\\det(\\boldsymbol{\\varepsilon} - \\varepsilon\\boldsymbol{I}) = 0$ 得到 $\\varepsilon^2 - (\\gamma/2)^2 = 0$。因此主应变为 $\\varepsilon_{1} = \\frac{\\gamma}{2}$ 和 $\\varepsilon_{2} = -\\frac{\\gamma}{2}$。我们不失一般性地假设 $\\gamma0$；最终结果将被证明对任何 $\\gamma$ 都有效。\n\n主轴 $\\boldsymbol{n}_{1}, \\boldsymbol{n}_{2}$ 是对应的特征向量。对于 $\\varepsilon_1 = \\gamma/2$，特征向量为 $\\boldsymbol{n}_{1} = \\frac{1}{\\sqrt{2}}(1,1)^T$。对于 $\\varepsilon_2 = -\\gamma/2$，特征向量为 $\\boldsymbol{n}_{2} = \\frac{1}{\\sqrt{2}}(1,-1)^T$。从主基到笛卡尔基的转换矩阵是 $Q = [\\boldsymbol{n}_1|\\boldsymbol{n}_2]$。\n\n我们现在为该应变状态计算主应力表达式中的各项。假设 $\\gamma > 0$：\n$$ \\varepsilon_{1} = \\frac{\\gamma}{2} > 0 \\implies \\langle\\varepsilon_{1}\\rangle_{+} = \\frac{\\gamma}{2}, \\quad \\langle\\varepsilon_{1}\\rangle_{-} = 0 $$\n$$ \\varepsilon_{2} = -\\frac{\\gamma}{2}  0 \\implies \\langle\\varepsilon_{2}\\rangle_{+} = 0, \\quad \\langle\\varepsilon_{2}\\rangle_{-} = -\\frac{\\gamma}{2} $$\n应变的迹为 $\\operatorname{tr}\\boldsymbol{\\varepsilon} = \\varepsilon_{1}+\\varepsilon_{2} = 0$。因此，\n$$ \\langle \\varepsilon_{1}+\\varepsilon_{2} \\rangle_{\\pm} = \\langle 0 \\rangle_{\\pm} = 0 $$\n将这些值代入主应力的表达式：\n$$ \\sigma_{1} = (1-d)^{2} \\left[ \\lambda(0) + 2\\mu \\left(\\frac{\\gamma}{2}\\right) \\right] + \\left[ \\lambda(0) + 2\\mu(0) \\right] = (1-d)^{2}\\mu\\gamma $$\n$$ \\sigma_{2} = (1-d)^{2} \\left[ \\lambda(0) + 2\\mu(0) \\right] + \\left[ \\lambda(0) + 2\\mu \\left(-\\frac{\\gamma}{2}\\right) \\right] = -\\mu\\gamma $$\n主基中的应力张量为 $\\boldsymbol{\\sigma}_{\\text{princ}} = \\operatorname{diag}(\\sigma_{1}, \\sigma_{2})$。为了找到原始笛卡尔基中的分量，我们进行基变换：$\\boldsymbol{\\sigma} = Q \\boldsymbol{\\sigma}_{\\text{princ}} Q^T$。\n$$ \\boldsymbol{\\sigma} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} \\sigma_{1}  0 \\\\ 0  \\sigma_{2} \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} \\sigma_{1}+\\sigma_{2}  \\sigma_{1}-\\sigma_{2} \\\\ \\sigma_{1}-\\sigma_{2}  \\sigma_{1}+\\sigma_{2} \\end{pmatrix} $$\n我们感兴趣的是剪应力分量 $\\sigma_{12}$：\n$$ \\sigma_{12} = \\frac{1}{2}(\\sigma_{1}-\\sigma_{2}) = \\frac{1}{2} \\left( (1-d)^{2}\\mu\\gamma - (-\\mu\\gamma) \\right) $$\n$$ \\sigma_{12} = \\frac{1}{2} (\\mu\\gamma(1-d)^{2} + \\mu\\gamma) = \\frac{\\mu\\gamma}{2} \\left( (1-d)^{2} + 1 \\right) $$\n此表达式可简化为 $\\sigma_{12} = \\mu\\gamma(1-d+\\frac{1}{2}d^2)$。\n如果我们假设 $\\gamma  0$，那么 $\\varepsilon_1 = \\gamma/2  0$ 且 $\\varepsilon_2 = -\\gamma/2 > 0$。重新命名主应变，使得 $\\varepsilon_1$ 为正、$\\varepsilon_2$ 为负，将对应于交换特征向量。计算过程完全相同，但用 $|\\gamma|$ 代替 $\\gamma$，并且最终变换回原始坐标时会重新引入 $\\gamma$ 的正确符号，得到相同的最终表达式。因此，该公式是通用的。\n作为检验，对于未损伤材料（$d=0$），我们恢复了线性弹性结果 $\\sigma_{12} = \\frac{\\mu\\gamma}{2}(1+1) = \\mu\\gamma$。对于完全损伤材料（$d=1$），$\\sigma_{12} = \\frac{\\mu\\gamma}{2}(0+1) = \\frac{\\mu\\gamma}{2}$。剩余的刚度是由于未损伤的压缩响应。\n所要求的 $\\sigma_{12}$ 的闭式解析表达式为：\n$$ \\sigma_{12}(d, \\gamma, \\mu) = \\frac{\\mu\\gamma}{2} \\left(1 + (1-d)^{2}\\right) $$", "answer": "$$\n\\boxed{\\frac{\\mu\\gamma}{2}\\left(1 + (1-d)^{2}\\right)}\n$$", "id": "2924539"}, {"introduction": "从连续介质理论到工程应用，本练习将引导你为耦合损伤-塑性模型开发数值算法。你将实现一个返回映射算法（return-mapping algorithm），这是计算力学中的标准技术，并推导一致切线算子（consistent tangent operator），它对有限元模拟的稳定性和效率至关重要。这项实践将理论付诸实践，展示了如何将控制方程离散化并进行数值求解 [@problem_id:2924524]。", "problem": "考虑一个一维小应变弹塑性材料，其具有一个内蕴标量损伤变量，并在一个热力学一致性框架内进行描述。其本构结构由单位参考体积的Helmholtz自由能密度指定\n$$\n\\psi(\\varepsilon,\\varepsilon^p,\\alpha,d)\n= (1-d)\\,\\frac{E}{2}\\,(\\varepsilon-\\varepsilon^p)^2 + \\frac{H}{2}\\,\\alpha^2 + \\frac{a}{2}\\,d^2,\n$$\n其中 $\\varepsilon$ 是总应变，$\\varepsilon^p$ 是塑性应变，$\\alpha$ 是累积塑性应变（各向同性硬化变量），$d\\in[0,1)$ 是损伤变量，$E$ 是弹性模量，$H$ 是塑性硬化模量，$a$ 是损伤硬化模量。此问题中的所有量均为无量纲；输出中无需物理单位。\n\n应力和热力学力遵循标准的热力学共轭关系。Cauchy应力为\n$$\n\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon} = (1-d)\\,E\\,(\\varepsilon-\\varepsilon^p),\n$$\n并定义有效应力\n$$\n\\tilde{\\sigma} = E\\,(\\varepsilon-\\varepsilon^p).\n$$\n塑性屈服函数为\n$$\nf_p(\\tilde{\\sigma},\\alpha) = |\\tilde{\\sigma}| - (\\sigma_{y0} + H\\,\\alpha)\\le 0,\n$$\n其中 $\\sigma_{y0}$ 是初始屈服应力。塑性流动是关联的，其法向为 $n=\\mathrm{sign}(\\tilde{\\sigma})$，塑性乘子 $\\lambda\\ge 0$ 满足率无关的Karush–Kuhn–Tucker (KKT) 条件：\n$$\n\\dot{\\varepsilon}^p = \\lambda\\,n,\\quad \\dot{\\alpha}=\\lambda,\\quad f_p\\le 0,\\ \\lambda\\ge 0,\\ \\lambda f_p=0.\n$$\n与损伤共轭的能量释放率为\n$$\nY = -\\frac{\\partial \\psi}{\\partial d} = \\frac{E}{2}\\,(\\varepsilon-\\varepsilon^p)^2 - a\\,d,\n$$\n损伤以率无关的方式演化，由阈值 $Y_0$ 通过以下准则控制\n$$\ng(Y) = Y - Y_0 \\le 0,\\quad \\dot{d}\\ge 0,\\quad \\dot{d}\\,g=0,\n$$\n并带有不可逆性约束 $d(t+\\Delta t)\\ge d(t)$。\n\n使用从步骤 $n$ 到 $n+1$ 的后向欧拉时间离散，构建一个回映算法，用于在给定应变 $\\varepsilon_{n+1}$ 的情况下，从已知状态 $(\\varepsilon^p_n,\\alpha_n,d_n)$ 出发，更新 $(\\varepsilon^p,d)$。您的算法必须与上述结构热力学一致，必须尊重 $d$ 的不可逆性，并且必须生成更新后的应力 $\\sigma_{n+1}$ 和一致性算法切线算子（在一维中标量）\n$$\n\\mathbb{D}_{\\text{alg}} = \\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}}.\n$$\n从由热力学第二定律（Clausius–Duhem不等式）、Helmholtz自由能以及塑性和损伤的KKT结构组成的基本基础出发设计算法，不假设除这些定义之外的任何目标公式。您的推导应识别出步骤结束时的激活集，并为每种激活/非激活组合生成 $(\\varepsilon^p_{n+1},\\alpha_{n+1},d_{n+1})$ 和 $\\mathbb{D}_{\\text{alg}}$ 的闭式更新表达式。\n\n您的程序必须实现最终的算法，并为下面的每个测试案例计算元组 $[\\sigma_{n+1},\\ \\mathbb{D}_{\\text{alg}},\\ \\varepsilon^p_{n+1},\\ d_{n+1}]$ 作为浮点数。所有测试案例均使用初始状态 $(\\varepsilon^p_n,\\alpha_n,d_n)=(0,0,0)$。所有量均为无量纲。如果损伤将超过或等于1，则将其限制在 $d_{\\max}=0.999$。\n\n测试套件（每个案例为 $(E,H,a,Y_0,\\sigma_{y0},\\varepsilon_{n+1})$）：\n- 案例 A（损伤的弹性边界）：$(200, 50, 400, 1, 50, 0.1)$，其中 $200$, $50$, $400$, $1$, $50$, $0.1$ 是各自的参数值。\n- 案例 B（仅损伤，塑性非激活）：$(200, 50, 100, 10, 150, 0.7)$。\n- 案例 C（仅塑性，损伤非激活）：$(200, 50, 100, 1000000, 50, 1.0)$。\n- 案例 D（塑性和损伤均激活）：$(200, 50, 100, 5, 50, 1.0)$。\n- 案例 E（极端损伤被限制）：$(200, 50, 10, 0, 1000, 3.0)$。\n\n您的程序应生成单行输出，其中包含结果，格式为以逗号分隔的方括号列表，并严格按照测试案例的顺序，例如\n\"[[r11,r12,r13,r14],[r21,r22,r23,r24],...]\"，其中每个 $r_{ij}$ 都是一个浮点数。", "solution": "该问题要求为一个具有耦合弹塑性和损伤的一维材料模型，构建并实现一个热力学一致的回映算法。推导必须源自所提供的本构关系和使用后向欧拉格式离散化的演化定律。\n\n首先，我们必须验证问题的陈述。所提供的框架，由Helmholtz自由能势 $\\psi$、应力 $\\sigma$ 和热力学力 $Y$ 的定义，以及由Karush-Kuhn-Tucker (KKT) 条件控制的塑性和损伤的率无关演化定律组成，构成了一个标准的、尽管是特定的连续介质损伤力学模型。该公式具有科学依据，是客观且适定的。给定的本构结构定义了一种单向耦合：塑性的演化（由有效应力 $\\tilde{\\sigma}$ 控制）独立于损伤变量 $d$，而损伤的演化（由能量释放率 $Y$ 控制）则通过有效应力依赖于塑性状态。这一结构特征显著简化了数值算法。尽管这类公式的某些形式在所有条件下都可能在耗散的非负性方面带来挑战，但该问题作为一个实现给定模型的指令是明确定义的。我们继续进行推导。\n\n令时间 $t_n$ 的状态已知：$(\\varepsilon^p_n, \\alpha_n, d_n)$。给定时间 $t_{n+1}$ 的总应变 $\\varepsilon_{n+1}$，我们必须找到更新后的状态 $(\\varepsilon^p_{n+1}, \\alpha_{n+1}, d_{n+1})$。为清晰起見，我们省略当前步骤变量的下标 $n+1$。演化定律的后向欧拉离散给出：\n$$\n\\varepsilon^p = \\varepsilon^p_n + \\Delta\\lambda\\,n\n$$\n$$\n\\alpha = \\alpha_n + \\Delta\\lambda\n$$\n$$\nd = d_n + \\Delta d\n$$\n其中 $\\Delta\\lambda \\ge 0$ 是塑性乘子增量，$\\Delta d \\ge 0$ 是损伤增量，它在率无关的损伤演化中充当乘子。在步骤结束时，变量必须满足离散的KKT条件：\n对于塑性：$\\Delta\\lambda \\ge 0, \\quad f_p(\\tilde{\\sigma}, \\alpha) \\le 0, \\quad \\Delta\\lambda\\,f_p = 0$。\n对于损伤：$\\Delta d \\ge 0, \\quad g(Y) \\le 0, \\quad \\Delta d\\,g = 0$。\n\n回映算法基于算子分裂：一个弹性试探步，如有必要，再跟一个塑性/损伤修正步。\n\n**1. 弹性试探步**\n我们将内变量冻结在前一步的值：\n$\\varepsilon^p_{tr} = \\varepsilon^p_n$, $\\alpha_{tr} = \\alpha_n$, $d_{tr} = d_n$。\n计算试探有效应力：\n$$\n\\tilde{\\sigma}_{tr} = E(\\varepsilon - \\varepsilon^p_n)\n$$\n然后，我们评估试探屈服函数和损伤函数：\n$$\nf_{p,tr} = |\\tilde{\\sigma}_{tr}| - (\\sigma_{y0} + H\\alpha_n)\n$$\n$$\nY_{tr} = \\frac{1}{2E}|\\tilde{\\sigma}_{tr}|^2 - a d_n \\quad \\implies \\quad g_{tr} = Y_{tr} - Y_0\n$$\n\n**2. 修正步与状态更新**\n单向耦合允许采用顺序更新程序。我们首先处理塑性，然后处理损伤。\n\n**2a. 塑性修正**\n我们检查塑性准则 $f_{p,tr}$。\n如果 $f_{p,tr} \\le 0$，则该步相对于塑性是弹性的。塑性变量不发生变化：$\\varepsilon^p_{p} = \\varepsilon^p_n$ 和 $\\alpha_{p} = \\alpha_n$。此阶段后的有效应力为 $\\tilde{\\sigma}_{p} = \\tilde{\\sigma}_{tr}$。\n如果 $f_{p,tr}  0$，则发生塑性流动。我们在步骤结束时强制执行屈服条件 $f_p=0$：\n$$\n|\\tilde{\\sigma}| - (\\sigma_{y0} + H\\alpha) = 0\n$$\n代入离散演化方程，其中 $\\tilde{\\sigma} = \\tilde{\\sigma}_{tr} - E\\Delta\\lambda\\,n$（$n = \\mathrm{sign}(\\tilde{\\sigma}_{tr})$）和 $\\alpha = \\alpha_n + \\Delta\\lambda$：\n$$\n|\\tilde{\\sigma}_{tr}| - E\\Delta\\lambda - (\\sigma_{y0} + H(\\alpha_n + \\Delta\\lambda)) = 0\n$$\n$$\n(|\\tilde{\\sigma}_{tr}| - (\\sigma_{y0} + H\\alpha_n)) - (E+H)\\Delta\\lambda = 0 \\quad \\implies \\quad f_{p,tr} = (E+H)\\Delta\\lambda\n$$\n塑性乘子可求得：\n$$\n\\Delta\\lambda = \\frac{f_{p,tr}}{E+H}\n$$\n内变量被更新到一个中间状态（塑性后，损伤前）：\n$$\n\\varepsilon^p_{p} = \\varepsilon^p_n + \\Delta\\lambda\\,n, \\quad \\alpha_{p} = \\alpha_n + \\Delta\\lambda\n$$\n此阶段的有效应力为 $\\tilde{\\sigma}_{p} = E(\\varepsilon - \\varepsilon^p_{p})$。注意 $|\\tilde{\\sigma}_{p}| = \\sigma_{y0} + H\\alpha_{p}$。\n\n**2b. 损伤修正**\n使用来自塑性修正器的状态 $(\\varepsilon^p_{p}, \\alpha_{p})$，我们现在检查损伤演化。有效应力为 $\\tilde{\\sigma}_{p}$。\n我们基于此状态计算能量释放率，但使用旧的损伤值 $d_n$：\n$$\nY_{p} = \\frac{1}{2E}|\\tilde{\\sigma}_{p}|^2 - a d_n\n$$\n并检查损伤准则 $g_{p} = Y_{p} - Y_0$。\n如果 $g_{p} \\le 0$，则不发生损伤演化。最终损伤为 $d_{n+1} = d_n$。\n如果 $g_{p}  0$，则损伤演化。我们在最终状态强制执行损伤条件 $g=0$：\n$$\nY_{n+1} = \\frac{1}{2E}|\\tilde{\\sigma}_{p}|^2 - a d_{n+1} = Y_0\n$$\n代入 $d_{n+1} = d_n + \\Delta d$：\n$$\n\\frac{1}{2E}|\\tilde{\\sigma}_{p}|^2 - a(d_n + \\Delta d) = Y_0 \\quad \\implies \\quad (Y_{p} + ad_n) - a(d_n + \\Delta d) = Y_0\n$$\n$$\nY_{p} - a\\Delta d = Y_0 \\quad \\implies \\quad \\Delta d = \\frac{Y_{p} - Y_0}{a} = \\frac{g_{p}}{a}\n$$\n最终损伤为 $d_{n+1} = d_n + \\Delta d$。问题指定了上限 $d_{\\max}=0.999$，所以我们强制 $d_{n+1} = \\min(d_n + \\Delta d, d_{\\max})$。\n最终状态变量为 $(\\varepsilon^p_{n+1}, \\alpha_{n+1}, d_{n+1}) = (\\varepsilon^p_p, \\alpha_p, d_{n+1})$。\n最终应力为 $\\sigma_{n+1} = (1-d_{n+1})\\tilde{\\sigma}_{p}$。\n\n**3. 一致性算法切线算子**\n隐式有限元求解器需要一致性切线算子 $\\mathbb{D}_{\\text{alg}} = \\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}}$。\n$$\n\\sigma_{n+1} = (1-d_{n+1})\\tilde{\\sigma}_{p} \\implies \\mathbb{D}_{\\text{alg}} = -\\frac{\\partial d_{n+1}}{\\partial \\varepsilon_{n+1}}\\tilde{\\sigma}_{p} + (1-d_{n+1})\\frac{\\partial \\tilde{\\sigma}_{p}}{\\partial \\varepsilon_{n+1}}\n$$\n我们需要最终状态变量相对于总应变 $\\varepsilon \\equiv \\varepsilon_{n+1}$ 的导数。\n令 $I_p = 1$ 如果塑性被激活（$f_{p,tr}0$），否则 $I_p=0$。\n塑性后有效应力的导数为：\n$$\n\\frac{\\partial \\tilde{\\sigma}_{p}}{\\partial \\varepsilon} = E\\left(1 - \\frac{\\partial \\varepsilon^p_{p}}{\\partial \\varepsilon}\\right) = E\\left(1 - I_p \\frac{\\partial \\Delta\\lambda}{\\partial \\varepsilon} n\\right) = E\\left(1 - I_p \\frac{1}{E+H}\\frac{\\partial f_{p,tr}}{\\partial \\varepsilon}n\\right)\n$$\n因为 $\\frac{\\partial f_{p,tr}}{\\partial \\varepsilon} = \\frac{\\partial}{\\partial \\varepsilon}(|\\tilde{\\sigma}_{tr}| - C) = n \\frac{\\partial \\tilde{\\sigma}_{tr}}{\\partial \\varepsilon} = nE$，我们得到：\n$$\n\\frac{\\partial \\tilde{\\sigma}_{p}}{\\partial \\varepsilon} = E(1 - I_p \\frac{En}{E+H}n) = E(1 - I_p\\frac{E}{E+H}) = (1-I_p)E + I_p\\frac{EH}{E+H} \\equiv E^{p}_{alg}\n$$\n令 $I_d=1$ 如果损伤被激活（$g_{p}0$ 且未达到上限），否则 $I_d=0$。\n$$\nd_{n+1} = d_n + I_d \\frac{g_p}{a} = d_n + \\frac{I_d}{a}\\left(\\frac{1}{2E}|\\tilde{\\sigma}_{p}|^2 - ad_n - Y_0\\right)\n$$\n$$\n\\frac{\\partial d_{n+1}}{\\partial \\varepsilon} = \\frac{I_d}{a}\\frac{\\partial}{\\partial \\varepsilon}\\left(\\frac{|\\tilde{\\sigma}_{p}|^2}{2E}\\right) = \\frac{I_d}{aE} \\tilde{\\sigma}_{p} \\frac{\\partial\\tilde{\\sigma}_{p}}{\\partial\\varepsilon} = \\frac{I_d}{aE}\\tilde{\\sigma}_{p} E^p_{alg}\n$$\n如果损伤达到上限（$d_{n+1}=d_{\\max}$），它相对于 $\\varepsilon$ 的微分变化是常数，所以 $\\frac{\\partial d_{n+1}}{\\partial \\varepsilon} = 0$。这种情况通过设置 $I_d=0$ 来覆盖。\n代入 $\\mathbb{D}_{\\text{alg}}$ 的表达式中：\n$$\n\\mathbb{D}_{\\text{alg}} = -\\left(\\frac{I_d}{aE}\\tilde{\\sigma}_{p} E^p_{alg}\\right)\\tilde{\\sigma}_{p} + (1-d_{n+1})E^p_{alg} = \\left(1-d_{n+1} - I_d\\frac{|\\tilde{\\sigma}_{p}|^2}{aE}\\right)E^p_{alg}\n$$\n这一个表达式为所有四种基本情况提供了正确的切线：\n- 弹性 (E): $I_p=0, I_d=0 \\implies \\mathbb{D}_{\\text{alg}} = (1-d_n)E$。\n- 仅塑性 (P): $I_p=1, I_d=0 \\implies \\mathbb{D}_{\\text{alg}} = (1-d_n)\\frac{EH}{E+H}$。\n- 仅损伤 (D): $I_p=0, I_d=1 \\implies \\mathbb{D}_{\\text{alg}} = (1-d_{n+1} - \\frac{|\\tilde{\\sigma}_{tr}|^2}{aE})E$。\n- 塑性与损伤 (PD): $I_p=1, I_d=1 \\implies \\mathbb{D}_{\\text{alg}} = \\left(1-d_{n+1} - \\frac{|\\tilde{\\sigma}_{p}|^2}{aE}\\right)\\frac{EH}{E+H}$。\n当损伤被限制时，包含 $|\\tilde{\\sigma}_p|^2$ 的项消失，正确地反映了固定损伤值下的切线。", "answer": "[[20.0,200.0,0.0,0.0],[85.4,-74.0,0.0,0.39],[80.0,40.0,0.6,0.0],[71.2,22.8,0.6,0.11],[0.6,0.2,0.0,0.999]]", "id": "2924524"}]}