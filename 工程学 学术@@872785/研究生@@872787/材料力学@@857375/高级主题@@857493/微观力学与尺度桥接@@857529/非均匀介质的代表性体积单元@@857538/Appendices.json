{"hands_on_practices": [{"introduction": "当我们面对一种微观结构未知的非均质材料时，如何估算其等效性能？本练习将介绍一种强大的分析方法，利用变分原理，仅根据各组分的体积分数和材料属性，建立严格的性能上、下限——即Voigt和Reuss界。掌握这种方法使您能够进行“最坏情况”下的设计估算，这是材料工程中的一项基本技能。 [@problem_id:2913611]", "problem": "一个两相、统计各向同性的线性弹性复合材料通过一个代表性体积单元 (RVE) 进行建模，该 RVE 包含体积模量为 $K_{1}$、体积分数为 $f_{1}$ 的第 1 相（柔性相），以及体积模量为 $K_{2}$、体积分数为 $f_{2}=1-f_{1}$ 的第 2 相（刚性相）。RVE 内部各相的微观结构排布是完全未知的。已知条件仅为：组分相是各向同性和线性弹性的，复合材料在 RVE 的意义上是宏观各向同性的，并且体积模量的对比度很高。\n\n从 Hill-Mandel 宏观均匀性条件和线性弹性变分原理（针对给定应变的最小势能原理和针对给定应力的余能原理）出发，推导 RVE 等效体积模量 $K_{\\mathrm{eff}}$ 的严格能量界，该能量界仅依赖于 $\\{K_{1},K_{2},f_{1},f_{2}\\}$，而与任何微观结构细节无关。使用这些界定一个 $K_{\\mathrm{eff}}$ 的最坏情况估计，该估计在 RVE 中各相的任何排布下都得到保证。\n\n然后，将问题具体化到以下高对比度数据：\n- $K_{1}=2.2~\\text{GPa}$，\n- $K_{2}=220~\\text{GPa}$，\n- $f_{2}=0.15$ 且 $f_{1}=0.85$。\n\n计算由您推导的界所蕴含的 $K_{\\mathrm{eff}}$ 的最坏情况估计。用 $\\text{GPa}$ 表示您的最终答案，并将结果四舍五入到四位有效数字。", "solution": "问题陈述在科学上是合理的、自洽的且适定的。它提出了复合材料微观力学中的一个经典问题，即等效体积模量的 Voigt-Reuss 界的推导。所有必要的数据和条件都已提供。我们可以开始求解。\n\n问题的核心在于将复合材料的宏观等效属性与其微观组分联系起来。这是通过代表性体积单元 (RVE) 的概念实现的，在该单元上对微观场（应力 $\\boldsymbol{\\sigma}(\\mathbf{x})$、应变 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$）进行体积平均，从而定义宏观场（$\\bar{\\boldsymbol{\\sigma}}$、$\\bar{\\boldsymbol{\\varepsilon}}$）。\n宏观应力 $\\bar{\\boldsymbol{\\sigma}}$ 和宏观应变 $\\bar{\\boldsymbol{\\varepsilon}}$ 定义为：\n$$\n\\bar{\\boldsymbol{\\sigma}} = \\frac{1}{V} \\int_{\\Omega} \\boldsymbol{\\sigma}(\\mathbf{x}) dV = \\langle \\boldsymbol{\\sigma} \\rangle\n$$\n$$\n\\bar{\\boldsymbol{\\varepsilon}} = \\frac{1}{V} \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{x}) dV = \\langle \\boldsymbol{\\varepsilon} \\rangle\n$$\n其中 $\\Omega$ 是体积为 $V$ 的 RVE 的域。等效本构关系将这些宏观量联系起来：$\\bar{\\boldsymbol{\\sigma}} = \\mathbf{C}_{\\mathrm{eff}} : \\bar{\\boldsymbol{\\varepsilon}}$，其中 $\\mathbf{C}_{\\mathrm{eff}}$ 是等效刚度张量。\n\nHill-Mandel 宏观均匀性条件提供了连接这两个尺度的关键能量关系。它指出，宏观应变能密度等于微观应变能密度的体积平均值：\n$$\n\\bar{\\boldsymbol{\\sigma}} : \\bar{\\boldsymbol{\\varepsilon}} = \\langle \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon} \\rangle\n$$\n例如，在施加于 RVE 的均匀应变或均匀应力边界条件下，该条件得以满足。\n\n问题具体关注等效体积模量 $K_{\\mathrm{eff}}$。对于宏观各向同性材料，它通过 $\\bar{\\sigma}_h = K_{\\mathrm{eff}} \\bar{\\varepsilon}_v$ 将平均静水应力 $\\bar{\\sigma}_h = \\frac{1}{3}\\mathrm{tr}(\\bar{\\boldsymbol{\\sigma}})$ 和平均体积应变 $\\bar{\\varepsilon}_v = \\mathrm{tr}(\\bar{\\boldsymbol{\\varepsilon}})$ 联系起来。\n\n为推导这些界，我们采用变分原理。\n\n**上界 (Voigt 界)**\n\n最小势能原理指出，对于边界上承受给定（导致了给定的平均应变 $\\bar{\\boldsymbol{\\varepsilon}}$）位移的物体，其实际应变场 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 使总势能最小化。复合材料的应变能密度为 $W(\\bar{\\boldsymbol{\\varepsilon}}) = \\frac{1}{2} \\bar{\\boldsymbol{\\varepsilon}} : \\mathbf{C}_{\\mathrm{eff}} : \\bar{\\boldsymbol{\\varepsilon}}$。任何运动学容许应变场 $\\boldsymbol{\\varepsilon}^*(\\mathbf{x})$（即，可从满足边界条件的连续位移场导出的场）产生的能量将大于或等于实际能量。\n我们选择一个简单的试探场：在整个 RVE 中应变均匀，即 $\\boldsymbol{\\varepsilon}^*(\\mathbf{x}) = \\bar{\\boldsymbol{\\varepsilon}}$。该场是运动学容许的。此试探场的应变能密度为：\n$$\nW^* = \\langle \\frac{1}{2} \\boldsymbol{\\varepsilon}^* : \\mathbf{C}(\\mathbf{x}) : \\boldsymbol{\\varepsilon}^* \\rangle = \\frac{1}{2} \\langle \\bar{\\boldsymbol{\\varepsilon}} : \\mathbf{C}(\\mathbf{x}) : \\bar{\\boldsymbol{\\varepsilon}} \\rangle = \\frac{1}{2} \\bar{\\boldsymbol{\\varepsilon}} : \\langle \\mathbf{C}(\\mathbf{x}) \\rangle : \\bar{\\boldsymbol{\\varepsilon}}\n$$\n根据该原理，$W \\le W^*$，这意味着：\n$$\n\\frac{1}{2} \\bar{\\boldsymbol{\\varepsilon}} : \\mathbf{C}_{\\mathrm{eff}} : \\bar{\\boldsymbol{\\varepsilon}} \\le \\frac{1}{2} \\bar{\\boldsymbol{\\varepsilon}} : \\langle \\mathbf{C} \\rangle : \\bar{\\boldsymbol{\\varepsilon}}\n$$\n这给出了以刚度张量表示的界：$\\mathbf{C}_{\\mathrm{eff}} \\le \\langle \\mathbf{C} \\rangle$。平均刚度张量是组分刚度的体积分数加权平均值：$\\langle \\mathbf{C} \\rangle = f_1 \\mathbf{C}_1 + f_2 \\mathbf{C}_2$。\n对于各向同性组分，刚度张量 $\\mathbf{C}_i$ 可以用体积模量 $K_i$ 和剪切模量 $G_i$ 分解为球量和偏量部分。体积模量对应于刚度张量的球量部分。因此，不等式 $\\mathbf{C}_{\\mathrm{eff}} \\le \\langle \\mathbf{C} \\rangle$ 意味着体积模量有类似的不等式：\n$$\nK_{\\mathrm{eff}} \\le f_1 K_1 + f_2 K_2 \\equiv K_V\n$$\n这是 Voigt 上界，代表了一种混合律。\n\n**下界 (Reuss 界)**\n\n最小余能原理（或卡氏第二定理）指出，对于边界上承受给定（导致了给定的平均应力 $\\bar{\\boldsymbol{\\sigma}}$）面力的物体，其实际应力场 $\\boldsymbol{\\sigma}(\\mathbf{x})$ 使总余能最小化。复合材料的余应变能密度为 $W^c(\\bar{\\boldsymbol{\\sigma}}) = \\frac{1}{2} \\bar{\\boldsymbol{\\sigma}} : \\mathbf{S}_{\\mathrm{eff}} : \\bar{\\boldsymbol{\\sigma}}$，其中 $\\mathbf{S}_{\\mathrm{eff}} = \\mathbf{C}_{\\mathrm{eff}}^{-1}$ 是等效柔度张量。任何静力学容许应力场 $\\boldsymbol{\\sigma}^*(\\mathbf{x})$（即，满足平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma}^* = \\mathbf{0}$ 和面力边界条件的场）将产生大于或等于实际值的余能。\n我们选择一个均匀应力试探场：$\\boldsymbol{\\sigma}^*(\\mathbf{x}) = \\bar{\\boldsymbol{\\sigma}}$。该场是静力学容许的。此试探场的余能密度为：\n$$\nW^{c*} = \\langle \\frac{1}{2} \\boldsymbol{\\sigma}^* : \\mathbf{S}(\\mathbf{x}) : \\boldsymbol{\\sigma}^* \\rangle = \\frac{1}{2} \\langle \\bar{\\boldsymbol{\\sigma}} : \\mathbf{S}(\\mathbf{x}) : \\bar{\\boldsymbol{\\sigma}} \\rangle = \\frac{1}{2} \\bar{\\boldsymbol{\\sigma}} : \\langle \\mathbf{S}(\\mathbf{x}) \\rangle : \\bar{\\boldsymbol{\\sigma}}\n$$\n根据该原理，$W^c \\le W^{c*}$，这意味着：\n$$\n\\frac{1}{2} \\bar{\\boldsymbol{\\sigma}} : \\mathbf{S}_{\\mathrm{eff}} : \\bar{\\boldsymbol{\\sigma}} \\le \\frac{1}{2} \\bar{\\boldsymbol{\\sigma}} : \\langle \\mathbf{S} \\rangle : \\bar{\\boldsymbol{\\sigma}}\n$$\n这给出了以柔度张量表示的界：$\\mathbf{S}_{\\mathrm{eff}} \\le \\langle \\mathbf{S} \\rangle$。平均柔度为 $\\langle \\mathbf{S} \\rangle = f_1 \\mathbf{S}_1 + f_2 \\mathbf{S}_2$。\n由于刚度张量和柔度张量互为逆矩阵且为正定，此不等式可以反转为 $\\mathbf{C}_{\\mathrm{eff}} \\ge \\langle \\mathbf{S} \\rangle^{-1}$。\n对于各向同性组分，与体积行为相关的柔量是 $1/K_i$。柔度张量的不等式意味着体积柔量有如下不等式：\n$$\n\\frac{1}{K_{\\mathrm{eff}}} \\le \\frac{f_1}{K_1} + \\frac{f_2}{K_2}\n$$\n反转此式可得到等效体积模量的下界：\n$$\nK_{\\mathrm{eff}} \\ge \\left( \\frac{f_1}{K_1} + \\frac{f_2}{K_2} \\right)^{-1} \\equiv K_R\n$$\n这是 Reuss 下界。\n\n综合这些结果，我们得到了与微观结构细节无关的等效体积模量的严格界：\n$$\n\\left( \\frac{f_1}{K_1} + \\frac{f_2}{K_2} \\right)^{-1} \\le K_{\\mathrm{eff}} \\le f_1 K_1 + f_2 K_2\n$$\n\n**最坏情况估计**\n\n问题要求给出 $K_{\\mathrm{eff}}$ 的“最坏情况估计”。在工程设计中，特别是在对刚度要求苛刻的应用中，最坏情况对应于必须考虑的最低材料刚度。这保证了设计的保守性。Reuss 下界 $K_R$ 代表了无论组分相如何排列都保证的最小体积模量。因此，最坏情况估计是 $K_R$。\n\n**数值计算**\n\n我们有以下给定数据：\n- $K_1 = 2.2~\\text{GPa}$\n- $K_2 = 220~\\text{GPa}$\n- $f_2 = 0.15$\n- $f_1 = 1 - f_2 = 1 - 0.15 = 0.85$\n\n我们计算 Reuss 下界 $K_R$：\n$$\nK_R = \\left( \\frac{f_1}{K_1} + \\frac{f_2}{K_2} \\right)^{-1} = \\left( \\frac{0.85}{2.2} + \\frac{0.15}{220} \\right)^{-1}\n$$\n进行计算：\n$$\n\\frac{0.85}{2.2} \\approx 0.3863636...\n$$\n$$\n\\frac{0.15}{220} \\approx 0.0006818...\n$$\n$$\nK_R = (0.3863636... + 0.0006818...)^{-1} = (0.38704545...)^{-1} \\approx 2.583675...~\\text{GPa}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nK_{\\text{worst-case}} \\approx 2.584~\\text{GPa}\n$$\n该值代表了复合材料保证的最小等效体积模量。", "answer": "$$\n\\boxed{2.584}\n$$", "id": "2913611"}, {"introduction": "代表性体积单元（RVE）的概念意味着其尺寸必须足够大以具有“代表性”，但“足够大”是多大呢？本练习将带您进入统计学领域来回答这个关键问题，将材料属性视为一个随机场。通过一个连接RVE尺寸与材料相关长度 $\\ell_c$ 的标度律，并将其应用于模拟数据，您将学会如何为给定的误差容限定量地确定所需的RVE尺寸。 [@problem_id:2913670]", "problem": "一个统计均匀、各态遍历的两相复合材料被建模为一个具有有限相关长度 $\\,\\ell_{c}\\,$ 的随机介质，该相关长度由相指示函数的两点相关函数推断得出。考虑表观均质化杨氏模量 $\\,E^{\\ast}(L,\\omega)\\,$，该模量通过在边长为 $\\,L\\,$ 的立方窗口上求解线弹性边值问题计算得出（其中 $\\,\\omega\\,$ 索引独立的微观结构实现）。代表性体积单元（RVE）被定义为最小的 $\\,L\\,$，使得变异系数（定义为 $\\,\\mathrm{COV}(L) \\equiv \\sqrt{\\mathrm{Var}[E^{\\ast}(L,\\omega)]}/\\mathbb{E}[E^{\\ast}(L,\\omega)]\\,$）低于一个指定的容差 $\\,\\varepsilon\\,$。\n\n从平稳、弱相关随机场的空间平均的基本性质以及通过两点相关函数定义的相关长度出发，推导一个形式如下的启发式标度关系\n$$\nL_{\\mathrm{RVE}} \\approx k\\,\\ell_{c},\n$$\n并确定空间的维度 $\\,d\\,$ 和一个无量纲振幅 $\\,A\\,$ 如何进入 $\\,k\\,$。然后解释如何通过改变 $\\,L\\,$ 和估计 $\\,\\mathrm{COV}(L)\\,$，利用数值模拟来校准 $\\,k\\,$。\n\n给定在 $\\,d=3\\,$ 维中，对于 $\\,L/\\ell_{c} \\in \\{2,3,5\\}\\,$ 的立方窗口，通过系综估计得到的三个 $\\,\\mathrm{COV}(L)\\,$ 值：\n- $\\,\\mathrm{COV}(2\\ell_{c}) = 0.1237\\,$,\n- $\\,\\mathrm{COV}(3\\ell_{c}) = 0.06730\\,$,\n- $\\,\\mathrm{COV}(5\\ell_{c}) = 0.03131\\,$.\n\n假设对于足够大的 $\\,L\\,$，$\\,\\mathrm{COV}(L)\\,$ 遵循一个由弱相关场的空间平均的方差标度律决定的、关于 $\\,L/\\ell_{c}\\,$ 的幂律关系。使用上述数据，估计所需的振幅，并确定在目标容差 $\\,\\varepsilon = 0.05\\,$ 下 $\\,k\\,$ 的数值。将你的最终答案 $\\,k\\,$ 四舍五入到四位有效数字。最终答案不带单位。", "solution": "该问题定义明确，并基于随机介质均质化理论的既定原则。我们直接进行求解。\n\n从微观结构实现 $\\omega$ 中，在一个尺寸为 $L$ 的有限采样窗口上计算出的表观宏观属性，例如杨氏模量 $E^{\\ast}(L,\\omega)$，是一个随机变量。当 $L \\to \\infty$ 时，其值围绕真实的均质化模量 $E^{\\mathrm{hom}}$ 波动。收敛速度由底层随机介质的统计特性决定。对于一个以有限相关长度 $\\ell_{c}$ 为特征的统计均匀且各态遍历的介质，空间平均的方差随着平均域的体积增大而衰减。\n\n设表观模量表示为局部属性场 $f(\\mathbf{x})$ 在边长为 $L$、体积为 $L^d$ 的立方域 $V$ 上的体积平均。对于一个大区域（$L \\gg \\ell_{c}$），当边界效应可以忽略不计时，此空间平均的方差 $\\mathrm{Var}[E^{\\ast}(L)]$ 由随机场理论中的一个核心结果给出：\n$$ \\mathrm{Var}[E^{\\ast}(L)] \\approx \\frac{1}{L^d} \\int_{\\mathbb{R}^d} C_{ff}(\\mathbf{r})\\,d\\mathbf{r} $$\n这里，$C_{ff}(\\mathbf{r})$ 是场 $f(\\mathbf{x})$ 的自协方差函数。积分 $\\int_{\\mathbb{R}^d} C_{ff}(\\mathbf{r})\\,d\\mathbf{r}$ 表示积分协方差，其量纲为 $[\\text{方差}] \\times [\\text{长度}]^d$。它与 $\\mathrm{Var}[f] \\ell_{c}^d$ 成正比。这导致了方差的基本标度律：\n$$ \\mathrm{Var}[E^{\\ast}(L)] \\propto L^{-d} $$\n平均值 $\\mathbb{E}[E^{\\ast}(L)]$ 对应于有效模量 $E^{\\mathrm{hom}}$，对于大的 $L$ 而言，它是一个常数。变异系数 $\\mathrm{COV}(L)$ 定义为 $\\sqrt{\\mathrm{Var}[E^{\\ast}(L)]} / \\mathbb{E}[E^{\\ast}(L)]$。因此，它随 $L$ 的标度关系为：\n$$ \\mathrm{COV}(L) \\propto \\sqrt{L^{-d}} = L^{-d/2} $$\n我们可以通过引入一个无量纲振幅参数 $A$ 来将此标度关系表示为一个方程，该参数包含了材料对比度和微观结构细节：\n$$ \\mathrm{COV}(L) = A \\left(\\frac{L}{\\ell_c}\\right)^{-d/2} = A \\left(\\frac{\\ell_c}{L}\\right)^{d/2} $$\n代表性体积单元的尺寸 $L_{\\mathrm{RVE}}$ 由一个实际准则确定：变异系数必须小于一个指定的容差 $\\varepsilon$。我们将 $L_{\\mathrm{RVE}}$ 定义为满足此条件的最小尺寸：\n$$ \\mathrm{COV}(L_{\\mathrm{RVE}}) = \\varepsilon $$\n将此代入标度关系中得到：\n$$ \\varepsilon = A \\left(\\frac{\\ell_c}{L_{\\mathrm{RVE}}}\\right)^{d/2} $$\n对此方程求解 $L_{\\mathrm{RVE}}$ 可得：\n$$ \\left(\\frac{L_{\\mathrm{RVE}}}{\\ell_c}\\right)^{d/2} = \\frac{A}{\\varepsilon} \\implies L_{\\mathrm{RVE}} = \\ell_c \\left(\\frac{A}{\\varepsilon}\\right)^{2/d} $$\n通过将此结果与所提出的形式 $L_{\\mathrm{RVE}} \\approx k\\,\\ell_{c}$ 进行比较，我们确定因子 $k$ 为：\n$$ k = \\left(\\frac{A}{\\varepsilon}\\right)^{2/d} $$\n这个表达式表明，$k$ 由材料的统计特性（通过振幅 $A$）、问题的维度 $d$ 以及用户定义的精度要求 $\\varepsilon$ 共同决定。\n\n$k$ 的校准需要通过数值实验来估计振幅 $A$。研究者需要对一系列区域尺寸 $L_i$ 的多个实现进行模拟。对于每个尺寸，结果的系综提供一个对 $\\mathrm{COV}(L_i)$ 的估计。参数 $A$ 可以通过将模型 $\\mathrm{COV}(L) = A (L/\\ell_c)^{-d/2}$ 拟合到计算出的数据点来确定。对数转换后的数据（$\\ln(\\mathrm{COV})$ vs. $\\ln(L/\\ell_c)$）进行线性回归是一种标准方法，用于验证指数 $-d/2$ 并从截距中找到 $\\ln(A)$。\n\n我们获得了三维情况（$d=3$）的数值数据，其标度律变为：\n$$ \\mathrm{COV}(L) = A \\left(\\frac{L}{\\ell_c}\\right)^{-3/2} $$\n由此，可以使用 $A = \\mathrm{COV}(L) \\cdot (L/\\ell_c)^{3/2}$ 从每个数据点估计振幅 $A$。\n使用所提供的数据：\n对于 $L/\\ell_c = 2$：$A_1 = 0.1237 \\times 2^{3/2} \\approx 0.34988$\n对于 $L/\\ell_c = 3$：$A_2 = 0.06730 \\times 3^{3/2} \\approx 0.34972$\n对于 $L/\\ell_c = 5$：$A_3 = 0.03131 \\times 5^{3/2} \\approx 0.35006$\n\n计算出的 $A$ 值高度一致，这支持了理论模型。我们取平均值作为振幅的最佳估计：\n$$ A = \\frac{A_1 + A_2 + A_3}{3} \\approx \\frac{0.34988 + 0.34972 + 0.35006}{3} \\approx 0.34989 $$\n使用该值 $A \\approx 0.3499$、指定的容差 $\\varepsilon = 0.05$ 和维度 $d=3$，我们计算因子 $k$：\n$$ k = \\left(\\frac{A}{\\varepsilon}\\right)^{2/d} = \\left(\\frac{0.3499}{0.05}\\right)^{2/3} = (6.998)^{2/3} $$\n进行计算：\n$$ k \\approx 3.65853 $$\n按照指示，将结果四舍五入到四位有效数字，得到最终值。", "answer": "$$\\boxed{3.659}$$", "id": "2913670"}, {"introduction": "为了对RVE进行计算分析，我们必须模拟它，就好像它是一个无限重复材料中的一小部分，这需要特殊的边界条件。本练习将指导您从基本的Hill-Mandel条件出发，推导周期性边界条件（PBCs）。对于任何周期性或统计均匀材料的有限元均匀化分析而言，理解并正确实施PBCs是至关重要的实践步骤。 [@problem_id:2913666]", "problem": "给定一个边长为 $L$ 的二维方形代表性体积单元 (RVE)，其中包含周期性方形排列的圆形夹杂物。夹杂相占据 RVE 的体积分数 $f \\in [0,1]$。基体相是线性弹性、各向同性的，其杨氏模量为 $E_m$，泊松比为 $\\nu_m$。夹杂相也是线性弹性、各向同性的，其杨氏模量为 $E_i$，泊松比为 $\\nu_i$。假设无穷小应变和静力平衡。考虑平面应变运动学。\n\n任务 A（周期性边界条件 (PBC) 的建立）：从 Hill–Mandel 宏观均匀性条件和周期性位移波动的定义出发，为 RVE 建立 PBC 的运动学形式。设宏观（体平均）应变为常数张量 $\\boldsymbol{E} \\in \\mathbb{R}^{2 \\times 2}$，且 $\\boldsymbol{E} = \\boldsymbol{E}^\\mathsf{T}$。设微观位移为 $\\boldsymbol{u}(\\boldsymbol{x})$，并将其分解为\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x}),\n$$\n其中 $\\tilde{\\boldsymbol{u}}$ 是一个平均梯度为零的周期性波动。利用这一点推导 RVE 相对边界 $\\Gamma_1$ 和 $\\Gamma_1 + L \\boldsymbol{e}_1$ 以及 $\\Gamma_2$ 和 $\\Gamma_2 + L \\boldsymbol{e}_2$ 上的运动学 PBC，其形式为\n$$\n\\boldsymbol{u}(\\boldsymbol{x} + L \\boldsymbol{e}_1) - \\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,L\\,\\boldsymbol{e}_1,\\quad\n\\boldsymbol{u}(\\boldsymbol{x} + L \\boldsymbol{e}_2) - \\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,L\\,\\boldsymbol{e}_2.\n$$\n论证为何面力条件是反周期性的。确定平面应变问题的独立宏观加载情况的最小集合，并以 Voigt 记法表示，其中应变由向量 $\\boldsymbol{\\varepsilon}_v = [\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12}]^\\mathsf{T}$ 表示，且 $\\gamma_{12} = 2 \\varepsilon_{12}$。\n\n任务 B（与 PBC 一致的等应变条件下的等效刚度）：在与运动学 PBC 一致的等应变假设下，\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{x}) \\equiv \\boldsymbol{E}\\quad \\text{for all } \\boldsymbol{x} \\in \\Omega,\n$$\n从第一性原理推导，Voigt 形式的等效刚度等于局部刚度的体平均，\n$$\n\\boldsymbol{C}_\\text{eff} = \\langle \\boldsymbol{C}(\\boldsymbol{x}) \\rangle = (1 - f)\\,\\boldsymbol{C}_m + f\\,\\boldsymbol{C}_i,\n$$\n其中 $\\boldsymbol{C}_m$ 和 $\\boldsymbol{C}_i$ 分别是基体和夹杂物的平面应变刚度矩阵。对于杨氏模量为 $E$、泊松比为 $\\nu$ 的平面应变各向同性线弹性固体，定义拉梅参数\n$$\n\\mu = \\frac{E}{2(1+\\nu)},\\qquad \\lambda = \\frac{\\nu E}{(1+\\nu)(1-2\\nu)},\n$$\n并证明以 Voigt 记法表示的平面应变刚度矩阵为\n$$\n\\boldsymbol{C} = \n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}.\n$$\n在三个独立的宏观应变加载下，使用 $\\boldsymbol{\\sigma}_v = \\boldsymbol{C}_\\text{eff}\\,\\boldsymbol{\\varepsilon}_v$ 计算相应的平均应力。等效刚度需以吉帕斯卡 (GPa) 为单位报告。\n\n几何说明：在边长为 $L$ 的正方形中，要达到目标体积分数 $f$，圆形夹杂物的半径 $r$ 为\n$$\nr = L \\sqrt{\\frac{f}{\\pi}}.\n$$\n\n数值和输出要求：\n- 全程使用平面应变。\n- 所有输入和输出中的模量均使用吉帕斯卡 (GPa) 单位。\n- 为符合物理现实，$f$ 为无量纲量，无量纲的泊松比严格在 $(0,\\,0.5)$ 范围内。\n- 将独立宏观加载情况的数量确定为一个整数，并将此整数包含在每个测试用例的结果中。\n- 测试套件（五个案例）：\n  1. 案例 1（一般对比度）：$E_m = 70$，$\\nu_m = 0.33$，$E_i = 200$，$\\nu_i = 0.30$，$f = 0.25$。\n  2. 案例 2（边界情况，无夹杂物）：$E_m = 70$，$\\nu_m = 0.33$，$E_i = 200$，$\\nu_i = 0.30$，$f = 0$。\n  3. 案例 3（边界情况，完全是夹杂物）：$E_m = 70$，$\\nu_m = 0.33$，$E_i = 200$，$\\nu_i = 0.30$，$f = 1$。\n  4. 案例 4（模量相等）：$E_m = 100$，$\\nu_m = 0.25$，$E_i = 100$，$\\nu_i = 0.25$，$f = 0.4$。\n  5. 案例 5（软夹杂物）：$E_m = 210$，$\\nu_m = 0.29$，$E_i = 1$，$\\nu_i = 0.49$，$f = 0.3$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个按案例划分的结果列表。每个案例的结果是一个长度为 10 的列表，包含：\n  $[\\text{rank}, C_{11}, C_{12}, C_{13}, C_{21}, C_{22}, C_{23}, C_{31}, C_{32}, C_{33}]$，\n  其中第一个条目是独立加载情况的整数数量，随后的条目是 Voigt 形式的 $\\boldsymbol{C}_\\text{eff}$ 的分量（按行主序），单位为吉帕斯卡 (GPa)，以浮点数表示。因此，最终格式是类似 `[[\\cdots],[\\cdots],\\ldots]` 的单行，使用逗号分隔值且无空格。", "solution": "所提出的问题经验证具有科学依据、是适定的且内部一致。这是连续介质微观力学中的一个标准练习。我们按要求分两部分进行求解。\n\n### 任务 A：周期性边界条件的建立\n\n第一个任务是为周期性代表性体积单元 (RVE) 建立运动学和静力学边界条件，并确定平面应变分析的独立加载模式。\n\n**1. 运动学周期性边界条件 (PBCs) 的推导**\n\nRVE 内的微观位移场 $\\boldsymbol{u}(\\boldsymbol{x})$ 被分解为一个宏观线性变化部分和一个周期性波动部分 $\\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$：\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x})\n$$\n此处，$\\boldsymbol{E}$ 是常数宏观应变张量，$\\boldsymbol{x}$ 是位置向量。波动场 $\\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$ 以 RVE 的周期（一个边长为 $L$ 的正方形）为周期。这种周期性表示为：\n$$\n\\tilde{\\boldsymbol{u}}(\\boldsymbol{x} + L\\boldsymbol{e}_k) = \\tilde{\\boldsymbol{u}}(\\boldsymbol{x}) \\quad \\text{for } k=1, 2\n$$\n其中 $\\boldsymbol{e}_1$ 和 $\\boldsymbol{e}_2$ 是坐标系的标准正交基向量。\n\n为了推导位移场 $\\boldsymbol{u}(\\boldsymbol{x})$ 上的边界条件，我们考虑 RVE 相对边界上的两个点，例如边界 $\\Gamma_1$ 上的点 $\\boldsymbol{x}$ 和相对边界 $\\Gamma_1 + L\\boldsymbol{e}_1$ 上的点 $\\boldsymbol{x} + L\\boldsymbol{e}_1$。\n\n在 $\\boldsymbol{x} + L\\boldsymbol{e}_1$ 处的位移由下式给出：\n$$\n\\boldsymbol{u}(\\boldsymbol{x} + L\\boldsymbol{e}_1) = \\boldsymbol{E}\\,(\\boldsymbol{x} + L\\boldsymbol{e}_1) + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x} + L\\boldsymbol{e}_1)\n$$\n利用波动的周期性，$\\tilde{\\boldsymbol{u}}(\\boldsymbol{x} + L\\boldsymbol{e}_1) = \\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$，表达式变为：\n$$\n\\boldsymbol{u}(\\boldsymbol{x} + L\\boldsymbol{e}_1) = \\boldsymbol{E}\\,\\boldsymbol{x} + \\boldsymbol{E}\\,L\\boldsymbol{e}_1 + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x})\n$$\n这两点之间的位移差则为：\n$$\n\\boldsymbol{u}(\\boldsymbol{x} + L\\boldsymbol{e}_1) - \\boldsymbol{u}(\\boldsymbol{x}) = (\\boldsymbol{E}\\,\\boldsymbol{x} + \\boldsymbol{E}\\,L\\boldsymbol{e}_1 + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x})) - (\\boldsymbol{E}\\,\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}(\\boldsymbol{x}))\n$$\n$$\n\\boldsymbol{u}(\\boldsymbol{x} + L\\boldsymbol{e}_1) - \\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,L\\boldsymbol{e}_1\n$$\n通过对方向 $\\boldsymbol{e}_2$ 的相同论证，我们得到：\n$$\n\\boldsymbol{u}(\\boldsymbol{x} + L\\boldsymbol{e}_2) - \\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{E}\\,L\\boldsymbol{e}_2\n$$\n这两个方程代表了施加在 RVE 边界上位移场 $\\boldsymbol{u}(\\boldsymbol{x})$ 的运动学周期性边界条件。\n\n**2. 面力的反周期性**\n\n相对边界上面力向量 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$ 的反周期性是 Hill-Mandel 宏观均匀性条件的直接结果。该条件将微观功密度的体平均与宏观量的功密度等同起来：\n$$\n\\langle \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon} \\rangle = \\langle \\boldsymbol{\\sigma} \\rangle : \\langle \\boldsymbol{\\varepsilon} \\rangle\n$$\n根据定义，平均应变为 $\\langle \\boldsymbol{\\varepsilon} \\rangle = \\boldsymbol{E}$。代入微观应变 $\\boldsymbol{\\varepsilon} = \\nabla_s \\boldsymbol{u}$ 并在静力平衡条件（$\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$）下使用散度定理，左侧变为：\n$$\n\\langle \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon} \\rangle = \\frac{1}{V} \\int_V \\boldsymbol{\\sigma} : \\nabla_s \\boldsymbol{u} \\, dV = \\frac{1}{V} \\int_{\\partial V} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{u} \\, dS = \\frac{1}{V} \\int_{\\partial V} \\boldsymbol{t} \\cdot \\boldsymbol{u} \\, dS\n$$\n将位移分解 $\\boldsymbol{u} = \\boldsymbol{E}\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}$ 代入边界积分，得到：\n$$\n\\frac{1}{V} \\int_{\\partial V} \\boldsymbol{t} \\cdot (\\boldsymbol{E}\\boldsymbol{x} + \\tilde{\\boldsymbol{u}}) \\, dS = \\frac{1}{V} \\int_{\\partial V} \\boldsymbol{t} \\cdot (\\boldsymbol{E}\\boldsymbol{x}) \\, dS + \\frac{1}{V} \\int_{\\partial V} \\boldsymbol{t} \\cdot \\tilde{\\boldsymbol{u}} \\, dS\n$$\n第一项可以转换回体积分，得到 $\\langle \\boldsymbol{\\sigma} \\rangle : \\boldsymbol{E}$。因此，Hill-Mandel 条件简化为要求第二项为零：\n$$\n\\int_{\\partial V} \\boldsymbol{t} \\cdot \\tilde{\\boldsymbol{u}} \\, dS = 0\n$$\n边界 $\\partial V$ 上的积分可以分解为成对的相对面。对于垂直于 $\\boldsymbol{e}_1$、位于 $x_1=0$ 和 $x_1=L$ 的面，外法向量分别为 $\\boldsymbol{n}^- = -\\boldsymbol{e}_1$ 和 $\\boldsymbol{n}^+ = \\boldsymbol{e}_1$。积分变为：\n$$\n\\int_{\\Gamma_1} \\boldsymbol{t}(\\boldsymbol{x}+L\\boldsymbol{e}_1) \\cdot \\tilde{\\boldsymbol{u}}(\\boldsymbol{x}+L\\boldsymbol{e}_1) \\, dS + \\int_{\\Gamma_1} \\boldsymbol{t}(\\boldsymbol{x}) \\cdot \\tilde{\\boldsymbol{u}}(\\boldsymbol{x}) \\, dS|_{\\boldsymbol{n}=-\\boldsymbol{e}_1} = 0\n$$\n利用 $\\tilde{\\boldsymbol{u}}$ 的周期性并将其提出，我们得到：\n$$\n\\int_{\\Gamma_1} [\\boldsymbol{t}(\\boldsymbol{x}+L\\boldsymbol{e}_1) + \\boldsymbol{t}(\\boldsymbol{x})|_{\\boldsymbol{n}=-\\boldsymbol{e}_1}] \\cdot \\tilde{\\boldsymbol{u}}(\\boldsymbol{x}) \\, dS = 0\n$$\n其中 $\\boldsymbol{t}(\\boldsymbol{x})|_{\\boldsymbol{n}=-\\boldsymbol{e}_1}$ 表示法向量为 $-\\boldsymbol{e}_1$ 的面上的面力。为使该积分对于任意周期性波动 $\\tilde{\\boldsymbol{u}}$ 均为零，方括号中的项必须为零。这意味着 $\\boldsymbol{t}(\\boldsymbol{x}+L\\boldsymbol{e}_1) = -\\boldsymbol{t}(\\boldsymbol{x})|_{\\boldsymbol{n}=-\\boldsymbol{e}_1}$。简单来说，相对面上的面力必须大小相等、方向相反，这就是反周期性条件。\n\n**3. 独立的宏观加载情况**\n\n对于平面应变条件下的二维问题，应变张量是一个对称的 $2 \\times 2$ 张量：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{11} & \\varepsilon_{12} \\\\ \\varepsilon_{12} & \\varepsilon_{22} \\end{pmatrix}\n$$\n这类张量的空间是一个维度为 $3$ 的向量空间。因此，需要 $3$ 种独立的宏观加载情况来完全表征材料的响应。可以使用一组线性无关的基张量来表示这些情况。在 Voigt 记法中，应变向量为 $\\boldsymbol{\\varepsilon}_v = [\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12}]^\\mathsf{T}$，其中 $\\gamma_{12} = 2\\varepsilon_{12}$，基向量的一个典型选择是：\n1.  1 方向的单轴应变：$\\boldsymbol{\\varepsilon}_v = [1, 0, 0]^\\mathsf{T}$\n2.  2 方向的单轴应变：$\\boldsymbol{\\varepsilon}_v = [0, 1, 0]^\\mathsf{T}$\n3.  纯剪切应变：$\\boldsymbol{\\varepsilon}_v = [0, 0, 1]^\\mathsf{T}$\n\n独立情况的数量为 $3$，这对应于平面应变刚度矩阵的秩。\n\n### 任务 B：等效刚度计算\n\n第二个任务是在等应变假设下推导等效刚度，并为给定的测试用例计算它。\n\n**1. 等效刚度的推导（Voigt 界）**\n\n等应变假设要求微观应变场在整个 RVE 中是均匀的，并且等于宏观应变：\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\boldsymbol{E} \\quad \\text{for all } \\boldsymbol{x} \\in \\Omega\n$$\n这是一个强假设，对应于等效刚度的 Voigt 上界。微观应力场则由局部本构关系给出：\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\boldsymbol{C}(\\boldsymbol{x}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\boldsymbol{C}(\\boldsymbol{x}) : \\boldsymbol{E}\n$$\n其中 $\\boldsymbol{C}(\\boldsymbol{x})$ 是局部刚度张量，在基体中为 $\\boldsymbol{C}_m$，在夹杂物中为 $\\boldsymbol{C}_i$。宏观应力 $\\boldsymbol{\\Sigma}$ 是微观应力的体平均：\n$$\n\\boldsymbol{\\Sigma} = \\langle \\boldsymbol{\\sigma}(\\boldsymbol{x}) \\rangle = \\frac{1}{V} \\int_V \\boldsymbol{C}(\\boldsymbol{x}) : \\boldsymbol{E} \\, dV\n$$\n由于 $\\boldsymbol{E}$ 是一个常数张量，可以将其从积分中提出：\n$$\n\\boldsymbol{\\Sigma} = \\left( \\frac{1}{V} \\int_V \\boldsymbol{C}(\\boldsymbol{x}) \\, dV \\right) : \\boldsymbol{E} = \\langle \\boldsymbol{C}(\\boldsymbol{x}) \\rangle : \\boldsymbol{E}\n$$\n根据定义，等效刚度张量 $\\boldsymbol{C}_\\text{eff}$ 关联宏观应力和应变：$\\boldsymbol{\\Sigma} = \\boldsymbol{C}_\\text{eff} : \\boldsymbol{E}$。将此与前一个表达式比较，我们得出结论：\n$$\n\\boldsymbol{C}_\\text{eff} = \\langle \\boldsymbol{C}(\\boldsymbol{x}) \\rangle\n$$\n刚度张量的体平均是通过分别对基体相和夹杂相进行积分来计算的：\n$$\n\\langle \\boldsymbol{C}(\\boldsymbol{x}) \\rangle = \\frac{1}{V} \\left( \\int_{V_m} \\boldsymbol{C}_m \\, dV + \\int_{V_i} \\boldsymbol{C}_i \\, dV \\right) = \\frac{1}{V} (V_m \\boldsymbol{C}_m + V_i \\boldsymbol{C}_i)\n$$\n设夹杂物体积分数为 $f = V_i/V$，则有 $V_m/V = 1-f$。这就得出了刚度的混合律：\n$$\n\\boldsymbol{C}_\\text{eff} = (1-f)\\boldsymbol{C}_m + f\\boldsymbol{C}_i\n$$\n在等应变假设下进行计算时，不需要关于夹杂物半径 $r$ 的几何说明，因为结果仅取决于体积分数 $f$。\n\n**2. Voigt 记法中的平面应变刚度矩阵**\n\n对于线弹性各向同性材料，三维本构关系为 $\\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon_{kk} + 2\\mu \\varepsilon_{ij}$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数。在平面应变中，对于 $k=1,2,3$，有 $\\varepsilon_{k3}=0$。应变张量的迹为 $\\varepsilon_{kk} = \\varepsilon_{11} + \\varepsilon_{22}$。面内应力分量为：\n$$\n\\sigma_{11} = \\lambda(\\varepsilon_{11} + \\varepsilon_{22}) + 2\\mu\\varepsilon_{11} = (\\lambda + 2\\mu)\\varepsilon_{11} + \\lambda\\varepsilon_{22}\n$$\n$$\n\\sigma_{22} = \\lambda(\\varepsilon_{11} + \\varepsilon_{22}) + 2\\mu\\varepsilon_{22} = \\lambda\\varepsilon_{11} + (\\lambda + 2\\mu)\\varepsilon_{22}\n$$\n$$\n\\sigma_{12} = 2\\mu\\varepsilon_{12}\n$$\n使用 Voigt 记法，其中 $\\boldsymbol{\\sigma}_v = [\\sigma_{11}, \\sigma_{22}, \\sigma_{12}]^\\mathsf{T}$ 且 $\\boldsymbol{\\varepsilon}_v = [\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12}]^\\mathsf{T}$，$\\gamma_{12} = 2\\varepsilon_{12}$，我们将剪切关系重写为 $\\sigma_{12} = \\mu(2\\varepsilon_{12}) = \\mu\\gamma_{12}$。因此，矩阵形式 $\\boldsymbol{\\sigma}_v = \\boldsymbol{C}\\boldsymbol{\\varepsilon}_v$ 为：\n$$\n\\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{12} \\end{pmatrix}\n=\n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}\n\\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\gamma_{12} \\end{pmatrix}\n$$\n拉梅参数由杨氏模量 $E$ 和泊松比 $\\nu$ 定义如下：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\quad \\lambda = \\frac{\\nu E}{(1+\\nu)(1-2\\nu)}\n$$\n这证实了所提供的平面应变刚度矩阵的结构。\n\n**3. 数值计算**\n\n对于每个测试用例，首先使用基体 ($\\boldsymbol{C}_m$) 和夹杂物 ($\\boldsymbol{C}_i$) 相各自的材料属性（$E_m, \\nu_m$ 和 $E_i, \\nu_i$）计算其刚度矩阵。然后，应用混合律：$\\boldsymbol{C}_\\text{eff} = (1-f)\\boldsymbol{C}_m + f\\boldsymbol{C}_i$。每个案例的最终结果包括秩（$3$）以及紧随其后的 $\\boldsymbol{C}_\\text{eff}$ 的 9 个分量（按行主序）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the RVE homogenization problem under the iso-strain assumption.\n\n    This function processes a suite of test cases for a two-phase composite\n    material. For each case, it calculates the effective stiffness tensor\n    C_eff using the Voigt bound (rule of mixtures).\n\n    The methodology is as follows:\n    1. Define a function to compute the plane strain stiffness matrix for an\n       isotropic material given its Young's modulus (E) and Poisson's ratio (nu).\n    2. Iterate through each test case, which provides material properties for\n       the matrix (E_m, nu_m) and inclusion (E_i, nu_i), and the inclusion\n       volume fraction (f).\n    3. For each case, compute the stiffness matrices for the matrix (C_m) and\n       inclusion (C_i).\n    4. Calculate the effective stiffness matrix C_eff = (1 - f) * C_m + f * C_i.\n    5. The number of independent loading cases (rank) for 2D plane strain is 3.\n    6. Format the results as a list containing the rank followed by the 9\n       components of C_eff in row-major order.\n    7. Aggregate the results for all test cases and print them in the\n       specified single-line format.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (general contrast)\n        (70.0, 0.33, 200.0, 0.30, 0.25),\n        # Case 2 (boundary, no inclusions)\n        (70.0, 0.33, 200.0, 0.30, 0.0),\n        # Case 3 (boundary, full inclusion)\n        (70.0, 0.33, 200.0, 0.30, 1.0),\n        # Case 4 (equal moduli)\n        (100.0, 0.25, 100.0, 0.25, 0.4),\n        # Case 5 (soft inclusion)\n        (210.0, 0.29, 1.0, 0.49, 0.3),\n    ]\n\n    def calculate_plane_strain_stiffness(E, nu):\n        \"\"\"\n        Calculates the plane strain stiffness matrix in Voigt notation.\n\n        Args:\n            E (float): Young's modulus in GPa.\n            nu (float): Poisson's ratio (dimensionless).\n\n        Returns:\n            numpy.ndarray: The 3x3 plane strain stiffness matrix.\n        \"\"\"\n        # Check for incompressibility which makes lambda diverge.\n        # nu=0.5 is technically not allowed by problem statement nu in (0, 0.5)\n        if nu >= 0.5:\n            # In a real-world scenario, handle this case, but here we assume valid inputs.\n            # A very large number could be used for lambda, but we stick to the formula.\n            pass\n\n        mu = E / (2 * (1 + nu))\n        lmbda = (nu * E) / ((1 + nu) * (1 - 2 * nu))\n        \n        C11 = lmbda + 2 * mu\n        C12 = lmbda\n        C33 = mu\n        \n        C = np.array([\n            [C11, C12, 0.0],\n            [C12, C11, 0.0],\n            [0.0, 0.0, C33]\n        ])\n        return C\n\n    all_results = []\n    \n    for case in test_cases:\n        E_m, nu_m, E_i, nu_i, f = case\n        \n        # Calculate stiffness matrices for matrix and inclusion\n        C_m = calculate_plane_strain_stiffness(E_m, nu_m)\n        C_i = calculate_plane_strain_stiffness(E_i, nu_i)\n        \n        # Calculate effective stiffness using the rule of mixtures (Voigt bound)\n        C_eff = (1 - f) * C_m + f * C_i\n        \n        # Rank of the plane strain problem is 3\n        rank = 3\n        \n        # Flatten the matrix into a list of its 9 components (row-major)\n        C_eff_flat = C_eff.flatten().tolist()\n        \n        # Combine rank and stiffness components into a single list for the case\n        case_result = [rank] + C_eff_flat\n        all_results.append(case_result)\n        \n    # Format the final output string as a list of lists with no spaces\n    # Example: [[rank,C11,...],[rank,C11,...]]\n    outer_list_str = []\n    for res in all_results:\n        # Format each inner list: [num1,num2,...]\n        inner_str = f\"[{','.join(map(str, res))}]\"\n        outer_list_str.append(inner_str)\n    \n    final_output_str = f\"[{','.join(outer_list_str)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2913666"}]}