{"hands_on_practices": [{"introduction": "我们将从最简单的例子——一维杆——开始，来理解应变梯度弹性理论所带来的根本性数学变化。这个练习将引导你从变分原理出发，推导出四阶控制方程。通过求解该方程，你将发现边界层这一关键概念，这是材料尺寸效应的一个标志性特征。", "problem": "考虑一根长度为 $L$ 的等截面线性弹性一维杆，承受沿杆轴方向的均匀体力密度 $b$（单位体积的力）。设 $x \\in [0,L]$ 表示轴向坐标，$u(x)$ 为小位移场。该杆遵循 Helmholtz 型的单参数应变梯度弹性理论，其中单位体积的应变能密度取决于微应变 $\\varepsilon(x)=u'(x)$ 及其梯度 $\\varepsilon'(x)$，表达式为\n$$\nW(\\varepsilon,\\varepsilon')=\\tfrac{1}{2} E\\,\\varepsilon^2+\\tfrac{1}{2} E\\,\\ell^2\\,(\\varepsilon')^2,\n$$\n其中 $E>0$ 是杨氏模量，$\\ell>0$ 是内禀材料长度。假设截面恒定（为简化起见，可取为单位1，因为它会在控制方程中被消去）且应变为小应变。杆的两端受到本质边界条件 $u(0)=0$ 和 $u(L)=0$ 的运动学约束，且没有施加高阶外部偶力。\n\n仅以驻定势能原理和上述定义为出发点，完成以下任务：\n\n1) 在施加本质边界条件 $u(0)=0$ 和 $u(L)=0$ 的情况下，推导与 $u(x)$ 变分相关的强形式平衡方程和自然边界条件。\n\n2) 求解由此产生的关于均匀体力密度 $b$ 的边值问题，并确定满足所有边界条件的位移场 $u(x)$ 的闭式表达式。\n\n3) 重写解答，以明确显示在 $x=0$ 和 $x=L$ 附近出现的任何边界层结构。将最终位移 $u(x)$（单位为米）表示为由 $b$、$E$、$\\ell$、$L$ 和 $x$ 构成的单一闭式解析表达式。", "solution": "### 第1步：提取已知条件\n- **几何与运动学**：一根长度为 $L$ 的一维杆。轴向坐标为 $x \\in [0,L]$。位移场为 $u(x)$。\n- **本构关系**：应变为 $\\varepsilon(x)=u'(x)$。应变能密度为 $W(\\varepsilon,\\varepsilon')=\\tfrac{1}{2} E\\,\\varepsilon^2+\\tfrac{1}{2} E\\,\\ell^2\\,(\\varepsilon')^2$。\n- **材料参数**：杨氏模量 $E>0$ 和内禀材料长度 $\\ell>0$。\n- **载荷**：均匀体力密度 $b$（单位体积）。\n- **截面**：恒定，取为单位1 ($A=1$)。\n- **边界条件**：本质（运动学）边界条件为 $u(0)=0$ 和 $u(L)=0$。无高阶外部偶力施加。\n- **方法**：驻定势能原理。\n- **任务**：\n    1. 推导强形式平衡方程和自然边界条件。\n    2. 求解边值问题，得到位移场 $u(x)$。\n    3. 重写解答，以显示边界层结构。\n\n### 第2步：推导过程\n\n杆的总势能 $\\Pi$ 是总应变能 $U$ 与外力势能 $V_{ext}$ 的和。在单位横截面积 ($A=1$) 下，它们由以下公式给出：\n$$\nU[u] = \\int_0^L W(u', u'') \\,dx = \\int_0^L \\left( \\frac{1}{2} E (u'(x))^2 + \\frac{1}{2} E \\ell^2 (u''(x))^2 \\right) dx,\n$$\n$$\nV_{ext}[u] = - \\int_0^L b u(x) \\,dx.\n$$\n总势能泛函为 $\\Pi[u] = U[u] + V_{ext}[u]$：\n$$\n\\Pi[u] = \\int_0^L \\left( \\frac{1}{2} E (u')^2 + \\frac{1}{2} E \\ell^2 (u'')^2 - b u \\right) dx.\n$$\n驻定势能原理要求 $\\Pi$ 相对于 $u$ 的一阶变分在平衡状态下为零，即 $\\delta\\Pi = 0$。\n$$\n\\delta\\Pi = \\int_0^L \\left( E u' \\delta(u') + E \\ell^2 u'' \\delta(u'') - b \\delta u \\right) dx = 0.\n$$\n对前两项进行分部积分：\n$$\n\\int_0^L E u' \\delta(u') dx = \\int_0^L E u' \\frac{d}{dx}(\\delta u) dx = \\Big[ E u' \\delta u \\Big]_0^L - \\int_0^L E u'' \\delta u \\,dx.\n$$\n$$\n\\int_0^L E \\ell^2 u'' \\delta(u'') dx = \\int_0^L E \\ell^2 u'' \\frac{d}{dx}(\\delta u') dx = \\Big[ E \\ell^2 u'' \\delta u' \\Big]_0^L - \\int_0^L (E \\ell^2 u'')' \\delta u' \\,dx.\n$$\n对最后一项进行第二次分部积分：\n$$\n- \\int_0^L (E \\ell^2 u'')' \\delta u' \\,dx = - \\Big[ (E \\ell^2 u'')' \\delta u \\Big]_0^L + \\int_0^L (E \\ell^2 u'')'' \\delta u \\,dx.\n$$\n合并所有项，变分 $\\delta\\Pi$ 变为：\n$$\n\\delta\\Pi = \\int_0^L \\Big( (E \\ell^2 u'')'' - E u'' - b \\Big) \\delta u \\,dx + \\Big[ (E u' - (E \\ell^2 u'')') \\delta u \\Big]_0^L + \\Big[ E \\ell^2 u'' \\delta u' \\Big]_0^L = 0.\n$$\n\n**1) 强形式平衡方程和自然边界条件**\n\n为使变分陈述对任何在内部 $(0,L)$ 为零的容许变分 $\\delta u$ 成立，被积函数必须为零。这得到了强形式平衡方程（欧拉-拉格朗日方程）：\n$$\n(E \\ell^2 u'')'' - E u'' = b.\n$$\n由于 $E$ 和 $\\ell$ 是常数，这可以简化为：\n$$\nE \\ell^2 u'''' - E u'' = b \\quad \\implies \\quad u'''' - \\frac{1}{\\ell^2} u'' = \\frac{b}{E \\ell^2}.\n$$\n边界项也必须为零。本质边界条件是 $u(0)=0$ 和 $u(L)=0$，这意味着容许变分必须满足 $\\delta u(0)=0$ 和 $\\delta u(L)=0$。这自动使得第一个边界项 $\\Big[ (E u' - (E \\ell^2 u'')') \\delta u \\Big]_0^L$ 为零。剩余的边界项是：\n$$\n\\Big[ E \\ell^2 u'' \\delta u' \\Big]_0^L = (E \\ell^2 u''(L)) \\delta u'(L) - (E \\ell^2 u''(0)) \\delta u'(0) = 0.\n$$\n由于变分 $\\delta u'(0)$ 和 $\\delta u'(L)$ 是任意的，它们的系数必须为零。这些就是自然边界条件，其物理意义对应于没有外部施加的偶力（力矩）：\n$$\nE \\ell^2 u''(0) = 0 \\quad \\text{and} \\quad E \\ell^2 u''(L) = 0.\n$$\n由于 $E>0$ 且 $\\ell>0$，这些简化为 $u''(0) = 0$ 和 $u''(L) = 0$。\n\n**2) 边值问题的求解**\n\n完整的边值问题是：\n- 微分方程(ODE): $u'''' - \\frac{1}{\\ell^2} u'' = \\frac{b}{E \\ell^2}$ 对于 $x \\in (0,L)$。\n- 边界条件(BCs): $u(0)=0$, $u(L)=0$, $u''(0)=0$, $u''(L)=0$。\n\n通解是特解 $u_p(x)$ 和齐次解 $u_h(x)$ 的和。\n对于特解，我们尝试多项式 $u_p(x) = C x^2$。代入ODE：\n$0 - \\frac{1}{\\ell^2}(2C) = \\frac{b}{E \\ell^2} \\implies C = -\\frac{b}{2E}$。因此，$u_p(x) = -\\frac{b}{2E}x^2$。\n\n对于齐次解，特征方程是 $r^4 - \\frac{1}{\\ell^2}r^2 = 0$，或 $r^2(r^2 - 1/\\ell^2)=0$。根是 $r_1=r_2=0$, $r_3=1/\\ell$, 和 $r_4=-1/\\ell$。齐次解是：\n$$\nu_h(x) = C_1 + C_2 x + C_3 \\cosh(x/\\ell) + C_4 \\sinh(x/\\ell).\n$$\n通解是：\n$$\nu(x) = C_1 + C_2 x + C_3 \\cosh(x/\\ell) + C_4 \\sinh(x/\\ell) - \\frac{b}{2E} x^2.\n$$\n我们需要它的二阶导数来应用自然边界条件：\n$$\nu''(x) = \\frac{C_3}{\\ell^2} \\cosh(x/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(x/\\ell) - \\frac{b}{E}.\n$$\n应用边界条件：\n- $u''(0)=0 \\implies \\frac{C_3}{\\ell^2} - \\frac{b}{E} = 0 \\implies C_3 = \\frac{b\\ell^2}{E}$。\n- $u''(L)=0 \\implies \\frac{C_3}{\\ell^2} \\cosh(L/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(L/\\ell) - \\frac{b}{E} = 0$。代入 $C_3$：\n  $\\frac{b}{E} \\cosh(L/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(L/\\ell) - \\frac{b}{E} = 0 \\implies C_4 = \\frac{b\\ell^2}{E} \\frac{1-\\cosh(L/\\ell)}{\\sinh(L/\\ell)} = -\\frac{b\\ell^2}{E} \\tanh(L/(2\\ell))$。\n- $u(0)=0 \\implies C_1 + C_3 = 0 \\implies C_1 = -C_3 = -\\frac{b\\ell^2}{E}$。\n- $u(L)=0 \\implies C_1 + C_2 L + C_3 \\cosh(L/\\ell) + C_4 \\sinh(L/\\ell) - \\frac{b}{2E} L^2 = 0$。\n  代入已知常数：\n  $-\\frac{b\\ell^2}{E} + C_2 L + \\frac{b\\ell^2}{E}\\cosh(L/\\ell) - \\frac{b\\ell^2}{E} \\tanh(L/(2\\ell)) \\sinh(L/\\ell) - \\frac{b}{2E} L^2 = 0$。\n  项 $\\frac{b\\ell^2}{E}\\cosh(L/\\ell) - \\frac{b\\ell^2}{E} \\tanh(L/(2\\ell)) \\sinh(L/\\ell)$ 可以简化。它等于 $C_3 \\cosh(L/\\ell) + C_4 \\sinh(L/\\ell) = \\ell^2 \\left( \\frac{C_3}{\\ell^2} \\cosh(L/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(L/\\ell) \\right) = \\ell^2 (\\frac{b}{E}) = \\frac{b\\ell^2}{E}$。\n  所以 $C_2$ 的方程变为：\n  $-\\frac{b\\ell^2}{E} + C_2 L + \\frac{b\\ell^2}{E} - \\frac{b}{2E} L^2 = 0 \\implies C_2 L = \\frac{bL^2}{2E} \\implies C_2 = \\frac{bL}{2E}$。\n\n将常数代回通解：\n$$\nu(x) = -\\frac{b\\ell^2}{E} + \\frac{bL}{2E} x - \\frac{b}{2E} x^2 + \\frac{b\\ell^2}{E} \\cosh(x/\\ell) - \\frac{b\\ell^2}{E} \\tanh(L/(2\\ell)) \\sinh(x/\\ell).\n$$\n\n**3) 边界层结构**\n\n为了明确显示结构，我们将各项分组如下：\n$$\nu(x) = \\frac{b}{2E} (Lx - x^2) + \\frac{b\\ell^2}{E} \\left( \\cosh(x/\\ell) - \\tanh(L/(2\\ell)) \\sinh(x/\\ell) - 1 \\right).\n$$\n第一项 $u_{cl}(x)=\\frac{b}{2E}(Lx-x^2)$ 是没有梯度效应的杆的经典抛物线位移分布。第二项是由于应变梯度引起的修正项。双曲函数部分可以使用恒等式 $\\cosh(A-B) = \\cosh A \\cosh B - \\sinh A \\sinh B$ 来简化：\n$$\n\\cosh(x/\\ell) - \\tanh(L/(2\\ell)) \\sinh(x/\\ell) = \\frac{\\cosh(x/\\ell)\\cosh(L/(2\\ell)) - \\sinh(L/(2\\ell))\\sinh(x/\\ell)}{\\cosh(L/(2\\ell))} = \\frac{\\cosh(\\frac{x}{\\ell}-\\frac{L}{2\\ell})}{\\cosh(L/(2\\ell))}.\n$$\n由于 $\\cosh$ 是偶函数，这也等于 $\\frac{\\cosh(\\frac{L}{2\\ell}-\\frac{x}{\\ell})}{\\cosh(L/(2\\ell))}$ 或 $\\frac{\\cosh(\\frac{x-L/2}{\\ell})}{\\cosh(L/(2\\ell))}$。\n位移场的最终紧凑表达式是：\n$$\nu(x) = \\frac{b}{2E} x(L-x) + \\frac{b\\ell^2}{E} \\left( \\frac{\\cosh(\\frac{x-L/2}{\\ell})}{\\cosh(L/2\\ell)} - 1 \\right).\n$$\n这种形式明确地显示了由一个修正项修正的经典抛物线解。该修正项由材料长度 $\\ell$ 控制。双曲余弦项在 $x=0$ 和 $x=L$ 附近创建了特征厚度为 $\\ell$ 的边界层。在这些层内部，梯度弹性解显著偏离经典解，以满足高阶边界条件 $u''=0$。远离边界，如果 $L \\gg \\ell$，修正项变得很小，解接近于经典解加上一个恒定的偏移量。此表达式即为所要求的单一闭式解。", "answer": "$$\n\\boxed{u(x) = \\frac{b}{2E} x(L-x) + \\frac{b \\ell^{2}}{E} \\left( \\frac{\\cosh\\left(\\frac{x - L/2}{\\ell}\\right)}{\\cosh\\left(\\frac{L}{2\\ell}\\right)} - 1 \\right)}\n$$", "id": "2688599"}, {"introduction": "在一维杆的基础上，我们现在将应变梯度概念应用于更复杂的工程结构：梁。这个实践探讨了经典的欧拉-伯努利梁理论是如何被修正的。我们将使用微扰分析来精确地揭示材料的内禀长度尺度 $\\ell$ 如何对经典解引入一个修正项，从而在新旧理论之间建立起切实的联系。", "problem": "考虑一个用于细长棱柱梁的一维弯曲模型，该模型通过应变梯度弹性理论引入了材料长度尺度。设 $x \\in [0,L]$ 表示梁的轴向坐标，设 $w(x)$ 表示在已知的静态横向载荷分布 $q(x)$（单位长度载荷）下的横向挠度。使用以下基本假设：\n- 欧拉-伯努利梁理论的运动学：曲率为 $\\kappa(x) = w''(x)$。\n- 弯矩的静态平衡：内部弯矩 $M(x)$ 满足 $M''(x) = q(x)$。\n- 考虑应变梯度增强的能量法：总势能为\n$$\\Pi[w] = \\int_0^L \\frac{1}{2} E I \\left( \\kappa(x)^2 + \\ell^2 \\kappa'(x)^2 \\right) \\, dx \\;-\\; \\int_0^L q(x) \\, w(x) \\, dx,$$\n其中 $E I$ 是抗弯刚度，$\\ell$ 是一个固有材料长度（两者均为严格为正的常数）。\n\n任务：\n1) 从平稳作用量条件 $\\delta \\Pi[w] = 0$ 出发，对于与几何边界条件一致的容许变分 $\\delta w(x)$，推导 $w(x)$ 的欧拉-拉格朗日方程，并完全用 $w(x)$ 和 $q(x)$ 表示。然后，严格证明 $\\ell \\to 0$ 的极限，并写出极限方程。\n\n2) 通过形式为\n$$w(x) = w_0(x) + \\ell^2 w_1(x) + \\mathcal{O}(\\ell^4)$$\n的正则微扰展开，量化小而有限的 $\\ell$ 的主阶修正，并推导出一个确定曲率主阶修正的可计算关系式。将曲率的最终关系式表达至 $\\ell^2$ 阶，用经典弯矩 $M(x)$ 及其导数表示，然后才在适当的边界条件下积分以获得 $w(x)$。\n\n3) 使用你的主阶关系式，构建一个算法，为以下边值问题计算挠度 $w(x)$ 至 $\\ell^2$ 阶。所有答案必须以米为单位表示，其中 $x$ 的单位为米，$E I$ 的单位为 $\\mathrm{N}\\,\\mathrm{m}^2$，$q$ 的单位为 $\\mathrm{N}/\\mathrm{m}$，施加的末端弯矩单位为 $\\mathrm{N}\\,\\mathrm{m}$。使用指定的精确常数；不要对中间计算进行四舍五入。\n\n测试套件：\n- 情况 A（简支，均布载荷）：梁长 $L = 2.0\\,\\mathrm{m}$，抗弯刚度 $E I = 2.0 \\times 10^7\\,\\mathrm{N}\\,\\mathrm{m}^2$，固有长度 $\\ell = 0.05\\,\\mathrm{m}$，恒定载荷 $q(x) = q_0$，其中 $q_0 = 1000\\,\\mathrm{N}/\\mathrm{m}$。几何边界条件为 $w(0) = 0$ 和 $w(L) = 0$。自然边界条件为简支端的弯矩为零。报告 $x = L/2$ 处的挠度。\n- 情况 B（悬臂梁，正弦载荷）：梁长 $L = 1.5\\,\\mathrm{m}$，抗弯刚度 $E I = 3.0 \\times 10^6\\,\\mathrm{N}\\,\\mathrm{m}^2$，固有长度 $\\ell = 0.02\\,\\mathrm{m}$，载荷 $q(x) = q_0 \\sin\\left(\\pi x/L\\right)$，其中 $q_0 = 500\\,\\mathrm{N}/\\mathrm{m}$。固定端 $x = 0$ 处的几何边界条件为 $w(0) = 0$ 和 $w'(0) = 0$。自由端 $x = L$ 处的自然边界条件为弯矩和剪力为零。报告 $x = L$ 处的尖端挠度。\n- 情况 C（悬臂梁，纯末端弯矩）：梁长 $L = 1.0\\,\\mathrm{m}$，抗弯刚度 $E I = 5.0 \\times 10^6\\,\\mathrm{N}\\,\\mathrm{m}^2$，固有长度 $\\ell = 0.10\\,\\mathrm{m}$，无分布载荷 $q(x) = 0$。在 $x = L$ 处施加一个恒定的末端弯矩 $M_0 = 2000\\,\\mathrm{N}\\,\\mathrm{m}$，导致在静态平衡下沿梁跨度产生一个恒定的内部弯矩 $M(x) = M_0$。在 $x = 0$ 处的几何边界条件为 $w(0) = 0$ 和 $w'(0) = 0$。报告 $x = L$ 处的尖端挠度。\n- 情况 D（恢复性检验，简支，均布载荷且 $\\ell = 0$）：与情况 A 相同，但 $\\ell = 0\\,\\mathrm{m}$。报告 $x = L/2$ 处的挠度。\n\n要求的最终输出格式：\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_i$ 是情况 A-D 所要求的挠度，单位为米，以浮点数表示。程序必须是自包含的，不得读取任何输入，并且必须使用本问题中的推导来计算答案，不使用外部文件或网络访问。", "solution": "**任务 1：控制方程的推导**\n\n总势能由一个泛函 $\\Pi[w]$ 给出。控制微分方程和自然边界条件通过将此泛函的一阶变分设为零来找到，即 $\\delta\\Pi = 0$，对所有容许变分 $\\delta w(x)$ 成立。拉格朗日密度为 $\\mathcal{L}(w, w'', w''') = \\frac{1}{2}EI\\left((w'')^2 + \\ell^2(w''')^2\\right) - q(x)w$。\n\n变分为：\n$$ \\delta\\Pi = \\int_0^L \\left( \\frac{\\partial \\mathcal{L}}{\\partial w}\\delta w + \\frac{\\partial \\mathcal{L}}{\\partial w''}\\delta w'' + \\frac{\\partial \\mathcal{L}}{\\partial w'''}\\delta w''' \\right) dx = \\int_0^L \\left( -q\\delta w + EIw''\\delta w'' + EI\\ell^2w'''\\delta w''' \\right) dx = 0 $$\n对包含 $\\delta w$ 导数的项使用分部积分：\n$$ \\int_0^L EIw''\\delta w'' dx = \\int_0^L EIw'' \\frac{d^2(\\delta w)}{dx^2} dx = \\left[ EIw'' \\frac{d(\\delta w)}{dx} \\right]_0^L - \\left[ \\frac{d(EIw'')}{dx} \\delta w \\right]_0^L + \\int_0^L \\frac{d^2(EIw'')}{dx^2} \\delta w dx $$\n$$ \\int_0^L EI\\ell^2w'''\\delta w''' dx = \\dots = -\\left[ \\frac{d(EI\\ell^2w''')}{dx} \\frac{d(\\delta w)}{dx} \\right]_0^L + \\left[ \\frac{d^2(EI\\ell^2w''')}{dx^2} \\delta w \\right]_0^L - \\int_0^L \\frac{d^3(EI\\ell^2w''')}{dx^3} \\delta w dx $$\n合并所有积分项，我们得到：\n$$ \\int_0^L \\left( \\frac{d^2(EIw'')}{dx^2} - \\frac{d^3(EI\\ell^2w''')}{dx^3} - q(x) \\right) \\delta w \\, dx + \\text{边界项} = 0 $$\n对于域 $(0, L)$ 内的任意变分 $\\delta w$，被积函数必须为零，从而得到欧拉-拉格朗日方程。假设 $EI$ 和 $\\ell$ 为常数：\n$$ EIw'''' - EI\\ell^2 w'''''' = q(x) $$\n这是控制挠度 $w(x)$ 的六阶微分方程。\n\n在极限 $\\ell \\to 0$ 下，只要解 $w(x)$ 足够光滑以使其六阶导数保持有界，项 $EI\\ell^2w''''''$ 就会消失。方程简化为：\n$$ EIw'''' = q(x) $$\n这正是经典的欧拉-伯努利梁方程。完整方程的解收敛到简化方程的解构成了正则微扰问题，证明了这个极限的合理性。\n\n**任务 2：微扰展开**\n\n我们寻求形式为 $w(x) = w_0(x) + \\ell^2 w_1(x) + \\mathcal{O}(\\ell^4)$ 的解。将其代入控制方程：\n$$ EI(w_0'''' + \\ell^2 w_1'''') - EI\\ell^2(w_0'''''' + \\ell^2 w_1'''''') = q(x) $$\n按 $\\ell^2$ 的幂次合并同类项：\n- $\\mathcal{O}(\\ell^0)$: $EIw_0'''' = q(x)$\n- $\\mathcal{O}(\\ell^2)$: $EIw_1'''' - EIw_0'''''' = 0 \\implies EIw_1'''' = EIw_0''''''$\n\n从零阶方程，我们可以微分两次得到 $EIw_0'''''' = q''(x)$。将其代入一阶方程得到：\n$$ EIw_1'''' = q''(x) $$\n总挠度 $w = w_0 + \\ell^2 w_1$ 通过求解两个独立的边值问题来找到：\n1.  **关于 $w_0$ 的经典问题**：求解 $EIw_0'''' = q(x)$，并施加指定的*经典*边界条件。\n2.  **关于 $w_1$ 的修正问题**：求解 $EIw_1'''' = q''(x)$，并施加适当的边界条件。这些是通过将微扰展开应用于完整问题的边界条件来推导的。对于 $w(a)=c$ 或 $w'(a)=d$ 形式的几何边界条件，修正问题对应的条件是齐次的：$w_1(a)=0$ 和 $w_1'(a)=0$。\n\n**任务 3：算法与计算**\n\n**情况 A：简支，均布载荷**\n$q(x)=q_0=1000$。因此，$q''(x)=0$。修正问题是 $EIw_1''''=0$。$w_1$的边界条件是齐次的，因此 $w_1(x) \\equiv 0$。解纯粹是经典的。对于均布载荷下的简支梁，中点挠度为：\n$$ w(L/2) = \\frac{5 q_0 L^4}{384 EI} = \\frac{5 \\times 1000 \\times (2.0)^4}{384 \\times (2.0 \\times 10^7)} \\approx 1.041667 \\times 10^{-5}\\,\\mathrm{m} $$\n\n**情况 B：悬臂梁，正弦载荷**\n$q(x) = q_0 \\sin(\\alpha x)$ 其中 $\\alpha = \\pi/L$。$q''(x) = -q_0 \\alpha^2 \\sin(\\alpha x)$。\n关于 $w_0$ 的问题：$EIw_0'''' = q_0\\sin(\\alpha x)$，边界条件为 $w_0(0)=w_0'(0)=0$ (固定) 和 $w_0''(L)=w_0'''(L)=0$ (自由)。求解得到尖端挠度：\n$$ w_0(L) = \\frac{q_0}{EI} \\left( \\frac{L^3}{3\\alpha} - \\frac{L}{\\alpha^3} \\right) = \\frac{q_0 L^4}{EI \\pi} \\left(\\frac{1}{3} - \\frac{1}{\\pi^2}\\right) $$\n关于 $w_1$ 的问题：$EIw_1'''' = -q_0 \\alpha^2 \\sin(\\alpha x)$，边界条件为 $w_1(0)=w_1'(0)=0$。自由端的自然边界条件是更复杂的，但可以通过微扰分析得出 $EIw_1''(L)=q(L)=0$ 和 $EIw_1'''(L)=q'(L)=-q_0\\alpha$。求解得到修正项的尖端挠度：\n$$ w_1(L) = \\frac{1}{EI} \\left( \\frac{q_0 L}{\\alpha} \\right) = \\frac{q_0 L^2}{EI \\pi} $$\n总尖端挠度为 $w(L) = w_0(L) + \\ell^2 w_1(L)$：\n$$ w(L) = \\frac{q_0 L^2}{EI \\pi} \\left[ L^2\\left(\\frac{1}{3} - \\frac{1}{\\pi^2}\\right) + \\ell^2 \\right] $$\n代入数值 $L=1.5, EI=3.0\\times 10^6, q_0=500, \\ell=0.02$：\n$$ w(1.5) \\approx 6.23493 \\times 10^{-5}\\,\\mathrm{m} $$\n\n**情况 C：悬臂梁，纯末端弯矩**\n$q(x)=0$，所以 $q''(x)=0$。修正问题 $EIw_1'''' = 0$ 的解为 $w_1(x) \\equiv 0$。梯度效应为零。\n解是悬臂梁在末端弯矩 $M_0$ 作用下的经典解：\n$$ w(x) = w_0(x) = \\frac{M_0 x^2}{2EI} $$\n尖端挠度为：\n$$ w(L) = \\frac{M_0 L^2}{2EI} = \\frac{2000 \\times (1.0)^2}{2 \\times (5.0 \\times 10^6)} = 2.0 \\times 10^{-4}\\,\\mathrm{m} $$\n\n**情况 D：恢复性检验，$\\ell=0$**\n此情况与情况 A 相同，因为已证明参数 $\\ell$ 对均布载荷下的解没有影响。\n$$ w(L/2) = \\frac{5 q_0 L^4}{384 EI} \\approx 1.041667 \\times 10^{-5}\\,\\mathrm{m} $$", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes beam deflections for four cases based on strain gradient elasticity.\n    The derivation shows that the deflection w(x) can be approximated by\n    w(x) = w_0(x) + l^2 * w_1(x), where w_0 is the classical solution\n    and w_1 is a correction.\n    - EI * w_0'''' = q(x)\n    - EI * w_1'''' = q''(x)\n    \"\"\"\n\n    results = []\n\n    # Case A: Simply supported, uniform load\n    L_A = 2.0\n    EI_A = 2.0e7\n    l_A = 0.05\n    q0_A = 1000.0\n    # For uniform load q(x) = q0, q''(x) = 0.\n    # The correction term w_1 is zero. The solution is purely classical.\n    # w(x=L/2) = 5 * q0 * L^4 / (384 * EI)\n    w_A = (5 * q0_A * L_A**4) / (384 * EI_A)\n    results.append(w_A)\n\n    # Case B: Cantilever, sinusoidal load\n    L_B = 1.5\n    EI_B = 3.0e6\n    l_B = 0.02\n    q0_B = 500.0\n    # The total tip deflection is w(L) = w0(L) + l^2 * w1(L)\n    # w0(L) = (q0 * L^4 / (EI * pi)) * (1/3 - 1/pi^2)\n    # w1(L) = (q0 * L^2 / (EI * pi))\n    # w(L) = (q0 * L^2 / (EI * pi)) * [L^2 * (1/3 - 1/pi^2) + l^2]\n    pi = np.pi\n    term1_B = q0_B * L_B**2 / (EI_B * pi)\n    term2_B = L_B**2 * (1/3 - 1/pi**2)\n    term3_B = l_B**2\n    w_B = term1_B * (term2_B + term3_B)\n    results.append(w_B)\n\n    # Case C: Cantilever, pure end moment\n    L_C = 1.0\n    EI_C = 5.0e6\n    l_C = 0.10\n    M0_C = 2000.0\n    # For q(x) = 0, q''(x) = 0.\n    # The correction term w_1 is zero. The solution is purely classical.\n    # w(x) = M0 * x^2 / (2 * EI), so w(L) = M0 * L^2 / (2 * EI)\n    w_C = (M0_C * L_C**2) / (2 * EI_C)\n    results.append(w_C)\n\n    # Case D: Recovery check, simply supported, uniform load with l=0\n    L_D = 2.0\n    EI_D = 2.0e7\n    l_D = 0.0\n    q0_D = 1000.0\n    # For uniform load, the solution does not depend on l.\n    # Result is identical to Case A.\n    w_D = (5 * q0_D * L_D**4) / (384 * EI_D)\n    results.append(w_D)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12g}' for r in results)}]\")\n\nsolve()\n```", "id": "2919598"}, {"introduction": "解析解仅限于简单情况，对于真实的工程问题，我们必须依赖于有限元法（FEM）等数值方法。这个练习深入探讨了在实现应变梯度模型时的一个关键问题：我们的近似函数需要具有更高阶的（$C^1$）连续性。理解这一要求是掌握为处理高阶连续介质理论而发展起来的先进计算技术的第一步。", "problem": "考虑一个占据有界利普希茨域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2,3\\}$）的小应变、线性、中心对称的应变梯度弹性固体。令 $u:\\Omega \\to \\mathbb{R}^{d}$ 表示位移场，$\\varepsilon(u) = \\tfrac{1}{2}(\\nabla u + \\nabla u^{\\top})$ 为对称应变。一个具有内禀材料长度 $\\ell > 0$ 的原型总势能泛函包含一个标准的弹性部分和一个二次应变梯度部分，后者依赖于 $\\varepsilon(u)$ 的空间梯度。为简洁起见，假设没有惯性、体力或面力。虚功原理指出，在平衡状态下，对于所有容许的虚位移 $v$，总势能的一阶变分必须为零。\n\n任务 A。从虚功原理和 $\\varepsilon(u)$ 的定义出发，论证当存在涉及 $\\varepsilon(u)$ 一阶导数的二次梯度项时，$u$ 的哪些导数必须是平方可积的。将此要求转换为索博列夫空间的形式化表述 $u \\in H^{m}(\\Omega)$（其中 $m \\ge 1$ 为整数），并分别讨论包含和不包含梯度项两种情况。解释双线性形式中出现的 $u$ 的最高阶导数如何确定 $m$，以及必须如何选择协调有限元，以使离散空间是 $H^{m}(\\Omega)$ 的子空间。\n\n任务 B。对于由分片多项式构成的协调离散化，令 $C^{r}$ 表示跨单元界面的 $r$ 阶单元间连续性。解释标量分量的 $H^{m}$-协调性与 $C^{m-1}$ 连续性之间的联系。定义一个函数，该函数将给定的导数阶数 $m$ 映射到最小单元间连续性阶数 $r=m-1$，并附带两个逻辑指示符：一个在要求至少 $C^{1}$ 连续性（即 $m \\ge 2$）时为真，另一个在恰好 $C^{1}$ 连续性即足够（即 $m=2$）时为真。\n\n任务 C。考虑一个基于单纯形的单元（$d=2$ 时为三角形，$d=3$ 时为四面体），其标量多项式形函数的总次数至多为 $p \\in \\mathbb{N}$。令 $N_{p}(d)$ 表示 $d$-单纯形上次数至多为 $p$ 的标量多项式空间的维数，即 $N_{p}(d) = \\binom{p+d}{d}$。对于 $d=3$ 的情况，我们关注单个平面三角形面 $F$。为使一个标量分量跨越 $F$ 具有 $C^{1}$ 单元间连续性，其独立的迹数据包括函数在 $F$ 上的限制 $u|_{F}$（一个在 $F$ 上次数至多为 $p$ 的多项式）和法向导数在 $F$ 上的限制 $\\partial u/\\partial n|_{F}$（一个在 $F$ 上次数至多为 $p-1$ 的多项式）。令 $\\dim \\mathcal{P}_{q}(F) = \\binom{q+2}{2}$ 表示 $F$ 上次数至多为 $q$ 的多项式空间的维数。定义面迹数据维数\n$$\nT_{\\mathrm{face}}(p) = \\dim \\mathcal{P}_{p}(F) + \\dim \\mathcal{P}_{p-1}(F) = \\binom{p+2}{2} + \\binom{p+1}{2} = (p+1)^{2}.\n$$\n对于 $d=3$，定义比率\n$$\nR_{\\mathrm{face}}(p) = \\frac{T_{\\mathrm{face}}(p)}{N_{p}(3)}, \\quad R_{\\mathrm{all\\,faces}}(p) = \\frac{4\\,T_{\\mathrm{face}}(p)}{N_{p}(3)}.\n$$\n这些比率分别量化了单个面上所需的 $C^{1}$ 迹数据空间相对于内部多项式空间的大小，以及在假设四个面相互独立的情况下，对所有四个面进行聚合的粗略上界指标。使用这些量来讨论在三维四面体上构造 $C^{1}$-协调标量多项式单元的挑战。\n\n编程要求。实现一个程序，执行以下操作：\n\n- 给定一个导数阶数列表 $m$，为每个 $m$ 计算：\n  - 最小连续性阶数 $r = m-1$，为整数。\n  - 一个布尔标志 $\\mathrm{requires\\_at\\_least\\_C1} = $ true 如果 $m \\ge 2$，否则为 false。\n  - 一个布尔标志 $\\mathrm{exactly\\_C1\\_sufficient} = $ true 如果 $m = 2$，否则为 false。\n- 对于 $d=3$ 和一个多项式次数列表 $p$，为每个 $p$ 计算：\n  - $N_{p}(3) = \\binom{p+3}{3}$，为整数。\n  - $T_{\\mathrm{face}}(p) = (p+1)^{2}$，为整数。\n  - $R_{\\mathrm{face}}(p)$ 和 $R_{\\mathrm{all\\,faces}}(p)$，为浮点数，四舍五入到六位小数。\n\n单位约定。此计算中不涉及物理单位。\n\n测试套件。您的程序必须精确使用以下测试参数：\n\n- 导数阶数 $m \\in \\{1,2,3\\}$。\n- 三维中的多项式次数 $p \\in \\{2,3,4,5,6\\}$。\n\n最终输出格式。您的程序应生成一行输出，其中包含一个扁平列表中的所有结果，顺序如下：\n\n- 对于 $m=1, m=2, m=3$ 序列中的每个 $m$，追加三个条目：$r$, $\\mathrm{requires\\_at\\_least\\_C1}$, $\\mathrm{exactly\\_C1\\_sufficient}$。布尔值必须打印为整数，$0$ 代表 false，$1$ 代表 true。\n- 对于 $p=2,3,4,5,6$ 序列中的每个 $p$，追加四个条目：$N_{p}(3)$, $T_{\\mathrm{face}}(p)$, $R_{\\mathrm{face}}(p)$, $R_{\\mathrm{all\\,faces}}(p)$，其中最后两个条目是四舍五入到六位小数的浮点数。\n\n例如，输出应具有以下结构：\n$[r_{1},b_{1},c_{1},r_{2},b_{2},c_{2},r_{3},b_{3},c_{3},N_{2},T_{2},R_{\\mathrm{face}}(2),R_{\\mathrm{all\\,faces}}(2),\\dots,N_{6},T_{6},R_{\\mathrm{face}}(6),R_{\\mathrm{all\\,faces}}(6)]$，\n方括号内用逗号分隔条目，无空格。条目本身必须是基本类型：布尔值表示为 $0$ 或 $1$，所有其他值均为指定的整数或浮点数。", "solution": "**任务 A：索博列夫空间要求**\n\n弹性体的总势能 $\\Pi$ 是应变能密度 $W$ 的体积积分。平衡状态通过最小化此势能找到，根据虚功原理，这要求其一阶变分 $\\delta\\Pi$ 对所有容许的虚位移 $v$ 均为零。为了使此形式在数学上有意义，任何容许位移场 $u$ 的能量 $\\Pi(u)$ 都必须是有限的。\n\n在经典线性弹性理论中，应变能密度 $W$ 是应变张量分量的二次函数，即 $W = W(\\varepsilon(u))$。由于应变张量 $\\varepsilon(u)$ 是位移场 $u$ 的一阶导数的线性函数，要使总能量 $\\Pi(u) = \\int_{\\Omega} W(\\varepsilon(u)) \\, d\\Omega$ 有限，$u$ 的一阶导数必须在域 $\\Omega$ 上是平方可积的。这在数学上表示为 $u$ 及其一阶导数属于 $L^{2}(\\Omega)$ 空间，即 $u \\in [H^{1}(\\Omega)]^{d}$。能量中出现的最高导数阶数为 $m=1$。\n\n在给定的应变梯度弹性模型中，能量密度还二次依赖于应变的梯度，即 $W = W(\\varepsilon(u), \\nabla\\varepsilon(u))$。项 $\\nabla\\varepsilon(u)$ 包含 $u$ 的二阶导数。因此，要使总能量有限，$u$ 的二阶导数必须是平方可积的。这要求 $u$ 及其直至二阶的导数都属于 $L^{2}(\\Omega)$，即 $u \\in [H^{2}(\\Omega)]^{d}$。能量中出现的最高导数阶数为 $m=2$。\n\n通常，对于一个变分问题，如果能量泛函中出现的未知场 $u$ 的最高导数阶数为 $m$，那么解的自然函数空间就是 $H^{m}(\\Omega)$。协调有限元近似要求离散函数空间 $V_h$ 是连续解空间 $V$ 的子空间，即 $V_h \\subset V = [H^m(\\Omega)]^d$。\n\n**任务 B：单元间连续性**\n\n对于一个被划分为单元网格的域，一个通过在每个单元上拼接多项式而构造的函数，当且仅当它在单元间边界上表现出一定程度的连续性时，才属于全局索博列夫空间 $H^m(\\Omega)$。一个基本结果指出，分片多项式函数要属于 $H^m(\\Omega)$，它必须在单元界面上是 $C^{m-1}$ 类连续的。\n\n-   对于 $m=1$（标准弹性，$H^1$-协调性），要求是 $C^{0}$ 连续性。\n-   对于 $m=2$（应变梯度弹性，$H^2$-协调性），要求是 $C^{1}$ 连续性。\n-   对于 $m=3$，要求将是 $C^{2}$ 连续性。\n\n因此，从导数阶数 $m$ 到连续性要求的映射如下：\n1.  要求的最小单元间连续性阶数：$r = m-1$。\n2.  布尔指示符 $\\mathrm{requires\\_at\\_least\\_C1}$ 在 $m \\geq 2$ 时为真。\n3.  布尔指示符 $\\mathrm{exactly\\_C1\\_sufficient}$ 在 $m=2$ 时为真。\n\n**任务 C：在三维中构造 $C^1$-协调单元的挑战**\n\n在四面体（$d=3$）上构造 $C^1$-协调有限元是出了名的困难。对自由度 (DoFs) 的分析揭示了问题的核心。一个稳定且协调的单元必须有一组节点自由度，这些自由度既能唯一确定单元内部的多项式，又能确保与相邻单元的 $C^1$ 连续性。\n\n为了使标量分量 $u_i$ 在一个三角形面 $F$ 上具有 $C^1$ 连续性，函数的迹 $u_i|_F$ 和其法向导数的迹 $\\partial u_i/\\partial n|_F$ 必须是连续的。如果 $u_i$ 的形函数在四面体内是 $p$ 次多项式，那么定义单个面上 $C^1$-迹的独立参数数量由 $T_{\\mathrm{face}}(p) = \\binom{p+2}{2} + \\binom{p-1+2}{2} = (p+1)^2$ 给出。\n\n定义单个四面体内 $p$ 次多项式的可用系数总数为 $N_p(3) = \\binom{p+3}{3}$。这些系数是单元的内部自由度。\n\n比率 $R_{\\mathrm{face}}(p) = T_{\\mathrm{face}}(p) / N_p(3)$ 衡量了单个面上的连续性要求所约束的内部自由度的比例。比率 $R_{\\mathrm{all\\,faces}}(p) = 4 T_{\\mathrm{face}}(p) / N_p(3)$ 是对总约束的一个粗略高估。\n\n$R_{\\mathrm{all\\,faces}}(p)$ 显著大于 $1$ 的事实说明了挑战所在。定义所有四个面上的迹所需的参数数量远超过可用的多项式系数数量。这表明这些迹不是独立的，它们通过单元边和顶点处的强相容性条件相互关联。用一组局部自由度同时满足所有这些约束在代数上非常困难。这迫使人们使用非常高的多项式次数，或采用非协调/不连续伽辽金方法。这种现象被称为“迹的暴政”，是在工程分析中实用的 $C^1$-协调四面体单元稀少且复杂的根本原因。", "answer": "```python\nimport numpy as np\nfrom scipy.special import comb\n\ndef solve():\n    \"\"\"\n    Computes results for Tasks B and C based on the problem statement.\n    \"\"\"\n    m_orders = [1, 2, 3]\n    p_degrees = [2, 3, 4, 5, 6]\n    \n    results = []\n\n    # Task B: Continuity requirements from derivative order m\n    for m in m_orders:\n        r = m - 1\n        requires_at_least_c1 = 1 if m >= 2 else 0\n        exactly_c1_sufficient = 1 if m == 2 else 0\n        results.extend([r, requires_at_least_c1, exactly_c1_sufficient])\n        \n    # Task C: Ratios for C1-conforming tetrahedral elements\n    d = 3 # Dimension is 3 for tetrahedra\n    for p in p_degrees:\n        # N_p(3) = C(p+3, 3)\n        # We use exact=True to ensure integer result\n        Np3 = comb(p + d, d, exact=True)\n        \n        # T_face(p) = (p+1)^2\n        T_face_p = (p + 1)**2\n        \n        # Calculate R_face(p)\n        R_face_p = T_face_p / Np3\n        \n        # Calculate R_all_faces(p)\n        R_all_faces_p = 4 * T_face_p / Np3\n        \n        results.extend([\n            Np3,\n            T_face_p,\n            round(R_face_p, 6),\n            round(R_all_faces_p, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2919600"}]}