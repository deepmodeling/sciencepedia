{"hands_on_practices": [{"introduction": "热力学势不仅仅是抽象的数学构造，它们是材料本构行为的生成函数。本练习旨在通过一个多孔介质力学的具体实例，演示如何从亥姆霍兹自由能势 $\\psi$ 出发，通过对其求二阶导数来推导关键的材料参数——Biot 模量和耦合系数。掌握这种从势函数推导本构参数的方法，是进行连续介质建模的一项基本功。[@problem_id:2925000]", "problem": "考虑一个均匀、各向同性、等温、小应变的多孔固体，其单位参考体积的 Helmholtz 自由能密度由 $\\,\\psi(\\varepsilon, m)\\,$ 描述，其中 $\\,\\varepsilon\\,$ 是无穷小应变张量，$\\,m\\,$ 是单位参考体积的流体含量。使用等温过程的标准热力学结构，其中与 $\\,\\varepsilon\\,$ 和 $\\,m\\,$ 共轭的热力学力通过对 $\\,\\psi\\,$ 求适当的导数得到，并且 Clausius–Duhem 不等式简化为对 $\\,\\psi\\,$ 的本构约束。在参考状态 $\\,(\\varepsilon, m) = (\\mathbf{0}, 0)\\,$ 下进行分析，并考虑关于此状态的线性化增量。\n\n通过定温下的线性化流体含量关系定义 Biot 耦合系数 $\\,\\alpha\\,$ 和 Biot 模量 $\\,M\\,$\n$$\ndm \\;=\\; \\alpha\\, d(\\operatorname{tr}\\varepsilon) \\;+\\; \\frac{1}{M}\\, dp,\n$$\n其中 $\\,p\\,$ 表示孔隙压力，$\\,\\operatorname{tr}(\\cdot)\\,$ 是迹。从上述热力学结构出发，在不假设 $\\,\\psi\\,$ 的任何先验具体形式的情况下，证明 $\\,\\alpha\\,$ 和 $\\,M\\,$ 可以用在参考状态下求值的 $\\,\\psi\\,$ 的二阶导数表示。\n\n然后，对于特定的二次自由能\n$$\n\\psi(\\varepsilon, m)\n\\;=\\;\n\\frac{1}{2}\\,\\kappa\\,\\big(\\operatorname{tr}\\varepsilon\\big)^{2}\n\\;+\\;\n\\mu\\,\\varepsilon_{\\mathrm{dev}}:\\varepsilon_{\\mathrm{dev}}\n\\;-\\;\n\\beta\\, m\\,\\operatorname{tr}\\varepsilon\n\\;+\\;\n\\frac{1}{2}\\,n\\, m^{2},\n$$\n其中 $\\,\\varepsilon_{\\mathrm{dev}} := \\varepsilon - \\frac{1}{3}\\operatorname{tr}\\varepsilon\\,\\mathbf{I}\\,$, $\\,\\kappa>0\\,$ (体积模量), $\\,\\mu>0\\,$ (剪切模量), $\\,n>0\\,$, 并且选择 $\\,\\beta\\in\\mathbb{R}\\,$ 使得 $\\,\\psi\\,$ 是严格凸的，用 $\\,\\beta\\,$ 和 $\\,n\\,$ 显式计算 $\\,\\alpha\\,$ 和 $\\,M\\,$。将您的最终答案表示为精确的解析表达式。最终答案必须以行矩阵的形式给出，首先是 $\\,\\alpha\\,$，然后是 $\\,M\\,$。", "solution": "该问题陈述经核实具有科学依据、适定且客观。这是多孔介质连续介质力学中的一个标准练习。我们开始解题。\n\n等温、小应变多孔固体的热力学框架建立在单位参考体积的 Helmholtz 自由能密度 $\\psi(\\varepsilon, m)$ 之上，其中 $\\varepsilon$ 是无穷小应变张量， $m$ 是单位参考体积的流体含量。功共轭热力学力是 Cauchy 应力张量 $\\sigma$ 和流体化学势 $\\mu_f$。它们由自由能的导数给出：\n$$\n\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon}(\\varepsilon, m), \\quad \\mu_f = \\frac{\\partial \\psi}{\\partial m}(\\varepsilon, m)\n$$\n我们考虑关于参考状态 $(\\varepsilon, m) = (\\mathbf{0}, 0)$ 的线性化增量，在该状态下，势及其一阶导数假定为零，即 $\\psi(\\mathbf{0}, 0) = 0$，$\\sigma(\\mathbf{0}, 0) = \\mathbf{0}$，以及 $\\mu_f(\\mathbf{0}, 0) = 0$。增量（用 $d(\\cdot)$ 表示，或对于小量直接用变量本身表示）的线性化本构关系由 $\\psi$ 的二阶泰勒展开得到：\n$$\nd\\sigma = \\frac{\\partial^2 \\psi}{\\partial \\varepsilon \\partial \\varepsilon}\\bigg|_{0} : d\\varepsilon + \\frac{\\partial^2 \\psi}{\\partial \\varepsilon \\partial m}\\bigg|_{0} dm\n$$\n$$\nd\\mu_f = \\frac{\\partial^2 \\psi}{\\partial m \\partial \\varepsilon}\\bigg|_{0} : d\\varepsilon + \\frac{\\partial^2 \\psi}{\\partial m^2}\\bigg|_{0} dm\n$$\n记号 $\\cdot|_0$ 表示在参考状态 $(\\varepsilon, m) = (\\mathbf{0}, 0)$ 下求值。根据二阶导数的对称性（Schwarz 定理），我们有 $\\frac{\\partial^2 \\psi}{\\partial \\varepsilon \\partial m} = \\left(\\frac{\\partial^2 \\psi}{\\partial m \\partial \\varepsilon}\\right)^T$。\n\n对于均匀各向同性的材料，标量函数 $\\psi$ 必须仅通过 $\\varepsilon$ 的不变量来依赖于 $\\varepsilon$。对于小应变，这些不变量通常选择为 $\\operatorname{tr}(\\varepsilon)$ 和某个偏应变的度量，如 $\\varepsilon_{\\mathrm{dev}}:\\varepsilon_{\\mathrm{dev}}$。因此，二阶导数张量也必须是各向同性的。混合二阶导数 $\\frac{\\partial^2 \\psi}{\\partial m \\partial \\varepsilon}|_0$ 必须是一个二阶各向同性张量，这意味着它与单位张量 $\\mathbf{I}$ 成正比：\n$$\n\\frac{\\partial^2 \\psi}{\\partial m \\partial \\varepsilon}\\bigg|_{0} = B\\,\\mathbf{I}\n$$\n其中 $B$ 是一个标量常数，由 $B = \\frac{\\partial^2\\psi}{\\partial m \\partial (\\operatorname{tr}\\varepsilon)}\\big|_0$ 给出。我们再定义标量 $N = \\frac{\\partial^2 \\psi}{\\partial m^2}\\big|_0$。化学势增量的方程简化为：\n$$\nd\\mu_f = B\\, (\\mathbf{I} : d\\varepsilon) + N\\, dm = B\\, d(\\operatorname{tr}\\varepsilon) + N\\, dm\n$$\n为了得到 $dm$ 的表达式，我们重新整理此方程：\n$$\nN\\, dm = d\\mu_f - B\\, d(\\operatorname{tr}\\varepsilon) \\implies dm = -\\frac{B}{N}\\,d(\\operatorname{tr}\\varepsilon) + \\frac{1}{N}\\,d\\mu_f\n$$\n问题给出了 Biot 参数 $\\alpha$ 和 $M$ 的唯象定义：\n$$\ndm = \\alpha\\, d(\\operatorname{tr}\\varepsilon) + \\frac{1}{M}\\, dp\n$$\n其中 $p$ 是孔隙压力。为了使该关系与我们的热力学推导一致，必须在孔隙压力 $p$ 和化学势 $\\mu_f$ 之间建立联系。在确保热力学稳定性的多孔介质力学中，标准惯例是直接将孔隙压力的增量等同于化学势的增量，即 $dp = d\\mu_f$。任何其他选择，例如 $dp = -d\\mu_f$，都将与 Biot 模量 $M$ 为正的物理要求相冲突，因为材料的稳定性要求 $N = \\frac{\\partial^2 \\psi}{\\partial m^2}|_0 > 0$。\n\n通过令 $dp = d\\mu_f$ 并比较 $dm$ 的两个表达式，我们可以确定系数：\n$$\n\\alpha = -\\frac{B}{N}, \\qquad \\frac{1}{M} = \\frac{1}{N} \\implies M = N\n$$\n代入 $B$ 和 $N$ 的定义，我们得到用 Helmholtz 自由能的二阶导数表示的 Biot 系数和 Biot 模量的表达式：\n$$\n\\alpha = -\\frac{\\frac{\\partial^2 \\psi}{\\partial m \\partial (\\operatorname{tr}\\varepsilon)}\\bigg|_{(\\mathbf{0},0)}}{\\frac{\\partial^2 \\psi}{\\partial m^2}\\bigg|_{(\\mathbf{0},0)}}, \\qquad M = \\frac{\\partial^2 \\psi}{\\partial m^2}\\bigg|_{(\\mathbf{0},0)}\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们给定了特定的二次自由能密度：\n$$\n\\psi(\\varepsilon, m) = \\frac{1}{2}\\,\\kappa\\,\\big(\\operatorname{tr}\\varepsilon\\big)^{2} + \\mu\\,\\varepsilon_{\\mathrm{dev}}:\\varepsilon_{\\mathrm{dev}} - \\beta\\, m\\,\\operatorname{tr}\\varepsilon + \\frac{1}{2}\\,n\\, m^{2}\n$$\n我们计算所需的二阶导数。首先，关于 $m$ 的偏导数是：\n$$\n\\frac{\\partial \\psi}{\\partial m} = - \\beta\\,\\operatorname{tr}\\varepsilon + n\\, m\n$$\n现在，我们计算在参考状态 $(\\varepsilon, m) = (\\mathbf{0}, 0)$ 下的二阶导数：\n$$\n\\frac{\\partial^2 \\psi}{\\partial m^2}\\bigg|_{(\\mathbf{0},0)} = \\frac{\\partial}{\\partial m} \\big( - \\beta\\,\\operatorname{tr}\\varepsilon + n\\, m \\big) \\bigg|_{(\\mathbf{0},0)} = n\n$$\n$$\n\\frac{\\partial^2 \\psi}{\\partial m \\partial (\\operatorname{tr}\\varepsilon)}\\bigg|_{(\\mathbf{0},0)} = \\frac{\\partial}{\\partial (\\operatorname{tr}\\varepsilon)} \\big( - \\beta\\,\\operatorname{tr}\\varepsilon + n\\, m \\big) \\bigg|_{(\\mathbf{0},0)} = -\\beta\n$$\n将这些结果代入 $\\alpha$ 和 $M$ 的一般表达式中：\n$$\nM = \\frac{\\partial^2 \\psi}{\\partial m^2}\\bigg|_{(\\mathbf{0},0)} = n\n$$\n$$\n\\alpha = -\\frac{\\frac{\\partial^2 \\psi}{\\partial m \\partial (\\operatorname{tr}\\varepsilon)}\\big|_{(\\mathbf{0},0)}}{\\frac{\\partial^2 \\psi}{\\partial m^2}\\big|_{(\\mathbf{0},0)}} = -\\frac{-\\beta}{n} = \\frac{\\beta}{n}\n$$\n$\\psi$ 是严格凸的条件意味着 $n > 0$ 和 $\\kappa n > \\beta^2$，这确保了 $\\alpha$ 和 $M$ 都是良定义的，并且 $M$ 是正的。\n\nBiot 系数和 Biot 模量的最终表达式为 $\\alpha = \\beta/n$ 和 $M = n$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\beta}{n} & n\n\\end{pmatrix}\n}\n$$", "id": "2925000"}, {"introduction": "麦克斯韦关系是热力学理论自洽性的优美体现，它源于热力学势作为状态函数其混合偏导数具有对称性。本练习将理论与计算实践相结合，要求您基于一个具体的线性热弹性模型，通过数值方法验证麦克斯韦关系。这个过程不仅能加深您对共轭变量（如应力与熵）及其导数物理意义的理解，还能训练您在计算科学中验证理论模型的关键技能。[@problem_id:2924996]", "problem": "您需要使用一个热力学势，在小应变各向同性热弹性力学中实现并验证一个 Maxwell 型关系。在三维空间中进行，所有张量均按常规索引表示法视为二阶张量。您必须使用的基本依据包括：单位参考体积的 Helmholtz 自由能密度的定义、Cauchy 应力和熵的共轭定义，以及线性各向同性弹性张量的形式。\n\n模型说明：\n- 令 Helmholtz 自由能密度为\n$$\n\\psi(\\varepsilon,T)\n=\n\\frac{1}{2}\\,\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big):\\mathbb{C}:\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big)\n\\;+\\;\nc_v\\Big(T - T_0 - T\\ln\\frac{T}{T_0}\\Big),\n$$\n其中 $\\,\\varepsilon\\,$ 是小应变张量，$\\,T\\,$ 是绝对温度，$\\,T_0\\,$ 是一个固定的参考温度，$\\,\\alpha\\,$ 是线性热膨胀系数，$\\,c_v\\,$ 是定容体积热容，$\\,\\mathbf{I}\\,$ 是二阶单位张量，而 $\\,\\mathbb{C}\\,$ 是四阶各向同性弹性张量，通过 Lamé 参数 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 表征如下：\n$$\n\\mathbb{C}:\\mathbf{E} \\;=\\; 2\\mu\\,\\mathbf{E} \\;+\\; \\lambda\\,\\mathrm{tr}(\\mathbf{E})\\,\\mathbf{I}\n\\quad \\text{对任意对称张量 } \\mathbf{E}.\n$$\n- Cauchy 应力 $\\,\\sigma\\,$ 和单位参考体积的熵 $\\,s\\,$ 由共轭关系定义：\n$$\n\\sigma(\\varepsilon,T) \\;=\\; \\frac{\\partial \\psi}{\\partial \\varepsilon}(\\varepsilon,T),\n\\qquad\ns(\\varepsilon,T) \\;=\\; -\\,\\frac{\\partial \\psi}{\\partial T}(\\varepsilon,T).\n$$\n\n任务：\n- 仅使用上述基本定义，数值计算以下两个混合偏导数\n$$\n\\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\varepsilon}\n\\quad \\text{和} \\quad\n-\\,\\left(\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\\right)_{T}\n$$\n并对下面的每个测试用例进行逐分量验证 Maxwell 关系\n$$\n\\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\varepsilon}\n\\;=\\;\n-\\,\\left(\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\\right)_{T}\n$$\n\n数值微分要求：\n- 两种导数均使用中心有限差分。\n- 对于固定应变下的温度导数，使用温度增量 $\\,\\Delta T = 10^{-6}\\,\\mathrm{K}\\,$：\n$$\n\\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\varepsilon}\n\\;\\approx\\;\n\\frac{\\sigma_{ij}(\\varepsilon,T+\\Delta T) - \\sigma_{ij}(\\varepsilon,T-\\Delta T)}{2\\,\\Delta T}.\n$$\n- 对于固定温度下的熵导数，使用应变增量 $\\,\\Delta \\varepsilon = 10^{-8}\\,$ 一次扰动一个独立的对称应变分量。对于 $\\,i=j\\,$，仅扰动 $\\,\\varepsilon_{ii}\\,$。对于 $\\,i\\neq j\\,$，以相同的量同时扰动 $\\,\\varepsilon_{ij}\\,$ 和 $\\,\\varepsilon_{ji}\\,$，以保持在对称应变空间内。使用：\n$$\n\\left(\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\\right)_{T}\n\\;\\approx\\;\n\\frac{s(\\varepsilon + \\Delta \\varepsilon\\,\\mathbf{E}^{(ij)}_{\\mathrm{sym}},T) - s(\\varepsilon - \\Delta \\varepsilon\\,\\mathbf{E}^{(ij)}_{\\mathrm{sym}},T)}{2\\,\\Delta \\varepsilon},\n$$\n其中 $\\,\\mathbf{E}^{(ij)}_{\\mathrm{sym}}\\,$ 是对称基张量，当 $\\,i\\neq j\\,$ 时在 $\\,\\{(i,j),(j,i)\\}\\,$ 位置的元素为 1，当 $\\,i=j\\,$ 时在 $\\,\\{(i,i)\\}\\,$ 位置的元素为 1，其他位置的元素均为零。\n\n验证指标：\n- 令 $\\,\\mathbf{A}\\in\\mathbb{R}^{3\\times 3}\\,$ 为元素是 $\\,A_{ij} = \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\varepsilon}\\,$ 的矩阵，$\\,\\mathbf{B}\\in\\mathbb{R}^{3\\times 3}\\,$ 为元素是 $\\,B_{ij} = -\\left(\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\\right)_{T}\\,$ 的矩阵。计算 Frobenius 范数残差\n$$\nr \\;=\\; \\|\\mathbf{A} - \\mathbf{B}\\|_F.\n$$\n如果满足以下条件，则接受 Maxwell 关系：\n$$\nr \\;\\le\\; \\mathrm{atol} \\;+\\; \\mathrm{rtol}\\,\\max\\big(\\|\\mathbf{A}\\|_F,\\,\\|\\mathbf{B}\\|_F\\big),\n$$\n其中绝对容差 $\\,\\mathrm{atol} = 10^{-4}\\,\\mathrm{Pa/K}\\,$，相对容差 $\\,\\mathrm{rtol} = 10^{-12}\\,$。\n\n物理单位：\n- $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 的单位为 $\\mathrm{Pa}$，$\\,\\alpha\\,$ 的单位为 $\\mathrm{K}^{-1}$，$\\,c_v\\,$ 的单位为 $\\mathrm{J}/(\\mathrm{m}^3\\,\\mathrm{K})$，$\\,T\\,$ 和 $\\,T_0\\,$ 的单位为 $\\mathrm{K}$，$\\,\\varepsilon\\,$ 是无量纲的。导数 $\\,\\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\varepsilon}\\,$ 和 $-\\left(\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\\right)_{T}\\,$ 的单位为 $\\mathrm{Pa/K}$。\n\n测试组：\n提供以下五个参数集。每个用例是一个元组 $\\,(\\lambda,\\mu,\\alpha,c_v,T_0,T,\\varepsilon)\\,$，其中 $\\,\\varepsilon\\,$ 由其矩阵分量给出：\n1. 用例 $\\,1\\,$ （一般情况，非静水压力，非等温）：\n   - $\\,\\lambda = 50\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\alpha = 1.2\\times 10^{-5}\\,\\mathrm{K}^{-1}$，$\\,c_v = 3.0\\times 10^{6}\\,\\mathrm{J}/(\\mathrm{m}^3\\,\\mathrm{K})$，$\\,T_0 = 293.15\\,\\mathrm{K}$，$\\,T = 350\\,\\mathrm{K}$，\n   - $\\,\\varepsilon = \\begin{bmatrix}\n   1.0\\times 10^{-3} & 0.5\\times 10^{-3} & -0.2\\times 10^{-3}\\\\\n   0.5\\times 10^{-3} & 2.0\\times 10^{-3} & 0.3\\times 10^{-3}\\\\\n   -0.2\\times 10^{-3} & 0.3\\times 10^{-3} & -1.5\\times 10^{-3}\n   \\end{bmatrix}$。\n2. 用例 $\\,2\\,$ （零热膨胀边界）：\n   - $\\,\\lambda = 80\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\mu = 40\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\alpha = 0$，$\\,c_v = 2.5\\times 10^{6}\\,\\mathrm{J}/(\\mathrm{m}^3\\,\\mathrm{K})$，$\\,T_0 = 300\\,\\mathrm{K}$，$\\,T = 1000\\,\\mathrm{K}$，\n   - $\\,\\varepsilon = \\begin{bmatrix}\n   1.5\\times 10^{-3} & -0.4\\times 10^{-3} & 0.7\\times 10^{-3}\\\\\n   -0.4\\times 10^{-3} & -0.8\\times 10^{-3} & 0.1\\times 10^{-3}\\\\\n   0.7\\times 10^{-3} & 0.1\\times 10^{-3} & 0.2\\times 10^{-3}\n   \\end{bmatrix}$。\n3. 用例 $\\,3\\,$ （参考温度下的等温，静水应变）：\n   - $\\,\\lambda = 60\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\mu = 20\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\alpha = 9\\times 10^{-6}\\,\\mathrm{K}^{-1}$，$\\,c_v = 3.2\\times 10^{6}\\,\\mathrm{J}/(\\mathrm{m}^3\\,\\mathrm{K})$，$\\,T_0 = 300\\,\\mathrm{K}$，$\\,T = 300\\,\\mathrm{K}$，\n   - $\\,\\varepsilon = 1.0\\times 10^{-4}\\,\\mathbf{I}$。\n4. 用例 $\\,4\\,$ （负热膨胀）：\n   - $\\,\\lambda = 10\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\mu = 5\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\alpha = -5.0\\times 10^{-6}\\,\\mathrm{K}^{-1}$，$\\,c_v = 1.5\\times 10^{6}\\,\\mathrm{J}/(\\mathrm{m}^3\\,\\mathrm{K})$，$\\,T_0 = 400\\,\\mathrm{K}$，$\\,T = 200\\,\\mathrm{K}$，\n   - $\\,\\varepsilon = \\begin{bmatrix}\n   -0.6\\times 10^{-3} & 0.2\\times 10^{-3} & 0.0\\\\\n   0.2\\times 10^{-3} & 0.9\\times 10^{-3} & -0.3\\times 10^{-3}\\\\\n   0.0 & -0.3\\times 10^{-3} & 0.4\\times 10^{-3}\n   \\end{bmatrix}$。\n5. 用例 $\\,5\\,$ （高刚度固体，宽温差）：\n   - $\\,\\lambda = 200\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\mu = 150\\times 10^{9}\\,\\mathrm{Pa}$，$\\,\\alpha = 1.0\\times 10^{-6}\\,\\mathrm{K}^{-1}$，$\\,c_v = 4.0\\times 10^{6}\\,\\mathrm{J}/(\\mathrm{m}^3\\,\\mathrm{K})$，$\\,T_0 = 100\\,\\mathrm{K}$，$\\,T = 600\\,\\mathrm{K}$，\n   - $\\,\\varepsilon = \\begin{bmatrix}\n   0.3\\times 10^{-3} & -0.1\\times 10^{-3} & 0.25\\times 10^{-3}\\\\\n   -0.1\\times 10^{-3} & -0.2\\times 10^{-3} & 0.15\\times 10^{-3}\\\\\n   0.25\\times 10^{-3} & 0.15\\times 10^{-3} & 0.05\\times 10^{-3}\n   \\end{bmatrix}$。\n\n计算要求：\n- 根据模型定义实现计算 $\\,\\psi(\\varepsilon,T)\\,$、$\\,\\sigma(\\varepsilon,T)\\,$ 和 $\\,s(\\varepsilon,T)\\,$ 的函数。\n- 按要求实现中心有限差分近似。\n- 对于每个测试用例，计算一个布尔值，指示 Maxwell 关系在上述容差标准下是否成立。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[true1,true2,true3,true4,true5]\"，但使用 Python 布尔字面量）。每个条目必须是与测试用例 1 到 5 按顺序对应的布尔值。不允许有其他输出。", "solution": "用户要求在小应变各向同性热弹性力学中对一个 Maxwell 关系进行数值验证。该问题被确认为科学上合理、适定且客观。它基于连续介质热力学的标准原理，并为获得唯一解提供了所有必要信息。\n\n问题的核心是验证由 Helmholtz 自由能密度 $\\,\\psi(\\varepsilon, T)\\,$ 的混合偏导数对称性产生的等式：\n$$\n\\frac{\\partial^2 \\psi}{\\partial T \\partial \\varepsilon_{ij}} = \\frac{\\partial^2 \\psi}{\\partial \\varepsilon_{ij} \\partial T}\n$$\n根据 Cauchy 应力 $\\,\\sigma_{ij} = \\frac{\\partial \\psi}{\\partial \\varepsilon_{ij}}\\,$ 和熵密度 $\\,s = -\\frac{\\partial \\psi}{\\partial T}\\,$ 的共轭定义，该等式直接转化为 Maxwell 关系：\n$$\n\\frac{\\partial \\sigma_{ij}}{\\partial T} = -\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\n$$\n我们的任务是数值计算该方程的两边，并在指定的容差范围内验证其相等性。\n\n首先，我们必须通过对给定的 Helmholtz 自由能密度求导，来建立 $\\,\\sigma\\,$ 和 $\\,s\\,$ 的显式解析形式：\n$$\n\\psi(\\varepsilon,T)\n=\n\\frac{1}{2}\\,\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big):\\mathbb{C}:\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big)\n\\;+\\;\nc_v\\Big(T - T_0 - T\\ln\\frac{T}{T_0}\\Big)\n$$\n四阶各向同性弹性张量 $\\,\\mathbb{C}\\,$ 通过其对一个对称二阶张量 $\\,\\mathbf{E}\\,$ 的作用来定义，即 $\\,\\mathbb{C}:\\mathbf{E} = 2\\mu\\,\\mathbf{E} + \\lambda\\,\\mathrm{tr}(\\mathbf{E})\\,\\mathbf{I}\\,$.\n\n**1. Cauchy 应力 $\\,\\sigma\\,$ 的推导**\n\nCauchy 应力张量定义为 $\\,\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon}\\,$。对 $\\,\\psi\\,$ 的力学部分关于应变张量 $\\,\\varepsilon\\,$ 求导，得到：\n$$\n\\sigma = \\frac{\\partial}{\\partial \\varepsilon} \\left[ \\frac{1}{2}\\,\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big):\\mathbb{C}:\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big) \\right]\n$$\n利用双点积的性质以及 $\\,\\mathbb{C}\\,$ 和 $\\,\\varepsilon\\,$ 的对称性，上式可简化为：\n$$\n\\sigma(\\varepsilon, T) = \\mathbb{C}:\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big)\n$$\n代入 $\\,\\mathbb{C}\\,$ 的表达式：\n$$\n\\sigma = 2\\mu\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big) + \\lambda\\,\\mathrm{tr}\\big(\\varepsilon - \\alpha\\,(T-T_0)\\,\\mathbf{I}\\big)\\,\\mathbf{I}\n$$\n由于 $\\,\\mathrm{tr}(\\mathbf{I})=3\\,$，我们有 $\\,\\mathrm{tr}\\big(\\alpha\\,(T-T_0)\\,\\mathbf{I}\\big) = 3\\alpha(T-T_0)\\,$。这导出了应力的最终表达式，即著名的 Duhamel-Neumann 本构律：\n$$\n\\sigma(\\varepsilon, T) = \\big(2\\mu\\varepsilon + \\lambda\\,\\mathrm{tr}(\\varepsilon)\\,\\mathbf{I}\\big) - (2\\mu+3\\lambda)\\alpha(T-T_0)\\,\\mathbf{I}\n$$\n该解析表达式将用于计算应力张量。\n\n**2. 熵密度 $\\,s\\,$ 的推导**\n\n熵密度定义为 $\\,s = -\\frac{\\partial \\psi}{\\partial T}\\,$。我们对 $\\,\\psi\\,$ 关于温度 $\\,T\\,$ 逐项求导，同时保持应变 $\\,\\varepsilon\\,$ 不变。\n令 $\\,\\varepsilon_{th}(T) = \\alpha(T-T_0)\\mathbf{I}\\,$。$\\,\\psi\\,$ 的力学部分通过 $\\,\\varepsilon_{th}\\,$ 成为 $\\,T\\,$ 的函数。使用链式法则：\n$$\n\\frac{\\partial \\psi_{\\mathrm{mech}}}{\\partial T} = \\frac{\\partial \\psi_{\\mathrm{mech}}}{\\partial \\varepsilon_{th}} : \\frac{\\partial \\varepsilon_{th}}{\\partial T}\n$$\n从 $\\,\\psi_{\\mathrm{mech}}\\,$ 的结构中，我们可以识别出 $\\,\\frac{\\partial \\psi_{\\mathrm{mech}}}{\\partial \\varepsilon_{th}} = -\\sigma\\,$。热应变的导数为 $\\,\\frac{\\partial \\varepsilon_{th}}{\\partial T} = \\alpha\\mathbf{I}\\,$。因此，$\\,\\frac{\\partial \\psi_{\\mathrm{mech}}}{\\partial T} = -\\sigma : (\\alpha\\mathbf{I}) = -\\alpha\\,\\mathrm{tr}(\\sigma)\\,$。\n代入 $\\,\\mathrm{tr}(\\sigma) = (2\\mu+3\\lambda)\\mathrm{tr}(\\varepsilon) - 3(2\\mu+3\\lambda)\\alpha(T-T_0)\\,$ 的表达式，得到：\n$$\n\\frac{\\partial \\psi_{\\mathrm{mech}}}{\\partial T} = -(2\\mu+3\\lambda)\\alpha \\big( \\mathrm{tr}(\\varepsilon) - 3\\alpha(T-T_0) \\big)\n$$\n$\\,\\psi\\,$ 的热学部分的导数是：\n$$\n\\frac{\\partial \\psi_{\\mathrm{th}}}{\\partial T} = \\frac{\\partial}{\\partial T} \\left[ c_v\\Big(T - T_0 - T\\ln\\frac{T}{T_0}\\Big) \\right] = c_v\\left(1 - \\left(\\ln\\frac{T}{T_0} + T\\cdot\\frac{1}{T}\\right)\\right) = -c_v\\ln\\frac{T}{T_0}\n$$\n组合各部分，$\\,\\frac{\\partial \\psi}{\\partial T} = \\frac{\\partial \\psi_{\\mathrm{mech}}}{\\partial T} + \\frac{\\partial \\psi_{\\mathrm{th}}}{\\partial T}\\,$。因此熵为：\n$$\ns(\\varepsilon, T) = -\\frac{\\partial \\psi}{\\partial T} = (2\\mu+3\\lambda)\\alpha \\big( \\mathrm{tr}(\\varepsilon) - 3\\alpha(T-T_0) \\big) + c_v\\ln\\frac{T}{T_0}\n$$\n该解析表达式将用于计算熵密度。\n\n**3. 数值验证程序**\n\n验证需要计算两个矩阵 $\\,\\mathbf{A}\\,$ 和 $\\,\\mathbf{B}\\,$，其分量定义如下：\n$$\nA_{ij} = \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\varepsilon} \\qquad B_{ij} = -\\left(\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\\right)_{T}\n$$\n这些导数按规定使用中心有限差分进行近似。\n\n对于矩阵 $\\,\\mathbf{A}\\,$，我们使用温度扰动 $\\,\\Delta T = 10^{-6}\\,\\mathrm{K}\\,$：\n$$\n\\mathbf{A} \\approx \\frac{\\sigma(\\varepsilon, T+\\Delta T) - \\sigma(\\varepsilon, T-\\Delta T)}{2\\,\\Delta T}\n$$\n整个矩阵 $\\,\\mathbf{A}\\,$ 可以通过两次调用实现 $\\,\\sigma(\\varepsilon, T)\\,$ 解析表达式的函数来计算。\n\n对于矩阵 $\\,\\mathbf{B}\\,$，我们必须使用应变扰动 $\\,\\Delta \\varepsilon = 10^{-8}\\,$ 来计算标量 $\\,s\\,$ 对张量 $\\,\\varepsilon\\,$ 每个分量的导数。扰动必须遵循应变张量的对称性。为此定义了一个基张量 $\\,\\mathbf{E}^{(ij)}_{\\mathrm{sym}}\\,$：\n$$\n\\mathbf{E}^{(ii)}_{\\mathrm{sym}} \\text{ 在 } (i,i) \\text{ 处的元素为 } 1 \\text{，其他位置为 } 0 \\text{。}\n$$\n$$\n\\mathbf{E}^{(ij)}_{\\mathrm{sym}} \\text{ (当 } i\\neq j \\text{ 时) 在 } (i,j) \\text{ 和 } (j,i) \\text{ 处的元素为 } 1 \\text{，其他位置为 } 0 \\text{。}\n$$\n导数分量 $\\,(\\partial s / \\partial \\varepsilon_{ij})\\,$ 随后通过以下方式近似：\n$$\n\\left(\\frac{\\partial s}{\\partial \\varepsilon_{ij}}\\right)_{T} \\approx \\frac{s(\\varepsilon + \\Delta\\varepsilon\\,\\mathbf{E}^{(ij)}_{\\mathrm{sym}}, T) - s(\\varepsilon - \\Delta\\varepsilon\\,\\mathbf{E}^{(ij)}_{\\mathrm{sym}}, T)}{2\\,\\Delta\\varepsilon}\n$$\n关键要注意到，对于仅依赖于应变张量迹 $\\,\\mathrm{tr}(\\varepsilon)\\,$ 的熵函数 $\\,s\\,$ 的特定形式，此有限差分格式能正确计算分量导数 $\\,\\partial s / \\partial \\varepsilon_{ij}\\,$。对于一个非对角分量（$i \\neq j$），$\\,\\mathrm{tr}(\\mathbf{E}^{(ij)}_{\\mathrm{sym}}) = 0\\,$，因此扰动不会改变 $\\,\\mathrm{tr}(\\varepsilon)\\,$，从而导致导数为零，这在解析上是正确的。对于一个对角分量（$i=j$），$\\,\\mathrm{tr}(\\mathbf{E}^{(ii)}_{\\mathrm{sym}}) = 1\\,$，该公式能正确计算关于 $\\,\\varepsilon_{ii}\\,$ 的导数。$\\,\\mathbf{B}\\,$ 的分量由 $\\,B_{ij} = - (\\partial s / \\partial \\varepsilon_{ij})_T\\,$ 给出。\n\n**4. 验证指标**\n\n最后，如果残差矩阵的 Frobenius 范数 $\\,r = \\|\\mathbf{A} - \\mathbf{B}\\|_F\\,$ 满足混合容差标准，则认为 Maxwell 关系在数值上得到验证：\n$$\nr \\le \\mathrm{atol} + \\mathrm{rtol}\\,\\max\\big(\\|\\mathbf{A}\\|_F, \\|\\mathbf{B}\\|_F\\big)\n$$\n其中给定的容差为绝对容差 $\\,\\mathrm{atol} = 10^{-4}\\,\\mathrm{Pa/K}\\,$ 和相对容差 $\\,\\mathrm{rtol} = 10^{-12}\\,$。此过程将应用于五个测试用例中的每一个。实现将遵循此逻辑以生成最终的布尔结果。", "answer": "```python\nimport numpy as np\n\ndef compute_sigma(eps, T, lam, mu, alpha, T0):\n    \"\"\"\n    Computes the Cauchy stress tensor sigma based on the Duhamel-Neumann law.\n    \n    Args:\n        eps (np.ndarray): Small strain tensor (3x3).\n        T (float): Absolute temperature in K.\n        lam (float): Lamé's first parameter in Pa.\n        mu (float): Lamé's second parameter (shear modulus) in Pa.\n        alpha (float): Coefficient of linear thermal expansion in 1/K.\n        T0 (float): Reference temperature in K.\n        \n    Returns:\n        np.ndarray: Cauchy stress tensor (3x3) in Pa.\n    \"\"\"\n    tr_eps = np.trace(eps)\n    I = np.identity(3)\n    K3 = 2 * mu + 3 * lam  # This is 3 * Bulk Modulus K\n    \n    sigma_mech = 2 * mu * eps + lam * tr_eps * I\n    sigma_th = K3 * alpha * (T - T0) * I\n    \n    return sigma_mech - sigma_th\n\ndef compute_s(eps, T, lam, mu, alpha, cv, T0):\n    \"\"\"\n    Computes the entropy density s.\n    \n    Args:\n        eps (np.ndarray): Small strain tensor (3x3).\n        T (float): Absolute temperature in K.\n        lam (float): Lamé's first parameter in Pa.\n        mu (float): Lamé's second parameter (shear modulus) in Pa.\n        alpha (float): Coefficient of linear thermal expansion in 1/K.\n        cv (float): Volumetric heat capacity at constant volume in J/(m^3*K).\n        T0 (float): Reference temperature in K.\n        \n    Returns:\n        float: Entropy density in J/(m^3*K) or Pa/K.\n    \"\"\"\n    if T == 0:\n        # The model assumes T > 0 Kelvin.\n        # This case is not expected based on the problem's test suite.\n        return np.nan\n\n    tr_eps = np.trace(eps)\n    K3 = 2 * mu + 3 * lam\n    \n    s_coupling = K3 * alpha * (tr_eps - 3 * alpha * (T - T0))\n    s_thermal = cv * np.log(T / T0) if T > 0 else -np.inf\n    \n    return s_coupling + s_thermal\n\ndef verify_case(case):\n    \"\"\"\n    Verifies the Maxwell relation for a single test case.\n    \"\"\"\n    lam, mu, alpha, cv, T0, T, eps = case\n    \n    # Numerical differentiation parameters\n    delta_T = 1e-6\n    delta_eps = 1e-8\n    \n    # Verification tolerance parameters\n    atol = 1e-4\n    rtol = 1e-12\n\n    # Compute Matrix A = (d(sigma)/dT)_eps\n    sigma_p = compute_sigma(eps, T + delta_T, lam, mu, alpha, T0)\n    sigma_m = compute_sigma(eps, T - delta_T, lam, mu, alpha, T0)\n    A = (sigma_p - sigma_m) / (2 * delta_T)\n\n    # Compute Matrix B = -(ds/deps)_T\n    B = np.zeros((3, 3))\n    for i in range(3):\n        for j in range(3):\n            E_ij_sym = np.zeros((3, 3))\n            if i == j:\n                E_ij_sym[i, i] = 1.0\n            else:\n                E_ij_sym[i, j] = 1.0\n                E_ij_sym[j, i] = 1.0\n            \n            eps_p = eps + delta_eps * E_ij_sym\n            eps_m = eps - delta_eps * E_ij_sym\n\n            s_p = compute_s(eps_p, T, lam, mu, alpha, cv, T0)\n            s_m = compute_s(eps_m, T, lam, mu, alpha, cv, T0)\n\n            ds_deps_ij = (s_p - s_m) / (2 * delta_eps)\n            B[i, j] = -ds_deps_ij\n    \n    # Verify the Maxwell relation using the specified tolerance criterion\n    norm_A = np.linalg.norm(A, 'fro')\n    norm_B = np.linalg.norm(B, 'fro')\n    residual = np.linalg.norm(A - B, 'fro')\n    tolerance = atol + rtol * max(norm_A, norm_B)\n    \n    return residual = tolerance\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        (50e9, 30e9, 1.2e-5, 3.0e6, 293.15, 350, \n         np.array([[1.0e-3, 0.5e-3, -0.2e-3], \n                   [0.5e-3, 2.0e-3, 0.3e-3], \n                   [-0.2e-3, 0.3e-3, -1.5e-3]])),\n        (80e9, 40e9, 0, 2.5e6, 300, 1000, \n         np.array([[1.5e-3, -0.4e-3, 0.7e-3], \n                   [-0.4e-3, -0.8e-3, 0.1e-3], \n                   [0.7e-3, 0.1e-3, 0.2e-3]])),\n        (60e9, 20e9, 9e-6, 3.2e6, 300, 300, \n         1.0e-4 * np.identity(3)),\n        (10e9, 5e9, -5.0e-6, 1.5e6, 400, 200, \n         np.array([[-0.6e-3, 0.2e-3, 0.0], \n                   [0.2e-3, 0.9e-3, -0.3e-3], \n                   [0.0, -0.3e-3, 0.4e-3]])),\n        (200e9, 150e9, 1.0e-6, 4.0e6, 100, 600, \n         np.array([[0.3e-3, -0.1e-3, 0.25e-3], \n                   [-0.1e-3, -0.2e-3, 0.15e-3], \n                   [0.25e-3, 0.15e-3, 0.05e-3]]))\n    ]\n\n    results = []\n    for case in test_cases:\n        result = verify_case(case)\n        results.append(str(result).lower())\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2924996"}, {"introduction": "连接微观物理与宏观材料性能是计算材料科学的核心目标之一。本练习将引导您完成一个贯穿不同尺度的综合性计算任务：从原子的成对相互作用（Lennard-Jones 势）出发，结合准谐振德拜模型构建亥姆霍兹自由能，进而预测晶体材料的宏观热膨胀系数 $\\alpha(T)$。通过该实践，您将亲身体验如何利用热力学势作为桥梁，实现从微观机理到宏观属性的预测，这是现代材料设计与模拟中的一种强大范式。[@problem_id:2924969]", "problem": "考虑一个各向同性晶体，其模型为面心立方晶格，对相互作用由 Lennard-Jones 势给出。在温度 $T$ 和单位原子体积 $V$ 下，每个原子的亥姆霍兹自由能定义为 $F(T,V)=U(V)+F_{\\mathrm{vib}}(T,V)$，其中 $U(V)$ 是每个原子的静态晶格能，$F_{\\mathrm{vib}}(T,V)$ 是准谐振子德拜模型中的振动亥姆霍兹自由能。计算中，能量单位为电子伏特 (eV)，体积单位为埃的三次方 ($\\mathrm{\\AA}^3$)，温度单位为开尔文 (K)。任务是设计并实现一个程序，该程序对于指定的参数集，在每个指定温度下对 $F(T,V)$ 关于 $V$ 进行数值最小化，计算出平衡体积 $V^{\\star}(T)$，然后使用温度的有限差分近似来预测由 $\\alpha(T)=\\frac{1}{V^{\\star}(T)}\\left.\\frac{\\partial V^{\\star}(T)}{\\partial T}\\right|_{P}$ 定义的体积热膨胀系数 $\\alpha(T)$。最终的 $\\alpha(T)$ 值以 $\\mathrm{K}^{-1}$ 为单位表示，并四舍五入到八位小数。\n\n使用以下基本和建模假设：\n\n- 对势是 Lennard-Jones $12$–$6$ 势 $\\phi(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$，其中 $\\varepsilon$ 是势阱深度（单位为 $\\mathrm{eV}$），$\\sigma$ 是长度标度（单位为 $\\mathrm{\\AA}$）。对于面心立方晶格，每个原子的静态能量为\n$$\nU(V)=\\frac{1}{2}\\sum_{j}\\phi(r_j)=2\\varepsilon\\left[S_{12}\\left(\\frac{\\sigma}{r_{\\mathrm{nn}}(V)}\\right)^{12}-S_{6}\\left(\\frac{\\sigma}{r_{\\mathrm{nn}}(V)}\\right)^{6}\\right],\n$$\n其中 $S_{6}=14.45392$ 和 $S_{12}=12.13188$ 是面心立方结构的无量纲晶格和，$r_{\\mathrm{nn}}(V)$ 是作为 $V$ 函数的最近邻距离。对于面心立方结构，晶格常数为 $a(V)=(4V)^{1/3}$，最近邻距离为 $r_{\\mathrm{nn}}(V)=a(V)/\\sqrt{2}$。\n\n- 在德拜模型中，每个原子的振动亥姆霍兹自由能（包括零点能）为\n$$\nF_{\\mathrm{vib}}(T,V)=9k_{\\mathrm{B}}T\\left(\\frac{T}{\\Theta_{\\mathrm{D}}(V)}\\right)^{3}\\int_{0}^{\\Theta_{\\mathrm{D}}(V)/T}y^{2}\\ln\\left(1-e^{-y}\\right)\\,\\mathrm{d}y+\\frac{9}{8}k_{\\mathrm{B}}\\Theta_{\\mathrm{D}}(V),\n$$\n对于 $T0$，而在 $T=0$ 时简化为 $F_{\\mathrm{vib}}(0,V)=\\frac{9}{8}k_{\\mathrm{B}}\\Theta_{\\mathrm{D}}(V)$。这里 $k_{\\mathrm{B}}$ 是以 $\\mathrm{eV/K}$ 为单位的玻尔兹曼常数，$\\Theta_{\\mathrm{D}}(V)$ 是德拜温度。假设其具有 Grüneisen 型的体积依赖性，\n$$\n\\Theta_{\\mathrm{D}}(V)=\\Theta_{\\mathrm{D},0}\\left(\\frac{V}{V_{0}}\\right)^{-\\gamma},\n$$\n其中 $\\Theta_{\\mathrm{D},0}$ 是在 $T=0$ 静态晶格平衡单位原子体积 $V_{0}$ 时的德拜温度，$\\gamma$ 是（无量纲的）Grüneisen 参数。\n\n- 每个温度下的平衡体积由固定 $T$ 下的条件 $\\frac{\\partial F(T,V)}{\\partial V}=0$（零外部压力）获得，您必须通过在每个指定的 $T$ 下对 $F(T,V)$ 关于 $V$ 进行直接数值最小化来实现。\n\n- 热膨胀系数必须根据定义 $\\alpha(T)=\\frac{1}{V^{\\star}(T)}\\frac{\\mathrm{d}V^{\\star}(T)}{\\mathrm{d}T}$，使用温度的有限差分近似进行计算。尽可能使用小的对称温度增量 $\\Delta T$。在温度网格点 $T_i$ 上，当 $T_i-\\Delta T$ 和 $T_i+\\Delta T$ 均为非负时，使用中心差分 $\\frac{V^{\\star}(T_i+\\Delta T)-V^{\\star}(T_i-\\Delta T)}{2\\Delta T}$；否则，使用步长为 $\\Delta T$ 的单边差分。\n\n常数和单位约定：\n\n- 使用 $k_{\\mathrm{B}}=8.617333262\\times 10^{-5}\\ \\mathrm{eV/K}$。\n- 所有能量必须以 $\\mathrm{eV}$ 为单位，体积以 $\\mathrm{\\AA}^3$ 为单位，温度以 $\\mathrm{K}$ 为单位。最终的 $\\alpha(T)$ 必须以 $\\mathrm{K}^{-1}$ 为单位。\n\n算法要求：\n\n- 对于每个测试用例，首先通过对 $U(V)$ 关于 $V$ 进行最小化来获得 $V_{0}$。\n- 然后，对于每个列出的温度 $T$，在一个围绕 $V_{0}$ 的物理上合理的区间内进行有界搜索，以数值方式最小化 $F(T,V)$ 关于 $V$。\n- 使用您选择的温度增量 $\\Delta T$（但在解决方案中需给出理由，并在所有测试用例中一致实现）通过有限差分计算 $\\alpha(T)$。\n- 将每个 $\\alpha(T)$ 值四舍五入并报告至八位小数。\n\n测试套件：\n\n为以下三个测试用例提供结果。每个用例由 $(\\varepsilon,\\sigma,\\Theta_{\\mathrm{D},0},\\gamma,\\{T\\ \\mathrm{grid}\\})$ 定义，其中 $\\varepsilon$ 的单位是 $\\mathrm{eV}$，$\\sigma$ 的单位是 $\\mathrm{\\AA}$，$\\Theta_{\\mathrm{D},0}$ 的单位是 $\\mathrm{K}$，$\\gamma$ 是无量纲的：\n\n- 用例 1: $(\\varepsilon, \\sigma, \\Theta_{\\mathrm{D},0}, \\gamma) = (0.0104, 3.405, 92, 2.0)$ 和温度 $\\{0, 50, 100, 200\\}$。\n- 用例 2: $(\\varepsilon, \\sigma, \\Theta_{\\mathrm{D},0}, \\gamma) = (0.0200, 2.800, 200, 1.5)$ 和温度 $\\{0, 300, 600, 900\\}$。\n- 用例 3: $(\\varepsilon, \\sigma, \\Theta_{\\mathrm{D},0}, \\gamma) = (0.0080, 3.000, 400, 0.5)$ 和温度 $\\{0, 100, 500, 1000\\}$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个列表的列表，第 $j$ 个子列表包含第 $j$ 个测试用例的 $\\alpha(T)$ 值，其顺序与为该用例指定的温度顺序相同，并四舍五入到八位小数。例如，输出必须看起来像\n\"[ [a11,a12,...], [a21,a22,...], [a31,a32,...] ]\"\n除了显示的空格外，没有多余的空格，每个 $a_{ij}$ 都是一个单位为 $\\mathrm{K}^{-1}$ 的十进制浮点数。", "solution": "所述问题是计算固态物理学中一个良构的练习。它在科学上是合理的，依赖于标准和公认的模型：用于面心立方晶格中对相互作用的 Lennard-Jones 势，以及用于振动热力学的准谐振子德拜模型。该问题是自洽的，提供了所有必要的物理参数、常数和数学公式。它是客观的，其要求是可算法形式化的。因此，该问题被认为是有效的，并将构建一个完整的解决方案。\n\n方法如下。\n\n首先，我们确定静态平衡单位原子体积 $V_0$，它对应于温度 $T=0\\,\\mathrm{K}$ 时静态晶格的最低能量构型。这个体积是通过最小化静态晶格能 $U(V)$ 关于 $V$ 来找到的。$U(V)$ 的表达式给出如下：\n$$\nU(V) = 2\\varepsilon\\left[S_{12}\\left(\\frac{\\sigma}{r_{\\mathrm{nn}}(V)}\\right)^{12}-S_{6}\\left(\\frac{\\sigma}{r_{\\mathrm{nn}}(V)}\\right)^{6}\\right]\n$$\n对于面心立方晶格，最近邻距离 $r_{\\mathrm{nn}}(V)$ 通过 $r_{\\mathrm{nn}}(V)^6 = 2V^2$ 与单位原子体积 $V$ 相关。将此代入能量表达式得到：\n$$\nU(V) = 2\\varepsilon\\left[S_{12}\\frac{\\sigma^{12}}{4V^4} - S_{6}\\frac{\\sigma^{6}}{2V^2}\\right]\n$$\n最小能量的条件是 $\\frac{\\mathrm{d}U}{\\mathrm{d}V} = 0$。对 $V$ 求导并求解，可以得到 $V_0$ 的解析表达式：\n$$\n\\frac{\\mathrm{d}U}{\\mathrm{d}V} = 2\\varepsilon \\left[ -S_{12}\\frac{\\sigma^{12}}{V^5} + S_{6}\\frac{\\sigma^{6}}{V^3} \\right] = 0\n$$\n这意味着 $S_{6}\\sigma^{6}V^{-3} = S_{12}\\sigma^{12}V^{-5}$，从而得到：\n$$\nV_0^2 = \\frac{S_{12}}{S_6}\\sigma^6 \\implies V_0 = \\sigma^3 \\sqrt{\\frac{S_{12}}{S_6}}\n$$\n这个值 $V_0$ 作为德拜温度 Grüneisen 模型的参考体积。\n\n其次，我们将总的单位原子亥姆霍兹自由能 $F(T,V)$ 表示为静态能量 $U(V)$ 和振动自由能 $F_{\\mathrm{vib}}(T,V)$ 的和：\n$$\nF(T,V) = U(V) + F_{\\mathrm{vib}}(T,V)\n$$\n在德拜模型中，振动贡献由下式给出：\n$$\nF_{\\mathrm{vib}}(T,V)=9k_{\\mathrm{B}}T\\left(\\frac{T}{\\Theta_{\\mathrm{D}}(V)}\\right)^{3}\\int_{0}^{\\Theta_{\\mathrm{D}}(V)/T}y^{2}\\ln\\left(1-e^{-y}\\right)\\,\\mathrm{d}y+\\frac{9}{8}k_{\\mathrm{B}}\\Theta_{\\mathrm{D}}(V)\n$$\n此处，$k_{\\mathrm{B}}=8.617333262\\times 10^{-5}\\ \\mathrm{eV/K}$ 是玻尔兹曼常数，德拜温度 $\\Theta_{\\mathrm{D}}(V)$ 由 Grüneisen 关系式 $\\Theta_{\\mathrm{D}}(V)=\\Theta_{\\mathrm{D},0}\\left(V/V_{0}\\right)^{-\\gamma}$ 给出。该积分是与德拜函数相关的标准形式，必须进行数值计算。对于 $T=0\\,\\mathrm{K}$ 的情况，表达式简化为零点能贡献，$F_{\\mathrm{vib}}(0,V) = \\frac{9}{8}k_{\\mathrm{B}}\\Theta_{\\mathrm{D}}(V)$。\n\n第三，对于测试套件中每个指定的温度 $T_i$，通过对总亥姆霍兹自由能 $F(T_i,V)$ 关于 $V$ 进行数值最小化，来找到相应的平衡体积 $V^{\\star}(T_i)$。这种最小化代表了零外部压力的物理条件。我们采用有界标量优化算法（Brent 方法）在一个物理上合理的区间（例如 $[0.8V_0, 1.5V_0]$）内进行搜索，以稳健地找到最小值。\n\n第四，体积热膨胀系数 $\\alpha(T)$ 使用问题陈述中指定的有限差分近似进行计算：\n$$\n\\alpha(T) = \\frac{1}{V^{\\star}(T)}\\frac{\\mathrm{d}V^{\\star}(T)}{\\mathrm{d}T}\n$$\n在温度 $T_i$ 处的导数 $\\frac{\\mathrm{d}V^{\\star}}{\\mathrm{d}T}$，对于任何 $T_i-\\Delta T$ 为非负的 $T_i$，都使用对称中心差分 $\\frac{V^{\\star}(T_i+\\Delta T)-V^{\\star}(T_i-\\Delta T)}{2\\Delta T}$ 来近似。对于 $T_i=0\\,\\mathrm{K}$ 的特定情况，使用单边前向差分 $\\frac{V^{\\star}(T_i+\\Delta T)-V^{\\star}(T_i)}{\\Delta T}$。在这些计算中，选择温度增量 $\\Delta T = 1.0\\,\\mathrm{K}$。这个值相对于温度网格足够小，可以提供导数的精确近似，同时又足够大，可以避免显著的浮点抵消误差。\n\n该实现将此逻辑封装在一个程序中，该程序遍历每个测试用例。为了优化计算，计算出的 $V^{\\star}(T)$ 值被缓存起来，因为在相邻温度点计算导数时可能需要它们。最终计算出的 $\\alpha(T)$ 值按要求四舍五入到八位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the coefficient of thermal expansion for a solid modeled with\n    a Lennard-Jones potential and the quasiharmonic Debye model.\n    \"\"\"\n\n    # Physical and model constants\n    KB = 8.617333262e-5  # Boltzmann constant in eV/K\n    S6 = 14.45392          # Lattice sum for r^-6 term\n    S12 = 12.13188         # Lattice sum for r^-12 term\n\n    class ThermalExpansionCalculator:\n        \"\"\"\n        A class to encapsulate the calculations for a single set of material parameters.\n        \"\"\"\n        def __init__(self, epsilon, sigma, theta_d0, gamma):\n            self.epsilon = epsilon\n            self.sigma = sigma\n            self.theta_d0 = theta_d0\n            self.gamma = gamma\n\n            # Analytically calculate V0, the static equilibrium volume at T=0K\n            self.v0 = self.sigma**3 * np.sqrt(S12 / S6)\n            \n            # Memoization cache for storing computed equilibrium volumes V*(T)\n            self.v_star_cache = {}\n\n        def U(self, V):\n            \"\"\"Static lattice energy per atom U(V).\"\"\"\n            if V == 0:\n                return np.inf\n            # Expression derived from U(r_nn) and r_nn^6(V) = 2V^2\n            term_12 = S12 * (self.sigma**12) / (4 * V**4)\n            term_6 = S6 * (self.sigma**6) / (2 * V**2)\n            return 2 * self.epsilon * (term_12 - term_6)\n\n        def theta_d(self, V):\n            \"\"\"Debye temperature as a function of volume V.\"\"\"\n            return self.theta_d0 * (V / self.v0)**(-self.gamma)\n\n        @staticmethod\n        def _debye_integrand(y):\n            \"\"\"Integrand for the Debye model's thermal energy term.\"\"\"\n            if y == 0:\n                return 0.0\n            # Use approximation for large y to avoid overflow in exp(-y)\n            # and subsequent log(1), which is safe but can be slow.\n            if y > 700:\n                return -y**2 * np.exp(-y)\n            return y**2 * np.log(1 - np.exp(-y))\n\n        def F_vib(self, T, V):\n            \"\"\"Vibrational Helmholtz free energy per atom F_vib(T, V).\"\"\"\n            if V == 0:\n                return np.inf\n            \n            theta = self.theta_d(V)\n            # Zero-point energy (ZPE)\n            zpe = (9.0 / 8.0) * KB * theta\n\n            # For T=0, only ZPE contributes\n            if T  1e-9:\n                return zpe\n\n            integral_limit = theta / T\n            integral_val, _ = integrate.quad(self._debye_integrand, 0, integral_limit, epsabs=1e-12, epsrel=1e-12)\n            \n            thermal_term = 9 * KB * T * (T / theta)**3 * integral_val\n            \n            return thermal_term + zpe\n\n        def F_total(self, T, V):\n            \"\"\"Total Helmholtz free energy per atom F(T, V).\"\"\"\n            return self.U(V) + self.F_vib(T, V)\n\n        def get_V_star(self, T):\n            \"\"\"\n            Calculates and caches the equilibrium volume V*(T) by minimizing F(T, V).\n            \"\"\"\n            # Use a tuple for the key because floats can be tricky\n            temp_key = round(T, 6)\n            if temp_key in self.v_star_cache:\n                return self.v_star_cache[temp_key]\n\n            f_to_minimize = lambda v: self.F_total(T, v)\n\n            # Search for the minimum in a physically reasonable range around V0\n            bounds = (0.8 * self.v0, 1.5 * self.v0)\n            \n            result = optimize.minimize_scalar(f_to_minimize, bounds=bounds, method='bounded')\n            \n            v_eq = result.x\n            self.v_star_cache[temp_key] = v_eq\n            return v_eq\n\n        def calculate_alpha_for_grid(self, T_grid, delta_T=1.0):\n            \"\"\"\n            Calculates the thermal expansion coefficient alpha(T) for a grid of temperatures.\n            \"\"\"\n            alphas = []\n            for T in T_grid:\n                V_star_T = self.get_V_star(T)\n                \n                # Use a one-sided (forward) difference if T  delta_T (covers T=0)\n                if T  delta_T:\n                    V_star_plus_dT = self.get_V_star(T + delta_T)\n                    dV_dT = (V_star_plus_dT - V_star_T) / delta_T\n                else:  # Use a central difference for all other temperatures\n                    V_star_plus_dT = self.get_V_star(T + delta_T)\n                    V_star_minus_dT = self.get_V_star(T - delta_T)\n                    dV_dT = (V_star_plus_dT - V_star_minus_dT) / (2.0 * delta_T)\n                    \n                alpha = (1.0 / V_star_T) * dV_dT\n                alphas.append(alpha)\n            \n            return alphas\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\"params\": (0.0104, 3.405, 92, 2.0), \"T_grid\": [0.0, 50.0, 100.0, 200.0]},\n        {\"params\": (0.0200, 2.800, 200, 1.5), \"T_grid\": [0.0, 300.0, 600.0, 900.0]},\n        {\"params\": (0.0080, 3.000, 400, 0.5), \"T_grid\": [0.0, 100.0, 500.0, 1000.0]},\n    ]\n    \n    all_results = []\n    \n    for case in test_cases:\n        epsilon, sigma, theta_d0, gamma = case[\"params\"]\n        T_grid = case[\"T_grid\"]\n        \n        calculator = ThermalExpansionCalculator(epsilon, sigma, theta_d0, gamma)\n        alphas = calculator.calculate_alpha_for_grid(T_grid)\n        \n        all_results.append(alphas)\n\n    # Format the final output string exactly as specified.\n    sublist_strings = []\n    for sublist in all_results:\n        # Round each value to 8 decimal places and format to string\n        formatted_sublist = \"[\" + \",\".join([f\"{x:.8f}\" for x in sublist]) + \"]\"\n        sublist_strings.append(formatted_sublist)\n        \n    final_output = \"[\" + \", \".join(sublist_strings) + \"]\"\n    print(final_output)\n\nsolve()\n```", "id": "2924969"}]}