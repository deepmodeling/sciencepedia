{"hands_on_practices": [{"introduction": "简单剪切是材料力学中一种基本的变形模式，但其在有限变形理论下的运动学描述远比小应变理论丰富。这个练习将带领我们从第一性原理出发，对一个简单剪切变形梯度进行右极分解 [@problem_id:2886430]。通过直接计算右柯西-格林张量 $ \\mathbf{C} $ 及其唯一的对称正定平方根 $ \\mathbf{U} $，我们将揭示一个关键的几何洞察：一个看似“纯粹”的剪切实际上内蕴了刚体旋转，这是有限应变理论的核心特征之一。", "problem": "三维空间中的均匀单剪切形变由形变梯度 $\\,\\mathbf{F}=\\mathbf{I}+\\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}\\,$ 描述，其中 $\\,\\gamma\\in\\mathbb{R}\\,$ 是一个常数剪切参数，$\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 是一组标准正交基。请仅使用有限形变运动学的基本定义，对 $\\,\\mathbf{F}\\,$ 进行右极分解，即确定一个正常正交张量 $\\,\\mathbf{R}\\in\\mathrm{SO}(3)\\,$ 和一个对称正定的右伸长张量 $\\,\\mathbf{U}\\,$，使得 $\\,\\mathbf{F}=\\mathbf{R}\\mathbf{U}\\,$。你的推导必须从定义 $\\,\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}\\,$ 和 $\\,\\mathbf{U}=\\mathbf{C}^{1/2}\\,$（$\\,\\mathbf{C}\\,$ 的唯一对称正定平方根）开始，然后计算 $\\,\\mathbf{R}=\\mathbf{F}\\mathbf{U}^{-1}\\,$，并建立 $\\,\\mathbf{R}\\,$ 和 $\\,\\mathbf{U}\\,$ 关于 $\\,\\gamma\\,$ 的闭式表达式。验证 $\\,\\mathbf{U}^{2}=\\mathbf{C}\\,$ 和 $\\,\\mathbf{R}^{\\mathsf{T}}\\mathbf{R}=\\mathbf{I}\\,$。\n\n最后，将 $\\,\\mathbf{R}\\,$ 参数化为绕 $\\,\\mathbf{e}_{3}\\,$ 轴的平面旋转，其带符号角为 $\\,\\theta(\\gamma)\\,$，即 $\\,\\mathbf{R}=\\mathbf{Q}(\\theta)\\,$，其中 $\\,\\mathbf{Q}(\\theta)\\,$ 在 $\\,\\mathbf{e}_{1}\\text{--}\\mathbf{e}_{2}\\,$ 平面内限制为一个标准旋转矩阵且 $\\,\\mathbf{Q}_{33}=1\\,$。然后，提取角度 $\\,\\theta(\\gamma)\\,$ 的显式闭式表达式。\n\n作为你最终提交的答案，仅需报告函数 $\\,\\theta(\\gamma)\\,$，它应为一个以弧度为单位的单一闭式解析表达式（不需要数值舍入）。", "solution": "给定的形变梯度为 $\\mathbf{F}=\\mathbf{I}+\\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}$，其中 $\\gamma$ 是剪切参数，$\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 是一个标准正交基。在此基下，$\\mathbf{F}$ 的矩阵表示为：\n$$\n[F] = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n右极分解为 $\\mathbf{F}=\\mathbf{R}\\mathbf{U}$，其中 $\\mathbf{R}$ 是一个正常正交张量，$\\mathbf{U}$ 是一个对称正定的右伸长张量。推导从计算右柯西-格林形变张量 $\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 开始。\n$$\n[F^{\\mathsf{T}}] = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n[C] = [F^{\\mathsf{T}}][F] = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n接下来，我们求右伸长张量 $\\mathbf{U}=\\mathbf{C}^{1/2}$。由于 $\\mathbf{C}$ 是对称且正定的，$\\mathbf{U}$ 是唯一的。我们寻找一个对称矩阵 $[U]$ 使得 $[U]^2=[C]$。根据 $[C]$ 的结构，我们假设 $[U]$ 具有以下形式：\n$$\n[U] = \\begin{pmatrix} a  b  0 \\\\ b  c  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n其中分量 $U_{33}=1$ 是因为 $C_{33}=1$。将该矩阵平方得到：\n$$\n[U]^2 = \\begin{pmatrix} a^2+b^2  b(a+c)  0 \\\\ b(a+c)  b^2+c^2  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n这为 $a, b, c$ 提供了一个代数方程组：\n1. $a^2+b^2=1$\n2. $b(a+c)=\\gamma$\n3. $b^2+c^2=\\gamma^2+1$\n\n为使 $\\mathbf{U}$ 是正定的，其所有主子式必须为正。这要求 $a0$ 且 $ac-b^20$。从(2)可知，如果 $\\gamma \\ne 0$，那么 $b \\ne 0$。我们可以假设 $b$ 与 $\\gamma$ 的符号相同。\n从(1)和(3)，我们得到 $c^2-a^2 = \\gamma^2$。从(2)，有 $a+c = \\gamma/b$。结合这两个式子可得 $c-a = \\gamma b$。解出 $a$ 和 $c$ 可得 $a=\\frac{1}{2}(\\frac{\\gamma}{b}-\\gamma b)$ 和 $c=\\frac{1}{2}(\\frac{\\gamma}{b}+\\gamma b)$。\n将 $a$ 代入(1)式，得到一个关于 $b^2$ 的二次方程：$(\\gamma^2+4)b^4 - 2(\\gamma^2+2)b^2 + \\gamma^2 = 0$。\n$b^2$ 的解为 $b^2 = \\frac{\\gamma^2}{\\gamma^2+4}$ 和 $b^2=1$。解 $b^2=1$ 得到的 $\\mathbf{U}$ 矩阵不是正定的，因此舍弃。\n我们取 $b^2=\\frac{\\gamma^2}{\\gamma^2+4}$。我们选择 $b=\\frac{\\gamma}{\\sqrt{\\gamma^2+4}}$ 使得 $b$ 与 $\\gamma$ 符号相同。这得到：\n$a = \\frac{2}{\\sqrt{\\gamma^2+4}}$\n$c = \\frac{\\gamma^2+2}{\\sqrt{\\gamma^2+4}}$\n这些值满足所有三个方程和正定性条件。因此，$\\mathbf{U}$ 的矩阵为：\n$$\n[U] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} 2  \\gamma  0 \\\\ \\gamma  \\gamma^2+2  0 \\\\ 0  0  \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n为了求旋转张量 $\\mathbf{R}$，我们计算 $\\mathbf{R}=\\mathbf{F}\\mathbf{U}^{-1}$。首先，我们求 $\\mathbf{U}^{-1}$。$[U]$ 的左上角 $2\\times2$ 子块的行列式为 $1$。其逆矩阵通过标准公式求得：\n$$\n[U^{-1}] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} \\gamma^2+2  -\\gamma  0 \\\\ -\\gamma  2  0 \\\\ 0  0  \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n现在我们计算 $[R]=[F][U^{-1}]$：\n$$\n[R] = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} \\gamma^2+2  -\\gamma  0 \\\\ -\\gamma  2  0 \\\\ 0  0  \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} (1)(\\gamma^2+2)+(\\gamma)(-\\gamma)  (1)(-\\gamma)+(\\gamma)(2)  0 \\\\ (0)(\\gamma^2+2)+(1)(-\\gamma)  (0)(-\\gamma)+(1)(2)  0 \\\\ 0  0  \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} 2  \\gamma  0 \\\\ -\\gamma  2  0 \\\\ 0  0  \\sqrt{\\gamma^2+4} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{\\sqrt{\\gamma^2+4}}  \\frac{\\gamma}{\\sqrt{\\gamma^2+4}}  0 \\\\ \\frac{-\\gamma}{\\sqrt{\\gamma^2+4}}  \\frac{2}{\\sqrt{\\gamma^2+4}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n我们验证 $\\mathbf{R}$ 是一个正常正交张量。\n$$\n[R^{\\mathsf{T}}R] = \\begin{pmatrix} \\frac{2}{k}  \\frac{-\\gamma}{k}  0 \\\\ \\frac{\\gamma}{k}  \\frac{2}{k}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{k}  \\frac{\\gamma}{k}  0 \\\\ \\frac{-\\gamma}{k}  \\frac{2}{k}  0 \\\\ 0  0  1 \\end{pmatrix} = \\frac{1}{k^2}\\begin{pmatrix} 4+\\gamma^2  2\\gamma-2\\gamma  0 \\\\ 2\\gamma-2\\gamma  \\gamma^2+4  0 \\\\ 0  0  k^2 \\end{pmatrix}\n$$\n其中 $k=\\sqrt{\\gamma^2+4}$。由于 $k^2=\\gamma^2+4$，此式化简为单位矩阵 $\\mathbf{I}$。\n其行列式为 $\\det[R] = (\\frac{2}{k})^2 - (\\frac{\\gamma}{k})(\\frac{-\\gamma}{k}) = \\frac{4+\\gamma^2}{k^2}=1$。因此 $\\mathbf{R} \\in \\mathrm{SO}(3)$。\n\n最后，我们将 $\\mathbf{R}$ 参数化为在 $\\mathbf{e}_1$-$\\mathbf{e}_2$ 平面内的一个平面旋转。一个向量绕原点逆时针旋转一个带符号角 $\\theta$ 的标准旋转矩阵是：\n$$\n[Q(\\theta)] = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n将 $[R]$ 与 $[Q(\\theta)]$ 比较，我们辨识出各分量：\n$$\n\\cos\\theta = \\frac{2}{\\sqrt{\\gamma^2+4}}\n$$\n$$\n-\\sin\\theta = \\frac{\\gamma}{\\sqrt{\\gamma^2+4}} \\quad \\implies \\quad \\sin\\theta = -\\frac{\\gamma}{\\sqrt{\\gamma^2+4}}\n$$\n角度 $\\theta$ 的正切是这些分量的比值：\n$$\n\\tan\\theta = \\frac{\\sin\\theta}{\\cos\\theta} = \\frac{-\\gamma/\\sqrt{\\gamma^2+4}}{2/\\sqrt{\\gamma^2+4}} = -\\frac{\\gamma}{2}\n$$\n因此角度 $\\theta(\\gamma)$ 由反正切函数给出。标准 $\\arctan$ 函数的值域 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ 在这里是合适的，因为对于所有 $\\gamma$，$\\cos\\theta  0$。\n$$\n\\theta(\\gamma) = \\arctan\\left(-\\frac{\\gamma}{2}\\right)\n$$\n该表达式提供了所需的带符号旋转角，作为剪切参数 $\\gamma$ 的函数。", "answer": "$$\\boxed{\\arctan\\left(-\\frac{\\gamma}{2}\\right)}$$", "id": "2886430"}, {"introduction": "极分解将一个变形唯一地分解为一个旋转和一个后续的纯拉伸（或一个先行的纯拉伸和一个旋转）。然而，有限旋转和有限拉伸这两种操作通常是不可交换的。本练习通过分析一个先进行主方向拉伸、后进行刚体旋转的变形过程 [@problem_id:2886415]，深入探讨了这一概念。通过推导其右极分解并量化旋转与拉伸的交换子，我们能够清晰地理解变形历史的顺序如何影响最终的运动学分解，从而加深对有限变形几何非线性的认识。", "problem": "考虑一个均匀变形映射，其定义为一个有限拉伸后跟一个有限刚体转动。变形梯度由乘积 $\\mathbf{F} = \\mathbf{Q}\\,\\mathbf{D}$ 给出，其中：\n- $\\mathbf{Q} \\in \\mathbb{R}^{3 \\times 3}$ 是一个正常正交张量，满足 $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q} = \\mathbf{I}$ 和 $\\det \\mathbf{Q} = 1$，表示绕固定单位向量 $\\mathbf{e}_3$ 的一个右手旋转，旋转角为 $\\theta$（单位为弧度），\n- $\\mathbf{D} = \\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)$ 是一个对称正定 (SPD) 拉伸张量，其主拉伸为 $\\lambda_i  0$。\n\n你可以假设使用标准正交基 $\\{\\mathbf{e}_1,\\mathbf{e}_2,\\mathbf{e}_3\\}$ 和如下显式旋转\n$$\n\\mathbf{Q} = \\begin{pmatrix}\n\\cos \\theta  -\\sin \\theta  0 \\\\\n\\sin \\theta  \\phantom{-}\\cos \\theta  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n\n任务：\n1. 从右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 和右拉伸张量 $\\mathbf{U}$（$\\mathbf{C}$ 的唯一对称正定平方根）的定义出发，在右极分解中提取右拉伸 $\\mathbf{U}$ 和旋转 $\\mathbf{R}$，其中 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 且 $\\mathbf{R}$ 是正常正交的。\n2. 仅使用第一性原理和上述定义，分析旋转和拉伸通常是否可交换。为了量化此 $\\mathbf{Q}$ 和 $\\mathbf{D}$ 的非交换程度，定义一个标量度量\n$$\n\\Gamma \\equiv \\|\\,[\\mathbf{Q},\\mathbf{U}]\\,\\|_F^{2} = \\|\\mathbf{Q}\\mathbf{U} - \\mathbf{U}\\mathbf{Q}\\|_F^{2},\n$$\n其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数。将 $\\Gamma$ 显式地推导为关于 $\\lambda_1,\\lambda_2,\\lambda_3$ 和 $\\theta$ 的闭式函数。\n\n你最终提交的答案必须是 $\\Gamma$ 的单一闭式解析表达式。不要包含单位。不需要进行数值计算。", "solution": "**任务 1：确定右极分解**\n\n变形梯度 $\\mathbf{F}$ 的右极分解由 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 给出，其中 $\\mathbf{R}$ 是一个正常正交张量，$\\mathbf{U}$ 是一个对称正定 (SPD) 张量，即右拉伸张量。\n\n右拉伸张量 $\\mathbf{U}$ 由右柯西-格林张量 $\\mathbf{C}$ 通过关系式 $\\mathbf{U} = \\sqrt{\\mathbf{C}}$ 确定。张量 $\\mathbf{C}$ 定义为 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$。\n\n已知 $\\mathbf{F} = \\mathbf{Q}\\mathbf{D}$。我们通过代入此表达式来计算 $\\mathbf{C}$：\n$$\n\\mathbf{C} = (\\mathbf{Q}\\mathbf{D})^{\\mathsf{T}}(\\mathbf{Q}\\mathbf{D})\n$$\n利用矩阵乘积转置的性质 $(\\mathbf{A}\\mathbf{B})^{\\mathsf{T}} = \\mathbf{B}^{\\mathsf{T}}\\mathbf{A}^{\\mathsf{T}}$，我们有：\n$$\n\\mathbf{C} = (\\mathbf{D}^{\\mathsf{T}}\\mathbf{Q}^{\\mathsf{T}})(\\mathbf{Q}\\mathbf{D})\n$$\n根据矩阵乘法的结合律：\n$$\n\\mathbf{C} = \\mathbf{D}^{\\mathsf{T}}(\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q})\\mathbf{D}\n$$\n问题陈述 $\\mathbf{Q}$ 是一个正交张量，因此 $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q} = \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。$\\mathbf{C}$ 的表达式简化为：\n$$\n\\mathbf{C} = \\mathbf{D}^{\\mathsf{T}}\\mathbf{I}\\mathbf{D} = \\mathbf{D}^{\\mathsf{T}}\\mathbf{D}\n$$\n此外，已知 $\\mathbf{D}$ 是一个对称张量，所以 $\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$。这导致：\n$$\n\\mathbf{C} = \\mathbf{D}\\mathbf{D} = \\mathbf{D}^2\n$$\n右拉伸张量 $\\mathbf{U}$ 是 $\\mathbf{C}$ 的唯一对称正定平方根。因此：\n$$\n\\mathbf{U} = \\sqrt{\\mathbf{C}} = \\sqrt{\\mathbf{D}^2}\n$$\n由于已知 $\\mathbf{D}$ 是一个对称正定张量，其主拉伸 $\\lambda_i  0$ 均为正数，所以它的唯一对称正定平方根就是 $\\mathbf{D}$ 本身。因此：\n$$\n\\mathbf{U} = \\mathbf{D} = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}\n$$\n现在，我们从极分解公式 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 中求出旋转张量 $\\mathbf{R}$。\n$$\n\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}\n$$\n代入已知的 $\\mathbf{F} = \\mathbf{Q}\\mathbf{D}$ 和推导出的 $\\mathbf{U} = \\mathbf{D}$：\n$$\n\\mathbf{R} = (\\mathbf{Q}\\mathbf{D})\\mathbf{D}^{-1}\n$$\n由于 $\\lambda_i  0$，$\\mathbf{D}$ 是可逆的。根据结合律：\n$$\n\\mathbf{R} = \\mathbf{Q}(\\mathbf{D}\\mathbf{D}^{-1}) = \\mathbf{Q}\\mathbf{I} = \\mathbf{Q}\n$$\n因此，对于指定的变形，其右极分解由 $\\mathbf{R} = \\mathbf{Q}$ 和 $\\mathbf{U} = \\mathbf{D}$ 给出。\n\n**任务 2：推导非交换性度量 $\\Gamma$**\n\n我们必须推导 $\\Gamma \\equiv \\|\\mathbf{Q}\\mathbf{U} - \\mathbf{U}\\mathbf{Q}\\|_F^{2}$ 的表达式。根据任务 1 的结果，我们有 $\\mathbf{U} = \\mathbf{D}$。因此，我们必须计算 $\\mathbf{Q}$ 和 $\\mathbf{D}$ 的对易子，记为 $[\\mathbf{Q}, \\mathbf{D}] = \\mathbf{Q}\\mathbf{D} - \\mathbf{D}\\mathbf{Q}$。\n\n让我们记 $c \\equiv \\cos\\theta$ 和 $s \\equiv \\sin\\theta$。矩阵为：\n$$\n\\mathbf{Q} = \\begin{pmatrix} c  -s  0 \\\\ s  c  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad \\mathbf{D} = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}\n$$\n首先，我们计算乘积 $\\mathbf{Q}\\mathbf{D}$：\n$$\n\\mathbf{Q}\\mathbf{D} = \\begin{pmatrix} c  -s  0 \\\\ s  c  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} c\\lambda_1  -s\\lambda_2  0 \\\\ s\\lambda_1  c\\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}\n$$\n接下来，我们计算乘积 $\\mathbf{D}\\mathbf{Q}$：\n$$\n\\mathbf{D}\\mathbf{Q} = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} \\begin{pmatrix} c  -s  0 \\\\ s  c  0 \\\\ 0  0  1 \\endpmatrix} = \\begin{pmatrix} c\\lambda_1  -s\\lambda_1  0 \\\\ s\\lambda_2  c\\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}\n$$\n对易子矩阵是这两个乘积之差：\n$$\n[\\mathbf{Q},\\mathbf{D}] = \\mathbf{Q}\\mathbf{D} - \\mathbf{D}\\mathbf{Q} = \\begin{pmatrix} c\\lambda_1 - c\\lambda_1  -s\\lambda_2 - (-s\\lambda_1)  0 - 0 \\\\ s\\lambda_1 - s\\lambda_2  c\\lambda_2 - c\\lambda_2  0 - 0 \\\\ 0 - 0  0 - 0  \\lambda_3 - \\lambda_3 \\end{pmatrix}\n$$\n$$\n[\\mathbf{Q},\\mathbf{D}] = \\begin{pmatrix} 0  -s(\\lambda_2 - \\lambda_1)  0 \\\\ s(\\lambda_1 - \\lambda_2)  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  s(\\lambda_1 - \\lambda_2)  0 \\\\ -s(\\lambda_1 - \\lambda_2)  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n量 $\\Gamma$ 是此对易子矩阵的弗罗贝尼乌斯范数的平方。矩阵 $\\mathbf{A}$ 的弗罗贝尼乌斯范数的平方 $\\|\\mathbf{A}\\|_F^2$ 是其所有元素平方之和。\n$$\n\\Gamma = \\|\\,[\\mathbf{Q},\\mathbf{D}]\\,\\|_F^{2} = (0)^{2} + (s(\\lambda_1 - \\lambda_2))^{2} + (0)^{2} + (-s(\\lambda_1 - \\lambda_2))^{2} + (0)^{2} + (0)^{2} + (0)^{2} + (0)^{2} + (0)^{2}\n$$\n$$\n\\Gamma = s^2(\\lambda_1 - \\lambda_2)^2 + s^2(\\lambda_1 - \\lambda_2)^2 = 2s^2(\\lambda_1 - \\lambda_2)^2\n$$\n将 $s = \\sin\\theta$ 代回表达式，得到 $\\Gamma$ 的最终闭式结果：\n$$\n\\Gamma = 2(\\sin\\theta)^{2}(\\lambda_1 - \\lambda_2)^{2}\n$$\n当且仅当 $\\Gamma = 0$ 时，$\\mathbf{Q}$ 和 $\\mathbf{U}=\\mathbf{D}$ 才可交换。这种情况发生在 $\\sin\\theta = 0$（即旋转角 $\\theta$ 是 $\\pi$ 的倍数，对应于平面内无旋转或平凡旋转）或 $\\lambda_1 = \\lambda_2$（即拉伸在旋转平面内是各向同性的）时。这证实了物理直觉。", "answer": "$$\n\\boxed{2(\\sin(\\theta))^{2}(\\lambda_1 - \\lambda_2)^{2}}\n$$", "id": "2886415"}, {"introduction": "虽然直接的代数方法对于理解极分解的定义至关重要，但在实际的数值计算中，我们需要更通用和稳健的算法。本练习介绍了基于奇异值分解 (Singular Value Decomposition, SVD) 的方法，它是计算力学中实现极分解的标准工具 [@problem_id:2886399]。更重要的是，本练习将揭示极分解背后深刻的变分原理：极分解所得到的旋转张量 $ \\mathbf{R} $ 是在所有旋转中与原变形梯度 $ \\mathbf{F} $ “最接近”的一个。理解这一最优性原理对于在弹塑性本构模型和几何非线性有限元法中正确应用运动学分解至关重要。", "problem": "给定一个表示材料力学中有限变形梯度的方阵。设变形梯度为一个实矩阵 $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$，且满足 $\\det(\\mathbf{F})  0$。右极分解旨在寻找一个正常正交张量 $\\mathbf{R} \\in \\mathrm{SO}(n)$ 和一个对称正定拉伸矩阵 $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$，使得 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$。本问题中所有角度均须以弧度解释。\n\n你的任务如下：\n\n1) 仅从奇异值分解、正交矩阵、Frobenius 范数和对称正定矩阵的基本定义出发，推导出一个使用奇异值分解计算 $\\mathbf{F}$ 的右极分解的算法。该算法必须对任何满足 $\\det(\\mathbf{F})  0$ 的 $\\mathbf{F}$ 都有效，并且必须返回一个正常正交张量 $\\mathbf{R} \\in \\mathrm{SO}(n)$ 和一个对称正定矩阵 $\\mathbf{U}$。\n\n2) 证明你的算法所产生的旋转矩阵 $\\mathbf{R}$ 是以下问题的唯一最小化子\n$$\n\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F,\n$$\n其中 $\\|\\cdot\\|_F$ 表示 Frobenius 范数，并证明相关的 $\\mathbf{U} = \\mathbf{R}^\\top \\mathbf{F}$ 是对称正定的。你的证明必须基于基本原理，从 Frobenius 范数的酉不变性和标准谱不等式出发，不得预先假设目标结果。\n\n3) 实现一个程序，该程序：\n- 计算每个给定测试矩阵 $\\mathbf{F}$ 的奇异值分解。\n- 使用你推导的算法为每种情况计算 $\\mathbf{R}$ 和 $\\mathbf{U}$。\n- 对每个测试用例，计算一个实值诊断量，用以定量验证你的推导和证明所蕴含的核心属性之一。\n\n使用以下变形梯度测试套件：\n- 情况 1 (二维对角拉伸)：$\\mathbf{F}_1 = \\begin{bmatrix} 2.0  0.0 \\\\ 0.0  0.5 \\end{bmatrix}$。输出 $\\|\\mathbf{F}_1 - \\mathbf{R}_1\\|_F$ 与 $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$ 之间的绝对差值，其中 $\\sigma_i$ 是 $\\mathbf{F}_1$ 的奇异值。\n- 情况 2 (二维旋转拉伸)：令 $\\theta = 0.4$ (弧度)，$\\mathbf{R}_{\\mathrm{true}} = \\begin{bmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{bmatrix}$，以及 $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(1.2, 0.8)$。定义 $\\mathbf{F}_2 = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$。\n- 情况 3 (具有非平凡特征基的三维一般对称拉伸)：令 $\\phi = 0.6$ (弧度)，$\\mathbf{Q} = \\begin{bmatrix} \\cos\\phi  -\\sin\\phi  0 \\\\ \\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{bmatrix}$，$\\mathbf{D} = \\operatorname{diag}(1.5, 0.9, 1.1)$，以及 $\\mathbf{U}_{\\mathrm{true}} = \\mathbf{Q}\\mathbf{D}\\mathbf{Q}^\\top$。令 $\\alpha = -0.7$ (弧度) 且 $\\mathbf{R}_{\\mathrm{true}}^{(x)} = \\begin{bmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{bmatrix}$。定义 $\\mathbf{F}_3 = \\mathbf{R}_{\\mathrm{true}}^{(x)} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$。\n- 情况 4 (二维病态拉伸)：令 $\\beta = 1.1$ (弧度)，$\\mathbf{R}_{\\beta} = \\begin{bmatrix} \\cos\\beta  -\\sin\\beta \\\\ \\sin\\beta  \\cos\\beta \\end{bmatrix}$，以及 $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(10^{-6}, 3.0)$。定义 $\\mathbf{F}_4 = \\mathbf{R}_{\\beta} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{F}_4 - \\mathbf{R}_4\\|_F$ 与 $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$ 之间的绝对差值。\n\n所有计算都必须假定角度以弧度为单位。你的程序必须将四个诊断量聚合到单行输出中，结果以逗号分隔的列表形式包含在方括号内，并按情况 1 到 4 的顺序排列。每个诊断量必须是一个实数（浮点数）。可以接受将输出四舍五入到固定的小数位数，但所有四个输出必须保持一致。\n\n注：\n- 上述表达式中的奇异值指的是每种情况下相应 $\\mathbf{F}$ 的奇异值。\n- 确保所有使用的 $\\mathbf{F}_k$ 都具有严格为正的行列式，从而保证极分解中存在真旋转。", "solution": "### 1. 右极分解的算法推导\n\n目标是找到一个正常正交张量 $\\mathbf{R} \\in \\mathrm{SO}(n)$（即 $\\mathbf{R}^\\top\\mathbf{R}=\\mathbf{I}$ 且 $\\det(\\mathbf{R})=+1$）和一个对称正定拉伸张量 $\\mathbf{U}$，使得对于给定的变形梯度 $\\mathbf{F}$（满足 $\\det(\\mathbf{F})  0$），右极分解成立：\n$$ \\mathbf{F} = \\mathbf{R}\\mathbf{U} $$\n我们从 $\\mathbf{F}$ 的奇异值分解 (SVD) 出发，它对任何实矩阵 $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$ 定义为：\n$$ \\mathbf{F} = \\mathbf{V} \\mathbf{\\Sigma} \\mathbf{W}^\\top $$\n这里，$\\mathbf{V}$ 和 $\\mathbf{W}$ 是正交矩阵（$\\mathbf{V}^\\top\\mathbf{V} = \\mathbf{I}$，$\\mathbf{W}^\\top\\mathbf{W} = \\mathbf{I}$），$\\mathbf{\\Sigma}$ 是包含 $\\mathbf{F}$ 的奇异值 $\\sigma_i \\ge 0$ 的对角矩阵。由于问题规定 $\\det(\\mathbf{F})  0$，$\\mathbf{F}$ 是可逆的，这意味着所有奇异值都严格为正，即 $\\sigma_i  0$。\n\n在右极分解 $\\mathbf{F}=\\mathbf{R}\\mathbf{U}$ 中，右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^\\top\\mathbf{F}$ 与右拉伸张量 $\\mathbf{U}$ 的关系为 $\\mathbf{C} = \\mathbf{U}^2$。\n利用 SVD，我们可以写出 $\\mathbf{C}$：\n$$ \\mathbf{C} = (\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top (\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top)(\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\mathbf{W}\\mathbf{\\Sigma}^2\\mathbf{W}^\\top $$\n由于 $\\mathbf{U}$ 是 $\\mathbf{C}$ 的唯一对称正定平方根，我们可以推断出：\n$$ \\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top $$\n这个 $\\mathbf{U}$ 是对称的（因为 $\\mathbf{\\Sigma}$ 是对称的），并且是正定的（因为它的特征值是 $\\sigma_i  0$）。\n\n然后，我们可以从 $\\mathbf{F}=\\mathbf{R}\\mathbf{U}$ 求出 $\\mathbf{R}$：\n$$ \\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1} = (\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^{-1} = (\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) (\\mathbf{W}\\mathbf{\\Sigma}^{-1}\\mathbf{W}^\\top) = \\mathbf{V}\\mathbf{W}^\\top $$\n我们必须验证 $\\mathbf{R}$ 是一个正常正交张量。它的正交性是显然的：$\\mathbf{R}^\\top\\mathbf{R} = (\\mathbf{V}\\mathbf{W}^\\top)^\\top(\\mathbf{V}\\mathbf{W}^\\top) = \\mathbf{W}\\mathbf{V}^\\top\\mathbf{V}\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{I}$。\n关于其行列式，我们有 $\\det(\\mathbf{F}) = \\det(\\mathbf{V})\\det(\\mathbf{\\Sigma})\\det(\\mathbf{W}^\\top)$。由于 $\\det(\\mathbf{F})  0$ 且 $\\det(\\mathbf{\\Sigma}) = \\prod \\sigma_i  0$，我们必然有 $\\det(\\mathbf{V})\\det(\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W})  0$。因为正交矩阵的行列式为 $\\pm 1$，所以 $\\det(\\mathbf{V})\\det(\\mathbf{W})=+1$。\n因此，$\\det(\\mathbf{R}) = \\det(\\mathbf{V}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1$，这确认了 $\\mathbf{R} \\in \\mathrm{SO}(n)$。\n\n算法如下：\n1. 对于给定的矩阵 $\\mathbf{F}$（满足 $\\det(\\mathbf{F})  0$），计算其 SVD：$\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$。\n2. 旋转矩阵是 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$。\n3. 拉伸张量是 $\\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top$。或者，也可以通过 $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$ 计算。\n\n### 2. 最小性和唯一性的证明\n\n我们必须证明 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ 是问题 $\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F$ 的唯一最小化子。\n\nFrobenius 范数的平方是 $\\|\\mathbf{A}\\|_F^2 = \\operatorname{Tr}(\\mathbf{A}^\\top\\mathbf{A})$。我们展开目标函数：\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}((\\mathbf{F} - \\mathbf{Q})^\\top(\\mathbf{F} - \\mathbf{Q})) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F} - \\mathbf{F}^\\top\\mathbf{Q} - \\mathbf{Q}^\\top\\mathbf{F} + \\mathbf{Q}^\\top\\mathbf{Q}) $$\n由于 $\\mathbf{Q} \\in \\mathrm{SO}(n)$，$\\mathbf{Q}$ 是正交的，所以 $\\mathbf{Q}^\\top\\mathbf{Q} = \\mathbf{I}$ 且 $\\operatorname{Tr}(\\mathbf{I}) = n$。同时，$\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) = \\operatorname{Tr}((\\mathbf{F}^\\top\\mathbf{Q})^\\top) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$。\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) + n - 2\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) = \\|\\mathbf{F}\\|_F^2 + n - 2\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) $$\n最小化此表达式等价于最大化项 $\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F})$。\n\n将 $\\mathbf{F}$ 的 SVD $\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$ 代入迹中：\n$$ \\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) = \\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) $$\n利用迹的循环性质 $\\operatorname{Tr}(\\mathbf{ABC}) = \\operatorname{Tr}(\\mathbf{CAB})$：\n$$ \\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\operatorname{Tr}(\\mathbf{W}^\\top\\mathbf{Q}^\\top\\mathbf{V}\\mathbf{\\Sigma}) $$\n令 $\\mathbf{Z} = \\mathbf{W}^\\top\\mathbf{Q}^\\top\\mathbf{V}$。由于 $\\mathbf{W}$、$\\mathbf{Q}$ 和 $\\mathbf{V}$ 都是正交的，它们的乘积 $\\mathbf{Z}$ 也是正交的。我们希望在所有可以由 $\\mathbf{Q} \\in \\mathrm{SO}(n)$ 构成的正交矩阵 $\\mathbf{Z}$ 上最大化 $\\operatorname{Tr}(\\mathbf{Z}\\mathbf{\\Sigma})$。\n$$ \\det(\\mathbf{Z}) = \\det(\\mathbf{W}^\\top)\\det(\\mathbf{Q}^\\top)\\det(\\mathbf{V}) = \\det(\\mathbf{W})\\det(\\mathbf{Q})\\det(\\mathbf{V}) = (+1) \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\n最后一步是因为对于行列式为 $\\pm 1$ 的正交矩阵，$\\det(\\mathbf{A}^\\top)=\\det(\\mathbf{A})$。并且我们从第1节知道 $\\det(\\mathbf{V})\\det(\\mathbf{W}) = +1$。\n因此，我们必须在所有 $\\mathbf{Z} \\in \\mathrm{SO}(n)$ 上最大化 $\\operatorname{Tr}(\\mathbf{Z}\\mathbf{\\Sigma})$。\n\n迹为 $\\operatorname{Tr}(\\mathbf{Z}\\mathbf{\\Sigma}) = \\sum_{i=1}^n \\sigma_i Z_{ii}$。根据 von Neumann 迹不等式的一个特例，对于对角矩阵 $\\mathbf{\\Sigma}$ 和正交矩阵 $\\mathbf{Z}$，$\\operatorname{Tr}(\\mathbf{Z}\\mathbf{\\Sigma}) \\le \\sum_i \\sigma_i$。当且仅当 $\\mathbf{Z}$ 为单位矩阵 $\\mathbf{I}$ 时，等号成立。\n要达到最大值，我们需要 $\\mathbf{Z} = \\mathbf{I}$，因为这使得 $\\operatorname{Tr}(\\mathbf{I}\\mathbf{\\Sigma}) = \\sum \\sigma_i$。单位矩阵 $\\mathbf{I}$ 属于 $\\mathrm{SO}(n)$，所以这是一个有效的选择。\n\n设置 $\\mathbf{Z} = \\mathbf{I}$ 给出最优的 $\\mathbf{Q}$：\n$$ \\mathbf{W}^\\top\\mathbf{Q}^\\top\\mathbf{V} = \\mathbf{I} \\implies \\mathbf{Q}^\\top = \\mathbf{W}\\mathbf{I}\\mathbf{V}^\\top = \\mathbf{W}\\mathbf{V}^\\top \\implies \\mathbf{Q} = (\\mathbf{W}\\mathbf{V}^\\top)^\\top = \\mathbf{V}\\mathbf{W}^\\top $$\n这正是上一节中推导出的矩阵 $\\mathbf{R}$。这证明了 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ 是 $\\|\\mathbf{F} - \\mathbf{Q}\\|_F$ 在 $\\mathbf{Q} \\in \\mathrm{SO}(n)$ 上的唯一最小化子。\n相关的拉伸张量 $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F} = (\\mathbf{V}\\mathbf{W}^\\top)^\\top (\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\mathbf{W}\\mathbf{V}^\\top\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top$ 是对称且正定的证明已在算法推导部分给出。\n\n### 3. 实现与验证\n\nPython 实现将遵循推导出的算法。对每个测试矩阵 $\\mathbf{F}_k$，我们执行以下步骤：\n1. 构建 $\\mathbf{F}_k$。\n2. 使用 `numpy.linalg.svd` 计算其 SVD：$\\mathbf{V}$、$\\mathbf{S}$ (奇异值向量)、$\\mathbf{W}^\\top$。\n3. 计算 $\\mathbf{R}_k = \\mathbf{V} \\mathbf{W}^\\top$。\n4. 计算所需的诊断量。\n\n对于情况 1 和 4，诊断量是 $|\\,\\|\\mathbf{F}_k - \\mathbf{R}_k\\|_F - \\sqrt{\\sum (\\sigma_i - 1)^2}\\,|$。\n从第 2 节的证明中，目标函数的最小值是：\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\|\\mathbf{F}\\|_F^2 + n - 2 \\operatorname{Tr}(\\mathbf{R}^\\top\\mathbf{F}) $$\n我们证明了 $\\operatorname{Tr}(\\mathbf{R}^\\top\\mathbf{F}) = \\sum \\sigma_i$。并且，$\\|\\mathbf{F}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}^2\\mathbf{W}^\\top) = \\operatorname{Tr}(\\mathbf{\\Sigma}^2) = \\sum \\sigma_i^2$。\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\sum \\sigma_i^2 + n - 2\\sum \\sigma_i = \\sum_{i=1}^n (\\sigma_i^2 - 2\\sigma_i + 1) = \\sum_{i=1}^n (\\sigma_i - 1)^2 $$\n取平方根，我们恰好得到 $\\|\\mathbf{F} - \\mathbf{R}\\|_F = \\sqrt{\\sum (\\sigma_i - 1)^2}$。\n因此，对于情况 1 和 4，诊断量预期为零（在浮点精度误差范围内）。这可以作为对我们最小化证明的定量验证。\n\n对于情况 2 和 3，矩阵 $\\mathbf{F}_k$ 是以 $\\mathbf{F}_k = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$ 的形式构建的，其中 $\\mathbf{R}_{\\mathrm{true}}$ 是一个正常正交张量，$\\mathbf{U}_{\\mathrm{true}}$ 是对称正定的。根据定义，这本身就是右极分解。由于可逆矩阵的极分解是唯一的，我们的算法必须恢复出 $\\mathbf{R}_k = \\mathbf{R}_{\\mathrm{true}}$ 和 $\\mathbf{U}_k = \\mathbf{U}_{\\mathrm{true}}$。因此，诊断量 $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$ 和 $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$ 预期为零（在数值精度范围内）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the right polar decomposition for several deformation gradients and\n    calculates specific diagnostic values to verify the theoretical results.\n    \"\"\"\n\n    # --- Test Case 1: 2D diagonal stretch ---\n    F1 = np.array([[2.0, 0.0], [0.0, 0.5]])\n\n    # --- Test Case 2: 2D rotated stretch ---\n    theta = 0.4\n    R_true2 = np.array([[np.cos(theta), -np.sin(theta)],\n                        [np.sin(theta), np.cos(theta)]])\n    U_true2 = np.diag([1.2, 0.8])\n    F2 = R_true2 @ U_true2\n\n    # --- Test Case 3: 3D general symmetric stretch ---\n    phi = 0.6\n    Q3 = np.array([[np.cos(phi), -np.sin(phi), 0.0],\n                   [np.sin(phi), np.cos(phi), 0.0],\n                   [0.0, 0.0, 1.0]])\n    D3 = np.diag([1.5, 0.9, 1.1])\n    U_true3 = Q3 @ D3 @ Q3.T\n    \n    alpha = -0.7\n    R_true3_x = np.array([[1.0, 0.0, 0.0],\n                          [0.0, np.cos(alpha), -np.sin(alpha)],\n                          [0.0, np.sin(alpha), np.cos(alpha)]])\n    F3 = R_true3_x @ U_true3\n\n    # --- Test Case 4: 2D ill-conditioned stretch ---\n    beta = 1.1\n    R_beta4 = np.array([[np.cos(beta), -np.sin(beta)],\n                        [np.sin(beta), np.cos(beta)]])\n    U_true4 = np.diag([1e-6, 3.0])\n    F4 = R_beta4 @ U_true4\n\n    test_cases = [\n        {'F': F1, 'type': 'diag_check'},\n        {'F': F2, 'type': 'R_check', 'R_true': R_true2},\n        {'F': F3, 'type': 'U_check', 'U_true': U_true3, 'R_true': R_true3_x},\n        {'F': F4, 'type': 'diag_check'}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        F = case['F']\n        \n        # Core algorithm: Right Polar Decomposition using SVD\n        # F = V @ Sigma @ Wt\n        V, S_vec, Wt = np.linalg.svd(F)\n        \n        # In this problem, det(F) > 0, so det(V)*det(Wt) is always +1.\n        # The general algorithm for any F would handle det(F)  0 by flipping\n        # a sign to ensure det(R) = +1, but it's not needed here.\n        R = V @ Wt\n\n        if case['type'] == 'diag_check':\n            # Diagnostic: | ||F - R||_F - sqrt(sum((sigma_i - 1)^2)) |\n            norm_F_minus_R = np.linalg.norm(F - R, 'fro')\n            norm_s_minus_1 = np.sqrt(np.sum((S_vec - 1)**2))\n            diagnostic = np.abs(norm_F_minus_R - norm_s_minus_1)\n            results.append(diagnostic)\n            \n        elif case['type'] == 'R_check':\n            # Diagnostic: ||R - R_true||_F\n            R_true = case['R_true']\n            diagnostic = np.linalg.norm(R - R_true, 'fro')\n            results.append(diagnostic)\n\n        elif case['type'] == 'U_check':\n            # U can be computed as U = R.T @ F\n            U = R.T @ F\n            U_true = case['U_true']\n            # Diagnostic: ||U - U_true||_F\n            diagnostic = np.linalg.norm(U - U_true, 'fro')\n            results.append(diagnostic)\n\n    # Format the output as a comma-separated list of floats in a single line.\n    # Use scientific notation for consistency and to handle very small numbers.\n    formatted_results = [f\"{res:.8e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2886399"}]}