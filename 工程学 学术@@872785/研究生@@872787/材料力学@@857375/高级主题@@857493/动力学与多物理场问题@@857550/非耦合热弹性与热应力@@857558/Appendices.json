{"hands_on_practices": [{"introduction": "理解热应力如何在受约束的结构中产生，是热弹性力学的一个基石。这个练习将通过一个经典的静不定系统，引导你综合运用平衡方程、运动学协调条件以及热弹性本构关系来求解问题。通过解决这个问题 [@problem_id:2928446]，你将为分析更复杂的工程组件（例如精密仪器或大型土木结构中的组件）建立坚实的基础，在这些应用中，温度效应至关重要。", "problem": "一根直棱复合杆由两段同轴杆段端对端连接而成，置于两个完全刚性、不可移动的支座之间，支座间距固定。杆段1的长度为$L_{1}$，横截面积为$A_{1}$，杨氏模量为$E_{1}$，线性热膨胀系数为$\\alpha_{1}$。杆段2的长度为$L_{2}$，横截面积为$A_{2}$，杨氏模量为$E_{2}$，线性热膨胀系数为$\\alpha_{2}$。在参考温度$T_{0}$时，该组合杆无应力，且恰好安装在两个支座之间。然后，整个杆件承受均匀的温升$\\Delta T$，而支座保持固定且不发生热膨胀。假设为非耦合线性热弹性状态：温度场是预设的（不受应力反馈影响），热应变为$\\alpha \\,\\Delta T$，总小应变等于机械应变和热应变之和。忽略体力以及接头处的任何滑移或间隙。\n\n仅使用平衡方程、运动学协调条件和线性热弹性本构定律，写出控制方程并求解杆中产生的共同轴向力。报告左支座的反力大小，注意两个支座反力大小相等。使用以下数据，这些数据对应于一个科学上合理的异种材料组合件：\n- $L_{1} = 0.60\\,\\mathrm{m}$，$A_{1} = 3.0\\times 10^{-4}\\,\\mathrm{m}^{2}$，$E_{1} = 70\\times 10^{9}\\,\\mathrm{Pa}$，$\\alpha_{1} = 23\\times 10^{-6}\\,\\mathrm{K}^{-1}$。\n- $L_{2} = 0.40\\,\\mathrm{m}$，$A_{2} = 2.0\\times 10^{-4}\\,\\mathrm{m}^{2}$，$E_{2} = 200\\times 10^{9}\\,\\mathrm{Pa}$，$\\alpha_{2} = 12\\times 10^{-6}\\,\\mathrm{K}^{-1}$。\n- $\\Delta T = 60\\,\\mathrm{K}$。\n\n以千牛（kN）为单位表示最终答案，并四舍五入到四位有效数字。", "solution": "解决此问题需要应用材料力学的三个基本原理：静力平衡、运动学协调和热弹性材料的本构定律。\n\n1.  **平衡：** 复合杆在支座反力的作用下处于静力平衡状态。对于一个沿其长度方向没有外力的一维问题，我们记为$P$的内部轴向力在整个杆件上必须是恒定的。我们采用惯例，正值力$P$为拉力，负值力为压力。支座的反力大小与此内力大小相等。\n\n2.  **运动学协调：** 支座被定义为完全刚性且不可移动。这对系统施加了一个运动学约束：复合杆的总长度变化（伸长量）必须为零。总伸长量$\\delta_{total}$是杆段1的伸长量($\\delta_1$)和杆段2的伸长量($\\delta_2$)之和。\n    $$ \\delta_{total} = \\delta_1 + \\delta_2 = 0 $$\n\n3.  **本构定律：** 对于线性热弹性材料，总应变$\\epsilon$是机械应变$\\epsilon_m$和热应变$\\epsilon_T$之和。机械应变遵循胡克定律，$\\epsilon_m = \\sigma / E$，其中$\\sigma$是轴向应力，E是杨氏模量。应力为$\\sigma = P / A$，其中A是横截面积。热应变由$\\epsilon_T = \\alpha \\Delta T$给出，其中$\\alpha$是线性热膨胀系数，$\\Delta T$是均匀的温度变化。长度为L的杆段的总伸长量$\\delta$为$\\delta = \\epsilon L$。将这些结合起来，得到杆段总伸长量的表达式：\n    $$ \\delta = \\left( \\frac{\\sigma}{E} + \\alpha \\Delta T \\right) L = \\left( \\frac{P}{AE} + \\alpha \\Delta T \\right) L = \\frac{PL}{AE} + \\alpha L \\Delta T $$\n\n通过将此本构关系应用于杆的每个部分，我们得到：\n$$ \\delta_1 = \\frac{P L_1}{A_1 E_1} + \\alpha_1 L_1 \\Delta T $$\n$$ \\delta_2 = \\frac{P L_2}{A_2 E_2} + \\alpha_2 L_2 \\Delta T $$\n\n将这些表达式代入协调方程$\\delta_1 + \\delta_2 = 0$中，得到系统的控制方程：\n$$ \\left( \\frac{P L_1}{A_1 E_1} + \\alpha_1 L_1 \\Delta T \\right) + \\left( \\frac{P L_2}{A_2 E_2} + \\alpha_2 L_2 \\Delta T \\right) = 0 $$\n我们现在可以求解内力$P$：\n$$ P \\left( \\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2} \\right) = - (\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T $$\n$$ P = - \\frac{(\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T}{\\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2}} $$\n负号证实了内力是压力，因为温度升高导致杆件推向固定支座。问题要求的是左支座反力$R$的大小，它等于内力的大小，即$R = |P|$。\n$$ R = \\frac{(\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T}{\\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2}} $$\n\n现在，代入所提供的数值。分开计算分子和分母是很有条理的方法。\n分子代表总的无约束热膨胀量：\n$$ \\text{分子} = (\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T = \\left( (23 \\times 10^{-6}\\,\\mathrm{K}^{-1})(0.60\\,\\mathrm{m}) + (12 \\times 10^{-6}\\,\\mathrm{K}^{-1})(0.40\\,\\mathrm{m}) \\right) (60\\,\\mathrm{K}) $$\n$$ = (1.38 \\times 10^{-5}\\,\\mathrm{m} + 0.48 \\times 10^{-5}\\,\\mathrm{m}) (60) = (1.86 \\times 10^{-5}\\,\\mathrm{m})(60) = 1.116 \\times 10^{-3}\\,\\mathrm{m} $$\n分母代表两个杆段的机械柔度之和：\n$$ \\frac{L_1}{A_1 E_1} = \\frac{0.60\\,\\mathrm{m}}{(3.0 \\times 10^{-4}\\,\\mathrm{m}^2)(70 \\times 10^9\\,\\mathrm{Pa})} = \\frac{0.60}{2.1 \\times 10^7}\\,\\mathrm{m/N} \\approx 2.85714 \\times 10^{-8}\\,\\mathrm{m/N} $$\n$$ \\frac{L_2}{A_2 E_2} = \\frac{0.40\\,\\mathrm{m}}{(2.0 \\times 10^{-4}\\,\\mathrm{m}^2)(200 \\times 10^9\\,\\mathrm{Pa})} = \\frac{0.40}{4.0 \\times 10^7}\\,\\mathrm{m/N} = 1.0 \\times 10^{-8}\\,\\mathrm{m/N} $$\n$$ \\text{分母} = \\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2} \\approx (2.85714 + 1.0) \\times 10^{-8}\\,\\mathrm{m/N} = 3.85714 \\times 10^{-8}\\,\\mathrm{m/N} $$\n反力$R$的大小是这两个量的比值：\n$$ R = \\frac{1.116 \\times 10^{-3}\\,\\mathrm{m}}{3.85714 \\times 10^{-8}\\,\\mathrm{m/N}} \\approx 28933.3\\,\\mathrm{N} $$\n问题要求答案以千牛（kN）为单位，并四舍五入到4位有效数字。\n$$ R = 28.9333\\,\\mathrm{kN} \\approx 28.93\\,\\mathrm{kN} $$", "answer": "$$\\boxed{28.93}$$", "id": "2928446"}, {"introduction": "在分析了由离散部件组成的结构之后，我们现在将注意力转向功能梯度材料（FGM），这类材料的性质会随空间位置连续变化。这个练习 [@problem_id:2928462] 要求你将平衡和协调性等核心原理应用于连续介质，这需要使用积分来施加边界条件。推导出应力场的符号表达式，可以让你深刻理解材料属性的梯度如何影响热机械响应，并为验证数值模型提供理论依据。", "problem": "一根长度为 $L$ 的细长直杆沿其轴线占据区间 $x \\in [0,L]$。该杆是非均匀的：其杨氏模量 $E(x)$ 和横截面积 $A(x)$ 是 $x$ 的光滑正函数。杆的两端由完全刚性支座约束，因此轴向位移满足 $u(0)=0$ 和 $u(L)=0$。不存在外部机械牵引力或轴向体力。在非耦合热弹性假设下，温度场是给定的，并且不受机械响应的影响。杆承受线性温度分布 $T(x) = T_{0} + \\beta x$，其中 $T_{0}$ 和 $\\beta$ 是常数，无应力参考温度为 $T_{\\mathrm{ref}} = T_{0}$。线性热膨胀系数是常数，等于 $\\alpha_{0}$。假设小应变以及适用于细长轴向受力构件的一维 (1D) 运动学和本构响应。\n\n从一维热弹性的基本原理出发——即无体力情况下的力学平衡、应变-位移关系和线性热弹性本构关系——推导轴向柯西应力场 $\\sigma(x)$ 关于 $x$、$L$、$\\beta$、$\\alpha_{0}$、$E(x)$ 和 $A(x)$ 的封闭形式表达式。以帕斯卡 (Pascals) 为单位表示 $\\sigma(x)$ 的最终答案。不要代入任何数值；仅提供符号表达式。最终答案必须是 $\\sigma(x)$ 的单个解析表达式。", "solution": "该问题旨在确定一根两端固定、承受线性温度分布的非均匀杆中的轴向应力场 $\\sigma(x)$。此问题采用一维 (1D) 热弹性力学的基本原理进行求解。\n\n首先，我们建立控制方程。\n1.  **力学平衡**：在没有轴向体力的情况下，一维平衡方程由下式给出\n    $$ \\frac{dP(x)}{dx} = 0 $$\n    其中 $P(x)$ 是位置 $x$ 处横截面上的内部轴向力。该方程意味着轴向力 $P(x)$ 必须沿杆的全长保持恒定。我们用 $F$ 表示这个恒定的力，因此 $P(x) = F$。轴向力与轴向柯西应力 $\\sigma(x)$ 和横截面积 $A(x)$ 的关系为 $P(x) = \\sigma(x) A(x)$。因此，我们有\n    $$ \\sigma(x) A(x) = F $$\n    这是一个静不定问题，恒定的反作用力 $F$ 必须由协调性和边界条件确定。根据这个关系，我们可以将应力表示为\n    $$ \\sigma(x) = \\frac{F}{A(x)} $$\n\n2.  **应变-位移关系**：对于小变形，轴向应变 $\\epsilon(x)$ 与轴向位移 $u(x)$ 的关系为\n    $$ \\epsilon(x) = \\frac{du(x)}{dx} $$\n\n3.  **本构关系**：一维线性热弹性本构关系表明，总应变 $\\epsilon(x)$ 是机械应变 $\\epsilon_{\\text{mech}}(x)$ 和热应变 $\\epsilon_{\\text{th}}(x)$ 的和。\n    $$ \\epsilon(x) = \\epsilon_{\\text{mech}}(x) + \\epsilon_{\\text{th}}(x) $$\n    机械应变由胡克定律给出，$\\epsilon_{\\text{mech}}(x) = \\sigma(x) / E(x)$，其中 $E(x)$ 是杨氏模量。热应变由 $\\epsilon_{\\text{th}}(x) = \\alpha_{0} \\Delta T(x)$ 给出，其中 $\\alpha_{0}$ 是线性热膨胀系数，$\\Delta T(x)$ 是相对于无应力参考温度 $T_{\\text{ref}}$ 的温度变化。\n    给定温度场 $T(x) = T_{0} + \\beta x$ 和参考温度 $T_{\\text{ref}} = T_{0}$，温度变化为\n    $$ \\Delta T(x) = T(x) - T_{\\text{ref}} = (T_{0} + \\beta x) - T_{0} = \\beta x $$\n    综合这些，总应变为\n    $$ \\epsilon(x) = \\frac{\\sigma(x)}{E(x)} + \\alpha_{0} \\beta x $$\n\n现在，我们使用边界条件来求解未知力 $F$。杆的两端由刚性支座约束，因此位移 $u(x)$ 满足 $u(0)=0$ 和 $u(L)=0$。杆的总长度变化是轴向应变在其长度上的积分：\n$$ \\Delta L = u(L) - u(0) = \\int_{0}^{L} \\epsilon(x) dx $$\n给定边界条件，总长度变化为零：\n$$ u(L) - u(0) = 0 - 0 = 0 $$\n这为该问题提供了协调方程：\n$$ \\int_{0}^{L} \\epsilon(x) dx = 0 $$\n我们将总应变的表达式代入此协调方程：\n$$ \\int_{0}^{L} \\left( \\frac{\\sigma(x)}{E(x)} + \\alpha_{0} \\beta x \\right) dx = 0 $$\n接下来，我们代入应力的表达式 $\\sigma(x) = F/A(x)$：\n$$ \\int_{0}^{L} \\left( \\frac{F}{A(x)E(x)} + \\alpha_{0} \\beta x \\right) dx = 0 $$\n我们可以将积分分成两部分：\n$$ \\int_{0}^{L} \\frac{F}{A(x)E(x)} dx + \\int_{0}^{L} \\alpha_{0} \\beta x dx = 0 $$\n由于 $F$、$\\alpha_{0}$ 和 $\\beta$ 是常数，我们可以将它们移到积分符号外：\n$$ F \\int_{0}^{L} \\frac{1}{A(x)E(x)} dx + \\alpha_{0} \\beta \\int_{0}^{L} x dx = 0 $$\n计算第二个积分得到：\n$$ \\int_{0}^{L} x dx = \\left[ \\frac{x^{2}}{2} \\right]_{0}^{L} = \\frac{L^{2}}{2} $$\n将此结果代回 $F$ 的方程中：\n$$ F \\int_{0}^{L} \\frac{dx}{A(x)E(x)} + \\alpha_{0} \\beta \\frac{L^{2}}{2} = 0 $$\n现在，我们可以解出恒定的反作用力 $F$：\n$$ F = - \\frac{\\alpha_{0} \\beta \\frac{L^{2}}{2}}{\\int_{0}^{L} \\frac{dx}{A(x)E(x)}} $$\n最后，为了求得应力场 $\\sigma(x)$，我们将 $F$ 的这个表达式代回关系式 $\\sigma(x) = F/A(x)$ 中。为避免积分变量与位置变量 $x$ 混淆，我们使用哑变量 $\\xi$ 进行积分：\n$$ \\sigma(x) = \\frac{1}{A(x)} \\left( - \\frac{\\alpha_{0} \\beta L^{2}}{2 \\int_{0}^{L} \\frac{d\\xi}{A(\\xi)E(\\xi)}} \\right) $$\n这给出了杆中轴向应力分布的最终表达式：\n$$ \\sigma(x) = - \\frac{\\alpha_{0} \\beta L^{2}}{2 A(x) \\int_{0}^{L} \\frac{d\\xi}{A(\\xi)E(\\xi)}} $$\n该表达式表示了由于热膨胀在受约束的杆中产生的压应力。负号表示压缩，这在物理上是符合预期的，因为杆被加热（对于 $\\beta > 0$）并且被阻止伸长。", "answer": "$$\n\\boxed{-\\frac{\\alpha_{0} \\beta L^{2}}{2 A(x) \\int_{0}^{L} \\frac{d\\xi}{A(\\xi)E(\\xi)}}}\n$$", "id": "2928462"}, {"introduction": "虽然解析解非常强大，但大多数具有复杂几何形状和材料属性的真实工程问题都需要借助数值方法。有限元法（FEM）是进行此类分析的行业标准。这项终极实践练习 [@problem_id:2928435] 将指导你从第一性原理出发，从虚功原理推导弱形式，从而构建一个一维有限元程序。通过实现该模型并对照解析解进行验证，你将对热载荷如何整合到有限元分析中以及如何处理空间变化的材料属性获得实践性的理解，这是高级力学分析与设计的一项关键技能。", "problem": "实现一种一维有限元方法，用于求解功能梯度材料中的非耦合热弹性问题，其中杨氏模量 $E(x)$ 和热膨胀系数 $\\alpha(x)$ 均在空间上变化。目标是从基本原理出发，展示在热载荷作用下，空间变化的系数如何在单元级别被一致地纳入，并组装成全局系统。仅从以下基本原理出发：运动学关系 $\\varepsilon(x) = du/dx$，无体力的一维线性动量平衡，以及线性热弹性本构行为 $\\sigma(x) = E(x)\\left(\\varepsilon(x) - \\alpha(x)\\Delta T\\right)$，其中 $\\Delta T$ 是一个给定的温度变化场，且独立于力学解（非耦合热弹性）。使用虚功原理推导弱形式以及使用线性形函数的相应有限元离散化。不要使用任何跳过这些基本原理推导路径的快捷公式。\n\n使用数值积分实现单元刚度和热载荷，该积分在每个单元内的积分点上计算 $E(x)$ 和 $\\alpha(x)$ 的值。组装全局刚度和热载荷，施加指定的边界条件，求解节点位移，并对轴向应力场进行后处理。在所有情况下，横截面积 $A$ 均为常数，且杆件为等截面杆。\n\n您的程序必须计算以下三个测试用例，并报告所要求的量。对所有积分使用线性两节点单元、在总长度上划分 $N = 400$ 个单元的均匀网格，以及每个单元使用 $3$ 个点的高斯积分。空间坐标 $x$ 的范围为从 $x=0$ 到 $x=L$。\n\n所有测试的通用参数：\n- 长度 $L = 1.0$ m，面积 $A = 1.0\\times 10^{-4}$ m$^2$，基础模量 $E_0 = 2.10\\times 10^{11}$ Pa，基础热膨胀系数 $\\alpha_0 = 12.0\\times 10^{-6}$ K$^{-1}$。\n\n测试用例 1 (梯度特性下的自由热膨胀):\n- 材料梯度: $E(x) = E_0\\left(1 + 0.5\\,x/L\\right)$, $\\alpha(x) = \\alpha_0\\left(1 + 0.5\\,x/L\\right)$。\n- 温度变化: $\\Delta T = 100.0$ K。\n- 边界条件: $u(0)=0$ 于 $x=0$ (固定)，无牵引于 $x=L$。\n- 待验证量：将有限元解得到的自由端位移 $u(L)$ 与 $x=L$ 处无牵引条件下处处应力为零所对应的精确值进行比较。报告绝对相对误差，一个无量纲浮点数。\n\n测试用例 2 (两端固定，无外部牵引):\n- 材料梯度: $E(x) = E_0\\left(1 + 0.8\\,x/L\\right)^2$, $\\alpha(x) = \\alpha_0\\left(1 + 0.3\\,x/L\\right)$。\n- 温度变化: $\\Delta T = 40.0$ K。\n- 边界条件: $u(0)=0$ 于 $x=0$ 且 $u(L)=0$ 于 $x=L$。\n- 待验证量：将有限元解得到的空间平均轴向应力 $\\bar{\\sigma} = \\frac{1}{L}\\int_{0}^{L}\\sigma(x)\\,dx$ 与由平衡和协调性所对应的精确恒定应力进行比较。报告绝对相对误差，一个无量纲浮点数。\n\n测试用例 3 (左端固定，右端施加端点牵引):\n- 材料梯度: $E(x) = E_0\\exp\\!\\left(1.2\\,x/L\\right)$, $\\alpha(x) = \\alpha_0\\left(1 + 0.4\\,x/L\\right)$。\n- 温度变化: $\\Delta T = 50.0$ K。\n- 边界条件和载荷：$u(0)=0$ 于 $x=0$，并在 $x=L$ 处施加一个给定的轴向牵引 $t = 50.0\\times 10^{6}$ Pa。\n- 待验证量：将有限元解得到的自由端位移 $u(L)$ 与轴向应力恒等于 $t$ 的平衡状态所对应的精确值进行比较。报告绝对相对误差，一个无量纲浮点数。\n\n需要生成的精确输出：\n- 对于测试用例 1：输出一个浮点数，其值为计算出的 $u(L)$ (单位：m) 与精确参考值 $u(L)$ (单位：m) 之间的绝对相对误差。\n- 对于测试用例 2：输出一个浮点数，其值为计算出的 $\\bar{\\sigma}$ (单位：Pa) 与精确参考值 $\\sigma$ (单位：Pa) 之间的绝对相对误差。\n- 对于测试用例 3：输出一个浮点数，其值为计算出的 $u(L)$ (单位：m) 与精确参考值 $u(L)$ (单位：m) 之间的绝对相对误差。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的列表，内含三个结果（例如，“[r1,r2,r3]”）。这三个浮点数必须按顺序分别是测试用例 1、2 和 3 的结果。每个报告的浮点数必须是无量纲的（绝对相对误差）。不应打印任何其他文本。\n\n注意：\n- 实现中的所有物理量必须使用国际单位制（SI单位）处理。位移单位为 m，应力单位为 Pa，温度单位为 K，长度单位为 m。报告的误差是无量纲的。\n- 本问题不使用角度。\n- 该实现不得读取任何用户输入，并且必须按原样运行。", "solution": "该解法需要实现一种用于功能梯度杆中非耦合热弹性问题的一维有限元方法（FEM）。这将从虚功原理出发进行推导。\n\n基本控制关系如下：\n$1$. 运动学关系 (应变-位移): $\\varepsilon(x) = \\frac{du}{dx}$\n$2$. 静力平衡 (源于无体力的线性动量平衡): $\\frac{d\\sigma}{dx} = 0$\n$3$. 本构关系 (线性热弹性): $\\sigma(x) = E(x)(\\varepsilon(x) - \\varepsilon_{th}(x)) = E(x)(\\frac{du}{dx} - \\alpha(x)\\Delta T)$\n\n此处，$u(x)$ 是轴向位移，$\\varepsilon(x)$ 是总轴向应变，$\\sigma(x)$ 是轴向应力，$E(x)$ 是空间变化的杨氏模量，$\\alpha(x)$ 是空间变化的热膨胀系数，$\\Delta T$ 是给定的均匀温度变化。\n\n虚功原理指出，对于处于平衡状态的物体，应力在虚应变场上所做的内虚功（$\\delta W_{int}$）等于外力在相应虚位移场上所做的外虚功（$\\delta W_{ext}$）。\n$$ \\delta W_{int} = \\delta W_{ext} $$\n对于横截面积为 $A$、长度为 $L$ 的一维杆，这表示为：\n$$ \\int_0^L \\sigma(x) \\delta\\varepsilon(x) A \\, dx = (P_L \\delta u(L) + P_0 \\delta u(0)) $$\n其中 $\\delta\\varepsilon$ 是与运动学容许的虚位移 $\\delta u$ 对应的虚应变，$P_0$ 和 $P_L$ 是在 $x=0$ 和 $x=L$ 处的外部点力。\n\n我们将本构关系代入内虚功项：\n$$ \\delta W_{int} = \\int_0^L E(x) \\left( \\frac{du}{dx} - \\alpha(x)\\Delta T \\right) \\frac{d(\\delta u)}{dx} A \\, dx $$\n整理各项，我们得到问题的弱形式。求解满足本质边界条件的 $u(x)$，使得对于所有容许的虚位移 $\\delta u$：\n$$ \\int_0^L A E(x) \\frac{du}{dx} \\frac{d(\\delta u)}{dx} \\, dx = \\int_0^L A E(x)\\alpha(x)\\Delta T \\frac{d(\\delta u)}{dx} \\, dx + \\delta W_{ext} $$\n\n为了离散化此方程，我们将域 $[0, L]$ 划分为 $N$ 个有限元。在每个连接节点 $i$ 和 $j$、长度为 $L^{(e)}$ 的单元 $(e)$ 内，位移场 $u(x)$ 使用线性形函数 $\\mathbf{N}(x) = [N_i(x), N_j(x)]$ 进行近似：\n$$ u^{(e)}(x) \\approx \\mathbf{N}(x) \\mathbf{d}^{(e)} = N_i(x) d_i + N_j(x) d_j $$\n其中 $\\mathbf{d}^{(e)} = [d_i, d_j]^T$ 是节点位移向量。应变则为：\n$$ \\varepsilon^{(e)}(x) = \\frac{du^{(e)}}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{d}^{(e)} = \\mathbf{B}^{(e)} \\mathbf{d}^{(e)} $$\n对于线性两节点单元，应变-位移矩阵 $\\mathbf{B}^{(e)}$ 是常数：\n$$ \\mathbf{B}^{(e)} = \\frac{1}{L^{(e)}} [-1, 1] $$\n虚位移和虚应变也用类似的方式近似：$\\delta u^{(e)} = \\mathbf{N}\\delta\\mathbf{d}^{(e)}$ 和 $\\delta\\varepsilon^{(e)} = \\mathbf{B}^{(e)}\\delta\\mathbf{d}^{(e)}$。\n\n将离散化的场代入单个单元的弱形式，得到：\n$$ (\\delta\\mathbf{d}^{(e)})^T \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x) \\mathbf{B}^{(e)} \\mathbf{d}^{(e)} \\, dx = (\\delta\\mathbf{d}^{(e)})^T \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x)\\alpha(x)\\Delta T \\, dx $$\n因为此式必须对任意的 $(\\delta\\mathbf{d}^{(e)})^T$ 成立，我们得到单元级矩阵方程：\n$$ \\mathbf{k}^{(e)} \\mathbf{d}^{(e)} = \\mathbf{f}_{th}^{(e)} $$\n其中 $\\mathbf{k}^{(e)}$ 是单元刚度矩阵，$\\mathbf{f}_{th}^{(e)}$ 是单元热载荷向量。\n\n各分量定义如下：\n$$ \\mathbf{k}^{(e)} = \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x) \\mathbf{B}^{(e)} \\, dx = \\frac{A}{(L^{(e)})^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} \\int_{L^{(e)}} E(x) \\, dx $$\n$$ \\mathbf{f}_{th}^{(e)} = \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x)\\alpha(x)\\Delta T \\, dx = \\frac{A \\Delta T}{L^{(e)}} \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} \\int_{L^{(e)}} E(x)\\alpha(x) \\, dx $$\n由于 $E(x)$ 和 $\\alpha(x)$ 是空间变化的，积分使用高斯积分进行数值计算。对于单元上的积分，我们使用 $x(\\xi) = \\frac{x_i+x_j}{2} + \\frac{L^{(e)}}{2}\\xi$ 将域 $x \\in [x_i, x_j]$ 映射到标准域 $\\xi \\in [-1, 1]$。微分元为 $dx = \\frac{L^{(e)}}{2}d\\xi$。积分变为在 $n_p$ 个积分点上的求和：\n$$ \\int_{L^{(e)}} g(x) dx = \\int_{-1}^1 g(x(\\xi)) \\frac{L^{(e)}}{2} d\\xi \\approx \\frac{L^{(e)}}{2} \\sum_{k=1}^{n_p} w_k g(x(\\xi_k)) $$\n其中 $w_k$ 和 $\\xi_k$ 是积分权重和积分点。问题指定 $n_p=3$。\n\n在为每个单元计算出 $\\mathbf{k}^{(e)}$ 和 $\\mathbf{f}_{th}^{(e)}$ 之后，将它们组装成全局方程组 $\\mathbf{K}\\mathbf{d} = \\mathbf{F}_{th} + \\mathbf{F}_{ext}$，其中 $\\mathbf{K}$ 是全局刚度矩阵，$\\mathbf{d}$ 是全局节点位移向量，$\\mathbf{F}_{th}$ 是全局热载荷向量，$\\mathbf{F}_{ext}$ 包含外部机械载荷。\n\n然后施加边界条件。对于给定的位移 $u_i = 0$，$\\mathbf{K}$ 的相应行和列被修改（例如，通过消元法），力向量也被调整。在求解出 $\\mathbf{d}$ 后，可以对每个单元中的应力进行后处理。由于每个单元的应变是恒定的，应力仅随材料属性变化：\n$$ \\sigma^{(e)}(x) = E(x) \\left( \\frac{d_j - d_i}{L^{(e)}} - \\alpha(x)\\Delta T \\right) $$\n\n为进行验证，我们从平衡方程 $\\frac{d\\sigma}{dx}=0$（这意味着 $\\sigma(x) = \\sigma_c$（一个常数））推导每个测试用例的精确解。位移通过对本构律积分得到：\n$$ u(x) = u(0) + \\int_0^x \\left(\\frac{\\sigma_c}{E(x')} + \\alpha(x')\\Delta T\\right) dx' $$\n情况 1：$u(0)=0$ 且 $\\sigma(L)=0$ (无牵引)。这意味着 $\\sigma_c=0$。\n$$ u_{exact}(L) = \\Delta T \\int_0^L \\alpha_0(1 + 0.5x/L) dx = \\alpha_0 \\Delta T [x + 0.25x^2/L]_0^L = 1.25 \\alpha_0 \\Delta T L $$\n情况 2：$u(0)=0$ 且 $u(L)=0$。使用条件 $u(L)=0$ 来求解 $\\sigma_c$。\n$$ 0 = \\sigma_c \\int_0^L \\frac{dx}{E(x)} + \\Delta T \\int_0^L \\alpha(x) dx \\implies \\bar{\\sigma}_{exact} = \\sigma_c = -\\Delta T \\frac{\\int_0^L \\alpha(x)dx}{\\int_0^L E(x)^{-1}dx} $$\n积分计算结果为 $\\int_0^L \\alpha_0(1+0.3x/L)dx = 1.15\\alpha_0 L$ 和 $\\int_0^L E_0^{-1}(1+0.8x/L)^{-2}dx = L/(1.8E_0)$。\n$$ \\bar{\\sigma}_{exact} = -\\Delta T \\frac{1.15\\alpha_0 L}{L/(1.8E_0)} = -2.07\\alpha_0 E_0 \\Delta T $$\n情况 3：$u(0)=0$ 且 $\\sigma(L)=t$。这意味着 $\\sigma_c=t$。\n$$ u_{exact}(L) = \\int_0^L \\left(\\frac{t}{E(x)} + \\alpha(x)\\Delta T\\right) dx = t \\int_0^L E_0^{-1}e^{-1.2x/L}dx + \\Delta T \\int_0^L \\alpha_0(1+0.4x/L)dx $$\n$$ u_{exact}(L) = \\frac{tL}{1.2E_0}(1-e^{-1.2}) + 1.2 \\alpha_0 \\Delta T L $$\n这些精确解将用作参考，以计算有限元实现所需的绝对相对误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a 1D FEM for uncoupled thermoelasticity in FGMs.\n    \"\"\"\n    # Common parameters from problem statement\n    L = 1.0  # m\n    A = 1.0e-4  # m^2\n    E0 = 2.10e11  # Pa\n    alpha0 = 12.0e-6  # K^-1\n    N = 400  # Number of elements\n    num_gauss_points = 3\n\n    # Define material property functions for each test case\n    def E_func_1(x, L_bar, E_base):\n        return E_base * (1.0 + 0.5 * x / L_bar)\n    \n    def alpha_func_1(x, L_bar, alpha_base):\n        return alpha_base * (1.0 + 0.5 * x / L_bar)\n\n    def E_func_2(x, L_bar, E_base):\n        return E_base * (1.0 + 0.8 * x / L_bar)**2\n    \n    def alpha_func_2(x, L_bar, alpha_base):\n        return alpha_base * (1.0 + 0.3 * x / L_bar)\n\n    def E_func_3(x, L_bar, E_base):\n        return E_base * np.exp(1.2 * x / L_bar)\n    \n    def alpha_func_3(x, L_bar, alpha_base):\n        return alpha_base * (1.0 + 0.4 * x / L_bar)\n\n    test_cases = [\n        {\n            \"E_func\": E_func_1, \"alpha_func\": alpha_func_1, \"delta_T\": 100.0,\n            \"bcs\": {\"u0\": 0.0, \"uL\": None}, \"traction_L\": 0.0, \"case_id\": 1\n        },\n        {\n            \"E_func\": E_func_2, \"alpha_func\": alpha_func_2, \"delta_T\": 40.0,\n            \"bcs\": {\"u0\": 0.0, \"uL\": 0.0}, \"traction_L\": 0.0, \"case_id\": 2\n        },\n        {\n            \"E_func\": E_func_3, \"alpha_func\": alpha_func_3, \"delta_T\": 50.0,\n            \"bcs\": {\"u0\": 0.0, \"uL\": None}, \"traction_L\": 50.0e6, \"case_id\": 3\n        }\n    ]\n\n    results = []\n\n    # Get Gaussian quadrature points and weights for the canonical interval [-1, 1]\n    # This is equivalent to `scipy.integrate.quadrature` or other standard tables\n    # For num_gauss_points = 3\n    gauss_points = np.array([-np.sqrt(3.0/5.0), 0.0, np.sqrt(3.0/5.0)])\n    gauss_weights = np.array([5.0/9.0, 8.0/9.0, 5.0/9.0])\n    \n    # Generate mesh\n    nodes = np.linspace(0, L, N + 1)\n    num_nodes = N + 1\n    elem_length = L / N\n\n    for case in test_cases:\n        E_func = case[\"E_func\"]\n        alpha_func = case[\"alpha_func\"]\n        delta_T = case[\"delta_T\"]\n\n        # Initialize global matrices\n        K_global = np.zeros((num_nodes, num_nodes))\n        F_global = np.zeros(num_nodes)\n\n        # Assemble global stiffness matrix and thermal load vector\n        for e in range(N):\n            node_i, node_j = e, e + 1\n            x1, x2 = nodes[node_i], nodes[node_j]\n            \n            # Numerical integration for element stiffness and thermal load\n            k_integral = 0.0\n            f_integral = 0.0\n            \n            for i in range(num_gauss_points):\n                xi = gauss_points[i]\n                w = gauss_weights[i]\n                \n                # Map from canonical to physical coordinates\n                x_phys = (x1 + x2) / 2.0 + (elem_length / 2.0) * xi\n                \n                E_val = E_func(x_phys, L, E0)\n                alpha_val = alpha_func(x_phys, L, alpha0)\n                \n                jacobian = elem_length / 2.0\n                \n                k_integral += w * E_val * jacobian\n                f_integral += w * E_val * alpha_val * jacobian\n                \n            k_elem_scalar = (A / elem_length**2) * k_integral\n            k_elem = k_elem_scalar * np.array([[1, -1], [-1, 1]])\n\n            f_th_elem_scalar = (A * delta_T / elem_length) * f_integral\n            f_th_elem = f_th_elem_scalar * np.array([-1, 1])\n\n            # Assembly\n            K_global[node_i:node_i+2, node_i:node_i+2] += k_elem\n            F_global[node_i:node_i+2] += f_th_elem\n        \n        # Add external traction\n        if case[\"traction_L\"] != 0.0:\n            F_global[-1] += case[\"traction_L\"] * A\n\n        # Apply boundary conditions using elimination\n        if case[\"bcs\"][\"u0\"] is not None:\n            K_global[0, :] = 0\n            K_global[:, 0] = 0\n            K_global[0, 0] = 1.0\n            F_global[0] = case[\"bcs\"][\"u0\"]\n\n        if case[\"bcs\"][\"uL\"] is not None:\n            K_global[-1, :] = 0\n            K_global[:, -1] = 0\n            K_global[-1, -1] = 1.0\n            F_global[-1] = case[\"bcs\"][\"uL\"]\n        \n        # Solve for nodal displacements\n        displacements = np.linalg.solve(K_global, F_global)\n\n        # Post-process and calculate error for each case\n        if case[\"case_id\"] == 1:\n            u_fem_L = displacements[-1]\n            u_exact_L = 1.25 * alpha0 * delta_T * L\n            error = abs((u_fem_L - u_exact_L) / u_exact_L)\n            results.append(error)\n\n        elif case[\"case_id\"] == 2:\n            total_sigma_integral = 0.0\n            for e in range(N):\n                node_i, node_j = e, e + 1\n                x1, x2 = nodes[node_i], nodes[node_j]\n                \n                u_i, u_j = displacements[node_i], displacements[node_j]\n                strain = (u_j - u_i) / elem_length\n                \n                sigma_integral_elem = 0.0\n                for i in range(num_gauss_points):\n                    xi, w = gauss_points[i], gauss_weights[i]\n                    x_phys = (x1 + x2) / 2.0 + (elem_length / 2.0) * xi\n                    \n                    E_val = E_func(x_phys, L, E0)\n                    alpha_val = alpha_func(x_phys, L, alpha0)\n                    \n                    sigma_val = E_val * (strain - alpha_val * delta_T)\n                    sigma_integral_elem += w * sigma_val * (elem_length / 2.0)\n                \n                total_sigma_integral += sigma_integral_elem\n            \n            sigma_bar_fem = total_sigma_integral / L\n            sigma_bar_exact = -2.07 * alpha0 * E0 * delta_T\n            error = abs((sigma_bar_fem - sigma_bar_exact) / sigma_bar_exact)\n            results.append(error)\n\n        elif case[\"case_id\"] == 3:\n            u_fem_L = displacements[-1]\n            traction = case[\"traction_L\"]\n            \n            # Integral part 1: Mechanical displacement\n            term1 = (traction * L / (1.2 * E0)) * (1.0 - np.exp(-1.2))\n            # Integral part 2: Thermal displacement\n            term2 = 1.2 * alpha0 * delta_T * L\n            u_exact_L = term1 + term2\n            \n            error = abs((u_fem_L - u_exact_L) / u_exact_L)\n            results.append(error)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```", "id": "2928435"}]}