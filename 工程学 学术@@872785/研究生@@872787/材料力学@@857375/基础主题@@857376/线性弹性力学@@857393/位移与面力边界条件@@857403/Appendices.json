{"hands_on_practices": [{"introduction": "牵引力边界条件代表作用在物体表面的分布力。将这些分布载荷换算为等效的合力和合力矩，对于进行整体平衡分析至关重要。本练习 [@problem_id:2879066] 提供了计算这些全局量的直接实践，让你深入理解牵引力场的物理意义及其在结构分析中的应用。", "problem": "一个单连通平面弹性体占据矩形区域 $\\Omega=\\{(x,y)\\in\\mathbb{R}^{2}\\,|\\,0\\le x\\le L,\\;0\\le y\\le H\\}$，其平面外厚度 $B$ 是均匀的。全局笛卡尔基为 $\\{\\mathbf{e}_{x},\\mathbf{e}_{y},\\mathbf{e}_{z}\\}$，原点位于左下角 $(x,y)=(0,0)$，且 $\\mathbf{e}_{z}$ 指向平面外。位于 $x=L$ 的边界段承受一个给定的柯西牵引力（单位面积上的力）$\\bar{\\mathbf{t}}(y)=t_{0}\\,\\mathbf{e}_{x}$，该牵引力沿该面空间均匀分布。所有其他边界段都是无牵引力的，且体力不存在。取 $L=1.2\\ \\mathrm{m}$，$H=0.8\\ \\mathrm{m}$，$B=0.02\\ \\mathrm{m}$，以及 $t_{0}=5.0\\times 10^{6}\\ \\mathrm{N/m^{2}}$。\n\n仅使用基本平衡定律和定义，计算由给定边界牵引力产生的等效全局外力合力 $\\mathbf{F}$ 和绕原点的总力矩 $\\mathbf{M}_{O}$。采用由 $\\mathbf{M}_{O}$ 的 $z$ 分量定义的标准平面外标量力矩 $M_{z}$。将最终结果表示为单行矩阵 $(F_{x},F_{y},M_{z})$，其中 $F_{x}$ 和 $F_{y}$ 的单位为 $\\mathrm{N}$，$M_{z}$ 的单位为 $\\mathrm{N\\cdot m}$。无需四舍五入；提供精确值。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n逐字提取已知条件：\n- 物体占据一个矩形区域 $\\Omega=\\{(x,y)\\in\\mathbb{R}^{2}\\,|\\,0\\le x\\le L,\\;0\\le y\\le H\\}$。\n- 平面外厚度是均匀的，为 $B$。\n- 全局笛卡尔基为 $\\{\\mathbf{e}_{x},\\mathbf{e}_{y},\\mathbf{e}_{z}\\}$，原点位于 $(x,y)=(0,0)$。\n- 位于 $x=L$ 的边界具有给定的牵引力 $\\bar{\\mathbf{t}}(y)=t_{0}\\,\\mathbf{e}_{x}$。\n- 所有其他边界段都是无牵引力的。\n- 体力不存在。\n- $L=1.2\\ \\mathrm{m}$。\n- $H=0.8\\ \\mathrm{m}$。\n- $B=0.02\\ \\mathrm{m}$。\n- $t_{0}=5.0\\times 10^{6}\\ \\mathrm{N/m^{2}}$。\n- 任务是计算等效全局外力合力 $\\mathbf{F}$ 和绕原点的总力矩 $\\mathbf{M}_{O}$，并将结果表示为 $(F_{x},F_{y},M_{z})$。\n\n这个问题具有科学依据，是适定的，并且是客观的。这是连续介质力学中的一个标准练习，要求从指定的牵引力场计算合力和合力矩。该问题是自洽的，所有必要的数据都已提供。没有逻辑矛盾、科学不准确性或含糊不清的术语。物理参数是现实的。因此，该问题被认为是有效的。\n\n解题过程如下。作用在物体上的总外力合力 $\\mathbf{F}$ 是给定牵引力矢量 $\\bar{\\mathbf{t}}$ 在物体边界面 $\\partial\\Omega$ 上的积分。\n$$ \\mathbf{F} = \\int_{\\partial\\Omega} \\bar{\\mathbf{t}} \\, dS $$\n绕原点 $O$ 的总力矩合力 $\\mathbf{M}_{O}$ 是微元力 $d\\mathbf{F} = \\bar{\\mathbf{t}} \\, dS$ 的力矩的积分。\n$$ \\mathbf{M}_{O} = \\int_{\\partial\\Omega} \\mathbf{r} \\times \\bar{\\mathbf{t}} \\, dS $$\n其中 $\\mathbf{r}$ 是从原点到牵引力作用点的位矢。\n\n矩形体的边界 $\\partial\\Omega$ 由四个面组成。在 $x=L$ 处且 $0 \\le y \\le H$ 的面上，牵引力指定为 $\\bar{\\mathbf{t}}(y)=t_{0}\\,\\mathbf{e}_{x}$，而在所有其他面（$x=0$、$y=0$ 和 $y=H$ 处）上为零。因此，$\\mathbf{F}$ 和 $\\mathbf{M}_{O}$ 的积分只在 $x=L$ 的面上有非零贡献。让我们将此曲面表示为 $\\Gamma_{L}$。\n\n为了计算合力，我们在 $\\Gamma_L$ 上对牵引力进行积分。该面上的微元面积为 $dS = B \\, dy$。\n$$ \\mathbf{F} = \\int_{\\Gamma_L} \\bar{\\mathbf{t}} \\, dS = \\int_{0}^{H} (t_{0} \\mathbf{e}_{x}) (B \\, dy) $$\n由于 $t_{0}$、$B$ 和 $\\mathbf{e}_x$ 相对于积分变量 $y$ 是常数，我们有：\n$$ \\mathbf{F} = t_{0} B \\mathbf{e}_{x} \\int_{0}^{H} dy = t_{0} B H \\mathbf{e}_{x} $$\n因此，力矢量 $\\mathbf{F} = F_x \\mathbf{e}_x + F_y \\mathbf{e}_y + F_z \\mathbf{e}_z$ 的分量为：\n$F_{x} = t_{0} B H$\n$F_{y} = 0$\n$F_{z} = 0$\n\n为了计算绕原点的合力矩，我们必须首先定义曲面 $\\Gamma_L$ 上任意一点的位矢 $\\mathbf{r}$。此曲面上一点的坐标为 $(L, y, z')$，其中 $0 \\le y \\le H$ 且 $-B/2 \\le z' \\le B/2$。由于问题的平面性质，我们考虑中平面 $z'=0$ 处的几何形状。因此，位矢为：\n$$ \\mathbf{r}(y) = L\\mathbf{e}_{x} + y\\mathbf{e}_{y} $$\n那么力矩积分为：\n$$ \\mathbf{M}_{O} = \\int_{\\Gamma_L} \\mathbf{r} \\times \\bar{\\mathbf{t}} \\, dS = \\int_{0}^{H} (L\\mathbf{e}_{x} + y\\mathbf{e}_{y}) \\times (t_{0} \\mathbf{e}_{x}) (B \\, dy) $$\n我们进行叉积运算：\n$$ (L\\mathbf{e}_{x} + y\\mathbf{e}_{y}) \\times (t_{0} \\mathbf{e}_{x}) = L t_{0} (\\mathbf{e}_{x} \\times \\mathbf{e}_{x}) + y t_{0} (\\mathbf{e}_{y} \\times \\mathbf{e}_{x}) $$\n使用恒等式 $\\mathbf{e}_{x} \\times \\mathbf{e}_{x} = \\mathbf{0}$ 和 $\\mathbf{e}_{y} \\times \\mathbf{e}_{x} = -\\mathbf{e}_{z}$，表达式简化为：\n$$ -y t_{0} \\mathbf{e}_{z} $$\n将此代回力矩积分：\n$$ \\mathbf{M}_{O} = \\int_{0}^{H} (-y t_{0} \\mathbf{e}_{z}) (B \\, dy) = -t_{0} B \\mathbf{e}_{z} \\int_{0}^{H} y \\, dy $$\n计算 $y$ 的积分：\n$$ \\int_{0}^{H} y \\, dy = \\left[ \\frac{y^2}{2} \\right]_{0}^{H} = \\frac{H^2}{2} $$\n因此，力矩矢量为：\n$$ \\mathbf{M}_{O} = -t_{0} B \\frac{H^2}{2} \\mathbf{e}_{z} $$\n问题要求力矩矢量 $\\mathbf{M}_O$ 的标量分量 $M_z$。\n$M_z = - \\frac{1}{2} t_{0} B H^2$。\n\n现在，我们代入给定的数值：\n$L = 1.2$\n$H = 0.8$\n$B = 0.02$\n$t_{0} = 5.0 \\times 10^{6}$\n\n计算 $F_x$：\n$$ F_{x} = t_{0} B H = (5.0 \\times 10^{6}) \\times (0.02) \\times (0.8) $$\n$$ F_{x} = (5.0 \\times 10^{6}) \\times (0.016) = 80000 $$\n力分量为 $F_x = 80000 \\ \\mathrm{N}$。\n力分量 $F_y$ 为 $0 \\ \\mathrm{N}$。\n\n计算 $M_z$：\n$$ M_z = - \\frac{1}{2} t_{0} B H^2 = - \\frac{1}{2} \\times (5.0 \\times 10^{6}) \\times (0.02) \\times (0.8)^{2} $$\n$$ M_z = - \\frac{1}{2} \\times (5.0 \\times 10^{6}) \\times (0.02) \\times (0.64) $$\n$$ M_z = - (5.0 \\times 10^{6}) \\times (0.01) \\times (0.64) $$\n$$ M_z = - (5.0 \\times 10^{4}) \\times (0.64) = -32000 $$\n力矩分量为 $M_z = -32000 \\ \\mathrm{N \\cdot m}$。\n\n最终结果是行矩阵 $(F_x, F_y, M_z)$。\n$$ (80000, 0, -32000) $$", "answer": "$$\n\\boxed{\\begin{pmatrix} 80000  0  -32000 \\end{pmatrix}}\n$$", "id": "2879066"}, {"introduction": "与定义外力的牵引力边界条件不同，位移边界条件直接约束物体的几何变形。本问题 [@problem_id:2879033] 完整地展示了求解一个典型一维弹性问题的全过程，从建立控制微分方程到应用位移边界条件以获得唯一的位移场。它清晰地阐明了这些条件如何通过确定积分常数来确保问题解的唯一性，这是良定边值问题的核心要求。", "problem": "一根长度为 $L$ 的直棱柱杆沿轴向占据区间 $x \\in [0,L]$。该杆具有恒定的横截面积 $A$ 和杨氏模量 $E$，因此 $EA$ 是一个常数。适用小应变线性弹性理论。一个均布的单位体积体力沿轴向作用，其大小为 $b(x)=\\beta$，其中 $\\beta$ 是一个常数。该杆两端受到本质（位移）边界条件约束：$u(0)=0$ 和 $u(L)=\\delta$，其中 $u(x)$ 是轴向位移场，$\\delta$ 是一个给定的常数。\n\n从三维静态线动量平衡以及适当的运动学和本构关系出发，将问题简化为一维强形式，并求解在 $[0,L]$ 上的轴向位移场 $u(x)$。明确验证所得的 $u(x)$ 满足给定的位移边界条件。可以假设平面横截面在变形后仍保持为平面，并且每个截面上的应力是均匀的。\n\n仅报告位移场 $u(x)$ 的最终闭式解析表达式。不需要进行数值计算或四舍五-入。最终表达式中不包含单位。", "solution": "问题陈述经评估有效。这是一个适定的一维线性弹性问题，没有科学或逻辑上的缺陷，并为获得唯一解提供了所有必要信息。\n\n该问题要求从三维静态线动量平衡推导出一维控制方程。在静态条件下，没有加速度，线动量平衡表示为：\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0} $$\n其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\mathbf{b}$ 是单位体积的体力矢量。\n\n设杆的轴向沿 $x$ 轴。体力被给定为轴向的均匀场，因此 $\\mathbf{b} = (\\beta, 0, 0)$，其中 $\\beta$ 是一个常数。平面横截面保持平面以及在位置 $x$ 的任何给定横截面上的应力是均匀的这两个假设，将应力状态简化为单轴应力状态。应力张量中唯一的非零分量是轴向正应力 $\\sigma_{xx}$，它仅取决于轴向坐标 $x$。我们将其记为 $\\sigma_x(x)$。所有其他应力分量均为零：$\\sigma_{yy} = \\sigma_{zz} = \\sigma_{xy} = \\sigma_{xz} = \\sigma_{yz} = 0$。\n\n在笛卡尔坐标系中，应力张量的散度 $\\nabla \\cdot \\boldsymbol{\\sigma}$ 展开为关于每个分量 $i \\in \\{1, 2, 3\\}$ 的三个方程：\n$$ \\frac{\\partial \\sigma_{ix}}{\\partial x} + \\frac{\\partial \\sigma_{iy}}{\\partial y} + \\frac{\\partial \\sigma_{iz}}{\\partial z} + b_i = 0 $$\n对于 $x$ 方向 ($i=1$)：\n$$ \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} + \\frac{\\partial \\sigma_{xz}}{\\partial z} + b_x = 0 $$\n代入假定的应力状态和体力，该式简化为：\n$$ \\frac{d\\sigma_x(x)}{dx} + \\beta = 0 $$\n对于 $y$ 和 $z$ 方向，方程恒满足（$0=0$）。因此，三维理论正确地简化为关于轴向应力的单个微分方程。\n\n接下来，我们引入运动学关系和本构关系。对于小应变，轴向应变 $\\epsilon_x$ 与轴向位移场 $u(x)$ 的关系为：\n$$ \\epsilon_x = \\frac{du}{dx} $$\n材料行为是线性弹性的（胡克定律），通过杨氏模量 $E$ 将应力与应变联系起来：\n$$ \\sigma_x = E \\epsilon_x $$\n结合这两个关系，我们用位移来表示应力：\n$$ \\sigma_x = E \\frac{du}{dx} $$\n将 $\\sigma_x$ 的这个表达式代入一维平衡方程，得到关于位移 $u(x)$ 的控制常微分方程（ODE）：\n$$ \\frac{d}{dx}\\left(E \\frac{du}{dx}\\right) + \\beta = 0 $$\n因为杨氏模量 $E$ 是常数，方程变为：\n$$ E \\frac{d^2u}{dx^2} + \\beta = 0 $$\n$$ \\frac{d^2u}{dx^2} = -\\frac{\\beta}{E} $$\n这是表示该边值问题强形式的二阶常微分方程。我们通过对 $x$ 积分两次来求解此方程。第一次积分得到位移的梯度：\n$$ \\frac{du}{dx} = \\int \\left(-\\frac{\\beta}{E}\\right) dx = -\\frac{\\beta}{E}x + C_1 $$\n其中 $C_1$ 是第一个积分常数。第二次积分得到位移场 $u(x)$ 的通解：\n$$ u(x) = \\int \\left(-\\frac{\\beta}{E}x + C_1\\right) dx = -\\frac{\\beta}{2E}x^2 + C_1 x + C_2 $$\n其中 $C_2$ 是第二个积分常数。\n\n常数 $C_1$ 和 $C_2$ 通过应用给定的本质（位移）边界条件来确定：$u(0)=0$ 和 $u(L)=\\delta$。\n\n在 $x=0$ 处应用第一个边界条件：\n$$ u(0) = -\\frac{\\beta}{2E}(0)^2 + C_1(0) + C_2 = 0 $$\n这立即得出 $C_2=0$。解简化为：\n$$ u(x) = -\\frac{\\beta}{2E}x^2 + C_1 x $$\n在 $x=L$ 处应用第二个边界条件：\n$$ u(L) = -\\frac{\\beta}{2E}L^2 + C_1 L = \\delta $$\n我们求解这个代数方程以得到 $C_1$：\n$$ C_1 L = \\delta + \\frac{\\beta L^2}{2E} $$\n$$ C_1 = \\frac{\\delta}{L} + \\frac{\\beta L}{2E} $$\n将 $C_1$ 和 $C_2$ 的表达式代回 $u(x)$ 的通解，得到最终的特解：\n$$ u(x) = -\\frac{\\beta}{2E}x^2 + \\left(\\frac{\\delta}{L} + \\frac{\\beta L}{2E}\\right)x $$\n为了更好地进行物理诠释，可以通过将与边界位移相关的项和与体力相关的项分组来重新整理此表达式：\n$$ u(x) = \\frac{\\delta x}{L} + \\frac{\\beta L x}{2E} - \\frac{\\beta x^2}{2E} $$\n$$ u(x) = \\frac{\\delta x}{L} + \\frac{\\beta x}{2E}(L - x) $$\n第一项 $\\frac{\\delta x}{L}$ 表示没有体力情况下的线性位移场。第二项 $\\frac{\\beta x}{2E}(L-x)$ 是由均布体力引起的附加抛物线位移分布，该位移在两端 $x=0$ 和 $x=L$ 处为零。\n\n最后，我们明确验证该解满足给定的边界条件。\n对于 $x=0$：\n$$ u(0) = \\frac{\\delta (0)}{L} + \\frac{\\beta (0)}{2E}(L - 0) = 0 + 0 = 0 $$\n条件 $u(0)=0$ 得到满足。\n对于 $x=L$：\n$$ u(L) = \\frac{\\delta (L)}{L} + \\frac{\\beta (L)}{2E}(L - L) = \\delta + \\frac{\\beta L}{2E}(0) = \\delta $$\n条件 $u(L)=\\delta$ 得到满足。推导出的表达式是正确的。", "answer": "$$\n\\boxed{\\frac{\\delta x}{L} + \\frac{\\beta x}{2E}(L - x)}\n$$", "id": "2879033"}, {"introduction": "许多现实世界中的力学问题过于复杂，无法求得解析解，必须依赖于数值方法。这项高级练习 [@problem_id:2879005] 将理论与现代计算实践相结合，要求你在有限差分程序中实现位移和牵引力边界条件。通过数值验证著名的贝蒂(Betti)互易定理，你将更深刻地体会到理论原理在计算力学中的体现，以及正确施加边界数据的关键作用。", "problem": "考虑一个占据矩形区域 $\\Omega = [0,L]\\times[0,H]$、平面外单位厚度的均匀、各向同性、线弹性体中的反平面剪切问题。令 $w(x,y)$ 表示平面外位移，剪切模量为常数 $\\mu0$。在没有体力的情况下，$w$ 在 $\\Omega$ 中满足平衡方程 $\\nabla\\cdot(\\mu\\nabla w)=0$。设边界分解为 $\\partial\\Omega=\\Gamma_u\\cup\\Gamma_t$，其中 $\\Gamma_u$ 表示位移（狄利克雷）边界，$\\Gamma_t$ 表示面力（诺伊曼）边界。对于此问题，取 $\\Gamma_u=\\{(x,0):0\\le x\\le L\\}\\cup\\{(0,y):0\\le y\\le H\\}\\cup\\{(L,y):0\\le y\\le H\\}$ 以及 $\\Gamma_t=\\{(x,H):0\\le x\\le L\\}$。在 $\\Gamma_u$ 上，施加 $w=0$。在 $\\Gamma_t$ 上，施加边界面力条件 $\\mu\\,\\partial w/\\partial n=\\bar t(x)$，其中 $\\partial/\\partial n$ 是外法向导数，面力 $\\bar t(x)$ 仅作用于 $\\Gamma_t$。考虑 $2$ 种不同的载荷工况 $k\\in\\{1,2\\}$，在 $\\Gamma_t$ 上施加面力 $\\bar t^{(k)}(x)$，产生解 $w^{(k)}(x,y)$。\n\n您的任务是通过计算以下两个边界功泛函来数值验证互易性：\n$$\nI_{12}=\\int_{\\Gamma_t}\\bar t^{(1)}(x)\\,w^{(2)}(x,H)\\,da,\\qquad\nI_{21}=\\int_{\\Gamma_t}\\bar t^{(2)}(x)\\,w^{(1)}(x,H)\\,da,\n$$\n并对几个测试用例比较 $I_{12}$ 和 $I_{21}$。对于反平面剪切，面力和位移是 $\\Gamma_t$ 上的标量场，在顶边上 $da=dx$。所有答案必须以焦耳每单位厚度表示，即以 $\\mathrm{N\\cdot m}$ 每单位厚度表示，并报告为十进制数。\n\n您必须构建一个一致的数值近似，该近似从控制方程 $\\nabla\\cdot(\\mu\\nabla w)=0$ 和指定的边界条件出发，不引入任何辅助的简化公式。使用一个沿 $x$ 方向有 $N_x$ 个点、沿 $y$ 方向有 $N_y$ 个点的均匀笛卡尔网格对 $\\Omega$ 进行离散化，其中 $N_x=N_y=101$，间距为 $\\Delta x=L/(N_x-1)$ 和 $\\Delta y=H/(N_y-1)$。在 $\\Gamma_u$ 上强施加狄利克雷边界条件 $w=0$，并通过与内部拉普拉斯算子（对于常数 $\\mu$）的五点有限差分离散兼容的一阶一致的虚点处理方法，在 $\\Gamma_t$ 上施加诺伊曼面力。在为每个测试用例求解 $w^{(1)}$ 和 $w^{(2)}$ 后，使用与施加面力时相同的虚点关系，一致地重构 $\\Gamma_t$ 上的位移迹，并使用沿 $\\Gamma_t$ 的复合梯形法则来近似边界积分 $I_{12}$ 和 $I_{21}$。\n\n测试套件。使用以下三组参数集，每组定义 $(L,H,\\mu,\\bar t^{(1)}(x),\\bar t^{(2)}(x))$：\n\n-   用例 1：$L=1\\,\\mathrm{m}$，$H=0.5\\,\\mathrm{m}$，$\\mu=30\\times 10^{9}\\,\\mathrm{Pa}$，$\\bar t^{(1)}(x)=q_0\\sin\\!\\big(\\pi x/L\\big)$，$\\bar t^{(2)}(x)=q_0\\,(x/L)$，其中 $q_0=1\\times 10^{6}\\,\\mathrm{Pa}$。\n\n-   用例 2：$L=1\\,\\mathrm{m}$，$H=0.25\\,\\mathrm{m}$，$\\mu=50\\times 10^{9}\\,\\mathrm{Pa}$，$\\bar t^{(1)}(x)=q_0$ (常数)，$\\bar t^{(2)}(x)=q_0\\cos\\!\\big(2\\pi x/L\\big)$，其中 $q_0=2\\times 10^{6}\\,\\mathrm{Pa}$。\n\n-   用例 3：$L=1\\,\\mathrm{m}$，$H=1\\,\\mathrm{m}$，$\\mu=10\\times 10^{9}\\,\\mathrm{Pa}$，$\\bar t^{(1)}(x)=q_0\\,(x/L)\\,(1-x/L)$，$\\bar t^{(2)}(x)=q_0\\sin\\!\\big(3\\pi x/L\\big)$，其中 $q_0=1\\times 10^{6}\\,\\mathrm{Pa}$。\n\n对于每个用例，按所述计算 $I_{12}$ 和 $I_{21}$，然后报告绝对差异 $\\Delta=\\lvert I_{12}-I_{21}\\rvert$。\n\n最终输出格式。您的程序应生成单行输出，其中包含三个测试用例的结果，结果为方括号括起来的逗号分隔列表，顺序与上面列出的用例相同，每个数字以科学记数法打印，并保留 $10$ 位有效数字（例如 $[1.2345678900e{-}03,5.0000000000e{+}00,7.8900000000e{-}01]$）。这些数字分别代表用例 1、2 和 3 的绝对差异 $\\Delta$，单位为 $\\mathrm{J}$ 每单位厚度（即 $\\mathrm{N\\cdot m}$ 每单位厚度）。", "solution": "用户要求对矩形域上的反平面剪切问题进行互易定理的数值验证。该问题需要针对两种不同的载荷工况求解控制偏微分方程（PDE），然后计算类功边界积分以检验其相等性。该问题定义明确，科学上合理，并包含了进行数值求解所需的所有参数。我们将继续推导和实现指定的数值方法。\n\n物理问题是占据区域 $\\Omega = [0,L]\\times[0,H]$ 的线弹性体的反平面剪切。对于恒定的剪切模量 $\\mu  0$ 且在没有体力的情况下，平面外位移 $w(x,y)$ 由平衡方程控制，该方程简化为拉普拉斯方程：\n$$\n\\nabla^2 w(x,y) = \\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2} = 0\n$$\n边界条件是混合型的。在矩形的三个边上，施加零位移（狄利克雷）条件：\n$$\nw(x,0) = 0 \\quad \\text{for } 0 \\le x \\le L\n$$\n$$\nw(0,y) = 0 \\quad \\text{for } 0 \\le y \\le H\n$$\n$$\nw(L,y) = 0 \\quad \\text{for } 0 \\le y \\le H\n$$\n在顶边上，指定了面力（诺伊曼）边界条件：\n$$\n\\mu \\frac{\\partial w}{\\partial n} = \\mu \\frac{\\partial w}{\\partial y} = \\bar t(x) \\quad \\text{for } y=H, 0 \\le x \\le L\n$$\n其中 $\\bar t(x)$ 是施加的面力。\n\n我们使用一个在 $x$ 方向有 $N_x=101$ 个点、在 $y$ 方向有 $N_y=101$ 个点的均匀笛卡尔网格来离散化区域 $\\Omega$。网格点为 $(x_i, y_j)$，其中 $x_i = i \\Delta x$（$i=0, ..., N_x-1$）和 $y_j = j \\Delta y$（$j=0, ..., N_y-1$）。网格间距为 $\\Delta x = L/(N_x-1)$ 和 $\\Delta y = H/(N_y-1)$。令 $w_{i,j}$ 为 $w(x_i, y_j)$ 的数值近似。\n\n在内部点 $(x_i, y_j)$，拉普拉斯算子使用标准的五点中心差分格式进行近似：\n$$\n\\frac{w_{i+1,j} - 2w_{i,j} + w_{i-1,j}}{(\\Delta x)^2} + \\frac{w_{i,j+1} - 2w_{i,j} + w_{i,j-1}}{(\\Delta y)^2} = 0\n$$\n未知位移集合为 $w_{i,j}$，其中 $i \\in [1, N_x-2]$ 且 $j \\in [1, N_y-2]$。通过将边界上的值设为零并且不将它们作为未知数，来强施加 $\\Gamma_u$ 上的狄利克雷边界条件 $w=0$。\n\n对于顶部边界 $y=H$（网格索引为 $j=N_y-1$）上的诺伊曼条件，我们按要求使用一阶精度方法。我们为紧邻顶部边界下方的一行节点（即 $j=N_y-2$）写出有限差分方程。对于这样一个点 $(i, N_y-2)$，其差分格式涉及来自顶部边界的值 $w_{i, N_y-1}$。我们使用诺伊曼条件的一阶精度后向有限差分近似来消去这一项：\n$$\n\\mu \\frac{w_{i,N_y-1} - w_{i,N_y-2}}{\\Delta y} = \\bar t(x_i)\n$$\n这给出了一个用于在主系统求解后进行“重构”的顶部边界位移表达式：\n$$\nw_{i,N_y-1} = w_{i,N_y-2} + \\frac{\\Delta y}{\\mu} \\bar t(x_i)\n$$\n将此式代入点 $(i, N_y-2)$ 处的标准差分格式方程，得到一个针对最顶层未知数的修正方程：\n$$\n\\frac{w_{i+1,N_y-2} - 2w_{i,N_y-2} + w_{i-1,N_y-2}}{(\\Delta x)^2} + \\frac{(w_{i,N_y-2} + \\frac{\\Delta y}{\\mu} \\bar t(x_i)) - 2w_{i,N_y-2} + w_{i,N_y-3}}{(\\Delta y)^2} = 0\n$$\n整理各项，我们得到：\n$$\n\\frac{1}{(\\Delta x)^2}(w_{i+1,N_y-2} + w_{i-1,N_y-2}) + \\frac{1}{(\\Delta y)^2}w_{i,N_y-3} - \\left(\\frac{2}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)w_{i,N_y-2} = -\\frac{\\bar t(x_i)}{\\mu \\Delta y}\n$$\n这个过程产生一个形如 $A\\mathbf{w}=\\mathbf{b}$ 的 $(N_x-2) \\times (N_y-2)$ 线性代数方程组，其中 $\\mathbf{w}$ 是未知位移 $w_{i,j}$ 的向量。矩阵 $A$ 是稀疏的，由几何形状和离散格式决定，而向量 $\\mathbf{b}$ 包含来自诺伊曼边界条件的贡献。\n\n为了验证互易性，我们对两种面力分布 $\\bar t^{(1)}(x)$ 和 $\\bar t^{(2)}(x)$ 求解这个系统，以获得相应的位移场 $w^{(1)}(x,y)$ 和 $w^{(2)}(x,y)$。在求解出内部位移 $w^{(k)}_{i,j}$（对于 $j=1,...,N_y-2$）之后，我们使用从后向差分导出的关系来重构顶部边界上的位移 $w^{(k)}_{i, N_y-1}$。然后使用复合梯形法则计算边界功泛函：\n$$\nI_{12}=\\int_{0}^{L}\\bar t^{(1)}(x)\\,w^{(2)}(x,H)\\,dx \\approx \\sum_{i=0}^{N_x-2} \\frac{\\bar t^{(1)}_i w^{(2)}_{i,N_y-1} + \\bar t^{(1)}_{i+1} w^{(2)}_{i+1,N_y-1}}{2} \\Delta x\n$$\n$$\nI_{21}=\\int_{0}^{L}\\bar t^{(2)}(x)\\,w^{(1)}(x,H)\\,dx \\approx \\sum_{i=0}^{N_x-2} \\frac{\\bar t^{(2)}_i w^{(1)}_{i,N_y-1} + \\bar t^{(2)}_{i+1} w^{(1)}_{i+1,N_y-1}}{2} \\Delta x\n$$\nBetti 互易定理指出，对于精确解，$I_{12}=I_{21}$。由于离散误差，数值结果会显示出微小的差异。最后一步是为每个给定的测试用例计算这个绝对差异 $\\Delta = |I_{12}-I_{21}|$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'L': 1.0, 'H': 0.5, 'mu': 30e9, 'q0': 1e6,\n         't1_func': lambda x, L, q0: q0 * np.sin(np.pi * x / L),\n         't2_func': lambda x, L, q0: q0 * (x / L)},\n        # Case 2\n        {'L': 1.0, 'H': 0.25, 'mu': 50e9, 'q0': 2e6,\n         't1_func': lambda x, L, q0: q0 * np.ones_like(x),\n         't2_func': lambda x, L, q0: q0 * np.cos(2 * np.pi * x / L)},\n        # Case 3\n        {'L': 1.0, 'H': 1.0, 'mu': 10e9, 'q0': 1e6,\n         't1_func': lambda x, L, q0: q0 * (x / L) * (1 - x / L),\n         't2_func': lambda x, L, q0: q0 * np.sin(3 * np.pi * x / L)},\n    ]\n\n    results = []\n    for case in test_cases:\n        discrepancy = compute_discrepancy(case)\n        results.append(discrepancy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\ndef compute_discrepancy(case_params):\n    \"\"\"\n    Solves the antiplane shear problem and computes the reciprocity discrepancy.\n    \"\"\"\n    L = case_params['L']\n    H = case_params['H']\n    mu = case_params['mu']\n    q0 = case_params['q0']\n    t1_func = case_params['t1_func']\n    t2_func = case_params['t2_func']\n\n    # Grid parameters\n    Nx = 101\n    Ny = 101\n    dx = L / (Nx - 1)\n    dy = H / (Ny - 1)\n    \n    x_coords = np.linspace(0, L, Nx)\n\n    # The unknowns are w_{i,j} for i in [1, Nx-2] and j in [1, Ny-2].\n    num_unknowns_x = Nx - 2\n    num_unknowns_y = Ny - 2\n    M = num_unknowns_x * num_unknowns_y\n\n    Cx = 1 / dx**2\n    Cy = 1 / dy**2\n\n    # Assemble the sparse matrix A, which is the same for both load cases.\n    # We use a column-major ordering for the unknowns: k = (i-1)*(num_y) + (j-1)\n    A = lil_matrix((M, M))\n    \n    for i in range(1, Nx - 1): # Physical x-index from 1 to Nx-2\n        for j in range(1, Ny - 1): # Physical y-index from 1 to Ny-2\n            if j > num_unknowns_y:\n                continue\n                \n            # Map (i,j) to linear index k\n            k = (i - 1) * num_unknowns_y + (j - 1)\n\n            # Terms related to x-derivatives\n            if i > 1:\n                A[k, k - num_unknowns_y] = Cx  # w_{i-1,j}\n            if i  Nx - 2:\n                A[k, k + num_unknowns_y] = Cx  # w_{i+1,j}\n            \n            # Terms related to y-derivatives\n            if j > 1:\n                A[k, k - 1] = Cy # w_{i,j-1}\n            \n            if j  num_unknowns_y: # (j  Ny-2) Standard interior point row\n                A[k, k] = -2 * (Cx + Cy)\n                A[k, k + 1] = Cy # w_{i,j+1}\n            else: # (j == Ny-2) Top row of unknowns, modified for Neumann BC\n                A[k, k] = -2 * Cx - Cy\n\n    # Convert A to CSR format for efficient solving\n    A_csr = csr_matrix(A)\n\n    def solve_for_traction(t_func):\n        # Assemble the RHS vector b\n        b = np.zeros(M)\n        t_values_on_grid = t_func(x_coords, L, q0)\n        \n        for i in range(1, Nx - 1): # Iterate over internal x-nodes\n            k = (i - 1) * num_unknowns_y + (num_unknowns_y - 1)\n            b[k] = -t_values_on_grid[i] / (mu * dy)\n            \n        # Solve the linear system Au = b\n        w_internal_flat = spsolve(A_csr, b)\n        \n        # Reshape solution to 2D grid based on column-major ordering\n        # Transpose to get (j,i) indexing convention\n        w_internal = w_internal_flat.reshape((num_unknowns_x, num_unknowns_y)).T\n\n        # Reconstruct displacement on the top boundary (y=H, j=Ny-1)\n        w_on_H = np.zeros(Nx) # w(x_i, H)\n\n        # Values w_{i, Ny-2} are the top row of the solved system.\n        w_at_j_Ny_minus_2 = w_internal[-1, :]\n        \n        # Reconstruct using the first-order backward difference relation\n        # w_{i, Ny-1} = w_{i, Ny-2} + (dy/mu) * t_i\n        w_on_H[1:Nx-1] = w_at_j_Ny_minus_2 + (dy / mu) * t_values_on_grid[1:Nx-1]\n        \n        return w_on_H\n\n    # Solve for both load cases to get displacements on the top boundary\n    wH_1 = solve_for_traction(t1_func)\n    wH_2 = solve_for_traction(t2_func)\n    \n    # Get traction values on the grid for integration\n    t1_grid = t1_func(x_coords, L, q0)\n    t2_grid = t2_func(x_coords, L, q0)\n    \n    # Compute the work-like integrals using the composite trapezoidal rule\n    I12 = np.trapz(t1_grid * wH_2, x_coords)\n    I21 = np.trapz(t2_grid * wH_1, x_coords)\n    \n    # Compute the absolute discrepancy\n    discrepancy = np.abs(I12 - I21)\n    \n    return discrepancy\n\nsolve()\n```", "id": "2879005"}]}