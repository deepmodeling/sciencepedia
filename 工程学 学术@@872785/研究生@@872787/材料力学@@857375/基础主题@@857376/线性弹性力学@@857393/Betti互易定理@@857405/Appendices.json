{"hands_on_practices": [{"introduction": "为牢固掌握贝蒂互易定理，我们从一个清晰具体的实例出发进行直接验证。本练习 [@problem_id:2618449] 建立了一个离散弹簧系统模型，让您能从第一性原理构建其刚度矩阵并观察其对称性。通过计算系统在两种不同载荷情况下的响应，您将直接证实一组力在另一组力引起的位移上所做的功与反之所做的功相等，即 $(P^{(1)})^T u^{(2)} = (P^{(2)})^T u^{(1)}$，从而加深对该定理代数基础的理解。", "problem": "一个线性弹性离散结构在标记为 $1$、$2$ 和 $3$ 的节点处具有 $3$ 个标量平移自由度 (DOF)。每对节点都由一个线性胡克弹簧连接，并且每个节点还通过一个线性胡克弹簧连接到地。该弹簧网络是保守的，所有弹簧都遵循胡克定律，具有恒定的刚度。弹簧及其刚度如下：\n- 节点 $1$ 和节点 $2$ 之间：刚度 $k_{12} = 2$。\n- 节点 $2$ 和节点 $3$ 之间：刚度 $k_{23} = 3$。\n- 节点 $1$ 和节点 $3$ 之间：刚度 $k_{13} = 1$。\n- 节点 $1$ 到地：刚度 $k_{1g} = 4$。\n- 节点 $2$ 到地：刚度 $k_{2g} = 5$。\n- 节点 $3$ 到地：刚度 $k_{3g} = 6$。\n\n施加了两个独立的静态载荷工况，作为节点力向量：\n- 载荷工况 $1$：$P^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix}$。\n- 载荷工况 $2$：$P^{(2)} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix}$。\n\n任务：\n1. 使用平衡、协调和胡克定律，组装该 $3$ 自由度系统的全局刚度矩阵 $K$。通过引用线性弹簧的能量势，解释为什么 $K$ 是对称的。\n2. 对于每个载荷工况 $i \\in \\{1,2\\}$，求解线性系统 $K\\,u^{(i)} = P^{(i)}$ 以获得位移向量 $u^{(1)}$ 和 $u^{(2)}$。\n3. 计算标量积 $P^{(1)} \\cdot u^{(2)}$ 和 $P^{(2)} \\cdot u^{(1)}$，并基于 $K$ 的对称性产生的互易性来验证它们的相等性。\n4. 使用线性保守系统的基本能量论证，从功的角度解释这些标量积的物理意义，并简要地将其与总应变能和克拉佩龙定理（Clapeyron’s theorem）预测的形式联系起来。\n\n报告这两个标量积的共同值。将这个数值表示为一个精确的有理数。不要四舍五入。如果您选择追踪单位，请以焦耳（Joules）表示结果，但最终报告的值应为无单位的纯数。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了一个线性弹性结构分析中的标准问题，并提供了所有必要的数据。这是一个有效的问题。我们开始求解。\n\n该问题要求对一个线性弹性弹簧网络进行四部分分析。我们按顺序处理每个任务。\n\n首先，我们组装这个 $3$ 自由度 ($DOF$) 系统的全局刚度矩阵 $K$。自由度分别是节点 $1$、$2$ 和 $3$ 处的标量平移位移 $u_1$、$u_2$ 和 $u_3$。刚度矩阵的元素 $K_{ij}$ 是在自由度 $j$ 处维持单位位移（$u_j=1$）而所有其他位移为零（$u_k=0$ for $k \\ne j$）时，在自由度 $i$ 处所需的力。\n\n对角线元素 $K_{ii}$ 代表连接到节点 $i$ 的总刚度。这是所有连接到节点 $i$ 的弹簧刚度之和。\n$$K_{11} = k_{12} + k_{13} + k_{1g} = 2 + 1 + 4 = 7$$\n$$K_{22} = k_{12} + k_{23} + k_{2g} = 2 + 3 + 5 = 10$$\n$$K_{33} = k_{13} + k_{23} + k_{3g} = 1 + 3 + 6 = 10$$\n\n非对角线元素 $K_{ij}$（其中 $i \\ne j$）代表节点 $j$ 处的单位位移传递到节点 $i$ 的力。这个力等于连接这两个节点的弹簧刚度的负值。\n$$K_{12} = K_{21} = -k_{12} = -2$$\n$$K_{13} = K_{31} = -k_{13} = -1$$\n$$K_{23} = K_{32} = -k_{23} = -3$$\n\n将这些分量组合起来，得到全局刚度矩阵 $K$：\n$$K = \\begin{pmatrix} 7  -2  -1 \\\\ -2  10  -3 \\\\ -1  -3  10 \\end{pmatrix}$$\n\n刚度矩阵的对称性，$K = K^T$，是线性保守系统的一个基本性质。胡克弹簧系统是保守的，这意味着内力所做的功与路径无关，可以表示为一个标量势能函数——应变能 $U$ 的变化。该系统的总应变能是节点位移 $u = \\begin{pmatrix} u_1  u_2  u_3 \\end{pmatrix}^T$ 的二次函数：\n$$U(u) = \\frac{1}{2} k_{12} (u_1-u_2)^2 + \\frac{1}{2} k_{13} (u_1-u_3)^2 + \\frac{1}{2} k_{23} (u_2-u_3)^2 + \\frac{1}{2} k_{1g} u_1^2 + \\frac{1}{2} k_{2g} u_2^2 + \\frac{1}{2} k_{3g} u_3^2$$\n这可以写成矩阵形式 $U(u) = \\frac{1}{2} u^T K u$。节点力向量 $P$ 是应变能相对于位移的梯度：$P = \\nabla_u U = K u$。刚度矩阵的分量是应变能势的二阶偏导数：$K_{ij} = \\frac{\\partial^2 U}{\\partial u_i \\partial u_j}$。根据混合偏导数的相等性（克莱罗定理, Clairaut's theorem），如果 $U$ 是二次连续可微的（它确实是，因为它是一个二次多项式），那么 $\\frac{\\partial^2 U}{\\partial u_i \\partial u_j} = \\frac{\\partial^2 U}{\\partial u_j \\partial u_i}$，这意味着 $K_{ij} = K_{ji}$。因此，线性保守系统存在标量能量势保证了其刚度矩阵的对称性。\n\n其次，我们求解两种载荷工况 $P^{(1)}$ 和 $P^{(2)}$ 下的位移向量 $u^{(1)}$ 和 $u^{(2)}$。这需要求解线性系统 $K u^{(i)} = P^{(i)}$。我们求 $K$ 的逆矩阵。$K$ 的行列式为：\n$$\\det(K) = 7(10 \\cdot 10 - (-3)(-3)) - (-2)((-2)10 - (-3)(-1)) + (-1)((-2)(-3) - 10(-1))$$\n$$\\det(K) = 7(91) + 2(-23) -1(16) = 637 - 46 - 16 = 575$$\n$K$ 的伴随矩阵 $\\text{adj}(K)$ 是其代数余子矩阵的转置。对于对称矩阵，其代数余子矩阵也是对称的，因此 $\\text{adj}(K)$ 为：\n$$\\text{adj}(K) = \\begin{pmatrix} 100-9  -(-20-3)  6+10 \\\\ -(-20-3)  70-1  -(-21-2) \\\\ 6+10  -(-21-2)  70-4 \\end{pmatrix} = \\begin{pmatrix} 91  23  16 \\\\ 23  69  23 \\\\ 16  23  66 \\end{pmatrix}$$\n逆刚度矩阵，或称柔度矩阵，是 $K^{-1} = \\frac{1}{\\det(K)} \\text{adj}(K)$：\n$$K^{-1} = \\frac{1}{575} \\begin{pmatrix} 91  23  16 \\\\ 23  69  23 \\\\ 16  23  66 \\end{pmatrix}$$\n我们现在计算位移向量：\n$$u^{(1)} = K^{-1} P^{(1)} = \\frac{1}{575} \\begin{pmatrix} 91  23  16 \\\\ 23  69  23 \\\\ 16  23  66 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 91(1) + 16(2) \\\\ 23(1) + 23(2) \\\\ 16(1) + 66(2) \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 123 \\\\ 69 \\\\ 148 \\end{pmatrix}$$\n$$u^{(2)} = K^{-1} P^{(2)} = \\frac{1}{575} \\begin{pmatrix} 91  23  16 \\\\ 23  69  23 \\\\ 16  23  66 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 23(3) + 16(1) \\\\ 69(3) + 23(1) \\\\ 23(3) + 66(1) \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 69+16 \\\\ 207+23 \\\\ 69+66 \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 85 \\\\ 230 \\\\ 135 \\end{pmatrix}$$\n\n第三，我们计算标量积 $P^{(1)} \\cdot u^{(2)}$ 和 $P^{(2)} \\cdot u^{(1)}$。在矩阵表示法中，它们是 $(P^{(1)})^T u^{(2)}$ 和 $(P^{(2)})^T u^{(1)}$。\n$$(P^{(1)})^T u^{(2)} = \\begin{pmatrix} 1  0  2 \\end{pmatrix} \\frac{1}{575} \\begin{pmatrix} 85 \\\\ 230 \\\\ 135 \\end{pmatrix} = \\frac{1}{575} (1 \\cdot 85 + 0 \\cdot 230 + 2 \\cdot 135) = \\frac{85 + 270}{575} = \\frac{355}{575}$$\n$$(P^{(2)})^T u^{(1)} = \\begin{pmatrix} 0  3  1 \\end{pmatrix} \\frac{1}{575} \\begin{pmatrix} 123 \\\\ 69 \\\\ 148 \\end{pmatrix} = \\frac{1}{575} (0 \\cdot 123 + 3 \\cdot 69 + 1 \\cdot 148) = \\frac{207 + 148}{575} = \\frac{355}{575}$$\n相等性得到证实。我们通过将分子和分母除以它们的最大公约数来简化这个有理数。$355 = 5 \\times 71$ 且 $575 = 5 \\times 115 = 5 \\times 5 \\times 23$。公因数是 $5$。\n$$\\frac{355}{575} = \\frac{71}{115}$$\n这些标量积的相等性是贝蒂互易定理（Betti's reciprocal theorem）的直接体现。该定理指出，对于一个承受两组力系 $\\{P^{(1)}, u^{(1)}\\}$ 和 $\\{P^{(2)}, u^{(2)}\\}$ 的线性弹性体，第一组力系在第二组位移上所做的功等于第二组力系在第一组位移上所做的功。在数学上，$(P^{(1)})^T u^{(2)} = (P^{(2)})^T u^{(1)}$。证明如下：\n$$(P^{(1)})^T u^{(2)} = (K u^{(1)})^T u^{(2)} = (u^{(1)})^T K^T u^{(2)}$$\n$$(P^{(2)})^T u^{(1)} = (u^{(1)})^T P^{(2)} = (u^{(1)})^T K u^{(2)}$$\n由于我们已经确定 $K$ 是对称的 ($K^T=K$)，因此这两个表达式是相同的。\n\n第四，我们解释其物理意义。标量积 $P \\cdot u$ 代表外力 $P$ 通过位移 $u$ 对系统所做的功。因此，量 $(P^{(1)})^T u^{(2)}$ 和 $(P^{(2)})^T u^{(1)}$ 是互易功或“相互作用功”项。\n\n克拉佩龙定理（Clapeyron's theorem）指出，对于一个承受单一力系 $P$ 并产生位移 $u$ 的线性弹性系统，外力所做的功等于储存在物体中的应变能，且两者都等于最终力和最终位移标量积的一半：$W_{ext} = U = \\frac{1}{2} P \\cdot u$。因子 $\\frac{1}{2}$ 的出现是因为力是逐渐施加的，并且力-位移关系是线性的。\n如果我们考虑一个组合载荷 $P = P^{(1)} + P^{(2)}$，根据叠加原理，总位移为 $u = u^{(1)} + u^{(2)}$。总应变能为：\n$$U_{total} = \\frac{1}{2} (P^{(1)}+P^{(2)}) \\cdot (u^{(1)}+u^{(2)}) = \\frac{1}{2} P^{(1)}\\cdot u^{(1)} + \\frac{1}{2} P^{(2)}\\cdot u^{(2)} + \\frac{1}{2} (P^{(1)}\\cdot u^{(2)} + P^{(2)}\\cdot u^{(1)})$$\n对单个载荷工况使用克拉佩龙定理，$U_1 = \\frac{1}{2} P^{(1)}\\cdot u^{(1)}$ 和 $U_2 = \\frac{1}{2} P^{(2)}\\cdot u^{(2)}$，我们可以写出：\n$$U_{total} = U_1 + U_2 + P^{(1)} \\cdot u^{(2)}$$\n这里我们使用了互易性 $P^{(1)} \\cdot u^{(2)} = P^{(2)} \\cdot u^{(1)}$。因此，项 $P^{(1)} \\cdot u^{(2)}$ 代表相互作用能，即由于同时施加两组载荷而储存在系统中的额外应变能，该能量超出了分别施加载荷时能量的总和。\n\n这两个标量积的共同值即为所求的最终答案。", "answer": "$$\\boxed{\\frac{71}{115}}$$", "id": "2618449"}, {"introduction": "深刻理解任何物理定律都要求我们探索其适用边界。本练习 [@problem_id:2618432] 通过引入一种非保守的“随动荷载”，构建了一个贝蒂定理不再成立的情景。您将推导出系统的非对称切线刚度矩阵，并发现互易性被破坏，通过计算一个非零的“互易差值”来量化这一定理的失效，从而深刻体会保守系统假设在该定理中的关键作用。", "problem": "考虑一个二自由度平面离散弹性系统，该系统由一个通过沿笛卡尔坐标轴的两个线性正交弹簧连接到地面的单个节点组成。设广义位移向量为 $\\mathbf{u} = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}$，内弹性力由 $\\mathbf{f}_{\\text{int}}(\\mathbf{u}) = \\mathbf{K}_c \\mathbf{u}$ 给出，其中 $\\mathbf{K}_c = \\begin{pmatrix} k_x  0 \\\\ 0  k_y \\end{pmatrix}$，$k_x > 0$ 且 $k_y > 0$。除弹簧外，该节点还受到一个大小恒为 $P$ 的非保守随动力，其本构律定义为\n$$\n\\mathbf{f}_{\\text{fol}}(\\mathbf{u}) \\;=\\; P \\, \\frac{\\mathbf{R}\\,\\mathbf{u}}{\\|\\mathbf{u}\\|}, \\qquad \\mathbf{R} \\;=\\; \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix},\n$$\n因此 $\\mathbf{f}_{\\text{fol}}(\\mathbf{u})$ 始终与 $\\mathbf{u}$ 正交，且范数恒为 $P$。假设系统通过辅助恒载（这些辅助载荷的细节与增量分析无关）保持在预加载构型 $\\mathbf{u}_0 = \\begin{pmatrix} U \\\\ 0 \\end{pmatrix}$（其中 $U > 0$）。考虑围绕 $\\mathbf{u}_0$ 的、受虚功原理控制的微小准静态增量。\n\n任务：\n1) 从虚功原理和随动力的定义出发，推导在 $\\mathbf{u}_0$ 处的线性化切线算子，即\n$$\n\\mathbf{K}_t \\;=\\; \\left.\\frac{\\partial \\mathbf{f}_{\\text{int}}}{\\partial \\mathbf{u}}\\right|_{\\mathbf{u}_0} \\;-\\; \\left.\\frac{\\partial \\mathbf{f}_{\\text{fol}}}{\\partial \\mathbf{u}}\\right|_{\\mathbf{u}_0},\n$$\n并明確证明当 $P \\neq 0$ 时，$\\mathbf{K}_t$ 是非对称的。\n\n2) 使用推导出的 $\\mathbf{K}_t$，计算在 $\\mathbf{u}_0$ 处施加的两个独立的单位探查载荷下的增量位移：\n- 情况 A：$\\mathbf{p}^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，\n- 情况 B：$\\mathbf{p}^{(2)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，\n通过求解 $\\mathbf{K}_t \\mathbf{u}^{(i)} = \\mathbf{p}^{(i)}$，$i = 1,2$。\n\n3) 使用第2部分的结果，通过计算差值\n$$\n\\Delta \\;=\\; \\big(u_y^{(1)}\\big) \\;-\\; \\big(u_x^{(2)}\\big),\n$$\n来数值上验证Betti互易定理的失效。对于具有对称切线的保守系统，该差值将为零。使用以下参数值：\n- $k_x = 1000$ N/m,\n- $k_y = 800$ N/m,\n- $P = 300$ N,\n- $U = 0.24$ m.\n\n以 $\\text{m}/\\text{N}$ 为单位表示 $\\Delta$ 的最终值，并将您的答案四舍五入到四位有效数字。您的最终答案必须是一个实数。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   广义位移向量：$\\mathbf{u} = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}$。\n-   内弹性力：$\\mathbf{f}_{\\text{int}}(\\mathbf{u}) = \\mathbf{K}_c \\mathbf{u}$，其中 $\\mathbf{K}_c = \\begin{pmatrix} k_x  0 \\\\ 0  k_y \\end{pmatrix}$，$k_x > 0$ 且 $k_y > 0$。\n-   非保守随动力：$\\mathbf{f}_{\\text{fol}}(\\mathbf{u}) = P \\, \\frac{\\mathbf{R}\\,\\mathbf{u}}{\\|\\mathbf{u}\\|}$，其中 $\\mathbf{R} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$ 且大小恒为 $P > 0$。\n-   预加载构型：$\\mathbf{u}_0 = \\begin{pmatrix} U \\\\ 0 \\end{pmatrix}$，其中 $U > 0$。\n-   切线算子定义：$\\mathbf{K}_t = \\left.\\frac{\\partial \\mathbf{f}_{\\text{int}}}{\\partial \\mathbf{u}}\\right|_{\\mathbf{u}_0} - \\left.\\frac{\\partial \\mathbf{f}_{\\text{fol}}}{\\partial \\mathbf{u}}\\right|_{\\mathbf{u}_0}$。\n-   增量问题：$\\mathbf{K}_t \\mathbf{u}^{(i)} = \\mathbf{p}^{(i)}$，对于 $i = 1,2$。\n-   探查载荷：$\\mathbf{p}^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$\\mathbf{p}^{(2)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n-   互易性差值：$\\Delta = u_y^{(1)} - u_x^{(2)}$。\n-   数值参数：$k_x = 1000$ N/m，$k_y = 800$ N/m，$P = 300$ N，$U = 0.24$ m。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了非保守结构力学领域用于研究颤振等稳定性现象的典型模型。随动力的概念是公认的。涉及线性化和矩阵演算的数学公式是标准的。该问题是适定的，为确定唯一解提供了所有必要的定义、数据和约束。给定的参数值在物理上是现实的，并且量纲一致。问题陈述客观、精确，没有任何歧义或矛盾。\n\n**步骤3：结论与行动**\n问题有效。我们现在将进行完整求解。\n\n系统在施加载荷 $\\mathbf{p}_{\\text{appl}}$ 下的准静态平衡由虚功原理给出，从而得到力平衡方程 $\\mathbf{f}_{\\text{int}}(\\mathbf{u}) - \\mathbf{f}_{\\text{fol}}(\\mathbf{u}) = \\mathbf{p}_{\\text{appl}}$。我们考虑围绕平衡构型 $\\mathbf{u}_0$ 的载荷增量 $\\mathbf{p}$ 和位移增量 $\\Delta\\mathbf{u}$。线性化平衡方程得到 $\\mathbf{K}_t \\Delta\\mathbf{u} = \\mathbf{p}$，其中 $\\mathbf{K}_t$ 是问题中定义的切线刚度算子。我们现在推导这个算子。\n\n**任务1：推导切线算子 $\\mathbf{K}_t$**\n\n切线算子 $\\mathbf{K}_t$ 由两部分组成：来自内力的贡献和来自随动力的贡献。\n\n首先，我们求内力向量 $\\mathbf{f}_{\\text{int}}(\\mathbf{u}) = \\begin{pmatrix} k_x u_x \\\\ k_y u_y \\end{pmatrix}$ 的雅可比矩阵。\n$$\n\\frac{\\partial \\mathbf{f}_{\\text{int}}}{\\partial \\mathbf{u}} = \\begin{pmatrix} \\frac{\\partial}{\\partial u_x}(k_x u_x)  \\frac{\\partial}{\\partial u_y}(k_x u_x) \\\\ \\frac{\\partial}{\\partial u_x}(k_y u_y)  \\frac{\\partial}{\\partial u_y}(k_y u_y) \\end{pmatrix} = \\begin{pmatrix} k_x  0 \\\\ 0  k_y \\end{pmatrix} = \\mathbf{K}_c.\n$$\n该矩阵是常数，因此其在 $\\mathbf{u}_0$ 处的值就是 $\\mathbf{K}_c$。\n\n接下来，我们求随动力向量 $\\mathbf{f}_{\\text{fol}}(\\mathbf{u})$ 的雅可比矩阵。该力由以下公式给出：\n$$\n\\mathbf{f}_{\\text{fol}}(\\mathbf{u}) = P \\frac{\\mathbf{R} \\mathbf{u}}{\\|\\mathbf{u}\\|} = \\frac{P}{\\sqrt{u_x^2 + u_y^2}} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\frac{P}{\\sqrt{u_x^2 + u_y^2}} \\begin{pmatrix} u_y \\\\ -u_x \\end{pmatrix}.\n$$\n令分量为 $f_{\\text{fol},x} = P u_y (u_x^2 + u_y^2)^{-1/2}$ 和 $f_{\\text{fol},y} = -P u_x (u_x^2 + u_y^2)^{-1/2}$。我们计算偏导数：\n$$\n\\frac{\\partial f_{\\text{fol},x}}{\\partial u_x} = P u_y \\left(-\\frac{1}{2}\\right) (u_x^2 + u_y^2)^{-3/2} (2u_x) = \\frac{-P u_x u_y}{(u_x^2 + u_y^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_{\\text{fol},x}}{\\partial u_y} = P (u_x^2 + u_y^2)^{-1/2} + P u_y \\left(-\\frac{1}{2}\\right) (u_x^2 + u_y^2)^{-3/2} (2u_y) = \\frac{P(u_x^2 + u_y^2) - P u_y^2}{(u_x^2 + u_y^2)^{3/2}} = \\frac{P u_x^2}{(u_x^2 + u_y^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_{\\text{fol},y}}{\\partial u_x} = -P (u_x^2 + u_y^2)^{-1/2} - P u_x \\left(-\\frac{1}{2}\\right) (u_x^2 + u_y^2)^{-3/2} (2u_x) = \\frac{-P(u_x^2 + u_y^2) + P u_x^2}{(u_x^2 + u_y^2)^{3/2}} = \\frac{-P u_y^2}{(u_x^2 + u_y^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_{\\text{fol},y}}{\\partial u_y} = -P u_x \\left(-\\frac{1}{2}\\right) (u_x^2 + u_y^2)^{-3/2} (2u_y) = \\frac{P u_x u_y}{(u_x^2 + u_y^2)^{3/2}}\n$$\n现在，我们在预加载构型 $\\mathbf{u}_0 = \\begin{pmatrix} U \\\\ 0 \\end{pmatrix}$ 处计算这个雅可比矩阵：\n$$\n\\left.\\frac{\\partial \\mathbf{f}_{\\text{fol}}}{\\partial \\mathbf{u}}\\right|_{\\mathbf{u}_0} = \\begin{pmatrix} \\frac{-P U (0)}{(U^2)^{3/2}}  \\frac{P U^2}{(U^2)^{3/2}} \\\\ \\frac{-P (0)^2}{(U^2)^{3/2}}  \\frac{P U (0)}{(U^2)^{3/2}} \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{P U^2}{U^3} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  P/U \\\\ 0  0 \\end{pmatrix}.\n$$\n因此，切线算子 $\\mathbf{K}_t$ 为：\n$$\n\\mathbf{K}_t = \\left.\\frac{\\partial \\mathbf{f}_{\\text{int}}}{\\partial \\mathbf{u}}\\right|_{\\mathbf{u}_0} - \\left.\\frac{\\partial \\mathbf{f}_{\\text{fol}}}{\\partial \\mathbf{u}}\\right|_{\\mathbf{u}_0} = \\begin{pmatrix} k_x  0 \\\\ 0  k_y \\end{pmatrix} - \\begin{pmatrix} 0  P/U \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} k_x  -P/U \\\\ 0  k_y \\end{pmatrix}.\n$$\n为检查对称性，我们计算其转置：$\\mathbf{K}_t^T = \\begin{pmatrix} k_x  0 \\\\ -P/U  k_y \\end{pmatrix}$。\n算子 $\\mathbf{K}_t$ 是对称的当且仅当 $\\mathbf{K}_t = \\mathbf{K}_t^T$，这要求 $-P/U = 0$。由于 $U > 0$，这个条件仅在 $P=0$ 时满足。对于任何非零随动力 $P \\neq 0$，切线算子 $\\mathbf{K}_t$ 是非对称的。\n\n**任务2：增量位移的计算**\n\n我们必须针对两个指定的探查载荷求解线性系统 $\\mathbf{K}_t \\mathbf{u}^{(i)} = \\mathbf{p}^{(i)}$。需要求 $\\mathbf{K}_t$ 的逆矩阵。行列式为 $\\det(\\mathbf{K}_t) = k_x k_y$。由于 $k_x>0$ 且 $k_y>0$，行列式非零，逆矩阵存在：\n$$\n\\mathbf{K}_t^{-1} = \\frac{1}{k_x k_y} \\begin{pmatrix} k_y  P/U \\\\ 0  k_x \\end{pmatrix} = \\begin{pmatrix} 1/k_x  P/(U k_x k_y) \\\\ 0  1/k_y \\end{pmatrix}.\n$$\n对于情况A，探查载荷为 $\\mathbf{p}^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。产生的位移是：\n$$\n\\mathbf{u}^{(1)} = \\mathbf{K}_t^{-1} \\mathbf{p}^{(1)} = \\begin{pmatrix} 1/k_x  P/(U k_x k_y) \\\\ 0  1/k_y \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/k_x \\\\ 0 \\end{pmatrix}.\n$$\n所以，$u_x^{(1)} = 1/k_x$ 且 $u_y^{(1)} = 0$。\n\n对于情况B，探查载荷为 $\\mathbf{p}^{(2)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。产生的位移是：\n$$\n\\mathbf{u}^{(2)} = \\mathbf{K}_t^{-1} \\mathbf{p}^{(2)} = \\begin{pmatrix} 1/k_x  P/(U k_x k_y) \\\\ 0  1/k_y \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} P/(U k_x k_y) \\\\ 1/k_y \\end{pmatrix}.\n$$\n所以，$u_x^{(2)} = P/(U k_x k_y)$ 且 $u_y^{(2)} = 1/k_y$。\n\n**任务3：Betti互易定理失效的证明**\n\nBetti互易定理指出，对于一个线性弹性系统，第一组力在第二组位移上所做的功等于第二组力在第一组位移上所做的功。对于我们选择的单位探查载荷，这表示为 $(\\mathbf{p}^{(1)})^T \\mathbf{u}^{(2)} = (\\mathbf{p}^{(2)})^T \\mathbf{u}^{(1)}$，可简化为 $u_x^{(2)} = u_y^{(1)}$。\n\n互易性差值 $\\Delta$ 定义为这两个量之差：\n$$\n\\Delta = u_y^{(1)} - u_x^{(2)}.\n$$\n使用任务2的结果：\n$$\n\\Delta = 0 - \\frac{P}{U k_x k_y} = -\\frac{P}{U k_x k_y}.\n$$\n这个解析结果表明，只要 $P \\neq 0$，差值 $\\Delta$ 就非零，这证实了由于非保守系统的切线算子具有非对称性，Betti定理失效。\n\n我们现在代入给定的数值：\n- $k_x = 1000$ N/m\n- $k_y = 800$ N/m\n- $P = 300$ N\n- $U = 0.24$ m\n\n$$\n\\Delta = -\\frac{300}{(0.24) \\times (1000) \\times (800)} = -\\frac{300}{192000} = -\\frac{1}{640} \\text{ m/N}.\n$$\n将其转换为十进制值：\n$$\n\\Delta = -0.0015625 \\text{ m/N}.\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta \\approx -0.001563 \\text{ m/N}.\n$$\n用标准科学记数法表示为 $-1.563 \\times 10^{-3}$ m/N。", "answer": "$$\n\\boxed{-1.563 \\times 10^{-3}}\n$$", "id": "2618432"}, {"introduction": "贝蒂定理不仅具有理论上的优美性，在现代工程中更是一个强大的计算工具。本实践练习 [@problem_id:2868483] 将指导您实现“伴随法”，这是一种直接源于互易定理的高效技术。您将学习如何通过仅执行一次辅助分析，便可精确计算出复杂结构中某个特定位移分量，从而展示该定理在结构优化和灵敏度分析等应用中的巨大实用价值。", "problem": "给定您在代数层面表示为对称正定刚度矩阵和载荷向量的小型、静态、线性弹性模型。位移向量由线性系统 $K u = f$ 定义，其中 $K$ 是刚度矩阵，$f$ 是载荷向量，$u$ 是位移向量。您希望计算目标自由度（DOF）处的单个标量位移分量（由 $j$ 索引），而无需计算 $f$ 下的完整位移解。请使用由虚功原理和弹性应变能的对称性推导出的 Betti 互易定理，设计一个单次求解的伴随过程，该过程使用一次辅助求解，并在目标自由度上施加单位载荷。结构是线性的，在每次测试中材料是均匀且各向同性的，并且代数系统已经简化为自由自由度（所有本质边界条件均已施加）。刚度矩阵以牛顿/米为单位，载荷向量以牛顿为单位，因此所请求的位移必须以米为单位报告。\n\n您的任务是实现一个程序，对于每个测试案例，构造与目标自由度上的单位力相对应的辅助右端项，使用给定的刚度矩阵求解相关的辅助线性系统，然后利用给定的原始载荷向量，通过互易性计算目标自由度处的标量位移。结果以米为单位报告，四舍五入到六位小数。\n\n请使用以下测试套件，目标自由度使用从 $0$ 开始的索引：\n- 测试案例 1：\n  - $K = \\begin{bmatrix} 12  -3  0 \\\\ -3  10  -2 \\\\ 0  -2  5 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 100 \\\\ 50 \\end{bmatrix}$ (牛顿)\n  - $j = 2$\n- 测试案例 2：\n  - $K = \\begin{bmatrix} 8  -2 \\\\ -2  4 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 10 \\end{bmatrix}$ (牛顿)\n  - $j = 0$\n- 测试案例 3：\n  - $K = \\begin{bmatrix} 6  -2  0 \\\\ -2  5  -1 \\\\ 0  -1  3 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$ (牛顿)\n  - $j = 1$\n- 测试案例 4：\n  - $K = \\begin{bmatrix} 20  -5  0  0 \\\\ -5  15  -3  0 \\\\ 0  -3  12  -4 \\\\ 0  0  -4  9 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 0 \\\\ 100 \\\\ 0 \\end{bmatrix}$ (牛顿)\n  - $j = 2$\n\n算法约束：\n- 独立处理每个测试。\n- 对每个测试，使用给定的刚度矩阵和一个在自由度 $j$ 处施加单位力而在其他地方施加零力的辅助右端项，执行恰好一次辅助线性求解。\n- 使用辅助位移场和给定的原始载荷向量，通过互易性提取目标位移。\n- 以米为单位表示每个最终标量位移，四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来且无空格的逗号分隔列表，按测试案例 1 到 4 的顺序列出结果。\n- 每个条目必须是一个浮点数，小数点后恰好有六位数字（单位为米）。\n- 示例格式（仅作说明）：$[0.123456,1.000000,0.000000,2.500000]$。", "solution": "我们考虑在有限元方法（FEM）中一个静态、线性、小应变的弹性系统，该系统在施加本质边界条件后已简化为自由自由度（DOF）。设 $K \\in \\mathbb{R}^{n \\times n}$ 为全局对称正定刚度矩阵，$f \\in \\mathbb{R}^{n}$ 为外加载荷向量，$u \\in \\mathbb{R}^{n}$ 为位移向量，它们通过线性系统关联：\n$$\nK u = f.\n$$\n我们感兴趣的是目标自由度索引 $j \\in \\{0,1,\\dots,n-1\\}$ 处的单个标量位移分量 $u_j$，以米为单位表示。通过求解 $K u = f$ 进行直接计算是可能的，但如果只需要一个分量，则可能比必要时更为昂贵。Betti 互易定理（也称为 Maxwell–Betti 互易性）提供了一种通过单次辅助求解计算 $u_j$ 的方法。\n\n基本原理：\n- 虚功原理指出，对于任何运动学容许的虚位移 $\\delta u$，内虚功等于外虚功：\n$$\n\\delta W_{\\text{int}} = \\delta W_{\\text{ext}}.\n$$\n- 在线性弹性中，由于线性本构行为，内虚功在位移场中是双线性的，并与一个对称的应变能密度相关联。对于两个平衡状态 $(u^{(a)}, f^{(a)})$ 和 $(u^{(b)}, f^{(b)})$，它们具有相同的 $K$ 且 $K u^{(a)} = f^{(a)}$，$K u^{(b)} = f^{(b)}$，$K$ 的对称性意味着互易恒等式\n$$\n\\left(u^{(a)}\\right)^{\\!\\top} K u^{(b)} = \\left(u^{(b)}\\right)^{\\!\\top} K u^{(a)}.\n$$\n- 代入平衡条件 $K u^{(a)} = f^{(a)}$ 和 $K u^{(b)} = f^{(b)}$，得到 Maxwell–Betti 关系\n$$\n\\left(f^{(a)}\\right)^{\\!\\top} u^{(b)} = \\left(f^{(b)}\\right)^{\\!\\top} u^{(a)}.\n$$\n\n伴随构造：\n- 选择状态 $(a)$ 为原始载荷：$f^{(a)} = f$，其解为 $u^{(a)} = u$。\n- 选择状态 $(b)$ 为一个辅助（伴随）载荷，它在目标自由度 $j$ 处施加一个单位力，而在其他地方为零：\n$$\nf^{(b)} = e_j,\n$$\n其中 $e_j \\in \\mathbb{R}^{n}$ 是第 $j$ 个标准基向量。相应的辅助位移是 $u^{(b)} = w$，由辅助系统\n$$\nK w = e_j.\n$$\n得到。\n- 应用 Maxwell–Betti 定理：\n$$\nf^{\\top} w = e_j^{\\top} u = u_j.\n$$\n因此，我们感兴趣的标量 $u_j$ 等于原始载荷向量 $f$ 在辅助位移场 $w$ 上所做的功。\n\n单位：\n- $K$ 的单位是牛顿/米。辅助右端项 $e_j$ 的单位是牛顿，大小为 $1$。因此，$w$ 的单位是米/牛顿，而 $f^{\\top} w$ 的单位是米，与目标位移分量的单位相匹配。\n\n每个测试案例的算法：\n- 构造 $e_j$，使其在索引 $j$ 处为 $1$，其他地方为 $0$。\n- 求解线性系统 $K w = e_j$ 得到 $w$。\n- 计算标量 $u_j = f^{\\top} w$。\n- 将 $u_j$ 四舍五入到六位小数，并以米为单位报告。\n\n数值实现细节：\n- 测试套件中的矩阵 $K$ 是小型的、对称的且严格对角占优的，因此是对称正定的；一个直接的稠密求解器是足够的。\n- 为确保零的清晰表示，如果 $|u_j|  \\varepsilon$ 对于某个小公差 $\\varepsilon$，我们可以在四舍五入之前将 $u_j$ 设为 $0$，以避免带符号零的误差。\n- 最终输出是单行，格式为精确要求的方括号、逗号分隔且无空格，每个值显示小数点后六位。\n\n此过程对每个测试案例仅使用一次辅助求解，并通过单个内积来评估所需的标量，实现了 Betti 互易定理所要求的单次求解伴随计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef adjoint_displacement(K: np.ndarray, f: np.ndarray, j: int) -> float:\n    \"\"\"\n    Compute the displacement at DOF j using a single auxiliary (adjoint) solve:\n    Solve K w = e_j, then return f^T w.\n    \"\"\"\n    n = K.shape[0]\n    e = np.zeros(n, dtype=float)\n    e[j] = 1.0  # unit load at target DOF\n    # Solve the auxiliary system\n    w = np.linalg.solve(K, e)\n    # Reciprocity: u_j = f^T w\n    uj = float(np.dot(f, w))\n    # Clean near-zero for formatting\n    if abs(uj)  1e-12:\n        uj = 0.0\n    return uj\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (K, f, j)\n    test_cases = [\n        (\n            np.array([[12.0, -3.0,  0.0],\n                      [-3.0, 10.0, -2.0],\n                      [ 0.0, -2.0,  5.0]], dtype=float),\n            np.array([0.0, 100.0, 50.0], dtype=float),\n            2\n        ),\n        (\n            np.array([[ 8.0, -2.0],\n                      [-2.0,  4.0]], dtype=float),\n            np.array([0.0, 10.0], dtype=float),\n            0\n        ),\n        (\n            np.array([[ 6.0, -2.0,  0.0],\n                      [-2.0,  5.0, -1.0],\n                      [ 0.0, -1.0,  3.0]], dtype=float),\n            np.array([0.0, 0.0, 0.0], dtype=float),\n            1\n        ),\n        (\n            np.array([[20.0, -5.0,  0.0,  0.0],\n                      [-5.0, 15.0, -3.0,  0.0],\n                      [ 0.0, -3.0, 12.0, -4.0],\n                      [ 0.0,  0.0, -4.0,  9.0]], dtype=float),\n            np.array([0.0, 0.0, 100.0, 0.0], dtype=float),\n            2\n        ),\n    ]\n\n    results = []\n    for K, f, j in test_cases:\n        uj = adjoint_displacement(K, f, j)\n        results.append(f\"{uj:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2868483"}]}