{"hands_on_practices": [{"introduction": "我们如何将连续介质假设应用于在微观尺度上不均匀的真实材料，例如复合材料？代表性体积单元（RVE）的概念为此提供了统计基础，它定义了可将材料视为均质的最小尺度。本练习将引导您推导样本尺寸与材料属性波动之间的关系，从而提供一种量化定义RVE的方法。", "problem": "一个统计均匀的两相复合材料被建模为一个连续介质，其局部杨氏模量场 $E(\\mathbf{x})$ 是一个二阶平稳且各遍历的空间随机场。该局部场具有均值 $\\mu_{E}$、方差 $\\sigma_{E}^{2}$ 和各向同性的两点协方差函数 $R(r) = \\operatorname{Cov}\\!\\big(E(\\mathbf{0}),E(\\mathbf{r})\\big)$，其中 $r = \\|\\mathbf{r}\\|$。假设材料对比度较小，因此体积为 $V$ 的试样上的有效模量可以由体积平均值 $E_{V} = \\frac{1}{V}\\int_{V} E(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}$ 近似。试样是一个凸域，其特征尺寸远大于材料相关长度，因此边界效应可以忽略，并且大体积渐近理论适用。\n\n仅从连续介质运动学、体积平均的定义以及二阶平稳随机场的性质出发，推导估计量 $E_{V}$ 的变异系数在三维空间中如何随试样体积 $V$ 缩放。具体来说，用 $\\mu_{E}$、$\\sigma_{E}$、$V$ 和 $R(r)$ 的适当积分来表示变异系数 $\\mathrm{COV}(E_{V})$，并展示其对 $V$ 的依赖关系。\n\n然后，针对高斯协方差\n$$\nR(r) \\;=\\; \\sigma_{E}^{2} \\exp\\!\\big(-(r/\\ell)^{2}\\big),\n$$\n进行特例分析，其相关长度为 $\\ell$。利用这一特例，估计满足 $\\mathrm{COV}(E_{V}) \\le \\tau$ 的最小试样体积 $V_{\\mathrm{RVE}}$，其中容差为 $\\tau = 0.02$。使用参数 $\\mu_{E} = 70\\,\\mathrm{GPa}$、$\\sigma_{E} = 7\\,\\mathrm{GPa}$ 和 $\\ell = 0.2\\,\\mathrm{mm}$。最终体积以 $\\mathrm{mm}^{3}$ 表示，并将答案四舍五入到三位有效数字。", "solution": "该问题要求推导随机介质体积平均属性的变异系数的缩放规律，并随后对一个特定情况进行数值计算。我们必须首先验证该问题。\n\n步骤 1：提取已知条件。\n- 局部杨氏模量 $E(\\mathbf{x})$ 是一个二阶平稳且各遍历的随机场。\n- 场的均值：$\\mu_{E} = \\mathrm{E}[E(\\mathbf{x})]$。\n- 场的方差：$\\sigma_{E}^{2} = \\mathrm{Var}[E(\\mathbf{x})]$。\n- 各向同性的两点协方差函数：$R(r) = \\operatorname{Cov}\\!\\big(E(\\mathbf{0}),E(\\mathbf{r})\\big)$，其中 $r = \\|\\mathbf{r}\\|$。\n- 有效模量由体积平均近似：$E_{V} = \\frac{1}{V}\\int_{V} E(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}$。\n- 试样体积 $V$ 远大于材料相关尺度，且边界效应可以忽略。\n- 任务 1：在三维空间中，推导 $\\mathrm{COV}(E_{V})$ 随 $V$ 的缩放规律，并用 $\\mu_E$、$\\sigma_E$、$V$ 以及 $R(r)$ 的一个积分来表示。\n- 任务 2：针对高斯协方差 $R(r) = \\sigma_{E}^{2} \\exp\\!\\big(-(r/\\ell)^{2}\\big)$ 进行特例分析。\n- 任务 3：计算满足 $\\mathrm{COV}(E_{V}) \\le \\tau$ 的最小体积 $V_{\\mathrm{RVE}}$，其中 $\\tau = 0.02$。\n- 参数：$\\mu_{E} = 70\\,\\mathrm{GPa}$、$\\sigma_{E} = 7\\,\\mathrm{GPa}$、$\\ell = 0.2\\,\\mathrm{mm}$。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，是随机介质均匀化和材料力学中的一个标准课题。平稳随机场、体积平均和代表性体积单元（RVE）等概念都是基础性的。该问题是适定的，提供了所有必要的信息和假设（如小对比度和大体积），从而能够得出一个唯一且有意义的解。它使用精确的数学和物理术语进行了客观陈述。未检测到任何缺陷。\n\n步骤 3：结论和行动。\n问题有效。将提供完整的解答。\n\n估计量 $E_{V}$ 的变异系数定义为其标准差与均值之比：\n$$\n\\mathrm{COV}(E_{V}) = \\frac{\\sqrt{\\mathrm{Var}(E_{V})}}{\\mathrm{E}[E_{V}]}\n$$\n我们必须首先计算 $E_{V}$ 的均值和方差。\n\n$E_{V}$ 的均值可通过对其定义求期望得到：\n$$\n\\mathrm{E}[E_{V}] = \\mathrm{E}\\left[\\frac{1}{V}\\int_{V} E(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}\\right]\n$$\n根据期望算子的线性性质，我们可以将其与积分互换：\n$$\n\\mathrm{E}[E_{V}] = \\frac{1}{V}\\int_{V} \\mathrm{E}[E(\\mathbf{x})]\\,\\mathrm{d}\\mathbf{x}\n$$\n由于随机场 $E(\\mathbf{x})$ 是平稳的，其均值 $\\mathrm{E}[E(\\mathbf{x})]$ 对所有 $\\mathbf{x}$ 都是一个常数 $\\mu_{E}$。\n$$\n\\mathrm{E}[E_{V}] = \\frac{1}{V}\\int_{V} \\mu_{E}\\,\\mathrm{d}\\mathbf{x} = \\frac{1}{V}(\\mu_{E}V) = \\mu_{E}\n$$\n体积平均模量的均值就是局部模量场的均值。\n\n接下来，我们计算 $E_{V}$ 的方差：\n$$\n\\mathrm{Var}(E_{V}) = \\mathrm{E}\\left[\\big(E_{V} - \\mathrm{E}[E_{V}]\\big)^{2}\\right] = \\mathrm{E}\\left[\\left(\\frac{1}{V}\\int_{V} E(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x} - \\mu_{E}\\right)^{2}\\right]\n$$\n我们可以将 $\\mu_{E}$ 写成 $\\mu_{E} = \\frac{1}{V}\\int_{V}\\mu_{E}\\,\\mathrm{d}\\mathbf{x}$，以便将各项合并到单个积分下：\n$$\n\\mathrm{Var}(E_{V}) = \\mathrm{E}\\left[\\left(\\frac{1}{V}\\int_{V} \\big(E(\\mathbf{x}) - \\mu_{E}\\big)\\,\\mathrm{d}\\mathbf{x}\\right)^{2}\\right] = \\frac{1}{V^{2}}\\mathrm{E}\\left[\\left(\\int_{V} E'(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}\\right)\\left(\\int_{V} E'(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y}\\right)\\right]\n$$\n其中 $E'(\\mathbf{x}) = E(\\mathbf{x}) - \\mu_{E}$ 是场的脉动部分，其均值为零。积分的乘积可以写成一个二重积分：\n$$\n\\mathrm{Var}(E_{V}) = \\frac{1}{V^{2}}\\mathrm{E}\\left[\\int_{V}\\int_{V} E'(\\mathbf{x})E'(\\mathbf{y})\\,\\mathrm{d}\\mathbf{x}\\,\\mathrm{d}\\mathbf{y}\\right]\n$$\n交换期望和积分：\n$$\n\\mathrm{Var}(E_{V}) = \\frac{1}{V^{2}}\\int_{V}\\int_{V} \\mathrm{E}[E'(\\mathbf{x})E'(\\mathbf{y})]\\,\\mathrm{d}\\mathbf{x}\\,\\mathrm{d}\\mathbf{y}\n$$\n项 $\\mathrm{E}[E'(\\mathbf{x})E'(\\mathbf{y})]$ 是协方差 $\\operatorname{Cov}(E(\\mathbf{x}), E(\\mathbf{y}))$ 的定义。由于二阶平稳性，这仅取决于分离向量 $\\mathbf{r} = \\mathbf{y}-\\mathbf{x}$，即 $\\operatorname{Cov}(E(\\mathbf{x}), E(\\mathbf{y})) = R(\\mathbf{y}-\\mathbf{x})$。\n$$\n\\mathrm{Var}(E_{V}) = \\frac{1}{V^{2}}\\int_{V}\\int_{V} R(\\mathbf{y}-\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}\\,\\mathrm{d}\\mathbf{y}\n$$\n问题指出，试样的特征尺寸远大于材料的相关长度。这为大体积渐近近似提供了依据。对于远离域 $V$ 边界的点 $\\mathbf{x}$，协方差函数对 $\\mathbf{y}$ 的积分近似于其在整个空间上的积分，因为 $R$ 衰减得很快。因此我们可以近似这个二重积分：\n$$\n\\int_{V}\\int_{V} R(\\mathbf{y}-\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}\\,\\mathrm{d}\\mathbf{y} \\approx \\int_{V} \\left( \\int_{\\mathbb{R}^{3}} R(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r} \\right)\\,\\mathrm{d}\\mathbf{x} = V \\int_{\\mathbb{R}^{3}} R(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}\n$$\n所以，方差简化为：\n$$\n\\mathrm{Var}(E_{V}) \\approx \\frac{1}{V} \\int_{\\mathbb{R}^{3}} R(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}\n$$\n由于协方差 $R(r)$ 是各向同性的，我们在球坐标中计算该积分，其中 $\\mathrm{d}\\mathbf{r} = r^{2}\\sin\\theta\\,\\mathrm{d}r\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$。\n$$\n\\int_{\\mathbb{R}^{3}} R(r)\\,\\mathrm{d}\\mathbf{r} = \\int_{0}^{\\infty}\\int_{0}^{\\pi}\\int_{0}^{2\\pi} R(r) r^{2}\\sin\\theta\\,\\mathrm{d}\\phi\\,\\mathrm{d}\\theta\\,\\mathrm{d}r = 4\\pi \\int_{0}^{\\infty} r^{2}R(r)\\,\\mathrm{d}r\n$$\n因此，方差为：\n$$\n\\mathrm{Var}(E_{V}) \\approx \\frac{4\\pi}{V} \\int_{0}^{\\infty} r^{2}R(r)\\,\\mathrm{d}r\n$$\n那么变异系数为：\n$$\n\\mathrm{COV}(E_{V}) \\approx \\frac{1}{\\mu_{E}}\\sqrt{\\frac{4\\pi}{V} \\int_{0}^{\\infty} r^{2}R(r)\\,\\mathrm{d}r}\n$$\n这个结果显示了缩放关系 $\\mathrm{COV}(E_{V}) \\propto V^{-1/2}$。\n\n现在，我们特例分析高斯协方差函数 $R(r) = \\sigma_{E}^{2}\\exp\\big(-(r/\\ell)^{2}\\big)$。我们必须计算这个积分：\n$$\n\\int_{0}^{\\infty} r^{2}R(r)\\,\\mathrm{d}r = \\sigma_{E}^{2} \\int_{0}^{\\infty} r^{2}\\exp\\big(-(r/\\ell)^{2}\\big)\\,\\mathrm{d}r\n$$\n令 $u = r/\\ell$，则 $r = u\\ell$ 且 $\\mathrm{d}r = \\ell\\,\\mathrm{d}u$。积变为：\n$$\n\\sigma_{E}^{2} \\int_{0}^{\\infty} (u\\ell)^{2}e^{-u^{2}}(\\ell\\,\\mathrm{d}u) = \\sigma_{E}^{2}\\ell^{3}\\int_{0}^{\\infty} u^{2}e^{-u^{2}}\\,\\mathrm{d}u\n$$\n这是一个标准的高斯积分，其值为 $\\int_{0}^{\\infty} u^{2}e^{-u^{2}}\\,\\mathrm{d}u = \\frac{\\sqrt{\\pi}}{4}$。\n因此，协方差在整个空间上的积分为：\n$$\n\\int_{\\mathbb{R}^{3}} R(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r} = 4\\pi \\left(\\sigma_{E}^{2}\\ell^{3} \\frac{\\sqrt{\\pi}}{4}\\right) = \\pi^{3/2} \\sigma_{E}^{2}\\ell^{3}\n$$\n对于高斯情况，方差为：\n$$\n\\mathrm{Var}(E_{V}) \\approx \\frac{\\pi^{3/2}\\sigma_{E}^{2}\\ell^{3}}{V}\n$$\n并且变异系数为：\n$$\n\\mathrm{COV}(E_{V}) \\approx \\frac{1}{\\mu_{E}}\\sqrt{\\frac{\\pi^{3/2}\\sigma_{E}^{2}\\ell^{3}}{V}} = \\frac{\\sigma_{E}}{\\mu_{E}}\\sqrt{\\frac{\\pi^{3/2}\\ell^{3}}{V}}\n$$\n最后，我们必须找到满足 $\\mathrm{COV}(E_{V}) \\le \\tau$ 的最小试样体积 $V_{\\mathrm{RVE}}$。我们求解等式：\n$$\n\\frac{\\sigma_{E}}{\\mu_{E}}\\sqrt{\\frac{\\pi^{3/2}\\ell^{3}}{V_{\\mathrm{RVE}}}} = \\tau\n$$\n两边平方并求解 $V_{\\mathrm{RVE}}$：\n$$\n\\left(\\frac{\\sigma_{E}}{\\mu_{E}}\\right)^{2}\\frac{\\pi^{3/2}\\ell^{3}}{V_{\\mathrm{RVE}}} = \\tau^{2} \\implies V_{\\mathrm{RVE}} = \\left(\\frac{\\sigma_{E}}{\\mu_{E}\\tau}\\right)^{2}\\pi^{3/2}\\ell^{3}\n$$\n给定参数 $\\mu_{E} = 70\\,\\mathrm{GPa}$、$\\sigma_{E} = 7\\,\\mathrm{GPa}$、$\\ell = 0.2\\,\\mathrm{mm}$ 和 $\\tau = 0.02$。\n比值 $\\sigma_{E}/\\mu_{E}$ 为 $\\frac{7}{70} = 0.1$。\n代入数值：\n$$\nV_{\\mathrm{RVE}} = \\left(\\frac{0.1}{0.02}\\right)^{2} \\pi^{3/2} (0.2\\,\\mathrm{mm})^{3}\n$$\n$$\nV_{\\mathrm{RVE}} = 5^{2} \\pi^{3/2} (0.008\\,\\mathrm{mm}^{3}) = 25 \\times 0.008 \\times \\pi^{3/2}\\,\\mathrm{mm}^{3} = 0.2\\,\\pi^{3/2}\\,\\mathrm{mm}^{3}\n$$\n现在我们计算数值：\n$$\nV_{\\mathrm{RVE}} \\approx 0.2 \\times (3.14159...)^{1.5} \\,\\mathrm{mm}^{3} \\approx 0.2 \\times 5.56832... \\,\\mathrm{mm}^{3} \\approx 1.11366... \\,\\mathrm{mm}^{3}\n$$\n四舍五入到三位有效数字，我们得到 $V_{\\mathrm{RVE}} \\approx 1.11\\,\\mathrm{mm}^{3}$。", "answer": "$$\\boxed{1.11}$$", "id": "2922835"}, {"introduction": "连续介质假设不仅适用于材料的体属性，也适用于其边界相互作用，在微米和纳米尺度的系统中，这种假设可能会失效。克努森数（Knudsen number）量化了这种失效的程度，对于“滑移流”区域内的流动，标准的无滑移边界条件必须被更精确的滑移流模型所取代。这个问题将挑战您诊断经典无滑移条件的局限性，并应用一阶修正，即滑移长度，这是微流控领域的一项关键技能。", "problem": "一股稀薄的单原子气体在微通道中切向流过原子级光滑的固体表面。测得该气体的平均自由程为 $\\lambda = 65 \\ \\mathrm{nm}$，壁面附近的特征速度梯度长度尺度为 $L = 1.0 \\ \\mathrm{\\mu m}$。由于部分镜面反射，该固体表面的切向动量适应系数为 $\\sigma = 0.80$。以连续介质假设为基础，按以下步骤进行：首先，根据第一性原理判断经典的纳维-斯托克斯方程和无滑移边界条件是否适用于此情况。如果不是，请选择与连续介质描述保持一致的最小修正，或者解释是否需要更高阶的动理学理论修正。然后，对于所选模型，根据给定参数估算壁面处的有效滑移长度 $b$。\n\n请将您的最终答案表示为 $b$ 的数值（单位为纳米），四舍五入到三位有效数字，最终数字不包含单位。", "solution": "对所述问题进行验证。\n\n首先，逐字提取已知条件：\n- 气体平均自由程：$\\lambda = 65 \\ \\mathrm{nm}$。\n- 特征速度梯度长度尺度：$L = 1.0 \\ \\mathrm{\\mu m}$。\n- 切向动量适应系数：$\\sigma = 0.80$。\n- 气体为稀薄单原子气体，切向流过原子级光滑表面。\n- 任务是判断纳维-斯托克斯方程和无滑移边界条件的有效性，若无效则选择一个合适的模型，并估算有效滑移长度 $b$。\n\n该问题具有科学依据，提法明确，且客观。它涉及流体动力学中一个已成熟的课题——滑移流区。所有参数都符合物理实际，并使用标准科学术语定义。该问题是自洽的，为进行第一性原理估算提供了所有必要信息。不存在矛盾、歧义或事实不准确之处。因此，该问题是有效的。\n\n连续介质假设及其相关的无滑移边界条件的有效性由克努森数 $Kn$ 决定，$Kn$ 定义为分子平均自由程 $\\lambda$ 与流动的特征长度尺度 $L$ 之比。对于本问题，特征长度是速度梯度长度尺度，即 $L = 1.0 \\ \\mathrm{\\mu m}$。\n\n我们计算克努森数：\n$$Kn = \\frac{\\lambda}{L}$$\n代入给定值，确保单位一致：\n$\\lambda = 65 \\ \\mathrm{nm} = 65 \\times 10^{-9} \\ \\mathrm{m}$\n$L = 1.0 \\ \\mathrm{\\mu m} = 1.0 \\times 10^{-6} \\ \\mathrm{m} = 1000 \\times 10^{-9} \\ \\mathrm{m}$\n$$Kn = \\frac{65 \\times 10^{-9} \\ \\mathrm{m}}{1.0 \\times 10^{-6} \\ \\mathrm{m}} = 0.065$$\n\n克努森数的值决定了适用于该气体流动的物理模型：\n1.  当 $Kn  0.01$ 时，连续介质假设成立，纳维-斯托克斯方程和无滑移边界条件有效。\n2.  当 $0.01  Kn  0.1$ 时，流动处于滑移流区。主体流动仍可由纳维-斯托克斯方程描述，但壁面处的无滑移条件不再有效，必须替换为滑移边界条件。\n3.  当 $Kn > 0.1$ 时，纳维-斯托克斯方程本身变得不准确，需要更高阶的动力学理论修正（例如，Burnett 方程，或基于玻尔兹曼方程的直接模拟方法）。\n\n我们计算出的值为 $Kn = 0.065$。该值落在 $0.01  Kn  0.1$ 的范围内，表明流动处于滑移流区。因此，经典的纳维-斯托克斯方程和无滑移边界条件对这种情况**不**适用。根据要求，与连续介质描述相符的最小修正是：保留用于流体主体的纳维-斯托克斯方程，但在固体边界处引入一阶速度滑移条件。对于此 $Kn$ 值，尚不需要更高阶的动力学理论。\n\n一阶滑移边界条件将滑移速度 $u_s$（气体在壁面处的切向速度）与垂直于壁面的局部速度梯度关联起来：\n$$u_s = u_{\\text{gas at wall}} - u_{\\text{wall}} = b \\left( \\frac{\\partial u}{\\partial y} \\right)_{\\text{wall}}$$\n此处，$b$ 是滑移长度，表示如果应用无滑移条件，速度剖面外推至壁面速度（$u_{\\text{wall}}$，在不失一般性的情况下可设为零）时，在壁面后方的虚拟距离。\n\n滑移长度 $b$ 可以通过考虑气体分子与表面之间的动量交换，从动力学理论中推导出来。假设一部分入射分子（比例为 $\\sigma$）发生漫反射，以从壁面温度下的麦克斯韦分布中采样的速度重新射出，且平均切向速度为零。剩余部分（比例为 $1-\\sigma$）发生镜面反射，其切向动量守恒。这个由 Maxwell 首次提出的物理模型，得出了以下滑移长度的表达式：\n$$b = \\frac{2 - \\sigma}{\\sigma} \\lambda$$\n这是滑移长度的标准一阶模型，足以满足本问题所要求的估算。一些更高级的模型引入了一个接近于1的数值前因子（例如，来自 Kramers 问题的 BGK 模型解），但我们将采用这一基本结果。\n\n现在我们将给定参数代入此表达式，以估算滑移长度 $b$：\n- 切向动量适应系数：$\\sigma = 0.80$\n- 平均自由程：$\\lambda = 65 \\ \\mathrm{nm}$\n\n$$b = \\frac{2 - 0.80}{0.80} \\lambda = \\frac{1.20}{0.80} \\lambda = 1.5 \\lambda$$\n$$b = 1.5 \\times (65 \\ \\mathrm{nm}) = 97.5 \\ \\mathrm{nm}$$\n\n估算的有效滑移长度为 $97.5$ 纳米。问题要求答案四舍五入到三位有效数字，此结果已满足要求。", "answer": "$$\\boxed{97.5}$$", "id": "2922868"}, {"introduction": "诸如密度和动量之类的连续场是离散粒子属性的宏观平均值。这个平均过程可以通过一种称为“粗粒化”的数学运算来形式化，该运算使用一个平滑核函数来连接微观和宏观尺度。通过这个计算练习，您将直接实现粗粒化过程，从粒子数据中构建连续场，并亲眼观察平均尺度（$\\eta$）的选择如何决定最终宏观描述的光滑度。[@problem_id:2922844]", "problem": "给定一个二维域中的离散点粒子集，该粒子集与材料力学的连续介质假设一致：通过平滑核对微观组分进行粗粒化平均，从而获得宏观场。您必须从基本守恒原理和定义出发，通过将离散粒子数据与宽度参数为 $\\eta$ 的归一化高斯核进行卷积，在均匀网格上构建粗粒化质量密度场和线动量密度场，然后量化这些场在 $\\eta$ 变化时的光滑度。\n\n定义与建模假设：\n- 空间域为单位正方形 $\\Omega = [0,1]\\times[0,1]$，视为无量纲，因此所有量均为无量纲。\n- 对于核宽度 $\\eta0$，位置 $\\mathbf{x}\\in \\Omega$ 处的粗粒化质量密度场定义为\n$$\n\\rho_{\\eta}(\\mathbf{x}) \\equiv \\sum_{p=1}^{P} m_p \\, W_{\\eta}(\\mathbf{x}-\\mathbf{x}_p),\n$$\n其中 $m_p$ 和 $\\mathbf{x}_p$ 分别是粒子 $p$ 的质量和位置，而 $W_{\\eta}$ 是二维空间中的归一化高斯核，\n$$\nW_{\\eta}(\\mathbf{r}) \\equiv \\frac{1}{2\\pi \\eta^2}\\,\\exp\\!\\left(-\\frac{\\|\\mathbf{r}\\|^2}{2\\eta^2}\\right).\n$$\n- 粗粒化线动量密度场定义为\n$$\n\\mathbf{g}_{\\eta}(\\mathbf{x}) \\equiv \\sum_{p=1}^{P} m_p \\,\\mathbf{v}_p \\, W_{\\eta}(\\mathbf{x}-\\mathbf{x}_p),\n$$\n其中 $\\mathbf{v}_p$ 是粒子速度。请注意，$\\mathbf{g}_{\\eta}$ 是一个在平面内具有两个分量的矢量场。\n\n使计算明确、可测试和可复现的离散化方法：\n- 在 $\\Omega$ 上使用一个均匀的笛卡尔网格，每个方向有 $N$ 个点，坐标为 $x_i = i\\,h$ 和 $y_j = j\\,h$，其中 $i,j\\in\\{0,1,\\dots,N-1\\}$，$h\\equiv 1/(N-1)$。\n- 使用所述的 $W_{\\eta}$，通过对粒子直接求和，在所有网格节点 $(x_i,y_j)$ 上计算 $\\rho_{\\eta}$ 和 $\\mathbf{g}_{\\eta}$。\n- 对于一个标量网格场 $f$，通过量纲一致的、归一化的离散狄利克雷-能量比来定义其离散粗糙度（光滑度的倒数）：\n$$\n\\mathcal{R}[f] \\equiv \\frac{\\sqrt{\\sum_{i=0}^{N-2}\\sum_{j=0}^{N-1}\\left(\\frac{f_{i+1,j}-f_{i,j}}{h}\\right)^2 h^2 \\;+\\; \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-2}\\left(\\frac{f_{i,j+1}-f_{i,j}}{h}\\right)^2 h^2}}{\\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} f_{i,j}^2 \\, h^2}}.\n$$\n- 定义矢量场 $\\mathbf{g}_{\\eta}=(g^{(x)}_{\\eta},g^{(y)}_{\\eta})$ 的粗糙度为\n$$\n\\mathcal{R}[\\mathbf{g}_{\\eta}] \\equiv \\frac{\\sqrt{\\sum_{i,j}\\left(\\left\\|\\nabla_h g^{(x)}_{\\eta}\\right\\|^2 + \\left\\|\\nabla_h g^{(y)}_{\\eta}\\right\\|^2\\right) h^2}}{\\sqrt{\\sum_{i,j}\\left(\\left(g^{(x)}_{\\eta}\\right)^2 + \\left(g^{(y)}_{\\eta}\\right)^2\\right) h^2}},\n$$\n其中 $\\|\\nabla_h f\\|^2$ 的近似方法与 $\\mathcal{R}[f]$ 中相同，使用前向差分模板，对 $x$ 方向差分求和时 $i\\in\\{0,\\dots,N-2\\}$ 且 $j\\in\\{0,\\dots,N-1\\}$，对 $y$ 方向差分求和时 $i\\in\\{0,\\dots,N-1\\}$ 且 $j\\in\\{0,\\dots,N-2\\}$。\n\n用于可复现测试的数据：\n- 网格分辨率：$N=81$，因此 $h=1/(81-1)$。\n- 粒子数量：$P=6$，具有以下属性：\n  - 粒子 1：位置 $(0.20,\\,0.20)$，质量 $0.50$，速度 $(0.80,\\,0.10)$。\n  - 粒子 2：位置 $(0.80,\\,0.20)$，质量 $0.30$，速度 $(-0.20,\\,0.50)$。\n  - 粒子 3：位置 $(0.50,\\,0.50)$，质量 $0.70$，速度 $(0.00,\\,-0.60)$。\n  - 粒子 4：位置 $(0.10,\\,0.90)$，质量 $0.40$，速度 $(0.30,\\,0.30)$。\n  - 粒子 5：位置 $(0.90,\\,0.90)$，质量 $0.60$，速度 $(-0.40,\\,0.20)$。\n  - 粒子 6：位置 $(0.05,\\,0.05)$，质量 $0.20$，速度 $(0.00,\\,0.00)$。\n- 核宽度（测试集）：$\\eta\\in\\{0.02,\\;0.05,\\;0.10,\\;0.25\\}$。\n\n任务：\n- 仅从上述定义和连续介质假设出发，对每个核宽度 $\\eta$，计算网格上的离散场 $\\rho_{\\eta}$ 和 $\\mathbf{g}_{\\eta}$，然后计算两个粗糙度度量 $\\mathcal{R}[\\rho_{\\eta}]$ 和 $\\mathcal{R}[\\mathbf{g}_{\\eta}]$。\n- 通过报告指定测试集中每个 $\\eta$ 对应的序对 $\\left(\\mathcal{R}[\\rho_{\\eta}],\\,\\mathcal{R}[\\mathbf{g}_{\\eta}]\\right)$，研究 $\\eta$ 如何影响光滑度。\n\n答案规格和输出格式：\n- 对于每个 $\\eta$，按 $\\eta=0.02$、$\\eta=0.05$、$\\eta=0.10$、$\\eta=0.25$ 的顺序，计算两个标量 $\\mathcal{R}[\\rho_{\\eta}]$ 和 $\\mathcal{R}[\\mathbf{g}_{\\eta}]$。\n- 使用标准四舍五入将每个标量圆整到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序展开：\n$$\n\\left[\\mathcal{R}[\\rho_{0.02}],\\;\\mathcal{R}[\\mathbf{g}_{0.02}],\\;\\mathcal{R}[\\rho_{0.05}],\\;\\mathcal{R}[\\mathbf{g}_{0.05}],\\;\\mathcal{R}[\\rho_{0.10}],\\;\\mathcal{R}[\\mathbf{g}_{0.10}],\\;\\mathcal{R}[\\rho_{0.25}],\\;\\mathcal{R}[\\mathbf{g}_{0.25}]\\right].\n$$\n- 输出必须是精确的一行，没有多余的文本，例如，格式为 $\\left[r_1,r_2,r_3,r_4,r_5,r_6,r_7,r_8\\right]$，其中每个 $r_k$ 是一个圆整到 $6$ 位小数的浮点数。\n\n您的最终答案必须是一个完整的、可运行的程序，该程序执行这些步骤并打印所需的单行输出。", "solution": "问题陈述已经过验证，并被认定为有效。这是一个良态计算问题，其基础是连续介质力学原理，特别是连接离散粒子描述与连续场描述的粗粒化过程。所有定义、数据和所需计算都已明确无误地指定，没有歧义或矛盾。\n\n任务是根据一组离散粒子计算粗粒化的质量密度场和线动量密度场，然后量化这些场的光滑度。步骤如下：\n\n1.  **离散化域**：将连续域 $\\Omega = [0,1]\\times[0,1]$ 离散化为一个 $N \\times N$ 的均匀笛卡尔网格，其中 $N=81$。网格点为 $\\mathbf{x}_{ij} = (i h, j h)$，其中 $i,j \\in \\{0, 1, \\dots, N-1\\}$，间距为 $h=1/(N-1)$。\n\n2.  **构建连续场**：对于给定的核宽度 $\\eta$，在每个网格点 $\\mathbf{x}_{ij}$ 处构建质量密度场 $\\rho_{\\eta}$ 和线动量密度场 $\\mathbf{g}_{\\eta}$。这些场是来自 $P=6$ 个粒子贡献的叠加，并由归一化的二维高斯核 $W_{\\eta}$ 加权。\n    质量密度是一个标量场，由下式给出：\n    $$\n    \\rho_{\\eta}(\\mathbf{x}_{ij}) = \\sum_{p=1}^{P} m_p \\, W_{\\eta}(\\mathbf{x}_{ij}-\\mathbf{x}_p)\n    $$\n    线动量密度是一个矢量场 $\\mathbf{g}_{\\eta} = (g^{(x)}_{\\eta}, g^{(y)}_{\\eta})$，由下式给出：\n    $$\n    \\mathbf{g}_{\\eta}(\\mathbf{x}_{ij}) = \\sum_{p=1}^{P} m_p \\,\\mathbf{v}_p \\, W_{\\eta}(\\mathbf{x}_{ij}-\\mathbf{x}_p)\n    $$\n    核函数定义为：\n    $$\n    W_{\\eta}(\\mathbf{r}) = \\frac{1}{2\\pi \\eta^2}\\,\\exp\\!\\left(-\\frac{\\|\\mathbf{r}\\|^2}{2\\eta^2}\\right)\n    $$\n    其中 $\\mathbf{r} = \\mathbf{x}_{ij} - \\mathbf{x}_p$ 是从粒子 $p$ 到网格点 $(i,j)$ 的向量。\n\n3.  **量化场的光滑度**：计算出的场的光滑度通过离散粗糙度度量 $\\mathcal{R}$ 来量化。此度量是一个归一化的比率。分子是场梯度 $L^2$范数的离散近似，代表场空间变化的总变差或“能量”。分母是场本身的离散 $L^2$范数，用于归一化。\n    对于网格上的标量场 $f$，其粗糙度为：\n    $$\n    \\mathcal{R}[f] = \\frac{\\sqrt{\\sum_{i,j} \\|\\nabla_h f_{ij}\\|^2 h^2}}{\\sqrt{\\sum_{i,j} f_{ij}^2 h^2}} = \\frac{\\sqrt{ \\sum_{i=0}^{N-2}\\sum_{j=0}^{N-1} (f_{i+1,j}-f_{i,j})^2 + \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-2} (f_{i,j+1}-f_{i,j})^2 }}{h \\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} f_{i,j}^2}}\n    $$\n    项 $\\|\\nabla_h f_{ij}\\|^2 h^2$ 使用前向差分来计算梯度分量。在消去 $h$ 后，公式得到简化。\n    对于矢量场 $\\mathbf{g}_{\\eta} = (g^{(x)}_{\\eta}, g^{(y)}_{\\eta})$，粗糙度推广了这一概念：分子结合了两个分量的梯度能量，分母是该矢量场的 $L^2$范数。\n    $$\n    \\mathcal{R}[\\mathbf{g}_{\\eta}] = \\frac{\\sqrt{ \\left(\\text{NumSq}[g^{(x)}_{\\eta}]\\right) + \\left(\\text{NumSq}[g^{(y)}_{\\eta}]\\right) }}{h \\sqrt{\\sum_{i,j} \\left( (g^{(x)}_{\\eta,ij})^2 + (g^{(y)}_{\\eta,ij})^2\\right)}}\n    $$\n    其中 $\\text{NumSq}[f]$ 代表标量粗糙度计算中的分子平方项。\n\n对每个指定的核宽度 $\\eta \\in \\{0.02, 0.05, 0.10, 0.25\\}$，执行这整个过程。随着 $\\eta$ 的增加，高斯核变得更宽，导致更大的重叠和更光滑的宏观场。因此，粗糙度度量 $\\mathcal{R}[\\rho_{\\eta}]$ 和 $\\mathcal{R}[\\mathbf{g}_{\\eta}]$ 预计会减小，这证实了粗粒化过程的平滑效应。最终结果按要求进行四舍五入和格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes coarse-grained mass and momentum density fields from discrete particle data\n    and calculates their roughness for various Gaussian kernel widths.\n    \"\"\"\n    # Define the test cases and parameters from the problem statement.\n    test_cases = [\n        # Particle data: [pos_x, pos_y, mass, vel_x, vel_y]\n        (np.array([\n            [0.20, 0.20, 0.50,  0.80,  0.10],\n            [0.80, 0.20, 0.30, -0.20,  0.50],\n            [0.50, 0.50, 0.70,  0.00, -0.60],\n            [0.10, 0.90, 0.40,  0.30,  0.30],\n            [0.90, 0.90, 0.60, -0.40,  0.20],\n            [0.05, 0.05, 0.20,  0.00,  0.00],\n        ]),\n        [0.02, 0.05, 0.10, 0.25])\n    ]\n\n    N = 81\n    h = 1.0 / (N - 1)\n    \n    # Generate grid coordinates\n    grid_coords = np.linspace(0, 1, N)\n    xx, yy = np.meshgrid(grid_coords, grid_coords)\n\n    results = []\n\n    for particles, eta_values in test_cases:\n        for eta in eta_values:\n            # Initialize fields for the current eta\n            rho = np.zeros((N, N))\n            g_x = np.zeros((N, N))\n            g_y = np.zeros((N, N))\n            \n            eta_sq = eta**2\n            kernel_norm = 1.0 / (2.0 * np.pi * eta_sq)\n            \n            # Sum contributions from all particles to construct the fields\n            for p_data in particles:\n                pos_x, pos_y, mass, vel_x, vel_y = p_data\n                \n                # Calculate squared distance from particle to all grid points\n                dist_sq = (xx - pos_x)**2 + (yy - pos_y)**2\n                \n                # Evaluate the Gaussian kernel over the grid\n                W = kernel_norm * np.exp(-dist_sq / (2.0 * eta_sq))\n                \n                # Accumulate weighted contributions to fields\n                rho += mass * W\n                g_x += mass * vel_x * W\n                g_y += mass * vel_y * W\n\n            # --- Calculate roughness for the scalar field rho ---\n            # Numerator: sqrt of sum of squared differences\n            diff_rho_x = rho[1:, :] - rho[:-1, :]\n            diff_rho_y = rho[:, 1:] - rho[:, :-1]\n            num_rho_sq = np.sum(diff_rho_x**2) + np.sum(diff_rho_y**2)\n            \n            # Denominator: h * sqrt of sum of squared field values\n            den_rho_sq_sum = np.sum(rho**2)\n            \n            if num_rho_sq == 0 or den_rho_sq_sum == 0:\n                R_rho = 0.0\n            else:\n                R_rho = np.sqrt(num_rho_sq) / (h * np.sqrt(den_rho_sq_sum))\n\n            # --- Calculate roughness for the vector field g ---\n            # Numerator: sqrt of the sum of squared gradient energies for each component\n            diff_gx_x = g_x[1:, :] - g_x[:-1, :]\n            diff_gx_y = g_x[:, 1:] - g_x[:, :-1]\n            num_gx_sq = np.sum(diff_gx_x**2) + np.sum(diff_gx_y**2)\n            \n            diff_gy_x = g_y[1:, :] - g_y[:-1, :]\n            diff_gy_y = g_y[:, 1:] - g_y[:, :-1]\n            num_gy_sq = np.sum(diff_gy_x**2) + np.sum(diff_gy_y**2)\n\n            num_g_sq = num_gx_sq + num_gy_sq\n\n            # Denominator: h * sqrt of sum of squared vector magnitudes\n            den_g_sq_sum = np.sum(g_x**2 + g_y**2)\n\n            if num_g_sq == 0 or den_g_sq_sum == 0:\n                R_g = 0.0\n            else:\n                 R_g = np.sqrt(num_g_sq) / (h * np.sqrt(den_g_sq_sum))\n\n            # Append rounded results to the list\n            results.append(round(R_rho, 6))\n            results.append(round(R_g, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2922844"}]}