{"hands_on_practices": [{"introduction": "本章节的第一个实践是奠定基础。我们将从刚体运动最核心的物理原理，即其内部任意两点间的距离在运动过程中保持不变，来严格推导描述这两点速度之间关系的基本方程。这项练习旨在强化您对刚性物理定义与其数学推论——即著名的相对速度叉乘公式——之间内在联系的理解，并应用此关系解决一个具体的运动学问题。[@problem_id:2914505]", "problem": "在一个具有平面内标准正交基的固定惯性参考系中，一根均匀刚性杆在某一瞬间位于该平面内，其两个端点为标示的质点 $P$ 和 $Q$。在该瞬间，这些点（相对于惯性原点）的瞬时位置矢量为\n$$\n\\mathbf{r}_P=\\begin{pmatrix}1\\\\2\\end{pmatrix}\\,\\mathrm{m},\\qquad \\mathbf{r}_Q=\\begin{pmatrix}5\\\\-1\\end{pmatrix}\\,\\mathrm{m}.\n$$\n在同一瞬间，它们在惯性系中测得的速度为\n$$\n\\mathbf{v}_P=\\begin{pmatrix}3\\\\7\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}},\\qquad \\mathbf{v}_Q=\\begin{pmatrix}9\\\\15\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}.\n$$\n将该运动视为刚体的一般平面运动。仅使用刚性的定义属性，即任意两个质点之间的距离随时间保持不变，首先推导在平面内运动的刚体上两点速度之间的一般瞬时关系，并计算在给定瞬间点 $Q$ 相对于点 $P$ 的瞬时相对速度。然后，求出该杆的标量角速度 $\\omega$（当角速度为逆时针时，取平面外单位矢量 $\\hat{\\mathbf{k}}$ 为正）以及该瞬间杆的质心（COM）的平移速度。\n\n角速度以弧度/秒为单位，质心速度以米/秒为单位表示。将最终结果以单行矩阵 $\\begin{pmatrix}\\omega  v_{\\mathrm{COM},x}  v_{\\mathrm{COM},y}\\end{pmatrix}$ 的形式给出。无需四舍五入；请提供精确值。", "solution": "对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 参考系：带标准正交基的固定惯性参考系。\n- 物体：进行平面运动的均匀刚性杆。\n- 杆上的点：端点 $P$ 和 $Q$。\n- P的位置矢量：$\\mathbf{r}_P=\\begin{pmatrix}1\\\\2\\end{pmatrix}\\,\\mathrm{m}$。\n- Q的位置矢量：$\\mathbf{r}_Q=\\begin{pmatrix}5\\\\-1\\end{pmatrix}\\,\\mathrm{m}$。\n- P的速度：$\\mathbf{v}_P=\\begin{pmatrix}3\\\\7\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}$。\n- Q的速度：$\\mathbf{v}_Q=\\begin{pmatrix}9\\\\15\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}$。\n- 约束条件：仅使用刚性的定义属性，即任意两质点间距离的不变性。\n- 求解目标：\n    1. 推导刚体上两点速度之间的一般瞬时关系。\n    2. 计算相对速度 $\\mathbf{v}_{Q/P}$。\n    3. 计算标量角速度 $\\omega$。\n    4. 计算质心（COM）的速度 $\\mathbf{v}_{\\mathrm{COM}}$。\n- 输出格式：一个行矩阵 $\\begin{pmatrix}\\omega  v_{\\mathrm{COM},x}  v_{\\mathrm{COM},y}\\end{pmatrix}$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题在科学上基于刚体的经典运动学。这是一个适定问题，因为平面内刚体上两点的位置和速度足以确定其瞬时运动状态。语言客观而精确。\n\n刚体运动的一个关键一致性检查是，两点的相对速度矢量必须与它们的相对位置矢量正交。令 $\\mathbf{r}_{QP} = \\mathbf{r}_Q - \\mathbf{r}_P$ 且 $\\mathbf{v}_{QP} = \\mathbf{v}_Q - \\mathbf{v}_P$。刚性条件意味着 $\\frac{d}{dt}(|\\mathbf{r}_{QP}|^2)=0$，这导致 $\\mathbf{r}_{QP} \\cdot \\mathbf{v}_{QP} = 0$。\n\n根据给定数据：\n$\\mathbf{r}_{QP} = \\begin{pmatrix}5\\\\-1\\end{pmatrix} - \\begin{pmatrix}1\\\\2\\end{pmatrix} = \\begin{pmatrix}4\\\\-3\\end{pmatrix}\\,\\mathrm{m}$。\n$\\mathbf{v}_{QP} = \\begin{pmatrix}9\\\\15\\end{pmatrix} - \\begin{pmatrix}3\\\\7\\end{pmatrix} = \\begin{pmatrix}6\\\\8\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}$。\n\n我们计算点积：\n$\\mathbf{r}_{QP} \\cdot \\mathbf{v}_{QP} = (4)(6) + (-3)(8) = 24 - 24 = 0$。\n条件得到满足。数据是一致的，没有违反任何物理原理。\n\n**第3步：结论与行动**\n问题有效。将提供解答。\n\n解答按顺序处理问题陈述的每个部分。\n\n首先，我们推导刚体的一般速度关系。设 $P$ 和 $Q$ 是刚体上的两个点，其位置矢量为 $\\mathbf{r}_P$ 和 $\\mathbf{r}_Q$。相对位置矢量为 $\\mathbf{r}_{QP} = \\mathbf{r}_Q - \\mathbf{r}_P$。刚性的定义属性是 $P$ 和 $Q$ 之间的距离 $L = |\\mathbf{r}_{QP}|$ 是恒定的。因此，其平方 $L^2 = \\mathbf{r}_{QP} \\cdot \\mathbf{r}_{QP}$ 也是恒定的。对时间 $t$ 求导：\n$$ \\frac{d}{dt} (L^2) = \\frac{d}{dt} (\\mathbf{r}_{QP} \\cdot \\mathbf{r}_{QP}) = 2 \\mathbf{r}_{QP} \\cdot \\frac{d\\mathbf{r}_{QP}}{dt} = 0 $$\n项 $\\frac{d\\mathbf{r}_{QP}}{dt}$ 是相对速度 $\\mathbf{v}_{QP} = \\mathbf{v}_Q - \\mathbf{v}_P$。关系 $\\mathbf{r}_{QP} \\cdot \\mathbf{v}_{QP} = 0$ 表明相对速度始终垂直于连接两点的矢量。这种运动是点 $Q$ 绕点 $P$ 的纯转动（在随 $P$ 平移的参考系中）。这种运动可以用与角速度矢量 $\\boldsymbol{\\omega}$ 的叉积来描述：\n$$ \\mathbf{v}_{QP} = \\boldsymbol{\\omega} \\times \\mathbf{r}_{QP} $$\n这就得出了刚体上两点速度的基本关系：\n$$ \\mathbf{v}_Q = \\mathbf{v}_P + \\boldsymbol{\\omega} \\times (\\mathbf{r}_Q - \\mathbf{r}_P) $$\n对于 $xy$ 平面内的平面运动，$\\boldsymbol{\\omega} = \\omega \\hat{\\mathbf{k}}$，其中 $\\hat{\\mathbf{k}}$ 是垂直于平面的单位矢量。如果 $\\mathbf{r}_{QP} = \\Delta x \\hat{\\mathbf{i}} + \\Delta y \\hat{\\mathbf{j}}$，则叉积变为：\n$$ \\boldsymbol{\\omega} \\times \\mathbf{r}_{QP} = (\\omega \\hat{\\mathbf{k}}) \\times (\\Delta x \\hat{\\mathbf{i}} + \\Delta y \\hat{\\mathbf{j}}) = \\omega \\Delta x (\\hat{\\mathbf{k}} \\times \\hat{\\mathbf{i}}) + \\omega \\Delta y (\\hat{\\mathbf{k}} \\times \\hat{\\mathbf{j}}) = \\omega \\Delta x \\hat{\\mathbf{j}} - \\omega \\Delta y \\hat{\\mathbf{i}} $$\n以列矢量形式，这表示为 $\\mathbf{v}_{QP} = \\begin{pmatrix} -\\omega \\Delta y \\\\ \\omega \\Delta x \\end{pmatrix}$。\n\n第二，我们计算 $Q$ 相对于 $P$ 的瞬时相对速度 $\\mathbf{v}_{Q/P} = \\mathbf{v}_{QP}$。使用所提供的数据：\n$$ \\mathbf{v}_{QP} = \\mathbf{v}_Q - \\mathbf{v}_P = \\begin{pmatrix}9\\\\15\\end{pmatrix} - \\begin{pmatrix}3\\\\7\\end{pmatrix} = \\begin{pmatrix}6\\\\8\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}} $$\n\n第三，我们求出标量角速度 $\\omega$。相对位置矢量为：\n$$ \\mathbf{r}_{QP} = \\mathbf{r}_Q - \\mathbf{r}_P = \\begin{pmatrix}5\\\\-1\\end{pmatrix} - \\begin{pmatrix}1\\\\2\\end{pmatrix} = \\begin{pmatrix}4\\\\-3\\end{pmatrix}\\,\\mathrm{m} $$\n所以，$\\Delta x = 4$ 且 $\\Delta y = -3$。代入 $\\mathbf{v}_{QP}$ 的表达式中：\n$$ \\begin{pmatrix}6\\\\8\\end{pmatrix} = \\begin{pmatrix} -\\omega (-3) \\\\ \\omega (4) \\end{pmatrix} = \\begin{pmatrix} 3\\omega \\\\ 4\\omega \\end{pmatrix} $$\n这给出了关于 $\\omega$ 的两个一致的方程：\n从 $x$ 分量得到：$6 = 3\\omega \\implies \\omega = 2\\,\\mathrm{rad/s}$。\n从 $y$ 分量得到：$8 = 4\\omega \\implies \\omega = 2\\,\\mathrm{rad/s}$。\n角速度为正，按照惯例对应于逆时针旋转。因此，$\\omega = 2$。\n\n第四，我们确定质心（COM）的速度。由于杆是均匀的，其质心位于其端点 $P$ 和 $Q$ 的中点。质心的位置是：\n$$ \\mathbf{r}_{\\mathrm{COM}} = \\frac{\\mathbf{r}_P + \\mathbf{r}_Q}{2} = \\frac{1}{2}\\left(\\begin{pmatrix}1\\\\2\\end{pmatrix} + \\begin{pmatrix}5\\\\-1\\end{pmatrix}\\right) = \\frac{1}{2}\\begin{pmatrix}6\\\\1\\end{pmatrix} = \\begin{pmatrix}3\\\\0.5\\end{pmatrix}\\,\\mathrm{m} $$\n质心的速度通过对其位置对时间求导得到：\n$$ \\mathbf{v}_{\\mathrm{COM}} = \\frac{d\\mathbf{r}_{\\mathrm{COM}}}{dt} = \\frac{1}{2} \\left( \\frac{d\\mathbf{r}_P}{dt} + \\frac{d\\mathbf{r}_Q}{dt} \\right) = \\frac{\\mathbf{v}_P + \\mathbf{v}_Q}{2} $$\n这种简单的平均之所以有效，特别是因为质心是几何中点。代入给定的速度：\n$$ \\mathbf{v}_{\\mathrm{COM}} = \\frac{1}{2} \\left( \\begin{pmatrix}3\\\\7\\end{pmatrix} + \\begin{pmatrix}9\\\\15\\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix}12\\\\22\\end{pmatrix} = \\begin{pmatrix}6\\\\11\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}} $$\n所以，质心速度的分量是 $v_{\\mathrm{COM},x} = 6\\,\\mathrm{\\tfrac{m}{s}}$ 和 $v_{\\mathrm{COM},y} = 11\\,\\mathrm{\\tfrac{m}{s}}$。\n\n最后，要求的结果是行矩阵 $\\begin{pmatrix}\\omega  v_{\\mathrm{COM},x}  v_{\\mathrm{COM},y}\\end{pmatrix}$：\n$$ \\begin{pmatrix}2  6  11\\end{pmatrix} $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  6  11\n\\end{pmatrix}\n}\n$$", "id": "2914505"}, {"introduction": "在掌握了基本的相对速度关系后，第二个实践将引导我们解决一个在实验和计算力学中更为高级和常见的逆问题。假设我们能够测量或计算出刚体上几个点的瞬时速度和加速度，我们将学习如何构建并求解一个线性方程组，从而反演出整个刚体的完整运动学状态，特别是其角速度向量 $\\omega$ 和角加速度向量 $\\dot{\\omega}$。该方法展示了如何从离散的局部测量数据中提取出全局的运动参数。[@problem_id:2914495]", "problem": "一个刚体在三维空间中运动。刚体上的三个质点，标记为 $A$、$B$ 和 $C$，固定在相对于刚体的位置上。在固连于刚体的坐标系（体坐标系）中，它们的位置向量是恒定的，由 $A_{0} = [0,\\,0,\\,0]^{\\mathsf{T}}\\,\\mathrm{m}$、$B_{0} = [1,\\,2,\\,-1]^{\\mathsf{T}}\\,\\mathrm{m}$ 和 $C_{0} = [-2,\\,1,\\,3]^{\\mathsf{T}}\\,\\mathrm{m}$ 给出。任意固连于刚体的向量 $r_{0}$ 在惯性坐标系中的位置由下式描述\n$$\nr(t) \\;=\\; c(t) \\;+\\; R(t)\\,r_{0},\n$$\n其中平移为 $c(t) = [\\,t^{2},\\ \\ln(1+t),\\ \\exp(-t)\\,]^{\\mathsf{T}}\\,\\mathrm{m}$，旋转为\n$$\nR(t) \\;=\\; R_{z}\\!\\big(\\theta(t)\\big)\\,R_{x}\\!\\big(\\varphi(t)\\big), \\quad \\theta(t) = t^{2}\\ \\text{(radians)}, \\quad \\varphi(t) = t\\ \\text{(radians)}.\n$$\n此处 $R_{z}(\\cdot)$ 和 $R_{x}(\\cdot)$ 分别表示绕惯性 $z$ 轴和 $x$ 轴的正常旋转。考虑瞬时 $t_{0} = 1\\,\\mathrm{s}$。\n\n从刚体速度场和加速度场的基本定义出发，构建一个线性系统，将瞬时角速度向量 $\\omega(t_{0})$ 和瞬时角加速度向量 $\\dot{\\omega}(t_{0})$ 与 $t_{0}$ 时刻各点速度和加速度的可测量差异联系起来。使用点 $A$ 作为参考点。\n\n为方便起见，提供了以下通过对给定轨迹求导并在 $t_{0}=1\\,\\mathrm{s}$ 时求值得到的量：\n- 相对位置向量：\n$$\nr_{BA}(t_{0}) \\;=\\; r_{B}(t_{0}) - r_{A}(t_{0}) \\;=\\; \\begin{bmatrix} -1.0770685392 \\\\ 1.8799728616 \\\\ 1.1426396637 \\end{bmatrix}\\,\\mathrm{m}, \n\\qquad\nr_{CA}(t_{0}) \\;=\\; r_{C}(t_{0}) - r_{A}(t_{0}) \\;=\\; \\begin{bmatrix} 0.5889669297 \\\\ -2.7549615281 \\\\ 2.4623779025 \\end{bmatrix}\\,\\mathrm{m}.\n$$\n- 速度：\n$$\nv_{A}(t_{0}) \\;=\\; \\begin{bmatrix} 2 \\\\ 0.5 \\\\ -0.3678794412 \\end{bmatrix}\\,\\mathrm{m/s},\\quad\nv_{B}(t_{0}) \\;=\\; \\begin{bmatrix} -0.7984476 \\\\ -2.2715079235 \\\\ 1.554194559 \\end{bmatrix}\\,\\mathrm{m/s},\\quad\nv_{C}(t_{0}) \\;=\\; \\begin{bmatrix} 9.581942 \\\\ 0.347505401 \\\\ -2.351029441 \\end{bmatrix}\\,\\mathrm{m/s}.\n$$\n- 加速度：\n$$\na_{A}(t_{0}) \\;=\\; \\begin{bmatrix} 2 \\\\ -0.25 \\\\ 0.3678794412 \\end{bmatrix}\\,\\mathrm{m/s^{2}},\\quad\na_{B}(t_{0}) \\;=\\; \\begin{bmatrix} 6.6352317 \\\\ -7.1160059 \\\\ -0.774760223 \\end{bmatrix}\\,\\mathrm{m/s^{2}},\\quad\na_{C}(t_{0}) \\;=\\; \\begin{bmatrix} 8.806197325 \\\\ 21.307876616 \\\\ -2.094498461 \\end{bmatrix}\\,\\mathrm{m/s^{2}}.\n$$\n\n仅使用速度/加速度差异与角速度/角加速度之间的刚体运动学关系，确定 $t_{0} = 1\\,\\mathrm{s}$ 时的瞬时角速度向量 $\\omega(t_{0})$ 和角加速度向量 $\\dot{\\omega}(t_{0})$。将最终数值分量的单位表示为 $\\omega(t_{0})$ 的弧度/秒和 $\\dot{\\omega}(t_{0})$ 的弧度/秒平方，并将答案四舍五入到四位有效数字。按顺序 $\\big(\\omega_{x},\\,\\omega_{y},\\,\\omega_{z},\\,\\dot{\\omega}_{x},\\,\\dot{\\omega}_{y},\\,\\dot{\\omega}_{z}\\big)$ 报告这六个分量。", "solution": "必须首先验证问题陈述的科学合理性、一致性和完整性。\n\n步骤 1：提取已知条件\n已知条件如下：\n- 一个带有三个质点 $A$、$B$、$C$ 的刚体。\n- 固连于刚体的位置向量：$A_{0} = [0,\\,0,\\,0]^{\\mathsf{T}}\\,\\mathrm{m}$、$B_{0} = [1,\\,2,\\,-1]^{\\mathsf{T}}\\,\\mathrm{m}$ 和 $C_{0} = [-2,\\,1,\\,3]^{\\mathsf{T}}\\,\\mathrm{m}$。\n- 运动学变换：$r(t) = c(t) + R(t)r_{0}$。\n- 平移向量：$c(t) = [t^{2}, \\ln(1+t), \\exp(-t)]^{\\mathsf{T}}\\,\\mathrm{m}$。\n- 旋转矩阵：$R(t) = R_{z}(\\theta(t))R_{x}(\\varphi(t))$，其中 $\\theta(t) = t^{2}$ 弧度，$\\varphi(t) = t$ 弧度。\n- 关注的瞬时：$t_{0} = 1\\,\\mathrm{s}$。\n- 在 $t_{0} = 1\\,\\mathrm{s}$ 时提供的数值数据：\n  - $r_{BA}(t_{0}) = [-1.0770685392, 1.8799728616, 1.1426396637]^{\\mathsf{T}}\\,\\mathrm{m}$\n  - $r_{CA}(t_{0}) = [0.5889669297, -2.7549615281, 2.4623779025]^{\\mathsf{T}}\\,\\mathrm{m}$\n  - $v_{A}(t_{0}) = [2, 0.5, -0.3678794412]^{\\mathsf{T}}\\,\\mathrm{m/s}$\n  - $v_{B}(t_{0}) = [-0.7984476, -2.2715079235, 1.554194559]^{\\mathsf{T}}\\,\\mathrm{m/s}$\n  - $v_{C}(t_{0}) = [9.581942, 0.347505401, -2.351029441]^{\\mathsf{T}}\\,\\mathrm{m/s}$\n  - $a_{A}(t_{0}) = [2, -0.25, 0.3678794412]^{\\mathsf{T}}\\,\\mathrm{m/s^{2}}$\n  - $a_{B}(t_{0}) = [6.6352317, -7.1160059, -0.774760223]^{\\mathsf{T}}\\,\\mathrm{m/s^{2}}$\n  - $a_{C}(t_{0}) = [8.806197325, 21.307876616, -2.094498461]^{\\mathsf{T}}\\,\\mathrm{m/s^{2}}$\n- 任务是仅使用速度和加速度差异的运动学关系以及提供的数值数据来确定角速度 $\\omega(t_{0})$ 和角加速度 $\\dot{\\omega}(t_{0})$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于标准的刚体运动学。验证的要点是检查所提供的数值数据是否与 $c(t)$ 和 $R(t)$ 的解析表达式一致。\n角速度可以从 $R(t) = R_z(\\theta(t))R_x(\\varphi(t))$ 导出。总角速度为 $\\omega(t) = \\dot{\\theta}(t)\\hat{k} + R_z(\\theta(t))(\\dot{\\varphi}(t)\\hat{i})$。用向量形式表示，即为 $\\omega(t) = [\\dot{\\varphi}(t)\\cos(\\theta(t)),\\, \\dot{\\varphi}(t)\\sin(\\theta(t)),\\, \\dot{\\theta}(t)]^{\\mathsf{T}}$。\n在 $t_0=1\\,\\mathrm{s}$ 时：$\\theta(1)=1$, $\\dot{\\theta}(1)=2$, $\\ddot{\\theta}(1)=2$；$\\varphi(1)=1$, $\\dot{\\varphi}(1)=1$, $\\ddot{\\varphi}(1)=0$。\n这得出 $\\omega(1) = [\\cos(1), \\sin(1), 2]^{\\mathsf{T}} \\approx [0.540302, 0.841471, 2]^{\\mathsf{T}}\\,\\mathrm{rad/s}$。\n角加速度为 $\\dot{\\omega}(t) = d/dt[\\dot{\\varphi}\\cos\\theta, \\dot{\\varphi}\\sin\\theta, \\dot{\\theta}]^{\\mathsf{T}} = [\\ddot{\\varphi}\\cos\\theta - \\dot{\\varphi}\\dot{\\theta}\\sin\\theta, \\ddot{\\varphi}\\sin\\theta + \\dot{\\varphi}\\dot{\\theta}\\cos\\theta, \\ddot{\\theta}]^{\\mathsf{T}}$。\n在 $t_0=1\\,\\mathrm{s}$ 时，$\\dot{\\omega}(1) = [-2\\sin(1), 2\\cos(1), 2]^{\\mathsf{T}} \\approx [-1.68294, 1.08060, 2]^{\\mathsf{T}}\\,\\mathrm{rad/s^2}$。\n经过全面检查，确认在 $t_0=1\\,\\mathrm{s}$ 时提供的所有关于位置、速度和加速度的数值，均与这些解析推导出的 $\\omega(1)$ 和 $\\dot{\\omega}(1)$ 以及基本运动学关系相符。该问题是自洽的、适定的，且没有矛盾。\n\n步骤 3：结论与行动\n问题是有效的。解题过程将按照要求，仅使用提供的数值数据，构建并求解线性系统。\n\n刚体上任意一点 $P$ 的速度可以通过以下公式与另一点 $Q$ 的速度相关联：\n$$\nv_P - v_Q = \\omega \\times (r_P - r_Q)\n$$\n其中 $\\omega$ 是刚体的瞬时角速度，$r_P, r_Q$ 是各点在惯性坐标系中的位置向量。\n\n以点 $A$ 为参考点，我们可以为点 $B$ 和 $C$ 写出：\n$$\nv_B - v_A = \\omega \\times (r_B - r_A) \\quad \\implies \\quad v_{BA} = \\omega \\times r_{BA}\n$$\n$$\nv_C - v_A = \\omega \\times (r_C - r_A) \\quad \\implies \\quad v_{CA} = \\omega \\times r_{CA}\n$$\n叉乘运算可以用矩阵乘法表示。对于向量 $u=[u_x, u_y, u_z]^{\\mathsf{T}}$ 和 $v=[v_x, v_y, v_z]^{\\mathsf{T}}$，$u \\times v = S(u)v$，其中 $S(u)$ 是反对称矩阵：\n$$\nS(u) = \\begin{pmatrix} 0  -u_z  u_y \\\\ u_z  0  -u_x \\\\ -u_y  u_x  0 \\end{pmatrix}\n$$\n注意 $u \\times v = -v \\times u$，因此 $S(u)v = -S(v)u$。速度方程可以写成：\n$$\nv_{BA} = -S(r_{BA})\\omega\n$$\n$$\nv_{CA} = -S(r_{CA})\\omega\n$$\n这两个向量方程可以叠加，形成一个包含 6 个方程的单一线性系统，用于求解 $\\omega = [\\omega_x, \\omega_y, \\omega_z]^{\\mathsf{T}}$ 的 3 个分量：\n$$\n\\begin{pmatrix} v_{BA} \\\\ v_{CA} \\end{pmatrix} = \\begin{pmatrix} -S(r_{BA}) \\\\ -S(r_{CA}) \\end{pmatrix} \\omega\n$$\n这是一个 $b = M\\omega$ 形式的超定系统，可以使用最小二乘法求解 $\\omega$，得到正规方程组：\n$$\n\\omega = (M^{\\mathsf{T}}M)^{-1}M^{\\mathsf{T}}b\n$$\n使用为 $t_0=1\\,\\mathrm{s}$ 提供的数值数据：\n$v_{BA} = v_B - v_A = [-2.79844760, -2.77150792, 1.92207400]^{\\mathsf{T}}\\,\\mathrm{m/s}$。\n$v_{CA} = v_C - v_A = [7.58194200, -0.15249460, -1.98315000]^{\\mathsf{T}}\\,\\mathrm{m/s}$。\n矩阵 $M$ 由 $r_{BA}(t_0)$ 和 $r_{CA}(t_0)$ 构造。求解该系统可得出 $\\omega(t_0)$ 的分量。\n\n类似地，两点之间的加速度差由下式给出：\n$$\na_P - a_Q = \\dot{\\omega} \\times (r_P - r_Q) + \\omega \\times (\\omega \\times (r_P - r_Q))\n$$\n其中 $\\dot{\\omega}$ 是瞬时角加速度。\n令 $a_{PQ} = a_P - a_Q$ 和 $r_{PQ} = r_P - r_Q$。我们重新整理方程以分离出含 $\\dot{\\omega}$ 的项：\n$$\na_{PQ} - \\omega \\times (\\omega \\times r_{PQ}) = \\dot{\\omega} \\times r_{PQ}\n$$\n我们定义一个修正的加速度差向量 $a'_{PQ} = a_{PQ} - \\omega \\times (\\omega \\times r_{PQ})$。方程变为 $a'_{PQ} = \\dot{\\omega} \\times r_{PQ}$，其数学形式与速度关系式相同。\n因此，我们可以为 $\\dot{\\omega}$ 构建一个类似的线性系统：\n$$\n\\begin{pmatrix} a'_{BA} \\\\ a'_{CA} \\end{pmatrix} = \\begin{pmatrix} -S(r_{BA}) \\\\ -S(r_{CA}) \\end{pmatrix} \\dot{\\omega}\n$$\n该系统为 $b' = M\\dot{\\omega}$，其中矩阵 M 与之前相同。解为：\n$$\n\\dot{\\omega} = (M^{\\mathsf{T}}M)^{-1}M^{\\mathsf{T}}b'\n$$\n为求解此问题，我们首先使用提供的加速度数据和第一步中求得的 $\\omega$ 值计算向量 $a'_{BA}$ 和 $a'_{CA}$。\n$a_{BA} = a_B - a_A = [4.63523170, -6.86600590, -1.14263966]^{\\mathsf{T}}\\,\\mathrm{m/s^2}$。\n$a_{CA} = a_C - a_A = [6.80619733, 21.55787662, -2.46237790]^{\\mathsf{T}}\\,\\mathrm{m/s^2}$。\n项 $\\omega \\times (\\omega \\times r)$ 使用向量三重积恒等式计算：$\\omega \\times (\\omega \\times r) = (\\omega \\cdot r)\\omega - (\\omega \\cdot \\omega)r$。\n数值求解这两个线性系统可得到所需的向量。\n\n对于 $\\omega(t_0)$：\n最小二乘解给出 $\\omega(t_0) = [0.540302, 0.841471, 2.000000]^{\\mathsf{T}}\\,\\mathrm{rad/s}$。\n\n对于 $\\dot{\\omega}(t_0)$：\n使用计算出的 $\\omega(t_0)$，我们计算向量 $a'_{BA}$ 和 $a'_{CA}$。第二个线性系统的解给出 $\\dot{\\omega}(t_0) = [-1.682942, 1.080604, 2.000000]^{\\mathsf{T}}\\,\\mathrm{rad/s^2}$。\n\n按要求将分量四舍五入到四位有效数字：\n$\\omega_x = 0.5403\\,\\mathrm{rad/s}$\n$\\omega_y = 0.8415\\,\\mathrm{rad/s}$\n$\\omega_z = 2.000\\,\\mathrm{rad/s}$\n$\\dot{\\omega}_x = -1.683\\,\\mathrm{rad/s^2}$\n$\\dot{\\omega}_y = 1.081\\,\\mathrm{rad/s^2}$\n$\\dot{\\omega}_z = 2.000\\,\\mathrm{rad/s^2}$\n\n最终答案以这六个分量的行矩阵形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5403  0.8415  2.000  -1.683  1.081  2.000\n\\end{pmatrix}\n}\n$$", "id": "2914495"}, {"introduction": "最后一个实践聚焦于材料力学和结构分析中的一个关键应用：从受污染的测量数据中校正并提取真实的变形信息。在实际测量或数值模拟中，节点的位移场往往同时包含了真实的变形和不必要的刚体运动，后者会干扰应力和应变的分析。我们将推导并应用一种最小二乘法，寻找一个“最佳拟合”的刚体运动（平动和转动），从而将其从总位移中分离出去，最终得到纯粹的、修正后的变形场。这个被称为“Procrustes问题”的技术对于精确分析实验和模拟数据至关重要。[@problem_id:2914458]", "problem": "给定一组具有已知参考位置和测量位移的质点（节点），这些位移受到未知的刚体运动污染。您的任务是推导、实现并评估一个最小二乘程序，该程序识别最佳拟合的刚体运动，并将其从测量的位移场中移除，只留下校正后（非刚体）的位移。完全在材料力学中刚体运动运动学的框架内进行工作，并从基本原理推导出所有必要的计算。\n\n起点和定义（基本依据）：\n- 在空间维度 $d$ 中的刚体运动由一个旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(d)$（特殊正交群，因此 $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$ 且 $\\det \\mathbf{R} = 1$）和一个平移向量 $\\mathbf{t} \\in \\mathbb{R}^d$ 描述。\n- 对于一个参考点 $\\mathbf{x}_i \\in \\mathbb{R}^d$，刚性移动后的位置是 $\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}$，相应的刚性位移是 $\\left(\\mathbf{R} - \\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t}$。\n- 节点 $i$ 处的测量位移是 $\\mathbf{u}_i^{\\mathrm{meas}} \\in \\mathbb{R}^d$，测量的变形后位置是 $\\mathbf{y}_i = \\mathbf{x}_i + \\mathbf{u}_i^{\\mathrm{meas}}$。\n\n问题要求：\n- 从第一性原理出发，提出并求解约束最小二乘问题，通过最小化测量变形后位置 $\\mathbf{y}_i$ 与刚性变换后参考位置 $\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}$ 之间的残差平方和，来识别最佳拟合的 $(\\mathbf{R}, \\mathbf{t})$，约束条件为 $\\mathbf{R} \\in \\mathrm{SO}(d)$。\n- 对于固定的 $\\mathbf{R}$，根据 $\\{\\mathbf{x}_i\\}$ 和 $\\{\\mathbf{y}_i\\}$ 的质心推导出平移向量 $\\mathbf{t}$，并仅使用正交性约束和最小二乘最优性推导出最优的 $\\mathbf{R}$（在问题陈述中不得假定使用任何快捷公式）。\n- 在识别出 $(\\mathbf{R}, \\mathbf{t})$ 后，计算每个节点的位移刚性部分为 $\\mathbf{u}_i^{\\mathrm{rigid}} = \\left(\\mathbf{R} - \\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t}$，并得到校正后的位移为 $\\mathbf{u}_i^{\\mathrm{corr}} = \\mathbf{u}_i^{\\mathrm{meas}} - \\mathbf{u}_i^{\\mathrm{rigid}}$。\n- 通过校正后位移的均方根 (RMS) 范数来量化残差，即 $\\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\lVert \\mathbf{u}_i^{\\mathrm{corr}} \\rVert_2^2}$。\n- 报告与 $\\mathbf{R}$ 相关的主旋转角：\n  - 对于 $d=2$，报告唯一的角度 $\\theta \\in [0,\\pi]$，使得 $\\mathbf{R} = \\begin{bmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{bmatrix}$。\n  - 对于 $d=3$，报告由 $\\cos\\theta = \\frac{\\mathrm{tr}(\\mathbf{R}) - 1}{2}$ 定义的角度 $\\theta \\in [0,\\pi]$。\n- 物理单位：所有长度必须以米 $\\mathrm{m}$ 为单位，报告的 RMS 残差也必须以米 $\\mathrm{m}$ 为单位。所有角度必须以弧度 $\\mathrm{rad}$ 报告。\n\n边界情况处理策略：\n- 如果数据是退化的（例如，所有中心化后的点重合，导致协方差矩阵秩亏），您仍必须返回一个有效的 $\\mathbf{R} \\in \\mathrm{SO}(d)$ 和 $\\mathbf{t} \\in \\mathbb{R}^d$，以最小化最小二乘目标函数。在所有中心化后的参考点都为零的完全无信息情况下，可以返回 $\\mathbf{R} = \\mathbf{I}$ 和等于质心差的 $\\mathbf{t}$。\n\n测试套件：\n对于下述每个测试用例，使用提供的参数合成测量位移，然后仅从合成的测量值中估计 $(\\mathbf{R}, \\mathbf{t})$（不要在估计中直接使用污染参数），校正位移，并按规定报告输出。\n\n- 测试用例 $1$（二维，带微小非刚性分量的一般刚体运动）：\n  - 维度 $d = 2$。\n  - 参考节点（单位：米 $\\mathrm{m}$）：$\\mathbf{x}_1 = (0, 0)$，$\\mathbf{x}_2 = (1, 0)$，$\\mathbf{x}_3 = (1, 1)$，$\\mathbf{x}_4 = (0, 1)$。\n  - 刚体运动参数：绕平面外轴线的旋转角 $\\theta = 0.2$ 弧度 $\\mathrm{rad}$，平移 $\\mathbf{t} = (0.05, -0.03)$ 米 $\\mathrm{m}$。\n  - 微小非刚性映射：$\\mathbf{u}^{\\mathrm{true}}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$，其中 $\\mathbf{B} = \\mathrm{diag}(0.001, -0.0005)$（无量纲）。\n  - 测量位移：$\\mathbf{u}_i^{\\mathrm{meas}} = \\left(\\mathbf{R}(\\theta)-\\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t} + \\mathbf{B}\\mathbf{x}_i$。\n\n- 测试用例 $2$（三维，带微小非刚性分量的一般轴-角刚体运动）：\n  - 维度 $d = 3$。\n  - 参考节点（单位：米 $\\mathrm{m}$）：$\\mathbf{x}_1 = (0, 0, 0)$，$\\mathbf{x}_2 = (1, 0, 0)$，$\\mathbf{x}_3 = (0, 1, 0)$，$\\mathbf{x}_4 = (0, 0, 1)$，$\\mathbf{x}_5 = (1, 1, 1)$。\n  - 刚体运动参数：轴 $\\mathbf{a} = \\frac{1}{\\sqrt{14}}(1, 2, 3)$（无量纲），角度 $\\theta = 0.3$ 弧度 $\\mathrm{rad}$，平移 $\\mathbf{t} = (-0.02, 0.04, 0.03)$ 米 $\\mathrm{m}$。\n  - 通过 Rodrigues 公式旋转：$\\mathbf{R} = \\cos\\theta\\,\\mathbf{I} + \\sin\\theta\\,[\\mathbf{a}]_\\times + (1-\\cos\\theta)\\,\\mathbf{a}\\mathbf{a}^\\mathsf{T}$，其中 $[\\mathbf{a}]_\\times$ 是斜对称矩阵，使得 $[\\mathbf{a}]_\\times \\mathbf{v} = \\mathbf{a} \\times \\mathbf{v}$。\n  - 微小非刚性映射：$\\mathbf{u}^{\\mathrm{true}}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$，其中 $\\mathbf{B} = \\mathrm{diag}(0.0008, -0.0006, 0.0004)$（无量纲）。\n  - 测量位移：$\\mathbf{u}_i^{\\mathrm{meas}} = \\left(\\mathbf{R}-\\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t} + \\mathbf{B}\\mathbf{x}_i$。\n\n- 测试用例 $3$（二维，纯平移）：\n  - 维度 $d = 2$。\n  - 参考节点（单位：米 $\\mathrm{m}$）：$\\mathbf{x}_1 = (0, 0)$，$\\mathbf{x}_2 = (2, 0)$，$\\mathbf{x}_3 = (0, 2)$。\n  - 刚体运动参数：旋转角 $\\theta = 0$ 弧度 $\\mathrm{rad}$，平移 $\\mathbf{t} = (0.1, -0.05)$ 米 $\\mathrm{m}$。\n  - 非刚性映射：$\\mathbf{B} = \\mathbf{0}$。\n  - 测量位移：$\\mathbf{u}_i^{\\mathrm{meas}} = \\left(\\mathbf{R}(\\theta)-\\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t}$。\n\n- 测试用例 $4$（三维，退化几何：所有节点重合）：\n  - 维度 $d = 3$。\n  - 参考节点（单位：米 $\\mathrm{m}$）：$\\mathbf{x}_1 = (2, 2, 2)$，$\\mathbf{x}_2 = (2, 2, 2)$，$\\mathbf{x}_3 = (2, 2, 2)$，$\\mathbf{x}_4 = (2, 2, 2)$。\n  - 刚体运动参数：选择任意旋转（此处不可识别）；平移 $\\mathbf{t} = (0.01, 0.02, -0.03)$ 米 $\\mathrm{m}$。\n  - 非刚性映射：$\\mathbf{B} = \\mathbf{0}$。\n  - 测量位移：$\\mathbf{u}_i^{\\mathrm{meas}} = \\mathbf{t}$。\n\n所需输出：\n- 对于每个测试用例 $k \\in \\{1,2,3,4\\}$，计算并返回一对浮点数：\n  - 如上定义的主旋转角大小 $\\theta_k$（单位为弧度 $\\mathrm{rad}$）。\n  - 校正后位移的 RMS 范数（单位为米 $\\mathrm{m}$），即 $\\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\lVert \\mathbf{u}_i^{\\mathrm{corr}} \\rVert_2^2}$。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。按顺序连接所有测试用例的结果，将列表展平，例如 $[\\theta_1,\\mathrm{RMS}_1,\\theta_2,\\mathrm{RMS}_2,\\theta_3,\\mathrm{RMS}_3,\\theta_4,\\mathrm{RMS}_4]$。所有角度必须以弧度 $\\mathrm{rad}$ 为单位，所有 RMS 值必须以米 $\\mathrm{m}$ 为单位。", "solution": "该问题要求推导并实现一个最小二乘程序，以确定测量位移场中的刚体运动分量。该解决方案必须从刚体运动学和优化的第一性原理推导得出。\n\n设 $N$ 个参考位置的集合为 $\\{\\mathbf{x}_i \\in \\mathbb{R}^d\\}_{i=1}^N$，相应的测量变形后位置为 $\\{\\mathbf{y}_i \\in \\mathbb{R}^d\\}_{i=1}^N$，其中 $d$ 是空间维度。刚体运动由一个旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(d)$ 和一个平移向量 $\\mathbf{t} \\in \\mathbb{R}^d$ 定义。特殊正交群 $\\mathrm{SO}(d)$ 由满足 $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$ 和 $\\det(\\mathbf{R}) = 1$ 的矩阵组成。目标是找到一对 $(\\mathbf{R}, \\mathbf{t})$，以最小化测量位置 $\\mathbf{y}_i$ 与刚性变换后的参考位置 $\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}$ 之间的欧几里得距离平方和。这定义了以下约束最小二乘问题：\n$$ \\underset{\\mathbf{R} \\in \\mathrm{SO}(d), \\mathbf{t} \\in \\mathbb{R}^d}{\\text{minimize}} \\quad S(\\mathbf{R}, \\mathbf{t}) = \\sum_{i=1}^{N} \\lVert \\mathbf{y}_i - (\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}) \\rVert_2^2 $$\n\n首先，我们针对固定的旋转矩阵 $\\mathbf{R}$ 求解最优平移向量 $\\mathbf{t}$。通过将二次函数 $S$ 对 $\\mathbf{t}$ 的梯度设为零来找到其最小值：\n$$ \\frac{\\partial S}{\\partial \\mathbf{t}} = \\sum_{i=1}^{N} \\frac{\\partial}{\\partial \\mathbf{t}} \\left( (\\mathbf{y}_i - \\mathbf{R}\\mathbf{x}_i - \\mathbf{t})^\\mathsf{T} (\\mathbf{y}_i - \\mathbf{R}\\mathbf{x}_i - \\mathbf{t}) \\right) = \\sum_{i=1}^{N} -2(\\mathbf{y}_i - \\mathbf{R}\\mathbf{x}_i - \\mathbf{t}) = \\mathbf{0} $$\n这可以简化为：\n$$ \\sum_{i=1}^{N} \\mathbf{y}_i - \\mathbf{R}\\sum_{i=1}^{N} \\mathbf{x}_i - N\\mathbf{t} = \\mathbf{0} $$\n我们将参考点云和变形点云的质心定义为 $\\bar{\\mathbf{x}} = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{x}_i$ 和 $\\bar{\\mathbf{y}} = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{y}_i$。将它们代入方程得到：\n$$ N\\bar{\\mathbf{y}} - N\\mathbf{R}\\bar{\\mathbf{x}} - N\\mathbf{t} = \\mathbf{0} $$\n$$ \\mathbf{t} = \\bar{\\mathbf{y}} - \\mathbf{R}\\bar{\\mathbf{x}} $$\n这表明最优平移向量 $\\mathbf{t}^*$ 将旋转后的参考构型的质心映射到变形构型的质心。\n\n接下来，我们将 $\\mathbf{t}^*$ 代回目标函数 $S$。我们将中心化坐标向量定义为 $\\mathbf{x}'_i = \\mathbf{x}_i - \\bar{\\mathbf{x}}$ 和 $\\mathbf{y}'_i = \\mathbf{y}_i - \\bar{\\mathbf{y}}$。范数内的项变为：\n$$ \\mathbf{y}_i - (\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}^*) = (\\mathbf{y}_i - \\bar{\\mathbf{y}}) - \\mathbf{R}(\\mathbf{x}_i - \\bar{\\mathbf{x}}) = \\mathbf{y}'_i - \\mathbf{R}\\mathbf{x}'_i $$\n最小化问题现在简化为寻找最优旋转 $\\mathbf{R}$：\n$$ \\underset{\\mathbf{R} \\in \\mathrm{SO}(d)}{\\text{minimize}} \\quad S(\\mathbf{R}) = \\sum_{i=1}^N \\lVert \\mathbf{y}'_i - \\mathbf{R}\\mathbf{x}'_i \\rVert_2^2 $$\n我们展开平方范数：\n$$ \\lVert \\mathbf{y}'_i - \\mathbf{R}\\mathbf{x}'_i \\rVert_2^2 = (\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{y}'_i - 2(\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i + (\\mathbf{x}'_i)^\\mathsf{T}\\mathbf{R}^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i = \\lVert \\mathbf{y}'_i \\rVert_2^2 - 2(\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i + \\lVert \\mathbf{x}'_i \\rVert_2^2 $$\n这里我们使用了属性 $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$。对所有点求和，目标函数变为：\n$$ S(\\mathbf{R}) = \\sum_{i=1}^N \\lVert \\mathbf{y}'_i \\rVert_2^2 + \\sum_{i=1}^N \\lVert \\mathbf{x}'_i \\rVert_2^2 - 2 \\sum_{i=1}^N (\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i $$\n前两项相对于 $\\mathbf{R}$ 是常数。因此，最小化 $S(\\mathbf{R})$ 等价于最大化项 $\\sum_{i=1}^N (\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i$。利用迹算子的循环特性，我们可以将其重写为：\n$$ \\sum_{i=1}^N \\text{tr}((\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i) = \\sum_{i=1}^N \\text{tr}(\\mathbf{R}\\mathbf{x}'_i(\\mathbf{y}'_i)^\\mathsf{T}) = \\text{tr} \\left( \\mathbf{R} \\sum_{i=1}^N \\mathbf{x}'_i(\\mathbf{y}'_i)^\\mathsf{T} \\right) $$\n我们定义 $d \\times d$ 协方差矩阵 $\\mathbf{H} = \\sum_{i=1}^N \\mathbf{x}'_i(\\mathbf{y}'_i)^\\mathsf{T}$。问题现在是找到一个 $\\mathbf{R} \\in \\mathrm{SO}(d)$ 来最大化 $\\text{tr}(\\mathbf{R}\\mathbf{H})$。\n\n为了解决这个约束最大化问题，我们使用 $\\mathbf{H}$ 的奇异值分解 (SVD)，即 $\\mathbf{H} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\mathsf{T}$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是正交矩阵，$\\boldsymbol{\\Sigma}$ 是非负奇异值的对角矩阵。\n$$ \\text{tr}(\\mathbf{R}\\mathbf{H}) = \\text{tr}(\\mathbf{R}\\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\mathsf{T}) = \\text{tr}(\\mathbf{V}^\\mathsf{T}\\mathbf{R}\\mathbf{U}\\boldsymbol{\\Sigma}) $$\n令 $\\mathbf{Z} = \\mathbf{V}^\\mathsf{T}\\mathbf{R}\\mathbf{U}$。由于 $\\mathbf{U}$、$\\mathbf{V}$ 和 $\\mathbf{R}$ 是正交的，$\\mathbf{Z}$ 也是一个正交矩阵。目标变为最大化 $\\text{tr}(\\mathbf{Z}\\boldsymbol{\\Sigma}) = \\sum_{j=1}^d Z_{jj}\\sigma_j$。由于 $\\mathbf{Z}$ 是正交的，所以 $|Z_{jj}| \\le 1$，并且奇异值 $\\sigma_j \\ge 0$。当 $Z_{jj}$ 尽可能大时，即 $Z_{jj}=1$ 时，获得最大值。这在 $\\mathbf{Z}=\\mathbf{I}$ 时实现。\n从 $\\mathbf{Z}=\\mathbf{I}$，我们在正交群 $\\mathrm{O}(d)$ 中找到最优旋转：\n$$ \\mathbf{V}^\\mathsf{T}\\mathbf{R}\\mathbf{U} = \\mathbf{I} \\implies \\mathbf{R} = \\mathbf{V}\\mathbf{I}\\mathbf{U}^\\mathsf{T} = \\mathbf{V}\\mathbf{U}^\\mathsf{T} $$\n我们必须确保 $\\mathbf{R} \\in \\mathrm{SO}(d)$，即 $\\det(\\mathbf{R})=1$。我们有 $\\det(\\mathbf{R}) = \\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T}) = \\det(\\mathbf{V})\\det(\\mathbf{U}^\\mathsf{T}) = \\det(\\mathbf{V})\\det(\\mathbf{U})$。SVD 算法可能产生行列式为 $+1$ 或 $-1$ 的 $\\mathbf{U}$ 和 $\\mathbf{V}$。\n如果 $\\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T}) = 1$，那么 $\\mathbf{R} = \\mathbf{V}\\mathbf{U}^\\mathsf{T}$ 是正确的解。\n如果 $\\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T}) = -1$，解对应于一个反射。最近的真旋转是通过修改 $\\mathbf{R}$ 来反转其行列式，同时最小化地减少迹值 $\\text{tr}(\\mathbf{R}\\mathbf{H})$ 来找到的。这通过翻转与最小奇异值相关联的分量的符号来实现。假设 $\\sigma_d$ 是最小的奇异值，$\\mathrm{SO}(d)$ 中的最优解是：\n$$ \\mathbf{R} = \\mathbf{V} \\mathbf{S} \\mathbf{U}^\\mathsf{T}, \\quad \\text{where} \\quad \\mathbf{S} = \\text{diag}(1, 1, \\dots, 1, \\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T})) $$\n这确保了在有问题的情况下 $\\det(\\mathbf{R}) = \\det(\\mathbf{V})\\det(\\mathbf{S})\\det(\\mathbf{U}^\\mathsf{T}) = \\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T})\\det(\\mathbf{S}) = (-1)(-1) = 1$。\n\n一旦找到最优的 $(\\mathbf{R}, \\mathbf{t})$，节点 $i$ 的刚性位移为 $\\mathbf{u}_i^{\\mathrm{rigid}} = (\\mathbf{R} - \\mathbf{I})\\mathbf{x}_i + \\mathbf{t}$。校正后的（非刚性）位移是测量位移与刚性位移之差：\n$$ \\mathbf{u}_i^{\\mathrm{corr}} = \\mathbf{u}_i^{\\mathrm{meas}} - \\mathbf{u}_i^{\\mathrm{rigid}} = (\\mathbf{y}_i - \\mathbf{x}_i) - ((\\mathbf{R} - \\mathbf{I})\\mathbf{x}_i + \\mathbf{t}) = \\mathbf{y}_i - (\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}) $$\n残差由这些校正后位移的均方根 (RMS) 范数量化：\n$$ \\text{RMS} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\lVert \\mathbf{u}_i^{\\mathrm{corr}} \\rVert_2^2} $$\n主旋转角 $\\theta \\in [0, \\pi]$ 是根据估计的旋转矩阵 $\\mathbf{R}$ 的迹计算的。对于 $d=2$，$\\theta = \\arccos(\\frac{\\mathrm{tr}(\\mathbf{R})}{2})$。对于 $d=3$，$\\theta = \\arccos(\\frac{\\mathrm{tr}(\\mathbf{R}) - 1}{2})$。在所有中心化后的参考点都为零的退化情况下，协方差矩阵 $\\mathbf{H}$ 是零矩阵。它的 SVD 不是唯一的，但标准实现通常会产生 $\\mathbf{U}=\\mathbf{V}=\\mathbf{I}$，这导致 $\\mathbf{R}=\\mathbf{I}$ 和 $\\theta=0$，满足了问题的边界情况处理策略。", "answer": "$$\n\\boxed{[0.20000000, 0.00067082, 0.30000000, 0.00067646, 0.00000000, 0.00000000, 0.00000000, 0.00000000]}\n$$", "id": "2914458"}]}