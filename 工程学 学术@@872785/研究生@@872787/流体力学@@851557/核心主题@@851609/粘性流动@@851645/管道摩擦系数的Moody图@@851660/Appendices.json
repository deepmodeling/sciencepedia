{"hands_on_practices": [{"introduction": "穆迪图的核心是科尔布鲁克-怀特方程 (Colebrook-White equation)，它巧妙地融合了粘性效应和壁面粗糙度对湍流摩擦的影响。为了深入理解这两个因素如何相互作用并决定流动状态，我们可以通过一个思想实验来定义一个“过渡”点，即在这点上，粘性底层贡献的摩擦与管道壁面粗糙度贡献的摩擦相等。通过推导这个过渡雷诺数 $Re_t$ 的表达式 [@problem_id:642825]，您将能够从解析层面剖析科尔布鲁克方程的内在结构，加深对穆迪图中不同区域物理意义的理解。", "problem": "管道中湍流的达西摩擦因子 $f$ 由科尔布鲁克-怀特方程隐式定义，该方程可使用自然对数表示为：\n$$\n\\frac{1}{\\sqrt{f}} = -A \\ln \\left( \\frac{\\epsilon/D}{B} + \\frac{C}{Re \\sqrt{f}} \\right)\n$$\n此处，$Re$ 是雷诺数，$\\epsilon/D$ 是管道的相对粗糙度，$A$、$B$ 和 $C$ 是无量纲的正经验常数。对数自变量中的两个相加项 $\\frac{\\epsilon/D}{B}$ 和 $\\frac{C}{Re \\sqrt{f}}$ 分别代表了由管壁粗糙度和粘性底层对摩擦的贡献。\n\n对于给定的相对粗糙度 $\\epsilon/D$，可以定义一个特征转变雷诺数 $Re_t$，其值为当这两种效应对对数自变量的贡献相等时的 $Re$ 值。该点标记了摩擦由粘性效应主导的区域和由粗糙度主导的区域之间的概念性边界。\n\n推导这个转变雷诺数 $Re_t$ 的表达式，用相对粗糙度 $\\epsilon/D$ 以及常数 $A$、$B$ 和 $C$ 来表示。", "solution": "我们从科尔布鲁克-怀特形式开始，\n$$\\frac{1}{\\sqrt{f}}=-A\\ln\\!\\Bigl(\\frac{\\epsilon/D}{B}+\\frac{C}{Re\\,\\sqrt{f}}\\Bigr)\\,. $$  \n定义对数内的两个贡献项：\n$$R_{\\rm rough}=\\frac{\\epsilon/D}{B},\\qquad R_{\\rm visc}=\\frac{C}{Re\\,\\sqrt{f}}\\,. $$  \n在转变雷诺数 $Re_t$ 处，这些贡献项相等，\n$$\\frac{\\epsilon/D}{B}=\\frac{C}{Re_t\\,\\sqrt{f}}\\,. $$  \n求解 $Re_t$：\n$$Re_t\\,\\sqrt{f}=\\frac{C\\,B}{\\epsilon/D}\\quad\\Longrightarrow\\quad\nRe_t=\\frac{C\\,B}{(\\epsilon/D)\\,\\sqrt{f}}\\,. \\tag{1}$$  \n但在转变点，对数的自变量变为任一项的两倍，\n$$\\frac{1}{\\sqrt{f}}=-A\\ln\\!\\Bigl(2\\,\\frac{\\epsilon/D}{B}\\Bigr)\n\\quad\\Longrightarrow\\quad\n\\sqrt{f}=\\frac{1}{A\\,\\bigl[-\\ln\\!(2\\,\\epsilon/(D B))\\bigr]}\n=\\frac{1}{A\\,\\ln\\!\\bigl(\\tfrac{D B}{2\\epsilon}\\bigr)}\\,. $$  \n将此 $\\sqrt{f}$ 代入 (1) 中：\n$$Re_t\n=\\frac{C\\,B}{(\\epsilon/D)}\\;A\\,\\ln\\!\\Bigl(\\tfrac{D B}{2\\epsilon}\\Bigr)\n=\\frac{A\\,B\\,C\\,D}{\\epsilon}\\,\\ln\\!\\Bigl(\\frac{B\\,D}{2\\,\\epsilon}\\Bigr)\\,. $$\n因此，转变雷诺数为\n$$Re_t=\\frac{A B C D}{\\epsilon}\\,\\ln\\!\\Bigl(\\frac{B D}{2\\epsilon}\\Bigr)\\,. $$", "answer": "$$\\boxed{\\frac{A B C D}{\\epsilon}\\,\\ln\\!\\left(\\frac{B D}{2\\epsilon}\\right)}$$", "id": "642825"}, {"introduction": "科尔布鲁克-怀特方程是一个隐式方程，这意味着我们无法直接通过代数运算求解摩擦因子 $f$。在工程实践中，为了方便快速计算，显式近似公式具有极高的价值。这个练习 [@problem_id:642803] 将引导您将理论知识与数值方法相结合，利用割线法 (Secant method) 推导出一个全新的、精确的显式摩擦因子近似公式。通过这个过程，您不仅能练习数值分析技巧，还能体会到如何利用物理洞察力（选择合适的初始迭代点）来构建高效的工程计算工具。", "problem": "对于圆管中的湍流，达西摩擦因子 $f$ 由隐式的 Colebrook-White 方程给出：\n$$\n\\frac{1}{\\sqrt{f}} = -2 \\log_{10}\\left( \\frac{\\epsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f}} \\right)\n$$\n其中，$Re$ 是雷诺数，$\\epsilon$ 是管道内表面的绝对粗糙度，$D$ 是管道的内径。\n\n鉴于此方程的隐式性质，求 $f$ 的显式近似具有重要的实用价值。你的任务是推导出一个新的摩擦因子显式近似。\n\n首先，令 $x = 1/\\sqrt{f}$，并将 Colebrook-White 方程重写为一个求根问题 $F(x) = 0$，其中：\n$$\nF(x) = \\frac{2.51 x}{Re} - 10^{-x/2} + \\frac{\\epsilon/D}{3.7}\n$$\n\n应用一次割线法迭代来找到一个改进的近似值 $x_2$。割线法的迭代公式为：\n$$\nx_{k+1} = x_k - F(x_k) \\frac{x_k - x_{k-1}}{F(x_k) - F(x_{k-1})}\n$$\n\n使用以下两个具有物理意义的初始猜测值 $x_0$ 和 $x_1$：\n1.  令 $x_0$ 为完全粗糙湍流区（$Re \\to \\infty$）的解：\n    $$\n    x_0 = -2 \\log_{10}\\left(\\frac{\\epsilon/D}{3.7}\\right)\n    $$\n2.  令 $x_1$ 为从 $x_0$ 开始，对原始 Colebrook-White 方程进行一次定点迭代的结果：\n    $$\n    x_1 = -2 \\log_{10}\\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51 x_0}{Re}\\right)\n    $$\n\n你的目标是推导摩擦因子的显式近似 $f_{approx} = 1/x_2^2$，并将最终结果完全用 $x_0$ 和 $x_1$ 表示。", "solution": "该问题要求推导摩擦因子 $f_{approx}$ 的一个显式近似，该近似是通过对特定形式的 Colebrook-White 方程应用一次割线法迭代得到的。最终的摩擦因子应以给定的初始猜测值 $x_0$ 和 $x_1$ 表示。\n\n求根问题的函数如下所示：\n$$\nF(x) = \\frac{2.51 x}{Re} - 10^{-x/2} + \\frac{\\epsilon/D}{3.7}\n$$\n\n割线法求下一个迭代值 $x_2$ 的公式是：\n$$\nx_2 = x_1 - F(x_1) \\frac{x_1 - x_0}{F(x_1) - F(x_0)}\n$$\n\n初始猜测值为：\n$$\nx_0 = -2 \\log_{10}\\left(\\frac{\\epsilon/D}{3.7}\\right)\n$$\n$$\nx_1 = -2 \\log_{10}\\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51 x_0}{Re}\\right)\n$$\n\n推导过程分几步进行。首先，我们计算函数 $F(x)$ 在初始点 $x_0$ 和 $x_1$ 处的值。\n\n**步骤 1：计算 $F(x_0)$**\n\n根据 $x_0$ 的定义，我们可以写出：\n$$\n-\\frac{x_0}{2} = \\log_{10}\\left(\\frac{\\epsilon/D}{3.7}\\right)\n$$\n根据以 10 为底的对数的定义，这意味着：\n$$\n10^{-x_0/2} = \\frac{\\epsilon/D}{3.7}\n$$\n现在，将此代入 $F(x_0)$ 的表达式中：\n$$\nF(x_0) = \\frac{2.51 x_0}{Re} - 10^{-x_0/2} + \\frac{\\epsilon/D}{3.7} = \\frac{2.51 x_0}{Re} - \\left(\\frac{\\epsilon/D}{3.7}\\right) + \\frac{\\epsilon/D}{3.7}\n$$\n化简后得到：\n$$\nF(x_0) = \\frac{2.51 x_0}{Re}\n$$\n\n**步骤 2：计算 $F(x_1)$**\n\n类似地，根据 $x_1$ 的定义：\n$$\n-\\frac{x_1}{2} = \\log_{10}\\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51 x_0}{Re}\\right)\n$$\n这意味着：\n$$\n10^{-x_1/2} = \\frac{\\epsilon/D}{3.7} + \\frac{2.51 x_0}{Re}\n$$\n将此代入 $F(x_1)$ 的表达式中：\n$$\nF(x_1) = \\frac{2.51 x_1}{Re} - 10^{-x_1/2} + \\frac{\\epsilon/D}{3.7} = \\frac{2.51 x_1}{Re} - \\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51 x_0}{Re}\\right) + \\frac{\\epsilon/D}{3.7}\n$$\n化简此表达式可得：\n$$\nF(x_1) = \\frac{2.51 x_1}{Re} - \\frac{2.51 x_0}{Re} = \\frac{2.51}{Re}(x_1 - x_0)\n$$\n\n**步骤 3：应用割线法求 $x_2$**\n\n现在我们将 $F(x_0)$ 和 $F(x_1)$ 的表达式代入割线法公式：\n$$\nx_2 = x_1 - F(x_1) \\frac{x_1 - x_0}{F(x_1) - F(x_0)}\n$$\n$$\nx_2 = x_1 - \\frac{\\frac{2.51}{Re}(x_1 - x_0) (x_1 - x_0)}{\\frac{2.51}{Re}(x_1 - x_0) - \\frac{2.51 x_0}{Re}}\n$$\n我们可以消去分数中分子和分母的公因式 $\\frac{2.51}{Re}$：\n$$\nx_2 = x_1 - \\frac{(x_1 - x_0)^2}{(x_1 - x_0) - x_0} = x_1 - \\frac{(x_1 - x_0)^2}{x_1 - 2x_0}\n$$\n\n**步骤 4：简化 $x_2$ 的表达式**\n\n为了得到更紧凑的形式，我们合并各项：\n$$\nx_2 = \\frac{x_1(x_1 - 2x_0) - (x_1 - x_0)^2}{x_1 - 2x_0}\n$$\n展开分子：\n$$\nx_2 = \\frac{(x_1^2 - 2x_1 x_0) - (x_1^2 - 2x_1 x_0 + x_0^2)}{x_1 - 2x_0}\n$$\n$$\nx_2 = \\frac{x_1^2 - 2x_1 x_0 - x_1^2 + 2x_1 x_0 - x_0^2}{x_1 - 2x_0} = \\frac{-x_0^2}{x_1 - 2x_0}\n$$\n分子和分母同乘以 $-1$ 得到 $x_2$ 的最终简化表达式：\n$$\nx_2 = \\frac{x_0^2}{2x_0 - x_1}\n$$\n\n**步骤 5：确定摩擦因子 $f_{approx}$**\n\n$f$ 和 $x$ 之间的关系是 $x = 1/\\sqrt{f}$，这意味着 $f = 1/x^2$。因此，摩擦因子的新近似值为：\n$$\nf_{approx} = \\frac{1}{x_2^2} = \\left(\\frac{1}{x_2}\\right)^2\n$$\n代入 $x_2$ 的表达式：\n$$\nf_{approx} = \\left(\\frac{2x_0 - x_1}{x_0^2}\\right)^2\n$$\n这就是用 $x_0$ 和 $x_1$ 表示的 $f_{approx}$ 的最终推导表达式。", "answer": "$$\n\\boxed{\\left(\\frac{2x_0 - x_1}{x_0^2}\\right)^2}\n$$", "id": "642803"}, {"introduction": "尽管显式近似公式非常实用，但在许多需要高精度的现代工程应用中，我们必须对原始的科尔布鲁克方程进行直接数值求解。这是将理论转化为精确工程结果的关键一步，也是现代流体力学计算的标准做法。在本练习中 [@problem_id:2393395]，您将亲手编写代码，通过不动点迭代法 (fixed-point iteration) 这一强大的数值技术，为不同流动参数下的管流问题计算出精确的摩擦因子。这项实践将巩固您将复杂数学模型转化为可执行计算程序的能力，完整地模拟了工程师在解决实际管流问题时的核心工作流程。", "problem": "给定一个用于描述圆管中湍流的隐式 Colebrook 关系式，它定义了 Darcy–Weisbach 摩擦系数 $f$：\n$$\n\\frac{1}{\\sqrt{f}} \\;=\\; -2\\,\\log_{10}\\!\\left(\\frac{\\epsilon/D}{3.7} \\;+\\; \\frac{2.51}{Re\\,\\sqrt{f}}\\right),\n$$\n其中 $\\epsilon/D$ 是相对粗糙度，$Re$ 是雷诺数，$\\log_{10}$ 表示以 10 为底的对数。量 $Re$ 和 $\\epsilon/D$ 均为无量纲。对于每个指定的参数对 $(Re,\\epsilon/D)$，计算上述方程唯一的正解 $f$。\n\n你的程序必须为以下参数对 $(Re,\\epsilon/D)$ 的测试套件计算 $f$：\n- 情况 1：$(Re,\\epsilon/D) = (100000,\\; 10^{-4})$。\n- 情况 2：$(Re,\\epsilon/D) = (100000,\\; 0)$。\n- 情况 3：$(Re,\\epsilon/D) = (4000,\\; 5\\times 10^{-4})$。\n- 情况 4：$(Re,\\epsilon/D) = (10^{7},\\; 5\\times 10^{-3})$。\n\n要求：\n- 将 $\\log_{10}$ 精确地解释为方程中所写的以 10 为底的对数。\n- 所有输入都是无量纲的。答案中不需要物理单位。\n- 对于每种情况，返回保留 $8$ 位小数的实数 $f$ 值。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含情况 1 到情况 4 的结果，结果按顺序排列，形式为一个用方括号括起来的逗号分隔列表，每个条目都四舍五入到 8 位小数（例如 $[f_1,f_2,f_3,f_4]$，其中 $f_i$ 是十进制数）。", "solution": "对所提出的问题进行验证。\n\n**步骤 1：提取已知条件**\n- **方程**：给定的 Colebrook 关系式为 $\\frac{1}{\\sqrt{f}} = -2\\,\\log_{10}\\!\\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51}{Re\\,\\sqrt{f}}\\right)$。\n- **定义**：$f$ 是 Darcy–Weisbach 摩擦系数，$\\epsilon/D$ 是相对粗糙度，$Re$ 是雷诺数。$\\log_{10}$ 是以 10 为底的对数。\n- **约束**：寻求唯一的正解 $f$。\n- **测试用例**：\n    - 情况 1：$(Re, \\epsilon/D) = (100000, 10^{-4})$\n    - 情况 2：$(Re, \\epsilon/D) = (100000, 0)$\n    - 情况 3：$(Re, \\epsilon/D) = (4000, 5 \\times 10^{-4})$\n    - 情况 4：$(Re, \\epsilon/D) = (10^7, 5 \\times 10^{-3})$\n- **输出要求**：每种情况下的 $f$ 值必须四舍五入到 8 位小数。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：Colebrook 方程是流体力学中一个基本的、经过经验验证的关系式，用于确定湍流管流中的摩擦系数。它是水力工程的基石。给定的雷諾数 ($Re$) 和相对粗糙度 ($\\epsilon/D$) 参数都在物理上现实的范围内。$Re \\ge 4000$ 证实了流动处于湍流或过渡到湍流的状态，该方程在此状态下适用。\n- **适定性**：该方程是关于 $f$ 的隐式方程，并且数学上已经证明，对于任何正的 $Re$ 和非负的 $\\epsilon/D$，都存在唯一的正解 $f$。因此，该问题是适定的。\n- **客观性**：该问题使用精确的数学和工程术语陈述。没有歧义或主观内容。\n\n**步骤 3：结论与行动**\n该问题科学上合理、适定、客观且完整。它是计算工程中的一个标准问题。该问题被判定为**有效**。将提供一个解决方案。\n\nColebrook 方程是一个超越方程，这意味着无法通过直接的代数变换来求解摩擦系数 $f$。因此，必须使用数值求根或迭代方法。我们将采用不动点迭代法，该方法对于此特定问题是稳健且高效的。\n\n为了应用不动点迭代，我们必须将方程重排为 $f = g(f)$ 的形式。通过将 $f$ 分离到一边，可以得到一个合适的重排形式。首先，我们对初始方程取倒数：\n$$\n\\sqrt{f} = \\frac{1}{-2\\,\\log_{10}\\!\\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51}{Re\\,\\sqrt{f}}\\right)}\n$$\n两边平方得到所需的不动点形式：\n$$\nf = \\frac{1}{\\left[-2\\,\\log_{10}\\!\\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51}{Re\\,\\sqrt{f}}\\right)\\right]^2}\n$$\n这给我们提供了一个迭代方案，其中 $f$ 的下一个近似值 $f_{k+1}$ 是根据当前近似值 $f_k$ 计算得出的：\n$$\nf_{k+1} = g(f_k) = \\frac{1}{\\left[-2\\,\\log_{10}\\!\\left(\\frac{\\epsilon/D}{3.7} + \\frac{2.51}{Re\\,\\sqrt{f_k}}\\right)\\right]^2}\n$$\n对于任何物理上合理的初始猜测 $f_0 > 0$，此迭代保证收敛到唯一的正根。迭代函数 $g'(f)$ 的导数在感兴趣的定义域内小于 1，满足压缩映射的收敛条件。\n\n算法如下：\n1.  对于每个给定的 $(Re, \\epsilon/D)$ 对，定义常数 $C_1 = \\frac{\\epsilon/D}{3.7}$ 和 $C_2 = \\frac{2.51}{Re}$。\n2.  迭代函数则为 $f_{k+1} = \\frac{1}{4 \\left[ \\log_{10}(C_1 + C_2/\\sqrt{f_k}) \\right]^2}$。\n3.  选择摩擦系数的初始猜测值 $f_0$。取 $f_0 = 0.02$ 是一个常用且有效的起始点，因为它位于 Moody diagram 上湍流摩擦系数的典型范围内。\n4.  使用 $f_{k+1}$ 的公式进行迭代，直到连续迭代值之间的变化可以忽略不计，即 $|f_{k+1} - f_k|  \\tau$，其中 $\\tau$ 是一个很小的容差（例如 $10^{-10}$）。\n5.  然后将最终收敛的值 $f$ 按要求四舍五入到 8 位小数。\n\n该过程将对所提供的四个测试用例中的每一个实施。对于情况 2，其中 $\\epsilon/D = 0$（光滑管道），项 $\\frac{\\epsilon/D}{3.7}$ 变为零，但迭代方案在结构上保持不变。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Darcy friction factor 'f' using the Colebrook equation\n    via fixed-point iteration for a given set of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Parameter set 1: Re, epsilon/D)\n        (100000, 1e-4),\n        # (Parameter set 2: Re, epsilon/D)\n        (100000, 0),\n        # (Parameter set 3: Re, epsilon/D)\n        (4000, 5e-4),\n        # (Parameter set 4: Re, epsilon/D)\n        (1e7, 5e-3),\n    ]\n\n    results = []\n    for case in test_cases:\n        Re, rel_roughness = case\n        \n        # Initial guess for the friction factor f.\n        # 0.02 is a standard initial guess for turbulent flow.\n        f = 0.02\n        \n        # Iteration parameters\n        tolerance = 1e-10\n        max_iterations = 100 # Convergence is fast, this is a safeguard.\n\n        for _ in range(max_iterations):\n            f_old = f\n            \n            # The Colebrook equation rearranged for fixed-point iteration:\n            # f = 1 / (-2 * log10( (eps/D)/3.7 + 2.51/(Re*sqrt(f)) ))**2\n            # Define terms for clarity\n            term1 = rel_roughness / 3.7\n            term2 = 2.51 / (Re * np.sqrt(f_old))\n            \n            try:\n                # Handle potential math domain errors if the argument to log10 becomes non-positive,\n                # which can happen with a poor initial guess for exotic parameters.\n                log_arg = term1 + term2\n                if log_arg = 0:\n                    # This case should not be reached with the given valid parameters\n                    # and a positive initial guess.\n                    raise ValueError(\"log argument is non-positive\")\n\n                denominator = -2.0 * np.log10(log_arg)\n                f = 1.0 / (denominator**2)\n\n            except (ValueError, ZeroDivisionError) as e:\n                # If an error occurs, we report it and break.\n                # For this problem set, this block is not expected to be executed.\n                results.append(f\"Error for case {case}: {e}\")\n                break\n\n            # Check for convergence\n            if np.abs(f - f_old)  tolerance:\n                break\n        \n        # After the loop, store the rounded result.\n        # The problem asks for the result to be rounded to 8 decimal places.\n        results.append(f\"{f:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2393395"}]}