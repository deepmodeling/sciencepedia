{"hands_on_practices": [{"introduction": "在边界层分析中，直接处理完整的速度剖面可能非常复杂。因此，我们引入积分参数，如位移厚度（$\\delta^*$）、动量厚度（$\\theta$）和形状因子（$H$），将边界层对外部流动的宏观效应（如质量和动量损失）浓缩为几个关键的厚度尺度。本练习 ([@problem_id:1806234]) 将指导您使用一个假设的二次速度剖面来计算这些基本参数，为您掌握更强大的动量积分方法奠定坚实的基础。", "problem": "在一新型飞机机翼的初步空气动力学分析中，其表面大部分区域的流动被建模为在光滑平板上发展的二维、不可压缩的层流边界层。为了快速估算边界层特性，一位工程师提出了一个简单的二次速度剖面近似，由以下关系式给出：\n$$\n\\frac{u}{U} = 2\\left(\\frac{y}{\\delta}\\right) - \\left(\\frac{y}{\\delta}\\right)^2\n$$\n此处，$u$ 是距离表面垂直距离为 $y$ 处的流体速度，$U$ 是边界层外的恒定自由来流速度，而 $\\delta$ 是边界层厚度。\n\n边界层的稳定性和分离特性通常与形状因子 $H$ 相关，其定义为位移厚度 $\\delta^*$ 与动量厚度 $\\theta$ 之比。位移厚度和动量厚度由以下积分定义：\n$$\n\\delta^* = \\int_{0}^{\\delta} \\left(1 - \\frac{u}{U}\\right) dy\n$$\n$$\n\\theta = \\int_{0}^{\\delta} \\frac{u}{U}\\left(1 - \\frac{u}{U}\\right) dy\n$$\n使用所提出的二次速度剖面，计算形状因子 $H$ 的数值。请以精确值的形式给出答案。", "solution": "给定在平板上的层流、二维、不可压缩边界层中的二次速度剖面：\n$$\n\\frac{u}{U} = 2\\left(\\frac{y}{\\delta}\\right) - \\left(\\frac{y}{\\delta}\\right)^{2}, \\quad 0 \\leq y \\leq \\delta.\n$$\n形状因子定义为 $H = \\delta^{*}/\\theta$，其中位移厚度和动量厚度为\n$$\n\\delta^{*} = \\int_{0}^{\\delta} \\left(1 - \\frac{u}{U}\\right) dy, \\qquad \\theta = \\int_{0}^{\\delta} \\frac{u}{U}\\left(1 - \\frac{u}{U}\\right) dy.\n$$\n引入无量纲坐标 $\\xi = y/\\delta$，从而 $dy = \\delta\\, d\\xi$，积分上下限变为 0 到 1。\n\n首先，计算位移厚度：\n$$\n1 - \\frac{u}{U} = 1 - \\left[2\\xi - \\xi^{2}\\right] = 1 - 2\\xi + \\xi^{2},\n$$\n所以\n$$\n\\delta^{*} = \\int_{0}^{\\delta} \\left(1 - \\frac{u}{U}\\right) dy = \\delta \\int_{0}^{1} \\left(1 - 2\\xi + \\xi^{2}\\right) d\\xi.\n$$\n逐项积分，\n$$\n\\int_{0}^{1} \\left(1 - 2\\xi + \\xi^{2}\\right) d\\xi = \\left[\\xi - \\xi^{2} + \\frac{1}{3}\\xi^{3}\\right]_{0}^{1} = 1 - 1 + \\frac{1}{3} = \\frac{1}{3},\n$$\n因此\n$$\n\\delta^{*} = \\frac{\\delta}{3}.\n$$\n\n接下来，计算动量厚度。令 $f(\\xi) = \\frac{u}{U} = 2\\xi - \\xi^{2}$。则\n$$\nf(1 - f) = (2\\xi - \\xi^{2})\\left[1 - (2\\xi - \\xi^{2})\\right] = (2\\xi - \\xi^{2}) - (2\\xi - \\xi^{2})^{2}.\n$$\n计算平方项：\n$$\n(2\\xi - \\xi^{2})^{2} = 4\\xi^{2} - 4\\xi^{3} + \\xi^{4},\n$$\n因此\n$$\nf(1 - f) = 2\\xi - \\xi^{2} - 4\\xi^{2} + 4\\xi^{3} - \\xi^{4} = 2\\xi - 5\\xi^{2} + 4\\xi^{3} - \\xi^{4}.\n$$\n因此，\n$$\n\\theta = \\int_{0}^{\\delta} f(1 - f)\\, dy = \\delta \\int_{0}^{1} \\left(2\\xi - 5\\xi^{2} + 4\\xi^{3} - \\xi^{4}\\right) d\\xi.\n$$\n逐项积分，\n$$\n\\int_{0}^{1} \\left(2\\xi - 5\\xi^{2} + 4\\xi^{3} - \\xi^{4}\\right) d\\xi = \\left[\\xi^{2} - \\frac{5}{3}\\xi^{3} + \\xi^{4} - \\frac{1}{5}\\xi^{5}\\right]_{0}^{1} = 1 - \\frac{5}{3} + 1 - \\frac{1}{5}.\n$$\n合并各项：\n$$\n1 - \\frac{5}{3} + 1 - \\frac{1}{5} = 2 - \\frac{5}{3} - \\frac{1}{5} = \\frac{30}{15} - \\frac{25}{15} - \\frac{3}{15} = \\frac{2}{15},\n$$\n所以\n$$\n\\theta = \\delta \\cdot \\frac{2}{15} = \\frac{2\\delta}{15}.\n$$\n\n最后，形状因子为\n$$\nH = \\frac{\\delta^{*}}{\\theta} = \\frac{\\delta/3}{(2\\delta/15)} = \\frac{1}{3} \\cdot \\frac{15}{2} = \\frac{5}{2}.\n$$", "answer": "$$\\boxed{\\frac{5}{2}}$$", "id": "1806234"}, {"introduction": "虽然近似剖面为工程估算提供了便利，但理解其准确性的关键在于将其与精确解进行比较。平板上的层流边界层存在一个经典的Blasius相似性解，它将复杂的偏微分方程组转化为一个可以精确求解的常微分方程。本高级练习 ([@problem_id:2500261]) 旨在连接抽象的Blasius相似性函数与我们之前遇到的物理积分参数，通过从精确解推导形状因子$H$，您将深刻理解该理论的精髓，并为近似方法的有效性提供一个重要的基准。", "problem": "一个二维、定常、不可压缩的层流边界层在一个与均匀自由来流速度 $U_{\\infty}$ 对齐的半无限平板上发展，其流向压力梯度为零，运动粘度 $\\nu$ 为常数。从质量守恒和流向动量方程的边界层形式出发，并使用流函数为 $\\psi(x,y)=\\sqrt{\\nu U_{\\infty} x}\\,f(\\eta)$ 和相似性变量为 $\\eta=y\\sqrt{U_{\\infty}/(\\nu x)}$ 的 Blasius 相似性变换，按以下步骤进行：\n\n1) 推导将有量纲速度分量与 Blasius 函数联系起来的相似性关系，特别是 $u(x,y)/U_{\\infty}=f'(\\eta)$，并陈述 $f(\\eta)$ 对应的常微分方程及其边界条件。\n\n2) 使用位移厚度和动量厚度的定义，\n$$\n\\delta^{\\ast}(x)=\\int_{0}^{\\infty}\\Big(1-\\frac{u(x,y)}{U_{\\infty}}\\Big)\\,\\mathrm{d}y,\\qquad\n\\theta(x)=\\int_{0}^{\\infty}\\frac{u(x,y)}{U_{\\infty}}\\Big(1-\\frac{u(x,y)}{U_{\\infty}}\\Big)\\,\\mathrm{d}y,\n$$\n证明每个厚度都与 $\\sqrt{\\nu x/U_{\\infty}}$ 成比例，并且可以写成如下形式\n$$\n\\delta^{\\ast}(x)=C_{\\delta^{\\ast}}\\sqrt{\\frac{\\nu x}{U_{\\infty}}},\\qquad\n\\theta(x)=C_{\\theta}\\sqrt{\\frac{\\nu x}{U_{\\infty}}},\n$$\n其中常数 $C_{\\delta^{\\ast}}$ 和 $C_{\\theta}$ 仅通过以下积分依赖于 Blasius 解\n$$\nC_{\\delta^{\\ast}}=\\int_{0}^{\\infty}\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta,\\qquad\nC_{\\theta}=\\int_{0}^{\\infty}f'(\\eta)\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta.\n$$\n\n3) 使用零压力梯度下的 von Kármán 动量积分方程以及从相似性解中得到的壁面剪切应力，将 $C_{\\theta}$ 用壁面值 $f''(0)$ 表示。\n\n4) 通过使用当 $\\eta\\to\\infty$ 时 $f(\\eta)\\sim \\eta - L$（其中 L 为某个常数），将 $C_{\\delta^{\\ast}}$ 用 $f(\\eta)$ 的大 $\\eta$ 渐近线表示，并证明 $C_{\\delta^{\\ast}}=L$。\n\n对于数值计算，使用 Blasius 解的数值确定常数：$f''(0)=0.332057$ 和 $L=\\lim_{\\eta\\to\\infty}\\big(\\eta-f(\\eta)\\big)=1.720787$。计算形状因子\n$$\nH=\\frac{\\delta^{\\ast}}{\\theta}=\\frac{C_{\\delta^{\\ast}}}{C_{\\theta}}\n$$\n并报告其四舍五入到四位有效数字的数值。基于边界层动量输运的基本原理，简要解释为什么计算出的 $H$ 值反映了层流边界层在逆压梯度下分离的趋势是相对较低还是较高。$H$ 的最终数值是无量纲的；请勿在答案中包含单位。", "solution": "#### 1) 速度关系与Blasius方程的推导\n速度分量 $u$ 和 $v$ 由流函数 $\\psi(x,y)$ 通过关系式 $u = \\frac{\\partial \\psi}{\\partial y}$ 和 $v = -\\frac{\\partial \\psi}{\\partial x}$ 导出。通过相似性变量 $\\eta$ 对 $x$ 和 $y$ 求导需要使用链式法则。\n对 $y$ 的偏导数为：\n$$\n\\frac{\\partial}{\\partial y} = \\frac{\\partial \\eta}{\\partial y} \\frac{d}{d\\eta} = \\sqrt{\\frac{U_{\\infty}}{\\nu x}} \\frac{d}{d\\eta}\n$$\n因此流向速度分量 $u$ 为：\n$$\nu = \\frac{\\partial \\psi}{\\partial y} = \\sqrt{\\nu U_{\\infty} x} \\frac{d f}{d \\eta} \\frac{\\partial \\eta}{\\partial y} = \\sqrt{\\nu U_{\\infty} x} f'(\\eta) \\sqrt{\\frac{U_{\\infty}}{\\nu x}} = U_{\\infty} f'(\\eta)\n$$\n这就得到了所需的关系式 $\\frac{u(x,y)}{U_{\\infty}} = f'(\\eta)$。将此关系及其导数代入流向动量方程，并利用流函数对连续性方程的满足，经过化简可得著名的Blasius方程：\n$$\n2f'''(\\eta) + f(\\eta)f''(\\eta) = 0\n$$\n物理边界条件相应地转换为对 $f(\\eta)$ 的约束：\n- 壁面无滑移（$y=0, \\eta=0$）：$u=0 \\implies U_{\\infty}f'(0)=0 \\implies f'(0)=0$。\n- 壁面无穿透（$y=0, \\eta=0$）：$v=0$。利用 $v = \\frac{1}{2}\\sqrt{\\frac{\\nu U_{\\infty}}{x}}\\left(\\eta f'(\\eta) - f(\\eta)\\right)$，这要求 $f(0)=0$。\n- 自由来流条件（$y\\to\\infty, \\eta\\to\\infty$）：$u \\to U_{\\infty} \\implies U_{\\infty}f'(\\infty) = U_{\\infty} \\implies f'(\\infty)=1$。\n\n#### 2) 边界层厚度的相似性形式推导\n对于位移厚度 $\\delta^*(x)$，我们将 $\\frac{u}{U_{\\infty}}=f'(\\eta)$ 代入其定义，并将积分变量从 $y$ 变为 $\\eta$（其中 $\\mathrm{d}y = \\sqrt{\\nu x/U_{\\infty}}\\,\\mathrm{d}\\eta$）：\n$$\n\\delta^{\\ast}(x)=\\int_{0}^{\\infty}\\Big(1-f'(\\eta)\\Big)\\,\\sqrt{\\frac{\\nu x}{U_{\\infty}}}\\,\\mathrm{d}\\eta = \\sqrt{\\frac{\\nu x}{U_{\\infty}}} \\int_{0}^{\\infty}\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta\n$$\n这证明了 $\\delta^{\\ast}(x)=C_{\\delta^{\\ast}}\\sqrt{\\frac{\\nu x}{U_{\\infty}}}$ 的形式，其中 $C_{\\delta^{\\ast}}=\\int_{0}^{\\infty}\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta$。\n同理，对于动量厚度 $\\theta(x)$：\n$$\n\\theta(x)=\\int_{0}^{\\infty}f'(\\eta)\\big(1-f'(\\eta)\\big)\\,\\sqrt{\\frac{\\nu x}{U_{\\infty}}}\\,\\mathrm{d}\\eta = \\sqrt{\\frac{\\nu x}{U_{\\infty}}} \\int_{0}^{\\infty}f'(\\eta)\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta\n$$\n这证明了 $\\theta(x)=C_{\\theta}\\sqrt{\\frac{\\nu x}{U_{\\infty}}}$ 的形式，其中 $C_{\\theta}=\\int_{0}^{\\infty}f'(\\eta)\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta$。\n\n#### 3) $C_{\\theta}$ 和 $f''(0)$ 之间的关系\n零压力梯度下的 von Kármán 动量积分方程为 $\\frac{d\\theta}{dx} = \\frac{\\tau_w}{\\rho U_{\\infty}^2}$。\n首先，计算壁面剪切应力 $\\tau_w = \\mu \\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0}$。\n$$\n\\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0} = U_{\\infty} f''(0) \\sqrt{\\frac{U_{\\infty}}{\\nu x}}\n$$\n因此，$\\tau_w = \\mu U_{\\infty} f''(0) \\sqrt{\\frac{U_{\\infty}}{\\nu x}}$。利用 $\\mu = \\rho\\nu$，我们得到：\n$$\n\\frac{\\tau_w}{\\rho U_{\\infty}^2} = \\frac{\\rho\\nu U_{\\infty} f''(0)}{\\rho U_{\\infty}^2} \\sqrt{\\frac{U_{\\infty}}{\\nu x}} = f''(0) \\sqrt{\\frac{\\nu}{U_{\\infty} x}}\n$$\n其次，对 $\\theta(x)$ 的表达式求导：\n$$\n\\frac{d\\theta}{dx} = \\frac{d}{dx}\\left( C_{\\theta}\\sqrt{\\frac{\\nu x}{U_{\\infty}}} \\right) = \\frac{C_{\\theta}}{2} \\sqrt{\\frac{\\nu}{U_{\\infty} x}}\n$$\n令两个表达式相等，$\\frac{C_{\\theta}}{2} \\sqrt{\\frac{\\nu}{U_{\\infty} x}} = f''(0) \\sqrt{\\frac{\\nu}{U_{\\infty} x}}$，立即得到 $C_{\\theta} = 2f''(0)$。\n\n#### 4) $C_{\\delta^{\\ast}}$ 和 $L$ 之间的关系\n我们直接计算 $C_{\\delta^{\\ast}}$ 的定义积分：\n$$\nC_{\\delta^{\\ast}} = \\int_{0}^{\\infty}\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta = \\lim_{\\eta_{max}\\to\\infty} \\int_{0}^{\\eta_{max}}\\big(1-f'(\\eta)\\big)\\,\\mathrm{d}\\eta\n$$\n$$\n= \\lim_{\\eta_{max}\\to\\infty} \\left[\\eta - f(\\eta)\\right]_{0}^{\\eta_{max}} = \\lim_{\\eta_{max}\\to\\infty} \\left( (\\eta_{max} - f(\\eta_{max})) - (0 - f(0)) \\right)\n$$\n由于 $f(0)=0$ 且已知 $L=\\lim_{\\eta\\to\\infty}\\big(\\eta-f(\\eta)\\big)$，我们得出结论 $C_{\\delta^{\\ast}} = L$。\n\n#### 形状因子H的计算\n形状因子 H 是位移厚度与动量厚度之比。使用推导出的常数：\n$$\nH = \\frac{\\delta^{\\ast}}{\\theta} = \\frac{C_{\\delta^{\\ast}}\\sqrt{\\frac{\\nu x}{U_{\\infty}}}}{C_{\\theta}\\sqrt{\\frac{\\nu x}{U_{\\infty}}}} = \\frac{C_{\\delta^{\\ast}}}{C_{\\theta}} = \\frac{L}{2f''(0)}\n$$\n代入给定的数值 $L=1.720787$ 和 $f''(0)=0.332057$：\n$$\nH = \\frac{1.720787}{2 \\times 0.332057} = \\frac{1.720787}{0.664114} \\approx 2.59107\n$$\n四舍五入到四位有效数字，$H \\approx 2.591$。\n\n#### H的物理解释\n形状因子 $H = \\delta^*/\\theta$ 量化了速度剖面的“饱满度”。较高的H值意味着速度剖面不那么“饱满”，对逆压梯度更敏感。层流边界层分离通常发生在 H 达到约 3.5 时。相比之下，湍流边界层的形状因子要小得多（通常为 1.3 到 1.6），使其对分离的抵抗力强得多。Blasius 剖面计算出的 H 值约为 2.591，显著大于典型的湍流值，因此，它反映了层流边界层在承受逆压梯度时有相对 **高** 的分离趋势。", "answer": "$$\n\\boxed{2.591}\n$$", "id": "2500261"}, {"introduction": "我们已经探讨了Blasius解的理论特性，但这个非线性常微分方程并没有简单的解析解。在实践中，我们必须借助数值方法来获得其精确解，而“打靶法” (shooting method) 就是其中一种经典而强大的技术。这项终极实践 ([@problem_id:2500302]) 将引导您从理论推导走向计算实践，通过亲手实现打靶法来求解Blasius方程，从而真正掌握从理论分析到数值实现的完整流程。", "problem": "要求您设计并实现一种数值打靶法，用以计算在与均匀来流对齐的半无限长平板上形成的二维、定常、不可压缩层流边界层的相似解。该物理问题由 Navier–Stokes 方程的边界层近似所控制。您的任务必须从基本守恒定律和经过充分检验的数学事实出发，推导出向边值常微分方程的相似性约化，然后将其转换为一个数值上易于处理的初值问题，其中包含一个未知的初始斜率，您需要通过强制施加渐近边界条件来确定该斜率。\n\n从以下基础开始。\n\n- 定常、二维、不可压缩的边界层方程包括以笛卡尔坐标书写的连续性方程和流向动量方程：\n  - 连续性方程：$\\dfrac{\\partial u}{\\partial x} + \\dfrac{\\partial v}{\\partial y} = 0$。\n  - 流向动量方程：$u \\dfrac{\\partial u}{\\partial x} + v \\dfrac{\\partial u}{\\partial y} = \\nu \\dfrac{\\partial^2 u}{\\partial y^2}$，其中 $\\nu$ 是运动粘度，$u(x,y)$ 和 $v(x,y)$ 分别是流向和壁面法向的速度分量。\n\n- 边界条件为壁面处的无滑移和无穿透条件，以及远离壁面处的均匀来流条件：\n  - 在壁面 $y = 0$ 处：$u(x,0) = 0$，$v(x,0) = 0$。\n  - 当 $y \\to \\infty$ 时：$u(x,y) \\to U_\\infty$，其中 $U_\\infty$ 是恒定的自由来流速度。\n\n待完成的任务：\n\n1. 从上述控制方程和边界条件出发，引入一个相似变量和一个形式如下的流函数\n   - $\\psi(x,y) = \\sqrt{\\nu U_\\infty x}\\, f(\\eta)$，\n   - $\\eta = y \\sqrt{\\dfrac{U_\\infty}{\\nu x}}$，\n   并使用定义 $u = \\dfrac{\\partial \\psi}{\\partial y}$ 和 $v = -\\dfrac{\\partial \\psi}{\\partial x}$ 将偏微分方程约化为关于 $f(\\eta)$ 的单个边值常微分方程及其在相似坐标下的边界条件。您必须提供逻辑步骤，以证明所得方程和边界条件是无量纲的，并且除了通过相似变量外，不显式依赖于 $x$、$y$ 或其他物理参数。\n\n2. 使用辅助变量（例如，定义 $f = y_1$、$f' = y_2$ 和 $f'' = y_3$），将边值常微分方程转换为一个一阶初值方程组，并确定在 $\\eta = 0$ 处作为打靶参数的未知初始条件。解释如何调整这个未知参数以满足在 $\\eta \\to \\infty$ 处的远场条件。\n\n3. 提出一种基于一维求根方法的更新程序，该方法仅使用函数求值（不需要关于打靶参数的导数）来调整未知初始条件。您的更新规则必须基于非线性方程求根的基本原理进行论证，并且必须在远场残差满足用户指定的容差时终止。您应该讨论如何处理 $\\eta$ 的计算域在有限的 $\\eta_{\\max}$ 处被截断的事实，以及这对残差定义的影响。\n\n4. 将您的程序实现为一个完整的程序，该程序：\n   - 对于打靶参数的任何试验值，将初值系统从 $\\eta = 0$ 积分到 $\\eta = \\eta_{\\max}$。\n   - 计算一个残差，定义为在 $\\eta = \\eta_{\\max}$ 处流向相似速度导数与其远场目标值的偏差。\n   - 迭代更新打靶参数，直到残差的绝对值小于指定的容差。\n   - 对于下面指定的每个测试用例，报告收敛后的打靶参数值。相似性公式中的所有变量都是无量纲的。不需要物理单位，也不应报告。\n\n测试套件规范：\n\n对于每个测试，您将得到一个四元组 $(\\eta_{\\max}, s_0, s_1, \\varepsilon)$，其中：\n- $\\eta_{\\max}$ 是用于近似远场的相似坐标的有限截断值，\n- $s_0$ 和 $s_1$ 是打靶参数 $s = f''(0)$ 的两个不同初始猜测值，\n- $\\varepsilon$ 是远场残差的绝对容差。\n\n您的程序必须为以下测试套件求解问题：\n- 测试 $1$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (10, 0.3, 0.35, 10^{-10})$。\n- 测试 $2$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (8, 0.1, 1.0, 10^{-8})$。\n- 测试 $3$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (6, 0.3, 0.35, 10^{-8})$。\n- 测试 $4$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (12, 0.33, 0.34, 10^{-12})$。\n\n输出规范：\n\n- 对于每个测试，仅输出您的算法计算出的打靶参数 $s^\\star = f''(0)$ 的收敛值。\n- 将四个浮点数结果按测试顺序聚合到单行中，格式严格为方括号内以逗号分隔的列表，每个值精确到小数点后六位，例如 $[0.111111,0.222222,0.333333,0.444444]$。", "solution": "以下是基于流体力学和数值分析原理的逐步解答。\n\n**任务1：Blasius 相似性方程的推导**\n\n目标是使用所提供的相似变换将控制偏微分方程简化为单个常微分方程。我们首先将速度分量 $u$ 和 $v$ 表示为相似函数 $f(\\eta)$ 的形式。\n\n相似变量是 $\\eta = y \\sqrt{\\frac{U_\\infty}{\\nu x}}$，流函数是 $\\psi(x,y) = \\sqrt{\\nu U_\\infty x} f(\\eta)$。撇号表示法，例如 $f'$，将表示对 $\\eta$ 的微分。\n\n首先，我们计算流向速度分量 $u$：\n$$\nu = \\frac{\\partial \\psi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sqrt{\\nu U_\\infty x} f(\\eta) \\right) = \\sqrt{\\nu U_\\infty x} \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial y}\n$$\n$\\eta$ 对 $y$ 的导数是：\n$$\n\\frac{\\partial \\eta}{\\partial y} = \\sqrt{\\frac{U_\\infty}{\\nu x}}\n$$\n将此代入 $u$ 的表达式中得到：\n$$\nu = \\sqrt{\\nu U_\\infty x} f'(\\eta) \\sqrt{\\frac{U_\\infty}{\\nu x}} = U_\\infty f'(\\eta)\n$$\n\n接下来，我们计算壁面法向速度分量 $v$。这更复杂，因为 $\\psi$ 乘积中的两项以及变量 $\\eta$ 本身都依赖于 $x$：\n$$\nv = -\\frac{\\partial \\psi}{\\partial x} = \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} \\left( \\eta f'(\\eta) - f(\\eta) \\right)\n$$\n连续性方程通过流函数的定义自动满足。现在，我们将这些表达式代入动量方程 $u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2}$。\n$$\n(U_\\infty f') \\left(-\\frac{U_\\infty \\eta}{2x} f''\\right) + \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} (\\eta f' - f) \\left(U_\\infty f'' \\sqrt{\\frac{U_\\infty}{\\nu x}}\\right) = \\nu \\left(U_\\infty f''' \\frac{U_\\infty}{\\nu x}\\right)\n$$\n化简后得到 Blasius 方程：\n$$\nf'''(\\eta) + \\frac{1}{2} f(\\eta) f''(\\eta) = 0 \\quad \\text{或} \\quad 2 f''' + f f'' = 0\n$$\n这是一个三阶非线性ODE。变换是成功的，因为该方程只依赖于 $\\eta$ 和 $f(\\eta)$，而不显式依赖于 $x$、$y$ 或物理参数。\n\n我们现在变换边界条件：\n- 在壁面处，$y=0$，这意味着 $\\eta=0$。\n  - $u(x,0) = 0 \\implies U_\\infty f'(0) = 0 \\implies f'(0) = 0$。\n  - $v(x,0) = 0 \\implies f(0) = 0$。\n- 在自由来流中，$y \\to \\infty$，这意味着 $\\eta \\to \\infty$。\n  - $u(x,y) \\to U_\\infty \\implies f'(\\eta \\to \\infty) = 1$。\n\n在相似坐标下的完整边值问题是：\n$$\n2 f''' + f f'' = 0\n$$\n服从于：\n$$\nf(0) = 0, \\quad f'(0) = 0, \\quad f'(\\eta \\to \\infty) = 1\n$$\n\n**任务2：转换为初值问题（IVP）**\n\n我们将三阶BVP转换为一个包含三个一阶ODE的系统。定义一个状态向量 $\\mathbf{y}(\\eta) = [y_1(\\eta), y_2(\\eta), y_3(\\eta)]^T$，其中：\n- $y_1(\\eta) = f(\\eta)$\n- $y_2(\\eta) = f'(\\eta)$\n- $y_3(\\eta) = f''(\\eta)$\n\n一阶ODE系统由这些定义和 Blasius 方程导出：\n- $y_1' = y_2$\n- $y_2' = y_3$\n- $y_3' = -\\frac{1}{2} y_1 y_3$\n\n$\\eta=0$ 处的边界条件为该系统提供了两个初始条件：\n- $y_1(0) = f(0) = 0$\n- $y_2(0) = f'(0) = 0$\n\n要将此系统作为IVP求解，我们需要第三个初始条件，$y_3(0) = f''(0)$。这个值是未知的。我们必须猜测它。设这个打靶参数为 $s = f''(0) = y_3(0)$。\n\n待求解的IVP是：\n$$\n\\frac{d}{d\\eta} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} y_2 \\\\ y_3 \\\\ -\\frac{1}{2} y_1 y_3 \\end{pmatrix}\n$$\n在 $\\eta=0$ 处的初始条件为：\n$$\n\\mathbf{y}(0) = \\begin{pmatrix} 0 \\\\ 0 \\\\ s \\end{pmatrix}\n$$\n打靶法的过程是猜测一个 $s$ 值，将IVP从 $\\eta=0$ 积分到一个大的值 $\\eta_{\\max}$ 来近似 $\\infty$，然后检查在无穷远处的边界条件，$f'(\\infty) = 1$（或 $y_2(\\infty)=1$），是否满足。我们定义一个残差函数 $R(s)$：\n$$\nR(s) = y_2(\\eta_{\\max}; s) - 1\n$$\n其中 $y_2(\\eta_{\\max}; s)$ 表示使用打靶参数 $s$ 在 $\\eta_{\\max}$ 处得到的 $y_2$ 的解。目标是找到 $s$ 的值，我们称之为 $s^*$，使得 $R(s^*) = 0$。\n\n**任务3：打靶参数的更新程序**\n\n我们需要找到非线性方程 $R(s)=0$ 的根 $s^*$。割线法是一个合适的选择，因为它不需要导数 $\\frac{dR}{ds}$。给定两个初始猜测值 $s_0$ 和 $s_1$，割线法使用以下更新规则生成一系列近似值 $\\{s_k\\}$：\n$$\ns_{k+1} = s_k - R(s_k) \\frac{s_k - s_{k-1}}{R(s_k) - R(s_{k-1})}\n$$\n算法流程如下：\n1.  选择两个不同的初始猜测值 $s_0$ 和 $s_1$，以及一个容差 $\\varepsilon$。\n2.  通过对每个猜测值积分IVP，计算残差 $R_0 = R(s_0)$ 和 $R_1 = R(s_1)$。\n3.  对于 $k=1, 2, ...$：\n    a. 使用上述公式计算下一个猜测值 $s_{k+1}$。\n    b. 用 $s = s_{k+1}$ 积分IVP，以找到新的残差 $R_{k+1} = R(s_{k+1})$。\n    c. 如果 $|R_{k+1}|  \\varepsilon$，则过程收敛。解为 $s^* \\approx s_{k+1}$。\n    d. 否则，为下一次迭代更新值。\n\n因为数值积分无法进行到无穷大，所以域在有限的 $\\eta_{\\max}$ 处被截断。如果 $\\eta_{\\max}$ 选择得足够大，则此近似有效。测试用例提供了 $\\eta_{\\max}$ 的值，这些值对于所需的精度是足够的。\n\n**任务4：程序实现**\n\n以下程序实现了上述逻辑。它使用 `scipy.integrate.solve_ivp` 来积分 ODE 系统，并用一个循环来实现割线法求根。\n\n```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the Blasius boundary layer problem for a given test suite\n    using a numerical shooting method based on the Secant algorithm.\n    \"\"\"\n\n    def blasius_solver(eta_max: float, s0: float, s1: float, tol: float) -> float:\n        \"\"\"\n        Finds the shooting parameter s = f''(0) for the Blasius equation.\n\n        Args:\n            eta_max: The finite truncation of the similarity coordinate.\n            s0: The first initial guess for the shooting parameter s.\n            s1: The second initial guess for the shooting parameter s.\n            tol: The absolute tolerance for the far-field residual.\n\n        Returns:\n            The converged value of the shooting parameter s.\n        \"\"\"\n\n        def ode_system(eta, y):\n            \"\"\"\n            Defines the system of first-order ODEs for the Blasius problem.\n            y[0] = f, y[1] = f', y[2] = f''\n            \"\"\"\n            _f, _f_prime, _f_double_prime = y\n            return [\n                _f_prime,\n                _f_double_prime,\n                -0.5 * _f * _f_double_prime,\n            ]\n\n        memo = {}\n        def get_residual(s: float) -> float:\n            \"\"\"\n            Calculates the residual R(s) = f'(eta_max; s) - 1.\n            It integrates the ODE system for a given shooting parameter s.\n            \"\"\"\n            if s in memo:\n                return memo[s]\n            \n            y0 = [0.0, 0.0, s]\n            sol = solve_ivp(\n                ode_system,\n                [0, eta_max],\n                y0,\n                dense_output=True,\n                rtol=1e-13, # Use high-precision integration\n                atol=1e-13,\n            )\n            \n            # The value of f'(eta_max) is the second component of the solution vector\n            # at the last time point.\n            f_prime_at_eta_max = sol.y[1, -1]\n            residual = f_prime_at_eta_max - 1.0\n            memo[s] = residual\n            return residual\n\n        # Secant Method Implementation\n        s_prev, s_curr = s0, s1\n        r_prev = get_residual(s_prev)\n        r_curr = get_residual(s_curr)\n        \n        # Limit iterations to prevent infinite loops in case of non-convergence\n        max_iter = 50 \n        for _ in range(max_iter):\n            if abs(r_curr)  tol:\n                return s_curr\n\n            # Avoid division by zero\n            if abs(r_curr - r_prev)  1e-14:\n                break\n\n            s_next = s_curr - r_curr * (s_curr - s_prev) / (r_curr - r_prev)\n            \n            s_prev, s_curr = s_curr, s_next\n            r_prev, r_curr = r_curr, get_residual(s_curr)\n\n        return s_curr\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (10.0, 0.3, 0.35, 1e-10),\n        (8.0, 0.1, 1.0, 1e-8),\n        (6.0, 0.3, 0.35, 1e-8),\n        (12.0, 0.33, 0.34, 1e-12),\n    ]\n\n    results = []\n    for case in test_cases:\n        eta_max_val, s0_val, s1_val, tol_val = case\n        converged_s = blasius_solver(eta_max_val, s0_val, s1_val, tol_val)\n        results.append(converged_s)\n    \n    # Format the final output string as specified.\n    # The problem asks to return this string, not print it.\n    # The wrapper script will handle the final output.\n    output_str = ','.join([f\"{res:.6f}\" for res in results])\n    return f\"[{output_str}]\"\n\n# The final answer is generated by running the code. The problem statement implies\n# the code itself is part of the implementation answer.\n```", "answer": "[0.332057,0.332057,0.332058,0.332057]", "id": "2500302"}]}