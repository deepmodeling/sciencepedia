{"hands_on_practices": [{"introduction": "本练习提供了一个从第一性原理推导功率谱密度（PSD）的基础实践。我们将使用随机电报信号，这是一个经典的随机模型，用于描述在两个状态之间随机切换的系统，例如数字通信信道或量子点。通过首先计算信号的自相关函数，然后应用维纳-辛钦定理，您将看到一个过程的时域统计行为与其频率内容之间的直接联系 [@problem_id:2892488]。", "problem": "考虑一个如下定义的平稳随机电报过程。设 $x(t)$ 是一个取值于 $\\{ -A, +A \\}$（其中 $A>0$）的双态连续时间过程。符号过程 $s(t) \\coloneqq x(t)/A \\in \\{ -1, +1 \\}$ 作为一个时间齐次的连续时间马尔可夫链 (CTMC) 演化，其对称切换率为 $\\lambda>0$：在任意长度为 $\\Delta t$ 的小区间内，给定当前状态，发生一次切换的概率为 $\\lambda \\Delta t + o(\\Delta t)$，且与过去无关。假设该过程处于统计稳态，因此 $\\mathbb{P}\\{ s(t)=+1 \\} = \\mathbb{P}\\{ s(t)=-1 \\} = \\tfrac{1}{2}$ 且 $\\mathbb{E}[x(t)] = 0$。\n\n仅使用基本定义和第一性原理：\n- 从宽平稳过程的自相关函数定义 $R_{x}(\\tau) \\coloneqq \\mathbb{E}[x(t)\\,x(t+\\tau)]$ 出发，推导 $R_{x}(\\tau)$ 对所有 $\\tau \\in \\mathbb{R}$ 的显式闭式表达式。\n- 然后，从维纳-辛钦定理出发，该定理将宽平稳过程的功率谱密度 (PSD) $S_{x}(\\omega)$ 定义为其自相关函数的傅里叶变换，\n$$\nS_{x}(\\omega) \\coloneqq \\int_{-\\infty}^{\\infty} R_{x}(\\tau)\\,\\exp(-\\mathrm{j}\\,\\omega \\tau)\\,\\mathrm{d}\\tau,\n$$\n推导 $S_{x}(\\omega)$ 的闭式表达式。\n- 最后，使用宽平稳过程的逆关系式，直接从 $S_{x}(\\omega)$ 计算 $R_{x}(0)$，\n$$\nR_{x}(0) \\coloneqq \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} S_{x}(\\omega)\\,\\mathrm{d}\\omega,\n$$\n并验证该值与从过程定义中获得的值一致。\n\n将你的最终答案表示为一个包含功率谱密度和零延迟自相关的数对，顺序为 $\\big(S_{x}(\\omega),\\,R_{x}(0)\\big)$。不需要数值近似；请提供精确的闭式表达式。最终答案中不需要单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 过程：$x(t)$ 是一个双态连续时间平稳随机过程。\n- 取值：$x(t) \\in \\{ -A, +A \\}$，其中 $A>0$。\n- 符号过程：$s(t) \\coloneqq x(t)/A \\in \\{ -1, +1 \\}$。\n- 动态特性：$s(t)$ 是一个时间齐次的连续时间马尔可夫链 (CTMC)，对称切换率为 $\\lambda > 0$。在区间 $\\Delta t$ 内发生一次切换的概率为 $\\lambda \\Delta t + o(\\Delta t)$。\n- 稳态：该过程处于统计稳态，$\\mathbb{P}\\{ s(t)=+1 \\} = \\mathbb{P}\\{ s(t)=-1 \\} = \\frac{1}{2}$。\n- 均值：$\\mathbb{E}[x(t)] = 0$。\n- 自相关定义：$R_{x}(\\tau) \\coloneqq \\mathbb{E}[x(t)\\,x(t+\\tau)]$。\n- 功率谱密度 (PSD) 定义：$S_{x}(\\omega) \\coloneqq \\int_{-\\infty}^{\\infty} R_{x}(\\tau)\\,\\exp(-\\mathrm{j}\\,\\omega \\tau)\\,\\mathrm{d}\\tau$。\n- 逆关系：$R_{x}(0) \\coloneqq \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} S_{x}(\\omega)\\,\\mathrm{d}\\omega$。\n\n**步骤2：使用提取的已知条件进行验证**\n问题定义良好且科学上合理。\n- **科学依据：** 随机电报过程是随机过程理论中的一个典型模型，在物理学和工程学中有广泛应用。自相关和功率谱密度的定义是标准的。\n- **适定性：** 问题提供了推导指定统计量的唯一确定解所需的所有必要参数（$A$, $\\lambda$）以及推导指定统计量的唯一确定解所需的统计特性（平稳性、稳态概率）。\n- **客观性：** 问题以精确的数学语言陈述，没有歧义或主观内容。\n- **完整性与一致性：** 已知条件是自洽的。对于一个对称切换率为 $\\lambda$ 的 CTMC，指定的稳态分布 $\\mathbb{P}\\{s(t)=+1\\} = \\mathbb{P}\\{s(t)=-1\\} = \\frac{1}{2}$ 是正确的。该问题是随机信号分析中的一个标准且不平凡的练习。\n\n**步骤3：结论与行动**\n问题被判定为 **有效**。将提供一个完整的、有理有据的解答。\n\n**自相关函数 $R_{x}(\\tau)$ 的推导**\n\n过程 $x(t)$ 的自相关函数定义为 $R_{x}(\\tau) \\coloneqq \\mathbb{E}[x(t)\\,x(t+\\tau)]$。由于该过程是宽平稳的，此函数仅取决于时间延迟 $\\tau$。代入 $x(t) = A s(t)$，我们得到：\n$$R_{x}(\\tau) = \\mathbb{E}[A s(t) \\cdot A s(t+\\tau)] = A^2 \\mathbb{E}[s(t)s(t+\\tau)]$$\n我们来计算符号过程的自相关 $R_s(\\tau) = \\mathbb{E}[s(t)s(t+\\tau)]$。状态 $\\{+1, -1\\}$ 之间的转换以速率 $\\lambda$ 发生。这意味着在持续时间为 $\\tau' \\ge 0$ 的时间间隔内，状态转换的次数 $N(\\tau')$ 服从参数为 $\\lambda \\tau'$ 的泊松分布，即 $\\mathbb{P}\\{N(\\tau') = k\\} = \\frac{(\\lambda \\tau')^k}{k!} \\exp(-\\lambda \\tau')$。\n\n对于给定的时间延迟 $\\tau$，$s(t+\\tau)$ 的值与 $s(t)$ 的关系取决于在区间 $(t, t+\\tau]$ 内发生的切换次数。具体来说，$s(t+\\tau) = s(t) \\cdot (-1)^{N(|\\tau|)}$，其中 $N(|\\tau|)$ 是在长度为 $|\\tau|$ 的时间间隔内的切换次数。使用绝对值 $|\\tau|$ 是为了处理正延迟和负延迟，因为事件的数量取决于区间的持续时间。\n\n现在我们可以计算 $R_s(\\tau)$：\n$$R_s(\\tau) = \\mathbb{E}[s(t) \\cdot s(t) (-1)^{N(|\\tau|)}] = \\mathbb{E}[s(t)^2 \\cdot (-1)^{N(|\\tau|)}]$$\n由于 $s(t)$ 只能是 $+1$ 或 $-1$，所以 $s(t)^2$ 恒为 $1$。因此：\n$$R_s(\\tau) = \\mathbb{E}[(-1)^{N(|\\tau|)}]$$\n期望值是根据 $N(|\\tau|)$ 的泊松分布计算的：\n$$ \\mathbb{E}[(-1)^{N(|\\tau|)}] = \\sum_{k=0}^{\\infty} (-1)^k \\mathbb{P}\\{N(|\\tau|) = k\\} = \\sum_{k=0}^{\\infty} (-1)^k \\frac{(\\lambda|\\tau|)^k}{k!} \\exp(-\\lambda|\\tau|) $$\n$$ = \\exp(-\\lambda|\\tau|) \\sum_{k=0}^{\\infty} \\frac{(-\\lambda|\\tau|)^k}{k!} $$\n认出这是指数函数的级数展开式 $\\sum_{k=0}^{\\infty} \\frac{z^k}{k!} = \\exp(z)$，我们有：\n$$ R_s(\\tau) = \\exp(-\\lambda|\\tau|) \\exp(-\\lambda|\\tau|) = \\exp(-2\\lambda|\\tau|) $$\n因此，$x(t)$ 的自相关函数是：\n$$ R_{x}(\\tau) = A^2 \\exp(-2\\lambda|\\tau|) $$\n\n**功率谱密度 $S_{x}(\\omega)$ 的推导**\n\n功率谱密度 $S_{x}(\\omega)$ 是自相关函数 $R_{x}(\\tau)$ 的傅里叶变换，由维纳-辛欽定理定义：\n$$ S_{x}(\\omega) = \\int_{-\\infty}^{\\infty} R_{x}(\\tau) \\exp(-\\mathrm{j}\\omega\\tau) \\,\\mathrm{d}\\tau = \\int_{-\\infty}^{\\infty} A^2 \\exp(-2\\lambda|\\tau|) \\exp(-\\mathrm{j}\\omega\\tau) \\,\\mathrm{d}\\tau $$\n我们可以将实数线上的积分分成两部分：\n$$ S_{x}(\\omega) = A^2 \\left( \\int_{-\\infty}^{0} \\exp(2\\lambda\\tau) \\exp(-\\mathrm{j}\\omega\\tau) \\,\\mathrm{d}\\tau + \\int_{0}^{\\infty} \\exp(-2\\lambda\\tau) \\exp(-\\mathrm{j}\\omega\\tau) \\,\\mathrm{d}\\tau \\right) $$\n合并指数：\n$$ S_{x}(\\omega) = A^2 \\left( \\int_{-\\infty}^{0} \\exp((2\\lambda-\\mathrm{j}\\omega)\\tau) \\,\\mathrm{d}\\tau + \\int_{0}^{\\infty} \\exp(-(2\\lambda+\\mathrm{j}\\omega)\\tau) \\,\\mathrm{d}\\tau \\right) $$\n我们计算定积分。由于 $\\lambda > 0$，指数的实部确保了收敛性。\n$$ S_{x}(\\omega) = A^2 \\left( \\left[ \\frac{\\exp((2\\lambda-\\mathrm{j}\\omega)\\tau)}{2\\lambda-\\mathrm{j}\\omega} \\right]_{-\\infty}^{0} + \\left[ \\frac{\\exp(-(2\\lambda+\\mathrm{j}\\omega)\\tau)}{-(2\\lambda+\\mathrm{j}\\omega)} \\right]_{0}^{\\infty} \\right) $$\n计算在极限处的值：\n$$ S_{x}(\\omega) = A^2 \\left( \\left( \\frac{1}{2\\lambda-\\mathrm{j}\\omega} - 0 \\right) + \\left( 0 - \\frac{1}{-(2\\lambda+\\mathrm{j}\\omega)} \\right) \\right) $$\n$$ S_{x}(\\omega) = A^2 \\left( \\frac{1}{2\\lambda-\\mathrm{j}\\omega} + \\frac{1}{2\\lambda+\\mathrm{j}\\omega} \\right) $$\n使用公分母合并各项：\n$$ S_{x}(\\omega) = A^2 \\left( \\frac{(2\\lambda+\\mathrm{j}\\omega) + (2\\lambda-\\mathrm{j}\\omega)}{(2\\lambda-\\mathrm{j}\\omega)(2\\lambda+\\mathrm{j}\\omega)} \\right) = A^2 \\left( \\frac{4\\lambda}{(2\\lambda)^2 - (\\mathrm{j}\\omega)^2} \\right) $$\n$$ S_{x}(\\omega) = A^2 \\left( \\frac{4\\lambda}{4\\lambda^2 + \\omega^2} \\right) = \\frac{4A^2\\lambda}{\\omega^2 + 4\\lambda^2} $$\n这个 PSD 表达式是一个洛伦兹函数，这是具有指数自相关过程的特征。\n\n**$R_{x}(0)$ 的验证**\n\n问题要求通过对 PSD 积分来验证总功率，或均方值 $R_x(0)$。\n$$ R_{x}(0) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{x}(\\omega) \\,\\mathrm{d}\\omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{4A^2\\lambda}{\\omega^2 + 4\\lambda^2} \\,\\mathrm{d}\\omega $$\n我们提出常数因子：\n$$ R_{x}(0) = \\frac{4A^2\\lambda}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{\\omega^2 + (2\\lambda)^2} \\,\\mathrm{d}\\omega $$\n$\\frac{1}{u^2+c^2}$ 的积分是 $\\frac{1}{c}\\arctan(\\frac{u}{c})$。\n$$ \\int_{-\\infty}^{\\infty} \\frac{1}{\\omega^2 + (2\\lambda)^2} \\,\\mathrm{d}\\omega = \\left[ \\frac{1}{2\\lambda} \\arctan\\left(\\frac{\\omega}{2\\lambda}\\right) \\right]_{-\\infty}^{\\infty} $$\n$$ = \\frac{1}{2\\lambda} \\left( \\lim_{\\omega\\to\\infty} \\arctan\\left(\\frac{\\omega}{2\\lambda}\\right) - \\lim_{\\omega\\to-\\infty} \\arctan\\left(\\frac{\\omega}{2\\lambda}\\right) \\right) $$\n$$ = \\frac{1}{2\\lambda} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{2\\lambda}(\\pi) = \\frac{\\pi}{2\\lambda} $$\n将此结果代回 $R_{x}(0)$ 的表达式中：\n$$ R_{x}(0) = \\frac{4A^2\\lambda}{2\\pi} \\cdot \\frac{\\pi}{2\\lambda} = \\frac{4\\pi A^2\\lambda}{4\\pi\\lambda} = A^2 $$\n现在我们从过程的定义来验证这一点。$R_x(0)$ 是过程的均方值：\n$$ R_{x}(0) = \\mathbb{E}[x(t)^2] $$\n过程 $x(t)$ 取值为 $-A$ 和 $+A$。无论哪种情况，$x(t)^2 = A^2$。因此，期望值是常数：\n$$ \\mathbb{E}[x(t)^2] = A^2 $$\n通过对推导出的 PSD 积分得到的 $R_{x}(0)$ 值与直接从过程定义中得到的值一致。验证结束。\n所要求的量是功率谱密度 $S_x(\\omega)$ 和零延迟自相关 $R_x(0)$。\n最终答案是数对 $\\big(S_{x}(\\omega),\\,R_{x}(0)\\big)$。", "answer": "$$ \\boxed{ \\left( \\frac{4A^2\\lambda}{\\omega^2 + 4\\lambda^2}, A^2 \\right) } $$", "id": "2892488"}, {"introduction": "虽然功率谱密度的理论通常假设信号是无限长的，但现实世界的分析总是基于有限的数据记录。本练习将从理想情况转向实际应用，探讨有限长度分析中的一个关键产物：频谱泄漏。您将量化当单个正弦波的频率与离散傅里叶变换（DFT）的频率点未完全对齐时，其功率如何“泄漏”到多个频率点上，并分析由此导致的信号可检测性损失 [@problem_id:2892490]。这个练习为所谓的“扇形损失”现象提供了具体的理解。", "problem": "考虑一个相位未知的离散时间复正弦信号，该信号沉浸在加性噪声中。您观测一段有限长度的记录，并使用矩形窗计算其离散傅里叶变换 (DFT)。您的目标是描述当正弦信号的频率不完全落在 DFT 频率仓上时的频谱泄漏模式，并量化由此产生的可检测性损失。\n\n设观测到的时间序列为\n$$\nx[n] = A \\exp(\\mathrm{j}\\,\\omega_{0} n) + w[n], \\quad n \\in \\{0,1,\\ldots,N-1\\},\n$$\n其中 $A \\in \\mathbb{C}$ 是一个非零常数，$\\omega_{0} \\in \\mathbb{R}$ 是角频率（单位为弧度/采样点），$\\{w[n]\\}$ 是零均值加性高斯白噪声 (AWGN)，每个采样点的方差为 $\\sigma^{2}$。您应用一个长度为 $N$ 的矩形窗 $w_{\\mathrm{R}}[n]$，定义为当 $n \\in \\{0,1,\\ldots,N-1\\}$ 时 $w_{\\mathrm{R}}[n]=1$，否则 $w_{\\mathrm{R}}[n]=0$，并计算 $N$ 点离散傅里叶变换 (DFT)\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right), \\quad k \\in \\{0,1,\\ldots,N-1\\}.\n$$\n\n假设正弦信号的频率不完全落在 DFT 频率仓上。将其参数化为\n$$\n\\omega_{0} = \\frac{2\\pi}{N}\\big(k_{0}+\\delta\\big),\n$$\n其中 $k_{0} \\in \\{0,1,\\ldots,N-1\\}$ 是一个整数，$\\delta \\in (-\\tfrac{1}{2},\\tfrac{1}{2})\\setminus\\{0\\}$ 是小数仓偏移量。定义频率仓偏移量 $m = k - k_{0} \\in \\mathbb{Z}$。\n\n任务：\n- 从 DFT、矩形窗的定义以及独立高斯随机变量在线性变换下的性质出发，推导无噪声分量的精确频谱泄漏模式，即仅由正弦信号在频率仓 $k$ 中产生的期望周期图谱样本的表达式，\n$$\n\\mathbb{E}\\!\\left[\\,|X[k]|^{2}\\,\\middle|\\,A \\exp(\\mathrm{j}\\,\\omega_{0} n)\\,\\right],\n$$\n该表达式是关于 $A$、$N$、$\\delta$ 和 $m$ 的函数。\n- 通过最强 DFT 频率仓中的期望信号功率与该频率仓中噪声贡献的方差之比来建模单仓检测器的可检测性，即单仓信噪比 (SNR)。利用您的泄漏结果，确定当 $\\delta \\in (-\\tfrac{1}{2},\\tfrac{1}{2})$ 时最强的频率仓，并推导可检测性损失因子\n$$\nL(N,\\delta),\n$$\n该因子定义为在小数偏移 $\\delta$ 下的单仓信噪比与当 $\\delta=0$ (即信号频率在频率仓上) 时的单仓信噪比之比，其中 $A$、$N$ 和 $\\sigma^{2}$ 相同。以简化的解析表达式形式给出 $L(N,\\delta)$ 的闭式解。\n\n只需报告 $L(N,\\delta)$ 的表达式作为最终答案。无需进行数值计算。如果您引入任何缩略语，例如离散傅里叶变换 (DFT)、加性高斯白噪声 (AWGN)、功率谱密度 (PSD) 或信噪比 (SNR)，请在首次使用时对其进行定义。角度 $\\omega_{0}$ 的单位是弧度/采样点。", "solution": "所提出的问题是数字信号处理领域的一个标准探究，它提法明确，具有科学依据，并且拥有唯一、可验证的解。因此，我们可以进行形式化推导。\n\n观测到的时间序列为 $x[n] = s[n] + w[n]$，其中 $s[n] = A \\exp(\\mathrm{j}\\,\\omega_{0} n)$ 是复正弦信号，$w[n]$ 是均值为零、方差为 $\\sigma^{2}$ 的加性高斯白噪声 (AWGN)。$N$ 点离散傅里叶变换 (DFT) 是一种线性运算，这使我们能够独立地分析信号和噪声分量。$x[n]$ 的 DFT 为 $X[k] = S[k] + W[k]$，其中 $S[k]$ 是信号分量 $s[n]$ 的 DFT，$W[k]$ 是噪声分量 $w[n]$ 的 DFT。\n\n首先，我们推导无噪声信号的 DFT $S[k]$ 的表达式，它代表了频谱泄漏模式。信号频率参数化为 $\\omega_{0} = \\frac{2\\pi}{N}(k_{0}+\\delta)$。\n$$\nS[k] = \\sum_{n=0}^{N-1} s[n] \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right) = \\sum_{n=0}^{N-1} A \\exp(\\mathrm{j}\\,\\omega_{0} n) \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right)\n$$\n代入 $\\omega_{0}$ 的表达式：\n$$\nS[k] = A \\sum_{n=0}^{N-1} \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta) n\\right) \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{N} n\\right) = A \\sum_{n=0}^{N-1} \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta-k) n\\right)\n$$\n这是一个形式为 $\\sum_{n=0}^{N-1} r^{n}$ 的几何级数，其中 $r = \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta-k)\\right)$。由于 $\\delta \\in (-\\tfrac{1}{2}, \\tfrac{1}{2})\\setminus\\{0\\}$，项 $k_{0}+\\delta-k$ 永远不是整数，因此 $r \\neq 1$。应用有限几何级数的求和公式 $\\sum_{n=0}^{N-1} r^{n} = \\frac{1-r^{N}}{1-r}$：\n$$\nS[k] = A \\frac{1 - \\exp\\left(\\mathrm{j}\\,2\\pi(k_{0}+\\delta-k)\\right)}{1 - \\exp\\left(\\mathrm{j}\\,\\frac{2\\pi}{N}(k_{0}+\\delta-k)\\right)}\n$$\n由于 $k$ 和 $k_{0}$ 是整数，所以 $\\exp(-\\mathrm{j}\\,2\\pi(k-k_{0})) = 1$。分子简化为 $1 - \\exp(\\mathrm{j}\\,2\\pi\\delta)$。\n为了求模，我们使用恒等式 $|1-\\exp(\\mathrm{j}\\,\\theta)| = | \\exp(\\mathrm{j}\\,\\theta/2) (\\exp(-\\mathrm{j}\\,\\theta/2) - \\exp(\\mathrm{j}\\,\\theta/2)) | = | -2\\mathrm{j}\\,\\sin(\\theta/2) | = 2|\\sin(\\theta/2)|$。\n将此应用于分子和分母：\n$$\n|S[k]| = |A| \\frac{|\\sin(\\pi(k_0+\\delta-k))|}{|\\sin(\\frac{\\pi}{N}(k_0+\\delta-k))|}\n$$\n已知 $k-k_0$ 是一个整数，令 $m = k-k_0$。那么 $\\sin(\\pi(k_0-k+\\delta)) = \\sin(-\\pi m + \\pi\\delta) = \\sin(\\pi\\delta)\\cos(\\pi m) - \\cos(\\pi\\delta)\\sin(\\pi m) = (-1)^{m}\\sin(\\pi\\delta)$。模不受符号影响，因此 $|\\sin(\\pi(k_0-k+\\delta))| = |\\sin(\\pi\\delta)|$。\n因此，信号 DFT 的模为：\n$$\n|S[k]| = |A| \\frac{|\\sin(\\pi\\delta)|}{|\\sin(\\frac{\\pi}{N}(\\delta-m))|}\n$$\n仅由信号产生的期望周期图谱样本就是 $S[k]$ 的模平方，因为信号是确定性的：\n$$\n\\mathbb{E}\\!\\left[\\,|X[k]|^{2}\\,\\middle|\\,A \\exp(\\mathrm{j}\\,\\omega_{0} n)\\,\\right] = |S[k]|^2 = |A|^2 \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi}{N}(\\delta-m)\\right)} \\right)^2\n$$\n该表达式描述了频谱泄漏模式，它是 $A$、$N$、$\\delta$ 和频率仓偏移量 $m = k-k_0$ 的函数。\n\n接下来，我们分析噪声的贡献。噪声的 DFT 是 $W[k] = \\sum_{n=0}^{N-1} w[n] \\exp(-\\mathrm{j}\\,\\frac{2\\pi k n}{N})$。由于 $\\mathbb{E}[w[n]]=0$，可得 $\\mathbb{E}[W[k]]=0$。频率仓 $k$ 中噪声贡献的方差是：\n$$\n\\text{Var}(W[k]) = \\mathbb{E}[|W[k]|^2] = \\mathbb{E}\\left[ \\left(\\sum_{n=0}^{N-1} w[n] e^{-\\mathrm{j}\\frac{2\\pi kn}{N}}\\right) \\left(\\sum_{l=0}^{N-1} w^*[l] e^{\\mathrm{j}\\frac{2\\pi kl}{N}}\\right) \\right]\n$$\n$$\n\\text{Var}(W[k]) = \\sum_{n=0}^{N-1}\\sum_{l=0}^{N-1} \\mathbb{E}[w[n]w^*[l]] \\exp\\left(-\\mathrm{j}\\frac{2\\pi k(n-l)}{N}\\right)\n$$\n对于 AWGN，采样点是不相关的，因此 $\\mathbb{E}[w[n]w^*[l]] = \\sigma^2 \\delta_{nl}$，其中 $\\delta_{nl}$ 是克罗内克 δ (Kronecker delta)。\n$$\n\\text{Var}(W[k]) = \\sum_{n=0}^{N-1}\\sum_{l=0}^{N-1} \\sigma^2 \\delta_{nl} \\exp\\left(-\\mathrm{j}\\frac{2\\pi k(n-l)}{N}\\right) = \\sum_{n=0}^{N-1} \\sigma^2 = N\\sigma^2\n$$\n噪声功率在所有 DFT 频率仓中是恒定的。\n\n可检测性由单仓信噪比 (SNR) 建模，其定义为最强 DFT 频率仓中的期望信号功率与该频率仓中噪声方差之比。为了找到最强的频率仓，我们必须最大化 $|S[k]|^2$，这等价于最小化分母项 $|\\sin(\\frac{\\pi}{N}(\\delta-m))|$。由于 $\\delta \\in (-\\frac{1}{2}, \\frac{1}{2})$，对于整数 $m$，当 $m=0$ 时 $|\\delta-m|$ 的值最小。这对应于频率仓 $k=k_0$。因此，最强的频率仓是 $k_0$。\n\n最强频率仓 $(m=0)$ 中的信号功率为：\n$$\n|S[k_0]|^2 = |A|^2 \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2\n$$\n对于小数偏移 $\\delta$，单仓信噪比为：\n$$\n\\text{SNR}(\\delta) = \\frac{|S[k_0]|^2}{\\text{Var}(W[k_0])} = \\frac{|A|^2}{N\\sigma^2} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2\n$$\n现在，我们必须求出频率仓上正弦信号 (on-bin sinusoid) 的参考信噪比，此时 $\\delta=0$。在这种情况下，$\\omega_0 = \\frac{2\\pi k_0}{N}$。信号的 DFT 变为 $S[k] = A \\sum_{n=0}^{N-1} \\exp(\\mathrm{j}\\frac{2\\pi(k_0-k)n}{N})$。由于 DFT 基函数的正交性，当 $k=k_0$ 时，此和为 $A N$，否则为 $0$。所有信号功率都集中在频率仓 $k_0$ 中。\n信号功率为 $|S[k_0]|^2 = |A|^2 N^2$。噪声功率仍为 $N\\sigma^2$。\n因此，频率仓上的信噪比为：\n$$\n\\text{SNR}(0) = \\frac{|A|^2 N^2}{N\\sigma^2} = \\frac{|A|^2 N}{\\sigma^2}\n$$\n这个结果也可以通过求 $\\text{SNR}(\\delta)$ 当 $\\delta \\to 0$ 时的极限得到，使用当 $x$ 很小时 $\\sin(x) \\approx x$ 的近似：\n$$\n\\lim_{\\delta\\to 0} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2 = \\lim_{\\delta\\to 0} \\left( \\frac{\\pi\\delta}{\\frac{\\pi\\delta}{N}} \\right)^2 = N^2\n$$\n因此，$\\lim_{\\delta\\to 0} \\text{SNR}(\\delta) = \\frac{|A|^2}{N\\sigma^2} N^2 = \\text{SNR}(0)$。\n\n最后，可检测性损失因子 $L(N, \\delta)$ 是 $\\text{SNR}(\\delta)$ 与 $\\text{SNR}(0)$ 的比值：\n$$\nL(N, \\delta) = \\frac{\\text{SNR}(\\delta)}{\\text{SNR}(0)} = \\frac{\\frac{|A|^2}{N\\sigma^2} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2}{\\frac{|A|^2 N}{\\sigma^2}}\n$$\n消去公因子，我们得到最终的表达式：\n$$\nL(N,\\delta) = \\frac{1}{N^2} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^2\n$$\n这就是所要求的可检测性损失因子的闭式解析表达式。", "answer": "$$\n\\boxed{\n\\frac{1}{N^{2}} \\left( \\frac{\\sin(\\pi\\delta)}{\\sin\\left(\\frac{\\pi\\delta}{N}\\right)} \\right)^{2}\n}\n$$", "id": "2892490"}, {"introduction": "在探索了功率谱密度的理论定义及其实际估计中的一个主要挑战之后，我们现在转向一个更高层次的问题：如何为特定任务选择正确的工具。本练习比较了三种广泛使用的功率谱密度估计方法——Bartlett法、Welch法和多窗谱法，促使您分析偏差（例如频谱泄漏）和方差（估计的稳定性）之间的基本权衡。通过在特定场景下评估它们的性能，您将培养出为不同类型的信号和分析目标选择合适谱估计器所需的批判性判断力 [@problem_id:2892460]。", "problem": "给定一个持续时间为 $T = 10\\,\\mathrm{s}$、采样率为 $F_s = 1000\\,\\mathrm{Hz}$ 的单实值、零均值、宽平稳离散时间记录，因此样本数为 $N = 10{,}000$。您希望估计其功率谱密度 (PSD)，其定义为自相关函数的傅里叶变换，有效分辨率带宽约为 $B_{\\mathrm{res}} = 2\\,\\mathrm{Hz}$，这意味着估计器应能解析 $2\\,\\mathrm{Hz}$ 量级的特征，同时控制谱泄漏和估计方差。考虑三种估计器，它们经过调整以达到大致相同的有效分辨率带宽：(i) Bartlett 估计器，通过对等长的矩形窗分段的非重叠周期图进行平均而形成；(ii) Welch 估计器，通过对重叠、加窗的 (例如，Hann窗) 周期图进行平均而形成；以及 (iii) 多窗格估计器，使用 $K$ 个正交离散扁长球状序列 (DPSS)，其时间半带宽 $W$ 的选择与期望分辨率相称。从周期图、PSD（作为自相关函数的傅里叶变换）的核心定义，以及加窗和平均对期望（通过与谱窗卷积）和方差（通过对近似独立的估计进行平均）的影响出发，确定在给定有限记录长度的情况下，哪种陈述在固定分辨率带宽下最好地比较了这三种方法之间的偏差和方差权衡，并指出了有利于每种方法的现实条件。\n\n选择唯一的最佳选项。\n\nA. 当每种方法都调整到相同的有效分辨率带宽时，对于此记录长度，Bartlett 和多窗格估计器通常会获得相当的有效自由度（因此方差减小相似），而由于重叠和加窗带来的依赖性，Welch 产生的有效自由度略少于其原始分段数。在偏差方面，Bartlett 的矩形分段具有窄主瓣但高旁瓣，对于有色谱或非整数倍频率正弦波会产生较大的泄漏偏差；Welch 的加窗减少了泄漏偏差，但需要更长的分段来保持相同的分辨率；多窗格估计器通过将能量集中在目标频带内，最小化了指定带宽的泄漏，因此对于在所选带宽内局部平滑的谱提供了最低的偏差。当谱接近白噪声或音调位于频率仓中心且计算简单性至关重要时，Bartlett 更受青睐；当需要控制泄漏并从单个记录中实现适度的方差减小时，Welch 更受青睐；当要求在指定分辨率下获得近最小均方误差时，尤其对于中短记录或混合线谱/连续谱，多窗格估计器更受青睐。\n\nB. 在相同的有效分辨率带宽下，Welch 总是获得最大数量的独立平均，因为重叠增加了独立性，所以其方差是三者中最低的；多窗格估计器的方差最高，因为窗不是独立的，并且由于其等效噪声带宽更宽，其偏差比 Bartlett 的要大。当存在强谱线时应使用 Welch，而多窗格估计器主要用于非常长的白噪声谱。\n\nC. 如果有效分辨率带宽匹配，Bartlett 的偏差最低，因为其主瓣最窄，而 Welch 和多窗格估计器都因加窗而产生更大的偏差；多窗格估计器仅减少离散谱线的泄漏，否则会增加连续谱的偏差。因此，对于有色谱应首选 Bartlett，仅当分段可以变得非常长时才使用 Welch，仅当记录极长时才使用多窗格估计器。\n\nD. 在相同的有效分辨率带宽下，这三种估计器的偏差和方差基本相同，因此在 Bartlett、Welch 和多窗格估计器之间的选择是任意的，与记录长度、重叠或窗的属性无关；重叠总是按重叠百分比成比例地增加自由度，并且不影响偏差，因为在固定分辨率下窗形状是无关紧要的。", "solution": "问题要求对三种功率谱密度 (PSD) 估计方法进行批判性比较：Bartlett、Welch 和多窗格。比较需要在这样的约束下进行：对于一个长度为 $N=10,000$ 个样本、采样率为 $F_s = 1000 \\, \\mathrm{Hz}$ 的给定离散时间信号记录，这三种方法都经过调整以达到相同的有效分辨率带宽 $B_{\\mathrm{res}} \\approx 2 \\, \\mathrm{Hz}$。分析必须侧重于偏差和方差之间的权衡。\n\n首先，我们为比较建立理论基础。宽平稳 (WSS) 过程的 PSD, $S_{xx}(f)$ 是其自相关函数 $R_{xx}[m]$ 的傅里叶变换。PSD 的一个基本估计器是周期图 $I(f)$，它是数据记录的离散傅里叶变换 (DFT) 幅度的平方，并按其长度进行缩放。对于长度为 $L$ 的记录 $x[n]$，周期图为 $I(f) = \\frac{1}{L} \\left| \\sum_{n=0}^{L-1} w[n] x[n] e^{-j2\\pi f n/F_s} \\right|^2$，其中 $w[n]$ 是一个窗函数。\n\nPSD 估计器的统计特性由其偏差和方差来表征。\n1.  **偏差**：估计器的期望值 $E[\\hat{S}_{xx}(f)]$ 与真实 PSD $S_{xx}(f)$ 通过与谱窗 $|W(f)|^2$ 的卷积相关联，其中 $W(f)$ 是窗函数 $w[n]$ 的傅里叶变换。\n    $$ E[\\hat{S}_{xx}(f)] \\approx S_{xx}(f) * \\frac{1}{L} |W(f)|^2 $$\n    偏差有两个组成部分：由 $|W(f)|^2$ 的主瓣宽度引起的展宽/分辨率偏差，以及由其旁瓣引起的泄漏偏差。由于问题为所有方法固定了有效分辨率带宽 $B_{\\mathrm{res}}$，我们实际上是在匹配它们的主瓣宽度。因此，偏差的关键区别因素是旁瓣泄漏。\n2.  **方差**：对于高斯过程，原始周期图的方差很高，`var`$(I(f)) \\approx (E[I(f)])^2$。为了减小这个方差，采用了平均法。如果一个估计器是通过平均 $K_{\\mathrm{eff}}$ 个有效独立的周期图形成的，其方差会减小一个因子 $K_{\\mathrm{eff}}$：\n    $$ \\mathrm{var}(\\hat{S}_{xx}(f)) \\approx \\frac{1}{K_{\\mathrm{eff}}} (E[\\hat{S}_{xx}(f)])^2 $$\n    数量 $2K_{\\mathrm{eff}}$ 被称为有效自由度。\n\n让我们使用给定的数据记录属性（$N=10,000$, $F_s=1000 \\, \\mathrm{Hz}$），将每种方法调整到指定的分辨率 $B_{\\mathrm{res}} = 2 \\, \\mathrm{Hz}$。\n\n**方法 (i): Bartlett 估计器**\n该方法将长度为 $N$ 的记录划分为 $K$ 个长度为 $L$ 的非重叠分段，为每个分段计算一个周期图，然后对结果进行平均。窗函数为矩形窗。分辨率约为 $B_{\\mathrm{res}} \\approx F_s/L$。\n- 为了实现 $B_{\\mathrm{res}} = 2 \\, \\mathrm{Hz}$，分段长度必须为 $L \\approx F_s / B_{\\mathrm{res}} = 1000 / 2 = 500$ 个样本。\n- 非重叠分段的数量为 $K_{\\mathrm{avg}} = \\lfloor N/L \\rfloor = \\lfloor 10,000 / 500 \\rfloor = 20$。\n- **偏差**：矩形窗具有高旁瓣（第一旁瓣在 $-13.3 \\, \\mathrm{dB}$）。这会导致显著的谱泄漏，引起高偏差，特别是对于具有大动态范围的谱（例如，强正弦波与弱噪声混合）。\n- **方差**：由于分段不重叠，它们是近似独立的。因此，$K_{\\mathrm{eff}} \\approx K_{\\mathrm{avg}} = 20$。方差减小了 20 倍。\n\n**方法 (ii): Welch 估计器**\n该方法使用重叠、加窗的分段。一个常见的选择是具有 $50\\%$ 重叠的 Hann 窗。Hann 窗的主瓣比矩形窗的宽。分辨率约为 $B_{\\mathrm{res}} \\approx 1.5 F_s/L$。\n- 为了实现 $B_{\\mathrm{res}} = 2 \\, \\mathrm{Hz}$，分段长度必须为 $L \\approx 1.5 F_s / B_{\\mathrm{res}} = 1.5 \\times 1000 / 2 = 750$ 个样本。\n- 对于 $50\\%$ 的重叠，步长为 $L/2 = 375$。分段数为 $K_{\\mathrm{avg}} = \\lfloor(N - L) / (L/2)\\rfloor + 1 = \\lfloor (10000 - 750) / 375 \\rfloor + 1 = 25$。\n- **偏差**：Hann 窗的旁瓣远低于矩形窗（第一旁瓣在 $-31.5 \\, \\mathrm{dB}$）。这极大地减少了谱泄漏，与 Bartlett 方法相比，偏差显著降低。为了匹配先验固定的分辨率，我们必须使用更长的分段，这是权衡的一个关键部分。\n- **方差**：重叠的分段不是独立的。对于 Hann 窗和 $50\\%$ 重叠，方差减小量小于原始分段数。有效独立分段数约为 $K_{\\mathrm{eff}} \\approx \\frac{9}{16} K_{\\mathrm{avg}} = \\frac{9}{16} \\times 25 \\approx 14.1$。方差减小了约 14 倍。\n\n**方法 (iii): 多窗格估计器**\n该方法将一组 $K$ 个正交窗——离散扁长球状序列 (DPSS) 或 Slepian 序列——应用于整个数据记录。分辨率由时间半带宽积 $p = TW$ 决定，其中 $T$ 是记录持续时间（$10 \\, \\mathrm{s}$），$2W$ 是分辨率带宽（Hz）。\n- 为了实现 $B_{\\mathrm{res}} = 2W = 2 \\, \\mathrm{Hz}$，半带宽参数为 $W=1 \\, \\mathrm{Hz}$。\n- 时间半带宽积为 $p = T \\times W = 10 \\, \\mathrm{s} \\times 1 \\, \\mathrm{Hz} = 10$。\n- 有用的窗的数量（特征值接近 1）为 $K \\approx 2p - 1 = 2(10) - 1 = 19$。我们对得到的 $K=19$ 个特征谱进行平均。\n- **偏差**：DPSS 窗被设计为在频带 $[-W, W]$ 内最优集中，从而最小化该频带外的泄漏。该方法为指定的分辨率提供了可能最低的泄漏偏差。\n- **方差**：来自正交窗的特征谱是近似独立的。因此，$K_{\\mathrm{eff}} \\approx K = 19$。方差减小了 19 倍。\n\n**$B_{\\mathrm{res}} \\approx 2 \\, \\mathrm{Hz}$ 下的比较总结：**\n- **偏差 (泄漏)**: 多窗格 (最低) $$ Welch (低) $\\ll$ Bartlett (高)。\n- **方差减小 ($K_{\\mathrm{eff}}$)**: Bartlett ($\\approx 20$) $\\approx$ 多窗格 ($\\approx 19$) $$ Welch ($\\approx 14$)。\n\n该分析表明，在相同的分辨率下，Bartlett 的偏差最差。与 Bartlett 相比，Welch 以牺牲一些方差减小为代价改善了偏差。多窗格估计器提供了最佳的偏差减小（最低泄漏），其方差减小与 Bartlett 的相当。\n\n现在，我们根据此分析评估每个提供的选项。\n\n**A. 当每种方法都调整到相同的有效分辨率带宽时，对于此记录长度，Bartlett 和多窗格估计器通常会获得相当的有效自由度（因此方差减小相似），而由于重叠和加窗带来的依赖性，Welch 产生的有效自由度略少于其原始分段数。在偏差方面，Bartlett 的矩形分段具有窄主瓣但高旁瓣，对于有色谱或非整数倍频率正弦波会产生较大的泄漏偏差；Welch 的加窗减少了泄漏偏差，但需要更长的分段来保持相同的分辨率；多窗格估计器通过将能量集中在目标频带内，最小化了指定带宽的泄漏，因此对于在所选带宽内局部平滑的谱提供了最低的偏差。当谱接近白噪声或音调位于频率仓中心且计算简单性至关重要时，Bartlett 更受青睐；当需要控制泄漏并从单个记录中实现适度的方差减小时，Welch 更受青睐；当要求在指定分辨率下获得近最小均方误差时，尤其对于中短记录或混合线谱/连续谱，多窗格估计器更受青睐。**\n\n该陈述与我们的推导完全一致。\n- 它正确地指出 Bartlett 和多窗格估计器具有相当的方差减小（分别为 $K_{\\mathrm{eff}} \\approx 20$ 和 $K_{\\mathrm{eff}} \\approx 19$）。\n- 它正确地注意到 Welch 的有效自由度少于其原始分段数。\n- 它准确地描述了 Bartlett 的矩形窗旁瓣带来的高泄漏偏差。\n- 它正确地解释了 Welch 的加窗减少了泄漏，但需要更长的分段以保持相同的分辨率。\n- 它正确地将多窗格估计器确定为通过设计来最小化泄漏偏差。\n- 用例总结是标准且正确的：Bartlett 用于简单情况，Welch 作为通用折衷方案，多窗格估计器用于高性能应用，尤其是在具有挑战性或短的数据集上。\n**结论：正确。**\n\n**B. 在相同的有效分辨率带宽下，Welch 总是获得最大数量的独立平均，因为重叠增加了独立性，所以其方差是三者中最低的；多窗格估计器的方差最高，因为窗不是独立的，并且由于其等效噪声带宽更宽，其偏差比 Bartlett 的要大。当存在强谱线时应使用 Welch，而多窗格估计器主要用于非常长的白噪声谱。**\n\n该陈述包含多个基本错误。\n- 重叠引入了依赖性，它不增加独立性。\n- 在我们的计算中，Welch 的方差最高（$K_{\\mathrm{eff}}$ 最低）。\n- 多窗格估计器的窗 (DPSS) 是正交的，并且得到的估计是近似独立的，从而导致良好的方差减小，而不是最高的方差。\n- 多窗格估计器的偏差是最低的，而不是比 Bartlett 的大。\n- 多窗格估计器由于其低泄漏而对具有强谱线的谱更优越；其主要优势在于中短记录，而不是简单的（白谱）方法就足够的非常长的记录。\n**结论：不正确。**\n\n**C. 如果有效分辨率带宽匹配，Bartlett 的偏差最低，因为其主瓣最窄，而 Welch 和多窗格估计器都因加窗而产生更大的偏差；多窗格估计器仅减少离散谱线的泄漏，否则会增加连续谱的偏差。因此，对于有色谱应首选 Bartlett，仅当分段可以变得非常长时才使用 Welch，仅当记录极长时才使用多窗格估计器。**\n\n该陈述在事实上是错误的。\n- Bartlett 具有最高的泄漏偏差，而不是最低的。对于给定的 $L$，窄主瓣与固定分辨率下的偏差是不同的概念。\n- 加窗是*减少*泄漏偏差的主要方法。\n- 多窗格估计器对于连续谱和离散谱都非常出色。\n- Bartlett 是有色谱的最差选择。多窗格估计器的优势在短记录上最为显著。\n**结论：不正确。**\n\n**D. 在相同的有效分辨率带宽下，这三种估计器的偏差和方差基本相同，因此在 Bartlett、Welch 和多窗格估计器之间的选择是任意的，与记录长度、重叠或窗的属性无关；重叠总是按重叠百分比成比例地增加自由度，并且不影响偏差，因为在固定分辨率下窗形状是无关紧要的。**\n\n该陈述否定了整个高级谱估计领域。\n- 这些估计器具有截然不同的偏差-方差特性。\n- 选择不是任意的，并且关键取决于数据和目标。\n- 窗形状是决定泄漏偏差的最重要因素。\n- 重叠对自由度的影响不是成比例的。\n**结论：不正确。**\n\n基于详尽的分析，选项 A 是唯一一个对这三种方法提供了科学上合理且详细比较的选项。", "answer": "$$\\boxed{A}$$", "id": "2892460"}]}