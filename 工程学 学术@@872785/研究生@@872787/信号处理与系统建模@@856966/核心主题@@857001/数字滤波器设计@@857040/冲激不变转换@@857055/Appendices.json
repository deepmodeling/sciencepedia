{"hands_on_practices": [{"introduction": "为了真正掌握脉冲不变性变换，我们必须回归其第一性原理。本练习将挑战你从一个特定的系统互连框图出发，推导连续时间脉冲响应 $h_a(t)$ 和离散时间脉冲响应 $h_d[n]$ 之间的基本关系。通过这个过程，你将深刻理解变换关系中是否存在以及为何存在尺度因子 $T$，从而澄清这一理论中的一个常见困惑点。[@problem_id:2877401]", "problem": "考虑一个连续时间线性时不变系统，其冲激响应 $h_a(t)$ 是绝对可积的，并且连续时间傅里叶变换 (CTFT) 的定义为\n$$\nH_a(j\\Omega)=\\int_{-\\infty}^{\\infty} h_a(t)\\, \\exp(-j\\Omega t)\\, dt.\n$$\n设采样周期为 $T0$。我们希望找到一个离散时间线性时不变系统，其冲激响应 $h_d[n]$ 是通过冲激不变法从 $h_a(t)$ 获得的。假设存在以下互联结构：对于一个任意的离散时间输入序列 $x[n]$，构造一个连续时间输入\n$$\nx_a(t) = \\sum_{n=-\\infty}^{\\infty} x[n]\\, \\delta(t-nT),\n$$\n用 $x_a(t)$ 驱动该连续时间系统以获得 $y_a(t)$，并要求离散时间系统的输出 $y[n]$ 满足\n$$\ny[n]=y_a(nT)\\quad\\text{对所有整数 }n.\n$$\n设离散时间傅里叶变换 (DTFT) 定义为\n$$\nX_d(\\exp(j\\omega))=\\sum_{n=-\\infty}^{\\infty} x[n]\\, \\exp(-j\\omega n),\n$$\n其逆变换为\n$$\nx[n]=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi} X_d(\\exp(j\\omega))\\, \\exp(j\\omega n)\\, d\\omega.\n$$\n假设一个时域关系的形式为\n$$\nh_d[n]=\\gamma\\, h_a(nT),\n$$\n其中 $\\gamma$ 是一个与 $n$ 和 $T$ 无关的标量。从 $y_a(t)$ 和 $y[n]$ 的卷积定义以及上述 CTFT 和 DTFT 的约定出发，推导冲激不变关系式 $h_d[n]$ 中是否包含因子 $T$；也就是说，确定 $\\gamma$ 的值。然后，仅使用关于采样和泊松求和公式的成熟结论，通过关联 $H_d(\\exp(j\\omega))$ 和 $H_a(j\\Omega)$，在频域中验证你的结果。你的最终答案必须是 $\\gamma$ 的值，以一个实数形式给出。不需要四舍五入。", "solution": "该问题要求为一个从连续时间系统派生出的特定离散时间系统，确定其冲激不变关系式 $h_d[n] = \\gamma h_a(nT)$ 中的比例常数 $\\gamma$。推导必须首先基于所提供的系统互联结构在时域中进行，然后在频域中进行验证。\n\n首先，我们验证问题陈述的有效性。\n已知条件是：\n1.  一个连续时间线性时不变 (LTI) 系统，其冲激响应 $h_a(t)$ 绝对可积。\n2.  连续时间傅里叶变换 (CTFT) 的定义：$H_a(j\\Omega)=\\int_{-\\infty}^{\\infty} h_a(t)\\, \\exp(-j\\Omega t)\\, dt$。\n3.  一个采样周期 $T0$。\n4.  一个离散时间 LTI 系统，其冲激响应为 $h_d[n]$。\n5.  系统互联结构定义为：将任意离散时间输入 $x[n]$ 转换为连续时间信号 $x_a(t) = \\sum_{n=-\\infty}^{\\infty} x[n]\\, \\delta(t-nT)$。该信号驱动连续时间系统产生 $y_a(t)$。离散时间系统的输出 $y[n]$ 通过对连续时间输出进行采样获得：$y[n]=y_a(nT)$。\n6.  离散时间傅里叶变换 (DTFT) 的定义：$X_d(\\exp(j\\omega))=\\sum_{n=-\\infty}^{\\infty} x[n]\\, \\exp(-j\\omega n)$。\n7.  假设的关系式：$h_d[n]=\\gamma\\, h_a(nT)$。\n\n该问题具有科学依据，提法得当，客观，且不包含内部矛盾或缺失信息。所有术语均为信号处理理论中的标准术语。问题是基于所提供定义的形式化推导。因此，该问题是有效的。\n\n我们开始求解。\n\n**时域推导**\n\n找到等效离散时间系统的冲激响应 $h_d[n]$ 的最直接方法是使用离散时间冲激作为输入，并找出相应的输出序列。设输入为单位冲激序列 $x[n]=\\delta[n]$，其中当 $n=0$ 时 $\\delta[n]=1$，当 $n \\neq 0$ 时 $\\delta[n]=0$。\n\n根据问题定义，这个离散时间输入被用来构成连续时间信号 $x_a(t)$：\n$$\nx_a(t) = \\sum_{k=-\\infty}^{\\infty} x[k]\\, \\delta(t-kT) = \\sum_{k=-\\infty}^{\\infty} \\delta[k]\\, \\delta(t-kT)\n$$\n由于离散时间冲激 $\\delta[k]$ 的性质，求和式中唯一的非零项是 $k=0$ 的那一项。因此，连续时间输入信号变为：\n$$\nx_a(t) = \\delta[0]\\, \\delta(t-0 \\cdot T) = 1 \\cdot \\delta(t) = \\delta(t)\n$$\n这个信号是一个连续时间的狄拉克冲激，它是冲激响应为 $h_a(t)$ 的连续时间 LTI 系统的输入。该系统的输出 $y_a(t)$ 由输入与冲激响应的卷积给出：\n$$\ny_a(t) = x_a(t) * h_a(t) = \\int_{-\\infty}^{\\infty} x_a(\\tau) h_a(t-\\tau) \\, d\\tau = \\int_{-\\infty}^{\\infty} \\delta(\\tau) h_a(t-\\tau) \\, d\\tau\n$$\n根据狄拉克 delta 函数的筛选特性，该积分的计算结果为：\n$$\ny_a(t) = h_a(t-0) = h_a(t)\n$$\n问题陈述中说明，离散时间输出 $y[n]$ 是通过在采样周期 $T$ 的整数倍时刻对 $y_a(t)$ 进行采样得到的：\n$$\ny[n] = y_a(nT) = h_a(nT)\n$$\n根据定义，当输入为单位冲激序列 $\\delta[n]$ 时，离散时间 LTI 系统的输出就是该系统的冲激响应 $h_d[n]$。因此，我们得到：\n$$\nh_d[n] = h_a(nT)\n$$\n问题假设了一个形式为 $h_d[n]=\\gamma\\, h_a(nT)$ 的关系。将我们推导出的结果与此假设进行比较，我们可以直接得出结论，比例常数 $\\gamma$ 为：\n$$\n\\gamma = 1\n$$\n\n**频域验证**\n\n我们现在通过在频域中分析该系统来验证这一结果。我们来求离散时间系统的频率响应 $H_d(\\exp(j\\omega))$。\n离散时间输入 $x[n]$ 和连续时间输入 $x_a(t)$ 之间的关系是已知的。它们的傅里叶变换是相关的。$x_a(t)$ 的 CTFT 是：\n$$\nX_a(j\\Omega) = \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} x[n]\\, \\delta(t-nT)\\right\\} = \\sum_{n=-\\infty}^{\\infty} x[n]\\, \\mathcal{F}\\{\\delta(t-nT)\\} = \\sum_{n=-\\infty}^{\\infty} x[n]\\, \\exp(-j\\Omega nT)\n$$\n这个表达式是 $x[n]$ 的 DTFT，$X_d(\\exp(j\\omega))$，其中进行了代换 $\\omega=\\Omega T$。所以，$X_a(j\\Omega) = X_d(\\exp(j\\Omega T))$。\n\n连续时间滤波器在频域中的输出是 $Y_a(j\\Omega) = H_a(j\\Omega) X_a(j\\Omega)$：\n$$\nY_a(j\\Omega) = H_a(j\\Omega) X_d(\\exp(j\\Omega T))\n$$\n离散时间输出 $y[n]$ 是通过在 $t=nT$ 时刻对 $y_a(t)$ 进行采样得到的。采样后信号的 DTFT, $Y_d(\\exp(j\\omega))$，与原始信号的 CTFT, $Y_a(j\\Omega)$，通过混叠公式相关联，该公式是泊松求和公式的一个推论：\n$$\nY_d(\\exp(j\\omega)) = \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} Y_a\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right)\n$$\n代入 $Y_a(j\\Omega)$ 的表达式：\n$$\nY_d(\\exp(j\\omega)) = \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} H_a\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right) X_d\\left(\\exp\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)T\\right)\\right)\n$$\n$X_d$ 中指数的参数可以简化为：\n$$\n\\exp\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)T\\right) = \\exp(j(\\omega - 2\\pi k)) = \\exp(j\\omega)\\exp(-j2\\pi k) = \\exp(j\\omega)\n$$\n因为 $k$ 是整数。因此，项 $X_d(\\exp(j\\omega))$ 与求和索引 $k$ 无关，可以被提出来：\n$$\nY_d(\\exp(j\\omega)) = X_d(\\exp(j\\omega)) \\left[ \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} H_a\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right) \\right]\n$$\n对于一个离散时间 LTI 系统，我们有 $Y_d(\\exp(j\\omega)) = H_d(\\exp(j\\omega)) X_d(\\exp(j\\omega))$。通过将其与推导出的表达式进行比較，我们确定离散时间系统的频率响应为：\n$$\nH_d(\\exp(j\\omega)) = \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} H_a\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right)\n$$\n为了从这个频率响应中求出冲激响应 $h_d[n]$，我们进行 DTFT 逆变换：\n$$\nh_d[n] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_d(\\exp(j\\omega)) \\exp(j\\omega n) \\, d\\omega\n$$\n代入 $H_d(\\exp(j\\omega))$ 的表达式：\n$$\nh_d[n] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\left[ \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} H_a\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right) \\right] \\exp(j\\omega n) \\, d\\omega\n$$\n交换积分和求和的顺序：\n$$\nh_d[n] = \\frac{1}{2\\pi T} \\sum_{k=-\\infty}^{\\infty} \\int_{-\\pi}^{\\pi} H_a\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right) \\exp(j\\omega n) \\, d\\omega\n$$\n对每个积分，我们进行变量代换。令 $\\Omega = \\frac{\\omega}{T} - \\frac{2\\pi k}{T}$。这意味着 $\\omega = T\\Omega + 2\\pi k$ 且 $d\\omega = T d\\Omega$。每一项的积分限会改变：对于 $\\omega \\in [-\\pi, \\pi]$，$\\Omega$ 的新积分限为 $[\\frac{-\\pi}{T} - \\frac{2\\pi k}{T}, \\frac{\\pi}{T} - \\frac{2\\pi k}{T}]$。给定 $k$ 的积分变为：\n$$\n\\int_{\\frac{-\\pi-2\\pi k}{T}}^{\\frac{\\pi-2\\pi k}{T}} H_a(j\\Omega) \\exp(j(T\\Omega + 2\\pi k) n) (T d\\Omega) = T \\int_{\\frac{-\\pi-2\\pi k}{T}}^{\\frac{\\pi-2\\pi k}{T}} H_a(j\\Omega) \\exp(j\\Omega nT) \\exp(j2\\pi kn) d\\Omega\n$$\n由于 $k$ 和 $n$ 都是整数，$\\exp(j2\\pi kn) = 1$。将此代回到 $h_d[n]$ 的求和式中：\n$$\nh_d[n] = \\frac{1}{2\\pi T} \\sum_{k=-\\infty}^{\\infty} T \\int_{\\frac{-\\pi-2\\pi k}{T}}^{\\frac{\\pi-2\\pi k}{T}} H_a(j\\Omega) \\exp(j\\Omega nT) d\\Omega\n$$\n因子 $T$ 被消掉。对这些相邻区间上的积分求和，其范围覆盖了整个实数轴：\n$$\nh_d[n] = \\frac{1}{2\\pi} \\sum_{k=-\\infty}^{\\infty} \\int_{\\frac{-\\pi-2\\pi k}{T}}^{\\frac{\\pi-2\\pi k}{T}} H_a(j\\Omega) \\exp(j\\Omega nT) d\\Omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H_a(j\\Omega) \\exp(j\\Omega nT) d\\Omega\n$$\n这个最后的积分是 $H_a(j\\Omega)$ 的 CTFT 逆变换的定义，在时间 $t=nT$ 处求值。与给定的正变换相对应的 CTFT 逆变换是 $h_a(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H_a(j\\Omega)\\, \\exp(j\\Omega t)\\, d\\Omega$。因此，我们得到：\n$$\nh_d[n] = h_a(nT)\n$$\n这个频域分析证实了从时域分析中得到的结果。再次与假设 $h_d[n]=\\gamma\\, h_a(nT)$ 进行比较，我们确认 $\\gamma = 1$。值得注意的是，这个结果是问题中定义的特定系统框图的直接推论。冲激不变法的其他定义可能会导致不同的比例因子。", "answer": "$$\n\\boxed{1}\n$$", "id": "2877401"}, {"introduction": "在滤波器设计中，应用一种变换只是第一步，理解其带来的影响对实际工程至关重要。本练习将探讨脉冲不变性变换的一个关键特性：它对系统直流增益的影响。通过解决这个问题，你将学习为何直流增益在变换后通常会发生改变，并掌握如何设计一个归一化因子 $\\gamma$，以精确匹配模拟和数字滤波器在零频率处的响应。[@problem_id:2877422]", "problem": "考虑一个严格真因果、连续时间线性时不变（LTI）系统，其传递函数为\n$$\nH_{c}(s)=\\sum_{k=1}^{M} \\frac{A_{k}}{s-p_{k}},\n$$\n其中极点 $\\{p_{k}\\}_{k=1}^{M}$ 是单极点且满足 $\\Re\\{p_{k}\\}0$，留数 $\\{A_{k}\\}_{k=1}^{M}$ 是有限的。令 $h_{c}(t)$ 表示相应的脉冲响应，因此对于 $t \\ge 0$，\n$$\nh_{c}(t)=\\sum_{k=1}^{M} A_{k}\\,\\exp(p_{k} t).\n$$\n设采样周期为 $T0$，并将通过脉冲不变转换（IIT）获得的离散时间系统定义为脉冲响应为\n$$\nh_{\\mathrm{ii}}[n]=T\\,h_{c}(nT), \\quad n \\in \\{0,1,2,\\dots\\}.\n$$\n将连续时间系统的直流（DC）增益定义为 $H_{c}(0)$，将离散时间系统的直流增益定义为 $H_{\\mathrm{ii}}(1)$，其中 $H_{\\mathrm{ii}}(z)$ 是 $h_{\\mathrm{ii}}[n]$ 的 $z$ 变换。\n\n你需要设计一种归一化方法，通过对离散时间系统进行后缩放，使得经过脉冲不变转换后的直流增益相等。也就是说，寻找一个标量因子 $\\gamma$（仅取决于 $T$、$\\{A_{k}\\}$ 和 $\\{p_{k}\\}$），使得具有传递函数的缩放后的离散时间系统\n$$\nH_{\\mathrm{norm}}(z)=\\gamma\\, H_{\\mathrm{ii}}(z)\n$$\n满足直流增益匹配条件 $H_{\\mathrm{norm}}(1)=H_{c}(0)$。换句话说，离散时间直流增益等于连续时间直流增益。\n\n仅从上述定义以及绝对可积脉冲响应的拉普拉斯变换和 $z$ 变换的第一性原理出发，推导 $\\gamma$ 关于 $T$、$\\{A_{k}\\}$ 和 $\\{p_{k}\\}$ 的闭式解析表达式。提供完整的推导过程和一个严格的证明，证明你的表达式确实对所有满足假设的 $\\{A_{k}\\}$ 和 $\\{p_{k}\\}$ 选择都强制实现 $H_{\\mathrm{norm}}(1)=H_{c}(0)$。你的最终答案必须是 $\\gamma$ 的单一闭式表达式。", "solution": "首先将对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知条件**\n- 连续时间LTI系统：严格真因果。\n- 传递函数：$H_{c}(s)=\\sum_{k=1}^{M} \\frac{A_{k}}{s-p_{k}}$。\n- 极点：$\\{p_{k}\\}_{k=1}^{M}$ 是单极点且满足 $\\Re\\{p_{k}\\}0$。\n- 留数：$\\{A_{k}\\}_{k=1}^{M}$ 是有限的。\n- 对于 $t \\ge 0$ 的连续时间脉冲响应：$h_{c}(t)=\\sum_{k=1}^{M} A_{k}\\,\\exp(p_{k} t)$。\n- 采样周期：$T0$。\n- 离散时间脉冲响应（脉冲不变转换）：对于 $n \\in \\{0,1,2,\\dots\\}$，$h_{\\mathrm{ii}}[n]=T\\,h_{c}(nT)$。\n- 连续时间直流增益：$H_{c}(0)$。\n- 离散时间直流增益：$H_{\\mathrm{ii}}(1)$，其中 $H_{\\mathrm{ii}}(z)$ 是 $h_{\\mathrm{ii}}[n]$ 的 $z$ 变换。\n- 归一化条件：找到一个标量 $\\gamma$，使得传递函数为 $H_{\\mathrm{norm}}(z)=\\gamma\\, H_{\\mathrm{ii}}(z)$ 的系统满足 $H_{\\mathrm{norm}}(1)=H_{c}(0)$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及数字信号处理中的标准概念，特别是脉冲不变转换和LTI系统的性质。传递函数、脉冲响应和直流增益的定义在该领域是正确和标准的。该问题是适定的；它要求基于一组给定的定义和约束推导出特定量（$\\gamma$）。语言客观、精确，没有歧义或主观性。所有必要的信息似乎都已提供。这些假设，例如极点位于左半平面（$\\Re\\{p_k\\}  0$），是确保连续时间系统稳定性的标准假设，并因此确保离散时间分析中涉及的级数收敛。该问题并非无足轻重，因为它需要使用变换理论进行形式推导，但它不是不适定的或矛盾的。\n\n**步骤3：结论和行动**\n问题被认为是有效的。将推导解决方案。\n\n目标是找到一个标量归一化因子 $\\gamma$，使得缩放后的离散时间系统的直流增益与其父连续时间系统的直流增益相匹配。$\\gamma$ 的定义方程是：\n$$\nH_{\\mathrm{norm}}(1)=H_{c}(0)\n$$\n已知 $H_{\\mathrm{norm}}(z) = \\gamma H_{\\mathrm{ii}}(z)$，该条件变为：\n$$\n\\gamma H_{\\mathrm{ii}}(1) = H_{c}(0)\n$$\n假设 $H_{\\mathrm{ii}}(1) \\neq 0$，我们可以将 $\\gamma$ 表示为：\n$$\n\\gamma = \\frac{H_{c}(0)}{H_{\\mathrm{ii}}(1)}\n$$\n我们现在必须从第一性原理推导 $H_{c}(0)$ 和 $H_{\\mathrm{ii}}(1)$ 的表达式。\n\n首先，我们计算连续时间系统的直流增益 $H_{c}(0)$。这通过在 $s=0$ 处计算传递函数 $H_c(s)$ 的值得到。\n$$\nH_{c}(0) = \\left. \\sum_{k=1}^{M} \\frac{A_{k}}{s-p_{k}} \\right|_{s=0} = \\sum_{k=1}^{M} \\frac{A_{k}}{0-p_{k}} = -\\sum_{k=1}^{M} \\frac{A_{k}}{p_{k}}\n$$\n\n接下来，我们计算未缩放的离散时间系统的直流增益 $H_{\\mathrm{ii}}(1)$。这通过在 $z=1$ 处计算 $h_{\\mathrm{ii}}[n]$ 的 $z$ 变换得到。$z$ 变换定义为：\n$$\nH_{\\mathrm{ii}}(z) = \\sum_{n=0}^{\\infty} h_{\\mathrm{ii}}[n] z^{-n}\n$$\n在 $z=1$ 处求值得到脉冲响应系数的和：\n$$\nH_{\\mathrm{ii}}(1) = \\sum_{n=0}^{\\infty} h_{\\mathrm{ii}}[n] (1)^{-n} = \\sum_{n=0}^{\\infty} h_{\\mathrm{ii}}[n]\n$$\n我们代入给定的定义 $h_{\\mathrm{ii}}[n] = T h_c(nT)$：\n$$\nH_{\\mathrm{ii}}(1) = \\sum_{n=0}^{\\infty} T h_{c}(nT) = T \\sum_{n=0}^{\\infty} h_{c}(nT)\n$$\n现在，代入 $h_c(t)$ 的表达式：\n$$\nH_{\\mathrm{ii}}(1) = T \\sum_{n=0}^{\\infty} \\left( \\sum_{k=1}^{M} A_{k}\\,\\exp(p_{k} nT) \\right)\n$$\n由于对 $k$ 的求和是有限的，且对 $n$ 的求和绝对收敛（如下所示），我们可以交换求和顺序：\n$$\nH_{\\mathrm{ii}}(1) = T \\sum_{k=1}^{M} A_{k} \\left( \\sum_{n=0}^{\\infty} \\exp(p_{k} nT) \\right)\n$$\n内部的和是一个形式为 $\\sum_{n=0}^{\\infty} r^n$ 的几何级数，其中 $r = \\exp(p_{k} T)$。为使该级数收敛，我们需要 $|r|1$。我们来验证这个条件。极点 $p_k$ 可以写成笛卡尔形式 $p_k = \\sigma_k + j\\omega_k$。条件 $\\Re\\{p_k\\}  0$ 意味着 $\\sigma_k  0$。比率 $r$ 的幅值为：\n$$\n|\\exp(p_{k} T)| = |\\exp((\\sigma_k + j\\omega_k)T)| = |\\exp(\\sigma_k T)\\exp(j\\omega_k T)| = |\\exp(\\sigma_k T)| \\cdot |\\exp(j\\omega_k T)|\n$$\n由于 $\\sigma_k  0$ 且 $T  0$，$\\sigma_k T$ 是一个负实数，所以 $|\\exp(\\sigma_k T)| = \\exp(\\sigma_k T)  1$。另外， $|\\exp(j\\omega_k T)| = 1$。因此， $|r| = \\exp(\\sigma_k T)  1$，几何级数收敛。\n几何级数的和为 $\\frac{1}{1-r}$。将此应用于我们的表达式：\n$$\n\\sum_{n=0}^{\\infty} \\exp(p_k nT) = \\sum_{n=0}^{\\infty} (\\exp(p_k T))^n = \\frac{1}{1 - \\exp(p_k T)}\n$$\n将此结果代回 $H_{\\mathrm{ii}}(1)$ 的表达式中：\n$$\nH_{\\mathrm{ii}}(1) = T \\sum_{k=1}^{M} \\frac{A_{k}}{1 - \\exp(p_{k} T)}\n$$\n我们现在有了 $H_{c}(0)$ 和 $H_{\\mathrm{ii}}(1)$ 的必要表达式。我们可以将它们代入 $\\gamma$ 的公式中：\n$$\n\\gamma = \\frac{H_{c}(0)}{H_{\\mathrm{ii}}(1)} = \\frac{-\\sum_{k=1}^{M} \\frac{A_{k}}{p_{k}}}{T \\sum_{k=1}^{M} \\frac{A_{k}}{1 - \\exp(p_{k} T)}}\n$$\n这就是归一化因子 $\\gamma$ 的闭式解析表达式。\n\n最后，我们提供证明，表明这个 $\\gamma$ 的表达式强制实现了所需的直流增益匹配条件。根据构造，我们定义归一化系统为 $H_{\\mathrm{norm}}(z) = \\gamma H_{\\mathrm{ii}}(z)$。这个归一化系统的直流增益是：\n$$\nH_{\\mathrm{norm}}(1) = \\gamma H_{\\mathrm{ii}}(1)\n$$\n代入我们推导出的 $\\gamma$ 表达式：\n$$\nH_{\\mathrm{norm}}(1) = \\left( \\frac{-\\sum_{k=1}^{M} \\frac{A_{k}}{p_{k}}}{T \\sum_{k=1}^{M} \\frac{A_{k}}{1 - \\exp(p_{k} T)}} \\right) \\left( T \\sum_{k=1}^{M} \\frac{A_{k}}{1 - \\exp(p_{k} T)} \\right)\n$$\n假设分母非零，它将与 $H_{\\mathrm{ii}}(1)$ 的项相消，得到：\n$$\nH_{\\mathrm{norm}}(1) = -\\sum_{k=1}^{M} \\frac{A_{k}}{p_{k}}\n$$\n这正是我们为 $H_c(0)$ 推导出的表达式。因此，我们证明了对于所有满足初始假设且 $H_{\\mathrm{ii}}(1) \\neq 0$ 的 $\\{A_k\\}$ 和 $\\{p_k\\}$ 选择，$H_{\\mathrm{norm}}(1) = H_c(0)$。", "answer": "$$\n\\boxed{\\frac{-\\sum_{k=1}^{M} \\frac{A_{k}}{p_{k}}}{T \\sum_{k=1}^{M} \\frac{A_{k}}{1 - \\exp(p_{k} T)}}}\n$$", "id": "2877422"}, {"introduction": "现在，让我们从理论分析转向综合应用，挑战一个更高级的“逆问题”——系统辨识。给定一组测量的离散时间脉冲响应数据，你的任务是通过计算来重构原始连续时间系统的极点。这个练习不仅会巩固你对 $s$ 平面和 $z$ 平面之间极点映射关系的理论理解，还将为你提供处理数值估计技术和解决复对数函数分支选择等关键问题的实践经验。[@problem_id:2877423]", "problem": "给定一个用于连续时间、线性时不变 (LTI) 有理系统的脉冲响应不变法设置，其传递函数为 $H_a(s)$，脉冲响应为 $h_a(t)$。在周期为 $T$ 的均匀采样下，对于整数 $n \\ge 0$，离散时间脉冲响应为 $h_d[n] = h_a(nT)$。假设连续时间传递函数 $H_a(s)$ 是严格真分式，具有简单极点 $\\{p_k\\}_{k=1}^K$（其中 $\\Re\\{p_k\\}  0$）和留数 $\\{R_k\\}_{k=1}^K$，因此脉冲响应是指数的有限和 $h_a(t) = \\sum_{k=1}^K R_k e^{p_k t}$。那么 $h_d[n] = \\sum_{k=1}^K R_k \\left(e^{p_k T}\\right)^n$。令 $z_k = e^{p_k T}$ 表示离散时间模式。\n\n根据上述定义和指数的性质，序列 $h_d[n]$ 是 $K$ 个复指数的有限和，这意味着它满足一个阶数为 $K$ 的常系数齐次线性递推关系，其特征根为 $\\{z_k\\}_{k=1}^K$。可以利用这一点，通过一致的数据驱动方法（如线性预测或 Prony's method）从有限个样本 $\\{h_d[n]\\}_{n=0}^{N-1}$ 中估计离散时间模式 $\\{z_k\\}$。一旦估计出 $\\{z_k\\}$，恢复连续时间极点就需要选择一个对数分支，因为复对数是多值的。一个物理上有意义且广泛使用的选择是，选择与脉冲响应不变法一致的分支，使得虚部 $\\Im\\{p_k\\}$ 位于开放的奈奎斯特频带 $(-\\pi/T,\\pi/T]$ 内，并且稳定性约束 $\\Re\\{p_k\\}  0$ 成立。然后，可以通过求解由 $h_d[n]$ 的指数模型定义的线性系统来获得留数 $\\{R_k\\}$。\n\n任务：开发一个完整的程序，在给定测量的离散时间脉冲响应 $\\{h_d[n]\\}$、采样周期 $T$（秒）和模型阶数 $K$ 的情况下，估计连续时间极点 $\\{p_k\\}$，并使用定量标准与真实值进行验证。您的程序必须：\n\n- 实现一个稳健的程序，仅使用上述性质（指数和意味着存在一个线性零化滤波器）从 $\\{h_d[n]\\}$ 中估计 $K$ 个离散时间模式 $\\{z_k\\}$。\n- 使用分支选择将 $\\{z_k\\}$ 映射到连续时间极点 $\\{p_k\\}$，该选择强制虚部在 $(-\\pi/T,\\pi/T]$（角度以弧度为单位）内，并在数据支持时产生 $\\Re\\{p_k\\}  0$。\n- 根据估计的 $\\{z_k\\}$ 所隐含的指数模型，通过最小二乘法估计留数 $\\{R_k\\}$。\n- 为了进行评估，在估计的极点和真实极点之间执行最优匹配，以最小化 $\\mathbb{C}$ 中的总绝对误差，并且如果匹配集中最大的绝对极点误差小于或等于指定的容差 $\\varepsilon_p$（单位：弧度/秒），则声明成功。\n\n使用以下测试套件。对于每种情况，通过 $h_d[n] = \\sum_{k=1}^K R_k e^{p_k n T}$（其中 $n \\in \\{0,1,\\dots,N-1\\}$）从给定的真实极点和留数合成 $h_d[n]$，然后应用您的估计算法。所有角频率必须以弧度/秒为单位处理，时间以秒为单位。极点估计的容差必须为 $\\varepsilon_p = 1.0 \\times 10^{-1}$（弧度/秒）。\n\n- 情况 A（两个实极点，无噪声）：\n  - $K = 2$， $T = 0.1$（秒），$N = 50$（样本）。\n  - 极点：$p = \\{-3.0,\\,-7.0\\}$。\n  - 留数：$R = \\{2.0,\\,-1.0\\}$。\n  - 附加噪声标准差：$\\sigma = 0.0$。\n\n- 情况 B（一对复共轭极点，无噪声）：\n  - $K = 2$， $T = 0.05$（秒），$N = 120$（样本）。\n  - 极点：$p = \\{-1.0 + 5.0\\,\\mathrm{j},\\,-1.0 - 5.0\\,\\mathrm{j}\\}$。\n  - 留数：$R = \\{1.0 - 0.5\\,\\mathrm{j},\\,1.0 + 0.5\\,\\mathrm{j}\\}$。\n  - 附加噪声标准差：$\\sigma = 0.0$。\n\n- 情况 C（靠近奈奎斯特边界的复共轭对，无噪声）：\n  - $K = 2$， $T = 0.05$（秒），$N = 200$（样本）。注意 $\\pi/T \\approx 62.831853\\ldots$（弧度/秒）。\n  - 极点：$p = \\{-0.5 + 60.0\\,\\mathrm{j},\\,-0.5 - 60.0\\,\\mathrm{j}\\}$。\n  - 留数：$R = \\{0.3 + 0.2\\,\\mathrm{j},\\,0.3 - 0.2\\,\\mathrm{j}\\}$。\n  - 附加噪声标准差：$\\sigma = 0.0$。\n\n- 情况 D（三个极点，有少量噪声）：\n  - $K = 3$， $T = 0.02$（秒），$N = 200$（样本）。\n  - 极点：$p = \\{-2.0,\\,-0.5 + 20.0\\,\\mathrm{j},\\,-0.5 - 20.0\\,\\mathrm{j}\\}$。\n  - 留数：$R = \\{1.0,\\,0.6 - 0.2\\,\\mathrm{j},\\,0.6 + 0.2\\,\\mathrm{j}\\}$。\n  - 附加噪声标准差：$\\sigma = 1.0 \\times 10^{-6}$。\n\n评估和输出规范：\n\n- 对于每个案例，计算估计的连续时间极点 $\\{\\hat{p}_k\\}$，并通过最小化总绝对误差 $\\sum_k |\\hat{p}_{\\pi(k)} - p_k|$（其中 $\\pi$ 是所有排列）将它们与真实极点 $\\{p_k\\}$ 进行匹配。令最大匹配极点误差为 $e_{\\max} = \\max_k |\\hat{p}_{\\pi(k)} - p_k|$。如果 $e_{\\max} \\le \\varepsilon_p$，则声明该案例成功。\n- 您的程序应生成一行输出，其中包含四个案例的成功值，格式为逗号分隔的列表，并用方括号括起来，例如 $[\\text{true},\\text{false},\\text{true},\\text{true}]$，但使用小写的 Python 布尔字面量。\n\n内部计算中的所有数值输出必须与角数量的弧度单位和时间量的秒单位保持一致。最终打印的输出必须是指定列表格式的、带布尔值的单行文本。", "solution": "我们从连续时间、线性时不变 (LTI) 有理系统的基本模型开始，该系统具有严格真分式传递函数 $H_a(s)$。如果 $H_a(s)$ 具有简单极点 $\\{p_k\\}_{k=1}^K$（其中 $\\Re\\{p_k\\}  0$）和留数 $\\{R_k\\}_{k=1}^K$，则其脉冲响应为\n$$\nh_a(t) \\;=\\; \\sum_{k=1}^K R_k e^{p_k t},\n$$\n这是有理函数的部分分式展开以及系统线性和时不变性的直接结果。在采样周期为 $T$（秒）的脉冲响应不变法采样下，离散时间脉冲响应为\n$$\nh_d[n] \\;=\\; h_a(nT) \\;=\\; \\sum_{k=1}^K R_k \\left(e^{p_k T}\\right)^n \\;=\\; \\sum_{k=1}^K R_k z_k^n,\n$$\n其中 $z_k = e^{p_k T}$ 是离散时间模式。这将 $h_d[n]$ 表示为 $K$ 个复指数的有限和。一个经过充分验证的事实是，任何这样的序列都遵循一个阶数为 $K$ 的常系数齐次线性递推关系：存在系数 $\\{a_\\ell\\}_{\\ell=1}^K$，使得对于有效范围内的所有 $n$，\n$$\nh_d[n + K] + \\sum_{\\ell=1}^K a_\\ell\\, h_d[n + K - \\ell] = 0.\n$$\n此递推关系的特征多项式\n$$\nA(z) = z^K + a_1 z^{K-1} + \\cdots + a_K,\n$$\n其根为离散时间模式 $\\{z_k\\}_{k=1}^K$。这是通过代入试验解 $h_d[n] = c z^n$ 并得到 $A(z) = 0$ 来得出的。\n\n基于原理的 $\\{z_k\\}$ 估计：给定有限个测量样本 $\\{h_d[n]\\}_{n=0}^{N-1}$，并假设 $N$ 远大于 $K$，我们可以构建一个包含 $M = N - K$ 个递推关系的线性方程组。记 $y[n] = -h_d[n + K]$ 和 $X[n, \\ell] = h_d[n + K - (\\ell+1)]$，其中 $\\ell \\in \\{0,1,\\dots,K-1\\}$，$n \\in \\{0,1,\\dots,M-1\\}$。线性系统 $X a \\approx y$（其中 $a = [a_1,\\dots,a_K]^\\top$）可以在最小二乘意义下求解。一旦估计出 $a$，计算 $A(z)$ 的根即可得到 $\\{\\hat{z}_k\\}$。\n\n分支一致的 $\\{p_k\\}$ 恢复：从 $z_k$ 到 $p_k$ 的映射是多值的，因为复对数是多值的：对于任何整数 $m$，$\\log(z_k) = \\ln|z_k| + \\mathrm{j}(\\arg(z_k) + 2\\pi m)$ 都是一个有效的分支。在脉冲响应不变法下，物理上有意义的分支假设模拟频率在奈奎斯特频带内，因此选择其虚部位于 $(-\\pi/T,\\pi/T]$ 内的分支。实现此目标的一致方法是：\n- 计算模 $|z_k|$ 和主辐角 $\\arg(z_k) \\in (-\\pi,\\pi]$。\n- 构建 $\\hat{p}_k = \\dfrac{\\ln|z_k| + \\mathrm{j}\\,\\arg(z_k)}{T}$，由于辐角的主值，这将 $\\Im\\{\\hat{p}_k\\}$ 置于 $(-\\pi/T,\\pi/T]$ 内。这提供了与奈奎斯特频带对齐的分支选择。因为 $|z_k| = e^{\\Re\\{p_k\\} T}$，稳定的连续时间极点会产生 $|z_k|  1$，因此在没有噪声的情况下，$\\Re\\{\\hat{p}_k\\}  0$。\n\n留数估计：有了 $\\{\\hat{z}_k\\}$，通过求解一个线性最小二乘问题，将留数 $\\{\\hat{R}_k\\}$ 拟合到模型 $h_d[n] \\approx \\sum_{k=1}^K \\hat{R}_k \\hat{z}_k^n$。使用范德蒙德型矩阵 $V \\in \\mathbb{C}^{N \\times K}$，其元素为 $V[n,k] = \\hat{z}_k^n$（其中 $n \\in \\{0,\\dots,N-1\\}$，$k \\in \\{1,\\dots,K\\}$），在最小二乘意义下求解 $V \\hat{R} \\approx h_d$。\n\n匹配与验证：为了比较估计的极点 $\\{\\hat{p}_k\\}$ 与真实极点 $\\{p_k\\}$，需要进行排列不变的比较。构建成本矩阵 $C \\in \\mathbb{R}^{K \\times K}$，其中 $C_{ij} = |\\hat{p}_j - p_i|$，然后求解线性总和分配（匈牙利）问题，以找到最小化总绝对误差的排列。设 $e_{\\max}$ 为此最优配对下的最大绝对误差。如果 $e_{\\max} \\le \\varepsilon_p$，则测试案例被声明为成功。此处的容差设置为 $\\varepsilon_p = 1.0 \\times 10^{-1}$（弧度/秒），以平衡数值灵敏度和模型可辨识性。\n\n算法和数值考量：\n- 数据长度 $N$ 必须满足 $N \\ge 2K$，以确保一个 $K$ 参数递推关系至少有 $K$ 个方程，并且在实践中，为了稳健性，通常使用 $N \\gg K$。\n- 零化滤波器系数和留数的最小二乘解应使用标准线性代数例程提供的数值稳定方法（例如，奇异值分解）来计算。\n- 主辐角函数 $\\arg(\\cdot)$ 返回 $(-\\pi,\\pi]$ 内的值，确保 $\\hat{p}_k$ 的虚部位于 $(-\\pi/T,\\pi/T]$ 内，这与脉冲响应不变法的奈奎斯特频带假设一致。如果噪声导致对稳定性的微小违反（例如，$\\Re\\{\\hat{p}_k\\}  0$ 略微），失配通常很小，并且可以在容差范围内被容忍。\n- 具有共轭留数的复共轭极点对会生成实的 $h_d[n]$。估计器不需要显式强制共轭性；由于数据的结构，它通常会恢复近似的共轭对。\n\n测试套件构建：\n- 情况 A 使用两个实极点，参数为 $K = 2$, $T = 0.1$（秒）, $N = 50$, 零噪声, 极点 $\\{-3.0,\\,-7.0\\}$, 留数 $\\{2.0,\\,-1.0\\}$。这验证了对实指数的基本恢复能力。\n- 情况 B 使用一对复共轭极点，参数为 $K = 2$, $T = 0.05$（秒）, $N = 120$, 零噪声, 极点 $\\{-1.0 \\pm 5.0\\,\\mathrm{j}\\}$, 留数 $\\{1.0 \\mp 0.5\\,\\mathrm{j}\\}$。这验证了分支处理和复数模式。\n- 情况 C 使用一对靠近奈奎斯特边界的极点，参数为 $K = 2$, $T = 0.05$（秒）, $N = 200$, 零噪声, 极点 $\\{-0.5 \\pm 60.0\\,\\mathrm{j}\\}$, 留数 $\\{0.3 \\pm 0.2\\,\\mathrm{j}\\}$。由于 $\\pi/T \\approx 62.831853\\ldots$（弧度/秒），虚部位于频带内，测试了对近边界角度的灵敏度。\n- 情况 D 使用三个带少量附加噪声的极点，参数为 $K = 3$, $T = 0.02$（秒）, $N = 200$, $\\sigma = 1.0 \\times 10^{-6}$, 极点 $\\{-2.0,\\,-0.5 \\pm 20.0\\,\\mathrm{j}\\}$, 以及留数 $\\{1.0,\\,0.6 \\mp 0.2\\,\\mathrm{j}\\}$。这测试了在轻微扰动下的多模式恢复能力。\n\n最终程序行为：对于每个案例，合成 $h_d[n]$，估计 $\\{\\hat{z}_k\\}$，使用奈奎斯特频带内的分支选择映射到 $\\{\\hat{p}_k\\}$，估计留数 $\\{\\hat{R}_k\\}$，与真实值进行最优极点匹配，并输出一个布尔值，指示是否 $e_{\\max} \\le \\varepsilon_p$。程序打印一行包含四个案例的布尔值的 Python 列表，例如 $[\\text{true},\\text{true},\\text{true},\\text{true}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linear_sum_assignment\n\ndef generate_hd(poles, residues, T, N, noise_sigma=0.0, rng=None):\n    \"\"\"\n    Generate discrete-time impulse response h_d[n] = sum R_k * exp(p_k * T * n)\n    \"\"\"\n    n = np.arange(N, dtype=float)\n    h = np.zeros(N, dtype=complex)\n    for p, R in zip(poles, residues):\n        h += R * np.exp(p * T * n)\n    if noise_sigma  0.0:\n        if rng is None:\n            rng = np.random.default_rng(0)\n        # Add real-valued Gaussian noise to keep output real if underlying signal is real\n        noise = noise_sigma * rng.standard_normal(N)\n        h = h + noise\n    return h\n\ndef prony_estimate_z(h, K):\n    \"\"\"\n    Estimate discrete-time modes z_k from sequence h using linear prediction (Prony).\n    h: 1-D numpy array (complex or real)\n    K: model order\n    Returns: array of K roots (z_k)\n    \"\"\"\n    h = np.asarray(h, dtype=complex).ravel()\n    N = h.shape[0]\n    M = N - K\n    if M  K:\n        raise ValueError(\"Insufficient data length N relative to model order K.\")\n    # Build least-squares system X a = y, where\n    # y[n] = -h[n+K], X[n, i] = h[n+K-(i+1)] for i=0..K-1\n    X = np.zeros((M, K), dtype=complex)\n    y = -h[K:K+M]\n    for n in range(M):\n        for i in range(K):\n            X[n, i] = h[n + K - (i + 1)]\n    # Solve for a (prediction coefficients)\n    a, *_ = np.linalg.lstsq(X, y, rcond=None)\n    # Characteristic polynomial A(z) = z^K + a1 z^{K-1} + ... + aK\n    poly_coeffs = np.concatenate(([1.0], a))\n    # Roots\n    z_roots = np.roots(poly_coeffs)\n    return z_roots\n\ndef estimate_residues(h, z):\n    \"\"\"\n    Given sequence h[n] and modes z_k, estimate residues R_k in h[n] ~ sum R_k z_k^n\n    via least squares.\n    \"\"\"\n    h = np.asarray(h, dtype=complex).ravel()\n    N = h.shape[0]\n    K = len(z)\n    n = np.arange(N, dtype=float)[:, None]  # shape (N,1)\n    V = (z[None, :] ** n)  # Vandermonde-like matrix\n    R, *_ = np.linalg.lstsq(V, h, rcond=None)\n    return R\n\ndef map_z_to_p(z, T):\n    \"\"\"\n    Map discrete-time modes z to continuous-time poles p using branch selection\n    in the Nyquist band: p = (ln|z| + j*angle(z)) / T, where angle in (-pi, pi].\n    \"\"\"\n    z = np.asarray(z, dtype=complex)\n    mags = np.abs(z)\n    angs = np.angle(z)  # principal value (-pi, pi]\n    p = (np.log(mags) + 1j * angs) / T\n    return p\n\ndef match_poles(p_true, p_est):\n    \"\"\"\n    Match estimated poles to true poles by minimizing total absolute difference.\n    Returns the permutation indices for p_est to match p_true, and the errors.\n    \"\"\"\n    p_true = np.asarray(p_true, dtype=complex)\n    p_est = np.asarray(p_est, dtype=complex)\n    K = len(p_true)\n    cost = np.abs(p_true[:, None] - p_est[None, :])\n    row_ind, col_ind = linear_sum_assignment(cost)\n    errs = np.abs(p_true[row_ind] - p_est[col_ind])\n    return col_ind, errs\n\ndef run_case(poles, residues, T, N, K, noise_sigma=0.0, eps_p=1e-1, rng=None):\n    h = generate_hd(poles, residues, T, N, noise_sigma=noise_sigma, rng=rng)\n    # Estimate z modes\n    z_est = prony_estimate_z(h, K)\n    # Map to continuous-time poles with branch selection in Nyquist band\n    p_est = map_z_to_p(z_est, T)\n    # Estimate residues (not used for validation here, but computed as part of the requested procedure)\n    _ = estimate_residues(h, z_est)\n    # Match estimated poles to true poles\n    _, errs = match_poles(np.array(poles, dtype=complex), p_est)\n    emax = float(np.max(errs)) if errs.size  0 else float('inf')\n    return emax = eps_p\n\ndef solve():\n    # Fixed RNG for reproducibility of noise in Case D\n    rng = np.random.default_rng(12345)\n    eps_p = 1.0e-1  # radians per second\n\n    # Define the test cases\n    test_cases = [\n        # Case A\n        {\n            \"poles\": np.array([-3.0 + 0.0j, -7.0 + 0.0j], dtype=complex),\n            \"residues\": np.array([2.0 + 0.0j, -1.0 + 0.0j], dtype=complex),\n            \"T\": 0.1,\n            \"N\": 50,\n            \"K\": 2,\n            \"noise_sigma\": 0.0\n        },\n        # Case B\n        {\n            \"poles\": np.array([-1.0 + 5.0j, -1.0 - 5.0j], dtype=complex),\n            \"residues\": np.array([1.0 - 0.5j, 1.0 + 0.5j], dtype=complex),\n            \"T\": 0.05,\n            \"N\": 120,\n            \"K\": 2,\n            \"noise_sigma\": 0.0\n        },\n        # Case C\n        {\n            \"poles\": np.array([-0.5 + 60.0j, -0.5 - 60.0j], dtype=complex),\n            \"residues\": np.array([0.3 + 0.2j, 0.3 - 0.2j], dtype=complex),\n            \"T\": 0.05,\n            \"N\": 200,\n            \"K\": 2,\n            \"noise_sigma\": 0.0\n        },\n        # Case D\n        {\n            \"poles\": np.array([-2.0 + 0.0j, -0.5 + 20.0j, -0.5 - 20.0j], dtype=complex),\n            \"residues\": np.array([1.0 + 0.0j, 0.6 - 0.2j, 0.6 + 0.2j], dtype=complex),\n            \"T\": 0.02,\n            \"N\": 200,\n            \"K\": 3,\n            \"noise_sigma\": 1.0e-6\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        ok = run_case(\n            poles=case[\"poles\"],\n            residues=case[\"residues\"],\n            T=case[\"T\"],\n            N=case[\"N\"],\n            K=case[\"K\"],\n            noise_sigma=case[\"noise_sigma\"],\n            eps_p=eps_p,\n            rng=rng\n        )\n        results.append(ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```", "id": "2877423"}]}