{"hands_on_practices": [{"introduction": "在开始设计任何滤波器之前，关键的第一步是选择正确的结构。线性相位FIR滤波器有四种不同的类型，每种类型都具有固有的频谱特性。本练习将指导您分析这些结构对称性如何对频率响应施加特定约束，使您能够为需要（例如）在直流（DC）处有零点的应用选择合适的滤波器类型。[@problem_id:2888730]", "problem": "您正在设计一个最优等波纹有限脉冲响应（FIR）线性相位滤波器，用于多频带系统模型。对于一个长度为 $M$ 的滤波器，其脉冲响应 $h[n]$ 的离散时间傅里叶变换（DTFT）为 $H(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}\\omega n}$。在线性相位类别中，脉冲响应满足对称性约束 $h[n] = s\\,h[M-1-n]$（对于所有 $n$），其中 $s \\in \\{+1,-1\\}$ 表示偶对称（$s=+1$）或奇对称（$s=-1$），且 $M$ 可以是偶数或奇数。\n\n您收到的设计约束是，离散时间频率响应必须满足 $H(\\mathrm{e}^{\\mathrm{j}0})=0$ 和 $H(\\mathrm{e}^{\\mathrm{j}\\pi})\\neq 0$。为了与等波纹算法一同使用，您必须选择一种线性相位类型，其结构对称性能保证 $H(\\mathrm{e}^{\\mathrm{j}0})=0$，同时又不会在结构上强制 $H(\\mathrm{e}^{\\mathrm{j}\\pi})=0$。也就是说，可行性要求是：在 $\\omega=0$ 处的约束必须是对称性的内在结果，而在 $\\omega=\\pi$ 处的非零要求必须与该对称性兼容，而非被其所否定。\n\n仅从 DTFT 定义和线性相位对称性 $h[n] = s\\,h[M-1-n]$ 出发，确定在这种结构要求下可行的线性相位类型，并构建 $h[n]$ 上相应的对称性约束。用数对 $(s,r)$ 表示所选类型，其中 $s \\in \\{+1,-1\\}$ 是对称性符号，$r \\in \\{0,1\\}$ 是奇偶性指示符 $r \\equiv M \\pmod 2$（$M$ 为偶数时 $r=0$，$M$ 为奇数时 $r=1$）。作为最终答案，返回一个包含两个条目的行向量 $[s\\;\\; r]$，写成单行矩阵的形式。如果多于一种类型满足结构可行性要求，则选择其中 $H(\\mathrm{e}^{\\mathrm{j}\\pi})$ 通常为非零（即，对于所有遵循对称性的脉冲响应，它不恒为零）的那一种。无需四舍五入。不要包含单位。角度以弧度为单位。", "solution": "所述问题具有科学依据、提法明确、客观且完整。它构成了数字滤波器设计理论中的一个标准分析问题。因此，该问题是有效的，并将提供解答。\n\n目标是确定四种线性相位有限脉冲响应（FIR）滤波器中的哪一种满足其频率响应 $H(\\mathrm{e}^{\\mathrm{j}\\omega})$ 在频率 $\\omega=0$ 和 $\\omega=\\pi$ 处的两个特定结构要求。频率响应由长度为 $M$ 的滤波器脉冲响应 $h[n]$ 的离散时间傅里叶变换（DTFT）定义：\n$$H(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}\\omega n}$$\n线性相位特性通过对脉冲响应系数的对称性约束来强制实现：\n$$h[n] = s\\,h[M-1-n], \\quad \\text{for } n=0, 1, \\dots, M-1$$\n其中 $s \\in \\{+1, -1\\}$ 决定了对称类型（偶对称或奇对称）。滤波器长度 $M$ 可以是奇数或偶数。这两个参数定义了四种不同的线性相位FIR滤波器类型。该类型用数对 $(s, r)$ 表示，其中 $r = M \\pmod 2$。\n\n结构要求如下：\n1.  条件 $H(\\mathrm{e}^{\\mathrm{j}0}) = 0$ 必须由所选的对称类型对任何有效的脉冲响应 $h[n]$ 内在地保证。\n2.  条件 $H(\\mathrm{e}^{\\mathrm{j}\\pi}) \\neq 0$ 必须是可能的，这意味着该对称类型不能在结构上强制使每个有效的 $h[n]$ 的 $H(\\mathrm{e}^{\\mathrm{j}\\pi})$ 都为零。\n\n我们计算在 $\\omega=0$ 和 $\\omega=\\pi$ 处的频率响应：\n在 $\\omega=0$ 处，响应是脉冲响应系数的总和：\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}0 \\cdot n} = \\sum_{n=0}^{M-1} h[n]$$\n在 $\\omega=\\pi$ 处，响应是脉冲响应系数的交替和：\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}\\pi n} = \\sum_{n=0}^{M-1} h[n](-1)^n$$\n\n我们现在分析四种滤波器类型中的每一种。\n\n**类型 I：偶对称（$s=+1$），奇数长度（$M$ 为奇数）**\n设 $M=2L+1$，其中 $L \\ge 0$ 为某个整数。对称性为 $h[n]=h[M-1-n]$。在 $n=L=(M-1)/2$ 处有一个中心系数。\n系数之和为：\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n] = \\sum_{n=0}^{2L} h[n] = h[L] + \\sum_{n=0}^{L-1}(h[n] + h[2L-n])$$\n使用对称性 $h[2L-n] = h[n]$，上式变为：\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = h[L] + 2\\sum_{n=0}^{L-1}h[n]$$\n此表达式在结构上不为零。因此，类型 I 滤波器违反了第一个要求。\n\n**类型 II：偶对称（$s=+1$），偶数长度（$M$ 为偶数）**\n设 $M=2L$，其中 $L \\ge 1$ 为某个整数。对称性为 $h[n]=h[M-1-n]$。没有中心系数。\n在 $\\omega=\\pi$ 处的求值结果为：\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n](-1)^n = \\sum_{n=0}^{2L-1} h[n](-1)^n = \\sum_{n=0}^{L-1} \\left( h[n](-1)^n + h[2L-1-n](-1)^{2L-1-n} \\right)$$\n使用对称性 $h[2L-1-n] = h[n]$ 和性质 $(-1)^{2L-1-n} = -(-1)^{-n} = -(-1)^n$，和中的每一项变为：\n$$h[n](-1)^n + h[n](-(-1)^n) = 0$$\n因此，对于任何遵循类型 II 对称性的系数集，$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 0$。这违反了第二个要求，即 $H(\\mathrm{e}^{\\mathrm{j}\\pi})$ 在结构上不为零。\n\n**类型 III：奇对称（$s=-1$），奇数长度（$M$ 为奇数）**\n设 $M=2L+1$。对称性为 $h[n]=-h[M-1-n]$。对于中心系数 $n=L$，我们有 $h[L]=-h[M-1-L] = -h[L]$，这意味着 $2h[L]=0$，因此 $h[L]=0$。\n系数之和为：\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n] = h[L] + \\sum_{n=0}^{L-1}(h[n] + h[2L-n])$$\n由于 $h[L]=0$ 且 $h[2L-n]=-h[n]$，上式变为：\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = 0 + \\sum_{n=0}^{L-1}(h[n] - h[n]) = 0$$\n这在结构上为零，满足第一个要求。\n现在，我们计算在 $\\omega=\\pi$ 处的响应：\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n](-1)^n = h[L](-1)^L + \\sum_{n=0}^{L-1} \\left( h[n](-1)^n + h[2L-n](-1)^{2L-n} \\right)$$\n使用 $h[L]=0$、$h[2L-n]=-h[n]$ 和 $(-1)^{2L-n} = (-1)^{-n} = (-1)^n$，求和中的每一项是：\n$$h[n](-1)^n + (-h[n])(-1)^n = 0$$\n因此，$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 0$。这在结构上为零，违反了第二个要求。\n\n**类型 IV：奇对称（$s=-1$），偶数长度（$M$ 为偶数）**\n设 $M=2L$。对称性为 $h[n]=-h[M-1-n]$。\n系数之和为：\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n] = \\sum_{n=0}^{2L-1} h[n] = \\sum_{n=0}^{L-1}(h[n] + h[2L-1-n])$$\n使用对称性 $h[2L-1-n]=-h[n]$，上式变为：\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{L-1}(h[n] - h[n]) = 0$$\n这在结构上为零，满足第一个要求。\n现在，我们计算在 $\\omega=\\pi$ 处的响应：\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n](-1)^n = \\sum_{n=0}^{2L-1} h[n](-1)^n = \\sum_{n=0}^{L-1} \\left( h[n](-1)^n + h[2L-1-n](-1)^{2L-1-n} \\right)$$\n使用 $h[2L-1-n]=-h[n]$ 和 $(-1)^{2L-1-n}=-(-1)^n$，每一项变为：\n$$h[n](-1)^n + (-h[n])(-(-1)^n) = h[n](-1)^n + h[n](-1)^n = 2h[n](-1)^n$$\n因此，和为：\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 2\\sum_{n=0}^{L-1} h[n](-1)^n$$\n这个和在结构上不为零。例如，如果我们选择 $h[0]=1$ 且所有其他独立系数为零，则 $H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 2$。因此，$H(\\mathrm{e}^{\\mathrm{j}\\pi})$ 可能为非零。这满足了第二个要求。\n\n只有类型 IV 滤波器同时满足两个结构要求。此类型的对称性约束为 $h[n] = -h[M-1-n]$，滤波器长度 $M$ 为偶数。这对应于：\n-   对称性符号 $s = -1$。\n-   长度奇偶性 $r = M \\pmod 2 = 0$，因为 $M$ 是偶数。\n\n所要求的数对 $(s,r)$ 是 $(-1, 0)$。最终答案将以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  0\n\\end{pmatrix}\n}\n$$", "id": "2888730"}, {"introduction": "滤波器的性能指标通常以分贝（dB）为单位，这是一种符合人类对幅度感知的直观对数尺度。然而，雷米兹（Remez）算法是基于线性的波纹值和权重进行运算的。本练习提供了必要的训练，帮助您将通带波纹和阻带衰减的标准dB指标转换（dB）为优化算法所需的线性$\\delta$值和权重比。[@problem_id:2888701]", "problem": "一个线性相位最优等波纹有限冲激响应（FIR）低通滤波器将通过对期望幅度响应进行加权极小化极大（切比雪夫）逼近来设计，该期望幅度响应在通带中为1，在阻带中为0。设计指标以分贝给出：通带波纹至多为 $A_{p} = 0.25$ dB，最小阻带衰减为 $A_{s} = 60$ dB。\n\n从基本定义出发，按以下步骤进行：\n- 使用幅度比的分贝定义，即对于幅度比 $r$，其分贝值为 $20 \\log_{10}(r)$，通过将通带偏差建模为位于 $1 - \\delta_{p}$ 和 $1 + \\delta_{p}$ 之间，来推导由 $A_{p}$ 所隐含的线性通带波纹 $\\delta_{p}$。\n- 使用相同的分贝定义，通过将最大阻带幅度建模为相对于1的 $\\delta_{s}$，来推导由 $A_{s}$ 所隐含的线性阻带波纹 $\\delta_{s}$。\n- 使用针对具有恒定频带权重的两个不相交频带的加权极小化极大准则的定义，推导出使通带和阻带中的最大加权误差相等的所需权重比 $w_{s}/w_{p}$。\n\n计算给定 $A_{p}$ 和 $A_{s}$ 下 $w_{s}/w_{p}$ 的数值，并将您的答案四舍五入到四位有效数字。将最终答案表示为一个无单位的无量纲数。", "solution": "题目陈述经过验证，被认为是具有科学依据、适定且客观的。它代表了数字信号处理领域中的一个标准问题。因此，我们可以进行形式化的求解。\n\n该问题要求基于给定的分贝指标，为一个最优等波纹低通滤波器设计推导并计算权重比 $w_s/w_p$。解法按要求从基本原理出发进行推导。\n\n首先，我们根据通带波纹的分贝指标 $A_p$ 来确定线性通带波纹 $\\delta_p$。问题陈述中指出，通带中的期望幅度响应为1，而实际滤波器的幅度响应（记为 $|H(\\omega)|$）发生偏离，其范围被限制在 $1 - \\delta_p$ 和 $1 + \\delta_p$ 之间。分贝值 $A_p$ 是为幅度比 $r$ 定义的，即 $20 \\log_{10}(r)$。对于通带波纹，该比率取通带内的最大和最小幅度之比。\n因此，通带波纹 $A_p$ 由下式给出：\n$$ A_p = 20 \\log_{10}\\left(\\frac{1 + \\delta_p}{1 - \\delta_p}\\right) $$\n给定 $A_p = 0.25 \\, \\text{dB}$。我们求解 $\\delta_p$：\n$$ \\frac{A_p}{20} = \\log_{10}\\left(\\frac{1 + \\delta_p}{1 - \\delta_p}\\right) $$\n对两边取以10为底的指数，得到：\n$$ 10^{A_p/20} = \\frac{1 + \\delta_p}{1 - \\delta_p} $$\n为了分离出 $\\delta_p$，我们可以重新整理方程。令 $K = 10^{A_p/20}$。\n$$ K(1 - \\delta_p) = 1 + \\delta_p $$\n$$ K - K\\delta_p = 1 + \\delta_p $$\n$$ K - 1 = \\delta_p (1 + K) $$\n$$ \\delta_p = \\frac{K - 1}{K + 1} = \\frac{10^{A_p/20} - 1}{10^{A_p/20} + 1} $$\n\n接下来，我们根据最小阻带衰减 $A_s$ 来确定线性阻带波纹 $\\delta_s$。阻带中的期望响应为零。滤波器在阻带中的最大幅度记为 $\\delta_s$。阻带衰减 $A_s$ 是通带中的单位参考幅度与该最大阻带幅度之比，以分贝表示。\n$$ A_s = 20 \\log_{10}\\left(\\frac{1}{\\delta_s}\\right) $$\n给定 $A_s = 60 \\, \\text{dB}$。我们求解 $\\delta_s$：\n$$ A_s = -20 \\log_{10}(\\delta_s) $$\n$$ \\frac{A_s}{-20} = \\log_{10}(\\delta_s) $$\n对两边取以10为底的指数，得到：\n$$ \\delta_s = 10^{-A_s/20} $$\n\n设计基于加权极小化极大准则，这是等波纹滤波器的基础。其目标是在所有指定频带上最小化最大加权逼近误差 $|E(\\omega)| = |W(\\omega)[H_d(\\omega) - H(\\omega)]|$。其中，$H_d(\\omega)$ 是理想期望响应，$W(\\omega)$ 是一个分段常数加权函数。对于一个最优滤波器，最大加权误差在所有频带中是相等的。\n在通带中，期望响应为 $H_d(\\omega) = 1$，权重为 $w_p$。最大绝对误差为 $|1 - |H(\\omega)||_{\\max} = \\delta_p$。最大加权误差为 $w_p \\delta_p$。\n在阻带中，期望响应为 $H_d(\\omega) = 0$，权重为 $w_s$。最大绝对误差为 $|0 - |H(\\omega)||_{\\max} = \\delta_s$。最大加权误差为 $w_s \\delta_s$。\n等波纹条件要求这些最大加权误差相等：\n$$ w_p \\delta_p = w_s \\delta_s $$\n从这个等式中，我们推导出所需的阻带权重与通带权重之比：\n$$ \\frac{w_s}{w_p} = \\frac{\\delta_p}{\\delta_s} $$\n\n现在，我们将 $\\delta_p$ 和 $\\delta_s$ 的表达式代入此比率：\n$$ \\frac{w_s}{w_p} = \\frac{1}{10^{-A_s/20}} \\left( \\frac{10^{A_p/20} - 1}{10^{A_p/20} + 1} \\right) $$\n我们已知数值 $A_p = 0.25$ 和 $A_s = 60$。\n首先，我们计算线性波纹：\n对于通带：\n$$ \\delta_p = \\frac{10^{0.25/20} - 1}{10^{0.25/20} + 1} = \\frac{10^{0.0125} - 1}{10^{0.0125} + 1} $$\n$10^{0.0125} \\approx 1.02919311$。\n$$ \\delta_p \\approx \\frac{1.02919311 - 1}{1.02919311 + 1} = \\frac{0.02919311}{2.02919311} \\approx 0.01438685 $$\n对于阻带：\n$$ \\delta_s = 10^{-60/20} = 10^{-3} = 0.001 $$\n最后，我们计算权重比：\n$$ \\frac{w_s}{w_p} = \\frac{\\delta_p}{\\delta_s} \\approx \\frac{0.01438685}{0.001} = 14.38685 $$\n问题要求答案四舍五入到四位有效数字。第五位有效数字是6，所以我们将第四位数字向上取整。\n$$ \\frac{w_s}{w_p} \\approx 14.39 $$\n这是一个无量纲量，因为它是两个权重的比率。", "answer": "$$\n\\boxed{14.39}\n$$", "id": "2888701"}, {"introduction": "Parks-McClellan算法是迭代的，需要一个滤波器阶数的初始猜测值。一个好的估计可以节省设计时间和计算资源。本练习探讨了一个广泛用于估计滤波器阶数的经验公式，将直观的窗函数设计法与最优等波纹方法联系起来，并帮助您理解其实用价值和局限性。[@problem_id:2888722]", "problem": "您正在准备运行 Parks–McClellan (PM) 算法来设计一个线性相位有限脉冲响应 (FIR) 等波纹滤波器。在运行该算法之前，您需要一个阶数估计值来初始化迭代求解器。从以下基本依据出发：\n- 理想的低通脉冲响应是砖墙频谱的离散时间傅里叶逆变换 (DTFT)，而实际的 FIR 设计通常通过对理想脉冲响应加时限窗来构建。\n- 过渡带宽度主要由窗函数 DTFT 的主瓣宽度决定，主瓣宽度与滤波器长度成反比。\n- 对于给定的窗函数族，远端旁瓣电平设定了可实现的均匀波纹幅度的近似上限，该幅度通过 $A=-20\\log_{10}(\\delta)$ 与分贝衰减相关联，其中 $\\delta$ 是波纹幅度。\n- 凯塞窗（Kaiser window）（离散扁长球状序列的一种近似）通过一个控制贝塞尔函数轮廓的形状参数，实现了主瓣宽度和旁瓣衰减之间的权衡，从而得出了用于过渡带宽和衰减的经验校准常数。\n\n设设计目标为：\n- 通带边缘的归一化角频率为 $\\omega_{p}$，阻带边缘为 $\\omega_{s}$，过渡带宽度为 $\\Delta\\omega=\\omega_{s}-\\omega_{p}$。\n- 通带波纹为 $\\delta_{p}$，阻带波纹为 $\\delta_{s}$，并定义 $A=-20\\log_{10}(\\min(\\delta_{p},\\delta_{s}))$。\n\n选择一个选项，该选项正确解释了用于初始 FIR 长度的一个广泛使用的经验阶数估计是如何从带有凯塞窗校准的加窗sinc函数观点中产生的，陈述了阶数对 $A$ 和 $\\Delta\\omega$ 的正确函数依赖关系，并准确地描述了这种估计在何时以及为何对于多带等波纹设计存在局限或需要调整。\n\nA. 该估计通过将凯塞窗的主瓣宽度与过渡带宽度等同，使用 $\\Delta\\omega \\approx \\frac{2.285\\pi}{N}$ 并取 $A=-20\\log_{10}(\\min(\\delta_{p},\\delta_{s}))$ 得出。它是一个上限，因为等波纹滤波器总是比加窗设计的滤波器需要更多的阶数（taps）。对于多带滤波器，用所有过渡带宽度的平均值替换 $\\Delta\\omega$ 以保持准确性。\n\nB. 该估计是通过注意到过渡带宽度与 $\\Delta\\omega \\propto \\frac{1}{N}$ 成比例关系，其比例常数经过凯塞校准，并且波纹幅度遵循基于窗函数旁瓣电平的 $A=-20\\log_{10}(\\min(\\delta_{p},\\delta_{s}))$ 得到的。这产生了一个形式为 $N \\approx \\frac{A-8}{2.285 \\Delta\\omega}$ 的经验关系，该关系通常会高估 Parks–McClellan 等波纹设计所需阶数的 $10\\%$ 到 $20\\%$，因此可作为一个安全的初始猜测。对于多带设计，使用所有频带中最小的过渡带宽度和最严格的波纹目标提供了一个保守的起点，但该估计忽略了频带权重分配和紧密间隔的过渡带之间的耦合，因此它可能低估或高估阶数，并可能需要迭代调整。\n\nC. 常数 $2.285$ 源自 Parks–McClellan 方法的交错定理，这使得该估计对于等波纹滤波器是精确的。因此，当 $\\Delta\\omega$ 被选为多带规范中所有过渡带宽度的最小值时，无论频带权重如何，该估计都是精确的。\n\nD. 该估计使用矩形窗主瓣宽度 $\\Delta\\omega \\approx \\frac{4\\pi}{N}$ 以及 $A=-10\\log_{10}(\\delta_{p}+\\delta_{s})$。它系统地低估了 Parks–McClellan 的阶数，并且随着频带数量的增加而变得更加准确。\n\nE. 该估计通过帕塞瓦尔定理将群延迟色散与通带波纹等同，从而在 $N \\approx \\frac{A}{2.285 \\Delta\\omega}$ 中获得一个通用常数。在多带场景中，用所有过渡带宽度的几何平均值替换 $\\Delta\\omega$ 会产生一个保守的估计。", "solution": "问题陈述在数字信号处理领域内提出了一个有效且定义明确的问题。它在科学上基于有限脉冲响应 (FIR) 滤波器设计理论，没有矛盾或歧义，并且所有术语都是该领域的标准术语。我将继续进行推导和分析。\n\n问题要求解释线性相位 FIR 滤波器的经验阶数估计，特别是从加窗sinc方法结合凯塞窗校准推导出的公式，及其与最优 Parks–McClellan (PM) 等波纹设计的关系。\n\n线性相位 FIR 滤波器的设计可以通过截断和加窗理想脉冲响应来实现。对于截止频率为 $\\omega_c$ 的低通滤波器，理想脉冲响应是一个 sinc 函数：\n$$ h_d[n] = \\frac{\\sin(\\omega_c n)}{\\pi n} $$\n该响应是无限长且非因果的。为了创建一个长度为 $N$ 的实用 FIR 滤波器，我们将 $h_d[n]$ 与一个长度为 $N$ 的有限长度窗函数 $w[n]$ 相乘。所得滤波器的频率响应 $H(e^{j\\omega})$ 是理想砖墙频率响应 $H_d(e^{j\\omega})$ 与窗函数的离散时间傅里叶变换 (DTFT) $W(e^{j\\omega})$ 的循环卷积。\n\n这种卷积有两个主要影响：\n1. 砖墙滤波器的急剧不连续性被展宽，形成一个宽度不为零的过渡带。该过渡带的宽度 $\\Delta\\omega$ 由 $W(e^{j\\omega})$ 的主瓣宽度决定。对于长度为 $N$ 的窗，主瓣宽度与 $N$ 成反比，即 $\\Delta\\omega \\propto \\frac{1}{N}$。\n2. 通带和阻带中的波纹是由 $W(e^{j\\omega})$ 的旁瓣引起的。峰值波纹幅度 $\\delta = \\min(\\delta_p, \\delta_s)$ 由窗谱的峰值旁瓣电平决定。以分贝为单位的阻带衰减 $A$ 与此波纹通过给定定义相关联：\n$$ A = -20\\log_{10}(\\delta) $$\n\n凯塞窗是一个近乎最优的窗函数族，它通过单个参数 $\\beta$ 在主瓣宽度和旁瓣电平之间提供灵活的权衡。通过广泛的经验研究，Kaiser 建立了直接将滤波器规格 $(A, \\Delta\\omega)$ 与所需滤波器长度 $N$ 联系起来的公式。这些公式是：\n对于给定的衰减 $A$，所需的 $\\beta$ 大约为：\n$$ \\beta \\approx \\begin{cases} 0.1102(A - 8.7)  A  50 \\\\ 0.5842(A - 21)^{0.4} + 0.07886(A - 21)  21 \\le A \\le 50 \\\\ 0  A  21 \\end{cases} $$\n对于给定的 $\\beta$（或 $A$），滤波器长度 $N$ 和过渡带宽 $\\Delta\\omega$ 之间的关系由下式给出：\n$$ N \\approx \\frac{D(\\beta)}{\\Delta\\omega} \\quad \\text{或} \\quad (N-1)\\Delta\\omega \\approx D(\\beta) $$\n其中 $D(\\beta)$ 是一个依赖于 $\\beta$ 的因子。Kaiser 发现量 $A-8$ 与 $(N-1)\\Delta\\omega$ 大致成正比。这引出了著名的滤波器长度 $N$ 的单一经验公式：\n$$ N \\approx \\frac{A - 8}{2.285 \\Delta\\omega} $$\n请注意，一些资料来源使用 $7.95$ 代替 $8$，并且可能包含一个 $+1$ 项，但所给出的形式是用于估计的最常见的形式。此公式提供了使用**凯塞窗方法**进行设计所需的滤波器长度。\n\nParks–McClellan 算法基于 Remez 交换算法和交错定理，设计了一个在切比雪夫意义上**最优**的 FIR 滤波器。“最优”意味着对于给定的滤波器长度 $N$，它能实现最小可能的峰值误差 $\\delta$，或者反过来说，对于给定的规格 $(\\delta_p, \\delta_s, \\omega_p, \\omega_s)$，它能找到具有最小可能长度 $N$ 的滤波器。\n\n由于凯塞窗设计是次优的，它所需的长度 $N_{Kaiser}$ 将大于或等于最优 PM 算法对于相同规格所需的长度 $N_{PM}$：$N_{Kaiser} \\ge N_{PM}$。因此，凯塞公式提供了所需 PM 滤波器长度的**高估值**。这使其成为 PM 算法一个非常有用的安全起点，因为 PM 算法需要一个滤波器阶数 ($N-1$) 的初始猜测。这种高估通常是适度的，通常在 $10\\%$ 到 $20\\%$ 的范围内，因为凯塞窗是对数学上最优的离散扁长球状序列的一个非常好的近似。\n\n对于具有多个过渡带的多带滤波器设计（例如带通或带阻滤波器），设计受最严格的规格限制。阶数估计公式必须使用最窄的过渡带宽 $\\Delta\\omega_{\\min}$ 和所需的最高衰减 $A_{\\max} = -20\\log_{10}(\\min(\\delta_i))$，其中最小值取自所有频带波纹规格。然而，这种简单的估计有其局限性。PM 算法允许对不同频带中的误差进行加权，这是基于窗的公式无法捕捉到的特性。此外，如果过渡带彼此靠得很近，它们的光谱特性可能会耦合，可能需要比估计值更高或更低的阶数。这意味着该估计是一个很好的初步猜测，但可能需要迭代优化。\n\n基于此基础，我们来评估给定的选项。\n\n**A.** 该估计通过将凯塞窗的主瓣宽度与过渡带宽度等同，使用 $\\Delta\\omega \\approx \\frac{2.285\\pi}{N}$ 并取 $A=-20\\log_{10}(\\min(\\delta_{p},\\delta_{s}))$ 得出。它是一个上限，因为等波纹滤波器总是比加窗设计的滤波器需要更多的阶数（taps）。对于多带滤波器，用所有过渡带宽度的平均值替换 $\\Delta\\omega$ 以保持准确性。\n**不正确**。公式 $\\Delta\\omega \\approx \\frac{2.285\\pi}{N}$ 是不正确的；它缺少对衰减 $A$ 的依赖。等波纹滤波器需要*更多*阶数的论证是事实性错误；作为最优设计，它们需要*更少*或相等的阶数。在多带设计中使用平均过渡带宽也是不正确的；最窄的过渡带是限制因素。\n\n**B.** 该估计是通过注意到过渡带宽度与 $\\Delta\\omega \\propto \\frac{1}{N}$ 成比例关系，其比例常数经过凯塞校准，并且波纹幅度遵循基于窗函数旁瓣电平的 $A=-20\\log_{10}(\\min(\\delta_{p},\\delta_{s}))$ 得到的。这产生了一个形式为 $N \\approx \\frac{A-8}{2.285 \\Delta\\omega}$ 的经验关系，该关系通常会高估 Parks–McClellan 等波纹设计所需阶数的 $10\\%$ 到 $20\\%$，因此可作为一个安全的初始猜测。对于多带设计，使用所有频带中最小的过渡带宽度和最严格的波纹目标提供了一个保守的起点，但该估计忽略了频带权重分配和紧密间隔的过渡带之间的耦合，因此它可能低估或高估阶数，并可能需要迭代调整。\n**正确**。此选项正确地陈述了概念基础（$\\Delta\\omega \\propto 1/N$，A 来自旁瓣），提供了正确的经验公式（$N \\approx \\frac{A-8}{2.285\\Delta\\omega}$），准确地描述了其与最优 PM 设计的关系（它是一个高估值，因此是一个安全的初始猜测），并正确地描述了多带设计的启发式方法（使用 $\\Delta\\omega_{\\min}$ 和 $A_{\\max}$）以及该方法的微妙局限性（忽略权重和频带耦合）。\n\n**C.** 常数 $2.285$ 源自 Parks–McClellan 方法的交错定理，这使得该估计对于等波纹滤波器是精确的。因此，当 $\\Delta\\omega$ 被选为多带规范中所有过渡带宽度的最小值时，无论频带权重如何，该估计都是精确的。\n**不正确**。常数 $2.285$ 来自*凯塞窗*的经验校准，而不是*交错定理*。该估计对于最优 PM 滤波器是一个近似值，而非精确值。声称无论频带权重如何都精确是错误的，因为权重直接影响最终的最优解。\n\n**D.** 该估计使用矩形窗主瓣宽度 $\\Delta\\omega \\approx \\frac{4\\pi}{N}$ 以及 $A=-10\\log_{10}(\\delta_{p}+\\delta_{s})$。它系统地低估了 Parks–McClellan 的阶数，并且随着频带数量的增加而变得更加准确。\n**不正确**。问题指定了凯塞窗校准，而不是矩形窗。矩形窗提供固定的、约 $21$ dB 的较差衰减，不适合作为通用估计器的基础。衰减公式不正确；它应该是 $-20\\log_{10}(\\delta)$。基于次优窗的估计会高估，而不是低估，所需的最优阶数。\n\n**E.** 该估计通过帕塞瓦尔定理将群延迟色散与通带波纹等同，从而在 $N \\approx \\frac{A}{2.285 \\Delta\\omega}$ 中获得一个通用常数。在多带场景中，用所有过渡带宽度的几何平均值替换 $\\Delta\\omega$ 会产生一个保守的估计。\n**不正确**。所提供的物理推理是无稽之谈。线性相位 FIR 滤波器具有恒定的群延迟，因此没有色散可以等同。帕塞瓦尔定理关联的是能量，在此上下文中不适用。公式缺少了关键的“$-8$”项。在多带设计中使用几何平均值是一种不正确的启发式方法。\n\n因此，选项 B 是唯一一个在其所有科学主张、公式和描述中都正确的选项。", "answer": "$$\\boxed{B}$$", "id": "2888722"}]}