{"hands_on_practices": [{"introduction": "离散傅里叶变换（DFT）隐含地假设信号是周期性的，这可能在分析帧的边界处引入不连续性，从而导致频谱泄漏。本练习通过检验不同窗函数的端点值，探讨了它们是如何从根本上解决这个问题的，这对理解加窗在减轻频谱泄漏中的作用至关重要。[@problem_id:2895206]", "problem": "一个长度为 $N$ 的有限长离散时间信号 $x[n]$ 与一个窗函数 $w[n]$ 相乘，得到 $y[n]=x[n]\\,w[n]$，其中 $0\\le n\\le N-1$。在计算离散傅里叶变换 (DFT) 时，分析过程隐含地使用了 $y[n]$ 的 $N$ 周期延拓，因此边界处的幅度跳变大小等于 $y[0]-y[N-1]$。考虑汉宁 (Hanning) 窗、汉明窗和布莱克曼窗在索引集 $\\{0,1,\\dots,N-1\\}$ 上的标准对称定义（零相位、偶对称、长度为 $N$），其中 $w[0]$ 和 $w[N-1]$ 表示端点采样值。下列哪个陈述正确地指出了这三种窗函数各自的端点值 $w[0]$ 和 $w[N-1]$，并正确解释了其对 DFT 下周期边界处信号不连续性的影响？\n\nA. 使用 $0\\le n\\le N-1$ 上的对称定义，汉宁窗和布莱克曼窗满足 $w[0]=w[N-1]=0$，而汉明窗满足 $w[0]=w[N-1]=0.08\\neq 0$。因此，对于任何 $x[n]$， $x[n]\\,w[n]$ 的周期延拓在边界处对于汉宁窗和布莱克曼窗没有幅度跳变，但对于汉明窗可能保留一个与 $x[0]-x[N-1]$ 成比例的残余跳变；此外，相对于汉宁窗，布莱克曼窗还能额外抑制斜率不连续性。\n\nB. 在对称形式下，这三种窗函数都具有 $w[0]=w[N-1]=0$，因此它们都同样地消除了边界不连续性；频谱泄漏的任何差异纯粹是由不同的主瓣宽度引起的。\n\nC. 汉明窗具有 $w[0]=w[N-1]=0$，而汉宁窗具有 $w[0]=w[N-1]=0.5$，所以汉明窗确保了完美的边界连续性，而汉宁窗则没有。\n\nD. 布莱克曼窗具有 $w[0]=w[N-1]=0.42$，意味着它不减少端点不连续性；汉宁窗和汉明窗都在两端逐渐变细至零，从而消除了幅度跳变。", "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确且客观的。它提出了一个关于数字信号处理中常用窗函数属性的标准问题。我现在将进行严谨的求解。\n\n问题研究了对长度为 $N$ 的离散时间信号 $x[n]$ 进行加窗处理以产生 $y[n] = x[n] w[n]$（$n \\in \\{0, 1, \\dots, N-1\\}$）的效果。离散傅里叶变换 (DFT) 的分析考虑了 $y[n]$ 的 $N$ 周期延拓，其中索引 $N$ 处的采样值被隐含地假定与索引 $0$ 处的采样值相同。一个周期边界处的幅度不连续性或跳变，由加窗序列的第一个和最后一个采样值之间的差给出，在定义的区间内即为 $y[0]$ 和 $y[N-1]$。然而，在周期延拓的背景下，跳变发生在一个数据块的末尾（$n=N-1$）和下一个数据块的开始（$n=N$，混叠为 $n=0$）之间。这个跳变的大小是 $|y[0] - y_{periodic}[N-1]| = |y[0] - y[N-1]|$。根据问题陈述，这个跳变是 $y[0]-y[N-1]$。\n\n问题指定使用窗函数的“标准对称定义”，这些定义关于点 $(N-1)/2$ 是偶对称的。这意味着对于所有 $n \\in \\{0, 1, \\dots, N-1\\}$，$w[n] = w[N-1-n]$。这种对称性的一个直接结果是端点相等：$w[0] = w[N-1]$。\n因此，幅度跳变为：\n$$ y[0] - y[N-1] = x[0]w[0] - x[N-1]w[N-1] $$\n因为 $w[0] = w[N-1]$，我们可以将其写为：\n$$ y[0] - y[N-1] = w[0] (x[0] - x[N-1]) $$\n当且仅当窗函数的端点为零，即 $w[0] = w[N-1] = 0$ 时，对于任何任意信号 $x[n]$，这个跳变都被强制为零。\n\n我们现在将使用它们在长度为 $N$ 的序列上（$n \\in \\{0, 1, \\dots, N-1\\}$）的标准对称定义，来评估三种指定窗函数中每一种的端点值。\n\n**1. 汉宁 (Hanning) 窗**\n对称的汉宁窗定义为：\n$$ w_H[n] = 0.5 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) $$\n让我们评估其端点：\n对于 $n=0$：\n$$ w_H[0] = 0.5 - 0.5 \\cos\\left(\\frac{2\\pi \\cdot 0}{N-1}\\right) = 0.5 - 0.5 \\cos(0) = 0.5 - 0.5(1) = 0 $$\n对于 $n=N-1$：\n$$ w_H[N-1] = 0.5 - 0.5 \\cos\\left(\\frac{2\\pi (N-1)}{N-1}\\right) = 0.5 - 0.5 \\cos(2\\pi) = 0.5 - 0.5(1) = 0 $$\n因此，对于汉宁窗，$w_H[0] = w_H[N-1] = 0$。这将加窗信号的端点 $y[0]$ 和 $y[N-1]$ 强制为零，完全消除了周期边界处的幅度跳变。\n\n**2. 汉明 (Hamming) 窗**\n对称的汉明窗定义为：\n$$ w_{Hm}[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) $$\n让我们评估其端点：\n对于 $n=0$：\n$$ w_{Hm}[0] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi \\cdot 0}{N-1}\\right) = 0.54 - 0.46 \\cos(0) = 0.54 - 0.46(1) = 0.08 $$\n对于 $n=N-1$：\n$$ w_{Hm}[N-1] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi (N-1)}{N-1}\\right) = 0.54 - 0.46 \\cos(2\\pi) = 0.54 - 0.46(1) = 0.08 $$\n因此，对于汉明窗，$w_{Hm}[0] = w_{Hm}[N-1] = 0.08$。端点非零。幅度跳变为 $0.08(x[0]-x[N-1])$。除非原始信号 $x[n]$ 恰好有 $x[0]=x[N-1]$，否则这个窗函数不能消除边界不连续性。非零端点是一种刻意的设计选择，用以修改窗函数的频谱，以实现比汉宁窗更低的第一旁瓣水平。\n\n**3. 布莱克曼 (Blackman) 窗**\n标准的对称“精确”布莱克曼窗定义为：\n$$ w_B[n] = 0.42 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\left(\\frac{4\\pi n}{N-1}\\right) $$\n让我们评估其端点：\n对于 $n=0$：\n$$ w_B[0] = 0.42 - 0.5 \\cos(0) + 0.08 \\cos(0) = 0.42 - 0.5(1) + 0.08(1) = 0.50 - 0.50 = 0 $$\n对于 $n=N-1$：\n$$ w_B[N-1] = 0.42 - 0.5 \\cos(2\\pi) + 0.08 \\cos(4\\pi) = 0.42 - 0.5(1) + 0.08(1) = 0 $$\n因此，对于布莱克曼窗，$w_B[0] = w_B[N-1] = 0$。与汉宁窗一样，它消除了任何信号在边界处的幅度跳变。\n\n现在，我们根据这些推导来评估给出的选项。\n\n**选项 A：** “使用 $0\\le n\\le N-1$ 上的对称定义，汉宁窗和布莱克曼窗满足 $w[0]=w[N-1]=0$，而汉明窗满足 $w[0]=w[N-1]=0.08\\neq 0$。因此，对于任何 $x[n]$， $x[n]\\,w[n]$ 的周期延拓在边界处对于汉宁窗和布莱克曼窗没有幅度跳变，但对于汉明窗可能保留一个与 $x[0]-x[N-1]$ 成比例的残余跳变；此外，相对于汉宁窗，布莱克曼窗还能额外抑制斜率不连续性。”\n- 关于所有三种窗函数端点值的陈述是正确的，如我们的计算所示。\n- 关于每种窗函数幅度跳变的结论是这些端点值的直接且正确的推论。\n- 最后的子句，“……此外，相对于汉宁窗，布莱克曼窗还能额外抑制斜率不连续性”，这种说法并不精确。汉宁窗和布莱克曼窗的连续模拟形式在其端点处的值和一阶导数均为零，这意味着两者都以相同的阶数抑制幅度和斜率不连续性。然而，布莱克曼窗的设计目标是比汉宁窗具有更优越的旁瓣抑制能力（峰值旁瓣约为 $-58$ dB，而汉宁窗约为 $-31$ dB）。这种卓越的性能来自于一种“更平滑”的窗形，它以一种最小化频谱能量泄漏的方式实现。这个短语是一种通俗的，尽管在数学上不严谨的说法，用来指代这种已知的性能优势。鉴于陈述的所有前面部分在事实上和逻辑上都是正确的，并且所有其他选项都有严重缺陷，这个选项是所提供的最准确的描述。\n**结论：正确**\n\n**选项 B：** “在对称形式下，这三种窗函数都具有 $w[0]=w[N-1]=0$，因此它们都同样地消除了边界不连续性；频谱泄漏的任何差异纯粹是由不同的主瓣宽度引起的。”\n- 最初的前提是错误的。我们的推导表明汉明窗具有非零端点，$w_{Hm}[0] = w_{Hm}[N-1] = 0.08$。这使得整个陈述无效。\n- 此外，声称泄漏差异“纯粹是由不同的主瓣宽度引起的”是一种极大的简化。旁瓣高度和滚降速率是频谱泄漏的主要特性。\n**结论：不正确**\n\n**选项 C：** “汉明窗具有 $w[0]=w[N-1]=0$ 而汉宁窗具有 $w[0]=w[N-1]=0.5$，所以汉明窗确保了完美的边界连续性而汉宁窗则没有。”\n- 这个陈述包含多个事实错误。汉明窗 a) 没有零端点，b) 不确保边界连续性。汉宁窗 a) 具有零端点，而不是 $0.5$，b) 确实确保了边界幅度连续性。这些数值完全是错误的。\n**结论：不正确**\n\n**选项 D：** “布莱克曼窗具有 $w[0]=w[N-1]=0.42$，意味着它不减少端点不连续性；汉宁窗和汉明窗都在两端逐渐变细至零，从而消除了幅度跳变。”\n- 这个陈述也充满了错误。布莱克曼窗的端点值是 $0$，而不是 $0.42$。数字 $0.42$ 仅仅是其定义中的常数项。因此，布莱克曼窗*确实*消除了幅度跳变。\n- 第二个子句声称汉宁窗和汉明窗都在两端逐渐变细至零。这对汉明窗来说是错误的。\n**结论：不正确**\n\n综上所述，选项 A 是唯一一个正确指出了三种窗函数端点值及其对边界不连续性的主要影响的陈述。尽管其最后的定性评论有轻微的不精确之处，但它仍然是唯一有效的选择。", "answer": "$$\\boxed{A}$$", "id": "2895206"}, {"introduction": "在频谱分析中，一个核心性能指标是频率分辨率，即区分两个相邻频率分量的能力。本练习将深入探讨窗函数的数学构造如何直接决定其频谱主瓣的宽度，从而揭示 Hann、Hamming 和 Blackman 窗在分辨率上的特性。[@problem_id:2895210]", "problem": "考虑三个长度为 $N \\in \\mathbb{N}$ 的有限长确定性窗函数，对于 $n \\in \\{0,1,\\dots,N-1\\}$ 定义如下：\n- 矩形窗：$w_{\\mathrm{rect}}[n] = 1$。\n- Hann (也称 Hanning) 窗：$w_{\\mathrm{Hann}}[n] = \\tfrac{1}{2} - \\tfrac{1}{2} \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$。\n- Hamming 窗：$w_{\\mathrm{Hamming}}[n] = 0.54 - 0.46 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$。\n- Blackman 窗：$w_{\\mathrm{Blackman}}[n] = 0.42 - 0.5 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\!\\left(\\tfrac{4\\pi n}{N-1}\\right)$。\n\n令 $W(\\omega)$ 表示窗函数 $w[n]$ 的离散时间傅里叶变换 (DTFT)，其定义为 $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\, \\exp(-j \\omega n)$，其中 $\\omega$ 是实数弧度频率。将主瓣宽度定义为 $\\lvert W(\\omega) \\rvert$ 最靠近原点的第一个负零点和第一个正零点之间的 $\\omega$ (以弧度为单位) 的零点到零点距离。\n\n仅从 DTFT 定义和对于大 $N$ 时的渐近黎曼和近似出发，通过 $t = n/(N-1)$ 将 $w[n]$ 建模为单位区间上平滑函数 $g(t)$ 的采样，并使用大 $N$ 标度近似 $W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp\\!\\big(-j \\omega (N-1) t\\big) \\, dt$。通过在 $2\\pi$ 的谐波处计算积分核的第一个谱零点，确定每个窗函数的主瓣宽度随 $N$ 的标度关系，并提取相对于矩形窗基线的比例常数 (即常数 $\\kappa$，使得对于大 $N$，有 $\\Delta \\omega_{\\mathrm{window}} \\approx \\kappa \\, \\Delta \\omega_{\\mathrm{rect}}$)。\n\n您必须：\n1. 使用积分近似和 $\\int_{0}^{1} \\exp(-j 2\\pi k t) \\, dt$ (其中 $k$ 为整数) 的性质，从第一性原理出发，论证随 $N$ 的标度关系。\n2. 对于每个窗函数，确定在大 $N$ 极限下 $\\omega$ (以弧度为单位) 的第一个正零点位置，从而确定零点到零点的主瓣宽度。\n3. 按照 Hann、Hamming、Blackman 的顺序，报告相对于矩形窗的三个比例常数。\n\n将最终答案表示为一个行矩阵，其中按 Hann、Hamming、Blackman 的顺序包含三个比例常数，无单位。无需进行数值舍入。所有角度均以弧度为单位。", "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。不存在矛盾、信息缺失或违反科学原则的情况。将推导解答。\n\n长度为 $N$ 的窗函数 $w[n]$ 的离散时间傅里叶变换 (DTFT) 由 $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\exp(-j \\omega n)$ 给出。对于大 $N$，这个和可以用积分来近似。通过为 $n \\in \\{0, 1, \\dots, N-1\\}$ 定义一个连续变量 $t = \\frac{n}{N-1}$，离散窗函数 $w[n]$ 被建模为区间 $t \\in [0, 1]$ 上连续函数 $g(t)$ 的采样。DTFT 随之被近似为一个黎曼和：\n$$ W(\\omega) \\approx \\sum_{n=0}^{N-1} g\\left(\\frac{n}{N-1}\\right) \\exp\\left(-j \\omega (N-1) \\frac{n}{N-1}\\right) \\Delta n $$\n当 $\\Delta n=1$ 时，这变成一个关于 $t$ 的积分：\n$$ W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp(-j \\omega (N-1) t) \\, dt $$\n我们定义一个缩放频率变量 $\\Omega = \\omega(N-1)$。积分核是 $g(t)$ 关于此缩放频率的连续傅里叶变换：\n$$ G(\\Omega) = \\int_{0}^{1} g(t) \\exp(-j \\Omega t) \\, dt $$\n那么 DTFT 为 $W(\\omega) \\approx (N-1) G(\\Omega)$。对于大 $N$， $W(\\omega)$ 的零点对应于 $G(\\Omega)$ 的零点。\n\n对每个窗函数的分析都依赖于区间 $[0, 1]$ 上常数函数的变换，我们将其记为 $S(\\Omega)$：\n$$ S(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = \\left[ \\frac{\\exp(-j \\Omega t)}{-j \\Omega} \\right]_{0}^{1} = \\frac{1 - \\exp(-j \\Omega)}{j \\Omega} $$\n这可以写成一个相移 sinc 函数：\n$$ S(\\Omega) = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\exp(j \\frac{\\Omega}{2}) - \\exp(-j \\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{2j \\sin(\\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\sin(\\frac{\\Omega}{2})}{\\frac{\\Omega}{2}} $$\n$S(\\Omega)$ 的零点发生在 $\\sin(\\Omega/2) = 0$ 但 $\\Omega \\ne 0$ 时。这给出 $\\frac{\\Omega}{2} = k\\pi$，对于任意非零整数 $k$，因此 $\\Omega = 2k\\pi$，其中 $k \\in \\mathbb{Z} \\setminus \\{0\\}$。在 $\\Omega=0$ 时，我们有 $S(0) = \\int_0^1 1 \\, dt = 1$。因此，对于整数 $m$，$S(2\\pi m) = \\delta_{m,0}$，其中 $\\delta$ 是克罗内克 δ 函数。\n\n我们现在依次分析每个窗函数。\n\n1.  **矩形窗**\n    连续模型为 $g_{\\mathrm{rect}}(t) = 1$，对于 $t \\in [0, 1]$。\n    其变换为 $G_{\\mathrm{rect}}(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = S(\\Omega)$。\n    $S(\\Omega)$ 的第一个正零点位于 $\\Omega = 2\\pi$。由于 $\\Omega = \\omega(N-1)$，$W(\\omega)$ 的第一个正零点位于 $\\omega_1 = \\frac{2\\pi}{N-1}$。主瓣是对称的，因此第一个负零点位于 $\\omega_{-1} = -\\frac{2\\pi}{N-1}$。\n    主瓣宽度定义为零点到零点的距离：\n    $$ \\Delta \\omega_{\\mathrm{rect}} = \\omega_1 - \\omega_{-1} = \\frac{2\\pi}{N-1} - \\left(-\\frac{2\\pi}{N-1}\\right) = \\frac{4\\pi}{N-1} $$\n    这确立了随 $N$ 的基本标度关系为 $\\frac{1}{N-1}$ (或对于大 $N$ 为 $\\frac{1}{N}$)。\n\n2.  **Hann 窗**\n    连续模型为 $g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{2} \\cos(2\\pi t)$。使用欧拉公式 $\\cos(x) = \\frac{1}{2}(\\exp(jx) + \\exp(-jx))$，我们得到：\n    $$ g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{4} \\exp(j2\\pi t) - \\frac{1}{4} \\exp(-j2\\pi t) $$\n    根据傅里叶变换的线性和频移性质，其变换 $G_{\\mathrm{Hann}}(\\Omega)$ 为：\n    $$ G_{\\mathrm{Hann}}(\\Omega) = \\frac{1}{2} S(\\Omega) - \\frac{1}{4} S(\\Omega - 2\\pi) - \\frac{1}{4} S(\\Omega + 2\\pi) $$\n    我们通过在 $2\\pi$ 的谐波处求值来寻找第一个正零点。\n    在 $\\Omega=2\\pi$ 处：$G_{\\mathrm{Hann}}(2\\pi) = \\frac{1}{2}S(2\\pi) - \\frac{1}{4}S(0) - \\frac{1}{4}S(4\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(1) - \\frac{1}{4}(0) = -\\frac{1}{4} \\ne 0$。\n    在 $\\Omega=4\\pi$ 处：$G_{\\mathrm{Hann}}(4\\pi) = \\frac{1}{2}S(4\\pi) - \\frac{1}{4}S(2\\pi) - \\frac{1}{4}S(6\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(0) - \\frac{1}{4}(0) = 0$。\n    第一个正零点位于 $\\Omega = 4\\pi$。$W(\\omega)$ 的第一个零点位于 $\\omega_1 = \\frac{4\\pi}{N-1}$。\n    主瓣宽度为 $\\Delta \\omega_{\\mathrm{Hann}} = 2 \\omega_1 = \\frac{8\\pi}{N-1}$。\n    相对于矩形窗的比例常数为 $\\kappa_{\\mathrm{Hann}} = \\frac{\\Delta \\omega_{\\mathrm{Hann}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$。\n\n3.  **Hamming 窗**\n    连续模型为 $g_{\\mathrm{Hamming}}(t) = 0.54 - 0.46 \\cos(2\\pi t)$。这与 Hann 窗具有相同的函数形式，$g(t) = a_0 - a_1 \\cos(2\\pi t)$。\n    其变换为 $G_{\\mathrm{Hamming}}(\\Omega) = 0.54 S(\\Omega) - 0.23 (S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi))$。\n    在 $2\\pi$ 的谐波处寻找零点的逻辑是相同的。\n    在 $\\Omega=2\\pi$ 处：$G_{\\mathrm{Hamming}}(2\\pi) = 0.54 S(2\\pi) - 0.23 S(0) - 0.23 S(4\\pi) = -0.23 \\ne 0$。\n    在 $\\Omega=4\\pi$ 处：$G_{\\mathrm{Hamming}}(4\\pi) = 0.54 S(4\\pi) - 0.23 S(2\\pi) - 0.23 S(6\\pi) = 0$。\n    第一个正零点也位于 $\\Omega = 4\\pi$。主瓣宽度为 $\\Delta \\omega_{\\mathrm{Hamming}} = \\frac{8\\pi}{N-1}$。\n    比例常数为 $\\kappa_{\\mathrm{Hamming}} = \\frac{\\Delta \\omega_{\\mathrm{Hamming}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$。\n\n4.  **Blackman 窗**\n    连续模型为 $g_{\\mathrm{Blackman}}(t) = 0.42 - 0.5 \\cos(2\\pi t) + 0.08 \\cos(4\\pi t)$。\n    使用欧拉公式，其变换由五个移位的 $S(\\Omega)$ 函数组成：\n    $$ G_{\\mathrm{Blackman}}(\\Omega) = 0.42 S(\\Omega) - 0.25(S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi)) + 0.04(S(\\Omega - 4\\pi) + S(\\Omega + 4\\pi)) $$\n    我们在 $2\\pi$ 的谐波处检查零点：\n    在 $\\Omega=2\\pi$ 处：$G_{\\mathrm{Blackman}}(2\\pi) = 0.42 S(2\\pi) - 0.25(S(0)+S(4\\pi)) + 0.04(S(-2\\pi)+S(6\\pi)) = -0.25 \\ne 0$。\n    在 $\\Omega=4\\pi$ 处：$G_{\\mathrm{Blackman}}(4\\pi) = 0.42 S(4\\pi) - 0.25(S(2\\pi)+S(6\\pi)) + 0.04(S(0)+S(8\\pi)) = 0.04 \\ne 0$。\n    在 $\\Omega=6\\pi$ 处：$G_{\\mathrm{Blackman}}(6\\pi) = 0.42 S(6\\pi) - 0.25(S(4\\pi)+S(8\\pi)) + 0.04(S(2\\pi)+S(10\\pi)) = 0$。\n    第一个正零点位于 $\\Omega = 6\\pi$。第一个零点位于 $\\omega_1 = \\frac{6\\pi}{N-1}$。\n    主瓣宽度为 $\\Delta \\omega_{\\mathrm{Blackman}} = 2 \\omega_1 = \\frac{12\\pi}{N-1}$。\n    比例常数为 $\\kappa_{\\mathrm{Blackman}} = \\frac{\\Delta \\omega_{\\mathrm{Blackman}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{12\\pi/(N-1)}{4\\pi/(N-1)} = 3$。\n\n总而言之，对于一个由高达第 $M$ 次谐波的余弦组成的窗函数 $g(t) = \\sum_{k=0}^M a_k \\cos(2\\pi k t)$，在这种连续近似下，其主瓣宽度的第一个零点位于 $\\Omega=2\\pi(M+1)$。\n- 矩形窗：$M=0$，第一个零点在 $2\\pi$。宽度因子为 $1$。\n- Hann/Hamming 窗：$M=1$，第一个零点在 $4\\pi$。宽度因子为 $2$。\n- Blackman 窗：$M=2$，第一个零点在 $6\\pi$。宽度因子为 $3$。\n\n相对于矩形窗，Hann、Hamming 和 Blackman 窗的比例常数分别为 $2$、$2$ 和 $3$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  2  3\n\\end{pmatrix}\n}\n$$", "id": "2895210"}, {"introduction": "加窗操作不仅影响信号，也改变了噪声在频域的分布，这对信噪比的分析至关重要。本练习引入了等效噪声带宽（$ENBW$）这一关键概念，通过计算和比较不同窗函数的 $ENBW$，您将学会如何量化加窗对频谱噪声基底的影响。[@problem_id:2895221]", "problem": "一位工程师在计算长度为 $N$ 的离散傅里叶变换 (DFT) 之前，对一段长度为 $N$ 的离散时间记录使用了三种广泛应用的确定性锥削窗——汉恩窗 (也称汉宁窗)、汉明窗和布莱克曼窗。这些余弦和窗定义为，对于 $n \\in \\{0,1,\\dots,N-1\\}$：\n- 汉恩窗：$w_{\\mathrm{Hann}}[n] = \\tfrac{1}{2} - \\tfrac{1}{2}\\cos\\!\\big(2\\pi n/(N-1)\\big)$，\n- 汉明窗：$w_{\\mathrm{Ham}}[n] = 0.54 - 0.46\\cos\\!\\big(2\\pi n/(N-1)\\big)$，\n- 布莱克曼窗：$w_{\\mathrm{Blk}}[n] = 0.42 - 0.50\\cos\\!\\big(2\\pi n/(N-1)\\big) + 0.08\\cos\\!\\big(4\\pi n/(N-1)\\big)$，\n\n其中所有余弦函数的参数单位均为弧度。\n\n考虑等效噪声带宽 (ENBW)，其定义为：当输入为具有平坦功率谱密度的离散时间白噪声时，一个理想矩形滤波器的带宽。该滤波器的带宽应使其通过的平均噪声功率，与实际加窗频谱响应在 DFT 输出谱线中心处通过的平均噪声功率相同。在标准的 DFT 频率归一化下进行计算，其中一个频率单元（bin）对应的频率间隔为 $1/N$ 周期/采样点，因此矩形窗（即无窗）的基线 ENBW 为 $1.0$ 个频率单元。\n\n从 ENBW 的上述定义、Parseval 定理以及当 $N \\to \\infty$ 时将求和与积分联系起来的黎曼和极限出发，推导出一个在 $N$ 较大极限下以 DFT 频率单元为单位的 ENBW 表达式，该表达式仅依赖于窗函数样本的均值。然后，对上述三种窗函数计算该值。按汉恩窗、汉明窗、布莱克曼窗的顺序，报告这三个渐近 ENBW 值（以频率单元为单位）。将每个值四舍五入至四位有效数字。将最终答案表示为单个行向量。", "solution": "我们从等效噪声带宽 (ENBW) 的定义开始。对于施加在具有平坦功率谱密度的白噪声上的确定性窗函数 $w[n]$，ENBW 在与归一化频率 $f \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$（单位：周期/采样点）上的离散时间傅里叶变换一致的频率单位下，表示为：\n$$\nB_{\\mathrm{e}} \\equiv \\frac{\\displaystyle \\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df}{\\displaystyle \\big|W(0)\\big|^{2}},\n$$\n其中 $W(f) = \\sum_{n=0}^{N-1} w[n]\\exp(-j 2\\pi f n)$ 是窗函数的频率响应，且 $W(0) = \\sum_{n=0}^{N-1} w[n]$。为了以 DFT “频率单元 (bin)” 表示 ENBW，我们将其除以频率单元间隔 $\\Delta f = 1/N$，得到：\n$$\n\\mathrm{ENBW\\ (bins)} \\;=\\; \\frac{B_{\\mathrm{e}}}{\\Delta f} \\;=\\; N \\,\\frac{\\displaystyle \\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df}{\\displaystyle \\big|W(0)\\big|^{2}}.\n$$\n根据此处使用的连续频率离散时间傅里叶变换 (DTFT) 惯例的 Parseval 定理，\n$$\n\\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df \\;=\\; \\sum_{n=0}^{N-1} w[n]^{2}.\n$$\n因此，\n$$\n\\mathrm{ENBW\\ (bins)} \\;=\\; N \\,\\frac{\\displaystyle \\sum_{n=0}^{N-1} w[n]^{2}}{\\displaystyle \\Big(\\sum_{n=0}^{N-1} w[n]\\Big)^{2}}.\n$$\n现在我们考虑形式为 $w[n] = g\\!\\big(\\tfrac{n}{N-1}\\big)$ 的余弦和窗在 $N$ 较大时的极限，其中 $g$ 在 $[0,1]$ 上是光滑的。定义归一化索引 $x \\equiv n/(N-1) \\in [0,1]$。当 $N \\to \\infty$ 时，黎曼和收敛于积分：\n$$\n\\sum_{n=0}^{N-1} w[n] \\;\\approx\\; N \\int_{0}^{1} g(x)\\,dx \\;\\equiv\\; N\\,\\mu,\n\\quad\n\\sum_{n=0}^{N-1} w[n]^{2} \\;\\approx\\; N \\int_{0}^{1} g(x)^{2}\\,dx \\;\\equiv\\; N\\,\\nu,\n$$\n其中 $\\mu$ 和 $\\nu$ 分别是 $w$ 和 $w^2$ 在 $x \\in [0,1]$ 上的一阶矩和二阶矩（均值）。因此，以频率单元表示的渐近 ENBW 为：\n$$\n\\lim_{N\\to\\infty} \\mathrm{ENBW} \\;=\\; \\lim_{N\\to\\infty} N \\,\\frac{N\\,\\nu}{(N\\,\\mu)^{2}} \\;=\\; \\frac{\\nu}{\\mu^{2}}.\n$$\n因此，我们只需利用余弦函数的正交性，通过在 $x \\in [0,1]$ 上求平均来为每个窗函数计算 $\\mu$ 和 $\\nu$：\n$$\n\\int_{0}^{1}\\cos(2\\pi k x)\\,dx = 0 \\;\\text{for}\\; k \\in \\mathbb{Z}\\setminus\\{0\\}, \n\\qquad\n\\int_{0}^{1}\\cos^{2}(2\\pi k x)\\,dx = \\frac{1}{2} \\;\\text{for}\\; k \\in \\mathbb{Z}\\setminus\\{0\\},\n$$\n且不同谐波的混合乘积积分为零。\n\n汉恩窗。令 $w(x) = \\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)$。则\n$$\n\\mu_{\\mathrm{Hann}} = \\int_{0}^{1} \\Big(\\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)\\Big)\\,dx = \\tfrac{1}{2},\n$$\n并且\n\\begin{align*}\n\\nu_{\\mathrm{Hann}} = \\int_{0}^{1} \\Big(\\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)\\Big)^{2} dx \\\\\n= \\int_{0}^{1} \\Big(\\tfrac{1}{4} - \\tfrac{1}{2}\\cos(2\\pi x) + \\tfrac{1}{4}\\cos^{2}(2\\pi x)\\Big) dx \\\\\n= \\tfrac{1}{4} + \\tfrac{1}{4}\\cdot \\tfrac{1}{2} \\;=\\; \\tfrac{3}{8}.\n\\end{align*}\n因此\n$$\n\\mathrm{ENBW}_{\\mathrm{Hann}} = \\frac{\\nu_{\\mathrm{Hann}}}{\\mu_{\\mathrm{Hann}}^{2}} = \\frac{\\tfrac{3}{8}}{(\\tfrac{1}{2})^{2}} = \\frac{3}{2} = 1.5 \\;\\text{bins}.\n$$\n\n汉明窗。令 $w(x) = 0.54 - 0.46\\cos(2\\pi x)$。则\n$$\n\\mu_{\\mathrm{Ham}} = 0.54,\n$$\n并且\n\\begin{align*}\n\\nu_{\\mathrm{Ham}} = \\int_{0}^{1} \\big(0.54 - 0.46\\cos(2\\pi x)\\big)^{2} dx \\\\\n= 0.54^{2} + 0.46^{2}\\cdot \\tfrac{1}{2} \\\\\n= \\frac{27^{2}}{50^{2}} + \\frac{1}{2}\\cdot \\frac{23^{2}}{50^{2}} \\\\\n= \\frac{1987}{5000}.\n\\end{align*}\n因此\n$$\n\\mathrm{ENBW}_{\\mathrm{Ham}} = \\frac{\\nu_{\\mathrm{Ham}}}{\\mu_{\\mathrm{Ham}}^{2}} = \\frac{\\tfrac{1987}{5000}}{(\\tfrac{27}{50})^{2}} = \\frac{1987}{1458} \\approx 1.3628\\ \\text{bins}.\n$$\n\n布莱克曼窗。令 $w(x) = 0.42 - 0.50\\cos(2\\pi x) + 0.08\\cos(4\\pi x)$。则\n$$\n\\mu_{\\mathrm{Blk}} = 0.42,\n$$\n并且，利用正交性消除交叉项，\n\\begin{align*}\n\\nu_{\\mathrm{Blk}} = \\int_{0}^{1} \\Big(0.42 - 0.50\\cos(2\\pi x) + 0.08\\cos(4\\pi x)\\Big)^{2} dx \\\\\n= 0.42^{2} + \\tfrac{1}{2}(0.50)^{2} + \\tfrac{1}{2}(0.08)^{2} \\\\\n= \\frac{441}{2500} + \\frac{1}{8} + \\frac{2}{625} \\\\\n= \\frac{1523}{5000}.\n\\end{align*}\n因此，\n$$\n\\mathrm{ENBW}_{\\mathrm{Blk}} = \\frac{\\nu_{\\mathrm{Blk}}}{\\mu_{\\mathrm{Blk}}^{2}} = \\frac{\\tfrac{1523}{5000}}{(\\tfrac{21}{50})^{2}} = \\frac{1523}{882} \\approx 1.7268\\ \\text{bins}.\n$$\n\n作为比较，矩形窗有 $w[n] \\equiv 1$，因此 $\\mu = 1$ 且 $\\nu = 1$，得到 $\\mathrm{ENBW} = 1.0$ 个频率单元，这与指定的基线相符。\n\n将每个渐近值四舍五入到四位有效数字，并按汉恩窗、汉明窗、布莱克曼窗的顺序列出，我们便得到所要求的以频率单元为单位的行向量。", "answer": "$$\\boxed{\\begin{pmatrix} 1.500  1.363  1.727 \\end{pmatrix}}$$", "id": "2895221"}]}