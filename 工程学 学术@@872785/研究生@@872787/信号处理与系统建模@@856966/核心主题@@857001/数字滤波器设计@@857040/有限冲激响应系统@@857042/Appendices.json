{"hands_on_practices": [{"introduction": "理解给定滤波器的特性是信号处理的基石。此练习聚焦于线性相位FIR滤波器，这类滤波器因其能够处理信号而不产生相位失真而备受青睐。通过从滤波器的对称脉冲响应出发，您将推导出其实振幅函数和恒定群延迟，从而巩固时域对称性与频域特性之间的基本联系。[@problem_id:2881290]", "problem": "考虑一个长度为 $N=7$ 的实值有限冲激响应 (FIR) 滤波器，其对于所有整数 $n$ 具有偶对称性 $h[n]=h[6-n]$，并具有以下指定的系数：\n- $h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$，且根据对称性有 $h[4]=\\frac{3}{16}$，$h[5]=-\\frac{1}{8}$，$h[6]=\\frac{1}{16}$。\n\n仅从冲激响应的离散时间傅里叶变换 (DTFT) 的定义和给定的对称性出发，推导频率响应的显式表达式，其形式为线性相位分解 $H(\\omega)=\\exp(-j \\omega M)\\,A(\\omega)$，并将实振幅函数 $A(\\omega)$ 确定为余弦项的和。然后，利用群延迟根据相位的定义，确定该滤波器的恒定群延迟。\n\n所有角量均使用弧度，并将群延迟以采样点数为单位表示。将最终答案以一个单行矩阵的两个条目的形式给出，其中第一个条目是 $A(\\omega)$ 的显式表达式，第二个条目是群延迟。无需进行四舍五入。", "solution": "对问题陈述进行验证。\n\n提取已知条件如下：\n1.  该滤波器是实值有限冲激响应 (FIR) 滤波器。\n2.  滤波器长度为 $N=7$。\n3.  冲激响应表现出偶对称性：$h[n]=h[6-n]$，对所有整数 $n$ 成立。\n4.  指定的系数为：$h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$。剩余系数由对称性确定：$h[4]=h[6-4]=h[2]=\\frac{3}{16}$，$h[5]=h[6-5]=h[1]=-\\frac{1}{8}$ 以及 $h[6]=h[6-6]=h[0]=\\frac{1}{16}$。\n\n该问题具有科学依据，是良定且客观的。它涉及数字信号处理中的标准概念，特别是 I 型线性相位 FIR 滤波器的分析。所有提供的数据都是一致且足以得到唯一解的。因此，该问题被视为有效。下面将进行求解。\n\n冲激响应为 $h[n]$ 的离散时间滤波器的频率响应 $H(\\omega)$ 由其离散时间傅里叶变换 (DTFT) 给出。对于长度为 $N$ 的滤波器，其定义为：\n$$H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-j \\omega n)$$\n给定滤波器长度为 $N=7$，求和范围是从 $n=0$ 到 $n=6$：\n$$H(\\omega) = \\sum_{n=0}^{6} h[n] \\exp(-j \\omega n)$$\n展开此求和式可得：\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[4]\\exp(-j4\\omega) + h[5]\\exp(-j5\\omega) + h[6]\\exp(-j6\\omega)$$\n问题陈述指出冲激响应具有偶对称性 $h[n]=h[6-n]$。我们将此性质应用于系数：\n$h[6] = h[0]$，$h[5] = h[1]$，以及 $h[4] = h[2]$。\n将这些代入 $H(\\omega)$ 的表达式中：\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[2]\\exp(-j4\\omega) + h[1]\\exp(-j5\\omega) + h[0]\\exp(-j6\\omega)$$\n为了揭示线性相位结构，我们必须围绕冲激响应的中心对称地对各项进行分组。对于长度为 $N=7$ 的滤波器，其对称中心位于索引 $n=\\frac{N-1}{2} = \\frac{7-1}{2}=3$。\n$$H(\\omega) = h[3]\\exp(-j3\\omega) + \\left( h[0] + h[0]\\exp(-j6\\omega) \\right) + \\left( h[1]\\exp(-j\\omega) + h[1]\\exp(-j5\\omega) \\right) + \\left( h[2]\\exp(-j2\\omega) + h[2]\\exp(-j4\\omega) \\right)$$\n我们提出对应于对称中心的相位项 $\\exp(-j3\\omega)$：\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + h[0]\\left(\\exp(j3\\omega) + \\exp(-j3\\omega)\\right) + h[1]\\left(\\exp(j2\\omega) + \\exp(-j2\\omega)\\right) + h[2]\\left(\\exp(j\\omega) + \\exp(-j\\omega)\\right) \\right]$$\n使用欧拉恒等式 $2\\cos(\\theta) = \\exp(j\\theta) + \\exp(-j\\theta)$，我们可以将括号内的项表示为余弦函数：\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + 2h[0]\\cos(3\\omega) + 2h[1]\\cos(2\\omega) + 2h[2]\\cos(\\omega) \\right]$$\n该表达式符合所要求的线性相位形式 $H(\\omega)=\\exp(-j \\omega M)A(\\omega)$，其中 $M=3$，且 $A(\\omega)$ 是实值振幅函数：\n$$A(\\omega) = h[3] + 2h[2]\\cos(\\omega) + 2h[1]\\cos(2\\omega) + 2h[0]\\cos(3\\omega)$$\n现在，我们代入给定的系数值：$h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$。\n$$A(\\omega) = \\frac{1}{4} + 2\\left(\\frac{3}{16}\\right)\\cos(\\omega) + 2\\left(-\\frac{1}{8}\\right)\\cos(2\\omega) + 2\\left(\\frac{1}{16}\\right)\\cos(3\\omega)$$\n$$A(\\omega) = \\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega)$$\n这就是实振幅函数 $A(\\omega)$ 的显式表达式。\n\n接下来，我们确定群延迟 $\\tau_g(\\omega)$。群延迟定义为频率响应的相位对角频率 $\\omega$ 的负导数：\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega} \\arg\\{H(\\omega)\\}$$\n频率响应为 $H(\\omega) = A(\\omega)\\exp(-j3\\omega)$。函数 $A(\\omega)$ 是实数，因此其相位 $\\arg\\{A(\\omega)\\}$ 要么为 $0$（如果 $A(\\omega) > 0$），要么为 $\\pi$（如果 $A(\\omega)  0$）。\n$H(\\omega)$ 的总相位，记为 $\\phi(\\omega)$，是：\n$$\\phi(\\omega) = \\arg\\{H(\\omega)\\} = \\arg\\{A(\\omega)\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} + \\arg\\{\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} - 3\\omega$$\n对于线性相位滤波器，群延迟通常由相位的线性分量定义。在 $A(\\omega)$ 符号不变的 $\\omega$ 区域内，$\\arg\\{A(\\omega)\\}$ 是一个常数（$0$ 或 $\\pi$），其导数为零。因此，相位的导数是：\n$$\\frac{d\\phi(\\omega)}{d\\omega} = \\frac{d}{d\\omega}(-3\\omega) = -3$$\n因此，群延迟是恒定的：\n$$\\tau_g(\\omega) = -(-3) = 3$$\n群延迟为 $3$ 个采样点。这与 I 型线性相位 FIR 滤波器的一般理论相符，该理论指出其群延迟是恒定的，等于 $(N-1)/2$。\n\n最终答案由 $A(\\omega)$ 的表达式和群延迟的恒定值组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega)  3\n\\end{pmatrix}\n}\n$$", "id": "2881290"}, {"introduction": "从分析转向设计，本练习将探讨如何从滤波器的基本构成要素——零点——来构建一个滤波器。零点在z平面上的位置决定了滤波器频率响应的零值点，从而可以精确地消除不需要的频率。在此问题中，您将根据一组指定的零点构建一个因果、实系数的FIR滤波器并归一化其增益，从而亲手实践零极点配置的设计方法。[@problem_id:2872240]", "problem": "考虑一个因果的、有限冲激响应 (FIR)、线性时不变 (LTI) 的离散时间系统，其系统函数具有实系数。给定其复零点集合（以极坐标形式给出）为 $$\\{z_{1},z_{2},z_{3}\\}=\\left\\{r\\,\\exp(j\\pi/3),\\;r\\,\\exp(-j\\pi/3),\\;-\\,\\frac{1}{4}\\right\\},$$ 其中 $$r=\\frac{4}{5}$$，所有角度均以弧度为单位。请仅使用系统函数零点的定义和双边 $z$ 变换的定义，构造一个因果的、具有实系数的 FIR 系统函数 $$H(z)$$，使其零点恰好为给定集合中的这些零点。选择总实数增益，使得系统在零频率处的离散时间频率响应为 1，即在标准代换 $$z=\\exp(j\\omega)$$ 下，有 $$H(1)=1$$。根据你构造的 $$H(z)$$，通过 $z$ 反变换求出其对应的冲激响应 $$h[n]$$。\n\n解题过程需从第一性原理和基本定义出发；不要使用任何预先给定的因式分解模板或“食谱式”公式。请基于给定的零点集合，证明系统函数的系数为何是实数，并阐明在你的构造过程中是如何保证冲激响应的因果性和有限性的。\n\n最后，以无舍入的精确有理数形式报告 $$h[2]$$ 的值作为最终答案。", "solution": "对所述问题进行验证。\n\n逐字提取的已知条件如下：\n1.  一个因果的、有限冲激响应 (FIR)、线性时不变 (LTI) 的离散时间系统。\n2.  系统函数具有实系数。\n3.  复零点集合为 $\\{z_{1},z_{2},z_{3}\\}=\\left\\{r\\,\\exp(j\\pi/3),\\;r\\,\\exp(-j\\pi/3),\\;-\\,\\frac{1}{4}\\right\\}$。\n4.  参数 $r$ 给定为 $r=\\frac{4}{5}$。\n5.  所有角度均以弧度为单位。\n6.  解题方法必须仅使用零点的定义和双边 $z$ 变换。\n7.  施加了一个归一化条件：离散时间频率响应在零频率处为 1，通过代换 $z=\\exp(j\\omega)$ 可转换为 $H(1)=1$。\n8.  任务是求出冲激响应 $h[n]$ 并报告 $h[2]$ 的值。\n\n验证结论：\n问题是有效的。它在科学上基于数字信号处理的既有理论。问题是适定的，提供了足够的信息（零点和增益归一化条件）来唯一确定一个 FIR 滤波器的系统函数。约束条件是自洽和客观的。问题避免了歧义，并遵循了该学科内的标准定义。\n\n开始求解。\n\n冲激响应 $h[n]$ 的双边 $z$ 变换定义为 $H(z) = \\sum_{n=-\\infty}^{\\infty} h[n] z^{-n}$。对于一个因果的、有限冲激响应 (FIR) 系统，其冲激响应仅在 $n \\in [0, N-1]$（其中 $N$ 为某个有限整数）时非零。因此，定义简化为：\n$$H(z) = \\sum_{n=0}^{N-1} h[n] z^{-n} = h[0] + h[1]z^{-1} + h[2]z^{-2} + \\dots + h[N-1]z^{-(N-1)}$$\n这种形式是关于变量 $z^{-1}$ 的多项式。因果性通过求和从 $n=0$ 开始得到保证，而有限持续时间则通过有限的求和上界 $N-1$ 得到保证。\n\n系统函数 $H(z)$ 的一个零点是一个复数 $z_k$，满足 $H(z_k)=0$。对于一个多项式，这意味着 $(z-z_k)$ 是该多项式的一个因子。当表示为关于 $z^{-1}$ 的多项式时，位于 $z=z_k$ 的一个零点意味着存在因子 $(1 - z_k z^{-1})$，因为代入 $z=z_k$ 会得到 $1 - z_k (z_k)^{-1} = 1-1=0$。\n\n问题提供了三个零点。因此，系统函数必须具有以下形式：\n$$H(z) = K \\left(1 - z_1 z^{-1}\\right)\\left(1 - z_2 z^{-1}\\right)\\left(1 - z_3 z^{-1}\\right)$$\n其中 $K$ 是一个实数增益常数，三个零点因子的存在意味着 $N-1=3$，所以 $N=4$。冲激响应的长度将为 $4$。这种关于 $z^{-1}$ 的多项式结构内在地满足了 FIR 和因果性的要求。\n\n给定的零点是：\n$$z_1 = r\\,\\exp(j\\pi/3) = \\frac{4}{5}\\left(\\cos(\\pi/3) + j\\sin(\\pi/3)\\right) = \\frac{4}{5}\\left(\\frac{1}{2} + j\\frac{\\sqrt{3}}{2}\\right) = \\frac{2}{5} + j\\frac{2\\sqrt{3}}{5}$$\n$$z_2 = r\\,\\exp(-j\\pi/3) = \\frac{4}{5}\\left(\\cos(-\\pi/3) + j\\sin(-\\pi/3)\\right) = \\frac{4}{5}\\left(\\frac{1}{2} - j\\frac{\\sqrt{3}}{2}\\right) = \\frac{2}{5} - j\\frac{2\\sqrt{3}}{5}$$\n$$z_3 = -\\frac{1}{4}$$\n系统函数必须具有实系数。对于一个多项式，这成立的充要条件是其复数根以共轭对的形式出现。我们验证 $z_1^* = \\left(\\frac{2}{5} + j\\frac{2\\sqrt{3}}{5}\\right)^* = \\frac{2}{5} - j\\frac{2\\sqrt{3}}{5} = z_2$。第三个零点 $z_3$ 是实数。该零点集合在复共轭运算下是封闭的，因此得到的 $H(z)$ 多项式将具有实系数。\n\n让我们首先将与复共轭零点对相对应的因子组合起来，以构造该多项式：\n$$\\left(1 - z_1 z^{-1}\\right)\\left(1 - z_2 z^{-1}\\right) = \\left(1 - z_1 z^{-1}\\right)\\left(1 - z_1^* z^{-1}\\right) = 1 - (z_1 + z_1^*)z^{-1} + (z_1 z_1^*)z^{-2}$$\n这个二次因子的系数是实数，符合要求。我们来计算它们：\n$$z_1 + z_1^* = 2\\,\\text{Re}\\{z_1\\} = 2\\left(\\frac{2}{5}\\right) = \\frac{4}{5}$$\n$$z_1 z_1^* = |z_1|^2 = r^2 = \\left(\\frac{4}{5}\\right)^2 = \\frac{16}{25}$$\n因此，该二次因子为 $\\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)$。\n\n现在，我们引入实零点 $z_3 = -\\frac{1}{4}$ 对应的因子：\n$$H(z) = K \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)\\left(1 - z_3 z^{-1}\\right) = K \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)\\left(1 + \\frac{1}{4}z^{-1}\\right)$$\n展开这个乘积：\n$$H(z) = K \\left[ \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right) + \\frac{1}{4}z^{-1}\\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right) \\right]$$\n$$H(z) = K \\left[ 1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2} + \\frac{1}{4}z^{-1} - \\frac{4}{20}z^{-2} + \\frac{16}{100}z^{-3} \\right]$$\n$$H(z) = K \\left[ 1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2} + \\frac{1}{4}z^{-1} - \\frac{1}{5}z^{-2} + \\frac{4}{25}z^{-3} \\right]$$\n按 $z^{-1}$ 的幂次合并同类项：\n$$H(z) = K \\left[ 1 + \\left(-\\frac{4}{5} + \\frac{1}{4}\\right)z^{-1} + \\left(\\frac{16}{25} - \\frac{1}{5}\\right)z^{-2} + \\frac{4}{25}z^{-3} \\right]$$\n系数为：\n$$-\\frac{4}{5} + \\frac{1}{4} = \\frac{-16+5}{20} = -\\frac{11}{20}$$\n$$\\frac{16}{25} - \\frac{1}{5} = \\frac{16-5}{25} = \\frac{11}{25}$$\n所以，系统函数是：\n$$H(z) = K \\left( 1 - \\frac{11}{20}z^{-1} + \\frac{11}{25}z^{-2} + \\frac{4}{25}z^{-3} \\right)$$\n增益 $K$ 由条件 $H(1)=1$ 确定。离散时间频率响应是 $H(e^{j\\omega})$，零频率对应于 $\\omega=0$，这意味着 $z=e^{j0}=1$。\n$$H(1) = K \\left( 1 - \\frac{11}{20}(1)^{-1} + \\frac{11}{25}(1)^{-2} + \\frac{4}{25}(1)^{-3} \\right) = K \\left( 1 - \\frac{11}{20} + \\frac{11}{25} + \\frac{4}{25} \\right)$$\n$$H(1) = K \\left( 1 - \\frac{11}{20} + \\frac{15}{25} \\right) = K \\left( 1 - \\frac{11}{20} + \\frac{3}{5} \\right)$$\n使用公分母 20：\n$$H(1) = K \\left( \\frac{20}{20} - \\frac{11}{20} + \\frac{12}{20} \\right) = K \\left( \\frac{20 - 11 + 12}{20} \\right) = K \\left( \\frac{21}{20} \\right)$$\n给定 $H(1)=1$，我们有 $K \\left( \\frac{21}{20} \\right) = 1$，这意味着 $K = \\frac{20}{21}$。\n\n将 $K$ 代回到 $H(z)$ 的表达式中：\n$$H(z) = \\frac{20}{21} \\left( 1 - \\frac{11}{20}z^{-1} + \\frac{11}{25}z^{-2} + \\frac{4}{25}z^{-3} \\right)$$\n$$H(z) = \\frac{20}{21} - \\frac{20}{21}\\frac{11}{20}z^{-1} + \\frac{20}{21}\\frac{11}{25}z^{-2} + \\frac{20}{21}\\frac{4}{25}z^{-3}$$\n$$H(z) = \\frac{20}{21} - \\frac{11}{21}z^{-1} + \\frac{4 \\cdot 5}{21}\\frac{11}{5 \\cdot 5}z^{-2} + \\frac{4 \\cdot 5}{21}\\frac{4}{5 \\cdot 5}z^{-3}$$\n$$H(z) = \\frac{20}{21} - \\frac{11}{21}z^{-1} + \\frac{44}{105}z^{-2} + \\frac{16}{105}z^{-3}$$\n根据定义 $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$，通过辨识 $H(z)$ 多项式形式中 $z^{-n}$ 各次幂的系数，可以得到冲激响应 $h[n]$。\n通过直接观察：\n$$h[0] = \\frac{20}{21}$$\n$$h[1] = -\\frac{11}{21}$$\n$$h[2] = \\frac{44}{105}$$\n$$h[3] = \\frac{16}{105}$$\n对于所有其他的 $n$，$h[n]=0$。\n\n问题要求 $h[2]$ 的值。这个值是 $\\frac{44}{105}$。\n这是一个精确的有理数形式，没有进行舍入，符合要求。", "answer": "$$\\boxed{\\frac{44}{105}}$$", "id": "2872240"}, {"introduction": "FIR设计的巅峰通常在于创建一个“最优”滤波器，以最佳方式逼近理想的频率响应。Remez交换算法是设计等波纹滤波器的黄金标准，它能在指定的频带上最小化最大误差。本练习通过引导您完成一次完整的解析迭代，揭示了这种强大迭代方法的神秘面纱，您将基于交错定理求解滤波器系数和定义最优性的等波纹误差 $\\delta$。[@problem_id:2872185]", "problem": "考虑一个长度为 $N=5$（4阶）的实系数、线性相位、I型有限冲激响应（FIR）滤波器的设计，其冲激响应具有对称性 $h[n]=h[4-n]$。根据对称性，其频率响应可以写成余弦形式：\n$$\nH(\\omega)=h_{0}+2h_{1}\\cos(\\omega)+2h_{2}\\cos(2\\omega),\n$$\n其中 $h_{0}=h[2]$，$h_{1}=h[1]=h[3]$，以及 $h_{2}=h[0]=h[4]$。期望的响应是分段常数：\n$$\nD(\\omega)=\\begin{cases}\n1,  0\\le \\omega \\le \\frac{\\pi}{3},\\\\\n0,  \\frac{2\\pi}{3}\\le \\omega \\le \\pi,\n\\end{cases}\n$$\n两个频带上的加权函数均为 $W(\\omega)=1$。频率以弧度表示。\n\n从初始极值点集 $\\{\\omega_{0},\\omega_{1},\\omega_{2},\\omega_{3}\\}=\\{0,\\frac{\\pi}{3},\\frac{2\\pi}{3},\\pi\\}$ 开始，实现Remez交换算法的单次迭代，其中误差符号对于 $k=0,1,2,3$ 交替为 $(-1)^{k}$。即，强制执行交替约束条件：\n$$\nE(\\omega_{k}) \\triangleq W(\\omega_{k})\\big(H(\\omega_{k})-D(\\omega_{k})\\big)=(-1)^{k}\\,\\delta,\\quad k\\in\\{0,1,2,3\\},\n$$\n并解析求解 $h_{0}$、$h_{1}$、$h_{2}$ 和波纹幅度 $\\delta$。然后，使用得到的 $H(\\omega)$，通过在每个频带内定位加权误差绝对值的最大点来确定更新后的极值频率，并指出它们是停留在频带边缘还是移动到频带内部。最后，将本次迭代中获得的波纹幅度 $\\delta$ 的值报告为一个精确的数字（无单位）。", "solution": "问题陈述已被解析和验证。该问题具有科学依据，提法得当，客观且自洽。它描述了使用Remez交换算法设计最优等波纹有限冲激响应（FIR）滤波器的标准初始步骤。该问题是有效的。\n\n任务是执行一次Remez交换算法的迭代。我们给定滤波器长度 $N=5$，对应阶数 $M=4$。该滤波器是I型线性相位滤波器，因此其冲激响应 $h[n]$ 是对称的，$h[n]=h[4-n]$，且其长度 $N$ 是奇数。频率响应 $H(\\omega)$ 是 $\\omega$ 的实函数，可以表示为：\n$$\nH(\\omega) = h_0 + 2h_1\\cos(\\omega) + 2h_2\\cos(2\\omega)\n$$\n其中系数为 $h_0=h[2]$、$h_1=h[1]$ 和 $h_2=h[0]$。需要确定3个独立的滤波器系数。\n\n该设计问题遵循交替定理。为了唯一确定3个滤波器系数和波纹幅度 $\\delta$，我们需要至少 $3+1=4$ 个极值频率。问题提供了一组初始的4个极值频率：$\\omega_0=0$, $\\omega_1=\\frac{\\pi}{3}$, $\\omega_2=\\frac{2\\pi}{3}$, 和 $\\omega_3=\\pi$。\n\n核心约束由等波纹条件给出：\n$$\nE(\\omega_k) \\triangleq W(\\omega_k)\\big(H(\\omega_k)-D(\\omega_k)\\big) = (-1)^k \\delta, \\quad k \\in \\{0, 1, 2, 3\\}\n$$\n鉴于处处有 $W(\\omega) = 1$，此式可简化为 $H(\\omega_k) - D(\\omega_k) = (-1)^k \\delta$。我们对四个频率分别展开此式。\n\n对于 $k=0$，$\\omega_0=0$：\n频率 $\\omega_0=0$ 在通带内，因此 $D(0)=1$。\n$H(0) - D(0) = \\delta \\implies (h_0 + 2h_1\\cos(0) + 2h_2\\cos(0)) - 1 = \\delta$\n$h_0 + 2h_1 + 2h_2 - 1 = \\delta \\implies h_0 + 2h_1 + 2h_2 - \\delta = 1 \\quad (1)$\n\n对于 $k=1$，$\\omega_1=\\frac{\\pi}{3}$：\n频率 $\\omega_1=\\frac{\\pi}{3}$ 位于通带边缘，因此 $D(\\frac{\\pi}{3})=1$。\n$H(\\frac{\\pi}{3}) - D(\\frac{\\pi}{3}) = -\\delta \\implies (h_0 + 2h_1\\cos(\\frac{\\pi}{3}) + 2h_2\\cos(\\frac{2\\pi}{3})) - 1 = -\\delta$\n使用 $\\cos(\\frac{\\pi}{3})=\\frac{1}{2}$ 和 $\\cos(\\frac{2\\pi}{3})=-\\frac{1}{2}$，我们得到：\n$h_0 + 2h_1(\\frac{1}{2}) + 2h_2(-\\frac{1}{2}) - 1 = -\\delta \\implies h_0 + h_1 - h_2 + \\delta = 1 \\quad (2)$\n\n对于 $k=2$，$\\omega_2=\\frac{2\\pi}{3}$：\n频率 $\\omega_2=\\frac{2\\pi}{3}$ 位于阻带边缘，因此 $D(\\frac{2\\pi}{3})=0$。\n$H(\\frac{2\\pi}{3}) - D(\\frac{2\\pi}{3}) = \\delta \\implies (h_0 + 2h_1\\cos(\\frac{2\\pi}{3}) + 2h_2\\cos(\\frac{4\\pi}{3})) - 0 = \\delta$\n使用 $\\cos(\\frac{2\\pi}{3})=-\\frac{1}{2}$ 和 $\\cos(\\frac{4\\pi}{3})=-\\frac{1}{2}$，我们得到：\n$h_0 + 2h_1(-\\frac{1}{2}) + 2h_2(-\\frac{1}{2}) = \\delta \\implies h_0 - h_1 - h_2 - \\delta = 0 \\quad (3)$\n\n对于 $k=3$，$\\omega_3=\\pi$：\n频率 $\\omega_3=\\pi$ 在阻带内，因此 $D(\\pi)=0$。\n$H(\\pi) - D(\\pi) = -\\delta \\implies (h_0 + 2h_1\\cos(\\pi) + 2h_2\\cos(2\\pi)) - 0 = -\\delta$\n使用 $\\cos(\\pi)=-1$ 和 $\\cos(2\\pi)=1$，我们得到：\n$h_0 - 2h_1 + 2h_2 = -\\delta \\implies h_0 - 2h_1 + 2h_2 + \\delta = 0 \\quad (4)$\n\n现在我们得到了一个关于四个未知数 $h_0, h_1, h_2, \\delta$ 的四元线性方程组：\n1. $h_0 + 2h_1 + 2h_2 - \\delta = 1$\n2. $h_0 + h_1 - h_2 + \\delta = 1$\n3. $h_0 - h_1 - h_2 - \\delta = 0$\n4. $h_0 - 2h_1 + 2h_2 + \\delta = 0$\n\n为了解这个方程组，我们组合这些方程。\n将方程 $(2)$ 减去 $(3)$：$(h_1 - (-h_1)) + (-h_2 - (-h_2)) + (\\delta - (-\\delta)) = 1-0 \\implies 2h_1 + 2\\delta = 1$。\n将方程 $(1)$ 减去 $(4)$：$(2h_1 - (-2h_1)) + (2h_2 - 2h_2) + (-\\delta - \\delta) = 1-0 \\implies 4h_1 - 2\\delta = 1$。\n\n现在我们有一个关于 $h_1$ 和 $\\delta$ 的二元方程组：\nA. $2h_1 + 2\\delta = 1$\nB. $4h_1 - 2\\delta = 1$\n将 $(A)$ 和 $(B)$ 相加：$6h_1 = 2 \\implies h_1 = \\frac{1}{3}$。\n将 $h_1 = \\frac{1}{3}$ 代入 $(A)$：$2(\\frac{1}{3}) + 2\\delta = 1 \\implies \\frac{2}{3} + 2\\delta = 1 \\implies 2\\delta = \\frac{1}{3} \\implies \\delta = \\frac{1}{6}$。\n\n已知 $h_1 = \\frac{1}{3}$ 和 $\\delta = \\frac{1}{6}$，我们求解 $h_0$ 和 $h_2$。\n从 $(3)$ 式可得：$h_0 = h_1 + h_2 + \\delta = \\frac{1}{3} + h_2 + \\frac{1}{6} = h_2 + \\frac{1}{2}$。\n从 $(4)$ 式可得：$h_0 = 2h_1 - 2h_2 - \\delta = 2(\\frac{1}{3}) - 2h_2 - \\frac{1}{6} = \\frac{2}{3} - 2h_2 - \\frac{1}{6} = \\frac{1}{2} - 2h_2$。\n令两个关于 $h_0$ 的表达式相等：\n$h_2 + \\frac{1}{2} = \\frac{1}{2} - 2h_2 \\implies 3h_2 = 0 \\implies h_2 = 0$。\n最后，将 $h_2=0$ 代入 $h_0$ 的表达式中：$h_0 = 0 + \\frac{1}{2} = \\frac{1}{2}$。\n\n系数和波纹幅度的解为：\n$h_0 = \\frac{1}{2}$，$h_1 = \\frac{1}{3}$，$h_2 = 0$，以及 $\\delta = \\frac{1}{6}$。\n\n得到的频率响应是：\n$$\nH(\\omega) = \\frac{1}{2} + \\frac{2}{3}\\cos(\\omega)\n$$\nRemez算法的下一步是找到加权误差函数 $E(\\omega) = W(\\omega)(H(\\omega)-D(\\omega))$ 的真实极值点。由于 $W(\\omega)=1$，我们分析 $E(\\omega) = H(\\omega)-D(\\omega)$。\n\n在通带 $\\omega \\in [0, \\frac{\\pi}{3}]$ 内，$D(\\omega)=1$：\n$E(\\omega) = (\\frac{1}{2} + \\frac{2}{3}\\cos(\\omega)) - 1 = \\frac{2}{3}\\cos(\\omega) - \\frac{1}{2}$。\n为求局部极值，我们计算导数：$\\frac{dE}{d\\omega} = -\\frac{2}{3}\\sin(\\omega)$。\n在区间 $(0, \\frac{\\pi}{3})$ 内，$\\sin(\\omega) > 0$，因此 $\\frac{dE}{d\\omega} \\ne 0$。所以极值点必定出现在频带边缘 $\\omega=0$ 和 $\\omega=\\frac{\\pi}{3}$ 处。\n$E(0) = \\frac{2}{3} - \\frac{1}{2} = \\frac{1}{6} = \\delta$。\n$E(\\frac{\\pi}{3}) = \\frac{2}{3}(\\frac{1}{2}) - \\frac{1}{2} = -\\frac{1}{6} = -\\delta$。\n\n在阻带 $\\omega \\in [\\frac{2\\pi}{3}, \\pi]$ 内，$D(\\omega)=0$：\n$E(\\omega) = \\frac{1}{2} + \\frac{2}{3}\\cos(\\omega)$。\n导数为 $\\frac{dE}{d\\omega} = -\\frac{2}{3}\\sin(\\omega)$。\n在区间 $(\\frac{2\\pi}{3}, \\pi)$ 内，$\\sin(\\omega) > 0$，因此 $\\frac{dE}{d\\omega} \\ne 0$。所以极值点必定出现在频带边缘 $\\omega=\\frac{2\\pi}{3}$ 和 $\\omega=\\pi$ 处。\n$E(\\frac{2\\pi}{3}) = \\frac{1}{2} + \\frac{2}{3}(-\\frac{1}{2}) = \\frac{1}{6} = \\delta$。\n$E(\\pi) = \\frac{1}{2} + \\frac{2}{3}(-1) = -\\frac{1}{6} = -\\delta$。\n\n最大绝对误差的位置是 $\\{0, \\frac{\\pi}{3}, \\frac{2\\pi}{3}, \\pi\\}$，与初始极值点集相同。算法在单次迭代中收敛。极值频率停留在频带边缘。\n\n从这次迭代中获得的波纹幅度 $\\delta$ 的值为 $\\frac{1}{6}$。", "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$", "id": "2872185"}]}