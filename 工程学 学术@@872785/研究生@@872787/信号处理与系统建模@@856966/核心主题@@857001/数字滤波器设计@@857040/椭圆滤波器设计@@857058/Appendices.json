{"hands_on_practices": [{"introduction": "许多高级数字无限冲激响应（IIR）滤波器的设计是通过变换一个模拟原型滤波器来实现的。这项练习将指导你推导关键的“预畸变”（prewarping）方程，这是确保最终数字滤波器满足其频率指标所必需的。通过从梯形积分法则这一基本原理出发 [@problem_id:2868768]，本练习将强化由双线性变换建立的连续时间域和离散时间域之间的根本联系，这是数字滤波器设计中的一个核心技能。", "problem": "一位工程师寻求设计一个具有椭圆幅度响应的数字低通无限脉冲响应 (IIR) 滤波器，方法是首先设计一个连续时间低通椭圆原型，然后应用双线性变换。该数字滤波器必须具有通带和阻带边缘角频率 $\\omega_{p}$ 和 $\\omega_{s}$ (单位为弧度/样本)，满足 $0  \\omega_{p}  \\omega_{s}  \\pi$，且均匀采样周期为 $T > 0$ 秒。模拟原型将由通带和阻带边缘角频率 $\\Omega_{p}$ 和 $\\Omega_{s}$ (单位为弧度/秒) 指定。\n\n从传递函数为 $H(s)=\\frac{1}{s}$ 的基本连续时间积分器出发，使用梯形法则（也称为 Tustin 方法）获得采样周期为 $T$ 的积分的因果离散时间近似，推导由双线性变换产生的模拟频率 $\\Omega$ (通过 $s=j\\Omega$) 与数字频率 $\\omega$ (通过 $z=\\exp(j\\omega)$) 之间的精确频率映射关系。然后，使用此映射建立模拟边缘频率 $\\Omega_{p}$ 和 $\\Omega_{s}$ 必须满足的精确预畸变关系，以确保经过双线性变换后，数字滤波器满足指定的边缘频率 $\\omega_{p}$ 和 $\\omega_{s}$。\n\n以 $\\Omega_{p}$ 和 $\\Omega_{s}$ 关于 $\\omega_{p}$、$\\omega_{s}$ 和 $T$ 的闭式解析表达式的形式提供您的最终答案。所有角度均以弧度表示。无需进行数值计算，也不允许四舍五入。您的最终答案必须仅包含排列成单行矩阵的两个表达式。", "solution": "问题陈述有效。这是一个数字信号处理领域中适定且有科学依据的问题。它要求从数值积分的第一性原理出发，推导双线性变换的标准频率预畸变方程。我们将开始解答。\n\n任务是推导由双线性变换产生的连续时间频率变量 $\\Omega$ 和离散时间频率变量 $\\omega$ 之间的映射关系，然后利用此映射来找到与指定的数字边缘频率 $\\omega_p$ 和 $\\omega_s$ 相对应的所需模拟原型边缘频率 $\\Omega_p$ 和 $\\Omega_s$。\n\n推导从连续时间积分器开始，其传递函数为 $H(s) = \\frac{1}{s}$。在时域中，假设初始条件为零，这对应于关系式 $y(t) = \\int_{0}^{t} x(\\tau) d\\tau$。该积分的离散时间近似可以通过使用数值积分的梯形法则获得。\n\n考虑在一个采样周期内，从 $t_{n-1} = (n-1)T$ 到 $t_n = nT$ 的积分，我们有：\n$$y(nT) - y((n-1)T) = \\int_{(n-1)T}^{nT} x(\\tau) d\\tau$$\n对右侧的积分应用梯形法则得到：\n$$\\int_{(n-1)T}^{nT} x(\\tau) d\\tau \\approx \\frac{T}{2} [x(nT) + x((n-1)T)]$$\n令 $y[n] = y(nT)$ 和 $x[n] = x(nT)$ 为离散时间序列。得到的差分方程为：\n$$y[n] - y[n-1] = \\frac{T}{2} (x[n] + x[n-1])$$\n为了求出这个离散时间系统的传递函数，我们对差分方程应用 Z 变换，并使用时移性质 $\\mathcal{Z}\\{f[n-k]\\} = z^{-k}F(z)$。\n$$Y(z) - z^{-1}Y(z) = \\frac{T}{2} (X(z) + z^{-1}X(z))$$\n提出公因式 $Y(z)$ 和 $X(z)$：\n$$Y(z)(1 - z^{-1}) = X(z) \\frac{T}{2} (1 + z^{-1})$$\n离散时间积分器的传递函数 $H_d(z)$ 是比值 $\\frac{Y(z)}{X(z)}$：\n$$H_d(z) = \\frac{Y(z)}{X(z)} = \\frac{T}{2} \\frac{1 + z^{-1}}{1 - z^{-1}}$$\n双线性变换由将连续时间传递函数 $H(s)$ 映射到其离散时间近似 $H_d(z)$ 的替换来定义。在本例中，我们将 $H(s) = \\frac{1}{s}$ 与 $H_d(z)$ 等同：\n$$\\frac{1}{s} = \\frac{T}{2} \\frac{1 + z^{-1}}{1 - z^{-1}}$$\n解出 $s$，我们得到双线性变换的表达式：\n$$s = \\frac{2}{T} \\frac{1 - z^{-1}}{1 + z^{-1}} = \\frac{2}{T} \\frac{z - 1}{z + 1}$$\n这个变换将 s 平面上的点映射到 z 平面上。为了找到模拟频率 $\\Omega$ 与数字频率 $\\omega$ 之间的关系，我们在 s 平面的虚轴 $s = j\\Omega$ 和 z 平面的单位圆 $z = \\exp(j\\omega)$ 上评估此变换。注意，问题指定 $\\omega$ 的单位是弧度/样本，并提供了关系式 $z=\\exp(j\\omega)$，因此我们必须与此定义保持一致。\n代入 $s = j\\Omega$ 和 $z = \\exp(j\\omega)$：\n$$j\\Omega = \\frac{2}{T} \\frac{\\exp(j\\omega) - 1}{\\exp(j\\omega) + 1}$$\n为了简化右侧，我们使用恒等式 $\\frac{\\exp(i\\theta)-1}{\\exp(i\\theta)+1} = j\\tan(\\frac{\\theta}{2})$。这可以通过从分子和分母中提出公因式 $\\exp(j\\omega/2)$ 来证明：\n$$\\frac{\\exp(j\\omega) - 1}{\\exp(j\\omega) + 1} = \\frac{\\exp(j\\omega/2)(\\exp(j\\omega/2) - \\exp(-j\\omega/2))}{\\exp(j\\omega/2)(\\exp(j\\omega/2) + \\exp(-j\\omega/2))} = \\frac{2j\\sin(\\omega/2)}{2\\cos(\\omega/2)} = j\\tan\\left(\\frac{\\omega}{2}\\right)$$\n将此代回频率映射方程中：\n$$j\\Omega = \\frac{2}{T} \\left[ j\\tan\\left(\\frac{\\omega}{2}\\right) \\right]$$\n消去公因子 $j$ 得到精确的频率映射关系：\n$$\\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)$$\n这种关系是非线性的，被称为频率畸变。为确保最终数字滤波器的临界频率 $\\omega_p$ 和 $\\omega_s$ 位于正确的位置，模拟原型滤波器的规格 $\\Omega_p$ 和 $\\Omega_s$ 必须使用此映射进行预畸变。\n\n我们将推导出的映射应用于给定的通带和阻带边缘频率。\n对于通带边缘，必须选择模拟频率 $\\Omega_p$，使其映射到所需的数字频率 $\\omega_p$。\n$$\\Omega_p = \\frac{2}{T} \\tan\\left(\\frac{\\omega_p}{2}\\right)$$\n对于阻带边缘，必须选择模拟频率 $\\Omega_s$，使其映射到所需的数字频率 $\\omega_s$。\n$$\\Omega_s = \\frac{2}{T} \\tan\\left(\\frac{\\omega_s}{2}\\right)$$\n这些就是所需的预畸变关系。最终答案将以指定格式呈现这两个表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{T} \\tan\\left(\\frac{\\omega_{p}}{2}\\right)  \\frac{2}{T} \\tan\\left(\\frac{\\omega_{s}}{2}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2868768"}, {"introduction": "一个滤波器的理论设计只是故事的一部分，其能否成功实现很大程度上取决于其系统极点的特性。这项练习聚焦于极点品质因数 $Q$ [@problem_id:2868799]，这是一个评估滤波器稳定性及其对元件值误差或系数（量化）敏感度的关键指标。通过计算和分析 $Q$ 值，你将更深入地理解决定滤波器实际性能的内在权衡。", "problem": "一个阶数 $N = 6$ 的模拟归一化低通椭圆（高尔）原型由通带波纹因子 $\\varepsilon = 0.25$ 和椭圆模数 $k = 0.65$ 指定。该原型通过标准的椭圆有理函数构造法合成，在开左半平面产生三对复共轭极点（每对包含两个实部和一个虚部）。数值计算出的极点位置（归一化弧度频率）报告如下：\n- 对于 $m = 1$：$s_{1,2} = -0.2124 \\pm \\jmath\\, 1.1010$。\n- 对于 $m = 2$：$s_{3,4} = -0.7825 \\pm \\jmath\\, 0.9132$。\n- 对于 $m = 3$：$s_{5,6} = -1.2480 \\pm \\jmath\\, 0.4598$。\n\n假设每对复共轭极点定义了一个线性时不变（LTI）系统的二阶节，且该节处于通常的规范形式。从二阶节的基本定义出发，推导出一个极点对的品质因数 $Q_m$ 关于其实部和虚部的显式符号表达式，然后计算给定 $m=2$ 极点对的 $Q_2$。此外，从椭圆滤波器合成的第一性原理和极小极大（等波纹）特性出发，定性地论证 $Q_m$ 预期如何随节索引 $m$、通带波纹因子 $\\varepsilon$ 和椭圆模数 $k$ 变化。\n\n报告 $Q_2$ 的数值，四舍五入到四位有效数字。品质因数是无量纲的，所以报告时无需单位。最终答案必须是单个数字。", "solution": "我们从与连续时间（CT）线性时不变（LTI）系统的复共轭极点对相关联的标准二阶实系数因子开始。如果一个节的极点位于\n$$\ns = -\\sigma \\pm \\jmath\\,\\omega,\n$$\n其中 $\\sigma > 0$ 且 $\\omega > 0$，那么对应的首一二次分母为\n$$\nD(s) \\;=\\; \\left(s - \\left(-\\sigma + \\jmath\\,\\omega\\right)\\right)\\left(s - \\left(-\\sigma - \\jmath\\,\\omega\\right)\\right) \\;=\\; s^{2} + 2\\sigma\\,s + \\left(\\sigma^{2} + \\omega^{2}\\right).\n$$\n根据定义，规范二阶形式为\n$$\nD(s) \\;=\\; s^{2} + \\frac{\\omega_{n}}{Q}\\,s + \\omega_{n}^{2},\n$$\n其中 $\\omega_{n} > 0$ 是自然（无阻尼）弧度频率，而 $Q > 0$ 是品质因数。对两个表达式进行系数匹配，得到\n$$\n\\omega_{n}^{2} \\;=\\; \\sigma^{2} + \\omega^{2}, \n\\qquad\n\\frac{\\omega_{n}}{Q} \\;=\\; 2\\sigma.\n$$\n求解 $Q$ 可得基本关系式\n$$\nQ \\;=\\; \\frac{\\omega_{n}}{2\\sigma} \\;=\\; \\frac{\\sqrt{\\sigma^{2} + \\omega^{2}}}{2\\sigma}.\n$$\n因此，对于第 $m$ 个节，其极点对为 $s = -\\sigma_{m} \\pm \\jmath\\,\\omega_{m}$，品质因数为\n$$\nQ_{m} \\;=\\; \\frac{\\sqrt{\\sigma_{m}^{2} + \\omega_{m}^{2}}}{2\\sigma_{m}}.\n$$\n\n我们现在使用提供的 $m=2$ 的极点对来计算 $Q_{2}$：\n$$\n-\\sigma_{2} \\pm \\jmath\\,\\omega_{2} \\;=\\; -0.7825 \\pm \\jmath\\,0.9132,\n$$\n所以 $\\sigma_{2} = 0.7825$ 且 $\\omega_{2} = 0.9132$。计算自然频率：\n$$\n\\omega_{n,2} \\;=\\; \\sqrt{\\sigma_{2}^{2} + \\omega_{2}^{2}} \\;=\\; \\sqrt{(0.7825)^{2} + (0.9132)^{2}} \n\\;=\\; \\sqrt{0.61230625 + 0.83393424}\n\\;=\\; \\sqrt{1.44624049}.\n$$\n计算平方根，\n$$\n\\omega_{n,2} \\;\\approx\\; 1.20259573.\n$$\n然后\n$$\nQ_{2} \\;=\\; \\frac{\\omega_{n,2}}{2\\sigma_{2}} \\;=\\; \\frac{1.20259573}{2 \\times 0.7825} \\;=\\; \\frac{1.20259573}{1.565} \\;\\approx\\; 0.768432\\ldots\n$$\n四舍五入到四位有效数字，\n$$\nQ_{2} \\;\\approx\\; 0.7684.\n$$\n\n在椭圆低通原型中，$Q_{m}$ 对 $m$、$\\varepsilon$ 和 $k$ 的定性依赖关系：\n- 对 $m$ 的依赖性：一个 $N$ 阶椭圆原型的极点对由一个参数序列 $u_{m} = \\frac{(2m-1)}{2N}K(k)$ 参数化，其中 $m = 1,2,\\dots,N/2$，$K(k)$ 是第一类完全椭圆积分，$k$ 是椭圆模数。通过雅可比椭圆函数从 $u$ 平面到 $s$ 平面的共形映射将极点置于左半平面的一个轨迹上。随着 $m$ 增加，$u_{m}$ 在 $(0, K(k))$ 上增加，而雅可比椭圆函数 $\\operatorname{sn}(\\cdot,k)$、$\\operatorname{cn}(\\cdot,k)$ 和 $\\operatorname{dn}(\\cdot,k)$ 在该区间上的单调行为通常会使 $\\sigma_{m}$ 相对于 $\\omega_{m}$ 增加。因此，$Q_{m} = \\sqrt{\\sigma_{m}^{2} + \\omega_{m}^{2}}/(2\\sigma_{m})$ 通常随 $m$ 减小，因为极点离虚轴更远（$\\sigma_{m}$ 更大）且虚部通常更小。尽管对于特定的 $(\\varepsilon,k)$ 可能会出现轻微的非单调性，但趋势是靠近通带边缘的第一个（或前几个）节具有最大的 $Q_{m}$。\n- 对 $\\varepsilon$ 的依赖性：通带波纹因子 $\\varepsilon$ 设定了通带中的等波纹幅度，改变了雅可比参数中的矩形域与 $s$ 平面之间的共形预畸变。较大的 $\\varepsilon$ 允许更大的通带变化，并驱使至少前几个极点对更靠近虚轴，以提高通带边缘附近的选择性，从而减小 $\\sigma_{m}$ 并增加 $Q_{m} = \\sqrt{\\sigma_{m}^{2} + \\omega_{m}^{2}}/(2\\sigma_{m})$。因此，对于固定的 $k$ 和 $N$，增加 $\\varepsilon$ 倾向于增加 $Q_{m}$，这在 $m$ 较小时最为显著。\n- 对 $k$ 的依赖性：椭圆模数 $k$ 通过完全椭圆积分控制通带和阻带极值点的间距。当 $k \\to 0$ 时，椭圆原型趋近于切比雪夫I型情况，$u$ 映射近似于三角函数，$Q_{m}$ 随 $m$ 的下降更为平滑。当 $k \\to 1$ 时，雅可比椭圆函数趋近于双曲极限，将传输零点置于更靠近通带边缘的位置，并使某些极点更靠近虚轴聚集。这通常会增加与通带边缘相关的极点对的 $Q_{m}$ 值（$m$ 较小），并可能轻微减小更深的节的 $Q_{m}$，反映了更陡峭的过渡带。因此，增加 $k$ 倾向于增加最大的 $Q_{m}$ 值并加剧不同 $m$ 之间的差异。\n\n这些定性趋势与幅度平方响应 $|H(\\jmath\\Omega)|^{2} = \\left(1 + \\varepsilon^{2} R_{N}^{2}(\\Omega,k)\\right)^{-1}$ 中椭圆有理函数 $R_{N}(\\cdot,k)$ 的极小极大特性以及控制极零点布局的雅可比椭圆函数的共形映射性质是一致的。", "answer": "$$\\boxed{0.7684}$$", "id": "2868799"}]}