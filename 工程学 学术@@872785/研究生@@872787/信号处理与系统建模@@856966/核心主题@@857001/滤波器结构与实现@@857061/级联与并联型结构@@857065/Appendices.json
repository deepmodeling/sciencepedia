{"hands_on_practices": [{"introduction": "并联结构的一个核心思想是将一个复杂的系统分解为多个更简单的子系统之和。这个练习将通过一个离散时间系统的脉冲响应，直观地展示如何将系统分解为两个一阶子系统的并联组合，从而将时域中的加法与系统框图中的并联连接直接对应起来。[@problem_id:1701264]", "problem": "一个离散时间线性时不变 (LTI) 系统由其冲激响应来表征，其表达式为：\n$$h[n] = (0.5)^{n} u[n] + (-0.5)^{n} u[n]$$\n其中 $u[n]$ 是因果单位阶跃函数，定义为当 $n \\ge 0$ 时 $u[n] = 1$，当 $n  0$ 时 $u[n] = 0$。\n\n该系统将使用一个由两个稳定的一阶子系统组成的并联结构来实现。总传递函数 $H(z)$ 是这两个子系统传递函数之和，$H(z) = H_1(z) + H_2(z)$。每个一阶子系统 $k \\in \\{1, 2\\}$ 的传递函数定义为：\n$$H_k(z) = \\frac{b_k}{1 - a_k z^{-1}}$$\n其中 $a_k$ 和 $b_k$ 是实值系数。\n\n为确保解的唯一性，系数按 $a_1 > a_2$ 的顺序排列。确定实现该给定系统的系数 $a_1, b_1, a_2, b_2$ 的值。将你的四个答案按 $\\begin{pmatrix} a_1  b_1  a_2  b_2 \\end{pmatrix}$ 的顺序表示为单行矩阵。", "solution": "给定的冲激响应为\n$$\nh[n] = \\left(\\frac{1}{2}\\right)^{n} u[n] + \\left(-\\frac{1}{2}\\right)^{n} u[n]\n$$\n对于一个传递函数为\n$$\nH_{k}(z) = \\frac{b_{k}}{1 - a_{k} z^{-1}}\n$$\n的一阶子系统，其对应的冲激响应通过 Z 反变换得到。使用标准变换对 $\\mathcal{Z}\\{a^{n} u[n]\\} = \\frac{1}{1 - a z^{-1}}$（对于 $|z| > |a|$），我们得到\n$$\nh_{k}[n] = b_{k} a_{k}^{n} u[n]\n$$\n由于整个系统是两个此类子系统的并联和，总冲激响应必须满足\n$$\nh[n] = h_{1}[n] + h_{2}[n] = b_{1} a_{1}^{n} u[n] + b_{2} a_{2}^{n} u[n]\n$$\n与给定的 $h[n]$ 进行比较，两个不同的指数项直接对应于\n$$\na_{1} = \\frac{1}{2}, \\quad b_{1} = 1, \\quad a_{2} = -\\frac{1}{2}, \\quad b_{2} = 1\n$$\n这也满足排序约束 $a_{1} > a_{2}$，因为 $\\frac{1}{2} > -\\frac{1}{2}$。作为在 z 域中的一致性检验，\n$$\nH(z) = \\mathcal{Z}\\{h[n]\\} = \\frac{1}{1 - \\frac{1}{2} z^{-1}} + \\frac{1}{1 + \\frac{1}{2} z^{-1}} = \\frac{b_{1}}{1 - a_{1} z^{-1}} + \\frac{b_{2}}{1 - a_{2} z^{-1}}\n$$\n确认了所识别的系数。两个子系统都是稳定的，因为 $|a_{1}|  1$ 且 $|a_{2}|  1$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  1  -\\frac{1}{2}  1 \\end{pmatrix}}$$", "id": "1701264"}, {"introduction": "当系统的传递函数包含重极点时，并联分解会变得更加复杂。本练习探讨了这种情况，要求对一个具有三阶重极点的连续时间系统进行部分分式展开，并解释展开式中的每一项如何对应于并联实现中的一个分支，这有助于深入理解重极点在系统结构中的物理意义。[@problem_id:2856865]", "problem": "一个在 Laplace 域中具有传递函数的线性时不变 (LTI) 单输入单输出系统由有理函数 $H(s)$ 定义。并联形式结构将 $H(s)$ 表示为并联连接的子系统传递函数之和，当极点为重极点时，部分分式展开会包含与这些重极点相关的高阶项。考虑传递函数\n$$\nH(s) = \\frac{2s+3}{(s+1)^{3}}.\n$$\n从 Laplace 变换的基本定义、传递函数定义为 $H(s)=Y(s)/X(s)$ 的概念，以及任何真有理传递函数都可以通过部分分式展开表示为更简单有理函数之和的原理出发，执行以下操作：\n- 推导 $H(s)$ 的部分分式展开式，该展开式明确地包含了在 $s=-1$ 处的重极点及其重数。\n- 论证此展开式中的每一项如何对应于由一阶构建模块构成的并联形式实现中的一个分支，并基于 LTI 系统分解的第一性原理，解释重极点在此映射中的作用。\n\n你的最终答案必须是 $H(s)$ 的明确部分分式展开式，以单个封闭形式的解析表达式表示。无需进行数值四舍五入。不要包含单位。", "solution": "核心原理是将一个复杂系统分解为一组更简单的子系统。对于一个由真有理传递函数 $H(s)$ 描述的 LTI 系统，这种分解是通过部分分式展开来实现的。所得到的结构，即总输出是由相同输入驱动的各子系统输出之和，被称为并联形式实现。传递函数如下：\n$$\nH(s) = \\frac{2s+3}{(s+1)^{3}}\n$$\n该函数在 $s = -1$ 处有一个重数为 $m=3$ 的极点。对于在 $s=p$ 处重数为 $m$ 的极点，其部分分式展开必须包含从 $k=1$ 到 $k=m$ 的所有 $(s-p)^{-k}$ 次幂项。因此，给定 $H(s)$ 的展开式必须具有以下形式：\n$$\nH(s) = \\frac{A_1}{s+1} + \\frac{A_2}{(s+1)^2} + \\frac{A_3}{(s+1)^3}\n$$\n对于重数为 $m$ 的重极点 $s=p$，系数 $A_k$ 由以下通用公式确定：\n$$\nA_{m-k} = \\frac{1}{k!} \\frac{d^k}{ds^k} \\left[ (s-p)^m H(s) \\right] \\bigg|_{s=p}\n$$\n在这个具体问题中，$p=-1$ 且 $m=3$。我们定义函数 $\\Phi(s)$ 如下：\n$$\n\\Phi(s) = (s+1)^3 H(s) = (s+1)^3 \\left( \\frac{2s+3}{(s+1)^3} \\right) = 2s+3\n$$\n现在我们可以计算系数 $A_3$、$A_2$ 和 $A_1$。\n\n对于 $A_3$，我们设 $k=0$（对应于公式中的 $m-k=3$）：\n$$\nA_3 = \\frac{1}{0!} \\frac{d^0}{ds^0} [\\Phi(s)] \\bigg|_{s=-1} = \\Phi(s) \\bigg|_{s=-1} = (2s+3) \\bigg|_{s=-1} = 2(-1) + 3 = 1\n$$\n对于 $A_2$，我们设 $k=1$（对应于公式中的 $m-k=2$）：\n$$\nA_2 = \\frac{1}{1!} \\frac{d}{ds} [\\Phi(s)] \\bigg|_{s=-1} = \\frac{d}{ds} (2s+3) \\bigg|_{s=-1} = 2 \\bigg|_{s=-1} = 2\n$$\n对于 $A_1$，我们设 $k=2$（对应于公式中的 $m-k=1$）：\n$$\nA_1 = \\frac{1}{2!} \\frac{d^2}{ds^2} [\\Phi(s)] \\bigg|_{s=-1} = \\frac{1}{2} \\frac{d^2}{ds^2} (2s+3) \\bigg|_{s=-1} = \\frac{1}{2} \\frac{d}{ds}(2) \\bigg|_{s=-1} = \\frac{1}{2}(0) = 0\n$$\n将这些系数代回展开式，得到 $H(s)$ 的完整部分分式形式：\n$$\nH(s) = \\frac{0}{s+1} + \\frac{2}{(s+1)^2} + \\frac{1}{(s+1)^3}\n$$\n这个表达式是明确的展开式，它考虑了重数为 $3$ 的重极点。\n\n现在，我们基于第一性原理来论证并联形式实现。传递函数 $H(s)$ 通过关系式 $Y(s) = H(s)X(s)$ 将经过 Laplace 变换的输出 $Y(s)$ 与输入 $X(s)$ 联系起来。使用我们推导出的展开式：\n$$\nY(s) = \\left( \\frac{0}{s+1} + \\frac{2}{(s+1)^2} + \\frac{1}{(s+1)^3} \\right) X(s)\n$$\n根据线性性质，这等价于：\n$$\nY(s) = \\left(\\frac{0}{s+1}\\right)X(s) + \\left(\\frac{2}{(s+1)^2}\\right)X(s) + \\left(\\frac{1}{(s+1)^3}\\right)X(s)\n$$\n我们定义子系统传递函数 $H_1(s)$、$H_2(s)$ 和 $H_3(s)$ 为展开式中的各个项：\n$$\nH_1(s) = \\frac{0}{s+1}, \\quad H_2(s) = \\frac{2}{(s+1)^2}, \\quad H_3(s) = \\frac{1}{(s+1)^3}\n$$\n总系统传递函数是各项之和 $H(s) = H_1(s) + H_2(s) + H_3(s)$。相应地，总输出是每个子系统在共同输入 $X(s)$ 驱动下各自输出的总和：\n$$\nY(s) = Y_1(s) + Y_2(s) + Y_3(s), \\quad \\text{其中 } Y_k(s) = H_k(s)X(s)\n$$\n这种结构，即单个输入驱动多个子系统，并且它们的输出被求和，正是并联形式实现的定义。\n\n重极点的作用对于定义这些并联分支的性质至关重要。\n- 对于在 $s=p$ 处的简单、非重极点，对应的分支是一个传递函数为 $\\frac{A}{s-p}$ 的一阶系统。\n- 对于重极点，会出现形如 $\\frac{A}{(s-p)^k}$ (其中 $k>1$) 的项。传递函数为 $H_k(s) = \\frac{1}{(s-p)^k}$ 的子系统不是一个一阶系统。相反，它等效于 $k$ 个相同的一阶系统级联而成，每个系统的传递函数为 $\\frac{1}{s-p}$。这从以下关系中可以明显看出：\n$$\n\\frac{1}{(s-p)^k} = \\left(\\frac{1}{s-p}\\right) \\times \\left(\\frac{1}{s-p}\\right) \\times \\cdots \\times \\left(\\frac{1}{s-p}\\right) \\quad (k \\text{ times})\n$$\n在我们的例子中，并联分支是：\n1. $H_1(s) = \\frac{0}{s+1}$：一个增益为零的一阶系统，对输出没有贡献。\n2. $H_2(s) = \\frac{2}{(s+1)^2}$：一个子系统，等效于两个一阶构建模块 $\\frac{1}{s+1}$ 的级联，再乘以一个为 $2$ 的增益。\n3. $H_3(s) = \\frac{1}{(s+1)^3}$：一个子系统，等效于三个一阶构建模块 $\\frac{1}{s+1}$ 的级联。\n\n因此，重数为 $m$ 的重极点的存在，要求包含 $m$ 个并联分支，其中每个分支 $k$ (对于 $k=1, \\dots, m$) 本身是与该极点位置相关的 $k$ 个基本一阶积分器的级联，并由系数 $A_k$ 进行缩放。这展示了重极点的部分分式展开的代数结构如何直接映射到一个由级联一阶元件的并联组合构成的物理或框图实现。", "answer": "$$\n\\boxed{\\frac{0}{s+1} + \\frac{2}{(s+1)^{2}} + \\frac{1}{(s+1)^{3}}}\n$$", "id": "2856865"}, {"introduction": "在数字滤波器设计中，级联结构因其在数值稳定性方面的优势而被广泛应用。这个实际的设计问题将引导你处理一个关键的工程挑战：在定点运算中防止内部信号溢出。通过为级联的每个二阶节设计缩放因子，你将亲身体验如何管理动态范围，以确保滤波器的稳健运行。[@problem_id:2856870]", "problem": "考虑一个离散时间线性时不变（LTI）数字滤波器，它以直接II型转置结构级联了三个二阶节（biquad）实现。设输入信号的幅度有界，为 $|x[n]| \\leq X_{\\max}$，其中 $X_{\\max} = 0.2$（以归一化满量程单位计），满量程饱和发生在幅度为 $1$ 时。对于每个 biquad $k \\in \\{1, 2, 3\\}$，给定两个诱导$\\ell_{\\infty}$-范数（也称为 $H_{\\infty}$ 范数）：\n- $\\beta_k$，该节的最坏情况下输入到输出的增益界，\n- $\\alpha_k$，该节的最坏情况下输入到最大内部状态的增益界，\n因此对于任意有界输入幅度 $U$，该节的输出幅度有界于 $\\beta_k U$，而节内部的最大内部状态幅度有界于 $\\alpha_k U$。\n\n各节的参数如下：\n- 第 $1$ 节：$\\alpha_1 = 2.7$，$\\beta_1 = 1.6$，\n- 第 $2$ 节：$\\alpha_2 = 1.8$，$\\beta_2 = 1.2$，\n- 第 $3$ 节：$\\alpha_3 = 3.0$，$\\beta_3 = 0.9$。\n\n允许在每节 $k$ 的前后插入对称的2的幂次缩放：在节的输入端乘以一个前置缩放因子 $c_k = 2^{m_k}$ ($m_k \\in \\mathbb{Z}$)，在节的输出端乘以一个后置缩放因子 $1/c_k$。这样做可以保持总体的端到端传递函数幅度不变，但会改变节内的内部状态幅度。字长设定要求任何内部节点（包括所有级间连接点和内部状态）的幅度必须严格小于满量程幅度 $1$，以避免溢出。\n\n请设计每节的缩放因子 $c_k$ 以防止所有内部节点发生溢出。然后，在你的设计下，假设输入界为 $|x[n]| \\leq 0.2$，确定整个级联结构中任何内部节点（包括级间连接点和内部状态）所能达到的最大最坏情况幅度。将你的最终答案四舍五入到四位有效数字，并以归一化满量程单位表示（不带单位符号）。", "solution": "设离散时间 LTI 系统是 $N=3$ 个二阶节的级联。设 $u_k[n]$ 是第 $k$ 个缩放节的输入（$k \\in \\{1, 2, 3\\}$），$y_k[n]$ 是其输出。整个滤波器的输入是 $x[n]$，因此 $u_1[n] = x[n]$。各节是级联的，所以 $u_{k+1}[n] = y_k[n]$。输入信号幅度有界，为 $|x[n]| \\le X_{\\max}$，其中 $X_{\\max} = 0.2$。设 $U_k$ 为第 $k$ 个缩放节输入处的最坏情况幅度（信号的$\\ell_{\\infty}$-范数），即 $U_k = \\sup_{n} |u_k[n]|$。因此，$U_1 = X_{\\max} = 0.2$。\n\n在每个缩放节 $k$ 内部，输入信号 $u_k[n]$ 首先乘以一个缩放因子 $c_k = 2^{m_k}$，其中 $m_k \\in \\mathbb{Z}$。因此，biquad 本身的输入是 $c_k u_k[n]$。问题为每个 biquad 提供了两个增益参数：\n1. $\\alpha_k$：从 biquad 输入到其最大内部状态幅度的最坏情况增益。\n2. $\\beta_k$：从 biquad 输入到其输出的最坏情况增益。\n\nbiquad $k$ 中内部状态的最坏情况幅度（记为 $S_k$）受限于 biquad 输入的幅度乘以 $\\alpha_k$。\n$$\nS_k = \\alpha_k \\sup_{n} |c_k u_k[n]| = \\alpha_k c_k U_k\n$$\nbiquad 输出的最坏情况幅度是 $\\beta_k c_k U_k$。该信号随后被缩放 $1/c_k$ 以产生缩放节的输出 $y_k[n]$。因此，$y_k[n]$ 的最坏情况幅度为：\n$$\nU_{k+1} = \\sup_{n} |y_k[n]| = \\frac{1}{c_k} (\\beta_k c_k U_k) = \\beta_k U_k\n$$\n这为级间连接点处的最坏情况幅度建立了一个递推关系。使用给定的值 $\\beta_1 = 1.6$，$\\beta_2 = 1.2$ 和 $\\beta_3 = 0.9$：\n$$\nU_1 = X_{\\max} = 0.2\n$$\n$$\nU_2 = \\beta_1 U_1 = 1.6 \\times 0.2 = 0.32\n$$\n$$\nU_3 = \\beta_2 U_2 = 1.2 \\times 0.32 = 0.384\n$$\n$$\nU_4 = \\beta_3 U_3 = 0.9 \\times 0.384 = 0.3456\n$$\n$U_4$ 是最终输出信号的最坏情况幅度。滤波器的内部节点包括每个 biquad 内的内部状态和级间连接点。为防止溢出，每个内部节点的幅度必须严格小于 $1$。\n\n约束条件是：\n1. 对于内部状态：$S_k  1 \\implies \\alpha_k c_k U_k  1$，对于 $k \\in \\{1, 2, 3\\}$。\n2. 对于级间连接点：$U_k  1$，对于 $k \\in \\{2, 3, 4\\}$。\n\n级间连接点的幅度为 $U_2=0.32$、$U_3=0.384$ 和 $U_4=0.3456$。它们都小于 $1$，因此无论如何缩放，这些节点都不会发生溢出。\n\n我们必须选择缩放因子 $c_k$ 以满足内部状态的约束。对每个 $c_k$ 的最优选择是满足不等式的最大2的幂，因为这能最大化利用可用的动态范围。对每个 $c_k$ 的约束是：\n$$\nc_k  \\frac{1}{\\alpha_k U_k}\n$$\n\n对于第 $k=1$ 节：\n已知 $\\alpha_1 = 2.7$。\n$$\nc_1  \\frac{1}{\\alpha_1 U_1} = \\frac{1}{2.7 \\times 0.2} = \\frac{1}{0.54} \\approx 1.85185\n$$\n小于 $1.85185$ 的最大2的幂 $2^{m_1}$ 是 $2^0 = 1$。所以，我们选择 $c_1 = 1$。\n\n对于第 $k=2$ 节：\n已知 $\\alpha_2 = 1.8$。\n$$\nc_2  \\frac{1}{\\alpha_2 U_2} = \\frac{1}{1.8 \\times 0.32} = \\frac{1}{0.576} \\approx 1.73611\n$$\n小于 $1.73611$ 的最大2的幂 $2^{m_2}$ 是 $2^0 = 1$。所以，我们选择 $c_2 = 1$。\n\n对于第 $k=3$ 节：\n已知 $\\alpha_3 = 3.0$。\n$$\nc_3  \\frac{1}{\\alpha_3 U_3} = \\frac{1}{3.0 \\times 0.384} = \\frac{1}{1.152} \\approx 0.86805\n$$\n小于 $0.86805$ 的最大2的幂 $2^{m_3}$ 是 $2^{-1} = 0.5$。所以，我们选择 $c_3 = 0.5$。\n\n使用缩放因子 $c_1 = 1$、$c_2 = 1$ 和 $c_3 = 0.5$，我们现在确定所有内部节点的最大最坏情况幅度。我们必须计算所有的 $S_k$ 和 $U_k$（对于 $k>1$）。\n最坏情况幅度如下：\n- 第 $1$ 节的内部状态：$S_1 = \\alpha_1 c_1 U_1 = 2.7 \\times 1 \\times 0.2 = 0.54$。\n- 第 $1$ 节后的级间连接点：$U_2 = 0.32$。\n- 第 $2$ 节的内部状态：$S_2 = \\alpha_2 c_2 U_2 = 1.8 \\times 1 \\times 0.32 = 0.576$。\n- 第 $2$ 节后的级间连接点：$U_3 = 0.384$。\n- 第 $3$ 节的内部状态：$S_3 = \\alpha_3 c_3 U_3 = 3.0 \\times 0.5 \\times 0.384 = 1.5 \\times 0.384 = 0.576$。\n- 最终输出节点：$U_4 = 0.3456$。\n\n我们必须找到这些值的最大值：\n$$\n\\max\\{S_1, U_2, S_2, U_3, S_3, U_4\\} = \\max\\{0.54, 0.32, 0.576, 0.384, 0.576, 0.3456\\} = 0.576\n$$\n任何内部节点达到的最大最坏情况幅度是 $0.576$。问题要求将最终答案四舍五入到四位有效数字，得到 $0.5760$。", "answer": "$$\n\\boxed{0.5760}\n$$", "id": "2856870"}]}