## 引言
在信号处理与[系统建模](@entry_id:197208)领域，级联与并联结构是构建和分析复杂系统的两种基本模式，如同用基本积木搭建宏伟建筑。无论是设计一个手机中的通信滤波器，还是模拟一个生态系统中的食物链，这两种结构都提供了强大而简洁的分析框架。然而，高阶系统的直接实现，尤其是在数字硬件中，常常会遭遇严重的数值敏感性问题，微小的系数误差就可能导致系统性能的灾难性下降甚至不稳定。级联与并联分解正是为了应对这一挑战而生的模块化解决方案，它能显著提高系统的鲁棒性和[可实现性](@entry_id:193701)。

本文将引导读者系统地掌握这一核心概念，从理论深度到实践广度。
- 在**“原理与机制”**一章中，我们将深入探讨级联与并联的数学基础，从时域卷积到变换域乘积，并揭示在[数字滤波器实现](@entry_id:265869)中，如[状态空间表示](@entry_id:147149)、系数量化和[有限字长效应](@entry_id:201338)等高级主题背后的精妙之处。
- 随后的**“应用与跨学科联系”**一章将视野拓宽，展示这些结构不仅是滤波器设计的基石，更在[多速率系统](@entry_id:264982)、[并行计算](@entry_id:139241)乃至生物[基因调控网络](@entry_id:150976)中扮演着关键角色，彰显其普适的科学与工程价值。
- 最后，**“动手实践”**部分将通过精心设计的计算与设计问题，让您亲手应用所学知识，解决滤波器缩放等实际工程挑战，从而将理论真正内化为技能。

## 原理与机制

在信号处理与[系统建模](@entry_id:197208)领域，复杂系统通常通过组合更简单的子系统来构建。这种模块化方法不仅简化了设计和分析过程，而且在物理实现中也至关重要。两种最基本的互连方案是**级联（cascade）**和**并联（parallel）**结构。本章将深入探讨这些结构的基本原理、数学描述，以及在实际系统（特别是[数字滤波器](@entry_id:181052)）实现中所面临的高级挑战和精妙之处。

### 级联与并联连接的基本原理

#### 级联连接

在**级联结构**中，信号按顺序流经一系列子系统：一个子系统的输出成为下一个子系统的输入。假设有两个[线性时不变](@entry_id:276287)（LTI）系统，其脉冲响应分别为 $h_1[n]$ 和 $h_2[n]$。如果输入信号 $x[n]$ 首先通过第一个系统，生成中间信号 $w[n] = (x * h_1)[n]$，然后 $w[n]$ 再作为第二个系统的输入，则最终输出 $y[n]$ 为 $y[n] = (w * h_2)[n]$。这里的 $*$ 代表卷积运算。

利用卷积的结合律，我们可以将这个过程表示为：
$y[n] = ((x * h_1) * h_2)[n] = (x * (h_1 * h_2))[n]$

这意味着整个级联系统的等效脉冲响应 **$h_{\text{cas}}[n]$** 就是各个子[系统脉冲响应](@entry_id:260864)的卷积：
$$h_{\text{cas}}[n] = h_1[n] * h_2[n]$$

在变换域中，这一关系变得更为简洁。根据卷积定理，时域的卷积对应于[频域](@entry_id:160070)或变换域的乘法。因此，整个级联系统的[传递函数](@entry_id:273897) **$H_{\text{cas}}(z)$** 或 **$H_{\text{cas}}(s)$** 是各个子系统[传递函数](@entry_id:273897)的乘积：
$$H_{\text{cas}}(z) = H_1(z) H_2(z) \quad \text{(离散时间系统)}$$
$$H_{\text{cas}}(s) = H_1(s) H_2(s) \quad \text{(连续时间系统)}$$

一个核心且重要的特性是**交换性（commutativity）**。由于标量函[数乘](@entry_id:155971)法和卷积运算都满足[交换律](@entry_id:141214)，即 $H_1(z)H_2(z) = H_2(z)H_1(z)$ 和 $h_1[n]*h_2[n] = h_2[n]*h_1[n]$，所以在理想的 LTI 系统模型中，级联子系统的顺序可以任意调换，而不会改变最终的输入-输出关系 [@problem_id:2856967]。例如，考虑一个由脉冲响应为 $h_1[n] = (\frac{1}{2})^n u[n]$ 和 $h_2[n] = \delta[n] - \delta[n-2]$ 的两个 LTI 系统组成的级联系统。无论输入信号是先通过 $h_1[n]$ 再通过 $h_2[n]$，还是反过来，其最终输出是完全相同的。计算特定输入（如单位阶跃 $u[n]$）在特定时刻（如 $n=4$）的输出值时，我们可以先计算总的脉冲响应 $h_{\text{cas}}[n] = h_1[n] * h_2[n]$，再与输入进行卷积，或者按顺序依次进行两次卷积，结果都将一致 [@problem_id:1701246]。

#### 并联连接

在**并联结构**中，同一个输入信号 $x[n]$ 或 $x(t)$ 被同时馈送到所有子系统，而最终的输出 $y[n]$ 或 $y(t)$ 是所有子系统输出的总和。

对于并联的 LTI 系统，其[叠加特性](@entry_id:267392)使得分析非常直观。总输出是各个子系统输出的简单相加。因此，整个并联系统的等效脉冲响应 **$h_{\text{par}}$** 是各个子[系统脉冲响应](@entry_id:260864)的**和**：
$$h_{\text{par}}[n] = h_1[n] + h_2[n] \quad \text{(离散时间系统)}$$
$$h_{\text{par}}(t) = h_1(t) + h_2(t) \quad \text{(连续时间系统)}$$

相应地，在变换域中，整体[传递函数](@entry_id:273897) **$H_{\text{par}}(z)$** 或 **$H_{\text{par}}(s)$** 也是各个子系统[传递函数](@entry_id:273897)的**和**：
$$H_{\text{par}}(z) = H_1(z) + H_2(z)$$
$$H_{\text{par}}(s) = H_1(s) + H_2(s)$$

例如，考虑一个由两个连续时间 LTI 子系统并联构成的复合系统。如果第一个子系统的脉冲响应为 $h_1(t) = t e^{-at} u(t)$（这是一个函数 $e^{-at}u(t)$ 与其自身的卷积），第二个子系统的脉冲响应为 $h_2(t) = A\delta(t) + B\delta(t-T)$，那么整个系统的脉冲响应就是这两个响应的直接相加：$h(t) = t e^{-at} u(t) + A\delta(t) + B\delta(t-T)$ [@problem_id:1701232]。

#### 混合结构

在实际应用中，系统通常是级联和并联的混合结构。分析这类系统时，我们可以通过代数运算，将整个系统的输入-输出关系简化为单个差分方程或[传递函数](@entry_id:273897)。例如，一个系统可能包含一个级联模块（系统 A）与另一个子系统（系统 B）并联。通过逐步代入各个模块的[差分方程](@entry_id:262177)，可以推导出描述整个系统的单一差分方程，并确定其系数 [@problem_id:1701252]。

### [数字滤波器](@entry_id:181052)的实现结构

高阶 IIR（无限脉冲响应）或 FIR（[有限脉冲响应](@entry_id:192542)）滤波器的[传递函数](@entry_id:273897)通常是高次多项式的比值。直接根据此[多项式系数](@entry_id:262287)来实现滤波器（称为**直接型结构**）在数值上非常敏感。系数的微小[量化误差](@entry_id:196306)可能会导致[极点位置](@entry_id:271565)发生巨大变化，甚至可能使稳定系统变得不稳定。为了克服这个问题，高阶滤波器通常被分解为一系列低阶（通常是一阶或二阶）部分，然后以级联或并联形式实现。

#### 级联型实现

级联型实现的基本思想是将高阶[传递函数](@entry_id:273897) $H(z)$ 分解为一系列二阶部分（称为**双二阶节（biquads）**）的乘积：
$$H(z) = G \prod_{k=1}^{N} H_k(z) = G \prod_{k=1}^{N} \frac{b_{0,k} + b_{1,k}z^{-1} + b_{2,k}z^{-2}}{1 + a_{1,k}z^{-1} + a_{2,k}z^{-2}}$$

这里，$G$ 是一个总增益。这种分解通过将[传递函数](@entry_id:273897)的分子和分母[多项式的根](@entry_id:154615)（即系统的[零点和极点](@entry_id:177073)）配对来实现。通常，将彼此靠近的极点和零点配对在同一个双二阶节中，有助于改善滤波器的动态范围。

#### 并联型实现

并联型实现则依赖于对[传递函数](@entry_id:273897)进行**[部分分式展开](@entry_id:265121)（Partial Fraction Expansion）**。如果[传递函数](@entry_id:273897) $H(z)$ 的分母阶数高于分子阶数（即系统是严格真分有理的），它可以被分解为一系列一阶或二阶项的和：
$$H(z) = C + \sum_{k=1}^{M} \frac{A_k}{1 - p_k z^{-1}} + \sum_{j=1}^{L} \frac{B_j + C_j z^{-1}}{1 + d_{1,j}z^{-1} + d_{2,j}z^{-2}}$$

常数项 $C$ 仅在 $H(z)$ 的分子和分母阶数相同时出现（通过[多项式长除法](@entry_id:272380)得到）。每个求和项对应于 $H(z)$ 的一个实数极点或一对共轭复数极点。

例如，一个由[传递函数](@entry_id:273897) $H(z) = \frac{2 - z^{-1} - 0.5z^{-2}}{1 - 0.3z^{-1} - 0.1z^{-2}}$ 描述的系统，可以被实现为一个常数增益与两个一阶滤波器并联的形式，即 $H(z) = C + \frac{A_1}{1 - 0.5z^{-1}} + \frac{A_2}{1 + 0.2z^{-1}}$。通过合并右侧的项并使其与左侧相等，可以建立一个关于未知系数 $C, A_1, A_2$ 的线性方程组。求解这个[方程组](@entry_id:193238)，我们就能确定实现该系统并联结构所需的系数，从而将一个[二阶系统](@entry_id:276555)分解为三个更简单的并行路径 [@problem_id:1701259]。

### 复合系统的[状态空间表示](@entry_id:147149)

状态空间方法为分析和综合复杂系统提供了强大的矩阵框架。一个 LTI 系统可以用一组一阶[微分](@entry_id:158718)或差分方程来描述：
$$\dot{x}(t) = Ax(t) + Bu(t)$$
$$y(t) = Cx(t) + Du(t)$$

其中 $x(t)$ 是状态向量，$(A, B, C, D)$ 是描述系统动态的矩阵。当子系统以级联或并联方式连接时，整个系统的[状态空间表示](@entry_id:147149)可以由子系统的矩阵导出。

对于**级联连接**，假设系统1 $(A_1, B_1, C_1, D_1)$ 的输出 $y_1$ 是系统2 $(A_2, B_2, C_2, D_2)$ 的输入 $u_2$。复合系统的[状态向量](@entry_id:154607)是 $x = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}$。通过代入连接关系 $u_2 = y_1 = C_1x_1 + D_1u_1$，我们可以推导出复合系统的[状态空间](@entry_id:177074)矩阵：
$$A_{\text{cas}} = \begin{pmatrix} A_1  0 \\ B_2 C_1  A_2 \end{pmatrix}, \quad B_{\text{cas}} = \begin{pmatrix} B_1 \\ B_2 D_1 \end{pmatrix}$$
$$C_{\text{cas}} = \begin{pmatrix} D_2 C_1  C_2 \end{pmatrix}, \quad D_{\text{cas}} = D_2 D_1$$

这种[块矩阵](@entry_id:148435)结构清晰地揭示了子系统间的相互作用：系统1的状态 $x_1$ 通过 $B_2 C_1$ 这一路径影响系统2的状态演化 $\dot{x_2}$ [@problem_id:1701258]。

对于**并联连接**，复合系统的状态矩阵具有更简单的[块对角结构](@entry_id:746869)，因为子系统之间没有直接的动态耦合：
$$A_{\text{par}} = \begin{pmatrix} A_1  0 \\ 0  A_2 \end{pmatrix}, \quad B_{\text{par}} = \begin{pmatrix} B_1 \\ B_2 \end{pmatrix}$$
$$C_{\text{par}} = \begin{pmatrix} C_1  C_2 \end{pmatrix}, \quad D_{\text{par}} = D_1 + D_2$$

### 高级主题与实践考量

在理想的数学世界中，级联和并联结构的行为非常清晰。然而，在实际工程应用中，特别是在数字硬件的有限精度环境下，会出现许多深刻而微妙的问题。

#### 极点-零点对消与系统最小性

在级联结构中，一个子系统的零点可能会与另一个子系统的极点在同一位置，导致**极点-零点对消**。当这种情况发生时，整体[传递函数](@entry_id:273897)的阶数会低于各子系统阶数之和。例如，如果 $H_1(s) = \frac{s - \alpha}{s + 2}$ 与 $H_2(s) = \frac{K}{s - \beta}$ 级联，得到的系统 $H(s) = H_1(s)H_2(s)$ 通常是二阶的。但如果 $H_1$ 的零点 $\alpha$ 恰好等于 $H_2$ 的极点 $\beta$ 或 $H_1$ 的极点 $-2$，则会发生对消，系统阶数降为一阶 [@problem_id:1701269]。

这种对消现象具有重要意义。首先，它可能导致系统的[状态空间实现](@entry_id:166670)是**非最小的**。一个非[最小实现](@entry_id:176932)意味着系统的某些内部动态（状态）从输入端是**不可控的**，或者从输出端是**不可观的**。与被对消的极点-零点[对相关](@entry_id:203353)的模式虽然存在于系统内部，但不会出现在输入-输出响应中。

其次，极点-零点对消是稳定设计的关键工具。考虑一个稳定的系统 $H_1(s)$ 与一个不稳定的系统 $H_2(s)$（即其极点位于右半 s 平面）级联。如果稳定系统 $H_1(s)$ 的[零点能](@entry_id:142176)够精确地对消掉 $H_2(s)$ 的[不稳定极点](@entry_id:268645)，那么整个级联系统可以是稳定的 [@problem_id:1701260]。然而，这种稳定是脆弱的：在物理实现中，由于参数漂移或[量化误差](@entry_id:196306)，完美的对消几乎不可能实现，残留的微小极点仍可能导致系统不稳定或产生长时间的[瞬态响应](@entry_id:165150)。

#### [有限字长效应](@entry_id:201338)：为什么顺序在实践中很重要

我们之前提到，在理想 LTI 系统中，级联的顺序无关紧要。然而，在**[定点算术](@entry_id:170136)**的硬件实现中，这一结论不再成立。每次算术运算后，结果都必须被**量化**（例如，舍入）到有限的位数。这在每个级联节的输出端引入了[非线性](@entry_id:637147)的量化操作，可以建模为一个附加的**量化噪声**源。

这个在第 $i$ 节输出端产生的噪声，会作为输入信号被其后的所有子系统（第 $i+1$ 到 $N$ 节）滤波。因此，总的输出噪声是所有内部噪声源经过不同滤波器（即下游级联子系统）整形后的叠加。如果改变级联节的顺序，每个噪声源所经过的“噪声[传递函数](@entry_id:273897)”就会改变，从而导致总输出噪声的功率谱密度和[均方误差](@entry_id:175403)发生变化 [@problem_id:2856967]。因此，在定点[滤波器设计](@entry_id:266363)中，双二阶节的**配对**（哪个极点和哪个零点组合）和**排序**（哪个双二阶节在前）是优化信噪比和避免[溢出](@entry_id:172355)的关键步骤。

#### 系数量化与极点灵敏度

除了信号值，滤波器系数本身也需要量化。系数的量化会使[系统的极点](@entry_id:261618)和零点偏离其设计时的理想位置。**极点灵敏度**描述了[极点位置](@entry_id:271565)对系数变化的敏感程度。

对于直接型实现的高阶滤波器，所有极点都与所有系数相关，灵敏度通常很高。而级联的双二阶结构则具有优越的灵敏度特性。对于一个双二阶节 $D_k(z) = 1 + a_{1,k}z^{-1} + a_{2,k}z^{-2}$，其两个极点 $p$ 和 $p'$ 的位置灵敏度与这两个极点之间的距离 $|p - p'|$ 成反比。当一个双二阶节内的两个极点彼此非常靠近（**极点聚集**）时，即 $|p - p'| \to 0$，分母多项式在极点处的导数 $D_k'(p)$ 趋于零，导致[极点位置](@entry_id:271565)对系数 $a_{1,k}$ 和 $a_{2,k}$ 的微小扰动变得极其敏感 [@problem_id:2856900]。级联结构将这种高灵敏度问题局部化了：一个极点的灵敏度只取决于同一双二阶节内的另一个极点，而与其它节中的极点无关。这极大地提高了[滤波器实现](@entry_id:267605)的鲁棒性。同样值得注意的是，只有分母系数的量化才会影响[极点位置](@entry_id:271565)；分子系数的量化仅影响零点位置 [@problem_id:2856900]。

#### 并联型实现的数值稳定性

并联型结构同样面临数值挑战，尤其是在处理具有相近极点的系统时。考虑一个[传递函数](@entry_id:273897)，其分母有两个非常接近的极点 $p+\epsilon$ 和 $p-\epsilon$，其中 $|\epsilon| \ll 1$。
$$H(s) = \frac{s + a}{(s - (p + \epsilon))(s - (p - \epsilon))}$$

当尝试进行[部分分式展开](@entry_id:265121) $H(s) = \frac{A}{s - (p + \epsilon)} + \frac{B}{s - (p - \epsilon)}$ 时，用于求解留数 $A$ 和 $B$ 的线性方程组变得**病态（ill-conditioned）**。其系数[矩阵的[行列](@entry_id:148198)式](@entry_id:142978)正比于 $2\epsilon$，当 $\epsilon \to 0$ 时趋于零。这导致计算出的留数 $A$ 和 $B$ 会变得非常大，符号相反，且它们的计算依赖于两个大数相减得到一个小数，这在有限精度计算中会引发灾难性的精度损失。

一种更稳健的计算方法是，首先在极限情况 $\epsilon \to 0$ 下分析系统。此时[传递函数](@entry_id:273897)变为 $H_0(s) = \frac{s+a}{(s-p)^2}$，这是一个具有二[重极点](@entry_id:262210)的系统。我们可以围绕合并点 $s=p$ 对其进行洛朗级数或 Hermite 型展开：
$$H_0(s) = \frac{C_1}{s-p} + \frac{C_2}{(s-p)^2}$$
这里的系数 $C_1=1$ 和 $C_2=p+a$ 是有限且良态的，可以通过求导和取极限稳定地计算出来。一旦得到了这些稳定的中间系数，就可以通过一个良态的代数关系，为给定的非零小 $\epsilon$ 反解出原始的留数 $A$ 和 $B$。这个过程将数值不稳定性隔离到一个简单的步骤中，从而实现了稳健的计算 [@problem_id:2856928]。这一例子深刻地说明了在系统实现中，直接的数学公式和数值上稳健的算法之间可能存在的巨大差异。