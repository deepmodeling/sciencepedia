{"hands_on_practices": [{"introduction": "本章的第一个实践练习是基础中的基础。我们将从一个虽然简单但却至关重要的时域信号——因果指数序列 $x[n]=a^n u[n]$ 出发，推导其离散时间傅里叶变换（DTFT）。这个练习不仅是应用 DTFT 定义的计算，更重要的是，它旨在建立一种直觉：理解时域中的一个简单参数 $a$ 如何决定整个频谱的形状，为我们后续理解基本滤波器和系统稳定性奠定了坚实的基础。", "problem": "考虑由 $x[n]=a^{n} u[n]$ 定义的右侧指数序列，其中 $u[n]$ 是单位阶跃序列，且 $a \\in \\mathbb{R}$ 满足 $|a|1$。角频率的单位是弧度/采样点。仅从离散时间傅里叶变换 (DTFT) 的定义：\n$$\nX(e^{j\\omega})=\\sum_{n=-\\infty}^{\\infty} x[n] e^{-j\\omega n},\n$$\n以及无穷级数的标准收敛性事实出发，完成以下任务：\n\n1) 推导DTFT $X(e^{j\\omega})$ 的闭式表达式，并证明在给定的关于 $a$ 的条件下，该表达式对所有实数 $\\omega$ 收敛。\n\n2) 将幅度 $|X(e^{j\\omega})|$ 和展开相位 $\\arg\\{X(e^{j\\omega})\\}$ 显式地写成关于 $\\omega$ 和 $a$ 的函数。仔细辨别幅度和相位的定性行为如何依赖于 $a$ 的符号和大小。\n\n3) 确定使幅度最大化的 $\\omega \\in [-\\pi,\\pi)$ 的值（作为 $a$ 的符号的函数），并以闭式形式计算该最大幅度。\n\n为每个步骤提供简要推理，以将结果与初始定义和已知的级数事实联系起来。作为最终答案，仅报告最大幅度 $\\,\\max_{\\omega \\in \\mathbb{R}} |X(e^{j\\omega})|\\,$ 关于 $a$ 的精确闭式表达式（可以使用绝对值运算符）。不要进行近似或四舍五入；给出精确表达式（最终答案无需单位）。", "solution": "所述问题具有科学依据，提法明确且客观。这是离散时间系统分析中的一个标准练习，没有任何使其无效的缺陷。因此，我们可以着手求解。\n\n问题要求分析右侧指数序列 $x[n]=a^{n} u[n]$ 的离散时间傅里叶变换 (DTFT)，其中 $a \\in \\mathbb{R}$ 且 $|a|1$。单位阶跃序列 $u[n]$ 定义为：当 $n \\ge 0$ 时 $u[n]=1$，当 $n  0$ 时 $u[n]=0$。DTFT 定义为\n$$\nX(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} x[n] e^{-j\\omega n}\n$$\n\n1) $X(e^{j\\omega})$ 闭式表达式的推导。\n我们首先将 $x[n]$ 的定义代入DTFT公式。单位阶跃序列 $u[n]$ 的存在将求和范围限制为索引 $n$ 的非负值：\n$$\nX(e^{j\\omega}) = \\sum_{n=0}^{\\infty} a^{n} e^{-j\\omega n}\n$$\n我们可以合并以 $n$ 为幂的项：\n$$\nX(e^{j\\omega}) = \\sum_{n=0}^{\\infty} (a e^{-j\\omega})^{n}\n$$\n这是一个公比为 $r = a e^{-j\\omega}$ 的等比级数，形式为 $\\sum_{n=0}^{\\infty} r^n$。根据无穷级数理论的一个标准结果，该级数收敛到 $\\frac{1}{1-r}$ 的充要条件是公比的模严格小于1，即 $|r|1$。我们必须验证此条件。\n公比的模为：\n$$\n|r| = |a e^{-j\\omega}| = |a| |e^{-j\\omega}|\n$$\n对于任意实频率 $\\omega$，根据欧拉公式 $e^{-j\\omega} = \\cos(-\\omega) + j\\sin(-\\omega) = \\cos(\\omega) - j\\sin(\\omega)$。其模为 $|e^{-j\\omega}| = \\sqrt{\\cos^2(\\omega) + (-\\sin(\\omega))^2} = \\sqrt{\\cos^2(\\omega) + \\sin^2(\\omega)} = 1$。\n因此，收敛条件变为 $|r| = |a| \\cdot 1 = |a|  1$。这个条件在问题陈述中已经给出。所以，该级数对所有实数 $\\omega$ 都收敛，我们可以应用收敛等比级数的求和公式：\n$$\nX(e^{j\\omega}) = \\frac{1}{1 - a e^{-j\\omega}}\n$$\n这就是所求的DTFT的闭式表达式。\n\n2) 幅度和相位。\n为求幅度和相位，我们首先使用 $e^{-j\\omega} = \\cos(\\omega) - j\\sin(\\omega)$ 将复数分母表示为直角坐标形式：\n$$\nX(e^{j\\omega}) = \\frac{1}{1 - a(\\cos(\\omega) - j\\sin(\\omega))} = \\frac{1}{(1 - a\\cos(\\omega)) + j(a\\sin(\\omega))}\n$$\n复数 $z = z_r + j z_i$ 的模是 $|z| = \\sqrt{z_r^2 + z_i^2}$。$X(e^{j\\omega})$ 的幅度是其分母模的倒数：\n$$\n|X(e^{j\\omega})| = \\frac{1}{\\sqrt{(1 - a\\cos(\\omega))^2 + (a\\sin(\\omega))^2}}\n$$\n展开平方根内的各项可得：\n$$\n(1 - 2a\\cos(\\omega) + a^2\\cos^2(\\omega)) + a^2\\sin^2(\\omega) = 1 - 2a\\cos(\\omega) + a^2(\\cos^2(\\omega) + \\sin^2(\\omega)) = 1 - 2a\\cos(\\omega) + a^2\n$$\n因此，幅度为：\n$$\n|X(e^{j\\omega})| = \\frac{1}{\\sqrt{1 - 2a\\cos(\\omega) + a^2}}\n$$\n复数 $z = z_r + j z_i$ 的相位是 $\\arg\\{z\\} = \\arctan(z_i/z_r)$。$X(e^{j\\omega})$ 的相位是其分母相位的相反数，因为分子是1（一个相位为0的正实数）：\n$$\n\\arg\\{X(e^{j\\omega})\\} = -\\arg\\{(1 - a\\cos(\\omega)) + j(a\\sin(\\omega))\\} = -\\arctan\\left(\\frac{a\\sin(\\omega)}{1-a\\cos(\\omega)}\\right)\n$$\n由于 $|a|1$ 意味着 $|a\\cos(\\omega)| \\le |a|  1$，项 $1-a\\cos(\\omega)$ 总是正的。这确保了反正切函数对于展开相位是良定义的，没有象限模糊性。\n\n定性行为：\n- 幅度：分母中的项 $-2a\\cos(\\omega)$ 决定了其形状。\n  - 若 $a > 0$，当 $\\cos(\\omega)=1$ (即 $\\omega=0$) 时，该项最小（变为最负）。这使得分母最小化，从而使幅度最大化。频谱是低通的，其峰值在 $\\omega=0$ 处。\n  - 若 $a  0$，令 $a = -|a|$。该项变为 $+2|a|\\cos(\\omega)$。当 $\\cos(\\omega)=-1$ (即 $\\omega=\\pi$) 时，该项最小。这使得分母最小化，从而使幅度最大化。频谱是高通的，其峰值在 $\\omega=\\pi$ 处。\n- 相位：分子 $a\\sin(\\omega)$ 中 $a$ 的符号决定了当 $\\omega \\in (0, \\pi)$ 时相位的符号。\n  - 若 $a > 0$，当 $\\omega \\in (0, \\pi)$ 时相位为负。\n  - 若 $a  0$，当 $\\omega \\in (0, \\pi)$ 时相位为正。\n\n3) 幅度的最大化。\n为了最大化幅度 $|X(e^{j\\omega})|$，我们必须最小化分母中的正函数 $g(\\omega) = 1 - 2a\\cos(\\omega) + a^2$。由于其他项相对于 $\\omega$ 是常数，我们可以通过分析项 $-2a\\cos(\\omega)$ 的行为来找到最小值。\n\n- 情况1：$a > 0$。因子 $-2a$ 为负。因此，要最小化 $-2a\\cos(\\omega)$，我们必须最大化 $\\cos(\\omega)$。$\\cos(\\omega)$ 的最大值为1，出现在 $\\omega = 2k\\pi$（$k$为整数）处。在区间 $[-\\pi, \\pi)$ 内，这对应于 $\\omega = 0$。\n将 $\\omega=0$ 代入幅度表达式，可得最大幅度：\n$$\n\\max |X(e^{j\\omega})| = \\frac{1}{\\sqrt{1 - 2a\\cos(0) + a^2}} = \\frac{1}{\\sqrt{1 - 2a + a^2}} = \\frac{1}{\\sqrt{(1-a)^2}} = \\frac{1}{|1-a|}\n$$\n由于 $a > 0$ 且 $|a|1$，我们有 $0  a  1$，这意味着 $1-a > 0$。因此，$|1-a|=1-a$。最大幅度为 $\\frac{1}{1-a}$。\n\n- 情况2：$a  0$。因子 $-2a$ 为正。因此，要最小化 $-2a\\cos(\\omega)$，我们必须最小化 $\\cos(\\omega)$。$\\cos(\\omega)$ 的最小值为-1，出现在 $\\omega = (2k+1)\\pi$（$k$为整数）处。在区间 $[-\\pi, \\pi)$ 内，这对应于 $\\omega = \\pi$ 或 $\\omega = -\\pi$。我们选择 $\\omega = \\pi$。\n将 $\\omega=\\pi$ 代入幅度表达式，可得最大幅度：\n$$\n\\max |X(e^{j\\omega})| = \\frac{1}{\\sqrt{1 - 2a\\cos(\\pi) + a^2}} = \\frac{1}{\\sqrt{1 - 2a(-1) + a^2}} = \\frac{1}{\\sqrt{1 + 2a + a^2}} = \\frac{1}{\\sqrt{(1+a)^2}} = \\frac{1}{|1+a|}\n$$\n由于 $a  0$ 且 $|a|1$，我们有 $-1  a  0$，这意味着 $1+a > 0$。因此，$|1+a|=1+a$。最大幅度为 $\\frac{1}{1+a}$。\n\n- 情况3：$a = 0$。序列为 $x[n]=\\delta[n]$，即单位冲激序列。其DTFT为 $X(e^{j\\omega}) = 1$（对所有 $\\omega$），因此最大幅度为1。\n\n我们可以将这些结果合并成一个单一的表达式。对于 $a>0$，最大值为 $\\frac{1}{1-a} = \\frac{1}{1-|a|}$。对于 $a0$，最大值为 $\\frac{1}{1+a} = \\frac{1}{1-(-a)} = \\frac{1}{1-|a|}$。对于 $a=0$，$\\frac{1}{1-|0|} = 1$。\n因此，对于任何满足 $|a|1$ 的 $a$，最大幅度由下式给出：\n$$\n\\max_{\\omega \\in \\mathbb{R}} |X(e^{j\\omega})| = \\frac{1}{1-|a|}\n$$\n这就是所求的最终表达式。", "answer": "$$\n\\boxed{\\frac{1}{1-|a|}}\n$$", "id": "2912118"}, {"introduction": "掌握了基本的频谱分析之后，下一步自然是学习如何操纵频谱。本练习将展示一个强大而高效的技术：通过将信号乘以序列 $(-1)^n$ 来实现频谱的搬移，这是滤波器设计中一项常见的操作。通过这个实践 [@problem_id:1760096]，你将亲身体会到，深刻理解 DTFT 的频率位移等性质，对于在实际应用中灵活变换和设计数字滤波器是何等重要。", "problem": "一位电气工程专业的学生正在设计一个简单的数字有限冲激响应 (FIR) 滤波器。其初始设计的冲激响应（记为 $h_1[n]$）由下式给出：\n$$\nh_1[n] = \\begin{cases} A \\cos(\\omega_0 n)  \\text{for } |n| \\le N \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n其中 $A$ 是一个正的振幅常数，$\\omega_0$ 是一个恒定的载波频率，满足 $0  \\omega_0  \\pi/2$ 弧度/采样点，而 $N$ 是一个定义了冲激响应长度的大正整数。该滤波器的频率响应为 $H_1(e^{j\\omega})$，它是 $h_1[n]$ 的离散时间傅里叶变换 (DTFT)。由于该冲激响应的性质，已知其频率响应的幅度 $|H_1(e^{j\\omega})|$ 会在频率 $\\omega = \\omega_0$ 和 $\\omega = -\\omega_0$ 附近呈现尖锐的峰值。\n\n为了创建一个新的滤波器，该学生用交变序列 $(-1)^n$ 来调制原始冲激响应。新的冲激响应 $h_2[n]$ 定义为：\n$$\nh_2[n] = (-1)^n h_1[n]\n$$\n设 $H_2(e^{j\\omega})$ 为这个新滤波器的频率响应。假设 $N$ 足够大，其幅度谱 $|H_2(e^{j\\omega})|$ 也会在主频率区间 $(-\\pi, \\pi]$ 内展现出两个尖锐的主峰。\n\n请确定 $|H_2(e^{j\\omega})|$ 的一个主峰在特定区间 $[0, \\pi]$ 内的位置频率 $\\omega_p$。请用 $\\pi$ 和 $\\omega_0$ 将你的答案表示为一个符号表达式。", "solution": "求解过程包括找出新滤波器频率响应 $H_2(e^{j\\omega})$ 与原始滤波器频率响应 $H_1(e^{j\\omega})$ 之间的关系。\n\n频率响应 $H_2(e^{j\\omega})$ 是冲激响应 $h_2[n]$ 的离散时间傅里叶变换 (DTFT)。根据定义，DTFT 由下式给出：\n$$\nH_2(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} h_2[n] e^{-j\\omega n}\n$$\n已知新的冲激响应为 $h_2[n] = (-1)^n h_1[n]$。一个关键步骤是使用欧拉恒等式 $e^{j\\theta} = \\cos(\\theta) + j\\sin(\\theta)$ 将调制序列 $(-1)^n$ 表示为其复指数形式。当 $\\theta = \\pi$ 时，我们有 $e^{j\\pi} = \\cos(\\pi) + j\\sin(\\pi) = -1 + 0 = -1$。\n因此，我们可以写出：\n$$\n(-1)^n = (e^{j\\pi})^n = e^{j\\pi n}\n$$\n将此代入 $h_2[n]$ 的表达式，得到 $h_2[n] = e^{j\\pi n} h_1[n]$。现在，我们将此代入 $H_2(e^{j\\omega})$ 的 DTFT 公式中：\n$$\nH_2(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} (e^{j\\pi n} h_1[n]) e^{-j\\omega n}\n$$\n我们可以合并指数项：\n$$\nH_2(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} h_1[n] e^{j\\pi n - j\\omega n} = \\sum_{n=-\\infty}^{\\infty} h_1[n] e^{-j(\\omega - \\pi)n}\n$$\n现在，让我们回顾原始滤波器频率响应 $H_1(e^{j\\omega'})$ 的定义：\n$$\nH_1(e^{j\\omega'}) = \\sum_{n=-\\infty}^{\\infty} h_1[n] e^{-j\\omega' n}\n$$\n通过将 $H_2(e^{j\\omega})$ 的表达式与 $H_1(e^{j\\omega'})$ 的定义进行比较，我们可以看出，如果设 $\\omega' = \\omega - \\pi$，两者是等价的。这就导出了 DTFT 的频移特性：\n$$\nH_2(e^{j\\omega}) = H_1(e^{j(\\omega - \\pi)})\n$$\n这个结果意味着新滤波器的频率响应 $H_2(e^{j\\omega})$ 是原始频率响应 $H_1(e^{j\\omega})$ 的一个移位版本。整个频谱向右平移了 $\\pi$ 弧度/采样点。\n\n题目说明幅度谱 $|H_1(e^{j\\omega})|$ 的主峰位于 $\\omega = \\pm \\omega_0$。由于 $|H_2(e^{j\\omega})| = |H_1(e^{j(\\omega - \\pi)})|$，因此 $|H_2(e^{j\\omega})|$ 的峰值将出现在使 $H_1$ 的自变量等于原始峰值位置的频率 $\\omega$ 处。也就是说，新的峰值位置满足：\n$$\n\\omega - \\pi = \\pm \\omega_0\n$$\n这给了我们两个可能的新峰值位置：\n1. $\\omega - \\pi = \\omega_0 \\implies \\omega = \\pi + \\omega_0$\n2. $\\omega - \\pi = -\\omega_0 \\implies \\omega = \\pi - \\omega_0$\n\n我们需要找到位于区间 $[0, \\pi]$ 内的峰值位置 $\\omega_p$。让我们在 $0  \\omega_0  \\pi/2$ 的约束条件下检查这两个解。\n\n对于第一个解 $\\omega = \\pi + \\omega_0$。由于 $\\omega_0$ 是正数，$\\pi + \\omega_0 > \\pi$。这个位置在指定的区间 $[0, \\pi]$ 之外。\n\n对于第二个解 $\\omega = \\pi - \\omega_0$。由于 $0  \\omega_0  \\pi/2$，我们可以确定这个值的范围：\n- 当 $\\omega_0 \\to 0$ 时，$\\omega \\to \\pi$。\n- 当 $\\omega_0 \\to \\pi/2$ 时，$\\omega \\to \\pi/2$。\n所以，对于给定的 $\\omega_0$ 范围，我们有 $\\pi/2  \\pi - \\omega_0  \\pi$。这个值显然在区间 $[0, \\pi]$ 内。\n\n因此，在区间 $[0, \\pi]$ 内 $|H_2(e^{j\\omega})|$ 的主峰位于 $\\omega_p = \\pi - \\omega_0$。", "answer": "$$\\boxed{\\pi - \\omega_{0}}$$", "id": "1760096"}, {"introduction": "前面的练习侧重于从信号到频谱的分析，而这个练习则将挑战逆向思维——从零开始设计信号。你需要在频域约束（即在特定频率点上设置零点）的指导下，构造出满足要求的时域信号。这个综合性练习 [@problem_id:1760144] 不仅连接了 DTFT 和 Z 变换，还引入了滤波器设计中的核心概念——零点配置，深刻揭示了频域特性与时域信号结构之间的内在联系。", "problem": "一个因果、实值的离散时间信号 $x[n]$ 被设计为具有最小可能长度，并受限于某些频率响应约束。该信号的离散时间傅里叶变换 (DTFT)，记作 $X(e^{j\\omega})$，要求在直流频率 ($\\omega = 0$) 处有一个二阶零点，在奈奎斯特频率 ($\\omega = \\pi$) 处有一个单零点。假设第一个非零样本为 $x[0]=1$，确定信号 $x[n]$ 在 $n \\ge 0$ 时的序列值。将您的答案表示为一个行矩阵，其中包含按 $n$ 递增顺序排列的信号样本值。", "solution": "一个实值、因果、有限长度的序列 $x[n]$ 的离散时间傅里叶变换为\n$$\nX(e^{j\\omega})=\\sum_{n=0}^{N}x[n]e^{-j\\omega n}=\\sum_{n=0}^{N}x[n]z^{-n},\\quad z=e^{j\\omega},\n$$\n这是一个关于 $z^{-1}$ 的 $N$ 阶多项式。在频率 $\\omega=\\omega_{0}$ 处的零点对应于 $X(z)$ 在 $z=e^{j\\omega_{0}}$ 处的根。因此：\n- 在直流频率 $\\omega=0$ (即 $z=1$) 处的二阶零点需要一个因子 $(1-z^{-1})^{2}$。\n- 在奈奎斯特频率 $\\omega=\\pi$ (即 $z=-1$) 处的单零点需要一个因子 $(1+z^{-1})$。\n\n为仅包含这些零点并具有最小可能长度，$X(z)$ 必须是恰好含有这些因子的最小阶多项式（相差一个非零标量 $K$）：\n$$\nX(z)=K\\,(1-z^{-1})^{2}(1+z^{-1}).\n$$\n展开得\n$$\n(1-z^{-1})^{2}=1-2z^{-1}+z^{-2},\n$$\n$$\n(1-2z^{-1}+z^{-2})(1+z^{-1})=1 - z^{-1} - z^{-2} + z^{-3}.\n$$\n因此\n$$\nX(z)=K\\left(1 - z^{-1} - z^{-2} + z^{-3}\\right).\n$$\n将系数与 $X(z)=\\sum_{n=0}^{3}x[n]z^{-n}$ 进行匹配，得到\n$$\nx[0]=K,\\quad x[1]=-K,\\quad x[2]=-K,\\quad x[3]=K,\n$$\n并且对于 $n\\geq 4$ 和 $n0$，$x[n]=0$，这是一个长度为 4 的因果序列。零点重数之和为 $3$，因此最小多项式阶数为 $3$，从而最小序列长度为 $4$，这在这里得到了实现。\n\n施加第一个非零样本为 $x[0]=1$ 的归一化条件，可得 $K=1$。因此，按 $n\\geq 0$ 递增顺序排列的序列是\n$$\n\\begin{pmatrix}\n1  -1  -1  1\n\\end{pmatrix}\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1  -1  -1  1\\end{pmatrix}}$$", "id": "1760144"}]}