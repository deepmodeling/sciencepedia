{"hands_on_practices": [{"introduction": "掌握任何数学变换的第一步都是直接应用其定义。这个练习 [@problem_id:2223980] 通过一个简单而直观的信号，让你手动计算其频率分量，从而揭示时域中的模式是如何转化为频域中的特定值的。这个基础计算是理解离散傅里叶级数如何作为分析工具的基石。", "problem": "在数字信号处理中，一个简单的振荡信号可以由一个离散的采样序列表示。考虑一个在四个时间点上采样的此类信号，得到序列 $x = (x[0], x[1], x[2], x[3])$，其中 $x[0]=1$，$x[1]=0$，$x[2]=-1$，$x[3]=0$。\n\n为了分析该信号的频谱分量，可以计算其离散傅里叶变换 (DFT)。一个长度为 $N$ 的序列 $x[n]$ 的 $N$ 点 DFT 是另一个长度为 $N$ 的序列 $X[k]$，由以下分析方程定义：\n$$ X[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi}{N} nk\\right) $$\n其中 $k = 0, 1, \\dots, N-1$，$j$ 是满足 $j^2 = -1$ 的虚数单位。\n\n使用上述定义，计算给定信号序列 $x$ 的 4 点 DFT。你的答案应为复数序列 $(X[0], X[1], X[2], X[3])$。", "solution": "给定一个长度为 $N=4$ 的序列 $x[n]$，其中 $x[0]=1$，$x[1]=0$，$x[2]=-1$，$x[3]=0$。4 点 DFT 定义为\n$$\nX[k] = \\sum_{n=0}^{3} x[n] \\exp\\left(-j \\frac{2\\pi}{4} nk\\right), \\quad k=0,1,2,3.\n$$\n将给定的 $x[n]$ 值代入求和式中，\n$$\nX[k] = 1\\cdot \\exp(0) + 0\\cdot \\exp\\left(-j \\frac{2\\pi}{4} k\\right) + (-1)\\cdot \\exp\\left(-j \\frac{2\\pi}{4} 2k\\right) + 0\\cdot \\exp\\left(-j \\frac{2\\pi}{4} 3k\\right).\n$$\n利用 $\\exp(0)=1$，可简化为\n$$\nX[k] = 1 - \\exp(-j \\pi k).\n$$\n对于整数 $k$，使用欧拉公式可得\n$$\n\\exp(-j \\pi k) = \\cos(\\pi k) - j \\sin(\\pi k) = (-1)^{k},\n$$\n因为 $\\sin(\\pi k)=0$ 且 $\\cos(\\pi k)=(-1)^{k}$。因此，\n$$\nX[k] = 1 - (-1)^{k}.\n$$\n对 $k=0,1,2,3$ 求值：\n- 对于 $k=0$：$X[0] = 1 - 1 = 0$。\n- 对于 $k=1$：$X[1] = 1 - (-1) = 2$。\n- 对于 $k=2$：$X[2] = 1 - 1 = 0$。\n- 对于 $k=3$：$X[3] = 1 - (-1) = 2$。\n\n因此，4 点 DFT 序列为 $(0, 2, 0, 2)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0 & 2 & 0 & 2 \\end{pmatrix}}$$", "id": "2223980"}, {"introduction": "在掌握了基本计算之后，让我们来探索一个更深层次的概念：一个信号是否能被其频谱的幅度唯一确定？这个思想实验 [@problem_id:2896131] 挑战你构建一个反例，证明相位信息对于信号重构至关重要，而其缺失会导致模糊性。这个被称为“相位问题”的概念，在密码学、成像和结构生物学等领域具有深远的影响。", "problem": "设 $N \\geq 3$ 为一个固定的正整数。考虑长度为 $N$ 的周期序列及其 $N$ 点离散傅里叶变换（DFT）与逆离散傅里叶变换（IDFT），定义如下\n$$\nX[k] \\triangleq \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-j \\frac{2\\pi}{N} k n\\right), \\quad k=0,1,\\dots,N-1,\n$$\n其逆变换为\n$$\nx[n] \\triangleq \\frac{1}{N} \\sum_{k=0}^{N-1} X[k] \\exp\\!\\left(j \\frac{2\\pi}{N} k n\\right), \\quad n=0,1,\\dots,N-1.\n$$\n构造两个显式的、不同的 $N$ 周期序列 $x_{1}[n]$ 和 $x_{2}[n]$，使得它们的DFT幅度对于每个谐波指数 $k$ 都相同，即对所有 $k$ 都有 $|X_{1}[k]| = |X_{2}[k]|$，但它们的相位至少对于一个 $k$ 不同，即对于某个 $k$ 有 $\\arg X_{1}[k] \\neq \\arg X_{2}[k]$。你的构造必须直接根据上述DFT定义进行证明，而不能引用任何未经证明的变换性质。然后，计算平方欧几里得距离\n$$\nD \\triangleq \\sum_{n=0}^{N-1} \\left| x_{1}[n] - x_{2}[n] \\right|^{2}.\n$$\n将你的最终答案表示为单个实数或一个闭式解析表达式。最后，仅使用基于DFT定义的推理，解释你的构造对于仅从DFT幅度数据重构信号的唯一性的影响。不需要进行数值取整，也不涉及物理单位。", "solution": "我们首先构造两个序列 $x_{1}[n]$ 和 $x_{2}[n]$。一个满足要求的简单且典型的选择是使用移位的单位冲激。我们定义序列如下：\n$$x_{1}[n] \\triangleq \\delta[n-1]$$\n$$x_{2}[n] \\triangleq \\delta[n-(N-1)]$$\n其中 $\\delta[m]$ 是离散时间单位冲激（克罗内克δ函数），当 $m \\equiv 0 \\pmod{N}$ 时其值为 $1$，否则为 $0$。\n\n现在我们必须仅使用基于所提供DFT定义的推理来验证此构造是否满足所有规定要求。\n$1$. **序列的相异性**：序列 $x_{1}[n]$ 仅在 $n=1$ 处非零，此时 $x_{1}[1]=1$。序列 $x_{2}[n]$ 仅在 $n=N-1$ 处非零，此时 $x_{2}[N-1]=1$。由于问题规定 $N \\geq 3$，索引 $1$ 和 $N-1$ 是不同的。因此，$x_{1}[n]$ 和 $x_{2}[n]$ 是不同的序列。\n\n$2$. **DFT性质**：我们直接根据定义计算每个序列的DFT。\n对于 $x_{1}[n]$，其DFT $X_{1}[k]$ 为：\n$$X_{1}[k] = \\sum_{n=0}^{N-1} \\delta[n-1] \\exp\\left(-j \\frac{2\\pi}{N} k n\\right) = \\exp\\left(-j \\frac{2\\pi}{N} k \\cdot 1\\right) = \\exp\\left(-j \\frac{2\\pi k}{N}\\right)$$\n对于 $x_{2}[n]$，其DFT $X_{2}[k]$ 为：\n$$X_{2}[k] = \\sum_{n=0}^{N-1} \\delta[n-(N-1)] \\exp\\left(-j \\frac{2\\pi}{N} k n\\right) = \\exp\\left(-j \\frac{2\\pi}{N} k (N-1)\\right) = \\exp\\left(-j 2\\pi k + j \\frac{2\\pi k}{N}\\right) = \\exp\\left(j \\frac{2\\pi k}{N}\\right)$$\n现在我们来检查幅度和相位。\n幅度为：\n$$|X_{1}[k]| = \\left|\\exp\\left(-j \\frac{2\\pi k}{N}\\right)\\right| = 1$$\n$$|X_{2}[k]| = \\left|\\exp\\left(j \\frac{2\\pi k}{N}\\right)\\right| = 1$$\n显然，对于所有 $k \\in \\{0, 1, \\dots, N-1\\}$，都有 $|X_{1}[k]| = |X_{2}[k]|$。幅度条件得到满足。\n\n相位为：\n$$\\arg X_{1}[k] = -\\frac{2\\pi k}{N} \\pmod{2\\pi}$$\n$$\\arg X_{2}[k] = \\frac{2\\pi k}{N} \\pmod{2\\pi}$$\n要使相位不同，我们需要找到一个 $k$ 使得 $\\arg X_{1}[k] \\neq \\arg X_{2}[k]$。这等价于 $-\\frac{2\\pi k}{N} \\not\\equiv \\frac{2\\pi k}{N} \\pmod{2\\pi}$，可以简化为要求 $\\frac{4\\pi k}{N}$ 不是 $2\\pi$ 的整数倍，或者说 $\\frac{2k}{N}$ 不是整数。\n我们选择 $k=1$。由于 $N \\geq 3$，值 $\\frac{2(1)}{N} = \\frac{2}{N}$ 不是整数。因此，对于 $k=1$，$\\arg X_{1}[1] = -2\\pi/N$ 和 $\\arg X_{2}[1] = 2\\pi/N$ 确实是不同的。相位条件得到满足。\n\n验证了我们的构造之后，我们现在计算平方欧几里得距离 $D$：\n$$D \\triangleq \\sum_{n=0}^{N-1} \\left| x_{1}[n] - x_{2}[n] \\right|^{2}$$\n差分序列是 $d[n] = x_{1}[n] - x_{2}[n] = \\delta[n-1] - \\delta[n-(N-1)]$。这个序列在一个周期 $n \\in \\{0, 1, \\dots, N-1\\}$ 内包含以下值：\n$$d[n] = \\begin{cases} 1 & n=1 \\\\ -1 & n=N-1 \\\\ 0 & \\text{其它} \\end{cases}$$\n这些值的平方幅度之和为：\n$$D = |d[1]|^{2} + |d[N-1]|^{2} + \\sum_{n \\in \\{0, \\dots, N-1\\}, n \\neq 1, n \\neq N-1} |d[n]|^{2} = |1|^{2} + |-1|^{2} + 0 = 1 + 1 = 2$$\n平方欧几里得距离为 $2$。\n\n作为验证，这个结果可以用帕塞瓦尔定理推导出来。对于在此问题中定义的DFT/IDFT对，帕塞瓦尔定理的形式为 $\\sum_{n=0}^{N-1} |y[n]|^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} |Y[k]|^2$。我们将此应用于我们的差分序列 $d[n]$，其DFT为 $D[k] = X_{1}[k] - X_{2}[k] = \\exp(-j\\frac{2\\pi k}{N}) - \\exp(j\\frac{2\\pi k}{N}) = -2j \\sin(\\frac{2\\pi k}{N})$。\n$$ D = \\sum_{n=0}^{N-1} |d[n]|^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} |D[k]|^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} \\left| -2j \\sin\\left(\\frac{2\\pi k}{N}\\right) \\right|^2 = \\frac{4}{N} \\sum_{k=0}^{N-1} \\sin^2\\left(\\frac{2\\pi k}{N}\\right) $$\n使用恒等式 $\\sin^2(\\theta) = \\frac{1}{2}(1-\\cos(2\\theta))$ 和标准结果 $\\sum_{k=0}^{N-1} \\cos(2\\pi m k / N) = 0$ (对于非 $N$ 的整数倍的 $m$)：\n$$ D = \\frac{4}{N} \\sum_{k=0}^{N-1} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{4\\pi k}{N}\\right)\\right) = \\frac{2}{N} \\left( \\sum_{k=0}^{N-1} 1 - \\sum_{k=0}^{N-1} \\cos\\left(\\frac{4\\pi k}{N}\\right) \\right) = \\frac{2}{N}(N-0) = 2 $$\n这证实了直接在时域计算得到的结果。\n\n最后，我们解释这对仅从DFT幅度数据重构信号唯一性的影响。逆DFT定义 $x[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} X[k] \\exp(j \\frac{2\\pi}{N} k n)$，可以用幅度和相位表示为：\n$$x[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} |X[k]| \\exp(j \\arg X[k]) \\exp\\left(j \\frac{2\\pi}{N} k n\\right)$$\n这个公式明确显示，重构序列 $x[n]$ 需要知道DFT的幅度 $|X[k]|$ 和DFT的相位 $\\arg X[k]$。我们的构造为仅从幅度进行唯一重构的可能性提供了一个具体的反例。我们已经证明了存在两个不同的序列 $x_{1}[n]$ 和 $x_{2}[n]$，它们产生相同的DFT幅度谱 $|X_{1}[k]| = |X_{2}[k]|$。一个只被提供了这个幅度谱的观察者无法确定原始序列是 $x_{1}[n]$ 还是 $x_{2}[n]$，因为区分它们的相位信息是不可用的。这表明从序列 $x[n]$到其DFT幅度谱 $|X[k]|$ 的映射不是单射（一对一）的。因此，如果没有额外的信息或约束（例如最小相位、因果性或信号的已知属性），从傅里叶幅度中唯一地恢复任意信号是根本不可能的。", "answer": "$$\\boxed{2}$$", "id": "2896131"}, {"introduction": "这个练习将离散傅里叶级数的理论特性与其最重要的实际应用——快速卷积——联系起来。通过这个动手分析 [@problem_id:2896155]，你将比较“暴力”的时域卷积方法与优雅的频域方法。这个练习使你能够量化快速傅里叶变换 (FFT) 带来的巨大计算优势，并理解这种优势在何种条件下变得显著。", "problem": "考虑离散时间域中长度为$N$的复数周期序列，设序列$x[n]$的离散傅里叶变换 (DFT) 与其逆变换 (IDFT) 由以下分析-合成对定义\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\Big(-j \\frac{2\\pi}{N}kn\\Big), \\quad\nx[n] = \\frac{1}{N}\\sum_{k=0}^{N-1} X[k] \\exp\\!\\Big(j \\frac{2\\pi}{N}kn\\Big),\n$$\n其中 $k,n \\in \\{0,1,\\dots,N-1\\}$。两个序列 $x[n]$ 和 $h[n]$ 的长度为 $N$ 的圆周卷积为\n$$\ny[n] = \\sum_{m=0}^{N-1} x[m]\\, h[(n-m) \\bmod N].\n$$\n假设 $h[n]$ 是 $K$-稀疏的，意味着其 $N$ 个元素中恰好有 $K$ 个非零，并且 $h[n]$ 的支撑集是已知的。你需要比较计算 $y[n]$ 的两种方法：\n- 在时域中利用 $h[n]$ 的稀疏性进行直接圆周卷积，以及\n- 一种基于 DFT 的方法，该方法构建 $X[k]$ 并将其与 $H[k]$ 相乘，然后应用逆 DFT 得到 $y[n]$。\n\n假设采用以下计算模型：\n- 以单位权重计算实数浮点运算：每次实数加法计为 $1$，每次实数乘法计为 $1$。\n- 一次复数加法等于 $2$ 次实数加法。\n- 一次复数乘法等于 $4$ 次实数乘法和 $2$ 次实数加法，总计 $6$ 次实数运算。\n- DFT 及其逆变换使用基-$2$ Cooley–Tukey 快速傅里叶变换 (FFT) 实现。一个长度为 $N$ 的基-$2$ FFT 有 $\\log_{2} N$ 个级，每级有 $N/2$ 个蝶形运算，每个蝶形运算恰好包含一次与旋转因子的复数乘法和两次复数加法。\n- $h[n]$ 的 DFT 是预先计算好的，并以 $H[k]$ 的形式提供，因此基于 DFT 的方法的每次评估成本包括一次对 $x[n]$ 的正向 FFT， $N$ 次逐点复数乘法 $X[k]H[k]$，以及一次用于合成 $y[n]$ 的逆 FFT。\n\n从上述基本定义以及你能推导出的任何性质出发，对这两种方法在 $N=4096$ 的特定情况下进行运算计数比较。确定确切的盈亏平衡稀疏度 $K_{\\text{be}}$，在该稀疏度下，两种方法评估一次 $y[n]$ 所需的总实数运算次数相同。将你的最终结果 $K_{\\text{be}}$ 报告为一个单一数字。无需四舍五入。", "solution": "我们的目标是找到盈亏平衡稀疏度 $K_{\\text{be}}$，使得直接时域方法的计算成本等于频域（基于 FFT）方法的成本。\n\n首先，我们确定直接方法 $C_D$ 的计算成本。圆周卷积由下式给出\n$$\ny[n] = \\sum_{m=0}^{N-1} x[m]\\, h[(n-m) \\bmod N].\n$$\n要计算单个输出样本 $y[n]$，该求和涉及 $N$ 次乘法和 $N-1$ 次加法。然而，序列 $h[n]$ 是 $K$-稀疏的。由于 $h[n]$ 的支撑集是已知的，我们可以利用这种稀疏性。设 $h[n]$ 非零的索引集合为 $\\mathcal{S}_h = \\{n_1, n_2, \\dots, n_K\\}$。对于给定的 $n$，卷积和减少为仅对 $K$ 项求和。对于每个 $n \\in \\{0, 1, \\dots, N-1\\}$，计算为\n$$\ny[n] = \\sum_{i=1}^{K} x[(n-n_i) \\bmod N] \\, h[n_i].\n$$\n对于每个输出样本 $y[n]$，我们执行 $K$ 次复数乘法（求和中的每一项一次）和 $K-1$ 次复数加法来对所得乘积求和。\n以实数运算计，计算一个样本 $y[n]$ 的成本是：\n- $K$ 次复数乘法的成本：$K \\times (4 \\text{ 次实数乘法} + 2 \\text{ 次实数加法}) = K \\times 6 = 6K$ FLOPS。\n- $K-1$ 次复数加法的成本：$(K-1) \\times (2 \\text{ 次实数加法}) = 2K-2$ FLOPS。\n一个样本 $y[n]$ 的总成本为 $6K + (2K-2) = 8K-2$ FLOPS。\n要计算 $n=0, 1, \\dots, N-1$ 的整个输出序列 $y[n]$，我们必须重复此计算 $N$ 次。\n因此，直接方法的总成本为\n$$\nC_D(K) = N(8K-2).\n$$\n\n接下来，我们确定基于 FFT 的方法 $C_F$ 的计算成本。该方法包括三个步骤：\n1. 计算 $x[n]$ 的 DFT：$X[k] = \\text{FFT}(x[n])$。\n2. 在频域中执行逐点乘法：$Y[k] = X[k]H[k]$。\n3. 计算逆 DFT 以获得结果：$y[n] = \\text{IFFT}(Y[k])$。\n\n我们使用提供的模型分析每一步的成本。\n一个 $N$ 点基-$2$ FFT 的成本基于其结构。它有 $\\log_2 N$ 个级，每级有 $N/2$ 个蝶形运算。每个蝶形运算涉及 $1$ 次复数乘法和 $2$ 次复数加法。\n一次蝶形运算的实数运算成本是：\n- $1$ 次复数乘法：$6$ FLOPS。\n- $2$ 次复数加法：$2 \\times 2 = 4$ FLOPS。\n每个蝶形运算的总成本是 $6+4=10$ FLOPS。\n一次 $N$ 点 FFT 的总成本是级数乘以每级的蝶形运算数再乘以每个蝶形运算的成本：\n$$\nC_{\\text{FFT}} = (\\log_2 N) \\times \\Big(\\frac{N}{2}\\Big) \\times 10 = 5N \\log_2 N \\text{ FLOPS}.\n$$\n我们假设逆 FFT 的计算成本与正向 FFT 相同，这是一个标准假设。\n\n总成本 $C_F$ 是正向 FFT、逐点乘法和逆 FFT 的成本之和。\n- $x[n]$ 的正向 FFT 成本：$5N \\log_2 N$。\n- $N$ 次逐点复数乘法 $X[k]H[k]$ 的成本：$N \\times (6 \\text{ FLOPS/次乘法}) = 6N$。\n- 逆 FFT 的成本：$5N \\log_2 N$。\n\n将这些部分相加，得到基于 FFT 的方法的总成本：\n$$\nC_F = 5N \\log_2 N + 6N + 5N \\log_2 N = 10N \\log_2 N + 6N.\n$$\n\n盈亏平衡点 $K_{\\text{be}}$ 是两种成本相等时的 $K$ 值：$C_D(K_{\\text{be}}) = C_F$。\n$$\nN(8K_{\\text{be}}-2) = 10N \\log_2 N + 6N.\n$$\n由于 $N=4096 \\neq 0$，我们可以将整个方程除以 $N$：\n$$\n8K_{\\text{be}}-2 = 10 \\log_2 N + 6.\n$$\n现在，我们求解 $K_{\\text{be}}$：\n$$\n8K_{\\text{be}} = 10 \\log_2 N + 8.\n$$\n$$\nK_{\\text{be}} = \\frac{10 \\log_2 N + 8}{8} = \\frac{5}{4}\\log_2 N + 1.\n$$\n问题指定 $N=4096$。我们计算 $\\log_2 N$：\n$$\n\\log_2(4096) = \\log_2(2^{12}) = 12.\n$$\n将此值代入 $K_{\\text{be}}$ 的表达式中：\n$$\nK_{\\text{be}} = \\frac{5}{4}(12) + 1 = 5 \\times 3 + 1 = 15 + 1 = 16.\n$$\n因此，当稀疏度为 $K=16$ 时，两种方法的计算成本相同。对于 $K16$，直接方法更有效。对于 $K>16$，基于 FFT 的方法更有效。确切的盈亏平衡稀疏度是 $16$。", "answer": "$$\\boxed{16}$$", "id": "2896155"}]}