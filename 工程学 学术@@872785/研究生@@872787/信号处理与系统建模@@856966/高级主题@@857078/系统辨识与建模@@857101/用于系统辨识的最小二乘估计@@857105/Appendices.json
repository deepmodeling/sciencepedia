{"hands_on_practices": [{"introduction": "一次成功的系统辨识实验极大地依赖于所用输入信号的质量。这个练习探讨了“持续激励”（persistency of excitation）这一核心概念，它为输入信号需具备足够的“丰富性”以区分所有系统参数提供了形式化要求。通过这个实践，您将具体地看到当一个FIR模型使用简单的单音正弦信号作为输入时，激励条件不被满足会发生什么，并理解为什么这会导致参数的不可辨识性[@problem_id:2880081]。", "problem": "考虑一个$m$阶离散时间、线性时不变的有限冲激响应(FIR)模型，其输入输出关系为 $y[k] = \\sum_{\\ell=0}^{m-1} h_{\\ell} u[k-\\ell] + v[k]$，其中 $h_{\\ell}$ 是未知的实系数，$u[k]$ 是已知输入，$v[k]$ 是与 $u[k]$ 不相关的附加零均值测量噪声。您收集了 $N$ 个连续样本 $\\{(u[k], y[k])\\}_{k=0}^{N-1}$，其中 $N \\geq m+1$。令回归向量为 $x[k] \\triangleq [u[k], u[k-1], \\dots, u[k-m+1]]^{\\top} \\in \\mathbb{R}^{m}$，最小二乘法向矩阵为 $S_N \\triangleq \\sum_{k=m-1}^{N-1} x[k] x[k]^{\\top} \\in \\mathbb{R}^{m \\times m}$。$h = [h_0, \\dots, h_{m-1}]^{\\top}$ 的最小二乘估计量要求 $S_N$ 是可逆的，而$m$阶持续激励（在无噪声极限下）等价于 $S_N$ 是正定的。假设您使用一个单音正弦输入 $u[k] = A \\cos(\\omega k + \\phi)$ 来驱动该系统，其振幅 $A \\neq 0$ 非零，频率 $\\omega \\in (0, \\pi)$，相位 $\\phi \\in \\mathbb{R}$ 为任意值。假设 $m \\geq 3$，并在大样本意义下（$N \\to \\infty$）解释 $S_N$，使得在 $u[k]$ 平稳的条件下，样本均值收敛于其期望值。\n\n仅从上述设置、FIR模型的线性性质、法向矩阵 $S_N$ 的定义以及三角和角恒等式出发，确定当输入 $u[k]$ 是指定的单音正弦波时，从 $\\{(u[k], y[k])\\}$ 数据通过最小二乘法无法辨识的系数子空间的精确维度（作为 $m$ 的函数）。将您的最终答案表示为关于 $m$ 的单个闭式表达式。无需单位，也无需四舍五入。", "solution": "问题要求解的是，当输入为单音正弦波时，对于一个 $m$ 阶有限冲激响应(FIR)模型，其系数向量 $h = [h_0, h_1, \\dots, h_{m-1}]^{\\top}$ 的不可辨识子空间的维度。该FIR模型由关系式 $y[k] = \\sum_{\\ell=0}^{m-1} h_{\\ell} u[k-\\ell] + v[k]$ 给出。\n\n如果一个系数向量 $h$ 对无噪声输出的贡献恒为零，则该向量是不可辨识的。在此条件下，不同的参数向量会产生相同的输出，导致它们无法通过输入输出数据加以区分。在数学上，这对应于所有满足在所有时间 $k$ 回归量-参数乘积为零的向量 $h \\in \\mathbb{R}^{m}$ 的集合。这类向量 $h$ 构成的空间恰好是渐近最小二乘法向矩阵 $S = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k} x[k]x[k]^{\\top}$ 的零空间，其中 $x[k]$ 是回归向量。因此，我们的任务是找到这个零空间的维度。\n\n向量 $h$ 位于不可辨识子空间中的条件是：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} u[k-\\ell] = 0 \\quad \\text{对所有 } k\n$$\n输入信号为 $u[k] = A \\cos(\\omega k + \\phi)$，其中振幅 $A$ 非零，频率 $\\omega \\in (0, \\pi)$，相位 $\\phi$ 是某个实常数。将此代入条件中，我们得到：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} A \\cos(\\omega(k-\\ell) + \\phi) = 0\n$$\n由于 $A \\neq 0$，两边同除以 $A$：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\cos(\\omega k - \\omega \\ell + \\phi) = 0\n$$\n我们应用三角和角恒等式 $\\cos(\\alpha - \\beta) = \\cos(\\alpha)\\cos(\\beta) + \\sin(\\alpha)\\sin(\\beta)$。令 $\\alpha = \\omega k + \\phi$ 和 $\\beta = \\omega \\ell$。方程变为：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\left( \\cos(\\omega k + \\phi)\\cos(\\omega \\ell) + \\sin(\\omega k + \\phi)\\sin(\\omega \\ell) \\right) = 0\n$$\n我们可以通过提出依赖于 $k$ 的项来重新整理求和：\n$$\n\\cos(\\omega k + \\phi) \\left( \\sum_{\\ell=0}^{m-1} h_{\\ell} \\cos(\\omega \\ell) \\right) + \\sin(\\omega k + \\phi) \\left( \\sum_{\\ell=0}^{m-1} h_{\\ell} \\sin(\\omega \\ell) \\right) = 0\n$$\n此方程必须对所有时间步 $k$ 成立。对于 $\\omega \\in (0, \\pi)$，时间函数 $f_1(k) = \\cos(\\omega k + \\phi)$ 和 $f_2(k) = \\sin(\\omega k + \\phi)$ 是线性无关的。若要让一组线性无关函数的线性组合对自变量的所有值都恒为零，则这些函数的系数必须全部为零。这就对系数向量 $h = [h_0, h_1, \\dots, h_{m-1}]^{\\top}$ 产生了两个独立的线性约束：\n\n约束 1：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\cos(\\omega \\ell) = 0\n$$\n约束 2：\n$$\n\\sum_{\\ell=0}^{m-1} h_{\\ell} \\sin(\\omega \\ell) = 0\n$$\n不可辨识子空间是这个包含 $m$ 个未知数 $\\{h_0, h_1, \\dots, h_{m-1}\\}$ 的双线性方程组的解空间。为了求出这个解空间的维度，我们必须验证这两个约束确实是线性无关的。\n\n我们可以将这些约束写成向量形式。令 $c = [\\cos(0), \\cos(\\omega), \\dots, \\cos((m-1)\\omega)]^{\\top}$ 和 $s = [\\sin(0), \\sin(\\omega), \\dots, \\sin((m-1)\\omega)]^{\\top}$。该方程组为：\n$$\nc^{\\top} h = 0\n$$\n$$\ns^{\\top} h = 0\n$$\n这两个约束的线性无关性等价于向量 $c$ 和 $s$ 的线性无关性。让我们假设 $c$ 和 $s$ 的某个线性组合是零向量：$\\alpha c + \\beta s = 0$，其中 $\\alpha, \\beta \\in \\mathbb{R}$ 为标量。\n\n对索引为 $\\ell=0$ 的元素，分量形式写出：\n$$\n\\alpha \\cos(0) + \\beta \\sin(0) = 0 \\implies \\alpha \\cdot 1 + \\beta \\cdot 0 = 0 \\implies \\alpha = 0\n$$\n当 $\\alpha=0$ 时，条件简化为 $\\beta s = 0$。向量 $s$ 是零向量当且仅当对于所有 $\\ell = 1, \\dots, m-1$，都有 $\\sin(\\omega \\ell) = 0$。这将要求对于每个这样的 $\\ell$，$\\omega \\ell$ 都必须是 $\\pi$ 的倍数。对于 $\\ell=1$ 的情况，这意味着 $\\omega$ 必须是 $\\pi$ 的倍数。然而，问题指明 $\\omega \\in (0, \\pi)$，这明确排除了 $\\omega$ 是 $\\pi$ 的倍数的可能性。因此，向量 $s$ 不是零向量。\n既然 $\\beta s = 0$ 且 $s \\neq 0$，那么必然有 $\\beta = 0$。\n唯一的解是 $\\alpha=0$ 和 $\\beta=0$，这证明了向量 $c$ 和 $s$ 是线性无关的。\n\n我们得到了一个包含 $m$ 个变量的两个线性无关的齐次方程组。解空间（即不可辨识子空间）的维度由变量数减去独立约束数给出。\n$$\n\\text{不可辨识子空间的维度} = m - 2\n$$\n这个结果对 $m \\geq 2$ 成立。问题条件 $m \\geq 3$ 是该结论有效的一个特例。因此，从给定的正弦输入通过最小二乘法无法辨识的系数向量子空间的维度是 $m-2$。", "answer": "$$\n\\boxed{m-2}\n$$", "id": "2880081"}, {"introduction": "在确保输入信号具有充分激励性之后，系统辨识中的下一个常见挑战是处理噪声的结构。标准的最小二乘法假设噪声是不相关的，但许多实际系统更适合用ARMAX模型来描述，其中噪声是有色的。本练习将引导您推导一种预滤波（或“白化”）技术，通过对模型进行变换，使得即使在存在相关噪声的情况下，普通最小二乘法也能成为一致的估计器[@problem_id:2880109]。", "problem": "考虑一个单输入单输出、离散时间的带外源输入的自回归移动平均 (ARMAX) 模型，该模型由一个零均值、独立同分布的高斯序列驱动，\n$$A(q) \\, y(t) \\;=\\; q^{-n_k} B(q) \\, u(t) \\;+\\; C(q) \\, e(t),$$\n其中 $q^{-1}$ 是单位延迟移位算子，$A(q) = 1 + a_{1} q^{-1} + \\cdots + a_{n_{a}} q^{-n_{a}}$，$B(q) = b_{0} + b_{1} q^{-1} + \\cdots + b_{n_{b}} q^{-n_{b}}$，$C(q) = 1 + c_{1} q^{-1} + \\cdots + c_{n_{c}} q^{-n_{c}}$ 是已知的、首一的、稳定的且最小相位的多项式，$n_k \\in \\mathbb{N}$ 是已知的输入延迟，输入 $u(t)$ 与 $e(t)$ 无关且是充分高阶的持续激励，数据 $\\{u(t),y(t)\\}$ 由一个稳定、时不变的系统生成，使得最小二乘法一致性的标准正则性条件（有界矩、遍历性、可辨识性）成立。目标是通过对一个线性回归模型使用普通最小二乘法来估计对象参数向量 $\\theta_{p} = \\begin{pmatrix} a_{1}  \\cdots  a_{n_{a}}  b_{0}  \\cdots  b_{n_{b}} \\end{pmatrix}^{\\top}$。\n\n请从第一性原理出发，推导一个因果、稳定、线性时不变的预滤波器 $L(q)$，该滤波器仅用 $C(q)$ 显式表示，并可由已知的 $C(q)$ 实现。当将 $L(q)$ 应用于 ARMAX 方程的两边时，得到的线性回归\n$$y_{L}(t) \\;=\\; \\varphi_{L}(t)^{\\top} \\theta_{p} \\;+\\; \\varepsilon_{L}(t)$$\n具有一个白噪声零均值扰动 $\\varepsilon_{L}(t)$，该扰动与回归量 $\\varphi_{L}(t)$ 不相关，从而在所述假设下，能够得到 $\\theta_{p}$ 的一个一致的普通最小二乘估计。你的推导必须从模型定义和所述假设开始，并且必须证明为什么在预滤波后扰动会变成白噪声，以及为什么它与回归量不相关。\n\n最终答案必须是预滤波器 $L(q)$ 关于 $C(q)$ 的解析表达式。请勿在最终答案中提供任何中间表达式或多个表达式；仅给出作为闭式解析表达式的单个算子 $L(q)$。本问题无需进行数值四舍五入。", "solution": "出发点是ARMAX模型方程：\n$$A(q) \\, y(t) = q^{-n_k} B(q) \\, u(t) + C(q) \\, e(t)$$\n我们的目标是估计包含在向量 $\\theta_p$ 中的 $A(q)$ 和 $B(q)$ 的参数。我们可以将模型重写为标准的线性回归形式。利用 $A(q) = 1 + (A(q) - 1)$，我们有：\n$$y(t) + (A(q) - 1)y(t) = q^{-n_k} B(q) u(t) + C(q) e(t)$$\n分离出 $y(t)$ 可得：\n$$y(t) = -(A(q) - 1)y(t) + q^{-n_k} B(q) u(t) + C(q) e(t)$$\n这个方程具有线性回归的结构，可以表示为：\n$$y(t) = \\varphi(t)^{\\top} \\theta_{p} + v(t)$$\n其中回归量向量 $\\varphi(t)$ 和参数向量 $\\theta_p$ 由下式给出：\n$$\\varphi(t)^{\\top} = \\begin{pmatrix} -y(t-1)  \\cdots  -y(t-n_a)  u(t-n_k)  \\cdots  u(t-n_k-n_b) \\end{pmatrix}$$\n$$\\theta_{p} = \\begin{pmatrix} a_{1}  \\cdots  a_{n_{a}}  b_{0}  \\cdots  b_{n_{b}} \\end{pmatrix}^{\\top}$$\n方程误差，或称扰动，是：\n$$v(t) = C(q) e(t) = (1 + c_{1} q^{-1} + \\cdots + c_{n_{c}} q^{-n_{c}}) e(t) = e(t) + c_{1} e(t-1) + \\cdots + c_{n_{c}} e(t-n_{c})$$\n为了使 $\\theta_p$ 的普通最小二乘(OLS)估计量具有一致性，一个必要条件是扰动 $v(t)$ 必须与回归量向量 $\\varphi(t)$ 不相关，即 $E[\\varphi(t) v(t)] = \\mathbf{0}$。\n\n我们来检验这个条件。扰动 $v(t)$ 是白噪声序列 $e(t)$ 的一个移动平均过程。由于 $C(q)$（在一般情况下）不等于1，$v(t)$ 是一个有色噪声序列。回归量 $\\varphi(t)$ 包含输出的过去值，$y(t-k)$ (其中 $k \\ge 1$)。输出 $y(t)$ 是所有过去输入 $u(s)$ 和噪声 $e(s)$ (其中 $s \\le t$) 的函数。因此，像 $y(t-1)$ 这样的回归量分量依赖于 $e(t-1), e(t-2), \\dots$。扰动 $v(t)$ 也因为项 $c_1 e(t-1), c_2 e(t-2), \\dots$ 而依赖于 $e(t-1), e(t-2), \\dots$。因此，$y(t-1)$ 和 $v(t)$ 是相关的。这导致 $E[\\varphi(t) v(t)] \\neq \\mathbf{0}$，违反了OLS的一致性条件。$\\theta_p$ 的OLS估计将是有偏且不一致的。\n\n为了解决此问题，我们必须对系统方程进行预滤波，使得新的扰动项是白噪声且与新的回归量不相关。设 $L(q)$ 是一个因果、稳定、线性时不变的滤波器。将此预滤波器应用于原始ARMAX方程的两边可得：\n$$L(q) A(q) y(t) = L(q) q^{-n_k} B(q) u(t) + L(q) C(q) e(t)$$\n新的扰动项是 $\\varepsilon_{L}(t) = L(q) C(q) e(t)$。为使此扰动成为白噪声序列，我们必须选择 $L(q)$，使得算子 $L(q) C(q)$ 不引入任何时间相关性。由于 $e(t)$ 已经是白噪声，对于 $L(q) C(q)$ 最简单的选择是单位算子 1。因此，我们要求：\n$$L(q) C(q) = 1$$\n这意味着预滤波器必须是噪声动态算子 $C(q)$ 的逆：\n$$L(q) = C(q)^{-1} = \\frac{1}{C(q)}$$\n这个选择是可行的，因为问题陈述 $C(q)$ 是已知的。此外，问题陈述 $C(q)$ 是一个稳定且首一的多项式算子。如果多项式 $P(z)=0$ 的所有根都严格位于单位圆 $|z|1$ 内部，则称多项式算子 $P(q)$ 是稳定的。滤波器 $L(q) = 1/C(q)$ 的稳定性由其极点决定，即 $C(z)=0$ 的根。由于 $C(q)$ 是稳定的，滤波器 $L(q)$ 保证是稳定的。$C(q)$ 的首一性质（即 $C(q) = 1 + \\sum_{i=1}^{n_c} c_i q^{-i}$）确保了 $L(q)$ 是因果的。最小相位的性质与此稳定性要求相关且一致。\n\n选择了 $L(q) = C(q)^{-1}$ 后，预滤波后的方程变为：\n$$C(q)^{-1} A(q) y(t) = C(q)^{-1} q^{-n_k} B(q) u(t) + e(t)$$\n我们将预滤波后的输出和输入信号定义为 $y_{L}(t) = C(q)^{-1} y(t)$ 和 $u_{L}(t) = C(q)^{-1} u(t)$。该方程可以写成：\n$$A(q) y_{L}(t) = q^{-n_k} B(q) u_{L}(t) + e(t)$$\n将其重排为回归形式可得：\n$$y_{L}(t) = -(A(q) - 1) y_{L}(t) + q^{-n_k} B(q) u_{L}(t) + e(t)$$\n这与期望的回归模型 $y_{L}(t) = \\varphi_{L}(t)^{\\top} \\theta_{p} + \\varepsilon_{L}(t)$ 相匹配，其中：\n- 新的扰动是 $\\varepsilon_{L}(t) = e(t)$。根据定义，$e(t)$ 是一个零均值白噪声序列。\n- 新的回归量是 $\\varphi_{L}(t)^{\\top} = \\begin{pmatrix} -y_{L}(t-1)  \\cdots  -y_{L}(t-n_a)  u_{L}(t-n_k)  \\cdots  u_{L}(t-n_k-n_b) \\end{pmatrix}$。\n\n我们现在必须验证新的回归量 $\\varphi_{L}(t)$ 与新的扰动 $\\varepsilon_{L}(t) = e(t)$ 不相关。$\\varphi_{L}(t)$ 的分量是 $y_L(t-j)$ 和 $u_L(t-k-j)$（其中 $j \\ge 1$）。由于 $L(q)=C(q)^{-1}$ 是一个因果滤波器，$y_L(t-j)$ 和 $u_L(t-k-j)$ 是截至时刻 $t-j$ 的 $y$ 和 $u$ 的当前值和过去值的函数。具体来说，$y_{L}(t-j)$ 依赖于 $\\{y(s) | s \\le t-j\\}$，$u_{L}(t-k-j)$ 依赖于 $\\{u(s) | s \\le t-k-j\\}$。因为整个系统是因果且稳定的，输出 $y(s)$ 仅依赖于 $\\tau \\le s$ 的输入 $u(\\tau)$ 和噪声 $e(\\tau)$。因此，回归量 $\\varphi_{L}(t)$ 的所有分量都是 $\\{u(\\tau), e(\\tau) | \\tau \\le t-1\\}$ 的函数。扰动是 $e(t)$。由于 $e(t)$ 是一个独立同分布序列，根据定义，它与其所有过去值 $e(\\tau)$ (其中 $\\tau  t$) 不相关。输入 $u(t)$ 也被指定为与 $e(t)$ 无关。因此，$e(t)$ 与任何过去输入和过去噪声的函数都不相关。\n这就证明了 $E[\\varphi_{L}(t) \\varepsilon_{L}(t)] = \\mathbf{0}$。\n\n转换后的回归模型满足OLS一致性的关键条件。因此，对这个预滤波后的模型应用OLS将得到 $\\theta_p$ 的一个一致估计。实现这一目标的所需预滤波器 $L(q)$ 是噪声多项式模型 $C(q)$ 的逆。", "answer": "$$\\boxed{\\frac{1}{C(q)}}$$", "id": "2880109"}, {"introduction": "最后，我们将关注求解最小二乘问题的实际计算方面。即使理论上问题是适定的（即输入具有持续激励性且噪声已妥善处理），找到解的数值过程本身也可能充满挑战。本练习探讨了“病态”（ill-conditioning）问题，即当回归量向量近似线性相关时，会导致数值不稳定。通过一个具体的例子并计算条件数，您将理解为什么在实践中，像QR分解或SVD这样数值稳健的算法，相比于直接求解正规方程，是更受青睐的选择[@problem_id:2880119]。", "problem": "考虑一个具有两个未知抽头增益的离散时间、有限脉冲响应线性时不变系统的辨识问题。设输入序列为 $u[k]$，输出序列为 $y[k]$，当 $k \\in \\{1,2,3\\}$ 时，其参数模型为 $y[k] \\approx \\theta_{0} u[k] + \\theta_{1} u[k-1]$。令输入和输出数据如下：$u[0] = 1$, $u[1] = 1$, $u[2] = 1$, $u[3] = 1 + \\delta$ (其中 $\\delta = 1 \\times 10^{-8}$)，以及 $y[1] = 2$, $y[2] = 2 + \\varepsilon$, $y[3] = 2 + \\varepsilon$ (其中 $\\varepsilon = 1 \\times 10^{-4}$)。构造最小二乘数据矩阵 $\\Phi \\in \\mathbb{R}^{3 \\times 2}$ 和向量 $\\mathbf{y} \\in \\mathbb{R}^{3}$ 如下：\n$$\n\\Phi \\triangleq \\begin{bmatrix}\nu[1]  u[0] \\\\\nu[2]  u[1] \\\\\nu[3]  u[2]\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1  1 \\\\\n1  1 \\\\\n1 + \\delta  1\n\\end{bmatrix},\n\\quad\n\\mathbf{y} \\triangleq \\begin{bmatrix}\ny[1] \\\\\ny[2] \\\\\ny[3]\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2 \\\\\n2 + \\varepsilon \\\\\n2 + \\varepsilon\n\\end{bmatrix}.\n$$\n你需要通过最小化最小二乘 (LS) 准则 $J(\\boldsymbol{\\theta}) \\triangleq \\|\\Phi \\boldsymbol{\\theta} - \\mathbf{y}\\|_{2}^{2}$ 来估计 $\\boldsymbol{\\theta} \\in \\mathbb{R}^{2}$。仅从最小二乘问题的核心定义以及正交三角 (QR) 分解和奇异值分解 (SVD) 的定义出发，用精确算术完成以下任务：(i) 使用 $\\Phi$ 的 QR 分解来描述 LS 最小化器和最小残差范数；(ii) 使用 $\\Phi$ 的 SVD 来描述 LS 最小化器和最小残差范数；(iii) 解释为什么 (i) 和 (ii) 中得到的残差范数必须一致；(iv) 以 $\\delta$ 的符号形式计算 2-范数条件数 $\\kappa_{2}(\\Phi)$，然后在 $\\delta = 1 \\times 10^{-8}$ 处求值，以证明该问题是严重病态的；(v) 最后，报告在给定 $\\varepsilon = 1 \\times 10^{-4}$ 时，最小残差 2-范数 $\\|\\Phi \\boldsymbol{\\theta}_{\\star} - \\mathbf{y}\\|_{2}$ 的数值，四舍五入到四位有效数字。你最终报告的答案必须是单个标量值的最小残差 2-范数，无单位，并按要求四舍五入到四位有效数字。", "solution": "问题是求解 $\\boldsymbol{\\theta} = [\\theta_0, \\theta_1]^T$，以最小化最小二乘准则 $J(\\boldsymbol{\\theta}) = \\|\\Phi \\boldsymbol{\\theta} - \\mathbf{y}\\|_{2}^{2}$，其中\n$$\n\\Phi =\n\\begin{bmatrix}\n1  1 \\\\\n1  1 \\\\\n1 + \\delta  1\n\\end{bmatrix}\n, \\quad\n\\mathbf{y} =\n\\begin{bmatrix}\n2 \\\\\n2 + \\varepsilon \\\\\n2 + \\varepsilon\n\\end{bmatrix}.\n$$\n最小化此准则的向量 $\\Phi\\boldsymbol{\\theta}_{\\star}$ 是 $\\mathbf{y}$ 在 $\\Phi$ 的列空间（记作 $\\mathcal{C}(\\Phi)$）上的正交投影。最小残差向量是 $\\mathbf{r}_{\\star} = \\mathbf{y} - \\Phi\\boldsymbol{\\theta}_{\\star}$，它是 $\\mathbf{y}$ 在列空间的正交补 $\\mathcal{C}(\\Phi)^{\\perp}$ 上的投影。最小残差范数为 $\\|\\mathbf{r}_{\\star}\\|_2$。\n\n(i) 使用 QR 分解进行描述\n设 $\\Phi \\in \\mathbb{R}^{3 \\times 2}$ 的完全 QR 分解为 $\\Phi = QR$，其中 $Q \\in \\mathbb{R}^{3 \\times 3}$ 是一个正交矩阵 ($Q^T Q = I_3$)，$R \\in \\mathbb{R}^{3 \\times 2}$ 是一个上三角矩阵。我们将 $Q$ 分块为 $Q = [Q_1 | Q_2]$，其中 $Q_1 \\in \\mathbb{R}^{3 \\times 2}$ 的列构成了 $\\mathcal{C}(\\Phi)$ 的一组标准正交基，而 $Q_2 \\in \\mathbb{R}^{3 \\times 1}$ 的列构成了 $\\mathcal{C}(\\Phi)^{\\perp}$ 的一组标准正交基。矩阵 $R$ 分块为 $R = \\begin{bmatrix} R_1 \\\\ 0 \\end{bmatrix}$，其中 $R_1 \\in \\mathbb{R}^{2 \\times 2}$ 是一个上三角矩阵，并且由于 $\\Phi$ 是满列秩的，所以 $R_1$ 是可逆的。\n\n目标函数变为：\n$$ J(\\boldsymbol{\\theta}) = \\|\\Phi\\boldsymbol{\\theta} - \\mathbf{y}\\|_2^2 = \\|QR\\boldsymbol{\\theta} - \\mathbf{y}\\|_2^2 = \\|Q^T(QR\\boldsymbol{\\theta} - \\mathbf{y})\\|_2^2 = \\|R\\boldsymbol{\\theta} - Q^T\\mathbf{y}\\|_2^2 $$\n使用分块形式：\n$$ J(\\boldsymbol{\\theta}) = \\left\\| \\begin{bmatrix} R_1 \\\\ 0 \\end{bmatrix} \\boldsymbol{\\theta} - \\begin{bmatrix} Q_1^T \\mathbf{y} \\\\ Q_2^T \\mathbf{y} \\end{bmatrix} \\right\\|_2^2 = \\|R_1\\boldsymbol{\\theta} - Q_1^T\\mathbf{y}\\|_2^2 + \\|Q_2^T\\mathbf{y}\\|_2^2 $$\n通过适当地选择 $\\boldsymbol{\\theta}$，第一项可以变为零，而第二项与 $\\boldsymbol{\\theta}$ 无关。因此，当 $R_1\\boldsymbol{\\theta}_{\\star} = Q_1^T\\mathbf{y}$ 时，$J(\\boldsymbol{\\theta})$ 达到最小值。LS 最小化器为 $\\boldsymbol{\\theta}_{\\star} = R_1^{-1}Q_1^T\\mathbf{y}$。\n最小残差范数的平方是 $\\|Q_2^T\\mathbf{y}\\|_2^2$。因此，最小残差范数为 $\\|\\Phi\\boldsymbol{\\theta}_{\\star} - \\mathbf{y}\\|_2 = \\|Q_2^T\\mathbf{y}\\|_2$。\n\n(ii) 使用奇异值分解 (SVD) 进行描述\n设 $\\Phi$ 的 SVD 为 $\\Phi = U\\Sigma V^T$，其中 $U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{2 \\times 2}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{3 \\times 2}$ 是由奇异值 $\\sigma_1 \\ge \\sigma_2  0$ 构成的对角矩阵。我们将 $U$ 分块为 $U = [\\mathbf{u}_1, \\mathbf{u}_2, \\mathbf{u}_3]$。列向量 $\\{\\mathbf{u}_1, \\mathbf{u}_2\\}$ 构成了 $\\mathcal{C}(\\Phi)$ 的一组标准正交基，而 $\\mathbf{u}_3$ 构成了 $\\mathcal{C}(\\Phi)^{\\perp}$ (即 $\\Phi^T$ 的零空间) 的一组标准正交基。\n\nLS 最小化器由 $\\boldsymbol{\\theta}_{\\star} = \\Phi^+\\mathbf{y}$ 给出，其中 $\\Phi^+ = V\\Sigma^+U^T$ 是 Moore-Penrose 伪逆。这里，$\\Sigma^+ = \\begin{pmatrix} 1/\\sigma_1  0  0 \\\\ 0  1/\\sigma_2  0 \\end{pmatrix}$。\n$\\mathbf{y}$ 在 $\\mathcal{C}(\\Phi)$ 上的投影是 $\\Phi\\boldsymbol{\\theta}_{\\star} = \\Phi\\Phi^+\\mathbf{y} = U\\Sigma V^T V\\Sigma^+ U^T \\mathbf{y} = U(\\Sigma\\Sigma^+)U^T\\mathbf{y}$。\n由于 $\\Sigma\\Sigma^+ = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}$，该投影为 $(\\mathbf{u}_1\\mathbf{u}_1^T + \\mathbf{u}_2\\mathbf{u}_2^T)\\mathbf{y}$。\n最小残差向量是 $\\mathbf{r}_{\\star} = \\mathbf{y} - \\Phi\\boldsymbol{\\theta}_{\\star} = \\mathbf{y} - (\\mathbf{u}_1\\mathbf{u}_1^T + \\mathbf{u}_2\\mathbf{u}_2^T)\\mathbf{y}$。\n因为 $I = U U^T = \\mathbf{u}_1\\mathbf{u}_1^T + \\mathbf{u}_2\\mathbf{u}_2^T + \\mathbf{u}_3\\mathbf{u}_3^T$，我们有 $\\mathbf{r}_{\\star} = \\mathbf{u}_3\\mathbf{u}_3^T\\mathbf{y} = (\\mathbf{u}_3^T\\mathbf{y})\\mathbf{u}_3$。\n最小残差范数是 $\\|\\mathbf{r}_{\\star}\\|_2 = \\|(\\mathbf{u}_3^T\\mathbf{y})\\mathbf{u}_3\\|_2 = |\\mathbf{u}_3^T\\mathbf{y}| \\|\\mathbf{u}_3\\|_2 = |\\mathbf{u}_3^T\\mathbf{y}|$。\n\n(iii) 残差范数的一致性\n最小二乘解 $\\Phi\\boldsymbol{\\theta}_{\\star}$ 在几何上被定义为向量 $\\mathbf{y}$ 在子空间 $\\mathcal{C}(\\Phi)$ 上的唯一正交投影。因此，最小残差向量 $\\mathbf{r}_{\\star} = \\mathbf{y} - \\Phi\\boldsymbol{\\theta}_{\\star}$ 是 $\\mathbf{y}$ 在正交补子空间 $\\mathcal{C}(\\Phi)^{\\perp}$ 上的唯一正交投影。最小残差范数 $\\|\\mathbf{r}_{\\star}\\|_2$ 是这个唯一投影的长度。\nQR 和 SVD 方法都提供了构造 $\\mathcal{C}(\\Phi)^{\\perp}$ 的标准正交基的方法。对于 QR 分解，这组基由 $Q_2$ 的列给出。对于 SVD，它由 $U$ 中对应于零奇异值的列（这里是 $\\mathbf{u}_3$）给出。虽然基本身可能不同（最多相差一个符号），但它们张成的子空间是相同的，并且 $\\mathbf{y}$ 在该子空间上的投影长度是唯一的。因此，从两种方法推导出的最小残差范数必须是相等的。\n\n(iv) 条件数\n2-范数条件数是 $\\kappa_2(\\Phi) = \\sigma_{\\max}/\\sigma_{\\min} = \\sigma_1/\\sigma_2$。奇异值的平方 $\\sigma_1^2, \\sigma_2^2$ 是 $\\Phi^T\\Phi$ 的特征值。\n$$ \\Phi^T\\Phi = \\begin{bmatrix} 1  1  1+\\delta \\\\ 1  1  1 \\end{bmatrix} \\begin{bmatrix} 1  1 \\\\ 1  1 \\\\ 1+\\delta  1 \\end{bmatrix} = \\begin{bmatrix} 3+2\\delta+\\delta^2  3+\\delta \\\\ 3+\\delta  3 \\end{bmatrix} $$\n特征方程 $\\det(\\Phi^T\\Phi - \\lambda I) = 0$ 为 $\\lambda^2 - (6+2\\delta+\\delta^2)\\lambda + 2\\delta^2 = 0$。\n特征值为 $\\lambda_{1,2} = \\frac{1}{2}(6+2\\delta+\\delta^2 \\pm \\sqrt{(6+2\\delta+\\delta^2)^2 - 8\\delta^2})$。\n所以 $\\sigma_1^2 = \\lambda_1$ 且 $\\sigma_2^2 = \\lambda_2$。\n$$ \\kappa_2(\\Phi)^2 = \\frac{\\sigma_1^2}{\\sigma_2^2} = \\frac{6+2\\delta+\\delta^2 + \\sqrt{(6+2\\delta+\\delta^2)^2 - 8\\delta^2}}{6+2\\delta+\\delta^2 - \\sqrt{(6+2\\delta+\\delta^2)^2 - 8\\delta^2}} $$\n分子和分母同乘以分子，得到：\n$$ \\kappa_2(\\Phi)^2 = \\frac{\\left(6+2\\delta+\\delta^2 + \\sqrt{(6+2\\delta+\\delta^2)^2 - 8\\delta^2}\\right)^2}{(6+2\\delta+\\delta^2)^2 - ((6+2\\delta+\\delta^2)^2 - 8\\delta^2)} = \\frac{\\left(6+2\\delta+\\delta^2 + \\sqrt{(6+2\\delta+\\delta^2)^2 - 8\\delta^2}\\right)^2}{8\\delta^2} $$\n取平方根，并假设 $\\delta0$：\n$$ \\kappa_2(\\Phi) = \\frac{6+2\\delta+\\delta^2 + \\sqrt{(6+2\\delta+\\delta^2)^2 - 8\\delta^2}}{2\\sqrt{2}\\delta} $$\n对于 $\\delta = 1 \\times 10^{-8}$，$\\delta^2$ 可忽略不计。$\\kappa_2(\\Phi) \\approx \\frac{6+2\\delta + \\sqrt{36+24\\delta}}{2\\sqrt{2}\\delta} \\approx \\frac{6+2\\delta + 6(1+\\frac{2}{3}\\delta)^{1/2}}{2\\sqrt{2}\\delta} \\approx \\frac{6+2\\delta + 6(1+\\frac{1}{3}\\delta)}{2\\sqrt{2}\\delta} = \\frac{12+4\\delta}{2\\sqrt{2}\\delta} \\approx \\frac{12}{2\\sqrt{2}\\delta} = \\frac{3\\sqrt{2}}{\\delta}$。\n$$ \\kappa_2(\\Phi) \\approx \\frac{3\\sqrt{2}}{1 \\times 10^{-8}} \\approx 4.2426 \\times 10^8 $$\n如此量级（$\\sim 10^8$）的条件数表明解 $\\boldsymbol{\\theta}$ 对 $\\Phi$ 或 $\\mathbf{y}$ 的微小扰动具有极高的敏感性。这是一个严重病态问题的特征，其原因在于当 $\\delta$ 很小时，$\\Phi$ 的列向量近似线性相关。\n\n(v) 最小残差范数计算\n为计算最小残差范数，我们找到 $\\mathcal{C}(\\Phi)^\\perp$（即 $\\Phi^T$ 的零空间）的一组基。设 $\\mathbf{x}=[x_1, x_2, x_3]^T$ 属于此零空间。\n$$ \\Phi^T\\mathbf{x} = \\begin{bmatrix} 1  1  1+\\delta \\\\ 1  1  1 \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} $$\n这给出了方程组 $x_1+x_2+(1+\\delta)x_3=0$ 和 $x_1+x_2+x_3=0$。用第一个方程减去第二个方程得到 $\\delta x_3 = 0$，因为 $\\delta \\neq 0$，所以这意味着 $x_3=0$。方程组简化为 $x_1+x_2=0$，即 $x_1=-x_2$。该零空间的一个基向量是 $[1, -1, 0]^T$。\n$\\mathcal{C}(\\Phi)^\\perp$ 的标准正交基是单位化后的向量，它对应于 SVD 中的 $\\mathbf{u}_3$ 或 QR 分解中的 $Q_2$ 的列。\n$$ \\mathbf{u}_3 = \\frac{1}{\\sqrt{1^2+(-1)^2+0^2}}\\begin{bmatrix} 1 \\\\ -1 \\\\ 0 \\end{bmatrix} = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1 \\\\ -1 \\\\ 0 \\end{bmatrix} $$\n最小残差范数是 $|\\mathbf{u}_3^T\\mathbf{y}|$。\n$$ \\|\\mathbf{r}_{\\star}\\|_2 = \\left| \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1  -1  0 \\end{bmatrix} \\begin{bmatrix} 2 \\\\ 2+\\varepsilon \\\\ 2+\\varepsilon \\end{bmatrix} \\right| = \\left| \\frac{1}{\\sqrt{2}}(2 - (2+\\varepsilon)) \\right| = \\left| \\frac{-\\varepsilon}{\\sqrt{2}} \\right| = \\frac{|\\varepsilon|}{\\sqrt{2}} $$\n给定 $\\varepsilon = 1 \\times 10^{-4}$，其数值为：\n$$ \\|\\mathbf{r}_{\\star}\\|_2 = \\frac{1 \\times 10^{-4}}{\\sqrt{2}} \\approx 0.70710678 \\times 10^{-4} = 7.0710678 \\times 10^{-5} $$\n四舍五入到四位有效数字，我们得到 $7.071 \\times 10^{-5}$。", "answer": "$$\n\\boxed{7.071 \\times 10^{-5}}\n$$", "id": "2880119"}]}