{"hands_on_practices": [{"introduction": "要有效地应用分离原理，我们首先必须精确理解其成立的理论基石。这个练习旨在检验你对线性二次高斯（LQG）控制器最优性条件的掌握程度 [@problem_id:2913855]。通过辨析一系列假设，你将巩固对分离原理为何以及在何种条件下成立的深刻认识，这是设计可靠的随机控制系统的第一步。", "problem": "考虑一个离散时间线性时不变 (LTI) 随机系统\n$$\nx_{k+1} = A x_k + B u_k + w_k, \\quad y_k = C x_k + v_k,\n$$\n其中 $x_k \\in \\mathbb{R}^{n}$ 是状态，$u_k \\in \\mathbb{R}^{m}$ 是控制输入，$y_k \\in \\mathbb{R}^{p}$ 是测量值。随机向量 $w_k$ 和 $v_k$ 是具有时不变二阶矩的零均值噪声过程，初始状态 $x_0$ 是具有有限二阶矩的随机向量。考虑部分可观测的无限时域二次型代价\n$$\nJ = \\mathbb{E}\\Bigg[\\sum_{k=0}^{\\infty} \\big(x_k^{\\top} Q x_k + u_k^{\\top} R u_k\\big)\\Bigg],\n$$\n其中 $Q \\succeq 0$ 且 $R \\succ 0$。假设我们使用输出反馈控制律\n$$\nu_k = -K \\,\\hat x_k,\n$$\n其中 $\\hat x_k$ 由（稳态）Kalman 滤波器产生，$K$ 是为完全可观测的线性二次型调节器 (LQR) 问题设计的常数状态反馈增益。\n\n根据随机最优控制和估计理论的基本原理，选择一组完整的假设，在此假设下，上述控制器在所有容许的输出反馈控制律中能够最小化 $J$。您的答案应指出哪个（些）选项给出了充分条件，这些条件在标准表述中是必要的，并且对于线性二次型高斯 (LQG) 分离原理在无限时域情况下成立是科学上最小的。\n\n选项：\n- A. 系统是线性时不变的；$w_k$ 和 $v_k$ 是零均值白色高斯过程，其协方差已知，相互独立且与 $x_0$ 独立；$Q \\succeq 0$, $R \\succ 0$，并且对 $(A,B)$ 和 $(A,C)$ 分别是能稳的 (stabilizable) 和能检测的 (detectable)，因此相关的代数 Riccati 方程存在镇定解；Kalman 滤波器使用正确的协方差，LQR 增益 $K$ 是为完全可观测问题计算的镇定状态反馈增益。在这些条件下，$u_k=-K\\hat x_k$ 是最优的。\n\n- B. 系统是线性时不变的；$w_k$ 和 $v_k$ 是零均值、有限方差（但不一定是高斯）的白噪声；$Q \\succeq 0$, $R \\succ 0$，并且 $(A,B)$ 是能稳的。即使 $(A,C)$ 不是能检测的且噪声非高斯，根据分离原理，$u_k=-K\\hat x_k$ 在所有可测的输出反馈律中仍然是全局最优的。\n\n- C. 系统是线性时不变的；测量矩阵 $C$ 具有满列秩；$Q \\succeq 0$, $R \\succ 0$。只要 $K$ 能镇定 $A-BK$，控制器 $u_k=-K\\hat x_k$ 就是最优的，无论噪声统计特性如何，因为闭环是稳定的。\n\n- D. 系统是线性时不变的；$(w_k, v_k)$ 是联合零均值白色高斯过程，其已知的二阶统计量可能包含非零的互协方差 $\\mathbb{E}[w_k v_k^{\\top}]\\neq 0$，并且与 $x_0$ 独立；$Q \\succeq 0$, $R \\succ 0$；问题数据使得稳态 Kalman 滤波器（考虑了互协方差）和 LQR 都存在镇定代数 Riccati 解；Kalman 滤波器和 $K$ 使用真实的协方差进行设计。在这些条件下，$u_k=-K\\hat x_k$ 是最优的。", "solution": "问题陈述需要经过验证。\n\n**步骤1：提取已知条件**\n-   离散时间线性时不变 (LTI) 随机系统：\n    $$x_{k+1} = A x_k + B u_k + w_k$$\n    $$y_k = C x_k + v_k$$\n-   状态向量：$x_k \\in \\mathbb{R}^{n}$\n-   控制输入：$u_k \\in \\mathbb{R}^{m}$\n-   测量输出：$y_k \\in \\mathbb{R}^{p}$\n-   过程噪声 $w_k$ 和测量噪声 $v_k$ 是具有时不变二阶矩的零均值随机向量。\n-   初始状态 $x_0$ 是具有有限二阶矩的随机向量。\n-   代价函数：无限时域二次型代价\n    $$J = \\mathbb{E}\\Bigg[\\sum_{k=0}^{\\infty} \\big(x_k^{\\top} Q x_k + u_k^{\\top} R u_k\\big)\\Bigg]$$\n-   代价矩阵属性：$Q \\succeq 0$ 且 $R \\succ 0$。\n-   提议的控制律：$u_k = -K \\,\\hat x_k$，这是一个输出反馈律。\n-   状态估计 $\\hat x_k$ 是稳态 Kalman 滤波器的输出。\n-   状态反馈增益 $K$ 是来自完全可观测的线性二次型调节器 (LQR) 问题的常数增益。\n-   问题：确定一组完整的假设，在此假设下，该控制器在所有容许的输出反馈控制律中能够最小化 $J$，特别关注那些在标准表述中是必要的、对于 LQG 分离原理成立而言在科学上是最小的充分条件。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题描述了一个离散时间 LTI 系统的典型线性二次型高斯 (LQG) 控制问题。这是现代随机控制理论的基石，并基于完善的数学原理。该问题在科学上是合理的。\n-   **适定性：** 该问题是适定的。它要求给出支撑著名的随机最优控制分离原理的标准假设，该原理为 LQG 问题提供了唯一且有意义的解。\n-   **客观性：** 问题使用精确、客观的数学语言陈述，没有任何主观性。\n-   **完整性和一致性：** 问题提供了一个具有二次型代价的 LTI 系统的一般框架，并要求给出确保特定控制器结构最优性所必需的具体假设。这种框架是有效的，不存在不完整或矛盾之处。\n\n**步骤3：结论和行动**\n问题陈述是有效的。这是一个控制理论中的标准、适定的问题。我将继续推导解决方案。\n\n**从基本原理推导**\n\n问题是找到一个控制序列 $\\{u_k\\}_{k=0}^\\infty$，其中每个 $u_k$ 是测量历史 $Y_k = \\{y_0, y_1, \\dots, y_k\\}$ 的因果函数，以最小化代价 $J$。这就是线性二次型高斯 (LQG) 问题。其解由著名的**分离原理**给出。\n\n该原理指出，最优控制器可以分两个独立的阶段进行设计：\n1.  **最优状态估计：** 基于测量值 $Y_k$ 为状态 $x_k$ 设计一个最优估计器。在最小化每个状态分量的均方误差意义下，最优估计是条件均值 $\\hat{x}_k = \\mathbb{E}[x_k | Y_k]$。对于具有高斯噪声的线性系统，这个最优估计由 Kalman 滤波器生成。\n2.  **最优状态反馈控制：** 解决确定性 LQR 问题，假设状态 $x_k$ 是完全已知的。这会得到最优状态反馈控制律 $u_k = -K x_k$。\n\n分离原理断言，最优随机控制器是通过在确定性最优控制律中用其最优估计 $\\hat{x}_k$ 简单地替换真实状态 $x_k$ 来获得的，从而得到 $u_k = -K \\hat{x}_k$。\n\n其数学证明依赖于代价函数的分解。设估计误差为 $\\tilde{x}_k = x_k - \\hat{x}_k$。代价函数可以重写为：\n$$J = \\mathbb{E}\\Bigg[\\sum_{k=0}^{\\infty} \\left( (\\hat{x}_k + \\tilde{x}_k)^{\\top} Q (\\hat{x}_k + \\tilde{x}_k) + u_k^{\\top} R u_k \\right)\\Bigg]$$\n展开此式得到：\n$$J = \\mathbb{E}\\Bigg[\\sum_{k=0}^{\\infty} \\left( \\hat{x}_k^{\\top} Q \\hat{x}_k + u_k^{\\top} R u_k + \\tilde{x}_k^{\\top} Q \\tilde{x}_k + 2\\hat{x}_k^{\\top} Q \\tilde{x}_k \\right)\\Bigg]$$\nKalman 滤波器的一个关键特性（当噪声是高斯时）是估计误差 $\\tilde{x}_k$ 是零均值，并且与测量历史 $Y_k$ 的所有函数的空间正交。由于 $\\hat{x}_k$ 是 $Y_k$ 的函数，交叉项的期望为零：$\\mathbb{E}[\\hat{x}_k^{\\top} Q \\tilde{x}_k] = 0$。\n代价函数分离为两个独立的部分：\n$$J = \\mathbb{E}\\Bigg[\\sum_{k=0}^{\\infty} \\big(\\hat{x}_k^{\\top} Q \\hat{x}_k + u_k^{\\top} R u_k \\big)\\Bigg] + \\mathbb{E}\\Bigg[\\sum_{k=0}^{\\infty} \\big(\\tilde{x}_k^{\\top} Q \\tilde{x}_k \\big)\\Bigg]$$\n第一项是控制代价，它依赖于控制律 $u_k$。第二项是估计代价，它只依赖于系统噪声、初始状态不确定性和滤波器设计，但与控制律 $u_k$ *无关*。\n\n为了最小化 $J$，我们只需要最小化第一项。状态估计 $\\hat{x}_k$ 的动态由 Kalman 滤波器方程给出，这可以看作是一个由新息过程驱动的系统。最小化第一项是针对状态估计 $\\hat{x}_k$ 的 LQR 问题，其解确实是 $u_k = -K \\hat{x}_k$，其中 $K$ 是来自确定性 LQR 问题的增益。\n\n为了使整个框架在无限时域情况下有效，以下条件是必要的：\n1.  **线性系统，二次型代价**：这是“LQ”部分。（已知）。\n2.  **高斯噪声**：过程噪声 $w_k$、测量噪声 $v_k$ 和初始状态 $x_0$ 必须是（联合）高斯的。这是“G”部分。这确保了 Kalman 滤波器是真正的条件均值估计器，而不仅仅是最佳线性估计器，这对于通过正交性实现代价分离至关重要。噪声还必须是具有已知协方差的白过程。\n3.  **稳态解的存在性**：对于无限时域问题，我们需要稳态的控制器和估计器增益。这要求相应的代数 Riccati 方程 (AREs) 具有唯一的、半正定的、镇定解。其充分条件是：\n    *   对于 LQR 控制器：对 $(A, B)$ 必须是能稳的。（对 $(A, Q^{1/2})$ 能检测的条件也是需要的，但通常通过确保有限代价的问题表述而隐含假设）。\n    *   对于 Kalman 滤波器：对 $(A, C)$ 必须是能检测的。（对 $(A, W^{1/2})$ 能稳的条件也是需要的，其中 $W$ 是 $w_k$ 的协方差，以确保误差协方差保持有界）。\n\n**逐项分析**\n\n- **A. 系统是线性时不变的；$w_k$ 和 $v_k$ 是零均值白色高斯过程，其协方差已知，相互独立且与 $x_0$ 独立；$Q \\succeq 0$, $R \\succ 0$，并且对 $(A,B)$ 和 $(A,C)$ 分别是能稳的 (stabilizable) 和能检测的 (detectable)，因此相关的代数 Riccati 方程存在镇定解；Kalman 滤波器使用正确的协方差，LQR 增益 $K$ 是为完全可观测问题计算的镇定状态反馈增益。在这些条件下，$u_k=-K\\hat x_k$ 是最优的。**\n  此选项正确列出了离散时间无限时域 LQG 问题的经典、标准表述的所有假设。它包括线性、二次型代价、高斯白噪声（具有独立性），以及为存在稳定、最优、稳态解所需的正确的能稳性/能检测性条件。在该条件下控制器是最优的这一陈述是随机控制的一个基本定理。\n  **结论：正确。**\n\n- **B. 系统是线性时不变的；$w_k$ 和 $v_k$ 是零均值、有限方差（但不一定是高斯）的白噪声；$Q \\succeq 0$, $R \\succ 0$，并且 $(A,B)$ 是能稳的。即使 $(A,C)$ 不是能检测的且噪声非高斯，根据分离原理，$u_k=-K\\hat x_k$ 在所有可测的输出反馈律中仍然是全局最优的。**\n  此选项包含多个严重错误。首先，如果噪声不是高斯的，Kalman 滤波器只是最佳*线性*估计器。分离原理通常不成立，并且控制器 $u_k=-K\\hat{x}_k$ 在所有（可能非线性的）控制器中不是最优的。其次，如果对 $(A,C)$ 不是能检测的，则系统存在不可观测的模式。如果这些模式中有任何不稳定的，状态估计误差将是无界的，稳态 Kalman 滤波器不存在或不稳定，并且整个闭环系统无法被镇定。代价 $J$ 将变为无穷大。\n  **结论：不正确。**\n\n- **C. 系统是线性时不变的；测量矩阵 $C$ 具有满列秩；$Q \\succeq 0$, $R \\succ 0$。只要 $K$ 能镇定 $A-BK$，控制器 $u_k=-K\\hat x_k$ 就是最优的，无论噪声统计特性如何，因为闭环是稳定的。**\n  此选项也有缺陷。$C$ 具有满列秩的条件是与能观测性相关的强条件，但它本身既非必要（能检测性才是）也非充分。声称“无论噪声统计特性如何”最优性都成立是错误的，如选项B的解释所述。高斯假设是必不可少的。此外，闭环系统的稳定性是该问题最优解的必要结果，但它不是最优性的充分条件。存在许多稳定的控制器，但它们在最小化二次型代价 $J$ 方面并非最优。\n  **结论：不正确。**\n\n- **D. 系统是线性时不变的；$(w_k, v_k)$ 是联合零均值白色高斯过程，其已知的二阶统计量可能包含非零的互协方差 $\\mathbb{E}[w_k v_k^{\\top}]\\neq 0$，并且与 $x_0$ 独立；$Q \\succeq 0$, $R \\succ 0$；问题数据使得稳态 Kalman 滤波器（考虑了互协方差）和 LQR 都存在镇定代数 Riccati 解；Kalman 滤波器和 $K$ 使用真实的协方差进行设计。在这些条件下，$u_k=-K\\hat x_k$ 是最优的。**\n  此选项描述了 LQG 问题的一个标准且重要的推广，其中过程噪声和测量噪声是相关的。在这些条件下，分离原理仍然成立。设计的 LQR 部分保持不变，而 Kalman 滤波器方程被修改以考虑互协方差项 $\\mathbb{E}[w_k v_k^{\\top}]$。所列出的假设（联合高斯噪声，存在镇定的 Riccati 解）对于控制器 $u_k=-K\\hat{x}_k$ 的最优性是充分的，其中 $\\hat{x}_k$ 现在来自修改后的 Kalman 滤波器。此选项正确地陈述了一个更一般的情况，其中 LQG 控制器是最优的。与选项 A 相比，它是一组更“科学上最小”的假设，因为它不要求噪声独立的非必要约束。\n  **结论：正确。**\n\n选项 A 和 D 都描述了给定控制器为最优的有效充分条件集。选项 D 是选项 A 的推广。问题要求“选择完整的假设集”并“确定哪个（些）选项”是正确的。A 和 D 都是描述分离原理成立场景的事实上正确的陈述。因此，它们都是正确答案。", "answer": "$$\\boxed{AD}$$", "id": "2913855"}, {"introduction": "分离原理虽然提供了一个优雅的控制器设计框架，但它的成功应用依赖于系统满足特定的结构属性。当系统的某些动态模式无法被控制或观测时，即使形式上构建了控制器，也可能无法实现闭环系统的稳定 [@problem_id:2913880]。这个练习将引导你探究可镇定性 (stabilizability) 和可检测性 (detectability) 的关键作用，并揭示为何一个不可控或不可观测的不稳定模式会成为分离设计的“阿喀琉斯之踵”。", "problem": "考虑一个由下式给出的连续时间线性时不变（LTI）单输入单输出（SISO）系统\n$$\\dot{x}(t)=A x(t)+B u(t),\\qquad y(t)=C x(t),$$\n其中 $x(t)\\in\\mathbb{R}^n$，$u(t)\\in\\mathbb{R}$，$y(t)\\in\\mathbb{R}$。通过分离架构实现了一个输出反馈控制器：一个 Luenberger 观测器为一个使用状态估计值的状态反馈律提供信息，\n$$u(t)=-K\\,\\hat{x}(t),\\qquad \\dot{\\hat{x}}(t)=A \\hat{x}(t)+B u(t)+L\\big(y(t)-C \\hat{x}(t)\\big),$$\n其中 $K\\in\\mathbb{R}^{1\\times n}$ 和 $L\\in\\mathbb{R}^{n\\times 1}$ 是恒定增益。仅使用上面给出的能控性、能观性、能镇定性、能检测性以及系统/控制器互联的基本定义。具体来说：\n- 当且仅当每个状态都可以通过合适的输入达到时，系统对 $(A,B)$ 是能控的；当且仅当 $A$ 的每个满足 $\\operatorname{Re}(\\lambda)\\ge 0$ 的特征值 $\\lambda$ 都是能控的，系统对 $(A,B)$ 是能镇定的。\n- 当且仅当每个状态都可以从输出中重构时，系统对 $(C,A)$ 是能观的；当且仅当 $A$ 的每个满足 $\\operatorname{Re}(\\lambda)\\ge 0$ 的特征值 $\\lambda$ 都是能观的，系统对 $(C,A)$ 是能检测的。\n\n假设 $A$ 存在至少一个特征值 $\\lambda_u$，满足 $\\operatorname{Re}(\\lambda_u)>0$，且该特征值（对于 $B$）是不能控的或（对于 $C$）是不能观的。所有其他模式可能是能控的或能观的，因此该系统可能是部分能镇定或部分能检测的，但不是完全能镇定或完全能检测的。你试图通过选择 $K$ 和 $L$，利用分离原理来执行输出反馈极点配置。\n\n下列哪个陈述正确地解释了为什么在这种情况下，通过这种分离架构进行任意的输出反馈极点配置可能是不可能的？\n\nA. 即使系统具有部分能镇定性或能检测性，在分离架构下，$A$ 在开右半平面中任何不能控或不能观的特征值都必然会保留为闭环特征值，因此任意极点配置是不可能的。\n\nB. 选择足够大的增益 $L$ 可以将 $A$ 的不能观的不稳定模式移动到开左半平面，因为观测器动态可以克服能观性的缺乏。\n\nC. 如果 $(A,B)$ 是能镇定的且 $(C,A)$ 是能检测的，那么对于任何期望的闭环极点多重集，都存在 $K$ 和 $L$，使得通过分离的输出反馈可以任意分配所有闭环极点，包括那些与不能控或不能观子空间相关的极点。\n\nD. 在 Kalman 能控性/能观性分解中，任何不能控或不能观的不稳定块都是自主演化的，它们的特征值必须出现在分离设计的闭环特征多项式中，从而排除了当这些块位于开右半平面时通过分离进行任意极点配置的可能性。\n\nE. 在相同的分离结构内，将严格真分有理的频率相关动态引入 $K$ 或 $L$ 中，可以将对应于不能控右半平面模式的系统特征值重新定位到开左半平面，从而恢复任意极点配置。", "solution": "首先应对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n- 系统动态：一个连续时间线性时不变（LTI）单输入单输出（SISO）系统。\n- 状态方程：$\\dot{x}(t)=A x(t)+B u(t)$，其中 $x(t)\\in\\mathbb{R}^n$，$u(t)\\in\\mathbb{R}$。\n- 输出方程：$y(t)=C x(t)$，其中 $y(t)\\in\\mathbb{R}$。\n- 控制器架构：带有 Luenberger 观测器和状态反馈的分离原理。\n- 控制律：$u(t)=-K\\,\\hat{x}(t)$，其中 $K\\in\\mathbb{R}^{1\\times n}$。\n- 观测器动态：$\\dot{\\hat{x}}(t)=A \\hat{x}(t)+B u(t)+L\\big(y(t)-C \\hat{x}(t)\\big)$，其中 $L\\in\\mathbb{R}^{n\\times 1}$。\n- 提供的定义：\n  - $(A,B)$ 的能控性：每个状态都是可达的。\n  - $(A,B)$ 的能镇定性：$A$ 的每个满足 $\\operatorname{Re}(\\lambda)\\ge 0$ 的特征值 $\\lambda$ 都是能控的。\n  - $(C,A)$ 的能观性：每个状态都是可重构的。\n  - $(C,A)$ 的能检测性：$A$ 的每个满足 $\\operatorname{Re}(\\lambda)\\ge 0$ 的特征值 $\\lambda$ 都是能观的。\n- 核心假设：存在至少一个 $A$ 的特征值 $\\lambda_u$，使得 $\\operatorname{Re}(\\lambda_u)>0$ 并且该模式对于 $B$ 是不能控的，或对于 $C$ 是不能观的。因此，该系统既不能镇定也不能检测。\n- 目标：找出能解释在这些条件下无法实现任意输出反馈极点配置的正确陈述。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题定义明确且有科学依据。它提出了现代控制理论中的一个典型问题：当系统不是能镇定和能检测时，分离原理的局限性。系统方程、控制器结构、定义和核心假设都是标准的、精确的且内部一致的。该问题没有违反任何物理或数学原理。它没有歧义、不完整或基于主观论断。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它提出了一个基于线性系统理论基本原理的标准、可验证的问题。可以进行全面分析。\n\n**闭环动态的推导**\n\n控制器设计的分离原理是基于分别分析系统状态和观测器误差的动态。设观测器误差定义为 $e(t) = x(t) - \\hat{x}(t)$。\n\n误差的时间导数是 $\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t)$。代入给定的动态方程：\n$\\dot{x}(t) = A x(t) + B u(t)$\n$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t)) = A \\hat{x}(t) + B u(t) + L(C x(t) - C \\hat{x}(t))$\n$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L C e(t)$\n\n因此，误差动态为：\n$\\dot{e}(t) = (A x(t) + B u(t)) - (A \\hat{x}(t) + B u(t) + L C e(t)) = A(x(t) - \\hat{x}(t)) - L C e(t)$\n$$\\dot{e}(t) = (A - L C)e(t)$$\n观测器误差动态的特征值是矩阵 $A - L C$ 的特征值。\n\n接下来，我们分析反馈下状态 $x(t)$ 的动态。控制律为 $u(t) = -K \\hat{x}(t) = -K (x(t) - e(t)) = -K x(t) + K e(t)$。将其代入状态方程：\n$\\dot{x}(t) = A x(t) + B(-K x(t) + K e(t)) = (A - B K)x(t) + B K e(t)$\n\n我们将 $x(t)$ 和 $e(t)$ 的动态组合成一个单一系统：\n$$\n\\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{pmatrix}\n=\n\\underbrace{\n\\begin{pmatrix} A - B K  B K \\\\ 0  A - L C \\end{pmatrix}\n}_{A_{cl}}\n\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}\n$$\n矩阵 $A_{cl}$ 控制着整个闭环动态。由于它是一个块上三角矩阵，其特征值集合是其对角块特征值的并集：\n$\\text{eig}(A_{cl}) = \\text{eig}(A - B K) \\cup \\text{eig}(A - L C)$。\n\n任意极点配置原理依赖于两个条件：\n1.  当且仅当系统对 $(A,B)$ 完全能控时，可以通过选择状态反馈增益 $K$ 将 $A - B K$ 的特征值任意配置在复平面上。\n2.  当且仅当系统对 $(C,A)$ 完全能观时，可以通过选择观测器增益 $L$ 将 $A - L C$ 的特征值任意配置。\n\n问题陈述指出，存在一个 $A$ 的特征值 $\\lambda_u$，其满足 $\\operatorname{Re}(\\lambda_u)>0$，且该模式是不能控的或不能观的。\n- 如果 $\\lambda_u$ 对应于一个不能控的模式，根据一个基本定理，对于任何 $K$ 的选择，$\\lambda_u$ 始终是 $A - B K$ 的一个特征值。因此，$\\lambda_u \\in \\text{eig}(A_{cl})$。\n- 如果 $\\lambda_u$ 对应于一个不能观的模式，根据一个基本定理（通过对偶性），对于任何 $L$ 的选择，$\\lambda_u$ 始终是 $A - L C$ 的一个特征值。因此，$\\lambda_u \\in \\text{eig}(A_{cl})$。\n\n在任何一种情况下，来自原始系统矩阵 $A$ 的不稳定特征值 $\\lambda_u$ 都会保留为闭环系统 $A_{cl}$ 的一个特征值。由于 $\\operatorname{Re}(\\lambda_u)>0$，闭环系统是不稳定的。这使得将所有闭环极点配置在任意位置（例如，全部在开左半平面）变得不可能。因此，任意极点配置是不可能的。\n\n**选项评估**\n\n**A. 即使系统具有部分能镇定性或能检测性，在分离架构下，$A$ 在开右半平面中任何不能控或不能观的特征值都必然会保留为闭环特征值，因此任意极点配置是不可能的。**\n这个陈述是以上分析的直接且正确的结论。分离原理局限性的本质在于，闭环谱包含 $\\text{eig}(A - B K)$ 和 $\\text{eig}(A - L C)$。$A$ 的一个不能控的特征值不受 $K$ 的配置影响，而 $A$ 的一个不能观的特征值不受 $L$ 的配置影响。如果这样一个特征值位于开右半平面，它在闭环系统中将保持不变，从而排除了镇定的可能性，更不用说任意极点配置了。\n**结论：正确。**\n\n**B. 选择足够大的增益 $L$ 可以将 $A$ 的不能观的不稳定模式移动到开左半平面，因为观测器动态可以克服能观性的缺乏。**\n这个陈述是根本错误的。一个模式是不能观的这一属性恰恰意味着它与输出 $y(t)$ 解耦，因此不受任何基于输出的反馈作用的影响，而观测器增益 $L$ 正是通过项 $L(y - \\hat{y})$ 来调节这种作用的。任何大小的增益 $L$ 都无法改变 $A$ 的一个不能观的特征值。“克服”能观性缺乏的说法在科学上是无意义的。\n**结论：错误。**\n\n**C. 如果 $(A,B)$ 是能镇定的且 $(C,A)$ 是能检测的，那么对于任何期望的闭环极点多重集，都存在 $K$ 和 $L$，使得通过分离的输出反馈可以任意分配所有闭环极点，包括那些与不能控或不能观子空间相关的极点。**\n这个陈述在多个方面都是错误的。首先，任意极点配置的条件是能控性和能观性，而不是较弱的能镇定性和能检测性条件。能镇定性和能检测性仅保证闭环系统可以被镇定（即所有极点可以被配置在开左半平面），而不能保证它们可以被任意配置。其次，如果一个系统仅仅是能镇定的而不是能控的，它就拥有稳定的、不能控的模式，其特征值是不能移动的。对于能检测的系统也是如此。声称可以分配“与不能控或不能观子空间相关的”极点，直接与这些术语的含义相矛盾。最后，该选项讨论的是一个能镇定/能检测的系统，而问题明确指出系统并非如此。\n**结论：错误。**\n\n**D. 在 Kalman 能控性/能观性分解中，任何不能控或不能观的不稳定块都是自主演化的，它们的特征值必须出现在分离设计的闭环特征多项式中，从而排除了当这些块位于开右半平面时通过分离进行任意极点配置的可能性。**\n这个陈述为该现象提供了更深层次的、结构性的解释。Kalman 分解将线性系统的状态空间正式地分解为四个子空间：能控能观、能控不能观、不能控能观、以及不能控不能观。与不能控（$A_{\\bar{c}}$）或不能观（$A_{\\bar{o}}$）块相关的特征值在状态反馈或输出注入下是不变的。如推导所示，这些固定的特征值将出现在闭环特征多项式中。如果这些固定的特征值中有任何一个对应于不稳定模式（$\\operatorname{Re}(\\lambda)>0$），它们就无法被移动，任意极点配置也就不可能实现。这是一个严谨且正确的解释。“自主演化”的措辞是一种轻微的简化，因为这些块可以被其他状态驱动，但它们的特征值确实是固定的。\n**结论：正确。**\n\n**E. 在相同的分离结构内，将严格真分有理的频率相关动态引入 $K$ 或 $L$ 中，可以将对应于不能控右半平面模式的系统特征值重新定位到开左半平面，从而恢复任意极点配置。**\n这个陈述是错误的。用动态传递函数 $K(s)$ 或 $L(s)$ 替换静态增益 $K$ 或 $L$ 相当于使用一个通用的动态补偿器。然而，一个不能控的模式是系统 $(A,B)$ 的一个基本属性——它代表一个不受输入 $u(t)$ 影响的动态模式，无论 $u(t)$ 是如何生成的。类似地，一个不能观的模式是 $(C,A)$ 的一个属性，并且对输出 $y(t)$ 是不可见的，这使得任何使用 $y(t)$ 的控制器都无法影响它。动态控制器无法规避系统的这些基本结构性限制。\n**结论：错误。**\n\n选项 A 和 D 都是正确的。选项 A 是对结果的直接陈述，而选项 D 通过 Kalman 分解提供了底层的结构性原因。两者都正确地解释了这一现象。", "answer": "$$\\boxed{AD}$$", "id": "2913880"}, {"introduction": "从理论设计到实际部署，工程师常常面临数值计算的挑战，尤其是在高性能控制系统中。激进的控制器和高增益观测器的组合，虽然在理论上能实现优异的性能，但在有限精度的计算机上可能导致严重的数值病态问题 [@problem_id:2913857]。这个练习聚焦于这一实际工程难题，要求你分析问题根源并评估不同的坐标缩放策略，以在保持分离结构的同时，提升控制器实现的数值鲁棒性。", "problem": "考虑一个由状态空间模型描述的连续时间线性时不变（LTI）单输入单输出（SISO）系统\n$$\n\\dot{x}(t) \\,=\\, A x(t) \\,+\\, B u(t),\\qquad y(t) \\,=\\, C x(t),\n$$\n其中 $A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times 1}$，$C \\in \\mathbb{R}^{1 \\times n}$，并假设 $(A,B)$ 是可镇定的，$(A,C)$ 是可检测的。通过结合状态反馈和 Luenberger 观测器，构建了一个标准的动态输出反馈控制器：\n$$\nu(t) \\,=\\, -K \\,\\hat{x}(t), \\qquad\n\\dot{\\hat{x}}(t) \\,=\\, A \\hat{x}(t) \\,+\\, B u(t) \\,+\\, L\\big(y(t) - C \\hat{x}(t)\\big),\n$$\n其中 $K \\in \\mathbb{R}^{1 \\times n}$ 且 $L \\in \\mathbb{R}^{n \\times 1}$。在精确计算下，令 $e(t) \\,=\\, x(t) - \\hat{x}(t)$，可得到闭环误差坐标动态方程\n$$\n\\begin{bmatrix}\n\\dot{x}(t) \\\\\n\\dot{e}(t)\n\\end{bmatrix}\n=\n\\underbrace{\\begin{bmatrix}\nA - B K  B K \\\\\n0  A - L C\n\\end{bmatrix}}_{\\mathcal{A}_{\\mathrm{cl}}}\n\\begin{bmatrix}\nx(t) \\\\\ne(t)\n\\end{bmatrix},\n$$\n该系统矩阵是块上三角矩阵，体现了分离原理：$\\mathcal{A}_{\\mathrm{cl}}$ 的谱是 $A - B K$ 和 $A - L C$ 的谱的并集。\n\n现在假设选择一个激进的状态反馈，使得 $A - B K$ 的特征值远在虚轴左侧（即大闭环带宽），并使用高增益观测器，其中 $L \\,=\\, \\tfrac{1}{\\epsilon} \\tilde{L}$，对于某个小的 $0  \\epsilon \\ll 1$ 和固定的 $\\tilde{L}$，使得 $A - L C$ 的特征值也远在左侧。在有限精度实现中，可能会出现数值条件问题，原因包括：\n- $x(t)$ 和 $e(t)$ 动态之间存在巨大的时间尺度差异，\n- $K$ 和 $L$ 的大范数放大了浮点舍入误差和传感器噪声，\n- 不良缩放的状态坐标导致 $\\mathcal{A}_{\\mathrm{cl}}$ 病态。\n\n一位研究人员建议通过适当的状态和观测器缩放来缓解数值条件问题，同时保持分离特性。下列哪个陈述正确地指明了一种缩放策略，该策略能在实现时减少数值条件问题并保持闭环的分离结构？选择所有适用项。\n\nA. 引入相似性变换 $z \\,=\\, S x$，其中 $S \\in \\mathbb{R}^{n \\times n}$ 可逆（例如，选择 $S$ 以大致平衡能控性和能观性），并在 $z$ 坐标下重新设计增益：\n$$\n\\dot{\\hat{z}} \\,=\\, S A S^{-1} \\hat{z} \\,+\\, S B u \\,+\\, L_z\\big(y - C S^{-1} \\hat{z}\\big), \\quad u \\,=\\, -K_z \\hat{z},\n$$\n然后实现 $K \\,=\\, K_z S$ 和 $L \\,=\\, S^{-1} L_z$。这改善了缩放，因为 $S A S^{-1}$、$S B$ 和 $C S^{-1}$ 中的系数可以被调节，并且它保持了分离性，因为在 $(z,e_z)$（其中 $e_z \\,=\\, z - \\hat{z}$）中的增广闭环系统与原始增广闭环系统相似。\n\nB. 进一步增加观测器增益的大小（使 $\\epsilon$ 更小），以便观测器误差动态在数值上主导系统动态，从而使 $B K$ 的数值影响可以忽略不计。这在数值上解耦了回路，从而在不进行任何坐标变换的情况下规范了条件数。\n\nC. 仅在观测器内部应用高增益缩放，定义 $\\hat{z} \\,=\\, S \\hat{x}$，其中 $S$ 是为高增益归一化而选择的对角矩阵，但控制器保持为 $u \\,=\\, -K \\hat{x}$，使用原始的 $K$。这减小了观测器信号的幅度，并保持了分离性，因为控制器和观测器仍然是独立设计的。\n\nD. 将测量的输出预先缩放为 $\\tilde{y} \\,=\\, \\alpha \\, y$，其中 $\\alpha \\in \\mathbb{R}$ 很小，以防止噪声被 $L$ 放大，但系统模型和控制器/观测器增益保持不变。这减少了数值问题，而不影响分离特性。\n\nE. 对于处于能观标准型的单输出系统，使用奇异摄动高增益缩放 $z \\,=\\, D(\\epsilon) x$，其中 $D(\\epsilon) \\,=\\, \\mathrm{diag}\\big(1, \\epsilon, \\epsilon^{2}, \\dots, \\epsilon^{n-1}\\big)$，为缩放后的模型设计 $K_z$ 和 $L_z$：\n$$\n\\dot{z} \\,=\\, D(\\epsilon) A D(\\epsilon)^{-1} z \\,+\\, D(\\epsilon) B u,\\qquad y \\,=\\, C D(\\epsilon)^{-1} z,\n$$\n实现 $u \\,=\\, -K_z \\hat{z}$ 和 $\\dot{\\hat{z}} \\,=\\, D(\\epsilon) A D(\\epsilon)^{-1} \\hat{z} \\,+\\, D(\\epsilon) B u \\,+\\, L_z\\big(y - C D(\\epsilon)^{-1} \\hat{z}\\big)$，并映射回 $K \\,=\\, K_z D(\\epsilon)$，$L \\,=\\, D(\\epsilon)^{-1} L_z$。这归一化了快/慢坐标，减少了动态范围的差异，并保持了分离性，因为增广闭环系统通过块对角相似变换相关联。\n\n选择所有适用项。", "solution": "问题要求找出正确的缩放策略，以缓解基于高增益观测器的控制器中的数值条件问题，同时保持分离原理。该系统是一个由下式给出的连续时间 LTI SISO 系统：\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\qquad y(t) = C x(t)\n$$\n其基于观测器的控制器为：\n$$\nu(t) = -K \\hat{x}(t), \\qquad \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - C \\hat{x}(t)\\big)\n$$\n当控制器增益 $K$ 和观测器增益 $L$ 都很大时，就会出现问题，导致数值病态。分离原理体现在坐标 $(x, e)$ 下的闭环动态矩阵 $\\mathcal{A}_{\\mathrm{cl}}$ 的块上三角结构中，其中 $e(t) = x(t) - \\hat{x}(t)$ 是估计误差。\n$$\n\\mathcal{A}_{\\mathrm{cl}} = \\begin{bmatrix} A - B K  B K \\\\ 0  A - L C \\end{bmatrix}\n$$\n$\\mathcal{A}_{\\mathrm{cl}}$ 的特征值是调节器块 $\\sigma(A-BK)$ 和观测器误差块 $\\sigma(A-LC)$ 的特征值的并集。如果新的闭环动态矩阵保留了这种结构特性，确保其特征值同样是解耦的，那么该策略就保持了分离特性。\n\n让我们逐一分析每个选项。\n\n### 选项 A 分析\n\n该选项提出了对状态进行一般的相似性变换，$z(t) = S x(t)$，其中 $S$ 是一个可逆矩阵。在 $z$ 坐标下设计一个新的控制器。\n$z$ 坐标下的系统动态方程为：\n$$\n\\dot{z}(t) = (S A S^{-1}) z(t) + (S B) u(t) = A_z z(t) + B_z u(t)\n$$\n$$\ny(t) = (C S^{-1}) z(t) = C_z z(t)\n$$\n所提出的控制器是为这个新表示设计的：\n$$\n\\dot{\\hat{z}}(t) = A_z \\hat{z}(t) + B_z u(t) + L_z\\big(y(t) - C_z \\hat{z}(t)\\big), \\quad u(t) = -K_z \\hat{z}(t)\n$$\n这是 $z$ 坐标下系统的标准基于观测器的控制器。在坐标 $(z, e_z)$（其中 $e_z(t) = z(t) - \\hat{z}(t)$）下对应的闭环动态将具有矩阵：\n$$\n\\mathcal{A}_{z} = \\begin{bmatrix} A_z - B_z K_z  B_z K_z \\\\ 0  A_z - L_z C_z \\end{bmatrix}\n$$\n该矩阵是块上三角矩阵，因此在新坐标中分离原理得以保持。特征值为 $\\sigma(A_z - B_z K_z) \\cup \\sigma(A_z - L_z C_z)$。\n\n陈述中说，这种实现等同于在原始坐标中使用增益 $K = K_z S$ 和 $L = S^{-1} L_z$。我们来验证一下。\n控制律为 $u = -K_z \\hat{z}$。由于 $\\hat{z}$ 是 $z=Sx$ 的估计，因此很自然地将原始状态的估计定义为 $\\hat{x} = S^{-1}\\hat{z}$。那么，$u = -K_z (S\\hat{x}) = -(K_zS)\\hat{x}$，这意味着 $K=K_zS$。\n观测器增益变换将增益为 $L$ 的 $\\hat{x}$ 观测器与增益为 $L_z$ 的 $\\hat{z}$ 观测器关联起来。对 $\\hat{z}=S\\hat{x}$ 求导得到 $\\dot{\\hat{z}} = S\\dot{\\hat{x}}$。\n代入标准的 $\\hat{x}$ 观测器动态方程：\n$\\dot{\\hat{z}} = S\\big(A \\hat{x} + B u + L(y - C \\hat{x})\\big) = (SAS^{-1})(S\\hat{x}) + (SB)u + SL(y - (CS^{-1})(S\\hat{x})) = A_z \\hat{z} + B_z u + (SL)(y - C_z \\hat{z})$。\n将此与 $\\hat{z}$ 观测器方程比较，我们确定 $L_z = SL$，这意味着 $L = S^{-1} L_z$。\n增益关系是正确的。\n\n其核心主张是该策略能改善数值条件。通过恰当地选择相似性变换 $S$（例如，使用平衡算法使变换后矩阵的行和列具有相似的范数），可以使导出的矩阵 $A_z, B_z, C_z$ 的条件数比原始的 $A, B, C$ 好得多。后续的设计步骤（例如，极点配置）和使用状态 $\\hat{z}$ 的控制器的最终实现在数值上将更加鲁棒。\n增广闭环矩阵 $\\mathcal{A}_z$ 通过块对角相似变换 $\\mathcal{S} = \\text{diag}(S, S)$ 与原始矩阵 $\\mathcal{A}_{cl}$ 相关联，因为 $z=Sx$ 且 $e_z = S e_x$。因此，$\\mathcal{A}_z = \\mathcal{S} \\mathcal{A}_{cl} \\mathcal{S}^{-1}$。这再次证实了分离结构得以保持。\n该策略是控制工程中用于提高数值鲁棒性的标准且可靠的方法。\n\n结论：**正确**。\n\n### 选项 B 分析\n\n这个选项建议将观测器增益 $L$ 变得更大（即在 $L = \\tfrac{1}{\\epsilon}\\tilde{L}$ 中使 $\\epsilon$ 更小）。给出的理由是，快速的观测器动态将占主导地位，使得耦合项 $BK$ 的影响在数值上可以忽略不计，从而规范化问题。\n这个推理根本上是错误的。数值条件问题*是由*大的增益 $K$ 和 $L$ 引起的。矩阵 $\\mathcal{A}_{\\mathrm{cl}}$ 变得病态的部分原因在于，与 $BK$ 和 $LC$ 相关的项与 $A$ 的项相比具有非常大的量级。增加 $L$ 的量级将进一步增加块 $A-LC$ 中项的量级，并可能增加 $\\mathcal{A}_{\\mathrm{cl}}$ 的条件数。这加剧了时间尺度分离和系数范围大的问题，而这正是病态的根源。该策略使数值问题恶化，而不是改善。\n\n结论：**不正确**。\n\n### 选项 C 分析\n\n该选项提出了一种混合方法：定义一个缩放的观测器状态 $\\hat{z} = S \\hat{x}$，但保持控制律为 $u = -K \\hat{x}$ 并使用原始的高增益 $K$。这种描述是模棱两可的。控制器是一个单一的动力系统。它不能部分地使用两种不同的状态表示（$\\hat{x}$ 和 $\\hat{z}$）。\n让我们将其解释为一个内部状态为 $\\hat{z}$ 的控制器，它产生一个输出 $\\hat{x} = S^{-1} \\hat{z}$，然后用于控制律 $u = -K\\hat{x}$。控制器将是：\n$$ \\dot{\\hat{z}} = A_z \\hat{z} + B_z u + L_z(y - C_z \\hat{z}), \\quad u = -K(S^{-1}\\hat{z}) $$\n这是在 $z$ 坐标下的标准控制器结构，如选项 A 所示，控制器增益为 $K_z = KS^{-1}$。认为应该“保持控制器为 $u=-K\\hat{x}$，使用原始的 $K$”的论点是误导性的。如果引入缩放是为了解决由大增益引起的系统范围的数值问题，那么它应该被一致地应用。保持大的增益 $K$ 不变，只缩放观测器一侧，并不能解决全部问题。闭环矩阵中的 $BK$ 项，它导致了病态条件，包含了这个未被缓解的大增益 $K$。\n此外，“保持了分离性，因为控制器和观测器仍然是独立设计的”这个理由是不合逻辑的。分离原理是最终闭环系统结构的数学性质，而不是设计理念。虽然该结构确实保持了分离性，但所提出的策略不是一个改善条件数的一致性方法，而且描述得很差。\n\n结论：**不正确**。\n\n### 选项 D 分析\n\n该选项建议在测量的输出进入观测器之前，将其乘以一个小的因子 $\\alpha$：新息项变为 $L(\\alpha y - C\\hat{x})$。\n我们来分析由此产生的误差动态 $e(t) = x(t)-\\hat{x}(t)$。\n$$\n\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(\\alpha y(t) - C \\hat{x}(t))\\big)\n$$\n$$\n\\dot{e}(t) = A e(t) - L(\\alpha C x(t) - C \\hat{x}(t)) = A e(t) - L C (\\alpha x(t) - \\hat{x}(t))\n$$\n我们可以写成 $\\alpha x - \\hat{x} = \\alpha x - (x - e) = (\\alpha-1)x + e$。\n$$\n\\dot{e}(t) = A e(t) - L C ((\\alpha-1)x(t) + e(t)) = (A-LC)e(t) - (\\alpha-1)LC x(t)\n$$\n在 $(x,e)$ 坐标系中，闭环系统的状态方程为：\n$$\n\\begin{bmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{bmatrix} = \\begin{bmatrix} A - B K  B K \\\\ -(\\alpha-1)LC  A - L C \\end{bmatrix} \\begin{bmatrix} x(t) \\\\ e(t) \\end{bmatrix}\n$$\n仅当 $(2,1)$ 块 $-(\\alpha-1)LC$ 为零时，系统矩阵才是块上三角矩阵。这要求 $\\alpha=1$（原始系统），或 $L=0$ 或 $C=0$（平凡情况）。对于任何 $\\alpha \\neq 1$，矩阵都不是块三角矩阵，分离原理被破坏。调节器和观测器的特征值变得耦合。所提出的修改从根本上是错误的，因为它使观测器与系统模型不一致（它将一个缩放后的测量值 $\\alpha y$ 与一个未缩放的预测值 $C\\hat{x}$ 进行比较）。\n\n结论：**不正确**。\n\n### 选项 E 分析\n\n该选项描述了一种针对能观标准型系统的特定、复杂的缩放策略，这是高增益观测器理论中的一个常见设置。它使用了一个状态变换 $z=D(\\epsilon)x$，其中对角矩阵为 $D(\\epsilon) = \\mathrm{diag}(1, \\epsilon, \\epsilon^{2}, \\dots, \\epsilon^{n-1})$。这是奇异摄动理论中一种众所周知的技术。\n1.  **缩放**：变换 $z = D(\\epsilon)x$ 是选项 A 中一般相似性变换 $z=Sx$ 的一个特例，其中 $S=D(\\epsilon)$。该变换专为处理高增益系统的多时间尺度特性而设计。它“拉伸”状态空间坐标，使变换后状态变量 $z_i$ 的量级更加均匀，从而改善变换后系统矩阵 $(A_\\epsilon, B_\\epsilon, C_\\epsilon) = (DAD^{-1}, DB, CD^{-1})$ 的数值条件。\n2.  **控制器设计**：然后，在这些性态良好的 $z$ 坐标中设计控制器。其结构是标准的：\n    $$\n    \\dot{\\hat{z}} = A_\\epsilon \\hat{z} + B_\\epsilon u + L_z(y - C_\\epsilon \\hat{z}), \\quad u = -K_z \\hat{z}\n    $$\n3.  **分离性的保持**：如选项 A 的分析所确立的，使用相似性变换并在新坐标中完全重新设计控制器，可以保持分离特性。在 $(z, e_z)$ 坐标下的闭环矩阵是块三角矩阵。关于增广闭环系统通过块对角相似变换 $\\text{diag}(D(\\epsilon), D(\\epsilon))$ 相关联的陈述也是正确的，正如对 A 的分析所示。\n4.  **增益映射**：关系式 $K = K_z D(\\epsilon)$ 和 $L = D(\\epsilon)^{-1}L_z$ 是正确的增益变换，与 $S=D(\\epsilon)$ 时的一般公式 $K=K_zS$ 和 $L=S^{-1}L_z$ 相匹配。\n\n这个选项正确地描述了一种在基于高增益观测器的控制中改善数值条件的有效且强大的技术，它是选项 A 中阐述的一般原则的一个高级且具体的应用。该选项中的所有声明都是正确的。\n\n结论：**正确**。\n\n### 总结\n选项 A 和 E 都描述了正确的缩放策略。选项 A 提出了一般性的相似变换原则，而选项 E 详述了这一原则针对高增益观测器的一个具体的、成熟的应用实例。选项 B、C 和 D 包含根本性的概念错误。", "answer": "$$\\boxed{AE}$$", "id": "2913857"}]}