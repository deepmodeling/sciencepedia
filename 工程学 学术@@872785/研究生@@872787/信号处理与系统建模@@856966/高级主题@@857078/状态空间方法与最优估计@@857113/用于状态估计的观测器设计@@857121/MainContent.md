## 引言
在现代工程与科学领域，理解并控制动态系统是核心任务之一。然而，我们常常面临一个根本性的挑战：系统的许多关键内部状态——如飞行器的姿态、[化学反应](@entry_id:146973)的浓度或机器人的关节速度——无法通过传感器直接、精确地测量。状态估计的[观测器设计](@entry_id:263404)正是为了解决这一难题而生，它旨在利用可测量的系统输出信息，结合系统的动态模型，来推断出这些不可见的内部状态。掌握[状态估计](@entry_id:169668)不仅是实现高性能控制的基础，也是进行系统监控、故障诊断和智能决策的关键。

本文旨在为读者构建一个关于[状态观测器设计](@entry_id:168017)的完整知识框架。我们将从以下三个层面展开：
*   在“**原理与机制**”一章中，我们将深入探讨[状态估计](@entry_id:169668)的基石——可观测性，并系统学习[确定性系统](@entry_id:174558)中的[龙伯格观测器](@entry_id:150581)和随机系统中的最优估计器——[卡尔曼滤波器](@entry_id:145240)，最后将这些方法推广到更具挑战性的[非线性](@entry_id:637147)领域。
*   在“**应用与[交叉](@entry_id:147634)学科联系**”一章中，我们将展示观测器如何与[反馈控制理论](@entry_id:167805)深度融合，形成[分离原理](@entry_id:176134)等优美结论，并探讨其在故障诊断、[鲁棒估计](@entry_id:261282)以及[分布](@entry_id:182848)式网络和[非线性](@entry_id:637147)几何控制等前沿[交叉](@entry_id:147634)学科中的强大应用。
*   最后，在“**动手实践**”环节，通过具体的编程练习，读者将有机会亲手实现和验证观测器的设计，将抽象的理论转化为解决实际问题的能力。

通过这一系列的学习，您将不仅理解“如何”设计一个观测器，更能领会“为何”如此设计，从而具备在各种复杂场景下灵活运用状态估计技术的能力。让我们首先深入其核心，探索[观测器设计](@entry_id:263404)的原理与机制。

## 原理与机制

本章深入探讨状态估计的核心原理与机制。在前一章介绍背景之后，我们将从一个基本问题开始：在何种条件下，我们可以仅通过观测一个系统的外部输出来确定其内部状态？这个问题的答案引出了**可观测性**（observability）的概念，它是所有[状态估计器](@entry_id:272846)设计的基石。在此基础上，我们将构建确定性观测器，如**[Luenberger观测器](@entry_id:150581)**，并探索其设计方法。随后，我们将引入随机性的概念，阐述如何在充满噪声的环境中实现最优估计，这自然地导向了强大的**卡尔曼滤波器**（Kalman Filter）。最后，我们将把这些思想扩展到非线性系统，介绍**[扩展卡尔曼滤波器](@entry_id:199333)**（Extended Kalman Filter, EKF）和**[无迹卡尔曼滤波器](@entry_id:166733)**（Unscented Kalman Filter, UKF）等高级方法。

### [可观测性](@entry_id:152062)：[状态估计](@entry_id:169668)的基石

在能够设计一个[状态估计器](@entry_id:272846)之前，我们必须首先确定所讨论的系统是否从根本上允许[状态估计](@entry_id:169668)。一个系统的状态是否能够被其输出完全揭示，这一固有属性被称为可观测性。

#### 什么是[可观测性](@entry_id:152062)？

从直觉上看，可观测性回答了这样一个问题：对于一个给定的系统，我们能否通过在一段时间内观察其输出信号，来唯一地确定系统在某个初始时刻的内部状态？如果答案是肯定的，那么该系统就是可观测的。

为了更精确地定义这一概念，我们考虑一个线性时不变（LTI）系统，其[状态空间表示](@entry_id:147149)为：
$$
\dot{x}(t) = A x(t) + B u(t) \\
y(t) = C x(t) + D u(t)
$$
其中，$x(t)$ 是 $n$ 维[状态向量](@entry_id:154607)，$u(t)$ 是输入，$y(t)$ 是输出。假设我们已知输入信号 $u(t)$ 和[系统矩阵](@entry_id:172230) $A, B, C, D$。我们能否仅通过测量一段时间（例如，从 $t=0$到$t=T$）内的输出 $y(t)$ 来唯一确定初始状态 $x(0)$？

系统的解可以表示为：
$$
y(t) = C e^{At} x(0) + C \int_0^t e^{A(t-\tau)} B u(\tau) d\tau + D u(t)
$$
由于输入 $u(t)$ 和[系统矩阵](@entry_id:172230)是已知的，等式右边的后两项是已知量。我们可以将它们从测量值 $y(t)$ 中减去，得到一个只与初始状态相关的修正输出 $\tilde{y}(t)$：
$$
\tilde{y}(t) = y(t) - D u(t) - C \int_0^t e^{A(t-\tau)} B u(\tau) d\tau = C e^{At} x(0)
$$
现在，问题转化为：我们能否从 $\tilde{y}(t)$ 中唯一地确定 $x(0)$？

**[可观测性](@entry_id:152062)**的正式定义如下：对于任意已知的输入 $u(t)$ 和任意时间区间 $[0, T]$（其中 $T>0$），如果由两个不同初始状态 $x_1(0)$ 和 $x_2(0)$ 产生的输出完全相同（即 $y_1(t) = y_2(t)$ for $t \in [0,T]$）必然意味着这两个初始状态是相同的（即 $x_1(0) = x_2(0)$），则系统是可观测的。

这个定义等价于说，映射 $x(0) \mapsto C e^{At} x(0)$ 是单射的。也就是说，$C e^{At} (x_1(0) - x_2(0)) = 0$ 只有在 $x_1(0) = x_2(0)$ 时才成立。值得注意的是，可观测性这一属性仅由矩阵对 $(A, C)$ 决定，而与输入矩阵 $B$ 和前馈矩阵 $D$ 无关 [@problem_id:2888297]。

#### 卡尔曼[可观测性秩条件](@entry_id:752870)

上述定义虽然精确，但在实践中不易直接检验。幸运的是，存在一个等价的代数判据，称为**卡尔曼[可观测性秩条件](@entry_id:752870)**（Kalman observability rank condition）。

该条件源于对 $C e^{At} v = 0$ 这一关系的分析。如果这个等式对所有 $t \ge 0$ 成立，那么它在 $t=0$ 处的所有时间导数也必须为零。
在 $t=0$ 时，我们有：
$$
\begin{align*}
\left. C e^{At} v \right|_{t=0} = C v = 0 \\
\left. \frac{d}{dt} (C e^{At} v) \right|_{t=0} = C A v = 0 \\
\left. \frac{d^2}{dt^2} (C e^{At} v) \right|_{t=0} = C A^2 v = 0 \\
\vdots \\
\left. \frac{d^{n-1}}{dt^{n-1}} (C e^{At} v) \right|_{t=0} = C A^{n-1} v = 0
\end{align*}
$$
根据[Cayley-Hamilton定理](@entry_id:150551)，任何高于 $n-1$ 次的[矩阵幂](@entry_id:264766) $A^k$ 都可以表示为 $\{I, A, \dots, A^{n-1}\}$ 的线性组合。因此，上述 $n$ 个方程足以涵盖所有信息。我们可以将这些方程写成一个矩阵形式：
$$
\mathcal{O} v = \begin{pmatrix} C \\ CA \\ \vdots \\ CA^{n-1} \end{pmatrix} v = 0
$$
这里的矩阵 $\mathcal{O}$ 被称为**[可观测性矩阵](@entry_id:165052)**。系统是可观测的，当且仅当方程 $\mathcal{O} v = 0$ 只有唯一解 $v=0$。这等价于要求[可观测性矩阵](@entry_id:165052) $\mathcal{O}$ 具有[满列秩](@entry_id:749628)，即 $\operatorname{rank}(\mathcal{O}) = n$ [@problem_id:2888297]。

**示例：** 考虑一个[二阶系统](@entry_id:276555)，其矩阵为 $A=\begin{pmatrix}0  & 1 \\ 0  & 0\end{pmatrix}$ 和 $C=\begin{pmatrix}1  & 0\end{pmatrix}$ [@problem_id:2888329]。状态维数 $n=2$。我们来构造[可观测性矩阵](@entry_id:165052)：
$$
CA = \begin{pmatrix}1  & 0\end{pmatrix} \begin{pmatrix}0  & 1 \\ 0  & 0\end{pmatrix} = \begin{pmatrix}0  & 1\end{pmatrix}
$$
因此，[可观测性矩阵](@entry_id:165052)为：
$$
\mathcal{O} = \begin{pmatrix} C \\ CA \end{pmatrix} = \begin{pmatrix} 1  & 0 \\ 0  & 1 \end{pmatrix}
$$
这个矩阵是 $2 \times 2$ 的[单位矩阵](@entry_id:156724)，其秩为 $2$。由于 $\operatorname{rank}(\mathcal{O}) = n = 2$，该系统是完全可观测的。

#### [可观测性格拉姆矩阵](@entry_id:190375)

检验可观测性的另一种方法是使用**[可观测性格拉姆矩阵](@entry_id:190375)**（Observability Gramian），其定义为：
$$
W_{o}(t_f) = \int_0^{t_f} e^{A^T \tau} C^T C e^{A \tau} d\tau
$$
系统是可观测的，当且仅当对于任意 $t_f > 0$，$W_o(t_f)$ 是正定的（因此是可逆的）。格拉姆矩阵在理论分析和能量相关的解释中特别有用。

对于上述示例 [@problem_id:2888329]，我们可以计算在区间 $[0,1]$ 上的[格拉姆矩阵](@entry_id:203297)。首先计算矩阵指数 $e^{A\tau}$。由于 $A^2=0$（$A$是[幂零矩阵](@entry_id:152732)），其泰勒级数展开只有两项：
$$
e^{A\tau} = I + A\tau = \begin{pmatrix}1  & \tau \\ 0  & 1\end{pmatrix}
$$
其[转置](@entry_id:142115)为 $e^{A^T\tau} = \begin{pmatrix}1  & 0 \\ \tau  & 1\end{pmatrix}$。积分项为：
$$
e^{A^T \tau} C^T C e^{A \tau} = \begin{pmatrix}1  & 0 \\ \tau  & 1\end{pmatrix} \begin{pmatrix}1  & 0 \\ 0  & 0\end{pmatrix} \begin{pmatrix}1  & \tau \\ 0  & 1\end{pmatrix} = \begin{pmatrix}1  & \tau \\ \tau  & \tau^2\end{pmatrix}
$$
对该矩阵从 $0$到$1$进行积分，得到：
$$
W_{o}(1) = \int_0^1 \begin{pmatrix}1  & \tau \\ \tau  & \tau^2\end{pmatrix} d\tau = \begin{pmatrix} 1  & \frac{1}{2} \\ \frac{1}{2}  & \frac{1}{3} \end{pmatrix}
$$
该格拉姆矩阵的[行列式](@entry_id:142978)为 $\det(W_{o}(1)) = (1)(\frac{1}{3}) - (\frac{1}{2})(\frac{1}{2}) = \frac{1}{12} \neq 0$。由于[行列式](@entry_id:142978)非零，该矩阵是可逆的，再次证实了系统的可观测性。

### [Luenberger观测器](@entry_id:150581)：一种确定性方法

知道了系统是可观测的，我们就可以着手设计一个[状态估计器](@entry_id:272846)。最经典的方法之一是David Luenberger在20世纪60年代提出的观测器。

#### [可检测性](@entry_id:265305)：一个更实用的条件

在实践中，完全可观测的要求有时过于严苛。一个更宽松且通常足够实用的条件是**[可检测性](@entry_id:265305)**（detectability）。要理解[可检测性](@entry_id:265305)，我们需要引入**[系统模态](@entry_id:272794)**（modes）的视角。系统的每个[特征值](@entry_id:154894) $\lambda$ 都对应一个动态模态。如果一个模态对应的[特征向量](@entry_id:151813) $v$ 恰好位于输出矩阵 $C$ 的[零空间](@entry_id:171336)中（即 $Cv=0$），那么这个模态的动态演化将不会在系统输出中产生任何痕迹，我们称之为**[不可观测模态](@entry_id:168628)**。

例如，考虑一个对角系统，其矩阵为 $A = \operatorname{diag}(1, -2)$ 和 $C = \begin{pmatrix}0  & 1\end{pmatrix}$ [@problem_id:2888318]。该系统的[特征值](@entry_id:154894)（模态）为 $\lambda_1 = 1$ 和 $\lambda_2 = -2$。对应的[特征向量](@entry_id:151813)分别是 $v_1 = \begin{pmatrix}1 \\ 0\end{pmatrix}$ 和 $v_2 = \begin{pmatrix}0 \\ 1\end{pmatrix}$。
我们检查每个模态是否可观测：
*   对于 $\lambda_1 = 1$：$Cv_1 = \begin{pmatrix}0  & 1\end{pmatrix} \begin{pmatrix}1 \\ 0\end{pmatrix} = 0$。该模态是不可观测的。
*   对于 $\lambda_2 = -2$：$Cv_2 = \begin{pmatrix}0  & 1\end{pmatrix} \begin{pmatrix}0 \\ 1\end{pmatrix} = 1 \neq 0$。该模态是可观测的。

**[可检测性](@entry_id:265305)**的定义是：一个系统是可检测的，当且仅当其所有**不可观测**的模态都是**稳定**的（即对应[特征值](@entry_id:154894)的实部严格为负）。这个定义背后的思想是，即使我们无法通过输出来“看到”或“修正”系统的某些部分，只要这些部分自身能够稳定地衰减到零，我们仍然可以渐近地估计出整个系统的状态。

在上述例子中 [@problem_id:2888318]，不可观测的模态是 $\lambda_1 = 1$。由于其不满足稳定条件（$\operatorname{Re}(1) \not\lt 0$），该系统是不可检测的。

总结来说 [@problem_id:2888336]：
*   **[可观测性](@entry_id:152062)**要求系统没有任何[不可观测模态](@entry_id:168628)。
*   **[可检测性](@entry_id:265305)**允许存在[不可观测模态](@entry_id:168628)，但要求它们必须是严格稳定的。

#### [Luenberger观测器](@entry_id:150581)的结构

[Luenberger观测器](@entry_id:150581)是一个动态系统，它通过模拟真实系统的行为来生成[状态估计](@entry_id:169668)值 $\hat{x}(t)$。其核心思想是构建一个包含两部分的估计器：一部分是原系统的模型副本，另一部分是基于输出误差的校正项。

其[标准形式](@entry_id:153058)为 [@problem_id:2699812]：
$$
\dot{\hat{x}}(t) = A \hat{x}(t) + B u(t) + L \big( y(t) - C \hat{x}(t) \big)
$$
这里的 $\hat{x}(t)$ 是状态估计值。让我们分解这个方程：
1.  **模型副本**：项 $A \hat{x}(t) + B u(t)$ 模拟了在没有未知扰动的情况下，系统状态应如何演化。为了计算这一项，观测器必须知道系统模型（矩阵 $A, B$）和实时施加的控制输入 $u(t)$。
2.  **校正项**：项 $L \big( y(t) - C \hat{x}(t) \big)$ 是关键的创新。$C \hat{x}(t)$ 是观测器基于当前[状态估计](@entry_id:169668)值 $\hat{x}(t)$ 预测的输出，我们称之为 $\hat{y}(t)$。而 $y(t)$ 是从真实系统中测量到的实际输出。它们的差值 $y(t) - \hat{y}(t)$ 被称为**输出误差**或**创新**（innovation）。这个[误差信号](@entry_id:271594)反映了模型预测与现实之间的偏差。观测器通过一个**增益矩阵** $L$ 将这个误差反馈回来，以持续修正状态估计值，使其趋向于真实状态。

#### 误差动态与[极点配置](@entry_id:155523)

[Luenberger观测器](@entry_id:150581)的性能取决于其估计误差 $e(t) = x(t) - \hat{x}(t)$ 的行为。我们希望这个误差能尽快收敛到零。误差的动态方程可以通过将真实系统动态减去观测器动态得到：
$$
\begin{align*}
\dot{e}(t) = \dot{x}(t) - \dot{\hat{x}}(t) \\
= (A x + B u) - (A \hat{x} + B u + L(y - C \hat{x})) \\
= A(x - \hat{x}) - L(C x - C \hat{x}) \\
= (A - LC) e(t)
\end{align*}
$$
这个简洁的结果表明，[估计误差](@entry_id:263890)自身构成一个线性系统，其动态由矩阵 $(A - LC)$ 决定。为了使误差渐近收敛到零，我们必须设计增益矩阵 $L$，使得矩阵 $(A - LC)$ 是**赫尔维茨**（Hurwitz）矩阵，即其所有[特征值](@entry_id:154894)都具有严格负实部。

一个基本结论是：当且仅当系统对 $(A, C)$ 是**可检测**的，我们总能找到一个增益 $L$ 使得 $(A - LC)$ 稳定。如果系统是**可观测**的，我们不仅能保证稳定性，还能通过选择合适的 $L$ 将 $(A - LC)$ 的[特征值](@entry_id:154894)（也称为**观测器极点**）配置到复平面上的任意期望位置（只要它们以共轭对形式出现）。这个过程称为**[极点配置](@entry_id:155523)**（pole placement）[@problem_id:2888336]。

通过[极点配置](@entry_id:155523)，我们可以精确地控制[估计误差](@entry_id:263890)的收敛速度和动态特性（如阻尼和[振荡](@entry_id:267781)）。例如，我们可以将观测器极点设计为具有特定的自然频率 $\omega_n$ 和[阻尼比](@entry_id:262264) $\zeta$，以实现期望的瞬态响应，如[过冲](@entry_id:147201)和镇定时间 [@problem_id:2888335]。

有趣的是，[观测器设计](@entry_id:263404)问题存在一个深刻的**对偶性**（duality）。为系统 $(A, C)$ 设计[观测器增益](@entry_id:267562) $L$ 以配置 $(A-LC)$ 的极点，在数学上等价于为对偶系统 $(A^T, C^T)$ 设计[状态反馈控制器](@entry_id:203349)增益 $K=L^T$ 来配置 $(A^T - C^T K)$ 的[闭环极点](@entry_id:274094) [@problem_id:2888335]。

### 最优状态估计：[卡尔曼滤波器](@entry_id:145240)

[Luenberger观测器](@entry_id:150581)在确定性框架下工作，它假设系统模型是精确的，并且没有噪声。然而，在现实世界中，系统总是受到未知扰动（过程噪声）和测量误差（[测量噪声](@entry_id:275238)）的影响。在这种情况下，我们不仅关心误差是否收敛，更关心如何使估计误差在统计意义上最小。

#### 从确定性到随机性估计

让我们考虑一个带有噪声的[LTI系统](@entry_id:271946)：
$$
\dot{x}(t) = A x(t) + B u(t) + w(t) \\
y(t) = C x(t) + v(t)
$$
其中 $w(t)$ 是[过程噪声](@entry_id:270644)，$v(t)$ 是测量噪声。如果我们仍然使用[Luenberger观测器](@entry_id:150581)结构，估计误差的动态将变为 [@problem_id:2699845]：
$$
\dot{e}(t) = (A - LC) e(t) + w(t) - L v(t)
$$
现在，误差 $e(t)$ 不再自主地衰减到零，而是被一个持续的[随机过程](@entry_id:159502) $w(t) - L v(t)$ 所驱动。

**[卡尔曼滤波器](@entry_id:145240)**（Kalman filter）正是在这种随机框架下提出的。它不再是任意地选择增益 $L$ 来配置极点，而是根据[过程噪声](@entry_id:270644) $w(t)$ 和[测量噪声](@entry_id:275238) $v(t)$ 的统计特性（即它们的协[方差](@entry_id:200758)），计算出一个**最优**的增益，以最小化估计误差的**[均方误差](@entry_id:175403)**（Mean Squared Error, MSE），即 $\mathbb{E}[\|e(t)\|^2]$。这个最优增益 $L$ 是通过求解一个称为**代数[Riccati方程](@entry_id:184132)**（Algebraic Riccati Equation, ARE）的[矩阵方程](@entry_id:203695)得到的，它精确地平衡了对模型预测的信任和对带噪测量的信任 [@problem_id:2699845]。

#### [离散时间卡尔曼滤波器](@entry_id:755929)算法

卡尔曼滤波器在[离散时间系统](@entry_id:263935)中应用最为广泛。其算法是一个递归的两步过程：**预测**（prediction）和**更新**（update）。

考虑[离散时间系统](@entry_id:263935)：
$$
x_{k+1} = A x_k + B u_k + w_k, \quad w_k \sim \mathcal{N}(0, Q) \\
y_k = C x_k + v_k, \quad v_k \sim \mathcal{N}(0, R)
$$
其中 $w_k$ 和 $v_k$ 是均值为零、协[方差](@entry_id:200758)分别为 $Q$ 和 $R$ 的[高斯白噪声](@entry_id:749762)。卡尔曼滤波器算法如下 [@problem_id:2888342]：

**1. 预测（时间更新）**
这一步利用系统模型将上一时刻的估计值和协[方差](@entry_id:200758)向前传播到当前时刻，得到一个“先验”估计。
*   **状态预测**：
    $$
    \hat{x}_{k|k-1} = A \hat{x}_{k-1|k-1} + B u_{k-1}
    $$
*   **协[方差](@entry_id:200758)预测**：
    $$
    P_{k|k-1} = A P_{k-1|k-1} A^T + Q
    $$
    这里，$\hat{x}_{k-1|k-1}$ 和 $P_{k-1|k-1}$ 分别是上一时刻的“后验”[状态估计](@entry_id:169668)和[误差协方差](@entry_id:194780)。$\hat{x}_{k|k-1}$ 和 $P_{k|k-1}$ 是当前时刻基于过去所有信息的[先验估计](@entry_id:186098)。协[方差](@entry_id:200758)的传播不仅考虑了通过系统动态 $A$ 映射的不确定性，还加入了过程噪声 $Q$ 带来的新增不确定性。

**2. 更新（测量更新）**
这一步利用当前时刻的测量值 $y_k$ 来修正[先验估计](@entry_id:186098)，得到一个更精确的“后验”估计。
*   **创新（Innovation）**：
    $$
    \tilde{y}_k = y_k - C \hat{x}_{k|k-1}
    $$
    这是实际测量值与预测测量值之差。
*   **创新协[方差](@entry_id:200758)**：
    $$
    S_k = C P_{k|k-1} C^T + R
    $$
    它代表了创新的不确定性，由预测状态的不确定性和测量噪声的不确定性共同构成。
*   **[卡尔曼增益](@entry_id:145800)**：
    $$
    K_k = P_{k|k-1} C^T S_k^{-1}
    $$
    这是滤波器的核心。增益 $K_k$ 决定了我们应该在多大程度上相信创新信号。如果[测量噪声](@entry_id:275238)协[方差](@entry_id:200758) $R$ 很大，增益 $K_k$ 会变小，意味着我们更相信模型预测；反之，如果预测协[方差](@entry_id:200758) $P_{k|k-1}$ 很大，增益 $K_k$ 会变大，意味着我们更相信新的测量值。
*   **状态更新**：
    $$
    \hat{x}_{k|k} = \hat{x}_{k|k-1} + K_k \tilde{y}_k
    $$
    用加权的创新来修正[先验估计](@entry_id:186098)，得到后验估计。
*   **协[方差](@entry_id:200758)更新**：
    $$
    P_{k|k} = (I - K_k C) P_{k|k-1}
    $$
    测量信息的使用减小了状态估计的不确定性。为了更好的数值稳定性，通常使用**Joseph形式**的协[方差](@entry_id:200758)[更新方程](@entry_id:264802)：
    $$
    P_{k|k} = (I - K_k C) P_{k|k-1} (I - K_k C)^T + K_k R K_k^T
    $$

这个[预测-更新循环](@entry_id:269441)不断进行，使得[卡尔曼滤波器](@entry_id:145240)能够实时地、最优地融合模型预测和带噪测量，从而得到对系统状态的最佳估计。

### [非线性系统](@entry_id:168347)的状态估计

现实世界中的许多系统本质上是[非线性](@entry_id:637147)的。对于非线性系统，标准[卡尔曼滤波器](@entry_id:145240)的线性假设不再成立。当一个高斯分布通过一个[非线性](@entry_id:637147)函数传播时，其结果通常不再是高斯分布，这意味着均值和协[方差](@entry_id:200758)不再足以完全描述该[分布](@entry_id:182848)。

考虑[非线性系统](@entry_id:168347)模型：
$$
x_{k+1} = f(x_k, u_k) + w_k, \quad y_k = h(x_k) + v_k
$$
其中 $f$ 和 $h$ 是[非线性](@entry_id:637147)函数。

#### [扩展卡尔曼滤波器](@entry_id:199333)（EKF）：基于线性化的近似

**[扩展卡尔曼滤波器](@entry_id:199333)**（Extended Kalman Filter, EKF）是处理[非线性](@entry_id:637147)问题最经典的方法。其核心思想非常直接：在每个时间步，将[非线性](@entry_id:637147)函数 $f$ 和 $h$ 在当前最佳[状态估计](@entry_id:169668)点附近进行一阶泰勒展开，用一个[局部线性](@entry_id:266981)模型来近似[非线性系统](@entry_id:168347)，然后将标准[卡尔曼滤波器](@entry_id:145240)的方程应用于这个线性化的模型 [@problem_id:2888283]。

EKF的算法结构与标准KF非常相似，主要区别在于：
*   在**预测**步骤中，状态通过[非线性](@entry_id:637147)函数 $f$ 直接传播：$\hat{x}_{k|k-1} = f(\hat{x}_{k-1|k-1}, u_{k-1})$。而协[方差](@entry_id:200758)的传播则使用 $f$ 在 $\hat{x}_{k-1|k-1}$ 处的**[雅可比矩阵](@entry_id:264467)** $F_{k-1}$：$P_{k|k-1} = F_{k-1} P_{k-1|k-1} F_{k-1}^T + Q_{k-1}$。
*   在**更新**步骤中，预测的输出通过[非线性](@entry_id:637147)函数 $h$ 计算：$\hat{y}_k = h(\hat{x}_{k|k-1})$。而创新协[方差](@entry_id:200758)和[卡尔曼增益](@entry_id:145800)的计算则使用 $h$ 在 $\hat{x}_{k|k-1}$ 处的雅可比矩阵 $H_k$。

EKF的优点是概念简单，计算相对高效。然而，它的性能严重依赖于[局部线性化](@entry_id:169489)假设的有效性。如果系统高度[非线性](@entry_id:637147)，或者状态不确定性较大，[线性化误差](@entry_id:751298)可能会导致滤波器性能下降甚至发散。

#### [无迹卡尔曼滤波器](@entry_id:166733)（UKF）：一种免求导数的选择

为了克服EKF的局限性，**[无迹卡尔曼滤波器](@entry_id:166733)**（Unscented Kalman Filter, UKF）被提了出来。其基本哲学是：**近似一个[概率分布](@entry_id:146404)比近似一个[非线性](@entry_id:637147)函数要容易** [@problem_id:2888287]。

UKF避免了对[非线性](@entry_id:637147)函数进行显式线性化和计算雅可比矩阵。取而代之的是，它采用一种称为**[无迹变换](@entry_id:163212)**（Unscented Transform, UT）的确定性[采样策略](@entry_id:188482)：
1.  **选择Sigma点**：根据当前状态的均值和协[方差](@entry_id:200758)，精心选择一小组确定性的采样点，称为**Sigma点**。这些点的数量通常为 $2n+1$（其中 $n$ 是状态维数），它们的加权均值和协[方差](@entry_id:200758)精确匹配原始[分布](@entry_id:182848)的均值和协[方差](@entry_id:200758)。
2.  **传播Sigma点**：将每个Sigma点直接通过**真实**的[非线性](@entry_id:637147)函数（$f$或$h$）进行传播，得到一组变换后的点。
3.  **重构[分布](@entry_id:182848)**：通过计算变换后Sigma点的加权均值和协[方差](@entry_id:200758)，得到对输出[分布](@entry_id:182848)均值和协[方差](@entry_id:200758)的近似。

与EKF相比，UKF的优势在于：
*   **无需计算[雅可比矩阵](@entry_id:264467)**，这对于复杂的[非线性](@entry_id:637147)函数来说是一个巨大的便利。
*   **更高阶的精度**。对于高斯输入，UT可以精确捕捉到[非线性](@entry_id:637147)函数[泰勒展开](@entry_id:145057)的三阶项（对于均值）和二阶项（对于协[方差](@entry_id:200758)），而EKF只是[一阶近似](@entry_id:147559)。这使得UKF在处理强[非线性](@entry_id:637147)问题时通常表现出更优的性能和更强的鲁棒性。

UKF的主要计算开销在于选择Sigma点时需要对[协方差矩阵](@entry_id:139155)进行分解（如[Cholesky分解](@entry_id:147066)），其计算复杂度通常为 $O(n^3)$。尽管如此，其卓越的性能使其成为现代[非线性状态估计](@entry_id:269877)中一个非常有吸[引力](@entry_id:175476)的选择。