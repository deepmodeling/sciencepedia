{"hands_on_practices": [{"introduction": "对任何状态空间模型进行分析，第一步都是确定其是否为最小实现。本练习将引导你使用能控性和能观性矩阵这两个基本工具，来判断一个给定的系统实现是否“最小”——即它是否不包含任何冗余的、不可见的“隐藏”状态。这是理解系统真实复杂度的关键一步，也是后续进行模型简化和控制器设计的基础。", "problem": "考虑一个连续时间、单输入单输出的线性时不变（LTI）状态空间系统\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\qquad y(t) = C x(t) + D u(t),\n$$\n其中\n$$\nA = \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  2\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0 \\\\ 0\n\\end{bmatrix}, \\quad\nC = \\begin{bmatrix}\n1  0  0  1\n\\end{bmatrix}, \\quad\nD = \\begin{bmatrix}\n0\n\\end{bmatrix}.\n$$\n基于线性时不变系统的能达性（能控性）和能重构性（能观性）的基本概念，使用基于秩的定义，计算给定实现的能控性矩阵的秩和能观性矩阵的秩。严格依据这些秩以及一个实现是最小的当且仅当它既是能控的又是能观的这一定义，判断给定的实现是否是最小的。最后，确定在零初始条件下具有相同输入输出行为的最小实现的维数（麦克米伦阶）。将你的最终答案报告为一个整数。不需要四舍五入。", "solution": "该问题要求分析一个给定的连续时间线性时不变（LTI）状态空间实现，以确定其最小性，并找到产生相同输入输出行为的最小实现的维数。一个实现由矩阵 $(A, B, C, D)$ 定义。\n\n给定系统的阶数为 $n=4$，矩阵如下：\n$$\nA = \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  2\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0 \\\\ 0\n\\end{bmatrix}, \\quad\nC = \\begin{bmatrix}\n1  0  0  1\n\\end{bmatrix}, \\quad\nD = [0]\n$$\n一个实现是最小的当且仅当它既是能控的又是能观的。我们必须首先通过计算能控性矩阵和能观性矩阵的秩来评估这两个性质。\n\n首先，我们分析能控性。对于一个阶数为 $n$ 的系统，其能控性矩阵 $\\mathcal{C}$ 由 $\\mathcal{C} = \\begin{bmatrix} B  AB  \\cdots  A^{n-1}B \\end{bmatrix}$ 给出。对于 $n=4$，我们有 $\\mathcal{C} = \\begin{bmatrix} B  AB  A^2B  A^3B \\end{bmatrix}$。我们计算各列：\n$B = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$\n$AB = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  2 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$\n$A^2B = A(AB) = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$\n$A^3B = A(A^2B) = A \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$\n\n因此，能控性矩阵为：\n$$\n\\mathcal{C} = \\begin{bmatrix}\n0  1  0  0 \\\\\n1  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0\n\\end{bmatrix}\n$$\n$\\mathcal{C}$ 的秩是线性无关列的数量。前两列是线性无关的，而最后两列是零向量。因此，能控性矩阵的秩为 $\\text{rank}(\\mathcal{C}) = 2$。由于 $\\text{rank}(\\mathcal{C}) = 2  n = 4$，该系统不是能控的。\n\n接下来，我们分析能观性。对于一个阶数为 $n$ 的系统，其能观性矩阵 $\\mathcal{O}$ 由 $\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{n-1} \\end{bmatrix}$ 给出。对于 $n=4$，我们有 $\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\end{bmatrix}$。我们计算各行：\n$C = \\begin{bmatrix} 1  0  0  1 \\end{bmatrix}$\n$CA = \\begin{bmatrix} 1  0  0  1 \\end{bmatrix} \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  2 \\end{bmatrix} = \\begin{bmatrix} 0  1  0  2 \\end{bmatrix}$\n$CA^2 = (CA)A = \\begin{bmatrix} 0  1  0  2 \\end{bmatrix} \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  2 \\end{bmatrix} = \\begin{bmatrix} 0  0  0  4 \\end{bmatrix}$\n$CA^3 = (CA^2)A = \\begin{bmatrix} 0  0  0  4 \\end{bmatrix} \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  2 \\end{bmatrix} = \\begin{bmatrix} 0  0  0  8 \\end{bmatrix}$\n\n因此，能观性矩阵为：\n$$\n\\mathcal{O} = \\begin{bmatrix}\n1  0  0  1 \\\\\n0  1  0  2 \\\\\n0  0  0  4 \\\\\n0  0  0  8\n\\end{bmatrix}\n$$\n$\\mathcal{O}$ 的秩是线性无关行的数量。第四行是第三行的标量倍（$R_4 = 2R_3$）。前三行是线性无关的。因此，能观性矩阵的秩为 $\\text{rank}(\\mathcal{O}) = 3$。由于 $\\text{rank}(\\mathcal{O}) = 3  n = 4$，该系统不是能观的。\n\n由于该系统既不是能控的也不是能观的，所以给定的实现不是最小的。\n\n最小实现的维数被称为系统的麦克米伦阶。它等于系统传递函数 $G(s) = C(sI-A)^{-1}B + D$ 的阶数。给定 $D = [0]$，我们计算 $G(s) = C(sI-A)^{-1}B$。\n首先，我们求 $(sI-A)$ 的逆：\n$$\nsI - A = \\begin{bmatrix} s  -1  0  0 \\\\ 0  s  0  0 \\\\ 0  0  s-1  0 \\\\ 0  0  0  s-2 \\end{bmatrix}\n$$\n其逆矩阵为：\n$$\n(sI - A)^{-1} = \\begin{bmatrix} \\frac{1}{s}  \\frac{1}{s^2}  0  0 \\\\ 0  \\frac{1}{s}  0  0 \\\\ 0  0  \\frac{1}{s-1}  0 \\\\ 0  0  0  \\frac{1}{s-2} \\end{bmatrix}\n$$\n现在，我们计算乘积 $(sI-A)^{-1}B$：\n$$\n(sI-A)^{-1}B = \\begin{bmatrix} \\frac{1}{s}  \\frac{1}{s^2}  0  0 \\\\ 0  \\frac{1}{s}  0  0 \\\\ 0  0  \\frac{1}{s-1}  0 \\\\ 0  0  0  \\frac{1}{s-2} \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{s^2} \\\\ \\frac{1}{s} \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n最后，我们计算传递函数 $G(s)$：\n$$\nG(s) = C(sI-A)^{-1}B = \\begin{bmatrix} 1  0  0  1 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{s^2} \\\\ \\frac{1}{s} \\\\ 0 \\\\ 0 \\end{bmatrix} = (1)\\left(\\frac{1}{s^2}\\right) + (0)\\left(\\frac{1}{s}\\right) + (0)(0) + (1)(0) = \\frac{1}{s^2}\n$$\n系统的传递函数为 $G(s) = \\frac{1}{s^2}$。有理传递函数的阶数是其分母多项式的次数，前提是分数是不可约的。在这里，次数是 $2$。\n这个阶数就是麦克米伦阶，它对应于系统任何最小实现的维数。在原始的 $n=4$ 阶状态空间实现中，不可控和不可观的模态在传递函数中被抵消了。\n因此，最小实现的维数是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2882884"}, {"introduction": "最小实现为何如此重要？本练习将通过一个带有“极零点对消”的传递函数，逆向构造一个非最小实现，从而揭示其背后隐藏的风险。你将亲手构建一个表面上看似稳定，但内部却隐藏着不稳定模式的系统[@problem_id:2882898]，由此深刻理解为什么仅仅依赖传递函数进行分析可能是片面的，甚至在工程实践中是危险的。", "problem": "考虑复频率变量 $s$ 的标量、严格真传递函数，\n$$\nG(s) = \\frac{s - 1}{(s - 1)(s + 2)}.\n$$\n该函数在分子和分母中都包含一个可消去的因子 $(s - 1)$。在标准的线性时不变 (LTI) 状态空间框架下，使用单输入单输出实现 $(A,B,C,D)$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$，$B \\in \\mathbb{R}^{2 \\times 1}$，$C \\in \\mathbb{R}^{1 \\times 2}$ 且 $D \\in \\mathbb{R}$。\n\n任务：\n1) 仅使用 LTI 系统的能控性和能观性的核心定义，以及状态空间模型的标准输入输出映射，构建一个显式的二阶非最小实现 $(A,B,C,D)$。该实现包含位于 $s=1$ 处的不稳定内部模态，但其输入输出传递函数与 $G(s)$ 一致，从而表现出内部不稳定对消。你的构造必须使用一个对角状态矩阵\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix}\n$$\n且 $D = 0$。请指定一个能实现此目标的 $B$ 和 $C$ 的具体选择。\n2) 应用与能控性和能观性定义相关的秩检验，验证哪个模态是不可达或不可观的，并解释为什么第 1 部分中的实现是非最小的。然后，利用 Kalman 分解的概念内容，通过移除不可控或不可观子空间，将你的实现约简为最小实现。写出约简后的 $(A_{\\min}, B_{\\min}, C_{\\min}, D_{\\min})$。\n3) 从你约简后的实现中，计算最小传递函数 $G_{\\min}(s)$，并表示为关于 $s$ 的单个有理表达式。\n\n答案规格：\n- 仅报告最终的闭式最小传递函数 $G_{\\min}(s)$ 作为你的最终答案。最终答案中不要包含中间矩阵。无需四舍五入，也无物理单位。", "solution": "该问题陈述在科学上是合理的、适定的、客观的，并包含足够的信息以获得唯一解。这是线性系统理论中的一个标准问题。因此，我将着手解决它。\n\n问题是为一个由下式描述的系统寻找一个最小实现及其对应的传递函数\n$$\nG(s) = \\frac{s - 1}{(s - 1)(s + 2)}.\n$$\n该过程将按规定分三部分执行。\n\n第 $1$ 部分：非最小实现的构建\n\n线性时不变 (LTI) 状态空间系统 $(A,B,C,D)$ 的传递函数由公式 $H(s) = C(sI - A)^{-1}B + D$ 给出。\n我们给定一个对角状态矩阵 $A = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix}$ 和直通项 $D = 0$。状态维数为 $n=2$。\n首先，我们计算矩阵 $(sI - A)^{-1}$：\n$$\nsI - A = \\begin{pmatrix} s  0 \\\\ 0  s \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} = \\begin{pmatrix} s-1  0 \\\\ 0  s+2 \\end{pmatrix}\n$$\n$$\n(sI - A)^{-1} = \\begin{pmatrix} \\frac{1}{s-1}  0 \\\\ 0  \\frac{1}{s+2} \\end{pmatrix}\n$$\n设输入和输出矩阵为 $B = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$ 和 $C = \\begin{pmatrix} c_1  c_2 \\end{pmatrix}$。则传递函数为：\n$$\nH(s) = \\begin{pmatrix} c_1  c_2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{s-1}  0 \\\\ 0  \\frac{1}{s+2} \\end{pmatrix} \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix} = \\frac{c_1 b_1}{s-1} + \\frac{c_2 b_2}{s+2}\n$$\n将各项通分合并后得到：\n$$\nH(s) = \\frac{c_1 b_1 (s+2) + c_2 b_2 (s-1)}{(s-1)(s+2)} = \\frac{(c_1 b_1 + c_2 b_2)s + (2c_1 b_1 - c_2 b_2)}{(s-1)(s+2)}\n$$\n该实现的传递函数 $H(s)$ 必须与给定的 $G(s) = \\frac{s-1}{(s-1)(s+2)}$ 一致。通过令分子相等，我们得到关于乘积 $p_1 = c_1 b_1$ 和 $p_2 = c_2 b_2$ 的线性方程组：\n\\begin{align*} c_1 b_1 + c_2 b_2 = 1 \\\\ 2c_1 b_1 - c_2 b_2 = -1 \\end{align*}\n将两方程相加得到 $3c_1 b_1 = 0$，这意味着 $c_1 b_1 = 0$。将此结果代回第一个方程，得到 $c_2 b_2 = 1$。\n\n条件 $c_1 b_1 = 0$ 是在 $s=1$ 处发生极点-零点对消的根源。这种对消表明与特征值 $\\lambda_1 = 1$ 相关的模态是不可控的（如果 $b_1=0$）、不可观的（如果 $c_1=0$）或两者兼有。我们必须构造一个这样的实现。\n\n我们选择使 $s=1$ 处的模态不可控。这需要设置 $b_1 = 0$。因此，对于 $c_1$ 的任何选择，条件 $c_1 b_1 = 0$ 都得到满足。第二个条件 $c_2 b_2 = 1$ 可以通过选择（例如）$b_2 = 1$ 和 $c_2 = 1$ 来满足。为确保系统不是不必要的退化，我们可以选择一个非零的 $c_1$，例如 $c_1 = 1$。\n\n因此，一个显式的非最小实现是：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  1 \\end{pmatrix}, \\quad D = 0\n$$\n\n第 $2$ 部分：能控性、能观性和约简\n\n现在我们分析所构建实现的性质。\n能控性矩阵是 $\\mathcal{C} = \\begin{pmatrix} B  AB \\end{pmatrix}$。\n$$\nAB = \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix}\n$$\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  0 \\\\ 1  -2 \\end{pmatrix}\n$$\n$\\mathcal{C}$ 的秩为 $\\text{rank}(\\mathcal{C}) = 1$。由于秩小于状态维数 $n=2$，该系统不是完全能控的。不可控模态与特征值 $\\lambda_1 = 1$ 相关联。这一点可以通过 Hautus-Popov-Belevitch 检验来确认：$\\text{rank}\\begin{pmatrix} \\lambda_1 I - A  B \\end{pmatrix} = \\text{rank}\\begin{pmatrix} 1I - A  B \\end{pmatrix} = \\text{rank}\\begin{pmatrix} 0  0  0 \\\\ 0  3  1 \\end{pmatrix} = 1  2$。\n\n能观性矩阵是 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$。\n$$\nCA = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\end{pmatrix}\n$$\n$$\n\\mathcal{O} = \\begin{pmatrix} 1  1 \\\\ 1  -2 \\end{pmatrix}\n$$\n$\\mathcal{O}$ 的行列式是 $(1)(-2) - (1)(1) = -3 \\neq 0$。$\\mathcal{O}$ 的秩为 $2$，因此系统是完全能观的。\n该实现是非最小的，因为它不是完全能控的。\n\n为了找到最小实现，我们应用 Kalman 分解。我们需要找到一个坐标变换 $x = Tz$，以分离能控子空间和不可控子空间。能控子空间是 $\\mathcal{C}$ 的值域，即 $\\text{span}\\left\\{\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\right\\}$。不可控子空间对应于 $\\text{span}\\left\\{\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\right\\}$。标准基向量已经表示了所需分解，但顺序是错误的。我们可以使用一个置换矩阵 $T = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$ 来重排状态，因此 $T^{-1} = T$。变换后的系统是 $(\\hat{A}, \\hat{B}, \\hat{C}, \\hat{D}) = (T^{-1}AT, T^{-1}B, CT, D)$。\n$$\n\\hat{A} = T^{-1}AT = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -2 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\n\\hat{B} = T^{-1}B = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\hat{C} = CT = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix}\n$$\n变换后的系统是：\n$$\n\\hat{A} = \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix}, \\quad \\hat{B} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\hat{C} = \\begin{pmatrix} 1  1 \\end{pmatrix}\n$$\n该系统处于针对不可控系统的 Kalman 形式：\n$$\n\\hat{A} = \\begin{pmatrix} A_c  A_{12} \\\\ 0  A_{\\bar{c}} \\end{pmatrix}, \\quad \\hat{B} = \\begin{pmatrix} B_c \\\\ 0 \\end{pmatrix}, \\quad \\hat{C} = \\begin{pmatrix} C_c  C_{\\bar{c}} \\end{pmatrix}\n$$\n其中能控子系统 $(A_c, B_c, C_c)$ 构成了最小实现。通过观察可得：\n$$\nA_{\\min} = A_c = [-2], \\quad B_{\\min} = B_c = [1], \\quad C_{\\min} = C_c = [1], \\quad D_{\\min} = D = 0\n$$\n\n第 $3$ 部分：最小传递函数\n\n最后，我们从最小状态空间实现 $(A_{\\min}, B_{\\min}, C_{\\min}, D_{\\min})$ 计算传递函数。\n$$\nG_{\\min}(s) = C_{\\min}(sI - A_{\\min})^{-1}B_{\\min} + D_{\\min}\n$$\n对于这个一阶系统：\n$$\nG_{\\min}(s) = [1] \\cdot (s - (-2))^{-1} \\cdot [1] + 0 = \\frac{1}{s+2}\n$$\n这就是最小传递函数，它对应于在 $s=1$ 处进行极点-零点对消后的原始传递函数。", "answer": "$$\n\\boxed{\\frac{1}{s+2}}\n$$", "id": "2882898"}, {"introduction": "在学会了如何诊断非最小系统并理解其危害之后，我们现在转向解决方案。这个高级练习将指导你完成Kalman标准分解的全过程，这是一种强大而系统化的方法，用于“解剖”一个状态空间模型。通过将系统变换到一个特殊的块结构，你将学会如何精确地分离并提取出系统的能控能观核心，也就是我们追求的最小实现[@problem_id:2882924]。", "problem": "考虑以下连续时间、单输入单输出的线性时不变（LTI）状态空间实现，其状态向量维度为四：\n$$\nA = \\begin{pmatrix}\n-2  0  0  0\\\\\n-2  -1  6  -6\\\\\n0  0  5  -6\\\\\n0  0  0  -1\n\\end{pmatrix},\\qquad\nB = \\begin{pmatrix}1\\\\ 1\\\\ 0\\\\ 0\\end{pmatrix},\\qquad\nC = \\begin{pmatrix}1  -1  1  -1\\end{pmatrix},\\qquad\nD = 0.\n$$\n已知该实现是非最小的。仅使用能控性和能观性的基本定义（能控子空间为 $\\{B,\\,AB,\\,A^{2}B,\\,\\dots\\}$ 的张成空间，不能观子空间为包含在能观性映射核中的最大 $A$-不变子空间）以及 Kalman 典范分解的概念结构来：\n\n1. 明确确定能控子空间和不能观子空间。\n2. 构造一个明确的相似变换矩阵 $T$，将该实现变换为 Kalman 典范型，即变换到一个坐标基，在该基中状态矩阵 $A'$ 是一个分块上三角矩阵，包含一个能控块及其补，输入矩阵 $B'$ 在对应于不能控部分有零行，输出矩阵 $C'$ 在对应于不能观部分有零列。提供变换后的四元组 $(A',B',C',D')$。\n3. 从 Kalman 典范型中，通过分离能控且能观的部分，提取最小实现 $(A_{m},B_{m},C_{m},D_{m})$。\n4. 计算最小实现的标量传递函数 $G_{m}(s) = C_{m}(sI - A_{m})^{-1} B_{m} + D_{m}$，结果表示为关于 $s$ 的单个闭式有理函数。\n\n你的最终答案必须是等于 $G_{m}(s)$ 的单个解析表达式。不要包含任何单位。不需要进行数值四舍五入。", "solution": "对问题陈述进行有效性审查。这是一个线性系统理论中关于给定状态空间模型的最小实现的适定问题。所有提供的数据（$A$、$B$、$C$、$D$）在数学上是一致的，并且足以求解。指令清晰且可形式化。该问题被认定为有效。\n\n解题过程按要求分为四个阶段。\n\n1.  **确定能控和不可观子空间**\n\n能控子空间，记为 $\\mathcal{R}$，是由能控性矩阵 $\\mathcal{C}_{\\text{matrix}} = \\begin{pmatrix} B  AB  A^2B  A^3B \\end{pmatrix}$ 的列向量张成的空间。\n状态维度为 $n=4$。我们计算所需的向量：\n$B = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$AB = \\begin{pmatrix} -2  0  0  0 \\\\ -2  -1  6  -6 \\\\ 0  0  5  -6 \\\\ 0  0  0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -3 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$A^2B = A(AB) = \\begin{pmatrix} -2  0  0  0 \\\\ -2  -1  6  -6 \\\\ 0  0  5  -6 \\\\ 0  0  0  -1 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ -3 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 7 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n向量 $B$ 和 $AB$ 是线性无关的。任何 $k \\geq 2$ 的向量 $A^k B$ 都会位于 $B$ 和 $AB$ 的张成空间内，例如 $A^2B = -2B - 3AB$。\n能控性矩阵的秩为 $2$，表明系统不是完全能控的。能控子空间 $\\mathcal{R}$ 的维度为 $2$。由于 $\\text{span}\\{B, AB\\} = \\text{span}\\{e_1, e_2\\}$，其中 $e_1=\\begin{pmatrix}1000\\end{pmatrix}^T$ 且 $e_2=\\begin{pmatrix}0100\\end{pmatrix}^T$，所以我们可以选择标准基向量作为基。\n因此，$\\mathcal{R} = \\text{span} \\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\}$。\n\n不可观子空间，记为 $\\mathcal{N}$，是能观性矩阵 $\\mathcal{O}_{\\text{matrix}} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\end{pmatrix}$ 的零空间。\n不可观子空间 $\\mathcal{N}$ 是所有满足 $\\mathcal{O}_{\\text{matrix}}x=0$ 的向量 $x = \\begin{pmatrix} x_1  x_2  x_3  x_4 \\end{pmatrix}^T$ 的集合。求解线性方程组 $Cx=0, CAx=0, \\dots$ 得到条件 $x_1=0$ 和 $x_2=x_3-x_4$。\n$\\mathcal{N}$ 中的一个向量具有形式 $\\begin{pmatrix} 0 \\\\ x_3-x_4 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = x_3\\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} + x_4\\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n能观性矩阵的秩为 $2$，所以系统不是完全能观的。不可观子空间 $\\mathcal{N}$ 的维度为 $2$，由基 $\\{f_1, f_2\\}$ 张成，其中 $f_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 且 $f_2 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n$\\mathcal{N} = \\text{span} \\left\\{ \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}$。\n\n2.  **进行能控性分解**\n\n为了分离系统的能控与不能控部分，我们执行能控性分解。我们寻找一个坐标变换，使得系统矩阵呈现分块结构。由于能控子空间 $\\mathcal{R}$ 是 $A$-不变的（$Ae_1 = -2e_1 - 2e_2 \\in \\mathcal{R}$ 且 $Ae_2 = -e_2 \\in \\mathcal{R}$），我们可以选择一个以 $\\mathcal{R}$ 的基向量开头的基。幸运的是，给定的系统已经处于能控性分解的形式。\n我们可以将状态向量 $x$ 划分为 $x = \\begin{pmatrix} x_c \\\\ x_{\\bar{c}} \\end{pmatrix}$，其中 $x_c = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 属于能控子空间，而 $x_{\\bar{c}} = \\begin{pmatrix} x_3 \\\\ x_4 \\end{pmatrix}$ 属于其补空间。\n在这种划分下，系统矩阵已经呈现出所需的分块上三角形式：\n$A = \\begin{pmatrix} A_c  A_{12} \\\\ 0  A_{\\bar{c}} \\end{pmatrix} = \\begin{pmatrix} -2  0  0  0 \\\\ -2  -1  6  -6 \\\\ \\hline 0  0  5  -6 \\\\ 0  0  0  -1 \\end{pmatrix}$\n$B = \\begin{pmatrix} B_c \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ \\hline 0 \\\\ 0 \\end{pmatrix}$\n$C = \\begin{pmatrix} C_c  C_{\\bar{c}} \\end{pmatrix} = \\begin{pmatrix} 1  -1  1  -1 \\end{pmatrix}$\n由于系统已处于此形式，相似变换矩阵为单位矩阵 $T=I$，变换后的四元组 $(A',B',C',D')$ 与原始的 $(A,B,C,D)$ 相同。\n\n3.  **提取最小实现**\n\n系统的传递函数仅由其能控部分决定。因此，我们提取能控子系统 $(A_c, B_c, C_c)$：\n$A_c = \\begin{pmatrix} -2  0 \\\\ -2  -1 \\end{pmatrix}$, $B_c = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, $C_c = \\begin{pmatrix} 1  -1 \\end{pmatrix}$\n接下来，我们必须检查这个能控子系统是否能观。其能观性矩阵为：\n$\\mathcal{O}_c = \\begin{pmatrix} C_c \\\\ C_c A_c \\end{pmatrix}$\n$C_c A_c = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} -2  0 \\\\ -2  -1 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\end{pmatrix}$\n$\\mathcal{O}_c = \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix}$\n由于 $\\det(\\mathcal{O}_c) = 1 \\neq 0$，$\\mathcal{O}_c$ 的秩为 $2$。因此，该能控子系统是能观的。\n这证实了该系统不存在能控但不可观的部分，系统的所有不可观状态都在不能控子空间内。因此，能控且能观的子系统就是我们提取的能控子系统。\n最小实现为 $(A_m, B_m, C_m, D_m)$:\n$A_m = \\begin{pmatrix} -2  0 \\\\ -2  -1 \\end{pmatrix}$\n$B_m = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n$C_m = \\begin{pmatrix} 1  -1 \\end{pmatrix}$\n$D_m = D = 0$。\n\n4.  **计算传递函数**\n\n最小实现的传递函数是 $G_m(s) = C_m(sI - A_m)^{-1}B_m + D_m$。\n$sI - A_m = \\begin{pmatrix} s - (-2)  -0 \\\\ -(-2)  s - (-1) \\end{pmatrix} = \\begin{pmatrix} s+2  0 \\\\ 2  s+1 \\end{pmatrix}$。\n其逆矩阵为 $(sI - A_m)^{-1} = \\frac{1}{(s+2)(s+1)} \\begin{pmatrix} s+1  0 \\\\ -2  s+2 \\end{pmatrix}$。\n现在，我们计算 $G_m(s)$：\n$G_m(s) = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\frac{1}{(s+2)(s+1)} \\begin{pmatrix} s+1  0 \\\\ -2  s+2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n$= \\frac{1}{s^2+3s+2} \\begin{pmatrix} 1  -1 \\end{pmatrix} \\left( \\begin{pmatrix} s+1  0 \\\\ -2  s+2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right)$\n$= \\frac{1}{s^2+3s+2} \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} s+1 \\\\ -2+s+2 \\end{pmatrix} = \\frac{1}{s^2+3s+2} \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} s+1 \\\\ s \\end{pmatrix}$\n$= \\frac{1}{s^2+3s+2} ((s+1) - s)$\n$= \\frac{1}{s^2+3s+2}$。\n\n最小传递函数的极点是 $\\{-1, -2\\}$，它们是原始矩阵 $A$ 的特征值 $\\{-2, -1, 5, -1\\}$ 的一个子集。对应于特征值 $5$ 和其中一个 $-1$ 的模式已经被抵消，因为它们对应于不能控或不可观的状态。", "answer": "$$\n\\boxed{\\frac{1}{s^2+3s+2}}\n$$", "id": "2882924"}]}