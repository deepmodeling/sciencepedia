{"hands_on_practices": [{"introduction": "要真正掌握无迹卡尔曼滤波器 (UKF)，我们必须首先理解其核心构件——无迹变换 (Unscented Transform, UT)。本练习将滤波器本身暂放一边，聚焦于 UT 如何通过非线性函数传递统计矩。通过对一个简单的二次函数 $g(x)=x^2$ 进行解析推导，并将其结果与真实统计矩进行比较 [@problem_id:2886759]，我们将深刻理解该方法的威力和精确性，从而为后续学习打下坚实的理论基础。", "problem": "考虑一个标量随机变量 $x \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，它通过非线性函数 $g(x)=x^{2}$。您将分析从输入分布到输出的两种映射：(i) 如同在无迹卡尔曼滤波器中使用的无迹变换 (Unscented Transform, UT) 和 (ii) 在高斯定律下矩的精确变换。请使用以下核心定义。\n\n对于标量无迹变换 (UT)，维数 $n=1$，调节参数 $\\alpha0$、$\\kappa \\in \\mathbb{R}$ 和 $\\beta \\in \\mathbb{R}$，定义\n- 缩放参数 $\\lambda = \\alpha^{2}(n+\\kappa)-n$，\n- sigma 点 $x_{0}=\\mu$、$x_{1}=\\mu+\\sqrt{(n+\\lambda)\\sigma^{2}}$ 和 $x_{2}=\\mu-\\sqrt{(n+\\lambda)\\sigma^{2}}$，\n- 用于变换后均值的权重 $W_{0}^{(m)}=\\dfrac{\\lambda}{n+\\lambda}$ 和 $W_{i}^{(m)}=\\dfrac{1}{2(n+\\lambda)}$（对于 $i\\in\\{1,2\\}$），\n- 用于变换后协方差的权重 $W_{0}^{(c)}=\\dfrac{\\lambda}{n+\\lambda}+\\left(1-\\alpha^{2}+\\beta\\right)$ 和 $W_{i}^{(c)}=\\dfrac{1}{2(n+\\lambda)}$（对于 $i\\in\\{1,2\\}$）。\n\n$y=g(x)$ 的 UT 预测均值定义为 $\\bar{y}_{\\mathrm{UT}}=\\sum_{i=0}^{2}W_{i}^{(m)}g(x_{i})$，UT 预测方差为 $S_{\\mathrm{UT}}=\\sum_{i=0}^{2}W_{i}^{(c)}\\left(g(x_{i})-\\bar{y}_{\\mathrm{UT}}\\right)^{2}$。\n\n仅从上述 UT 定义和高斯分布的标准性质出发，推导出以下各项的闭式解：\n- 对于 $g(x)=x^{2}$ 的 UT 预测均值 $\\bar{y}_{\\mathrm{UT}}$，\n- 对于 $g(x)=x^{2}$ 的 UT 预测方差 $S_{\\mathrm{UT}}$，\n- 精确均值 $\\mathbb{E}[x^{2}]$，\n- 精确方差 $\\mathrm{Var}[x^{2}]$。\n\n然后比较这些表达式，并在您的推理中，找出使 UT 方差与精确方差相匹配的任何参数条件。\n\n将您的最终答案表示为一个单行矩阵，按顺序包含四个表达式 $\\left(\\bar{y}_{\\mathrm{UT}},\\,S_{\\mathrm{UT}},\\,\\mathbb{E}[x^{2}],\\,\\mathrm{Var}[x^{2}]\\right)$，并用 $\\mu$、$\\sigma$、$\\alpha$、$\\beta$ 和 $\\kappa$ 表示。不需要数值四舍五入，这些量也没有单位。", "solution": "问题陈述需要经过验证。\n\n**步骤 1：提取已知条件**\n- 一个标量随机变量 $x$ 服从正态分布：$x \\sim \\mathcal{N}(\\mu, \\sigma^{2})$。\n- 非线性函数为 $g(x) = x^{2}$。\n- 维数为 $n=1$。\n- 调节参数为 $\\alpha  0$、$\\kappa \\in \\mathbb{R}$ 和 $\\beta \\in \\mathbb{R}$。\n- 缩放参数定义为 $\\lambda = \\alpha^{2}(n+\\kappa) - n$。\n- sigma 点为 $x_{0} = \\mu$、$x_{1} = \\mu + \\sqrt{(n+\\lambda)\\sigma^{2}}$ 和 $x_{2} = \\mu - \\sqrt{(n+\\lambda)\\sigma^{2}}$。\n- 变换后均值的权重为 $W_{0}^{(m)} = \\frac{\\lambda}{n+\\lambda}$ 和 $W_{i}^{(m)} = \\frac{1}{2(n+\\lambda)}$（对于 $i \\in \\{1, 2\\}$）。\n- 变换后协方差的权重为 $W_{0}^{(c)} = \\frac{\\lambda}{n+\\lambda} + (1 - \\alpha^{2} + \\beta)$ 和 $W_{i}^{(c)} = \\frac{1}{2(n+\\lambda)}$（对于 $i \\in \\{1, 2\\}$）。\n- $y=g(x)$ 的 UT 预测均值为 $\\bar{y}_{\\mathrm{UT}} = \\sum_{i=0}^{2} W_{i}^{(m)} g(x_{i})$。\n- UT 预测方差为 $S_{\\mathrm{UT}} = \\sum_{i=0}^{2} W_{i}^{(c)} (g(x_{i}) - \\bar{y}_{\\mathrm{UT}})^{2}$。\n- 需要推导的量为 $\\bar{y}_{\\mathrm{UT}}$、$S_{\\mathrm{UT}}$、$\\mathbb{E}[x^{2}]$ 和 $\\mathrm{Var}[x^{2}]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是良定且客观的。它基于无迹变换 (UT) 的标准公式和高斯分布的统计特性，这些都是信号处理和估计理论中的基石概念。该问题是自洽的，提供了所有必要的定义和参数。目标以数学精度陈述，推导过程会得出一组唯一的表达式。不存在逻辑矛盾、事实错误或含糊不清之处。\n\n**步骤 3：结论与行动**\n该问题被认为是有效的。将提供完整的解决方案。\n\n**无迹变换 (UT) 和精确矩的推导**\n\n首先，我们将 UT 参数针对给定维数 $n=1$ 进行特化。\n缩放参数 $\\lambda$ 变为：\n$$ \\lambda = \\alpha^{2}(1+\\kappa) - 1 $$\n复合参数 $n+\\lambda$ 简化为 $1+\\lambda = \\alpha^{2}(1+\\kappa)$。为使 sigma 点为实数，一个隐含的假设是 $(n+\\lambda)\\sigma^{2} \\ge 0$。由于 $\\sigma^{2} \\ge 0$，我们需要 $1+\\lambda \\ge 0$，如果我们假设 $1+\\kappa \\ge 0$，那么由于 $\\alpha^{2}(1+\\kappa) \\ge 0$ 该条件为真。问题中没有说明这一点，但对于实值变换是必要的。我们假设此条件成立并继续推导。\n\nsigma 点为：\n$$ x_{0} = \\mu $$\n$$ x_{1} = \\mu + \\sqrt{(1+\\lambda)\\sigma^{2}} = \\mu + \\sqrt{\\alpha^{2}(1+\\kappa)\\sigma^{2}} = \\mu + \\alpha\\sqrt{1+\\kappa}\\sigma $$\n$$ x_{2} = \\mu - \\sqrt{(1+\\lambda)\\sigma^{2}} = \\mu - \\sqrt{\\alpha^{2}(1+\\kappa)}\\sigma $$\n\n均值的权重为：\n$$ W_{0}^{(m)} = \\frac{\\lambda}{1+\\lambda} = \\frac{\\alpha^{2}(1+\\kappa) - 1}{\\alpha^{2}(1+\\kappa)} $$\n$$ W_{1}^{(m)} = W_{2}^{(m)} = \\frac{1}{2(1+\\lambda)} = \\frac{1}{2\\alpha^{2}(1+\\kappa)} $$\n\n我们将 sigma 点通过非线性函数 $g(x) = x^{2}$ 进行传播：\n$$ y_{0} = g(x_{0}) = \\mu^{2} $$\n$$ y_{1} = g(x_{1}) = \\left(\\mu + \\alpha\\sqrt{1+\\kappa}\\sigma\\right)^{2} = \\mu^{2} + 2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\alpha^{2}(1+\\kappa)\\sigma^{2} $$\n$$ y_{2} = g(x_{2}) = \\left(\\mu - \\alpha\\sqrt{1+\\kappa}\\sigma\\right)^{2} = \\mu^{2} - 2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\alpha^{2}(1+\\kappa)\\sigma^{2} $$\n\n**1. UT 预测均值 $\\bar{y}_{\\mathrm{UT}}$**\nUT 预测均值为 $\\bar{y}_{\\mathrm{UT}} = \\sum_{i=0}^{2} W_{i}^{(m)} y_{i}$。\n$$ \\bar{y}_{\\mathrm{UT}} = W_{0}^{(m)}y_{0} + W_{1}^{(m)}y_{1} + W_{2}^{(m)}y_{2} $$\n由于 $W_{1}^{(m)} = W_{2}^{(m)}$，这变为：\n$$ \\bar{y}_{\\mathrm{UT}} = W_{0}^{(m)}y_{0} + W_{1}^{(m)}(y_{1} + y_{2}) $$\n和 $y_{1} + y_{2}$ 为：\n$$ y_{1} + y_{2} = \\left(\\mu^{2} + 2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\alpha^{2}(1+\\kappa)\\sigma^{2}\\right) + \\left(\\mu^{2} - 2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\alpha^{2}(1+\\kappa)\\sigma^{2}\\right) = 2\\mu^{2} + 2\\alpha^{2}(1+\\kappa)\\sigma^{2} $$\n代入权重和传播后的点：\n$$ \\bar{y}_{\\mathrm{UT}} = \\left(\\frac{\\alpha^{2}(1+\\kappa) - 1}{\\alpha^{2}(1+\\kappa)}\\right)\\mu^{2} + \\left(\\frac{1}{2\\alpha^{2}(1+\\kappa)}\\right)\\left(2\\mu^{2} + 2\\alpha^{2}(1+\\kappa)\\sigma^{2}\\right) $$\n$$ \\bar{y}_{\\mathrm{UT}} = \\left(\\frac{\\alpha^{2}(1+\\kappa) - 1}{\\alpha^{2}(1+\\kappa)}\\right)\\mu^{2} + \\frac{1}{\\alpha^{2}(1+\\kappa)}\\mu^{2} + \\sigma^{2} $$\n$$ \\bar{y}_{\\mathrm{UT}} = \\mu^{2}\\left(\\frac{\\alpha^{2}(1+\\kappa) - 1 + 1}{\\alpha^{2}(1+\\kappa)}\\right) + \\sigma^{2} = \\mu^{2}\\left(\\frac{\\alpha^{2}(1+\\kappa)}{\\alpha^{2}(1+\\kappa)}\\right) + \\sigma^{2} $$\n$$ \\bar{y}_{\\mathrm{UT}} = \\mu^{2} + \\sigma^{2} $$\n\n**2. UT 预测方差 $S_{\\mathrm{UT}}$**\nUT 预测方差为 $S_{\\mathrm{UT}} = \\sum_{i=0}^{2} W_{i}^{(c)}(y_{i} - \\bar{y}_{\\mathrm{UT}})^{2}$。\n协方差的权重为：\n$$ W_{0}^{(c)} = \\frac{\\lambda}{1+\\lambda} + (1 - \\alpha^{2} + \\beta) = \\frac{\\alpha^{2}(1+\\kappa)-1}{\\alpha^{2}(1+\\kappa)} + 1 - \\alpha^{2} + \\beta $$\n$$ W_{1}^{(c)} = W_{2}^{(c)} = \\frac{1}{2(1+\\lambda)} = \\frac{1}{2\\alpha^{2}(1+\\kappa)} $$\n我们计算与预测均值的偏差：\n$$ y_{0} - \\bar{y}_{\\mathrm{UT}} = \\mu^{2} - (\\mu^{2} + \\sigma^{2}) = -\\sigma^{2} $$\n$$ y_{1} - \\bar{y}_{\\mathrm{UT}} = \\left(\\mu^{2} + 2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\alpha^{2}(1+\\kappa)\\sigma^{2}\\right) - (\\mu^{2} + \\sigma^{2}) = 2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\left(\\alpha^{2}(1+\\kappa) - 1\\right)\\sigma^{2} $$\n$$ y_{2} - \\bar{y}_{\\mathrm{UT}} = \\left(\\mu^{2} - 2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\alpha^{2}(1+\\kappa)\\sigma^{2}\\right) - (\\mu^{2} + \\sigma^{2}) = -2\\mu\\alpha\\sqrt{1+\\kappa}\\sigma + \\left(\\alpha^{2}(1+\\kappa) - 1\\right)\\sigma^{2} $$\n注意 $\\alpha^{2}(1+\\kappa)-1 = \\lambda$。所以偏差为：\n$$ y_{1} - \\bar{y}_{\\mathrm{UT}} = 2\\mu\\sqrt{1+\\lambda}\\sigma + \\lambda\\sigma^{2} $$\n$$ y_{2} - \\bar{y}_{\\mathrm{UT}} = -2\\mu\\sqrt{1+\\lambda}\\sigma + \\lambda\\sigma^{2} $$\n方差和为 $S_{\\mathrm{UT}} = W_{0}^{(c)}(-\\sigma^{2})^{2} + W_{1}^{(c)}\\left( (y_{1} - \\bar{y}_{\\mathrm{UT}})^{2} + (y_{2} - \\bar{y}_{\\mathrm{UT}})^{2} \\right)$。\n对于 $i=1,2$ 的偏差平方和为：\n$$ (y_{1} - \\bar{y}_{\\mathrm{UT}})^{2} + (y_{2} - \\bar{y}_{\\mathrm{UT}})^{2} = 2\\left( (2\\mu\\sqrt{1+\\lambda}\\sigma)^{2} + (\\lambda\\sigma^{2})^{2} \\right) = 2\\left( 4\\mu^{2}(1+\\lambda)\\sigma^{2} + \\lambda^{2}\\sigma^{4} \\right) = 8\\mu^{2}(1+\\lambda)\\sigma^{2} + 2\\lambda^{2}\\sigma^{4} $$\n代入方差方程：\n$$ S_{\\mathrm{UT}} = W_{0}^{(c)}\\sigma^{4} + \\frac{1}{2(1+\\lambda)}\\left( 8\\mu^{2}(1+\\lambda)\\sigma^{2} + 2\\lambda^{2}\\sigma^{4} \\right) $$\n$$ S_{\\mathrm{UT}} = W_{0}^{(c)}\\sigma^{4} + 4\\mu^{2}\\sigma^{2} + \\frac{\\lambda^{2}}{1+\\lambda}\\sigma^{4} $$\n现在代入 $W_{0}^{(c)} = \\frac{\\lambda}{1+\\lambda} + 1 - \\alpha^{2} + \\beta$：\n$$ S_{\\mathrm{UT}} = \\left( \\frac{\\lambda}{1+\\lambda} + 1 - \\alpha^{2} + \\beta \\right)\\sigma^{4} + 4\\mu^{2}\\sigma^{2} + \\frac{\\lambda^{2}}{1+\\lambda}\\sigma^{4} $$\n$$ S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + \\left( \\frac{\\lambda + \\lambda^{2}}{1+\\lambda} + 1 - \\alpha^{2} + \\beta \\right)\\sigma^{4} $$\n$$ S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + \\left( \\frac{\\lambda(1 + \\lambda)}{1+\\lambda} + 1 - \\alpha^{2} + \\beta \\right)\\sigma^{4} $$\n$$ S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + (\\lambda + 1 - \\alpha^{2} + \\beta)\\sigma^{4} $$\n最后，代入 $\\lambda = \\alpha^{2}(1+\\kappa) - 1$：\n$$ S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + (\\alpha^{2}(1+\\kappa) - 1 + 1 - \\alpha^{2} + \\beta)\\sigma^{4} $$\n$$ S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + (\\alpha^{2} + \\alpha^{2}\\kappa - \\alpha^{2} + \\beta)\\sigma^{4} $$\n$$ S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + (\\alpha^{2}\\kappa + \\beta)\\sigma^{4} $$\n\n**3. 精确均值 $\\mathbb{E}[x^{2}]$**\n对于任何随机变量 $x$，方差定义为 $\\mathrm{Var}[x] = \\mathbb{E}[x^{2}] - (\\mathbb{E}[x])^{2}$。\n给定 $x \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，我们有 $\\mathbb{E}[x] = \\mu$ 和 $\\mathrm{Var}[x] = \\sigma^{2}$。\n$$ \\sigma^{2} = \\mathbb{E}[x^{2}] - \\mu^{2} $$\n求解二阶矩 $\\mathbb{E}[x^{2}]$：\n$$ \\mathbb{E}[x^{2}] = \\mu^{2} + \\sigma^{2} $$\n与 UT 结果比较，我们发现 $\\bar{y}_{\\mathrm{UT}} = \\mathbb{E}[x^{2}]$。无迹变换对于高斯变量的二次函数均值是精确的。\n\n**4. 精确方差 $\\mathrm{Var}[x^{2}]$**\n$y=x^{2}$ 的方差由 $\\mathrm{Var}[y] = \\mathbb{E}[y^{2}] - (\\mathbb{E}[y])^{2}$ 给出。\n$$ \\mathrm{Var}[x^{2}] = \\mathbb{E}[(x^{2})^{2}] - (\\mathbb{E}[x^{2}])^{2} = \\mathbb{E}[x^{4}] - (\\mu^{2} + \\sigma^{2})^{2} $$\n我们需要高斯随机变量 $x \\sim \\mathcal{N}(\\mu, \\sigma^{2})$ 的四阶矩 $\\mathbb{E}[x^{4}]$。\n令 $z = (x-\\mu)/\\sigma$，所以 $z \\sim \\mathcal{N}(0, 1)$。那么 $x = \\mu + \\sigma z$。\n$$ \\mathbb{E}[x^{4}] = \\mathbb{E}[(\\mu + \\sigma z)^{4}] = \\mathbb{E}[\\mu^{4} + 4\\mu^{3}(\\sigma z) + 6\\mu^{2}(\\sigma z)^{2} + 4\\mu(\\sigma z)^{3} + (\\sigma z)^{4}] $$\n使用期望的线性性质和标准正态分布的矩 ($\\mathbb{E}[z]=0$, $\\mathbb{E}[z^{2}]=1$, $\\mathbb{E}[z^{3}]=0$, $\\mathbb{E}[z^{4}]=3$)：\n$$ \\mathbb{E}[x^{4}] = \\mu^{4} + 4\\mu^{3}\\sigma\\mathbb{E}[z] + 6\\mu^{2}\\sigma^{2}\\mathbb{E}[z^{2}] + 4\\mu\\sigma^{3}\\mathbb{E}[z^{3}] + \\sigma^{4}\\mathbb{E}[z^{4}] $$\n$$ \\mathbb{E}[x^{4}] = \\mu^{4} + 6\\mu^{2}\\sigma^{2}(1) + \\sigma^{4}(3) = \\mu^{4} + 6\\mu^{2}\\sigma^{2} + 3\\sigma^{4} $$\n现在，将此代入方差表达式中：\n$$ \\mathrm{Var}[x^{2}] = (\\mu^{4} + 6\\mu^{2}\\sigma^{2} + 3\\sigma^{4}) - (\\mu^{2} + \\sigma^{2})^{2} $$\n$$ \\mathrm{Var}[x^{2}] = (\\mu^{4} + 6\\mu^{2}\\sigma^{2} + 3\\sigma^{4}) - (\\mu^{4} + 2\\mu^{2}\\sigma^{2} + \\sigma^{4}) $$\n$$ \\mathrm{Var}[x^{2}] = 4\\mu^{2}\\sigma^{2} + 2\\sigma^{4} $$\n\n**UT 方差与精确方差的比较**\n我们比较两个推导出的方差表达式：\n- UT 预测方差: $S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + (\\alpha^{2}\\kappa + \\beta)\\sigma^{4}$\n- 精确方差: $\\mathrm{Var}[x^{2}] = 4\\mu^{2}\\sigma^{2} + 2\\sigma^{4}$\n\n要使这两个表达式对于任何 $\\mu$ 和 $\\sigma$ (假设 $\\sigma \\ne 0$) 都相同，$\\sigma^{4}$ 项的系数必须相等。\n$$ \\alpha^{2}\\kappa + \\beta = 2 $$\n这个关于调节参数 $\\alpha$、$\\kappa$ 和 $\\beta$ 的条件确保了对于高斯输入，$y=x^{2}$ 的 UT 方差是精确的。满足此条件的一个常用参数选择是 $\\kappa=0$（对于 $n=1$，它通常被设置为 $3-n$，所以 $\\kappa=2$）和 $\\beta=2$，这是针对高斯分布的标准建议。例如，如果 $n=1$, $\\kappa=2$ 和 $\\beta=0$ 是另一个选择。当 $\\alpha=1, \\kappa=2, \\beta=0$ 时，我们有 $1^{2}(2)+0=2$。当 $\\alpha=1, \\kappa=0, \\beta=2$ 时，我们有 $1^{2}(0)+2=2$。\n\n为得出最终答案，收集最终推导出的表达式。\n- $\\bar{y}_{\\mathrm{UT}} = \\mu^{2} + \\sigma^{2}$\n- $S_{\\mathrm{UT}} = 4\\mu^{2}\\sigma^{2} + (\\alpha^{2}\\kappa + \\beta)\\sigma^{4}$\n- $\\mathbb{E}[x^{2}] = \\mu^{2} + \\sigma^{2}$\n- $\\mathrm{Var}[x^{2}] = 4\\mu^{2}\\sigma^{2} + 2\\sigma^{4}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\mu^{2} + \\sigma^{2}  4\\mu^{2}\\sigma^{2} + (\\alpha^{2}\\kappa + \\beta)\\sigma^{4}  \\mu^{2} + \\sigma^{2}  4\\mu^{2}\\sigma^{2} + 2\\sigma^{4} \\end{pmatrix}}\n$$", "id": "2886759"}, {"introduction": "许多现实世界中的系统天然地由连续时间动态来描述，但卡尔曼滤波器却是在离散时间上运行的。本练习旨在解决一个关键的实际问题：如何将一个连续时间随机微分方程 (SDE) 转化为离散时间模型 [@problem_id:2886813]。我们将特别关注如何正确地转换过程噪声的协方差，这项技能对于将 EKF 和 UKF 等滤波器应用于物理系统至关重要。", "problem": "考虑连续时间非线性随机微分方程\n$$\n\\dot{x}(t) \\;=\\; a\\big(x(t),t\\big) \\;+\\; L\\big(x(t),t\\big)\\,w_c(t),\n$$\n其中 $x(t)\\in\\mathbb{R}^{2}$，$a:\\mathbb{R}^{2}\\times\\mathbb{R}\\to\\mathbb{R}^{2}$，以及 $L:\\mathbb{R}^{2}\\times\\mathbb{R}\\to\\mathbb{R}^{2\\times 2}$。驱动噪声 $w_c(t)$ 是一个零均值向量值白高斯过程，其协方差强度为\n$$\n\\mathbb{E}\\!\\left[w_c(t)\\,w_c^{\\top}(\\tau)\\right] \\;=\\; Q_c\\,\\delta(t-\\tau),\n$$\n其中 $Q_c\\in\\mathbb{R}^{2\\times 2}$ 是对称半正定矩阵，$\\delta(\\cdot)$ 是狄拉克δ分布。这种连续时间模型通常被离散化，以构建扩展卡尔曼滤波器（EKF）和无迹卡尔曼滤波器（UKF）所使用的过程模型。\n\n仅从随机微分方程的积分形式、白高斯噪声作为维纳过程的分布导数的定义以及伊东等距性出发，推导一个关于步长 $\\Delta t$ 的一阶离散时间近似，其形式为\n$$\nx_{k+1} \\;\\approx\\; x_k \\;+\\; a\\big(x_k,t_k\\big)\\,\\Delta t \\;+\\; w_k,\n$$\n并给出一个离散时间过程噪声协方差 $\\mathbb{E}\\!\\left[w_k\\,w_k^{\\top}\\right]$ 的显式公式。\n\n然后，对于由下式定义的特定系统\n$$\na(x,t) \\;=\\; \\begin{pmatrix} \\sin(x_1) \\\\ x_1\\,x_2 - t^{2} \\end{pmatrix}, \n\\qquad\nL(x,t) \\;=\\; \\begin{pmatrix} x_1+2  \\tfrac{1}{2} \\\\ -t  1+x_2^{2} \\end{pmatrix},\n$$\n采样时刻为 $t_k = 0.2$，状态为 $x_k = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$，连续时间噪声强度为\n$$\nQ_c \\;=\\; \\begin{pmatrix} 0.8  0 \\\\ 0  1.2 \\end{pmatrix},\n$$\n步长为 $\\Delta t = 0.1$，计算标量\n$$\n\\operatorname{tr}\\!\\big(Q_k\\big),\n$$\n其中 $Q_k$ 是你在 $(x_k,t_k)$ 处推导的一阶离散时间过程噪声协方差。将你的答案四舍五入到四位有效数字。将最终答案表示为一个纯数（无单位），在适用的情况下使用弧度（此处不出现角度）。", "solution": "所述问题具有科学依据，是适定的、客观且自洽的。它提出了随机系统和非线性滤波领域中的一个标准任务：连续时间伊东（Itô）随机微分方程（SDE）的离散化。为理论推导和后续的数值计算提供了所有必要的函数、参数和条件。该问题遵循伊东微积分和随机微分方程近似理论的既定原则。因此，该问题是有效的，我们开始求解。\n\n问题要求对连续时间SDE进行一阶离散化：\n$$\n\\dot{x}(t) = a\\big(x(t),t\\big) + L\\big(x(t),t\\big)\\,w_c(t)\n$$\n这个在工程文献中常见的方程，必须严格地解释为伊东SDE。项 $w_c(t)$ 表示一个向量白高斯噪声过程，它是维纳过程 $W(t)$ 的分布导数。$w_c(t)$ 的协方差由 $\\mathbb{E}[w_c(t)w_c^{\\top}(\\tau)] = Q_c\\,\\delta(t-\\tau)$ 指定，这意味着其底层的维纳过程的增量协方差为 $\\mathbb{E}[dW_t dW_t^{\\top}] = Q_c dt$。因此，正式的伊东SDE为：\n$$\ndx(t) = a(x(t), t) dt + L(x(t), t) dW(t)\n$$\n为了推导离散时间模型，我们将此SDE在一个小的时间区间 $[t_k, t_{k+1} = t_k + \\Delta t]$ 上积分：\n$$\nx(t_{k+1}) - x(t_k) = \\int_{t_k}^{t_{k+1}} a(x(s), s) ds + \\int_{t_k}^{t_{k+1}} L(x(s), s) dW(s)\n$$\n我们记 $x_k = x(t_k)$ 和 $x_{k+1} = x(t_{k+1})$。对于一个小的步长 $\\Delta t$，我们对积分进行近似。最简单的一阶近似（对应于欧拉-丸山法）是假设被积函数在区间 $[t_k, t_{k+1}]$ 上为常数，且等于其在区间起点 $t_k$ 处的值。\n\n首先，我们近似漂移项积分：\n$$\n\\int_{t_k}^{t_{k+1}} a(x(s), s) ds \\approx a(x_k, t_k) \\int_{t_k}^{t_{k+1}} ds = a(x_k, t_k) \\Delta t\n$$\n这是一个关于 $\\Delta t$ 的一阶近似。\n\n第二项，即随机积分，构成了离散时间过程噪声，我们将其记为 $w_k$：\n$$\nw_k = \\int_{t_k}^{t_{k+1}} L(x(s), s) dW(s)\n$$\n根据其构造，由于 $dW(s)$ 均值为零，噪声项 $w_k$ 的均值也为零：$\\mathbb{E}[w_k] = 0$。\n\n结合这些结果，我们得到离散时间状态传播模型：\n$$\nx_{k+1} \\approx x_k + a(x_k, t_k) \\Delta t + w_k\n$$\n这就是题目陈述中要求的结构。\n\n接下来，我们必须求出协方差矩阵 $Q_k = \\mathbb{E}[w_k w_k^{\\top}]$。协方差由下式给出：\n$$\nQ_k = \\mathbb{E}\\left[ \\left( \\int_{t_k}^{t_{k+1}} L(x(s), s) dW(s) \\right) \\left( \\int_{t_k}^{t_{k+1}} L(x(\\tau), \\tau) dW(\\tau) \\right)^{\\top} \\right]\n$$\n我们应用针对向量值随机积分的伊东等距性，其内容如下：\n$$\n\\mathbb{E}\\left[ \\left( \\int_{t_a}^{t_b} \\Phi(s) dW(s) \\right) \\left( \\int_{t_a}^{t_b} \\Phi(s) dW(s) \\right)^{\\top} \\right] = \\mathbb{E}\\left[ \\int_{t_a}^{t_b} \\Phi(s) Q_c \\Phi(s)^{\\top} ds \\right]\n$$\n将此应用于 $w_k$，其中 $\\Phi(s) = L(x(s), s)$，我们得到：\n$$\nQ_k = \\mathbb{E}\\left[ \\int_{t_k}^{t_{k+1}} L(x(s), s) Q_c L(x(s), s)^{\\top} ds \\right]\n$$\n为了保持与漂移项一致的一阶近似，我们用被积函数在区间起点 $(x_k, t_k)$ 的值来近似它。这消除了积分和期望内部对随机过程 $x(s)$ 的依赖：\n$$\nQ_k \\approx \\int_{t_k}^{t_{k+1}} L(x_k, t_k) Q_c L(x_k, t_k)^{\\top} ds\n$$\n现在，被积函数相对于积分变量 $s$ 是常数。计算该积分得到：\n$$\nQ_k = L(x_k, t_k) Q_c L(x_k, t_k)^{\\top} \\Delta t\n$$\n这就是离散时间过程噪声协方差的一阶近似的显式公式。推导至此完成。\n\n现在，我们对给定的系统进行数值计算。参数如下：\n$t_k = 0.2$， $x_k = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$， $\\Delta t = 0.1$。\n矩阵函数为：\n$$\nL(x,t) = \\begin{pmatrix} x_1+2  \\frac{1}{2} \\\\ -t  1+x_2^2 \\end{pmatrix}, \\qquad Q_c = \\begin{pmatrix} 0.8  0 \\\\ 0  1.2 \\end{pmatrix}\n$$\n首先，我们在给定的状态和时间点计算 $L(x_k, t_k)$：\n$$\nL_k = L(x_k, t_k) = \\begin{pmatrix} 1+2  \\frac{1}{2} \\\\ -0.2  1+(-2)^2 \\end{pmatrix} = \\begin{pmatrix} 3  0.5 \\\\ -0.2  1+4 \\end{pmatrix} = \\begin{pmatrix} 3  0.5 \\\\ -0.2  5 \\end{pmatrix}\n$$\n接下来，我们计算乘积 $L_k Q_c L_k^{\\top}$：\n$$\nL_k Q_c L_k^{\\top} = \\begin{pmatrix} 3  0.5 \\\\ -0.2  5 \\end{pmatrix} \\begin{pmatrix} 0.8  0 \\\\ 0  1.2 \\end{pmatrix} \\begin{pmatrix} 3  0.5 \\\\ -0.2  5 \\end{pmatrix}^{\\top}\n$$\n$$\n= \\begin{pmatrix} 3(0.8)  0.5(1.2) \\\\ -0.2(0.8)  5(1.2) \\end{pmatrix} \\begin{pmatrix} 3  -0.2 \\\\ 0.5  5 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 2.4  0.6 \\\\ -0.16  6 \\end{pmatrix} \\begin{pmatrix} 3  -0.2 \\\\ 0.5  5 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 2.4(3) + 0.6(0.5)  2.4(-0.2) + 0.6(5) \\\\ -0.16(3) + 6(0.5)  -0.16(-0.2) + 6(5) \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 7.2 + 0.3  -0.48 + 3 \\\\ -0.48 + 3  0.032 + 30 \\end{pmatrix} = \\begin{pmatrix} 7.5  2.52 \\\\ 2.52  30.032 \\end{pmatrix}\n$$\n最后，我们通过乘以 $\\Delta t$ 来计算 $Q_k$：\n$$\nQ_k = (L_k Q_c L_k^{\\top}) \\Delta t = \\begin{pmatrix} 7.5  2.52 \\\\ 2.52  30.032 \\end{pmatrix} (0.1) = \\begin{pmatrix} 0.75  0.252 \\\\ 0.252  3.0032 \\end{pmatrix}\n$$\n问题要求计算该矩阵的迹，$\\operatorname{tr}(Q_k)$：\n$$\n\\operatorname{tr}(Q_k) = 0.75 + 3.0032 = 3.7532\n$$\n结果必须四舍五入到四位有效数字。这个数字是 $3.7532$。前四位有效数字是 $3$、$7$、$5$ 和 $3$。第五位有效数字是 $2$，小于 $5$，因此我们向下舍入。\n最终的数值结果是 $3.753$。", "answer": "$$\n\\boxed{3.753}\n$$", "id": "2886813"}, {"introduction": "在掌握了理想模型后，我们将转向一个常见的、具有挑战性的现实场景：传感器饱和。本练习探讨了这种强非线性带来的后果 [@problem_id:2886761]。通过为饱和测量推导精确的贝叶斯后验分布，并将其与简化的扩展卡尔曼滤波器 (EKF) 近似进行比较，我们可以精确地量化由此产生的估计偏差。这有助于我们批判性地审视滤波器性能，并理解正确地为测量过程建模的重要性。", "problem": "考虑一个标量状态 $x$，其高斯先验为 $x \\sim \\mathcal{N}(m, P)$，以及一个加性高斯测量通道 $y = x + v$，其中 $v \\sim \\mathcal{N}(0, R)$ 与 $x$ 独立。物理传感器在一个上轨 $c \\in \\mathbb{R}$ 处饱和，因此报告的测量值是非线性映射 $y_{\\mathrm{obs}} = \\min(y, c)$。在给定的更新时刻，仪器的读数恰好在饱和值，即 $y_{\\mathrm{obs}} = c$。将此测量事件视为对潜在高斯变量 $y$ 的截断事件 $\\{y \\geq c\\}$。\n\n仅使用贝叶斯法则、联合高斯变量的性质以及关于截断高斯分布的标准事实，完成以下任务：\n\n1) 从线性高斯模型所隐含的 $(x, y)$ 的联合正态性出发，以闭式形式推导精确的后验均值 $\\mathbb{E}[x \\mid y \\geq c]$。你的推导应通过以 $y$ 为条件，然后对 $y$ 的截断高斯尾部进行平均来进行。用 $m$、$P$、$R$、$c$ 以及标准正态概率密度函数 $\\phi(\\cdot)$ 和累积分布函数 $\\Phi(\\cdot)$ 来表示你的结果。\n\n2) 扩展卡尔曼滤波器 (EKF) 的近似方法会忽略截断，将饱和报告视为一个带有加性高斯噪声的未饱和样本 $y = c$，并对均值执行标准的线性高斯更新。写出这个 EKF 后验均值，并以闭式形式计算均值偏差\n$\\delta_{\\mathrm{EKF}} \\triangleq \\mathbb{E}_{\\mathrm{EKF}}[x \\mid y=c] - \\mathbb{E}[x \\mid y \\geq c]$，\n同样用 $m$、$P$、$R$、$c$、$\\phi(\\cdot)$ 和 $\\Phi(\\cdot)$ 来表示。\n\n3) 简要说明当 $y_{\\mathrm{obs}}=c$ 时，无迹卡尔曼滤波器 (UKF) 将如何近似相同的更新，指出计算的哪一部分试图解释非线性 $y_{\\mathrm{obs}}=\\min(y,c)$，以及为什么相对于精确的截断更新会产生偏差。\n\n仅报告 $\\delta_{\\mathrm{EKF}}$ 的最终闭式表达式。无需进行数值代入，也无需单位。不要对结果进行四舍五入。", "solution": "在尝试解答之前，对所提供的问题进行验证。\n\n**步骤1：提取已知条件**\n- 状态变量：$x$，一个标量。\n- 先验分布：$x \\sim \\mathcal{N}(m, P)$。\n- 测量模型（潜在）：$y = x + v$。\n- 测量噪声：$v \\sim \\mathcal{N}(0, R)$。\n- 独立性：$v$ 与 $x$ 独立。\n- 非线性测量函数：$y_{\\mathrm{obs}} = \\min(y, c)$。\n- 观测到的测量值：$y_{\\mathrm{obs}} = c$。\n- 观测的解释：事件 $\\{y \\geq c\\}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是非线性估计理论中的一个标准课题，特别是涉及由非线性测量产生的非高斯后验的贝叶斯滤波。该问题是适定的，提供了所有必要的参数（$m, P, R, c$）和分布假设。语言客观且数学上精确。该问题是概率论中一个可形式化的练习，与非线性卡尔曼滤波器的主题直接相关。它是自洽的、一致的，并且不包含任何科学或逻辑上的缺陷。\n\n**步骤3：结论与行动**\n问题是**有效的**。现在将提供一个完整的、有理有据的解决方案。\n\n该问题要求推导精确的后验均值、其扩展卡尔曼滤波器（EKF）近似、产生的偏差，以及在相同背景下对无迹卡尔曼滤波器（UKF）的定性分析。\n\n**1) 精确后验均值 $\\mathbb{E}[x \\mid y \\geq c]$ 的推导**\n\n首先，我们确定状态 $x$ 和潜在测量 $y$ 的联合分布。由于 $x \\sim \\mathcal{N}(m, P)$ 且 $y = x + v$（其中 $v \\sim \\mathcal{N}(0, R)$ 与 $x$ 独立），向量 $(x, y)$ 是联合高斯分布的。\n\n均值向量为：\n$$\n\\mathbb{E}\\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} \\mathbb{E}[x] \\\\ \\mathbb{E}[x+v] \\end{pmatrix} = \\begin{pmatrix} m \\\\ m \\end{pmatrix}\n$$\n协方差矩阵为：\n$$\n\\mathrm{Cov}\\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} \\mathrm{Var}(x)  \\mathrm{Cov}(x,y) \\\\ \\mathrm{Cov}(y,x)  \\mathrm{Var}(y) \\end{pmatrix}\n$$\n各分量为：\n- $\\mathrm{Var}(x) = P$\n- $\\mathrm{Var}(y) = \\mathrm{Var}(x+v) = \\mathrm{Var}(x) + \\mathrm{Var}(v) = P+R$（由于独立性）\n- $\\mathrm{Cov}(x,y) = \\mathrm{Cov}(x, x+v) = \\mathrm{Cov}(x,x) + \\mathrm{Cov}(x,v) = \\mathrm{Var}(x) + 0 = P$\n\n因此，联合分布为：\n$$\n\\begin{pmatrix} x \\\\ y \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} m \\\\ m \\end{pmatrix}, \\begin{pmatrix} P  P \\\\ P  P+R \\end{pmatrix} \\right)\n$$\n潜在测量 $y$ 的边际分布为 $y \\sim \\mathcal{N}(m, P+R)$。我们记 $y$ 的均值和方差为 $\\mu_y = m$ 和 $\\sigma_y^2 = P+R$。\n\n我们求解精确后验均值 $\\mathbb{E}[x \\mid y \\geq c]$。我们使用全期望定律：\n$$\n\\mathbb{E}[x \\mid y \\geq c] = \\mathbb{E}[\\mathbb{E}[x \\mid y] \\mid y \\geq c]\n$$\n对于联合高斯变量，条件均值 $\\mathbb{E}[x \\mid y]$ 是 $y$ 的线性函数：\n$$\n\\mathbb{E}[x \\mid y] = \\mathbb{E}[x] + \\mathrm{Cov}(x,y) (\\mathrm{Var}(y))^{-1} (y - \\mathbb{E}[y]) = m + P(P+R)^{-1}(y-m)\n$$\n将此代入全期望定律：\n$$\n\\mathbb{E}[x \\mid y \\geq c] = \\mathbb{E}\\left[ m + \\frac{P}{P+R}(y-m) \\mid y \\geq c \\right] = m + \\frac{P}{P+R} \\mathbb{E}[y-m \\mid y \\geq c]\n$$\n$$\n\\mathbb{E}[x \\mid y \\geq c] = m + \\frac{P}{P+R} (\\mathbb{E}[y \\mid y \\geq c] - m)\n$$\n问题现在简化为求一个从下方在 $c$ 处截断的高斯随机变量 $y \\sim \\mathcal{N}(\\mu_y, \\sigma_y^2)$ 的均值。其公式为：\n$$\n\\mathbb{E}[y \\mid y \\geq c] = \\mu_y + \\sigma_y \\frac{\\phi\\left(\\frac{c-\\mu_y}{\\sigma_y}\\right)}{1 - \\Phi\\left(\\frac{c-\\mu_y}{\\sigma_y}\\right)}\n$$\n其中 $\\phi(\\cdot)$ 是标准正态概率密度函数 (PDF)，$\\Phi(\\cdot)$ 是标准正态累积分布函数 (CDF)。令 $\\alpha = \\frac{c-\\mu_y}{\\sigma_y} = \\frac{c-m}{\\sqrt{P+R}}$。代入 $\\mu_y=m$ 和 $\\sigma_y=\\sqrt{P+R}$：\n$$\n\\mathbb{E}[y \\mid y \\geq c] = m + \\sqrt{P+R} \\frac{\\phi(\\alpha)}{1 - \\Phi(\\alpha)}\n$$\n现在，将此结果代回 $x$ 的后验均值表达式中：\n$$\n\\mathbb{E}[x \\mid y \\geq c] = m + \\frac{P}{P+R} \\left( \\left( m + \\sqrt{P+R} \\frac{\\phi(\\alpha)}{1 - \\Phi(\\alpha)} \\right) - m \\right)\n$$\n$$\n\\mathbb{E}[x \\mid y \\geq c] = m + \\frac{P}{P+R} \\sqrt{P+R} \\frac{\\phi(\\alpha)}{1 - \\Phi(\\alpha)}\n$$\n$$\n\\mathbb{E}[x \\mid y \\geq c] = m + \\frac{P}{\\sqrt{P+R}} \\frac{\\phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)}{1 - \\Phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)}\n$$\n这就是以饱和事件为条件的精确后验均值。\n\n**2) EKF 近似与均值偏差 $\\delta_{\\mathrm{EKF}}$**\n\n问题指出，EKF 近似将饱和报告 $y_{\\mathrm{obs}}=c$ 视为来自线性高斯模型 $y=x+v$ 的一个直接的、未饱和的测量值 $y=c$。这对应于使用测量值 $c$ 应用标准的线性卡尔曼滤波器更新方程。\n\n先验均值为 $m$，先验协方差为 $P$。\n卡尔曼增益 $K$ 为：\n$$\nK = \\mathrm{Cov}(x,y) (\\mathrm{Var}(y))^{-1} = P(P+R)^{-1} = \\frac{P}{P+R}\n$$\n新息为 $\\nu = c - \\mathbb{E}[y] = c-m$。\n更新后的均值，我们称之为 EKF 后验均值，为：\n$$\n\\mathbb{E}_{\\mathrm{EKF}}[x \\mid y=c] = m + K \\nu = m + \\frac{P}{P+R}(c-m)\n$$\n均值偏差 $\\delta_{\\mathrm{EKF}}$ 是此 EKF 近似与精确后验均值之间的差值：\n$$\n\\delta_{\\mathrm{EKF}} \\triangleq \\mathbb{E}_{\\mathrm{EKF}}[x \\mid y=c] - \\mathbb{E}[x \\mid y \\geq c]\n$$\n$$\n\\delta_{\\mathrm{EKF}} = \\left( m + \\frac{P}{P+R}(c-m) \\right) - \\left( m + \\frac{P}{\\sqrt{P+R}} \\frac{\\phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)}{1 - \\Phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)} \\right)\n$$\n消去先验均值 $m$ 并简化：\n$$\n\\delta_{\\mathrm{EKF}} = \\frac{P(c-m)}{P+R} - \\frac{P}{\\sqrt{P+R}} \\frac{\\phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)}{1 - \\Phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)}\n$$\n为了使表达式更紧凑，我们重新引入标准化变量 $\\alpha = \\frac{c-m}{\\sqrt{P+R}}$。注意 $c-m = \\alpha \\sqrt{P+R}$。\n$$\n\\frac{P(c-m)}{P+R} = \\frac{P (\\alpha \\sqrt{P+R})}{P+R} = \\frac{P \\alpha}{\\sqrt{P+R}}\n$$\n将此代回偏差的表达式中：\n$$\n\\delta_{\\mathrm{EKF}} = \\frac{P \\alpha}{\\sqrt{P+R}} - \\frac{P}{\\sqrt{P+R}} \\frac{\\phi(\\alpha)}{1 - \\Phi(\\alpha)}\n$$\n提取公因子，得到偏差的最终闭式表达式：\n$$\n\\delta_{\\mathrm{EKF}} = \\frac{P}{\\sqrt{P+R}} \\left( \\alpha - \\frac{\\phi(\\alpha)}{1-\\Phi(\\alpha)} \\right) = \\frac{P}{\\sqrt{P+R}} \\left( \\frac{c-m}{\\sqrt{P+R}} - \\frac{\\phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)}{1-\\Phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)} \\right)\n$$\n\n**3) UKF 近似**\n\n无迹卡尔曼滤波器（UKF）使用一种称为无迹变换的确定性采样方法，来近似经过非线性变换的随机变量的统计特性。在这个问题中，非线性 $y_{\\mathrm{obs}} = \\min(y, c)$ 是在状态 $x$ 被噪声 $v$ 污染后应用的。因此，需要使用一个增广状态向量 $x_a = [x^T, v^T]^T$。\n\nUKF 将按以下步骤进行：\n1.  基于增广先验均值 $[m, 0]^T$ 和协方差 $\\mathrm{diag}(P, R)$ 构造 sigma 点。\n2.  将这些 sigma 点通过精确的非线性测量函数进行传播：$\\mathcal{Y}_i = \\min(\\mathcal{X}_i^x + \\mathcal{X}_i^v, c)$。\n3.  通过对传播后的 sigma 点 $\\mathcal{Y}_i$ 进行加权平均，计算预测的测量均值 $\\hat{y}_{\\mathrm{obs}}$ 和协方差（$S_y, P_{xy}$）。这一步是 UKF **试图考虑非线性**的地方。\n4.  使用计算出的卡尔曼增益 $K = P_{xy}S_y^{-1}$ 和新息 $y_{\\mathrm{obs}} - \\hat{y}_{\\mathrm{obs}} = c - \\hat{y}_{\\mathrm{obs}}$ 执行标准的线性更新。\n\n相对于精确的截断更新，产生偏差主要有两个原因。首先，无迹变换只提供了非线性变换后变量 $y_{\\mathrm{obs}}$ 真实矩（均值和协方差）的**近似**。虽然通常比 EKF 的一阶线性化更精确，但对于这种特定的非线性来说，它不是精确的。其次，最后的更新步骤是线性的，并且内在地假设了得到的后验分布是高斯的，而事实并非如此。给定不等式约束 $\\{y \\geq c\\}$ 的精确后验分布是非高斯的。UKF 找到的是对这个真实后验的高斯近似的均值，这会引入误差。", "answer": "$$\n\\boxed{\\frac{P}{\\sqrt{P+R}} \\left( \\frac{c-m}{\\sqrt{P+R}} - \\frac{\\phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)}{1-\\Phi\\left(\\frac{c-m}{\\sqrt{P+R}}\\right)} \\right)}\n$$", "id": "2886761"}]}