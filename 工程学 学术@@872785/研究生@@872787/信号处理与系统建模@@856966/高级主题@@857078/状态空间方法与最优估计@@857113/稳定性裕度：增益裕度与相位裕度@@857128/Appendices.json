{"hands_on_practices": [{"introduction": "对稳定裕度的深刻理解始于掌握其基本原理的计算。本练习将引导您为一个典型的二阶系统完整地推导稳定裕度，这是控制理论中的一个基本构建模块 [@problem_id:2906907]。通过直接运用增益交越频率和相位交越频率的定义，您不仅将计算出相位裕度和增益裕度，还将确定控制器增益如何影响系统的鲁棒性，这是反馈设计中的一项关键技能。", "problem": "考虑一个连续时间单回路单位反馈系统，其开环传递函数为\n$$\nL(s) \\;=\\; \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)} \\,,\n$$\n其中 $k>0$ 且 $\\omega_{p}>0$。该回路在原点有一个实极点，在 $s=-\\omega_{p}$ 处有一个实极点。使用以下基本定义：增益交越频率是满足 $\\lvert L(j\\omega_{gc})\\rvert = 1$ 的频率 $\\omega_{gc}0$；相位裕度 (PM) 是在 $\\omega_{gc}$ 处达到 $-180^\\circ$ 所需的额外相位滞后（以度为单位）；相位交越频率是开环相位等于 $-180^\\circ$ 时的频率 $\\omega_{pc}0$；增益裕度 (GM) 是在 $\\omega_{pc}$ 处开环幅值的倒数。根据这些定义，以及复数和有理传递函数的基本性质，进行以下推导：\n\n- 推导幅值 $\\lvert L(j\\omega)\\rvert$ 和相位 $\\angle L(j\\omega)$ 作为 $\\omega$、$k$ 和 $\\omega_{p}$ 的函数的闭式表达式。\n- 根据增益交越条件，推导 $\\omega_{gc}$（用 $k$ 和 $\\omega_{p}$ 表示），然后求出相位裕度 $\\mathrm{PM}(k,\\omega_{p})$（以度为单位）。\n- 确定该回路的相位交越行为，并推断出增益裕度 $\\mathrm{GM}(k,\\omega_{p})$。\n- 最后，确定使相位裕度满足 $\\mathrm{PM}\\geq 60^\\circ$ 的最大允许 $k$ 值（表示为 $\\omega_{p}$ 的函数）。\n\n所有角度均以度表示。你最终报告的答案必须是保证 $\\mathrm{PM}\\geq 60^\\circ$ 的最大允许 $k$ 值的单个闭式表达式。无需四舍五入。不要将中间结果或不等式作为最终答案报告。", "solution": "该问题要求对一个给定的二阶系统进行稳定性裕度的系统性推导，并随后确定一个增益参数的约束条件。我们按照指定的任务进行。\n\n首先，我们必须确定开环传递函数 $L(s)$ 的频率响应。给定的传递函数为\n$$\nL(s) = \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)}\n$$\n其中参数 $k$ 和 $\\omega_{p}$ 是正实数，$k>0$ 且 $\\omega_{p}>0$。频率响应通过代入 $s = j\\omega$ 得到，其中 $\\omega$ 是角频率。\n$$\nL(j\\omega) = \\frac{k}{j\\omega(1 + j\\omega/\\omega_{p})}\n$$\n$L(j\\omega)$ 的幅值，记作 $|L(j\\omega)|$，是分子和分母幅值的比值：\n$$\n|L(j\\omega)| = \\frac{|k|}{|j\\omega| \\cdot |1 + j\\omega/\\omega_{p}|}\n$$\n给定 $k > 0$，我们有 $|k|=k$。对于 $\\omega \\ge 0$，幅值 $|j\\omega|$ 是 $\\omega$。复数 $1 + j\\omega/\\omega_{p}$ 的幅值是 $\\sqrt{1^2 + (\\omega/\\omega_{p})^2}$。因此，幅值的表达式为：\n$$\n|L(j\\omega)| = \\frac{k}{\\omega \\sqrt{1 + \\frac{\\omega^2}{\\omega_{p}^2}}}\n$$\n$L(j\\omega)$ 的相位，记作 $\\angle L(j\\omega)$，计算为各项相位的和，其中分母项的相位带负号：\n$$\n\\angle L(j\\omega) = \\angle k - \\angle(j\\omega) - \\angle(1 + j\\omega/\\omega_{p})\n$$\n由于 $k$ 是一个正实数，其相位为 $0^\\circ$。$j\\omega$ 的相位恰好是 $90^\\circ$。$1 + j\\omega/\\omega_{p}$ 的相位由 $\\arctan((\\omega/\\omega_{p})/1) = \\arctan(\\omega/\\omega_{p})$ 给出。因此，以度为单位的相位表达式为：\n$$\n\\angle L(j\\omega) = 0^\\circ - 90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right) = -90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right)\n$$\n接下来，我们推导增益交越频率 $\\omega_{gc}$ 和相位裕度 $\\mathrm{PM}$。根据定义，$\\omega_{gc}$ 是使得 $|L(j\\omega_{gc})| = 1$ 的频率。\n$$\n1 = \\frac{k}{\\omega_{gc} \\sqrt{1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}}}\n$$\n两边平方并重新整理各项，得到一个关于 $\\omega_{gc}^2$ 的多项式方程：\n$$\n1 = \\frac{k^2}{\\omega_{gc}^2 (1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2})} \\implies \\omega_{gc}^2 \\left(1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}\\right) = k^2\n$$\n$$\n\\frac{1}{\\omega_{p}^2}\\omega_{gc}^4 + \\omega_{gc}^2 - k^2 = 0\n$$\n这是一个关于变量 $\\omega_{gc}^2$ 的二次方程。我们使用二次公式求解 $\\omega_{gc}^2$，其中系数为 $a=1/\\omega_{p}^2$，$b=1$ 和 $c=-k^2$：\n$$\n\\omega_{gc}^2 = \\frac{-1 \\pm \\sqrt{1^2 - 4(1/\\omega_{p}^2)(-k^2)}}{2(1/\\omega_{p}^2)} = \\frac{\\omega_{p}^2}{2} \\left(-1 \\pm \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\\right)\n$$\n由于 $\\omega_{gc}^2$ 必须是一个正实数（根据定义 $\\omega_{gc} > 0$），我们必须选择带加号的解：\n$$\n\\omega_{gc}^2 = \\frac{\\omega_{p}^2}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\n相位裕度 $\\mathrm{PM}$ 定义为 $\\mathrm{PM} = 180^\\circ + \\angle L(j\\omega_{gc})$。\n$$\n\\mathrm{PM} = 180^\\circ + \\left(-90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\\right) = 90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\n\n现在，我们分析相位交越行为和增益裕度 $\\mathrm{GM}$。相位交越频率 $\\omega_{pc}$ 是使得 $\\angle L(j\\omega_{pc}) = -180^\\circ$ 的频率。\n$$\n-180^\\circ = -90^\\circ - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right)\n$$\n$$\n-90^\\circ = - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) \\implies \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) = 90^\\circ\n$$\n反正切函数仅在其参数趋于无穷大时才趋近于 $90^\\circ$。这意味着 $\\omega_{pc}/\\omega_{p} \\to \\infty$，因此 $\\omega_{pc} \\to \\infty$。不存在有限的正频率 $\\omega_{pc}$ 使得相位达到 $-180^\\circ$。增益裕度定义为 $\\mathrm{GM} = 1/|L(j\\omega_{pc})|$。在这种情况下，我们必须考虑当 $\\omega \\to \\infty$ 时的极限：\n$$\n\\lim_{\\omega \\to \\infty} |L(j\\omega)| = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega \\sqrt{1 + \\omega^2/\\omega_{p}^2}} = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega (\\omega/\\omega_{p})} = \\lim_{\\omega \\to \\infty} \\frac{k \\omega_{p}}{\\omega^2} = 0\n$$\n在相位将为 $-180^\\circ$ 的频率下，幅值为零。因此，增益裕度 $\\mathrm{GM} = 1/0$ 是无穷大。这表明闭环系统对于所有正的 $k$ 值都是稳定的。\n\n最后，我们确定使相位裕度满足条件 $\\mathrm{PM} \\ge 60^\\circ$ 的最大允许 $k$ 值。\n$$\n90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right) \\ge 60^\\circ\n$$\n$$\n30^\\circ \\ge \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\n由于 $\\arctan(x)$ 是一个单调递增函数，我们可以对不等式两边应用正切函数。$\\tan(30^\\circ)$ 的值是 $1/\\sqrt{3}$。\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\frac{\\omega_{gc}}{\\omega_{p}}\n$$\n我们代入 $\\omega_{gc}/\\omega_p$ 的表达式：\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\sqrt{\\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)}\n$$\n将不等式两边平方：\n$$\n\\frac{1}{3} \\ge \\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\n我们现在求解 $k$：\n$$\n\\frac{2}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\n$$\n$$\n\\frac{2}{3} + 1 \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} \\implies \\frac{5}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\n$$\n再次将两边平方：\n$$\n\\left(\\frac{5}{3}\\right)^2 \\ge 1 + \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{25}{9} \\ge 1 + \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{25}{9} - 1 \\ge \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{16}{9} \\ge \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{16}{9}\\omega_{p}^2 \\ge 4k^2 \\implies \\frac{4}{9}\\omega_{p}^2 \\ge k^2\n$$\n由于 $k > 0$ 且 $\\omega_{p} > 0$，对两边取正平方根，我们得到对 $k$ 的约束：\n$$\n\\frac{2}{3}\\omega_{p} \\ge k\n$$\n问题要求的是 $k$ 的最大允许值。这对应于等式成立的条件。因此，$k$ 的最大值是 $\\frac{2}{3}\\omega_{p}$。", "answer": "$$\n\\boxed{\\frac{2}{3}\\omega_{p}}\n$$", "id": "2906907"}, {"introduction": "虽然正的相位裕度通常被视为稳定性的可靠指标，但这只是一个具有关键局限性的经验法则。本练习探讨了这一假设失效的情景，展示了一个具有“表面上的”正相位裕度但实际上不稳定的系统 [@problem_id:2906959]。通过面对这个看似矛盾的情况，您将被引导去应用完整的奈奎斯特稳定判据，从而加深一个至关重要的教训：开环不稳定的系统需要比单独的波特图裕度所能提供的更严格的分析。", "problem": "一个连续时间、单输入单输出的单位负反馈回路是围绕一个具有实系数的严格真环路传递函数 $L(s)$ 构成的。该环路传递函数为\n$$\nL(s) \\;=\\; K \\,\\frac{s+z}{(s-1)(s+1)(s+2)}\\,,\n$$\n其中 $K=\\dfrac{10\\sqrt{5}}{\\sqrt{29}}$ 且 $z=\\dfrac{2}{5}$。请注意，$L(s)$ 在右半平面（RHP）的 $s=1$ 处有一个极点。\n\n仅从核心定义（波特幅频和相频，以及由柯西辐角原理推导出的奈奎斯特稳定性判据）出发，完成以下任务：\n\n1) 将增益交越频率 $\\omega_{\\mathrm{gc}}$ 定义为 $|L(\\mathrm{j}\\omega)|=1$ 的正实数解。计算 $\\omega_{\\mathrm{gc}}$ 和相应的环路相位 $\\angle L(\\mathrm{j}\\omega_{\\mathrm{gc}})$。然后，使用波特分析中相位裕度（PM）的标准定义，计算在（错误地）忽略 $L(s)$ 中存在右半平面极点的情况下，人们会从波特图报告的“表观”相位裕度。角度以度表示。你可以保留中间的符号表达式为精确值；如果给出任何十进制角度，请四舍五入至四位有效数字。\n\n2) 使用奈奎斯特稳定性判据（基于柯西辐角原理），确定 $1+L(s)$ 在右半平面中的零点数量 $Z$，该数量等于单位反馈系统在右半平面中的闭环极点数量。通过直接根据你在第1部分答案和低频值 $L(0)$ 所暗示的奈奎斯特图的定性几何形状进行推理，来证明你对包围圈数的判定。\n\n3) 提供一个诊断性解释，以调和第1步中得到的正“表观”相位裕度与第2步中得到的不稳定闭环。明确指出将增益裕度（GM）和相位裕度（PM）解释为稳定性保证背后的哪个标准假设被违反了，以及如何预先检测到这种情况。\n\n最终答案只报告 $Z$ 的整数值（无单位，无附加文本）。$Z$ 无需四舍五入。", "solution": "首先验证问题陈述。\n已知条件：\n- 环路传递函数：$L(s) = K \\frac{s+z}{(s-1)(s+1)(s+2)}$\n- 常数：$K = \\frac{10\\sqrt{5}}{\\sqrt{29}}$ 且 $z = \\frac{2}{5}$\n- 系统为单位负反馈配置。\n- $L(s)$ 在 $s=1$ 处有一个不稳定极点。\n\n验证：\n该问题在经典控制理论中有科学依据，特别是关于频域稳定性分析。问题提法恰当，为获得唯一解提供了所有必要信息。语言客观而精确。该设置涉及一个开环不稳定系统，是理解奈奎斯特稳定性判据全部范围的一个标准且重要的案例研究，它既不琐碎也不病态。该问题被认为是有效的。\n\n第1部分：“表观”相位裕度的计算\n\n环路传递函数的频率响应为 $L(j\\omega)$。$L(j\\omega)$ 的幅值平方由下式给出：\n$$\n|L(j\\omega)|^2 = \\left| K \\frac{j\\omega+z}{(j\\omega-1)(j\\omega+1)(j\\omega+2)} \\right|^2 = K^2 \\frac{|j\\omega+z|^2}{|j\\omega-1|^2 |j\\omega+1|^2 |j\\omega+2|^2} = K^2 \\frac{\\omega^2+z^2}{(\\omega^2+1)(\\omega^2+1)(\\omega^2+4)} = K^2 \\frac{\\omega^2+z^2}{(\\omega^2+1)^2 (\\omega^2+4)}\n$$\n增益交越频率 $\\omega_{\\mathrm{gc}}$ 是使得 $|L(j\\omega_{\\mathrm{gc}})| = 1$ 的正频率，这等价于 $|L(j\\omega_{\\mathrm{gc}})|^2 = 1$。\n给定的常数为 $K=\\frac{10\\sqrt{5}}{\\sqrt{29}}$ 和 $z=\\frac{2}{5}$。\n因此，$K^2 = \\frac{100 \\times 5}{29} = \\frac{500}{29}$ 且 $z^2 = \\frac{4}{25}$。\n我们需要从以下方程求解 $\\omega_{\\mathrm{gc}}$：\n$$\n1 = \\frac{500}{29} \\frac{\\omega_{\\mathrm{gc}}^2 + \\frac{4}{25}}{(\\omega_{\\mathrm{gc}}^2+1)^2 (\\omega_{\\mathrm{gc}}^2+4)}\n$$\n让我们测试解 $\\omega_{\\mathrm{gc}}=1$ rad/s，这意味着 $\\omega_{\\mathrm{gc}}^2=1$。\n$$\n\\frac{500}{29} \\frac{1 + \\frac{4}{25}}{(1+1)^2 (1+4)} = \\frac{500}{29} \\frac{\\frac{29}{25}}{(2^2)(5)} = \\frac{500}{29} \\frac{29/25}{20} = \\frac{500}{29} \\frac{29}{500} = 1\n$$\n方程成立。因此，增益交越频率为 $\\omega_{\\mathrm{gc}} = 1$ rad/s。\n\n接下来，我们计算在 $\\omega = \\omega_{\\mathrm{gc}} = 1$ 时 $L(j\\omega)$ 的相位。相位由下式给出：\n$$\n\\angle L(j\\omega) = \\angle(j\\omega+z) - \\angle(j\\omega-1) - \\angle(j\\omega+1) - \\angle(j\\omega+2)\n$$\n用度表示角度：\n$$\n\\angle(j\\omega+z) = \\arctan\\left(\\frac{\\omega}{z}\\right)\n$$\n$$\n\\angle(j\\omega-1) = \\angle(-1+j\\omega) = 180^\\circ - \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+1) = \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+2) = \\arctan\\left(\\frac{\\omega}{2}\\right)\n$$\n所以，总相位为：\n$$\n\\angle L(j\\omega) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\left(180^\\circ - \\arctan(\\omega)\\right) - \\arctan(\\omega) - \\arctan\\left(\\frac{\\omega}{2}\\right) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\arctan\\left(\\frac{\\omega}{2}\\right) - 180^\\circ\n$$\n在 $\\omega = \\omega_{\\mathrm{gc}}=1$ 且 $z=\\frac{2}{5}$ 时：\n$$\n\\angle L(j1) = \\arctan\\left(\\frac{1}{2/5}\\right) - \\arctan\\left(\\frac{1}{2}\\right) - 180^\\circ = \\arctan(2.5) - \\arctan(0.5) - 180^\\circ\n$$\n使用恒等式 $\\arctan(a) - \\arctan(b) = \\arctan\\left(\\frac{a-b}{1+ab}\\right)$，我们得到：\n$$\n\\arctan(2.5) - \\arctan(0.5) = \\arctan\\left(\\frac{2.5 - 0.5}{1 + 2.5 \\times 0.5}\\right) = \\arctan\\left(\\frac{2}{1 + 1.25}\\right) = \\arctan\\left(\\frac{2}{2.25}\\right) = \\arctan\\left(\\frac{8}{9}\\right)\n$$\n所以，在增益交越频率处的相位是：\n$$\n\\angle L(j\\omega_{\\mathrm{gc}}) = \\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ \\approx 41.6339^\\circ - 180^\\circ = -138.3661^\\circ\n$$\n四舍五入到四位有效数字，$\\angle L(j\\omega_{\\mathrm{gc}}) \\approx -138.4^\\circ$。\n\n相位裕度（PM）的标准定义是 $PM = 180^\\circ + \\angle L(j\\omega_{\\mathrm{gc}})$。忽略右半平面极点的“表观”PM是：\n$$\nPM_{\\mathrm{apparent}} = 180^\\circ + \\left(\\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ\\right) = \\arctan\\left(\\frac{8}{9}\\right) \\approx 41.63^\\circ\n$$\n这是一个正的相位裕度。\n\n第2部分：奈奎斯特稳定性分析\n\n奈奎斯特稳定性判据指出 $Z = N + P$，其中：\n- $Z$ 是 $1+L(s)$ 在右半平面中的零点数，这对应于不稳定闭环极点的数量。\n- $P$ 是开环传递函数 $L(s)$ 在右半平面中的极点数。\n- $N$ 是 $L(s)$ 的奈奎斯特图对临界点 $-1+j0$ 的顺时针包围圈数。\n\n从 $L(s) = K \\frac{s+z}{(s-1)(s+1)(s+2)}$ 的定义中，我们可以确定极点位于 $s=1$、$s=-1$ 和 $s=-2$。$s=1$ 处的极点在右半平面。因此，$P=1$。\n\n为了确定 $N$，我们分析奈奎斯特图，它是标准奈奎斯特D形围线的像。我们需要确定该图是否包围点 $-1$。\n1.  当 $\\omega \\to 0^+$ 时，$L(j\\omega) \\to L(0) = K \\frac{z}{(-1)(1)(2)} = -\\frac{Kz}{2}$。\n    $L(0) = -\\frac{1}{2} \\left(\\frac{10\\sqrt{5}}{\\sqrt{29}}\\right) \\left(\\frac{2}{5}\\right) = -\\frac{2\\sqrt{5}}{\\sqrt{29}} \\approx -0.8318$。\n    奈奎斯特图从负实轴上约 $-0.8318$ 处开始，该点在 $-1$ 的右侧。\n2.  $L(j\\omega)$ 的相位是 $\\angle L(j\\omega) = \\arctan(\\omega/z) - \\arctan(\\omega/2) - 180^\\circ$。对于 $\\omega \\in (0, \\infty)$，$\\arctan(\\omega/z)$ 和 $\\arctan(\\omega/2)$ 都在 $(0, 90^\\circ)$ 区间内，且由于 $z  2$，我们有 $\\omega/z > \\omega/2$，因此 $\\arctan(\\omega/z) > \\arctan(\\omega/2)$。这意味着 $\\arctan(\\omega/z) - \\arctan(\\omega/2)$ 在 $(0, 90^\\circ)$ 区间内。因此，$\\angle L(j\\omega)$ 始终在 $(-180^\\circ, -90^\\circ)$ 区间内。对于 $\\omega > 0$，奈奎斯特图完全停留在第三象限。它从不穿过负实轴。\n3.  由于系统是严格真的，当 $\\omega \\to \\infty$ 时，$L(j\\omega) \\to 0$。相位趋近于 $\\lim_{\\omega\\to\\infty} (\\arctan(\\omega/z) - \\arctan(\\omega/2) - 180^\\circ) = 90^\\circ - 90^\\circ - 180^\\circ = -180^\\circ$。奈奎斯特图沿负实轴趋近于原点。\n4.  由于 $L(s)$ 是严格真的，s平面中D形围线的大半圆闭合部分映射到L(s)平面中的原点处的一条路径。\n\n对于 $\\omega \\in (-\\infty, \\infty)$，奈奎斯特图在 $\\omega \\to -\\infty$ 时从原点开始，移动到 $L(0) \\approx -0.8318$，在第二和第三象限形成一个环路，该环路穿过单位圆上的点 $L(j1)$，但从不穿过 $-1$ 左侧的实轴，并在 $\\omega \\to \\infty$ 时返回原点。临界点 $-1+j0$ 从未被该图包围。\n因此，包围圈数 $N=0$。\n\n使用奈奎斯特判据，不稳定闭环极点的数量为：\n$$\nZ = N + P = 0 + 1 = 1\n$$\n闭环系统在右半平面有一个极点，因此是不稳定的。\n\n第3部分：调和与诊断性解释\n\n分析揭示了一个“表观”矛盾：一个正的相位裕度（$PM \\approx 41.63^\\circ$）通常与稳定性相关，但系统却是不稳定的（$Z=1$）。通过理解波特图稳定性裕度的局限性，可以解决这种差异。\n\n“正相位裕度和大于1的增益裕度保证闭环稳定性”这一标准解释仅在开环系统 $L(s)$ 稳定（即 P = 0）时才有效。\n\n在这个问题中，这个基本假设被违反了。开环传递函数 $L(s)$ 在 $s=1$ 处有一个极点，因此它是不稳定的，且 $P=1$。对于开环不稳定的系统，必须直接使用奈奎斯特判据 $Z=N+P$。为了保证稳定性，我们需要 $Z=0$。在 $P=1$ 的情况下，这就要求 $N = Z-P = 0-1 = -1$，意味着奈奎斯特图必须以逆时针方向包围临界点 $-1$ 一次。\n\n正的相位裕度仅仅表明在增益交越频率处，相位比 $-180^\\circ$ 更不负。如果没有开环极点位置的额外背景信息，它不提供关于包围圈数 $N$ 的任何信息。在这种情况下，正的相位裕度出现在一个奈奎斯特图完全不包围 $-1$（$N=0$）的系统中，未能提供所需的起稳定作用的逆时针包围。\n\n预先检测这种情况很简单：必须始终首先确定开环传递函数 $L(s)$ 的极点。任何具有正实部的极点（本例中为 $s=1$）的存在，都会立即使与波特图相关的简单稳定性经验法则失效，并强制要求使用完整的奈奎斯特稳定性判据（或像根轨迹这样的等效方法）。", "answer": "$$\n\\boxed{1}\n$$", "id": "2906959"}, {"introduction": "在掌握了基本计算和理论要点之后，我们现在将这些知识应用于一个实际的控制器选择问题。本练习聚焦于控制一个非最小相位对象的挑战，这类对象因其固有的性能限制而著称 [@problem_id:2906949]。通过为同一个对象和相同的交越频率设计并比较比例（P）、比例积分（PI）和超前（Lead）控制器，您将分析每种控制策略如何与对象动态相互作用以塑造稳定裕度，从而揭示反馈设计中的基本权衡。", "problem": "考虑一个开环、单输入单输出对象，其传递函数含有一个非最小相位零点，表示为\n$$\nG(s)=\\frac{1-\\frac{s}{z}}{(s+1)(s+2)}, \\quad z=0.5.\n$$\n你将研究三种补偿器的环路稳定性裕度：比例 (P) 补偿器、比例积分 (PI) 补偿器和相位超前控制器。设补偿器定义为\n$$\nC_{P}(s)=K_{P}, \\quad C_{PI}(s)=K_{PI}\\left(1+\\frac{1}{T_{i}s}\\right), \\quad C_{L}(s)=K_{L}\\,\\frac{1+sT}{1+s\\alpha T},\n$$\n参数固定为\n$$\nT_{i}=1, \\quad T=1, \\quad \\alpha=0.2.\n$$\n对每种补偿器，选择标量增益，使得环路传递函数 $L(s)=C(s)G(s)$ 满足单位增益交越条件\n$$\n|L(\\mathrm{j}\\omega_{c})|=1 \\quad \\text{在} \\quad \\omega_{c}=1 \\ \\text{rad/s}.\n$$\n然后，仅使用频域中增益裕度和相位裕度的定义以及 Bode 频率响应合成的基本原理（极点和零点的相位贡献之和），执行以下操作：\n1) 对每种补偿器，推导在一般频率 $\\omega$ 下的环路幅值和相位的表达式，用初等函数表示。\n2) 确定所需的增益 $K_{P}$、$K_{PI}$ 和 $K_{L}$，以满足 $|L(\\mathrm{j}1)|=1$。\n3) 计算每个环路的相位裕度，其值为 $180$ 度与在 $\\omega=1$ rad/s 时的环路相位之差。\n4) 计算每个环路的增益裕度，方法是找到一个频率 $\\omega_{180}$，在该频率下环路相位为 $-180$ 度，然后计算该频率下环路幅值的倒数（表示为无量纲乘法因子）。\n\n最后，通过将三种控制器在相位裕度和增益裕度上的差异明确归因于非最小相位零点以及每种补偿器极零点分布的 Bode 相位贡献，来解释这些差异。\n\n答案说明：作为您最终报告的量，请提供三种补偿器中最大的相位裕度。角度以度为单位表示。将您的最终答案四舍五入到四位有效数字。", "solution": "我们从频率响应的定义开始。对于环路传递函数 $L(s)=C(s)G(s)$，相位裕度 (PM) 定义为\n$$\n\\mathrm{PM}=180^{\\circ}+\\arg L(\\mathrm{j}\\omega_{gc}),\n$$\n其中 $\\omega_{gc}$ 是增益交越频率，满足 $|L(\\mathrm{j}\\omega_{gc})|=1$。增益裕度 (GM) 在满足 $\\arg L(\\mathrm{j}\\omega_{pc})=-180^{\\circ}$ 的相位交越频率 $\\omega_{pc}$ 处定义为\n$$\n\\mathrm{GM}=\\frac{1}{|L(\\mathrm{j}\\omega_{pc})|}.\n$$\n所有角度都将以度为单位表示。我们通过组合对象和补偿器的频率响应来构建 $L(\\mathrm{j}\\omega)$。\n\n对象频率响应。当 $z=0.5$ 时，对象为\n$$\nG(\\mathrm{j}\\omega)=\\frac{1-\\mathrm{j}\\frac{\\omega}{z}}{(\\mathrm{j}\\omega+1)(\\mathrm{j}\\omega+2)}=\\frac{1-\\mathrm{j}(2\\omega)}{(1+\\mathrm{j}\\omega)(2+\\mathrm{j}\\omega)}.\n$$\n其幅值和相位分解为零点和极点的因子：\n$$\n|G(\\mathrm{j}\\omega)|=\\frac{\\sqrt{1+(2\\omega)^{2}}}{\\sqrt{1+\\omega^{2}}\\;\\sqrt{4+\\omega^{2}}}, \\quad\n\\arg G(\\mathrm{j}\\omega)=-\\arctan(2\\omega)-\\arctan(\\omega)-\\arctan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\n负贡献 $-\\arctan(2\\omega)$ 来自于右半平面零点 $s=+z$，通过因子 $1-\\mathrm{j}\\omega/z$ 产生。\n\n补偿器。我们写出每个补偿器的幅值和相位：\n1) 比例补偿器：$C_{P}(\\mathrm{j}\\omega)=K_{P}$，所以\n$$\n|C_{P}(\\mathrm{j}\\omega)|=K_{P}, \\quad \\arg C_{P}(\\mathrm{j}\\omega)=0^{\\circ}.\n$$\n2) 比例积分补偿器，其中 $T_{i}=1$：\n$$\nC_{PI}(s)=K_{PI}\\left(1+\\frac{1}{s}\\right)=K_{PI}\\frac{s+1}{s}, \\quad C_{PI}(\\mathrm{j}\\omega)=K_{PI}\\frac{1+\\mathrm{j}\\omega}{\\mathrm{j}\\omega}.\n$$\n因此\n$$\n|C_{PI}(\\mathrm{j}\\omega)|=K_{PI}\\frac{\\sqrt{1+\\omega^{2}}}{\\omega}, \\quad \\arg C_{PI}(\\mathrm{j}\\omega)=\\arctan(\\omega)-90^{\\circ}.\n$$\n3) 超前补偿器，其中 $T=1$, $\\alpha=0.2$：\n$$\nC_{L}(s)=K_{L}\\frac{1+s}{1+0.2s}, \\quad C_{L}(\\mathrm{j}\\omega)=K_{L}\\frac{1+\\mathrm{j}\\omega}{1+\\mathrm{j}0.2\\omega}.\n$$\n因此\n$$\n|C_{L}(\\mathrm{j}\\omega)|=K_{L}\\frac{\\sqrt{1+\\omega^{2}}}{\\sqrt{1+(0.2\\omega)^{2}}}, \\quad \\arg C_{L}(\\mathrm{j}\\omega)=\\arctan(\\omega)-\\arctan(0.2\\omega).\n$$\n\n在 $\\omega_{c}=1$ rad/s 处的单位增益交越。我们通过求解每个增益来满足 $|L(\\mathrm{j}1)|=1$。\n\n在 $\\omega=1$ 处的对象。计算\n$$\nG(\\mathrm{j}1)=\\frac{1-2\\mathrm{j}}{(1+\\mathrm{j})(2+\\mathrm{j})}=\\frac{1-2\\mathrm{j}}{1+3\\mathrm{j}}.\n$$\n因此\n$$\n|G(\\mathrm{j}1)|=\\frac{\\sqrt{1+4}}{\\sqrt{1+1}\\sqrt{4+1}}=\\frac{\\sqrt{5}}{\\sqrt{10}}=\\frac{1}{\\sqrt{2}}, \\quad \\arg G(\\mathrm{j}1)=-\\arctan(2)-\\arctan(1)-\\arctan\\!\\left(\\tfrac{1}{2}\\right)=-135^{\\circ}.\n$$\n\n1) 比例补偿器。单位交越条件为\n$$\n|L_{P}(\\mathrm{j}1)|=K_{P}|G(\\mathrm{j}1)|=1 \\;\\Rightarrow\\; K_{P}=\\frac{1}{|G(\\mathrm{j}1)|}=\\sqrt{2}.\n$$\n在 $\\omega=1$ 时的相位为 $\\arg L_{P}(\\mathrm{j}1)=-135^{\\circ}$，所以相位裕度为\n$$\n\\mathrm{PM}_{P}=180^{\\circ}-135^{\\circ}=45^{\\circ}.\n$$\n对于增益裕度，我们求解满足 $\\arg L_{P}(\\mathrm{j}\\omega_{pc})=-180^{\\circ}$ 的 $\\omega_{pc}$，即，\n$$\n\\arctan(2\\omega_{pc})+\\arctan(\\omega_{pc})+\\arctan\\!\\left(\\frac{\\omega_{pc}}{2}\\right)=180^{\\circ}.\n$$\n求解可得 $\\omega_{pc} = \\sqrt{3.5} \\approx 1.871$ rad/s。在该频率下的环路幅值为\n$$\n|L_{P}(\\mathrm{j}\\omega_{pc})|=K_{P}|G(\\mathrm{j}\\omega_{pc})|=\\sqrt{2}\\,\\frac{\\sqrt{1+4(3.5)}}{\\sqrt{1+3.5}\\sqrt{4+3.5}} = \\sqrt{2}\\frac{\\sqrt{15}}{\\sqrt{4.5}\\sqrt{7.5}} = \\frac{2\\sqrt{2}}{3} \\approx 0.9428.\n$$\n所以，\n$$\n\\mathrm{GM}_{P}=\\frac{1}{|L_{P}(\\mathrm{j}\\omega_{pc})|} = \\frac{3\\sqrt{2}}{4} \\approx 1.061.\n$$\n\n2) 比例积分补偿器。在 $\\omega=1$ 处，\n$$\n|C_{PI}(\\mathrm{j}1)|=K_{PI}\\frac{\\sqrt{1+1^{2}}}{1}=K_{PI}\\sqrt{2}, \\quad |L_{PI}(\\mathrm{j}1)|=K_{PI}\\sqrt{2}\\,|G(\\mathrm{j}1)|=K_{PI}\\sqrt{2}\\cdot\\frac{1}{\\sqrt{2}}=K_{PI}.\n$$\n因此 $K_{PI}=1$。在 $\\omega=1$ 处的环路相位为\n$$\n\\arg L_{PI}(\\mathrm{j}1)=\\arg G(\\mathrm{j}1)+\\arg C_{PI}(\\mathrm{j}1)=-135^{\\circ}+(\\arctan(1)-90^{\\circ})=-135^{\\circ}+(45^{\\circ}-90^{\\circ})=-180^{\\circ}.\n$$\n因此，\n$$\n\\mathrm{PM}_{PI}=180^{\\circ}-180^{\\circ}=0^{\\circ}.\n$$\n对于增益裕度，相位交越发生在 $\\omega_{pc}=1$ rad/s，且 $|L_{PI}(\\mathrm{j}1)|=1$，所以\n$$\n\\mathrm{GM}_{PI}=\\frac{1}{|L_{PI}(\\mathrm{j}\\omega_{pc})|}=\\frac{1}{1}=1.\n$$\n\n3) 超前补偿器。在 $\\omega=1$ 处，\n$$\n|C_{L}(\\mathrm{j}1)|=K_{L}\\frac{\\sqrt{1+1^{2}}}{\\sqrt{1+(0.2\\cdot 1)^{2}}}=K_{L}\\frac{\\sqrt{2}}{\\sqrt{1.04}}.\n$$\n单位交越条件 $|L_{L}(\\mathrm{j}1)|=1$ 变为\n$$\nK_{L}\\frac{\\sqrt{2}}{\\sqrt{1.04}}\\cdot\\frac{1}{\\sqrt{2}}=1 \\;\\Rightarrow\\; K_{L}=\\sqrt{1.04}.\n$$\n在 $\\omega=1$ 处的环路相位为\n$$\n\\arg L_{L}(\\mathrm{j}1)=\\arg G(\\mathrm{j}1)+\\arg C_{L}(\\mathrm{j}1)=-135^{\\circ}+\\bigl(\\arctan(1)-\\arctan(0.2)\\bigr)\n=-135^{\\circ}+\\bigl(45^{\\circ}-11.3099^{\\circ}\\bigr)=-101.3099^{\\circ}.\n$$\n因此，\n$$\n\\mathrm{PM}_{L}=180^{\\circ}-101.3099^{\\circ}=78.6901^{\\circ}.\n$$\n对于增益裕度，相位交越条件是 $\\arg G(\\omega_{pc}) + \\arg C_L(\\omega_{pc}) = -180^\\circ$，这简化为：\n$$\n\\arctan(2\\omega_{pc})+\\arctan\\!\\left(\\frac{\\omega_{pc}}{2}\\right)+\\arctan(0.2\\omega_{pc})=180^{\\circ},\n$$\n求解可得 $\\omega_{pc}^2 = 13.5$，即 $\\omega_{pc} = \\sqrt{13.5} \\approx 3.674$ rad/s。在该频率下的环路幅值为\n$$\n|L_{L}(\\mathrm{j}\\omega_{pc})| = K_L |C_L(\\mathrm{j}\\omega_{pc})| |G(\\mathrm{j}\\omega_{pc})| = \\sqrt{1.04} \\left| \\frac{1+j\\sqrt{13.5}}{1+j0.2\\sqrt{13.5}} \\right| \\left| \\frac{1-j2\\sqrt{13.5}}{(1+j\\sqrt{13.5})(2+j\\sqrt{13.5})} \\right| \\approx 1.457,\n$$\n所以\n$$\n\\mathrm{GM}_{L}=\\frac{1}{|L_{L}(\\mathrm{j}\\omega_{pc})|}\\approx 0.686.\n$$\n\n通过 Bode 相位合成进行解释。位于 $s=+0.5$ 的右半平面零点贡献了一个负相位项 $-\\arctan(2\\omega)$，同时随着 $\\omega$ 的升高增加了高频幅值，这是非最小相位行为的一个标志。比例积分补偿器在原点引入一个极点，在 $s=-1$ 引入一个零点，净相位为 $\\arctan(\\omega)-90^{\\circ}$；在选定的交越频率 $\\omega=1$ 处，这增加了 $-45^{\\circ}$ 的相位滞后，将总环路相位推至 $-180^{\\circ}$，从而产生零相位裕度和单位增益裕度。比例补偿器在交越频率处不改变相位，给出了一个适中的相位裕度（此处为 $45^{\\circ}$）和一个略大于 1 的增益裕度（$\\approx 1.061$）。超前补偿器增加了正相位 $\\arctan(\\omega)-\\arctan(0.2\\omega)$，这在 $\\omega=1$ 附近很大程度上补偿了对象的部分相位滞后，并导致了一个大的相位裕度（$\\approx 78.69^{\\circ}$）。然而，超前补偿器也在较高频率处放大了幅值，这与对象的非最小相位零点共同作用，使得相位交越频率处的环路幅值显著增加，从而导致一个更小的增益裕度（$\\approx 0.686$）。这说明了非最小相位零点所带来的权衡：在固定的交越频率下，通过超前补偿增加相位裕度可能会因为高频环路幅值的增加而牺牲增益裕度。\n\n最终报告量。在三种补偿器中，最大的相位裕度来自超前补偿环路。根据上述计算，\n$$\n\\mathrm{PM}_{\\max}=\\mathrm{PM}_{L}\\approx 78.6901^{\\circ}.\n$$\n四舍五入到四位有效数字并以度表示，结果是 $78.69$ 度。", "answer": "$$\\boxed{78.69}$$", "id": "2906949"}]}