## 引言
在[系统建模](@entry_id:197208)与信号处理领域，[传递函数](@entry_id:273897)和状态空间是描述动态系统的两种基本语言。[传递函数](@entry_id:273897)提供了简洁的输入-输出（外部）视角，而状态空间则揭示了系统内部状态的[演化机制](@entry_id:196221)。尽管两种表示在理论上是等价的，但从给定的[传递函数](@entry_id:273897)构建一个状态空间模型——即“[状态空间实现](@entry_id:166670)”问题——并非一个简单的代数转换。这个过程充满了关于系统效率、唯一性和稳定性的深刻问题，这些问题直接关系到我们对系统内在结构的理解。

本文旨在系统性地回答这些问题，为读者构建一个从[传递函数](@entry_id:273897)到[状态空间实现](@entry_id:166670)的完整知识框架。我们将分三个章节展开讨论。在“原理与机制”中，我们将深入探讨实现理论的核心，阐明一个实现存在的条件、非唯一性问题，并引入最小性的概念及其与可控性和可观性的内在联系。接着，在“应用与跨学科联系”中，我们将展示这些理论如何在信号处理、[系统辨识](@entry_id:201290)、以及对MIMO和时延等复杂系统的建模中发挥作用，并探讨不同实现[范式](@entry_id:161181)（如模态形式）的物理意义。最后，通过“动手实践”部分，你将有机会通过具体问题来巩固和应用所学知识。

让我们从第一章开始，系统地探索将系统外部描述转换为内部洞察的基本原理与机制。

## 原理与机制

在上一章中，我们介绍了将物理系统和[信号处理算法](@entry_id:201534)抽象为数学模型的概念。两种最普遍的表示方法是输入-输出表示（通过[传递函数](@entry_id:273897)或脉冲响应）和[状态空间表示](@entry_id:147149)。本章将深入探讨这两种表示之间的基本关系，重点关注从给定的有理[传递函数](@entry_id:273897) $G(s)$ 导出状态空间模型 $(A,B,C,D)$ 的过程。这个过程被称为**[状态空间实现](@entry_id:166670) (state-space realization)**。我们将系统地阐述实现的存在性、非唯一性、效率（即最小性）以及这种结构对[系统稳定性](@entry_id:273248)的深远影响。

### 从[传递函数](@entry_id:273897)到[状态空间](@entry_id:177074)：实现问题

从本质上讲，[状态空间实现](@entry_id:166670)旨在将系统的外部（输入-输出）描述转换为内部（状态）描述。对于一个给定的有理[传递函数矩阵](@entry_id:271746) $G(s)$，其[状态空间实现](@entry_id:166670)是一个矩阵四元组 $(A,B,C,D)$，其维度分别为 $n \times n$、$n \times m$、$p \times n$ 和 $p \times m$，满足以下关系：

$G(s) = C(sI - A)^{-1}B + D$

这个等式是在[复变量](@entry_id:175312) $s$ 的一个集合上成立的，在该集合上矩阵 $(sI - A)$ 是可逆的。这个定义是连接[频域](@entry_id:160070)和时域模型的桥梁 [@problem_id:2907652]。状态向量 $x(t) \in \mathbb{R}^n$ 的维度 $n$ 被称为该实现的**阶 (order)**。

一个自然产生的问题是：什么样的[传递函数](@entry_id:273897)可以被一个有限维[状态空间模型](@entry_id:137993)实现？答案与[传递函数](@entry_id:273897)的**固有性 (properness)** 直接相关。一个有理[传递函数](@entry_id:273897)（或[传递函数矩阵](@entry_id:271746)的每个元素）如果其分子多项式的次数不大于分母多项式的次数，则被称为**固有的 (proper)**。如果分子的次数严格小于分母的次数，则被称为**严格固有的 (strictly proper)** [@problem_id:2907652]。

要理解固有性为何如此关键，我们可以考察[传递函数](@entry_id:273897)在 $s \to \infty$ 时的行为。对于一个由 $(A,B,C,D)$ 实现的系统，我们可以分析其[传递函数](@entry_id:273897)表达式的极限：
$$
\lim_{s \to \infty} G(s) = \lim_{s \to \infty} \left( C(sI - A)^{-1}B + D \right)
$$
矩阵 $(sI-A)^{-1}$ 可以展开为 $\frac{1}{s} (I - \frac{1}{s}A)^{-1}$。对于足够大的 $|s|$，我们可以使用[诺伊曼级数](@entry_id:191685)展开 $(I-X)^{-1} = I + X + X^2 + \dots$，得到：
$$
(sI-A)^{-1} = \frac{1}{s}I + \frac{1}{s^2}A + \frac{1}{s^3}A^2 + \dots
$$
当 $s \to \infty$ 时，这个级数的每一项都趋向于[零矩阵](@entry_id:155836)。因此，$\lim_{s \to \infty} C(sI-A)^{-1}B = 0$。这意味着：
$$
\lim_{s \to \infty} G(s) = D
$$
这个重要的结论表明，任何有限维[状态空间实现](@entry_id:166670)的[传递函数](@entry_id:273897)在[无穷远处的极限](@entry_id:140879)都是一个有限的常数矩阵 $D$，即[传递函数](@entry_id:273897)必须是固有的。矩阵 $D$ 通常被称为**直接馈通项 (direct feedthrough term)**，因为它代表了输入在没有经过动态系统（积分器）的情况下直接传递到输出的路径。相应地，如果一个系统是严格固有的，那么 $\lim_{s \to \infty} G(s) = 0$，这必然要求在其任何实现中 $D=0$ [@problem_id:2907652]。反之，一个**非固有 (improper)** 的[传递函数](@entry_id:273897)（即分子次数大于分母次数）无法用标准的有限维[状态空间](@entry_id:177074)形式来表示，因为它在无穷远处的增益是无限的。

那么，对于任何一个固有的有理[传递函数](@entry_id:273897) $G(s)$，我们是否总能找到一个[状态空间实现](@entry_id:166670)呢？答案是肯定的。我们可以通过[多项式长除法](@entry_id:272380)来证明这一点。任何一个固有[有理函数](@entry_id:154279) $G(s)$ 都可以被分解为一个常数 $D$ 和一个严格固有的部分 $\tilde{G}(s)$ 的和：
$$
G(s) = D + \tilde{G}(s)
$$
其中 $D = \lim_{s \to \infty} G(s)$。接下来，我们只需要为严格固有的部分 $\tilde{G}(s)$ 找到一个实现 $(A,B,C)$ 即可。存在多种构造性方法可以做到这一点，例如**可控规范型 (controllable canonical form)** 或**可观测规范型 (observable canonical form)**。这些规范型提供了一套明确的程序，可以直接从 $\tilde{G}(s)$ 的分子和分母多项式的系数构建出矩阵 $A, B, C$。因此，通过将这些部分组合起来，任何固有的实有理[传递函数](@entry_id:273897)都存在一个有限维的实数[状态空间实现](@entry_id:166670) $(A,B,C,D)$ [@problem_id:2749006]。

### 非唯一性与等价实现：相似性变换的角色

我们已经确定任何固有有理[传递函数](@entry_id:273897)都至少有一个[状态空间实现](@entry_id:166670)。下一个问题是：这个实现是唯一的吗？答案是肯定的。事实上，如果一个系统存在一个实现，那么它就存在无穷多个实现。

这是因为状态向量 $x$ 本身并不是唯一的。它仅仅是一组描述系统内部动态的变量。我们可以选择另一组变量（状态基）来描述同一个系统。这种[坐标变换](@entry_id:172727)在数学上通过一个[可逆矩阵](@entry_id:171829) $T$ 来表示，称为**相似性变换 (similarity transformation)**。令 $\bar{x} = T^{-1}x$ 为新的[状态向量](@entry_id:154607)，其中 $T \in \mathbb{R}^{n \times n}$ 是一个任意的[可逆矩阵](@entry_id:171829)。通过代换，我们可以得到新[坐标系](@entry_id:156346)下的[状态空间模型](@entry_id:137993) $(\bar{A}, \bar{B}, \bar{C}, \bar{D})$：
$$
\dot{\bar{x}} = (T^{-1}AT)\bar{x} + (T^{-1}B)u
$$
$$
y = (CT)\bar{x} + Du
$$
因此，新的实现矩阵为：
$$
\bar{A} = T^{-1}AT, \quad \bar{B} = T^{-1}B, \quad \bar{C} = CT, \quad \bar{D} = D
$$
一个至关重要的问题是，这个新的实现是否描述了同一个输入-输出系统。我们可以通过计算它的[传递函数](@entry_id:273897)来验证：
$$
\bar{G}(s) = \bar{C}(sI - \bar{A})^{-1}\bar{B} + \bar{D} = (CT)(sI - T^{-1}AT)^{-1}(T^{-1}B) + D
$$
注意到 $sI - T^{-1}AT = T^{-1}(sI-A)T$，因此 $(sI - T^{-1}AT)^{-1} = T^{-1}(sI-A)^{-1}T$。代入上式得到：
$$
\bar{G}(s) = C(TT^{-1})(sI-A)^{-1}(TT^{-1})B + D = C(sI-A)^{-1}B + D = G(s)
$$
这个结果表明，**[传递函数](@entry_id:273897)在相似性变换下是不变的** [@problem_id:2907656]。这意味着所有通过相似性变换相互关联的实现都是**等价的 (equivalent)**，因为它们描述了完全相同的输入-输出行为。

这也引出了一个更深层次的问题：在相似性变换下，哪些系统属性是不变的，哪些是依赖于特定坐标选择的？不变的属性是系统的内在特性，而变化的属性则是实现的表现形式。除了[传递函数](@entry_id:273897)本身，其他重要的[不变量](@entry_id:148850)包括系统的**不变零点 (invariant zeros)** 和**[可控性](@entry_id:148402)指数 (controllability indices)**。相反，像状态矩阵 $A$ 的[特征向量](@entry_id:151813)或**[可控性格拉姆矩阵](@entry_id:186170) (controllability Gramian)** 的[特征值](@entry_id:154894)等属性通常会随着[坐标系](@entry_id:156346)的改变而改变 [@problem_id:2907656]。理解这些[不变量](@entry_id:148850)对于分析和比较不同模型至关重要。

### 最小性：寻找最高效的实现

既然存在无穷多个实现，我们自然会去寻找“最好”或“最有效”的那个。在状态空间理论中，“效率”通常指[状态向量](@entry_id:154607)的维度尽可能小。一个状态维度为 $n$ 的实现，如果不存在一个阶数更低的实现能够产生相同的[传递函数](@entry_id:273897)，那么这个实现就被称为**[最小实现](@entry_id:176932) (minimal realization)** [@problem_id:2907670]。

最小性的概念与两个核心的结构特性紧密相连：**可控性 (controllability)** 和**[可观测性](@entry_id:152062) (observability)**。
-   **可控性**：一个系统（或状态空间对 $(A,B)$）是可控的，如果对于任意初始状态 $x(0)$ 和任意目标状态 $x_f$，都存在一个输入信号 $u(t)$，能在有限时间内将系统从 $x(0)$ 驱动到 $x_f$。直观地讲，[可控性](@entry_id:148402)意味着输入信号有能力影响系统的所有动态模式。
-   **[可观测性](@entry_id:152062)**：一个系统（或状态空间对 $(A,C)$）是可观测的，如果对于任意未知的初始状态 $x(0)$，我们都可以通过在一段有限时间内观测输出信号 $y(t)$ 和输入信号 $u(t)$ 来唯一地确定 $x(0)$。直观地讲，[可观测性](@entry_id:152062)意味着系统的所有动态模式都能在输出信号中有所体现。

实现理论中的一个基本定理指出：**一个[状态空间实现](@entry_id:166670)是最小的，当且仅当它既是可控的也是可观测的** [@problem_id:2907670]。如果一个实现不是最小的，那意味着其[状态空间](@entry_id:177074)中存在“冗余”的部分：或者存在无法被输入影响的模式（不可控），或者存在无法在输出中被观察到的模式（不可观测）。这些“隐藏模式”可以在不改变输入-输出关系（即[传递函数](@entry_id:273897)）的情况下从模型中移除，从而得到一个阶数更低的实现。

为了检验一个实现 $(A,B,C)$ 的最小性，我们有几个等价的代数测试方法：

1.  **[卡尔曼秩检验](@entry_id:170588) (Kalman Rank Tests)**：这是最经典的测试方法。我们构造**[可控性矩阵](@entry_id:271824)** $\mathcal{C}$ 和**[可观测性矩阵](@entry_id:165052)** $\mathcal{O}$：
    $$
    \mathcal{C} = \begin{bmatrix} B  AB  A^2B  \cdots  A^{n-1}B \end{bmatrix}
    $$
    $$
    \mathcal{O} = \begin{bmatrix} C \\ CA \\ CA^2 \\ \vdots \\ CA^{n-1} \end{bmatrix}
    $$
    系统是可控的当且仅当 $\operatorname{rank}(\mathcal{C}) = n$，是可观测的当且仅当 $\operatorname{rank}(\mathcal{O}) = n$。因此，实现是最小的当且仅当这两个矩阵都具有满秩 $n$ [@problem_id:2907670] [@problem_id:2748882]。

2.  **PBH（Popov–Belevitch–Hautus）检验**：这是一种[频域](@entry_id:160070)测试方法。实现是最小的当且仅当对于所有复数 $\lambda \in \mathbb{C}$，以下两个秩条件同时满足：
    $$
    \operatorname{rank}\begin{bmatrix} \lambda I - A  B \end{bmatrix} = n \quad \text{和} \quad \operatorname{rank}\begin{bmatrix} \lambda I - A \\ C \end{bmatrix} = n
    $$
    实际上，我们只需要对 $A$ 的所有[特征值](@entry_id:154894) $\lambda$ 进行检验即可 [@problem_id:2748882]。如果对于某个[特征值](@entry_id:154894) $\lambda_0$，第一个秩条件不满足，则与该[特征值](@entry_id:154894)关联的模式是不可控的；如果第二个秩条件不满足，则是不可观测的。

3.  **汉克尔矩阵检验 (Hankel Matrix Test)**：我们还可以通过系统的马尔可夫参数 $H_k = CA^{k-1}B$（即脉冲响应的样本）来构造一个**汉克尔矩阵** $\mathcal{H}_n$。实现是最小的当且仅当 $\operatorname{rank}(\mathcal{H}_n) = n$ [@problem_id:2748882]。这个检验的美妙之处在于它直接将最小阶数与输入-输出数据（脉冲响应）的内在复杂性联系起来。

### 麦克米兰阶：量化最小复杂度

既然所有[最小实现](@entry_id:176932)都具有相同的阶数，这个阶数本身就是一个[传递函数](@entry_id:273897) $G(s)$ 的[不变量](@entry_id:148850)。这个唯一的最小阶数被称为**麦克米兰阶 (McMillan degree)**，记为 $\delta(G)$。它量化了产生该输入-输出行为所需的最小动态复杂度 [@problem_id:2907650]。

从[传递函数](@entry_id:273897)的角度看，麦克米兰阶等于系统“真正的”极点数量。考虑一个SISO[传递函数](@entry_id:273897) $G(s) = \frac{N(s)}{P(s)}$。如果我们直接从给定的多项式 $P(s)$ 中构建实现，其阶数将是 $\deg(P(s))$。然而，如果 $N(s)$ 和 $P(s)$ 有公因式，就会发生**[极零点对消](@entry_id:261496) (pole-zero cancellation)**。每一次对消都对应于一个不可控或不可观测的模式。例如，考虑[传递函数](@entry_id:273897)：
$$
G(s) = \frac{(s+1)(s+2)}{(s+2)(s+3)(s+5)}
$$
其分母的“名义”阶数是3。然而，分子和分母共享一个因子 $(s+2)$。在化简后，我们得到等价的不可约[传递函数](@entry_id:273897)：
$$
G(s) = \frac{s+1}{(s+3)(s+5)}
$$
这个不可约形式的分母阶数是2。因此，这个系统的麦克米兰阶是2，任何[最小实现](@entry_id:176932)的阶数都将是2 [@problem_id:2907689]。名义阶数3对应于一个非[最小实现](@entry_id:176932)，其中与极点 $s=-2$ 相关的模式是隐藏的。

对于[MIMO系统](@entry_id:268566)，这个概念可以推广。通过**史密斯-麦克米兰[范式](@entry_id:161181) (Smith-McMillan form)**，任何有理[传递函数矩阵](@entry_id:271746) $G(s)$ 都可以分解为 $G(s) = U(s)M(s)V(s)$，其中 $U(s)$ 和 $V(s)$ 是[幺模矩阵](@entry_id:148345)（多项式矩阵，其[行列式](@entry_id:142978)为非零常数），而 $M(s)$ 是一个对角有理矩阵，其对角[线元](@entry_id:196833)素为 $\frac{\alpha_i(s)}{\beta_i(s)}$ 的形式，其中 $\alpha_i(s)$ 和 $\beta_i(s)$ 是[互质](@entry_id:143119)多项式。麦克米兰阶就是所有这些互质分母多项式次数的总和：$\delta(G) = \sum_{i} \deg \beta_i(s)$。这再次体现了麦克米兰阶是计算所有不可约极点的总数的思想 [@problem_id:2907658]。

### 结构分解与稳定性推论

最小性的概念对于理解系统的稳定性至关重要。我们区分两种稳定性概念：

-   **外部稳定性 (External Stability)** 或 **有界输入有界输出 (BIBO) 稳定性**：这是一个输入-输出概念。如果对任何有界的输入信号，系统产生的输出信号总是有界的，则称系统是BIBO稳定的。对于一个有理[传递函数](@entry_id:273897) $G(s)$，[BIBO稳定性](@entry_id:157773)等价于其所有极点都位于复平面的开[左半平面](@entry_id:270729)（即极点的实部均为负）。

-   **内部稳定性 (Internal Stability)** 或 **[李雅普诺夫稳定性](@entry_id:147734)**：这是一个状态概念。如果对于零输入，无论初始状态为何，[状态向量](@entry_id:154607) $x(t)$ 都会随着时间 $t \to \infty$ 衰减到零，则称一个实现 $(A,B,C,D)$ 是内部稳定的。这等价于状态矩阵 $A$ 的所有[特征值](@entry_id:154894)都位于开左半平面（即 $A$ 是一个**赫尔维茨 (Hurwitz)** 矩阵）。

**内部稳定性总是能保证外部稳定性**。因为 $G(s)$ 的极点是 $A$ 的[特征值](@entry_id:154894)的[子集](@entry_id:261956)，如果所有[特征值](@entry_id:154894)都在左半平面，那么所有极点也必然在左半平面。

然而，**外部稳定性并不总能保证内部稳定性**。一个系统可以有稳定的[传递函数](@entry_id:273897)（所有极点都在左半平面），但其某个实现却可能是内部不稳定的（$A$ 含有右半平面[特征值](@entry_id:154894)）。这种情况发生当且仅当该实现是**非最小的**，并且不稳定的模式是不可控或不可观测的。这些不稳定的“隐藏模式”虽然会导致内部状态发散，但由于它们与输入-输出通道解耦，因此不会出现在[传递函数](@entry_id:273897)中，也不会影响输出的稳定性 [@problem_id:2748980]。

这一深刻见解引出了**[卡尔曼分解](@entry_id:144281) (Kalman decomposition)**，这是一个强大的理论工具。通过一个相似性变换，任何[状态空间](@entry_id:177074)都可以被分解为四个相互正交的[子空间](@entry_id:150286)的直和：
1.  **可控且可观测的[子空间](@entry_id:150286) ($x_{co}$)**
2.  **可控但不可观测的[子空间](@entry_id:150286) ($x_{c\bar{o}}$)**
3.  **不可控但可观测的[子空间](@entry_id:150286) ($x_{\bar{c}o}$)**
4.  **既不可控也不可观测的[子空间](@entry_id:150286) ($x_{\bar{c}\bar{o}}$)**

在这个新的基底下，状态矩阵 $A$ 呈现出分块上三角结构，并且系统的[传递函数](@entry_id:273897) $G(s)$ 完全由可控且可观测的部分 $(A_{co}, B_{co}, C_{co})$ 决定。其他三个[子空间](@entry_id:150286)构成了系统的隐藏部分。

例如，对于一个由对角矩阵 $A=\operatorname{diag}(-1, -2, -3)$ 和特定 $B, C$ 矩阵给出的三阶系统，我们可以通过分析可控与可观测[子空间](@entry_id:150286)来确定其结构。假设我们发现[可控子空间](@entry_id:176655)为 $\operatorname{span}\{e_1, e_2\}$，而[不可观测子空间](@entry_id:176289)为 $\operatorname{span}\{e_1\}$。通过这些[子空间的交](@entry_id:199017)与并，我们可以确定四个卡尔曼[子空间](@entry_id:150286)，并构造一个相似性变换 $T$ 将系统变换到[卡尔曼分解](@entry_id:144281)形式。在这个形式下，我们可以清晰地看到哪个状态是可控可观的，哪个是可控但不可观的，等等。[传递函数](@entry_id:273897)只与可控可观的那个状态（或状态块）相关。从这个分解中提取出的 $(A_{co}, B_{co}, C_{co})$ 就是该系统的[最小实现](@entry_id:176932) [@problem_id:2907691]。

总之，从[传递函数](@entry_id:273897)到[状态空间](@entry_id:177074)的实现过程揭示了系统模型的丰富内部结构。最小性的概念——通过[可控性](@entry_id:148402)和可观测性来定义——不仅引导我们找到最简洁的模型，而且是理解外部行为（如[BIBO稳定性](@entry_id:157773)）与内部动态之间微妙关系的关键。[卡尔曼分解](@entry_id:144281)为我们提供了一个完整的框架，用以剖析任何[线性系统](@entry_id:147850)，并分离其核心的输入-输出动态与隐藏的内部模式。