{"hands_on_practices": [{"introduction": "$\\mathcal{H}_{\\infty}$ 范数是衡量系统从输入到输出的最坏情况增益的关键指标。在练习 [@problem_id:2901523] 中，您将从诱导 $L_2$ 增益的抽象定义出发，利用 Kalman-Yakubovich-Popov (KYP) 引理，将其转化为一个具体的线性矩阵不等式（LMI）问题。通过解决这个LMI，您将能够亲手计算出系统的 $\\mathcal{H}_{\\infty}$ 范数，从而深刻理解时域的耗散性理论与频域的范数界限之间的内在联系。", "problem": "考虑具有状态空间实现的单输入单输出 (SISO) 线性时不变 (LTI) 系统\n$$\n\\dot{x}(t) = -2\\,x(t) + w(t), \\quad z(t) = x(t),\n$$\n其中 $x(t) \\in \\mathbb{R}$ 是状态，$w(t) \\in \\mathbb{R}$ 是外源输入，$z(t) \\in \\mathbb{R}$ 是性能输出。假设初始条件为 $x(0)=0$。对于这个渐近稳定的LTI系统，从 $w$ 到 $z$ 的诱导 $L_{2}$ 增益等于其 $\\mathcal{H}_{\\infty}$ 范数。\n\n仅从诱导 $L_{2}$ 增益的定义和供给率为 $s(w,z) = z^{\\top} z - \\gamma^{2} w^{\\top} w$ 的耗散不等式出发，使用 Kalman–Yakubovich–Popov (KYP) 引理来构造一个二次存储函数 $V(x) = x^{\\top} P x$（其中 $P \\succ 0$），该函数可证明诱导 $L_{2}$ 增益的一个上界 $\\gamma$。显式地推导相关的线性矩阵不等式 (LMI) 条件，并将其简化为适用于该系统的标量不等式。确定存在此类 $P \\succ 0$ 的最小界 $\\gamma_{\\star}$，展示在 $\\gamma = \\gamma_{\\star}$ 时的一个可行 $P$，并直接验证耗散不等式\n$$\n\\dot{V}(x) + z^{\\top}z - \\gamma^{2} w^{\\top} w \\le 0\n$$\n对所有 $x \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$ 成立。\n\n将最终答案表示为等于可实现的最小诱导 $L_{2}$ 增益界 $\\gamma_{\\star}$ 的精确实数。无需四舍五入。最终答案不带单位。", "solution": "本问题要求通过 Kalman–Yakubovich–Popov (KYP) 引理框架，利用二次存储函数来确定给定线性时不变 (LTI) 系统的最小诱导 $L_{2}$ 增益界 $\\gamma_{\\star}$。\n\n系统由以下状态空间方程给出：\n$$\n\\dot{x}(t) = -2\\,x(t) + w(t), \\quad z(t) = x(t)\n$$\n这对应于一般 LTI 形式 $\\dot{x} = Ax + Bw$ 和 $z = Cx + Dw$，其标量系数如下，为了形式上的一致性，我们将其视为 $1 \\times 1$ 矩阵：\n$A = -2$, $B = 1$, $C = 1$, 以及 $D = 0$。状态 $x$、输入 $w$ 和输出 $z$ 均在 $\\mathbb{R}$ 中。\n\n问题在于找到最小的 $\\gamma  0$，使得存在一个二次存储函数 $V(x) = x^{\\top}Px = Px^2$（其中 $P0$）满足耗散不等式：\n$$\n\\frac{d}{dt}V(x(t)) + s(w(t), z(t)) \\le 0\n$$\n对于系统的所有轨迹。供给率为 $s(w,z) = z^{\\top}z - \\gamma^2 w^{\\top}w$。在零初始条件下，存在这样的 $V(x)$ 保证了诱导 $L_2$ 增益有界于 $\\gamma$。该不等式为：\n$$\n\\dot{V}(x) + z^{\\top}z - \\gamma^2 w^{\\top}w \\le 0\n$$\n首先，我们计算存储函数 $V(x) = Px^2$ 的时间导数：\n$$\n\\dot{V}(x) = \\frac{d}{dt}(Px^2) = 2Px\\dot{x}\n$$\n代入状态方程 $\\dot{x} = -2x+w$：\n$$\n\\dot{V}(x) = 2Px(-2x+w) = -4Px^2 + 2Pxw\n$$\n现在，将 $\\dot{V}(x)$ 和 $z=x$ 代入耗散不等式：\n$$\n(-4Px^2 + 2Pxw) + (x^2) - \\gamma^2 w^2 \\le 0\n$$\n整理各项得到一个关于 $x$ 和 $w$ 的二次型：\n$$\n(1 - 4P)x^2 + 2Pxw - \\gamma^2 w^2 \\le 0\n$$\n这个不等式必须对所有 $x \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$ 成立。我们可以将左侧表示为矩阵形式：\n$$\n\\begin{pmatrix} x  w \\end{pmatrix}\n\\begin{pmatrix}\n1 - 4P  P \\\\\nP  -\\gamma^2\n\\end{pmatrix}\n\\begin{pmatrix} x \\\\ w \\end{pmatrix}\n\\le 0\n$$\n为使该二次型对所有 $x$ 和 $w$ 都是半负定的，该矩阵必须是半负定的。这就是与本问题相关的线性矩阵不等式 (LMI)：\n$$\n\\begin{pmatrix}\n1 - 4P  P \\\\\nP  -\\gamma^2\n\\end{pmatrix}\n\\preceq 0\n$$\n一个对称矩阵是半负定的，当且仅当其顺序主子式符号交替，从非正开始。\n$1$. 第一个主子式（$(1,1)$ 元素）必须是非正的：\n$$\n1 - 4P \\le 0 \\implies 4P \\ge 1 \\implies P \\ge \\frac{1}{4}\n$$\n$2$. 行列式（第二个主子式）必须是非负的：\n$$\n(1 - 4P)(-\\gamma^2) - P^2 \\ge 0\n$$\n$$\n- \\gamma^2 + 4P\\gamma^2 - P^2 \\ge 0\n$$\n$$\nP^2 - 4\\gamma^2 P + \\gamma^2 \\le 0\n$$\n我们需要找到最小的 $\\gamma  0$，使得存在一个 $P$ 同时满足 $P \\ge 1/4$ 和 $P^2 - 4\\gamma^2 P + \\gamma^2 \\le 0$。题目陈述中的条件 $P \\succ 0$ 变为 $P  0$，这由 $P \\ge 1/4$ 保证。\n\n考虑关于 $P$ 的二次不等式 $f(P) = P^2 - 4\\gamma^2 P + \\gamma^2 \\le 0$。这描述了一个开口向上的抛物线。为了使这个不等式有解 $P$，二次方程 $f(P) = 0$ 必须有实根。这要求其判别式为非负：\n$$\n\\Delta = (-4\\gamma^2)^2 - 4(1)(\\gamma^2) = 16\\gamma^4 - 4\\gamma^2 \\ge 0\n$$\n由于我们寻求 $\\gamma  0$，我们可以除以 $4\\gamma^2$：\n$$\n4\\gamma^2 - 1 \\ge 0 \\implies \\gamma^2 \\ge \\frac{1}{4}\n$$\n由于 $\\gamma$ 代表增益，它必须是非负的，所以 $\\gamma \\ge \\frac{1}{2}$。因此，存在解 $P$ 的 $\\gamma$ 的最小值为 $\\gamma_{\\star} = \\frac{1}{2}$。\n\n现在，我们必须为这个最小界 $\\gamma_{\\star}$ 展示一个可行的 $P  0$。令 $\\gamma = \\gamma_{\\star} = \\frac{1}{2}$。关于 $P$ 的不等式变为：\n$$\nP^2 - 4\\left(\\frac{1}{2}\\right)^2 P + \\left(\\frac{1}{2}\\right)^2 \\le 0\n$$\n$$\nP^2 - P + \\frac{1}{4} \\le 0\n$$\n这个表达式是一个完全平方：\n$$\n\\left(P - \\frac{1}{2}\\right)^2 \\le 0\n$$\n由于实数的平方不能为负，唯一的解是 $\\left(P - \\frac{1}{2}\\right)^2 = 0$，这意味着 $P = \\frac{1}{2}$。该解满足条件 $P  0$ 和 $P \\ge 1/4$。因此，对于 $\\gamma_{\\star} = 1/2$，存在一个唯一可行的存储函数参数 $P=1/2$。\n\n最后，我们对 $\\gamma = \\gamma_{\\star} = 1/2$ 和 $P=1/2$ 直接验证耗散不等式。\n存储函数为 $V(x) = \\frac{1}{2}x^2$。其导数为 $\\dot{V}(x) = x\\dot{x} = x(-2x+w) = -2x^2+xw$。\n不等式 $\\dot{V}(x) + z^2 - \\gamma^2 w^2 \\le 0$ 变为：\n$$\n(-2x^2 + xw) + x^2 - \\left(\\frac{1}{2}\\right)^2 w^2 \\le 0\n$$\n$$\n-x^2 + xw - \\frac{1}{4}w^2 \\le 0\n$$\n提出一个负号：\n$$\n-\\left(x^2 - xw + \\frac{1}{4}w^2\\right) \\le 0\n$$\n括号中的表达式是一个完全平方：\n$$\n-\\left(x - \\frac{1}{2}w\\right)^2 \\le 0\n$$\n这个不等式对所有 $x \\in \\mathbb{R}$ 和 $w \\in \\mathbb{R}$ 都成立，因为任何实数的平方都是非负的。这样就完成了验证。可实现的最小诱导 $L_{2}$ 增益界是 $\\gamma_{\\star}$。\n该问题是适定的，分析得出了一个确定的结果。最小界是 $\\gamma_{\\star} = 1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2901523"}, {"introduction": "标准 $\\mathcal{H}_{\\infty}$ 综合公式常依赖于简化假设，例如测量通道中不存在直接馈通项（$D_{22}=0$）。然而，在工程实践中这一假设往往不成立。练习 [@problem_id:2901540] 将引导您处理这个核心挑战，通过应用“回路变换”（loop shifting）这一关键技巧，将一个非标准问题转化为标准的可解形式，从而掌握将理论应用于复杂现实问题的能力。", "problem": "考虑一个连续时间线性时不变广义对象，其状态空间实现为\n$$\n\\begin{aligned}\n\\dot{x} = A x + B_{1} w + B_{2} u,\\\\\nz = C_{1} x + D_{11} w + D_{12} u,\\\\\ny = C_{2} x + D_{21} w + D_{22} u,\n\\end{aligned}\n$$\n其中，$x$ 是状态，$w$ 是外源输入，$u$ 是控制输入，$z$ 是被控输出，$y$ 是测量输出。$\\mathcal{H}_{\\infty}$ 综合的目标是设计一个正常控制器 $K$，使得从 $w$ 到 $z$ 的闭环传递矩阵的 $\\mathcal{H}_{\\infty}$ 范数小于一个预定的界限。标准的状态空间 $\\mathcal{H}_{\\infty}$ 公式假定 $D_{22} = 0$。然而，在许多实际模型中，$D_{22} \\neq 0$。\n\n从适定互联（无代数环路）的形式化定义以及 $P$ 与一个正常控制器 $K$ 的模块反馈互联出发，论述 $D_{22} \\neq 0$ 对标准状态空间 $\\mathcal{H}_{\\infty}$ 综合公式适用性的影响。然后，仅使用线性分式变换和信号重定义的基本性质，确定一个正确的程序，将问题转换为一个性能目标等价但在测量通道中直接馈通为零的问题，并将为变换后对象综合的控制器映射回原始对象的控制器。该程序可以描述为环路移动（信号重定义），或者通过与一个静态、适定的互联进行 Redheffer 星积来描述。\n\n哪个选项最准确地陈述了 $D_{22} \\neq 0$ 的影响以及处理该问题的正确、可验证的程序（包括必要的适定性条件）？\n\nA. $D_{22} \\neq 0$ 的存在在 $u$ 和 $y$ 之间产生了一个代数耦合，这使得基于 $D_{22} = 0$ 的标准状态空间 $\\mathcal{H}_{\\infty}$ 公式失效。一个有效的补救措施是进行环路移动，定义虚拟测量 $\\tilde{y} = y - D_{22} u$，这会产生一个具有相同 $(A, B_{1}, B_{2})$ 和输出 $(z, \\tilde{y})$ 的变换后对象，满足 $\\tilde{y} = C_{2} x + D_{21} w$，因此变换后的直接馈通 $\\tilde{D}_{22} = 0$。设计一个将 $\\tilde{y}$ 映射到 $u$ 的正常控制器 $\\hat{K}$，使用标准的 $\\mathcal{H}_{\\infty}$ 综合方法。然后，通过 $K = (I + \\hat{K} D_{22})^{-1} \\hat{K}$ 恢复原始对象的可实现控制器，前提是该互联是适定的（等价地，$I + \\hat{K}(\\infty) D_{22}$ 是非奇异的，从而使 $K$ 是正常的，并且 $I + \\hat{K}(s) D_{22}$ 在闭右半平面上是逐点可逆的）。此变换也可以表示为与强制 $\\tilde{y} = y - D_{22} u$ 的静态模块的 Redheffer 星积。在这些条件下，从 $w$ 到 $z$ 的闭环映射在该变换下是不变的。\n\nB. $D_{22} \\neq 0$ 这一项对于 $\\mathcal{H}_{\\infty}$ 综合是无关紧要的，因为 $\\mathcal{H}_{\\infty}$ 范数对小的直接馈通具有鲁棒性。可以忽略 $D_{22}$ 或设置 $D_{22} = 0$ 而不影响最优控制器，因为直接馈通仅扰动测量噪声。\n\nC. 处理 $D_{22} \\neq 0$ 的正确方法是通过在 $y$ 上插入一个静态预滤波器 $Q$ 并令 $Q = D_{22}^{-1}$ 来抵消它，这样控制器看到的便是 $Q y = Q(C_{2} x + D_{21} w + D_{22} u) = C_{2}' x + D_{21}' w + u$。这对于任何 $D_{22}$ 都消除了代数环路，并保持了最优的 $\\mathcal{H}_{\\infty}$ 性能。\n\nD. 当 $D_{22} \\neq 0$ 时，标准方法仍然是在原始对象上综合一个控制器，然后通过 $K = \\hat{K} (I + D_{22} \\hat{K})^{-1}$ 对其进行校正。此公式无需额外假设即可成立，并保证与未校正控制器相同的闭环 $\\mathcal{H}_{\\infty}$ 范数。", "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n已知条件如下：\n- 一个连续时间线性时不变（LTI）广义对象，其状态空间实现为：\n$$\n\\begin{aligned}\n\\dot{x} = A x + B_{1} w + B_{2} u,\\\\\nz = C_{1} x + D_{11} w + D_{12} u,\\\\\ny = C_{2} x + D_{21} w + D_{22} u,\n\\end{aligned}\n$$\n- $x$ 是状态向量。\n- $w$ 是外源输入向量。\n- $u$ 是控制输入向量。\n- $z$ 是被控输出向量。\n- $y$ 是测量输出向量。\n- 目标是设计一个正常的控制器 $K$，使得从 $w$ 到 $z$ 的闭环传递矩阵的 $\\mathcal{H}_{\\infty}$ 范数小于一个预定的界限。\n- 标准的状态空间 $\\mathcal{H}_{\\infty}$ 综合公式假定 $D_{22} = 0$。\n- 需要解决的问题是 $D_{22} \\neq 0$ 的情况。\n- 任务是确定 $D_{22} \\neq 0$ 的影响，并找到一个正确的程序，将问题转换为一个性能目标等价但在测量通道中直接馈通为零（$D_{22,new} = 0$）的问题，并将为新对象设计的控制器映射回原始对象的控制器。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是鲁棒控制理论中的一个标准课题，特别是 $\\mathcal{H}_{\\infty}$ 综合。广义对象表示法和非零 $D_{22}$ 项的问题是该领域的基本概念。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它要求推导和论证控制理论中一个已知的标准程序。问题清晰，有明确、可验证的答案。\n- **客观性**：问题使用精确、客观、标准的控制工程术语陈述。没有主观性或歧义。\n- 该问题没有违反任何无效性标准。它不是基于错误的前提，可以直接形式化，是自洽的，科学上是合理的，并且不是微不足道的。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。将推导解答。\n\n### 基于原理的推导\n该问题涉及为一个广义对象 $P$ 进行 $\\mathcal{H}_{\\infty}$ 控制器综合，其中从控制输入 $u$ 到测量输出 $y$ 的直接馈通项 $D_{22}$ 不为零。通常涉及两个代数 Riccati 方程的标准状态空间解法，是在 $D_{22} = 0$ 这一简化假设下推导出来的。\n\n$D_{22} \\neq 0$ 的存在使得 $y$ 在代数上依赖于 $u$。当连接一个控制器 $u=K(s)y$ 时，测量方程变为 $y = C_2 x + D_{21} w + D_{22} K y$。这意味着一个直接的代数环路：$(I - D_{22} K)y = C_2 x + D_{21} w$。为了使这个互联是适定的，矩阵 $(I - D_{22} K(s))$ 必须是可逆的。对于一个正常控制器 $K(s)$，在 $s \\to \\infty$ 时，这要求 $(I - D_{22} K(\\infty))$ 是可逆的。标准的综合公式没有考虑这个代数约束，因此不直接适用。\n\n处理这个问题的一个正确程序是一种称为“环路移动”或信号重定义的技术。其目标是定义一个新的、虚拟的测量输出 $\\tilde{y}$，使其与 $u$ 的直接馈通为零，同时保持底层的性能目标。\n\n我们定义一个新的测量信号 $\\tilde{y}$ 为：\n$$ \\tilde{y} = y - D_{22} u $$\n代入 $y$ 的原始表达式：\n$$ \\tilde{y} = (C_{2} x + D_{21} w + D_{22} u) - D_{22} u = C_{2} x + D_{21} w $$\n我们现在可以定义一个新的广义对象 $\\tilde{P}$，它具有相同的状态 $x$、输入 $(w, u)$ 和性能输出 $z$，但使用新的测量输出 $\\tilde{y}$。$\\tilde{P}$ 的状态空间表示为：\n$$\n\\begin{aligned}\n\\dot{x} = A x + B_{1} w + B_{2} u,\\\\\nz = C_{1} x + D_{11} w + D_{12} u,\\\\\n\\tilde{y} = C_{2} x + D_{21} w + 0 \\cdot u.\n\\end{aligned}\n$$\n这个变换后的对象 $\\tilde{P}$ 有一个新的矩阵 $\\tilde{D}_{22} = 0$。因此，标准的 $\\mathcal{H}_{\\infty}$ 综合算法可以应用于 $\\tilde{P}$，以设计一个正常的控制器，我们称之为 $\\hat{K}$，它将 $\\tilde{y}$ 映射到 $u$，即 $u = \\hat{K} \\tilde{y}$。\n\n接下来，我们必须找到用于原始对象的控制器 $K$，它将原始测量值 $y$ 映射到 $u$，即 $u = K y$。我们使用我们已定义的关系：\n$$ u = \\hat{K} \\tilde{y} \\quad \\text{和} \\quad \\tilde{y} = y - D_{22} u $$\n将第二个方程代入第一个方程：\n$$ u = \\hat{K} (y - D_{22} u) $$\n$$ u = \\hat{K} y - \\hat{K} D_{22} u $$\n重新整理以求解 $u$ 作为 $y$ 的函数：\n$$ (I + \\hat{K} D_{22}) u = \\hat{K} y $$\n$$ u = (I + \\hat{K} D_{22})^{-1} \\hat{K} y $$\n因此，用于原始对象 $P$ 的控制器由下式给出：\n$$ K = (I + \\hat{K} D_{22})^{-1} \\hat{K} $$\n这个表达式表示对 $\\hat{K}$ 的一个下线性分式变换（LFT），具体为 $K = \\mathcal{F}_l(\\hat{K}, -D_{22})$。\n\n为了使这个变换有效，必须满足某些条件：\n1.  **适定性**：得到的控制器 $K(s)$ 必须是正常的。由于综合出的控制器 $\\hat{K}(s)$ 是正常的，其在无穷远点的值 $\\hat{K}(\\infty)$ 是一个有限矩阵。$K(s)$ 的正常性要求 $K(\\infty) = (I + \\hat{K}(\\infty) D_{22})^{-1} \\hat{K}(\\infty)$ 是良定义的。这反过来要求矩阵 $(I + \\hat{K}(\\infty) D_{22})$ 必须是可逆的。\n2.  **稳定性**：控制器 $\\hat{K}$ 稳定了对象 $\\tilde{P}$。得到的控制器 $K$ 必须稳定原始对象 $P$。$K(s)$ 的极点包括 $\\hat{K}(s)$ 的极点，也可能包括对应于 $\\det(I + \\hat{K}(s) D_{22})$ 零点的额外极点。为了整个系统的内部稳定性，定义 $K$ 的反馈环路必须是稳定的。这要求传递矩阵 $(I + \\hat{K}(s) D_{22})^{-1}$ 在闭右半平面（$Re(s) \\ge 0$）内没有极点，这等价于要求 $(I + \\hat{K}(s) D_{22})$ 在闭右半平面内的所有 $s$ 上都是逐点可逆的。\n\n最后，我们必须验证闭环性能在此变换下是不变的。从 $w$到 $z$ 的闭环传递函数，记为 $T_{zw}$，由下 LFT $\\mathcal{F}_l(P, K)$ 给出。变换后问题的传递函数为 $\\tilde{T}_{zw} = \\mathcal{F}_l(\\tilde{P}, \\hat{K})$。通过将 $K$ 关于 $\\hat{K}$ 的表达式代入原始闭环系统的方程，可以通过代数操作（如在思考过程中所进行的）证明，对于两个闭环系统，控制信号 $u$ 关于状态 $x$ 和外源输入 $w$ 的最终表达式是相同的。因此，状态演化和输出 $z$ 是相同的，从而导致 $T_{zw} = \\tilde{T}_{zw}$。因此，两个问题的 $\\mathcal{H}_{\\infty}$ 性能目标是等价的。整个过程是一种变量替换，可以用系统互联的代数来抽象表示，例如 Redheffer 星积。\n\n### 逐项分析\n\n**A. $D_{22} \\neq 0$ 的存在在 $u$ 和 $y$ 之间产生了一个代数耦合...**\n该选项正确地指出，$D_{22} \\neq 0$ 引入了一个代数耦合，使得标准公式失效。它提出了正确的环路移动 $\\tilde{y} = y - D_{22} u$，从而得到一个变换后且 $\\tilde{D}_{22} = 0$ 的对象。它正确地确定了为新对象设计控制器 $\\hat{K}$ 的过程。它提供了原始控制器的正确公式，$K = (I + \\hat{K} D_{22})^{-1} \\hat{K}$。至关重要的是，它列出了必要的适定性和稳定性条件，涉及 $(I + \\hat{K}(\\infty) D_{22})$ 和 $(I + \\hat{K}(s) D_{22})$ 在闭右半平面上的可逆性。它正确地断言从 $w$ 到 $z$ 的闭环映射是不变的。提及 Redheffer 星积也提供了恰当的背景。\n**结论：正确**\n\n**B. $D_{22} \\neq 0$ 这一项对于 $\\mathcal{H}_{\\infty}$ 综合是无关紧要的...**\n这个陈述是根本错误的。忽略 $D_{22}$ 相当于将在修改后的对象 $\\tilde{P}$ 上设计的控制器 $\\hat{K}$ 直接用于原始对象 $P$。这会导致一个不同的闭环系统，具有不同的传递函数 $T_{zw}$，因此性能也不同。更关键的是，闭环系统的稳定性没有保证。项 $(I - \\hat{K}(s) P_{22}(s))^{-1}$ 会出现在闭环动态中，而 $\\hat{K}$ 的设计并不能保证其稳定性。$D_{22}$ 的大小并没有假定为很小，因此不能将其视为可忽略的扰动。\n**结论：错误**\n\n**C. 处理 $D_{22} \\neq 0$ 的正确方法是通过在 $y$ 上插入一个静态预滤波器 $Q = D_{22}^{-1}$...**\n这个程序存在几个缺陷。首先，它假定 $D_{22}$ 是可逆的，这要求它是一个方的非奇异矩阵。这个条件通常不满足；例如，在输入和测量数量不同的系统中。其次，即使 $D_{22}$ 是可逆的，应用预滤波器 $Q=D_{22}^{-1}$ 会得到一个新的测量输出 $y' = (D_{22}^{-1}C_2)x + (D_{22}^{-1}D_{21})w + u$。新的馈通项将是 $D'_{22} = I$（单位矩阵），而不是 $0$。这并没有将问题转换为综合公式所需的标准形式。\n**结论：错误**\n\n**D. 当 $D_{22} \\neq 0$ 时，标准方法仍然是在原始对象上综合一个控制器...**\n该选项包含几个不准确之处。首先，“在原始对象上综合一个控制器”这句话是模糊的。假设它的意思是“为对象综合一个控制器 $\\hat{K}$，就好像 $D_{22}$ 为 $0$ 一样”，那么提出的校正控制器公式是 $K = \\hat{K} (I + D_{22} \\hat{K})^{-1}$。使用矩阵恒等式 $(I+AB)^{-1}A = A(I+BA)^{-1}$，这在数学上等价于选项 A 中的公式：$K = (I + \\hat{K} D_{22})^{-1} \\hat{K}$。然而，声称此公式“无需额外假设即可成立”是严重错误的。正如我们的推导所确立的，$K$ 的适定性（即其正常性）和所得互联的稳定性依赖于项 $(I + \\hat{K} D_{22})$ 的可逆性条件。选项 A 正确地陈述了这些必要条件，而选项 D 错误地忽略了它们。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "2901540"}, {"introduction": "当系统面对具有特定“结构”的不确定性时，单纯使用 $\\mathcal{H}_{\\infty}$ 范数进行分析可能导致过于保守的结论。练习 [@problem_id:2901532] 引入了更精细的鲁棒性分析工具——结构化奇异值（$\\mu$）。您将通过实现一个数值优化算法来计算 $\\mu$ 的上界，这一过程将揭示如何利用 D-缩放（D-scaling）技术来降低保守性，这也是现代 $\\mu$ 分析与综合的基石。", "problem": "考虑一个在固定频率下的复矩阵的结构奇异值，该奇异值是为块对角不确定性集合定义的。设结构不确定性为块对角形式，其块的大小由给定的正整数指定。对于一个复方阵 $M \\in \\mathbb{C}^{n \\times n}$，其相对于给定块结构的结构奇异值定义为：在该结构中使得 $I - M \\Delta$ 奇异的最小范数不确定性 $\\Delta$ 的范数的倒数（如果存在这样的 $\\Delta$），否则为零。您的目标是从结构奇异值的精确定义以及范数和相似变换的基本性质出发，推导出一个可实现的上界。该上界使用与不确定性结构对易的块对角正定缩放矩阵 $D$。然后，实现一个数值算法，通过对此类 $D$ 进行优化来计算这个上界。\n\n您必须：\n- 从结构奇异值的定义出发，仅使用核心定义和谱范数的次乘性，推导出一个基于与不确定性结构对易的块对角正定缩放矩阵的可计算上界。\n- 将允许的缩放矩阵 $D$ 建模为块对角矩阵，每个不确定性块对应一个正常数，该常数在该块的对角线上重复以匹配其大小。即，如果不确定性有 $b$ 个块，大小分别为 $n_{1}, \\dots, n_{b}$，则 $D = \\mathrm{diag}(d_{1} I_{n_{1}}, \\dots, d_{b} I_{n_{b}})$，其中 $d_{i}  0$。\n- 通过使用缩放因子的对数，将优化问题简化为一个有限维无约束问题，从而自动满足正性约束。\n- 实现一个稳健的数值程序来计算下面每个测试用例的上界。您可以使用迭代数值优化方法，并应注意确保确定性行为。\n\n测试套件：\n每个测试用例提供一个单频复矩阵 $M$ 和一个表示不确定性结构的块大小列表。对于每个测试用例，计算通过上述块对角缩放方法得到的上界值。\n\n- 测试用例 1:\n  - $M \\in \\mathbb{C}^{2 \\times 2}$ 由下式给出\n    $$\n    M = \\begin{bmatrix}\n    0.2 + 0.1 \\mathrm{i}  2.0 - 0.3 \\mathrm{i} \\\\\n    0.0 + 0.5 \\mathrm{i}  0.1 - 0.2 \\mathrm{i}\n    \\end{bmatrix}.\n    $$\n  - 块大小: $[1, 1]$。\n- 测试用例 2:\n  - $M \\in \\mathbb{C}^{3 \\times 3}$ 由下式给出\n    $$\n    M = \\begin{bmatrix}\n    0.05 + 0.0 \\mathrm{i}  1.0 - 0.1 \\mathrm{i}  0.2 - 0.1 \\mathrm{i} \\\\\n    0.0 + 0.1 \\mathrm{i}  0.3 + 0.0 \\mathrm{i}  2.0 + 0.2 \\mathrm{i} \\\\\n    0.0 + 0.0 \\mathrm{i}  0.5 - 0.1 \\mathrm{i}  0.0 + 0.1 \\mathrm{i}\n    \\end{bmatrix}.\n    $$\n  - 块大小: $[1, 2]$。\n- 测试用例 3:\n  - $M \\in \\mathbb{C}^{4 \\times 4}$ 是一个块对角矩阵，有两个大小为 2 的块，\n    $$\n    M = \\mathrm{diag}(A, B), \\quad\n    A = \\begin{bmatrix}\n    0.8 + 0.05 \\mathrm{i}  0.02 - 0.01 \\mathrm{i} \\\\\n    0.01 + 0.0 \\mathrm{i}  0.7 + 0.02 \\mathrm{i}\n    \\end{bmatrix}, \\quad\n    B = \\begin{bmatrix}\n    0.6 + 0.04 \\mathrm{i}  0.03 + 0.0 \\mathrm{i} \\\\\n    0.0 + 0.01 \\mathrm{i}  0.65 + 0.03 \\mathrm{i}\n    \\end{bmatrix}.\n    $$\n  - 块大小: $[2, 2]$。\n\n输出规范：\n- 对于每个测试用例，通过对上述所有允许的块对角正定缩放矩阵 $D$ 进行优化，计算得到的上界值。\n- 将每个上界表示为四舍五入到六位小数的实浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[x1,x2,x3]”），其中 $x_{k}$ 是测试用例 $k$ 的计算上界。", "solution": "该问题陈述经评估是科学严谨、适定、客观且完整的。它描述了鲁棒控制理论中的一个标准问题：结构奇异值 $\\mu$ 的上界计算。所提供的定义、矩阵和目标是一致且充分的，足以进行严格的求解。我们继续进行推导和实现。\n\n对于一个复矩阵 $M \\in \\mathbb{C}^{n \\times n}$，其相对于块对角不确定性结构 $\\Delta$ 的结构奇异值 $\\mu_{\\Delta}(M)$ 定义为：\n$$\n\\mu_{\\Delta}(M) \\triangleq \\frac{1}{\\min \\{ \\|\\Delta\\|_2 \\mid \\Delta \\in \\mathcal{B}_{\\Delta}, \\det(I - M\\Delta) = 0 \\}}\n$$\n如果存在使矩阵 $I - M\\Delta$ 奇异的矩阵 $\\Delta$，否则 $\\mu_{\\Delta}(M) \\triangleq 0$。此处，$\\|\\cdot\\|_2$ 表示谱范数（最大奇异值），$\\mathcal{B}_{\\Delta}$ 是符合指定结构的所有块对角不确定性矩阵的集合。也就是说，如果块的大小为 $n_1, n_2, \\dots, n_b$ 且 $\\sum_{i=1}^{b} n_i = n$，则 $\\Delta = \\mathrm{diag}(\\Delta_1, \\dots, \\Delta_b)$，其中每个 $\\Delta_i \\in \\mathbb{C}^{n_i \\times n_i}$。\n\n条件 $\\det(I - M\\Delta) = 0$ 等价于矩阵 $M\\Delta$ 有一个特征值为 1。这意味着存在一个非零向量 $x \\in \\mathbb{C}^n$ 使得 $M\\Delta x = x$。\n\n我们要使用一组缩放矩阵 $\\mathcal{D}$ 来推导一个上界。这个集合由与不确定性结构对易的块对角正定矩阵组成。如果对于所有 $\\Delta \\in \\mathcal{B}_{\\Delta}$ 都有 $D\\Delta = \\Delta D$，则矩阵 $D$ 与不确定性结构对易。$D \\in \\mathcal{D}$ 的规定形式为：\n$$\nD = \\mathrm{diag}(d_1 I_{n_1}, d_2 I_{n_2}, \\dots, d_b I_{n_b})\n$$\n其中 $d_i \\in \\mathbb{R}$，$d_i  0$（$i = 1, \\dots, b$），$I_{n_i}$ 是大小为 $n_i \\times n_i$ 的单位矩阵。由于 $D$ 和集合中的任何 $\\Delta$ 都具有相同的块对角结构，因此它们对易。\n\n让我们分析一下 $M$ 的奇异性条件与 $M$ 的缩放版本之间的关系。对于任何可逆的 $D \\in \\mathcal{D}$，条件 $\\det(I - M\\Delta) = 0$ 等价于 $\\det(I - DMD^{-1}\\Delta) = 0$。这可以如下证明：\n$$\n\\det(I - M\\Delta) = \\det(D(I - M\\Delta)D^{-1}) = \\det(D I D^{-1} - D M \\Delta D^{-1}) = \\det(I - D M D^{-1} \\Delta)\n$$\n其中最后一步使用了对易性质 $D\\Delta = \\Delta D$。这意味着使矩阵奇异的不确定性 $\\Delta$ 集合对于 $M$ 和相似变换后的矩阵 $DMD^{-1}$ 是相同的。因此，它们的结构奇异值相等：\n$$\n\\mu_{\\Delta}(M) = \\mu_{\\Delta}(DMD^{-1}) \\quad \\forall D \\in \\mathcal{D}\n$$\n\n接下来，我们为任意矩阵 $A$ 建立 $\\mu_{\\Delta}(A)$ 的一个通用上界。如果 $\\det(I - A\\Delta) = 0$，则存在一个向量 $x \\ne 0$ 使得 $A\\Delta x = x$。对两边取谱范数，并应用范数的次乘性，我们得到：\n$$\n\\|x\\|_2 = \\|A\\Delta x\\|_2 \\le \\|A\\|_2 \\|\\Delta x\\|_2 \\le \\|A\\|_2 \\|\\Delta\\|_2 \\|x\\|_2\n$$\n由于 $\\|x\\|_2  0$，我们可以用它来除，得到 $1 \\le \\|A\\|_2 \\|\\Delta\\|_2$，这意味着任何奇异化扰动 $\\Delta$ 都必须满足 $\\|\\Delta\\|_2 \\ge 1/\\|A\\|_2$。因此，这种 $\\Delta$ 的最小范数也必须满足这个不等式：\n$$\n\\min \\{ \\|\\Delta\\|_2 \\mid \\det(I - A\\Delta)=0 \\} \\ge \\frac{1}{\\|A\\|_2}\n$$\n对两边取倒数会反转不等号：\n$$\n\\mu_{\\Delta}(A) = \\left( \\min \\{ \\|\\Delta\\|_2 \\} \\right)^{-1} \\le \\|A\\|_2 = \\sigma_{\\max}(A)\n$$\n其中 $\\sigma_{\\max}(A)$ 是 $A$ 的最大奇异值。\n\n结合这两个结果，我们有 $\\mu_{\\Delta}(M) = \\mu_{\\Delta}(DMD^{-1}) \\le \\sigma_{\\max}(DMD^{-1})$。这个不等式对允许集合 $\\mathcal{D}$ 中的任何 $D$ 都成立。为了从这族上界中找到最紧的上界，我们应该寻求在所有这些 $D$ 上的下确界：\n$$\n\\mu_{\\Delta}(M) \\le \\inf_{D \\in \\mathcal{D}} \\sigma_{\\max}(DMD^{-1})\n$$\n这就是我们要实现的那个可计算的上界。现在的任务是一个优化问题：\n$$\n\\min_{d_1  0, \\dots, d_b  0} f(d_1, \\dots, d_b) = \\sigma_{\\max}\\left( \\mathrm{diag}(d_1 I_{n_1}, \\dots) M \\mathrm{diag}(d_1^{-1} I_{n_1}, \\dots) \\right)\n$$\n正性约束 $d_i  0$ 使其成为一个有约束的优化问题。如题中所建议，我们可以通过变量替换将其转换为一个无约束问题。令 $d_i = e^{\\alpha_i}$，其中 $\\alpha_i \\in \\mathbb{R}$。现在的优化变量是 $\\alpha_1, \\dots, \\alpha_b$，并且 $d_i$ 的正性得到了内在的满足。目标函数变为：\n$$\ng(\\alpha_1, \\dots, \\alpha_b) = \\sigma_{\\max}(D(\\alpha) M D(\\alpha)^{-1})\n$$\n其中 $D(\\alpha) = \\mathrm{diag}(e^{\\alpha_1} I_{n_1}, \\dots, e^{\\alpha_b} I_{n_b})$。问题在于找到 $\\min_{\\alpha \\in \\mathbb{R}^b} g(\\alpha)$。注意，将所有 $d_i$ 乘以一个共同的正常数因子 $c$ 不会改变 $DMD^{-1}$ 的值，因为 $c D M (c D)^{-1} = c D M c^{-1} D^{-1} = DMD^{-1}$。这意味着目标函数在 $\\alpha$ 空间中沿着方向 $[1, 1, \\dots, 1]^T$ 是常数。该优化问题是凸的，这确保了任何局部最小值也是全局最小值。\n\n为了数值求解，我们采用一种拟牛顿优化算法，具体是由 `scipy.optimize.minimize` 函数提供的 L-BFGS-B 算法。该方法适用于无约束或箱约束问题，并且对光滑目标函数是高效的。虽然最大奇异值函数并非处处可微（特别是在奇异值重复时），但它几乎处處可微，并且标准的基于梯度的优化算法在实践中表现良好。我们从初始猜测 $\\alpha = [0, 0, \\dots, 0]^T$ 开始优化，这对应于所有 $i$ 的 $d_i=1$，即 $D=I$。因此，目标函数的初始值为 $\\sigma_{\\max}(M)$。\n\n数值步骤如下：\n1.  对于给定的矩阵 $M$ 和块大小列表 $\\{n_1, \\dots, n_b\\}$，定义一个以向量 $\\alpha \\in \\mathbb{R}^b$ 为输入的目标函数。\n2.  在此函数内部，通过将与块 $i$ 对应的对角线元素设置为 $e^{\\alpha_i}$ 来从 $\\alpha$ 构建对角矩阵 $D$。构建其逆矩阵 $D^{-1}$，其对角线元素为 $e^{-\\alpha_i}$。\n3.  计算缩放后的矩阵 $M' = D M D^{-1}$。\n4.  使用标准的奇异值分解（SVD）算法计算 $M'$ 的谱范数，即其最大奇异值。该值是函数的输出。\n5.  使用此目标函数、初始猜测值 $\\alpha_0 = 0 \\in \\mathbb{R}^b$ 和 L-BFGS-B 方法调用 `scipy.optimize.minimize`。\n6.  优化器返回的最小值即为 $\\mu_{\\Delta}(M)$ 的计算上界。对每个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Computes the D-scaling upper bound for the structured singular value (mu)\n    for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"M\": np.array([\n                [0.2 + 0.1j, 2.0 - 0.3j],\n                [0.0 + 0.5j, 0.1 - 0.2j]\n            ]),\n            \"block_sizes\": [1, 1]\n        },\n        {\n            \"M\": np.array([\n                [0.05 + 0.0j, 1.0 - 0.1j, 0.2 - 0.1j],\n                [0.0 + 0.1j, 0.3 + 0.0j, 2.0 + 0.2j],\n                [0.0 + 0.0j, 0.5 - 0.1j, 0.0 + 0.1j]\n            ]),\n            \"block_sizes\": [1, 2]\n        },\n        {\n            \"M\": np.block([\n                [np.array([[0.8 + 0.05j, 0.02 - 0.01j],\n                           [0.01 + 0.0j, 0.7 + 0.02j]]), np.zeros((2, 2), dtype=np.complex128)],\n                [np.zeros((2, 2), dtype=np.complex128), np.array([[0.6 + 0.04j, 0.03 + 0.0j],\n                                                                 [0.0 + 0.01j, 0.65 + 0.03j]])]\n            ]),\n            \"block_sizes\": [2, 2]\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M = case[\"M\"]\n        block_sizes = case[\"block_sizes\"]\n        num_blocks = len(block_sizes)\n\n        # Create a mapping from row/column index to block index\n        block_indices = []\n        for i, size in enumerate(block_sizes):\n            block_indices.extend([i] * size)\n\n        def objective_function(alpha):\n            \"\"\"\n            Objective function to minimize: sigma_max(D * M * D^-1).\n            alpha is a vector of logarithms of the scaling factors.\n            \"\"\"\n            # Construct the scaling matrix D and its inverse D_inv\n            # d_i = exp(alpha_i)\n            d_vals = np.exp(alpha)\n            \n            # The problem can be parameterized by b-1 variables, but using b variables\n            # is general and the optimizer handles the redundant degree of freedom.\n            d_vec = np.array([d_vals[block_indices[i]] for i in range(M.shape[0])])\n            \n            # Efficiently compute D * M * D^-1 for diagonal D\n            # (DMD^-1)_ij = d_i/d_j * M_ij\n            D_M_D_inv = M * (d_vec[:, np.newaxis] / d_vec)\n\n            # Compute the largest singular value (spectral norm)\n            # We don't need the singular vectors, so compute_uv=False for efficiency\n            s = np.linalg.svd(D_M_D_inv, compute_uv=False)\n            \n            return s[0]\n\n        # Initial guess for alpha is all zeros, which corresponds to D = I\n        alpha0 = np.zeros(num_blocks)\n\n        # Perform the optimization\n        # L-BFGS-B is a robust and efficient quasi-Newton method\n        # for unconstrained or box-constrained problems.\n        opt_result = minimize(\n            objective_function,\n            alpha0,\n            method='L-BFGS-B',\n            options={'disp': False}\n        )\n\n        # The minimum value found is the upper bound\n        mu_upper_bound = opt_result.fun\n        results.append(round(mu_upper_bound, 6))\n\n    # Format the final output according to the problem specification\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2901532"}]}