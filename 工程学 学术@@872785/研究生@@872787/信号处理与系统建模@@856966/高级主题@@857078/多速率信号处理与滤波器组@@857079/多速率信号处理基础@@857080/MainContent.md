## 引言
[多速率信号处理](@entry_id:196803)是现代[数字信号处理](@entry_id:263660)的一个基石，它研究的是在系统中处理具有不同采样率信号的理论与技术。从高清音频的格式转换到蜂窝通信的信道化，再到图像的压缩与分析，高效地改变和操纵[信号采样](@entry_id:261929)率的能力至关重要。然而，直接改变[采样率](@entry_id:264884)的操作不仅会引入混叠、镜像等[信号失真](@entry_id:269932)，其直接实现方式在计算上也常常是低效甚至是不可行的。本文旨在系统性地解决这些挑战，为读者构建一个从基本原理到高级应用的完整知识框架。

在接下来的内容中，您将通过三个章节的學習，全面掌握[多速率信号处理](@entry_id:196803)：

- **第一章：原理与机制**，将深入剖析[多速率系统](@entry_id:264982)的核心构件——抽取与内插，揭示其时频特性。我们将引入强大的多相表示，以构建计算高效的系统，并探索[多速率系统](@entry_id:264982)与线性周期时变（LPTV）系统的深刻联系，最终应用于[滤波器组](@entry_id:266441)与[完美重构](@entry_id:194472)（Perfect Reconstruction）理论。

- **第二章：应用与跨学科联系**，将理论付诸实践，展示多速率技术如何在数字[采样率转换](@entry_id:274165)（SRC）、无乘法器的[CIC滤波器](@entry_id:183246)、异步[采样率转换](@entry_id:274165)（ASRC）以及数字通信和[离散小波变换](@entry_id:197315)等领域发挥关键作用。

- **第三章：动手实践**，提供了一系列精心设计的练习，旨在通过具体的计算和设计问题，加深您对混叠、镜像、[滤波器设计](@entry_id:266363)权衡以及实际系统实现等核心概念的理解。

让我们从[多速率信号处理](@entry_id:196803)最基本的原理与机制开始。

## 原理与机制

在上一章介绍[多速率信号处理](@entry_id:196803)的背景与应用之后，本章将深入探讨其核心原理与基本机制。我们将从最基本的[采样率](@entry_id:264884)变换操作入手，分析其在时域和[频域](@entry_id:160070)中的行为特性，并由此引出为实现计算效率而设计的**多相表示（polyphase representation）**。进一步地，我们将建立[多速率系统](@entry_id:264982)与**线性周期时变（Linear Periodically Time-Varying, LPTV）**系统之间的深刻联系。最后，我们将所有这些概念应用于分析与综合滤波器组的设计，特别是实现**[完美重构](@entry_id:194472)（perfect reconstruction）**的关键条件。

### 核心多速率操作：抽取与内插

[多速率信号处理](@entry_id:196803)的基石是两种基本操作：**抽取（decimation）**（降低[采样率](@entry_id:264884)）和**内插（interpolation）**（提高[采样率](@entry_id:264884)）。这两种操作的核心分别是理想的**抽取器（downsampler）**和**内插器（upsampler）**。

#### 时域定义与基本性质

一个以整数因子 $M \ge 2$ 进行的理想抽取器，其输入-输出关系定义为：
$$
y[n] = x[Mn]
$$
该操作保留了输入序列 $x[n]$ 中每 $M$ 个样本中的一个，并丢弃其余的 $M-1$ 个样本，从而使信号的采样率降低为原来的 $1/M$。

相对地，一个以整数因子 $L \ge 2$ 进行的理想内插器（或称零值插入器），其输入-输出关系定义为：
$$
v[n] = \begin{cases} x[n/L], & n \text{ 是 } L \text{ 的整数倍} \\ 0, & \text{其它} \end{cases}
$$
该操作在输入序列 $x[n]$ 的每两个连续样本之间插入 $L-1$ 个零值样本，从而使信号的采样率提升为原来的 $L$ 倍。

尽管这些操作看起来很简单，但它们与我们熟悉的**线性时不变（Linear Time-Invariant, LTI）**系统有着本质的区别。我们可以通过考察它们的线性和[时不变性](@entry_id:198838)来验证这一点 [@problem_id:2874153]。

**线性（Linearity）**：抽取器和内插器都是线性操作。例如，对于抽取器，若输入为 $a x_1[n] + b x_2[n]$，则输出为 $a x_1[Mn] + b x_2[Mn]$，这恰好是分别处理 $x_1[n]$ 和 $x_2[n]$ 后再进行[线性组合](@entry_id:154743)的结果。内插器也同样满足[叠加原理](@entry_id:144649)。

**[时不变性](@entry_id:198838)（Time-Invariance）**：一个系统是时不变的，当且仅当它与任意时间的[移位](@entry_id:145848)操作 $S_k$（定义为 $(S_k x)[n] = x[n-k]$）是可交换的。然而，抽取器和内插器都不满足这个条件。

-   对于抽取器 $D_M$，先[移位](@entry_id:145848)再抽取得到 $(D_M S_k x)[n] = x[Mn - k]$。而先抽取再[移位](@entry_id:145848)得到 $(S_k D_M x)[n] = x[M(n-k)] = x[Mn - Mk]$。显然，当 $k \neq Mk$ 时（即 $k \neq 0, M \ge 2$），$x[Mn - k] \neq x[Mn - Mk]$，因此抽取器是**时变（time-variant）**的。

-   对于内插器 $U_L$，类似的分析也会表明，对输入信号的[移位](@entry_id:145848)并不能等效为对输出信号的同样[移位](@entry_id:145848)。例如，将 $x[n]$ 移位一个样本，内插后零值的位置会发生改变，这与直接移位内插后的输出是不同的。因此，内插器也是**时变**的。

由于抽取器和内插器都不是时不变的，它们不属于[LTI系统](@entry_id:271946)。这意味着它们不能用一个固定的冲激响应 $h[n]$ 通过卷积来描述。它们是**线性时变（Linear Time-Variant, LTV）**系统的最简单示例。尽管它们不完全满足[时不变性](@entry_id:198838)，但其时变行为是有规律的，这与[移位](@entry_id:145848)操作之间存在着特殊的[交换关系](@entry_id:136780) [@problem_id:28741semantically_similar_to_2874153]。例如，可以证明 $S_{Lk} U_L = U_L S_k$，这表明将输入信号[移位](@entry_id:145848) $k$ 个样本，再进行 $L$ 倍内插，其效果等同于先内插再将输出信号[移位](@entry_id:145848) $Lk$ 个样本。

#### [频域](@entry_id:160070)效应：镜像与[混叠](@entry_id:146322)

抽取和内插操作在时域中的采样点丢弃与插入，会在[频域](@entry_id:160070)中产生深刻而独特的后果，即**镜像（imaging）**和**混叠（aliasing）**。我们可以通过推导其输出信号的[离散时间傅里叶变换](@entry_id:196741)（DTFT）来精确描述这些现象 [@problem_id:2874157]。

令输入信号 $x[n]$ 的DTFT为 $X(e^{j\omega})$。

**内插的[频域](@entry_id:160070)效应：镜像**

对于内插器，其输出 $v[n]$ 的DTFT为：
$$
V(e^{j\omega}) = \sum_{n=-\infty}^{\infty} v[n] e^{-j\omega n}
$$
由于 $v[n]$仅在 $n$ 是 $L$ 的倍数时非零，我们可以令 $n=mL$：
$$
V(e^{j\omega}) = \sum_{m=-\infty}^{\infty} v[mL] e^{-j\omega(mL)} = \sum_{m=-\infty}^{\infty} x[m] e^{-j(\omega L) m}
$$
通过与 $X(e^{j\omega})$ 的定义式 $\sum_{n} x[n] e^{-j\omega n}$ 对比，我们立即得到：
$$
V(e^{j\omega}) = X(e^{j\omega L})
$$
这个简洁的公式揭示了内插的[频域](@entry_id:160070)本质：原始[频谱](@entry_id:265125) $X(e^{j\omega})$ 在频率轴上被**压缩**了 $L$ 倍。由于DTFT是以 $2\pi$ 为周期的，原始[频谱](@entry_id:265125)在 $[-\pi, \pi)$ 区间的内容被压缩到 $[-\pi/L, \pi/L)$ 区间。同时，由于压缩后的[频谱](@entry_id:265125)周期变为 $2\pi/L$，在 $[-\pi, \pi)$ 内会出现 $L-1$ 个额外的、未经相加的[频谱](@entry_id:265125)副本。这些副本被称为**镜像（images）**。为了得到一个真正[采样率](@entry_id:264884)提高的平滑信号，必须使用一个**内插滤波器（interpolation filter）**（通常是低通滤波器）来滤除这些镜像。

**抽取的[频域](@entry_id:160070)效应：混叠**

对于抽取器，其输出 $y[n]=x[Mn]$ 的DTFT推导稍微复杂，但其结果同样具有启发性：
$$
Y(e^{j\omega}) = \frac{1}{M} \sum_{k=0}^{M-1} X\left(e^{j\frac{\omega - 2\pi k}{M}}\right)
$$
这个公式表明，抽取操作在[频域](@entry_id:160070)中包含两个步骤：
1.  **频率扩展**：原始[频谱](@entry_id:265125) $X(e^{j\omega})$ 的频率轴被**扩展**（或拉伸）了 $M$ 倍（由因子 $\omega/M$ 体现）。
2.  **叠加**：$M$ 个经过扩展和[移位](@entry_id:145848)的[频谱](@entry_id:265125)副本（由 $k=0, \dots, M-1$ 索引）被叠加在一起。

如果原始信号 $x[n]$ 的[频谱](@entry_id:265125)没有被严格限制在 $[-\pi/M, \pi/M)$ 频带内，那么在频率扩展后，这些[移位](@entry_id:145848)的[频谱](@entry_id:265125)副本将会相互重叠。这种重叠导致的[频谱](@entry_id:265125)失真被称为**混叠（aliasing）**。一旦发生混叠，原始信号的[频谱](@entry_id:265125)信息将无法恢复。因此，在进行抽取操作之前，通常必须使用一个**[抗混叠滤波器](@entry_id:636666)（anti-aliasing filter）**（通常是低通滤波器）来预先限制信号的带宽，以满足[Nyquist采样定理](@entry_id:268107)的推广形式。

### 高效结构：多相表示

直接实现一个包含滤波和采样率变换的系统（例如，先滤波再抽取）是[计算效率](@entry_id:270255)低下的。例如，在抽取系统中，滤波器会计算出所有中间样本，但其中大部分随后会被抽取器丢弃。**多相表示（polyphase representation）**是一种强大的代数工具，它允许我们重排运算顺序，从而避免不必要的计算。

#### [多相分解](@entry_id:269253)

一个滤波器 $H(z)$ 的[多相分解](@entry_id:269253)是将其冲激响应 $h[n]$ 分解为 $M$ 个[子序列](@entry_id:147702)，然后将这些[子序列](@entry_id:147702)表示为 $M$ 个**多相分量（polyphase components）**滤波器。对于**1型（Type-1）**[多相分解](@entry_id:269253)，我们定义第 $k$ 个[子序列](@entry_id:147702) $e_k[n]$ 为：
$$
e_k[n] = h[nM+k], \quad k = 0, 1, \dots, M-1
$$
其对应的z变换为 $E_k(z) = \sum_n e_k[n] z^{-n}$。原始滤波器 $H(z)$ 可以通过这些分量重构：
$$
H(z) = \sum_{k=0}^{M-1} z^{-k} E_k(z^M)
$$
这个恒等式是多相理论的基石。为了具体理解这个分解过程，我们可以考察一个12阶[FIR滤波器](@entry_id:262292)，并将其分解为 $M=3$ 的多相分量 [@problem_id:2874131]。

假设滤波器为：
$$
H(z) = 3 - z^{-1} + 4z^{-2} + 2z^{-4} - 2z^{-5} + z^{-6} + 5z^{-7} - 3z^{-8} + 7z^{-9} - z^{-11}
$$
其系数序列 $h[n]$ 为 $\{3, -1, 4, 0, 2, -2, 1, 5, -3, 7, 0, -1\}$。

-   $k=0$ 的分量由 $h[0], h[3], h[6], h[9]$ 构成，即 $\{3, 0, 1, 7\}$。因此 $E_0(z) = 3 + z^{-2} + 7z^{-3}$。
-   $k=1$ 的分量由 $h[1], h[4], h[7], h[10]$ 构成，即 $\{-1, 2, 5, 0\}$。因此 $E_1(z) = -1 + 2z^{-1} + 5z^{-2}$。
-   $k=2$ 的分量由 $h[2], h[5], h[8], h[11]$ 构成，即 $\{4, -2, -3, -1\}$。因此 $E_2(z) = 4 - 2z^{-1} - 3z^{-2} - z^{-3}$。

读者可以自行验证，通过 $H(z) = E_0(z^3) + z^{-1}E_1(z^3) + z^{-2}E_2(z^3)$ 可以精确地重构出原始的 $H(z)$。

#### 多相抽取器

利用[多相分解](@entry_id:269253)，我们可以推导出一个高效的抽取器结构。一个标准的抽取器由一个[抗混叠滤波器](@entry_id:636666) $H(z)$ 和一个 $M$ 倍抽取器组成。其输出 $y[n]$ 为：
$$
y[n] = w[nM] = \sum_{l=-\infty}^{\infty} h[l] x[nM-l]
$$
通过将求和索引 $l$ 分解为 $l=qM+k$ 并代入 $h[l]$ 的多相分量，我们可以推导出如下表达式 [@problem_id:2874197]：
$$
y[n] = \sum_{k=0}^{M-1} \sum_{m=-\infty}^{\infty} e_k[n-m] x[Mm - k]
$$
这个公式揭示了一个高效的实现结构：输入信号 $x[n]$ 首先经过一系列延时（$z^{-k}$）和 $M$ 倍抽取，生成 $M$ 个多相信号流 $x[Mm-k]$。然后，每个信号流被对应的多相滤波器 $e_k[n]$ 进行滤波。最后，所有滤波器的输出相加得到最终的低速率输出 $y[n]$。在这种结构中，所有的滤波操作都发生在**低采样率**下，从而极大地节省了计算量。

#### 多相内插器

与抽取器对偶的是内插器。一个标准的内插器由一个 $L$ 倍内插器和一个[抗镜像滤波器](@entry_id:273602) $H(z)$ 组成。其输出为：
$$
y[n] = \sum_{p=-\infty}^{\infty} h[n-pL] x[p]
$$
为了推导其高效结构，我们将输出 $y[n]$ 分解为 $L$ 个多相分量 $y_k[q] = y[qL+k]$。通过代数变换，可以证明 [@problem_id:2874175]：
$$
y_k[q] = y[qL+k] = \sum_{p=-\infty}^{\infty} r_k[q-p] x[p] = (r_k * x)[q]
$$
这里，$r_k[n] = h[nL+k]$ 是滤波器 $H(z)$ 的**2型（Type-2）**多相分量。这个结果表明，输入信号 $x[n]$ 可以直接送入一个由 $L$ 个多相滤波器 $R_k(z)$ 组成的滤波器组中。所有滤波操作都在**低采样率**下完成。然后，一个**换向器（commutator）**将这 $L$ 个并行输出流交错地组合起来，形成最终的高速率输出信号 $y[n]$。这种结构同样将计算密集型的滤波操作移到了低速率端，实现了效率的提升。

在z域中，这种结构可以简洁地表示为 [@problem_id:287semantically_similar_to_2874175]：
$$
Y(z) = X(z^L) \left( \sum_{k=0}^{L-1} z^{-k} R_k(z^L) \right)
$$
其中 $R_k(z)$ 是 $r_k[n]$ 的z变换。

### [多速率系统](@entry_id:264982)作为[LPTV系统](@entry_id:185385)

我们已经看到，抽取器和内插器是[时变系统](@entry_id:175653)。当它们与[LTI滤波器](@entry_id:271149)级联时，整个系统就成为一个**线性周期时变（Linear Periodically Time-Varying, LPTV）**系统。[LPTV系统](@entry_id:185385)的输入-输出关系由一个时变的冲激响应 $h[n,k]$ 描述：
$$
y[n] = \sum_{k=-\infty}^{\infty} h[n,k] x[k]
$$
[LPTV系统](@entry_id:185385)的关键特性是其冲激响应具有周期性。例如，可以证明，一个内插因子为 $L$ 的内插器后接一个冲激响应为 $g[n]$ 的[LTI滤波器](@entry_id:271149)，其等效的冲激响应为 $h[n,k] = g[n-kL]$。这个响应满足周期性关系 $h[n+L, k+1] = h[n,k]$ [@problem_id:2874174]。

一个更具一般性的[LPTV系统](@entry_id:185385)定义是冲激响应满足 $h[n+M, k+M] = h[n,k]$。可以证明，任何满足此条件的 $M$-周期[LPTV系统](@entry_id:185385)，都等价于一个作用于信号多相分量上的 $M \times M$ **多输入多输出（MIMO）** [LTI系统](@entry_id:271946) [@problem_id:2874162]。具体来说，若将输入 $x[n]$ 和输出 $y[n]$ 分别分解为多相分量 $x_s[\ell]$ 和 $y_r[\ell]$，则它们之间的关系可以表示为：
$$
y_r[\ell] = \sum_{s=0}^{M-1} (e_{r,s} * x_s)[\ell] = \sum_{s=0}^{M-1} \sum_{m=-\infty}^{\infty} e_{r,s}[m] x_s[\ell-m]
$$
其中 $e_{r,s}[m]$ 是 $M^2$ 个[LTI滤波器](@entry_id:271149)的冲激响应，它们完全由原始的 $h[n,k]$ 决定。这个深刻的等价关系是多相理论的理论基础：它表明，任何LPTV操作都可以通过将信号分解到多相域，然后在其上执行LTI操作来完成。这正是多相抽取器和内插器高效实现的核心思想。

### 分析-综合[滤波器组](@entry_id:266441)

[多速率系统](@entry_id:264982)的最重要的应用之一是**分析-综合滤波器组（analysis-synthesis filter banks）**。一个 $M$ 通道[滤波器组](@entry_id:266441)将一个[信号分解](@entry_id:145846)为 $M$ 个子带信号，在[子带](@entry_id:154462)中进行处理（例如编码、降噪），然后再将它们合成为一个输出信号。

#### 二通道滤波器组与[完美重构](@entry_id:194472)

我们以一个二通道（$M=2$）滤波器组为例来阐述其基本原理。分析端由两个滤波器 $H_0(z)$（低通）和 $H_1(z)$（高通）组成，其后各接一个2倍抽取器。综合端则由两个2倍内插器和两个综合滤波器 $G_0(z)$、$G_1(z)$ 组成。

通过在z域中追踪信号，可以推导出整个系统的输入-输出关系 [@problem_id:2874141]：
$$
Y(z) = \frac{1}{2} [H_0(z)G_0(z) + H_1(z)G_1(z)] X(z) + \frac{1}{2} [H_0(-z)G_0(z) + H_1(-z)G_1(z)] X(-z)
$$
这个表达式由两部分组成：第一项是信号的线性失真，由**失真[传递函数](@entry_id:273897)** $T(z) = \frac{1}{2} [H_0(z)G_0(z) + H_1(z)G_1(z)]$ 描述；第二项是由抽取引入的**[混叠](@entry_id:146322)**，由**[混叠](@entry_id:146322)[传递函数](@entry_id:273897)** $A(z) = \frac{1}{2} [H_0(-z)G_0(z) + H_1(-z)G_1(z)]$ 描述。

为了实现**[完美重构](@entry_id:194472)（perfect reconstruction, PR）**，即输出信号与输入信号仅相差一个增益和一个延时（$y[n] = c \cdot x[n-k]$），我们必须同时满足以下两个条件：
1.  **消除[混叠](@entry_id:146322)**：$A(z) = 0 \implies H_0(-z)G_0(z) + H_1(-z)G_1(z) = 0$
2.  **校正失真**：$T(z) = c z^{-k} \implies H_0(z)G_0(z) + H_1(z)G_1(z) = 2c z^{-k}$

这两个条件构成了设计PR[滤波器组](@entry_id:266441)的基础。例如，给定分析滤波器 $H_0(z) = 1+z^{-1}$ 和 $H_1(z) = 1-z^{-1}$，我们可以通过求解上述[方程组](@entry_id:193238)来确定实现PR的综合滤波器 $G_0(z)$ 和 $G_1(z)$。一个可能的解是 $G_0(z) = \frac{1}{2}(1+z^{-1})$ 和 $G_1(z) = \frac{1}{2}(-1+z^{-1})$，这可以实现 $c=1, k=1$ 的[完美重构](@entry_id:194472) [@problem_id:2874semantically_similar_to_2874141]。

#### PR的多相域视角

PR条件可以用[多相矩阵](@entry_id:201228)更优雅地表达。将分析滤波器 $H_k(z)$ 和综合滤波器 $G_k(z)$ 分别表示为它们的 $2 \times 2$ [多相矩阵](@entry_id:201228) $E(z)$ 和 $R(z)$。那么，整个[滤波器组](@entry_id:266441)的PR条件等价于：
$$
R(z) E(z) = c z^{-d} I
$$
其中 $I$ 是单位矩阵。这个条件意味着，综合[多相矩阵](@entry_id:201228) $R(z)$ 必须是分析[多相矩阵](@entry_id:201228) $E(z)$ 的（标度化的）逆。
$$
R(z) = c z^{-d} E^{-1}(z) = c z^{-d} \frac{\text{adj}(E(z))}{\det(E(z))}
$$
这个公式揭示了 $\det(E(z))$ 的关键作用 [@problem_id:2874195]。
-   **FIR PR的条件**：为了使综合滤波器成为[FIR滤波器](@entry_id:262292)（这在实践中通常是期望的），$R(z)$ 的所有元素必须是 $z^{-1}$ 的多项式。这要求 $E^{-1}(z)$ 的所有元素都是多项式，这又进一步要求 $\det(E(z))$ 必须是一个简单的单项式，即 $\det(E(z)) = \alpha z^{-\delta}$，其中 $\alpha \neq 0$。如果 $\det(E(z))$ 是一个更复杂的多项式，则无法实现FIR[完美重构](@entry_id:194472)。

-   **IIR PR的稳定性**：如果无法实现FIR PR，我们可能可以实现IIR PR。此时，$R(z)$ 的分母为 $\det(E(z))$，这意味着 $\det(E(z))$ 的零点将成为综合滤波器的极点。根据[稳定性理论](@entry_id:149957)，为了使综合滤波器是BIBO（有界输入有界输出）稳定的，其所有极点必须严格位于[单位圆](@entry_id:267290)内部。因此，如果 $\det(E(z))$ 在单位圆上或[单位圆](@entry_id:267290)外有任何零点，那么对应的IIR PR系统将是不稳定的。

例如，对于一个分析滤波器组，若其多相[矩阵的[行列](@entry_id:148198)式](@entry_id:142978)为 $\det(E(z)) = -2(1+z^{-1})^2$，则它在 $z=-1$ 处有一个二阶零点。这个零点位于单位圆上。因此，该滤波器组不仅无法实现FIR PR，而且任何试[图实现](@entry_id:270634)IIR PR的综合[滤波器组](@entry_id:266441)都将是**不稳定**的。

#### DFT滤波器组

对于多于两个通道的[滤波器组](@entry_id:266441)，一个重要且高效的结构是**DFT[滤波器组](@entry_id:266441)**。在这种结构中，M个分析滤波器 $H_k(z)$ 是通过对一个原型低通滤波器 $P(z)$ 进行复调制得到的 [@problem_id:2874136]：
$$
H_k(z) = P(z W_M^{-k}), \quad k=0, 1, \dots, M-1
$$
其中 $W_M = e^{-j2\pi/M}$。这种调制将原型滤波器的频率响应[移位](@entry_id:145848)到不同的中心频率，从而覆盖整个[频谱](@entry_id:265125)。这种结构的分析端可以用高效的[FFT算法](@entry_id:146326)实现。

为了实现重构，综合滤波器 $G_k(z)$ 通常选择与分析滤波器共轭的调制方向：
$$
G_k(z) = P(z W_M^k), \quad k=0, 1, \dots, M-1
$$
综合端可以用I[FFT算法](@entry_id:146326)实现。这种结构的PR条件最终归结为对原型滤波器 $P(z)$ 及其多相分量的约束。如果原型滤波器被恰当设计（例如，使其[多相矩阵](@entry_id:201228)成为**酉矩阵（paraunitary matrix）**），整个系统就可以实现[完美重构](@entry_id:194472)。

本章我们从多速率处理的基本操作出发，系统地建立了其时[频域](@entry_id:160070)特性、高效实现结构以及与[LPTV系统](@entry_id:185385)的联系，并最终将这些原理应用于现代[滤波器组](@entry_id:266441)的设计与分析中。这些基础构成了下一章将要讨论的更高级主题，如小波变换和高级滤波器组设计的基础。