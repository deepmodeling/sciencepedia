{"hands_on_practices": [{"introduction": "掌握多速率理论的关键在于理解其在计算效率上的优势。本练习旨在通过直接比较两种实现方式来量化多相分解的效用：直接型 FIR 抽取器和其等效的多相结构。通过为一种特殊的半带滤波器计算每单位输出样本所需的乘法次数，您将亲身体会到为何多相结构是高效多速率系统设计的基石 ([@problem_id:2867572])。", "problem": "考虑一个由因子 $2$ 实现的抽取器，其使用长度为 $N=4R+1$（其中 $R \\geq 1$ 为整数）的奇数长度、线性相位半带有限冲激响应 (FIR) 低通滤波器 $h[n]$。该滤波器满足 $h[n]=h[N-1-n]$（偶对称性）以及半带特性，即除了中心抽头外，每隔一个系数就为零：对于所有奇数 $n$，$h[n]=0$，并且 $h[(N-1)/2]=\\tfrac{1}{2}$。设输入为 $x[n]$，抽取后的输出为 $y[m]$。\n\n要求您确定在以下两种实现策略下，每个输出样本所需的非零系数实数乘法运算的确切次数，这两种策略都利用了系数对称性并跳过了值为零的抽头：\n- 直接形式“先滤波后抽取”：使用对称 FIR 结构计算全速率卷积 $y_{\\text{full}}[n]=\\sum_{k=0}^{N-1} h[k]\\,x[n-k]$，然后保留每隔一个的样本 $y[m]=y_{\\text{full}}[2m]$。\n- 双分支多相二倍抽取器：将 $h[n]$ 写为，对于偶数 $n$，$h[n]=e_{0}[n/2]$；对于奇数 $n$，$h[n]=e_{1}[(n-1)/2]$。仅在低速率下计算 $y[m]=\\sum_{k} e_{0}[k]\\,x[2m-2k]+\\sum_{k} e_{1}[k]\\,x[2m-1-2k]$，并利用非零多相分支内的对称性。\n\n在两种策略中，精确计算每个非零系数的乘法一次，包括与中心抽头 $h[(N-1)/2]=\\tfrac{1}{2}$ 的乘法。不要计算与零系数的乘法。将您的答案表示为关于 $N$ 的封闭形式符号表达式。\n\n将最终答案以行向量的形式给出，其第一个条目是直接形式的计数，第二个条目是多相形式的计数。不需要单位。答案必须是单一的解析表达式。不需要四舍五入。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 抽取因子：$M=2$。\n- 滤波器类型：线性相位半带有限冲激响应 (FIR) 低通滤波器，$h[n]$。\n- 滤波器长度：$N=4R+1$，其中 $R$ 为整数且 $R \\geq 1$。\n- 滤波器对称性：$h[n]=h[N-1-n]$（类型 1，偶对称）。\n- 半带特性：对于所有奇数索引 $n$，$h[n]=0$。\n- 中心抽头值：$h[(N-1)/2] = \\frac{1}{2}$。\n- 输入信号：$x[n]$。\n- 输出信号：$y[m]$。\n- 策略 1（直接形式）：使用对称 FIR 结构计算 $y_{\\text{full}}[n]=\\sum_{k=0}^{N-1} h[k]\\,x[n-k]$，然后通过 $y[m]=y_{\\text{full}}[2m]$ 进行抽取。\n- 策略 2（多相）：将 $h[n]$ 分解为多相分量 $e_0[n]$ 和 $e_1[n]$，并利用对称性计算 $y[m]=\\sum_{k} e_{0}[k]\\,x[2m-2k]+\\sum_{k} e_{1}[k]\\,x[2m-1-2k]$。\n- 成本度量：每个输出样本 $y[m]$ 所需的非零系数实数乘法次数。不计算与 $0$ 的乘法。与 $\\frac{1}{2}$ 的乘法被计算在内。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了针对一类特定的 FIR 滤波器（线性相位半带滤波器）的标准多速率信号处理结构（直接形式和多相抽取器）的分析。所有概念都是数字信号处理的基础。该问题在科学上是合理的。\n- **良态问题**：该问题是良态的。它提供了所有必要的信息，并定义了两种不同的标准实现策略。目标是计算一个特定的、定义明确的复杂度度量（每个输出样本的乘法次数）。存在唯一解，并由所给约束条件确定。\n- **客观性**：该问题使用精确、客观和标准的技术术语进行陈述。它没有歧义和主观论断。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它具有科学依据、是良态的并且是客观的。可以推导出严谨的解。\n\n### 解题推导\n\n首先，我们分析滤波器 $h[n]$ 的性质。\n滤波器长度为 $N=4R+1$，其中 $R \\geq 1$ 是一个整数。这是一个奇数。滤波器具有偶对称性，$h[n]=h[N-1-n]$，这使其成为类型 1 的线性相位 FIR 滤波器。对称中心位于索引 $n_c = \\frac{N-1}{2} = \\frac{(4R+1)-1}{2} = 2R$。\n\n半带特性指出，对于所有奇数 $n$，$h[n]=0$。因此，唯一的非零系数位于偶数索引 $n \\in \\{0, 2, \\dots, 4R\\}$ 处。可能非零的系数总数为 $2R+1$。\n中心抽头是 $h[2R] = \\frac{1}{2}$。\n由于对称性，$h[2k] = h[N-1-2k] = h[4R-2k]$，对于 $k \\in \\{0, 1, \\dots, 2R\\}$。\n需要乘法的唯一非零系数值由 $k \\in \\{0, 1, \\dots, R-1\\}$ 的 $h[2k]$ 和中心抽头 $h[2R]$ 表示。这总共给出了 $R+1$ 个需要相乘的唯一系数值。注意，从 $N=4R+1$ 可得 $R = \\frac{N-1}{4}$。\n唯一的非零系数值的数量是 $R+1 = \\frac{N-1}{4}+1 = \\frac{N+3}{4}$。\n\n#### 策略 1：直接形式“先滤波后抽取”\n\n在此策略中，滤波操作在高的输入采样率下执行，然后输出被以 $M=2$ 的因子降采样。卷积为 $y_{\\text{full}}[n] = \\sum_{k=0}^{N-1} h[k]x[n-k]$。\n\n为了计算一个 $y_{\\text{full}}[n]$ 的样本，我们利用滤波器的性质。求和只需在偶数索引处的 $2R+1$ 个非零系数上进行。此外，利用对称性允许我们在乘法之前预先相加输入样本。\n一个输出样本 $y_{\\text{full}}[n]$ 的计算如下：\n$$y_{\\text{full}}[n] = h[2R]x[n-2R] + \\sum_{k=0}^{R-1} h[2k] \\left( x[n-2k] + x[n-(4R-2k)] \\right)$$\n这需要 1 次乘法用于中心抽头，R 次乘法用于对称对。计算一个样本 $y_{\\text{full}}[n]$ 的总乘法次数是 $C_{H} = R+1$。\n\n问题要求的是每个最终输出样本 $y[m]$ 的乘法次数。为了获得序列 $y[m] = y_{\\text{full}}[2m]$，我们概念上是计算整个序列 $y_{\\text{full}}[n]$ 并丢弃奇数索引的样本。对于每个保留的样本 $y[m]$，一个样本 $y_{\\text{full}}[2m-1]$ 被计算然后丢弃。因此，产生一个输出样本 $y[m]$ 所需的总计算工作量是计算两个高速率样本 $y_{\\text{full}}[2m-1]$ 和 $y_{\\text{full}}[2m]$ 所需的工作量。\n\n因此，每个最终输出样本的乘法次数是 $2 \\times C_{H}$。\n$$ C_1 = 2(R+1) = 2\\left(\\frac{N-1}{4}+1\\right) = 2\\left(\\frac{N+3}{4}\\right) = \\frac{N+3}{2} $$\n\n#### 策略 2：双分支二倍多相抽取器\n\n这种结构通过重新排列滤波操作来高效地实现抽取。滤波器 $H(z)$ 被分解为其类型 1 多相分量：$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$，其中多相滤波器分别由 $h[n]$ 的偶数和奇数索引系数定义：\n$$ e_0[k] = h[2k] \\quad \\text{和} \\quad e_1[k] = h[2k+1] $$\n输出在低速率下计算为 $y[m] = (x_e * e_0)[m] + (x_o * e_1)[m]$，其中 $x_e[m]=x[2m]$ 和 $x_o[m]=x[2m-1]$。\n\n根据给定的半带特性，$h[n]=0$ 对于所有奇数 $n$。这直接意味着第二个多相分量的所有系数都为零：对于所有 $k$，$e_1[k] = h[2k+1] = 0$。因此，滤波器 $E_1(z)$ 为零，多相结构的第二个分支对输出没有贡献。\n\n计算简化为：\n$$ y[m] = \\sum_{k} e_0[k] x[2m-2k] $$\n这是一个滤波器 $e_0[k]$ 与降采样后的输入序列 $x[2m]$ 的单次卷积，在输出采样率下运行。我们需要找到这次卷积的成本。\n\n滤波器 $e_0[k] = h[2k]$ 的系数对于 $k \\in \\{0, 1, \\dots, 2R\\}$。其长度为 $L_0 = 2R+1$。\n我们检查其对称性：$e_0[k] = h[2k]$，并且根据 $h[n]$ 的对称性，$h[2k] = h[4R-2k]$。系数 $e_0[2R-k] = h[2(2R-k)] = h[4R-2k]$。因此，$e_0[k]=e_0[2R-k]$，这意味着 $e_0[k]$ 是一个长度为奇数 $L_0=2R+1$ 的对称滤波器。\n\n对于一个利用对称性的奇数长度 $L_0$ 的对称 FIR 滤波器，每个输出样本的乘法次数是 $\\frac{L_0+1}{2}$。\n$e_0[k]$ 的中心抽头位于索引 $k=R$ 处，其值为 $e_0[R] = h[2R] = \\frac{1}{2}$，这是非零的，必须计算在内。\n策略 2 的计算成本是：\n$$ C_2 = \\frac{L_0+1}{2} = \\frac{(2R+1)+1}{2} = \\frac{2R+2}{2} = R+1 $$\n代入 $R = \\frac{N-1}{4}$：\n$$ C_2 = \\frac{N-1}{4} + 1 = \\frac{N+3}{4} $$\n\n直接形式下每个输出样本的实数乘法次数为 $\\frac{N+3}{2}$，而多相形式下为 $\\frac{N+3}{4}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{N+3}{2}  \\frac{N+3}{4} \\end{pmatrix} } $$", "id": "2867572"}, {"introduction": "在处理大的抽取因子时，级联积分梳状 (CIC) 滤波器因其无需乘法器的结构而备受青睐。然而，这种效率的代价是巨大的直流增益和频率响应的下垂，通常需要一个补偿 FIR 滤波器来校正。本练习将带您进入一个实际的双级抽取器设计场景，您需要解决固定点实现中的关键问题：如何正确地对 CIC 滤波器的增益进行归一化，并为积分器和累加器确定必要的位宽以防止溢出 ([@problem_id:2867568])。", "problem": "在一个两级多速率抽取器中，一个级联积分梳状 (CIC) 抽取前端之后连接一个补偿有限冲激响应 (FIR) 级。输入为有符号定点数据流，以 $B_{\\mathrm{in}}=12$ 位的二进制补码表示，归一化满量程范围为 $\\left[-1,1\\right)$。输入幅值有界，满足 $\\left|x[n]\\right|\\leq X_{\\max}$，其中 $X_{\\max}=0.5$。CIC 级有 $N=3$ 个级联部分，差分延迟 $M=1$，抽取因子 $R=32$。补偿 FIR 级是一个线性相位、对称、5 抽头的 2 倍抽取器，其系数为\n$$\nh[0]=-0.04,\\quad h[1]=0.12,\\quad h[2]=0.84,\\quad h[3]=0.12,\\quad h[4]=-0.04,\n$$\n应用于 CIC 输出速率。在 CIC 梳状滤波器输出之后、补偿 FIR 之前，插入一个 2 的幂次缩放因子 $2^{-k}$，以归一化总直流 (DC) 增益并防止下游 FIR 累加器溢出。\n\n从线性时不变系统的第一性原理出发，包括 CIC 滤波器作为 $N$ 重积分器和梳状滤波器级联并以 $R$ 倍抽取的结构，以及 FIR 卷积幅度的 $\\ell_{1}$ 范数界，确定：\n\n1) 使从输入到最终输出的总直流增益恰好为 1 的归一化因子 $2^{-k}$（即确定 $k$）。\n\n2) 对于满足 $\\left|x[n]\\right|\\leq X_{\\max}$ 的任何输入，为防止溢出，CIC 积分器寄存器必须在 $B_{\\mathrm{in}}$ 之外增加的最小位数。\n\n3) 当使用第 1 部分的归一化因子时，在相同的输入边界下，为防止溢出，FIR 累加器必须在其输入字长之外增加的最小位数。\n\n按以下顺序以单行矩阵形式报告您的最终结果：\n- 第一项：归一化因子 $2^{-k}$ 的精确解析表达式。\n- 第二项：第 2 项中的 CIC 积分器附加位数。\n- 第三项：第 3 项中的 FIR 累加器附加位数。\n\n无需四舍五入；提供精确值。最终答案中不要包含单位。", "solution": "所提出的问题是多速率数字信号处理系统分析中的一个标准练习，具体涉及级联积分梳状 (CIC) 滤波器和有限冲激响应 (FIR) 滤波器的定点实现。系统的验证表明，该问题具有科学依据、提法恰当且客观。它包含了所有必要的信息，没有矛盾或无法形式化的断言。因此，我将给出完整的解答。\n\n该问题要求确定与两级抽取器相关的三个量：1) 归一化缩放因子 $2^{-k}$，2) CIC 积分器寄存器的附加位宽，以及 3) 补偿 FIR 累加器的附加位宽。我们将基于第一性原理依次解决每个问题。\n\n首先，我们确定将总直流 (DC) 增益设置为 1 所需的归一化因子 $2^{-k}$。总直流增益是级联中各个级（CIC 滤波器、缩放器和 FIR 滤波器）的直流增益的乘积。\n\n从高速率输入到低速率输出的 CIC 抽取器的传递函数由下式给出\n$$\nH_{\\text{CIC}}(z) = \\left( \\frac{1 - z^{-RM}}{1 - z^{-M}} \\right)^N\n$$\n然而，为了进行增益分析，使用非递归形式更为直观，该形式将滤波器建模为 $N$ 个移动平均滤波器的级联，每个滤波器长度为 $RM$。从高速率输入 $x[n]$ 到低速率输出 $y_d[n']$ 的真实传递函数具有等效的频率响应，对应于\n$$\nH_{\\text{CIC, effective}}(z) = \\left( \\frac{\\sum_{i=0}^{RM-1} z^{-i}}{1} \\right)^N = \\left( \\frac{1 - z^{-RM}}{1-z^{-1}} \\right)^N\n$$\n直流增益对应于在 $z=1$ (或 $\\omega=0$) 处对此传递函数的求值。直接代入会导致不定形式 $\\frac{0}{0}$。我们对核心项应用 L'Hôpital 法则：\n$$\n\\lim_{z \\to 1} \\frac{1 - z^{-RM}}{1-z^{-1}} = \\lim_{z \\to 1} \\frac{\\frac{d}{dz}(1 - z^{-RM})}{\\frac{d}{dz}(1-z^{-1})} = \\lim_{z \\to 1} \\frac{RM z^{-RM-1}}{z^{-2}} = RM\n$$\n因此，CIC 滤波器的直流增益 $G_{\\text{CIC,DC}}$ 为 $(RM)^N$。给定参数 $R=32$、$M=1$ 和 $N=3$，我们有：\n$$\nG_{\\text{CIC,DC}} = (32 \\cdot 1)^3 = 32^3 = (2^5)^3 = 2^{15}\n$$\nFIR 滤波器的直流增益 $G_{\\text{FIR,DC}}$ 是其系数之和，这等效于在 $z'=1$ 处计算其传递函数 $H_{\\text{FIR}}(z') = \\sum_{j=0}^{4} h[j] (z')^{-j}$：\n$$\nG_{\\text{FIR,DC}} = \\sum_{j=0}^{4} h[j] = (-0.04) + 0.12 + 0.84 + 0.12 + (-0.04) = 1.00\n$$\n总直流增益 $G_{\\text{total}}$ 是 CIC 级、缩放器 $2^{-k}$ 和 FIR 级的增益的乘积。我们按要求将其设置为 1：\n$$\nG_{\\text{total}} = G_{\\text{CIC,DC}} \\cdot 2^{-k} \\cdot G_{\\text{FIR,DC}} = 1\n$$\n$$\n2^{15} \\cdot 2^{-k} \\cdot 1.0 = 1 \\implies 2^{-k} = 2^{-15}\n$$\n这确定了归一化因子为 $2^{-15}$，意味着 $k=15$。\n\n其次，我们确定为防止溢出，CIC 积分器寄存器所需的最小附加位数。附加位数对应于必要的裕量，该裕量由寄存器必须保持的最大可能值决定。第 $N$ 个积分器级输出的最大值受滤波器增益与最大输入幅值乘积的限制。对于 CIC 滤波器，此增益为 $(RM)^N$。\n给定输入信号 $x[n]$ 有界，满足 $|x[n]| \\le X_{\\max} = 0.5$，则最终积分器级输出的最大绝对值 $|y_{N, \\max}|$ 为：\n$$\n|y_{N, \\max}| \\le (RM)^N X_{\\max} = (32 \\cdot 1)^3 \\cdot 0.5 = 2^{15} \\cdot 2^{-1} = 2^{14}\n$$\n输入信号用 $B_{\\mathrm{in}}=12$ 位表示，在归一化范围 $[-1, 1)$ 内，这意味着一个定点格式有 $0$ 个整数位（符号位不是整数位）。为了在二进制补码系统中无溢出地表示最大输出幅值 $2^{14}$，所需的整数位数 $I_{\\text{out}}$ 由下式给出：\n$$\nI_{\\text{out}} = \\lceil \\log_2(|y_{N, \\max}|) \\rceil = \\lceil \\log_2(2^{14}) \\rceil = 14\n$$\n所需的附加位数是从输入到输出整数位数的增加量。输入需要 $I_{\\text{in}} = 0$ 个整数位。因此，积分器寄存器所需的附加位数为：\n$$\n\\Delta B_{\\text{CIC}} = I_{\\text{out}} - I_{\\text{in}} = 14 - 0 = 14\n$$\n\n第三，我们确定 FIR 累加器所需的最小附加位数。FIR 滤波器处理信号 $v[n']$，该信号是 CIC 抽取器输出经 $2^{-k}$ 缩放后的结果。首先，我们找到 $v[n']$ 的最大幅值。整个 CIC 抽取滤波器的最大输出 $|y_d|_{\\max}$ 受限于与其最终积分器级相同的值：$|y_d|_{\\max} \\le 2^{14}$。\nFIR 级的输入为 $v[n'] = 2^{-k} y_d[n']$。使用 $k=15$：\n$$\n|v|_{\\max} = \\max_n |v[n']| \\le 2^{-15} |y_d|_{\\max} = 2^{-15} \\cdot 2^{14} = 0.5\n$$\n为防止 FIR 累加器溢出，我们必须找到卷积和的最大可能值。FIR 滤波器输出幅值的一个稳健的、最坏情况下的界是其系数的 $\\ell_1$ 范数与最大输入幅值的乘积。FIR 滤波器的 $\\ell_1$ 范数 $\\|h\\|_1$ 是：\n$$\n\\|h\\|_1 = \\sum_{j=0}^{4} |h[j]| = |-0.04| + |0.12| + |0.84| + |0.12| + |-0.04|\n$$\n$$\n\\|h\\|_1 = 0.04 + 0.12 + 0.84 + 0.12 + 0.04 = 1.16\n$$\n因此，FIR 累加器中的最大值 $|y_{\\text{FIR,acc}}|_{\\max}$ 的界为：\n$$\n|y_{\\text{FIR,acc}}|_{\\max} \\le \\|h\\|_1 \\cdot |v|_{\\max} = 1.16 \\cdot 0.5 = 0.58\n$$\n现在我们确定所需的位增长。FIR 输入信号 $v[n']$ 的最大幅值为 $0.5$。由于 $0.5  1$，其表示需要 $I_{\\text{FIR,in}} = 0$ 个整数位。累加器输出的最大幅值为 $0.58$。由于 $0.58  1$，其表示也需要 $I_{\\text{FIR,out}} = 0$ 个整数位。\nFIR 累加器所需的附加位数为差值：\n$$\n\\Delta B_{\\text{FIR}} = I_{\\text{FIR,out}} - I_{\\text{FIR,in}} = 0 - 0 = 0\n$$\n缩放因子 $k=15$ 正是确保 FIR 累加器输出幅值保持在 $1.0$ 以下所需的最小整数值，从而无需额外的整数位。\n\n最终结果是归一化因子 $2^{-15}$，CIC 积分器的 14 个附加位，以及 FIR 累加器的 0 个附加位。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2^{-15}  14  0\n\\end{pmatrix}\n}\n$$", "id": "2867568"}, {"introduction": "高效的多速率结构不仅限于抽取，在插值中也同样至关重要。本练习将焦点转向插值器，它通过升采样和滤波来提高信号的采样率。您将分析一个线性相位 FIR 插值滤波器的两个关键性能方面：它为系统带来的群延迟，以及其抑制频谱镜像的能力如何直接影响输出信号的无杂散动态范围 (SFDR) ([@problem_id:2867566])。这个过程展示了如何将高层级的系统性能要求转化为具体的滤波器设计规范。", "problem": "一个离散时间$2$倍插值系统的构建如下。将采样频率为 $f_{s,\\mathrm{in}}$ 的输入序列 $x[n]$ 通过插入零点的方式进行$2$倍上采样，生成 $x_{\\uparrow 2}[m]$，然后通过一个实系数有限脉冲响应（FIR）半带低通滤波器 $h[n]$，产生采样频率为 $f_{s,\\mathrm{out}}=2 f_{s,\\mathrm{in}}$ 的输出 $y[m]$。滤波器 $h[n]$ 的长度 $N$ 为奇数，具有线性相位且对称性为 $h[n]=h[N-1-n]$，在通带内 $\\omega=0$ 处的增益为单位增益，且最大阻带幅度有界，即 $\\max_{\\omega \\in \\mathrm{SB}}|H(\\mathrm{e}^{j\\omega})| \\leq 10^{-A_{s}/20}$，其中 $A_{s}$ 是以分贝（dB）表示的阻带衰减。假设通带波纹可忽略不计，因此在推导中可将通带增益视为恰好为$1$。\n\n设输入为单音正弦波 $x[n]=A \\cos(\\Omega_{0} n + \\varphi)$，其相位 $\\varphi$ 任意，幅度 $A0$，离散时间弧度频率为 $\\Omega_{0}$，且该音调在插值后严格位于基带内（即无混叠）。\n\n使用多速率信号处理（通过插入零点进行上采样）和线性相位FIR系统的基本原理，推导：\n\n1. 整个插值器的群延迟的闭式表达式（用 $N$ 表示），以输出样本为单位（即以输出采样周期为单位）。然后对 $N=81$ 进行求值。\n\n2. 最小镜像衰减 $A_{s}^{\\star}$ 的闭式表达式（以dB表示），该衰减保证在上述正弦输入下，插值器输出端达到目标无杂散动态范围（SFDR） $S_{\\mathrm{target}}$ dB。此推导基于最大杂散是插值滤波器后的残留镜像这一假设。然后对 $S_{\\mathrm{target}}=92$ dB 进行求值。\n\n以行矩阵 $(\\text{群延迟（以输出样本为单位）}, \\text{所需衰减（以dB为单位）})$ 的形式提供最终的数值对。矩阵中不要包含单位。如果需要四舍五入，则保留四位有效数字；否则提供精确整数。", "solution": "该问题经评估为有效问题，因为它科学地基于数字信号处理原理，问题设定良好，有足够信息得出唯一解，并且以客观、正式的语言陈述。我们可以开始求解。\n\n该问题要求计算与离散时间插值器相关的两个量。该插值器首先通过插入零点将输入序列 $x[n]$ 上采样，使采样率提高 $M=2$ 倍，然后将结果通过一个低通有限脉冲响应（FIR）滤波器 $h[n]$。\n\n**1. 插值器的群延迟**\n\n整个插值系统包括两个阶段：一个$2$倍上采样器和一个FIR滤波器 $h[n]$。\n上采样操作定义为：当 $m$ 为偶数时 $x_{\\uparrow 2}[m] = x[m/2]$，当 $m$ 为奇数时 $x_{\\uparrow 2}[m]=0$。这是一个无记忆的逐点操作，它不会在信号路径中引入任何时间延迟。因此，整个插值系统的群延迟完全由后插值滤波器 $h[n]$ 的群延迟决定。\n\n滤波器 $h[n]$ 被指定为实系数、奇数长度（$N$）、具有对称性 $h[n] = h[N-1-n]$ 的线性相位FIR滤波器。这对应于I型线性相位FIR滤波器。\n\nI型FIR滤波器的频率响应可以写成以下形式：\n$$H(\\mathrm{e}^{j\\omega}) = A_e(\\omega) \\exp\\left(-j\\omega\\frac{N-1}{2}\\right)$$\n其中 $A_e(\\omega)$ 是一个实值幅度函数，相位响应为 $\\theta(\\omega) = -\\omega \\frac{N-1}{2}$。\n\n群延迟 $\\tau_g(\\omega)$ 定义为相位响应对频率的负导数：\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega} \\theta(\\omega) = -\\frac{d}{d\\omega} \\left(-\\omega\\frac{N-1}{2}\\right)$$\n$$\\tau_g(\\omega) = \\frac{N-1}{2}$$\n对于I型线性相位FIR滤波器，群延迟在所有频率上都是恒定的。滤波器 $h[n]$ 作用于上采样后的信号，该信号的采样频率为输出采样频率 $f_{s,\\mathrm{out}}$。因此，其群延迟以输出采样周期 $T_{s,\\mathrm{out}} = 1/f_{s,\\mathrm{out}}$ 为单位进行测量。\n\n问题要求以输出样本为单位计算此群延迟。推导出的值已经是这个单位。\n给定滤波器长度 $N=81$，群延迟为：\n$$\\tau_g = \\frac{81-1}{2} = \\frac{80}{2} = 40$$\n群延迟为 $40$ 个输出样本。\n\n**2. 目标SFDR所需的最小镜像衰减**\n\n设输入信号为 $x[n] = A \\cos(\\Omega_0 n + \\varphi)$。其离散时间弧度频率 $\\Omega_0$ 是相对于输入采样率 $f_{s,\\mathrm{in}}$ 而言的。\n\n通过插入零点进行的$2$倍上采样操作产生序列 $x_{\\uparrow 2}[m]$。为了分析 $x_{\\uparrow 2}[m]$ 的频谱内容，我们可以将输入表示为复指数之和：\n$$x[n] = \\frac{A}{2} \\left( e^{j(\\Omega_0 n + \\varphi)} + e^{-j(\\Omega_0 n + \\varphi)} \\right)$$\n将复指数 $e^{j\\omega_0 n}$ 通过插入零点进行 $M$ 倍（此处 $M=2$）上采样，会得到一个序列，其分量位于频率 $\\frac{\\omega_0}{M} + \\frac{2\\pi k}{M}$ 处，其中 $k=0, 1, ..., M-1$。对于 $M=2$，这给出了频率 $\\frac{\\omega_0}{2}$ 和 $\\frac{\\omega_0}{2}+\\pi$。每个新分量的幅度是原始复指数幅度的 $1/M$（即 $1/2$）。\n\n将此应用于我们的输入信号：\n- 项 $\\frac{A}{2}e^{j\\varphi} e^{j\\Omega_0 n}$ 在 $x_{\\uparrow 2}[m]$ 中产生两个分量：\n  - 位于频率 $\\omega = \\Omega_0/2$ 处的 $\\frac{1}{2}\\left(\\frac{A}{2}e^{j\\varphi}\\right) e^{j(\\Omega_0/2) m}$。\n  - 位于频率 $\\omega = \\Omega_0/2 + \\pi$ 处的 $\\frac{1}{2}\\left(\\frac{A}{2}e^{j\\varphi}\\right) e^{j(\\Omega_0/2 + \\pi) m}$。\n- 项 $\\frac{A}{2}e^{-j\\varphi} e^{-j\\Omega_0 n}$ 产生两个分量：\n  - 位于频率 $\\omega = -\\Omega_0/2$ 处的 $\\frac{1}{2}\\left(\\frac{A}{2}e^{-j\\varphi}\\right) e^{-j(\\Omega_0/2) m}$。\n  - 位于频率 $\\omega = \\pi - \\Omega_0/2$ 处的 $\\frac{1}{2}\\left(\\frac{A}{2}e^{-j\\varphi}\\right) e^{j(-\\Omega_0/2 + \\pi) m}$。\n\n组合这些分量以形成实正弦波：\n- **期望信号**：位于 $\\pm\\Omega_0/2$ 的分量组合形成期望信号：\n  $$s_d[m] = \\frac{A}{4}e^{j\\varphi} e^{j(\\Omega_0/2) m} + \\frac{A}{4}e^{-j\\varphi} e^{-j(\\Omega_0/2) m} = \\frac{A}{2} \\cos\\left(\\frac{\\Omega_0}{2} m + \\varphi\\right)$$\n  滤波前期望信号分量的幅度为 $A_d^{\\mathrm{pre}} = A/2$。其频率 $\\Omega_0/2$ 位于半带滤波器 $h[n]$ 的通带内（因为 $\\Omega_0 \\in (0, \\pi)$，所以 $\\Omega_0/2 \\in (0, \\pi/2)$）。\n- **镜像信号**：位于 $\\pi+\\Omega_0/2$ 和 $\\pi-\\Omega_0/2$ 的分量形成镜像信号。频率 $\\pi+\\Omega_0/2$ 是 $\\pi+\\Omega_0/2-2\\pi = \\Omega_0/2-\\pi = -(\\pi-\\Omega_0/2)$ 的混叠，即另一个镜像频率的负值。这些分量组合为：\n  $$s_{im}[m] = \\frac{A}{2} \\cos\\left( (\\pi - \\frac{\\Omega_0}{2})m - \\varphi \\right)$$\n  滤波前镜像信号（杂散）的幅度为 $A_{im}^{\\mathrm{pre}} = A/2$。其频率 $\\pi-\\Omega_0/2$ 位于半带滤波器的阻带内。\n\n信号 $x_{\\uparrow 2}[m]$ 随后通过滤波器 $h[n]$。\n- 期望信号的输出幅度为 $A_{d,\\mathrm{out}} = A_d^{\\mathrm{pre}} \\times |H(e^{j\\Omega_0/2})|$。根据通带单位增益的假设， $|H(e^{j\\Omega_0/2})|=1$，因此 $A_{d,\\mathrm{out}} = A/2$。\n- 杂散的输出幅度为 $A_{spur,\\mathrm{out}} = A_{im}^{\\mathrm{pre}} \\times |H(e^{j(\\pi-\\Omega_0/2)})|$。问题给出了滤波器在阻带内幅度的上限：$|H(e^{j\\omega})| \\le 10^{-A_s/20}$，其中 $\\omega \\in \\mathrm{SB}$。最坏情况下的杂散幅度发生在滤波器在镜像频率处的响应达到此最大允许值时。\n  $$A_{spur,\\mathrm{out}}^{\\max} = \\frac{A}{2} \\times 10^{-A_s/20}$$\n\n无杂散动态范围（SFDR）是期望信号幅度与最强杂散分量幅度的比值。\n$$SFDR = \\frac{A_{d,\\mathrm{out}}}{A_{spur,\\mathrm{out}}^{\\max}} = \\frac{A/2}{(A/2) \\times 10^{-A_s/20}} = \\frac{1}{10^{-A_s/20}} = 10^{A_s/20}$$\n以分贝（dB）表示SFDR，我们得到：\n$$S_{\\mathrm{dB}} = 20 \\log_{10}(SFDR) = 20 \\log_{10}(10^{A_s/20}) = A_s$$\n这表明，对于该系统，所需的最小阻带衰减（以dB为单位）$A_s^{\\star}$ 等于目标SFDR（以dB为单位）$S_{\\mathrm{target}}$。\n$$A_s^{\\star} = S_{\\mathrm{target}}$$\n给定目标SFDR为 $S_{\\mathrm{target}}=92$ dB，所需的最小阻带衰减为：\n$$A_s^{\\star} = 92 \\; \\mathrm{dB}$$\n\n最终的数值对是（群延迟，所需衰减）。\n群延迟为 $40$ 个样本。\n所需衰减为 $92$ dB。\n两个值都是精确整数，不需要四舍五入。", "answer": "$$ \\boxed{ \\begin{pmatrix} 40  92 \\end{pmatrix} } $$", "id": "2867566"}]}