{"hands_on_practices": [{"introduction": "正交镜像滤波器组 (QMF) 的精妙之处在于其能够完美消除由下采样引入的混叠失真。本练习 ([@problem_id:2915690]) 并非一次纯粹的代数推演，其核心在于揭示滤波器设计中使这种抵消成为可能的优美对称性。通过从第一性原理出发完成此推导，您将深刻理解实现混叠对消的核心设计条件。", "problem": "考虑为离散时间信号设计一个双通道正交镜像滤波器（Quadrature Mirror Filter, QMF）组。令分析低通滤波器为一个实值、线性相位、对称半带有限冲激响应（Finite Impulse Response, FIR）滤波器 $H_{0}(\\exp(j\\omega))$，它是通过对理想半带低通滤波器使用窗函数法得到的。具体来说，从理想的半带频率响应出发，该响应在 $|\\omega| \\leq \\omega_{c}$ 时为1，在 $|\\omega| \\geq \\pi - \\omega_{c}$ 时为0，过渡带中心在 $\\omega_{c} = \\pi/2$。其理想冲激响应为\n$$\nh_{\\mathrm{ideal}}[n] \\;=\\; \\frac{\\sin\\!\\big(\\frac{\\pi}{2}(n - (N-1)/2)\\big)}{\\pi (n - (N-1)/2)} \\quad \\text{对于} \\; n \\neq (N-1)/2,\\quad\nh_{\\mathrm{ideal}}[(N-1)/2] \\;=\\; \\frac{1}{2},\n$$\n其中 $N$ 是一个奇数正整数。选择任意一个在 $n = 0,\\dots,N-1$ 上有支撑的偶对称窗函数 $w[n]$，满足 $w[n] = w[N-1-n]$，并将设计的滤波器系数定义为 $h_{0}[n] = h_{\\mathrm{ideal}}[n]\\,w[n]$，使得 $H_{0}(\\exp(j\\omega))$ 是实值、偶对称和半带的。通过正交镜像关系定义相应的分析高通滤波器 $H_{1}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - \\pi)))$。考虑一个经典的双通道QMF分析-综合系统，该系统在分析后进行2倍抽取，在综合前进行2倍内插，且选择的综合滤波器为 $F_{0}(\\exp(j\\omega)) = H_{0}(\\exp(j\\omega))$ 和 $F_{1}(\\exp(j\\omega)) = -\\,H_{1}(\\exp(j\\omega))$。\n\n仅从离散时间傅里叶变换（DTFT）、线性时不变滤波的定义，以及2倍降采样和2倍升采样的频域关系出发，推导将系统输出端的期望（非混叠）分量与混叠分量分离开的输入-输出关系。由此，求出在输出端与调制输入 $X(\\exp(j(\\omega-\\pi)))$ 相乘的混叠传递函数 $A(\\exp(j\\omega))$。然后，仅使用给定的 $H_{0}$、$H_{1}$、$F_{0}$ 和 $F_{1}$ 之间的QMF关系，计算 $A(\\exp(j\\omega))$ 的精确闭式表达式。\n\n你的最终答案必须是一个单一的闭式解析表达式。不需要数值近似。", "solution": "该问题陈述是数字信号处理领域中一个有效且适定的问题。它具有科学依据，并包含了推导唯一解所需的所有信息。我们将着手进行推导。\n\n该结构是一个双通道分析-综合滤波器组。设输入信号为 $x[n]$，其离散时间傅里叶变换（DTFT）为 $X(\\exp(j\\omega))$。\n\n首先，我们描述分析阶段。输入信号 $x[n]$ 通过一个低通滤波器 $h_{0}[n]$ 和一个高通滤波器 $h_{1}[n]$。输出分别为 $y_{0}[n]$ 和 $y_{1}[n]$。在频域中，它们的DTFT由下式给出：\n$$Y_{0}(\\exp(j\\omega)) = H_{0}(\\exp(j\\omega)) X(\\exp(j\\omega))$$\n$$Y_{1}(\\exp(j\\omega)) = H_{1}(\\exp(j\\omega)) X(\\exp(j\\omega))$$\n\n接下来，这些信号被以2为因子进行降采样。设降采样后的信号为 $v_{0}[n] = y_{0}[2n]$ 和 $v_{1}[n] = y_{1}[2n]$。一个被2倍降采样的信号的DTFT与原始信号的DTFT之间有如下基本关系：\n$$V_{k}(\\exp(j\\omega)) = \\frac{1}{2} \\left[ Y_{k}(\\exp(j\\omega/2)) + Y_{k}(\\exp(j(\\omega/2 - \\pi))) \\right]$$\n对于 $k = 0, 1$。代入 $Y_{0}(\\exp(j\\omega))$ 和 $Y_{1}(\\exp(j\\omega))$ 的表达式，我们得到：\n$$V_{0}(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega/2)) X(\\exp(j\\omega/2)) + H_{0}(\\exp(j(\\omega/2 - \\pi))) X(\\exp(j(\\omega/2 - \\pi))) \\right]$$\n$$V_{1}(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{1}(\\exp(j\\omega/2)) X(\\exp(j\\omega/2)) + H_{1}(\\exp(j(\\omega/2 - \\pi))) X(\\exp(j(\\omega/2 - \\pi))) \\right]$$\n\n这些被抽取后的信号被传输，然后在接收端进入综合阶段之前，被以2为因子进行升采样。设升采样后的信号为 $u_{0}[n]$ 和 $u_{1}[n]$。一个升采样信号的DTFT由 $U(\\exp(j\\omega)) = V(\\exp(j2\\omega))$ 给出。将此应用于 $v_{0}[n]$ 和 $v_{1}[n]$ 得到：\n$$U_{0}(\\exp(j\\omega)) = V_{0}(\\exp(j2\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{0}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right]$$\n$$U_{1}(\\exp(j\\omega)) = V_{1}(\\exp(j2\\omega)) = \\frac{1}{2} \\left[ H_{1}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{1}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right]$$\n\n最后，综合阶段重构信号。升采样后的信号由综合滤波器 $F_{0}(\\exp(j\\omega))$ 和 $F_{1}(\\exp(j\\omega))$ 进行滤波，它们的输出相加。最终输出信号 $\\hat{x}[n]$ 的DTFT为：\n$$\\hat{X}(\\exp(j\\omega)) = F_{0}(\\exp(j\\omega)) U_{0}(\\exp(j\\omega)) + F_{1}(\\exp(j\\omega)) U_{1}(\\exp(j\\omega))$$\n代入 $U_{0}(\\exp(j\\omega))$ 和 $U_{1}(\\exp(j\\omega))$ 的表达式：\n\\begin{align*}\n\\hat{X}(\\exp(j\\omega)) = \\frac{1}{2} F_{0}(\\exp(j\\omega)) \\left[ H_{0}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{0}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right] \\\\\n+ \\frac{1}{2} F_{1}(\\exp(j\\omega)) \\left[ H_{1}(\\exp(j\\omega)) X(\\exp(j\\omega)) + H_{1}(\\exp(j(\\omega - \\pi))) X(\\exp(j(\\omega - \\pi))) \\right]\n\\end{align*}\n我们现在将包含原始输入谱 $X(\\exp(j\\omega))$ 的项与包含混叠谱 $X(\\exp(j(\\omega - \\pi)))$ 的项分离开。\n\\begin{align*}\n\\hat{X}(\\exp(j\\omega)) = \\frac{1}{2} \\left[ F_{0}(\\exp(j\\omega)) H_{0}(\\exp(j\\omega)) + F_{1}(\\exp(j\\omega)) H_{1}(\\exp(j\\omega)) \\right] X(\\exp(j\\omega)) \\\\\n+ \\frac{1}{2} \\left[ F_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) + F_{1}(\\exp(j\\omega)) H_{1}(\\exp(j(\\omega - \\pi))) \\right] X(\\exp(j(\\omega - \\pi)))\n\\end{align*}\n这是一个双通道滤波器组的一般输入-输出关系，其形式为 $\\hat{X}(\\exp(j\\omega)) = T(\\exp(j\\omega)) X(\\exp(j\\omega)) + A(\\exp(j\\omega)) X(\\exp(j(\\omega - \\pi)))$。\n项 $A(\\exp(j\\omega))$ 是混叠传递函数，由下式给出：\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ F_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) + F_{1}(\\exp(j\\omega)) H_{1}(\\exp(j(\\omega - \\pi))) \\right]$$\n问题要求我们使用滤波器之间指定的以下关系来计算 $A(\\exp(j\\omega))$ 的精确闭式表达式：\n1.  $H_{1}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - \\pi)))$\n2.  $F_{0}(\\exp(j\\omega)) = H_{0}(\\exp(j\\omega))$\n3.  $F_{1}(\\exp(j\\omega)) = -H_{1}(\\exp(j\\omega))$\n\n我们将关系式(2)和(3)代入 $A(\\exp(j\\omega))$ 的表达式中：\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) + (-H_{1}(\\exp(j\\omega))) H_{1}(\\exp(j(\\omega - \\pi))) \\right]$$\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) - H_{1}(\\exp(j\\omega)) H_{1}(\\exp(j(\\omega - \\pi))) \\right]$$\n现在，我们使用关系式(1)将涉及 $H_{1}$ 的项用 $H_{0}$ 来表示。我们需要的第一个项是 $H_{1}(\\exp(j\\omega))$，它由关系式(1)直接给出：\n$$H_{1}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - \\pi)))$$\n我们需要的第二个项是 $H_{1}(\\exp(j(\\omega - \\pi)))$。我们通过将 $\\omega \\to (\\omega - \\pi)$ 代入关系式(1)来得到它：\n$$H_{1}(\\exp(j(\\omega - \\pi))) = H_{0}(\\exp(j((\\omega - \\pi) - \\pi))) = H_{0}(\\exp(j(\\omega - 2\\pi)))$$\n由于DTFT是以 $2\\pi$ 为周期的，所以 $H_{0}(\\exp(j(\\omega - 2\\pi))) = H_{0}(\\exp(j\\omega))$。因此：\n$$H_{1}(\\exp(j(\\omega - \\pi))) = H_{0}(\\exp(j\\omega))$$\n现在我们将这两个恒等式代回到我们关于 $A(\\exp(j\\omega))$ 的表达式中：\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ H_{0}(\\exp(j\\omega)) H_{0}(\\exp(j(\\omega - \\pi))) - (H_{0}(\\exp(j(\\omega - \\pi)))) (H_{0}(\\exp(j\\omega))) \\right]$$\n方括号内的两项是相同的，并且相互减去。\n$$A(\\exp(j\\omega)) = \\frac{1}{2} \\left[ 0 \\right]$$\n因此，混叠传递函数恒等于零。\n$$A(\\exp(j\\omega)) = 0$$\n这表明，问题中规定的综合滤波器的特定选择，与分析滤波器之间的正交镜像关系相结合，导致了在QMF滤波器组输出端混叠分量的完美抵消。关于 $H_{0}(\\exp(j\\omega))$ 设计的详细信息是背景知识，用以确认这种滤波器可以实现，但对于最终的代数化简并非必需。", "answer": "$$\\boxed{0}$$", "id": "2915690"}, {"introduction": "在证明了混叠*可以*被消除之后，我们现在来探究为什么它首先会成为一个问题。本练习 ([@problem_id:2915722]) 通过一个假设场景，直观地展示了滤波和抽取之间关键的不可交换关系。通过计算两种不同处理顺序下的输出，您将能够量化由混叠引入的误差，并理解在下采样*之前*衰减带外信号的重要性。", "problem": "考虑一个双通道正交镜像滤波器（QMF）组中的分析低通分支，其中分析低通滤波器是一个非理想的离散时间线性时不变滤波器，其频率响应为 $H(e^{j\\omega})$。设输入为两个实正弦信号之和，\n$$\nx[n] = A \\cos(\\omega_{p} n) + B \\cos(\\omega_{s} n),\n$$\n其中 $A>0$，$B>0$，$\\omega_{p} = \\pi/6$（通带）和 $\\omega_{s} = 5\\pi/6$（阻带）。该非理想低通滤波器具有理想化的分段常数幅值响应\n$$\n|H(e^{j\\omega})| = \\begin{cases}\n1,  & |\\omega| \\le \\pi/2,\\\\\n\\varepsilon, & \\pi/2 < |\\omega| \\le \\pi,\n\\end{cases}\n$$\n其中 $0 < \\varepsilon < 1$，且具有线性相位，因此通过 $|H(e^{j\\omega})|$ 的幅度缩放完全表征了正弦响应。考虑两种以因子 2 进行抽取（decimation）的处理顺序：\n\n- 先滤波后抽取：$x[n] \\xrightarrow{H(z)} v[n] \\xrightarrow{\\downarrow 2} y_{\\mathrm{FD}}[n]$，其中 $y_{\\mathrm{FD}}[n] = v[2n]$。\n\n- 先抽取后滤波：$x[n] \\xrightarrow{\\downarrow 2} u[n] \\xrightarrow{H(z)} y_{\\mathrm{DF}}[n]$，其中 $u[n] = x[2n]$ 且 $y_{\\mathrm{DF}}[n] = (h * u)[n]$。\n\n采用抽取后的归一化数字频率，使得 $y_{\\mathrm{FD}}[n]$ 和 $y_{\\mathrm{DF}}[n]$ 的频谱分量由 $\\omega' \\in [-\\pi,\\pi]$ 参数化。仅使用第一性原理（离散时间傅里叶变换的定义、滤波的线性性和时不变性，以及对余弦信号进行 2 倍下采样的时间域效应），比较 $y_{\\mathrm{FD}}[n]$ 和 $y_{\\mathrm{DF}}[n]$ 的频谱，并分离出在抽取后频率 $\\omega' = \\pi/3$ 处的贡献。\n\n将 $\\omega'=\\pi/3$ 处的混叠差异定义为\n$$\n\\Delta A \\triangleq y_{\\mathrm{DF}}[n]\\text{ 中 }\\cos(\\pi n/3)\\text{ 分量的幅度}\\;-\\;y_{\\mathrm{FD}}[n]\\text{ 中 }\\cos(\\pi n/3)\\text{ 分量的幅度}。\n$$\n以 $A$、$B$ 和 $\\varepsilon$ 的形式计算 $\\Delta A$ 的闭式解。以单一解析表达式的形式提供最终答案。不需要数值近似。", "solution": "该问题陈述清晰且科学合理。这是多速率数字信号处理中的一个标准练习，旨在检验对混叠以及滤波与抽取操作的不可交换性的理解。\n\n给定一个输入信号 $x[n]$，它是两个实正弦信号的和：\n$$x[n] = A \\cos(\\omega_{p} n) + B \\cos(\\omega_{s} n)$$\n其频率为 $\\omega_{p} = \\pi/6$ 和 $\\omega_{s} = 5\\pi/6$。该信号由一个具有分段常数幅值响应的低通滤波器 $H(z)$ 处理：\n$$\n|H(e^{j\\omega})| = \\begin{cases}\n1,  & |\\omega| \\le \\pi/2,\\\\\n\\varepsilon, & \\pi/2 < |\\omega| \\le \\pi.\n\\end{cases}\n$$\n问题陈述该滤波器具有线性相位，并且“通过 $|H(e^{j\\omega})|$ 的幅度缩放完全表征了正弦响应”。这是一个关键陈述。线性相位滤波器会引入一个与频率相关的相移 $-\\omega n_d$，从而产生一个恒定的群延迟 $n_d$。正弦信号之和的最终幅度可能取决于此延迟，因为混叠分量可以根据其相对相位进行相长或相消干涉。然而，问题的措辞强烈暗示，为了确定幅度，我们可以忽略相位效应。在这类问题中，这是一种常见的简化，以便专注于滤波和混叠的核心概念。因此，我们假设存在一个等效的零相位滤波器，其响应是纯实数的，即 $H(e^{j\\omega}) = |H(e^{j\\omega})|$。\n\n输入频率落入滤波器的不同频带：\n对于通带分量 $\\omega_p = \\pi/6$，我们有 $|\\pi/6| \\le \\pi/2$，因此滤波器增益为 $|H(e^{j\\pi/6})| = 1$。\n对于阻带分量 $\\omega_s = 5\\pi/6$，我们有 $\\pi/2 < |5\\pi/6| \\le \\pi$，因此滤波器增益为 $|H(e^{j5\\pi/6})| = \\varepsilon$。\n\n我们将分别分析这两个处理路径。\n\n路径 1：先滤波后抽取（FD）\n系统为 $x[n] \\xrightarrow{H(z)} v[n] \\xrightarrow{\\downarrow 2} y_{\\mathrm{FD}}[n]$。\n\n首先，信号 $x[n]$ 被滤波。根据我们的零相位假设，滤波作用是对正弦分量的幅度进行简单的缩放。\n$$v[n] = A \\cdot |H(e^{j\\pi/6})| \\cos(\\frac{\\pi}{6} n) + B \\cdot |H(e^{j5\\pi/6})| \\cos(\\frac{5\\pi}{6} n)$$\n$$v[n] = A \\cdot 1 \\cdot \\cos(\\frac{\\pi}{6} n) + B \\cdot \\varepsilon \\cdot \\cos(\\frac{5\\pi}{6} n) = A \\cos(\\frac{\\pi}{6} n) + B \\varepsilon \\cos(\\frac{5\\pi}{6} n)$$\n\n接下来，信号 $v[n]$ 以因子 2 进行抽取。这是通过取每第二个样本来实现的，即 $y_{\\mathrm{FD}}[n] = v[2n]$。\n$$y_{\\mathrm{FD}}[n] = A \\cos(\\frac{\\pi}{6} \\cdot 2n) + B \\varepsilon \\cos(\\frac{5\\pi}{6} \\cdot 2n)$$\n$$y_{\\mathrm{FD}}[n] = A \\cos(\\frac{\\pi}{3} n) + B \\varepsilon \\cos(\\frac{5\\pi}{3} n)$$\n第二项的频率 $5\\pi/3$ 位于抽取后信号的主频率范围 $[-\\pi, \\pi]$ 之外。我们在此范围内找到它的混叠。由于余弦函数是偶函数且周期为 $2\\pi$，我们有：\n$$\\cos(\\frac{5\\pi}{3} n) = \\cos(2\\pi n - \\frac{\\pi}{3} n) = \\cos(-\\frac{\\pi}{3} n) = \\cos(\\frac{\\pi}{3} n)$$\n将此代回 $y_{\\mathrm{FD}}[n]$ 的表达式中：\n$$y_{\\mathrm{FD}}[n] = A \\cos(\\frac{\\pi}{3} n) + B \\varepsilon \\cos(\\frac{\\pi}{3} n) = (A + B\\varepsilon) \\cos(\\frac{\\pi}{3} n)$$\n信号 $y_{\\mathrm{FD}}[n]$ 是一个在抽取后频率 $\\omega' = \\pi/3$ 处的单一正弦信号。因此，$y_{\\mathrm{FD}}[n]$ 中 $\\cos(\\pi n/3)$ 分量的幅度为 $A + B\\varepsilon$。\n\n路径 2：先抽取后滤波（DF）\n系统为 $x[n] \\xrightarrow{\\downarrow 2} u[n] \\xrightarrow{H(z)} y_{\\mathrm{DF}}[n]$。\n\n首先，信号 $x[n]$ 以因子 2 进行抽取，得到 $u[n] = x[2n]$。\n$$u[n] = A \\cos(\\frac{\\pi}{6} \\cdot 2n) + B \\cos(\\frac{5\\pi}{6} \\cdot 2n)$$\n$$u[n] = A \\cos(\\frac{\\pi}{3} n) + B \\cos(\\frac{5\\pi}{3} n)$$\n与前一种情况一样，原始频率为 $\\omega_s=5\\pi/6$ 的阻带分量由于抽取而发生混叠。其新频率变为 $5\\pi/3$，这是 $\\pi/3$ 的一个混叠频率。\n$$u[n] = A \\cos(\\frac{\\pi}{3} n) + B \\cos(\\frac{\\pi}{3} n) = (A + B) \\cos(\\frac{\\pi}{3} n)$$\n在此路径中，混叠发生在滤波之前。两个原始分量在抽取后的域中都映射到相同的频率 $\\omega' = \\pi/3$，并且它们的幅度相加。\n\n接下来，信号 $u[n]$ 由 $H(z)$ 滤波。滤波器的输入是频率为 $\\omega' = \\pi/3$ 的单一正弦信号。滤波器的响应由其在该频率下的增益决定。\n$$|H(e^{j\\omega'})| \\text{ at } \\omega' = \\pi/3$$\n由于 $|\\pi/3| \\le \\pi/2$，该频率位于滤波器的通带内，增益为 $|H(e^{j\\pi/3})| = 1$。\n输出信号 $y_{\\mathrm{DF}}[n]$ 为：\n$$y_{\\mathrm{DF}}[n] = (A+B) \\cdot |H(e^{j\\pi/3})| \\cdot \\cos(\\frac{\\pi}{3} n)$$\n$$y_{\\mathrm{DF}}[n] = (A+B) \\cdot 1 \\cdot \\cos(\\frac{\\pi}{3} n) = (A+B) \\cos(\\frac{\\pi}{3} n)$$\n$y_{\\mathrm{DF}}[n]$ 中 $\\cos(\\pi n/3)$ 分量的幅度为 $A+B$。\n\n最后，我们计算问题陈述中定义的混叠差异 $\\Delta A$。\n$$\\Delta A \\triangleq y_{\\mathrm{DF}}[n]\\text{ 中 }\\cos(\\pi n/3)\\text{ 分量的幅度}\\;-\\;y_{\\mathrm{FD}}[n]\\text{ 中 }\\cos(\\pi n/3)\\text{ 分量的幅度}$$\n$$\\Delta A = (A+B) - (A + B\\varepsilon)$$\n$$\\Delta A = A + B - A - B\\varepsilon = B - B\\varepsilon$$\n$$\\Delta A = B(1-\\varepsilon)$$\n这个结果量化了两个系统处理阻带分量的差异。在先滤波后抽取的架构中，阻带信号在发生混叠之前被衰减。在先抽取后滤波的架构中，阻带信号混叠到通带中，并且未被衰减。最终幅度的差异恰好是绕过的阻带衰减量，即 $B - B\\varepsilon$。", "answer": "$$\n\\boxed{B(1-\\varepsilon)}\n$$", "id": "2915722"}, {"introduction": "理论推导是必不可少的，但通过计算来验证理论能带来更深层次的理解和信心。在最后一个练习 ([@problem_id:2915687]) 中，您将使用现代且高效的提升方案 (lifting scheme) 来实现一个完美重构滤波器组。通过使用正弦输入测试该系统并测量混叠项，您将从数值上验证，对于一个正确设计的系统，混叠可以在机器精度范围内被消除。", "problem": "你需要使用两阶段提升方案（two-stage lifting scheme）实现一个双通道共轭正交滤波器（CQF）组，并通过估计一组测试正弦波的混叠传递函数 $T_1(e^{j\\omega})$ 来验证数值上的混叠消除。目标是从临界采样双通道滤波器组的基本多相和调制框架出发进行推导，并验证对于一个正确设计的 CQF，混叠能够被消除，即 $T_1(e^{j\\omega}) = 0$。\n\n从以下基本事实开始：\n\n1. 在一个临界采样的双通道分析-综合系统中，其在频域中的总输入-输出关系可以写为\n$$\nY\\left(e^{j\\omega}\\right) = \\frac{1}{2}\\left[T_0\\left(e^{j\\omega}\\right) X\\left(e^{j\\omega}\\right) + T_1\\left(e^{j\\omega}\\right) X\\left(e^{j(\\omega+\\pi)}\\right)\\right],\n$$\n其中 $X\\left(e^{j\\omega}\\right)$ 和 $Y\\left(e^{j\\omega}\\right)$ 分别是输入信号和重构输出信号的离散时间傅里叶变换。函数 $T_0\\left(e^{j\\omega}\\right)$ 是失真传递函数，而 $T_1\\left(e^{j\\omega}\\right)$ 是混叠传递函数。\n\n2. 对于一个具有完美重构特性的共轭正交滤波器（CQF）对，对所有 $\\omega$ 都有 $T_1\\left(e^{j\\omega}\\right) = 0$，并且 $T_0\\left(e^{j\\omega}\\right)$ 等于一个纯延迟（可能带有一个恒定增益）。一个充分的 CQF 条件是 $G_0(z) = H_0(z)$、$G_1(z) = -H_1(z)$，以及对于某个整数延迟 $k$ 有 $H_1(z) = z^{-k} H_0(-z)$。\n\n3. 在双通道滤波器组的提升框架中，一个预测步骤后跟一个更新步骤构成一个两阶段提升方案。将输入 $x[n]$ 进行奇偶分裂，得到 $s[k] = x[2k]$（偶数样本）和 $d[k] = x[2k+1]$（奇数样本），一个预测系数 $p$ 和一个更新系数 $u$ 定义了如下的分析过程：\n$$\nd \\leftarrow d - p \\, s, \\quad s \\leftarrow s + u \\, d,\n$$\n可以选择性地后跟一个对角缩放（在本题中你必须将缩放因子设为1）。综合过程精确地反转这两个步骤：\n$$\ns \\leftarrow s - u \\, d, \\quad d \\leftarrow d + p \\, s,\n$$\n然后交织 $s$ 和 $d$ 以重构输出。\n\n你的具体任务是：\n\n1. 实现一个两阶段提升方案，通过选择预测系数 $p = 1$ 和更新系数 $u = \\tfrac{1}{2}$，以及单位缩放因子 $\\kappa = 1$，来实现 Haar CQF 滤波器组。通过奇偶分裂、一个预测步骤和一个更新步骤来执行分析；通过逆更新和逆预测，然后交织奇偶部分以获得重构输出来执行综合。\n\n2. 使用此分析-综合链处理形式为 $x[n] = e^{j \\omega n}$ 的复值正弦测试信号，其中角频率 $\\omega$ 以弧度为单位是固定的。因为临界采样的双通道系统是周期为 $2$ 的线性周期时变系统，你可以假设输出具有以下形式：\n$$\ny[n] = \\frac{1}{2}\\left(T_0\\left(e^{j\\omega}\\right) e^{j\\omega n} + T_1\\left(e^{j\\omega}\\right) (-1)^n e^{j\\omega n}\\right).\n$$\n\n3. 对于给定的 $\\omega$，通过将 $y[n]$ 投影到 $e^{j\\omega n}$ 和 $(-1)^n e^{j\\omega n}$ 上，来数值化地估计混叠传递函数 $T_1\\left(e^{j\\omega}\\right)$。具体来说，定义\n$$\nc_1(\\omega) \\triangleq \\frac{1}{N} \\sum_{n=0}^{N-1} y[n] \\, e^{-j \\omega n} \\, (-1)^n,\n$$\n对于一个长度为 $N$ 的偶数长度信号。对于偶数 $N$，$\\frac{1}{N}\\sum_{n=0}^{N-1} (-1)^n = 0$，由此可得 $c_1(\\omega) = \\tfrac{1}{2} T_1\\left(e^{j\\omega}\\right)$。因此，你可以估计\n$$\n\\widehat{T}_1\\left(e^{j\\omega}\\right) = 2 \\, c_1(\\omega).\n$$\n对每个测试频率使用这个估计量。\n\n4. 通过检查 $\\left|\\widehat{T}_1\\left(e^{j\\omega}\\right)\\right|$ 是否低于指定的容差 $\\epsilon$，来数值验证 $T_1\\left(e^{j\\omega}\\right) = 0$。\n\n实现要求：\n\n- 使用周期性复指数 $x[n] = e^{j \\omega n}$ 作为测试信号，其中 $\\omega$ 以弧度为单位。不涉及物理单位，但你必须以弧度处理角度。\n- 使用偶数信号长度 $N = 4096$。\n- 使用预测系数 $p = 1$，更新系数 $u = \\tfrac{1}{2}$，以及缩放因子 $\\kappa = 1$。\n- 使用数值容差 $\\epsilon = 10^{-10}$。\n\n测试套件：\n\n- 使用以下角频率，均以弧度为单位：$\\omega_1 = 0$、$\\omega_2 = \\tfrac{\\pi}{2}$ 和 $\\omega_3 = \\pi - 10^{-2}$。\n- 对于每个 $\\omega_i$，计算 $\\widehat{T}_1\\left(e^{j\\omega_i}\\right)$ 并测试是否 $\\left|\\widehat{T}_1\\left(e^{j\\omega_i}\\right)\\right| < \\epsilon$。\n\n最终输出格式：\n\n- 你的程序应产生单行输出，其中包含三个布尔结果（按 $\\omega_1$、$\\omega_2$、$\\omega_3$ 的顺序），形式为用方括号括起来的逗号分隔列表。例如，一个可接受的格式是 $[\\text{True},\\text{False},\\text{True}]$。\n- 不应产生任何其他输出。", "solution": "所提出的问题是验证一个特定的双通道共轭正交滤波器（CQF）组（即 Haar 滤波器组）的混叠消除特性，该滤波器组通过两阶段提升方案实现。这个任务在科学上是合理的、适定的，并且基于多速率信号处理的基本原理。所提供的参数和方法是完整且一致的。我们将继续进行形式化的求解。\n\n问题的核心在于一个临界采样的双通道滤波器组的分析-综合结构。提升方案通过对输入信号的多相分量进行操作，为这种滤波器组提供了一种高效的实现方式。\n\n首先，我们形式化提升操作。设输入信号为 $x[n]$。其多相表示由偶数索引分量 $s_0[k] = x[2k]$ 和奇数索引分量 $d_0[k] = x[2k+1]$ 组成。\n\n分析阶段将多相分量 $(s_0, d_0)$ 变换为子带分量 $(s_1, d_1)$，由一系列预测和更新步骤描述。\n1.  **预测步骤**：从偶数分量 $s_0[k]$ 形成对奇数分量 $d_0[k]$ 的预测。预测误差构成了高通子带信号 $d_1[k]$。使用给定的预测系数 $p=1$，该操作为：\n    $$\n    d_1[k] = d_0[k] - p \\cdot s_0[k] = d_0[k] - s_0[k]\n    $$\n2.  **更新步骤**：使用新计算的高通信号 $d_1[k]$ 更新偶数分量 $s_0[k]$，以生成低通子带信号 $s_1[k]$。此步骤旨在在低通通道中保持某些信号属性，如局部均值。使用更新系数 $u = \\frac{1}{2}$，我们有：\n    $$\n    s_1[k] = s_0[k] + u \\cdot d_1[k] = s_0[k] + \\frac{1}{2} d_1[k]\n    $$\n问题指定了单位缩放因子 $\\kappa=1$，因此不需要对 $s_1[k]$ 和 $d_1[k]$ 进行进一步操作。\n\n综合阶段反转这些操作，以完美重构原始信号。\n1.  **逆更新**：从子带信号 $(s_1, d_1)$ 中恢复原始偶数分量 $s_0[k]$：\n    $$\n    s_{0}^{\\text{rec}}[k] = s_1[k] - u \\cdot d_1[k] = s_1[k] - \\frac{1}{2} d_1[k]\n    $$\n    验证表明此步骤确实是可逆的：$(s_0[k] + \\frac{1}{2} d_1[k]) - \\frac{1}{2} d_1[k] = s_0[k]$。\n2.  **逆预测**：使用高通信号 $d_1[k]$ 和已恢复的偶数分量 $s_{0}^{\\text{rec}}[k]$ 恢复原始奇数分量 $d_0[k]$：\n    $$\n    d_{0}^{\\text{rec}}[k] = d_1[k] + p \\cdot s_{0}^{\\text{rec}}[k] = d_1[k] + s_{0}^{\\text{rec}}[k]\n    $$\n    验证证实了这一点：$(d_0[k] - s_0[k]) + s_0[k] = d_0[k]$。\n\n重构信号 $y[n]$ 是通过交织已恢复的多相分量形成的：$y[2k] = s_{0}^{\\text{rec}}[k]$ 和 $y[2k+1] = d_{0}^{\\text{rec}}[k]$。由于所有步骤都是完全可逆的，我们期望在没有数值误差的情况下 $y[n] = x[n]$。\n\n问题要求我们验证混叠传递函数 $T_1(e^{j\\omega})$ 为零。对于一个正弦输入 $x[n] = e^{j\\omega n}$，一个通用的双通道系统的输出由下式给出：\n$$\ny[n] = \\frac{1}{2}\\left(T_0\\left(e^{j\\omega}\\right) e^{j\\omega n} + T_1\\left(e^{j\\omega}\\right) (-1)^n e^{j\\omega n}\\right)\n$$\n为了估计 $T_1(e^{j\\omega})$，我们使用提供的估计量，该估计量源自复指数在偶数长度区间 $N$ 上的正交性：\n$$\n\\widehat{T}_1(e^{j\\omega}) = \\frac{2}{N} \\sum_{n=0}^{N-1} y[n] e^{-j\\omega n} (-1)^n\n$$\n如果对于一个小的容差 $\\epsilon = 10^{-10}$，有 $|\\widehat{T}_1(e^{j\\omega})| < \\epsilon$，则数值上验证了混叠消除。\n\n对于每个测试频率 $\\omega_i$ 的步骤如下：\n1.  生成长度为 $N=4096$ 的复正弦输入信号向量 $x$，其中 $x[n] = e^{j\\omega_i n}$。\n2.  通过将 $x$ 分裂为奇偶部分，然后使用 $p=1$ 和 $u=0.5$ 应用预测和更新步骤，来执行分析阶段。\n3.  通过应用逆更新和逆预测步骤，然后交织结果以获得输出信号 $y$，来执行综合阶段。\n4.  使用信号 $y$ 和提供的公式计算估计值 $\\widehat{T}_1(e^{j\\omega_i})$。\n5.  将估计值的绝对值与容差 $\\epsilon$ 进行比较，以确定布尔结果。\n\n整个过程将对三个指定的角频率实施：$\\omega_1 = 0$、$\\omega_2 = \\frac{\\pi}{2}$ 和 $\\omega_3 = \\pi - 10^{-2}$。理论预期是混叠被完美消除，因此任何计算出的 $\\widehat{T}_1$ 值都将仅仅是由于浮点算术误差，并且应该远低于容差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a two-channel CQF bank via a two-stage lifting scheme\n    to verify numerical aliasing cancellation.\n    \"\"\"\n    \n    # Define problem parameters\n    N = 4096  # Signal length (must be even)\n    p = 1.0   # Predictor coefficient\n    u = 0.5   # Updater coefficient\n    epsilon = 1e-10  # Numerical tolerance for aliasing cancellation\n\n    # Define the test suite of angular frequencies in radians\n    test_omegas = [\n        0.0,\n        np.pi / 2.0,\n        np.pi - 1e-2\n    ]\n\n    results = []\n\n    for omega in test_omegas:\n        # 1. Generate the complex sinusoidal input signal\n        n = np.arange(N)\n        x = np.exp(1j * omega * n)\n\n        # 2. Analysis stage (Lifting)\n        # Even-odd split (polyphase decomposition)\n        s0 = x[0::2]\n        d0 = x[1::2]\n\n        # Predict step\n        d1 = d0 - p * s0\n        \n        # Update step\n        s1 = s0 + u * d1\n\n        # The subband signals are s1 (low-pass) and d1 (high-pass).\n\n        # 3. Synthesis stage (Inverse Lifting)\n        # Inverse update step\n        s0_rec = s1 - u * d1\n        \n        # Inverse predict step\n        d0_rec = d1 + p * s0_rec\n\n        # Interleave to reconstruct the output signal\n        y = np.empty_like(x, dtype=np.complex128)\n        y[0::2] = s0_rec\n        y[1::2] = d0_rec\n        \n        # 4. Estimate the alias transfer function T1(e^jω)\n        # The estimator is T1_hat = 2 * c1(ω), where\n        # c1(ω) = (1/N) * sum_{n=0}^{N-1} y[n] * e^{-jωn} * (-1)^n\n        \n        # Create the modulation term (-1)^n\n        mod_signal = np.power(-1.0, n)\n        \n        # Create the analysis sinusoid e^{-jωn}\n        analysis_signal = np.exp(-1j * omega * n) # or np.conj(x)\n        \n        # Compute c1(ω)\n        c1 = (1.0 / N) * np.sum(y * analysis_signal * mod_signal)\n        \n        # Compute the estimate of T1\n        T1_est = 2.0 * c1\n        \n        # 5. Verify aliasing cancellation\n        # Check if the magnitude of the estimated alias transfer function\n        # is below the specified tolerance.\n        is_cancelled = np.abs(T1_est)  epsilon\n        results.append(is_cancelled)\n\n    # Format the final output as a comma-separated list of booleans\n    # enclosed in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2915687"}]}