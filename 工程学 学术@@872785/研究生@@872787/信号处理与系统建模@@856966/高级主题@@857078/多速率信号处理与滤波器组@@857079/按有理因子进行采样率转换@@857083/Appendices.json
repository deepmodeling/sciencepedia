{"hands_on_practices": [{"introduction": "我们的动手实践将从一个基本问题开始。当我们改变信号的采样率时，其感知频率会如何变化？本练习将使用一个简单的余弦波，在一个理想的有理数倍率转换器中，演示频率调整的核心原理，为后续更复杂的课题打下坚实的基础。", "problem": "在一个数字信号处理 (DSP) 应用中，一个由离散时间信号 $x[n] = \\cos\\left(\\frac{3\\pi n}{11}\\right)$ 表示的测试音必须被转换到不同的采样率。该信号通过一个采样率转换器，该转换器以一个有理因子改变采样率。\n\n转换过程包括两个阶段。首先，信号通过一个整数因子 $L=3$ 进行上采样。此操作在 $x[n]$ 的每对连续样本之间插入 $L-1$ 个零值样本。得到的信号随后通过一个理想低通滤波器，该滤波器增益为 $L$，截止频率为每样本 $\\frac{\\pi}{L}$ 弧度。\n\n在第二阶段，滤波后的信号通过一个整数因子 $M=5$ 进行下采样。这个抽取过程通过仅保留第一阶段信号的每第 $M$ 个样本来创建最终的输出信号 $y[n]$。\n\n假设该过程是理想的，并且在下采样阶段没有发生混叠，确定输出信号 $y[n]$ 的基波角频率。请将您的答案表示为每样本弧度，并写成 $\\pi$ 的有理数倍。", "solution": "设输入为 $x[n]=\\cos(\\omega_{0}n)$，其中 $\\omega_{0}=\\frac{3\\pi}{11}$。\n\n阶段1（以 $L=3$ 进行上采样和理想插值）：插入 $L-1$ 个零点会得到一个频谱 $X_{u}(\\mathrm{e}^{\\mathrm{j}\\omega})=X(\\mathrm{e}^{\\mathrm{j}\\omega L})$，这会将频率压缩 $L$ 倍。增益为 $L$、截止频率为 $\\frac{\\pi}{L}$ 的理想低通滤波器会移除镜像并恢复幅度，从而产生一个频率被缩放 $\\frac{1}{L}$ 倍的插值序列。因此，阶段1的输出是\n$$\nv[n]=\\cos\\!\\left(\\frac{\\omega_{0}}{L}\\,n\\right)=\\cos\\!\\left(\\frac{\\pi}{11}\\,n\\right),\n$$\n所以中间角频率是\n$$\n\\omega_{1}=\\frac{\\omega_{0}}{L}=\\frac{\\pi}{11}.\n$$\n\n阶段2（以 $M=5$ 进行下采样）：下采样保留每第 $M$ 个样本，所以\n$$\ny[n]=v[nM]=\\cos\\!\\left(\\omega_{1}Mn\\right)=\\cos\\!\\left(\\frac{M}{L}\\,\\omega_{0}\\,n\\right).\n$$\n抽取下的频率映射为 $\\omega\\mapsto M\\omega$ 模 $2\\pi$。无混叠条件要求 $|\\omega_{1}|  \\frac{\\pi}{M}$，此条件成立，因为\n$$\n|\\omega_{1}|=\\frac{\\pi}{11}  \\frac{\\pi}{5}.\n$$\n因此，输出的基波角频率是\n$$\n\\omega_{y}=\\frac{M}{L}\\,\\omega_{0}=\\frac{5}{3}\\cdot\\frac{3\\pi}{11}=\\frac{5\\pi}{11},\n$$\n该值位于 $(0,\\pi)$ 区间内，因此不需要进行模运算。", "answer": "$$\\boxed{\\frac{5\\pi}{11}}$$", "id": "1750703"}, {"introduction": "直接实现“升采样-滤波-降采样”的流程在计算上是昂贵的。高效设计的关键在于对FIR滤波器进行多相分解。这个练习将带你亲手操作，将一个给定的滤波器分解为其多相分量，揭示实现高效速率转换的底层结构。[@problem_id:1750703]", "problem": "考虑一个因果有限冲激响应滤波器，其传递函数 $H(z)$ 由下式给出\n$$\nH(z) \\;=\\; \\sum_{n=0}^{12} h[n]\\, z^{-n},\n$$\n其中冲激响应系数 $\\{h[n]\\}$ 为\n$$\n\\{h[n]\\}_{n=0}^{12} \\;=\\; \\{\\, 0.0040,\\; -0.0120,\\; 0.0280,\\; 0.0800,\\; 0.1350,\\; 0.1650,\\; 0.1800,\\; 0.1650,\\; 0.1350,\\; 0.0800,\\; 0.0280,\\; -0.0120,\\; 0.0040 \\,\\}.\n$$\n在按有理数因子进行采样率转换的背景下，一个内插因子为 $L$ 的多相实现通过基于索引模 $L$ 的方式将系数 $\\{h[n]\\}$ 分配到 $L$ 个分支，从而将 $H(z)$ 分割成 $L$ 个子滤波器。仅从z变换、有限冲激响应滤波以及均匀模索引划分的概念出发，通过显式构造满足内插多相关系的四个多相分量 $E_{0}(z)$、$E_{1}(z)$、$E_{2}(z)$ 和 $E_{3}(z)$，来推导内插因子 $L=4$ 的多相分解。请清楚地展示索引映射如何将系数分配给每个分支。\n\n请将最终答案表示为一个行向量，按顺序包含四个多项式 $E_{0}(z)$、$E_{1}(z)$、$E_{2}(z)$ 和 $E_{3}(z)$。无需四舍五入；请使用上面给出的精确小数值。最终答案应为以 $z$ 为变量的单个闭式解析表达式。", "solution": "我们从z变换和有限冲激响应滤波的定义开始。一个因果有限冲激响应滤波器由一组有限的冲激响应系数 $\\{h[n]\\}$ 指定，其传递函数为\n$$\nH(z) \\;=\\; \\sum_{n=0}^{N-1} h[n]\\, z^{-n}.\n$$\n在这里，我们有 $N=13$ 以及给定的 $h[n]$，其中 $n\\in\\{0,1,\\dots,12\\}$。\n\n对于按整数因子 $L$ 进行的内插，多相实现通过将索引集 $\\{0,1,\\dots,N-1\\}$ 划分成模 $L$ 的剩余类，来将滤波器系数重组为 $L$ 个子滤波器。具体来说，对于 $L=4$，索引根据其模4的余数进行划分。基本步骤是通过将 $n$ 表示为以下形式，来重写关于 $n$ 的单个求和\n$$\nn \\;=\\; 4m + k, \\quad \\text{with} \\quad k \\in \\{0,1,2,3\\}, \\quad m \\in \\mathbb{Z}_{\\ge 0},\n$$\n并满足条件 $4m+k \\le N-1$。将此代入 $H(z)$ 中，得到\n$$\nH(z)\n\\;=\\;\n\\sum_{n=0}^{N-1} h[n]\\, z^{-n}\n\\;=\\;\n\\sum_{k=0}^{3} \\sum_{m \\,\\ge\\, 0:\\, 4m+k \\le N-1} h[\\,4m + k\\,]\\, z^{-(4m + k)}.\n$$\n我们提出因子 $z^{-k}$，并将剩余的 $z^{-4}$ 的幂组合在一起：\n$$\nH(z)\n\\;=\\;\n\\sum_{k=0}^{3} z^{-k} \\left( \\sum_{m \\,\\ge\\, 0:\\, 4m+k \\le N-1} h[\\,4m + k\\,]\\, (z^{-4})^{m} \\right).\n$$\n通过下式定义第 $k$ 个多相分量\n$$\nE_{k}(z) \\;=\\; \\sum_{m \\,\\ge\\, 0:\\, 4m+k \\le N-1} h[\\,4m + k\\,]\\, z^{-m},\n$$\n我们得到（用于内插的标准形式的）多相分解为\n$$\nH(z) \\;=\\; \\sum_{k=0}^{3} z^{-k}\\, E_{k}\\!\\left(z^{4}\\right).\n$$\n这个构造过程展示了系数是如何分配的：索引为 $k$ 的分支收集所有原始索引与 $k$ 模4同余的系数，并按 $m$ 的递增顺序将它们放入 $E_{k}(z)$ 中，其中 $m = (n-k)/4$。\n\n现在我们将此方法应用于给定的 $h[n]$，其中 $N=13$ 且 $L=4$。\n\n- 分支 $k=0$ 取索引 $n \\in \\{0,4,8,12\\}$，对应于 $m \\in \\{0,1,2,3\\}$：\n  - $h[0] = 0.0040$ 成为 $E_{0}(z)$ 中 $z^{0}$ 的系数。\n  - $h[4] = 0.1350$ 成为 $z^{-1}$ 的系数。\n  - $h[8] = 0.1350$ 成为 $z^{-2}$ 的系数。\n  - $h[12] = 0.0040$ 成为 $z^{-3}$ 的系数。\n  因此，\n  $$\n  E_{0}(z) \\;=\\; 0.0040 \\;+\\; 0.1350\\, z^{-1} \\;+\\; 0.1350\\, z^{-2} \\;+\\; 0.0040\\, z^{-3}.\n  $$\n\n- 分支 $k=1$ 取索引 $n \\in \\{1,5,9\\}$，对应于 $m \\in \\{0,1,2\\}$：\n  - $h[1] = -0.0120$ 成为 $E_{1}(z)$ 中 $z^{0}$ 的系数。\n  - $h[5] = 0.1650$ 成为 $z^{-1}$ 的系数。\n  - $h[9] = 0.0800$ 成为 $z^{-2}$ 的系数。\n  因此，\n  $$\n  E_{1}(z) \\;=\\; -0.0120 \\;+\\; 0.1650\\, z^{-1} \\;+\\; 0.0800\\, z^{-2}.\n  $$\n\n- 分支 $k=2$ 取索引 $n \\in \\{2,6,10\\}$，对应于 $m \\in \\{0,1,2\\}$：\n  - $h[2] = 0.0280$ 成为 $E_{2}(z)$ 中 $z^{0}$ 的系数。\n  - $h[6] = 0.1800$ 成为 $z^{-1}$ 的系数。\n  - $h[10] = 0.0280$ 成为 $z^{-2}$ 的系数。\n  因此，\n  $$\n  E_{2}(z) \\;=\\; 0.0280 \\;+\\; 0.1800\\, z^{-1} \\;+\\; 0.0280\\, z^{-2}.\n  $$\n\n- 分支 $k=3$ 取索引 $n \\in \\{3,7,11\\}$，对应于 $m \\in \\{0,1,2\\}$：\n  - $h[3] = 0.0800$ 成为 $E_{3}(z)$ 中 $z^{0}$ 的系数。\n  - $h[7] = 0.1650$ 成为 $z^{-1}$ 的系数。\n  - $h[11] = -0.0120$ 成为 $z^{-2}$ 的系数。\n  因此，\n  $$\n  E_{3}(z) \\;=\\; 0.0800 \\;+\\; 0.1650\\, z^{-1} \\;-\\; 0.0120\\, z^{-2}.\n  $$\n\n这个显式构造验证了模索引映射：每个分支 $k$ 接收所有满足 $n \\equiv k \\pmod{4}$ 的系数 $h[n]$，并且它们在 $E_{k}(z)$ 中的位置以 $m = (n-k)/4$ 作为 $z^{-1}$ 的幂次。将这些 $E_{k}(z)$ 代入关系式 $H(z) = \\sum_{k=0}^{3} z^{-k} E_{k}(z^{4})$ 可以重构出原始的 $H(z)$，从而证实了分解的正确性。", "answer": "$$\\boxed{\\begin{pmatrix}\n0.0040 + 0.1350\\, z^{-1} + 0.1350\\, z^{-2} + 0.0040\\, z^{-3} \\\\\n-0.0120 + 0.1650\\, z^{-1} + 0.0800\\, z^{-2} \\\\\n0.0280 + 0.1800\\, z^{-1} + 0.0280\\, z^{-2} \\\\\n0.0800 + 0.1650\\, z^{-1} - 0.0120\\, z^{-2}\n\\end{pmatrix}}$$", "id": "2902294"}, {"introduction": "我们已经了解了如何构建多相滤波器结构[@problem_id:2902294]，但它究竟有多高效呢？这最后一个练习将通过比较朴素的直接型实现与经过多相优化的实现，来量化计算优势。通过计算两者的每秒运算次数，你将对为何多相结构在现代信号处理中不可或缺有一个切实的理解。", "problem": "一个离散时间系统使用一个长度为 $N$ 的理想化有限冲激响应（FIR）抗镜像和抗混叠滤波器（即具有 $N$ 个非零抽头且未利用系数对称性），以有理因子 $L/M$ 进行采样率转换。输入采样率为 $F_{\\text{in}}$。对于一组固定的整数 $L \\geq 2$，$M \\geq 2$，考虑该转换器的两种实现方式：\n\n1.  一种朴素的直接型结构，它显式地进行 $L$ 倍上采样（在输入样本之间插入 $L-1$ 个零），在更高的速率下进行滤波，然后进行 $M$ 倍下采样（每 $M$ 个样本保留一个），所有这些操作都不使用贵族恒等式或多相分解。\n2.  一种多相-贵族恒等式优化结构，它使用用于上采样和下采样的贵族恒等式以及 FIR 滤波器的 $L$ 分支多相分解，从而仅在最低的可行内部速率下计算必要的滤波器相位。\n\n仅从上采样、下采样和 FIR 滤波的卷积和的定义出发，推导每种实现方式的总乘法率（每秒乘法次数）的表达式。然后，对于 $L=7$，$M=5$，$N=301$ 和 $F_{\\text{in}}=96\\,\\mathrm{kHz}$，计算这些表达式的值。最后，计算定义为朴素直接型乘法率与多相-贵族恒等式乘法率之比的加速比。\n\n用 $\\mathrm{MAC/s}$（每秒乘法累加运算次数，每个抽头每产生一个样本计为一次乘法）表示两种乘法率，并用纯数表示加速比。提供精确的整数值，无需四舍五入。按顺序 $\\big($直接型 $\\mathrm{MAC/s}$，多相结构 $\\mathrm{MAC/s}$，加速比$\\big)$ 报告你的三个最终值。", "solution": "所提出的问题是数字信号处理中一个定义明确且具有科学依据的练习，要求分析一个有理因子采样率转换器两种不同实现的计算复杂度。它基于多速率系统的既定原理，包括上采样、下采样、FIR 滤波和多相分解。所有必要的参数都已提供，问题没有任何模糊或矛盾之处。因此，我们可以进行正式推导。\n\n设输入信号为 $x[n]$，采样率为 $F_{\\text{in}}$。系统必须将此速率转换 $L/M$ 倍。FIR 滤波器的冲激响应为 $h[n]$，长度为 $N$。\n\n首先，我们分析朴素的直接型实现。\n该结构按以下顺序执行操作：$L$ 倍上采样、FIR 滤波和 $M$ 倍下采样。\n$1$. $L$ 倍上采样：通过在 $x[n]$ 的连续样本之间插入 $L-1$ 个零值样本，创建一个中间信号 $x_u[m]$。$x_u[m]$ 的采样率变为 $F_{\\text{int}} = L \\times F_{\\text{in}}$。\n$2$. FIR 滤波：上采样后的信号 $x_u[m]$ 由长度为 $N$ 的 FIR 滤波器 $h[n]$ 进行滤波。滤波器的输出 $v[m]$ 由卷积和给出：\n$$v[m] = \\sum_{i=0}^{N-1} h[i] x_u[m-i]$$\n为了计算每个样本 $v[m]$，需要进行 $N$ 次乘法（因为我们计算每个滤波器抽头有一次乘法累加操作）。滤波器在中间采样率 $F_{\\text{int}}$ 下运行，每秒产生 $L \\times F_{\\text{in}}$ 个样本。因此，滤波器的总乘法率是每次采样的乘法次数与采样率的乘积。\n设 $R_1$ 为朴素实现的乘法率。\n$$R_1 = N \\times F_{\\text{int}} = N \\times (L \\times F_{\\text{in}}) = N L F_{\\text{in}}$$\n$3$. $M$ 倍下采样：滤波后的信号 $v[m]$通过每 $M$ 个样本保留一个样本的方式进行下采样，产生最终输出 $y[k] = v[kM]$。此操作不涉及乘法。\n\n因此，朴素直接型结构的总乘法率为 $R_1 = N L F_{\\text{in}}$。\n\n接下来，我们分析多相-贵族恒等式优化实现。\n这种结构利用多速率恒等式在较低的采样率下执行滤波。问题指定使用滤波器 $h[n]$ 的 $L$ 分支多相分解。\n$1$. 系统架构：整个系统是上采样（$\\uparrow L$）、滤波（$H(z)$）和下采样（$\\downarrow M$）的级联。\n$2$. $L$ 分支多相分解：滤波器的传递函数 $H(z) = \\sum_{n=0}^{N-1} h[n] z^{-n}$ 被分解为 $L$ 个多相分量 $E_k(z)$：\n$$H(z) = \\sum_{k=0}^{L-1} z^{-k} E_k(z^L)$$\n其中第 $k$ 个多相滤波器 $E_k(z)$ 的系数为 $e_k[n] = h[nL+k]$。滤波器 $E_k(z)$ 的长度为 $N_k = \\lceil (N-k)/L \\rceil$。\n$3$. 应用贵族恒等式：该系统可以写作 $y[p] = \\left( \\left( x[n] \\uparrow L \\right) * h[n] \\right) \\downarrow M$。代入 $h[n]$ 的多相展开式并分析一个输出样本 $y[p]$ 的信号路径，得出：\n$$y[p] = \\sum_{i=0}^{N-1} h[i] x_u[pM - i]$$\n其中 $x_u[\\cdot]$ 是上采样后的输入。设 $i = nL+k$，其中 $k \\in \\{0, 1, \\dots, L-1\\}$。\n$$y[p] = \\sum_{k=0}^{L-1} \\sum_{n} h[nL+k] x_u[pM - (nL+k)]$$\n项 $x_u[j]$ 仅当 $j$ 是 $L$ 的倍数时非零。因此，要有非零贡献，我们必须使 $pM - (nL+k)$ 是 $L$ 的倍数。这意味着 $pM - k$ 必须是 $L$ 的倍数，或者 $k \\equiv pM \\pmod{L}$。对于任意给定的输出索引 $p$，这个条件将 $k$ 固定为单个值 $k_p = pM \\pmod{L}$。\n设 $pM - k_p = n_p L$，由此得到 $n_p = (pM - k_p)/L = \\lfloor pM/L \\rfloor$。$y[p]$ 的求和坍缩为单个多相分支：\n$$y[p] = \\sum_{n} h[nL+k_p] x[n_p-n] = \\sum_{n} e_{k_p}[n] x[n_p-n] = (e_{k_p} * x)[n_p]$$\n这个方程揭示了，为了计算输出样本 $y[p]$，我们只需要在单个时间点 $n_p$ 计算单个多相滤波器 $E_{k_p}(z)$ 的输出。这个计算需要 $N_{k_p} = \\lceil (N-k_p)/L \\rceil$ 次乘法。滤波操作有效地发生在输入速率域，但仅在需要特定多相滤波器输出时才进行。\n\n为了求得平均乘法率 $R_2$，我们确定每个输出样本的平均乘法次数，并乘以输出采样率 $F_{\\text{out}} = F_{\\text{in}} \\frac{L}{M}$。\n使用的多相索引序列 $k_p = pM \\pmod{L}$ 关于 $p$ 是周期的。周期为 $P = L/\\text{gcd}(L,M)$。当 $\\text{gcd}(L,M)=1$ 时（如本题所示），周期为 $L$，序列 $\\{ pM \\pmod{L} \\}_{p=0}^{L-1}$ 是 $\\{0, 1, \\dots, L-1\\}$ 的一个排列。\n在 $L$ 个连续的输出样本中，$L$ 个多相滤波器中的每一个都恰好被使用一次。产生这 $L$ 个样本所需的总乘法次数是 $\\sum_{k=0}^{L-1} N_k = \\sum_{k=0}^{L-1} \\lceil (N-k)/L \\rceil$。可以证明这个和恰好等于 $N$。设 $N = qL+r$，其中 $0 \\le r  L$。\n$$\\sum_{k=0}^{L-1} \\lceil \\frac{N-k}{L} \\rceil = \\sum_{k=0}^{L-1} \\left( q + \\lceil \\frac{r-k}{L} \\rceil \\right) = qL + \\sum_{k=0}^{r-1}(1) + \\sum_{k=r}^{L-1}(0) = qL + r = N$$\n因此，为生成 $L$ 个输出样本执行了 $N$ 次乘法。每个输出样本的平均乘法次数是 $N/L$。\n总乘法率 $R_2$ 是：\n$$R_2 = \\left( \\frac{\\text{MACs}}{\\text{输出样本}} \\right) \\times \\left( \\frac{\\text{输出样本}}{\\text{秒}} \\right) = \\left(\\frac{N}{L}\\right) \\times F_{\\text{out}} = \\frac{N}{L} \\times \\left( F_{\\text{in}} \\frac{L}{M} \\right) = \\frac{N F_{\\text{in}}}{M}$$\n$R_2$ 的这个表达式是有效的，因为问题指定了 $L$ 分支分解且 $\\text{gcd}(L,M)=1$。\n\n最后，加速比 $S$ 是朴素乘法率与优化后速率的比值。\n$$S = \\frac{R_1}{R_2} = \\frac{N L F_{\\text{in}}}{N F_{\\text{in}} / M} = L M$$\n\n现在我们对给定值计算这些表达式：$L=7$, $M=5$, $N=301$, and $F_{\\text{in}}=96\\,\\mathrm{kHz} = 96000\\,\\mathrm{Hz}$。\n注意 $\\text{gcd}(7,5)=1$，验证了我们使用的简化公式的正确性。\n\n直接型乘法率：\n$$R_1 = N L F_{\\text{in}} = 301 \\times 7 \\times 96000 = 2107 \\times 96000 = 202,272,000 \\,\\mathrm{MAC/s}$$\n\n多相-贵族恒等式乘法率：\n$$R_2 = \\frac{N F_{\\text{in}}}{M} = \\frac{301 \\times 96000}{5} = 301 \\times 19200 = 5,779,200 \\,\\mathrm{MAC/s}$$\n\n加速比：\n$$S = L M = 7 \\times 5 = 35$$\n\n作为检验，我们可以计算速率之比：$S = \\frac{202,272,000}{5,779,200} = 35$。结果是一致的。\n\n三个最终值是直接型结构的 MAC/s、多相结构的 MAC/s 和加速比。", "answer": "$$\\boxed{\\begin{pmatrix} 202272000  5779200  35 \\end{pmatrix}}$$", "id": "2902270"}]}