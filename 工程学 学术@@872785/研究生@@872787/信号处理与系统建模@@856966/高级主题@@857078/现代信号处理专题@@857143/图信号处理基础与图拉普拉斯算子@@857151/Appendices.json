{"hands_on_practices": [{"introduction": "要真正掌握图拉普拉斯算子，从基本定义出发进行推导是至关重要的一步。这个练习将指导你为一个基本但极其重要的图结构——路径图——构建其拉普拉斯矩阵。你将从节点-边关联矩阵 $B$ 开始，通过矩阵乘法 $L = B^{\\top} B$ 推导出拉普拉斯算子 $L$ 的具体形式，并最终求解其代数连通度[@problem_id:2903901]。这项实践旨在加深你对图的组合结构、代数表示以及谱特性之间内在联系的理解。", "problem": "考虑一个包含 $n \\geq 2$ 个标记节点 $\\{1,2,\\dots,n\\}$ 的无向、无权路径图，其边集为 $\\{(1,2),(2,3),\\dots,(n-1,n)\\}$。通过将每条边从索引较小的节点指向索引较大的节点，为其赋予一个任意的方向。令 $B \\in \\mathbb{R}^{(n-1) \\times n}$ 表示由该方向决定的节点-边关联矩阵，其中每行对应一条边，每列对应一个节点，矩阵元素 $-1$、$+1$ 和 $0$ 分别表示边的起点、终点和非关联情况。\n\n仅使用关联矩阵的基本定义以及非归一化图拉普拉斯算子 $L$ 的定义 $L = B^{\\top} B$，完成以下任务：\n\n1. 为路径图的给定方向显式地构造矩阵 $B$，并从 $B^{\\top} B$ 导出 $L$ 的显式三对角结构。你的推导必须从 $B$ 和 $L$ 的定义出发，并且只使用线性代数运算，不得引用任何预先记忆的 $L$ 公式。\n\n2. 从得到的 $L$ 的三对角形式，推导代数连通度的闭式表达式，代数连通度定义为 $L$ 的第二小特征值。你的推导必须从三对角矩阵的特征值方程开始，并遵循第一性原理（例如，通过求解带有适当边界条件的相关线性递推关系）。\n\n请以关于 $n$ 的单个精确解析表达式的形式给出你的最终答案。不要进行近似计算，也不要包含任何单位。如果引入任何角度，必须以弧度为单位。最终答案必须是单个表达式，而非不等式或方程。", "solution": "所述问题在数学上是良定义的、自洽的，并且在科学上是合理的。它提出了一个谱图理论中的标准问题，该问题存在唯一且可验证的解。因此，我们着手进行推导。\n\n问题需要分两部分进行推导。第一部分，从关联矩阵 $B$ 构造图拉普拉斯矩阵 $L$。第二部分，通过求解 $L$ 的特征值问题推导其代数连通度。\n\n第一部分：拉普拉斯矩阵 $L$ 的推导\n\n该图是一个包含 $n$ 个节点的无权路径图，我们将其标记为 $\\{1, 2, \\dots, n\\}$。其边集为 $\\{(k, k+1) \\mid k = 1, 2, \\dots, n-1\\}$。共有 $m = n-1$ 条边。通过将每条边从节点 $k$ 指向节点 $k+1$ 来赋予一个方向。\n\n关联矩阵 $B \\in \\mathbb{R}^{(n-1) \\times n}$ 的行由边索引，列由节点索引。令第 $k$ 条边为 $e_k = (k, k+1)$，其中 $k$ 是起点，$k+1$ 是终点。$B$ 的元素定义如下：\n$B_{k,j} = -1$ 如果节点 $j$ 是边 $e_k$ 的起点，\n$B_{k,j} = +1$ 如果节点 $j$ 是边 $e_k$ 的终点，\n$B_{k,j} = 0$ 否则。\n\n对于第 $k$ 行，对应于边 $e_k = (k, k+1)$，非零元素位于第 $j=k$ 列和第 $j=k+1$ 列。具体来说，对于 $k \\in \\{1, \\dots, n-1\\}$：\n$$\nB_{k,j} = \\begin{cases}\n-1  \\text{if } j=k \\\\\n+1  \\text{if } j=k+1 \\\\\n0   \\text{otherwise}\n\\end{cases}\n$$\n非归一化图拉普拉斯算子定义为 $L = B^{\\top}B$。$L$ 是一个 $n \\times n$ 矩阵，其元素 $L_{ij}$ 是 $B$ 的第 $i$ 列和第 $j$ 列的点积。令 $\\mathbf{b}_j \\in \\mathbb{R}^{n-1}$ 为 $B$ 的第 $j$ 列。则 $L_{ij} = \\mathbf{b}_i^{\\top}\\mathbf{b}_j$。\n\n我们现在确定 $B$ 的列结构：\n- 第一列 $\\mathbf{b}_1$ 对应于节点 1。节点 1 仅是边 $e_1=(1,2)$ 的起点。因此，$\\mathbf{b}_1$ 在第一行有一个 $-1$，其余位置为零。\n- 对于 $j \\in \\{2, \\dots, n-1\\}$ 的一般列 $\\mathbf{b}_j$ 对应于内部节点 $j$。节点 $j$ 是边 $e_{j-1}=(j-1, j)$ 的终点，也是边 $e_j=(j, j+1)$ 的起点。因此，$\\mathbf{b}_j$ 在第 $j-1$ 行有一个 $+1$，在第 $j$ 行有一个 $-1$，其余位置为零。\n- 最后一列 $\\mathbf{b}_n$ 对应于节点 $n$。节点 $n$ 仅是边 $e_{n-1}=(n-1, n)$ 的终点。因此，$\\mathbf{b}_n$ 在最后一行（第 $n-1$ 行）有一个 $+1$，其余位置为零。\n\n现在我们计算 $L = (L_{ij})$ 的元素：\n\n1.  对角元素 ($i=j$): $L_{ii} = \\mathbf{b}_i^{\\top}\\mathbf{b}_i$。\n    - 对于 $i=1$: $L_{11} = \\mathbf{b}_1^{\\top}\\mathbf{b}_1 = (-1)^2 = 1$。\n    - 对于 $i \\in \\{2, \\dots, n-1\\}$: $L_{ii} = \\mathbf{b}_i^{\\top}\\mathbf{b}_i = (+1)^2 + (-1)^2 = 2$。\n    - 对于 $i=n$: $L_{nn} = \\mathbf{b}_n^{\\top}\\mathbf{b}_n = (+1)^2 = 1$。\n    $L$ 的对角线是 $(1, 2, 2, \\dots, 2, 1)$。\n\n2.  非对角元素 ($i \\neq j$): $L_{ij} = \\mathbf{b}_i^{\\top}\\mathbf{b}_j$。\n    - 对于相邻节点，$j=i+1$：我们计算 $L_{i, i+1} = \\mathbf{b}_i^{\\top}\\mathbf{b}_{i+1}$。\n        - 对于 $i=1$：$\\mathbf{b}_1$ 在第 1 行有一个 $-1$。$\\mathbf{b}_2$ 在第 1 行有一个 $+1$。它们的支撑集仅在第 1 行重叠。$L_{12} = (-1)(+1) = -1$。\n        - 对于 $i \\in \\{2, \\dots, n-2\\}$：$\\mathbf{b}_i$ 在第 $i-1$ 行和第 $i$ 行有非零元素。$\\mathbf{b}_{i+1}$ 在第 $i$ 行和第 $i+1$ 行有非零元素。它们的支撑集仅在第 $i$ 行重叠。$\\mathbf{b}_i$ 在第 $i$ 行的元素是 $-1$，$\\mathbf{b}_{i+1}$ 在第 $i$ 行的元素是 $+1$。因此，$L_{i, i+1} = (-1)(+1) = -1$。\n        - 对于 $i=n-1$：$\\mathbf{b}_{n-1}$ 在第 $n-2$ 行和第 $n-1$ 行有非零元素。$\\mathbf{b}_n$ 在第 $n-1$ 行有非零元素。它们的支撑集仅在第 $n-1$ 行重叠。$\\mathbf{b}_{n-1}$ 在第 $n-1$ 行的元素是 $-1$，$\\mathbf{b}_n$ 的元素是 $+1$。因此，$L_{n-1,n} = (-1)(+1) = -1$。\n    - 由于 $L$ 是对称的，$L_{i+1, i} = L_{i, i+1} = -1$。\n    - 对于不相邻的节点，$|i-j| > 1$：列向量 $\\mathbf{b}_i$ 和 $\\mathbf{b}_j$ 的非零元素位于不相交的行集合中。因此，它们的点积为零。$L_{ij} = 0$。\n\n综合这些结果，拉普拉斯矩阵 $L$ 是一个 $n \\times n$ 的对称三对角矩阵：\n$$\nL = \\begin{pmatrix}\n1  -1  0  \\cdots  0  0 \\\\\n-1  2  -1  \\cdots  0  0 \\\\\n0  -1  2  \\cdots  0  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\cdots  2  -1 \\\\\n0  0  0  \\cdots  -1  1\n\\end{pmatrix}\n$$\n\n第二部分：代数连通度的推导\n\n代数连通度是 $L$ 的第二小特征值。我们必须求解特征值方程 $L\\mathbf{v} = \\lambda\\mathbf{v}$，其中 $\\mathbf{v} = [v_1, v_2, \\dots, v_n]^{\\top}$ 是特征向量，$\\lambda$ 是其对应的特征值。这个矩阵方程代表一个包含 $n$ 个线性方程的方程组。\n\n- 第 1 行: $v_1 - v_2 = \\lambda v_1 \\implies (1-\\lambda)v_1 - v_2 = 0$\n- 第 $k$ 行 ($1  k  n$): $-v_{k-1} + 2v_k - v_{k+1} = \\lambda v_k \\implies -v_{k-1} + (2-\\lambda)v_k - v_{k+1} = 0$\n- 第 $n$ 行: $-v_{n-1} + v_n = \\lambda v_n \\implies -v_{n-1} + (1-\\lambda)v_n = 0$\n\n内部节点的方程定义了一个二阶线性齐次递推关系：$v_{k+1} - (2-\\lambda)v_k + v_{k-1} = 0$。第一个和最后一个方程作为边界条件。\n\n我们可以通过定义“虚点”$v_0$ 和 $v_{n+1}$ 来统一这些方程。\n在 $k=1$ 处的边界方程是 $v_2 = (1-\\lambda)v_1$。对于 $k=1$ 的一般递推式将是 $v_2 - (2-\\lambda)v_1 + v_0 = 0$。代入 $v_2$，我们得到 $(1-\\lambda)v_1 - (2-\\lambda)v_1 + v_0 = 0$，化简后为 $-v_1 + v_0 = 0$，即 $v_0 = v_1$。\n类似地，在 $k=n$ 处的边界方程是 $v_{n-1} = (1-\\lambda)v_n$。对于 $k=n$ 的一般递推式将是 $v_{n+1} - (2-\\lambda)v_n + v_{n-1} = 0$。代入 $v_{n-1}$，我们得到 $v_{n+1} - (2-\\lambda)v_n + (1-\\lambda)v_n = 0$，化简后为 $v_{n+1} - v_n = 0$，即 $v_{n+1} = v_n$。\n\n因此，问题等价于求解递推关系 $v_{k+1} - (2-\\lambda)v_k + v_{k-1} = 0$（对于 $k=1, \\dots, n$），并满足诺伊曼型边界条件 $v_0 = v_1$ 和 $v_{n+1} = v_n$。\n\n令 $2-\\lambda = 2\\cos(\\theta)$，对于某个 $\\theta$。递推关系变为 $v_{k+1} - 2\\cos(\\theta)v_k + v_{k-1} = 0$。其特征方程为 $r^2 - 2\\cos(\\theta)r + 1 = 0$，根为 $r = e^{\\pm i\\theta}$。通解的形式为 $v_k = A \\cos(k\\theta) + B \\sin(k\\theta)$。\n对于 $v_0=v_1$ 和 $v_n=v_{n+1}$ 形式的边界条件，一个更方便的解的形式是 $v_k = C\\cos((k-1/2)\\theta)$。\n我们来验证第一个条件：$v_1 = C\\cos(\\theta/2)$ 且 $v_0 = C\\cos(-\\theta/2) = C\\cos(\\theta/2)$。所以 $v_0=v_1$ 对任何 $\\theta$ 都成立。\n\n现在我们应用第二个边界条件，$v_{n+1} = v_n$：\n$$ C\\cos\\left(\\left(n+1-\\frac{1}{2}\\right)\\theta\\right) = C\\cos\\left(\\left(n-\\frac{1}{2}\\right)\\theta\\right) $$\n$$ \\cos\\left(\\left(n+\\frac{1}{2}\\right)\\theta\\right) = \\cos\\left(\\left(n-\\frac{1}{2}\\right)\\theta\\right) $$\n这个等式成立的条件是 $\\left(n+\\frac{1}{2}\\right)\\theta = \\pm \\left(n-\\frac{1}{2}\\right)\\theta + 2\\pi j$，其中 $j$ 为某个整数。\n- 情况1：$\\left(n+\\frac{1}{2}\\right)\\theta = \\left(n-\\frac{1}{2}\\right)\\theta + 2\\pi j \\implies \\theta = 2\\pi j$。这得到 $\\lambda = 2 - 2\\cos(2\\pi j) = 0$。这对应于最小特征值 $\\lambda_1 = 0$，其特征向量是常数向量 $[1, 1, \\dots, 1]^{\\top}$。\n- 情况2：$\\left(n+\\frac{1}{2}\\right)\\theta = -\\left(n-\\frac{1}{2}\\right)\\theta + 2\\pi j \\implies 2n\\theta = 2\\pi j \\implies \\theta = \\frac{\\pi j}{n}$。\n\n通过取 $j = 0, 1, \\dots, n-1$，我们得到一组 $n$ 个不同的特征值。特征值 $\\lambda_j$ 由下式给出：\n$$ \\lambda_j = 2 - 2\\cos(\\theta_j) = 2 - 2\\cos\\left(\\frac{\\pi j}{n}\\right) \\quad \\text{for } j=0, 1, \\dots, n-1. $$\n函数 $\\cos(x)$ 在 $x \\in [0, \\pi]$ 上是严格递减的。我们的参数 $\\frac{\\pi j}{n}$ 位于范围 $[0, \\pi - \\pi/n]$ 内。因此，随着 $j$ 的增加，$\\cos(\\frac{\\pi j}{n})$ 减小，而 $\\lambda_j$ 增加。特征值由索引 $j$ 自然排序。\n\n最小的特征值对应于 $j=0$：$\\lambda_0 = 2 - 2\\cos(0) = 0$。\n第二小的特征值，即代数连通度，对应于 $j=1$：\n$$ \\lambda_1 = 2 - 2\\cos\\left(\\frac{\\pi}{n}\\right) $$\n这就是所要求的表达式。", "answer": "$$\n\\boxed{2 - 2\\cos\\left(\\frac{\\pi}{n}\\right)}\n$$", "id": "2903901"}, {"introduction": "对于大规模复杂图，直接计算所有特征值往往是不可行或不必要的。因此，掌握谱估计技术显得尤为重要。本练习将介绍如何应用矩阵分析中的一个强大工具——格什戈林圆盘定理 (Gershgorin Circle Theorem)，来估计图拉普拉斯算子谱的范围[@problem_id:2903926]。通过这项实践，你将学会仅利用图中每个节点的局部信息（即节点度），就能为未归一化和归一化拉普拉斯算子的最大特征值 $\\lambda_{\\max}$ 找到一个紧致的界限，这对于后续的滤波器设计至关重要。", "problem": "考虑一个有限、无向、带权图，其顶点集为 $\\{1,2,\\dots,n\\}$，对称非负权重为 $w_{ij} = w_{ji} \\ge 0$ 且 $w_{ii} = 0$，带权邻接矩阵为 $A = [w_{ij}]$，度序列定义为 $d_i = \\sum_{j=1}^{n} w_{ij}$，度矩阵为 $D = \\mathrm{diag}(d_1,\\dots,d_n)$。定义非规范化图拉普拉斯矩阵 $L = D - A$ 和对称规范化拉普拉斯矩阵 $L_{\\mathrm{sym}} = I - D^{-1/2} A D^{-1/2}$，其中 $I$ 是单位矩阵。令 $d_{\\max} = \\max_{1 \\le i \\le n} d_i$。\n\n仅从 Gershgorin 圆盘定理（不得假设任何其他谱界或特定的拉普拉斯特征值性质）以及关于相似变换的基本线性代数知识出发，分别推导 $L$ 和 $L_{\\mathrm{sym}}$ 最大特征值的基于 Gershgorin 定理的紧致统一上界 $B_{L}$ 和 $B_{L_{\\mathrm{sym}}}$，并用 $\\{w_{ij}\\}$ 和 $\\{d_i\\}$ 表示。然后，为总和 $B_{L} + B_{L_{\\mathrm{sym}}}$ 提供一个仅用 $d_{\\max}$ 表示的单一简化解析表达式。\n\n你的最终答案必须是单一的闭式表达式。最终答案中不得包含任何不等式或等式。无需进行数值舍入。", "solution": "该问题是有效且适定的，前提是标准假设成立，即图中不含孤立顶点，也就是说，对于所有顶点 $i \\in \\{1, 2, \\dots, n\\}$，都有 $d_i = \\sum_{j=1}^{n} w_{ij}  0$。这对于度矩阵 $D$ 可逆以及 $D^{-1/2}$ 良定义是必要的。我们在此假设下进行推导。\n\n此推导的基础是 Gershgorin 圆盘定理。对于任意方阵 $M = [m_{ij}] \\in \\mathbb{C}^{n \\times n}$，其谱 $\\sigma(M)$ 包含在复平面中 $n$ 个圆盘的并集内，即 $\\sigma(M) \\subseteq \\bigcup_{i=1}^{n} C_i$，其中每个圆盘 $C_i$ 的圆心为对角元素 $m_{ii}$，半径为 $R_i = \\sum_{j \\ne i} |m_{ij}|$。由于拉普拉斯矩阵 $L$ 和 $L_{\\mathrm{sym}}$ 都是实对称矩阵，它们的特征值是实数。因此，这些特征值必须位于 Gershgorin 圆盘与实轴交集所定义的实数区间的并集内。\n\n首先，我们推导非规范化图拉普拉斯矩阵 $L = D - A$ 的最大特征值的上界。$L$ 的元素由下式给出：\n$$L_{ij} = \\begin{cases} d_i  \\text{若 } i=j \\\\ -w_{ij}  \\text{若 } i \\ne j \\end{cases}$$\n对于第 $i$ 个 Gershgorin 圆盘，其圆心为对角元素 $c_i = L_{ii} = d_i$。半径是第 $i$ 行非对角元素绝对值之和：\n$$R_i = \\sum_{j \\ne i} |L_{ij}| = \\sum_{j \\ne i} |-w_{ij}| = \\sum_{j \\ne i} w_{ij}$$\n根据顶点度 $d_i$ 的定义和给定条件 $w_{ii}=0$，我们有 $d_i = \\sum_{j=1}^{n} w_{ij} = w_{ii} + \\sum_{j \\ne i} w_{ij} = \\sum_{j \\ne i} w_{ij}$。\n因此，第 $i$ 个圆盘的半径恰好等于其圆心：$R_i = d_i$。\n\n对于 $L$ 的任意特征值 $\\lambda$，存在一个索引 $i$，使得 $|\\lambda - c_i| \\le R_i$，即 $|\\lambda - d_i| \\le d_i$。由于 $\\lambda$ 必须是实数，此不等式等价于 $-d_i \\le \\lambda - d_i \\le d_i$，即 $0 \\le \\lambda \\le 2d_i$。\n$L$ 的整个谱必须位于这些区间的并集内：$\\sigma(L) \\subseteq \\bigcup_{i=1}^{n} [0, 2d_i]$。因此，最大特征值 $\\lambda_{\\max}(L)$ 的上界是该并集中的最大值：\n$$\\lambda_{\\max}(L) \\le \\max_{1 \\le i \\le n} (2d_i) = 2 \\max_{1 \\le i \\le n} d_i = 2d_{\\max}$$\n这个界是紧的；例如，一个具有两个顶点且权重为 $w_{12}=1$ 的完全图，其 $d_{\\max}=1$，特征值为 $\\{0, 2\\}$，其中 $\\lambda_{\\max}(L)=2=2d_{\\max}$。因此，基于 Gershgorin 定理的最紧统一上界为 $B_L = 2d_{\\max}$。\n\n接下来，我们推导对称规范化拉普拉斯矩阵 $L_{\\mathrm{sym}} = I - D^{-1/2} A D^{-1/2}$ 的最大特征值的上界。直接对 $L_{\\mathrm{sym}}$ 应用 Gershgorin 定理是可行的，但无法得到通过此方法能获得的最紧上界。问题正确地允许使用相似变换，这是正确的途径。\n\n考虑随机游走拉普拉斯矩阵 $L_{\\mathrm{rw}} = D^{-1}L = I - D^{-1}A$。矩阵 $L_{\\mathrm{sym}}$ 与 $L_{\\mathrm{rw}}$ 相似：\n$$L_{\\mathrm{sym}} = I - D^{-1/2} A D^{-1/2} = D^{1/2} (I - D^{-1}A) D^{-1/2} = D^{1/2} L_{\\mathrm{rw}} D^{-1/2}$$\n由于 $L_{\\mathrm{sym}}$ 和 $L_{\\mathrm{rw}}$ 相似，它们具有相同的特征值集合。因此，我们可以分析 $L_{\\mathrm{rw}}$ 的谱来界定 $L_{\\mathrm{sym}}$ 的特征值。$L_{\\mathrm{rw}}$ 的元素为：\n$$(L_{\\mathrm{rw}})_{ij} = \\delta_{ij} - \\frac{w_{ij}}{d_i}$$\n其中 $\\delta_{ij}$ 是克罗内克 $\\delta$ 函数。对角元素为 $(L_{\\mathrm{rw}})_{ii} = 1 - w_{ii}/d_i = 1$。非对角元素为 $(L_{\\mathrm{rw}})_{ij} = -w_{ij}/d_i$（当 $i \\ne j$ 时）。\n\n现在，我们将 Gershgorin 定理应用于 $L_{\\mathrm{rw}}$。对于第 $i$ 行，圆盘的圆心为 $c_i = (L_{\\mathrm{rw}})_{ii} = 1$。半径为：\n$$R_i = \\sum_{j \\ne i} |(L_{\\mathrm{rw}})_{ij}| = \\sum_{j \\ne i} \\left|-\\frac{w_{ij}}{d_i}\\right| = \\frac{1}{d_i} \\sum_{j \\ne i} w_{ij}$$\n由于 $\\sum_{j \\ne i} w_{ij} = d_i$，半径为 $R_i = d_i/d_i = 1$。\n这对每一行 $i=1, \\dots, n$ 都成立。因此，$L_{\\mathrm{rw}}$ 的所有 Gershgorin 圆盘都是相同的：它们都以 $1$ 为圆心，半径为 $1$。$L_{\\mathrm{rw}}$ 的任何特征值 $\\lambda$ 都必须满足 $|\\lambda - 1| \\le 1$。\n$L_{\\mathrm{sym}}$ 的特征值与 $L_{\\mathrm{rw}}$ 的特征值相同，并且由于 $L_{\\mathrm{sym}}$ 是对称的，已知其特征值为实数。因此，这些特征值必须位于圆盘 $|\\lambda - 1| \\le 1$ 与实轴的交集内，即区间 $[0, 2]$。\n这意味着对于 $L_{\\mathrm{sym}}$ 的任意特征值 $\\lambda$，我们有 $0 \\le \\lambda \\le 2$。因此，最大特征值的上界为：\n$$\\lambda_{\\max}(L_{\\mathrm{sym}}) \\le 2$$\n这个界是紧的，同样可以由具有 $w_{12}=1$ 的双顶点图证明，对于该图，$L_{\\mathrm{sym}}$ 的特征值为 $\\{0, 2\\}$。其上界为 $B_{L_{\\mathrm{sym}}} = 2$。\n\n最后，问题要求这两个上界之和 $B_L + B_{L_{\\mathrm{sym}}}$，并用 $d_{\\max}$ 表示。\n$$B_L + B_{L_{\\mathrm{sym}}} = 2d_{\\max} + 2$$\n此表达式即为所要求的简化解析形式。", "answer": "$$\\boxed{2d_{\\max} + 2}$$", "id": "2903926"}, {"introduction": "图滤波器是图信号处理领域的核心构件，而多项式逼近是实现这些滤波器的关键技术。这个练习将理论与应用相结合，指导你如何使用切比雪夫多项式来构建一个数值稳定的图滤波器近似[@problem_id:2903956]。这项实践不仅阐明了如何将任意函数$g(L)$表示为在算子$\\widetilde{L}$上求值的多项式级数，还强调了谱重缩放（即将谱域 $[0, \\lambda_{\\max}]$ 映射到 $[-1, 1]$）对于保证计算稳定性的根本作用，这直接关联到前一个练习中对 $\\lambda_{\\max}$ 的估计。", "problem": "考虑一个具有 $N$ 个节点且带权的无向图，其组合图拉普拉斯算子 $L \\in \\mathbb{R}^{N \\times N}$ 定义为 $L = D - W$，其中 $W$ 是对称权重矩阵，$D$ 是度矩阵。矩阵 $L$ 是对称半正定的，其实数特征值位于 $[0,\\lambda_{\\max}]$ 区间内。设 $g : [0,\\lambda_{\\max}] \\to \\mathbb{R}$ 是一个连续函数。图滤波器 $g(L)$ 通过谱函数演算定义：如果 $L = U \\Lambda U^{\\top}$，其中 $\\Lambda = \\mathrm{diag}(\\lambda_{1},\\dots,\\lambda_{N})$ 且 $U$ 是正交矩阵，则 $g(L) = U \\, g(\\Lambda) \\, U^{\\top}$，其中 $g(\\Lambda) = \\mathrm{diag}(g(\\lambda_{1}),\\dots,g(\\lambda_{N}))$。\n\n您的目标是使用第一类切比雪夫多项式，获得 $g(L)$ 的一个数值稳定的 $K$ 次多项式近似。仅从以下性质出发：(i) $L$ 可对角化，其谱在 $[0,\\lambda_{\\max}]$ 内；(ii) 第一类切比雪夫多项式 $\\{T_{k}\\}_{k \\ge 0}$ 在 $[-1,1]$ 上相对于权重 $(1-x^{2})^{-1/2}$ 构成正交基，请推导：\n\n1. 一个将谱 $[0,\\lambda_{\\max}]$ 映射到 $[-1,1]$ 的仿射重缩放，以及用 $L$ 和 $\\lambda_{\\max}$ 表示的相应重缩放算子 $\\widetilde{L}$。\n2. $g(L)$ 的 $K$ 次切比雪夫近似 $p_{K}(L)$，表示为在 $\\widetilde{L}$ 处求值的切比雪夫多项式之和，其系数通过您的仿射重缩放的逆变换，明确地写成在 $[0,\\lambda_{\\max}]$ 上涉及 $g$ 的积分形式。您的推导应清楚地说明在 $[-1,1]$ 上的正交性如何确定这些系数。\n3. 简要论证为什么在通过三项切比雪夫递推关系评估近似值时，这种重缩放能提高数值稳定性。\n\n请以一个单一的、封闭形式的解析表达式给出 $p_{K}(L)$，用 $g$、$\\lambda_{\\max}$、$K$ 和 $L$ 表示。不需要进行数值计算，也不需要单位。最终答案必须是单一表达式，而不是方程或不等式。", "solution": "所述问题具有科学依据，是适定且客观的。这是图信号处理领域的一个标准练习，基于线性代数和近似理论的既定原理。所有必要的数据和定义都已提供，没有矛盾或歧义。该问题是有效的。\n\n目标是使用切比雪夫多项式构建图滤波器 $g(L)$ 的一个 $K$ 次多项式近似。我们将依次处理推导所需的三个部分。\n\n1. 谱的仿射重缩放\n\n图拉普拉斯算子 $L$ 是一个对称半正定矩阵，其谱（记为 $\\sigma(L)$）位于区间 $[0, \\lambda_{\\max}]$ 内，其中 $\\lambda_{\\max}$ 是 $L$ 的最大特征值。切比雪夫多项式 $T_k(x)$ 在区间 $[-1, 1]$ 上定义，并具有理想的正交性和稳定性。因此，需要一个从 $L$ 的谱域到该区间的映射。\n\n设 $\\lambda \\in [0, \\lambda_{\\max}]$ 是 $L$ 的一个特征值。我们寻求一个仿射变换 $\\tilde{\\lambda} = f(\\lambda) = a\\lambda + b$，使得区间 $[0, \\lambda_{\\max}]$ 被映射到 $[-1, 1]$。这要求区间的端点相应地被映射：\n- $f(0) = -1$\n- $f(\\lambda_{\\max}) = 1$\n\n将这些条件代入仿射形式，得到关于系数 $a$ 和 $b$ 的一个二元一次方程组：\n$$a(0) + b = -1 \\implies b = -1$$\n$$a(\\lambda_{\\max}) + b = 1 \\implies a\\lambda_{\\max} - 1 = 1 \\implies a\\lambda_{\\max} = 2 \\implies a = \\frac{2}{\\lambda_{\\max}}$$\n因此，对特征值所需的仿射变换为 $\\tilde{\\lambda} = \\frac{2}{\\lambda_{\\max}}\\lambda - 1$。\n\n根据矩阵的函数演算原理，将相同的变换应用于算子 $L$ 会得到重缩放算子 $\\widetilde{L}$。如果对于一个特征向量 $\\mathbf{u}$ 有 $L\\mathbf{u} = \\lambda\\mathbf{u}$，那么：\n$$\\left(\\frac{2}{\\lambda_{\\max}}L - I\\right)\\mathbf{u} = \\frac{2}{\\lambda_{\\max}}(L\\mathbf{u}) - I\\mathbf{u} = \\frac{2}{\\lambda_{\\max}}(\\lambda\\mathbf{u}) - \\mathbf{u} = \\left(\\frac{2\\lambda}{\\lambda_{\\max}} - 1\\right)\\mathbf{u} = \\tilde{\\lambda}\\mathbf{u}$$\n其中 $I$ 是 $N \\times N$ 单位矩阵。这证实了新算子 $\\widetilde{L}$ 的特征值是重缩放后的特征值 $\\tilde{\\lambda}$。\n\n因此，重缩放算子为：\n$$\\widetilde{L} = \\frac{2}{\\lambda_{\\max}}L - I$$\n$\\widetilde{L}$ 的谱 $\\sigma(\\widetilde{L})$ 完全位于区间 $[-1, 1]$ 内，符合要求。\n\n2. 切比雪夫近似的推导\n\n我们希望对 $\\lambda \\in [0, \\lambda_{\\max}]$ 上的函数 $g(\\lambda)$ 进行近似。使用仿射重缩放的逆变换 $\\lambda(x) = \\frac{\\lambda_{\\max}}{2}(x+1)$，我们在区间 $[-1, 1]$ 上定义一个对应的函数 $\\tilde{g}(x)$：\n$$\\tilde{g}(x) = g(\\lambda(x)) = g\\left(\\frac{\\lambda_{\\max}}{2}(x+1)\\right)$$\n我们使用一个截断的 $K$ 次切比雪夫级数来近似 $\\tilde{g}(x)$。切比雪夫级数展开式由 $\\tilde{g}(x) = \\sum_{k=0}^{\\infty} c_k T_k(x)$ 给出，其中系数 $c_k$ 通过利用切比雪夫多项式 $\\{T_k(x)\\}_{k \\ge 0}$ 在 $[-1, 1]$ 上关于权重函数 $w(x) = (1-x^2)^{-1/2}$ 的正交性来确定。正交关系为：\n$$\\int_{-1}^{1} T_k(x) T_j(x) \\frac{dx}{\\sqrt{1-x^2}} = \\begin{cases} 0  \\text{若 } k \\neq j \\\\ \\pi  \\text{若 } k=j=0 \\\\ \\frac{\\pi}{2}  \\text{若 } k=j  0 \\end{cases}$$\n系数 $c_k$ 是 $\\tilde{g}(x)$ 在基函数 $T_k(x)$ 上的投影：\n$$c_k = \\frac{\\langle \\tilde{g}, T_k \\rangle_w}{\\langle T_k, T_k \\rangle_w} = \\frac{\\int_{-1}^{1} \\tilde{g}(x) T_k(x) (1-x^2)^{-1/2} dx}{\\int_{-1}^{1} T_k(x)^2 (1-x^2)^{-1/2} dx}$$\n这给出了 $k=0$ 和 $k0$ 的不同表达式：\n$$c_0 = \\frac{1}{\\pi} \\int_{-1}^{1} \\frac{\\tilde{g}(x)}{\\sqrt{1-x^2}} dx$$\n$$c_k = \\frac{2}{\\pi} \\int_{-1}^{1} \\frac{\\tilde{g}(x) T_k(x)}{\\sqrt{1-x^2}} dx \\quad \\text{对于 } k \\ge 1$$\n为了用区间 $[0, \\lambda_{\\max}]$ 上的原始函数 $g$ 来表示这些系数，我们在积分中进行变量替换。令 $\\lambda' = \\frac{\\lambda_{\\max}}{2}(x+1)$，这意味着 $x = \\frac{2\\lambda'}{\\lambda_{\\max}}-1$。微分是 $d\\lambda' = \\frac{\\lambda_{\\max}}{2}dx$，所以 $dx = \\frac{2}{\\lambda_{\\max}}d\\lambda'$。权重函数项变为：\n$$\\sqrt{1-x^2} = \\sqrt{1 - \\left(\\frac{2\\lambda'}{\\lambda_{\\max}}-1\\right)^2} = \\sqrt{\\frac{4\\lambda'(\\lambda_{\\max}-\\lambda')}{\\lambda_{\\max}^2}} = \\frac{2}{\\lambda_{\\max}}\\sqrt{\\lambda'(\\lambda_{\\max}-\\lambda')}$$\n将这些代入 $c_k$ 的积分中（对于 $k \\ge 1$）：\n$$c_k = \\frac{2}{\\pi} \\int_{0}^{\\lambda_{\\max}} \\frac{g(\\lambda') T_k\\left(\\frac{2\\lambda'}{\\lambda_{\\max}}-1\\right)}{\\frac{2}{\\lambda_{\\max}}\\sqrt{\\lambda'(\\lambda_{\\max}-\\lambda')}} \\left(\\frac{2}{\\lambda_{\\max}} d\\lambda'\\right) = \\frac{2}{\\pi} \\int_{0}^{\\lambda_{\\max}} \\frac{g(\\lambda') T_k\\left(\\frac{2\\lambda'}{\\lambda_{\\max}}-1\\right)}{\\sqrt{\\lambda'(\\lambda_{\\max}-\\lambda')}} d\\lambda'$$\n$c_0$ 的类似替换得到：\n$$c_0 = \\frac{1}{\\pi} \\int_{0}^{\\lambda_{\\max}} \\frac{g(\\lambda')}{\\sqrt{\\lambda'(\\lambda_{\\max}-\\lambda')}} d\\lambda'$$\n$g(\\lambda)$ 的 $K$ 次多项式近似就是该截断级数在重缩放特征值处的求值：\n$$p_K(\\lambda) = \\sum_{k=0}^{K} c_k T_k\\left(\\frac{2\\lambda}{\\lambda_{\\max}}-1\\right)$$\n根据函数演算，图滤波器 $g(L)$ 的矩阵多项式近似 $p_K(L)$ 是通过用算子 $L$ 替换标量 $\\lambda$ 得到的：\n$$p_K(L) = \\sum_{k=0}^{K} c_k T_k\\left(\\frac{2}{\\lambda_{\\max}}L - I\\right) = \\sum_{k=0}^{K} c_k T_k(\\widetilde{L})$$\n代入系数 $c_k$ 的积分表达式，便得到该近似的最终解析形式。\n\n3. 数值稳定性的论证\n\n使用重缩放算子 $\\widetilde{L}$ 对于计算的数值稳定性至关重要。在实践中，多项式近似 $p_K(L)$ 的评估不是通过形成 $\\widetilde{L}$ 的幂，而是通过使用切比雪夫多项的三项递推关系：\n$$T_{k+1}(x) = 2x T_k(x) - T_{k-1}(x), \\quad \\text{其中 } T_0(x)=1, T_1(x)=x$$\n此递推关系可以应用于算子 $\\widetilde{L}$ 以生成矩阵 $T_k(\\widetilde{L})$，或者更高效地，在像 Clenshaw 算法这样的算法中用于计算 $p_K(L)$ 对一个向量的作用。\n\n这个递推关系的稳定性取决于其自变量的量级。对于自变量 $x$ 满足 $|x| \\le 1$，切比雪夫多项式是有界的：对所有 $k \\ge 0$，有 $|T_k(x)| \\le 1$。通过将算子 $L$ 重缩放为 $\\widetilde{L}$，我们确保其所有特征值 $\\tilde{\\lambda}_i$ 都在 $[-1, 1]$ 内。因此，每个矩阵 $T_k(\\widetilde{L})$ 的特征值，即 $T_k(\\tilde{\\lambda}_i)$，其大小也被界定在 1 以内。由于 $T_k(\\widetilde{L})$ 是一个对称矩阵，其谱范数等于其谱半径，所以 $\\|T_k(\\widetilde{L})\\|_2 \\le 1$。这可以防止递推关系中涉及的矩阵和向量的量级指数级增长，从而避免数值溢出和不稳定性。\n\n若不进行重缩放，我们将对 $\\lambda \\in [0, \\lambda_{\\max}]$ 计算 $T_k(\\lambda)$。如果 $\\lambda_{\\max}  1$，对于任何大于 1 的特征值 $\\lambda_i$，$T_k(\\lambda_i)$ 会随 $k$ 指数级增长，导致灾难性的数值错误。因此，仿射重缩放不仅仅是为了方便，而是稳定计算的一个基本要求。", "answer": "$$\\boxed{\\sum_{k=0}^{K} \\left( \\frac{2-\\delta_{k0}}{\\pi} \\int_{0}^{\\lambda_{\\max}} \\frac{g(\\lambda') T_k\\left(\\frac{2\\lambda'}{\\lambda_{\\max}}-1\\right)}{\\sqrt{\\lambda'(\\lambda_{\\max}-\\lambda')}} d\\lambda' \\right) T_k\\left(\\frac{2}{\\lambda_{\\max}}L-I\\right)}$$", "id": "2903956"}]}