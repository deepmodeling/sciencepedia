{"hands_on_practices": [{"introduction": "一阶迎风格式因其鲁棒性而广受欢迎，但也以其数值耗散特性而闻名。本练习将通过修正方程分析这一强大技术，揭示该格式的真实行为。通过考察其截断误差中的主导项，我们可以将其诠释为一种“人工”或“数值”扩散，完成这项练习 [@problem_id:2478002] 将使你从数学上深刻理解为何迎风格式会平滑尖锐梯度，以及这种效应如何与单元佩克莱数（Péclet number）$ \\mathrm{Pe} $ 相关联。", "problem": "考虑在间距为 $\\,\\Delta x\\,$ 的均匀网格上，一个被动标量 $\\,\\phi(x)\\,$ 在静止介质中的稳态一维输运。该介质具有恒定的密度 $\\,\\rho\\,$、恒定的均匀速度 $\\,u0\\,$ 和恒定的分子扩散系数 $\\,\\Gamma\\,$。其控制微分守恒方程为\n$$\n\\frac{d}{dx}\\!\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)\\;-\\;\\rho\\,u\\,\\frac{d\\phi}{dx}\\;=\\;0.\n$$\n在以节点 $\\,x_P\\,$ 为中心、面位于 $\\,x_w=x_P-\\tfrac{\\Delta x}{2}\\,$ 和 $\\,x_e=x_P+\\tfrac{\\Delta x}{2}\\,$ 的控制体上进行有限体积离散化。面上的扩散通量通过二阶中心差分近似，而面上的对流通量通过一阶迎风格式近似（即，对于 $\\,u0\\,$，面上的值取自上游节点）。\n\n仅从该守恒定律、均匀网格几何结构以及所述的近似方法出发，使用基于泰勒级数的修正方程分析，找出由对流通量的迎风离散格式所引入的主阶截断项。将此项解释为乘以 $\\,\\tfrac{d^{2}\\phi}{dx^{2}}\\,$ 的附加数值扩散 $\\,\\Gamma_{\\text{num}}\\,$，从而得到有效总扩散\n$$\n\\Gamma_{\\text{eff}} \\;=\\; \\Gamma \\;+\\; \\Gamma_{\\text{num}}.\n$$\n用分子扩散系数 $\\,\\Gamma\\,$ 和网格佩克莱特数（Péclet number）\n$$\n\\mathrm{Pe} \\;=\\; \\frac{\\rho\\,u\\,\\Delta x}{\\Gamma}.\n$$\n以封闭形式表示 $\\,\\Gamma_{\\text{eff}}\\,$ 的最终结果。然后，基于相同的修正方程推理，定性预测当固定 $\\,\\Delta x\\,$ 和 $\\,\\Gamma\\,$ 而 $\\,\\mathrm{Pe}\\,$ 增加时，离散解的边界层厚度和内部梯度误差相对于精确连续解的变化趋势。无需进行数值计算。将 $\\,\\Gamma_{\\text{eff}}\\,$ 的最终答案表述为单一的封闭形式解析表达式；不包括单位。", "solution": "所述问题在科学上是合理的、适定的且客观的。这是输运现象数值方法分析中的一个标准练习。我将开始推导。\n\n被动标量 $\\phi(x)$ 的稳态一维对流扩散控制方程如下：\n$$\n\\frac{d}{dx}\\!\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)\\;-\\;\\rho\\,u\\,\\frac{d\\phi}{dx}\\;=\\;0\n$$\n鉴于密度 $\\rho$、速度 $u$ 和分子扩散系数 $\\Gamma$ 均为常数，方程简化为：\n$$\n\\Gamma\\,\\frac{d^2\\phi}{dx^2} \\;-\\; \\rho\\,u\\,\\frac{d\\phi}{dx}\\;=\\;0\n$$\n为使用有限体积法离散该方程，我们将其在一个以网格节点 $x_P$ 为中心、长度为 $\\Delta x$ 的控制体上积分。该控制体的面位于 $x_w = x_P - \\frac{\\Delta x}{2}$ 和 $x_e = x_P + \\frac{\\Delta x}{2}$。\n$$\n\\int_{x_w}^{x_e} \\left( \\Gamma\\,\\frac{d^2\\phi}{dx^2} \\;-\\; \\rho\\,u\\,\\frac{d\\phi}{dx} \\right) dx \\;=\\; 0\n$$\n应用微积分基本定理，这成为控制体面上的通量平衡：\n$$\n\\left[ \\Gamma\\,\\frac{d\\phi}{dx} \\right]_{x_w}^{x_e} \\;-\\; \\left[ \\rho\\,u\\,\\phi \\right]_{x_w}^{x_e} \\;=\\; 0\n$$\n可以写成：\n$$\n\\left( \\Gamma\\,\\frac{d\\phi}{dx} \\right)_e - \\left( \\Gamma\\,\\frac{d\\phi}{dx} \\right)_w - \\left( (\\rho\\,u\\,\\phi)_e - (\\rho\\,u\\,\\phi)_w \\right) = 0\n$$\n此处，下标 $e$ 和 $w$ 分别表示在东、西两面上的求值。\n\n现在我们引入指定的数值近似。网格节点用 $W$ (西, $x_P - \\Delta x$)、$P$ (中心, $x_P$) 和 $E$ (东, $x_P + \\Delta x$) 表示。\n\n扩散通量使用二阶中心差分近似：\n$$\n\\left( \\Gamma\\,\\frac{d\\phi}{dx} \\right)_e \\approx \\Gamma\\,\\frac{\\phi_E - \\phi_P}{\\Delta x}\n$$\n$$\n\\left( \\Gamma\\,\\frac{d\\phi}{dx} \\right)_w \\approx \\Gamma\\,\\frac{\\phi_P - \\phi_W}{\\Delta x}\n$$\n\n对流通量使用一阶迎风格式近似。由于速度 $u0$，流动方向是从西到东。因此，面上 $\\phi$ 的值取自上游节点。\n对于东面 $x_e$，上游节点是 $P$。因此：\n$$\n(\\rho\\,u\\,\\phi)_e = \\rho\\,u\\,\\phi_e \\approx \\rho\\,u\\,\\phi_P\n$$\n对于西面 $x_w$，上游节点是 $W$。因此：\n$$\n(\\rho\\,u\\,\\phi)_w = \\rho\\,u\\,\\phi_w \\approx \\rho\\,u\\,\\phi_W\n$$\n\n将这些离散近似代入积分平衡方程，得到节点 $P$ 的离散方程：\n$$\n\\Gamma\\,\\frac{\\phi_E - \\phi_P}{\\Delta x} - \\Gamma\\,\\frac{\\phi_P - \\phi_W}{\\Delta x} - (\\rho\\,u\\,\\phi_P - \\rho\\,u\\,\\phi_W) = 0\n$$\n整理并除以 $\\Delta x$，以便将各项与导数关联起来：\n$$\n\\Gamma\\,\\frac{\\phi_E - 2\\phi_P + \\phi_W}{\\Delta x^2} - \\rho\\,u\\,\\frac{\\phi_P - \\phi_W}{\\Delta x} = 0\n$$\n这就是数值格式在每个节点上求解的有限差分方程。为了进行修正方程分析，我们用节点值 $\\phi_W$ 和 $\\phi_E$ 在 $x_P$ 点的泰勒级数展开来替换它们，其中我们使用记号 $\\phi'_P = (\\frac{d\\phi}{dx})_P$、$\\phi''_P = (\\frac{d^2\\phi}{dx^2})_P$ 等等。\n$$\n\\phi_E = \\phi_P + \\Delta x \\, \\phi'_P + \\frac{(\\Delta x)^2}{2!} \\, \\phi''_P + \\frac{(\\Delta x)^3}{3!} \\, \\phi'''_P + \\dots\n$$\n$$\n\\phi_W = \\phi_P - \\Delta x \\, \\phi'_P + \\frac{(\\Delta x)^2}{2!} \\, \\phi''_P - \\frac{(\\Delta x)^3}{3!} \\, \\phi'''_P + \\dots\n$$\n\n现在我们展开离散方程的两项。\n对于扩散项的有限差分算子：\n$$\n\\frac{\\phi_E - 2\\phi_P + \\phi_W}{\\Delta x^2} = \\frac{1}{\\Delta x^2} \\left[ \\left(\\phi_P + \\Delta x \\, \\phi'_P + \\frac{\\Delta x^2}{2} \\, \\phi''_P + \\dots\\right) - 2\\phi_P + \\left(\\phi_P - \\Delta x \\, \\phi'_P + \\frac{\\Delta x^2}{2} \\, \\phi''_P - \\dots\\right) \\right]\n$$\n$$\n= \\frac{1}{\\Delta x^2} \\left[ \\Delta x^2 \\, \\phi''_P + \\frac{2(\\Delta x)^4}{4!} \\, \\phi''''_P + \\dots \\right] = \\phi''_P + \\frac{\\Delta x^2}{12} \\, \\phi''''_P + O(\\Delta x^4)\n$$\n对于对流项的有限差分算子：\n$$\n\\frac{\\phi_P - \\phi_W}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ \\phi_P - \\left(\\phi_P - \\Delta x \\, \\phi'_P + \\frac{\\Delta x^2}{2} \\, \\phi''_P - \\dots\\right) \\right]\n$$\n$$\n= \\frac{1}{\\Delta x} \\left[ \\Delta x \\, \\phi'_P - \\frac{\\Delta x^2}{2} \\, \\phi''_P + \\frac{\\Delta x^3}{6} \\, \\phi'''_P - \\dots \\right] = \\phi'_P - \\frac{\\Delta x}{2} \\, \\phi''_P + \\frac{\\Delta x^2}{6} \\, \\phi'''_P - \\dots\n$$\n\n将这些展开式代回离散方程，得到修正方程，即数值格式实际求解的微分方程：\n$$\n\\Gamma \\left( \\phi''_P + \\frac{\\Delta x^2}{12} \\phi''''_P + \\dots \\right) - \\rho\\,u \\left( \\phi'_P - \\frac{\\Delta x}{2} \\phi''_P + \\frac{\\Delta x^2}{6} \\phi'''_P - \\dots \\right) = 0\n$$\n我们对各项进行分组，以匹配原始微分方程，并识别出剩余的截断误差项：\n$$\n\\left( \\Gamma \\phi''_P - \\rho\\,u\\,\\phi'_P \\right) + \\left( \\frac{\\rho\\,u\\,\\Delta x}{2} \\phi''_P \\right) - \\frac{\\rho\\,u\\,\\Delta x^2}{6} \\phi'''_P + \\frac{\\Gamma\\,\\Delta x^2}{12} \\phi''''_P + \\dots = 0\n$$\n主阶截断项是 $\\Delta x$ 幂次最低的项，即 $\\frac{\\rho\\,u\\,\\Delta x}{2} \\phi''_P$。此项的阶为 $O(\\Delta x)$，证实了迎风格式是一阶精度的。\n这个主阶误差项具有扩散项的形式，因为它与二阶导数 $\\phi''_P$ 成正比。因此，我们可以定义一个数值扩散系数 $\\Gamma_{\\text{num}}$，使得此项为 $\\Gamma_{\\text{num}} \\phi''_P$。\n$$\n\\Gamma_{\\text{num}} \\frac{d^2\\phi}{dx^2} = \\frac{\\rho\\,u\\,\\Delta x}{2} \\frac{d^2\\phi}{dx^2} \\implies \\Gamma_{\\text{num}} = \\frac{\\rho\\,u\\,\\Delta x}{2}\n$$\n到主阶为止，修正方程可以通过合并物理扩散项和数值扩散项来重写：\n$$\n\\left(\\Gamma + \\Gamma_{\\text{num}}\\right) \\frac{d^2\\phi}{dx^2} - \\rho\\,u\\,\\frac{d\\phi}{dx} + O(\\Delta x^2) = 0\n$$\n因此，有效扩散系数 $\\Gamma_{\\text{eff}}$ 是物理扩散系数和数值扩散系数之和：\n$$\n\\Gamma_{\\text{eff}} = \\Gamma + \\Gamma_{\\text{num}} = \\Gamma + \\frac{\\rho\\,u\\,\\Delta x}{2}\n$$\n为了用分子扩散系数 $\\Gamma$ 和网格佩克莱特数 $\\mathrm{Pe} = \\frac{\\rho\\,u\\,\\Delta x}{\\Gamma}$ 表示，我们提出因子 $\\Gamma$：\n$$\n\\Gamma_{\\text{eff}} = \\Gamma \\left( 1 + \\frac{\\rho\\,u\\,\\Delta x}{2\\Gamma} \\right) = \\Gamma \\left( 1 + \\frac{\\mathrm{Pe}}{2} \\right)\n$$\n该表达式表明，数值格式引入了与网格佩克莱特数成正比的人工扩散。\n\n对于定性分析，我们考虑在固定 $\\Delta x$ 和 $\\Gamma$ 的情况下增加 $\\mathrm{Pe}$ 的影响，这对应于增加速度 $u$。\n原始方程 $\\Gamma\\,\\phi'' - \\rho\\,u\\,\\phi' = 0$ 的精确解具有诸如边界层之类的特征，其特征厚度 $\\delta$ 与扩散输运与对流输运之比成正比，即 $\\delta \\sim \\frac{\\Gamma}{\\rho u}$。随着 $\\mathrm{Pe}$（以及 $u$）的增加，$\\delta$ 减小，意味着物理边界层变薄，梯度变得更陡。\n然而，数值解的行为遵循由 $\\Gamma_{\\text{eff}}$ 控制的修正方程。数值解中特征的特征厚度 $\\delta_{\\text{num}}$ 将与 $\\frac{\\Gamma_{\\text{eff}}}{\\rho u}$ 成正比。\n$$\n\\delta_{\\text{num}} \\sim \\frac{\\Gamma_{\\text{eff}}}{\\rho u} = \\frac{\\Gamma + \\frac{\\rho u \\Delta x}{2}}{\\rho u} = \\frac{\\Gamma}{\\rho u} + \\frac{\\Delta x}{2}\n$$\n随着 $\\mathrm{Pe}$ 的增加，物理边界层厚度 $\\delta \\sim \\frac{\\Gamma}{\\rho u}$ 趋近于零。然而，数值边界层厚度 $\\delta_{\\text{num}}$ 趋近于极限值 $\\frac{\\Delta x}{2}$。这意味着数值解将无法解析精确解中日益尖锐的梯度。这种梯度的过度、人为增厚被称为数值耗散（或数值涂抹）。边界层厚度误差将随 $\\mathrm{Pe}$ 大幅增长。\n类似地，在区域内部，只要存在曲率（$\\phi'' \\neq 0$），数值扩散项 $\\Gamma_{\\text{num}} \\phi''$ 就会人为地抑制解剖面中的任何变化。随着 $\\mathrm{Pe}$ 的增加，数值扩散 $\\Gamma_{\\text{num}}$ 随 $u$ 线性增加，变得远大于物理扩散 $\\Gamma$。这导致数值解看起来比精确解要弥散得多，从而在内部梯度上产生较大误差。\n总之，随着 $\\mathrm{Pe}$ 的增加，一阶迎风格式变得越来越不准确，引入了占主导地位的数值扩散，它涂抹了边界层和内部特征，导致数值解显著偏离物理上正确的、对流主导的行为。", "answer": "$$\n\\boxed{\\Gamma \\left( 1 + \\frac{\\mathrm{Pe}}{2} \\right)}\n$$", "id": "2478002"}, {"introduction": "在中心差分格式（CDS）和迎风格式（UDS）之间做出选择，涉及在精度和稳定性之间的关键权衡。这个编程练习 [@problem_id:2478026] 要求你为一个经典的对流-扩散问题同时实现这两种格式。你将直接观察到当对流占主导（即单元佩克莱数 $ \\mathrm{Pe}_h $ 超过临界值2）时中心差分格式的振荡行为，以及迎风格式虽然稳定但过度耗散的特性。这项实践对于培养对不同离散格式性能的直观感受，以及理解数值扩散和稳定性约束等概念的实际影响至关重要。", "problem": "考虑在域 $ x \\in [0, L] $ 上标量 $ \\phi(x) $ 的稳态一维对流扩散问题，物性恒定且无体积源项。控制方程为守恒律\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d \\phi}{dx}\\right) - \\rho u \\frac{d \\phi}{dx} = 0,\n$$\n服从狄利克雷边界条件 $ \\phi(0) = 1 $ 和 $ \\phi(L) = 0 $。假设 $ L = 1 $ 米，$ \\Gamma = 1 $（扩散系数），以及 $ \\rho u  0 $（从左向右流动）。定义佩克莱特数为 $ \\mathrm{Pe} = \\dfrac{\\rho u L}{\\Gamma} $，因此当 $ L = 1 $ 和 $ \\Gamma = 1 $ 时，我们有 $ \\rho u = \\mathrm{Pe} $。\n\n从上述常系数基本平衡方程可知，其精确解析解为指数形式。在本任务中，您必须从第一性原理推导出：\n- 精确解 $ \\phi_{\\mathrm{exact}}(x) $，\n- 使用有限差分法（FDM）在均匀网格上为未知节点值建立一个线性离散系统，其中对流导数分别采用中心差分近似和一阶迎风差分近似进行离散。\n\n使用包含 $ x=0 $ 和 $ x=L $ 处边界在内的 $ N $ 个节点的均匀网格，网格间距为 $ \\Delta x = \\dfrac{L}{N-1} $。设内部节点索引为 $ i = 1, 2, \\ldots, N-2 $。在 $ i = 0 $ 和 $ i = N-1 $ 处强施加边界条件。对于扩散项 $ \\dfrac{d^2 \\phi}{dx^2} $，使用标准的二阶中心差分。对于内部节点的对流项 $ \\dfrac{d \\phi}{dx} $，实现以下两种离散格式：\n- 中心差分格式 (CDS)：二阶中心差分，\n- 一阶迎风差分格式 (UDS)：假设 $ u  0 $ 的供体单元迎风。\n\n通过求解得到的三对角线性系统，为下面测试套件中列出的每种格式和参数集计算离散解 $ \\phi_{\\mathrm{num}} $。然后，使用基于两个等值的宽度度量来量化和比较边界层分辨率。具体来说，将边界层宽度 $ w $ 定义为位置 $ x(\\alpha_1) $ 和 $ x(\\alpha_2) $ 的差值，其中 $ \\alpha_1 = 0.9 $ 和 $ \\alpha_2 = 0.1 $，$ x(\\alpha) $ 是通过在相邻网格节点之间进行线性插值找到的 $ \\phi(x) = \\alpha $ 的位置。分别计算精确解和数值解的该宽度，并构成无量纲的边界层分辨率比 $ r = \\dfrac{w_{\\mathrm{num}}}{w_{\\mathrm{exact}}} $。此外，计算所有网格节点上的均方根 (RMS) 误差 $ \\varepsilon_{\\mathrm{rms}} = \\sqrt{\\dfrac{1}{N} \\sum_{j=0}^{N-1} \\left(\\phi_{\\mathrm{num}}(x_j) - \\phi_{\\mathrm{exact}}(x_j)\\right)^2 } $，以及一个布尔单调性标志，该标志指示离散解在整个域上是否从左到右非递增。\n\n您必须实现上述内容并评估下面列出的参数集测试套件，其中 $ \\mathrm{Pe} \\in \\{2, 5, 10\\} $ 和 $ N \\in \\{21, 5\\} $。对于每种情况，使用指定的离散格式：\n- 情况 1：格式 = CDS，$ \\mathrm{Pe} = 2 $，$ N = 21 $，\n- 情况 2：格式 = UDS，$ \\mathrm{Pe} = 2 $，$ N = 21 $，\n- 情况 3：格式 = CDS，$ \\mathrm{Pe} = 5 $，$ N = 21 $，\n- 情况 4：格式 = UDS，$ \\mathrm{Pe} = 5 $，$ N = 21 $，\n- 情况 5：格式 = CDS，$ \\mathrm{Pe} = 10 $，$ N = 21 $，\n- 情况 6：格式 = UDS，$ \\mathrm{Pe} = 10 $，$ N = 21 $，\n- 情况 7：格式 = CDS，$ \\mathrm{Pe} = 5 $，$ N = 5 $，\n- 情况 8：格式 = UDS，$ \\mathrm{Pe} = 5 $，$ N = 5 $，\n- 情况 9：格式 = CDS，$ \\mathrm{Pe} = 10 $，$ N = 5 $，\n- 情况 10：格式 = UDS，$ \\mathrm{Pe} = 10 $，$ N = 5 $。\n\n对于每种情况，计算并报告元组 $ [s, \\mathrm{Pe}, N, \\varepsilon_{\\mathrm{rms}}, r, \\text{monotone}] $，其中 $ s $ 是一个整数格式代码，定义为 CDS 为 $ s=0 $，UDS 为 $ s=1 $，$ \\varepsilon_{\\mathrm{rms}} $ 是无量纲的，$ r $ 是无量纲的，$ \\text{monotone} $ 是一个布尔值，如果对于所有相邻节点都有 $ \\phi_{\\mathrm{num}}(x_{j+1}) \\le \\phi_{\\mathrm{num}}(x_{j}) $，则为 $ \\text{True} $，否则为 $ \\text{False} $。基于位置的量在内部对 $ x $ 使用米为单位，但只需报告无量纲比率 $ r $。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身都是如上所述的列表（例如，$ [ [\\cdot], [\\cdot], \\ldots ] $）。不应打印任何其他文本。", "solution": "我们从稳态、一维、物性恒定且无源项的对流扩散方程开始，\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d \\phi}{dx}\\right) - \\rho u \\frac{d \\phi}{dx} = 0, \\quad x \\in [0,L],\n$$\n其狄利克雷边界条件为 $ \\phi(0) = 1 $ 和 $ \\phi(L) = 0 $。当 $ \\Gamma $ 和 $ \\rho u $ 为常数时，该方程简化为\n$$\n\\Gamma \\frac{d^2 \\phi}{dx^2} - \\rho u \\frac{d \\phi}{dx} = 0.\n$$\n令 $ P = \\dfrac{\\rho u}{\\Gamma} $ 为常数。则\n$$\n\\frac{d^2 \\phi}{dx^2} - P \\frac{d \\phi}{dx} = 0.\n$$\n引入 $ \\psi = \\dfrac{d \\phi}{dx} $。则 $ \\dfrac{d \\psi}{dx} - P \\psi = 0 $，得到 $ \\psi(x) = C_1 e^{P x} $。积分得，\n$$\n\\phi(x) = \\frac{C_1}{P} e^{P x} + C_2.\n$$\n使用 $ \\phi(0) = 1 $ 和 $ \\phi(L) = 0 $ 可得\n$$\n\\phi(x) = 1 - \\frac{e^{P x} - 1}{e^{P L} - 1} = \\frac{e^{P L} - e^{P x}}{e^{P L} - 1}.\n$$\n当 $ L = 1 $，$ \\Gamma = 1 $ 且 $ \\mathrm{Pe} = \\dfrac{\\rho u L}{\\Gamma} = \\rho u $ 时，我们有 $ P = \\mathrm{Pe} $，精确解为\n$$\n\\phi_{\\mathrm{exact}}(x) = \\frac{e^{\\mathrm{Pe}} - e^{\\mathrm{Pe} x}}{e^{\\mathrm{Pe}} - 1}.\n$$\n\n为了量化边界层宽度，定义位置 $ x(\\alpha) $ 使得 $ \\phi(x(\\alpha)) = \\alpha $，其中 $ \\alpha_1 = 0.9 $ 和 $ \\alpha_2 = 0.1 $。对于精确解，反解指数关系可得\n$$\n\\alpha = \\frac{e^{\\mathrm{Pe}} - e^{\\mathrm{Pe} x}}{e^{\\mathrm{Pe}} - 1} \\quad \\Longrightarrow \\quad e^{\\mathrm{Pe} x} = e^{\\mathrm{Pe}} - \\alpha (e^{\\mathrm{Pe}} - 1) = (1-\\alpha) e^{\\mathrm{Pe}} + \\alpha,\n$$\n所以\n$$\nx(\\alpha) = \\frac{1}{\\mathrm{Pe}} \\ln\\!\\big( \\alpha + (1-\\alpha) e^{\\mathrm{Pe}} \\big).\n$$\n因此，$ \\alpha_1 $ 和 $ \\alpha_2 $ 之间的精确边界层宽度为\n$$\nw_{\\mathrm{exact}} = x(0.1) - x(0.9) = \\frac{1}{\\mathrm{Pe}} \\left[ \\ln\\!\\big(0.1 + 0.9 e^{\\mathrm{Pe}}\\big) - \\ln\\!\\big(0.9 + 0.1 e^{\\mathrm{Pe}}\\big) \\right].\n$$\n\n对于数值近似，使用包含 $ N $ 个节点的均匀网格，网格间距为 $ \\Delta x = \\dfrac{L}{N-1} $，节点位置为 $ x_j = j \\Delta x $，$ j = 0,1,\\ldots,N-1 $。内部未知数为 $ \\phi_1, \\ldots, \\phi_{N-2} $。扩散项通过二阶中心差分近似为\n$$\n\\left.\\frac{d^2 \\phi}{dx^2}\\right|_{x_i} \\approx \\frac{\\phi_{i-1} - 2 \\phi_i + \\phi_{i+1}}{\\Delta x^2}.\n$$\n对于 $ x_i $ 处的对流项 $ \\dfrac{d \\phi}{dx} $，我们采用两种备选方案：\n- 中心差分格式 (CDS)：\n$$\n\\left.\\frac{d \\phi}{dx}\\right|_{x_i} \\approx \\frac{\\phi_{i+1} - \\phi_{i-1}}{2 \\Delta x}.\n$$\n- 对于 $ u  0 $ 的一阶迎风差分格式 (UDS)：\n$$\n\\left.\\frac{d \\phi}{dx}\\right|_{x_i} \\approx \\frac{\\phi_{i} - \\phi_{i-1}}{\\Delta x}.\n$$\n\n将这些近似代入内部节点 $ i $ 的方程 $ \\Gamma \\dfrac{d^2 \\phi}{dx^2} - \\rho u \\dfrac{d \\phi}{dx} = 0 $，得到三对角形式的线性代数方程组 $ a_W \\phi_{i-1} + a_P \\phi_i + a_E \\phi_{i+1} = b_i $，其系数取决于所用格式：\n- 对于 CDS：\n$$\na_W = \\frac{\\Gamma}{\\Delta x^2} + \\frac{\\rho u}{2 \\Delta x}, \\quad\na_P = -\\frac{2 \\Gamma}{\\Delta x^2}, \\quad\na_E = \\frac{\\Gamma}{\\Delta x^2} - \\frac{\\rho u}{2 \\Delta x}.\n$$\n- 对于 UDS ($ u  0 $ 时)：\n$$\na_W = \\frac{\\Gamma}{\\Delta x^2} + \\frac{\\rho u}{\\Delta x}, \\quad\na_P = -\\frac{2 \\Gamma}{\\Delta x^2} - \\frac{\\rho u}{\\Delta x}, \\quad\na_E = \\frac{\\Gamma}{\\Delta x^2}.\n$$\n通过将 $ \\phi_0 = 1 $ 和 $ \\phi_{N-1} = 0 $ 代入第一个和最后一个内部方程来施加边界条件，这会修改 $ i = 1 $ 和 $ i = N-2 $ 时的右侧项 $ b_i $：\n$$\nb_1 \\leftarrow b_1 - a_W \\phi_0, \\quad b_{N-2} \\leftarrow b_{N-2} - a_E \\phi_{N-1}.\n$$\n所有其他的 $ b_i $ 均为零。当 $ L = 1 $，$ \\Gamma = 1 $ 且 $ \\rho u = \\mathrm{Pe} $ 时，这些系数可直接由 $ \\Delta x $ 和 $ \\mathrm{Pe} $ 计算得出。求解得到的三对角线性系统以获得 $ \\phi_1, \\ldots, \\phi_{N-2} $，然后附加 $ \\phi_0 = 1 $ 和 $ \\phi_{N-1} = 0 $ 以获得完整的离散解 $ \\phi_{\\mathrm{num}} $。\n\n为评估解的质量和边界层分辨率：\n- 计算精确剖面 $ \\phi_{\\mathrm{exact}}(x_j) $ 和均方根 (RMS) 误差\n$$\n\\varepsilon_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N} \\sum_{j=0}^{N-1} \\left(\\phi_{\\mathrm{num}}(x_j) - \\phi_{\\mathrm{exact}}(x_j)\\right)^2 }.\n$$\n- 通过从左到右扫描找到第一个区间 $ [x_{k-1}, x_k] $（其中 $ \\phi_{\\mathrm{num}} $ 穿过水平 $ \\alpha $），并进行线性插值，来为离散解计算 $ x(\\alpha) $：\n$$\nx_{\\mathrm{num}}(\\alpha) = x_{k-1} + \\frac{\\alpha - \\phi_{k-1}}{\\phi_k - \\phi_{k-1}} \\Delta x.\n$$\n然后获得 $ w_{\\mathrm{num}} = x_{\\mathrm{num}}(0.1) - x_{\\mathrm{num}}(0.9) $ 和分辨率比 $ r = \\dfrac{w_{\\mathrm{num}}}{w_{\\mathrm{exact}}} $。\n- 通过检查所有 $ j $ 是否满足 $ \\phi_{\\mathrm{num}}(x_{j+1}) \\le \\phi_{\\mathrm{num}}(x_j) $（在一个小的数值容差内）来确定单调性，从而得到一个布尔标志。\n\n关于稳定性和振荡，已知当网格佩克莱特数 $ \\mathrm{Pe}_h = \\dfrac{\\rho u \\Delta x}{\\Gamma} = \\mathrm{Pe} \\Delta x $ 超过 2 时，用于对流项的中心差分格式 (CDS) 会产生非单调的振荡解。在我们的测试套件中，当 $ N = 5 $ 且 $ \\mathrm{Pe} = 10 $ 时，我们有 $ \\Delta x = \\dfrac{1}{4} $ 和 $ \\mathrm{Pe}_h = 2.5  2 $，因此预计 CDS 会是非单调的，而 UDS 保持单调但扩散性更强（$ r $ 值更大）。对于 $ N = 21 $ 且 $ \\mathrm{Pe} \\in \\{2,5,10\\} $ 的情况，$ \\Delta x = \\dfrac{1}{20} $，因此 $ \\mathrm{Pe}_h \\in \\{0.1, 0.25, 0.5\\} $，此时 CDS 保持单调且通常比 UDS 更准确。\n\n每个测试用例的算法步骤如下：\n1. 设置 $ L = 1 $，$ \\Gamma = 1 $，$ \\rho u = \\mathrm{Pe} $，并用 $ N $ 个节点构建均匀网格。\n2. 使用所选的对流离散格式（CDS 或 UDS）和中心差分扩散项来组装三对角系统，并将边界值合并到右侧项中。\n3. 求解线性系统以获得所有节点上的 $ \\phi_{\\mathrm{num}} $。\n4. 评估 $ \\phi_{\\mathrm{exact}}(x_j) $ 并计算 $ \\varepsilon_{\\mathrm{rms}} $。\n5. 根据闭式表达式计算 $ w_{\\mathrm{exact}} $，并通过在 $ \\alpha_1 = 0.9 $ 和 $ \\alpha_2 = 0.1 $ 水平上进行线性插值计算 $ w_{\\mathrm{num}} $，然后构成 $ r $。\n6. 检查 $ \\phi_{\\mathrm{num}} $ 在整个网格上的单调性以生成布尔标志。\n7. 输出列表 $ [s, \\mathrm{Pe}, N, \\varepsilon_{\\mathrm{rms}}, r, \\text{monotone}] $，其中 CDS 对应 $ s = 0 $，UDS 对应 $ s = 1 $。\n\n最终的程序为十个指定的情况实现了这些步骤，并按要求打印包含结果列表的单行输出。", "answer": "```python\nimport numpy as np\n\ndef exact_phi(x, Pe):\n    # Exact solution for L=1, Gamma=1, rho*u = Pe\n    # phi(x) = (exp(Pe) - exp(Pe*x)) / (exp(Pe) - 1)\n    exPe = np.exp(Pe)\n    denom = exPe - 1.0\n    return (exPe - np.exp(Pe * x)) / denom\n\ndef exact_bl_width(Pe):\n    # w_exact = (1/Pe) [ ln(0.1 + 0.9 e^Pe) - ln(0.9 + 0.1 e^Pe) ]\n    exPe = np.exp(Pe)\n    a1 = 0.1 + 0.9 * exPe\n    a2 = 0.9 + 0.1 * exPe\n    return (np.log(a1) - np.log(a2)) / Pe\n\ndef build_system(N, Pe, scheme):\n    # L=1, Gamma=1, rho*u = Pe\n    L = 1.0\n    Gamma = 1.0\n    rhou = Pe\n    dx = L / (N - 1)\n    # Interior unknowns: indices 1..N-2\n    m = N - 2\n    A = np.zeros((m, m), dtype=float)\n    b = np.zeros(m, dtype=float)\n    # Coefficients per scheme\n    if scheme == 'central':\n        aW = Gamma / dx**2 + rhou / (2.0 * dx)\n        aP = -2.0 * Gamma / dx**2\n        aE = Gamma / dx**2 - rhou / (2.0 * dx)\n    elif scheme == 'upwind':\n        aW = Gamma / dx**2 + rhou / dx\n        aP = -2.0 * Gamma / dx**2 - rhou / dx\n        aE = Gamma / dx**2\n    else:\n        raise ValueError(\"Unknown scheme\")\n    # Assemble tridiagonal matrix\n    for i in range(m):\n        # global index is i+1\n        if i - 1 >= 0:\n            A[i, i - 1] = aW\n        A[i, i] = aP\n        if i + 1  m:\n            A[i, i + 1] = aE\n    # Apply Dirichlet BCs: phi_0 = 1, phi_{N-1} = 0\n    # Modify b for first and last interior equations\n    b[0] -= aW * 1.0  # phi_0 = 1\n    b[-1] -= aE * 0.0  # phi_{N-1} = 0\n    return A, b\n\ndef solve_case(scheme, Pe, N):\n    # Build and solve\n    A, b = build_system(N, Pe, scheme)\n    # Solve interior\n    phi_interior = np.linalg.solve(A, b)\n    # Construct full solution with boundaries\n    phi = np.zeros(N, dtype=float)\n    phi[0] = 1.0\n    phi[-1] = 0.0\n    phi[1:-1] = phi_interior\n    # Grid\n    x = np.linspace(0.0, 1.0, N)\n    # Exact\n    phi_ex = exact_phi(x, Pe)\n    # RMS error\n    rms = np.sqrt(np.mean((phi - phi_ex) ** 2))\n    # Boundary layer width: compute for numerical by linear interpolation\n    def interp_x_for_alpha(alpha):\n        # Find first index where phi crosses alpha\n        for k in range(1, N):\n            if (phi[k - 1] >= alpha and phi[k] = alpha) or (phi[k - 1] = alpha and phi[k] >= alpha):\n                # Linear interpolation\n                if phi[k] == phi[k - 1]:\n                    return x[k]  # degenerate, return right node\n                t = (alpha - phi[k - 1]) / (phi[k] - phi[k - 1])\n                return x[k - 1] + t * (x[k] - x[k - 1])\n        return np.nan\n    x09 = interp_x_for_alpha(0.9)\n    x01 = interp_x_for_alpha(0.1)\n    w_num = x01 - x09 if (np.isfinite(x01) and np.isfinite(x09)) else np.nan\n    w_ex = exact_bl_width(Pe)\n    r = w_num / w_ex if np.isfinite(w_num) and w_ex != 0.0 else np.nan\n    # Monotonicity: non-increasing across nodes\n    tol = 1e-12\n    monotone = np.all(phi[1:] = phi[:-1] + tol)\n    # Scheme code: 0 for central, 1 for upwind\n    s_code = 0 if scheme == 'central' else 1\n    return [s_code, float(Pe), int(N), float(rms), float(r), bool(monotone)]\n\ndef solve():\n    test_cases = [\n        ('central', 2.0, 21),\n        ('upwind',  2.0, 21),\n        ('central', 5.0, 21),\n        ('upwind',  5.0, 21),\n        ('central',10.0, 21),\n        ('upwind', 10.0, 21),\n        ('central', 5.0, 5),\n        ('upwind',  5.0, 5),\n        ('central',10.0, 5),\n        ('upwind', 10.0, 5),\n    ]\n    results = []\n    for scheme, Pe, N in test_cases:\n        results.append(solve_case(scheme, Pe, N))\n    # Format output as a single-line list of lists\n    # Ensure booleans and floats are printed naturally\n    def format_inner(lst):\n        # Convert Python list to string without spaces after commas\n        return \"[\" + \",\".join(str(item) for item in lst) + \"]\"\n    print(\"[\" + \",\".join(format_inner(r) for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2478026"}, {"introduction": "在理解了基本离散格式之后，下一步是应用它们来求解更一般的边值问题（BVP）。本练习 [@problem_id:2478020] 涉及使用中心差分法离散一个包含对流、扩散和反应项的一维方程，从而形成一个三对角线性系统。你将对该系统进行数值求解，并将结果与推导出的精确解析解进行比较。通过这项实践，你将掌握数值求解边值问题的完整流程：从离散化、矩阵组装到系统求解，并对照已知基准进行严格的误差量化。", "problem": "考虑一个一维、稳态的被动标量对流-扩散-反应问题，该问题常见于传热与传质领域，定义在单位区间上，并带有狄利克雷边界条件。设 $x \\in [0,1]$，$\\phi(x)$ 满足以下线性常微分方程 (ODE)\n$$\n\\frac{d^2 \\phi}{dx^2} - \\mathrm{Pe}\\,\\frac{d \\phi}{dx} - \\mathrm{Da}\\,\\phi \\;=\\; 0,\n$$\n边界条件为\n$$\n\\phi(0) \\;=\\; \\phi_L,\\qquad \\phi(1) \\;=\\; \\phi_R.\n$$\n此处，$\\mathrm{Pe}$ 表示无量纲 Peclet 数，$\\mathrm{Da}$ 表示无量纲 Damköhler 数。在每个测试用例中，$\\mathrm{Pe}$ 和 $\\mathrm{Da}$ 均为给定的常数。任务是使用均匀网格上的中心差分格式计算数值解，并将其与该边值问题的精确解进行比较。\n\n从具有常系数和线性汇项的稳态一维被动标量守恒定律出发，利用 Peclet 数和 Damköhler 数的定义得到无量纲形式，然后推导在具有 $N$ 个尺寸为 $h = 1/N$ 的均匀区间的均匀网格上，针对内部节点的中心差分格式。对二阶导数和一阶导数均使用中心差分，并在端点节点上施加狄利克雷边界条件。\n\n通过解析求解常系数线性常微分方程（使用相应的特征方程）并应用边界条件，计算该边值问题的精确解。除了测试套件中给定的情况外，不要对 $\\mathrm{Pe}$ 或 $\\mathrm{Da}$ 的符号做任何特定假设。您必须同时实现离散中心差分解和解析精确解。\n\n将误差定义为所有网格节点上的均方根 (RMS) 绝对误差：\n$$\n\\mathcal{E}_{\\mathrm{RMS}} \\;=\\; \\sqrt{\\frac{1}{N+1}\\sum_{i=0}^{N} \\left(\\phi_i^{\\text{num}} - \\phi(x_i)^{\\text{exact}} \\right)^2},\n$$\n其中 $x_i = i h$（$i = 0,1,\\dots,N$），$\\phi_i^{\\text{num}}$ 是节点 $i$ 处的数值解，$\\phi(x_i)^{\\text{exact}}$ 是在 $x_i$ 处求值的精确解。\n\n您的程序必须：\n- 使用均匀间距 $h$ 和给定的 $\\mathrm{Pe}$、$\\mathrm{Da}$，为内部节点构建与中心差分离散化相对应的三对角线性系统。\n- 通过将 $\\phi_L$ 和 $\\phi_R$ 合并到右端项的适当位置来施加狄利克雷边界条件。\n- 求解内部节点值，并组装包含边界在内的完整数值解向量。\n- 通过特征方程解析求解常系数 ODE，并应用边界条件确定积分常数，从而计算精确解。\n- 计算如上定义的 RMS 误差 $\\mathcal{E}_{\\mathrm{RMS}}$。\n\n测试套件：\n对于下方的每个有序元组 $(\\mathrm{Pe}, \\mathrm{Da}, N, \\phi_L, \\phi_R)$，计算并报告 RMS 误差。请使用给定的顺序。\n\n1. $(\\mathrm{Pe}, \\mathrm{Da}, N, \\phi_L, \\phi_R) = (\\,2.5,\\,0.5,\\,80,\\,1.0,\\,0.2\\,)$\n2. $(\\mathrm{Pe}, \\mathrm{Da}, N, \\phi_L, \\phi_R) = (\\,0.1,\\,0.0,\\,40,\\,0.0,\\,1.0\\,)$\n3. $(\\mathrm{Pe}, \\mathrm{Da}, N, \\phi_L, \\phi_R) = (\\,40.0,\\,0.0,\\,20,\\,1.0,\\,0.0\\,)$\n4. $(\\mathrm{Pe}, \\mathrm{Da}, N, \\phi_L, \\phi_R) = (\\,0.0,\\,100.0,\\,200,\\,1.0,\\,0.0\\,)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含上述测试用例的 RMS 误差，按顺序排列，形式为一个用方括号括起来的逗号分隔列表（例如，$[\\dots]$），每个浮点数值四舍五入到八位小数。\n- 不应打印任何额外的文本或行。\n\n输出中不需要物理单位，因为问题是以无量纲形式提出的。不涉及角度。不涉及百分比；所有数值均为不带单位符号的实数。", "solution": "任务是求解一维稳态对流-扩散-反应方程的解析解和数值解，并计算两者之间的均方根误差。该问题是适定的且科学上是合理的，代表了输运现象中的一个标准边值问题。验证通过，我们开始进行求解。\n\n首先，我们推导精确的解析解。控制常微分方程 (ODE) 是一个二阶线性齐次常系数方程：\n$$\n\\frac{d^2 \\phi}{dx^2} - \\mathrm{Pe}\\,\\frac{d \\phi}{dx} - \\mathrm{Da}\\,\\phi = 0\n$$\n相应的特征方程为 $r^2 - \\mathrm{Pe}\\,r - \\mathrm{Da} = 0$。其根 $r_{1,2}$ 由二次求根公式给出：\n$$\nr_{1,2} = \\frac{\\mathrm{Pe} \\pm \\sqrt{\\mathrm{Pe}^2 + 4\\,\\mathrm{Da}}}{2}\n$$\n对于所有提供的测试用例，判别式 $\\Delta = \\mathrm{Pe}^2 + 4\\,\\mathrm{Da}$ 严格为正，从而产生两个不相等的实根 $r_1$ 和 $r_2$。因此，通解的形式为：\n$$\n\\phi(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x}\n$$\n积分常数 $C_1$ 和 $C_2$ 通过施加狄利克雷边界条件 $\\phi(0) = \\phi_L$ 和 $\\phi(1) = \\phi_R$ 来确定。这产生了一个关于两个未知数的二元线性方程组：\n$$\n\\begin{cases}\nC_1 + C_2 = \\phi_L \\\\\nC_1 e^{r_1} + C_2 e^{r_2} = \\phi_R\n\\end{cases}\n$$\n求解该方程组可得系数的表达式：\n$$\nC_1 = \\frac{\\phi_R - \\phi_L e^{r_2}}{e^{r_1} - e^{r_2}}\n\\qquad \\text{和} \\qquad\nC_2 = \\frac{\\phi_L e^{r_1} - \\phi_R}{e^{r_1} - e^{r_2}}\n$$\n有了这些系数，对于任意 $x \\in [0,1]$，精确解 $\\phi(x)^{\\text{exact}}$ 就被完全确定了。\n\n接下来，我们使用均匀网格上的中心差分格式推导数值解。区域 $[0,1]$ 被离散为 $N$ 个等大的区间，区间大小为 $h=1/N$。网格节点位于 $x_i = i h$ 处，其中 $i = 0, 1, \\dots, N$。在任意内部节点 $x_i$（$i \\in \\{1, \\dots, N-1\\}$），我们使用二阶中心差分公式来近似一阶和二阶导数：\n$$\n\\frac{d\\phi}{dx}\\bigg|_{x_i} \\approx \\frac{\\phi_{i+1} - \\phi_{i-1}}{2h}, \\qquad \\frac{d^2\\phi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\n其中 $\\phi_i$ 表示 $\\phi(x_i)$ 的数值近似值 $\\phi_i^{\\text{num}}$。将这些近似式代入控制 ODE，得到：\n$$\n\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2} - \\mathrm{Pe} \\left( \\frac{\\phi_{i+1} - \\phi_{i-1}}{2h} \\right) - \\mathrm{Da}\\,\\phi_i = 0\n$$\n两边同乘以 $h^2$ 并重新整理各项，将 $\\phi_{i-1}$、$\\phi_i$ 和 $\\phi_{i+1}$ 的系数归类，我们得到每个内部节点的代数方程：\n$$\n\\left(1 + \\frac{\\mathrm{Pe}\\,h}{2}\\right)\\phi_{i-1} + \\left(-2 - \\mathrm{Da}\\,h^2\\right)\\phi_i + \\left(1 - \\frac{\\mathrm{Pe}\\,h}{2}\\right)\\phi_{i+1} = 0\n$$\n这个关于未知内部节点值 $\\phi_1, \\dots, \\phi_{N-1}$ 的 $N-1$ 个线性方程组构成一个三对角系统。边界条件为 $\\phi_0 = \\phi_L$ 和 $\\phi_N = \\phi_R$。这些已知值被移到 $i=1$ 和 $i=N-1$ 对应方程的右端。\n当 $i=1$ 时：\n$$\n\\left(-2 - \\mathrm{Da}\\,h^2\\right)\\phi_1 + \\left(1 - \\frac{\\mathrm{Pe}\\,h}{2}\\right)\\phi_2 = -\\left(1 + \\frac{\\mathrm{Pe}\\,h}{2}\\right)\\phi_L\n$$\n当 $i=N-1$ 时：\n$$\n\\left(1 + \\frac{\\mathrm{Pe}\\,h}{2}\\right)\\phi_{N-2} + \\left(-2 - \\mathrm{Da}\\,h^2\\right)\\phi_{N-1} = -\\left(1 - \\frac{\\mathrm{Pe}\\,h}{2}\\right)\\phi_R\n$$\n令次对角线、主对角线和超对角线的系数分别为 $c_s = 1 + \\frac{\\mathrm{Pe}\\,h}{2}$、$c_d = -2 - \\mathrm{Da}\\,h^2$ 和 $c_u = 1 - \\frac{\\mathrm{Pe}\\,h}{2}$。求解得到的 $(N-1) \\times (N-1)$ 三对角线性系统 $A\\vec{\\phi}_{\\text{int}} = \\vec{b}$，以获得内部解向量 $\\vec{\\phi}_{\\text{int}} = [\\phi_1, \\dots, \\phi_{N-1}]^T$。然后组装完整的数值解向量为 $\\phi^{\\text{num}} = [\\phi_L, \\phi_1, \\dots, \\phi_{N-1}, \\phi_R]^T$。该系统使用适当的数值线性代数程序求解。\n\n最后，数值解与精确解之间的误差使用均方根 (RMS) 误差进行量化，定义如下：\n$$\n\\mathcal{E}_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N+1}\\sum_{i=0}^{N} \\left(\\phi_i^{\\text{num}} - \\phi(x_i)^{\\text{exact}} \\right)^2}\n$$\n此计算需要在每个网格点 $x_i$ 处计算精确解的值，并与计算出的数值 $\\phi_i^{\\text{num}}$ 进行比较。节点总数为 $N+1$。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection-diffusion-reaction problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # (Pe, Da, N, phi_L, phi_R)\n        (2.5, 0.5, 80, 1.0, 0.2),\n        (0.1, 0.0, 40, 0.0, 1.0),\n        (40.0, 0.0, 20, 1.0, 0.0),\n        (0.0, 100.0, 200, 1.0, 0.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Pe, Da, N, phi_L, phi_R = case\n        h = 1.0 / N\n        x_nodes = np.linspace(0.0, 1.0, N + 1)\n\n        # 1. Analytical (Exact) Solution\n        # Characteristic equation: r^2 - Pe*r - Da = 0\n        discriminant = Pe**2 + 4.0 * Da\n        sqrt_discriminant = np.sqrt(discriminant)\n        r1 = (Pe + sqrt_discriminant) / 2.0\n        r2 = (Pe - sqrt_discriminant) / 2.0\n        \n        # General solution: phi(x) = C1*exp(r1*x) + C2*exp(r2*x)\n        # Apply BCs to find C1, C2 by solving a 2x2 system\n        # [ 1      1    ] [C1] = [phi_L]\n        # [exp(r1) exp(r2)] [C2] = [phi_R]\n        if np.isclose(r1, r2): # Repeated roots case (not in test suite but robust)\n            # This logic block will not be hit by the provided test cases.\n            A_mat = np.array([\n                [1.0, 0.0],\n                [np.exp(r1), np.exp(r1)]\n            ])\n            b_vec = np.array([phi_L, phi_R])\n            C1, C2 = np.linalg.solve(A_mat, b_vec)\n            phi_exact_vals = (C1 + C2 * x_nodes) * np.exp(r1 * x_nodes)\n        else: # Distinct real roots\n            A_mat = np.array([\n                [1.0, 1.0],\n                [np.exp(r1), np.exp(r2)]\n            ])\n            b_vec = np.array([phi_L, phi_R])\n            C1, C2 = np.linalg.solve(A_mat, b_vec)\n            phi_exact_vals = C1 * np.exp(r1 * x_nodes) + C2 * np.exp(r2 * x_nodes)\n\n        # 2. Numerical Solution (Central Differencing)\n        num_interior_nodes = N - 1\n        \n        if num_interior_nodes = 0:\n            # Handle trivial case of N=1 where only boundary nodes exist.\n            phi_num = np.array([phi_L, phi_R] if N == 1 else [phi_L])\n        else:\n            # Coefficients of the tridiagonal system\n            c_s = 1.0 + Pe * h / 2.0  # Sub-diagonal\n            c_d = -2.0 - Da * h**2   # Main diagonal\n            c_u = 1.0 - Pe * h / 2.0  # Super-diagonal\n\n            # Create the banded matrix for scipy's solver\n            # Shape is (3, N-1) for a tridiagonal system\n            ab = np.zeros((3, num_interior_nodes))\n            ab[0, 1:] = c_u   # Super-diagonal on first row, shifted\n            ab[1, :] = c_d    # Main diagonal on second row\n            ab[2, :-1] = c_s  # Sub-diagonal on third row, shifted\n\n            # Create the right-hand side vector\n            b_rhs = np.zeros(num_interior_nodes)\n            b_rhs[0] = -c_s * phi_L\n            b_rhs[-1] = -c_u * phi_R\n            \n            # Solve the tridiagonal system for interior nodes\n            phi_interior = solve_banded((1, 1), ab, b_rhs)\n            \n            # Assemble the full solution vector including boundaries\n            phi_num = np.concatenate(([phi_L], phi_interior, [phi_R]))\n\n        # 3. RMS Error Calculation\n        squared_errors = (phi_num - phi_exact_vals)**2\n        rms_error = np.sqrt(np.mean(squared_errors))\n        results.append(f\"{rms_error:.8f}\")\n\n    # Final output formatting\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2478020"}]}