{"hands_on_practices": [{"introduction": "任何数值模拟的第一步都是将控制方程离散化。本练习将提供一个基础性的实践经验，指导你如何应用有限体积法，将热量守恒原理以及各类边界条件（如狄利克雷、诺伊曼和罗宾边界条件）转化为代数方程组。通过编程为不同类型的控制体积组装系数，你将巩固对物理边界相互作用如何在离散矩阵系统中表达的理解。", "problem": "一个二维稳态热传导问题将使用有限体积法在均匀笛卡尔网格上进行离散化，并组装成形式为 $a_P T_P - \\sum a_{nb} T_{nb} = b_P$ 的代数节点方程，其中 $a_P$ 是主对角系数，$a_{nb}$ 是相邻系数，$b_P$ 是右端源项。计算域为一个宽度为 $L_x$、高度为 $L_y$ 的矩形，其热导率为 $k$（假定为常数且各向同性），均匀体积生热率为 $\\dot{q}$（单位 $\\mathrm{W/m^3}$），且在平面外方向上具有单位厚度。网格由 $n_x \\times n_y$ 个大小相等的控制体积组成，尺寸分别为 $\\Delta x$ 和 $\\Delta y$，因此 $L_x = n_x \\Delta x$ 且 $L_y = n_y \\Delta y$。您将使用能量守恒的积分形式为每个控制体积组装节点方程，并针对一组代表每种边界类型的典型单元，对照独立计算的期望值，验证所组装的系数 $a_P$、$a_{nb}$ 和 $b_P$ 的正确性。\n\n从稳态热传导与热源生成的基本能量守恒方程开始，\n$$-\\nabla \\cdot \\left(k \\nabla T \\right) = \\dot{q},$$\n对每个控制体积进行积分，并通过单元中心之间或单元中心与边界面之间的距离上的线性分布来近似面法向梯度。假设面面积为 $A_e = \\Delta y$、$A_w = \\Delta y$、$A_n = \\Delta x$ 和 $A_s = \\Delta x$（单位厚度）。使用以下有限体积原理处理面通量和边界，这些原理由守恒声明推导而来，不以任何简化公式为目标：\n\n- 对于相邻控制体积 $P$ 和 $E$ 之间、相距 $\\Delta x$ 的内界面，扩散导为 $D_e = k A_e / \\Delta x$，它为 $P$ 的方程贡献 $a_E = D_e$，并为其东侧相邻方程贡献 $a_W = D_e$。类似的定义适用于西、北、南面，其扩散导分别为 $D_w = k A_w / \\Delta x$、$D_n = k A_n / \\Delta y$ 和 $D_s = k A_s / \\Delta y$。\n\n- 对于具有给定边界温度 $T_b$ 的狄利克雷（Dirichlet）边界，通过跨半个单元距离的线性外推来消去虚拟温度，使得该面的贡献表现为对主系数和右端项的增加：将 $2 k A / \\delta$ 加到 $a_P$ 上，并将 $2 k A T_b / \\delta$ 加到 $b_P$ 上，其中 $\\delta$ 是从单元中心到边 界面的距离，对于垂直面等于 $\\Delta x/2$，对于水平面等于 $\\Delta y/2$。\n\n- 对于具有给定法向热通量 $q''$（定义为流入计算域为正）的诺伊曼（Neumann）边界，将 $q'' A$ 添加到该面的 $b_P$ 中，而该面的相邻系数不变。\n\n- 对于对流罗宾（Robin）边界，其中表面热通量满足 $q'' = h (T_\\infty - T_\\text{face})$，其中 $h$ 为传热系数，$T_\\infty$ 为环境温度。将跨半单元的线性传导关系 $q'' = k (T_P - T_\\text{face})/\\delta$ 与对流条件相结合以消去 $T_\\text{face}$，从而获得形式为 $q'' = G (T_\\infty - T_P)$ 的等效线性贡献，其中\n$$G = \\frac{\\left( k/\\delta \\right) h}{h + \\left( k/\\delta \\right)} A.$$\n通过将 $G$ 添加到 $a_P$ 并将 $G T_\\infty$ 添加到 $b_P$ 来表示此贡献。\n\n- 通过将 $\\dot{q} V$ 添加到 $b_P$ 来处理体积源项，其中 $V = \\Delta x \\Delta y$ 是控制体积。\n\n以规范形式 $a_P T_P - \\sum a_{nb} T_{nb} = b_P$ 实现代数方程，其中相邻集为 $\\{E,W,N,S\\}$。对于因边界而缺失的任何相邻点，其对应的 $a_{nb}$ 必须为 $0$。\n\n您的任务：\n\n- 针对给定的物理参数和边界条件，为 $n_x \\times n_y$ 网格中的每个控制体积，以编程方式组装系数 $a_P$、$a_W$、$a_E$、$a_S$、$a_N$ 和 $b_P$。\n\n- 对于选定的能说明每种边界类型的控制体积，使用上述逐面公式独立计算这些系数的期望值。\n\n- 对每个选定的控制体积，验证组装的系数和期望的系数在绝对容差 $\\varepsilon = 10^{-10}$ 内是否匹配。\n\n边界条件说明：\n\n- 位于 $x=0$ 的西边界是狄利克雷边界，给定温度为 $T_W$。\n\n- 位于 $x=L_x$ 的东边界是诺伊曼边界，给定的热通量为 $q''_E$（流入域内为正）。\n\n- 位于 $y=0$ 的南边界是诺伊曼边界，给定的热通量为 $q''_S$（流入域内为正；对于绝热边界可能为 $0$）。\n\n- 位于 $y=L_y$ 的北边界是罗宾（对流）边界，系数为 $h_N$，环境温度为 $T_{\\infty,N}$。\n\n几何与材料参数：\n\n- 网格是均匀的，有 $n_x \\times n_y$ 个控制体积，间距为 $\\Delta x$ 和 $\\Delta y$（单位 $\\mathrm{m}$），各向同性热导率为 $k$（单位 $\\mathrm{W/(m\\cdot K)}$），体积生热率为 $\\dot{q}$（单位 $\\mathrm{W/m^3}$）。厚度为 $1$（无量纲，单位为米），因此面面积为 $A_e = A_w = \\Delta y$ 和 $A_n = A_s = \\Delta x$（单位 $\\mathrm{m^2}$），单元体积为 $V = \\Delta x \\Delta y$（单位 $\\mathrm{m^3}$）。\n\n每个测试案例需验证的代表性单元：\n\n- 内部中心单元 $(i,j) = (1,1)$，其中 $i=0,\\dots,n_x-1$ 从西到东， $j=0,\\dots,n_y-1$ 从南到北。\n\n- 西边缘中间单元 $(0,1)$（存在狄利克雷边界）。\n\n- 东边缘中间单元 $(n_x-1,1)$（存在诺伊曼边界）。\n\n- 北边缘中间单元 $(1,n_y-1)$（存在罗宾边界）。\n\n- 南边缘中间单元 $(1,0)$（存在诺伊曼边界，可能为绝热）。\n\n- 西北角单元 $(0,n_y-1)$（同时存在狄利克雷和罗宾边界）。\n\n测试套件：\n\n提供三个测试案例；所有数据均采用指定的相干国际单位制单位。\n\n- 测试案例 A:\n    - $n_x = 3$，$n_y = 3$，$\\Delta x = 0.1\\,\\mathrm{m}$，$\\Delta y = 0.1\\,\\mathrm{m}$，\n    - $k = 20\\,\\mathrm{W/(m\\cdot K)}$，$\\dot{q} = 1.0\\times 10^{5}\\,\\mathrm{W/m^3}$，\n    - 西边界狄利克雷 $T_W = 400\\,\\mathrm{K}$，\n    - 东边界诺伊曼 $q''_E = 5000\\,\\mathrm{W/m^2}$，\n    - 南边界诺伊曼 $q''_S = 0\\,\\mathrm{W/m^2}$ (绝热)，\n    - 北边界罗宾 $h_N = 25\\,\\mathrm{W/(m^2\\cdot K)}$，$T_{\\infty,N} = 300\\,\\mathrm{K}$。\n\n- 测试案例 B:\n    - $n_x = 3$，$n_y = 3$，$\\Delta x = 0.05\\,\\mathrm{m}$，$\\Delta y = 0.2\\,\\mathrm{m}$，\n    - $k = 50\\,\\mathrm{W/(m\\cdot K)}$，$\\dot{q} = 0\\,\\mathrm{W/m^3}$，\n    - 西边界狄利克雷 $T_W = 310\\,\\mathrm{K}$，\n    - 东边界诺伊曼 $q''_E = -2000\\,\\mathrm{W/m^2}$，\n    - 南边界诺伊曼 $q''_S = 0\\,\\mathrm{W/m^2}$，\n    - 北边界罗宾 $h_N = 100\\,\\mathrm{W/(m^2\\cdot K)}$，$T_{\\infty,N} = 350\\,\\mathrm{K}$。\n\n- 测试案例 C:\n    - $n_x = 3$，$n_y = 3$，$\\Delta x = 0.08\\,\\mathrm{m}$，$\\Delta y = 0.12\\,\\mathrm{m}$，\n    - $k = 10\\,\\mathrm{W/(m\\cdot K)}$，$\\dot{q} = 2.0\\times 10^{4}\\,\\mathrm{W/m^3}$，\n    - 西边界狄利克雷 $T_W = 300\\,\\mathrm{K}$，\n    - 东边界诺伊曼 $q''_E = 0\\,\\mathrm{W/m^2}$，\n    - 南边界诺伊曼 $q''_S = 1000\\,\\mathrm{W/m^2}$，\n    - 北边界罗宾 $h_N = 10^{4}\\,\\mathrm{W/(m^2\\cdot K)}$，$T_{\\infty,N} = 330\\,\\mathrm{K}$。\n\n最终输出规格：\n\n- 您的程序必须为每个测试案例组装系数，并针对六个指定的控制体积，按 $(1,1)$、$(0,1)$、$(2,1)$、$(1,2)$、$(1,0)$、$(0,2)$ 的顺序，将组装的系数与使用绝对容差 $\\varepsilon = 10^{-10}$ 独立计算的期望值进行比较。\n\n- 对于每个单元，如果且仅当所有六个系数 $a_P$、$a_W$、$a_E$、$a_S$、$a_N$ 和 $b_P$ 都在容差范围内匹配，则生成一个布尔值 $true$；否则为 $false$。\n\n- 将所有三个测试案例的所有布尔值聚合起来，保持测试案例顺序和每个测试案例的单元顺序不变，形成一个扁平列表，并打印包含此列表的单行，格式为逗号分隔并用方括号括起，例如 $[\\text{true},\\text{true},\\dots]$。\n\n角度单位不适用。物理输入采用指定的国际单位制单位，而最终的布尔值是无单位的。", "solution": "问题陈述经过严格审查，被认为是有效的。它在科学上基于传热原理，在数学上是自洽的，并且表述客观。它提出了一个计算传热学中明确定义的任务：组装和验证从有限体积法导出的节点代数方程。\n\n基本原理是稳态系统的能量守恒，其微分形式对于带源项的热传导为：\n$$-\\nabla \\cdot \\left(k \\nabla T \\right) = \\dot{q}$$\n其中 $k$ 是热导率，单位为 $\\mathrm{W/(m\\cdot K)}$，$T$ 是温度场，单位为 $\\mathrm{K}$，$\\dot{q}$ 是体积生热率，单位为 $\\mathrm{W/m^3}$。\n\n为了使用有限体积法离散化该方程，我们将其在一个以节点 $P$ 为中心的控制体积 $V_P$ 上积分：\n$$ \\int_{V_P} -\\nabla \\cdot \\left(k \\nabla T \\right) dV = \\int_{V_P} \\dot{q} dV $$\n对左侧应用散度定理，将体积积分转换为控制体积各表面的通量之和：\n$$ -\\sum_{f} \\int_{A_f} (k \\nabla T) \\cdot \\mathbf{n} \\, dA = \\dot{q} V_P $$\n其中，求和遍及控制体积的所有面 $f$（东、西、南、北），$A_f$ 是一个面的面积，$\\mathbf{n}$ 是向外的单位法向量。令 $q''_f$ 为通过面 $f$ 流出控制体积的热通量。方程变为：\n$$ \\sum_{f \\in \\{e,w,n,s\\}} q''_f A_f = \\dot{q} V_P $$\n该方法的核心在于近似热通量项 $q''_f A_f$。每个节点 $P$ 产生的代数方程以规范形式表示：\n$$ a_P T_P - \\sum_{nb} a_{nb} T_{nb} = b_P $$\n其中 $T_P$ 是节点 $P$ 的温度，$T_{nb}$ 是相邻节点的温度，$a_P$ 是中心系数，$a_{nb}$ 是相邻系数，$b_P$ 是源项。这些系数是通过考虑控制体积每个面的贡献来组装的。\n\n**1. 内界面：**\n对于一个内界面，例如节点 $P$ 和 $E$ 之间的东面“e”，热通量通过单元中心之间的线性温度分布来近似。通过面“e”离开 $P$ 的热流率为：\n$$ q_e = k A_e \\frac{T_P - T_E}{\\delta x_{PE}} $$\n这里，$A_e = \\Delta y$ 是面面积（假设单位深度），$\\delta x_{PE} = \\Delta x$ 是单元中心之间的距离。此贡献可以写为 $D_e(T_P - T_E)$，其中 $D_e = k A_e / \\Delta x$ 是扩散导。项 $-D_e T_E$ 移到最终方程的左侧，得到 $a_E = D_e$。项 $D_e T_P$ 对中心系数有贡献，因此 $a_P$ 增加 $D_e$。类似表达式适用于其他内界面，其中 $a_W = D_w = k \\Delta y / \\Delta x$，$a_N = D_n = k \\Delta x / \\Delta y$，$a_S = D_s = k \\Delta x / \\Delta y$。对于边界面，相应的相邻系数 $a_{nb}$ 为零。\n\n**2. 狄利克雷边界（给定温度）：**\n在具有指定温度 $T_b$ 的边界面（例如西面），通量使用从单元中心 $P$ 到边界的距离 $\\delta = \\Delta x/2$ 来近似。热流率为：\n$$ q_w = k A_w \\frac{T_P - T_b}{\\delta} = \\frac{2k A_w}{\\Delta x}(T_P - T_b) $$\n将其重排为标准形式 $a_P T_P - \\dots = b_P$，项 $\\frac{2k A_w}{\\Delta x} T_P$ 对左侧有贡献，而项 $\\frac{2k A_w}{\\Delta x} T_b$ 移至右侧。因此，对于狄利克雷边界面，我们将 $\\frac{2kA}{\\delta}$ 加到 $a_P$ 上，将 $\\frac{2kAT_b}{\\delta}$ 加到 $b_P$ 上，其中 $A$ 是面面积，$\\delta$ 是半单元宽度。\n\n**3. 诺伊曼边界（给定热通量）：**\n在具有指定热通量 $q''$ 进入域的边界面，进入控制体积的热流率就是 $q'' A$。离开控制体积的热流率为 $-q'' A$。在面上的守恒方程为 $q_f A_f = -q''_f A$。此项是一个常数，仅对源项 $b_P$ 有贡献。因此，对于诺伊曼边界面，我们将 $q''_{bnd} A$ 加到 $b_P$ 上。\n\n**4. 罗宾边界（对流）：**\n对于对流边界，流入域内的通量由 $q''=h(T_{\\infty}-T_{\\text{face}})$ 给出。从单元中心 $P$ 到面的通量为 $q''=k(T_P-T_{\\text{face}})/\\delta$。消去未知面温度 $T_{\\text{face}}$，得到一个仅与 $T_P$ 和已知环境温度 $T_{\\infty}$ 相关的通量表达式：\n$$ q'' = G(T_{\\infty}-T_P)/A \\quad \\text{其中} \\quad G = \\frac{1}{\\frac{\\delta}{kA} + \\frac{1}{hA}} = \\frac{(k/\\delta)h}{h + (k/\\delta)}A $$\n通过该面进入的总热流率为 $q''A=G(T_{\\infty}-T_P)$。整理后，项 $G T_P$ 对 方程左侧有贡献，因此我们将 $G$ 加到 $a_P$。项 $G T_{\\infty}$ 对右侧有贡献，因此我们将 $G T_{\\infty}$ 加到 $b_P$。\n\n**5. 体积源项：**\n积分后的体积热源 $\\dot{q} V_P = \\dot{q} \\Delta x \\Delta y$ 是对源项 $b_P$ 的一个常数贡献。\n\n**组装与验证程序：**\n实现分为两部分。首先，一个通用程序通过遍历每个单元 $(i,j)$（其中 $i=0, \\dots, n_x-1$ 和 $j=0, \\dots, n_y-1$）并根据单元位置应用上述规则，以编程方式为整个 $n_x \\times n_y$ 网格组装六个系数数组（$a_P, a_W, a_E, a_S, a_N, b_P$）。其次，为了验证此通用实现，一个单独的函数通过直接应用相同的公式集（针对该单元特定的边界和内界面组合进行硬编码），计算单个指定单元的期望系数。最后，对于选定的代表性单元，将通用组装的结果与特定的、独立计算的期望值进行比较。当且仅当给定单元的所有六个系数在绝对容差 $\\varepsilon = 10^{-10}$ 内匹配时，返回布尔值 `true`。对所有指定的测试案例重复此过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Assembles and verifies finite volume nodal equation coefficients for a 2D heat conduction problem.\n    \"\"\"\n    test_cases = [\n        # Test Case A\n        {\n            \"nx\": 3, \"ny\": 3, \"dx\": 0.1, \"dy\": 0.1,\n            \"k\": 20.0, \"q_dot\": 1.0e5,\n            \"T_W\": 400.0, \"q_E\": 5000.0, \"q_S\": 0.0,\n            \"h_N\": 25.0, \"T_inf_N\": 300.0,\n        },\n        # Test Case B\n        {\n            \"nx\": 3, \"ny\": 3, \"dx\": 0.05, \"dy\": 0.2,\n            \"k\": 50.0, \"q_dot\": 0.0,\n            \"T_W\": 310.0, \"q_E\": -2000.0, \"q_S\": 0.0,\n            \"h_N\": 100.0, \"T_inf_N\": 350.0,\n        },\n        # Test Case C\n        {\n            \"nx\": 3, \"ny\": 3, \"dx\": 0.08, \"dy\": 0.12,\n            \"k\": 10.0, \"q_dot\": 2.0e4,\n            \"T_W\": 300.0, \"q_E\": 0.0, \"q_S\": 1000.0,\n            \"h_N\": 1.0e4, \"T_inf_N\": 330.0,\n        },\n    ]\n\n    verification_cells = [(1, 1), (0, 1), (2, 1), (1, 2), (1, 0), (0, 2)]\n    tolerance = 1e-10\n    all_results = []\n\n    def assemble_coefficients(params):\n        nx, ny, dx, dy = params[\"nx\"], params[\"ny\"], params[\"dx\"], params[\"dy\"]\n        k, q_dot = params[\"k\"], params[\"q_dot\"]\n        T_W, q_E, q_S = params[\"T_W\"], params[\"q_E\"], params[\"q_S\"]\n        h_N, T_inf_N = params[\"h_N\"], params[\"T_inf_N\"]\n        \n        a_P = np.zeros((ny, nx))\n        a_W = np.zeros((ny, nx))\n        a_E = np.zeros((ny, nx))\n        a_S = np.zeros((ny, nx))\n        a_N = np.zeros((ny, nx))\n        b_P = np.zeros((ny, nx))\n\n        V = dx * dy\n        \n        for j in range(ny):\n            for i in range(nx):\n                # Volumetric source term\n                b_P[j, i] += q_dot * V\n\n                # West face\n                if i == 0:  # West boundary (Dirichlet)\n                    delta_w = dx / 2\n                    A_w = dy\n                    term = 2 * k * A_w / delta_w\n                    a_P[j, i] += term\n                    b_P[j, i] += term * T_W\n                else:  # Internal face\n                    D_w = k * dy / dx\n                    a_P[j, i] += D_w\n                    a_W[j, i] = D_w\n                \n                # East face\n                if i == nx - 1:  # East boundary (Neumann)\n                    A_e = dy\n                    b_P[j, i] += q_E * A_e\n                else:  # Internal face\n                    D_e = k * dy / dx\n                    a_P[j, i] += D_e\n                    a_E[j, i] = D_e\n\n                # South face\n                if j == 0:  # South boundary (Neumann)\n                    A_s = dx\n                    b_P[j, i] += q_S * A_s\n                else:  # Internal face\n                    D_s = k * dx / dy\n                    a_P[j, i] += D_s\n                    a_S[j, i] = D_s\n\n                # North face\n                if j == ny - 1:  # North boundary (Robin)\n                    delta_n = dy / 2\n                    A_n = dx\n                    G = (k / delta_n * h_N) / (h_N + k / delta_n) * A_n\n                    a_P[j, i] += G\n                    b_P[j, i] += G * T_inf_N\n                else:  # Internal face\n                    D_n = k * dx / dy\n                    a_P[j, i] += D_n\n                    a_N[j, i] = D_n\n\n        return a_P, a_W, a_E, a_S, a_N, b_P\n\n    def get_expected_coeffs(i, j, params):\n        nx, ny, dx, dy = params[\"nx\"], params[\"ny\"], params[\"dx\"], params[\"dy\"]\n        k, q_dot = params[\"k\"], params[\"q_dot\"]\n        T_W, q_E, q_S = params[\"T_W\"], params[\"q_E\"], params[\"q_S\"]\n        h_N, T_inf_N = params[\"h_N\"], params[\"T_inf_N\"]\n        \n        aP, aW, aE, aS, aN, bP = 0.0, 0.0, 0.0, 0.0, 0.0, 0.0\n        \n        V = dx * dy\n        bP += q_dot * V\n\n        # West Face Contribution\n        if i > 0:\n            D_w = k * dy / dx\n            aP += D_w\n            aW = D_w\n        else: # i == 0\n            delta_w = dx / 2\n            A_w = dy\n            term = 2 * k * A_w / delta_w\n            aP += term\n            bP += term * T_W\n            aW = 0.0\n            \n        # East Face Contribution\n        if i  nx - 1:\n            D_e = k * dy / dx\n            aP += D_e\n            aE = D_e\n        else: # i == nx - 1\n            A_e = dy\n            bP += q_E * A_e\n            aE = 0.0\n\n        # South Face Contribution\n        if j > 0:\n            D_s = k * dx / dy\n            aP += D_s\n            aS = D_s\n        else: # j == 0\n            A_s = dx\n            bP += q_S * A_s\n            aS = 0.0\n            \n        # North Face Contribution\n        if j  ny - 1:\n            D_n = k * dx / dy\n            aP += D_n\n            aN = D_n\n        else: # j == ny - 1\n            delta_n = dy / 2\n            A_n = dx\n            G = (k / delta_n * h_N) / (h_N + k / delta_n) * A_n\n            aP += G\n            bP += G * T_inf_N\n            aN = 0.0\n\n        return aP, aW, aE, aS, aN, bP\n\n    for case in test_cases:\n        assembled_coeffs = assemble_coefficients(case)\n        aP_arr, aW_arr, aE_arr, aS_arr, aN_arr, bP_arr = assembled_coeffs\n        \n        case_results = []\n        for i, j in verification_cells:\n            # Map (i,j) which is (col, row) to numpy's (row, col) indexing\n            assembled_vals = np.array([\n                aP_arr[j, i],\n                aW_arr[j, i],\n                aE_arr[j, i],\n                aS_arr[j, i],\n                aN_arr[j, i],\n                bP_arr[j, i]\n            ])\n            \n            expected_vals = np.array(get_expected_coeffs(i, j, case))\n            \n            is_match = np.allclose(assembled_vals, expected_vals, rtol=0, atol=tolerance)\n            case_results.append(str(is_match).lower())\n        \n        all_results.extend(case_results)\n\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2468813"}, {"introduction": "系统矩阵组装完成后，理解其数学性质对于预测数值解的行为和稳定性至关重要。本练习将应用线性代数中的有力工具——盖尔圆盘定理（Gershgorin Circle Theorem），来分析一个由瞬态热扩散问题导出的矩阵 [@problem_id:2468727]。通过定位盖尔圆盘，你将能够证明该矩阵是严格对角占优和正定的，并为其最小特征值确定一个可靠的下界，这对于隐式时间步进格式的物理真实性和数值稳定性具有直接意义。", "problem": "一个一维瞬态热扩散问题在非均匀网格上使用有限体积法（FVM）进行离散化，两端采用狄利克雷（Dirichlet）边界条件。该杆具有恒定的各向同性导热系数 $k$、恒定密度 $\\rho$、恒定比热容 $c_p$ 和恒定横截面积 $A$。其控制定律为傅里叶热传导定律以及每个控制体上的能量守恒。采用时间步长为 $\\Delta t$ 的隐式（后向欧拉）时间积分方法，从时间层 $n$ 推进到 $n+1$。节点未知数是三个内部节点的温度 $\\{T_1^{n+1},T_2^{n+1},T_3^{n+1}\\}$；左右两端的边界温度是给定的，并被移至方程组的右侧项。\n\n网格几何形状如下。沿杆的距离为：从左边界到节点1的距离是 $d_L = 0.02\\,\\text{m}$，节点1和2之间的距离是 $d_{12} = 0.03\\,\\text{m}$，节点2和3之间的距离是 $d_{23} = 0.02\\,\\text{m}$，从节点3到右边界的距离是 $d_R = 0.01\\,\\text{m}$。横截面积为 $A = 0.02\\,\\text{m}^2$，导热系数为 $k = 50\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$，密度为 $\\rho = 7800\\,\\text{kg}\\,\\text{m}^{-3}$，比热容为 $c_p = 500\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，时间步长为 $\\Delta t = 2\\,\\text{s}$。每个内部节点 $i$ 周围的控制体占据了其到相邻节点或边界距离的一半，因此节点1的控制体长度为 $0.5\\,(d_L + d_{12})$，节点2的为 $0.5\\,(d_{12}+d_{23})$，节点3的为 $0.5\\,(d_{23}+d_R)$。\n\n从每个控制体的能量守恒和傅里叶定律出发，组装与时间层 $n+1$ 的未知温度向量相乘的 $3\\times 3$ 线性系统矩阵 $\\mathbf{A}$。使用这个组装好的矩阵，执行以下操作：\n\n1. 计算 $\\mathbf{A}$ 的盖尔圆盘（Gershgorin disks），指明每个行圆盘的圆心和半径。\n2. 使用盖尔圆盘界定谱的范围，并论证 $\\mathbf{A}$ 的严格对角占优性。\n3. 根据盖尔圆盘，确定 $\\mathbf{A}$ 最小特征值的最大认证下界。\n\n最终答案仅报告最小特征值的最大认证下界的单个数值，四舍五入到四位有效数字。在您的计算过程中，数值以 $\\text{W}\\,\\text{K}^{-1}$ 为单位表示，但最终的方框答案中不包含单位。", "solution": "问题陈述需进行验证。\n\n**步骤1：提取已知条件**\n- **问题类型**：一维瞬态热扩散。\n- **离散化方法**：非均匀网格上的有限体积法（FVM）。\n- **时间积分**：隐式（后向欧拉），时间步长 $\\Delta t = 2\\,\\text{s}$。\n- **边界条件**：两端为狄利克雷条件。\n- **未知数**：三个内部节点的节点温度 $\\{T_1^{n+1}, T_2^{n+1}, T_3^{n+1}\\}$。\n- **材料属性（恒定，各向同性）**：\n  - 导热系数：$k = 50\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$。\n  - 密度：$\\rho = 7800\\,\\text{kg}\\,\\text{m}^{-3}$。\n  - 比热容：$c_p = 500\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$。\n- **几何属性**：\n  - 横截面积：$A = 0.02\\,\\text{m}^2$。\n  - 节点间距：$d_L = 0.02\\,\\text{m}$（左边界到节点1），$d_{12} = 0.03\\,\\text{m}$（节点1到2），$d_{23} = 0.02\\,\\text{m}$（节点2到3），$d_R = 0.01\\,\\text{m}$（节点3到右边界）。\n- **控制体长度**：$\\Delta x_1 = 0.5(d_L + d_{12})$，$\\Delta x_2 = 0.5(d_{12} + d_{23})$，$\\Delta x_3 = 0.5(d_{23} + d_R)$。\n- **任务**：组装 $3 \\times 3$ 线性系统矩阵 $\\mathbf{A}$，计算其盖尔圆盘，使用它们界定谱的范围并证明严格对角占优性，并找到 $\\mathbf{A}$ 最小特征值的最大认证下界。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于傅里叶热传导定律和能量守恒原理，这些是传热学的基础。采用隐式时间格式的有限体积法是一种标准的、科学上合理的数值技术。\n- **适定性**：该问题提供了唯一构建系统矩阵 $\\mathbf{A}$ 所需的所有材料属性、几何数据和数值参数。任务在数学上是精确的。\n- **客观性**：问题以客观、定量的语言陈述，没有歧义或主观论断。\n\n该问题未违反任何无效性标准。它在科学上是合理的、适定的、客观的、完整的且可行的。\n\n**步骤3：结论与行动**\n该问题有效。将构建解答。\n\n**求解推导**\n一维瞬态热传导的控制方程为：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x} \\left( k \\frac{\\partial T}{\\partial x} \\right) $$\n我们应用有限体积法。节点 $i$ 周围控制体（CV）的能量守恒方程的积分形式为：\n$$ \\int_{CV_i} \\rho c_p \\frac{\\partial T}{\\partial t} \\, dV = \\int_{\\partial CV_i} k \\frac{\\partial T}{\\partial x} \\hat{n} \\cdot d\\mathbf{S} $$\n对于横截面积恒为 $A$ 的一维杆，第 $i$ 个控制体的体积为 $V_i = A \\Delta x_i$。方程变为：\n$$ \\rho c_p A \\Delta x_i \\frac{dT_i}{dt} = q_w - q_e $$\n其中 $q_w$ 和 $q_e$ 分别是通过控制体西面和东面的传热率。使用时间步长为 $\\Delta t$ 的隐式（后向欧拉）时间离散，我们对时间导数进行近似，并在未来的时间层 $n+1$ 处计算空间通量：\n$$ \\rho c_p A \\Delta x_i \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = q_w^{n+1} - q_e^{n+1} $$\n由傅里叶定律，两点 $a$ 和 $b$ 之间相距 $d_{ab}$ 的热通量为：$q_{ab} = k A \\frac{T_a - T_b}{d_{ab}}$。\n\n现在我们为三个内部节点中的每一个推导具体方程。\n\n**节点 1：**\n节点1的控制体长度为 $\\Delta x_1 = 0.5(d_L + d_{12})$。能量平衡方程为：\n$$ \\rho c_p A \\Delta x_1 \\frac{T_1^{n+1} - T_1^n}{\\Delta t} = k A \\frac{T_L^{n+1} - T_1^{n+1}}{d_L} - k A \\frac{T_1^{n+1} - T_2^{n+1}}{d_{12}} $$\n其中 $T_L$ 是左边界给定的温度。重新整理方程，将未知温度 $\\{T_1^{n+1}, T_2^{n+1}, T_3^{n+1}\\}$ 组合在左侧（LHS）：\n$$ \\left( \\frac{\\rho c_p \\Delta x_1}{\\Delta t} + \\frac{k}{d_L} + \\frac{k}{d_{12}} \\right) A T_1^{n+1} - \\left( \\frac{k}{d_{12}} \\right) A T_2^{n+1} = \\text{RHS}_1 $$\n右侧（RHS）包含来自前一时间步长和边界条件的已知量。由此，我们确定矩阵 $\\mathbf{A}$ 第一行的系数：\n$A_{11} = \\left( \\frac{\\rho c_p \\Delta x_1}{\\Delta t} + \\frac{k}{d_L} + \\frac{k}{d_{12}} \\right) A$\n$A_{12} = -\\frac{k A}{d_{12}}$\n$A_{13} = 0$\n\n**节点 2：**\n节点2的控制体长度为 $\\Delta x_2 = 0.5(d_{12} + d_{23})$。能量平衡方程为：\n$$ \\rho c_p A \\Delta x_2 \\frac{T_2^{n+1} - T_2^n}{\\Delta t} = k A \\frac{T_1^{n+1} - T_2^{n+1}}{d_{12}} - k A \\frac{T_2^{n+1} - T_3^{n+1}}{d_{23}} $$\n重新整理得到：\n$$ -\\left( \\frac{k}{d_{12}} \\right) A T_1^{n+1} + \\left( \\frac{\\rho c_p \\Delta x_2}{\\Delta t} + \\frac{k}{d_{12}} + \\frac{k}{d_{23}} \\right) A T_2^{n+1} - \\left( \\frac{k}{d_{23}} \\right) A T_3^{n+1} = \\text{RHS}_2 $$\n第二行的系数为：\n$A_{21} = -\\frac{k A}{d_{12}}$\n$A_{22} = \\left( \\frac{\\rho c_p \\Delta x_2}{\\Delta t} + \\frac{k}{d_{12}} + \\frac{k}{d_{23}} \\right) A$\n$A_{23} = -\\frac{k A}{d_{23}}$\n\n**节点 3：**\n节点3的控制体长度为 $\\Delta x_3 = 0.5(d_{23} + d_R)$。能量平衡方程为：\n$$ \\rho c_p A \\Delta x_3 \\frac{T_3^{n+1} - T_3^n}{\\Delta t} = k A \\frac{T_2^{n+1} - T_3^{n+1}}{d_{23}} - k A \\frac{T_3^{n+1} - T_R^{n+1}}{d_R} $$\n重新整理得到：\n$$ -\\left( \\frac{k}{d_{23}} \\right) A T_2^{n+1} + \\left( \\frac{\\rho c_p \\Delta x_3}{\\Delta t} + \\frac{k}{d_{23}} + \\frac{k}{d_R} \\right) A T_3^{n+1} = \\text{RHS}_3 $$\n第三行的系数为：\n$A_{31} = 0$\n$A_{32} = -\\frac{k A}{d_{23}}$\n$A_{33} = \\left( \\frac{\\rho c_p \\Delta x_3}{\\Delta t} + \\frac{k}{d_{23}} + \\frac{k}{d_R} \\right) A$\n\n**矩阵 A 的数值组装**\n我们代入给定的数值。首先，我们计算辅助项。所有单位均为国际单位制（SI）。\n$\\rho c_p = 7800 \\times 500 = 3.9 \\times 10^6$\n$\\frac{\\rho c_p}{\\Delta t} = \\frac{3.9 \\times 10^6}{2} = 1.95 \\times 10^6$\n$\\Delta x_1 = 0.5(0.02 + 0.03) = 0.025$\n$\\Delta x_2 = 0.5(0.03 + 0.02) = 0.025$\n$\\Delta x_3 = 0.5(0.02 + 0.01) = 0.015$\n\n现在我们计算矩阵元素。每个元素的单位是 $\\text{W}\\,\\text{K}^{-1}$。\n$A_{11} = \\left( (1.95 \\times 10^6 \\times 0.025) + \\frac{50}{0.02} + \\frac{50}{0.03} \\right) \\times 0.02 = \\left( 48750 + 2500 + \\frac{5000}{3} \\right) \\times 0.02 = \\left( 51250 + \\frac{5000}{3} \\right) \\times 0.02 = \\left( \\frac{153750+5000}{3} \\right) \\times 0.02 = \\frac{158750}{3} \\times 0.02 = \\frac{3175}{3}$。\n$A_{12} = -\\frac{50 \\times 0.02}{0.03} = -\\frac{1}{0.03} = -\\frac{100}{3}$。\n$A_{13} = 0$。\n\n$A_{21} = A_{12} = -\\frac{100}{3}$。\n$A_{22} = \\left( (1.95 \\times 10^6 \\times 0.025) + \\frac{50}{0.03} + \\frac{50}{0.02} \\right) \\times 0.02 = \\left( 48750 + \\frac{5000}{3} + 2500 \\right) \\times 0.02 = \\frac{3175}{3}$。\n$A_{23} = -\\frac{50 \\times 0.02}{0.02} = -50$。\n\n$A_{31} = 0$。\n$A_{32} = A_{23} = -50$。\n$A_{33} = \\left( (1.95 \\times 10^6 \\times 0.015) + \\frac{50}{0.02} + \\frac{50}{0.01} \\right) \\times 0.02 = (29250 + 2500 + 5000) \\times 0.02 = 36750 \\times 0.02 = 735$。\n\n组装后的矩阵 $\\mathbf{A}$ 是对称的：\n$$ \\mathbf{A} = \\begin{pmatrix} \\frac{3175}{3}  -\\frac{100}{3}  0 \\\\ -\\frac{100}{3}  \\frac{3175}{3}  -50 \\\\ 0  -50  735 \\end{pmatrix} \\approx \\begin{pmatrix} 1058.33  -33.33  0 \\\\ -33.33  1058.33  -50 \\\\ 0  -50  735.00 \\end{pmatrix} $$\n\n**盖尔圆盘分析**\n盖尔圆盘定理指出，矩阵 $\\mathbf{A}$ 的每个特征值都至少位于其一个盖尔圆盘内。第 $i$ 个圆盘 $G_i$ 以对角元素 $A_{ii}$ 为圆心，半径为 $R_i = \\sum_{j \\neq i} |A_{ij}|$。\n\n1. **计算盖尔圆盘：**\n   - 对于第1行：圆心 $C_1 = A_{11} = \\frac{3175}{3}$。半径 $R_1 = |A_{12}| + |A_{13}| = |-\\frac{100}{3}| + |0| = \\frac{100}{3}$。\n   - 对于第2行：圆心 $C_2 = A_{22} = \\frac{3175}{3}$。半径 $R_2 = |A_{21}| + |A_{23}| = |-\\frac{100}{3}| + |-50| = \\frac{100}{3} + 50 = \\frac{250}{3}$。\n   - 对于第3行：圆心 $C_3 = A_{33} = 735$。半径 $R_3 = |A_{31}| + |A_{32}| = |0| + |-50| = 50$。\n\n2. **界定谱范围并论证严格对角占优性：**\n   由于 $\\mathbf{A}$ 是一个实对称矩阵，其特征值为实数。特征值必须位于由这些圆盘定义的实数区间的并集内：\n   - 区间1：$[C_1 - R_1, C_1 + R_1] = [\\frac{3075}{3}, \\frac{3275}{3}] = [1025, 1091.\\overline{6}]$\n   - 区间2：$[C_2 - R_2, C_2 + R_2] = [\\frac{2925}{3}, \\frac{3425}{3}] = [975, 1141.\\overline{6}]$\n   - 区间3：$[C_3 - R_3, C_3 + R_3] = [735 - 50, 735 + 50] = [685, 785]$\n   谱 $\\sigma(\\mathbf{A})$ 包含在并集 $[685, 785] \\cup [975, 1141.\\overline{6}]$ 中。\n\n   如果对于所有 $i$ 都有 $|A_{ii}| > R_i$，则矩阵是严格对角占优（SDD）的。\n   - 第1行：$|\\frac{3175}{3}| \\approx 1058.33 > \\frac{100}{3} \\approx 33.33$。成立。\n   - 第2行：$|\\frac{3175}{3}| \\approx 1058.33 > \\frac{250}{3} \\approx 83.33$。成立。\n   - 第3行：$|735| > 50$。成立。\n   矩阵 $\\mathbf{A}$ 是严格对角占优的。对于具有正对角元素的对称矩阵，SDD 意味着它是正定的，即其所有特征值都严格为正。我们的区间证实了这一点。\n\n3. **最小特征值的最大认证下界：**\n   根据盖尔圆盘定理，对于任意特征值 $\\lambda \\in \\sigma(\\mathbf{A})$，存在某个 $i$ 使得 $|\\lambda - A_{ii}| \\le R_i$。这意味着 $\\lambda \\ge A_{ii} - R_i$。因此，所有特征值必须大于或等于这些下界的最小值：\n   $$ \\lambda_{min} \\ge \\min_{i} (A_{ii} - R_i) $$\n   每个圆盘的下界是：\n   - $C_1 - R_1 = 1025$\n   - $C_2 - R_2 = 975$\n   - $C_3 - R_3 = 685$\n   因此，$\\lambda_{min} \\ge \\min(1025, 975, 685) = 685$。\n\n   此外，该定理的第二部分指出，如果 $k$ 个圆盘的并集与其余 $n-k$ 个圆盘的并集不相交，则第一个并集恰好包含 $k$ 个特征值。这里，$G_1 \\cup G_2$（对应于区间 $[975, 1141.\\overline{6}]$）与 $G_3$（区间 $[685, 785]$）不相交。这证明了在 $[685, 785]$ 中恰好有一个特征值，在 $[975, 1141.\\overline{6}]$ 中有两个特征值。因此，最小特征值 $\\lambda_{min}$ 必须位于区间 $[685, 785]$ 内。\n   从盖尔圆盘可以确定的 $\\lambda_{min}$ 的最大认证下界是此范围内的最小值，即 $685$。该定理不允许我们证明一个大于 $685$ 的下界，因为特征值可能恰好位于这个边界上。\n\n最小特征值的最大认证下界是 $685$。问题要求四舍五入到四位有效数字，得到 $685.0$。", "answer": "$$\\boxed{685.0}$$", "id": "2468727"}, {"introduction": "对于大规模问题，线性求解器的效率至关重要，而矩阵的结构，特别是其带宽和轮廓，对效率有巨大影响。本练习介绍逆卡西尔-麦基算法（Reverse Cuthill–McKee, RCM），这是一种经典的重排序技术，通过对矩阵进行置换来减小其带宽，从而为科列斯基（Cholesky）等分解方法减少计算量和存储需求 [@problem_id:2468747]。将此基于图论的算法应用于一个示例网格，你将具体了解到策略性重排序如何能显著提升矩阵求解过程的性能。", "problem": "一个对称稀疏线性系统是在均匀矩形网格上，使用五点有限体积格式，为各向同性热导率的稳态二维热传导问题建立节点能量平衡方程时产生的。令 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 表示组装的系数矩阵，其中 $N$ 等于内部节点数。$\\mathbf{A}$ 的无向图 $G=(V,E)$ 中，每个节点对应一个顶点（$|V|=N$），且当且仅当 $a_{ij} \\neq 0$ 且 $i \\neq j$ 时，存在一条边 $\\{i,j\\} \\in E$。在给定的节点排列 $\\pi$（使得 $\\mathbf{A}$ 的第 $i$ 行和第 $i$ 列对应于节点 $\\pi(i)$）下，$\\mathbf{A}$ 的半带宽 $\\beta$ 定义为\n$$\n\\beta(\\pi) \\equiv \\max_{\\{u,v\\} \\in E} \\left|p(u)-p(v)\\right|,\n$$\n其中 $p(u)$ 是顶点 $u$ 在排列 $\\pi$ 下在 $\\{1,2,\\dots,N\\}$ 中的位置。\n\n任务 1（推导）：从对称正定系统的图结构与其 Cholesky 分解之间的基本关系出发，论证为何重排序的一个实际目标是最小化 $\\beta(\\pi)$，并解释 Reverse Cuthill–McKee (RCM) 算法 (Reverse Cuthill–McKee (RCM)) 如何从广度优先搜索 (breadth-first search (BFS)) 的层级集合出发来追求此目标。您的推导必须从 $\\beta(\\pi)$ 的定义以及 Cholesky 因子中的填充模式包含在带宽所隐含的包络线内的观察开始。\n\n任务 2（应用）：考虑一个大小为 $3 \\times 5$ （行 $\\times$ 列）的矩形网格，节点从左上角（节点 $1$）到右下角（节点 $15$）按行主序编号。五点格式通过将每个内部节点连接到其四个轴对齐的邻居，并将每个边界节点仅连接到域内已存在的邻居来生成 $E$。按照以下精确规则将 RCM 算法应用于 $G$ 以获得排列 $\\pi_{\\mathrm{RCM}}$：\n- 选择图度最小的节点作为初始根节点；如有多个，则选择索引最小的节点。\n- 通过 BFS 执行 Cuthill–McKee 分层：维护一个先进先出队列，每次从队列中取出一个节点，当将其邻居加入队列时，按度的非递减顺序对未编号的邻居进行排序，若度相同则按索引的递增顺序排序。\n- 按照节点出队的顺序记录 Cuthill–McKee 排序。\n- 反转该序列以获得 RCM 排序。\n\n计算此网格和此排序下的半带宽 $\\beta(\\pi_{\\mathrm{RCM}})$。您的最终答案应表示为一个整数。", "solution": "该问题分为两部分。第一部分要求为稀疏线性系统的重排序策略（带宽最小化）提供理论上的论证。第二部分要求将 Reverse Cuthill–McKee 算法应用于一个特定的网格图，以计算最终的半带宽。\n\n首先，我们验证问题的陈述。给定条件为：一个来自均匀网格上二维稳态热方程的五点有限体积离散化的对称稀疏线性系统、矩阵图 $G=(V, E)$ 的定义、半带宽 $\\beta(\\pi)$ 的定义、一个 $3 \\times 5$ 网格的具体参数，以及应用 Reverse Cuthill–McKee (RCM) 算法的精确规则。该问题在科学上植根于数值分析和科学计算领域，特别是关于高效求解偏微分方程产生的稀疏线性系统。Cholesky 分解、矩阵带宽和像 RCM 这样基于图的重排序算法等概念都是标准且定义明确的。问题是适定的；RCM 算法的规则是确定性的，确保了唯一的排列，从而得到唯一的带宽。问题是自洽且客观的。问题描述中的一个微小模糊之处，即 $N$ 是*内部*节点数的一般陈述与应用于总节点数 $N=15$ 的网格的应用部分之间的对比，可以通过应用部分对图构建的详细说明得到解决，该说明包含了所有 $15$ 个节点。因此，该问题被认为是有效的。\n\n**第 1 部分：推导**\n问题涉及求解一个对称正定（SPD）线性系统 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 来自物理问题的离散化。此类系统通常使用直接法求解，特别是 Cholesky 分解，它将 $\\mathbf{A}$ 分解为 $\\mathbf{A} = \\mathbf{L}\\mathbf{L}^T$，其中 $\\mathbf{L}$ 是一个下三角矩阵。然后通过求解两个三角系统来找到解：$\\mathbf{L}\\mathbf{y} = \\mathbf{b}$（前向替换）和 $\\mathbf{L}^T\\mathbf{x} = \\mathbf{y}$（反向替换）。\n\n该方法的效率关键取决于 $\\mathbf{A}$ 的稀疏模式，更重要的是取决于 Cholesky 因子 $\\mathbf{L}$ 的稀疏模式。在分解过程中，新的非零项（称为“填充”）会出现在 $\\mathbf{L}$ 中原始矩阵 $\\mathbf{A}$ 为零的位置。也就是说，即使 $a_{ij}=0$（对于 $i > j$），$l_{ij}$ 也可能为非零。$\\mathbf{L}$ 中的非零位置集合是 $\\mathbf{A}$ 下三角部分非零位置集合的超集。\n\n对于给定的行和列排序，矩阵的半带宽定义为 $\\beta = \\max \\{|i-j| \\mid a_{ij} \\neq 0\\}$。一个重要的定理指出，如果 $\\mathbf{A}$ 是一个半带宽为 $\\beta$ 的带状矩阵，其 Cholesky 因子 $\\mathbf{L}$ 也将是带状的，并且具有相同的下半带宽 $\\beta$。这意味着所有填充都发生在*带内*。因此，分解所需的计算资源由 $\\beta$ 决定。对于一个 $N \\times N$ 的矩阵，带的存储量约为 $N(\\beta+1)$，即 $O(N\\beta)$，而带状 Cholesky 分解的浮点运算次数约为 $N\\beta^2$，即 $O(N\\beta^2)$。\n\n对底层网格图 $G$ 中的节点进行重排序，对应于对矩阵 $\\mathbf{A}$ 进行对称排列，得到 $\\mathbf{A}' = \\mathbf{P}\\mathbf{A}\\mathbf{P}^T$，其中 $\\mathbf{P}$ 是一个排列矩阵。重排序算法的目标是找到一个排列 $\\mathbf{P}$（或等效地，一个节点排列 $\\pi$），使得 $\\mathbf{A}'$ 的结构能够最小化填充和计算工作量。问题将排列 $\\pi$ 下的半带宽定义为 $\\beta(\\pi) \\equiv \\max_{\\{u,v\\} \\in E} |p(u)-p(v)|$，其中 $p(u)$ 给出节点 $u$ 的新索引（行/列号）。这个定义恰好是排列后矩阵 $\\mathbf{A}'$ 的半带宽。因此，最小化 $\\beta(\\pi)$ 是降低带状 Cholesky 求解器的 $O(N\\beta^2)$ 复杂度和 $O(N\\beta)$ 存储量的直接策略，这证明了它是一个实际的目标。\n\nCuthill–McKee (CM) 算法是一种用于最小化带宽的启发式算法。它基于对矩阵图 $G$ 的广度优先搜索（BFS）。BFS 将顶点划分为层级集合 $L_0, L_1, \\dots, L_k$，其中 $L_0$ 是起始节点，$L_i$ 包含所有与起始节点最短路径距离为 $i$ 的节点。图结构的一个关键特性是，层级 $L_i$ 中的任何节点只能与层级 $L_{i-1}$、$L_i$ 和 $L_{i+1}$ 中的节点相连。CM 算法从一个外围节点（度较低的节点）开始编号，然后逐层对 BFS 生成的节点进行编号。通过连续地对相邻层级的节点进行编号，任何相连节点对 $\\{u,v\\}$ 的索引差 $|p(u)-p(v)|$ 都会受到限制。这倾向于使矩阵的非零元素聚集在主对角线周围，从而减小带宽。\n\nReverse Cuthill–McKee (RCM) 算法只是简单地反转 CM 产生的排序。虽然 $\\beta(\\pi_{\\mathrm{CM}}) = \\beta(\\pi_{\\mathrm{RCM}})$，但根据经验和理论，RCM 通常比 CM 产生更少的总填充。这是因为 RCM 倾向于更有效地减小矩阵的*包络*或*轮廓*，这是衡量通用稀疏（非严格带状）Cholesky 分解所需工作量的更精确指标。填充包含在每行第一个非零元素定义的包络线内。RCM 的有效性源于它构建分解过程中依赖关系的方式。\n\n**第 2 部分：应用**\n我们将 RCM 算法应用于 $3 \\times 5$ 网格。节点按行主序从 $1$ 到 $15$ 编号。\n网格和节点邻接关系（图 $G$）由五点格式定义。首先，我们确定每个节点的度：\n- 角节点 $\\{1, 5, 11, 15\\}$ 的度为 $2$。\n- 边节点 $\\{2, 3, 4, 6, 10, 12, 13, 14\\}$ 的度为 $3$。\n- 内部节点 $\\{7, 8, 9\\}$ 的度为 $4$。\n\nRCM 算法的执行步骤如下：\n1.  **选择根节点：** 选择一个度最小的节点。最小度为 $2$，对应于节点 $\\{1, 5, 11, 15\\}$。平局规则指定选择索引最小的一个。因此，根节点是 $1$。\n\n2.  **使用 BFS 生成 Cuthill–McKee 排序：** 我们维护一个队列 $Q$、一个已访问集合 `visited` 和结果列表 $R$。\n    - 开始时, $R=[]$, $Q=[1]$, `visited={1}`.\n    - 将 $1$ 出队, 加入 $R$ ($R=[1]$). 它的未访问邻居是 {2, 6}. deg(2)=3, deg(6)=3. 按索引排序: {2, 6}. 入队 $Q=[2, 6]$, `visited` 添加 {2, 6}.\n    - 将 $2$ 出队, 加入 $R$ ($R=[1, 2]$). 它的未访问邻居是 {3, 7}. deg(3)=3, deg(7)=4. 排序: {3, 7}. 入队 $Q=[6, 3, 7]$, `visited` 添加 {3, 7}.\n    - 将 $6$ 出队, 加入 $R$ ($R=[1, 2, 6]$). 它的未访问邻居是 {5, 11}. deg(5)=2, deg(11)=2. 排序: {5, 11}. 入队 $Q=[3, 7, 5, 11]$, `visited` 添加 {5, 11}.\n    - 将 $3$ 出队, 加入 $R$ ($R=[1, 2, 6, 3]$). 它的未访问邻居是 {4, 8}. deg(4)=3, deg(8)=4. 排序: {4, 8}. 入队 $Q=[7, 5, 11, 4, 8]$, `visited` 添加 {4, 8}.\n    - 将 $7$ 出队, 加入 $R$ ($R=[1, 2, 6, 3, 7]$). 它的未访问邻居是 {12}. deg(12)=3. 入队 $Q=[5, 11, 4, 8, 12]$, `visited` 添加 {12}.\n    - 将 $5$ 出队, 加入 $R$ ($R=[1, 2, 6, 3, 7, 5]$). 它的未访问邻居是 {10}. deg(10)=3. 入队 $Q=[11, 4, 8, 12, 10]$, `visited` 添加 {10}.\n    - 将 $11$ 出队, 加入 $R$ ($R=[1, 2, 6, 3, 7, 5, 11]$). 无未访问邻居. $Q=[4, 8, 12, 10]$.\n    - 将 $4$ 出队, 加入 $R$ ($R=[..., 11, 4]$). 它的未访问邻居是 {9}. deg(9)=4. 入队 $Q=[8, 12, 10, 9]$, `visited` 添加 {9}.\n    - 将 $8$ 出队, 加入 $R$ ($R=[..., 4, 8]$). 它的未访问邻居是 {13}. deg(13)=3. 入队 $Q=[12, 10, 9, 13]$, `visited` 添加 {13}.\n    - 将 $12$ 出队, 加入 $R$ ($R=[..., 8, 12]$). 无未访问邻居. $Q=[10, 9, 13]$.\n    - 将 $10$ 出队, 加入 $R$ ($R=[..., 12, 10]$). 它的未访问邻居是 {15}. deg(15)=2. 入队 $Q=[9, 13, 15]$, `visited` 添加 {15}.\n    - 将 $9$ 出队, 加入 $R$ ($R=[..., 10, 9]$). 它的未访问邻居是 {14}. deg(14)=3. 入队 $Q=[13, 15, 14]$, `visited` 添加 {14}.\n    - 依次将 $13, 15, 14$ 出队并加入 $R$。\n\n    Cuthill–McKee 排序是：\n    $\\pi_{\\mathrm{CM}} = (1, 2, 6, 3, 7, 5, 11, 4, 8, 12, 10, 9, 13, 15, 14)$。\n\n3.  **反转排序：** RCM 排序是 CM 排序的反转：\n    $\\pi_{\\mathrm{RCM}} = (14, 15, 13, 9, 10, 12, 8, 4, 11, 5, 7, 3, 6, 2, 1)$。\n\n4.  **计算半带宽：** 我们根据此排序建立新的位置函数 $p(u)$。$p(14)=1, p(15)=2, p(13)=3, p(9)=4, p(10)=5, p(12)=6, p(8)=7, p(4)=8, p(11)=9, p(5)=10, p(7)=11, p(3)=12, p(6)=13, p(2)=14, p(1)=15$。我们现在必须在所有边 $\\{u,v\\} \\in E$ 上找到 $|p(u)-p(v)|$ 的最大值。\n\n    我们检查所有边的索引差异：\n    - 水平边：$|p(1)-p(2)|=1, |p(2)-p(3)|=2, |p(3)-p(4)|=4, |p(4)-p(5)|=2, |p(6)-p(7)|=2, |p(7)-p(8)|=4, |p(8)-p(9)|=3, |p(9)-p(10)|=1, |p(11)-p(12)|=3, |p(12)-p(13)|=3, |p(13)-p(14)|=2, |p(14)-p(15)|=1$。\n    - 垂直边：$|p(1)-p(6)|=2, |p(2)-p(7)|=3, |p(3)-p(8)|=5, |p(4)-p(9)|=4, |p(5)-p(10)|=5, |p(6)-p(11)|=4, |p(7)-p(12)|=5, |p(8)-p(13)|=4, |p(9)-p(14)|=3, |p(10)-p(15)|=3$。\n\n    最大差值为 $5$，出现在边 $\\{3,8\\}$、$\\{5,10\\}$ 和 $\\{7,12\\}$ 上。\n    因此，此排序的半带宽为 $\\beta(\\pi_{\\mathrm{RCM}}) = 5$。\n    (初始排序的半带宽是 $\\max(|6-1|, |7-2|, \\dots) = 5$，因此 RCM 在此例中没有减小半带宽，但通常会减小轮廓。)", "answer": "$$\\boxed{5}$$", "id": "2468747"}]}