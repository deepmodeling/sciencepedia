{"hands_on_practices": [{"introduction": "均匀化理论旨在为非均质介质推导等效属性，从而使我们能在更大尺度上将其作为均质材料进行建模。本实践通过一个基础案例——层状复合材料——来探索这一核心概念。通过计算平行和垂直于层状结构的等效热导率，您将直接观察到微观结构排列如何决定宏观各向异性行为，并学习“混合法则”的物理基础。[@problem_id:2508571]", "problem": "一种周期性层压复合材料由两种均匀、各向同性材料的平直层交替组成，其热导率分别为 $k_{1}$ 和 $k_{2}$。这些层完美粘合，在 $y$ 方向上空间周期性排布，周期为 $\\ell$，并在 $x$ 和 $z$ 方向上无限延伸。在一个周期内，两层的厚度分别为 $t_{1}$ 和 $t_{2}$，材料1的体积分数为 $f = t_{1}/(t_{1}+t_{2})$。假设为稳态热传导，无内部热源，且存在明显的尺度分离，$0  \\epsilon = \\ell/L \\ll 1$，其中 $L$ 是施加温度变化的宏观长度。\n\n请仅从傅立叶热传导定律和局部能量守恒出发，使用代表性体积单元和双尺度均匀化或等效的体积平均法，推导平行于和垂直于层板方向的等效热导率。对于每种加载情况，请阐明所需的关于宏观温度梯度形式的任何假设。然后，简要讨论均匀化介质的各向异性类别，以及当 $k_{1}$ 和 $k_{2}$ 为正值时，两种等效热导率之间的大小关系。\n\n请将您的最终答案表示为一个数对，包含平行于层板的等效热导率 $k_{\\parallel}$ 和垂直于层板的等效热导率 $k_{\\perp}$，以 $k_{1}$、$k_{2}$ 和 $f$ 的函数闭合形式表示。最终答案不应包含单位，也无需进行数值四舍五入。请将最终的数对以单行矩阵的形式呈现。", "solution": "该问题是周期性介质均匀化中的一个基础练习，具体涉及确定层压复合材料的等效热性能。该问题具有科学依据，是适定的，并包含了获得唯一解所需的所有信息。我们认为该问题有效，并着手进行推导。\n\n该问题所遵循的物理原理是在无内部热源的介质中的稳态热传导。这由能量守恒方程 $\\nabla \\cdot \\mathbf{q} = 0$ 描述，其中 $\\mathbf{q}$ 是热通量矢量。连接热通量与温度场 $T$ 的本构关系是傅立叶定律，$\\mathbf{q} = -k \\nabla T$。热导率 $k$ 是空间坐标 $y$ 的分段常数函数，在相应层中取值为 $k_{1}$ 和 $k_{2}$。\n\n目标是找到等效热导率张量 $\\mathbf{K}_{\\text{eff}}$，它通过宏观定律 $\\langle\\mathbf{q}\\rangle = -\\mathbf{K}_{\\text{eff}} \\langle\\nabla T\\rangle$ 将体积平均热通量 $\\langle\\mathbf{q}\\rangle$ 与体积平均温度梯度 $\\langle\\nabla T\\rangle$ 联系起来。平均是在一个代表性体积单元（RVE）上进行的，在本例中，该RVE是在 $y$ 方向上周期为 $\\ell = t_{1} + t_{2}$、在 $x$ 和 $z$ 方向上为任意单位长度的单元。由于层状结构，等效性能将是各向异性的。我们分析两种主要情况，分别对应于平行于和垂直于层板的热流。\n\n情况1：热流平行于层板（例如，在 $x$ 方向）。\n对于这种情况，我们施加一个沿 $x$ 轴方向的均匀宏观温度梯度，$\\langle\\nabla T\\rangle = (G_{x}, 0, 0)$，其中 $G_{x}$ 是一个常数。任意点的温度可以写为 $T(x,y) = G_{x}x + T'(x,y)$，其中 $T'$ 是一个周期性扰动。此加载的一个关键假设是温度场在层间界面上是连续的。此外，由于各层在 $x$ 方向是均匀且无限延伸的，等温面是垂直于 $x$ 轴的平面。这意味着对于此特定加载条件，在RVE内温度 $T$ 不随 $y$ 变化。因此，两种材料层中的温度梯度是相同的，并且等于施加的宏观梯度：\n$$ \\nabla T_{1} = \\nabla T_{2} = \\langle\\nabla T\\rangle = (G_{x}, 0, 0) $$\n每种材料层内的热通量矢量由傅立叶定律给出：\n$$ \\mathbf{q}_{1} = -k_{1} \\nabla T_{1} = (-k_{1} G_{x}, 0, 0) $$\n$$ \\mathbf{q}_{2} = -k_{2} \\nabla T_{2} = (-k_{2} G_{x}, 0, 0) $$\n体积平均热通量 $\\langle\\mathbf{q}\\rangle$ 是每种材料中热通量的加权平均，权重是它们各自的体积分数。材料1的体积分数为 $f = t_{1}/\\ell$，材料2的体积分数为 $1-f = t_{2}/\\ell$。\n$$ \\langle q_{x} \\rangle = f q_{x,1} + (1-f) q_{x,2} = f (-k_{1} G_{x}) + (1-f) (-k_{2} G_{x}) $$\n$$ \\langle q_{x} \\rangle = -[f k_{1} + (1-f) k_{2}] G_{x} $$\n根据定义，宏观关系为 $\\langle q_{x} \\rangle = -k_{\\parallel} \\langle \\nabla_{x} T \\rangle = -k_{\\parallel} G_{x}$。将此与通过体积平均推导出的表达式进行比较，我们确定了平行于层板的等效热导率：\n$$ k_{\\parallel} = f k_{1} + (1-f) k_{2} $$\n这个结果是热导率的算术平均值，通常称为Voigt界或混合法则。它类似于电路中的电阻并联。\n\n情况2：热流垂直于层板（在 $y$ 方向）。\n对于这种情况，我们沿 $y$ 轴施加一个均匀的宏观温度梯度（或热通量）。最直接的方法是假设一个恒定的热通量 $Q_{y}$ 沿 $y$ 方向流动。根据稳态能量守恒方程 $\\nabla \\cdot \\mathbf{q} = \\frac{\\partial q_{y}}{\\partial y} = 0$，垂直于界面的热通量分量必须在整个RVE内是连续且恒定的。因此，\n$$ q_{y,1} = q_{y,2} = \\langle q_{y} \\rangle = Q_{y} $$\n每个材料层内的温度梯度则由傅立叶定律确定：\n$$ \\nabla_{y} T_{1} = -\\frac{q_{y,1}}{k_{1}} = -\\frac{Q_{y}}{k_{1}} $$\n$$ \\nabla_{y} T_{2} = -\\frac{q_{y,2}}{k_{2}} = -\\frac{Q_{y}}{k_{2}} $$\n一个周期 $\\ell$ 内的总温降是各层温降之和。平均温度梯度 $\\langle\\nabla_{y} T\\rangle$ 是这个总温降除以总厚度 $\\ell$：\n$$ \\langle \\nabla_{y} T \\rangle = \\frac{\\Delta T_{\\text{total}}}{\\ell} = \\frac{(\\nabla_{y} T_{1}) t_{1} + (\\nabla_{y} T_{2}) t_{2}}{t_{1} + t_{2}} $$\n代入各层梯度的表达式：\n$$ \\langle \\nabla_{y} T \\rangle = \\frac{(-\\frac{Q_{y}}{k_{1}}) t_{1} + (-\\frac{Q_{y}}{k_{2}}) t_{2}}{t_{1} + t_{2}} = -Q_{y} \\left( \\frac{t_{1}/\\ell}{k_{1}} + \\frac{t_{2}/\\ell}{k_{2}} \\right) $$\n使用体积分数 $f = t_{1}/\\ell$ 和 $1-f = t_{2}/\\ell$：\n$$ \\langle \\nabla_{y} T \\rangle = -Q_{y} \\left( \\frac{f}{k_{1}} + \\frac{1-f}{k_{2}} \\right) $$\n宏观关系为 $\\langle q_{y} \\rangle = -k_{\\perp} \\langle \\nabla_{y} T \\rangle$，或 $Q_{y} = -k_{\\perp} \\langle \\nabla_{y} T \\rangle$。将此代入前一个方程得到：\n$$ \\langle \\nabla_{y} T \\rangle = -(-k_{\\perp} \\langle \\nabla_{y} T \\rangle) \\left( \\frac{f}{k_{1}} + \\frac{1-f}{k_{2}} \\right) $$\n假设温度梯度非平凡，即 $\\langle \\nabla_{y} T \\rangle \\neq 0$，我们可以消去它得到：\n$$ 1 = k_{\\perp} \\left( \\frac{f}{k_{1}} + \\frac{1-f}{k_{2}} \\right) $$\n求解垂直于层板的等效热导率 $k_{\\perp}$：\n$$ k_{\\perp} = \\left( \\frac{f}{k_{1}} + \\frac{1-f}{k_{2}} \\right)^{-1} $$\n这个结果是热导率的调和平均值，通常称为Reuss界。它类似于电路中的电阻串联。\n\n各向异性类别和大小关系：\n在与层板对齐的坐标系中（$x, z$ 平行；$y$ 垂直），等效热导率张量 $\\mathbf{K}_{\\text{eff}}$ 是对角矩阵：\n$$ \\mathbf{K}_{\\text{eff}} = \\begin{pmatrix} k_{\\parallel}  0  0 \\\\ 0  k_{\\perp}  0 \\\\ 0  0  k_{\\parallel} \\end{pmatrix} $$\n由于 $k_{xx} = k_{zz} = k_{\\parallel}$ 且 $k_{yy} = k_{\\perp}$，并且通常 $k_{\\parallel} \\neq k_{\\perp}$，因此均匀化介质是横向各向同性（或单轴各向异性）的。旋转对称轴是垂直于层板的 $y$ 轴。\n\n关于热导率的大小关系，我们比较算术平均值（$k_{\\parallel}$）和调和平均值（$k_{\\perp}$）。对于任意一组正数，算术平均值大于或等于调和平均值。当且仅当集合中所有数都相等时，等号成立。对于我们这里正的热导率 $k_{1}, k_{2}  0$ 和体积分数 $0  f  1$ 的情况，我们有 $k_{\\parallel} \\ge k_{\\perp}$。等号仅在材料相同的平凡情况下成立，即 $k_{1} = k_{2}$。其物理解释是，平行于层板的热流可以利用高热导率的路径，导致更高的等效热导率；而垂直于层板的热流被迫穿过所有层，包括电阻最大（热导率最低）的层，这限制了总热通量，从而导致较低的等效热导率。", "answer": "$$\\boxed{\\begin{pmatrix} f k_{1} + (1-f) k_{2}  \\left(\\frac{f}{k_{1}} + \\frac{1-f}{k_{2}}\\right)^{-1} \\end{pmatrix}}$$", "id": "2508571"}, {"introduction": "现实世界中的多尺度问题通常涉及多种物理过程的耦合。本练习深入探讨了这样一个场景，通过研究多孔催化剂颗粒，这是一个化学反应工程中的经典问题，其中扩散、化学反应和热传递相互交织。您将推导并使用诸如 Thiele 模量之类的关键无量纲参数，来量化反应动力学和传质限制之间的相互作用，这是设计和分析反应体系的一项关键技能。[@problem_id:2508584]", "problem": "一个半径为 $R$ 的球形多孔催化剂单颗粒被稀薄的气态反应物 $A$ 穿过，反应物 $A$ 在孔隙空间内发生本征一级反应 $r_{A} = k(T)\\,C_{A}$。有效扩散系数为 $D_{\\mathrm{e}} = \\varepsilon D_{m} / \\tau$，其中 $\\varepsilon$ 是孔隙率，$\\tau$ 是曲折因子，$D_{m}$ 是分子扩散系数。假设颗粒内部处于准稳态条件，且对流可忽略不计。微观尺度的质量平衡由物种守恒和菲克扩散控制。边界条件为中心处径向对称，以及在 $r=R$ 处有给定的表面浓度 $C_{A,s}$。该反应是放热的，反应热为 $-\\Delta H$（其中 $\\Delta H > 0$）。颗粒具有很高的内部导热系数，因此其内部在均匀的颗粒温度 $T_{p}$ 下是空间等温的，并通过一个外部传热系数 $h$ 与温度为 $T_{b}$ 的环境进行热交换；外部传质阻力可以忽略不计，因此表面浓度等于主体浓度，$C_{A}(R)=C_{A,s}$。反应速率常数遵循阿伦尼乌斯定律，并且为了便于解析处理，您可以使用弗兰克-卡门涅茨基（Frank–Kamenetskii）大活化能近似，该近似在 $T_{b}$ 附近线性化，即 $k(T_{p}) \\approx k(T_{b}) \\exp\\!\\big(\\gamma\\,(T_{p}-T_{b})\\big)$，其中 $\\gamma \\equiv E/(R_{g} T_{b}^{2})$，$E$ 是活化能，$R_{g}$ 是普适气体常数。\n\n仅使用质量和能量守恒的第一性原理以及所述的本构关系，并明确区分微观尺度（颗粒内扩散-反应）和宏观尺度（颗粒-环境热交换）的步骤：\n\n- 用 $R$、$D_{\\mathrm{e}}$ 和 $k(T)$ 推导球形颗粒的Thiele模数 $\\phi$ 的精确定义。\n- 求解微观尺度等温问题，得到一级动力学的球形颗粒的等温有效因子 $\\eta_{\\mathrm{iso}}(\\phi)$，其定义为颗粒内实际总反应速率与假设整个颗粒处于表面浓度 $C_{A,s}$ 且具有相同本征动力学时的总速率之比。\n- 接着，将微观尺度的结果与宏观尺度的能量平衡耦合，得到一个非等温全局有效因子 $\\eta_{\\mathrm{noniso}}$ 的闭式解析表达式，其定义为颗粒在 $T_{p}$ 温度下的实际总反应速率与在环境温度 $T_{b}$ 下且无内部扩散阻力时的假设总速率之比。在此宏观步骤中，假设颗粒内浓度分布可以由在 $T_{b}$ 处计算的等温解很好地近似，因此唯一的非等温效应通过 $k(T_{p})$ 的温度依赖性及由此产生的热平衡进入。定义几何因子 $S \\equiv \\dfrac{(-\\Delta H)\\,k(T_{b})\\,C_{A,s}\\,V}{h\\,A}$，其中 $V$ 和 $A$ 分别为颗粒体积和表面积，如果需要，可使用兰伯特W函数（Lambert W function，也称乘积对数）。\n\n将您的最终答案以单行矩阵的形式给出，包含三个解析表达式，顺序为 $\\big[\\phi,\\ \\eta_{\\mathrm{iso}}(\\phi),\\ \\eta_{\\mathrm{noniso}}\\big]$。不需要进行数值计算，最终表达式内不应包含任何单位。仅使用精确的符号形式。", "solution": "所给出的问题陈述是化学反应工程中的一个标准问题，具体来说是对非等温多孔催化剂颗粒的分析。该问题具有科学依据、提法适定，并提供了所有必要的参数和本构关系。所使用的模型——菲克扩散、一级动力学、带有弗兰克-卡门涅茨基近似的阿伦尼乌斯定律，以及Thiele模数和有效因子的概念——都是该领域的基础。问题在逻辑上构建为一个多尺度分析，将颗粒内（微观尺度）现象与颗粒-环境（宏观尺度）传热分开。问题没有科学上的不一致、矛盾或缺失信息。因此，该问题被认为是有效的，并将提供解答。\n\n解答按要求分为三部分推导。\n\n第一部分：Thiele模数 $\\phi$ 的推导\n\n在准稳态条件下，球形颗粒内反应物 $A$ 的微观尺度质量平衡由扩散-反应方程给出。在球坐标系中，对于径向对称情况，物种 $A$ 的守恒方程为：\n$$ \\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} N_{A,r} \\right) + R_{A} = 0 $$\n这里，$N_{A,r}$ 是 $A$ 在径向上的摩尔通量，$R_{A}$ 是 $A$ 的体积生成速率。对于一级消耗反应 $r_{A} = k(T)C_{A}$，生成速率为 $R_{A} = -r_{A} = -k(T)C_{A}$。对于对流可忽略的稀体系，菲克扩散定律表明 $N_{A,r} = -D_{\\mathrm{e}} \\frac{dC_{A}}{dr}$。将这些关系代入守恒方程，得到：\n$$ \\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} \\left(-D_{\\mathrm{e}} \\frac{dC_{A}}{dr}\\right) \\right) - k(T)C_{A} = 0 $$\n假设有效扩散系数 $D_{\\mathrm{e}}$ 在整个颗粒内是常数，我们得到：\n$$ \\frac{d^{2}C_{A}}{dr^{2}} + \\frac{2}{r} \\frac{dC_{A}}{dr} - \\frac{k(T)}{D_{\\mathrm{e}}} C_{A} = 0 $$\n为对此方程进行无量纲化，我们引入无量纲半径 $\\rho = \\frac{r}{R}$ 和无量纲浓度 $\\psi = \\frac{C_{A}}{C_{A,s}}$。导数变换为 $\\frac{d}{dr} = \\frac{1}{R}\\frac{d}{d\\rho}$ 和 $\\frac{d^2}{dr^2} = \\frac{1}{R^2}\\frac{d^2}{d\\rho^2}$。将这些代入微分方程，得到：\n$$ \\frac{1}{R^{2}} \\frac{d^{2}\\psi}{d\\rho^{2}} + \\frac{2}{R\\rho} \\frac{1}{R} \\frac{d\\psi}{d\\rho} - \\frac{k(T)}{D_{\\mathrm{e}}} \\psi = 0 $$\n两边乘以 $R^{2}$，得到无量纲形式：\n$$ \\frac{d^{2}\\psi}{d\\rho^{2}} + \\frac{2}{\\rho} \\frac{d\\psi}{d\\rho} - \\left( \\frac{k(T)R^{2}}{D_{\\mathrm{e}}} \\right) \\psi = 0 $$\nThiele模数，通常用 $\\phi$ 表示，定义为量化特征反应速率与特征扩散速率之比的无量纲数群的平方根。从方程中可知，这个数群是 $\\frac{k(T)R^{2}}{D_{\\mathrm{e}}}$。\n因此，Thiele模数定义为：\n$$ \\phi = \\sqrt{\\frac{k(T)R^{2}}{D_{\\mathrm{e}}}} = R \\sqrt{\\frac{k(T)}{D_{\\mathrm{e}}}} $$\n\n第二部分：等温有效因子 $\\eta_{\\mathrm{iso}}(\\phi)$ 的推导\n\n对于温度为 $T_{p}$ 的等温颗粒，Thiele模数为常数，$\\phi = R\\sqrt{k(T_{p})/D_{\\mathrm{e}}}$。无量纲质量平衡方程为：\n$$ \\frac{d^{2}\\psi}{d\\rho^{2}} + \\frac{2}{\\rho} \\frac{d\\psi}{d\\rho} - \\phi^{2} \\psi = 0 $$\n边界条件为：在 $\\rho=0$ 处 $\\frac{d\\psi}{d\\rho}=0$（对称性），在 $\\rho=1$ 处 $\\psi=1$（表面浓度）。\n该方程可通过变量替换 $u(\\rho) = \\rho\\psi(\\rho)$ 求解，这会将其转换为更简单的形式：\n$$ \\frac{d^{2}u}{d\\rho^{2}} - \\phi^{2}u = 0 $$\n通解为 $u(\\rho) = C_{1}\\sinh(\\phi\\rho) + C_{2}\\cosh(\\phi\\rho)$。则浓度分布为 $\\psi(\\rho) = \\frac{C_{1}\\sinh(\\phi\\rho) + C_{2}\\cosh(\\phi\\rho)}{\\rho}$。为使浓度在中心处（$\\rho=0$）为有限值，必须有 $C_{2}=0$，因为 $\\lim_{\\rho\\to 0} \\frac{\\cosh(\\phi\\rho)}{\\rho} \\to \\infty$。应用表面边界条件 $\\psi(1)=1$ 给出 $1 = \\frac{C_{1}\\sinh(\\phi)}{1}$，所以 $C_{1} = 1/\\sinh(\\phi)$。浓度分布为：\n$$ \\psi(\\rho) = \\frac{\\sinh(\\phi\\rho)}{\\rho\\sinh(\\phi)} $$\n等温有效因子 $\\eta_{\\mathrm{iso}}$ 是实际总反应速率与假设整个颗粒处于表面浓度 $C_{A,s}$ 时的速率之比。\n$$ \\eta_{\\mathrm{iso}} = \\frac{\\int_{0}^{R} k(T_p)C_{A}(r) \\, 4\\pi r^2 dr}{k(T_p)C_{A,s} \\left(\\frac{4}{3}\\pi R^3\\right)} = 3 \\int_{0}^{1} \\psi(\\rho) \\rho^2 d\\rho $$\n代入 $\\psi(\\rho)$ 的表达式：\n$$ \\eta_{\\mathrm{iso}} = 3 \\int_{0}^{1} \\frac{\\sinh(\\phi\\rho)}{\\rho\\sinh(\\phi)} \\rho^2 d\\rho = \\frac{3}{\\sinh(\\phi)} \\int_{0}^{1} \\rho\\sinh(\\phi\\rho)d\\rho $$\n使用分部积分法可得：\n$$ \\int_{0}^{1} \\rho\\sinh(\\phi\\rho)d\\rho = \\left[\\frac{\\rho\\cosh(\\phi\\rho)}{\\phi}\\right]_0^1 - \\int_{0}^{1} \\frac{\\cosh(\\phi\\rho)}{\\phi}d\\rho = \\frac{\\cosh(\\phi)}{\\phi} - \\left[\\frac{\\sinh(\\phi\\rho)}{\\phi^2}\\right]_0^1 = \\frac{\\cosh(\\phi)}{\\phi} - \\frac{\\sinh(\\phi)}{\\phi^2} $$\n将此结果代回 $\\eta_{\\mathrm{iso}}$ 的表达式中：\n$$ \\eta_{\\mathrm{iso}}(\\phi) = \\frac{3}{\\sinh(\\phi)} \\left(\\frac{\\cosh(\\phi)}{\\phi} - \\frac{\\sinh(\\phi)}{\\phi^2}\\right) = \\frac{3}{\\phi^2}\\left(\\phi\\frac{\\cosh(\\phi)}{\\sinh(\\phi)} - 1\\right) $$\n这给出了等温有效因子的最终表达式：\n$$ \\eta_{\\mathrm{iso}}(\\phi) = \\frac{3}{\\phi^2} (\\phi \\coth(\\phi) - 1) $$\n\n第三部分：非等温全局有效因子 $\\eta_{\\mathrm{noniso}}$ 的推导\n\n全局有效因子 $\\eta_{\\mathrm{noniso}}$ 定义为在颗粒温度 $T_p$ 下的实际总速率与在环境温度 $T_b$ 下无扩散限制时的假设速率之比。\n$$ \\eta_{\\mathrm{noniso}} = \\frac{\\text{实际速率}(T_p)}{\\text{假设速率}(T_b, C_{A,s}, \\text{无扩散})} $$\n分母就是 $k(T_b) C_{A,s} V$。对于分子，问题指定使用在 $T_b$ 下的等温颗粒的浓度分布，但速率常数在实际颗粒温度 $T_p$ 下计算。\n实际总速率是：\n$$ \\text{实际速率}(T_p) = \\int_V k(T_p) C_A(r; T_b) dV = k(T_p) \\int_V C_A(r; T_b) dV $$\n根据第二部分，该积分可以与在 $T_b$ 下计算的等温有效因子（我们记作 $\\eta_{\\mathrm{iso},b}$）相关联：\n$$ \\eta_{\\mathrm{iso},b} = \\frac{\\int_V k(T_b) C_A(r; T_b) dV}{k(T_b) C_{A,s} V} = \\frac{\\int_V C_A(r; T_b) dV}{C_{A,s} V} $$\n因此，$\\int_V C_A(r; T_b) dV = \\eta_{\\mathrm{iso},b} C_{A,s} V$。那么实际速率为 $k(T_p) \\eta_{\\mathrm{iso},b} C_{A,s} V$。\n全局有效因子变为：\n$$ \\eta_{\\mathrm{noniso}} = \\frac{k(T_p) \\eta_{\\mathrm{iso},b} C_{A,s} V}{k(T_b) C_{A,s} V} = \\frac{k(T_p)}{k(T_b)} \\eta_{\\mathrm{iso},b} $$\n颗粒温度 $T_p$ 由宏观尺度能量平衡决定：产生的热量等于移走的热量。\n$$ Q_{gen} = (\\text{实际速率})(-\\Delta H) = k(T_p) \\eta_{\\mathrm{iso},b} C_{A,s} V (-\\Delta H) $$\n$$ Q_{rem} = h A (T_p - T_b) $$\n令 $Q_{gen}$ 和 $Q_{rem}$ 相等，并代入弗兰克-卡门涅茨基近似 $k(T_p) = k(T_b) \\exp(\\gamma(T_p-T_b))$：\n$$ k(T_b)\\exp(\\gamma(T_p - T_b)) \\eta_{\\mathrm{iso},b} C_{A,s} V (-\\Delta H) = h A (T_p - T_b) $$\n令 $\\theta = \\gamma(T_p - T_b)$。方程变为：\n$$ \\exp(\\theta) \\frac{k(T_b) \\eta_{\\mathrm{iso},b} C_{A,s} V (-\\Delta H)}{h A} = \\frac{\\theta}{\\gamma} $$\n使用定义 $S = \\frac{(-\\Delta H)k(T_b)C_{A,s}V}{hA}$：\n$$ \\theta \\exp(-\\theta) = \\gamma S \\eta_{\\mathrm{iso},b} $$\n该方程的形式为 $-x\\exp(x) = -\\gamma S \\eta_{\\mathrm{iso},b}$，其中 $x=-\\theta$。其解由兰伯特W函数给出：$x = W(-\\gamma S \\eta_{\\mathrm{iso},b})$。\n所以，$-\\theta = W(-\\gamma S \\eta_{\\mathrm{iso},b})$，即 $\\theta = -W(-\\gamma S \\eta_{\\mathrm{iso},b})$。\n我们需要比值 $\\frac{k(T_p)}{k(T_b)} = \\exp(\\theta) = \\exp(-W(-\\gamma S \\eta_{\\mathrm{iso},b}))$。\n利用兰伯特W函数的性质 $\\exp(-W(z)) = W(z)/z$，我们发现：\n$$ \\frac{k(T_p)}{k(T_b)} = \\frac{W(-\\gamma S \\eta_{\\mathrm{iso},b})}{-\\gamma S \\eta_{\\mathrm{iso},b}} $$\n最后，将此代入 $\\eta_{\\mathrm{noniso}}$ 的表达式中：\n$$ \\eta_{\\mathrm{noniso}} = \\left(\\frac{W(-\\gamma S \\eta_{\\mathrm{iso},b})}{-\\gamma S \\eta_{\\mathrm{iso},b}}\\right) \\eta_{\\mathrm{iso},b} = \\frac{W(-\\gamma S \\eta_{\\mathrm{iso},b})}{-\\gamma S} $$\n这里，$\\eta_{\\mathrm{iso},b}$ 是在Thiele模数 $\\phi_b = R\\sqrt{k(T_b)/D_e}$ 处计算的第二部分的等温有效因子。因此，最终表达式为：\n$$ \\eta_{\\mathrm{noniso}} = \\frac{W\\left(-\\gamma S \\left[ \\frac{3}{\\phi_b^2}(\\phi_b \\coth(\\phi_b) - 1) \\right] \\right)}{-\\gamma S} $$\n其中 $\\phi_b = R\\sqrt{k(T_b)/D_e}$。\n\n所需的三个表达式汇总在最终答案中。", "answer": "$$ \\boxed{ \\begin{pmatrix} R \\sqrt{\\frac{k(T)}{D_{\\mathrm{e}}}}  \\frac{3}{\\phi^{2}} (\\phi \\coth(\\phi) - 1)  \\frac{W\\left(-\\gamma S \\left[ \\frac{3}{\\phi_{b}^{2}} (\\phi_{b} \\coth(\\phi_{b}) - 1) \\right] \\right)}{-\\gamma S} \\end{pmatrix} } $$", "id": "2508584"}, {"introduction": "虽然解析模型对于理想化的微观结构非常有效，但许多真实材料展现出复杂的随机几何形状，难以用简单的数学描述。本实践从解析理论过渡到现代多尺度分析的计算方法。您将实施一个程序，从数字材料图像中估算代表性单元体积 (REV) 的尺寸，学习如何通过对材料属性场进行统计分析来定义其开始表现为均匀连续体的长度尺度。[@problem_id:2508640]", "problem": "您的任务是设计并实现一个计算程序，通过评估体积平均热导率的变异系数（CV）随采样窗口尺寸的变化，来从合成的微计算机断层扫描（micro-CT）图像体积中估算表观热导率的代表性体积元（REV）。\n\n从热传导的基本原理出发。在没有内热源的稳态条件下，能量守恒定律表示为 $\\nabla \\cdot \\mathbf{q} = 0$，其中 $\\mathbf{q}$ 是热通量。傅立叶定律指出 $\\mathbf{q} = -k(\\mathbf{x}) \\nabla T$，其中 $k(\\mathbf{x})$ 是空间变化的热导率，$T$ 是温度。对于一个足够大的尺寸为 $L \\times L \\times L$ 的采样体积 $\\Omega_L$，在尺度分离和遍历性假设下，其体积平均性质 $\\bar{k}_L = \\frac{1}{|\\Omega_L|} \\int_{\\Omega_L} k(\\mathbf{x}) \\, \\mathrm{d}V$ 预计会收敛到一个与尺度无关的等效值。该收敛性的一个实用数值指标是变异系数 $\\mathrm{CV}(L) = \\frac{\\sigma_L}{\\mu_L}$，其中 $\\mu_L$ 和 $\\sigma_L$ 分别是在域内所有窗口位置上计算得到的局部体积平均值 $\\bar{k}_L$ 系综的均值和标准差。\n\n您的程序必须按如下方式操作化这一概念：\n\n- 定义一个尺寸为 $N \\times N \\times N$ 体素的离散三维域。构建一个合成的两相微观结构，并将各相映射到热导率 $k_{\\mathrm{low}}$ 和 $k_{\\mathrm{high}}$（单位为 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$）。该性质场为 $k[i,j,k] \\in \\{k_{\\mathrm{low}}, k_{\\mathrm{high}}\\}$。\n- 对于给定集合 $\\mathcal{L}$ 中的每个立方窗口边长 $L$（以体素为单位），使用周期性边界条件计算所有体素位置处的滑动窗口体积平均值 $\\bar{k}_L$。将此操作解释为与一个尺寸为 $L \\times L \\times L$、归一化为单位和的均匀核进行离散卷积。\n- 对于每个 $L \\in \\mathcal{L}$，计算 $\\mathrm{CV}(L) = \\sigma_L / \\mu_L$，其中 $\\mu_L$ 和 $\\sigma_L$ 是所有窗口位置上 $\\bar{k}_L$ 值的均值和标准差。\n- 将 REV 估计值 $\\widehat{L}_{\\mathrm{REV}}$ 定义为 $\\mathcal{L}$ 中满足 $\\max_{L' \\in \\mathcal{L},\\, L' \\ge L} \\mathrm{CV}(L') \\le \\varepsilon$ 的最小 $L$，其中 $\\varepsilon > 0$ 是给定的容差。如果 $\\mathcal{L}$ 中不存在这样的 $L$，则返回 $-1$。\n\n在以下测试套件上实现该程序。每个测试用例都指定了 $N$、微观结构生成规则、相热导率、任何附加参数、窗口尺寸集合 $\\mathcal{L}$、变异系数容差 $\\varepsilon$ 以及用于可复现性的随机种子（如适用）。所有长度必须以体素为单位进行解释和报告。将每个最终估计的 REV 表示为整数体素数。\n\n测试套件（四个用例）：\n\n- 用例 A（不相关，低对比度）：\n  - 域尺寸：$N = 64$。\n  - 微观结构：高热导率相的概率 $p = 0.5$ 的独立伯努利场。\n  - 热导率：$k_{\\mathrm{low}} = 1.0$, $k_{\\mathrm{high}} = 2.0$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n  - 候选窗口尺寸：$\\mathcal{L} = [4,\\,8,\\,12,\\,16,\\,24,\\,32]$（体素）。\n  - 容差：$\\varepsilon = 0.05$。\n  - 随机种子：$r = 0$。\n\n- 用例 B（不相关，高对比度）：\n  - 域尺寸：$N = 64$。\n  - 微观结构：高热导率相的概率 $p = 0.5$ 的独立伯努利场。\n  - 热导率：$k_{\\mathrm{low}} = 0.1$, $k_{\\mathrm{high}} = 10.0$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n  - 候选窗口尺寸：$\\mathcal{L} = [4,\\,8,\\,12,\\,16,\\,24,\\,32]$（体素）。\n  - 容差：$\\varepsilon = 0.05$。\n  - 随机种子：$r = 1$。\n\n- 用例 C（相关斑点）：\n  - 域尺寸：$N = 64$。\n  - 微观结构：由标准差 $\\sigma = 3$ 体素的高斯滤波器平滑的零均值高斯随机场，然后在 $0$ 处进行阈值处理，以产生体积分数近似相等的两相。即，在网格上独立同分布地抽取 $X \\sim \\mathcal{N}(0,1)$，设 $Y = G_\\sigma \\star X$（其中 $G_\\sigma$ 是标准差为 $\\sigma$ 的高斯核），并将高热导率相定义为 $\\{Y \\ge 0\\}$。\n  - 热导率：$k_{\\mathrm{low}} = 1.0$, $k_{\\mathrm{high}} = 5.0$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n  - 候选窗口尺寸：$\\mathcal{L} = [4,\\,8,\\,12,\\,16,\\,24,\\,32]$（体素）。\n  - 容差：$\\varepsilon = 0.05$。\n  - 随机种子：$r = 2$。\n\n- 用例 D（分层介质）：\n  - 域尺寸：$N = 64$。\n  - 微观结构：垂直于 $z$ 轴的完美周期性分层，周期 $T = 8$ 体素，由 $4$ 个体素的高热导率相和 $4$ 个体素的低热导率相组成，并沿 $z$ 轴重复。在 $x$ 和 $y$ 方向上是均匀的。\n  - 热导率：$k_{\\mathrm{low}} = 1.0$, $k_{\\mathrm{high}} = 5.0$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n  - 候选窗口尺寸：$\\mathcal{L} = [4,\\,8,\\,12,\\,16,\\,24,\\,32]$（体素）。\n  - 容差：$\\varepsilon = 0.05$。\n\n您的程序必须：\n\n- 完全按照规定生成每个合成微观结构，并在适用时使用提供的随机种子。\n- 在计算滑动窗口平均值时使用周期性边界条件。\n- 对每个用例，计算所有 $L \\in \\mathcal{L}$ 的序列 $\\mathrm{CV}(L)$，然后计算 $\\widehat{L}_{\\mathrm{REV}}$。\n- 生成单行输出，包含四个 $\\widehat{L}_{\\mathrm{REV}}$ 值，形式为用方括号括起来的逗号分隔列表，例如 $\\left[16,8,24,32\\right]$。\n\n以体素为单位回答，并报告为整数。输出格式必须是如示例所示的单行列表字符串；不允许有任何附加文本。", "solution": "提交分析的问题陈述被认为是有效的。它提出了一个适定的计算任务，该任务基于非均质材料多尺度建模和均匀化理论的既定原则。其目标是估算合成微观结构表观热导率的代表性体积元（REV），这是连续介质力学中的一个基本概念。该方法基于分析体积平均性质的变异系数随尺度的变化，是一种用于形态学表征的标准且科学上合理的方法。所有参数、边界条件和微观结构生成规则都以足够的精度进行了规定，以确保数值解的唯一性和可复现性。该问题不违反任何物理学或数学原理，并与热质传递主题直接相关。\n\n解决方案通过实现指定的计算程序来推进。该程序的核心是量化材料性质场的统计非均质性如何随着平均体积的增加而减小。\n\n**1. 理论框架**\n\n在没有内部热源的稳态热传递中，控制方程是热通量的散度为零，即 $\\nabla \\cdot \\mathbf{q} = 0$。傅立叶定律通过局部热导率 $k(\\mathbf{x})$ 将热通量 $\\mathbf{q}$ 与温度梯度 $\\nabla T$ 联系起来，即 $\\mathbf{q} = -k(\\mathbf{x}) \\nabla T$。对于非均质材料，$k(\\mathbf{x})$ 在空间上是变化的。\n\nREV 的概念源于这样一种需求：为了在更大尺度上进行分析，希望用一个由等效性质描述的等效均质材料来替代复杂的非均质材料。如果在一个特征尺寸为 $L$ 的体积 $\\Omega_L$ 上计算的体积平均性质变得与该体积的具体位置和尺寸无关，那么只要 $L$ 相对于微观结构长度尺度足够大，该体积就被认为是 REV。\n\n该问题通过分析体积平均热导率场本身 $\\bar{k}_L = \\frac{1}{|\\Omega_L|} \\int_{\\Omega_L} k(\\mathbf{x}) \\, \\mathrm{d}V$ 的收敛性来简化此过程，而不是求解等效热导率的完整边值问题。收敛准则基于变异系数 $\\mathrm{CV}(L) = \\sigma_L / \\mu_L$。这里，$\\mu_L$ 和 $\\sigma_L$ 是通过将平均窗口 $\\Omega_L$ 放置在较大材料域内所有可能位置而获得的 $\\bar{k}_L$ 值系综的均值和标准差。$\\mathrm{CV}(L)$ 的减小表明材料在尺度 $L$ 上显得越来越均匀。\n\n**2. 计算实现**\n\n将连续问题离散化到一个 $N \\times N \\times N$ 体素的三维笛卡尔网格上。空间变化的热导率 $k(\\mathbf{x})$ 变成一个离散数组 $k[i,j,k]$。\n\n**2.1. 微观结构生成**\n对于每个测试用例，会生成一个特定的 $N \\times N \\times N$ 热导率场：\n- **用例 A 和 B（不相关伯努利场）：** 用从均匀分布中抽取的随机值填充一个三维数组。如果一个体素的随机数小于概率 $p$，则为其分配高热导率值 $k_{\\mathrm{high}}$，否则分配低热导率值 $k_{\\mathrm{low}}$。这会创建一个没有空间相关的随机棋盘状结构。通过为伪随机数生成器设定种子来确保可复现性。\n- **用例 C（相关高斯斑点）：** 生成一个具有特征尺寸的、更真实的微观结构。首先，创建一个独立标准正态随机变量场 $X \\sim \\mathcal{N}(0,1)$。然后将这个“白噪声”场与一个标准差为 $\\sigma$ 的离散三维高斯核进行卷积。此滤波步骤引入了空间相关性，创建了平滑的“斑点”。卷积在周期性边界条件下执行，这可以由诸如 `scipy.ndimage.gaussian_filter` 的库函数正确处理。得到的平滑场 $Y$ 在 $0$ 处进行阈值处理；$Y \\ge 0$ 的体素被赋予 $k_{\\mathrm{high}}$，其余的被赋予 $k_{\\mathrm{low}}$。\n- **用例 D（分层介质）：** 创建一个确定性的各向异性微观结构。坐标为 $(i, j, k)$ 的体素的热导率仅取决于 $z$ 坐标 $k$。该结构沿 $z$ 轴呈周期性，周期为 $T$。对于 $k \\pmod T  T/2$，相是高热导率相；否则是低热导率相。\n\n**2.2. 体积平均和 CV 计算**\n对于集合 $\\mathcal{L}$ 中的每个候选窗口尺寸 $L$，必须计算局部体积平均场 $\\bar{k}_L$。使用嵌套循环的朴素实现计算成本会过高。问题正确地指出，此操作等效于将热导率场 $k[i,j,k]$ 与一个尺寸为 $L \\times L \\times L$、归一化为单位和的均匀（盒式）核进行离散卷积。关键的是，必须应用周期性边界条件来处理跨越域边界的窗口。这可以通过使用 `scipy.ndimage.uniform_filter` 并设置 `mode='wrap'` 选项来高效实现。此操作产生一个 $N \\times N \\times N$ 的数组 $\\bar{k}_L$，其中每个元素是在以该体素为中心的尺寸为 $L$ 的窗口上的平均热导率。从此数组中，计算所有 $N^3$ 个值的全局均值 $\\mu_L$ 和标准差 $\\sigma_L$。然后计算变异系数 $\\mathrm{CV}(L) = \\sigma_L / \\mu_L$。对每个 $L \\in \\mathcal{L}$ 重复此过程。\n\n**2.3. REV 估算**\n最后一步是从计算出的 $\\mathrm{CV}(L)$ 值序列中确定估计的 REV 尺寸 $\\widehat{L}_{\\mathrm{REV}}$。根据问题的定义，我们搜索 $\\mathcal{L}$ 中最小的 $L$，使得其本身及所有更大的测试尺寸的变异系数都保持在给定容差 $\\varepsilon$ 以下。也就是说，我们找到满足 $\\max_{L' \\in \\mathcal{L}, L' \\ge L} \\mathrm{CV}(L') \\le \\varepsilon$ 的最小 $L \\in \\mathcal{L}$。如果在给定的集合 $\\mathcal{L}$ 中找不到这样的 $L$，则意味着在测试的尺度范围内未达到所需的收敛容差，此时返回值为 $-1$。\n\n以下 Python 代码为所有指定的测试用例实现了这一完整程序。", "answer": "[8,24,12,8]", "id": "2508640"}]}