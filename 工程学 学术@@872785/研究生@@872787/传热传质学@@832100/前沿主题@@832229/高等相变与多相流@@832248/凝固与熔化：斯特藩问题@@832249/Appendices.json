{"hands_on_practices": [{"introduction": "本练习旨在通过一个经典的凝固问题，巩固对相似性解方法的掌握。虽然最基本的Neumann解适用于半无限域，但此问题[@problem_id:2523101]将其扩展到一个更具实际意义的有限厚度平板。通过巧妙地利用对称性，您将推导出凝固完成所需的时间，这不仅是对数学技巧的锻炼，更是对模型简化和物理洞察力的深刻训练。", "problem": "一个厚度为 $L_s$ 的有限平板最初完全处于液态，其温度为其平衡熔化温度 $T_m$。在时间 $t=0^{+}$ 时，位于 $x=0$ 和 $x=L_s$ 的两个表面突然被冷却至均匀温度 $T_0$（其中 $T_0  T_m$）。假设液相始终保持在 $T_m$。从第一性原理出发，推导凝固完成所需的时间 $t_f$。您的答案应以材料和系统参数的形式表示，包括一个无量纲常数 $\\lambda$，该常数是涉及斯特凡数 $\\mathrm{Ste} = c(T_m-T_0)/\\ell$ 的超越方程的解。", "solution": "所述问题是一个经典的单相斯特凡问题。它基于热传导和相变的基本原理，在数学上是适定的，在科学上是合理的。我们将着手求解。\n\n凝固过程关于中平面 $x = L_s/2$ 是对称的。因此，我们可以只分析平板一半的凝固过程，例如区域 $0 \\le x \\le L_s/2$。一个固态层从 $x=0$ 的表面形成并向液相中生长。在时间 $t$ 时，该层的厚度由 $s(t)$ 给出。\n\n在固相内部（$0  x  s(t)$），温度分布 $T(x,t)$ 由一维热方程控制，假设热扩散率 $\\alpha$ 为常数：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{for} \\quad 0  x  s(t), t > 0 $$\n\n温度场的边界条件为：\n1.  在外表面 $x=0$ 处保持固定温度 $T_0$：\n    $$ T(0, t) = T_0 \\quad \\text{for} \\quad t > 0 $$\n2.  在移动的固液界面 $x=s(t)$ 处，温度为平衡熔化温度 $T_m$：\n    $$ T(s(t), t) = T_m \\quad \\text{for} \\quad t > 0 $$\n\n界面的移动由斯特凡条件控制，该条件是 $x=s(t)$ 处的能量平衡。从固相到界面的热通量提供了凝固所需的熔化潜热。由于假设液相在 $T_m$ 下是等温的，因此没有从液相到界面的热通量。因此，斯特凡条件是：\n$$ k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=s(t)} = \\rho \\ell \\frac{ds}{dt} $$\n其中 $k$ 是热导率，$\\rho$ 是固体的密度，$\\ell$ 是单位质量的熔化潜热。\n\n该问题允许相似解。我们引入一个无量纲相似变量 $\\eta$：\n$$ \\eta = \\frac{x}{2\\sqrt{\\alpha t}} $$\n我们寻求一个解，其中界面位置 $s(t)$ 与 $\\sqrt{t}$ 成正比，而温度 $T(x,t)$ 仅是 $\\eta$ 的函数。设\n$$ s(t) = 2\\lambda\\sqrt{\\alpha t} $$\n$$ T(x,t) = G(\\eta) $$\n这里，$\\lambda$ 是一个待确定的无量纲常数。$T$ 的偏导数变换如下：\n$$ \\frac{\\partial T}{\\partial t} = G'(\\eta) \\frac{\\partial \\eta}{\\partial t} = G'(\\eta) \\left( -\\frac{x}{4\\sqrt{\\alpha} t^{3/2}} \\right) = -\\frac{\\eta}{2t} G'(\\eta) $$\n$$ \\frac{\\partial T}{\\partial x} = G'(\\eta) \\frac{\\partial \\eta}{\\partial x} = G'(\\eta) \\frac{1}{2\\sqrt{\\alpha t}} $$\n$$ \\frac{\\partial^2 T}{\\partial x^2} = G''(\\eta) \\left( \\frac{\\partial \\eta}{\\partial x} \\right)^2 = G''(\\eta) \\frac{1}{4\\alpha t} $$\n将这些代入热方程，得到一个关于 $G(\\eta)$ 的常微分方程：\n$$ -\\frac{\\eta}{2t} G'(\\eta) = \\alpha \\left( G''(\\eta) \\frac{1}{4\\alpha t} \\right) $$\n$$ G''(\\eta) + 2\\eta G'(\\eta) = 0 $$\n这是一个二阶线性常微分方程。其通解可通过两次连续积分得到：\n$$ G'(\\eta) = C_1 \\exp(-\\eta^2) $$\n$$ G(\\eta) = C_1 \\int_0^\\eta \\exp(-\\xi^2) d\\xi + C_2 = C_1 \\frac{\\sqrt{\\pi}}{2} \\mathrm{erf}(\\eta) + C_2 $$\n其中 $\\mathrm{erf}(\\eta)$ 是误差函数。我们可以将温度剖面写为：\n$$ T(x,t) = A \\, \\mathrm{erf}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right) + B $$\n常数 $A$ 和 $B$ 由边界条件确定。\n在 $x=0$ 处，$\\eta=0$。条件 $T(0,t)=T_0$ 给出：\n$$ T_0 = A \\, \\mathrm{erf}(0) + B \\implies B = T_0 $$\n在界面 $x=s(t)$ 处，相似变量为 $\\eta = s(t)/(2\\sqrt{\\alpha t}) = \\lambda$。条件 $T(s(t),t)=T_m$ 给出：\n$$ T_m = A \\, \\mathrm{erf}(\\lambda) + T_0 \\implies A = \\frac{T_m - T_0}{\\mathrm{erf}(\\lambda)} $$\n因此，固相中的温度分布为：\n$$ T(x,t) = T_0 + (T_m - T_0) \\frac{\\mathrm{erf}(x / (2\\sqrt{\\alpha t}))}{\\mathrm{erf}(\\lambda)} $$\n现在，我们应用斯特凡条件。温度对 $x$ 的导数是：\n$$ \\frac{\\partial T}{\\partial x} = (T_m - T_0) \\frac{1}{\\mathrm{erf}(\\lambda)} \\frac{d}{dx} \\left[ \\mathrm{erf}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right) \\right] = (T_m - T_0) \\frac{1}{\\mathrm{erf}(\\lambda)} \\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)^2\\right) \\frac{1}{2\\sqrt{\\alpha t}} $$\n在界面 $x=s(t)$ 处（其中 $\\eta=\\lambda$）计算该导数：\n$$ \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=s(t)} = \\frac{T_m - T_0}{\\sqrt{\\pi \\alpha t} \\, \\mathrm{erf}(\\lambda)} \\exp(-\\lambda^2) $$\n通过对 $s(t)$ 求导，可以找到界面的推进速率：\n$$ \\frac{ds}{dt} = \\frac{d}{dt}(2\\lambda\\sqrt{\\alpha t}) = 2\\lambda\\sqrt{\\alpha} \\left(\\frac{1}{2} t^{-1/2}\\right) = \\lambda\\sqrt{\\frac{\\alpha}{t}} $$\n将这些表达式代入斯特凡条件 $k (\\partial T / \\partial x) = \\rho \\ell (ds/dt)$：\n$$ k \\left( \\frac{T_m - T_0}{\\sqrt{\\pi \\alpha t} \\, \\mathrm{erf}(\\lambda)} \\exp(-\\lambda^2) \\right) = \\rho \\ell \\left( \\lambda \\sqrt{\\frac{\\alpha}{t}} \\right) $$\n$\\sqrt{t}$ 项消掉了。我们简化并使用定义 $\\alpha = k/(\\rho c)$：\n$$ k (T_m - T_0) \\exp(-\\lambda^2) = \\rho \\ell \\lambda \\alpha \\sqrt{\\pi} \\, \\mathrm{erf}(\\lambda) $$\n$$ k (T_m - T_0) \\exp(-\\lambda^2) = \\rho \\ell \\lambda \\frac{k}{\\rho c} \\sqrt{\\pi} \\, \\mathrm{erf}(\\lambda) $$\n$$ (T_m - T_0) \\exp(-\\lambda^2) = \\frac{\\ell}{c} \\lambda \\sqrt{\\pi} \\, \\mathrm{erf}(\\lambda) $$\n整理后得到一个关于 $\\lambda$ 的超越方程：\n$$ \\frac{c(T_m - T_0)}{\\ell} = \\sqrt{\\pi} \\lambda \\exp(\\lambda^2) \\mathrm{erf}(\\lambda) $$\n左边是斯特凡数，$\\mathrm{Ste} = c(T_m-T_0)/\\ell$。因此，$\\lambda$ 是以下方程的正根：\n$$ \\mathrm{Ste} = \\sqrt{\\pi} \\lambda \\exp(\\lambda^2) \\mathrm{erf}(\\lambda) $$\n当从 $x=0$ 和 $x=L_s$ 推进的两个界面在中平面相遇时，凝固在时间 $t_f$ 完成。这意味着 $s(t_f) = L_s/2$。\n使用 $s(t)$ 的表达式：\n$$ 2\\lambda\\sqrt{\\alpha t_f} = \\frac{L_s}{2} $$\n求解完成时间 $t_f$：\n$$ \\sqrt{t_f} = \\frac{L_s}{4\\lambda\\sqrt{\\alpha}} $$\n$$ t_f = \\frac{L_s^2}{16 \\lambda^2 \\alpha} $$\n这就是完成时间的最终解析表达式。常数 $\\lambda$ 由材料属性和温度条件通过涉及斯特凡数的超越方程确定。", "answer": "$$\\boxed{\\frac{L_s^2}{16 \\lambda^2 \\alpha}}$$", "id": "2523101"}, {"introduction": "简单的平面凝固前沿在现实中并非总是稳定存在的。本练习[@problem_id:2523106]引导我们探索一个更深层次的问题：平界面在何种条件下会失稳并演化出更复杂的形态？通过执行线性稳定性分析——一种在流体力学和材料科学中无处不在的强大工具——您将从基本物理原理出发，推导出界面稳定性的临界条件，从而揭示凝固过程中形态选择的基本机制。", "problem": "一种纯物质占据一个笛卡尔坐标为 $(x,z)$ 的二维半空间。固相占据 $z0$ 的区域，液相占据 $z>0$ 的区域。两相的热导率和热扩散率相同，即 $k_s=k_l=k$ 和 $\\alpha_s=\\alpha_l=\\alpha$。不存在对流。表面张力（毛细现象）和动力学过冷可以忽略不计，因此局部界面温度在任何时候都等于平衡熔化温度 $T_m$。在远离界面的地方，温度场由外部熔炉维持，使得当 $z \\to \\pm \\infty$ 时，$T \\to T_m + G z$，其中 $G$ 是一个恒定的外加温度梯度。界面初始时为位于 $z=0$ 的平面，并且平均来看是静止的。\n\n假设纯粹由热扩散控制，并考虑界面上一个振幅很小的正弦扰动 $z=\\eta(x,t)$，其中 $|\\eta|\\ll 1$。在相对于界面运动而言热扩散极快的准静态极限下，各相中的温度场满足拉普拉斯方程，界面能量平衡由斯蒂芬条件决定。从各相中的基本能量守恒定律和界面能量平衡（斯蒂芬）条件\n$$\n\\rho L V_n = k_s \\frac{\\partial T_s}{\\partial n} - k_l \\frac{\\partial T_l}{\\partial n},\n$$\n出发，其中 $\\rho$ 是密度，$L$ 是单位质量的潜热，$V_n$ 是界面的法向速度，$\\partial/\\partial n$ 表示在界面上计算的法向导数，对平面基态进行线性稳定性分析。推导简正模扰动 $\\eta(x,t)=\\hat{\\eta}\\exp(i q x + \\omega t)$ 的色散关系，并确定液相侧温度梯度 $G$ 的临界值 $G_{\\text{crit}}$，使得平面界面处于中性稳定状态。你的最终答案 $G_{\\text{crit}}$ 必须以 $\\mathrm{K\\,m^{-1}}$ 为单位表示。不要假设任何“快捷”公式；从所述的控制原理出发推导你的结果。最终答案必须是一个实数。", "solution": "该问题要求在特定的简化假设下，对平面凝固前沿进行线性稳定性分析。该分析将确定中性稳定性的临界温度梯度。在进行求解之前，我将首先验证问题的陈述。\n\n**问题验证**\n\n步骤1：提取已知条件\n-   系统：包含纯物质的二维半空间 $(x,z)$。固相在 $z0$，液相在 $z>0$。\n-   界面位置：$z=\\eta(x,t)$。基态是位于 $z=0$ 的平面界面。\n-   热学性质：$k_s = k_l = k$（热导率），$\\alpha_s = \\alpha_l = \\alpha$（热扩散率）。\n-   热力学性质：$\\rho$（密度），$L$（单位质量潜热），$T_m$（平衡熔化温度）。\n-   输运机制：纯热扩散；无对流。\n-   边界条件：\n    -   远场温度：当 $z \\to \\pm \\infty$ 时，$T \\to T_m + G z$。\n    -   界面温度：$T_i = T_m$（忽略毛细现象和动力学过冷）。\n-   控制方程：\n    -   温度场：准静态极限下，两相中均为 $\\nabla^2 T = 0$。\n    -   界面处的斯蒂芬条件：$\\rho L V_n = k_s \\frac{\\partial T_s}{\\partial n} - k_l \\frac{\\partial T_l}{\\partial n}$。\n-   扰动：形式为 $\\eta(x,t) = \\hat{\\eta}\\exp(i q x + \\omega t)$ 的简正模，其中 $|\\eta| \\ll 1$。\n-   目标：推导色散关系 $\\omega(q)$ 并找到中性稳定（$\\omega=0$）的临界梯度 $G_{\\text{crit}}$。要求答案以 $\\mathrm{K\\,m^{-1}}$ 为单位的单个实数形式给出。\n\n步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题是研究凝固前沿形态不稳定性的经典模型（一个简化的 Mullins-Sekerka 模型）。其控制原理——准静态温度场的拉普拉斯方程和移动界面能量平衡的斯蒂芬条件——是传热传质领域的基础。该问题在科学上是合理的。\n-   **适定性：** 问题提供了足够的信息来推导色散关系。\n-   **目标：** 问题以精确、客观、无歧义的科学语言陈述。\n-   **完整性：** 问题要求给出 $G_{\\text{crit}}$ 的最终数值答案，但没有提供材料性质 $\\rho$、$L$ 和 $k$ 的数值。这通常会使问题欠定。然而，初步分析表明，对于中性稳定的特定条件，这些参数可能会相互抵消或无关紧要，此时答案是一个通用数值（在这种情况下是 $0$）。如果真是这样，那么该问题是自洽且完整的。\n\n步骤3：结论与行动\n该问题被认为是有效的，前提是最终答案不依赖于未指定的材料常数。我现在将进行形式推导。\n\n**推导**\n\n分析过程首先定义基态，然后引入微小扰动，最后分析该扰动的演化以找到稳定性判据。\n\n**1. 基态**\n基态由一个位于 $z=0$ 的平面静止界面组成。固相 ($T_s$) 和液相 ($T_l$) 中的温度场必须满足拉普拉斯方程 $\\nabla^2 T = 0$ 和边界条件。对于仅依赖于 $z$ 的一维温度场，这简化为 $\\frac{d^2 T}{dz^2} = 0$，其通解为 $T(z) = Az+B$。\n\n应用边界条件：\n-   在界面 $z=0$ 处，$T_s(0) = T_l(0) = T_m$。\n-   远离界面处，当 $z \\to \\pm \\infty$ 时，$T \\to T_m + Gz$。\n\n这导致两相中唯一有效的基态温度分布为：\n$$T_0(z) = T_m + Gz$$\n固相和液相中的温度梯度分别为 $G_s = \\frac{dT_0}{dz} = G$ 和 $G_l = \\frac{dT_0}{dz} = G$。\n对于静止界面，法向速度 $V_n=0$。斯蒂芬条件要求热通量在界面上是连续的：$k_s \\frac{\\partial T_s}{\\partial z} |_{z=0} = k_l \\frac{\\partial T_l}{\\partial z} |_{z=0}$。在 $k_s=k_l=k$ 和 $G_s=G_l=G$ 的条件下，该条件 $kG=kG$ 被自然满足。因此，基态是一致的。\n\n**2. 扰动态**\n我们引入一个小的正弦扰动到界面上：\n$$z = \\eta(x,t) = \\hat{\\eta} \\exp(i q x + \\omega t)$$\n其中 $\\hat{\\eta}$ 是振幅，$q$ 是波数，$\\omega$ 是增长率。温度场也相应地被扰动：$T(x,z,t) = T_0(z) + \\tilde{T}(x,z,t)$，其中 $\\tilde{T}$ 是小的温度扰动。\n由于基态 $T_0(z)$ 满足拉普拉斯方程，扰动 $\\tilde{T}$ 在准静态极限下也必须满足拉普拉斯方程：\n$$\\nabla^2 \\tilde{T} = \\frac{\\partial^2 \\tilde{T}}{\\partial x^2} + \\frac{\\partial^2 \\tilde{T}}{\\partial z^2} = 0$$\n我们寻求与扰动形式相匹配的简正模形式的 $\\tilde{T}$ 解：\n$$\\tilde{T}(x,z,t) = \\hat{T}(z) \\exp(i q x + \\omega t)$$\n将此代入拉普拉斯方程，得到关于 $\\hat{T}(z)$ 的常微分方程：\n$$-q^2 \\hat{T}(z) + \\frac{d^2 \\hat{T}(z)}{dz^2} = 0$$\n其通解为 $\\hat{T}(z) = A \\exp(|q|z) + B \\exp(-|q|z)$。我们使用 $|q|$ 以确保实指数衰减，假设 $q$ 为实数。\n\n扰动必须在远离界面处衰减。\n-   在液相中 ($z > 0$)，当 $z \\to \\infty$ 时，$\\tilde{T}_l \\to 0$。这要求解为 $\\hat{T}_l(z) = C_l \\exp(-|q|z)$。\n-   在固相中 ($z  0$)，当 $z \\to -\\infty$ 时，$\\tilde{T}_s \\to 0$。这要求解为 $\\hat{T}_s(z) = C_s \\exp(|q|z)$。\n\n因此，温度扰动为：\n$$\\tilde{T}_l(x,z,t) = C_l \\exp(-|q|z) \\exp(i q x + \\omega t)$$\n$$\\tilde{T}_s(x,z,t) = C_s \\exp(|q|z) \\exp(i q x + \\omega t)$$\n\n**3. 扰动界面处的边界条件**\n\n我们现在必须在界面 $z=\\eta(x,t)$ 处应用两个边界条件。这些条件将确定系数 $C_l$ 和 $C_s$，并最终得到色散关系。\n\n**a) 等温条件：** 界面处于平衡熔化温度 $T_m$。\n$$T_s(x, \\eta, t) = T_m \\quad \\text{和} \\quad T_l(x, \\eta, t) = T_m$$\n我们对液相的这个条件进行线性化。我们将总温度 $T_l(x, \\eta, t)$ 在 $z=0$ 附近按 $\\eta$ 展开到一阶：\n$$T_l(x, \\eta, t) = T_0(\\eta) + \\tilde{T}_l(x, \\eta, t) \\approx (T_m + G\\eta) + \\tilde{T}_l(x, 0, t) + O(\\eta^2) = T_m$$\n这简化为：\n$$G\\eta + \\tilde{T}_l(x, 0, t) = 0$$\n代入 $\\eta$ 和 $\\tilde{T}_l$ 的简正模形式：\n$$G \\hat{\\eta} \\exp(i q x + \\omega t) + C_l \\exp(i q x + \\omega t) = 0$$\n这给出了系数 $C_l = -G \\hat{\\eta}$。\n对固相进行完全类似的计算，得到 $C_s = -G \\hat{\\eta}$。\n\n**b) 斯蒂芬条件：** 界面处的能量平衡由 $\\rho L V_n = k_s \\frac{\\partial T_s}{\\partial n} - k_l \\frac{\\partial T_l}{\\partial n}$ 给出。\n界面的法向速度为 $V_n = \\frac{\\partial \\eta}{\\partial t} = \\omega \\eta$。\n界面 $F(x,z,t) = z - \\eta(x,t) = 0$ 的法向量为 $\\mathbf{n} = \\frac{\\nabla F}{|\\nabla F|} = \\frac{-\\frac{\\partial \\eta}{\\partial x}\\mathbf{e}_x + \\mathbf{e}_z}{\\sqrt{1+(\\frac{\\partial \\eta}{\\partial x})^2}}$。对 $\\eta$ 取一阶近似，$\\mathbf{n} \\approx \\mathbf{e}_z - \\frac{\\partial \\eta}{\\partial x}\\mathbf{e}_x$。\n法向导数为 $\\frac{\\partial T}{\\partial n} = \\mathbf{n} \\cdot \\nabla T$。\n我们对斯蒂芬条件的右侧进行线性化。已知 $k_s=k_l=k$：\n$$k \\left( \\frac{\\partial T_s}{\\partial n}\\bigg|_{z=\\eta} - \\frac{\\partial T_l}{\\partial n}\\bigg|_{z=\\eta} \\right)$$\n零阶项相消，因为 $k \\frac{\\partial T_0}{\\partial z} - k \\frac{\\partial T_0}{\\partial z} = kG - kG = 0$。我们需要找到一阶项。\n右侧的一阶部分是：\n$$k \\left( \\frac{\\partial \\tilde{T}_s}{\\partial z}\\bigg|_{z=0} - \\frac{\\partial \\tilde{T}_l}{\\partial z}\\bigg|_{z=0} \\right)$$\n我们来计算这些导数：\n对于液相：\n$$\\frac{\\partial \\tilde{T}_l}{\\partial z} = C_l (-|q|) \\exp(-|q|z) \\exp(i q x + \\omega t)$$\n$$\\frac{\\partial \\tilde{T}_l}{\\partial z}\\bigg|_{z=0} = -|q| C_l \\exp(i q x + \\omega t) = -|q| (-G\\hat{\\eta}) \\exp(i q x + \\omega t) = |q|G\\eta$$\n对于固相：\n$$\\frac{\\partial \\tilde{T}_s}{\\partial z} = C_s (|q|) \\exp(|q|z) \\exp(i q x + \\omega t)$$\n$$\\frac{\\partial \\tilde{T}_s}{\\partial z}\\bigg|_{z=0} = |q| C_s \\exp(i q x + \\omega t) = |q| (-G\\hat{\\eta}) \\exp(i q x + \\omega t) = -|q|G\\eta$$\n将这些代入线性化的斯蒂芬条件：\n$$\\rho L (\\omega \\eta) = k ( (-|q|G\\eta) - (|q|G\\eta) )$$\n$$\\rho L \\omega \\eta = -2 k |q| G \\eta$$\n\n**4. 色散关系与临界梯度**\n两边除以 $\\eta$（对于存在的扰动，$\\eta$ 非零），我们得到色散关系：\n$$\\omega(q) = -\\frac{2 k |q| G}{\\rho L}$$\n该关系决定了扰动的时间演化。\n-   如果 $\\omega  0$，扰动衰减，平面界面稳定。\n-   如果 $\\omega > 0$，扰动增长，平面界面不稳定。\n-   如果 $\\omega = 0$，界面处于中性稳定状态。\n\n材料常数 $\\rho$、$L$ 和 $k$ 均为正值，波数大小 $|q|$ 也为正。因此，$\\omega$ 的符号完全由 $-G$ 的符号决定。\n-   对于 $G > 0$，我们有 $\\omega  0$。界面对所有扰动都是稳定的。这对应于液相和固相中都存在正的温度梯度，是一种物理上稳定的构型。\n-   对于 $G  0$，我们有 $\\omega > 0$。界面对所有扰动都是不稳定的。这对应于负的温度梯度，意味着界面前方的液体是过冷的，从而促进失控生长。\n\n中性稳定的临界条件是 $\\omega = 0$。从色散关系可知，这种情况发生在：\n$$-\\frac{2 k |q| G}{\\rho L} = 0$$\n因为 $k, \\rho, L, |q|$ 均不为零，这要求：\n$$G = 0$$\n因此，不稳定性开始出现的温度梯度临界值为 $G_{\\text{crit}}=0$。在这个简化模型中，任何负梯度都将导致不稳定。问题对数值答案的要求现在得到了解决，因为这个值是一个不依赖于材料性质的特定数字。", "answer": "$$\\boxed{0}$$", "id": "2523106"}, {"introduction": "绝大多数实际的Stefan问题由于其复杂的几何形状、边界条件或材料属性而无法求得解析解，此时数值方法便成为不可或缺的工具。本练习[@problem_id:2523100]将指导您实现一种强大而优雅的固定网格算法——焓法。通过将潜热巧妙地包含在焓-温度关系中，该方法避免了显式追踪移动界面的复杂性，是解决相变传热问题的主力计算方法之一。", "problem": "考虑固定空间区间上采用固定网格焓法的一维两相斯特芬问题。令 $x \\in [0,L]$ 表示空间， $t \\ge 0$ 表示时间。温度场为 $T(x,t)$，体积焓为 $H(x,t)$。热传导遵循能量守恒和傅里叶定律，两者共同导出焓平衡方程\n$$\n\\frac{\\partial H}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(k\\,\\frac{\\partial T}{\\partial x}\\right),\n$$\n其中 $k$ 是热导率，假设在两相中均为常数且相同。焓 $H$ 与温度 $T$ 通过一个严格递增的分段线性函数关联，该函数通过围绕熔化温度的一个狭窄糊状区间来包含潜热。具体来说，固定一个熔化温度 $T_m$、一个糊状半宽 $\\Delta T/2 > 0$、一个体积热容 $C$（假设在固相和液相中均为常数且相同）以及一个单位体积潜热 $L_v > 0$。定义固相线和液相线温度为\n$$\nT_s \\;=\\; T_m \\;-\\; \\frac{\\Delta T}{2},\\qquad\nT_l \\;=\\; T_m \\;+\\; \\frac{\\Delta T}{2}.\n$$\n定义焓-温度关系 $H(T)$ 为\n$$\nH(T) =\n\\begin{cases}\nC\\,T,  \\text{if } T \\le T_s, \\\\\nC\\,T + L_v \\frac{T - T_s}{\\Delta T},  \\text{if } T_s  T  T_l, \\\\\nC\\,T + L_v,  \\text{if } T \\ge T_l.\n\\end{cases}\n$$\n该函数是可逆的；给定 $H$，通过反转上述分段定义来恢复 $T$。在 $x=0$ 处施加狄利克雷边界条件，$T(0,t)=T_{\\text{left}}$，在 $x=L$ 处施加绝热（法向热通量为零）的诺伊曼边界条件，$\\partial T/\\partial x \\big|_{x=L}=0$。初始温度是均匀的，$T(x,0)=T_{\\text{init}}$。\n\n您的任务是实现一个固定网格算法，该算法在时间上对 $H$ 进行显式推进，并在每个时间步通过反转 $H(T)$ 来恢复 $T$，这一切都在一个包含 $N$ 个节点的均匀网格上进行。对空间二阶导数使用中心有限差分，对 $H$ 使用显式前向欧拉时间积分器。通过直接设置边界温度来强制执行狄利克雷边界，通过零梯度条件来强制执行绝热边界。将固-液界面位置隐式地追踪为 $T(x,t)$ 从左侧穿越 $T_m$ 的位置。如果在 $[0,L]$ 内没有穿越，则当所有 $x$ 的 $T(x,t) \\ge T_m$ 时，定义界面位置为 $0$，当所有 $x$ 的 $T(x,t) \\le T_m$ 时，定义为 $L$。当穿越位置位于节点之间时，使用相邻网格点之间的线性插值来估计该位置。\n\n从上述基本定律出发，设计您的算法以实现：\n- 通过焓平衡方程演化 $H$，\n- 通过逐点反转 $H(T)$ 恢复 $T$，\n- 在每个时间步一致地强制执行边界条件，\n- 从计算出的温度场隐式地计算界面位置 $s(t)$。\n\n将您的算法实现为一个完整的程序，运行以下测试套件。对于每个测试用例，模拟直到时间 $t_{\\text{end}}$，并返回界面位置 $s(t_{\\text{end}})$（单位：米）。请使用提供的精确参数值；所有量均采用国际单位制（SI）。网格是均匀的，有 $N$ 个节点，间距为 $\\Delta x = L/(N-1)$。精确执行 $n_{\\text{steps}} = \\lfloor t_{\\text{end}}/\\Delta t \\rfloor$ 步，步长为 $\\Delta t$，因此模拟的最终时间是 $n_{\\text{steps}}\\,\\Delta t$。该测试套件涵盖一个典型的凝固情况、一个高潜热情况和一个熔化情况：\n\n- 测试用例 A（凝固，中等潜热）：\n  - $L = 0.1$,\n  - $N = 201$,\n  - $k = 2.0$,\n  - $C = 2.0 \\times 10^{6}$,\n  - $L_v = 3.34 \\times 10^{8}$,\n  - $T_m = 0.0$,\n  - $\\Delta T = 0.2$,\n  - $T_{\\text{left}} = -10.0$,\n  - $T_{\\text{init}} = 10.0$,\n  - $t_{\\text{end}} = 200.0$,\n  - $\\Delta t = 0.05$.\n\n- 测试用例 B（凝固，非常大的潜热）：\n  - $L = 0.1$,\n  - $N = 201$,\n  - $k = 2.0$,\n  - $C = 2.0 \\times 10^{6}$,\n  - $L_v = 1.0 \\times 10^{9}$,\n  - $T_m = 0.0$,\n  - $\\Delta T = 0.2$,\n  - $T_{\\text{left}} = -10.0$,\n  - $T_{\\text{init}} = 10.0$,\n  - $t_{\\text{end}} = 200.0$,\n  - $\\Delta t = 0.05$.\n\n- 测试用例 C（熔化，中等潜热）：\n  - $L = 0.05$,\n  - $N = 201$,\n  - $k = 1.5$,\n  - $C = 2.0 \\times 10^{6}$,\n  - $L_v = 3.34 \\times 10^{8}$,\n  - $T_m = 0.0$,\n  - $\\Delta T = 0.2$,\n  - $T_{\\text{left}} = 10.0$,\n  - $T_{\\text{init}} = -5.0$,\n  - $t_{\\text{end}} = 100.0$,\n  - $\\Delta t = 0.02$.\n\n科学真实性要求：\n- 将 $k$、$C$ 和 $L_v$ 视为在空间和时间上恒定，且在两相中相同。\n- 使用上面定义的分段线性 $H(T)$ 及其精确的逐点逆函数从 $H$ 中恢复 $T$。\n- 确保算法在每个时间步都强制执行边界条件。\n\n角度单位不适用。所有界面位置必须以米为单位报告。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[resultA,resultB,resultC]”），其中每个条目是一个等于 $s(t_{\\text{end}})$（单位：米）的浮点数，四舍五入到六位小数。", "solution": "该问题已接受验证。\n\n**步骤 1：提取给定信息**\n- **控制方程**：$\\frac{\\partial H}{\\partial t} = \\frac{\\partial}{\\partial x}\\!(k\\,\\frac{\\partial T}{\\partial x})$\n- **域**：空间 $x \\in [0,L]$，时间 $t \\ge 0$。\n- **常数**：热导率 $k$，体积热容 $C$，单位体积潜热 $L_v$，熔化温度 $T_m$，糊状半宽 $\\Delta T/2$。\n- **相变温度**：$T_s = T_m - \\Delta T/2$, $T_l = T_m + \\Delta T/2$。\n- **焓-温度关系 $H(T)$**：\n$$\nH(T) = \\begin{cases}\nC\\,T,  \\text{if } T \\le T_s, \\\\\nC\\,T + L_v \\frac{T - T_s}{\\Delta T},  \\text{if } T_s  T  T_l, \\\\\nC\\,T + L_v,  \\text{if } T \\ge T_l.\n\\end{cases}\n$$\n- **边界条件**：$T(0,t)=T_{\\text{left}}$ (狄利克雷)，$\\partial T/\\partial x \\big|_{x=L}=0$ (诺伊曼)。\n- **初始条件**：$T(x,0)=T_{\\text{init}}$。\n- **数值格式**：具有 $N$ 个节点的均匀网格，间距 $\\Delta x = L/(N-1)$。使用步长 $\\Delta t$ 的显式前向欧拉时间积分，对空间使用中心有限差分。\n- **时间积分**：步数为 $n_{\\text{steps}} = \\lfloor t_{\\text{end}}/\\Delta t \\rfloor$，步长为 $\\Delta t$。\n- **界面位置 $s(t)$**：$T(x,t) = T_m$ 的位置，通过线性插值找到。若对所有 $x$ 都有 $T \\ge T_m$，则 $s=0$。若对所有 $x$ 都有 $T \\le T_m$，则 $s=L$。\n- **测试用例**：为情况 A、B 和 C 提供了所有常数和数值参数的具体值。\n\n**步骤 2：使用提取的给定信息进行验证**\n该问题具有科学依据，描述了使用焓法的标准一维斯特芬问题，这是一种在计算传热学中成熟的技术。所有必要的方程、初始条件、边界条件和材料属性均已指定，使得问题自成体系且完整。数值离散化方法（显式有限差分）定义清晰。稳定性分析证实，所有测试用例选择的时间步长都满足显式热方程的Courant-Friedrichs-Lewy (CFL) 条件，从而保证了数值稳定性。例如，在情况 A 中，稳定性极限为 $\\Delta t \\le (\\Delta x)^2 / (2\\alpha) = (5 \\times 10^{-4})^2 / (2 \\times 10^{-6}) = 0.125$ s，而所选的 $\\Delta t = 0.05$ s 安全地低于此极限。该问题是客观的、适定的且非平凡的。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将构建一个解决方案。\n\n此问题的解决方案需要设计一个基于有限差分法的数值算法，以求解给定的焓偏微分方程。算法流程如下。\n\n**1. 控制方程的离散化**\n将域离散化为一个具有 $N$ 个节点的均匀网格，索引为 $i=0, 1, \\dots, N-1$。节点 $i$ 的空间坐标为 $x_i = i \\Delta x$，其中 $\\Delta x = L/(N-1)$。在节点 $i$ 和时间步 $n$ 的温度和焓分别表示为 $T_i^n$ 和 $H_i^n$。\n\n控制方程为\n$$\n\\frac{\\partial H}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2}\n$$\n我们对时间导数应用前向欧拉格式，对空间二阶导数应用中心差分格式。对于内部节点 $i \\in \\{1, \\dots, N-2\\}$，离散化方程为：\n$$\n\\frac{H_i^{n+1} - H_i^n}{\\Delta t} = k \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n为焓的显式更新重新整理方程，得到：\n$$\nH_i^{n+1} = H_i^n + \\frac{k \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\n\n**2. 焓-温度本构关系**\n焓法的核心是焓 $H$ 和温度 $T$ 之间的关系。为了推进模拟，我们首先更新 $H$，然后从更新后的 $H$ 中恢复新的温度 $T$。这需要反函数 $T(H)$，我们从给定的分段线性函数 $H(T)$ 推导得出。\n\n首先，我们定义在固相线和液相线温度 $T_s = T_m - \\Delta T/2$ 和 $T_l = T_m + \\Delta T/2$ 处的焓值：\n$$\nH_s = H(T_s) = C T_s\n$$\n$$\nH_l = H(T_l) = C T_l + L_v\n$$\n通过反转 $H(T)$ 函数的每一段，我们得到 $T(H)$：\n$$\nT(H) =\n\\begin{cases}\nH/C  \\text{if } H \\le H_s \\quad \\text{(固相)} \\\\\n\\frac{H \\Delta T + L_v T_s}{L_v + C \\Delta T}  \\text{if } H_s  H  H_l \\quad \\text{(糊状区)} \\\\\n(H - L_v)/C  \\text{if } H \\ge H_l \\quad \\text{(液相)}\n\\end{cases}\n$$\n在每个时间步，将此函数逐点应用于焓数组 $H^{n+1}$，以获得温度数组 $T^{n+1}$。\n\n**3. 边界条件**\n边界节点 $i=0$ 和 $i=N-1$ 需要特殊处理。\n\n- **$x=0$ 处的狄利克雷条件**：温度是固定的，$T(0,t) = T_{\\text{left}}$。在每个时间步 $n+1$，我们通过设置 $T_0^{n+1} = T_{\\text{left}}$ 来强制执行此条件。为了保持状态变量之间的一致性，该节点的焓也必须更新以对应于此固定温度：$H_0^{n+1} = H(T_{\\text{left}})$，使用给定的 $H(T)$ 函数计算。\n\n- **$x=L$ 处的诺伊曼条件**：零通量条件 $\\partial T/\\partial x = 0$ 使用二阶精度的鬼点法实现。我们设想在 $x_N = x_{N-1} + \\Delta x$ 处有一个鬼点，使得在 $x_{N-1}$ 处的梯度中心差分为零：$\\frac{T_N^n - T_{N-2}^n}{2\\Delta x} = 0$，这意味着 $T_N^n = T_{N-2}^n$。将此代入节点 $i=N-1$ 处二阶导数的中心差分公式：\n$$\n\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_{i=N-1} \\approx \\frac{T_N^n - 2T_{N-1}^n + T_{N-2}^n}{(\\Delta x)^2} = \\frac{T_{N-2}^n - 2T_{N-1}^n + T_{N-2}^n}{(\\Delta x)^2} = \\frac{2(T_{N-2}^n - T_{N-1}^n)}{(\\Delta x)^2}\n$$\n因此，最右侧节点的焓更新公式为：\n$$\nH_{N-1}^{n+1} = H_{N-1}^n + \\frac{2 k \\Delta t}{(\\Delta x)^2} (T_{N-2}^n - T_{N-1}^n)\n$$\n\n**4. 界面位置追踪**\n固-液界面位置 $s(t)$ 定义为 $T(x,t) = T_m$ 的位置。在给定时间计算出温度分布 $T^n$ 后，我们从左侧开始搜索第一个温度穿过 $T_m$ 的网格区间 $[x_i, x_{i+1}]$。这发生在 $(T_i^n - T_m)(T_{i+1}^n - T_m) \\le 0$ 的地方。如果找到这样的区间，界面位置 $s$ 通过线性插值估算：\n$$\ns = x_i + \\Delta x \\frac{T_m - T_i^n}{T_{i+1}^n - T_i^n}\n$$\n如果不存在这样的穿越，问题指定了位置：如果所有温度 $T_i^n \\ge T_m$（完全液相/糊状），则 $s=0$；如果所有 $T_i^n \\le T_m$（完全固相/糊状），则 $s=L$。\n\n**5. 算法总结**\n总体算法如下：\n1.  **初始化**：定义所有物理和数值参数。创建空间网格 $x$。将温度数组 $T$ 初始化为 $T_{\\text{init}}$，然后强制执行边界条件 $T_0 = T_{\\text{left}}$。使用 $H(T)$ 关系从初始 $T$ 计算初始焓数组 $H$。\n2.  **时间推进**：循环 $n_{\\text{steps}}$ 次迭代。\n    a. 基于当前温度分布 $T^n$，使用内部节点和右边界节点的显式更新规则计算下一个焓数组 $H^{n+1}$。\n    b. 通过逐点应用反函数 $T(H^{n+1})$ 来恢复新的温度数组 $T^{n+1}$。\n    c. 强制执行狄利克雷边界条件：设置 $T_0^{n+1} = T_{\\text{left}}$ 并更新 $H_0^{n+1} = H(T_{\\text{left}})$。\n    d. 更新后的数组 $H^{n+1}$ 和 $T^{n+1}$ 成为下一次迭代的当前数组。\n3.  **最终计算**：循环结束后，使用插值逻辑从最终温度分布计算最终界面位置 $s(t_{\\text{end}})$。", "answer": "```python\nimport numpy as np\n\ndef get_H_from_T(T_arr, C, Lv, Tm, DT):\n    \"\"\"\n    Computes volumetric enthalpy H from temperature T.\n    T_arr can be a scalar or a numpy array.\n    \"\"\"\n    # Ensure T_arr is an array for consistent processing\n    T = np.atleast_1d(T_arr)\n    H = np.zeros_like(T, dtype=np.float64)\n\n    Ts = Tm - DT / 2.0\n    Tl = Tm + DT / 2.0\n\n    solid_mask = T = Ts\n    liquid_mask = T >= Tl\n    mushy_mask = (~solid_mask)  (~liquid_mask)\n\n    H[solid_mask] = C * T[solid_mask]\n    H[liquid_mask] = C * T[liquid_mask] + Lv\n    H[mushy_mask] = C * T[mushy_mask] + Lv * (T[mushy_mask] - Ts) / DT\n\n    return H\n\ndef get_T_from_H(H_arr, C, Lv, Tm, DT):\n    \"\"\"\n    Computes temperature T from volumetric enthalpy H.\n    H_arr can be a scalar or a numpy array.\n    \"\"\"\n    H = np.atleast_1d(H_arr)\n    T = np.zeros_like(H, dtype=np.float64)\n\n    Ts = Tm - DT / 2.0\n    Tl = Tm + DT / 2.0\n    \n    Hs = C * Ts\n    Hl = C * Tl + Lv\n\n    solid_mask = H = Hs\n    liquid_mask = H >= Hl\n    mushy_mask = (~solid_mask)  (~liquid_mask)\n\n    T[solid_mask] = H[solid_mask] / C\n    T[liquid_mask] = (H[liquid_mask] - Lv) / C\n    T[mushy_mask] = (H[mushy_mask] * DT + Lv * Ts) / (Lv + C * DT)\n\n    return T\n\ndef find_interface_position(x, T, Tm, L):\n    \"\"\"\n    Finds the interface position s where T(s) = Tm.\n    \"\"\"\n    if np.all(T >= Tm):\n        return 0.0\n    if np.all(T = Tm):\n        return L\n\n    cross_indices = np.where((T[:-1] - Tm) * (T[1:] - Tm) = 0)[0]\n    \n    if len(cross_indices) == 0:\n        # Fallback, though the np.all checks should handle this.\n        return 0.0 if T[0] > Tm else L\n\n    i = cross_indices[0]\n    T_i, T_i1 = T[i], T[i+1]\n    x_i, x_i1 = x[i], x[i+1]\n    \n    if T_i == T_i1:\n        return x_i\n    \n    # Linear interpolation\n    s = x_i + (x_i1 - x_i) * (Tm - T_i) / (T_i1 - T_i)\n    return s\n\ndef run_simulation(params):\n    \"\"\"\n    Runs a single simulation case for the Stefan problem.\n    \"\"\"\n    L, N, k, C, Lv, Tm, DT, T_left, T_init, t_end, dt = params\n\n    # Discretization parameters\n    dx = L / (N - 1)\n    n_steps = int(t_end / dt)\n    x = np.linspace(0, L, N)\n    \n    # Initial conditions\n    T = np.full(N, T_init, dtype=np.float64)\n    T[0] = T_left  # Boundary condition dominates at t=0, x=0\n    H = get_H_from_T(T, C, Lv, Tm, DT)\n\n    # Pre-calculate constant factor for performance\n    prefactor = k * dt / (dx**2)\n\n    # Time-marching loop\n    for _ in range(n_steps):\n        # Create a copy of H for the update step.\n        H_new = H.copy()\n        \n        # Update enthalpy for interior nodes\n        H_new[1:-1] = H[1:-1] + prefactor * (T[2:] - 2 * T[1:-1] + T[:-2])\n        \n        # Update enthalpy for right boundary (Neumann)\n        H_new[-1] = H[-1] + 2 * prefactor * (T[-2] - T[-1])\n        \n        # Recover new temperature field from new enthalpy field\n        T_new = get_T_from_H(H_new, C, Lv, Tm, DT)\n\n        # Enforce left boundary (Dirichlet)\n        T_new[0] = T_left\n        H_new[0] = get_H_from_T(T_left, C, Lv, Tm, DT)[0]\n        \n        # Update T and H for the next iteration\n        T, H = T_new, H_new\n\n    # Calculate final interface position\n    s_final = find_interface_position(x, T, Tm, L)\n    \n    return s_final\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite, then prints the formatted results.\n    \"\"\"\n    test_cases = [\n        # Case A (solidification, moderate latent heat)\n        (0.1, 201, 2.0, 2.0e6, 3.34e8, 0.0, 0.2, -10.0, 10.0, 200.0, 0.05),\n        \n        # Case B (solidification, very large latent heat)\n        (0.1, 201, 2.0, 2.0e6, 1.0e9, 0.0, 0.2, -10.0, 10.0, 200.0, 0.05),\n        \n        # Case C (melting, moderate latent heat)\n        (0.05, 201, 1.5, 2.0e6, 3.34e8, 0.0, 0.2, 10.0, -5.0, 100.0, 0.02),\n    ]\n\n    results = []\n    for case in test_cases:\n        s = run_simulation(case)\n        results.append(f\"{s:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2523100"}]}