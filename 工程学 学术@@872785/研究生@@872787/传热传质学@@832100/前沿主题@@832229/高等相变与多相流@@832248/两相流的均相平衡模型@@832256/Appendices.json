{"hands_on_practices": [{"introduction": "工程中的一个常见问题是预测流体在受热管道中沸腾时的状态。本练习将热力学第一定律应用于由均匀平衡模型（HEM）描述的两相混合物。通过这个练习，您将学习如何将热量输入与蒸汽质量的变化直接联系起来，然后计算由此产生的空隙率——这是理解两相流行为的关键参数 [@problem_id:2495004]。", "problem": "一根内径为 $D = 0.010 \\,\\mathrm{m}$、加热长度为 $L = 5.00 \\,\\mathrm{m}$ 的水平圆管中，液态水以 $G = 500 \\,\\mathrm{kg\\,m^{-2}\\,s^{-1}}$ 的稳定质量通量流动。管壁在整个加热长度上提供 $q'' = 200 \\,\\mathrm{kW\\,m^{-2}}$ 的均匀热通量。圆管排入一个大型储罐，该储罐将流体压力维持在 $p = 1.000 \\,\\mathrm{MPa}$，因此可以忽略管内的轴向压降。入口水温为 $T_{\\mathrm{in}} = 170.0 \\,^{\\circ}\\mathrm{C}$。假设在任何两相流过程中，混合物都遵循均匀平衡模型 (HEM)：即各相在当地的饱和状态下处于热力学和力学平衡，并且速度相等。\n\n仅使用一维稳态质量和能量守恒以及 HEM 的等速约束，推导出计算出口空泡份额 $\\alpha_{\\mathrm{out}}$ 所需的表达式，该表达式应使用给定物理量和已知热物理性质表示。然后，在以下条件和数据下，对 $\\alpha_{\\mathrm{out}}$ 进行数值计算。假设能量平衡中动能和势能的变化可以忽略，轴向压降也可以忽略，因此在两相区适用 $p = 1.000 \\,\\mathrm{MPa}$ 下的饱和性质：\n\n- 饱和温度: $T_{\\mathrm{sat}} = 179.9 \\,^{\\circ}\\mathrm{C}$。\n- 饱和液比焓: $h_{f} = 781.3 \\,\\mathrm{kJ\\,kg^{-1}}$。\n- 饱和蒸汽比焓: $h_{g} = 2776.2 \\,\\mathrm{kJ\\,kg^{-1}}$。\n- 饱和液密度: $\\rho_{f} = 888 \\,\\mathrm{kg\\,m^{-3}}$。\n- 饱和蒸汽密度: $\\rho_{g} = 5.15 \\,\\mathrm{kg\\,m^{-3}}$。\n- 在约 $p = 1.000 \\,\\mathrm{MPa}$ 下的液体比热: $c_{p,\\ell} = 4.30 \\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$。\n\n以纯数（无量纲）形式给出出口空泡份额的最终答案。将答案四舍五入至四位有效数字。", "solution": "对问题陈述的分析表明，该问题具有科学依据、提法得当且内部一致。它提出了一个两相流传热领域的标准问题，提供了所有必要的数据和真实的热物理性质。不存在逻辑矛盾或含糊不清之处。因此，该问题是有效的，我们将着手求解。\n\n目标是推导并计算出口空泡份额 $\\alpha_{\\mathrm{out}}$。空泡份额 $\\alpha$ 定义为蒸汽（气）相所占的横截面积 $A_g$ 与总横截面积 $A$ 的比值。\n$$\n\\alpha = \\frac{A_g}{A}\n$$\n那么，液相所占的面积 $A_f$ 为 $A_f = A - A_g = (1-\\alpha)A$。\n\n在均匀平衡模型 (HEM) 下，液相和汽相具有相同的速度，即 $u_f = u_g = u$。汽相的质量流量 $\\dot{m}_g$ 和液相的质量流量 $\\dot{m}_f$ 分别由下式给出：\n$$\n\\dot{m}_g = \\rho_g A_g u = \\rho_g (\\alpha A) u\n$$\n$$\n\\dot{m}_f = \\rho_f A_f u = \\rho_f (1-\\alpha) A u\n$$\n其中 $\\rho_g$ 和 $\\rho_f$ 分别是饱和蒸汽密度和饱和液体密度。\n\n热力学干度 $x$ 是蒸汽质量流量与总质量流量 $\\dot{m} = \\dot{m}_f + \\dot{m}_g$ 的比值。\n$$\nx = \\frac{\\dot{m}_g}{\\dot{m}_f + \\dot{m}_g} = \\frac{\\rho_g \\alpha A u}{\\rho_f (1-\\alpha) A u + \\rho_g \\alpha A u} = \\frac{\\rho_g \\alpha}{\\rho_f (1-\\alpha) + \\rho_g \\alpha}\n$$\n为了用干度 $x$ 表示空泡份额 $\\alpha$，我们必须重新整理这个表达式。\n$$\nx[\\rho_f (1-\\alpha) + \\rho_g \\alpha] = \\rho_g \\alpha\n$$\n$$\nx \\rho_f - x \\rho_f \\alpha + x \\rho_g \\alpha = \\rho_g \\alpha\n$$\n$$\nx \\rho_f = \\alpha (\\rho_g - x \\rho_g + x \\rho_f) = \\alpha [(1-x)\\rho_g + x \\rho_f]\n$$\n这就得到了用干度和相密度表示空泡份额所需的表达式：\n$$\n\\alpha = \\frac{x \\rho_f}{(1-x)\\rho_g + x \\rho_f}\n$$\n这也可以写成：\n$$\n\\alpha = \\frac{x}{x + (1-x)\\frac{\\rho_g}{\\rho_f}}\n$$\n为了求出出口空泡份额 $\\alpha_{\\mathrm{out}}$，我们必须首先确定出口干度 $x_{\\mathrm{out}}$。这可以通过对流经加热管的流体应用稳态能量平衡来实现。控制体积是管内流体的全部体积。\n\n根据题意忽略动能和势能的变化，此开放系统的热力学第一定律为：\n$$\n\\dot{Q} = \\dot{m} (h_{\\mathrm{out}} - h_{\\mathrm{in}})\n$$\n其中 $\\dot{Q}$ 是传入流体的总传热速率，$\\dot{m}$ 是总质量流量，$h_{\\mathrm{in}}$ 和 $h_{\\mathrm{out}}$ 分别是入口和出口的比焓。\n\n总质量流量 $\\dot{m}$ 与质量通量 $G$ 和管的横截面积 $A = \\frac{\\pi D^2}{4}$ 相关：\n$$\n\\dot{m} = G A = G \\frac{\\pi D^2}{4}\n$$\n总传热速率 $\\dot{Q}$ 是均匀热通量 $q''$ 与管的加热表面积 $A_s = \\pi D L$ 的乘积：\n$$\n\\dot{Q} = q'' A_s = q'' \\pi D L\n$$\n将这些代入能量平衡方程得到：\n$$\nq'' \\pi D L = \\left(G \\frac{\\pi D^2}{4}\\right) (h_{\\mathrm{out}} - h_{\\mathrm{in}})\n$$\n求解比焓的变化量 $\\Delta h = h_{\\mathrm{out}} - h_{\\mathrm{in}}$：\n$$\n\\Delta h = \\frac{q'' \\pi D L}{G \\frac{\\pi D^2}{4}} = \\frac{4 q'' L}{G D}\n$$\n入口比焓 $h_{\\mathrm{in}}$ 对应于 $T_{\\mathrm{in}} = 170.0 \\,^{\\circ}\\mathrm{C}$ 的过冷液体。其计算方法是，从系统压力下的饱和液比焓 $h_f$ 开始，减去与过冷度 $T_{\\mathrm{sat}} - T_{\\mathrm{in}}$ 对应的显热。\n$$\nh_{\\mathrm{in}} \\approx h_f - c_{p,\\ell} (T_{\\mathrm{sat}} - T_{\\mathrm{in}})\n$$\n出口比焓则为 $h_{\\mathrm{out}} = h_{\\mathrm{in}} + \\Delta h$。如果 $h_f  h_{\\mathrm{out}}  h_g$，则出口流体为两相混合物。出口干度 $x_{\\mathrm{out}}$ 由混合物比焓关系式定义：\n$$\nh_{\\mathrm{out}} = (1-x_{\\mathrm{out}})h_f + x_{\\mathrm{out}}h_g = h_f + x_{\\mathrm{out}}(h_g - h_f)\n$$\n求解 $x_{\\mathrm{out}}$：\n$$\nx_{\\mathrm{out}} = \\frac{h_{\\mathrm{out}} - h_f}{h_g - h_f} = \\frac{h_{\\mathrm{out}} - h_f}{h_{fg}}\n$$\n现在我们使用所提供的数据进行数值计算。为保证计算的一致性，所有数值都将转换为国际单位制（SI）基本单位。\n给定数据：\n$D = 0.010 \\,\\mathrm{m}$\n$L = 5.00 \\,\\mathrm{m}$\n$G = 500 \\,\\mathrm{kg\\,m^{-2}\\,s^{-1}}$\n$q'' = 200 \\,\\mathrm{kW\\,m^{-2}} = 2.00 \\times 10^5 \\,\\mathrm{J\\,s^{-1}\\,m^{-2}}$\n$T_{\\mathrm{in}} = 170.0 \\,^{\\circ}\\mathrm{C}$\n$T_{\\mathrm{sat}} = 179.9 \\,^{\\circ}\\mathrm{C}$\n$c_{p,\\ell} = 4.30 \\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}} = 4.30 \\times 10^3 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n$h_f = 781.3 \\,\\mathrm{kJ\\,kg^{-1}} = 7.813 \\times 10^5 \\,\\mathrm{J\\,kg^{-1}}$\n$h_g = 2776.2 \\,\\mathrm{kJ\\,kg^{-1}} = 2.7762 \\times 10^6 \\,\\mathrm{J\\,kg^{-1}}$\n$\\rho_f = 888 \\,\\mathrm{kg\\,m^{-3}}$\n$\\rho_g = 5.15 \\,\\mathrm{kg\\,m^{-3}}$\n\n首先，计算入口比焓 $h_{\\mathrm{in}}$：\n$$\nh_{\\mathrm{in}} = 7.813 \\times 10^5 \\,\\mathrm{J\\,kg^{-1}} - (4.30 \\times 10^3 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})(179.9 - 170.0)\\,\\mathrm{K}\n$$\n$$\nh_{\\mathrm{in}} = 7.813 \\times 10^5 - (4.30 \\times 10^3)(9.9) = 7.813 \\times 10^5 - 42570 = 738730 \\,\\mathrm{J\\,kg^{-1}}\n$$\n\n接下来，计算比焓增量 $\\Delta h$：\n$$\n\\Delta h = \\frac{4 (2.00 \\times 10^5 \\,\\mathrm{J\\,s^{-1}\\,m^{-2}}) (5.00 \\,\\mathrm{m})}{(500 \\,\\mathrm{kg\\,m^{-2}\\,s^{-1}}) (0.010 \\,\\mathrm{m})} = \\frac{4.00 \\times 10^6}{5.00} = 8.00 \\times 10^5 \\,\\mathrm{J\\,kg^{-1}}\n$$\n\n现在，计算出口比焓 $h_{\\mathrm{out}}$：\n$$\nh_{\\mathrm{out}} = h_{\\mathrm{in}} + \\Delta h = 738730 + 8.00 \\times 10^5 = 1538730 \\,\\mathrm{J\\,kg^{-1}} = 1538.73 \\,\\mathrm{kJ\\,kg^{-1}}\n$$\n我们通过将 $h_{\\mathrm{out}}$ 与 $h_f$ 和 $h_g$ 进行比较来检查出口状态是否为两相混合物：\n$h_f = 781.3 \\,\\mathrm{kJ\\,kg^{-1}}$ 且 $h_g = 2776.2 \\,\\mathrm{kJ\\,kg^{-1}}$。\n由于 $781.3  1538.73  2776.2$，出口确实是两相混合物。\n\n现在我们可以计算出口干度 $x_{\\mathrm{out}}$：\n汽化潜热为 $h_{fg} = h_g - h_f = 2776.2 - 781.3 = 1994.9 \\,\\mathrm{kJ\\,kg^{-1}}$。\n$$\nx_{\\mathrm{out}} = \\frac{h_{\\mathrm{out}} - h_f}{h_{fg}} = \\frac{1538.73 - 781.3}{1994.9} = \\frac{757.43}{1994.9} \\approx 0.37968\n$$\n\n最后，我们使用推导出的表达式来计算出口空泡份额 $\\alpha_{\\mathrm{out}}$：\n$$\n\\alpha_{\\mathrm{out}} = \\frac{x_{\\mathrm{out}} \\rho_f}{(1-x_{\\mathrm{out}})\\rho_g + x_{\\mathrm{out}} \\rho_f}\n$$\n代入数值：\n$$\n\\alpha_{\\mathrm{out}} = \\frac{(0.37968)(888)}{(1-0.37968)(5.15) + (0.37968)(888)}\n$$\n$$\n\\alpha_{\\mathrm{out}} = \\frac{337.156}{(0.62032)(5.15) + 337.156} = \\frac{337.156}{3.1946 + 337.156} = \\frac{337.156}{340.351} \\approx 0.99061\n$$\n按要求四舍五入到四位有效数字，出口空泡份额为 $0.9906$。这个高数值在物理上是正确的，因为汽相的密度比液相的密度小几个数量级，因此中等质量分数的蒸汽会占据非常大的体积分数。", "answer": "$$\n\\boxed{0.9906}\n$$", "id": "2495004"}, {"introduction": "均匀平衡模型（HEM）的核心假设是液相和气相始终处于完美的热力学和力学平衡状态。本练习要求您通过比较相间的动量和热弛豫时间尺度与整体流动时间，来量化评估此假设的有效性。通过进行这种分析，您将对模型的局限性有更深刻、更批判性的理解，并学会判断何时应用该模型是合适的 [@problem_id:2495003]。", "problem": "一根管道输送湿蒸汽流，其中悬浮着细小分散、单分散的液态水滴，并与载气交换动量和热量。均匀平衡模型 (HEM) 假设相对于流体动力学演化，相间平衡是瞬时完成的。在长度为 $L$ 的水平直管段中，可以通过比较主导的相间弛豫时间尺度与流体动力学停留时间来评估 HEM 的适用性。考虑以下情况。\n\n- 载气为约 $100\\,^{\\circ}\\mathrm{C}$ 的饱和蒸汽，其密度 $\\rho_{g} = 0.60\\,\\mathrm{kg\\,m^{-3}}$，动力粘度 $\\mu_{g} = 1.20 \\times 10^{-5}\\,\\mathrm{Pa\\,s}$，热导率 $k_{g} = 0.025\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，普朗特数 $\\mathrm{Pr}_{g} = 1.0$。\n- 分散相由直径 $d = 50\\,\\mu\\mathrm{m}$ 的液态水滴组成，其密度 $\\rho_{p} = 958\\,\\mathrm{kg\\,m^{-3}}$，比热容 $c_{p,p} = 4.20 \\times 10^{3}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，热导率 $k_{l} = 0.68\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$。\n- 混合物的整体（表观）速度是均匀的，等于 $U = 0.50\\,\\mathrm{m\\,s^{-1}}$，直管段长度为 $L = 2.0\\,\\mathrm{m}$。\n\n从第一性原理和经过充分检验的物理定律出发，按以下步骤进行：\n\n1) 在蠕动流条件下，通过应用带有线性粘性曳力的牛顿第二定律，推导适用于粘性连续介质中微小球形颗粒的液滴动量弛豫时间尺度 $\\tau_{m}$，并用 $\\rho_{p}$、$d$ 和 $\\mu_{g}$ 表示 $\\tau_{m}$。\n\n2) 在小毕渥数（集总电容）极限下，通过建立一个将液滴热容与外部对流传热系数耦合的能量平衡方程，推导液滴热弛豫时间尺度 $\\tau_{T}$。对于中低雷诺数气流中球体周围的外部对流，将该系数与努塞尔数 $\\mathrm{Nu}$ 相关联，并使用公认的 $\\mathrm{Nu}$ 作为雷诺数 $\\mathrm{Re}$ 和普朗特数 $\\mathrm{Pr}_{g}$ 函数的关联式。用 $\\rho_{p}$、$c_{p,p}$、$d$、$k_{g}$ 和 $\\mathrm{Nu}$ 表示 $\\tau_{T}$。\n\n3) 使用你推导的表达式，根据给定数据计算 $\\tau_{m}$ 和 $\\tau_{T}$ 的数值。通过计算液滴雷诺数 $\\mathrm{Re}$ 和内部毕渥数 $\\mathrm{Bi}$，事后验证蠕动流和小毕渥数假设的自洽性。在估算 $\\mathrm{Re}$ 和外部传热时，取相间相对速度与 $U$ 为同一数量级。\n\n4) 定义流体动力学停留时间 $t_{h} = L/U$ 和平衡参数\n$$\n\\varepsilon \\equiv \\frac{\\max\\!\\left(\\tau_{m},\\,\\tau_{T}\\right)}{t_{h}}。\n$$\n计算给定数据的 $\\varepsilon$。\n\n将你最终的 $\\varepsilon$ 数值答案四舍五入到三位有效数字，并以无单位的纯数形式报告。如果需要，用适当的国际单位制（SI）单位表示任何中间物理量，但只有最终答案应该是无单位的。", "solution": "问题陈述已经过严格评估，被认为是有效的。它具有科学依据、提法明确、客观且内部一致。它提出了一个两相流和传热分析中的标准问题，为获得唯一解提供了所有必要的物理性质和条件。蒸汽和水的数据在指定条件下是物理准确的。指令清晰，可以导出一个可验证的结果。我将开始解题。\n\n该问题要求进行四部分分析，通过比较特征相间弛豫时间与含颗粒流的流体动力学停留时间，来评估均匀平衡模型（HEM）的适用性。\n\n1) 动量弛豫时间尺度 $\\tau_{m}$ 的推导。\n我们考虑一个直径为 $d$、密度为 $\\rho_{p}$ 的球形液滴在粘度为 $\\mu_{g}$ 的气体中运动。液滴的牛顿第二定律为：\n$$\nm_{p} \\frac{d\\vec{u}_{p}}{dt} = \\vec{F}_{D}\n$$\n其中 $m_{p}$ 是液滴质量，$\\vec{u}_{p}$ 是液滴速度，$\\vec{F}_{D}$ 是气体施加的曳力。液滴质量为 $m_{p} = \\rho_{p} V_{p} = \\rho_{p} \\frac{\\pi d^{3}}{6}$。\n\n在蠕动流条件下（$\\mathrm{Re} \\ll 1$），曳力由斯托克斯定律给出：\n$$\n\\vec{F}_{D} = 3\\pi\\mu_{g}d(\\vec{u}_{g} - \\vec{u}_{p})\n$$\n其中 $\\vec{u}_{g}$ 是气体速度。设相对速度为 $\\vec{w} = \\vec{u}_{p} - \\vec{u}_{g}$。假设背景气体速度 $\\vec{u}_{g}$ 是恒定的，我们有 $\\frac{d\\vec{w}}{dt} = \\frac{d\\vec{u}_{p}}{dt}$。牛顿第二定律变为：\n$$\nm_{p} \\frac{d\\vec{w}}{dt} = -3\\pi\\mu_{g}d \\vec{w}\n$$\n将其整理成一阶线性常微分方程的标准形式，我们得到：\n$$\n\\frac{d\\vec{w}}{dt} = -\\left(\\frac{3\\pi\\mu_{g}d}{m_{p}}\\right) \\vec{w}\n$$\n该方程描述了相对速度以一个特征时间尺度指数衰减，我们将其确定为动量弛豫时间 $\\tau_{m}$：\n$$\n\\tau_{m} = \\frac{m_{p}}{3\\pi\\mu_{g}d}\n$$\n代入液滴质量的表达式，我们得到用所需参数表示的 $\\tau_{m}$：\n$$\n\\tau_{m} = \\frac{\\rho_{p} \\frac{\\pi d^{3}}{6}}{3\\pi\\mu_{g}d} = \\frac{\\rho_{p} d^{2}}{18\\mu_{g}}\n$$\n\n2) 热弛豫时间尺度 $\\tau_{T}$ 的推导。\n我们对液滴应用能量平衡。在小毕渥数（集总电容）假设下，液滴内部的温度分布是均匀的，$T_{p}(t)$。液滴内能的变化率与来自周围温度为 $T_{g}$ 的气体的对流传热相平衡：\n$$\nm_{p} c_{p,p} \\frac{dT_{p}}{dt} = h A_{s} (T_{g} - T_{p})\n$$\n这里，$c_{p,p}$ 是液滴的比热容，$h$ 是对流传热系数，$A_{s} = \\pi d^{2}$ 是液滴的表面积。设温差为 $\\Delta T = T_{p} - T_{g}$。假设 $T_g$ 是恒定的，我们有 $\\frac{d(\\Delta T)}{dt} = \\frac{dT_{p}}{dt}$。能量平衡方程变为：\n$$\nm_{p} c_{p,p} \\frac{d(\\Delta T)}{dt} = -h A_{s} \\Delta T\n$$\n这是另一个一阶线性常微分方程，由此我们确定热弛豫时间 $\\tau_{T}$：\n$$\n\\tau_{T} = \\frac{m_{p} c_{p,p}}{h A_{s}}\n$$\n代入 $m_{p}$ 和 $A_{s}$ 的表达式：\n$$\n\\tau_{T} = \\frac{\\left(\\rho_{p} \\frac{\\pi d^{3}}{6}\\right) c_{p,p}}{h (\\pi d^{2})} = \\frac{\\rho_{p} c_{p,p} d}{6h}\n$$\n传热系数 $h$ 通过定义 $\\mathrm{Nu} = \\frac{hd}{k_{g}}$ 与努塞尔数 $\\mathrm{Nu}$ 相关，其中 $k_{g}$ 是气体的热导率。因此，$h = \\frac{\\mathrm{Nu} k_{g}}{d}$。将此代入 $\\tau_{T}$ 的表达式，得到最终形式：\n$$\n\\tau_{T} = \\frac{\\rho_{p} c_{p,p} d}{6 \\left(\\frac{\\mathrm{Nu} k_{g}}{d}\\right)} = \\frac{\\rho_{p} c_{p,p} d^{2}}{6 \\mathrm{Nu} k_{g}}\n$$\n\n3) 数值计算与假设验证。\n给定数据如下：\n$\\rho_{g} = 0.60\\,\\mathrm{kg\\,m^{-3}}$，$\\mu_{g} = 1.20 \\times 10^{-5}\\,\\mathrm{Pa\\,s}$， $k_{g} = 0.025\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$\\mathrm{Pr}_{g} = 1.0$。\n$\\rho_{p} = 958\\,\\mathrm{kg\\,m^{-3}}$，$c_{p,p} = 4.20 \\times 10^{3}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$k_{l} = 0.68\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$d = 50\\,\\mu\\mathrm{m} = 5.0 \\times 10^{-5}\\,\\mathrm{m}$。\n$U = 0.50\\,\\mathrm{m\\,s^{-1}}$，$L = 2.0\\,\\mathrm{m}$。\n\n首先，我们通过计算液滴雷诺数 $\\mathrm{Re}$ 来验证蠕动流假设。按照指示，我们估计相对速度为 $U_{rel} \\approx U$。\n$$\n\\mathrm{Re} = \\frac{\\rho_{g} U d}{\\mu_{g}} = \\frac{(0.60\\,\\mathrm{kg\\,m^{-3}})(0.50\\,\\mathrm{m\\,s^{-1}})(5.0 \\times 10^{-5}\\,\\mathrm{m})}{1.20 \\times 10^{-5}\\,\\mathrm{Pa\\,s}} = 1.25\n$$\n斯托克斯流区域严格适用于 $\\mathrm{Re} \\ll 1$。$\\mathrm{Re} = 1.25$ 的值表明流动处于斯托克斯区域的上限，惯性效应变得不可忽略。因此，该假设仅勉强满足。然而，我们根据问题的指示继续使用推导出的公式。\n\n现在，我们计算 $\\tau_{m}$：\n$$\n\\tau_{m} = \\frac{\\rho_{p} d^{2}}{18\\mu_{g}} = \\frac{(958\\,\\mathrm{kg\\,m^{-3}})(5.0 \\times 10^{-5}\\,\\mathrm{m})^{2}}{18(1.20 \\times 10^{-5}\\,\\mathrm{Pa\\,s})} \\approx 0.01109\\,\\mathrm{s}\n$$\n\n接下来，我们计算 $\\tau_{T}$。这需要努塞尔数 $\\mathrm{Nu}$。我们使用 Ranz-Marshall 关联式，它适用于此 $\\mathrm{Re}$ 范围内的球体：\n$$\n\\mathrm{Nu} = 2.0 + 0.6 \\mathrm{Re}^{1/2} \\mathrm{Pr}_{g}^{1/3}\n$$\n代入 $\\mathrm{Re} = 1.25$ 和 $\\mathrm{Pr}_{g} = 1.0$：\n$$\n\\mathrm{Nu} = 2.0 + 0.6 (1.25)^{1/2} (1.0)^{1/3} \\approx 2.0 + 0.6 (1.11803) \\approx 2.6708\n$$\n\n有了 $\\mathrm{Nu}$，我们可以计算 $\\tau_{T}$：\n$$\n\\tau_{T} = \\frac{\\rho_{p} c_{p,p} d^{2}}{6 \\mathrm{Nu} k_{g}} = \\frac{(958\\,\\mathrm{kg\\,m^{-3}})(4.20 \\times 10^{3}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})(5.0 \\times 10^{-5}\\,\\mathrm{m})^{2}}{6(2.6708)(0.025\\,\\mathrm{W\\,m^{-1}\\,K^{-1}})} \\approx 0.02511\\,\\mathrm{s}\n$$\n\n现在，我们验证小毕渥数假设。毕渥数 $\\mathrm{Bi}$ 由 $\\mathrm{Bi} = \\frac{hL_{c}}{k_{l}}$ 给出，其中 $L_c$ 是液滴的特征长度，$k_l$ 是其热导率。对于球体，$L_{c} = V_{p}/A_{s} = d/6$。\n首先，计算传热系数 $h$：\n$$\nh = \\frac{\\mathrm{Nu} k_{g}}{d} = \\frac{(2.6708)(0.025\\,\\mathrm{W\\,m^{-1}\\,K^{-1}})}{5.0 \\times 10^{-5}\\,\\mathrm{m}} \\approx 1335.4\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}\n$$\n现在，计算毕渥数：\n$$\n\\mathrm{Bi} = \\frac{h (d/6)}{k_{l}} = \\frac{(1335.4\\,\\mathrm{W\\,m^{-2}\\,K^{-1}})(5.0 \\times 10^{-5}\\,\\mathrm{m} / 6)}{0.68\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}} \\approx 0.016\n$$\n由于 $\\mathrm{Bi} \\approx 0.016 \\ll 0.1$，液滴的内部热阻与外部对流热阻相比可以忽略不计。因此，集总电容假设是有效的。\n\n4) 平衡参数 $\\varepsilon$ 的计算。\n流体动力学停留时间 $t_{h}$ 是主流体流过管道段长度 $L$ 所需的时间：\n$$\nt_{h} = \\frac{L}{U} = \\frac{2.0\\,\\mathrm{m}}{0.50\\,\\mathrm{m\\,s^{-1}}} = 4.0\\,\\mathrm{s}\n$$\n平衡参数 $\\varepsilon$ 定义为较长的弛豫时间与停留时间之比。比较两个弛豫时间：\n$\\tau_{m} \\approx 0.0111\\,\\mathrm{s}$\n$\\tau_{T} \\approx 0.0251\\,\\mathrm{s}$\n热弛豫时间更长。因此，$\\max(\\tau_{m}, \\tau_{T}) = \\tau_{T}$。\n我们现在可以计算 $\\varepsilon$：\n$$\n\\varepsilon = \\frac{\\max\\!\\left(\\tau_{m},\\,\\tau_{T}\\right)}{t_{h}} = \\frac{\\tau_{T}}{t_{h}} = \\frac{0.02511\\,\\mathrm{s}}{4.0\\,\\mathrm{s}} \\approx 0.0062775\n$$\n四舍五入到三位有效数字，我们得到 $\\varepsilon \\approx 0.00628$。这个很小的 $\\varepsilon$ 值表明，动量和热弛豫的发生都远快于液滴在管段中花费的时间，这表明对于这个特定的流动场景，均匀平衡模型是一个合理的近似。", "answer": "$$\n\\boxed{0.00628}\n$$", "id": "2495003"}, {"introduction": "预测可压缩两相流，特别是像喷管中的壅塞（choked flow）这类现象，需要稳健的计算方法。本练习将指导您构建一个计算程序，该程序实现了完整的均匀平衡模型，将等熵流关系与热力学性质相结合。通过这个实践，您将把理论原理转化为一个实用的工具，用于分析高速两相流并预测如临界质量通量等关键条件 [@problem_id:2494999]。", "problem": "考虑饱和液汽混合物通过光滑、无摩擦的收敛喷管或文丘里管的稳态、一维、绝热流动。使用均相平衡模型（HEM）对两相流进行建模，该模型假设相间存在单一速度、单一温度和局部热力学平衡。使用无粘流的质量、动量和能量守恒方程，以及饱和线上的热力学关系来封闭该问题。您的任务是推导一个计算程序，该程序能针对给定的上游饱和状态，计算作为局部压力函数的质量通量，识别壅塞（临界）条件，并预测在指定质量流量下文丘里管的喉部压力。\n\n从以下基本依据和核心定义出发：\n\n- 稳态一维流中的质量守恒：$\\dot{m} = \\rho A v$，其中 $\\dot{m}$ 是质量流量，$\\rho$ 是混合物密度，$A$ 是横截面积，$v$ 是轴向速度。\n- 能量守恒（稳态、绝热、无粘、无轴功）：$h_{0} = h + \\dfrac{v^{2}}{2}$，其中 $h_{0}$ 是滞止焓，$h$ 是静焓。\n- 在局部压力 $p$ 下，饱和线上的均相平衡模型（HEM）混合物封闭关系：\n  - 饱和温度 $T_{\\mathrm{sat}}(p)$ 满足水的安托万方程，该方程在大约 $1^{\\circ}\\mathrm{C}$ 到 $100^{\\circ}\\mathrm{C}$ 的范围内有效：$\\log_{10}\\!\\left(p_{\\mathrm{mmHg}}\\right) = A - \\dfrac{B}{C + T_{C}}$，其中 $p_{\\mathrm{mmHg}}$ 是以 $\\mathrm{mmHg}$ 为单位的压力，$T_{C}$ 是以 ${}^{\\circ}\\mathrm{C}$ 为单位的温度，常数为 $A = 8.07131$，$B = 1730.63$，$C = 233.426$，且 $p_{\\mathrm{mmHg}} = p / 133.322$（$p$ 的单位为 $\\mathrm{Pa}$）。对此方程求逆，以获得每个 $p$ 对应的 $T_{\\mathrm{sat}}(p)$（单位为 $\\mathrm{K}$）。\n  - 饱和曲线的克拉佩龙方程：$\\dfrac{dp_{\\mathrm{sat}}}{dT} = \\dfrac{h_{lv}}{T\\left(v_{v}-v_{l}\\right)}$，其中 $h_{lv}$ 是汽化潜热，$v_{v}$ 和 $v_{l}$ 分别是饱和蒸汽和饱和液体的比容，$T$ 是绝对温度。使用此方程计算 $h_{lv}(p)$，即 $h_{lv}(p) = T\\left(v_{v}-v_{l}\\right)\\dfrac{dp_{\\mathrm{sat}}}{dT}$。\n  - 饱和液体密度近似恒定：$\\rho_{l} = 950\\,\\mathrm{kg/m^{3}}$。饱和蒸汽遵循理想气体定律：$\\rho_{v} = \\dfrac{p}{R_{v} T}$，其中 $R_{v} = 461.5\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n  - 饱和液体焓和熵（参考温度为 $T_{\\mathrm{ref}} = 273.15\\ \\mathrm{K}$）：$h_{l}(T) = c_{pl}\\left(T - T_{\\mathrm{ref}}\\right)$ 和 $s_{l}(T) = c_{pl}\\ln\\!\\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right)$，其中 $c_{pl} = 4200\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n  - 饱和蒸汽焓和熵：$h_{v}(T) = h_{l}(T) + h_{lv}(p)$ 和 $s_{v}(T) = s_{l}(T) + \\dfrac{h_{lv}(p)}{T}$。\n  - 混合物干度（蒸汽质量分数）$x \\in [0,1]$，混合物焓 $h = (1-x) h_{l} + x h_{v}$，混合物比容 $v = (1-x) v_{l} + x v_{v}$（其中 $v_{l} = 1/\\rho_{l}$ 和 $v_{v} = 1/\\rho_{v}$），以及混合物密度 $\\rho = 1/v$。\n  - 均相平衡模型等熵路径：混合物沿着比熵恒定为 $s_{0} = (1-x_{0}) s_{l}(T_{0}) + x_{0} s_{v}(T_{0})$ 的路径膨胀或压缩，其中上游状态为在压力 $p_{0}$、干度 $x_{0}$ 和温度 $T_{0} = T_{\\mathrm{sat}}(p_{0})$ 下的饱和状态。对于任何局部压力 $p$，混合物保持在 $T = T_{\\mathrm{sat}}(p)$ 的饱和状态，局部干度通过施加 $s(p,x) = s_{0}$ 得到，即 $x(p) = \\dfrac{s_{0} - s_{l}(T)}{s_{v}(T) - s_{l}(T)}$，如有必要，为保证数值稳定性，需将结果裁剪到区间 $[0,1]$ 内。\n\n基于以上内容，推导下列计算结构，除基本依据所隐含的公式外，不引入任何快捷公式：\n\n- 在 $p_{0}$ 处，入口速度可忽略不计的上游滞止焓 $h_{0} = (1-x_{0}) h_{l}(T_{0}) + x_{0} h_{v}(T_{0})$。\n- 质量通量函数 $G(p)$，作为沿均相平衡模型等熵路径的局部压力 $p$ 的函数，定义如下：\n  1. 计算 $T = T_{\\mathrm{sat}}(p)$。\n  2. 根据等熵条件 $s(p,x) = s_{0}$ 计算 $x(p)$。\n  3. 计算在该 $p$ 和 $x(p)$ 下的 $h(p)$ 和 $\\rho(p)$。\n  4. 根据能量守恒计算局部速度 $v(p) = \\sqrt{2\\max\\{0,\\,h_{0} - h(p)\\}}$，并设置 $G(p) = \\rho(p)\\, v(p)$。\n- 临界（壅塞）条件对应于 $G(p)$ 在容许压力区间 $p \\in [p_{\\min},\\,p_{0}]$ 上的最大值，其中选择 $p_{\\min} = 1500\\ \\mathrm{Pa}$ 以保持在安托万相关式的有效范围内。\n\n您必须实现一个程序，针对以下测试套件，为每个测试计算所要求的标量结果：\n\n- 测试 1 (收敛喷管，临界质量通量): 上游饱和状态 $p_{0} = 101325\\ \\mathrm{Pa}$，$x_{0} = 0.2$。通过在 $p \\in [p_{\\min},\\,p_{0}]$ 上最大化 $G(p)$ 来计算最大质量通量 $G_{\\max}$，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$。\n- 测试 2 (文丘里管，亚临界喉部压力): 相同的上游状态 $p_{0} = 101325\\ \\mathrm{Pa}$，$x_{0} = 0.2$，喉部面积 $A_{t} = 1.0\\times 10^{-3}\\ \\mathrm{m^{2}}$，以及质量流量 $\\dot{m} = 0.03\\,\\mathrm{kg/s}$。计算喉部压力 $p_{t}$（单位为 $\\mathrm{Pa}$），作为 $G(p_{t}) = \\dot{m}/A_{t}$ 的较高压力根，前提是 $\\dot{m}/A_{t}  G_{\\max}$。如果由于请求的质量通量超过临界值而无此根存在，则将此测试视为不适定的；但是，所选数值确保其为亚临界状态。\n- 测试 3 (文丘里管，壅塞指示符): 相同的上游状态和 $A_{t} = 1.0\\times 10^{-3}\\ \\mathrm{m^{2}}$，但 $\\dot{m} = 1.0\\,\\mathrm{kg/s}$。计算一个整数指示符，如果请求是壅塞的，即如果 $\\dot{m}/A_{t} \\geq G_{\\max}$，则等于 $1$，否则等于 $0$。\n- 测试 4 (收敛喷管，较干入口的临界质量通量): 上游饱和状态 $p_{0} = 101325\\ \\mathrm{Pa}$，$x_{0} = 0.8$。计算 $G_{\\max}$，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$。\n\n物理和数值单位必须严格按照上述规定使用。所有压力必须以 $\\mathrm{Pa}$ 表示，所有质量通量以 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$ 表示，质量流量以 $\\mathrm{kg/s}$ 表示。\n\n最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，按上述测试的顺序排列结果，即 $[r_{1},r_{2},r_{3},r_{4}]$，其中 $r_{1}$ 和 $r_{4}$ 是浮点数质量通量（单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$），$r_{2}$ 是浮点数喉部压力（单位为 $\\mathrm{Pa}$），$r_{3}$ 是整数壅塞指示符（$0$ 或 $1$）。", "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于热力学和流体力学的既定原理，特别是用于两相流的均相平衡模型（HEM）。该问题是适定的，提供了构建计算解所必需的一套完整且一致的定义、方程和边界条件。它是客观的，没有歧义。因此，我们将着手推导和构建所需的计算程序。\n\n问题的核心是在等熵过程的假设下，计算饱和液汽混合物通过可变面积通道的质量通量 $G$。质量通量 $G$ 定义为 $G = \\rho v$，其中 $\\rho$ 是混合物密度，$v$ 是速度。整个流场由上游滞止状态和局部静压 $p$ 决定。\n\n首先，我们根据所提供的定义建立必要的热力学性质函数。由于假设流动保持在饱和线上，所有性质都是局部压力 $p$ 的函数。\n\n饱和温度 $T = T_{\\mathrm{sat}}(p)$ 通过对安托万方程求逆得到。给定：\n$$\n\\log_{10}\\!\\left(p_{\\mathrm{mmHg}}\\right) = A - \\dfrac{B}{C + T_{C}}\n$$\n其中 $p_{\\mathrm{mmHg}} = p / c_{conv}$，$c_{conv} = 133.322 \\text{ Pa/mmHg}$，$T_C$ 是摄氏温度。求解开尔文温度 $T = T_C + T_{\\mathrm{abs}}$，其中 $T_{\\mathrm{abs}} = 273.15 \\text{ K}$：\n$$\nT(p) = \\frac{B}{A - \\log_{10}(p/c_{conv})} - C + T_{\\mathrm{abs}}\n$$\n常数给定为 $A = 8.07131$，$B = 1730.63$，$C = 233.426$。\n\n接下来，我们需要导数 $\\frac{dp_{\\mathrm{sat}}}{dT}$ 以使用克拉佩龙方程。我们对表示为 $p(T)$ 的安托万方程进行微分：\n$$\np(T) = c_{conv} \\cdot 10^{\\left(A - \\frac{B}{C + T_C}\\right)} = c_{conv} \\cdot \\exp\\left( \\ln(10) \\left(A - \\frac{B}{C + T_C}\\right) \\right)\n$$\n对 $T_C$ 求导（注意 $dT = dT_C$）：\n$$\n\\frac{dp_{\\mathrm{sat}}}{dT} = p(T) \\cdot \\ln(10) \\cdot \\frac{d}{dT_C}\\left(-\\frac{B}{C + T_C}\\right) = p(T) \\cdot \\ln(10) \\cdot \\frac{B}{(C + T_C)^2}\n$$\n液体和蒸汽的比容分别为 $v_l = 1/\\rho_l$ 和 $v_v = 1/\\rho_v$。液体密度 $\\rho_l = 950 \\text{ kg/m}^3$ 为常数。蒸汽被视为理想气体，因此其密度为 $\\rho_v = p/(R_v T)$，其中 $R_v = 461.5 \\text{ J\\,kg^{-1}\\,K^{-1}}$。\n\n汽化潜热 $h_{lv}$ 由克拉佩龙方程计算：\n$$\nh_{lv}(p) = T(p) \\left(v_v(p) - v_l\\right) \\frac{dp_{\\mathrm{sat}}}{dT}(p)\n$$\n其中 $T = T_{\\mathrm{sat}}(p)$，所有量都在此状态下计算。\n\n饱和相的焓和熵参考于 $T_{\\mathrm{ref}} = 273.15 \\text{ K}$。\n对于液相，其中 $c_{pl} = 4200 \\text{ J\\,kg^{-1}\\,K^{-1}}$：\n$$\nh_l(T) = c_{pl} (T - T_{\\mathrm{ref}})\n$$\n$$\ns_l(T) = c_{pl} \\ln(T/T_{\\mathrm{ref}})\n$$\n对于汽相：\n$$\nh_v(T, p) = h_l(T) + h_{lv}(p)\n$$\n$$\ns_v(T, p) = s_l(T) + \\frac{h_{lv}(p)}{T}\n$$\n\n过程是等熵的，从上游状态 $(p_0, x_0)$ 开始。首先，我们表征这个初始状态。温度为 $T_0 = T_{\\mathrm{sat}}(p_0)$。比熵 $s_0$ 在整个流动过程中是恒定的：\n$$\ns_0 = (1-x_0)s_l(T_0) + x_0 s_v(T_0, p_0)\n$$\n滞止焓 $h_0$ 也是恒定的。假设入口速度可忽略不计 ($v_0 \\approx 0$)，滞止焓等于入口处的静焓：\n$$\nh_0 = h(p_0, x_0) = (1-x_0)h_l(T_0) + x_0 h_v(T_0, p_0)\n$$\n对于任何下游压力 $p  p_0$，混合物处于温度 $T=T_{\\mathrm{sat}}(p)$。局部干度 $x(p)$ 由等熵条件 $s(p, x) = s_0$ 决定：\n$$\n(1-x)s_l(T) + x s_v(T,p) = s_0 \\implies x(p) = \\frac{s_0 - s_l(T)}{s_v(T,p) - s_l(T)} = \\frac{T(s_0 - s_l(T))}{h_{lv}(p)}\n$$\n为保证数值稳健性，此 $x(p)$ 值必须被裁剪到物理范围 $[0, 1]$ 内。\n\n确定了局部干度 $x(p)$ 后，我们可以找到局部混合物性质。比焓为：\n$$\nh(p) = (1 - x(p))h_l(T) + x(p)h_v(T,p) = h_l(T) + x(p)h_{lv}(p)\n$$\n混合物比容为 $v(p) = (1-x(p))v_l + x(p)v_v(p)$，混合物密度为 $\\rho(p) = 1/v(p)$。\n\n根据稳流能量方程 $h_0 = h + v^2/2$，局部速度 $v(p)$ 为：\n$$\nv(p) = \\sqrt{2(h_0 - h(p))}\n$$\n项 $h_0 - h(p)$ 必须为非负数，这在计算上强制执行。\n\n最后，质量通量 $G(p)$ 由下式给出：\n$$\nG(p) = \\rho(p) v(p) = \\frac{\\sqrt{2(h_0 - h(p))}}{(1-x(p))v_l + x(p)v_v(p)}\n$$\n这个函数 $G(p)$ 概括了沿等熵路径的流动行为。\n\n现在处理测试用例的计算任务：\n\n1.  **临界质量通量 ($G_{\\max}$)**：当质量通量达到其最大值时，流动发生壅塞。这对应于 HEM 模型中的声速条件。要找到 $G_{\\max}$，我们必须在压力范围 $p \\in [p_{\\min}, p_0]$（其中 $p_{\\min}=1500 \\text{ Pa}$）上找到函数 $G(p)$ 的最大值。这是一个一维优化问题，可以通过最小化 $-G(p)$ 来解决。出现此最大值的压力是临界压力 $p_{\\text{crit}}$。\n\n2.  **亚临界喉部压力 ($p_t$)**：对于给定的质量流量 $\\dot{m}$ 和喉部面积 $A_t$，所需的质量通量为 $G_t = \\dot{m}/A_t$。如果 $G_t  G_{\\max}$，则流动是亚临界的。方程 $G(p) = G_t$ 在区间 $[p_{\\min}, p_0]$ 内将有两个解：一个亚声速解 $p > p_{\\text{crit}}$ 和一个超声速解 $p  p_{\\text{crit}}$。对于通过收敛-发散文丘里管的流动，喉部压力对应于较高压力（亚声速）的根。这是一个在区间 $(p_{\\text{crit}}, p_0)$ 内求解 $p_t$ 的求根问题。\n\n3.  **壅塞指示符**：对于给定的 $\\dot{m}$ 和 $A_t$，请求的质量通量为 $G_{\\text{req}} = \\dot{m}/A_t$。如果 $G_{\\text{req}} \\ge G_{\\max}$，则喷管壅塞，不可能通过此质量流量。流动将调整为仅通过 $G_{\\max}$。如果满足此条件，指示符为 $1$，否则为 $0$。\n\n实现将遵循这些步骤，使用 `scipy` 库中的数值优化和求根例程来求解 $G_{\\max}$ 和 $p_t$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar, root_scalar\n\ndef solve():\n    \"\"\"\n    Solves a series of problems related to two-phase flow in a nozzle\n    using the Homogeneous Equilibrium Model (HEM).\n    \"\"\"\n\n    # Physical and model constants\n    P_CONV = 133.322  # Pa/mmHg\n    R_V = 461.5  # J/(kg.K), specific gas constant for water vapor\n    RHO_L = 950.0  # kg/m^3, saturated liquid density (assumed constant)\n    C_PL = 4200.0  # J/(kg.K), specific heat of liquid water\n    T_REF = 273.15  # K, reference temperature for enthalpy/entropy\n    T_ABS = 273.15 # K, conversion from Celsius to Kelvin\n    P_MIN = 1500.0   # Pa, minimum pressure for calculation validity\n\n    # Antoine equation constants for water (p in mmHg, T in Celsius)\n    ANT_A = 8.07131\n    ANT_B = 1730.63\n    ANT_C = 233.426\n\n    class TwoPhaseFlowSolver:\n        \"\"\"\n        Implements the Homogeneous Equilibrium Model for isentropic nozzle flow.\n        \"\"\"\n        def __init__(self, p0, x0):\n            \"\"\"\n            Initializes the solver with upstream stagnation conditions.\n            Args:\n                p0 (float): Upstream pressure in Pa.\n                x0 (float): Upstream quality (vapor mass fraction).\n            \"\"\"\n            self.p0 = p0\n            self.x0 = x0\n            \n            # Pre-calculate initial state properties\n            self.T0 = self._get_T_sat(self.p0)\n            \n            (self.h_l0, self.s_l0, self.h_v0, self.s_v0,\n             self.rho_v0, self.v_v0, self.h_lv0) = self._get_phase_props(self.p0, self.T0)\n\n            # Stagnation entropy (constant for the isentropic process)\n            self.s0 = (1 - self.x0) * self.s_l0 + self.x0 * self.s_v0\n            \n            # Stagnation enthalpy (constant, assuming negligible inlet velocity)\n            self.h0 = (1 - self.x0) * self.h_l0 + self.x0 * self.h_v0\n\n        def _get_T_sat(self, p):\n            \"\"\"Calculates saturation temperature T (K) from pressure p (Pa).\"\"\"\n            p_mmhg = p / P_CONV\n            if p_mmhg = 0: return np.nan\n            T_C = ANT_B / (ANT_A - np.log10(p_mmhg)) - ANT_C\n            return T_C + T_ABS\n\n        def _get_dp_sat_dT(self, p, T):\n            \"\"\"Calculates dp_sat/dT from the Antoine equation.\"\"\"\n            T_C = T - T_ABS\n            return p * np.log(10) * ANT_B / ((ANT_C + T_C)**2)\n        \n        def _get_phase_props(self, p, T):\n            \"\"\"Computes all phase properties at a given saturation state (p, T).\"\"\"\n            # Liquid properties\n            h_l = C_PL * (T - T_REF)\n            s_l = C_PL * np.log(T / T_REF)\n            \n            # Vapor properties\n            rho_v = p / (R_V * T)\n            v_v = 1.0 / rho_v\n            v_l = 1.0 / RHO_L\n            \n            # Clapeyron equation for latent heat\n            dp_dT = self._get_dp_sat_dT(p, T)\n            h_lv = T * (v_v - v_l) * dp_dT\n            \n            h_v = h_l + h_lv\n            s_v = s_l + h_lv / T\n            \n            return h_l, s_l, h_v, s_v, rho_v, v_v, h_lv\n\n        def get_state_at_p(self, p):\n            \"\"\"\n            Calculates all mixture properties at a given local pressure p.\n            \"\"\"\n            T = self._get_T_sat(p)\n            if np.isnan(T):\n                return (np.nan,) * 4\n\n            h_l, s_l, h_v, s_v, rho_v, v_v, h_lv = self._get_phase_props(p, T)\n\n            # Isentropic quality\n            s_diff = s_v - s_l\n            if abs(s_diff)  1e-9: # Avoid division by zero\n                x = self.x0\n            else:\n                x = (self.s0 - s_l) / s_diff\n            x = np.clip(x, 0.0, 1.0)\n            \n            # Mixture properties\n            h = (1 - x) * h_l + x * h_v\n            v_mix = (1 - x) * (1.0 / RHO_L) + x * v_v\n            rho = 1.0 / v_mix\n            \n            return x, h, rho, T\n\n        def get_mass_flux(self, p):\n            \"\"\"Calculates the mass flux G(p) for a given local pressure.\"\"\"\n            if p > self.p0 or p  P_MIN:\n                # Mass flux is zero outside the physical pressure range\n                return 0.0\n\n            x, h, rho, T = self.get_state_at_p(p)\n            \n            if np.isnan(h):\n                return 0.0\n\n            # Energy conservation to find velocity\n            delta_h = self.h0 - h\n            v = np.sqrt(2 * max(0, delta_h))\n            \n            G = rho * v\n            return G\n\n        def find_G_max(self):\n            \"\"\"\n            Finds the maximum (critical) mass flux by minimizing -G(p).\n            \"\"\"\n            # We minimize the negative of G to find its maximum\n            res = minimize_scalar(lambda p: -self.get_mass_flux(p),\n                                  bounds=(P_MIN, self.p0),\n                                  method='bounded')\n            \n            g_max = -res.fun\n            p_crit = res.x\n            return g_max, p_crit\n\n        def find_p_throat(self, G_target, p_crit):\n            \"\"\"\n            Finds the throat pressure for a subcritical mass flux.\n            This corresponds to the higher-pressure root of G(p) = G_target.\n            \"\"\"\n            def objective(p):\n                return self.get_mass_flux(p) - G_target\n\n            # Search in the subsonic region (p_crit, p0)\n            res = root_scalar(objective, bracket=(p_crit, self.p0))\n            return res.root\n\n    test_cases = [\n        {'type': 'G_max', 'p0': 101325.0, 'x0': 0.2},\n        {'type': 'p_throat', 'p0': 101325.0, 'x0': 0.2, 'At': 1.0e-3, 'mdot': 0.03},\n        {'type': 'choke_indicator', 'p0': 101325.0, 'x0': 0.2, 'At': 1.0e-3, 'mdot': 1.0},\n        {'type': 'G_max', 'p0': 101325.0, 'x0': 0.8}\n    ]\n\n    results = []\n    solver_cache = {} # Cache solvers for the same inlet conditions\n\n    for case in test_cases:\n        p0, x0 = case['p0'], case['x0']\n        solver_key = (p0, x0)\n\n        if solver_key not in solver_cache:\n            solver_cache[solver_key] = TwoPhaseFlowSolver(p0, x0)\n        solver = solver_cache[solver_key]\n        \n        if case['type'] == 'G_max':\n            g_max, _ = solver.find_G_max()\n            results.append(g_max)\n\n        elif case['type'] == 'p_throat':\n            G_target = case['mdot'] / case['At']\n            g_max, p_crit = solver.find_G_max()\n            if G_target  g_max:\n                p_t = solver.find_p_throat(G_target, p_crit)\n                results.append(p_t)\n            else: # Should not happen based on problem description\n                results.append(np.nan) \n\n        elif case['type'] == 'choke_indicator':\n            G_req = case['mdot'] / case['At']\n            g_max, _ = solver.find_G_max()\n            indicator = 1 if G_req >= g_max else 0\n            results.append(indicator)\n    \n    # Format results as specified\n    formatted_results = [\n        f\"{results[0]:.10f}\",\n        f\"{results[1]:.10f}\",\n        f\"{int(results[2])}\",\n        f\"{results[3]:.10f}\"\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2494999"}]}