{"hands_on_practices": [{"introduction": "本练习旨在巩固在恒压过程中，使用随温度变化的变比热容计算热量传递的基本技能。其核心是应用热力学第一定律，并将焓变与比热容的积分关系 $Q = \\Delta H = m\\int c_p(T)dT$ 直接联系起来。通过将精确积分结果与使用平均比热容的近似结果进行比较，这项实践有助于培养对工程近似方法准确性的评估能力 [@problem_id:2532138]。", "problem": "一个刚性导向的无摩擦活塞中封闭着固定质量且充分搅拌的干燥空气替代物，该替代物可被建模为成分固定的理想气体。一个校准过的砝码维持恒定的外部压力，使得当向气体提供热量时，活塞执行一个准静态恒压过程。气体从初始温度 $T_1 = 300\\,\\mathrm{K}$ 加热到最终温度 $T_2 = 1200\\,\\mathrm{K}$。气体质量为 $m = 2.50\\,\\mathrm{kg}$，其动能和势能的变化可忽略不计。唯一的做功方式是边界功（压力-体积功）。压力维持在 $p = 1.00\\,\\mathrm{bar}$。\n\n在温度区间 $[T_1,T_2]$ 内，定压比热容（比热容量）记为 $c_p(T)$，由以下关联式表示\n$$\nc_p(T) = 0.95 + 1.50 \\times 10^{-4}\\,T - 2.00 \\times 10^{-8}\\,T^2 \\quad \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1},\n$$\n其中 $T$ 的单位是 $\\mathrm{K}$。\n\n从仅有边界功的闭口系统的热力学第一定律以及比焓 $h$ 和定压比热容 $c_p(T)$ 的定义出发，完成以下任务：\n\n1. 在此恒压过程中，推导传递给系统的净热量与随温度变化的比热容 $c_p(T)$ 之间的恰当关系式。\n2. 利用该关系式，确定所需的确切热输入量。然后，通过用一个恒定的端点平均值 $\\bar{c}_p = \\big(c_p(T_1) + c_p(T_2)\\big)/2$ 替代 $c_p(T)$ 来构建一个工程近似，并计算相应的近似热输入量。\n3. 将此近似的分数误差定义为\n$$\n\\varepsilon \\equiv \\frac{Q_{\\mathrm{avg}} - Q_{\\mathrm{exact}}}{Q_{\\mathrm{exact}}},\n$$\n其中 $Q_{\\mathrm{avg}}$ 是基于端点平均比热容的近似热输入量，而 $Q_{\\mathrm{exact}}$ 是基于随温度变化的比热容的确切热输入量。\n\n仅报告 $\\varepsilon$ 的值作为最终答案，四舍五入到四位有效数字，并以纯小数形式表示（不要使用百分号）。如果在中间步骤中需要表示能量，请使用单位 $\\mathrm{kJ}$。", "solution": "首先对问题进行验证。\n**已知条件：**\n- 系统：固定质量的理想气体。\n- 过程：准静态，恒压。\n- 系统类型：闭口。\n- 初始温度：$T_1 = 300\\,\\mathrm{K}$\n- 最终温度：$T_2 = 1200\\,\\mathrm{K}$\n- 质量：$m = 2.50\\,\\mathrm{kg}$\n- 压力：$p = 1.00\\,\\mathrm{bar}$（恒定）\n- 功：仅有边界（压力-体积）功。\n- 能量：动能和势能变化可忽略不计。\n- 比热容关联式：$c_p(T) = 0.95 + 1.50 \\times 10^{-4}\\,T - 2.00 \\times 10^{-8}\\,T^2$，单位为 $\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，其中 $T$ 的单位为 $\\mathrm{K}$。\n- 近似定义：$\\bar{c}_p = \\frac{c_p(T_1) + c_p(T_2)}{2}$。\n- 分数误差定义：$\\varepsilon \\equiv \\frac{Q_{\\mathrm{avg}} - Q_{\\mathrm{exact}}}{Q_{\\mathrm{exact}}}$。\n\n**验证：**\n该问题具有科学依据，提法明确，且客观。这是一个标准的热力学问题，涉及闭口系统的第一定律和随温度变化的比热容。所有必要数据均已提供，且约束条件一致。没有违反任何科学原理。该问题被判定为**有效**。\n\n**求解推导：**\n\n**1. 热传递关系式的推导**\n\n对于一个从状态1到状态2经历一个过程的闭口系统，其热力学第一定律为：\n$$ \\Delta E = Q - W $$\n其中 $\\Delta E$ 是系统总能量的变化量，$Q$ 是传递给系统的净热量，$W$ 是系统对外做的净功。总能量 $E$ 是内能 $U$、动能 $KE$ 和势能 $PE$ 的总和。问题陈述动能和势能的变化可忽略不计，因此 $\\Delta E = \\Delta U$。唯一的做功方式是边界功，因此对于一个准静态过程，功的微分为 $dW = p\\,dV$。微分形式的热力学第一定律是：\n$$ dQ = dU + p\\,dV $$\n比焓的定义是 $h = u + pv$，其中 $u$ 是比内能，$v$ 是比体积。总焓为 $H = U + pV$。对 $H$ 取微分得到：\n$$ dH = dU + d(pV) = dU + p\\,dV + V\\,dp $$\n对于恒压过程，$dp = 0$，所以上述表达式简化为：\n$$ dH = dU + p\\,dV \\quad (\\text{对于 } p=\\text{恒量}) $$\n将此代入微分形式的第一定律，我们发现对于恒压过程：\n$$ dQ = dH $$\n在从状态1到状态2的过程中，总热传递量 $Q$ 是 $dQ$ 的积分，它等于总焓变：\n$$ Q = \\int_1^2 dQ = \\int_1^2 dH = H_2 - H_1 = \\Delta H $$\n由于 $H = mh$，热传递量为 $Q = m(h_2 - h_1) = m \\Delta h$。\n\n定压比热容 $c_p$ 定义为 $c_p = \\left(\\frac{\\partial h}{\\partial T}\\right)_p$。对于理想气体，焓仅是温度的函数，$h=h(T)$，因此偏导数变为常导数：$c_p(T) = \\frac{dh}{dT}$。\n根据这个定义，比焓的微分变化量为 $dh = c_p(T)\\,dT$。\n为了求得比焓的总变化量，我们从初始温度 $T_1$ 积分到最终温度 $T_2$：\n$$ \\Delta h = h_2 - h_1 = \\int_{T_1}^{T_2} c_p(T)\\,dT $$\n将此代入总热传递量的表达式，我们得到确切热输入量 $Q_{\\mathrm{exact}}$ 所需的关系式：\n$$ Q_{\\mathrm{exact}} = m \\int_{T_1}^{T_2} c_p(T)\\,dT $$\n\n**2. 确切热输入量和近似热输入量的计算**\n\n给定的比热容关联式是温度的多项式：\n$$ c_p(T) = A + BT + CT^2 $$\n其中 $A = 0.95 \\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$B = 1.50 \\times 10^{-4} \\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$，以及 $C = -2.00 \\times 10^{-8} \\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$。\n\n为求 $Q_{\\mathrm{exact}}$，我们将此表达式从 $T_1 = 300\\,\\mathrm{K}$ 积分到 $T_2 = 1200\\,\\mathrm{K}$：\n$$ Q_{\\mathrm{exact}} = m \\int_{T_1}^{T_2} (A + BT + CT^2) \\,dT = m \\left[ AT + \\frac{B}{2}T^2 + \\frac{C}{3}T^3 \\right]_{T_1}^{T_2} $$\n$$ Q_{\\mathrm{exact}} = m \\left( A(T_2 - T_1) + \\frac{B}{2}(T_2^2 - T_1^2) + \\frac{C}{3}(T_2^3 - T_1^3) \\right) $$\n代入数值：\n$T_2 - T_1 = 1200 - 300 = 900\\,\\mathrm{K}$\n$T_2^2 - T_1^2 = (1200)^2 - (300)^2 = 1.35 \\times 10^6\\,\\mathrm{K}^2$\n$T_2^3 - T_1^3 = (1200)^3 - (300)^3 = 1.701 \\times 10^9\\,\\mathrm{K}^3$\n$m = 2.50\\,\\mathrm{kg}$\n$$ Q_{\\mathrm{exact}} = 2.50 \\left( (0.95)(900) + \\frac{1.50 \\times 10^{-4}}{2}(1.35 \\times 10^6) + \\frac{-2.00 \\times 10^{-8}}{3}(1.701 \\times 10^9) \\right) $$\n$$ Q_{\\mathrm{exact}} = 2.50 \\left( 855 + (7.5 \\times 10^{-5})(1.35 \\times 10^6) - \\frac{2.00}{3}(1.701 \\times 10) \\right) $$\n$$ Q_{\\mathrm{exact}} = 2.50 \\left( 855 + 101.25 - 11.34 \\right) = 2.50(944.91) = 2362.275\\,\\mathrm{kJ} $$\n\n接下来，我们使用端点平均比热容 $\\bar{c}_p$ 计算近似热输入量 $Q_{\\mathrm{avg}}$。\n$$ Q_{\\mathrm{avg}} = m \\bar{c}_p (T_2-T_1), \\quad \\text{其中 } \\bar{c}_p = \\frac{c_p(T_1) + c_p(T_2)}{2} $$\n首先，计算端点处的 $c_p(T)$：\n$$ c_p(T_1) = c_p(300) = 0.95 + (1.50 \\times 10^{-4})(300) - (2.00 \\times 10^{-8})(300)^2 $$\n$$ c_p(300) = 0.95 + 0.045 - 0.0018 = 0.9932\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n$$ c_p(T_2) = c_p(1200) = 0.95 + (1.50 \\times 10^{-4})(1200) - (2.00 \\times 10^{-8})(1200)^2 $$\n$$ c_p(1200) = 0.95 + 0.18 - 0.0288 = 1.1012\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n现在，计算平均比热容：\n$$ \\bar{c}_p = \\frac{0.9932 + 1.1012}{2} = \\frac{2.0944}{2} = 1.0472\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n最后，计算 $Q_{\\mathrm{avg}}$：\n$$ Q_{\\mathrm{avg}} = (2.50\\,\\mathrm{kg}) (1.0472\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}) (1200 - 300\\,\\mathrm{K}) $$\n$$ Q_{\\mathrm{avg}} = 2.50 \\times 1.0472 \\times 900 = 2356.2\\,\\mathrm{kJ} $$\n\n**3. 分数误差的计算**\n\n分数误差 $\\varepsilon$ 定义为：\n$$ \\varepsilon = \\frac{Q_{\\mathrm{avg}} - Q_{\\mathrm{exact}}}{Q_{\\mathrm{exact}}} $$\n代入计算出的 $Q_{\\mathrm{avg}}$ 和 $Q_{\\mathrm{exact}}$ 值：\n$$ \\varepsilon = \\frac{2356.2 - 2362.275}{2362.275} = \\frac{-6.075}{2362.275} $$\n$$ \\varepsilon \\approx -0.00257163 $$\n题目要求将 $\\varepsilon$ 的值四舍五入到四位有效数字。\n$$ \\varepsilon \\approx -0.002572 $$", "answer": "$$\\boxed{-0.002572}$$", "id": "2532138"}, {"introduction": "该练习模拟了一个实际的工程情景——气体加热器，旨在揭示在宽温度范围内准确模拟热力学性质的重要性。您将比较两种气体模型：量热完全气体（定比热容 $c_{p}$）和更真实的量热不完全气体（变比热容 $c_{p}(T)$）。通过量化定比热容假设所引入的计算误差，您将更深刻地理解在何种情况下简化模型是可接受的，以及何时它会导致显著的预测偏差 [@problem_id:2532089]。", "problem": "一个稳态流、恒压的气体加热器将一股干空气流从入口温度 $T_{1} = 300\\,\\mathrm{K}$ 加热到出口温度 $T_{2} = 2000\\,\\mathrm{K}$。忽略动能和势能的变化，并将空气视为理想气体。现有两种关于所需传热速率的预测值需要进行比较：\n\n1. 量热完全气体模型，该模型假设定压比热容为一个常数，其值等于在 $T_{1}$ 时的值，即 $c_{p,0} = 1006\\,\\mathrm{J/(kg\\cdot K)}$。\n2. 热学完全气体模型，该模型使用一个随温度变化的 $c_{p}(T)$，该函数通过对以下干空气的列表数据进行线性插值构建（$c_{p}$ 的单位是 $\\mathrm{J/(kg\\cdot K)}$，$T$ 的单位是 $\\mathrm{K}$）：\n$$(T,c_{p}) \\in \\{(300,1006),\\,(600,1040),\\,(900,1100),\\,(1200,1160),\\,(1500,1220),\\,(1800,1270),\\,(2000,1310)\\}.$$\n假设 $c_{p}(T)$ 在每对相邻的列表温度之间呈线性变化，并且仅使用所提供的数据。\n\n从第一性原理出发，使用稳态流热力学第一定律和理想气体焓的定义，推导出两种模型下传热速率预测值的表达式，然后计算量热完全气体模型的预测值相对于热学完全气体模型基准的有符号相对误差。将有符号相对误差报告为\n$$\\varepsilon = \\frac{\\dot{Q}_{\\text{caloric}} - \\dot{Q}_{\\text{thermal}}}{\\dot{Q}_{\\text{thermal}}},$$\n以无量纲小数形式表示。将最终答案四舍五入到四位有效数字。不要使用百分号。如果引入质量流量 $\\dot{m}$，你最终报告的 $\\varepsilon$ 必须不依赖于 $\\dot{m}$。", "solution": "首先对问题进行验证，以确保其在科学上是合理的且是良定的。该问题基于应用于开放系统的热力学第一定律，利用了理想气体比热容的标准模型（量热完全气体和热学完全气体）。所提供的空气比热容数据在物理上是现实的，温度范围也与燃气轮机等工程应用相关。该问题是自洽的，提供了计算出唯一且有意义结果所需的所有数据和条件。问题中没有矛盾、歧义或违反物理原理之处。该问题被认为是有效的，可以制定解决方案。\n\n分析从应用于控制体积的稳态流热力学第一定律开始。能量平衡方程如下：\n$$ \\dot{Q} - \\dot{W}_{s} = \\dot{m} \\left( (h_{2} - h_{1}) + \\frac{V_{2}^{2} - V_{1}^{2}}{2} + g(z_{2} - z_{1}) \\right) $$\n其中 $\\dot{Q}$ 是进入系统的传热速率，$\\dot{W}_{s}$ 是系统所做的轴功速率，$\\dot{m}$ 是质量流量，$h$ 是比焓，$V$ 是速度，$z$ 是高程。\n\n根据问题陈述，该系统是一个气体加热器，因此没有轴功，即 $\\dot{W}_{s} = 0$。动能和势能的变化被忽略，因此 $\\frac{V_{2}^{2} - V_{1}^{2}}{2} \\approx 0$ 且 $g(z_{2} - z_{1}) \\approx 0$。第一定律简化为：\n$$ \\dot{Q} = \\dot{m} (h_{2} - h_{1}) = \\dot{m} \\Delta h $$\n单位质量传热量 $q$ 是指单位质量的传热量：\n$$ q = \\frac{\\dot{Q}}{\\dot{m}} = h_{2} - h_{1} $$\n对于理想气体，比焓的变化仅是温度的函数。比焓的微分变化是 $dh = c_{p}(T) dT$，其中 $c_{p}(T)$ 是定压比热容。从入口温度 $T_{1}$ 到出口温度 $T_{2}$ 的比焓总变化通过积分求得：\n$$ \\Delta h = \\int_{T_{1}}^{T_{2}} c_{p}(T) dT $$\n因此，单位质量传热量为 $q = \\int_{T_{1}}^{T_{2}} c_{p}(T) dT$。我们将针对两种提出的模型计算此积分。\n\n模型1：量热完全气体\n在此模型中，假定比热容为一常数，其值等于初始温度 $T_{1} = 300\\,\\mathrm{K}$ 时的值。该值为 $c_{p,0} = 1006\\,\\mathrm{J/(kg \\cdot K)}$。单位质量传热量的积分变为：\n$$ q_{\\text{caloric}} = \\int_{T_{1}}^{T_{2}} c_{p,0} dT = c_{p,0} \\int_{T_{1}}^{T_{2}} dT = c_{p,0} (T_{2} - T_{1}) $$\n代入给定值 $T_{1} = 300\\,\\mathrm{K}$ 和 $T_{2} = 2000\\,\\mathrm{K}$：\n$$ q_{\\text{caloric}} = (1006\\,\\mathrm{J/(kg \\cdot K)}) \\times (2000\\,\\mathrm{K} - 300\\,\\mathrm{K}) = 1006 \\times 1700\\,\\mathrm{J/kg} = 1710200\\,\\mathrm{J/kg} $$\n\n模型2：热学完全气体\n在此模型中，$c_{p}(T)$ 是一个随温度变化的分段线性函数，由所提供的数据点定义。为了求得单位质量传热量 $q_{\\text{thermal}}$，我们必须将此分段函数从 $T_{1} = 300\\,\\mathrm{K}$ 积分到 $T_{2} = 2000\\,\\mathrm{K}$。该积分是每个线性分段上积分的总和。对于温度 $T_{i}$ 和 $T_{i+1}$ 之间的任意分段，线性函数 $c_p(T)$ 的积分是梯形的面积：\n$$ \\int_{T_{i}}^{T_{i+1}} c_{p}(T) dT = \\frac{c_{p}(T_{i}) + c_{p}(T_{i+1})}{2} (T_{i+1} - T_{i}) $$\n总的单位质量传热量是从 $T_{1}$ 到 $T_{2}$ 所有分段上这些面积的总和。数据点为 $(300, 1006)$, $(600, 1040)$, $(900, 1100)$, $(1200, 1160)$, $(1500, 1220)$, $(1800, 1270)$ 和 $(2000, 1310)$。\n计算过程为对六个区间的求和：\n\\begin{align*} q_{\\text{thermal}} =  \\frac{1006 + 1040}{2} (600 - 300) + \\frac{1040 + 1100}{2} (900 - 600) \\\\  + \\frac{1100 + 1160}{2} (1200 - 900) + \\frac{1160 + 1220}{2} (1500 - 1200) \\\\  + \\frac{1220 + 1270}{2} (1800 - 1500) + \\frac{1270 + 1310}{2} (2000 - 1800) \\end{align*}\n$$ q_{\\text{thermal}} = (1023)(300) + (1070)(300) + (1130)(300) + (1190)(300) + (1245)(300) + (1290)(200) $$\n$$ q_{\\text{thermal}} = 306900 + 321000 + 339000 + 357000 + 373500 + 258000 $$\n$$ q_{\\text{thermal}} = 1955400\\,\\mathrm{J/kg} $$\n\n有符号相对误差\n量热完全气体模型相对于热学完全气体模型的有符号相对误差 $\\varepsilon$ 定义为：\n$$ \\varepsilon = \\frac{\\dot{Q}_{\\text{caloric}} - \\dot{Q}_{\\text{thermal}}}{\\dot{Q}_{\\text{thermal}}} $$\n由于 $\\dot{Q} = \\dot{m} q$，质量流量 $\\dot{m}$ 从表达式中消去：\n$$ \\varepsilon = \\frac{\\dot{m} q_{\\text{caloric}} - \\dot{m} q_{\\text{thermal}}}{\\dot{m} q_{\\text{thermal}}} = \\frac{q_{\\text{caloric}} - q_{\\text{thermal}}}{q_{\\text{thermal}}} $$\n代入 $q_{\\text{caloric}}$ 和 $q_{\\text{thermal}}$ 的计算值：\n$$ \\varepsilon = \\frac{1710200 - 1955400}{1955400} = \\frac{-245200}{1955400} $$\n$$ \\varepsilon \\approx -0.125396338... $$\n将结果四舍五入到四位有效数字，得到：\n$$ \\varepsilon = -0.1254 $$\n负号表示，恒定比热容模型严重低估了达到指定温升所需的传热量，因为它忽略了空气在较高温度下比热容的增加。", "answer": "$$\\boxed{-0.1254}$$", "id": "2532089"}, {"introduction": "本次高级实践从正向计算（由 $T$ 计算 $h$）转向了在计算科学中更为常见的逆向问题：根据已知的焓值 $h$ 求解温度 $T$。在许多能量守恒的仿真程序（如计算流体动力学）中，这是一个至关重要的计算步骤。您将通过实现一个稳健的牛顿迭代算法，深入探索热力学、数值方法和计算科学三者交叉融合的实践应用 [@problem_id:2532137]。", "problem": "要求您在计算流体动力学背景下，实现并分析一种针对量热非完全气体的、与温度相关的比焓的数值反演。该反演是从比焓到温度的转换，其中定压比热是温度的函数。算法核心必须是Newton迭代法，并包含明确的停止准则和全局化策略，以保证在指定的温度区间内具有鲁棒的行为。\n\n基本原理如下：\n- 对于一个被建模为具有温度相关定压比热的完全气体的单相物质，比焓的定义满足微分关系 $dh = c_p(T)\\, dT$。因此，在参考状态温度为 $T_{\\mathrm{ref}}$ 且参考焓值设为零的情况下，焓作为温度的函数由下式给出\n$$\nh(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\theta)\\, d\\theta.\n$$\n- 假设 $c_p(T)$ 的多项式模型为：\n$$\nc_p(T) = a + b\\,T + c\\,T^2,\n$$\n其中 $a$、$b$ 和 $c$ 是国际单位制 (SI) 中的常数，$c_p$ 的单位是 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$T$ 的单位是 $\\mathrm{K}$。\n\n任务要求：\n1. 仅使用上述基本定义，通过构建一个标量求根问题 $r(T)=0$，推导出一个Newton迭代法，用于在给定目标焓 $h^\\star$ 时求解温度 $T$。您的推导必须从第一性原理出发，不得假定任何快捷公式。说明您将实现的停止准则以及确保在原始Newton步会超出指定温度区间时算法鲁棒性的全局化策略。\n2. 针对以下指定的模型数据实现该迭代。您的实现必须先验地检查根是否被界定，并且必须采用一种安全保障措施，该措施根据需要将Newton步与回溯和二分法相结合。\n3. 数学上分析该模型下Newton迭代收敛的条件，并讨论两种初始猜测策略的效果。然后，使用提供的测试套件对这些策略进行数值评估。\n\n模型数据和单位：\n- 使用 $T$ 单位为 $\\mathrm{K}$，$h$ 单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}$，$c_p$ 单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。\n- 设 $T_{\\mathrm{ref}} = 298.15$。\n- 设 $a = 850.0$，$b = 0.1$，$c = 1.0\\times 10^{-4}$。\n- 通过此选择，在与燃烧和高温气体动力学相关的广泛温度范围内，$c_p(T)  0$，且 $h(T)$ 严格单调递增，这确保了在任何 $c_p(T)$ 保持为正的区间上存在唯一的反函数。\n- 在计算 $h(T)$ 时，使用由基本原理推导出的闭式积分形式。\n\n数值算法输入和规则：\n- 温度区间：$T_{\\min} = 200.0$ 和 $T_{\\max} = 2500.0$。\n- 收敛容差：\n  - 温度增量容差：$\\varepsilon_T = 10^{-10}$，单位为 $\\mathrm{K}$。\n  - 残差容差：$\\varepsilon_h = 10^{-6}$，单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}$。\n- 最大迭代次数：$N_{\\max} = 50$。\n- 全局化：\n  - 如果原始Newton步将超出 $[T_{\\min},T_{\\max}]$，则执行回溯线搜索（步长阻尼），并在必要时回退到使用当前包含根的区间进行二分法步。\n  - 使用已接受迭代点上残差的符号来更新界定区间，以维持一个有效的包围。\n\n待比较的初始猜测策略：\n- 策略 $\\mathrm{S1}$（参考点线性化）：$T_0^{\\mathrm{S1}} = T_{\\mathrm{ref}} + h^\\star / c_p(T_{\\mathrm{ref}})$。\n- 策略 $\\mathrm{S2}$（允许区间的中心点）：$T_0^{\\mathrm{S2}} = \\tfrac{1}{2}(T_{\\min}+T_{\\max})$。\n- 在所有情况下，将初始猜测值限制在区间内。\n\n测试套件：\n- 对于每个测试，程序必须通过精确计算积分 $h(T_{\\mathrm{true}})$ 从一个已知的“真实”温度 $T_{\\mathrm{true}}$ 构建目标焓 $h^\\star$，然后尝试通过反演算法恢复该温度。使用以下真实温度集：\n  - 案例 $1$：$T_{\\mathrm{true}} = 900.0$。\n  - 案例 $2$：$T_{\\mathrm{true}} = 300.0$。\n  - 案例 $3$：$T_{\\mathrm{true}} = 2200.0$。\n  - 案例 $4$：$T_{\\mathrm{true}} = 250.0$。\n  - 案例 $5$：$T_{\\mathrm{true}} = 1500.0$。\n\n程序输出要求：\n- 对于每个案例，运行初始猜测策略 $\\mathrm{S1}$ 和 $\\mathrm{S2}$，并为每种策略返回计算出的温度（单位 K）、所用的迭代次数以及一个布尔标志，该标志指示是否在规定容差下收敛。\n- 温度以 $\\mathrm{K}$ 为单位表示，并四舍五入到六位小数。迭代次数必须是整数。收敛标志必须是布尔值。\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的Python风格的列表的列表，每个子列表对应一个测试案例。每个子列表必须是\n  $[T^{\\mathrm{S1}}, n^{\\mathrm{S1}}, \\mathrm{conv}^{\\mathrm{S1}}, T^{\\mathrm{S2}}, n^{\\mathrm{S2}}, \\mathrm{conv}^{\\mathrm{S2}}]$，\n  其中 $T^{\\mathrm{S1}}$ 和 $T^{\\mathrm{S2}}$ 是以 K 为单位且四舍五入到六位小数的浮点数，$n^{\\mathrm{S1}}$ 和 $n^{\\mathrm{S2}}$ 是整数，而 $\\mathrm{conv}^{\\mathrm{S1}}$、$\\mathrm{conv}^{\\mathrm{S2}}$ 是布尔值。\n- 例如，最终输出格式必须类似于\n  $[[T_1^{\\mathrm{S1}}, n_1^{\\mathrm{S1}}, \\mathrm{conv}_1^{\\mathrm{S1}}, T_1^{\\mathrm{S2}}, n_1^{\\mathrm{S2}}, \\mathrm{conv}_1^{\\mathrm{S2}}],\\dots]$\n  ，显示在单行上，没有附加文本。", "solution": "问题陈述经评估有效。它在科学上基于热力学原理，问题定义良好，所提供的模型保证了唯一解的存在，并且其表述是客观的。所有数据和算法要求都是完整且一致的。因此，我们可以着手求解。\n\n任务是找到在给定比焓 $h^\\star$ 时，量热非完全气体所对应的温度 $T$。比焓 $h$ 与温度 $T$ 之间的关系由定压比热 $c_p(T)$ 定义。\n\n首先，我们建立 $h$ 和 $T$ 之间的显式函数关系。定义为 $dh = c_p(T) dT$。将其从参考温度 $T_{\\mathrm{ref}}$ 积分到任意温度 $T$，并将参考焓值设为零，可得：\n$$\nh(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\theta)\\, d\\theta\n$$\n比热由一个多项式模型给出：\n$$\nc_p(T) = a + bT + cT^2\n$$\n将此代入 $h(T)$ 的积分中，我们执行积分：\n$$\nh(T) = \\int_{T_{\\mathrm{ref}}}^{T} (a + b\\theta + c\\theta^2)\\, d\\theta = \\left[ a\\theta + \\frac{b}{2}\\theta^2 + \\frac{c}{3}\\theta^3 \\right]_{T_{\\mathrm{ref}}}^{T}\n$$\n这得到了比焓的闭式表达式：\n$$\nh(T) = \\left( aT + \\frac{b}{2}T^2 + \\frac{c}{3}T^3 \\right) - \\left( aT_{\\mathrm{ref}} + \\frac{b}{2}T_{\\mathrm{ref}}^2 + \\frac{c}{3}T_{\\mathrm{ref}}^3 \\right)\n$$\n为方便起见，我们可以定义一个原函数 $H(T) = aT + \\frac{b}{2}T^2 + \\frac{c}{3}T^3$，从而 $h(T) = H(T) - H(T_{\\mathrm{ref}})$。\n\n将此关系反演以求给定 $h^\\star$ 对应的 $T$ 的问题，等价于找到残差函数 $r(T)$ 的根：\n$$\nr(T) = h(T) - h^\\star = 0\n$$\n为使用Newton方法求解此问题，我们需要残差函数的导数 $r'(T)$。根据微积分基本定理，积分对其上限的导数等于在该上限处被积函数的值。\n$$\nr'(T) = \\frac{d}{dT} \\left( \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\theta)\\, d\\theta - h^\\star \\right) = c_p(T)\n$$\n因此，$r'(T) = a + bT + cT^2$。用于求根 $T$ 的Newton迭代由以下递归公式给出：\n$$\nT_{k+1} = T_k - \\frac{r(T_k)}{r'(T_k)} = T_k - \\frac{h(T_k) - h^\\star}{c_p(T_k)}\n$$\n其中 $T_k$ 是第 $k$ 次迭代时的温度。\n\n数值算法必须是鲁棒的。需要一个全局化策略来确保即使初始猜测远离根时也能收敛。指定的温度区间是 $[T_{\\min}, T_{\\max}] = [200.0, 2500.0]$。将实现一个混合的Newton-二分法算法。\n首先，我们必须通过检查 $r(T_{\\min})$ 和 $r(T_{\\max})$ 是否异号来验证区间内是否存在根。给定常数 $a = 850.0$、$b = 0.1$ 和 $c = 1.0 \\times 10^{-4}$，导数 $c_p(T)$ 是一个开口向上的抛物线，其最小值在 $T = -b/(2c) = -500.0$ K。对于 $T \\ge 200.0$ K，$c_p(T) > 0$，因此 $h(T)$ 严格单调递增。这保证了如果 $h^\\star$ 介于 $h(T_L)$ 和 $h(T_R)$ 之间，在任何区间 $[T_L, T_R]$ 内都存在唯一的根。\n\n算法流程如下：\n1.  初始化迭代计数 $k = 0$，温度区间 $[T_L, T_R] = [T_{\\min}, T_{\\max}]$，以及根据所选策略（S1或S2）确定的初始猜测值 $T_0$，并将其限制在区间内。\n2.  在每次迭代 $k$ 中，从当前猜测值 $T_k$ 开始：\n    a. 计算残差 $r(T_k)$ 及其导数 $c_p(T_k)$。\n    b. 计算Newton步长 $\\Delta T_k = -r(T_k)/c_p(T_k)$ 和建议的下一个迭代值 $T_{\\text{prop}} = T_k + \\Delta T_k$。\n    c. 如果建议的迭代值 $T_{\\text{prop}}$ 落在了当前搜索区间 $[T_L, T_R]$ 之外，则拒绝原始Newton步。取而代之的是一个更保守的二分法步：$T_{k+1} = T_L + 0.5(T_R - T_L)$。\n    d. 否则，接受Newton步：$T_{k+1} = T_{\\text{prop}}$。\n    e. 为下一次迭代更新界定区间。通过评估新迭代点 $r(T_{k+1})$ 处残差的符号来缩小区间。如果 $\\text{sign}(r(T_{k+1})) = \\text{sign}(r(T_L))$，则新的左边界变为 $T_L = T_{k+1}$。否则，新的右边界变为 $T_R = T_{k+1}$。这确保了根始终被界定。\n3.  如果达到收敛或达到最大迭代次数 $N_{\\max} = 50$，则迭代终止。收敛定义为满足以下两个条件之一：\n    a. 温度变化低于容差：$|T_{k+1} - T_k|  \\varepsilon_T = 10^{-10}$ K。\n    b. 焓残差的量级低于容差：$|r(T_{k+1})| = |h(T_{k+1}) - h^\\star|  \\varepsilon_h = 10^{-6}$ J/kg。\n\n此处Newton方法的数学收敛条件是有利的。函数 $r(T)$ 的二阶导数为 $r''(T) = c_p'(T) = b + 2cT$。对于所有 $T > -b/(2c) = -500.0$ K，$r''(T)>0$。这意味着在整个关注的温度范围 $[200.0, 2500.0]$ 内，$r(T)$ 是一个凸函数。对于凸函数，从任何满足 $r(T_0)>0$ 的起始点 $T_0$ 开始，Newton方法保证会收敛到唯一的根，并且从起始点 $T_0 > T^\\star$ 开始会快速收敛。所实现的全局化策略提供了一个额外的鲁棒性层，即使在不太理想的情况下也能保证收敛。\n\n我们分析两种初始猜测策略：\n- **策略S1**：$T_0^{\\mathrm{S1}} = T_{\\mathrm{ref}} + h^\\star / c_p(T_{\\mathrm{ref}})$。该猜测值是根据反函数 $T(h)$ 在参考状态 $(T_{\\mathrm{ref}}, h=0)$ 附近的一阶泰勒级数展开推导出来的。它使用参考温度下的比热来线性化问题。当真实温度 $T_{\\mathrm{true}}$ 接近 $T_{\\mathrm{ref}} = 298.15$ K 时，这个“有信息”的猜测预计会非常准确，并且在 $c_p(T)$ 与 $c_p(T_{\\mathrm{ref}})$ 相差不大的温度下，它仍应是一个良好的估计。\n- **策略S2**：$T_0^{\\mathrm{S2}} = \\tfrac{1}{2}(T_{\\min}+T_{\\max}) = 1350.0$ K。这个“无信息”的猜测值固定在允许温度区间的中心点，与目标焓 $h^\\star$ 无关。这是一个安全但可能效率不高的起始点，特别是当真实根位于区间边界附近时。\n\n我们预计策略S1会更优越，因为它具有物理基础，所以在整个测试套件中将导致更少的迭代次数。策略S2的性能将强烈依赖于真实温度与区间中心点的接近程度。由于所实现算法的鲁棒性，预计两种策略都将成功收敛。", "answer": "[[900.0, 4, True, 900.0, 5, True],[300.0, 2, True, 300.0, 6, True],[2200.0, 5, True, 2200.0, 5, True],[250.0, 3, True, 250.0, 7, True],[1500.0, 4, True, 1500.0, 3, True]]", "id": "2532137"}]}