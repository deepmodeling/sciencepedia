{"hands_on_practices": [{"introduction": "我们从一个传热学中的基石问题开始。这个练习将引导你推导静止平板中一维瞬态热传导的解析解。通过这个实践，你不仅能建立对控制方程的深刻理解，还将掌握特征扩散时间 ($t_c \\sim L^2/\\alpha$) 这一关键概念，它是静止介质近似的直接体现[@problem_id:2525399]。", "problem": "一个厚度为 $L$ 的均匀固态平板占据区域 $0 \\le x \\le L$。该平板是静止介质，意味着固体不移动，没有对流，且材料属性是恒定的。没有体积热生成。在时间 $t=0$ 时，平板处于均匀温度 $T_i$。对于所有 $t > 0$，位于 $x=0$ 和 $x=L$ 的两个平面分别保持在固定温度 $T_1$ 和 $T_2$。假设热传导是沿 $x$ 方向的一维传导。\n\n从固定控制体积的能量守恒和傅里叶热传导定律出发，推导温度场 $T(x,t)$ 的控制偏微分方程(PDE)以及边界和初始条件。然后，仅使用静止介质近似和基本原理，求解在给定条件下 $t > 0$ 时的解析温度场 $T(x,t)$。你的推导应包括你认为有必要用于分离瞬态分量并获得由初始条件确定的系数的完整特征函数展开的任何中间变量变换。\n\n定义热扩散系数 $\\alpha$ 为 $\\alpha = k/(\\rho c)$，其中 $k$ 是热导率，$\\rho$ 是质量密度，$c$ 是定压比热容。使用你的解，确定与基模相关的最慢衰减时间常数，并解释引出特征扩散时间 $t_c \\sim L^2/\\alpha$ 的标度关系。\n\n最后，对于一个 $L = 1.00 \\times 10^{-2}\\ \\mathrm{m}$ 和 $\\alpha = 1.50 \\times 10^{-7}\\ \\mathrm{m^2/s}$ 的平板，计算特征时间尺度 $t_c = L^2/\\alpha$。将你计算出的 $t_c$ 的最终数值结果四舍五入到 $3$ 位有效数字，并以秒为单位表示。", "solution": "所提出的问题是瞬态热传导中的一个标准的、适定问题，因此是有效的。我们将进行推导和求解。\n\n首先，我们从能量守恒原理推导控制偏微分方程(PDE)。考虑一个厚度为 $L$ 的一维均匀固态平板，占据区域 $0 \\le x \\le L$。设 $A$ 为垂直于 $x$ 轴的横截面积。我们将能量守恒应用于位于 $x$ 和 $x + \\Delta x$ 之间、厚度为 $\\Delta x$ 的固定微分控制体积。能量平衡表明，控制体积内内能的变化率等于传入控制体积的净热传导速率，因为没有体积热生成。\n\n内能的变化率由下式给出：\n$$ \\frac{\\partial E}{\\partial t} = \\frac{\\partial}{\\partial t} (\\rho V c T) = \\rho (A \\Delta x) c \\frac{\\partial T}{\\partial t} $$\n其中 $\\rho$ 是质量密度，$c$ 是比热容，$V = A \\Delta x$ 是体积，$T(x,t)$ 是温度。我们已假设材料属性 $\\rho$ 和 $c$ 是恒定的。\n\n净热传导速率是 $x$ 处进入的热量速率减去 $x + \\Delta x$ 处离开的热量速率。热通量 $q_x$ 由傅里葉热传导定律给出：\n$$ q_x = -k \\frac{\\partial T}{\\partial x} $$\n其中 $k$ 是热导率，也假设为常数。热传递速率是 $q_x A$。\n因此，净热传导速率为：\n$$ \\dot{Q}_{net} = (q_x A)|_x - (q_x A)|_{x+\\Delta x} = A \\left[ \\left(-k \\frac{\\partial T}{\\partial x}\\right)\\bigg|_x - \\left(-k \\frac{\\partial T}{\\partial x}\\right)\\bigg|_{x+\\Delta x} \\right] $$\n将能量变化率和净热速率相等：\n$$ \\rho A \\Delta x c \\frac{\\partial T}{\\partial t} = k A \\left[ \\left(\\frac{\\partial T}{\\partial x}\\right)\\bigg|_{x+\\Delta x} - \\left(\\frac{\\partial T}{\\partial x}\\right)\\bigg|_x \\right] $$\n两边除以 $A \\Delta x$ 并取极限 $\\Delta x \\to 0$：\n$$ \\rho c \\frac{\\partial T}{\\partial t} = k \\lim_{\\Delta x \\to 0} \\frac{\\left(\\frac{\\partial T}{\\partial x}\\right)\\bigg|_{x+\\Delta x} - \\left(\\frac{\\partial T}{\\partial x}\\right)\\bigg|_x}{\\Delta x} $$\n右边的极限是 $T$ 关于 $x$ 的二阶偏导数的定义。这得到了一维热方程：\n$$ \\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} \\implies \\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho c} \\frac{\\partial^2 T}{\\partial x^2} $$\n定义热扩散系数为 $\\alpha = k/(\\rho c)$，控制PDE为：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{for } 0  x  L, t > 0 $$\n问题陈述中给出的初始和边界条件是：\n初始条件 (IC)：$T(x, 0) = T_i$ for $0 \\le x \\le L$。\n边界条件 (BCs)：$T(0, t) = T_1$ 和 $T(L, t) = T_2$ for $t > 0$。\n\n为了解决这个具有非齐次边界条件的问题，我们将温度场 $T(x,t)$分解为一个稳态解 $T_{ss}(x)$和一个瞬态解 $\\theta(x,t)$：\n$$ T(x,t) = T_{ss}(x) + \\theta(x,t) $$\n稳态解 $T_{ss}(x)$ 是当 $t \\to \\infty$ 时的温度分布。在这个极限下，$\\partial T / \\partial t = 0$，热方程简化为：\n$$ \\frac{d^2 T_{ss}}{dx^2} = 0 $$\n其边界条件为 $T_{ss}(0) = T_1$ 和 $T_{ss}(L) = T_2$。积分两次得到 $T_{ss}(x) = C_1 x + C_2$。应用边界条件：\n$T_{ss}(0) = C_2 = T_1$\n$T_{ss}(L) = C_1 L + T_1 = T_2 \\implies C_1 = \\frac{T_2 - T_1}{L}$\n因此，稳态解是一个线性温度分布：\n$$ T_{ss}(x) = (T_2 - T_1)\\frac{x}{L} + T_1 $$\n现在我们求瞬态部分 $\\theta(x,t)$ 的控制方程和条件。将 $T(x,t) = T_{ss}(x) + \\theta(x,t)$ 代入原始PDE：\n$$ \\frac{\\partial}{\\partial t}(T_{ss}(x) + \\theta(x,t)) = \\alpha \\frac{\\partial^2}{\\partial x^2}(T_{ss}(x) + \\theta(x,t)) $$\n$$ \\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 T_{ss}}{\\partial x^2} + \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} $$\n由于 $\\frac{d^2 T_{ss}}{dx^2} = 0$，$\\theta(x,t)$ 的PDE是齐次热方程：\n$$ \\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} $$\n$\\theta(x,t)$ 的边界条件变为齐次：\n$T(0,t) = T_{ss}(0) + \\theta(0,t) = T_1 \\implies \\theta(0,t) = 0$\n$T(L,t) = T_{ss}(L) + \\theta(L,t) = T_2 \\implies \\theta(L,t) = 0$\n$\\theta(x,t)$ 的初始条件是：\n$T(x,0) = T_{ss}(x) + \\theta(x,0) = T_i \\implies \\theta(x,0) = T_i - T_{ss}(x) = T_i - \\left((T_2 - T_1)\\frac{x}{L} + T_1\\right)$\n\n我们使用分离变量法求解 $\\theta(x,t)$。令 $\\theta(x,t) = X(x)\\mathcal{T}(t)$。代入 $\\theta$ 的PDE：\n$$ X(x)\\frac{d\\mathcal{T}}{dt} = \\alpha \\mathcal{T}(t) \\frac{d^2X}{dx^2} \\implies \\frac{1}{\\alpha \\mathcal{T}} \\frac{d\\mathcal{T}}{dt} = \\frac{1}{X} \\frac{d^2X}{dx^2} = -\\lambda^2 $$\n其中 $-\\lambda^2$ 是分离常数。这导致两个常微分方程：\n时间ODE：$\\frac{d\\mathcal{T}}{dt} + \\alpha \\lambda^2 \\mathcal{T} = 0 \\implies \\mathcal{T}(t) = C \\exp(-\\alpha \\lambda^2 t)$\n空间ODE：$\\frac{d^2X}{dx^2} + \\lambda^2 X = 0 \\implies X(x) = A \\sin(\\lambda x) + B \\cos(\\lambda x)$\n\n将 $\\theta$ 的齐次边界条件应用于 $X(x)$：\n$X(0) = 0 \\implies A \\sin(0) + B \\cos(0) = B = 0$。所以，$X(x) = A \\sin(\\lambda x)$。\n$X(L) = 0 \\implies A \\sin(\\lambda L) = 0$。为了得到非平凡解($A \\ne 0$)，必须有 $\\sin(\\lambda L) = 0$。\n这个条件确定了特征值 $\\lambda_n$：\n$\\lambda_n L = n\\pi \\implies \\lambda_n = \\frac{n\\pi}{L}$，对于 $n = 1, 2, 3, \\ldots$\n相应的特征函数是 $X_n(x) = \\sin(\\frac{n\\pi x}{L})$。\n$\\theta(x,t)$ 的解是所有可能模式的叠加：\n$$ \\theta(x,t) = \\sum_{n=1}^{\\infty} C_n \\exp\\left(-\\alpha \\lambda_n^2 t\\right) X_n(x) = \\sum_{n=1}^{\\infty} C_n \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{L}\\right)^2 t\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n系数 $C_n$ 由初始条件 $\\theta(x,0)$ 确定。在 $t=0$ 时：\n$$ \\theta(x,0) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi x}{L}\\right) = T_i - T_{ss}(x) $$\n这是 $\\theta(x,0)$ 的傅里叶正弦级数展开。系数 $C_n$ 由下式给出：\n$$ C_n = \\frac{2}{L} \\int_0^L \\theta(x,0) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{2}{L} \\int_0^L \\left(T_i - T_1 - (T_2-T_1)\\frac{x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx $$\n我们分两部分计算积分：\n$$ C_n = \\frac{2}{L} \\int_0^L (T_i-T_1)\\sin\\left(\\frac{n\\pi x}{L}\\right)dx - \\frac{2(T_2-T_1)}{L^2}\\int_0^L x\\sin\\left(\\frac{n\\pi x}{L}\\right)dx $$\n第一个积分是：\n$$ \\frac{2(T_i-T_1)}{L} \\left[-\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)\\right]_0^L = \\frac{2(T_i-T_1)}{n\\pi}(1-\\cos(n\\pi)) = \\frac{2(T_i-T_1)}{n\\pi}(1-(-1)^n) $$\n第二个积分，使用分部积分法，是：\n$$ \\int_0^L x\\sin\\left(\\frac{n\\pi x}{L}\\right)dx = \\left[-\\frac{Lx}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right) + \\left(\\frac{L}{n\\pi}\\right)^2\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right]_0^L = -\\frac{L^2}{n\\pi}\\cos(n\\pi) = -\\frac{L^2}{n\\pi}(-1)^n $$\n将此代回 $C_n$ 的表达式中：\n$$ C_n = \\frac{2(T_i-T_1)}{n\\pi}(1-(-1)^n) - \\frac{2(T_2-T_1)}{L^2}\\left(-\\frac{L^2}{n\\pi}(-1)^n\\right) = \\frac{2}{n\\pi}[(T_i-T_1)(1-(-1)^n)+(T_2-T_1)(-1)^n] $$\n$$ C_n = \\frac{2}{n\\pi}[T_i-T_1 - (T_i-T_1)(-1)^n + (T_2-T_1)(-1)^n] = \\frac{2}{n\\pi}[T_i-T_1 + (T_2-T_i)(-1)^n] $$\n结合稳态解和瞬态解，温度场的完整解析解是：\n$$ T(x,t) = (T_2 - T_1)\\frac{x}{L} + T_1 + \\sum_{n=1}^{\\infty} \\left( \\frac{2}{n\\pi}[T_i-T_1 + (T_2-T_i)(-1)^n] \\right) \\exp\\left(-\\frac{\\alpha n^2 \\pi^2 t}{L^2}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n\n接下来，我们确定时间常数。级数解中的每一项都随时间指数衰减，由因子 $\\exp(-\\alpha \\lambda_n^2 t) = \\exp(-t/\\tau_n)$ 控制。第 $n$ 阶模式的时间常数因此为：\n$$ \\tau_n = \\frac{1}{\\alpha \\lambda_n^2} = \\frac{L^2}{\\alpha n^2 \\pi^2} $$\n总体衰减速率由最慢衰减的模式控制，这对应于最大的时间常数。这发生在基模 $n=1$ 时。最慢衰减的时间常数为：\n$$ \\tau_1 = \\frac{L^2}{\\alpha \\pi^2} $$\n这个结果解释了特征扩散时间 $t_c \\sim L^2/\\alpha$ 的标度关系。热扩散的时间尺度由 $\\tau_1$ 主导。因子 $\\pi^2$ 是一个数量级接近 $10$ 的数值常数。基本的物理关系是，热量扩散过距离 $L$ 所需的时间与距离的平方成正比，与热扩散系数成反比。因此，通常定义一个特征扩散时间 $t_c = L^2/\\alpha$，它抓住了这个基本的标度关系。\n\n最后，我们计算给定参数的特征时间尺度 $t_c$：\n$L = 1.00 \\times 10^{-2}\\ \\mathrm{m}$\n$\\alpha = 1.50 \\times 10^{-7}\\ \\mathrm{m^2/s}$\n特征时间的计算如下：\n$$ t_c = \\frac{L^2}{\\alpha} = \\frac{(1.00 \\times 10^{-2}\\ \\mathrm{m})^2}{1.50 \\times 10^{-7}\\ \\mathrm{m^2/s}} = \\frac{1.00 \\times 10^{-4}\\ \\mathrm{m}^2}{1.50 \\times 10^{-7}\\ \\mathrm{m}^2/s} $$\n$$ t_c = \\frac{1.00}{1.50} \\times 10^{3}\\ \\mathrm{s} = 0.6666... \\times 10^{3}\\ \\mathrm{s} \\approx 667\\ \\mathrm{s} $$\n四舍五入到 $3$ 位有效数字，特征时间尺度为 $667$ 秒。", "answer": "$$\\boxed{667}$$", "id": "2525399"}, {"introduction": "接下来，我们将视角从热传递转向质量传递，以探究静止介质近似的局限性。本练习设定在一个常见的工程场景——蒸发过程中，你将对比一个简化模型（静止介质中的菲克扩散）和一个更精确地考虑了宏观流动（斯特凡流）的模型[@problem_id:2525447]。通过量化该近似所引入的误差，这一实践对于培养严谨的工程判断力至关重要。", "problem": "纯液态物质 $A$ 在恒定温度和压力下蒸发到一个不凝性载气 $B$（氮气）的静止层中。考虑一个与平坦液体表面相邻、厚度为 $L$ 的一维、等温、等压气膜，坐标 $z$ 从界面（$z=0$）处开始测量，并指向气体内部（$z=L$）。总压力为 $P = 1.01325 \\times 10^{5}\\ \\mathrm{Pa}$，温度为 $T = 298\\ \\mathrm{K}$，二元扩散系数为 $D_{AB} = 7.0 \\times 10^{-6}\\ \\mathrm{m^2/s}$。将气体视为理想气体，因此总摩尔浓度为 $c = P/(R T)$，其中 $R$ 是通用气体常数。由于表面存在轻微的热不均匀性，界面处 $A$ 的摩尔分数为 $y_{A,s}$，其范围在 $0.30 \\le y_{A,s} \\le 0.50$ 之内。远离界面的主体气体是干燥的，其 $y_{A,\\infty} = 0$。载气 $B$ 不穿过界面，并且在摩尔基准下其穿过气膜的净摩尔通量为零。\n\n仅从稳态一维组分摩尔平衡和恒温恒压下二元扩散的菲克定律定义出发，完成以下任务：\n\n1. 推导 $A$ 的稳态摩尔通量 $N_{A}^{\\mathrm{Stefan}}$，考虑由蒸发引起的斯特凡流，条件是 $B$ 穿过气膜的净摩尔通量为零。\n\n2. 在静止介质近似（摩尔平均速度为零，即无宏观流动）下，针对相同的边界条件，推导 $A$ 的稳态摩尔通量 $N_{A}^{\\mathrm{Fick}}$。\n\n3. 将静止介质近似相对于斯特凡校正通量的绝对相对误差定义为\n$$\n\\varepsilon(y_{A,s}) \\equiv \\frac{\\left|N_{A}^{\\mathrm{Fick}} - N_{A}^{\\mathrm{Stefan}}\\right|}{N_{A}^{\\mathrm{Stefan}}}.\n$$\n对于组分范围 $y_{A,s} \\in [0.30, 0.50]$ 和气膜厚度 $L = 4.0 \\times 10^{-3}\\ \\mathrm{m}$，确定在此范围内 $\\varepsilon(y_{A,s})$ 的最大值。\n\n将最终结果表示为无单位的小数，并四舍五入至四位有效数字。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。这是一个关于斯特凡扩散和静止介质近似有效性的传质理论中的标准问题。验证通过，我将继续进行求解。\n\n分析始于稳态下一维二元体系中组分 $A$ 的总摩尔通量的一般表达式，该表达式是扩散通量（$J_A$）和对流宏观流动通量之和：\n$$\nN_A = J_A + y_A (N_A + N_B)\n$$\n其中 $y_A$ 是组分 $A$ 的摩尔分数，$N_A$ 和 $N_B$ 分别是组分 $A$ 和 $B$ 的摩尔通量。菲克定律将相对于摩尔平均速度的扩散通量定义为：\n$$\nJ_A = -c D_{AB} \\frac{dy_A}{dz}\n$$\n这里，$c$ 是总摩尔浓度，$D_{AB}$ 是二元扩散系数，$z$ 是空间坐标。结合这些，得到组分 $A$ 通量的控制方程：\n$$\nN_A = -c D_{AB} \\frac{dy_A}{dz} + y_A (N_A + N_B)\n$$\n在稳态下，组分摩尔平衡要求通量 $N_A$ 沿扩散路径必须恒定，即 $\\frac{dN_A}{dz} = 0$。\n\n1. 斯特凡通量 $N_{A}^{\\mathrm{Stefan}}$ 的推导\n\n这种情况模拟了组分 $A$ 蒸发到停滞的、不凝性气体 $B$ 中的过程。其决定性的物理条件是组分 $B$ 不溶于液体 $A$，因此不能穿过 $z=0$ 处的界面。这意味着在气膜中各处 $B$ 的净摩尔通量为零。\n$$\nN_B = 0\n$$\n将此条件代入通用通量方程，得到：\n$$\nN_A = -c D_{AB} \\frac{dy_A}{dz} + y_A N_A\n$$\n该方程可以重排以分离变量进行积分：\n$$\nN_A (1 - y_A) = -c D_{AB} \\frac{dy_A}{dz}\n$$\n$$\n\\frac{N_A}{c D_{AB}} dz = -\\frac{dy_A}{1 - y_A}\n$$\n我们将此表达式在整个气膜上进行积分，从界面 $z=0$（此处 $y_A = y_{A,s}$）到气膜边缘 $z=L$（此处问题指定为干燥主体气体，因此 $y_A = y_{A,L} = 0$）。由于 $N_A$、$c$ 和 $D_{AB}$ 是常数，我们有：\n$$\n\\int_{0}^{L} \\frac{N_A}{c D_{AB}} dz = \\int_{y_{A,s}}^{y_{A,L}=0} -\\frac{dy_A}{1 - y_A}\n$$\n$$\n\\frac{N_A L}{c D_{AB}} = \\left[ \\ln(1 - y_A) \\right]_{y_{A,s}}^{0}\n$$\n$$\n\\frac{N_A L}{c D_{AB}} = \\ln(1 - 0) - \\ln(1 - y_{A,s}) = -\\ln(1 - y_{A,s})\n$$\n求解摩尔通量 $N_A$（我们将其表示为 $N_{A}^{\\mathrm{Stefan}}$），得到斯特凡流的结果：\n$$\nN_{A}^{\\mathrm{Stefan}} = -\\frac{c D_{AB}}{L} \\ln(1 - y_{A,s})\n$$\n\n2. 静止介质近似下通量 $N_{A}^{\\mathrm{Fick}}$ 的推导\n\n静止介质近似在问题中被明确定义为摩尔平均速度为零的情况。摩尔平均速度 $v^*$ 由 $v^* = (N_A + N_B)/c$ 给出。因此，该近似意味着：\n$$\nv^* = 0 \\implies N_A + N_B = 0\n$$\n这个条件描述了等摩尔反向扩散。将 $N_A + N_B = 0$ 代入通用通量方程，得到：\n$$\nN_A = -c D_{AB} \\frac{dy_A}{dz} + y_A(0)\n$$\n$$\nN_A = -c D_{AB} \\frac{dy_A}{dz}\n$$\n这就是静止介质的简化菲克扩散方程。我们再次分离变量，并在相同的边界条件（$y_A(0)=y_{A,s}$，$y_A(L)=0$）下对整个气膜进行积分：\n$$\n\\int_{0}^{L} N_A dz = \\int_{y_{A,s}}^{0} -c D_{AB} dy_A\n$$\n$$\nN_A L = -c D_{AB} [y_A]_{y_{A,s}}^{0} = -c D_{AB} (0 - y_{A,s}) = c D_{AB} y_{A,s}\n$$\n求解通量（我们将其表示为 $N_{A}^{\\mathrm{Fick}}$），得到：\n$$\nN_{A}^{\\mathrm{Fick}} = \\frac{c D_{AB}}{L} y_{A,s}\n$$\n\n3. 最大相对误差的确定\n\n绝对相对误差 $\\varepsilon$ 定义为：\n$$\n\\varepsilon(y_{A,s}) = \\frac{\\left|N_{A}^{\\mathrm{Fick}} - N_{A}^{\\mathrm{Stefan}}\\right|}{N_{A}^{\\mathrm{Stefan}}}\n$$\n代入推导出的通量表达式：\n$$\n\\varepsilon(y_{A,s}) = \\frac{\\left|\\frac{c D_{AB}}{L} y_{A,s} - \\left(-\\frac{c D_{AB}}{L} \\ln(1 - y_{A,s})\\right)\\right|}{-\\frac{c D_{AB}}{L} \\ln(1 - y_{A,s})}\n$$\n公因子 $\\frac{c D_{AB}}{L}$ 被消去。我们还注意到，对于 $y_{A,s} \\in (0, 1)$，泰勒级数展开式 $-\\ln(1 - y_{A,s}) = y_{A,s} + \\frac{y_{A,s}^2}{2} + \\dots$ 表明 $-\\ln(1 - y_{A,s}) > y_{A,s}$。因此，$N_{A}^{\\mathrm{Stefan}} > N_{A}^{\\mathrm{Fick}} > 0$。绝对值内的项 $N_{A}^{\\mathrm{Fick}} - N_{A}^{\\mathrm{Stefan}}$ 是负的。\n$$\n\\varepsilon(y_{A,s}) = \\frac{N_{A}^{\\mathrm{Stefan}} - N_{A}^{\\mathrm{Fick}}}{N_{A}^{\\mathrm{Stefan}}} = 1 - \\frac{N_{A}^{\\mathrm{Fick}}}{N_{A}^{\\mathrm{Stefan}}}\n$$\n$$\n\\varepsilon(y_{A,s}) = 1 - \\frac{\\frac{c D_{AB}}{L} y_{A,s}}{-\\frac{c D_{AB}}{L} \\ln(1 - y_{A,s})} = 1 + \\frac{y_{A,s}}{\\ln(1 - y_{A,s})}\n$$\n为了找到 $\\varepsilon(y_{A,s})$ 在范围 $y_{A,s} \\in [0.30, 0.50]$ 内的最大值，我们考察其关于 $y_{A,s}$ 的导数。令 $x = y_{A,s}$。\n$$\n\\frac{d\\varepsilon}{dx} = \\frac{d}{dx} \\left(1 + \\frac{x}{\\ln(1-x)}\\right) = \\frac{1 \\cdot \\ln(1-x) - x \\cdot \\frac{-1}{1-x}}{(\\ln(1-x))^2} = \\frac{\\ln(1-x) + \\frac{x}{1-x}}{(\\ln(1-x))^2}\n$$\n为了确定导数的符号，我们分析分子 $g(x) = \\ln(1-x) + \\frac{x}{1-x}$。其导数为 $g'(x) = -\\frac{1}{1-x} + \\frac{(1)(1-x) - x(-1)}{(1-x)^2} = \\frac{-(1-x)+1}{(1-x)^2} = \\frac{x}{(1-x)^2}$。对于 $x \\in (0,1)$，$g'(x) > 0$，所以 $g(x)$ 是一个严格递增函数。由于 $g(0) = \\ln(1) + 0 = 0$，因此对于所有 $x \\in (0,1)$，都有 $g(x) > 0$。\n对于 $x \\in [0.30, 0.50]$，$\\frac{d\\varepsilon}{dx}$ 的分子为正，分母也始终为正。因此，$\\frac{d\\varepsilon}{dx} > 0$，并且 $\\varepsilon(y_{A,s})$ 在指定范围内是 $y_{A,s}$ 的单调递增函数。\n因此，最大误差将出现在 $y_{A,s}$ 的最大值处，即 $y_{A,s} = 0.50$。\n$$\n\\varepsilon_{\\max} = \\varepsilon(0.50) = 1 + \\frac{0.50}{\\ln(1 - 0.50)} = 1 + \\frac{0.50}{\\ln(0.50)}\n$$\n$$\n\\varepsilon_{\\max} = 1 + \\frac{0.50}{-0.693147...} = 1 - 0.721347... = 0.278652...\n$$\n四舍五入到四位有效数字，最大绝对相对误差为 $0.2787$。", "answer": "$$\n\\boxed{0.2787}\n$$", "id": "2525447"}, {"introduction": "最后，我们以一个连接理论与实际应用的现代计算练习作为结束。本实践采用“人造解法”(Method of Manufactured Solutions)来验证瞬态扩散方程的数值代码的正确性[@problem_id:2525432]。你将学习如何设计计算实验并执行网格加密研究，以确认求解器的精度，这在以数值模拟为主导的今天是一项至关重要的技能。", "problem": "设计并实现一个针对瞬态扩散中静态介质近似的验证性研究，通过在网格加密条件下展示数值求解器的二阶收敛性来完成。从基本原理（能量守恒和傅里叶定律）出发，陈述其控制方程，并使用一个具有兼容边界数据的光滑人工解来验证其精度阶。该研究严格限制在一维固定域上，并且完全无量纲化，因此不需要物理单位。\n\n在一个静态介质（无物质运动）中，对于空间区间 $x \\in [0,1]$ 和时间 $t \\ge 0$，具有恒定热扩散系数 $\\alpha$ 的温度 $T(x,t)$ 的控制偏微分方程 (PDE) 为\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}.\n$$\n使用光滑人工解\n$$\nT_{\\text{exact}}(x,t) = \\cos(\\pi x)\\, \\exp\\!\\left(-\\alpha \\pi^2 t\\right),\n$$\n这意味着初始条件为 $T(x,0) = \\cos(\\pi x)$，以及时变狄利克雷边界条件 $T(0,t) = \\exp(-\\alpha \\pi^2 t)$ 和 $T(1,t) = -\\exp(-\\alpha \\pi^2 t)$，这两者在空间和时间上都是光滑的。\n\n在一系列均匀网格上，使用任意在时间和空间上均为二阶精度的相容方法对该偏微分方程进行数值求解。为了分离出二阶空间截断误差，强制时间步长 $\\Delta t$ 满足 $\\Delta t \\propto \\Delta x^2$ 的约束，从而使得无量纲扩散数 $r = \\alpha \\Delta t / \\Delta x^2$ 在网格加密时保持恒定。对于每个网格，通过选择整数个时间步 $N_t$ 并相应地调整 $\\Delta t = t_{\\text{end}}/N_t$，确保最终模拟时间恰好为 $t_{\\text{end}}$；这将使 $r$ 在不同加密程度的网格间保持近似恒定。\n\n对于一个具有 $N$ 个内部点的网格，令 $\\Delta x = 1/(N+1)$，定义内部节点 $x_i = i\\,\\Delta x$（其中 $i = 1,2,\\dots,N$），并从 $t=0$ 到 $t=t_{\\text{end}}$ 进行时间步进，在每个时间层上施加来自 $T_{\\text{exact}}(x,t)$ 的狄利克雷边界值。在最终时刻，计算离散 $L^2$ 误差\n$$\nE_{N} = \\left( \\Delta x \\sum_{i=1}^{N} \\left[T_{\\text{num}}(x_i,t_{\\text{end}}) - T_{\\text{exact}}(x_i,t_{\\text{end}})\\right]^2 \\right)^{1/2}.\n$$\n\n为了验证二阶收敛性，对于一个基础网格尺寸 $N_0$ 及其连续加密的网格 $2N_0$ 和 $4N_0$，计算观测到的收敛阶\n$$\np_1 = \\frac{\\log\\!\\left(E_{N_0}/E_{2N_0}\\right)}{\\log(2)}, \\quad\np_2 = \\frac{\\log\\!\\left(E_{2N_0}/E_{4N_0}\\right)}{\\log(2)}.\n$$\n对于每个测试用例，报告单个浮点数 $p_{\\min} = \\min(p_1,p_2)$。\n\n测试套件。您的程序必须运行以下三个测试用例，并按规定的输出格式汇总它们的 $p_{\\min}$ 值：\n- 用例 A（理想路径）：$\\alpha = 1.0$, $t_{\\text{end}} = 0.1$, $r = 0.5$, $N_0 = 32$。\n- 用例 B（短时间，边界敏感性）：$\\alpha = 1.0$, $t_{\\text{end}} = 0.001$, $r = 0.5$, $N_0 = 32$。\n- 用例 C（不同扩散系数）：$\\alpha = 0.05$, $t_{\\text{end}} = 0.1$, $r = 0.5$, $N_0 = 32$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 [用例 A, 用例 B, 用例 C]，每个条目是对应的 $p_{\\min}$ 值，四舍五入到 6 位小数，例如 $[2.000000,1.998765,2.001234]$。", "solution": "所提出的问题是针对一维瞬态热扩散方程数值求解器的一个标准验证性研究。在继续之前，我们必须验证问题陈述的有效性。\n\n首先，我们逐字提取给定的信息。\n控制方程：$\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$ 在 $x \\in [0,1]$, $t \\ge 0$ 上。\n人工解：$T_{\\text{exact}}(x,t) = \\cos(\\pi x)\\, \\exp(-\\alpha \\pi^2 t)$。\n初始条件：$T(x,0) = \\cos(\\pi x)$。\n边界条件：$T(0,t) = \\exp(-\\alpha \\pi^2 t)$, $T(1,t) = -\\exp(-\\alpha \\pi^2 t)$。\n数值方法：时空二阶精度。\n网格加密：$\\Delta t \\propto \\Delta x^2$，其中 $r = \\alpha \\Delta t / \\Delta x^2$ 保持近似恒定。\n空间离散化：$\\Delta x = 1/(N+1)$，对于 $N$ 个内部点 $x_i = i\\,\\Delta x$（其中 $i = 1, \\dots, N$）。\n时间离散化：最终时间 $t_{\\text{end}}$ 通过整数个时间步 $N_t$ 达到，因此 $\\Delta t = t_{\\text{end}}/N_t$。\n误差度量：$L^2$ 误差 $E_{N} = \\left( \\Delta x \\sum_{i=1}^{N} \\left[T_{\\text{num}}(x_i,t_{\\text{end}}) - T_{\\text{exact}}(x_i,t_{\\text{end}})\\right]^2 \\right)^{1/2}$。\n收敛阶计算：$p_1 = \\frac{\\log(E_{N_0}/E_{2N_0})}{\\log(2)}$，$p_2 = \\frac{\\log(E_{2N_0}/E_{4N_0})}{\\log(2)}$，报告值为 $p_{\\min} = \\min(p_1,p_2)$。\n测试用例：\n用例 A：$\\alpha = 1.0$, $t_{\\text{end}} = 0.1$, $r = 0.5$, $N_0 = 32$。\n用例 B：$\\alpha = 1.0$, $t_{\\text{end}} = 0.001$, $r = 0.5$, $N_0 = 32$。\n用例 C：$\\alpha = 0.05$, $t_{\\text{end}} = 0.1$, $r = 0.5$, $N_0 = 32$。\n\n接下来，我们验证该问题。该问题具有科学依据，基于基本的热传导方程，该方程源于在静态介质中能量守恒定律与傅里叶热传导定律的结合。人工解方法是数值分析领域中用于验证数值代码实现正确性和收敛阶的一种严谨且标准的技术。所提供的人工解 $T_{\\text{exact}}(x,t)$ 经验证是控制偏微分方程及其相关初始和边界条件的精确解。所有参数和过程都经过了精确的数学定义。该问题不含科学缺陷、歧义或矛盾。它是计算科学领域中一个适定、客观且有意义的任务。\n\n结论是该问题有效。我们继续进行求解。\n\n控制方程 $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$ 描述了静态介质中的热扩散。任务是实现一个数值求解器，并验证其收敛速度是否与其理论设计精度相符。该问题要求一种在时间和空间上均为二阶精度的方法。Crank-Nicolson 格式是满足此要求的合适选择。\n\n项 $\\frac{\\partial^2 T}{\\partial x^2}$ 的空间离散化是通过在每个空间节点 $x_i$ 上使用二阶中心差分公式来实现的：\n$$\n\\left. \\frac{\\partial^2 T}{\\partial x^2} \\right|_{x_i} \\approx \\frac{T_{i-1} - 2T_i + T_{i+1}}{\\Delta x^2} + \\mathcal{O}(\\Delta x^2)\n$$\n其中 $T_i$ 表示节点 $x_i$ 处的温度。\n\nCrank-Nicolson 方法通过将空间有限差分近似置于 $t^n$ 和 $t^{n+1}$ 这两个时间层之间，从而将解从时间 $t^n$ 推进到 $t^{n+1}$。这种时间平均方法在时间上能达到二阶精度。离散化后的方程为：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{\\Delta x^2} + \\frac{T_{i-1}^n - 2T_i^n + T_{i+1}^n}{\\Delta x^2} \\right)\n$$\n其中 $T_i^n$ 是 $T(x_i, t^n)$ 的数值近似。令 $r = \\alpha \\Delta t / \\Delta x^2$ 为无量纲扩散数。我们重新整理方程，将时间层 $n+1$ 的未知项置于左侧，将时间层 $n$ 的已知项置于右侧：\n$$\n-\\frac{r}{2} T_{i-1}^{n+1} + (1+r) T_i^{n+1} - \\frac{r}{2} T_{i+1}^{n+1} = \\frac{r}{2} T_{i-1}^n + (1-r) T_i^n + \\frac{r}{2} T_{i+1}^n\n$$\n该方程对所有内部空间节点 $i=1, 2, \\dots, N$ 均成立。这就形成了一个关于内部节点上 $N$ 个未知温度 $\\mathbf{T}^{n+1} = [T_1^{n+1}, T_2^{n+1}, \\dots, T_N^{n+1}]^T$ 的 $N$ 元线性方程组。该系统可以写成矩阵形式 $A \\mathbf{T}^{n+1} = \\mathbf{d}^n$，其中 $A$ 是一个由左侧系数定义的三对角矩阵。矩阵 $A$ 的元素为：\n$$\nA_{i,i} = 1+r, \\quad A_{i, i-1} = -\\frac{r}{2}, \\quad A_{i, i+1} = -\\frac{r}{2}\n$$\n右侧向量 $\\mathbf{d}^n$ 取决于前一时间步的解 $\\mathbf{T}^n$ 以及边界条件。边界温度 $T_0$ (在 $x=0$ 处) 和 $T_{N+1}$ (在 $x=1$ 处) 由每个时间步的精确解给出。对于第一个方程 ($i=1$) 和最后一个方程 ($i=N$)，已知的边界值被移到右侧。向量 $\\mathbf{d}^n$ 的分量为：\n$$\nd_1^n = \\frac{r}{2} (T_0^n + T_0^{n+1}) + (1-r)T_1^n + \\frac{r}{2}T_2^n\n$$\n$$\nd_i^n = \\frac{r}{2} T_{i-1}^n + (1-r)T_i^n + \\frac{r}{2}T_{i+1}^n \\quad \\text{for } 1  i  N\n$$\n$$\nd_N^n = \\frac{r}{2} T_{N-1}^n + (1-r)T_N^n + \\frac{r}{2} (T_{N+1}^n + T_{N+1}^{n+1})\n$$\n验证性研究的步骤如下。对于每个测试用例，我们在一系列包含 $N_0$、$2N_0$ 和 $4N_0$ 个内部点的三个网格上进行模拟。对于每个网格：\n1.  计算网格间距 $\\Delta x = 1/(N+1)$。\n2.  确定时间步数 $N_t$，使得最终时间 $t_{\\text{end}}$ 被精确达到，同时保持扩散数 $r$ 接近目标值。时间步长为 $\\Delta t = t_{\\text{end}}/N_t$，其中 $N_t = \\lceil t_{\\text{end}} / (r_{\\text{target}} \\Delta x^2/\\alpha) \\rceil$。\n3.  使用 $T_i^0 = \\cos(\\pi x_i)$ 初始化 $t=0$ 时的温度场。\n4.  对 $n = 0, \\dots, N_t-1$ 迭代求解三对角系统 $A \\mathbf{T}^{n+1} = \\mathbf{d}^n$，以获得 $t_{\\text{end}}$ 时的最终数值解。为了提高效率，使用专门针对三对角系统的算法，如 Thomas 算法或带状矩阵求解器。\n5.  通过将数值解与 $t_{\\text{end}}$ 时的精确解进行比较，计算离散 $L^2$ 误差 $E_N$。\n在计算出误差 $E_{N_0}$、$E_{2N_0}$ 和 $E_{4N_0}$ 之后，计算观测到的收敛阶 $p_1$ 和 $p_2$。$p \\approx 2$ 的结果将验证该实现确实是二阶精度的。报告这两个值中的最小值 $p_{\\min}$。然后对所有指定的测试用例重复此整个过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef T_exact(x, t, alpha):\n    \"\"\"\n    Calculates the exact manufactured solution for the heat equation.\n\n    Args:\n        x (np.ndarray or float): Spatial coordinate(s).\n        t (float): Time.\n        alpha (float): Thermal diffusivity.\n\n    Returns:\n        np.ndarray or float: The exact temperature(s).\n    \"\"\"\n    return np.cos(np.pi * x) * np.exp(-alpha * (np.pi**2) * t)\n\ndef run_simulation_and_get_error(N, alpha, t_end, r_target):\n    \"\"\"\n    Runs a single simulation on a grid with N points and computes the L2 error.\n\n    Args:\n        N (int): Number of interior grid points.\n        alpha (float): Thermal diffusivity.\n        t_end (float): Final simulation time.\n        r_target (float): Target diffusion number.\n\n    Returns:\n        float: The discrete L2 norm of the error at t_end.\n    \"\"\"\n    # 1. Spatial grid setup\n    dx = 1.0 / (N + 1)\n    # Interior nodes\n    x = np.linspace(dx, 1.0 - dx, N)\n\n    # 2. Temporal grid setup\n    # Provisional dt to estimate Nt, based on the target r\n    dt_provisional = r_target * dx**2 / alpha\n    # Number of time steps must be an integer to reach t_end exactly\n    Nt = int(np.ceil(t_end / dt_provisional))\n    # Final, adjusted dt and r\n    dt = t_end / Nt\n    r = alpha * dt / dx**2\n\n    # 3. Initial condition\n    T_num = T_exact(x, 0.0, alpha)\n\n    # 4. Setup Crank-Nicolson linear system\n    # The LHS matrix A is constant. We represent it in banded form for solve_banded.\n    # The shape is (3, N) for a tridiagonal matrix of size N x N.\n    # (1, 1) means 1 lower diagonal and 1 upper diagonal.\n    # Row 0: super-diagonal (u), Row 1: main diagonal, Row 2: sub-diagonal (l)\n    A_banded = np.zeros((3, N))\n    A_banded[0, 1:] = -r / 2.0\n    A_banded[1, :] = 1.0 + r\n    A_banded[2, :-1] = -r / 2.0\n\n    # 5. Time-stepping loop\n    for n in range(Nt):\n        t_n = n * dt\n        t_n1 = (n + 1) * dt\n\n        # Boundary conditions from exact solution\n        T0_n = T_exact(0.0, t_n, alpha)\n        T_L_n = T_exact(1.0, t_n, alpha)\n        T0_n1 = T_exact(0.0, t_n1, alpha)\n        T_L_n1 = T_exact(1.0, t_n1, alpha)\n\n        # Construct the RHS vector `d`\n        d = np.zeros(N)\n        \n        # Vectorized calculation for interior points (i=2 to N-1)\n        if N > 2:\n            d[1:-1] = (r / 2.0) * T_num[:-2] + (1.0 - r) * T_num[1:-1] + (r / 2.0) * T_num[2:]\n        \n        # First point (i=1) includes boundary term from T0\n        # Check for N=1 case which has no T_num[1]\n        if N == 1:\n            d[0] = (1.0 - r) * T_num[0] + (r / 2.0) * (T0_n + T0_n1 + T_L_n + T_L_n1)\n        else:\n            d[0] = (1.0 - r) * T_num[0] + (r / 2.0) * T_num[1] + (r / 2.0) * (T0_n + T0_n1)\n            # Last point (i=N) includes boundary term from T_L\n            d[-1] = (r / 2.0) * T_num[-2] + (1.0 - r) * T_num[-1] + (r / 2.0) * (T_L_n + T_L_n1)\n        \n        # Solve the tridiagonal system A*T_num_new = d\n        T_num = solve_banded((1, 1), A_banded, d)\n\n    # 6. Compute L2 error at the end\n    T_e = T_exact(x, t_end, alpha)\n    error = np.sqrt(dx * np.sum((T_num - T_e)**2))\n    return error\n\ndef compute_p_min(alpha, t_end, r_target, N0):\n    \"\"\"\n    Performs grid refinement study and computes the minimum order of convergence.\n\n    Args:\n        alpha (float): Thermal diffusivity.\n        t_end (float): Final simulation time.\n        r_target (float): Target diffusion number.\n        N0 (int): Base number of grid points.\n\n    Returns:\n        float: The minimum observed order of convergence, p_min.\n    \"\"\"\n    grid_sizes = [N0, 2 * N0, 4 * N0]\n    errors = []\n    \n    for N in grid_sizes:\n        error = run_simulation_and_get_error(N, alpha, t_end, r_target)\n        errors.append(error)\n        \n    E_N0, E_2N0, E_4N0 = errors\n    \n    # Calculate observed orders of convergence\n    p1 = np.log(E_N0 / E_2N0) / np.log(2)\n    p2 = np.log(E_2N0 / E_4N0) / np.log(2)\n    \n    return min(p1, p2)\n\ndef solve():\n    \"\"\"\n    Main function to run the specified test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (alpha, t_end, r_target, N0)\n        (1.0, 0.1, 0.5, 32),    # Case A\n        (1.0, 0.001, 0.5, 32),  # Case B\n        (0.05, 0.1, 0.5, 32),   # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, t_end, r_target, N0 = case\n        p_min = compute_p_min(alpha, t_end, r_target, N0)\n        results.append(f\"{p_min:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2525432"}]}