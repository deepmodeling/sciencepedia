{"hands_on_practices": [{"introduction": "本节的实践练习始于一个基本但极具启发性的思想实验，旨在建立关于大颗粒与辐射相互作用的物理直觉。我们不采用复杂的波动理论，而是通过几何光学和衍射的物理论证，来推导一个令人惊讶却又至关重要的结果，即所谓的“消光悖论”。这个练习[@problem_id:2468121]将帮助你深入理解消光、吸收和散射截面的物理本质，并掌握如何估算大尺寸参数极限下的不对称因子 $g$ 和消光效率 $Q_{\\text{ext}}$。", "problem": "在一种非折射主介质中，一束准直单色光（波长为 $\\lambda$）照射着一个空间均匀、光学薄的悬浮液，其中包含半径为 $a$ 的相同球形粒子。粒子尺寸参数为 $x = 2\\pi a/\\lambda \\gg 1$。每个粒子都是完全吸收的（无镜面反射，无透射），并且在入射波长下，热辐射可以忽略不计。\n\n采用几何光学极限，并辅以通过 Babinet’s principle 和 Huygens–Fresnel construction 的标量衍射来表示前向瓣。令 $C_{\\text{ext}}$、$C_{\\text{sca}}$ 和 $C_{\\text{abs}}$ 分别表示单个粒子的消光、散射和吸收截面，消光效率为 $Q_{\\text{ext}} = C_{\\text{ext}}/(\\pi a^{2})$。每单位立体角的微分散射截面为 $dC_{\\text{sca}}/d\\Omega$，归一化相函数 $p(\\Omega)$ 满足 $\\int_{4\\pi} p(\\Omega)\\,d\\Omega = 1$ 且 $p(\\Omega) = \\frac{1}{C_{\\text{sca}}}\\frac{dC_{\\text{sca}}}{d\\Omega}$。不对称参数为 $g = \\int_{4\\pi} p(\\Omega)\\,\\cos\\theta\\,d\\Omega$，其中 $\\theta$ 是从入射光束方向测量的散射极角。\n\n仅使用能量守恒、上述定义、几何遮蔽以及针对几何截面为 $\\pi a^{2}$ 的完全吸收障碍物的 Babinet–diffraction 论证，确定单个粒子的不对称参数 $g$ 和消光效率 $Q_{\\text{ext}}$ 的渐近值（当 $x\\to\\infty$ 时）。将最终答案以行矩阵的形式 $\\big(g_{\\infty},\\,Q_{\\text{ext},\\infty}\\big)$ 表达。无需四舍五入，报告精确值。两个所求量均为无量纲，因此不需要单位。", "solution": "问题陈述已经过验证，被认为是具有科学依据、适定且客观的。它描述了大粒子光散射理论中的一个经典问题，通常称为消光佯谬。将根据问题中规定的原则推导求解。\n\n分析始于能量守恒。从入射光束中移除的总能量，由消光截面 $C_{\\text{ext}}$ 量化，是粒子吸收的能量 $C_{\\text{abs}}$ 和散射到所有方向的能量 $C_{\\text{sca}}$ 的总和。\n$$C_{\\text{ext}} = C_{\\text{abs}} + C_{\\text{sca}}$$\n所求的是这些量在尺寸参数 $x = 2\\pi a/\\lambda \\to \\infty$（其中 $a$ 为粒子半径，$\\lambda$ 为波长）极限下的渐近值。该极限对应于几何光学的范畴。\n\n首先，我们确定吸收截面 $C_{\\text{abs}}$。问题陈述粒子是完全吸收的，并且我们处于几何光学极限。这意味着光沿直线传播。任何几何上撞击粒子投影面积的光线都会被完全吸收。对于半径为 $a$ 的球体，其投影面积是面积为 $\\pi a^{2}$ 的圆盘。因此，粒子吸收的功率是入射辐照度与该面积的乘积。根据定义，吸收截面等于该几何截面。\n$$C_{\\text{abs}} = \\pi a^{2}$$\n\n接下来，我们确定散射截面 $C_{\\text{sca}}$。问题指定使用针对完全吸收障碍物的 Babinet–diffraction 论证，并明确指出没有镜面反射和透射。这意味着散射的唯一机制是入射波在粒子边缘的衍射。根据 Babinet's principle，不透明物体产生的衍射图样与同样大小和形状的孔径所产生的衍射图样相同，但在远前向方向除外。物体通过衍射散射的总功率等于通过相应孔径透射的功率。该功率是入射辐照度与孔径面积的乘积，同样是 $\\pi a^{2}$。因此，由衍射引起的散射截面为：\n$$C_{\\text{sca}} = \\pi a^{2}$$\n\n在确定了两个截面后，我们可以计算总消光截面：\n$$C_{\\text{ext}} = C_{\\text{abs}} + C_{\\text{sca}} = \\pi a^{2} + \\pi a^{2} = 2\\pi a^{2}$$\n\n消光效率 $Q_{\\text{ext}}$ 定义为消光截面除以粒子的几何截面 $\\pi a^{2}$ 进行归一化。在 $x \\to \\infty$ 的渐近极限下，该效率记为 $Q_{\\text{ext},\\infty}$，变为：\n$$Q_{\\text{ext},\\infty} = \\frac{C_{\\text{ext}}}{\\pi a^{2}} = \\frac{2\\pi a^{2}}{\\pi a^{2}} = 2$$\n这个结果，即大粒子从其物理截面上移除了两倍于入射能量的能量，就是消光佯谬。一个单位的截面解释了吸收，另一个单位的截面解释了衍射。\n\n现在，我们确定不对称参数 $g$。其定义为在所有立体角 $\\Omega$ 上的积分：\n$$g = \\int_{4\\pi} p(\\Omega)\\,\\cos\\theta\\,d\\Omega$$\n其中 $p(\\Omega)$ 是归一化相函数，$\\theta$ 是散射角。相函数定义为 $p(\\Omega) = \\frac{1}{C_{\\text{sca}}}\\frac{dC_{\\text{sca}}}{d\\Omega}$。因此，不对称参数可以写为：\n$$g = \\frac{1}{C_{\\text{sca}}} \\int_{4\\pi} \\frac{dC_{\\text{sca}}}{d\\Omega} \\cos\\theta \\,d\\Omega$$\n在我们建立的模型中，对散射的唯一贡献是衍射。对于大粒子（$x \\gg 1$），衍射瓣非常窄，并且在前向方向（$\\theta = 0$）上呈尖锐峰值。该瓣的特征角宽度量级为 $\\lambda/a = 2\\pi/x$。当 $x \\to \\infty$ 时，该角宽度趋近于 $0$。\n\n这意味着微分散射截面 $\\frac{dC_{\\text{sca}}}{d\\Omega}$ 仅在角度任意接近 $\\theta = 0$ 时才不为零。在 $x \\to \\infty$ 的极限下，积分的全部贡献来自于前向方向周围的一个无穷小立体角。在该区域内，$\\cos\\theta$ 的值无穷接近于 $\\cos(0) = 1$。因此，我们可以在极限情况下用 $1$ 替换积分内的 $\\cos\\theta$。\n$$g_{\\infty} = \\lim_{x\\to\\infty} g = \\frac{1}{C_{\\text{sca}}} \\int_{4\\pi} \\left(\\lim_{x\\to\\infty} \\frac{dC_{\\text{sca}}}{d\\Omega}\\right) (1) \\,d\\Omega$$\n根据定义，微分散射截面在所有立体角上的积分是总散射截面 $C_{\\text{sca}}$：\n$$\\int_{4\\pi} \\frac{dC_{\\text{sca}}}{d\\Omega} \\,d\\Omega = C_{\\text{sca}}$$\n因此，不对称参数的极限值为：\n$$g_{\\infty} = \\frac{1}{C_{\\text{sca}}} C_{\\text{sca}} = 1$$\n这个结果反映了一个事实，即来自大型吸收粒子的散射完全由前向衍射组成。\n\n所求的渐近值为 $g_{\\infty} = 1$ 和 $Q_{\\text{ext},\\infty} = 2$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$", "id": "2468121"}, {"introduction": "在理解了单个颗粒的基本散射特性后，下一步是处理实际参与介质中复杂的散射相函数。这个实践练习[@problem_id:2468089]是一个连接理论与应用的计算任务。你将学习如何处理离散的相函数测量数据，并应用强大的 delta-Eddington 近似方法，这对于简化求解高度前向散射介质中的辐射传输方程至关重要。通过亲手实现这一过程，你将掌握一种在工程和科研中广泛使用的实用建模技术。", "problem": "给定参与介质中一个方位角对称散射相函数的离散测量值，即在一系列点 $\\mu \\in [-1,1]$ 上的 $p(\\mu)$ 值，其中 $\\mu = \\cos(\\theta)$，$\\theta$ 是散射角。从辐射传输的第一性原理出发，推导如何从离散数据中估算不对称因子 $g$ 和相函数的二阶矩 $m_2$，然后构建一个等效的 delta-Eddington 表示。delta-Eddington 表示法将相函数分解为一个前向 delta 峰和一个关于 $\\mu$ 的线性余项。您的目标是：\n- 通过数值积分，从测量数据中计算不对称因子 $g$ 和二阶矩 $m_2$。\n- 确定前向 delta 权重 $f$ 和约化各向异性 $g'$，使得 delta-Eddington 表示法能保持零阶、一阶和二阶角矩。\n- 给定单次散射反照率 $\\omega_0$ 和光学深度 $\\tau$，计算 delta-Eddington 变换后的性质 $\\tau^\\star$、$\\omega_0^\\star$ 和 $g^\\star$，这些性质在双流近似中使用时，能够保留被移除的前向峰值的影响。\n\n需要使用的基本原理和定义：\n- 相函数 $p(\\mu)$ 被归一化，使得 $\\frac{1}{2}\\int_{-1}^{1} p(\\mu)\\,d\\mu = 1$。如果给定的数据集未归一化，您必须对其进行重新归一化以满足此条件。\n- 不对称因子为 $g = \\frac{1}{2}\\int_{-1}^{1} \\mu\\,p(\\mu)\\,d\\mu$。\n- 二阶矩为 $m_2 = \\frac{1}{2}\\int_{-1}^{1} \\mu^2\\,p(\\mu)\\,d\\mu$。\n- delta-Eddington 相函数的形式为 $p_{\\delta E}(\\mu) = 2 f\\,\\delta(1-\\mu) + (1-f)\\,(1 + 3 g'\\,\\mu)$，其中 $\\delta(\\cdot)$ 是集中在 $\\mu=1$ 处的狄拉克 delta 分布，$f \\in [0,1)$ 是前向 delta 权重，$g'$ 是余项的约化各向异性。\n- delta-Eddington 变换后的介质性质为 $\\tau^\\star = (1 - \\omega_0 f)\\,\\tau$，$\\omega_0^\\star = \\dfrac{(1-f)\\,\\omega_0}{1 - \\omega_0 f}$，以及 $g^\\star = \\dfrac{g - f}{1 - f}$。\n\n您的程序必须使用在 $\\mu$ 上应用梯形法则的数值积分，在提供的离散网格上实现上述计算。所有量均为无量纲；将所有输出报告为不带单位的纯数字。\n\n测试套件：\n对于每种情况，在 $[-1,1]$ 上使用一个包含 $N=1001$ 个点的均匀 $\\mu$ 网格。测量的相函数 $p(\\mu)$ 在下面按情况指定；如果 $p(\\mu)$ 是以未归一化的形状给出的，您必须在计算 $g$ 和 $m_2$ 之前将其重新归一化为 $p(\\mu)$，以满足 $\\frac{1}{2}\\int_{-1}^{1} p(\\mu)\\,d\\mu = 1$。\n\n- 情况 A（类瑞利，小尺寸参数）：尺寸参数 $x = 0.1$，单次散射反照率 $\\omega_0 = 1.0$，光学深度 $\\tau = 0.5$。使用 $p(\\mu) = \\frac{3}{4}\\,(1+\\mu^2)$，该函数已经归一化。\n- 情况 B（具有强前向散射的 Henyey–Greenstein）：尺寸参数 $x = 30$，单次散射反照率 $\\omega_0 = 0.95$，光学深度 $\\tau = 3.0$。使用目标不对称因子 $g_0 = 0.85$ 的 Henyey–Greenstein 函数生成 $p(\\mu)$，\n  $$\n  p(\\mu) = \\frac{1 - g_0^2}{\\left(1 + g_0^2 - 2 g_0 \\mu\\right)^{3/2}},\n  $$\n  该函数满足 $\\frac{1}{2}\\int_{-1}^{1} p(\\mu)\\,d\\mu = 1$。\n- 情况 C（各向同性散射）：尺寸参数 $x = 3$，单次散射反照率 $\\omega_0 = 0.8$，光学深度 $\\tau = 1.0$。使用 $p(\\mu) = 1$，该函数已经归一化。\n- 情况 D（合成的窄前向波瓣）：尺寸参数 $x = 100$，单次散射反照率 $\\omega_0 = 0.99$，光学深度 $\\tau = 5.0$。构建一个未归一化的形状\n  $$\n  \\tilde{p}(\\mu) = 1 + A \\exp\\!\\left(-\\frac{(1-\\mu)^2}{2\\sigma^2}\\right),\n  $$\n  其中 $A = 100$ 和 $\\sigma = 0.05$，然后将 $\\tilde{p}(\\mu)$ 重新归一化为 $p(\\mu)$，以满足 $\\frac{1}{2}\\int_{-1}^{1} p(\\mu)\\,d\\mu = 1$。\n\n计算与输出：\n- 对于每种情况，按顺序计算：$g$、$m_2$、$f$、$g'$、$\\tau^\\star$、$\\omega_0^\\star$ 和 $g^\\star$。\n- 通过匹配二阶矩来选择 $f$，即强制 $\\frac{1}{2}\\int_{-1}^{1} \\mu^2 p_{\\delta E}(\\mu)\\,d\\mu = m_2$，这会得到 $f = \\frac{3 m_2 - 1}{2}$。如果数值误差导致 $f$ 略微超出 $[0,1)$，则将其限制在 $[0, 0.999999]$ 范围内以避免除以零。然后设置 $g' = \\frac{g - f}{1 - f}$ 和 $g^\\star = \\frac{g - f}{1 - f}$；如果在数值公差范围内 $f$ 等于 $1$，则设置 $g' = 0$ 和 $g^\\star = 0$。\n- 您的程序应生成单行输出，其中包含一个列表的列表，每个子列表对应一种情况，包含按上述顺序排列的七个数字，每个数字四舍五入到六位小数。该行不得包含任何空格。例如：\"[[gA,m2A,fA,gpA,tauAstar,omega0Astar,gAstar],[gB,m2B,fB,gpB,tauBstar,omega0Bstar,gBstar],...]\"。\n\n所有输出均为无量纲数。角度（如果有）通过 $\\mu$ 表示，不使用明确的角度单位。不得使用百分比；所有输出均为小数。", "solution": "所提出的问题是辐射传热领域一个明确定义的练习。它要求用一种更简单、可解析处理的形式，即所谓的 delta-Eddington 相函数 $p_{\\delta E}(\\mu)$，来近似给定的散射相函数 $p(\\mu)$。该过程在科学上是合理的，并涉及处理参与介质中各向异性散射的标准技术。验证证实了问题陈述的所有方面都是严谨、完整且与既定原则一致的。我们将从第一性原理出发进行求解。\n\n核心任务是通过匹配原始相函数的前三个角矩来确定 delta-Eddington 近似的参数。程序步骤如下：\n\n1.  **相函数的归一化**\n    散射相函数 $p(\\mu)$ 描述了散射辐射的角度分布。按照惯例，它被归一化，使其在所有立体角上的积分为1。对于方位角对称函数，此条件为：\n    $$\n    \\frac{1}{2}\\int_{-1}^{1} p(\\mu)\\,d\\mu = 1\n    $$\n    其中 $\\mu = \\cos(\\theta)$ 是散射角的余弦。提供的离散数据必须满足此条件的离散模拟。如果给定一个未归一化的形状函数 $\\tilde{p}(\\mu)$，我们首先通过数值积分计算归一化常数 $C$：\n    $$\n    C = \\frac{1}{2}\\int_{-1}^{1} \\tilde{p}(\\mu)\\,d\\mu\n    $$\n    然后，归一化后的相函数为 $p(\\mu) = \\tilde{p}(\\mu) / C$。对于所有计算，我们将在提供的均匀 $\\mu$ 值网格上使用梯形法则进行数值积分。\n\n2.  **相函数矩的计算**\n    相函数的角度特性由其矩来概括。前两个非平凡矩是不对称因子 $g$ 和二阶矩 $m_2$。\n    不对称因子 $g$ 是一阶矩，表示散射角余弦的平均值，指示前向或后向散射的程度。其定义为：\n    $$\n    g = \\frac{1}{2}\\int_{-1}^{1} \\mu\\,p(\\mu)\\,d\\mu\n    $$\n    二阶矩 $m_2$ 定义为：\n    $$\n    m_2 = \\frac{1}{2}\\int_{-1}^{1} \\mu^2\\,p(\\mu)\\,d\\mu\n    $$\n    我们通过对归一化后的离散相函数数据应用梯形法则来计算这些值。\n\n3.  **Delta-Eddington 近似**\n    对于强前向散射的相函数，用一种能分离出尖锐前向峰值的形式来近似 $p(\\mu)$ 在计算上是有利的。delta-Eddington 近似通过将相函数表示为前向（$\\mu=1$）的狄拉克 delta 函数与一个各向异性的、线性变化的余项（Eddington 近似）之和来实现这一点：\n    $$\n    p_{\\delta E}(\\mu) = 2 f\\,\\delta(1-\\mu) + (1-f)\\,(1 + 3 g'\\,\\mu)\n    $$\n    这里，$f$ 是散射到前向峰值的能量分数，$g'$ 是剩余的宽散射部分的约化不对称因子。参数 $f$ 和 $g'$ 通过强制保持 $p(\\mu)$ 的矩来确定。\n\n    -   $p_{\\delta E}(\\mu)$ 的零阶矩（归一化）是固有守恒的：\n        $$\n        \\frac{1}{2}\\int_{-1}^{1} p_{\\delta E}(\\mu)\\,d\\mu = \\frac{1}{2}\\left[ 2f\\int_{-1}^{1}\\delta(1-\\mu)\\,d\\mu + (1-f)\\int_{-1}^{1}(1+3g'\\mu)\\,d\\mu \\right] = f + (1-f) = 1\n        $$\n    -   为了找到 $f$，我们将 $p_{\\delta E}(\\mu)$ 的二阶矩 $m_2$ 与原始 $p(\\mu)$ 的二阶矩相匹配：\n        $$\n        m_2 = \\frac{1}{2}\\int_{-1}^{1} \\mu^2 p_{\\delta E}(\\mu)\\,d\\mu = \\frac{1}{2}\\left[ 2f\\int_{-1}^{1}\\mu^2\\delta(1-\\mu)\\,d\\mu + (1-f)\\int_{-1}^{1}\\mu^2(1+3g'\\mu)\\,d\\mu \\right]\n        $$\n        $$\n        m_2 = f \\cdot 1^2 + \\frac{1-f}{2} \\left[ \\frac{\\mu^3}{3} \\right]_{-1}^{1} = f + \\frac{1-f}{3} = \\frac{1+2f}{3}\n        $$\n        求解 $f$ 得到所需关系式：\n        $$\n        f = \\frac{3 m_2 - 1}{2}\n        $$\n    -   为了找到 $g'$，我们匹配一阶矩 $g$：\n        $$\n        g = \\frac{1}{2}\\int_{-1}^{1} \\mu p_{\\delta E}(\\mu)\\,d\\mu = \\frac{1}{2}\\left[ 2f\\int_{-1}^{1}\\mu \\delta(1-\\mu)\\,d\\mu + (1-f)\\int_{-1}^{1}\\mu(1+3g'\\mu)\\,d\\mu \\right]\n        $$\n        $$\n        g = f \\cdot 1 + \\frac{1-f}{2} \\left[ 3g' \\frac{\\mu^3}{3} \\right]_{-1}^{1} = f + (1-f)g'\n        $$\n        求解 $g'$ 得到：\n        $$\n        g' = \\frac{g-f}{1-f}\n        $$\n\n4.  **宏观性质的变换**\n    Delta-Eddington 近似通过从积分源项中移除前向散射峰值，并将其效应并入消光系数，从而简化了辐射传输方程。这产生了一个具有缩放性质（$\\tau^\\star, \\omega_0^\\star, g^\\star$）的变换后方程，这些性质必须在后续计算（例如，双流近似）中使用。这些变换是：\n    -   变换后的光学深度：$\\tau^\\star = (1 - \\omega_0 f)\\,\\tau$\n    -   变换后的单次散射反照率：$\\omega_0^\\star = \\dfrac{(1-f)\\,\\omega_0}{1 - \\omega_0 f}$\n    -   变换后的不对称因子：$g^\\star = g' = \\dfrac{g - f}{1 - f}$\n    参数 $g^\\star$ 是相函数中经 Eddington 近似部分的不对称因子。\n\n计算算法将为每个提供的测试案例实施这四个步骤。将按规定将 $f$ 的值限制在 $[0, 0.999999]$ 范围内，以确保数值稳定性。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes delta-Eddington parameters for various phase functions.\n    \"\"\"\n\n    # Define the test cases as specified in the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"p_func\": lambda mu, p: 0.75 * (1 + mu**2),\n            \"omega0\": 1.0,\n            \"tau\": 0.5,\n            \"params\": {}\n        },\n        {\n            \"name\": \"Case B\",\n            \"p_func\": lambda mu, p: (1 - p['g0']**2) / (1 + p['g0']**2 - 2 * p['g0'] * mu)**1.5,\n            \"omega0\": 0.95,\n            \"tau\": 3.0,\n            \"params\": {'g0': 0.85}\n        },\n        {\n            \"name\": \"Case C\",\n            \"p_func\": lambda mu, p: np.ones_like(mu),\n            \"omega0\": 0.8,\n            \"tau\": 1.0,\n            \"params\": {}\n        },\n        {\n            \"name\": \"Case D\",\n            \"p_func\": lambda mu, p: 1 + p['A'] * np.exp(-(1 - mu)**2 / (2 * p['sigma']**2)),\n            \"omega0\": 0.99,\n            \"tau\": 5.0,\n            \"params\": {'A': 100, 'sigma': 0.05}\n        }\n    ]\n\n    # Setup the numerical grid\n    N = 1001\n    mu = np.linspace(-1, 1, N, dtype=np.float64)\n\n    all_results = []\n\n    for case in test_cases:\n        p_func = case[\"p_func\"]\n        omega0 = case[\"omega0\"]\n        tau = case[\"tau\"]\n        params = case[\"params\"]\n\n        # 1. Evaluate phase function and normalize the discrete data\n        p_values = p_func(mu, params)\n        \n        # The normalization constant C is computed via numerical integration\n        C = 0.5 * np.trapz(p_values, mu)\n        p_normalized = p_values / C\n\n        # 2. Compute moments g and m_2\n        # Asymmetry parameter g (first moment)\n        integrand_g = mu * p_normalized\n        g = 0.5 * np.trapz(integrand_g, mu)\n\n        # Second moment m_2\n        integrand_m2 = mu**2 * p_normalized\n        m_2 = 0.5 * np.trapz(integrand_m2, mu)\n        \n        # 3. Compute delta-Eddington parameters f and g'\n        f = (3.0 * m_2 - 1.0) / 2.0\n        \n        # Clamp f to the specified range [0, 0.999999] for numerical stability\n        f = np.clip(f, 0.0, 0.999999)\n\n        # The denominator (1-f) is safe from being zero due to the clamping\n        g_prime = (g - f) / (1.0 - f)\n\n        # 4. Compute transformed macroscopic properties\n        g_star = g_prime\n        tau_star = (1.0 - omega0 * f) * tau\n        \n        denominator_omega_star = 1.0 - omega0 * f\n        omega0_star = (1.0 - f) * omega0 / denominator_omega_star\n        \n        # Store results for this case\n        case_results = [g, m_2, f, g_prime, tau_star, omega0_star, g_star]\n        all_results.append(case_results)\n\n    # Format the final output string as per the requirements\n    output_parts = []\n    for res_list in all_results:\n        # Round each value to six decimal places and format as a string\n        rounded_res = [f\"{x:.6f}\" for x in res_list]\n        output_parts.append(f\"[{','.join(rounded_res)}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n    \n    # Print the single-line result\n    print(final_output_string)\n\nsolve()\n```", "id": "2468089"}, {"introduction": "本章的最后一个练习是一个综合性问题，它将吸收、发射和辐射平衡等核心概念融为一体。这个问题[@problem_id:2468135]要求你从基本的辐射传输方程出发，通过应用经典的 $P_1$ 近似方法，最终推导出非等温平板中的温度分布。这个练习完美地展示了如何运用辐射传输原理来解决实际的传热问题，是检验和巩固本章所学知识的绝佳机会。", "problem": "一个厚度为 $L$ 的平面一维板中充满了静态、灰体、吸收-发射、非散射的介质，其单次散射反照率为 $\\omega=0$。光谱吸收系数为 $\\kappa_{\\lambda}(T)$，介质处于局部热力学平衡（LTE）状态，因此光谱发射系数满足基尔霍夫定律 $j_{\\lambda}=\\kappa_{\\lambda} B_{\\lambda}(T)$，其中 $B_{\\lambda}(T)$ 是普朗克函数。不存在传导和对流。该板由位于 $x=0$ 和 $x=L$ 处的两个漫射黑体壁面界定，其温度分别固定为 $T_{0}$ 和 $T_{L}$。板外是冷真空。\n\n从光谱辐射传输方程和辐射平衡（稳态下无净体积加热）的表述出发，完成以下任务：\n\n- 在给定假设和 $\\omega=0$ 的条件下，证明对于每个位置 $x$ 和每个波长 $\\lambda$（其中 $\\kappa_{\\lambda}0$），光谱平均强度等于普朗克函数，即 $J_{\\lambda}(x)=B_{\\lambda}(T(x))$。\n\n- 然后，采用灰体介质极限，其中灰体吸收系数 $\\kappa$ 为常数，并使用由爱丁顿（一阶球谐，$P_{1}$）近似封闭的角矩方程，以获得板内温度分布 $T(x)$ 关于 $T_{0}$、$T_{L}$、$L$ 和 $\\kappa$ 的显式解析表达式。在 $x=0$ 和 $x=L$ 处使用适用于 $P_{1}$ 近似的漫射-黑体边界条件。将光学深度定义为 $\\tau=\\kappa x$，总光学厚度定义为 $\\tau_{L}=\\kappa L$，并将最终答案明确表示为 $T(x)$（等效于 $T(\\tau)$）的单个解析函数。\n\n将最终答案表示为 $T(x)$ 的闭式表达式，无需进行数值计算或四舍五入。在问题设置中，温度必须以开尔文为单位；最终表达式中不要包含单位。", "solution": "对问题陈述进行严格评估如下。\n\n已知条件：\n1.  几何：厚度为 $L$ 的平面一维板。\n2.  介质属性：静态、灰体、吸收-发射、非散射。\n3.  单次散射反照率：$\\omega=0$。\n4.  吸收系数：光谱吸收系数 $\\kappa_{\\lambda}(T)$ 和常数灰体吸收系数 $\\kappa$。\n5.  热力学状态：局部热力学平衡 (LTE)。\n6.  基尔霍夫定律：$j_{\\lambda}=\\kappa_{\\lambda} B_{\\lambda}(T)$。\n7.  能量传输：不存在传导和对流。\n8.  边界条件：位于 $x=0$ 和 $x=L$ 处的漫射黑体壁面。\n9.  边界温度：$T(x=0) = T_{0}$，$T(x=L) = T_{L}$。\n10. 外部环境：冷真空。\n11. 稳态条件：辐射平衡（无净体积加热）。\n12. 近似方法：爱丁顿（$P_{1}$）近似及其相应的漫射-黑体边界条件。\n13. 定义：光学深度 $\\tau = \\kappa x$，总光学厚度 $\\tau_{L}=\\kappa L$。\n\n验证：\n该问题是辐射传热领域一个经典的、适定的问题。它具有科学依据，使用了诸如辐射传输方程（RTE）、基尔霍夫定律和 $P_{1}$ 近似等既定原理。各项假设内部一致：非散射介质意味着 $\\omega=0$，而 LTE 证明了使用基尔霍夫定律的合理性。辐射平衡的表述为求解稳态温度分布提供了必要条件。边界条件已明确指定。该问题是客观的，表述精确，并包含唯一解所需的所有信息。因此，该问题被认为是有效的。\n\n第1部分：证明 $J_{\\lambda}(x)=B_{\\lambda}(T(x))$\n\n对于一维平面平行介质，在由 $\\mu = \\cos\\theta$ 指定的方向上，光谱辐射传输方程（RTE）为：\n$$ \\mu \\frac{dI_{\\lambda}(x, \\mu)}{dx} = j_{\\lambda} - \\kappa_{\\lambda} I_{\\lambda} - \\sigma_{s,\\lambda} I_{\\lambda} + \\frac{\\sigma_{s,\\lambda}}{2} \\int_{-1}^{1} I_{\\lambda}(x, \\mu') \\Phi(\\mu', \\mu) d\\mu' $$\n问题陈述介质为非散射，因此散射系数 $\\sigma_{s,\\lambda}=0$。这与单次散射反照率 $\\omega = \\sigma_{s,\\lambda} / (\\kappa_{\\lambda} + \\sigma_{s,\\lambda}) = 0$ 一致。介质处于局部热力学平衡（LTE）状态，因此基尔霍夫定律通过普朗克函数 $B_{\\lambda}(T)$ 将光谱发射系数 $j_{\\lambda}$ 与光谱吸收系数 $\\kappa_{\\lambda}$ 联系起来：$j_{\\lambda} = \\kappa_{\\lambda} B_{\\lambda}(T)$。在这些条件下，RTE 大大简化为：\n$$ \\mu \\frac{dI_{\\lambda}(x, \\mu)}{dx} = \\kappa_{\\lambda}(T(x)) [B_{\\lambda}(T(x)) - I_{\\lambda}(x, \\mu)] $$\n辐射平衡条件规定介质内部没有净的体积能量生成或损失。这表示为辐射热通量矢量的散度为零，$\\nabla \\cdot \\vec{q}_r = 0$。对于一维板，这变为 $\\frac{dq_r}{dx}=0$。通量的散度也等于光谱积分的净体积发射：\n$$ \\frac{dq_r}{dx} = \\int_{0}^{\\infty} \\left( \\int_{4\\pi} (j_{\\lambda} - \\kappa_{\\lambda} I_{\\lambda}) d\\Omega \\right) d\\lambda = 0 $$\n代入 $j_{\\lambda} = \\kappa_{\\lambda} B_{\\lambda}(T)$，并注意到立体角积分为 $\\int_{4\\pi} d\\Omega = 2\\pi \\int_{-1}^{1} d\\mu$：\n$$ \\frac{dq_r}{dx} = \\int_{0}^{\\infty} \\kappa_{\\lambda} \\left( 2\\pi \\int_{-1}^{1} [B_{\\lambda}(T) - I_{\\lambda}(x,\\mu)] d\\mu \\right) d\\lambda = 0 $$\n由于普朗克函数 $B_{\\lambda}(T)$ 是各向同性的（与方向 $\\mu$ 无关），因此 $\\int_{-1}^{1} B_{\\lambda}(T) d\\mu = 2B_{\\lambda}(T)$。光谱平均强度定义为 $J_{\\lambda}(x) = \\frac{1}{4\\pi} \\int_{4\\pi} I_{\\lambda} d\\Omega = \\frac{1}{2} \\int_{-1}^{1} I_{\\lambda}(x,\\mu) d\\mu$。因此，方程变为：\n$$ \\frac{dq_r}{dx} = 4\\pi \\int_{0}^{\\infty} \\kappa_{\\lambda}(x) [B_{\\lambda}(T(x)) - J_{\\lambda}(x)] d\\lambda = 0 $$\n该方程表明，介质在所有波长上吸收的总能量等于其发射的总能量。在不存在散射、传导和对流的纯吸收-发射介质中，没有物理机制可以将能量从一个波长转移到另一个波长。因此，为使系统处于稳态，每个波长都必须满足细致平衡。每个特定波长处的净能量交换必须为零。这要求被积函数对于每个 $\\lambda$ 都为零：\n$$ \\kappa_{\\lambda}(x) [B_{\\lambda}(T(x)) - J_{\\lambda}(x)] = 0 $$\n对于介质参与的任何波长（即 $\\kappa_{\\lambda}  0$），以下关系必须成立：\n$$ J_{\\lambda}(x) = B_{\\lambda}(T(x)) $$\n这证明了所要求的关系。\n\n第2部分：用于温度分布的 $P_{1}$ 近似\n\n我们现在采用灰体介质模型，其中吸收系数 $\\kappa$ 为常数。对于灰体介质，RTE 的前两个角矩方程是：\n1.  零阶矩：$\\frac{d q_r}{dx} = \\kappa(G - 4\\pi B)$，其中 $G = 4\\pi J$ 是入射辐射，$B = \\int_0^{\\infty} B_\\lambda d\\lambda = \\frac{\\sigma T^4}{\\pi}$。\n2.  一阶矩：$\\frac{dG}{dx} = -3\\kappa q_r$。这是 $P_{1}$ 闭合关系，其中我们假设了各向同性散射（由于散射为零，这一点没有实际意义），并使用了将入射辐射梯度与热通量 $q_r$ 相关联的标准形式。\n\n根据辐射平衡条件，$\\frac{dq_r}{dx} = 0$。这蕴含两点：\na) 辐射热通量 $q_r$ 在整个板内是恒定的。\nb) 根据零阶矩方程，$\\kappa(G - 4\\pi B) = 0$。由于 $\\kappa \\neq 0$，我们有 $G(x) = 4\\pi B(T(x)) = 4\\sigma T(x)^4$。\n\n我们对一阶矩方程进行积分：\n$\\int dG = \\int -3\\kappa q_r dx \\implies G(x) = -3\\kappa q_r x + C$\n其中 $C$ 是一个积分常数。代入 $G(x) = 4\\sigma T(x)^4$：\n$4\\sigma T(x)^4 = -3\\kappa q_r x + C$\n我们有两个未知数，即常数通量 $q_r$ 和常数 $C$。我们使用边界条件来确定它们。对于 $P_{1}$ 近似，Marshak 边界条件适用于漫射表面。对于黑体壁面（$\\epsilon=1$），出射强度纯粹是发射性的。\n在 $x=0$ 处，温度为 $T_0$ 的壁面向正 x 半球发射。离开壁面的辐射通量为 $q_r^{+}(0) = \\sigma T_0^4$。在 $P_{1}$ 近似中，该通量由 $q_r^{+}(x) = \\frac{G(x)}{4} + \\frac{q_r}{2}$ 给出。因此，在 $x=0$ 处：\n$$ \\frac{G(0)}{4} + \\frac{q_r}{2} = \\sigma T_0^4 \\quad (1) $$\n在 $x=L$ 处，温度为 $T_L$ 的壁面向负 x 半球发射。该通量的大小为 $q_r^{-}(L) = \\sigma T_L^4$。在 $P_{1}$ 近似中，$q_r^{-}(x) = \\frac{G(x)}{4} - \\frac{q_r}{2}$。因此，在 $x=L$ 处：\n$$ \\frac{G(L)}{4} - \\frac{q_r}{2} = \\sigma T_L^4 \\quad (2) $$\n我们现在求解 $q_r$ 和 $C$。\n由 $G(x) = -3\\kappa q_r x + C$，我们有 $G(0) = C$ 和 $G(L) = -3\\kappa q_r L + C$。\n将这些代入边界条件：\n由 (1)：$\\frac{C}{4} + \\frac{q_r}{2} = \\sigma T_0^4 \\implies C = 4\\sigma T_0^4 - 2q_r$。\n由 (2)：$\\frac{-3\\kappa q_r L + C}{4} - \\frac{q_r}{2} = \\sigma T_L^4 \\implies -3\\kappa q_r L + C - 2q_r = 4\\sigma T_L^4$。\n\n将 $C$ 的表达式代入修改后的第二个方程：\n$$ -3\\kappa q_r L + (4\\sigma T_0^4 - 2q_r) - 2q_r = 4\\sigma T_L^4 $$\n$$ -3\\kappa q_r L - 4q_r = 4\\sigma T_L^4 - 4\\sigma T_0^4 $$\n$$ q_r (-3\\kappa L - 4) = 4\\sigma (T_L^4 - T_0^4) $$\n$$\nq_r = \\frac{4\\sigma (T_0^4 - T_L^4)}{3\\kappa L + 4}\n$$\n现在我们求 $T(x)$ 的表达式。我们有 $4\\sigma T(x)^4 = G(x) = -3\\kappa q_r x + C$。\n使用 $C = 4\\sigma T_0^4 - 2q_r$：\n$$ 4\\sigma T(x)^4 = -3\\kappa q_r x + 4\\sigma T_0^4 - 2q_r = 4\\sigma T_0^4 - q_r(3\\kappa x + 2) $$\n两边除以 $4\\sigma$：\n$$ T(x)^4 = T_0^4 - \\frac{q_r}{4\\sigma}(3\\kappa x + 2) $$\n代入 $q_r$ 的表达式：\n$$ T(x)^4 = T_0^4 - \\frac{4\\sigma (T_0^4 - T_L^4)}{4\\sigma (3\\kappa L + 4)}(3\\kappa x + 2) = T_0^4 - (T_0^4 - T_L^4) \\frac{3\\kappa x + 2}{3\\kappa L + 4} $$\n这个表达式可以重排成一个更对称的形式：\n$$ T(x)^4 = T_0^4 \\left( 1 - \\frac{3\\kappa x + 2}{3\\kappa L + 4} \\right) + T_L^4 \\left( \\frac{3\\kappa x + 2}{3\\kappa L + 4} \\right) $$\n$$ T(x)^4 = T_0^4 \\left( \\frac{3\\kappa L + 4 - 3\\kappa x - 2}{3\\kappa L + 4} \\right) + T_L^4 \\left( \\frac{3\\kappa x + 2}{3\\kappa L + 4} \\right) $$\n$$ T(x)^4 = T_0^4 \\frac{3\\kappa(L-x) + 2}{3\\kappa L + 4} + T_L^4 \\frac{3\\kappa x + 2}{3\\kappa L + 4} $$\n取四次方根得到温度分布 $T(x)$ 的最终表达式。", "answer": "$$ \\boxed{ T(x) = \\left( T_{0}^{4} \\frac{3\\kappa(L-x) + 2}{3\\kappa L + 4} + T_{L}^{4} \\frac{3\\kappa x + 2}{3\\kappa L + 4} \\right)^{\\frac{1}{4}} } $$", "id": "2468135"}]}