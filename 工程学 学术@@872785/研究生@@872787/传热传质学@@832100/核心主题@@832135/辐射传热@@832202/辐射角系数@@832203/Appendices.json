{"hands_on_practices": [{"introduction": "要精确地应用辐射换热原理，首先必须清晰地辨别其中的基本概念。本练习旨在巩固角系数的纯几何本质，并将其与依赖于表面属性（如吸收率）的实际能量吸收过程区分开来。通过分析一系列陈述，您将加深对角系数为何独立于材料物理特性，以及它如何在更广泛的能量交换计算中作为基础输入的理解 [@problem_id:2518540]。", "problem": "一个等温、真空的凸形腔体由 $N \\ge 3$ 个不透明的漫-灰表面 $\\{1,2,\\dots,N\\}$ 构成，它们的面积为 $\\{A_1,\\dots,A_N\\}$，漫射半球吸收率为 $\\{\\alpha_1,\\dots,\\alpha_N\\}$（其中 $\\rho_i = 1 - \\alpha_i$ 为漫射反射率）。表面的发射和反射均为理想漫射，介质为非参与性介质，且所有光学性质均为灰色（与波长无关）。考虑一个概念性实验，其中一定量的辐射能 $Q$ 从表面 $i$ 均匀且漫射地发射到腔体中，而其余表面则根据其所述属性进行响应。定义：\n- 角系数（或形态因子）$F_{ij}$ 为离开表面 $i$ 的漫射能量中，未经任何反射直接投射到表面 $j$ 上的份额。\n- 首次吸收份额 $p_{ij}^{(1)}$ 为在能量首次投射到表面 $j$ 上时，被表面 $j$ 吸收的 $Q$ 的份额（即，在任何地方发生任何反射之前）。\n- 最终吸收份额 $p_{ij}^{(\\infty)}$ 为在所有腔体表面之间发生任意多次漫反射之后，最终被表面 $j$ 吸收的 $Q$ 的份额。\n\n仅使用漫射发射和反射、几何交换以及能量守恒的基本定义，判断对于任意指定的腔体几何形状和属性，下列哪些陈述是正确的。\n\nA. 对于任意腔体几何形状和漫-灰表面，$p_{ij}^{(1)} = \\alpha_j F_{ij}$。\n\nB. 对于任意腔体几何形状和漫-灰表面，$p_{ij}^{(\\infty)} = F_{ij}$ 与 $\\{\\alpha_k\\}$ 无关。\n\nC. 如果腔体中的每个表面都是黑体（即，对于所有 $k$，$\\alpha_k = 1$），则 $p_{ij}^{(\\infty)} = F_{ij}$。\n\nD. 角系数 $F_{ij}$ 取决于表面属性 $\\{\\alpha_k\\}$ 和 $\\{\\varepsilon_k\\}$，而与几何形状无关。\n\nE. 互易关系 $A_i F_{ij} = A_j F_{ji}$ 源于能量守恒，并且独立于表面发射率和吸收率。\n\nF. 在一个仅由表面 1 和 2 组成的双表面腔体中，最终吸收份额 $p_{12}^{(\\infty)}$ 不依赖于 $\\alpha_1$。\n\n选择所有适用的选项。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 腔体类型：等温、真空、凸形。\n- 表面数量：$N \\ge 3$。\n- 表面属性：不透明、漫-灰。\n- 表面面积：$\\{A_1, A_2, \\dots, A_N\\}$。\n- 漫射半球吸收率：$\\{\\alpha_1, \\alpha_2, \\dots, \\alpha_N\\}$。\n- 漫射反射率：$\\rho_i = 1 - \\alpha_i$。\n- 发射/反射行为：理想漫射。\n- 介质：非参与性。\n- 光学性质：灰色（与波长无关）。\n- 实验条件：一定量的辐射能 $Q$ 从表面 $i$ 均匀且漫射地发射。\n- 角系数 $F_{ij}$ 的定义：离开表面 $i$ 的漫射能量中，未经任何反射直接投射到表面 $j$ 上的份额。\n- 首次吸收份额 $p_{ij}^{(1)}$ 的定义：在首次投射到表面 $j$ 上时，被表面 $j$ 吸收的 $Q$ 的份额。\n- 最终吸收份额 $p_{ij}^{(\\infty)}$ 的定义：经过任意多次漫反射后，最终被表面 $j$ 吸收的 $Q$ 的份额。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于腔体内辐射传热的基本且公认的原理。漫-灰表面、角系数、辐射度和能量守恒等概念是该领域的标准内容。\n- **适定性**：该问题是适定的。它提供了清晰和标准的定义，并要求基于这些定义和第一性原理对几个陈述进行评估。可以确定一组唯一的正确和不正确的陈述。\n- **客观性**：语言技术性强、精确且客观。\n- **潜在缺陷分析**：\n  - 问题陈述腔体是“凸形”的。在标准术语中，这意味着没有表面可以看到自身，即对于所有 $i$，$F_{ii}=0$。这是一个常见的简化假设，并不会使问题无效，因为所要测试的基本原理是通用的。\n  - 问题还陈述腔体是“等温”的。这通常意味着所有表面都处于相同温度，导致平衡时净传热为零。然而，问题引入了一个思想实验，从一个表面注入能量 $Q$。这是计算辐射交换因子的标准方法，并不矛盾。它分析的是特定能量的去向，而不是热平衡中的净交换。\n  - 注意到了约束条件 $N \\ge 3$。其中一个选项（F）考虑了 $N=2$ 的情况，这在技术上超出了指定范围。然而，这一疏忽并未使核心问题设置无效。我们将在评估该陈述的物理有效性的同时，指出这一差异。\n\n**步骤3：结论与行动**\n问题陈述被认为是**有效的**。它提出了辐射传热领域一个标准而严谨的问题。我们继续进行求解。\n\n***\n\n**陈述分析**\n\n**A. 对于任意腔体几何形状和漫-灰表面，$p_{ij}^{(1)} = \\alpha_j F_{ij}$。**\n根据定义，$F_{ij}$ 是离开表面 $i$ 的能量中直接投射到表面 $j$ 的份额。\n鉴于从表面 $i$ 发射的总能量为 $Q$，直接投射到表面 $j$ 的能量为 $Q_{i\\to j, direct} = Q \\cdot F_{ij}$。\n表面 $j$ 是一个吸收率为 $\\alpha_j$ 的漫-灰表面。它吸收的入射辐射的份额是 $\\alpha_j$。\n表面 $j$ 在这首次投射时吸收的能量是 $Q_{abs, j}^{(1)} = Q_{i\\to j, direct} \\cdot \\alpha_j = (Q \\cdot F_{ij}) \\cdot \\alpha_j$。\n首次吸收份额 $p_{ij}^{(1)}$ 定义为该吸收能量与从 $i$ 发射的总能量之比：\n$$p_{ij}^{(1)} = \\frac{Q_{abs, j}^{(1)}}{Q} = \\frac{Q F_{ij} \\alpha_j}{Q} = \\alpha_j F_{ij}$$\n此推导仅依赖于所提供的定义。\n该陈述是**正确的**。\n\n**B. 对于任意腔体几何形状和漫-灰表面，$p_{ij}^{(\\infty)} = F_{ij}$ 与 $\\{\\alpha_k\\}$ 无关。**\n最终吸收份额 $p_{ij}^{(\\infty)}$ 考虑了多次反射后吸收的能量。反射过程涉及表面的反射率属性 $\\rho_k = 1 - \\alpha_k$。因此，能量的最终分布必须取决于腔体中所有表面的吸收率 $\\{\\alpha_k\\}$。\n要反驳该陈述，我们只需要一个反例。考虑表面 $j$ 是一个理想反射体，即 $\\alpha_j=0$ 的情况。在这种情况下，表面 $j$ 不能吸收任何能量，所以它吸收的能量必须为零。因此，$p_{ij}^{(\\infty)} = 0$。然而，角系数 $F_{ij}$ 是一个纯粹的几何量，对于一个通用腔体可以是非零的。对于这种情况，$p_{ij}^{(\\infty)} = 0 \\ne F_{ij}$。\n这表明 $p_{ij}^{(\\infty)}$ 并非独立于 $\\{\\alpha_k\\}$。\n该陈述是**不正确的**。\n\n**C. 如果腔体中的每个表面都是黑体（即，对于所有 $k$，$\\alpha_k = 1$），则 $p_{ij}^{(\\infty)} = F_{ij}$。**\n如果每个表面 $k$ 都是黑体，其吸收率为 $\\alpha_k=1$。因此，其反射率为 $\\rho_k = 1 - \\alpha_k = 0$。\n当所有表面的 $\\rho_k=0$ 时，腔体内任何地方都没有反射。任何投射到任何表面上的辐射都被完全吸收。\n由表面 $i$ 发射的能量 $Q$ 在腔体内传播。一部分 $F_{ij}$ 直接照射到表面 $j$。任何其他部分 $F_{ik}$（其中 $k \\ne j$）照射到表面 $k$ 并被完全吸收。这些能量中没有一部分会反射并随后到达表面 $j$。\n因此，从 $i$ 发出而被 $j$ 吸收的唯一能量是首次投射时吸收的能量。“最终”吸收份额与“首次”吸收份额相同：$p_{ij}^{(\\infty)} = p_{ij}^{(1)}$。\n根据对陈述 A 的分析，$p_{ij}^{(1)} = \\alpha_j F_{ij}$。\n鉴于表面 $j$ 是黑体，$\\alpha_j=1$。\n因此，$p_{ij}^{(\\infty)} = 1 \\cdot F_{ij} = F_{ij}$。\n该陈述是**正确的**。\n\n**D. 角系数 $F_{ij}$ 取决于表面属性 $\\{\\alpha_k\\}$ 和 $\\{\\varepsilon_k\\}$，而与几何形状无关。**\n角系数，或称形态因子，$F_{ij}$，是由系统的几何形状定义的。对于两个漫射表面 $A_i$ 和 $A_j$，其定义积分为：\n$$F_{ij} = \\frac{1}{A_i} \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} \\mathrm{d}A_j \\mathrm{d}A_i$$\n其中 $r$ 是微元面积 $\\mathrm{d}A_i$ 和 $\\mathrm{d}A_j$ 之间的距离，$\\theta_i$ 和 $\\theta_j$ 是连接它们的线与各自表面法线之间的夹角。这个公式只包含几何量。它从根本上独立于表面属性，如吸收率 $\\alpha$、发射率 $\\varepsilon$ 或温度。\n该陈述的主张恰恰相反。\n该陈述是**不正确的**。\n\n**E. 互易关系 $A_i F_{ij} = A_j F_{ji}$ 源于能量守恒，并且独立于表面发射率和吸收率。**\n互易关系是角系数几何定义的直接数学结果。从定义积分推导出的 $A_i F_{ij}$ 的表达式是\n$$A_i F_{ij} = \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} \\mathrm{d}A_j \\mathrm{d}A_i$$\n积分核相对于下标 $i$ 和 $j$ 是对称的。通过交换积分顺序，我们得到 $A_j F_{ji}$ 的表达式。这仅基于几何就确立了 $A_i F_{ij} = A_j F_{ji}$，证明了它与表面属性无关。\n它“源于能量守恒”的说法也是成立的。可以通过考虑一个由温度为 $T$ 的黑体表面组成的等温腔体来证明此关系。根据热力学第二定律，任何两个处于相同温度的表面之间不能有净热量传递。离开 $i$ 到达 $j$ 的能量是 $(A_i E_b)F_{ij}$，离开 $j$ 到达 $i$ 的能量是 $(A_j E_b)F_{ji}$。令两者相等得到 $A_i E_b F_{ij} = A_j E_b F_{ji}$，简化为 $A_i F_{ij} = A_j F_{ji}$。既然我们已经证明了该关系在这种特定的物理情境下成立，并且由于 $F_{ij}$ 是纯几何的，那么该关系必须在所有情境下都成立。\n该陈述是**正确的**。\n\n**F. 在一个仅由表面 1 和 2 组成的双表面腔体中，最终吸收份额 $p_{12}^{(\\infty)}$ 不依赖于 $\\alpha_1$。**\n该陈述提出了一个包含 $N=2$ 个表面的系统，这与问题 $N \\ge 3$ 的前提相矛盾。虽然这是问题一致性的一个缺陷，但我们分析其物理主张。\n设能量 $Q$ 由表面 1 发射。该能量在表面 1 和 2 之间经历多次反射。表面 1 反射的能量取决于其反射率 $\\rho_1 = 1 - \\alpha_1$。这部分反射的能量随后会贡献于对表面 2 的辐照。\n为了更严谨，我们可以为一个简单的几何形状计算 $p_{12}^{(\\infty)}$，例如两个无限大平行平板，其中 $A_1=A_2$，$F_{12}=1$ 且 $F_{21}=1$。追踪从表面 1 发出的能量 $Q$ 的路径：\n- 表面 2 在第一次通过时吸收的量：$Q \\alpha_2$。\n- 被 2 反射，然后被 1 反射，再被 2 吸收的量：$(Q \\rho_2) (\\rho_1) (\\alpha_2)$。\n- 被 2 反射，然后 1，然后 2，然后 1，再被 2 吸收的量：$(Q \\rho_2) (\\rho_1) (\\rho_2) (\\rho_1) (\\alpha_2)$。\n被 2 吸收的总份额是一个几何级数的和：\n$$p_{12}^{(\\infty)} = \\frac{1}{Q} \\sum_{k=0}^{\\infty} Q \\alpha_2 (\\rho_1 \\rho_2)^k = \\alpha_2 \\sum_{k=0}^{\\infty} (\\rho_1 \\rho_2)^k = \\frac{\\alpha_2}{1 - \\rho_1 \\rho_2} = \\frac{\\alpha_2}{1 - (1-\\alpha_1)(1-\\alpha_2)}$$\n这个 $p_{12}^{(\\infty)}$ 的表达式显然包含 $\\alpha_1$。该份额依赖于 $\\alpha_1$，除非 $\\alpha_2=1$（此时 $p_{12}^{(\\infty)}=1$）或 $\\alpha_2=0$（此时 $p_{12}^{(\\infty)}=0$）。由于该陈述必须对任意属性都成立，因此它是错误的。\n该陈述是**不正确的**。", "answer": "$$\\boxed{ACE}$$", "id": "2518540"}, {"introduction": "在掌握了角系数的基本定义后，下一步是将其应用于具体的几何结构中，从第一性原理出发进行推导。这个实践问题提供了一个经典的挑战：为一个无限长的U形通道计算其内部表面之间的角系数矩阵 [@problem_id:2518531]。解决此问题需要您直接应用角系数的积分定义，并熟练运用对称性、求和法则和互易关系，这些都是解决封闭腔内辐射问题的核心技巧。", "problem": "考虑一个长条、开口、U形的漫灰外壳，其横截面为宽度为 $W$、高度为 $H$ 的矩形。该外壳在平面外方向上拉伸了距离 $L$，其中 $L \\gg \\max\\{W,H\\}$，因此可以忽略端部效应。三个内平面为：\n- 表面 $1$：左侧垂直壁面，面积为 $A_1 = H L$，指向腔体内部的外法线方向为 $+x$。\n- 表面 $2$：底部水平壁面，面积为 $A_2 = W L$，指向腔体内部的外法线方向为 $+y$。\n- 表面 $3$：右侧垂直壁面，面积为 $A_3 = H L$，指向腔体内部的外法线方向为 $-x$。\n\n该外壳顶部向第四个“开口”表面（记为 $4$）开放，你可以使用该表面来建立封闭关系，但不需要报告其角系数。假设所有表面均为平面、漫射且不透明；所有边缘均为锐边；所有角系数的计算都忽略端部效应（即在 $L \\to \\infty$ 的极限下）。\n\n仅从表面到表面的角系数定义以及外壳的相互关系和求和法则出发，推导三个内表面 $i,j \\in \\{1,2,3\\}$ 之间所有九个角系数 $F_{ij}$ 的封闭形式表达式，包括自角系数。你的推导必须通过对拉伸方向进行显式积分，将三维公式在 $L \\to \\infty$ 极限下简化为二维公式。\n\n将最终结果以 $3 \\times 3$ 角系数矩阵的九个元素元组形式报告，按行主序排列，\n$\n\\left(F_{11}, F_{12}, F_{13};\\; F_{21}, F_{22}, F_{23};\\; F_{31}, F_{32}, F_{33}\\right),\n$\n仅用 $W$ 和 $H$ 表示。不要近似或四舍五入；提供精确的封闭形式表达式，不进行数值代入。", "solution": "我们从表面到表面的形态因子（角系数）的基本定义开始。对于两个漫射表面 $i$ 和 $j$，\n$$\nF_{ij} \\;=\\; \\frac{1}{A_i} \\iint_{A_i} \\iint_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi R^2} \\, \\mathrm{d}A_j \\, \\mathrm{d}A_i,\n$$\n其中 $R$ 是微分单元之间的距离，$\\theta_i$ 和 $\\theta_j$ 是局部外法线与连接两个微分单元的直线之间的夹角，方向取法适当。\n\n将使用两个额外的外壳恒等式：\n- 相互关系：$A_i F_{ij} = A_j F_{ji}$。\n- 求和法则：对于每个表面 $i$，$\\sum_{j} F_{ij} = 1$，其中求和包括开口。\n\n由于所有三个内表面都是平面的，每个自角系数都为零：连接同一平面上两个微分单元的任何视线都与该平面相切，因此至少有一个余弦因子为零。因此，\n$$\nF_{11} = F_{22} = F_{33} = 0.\n$$\n\n我们现在通过直接计算来求解非平凡的相互角系数，然后通过对称性和相互关系来补全整个集合。引入一个笛卡尔坐标系，底部表面占据 $\\{(x,0,z): 0 \\le x \\le W,\\, 0 \\le z \\le L\\}$，左壁面占据 $\\{(0,y,z): 0 \\le y \\le H,\\, 0 \\le z \\le L\\}$，右壁面占据 $\\{(W,y,z): 0 \\le y \\le H,\\, 0 \\le z \\le L\\}$。\n\n1) 角系数 $F_{2\\to 1}$（底部到左壁面）。\n\n在底部选取微分单元 $\\mathrm{d}A_2$ 于 $(x,0,z_2)$，在左壁面选取微分单元 $\\mathrm{d}A_1$ 于 $(0,y,z_1)$。从 $\\mathrm{d}A_2$ 到 $\\mathrm{d}A_1$ 的向量是 $\\mathbf{r} = (-x,\\, y,\\, z_1 - z_2)$，且 $R^2 = x^2 + y^2 + (z_1 - z_2)^2$。底部的外法线是 $\\mathbf{n}_2 = (0,1,0)$，左壁面的外法线是 $\\mathbf{n}_1 = (1,0,0)$。因此\n$$\n\\cos\\theta_2 = \\frac{\\mathbf{n}_2 \\cdot \\mathbf{r}}{R} = \\frac{y}{R}, \\qquad\n\\cos\\theta_1 = \\frac{\\mathbf{n}_1 \\cdot (-\\mathbf{r})}{R} = \\frac{x}{R}.\n$$\n代入定义中得到\n$$\nF_{21} = \\frac{1}{A_2} \\int_{0}^{W}\\int_{0}^{L}\\int_{0}^{H}\\int_{0}^{L} \\frac{x\\,y}{\\pi\\left[x^2 + y^2 + (z_1 - z_2)^2\\right]^2} \\,\\mathrm{d}z_1\\,\\mathrm{d}y\\,\\mathrm{d}z_2\\,\\mathrm{d}x.\n$$\n首先对 $z_1$ 和 $z_2$ 进行积分。令 $\\Delta z = z_1 - z_2$，并在 $L \\to \\infty$ 极限下使用标准卷积，\n$$\n\\int_{0}^{L}\\int_{0}^{L} \\frac{\\mathrm{d}z_1\\,\\mathrm{d}z_2}{\\left[x^2 + y^2 + (z_1 - z_2)^2\\right]^2}\n\\;\\xrightarrow[L\\to\\infty]{}\\;\nL \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}\\Delta z}{\\left[x^2 + y^2 + \\Delta z^2\\right]^2}\n\\;=\\; L \\,\\frac{\\pi}{2\\left(x^2 + y^2\\right)^{3/2}},\n$$\n这里我们使用了标准积分 $\\int_{-\\infty}^{\\infty} \\mathrm{d}s/(s^2 + a^2)^2 = \\pi/(2 a^3)$，其中 $a^2 = x^2 + y^2$。于是，\n$$\nF_{21} = \\frac{1}{W L} \\int_{0}^{W}\\int_{0}^{H} \\frac{x\\,y}{\\pi} \\left[ L \\frac{\\pi}{2\\left(x^2 + y^2\\right)^{3/2}} \\right] \\mathrm{d}y\\,\\mathrm{d}x\n= \\frac{1}{2 W} \\int_{0}^{W}\\int_{0}^{H} \\frac{x\\,y}{\\left(x^2 + y^2\\right)^{3/2}} \\,\\mathrm{d}y\\,\\mathrm{d}x.\n$$\n计算关于 $y$ 的内层积分：\n$$\n\\int_{0}^{H} \\frac{y}{\\left(x^2 + y^2\\right)^{3/2}} \\,\\mathrm{d}y\n= \\left[ -\\frac{1}{\\sqrt{x^2 + y^2}} \\right]_{0}^{H}\n= \\frac{1}{x} - \\frac{1}{\\sqrt{x^2 + H^2}}.\n$$\n乘以 $x$ 并对 $x$ 积分，\n$$\n\\int_0^W \\left(1 - \\frac{x}{\\sqrt{x^2 + H^2}}\\right) \\mathrm{d}x = \\left[x - \\sqrt{x^2 + H^2}\\right]_0^W = W - \\sqrt{W^2 + H^2} - (0 - \\sqrt{H^2}) = W - \\sqrt{W^2 + H^2} + H.\n$$\n于是\n$$\nF_{21} = \\frac{1}{2W} \\left( W + H - \\sqrt{W^2 + H^2} \\right) = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W}.\n$$\n根据左右对称性，$F_{23} = F_{21}$。\n\n2) 通过相互关系求角系数 $F_{1\\to 2}$ 和 $F_{3\\to 2}$。\n\n使用 $A_2 F_{21} = A_1 F_{12}$，其中 $A_2 = W L$ 和 $A_1 = H L$，\n$$\nF_{12} = \\frac{A_2}{A_1} F_{21} = \\frac{W}{H} \\cdot \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W}\n= \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H}.\n$$\n根据对称性，$F_{32} = F_{12}$。\n\n3) 角系数 $F_{1\\to 3}$（左壁面到右壁面）。\n\n在 $(0,y_1,z_1)$ 处选取 $\\mathrm{d}A_1$，在 $(W,y_3,z_3)$ 处选取 $\\mathrm{d}A_3$。从 $\\mathrm{d}A_1$ 到 $\\mathrm{d}A_3$ 的向量是 $\\mathbf{r} = (W,\\, y_3 - y_1,\\, z_3 - z_1)$，且 $R^2 = W^2 + (y_3 - y_1)^2 + (z_3 - z_1)^2$。外法线为 $\\mathbf{n}_1 = (1,0,0)$ 和 $\\mathbf{n}_3 = (-1,0,0)$。因此\n$$\n\\cos\\theta_1 = \\frac{\\mathbf{n}_1 \\cdot \\mathbf{r}}{R} = \\frac{W}{R}, \\qquad\n\\cos\\theta_3 = \\frac{\\mathbf{n}_3 \\cdot (-\\mathbf{r})}{R} = \\frac{W}{R}.\n$$\n因此\n$$\nF_{13} = \\frac{1}{A_1} \\int_{0}^{H}\\int_{0}^{L}\\int_{0}^{H}\\int_{0}^{L} \\frac{W^2}{\\pi\\left[W^2 + (y_3 - y_1)^2 + (z_3 - z_1)^2\\right]^2} \\,\\mathrm{d}z_3\\,\\mathrm{d}y_3\\,\\mathrm{d}z_1\\,\\mathrm{d}y_1.\n$$\n和之前一样，在 $L \\to \\infty$ 的极限下对 $z_1,z_3$ 积分：\n$$\n\\int_{0}^{L}\\int_{0}^{L} \\frac{\\mathrm{d}z_1\\,\\mathrm{d}z_3}{\\left[W^2 + (y_3 - y_1)^2 + (z_3 - z_1)^2\\right]^2}\n\\;\\xrightarrow[L\\to\\infty]{}\\;\nL \\frac{\\pi}{2 \\left[ W^2 + (y_3 - y_1)^2 \\right]^{3/2}}.\n$$\n因此\n$$\nF_{13} = \\frac{1}{H L} \\int_{0}^{H}\\int_{0}^{H} \\frac{W^2}{\\pi} \\left[ L \\frac{\\pi}{2 \\left( W^2 + (y_3 - y_1)^2 \\right)^{3/2}} \\right] \\mathrm{d}y_3\\,\\mathrm{d}y_1\n= \\frac{1}{H} \\int_{0}^{H}\\int_{0}^{H} \\frac{W^2}{2 \\left( W^2 + (y_3 - y_1)^2 \\right)^{3/2}} \\,\\mathrm{d}y_3\\,\\mathrm{d}y_1.\n$$\n使用关于差值的函数的标准恒等式，\n$$\n\\int_{0}^{H}\\int_{0}^{H} f(|y_3 - y_1|)\\,\\mathrm{d}y_3\\,\\mathrm{d}y_1 \\;=\\; 2 \\int_{0}^{H} (H - u) f(u)\\,\\mathrm{d}u.\n$$\n于是，\n$$\nF_{13} = \\frac{1}{H} \\int_{0}^{H} (H - u)\\, \\frac{W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u.\n$$\n将积分拆分：\n$$\nF_{13} = \\frac{1}{H} \\left[ H \\int_{0}^{H} \\frac{W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u \\;-\\; \\int_{0}^{H} \\frac{u\\, W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u \\right].\n$$\n计算这两个基本积分：\n- 通过换元 $u = W \\tan t$，可以得到\n$$\n\\int_{0}^{H} \\frac{W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u\n= \\left[ \\frac{u}{\\sqrt{W^2 + u^2}} \\right]_{0}^{H}\n= \\frac{H}{\\sqrt{W^2 + H^2}}.\n$$\n- 通过 $s = W^2 + u^2$，$\\mathrm{d}s = 2 u\\,\\mathrm{d}u$，可以得到\n$$\n\\int_{0}^{H} \\frac{u\\, W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u\n= \\left[ - \\frac{W^2}{\\sqrt{W^2 + u^2}} \\right]_{0}^{H}\n= W - \\frac{W^2}{\\sqrt{W^2 + H^2}}.\n$$\n因此，\n$$\nF_{13} = \\frac{1}{H} \\left[ H \\cdot \\frac{H}{\\sqrt{W^2 + H^2}} - \\left( W - \\frac{W^2}{\\sqrt{W^2 + H^2}} \\right) \\right]\n= \\frac{1}{H} \\left[ \\frac{H^2 + W^2}{\\sqrt{W^2 + H^2}} - W \\right]\n= \\frac{\\sqrt{W^2 + H^2} - W}{H}.\n$$\n根据对称性，$F_{31} = F_{13}$。\n\n4) 补全与一致性检验。\n\n我们已经得到\n$$\nF_{11} = F_{22} = F_{33} = 0,\\quad\nF_{21} = F_{23} = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W},\\quad\nF_{12} = F_{32} = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H},\\quad\nF_{13} = F_{31} = \\frac{\\sqrt{W^2 + H^2} - W}{H}.\n$$\n根据构造，这些角系数满足相互关系。作为进一步检验，对每个发射表面 $i$ 应用求和法则，包括开口 $4$：\n- 对于 $i=2$，\n$$\nF_{21} + F_{22} + F_{23} + F_{24} = 2 \\cdot \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W} + 0 + F_{24} = 1\n\\;\\Rightarrow\\;\nF_{24} = 1 - \\frac{H+W-\\sqrt{W^2+H^2}}{W} = \\frac{\\sqrt{W^2 + H^2} - H}{W}.\n$$\n- 对于 $i=1$，\n$$\nF_{12} + F_{13} + F_{14} = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H} + \\frac{\\sqrt{W^2 + H^2} - W}{H} + F_{14} = 1\n$$\n$$\nF_{14} = 1 - \\left( \\frac{H+W-\\sqrt{W^2+H^2} + 2\\sqrt{W^2+H^2} - 2W}{2H} \\right) = 1 - \\frac{H-W+\\sqrt{W^2+H^2}}{2H} = \\frac{H+W-\\sqrt{W^2+H^2}}{2H}\n$$\n$F_{24}$ 和 $F_{14}$ 均为非负且小于 1，这证实了一致性。在 $\\{1,2,3\\}$ 中没有其他未确定的项了。\n\n将这九个元素按行主序排列，得到所要求的仅用 $W$ 和 $H$ 表示的封闭形式结果。", "answer": "$$\\boxed{\\left(0, \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H}, \\frac{\\sqrt{W^2 + H^2} - W}{H}; \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W}, 0, \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W}; \\frac{\\sqrt{W^2 + H^2} - W}{H}, \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H}, 0\\right)}$$", "id": "2518531"}, {"introduction": "虽然解析推导对于理解基本原理至关重要，但现实世界中的工程问题往往涉及无法解析求解的复杂几何形状。因此，数值方法是辐射换热分析中不可或缺的工具。本练习将引导您从理论走向实践，通过编写代码来数值计算两个平行矩形板之间的角系数 [@problem_id:2518472]。您不仅将实现一个数值积分方案，还将学习如何评估计算结果的精度，并通过强制执行互易关系这一物理定律来校正和验证您的数值解。", "problem": "考虑真空中两个有限的平面矩形表面之间的漫-灰辐射角系数，两者之间视线无遮挡。这两个表面是矩形，以笛卡尔坐标原点为中心，一个位于平面 $z=0$ 上，其向外单位法向量为 $\\mathbf{n}_1=(0,0,1)$，面积为 $A_1=L_{1x}L_{1y}$；另一个位于与之平行的平面 $z=H$ 上，其向外单位法向量为 $\\mathbf{n}_2=(0,0,-1)$，面积为 $A_2=L_{2x}L_{2y}$。每个矩形的边都与坐标轴对齐。设表面 $1$ 上的点参数化为 $(x_1,y_1,0)$，其中 $x_1\\in[-L_{1x}/2,L_{1x}/2]$，$y_1\\in[-L_{1y}/2,L_{1y}/2]$；表面 $2$ 上的点参数化为 $(x_2,y_2,H)$，其中 $x_2\\in[-L_{2x}/2,L_{2x}/2]$，$y_2\\in[-L_{2y}/2,L_{2y}/2]$。分离向量为 $\\mathbf{r}=(x_2-x_1,y_2-y_1,H)$，其模为 $r=\\|\\mathbf{r}\\|$。对于无遮挡的视图（可见性 $V=1$），角系数 $F_{1\\to 2}$ 由基本的表面到表面交换积分定义\n$$\nF_{1\\to 2}=\\frac{1}{A_1}\\iint_{A_1}\\iint_{A_2}\\frac{\\cos\\theta_1\\,\\cos\\theta_2}{\\pi\\,r^2}\\,\\mathrm{d}A_2\\,\\mathrm{d}A_1,\n$$\n其中 $\\cos\\theta_1=\\mathbf{n}_1\\cdot\\frac{\\mathbf{r}}{r}$ 且 $\\cos\\theta_2=\\mathbf{n}_2\\cdot\\frac{-\\mathbf{r}}{r}$。对于当前几何构型，$\\cos\\theta_1=\\cos\\theta_2=\\frac{H}{r}$，因此被积函数简化为 $\\frac{H^2}{\\pi r^4}$。互易性恒等式（一个经过充分检验的漫反射交换事实）表明 $A_1F_{1\\to 2}=A_2F_{2\\to 1}$。\n\n您的任务是通过以下方式计算 $F_{1\\to 2}$ 和 $F_{2\\to 1}$ 数值积分的后验误差估计：\n- 在每个矩形上使用张量积高斯-勒让德求积来近似四维积分。\n- 比较连续的加密级别（每个矩形维度上的点数加倍）以形成每个方向上求积误差的后验估计。\n- 在各自的加密级别上计算两个独立的近似值 $G_{12}$ 和 $G_{21}$，然后通过将 $\\big(G_{12},G_{21}\\big)$ 替换为满足线性约束 $A_1F_{12}^\\star=A_2F_{21}^\\star$ 的最小二乘对 $\\big(F_{12}^\\star,F_{21}^\\star\\big)$ 来强制执行互易性。\n- 报告每个方向的后验误差指标，该指标聚合了逐次加密的差异和互易性校正的位移。\n\n为每个测试用例实现以下内容：\n1. 在 $A_1$ 上使用阶数为 $(n_{1},n_{1})$ 并在 $A_2$ 上使用阶数为 $(n_{2},n_{2})$ 的张量积高斯-勒让德节点，以获得粗略近似值 $F_{1\\to 2}^{(c)}$。将两个阶数都加密到 $(2n_{1},2n_{1})$ 和 $(2n_{2},2n_{2})$ 以获得 $F_{1\\to 2}^{(f)}$，并定义后验误差估计 $E_{12}^{\\text{ref}}=\\left|F_{1\\to 2}^{(f)}-F_{1\\to 2}^{(c)}\\right|$。取 $G_{12}=F_{1\\to 2}^{(f)}$。\n2. 独立地，在 $A_2$ 上使用 $(m_{2},m_{2})$ 阶、在 $A_1$ 上使用 $(m_{1},m_{1})$ 阶计算 $F_{2\\to 1}^{(c)}$，然后加密到 $(2m_{2},2m_{2})$ 和 $(2m_{1},2m_{1})$ 以得到 $F_{2\\to 1}^{(f)}$ 和 $E_{21}^{\\text{ref}}=\\left|F_{2\\to 1}^{(f)}-F_{2\\to 1}^{(c)}\\right|$。取 $G_{21}=F_{2\\to 1}^{(f)}$。\n3. 计算互易性校正对 $\\big(F_{12}^\\star,F_{21}^\\star\\big)$，作为在约束 $A_1F_{12}=A_2F_{21}$ 下最小化 $\\left(F_{12}-G_{12}\\right)^2+\\left(F_{21}-G_{21}\\right)^2$ 的最小二乘解。定义位移大小 $\\Delta_{12}=\\left|F_{12}^\\star-G_{12}\\right|$ 和 $\\Delta_{21}=\\left|F_{21}^\\star-G_{21}\\right|$。最后报告误差指标 $E_{12}=\\max\\left(E_{12}^{\\text{ref}},\\Delta_{12}\\right)$ 和 $E_{21}=\\max\\left(E_{21}^{\\text{ref}},\\Delta_{21}\\right)$。\n4. 所有角系数和误差指标都是无量纲的。将所有报告的数字表示为四舍五入到六位小数的小数。\n\n使用以下测试套件，其中所有长度单位均为米：\n- 情况 1：$L_{1x}=1$, $L_{1y}=1$, $L_{2x}=1$, $L_{2y}=1$, $H=1$，其中 $(n_{1},n_{2})=(8,8)$ 且 $(m_{2},m_{1})=(10,10)$。\n- 情况 2：$L_{1x}=1$, $L_{1y}=2$, $L_{2x}=2$, $L_{2y}=3$, $H=0.2$，其中 $(n_{1},n_{2})=(8,8)$ 且 $(m_{2},m_{1})=(10,10)$。\n- 情况 3：$L_{1x}=1$, $L_{1y}=1$, $L_{2x}=3$, $L_{2y}=1$, $H=4$，其中 $(n_{1},n_{2})=(8,8)$ 且 $(m_{2},m_{1})=(10,10)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目本身都是一个用例的列表：$\\big[F_{12}^\\star,F_{21}^\\star,E_{12},E_{21}\\big]$，每个值都四舍五入到六位小数。例如，输出格式为\n\"[ [x11,x12,x13,x14], [x21,x22,x23,x24], [x31,x32,x33,x34] ]\"\n其中所有 $x_{ij}$ 都以六位小数形式给出，无单位。此处不使用角度（如有）。不使用百分比；所有量都是不带百分号的纯数字。", "solution": "问题陈述已经过严格验证。它在科学上基于辐射传热原理，在数学和算法上是适定的，并且陈述客观。它要求实现一种标准的数值积分技术（高斯-勒让德求积），并结合后验误差估计和基于物理动机的校正程序来强制执行互易性定理。所有数据和参数都已提供，任务明确。因此，该问题被认为是有效的，并将提供解决方案。\n\n核心任务是数值计算两个平行的、中心对齐的、轴对齐的矩形 $A_1$ 和 $A_2$ 之间的漫反射辐射角系数 $F_{1\\to 2}$，它们相距为 $H$。控制方程是四维积分：\n$$\nF_{1\\to 2} = \\frac{1}{A_1} \\iint_{A_1} \\iint_{A_2} \\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi r^2} \\, \\mathrm{d}A_2 \\, \\mathrm{d}A_1\n$$\n对于指定的几何构型，表面法向量为 $\\mathbf{n}_1=(0,0,1)$ 和 $\\mathbf{n}_2=(0,0,-1)$，角度项为 $\\cos\\theta_1 = \\cos\\theta_2 = H/r$。被积函数简化为 $H^2 / (\\pi r^4)$。距离的平方 $r^2$ 由 $r^2 = (x_2-x_1)^2 + (y_2-y_1)^2 + H^2$ 给出。积分变为：\n$$\nF_{1\\to 2} = \\frac{H^2}{A_1 \\pi} \\int_{-L_{1y}/2}^{L_{1y}/2} \\int_{-L_{1x}/2}^{L_{1x}/2} \\int_{-L_{2y}/2}^{L_{2y}/2} \\int_{-L_{2x}/2}^{L_{2x}/2} \\frac{1}{((x_2-x_1)^2 + (y_2-y_1)^2 + H^2)^2} \\, \\mathrm{d}x_2 \\, \\mathrm{d}y_2 \\, \\mathrm{d}x_1 \\, \\mathrm{d}y_1\n$$\n其中 $A_1 = L_{1x}L_{1y}$。\n\n为便于数值积分，我们进行变量代换，将积分域从 $[-L_{1x}/2, L_{1x}/2] \\times \\dots \\times [-L_{2y}/2, L_{2y}/2]$ 转换为标准超立方体 $[-1, 1]^4$。令 $x_1 = \\frac{L_{1x}}{2}u_1$, $y_1 = \\frac{L_{1y}}{2}u_2$, $x_2 = \\frac{L_{2x}}{2}u_3$, $y_2 = \\frac{L_{2y}}{2}u_4$。微分变换为 $\\mathrm{d}x_1 = \\frac{L_{1x}}{2}\\mathrm{d}u_1$，依此类推。此变换的总雅可比行列式为 $\\frac{L_{1x}L_{1y}L_{2x}L_{2y}}{16} = \\frac{A_1 A_2}{16}$。将此代入 $F_{1\\to 2}$ 的积分表达式中：\n$$\nF_{1\\to 2} = \\frac{H^2}{A_1 \\pi} \\frac{A_1 A_2}{16} \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\frac{1}{r^4(u_1, u_2, u_3, u_4)} \\, \\mathrm{d}u_4 \\, \\mathrm{d}u_3 \\, \\mathrm{d}u_2 \\, \\mathrm{d}u_1 = \\frac{A_2 H^2}{16\\pi} \\int_{[-1,1]^4} \\frac{1}{r^4} \\, \\mathrm{d}\\mathbf{u}\n$$\n该积分使用张量积高斯-勒让德求积法则进行近似。对于阶数 $N_{1x}, N_{1y}, N_{2x}, N_{2y}$，令 $\\{(u_{1,i}, w_{1,i})\\}_{i=1}^{N_{1x}}$, ..., $\\{(u_{4,l}, w_{4,l})\\}_{l=1}^{N_{2y}}$ 分别为相应的求积节点和权重。角系数近似为：\n$$\nF_{1\\to 2} \\approx \\frac{A_2 H^2}{16\\pi} \\sum_{i=1}^{N_{1x}} \\sum_{j=1}^{N_{1y}} \\sum_{k=1}^{N_{2x}} \\sum_{l=1}^{N_{2y}} w_{1,i}w_{2,j}w_{3,k}w_{4,l} \\frac{1}{r_{ijkl}^4}\n$$\n其中 $r_{ijkl}^2$ 在对应于节点 $(u_{1,i}, u_{2,j}, u_{3,k}, u_{4,l})$ 的物理坐标处求值。$F_{2\\to 1}$ 的计算是类似的，只需交换表面 $1$ 和 $2$ 的角色。\n\n后验误差估计涉及两个不同的度量。首先，通过比较粗略的求积结果和更精细的结果，计算基于加密的估计 $E^{\\text{ref}}$。例如，对于 $F_{1\\to 2}$，我们使用阶数 $(n_{1}, n_{1})$ 和 $(n_{2}, n_{2})$ 计算 $F_{1\\to 2}^{(c)}$，并使用加密后的阶数 $(2n_{1}, 2n_{1})$ 和 $(2n_{2}, 2n_{2})$ 计算 $F_{1\\to 2}^{(f)}$。估计值为 $E_{12}^{\\text{ref}}=\\left|F_{1\\to 2}^{(f)}-F_{1\\to 2}^{(c)}\\right|$。保留更精确的值 $G_{12} = F_{1\\to 2}^{(f)}$。一次独立的计算提供 $G_{21} = F_{2\\to 1}^{(f)}$ 和 $E_{21}^{\\text{ref}}$。\n\n其次，由于求积误差，数值结果 $G_{12}$ 和 $G_{21}$ 通常不完全满足互易性定理 $A_1 F_{1\\to 2} = A_2 F_{2\\to 1}$。我们通过找到一个校正对 $(F_{12}^\\star, F_{21}^\\star)$ 来强制执行这条物理定律，该校正对在满足线性约束 $A_1 F_{12} - A_2 F_{21} = 0$ 的条件下，使最小二乘泛函 $S = (F_{12} - G_{12})^2 + (F_{21} - G_{21})^2$ 最小化。采用拉格朗日乘子法。拉格朗日函数为 $\\mathcal{L} = S - \\lambda (A_1 F_{12} - A_2 F_{21})$。方程组 $\\nabla \\mathcal{L} = 0$ 产生解：\n$$\n\\lambda = \\frac{2(A_2 G_{21} - A_1 G_{12})}{A_1^2 + A_2^2}\n$$\n强制执行互易性后的角系数为：\n$$\nF_{12}^\\star = G_{12} + \\frac{\\lambda}{2}A_1 = \\frac{A_2(A_2 G_{12} + A_1 G_{21})}{A_1^2 + A_2^2}\n$$\n$$\nF_{21}^\\star = G_{21} - \\frac{\\lambda}{2}A_2 = \\frac{A_1(A_1 G_{21} + A_2 G_{12})}{A_1^2 + A_2^2}\n$$\n由该校正引起的位移 $\\Delta_{12} = |F_{12}^\\star - G_{12}|$ 和 $\\Delta_{21} = |F_{21}^\\star - G_{21}|$，作为数值误差的另一个指标。互易性残差的大小 $R = |A_1 G_{12} - A_2 G_{21}|$ 给出 $\\Delta_{12} = \\frac{A_2 R}{A_1^2 + A_2^2}$ 和 $\\Delta_{21} = \\frac{A_1 R}{A_1^2 + A_2^2}$。\n\n最终报告的每个方向的误差指标聚合了这两个误差源：$E_{12} = \\max(E_{12}^{\\text{ref}}, \\Delta_{12})$ 和 $E_{21} = \\max(E_{21}^{\\text{ref}}, \\Delta_{21})$。这为计算出的角系数的总不确定性提供了一个保守估计。\n\n因此，算法流程如下：\n1.  对于给定的几何形状 $(L_{1x}, L_{1y}, L_{2x}, L_{2y}, H)$ 和求积阶数，计算 $F_{1\\to 2}^{(c)}$ 和 $F_{1\\to 2}^{(f)}$ 以找到 $G_{12}$ 和 $E_{12}^{\\text{ref}}$。\n2.  独立计算 $F_{2\\to 1}^{(c)}$ 和 $F_{2\\to 1}^{(f)}$ 以找到 $G_{21}$ 和 $E_{21}^{\\text{ref}}$。\n3.  使用 $G_{12}$, $G_{21}$, $A_1$ 和 $A_2$ 计算校正对 $(F_{12}^\\star, F_{21}^\\star)$ 和位移 $(\\Delta_{12}, \\Delta_{21})$。\n4.  组合误差度量以报告最终指标 $(E_{12}, E_{21})$。\n对每个测试用例重复此过程。", "answer": "\"[ [0.199824, 0.199824, 0.000001, 0.000000], [0.741006, 0.247002, 0.000542, 0.000181], [0.046522, 0.139566, 0.000004, 0.000001] ]\"", "id": "2518472"}]}