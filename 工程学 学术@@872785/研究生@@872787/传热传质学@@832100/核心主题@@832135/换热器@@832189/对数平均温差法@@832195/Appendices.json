{"hands_on_practices": [{"introduction": "这个练习将引导你回归基本原理。你将不再仅仅是应用对数平均温差 (LMTD) 公式，而是从能量守恒和传热学的基本定律出发，亲自推导出它。这项练习对于深刻理解为何在许多换热器中，对数平均值是温差驱动力 $\\Delta T$ 的正确空间平均形式，以及当我们将设计推向热力学极限时会发生什么至关重要 [@problem_id:2528891]。", "problem": "一个长度为 $L$ 的稳态、一维、单程逆流换热器，在两种物性恒定的单相流体之间传递热量。设热、冷流体的热容率分别为恒定的 $C_{h}$ 和 $C_{c}$，且无热量损失到环境中。总传热系数 (OHTC) 是均匀的，等于 $U$，传热周长也是均匀的，等于 $P$，因此微分面积元为 $dA = P\\,dx$，其中 $x$ 是流向坐标。\n\n- 仅从每股流体的能量守恒和界面传热的局部线性本构关系出发，推导局部温差 $\\Delta T(x) \\equiv T_{h}(x) - T_{c}(x)$ 的精确微分方程，并在边界值 $\\Delta T(0) = \\Delta T_{1}  0$ 和 $\\Delta T(L) = \\Delta T_{2}  0$ 的条件下求解该方程。\n- 定义空间平均驱动力 $\\overline{\\Delta T} \\equiv \\frac{1}{L}\\int_{0}^{L} \\Delta T(x)\\,dx$。证明总热负荷 $Q$ 可以写成 $Q = U\\,A\\,\\overline{\\Delta T}$ 的形式，其中 $A = P\\,L$，并仅用 $\\Delta T_{1}$ 和 $\\Delta T_{2}$ 表示 $\\overline{\\Delta T}$。将此平均值确定为对数平均温差 (LMTD)。\n- 设无量纲比值 $\\theta \\equiv \\frac{\\Delta T_{\\mathrm{lm}}}{\\Delta T_{1}}$。在 $\\Delta T_{1}  0$ 为固定的有限值的情况下，当一个端点温差趋于零时，即 $\\lim_{\\Delta T_{2}\\to 0^{+}} \\theta$，求 $\\theta$ 的极限。将极限值报告为一个纯数。\n- 简要解释结果，说明在 $U$ 为有限值时，当一端的趋近温度趋于零时，传递一个固定的有限热负荷 $Q$ 所需的面积 $A$。\n\n将最终答案表示为 $\\theta$ 的极限值，为一个纯数。无需四舍五入。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 系统：稳态、一维、单程逆流换热器。\n- 长度：$L$。\n- 流体：两种物性恒定的单相流体。\n- 热容率：$C_{h}$ (热流体)，$C_{c}$ (冷流体)，均为常数。\n- 热损失：无热量损失到环境中。\n- 总传热系数 (OHTC)：均匀，为 $U$。\n- 传热周长：均匀，为 $P$。\n- 微分面积元：$dA = P\\,dx$。\n- 流向坐标：$x$，从 $x=0$ 到 $x=L$。\n- 局部温差：$\\Delta T(x) \\equiv T_{h}(x) - T_{c}(x)$。\n- 边界值：$\\Delta T(0) = \\Delta T_{1}  0$ 和 $\\Delta T(L) = \\Delta T_{2}  0$。\n- 空间平均驱动力：$\\overline{\\Delta T} \\equiv \\frac{1}{L}\\int_{0}^{L} \\Delta T(x)\\,dx$。\n- 总热负荷：$Q = U\\,A\\,\\overline{\\Delta T}$，其中 $A = P\\,L$。\n- 无量纲比值：$\\theta \\equiv \\frac{\\Delta T_{\\mathrm{lm}}}{\\Delta T_{1}}$。\n- 待求极限：在 $\\Delta T_{1}  0$ 为固定的有限值的情况下，求 $\\lim_{\\Delta T_{2}\\to 0^{+}} \\theta$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是关于推导逆流换热器对数平均温差 (LMTD) 的热质传递领域的经典问题。它提法明确、客观且自洽。所有术语都已定义，并且假设（物性恒定、U均匀、稳态）是进行解析处理所必需的标准理想化。该问题不违反任何物理定律，不包含矛盾，且并非微不足道。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n**控制微分方程的推导**\n\n我们建立一个坐标系，其中热流体沿正 $x$ 方向流动，从 $x=0$ 到 $x=L$。在逆流配置中，冷流体因此必须沿负 $x$ 方向流动，从 $x=L$ 到 $x=0$。\n\n通过微分面积元 $dA = P\\,dx$ 的传热由局部本构关系给出：\n$$dQ = U (T_h(x) - T_c(x)) P\\,dx = U P \\Delta T(x) \\,dx$$\n\n对每个流体流，在从 $x$ 到 $x+dx$ 的微分控制体积上应用能量守恒。\n\n对于沿 $+x$ 方向流动的热流体，其温度降低。其焓变等于传出的热量：\n$$C_h dT_h = -dQ = -U P \\Delta T(x) \\,dx$$\n$$\\frac{dT_h}{dx} = -\\frac{UP}{C_h} \\Delta T(x)$$\n\n对于沿 $-x$ 方向流动的冷流体，当它从 $x=L$ 流向 $x=0$ 时，其温度升高。在相同的微分元件上应用能量平衡，焓变是由于传入的热量。考虑到流动方向：\n$C_c T_c(x) - C_c T_c(x+dx) = dQ$\n$$-C_c (T_c(x+dx) - T_c(x)) = U P \\Delta T(x) \\,dx$$\n$$-C_c \\frac{dT_c}{dx} = U P \\Delta T(x)$$\n$$\\frac{dT_c}{dx} = -\\frac{UP}{C_c} \\Delta T(x)$$\n\n问题要求一个关于 $\\Delta T(x) = T_h(x) - T_c(x)$ 的微分方程。我们对这个定义关于 $x$ 求导：\n$$\\frac{d(\\Delta T)}{dx} = \\frac{dT_h}{dx} - \\frac{dT_c}{dx}$$\n代入从能量平衡推导出的表达式：\n$$\\frac{d(\\Delta T)}{dx} = \\left(-\\frac{UP}{C_h} \\Delta T(x)\\right) - \\left(-\\frac{UP}{C_c} \\Delta T(x)\\right)$$\n$$\\frac{d(\\Delta T)}{dx} = -UP \\left( \\frac{1}{C_h} - \\frac{1}{C_c} \\right) \\Delta T(x)$$\n这就是所要求的关于 $\\Delta T(x)$ 的一阶、线性、齐次常微分方程。\n\n为求解此常微分方程，我们分离变量并积分：\n$$\\int \\frac{d(\\Delta T)}{\\Delta T} = -UP \\left( \\frac{1}{C_h} - \\frac{1}{C_c} \\right) \\int dx$$\n$$\\ln(\\Delta T(x)) = -UP \\left( \\frac{1}{C_h} - \\frac{1}{C_c} \\right) x + K$$\n其中 $K$ 是积分常数。使用 $x=0$ 处的边界条件 $\\Delta T(0) = \\Delta T_1$：\n$$\\ln(\\Delta T_1) = K$$\n因此，局部温差的解为：\n$$\\ln\\left(\\frac{\\Delta T(x)}{\\Delta T_1}\\right) = -UP \\left( \\frac{1}{C_h} - \\frac{1}{C_c} \\right) x$$\n$$\\Delta T(x) = \\Delta T_1 \\exp\\left[-UP \\left( \\frac{1}{C_h} - \\frac{1}{C_c} \\right) x\\right]$$\n此解满足边界条件 $\\Delta T(0) = \\Delta T_1$。在 $x=L$ 处，我们有 $\\Delta T(L) = \\Delta T_2$。\n\n**对数平均温差 (LMTD) 的推导**\n\n总热负荷 $Q$ 是局部传热速率在换热器整个长度上的积分：\n$$Q = \\int_0^L U P \\Delta T(x) \\,dx = UP \\int_0^L \\Delta T(x) \\,dx$$\n根据空间平均驱动力 $\\overline{\\Delta T} \\equiv \\frac{1}{L}\\int_{0}^{L} \\Delta T(x)\\,dx$ 的定义，并设 $A=PL$：\n$$Q = U (PL) \\left(\\frac{1}{L} \\int_0^L \\Delta T(x) \\,dx\\right) = U A \\overline{\\Delta T}$$\n这证实了问题陈述中给出的函数形式。\n\n为了用端点温差 $\\Delta T_1$ 和 $\\Delta T_2$ 来表示 $\\overline{\\Delta T}$，我们重新整理关于 $\\Delta T$ 的常微分方程：\n$$\\frac{d(\\Delta T)}{\\Delta T} = -UP\\left(\\frac{1}{C_h} - \\frac{1}{C_c}\\right)dx$$\n总热负荷 $Q$ 也可以通过对每个流体的总能量平衡来表示：\n对于热流体：$Q = C_h (T_{h,in} - T_{h,out}) = C_h (T_h(0) - T_h(L))$，这意味着 $\\frac{1}{C_h} = \\frac{T_h(0)-T_h(L)}{Q}$。\n对于冷流体：$Q = C_c (T_{c,out} - T_{c,in}) = C_c (T_c(0) - T_c(L))$，这意味着 $\\frac{1}{C_c} = \\frac{T_c(0)-T_c(L)}{Q}$。\n\n将这些表达式代入 $d(\\Delta T)/dx$ 的微分方程中：\n$$\\frac{d(\\Delta T)}{dx} = -UP \\left( \\frac{T_h(0)-T_h(L)}{Q} - \\frac{T_c(0)-T_c(L)}{Q} \\right) \\Delta T$$\n$$\\frac{d(\\Delta T)}{dx} = -\\frac{UP}{Q} \\left[ (T_h(0)-T_c(0)) - (T_h(L)-T_c(L)) \\right] \\Delta T$$\n使用定义 $\\Delta T_1 = \\Delta T(0) = T_h(0)-T_c(0)$ 和 $\\Delta T_2 = \\Delta T(L) = T_h(L)-T_c(L)$：\n$$\\frac{d(\\Delta T)}{dx} = -\\frac{UP}{Q} (\\Delta T_1 - \\Delta T_2) \\Delta T$$\n我们分离变量并在换热器长度上从 $x=0$ 到 $x=L$ 进行积分：\n$$\\int_{\\Delta T_1}^{\\Delta T_2} \\frac{d(\\Delta T)}{\\Delta T} = -\\frac{UP}{Q} (\\Delta T_1 - \\Delta T_2) \\int_0^L dx$$\n$$\\ln\\left(\\frac{\\Delta T_2}{\\Delta T_1}\\right) = -\\frac{UPL}{Q} (\\Delta T_1 - \\Delta T_2) = \\frac{U A}{Q} (\\Delta T_2 - \\Delta T_1)$$\n求解 $Q$：\n$$Q = U A \\frac{\\Delta T_2 - \\Delta T_1}{\\ln(\\frac{\\Delta T_2}{\\Delta T_1})} = U A \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\frac{\\Delta T_1}{\\Delta T_2})}$$\n通过将此结果与 $Q = U A \\overline{\\Delta T}$ 进行比较，我们将空间平均温差确定为对数平均温差 (LMTD)：\n$$\\overline{\\Delta T} = \\Delta T_{\\mathrm{lm}} = \\frac{\\Delta T_2 - \\Delta T_1}{\\ln(\\frac{\\Delta T_2}{\\Delta T_1})}$$\n\n**极限的计算**\n\n无量纲比值 $\\theta$ 定义为 $\\theta \\equiv \\frac{\\Delta T_{\\mathrm{lm}}}{\\Delta T_{1}}$。代入 $\\Delta T_{\\mathrm{lm}}$ 的表达式：\n$$\\theta = \\frac{1}{\\Delta T_1} \\left( \\frac{\\Delta T_2 - \\Delta T_1}{\\ln(\\frac{\\Delta T_2}{\\Delta T_1})} \\right) = \\frac{\\frac{\\Delta T_2}{\\Delta T_1} - 1}{\\ln(\\frac{\\Delta T_2}{\\Delta T_1})}$$\n令 $r = \\frac{\\Delta T_2}{\\Delta T_1}$。$\\theta$ 的表达式变为：\n$$\\theta(r) = \\frac{r-1}{\\ln(r)}$$\n我们需要在 $\\Delta T_1$ 为固定的正值常数的情况下，计算当 $\\Delta T_2 \\to 0^+$ 时 $\\theta$ 的极限。这对应于当 $r \\to 0^+$ 时的极限。\n$$\\lim_{\\Delta T_2 \\to 0^+} \\theta = \\lim_{r \\to 0^+} \\frac{r-1}{\\ln(r)}$$\n当 $r \\to 0^+$ 时，分子 $(r-1)$ 趋近于 $0 - 1 = -1$。\n当 $r \\to 0^+$ 时，分母 $\\ln(r)$ 趋近于 $-\\infty$。\n因此，极限为：\n$$\\lim_{r \\to 0^+} \\frac{r-1}{\\ln(r)} = \\frac{-1}{-\\infty} = 0$$\n\n**结果的解释**\n\n总热负荷由 $Q = U A \\Delta T_{\\mathrm{lm}}$ 给出。所需的传热面积 $A$ 可以表示为：\n$$A = \\frac{Q}{U \\Delta T_{\\mathrm{lm}}}$$\n使用 $\\theta$ 的定义，我们有 $\\Delta T_{\\mathrm{lm}} = \\theta \\Delta T_1$。将此代入面积方程：\n$$A = \\frac{Q}{U \\theta \\Delta T_1}$$\n问题要求在极限 $\\Delta T_2 \\to 0^+$ 下，对于固定的有限热负荷 $Q$、有限的总传热系数 $U$ 和固定的有限端点温差 $\\Delta T_1$ 的情况下对结果进行解释。\n在此极限下，我们发现 $\\theta \\to 0$。面积的表达式变为：\n$$\\lim_{\\theta \\to 0^+} A = \\lim_{\\theta \\to 0^+} \\frac{Q}{U \\Delta T_1} \\frac{1}{\\theta}$$\n由于 $Q$、$U$ 和 $\\Delta T_1$ 都是有限且非零的，当 $\\theta \\to 0^+$ 时，项 $\\frac{1}{\\theta} \\to +\\infty$。因此，所需的传热面积 $A$ 必须趋于无穷大。\n\n物理上，条件 $\\Delta T_2 \\to 0^+$ 意味着两种流体在换热器一端的温差趋于零。这被称为热“夹点”。要达到两流体在一端达到热平衡，同时在换热器长度上传递有限热量 $Q  0$ 的条件，需要无限大的接触面积。这展示了换热器设计中的一个基本实践限制：用有限尺寸的设备实现零温度趋近在物理上是不可能的。", "answer": "$$\\boxed{0}$$", "id": "2528891"}, {"introduction": "在理论基础之上，本问题引入了一个实际的设计约束：一个最小允许温差，即“夹点”(pinch)。你需要在此操作限制下，确定换热器能达到的最大换热量 $Q$ 以及所需的换热面积 $A$。这项任务将理想化理论与现实工程设计联系起来，在现实设计中，安全和操作裕度是至关重要的考量因素 [@problem_id:2528963]。", "problem": "一个逆流换热器将被设计用于使用液态水冷却单相热油流，其操作约束为换热器内任意位置的温差不得低于指定的最小值。假设稳态运行，忽略对环境的热损失，忽略两种流体和壁内的轴向传导，比热恒定，以及总传热系数在空间上均匀。\n\n给定数据：\n- 热流（油）：质量流量 $\\,\\dot{m}_{h} = 2.50\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}\\,$, 比热 $\\,c_{p,h} = 2.10\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}\\,$, 入口温度 $\\,T_{h,\\mathrm{in}} = 180\\,^{\\circ}\\mathrm{C}\\,$.\n- 冷流（水）：质量流量 $\\,\\dot{m}_{c} = 1.00\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}\\,$, 比热 $\\,c_{p,c} = 4.18\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}\\,$, 入口温度 $\\,T_{c,\\mathrm{in}} = 25\\,^{\\circ}\\mathrm{C}\\,$.\n- 总传热系数（基于面积）：$\\,U = 0.80\\,\\mathrm{kW}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}\\,$.\n- 换热器内允许的最小温差：$\\,\\Delta T_{\\min} = 10\\,\\mathrm{K}\\,$.\n\n任务：\n1) 仅从稳流能量平衡和逆流换热器的微分传热关系出发，确定在满足最小温差约束 $\\,\\Delta T_{\\min}\\,$ 条件下，热力学上和操作上可行的最大稳态传热速率 $\\,Q_{\\max}\\,$。您的推理必须根据热容率确定最小温差发生的位置。\n2) 在相同的基础上，建立逆流换热器的适当平均温差驱动力，并在 $\\,Q_{\\max}\\,$ 条件下对其进行评估。然后计算在给定的 $\\,U\\,$ 下能够实现 $\\,Q_{\\max}\\,$ 所需的最小传热面积 $\\,A\\,$。\n\n将 $\\,Q_{\\max}\\,$ 以 $\\mathrm{kW}$ 为单位，$\\,A\\,$ 以 $\\mathrm{m}^{2}$ 为单位表示。将两个值四舍五入至四位有效数字。", "solution": "该问题被验证为具有科学依据、提法明确且完整。我们将按要求基于第一性原理进行求解。\n\n控制原理是每股流体的稳流能量平衡和换热器的传热速率方程。对于一个微分面积元 $dA$，传热速率 $dQ$ 由下式给出：\n$$dQ = U (T_h - T_c) dA$$\n其中 $U$ 是总传热系数，$T_h$ 和 $T_c$ 分别是热流体和冷流体的局部温度。\n\n在该微分单元上，热流体和冷流体的能量平衡为：\n$$dQ = -C_h dT_h$$\n$$dQ = C_c dT_c$$\n其中 $C_h = \\dot{m}_{h} c_{p,h}$ 和 $C_c = \\dot{m}_{c} c_{p,c}$ 分别是热流体和冷流体的热容率。热流体的负号表示其温度随着热量传出而降低。\n\n首先，我们根据给定数据计算热容率：\n对于热流（油）：\n$$C_h = \\dot{m}_{h} c_{p,h} = (2.50\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}) \\times (2.10\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}) = 5.25\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}$$\n对于冷流（水）：\n$$C_c = \\dot{m}_{c} c_{p,c} = (1.00\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}) \\times (4.18\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}) = 4.18\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}$$\n\n我们观察到 $C_c  C_h$。这意味着对于给定的传热量，冷流体的温度变化将大于热流体的温度变化。\n\n为完成任务1，我们必须确定在逆流布置中，最小温差 $\\Delta T(x) = T_h(x) - T_c(x)$ 出现在何处。我们建立一个坐标系 $x$，从 $x=0$（热流体入口，冷流体出口）到 $x=L$（热流体出口，冷流体入口）。在这个系统中，热流体沿 $x$ 轴正方向流动，冷流体沿 $x$ 轴负方向流动。\n\n局部温差 $\\Delta T$ 相对于位置坐标 $x$ 的变化为：\n$$\\frac{d(\\Delta T)}{dx} = \\frac{dT_h}{dx} - \\frac{dT_c}{dx}$$\n从微分能量平衡和传热速率方程，我们可以写出温度梯度。设 $P$ 为传热周长，使得 $dA = P dx$。\n$$\\frac{dT_h}{dx} = -\\frac{UP}{C_h}(T_h - T_c)$$\n对于反向流动的冷流体，其温度随着 $x$ 的减小而升高。因此，$\\frac{dT_c}{dx}$ 为负。\n$$\\frac{dT_c}{dx} = -\\frac{UP}{C_c}(T_h - T_c)$$\n将这些代入温差梯度的表达式中：\n$$\\frac{d(\\Delta T)}{dx} = -\\frac{UP}{C_h}(T_h - T_c) - \\left(-\\frac{UP}{C_c}(T_h - T_c)\\right) = UP(T_h - T_c) \\left(\\frac{1}{C_c} - \\frac{1}{C_h}\\right)$$\n由于发生传热需要 $T_h  T_c$，所以项 $UP(T_h - T_c)$ 为正。因此 $\\frac{d(\\Delta T)}{dx}$ 的符号由 $(\\frac{1}{C_c} - \\frac{1}{C_h})$ 的符号决定，这等同于 $(C_h - C_c)$ 的符号。\n\n在本问题中，$C_h = 5.25\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}$ 且 $C_c = 4.18\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}$，所以 $C_h  C_c$。这使得 $\\frac{d(\\Delta T)}{dx}$ 为正。正导数意味着温差 $\\Delta T$ 沿着 $x$ 轴从 $x=0$ 到 $x=L$ 增加。因此，最小温差出现在坐标系起点 $x=0$ 处，即热流体进入和冷流体流出的一端。\n$$\\Delta T_{\\text{min, location}} = \\Delta T_1 = T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}$$\n题目规定最小允许温差为 $\\Delta T_{\\min} = 10\\,\\mathrm{K}$。这个约束因此设定了冷流体的最大可能出口温度：\n$$T_{c,\\mathrm{out}} = T_{h,\\mathrm{in}} - \\Delta T_{\\min} = 180\\,^{\\circ}\\mathrm{C} - 10\\,^{\\circ}\\mathrm{C} = 170\\,^{\\circ}\\mathrm{C}$$\n热力学上和操作上可行的最大传热速率 $Q_{\\max}$，由冷流达到此最高温度所获得的能量决定：\n$$Q_{\\max} = C_c (T_{c,\\mathrm{out}} - T_{c,\\mathrm{in}}) = (4.18\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}) \\times (170\\,^{\\circ}\\mathrm{C} - 25\\,^{\\circ}\\mathrm{C})$$\n$$Q_{\\max} = (4.18\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}) \\times (145\\,\\mathrm{K}) = 606.1\\,\\mathrm{kW}$$\n\n对于任务2，我们必须求出所需的传热面积 $A$。这需要使用对数平均温差（LMTD）法。控制方程为 $Q_{\\max} = U A \\Delta T_{lm}$。逆流换热器的LMTD定义为：\n$$\\Delta T_{lm} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)}$$\n其中 $\\Delta T_1$ 和 $\\Delta T_2$ 是换热器两端的温差。我们已经确定 $\\Delta T_1 = 10\\,\\mathrm{K}$。现在我们需要求出 $\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}$。\n\n首先，我们利用热流的能量平衡和已计算出的 $Q_{\\max}$，求出热流体的出口温度 $T_{h,\\mathrm{out}}$：\n$$Q_{\\max} = C_h (T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}})$$\n$$606.1\\,\\mathrm{kW} = (5.25\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}) \\times (180\\,^{\\circ}\\mathrm{C} - T_{h,\\mathrm{out}})$$\n$$T_{h,\\mathrm{out}} = 180\\,^{\\circ}\\mathrm{C} - \\frac{606.1\\,\\mathrm{kW}}{5.25\\,\\mathrm{kW}\\,\\mathrm{K}^{-1}} = 180\\,^{\\circ}\\mathrm{C} - 115.4476...\\,^{\\circ}\\mathrm{C} = 64.5524\\,^{\\circ}\\mathrm{C}$$\n现在我们计算另一端的温差：\n$$\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}} = 64.5524\\,^{\\circ}\\mathrm{C} - 25\\,^{\\circ}\\mathrm{C} = 39.5524\\,\\mathrm{K}$$\n我们现在可以计算LMTD：\n$$\\Delta T_{lm} = \\frac{39.5524\\,\\mathrm{K} - 10\\,\\mathrm{K}}{\\ln(39.5524 / 10)} = \\frac{29.5524}{\\ln(3.95524)} = 21.4926\\,\\mathrm{K}$$\n最后，我们重新整理传热方程以求解所需的最小面积 $A$：\n$$A = \\frac{Q_{\\max}}{U \\Delta T_{lm}} = \\frac{606.1\\,\\mathrm{kW}}{(0.80\\,\\mathrm{kW}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}) \\times (21.4926\\,\\mathrm{K})}$$\n$$A = \\frac{606.1}{17.1941} \\,\\mathrm{m}^{2} = 35.250... \\,\\mathrm{m}^{2}$$\n按要求将结果四舍五入至四位有效数字：\n$Q_{\\max} = 606.1\\,\\mathrm{kW}$\n$A = 35.25\\,\\mathrm{m}^{2}$", "answer": "$$\n\\boxed{\\begin{pmatrix} 606.1  35.25 \\end{pmatrix}}\n$$", "id": "2528963"}, {"introduction": "在现实世界中，工程参数的测量值永远不可能达到绝对精确。这项高级练习将挑战你量化温度和总传热系数 $U$ 的测量不确定度对换热器面积 $A$ 计算结果的影响。通过应用一阶不确定度传播方法，你将学习到一种评估设计可靠性的强大技术，这是任何从业工程师都应具备的关键技能 [@problem_id:2528904]。", "problem": "一个稳态、单程、逆流换热器的设计采用了热负荷、总传热系数、面积和对数平均温差（LMTD）之间的经典关系。所需的面积由传热平衡和驱动力得到。设计必须考虑到总传热系数和四个终端温度的测量不确定性。你的任务是从基本原理出发，推导出一阶不确定度传播，从而得出所需面积的置信区间。\n\n从以下基础出发：\n- 热传递负荷满足单程换热器的经典关系：热负荷 $Q$ 与总传热系数 $U$、面积 $A$、修正系数 $F$（无量纲）以及对数平均温差（LMTD）$\\Delta T_{\\mathrm{lm}}$ 的关系为 $Q = U A F \\Delta T_{\\mathrm{lm}}$。\n- 对于逆流流动，终端温差定义为 $\\Delta T_{1} = T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}$ 和 $\\Delta T_{2} = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}$，对数平均温差定义为 $\\Delta T_{\\mathrm{lm}} = \\dfrac{\\Delta T_{1} - \\Delta T_{2}}{\\ln\\!\\left(\\dfrac{\\Delta T_{1}}{\\Delta T_{2}}\\right)}$，约定 $\\Delta T_{1}  0$ 和 $\\Delta T_{2}  0$。\n\n假设：\n- 热负荷 $Q$ 和修正系数 $F$ 已知且无不确定性。\n- 不确定变量为总传热系数和终端温度，记为 $\\mathbf{x} = [U, T_{h,\\mathrm{in}}, T_{h,\\mathrm{out}}, T_{c,\\mathrm{in}}, T_{c,\\mathrm{out}}]^{\\top}$。\n- 变量 $\\mathbf{x}$ 被建模为多元正态分布，其均值向量为 $\\boldsymbol{\\mu}$，协方差矩阵为 $\\boldsymbol{\\Sigma}$，其中 $U$ 与所有温度无关。温度的不确定性可能如测试套件中所述是相关的。\n- 每个不确定变量的变异系数很小，因此一阶线性化（Gauss近似）有效。\n\n任务：\n1. 使用 $Q = UAF\\Delta T_{\\mathrm{lm}}$，将所需面积 $A$ 表示为 $U$ 和 $\\Delta T_{\\mathrm{lm}}$ 的函数。然后，用终端温度表示 $\\Delta T_{1}$ 和 $\\Delta T_{2}$，并由此用终端温度表示 $\\Delta T_{\\mathrm{lm}}$。\n2. 使用链式法则推导 $A$ 相对于变量 $\\mathbf{x}$ 的梯度（雅可比矩阵）。你必须提供 $\\Delta T_{\\mathrm{lm}}$ 相对于 $\\Delta T_{1}$ 和 $\\Delta T_{2}$ 的偏导数的闭合形式表达式。通过对这些导数取适当的极限来处理 $\\Delta T_{1} \\to \\Delta T_{2}$ 的极限情况。\n3. 使用一阶（线性）不确定度传播，计算 $A$ 的方差为 $\\mathrm{Var}(A) = \\mathbf{J}\\,\\boldsymbol{\\Sigma}\\,\\mathbf{J}^{\\top}$，其中 $\\mathbf{J}$ 是 $A$ 相对于 $\\mathbf{x}$ 的雅可比矩阵，在均值处求值。然后，假设 $A$ 服从正态分布，计算其 $95\\%$ 置信区间为 $A \\pm z\\,\\sigma_{A}$，其中 $z = 1.96$ 且 $\\sigma_{A} = \\sqrt{\\mathrm{Var}(A)}$。\n4. 在一个程序中实现此计算，为每个测试用例评估所需的平均面积和双边 $95\\%$ 置信区间。\n\n物理单位和数值报告：\n- 使用国际单位制。热负荷 $Q$ 的单位是瓦特（W），总传热系数 $U$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$，温度的单位是摄氏度（温差在开尔文和摄氏度下相等），面积 $A$ 的单位是平方米。\n- 以 $\\mathrm{m}^{2}$ 为单位报告面积结果，精确到小数点后四位。\n\n测试套件：\n- 案例 $1$（温度不相关，一般情况）：\n  - $Q = 1.20\\times 10^{6}\\ \\mathrm{W}$，$F = 0.95$，\n  - $U \\sim \\mathcal{N}(\\mu_{U} = 850,\\ \\sigma_{U} = 40)\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$，\n  - $T_{h,\\mathrm{in}} \\sim \\mathcal{N}(160,\\,0.5)$，$T_{h,\\mathrm{out}} \\sim \\mathcal{N}(110,\\,0.5)$，$T_{c,\\mathrm{in}} \\sim \\mathcal{N}(40,\\,0.5)$，$T_{c,\\mathrm{out}} \\sim \\mathcal{N}(85,\\,0.5)$，单位为 $\\mathrm{^{\\circ}C}$，\n  - 温度相关矩阵 $\\mathbf{R}_{T} = \\mathbf{I}_{4}$。\n- 案例 $2$（极限情况 $\\Delta T_{1} \\approx \\Delta T_{2}$，温度不相关）：\n  - $Q = 0.80\\times 10^{6}\\ \\mathrm{W}$，$F = 1.00$，\n  - $U \\sim \\mathcal{N}(\\mu_{U} = 1000,\\ \\sigma_{U} = 30)\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$，\n  - $T_{h,\\mathrm{in}} \\sim \\mathcal{N}(150,\\,0.2)$，$T_{h,\\mathrm{out}} \\sim \\mathcal{N}(100,\\,0.2)$，$T_{c,\\mathrm{in}} \\sim \\mathcal{N}(50,\\,0.2)$，$T_{c,\\mathrm{out}} \\sim \\mathcal{N}(100,\\,0.2)$，单位为 $\\mathrm{^{\\circ}C}$，\n  - 温度相关矩阵 $\\mathbf{R}_{T} = \\mathbf{I}_{4}$。\n- 案例 $3$（温度相关，一般情况）：\n  - $Q = 2.50\\times 10^{6}\\ \\mathrm{W}$，$F = 0.92$，\n  - $U \\sim \\mathcal{N}(\\mu_{U} = 700,\\ \\sigma_{U} = 70)\\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$，\n  - $T_{h,\\mathrm{in}} \\sim \\mathcal{N}(180,\\,1.0)$，$T_{h,\\mathrm{out}} \\sim \\mathcal{N}(120,\\,1.0)$，$T_{c,\\mathrm{in}} \\sim \\mathcal{N}(60,\\,0.8)$，$T_{c,\\mathrm{out}} \\sim \\mathcal{N}(100,\\,0.8)$，单位为 $\\mathrm{^{\\circ}C}$，\n  - 温度相关矩阵\n    $\\mathbf{R}_{T} =\n    \\begin{bmatrix}\n    1  0.8  -0.3  -0.1 \\\\\n    0.8  1  -0.1  -0.3 \\\\\n    -0.3  -0.1  1  0.7 \\\\\n    -0.1  -0.3  0.7  1\n    \\end{bmatrix}$。\n- 在所有案例中，$U$ 与温度无关，温度协方差矩阵为 $\\boldsymbol{\\Sigma}_{T} = \\mathbf{D}\\,\\mathbf{R}_{T}\\,\\mathbf{D}$，其中 $\\mathbf{D} = \\mathrm{diag}(\\sigma_{T_{h,\\mathrm{in}}}, \\sigma_{T_{h,\\mathrm{out}}}, \\sigma_{T_{c,\\mathrm{in}}}, \\sigma_{T_{c,\\mathrm{out}}})$。\n\n要求的程序输出格式：\n- 你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是三个浮点数的列表 $[A_{\\mathrm{mean}}, A_{\\mathrm{low}}, A_{\\mathrm{high}}]$，其中 $A_{\\mathrm{low}}$ 和 $A_{\\mathrm{high}}$ 是双边 $95\\%$ 置信区间的端点。因此，最终输出必须如下所示：\n  $[[a_{1},b_{1},c_{1}],[a_{2},b_{2},c_{2}],[a_{3},b_{3},c_{3}]]$\n  其中所有条目的单位均为 $\\mathrm{m}^{2}$，并精确到小数点后四位。", "solution": "该问题经过验证，被认为是科学上合理、提法得当且客观的。它呈现了一个涉及传热原理和统计不确定性分析的标准工程场景。所有必要的数据和定义都已提供，不存在内部矛盾或事实错误。该问题有效。\n\n解决方案按照要求从第一性原理出发推导必要的表达式。\n\n**任务1：所需面积的表达式**\n\n热负荷 $Q$ 由基本关系式给出：\n$$\nQ = U A F \\Delta T_{\\mathrm{lm}}\n$$\n其中 $U$ 是总传热系数，$A$ 是传热面积，$F$ 是修正系数，$\\Delta T_{\\mathrm{lm}}$ 是对数平均温差。\n\n解出面积 $A$ 可得：\n$$\nA = \\frac{Q}{U F \\Delta T_{\\mathrm{lm}}}\n$$\n逆流换热器的对数平均温差定义为：\n$$\n\\Delta T_{\\mathrm{lm}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)}\n$$\n其中终端温差 $\\Delta T_1$ 和 $\\Delta T_2$ 由下式给出：\n$$\n\\Delta T_1 = T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}} \\\\\n\\Delta T_2 = T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}\n$$\n将 $\\Delta T_{\\mathrm{lm}}$ 的表达式和终端温差代入 $A$ 的方程，我们得到面积作为不确定变量 $\\mathbf{x} = [U, T_{h,\\mathrm{in}}, T_{h,\\mathrm{out}}, T_{c,\\mathrm{in}}, T_{c,\\mathrm{out}}]^{\\top}$ 的函数：\n$$\nA(\\mathbf{x}) = \\frac{Q}{U F} \\left( \\frac{(T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}) - (T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}})}{\\ln\\left(\\frac{T_{h,\\mathrm{in}} - T_{c,\\mathrm{out}}}{T_{h,\\mathrm{out}} - T_{c,\\mathrm{in}}}\\right)} \\right)^{-1} = \\frac{Q}{U F} \\left( \\frac{\\ln(\\Delta T_1) - \\ln(\\Delta T_2)}{\\Delta T_1 - \\Delta T_2} \\right)\n$$\n其中 $Q$ 和 $F$ 被视作已知常数。\n\n**任务2：雅可比矩阵推导**\n\n为了应用一阶不确定度传播，我们必须计算 $A$ 相对于不确定变量向量 $\\mathbf{x}$ 的雅可比矩阵（梯度），并在其均值 $\\boldsymbol{\\mu}$ 处求值。雅可比矩阵是一个行向量：\n$$\n\\mathbf{J} = \\left[ \\frac{\\partial A}{\\partial U}, \\frac{\\partial A}{\\partial T_{h,\\mathrm{in}}}, \\frac{\\partial A}{\\partial T_{h,\\mathrm{out}}}, \\frac{\\partial A}{\\partial T_{c,\\mathrm{in}}}, \\frac{\\partial A}{\\partial T_{c,\\mathrm{out}}} \\right]_{\\mathbf{x}=\\boldsymbol{\\mu}}\n$$\n相对于 $U$ 的偏导数是直接的：\n$$\n\\frac{\\partial A}{\\partial U} = -\\frac{Q}{U^2 F \\Delta T_{\\mathrm{lm}}} = -\\frac{A}{U}\n$$\n对于温度的导数，我们应用链式法则。首先表示 $A$ 相对于 $\\Delta T_1$ 和 $\\Delta T_2$ 的导数更为方便。设 $C' = Q/(UF)$。\n$$\nA = C' \\left( \\frac{\\ln(\\Delta T_1) - \\ln(\\Delta T_2)}{\\Delta T_1 - \\Delta T_2} \\right)\n$$\n$A$ 相对于 $\\Delta T_1$ 的偏导数是：\n$$\n\\frac{\\partial A}{\\partial \\Delta T_1} = C' \\frac{\\frac{1}{\\Delta T_1}(\\Delta T_1 - \\Delta T_2) - (\\ln(\\Delta T_1) - \\ln(\\Delta T_2))(1)}{(\\Delta T_1 - \\Delta T_2)^2} = C' \\frac{1 - \\frac{\\Delta T_2}{\\Delta T_1} - \\ln\\left(\\frac{\\Delta T_1}{\\Delta T_2}\\right)}{(\\Delta T_1 - \\Delta T_2)^2}\n$$\n$A$ 相对于 $\\Delta T_2$ 的偏导数是：\n$$\n\\frac{\\partial A}{\\partial \\Delta T_2} = C' \\frac{-\\frac{1}{\\Delta T_2}(\\Delta T_1 - \\Delta T_2) - (\\ln(\\Delta T_1) - \\ln(\\Delta T_2))(-1)}{(\\Delta T_1 - \\Delta T_2)^2} = C' \\frac{-\\frac{\\Delta T_1}{\\Delta T_2} + 1 + \\ln\\left(\\frac{\\Delta T_1}{\\Delta T_2}\\right)}{(\\Delta T_1 - \\Delta T_2)^2}\n$$\n现在，再次使用链式法则和 $\\Delta T_1$、$\\Delta T_2$ 的定义：\n$$\n\\frac{\\partial A}{\\partial T_j} = \\frac{\\partial A}{\\partial \\Delta T_1} \\frac{\\partial \\Delta T_1}{\\partial T_j} + \\frac{\\partial A}{\\partial \\Delta T_2} \\frac{\\partial \\Delta T_2}{\\partial T_j}\n$$\n$\\Delta T_1$ 和 $\\Delta T_2$ 的导数是：\n$$\n\\frac{\\partial \\Delta T_1}{\\partial T_{h,\\mathrm{in}}} = 1, \\quad \\frac{\\partial \\Delta T_1}{\\partial T_{c,\\mathrm{out}}} = -1 \\quad (\\text{其他导数为 } 0) \\\\\n\\frac{\\partial \\Delta T_2}{\\partial T_{h,\\mathrm{out}}} = 1, \\quad \\frac{\\partial \\Delta T_2}{\\partial T_{c,\\mathrm{in}}} = -1 \\quad (\\text{其他导数为 } 0)\n$$\n结合这些结果，得到雅可比矩阵中温度分量的表达式：\n$$\n\\frac{\\partial A}{\\partial T_{h,\\mathrm{in}}} = \\frac{\\partial A}{\\partial \\Delta T_1}, \\quad \\frac{\\partial A}{\\partial T_{h,\\mathrm{out}}} = \\frac{\\partial A}{\\partial \\Delta T_2}, \\quad \\frac{\\partial A}{\\partial T_{c,\\mathrm{in}}} = -\\frac{\\partial A}{\\partial \\Delta T_2}, \\quad \\frac{\\partial A}{\\partial T_{c,\\mathrm{out}}} = -\\frac{\\partial A}{\\partial \\Delta T_1}\n$$\n当 $\\Delta T_1 \\to \\Delta T_2$ 时，这些表达式在数值上不稳定。在此极限下，$\\Delta T_{\\mathrm{lm}} \\to \\Delta T_1 = \\Delta T_2 \\equiv \\Delta T$。导数变成 $0/0$ 的不定形式。我们必须使用 L'Hôpital's rule 或泰勒级数展开来评估极限。设 $\\Delta T_1 = \\Delta T(1+\\epsilon)$ 和 $\\Delta T_2 = \\Delta T$。当 $\\epsilon \\to 0$ 时：\n$$\n\\lim_{\\Delta T_1 \\to \\Delta T} \\frac{\\partial A}{\\partial \\Delta T_1} = -\\frac{Q}{2 U F (\\Delta T)^2} = -\\frac{A}{2 \\Delta T}\n$$\n根据对称性，对 $\\partial A / \\partial \\Delta T_2$ 也存在类似结果：\n$$\n\\lim_{\\Delta T_2 \\to \\Delta T} \\frac{\\partial A}{\\partial \\Delta T_2} = -\\frac{A}{2 \\Delta T}\n$$\n因此，对于 $\\Delta T_1 \\approx \\Delta T_2$ 的极限情况，相对于温度的偏导数可近似为：\n$$\n\\frac{\\partial A}{\\partial T_{h,\\mathrm{in}}} \\approx -\\frac{A}{2\\Delta T_1}, \\quad \\frac{\\partial A}{\\partial T_{h,\\mathrm{out}}} \\approx -\\frac{A}{2\\Delta T_2}, \\quad \\frac{\\partial A}{\\partial T_{c,\\mathrm{in}}} \\approx \\frac{A}{2\\Delta T_2}, \\quad \\frac{\\partial A}{\\partial T_{c,\\mathrm{out}}} \\approx \\frac{A}{2\\Delta T_1}\n$$\n\n**任务3：不确定度传播与置信区间**\n\n$A$ 的方差的一阶近似，记为 $\\mathrm{Var}(A)$ 或 $\\sigma_A^2$，由矩阵方程给出：\n$$\n\\sigma_A^2 = \\mathbf{J}\\,\\boldsymbol{\\Sigma}\\,\\mathbf{J}^{\\top}\n$$\n其中 $\\mathbf{J}$ 是在均值 $\\boldsymbol{\\mu}$ 处求值的雅可比向量，$\\boldsymbol{\\Sigma}$ 是变量 $\\mathbf{x}$ 的协方差矩阵。由于 $U$ 与温度无关，协方差矩阵 $\\boldsymbol{\\Sigma}$ 具有块对角结构：\n$$\n\\boldsymbol{\\Sigma} = \\begin{bmatrix} \\sigma_U^2  \\mathbf{0}_{1 \\times 4} \\\\ \\mathbf{0}_{4 \\times 1}  \\boldsymbol{\\Sigma}_T \\end{bmatrix}\n$$\n这里，$\\sigma_U^2 = \\mathrm{Var}(U)$，$\\boldsymbol{\\Sigma}_T$ 是温度的 $4 \\times 4$ 协方差矩阵。问题指定 $\\boldsymbol{\\Sigma}_T = \\mathbf{D}\\,\\mathbf{R}_{T}\\,\\mathbf{D}$，其中 $\\mathbf{R}_T$ 是温度相关矩阵，$\\mathbf{D}$ 是温度标准差的对角矩阵。\n\n方差计算可以展开为：\n$$\n\\sigma_A^2 = \\left(\\frac{\\partial A}{\\partial U}\\right)^2 \\sigma_U^2 + \\mathbf{J}_T \\boldsymbol{\\Sigma}_T \\mathbf{J}_T^{\\top}\n$$\n其中 $\\mathbf{J}_T = \\left[ \\frac{\\partial A}{\\partial T_{h,\\mathrm{in}}}, \\frac{\\partial A}{\\partial T_{h,\\mathrm{out}}}, \\frac{\\partial A}{\\partial T_{c,\\mathrm{in}}}, \\frac{\\partial A}{\\partial T_{c,\\mathrm{out}}} \\right]$。所有偏导数均在输入变量的均值处求值。\n\n假设 $A$ 的结果分布近似为正态分布，则双边 $95\\%$ 置信区间构建为：\n$$\n[A_{\\mathrm{low}}, A_{\\mathrm{high}}] = [A_{\\mathrm{mean}} - z\\,\\sigma_{A}, A_{\\mathrm{mean}} + z\\,\\sigma_{A}]\n$$\n其中 $A_{\\mathrm{mean}}$ 是使用所有输入的均值计算的面积，$\\sigma_A = \\sqrt{\\sigma_A^2}$，$z=1.96$ 是对应于 $95\\%$ 置信水平的标准正态分布的分位数。\n\n**任务4：实现**\n\n计算过程实现如下：\n1.  对于每个测试用例，计算 $\\Delta T_1$ 和 $\\Delta T_2$ 的均值。\n2.  计算对数平均温差的均值 $\\Delta T_{\\mathrm{lm}}$。使用容差检查：如果 $|\\Delta T_1 - \\Delta T_2|$ 相对于其量级非常小，则使用极限值 $\\Delta T_{\\mathrm{lm}} = \\Delta T_1$。\n3.  计算平均面积 $A_{\\mathrm{mean}}$。\n4.  基于相同的容差检查，使用通用导数公式或极限情况公式计算雅可比向量 $\\mathbf{J}$。\n5.  构建 $5 \\times 5$ 的协方差矩阵 $\\boldsymbol{\\Sigma}$。\n6.  通过矩阵乘积 $\\mathbf{J}\\,\\boldsymbol{\\Sigma}\\,\\mathbf{J}^{\\top}$ 计算方差 $\\sigma_A^2$。\n7.  通过对方差取平方根找到标准差 $\\sigma_A$。\n8.  计算 $95\\%$ 置信区间的下限和上限，并将所有结果四舍五入到小数点后四位。\n此过程封装在一个Python程序中，以处理指定的测试套件。", "answer": "```python\nimport numpy as np\n\ndef calculate_area_uncertainty(Q, F, mu_U, sigma_U, mu_temps, sigma_temps, R_T):\n    \"\"\"\n    Calculates the mean required area and its 95% confidence interval.\n    \n    Args:\n        Q (float): Heat duty in W.\n        F (float): Correction factor.\n        mu_U (float): Mean of the overall heat transfer coefficient in W/m^2/K.\n        sigma_U (float): Standard deviation of U.\n        mu_temps (list[float]): Mean temperatures [Th_in, Th_out, Tc_in, Tc_out] in Celsius.\n        sigma_temps (list[float]): Standard deviations of temperatures.\n        R_T (np.ndarray): 4x4 temperature correlation matrix.\n\n    Returns:\n        tuple[float, float, float]: Mean area, lower CI bound, upper CI bound.\n    \"\"\"\n    z_95 = 1.96\n    \n    # Unpack mean temperatures\n    mu_Th_in, mu_Th_out, mu_Tc_in, mu_Tc_out = mu_temps\n\n    # 1. Calculate mean values\n    mu_dT1 = mu_Th_in - mu_Tc_out\n    mu_dT2 = mu_Th_out - mu_Tc_in\n\n    # Handle LMTD calculation, including the limiting case\n    if abs(mu_dT1 - mu_dT2)  1e-9 * (mu_dT1 + mu_dT2):\n        mu_dT_lm = mu_dT1\n    else:\n        mu_dT_lm = (mu_dT1 - mu_dT2) / np.log(mu_dT1 / mu_dT2)\n    \n    # Mean Area\n    A_mean = Q / (mu_U * F * mu_dT_lm)\n\n    # 2. Derive Jacobian\n    J = np.zeros(5) # [dU, dTh_in, dTh_out, dTc_in, dTc_out]\n\n    # Partial derivative with respect to U\n    J[0] = -A_mean / mu_U\n\n    # Partial derivatives with respect to temperatures\n    # Use limiting case approximation if dT1 and dT2 are very close\n    if abs(mu_dT1 - mu_dT2)  1e-9 * (mu_dT1 + mu_dT2):\n        # Limiting form of derivatives\n        dAdT1 = -A_mean / (2 * mu_dT1)\n        dAdT2 = -A_mean / (2 * mu_dT2)\n    else:\n        # General form of derivatives\n        C_prime = Q / (mu_U * F)\n        log_ratio = np.log(mu_dT1 / mu_dT2)\n        diff_sq = (mu_dT1 - mu_dT2)**2\n        \n        dAdT1 = C_prime * (1 - mu_dT2 / mu_dT1 - log_ratio) / diff_sq\n        dAdT2 = C_prime * (-mu_dT1 / mu_dT2 + 1 + log_ratio) / diff_sq\n\n    # Map derivatives of dT's to derivatives of T's\n    J[1] = dAdT1   # d/dTh_in\n    J[2] = dAdT2   # d/dTh_out\n    J[3] = -dAdT2  # d/dTc_in\n    J[4] = -dAdT1  # d/dTc_out\n    \n    # 3. Construct covariance matrix\n    # Temperature covariance matrix Sigma_T = D * R_T * D\n    D_T = np.diag(sigma_temps)\n    Sigma_T = D_T @ R_T @ D_T\n\n    # Full 5x5 covariance matrix Sigma\n    Sigma = np.zeros((5, 5))\n    Sigma[0, 0] = sigma_U**2\n    Sigma[1:, 1:] = Sigma_T\n    \n    # 4. Compute variance of Area\n    var_A = J @ Sigma @ J.T\n    sigma_A = np.sqrt(var_A)\n    \n    # 5. Compute confidence interval\n    A_low = A_mean - z_95 * sigma_A\n    A_high = A_mean + z_95 * sigma_A\n    \n    # Return rounded results\n    return (\n        round(A_mean, 4), \n        round(A_low, 4), \n        round(A_high, 4)\n    )\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for heat exchanger uncertainty analysis.\n    \"\"\"\n    test_cases = [\n        # Case 1: Independent temperatures, general case\n        {\n            \"Q\": 1.20e6, \"F\": 0.95,\n            \"mu_U\": 850, \"sigma_U\": 40,\n            \"mu_temps\": [160, 110, 40, 85],\n            \"sigma_temps\": [0.5, 0.5, 0.5, 0.5],\n            \"R_T\": np.identity(4)\n        },\n        # Case 2: Limiting case dT1 approx dT2\n        {\n            \"Q\": 0.80e6, \"F\": 1.00,\n            \"mu_U\": 1000, \"sigma_U\": 30,\n            \"mu_temps\": [150, 100, 50, 100],\n            \"sigma_temps\": [0.2, 0.2, 0.2, 0.2],\n            \"R_T\": np.identity(4)\n        },\n        # Case 3: Correlated temperatures, general case\n        {\n            \"Q\": 2.50e6, \"F\": 0.92,\n            \"mu_U\": 700, \"sigma_U\": 70,\n            \"mu_temps\": [180, 120, 60, 100],\n            \"sigma_temps\": [1.0, 1.0, 0.8, 0.8],\n            \"R_T\": np.array([\n                [1,    0.8, -0.3, -0.1],\n                [0.8,  1,   -0.1, -0.3],\n                [-0.3, -0.1,  1,    0.7],\n                [-0.1, -0.3,  0.7,    1]\n            ])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_area_uncertainty(\n            case[\"Q\"], case[\"F\"], case[\"mu_U\"], case[\"sigma_U\"],\n            case[\"mu_temps\"], case[\"sigma_temps\"], case[\"R_T\"]\n        )\n        # Format each result as a list of floats for the final output\n        results.append(list(result))\n\n    # Format the final output string exactly as required\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2528904"}]}