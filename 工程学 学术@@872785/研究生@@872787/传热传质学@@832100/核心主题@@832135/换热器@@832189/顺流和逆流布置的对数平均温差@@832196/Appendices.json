{"hands_on_practices": [{"introduction": "在进行换热器面积的详细计算之前，首要任务是确认所提出的操作条件在热力学上是否可行。本练习将引导你通过一个具体案例，检验一个平行流换热器设计方案是否会违反热力学第二定律，即出现“温度交叉”现象。掌握这种基本的可行性分析是所有换热器设计与分析工作的基础。[@problem_id:2501368]", "problem": "一个单程管式换热器用于使用液态水冷却一股热油流，轴向热传导可忽略不计，物性恒定，且无热量损失至周围环境。热油入口温度为 $T_{h,\\mathrm{in}} = 140\\,^{\\circ}\\mathrm{C}$，热容率为 $C_{h} = 4\\,\\mathrm{kW/K}$，水入口温度为 $T_{c,\\mathrm{in}} = 20\\,^{\\circ}\\mathrm{C}$，热容率为 $C_{c} = 6\\,\\mathrm{kW/K}$。工艺要求热油出口温度为 $T_{h,\\mathrm{out}} = 50\\,^{\\circ}\\mathrm{C}$。设计团队提出了一种并流方案。\n\n仅使用第一性原理——即稳态能量平衡、给定流动布置下的端点温差定义，以及热力学第二定律对于显热换熱器局部温差驱动力不得改變符号的要求——判断所提出的并流设计是否可行，即对数平均温差（LMTD）是否保持非负实数。如果所提出的布置不可行，请确定一个可行的替代布置（如果有的话）以实现所述目标，并确定在稳态下满足该热负荷所需的相应最小总传热系数 $U A$。\n\n假设总传热系数 $U$ 和传热面积 $A$ 是均匀的，并且总传热速率通过标准的LMTD方法与对数平均温差相关。\n\n选择所有正确的陈述：\n\n- A. 并流设计是可行的；对数平均温差为正，且所需的 $U A$ 等于 $8.31\\,\\mathrm{kW/K}$。\n\n- B. 并流设计是不可行的，因为出口端温差将为负，导致对数平均温差为非实数（违反了第二定律）。\n\n- C. 对于所述目标，并流和逆流布置都是可行的，且所需的 $U A$ 相同。\n\n- D. 逆流布置是可行的；所需的 $U A$ 约等于 $8.31\\,\\mathrm{kW/K}$。", "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知条件\n- 热流体入口温度：$T_{h,\\mathrm{in}} = 140\\,^{\\circ}\\mathrm{C}$\n- 热流体热容率：$C_{h} = 4\\,\\mathrm{kW/K}$\n- 冷流体入口温度：$T_{c,\\mathrm{in}} = 20\\,^{\\circ}\\mathrm{C}$\n- 冷流体热容率：$C_{c} = 6\\,\\mathrm{kW/K}$\n- 要求的热流体出口温度：$T_{h,\\mathrm{out}} = 50\\,^{\\circ}\\mathrm{C}$\n- 提议的布置：并流。\n- 假设：单程管式换热器，轴向热传导可忽略不计，物性恒定，无热量损失至周围环境，总传热系数 $U$ 和面积 $A$ 均匀。\n- 要求分析：使用第一性原理（包括第二定律约束）确定并流设计的可行性。如果不可行，评估一个可行的替代方案及其所需的总传热系数 $UA$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及基于热力学第一定律和第二定律的标准热工分析。问题提法很严谨，提供了足够的数据来进行所要求的可行性分析和计算。语言客观精确。物理数值是现实的。没有矛盾或模糊不清之处。\n\n### 步骤3：结论与行动\n问题有效。将继续进行求解。\n\n### 推导\n\n分析始于稳态能量平衡，这是热力学第一定律的应用。由于热损失可忽略不计，从热流体传递的热量必须等于冷流体吸收的热量。\n\n总传热速率 $\\dot{Q}$ 由热流体的指定条件确定：\n$$ \\dot{Q} = C_{h} (T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}}) $$\n代入给定值：\n$$ \\dot{Q} = (4\\,\\mathrm{kW/K}) \\times (140\\,^{\\circ}\\mathrm{C} - 50\\,^{\\circ}\\mathrm{C}) = 4 \\times 90 \\,\\mathrm{kW} = 360\\,\\mathrm{kW} $$\n\n利用这个热速率，我们可以从冷流的能量平衡中确定冷流体的出口温度 $T_{c,\\mathrm{out}}$：\n$$ \\dot{Q} = C_{c} (T_{c,\\mathrm{out}} - T_{c,\\mathrm{in}}) $$\n$$ 360\\,\\mathrm{kW} = (6\\,\\mathrm{kW/K}) \\times (T_{c,\\mathrm{out}} - 20\\,^{\\circ}\\mathrm{C}) $$\n求解 $T_{c,\\mathrm{out}}$：\n$$ T_{c,\\mathrm{out}} - 20\\,^{\\circ}\\mathrm{C} = \\frac{360\\,\\mathrm{kW}}{6\\,\\mathrm{kW/K}} = 60\\,\\mathrm{K} = 60\\,^{\\circ}\\mathrm{C} $$\n$$ T_{c,\\mathrm{out}} = 20\\,^{\\circ}\\mathrm{C} + 60\\,^{\\circ}\\mathrm{C} = 80\\,^{\\circ}\\mathrm{C} $$\n\n**并流布置的可行性**\n\n现在我们评估所提出的并流布置的可行性。在并流换热器中，两种流体在同一端（我们称之为“1”端）进入，在另一端（“2”端）流出。为了使热量在换热器沿线的每一点都从热流体传递到冷流体，热力学第二定律要求对于所有位置 $x$ 都有 $T_h(x) \\ge T_c(x)$。这也必须在边界上成立。\n\n在入口（1端）：\n$T_{h,1} = T_{h,\\mathrm{in}} = 140\\,^{\\circ}\\mathrm{C}$\n$T_{c,1} = T_{c,\\mathrm{in}} = 20\\,^{\\circ}\\mathrm{C}$\n温差为 $\\Delta T_1 = T_{h,1} - T_{c,1} = 140 - 20 = 120\\,^{\\circ}\\mathrm{C}$。这里，$T_h > T_c$，是有效的。\n\n在出口（2端）：\n$T_{h,2} = T_{h,\\mathrm{out}} = 50\\,^{\\circ}\\mathrm{C}$\n$T_{c,2} = T_{c,\\mathrm{out}} = 80\\,^{\\circ}\\mathrm{C}$\n温差为 $\\Delta T_2 = T_{h,2} - T_{c,2} = 50 - 80 = -30\\,^{\\circ}\\mathrm{C}$。\n\n热流体的出口温度（$50\\,^{\\circ}\\mathrm{C}$）低于冷流体的出口温度（$80\\,^{\\circ}\\mathrm{C}$）。这种情况在并流布置中是物理上不可能的，因为它将需要在出口附近从较冷的流体向较热的流体传热，这直接违反了热力学第二定律。这种情况被称为“温度交叉”，并使设计不可行。因此，此配置的对数平均温差（LMTD）由 $\\Delta T_{\\mathrm{lm}} = (\\Delta T_1 - \\Delta T_2) / \\ln(\\Delta T_1 / \\Delta T_2)$ 给出，将涉及负数的对数（$\\ln(120/(-30))$），这不是一个实数。因此，并流设计是不可行的。\n\n**逆流布置的可行性**\n\n我们现在研究替代的逆流布置。在这种配置中，流体从相对的两端进入。设“1”端为热流体入口和冷流体出口，“2”端为热流体出口和冷流体入口。\n\n在1端：\n$T_{h,1} = T_{h,\\mathrm{in}} = 140\\,^{\\circ}\\mathrm{C}$\n$T_{c,1} = T_{c,\\mathrm{out}} = 80\\,^{\\circ}\\mathrm{C}$\n温差为 $\\Delta T_1 = T_{h,1} - T_{c,1} = 140 - 80 = 60\\,^{\\circ}\\mathrm{C}$。\n\n在2端：\n$T_{h,2} = T_{h,\\mathrm{out}} = 50\\,^{\\circ}\\mathrm{C}$\n$T_{c,2} = T_{c,\\mathrm{in}} = 20\\,^{\\circ}\\mathrm{C}$\n温差为 $\\Delta T_2 = T_{h,2} - T_{c,2} = 50 - 20 = 30\\,^{\\circ}\\mathrm{C}$。\n\n两个端点的温差都是正的。对于物性恒定的逆流换热器，如果 $\\Delta T_1 > 0$ 和 $\\Delta T_2 > 0$，那么局部温差 $T_h(x) - T_c(x)$ 在整个换热器内都将是正的。因此，逆流布置在热力学上是可行的。\n\n现在，我们计算逆流情况下的 LMTD：\n$$ \\Delta T_{\\mathrm{lm, counter}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)} = \\frac{60\\,\\mathrm{K} - 30\\,\\mathrm{K}}{\\ln(60/30)} = \\frac{30\\,\\mathrm{K}}{\\ln(2)} $$\n使用 $\\ln(2) \\approx 0.693147$：\n$$ \\Delta T_{\\mathrm{lm, counter}} \\approx \\frac{30}{0.693147} \\,\\mathrm{K} \\approx 43.28\\,\\mathrm{K} $$\n\n确定 LMTD 后，所需的总传热系数 $UA$ 可以从基本换热器方程 $\\dot{Q} = (UA) \\Delta T_{\\mathrm{lm}}$ 计算得出：\n$$ UA = \\frac{\\dot{Q}}{\\Delta T_{\\mathrm{lm, counter}}} = \\frac{360\\,\\mathrm{kW}}{30/\\ln(2)\\,\\mathrm{K}} = \\frac{360}{30} \\ln(2) \\,\\mathrm{kW/K} = 12 \\ln(2) \\,\\mathrm{kW/K} $$\n$$ UA \\approx 12 \\times 0.693147 \\,\\mathrm{kW/K} \\approx 8.31776\\,\\mathrm{kW/K} $$\n这个值约等于 $8.31\\,\\mathrm{kW/K}$。\n\n### 逐项分析\n\n- **A. 并流设计是可行的；对数平均温差为正，且所需的 $UA$ 等于 $8.31\\,\\mathrm{kW/K}$。**\n并流设计已被证明由于温度交叉而热力学上不可行，这违反了第二定律。因此，该陈述是**错误**的。\n\n- **B. 并流设计是不可行的，因为出口端温差将为负，导致对数平均温差为非实数（违反了第二定律）。**\n我们的分析表明，对于并流布置，出口温差为 $T_{h,\\mathrm{out}} - T_{c,\\mathrm{out}} = 50\\,^{\\circ}\\mathrm{C} - 80\\,^{\\circ}\\mathrm{C} = -30\\,^{\\circ}\\mathrm{C}$。负温差意味着对于显热换热器违反了热力学第二定律。LMTD的计算将涉及负数的对数，这是一个非实数（复数）值。该陈述是严谨正确的。结论是**正确**的。\n\n- **C. 对于所述目标，并流和逆流布置都是可行的，且所需的 $UA$ 相同。**\n并流布置是不可行的。这立即证伪了该陈述。此外，即使两者都可行，逆流的LMTD总是大于或等于并流的LMTD，这意味着逆流情况所需的 $UA$ 会更小，而不是相同。该陈述是**错误**的。\n\n- **D. 逆流布置是可行的；所需的 $UA$ 约等于 $8.31\\,\\mathrm{kW/K}$。**\n我们的分析证实了逆流布置在热力学上是可行的。所需总传热系数的计算得出 $UA = 12 \\ln(2)\\,\\mathrm{kW/K}$，约等于 $8.318\\,\\mathrm{kW/K}$。陈述中的值 $8.31\\,\\mathrm{kW/K}$ 是一个正确的近似值。该陈述与从第一性原理的推导完全一致。结论是**正确**的。", "answer": "$$\\boxed{BD}$$", "id": "2501368"}, {"introduction": "确认了设计方案的可行性后，下一步便是确定所需的换热面积。本练习聚焦于一个极具挑战性的设计情景：换热器在一端以非常小的温差（即“近夹点”）运行。通过这个练习，你将深入理解在这种极限工况下，所需的换热面积如何对对数平均温差（LMTD）表现出高度敏感性，并揭示其对设备成本和运行稳定性的实际影响。[@problem_id:2501386]", "problem": "一个无相变、物性恒定的单程管式换热器需要进行尺寸设计，以在两股单相流体之间传递给定的热负荷。总传热系数 (U) 可被视为空间均匀，无环境热损失，且每股流体内的轴向热传导和横向混合可忽略不计。考虑并流或逆流两种排列方式。设在轴向位置 $x$ 处，热、冷流体之间的局部温差表示为 $\\Delta T(x)$，换热器两端的温差分别表示为 $\\Delta T_1$ 和 $\\Delta T_2$。\n\n仅从局部热通量关系 $d\\dot{Q}=U\\,\\Delta T\\,dA$ 和微分能量平衡 $d\\dot{Q}=-C_h\\,dT_h=\\pm C_c\\,dT_c$（其中符号由流动排列方式决定）出发，推导出一个精确表达式，用于表示关联总热负荷 $\\dot{Q}$、面积 $A$ 和两端温差 $\\Delta T_1$、$\\Delta T_2$ 的平均温差。然后，分析其中一个端点温差远小于另一个的极限情况，即 $\\Delta T_s \\ll \\Delta T_\\ell$（其中 $\\Delta T_s=\\min\\{\\Delta T_1,\\Delta T_2\\}$ 且 $\\Delta T_\\ell=\\max\\{\\Delta T_1,\\Delta T_2\\}$），并求出此极限下平均温差的主阶渐近行为。\n\n一位工程师报告说，对于一个设想的近夹点设计，两个端点温差分别为 $\\Delta T_1=20.0\\,\\mathrm{K}$ 和 $\\Delta T_2=0.50\\,\\mathrm{K}$。所需热负荷为 $\\dot{Q}=2.00\\times 10^6\\,\\mathrm{W}$，总传热系数为 $U=1.00\\times 10^3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。使用你推导出的平均温差，根据这些端点温差计算所需的面积 $A$。然后，如果将较小的端点温差四舍五入并记录为 $\\Delta T_2=1.0\\,\\mathrm{K}$，请重新计算 $A$ 来评估粗略数值修约的影响，并报告计算出的面积的百分比变化。所有推理都必须基于上述基本平衡关系，不得援引任何其他关联式。\n\n根据你的推导和计算，以下哪些陈述是正确的？\n\nA. 在并流或逆流的 $\\Delta T_s \\ll \\Delta T_\\ell$ 情况下，平均温差渐近于 $\\Delta T_\\mathrm{mean}\\sim \\dfrac{\\Delta T_\\ell}{\\ln\\!\\left(\\dfrac{\\Delta T_\\ell}{\\Delta T_s}\\right)}$，因此对于固定的 $\\dot{Q}$ 和 $U$，当 $\\Delta T_s\\to 0^+$ 时，所需面积像 $\\ln\\!\\left(\\dfrac{\\Delta T_\\ell}{\\Delta T_s}\\right)$ 一样发散。\n\nB. 在逆流情况下，当一个端点温差远小于另一个时，平均温差可取为算术平均值 $\\dfrac{\\Delta T_1+\\Delta T_2}{2}$，这可以防止所需面积在 $\\Delta T_s\\to 0^+$ 时发散。\n\nC. 将较小的端点温差从 $0.50\\,\\mathrm{K}$ 修约到 $1.0\\,\\mathrm{K}$，平均温差的变化小于 $1\\,\\%$，因此这种修约对近夹点设计的面积确定影响可以忽略不计。\n\nD. 如果由于 $\\Delta T_1$ 和 $\\Delta T_2$ 的符号约定，平均温差的数值计算得出负值，应通过取绝对值来强制其为正；这对可行性或面积设计没有影响，因为只有大小才重要。\n\nE. 对于固定的入口温度和热容率，逆流比并流产生更大的平均温差；然而，当一个端点温差被驱使到远小于另一个时，两种排列方式都表现出选项A中所体现的相同的对数惩罚，所需面积以相同的渐近方式无界增长。", "solution": "问题陈述具有科学依据，提法得当且客观。它提出了一个传热理论中的标准问题——基于基本原理推导和应用对数平均温差 (LMTD)。所提供的数据在物理上是一致的，并且为获得唯一解提供了所有必要信息。该问题是有效的。\n\n我们首先从给定的基本关系式推导平均温差的表达式。设换热器沿程的位置由累积传热面积 $a$ 参数化，从 $a=0$ 到 $a=A$。局部温差为 $\\Delta T(a) = T_h(a) - T_c(a)$。控制方程如下：\n1. $d\\dot{Q} = U \\, \\Delta T \\, da$\n2. $d\\dot{Q} = -C_h \\, dT_h$\n3. $d\\dot{Q} = \\eta C_c \\, dT_c$，其中 $\\eta$ 取决于流动排列方式。\n\n由此，我们可以将温度的微分表示为 $dT_h = -d\\dot{Q}/C_h$ 和 $dT_c = d\\dot{Q}/(\\eta C_c)$。温差 $\\Delta T$ 的微分为 $d(\\Delta T) = dT_h - dT_c$。代入 $dT_h$ 和 $dT_c$ 的表达式：\n$$d(\\Delta T) = -\\frac{d\\dot{Q}}{C_h} - \\frac{d\\dot{Q}}{\\eta C_c} = -d\\dot{Q} \\left( \\frac{1}{C_h} + \\frac{1}{\\eta C_c} \\right)$$\n现在，我们代入 $d\\dot{Q} = U \\Delta T da$：\n$$d(\\Delta T) = -U \\Delta T da \\left( \\frac{1}{C_h} + \\frac{1}{\\eta C_c} \\right)$$\n分离变量，我们得到：\n$$\\frac{d(\\Delta T)}{\\Delta T} = -U \\left( \\frac{1}{C_h} + \\frac{1}{\\eta C_c} \\right) da$$\n我们对该表达式在换热器的整个长度上进行积分，从面积 $a=0$ 到 $a=A$，对应于端点温差 $\\Delta T_1$ 和 $\\Delta T_2$：\n$$\\int_{\\Delta T_1}^{\\Delta T_2} \\frac{d(\\Delta T)}{\\Delta T} = -U \\left( \\frac{1}{C_h} + \\frac{1}{\\eta C_c} \\right) \\int_0^A da$$\n$$\\ln\\left(\\frac{\\Delta T_2}{\\Delta T_1}\\right) = -U A \\left( \\frac{1}{C_h} + \\frac{1}{\\eta C_c} \\right)$$\n为了继续推导，我们必须针对两种流动排列方式计算括号中的项。总传热速率为 $\\dot{Q}$。\n\n情况1：并流\n热、冷流体从同一端（$a=0$）进入，并从另一端（$a=A$）流出。冷流体温度沿流动方向升高，因此 $\\eta=+1$。\n能量平衡方程为 $\\dot{Q} = C_h (T_{h,in} - T_{h,out})$ 和 $\\dot{Q} = C_c (T_{c,out} - T_{c,in})$。括号中的项为：\n$$\\frac{1}{C_h} + \\frac{1}{C_c} = \\frac{T_{h,in} - T_{h,out}}{\\dot{Q}} + \\frac{T_{c,out} - T_{c,in}}{\\dot{Q}} = \\frac{(T_{h,in} - T_{c,in}) - (T_{h,out} - T_{c,out})}{\\dot{Q}}$$\n端点温差为 $\\Delta T_1 = T_{h,in} - T_{c,in}$ 和 $\\Delta T_2 = T_{h,out} - T_{c,out}$。因此：\n$$\\frac{1}{C_h} + \\frac{1}{C_c} = \\frac{\\Delta T_1 - \\Delta T_2}{\\dot{Q}}$$\n\n情况2：逆流\n流体从相对的两端进入。设热流体从 $a=0$ 进入，冷流体从 $a=A$ 进入。冷流体温度沿着坐标 $a$ 减小，因此 $\\eta=-1$。\n能量平衡方程为 $\\dot{Q} = C_h (T_{h,in} - T_{h,out})$ 和 $\\dot{Q} = C_c (T_{c,in} - T_{c,out})$。等等，总变化仍然是增加的，$\\dot{Q} = C_c(T_{c,out} - T_{c,in})$。符号约定来自微分形式。对于 $da>0$，$dT_c0$，所以 $d\\dot{Q} = -C_c dT_c$，意味着在 $d\\dot{Q}=\\eta C_c dT_c$ 的框架下 $\\eta=-1$。\n括号中的项为：\n$$\\frac{1}{C_h} - \\frac{1}{C_c} = \\frac{T_{h,in} - T_{h,out}}{\\dot{Q}} - \\frac{T_{c,out} - T_{c,in}}{\\dot{Q}} = \\frac{(T_{h,in} - T_{c,out}) - (T_{h,out} - T_{c,in})}{\\dot{Q}}$$\n端点温差为 $\\Delta T_1 = T_{h,in} - T_{c,out}$ 和 $\\Delta T_2 = T_{h,out} - T_{c,in}$。因此：\n$$\\frac{1}{C_h} - \\frac{1}{C_c} = \\frac{\\Delta T_1 - \\Delta T_2}{\\dot{Q}}$$\n\n对于这两种情况，我们将此结果代回到积分方程中：\n$$\\ln\\left(\\frac{\\Delta T_2}{\\Delta T_1}\\right) = -U A \\left( \\frac{\\Delta T_1 - \\Delta T_2}{\\dot{Q}} \\right) = U A \\left( \\frac{\\Delta T_2 - \\Delta T_1}{\\dot{Q}} \\right)$$\n整理以求解 $\\dot{Q}$，得到最终关系式：\n$$\\dot{Q} = U A \\frac{\\Delta T_2 - \\Delta T_1}{\\ln(\\Delta T_2 / \\Delta T_1)} = U A \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)}$$\n这就将平均温差定义为对数平均温差 (LMTD)，即 $\\Delta T_{LMTD}$：\n$$\\Delta T_{mean} = \\Delta T_{LMTD} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)}$$\n\n接下来，我们分析一个端点温差远小于另一个时的渐近行为。设 $\\Delta T_s = \\min\\{\\Delta T_1, \\Delta T_2\\}$ 和 $\\Delta T_\\ell = \\max\\{\\Delta T_1, \\Delta T_2\\}$。LMTD 可以写成：\n$$\\Delta T_{LMTD} = \\frac{\\Delta T_\\ell - \\Delta T_s}{\\ln(\\Delta T_\\ell / \\Delta T_s)}$$\n在 $\\Delta T_s \\ll \\Delta T_\\ell$ 的极限下，令 $\\epsilon = \\Delta T_s / \\Delta T_\\ell \\to 0^+$。\n$$\\Delta T_{LMTD} = \\frac{\\Delta T_\\ell (1 - \\epsilon)}{\\ln(1/\\epsilon)} = \\frac{\\Delta T_\\ell (1 - \\epsilon)}{-\\ln(\\epsilon)}$$\n当 $\\epsilon \\to 0$ 时，项 $(1 - \\epsilon) \\to 1$。因此，主阶渐近行为是：\n$$\\Delta T_{LMTD} \\sim \\frac{\\Delta T_\\ell}{-\\ln(\\epsilon)} = \\frac{\\Delta T_\\ell}{\\ln(1/\\epsilon)} = \\frac{\\Delta T_\\ell}{\\ln(\\Delta T_\\ell / \\Delta T_s)}$$\n\n现在，我们进行数值计算。\n已知数据：$\\dot{Q}=2.00\\times 10^6\\,\\mathrm{W}$，$U=1.00\\times 10^3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n情况 1：$\\Delta T_1=20.0\\,\\mathrm{K}$ 且 $\\Delta T_2=0.50\\,\\mathrm{K}$。\nLMTD 为：\n$$\\Delta T_{LMTD,1} = \\frac{20.0 - 0.50}{\\ln(20.0 / 0.50)} = \\frac{19.5}{\\ln(40)} \\approx \\frac{19.5}{3.688879} \\approx 5.2863\\,\\mathrm{K}$$\n所需面积 $A_1$ 为：\n$$A_1 = \\frac{\\dot{Q}}{U \\Delta T_{LMTD,1}} = \\frac{2.00 \\times 10^6\\,\\mathrm{W}}{(1.00 \\times 10^3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}) (5.2863\\,\\mathrm{K})} \\approx 378.33\\,\\mathrm{m^2}$$\n\n情况 2（修约后）：$\\Delta T_1=20.0\\,\\mathrm{K}$ 且 $\\Delta T_2=1.0\\,\\mathrm{K}$。\nLMTD 为：\n$$\\Delta T_{LMTD,2} = \\frac{20.0 - 1.0}{\\ln(20.0 / 1.0)} = \\frac{19.0}{\\ln(20)} \\approx \\frac{19.0}{2.995732} \\approx 6.3423\\,\\mathrm{K}$$\n所需面积 $A_2$ 为：\n$$A_2 = \\frac{\\dot{Q}}{U \\Delta T_{LMTD,2}} = \\frac{2.00 \\times 10^6\\,\\mathrm{W}}{(1.00 \\times 10^3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}) (6.3423\\,\\mathrm{K})} \\approx 315.35\\,\\mathrm{m^2}$$\n计算出的面积的百分比变化为：\n$$\\%\\,\\text{change} = \\frac{A_2 - A_1}{A_1} \\times 100\\% = \\frac{315.35 - 378.33}{378.33} \\times 100\\% \\approx -16.65\\%$$\n\n根据这些推导和计算，我们现在来评估每个陈述。\n\nA. 在并流或逆流的 $\\Delta T_s \\ll \\Delta T_\\ell$ 情况下，平均温差渐近于 $\\Delta T_\\mathrm{mean}\\sim \\dfrac{\\Delta T_\\ell}{\\ln\\!\\left(\\dfrac{\\Delta T_\\ell}{\\Delta T_s}\\right)}$，因此对于固定的 $\\dot{Q}$ 和 $U$，当 $\\Delta T_s\\to 0^+$ 时，所需面积像 $\\ln\\!\\left(\\dfrac{\\Delta T_\\ell}{\\Delta T_s}\\right)$ 一样发散。\n该陈述完全由我们的渐近分析所支持。推导出的 $\\Delta T_{mean}$ 的渐近形式是精确的。所需面积为 $A = \\dot{Q} / (U \\Delta T_{mean})$。代入渐近形式：\n$$A \\sim \\frac{\\dot{Q}}{U} \\frac{\\ln(\\Delta T_\\ell / \\Delta T_s)}{\\Delta T_\\ell}$$\n当 $\\Delta T_s \\to 0^+$ 时，项 $\\ln(\\Delta T_\\ell / \\Delta T_s)$ 无界增长，导致面积 $A$ 发散。发散与 $\\ln(\\Delta T_\\ell / \\Delta T_s)$ 成正比。该陈述是**正确的**。\n\nB. 在逆流情况下，当一个端点温差远小于另一个时，平均温差可取为算术平均值 $\\dfrac{\\Delta T_1+\\Delta T_2}{2}$，这可以防止所需面积在 $\\Delta T_s\\to 0^+$ 时发散。\n算术平均值 $\\Delta T_{AM} = (\\Delta T_1 + \\Delta T_2)/2$ 仅在 $\\Delta T_1 \\approx \\Delta T_2$ 时才是 LMTD 的良好近似。在指定的 $\\Delta T_s \\ll \\Delta T_\\ell$ 情况下，两者显著不同。对于我们的数值案例，$\\Delta T_{LMTD,1} \\approx 5.29\\,\\mathrm{K}$ 而 $\\Delta T_{AM} = (20.0+0.50)/2 = 10.25\\,\\mathrm{K}$。它们相差近2倍。在此极限下使用算术平均值在物理上是不正确的。如果使用算术平均值，面积确实会保持有限，但这是基于一个错误的前提。真实的平均温差会导致发散。该陈述是**不正确的**。\n\nC. 将较小的端点温差从 $0.50\\,\\mathrm{K}$ 修约到 $1.0\\,\\mathrm{K}$，平均温差的变化小于 $1\\,\\%$，因此这种修约对近夹点设计的面积确定影响可以忽略不计。\n我们的计算表明，将 $\\Delta T_2$ 从 $0.50\\,\\mathrm{K}$ 修约到 $1.0\\,\\mathrm{K}$ 会使 LMTD 从 $5.2863\\,\\mathrm{K}$ 变为 $6.3423\\,\\mathrm{K}$，变化幅度为 $\\frac{6.3423 - 5.2863}{5.2863} \\times 100\\% \\approx 19.98\\%$。这远非小于 $1\\,\\%$。因此，所需面积变化了 $-16.65\\%$，这是一个非常显著的影响。近夹点设计对小温差的值极其敏感。该陈述明显是错误的。该陈述是**不正确的**。\n\nD. 如果由于 $\\Delta T_1$ 和 $\\Delta T_2$ 的符号约定，平均温差的数值计算得出负值，应通过取绝对值来强制其为正；这对可行性或面积设计没有影响，因为只有大小才重要。\nLMTD 公式 $\\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1/\\Delta T_2)}$ 只有在 $\\Delta T_1$ 和 $\\Delta T_2$ 符号相反时才会为负（假设两者都非零），因为两个正数之比的对数总是正的。一个负的端点温差，例如 $\\Delta T_2  0$，意味着在该端 $T_c > T_h$，这种情况被称为“温度交叉”。这违反了 LMTD 推导所基于的整个换热器中 $T_h > T_c$ 的基本假设。这种情况表明设计在物理上是不可行的，或者是对模型的误用。简单地取绝对值会掩盖工艺设计中的一个关键缺陷，这对可行性有深远的影响。该陈述在物理上和逻辑上都是不成立的。该陈述是**不正确的**。\n\nE. 对于固定的入口温度和热容率，逆流比并流产生更大的平均温差；然而，当一个端点温差被驱使到远小于另一个时，两种排列方式都表现出选项A中所体现的相同的对数惩罚，所需面积以相同的渐近方式无界增长。\n该陈述的第一部分是换热器分析中一个公认的原则：对于相同的入口条件，$(\\Delta T_{LMTD})_{\\text{逆流}} \\ge (\\Delta T_{LMTD})_{\\text{并流}}$。这使得逆流在热力学上更有效，通常在给定热负荷下需要更少的面积。第二部分讨论了接近夹点（$\\Delta T_s \\to 0$）时的渐近行为。我们对LMTD及其渐近极限的推导在数学上是通用的，适用于两种流动配置。这种惩罚表现为所需面积呈对数增长 $A \\propto \\ln(1/\\Delta T_s)$，是在接近零温差条件下操作的一个基本后果，与流动排列方式无关。该陈述正确地指出了逆流的普遍优势，同时也正确地指出，在接近夹点时，两种排列方式都遭受相同类型的面积需求数学发散。该陈述是**正确的**。\n\n基于分析，陈述A和E是正确的。", "answer": "$$\\boxed{AE}$$", "id": "2501386"}, {"introduction": "前面的练习侧重于“设计”问题（为给定热负荷计算面积），而工程中同样常见的任务是“校核”问题（为给定换热器计算性能）。这项最终的综合实践将指导你开发一个数值求解器，以确定换热器的出口温度。你需要将能量平衡方程与非线性的LMTD关系结合起来，构建一个方程组并使用牛顿法等数值方法求解，从而模拟真实工程分析工具的开发过程。[@problem_id:2501348]", "problem": "您将开发一个程序，用于计算双流体换热器中的两个未知出口温度——热流体出口温度和冷流体出口温度，并涵盖并流和逆流两种布置方式。该计算必须通过使用牛顿法求解一个耦合非线性方程组来执行。非线性耦合的产生，是由于需要同时对每股流体强制施加能量守恒，并使用基于对数平均温差的传热速率定义。您的程序必须使用以下基于物理的模型，该模型源自基本的能量平衡和对数平均温差的定义，不得使用简化的关联式或预先制表的效能公式。\n\n未知数为热流体出口温度 $T_{h,o}$ 和冷流体出口温度 $T_{c,o}$。已知条件为热流体入口温度 $T_{h,i}$、冷流体入口温度 $T_{c,i}$、总传热系数 $U$、传热面积 $A$ 以及热、冷流体的热容率 $C_{h}$ 和 $C_{c}$。使用基本的能量平衡和对数平均温差的定义，其中传热速率由 $Q = U A \\Delta T_{lm}$ 定义，且 $Q = C_{h} (T_{h,i} - T_{h,o}) = C_{c} (T_{c,o} - T_{c,i})$。对于具有恒定 $U$ 和 $A$ 的单程换热器，对数平均温差使用两端的温差。对于并流布置：\n- $\\Delta T_{1} = T_{h,i} - T_{c,i}$，\n- $\\Delta T_{2} = T_{h,o} - T_{c,o}$。\n对于逆流布置：\n- $\\Delta T_{1} = T_{h,i} - T_{c,o}$，\n- $\\Delta T_{2} = T_{h,o} - T_{c,i}$。\n当两端温差严格为正（$\\Delta T_{1} > 0$ 和 $\\Delta T_{2} > 0$）时，对数平均温差定义为\n$$\n\\Delta T_{lm} = \\frac{\\Delta T_{1} - \\Delta T_{2}}{\\ln\\left(\\frac{\\Delta T_{1}}{\\Delta T_{2}}\\right)}.\n$$\n当两端温差近似相等时，您的实现必须使用由连续性良好定义的极限值，即当 $\\Delta T_{2} \\to \\Delta T_{1}$ 时，$\\Delta T_{lm} \\to \\Delta T_{1}$，并且必须使用一致的极限导数，以保持数值稳定性。\n\n您的牛顿迭代必须通过施加两个沿流向的能量平衡来求解未知数 $T_{h,o}$ 和 $T_{c,o}$，其中使用一个由 $U A \\Delta T_{lm}$ 计算出的单一、一致的传热速率 $Q$。您必须解析地计算雅可比矩阵，包括 $\\Delta T_{lm}$ 相对于未知出口温度的偏导数，并使用全局化策略（例如，回溯线搜索）来强制施加物理约束，以确保两端温差保持严格为正。当残差向量的范数和牛顿步长足够小时，迭代应终止；请明确说明并实现您的收敛容差。\n\n所有计算必须使用以下单位：\n- $U$ 的单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，\n- $A$ 的单位为 $\\mathrm{m^{2}}$，\n- $C_h$ 和 $C_c$ 的单位为 $\\mathrm{W\\,K^{-1}}$，\n- 温度单位为 $\\mathrm{^{\\circ}C}$，\n- 传热速率 $Q$ 的单位为 $\\mathrm{W}$。\n报告 $T_{h,o}$ 和 $T_{c,o}$，单位为 $\\mathrm{^{\\circ}C}$，四舍五入到小数点后六位。\n\n测试套件和要求的输出：\n- 实现您的求解器，并在以下五个案例上进行评估。每个案例以元组 $(\\text{arrangement}, U, A, C_h, C_c, T_{h,i}, T_{c,i})$ 的形式给出，其中 $\\text{arrangement}$ 是字符串 \"parallel\" 或 \"counter\"。\n    1. $(\\text{\"parallel\"},\\, 400.0,\\, 20.0,\\, 5000.0,\\, 8000.0,\\, 120.0,\\, 20.0)$\n    2. $(\\text{\"counter\"},\\, 300.0,\\, 30.0,\\, 6000.0,\\, 6000.0,\\, 150.0,\\, 50.0)$\n    3. $(\\text{\"parallel\"},\\, 50.0,\\, 0.5,\\, 4000.0,\\, 6000.0,\\, 90.0,\\, 30.0)$\n    4. $(\\text{\"counter\"},\\, 1000.0,\\, 100.0,\\, 2000.0,\\, 6000.0,\\, 200.0,\\, 40.0)$\n    5. $(\\text{\"parallel\"},\\, 150.0,\\, 10.0,\\, 5000.0,\\, 5000.0,\\, 170.0,\\, 70.0)$\n- 您的程序必须生成单行输出，其中包含每个案例的出口温度列表，格式为一个逗号分隔的配对列表，每个配对是两个温度 $[T_{h,o}, T_{c,o}]$，四舍五入到六位小数。确切要求的格式是：\n\"[ [Th1,Tc1],[Th2,Tc2],[Th3,Tc3],[Th4,Tc4],[Th5,Tc5] ]\"\n其中每个 $T$ 是一个小数点后有六位数字的十进制数（无单位且无多余空格）。", "solution": "我们从第一性原理出发，推导并实现一个鲁棒的牛顿法，用于计算 $T_{h,o}$ 和 $T_{c,o}$。其基本依据包括沿流向的能量平衡和对数平均温差的定义。\n\n1. 基本控制关系。对于总传热系数 $U$ 和面积 $A$ 恒定的单程换热器，假设轴向热传导可忽略不计且无相变，传热速率 $Q$ 满足每股流体的能量守恒：\n$$\nQ = C_h \\left(T_{h,i} - T_{h,o}\\right) = C_c \\left(T_{c,o} - T_{c,i}\\right).\n$$\n根据在终端点两端温差严格为正的情况下的对数平均温差定义，\n$$\nQ = U A \\Delta T_{lm}, \\quad \\Delta T_{lm} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln\\left(\\frac{\\Delta T_1}{\\Delta T_2}\\right)}.\n$$\n对于并流，\n$$\n\\Delta T_1 = T_{h,i} - T_{c,i}, \\quad \\Delta T_2 = T_{h,o} - T_{c,o},\n$$\n对于逆流，\n$$\n\\Delta T_1 = T_{h,i} - T_{c,o}, \\quad \\Delta T_2 = T_{h,o} - T_{c,i}.\n$$\n这些关系将两个未知的出口温度与定义对数平均温差的两端温差耦合起来。\n\n2. 非线性系统构建。未知向量为\n$$\n\\mathbf{x} =\n\\begin{bmatrix}\nT_{h,o} \\\\ T_{c,o}\n\\end{bmatrix}.\n$$\n将对数平均温差定义为函数 $L(\\Delta T_1, \\Delta T_2)$，并定义 $Q(\\mathbf{x}) = U A \\, L(\\Delta T_1(\\mathbf{x}), \\Delta T_2(\\mathbf{x}))$。两个残差方程通过使用相同的 $Q$ 来对每股流体强制施加能量守恒：\n$$\nF_1(\\mathbf{x}) = C_h \\left(T_{h,i} - T_{h,o}\\right) - Q(\\mathbf{x}) = 0,\n$$\n$$\nF_2(\\mathbf{x}) = C_c \\left(T_{c,o} - T_{c,i}\\right) - Q(\\mathbf{x}) = 0.\n$$\n如果我们强制要求两端温差为正，求解 $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$ 将得到物理上允许的出口温度：对于并流，除了 $\\Delta T_1>0$ 外，还需 $\\Delta T_2 = T_{h,o} - T_{c,o} > 0$；对于逆流，我们要求 $\\Delta T_1 = T_{h,i} - T_{c,o} > 0$ 和 $\\Delta T_2 = T_{h,o} - T_{c,i} > 0$。此外，对于没有内部热源的显热交换，物理边界要求 $T_{h,i} \\ge T_{h,o} \\ge T_{c,i}$ 和 $T_{h,i} \\ge T_{c,o} \\ge T_{c,i}$。\n\n3. 对数平均温差及其导数。设 $f(a,b) = \\dfrac{a-b}{\\ln\\left(a/b\\right)}$，其中 $a>0$, $b>0$, $a\\neq b$。其偏导数可通过商法则，利用 $\\partial \\ln(a/b)/\\partial a = 1/a$ 和 $\\partial \\ln(a/b)/\\partial b = -1/b$ 求得：\n$$\n\\frac{\\partial f}{\\partial a} = \\frac{\\ln\\left(\\frac{a}{b}\\right) - \\frac{a-b}{a}}{\\left[\\ln\\left(\\frac{a}{b}\\right)\\right]^2}, \\qquad\n\\frac{\\partial f}{\\partial b} = \\frac{-\\ln\\left(\\frac{a}{b}\\right) + \\frac{a-b}{b}}{\\left[\\ln\\left(\\frac{a}{b}\\right)\\right]^2}.\n$$\n当 $a \\to b$ 时，我们使用极限值。二阶展开显示\n$$\n\\lim_{a\\to b} f(a,b) = a, \\qquad \\lim_{a\\to b} \\frac{\\partial f}{\\partial a} = \\frac{1}{2}, \\qquad \\lim_{a\\to b} \\frac{\\partial f}{\\partial b} = \\frac{1}{2}.\n$$\n在实现中必须使用这些极限，以避免当 $|a-b|$ 相对于 $\\max(a,b)$ 很小时出现数值精度损失。\n\n对于并流，\n$$\na = \\Delta T_1 = T_{h,i} - T_{c,i}, \\quad b = \\Delta T_2 = T_{h,o} - T_{c,o},\n$$\n因此\n$$\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}} = \\frac{\\partial f}{\\partial b}\\cdot \\frac{\\partial b}{\\partial T_{h,o}} = \\frac{\\partial f}{\\partial b} \\cdot 1, \\qquad\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial b}\\cdot \\frac{\\partial b}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial b} \\cdot (-1).\n$$\n对于逆流，\n$$\na = \\Delta T_1 = T_{h,i} - T_{c,o}, \\quad b = \\Delta T_2 = T_{h,o} - T_{c,i},\n$$\n因此\n$$\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}} = \\frac{\\partial f}{\\partial b}\\cdot 1, \\qquad\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial a}\\cdot \\frac{\\partial a}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial a} \\cdot (-1).\n$$\n\n4. 牛顿迭代。设 $\\mathbf{F}(\\mathbf{x})$ 如上。雅可比矩阵为\n$$\nJ(\\mathbf{x}) =\n\\begin{bmatrix}\n\\frac{\\partial F_1}{\\partial T_{h,o}}  \\frac{\\partial F_1}{\\partial T_{c,o}}\\\\\n\\frac{\\partial F_2}{\\partial T_{h,o}}  \\frac{\\partial F_2}{\\partial T_{c,o}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n- C_h - U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}}  - U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}}\\\\\n- U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}}  \\phantom{-} C_c - U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}}\n\\end{bmatrix}.\n$$\n牛顿法更新步骤为\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\alpha_k \\Delta \\mathbf{x}_k, \\quad \\text{其中} \\quad J(\\mathbf{x}_k)\\,\\Delta \\mathbf{x}_k = -\\mathbf{F}(\\mathbf{x}_k),\n$$\n其中全局化因子 $0  \\alpha_k \\le 1$ 通过回溯线搜索选取，以确保新的迭代点满足物理可行性（两端温差严格为正）并减小残差范数，例如欧几里得范数 $\\|\\mathbf{F}\\|_2$。\n\n5. 收敛准则。当以下两个条件均满足时终止迭代：\n- $\\|\\mathbf{F}(\\mathbf{x}_k)\\|_2 \\le \\varepsilon_{res}$，\n- $\\|\\Delta \\mathbf{x}_k\\|_2 \\le \\varepsilon_{step}$。\n一个鲁棒的选择是 $\\varepsilon_{res} = 10^{-9}$ (单位 $\\mathrm{W}$) 和 $\\varepsilon_{step} = 10^{-10}$ (单位 $\\mathrm{K}$)。设置最大迭代次数（例如 50 次），如果在此限制内未收敛，则声明失败。回溯法以几何级数方式减小 $\\alpha_k$（例如，重复乘以 1/2），直到满足可行性和充分下降条件。如果回溯法将 $\\alpha_k$ 减小到某个最小阈值以下（例如 $10^{-10}$），则以失败告终；然而，所提供的测试套件经过选择以避免此类失败。\n\n6. 初始化。一个物理上允许的初始猜测能确保可行性：选择一个保守的初始传热速率\n$$\nQ_0 = \\frac{1}{2}\\,\\min\\left( U A \\, (T_{h,i} - T_{c,i}),\\, \\min(C_h,C_c)\\,(T_{h,i} - T_{c,i}) \\right),\n$$\n并设置\n$$\nT_{h,o}^{(0)} = T_{h,i} - \\frac{Q_0}{C_h}, \\quad T_{c,o}^{(0)} = T_{c,i} + \\frac{Q_0}{C_c}.\n$$\n根据构造，这保证了 $T_{h,i} \\ge T_{h,o}^{(0)} > T_{c,i}$ 和 $T_{c,o}^{(0)} > T_{c,i}$，并且通常是两种布置方式的一个良好起点。\n\n7. 输出规范。对于每个测试案例，计算收敛的 $(T_{h,o}, T_{c,o})$，并以单行的精确格式输出五个出口温度对的列表：\n\"[ [Th1,Tc1],[Th2,Tc2],[Th3,Tc3],[Th4,Tc4],[Th5,Tc5] ]\"\n所有温度必须四舍五入到小数点后六位，并且打印时不带单位，也不带任何多余的空格。\n\n所述算法通过推导和使用解析雅可比矩阵，通过线搜索强制施加可行性，并应用严格的收敛准则，将基本原理（能量守恒和对数平均温差定义）集成到一个稳定的牛顿迭代中。", "answer": "```python\nimport numpy as np\n\ndef log_mean_and_partials(a: float, b: float):\n    if a = 0.0 or b = 0.0:\n        raise ValueError(\"End temperature differences must be positive.\")\n    rel_diff = abs(a - b) / max(a, b, 1e-9)\n    if rel_diff  1e-8:\n        val = (a + b) / 2.0\n        d_val_da = 0.5\n        d_val_db = 0.5\n        return val, d_val_da, d_val_db\n    log_ratio = np.log(a / b)\n    val = (a - b) / log_ratio\n    d_val_da = (log_ratio - (a - b) / a) / (log_ratio**2)\n    d_val_db = (-log_ratio + (a - b) / b) / (log_ratio**2)\n    return val, d_val_da, d_val_db\n\ndef residual_and_jacobian(x, arrangement, U, A, Ch, Cc, Thi, Tci):\n    Tho, Tco = x[0], x[1]\n    \n    if arrangement == \"parallel\":\n        a, b = Thi - Tci, Tho - Tco\n        if a = 1e-9 or b = 1e-9: raise ValueError(\"Infeasible temperatures\")\n        LMTD, dL_da, dL_db = log_mean_and_partials(a, b)\n        dL_dTho = dL_db\n        dL_dTco = -dL_db\n    elif arrangement == \"counter\":\n        a, b = Thi - Tco, Tho - Tci\n        if a = 1e-9 or b = 1e-9: raise ValueError(\"Infeasible temperatures\")\n        LMTD, dL_da, dL_db = log_mean_and_partials(a, b)\n        dL_dTho = dL_db\n        dL_dTco = -dL_da\n    else:\n        raise ValueError(\"Invalid arrangement\")\n\n    Q = U * A * LMTD\n    F = np.array([\n        Ch * (Thi - Tho) - Q,\n        Cc * (Tco - Tci) - Q\n    ])\n    \n    J = np.array([\n        [-Ch - U * A * dL_dTho, -U * A * dL_dTco],\n        [-U * A * dL_dTho, Cc - U * A * dL_dTco]\n    ])\n    \n    return F, J\n\ndef newton_solve(arrangement, U, A, Ch, Cc, Thi, Tci):\n    Q_max_possible = min(Ch, Cc) * (Thi - Tci)\n    Q_guess = 0.5 * min(Q_max_possible, U * A * (Thi - Tci))\n    Tho_guess = Thi - Q_guess / Ch\n    Tco_guess = Tci + Q_guess / Cc\n    x = np.array([Tho_guess, Tco_guess])\n    \n    for i in range(50):\n        try:\n            F, J = residual_and_jacobian(x, arrangement, U, A, Ch, Cc, Thi, Tci)\n        except (ValueError, ZeroDivisionError):\n            break\n\n        if np.linalg.norm(F)  1e-9:\n            break\n            \n        try:\n            step = np.linalg.solve(J, -F)\n        except np.linalg.LinAlgError:\n            break\n\n        if np.linalg.norm(step)  1e-10:\n            break\n        \n        alpha = 1.0\n        norm_F = np.linalg.norm(F)\n        for _ in range(10):\n            x_new = x + alpha * step\n            try:\n                F_new, _ = residual_and_jacobian(x_new, arrangement, U, A, Ch, Cc, Thi, Tci)\n                if np.linalg.norm(F_new)  (1 - 1e-4 * alpha) * norm_F:\n                    x = x_new\n                    break\n            except (ValueError, ZeroDivisionError):\n                pass\n            alpha /= 2.0\n        else:\n            break\n    \n    return x[0], x[1]\n\ndef solve():\n    test_cases = [\n        (\"parallel\", 400.0, 20.0, 5000.0, 8000.0, 120.0, 20.0),\n        (\"counter\", 300.0, 30.0, 6000.0, 6000.0, 150.0, 50.0),\n        (\"parallel\", 50.0, 0.5, 4000.0, 6000.0, 90.0, 30.0),\n        (\"counter\", 1000.0, 100.0, 2000.0, 6000.0, 200.0, 40.0),\n        (\"parallel\", 150.0, 10.0, 5000.0, 5000.0, 170.0, 70.0),\n    ]\n    results = []\n    for case in test_cases:\n        Tho, Tco = newton_solve(*case)\n        results.append(f\"[{Tho:.6f},{Tco:.6f}]\")\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2501348"}]}