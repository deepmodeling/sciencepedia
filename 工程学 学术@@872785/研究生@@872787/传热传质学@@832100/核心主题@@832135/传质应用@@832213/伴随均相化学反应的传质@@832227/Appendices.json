{"hands_on_practices": [{"introduction": "本练习旨在解决反应-扩散系统中的一个基本问题。通过求解简单平面几何中的稳态浓度分布，我们可以掌握物种通过扩散进行的传输与其在一级反应中的消耗之间根本性的相互作用。该分析将引导我们推导并解释一个关键概念：特征穿透深度，它量化了反应物在被显著消耗之前可以行进的距离 [@problem_id:2503815]。", "problem": "反应溶质组分 $A$ 在一个占据 $0 \\le y \\le L$ 的平板内进行稳态扩散和一级均相反应 $A \\to P$。该系统是等温的，物性恒定，无宏观流动，且输运是沿 $y$ 方向的一维过程。有效扩散系数为 $D$，均相反应速率为 $r_A = -k\\,c_A$，其中 $k0$。在 $y=0$ 处的界面维持浓度为 $c_A(0)=c_{A0}$，而在另一侧 $y=L$ 处的界面则为完全消耗，因此 $c_A(L)=0$。从包含菲克定律的稳态组分守恒方程出发，推导控制常微分方程，并求解满足边界条件的浓度分布 $c_A(y)$ 的闭合形式解。使用主导平衡法，定义并解释以 $D$ 和 $k$ 表示的特征穿透深度，并结合您得到的浓度分布解释其物理意义。请将最终的浓度分布 $c_A(y)$ 表示为包含 $y$、$L$、$D$、$k$ 和 $c_{A0}$ 的单个闭合形式解析表达式。不需要进行数值取整。", "solution": "所述问题具有科学依据，提法恰当且客观。这是反应-扩散理论中的一个标准问题，并且具有完整的数据和一致的边界条件。因此，我们可以进行推导和求解。\n\n起点是组分守恒的通用微分方程。对于组分 $A$，该方程表示为：\n$$\n\\frac{\\partial c_A}{\\partial t} + \\nabla \\cdot \\mathbf{N}_A = R_A\n$$\n其中 $c_A$ 是组分 $A$ 的摩尔浓度，$t$ 是时间，$\\mathbf{N}_A$ 是 $A$ 的摩尔通量，$R_A$ 是 $A$ 的体积生产速率。\n\n我们应用问题陈述中给出的条件：\n1.  系统处于稳态，因此所有时间导数均为零：$\\frac{\\partial c_A}{\\partial t} = 0$。\n2.  输运是沿 $y$ 方向的一维过程，因此散度算子简化为 $\\nabla \\cdot \\mathbf{N}_A = \\frac{dN_{A,y}}{dy}$。\n3.  无宏观流动，因此摩尔通量 $\\mathbf{N}_A$ 完全由菲克扩散定律描述：$\\mathbf{N}_A = -D \\nabla c_A$。在一维情况下，这变为 $N_{A,y} = -D \\frac{dc_A}{dy}$。扩散系数 $D$ 是常数。\n4.  均相反应为 $A \\to P$，速率为 $r_A = -k c_A$。这是消耗速率。因此，生产速率 $R_A$ 必须为负。在化学工程中，标准惯例是反应速率 $r_A$ 指的是组分 $A$ 的生成速率。因此，$R_A = r_A = -k c_A$。\n\n将这些条件代入通用守恒方程，得到：\n$$\n\\frac{d}{dy}\\left(-D \\frac{dc_A}{dy}\\right) = -k c_A\n$$\n由于扩散系数 $D$ 是常数，我们可以将方程写为：\n$$\n-D \\frac{d^2c_A}{dy^2} = -k c_A\n$$\n重新整理后，得到浓度分布 $c_A(y)$ 的控制常微分方程（ODE）：\n$$\n\\frac{d^2c_A}{dy^2} - \\frac{k}{D} c_A = 0\n$$\n这是一个二阶线性齐次常系数常微分方程。其特征方程为 $m^2 - \\frac{k}{D} = 0$，根为 $m_{1,2} = \\pm\\sqrt{\\frac{k}{D}}$。通解可以用指数函数表示，或者对此问题更方便地用双曲函数表示：\n$$\nc_A(y) = C_1 \\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) + C_2 \\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right)\n$$\n积分常数 $C_1$ 和 $C_2$ 由边界条件确定：\n1.  在 $y=0$ 处，浓度为 $c_A(0) = c_{A0}$。\n2.  在 $y=L$ 处，浓度为 $c_A(L) = 0$。\n\n应用第一个边界条件，在 $y=0$ 处：\n$$\nc_{A0} = C_1 \\cosh(0) + C_2 \\sinh(0) = C_1 \\cdot 1 + C_2 \\cdot 0 \\implies C_1 = c_{A0}\n$$\n因此解变为：\n$$\nc_A(y) = c_{A0} \\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) + C_2 \\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right)\n$$\n应用第二个边界条件，在 $y=L$ 处：\n$$\n0 = c_{A0} \\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right) + C_2 \\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)\n$$\n求解 $C_2$：\n$$\nC_2 = -c_{A0} \\frac{\\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)}\n$$\n将 $C_1$ 和 $C_2$ 代回解中，得到：\n$$\nc_A(y) = c_{A0} \\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) - c_{A0} \\frac{\\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)} \\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right)\n$$\n此表达式可通过通分合并各项来简化：\n$$\nc_A(y) = \\frac{c_{A0}}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)} \\left[ \\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)\\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) - \\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right)\\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right) \\right]\n$$\n使用双曲恒等式 $\\sinh(a-b) = \\sinh(a)\\cosh(b) - \\cosh(a)\\sinh(b)$，其中 $a = \\sqrt{\\frac{k}{D}}L$ 且 $b = \\sqrt{\\frac{k}{D}}y$，我们得到浓度分布的最终闭合形式解：\n$$\nc_A(y) = c_{A0} \\frac{\\sinh\\left(\\sqrt{\\frac{k}{D}}(L-y)\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}}L\\right)}\n$$\n接下来，我们使用主导平衡法来定义和解释特征穿透深度。控制常微分方程为 $D \\frac{d^2c_A}{dy^2} - k c_A = 0$。这两项分别代表扩散（$D \\frac{d^2c_A}{dy^2}$）和反应（$-k c_A$）。当这两个过程的量级相当时，会出现一个特征长度尺度。令 $\\delta$ 为此特征长度尺度。我们可以将二阶导数近似为 $\\frac{d^2c_A}{dy^2} \\sim \\frac{c_{A0}}{\\delta^2}$，将浓度近似为 $c_A \\sim c_{A0}$。那么这两项的平衡关系为：\n$$\nD \\frac{c_{A0}}{\\delta^2} \\sim k c_{A0}\n$$\n求解 $\\delta$ 得到特征穿透深度：\n$$\n\\delta = \\sqrt{\\frac{D}{k}}\n$$\n该穿透深度的物理意义是，扩散组分 $A$ 在被化学反应显著消耗之前，能够穿透进入平板的特征距离。它是扩散（输运组分）与反应（消耗组分）之间竞争的量度。\n\n从得到的解析解中可以清楚地看到这种解释。双曲正弦函数的自变量形式为 $\\frac{y}{\\delta}$ 和 $\\frac{L}{\\delta}$。无量纲数组 $\\frac{L}{\\delta} = L\\sqrt{\\frac{k}{D}}$ 被称为希勒模数（Thiele modulus），它比较了反应速率与扩散速率。\n如果 $L \\ll \\delta$（反应慢或扩散快），那么当 $x$ 很小时，$\\sinh(x) \\approx x$。浓度分布近似为：\n$$\nc_A(y) \\approx c_{A0} \\frac{\\sqrt{k/D}(L-y)}{\\sqrt{k/D}L} = c_{A0}\\left(1 - \\frac{y}{L}\\right)\n$$\n这是一个线性分布，即无反应的纯扩散问题的解。\n如果 $L \\gg \\delta$（反应快或扩散慢），那么反应物在到达平板末端 $y=L$ 之前早已被消耗殆尽。当 $x$ 很大时，$\\sinh(x) \\approx \\frac{1}{2}\\exp(x)$。浓度分布变为：\n$$\nc_A(y) \\approx c_{A0} \\frac{\\frac{1}{2}\\exp\\left(\\frac{L-y}{\\delta}\\right)}{\\frac{1}{2}\\exp\\left(\\frac{L}{\\delta}\\right)} = c_{A0} \\exp\\left(-\\frac{y}{\\delta}\\right) = c_{A0} \\exp\\left(-y\\sqrt{\\frac{k}{D}}\\right)\n$$\n在此区域内，浓度从表面 $y=0$ 开始以特征长度 $\\delta$ 指数衰减。在 $y=L$ 处的边界条件对 $y=0$ 附近的浓度没有影响。因此，$\\delta = \\sqrt{D/k}$ 正是决定因反应而导致浓度分布衰减的长度尺度。", "answer": "$$\n\\boxed{c_{A0} \\frac{\\sinh\\left(\\sqrt{\\frac{k}{D}} (L-y)\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)}}\n$$", "id": "2503815"}, {"introduction": "本实践练习在抽象理论与实际工程应用（特别是在气-液反应器的背景下）之间架起了一座桥梁。当气体被吸收到液体中并发生反应时，传质速率会显著提高——这种效应可以通过增强因子 $E$ 来量化。这个问题挑战您从一个测得的增强因子出发，反向计算出内在反应速率常数，这是化学过程开发中的一项常见任务，并引入了控制此过程的关键无量纲数——哈塔数（$Ha$）[@problem_id:2503840]。", "problem": "一种微溶气体物质$A$从稀薄气体中被吸收到液体中，并在液体中发生均相、不可逆的一级反应 $A \\rightarrow \\text{产物}$，其本征速率为 $r_A = k\\,C_A$。考虑在稳态和等温条件下的液侧双膜理论描述。假设液膜性质恒定，且溶液足够稀，以至于膜边缘的主体液体浓度可视为 $C_{A,b} \\approx 0$。一项实验测量了相对于纯物理吸收（在其他流体动力学条件相同的情况下，通过抑制剂抑制反应），反应对吸收通量的增强效果。测得的增强因子为 $E = 7.50$。独立测得的物理液侧传质系数为 $k_L = 2.00 \\times 10^{-5}$ m s$^{-1}$，$A$在液体中的分子扩散系数为 $D = 1.50 \\times 10^{-9}$ m$^{2}$ s$^{-1}$。在反算本征速率常数时，可以忽略气侧阻力。\n\n仅使用液膜中包含一级反应和菲克扩散的基本质量守恒，推导连接增强因子$E$与本征速率常数$k$及测得的输运性质之间的关系式，然后对其进行反演以计算本征速率常数$k$。最终的本征速率常数以s$^{-1}$为单位表示，并将答案四舍五入至三位有效数字。\n\n最后，基于双膜理论框架，讨论如果气侧阻力不可忽略，从测量的$E$中是否仍能唯一确定$k$（定性推理即可，但所使用的任何符号都必须定义）。", "solution": "首先必须严格验证问题陈述。\n\n步骤1：提取已知条件。\n- 一种微溶气体物质$A$被吸收到液体中。\n- 在液体中发生均相、不可逆的一级反应 $A \\rightarrow \\text{产物}$。\n- 本征反应速率为 $r_A = k\\,C_A$。\n- 分析基于稳态和等温条件下的液侧双膜理论描述。\n- 液膜性质恒定。\n- 溶液足够稀，膜边缘的主体液体浓度为 $C_{A,b} \\approx 0$。\n- 测得的增强因子为 $E = 7.50$。\n- 物理液侧传质系数为 $k_L = 2.00 \\times 10^{-5}$ m s$^{-1}$。\n- $A$在液体中的分子扩散系数为 $D = 1.50 \\times 10^{-9}$ m$^{2}$ s$^{-1}$。\n- 计算中，忽略气侧阻力。\n- 本征速率常数$k$的最终答案必须以s$^{-1}$为单位，并四舍五入至三位有效数字。\n- 需要对气侧阻力不可忽略时$k$的可确定性进行定性讨论。\n\n步骤2：问题陈述的验证。\n该问题具有科学依据，植根于化学反应工程和传质的基本原理。双膜理论是分析跨相界传质的标准、成熟的模型。控制方程是一个表示带反应的扩散的二阶常微分方程，是质量守恒的直接结果。该问题是适定的：它提供了足够的数据集（$E$、$k_L$、$D$）和边界条件（$C_A(\\delta) = 0$），允许计算出速率常数$k$的唯一值。该问题是客观的，并使用了精确的术语。不存在科学或事实上的不健全之处，没有矛盾，也不依赖于主观论断。给定的数值在物理上是合理的。该问题是应用基本理论的标准、非平凡的练习。\n\n步骤3：结论与行动。\n该问题被认为是有效的。现在将展开一个完整的、有理有据的解答。\n\n出发点是物质$A$穿过液膜的微分质量平衡。在稳态条件下，一维膜内菲克扩散和一级化学反应之间的平衡关系为：\n$$ D \\frac{d^2 C_A}{dz^2} - k C_A = 0 $$\n其中，$z$是垂直于界面的空间坐标（界面处$z=0$，膜边缘处$z=\\delta$），$C_A$是$A$的浓度，$D$是其扩散系数，$k$是一级速率常数。边界条件为：\n1. 在界面处，$z=0$：$C_A(0) = C_{A,i}$。\n2. 在膜边缘处，$z=\\delta$：$C_A(\\delta) = C_{A,b} \\approx 0$。\n\n此微分方程的通解可以用双曲函数写出：\n$$ C_A(z) = C_1 \\sinh\\left(z\\sqrt{\\frac{k}{D}}\\right) + C_2 \\cosh\\left(z\\sqrt{\\frac{k}{D}}\\right) $$\n应用边界条件确定常数$C_1$和$C_2$，得到浓度分布：\n$$ C_A(z) = C_{A,i} \\frac{\\sinh\\left((\\delta - z) \\sqrt{k/D}\\right)}{\\sinh\\left(\\delta \\sqrt{k/D}\\right)} $$\n根据菲克第一定律，物质$A$进入液体的界面通量为：\n$$ N_A = -D \\left. \\frac{dC_A}{dz} \\right|_{z=0} $$\n对浓度分布求导并在$z=0$处取值，得到：\n$$ \\left. \\frac{dC_A}{dz} \\right|_{z=0} = - C_{A,i} \\sqrt{\\frac{k}{D}} \\coth\\left(\\delta \\sqrt{\\frac{k}{D}}\\right) $$\n因此，有反应时的吸收通量为：\n$$ N_A = C_{A,i} \\sqrt{kD} \\coth\\left(\\delta \\sqrt{\\frac{k}{D}}\\right) $$\n增强因子$E$是此通量与纯物理吸收（$k=0$）下发生的通量之比，后者记为$N_A^*$。对于物理吸收，通量为 $N_A^* = k_L C_{A,i}$，其中$k_L$是物理传质系数，在膜理论中定义为 $k_L = D/\\delta$。\n$$ E = \\frac{N_A}{N_A^*} = \\frac{C_{A,i} \\sqrt{kD} \\coth\\left(\\delta \\sqrt{k/D}\\right)}{k_L C_{A,i}} = \\frac{\\sqrt{kD}}{k_L} \\coth\\left(\\frac{D}{k_L} \\sqrt{\\frac{k}{D}}\\right) $$\n通过引入无量纲的Hatta数$Ha$来简化此关系：\n$$ Ha = \\frac{\\sqrt{kD}}{k_L} $$\nHatta数比较了反应速率与传质速率。用$Ha$表示，增强因子变为：\n$$ E = Ha \\coth(Ha) $$\n这是连接增强因子与系统性质的基本关系。问题给出$E = 7.50$。我们必须求解超越方程$Ha \\coth(Ha) = 7.50$以得到$Ha$。当$Ha \\gtrsim 3$时，反应被认为是快速反应，且$\\coth(Ha) \\rightarrow 1$。在此极限下，$E \\approx Ha$。鉴于$E=7.50$，这个近似非常好。精确计算表明，如果$Ha=7.50$，则$Ha \\coth(7.50) \\approx 7.50 \\times (1.0000006) \\approx 7.5000045$。差异可以忽略不计。因此，我们取$Ha = 7.50$。\n\n现在我们可以根据Hatta数的定义求解本征速率常数$k$：\n$$ k = \\frac{Ha^2 k_L^2}{D} $$\n代入给定值：\n$$ k = \\frac{(7.50)^2 (2.00 \\times 10^{-5} \\text{ m s}^{-1})^2}{1.50 \\times 10^{-9} \\text{ m}^2 \\text{ s}^{-1}} $$\n$$ k = \\frac{56.25 \\times (4.00 \\times 10^{-10} \\text{ m}^2 \\text{ s}^{-2})}{1.50 \\times 10^{-9} \\text{ m}^2 \\text{ s}^{-1}} = \\frac{2.25 \\times 10^{-8} \\text{ m}^2 \\text{ s}^{-2}}{1.50 \\times 10^{-9} \\text{ m}^2 \\text{ s}^{-1}} $$\n$$ k = 15.0 \\text{ s}^{-1} $$\n计算值已经是三位有效数字。\n\n最后，我们讨论当气侧阻力不可忽略时，$k$的可确定性问题。当同时存在气侧和液侧阻力时，通量由总传质表达式给出：\n$$ N_A = \\frac{p_{A,G} - H C_{A,b}}{\\frac{1}{k_g} + \\frac{H}{E k_L}} $$\n其中，$p_{A,G}$是气体主体分压，$k_g$是气侧传质系数，$H$是亨利常数。对于物理吸收（$k=0 \\implies E=1$），通量为$N_A^* = (p_{A,G} - H C_{A,b}) / (1/k_g + H/k_L)$。实验测量的是*观测*增强因子$E_{obs} = N_A/N_A^*$。\n$$ E_{obs} = \\frac{\\frac{1}{k_g} + \\frac{H}{k_L}}{\\frac{1}{k_g} + \\frac{H}{E k_L}} $$\n为了确定本征速率常数$k$，必须首先从测量的$E_{obs}$中找出本征增强因子$E$。该方程表明，$E$不仅取决于$E_{obs}$，还取决于气侧和液侧阻力的相对贡献，而这些贡献是$k_g$、$k_L$和$H$的函数。如果只测量了$E_{obs}$，而参数$k_g$和$H$未知，就不可能唯一地解出本征因子$E$。单次测量$E_{obs}$不足以解耦气侧阻力、液侧阻力和本征反应动力学的耦合效应。因此，如果没有关于$k_g$和$H$的独立知识或测量，本征速率常数$k$无法从测量的总增强因子中唯一确定。", "answer": "$$\n\\boxed{15.0}\n$$", "id": "2503840"}, {"introduction": "这最后一个练习将我们带入高级建模领域，用于处理那些无法获得简单解析解的、更真实和复杂的系统。虽然菲克定律是一个有用的近似，但许多现实世界的过程涉及多组分混合物，其中扩散通量是耦合的，这需要更严格的麦克斯韦-斯特凡（Maxwell-Stefan）公式。这个问题将指导您开发一个数值方案来求解这些耦合的非线性方程，从而磨练一项对于现代化学工程领域的计算研究和过程模拟至关重要的技能 [@problem_id:2503863]。", "problem": "考虑在厚度为 $L$ 的无孔隙静态气膜中发生的等温、等压、一维扩散和均相反应，该气膜包含三种理想气体组分：反应物 $A$、反应物 $B$ 和惰性物质 $I$。不可逆反应为 $A + B \\rightarrow 2 I$，在整个气膜中以二级动力学 $r = k \\, c_A \\, c_B$ 进行均相反应，其中 $c_A$ 和 $c_B$ 是摩尔浓度。假设气体混合物是理想的，总摩尔浓度为 $c = p/(R T)$，其中 $p$ 是压力，$T$ 是温度，$R$ 是普适气体常数。令 $x_i$ 和 $N_i$ 分别表示组分 $i \\in \\{A,B,I\\}$ 在 $z$ 方向（垂直于气膜）的摩尔分数和摩尔通量。气膜由两个充分搅拌的储库界定，这两个储库在 $z=0$ 和 $z=L$ 处施加了固定的组成：$x_A(0)=x_{A,0}$，$x_B(0)=x_{B,0}$，$x_A(L)=x_{A,L}$ 和 $x_B(L)=x_{B,L}$；惰性组分的摩尔分数由 $x_I = 1 - x_A - x_B$ 得出。二元Maxwell–Stefan扩散系数 $D_{AB}$、$D_{AI}$ 和 $D_{BI}$ 是恒定且对称的（例如，$D_{AB}=D_{BA}$）。\n\n您需要从第一性原理出发，推导一个数值方案来求解该气膜中具有二级动力学的Maxwell–Stefan扩散反应问题，然后实现该方案以计算一个小测试套件在 $z=0$ 处的 $A$ 的摩尔通量。您的推导和实现必须从以下几点开始：\n\n- 稳态下一维空间中带均相反应的组分平衡：$\\dfrac{d N_i}{d z} = \\nu_i \\, r$，其中 $\\nu_A=-1$，$\\nu_B=-1$，$\\nu_I=+2$。\n- 理想多组分混合物在一维空间中的Maxwell–Stefan通量-梯度关系：$-\\dfrac{d x_i}{d z} = \\dfrac{1}{c}\\sum_{j\\neq i}\\dfrac{x_j N_i - x_i N_j}{D_{ij}}$，并满足 $x_A + x_B + x_I = 1$。\n- 总浓度 $c = p/(R T)$ 和反应速率 $r = k \\, c_A \\, c_B = k \\, c^2 x_A x_B$。\n\n您的方案必须：\n- 明确强制执行由化学计量以及等温、等压条件得出的通量总和约束 $\\sum_i N_i = 0$，并解释如何利用它来消除一个通量变量。\n- 通过在每个空间位置构建和求解适当的线性系统，或通过将关系式重新排列为部分变量的常微分方程组（同时保持对原始Maxwell–Stefan结构的忠实），来处理Maxwell–Stefan方程的代数耦合。\n- 构建一个具有足够边界条件的边值问题，并设计一个算法对其进行数值求解，保证对下面提供的测试参数收敛。\n\n要求输出：\n- 对于每个测试案例，计算在 $z=0$ 处的组分 $A$ 的界面摩尔通量，记为 $N_A(0)$，并以 $\\mathrm{mol\\, m^{-2}\\, s^{-1}}$ 为单位报告。\n\n使用的物理单位：\n- $L$ 单位为 $\\mathrm{m}$，$p$ 单位为 $\\mathrm{Pa}$，$T$ 单位为 $\\mathrm{K}$，$D_{ij}$ 单位为 $\\mathrm{m^2\\, s^{-1}}$，$k$ 单位为 $\\mathrm{m^3\\, mol^{-1}\\, s^{-1}}$，$N_i$ 单位为 $\\mathrm{mol\\, m^{-2}\\, s^{-1}}$。\n- 使用 $R = 8.314462618\\, \\mathrm{J\\, mol^{-1}\\, K^{-1}}$。\n\n测试套件（每个测试是一个元组 $\\{L, p, T, D_{AB}, D_{AI}, D_{BI}, k, x_{A,0}, x_{B,0}, x_{A,L}, x_{B,L}\\}$）：\n- 测试 $1$：$\\{L = 1.0\\times 10^{-3},\\, p = 1.01325\\times 10^{5},\\, T = 3.30\\times 10^{2},\\, D_{AB} = 1.6\\times 10^{-5},\\, D_{AI} = 1.2\\times 10^{-5},\\, D_{BI} = 1.3\\times 10^{-5},\\, k = 5.0\\times 10^{-2},\\, x_{A,0} = 3.0\\times 10^{-1},\\, x_{B,0} = 2.0\\times 10^{-1},\\, x_{A,L} = 1.0\\times 10^{-1},\\, x_{B,L} = 4.0\\times 10^{-1}\\}$。\n- 测试 $2$（边界与无反应边缘情况）：$\\{L = 1.0\\times 10^{-3},\\, p = 1.01325\\times 10^{5},\\, T = 3.30\\times 10^{2},\\, D_{AB} = 1.6\\times 10^{-5},\\, D_{AI} = 1.2\\times 10^{-5},\\, D_{BI} = 1.3\\times 10^{-5},\\, k = 0.0,\\, x_{A,0} = 2.0\\times 10^{-1},\\, x_{B,0} = 3.0\\times 10^{-1},\\, x_{A,L} = 2.0\\times 10^{-1},\\, x_{B,L} = 3.0\\times 10^{-1}\\}$。\n- 测试 $3$（不对称扩散系数）：$\\{L = 5.0\\times 10^{-4},\\, p = 1.01325\\times 10^{5},\\, T = 3.40\\times 10^{2},\\, D_{AB} = 1.0\\times 10^{-5},\\, D_{AI} = 8.0\\times 10^{-6},\\, D_{BI} = 2.0\\times 10^{-5},\\, k = 2.0\\times 10^{-2},\\, x_{A,0} = 3.5\\times 10^{-1},\\, x_{B,0} = 1.5\\times 10^{-1},\\, x_{A,L} = 5.0\\times 10^{-2},\\, x_{B,L} = 4.5\\times 10^{-1}\\}$。\n- 测试 $4$（薄膜，更快反应）：$\\{L = 2.0\\times 10^{-4},\\, p = 1.01325\\times 10^{5},\\, T = 3.50\\times 10^{2},\\, D_{AB} = 1.6\\times 10^{-5},\\, D_{AI} = 1.2\\times 10^{-5},\\, D_{BI} = 1.3\\times 10^{-5},\\, k = 5.0\\times 10^{-1},\\, x_{A,0} = 2.5\\times 10^{-1},\\, x_{B,0} = 2.5\\times 10^{-1},\\, x_{A,L} = 1.0\\times 10^{-1},\\, x_{B,L} = 4.5\\times 10^{-1}\\}$。\n\n实现要求：\n- 您的程序必须求解由上述关系式和测试数据所隐含的边值问题，并生成一行输出，其中包含用方括号括起来的、按测试顺序排列的逗号分隔的结果列表，例如 $\\big[$$N_A^{(1)}(0), N_A^{(2)}(0), N_A^{(3)}(0), N_A^{(4)}(0)\\big]$，其中每个 $N_A^{(i)}(0)$ 是一个单位为 $\\mathrm{mol\\, m^{-2}\\, s^{-1}}$ 的浮点数。\n\n您的任务：\n- 推导满足上述要求的数学模型和稳健的数值方案。\n- 在最终答案部分以指定的单个、独立完整的程序实现它。", "solution": "所提出的问题在化学和数学上是合理的，代表了反应工程中的一个典型问题。该问题是适定的，提供了足够的控制方程和边界条件以确定唯一解。所有物理参数都在现实范围内。因此，我们将着手进行推导和求解。\n\n该问题需要求解一个描述同时发生的传质和化学反应的耦合非线性常微分方程(ODEs)组。我们首先从所提供的第一性原理推导完整的数学模型。\n\n该系统涉及三个组分：反应物 $A$、反应物 $B$ 和惰性物质 $I$。气膜存在于从 $z=0$ 到 $z=L$ 的区间。\n\n首先，我们建立控制ODE系统。系统在任何位置 $z$ 的状态由摩尔分数 $x_A(z)$、$x_B(z)$ 和摩尔通量 $N_A(z)$、$N_B(z)$ 描述。惰性组分的摩尔分数由加和约束 $x_I(z) = 1 - x_A(z) - x_B(z)$ 确定。\n\n稳态下每个组分 $i$ 的组分连续性方程为：\n$$ \\frac{d N_i}{d z} = \\nu_i r $$\n其中 $\\nu_i$ 是组分 $i$ 的化学计量系数，$r$ 是体积反应速率。对于反应 $A + B \\rightarrow 2 I$，化学计量系数为 $\\nu_A = -1$，$\\nu_B = -1$ 和 $\\nu_I = +2$。反应速率为 $r = k c_A c_B = k c^2 x_A x_B$，其中 $c$ 是恒定的总摩尔浓度，$c = p/(RT)$。\n\n因此，反应物 $A$ 和 $B$ 的组分平衡方程为：\n$$ \\frac{d N_A}{d z} = -k c^2 x_A x_B $$\n$$ \\frac{d N_B}{d z} = -k c^2 x_A x_B $$\n\n一个关于通量的关键约束来自于化学计量。将所有组分 $i \\in \\{A, B, I\\}$ 的组分连续性方程相加，得到：\n$$ \\frac{d}{dz} \\left( \\sum_{i} N_i \\right) = r \\left( \\sum_{i} \\nu_i \\right) $$\n对于给定的反应，$\\sum_i \\nu_i = (-1) + (-1) + (+2) = 0$。这意味着 $\\frac{d}{dz}(\\sum_i N_i) = 0$，所以总摩尔通量 $\\sum_i N_i$ 在整个气膜中是恒定的。对于由不可渗透壁或不引起净对流的界面界定的静态膜，此常数必须为零。因此，我们强制执行以下条件：\n$$ N_A(z) + N_B(z) + N_I(z) = 0 \\quad \\text{对于所有 } z \\in [0, L] $$\n这使我们能够从Maxwell-Stefan方程中消除惰性通量 $N_I$：$N_I(z) = -N_A(z) - N_B(z)$。\n\n接下来，我们使用Maxwell-Stefan关系式构建摩尔分数的ODE。对于一个三元体系，我们有两个独立的摩尔分数梯度方程。对于组分 $A$ 和 $B$：\n$$ -\\frac{d x_A}{d z} = \\frac{1}{c}\\left(\\frac{x_B N_A - x_A N_B}{D_{AB}} + \\frac{x_I N_A - x_A N_I}{D_{AI}}\\right) $$\n$$ -\\frac{d x_B}{d z} = \\frac{1}{c}\\left(\\frac{x_A N_B - x_B N_A}{D_{AB}} + \\frac{x_I N_B - x_B N_I}{D_{BI}}\\right) $$\n将 $x_I = 1 - x_A - x_B$ 和 $N_I = -N_A - N_B$ 代入这些方程，我们得到摩尔分数梯度仅用组分 $A$ 和 $B$ 的摩尔分数和通量表示的显式表达式。\n对于 $x_A$：\n$$ -\\frac{d x_A}{d z} = \\frac{1}{c}\\left[ \\frac{x_B N_A - x_A N_B}{D_{AB}} + \\frac{(1 - x_A - x_B) N_A - x_A (-N_A - N_B)}{D_{AI}} \\right] $$\n$$ \\frac{d x_A}{d z} = -\\frac{1}{c} \\left[ N_A \\left( \\frac{x_B}{D_{AB}} + \\frac{1 - x_B}{D_{AI}} \\right) + N_B \\left( \\frac{x_A}{D_{AI}} - \\frac{x_A}{D_{AB}} \\right) \\right] $$\n对于 $x_B$：\n$$ -\\frac{d x_B}{d z} = \\frac{1}{c}\\left[ \\frac{x_A N_B - x_B N_A}{D_{AB}} + \\frac{(1 - x_A - x_B) N_B - x_B (-N_A - N_B)}{D_{BI}} \\right] $$\n$$ \\frac{d x_B}{d z} = -\\frac{1}{c} \\left[ N_A \\left( \\frac{x_B}{D_{BI}} - \\frac{x_B}{D_{AB}} \\right) + N_B \\left( \\frac{x_A}{D_{AB}} + \\frac{1 - x_A}{D_{BI}} \\right) \\right] $$\n\n我们现在构建了一个包含四个一阶ODE的系统。设状态向量为 $\\mathbf{y}(z) = [y_0(z), y_1(z), y_2(z), y_3(z)]^T = [x_A(z), x_B(z), N_A(z), N_B(z)]^T$。该系统为 $\\frac{d\\mathbf{y}}{dz} = \\mathbf{f}(z, \\mathbf{y})$，其中：\n$$ \\frac{dy_0}{dz} = -\\frac{1}{c} \\left[ y_2 \\left( \\frac{y_1}{D_{AB}} + \\frac{1 - y_1}{D_{AI}} \\right) + y_3 \\left( \\frac{y_0}{D_{AI}} - \\frac{y_0}{D_{AB}} \\right) \\right] $$\n$$ \\frac{dy_1}{dz} = -\\frac{1}{c} \\left[ y_2 \\left( \\frac{y_1}{D_{BI}} - \\frac{y_1}{D_{AB}} \\right) + y_3 \\left( \\frac{y_0}{D_{AB}} + \\frac{1 - y_0}{D_{BI}} \\right) \\right] $$\n$$ \\frac{dy_2}{dz} = -k c^2 y_0 y_1 $$\n$$ \\frac{dy_3}{dz} = -k c^2 y_0 y_1 $$\n\n该系统必须在问题陈述中给出的边界条件下求解：\n- 在 $z=0$ 处：$x_A(0)=x_{A,0}$ 和 $x_B(0)=x_{B,0}$。\n- 在 $z=L$ 处：$x_A(L)=x_{A,L}$ 和 $x_B(L)=x_{B,L}$。\n\n这构成了一个两点边值问题（BVP）。我们将使用打靶法（shooting method）来解决这个BVP。核心思想是将BVP转换为一个初值问题（IVP）。未知的初始条件是在 $z=0$ 处的通量，即 $N_A(0)$ 和 $N_B(0)$。让我们将这些未知值表示为 $u_A = N_A(0)$ 和 $u_B = N_B(0)$。\n\n算法过程如下：\n1.  对未知通量 $\\mathbf{u} = [u_A, u_B]^T$ 进行初始猜测。\n2.  利用完整的初始条件集 $\\mathbf{y}(0) = [x_{A,0}, x_{B,0}, u_A, u_B]^T$，使用数值求解器（如Runge-Kutta法）从 $z=0$ 到 $z=L$ 对四个ODE组成的系统进行积分，以求解该IVP。\n3.  积分得到在 $z=L$ 处的状态向量，包括计算出的摩尔分数 $x_A(L)$ 和 $x_B(L)$。\n4.  定义一个残差向量 $\\mathbf{F}(\\mathbf{u})$，表示在 $z=L$ 处计算出的边界条件与目标边界条件之间的差异：\n    $$ \\mathbf{F}(\\mathbf{u}) = \\begin{pmatrix} x_A(L; u_A, u_B) - x_{A,L} \\\\ x_B(L; u_A, u_B) - x_{B,L} \\end{pmatrix} $$\n5.  使用数值求根算法（如拟牛顿法）来找到使残差 $\\mathbf{F}(\\mathbf{u})$ 趋于零的向量 $\\mathbf{u}$。$\\mathbf{F}(\\mathbf{u})=\\mathbf{0}$ 的解中的 $u_A$ 和 $u_B$ 值就是正确的初始通量 $N_A(0)$ 和 $N_B(0)$。\n\n此迭代过程的收敛性关键取决于对 $[N_A(0), N_B(0)]$ 的一个良好初始猜测。通过考虑无反应（$k=0$）的简化情况，可以得出一个稳健的猜测。在此极限下，通量 $N_A$ 和 $N_B$ 是恒定的。将Maxwell-Stefan方程从 $z=0$ 积分到 $z=L$，并用其平均值（$\\bar{x}_i = (x_{i,0} + x_{i,L})/2$）近似与组成相关的项，可以得到一个关于通量 $N_A$ 和 $N_B$ 的 $2 \\times 2$ 线性系统。求解该系统可为求根算法提供一个基于物理的初始猜测。\n\n这个数值方案在以下程序中实现。它使用`scipy.integrate.solve_ivp`进行ODE积分，并使用`scipy.optimize.root`来求解打靶法的非线性代数方程。最终输出是在边界 $z=0$ 处的组分 $A$ 的计算摩尔通量 $N_A(0)$。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the multicomponent diffusion-reaction problem using a shooting method.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.314462618\n\n    # Test suite from the problem statement\n    test_cases = [\n        # {L, p, T, D_AB, D_AI, D_BI, k, x_A,0, x_B,0, x_A,L, x_B,L}\n        # Test 1\n        (1.0e-3, 1.01325e5, 3.30e2, 1.6e-5, 1.2e-5, 1.3e-5, 5.0e-2, 3.0e-1, 2.0e-1, 1.0e-1, 4.0e-1),\n        # Test 2\n        (1.0e-3, 1.01325e5, 3.30e2, 1.6e-5, 1.2e-5, 1.3e-5, 0.0, 2.0e-1, 3.0e-1, 2.0e-1, 3.0e-1),\n        # Test 3\n        (5.0e-4, 1.01325e5, 3.40e2, 1.0e-5, 8.0e-6, 2.0e-5, 2.0e-2, 3.5e-1, 1.5e-1, 5.0e-2, 4.5e-1),\n        # Test 4\n        (2.0e-4, 1.01325e5, 3.50e2, 1.6e-5, 1.2e-5, 1.3e-5, 5.0e-1, 2.5e-1, 2.5e-1, 1.0e-1, 4.5e-1),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L, p, T, D_AB, D_AI, D_BI, k, xA0, xB0, xAL, xBL = case\n        \n        # Total molar concentration in mol m^-3\n        c = p / (R * T)\n\n        def ode_system(z, y):\n            \"\"\"Defines the system of 4 first-order ODEs.\"\"\"\n            xA, xB, NA, NB = y\n\n            # Prevent solver from exploring non-physical regions. If mole fractions\n            # go out of the [0, 1] range, return large gradients to penalize the step.\n            if not (0 = xA = 1 and 0 = xB = 1 and 0 = xA + xB = 1):\n                return [1e6, 1e6, 1e6, 1e6]\n\n            # Reaction rate in mol m^-3 s^-1\n            rate = k * c**2 * xA * xB\n            \n            # Mole fraction gradients from Maxwell-Stefan equations (dx_i/dz)\n            dxAdz = -1/c * (NA * (xB/D_AB + (1-xB)/D_AI) + NB * (xA/D_AI - xA/D_AB))\n            dxBdz = -1/c * (NA * (xB/D_BI - xB/D_AB) + NB * (xA/D_AB + (1-xA)/D_BI))\n            \n            # Flux gradients from species balances (dN_i/dz)\n            dNAdz = -rate\n            dNBdz = -rate\n            \n            return [dxAdz, dxBdz, dNAdz, dNBdz]\n\n        def get_residuals(u):\n            \"\"\"\n            Calculates the residuals at z=L for given initial fluxes at z=0.\n            The input u is a vector [NA(0), NB(0)].\n            \"\"\"\n            NA0, NB0 = u\n            y0 = [xA0, xB0, NA0, NB0]\n            \n            # Solve the initial value problem\n            sol = solve_ivp(ode_system, [0, L], y0, method='RK45', atol=1e-9, rtol=1e-9)\n            \n            if sol.status != 0:\n                # If integration fails, return large residuals to guide the root finder away\n                return [1e6, 1e6]\n            \n            # Solution at z=L\n            yL = sol.y[:, -1]\n            xAL_calc, xBL_calc = yL[0], yL[1]\n            \n            # Residuals are the differences between calculated and target boundary values\n            return [xAL_calc - xAL, xBL_calc - xBL]\n\n        # Calculate a good initial guess for the shooting method\n        # This is based on a linearized, no-reaction model\n        xA_avg = (xA0 + xAL) / 2\n        xB_avg = (xB0 + xBL) / 2\n        \n        M_guess = np.zeros((2, 2))\n        M_guess[0, 0] = (xB_avg/D_AB + (1-xB_avg)/D_AI)\n        M_guess[0, 1] = (xA_avg/D_AI - xA_avg/D_AB)\n        M_guess[1, 0] = (xB_avg/D_BI - xB_avg/D_AB)\n        M_guess[1, 1] = (xA_avg/D_AB + (1-xA_avg)/D_BI)\n\n        b_guess = np.array([c/L * (xA0 - xAL), c/L * (xB0 - xBL)])\n\n        try:\n            if abs(np.linalg.det(M_guess)) > 1e-12:\n                u_guess = np.linalg.solve(M_guess, b_guess)\n            else:\n                # If determinant is zero, guess is likely zero (e.g., Test 2)\n                u_guess = np.array([0.0, 0.0])\n        except np.linalg.LinAlgError:\n            # Fallback for any linear algebra errors\n            u_guess = np.array([0.0, 0.0])\n\n        # Solve the BVP using the shooting method with scipy.optimize.root\n        solution = root(get_residuals, u_guess, method='hybr', options={'xtol': 1e-9})\n        \n        if not solution.success:\n            # If the calculated guess fails, try a zero guess as a fallback\n            solution = root(get_residuals, [0.0, 0.0], method='hybr', options={'xtol': 1e-9})\n            if not solution.success:\n                # This should not happen for the given test cases, but indicates a convergence problem\n                results.append(np.nan) \n                continue\n\n        # The result is the flux of A at z=0, which is the first component of the solution vector\n        NA0_sol = solution.x[0]\n        results.append(NA0_sol)\n        \n    # Print results in the required format\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```", "id": "2503863"}]}