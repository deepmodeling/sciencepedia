{"hands_on_practices": [{"introduction": "理解局部截断误差的第一步是学会如何计算它。这个练习将指导你完成一个基本但至关重要的计算：为前向欧拉法应用于一个简单的非线性常微分方程时，推导其局部截断误差。通过运用泰勒展开，你将亲手揭示数值方法在单步计算中引入的误差是如何与步长 $h$ 和解本身的性质相关联的，为我们后续分析和改进数值方法奠定基础 [@problem_id:2185077]。", "problem": "考虑自治常微分方程 (ODE)：\n$$ \\frac{dy}{dt} = \\alpha y^{2} $$\n其中 $\\alpha$ 是一个非零参数。该方程将使用前向欧拉法进行数值求解，该方法使用以下公式将解从时间 $t_n$推进到 $t_{n+1} = t_n + h$：\n$$ y_{n+1} = y_n + h f(t_n, y_n) $$\n这里，$h$ 是恒定步长，$y_n$ 是真实解 $y(t)$ 在时间 $t_n$ 处的数值近似。\n\n局部截断误差（单位步长），记为 $\\tau_{n+1}$，量化了方法单步引入的误差，假设起始值是精确的。其定义为：\n$$ \\tau_{n+1} = \\frac{y(t_{n+1}) - y_{n+1}^{\\text{Euler}}}{h} $$\n其中 $y(t)$ 是通过点 $(t_n, y(t_n))$ 的 ODE 的精确解，而 $y_{n+1}^{\\text{Euler}}$ 是从这个精确点开始，通过前向欧拉法一步计算得到的值，即 $y_{n+1}^{\\text{Euler}} = y(t_n) + h f(t_n, y(t_n))$。\n\n确定此方法和 ODE 的局部截断误差 $\\tau_{n+1}$ 的主项。主项是当 $h \\to 0$ 时，$h$ 的最低阶项。请用 $\\alpha$、$h$ 和 $y(t_n)$ 的符号表示您的答案。", "solution": "目标是求出将前向欧拉法应用于常微分方程 (ODE) $y' = \\alpha y^2$ 时的局部截断误差 (LTE) 的主项。\n\n单位步长的局部截断误差的定义如下：\n$$ \\tau_{n+1} = \\frac{y(t_{n+1}) - y_{n+1}^{\\text{Euler}}}{h} $$\n这里我们假设计算从时间 $t_n$ 处的一个精确值开始，因此欧拉步长由 $y_{n+1}^{\\text{Euler}} = y(t_n) + h f(t_n, y(t_n))$ 给出。项 $y(t_{n+1})$ 表示在时间 $t_{n+1} = t_n + h$ 处求值的精确解。\n\n首先，我们从给定的 ODE 中确定函数 $f(t,y)$：\n$$ \\frac{dy}{dt} = \\alpha y^{2} \\implies f(t,y) = \\alpha y^{2} $$\n因此，从精确解 $y(t_n)$ 开始的前向欧拉法的一步是：\n$$ y_{n+1}^{\\text{Euler}} = y(t_n) + h (\\alpha y(t_n)^2) $$\n\n接下来，我们使用泰勒级数展开将真实解 $y(t)$ 在点 $t_n$ 附近展开到 $h$ 的二阶项：\n$$ y(t_{n+1}) = y(t_n + h) = y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + \\mathcal{O}(h^3) $$\n其中 $y'(t_n)$ 和 $y''(t_n)$ 是在 $t=t_n$ 处求值的精确解的一阶和二阶导数。\n\n现在，我们将泰勒展开式和前向欧拉步长的表达式都代入 LTE 的定义中：\n$$ \\tau_{n+1} = \\frac{1}{h} \\left[ \\left( y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + \\mathcal{O}(h^3) \\right) - \\left( y(t_n) + h \\alpha y(t_n)^2 \\right) \\right] $$\n\n从 ODE 本身，我们知道 $y'(t) = \\alpha y(t)^2$。在 $t_n$ 处求值得到 $y'(t_n) = \\alpha y(t_n)^2$。我们可以将其代入 $\\tau_{n+1}$ 的表达式中：\n$$ \\tau_{n+1} = \\frac{1}{h} \\left[ \\left( y(t_n) + h (\\alpha y(t_n)^2) + \\frac{h^2}{2} y''(t_n) + \\mathcal{O}(h^3) \\right) - \\left( y(t_n) + h \\alpha y(t_n)^2 \\right) \\right] $$\n\n项 $y(t_n)$ 和 $h \\alpha y(t_n)^2$ 相互抵消：\n$$ \\tau_{n+1} = \\frac{1}{h} \\left[ \\frac{h^2}{2} y''(t_n) + \\mathcal{O}(h^3) \\right] $$\n$$ \\tau_{n+1} = \\frac{h}{2} y''(t_n) + \\mathcal{O}(h^2) $$\n\n为了找到主项，我们需要计算 $y''(t_n)$。我们使用链式法则对 ODE $y'(t) = \\alpha y(t)^2$ 关于 $t$求导：\n$$ y''(t) = \\frac{d}{dt} \\left( \\alpha y(t)^2 \\right) = \\alpha \\cdot 2 y(t) \\cdot y'(t) $$\n现在，我们将 $y'(t)$ 的表达式代回这个方程：\n$$ y''(t) = 2 \\alpha y(t) \\left( \\alpha y(t)^2 \\right) = 2 \\alpha^2 y(t)^3 $$\n在 $t_n$ 处求值得到：\n$$ y''(t_n) = 2 \\alpha^2 y(t_n)^3 $$\n\n最后，我们将 $y''(t_n)$ 的这个表达式代入我们的 $\\tau_{n+1}$ 方程中：\n$$ \\tau_{n+1} = \\frac{h}{2} \\left( 2 \\alpha^2 y(t_n)^3 \\right) + \\mathcal{O}(h^2) $$\n$$ \\tau_{n+1} = \\alpha^2 h y(t_n)^3 + \\mathcal{O}(h^2) $$\n\n局部截断误差的主项是当 $h \\to 0$ 时展开式中的首项，也就是 $h$ 的最低次幂项。在这种情况下，它是 $\\alpha^2 h y(t_n)^3$。", "answer": "$$\\boxed{\\alpha^{2} h y(t_n)^{3}}$$", "id": "2185077"}, {"introduction": "一旦我们掌握了如何分析误差，下一步自然就是思考如何控制甚至减小它。$\\theta$-方法为我们提供了一个绝佳的平台，它通过一个参数 $\\theta$ 统一了包括前向欧拉法和梯形法则在内的多种方法。在这个练习中，你的任务是扮演一个数值方法设计者的角色，通过调整参数 $\\theta$ 来消除局部截断误差中的低阶项，从而创造出一个更高阶、更精确的数值格式 [@problem_id:2185097]。这个过程将让你深刻体会到，对误差结构的精确分析是设计高效数值算法的核心。", "problem": "求解形如 $y'(t) = f(t, y(t))$ 的一阶常微分方程 (ODE) 的一类通用单步数值方法被称为 $\\theta$ 方法。对于均匀步长 $h = t_{n+1} - t_n$，该方法由以下隐式公式定义：\n$$y_{n+1} = y_n + h \\left[ (1-\\theta)f(t_n, y_n) + \\theta f(t_{n+1}, y_{n+1}) \\right]$$\n其中 $y_n$ 是精确解 $y(t)$ 在时间 $t_n$ 处的数值近似，$\\theta$ 是一个在 $[0, 1]$ 范围内的常数参数。该方法的特例包括显式欧拉法 ($\\theta=0$)、隐式欧拉法 ($\\theta=1$) 和梯形法则 ($\\theta=1/2$)。\n\n局部截断误差 $T_{n+1}$ 量化了该方法在单步中引入的误差，其假设前一步的解是精确的，即 $y_n = y(t_n)$。它被定义为将精确解 $y(t)$ 代入数值格式后得到的残差：\n$$T_{n+1} = y(t_{n+1}) - y(t_n) - h \\left[ (1-\\theta)y'(t_n) + \\theta y'(t_{n+1}) \\right]$$\n数值方法的阶定义为整数 $p$，使得 $T_{n+1} = \\mathcal{O}(h^{p+1})$。对于小步长，更高的阶通常意味着更高的精度。\n\n你的任务是找到使 $\\theta$ 方法的阶 $p$ 最大化的参数 $\\theta$ 的具体值。假设精确解 $y(t)$ 足够光滑，即其任意所需阶的导数都存在且连续。", "solution": "我们的目标是找到使 $\\theta$ 方法的阶最大化的 $\\theta \\in [0, 1]$ 的值。阶 $p$ 由局部截断误差 (LTE) $T_{n+1}$ 决定，其中 $T_{n+1} = \\mathcal{O}(h^{p+1})$。为了找到这个值，我们需要将 $T_{n+1}$ 表达式中的各项按步长 $h$ 的幂展开为泰勒级数。\n\n局部截断误差的定义如下：\n$$T_{n+1} = y(t_{n+1}) - y(t_n) - h \\left[ (1-\\theta)y'(t_n) + \\theta y'(t_{n+1}) \\right]$$\n我们来逐项分析。我们将关于 $t_{n+1} = t_n + h$ 的函数在点 $t_n$ 处进行泰勒级数展开。\n\n$y(t_{n+1})$ 的展开式为：\n$$y(t_{n+1}) = y(t_n + h) = y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + \\frac{h^3}{6} y'''(t_n) + \\mathcal{O}(h^4)$$\n\n$y'(t_{n+1})$ 的展开式为：\n$$y'(t_{n+1}) = y'(t_n + h) = y'(t_n) + h y''(t_n) + \\frac{h^2}{2} y'''(t_n) + \\mathcal{O}(h^3)$$\n\n现在，我们将这些展开式代回 $T_{n+1}$ 的表达式中：\n$$T_{n+1} = \\left( y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + \\frac{h^3}{6} y'''(t_n) + \\mathcal{O}(h^4) \\right) - y(t_n) - h \\left[ (1-\\theta)y'(t_n) + \\theta \\left( y'(t_n) + h y''(t_n) + \\frac{h^2}{2} y'''(t_n) + \\mathcal{O}(h^3) \\right) \\right]$$\n\n我们先化简方括号内的项：\n$$(1-\\theta)y'(t_n) + \\theta \\left( y'(t_n) + h y''(t_n) + \\frac{h^2}{2} y'''(t_n) + \\dots \\right)$$\n$$= (1-\\theta)y'(t_n) + \\theta y'(t_n) + \\theta h y''(t_n) + \\theta \\frac{h^2}{2} y'''(t_n) + \\mathcal{O}(h^3)$$\n$$= y'(t_n) + \\theta h y''(t_n) + \\frac{\\theta h^2}{2} y'''(t_n) + \\mathcal{O}(h^3)$$\n\n现在，将这个化简后的表达式代回 $T_{n+1}$ 的方程中：\n$$T_{n+1} = \\left( y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + \\frac{h^3}{6} y'''(t_n) \\right) - y(t_n) - h \\left( y'(t_n) + \\theta h y''(t_n) + \\frac{\\theta h^2}{2} y'''(t_n) \\right) + \\mathcal{O}(h^4)$$\n\n分配因子 $-h$：\n$$T_{n+1} = \\left( y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + \\frac{h^3}{6} y'''(t_n) \\right) - y(t_n) - h y'(t_n) - \\theta h^2 y''(t_n) - \\frac{\\theta h^3}{2} y'''(t_n) + \\mathcal{O}(h^4)$$\n\n现在，我们根据 $h$ 的幂次合并同类项：\n$\\mathcal{O}(h^0)$ 阶的项是 $y(t_n) - y(t_n) = 0$。\n$\\mathcal{O}(h^1)$ 阶的项是 $h y'(t_n) - h y'(t_n) = 0$。\n直到 $\\mathcal{O}(h^1)$ 的项都相消，这证实了该方法是相容的，意味着对于任何 $\\theta$，其阶 $p$ 至少为 1。\n\n$\\mathcal{O}(h^2)$ 阶的项是：\n$$\\frac{h^2}{2} y''(t_n) - \\theta h^2 y''(t_n) = \\left( \\frac{1}{2} - \\theta \\right) h^2 y''(t_n)$$\n\n$\\mathcal{O}(h^3)$ 阶的项是：\n$$\\frac{h^3}{6} y'''(t_n) - \\frac{\\theta h^3}{2} y'''(t_n) = \\left( \\frac{1}{6} - \\frac{\\theta}{2} \\right) h^3 y'''(t_n)$$\n\n所以，局部截断误差的展开式为：\n$$T_{n+1} = \\left( \\frac{1}{2} - \\theta \\right) h^2 y''(t_n) + \\left( \\frac{1}{6} - \\frac{\\theta}{2} \\right) h^3 y'''(t_n) + \\mathcal{O}(h^4)$$\n\n为了使方法的阶最大化，我们必须选择 $\\theta$ 使 $h$ 的最低次幂项的系数为零。最低次幂项是 $h^2$ 项。我们将其系数设为零：\n$$\\frac{1}{2} - \\theta = 0$$\n解出 $\\theta$，我们得到：\n$$\\theta = \\frac{1}{2}$$\n\n对于这个 $\\theta$ 值，$O(h^2)$ 项消失。局部截断误差变为：\n$$T_{n+1} = \\left( \\frac{1}{6} - \\frac{1/2}{2} \\right) h^3 y'''(t_n) + \\mathcal{O}(h^4) = \\left( \\frac{1}{6} - \\frac{1}{4} \\right) h^3 y'''(t_n) + \\mathcal{O}(h^4) = -\\frac{1}{12} h^3 y'''(t_n) + \\mathcal{O}(h^4)$$\n在这种情况下，$T_{n+1} = \\mathcal{O}(h^3)$。由于阶 $p$ 由 $T_{n+1} = \\mathcal{O}(h^{p+1})$ 定义，我们有 $p+1=3$，这意味着 $p=2$。\n\n对于任何其他 $\\theta \\neq 1/2$ 的选择，LTE 中最低次幂的非零项是 $\\mathcal{O}(h^2)$ 项。因此，对于 $\\theta \\neq 1/2$，我们有 $T_{n+1} = \\mathcal{O}(h^2)$，这对应于 $p=1$ 的阶。\n\n因此，当 $\\theta = 1/2$ 时，该方法的阶达到最大值 $p=2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2185097"}, {"introduction": "理论上的局部误差分析最终要服务于实践：我们真正关心的是在整个求解区间上累积的全局误差。这个练习将局部误差的“阶”与全局误差的实际表现联系起来。通过一个简单的思想实验，你将探索一个二阶方法的全局误差是如何随着步长的改变而变化的 [@problem_id:2185101]。理解这种缩放关系对于在实际应用中预估计算成本、选择合适的步长以及验证代码的正确性至关重要。", "problem": "一位数值分析家正在研究一种用于在固定区间上求解常微分方程的稳定数值方法的精度。已知该方法为二阶方法。在第一次计算实验中，分析家使用恒定步长 $h$ 计算解，并发现区间末端的全局截断误差约为 $\\epsilon$。\n\n在第二次实验中，分析家决定将步长改为 $2h$，同时保持所有其他参数和微分方程不变。假设该方法保持稳定，并且全局误差与步长的关系在此范围内成立，那么第二次实验的估计全局截断误差是多少？\n\nA. $\\frac{\\epsilon}{4}$\n\nB. $\\frac{\\epsilon}{2}$\n\nC. $\\epsilon$\n\nD. $2\\epsilon$\n\nE. $4\\epsilon$", "solution": "一个 $p$ 阶的稳定方法，在固定的最终时间点，其全局截断误差与步长的关系为 $E(h)=C h^{p}$，其中 $C$ 是一个与 $h$ 无关的常数，前提是该方法保持稳定且渐近误差关系成立。\n\n已知该方法为二阶方法，即 $p=2$。当步长为 $h$ 时，观测到的全局误差为 $\\epsilon$，所以\n$$\n\\epsilon = C h^{2}.\n$$\n如果步长变为 $2h$，新的全局误差为\n$$\nE(2h) = C (2h)^{2} = 4 C h^{2} = 4 \\epsilon.\n$$\n因此，将步长加倍会使全局误差乘以 $4$，这对应于选项 E。", "answer": "$$\\boxed{E}$$", "id": "2185101"}]}