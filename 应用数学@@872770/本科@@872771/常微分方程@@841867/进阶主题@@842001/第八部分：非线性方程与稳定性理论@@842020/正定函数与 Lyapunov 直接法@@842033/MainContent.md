## 引言
在动力系统的研究中，判断一个[平衡点](@entry_id:272705)是否稳定是核心问题之一。直接求解复杂的[非线性微分方程](@entry_id:175929)往往非常困难甚至不可能，因此，发展不依赖于解析解的[稳定性分析](@entry_id:144077)方法至关重要。[李雅普诺夫直接法](@entry_id:168377)（或称第二方法）正是为此而生的一种极其强大的工具，它通过一个巧妙的类比——系统的“能量”，为我们提供了洞察系统[长期行为](@entry_id:192358)的深刻视角。

本文旨在系统地介绍正定函数与[李雅普诺夫直接法](@entry_id:168377)。在接下来的内容中，我们将首先深入**原理与机制**，从物理直觉出发，严格定义正定函数与李雅普诺夫函数，并阐述核心的稳定性定理。随后，我们将在**应用与跨学科联系**一章中，展示该方法如何在物理、工程、控制理论等多个领域解决实际问题，并探讨构造[李雅普诺夫函数](@entry_id:273986)的高级技巧。最后，通过**动手实践**环节，您将有机会将所学理论应用于具体问题，巩固并加深理解。通过这一系列的学习，您将掌握一种无需求解方程即可分析[系统稳定性](@entry_id:273248)的核心技能。

## 原理与机制

在上一章中，我们介绍了动力[系统稳定性](@entry_id:273248)理论的基本概念。本章将深入探讨一种无需直接求解微分方程即可判断[平衡点稳定性](@entry_id:261937)的强大工具——[李雅普诺夫直接法](@entry_id:168377)。这一方法的核心思想是，通过构造一个类似于系统“能量”的标量函数，并观察其如何随时间演化，来推断系统的[长期行为](@entry_id:192358)。

### 从物理直觉到数学构造：李雅普诺夫函数的思想

想象一个放置在碗底的弹珠。这个位置是一个稳定的[平衡点](@entry_id:272705)。如果我们轻推弹珠，它会沿碗壁上下滚动，但由于[摩擦力](@entry_id:171772)的作用，其[振荡](@entry_id:267781)幅度会越来越小，最终重新回到碗底。在这个过程中，弹珠的[总机械能](@entry_id:167353)（动能与势能之和）持续减少，直到达到最小值。

李雅普诺夫（[Aleksandr Lyapunov](@entry_id:202838)）将这一物理直觉提炼为一种严谨的数学方法。他提出，如果我们能为某个动力系统 $\dot{\mathbf{x}} = f(\mathbf{x})$（假设其[平衡点](@entry_id:272705)在原点 $\mathbf{x}=\mathbf{0}$）找到一个标量函数 $V(\mathbf{x})$，这个函数具有类似于“能量”的性质，我们就能判断该[平衡点的稳定性](@entry_id:177203)。这个被称为**李雅普诺夫函数**（Lyapunov function）的 $V(\mathbf{x})$ 应该满足：

1.  在[平衡点](@entry_id:272705)附近，它的值是正的，并且仅在[平衡点](@entry_id:272705)处为零。这好比势能坑，坑底是能量最低点。
2.  沿着系统的任何运动轨迹，它的值随时间递减。这对应于能量因“摩擦”或“阻尼”而耗散的过程。

如果能找到这样一个函数，那么系统状态就像那颗弹珠一样，无论从哪里开始，都必然会“滚向”能量最低点，即[平衡点](@entry_id:272705)。这便是[李雅普诺夫直接法](@entry_id:168377)的精髓所在。接下来的小节将对这些直观概念进行严格的数学定义。

### 正定函数：量化“类能量”函数

李雅普诺夫思想的第一个基石是严格定义一个在[平衡点](@entry_id:272705)处取唯一最小值的函数。这引出了**正定函数**（positive definite function）的概念。

一个在包含原点的区域 $D \subseteq \mathbb{R}^n$ 上连续可微的函数 $V(\mathbf{x})$，如果满足以下条件，则被称为在原点是**正定的**：

1.  $V(\mathbf{0}) = 0$。
2.  对于 $D$ 中任何非零点 $\mathbf{x} \neq \mathbf{0}$，都有 $V(\mathbf{x}) > 0$。

如果条件2被放宽为 $V(\mathbf{x}) \ge 0$，则该函数被称为**半正定的**（positive semidefinite）。显然，正定函数一定是半正定函数。

**示例与辨析**

-   最典型的正定函数是 $V(x, y) = x^2 + y^2$。它在 $(0,0)$ 处为零，在其他任何点都严格大于零。

-   考虑函数 $V(x, y) = (x-y)^2$ [@problem_id:2193225]。它满足 $V(0,0)=0$ 且对于所有 $(x,y)$ 都有 $V(x,y) \ge 0$，因此是半正定的。然而，它并非正定函数，因为在所有满足 $x=y$ 的非零点上（例如 $(1,1)$ 或 $(-2,-2)$），$V(x,y)$ 也等于零。这意味着函数的“谷底”不是一个点，而是一条直线。

-   对于二次型函数 $V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}$，其定性可以通过判断[对称矩阵](@entry_id:143130) $P$ 的定性来确定。例如，对于 $V(x,y) = 3x^2 - 4xy + 2y^2$ [@problem_id:2193269]，我们可以通过[配方法](@entry_id:265480)来检验其定性：
    $$ V(x,y) = 3(x^2 - \frac{4}{3}xy) + 2y^2 = 3(x - \frac{2}{3}y)^2 - 3(\frac{2}{3}y)^2 + 2y^2 = 3(x - \frac{2}{3}y)^2 + \frac{2}{3}y^2 $$
    这是一个具有正系数的平方和，仅当 $y=0$ 且 $x - \frac{2}{3}y = 0$（即 $x=0, y=0$）时才为零。因此，该函数是正定的。相反，函数 $V(x,y) = x^2+4xy+y^2$ [@problem_id:2193228] 不是正定的，因为在直线 $y=-x$ 附近，例如取点 $(1, -1.1)$，函数值为 $1 - 4.4 + 1.21 = -2.19  0$。实际上，在任何包含原[点的邻域](@entry_id:144055)内，该函数都会取到负值。

-   正定性是一个局部概念。函数 $V(x,y) = 1 - \cos(x) + y^2$ [@problem_id:2193228] 在原点附近是正定的。因为 $V(0,0)=0$，且在 $|x|2\pi$ 的邻域内，当 $x \neq 0$ 时 $1-\cos(x)>0$，所以只要 $(x,y) \neq (0,0)$，$V(x,y)$ 就严格大于零。

### 李雅普诺夫导数：追踪能量变化率

定义了“类能量”函数后，我们需要一个工具来衡量它如何沿着系统轨迹变化。对于系统 $\dot{\mathbf{x}} = f(\mathbf{x})$，函数 $V(\mathbf{x}(t))$ 对时间的[全导数](@entry_id:137587)，记为 $\dot{V}$，可以通过[链式法则](@entry_id:190743)计算：
$$ \dot{V} = \frac{dV}{dt} = \sum_{i=1}^{n} \frac{\partial V}{\partial x_i} \frac{dx_i}{dt} = \nabla V \cdot \dot{\mathbf{x}} = \nabla V(\mathbf{x}) \cdot f(\mathbf{x}) $$
这个导数被称为 $V$ 沿着系统轨迹的**李雅普诺夫导数**（Lyapunov derivative）或[轨道](@entry_id:137151)导数。请注意，$\dot{V}$ 最终被表示为[状态变量](@entry_id:138790) $\mathbf{x}$ 的函数，而无需知道解 $\mathbf{x}(t)$ 的具体形式。

类似于[正定性](@entry_id:149643)的定义，我们称 $\dot{V}(\mathbf{x})$ 是**负定的**（negative definite），如果 $\dot{V}(\mathbf{0})=0$ 且对所有 $\mathbf{x} \neq \mathbf{0}$ 有 $\dot{V}(\mathbf{x})  0$。若 $\dot{V}(\mathbf{x}) \le 0$，则称其为**负半定的**（negative semidefinite）。

**计算示例**

考虑系统 [@problem_id:2193238]：
$$ \begin{aligned} \dot{x} = -2x - y^3 \\ \dot{y} = xy^2 - y^5 \end{aligned} $$
我们选择一个候选[李雅普诺夫函数](@entry_id:273986) $V(x,y) = \frac{1}{2}x^2 + \frac{1}{2}y^2$，这是一个明显的正定函数。其梯度为 $\nabla V = \begin{pmatrix} x  y \end{pmatrix}^T$。
计算李雅普诺夫导数：
$$ \dot{V} = \frac{\partial V}{\partial x}\dot{x} + \frac{\partial V}{\partial y}\dot{y} = x(-2x - y^3) + y(xy^2 - y^5) $$
$$ \dot{V} = -2x^2 - xy^3 + xy^3 - y^6 = -2x^2 - y^6 = -(2x^2 + y^6) $$
由于 $2x^2 + y^6$ 仅在 $(0,0)$ 处为零，在其他地方都为正，因此 $\dot{V}(x,y)$ 是一个负定函数。这意味着无论系统处于哪个非平衡状态，其“能量”$V$ 都在严格减少。

### [李雅普诺夫稳定性定理](@entry_id:274584)

有了正定函数 $V$ 和李雅普诺夫导数 $\dot{V}$ 的概念，我们就可以陈述[李雅普诺夫直接法](@entry_id:168377)的核心定理。

#### [渐近稳定性](@entry_id:149743)

**定理（[渐近稳定性](@entry_id:149743)）**: 如果在[平衡点](@entry_id:272705) $\mathbf{x}=\mathbf{0}$ 的一个邻域内，存在一个正定函数 $V(\mathbf{x})$，其李雅普诺夫导数 $\dot{V}(\mathbf{x})$ 是负定的，则该[平衡点](@entry_id:272705)是**[渐近稳定](@entry_id:168077)的**（asymptotically stable）。

渐近稳定意味着，从[平衡点](@entry_id:272705)附近出发的轨迹不仅会保持在附近（稳定性），而且最终会收敛到该[平衡点](@entry_id:272705)。

一个经典的例子是分析一个带参数的系统 [@problem_id:2193201]。考虑系统：
$$ \begin{aligned} \dot{x} = p x - 5 y \\ \dot{y} = 5 x + p y \end{aligned} $$
其中 $p$ 是一个可调参数。我们使用 $V(x,y) = x^2 + y^2$（正定）来分析原点的稳定性。
$$ \dot{V} = 2x(px - 5y) + 2y(5x + py) = 2px^2 - 10xy + 10xy + 2py^2 = 2p(x^2 + y^2) = 2pV $$
-   如果 $p  0$，则 $\dot{V} = 2pV$ 是负定的，因为 $V>0$。根据定理，原点是[渐近稳定](@entry_id:168077)的。
-   如果 $p > 0$，则 $\dot{V}$ 是正定的。
-   如果 $p = 0$，则 $\dot{V} \equiv 0$。

这表明，只有当参数 $p$ 为负时，系统才能保证[稳定收敛](@entry_id:199422)。

#### 不稳定性

**定理（不稳定性）**: 如果在[平衡点](@entry_id:272705) $\mathbf{x}=\mathbf{0}$ 的一个邻域内，存在一个正定函数 $V(\mathbf{x})$，其李雅普诺夫导数 $\dot{V}(\mathbf{x})$ 也是正定的，则该[平衡点](@entry_id:272705)是**不稳定的**（unstable）。

直观上，这意味着系统的“能量”在不断增加，使状态远离平衡点。

考虑系统 [@problem_id:2193274]：
$$ \begin{aligned} \dot{x} = x^3 \\ \dot{y} = y^3 \end{aligned} $$
同样使用 $V(x,y) = x^2+y^2$。计算 $\dot{V}$：
$$ \dot{V} = 2x(x^3) + 2y(y^3) = 2x^4 + 2y^4 $$
显然，$V$ 和 $\dot{V}$ 都是正定函数。因此，原点是不稳定的。

#### （李雅普诺夫）稳定性

当 $\dot{V}$ 只是负半定时，我们能得到的结论较弱。

**定理（稳定性）**: 如果在[平衡点](@entry_id:272705) $\mathbf{x}=\mathbf{0}$ 的一个邻域内，存在一个正定函数 $V(\mathbf{x})$，其李雅普诺夫导数 $\dot{V}(\mathbf{x})$ 是负半定的，则该[平衡点](@entry_id:272705)是**稳定的**（stable in the sense of Lyapunov）。

“稳定”意味着从[平衡点](@entry_id:272705)附近出发的轨迹将始终保持在其初始位置的某个邻域内，但**不一定**收敛到[平衡点](@entry_id:272705)。

一个绝佳的例子是无阻尼单摆 [@problem_id:2193245]。其状态方程为 $\dot{x}_1 = x_2, \dot{x}_2 = -(g/L)\sin(x_1)$，其中 $x_1=\theta, x_2=\dot{\theta}$。系统的总能量函数（经过归一化和移位）可以作为李雅普诺夫函数：
$$ V(x_1, x_2) = \frac{g}{L}(1 - \cos(x_1)) + \frac{1}{2}x_2^2 $$
这个函数在原点 $(0,0)$ 附近是正定的。计算其李雅普诺夫导数：
$$ \dot{V} = \frac{g}{L}\sin(x_1) \dot{x}_1 + x_2 \dot{x}_2 = \frac{g}{L}\sin(x_1) x_2 + x_2(-\frac{g}{L}\sin(x_1)) = 0 $$
由于 $\dot{V} \equiv 0$，它是负半定的。因此，[平衡点](@entry_id:272705)是稳定的。然而，由于[能量守恒](@entry_id:140514)（$\dot{V}=0$），摆一旦被启动，就会永远在初始能量对应的[轨道](@entry_id:137151)上摆动，而不会停在最低点。这正是稳定而非[渐近稳定](@entry_id:168077)的体现。类似地，对于系统 $\dot{x}=-y^3, \dot{y}=x^3$ [@problem_id:2193205]，使用 $V=x^4+y^4$ 也会得到 $\dot{V}\equiv 0$，结论同样是稳定而非[渐近稳定](@entry_id:168077)。

### 深入一步：[拉萨尔不变性原理](@entry_id:266201)

当 $\dot{V}$ 是负半定但非零时，情况变得更加有趣。例如，如果[能量耗散](@entry_id:147406)只在系统的某些区域发生，系统最终会走向何方？这引出了**[拉萨尔不变性原理](@entry_id:266201)**（LaSalle's Invariance Principle），它是[李雅普诺夫直接法](@entry_id:168377)的有力推广。

**[拉萨尔不变性原理](@entry_id:266201) (简述)**: 设 $\Omega$ 是一个紧致的（即封[闭且有界](@entry_id:140798)的）正向[不变集](@entry_id:275226)（从该集合出发的轨迹将永远留在其中）。设 $V$ 是一个在 $\Omega$ 上连续可微的函数，且 $\dot{V}(\mathbf{x}) \le 0$ 对所有 $\mathbf{x} \in \Omega$ 成立。令 $E = \{\mathbf{x} \in \Omega \mid \dot{V}(\mathbf{x}) = 0\}$。那么，当 $t \to \infty$ 时，$\Omega$ 内的每一条轨迹都将收敛到 $E$ 中的最大不变[子集](@entry_id:261956) $M$。

通俗地讲，即使[能量耗散](@entry_id:147406)（$\dot{V}0$）不是处处发生，只要系统轨迹最终被限制在一个有界区域内，它也必须趋向于那个“不耗散能量”的集合 $E$ 中“可以永远待下去”的部分。

让我们看一个有阻尼的[非线性系统](@entry_id:168347) [@problem_id:2193203]：
$$ \begin{aligned} \dot{x}_1 = x_2 \\ \dot{x}_2 = -\sin(x_1) - x_2^3 \end{aligned} $$
使用与无阻尼单摆类似的能量函数 $V(x_1, x_2) = 1 - \cos(x_1) + \frac{1}{2} x_2^2$。该函数在原点附近是正定的。其导数为：
$$ \dot{V} = \sin(x_1)\dot{x}_1 + x_2\dot{x}_2 = \sin(x_1)x_2 + x_2(-\sin(x_1) - x_2^3) = -x_2^4 $$
这里 $\dot{V} = -x_2^4 \le 0$，是负半定的。能量耗散仅发生在 $x_2 \neq 0$（即摆在运动）时。当 $x_2=0$（摆在瞬时静止位置）时，$\dot{V}=0$。

根据[李雅普诺夫稳定性定理](@entry_id:274584)，我们只能得出原点是稳定的。但借助拉萨尔原理，我们可以得到更强的结论。考虑原点附近的一个紧致水平集 $\Omega_c = \{\mathbf{x} \mid V(\mathbf{x}) \le c\}$。在此集合内，$\dot{V} \le 0$，因此它是一个正向[不变集](@entry_id:275226)。
集合 $E$ 是 $\dot{V} = -x_2^4 = 0$ 的点集，即 $x_2=0$ 的直线（$x_1$ 轴）。
现在，我们需要寻找 $E$ 中的最大不变[子集](@entry_id:261956) $M$。一个轨迹若要停留在 $E$ 中，它必须始终满足 $x_2(t)=0$。如果 $x_2(t) \equiv 0$，那么 $\dot{x}_2(t) \equiv 0$。代入系统方程 $\dot{x}_2 = -\sin(x_1) - x_2^3$，我们得到 $0 = -\sin(x_1) - 0$，这意味着 $\sin(x_1)=0$。在原点附近，这只可能在 $x_1=0$ 时成立。因此，$E$ 中唯一的不变点是原点 $(0,0)$。
根据[拉萨尔不变性原理](@entry_id:266201)，所有从 $\Omega_c$ 出发的轨迹最终都必须收敛到这个最大不变[子集](@entry_id:261956)，即原点。这证明了原点是**局部渐近稳定的**。

### 全局与[局部稳定性](@entry_id:751408)：径向无界性

到目前为止，我们讨论的稳定性大多是“局部的”，即只对[平衡点](@entry_id:272705)附近的小邻域内的初始条件有效。我们如何断言一个[平衡点](@entry_id:272705)是**全局渐近稳定的**（Globally Asymptotically Stable, GAS），即从**任何**初始状态出发的轨迹都会收敛到它？

一个关键的附加条件是[李雅普诺夫函数](@entry_id:273986)必须是**径向无界的**（radially unbounded）。这意味着当状态范数 $\|\mathbf{x}\| \to \infty$ 时，$V(\mathbf{x}) \to \infty$。

**定理（[全局渐近稳定性](@entry_id:187629)）**: 如果存在一个正定、径向无界的李雅普诺夫函数 $V(\mathbf{x})$，其导数 $\dot{V}(\mathbf{x})$ 在整个[状态空间](@entry_id:177074)上是负定的，则[平衡点](@entry_id:272705) $\mathbf{x}=\mathbf{0}$ 是全局渐近稳定的。

径向无界性的直观意义是，函数 $V(\mathbf{x})$ 的[等位面](@entry_id:158674) $V(\mathbf{x})=c$ 都是有界的。这就像一个无限深的“能量碗”，无论初始状态离原点多远，它都处于某个有限能量的等位面内部。由于能量持续下降，轨迹无法逃逸到无穷远，最终只能落入碗底。

考虑这个例子 [@problem_id:2193220]：
$$ \begin{aligned} \dot{x}_1 = -\frac{1}{2}x_1(1+x_1^2)^2 \\ \dot{x}_2 = -\frac{1}{2}x_2 \end{aligned} $$
候选[李雅普诺夫函数](@entry_id:273986)为 $V(x_1, x_2) = \frac{x_1^2}{1+x_1^2} + x_2^2$。
-   **定性**：该函数是正定的。
-   **李雅普诺夫导数**：
    $$ \dot{V} = \frac{2x_1}{(1+x_1^2)^2}\dot{x}_1 + 2x_2\dot{x}_2 = \frac{2x_1}{(1+x_1^2)^2} \left(-\frac{1}{2}x_1(1+x_1^2)^2\right) + 2x_2\left(-\frac{1}{2}x_2\right) = -x_1^2 - x_2^2 $$
    $\dot{V}$ 在整个 $\mathbb{R}^2$ 上是负定的。这看起来是全局[渐近稳定](@entry_id:168077)的理想情况。

然而，我们必须检查 $V$ 的径向无界性。当 $x_2$ 固定（例如 $x_2=0$）而 $|x_1| \to \infty$ 时， $V(x_1, 0) = \frac{x_1^2}{1+x_1^2} \to 1$。函数值并没有趋于无穷。因此，$V$ 不是径向无界的。它的等位面 $V=c$ 当 $c \ge 1$ 时是无界的。
这意味着我们不能使用这个特定的李雅普诺夫函数来证明[全局渐近稳定性](@entry_id:187629)。我们只能得出原点是（局部）[渐近稳定](@entry_id:168077)的结论。这突显了一个重要事实：未能找到一个满足全局稳定性条件的李雅普诺夫函数，并不意味着系统本身不是全局稳定的，可能只是我们选择的函数不够巧妙。

总结而言，[李雅普诺夫直接法](@entry_id:168377)通过构造和分析一个抽象的“能量”函数，为我们提供了一套系统性的方法来分析[平衡点的稳定性](@entry_id:177203)，其威力在于它绕过了求解复杂的[非线性微分方程](@entry_id:175929)这一难题。