{"hands_on_practices": [{"introduction": "本练习探讨了生灭过程的一个基本应用，即对个人财富随时间变化的建模。通过设定恒定的“出生率”（财富获取）和与当前状态成正比的“死亡率”（财富支出），我们可以推导出系统在长期均衡下的状态分布。这个问题 [@problem_id:1333907] 旨在帮助你掌握求解稳态分布的核心方法，并理解为何泊松分布在此类场景中频繁出现。", "problem": "考虑一个零工经济工作者个人财富的简化模型。该工作者的财富以离散的货币单位来衡量。新单位随时间随机获得，其到达过程遵循泊松过程，平均速率恒为每小时 $\\lambda$ 个单位。该工作者也会花钱，我们将其建模为一个损失过程。在一个微小的时间间隔内，花掉一个货币单位的概率与该工作者当前拥有的单位数量 $n$ 成正比。具体来说，如果工作者拥有 $n$ 个单位，失去一个单位的瞬时速率由 $\\mu_n = n \\mu$ 给出，其中 $\\mu$ 是一个恒定的损失率参数，单位为小时的倒数。假设获得和失去金钱的过程是独立的。\n\n设 $N(t)$ 为工作者在时刻 $t$ 拥有的货币单位数量。经过很长一段时间后，该系统预计将达到一个统计平衡状态。工作者拥有恰好 $n$ 个货币单位的长期概率 $P(N=n)$ 是多少（其中 $n = 0, 1, 2, ...$）？请将你的答案表示为 $n$、$\\lambda$ 和 $\\mu$ 的函数。", "solution": "我们将 $N(t)$ 建模为非负整数集上的一个连续时间生灭过程，其中：\n- 出生（获得）以恒定速率 $\\lambda$ 发生，因此对于所有 $n \\geq 0$，转移 $n \\to n+1$ 的速率为 $\\lambda$。\n- 死亡（花费）以速率 $\\mu_{n} = n \\mu$ 发生，因此对于所有 $n \\geq 1$，转移 $n \\to n-1$ 的速率为 $n \\mu$。\n\n在统计平衡状态下，设 $\\pi_{n} = P(N=n)$ 表示处于状态 $n$ 的平稳概率。对于处于平衡状态的生灭过程，相邻状态之间的局部（细致）平衡方程成立：\n$$\n\\pi_{n} \\cdot \\lambda = \\pi_{n+1} \\cdot \\mu (n+1), \\quad \\text{for all } n \\geq 0.\n$$\n解此递推关系可得\n$$\n\\pi_{n+1} = \\frac{\\lambda}{\\mu (n+1)} \\pi_{n} \\quad \\Longrightarrow \\quad \\pi_{n} = \\pi_{0} \\prod_{k=0}^{n-1} \\frac{\\lambda}{\\mu (k+1)} = \\pi_{0} \\frac{(\\lambda/\\mu)^{n}}{n!}, \\quad \\text{for } n \\geq 1,\n$$\n其中 $\\pi_{0}$ 待由归一化条件确定。应用 $\\sum_{n=0}^{\\infty} \\pi_{n} = 1$ 可得\n$$\n\\sum_{n=0}^{\\infty} \\pi_{n} = \\pi_{0} \\sum_{n=0}^{\\infty} \\frac{(\\lambda/\\mu)^{n}}{n!} = \\pi_{0} \\exp\\left(\\frac{\\lambda}{\\mu}\\right) = 1,\n$$\n因此\n$$\n\\pi_{0} = \\exp\\left(-\\frac{\\lambda}{\\mu}\\right).\n$$\n所以，\n$$\nP(N=n) = \\pi_{n} = \\exp\\left(-\\frac{\\lambda}{\\mu}\\right) \\frac{\\left(\\frac{\\lambda}{\\mu}\\right)^{n}}{n!}, \\quad n = 0,1,2,\\ldots,\n$$\n这是一个均值为 $\\lambda/\\mu$ 的泊松分布。", "answer": "$$\\boxed{\\exp\\left(-\\frac{\\lambda}{\\mu}\\right)\\,\\frac{\\left(\\frac{\\lambda}{\\mu}\\right)^{n}}{n!}}$$", "id": "1333907"}, {"introduction": "现实世界中的许多系统表现出比简单线性模型更复杂的状态依赖行为。本练习 [@problem_id:1333904] 提出了一个具有交替到达率的排队模型，挑战你将细致平衡方程应用于非标准情况的能力。解决这个问题将加深你对生灭过程基本原理的理解，并展示其在分析复杂动态系统时的灵活性。", "problem": "考虑一个用于专业数据处理中心的单服务台排队系统模型。新的处理任务根据泊松过程到达，但到达率取决于系统中已有的任务数量 $n$。具体来说，当任务数量 $n$ 为偶数（包括零）时，到达率为 $\\lambda_n = a$。当任务数量 $n$ 为奇数时，到达率为 $\\lambda_n = b$。每个任务的服务时间服从指数分布，导致当 $n \\ge 1$ 时服务率为常数 $\\mu_n = \\mu$。这意味着只要系统不为空，任务就以速率 $\\mu$ 被处理并离开系统。\n\n假设系统达到稳态，并且满足稳定性条件，从而确保存在一个平稳分布。你的任务是求出系统为空的概率，记为 $P_0$。请用参数 $a$、$b$ 和 $\\mu$ 将你的答案表示为一个封闭形式的解析表达式。", "solution": "将该系统建模为生灭过程，其出生率为 $\\lambda_{n}$，死亡率为 $\\mu_{n}$。在稳态下，对所有 $n \\ge 0$ 局部平衡成立：\n$$\n\\pi_{n} \\lambda_{n} = \\pi_{n+1} \\mu_{n+1},\n$$\n其中 $\\pi_{n} = P\\{N=n\\}$ 并且当 $n \\ge 1$ 时 $\\mu_{n}=\\mu$。因此，对于 $n \\ge 0$，\n$$\n\\pi_{n+1} = \\pi_{n} \\frac{\\lambda_{n}}{\\mu}.\n$$\n令 $P_{0}=\\pi_{0}$。使用交替的出生率，即当 $n$ 为偶数时 $\\lambda_{n}=a$，当 $n$ 为奇数时 $\\lambda_{n}=b$，迭代递推关系可得\n$$\n\\pi_{1} = P_{0} \\frac{a}{\\mu}, \\quad\n\\pi_{2} = P_{0} \\frac{ab}{\\mu^{2}}, \\quad\n\\pi_{3} = P_{0} \\frac{a^{2} b}{\\mu^{3}}, \\quad\n\\pi_{4} = P_{0} \\frac{a^{2} b^{2}}{\\mu^{4}}, \\ \\ldots\n$$\n定义 $r = \\frac{ab}{\\mu^{2}}$。那么对于 $m \\ge 0$，\n$$\n\\pi_{2m} = P_{0} r^{m}, \n\\qquad\n\\pi_{2m+1} = P_{0} \\frac{a}{\\mu} r^{m}.\n$$\n归一化条件 $\\sum_{n=0}^{\\infty} \\pi_{n} = 1$ 给出\n$$\n1 = \\sum_{m=0}^{\\infty} \\pi_{2m} + \\sum_{m=0}^{\\infty} \\pi_{2m+1}\n= P_{0} \\sum_{m=0}^{\\infty} r^{m} + P_{0} \\frac{a}{\\mu} \\sum_{m=0}^{\\infty} r^{m}\n= P_{0} \\left(1 + \\frac{a}{\\mu}\\right) \\sum_{m=0}^{\\infty} r^{m}.\n$$\n在稳定性条件 $ab  \\mu^{2}$ 下，该几何级数求和为\n$$\n\\sum_{m=0}^{\\infty} r^{m} = \\frac{1}{1 - r}.\n$$\n因此，\n$$\nP_{0} = \\frac{1 - r}{1 + \\frac{a}{\\mu}} = \\frac{1 - \\frac{ab}{\\mu^{2}}}{1 + \\frac{a}{\\mu}} = \\frac{\\mu^{2} - ab}{\\mu^{2} + a \\mu}.\n$$", "answer": "$$\\boxed{\\frac{\\mu^{2} - ab}{\\mu^{2} + a \\mu}}$$", "id": "1333904"}, {"introduction": "这个练习 [@problem_id:1333917] 将生灭过程理论应用于化学反应动力学，这是一个展示其强大建模能力的进阶案例。问题中的非线性“死亡率”精确地反映了双分子反应的机制，这会导致一个更复杂的稳态分布。通过解决这个问题，你将体会到如何处理非典型速率，并接触到在物理科学建模中出现的更高级的数学结构。", "problem": "考虑一个在充分混合溶液中化学反应的简化模型。一种我们称之为 $X$ 的分子以恒定速率 $\\alpha  0$ 合成。同时，$X$ 分子通过一种需要一对分子相互作用的反应被消耗。单个 $X$ 分子被消耗的事件发生的速率与可用的 $X$ 分子对的数量成正比。\n\n设 $N(t)$ 为时刻 $t$ 时 $X$ 分子的数量。我们将此系统建模为非负整数集 $\\{0, 1, 2, ...\\}$ 上的一个连续时间马尔可夫链。对应于新分子生成（从状态 $n$ 转移到 $n+1$）的生长率由 $\\lambda_n = \\alpha$ 给出（对所有 $n \\ge 0$）。对应于单个分子消耗（从状态 $n$ 转移到 $n-1$）的消亡率由 $\\mu_n = \\beta n(n-1)$ 给出（对所有 $n \\ge 0$），其中 $\\beta  0$ 是一个速率常数。注意，此定义意味着 $\\mu_0 = 0$ 和 $\\mu_1 = 0$。\n\n假设当 $t \\to \\infty$ 时，系统达到一个平稳（或稳态）分布。计算稳态下系统中分子的期望数量 $E[N]$。用比率 $\\rho = \\alpha/\\beta$ 和第一类修正贝塞尔函数 $I_0(z)$ 与 $I_1(z)$ 来表示你的答案。", "solution": "该问题描述了一个生灭过程，其中状态 $n$ 代表分子数量。生长率为 $\\lambda_n = \\alpha$（对 $n \\ge 0$），消亡率为 $\\mu_n = \\beta n(n-1)$（对 $n \\ge 0$）。\n\n首先，我们分析平稳状态下该过程的状态空间。从状态 $n=1$ 的消亡率为 $\\mu_1 = \\beta(1)(1-1) = 0$。这意味着如果系统处于状态 1，它不能转移到状态 0。可能发生一次生长，使系统转移到状态 2，从此状态开始消亡是可能的（$\\mu_2 = 2\\beta  0$）。因此，一旦过程达到任何状态 $n \\ge 1$，它就永远无法返回到状态 0。因此，状态 0 是一个瞬态，平稳分布将集中在正整数集 $S = \\{1, 2, 3, ...\\}$ 上。设 $\\pi_n$ 为具有 $n$ 个分子的平稳概率，其中 $n \\in S$。\n\n通过求解细致平衡方程可以找到平稳分布：\n$$ \\pi_n \\lambda_n = \\pi_{n+1} \\mu_{n+1} \\quad \\text{for } n \\ge 1 $$\n代入给定的速率：\n$$ \\pi_n \\alpha = \\pi_{n+1} \\beta(n+1)(n+1-1) = \\pi_{n+1} \\beta n(n+1) \\quad \\text{for } n \\ge 1 $$\n我们可以用 $\\pi_n$ 表示 $\\pi_{n+1}$：\n$$ \\pi_{n+1} = \\pi_n \\frac{\\alpha}{\\beta n(n+1)} $$\n我们可以解这个递推关系，用 $\\pi_1$ 表示所有的 $\\pi_n$。\n对于 $n=2$：\n$$ \\pi_2 = \\pi_1 \\frac{\\alpha}{\\beta \\cdot 1 \\cdot 2} = \\pi_1 \\frac{\\rho}{2 \\cdot 1} $$\n其中我们定义了 $\\rho = \\alpha/\\beta$。\n对于 $n=3$：\n$$ \\pi_3 = \\pi_2 \\frac{\\alpha}{\\beta \\cdot 2 \\cdot 3} = \\left(\\pi_1 \\frac{\\rho}{2 \\cdot 1}\\right) \\frac{\\rho}{3 \\cdot 2} = \\pi_1 \\frac{\\rho^2}{(3 \\cdot 2 \\cdot 1)(2 \\cdot 1)} = \\pi_1 \\frac{\\rho^2}{3! 2!} $$\n通过归纳法，对于 $n \\ge 2$，通式为：\n$$ \\pi_n = \\pi_1 \\prod_{k=1}^{n-1} \\frac{\\alpha}{\\beta k(k+1)} = \\pi_1 \\frac{\\rho^{n-1}}{\\prod_{k=1}^{n-1} k(k+1)} = \\pi_1 \\frac{\\rho^{n-1}}{(n-1)! n!} $$\n这个公式对 $n \\ge 2$ 有效。对于 $n=1$，我们只有 $\\pi_1$。\n\n为了求 $\\pi_1$，我们使用归一化条件 $\\sum_{n=1}^{\\infty} \\pi_n = 1$：\n$$ 1 = \\pi_1 + \\sum_{n=2}^{\\infty} \\pi_n = \\pi_1 + \\sum_{n=2}^{\\infty} \\pi_1 \\frac{\\rho^{n-1}}{n!(n-1)!} = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{n!(n-1)!}\\right) $$\n我们来分析这个和。令 $j = n-1$。该和变为 $\\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j+1)!j!}$。\n$\\nu$ 阶第一类修正贝塞尔函数的定义为 $I_\\nu(z) = \\sum_{k=0}^{\\infty} \\frac{1}{k! \\Gamma(k+\\nu+1)} (\\frac{z}{2})^{2k+\\nu}$。\n对于 $\\nu=1$，我们有 $I_1(z) = \\sum_{k=0}^{\\infty} \\frac{1}{k! (k+1)!} (\\frac{z}{2})^{2k+1}$。\n令 $z=2\\sqrt{\\rho}$。则 $z/2 = \\sqrt{\\rho}$，我们有\n$I_1(2\\sqrt{\\rho}) = \\sum_{k=0}^{\\infty} \\frac{1}{k!(k+1)!} (\\sqrt{\\rho})^{2k+1} = \\sqrt{\\rho} \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{k!(k+1)!}$。\n两边除以 $\\sqrt{\\rho}$ 得到：\n$$ \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} = \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{k!(k+1)!} = \\frac{\\rho^0}{0!1!} + \\sum_{k=1}^{\\infty} \\frac{\\rho^k}{k!(k+1)!} = 1 + \\sum_{j=1}^{\\infty} \\frac{\\rho^j}{j!(j+1)!} $$\n我们归一化方程中的和恰好是这个级数，所以 $\\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{n!(n-1)!} = \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} - 1$。\n将此代回归一化方程：\n$$ 1 = \\pi_1 \\left(1 + \\left(\\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} - 1\\right)\\right) = \\pi_1 \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} $$\n求解 $\\pi_1$：\n$$ \\pi_1 = \\frac{\\sqrt{\\rho}}{I_1(2\\sqrt{\\rho})} $$\n现在我们可以计算分子的期望数量 $E[N]$：\n$$ E[N] = \\sum_{n=1}^{\\infty} n \\pi_n = 1 \\cdot \\pi_1 + \\sum_{n=2}^{\\infty} n \\pi_n = \\pi_1 + \\sum_{n=2}^{\\infty} n \\left(\\pi_1 \\frac{\\rho^{n-1}}{n!(n-1)!}\\right) $$\n$$ E[N] = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{n \\rho^{n-1}}{n!(n-1)!}\\right) = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{(n-1)!(n-1)!}\\right) $$\n我们来分析第二个和。令 $j = n-1$。该和变为 $\\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j!)^2}$。\n0 阶第一类修正贝塞尔函数为 $I_0(z) = \\sum_{k=0}^{\\infty} \\frac{1}{(k!)^2} (\\frac{z}{2})^{2k}$。\n令 $z=2\\sqrt{\\rho}$。则我们有：\n$$ I_0(2\\sqrt{\\rho}) = \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{(k!)^2} = \\frac{\\rho^0}{(0!)^2} + \\sum_{k=1}^{\\infty} \\frac{\\rho^k}{(k!)^2} = 1 + \\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j!)^2} $$\n所以 $E[N]$ 表达式中的和是 $I_0(2\\sqrt{\\rho}) - 1$。\n将此代入 $E[N]$ 的表达式中：\n$$ E[N] = \\pi_1 \\left(1 + (I_0(2\\sqrt{\\rho}) - 1)\\right) = \\pi_1 I_0(2\\sqrt{\\rho}) $$\n最后，我们代入我们找到的 $\\pi_1$ 的表达式：\n$$ E[N] = \\frac{\\sqrt{\\rho}}{I_1(2\\sqrt{\\rho})} I_0(2\\sqrt{\\rho}) = \\sqrt{\\rho} \\frac{I_0(2\\sqrt{\\rho})}{I_1(2\\sqrt{\\rho})} $$\n这就是稳态下分子期望数量的最终表达式。", "answer": "$$\\boxed{\\sqrt{\\rho} \\frac{I_0(2\\sqrt{\\rho})}{I_1(2\\sqrt{\\rho})}}$$", "id": "1333917"}]}