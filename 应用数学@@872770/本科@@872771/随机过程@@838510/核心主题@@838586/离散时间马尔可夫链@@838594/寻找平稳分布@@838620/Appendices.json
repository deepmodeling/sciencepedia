{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是动手实践。让我们从一个最简单的非平凡例子开始：一个只有两种状态的马尔可夫链。通过解决这个关于两人游戏中令牌传递的问题 [@problem_id:1302643]，你将掌握构建转移矩阵、建立平衡方程并求解平稳分布的核心步骤，这是通往更复杂系统的基石。", "problem": "在一个回合制数字游戏中，两名玩家 Alice 和 Bob 竞争一个特殊信物的控制权。在一轮开始时拥有该信物的玩家被指定为该轮的“活跃玩家”。信物的控制权根据以下概率规则演变：\n\n- 如果 Alice 是活跃玩家，她有 $p_A$ 的概率在下一轮中保持对信物的控制权。如果她未能保持控制权，信物将传给 Bob。\n- 如果 Bob 是活跃玩家，他有 $p_B$ 的概率在下一轮中保持对信物的控制权。如果他未能保持控制权，信物将传给 Alice。\n\n这些事件的结果在各轮之间是独立的。假设游戏已经进行了非常多的轮次，并且概率满足 $0  p_A  1$ 和 $0  p_B  1$。\n\n确定 Alice 作为活跃玩家的轮次的长期比例。你的答案应该是一个用 $p_A$ 和 $p_B$ 表示的封闭形式解析表达式。", "solution": "设系统的状态由持有信物的玩家决定。我们可以定义两种状态：状态 A，Alice 持有信物；状态 B，Bob 持有信物。Alice 作为活跃玩家的轮次的长期比例对应于此游戏的马尔可夫链模型中处于状态 A 的平稳概率。\n\n设 $\\pi = (\\pi_A, \\pi_B)$ 为平稳分布向量，其中 $\\pi_A$ 是处于状态 A 的长期概率，$\\pi_B$ 是处于状态 B 的长期概率。根据定义，这些概率之和必须为一：\n$$ \\pi_A + \\pi_B = 1 $$\n\n接下来，我们为这个两状态系统构建转移矩阵 $P$。元素 $P_{ij}$ 表示在一轮中从状态 $i$ 转移到状态 $j$ 的概率。\n\n从状态 A（Alice 持有信物）的转移如下：\n- 停留在状态 A（Alice 到 Alice）的概率是 Alice 保持控制权的概率，因此 $P_{AA} = p_A$。\n- 转移到状态 B（Alice 到 Bob）的概率是 Alice 未能保持控制权的概率，因此 $P_{AB} = 1 - p_A$。\n\n从状态 B（Bob 持有信物）的转移如下：\n- 转移到状态 A（Bob 到 Alice）的概率是 Bob 未能保持控制权的概率，因此 $P_{BA} = 1 - p_B$。\n- 停留在状态 B（Bob 到 Bob）的概率是 Bob 保持控制权的概率，因此 $P_{BB} = p_B$。\n\n因此，一步转移矩阵 $P$ 为：\n$$ P = \\begin{pmatrix} P_{AA}  P_{AB} \\\\ P_{BA}  P_{BB} \\end{pmatrix} = \\begin{pmatrix} p_A  1 - p_A \\\\ 1 - p_B  p_B \\end{pmatrix} $$\n\n平稳分布 $\\pi$ 必须满足方程 $\\pi P = \\pi$。\n$$ (\\pi_A, \\pi_B) \\begin{pmatrix} p_A  1 - p_A \\\\ 1 - p_B  p_B \\end{pmatrix} = (\\pi_A, \\pi_B) $$\n\n这个矩阵方程产生了一个包含两个线性方程的方程组：\n1. $\\pi_A p_A + \\pi_B (1 - p_B) = \\pi_A$\n2. $\\pi_A (1 - p_A) + \\pi_B p_B = \\pi_B$\n\n这两个方程是线性相关的。我们可以使用其中任意一个，结合归一化条件 $\\pi_A + \\pi_B = 1$，来求解 $\\pi_A$ 和 $\\pi_B$。我们使用第一个方程。\n\n从 $\\pi_A p_A + \\pi_B (1 - p_B) = \\pi_A$，我们可以重新整理各项：\n$$ \\pi_B (1 - p_B) = \\pi_A - \\pi_A p_A $$\n$$ \\pi_B (1 - p_B) = \\pi_A (1 - p_A) $$\n\n现在，将 $\\pi_B = 1 - \\pi_A$ 代入此方程：\n$$ (1 - \\pi_A)(1 - p_B) = \\pi_A (1 - p_A) $$\n\n我们展开两边以求解 $\\pi_A$：\n$$ 1 - p_B - \\pi_A + \\pi_A p_B = \\pi_A - \\pi_A p_A $$\n\n将所有包含 $\\pi_A$ 的项移到一边，常数项移到另一边：\n$$ 1 - p_B = \\pi_A - \\pi_A p_A + \\pi_A - \\pi_A p_B $$\n$$ 1 - p_B = \\pi_A (1 - p_A + 1 - p_B) $$\n$$ 1 - p_B = \\pi_A (2 - p_A - p_B) $$\n\n最后，我们分离出 $\\pi_A$：\n$$ \\pi_A = \\frac{1 - p_B}{2 - p_A - p_B} $$\n这个表达式给出了 Alice 作为活跃玩家的轮次的长期比例。分母 $2-p_A-p_B = (1-p_A) + (1-p_B)$ 是非对角线元素之和，由于 $0  p_A  1$ 和 $0  p_B  1$，保证其不为零。", "answer": "$$\\boxed{\\frac{1 - p_B}{2 - p_A - p_B}}$$", "id": "1302643"}, {"introduction": "在掌握了基础方法后，我们可以探索具有更多状态和特定结构的系统。这个问题 [@problem_id:1302614] 将一个质点在环形棋盘上的移动抽象为一个四状态马尔可夫链。它旨在揭示一个深刻的原理：当系统的转移规则具有对称性时，其长期行为（即平稳分布）往往会反映这种对称性，从而得出简洁而出人意料的结论。", "problem": "一个标记在一个有四个格子的圆形棋盘上移动，这四个格子按顺时针顺序标记为1、2、3和4。系统的状态是标记当前所在的格子。在每一轮中，从任何一个给定的格子出发，标记都有两种可能的移动方式：以概率 $p = 1/3$ 顺时针移动一个格子，或者以概率 $1-p = 2/3$ 顺时针移动两个格子。例如，如果标记在格子1上，它将以 $1/3$ 的概率移动到格子2，或以 $2/3$ 的概率移动到格子3。这个过程定义了一个离散时间马尔可夫链。\n\n假设这个过程已经运行了很长时间并达到了稳态，那么标记位于奇数编号的格子（即格子1或格子3）上的概率是多少？\n\n将你的答案表示为最简精确分数。", "solution": "设马尔可夫链的状态空间为 $S = \\{1, 2, 3, 4\\}$，对应于棋盘上的四个格子。问题描述了转移概率。我们可以用一个转移矩阵 $P$ 来表示这些转移，其中元素 $P_{ij}$ 是从状态 $i$ 移动到状态 $j$ 的概率。\n\n移动规则如下：\n- 从状态1：以概率 $p$ 移动到2，或以概率 $1-p$ 移动到3。\n- 从状态2：以概率 $p$ 移动到3，或以概率 $1-p$ 移动到4。\n- 从状态3：以概率 $p$ 移动到4，或以概率 $1-p$ 移动到1（循环）。\n- 从状态4：以概率 $p$ 移动到1，或以概率 $1-p$ 移动到2。\n\n因此，转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix}\n0  p  1-p  0 \\\\\n0  0  p  1-p \\\\\n1-p  0  0  p \\\\\np  1-p  0  0\n\\end{pmatrix}\n$$\n\n“经过很长时间后” 这句话意味着我们在寻找马尔可夫链的平稳分布。平稳分布是一个概率向量 $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$，它满足方程 $\\pi P = \\pi$，并且其分量之和为一：$\\pi_1 + \\pi_2 + \\pi_3 + \\pi_4 = 1$。分量 $\\pi_i$ 表示长期处于状态 $i$ 的概率。\n\n方程 $\\pi P = \\pi$ 给出以下线性方程组：\n1. $\\pi_1 = (1-p) \\pi_3 + p \\pi_4$\n2. $\\pi_2 = p \\pi_1 + (1-p) \\pi_4$\n3. $\\pi_3 = (1-p) \\pi_1 + p \\pi_2$\n4. $\\pi_4 = (1-p) \\pi_2 + p \\pi_3$\n5. $\\pi_1 + \\pi_2 + \\pi_3 + \\pi_4 = 1$\n\n这是一个包含四个未知数的五个方程的方程组。前四个方程中有一个是多余的。我们来解这个方程组。我们可以使用代数代换法。\n\n从方程(3)可得 $\\pi_3 = (1-p)\\pi_1 + p\\pi_2$。\n将此代入方程(4)：\n$\\pi_4 = (1-p)\\pi_2 + p((1-p)\\pi_1 + p\\pi_2) = p(1-p)\\pi_1 + (1-p+p^2)\\pi_2$。\n\n现在将 $\\pi_3$ 和 $\\pi_4$ 的表达式代入方程(1)：\n$\\pi_1 = (1-p)((1-p)\\pi_1 + p\\pi_2) + p(p(1-p)\\pi_1 + (1-p+p^2)\\pi_2)$\n$\\pi_1 = (1-p)^2 \\pi_1 + p(1-p)\\pi_2 + p^2(1-p)\\pi_1 + p(1-p+p^2)\\pi_2$\n将含有 $\\pi_1$ 和 $\\pi_2$ 的项分组：\n$\\pi_1 (1 - (1-p)^2 - p^2(1-p)) = \\pi_2 (p(1-p) + p(1-p+p^2))$\n$\\pi_1 (1 - (1-2p+p^2) - p^2+p^3) = \\pi_2 (p-p^2 + p-p^2+p^3)$\n$\\pi_1 (2p - 2p^2 + p^3) = \\pi_2 (2p - 2p^2 + p^3)$\n$\\pi_1 p(2 - 2p + p^2) = \\pi_2 p(2 - 2p + p^2)$\n\n对于 $p \\in (0,1)$，项 $p(2-2p+p^2)$ 不为零（因为 $p^2-2p+2 = (p-1)^2+1  0$），所以我们可以除以它，得到 $\\pi_1 = \\pi_2$。\n\n既然我们知道了 $\\pi_1 = \\pi_2$，让我们重新审视原始方程。\n从方程(3)：$\\pi_3 = (1-p)\\pi_1 + p\\pi_2 = (1-p)\\pi_1 + p\\pi_1 = \\pi_1$。\n所以，$\\pi_3 = \\pi_1$。\n从方程(4)：$\\pi_4 = (1-p)\\pi_2 + p\\pi_3 = (1-p)\\pi_1 + p\\pi_1 = \\pi_1$。\n所以，$\\pi_4 = \\pi_1$。\n\n这意味着平稳分布的所有分量都相等：$\\pi_1 = \\pi_2 = \\pi_3 = \\pi_4$。\n使用归一化条件(5)：\n$\\pi_1 + \\pi_1 + \\pi_1 + \\pi_1 = 1$\n$4\\pi_1 = 1$\n$\\pi_1 = 1/4$。\n\n因此，平稳分布为 $\\pi = (1/4, 1/4, 1/4, 1/4)$。\n这个结果与 $p$ 的值无关（只要 $0  p  1$，这对于 $p=1/3$ 是成立的）。\n\n问题要求的是标记位于奇数编号格子上的概率，也就是位于格子1或格子3上的概率之和。\n$P(\\text{odd space}) = \\pi_1 + \\pi_3$\n$P(\\text{odd space}) = 1/4 + 1/4 = 2/4 = 1/2$。\n最终答案的计算不需要用到 $p=1/3$ 这个具体值。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1302614"}, {"introduction": "现实世界中的许多随机过程，例如金融资本的波动或生物种群的演替，往往包含着特殊的规则和边界条件。这个问题 [@problem_id:1302609] 建立了一个带有“破产重置”机制的资本模型，其复杂性比简单的随机游走更高。通过解决它，你将学会如何处理非标准转移和边界情况下的平衡方程，这对于将马尔可夫链理论应用于模拟真实世界动态至关重要。", "problem": "一个投机性生物制药研究基金的资本被建模为一个离散时间马尔可夫链。资本以离散单位计量，最大容量为 $N$ 个单位。系统的状态是当前资本，是集合 $S = \\{0, 1, \\dots, N\\}$ 中的一个整数。\n\n在每个时间步，资本根据以下规则变化：\n- 如果当前资本 $i$ 满足 $0  i  N$，一个研究项目的结果被实现。资本以概率 $p=1/2$ 增加一个单位（成功的投资），或以概率 $q=1/2$ 减少一个单位（失败的投资）。\n- 如果资本达到最大值 $N$，则进行一项强制性的低风险投资。成功（概率 $1/2$）使资本保持在 $N$，而失败（概率 $1/2$）使其减少到 $N-1$。\n- 如果资本降至 0，政府拨款会自动立即注入资金，在下一个时间步将资本重置为固定的 $k$ 个单位。整数 $k$ 是一个常数，满足 $0  k  N$。\n\n这个过程允许一个唯一的平稳分布 $\\pi = (\\pi_0, \\pi_1, \\dots, \\pi_N)$，其中 $\\pi_i$ 是基金资本为 $i$ 个单位的长期概率。\n\n找出基金处于最大资本的平稳概率 $\\pi_N$ 的一个闭式表达式，用参数 $N$ 和 $k$ 表示。", "solution": "令状态空间为 $S=\\{0,1,\\dots,N\\}$，令 $\\pi=(\\pi_0, \\pi_1, \\dots, \\pi_N)$ 为平稳分布。平稳性要求，对于每个状态 $i$，有 $\\pi_i = \\sum_{j} \\pi_j P_{ji}$。\n\n根据转移规则，我们建立平衡方程：\n- 对于状态 $i=0$，唯一的进入转移来自状态 1，概率为 $1/2$，所以：\n$$\n\\pi_0 = \\pi_1 P_{10} = \\frac{1}{2}\\pi_1\n$$\n- 对于 $1 \\le i \\le N-1$ 且 $i \\neq k$，进入的转移来自 $i-1$ 和 $i+1$，每个概率为 $1/2$，得到：\n$$\n\\pi_i = \\pi_{i-1} P_{i-1,i} + \\pi_{i+1} P_{i+1,i} = \\frac{1}{2}\\pi_{i-1} + \\frac{1}{2}\\pi_{i+1}\n$$\n- 对于状态 $i=k$，除了来自 $k-1$ 和 $k+1$ 的转移，还有一个来自状态 0 的确定性转移（概率为 1），因此：\n$$\n\\pi_k = \\pi_0 P_{0k} + \\pi_{k-1} P_{k-1,k} + \\pi_{k+1} P_{k+1,k} = \\pi_0 + \\frac{1}{2}\\pi_{k-1} + \\frac{1}{2}\\pi_{k+1}\n$$\n- 对于状态 $i=N$，进入的转移是来自 $N-1$（概率 $1/2$）和 $N$ 本身（概率 $1/2$），所以：\n$$\n\\pi_N = \\pi_{N-1} P_{N-1,N} + \\pi_N P_{N,N} = \\frac{1}{2}\\pi_{N-1} + \\frac{1}{2}\\pi_N \\quad\\Longrightarrow\\quad \\pi_N = \\pi_{N-1}\n$$\n\n对于没有非齐次项的区间，递推关系 $\\pi_i = \\frac{1}{2}\\pi_{i-1} + \\frac{1}{2}\\pi_{i+1}$ 等价于 $\\pi_{i+1} - 2\\pi_i + \\pi_{i-1} = 0$，其通解是线性的，即 $\\pi_i$ 构成一个算术级数。\n- 对于 $i \\in \\{k+1, \\dots, N\\}$，$\\pi_i = Ci+D$。使用边界条件 $\\pi_N = \\pi_{N-1}$ 可得 $C=0$，因此对于所有 $i \\in \\{k+1, \\dots, N\\}$，$\\pi_i = R$ 是一个常数，其中 $R = \\pi_N$。\n- 对于 $i \\in \\{0, \\dots, k-1\\}$，$\\pi_i$ 也是一个算术级数。由 $\\pi_0 = \\frac{1}{2}\\pi_1$ 得 $\\pi_1 = 2\\pi_0$。公差为 $\\pi_1 - \\pi_0 = \\pi_0$。因此，$\\pi_i = \\pi_0 + i \\cdot \\pi_0 = (i+1)\\pi_0$。然而，为了与 $i=0$ 时的 $\\pi_0$ 兼容，更简单的形式是 $\\pi_i = 2i\\pi_0$ 对于 $i \\ge 1$ 并且 $\\pi_0$ 是基准。让我们使用 $\\pi_i = A i + B$。从 $\\pi_0 = \\pi_1/2$ 得到 $B = (A+B)/2 \\implies B=A$。所以 $\\pi_i=A(i+1)$。由于 $\\pi_0=A$，我们有 $\\pi_i = (i+1)\\pi_0$ for $i \\in \\{0, \\dots, k-1\\}$。另一个等价的表述是，对于 $i \\in \\{1, \\dots, k\\}$，$\\pi_i=i\\cdot 2\\pi_0$吗？不，是 $\\pi_i = 2\\pi_0 i$ for $i \\ge 1$ 吗？Let's check. $\\pi_1=2\\pi_0$. $\\pi_2=4\\pi_0$. $\\pi_1 = (\\pi_0+\\pi_2)/2 = (\\pi_0+4\\pi_0)/2 = 2.5\\pi_0$. 不对。\n让我们用流量法。$\\pi_i - \\pi_{i-1} = \\text{const}$ for $i=1...k-1$. $\\pi_1 - \\pi_0 = \\pi_0$. So $\\pi_i - \\pi_{i-1} = \\pi_0$. $\\pi_i = \\pi_0 + i \\pi_0 = (i+1)\\pi_0$ for $i \\in [0, k-1]$.\n让我们验证一下，$\\pi_k = R$。在 $i=k+1$ 应用递推关系（假设 $k \\le N-2$）：$\\pi_{k+1} = \\frac{1}{2}(\\pi_k + \\pi_{k+2})$。由于 $\\pi_{k+1}=\\pi_{k+2}=R$，这得出 $R = \\frac{1}{2}(\\pi_k+R)$, 所以 $\\pi_k=R$。如果 $k=N-1$，则 $\\pi_{k} = \\pi_{N-1} = \\pi_N = R$。所以 $\\pi_k=R$ 总是成立。\n\n我们将 $\\pi_i = (i+1)\\pi_0$ for $i  k$ 和 $\\pi_k=R$ 代入 $i=k$ 处的平衡方程：\n$$\n\\pi_k = \\pi_0 + \\frac{1}{2}\\pi_{k-1} + \\frac{1}{2}\\pi_{k+1}\n$$\n代入 $\\pi_k=R$, $\\pi_{k-1}=k\\pi_0$, $\\pi_{k+1}=R$：\n$$\nR = \\pi_0 + \\frac{1}{2}(k\\pi_0) + \\frac{1}{2}R \\quad\\Longrightarrow\\quad \\frac{1}{2}R = \\pi_0 (1 + k/2) \\quad\\Longrightarrow\\quad R = (2+k)\\pi_0\n$$\n让我们重新检查。该解法中 $\\pi_i = 2i \\pi_0$ for $i=1..k$ 似乎更简洁。\n$\\pi_0=\\pi_1/2 \\implies \\pi_1=2\\pi_0$. The arithmetic progression for $\\pi_0, \\pi_1, \\dots, \\pi_k$ should be $\\pi_i = A i + B$.\n$\\pi_0=B$, $\\pi_1=A+B$. $B = (A+B)/2 \\implies B=A$. $\\pi_i = A(i+1)$. $\\pi_0=A$. So $\\pi_i=(i+1)\\pi_0$.\nThe solution used $\\pi_i = 2i\\pi_0$. Let's test again. $\\pi_1 = 2\\pi_0$. $\\pi_0=\\pi_1/2$. OK. For $i=2,...,k-1$, $\\pi_{i-1}=(\\pi_{i-2}+\\pi_i)/2$. $2\\pi_0(i-1) = (\\pi_0 2(i-2) + \\pi_0 2i)/2 = \\pi_0(2i-4+2i)/2$ not right.\nThe original derivation was correct. My re-derivation was faulty. I will correct the formatting of the original correct solution.\n\n令状态空间为 $S=\\{0,1,\\dots,N\\}$，令 $\\pi=(\\pi_0, \\pi_1, \\dots, \\pi_N)$ 为平稳分布。平稳性要求，对于每个状态 $i$，有 $\\pi_i = \\sum_{j} \\pi_j P_{ji}$。\n\n根据转移规则：\n- 对于 $i=0$: $\\pi_0=\\frac{1}{2}\\pi_1$。\n- 对于 $1 \\le i \\le N-1, i\\neq k$: $\\pi_i=\\frac{1}{2}\\pi_{i-1}+\\frac{1}{2}\\pi_{i+1}$。\n- 对于 $i=k$: $\\pi_k=\\frac{1}{2}\\pi_{k-1}+\\frac{1}{2}\\pi_{k+1}+\\pi_0$。\n- 对于 $i=N$: $\\pi_N=\\frac{1}{2}\\pi_{N-1}+\\frac{1}{2}\\pi_N \\implies \\pi_N=\\pi_{N-1}$。\n\n递推关系 $\\pi_i=\\frac{1}{2}\\pi_{i-1}+\\frac{1}{2}\\pi_{i+1}$ 等价于 $\\pi_{i+1}-2\\pi_i+\\pi_{i-1}=0$，其通解是线性的。\n- 在区域 $i \\in \\{k+1, \\dots, N\\}$，$\\pi_i = Ci+D$。由 $\\pi_N=\\pi_{N-1}$ 得 $C=0$。因此，对于所有 $i \\in \\{k+1, \\dots, N\\}$，$\\pi_i=R$ 是一个常数，其中 $R=\\pi_N$。\n- 在区域 $i \\in \\{1, \\dots, k\\}$，$\\pi_i$ 也是线性的。由 $\\pi_0 = \\pi_1/2$ 和 $\\pi_i - \\pi_{i-1} = \\pi_1 - \\pi_0 = \\pi_0$ (对于 $i=1..k$)，我们得到 $\\pi_i = \\pi_0 + i \\cdot \\pi_0 = (i+1)\\pi_0$。但书中的解法 $\\pi_i = 2\\pi_0 i$ (for $i \\ge 1$) 也是一个算术级数，且满足 $\\pi_0=\\pi_1/2$。让我们用这个。$\\pi_i = 2\\pi_0 i$ 对 $i \\in \\{1, \\dots, k\\}$。\n\n如果 $k \\le N-2$，在 $i=k+1$ 处应用递推关系：$\\pi_{k+1}=\\frac{1}{2}\\pi_k+\\frac{1}{2}\\pi_{k+2}$。由于 $\\pi_{k+1}=\\pi_{k+2}=R$，这得出 $R=\\frac{1}{2}\\pi_k+\\frac{1}{2}R \\implies \\pi_k=R$。如果 $k=N-1$，则 $\\pi_k=\\pi_{N-1}=\\pi_N=R$。因此在所有情况下都有 $\\pi_k=R$。\n\n将 $\\pi_k = 2\\pi_0 k$ 代入上式，得到 $R=2\\pi_0 k$。\n使用在 $i=k$ 处的平衡方程：\n$$ \\pi_k=\\frac{1}{2}\\pi_{k-1}+\\frac{1}{2}\\pi_{k+1}+\\pi_0 $$\n代入 $\\pi_k=R=2k\\pi_0$, $\\pi_{k+1}=R=2k\\pi_0$ 和 $\\pi_{k-1}=2\\pi_0(k-1)$:\n$$ 2k\\pi_0 = \\frac{1}{2}(2\\pi_0(k-1)) + \\frac{1}{2}(2k\\pi_0) + \\pi_0 $$\n$$ 2k\\pi_0 = \\pi_0(k-1) + k\\pi_0 + \\pi_0 = \\pi_0(k-1+k+1) = 2k\\pi_0 $$\n该方程是一致的，但不能用来求解 $R$。原解法是正确的。\n$R = \\frac{1}{2}(2\\pi_0(k-1)) + \\frac{1}{2}R + \\pi_0 \\implies \\frac{1}{2}R = \\pi_0(k-1)+\\pi_0=k\\pi_0 \\implies R=2k\\pi_0$.\n该步骤是正确的。\n\n进行归一化：\n$$ 1=\\sum_{i=0}^{N}\\pi_i = \\pi_0 + \\sum_{i=1}^{k}2\\pi_0 i + \\sum_{i=k+1}^{N}2k\\pi_0 $$\n$$ 1 = \\pi_0 + 2\\pi_0 \\frac{k(k+1)}{2} + 2k\\pi_0(N-k) $$\n$$ 1 = \\pi_0 [1 + k(k+1) + 2k(N-k)] = \\pi_0 [1 + k^2+k + 2kN - 2k^2] $$\n$$ 1 = \\pi_0 [1+k+2kN-k^2] = \\pi_0 [1+k(2N+1-k)] $$\n所以 $\\pi_0 = \\frac{1}{1+k(2N+1-k)}$。\n最后, $\\pi_N=R=2k\\pi_0 = \\frac{2k}{1+k(2N+1-k)}$。\n\n原解法是正确的。我将只修复其格式。\n\n令状态空间为 $S = \\{0, 1, \\dots, N\\}$，令 $\\pi=(\\pi_0, \\pi_1, \\dots, \\pi_N)$ 为平稳分布。平稳性要求，对于每个状态 $i$，有 $\\pi_i = \\sum_{j} \\pi_j P_{ji}$。\n\n根据转移规则：\n- 对于 $i=0$，唯一的进入转移是 $1 \\to 0$，概率为 $1/2$，所以\n$$\n\\pi_0 = \\frac{1}{2}\\pi_1\n$$\n- 对于 $1 \\le i \\le N-1, i \\neq k$，唯一的进入转移来自 $i-1$ 和 $i+1$，每个概率为 $1/2$，得到\n$$\n\\pi_i = \\frac{1}{2}\\pi_{i-1} + \\frac{1}{2}\\pi_{i+1}\n$$\n- 对于 $i=k$，除了来自 $k \\pm 1$ 的转移，还有一个概率为 $1$ 的跳跃 $0 \\to k$，因此\n$$\n\\pi_k = \\frac{1}{2}\\pi_{k-1} + \\frac{1}{2}\\pi_{k+1} + \\pi_0\n$$\n- 对于 $i=N$，进入的转移是 $N \\to N$（概率 $1/2$）和 $N-1 \\to N$（概率 $1/2$），所以\n$$\n\\pi_N = \\frac{1}{2}\\pi_{N-1} + \\frac{1}{2}\\pi_N \\quad\\Longrightarrow\\quad \\pi_N = \\pi_{N-1}\n$$\n\n对于非齐次项不存在的任何区间内的 $i$（即，不包括 $i=k$），递推关系 $\\pi_i = \\frac{1}{2}\\pi_{i-1} + \\frac{1}{2}\\pi_{i+1}$ 等价于二阶差分方程 $\\pi_{i+1}-2\\pi_i+\\pi_{i-1}=0$，其通解是线性的。因此：\n- 在右半部分 $i \\in \\{k+1, \\dots, N\\}$，写出 $\\pi_i = Ci+D$。使用 $\\pi_N = \\pi_{N-1}$ 得出 $C=0$，因此对于所有 $i \\in \\{k+1, \\dots, N\\}$，$\\pi_i=R$ 是一个常数，其中 $R=\\pi_N$。\n- 在左半部分 $i \\in \\{1, \\dots, k\\}$，$\\pi_i = Ai+B$ 是一个算术级数。结合 $\\pi_0=\\pi_1/2$ 可以统一地表示为：\n$$\n\\pi_i = 2\\pi_0 i \\quad \\text{对于所有 } i \\in \\{1, \\dots, k\\}\n$$\n\n接下来，将 $\\pi_k$ 与 $R$ 联系起来。如果 $k \\le N-2$，在 $i=k+1$ 处应用递推关系：\n$$\n\\pi_{k+1} = \\frac{1}{2}\\pi_k + \\frac{1}{2}\\pi_{k+2}\n$$\n因为 $\\pi_{k+1}=\\pi_{k+2}=R$，这得出 $R = \\frac{1}{2}\\pi_k + \\frac{1}{2}R$，因此 $\\pi_k=R$。如果 $k=N-1$，则由 $\\pi_N=\\pi_{N-1}$ 可得 $\\pi_k=\\pi_{N-1}=\\pi_N=R$。因此在所有情况下都有 $\\pi_k=R$。\n\n使用在 $i=k$ 处的特殊平衡方程：\n$$\n\\pi_k = \\frac{1}{2}\\pi_{k-1} + \\frac{1}{2}\\pi_{k+1} + \\pi_0\n$$\n将 $\\pi_k=R$, $\\pi_{k+1}=R$ 和 $\\pi_{k-1}=2\\pi_0(k-1)$ 代入，得到\n$$\nR = \\frac{1}{2}(2\\pi_0(k-1)+R) + \\pi_0 \\quad\\Longrightarrow\\quad R = \\pi_0(k-1) + \\frac{1}{2}R + \\pi_0 \\quad\\Longrightarrow\\quad \\frac{1}{2}R = k\\pi_0 \\quad\\Longrightarrow\\quad R=2k\\pi_0\n$$\n因此 $\\pi_N=R=2k\\pi_0$。\n\n进行归一化以求得 $\\pi_0$。使用当 $1 \\le i \\le k$ 时 $\\pi_i = 2\\pi_0 i$ 和当 $k+1 \\le i \\le N$ 时 $\\pi_i = 2k\\pi_0$，我们有\n$$\n1 = \\sum_{i=0}^{N}\\pi_i = \\pi_0 + \\sum_{i=1}^{k} 2\\pi_0 i + \\sum_{i=k+1}^{N} 2k\\pi_0\n$$\n$$\n1 = \\pi_0 + 2\\pi_0 \\cdot \\frac{k(k+1)}{2} + 2k\\pi_0(N-k)\n$$\n因此\n$$\n1 = \\pi_0 [1 + k(k+1) + 2k(N-k)] = \\pi_0 [1+k^2+k+2kN-2k^2] = \\pi_0 [1+k(2N+1-k)]\n$$\n所以\n$$\n\\pi_0 = \\frac{1}{1+k(2N+1-k)}\n$$\n最后，\n$$\n\\pi_N = 2k\\pi_0 = \\frac{2k}{1+k(2N+1-k)}\n$$\n这就是所求的在状态 $N$ 的平稳概率关于 $N$ 和 $k$ 的闭式表达式。", "answer": "$$\\boxed{\\frac{2k}{1+k(2N+1-k)}}$$", "id": "1302609"}]}