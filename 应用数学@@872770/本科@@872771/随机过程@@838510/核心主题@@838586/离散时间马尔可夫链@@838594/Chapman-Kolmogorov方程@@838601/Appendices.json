{"hands_on_practices": [{"introduction": "我们从一个基本应用开始：预测一个系统在未来某个时间的状态。这个练习将帮助你理解如何使用查普曼-科尔莫戈罗夫方程来计算多步转移概率，这是分析马尔可夫链随时间演化的核心技能。通过一个关于扫地机器人的直观场景[@problem_id:1347922]，你将实践如何通过迭代或矩阵乘法来追踪概率分布的变化。", "problem": "一个智能扫地机器人在一个有两间房的公寓里工作，分别是客厅（房间1）和卧室（房间2）。机器人在房间之间的移动被建模为一个离散时间随机过程。在每个清洁周期（一个时间步）结束时，机器人根据其当前位置决定下一步去哪里。\n\n转移概率如下：\n- 如果机器人在客厅（房间1），它有 $\\frac{1}{3}$ 的概率在下一个周期停留在客厅，有 $\\frac{2}{3}$ 的概率移动到卧室（房间2）。\n- 如果机器人在卧室（房间2），它有 $\\frac{1}{2}$ 的概率在下一个周期移动到客厅，有 $\\frac{1}{2}$ 的概率停留在卧室。\n\n假设机器人在时间步 $t=0$ 时从客厅开始其清洁过程。那么在时间步 $t=3$ 时机器人在客厅的概率是多少？请将你的答案表示为一个分数。", "solution": "将机器人的位置建模为一个具有两个状态的马尔可夫链，状态 $1$（客厅）和状态 $2$（卧室）。令 $p_{t}=\\mathbb{P}(X_{t}=1)$ 为机器人在时间 $t$ 位于客厅的概率。根据全概率公式和给定的转移概率，\n$$\np_{t+1}=p_{t}\\cdot \\frac{1}{3}+(1-p_{t})\\cdot \\frac{1}{2}=\\frac{1}{2}-\\frac{1}{6}p_{t}.\n$$\n这是一个线性差分方程。其不动点 $p^{*}$ 满足\n$$\np^{*}=\\frac{1}{2}-\\frac{1}{6}p^{*}\\quad\\Rightarrow\\quad p^{*}\\left(1+\\frac{1}{6}\\right)=\\frac{1}{2}\\quad\\Rightarrow\\quad p^{*}=\\frac{3}{7}.\n$$\n因此通解为\n$$\np_{t}-p^{*}=\\left(-\\frac{1}{6}\\right)^{t}\\left(p_{0}-p^{*}\\right).\n$$\n根据初始条件 $p_{0}=1$，我们得到\n$$\np_{3}=\\frac{3}{7}+\\left(1-\\frac{3}{7}\\right)\\left(-\\frac{1}{6}\\right)^{3}=\\frac{3}{7}+\\frac{4}{7}\\left(-\\frac{1}{216}\\right)=\\frac{3}{7}-\\frac{1}{378}=\\frac{162-1}{378}=\\frac{161}{378}=\\frac{23}{54}.\n$$\n因此，在时间步 $t=3$ 时机器人在客厅的概率是 $\\frac{23}{54}$。", "answer": "$$\\boxed{\\frac{23}{54}}$$", "id": "1347922"}, {"introduction": "在掌握了未来状态预测后，我们可以探索一个更有趣的问题：如何根据系统的起点和终点来推断其经过的路径？这个问题[@problem_id:1347939]展示了马尔可夫链原理在推断和诊断领域的强大应用。它要求我们运用条件概率来重构系统未被观测到的中间状态，这对于理解隐藏在数据背后的过程至关重要。", "problem": "一个监控系统在每小时结束时跟踪一个关键服务器组件的状态。该组件可能处于三种状态之一：状态1（最优）、状态2（降级）或状态3（故障）。状态之间的转移构成一个离散时间马尔可夫链。一步转移概率矩阵 $P$，其中 $P_{ij} = P(X_{t+1}=j | X_t=i)$，由下式给出：\n$$\nP = \\begin{pmatrix}\n1 - 2\\alpha  2\\alpha  0 \\\\\n\\beta  1 - \\beta - \\gamma  \\gamma \\\\\n0  0  1\n\\end{pmatrix}\n$$\n此处，$X_t$ 表示在第 $t$ 小时组件的状态。参数 $\\alpha, \\beta, \\gamma$ 是满足 $0  2\\alpha  1$，$0  \\beta  1$，$0  \\gamma  1$ 以及 $\\beta + \\gamma  1$ 的常数。\n\n假设在时间 $t=0$ 时，观测到组件处于最优状态（状态1）。两小时后，在时间 $t=2$ 时，观测到它处于降级状态（状态2）。\n\n根据这些观测结果，计算在时间 $t=1$ 时该组件处于降级状态（状态2）的条件概率。将答案表示为以 $\\alpha$、$\\beta$ 和 $\\gamma$ 表示的闭式解析表达式。", "solution": "题目要求我们计算一个转移矩阵为 $P$ 的时齐马尔可夫链的条件概率 $P(X_{1}=2 \\mid X_{0}=1, X_{2}=2)$。根据条件概率的定义和马尔可夫性质（未来只依赖于当前状态），我们使用\n$$\nP(X_{1}=j \\mid X_{0}=i, X_{2}=k) = \\frac{P(X_{1}=j, X_{2}=k \\mid X_{0}=i)}{P(X_{2}=k \\mid X_{0}=i)}.\n$$\n根据马尔可夫性质，分子可以分解为\n$$\nP(X_{1}=j, X_{2}=k \\mid X_{0}=i) = P(X_{1}=j \\mid X_{0}=i)\\,P(X_{2}=k \\mid X_{1}=j) = P_{i j} P_{j k},\n$$\n而分母，根据全概率公式和马尔可夫性质，是\n$$\nP(X_{2}=k \\mid X_{0}=i) = \\sum_{m} P(X_{2}=k \\mid X_{1}=m)\\,P(X_{1}=m \\mid X_{0}=i) = \\sum_{m} P_{i m} P_{m k}.\n$$\n因此，\n$$\nP(X_{1}=j \\mid X_{0}=i, X_{2}=k) = \\frac{P_{i j} P_{j k}}{\\sum_{m} P_{i m} P_{m k}}.\n$$\n我们代入 $i=1$，$j=2$，$k=2$，并使用给定的 $P$。相关的非零项为\n$$\nP_{1,1} = 1 - 2\\alpha,\\quad P_{1,2} = 2\\alpha,\\quad P_{2,2} = 1 - \\beta - \\gamma,\\quad P_{1,3} = 0.\n$$\n由于 $P_{1,3}=0$，分母中的求和简化为 $m \\in \\{1,2\\}$。对于 $j=2$，分子为\n$$\nP_{1,2} P_{2,2} = (2\\alpha)(1 - \\beta - \\gamma).\n$$\n分母为\n$$\n\\sum_{m} P_{1,m} P_{m,2} = P_{1,1} P_{1,2} + P_{1,2} P_{2,2} = (1 - 2\\alpha)(2\\alpha) + (2\\alpha)(1 - \\beta - \\gamma) = 2\\alpha \\big(2 - 2\\alpha - \\beta - \\gamma\\big).\n$$\n因此，\n$$\nP(X_{1}=2 \\mid X_{0}=1, X_{2}=2) = \\frac{(2\\alpha)(1 - \\beta - \\gamma)}{2\\alpha \\big(2 - 2\\alpha - \\beta - \\gamma\\big)} = \\frac{1 - \\beta - \\gamma}{2 - 2\\alpha - \\beta - \\gamma}.\n$$\n在给定的约束条件 $0  2\\alpha  1$，$0  \\beta  1$，$0  \\gamma  1$ 和 $\\beta+\\gamma  1$ 下，此表达式是良定义的，这些条件确保了分母为正。", "answer": "$$\\boxed{\\frac{1-\\beta-\\gamma}{2-2\\alpha-\\beta-\\gamma}}$$", "id": "1347939"}, {"introduction": "现实世界中的许多系统并非一成不变，它们的转移规则可能会随时间演化。这个高级练习[@problem_id:706878]挑战你将查普曼-科尔莫戈罗夫方程应用于规则本身也在变化的时间非齐次马尔可夫链。它揭示了该方程的本质——即组合连续的转移过程，而不仅仅是对单个转移矩阵进行幂运算，从而加深你对该基本原理的理解。", "problem": "考虑一个在具有三个顶点集合 $V = \\{1, 2, 3\\}$ 的时变图上的离散时间懒惰随机游走。游走的行为由一个懒惰参数 $p \\in (0, 1)$ 控制。在任意顶点 $v$，游走者有概率 $p$ 在下一时间步停留在 $v$。以 $1-p$ 的概率，游走者移动到一个随机均匀选择的相邻顶点。顶点 $v$ 的邻居集合由其在该特定时间的图中度 $d(v)$ 决定。如果一个顶点没有邻居 ($d(v)=0$)，游走者以概率 1 停留在 $v$。\n\n图的结构是随时间变化的。\n- 在第一个时间步，从时间 $t=0$ 到 $t=1$，图为 $G_0 = (V, E_0)$，其边集为 $E_0 = \\{(1, 3), (2, 3)\\}$。\n- 对于所有后续时间步，即对于所有 $n \\ge 1$，从 $t=n$ 到 $t=n+1$，在顶点 1 和 2 之间添加一条边。图变为 $G_1 = (V, E_1)$，其边集为 $E_1 = \\{(1, 2), (1, 3), (2, 3)\\}$。\n\n令 $P_{ij}(t)$ 表示在时间 $t=0$ 从顶点 $i$ 出发的游走者在时间 $t$ 位于顶点 $j$ 的概率。使用非时齐马尔可夫链的 Chapman-Kolmogorov 方程，推导两步转移概率 $P_{33}(2)$ 作为懒惰参数 $p$ 的函数的闭式表达式。", "solution": "1. 两步转移概率由非时齐链的查普曼-科尔莫戈罗夫方程给出：$P_{33}(2) = \\sum_{k \\in \\{1,2,3\\}} P(X_1=k|X_0=3) \\cdot P(X_2=3|X_1=k)$。根据题意，$P(X_1=k|X_0=3)$ 就是一步转移概率 $P_{3k}(1)$。\n2. 在 $G_0$（第一步）上，顶点 3 的度为 2，所以 $P_{33}(1)=p$, $P_{31}(1)=\\frac{1-p}{2}$, $P_{32}(1)=\\frac{1-p}{2}$。\n3. 在 $G_1$（第二步）上，所有顶点的度都为 2。因此，从任意顶点 $k$到顶点 3 的转移概率 $P(X_2=3|X_1=k)$ 为：\n   $$P(X_2=3|X_1=k)=\\begin{cases}\n   p  \\text{若 } k=3 \\\\\n   \\frac{1-p}{2}  \\text{若 } k=1,2\n   \\end{cases}$$\n4. 代入求和式中：\n   $$\n   P_{33}(2) = P_{33}(1)P(X_2=3|X_1=3) + P_{31}(1)P(X_2=3|X_1=1) + P_{32}(1)P(X_2=3|X_1=2)\n   = p \\cdot p + \\frac{1-p}{2} \\cdot \\frac{1-p}{2} + \\frac{1-p}{2} \\cdot \\frac{1-p}{2}\n   = p^2 + \\frac{(1-p)^2}{2}\\,.\n   $$", "answer": "$$\\boxed{p^2+\\frac{(1-p)^2}{2}}$$", "id": "706878"}]}