{"hands_on_practices": [{"introduction": "转移概率矩阵最直接的应用是计算一个系统遵循特定状态序列的概率。得益于马尔可夫性质，一个序列的总概率就是构成该序列的每一步转移概率的简单乘积。通过一个关于粒子能量阱的假设模型，本练习 [@problem_id:1345202] 将帮助你掌握这一基本计算方法。", "problem": "一个简化模型描述了一个粒子的状态，该粒子可以占据三个离散的能阱之一，分别标记为状态1、状态2和状态3。该过程被建模为一个离散时间马尔可夫链。从时间 $t$ 的状态 $i$到时间 $t+1$ 的状态 $j$ 的转移由概率 $P_{ij}$ 给出，其中转移概率矩阵 $P$ 定义为：\n$$\nP = \\begin{pmatrix}\n0.2 & 0.5 & 0.3 \\\\\n0.4 & 0.1 & 0.5 \\\\\n0.7 & 0.2 & 0.1\n\\end{pmatrix}\n$$\n假设在初始时间 $t=0$ 时，该粒子总是处于状态1。\n计算在时间 $t=1$ 时观察到粒子处于状态3，并随后在时间 $t=2$ 时处于状态2的概率。将你的答案表示为小数。", "solution": "令 $X_{t}$ 表示时间 $t$ 时的状态。初始条件为 $X_{0}=1$ 的概率为 $1$。我们要求的是在给定 $X_{0}=1$ 的条件下，事件 $\\{X_{1}=3, X_{2}=2\\}$ 发生的概率。\n\n根据乘法法则和马尔可夫性质，\n$$\n\\Pr(X_{1}=3, X_{2}=2 \\mid X_{0}=1)\n= \\Pr(X_{1}=3 \\mid X_{0}=1)\\,\\Pr(X_{2}=2 \\mid X_{1}=3).\n$$\n从转移矩阵 $P$ 中，我们读出 $P_{13}=0.3$ 和 $P_{32}=0.2$，因此\n$$\n\\Pr(X_{1}=3, X_{2}=2 \\mid X_{0}=1) = 0.3 \\times 0.2 = 0.06.\n$$\n因此，所求概率为 $0.06$。", "answer": "$$\\boxed{0.06}$$", "id": "1345202"}, {"introduction": "在掌握了计算单一路径概率的方法之后，一个更常见的问题是：从某个初始状态出发，经过若干步之后，系统处于某个特定状态的总概率是多少？这引出了 n 步转移概率的概念，它可以通过矩阵乘法 $P^n$ 来计算。这个练习 [@problem_id:1345206] 将让你通过一个自动驾驶系统的虚构模型，比较系统在两步之后进入不同模式的可能性，从而实践多步转移概率的计算。", "problem": "一个实验性自动驾驶汽车的控制系统行为被建模为一个离散时间马尔可夫链。在任何给定的时间步，该系统可以处于三种操作模式之一：“激进”、“正常”或“谨慎”。在一个时间步内从一种模式转换到另一种模式的过程由一个固定的概率矩阵决定。设状态由数字表示：1代表“激进”，2代表“正常”，3代表“谨慎”。一步转移概率矩阵 $P$ 如下所示，其中元素 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率：\n\n$$\nP = \\begin{pmatrix} 0.5 & 0.4 & 0.1 \\\\ 0.2 & 0.5 & 0.3 \\\\ 0.1 & 0.6 & 0.3 \\end{pmatrix}\n$$\n\n该汽车的系统初始状态为“正常”模式。我们想要比较经过恰好两个时间步后，其操作模式的可能性。下列哪个陈述是正确的？\n\nA. 系统处于“激进”模式的概率大于其处于“谨慎”模式的概率。\n\nB. 系统处于“谨慎”模式的概率大于其处于“激进”模式的概率。\n\nC. 系统处于“激进”模式和“谨慎”模式的概率完全相等。\n\nD. 根据所提供的信息无法确定。", "solution": "设状态标记为 1 = 激进，2 = 正常，3 = 谨慎。系统从状态2开始，因此经过两步后处于状态 $j$ 的概率是两步转移概率 $(P^{2})_{2j}$，其中 $P^{2} = P P$。\n\n将给定的转移矩阵用精确分数写出：\n$$\nP = \\begin{pmatrix}\n\\frac{1}{2} & \\frac{2}{5} & \\frac{1}{10} \\\\\n\\frac{1}{5} & \\frac{1}{2} & \\frac{3}{10} \\\\\n\\frac{1}{10} & \\frac{3}{5} & \\frac{3}{10}\n\\end{pmatrix}.\n$$\n对于 $j \\in \\{1,2,3\\}$，\n$$\n(P^{2})_{2j} = \\sum_{k=1}^{3} P_{2k} P_{kj}.\n$$\n计算两步后转移到状态1和状态3的概率。\n\n对于状态1（激进）：\n$$\n(P^{2})_{21} = P_{21}P_{11} + P_{22}P_{21} + P_{23}P_{31}\n= \\frac{1}{5}\\cdot\\frac{1}{2} + \\frac{1}{2}\\cdot\\frac{1}{5} + \\frac{3}{10}\\cdot\\frac{1}{10}\n= \\frac{1}{10} + \\frac{1}{10} + \\frac{3}{100}\n= \\frac{23}{100}.\n$$\n对于状态3（谨慎）：\n$$\n(P^{2})_{23} = P_{21}P_{13} + P_{22}P_{23} + P_{23}P_{33}\n= \\frac{1}{5}\\cdot\\frac{1}{10} + \\frac{1}{2}\\cdot\\frac{3}{10} + \\frac{3}{10}\\cdot\\frac{3}{10}\n= \\frac{1}{50} + \\frac{3}{20} + \\frac{9}{100}\n= \\frac{2}{100} + \\frac{15}{100} + \\frac{9}{100}\n= \\frac{26}{100}.\n$$\n比较：\n$$\n\\frac{23}{100} < \\frac{26}{100},\n$$\n因此，两步后处于“谨慎”模式的概率大于处于“激进”模式的概率。因此，陈述B是正确的。", "answer": "$$\\boxed{B}$$", "id": "1345206"}, {"introduction": "现在，让我们来处理一个更精细的问题：系统在第 n 步*首次*到达某个特定状态的概率是多少？这与简单地计算第 n 步处于该状态的概率不同，因为它要求我们在计算中排除那些在第 n 步之前就已经访问过目标状态的路径。通过分析一个学生日常活动安排的假设场景，本练习 [@problem_id:1345205] 将训练你如何严谨地识别并计算满足“首次到达”条件的路径概率。", "problem": "一个学生下午日程的简化模型遵循一个具有三种可能状态的马尔可夫链过程：\n- 状态1：听讲座。\n- 状态2：在图书馆学习。\n- 状态3：在咖啡店放松。\n\n这些状态之间的转移发生在离散的时间步。单步转移概率矩阵 $P$（其中元素 $P_{ij}$ 表示从状态 $i$ 转移到状态 $j$ 的概率）由下式给出：\n\n$$\nP = \\begin{pmatrix}\n0.2 & 0.5 & 0.3 \\\\\n0.4 & 0.4 & 0.2 \\\\\n0.1 & 0.1 & 0.8\n\\end{pmatrix}\n$$\n\n假设学生当前处于状态1（听讲座）。计算学生在第二个时间步首次访问咖啡店（状态3）的概率。请将您的答案表示为保留三位有效数字的小数。", "solution": "设 $X_n$ 为学生在时间步 $n$ 时的状态。状态空间为 $S = \\{1, 2, 3\\}$。\n我们已知学生从状态1开始，所以初始状态为 $X_0 = 1$。\n我们需要计算学生在第二个时间步（即 $n=2$）首次访问状态3的概率。这意味着在时间步 $n=2$ 时，学生处于状态3，并且在之前所有的时间步（此处为 $n=1$），学生都不在状态3。\n在数学上，我们要求计算在 $X_0 = 1$ 的条件下，事件 $\\{X_2 = 3 \\text{ 且 } X_1 \\neq 3\\}$ 发生的概率。\n\n我们可以根据时间步 $n=1$ 的可能状态来分解这个事件。由于我们要求 $X_1 \\neq 3$，学生在时间步1时必须处于状态1或状态2。这两种可能性代表了从初始状态到最终状态的互斥路径。\n两条有效的路径是：\n1.  从状态1开始，转移到状态1，然后转移到状态3。状态序列为 $1 \\to 1 \\to 3$。\n2.  从状态1开始，转移到状态2，然后转移到状态3。状态序列为 $1 \\to 2 \\to 3$。\n\n路径 $1 \\to 3 \\to \\dots$ 是不允许的，因为这意味着首次访问状态3发生在时间步1，而不是2。\n\n我们使用马尔可夫性质来计算每条路径的概率。一个状态序列的概率是各个转移概率的乘积。\n第一条路径（$1 \\to 1 \\to 3$）的概率是：\n$$\nP(X_1=1, X_2=3 | X_0=1) = P(X_1=1 | X_0=1) \\times P(X_2=3 | X_1=1)\n$$\n使用转移矩阵 $P$，其中 $P_{ij} = P(X_{n+1}=j | X_n=i)$，这变为：\n$$\nP(\\text{路径 } 1) = P_{11} \\times P_{13}\n$$\n第二条路径（$1 \\to 2 \\to 3$）的概率是：\n$$\nP(X_1=2, X_2=3 | X_0=1) = P(X_1=2 | X_0=1) \\times P(X_2=3 | X_1=2)\n$$\n用转移矩阵的元素表示，即为：\n$$\nP(\\text{路径 } 2) = P_{12} \\times P_{23}\n$$\n在第二个时间步首次访问状态3的总概率是这两条不相交路径的概率之和：\n$$\nP(\\text{总计}) = P(\\text{路径 } 1) + P(\\text{路径 } 2) = (P_{11} \\times P_{13}) + (P_{12} \\times P_{23})\n$$\n现在，我们代入给定转移矩阵中的数值：\n$$\nP = \\begin{pmatrix}\n0.2 & 0.5 & 0.3 \\\\\n0.4 & 0.4 & 0.2 \\\\\n0.1 & 0.1 & 0.8\n\\end{pmatrix}\n$$\n所以，$P_{11} = 0.2$，$P_{13} = 0.3$，$P_{12} = 0.5$，以及 $P_{23} = 0.2$。\n\n将这些值代入我们的总概率表达式中：\n$$\nP(\\text{总计}) = (0.2 \\times 0.3) + (0.5 \\times 0.2)\n$$\n$$\nP(\\text{总计}) = 0.06 + 0.10\n$$\n$$\nP(\\text{总计}) = 0.16\n$$\n题目要求答案保留三位有效数字。\n$$\n0.160\n$$", "answer": "$$\\boxed{0.160}$$", "id": "1345205"}]}