{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是亲手实践。这个练习将带你回到马尔可夫性质最核心的定义：系统的未来只依赖于其当前状态。通过计算一个粒子在几个离散时间步后到达特定位置的概率，你将直接应用状态转移概率，并体会到将复杂随机过程分解为一系列简单步骤的威力 [@problem_id:1342491]。", "problem": "考虑一个简化的自校准对齐系统的一维模型。一个粒子沿着整数线 $\\mathbb{Z}$ 运动。令 $X_n$ 表示粒子在离散时间步 $n$ 的位置。系统的目标是使粒子尽可能地靠近原点（位置 0）。\n\n在每个时间步，粒子的位置变化一个单位，即 $X_{n+1} = X_n \\pm 1$。运动方向由一个旨在倾向于返回原点的概率规则决定。向右移动（$X_{n+1} = X_n + 1$）的概率取决于当前位置 $X_n = x$，并由函数 $p(x)$ 给出。因此，向左移动（$X_{n+1} = X_n - 1$）的概率是 $1-p(x)$。\n\n函数 $p(x)$ 的定义如下：\n$$\np(x) = \\begin{cases}\nq & \\text{if } x  0 \\\\\n1/2  \\text{if } x = 0 \\\\\n1-q  \\text{if } x > 0\n\\end{cases}\n$$\n其中 $q$ 是一个满足 $1/2  q  1$ 的给定常数。\n\n假设粒子从位置 $X_0 = 1$ 开始。计算在时间步 $n=3$ 时粒子位于原点的概率，即求 $P(X_3 = 0)$。将你的答案表示为 $q$ 的函数。", "solution": "我们将该运动建模为在 $\\mathbb{Z}$ 上的一个离散时间马尔可夫链。粒子从 $X_0 = 1$ 开始，我们想计算 $P(X_3=0)$。\n为了在3个时间步后从位置1到达位置0，粒子必须向左移动两次，向右移动一次。\n可能的位置序列有三种：\n1.  $1 \\to 0 \\to 1 \\to 0$\n2.  $1 \\to 2 \\to 1 \\to 0$\n3.  $1 \\to 0 \\to -1 \\to 0$\n\n我们首先确定转移概率：\n- 从 $x > 0$（如 1 或 2）向左移动的概率是 $1 - p(x) = 1 - (1-q) = q$。\n- 从 $x > 0$（如 1 或 2）向右移动的概率是 $p(x) = 1-q$。\n- 从 $x = 0$ 向左移动的概率是 $1 - p(0) = 1 - 1/2 = 1/2$。\n- 从 $x = 0$ 向右移动的概率是 $p(0) = 1/2$。\n- 从 $x  0$（如 -1）向右移动的概率是 $p(x) = q$。\n\n现在我们计算每条路径的概率：\n1.  路径 $1 \\to 0 \\to 1 \\to 0$ 的概率是：\n    $P(X_1=0|X_0=1) \\times P(X_2=1|X_1=0) \\times P(X_3=0|X_2=1) = q \\times \\frac{1}{2} \\times q = \\frac{1}{2}q^2$\n2.  路径 $1 \\to 2 \\to 1 \\to 0$ 的概率是：\n    $P(X_1=2|X_0=1) \\times P(X_2=1|X_1=2) \\times P(X_3=0|X_2=1) = (1-q) \\times q \\times q = q^2(1-q)$\n3.  路径 $1 \\to 0 \\to -1 \\to 0$ 的概率是：\n    $P(X_1=0|X_0=1) \\times P(X_2=-1|X_1=0) \\times P(X_3=0|X_2=-1) = q \\times \\frac{1}{2} \\times q = \\frac{1}{2}q^2$\n\n总概率是这三条不相交路径的概率之和：\n$P(X_3 = 0) = \\frac{1}{2}q^2 + q^2(1-q) + \\frac{1}{2}q^2 = q^2 + q^2(1-q) = q^2(1 + 1 - q) = q^2(2-q)$。", "answer": "$$\\boxed{q^{2}(2-q)}$$", "id": "1342491"}, {"introduction": "在实际应用中，许多随机过程似乎并不满足马尔可夫性质，因为它们的未来状态可能依赖于多个历史状态。这个问题展示了一种至关重要的建模技巧：状态空间扩展。通过将一个依赖于过去两期状态的总体动力学模型 [@problem_id:1342473] 转化为一个矢量马尔可夫过程，你将学会如何将更复杂的“有记忆”系统纳入马尔可夫分析的强大框架中。", "problem": "一位生物学家正在研究一个物种，其种群大小（在第 $t$ 年记为 $P_t$）表现出复杂的动态。研究发现，下一年的种群 $P_{t+1}$ 不仅取决于当年 $P_t$ 的种群，还取决于前一年 $P_{t-1}$ 的种群。这种“记忆”效应是由于资源可利用性以两年为周期恢复。该模型由以下线性递推关系描述：\n$$P_{t+1} = \\alpha P_t + \\beta P_{t-1} + W_t$$\n其中，$\\alpha$ 和 $\\beta$ 是常数系数，分别代表增长效应和延迟调节效应，而 $\\{W_t\\}$ 是一个独立同分布的随机变量序列，代表不可预测的环境波动，其均值为零。\n\n这个过程 $\\{P_t\\}$ 不是一个马尔可夫过程，因为预测种群的未来分布需要的信息不仅仅是当前状态 $P_t$。为了使用强大的马尔可夫过程框架来分析这个系统，必须首先在时间 $t$ 定义一个合适的状态向量 $S_t$，使得由此产生的向量过程 $\\{S_t\\}$ 具有马尔可夫性质。\n\n以下哪个向量（向量以列向量形式书写）可以作为此目的的有效状态向量 $S_t$？\n\nA. $S_t = P_t$\n\nB. $S_t = \\begin{pmatrix} P_t \\\\ W_t \\end{pmatrix}$\n\nC. $S_t = \\begin{pmatrix} P_t \\\\ P_{t-1} \\end{pmatrix}$\n\nD. $S_t = \\begin{pmatrix} P_{t+1} \\\\ P_t \\end{pmatrix}$\n\nE. $S_t = P_t + P_{t-1}$", "solution": "我们已知线性递推关系\n$$P_{t+1}=\\alpha P_{t}+\\beta P_{t-1}+W_{t},$$\n其中 $\\{W_{t}\\}$ 是一个均值为零且独立于过去的独立同分布序列。一个向量过程 $\\{S_{t}\\}$ 是马尔可夫过程，如果对于每一个 $t$，$S_{t+1}$ 在给定整个过去的条件下的条件分布仅取决于 $S_{t}$；也就是说，\n$$\\Pr(S_{t+1}\\in A\\mid S_{t},S_{t-1},\\dots)=\\Pr(S_{t+1}\\in A\\mid S_{t})\\quad\\text{对于所有可测的 }A.$$\n\n考虑 $S_{t}=\\begin{pmatrix}P_{t}\\\\P_{t-1}\\end{pmatrix}$。那么\n$$S_{t+1}=\\begin{pmatrix}P_{t+1}\\\\P_{t}\\end{pmatrix}=\\begin{pmatrix}\\alpha  \\beta\\\\ 1  0\\end{pmatrix}\\begin{pmatrix}P_{t}\\\\P_{t-1}\\end{pmatrix}+\\begin{pmatrix}1\\\\0\\end{pmatrix}W_{t}.$$\n令 $A=\\begin{pmatrix}\\alpha  \\beta\\\\ 1  0\\end{pmatrix}$ 和 $B=\\begin{pmatrix}1\\\\0\\end{pmatrix}$。那么 $S_{t+1}=A S_{t}+B W_{t}$。因为 $W_{t}$ 独立于 $(S_{t},S_{t-1},\\dots)$ 并且具有固定的分布，所以 $S_{t+1}$ 在给定过去的条件下的条件分布仅通过确定性项 $A S_{t}$ 和独立新息 $B W_{t}$ 取决于 $S_{t}$。因此，$\\{S_{t}\\}$ 是一个一阶马尔可夫过程。所以选项 C 是有效的。\n\n我们现在来证明为什么其他选项作为时间 $t$ 的状态向量是无效的。\n\nA. $S_{t}=P_{t}$ 是不充分的，因为\n$$P_{t+1}\\mid(P_{t},P_{t-1})=\\alpha P_{t}+\\beta P_{t-1}+W_{t}$$\n其条件均值取决于 $P_{t-1}$，而 $P_{t-1}$ 并非由 $P_{t}$ 决定。因此，仅给定 $P_{t}$ 的 $P_{t+1}$ 的条件分布与给定全部过去的条件分布不匹配，这违反了马尔可夫性质。\n\nB. $S_{t}=\\begin{pmatrix}P_{t}\\\\ W_{t}\\end{pmatrix}$ 也是不充分的。尽管 $P_{t+1}=\\alpha P_{t}+\\beta P_{t-1}+W_{t}$ 包含了 $W_{t}$，但在给定 $(P_{t},W_{t})$ 的情况下，项 $\\beta P_{t-1}$ 仍然是未知的。因此，给定 $(P_{t},W_{t})$ 的 $P_{t+1}$ 的条件分布取决于 $P_{t-1}$，所以该过程在这种状态下不是马尔可夫过程。\n\nD. $S_{t}=\\begin{pmatrix}P_{t+1}\\\\P_{t}\\end{pmatrix}$ 使用了一个未来的值 $P_{t+1}$ 作为时间 $t$ 状态的一部分，而这个值并非由时间 $t$ 可用的信息所决定。虽然如果允许使用未来的信息，序列 $\\left(\\begin{pmatrix}P_{t+1}\\\\P_{t}\\end{pmatrix}\\right)_{t}$ 会满足关于 $t$ 的马尔可夫递推，但它不是一个由当前和过去信息构建的在时间 $t$ 的有效状态向量，而这对于系统演化的马尔可夫建模是必需的。\n\nE. $S_{t}=P_{t}+P_{t-1}$ 将两个所需的分量聚合成一个标量，从而丢失了信息。由于\n$$P_{t+1}=\\alpha P_{t}+\\beta P_{t-1}+W_{t},$$\n仅知道 $P_{t}+P_{t-1}$ 并不能确定 $P_{t+1}$ 的条件分布，因为不同的 $(P_{t},P_{t-1})$ 对可以产生相同的和，但 $\\alpha P_{t}+\\beta P_{t-1}$ 的值却不同。\n\n因此，唯一能产生时间 $t$ 的马尔可夫状态向量的有效选择是 $S_{t}=\\begin{pmatrix}P_{t}\\\\P_{t-1}\\end{pmatrix}$。", "answer": "$$\\boxed{C}$$", "id": "1342473"}, {"introduction": "对一个已知的马尔可夫过程进行函数变换，我们得到的新过程是否仍然是马尔可夫过程？这个问题引导我们深入探讨马尔可夫性质在变换下的保持性。通过分析一个由两状态马尔可夫链构造出的新过程 [@problem_id:1342502]，你需要推导出使其保持马尔可夫性的精确条件。这个练习不仅能加深你对马尔可夫性质的理解，也为你接触更高级的概念（如可集结性 lumpability）打下基础。", "problem": "考虑一个状态空间为 $S_X = \\{-1, 1\\}$ 的离散时间随机过程 $\\{X_n\\}_{n \\ge 0}$，该过程遵循时齐马尔可夫链的规则演化。其转移概率由下式给出：\n$$P(X_n = 1 | X_{n-1} = -1) = p$$\n$$P(X_n = -1 | X_{n-1} = 1) = q$$\n其中 $p$ 和 $q$ 是常数，满足 $0  p  1$ 且 $0  q  1$。另外两个转移概率由离开任何状态的概率之和必须为 1 这一事实确定。\n\n基于 $\\{X_n\\}$ 定义了一个新的随机过程 $\\{Y_n\\}_{n \\ge 1}$，其关系为 $Y_n = X_n X_{n-1}$。这个新过程的状态空间为 $S_Y = \\{-1, 1\\}$。\n\n在下列哪个条件下，过程 $\\{Y_n\\}_{n \\ge 1}$ 是一个马尔可夫链？\n\nA. 对所有有效的 $p$ 和 $q$，$\\{Y_n\\}$ 都是马尔可夫链。\n\nB. 当且仅当 $p=q$ 时，$\\{Y_n\\}$ 是马尔可夫链。\n\nC. 当且仅当 $p+q=1$ 时，$\\{Y_n\\}$ 是马尔可夫链。\n\nD. 当且仅当 $p=q=\\frac{1}{2}$ 时，$\\{Y_n\\}$ 是马尔可夫链。\n\nE. 对任何有效的 $p$ 和 $q$，$\\{Y_n\\}$ 都不是马尔可夫链。", "solution": "设 $\\{X_{n}\\}_{n\\ge 0}$ 是一个在 $S_{X}=\\{-1,1\\}$ 上的双态时齐马尔可夫链，其转移概率为\n$$\nP(X_{n}=1\\mid X_{n-1}=-1)=p,\\qquad P(X_{n}=-1\\mid X_{n-1}=1)=q,\n$$\n因此\n$$\nP(X_{n}=-1\\mid X_{n-1}=-1)=1-p,\\qquad P(X_{n}=1\\mid X_{n-1}=1)=1-q,\n$$\n其中 $0  p  1$ 且 $0  q  1$。\n新过程定义为 $Y_{n}=X_{n}X_{n-1}$，对于 $n\\ge 1$。$Y_{n}$ 的状态空间为 $S_{Y}=\\{-1,1\\}$。$Y_{n}=1$ 意味着 $X_{n}=X_{n-1}$（无状态变化），而 $Y_{n}=-1$ 意味着 $X_{n}\\neq X_{n-1}$（有状态变化）。\n\n为了使 $\\{Y_{n}\\}$ 成为一个马尔可夫链，转移概率 $P(Y_{n}=j\\mid Y_{n-1}=i)$ 必须独立于 $\\{Y_{n-2},Y_{n-3},\\dots\\}$。这等价于 $P(Y_{n}=j\\mid Y_{n-1}=i, Y_{n-2}=k) = P(Y_{n}=j\\mid Y_{n-1}=i)$ 对所有 $i,j,k \\in S_Y$ 成立。\n\n让我们计算 $P(Y_{n}=j\\mid Y_{n-1}=i, X_{n-2}=s)$，其中 $s\\in S_X$。如果这个概率不依赖于 $s$，那么它也不依赖于 $Y_{n-2}$，因为 $Y_{n-2}$ 是由 $X_{n-3}$ 和 $X_{n-2}$ 决定的。\n$Y_{n-1}=i$ 告诉我们 $X_{n-1}$ 和 $X_{n-2}$ 之间的关系。例如，如果 $Y_{n-1}=1$，则 $X_{n-1}=X_{n-2}$。如果 $Y_{n-1}=-1$，则 $X_{n-1}=-X_{n-2}$。\n\n考虑 $P(Y_n = -1 \\mid Y_{n-1}=1)$。这表示 $P(X_n \\neq X_{n-1} \\mid X_{n-1}=X_{n-2})$。\n-   如果 $X_{n-2}=1$，则 $X_{n-1}=1$。那么 $P(X_n \\neq X_{n-1} \\mid X_{n-2}=1, X_{n-1}=1) = P(X_n=-1 \\mid X_{n-1}=1) = q$。\n-   如果 $X_{n-2}=-1$，则 $X_{n-1}=-1$。那么 $P(X_n \\neq X_{n-1} \\mid X_{n-2}=-1, X_{n-1}=-1) = P(X_n=1 \\mid X_{n-1}=-1) = p$。\n\n为了使 $\\{Y_n\\}$ 成为马尔可夫链，给定 $Y_{n-1}$ 的 $Y_n$ 的条件概率不能依赖于 $X_{n-2}$ 的特定值。因此，我们必须有 $p=q$。\n\n让我们验证其他转移概率是否也满足这个条件。\n考虑 $P(Y_n = 1 \\mid Y_{n-1}=1)$。这表示 $P(X_n = X_{n-1} \\mid X_{n-1}=X_{n-2})$。\n-   如果 $X_{n-2}=1$，则 $X_{n-1}=1$。那么 $P(X_n = X_{n-1} \\mid X_{n-1}=1) = P(X_n=1 \\mid X_{n-1}=1) = 1-q$。\n-   如果 $X_{n-2}=-1$，则 $X_{n-1}=-1$。那么 $P(X_n = X_{n-1} \\mid X_{n-1}=-1) = P(X_n=-1 \\mid X_{n-1}=-1) = 1-p$。\n为了独立于 $X_{n-2}$，我们需要 $1-q=1-p$，即 $p=q$。\n\n考虑 $P(Y_n = -1 \\mid Y_{n-1}=-1)$。这表示 $P(X_n \\neq X_{n-1} \\mid X_{n-1}\\neq X_{n-2})$。\n-   如果 $X_{n-2}=1$，则 $X_{n-1}=-1$。那么 $P(X_n \\neq X_{n-1} \\mid X_{n-1}=-1) = P(X_n=1 \\mid X_{n-1}=-1) = p$。\n-   如果 $X_{n-2}=-1$，则 $X_{n-1}=1$。那么 $P(X_n \\neq X_{n-1} \\mid X_{n-1}=1) = P(X_n=-1 \\mid X_{n-1}=1) = q$。\n同样，我们需要 $p=q$。\n\n考虑 $P(Y_n = 1 \\mid Y_{n-1}=-1)$。这表示 $P(X_n = X_{n-1} \\mid X_{n-1}\\neq X_{n-2})$。\n-   如果 $X_{n-2}=1$，则 $X_{n-1}=-1$。那么 $P(X_n = X_{n-1} \\mid X_{n-1}=-1) = P(X_n=-1 \\mid X_{n-1}=-1) = 1-p$。\n-   如果 $X_{n-2}=-1$，则 $X_{n-1}=1$。那么 $P(X_n = X_{n-1} \\mid X_{n-1}=1) = P(X_n=1 \\mid X_{n-1}=1) = 1-q$。\n为了独立，我们需要 $1-p=1-q$，即 $p=q$。\n\n在所有情况下，$\\{Y_n\\}$ 成为马尔可夫链的条件都是 $p=q$。\n反之，如果 $p=q$，那么转移概率 $P(Y_n=j \\mid Y_{n-1}=i)$ 将独立于 $X_{n-2}$ 的状态，从而也独立于更早的过去，因此 $\\{Y_n\\}$ 是一个马尔可夫链。\n所以，当且仅当 $p=q$ 时，$\\{Y_n\\}$ 是一个马尔可夫链。", "answer": "$$\\boxed{B}$$", "id": "1342502"}]}