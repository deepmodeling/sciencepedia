{"hands_on_practices": [{"introduction": "对于任何不可约的马尔可夫链，无论其初始状态如何，系统在长期运行后处于各个状态的概率都会收敛到一个唯一的平稳分布。这个练习将引导你通过建立并求解由 $\\pi = \\pi P$ 定义的线性方程组，来直接计算这个平稳分布。这是分析马尔可夫链长期行为的一项基本计算技能 [@problem_id:1348565]。", "problem": "一个新发布的虚拟宠物的心情被建模为一个离散时间马尔可夫链。在每个小时结束时，该宠物的心情可以是三种状态之一：状态1（开心）、状态2（中性）或状态3（伤心）。在一个小时内从一个状态转移到另一个状态的转移概率由以下转移矩阵 $P$ 给出：\n\n$$\nP = \\begin{pmatrix} 0.5  0.5  0 \\\\ 0.2  0.2  0.6 \\\\ 0.1  0.8  0.1 \\end{pmatrix}\n$$\n\n其中，元素 $P_{ij}$ 表示从状态 $i$ 转移到状态 $j$ 的概率。\n\n对于像这样一个不可约且非周期的马尔可夫链，一个已知的性质是，经过很多时间步后，发现宠物处于任何给定心情的概率与其初始心情无关。这意味着对于一个非常大的整数 $n$，矩阵 $P^n$（$n$ 步转移矩阵）的所有行都收敛到同一个极限行向量 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$。这个向量 $\\pi$ 代表了宠物在每种心情下花费时间的长期比例。\n\n计算这个极限向量 $\\pi$。将你的答案表示为一个由三个最简精确分数组成的行向量。", "solution": "设 $\\pi = (\\pi_{1},\\pi_{2},\\pi_{3})$ 表示极限行向量。对于不可约且非周期的马尔可夫链，$\\pi$ 是满足 $\\pi = \\pi P$ 和 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$ 的唯一平稳分布。\n\n用精确分数表示 $P$：\n$$\nP=\\begin{pmatrix}\n\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n\\frac{1}{5}  \\frac{1}{5}  \\frac{3}{5} \\\\\n\\frac{1}{10}  \\frac{4}{5}  \\frac{1}{10}\n\\end{pmatrix}.\n$$\n平稳性方程 $\\pi = \\pi P$ 的分量形式为：\n$$\n\\pi_{1}=\\frac{1}{2}\\pi_{1}+\\frac{1}{5}\\pi_{2}+\\frac{1}{10}\\pi_{3},\\quad\n\\pi_{2}=\\frac{1}{2}\\pi_{1}+\\frac{1}{5}\\pi_{2}+\\frac{4}{5}\\pi_{3},\\quad\n\\pi_{3}=0\\cdot\\pi_{1}+\\frac{3}{5}\\pi_{2}+\\frac{1}{10}\\pi_{3}.\n$$\n将每一项移到左边并消去分母，重写方程组：\n$$\n5\\pi_{1}-2\\pi_{2}-\\pi_{3}=0,\\qquad 8\\pi_{2}-5\\pi_{1}-8\\pi_{3}=0,\\qquad 9\\pi_{3}-6\\pi_{2}=0.\n$$\n由 $9\\pi_{3}-6\\pi_{2}=0$ 可得 $\\pi_{3}=\\frac{2}{3}\\pi_{2}$。将此代入 $5\\pi_{1}-2\\pi_{2}-\\pi_{3}=0$：\n$$\n5\\pi_{1}-2\\pi_{2}-\\frac{2}{3}\\pi_{2}=0 \\;\\Longrightarrow\\; 5\\pi_{1}-\\frac{8}{3}\\pi_{2}=0 \\;\\Longrightarrow\\; \\pi_{1}=\\frac{8}{15}\\pi_{2}.\n$$\n使用归一化条件 $\\pi_{1}+\\pi_{2}+\\pi_{3}=1$ 以及 $\\pi_{1}=\\frac{8}{15}\\pi_{2}$ 和 $\\pi_{3}=\\frac{2}{3}\\pi_{2}$：\n$$\n\\frac{8}{15}\\pi_{2}+\\pi_{2}+\\frac{2}{3}\\pi_{2}=1 \\;\\Longrightarrow\\; \\left(\\frac{8}{15}+\\frac{15}{15}+\\frac{10}{15}\\right)\\pi_{2}=1 \\;\\Longrightarrow\\; \\frac{33}{15}\\pi_{2}=1 \\;\\Longrightarrow\\; \\pi_{2}=\\frac{15}{33}=\\frac{5}{11}.\n$$\n则\n$$\n\\pi_{1}=\\frac{8}{15}\\cdot\\frac{15}{33}=\\frac{8}{33},\\qquad \\pi_{3}=\\frac{2}{3}\\cdot\\frac{15}{33}=\\frac{10}{33}.\n$$\n因此，极限向量是\n$$\n\\pi=\\left(\\frac{8}{33},\\frac{5}{11},\\frac{10}{33}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{8}{33}  \\frac{5}{11}  \\frac{10}{33} \\end{pmatrix}}$$", "id": "1348565"}, {"introduction": "虽然代数方法总是有效的，但有时问题的内在结构允许我们采用更优雅、更直观的解法。本练习探讨了一个具有高度对称性的随机游走模型，并借此引入了双随机矩阵的概念。学会识别并利用这种对称性，可以极大地简化寻找平稳分布的过程，并加深你对系统平衡状态的理解 [@problem_id:1348583]。", "problem": "一个粒子在一组由四个不同位置组成的集合 $\\{1, 2, 3, 4\\}$ 上进行随机游走。在每个离散时间步，该粒子从其当前位置跳到*其他三个*位置中的一个。在所有可用的目标位置中，每个位置被选中的概率是相等的。例如，如果粒子在位置1，它将以 $1/3$ 的概率跳到位置2、3或4。假设该过程持续了非常大量的步数。求粒子在位置2的极限概率是多少？请用分数表示你的答案。", "solution": "将此过程建模为状态空间为 $\\{1,2,3,4\\}$ 的时齐马尔可夫链，其转移概率为\n$$\nP_{ij}=\\begin{cases}\n\\frac{1}{3},  i\\neq j,\\\\\n0,  i=j.\n\\end{cases}\n$$\n因为对于所有 $i\\neq j$ 都有 $P_{ij}>0$，所以任何状态都可以在一步内从任何其他状态到达，因此该链是不可约的。\n\n为证明其非周期性，我们计算返回概率。对于任意状态 $i$，\n$$\nP^{2}_{ii}=\\sum_{j\\neq i}P_{ij}P_{ji}=3\\cdot \\frac{1}{3}\\cdot \\frac{1}{3}=\\frac{1}{3}>0.\n$$\n对于三步的情况，计算返回路径 $i\\to j\\to k\\to i$ 的数量，其中 $j\\neq i$，$k\\neq j$ 且 $k\\neq i$。共有 $3\\cdot 2=6$ 条这样的路径，每条路径的概率为 $\\left(\\frac{1}{3}\\right)^{3}$，因此\n$$\nP^{3}_{ii}=6\\left(\\frac{1}{3}\\right)^{3}>0.\n$$\n因此，集合 $\\{n\\geq 1:P^{n}_{ii}>0\\}$ 包含 2 和 3，并且 $\\gcd(2,3)=1$，所以周期为 1。该链因此是遍历的（不可约且非周期），这意味着它会收敛到一个唯一的平稳分布。\n\n平稳分布 $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3},\\pi_{4})$ 满足 $\\pi=\\pi P$ 和 $\\sum_{j=1}^{4}\\pi_{j}=1$。根据对称性（或者因为 $P$ 是双随机矩阵，因为其每列都有三个 $\\frac{1}{3}$ 和一个 0），所有分量都相等：令对所有 $j$ 都有 $\\pi_{j}=c$。那么\n$$\n\\sum_{j=1}^{4}\\pi_{j}=4c=1 \\quad \\Rightarrow \\quad c=\\frac{1}{4}.\n$$\n我们也可以直接验证其平稳性：\n$$\n(\\pi P)_{j}=\\sum_{i=1}^{4}\\pi_{i}P_{ij}=c\\sum_{i\\neq j}\\frac{1}{3}=c\\cdot \\frac{3}{3}=c=\\pi_{j}.\n$$\n根据遍历性，对于任意初始分布，\n$$\n\\lim_{n\\to\\infty}\\mathbb{P}(X_{n}=j)=\\pi_{j}.\n$$\n因此，粒子在位置 2 的极限概率是 $\\pi_{2}=\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1348583"}, {"introduction": "我们已经知道，不可约性是保证平稳分布唯一的充分条件，但反过来是否成立呢？这个练习旨在挑战你对马尔可夫链核心定理的逻辑基础进行批判性思考。通过尝试构建反例，你将更深刻地理解马尔可夫链的结构——特别是常返类和瞬时类之间的区别——是如何决定其平稳分布的数量的 [@problem_id:1348575]。", "problem": "在离散时间马尔可夫链的研究中，一条基本定理指出，任何有限状态、不可约的马尔可夫链都有唯一的平稳分布。一位概率论的学生想知道这个命题的逆命题是否成立。\n\n考虑关于具有有限个状态的马尔可夫链的以下论断：\n\n“如果已知一个有限状态马尔可夫链恰好有一个平稳分布，那么该链必定是不可约的。”\n\n以下哪个选项正确地评估了这一论断？\n\nA. 该论断总是正确的。平稳分布的唯一性是不可约性的一个充分条件。\nB. 该论断总是错误的。没有可约链能有唯一的平稳分布。\nC. 该论断是错误的。可以用一个包含多个不同常返通信类的可约链构造出反例。\nD. 该论断是错误的。可以用一个包含恰好一个常返通信类和至少一个暂态的可约链构造出反例。\nE. 该论断仅当链中所有状态都是非周期时才成立。", "solution": "该问题要求我们评估论断：“如果一个有限状态马尔可夫链恰好有一个平稳分布，那么该链必定是不可约的。” 为此，我们需要确定一个可约链是否可能拥有唯一的平稳分布。\n\n让我们首先回顾一下有限状态马尔可夫链（转移矩阵为 $P$）的相关定义。\n- **平稳分布**是一个概率向量 $\\pi$（即其分量非负且和为1），满足 $\\pi P = \\pi$。\n- 如果一个链由单个通信类构成，即从任意状态 $i$ 可以在有限步内到达任意状态 $j$，则该链是**不可约的**。\n- 如果一个链不是不可约的，即它有多个通信类，则该链是**可约的**。\n- 一个通信类可以是**常返的**或**暂态的**。在有限链中，如果我们从一个常返类开始，我们将永远停留在其中。如果我们从一个暂态开始，我们最终离开该状态且永不返回的概率不为零。\n\n已知的定理指出，如果一个链是有限且不可约的，其平稳分布是唯一的。我们正在研究其逆命题。让我们分析可约链中平稳分布的性质。\n\n任何平稳分布 $\\pi$ 都必须将零概率赋给所有暂态。也就是说，如果状态 $i$ 是暂态，那么 $\\pi_i = 0$。这是因为从长远来看（$n \\to \\infty$），处于暂态的概率趋于零，而平稳分布描述的正是这种长期行为。因此，任何平稳分布的支撑集都必须包含在常返状态集内。\n\n让我们考虑一个可约链的结构。它必须至少有两个通信类。根据常返类的数量，我们可以将其分为两种主要情况。\n\n**情况1：链有多个（比如 $k \\ge 2$ 个）常返类。**\n设常返类为 $C_1, C_2, \\dots, C_k$。对于每个常返类 $C_j$，我们可以将其视为一个更小的、自包含的不可约马尔可夫链。因此，每个类 $C_j$ 都有其自己唯一的平稳分布，我们称之为 $\\pi^{(j)}$，其中只有 $C_j$ 内的状态对应的概率非零。我们可以将每个 $\\pi^{(j)}$ 扩展为整个链的平稳分布，方法是将 $C_j$ 之外所有状态的概率设为零。这样我们至少得到 $k$ 个不同的平稳分布：$\\pi^{(1)}, \\pi^{(2)}, \\dots, \\pi^{(k)}$。\n此外，这些分布的任何凸组合，$\\pi = \\alpha_1 \\pi^{(1)} + \\alpha_2 \\pi^{(2)} + \\dots + \\alpha_k \\pi^{(k)}$，其中 $\\alpha_j \\ge 0$ 且 $\\sum \\alpha_j = 1$，也是整个链的有效平稳分布。由于有无限多种方式选择系数 $\\alpha_j$，具有多个常返类的链有无限多个平稳分布，而不是唯一的。\n这个分析表明，如果一个链有唯一的平稳分布，它不可能有多个常返类。这直接驳斥了选项C，该选项建议用这种结构作为反例。这也驳斥了选项B，因为我们尚未排除所有可约链。\n\n**情况2：链恰好有一个常返类和至少一个暂态。**\n设唯一的常返类为 $C_R$，暂态集为 $T$。由于链是可约的，所以 $C_R$ 和 $T$ 都是非空的，并且必须存在至少一条从 $T$ 中的某个状态到 $C_R$ 中某个状态的路径。（否则，$T$ 将包含另一个常返类）。\n如前所述，任何平稳分布 $\\pi$ 都必须对所有 $i \\in T$ 满足 $\\pi_i = 0$。全部的概率质量必须分布在常返类 $C_R$ 上。\n在常返类 $C_R$ 内部，这些状态构成一个不可约子链。根据基本定理，这个不可约子链有一个唯一的平稳分布，我们称之为 $\\pi_R$。\n因此，整个链唯一可能的平稳分布是：对于 $C_R$ 中的状态，其概率由 $\\pi_R$ 给出，而对于 $T$ 中所有状态，其概率为零。这个分布是唯一的。\n\n让我们构建一个具体的反例。考虑一个包含状态 $\\{1, 2, 3\\}$ 的3状态链，其转移矩阵为：\n$$ P = \\begin{pmatrix} 0  1  0 \\\\ 0.5  0.5  0 \\\\ 0  0.5  0.5 \\end{pmatrix} $$\n通信类为 $C_1 = \\{1, 2\\}$ 和 $C_2 = \\{3\\}$。\n从状态3，我们可以到达状态2（$P_{32} = 0.5 > 0$），但从状态1或2，我们永远无法到达状态3。因此，类 $C_1$ 是常返的，而类 $C_2$ 是暂态的。这个链是可约的。\n让我们通过求解 $\\pi = \\pi P$ 来找到平稳分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$。\n1. $\\pi_1 = 0.5 \\pi_2$\n2. $\\pi_2 = \\pi_1 + 0.5 \\pi_2 + 0.5 \\pi_3$\n3. $\\pi_3 = 0.5 \\pi_3 \\implies 0.5 \\pi_3 = 0 \\implies \\pi_3 = 0$。\n正如预期的，暂态的平稳概率为零。\n将 $\\pi_3 = 0$ 代入方程(2)得到 $\\pi_2 = \\pi_1 + 0.5 \\pi_2$，简化为 $0.5 \\pi_2 = \\pi_1$。这与方程(1)相同。\n我们还有归一化条件：$\\pi_1 + \\pi_2 + \\pi_3 = 1$。\n将 $\\pi_1 = 0.5 \\pi_2$ 和 $\\pi_3 = 0$ 代入归一化方程得到 $0.5 \\pi_2 + \\pi_2 + 0 = 1$，这意味着 $1.5 \\pi_2 = 1$，所以 $\\pi_2 = 2/3$。\n然后，$\\pi_1 = 0.5 \\pi_2 = 0.5 (2/3) = 1/3$。\n唯一的平稳分布是 $\\pi = (1/3, 2/3, 0)$。\n\n我们成功地构建了一个拥有**唯一**平稳分布的**可约**链。因此，原论断是**错误**的。\n\n现在我们来评估各个选项：\n- A: 错误。我们的反例证伪了这一点。\n- B: 错误。我们的反例是一个具有唯一平稳分布的可约链。\n- C: 错误。如情况1所示，具有多个常返类的链具有非唯一（实际上是无限个）的平稳分布集。这种结构不能作为反例。\n- D: 正确。该选项正确描述了我们反例的结构以及构建此类反例的一般原则：一个作为所有暂态的“吸收阱”的单一常返类。\n- E: 错误。非周期性与收敛到平稳分布有关，而与它的存在性或唯一性无关。我们反例中的常返类是非周期的（$P_{22}=0.5>0$），但我们也可以构建一个周期的（例如，一个简单的2-循环），整个平稳分布的唯一性仍然成立。\n\n正确的评估是该论断是错误的，一个反例是具有恰好一个常返类的可约链。", "answer": "$$\\boxed{D}$$", "id": "1348575"}]}