## 引言
当一个随机系统随时间演化时，我们最关心的问题之一是其长期行为：它最终会趋于稳定吗？如果会，这种稳定状态是唯一的，还是依赖于初始条件？马尔可夫链为分析这类问题提供了强大的数学框架，而“平稳分布”正是理解其[长期均衡](@entry_id:139043)的关键。然而，[平稳分布的存在性](@entry_id:272084)与唯一性并非理所当然，它依赖于马尔可夫链的深层结构特性。

本文旨在系统地解决这一核心问题。我们将首先在“原理与机制”一章中，严格定义[平稳分布](@entry_id:194199)，并证明对于一类重要的[马尔可夫链](@entry_id:150828)——不[可约链](@entry_id:200553)，其[平稳分布](@entry_id:194199)是唯一的。接着，在“应用与跨学科联系”一章中，我们将探索这一理论如何作为统一的分析工具，在物理学、计算机科学、生物学乃至社会科学中解释和预测复杂系统的长期行为。最后，“实践练习”部分将提供一系列精心设计的问题，帮助读者巩固理论知识并将其应用于具体计算中。通过这三部分的学习，您将对马尔可夫链的长期动态建立起深刻而全面的理解。

## 原理与机制

在对马尔可夫链的初步介绍之后，我们现在转向一个更为深刻和核心的问题：系统的[长期行为](@entry_id:192358)。当一个系统根据马尔可夫规则演化时，它最终会稳定下来吗？如果会，这种稳定状态是唯一的吗？本章将系统地阐述平稳分布的概念，并严格证明对于一类重要的[马尔可夫链](@entry_id:150828)——不[可约链](@entry_id:200553)，其平稳分布不仅存在而且是唯一的。我们将从多个角度探讨这一核心结果，包括代数和概率的双重论证，从而为理解[随机过程](@entry_id:159502)的[长期均衡](@entry_id:139043)奠定坚实的基础。

### 平稳状态：不变的[概率分布](@entry_id:146404)

一个随机系统在[演化过程](@entry_id:175749)中，其状态的[概率分布](@entry_id:146404)通常随时间而改变。然而，在某些条件下，系统可能达到一种统计上的平衡状态，其中状态的[概率分布](@entry_id:146404)不再随时间变化。这种不随[时间演化](@entry_id:153943)的[概率分布](@entry_id:146404)被称为**平稳分布**（stationary distribution）。

形式上，对于一个具有转移[概率矩阵](@entry_id:274812) $P$ 的[离散时间马尔可夫链](@entry_id:263188)，一个行向量 $\pi = (\pi_1, \pi_2, \dots, \pi_N)$ 被称为[平稳分布](@entry_id:194199)，如果它满足以下两个条件：
1.  它是一个[概率分布](@entry_id:146404)：所有分量 $\pi_i \ge 0$，且所有分量之和为1，即 $\sum_{i=1}^{N} \pi_i = 1$。
2.  它在[转移矩阵](@entry_id:145510) $P$ 的作用下保持不变：$\pi P = \pi$。

第二个条件 $\pi P = \pi$ 是平稳性的数学表述。它意味着，如果系统在某个时刻的状态[分布](@entry_id:182848)是 $\pi$，那么在下一个时刻，它的状态[分布](@entry_id:182848)仍然是 $\pi$。从物理直觉上看，$\pi_i$ 代表了系统在长期运行中处于状态 $i$ 的时间比例或概率。

从线性代数的角度来看，方程 $\pi P = \pi$ 揭示了一个深刻的联系：平稳分布 $\pi$ 是转移矩阵 $P$ 的一个**左[特征向量](@entry_id:151813)**，其对应的**[特征值](@entry_id:154894)为1**。因此，寻找平稳分布的问题可以转化为一个寻找特定[特征向量](@entry_id:151813)的代数问题。

### [平稳分布](@entry_id:194199)的计算：一个实践性方法

我们可以通过[求解线性方程组](@entry_id:169069)来计算[平稳分布](@entry_id:194199)。考虑一个具有[状态空间](@entry_id:177074) $S = \{1, 2, 3\}$ 且[转移矩阵](@entry_id:145510)为 $P$ 的[马尔可夫链](@entry_id:150828) [@problem_id:1348553]：
$$ P = \begin{pmatrix} 1/2  1/2  0 \\ 1/2  0  1/2 \\ 0  1  0 \end{pmatrix} $$
平稳分布 $\pi = (\pi_1, \pi_2, \pi_3)$ 必须满足方程 $\pi P = \pi$，即：
$$ (\pi_1, \pi_2, \pi_3) \begin{pmatrix} 1/2  1/2  0 \\ 1/2  0  1/2 \\ 0  1  0 \end{pmatrix} = (\pi_1, \pi_2, \pi_3) $$
这可以展开为三个分量方程：
$$
\begin{cases}
\frac{1}{2}\pi_1 + \frac{1}{2}\pi_2 = \pi_1 \\
\frac{1}{2}\pi_1 + \pi_3 = \pi_2 \\
\frac{1}{2}\pi_2 = \pi_3
\end{cases}
$$
第一个方程化简为 $\pi_1 = \pi_2$。将第三个方程代入第二个方程，得到 $\frac{1}{2}\pi_1 + \frac{1}{2}\pi_2 = \pi_2$，同样得到 $\pi_1 = \pi_2$。这表明该[方程组](@entry_id:193238)中存在冗余。我们可以用 $\pi_2$ 来表示其他分量：$\pi_1 = \pi_2$ 且 $\pi_3 = \frac{1}{2}\pi_2$。

至此，我们找到了满足 $\pi P = \pi$ 的所有解的结构，它们构成了对应于[特征值](@entry_id:154894)1的左[特征空间](@entry_id:638014)。为了得到唯一的[概率分布](@entry_id:146404)，我们必须引入[归一化条件](@entry_id:156486) $\pi_1 + \pi_2 + \pi_3 = 1$。代入上述关系：
$$ \pi_2 + \pi_2 + \frac{1}{2}\pi_2 = 1 \implies \frac{5}{2}\pi_2 = 1 \implies \pi_2 = \frac{2}{5} $$
由此可得 $\pi_1 = \frac{2}{5}$ 和 $\pi_3 = \frac{1}{5}$。因此，该马尔可夫链的唯一平稳分布是 $\pi = (\frac{2}{5}, \frac{2}{5}, \frac{1}{5})$。

在某些情况下，我们可能只关心平稳概率的相对大小。例如，对于一个由参数 $\alpha$ ($0 \lt \alpha \lt 1$) 控制的系统 [@problem_id:1348545]，其平稳方程可能直接给出了分量之间的简单比例关系。考虑从 $\pi_1 = (1-\alpha)\pi_1 + \frac{1}{2}\pi_2$ 这个方程中，我们可以立即推导出 $\alpha \pi_1 = \frac{1}{2} \pi_2$，从而得到比率 $\frac{\pi_2}{\pi_1} = 2\alpha$。这表明，有时我们无需解出完整的[分布](@entry_id:182848)就能获得关于系统长期行为的宝贵洞察。这些计算实践 [@problem_id:1348567] 都建立在一个前提之上：存在一个唯一的解。但这是否总是成立呢？

### 不可约性：唯一性的关键前提

平稳分布并非总是唯一的。考虑一个由六个状态组成的系统，其转移规则如下：状态 $\{1, 2, 3\}$ 构成一个确定性的循环（$1 \to 2 \to 3 \to 1$），而状态 $\{4, 5, 6\}$ 构成另一个独立的确定性循环（$4 \to 5 \to 6 \to 4$）[@problem_id:1348578]。

这个[马尔可夫链](@entry_id:150828)是**可约的**（reducible），因为它不满足**不可约性**（irreducibility）的定义。一个[马尔可夫链](@entry_id:150828)被称为不可约的，当且仅当从任何状态出发，都有可能在有限步内到达任何其他状态。在上述例子中，从状态1出发，永远无法到达状态4。

对于这个[可约链](@entry_id:200553)，我们可以找到多个平稳分布。例如，[分布](@entry_id:182848) $\pi^{(1)} = (\frac{1}{3}, \frac{1}{3}, \frac{1}{3}, 0, 0, 0)$ 是一个[平稳分布](@entry_id:194199)，因为它将所有概率[质量集中](@entry_id:175432)在第一个循环上。同样，$\pi^{(2)} = (0, 0, 0, \frac{1}{3}, \frac{1}{3}, \frac{1}{3})$ 也是一个[平稳分布](@entry_id:194199)。更进一步，这两个[分布](@entry_id:182848)的任意**[凸组合](@entry_id:635830)**，例如 $\alpha \pi^{(1)} + (1-\alpha) \pi^{(2)}$ 对于任何 $\alpha \in [0, 1]$，都是一个有效的[平稳分布](@entry_id:194199)。例如，当 $\alpha = \frac{3}{4}$ 时，我们得到 $\pi = (\frac{1}{4}, \frac{1}{4}, \frac{1}{4}, \frac{1}{12}, \frac{1}{12}, \frac{1}{12})$。这表明，对于[可约链](@entry_id:200553)，平稳分布可能构成一个无穷集。

这个反例凸显了不可约性的重要性。它保证了整个[状态空间](@entry_id:177074)是相互连通的，从而排除了概率质量被“困在”系统某个部分的可能性。正是这种全局连通性，奠定了平稳[分布唯一性](@entry_id:186911)的基础。

### 唯一性证明：两种视角

现在我们陈述[马尔可夫链](@entry_id:150828)理论中的一个基石性定理：**任何具有有限[状态空间](@entry_id:177074)的不可约[马尔可夫链](@entry_id:150828)，都存在一个唯一的[平稳分布](@entry_id:194199)。** 我们将从两个不同的角度来理解和证明这个深刻的结论。

#### 线性代数论证：[特征空间](@entry_id:638014)的维度

如前所述，[平稳分布](@entry_id:194199)是[转移矩阵](@entry_id:145510) $P$ 对应于[特征值](@entry_id:154894)1的归一化左[特征向量](@entry_id:151813)。因此，[平稳分布的唯一性](@entry_id:264255)等价于证明这个左特征空间的维度为1。

一个严谨的代数论证可以借助著名的[Perron-Frobenius定理](@entry_id:138708)，但我们也可以通过一个更直接的构造来理解其核心思想 [@problem_id:1348581]。考虑矩阵 $M = P^T - I$，其中 $P^T$ 是 $P$ 的[转置](@entry_id:142115)，$I$ 是单位矩阵。

一个向量 $\pi^T$ 是 $P^T$ 对应于[特征值](@entry_id:154894)1的右[特征向量](@entry_id:151813)（即 $P^T \pi^T = \pi^T$），当且仅当它位于矩阵 $M$ 的核（kernel）或[零空间](@entry_id:171336)中（即 $M \pi^T = \mathbf{0}$）。由于矩阵的左右[特征值](@entry_id:154894)相同，其左、右特征空间的维度也必然相等。因此，证明[平稳分布的唯一性](@entry_id:264255)，等价于证明矩阵 $M$ 的核空间维度为1，即 $\dim(\ker(M)) = 1$。

对于任何不可约的[有限马尔可夫链](@entry_id:264809)，理论保证了其[平稳分布](@entry_id:194199)是唯一的。这意味着满足 $\pi P = \pi$ 和[归一化条件](@entry_id:156486)的向量 $\pi$ 是唯一的。这反过来就要求了对应于[特征值](@entry_id:154894)1的左[特征空间](@entry_id:638014)必须是一维的。因此，$\dim(\ker(M))$ 必然为1。

根据线性代数中的**秩-零度定理**（Rank-Nullity Theorem），对于一个 $N \times N$ 的矩阵 $M$，我们有：
$$ \text{rank}(M) + \dim(\ker(M)) = N $$
既然我们已经从[平稳分布的唯一性](@entry_id:264255)论证了 $\dim(\ker(M)) = 1$，那么我们可以立即得出结论：
$$ \text{rank}(M) = N - 1 $$
这个结论为[平稳分布的唯一性](@entry_id:264255)提供了一个坚实的代[数基](@entry_id:634389)础。它将一个概率问题（唯一均衡）转化为了一个关于[矩阵秩](@entry_id:153017)的精确陈述。

#### 概率论证：平均返回时间

除了代数方法，我们还可以从一个更具物理直觉的概率角度来证明唯一性 [@problem_id:1348554]。这个论证的核心是**平均返回时间**（mean recurrence time）的概念。

对于不[可约链](@entry_id:200553)中的任意状态 $i$，假设系统从状态 $i$ 出发，我们定义 $m_i$ 为首次返回状态 $i$ 所需的平均步数。由于链是不可约且有限的，所有状态都是[正常返](@entry_id:195139)的（positive recurrent），这意味着每个 $m_i$ 都是有限的。重要的是，$m_i$ 是由[转移矩阵](@entry_id:145510) $P$ 唯一确定的内在属性。

遍历理论中的一个基本结果（可由更新-回报定理导出）指出，对于一个不可约马尔可夫链，无论其初始状态如何，系统在长期运行中处于状态 $i$ 的时间比例，恰好等于其平均返回时间的倒数，即 $1/m_i$。

另一方面，[平稳分布](@entry_id:194199)的分量 $\pi_i$ 的物理解释正是系统处于状态 $i$ 的长期时间比例。因此，我们必然有以下等式：
$$ \pi_i = \frac{1}{m_i} $$
这个关系式为唯一性提供了强有力的论证。因为每个平均返回时间 $m_i$ 都由转移矩阵 $P$ 唯一确定，所以每个平稳概率 $\pi_i$ 也必须被唯一确定。因此，不可能存在两个不同的向量 $\mathbf{v}$ 和 $\mathbf{w}$ 同时作为该链的平稳分布。如果存在，它们的每个分量都必须等于 $1/m_i$，从而 $\mathbf{v} = \mathbf{w}$。这个论证巧妙地将[平稳分布的唯一性](@entry_id:264255)追溯到了系统动力学（由 $P$ 决定）的内在时间尺度。

### 唯一平稳分布的性质

既然我们已经确定了不[可约链](@entry_id:200553)存在唯一的[平稳分布](@entry_id:194199)，那么这个[分布](@entry_id:182848)本身具有什么性质呢？一个至关重要的性质是**严格正性**（strict positivity）。

对于一个有限不可约马尔可夫链，其唯一的[平稳分布](@entry_id:194199) $\pi$ 的所有分量都严格大于零，即对所有状态 $i$，都有 $\pi_i > 0$。

这个性质的直观解释是，由于链是不可约的，系统可以从任何状态到达任何其他状态。因此，在长期运行中，系统不可能完全不访问任何一个状态。每个状态都会以一定的正概率被访问，因此其长期占据比例必须是正的。

这个性质也提供了一个有力的诊断工具。如果有人声称找到了一个不[可约链](@entry_id:200553)的平稳分布，但其中某个分量为零（例如，$v_j = 0$）[@problem_id:1348557]，那么这个论断必然存在矛盾。一个包含零分量的平稳分布意味着概率质量无法到达状态 $j$，这直接违反了不可约性的定义。因此，我们可以断定，该链必定是可约的。

### 一个强大的捷径：[细致平衡条件](@entry_id:265158)

[求解线性方程组](@entry_id:169069) $\pi P = \pi$ 可能是繁琐的。在许多应用中，一个更强的条件——**[细致平衡条件](@entry_id:265158)**（detailed balance condition）——提供了一个寻找平稳分布的优雅捷径。

一个[分布](@entry_id:182848) $\pi$ 和一个转移矩阵 $P$ 被认为满足[细致平衡条件](@entry_id:265158)，如果对于所有状态对 $(i, j)$，以下等式成立：
$$ \pi_i p_{ij} = \pi_j p_{ji} $$
这个等式的物理解释是，在平稳状态下，从状态 $i$ 流向状态 $j$ 的“[概率流](@entry_id:150949)”恰好等于从状态 $j$ 反向流回状态 $i$ 的“[概率流](@entry_id:150949)”。满足此条件的[马尔可夫链](@entry_id:150828)被称为**时间可逆的**（time-reversible）。

细致平衡是一个比[平稳性](@entry_id:143776)更强的条件。如果一个[分布](@entry_id:182848) $\pi$ 满足细致平衡，那么它必然是一个平稳分布。我们可以通过对 $i$ 求和来验证这一点：
$$ \sum_{i} \pi_i p_{ij} = \sum_{i} \pi_j p_{ji} = \pi_j \sum_{i} p_{ji} = \pi_j \cdot 1 = \pi_j $$
这正是平稳方程 $(\pi P)_j = \pi_j$。

这一事实极为有用。对于一个不[可约链](@entry_id:200553)，如果我们能找到一个满足[细致平衡条件](@entry_id:265158)的[分布](@entry_id:182848) $\pi$，那么由于该[分布](@entry_id:182848)必然是平稳的，而不[可约链](@entry_id:200553)的平稳分布又是唯一的，所以我们找到的 $\pi$ **必定是**那个唯一的[平稳分布](@entry_id:194199) [@problem_id:1348566]。在许多情况下，尤其是复杂的系统中（如统计物理中的模型和计算统计中的[MCMC算法](@entry_id:751788)），直接验证细致平衡比求解完整的[线性方程组](@entry_id:148943)要简单得多。

### 关于收敛性的注记

最后，需要区分**平稳分布**和**[极限分布](@entry_id:174797)**（limiting distribution）的概念。[平稳分布](@entry_id:194199)是一种不变性：如果系统以[分布](@entry_id:182848) $\pi$ 开始，它将永远保持在[分布](@entry_id:182848) $\pi$。[极限分布](@entry_id:174797)则是指无论初始状态如何，当时间趋于无穷时，系统状态的[分布](@entry_id:182848)所收敛到的那个[分布](@entry_id:182848)。

对于有限、不可约且**非周期**（aperiodic）的[马尔可夫链](@entry_id:150828)（非周期性直观上意味着链的运动不存在严格的周期性循环），[极限分布](@entry_id:174797)存在且等于其唯一的平稳分布。这就是为什么平稳分布通常被称为“长期[分布](@entry_id:182848)”或“均衡[分布](@entry_id:182848)”的原因。它不仅描述了一个不变的统计状态，而且是系统在长[时间演化](@entry_id:153943)后实际会达到的状态。

综上所述，不可约性保证了马尔可夫链拥有一个唯一的统计均衡点，而这个均衡点可以通过多种方式被理解和计算。这一深刻的结论是现代概率论和众多应用领域的基石。