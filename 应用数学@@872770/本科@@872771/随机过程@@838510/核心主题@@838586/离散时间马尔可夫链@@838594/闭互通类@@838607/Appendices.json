{"hands_on_practices": [{"introduction": "理论学习的最佳方式是付诸实践。本节我们从一个模拟工厂生产线的具体例子开始，这个场景直观地展示了系统中的不同部分是如何相互关联或相互隔离的。通过分析一个产品在装配、测试和回收等不同阶段的流转，你将练习如何识别瞬时状态、闭通信类以及吸收态，这些都是理解马尔可夫链长期行为的基础。[@problem_id:1289515]", "problem": "一家工厂针对一种新型电子设备的质量保证流程被建模为一个离散时间马尔可夫链。该流程中一个设备的状态由以下六种可能的状态之一来描述：\n\n*   状态 1：初始装配\n*   状态 2：初步测试\n*   状态 3：最终处理\n*   状态 4：回收站 Alpha\n*   状态 5：回收站 Beta\n*   状态 6：已发货\n\n状态之间的转移遵循以下规则：\n*   处于“初始装配”（状态 1）的设备总是进入“初步测试”（状态 2）。\n*   从“初步测试”（状态 2）开始，设备有 75% 的概率通过并转移到“最终处理”（状态 3）。它有 25% 的概率未通过测试并被送到“回收站 Alpha”（状态 4）。\n*   到达“最终处理”（状态 3）的设备总是被送到“已发货”状态（状态 6）。\n*   一旦设备进入回收线（状态 4 或 5），它就再也不会返回主生产线（状态 1、2 或 3）或已发货状态（状态 6）。具体来说，在“回收站 Alpha”（状态 4）的设备总是被移至“回收站 Beta”（状态 5）进行进一步处理。在“回收站 Beta”（状态 5）的设备总是被送回“回收站 Alpha”（状态 4）。\n*   处于“已发货”状态（状态 6）的设备已完成流程，并将无限期地保持在该状态。\n\n一个互通类是一个状态集合，其中从集合中的任何状态都可以到达集合中的任何其他状态。如果一个过程一旦进入某个互通类就永远不能离开，那么该互通类被称为闭合的。以下哪个选项代表了属于任何闭合互通类的所有状态的完整集合？\n\nA. {1, 2, 3}\n\nB. {4, 5}\n\nC. {6}\n\nD. {4, 5, 6}\n\nE. {1, 3, 6}", "solution": "我们将该过程建模为一个离散时间马尔可夫链，其状态为 $\\{1,2,3,4,5,6\\}$，转移如下：\n- $1 \\to 2$ 的概率为 $1$。\n- $2 \\to 3$ 的概率为 $\\frac{3}{4}$，$2 \\to 4$ 的概率为 $\\frac{1}{4}$。\n- $3 \\to 6$ 的概率为 $1$。\n- $4 \\to 5$ 的概率为 $1$。\n- $5 \\to 4$ 的概率为 $1$。\n- $6 \\to 6$ 的概率为 $1$。\n\n定义：一个互通类是一个状态集合，其中每个状态都可以到达集合中的任何其他状态（相互可达）。如果从类中任何状态出发的转移都不会指向类外的状态，则该类是闭合的。\n\n分析候选类：\n- $\\{4,5\\}$：我们有 $4 \\to 5$ 和 $5 \\to 4$，因此 $4$ 和 $5$ 互通。没有从 $\\{4,5\\}$ 到 $\\{4,5\\}$ 之外任何状态的转移，所以 $\\{4,5\\}$ 是一个闭合互通类。\n- $\\{6\\}$：状态 $6$ 只转移到自身，因此它与自身互通，并且没有向外的转移；因此 $\\{6\\}$ 是一个闭合互通类。\n- $\\{1,2,3\\}$：不是闭合的，因为 $2 \\to 4$ 的概率为正，且 $3 \\to 6$ 的概率为 $1$，所以可以离开该类。\n\n因此，属于任何闭合互通类的所有状态的完整集合是并集 $\\{4,5\\} \\cup \\{6\\} = \\{4,5,6\\}$，这对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1289515"}, {"introduction": "掌握了基础概念后，让我们挑战一个更抽象的问题，它的状态空间不再是几个孤立的点，而是由所有可能图形构成的庞大集合。这个问题将引导你思考如何在一个巨大的、结构化的状态空间中证明连通性和封闭性。解决这个问题的关键不在于逐一检查状态，而在于运用图论原理来论证状态之间的可达性，从而将“闭通信类”的概念应用到更复杂的系统中。[@problem_id:1289467]", "problem": "考虑一个系统，其状态是定义在一个固定的 $n$ 个顶点的集合 $V = \\{v_1, v_2, \\dots, v_n\\}$ 上的一个简单图。状态空间 $\\mathcal{G}_n$ 是所有这类图的集合。一个离散时间马尔可夫链通过以下转移规则定义在该状态空间上：\n\n在每个时间步，给定当前图为 $G_t$：\n1. 从 $\\binom{n}{2}$ 个可能的顶点对中均匀随机地选择一对不同的顶点 $\\{u, v\\}$。\n2. 如果边 $(u, v)$ 存在于 $G_t$ 中，则尝试向图 $G_{t+1} = G_t \\setminus \\{(u,v)\\}$ 转移。当且仅当边 $(u,v)$ 在 $G_t$ 中不是桥时，此转移才会发生。如果 $(u,v)$ 是一个桥，则不发生任何变化，且 $G_{t+1} = G_t$。（如果移除一条边会增加图的连通分量的数量，则该边是桥）。\n3. 如果边 $(u, v)$ 不存在于 $G_t$ 中，则发生向图 $G_{t+1} = G_t \\cup \\{(u,v)\\}$ 的转移。\n\n令 $\\mathcal{C}_n \\subseteq \\mathcal{G}_n$ 为所有在 $n$ 个顶点上的连通图的子集。对于任意整数 $n \\ge 1$，下列哪个陈述正确描述了在此马尔可夫链下集合 $\\mathcal{C}_n$ 的性质？\n\nA. 对于任意 $n \\ge 1$，$\\mathcal{C}_n$ 构成一个单一的、闭合的互通类。\n\nB. 对于任意 $n \\ge 1$，$\\mathcal{C}_n$ 是一个互通类，但它不是一个闭集。\n\nC. 对于任意 $n \\ge 1$，$\\mathcal{C}_n$ 是一个闭集，但对于 $n \\ge 3$，它会划分为多个不同的互通类。\n\nD. $\\mathcal{C}_n$ 的性质根据 $n  3$ 还是 $n \\ge 3$ 而变化；它仅在 $n  3$ 时是单一的闭合互通类。", "solution": "我们分析在所有简单图（基于固定的顶点集 $V=\\{v_{1},\\dots,v_{n}\\}$）的状态空间 $\\mathcal{G}_{n}$ 上的马尔可夫链，其每一步的转移定义如下：从 $\\binom{n}{2}$ 个顶点对中均匀选择一对 $\\{u,v\\}$；如果 $(u,v)\\in E(G_{t})$，则尝试删除它，并且当且仅当 $(u,v)$ 在 $G_{t}$ 中不是桥时才实际删除它；如果 $(u,v)\\notin E(G_{t})$，则添加它。令 $\\mathcal{C}_{n}\\subseteq\\mathcal{G}_{n}$ 表示连通图的集合。\n\n论断1：对于所有 $n\\geq 1$，$\\mathcal{C}_{n}$ 是闭合的。\n令 $G\\in\\mathcal{C}_{n}$，因此 $G$ 是连通的，等价地，$c(G)=1$，其中 $c(G)$ 表示连通分量的数量。考虑从 $G$ 出发的任意一步转移：\n- 如果选择了一条不存在的边 $(u,v)$，则 $G_{t+1}=G\\cup\\{(u,v)\\}$，该图是连通的，因为增加一条边不会增加 $c(\\cdot)$ 的值，也不会使一个连通图变得不连通。因此 $c(G_{t+1})=1$。\n- 如果选择了一条存在的边 $(u,v)$ 且它不是桥，那么根据非桥的定义，$G_{t+1}=G\\setminus\\{(u,v)\\}$ 仍然是连通的（移除一个非桥不会增加 $c(\\cdot)$；特别地，$c(G\\setminus\\{(u,v)\\})=c(G)=1$）。\n- 如果选择了一条存在的边 $(u,v)$ 且它是一个桥，则不发生任何变化，因此 $G_{t+1}=G$ 并且仍然是连通的。\n在所有情况下，从 $G\\in\\mathcal{C}_{n}$ 出发，我们都有 $G_{t+1}\\in\\mathcal{C}_{n}$。因此 $\\mathcal{C}_{n}$ 是闭合的。\n\n论断2：对于所有 $n\\geq 1$，$\\mathcal{C}_{n}$ 是一个单一的互通类。\n固定任意 $G,H\\in\\mathcal{C}_{n}$。我们展示一条从 $G$ 到 $H$ 的、具有正概率的允许转移路径，该路径全程保持在 $\\mathcal{C}_{n}$ 中。\n\n步骤2.1：从 $G$ 到完全图 $K_{n}$。令 $E(G)$ 表示 $G$ 的边集。对于每条边 $e\\in E(K_{n})\\setminus E(G)$，当它不存在时，选择其端点对；根据链的规则，转移 $G\\mapsto G\\cup\\{e\\}$ 会发生。对所有缺失的边重复此操作，会产生一个有限的加边序列，最终得到 $K_{n}$。在每一步中，每个选定的点对都有 $\\frac{1}{\\binom{n}{2}}$ 的概率，因此这个特定的序列以正概率发生。根据论断1中的论证，每一步都保持了连通性。\n\n步骤2.2：通过只删除不在 $H$ 中的边，从 $K_{n}$ 到 $H$。考虑要移除的边集 $F=E(K_{n})\\setminus E(H)$。我们以任意顺序逐一移除 $F$ 中的边，从不尝试删除 $H$ 中的边。在每个中间步骤，当前图都包含 $H$ 作为其一个连通的生成子图。对于在中间步骤中存在的任意边 $e=\\{x,y\\}\\in F$，由于 $H$ 是连通的，存在一条完全在 $H$ 中的 $x-y$ 路径。因此，$e$ 位于由 $e$ 和该路径形成的环上，这意味着 $e$ 在当前图中不是桥。因此链允许删除它。重复此过程，在有限步后得到 $H$。和之前一样，选择此序列中的特定点对具有正概率，并且每一步都保持了连通性。\n\n结合步骤2.1和2.2，$H$ 可以从 $G$ 以正概率到达，同时保持在 $\\mathcal{C}_{n}$ 中。根据对称性（或通过交换 $G$ 和 $H$ 重复此构造），$\\mathcal{C}_{n}$ 中的任意两个状态都是互通的。因此，$\\mathcal{C}_{n}$ 是一个互通类。\n\n边界情况：对于 $n=1$，$\\mathcal{C}_{1}$ 只包含一个没有边的（连通）图，这显然是一个闭合的互通类。对于 $n=2$，$\\mathcal{C}_{2}$ 只包含一个有一条边的连通图；这条边是一个桥，所以不会发生删除，也没有其他可添加的边，使其成为一个闭合的单元素互通类。这些情况与上述论证是一致的。\n\n因此，对于每个 $n\\geq 1$，$\\mathcal{C}_{n}$ 构成一个单一的、闭合的互通类。因此选项A是正确的，而选项B、C和D则不正确。", "answer": "$$\\boxed{A}$$", "id": "1289467"}, {"introduction": "最后，我们来看一个展示了随机过程与抽象代数之间深刻联系的高级问题。在这个马尔可夫链中，状态转移由模算术下的乘法定义，其背后的结构远比表面看起来更丰富。通过解决这个问题，你将学会如何利用数论中的不变量（如最大公约数）来精确地划分状态空间，并确定所有闭通信类的数量。这不仅是对马尔可夫链理论的考验，也是一次跨学科思维的精彩实践。[@problem_id:1289484]", "problem": "考虑一个定义在状态空间 $S = \\{0, 1, 2, \\ldots, 719\\}$ 上的离散时间马尔可夫链。其转移遵循以下规则：在每个时间步，如果系统的当前状态为 $i \\in S$，则从集合 $\\{1, 2, \\ldots, 719\\}$ 中所有与 $720$ 互质的整数中均匀随机地选择一个整数 $k$。系统的下一个状态由 $j = (i \\cdot k) \\pmod{720}$ 给出。\n\n在此马尔可夫链的背景下：\n1.  如果状态 $v$ 可从 $u$ 到达，且状态 $u$ 可从 $v$ 到达，则称两个状态 $u$ 和 $v$ **互通**。这种关系将状态空间 $S$ 划分成若干个不相交的等价类，称为**互通类**。\n2.  如果一旦链进入状态集 $C \\subseteq S$，它就永远不能离开，则称该集合是**闭集**。也就是说，对于任何状态 $i \\in C$，转移到 $C$ 之外任何状态的概率为零。\n\n一个**闭互通类**是指既是互通类又是闭集。\n\n确定此马尔可夫链的不同闭互通类的总数。", "solution": "令 $U(720)$ 表示模 $720$ 的单位元集合，即 $U(720)=\\{k \\in \\{1,\\ldots,719\\} : \\gcd(k,720)=1\\}$。转移规则为\n$$\nX_{n+1} \\equiv X_{n}\\cdot K \\pmod{720}, \\quad K \\in U(720) \\text{ 均匀选取}.\n$$\n因此，该链是群 $U(720)$ 在 $\\mathbb{Z}/720\\mathbb{Z}$ 上的乘法作用。\n\n首先，状态 $0$ 是吸收态，因为对于每个 $k \\in U(720)$，\n$$\n0 \\cdot k \\equiv 0 \\pmod{720}.\n$$\n因此 $\\{0\\}$ 是一个闭互通类。\n\n接下来，固定任意状态 $i \\in \\{1,\\ldots,719\\}$，并令 $d=\\gcd(i,720)$。写作 $i=d t$ 和 $720=d m$，其中 $\\gcd(t,m)=1$。对于任何 $k \\in U(720)$，我们有 $\\gcd(k,720)=1$，这意味着 $\\gcd(k,m)=1$。那么\n$$\n\\gcd(i\\cdot k,720)=\\gcd(d t \\cdot k, d m)=d\\cdot \\gcd(t k, m)=d,\n$$\n因为 $\\gcd(t,m)=1$ 和 $\\gcd(k,m)=1$ 蕴含 $\\gcd(tk,m)=1$。因此，量 $\\gcd(X_{n},720)$ 在转移下是不变的。因此，对于 $720$ 的每个约数 $d$，子集\n$$\nR_{d}=\\{i \\in \\{0,\\ldots,719\\} : \\gcd(i,720)=d\\}\n$$\n是闭集：从 $R_{d}$ 开始，链将始终保持在 $R_{d}$ 中。\n\n我们现在证明，对于每个 $d \\mid 720$ 的 $R_d$ 都是一个单独的互通类。令 $i=d t$ 和 $j=d s$ 为 $R_d$ 中的两个状态，因此 $\\gcd(t,m)=\\gcd(s,m)=1$，其中 $m=720/d$。我们寻找 $k \\in U(720)$ 使得\n$$\nj \\equiv i \\cdot k \\pmod{720}.\n$$\n两边除以 $d$，这等价于\n$$\ns \\equiv t \\cdot k \\pmod{m}.\n$$\n因为模 $m$ 的约化给出了一个满群同态 $U(720) \\to U(m)$（通过中国剩余定理，在每个素数幂因子上是分量上满射的，并且对于每个素数幂 $p^{\\alpha}$，通过选择不被 $p$ 整除的代表元，约化 $U(p^{\\alpha}) \\to U(p^{\\beta})$ 对 $\\beta \\leq \\alpha$ 是满射的），所以存在一个 $k \\in U(720)$，其在 $U(m)$ 中的像等于 $t^{-1}s$。因此 $k \\equiv t^{-1}s \\pmod{m}$，所以 $s \\equiv t k \\pmod{m}$，这可以提升为 $j \\equiv i k \\pmod{720}$。因此 $j$ 可从 $i$ 在一步之内到达。通过对称性（使用 $k^{-1}$），$i$ 也可从 $j$ 到达。所以 $R_{d}$ 是一个互通类。\n\n由于每次转移都保持 $d=\\gcd(\\cdot,720)$ 不变，所以在不同的 $R_d$ 之间不存在转移，因此每个 $R_d$ 也是闭集。闭互通类恰好是当 $d$ 取遍 $720$ 的所有正约数时的 $R_d$ 集合。\n\n剩下的就是计算 $720$ 的正约数的数量。分解因数\n$$\n720=2^{4}\\cdot 3^{2}\\cdot 5^{1},\n$$\n所以正约数的数量是\n$$\n(4+1)(2+1)(1+1)=30.\n$$\n因此，共有 $30$ 个不同的闭互通类。", "answer": "$$\\boxed{30}$$", "id": "1289484"}]}