{"hands_on_practices": [{"introduction": "这个练习将引导你直接应用正常返的定义。通过计算返回基态的平均时间，我们可以直接判断系统是否会稳定地回到初始状态，这是理解正常返最直观的方法。这个问题 [@problem_id:1323959] 展示了一个非最近邻随机游动，但其结构简单，足以让我们精确计算首次返回时间的分布。", "problem": "一个粒子的能级被建模为非负整数集 $\\{0, 1, 2, \\dots\\}$ 上的一个离散时间随机过程。从任意能级 $i \\ge 0$ 出发，粒子以固定的概率 $p$ 跃迁到能级 $i+2$。并以互补概率 $1-p$ 衰变到基态（能级 0）。概率 $p$ 是一个常数，其范围为 $0  p  1$。\n\n下列哪个陈述正确地对基态（能级 0）进行了分类？\n\nA. 能级 0 是一个瞬态。\nB. 能级 0 是一个零常返态。\nC. 能级 0 是一个正常返态。\nD. 能级 0 的分类取决于 $p  1/2$ 还是 $p \\ge 1/2$。\nE. 只有当 $p$ 是有理数时，能级 0 的分类才有明确定义。", "solution": "为了确定状态0的分类，我们计算其平均返回时间 $\\mu_0$。根据定义，平均返回时间是系统从状态0出发，首次返回状态0所需的平均步数。\n\n一个返回过程包含两个阶段：\n1.  系统必须首先离开状态0。根据转移规则，从状态0出发，系统以概率 $p$ 跃迁到状态2。这一步需要1个时间单位。（注：以概率 $1-p$ 跃迁回状态0不算作一次“返回”，因为它从未离开。）\n2.  一旦系统处于状态2，我们需要计算它首次到达状态0所需的平均时间。我们令 $\\tau_i$ 为从状态 $i$ 出发首次到达状态0所需的平均时间（即平均击中时间）。我们要求解的是 $\\tau_2$。\n\n我们可以对所有不为0的状态 $i$ 应用一步分析来求解 $\\tau_i$。从任何状态 $i \\ne 0$ 出发，系统在下一步到达状态0的概率是 $1-p$，或者以概率 $p$ 移动到状态 $i+2$。因此：\n$$ \\tau_i = 1 \\cdot (1-p) + (1 + \\tau_{i+2}) \\cdot p = 1 + p \\cdot \\tau_{i+2} $$\n由于转移规则不依赖于具体的能级 $i$（只要 $i \\ne 0$），所有从非零状态开始的平均击中时间 $\\tau_i$ 都是相同的。令 $\\tau = \\tau_i$ 对所有 $i \\ne 0$ 成立。将此代入上式：\n$$ \\tau = 1 + p \\cdot \\tau $$\n解这个关于 $\\tau$ 的方程，我们得到：\n$$ \\tau(1-p) = 1 \\implies \\tau = \\frac{1}{1-p} $$\n这个结果是有限的，因为 $0  p  1$。\n\n总的平均返回时间 $\\mu_0$ 是离开状态0的时间（1步）加上从状态2返回0的平均时间 $\\tau_2$：\n$$ \\mu_0 = 1 + \\tau_2 = 1 + \\frac{1}{1-p} $$\n由于 $0  p  1$，分母 $1-p$ 大于0，所以 $\\mu_0$ 是一个有限的正数。\n\n因为平均返回时间 $\\mu_0$ 是有限的，所以状态0是正常返态。", "answer": "$$\\boxed{C}$$", "id": "1323959"}, {"introduction": "对于一类重要的马尔可夫链——生灭过程，我们有一个强大的判别工具。这个练习 [@problem_id:1324014] 将向你展示如何利用一个求和判据来确定链的返始性，这通常比直接计算返回时间要简洁得多。通过构建和分析一个特定的级数，我们可以判断系统是否存在一个稳定的长期分布。", "problem": "一个粒子在非负整数集 $S = \\{0, 1, 2, \\dots\\}$ 上进行随机游走。粒子的运动由一个依赖于状态的概率所支配。当粒子处于状态 $n \\in S$ 时，它以概率 $p_n$ 移动到状态 $n+1$，如果 $n  0$，它以概率 $1-p_n$ 移动到状态 $n-1$。在状态 $0$，粒子总是移动到状态 $1$。概率 $p_n$ 由函数 $p_n = \\exp(-n)$ 定义，对所有 $n \\ge 0$ 成立。\n\n确定该马尔可夫链各状态的分类。\nA. 暂留的\nB. 零常返的\nC. 正常返的\nD. 状态的分类不同；一些是常返的，一些是暂留的。", "solution": "设 $S=\\{0,1,2,\\dots\\}$，且该链为生灭链，其向上转移概率为 $p_{n}=\\exp(-n)$ 对所有 $n\\geq 0$ 成立，向下转移概率为 $q_{n}=1-p_{n}$ 对 $n\\geq 1$ 成立（其中 $q_{0}=0$）。在状态 $0$，链以概率 $1$ 移动到状态 $1$，这与 $p_{0}=\\exp(0)=1$ 一致。\n\n首先，该链是不可约的：对于任意 $n\\geq 1$，$q_{n}=1-\\exp(-n)0$ 且 $p_{n}0$，因此从任何状态 $i$ 都可以通过连续的向下移动以正概率到达状态 $0$，并且从状态 $0$ 可以通过连续的向上移动以概率 $\\prod_{k=0}^{j-1}p_{k}0$ 到达任何状态 $j$。\n\n对于 $S$ 上的一个生灭链，其中对所有 $n$ 有 $p_{n}0$ 且对所有 $n\\geq 1$ 有 $q_{n}0$，一个标准判据表明，如果\n$$\nS:=\\sum_{n=0}^{\\infty}w_{n}  \\infty,\\quad\\text{其中}\\quad w_{0}=1,\\quad w_{n}=\\prod_{k=1}^{n}\\frac{p_{k-1}}{q_{k}},\n$$\n则存在一个平稳分布，由 $\\pi_{n}=w_{n}/S$ 给出，并且该链是正常返的；如果链是不可约的且 $S=\\infty$，则不存在有限的平稳分布，该链是零常返或暂留的，具体取决于进一步的条件。\n\n这里计算 $w_{n}$：\n$$\nw_{n}=\\prod_{k=1}^{n}\\frac{p_{k-1}}{q_{k}}=\\prod_{k=1}^{n}\\frac{\\exp(-(k-1))}{1-\\exp(-k)}.\n$$\n我们证明 $\\sum_{n=0}^{\\infty}w_{n}  \\infty$。考虑比值\n$$\n\\frac{w_{n+1}}{w_{n}}=\\frac{p_{n}}{q_{n+1}}=\\frac{\\exp(-n)}{1-\\exp(-(n+1))}.\n$$\n当 $n\\to\\infty$ 时，$\\exp(-(n+1))\\to 0$，所以 $1-\\exp(-(n+1))\\to 1$，因此\n$$\n\\lim_{n\\to\\infty}\\frac{w_{n+1}}{w_{n}}=\\lim_{n\\to\\infty}\\exp(-n)=0.\n$$\n因此，根据比值判别法，$\\sum_{n=0}^{\\infty}w_{n}$ 收敛。\n\n或者，对所有 $k\\geq 1$，$1-\\exp(-k)\\geq 1-\\exp(-1)$，所以\n$$\nw_{n}\\leq\\prod_{k=1}^{n}\\frac{\\exp(-(k-1))}{1-\\exp(-1)}=(1-\\exp(-1))^{-n}\\exp\\!\\left(-\\sum_{k=1}^{n}(k-1)\\right)=(1-\\exp(-1))^{-n}\\exp\\!\\left(-\\frac{n(n-1)}{2}\\right),\n$$\n且右侧项关于 $n$ 是可求和的。\n\n因为 $S  \\infty$，存在平稳分布，且该链是正常返的。因为该链是不可约的，所有状态都具有相同的分类，即正常返。\n\n因此，正确的分类是选项 C。", "answer": "$$\\boxed{C}$$", "id": "1324014"}, {"introduction": "当马尔可夫链的行为更为复杂时，我们可以通过分析其“漂移”来判断其长期行为。这个练习 [@problem_id:1323998] 将介绍 Foster-Lyapunov 判据，通过考察系统状态的期望变化，来判断链是否为正常返或零常返。这种方法非常通用，因为它关注的是系统远离原点时的平均趋势，为我们提供了一个强大的分析工具。", "problem": "一个人的财务储蓄可以被建模为一个离散时间马尔可夫链 $\\{X_n, n \\ge 0\\}$，其中 $X_n$ 表示在第 $n$ 个月末的储蓄金额，以整数单位计。状态空间为非负整数集合 $\\{0, 1, 2, ...\\}$。每个月储蓄变化的规则如下：\n\n- 每个月，此人以固定的概率 $p$ 决定多储蓄一个单位。\n- 如果当前储蓄至少为2个单位，此人可能会决定花费2个单位，此事件发生的固定概率为 $q$。这个花费决定与储蓄决定是独立的。\n- 如果这两个事件都没有发生，储蓄保持不变。\n\n我们来形式化转移概率。从状态 $i$ 出发：\n- 对于 $i=0$ 或 $i=1$：储蓄只能以概率 $p$ 增加1（到 $i+1$），或者以概率 $1-p$ 保持不变（在 $i$）。此时没有花费的选项。\n- 对于 $i \\ge 2$：储蓄以概率 $p$ 增加1（到 $i+1$），以概率 $q$ 减少2（到 $i-2$），或者以概率 $1-p-q$ 保持不变（在 $i$）。\n\n假设 $p \\in (0,1)$，$q \\in (0,1)$，并且 $p+q  1$。所描述的马尔可夫链是不可约和非周期的。\n\n下列哪个陈述正确地指明了该链为正常返和零常返时 $p$ 和 $q$ 需要满足的条件？\n\nA. 正常返: $p  2q$。零常返: $p = 2q$。\nB. 正常返: $p > 2q$。零常返: $p = 2q$。\nC. 正常返: $p  q$。零常返: $p = q$。\nD. 正常返: $2p  q$。零常返: $2p = q$。\nE. 正常返: $p  q/2$。零常返: $p = q/2$。", "solution": "对于 $i \\ge 2$，一步增量 $\\Delta X := X_{n+1}-X_{n}$ 满足\n$$\n\\Delta X=\\begin{cases}\n+1  \\text{with probability } p,\\\\\n-2  \\text{with probability } q,\\\\\n0  \\text{with probability } 1-p-q.\n\\end{cases}\n$$\n因此，对于 $i \\ge 2$，\n$$\n\\mathbb{E}[\\Delta X \\mid X_{n}=i]=p-2q.\n$$\n对于 $i=0$ 或 $i=1$，没有花费，所以\n$$\n\\mathbb{E}[\\Delta X \\mid X_{n}=0]=p,\\qquad \\mathbb{E}[\\Delta X \\mid X_{n}=1]=p.\n$$\n考虑 Lyapunov 函数 $V(i)=i$。其漂移是\n$$\n\\mathbb{E}[V(X_{n+1})-V(X_{n}) \\mid X_{n}=i]=\n\\begin{cases}\np  \\text{if } i\\in\\{0,1\\},\\\\\np-2q  \\text{if } i \\ge 2.\n\\end{cases}\n$$\n因此，在有限集 $C=\\{0,1\\}$ 之外，漂移是常数 $p-2q$。\n\n根据 Foster-Lyapunov 准则：\n- 如果 $p-2q  0$（即 $p  2q$），则存在 $\\epsilon0$ 使得对于所有 $i \\ge 2$ 都有 $\\mathbb{E}[V(X_{n+1})-V(X_{n}) \\mid X_{n}=i]\\le -\\epsilon$，这意味着该链是正常返的。\n- 如果 $p-2q  0$（即 $p  2q$），漂移在 $C$ 之外为正，这意味着链是瞬时（因此不是常返）的。\n- 对于边界情况 $p=2q$，对所有 $i \\ge 2$ 漂移为 $0$。为了区分零常返和正常返，我们计算 $i \\ge 2$ 时增量的二阶矩：\n$$\n\\mathbb{E}[(\\Delta X)^{2} \\mid X_{n}=i]=p \\cdot 1^{2}+q \\cdot 2^{2}+(1-p-q)\\cdot 0=p+4q.\n$$\n因此，当 $p=2q$ 时，方差为\n$$\n\\mathrm{Var}(\\Delta X \\mid X_{n}=i)=\\mathbb{E}[(\\Delta X)^{2} \\mid X_{n}=i] - \\left(\\mathbb{E}[\\Delta X \\mid X_{n}=i]\\right)^{2}=p+4q0,\n$$\n因此对于所有 $i \\ge 2$，增量的均值为零且方差为正。这将该链置于经典的一维反射随机游走范畴中，其具有有界跳跃、零漂移和非退化方差，因此是零常返的。等价地，根据适用于 $\\{0,1,2,\\dots\\}$ 上具有有界增量和渐近零漂移过程的 Lamperti-type 准则，零漂移和正方差导致零常返。\n\n因此，该链是正常返的当且仅当 $p  2q$，是零常返的当且仅当 $p=2q$。这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1323998"}]}