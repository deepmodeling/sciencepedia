{"hands_on_practices": [{"introduction": "理解遍历性的一个关键步骤是认识到什么情况下状态*不是*遍历的。本练习通过一个在一维直线上运动的粒子的简单模型，直观地展示了周期性的概念，这是遍历性的一个常见障碍。通过分析这个马尔可夫链，你将学会如何识别周期性状态，并理解为何非周期性是遍历性的一个必要条件[@problem_id:1299388]。", "problem": "一个粒子在一组四个离散位置上进行随机游走，我们可以将其标记为状态 {1, 2, 3, 4}。这个过程被建模为一个离散时间马尔可夫链。这些位置排列在一条线上，粒子的运动遵循以下转移规则：\n- 当处于内部位置 $i \\in \\{2, 3\\}$ 时，粒子以 0.5 的概率移动到位置 $i-1$，或以 0.5 的概率移动到位置 $i+1$。\n- 位置 1 和 4 作为反射边界。从位置 1，粒子在下一步总是移动到位置 2（即，概率为 1）。从位置 4，粒子在下一步总是移动到位置 3（概率为 1）。\n\n基于这个模型，下列哪个陈述对状态 2 提供了正确的分类？\n\nA. 状态 2 是遍历的。\nB. 状态 2 不是遍历的，因为它是一个周期性状态。\nC. 状态 2 不是遍历的，因为它是一个暂留状态。\nD. 状态 2 不是遍历的，因为它是一个零常返状态。", "solution": "我们用转移矩阵 $P$ （行和列按 1,2,3,4 排序）来建模状态空间为 $\\{1,2,3,4\\}$ 的马尔可夫链：\n$$\nP=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n\\frac{1}{2} & 0 & \\frac{1}{2} & 0\\\\\n0 & \\frac{1}{2} & 0 & \\frac{1}{2}\\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}.\n$$\n首先，我们确定不可约性和常返性。底层图通过带有反射边界的最近邻移动是连通的：$1 \\leftrightarrow 2 \\leftrightarrow 3 \\leftrightarrow 4$，其中每个方向都具有严格为正的概率。因此，每个状态都与其它所有状态互通；该链是不可约的。由于状态空间是有限的且链是不可约的，所以每个状态都是正常返的。因此，状态 $2$ 不是暂留的，也不是零常返的。\n\n接下来，我们确定状态 $2$ 的周期。周期 $d(2)$ 定义为\n$$\nd(2)=\\gcd\\{n\\ge 1 : (P^{n})_{2,2}>0\\}.\n$$\n每一步都会改变位置的奇偶性（在奇数状态和偶数状态之间移动），因此从偶数状态 $2$ 开始，经过 $n$ 步后，链处于偶数状态当且仅当 $n$ 是偶数。因此，对于所有奇数 $n$，$(P^{n})_{2,2}=0$。对于偶数 $n=2m$，存在一条返回到 $2$ 的路径，例如\n$$\n2 \\to 1 \\to 2 \\to 1 \\to \\cdots \\to 2 \\quad \\text{(length }2m\\text{),}\n$$\n其概率等于 $\\left(\\frac{1}{2}\\right)^{m}>0$（每次 $2\\to 1$ 的概率为 $\\frac{1}{2}$，每次 $1\\to 2$ 的概率为 $1$）。因此，对于所有 $m\\ge 1$，$(P^{2m})_{2,2}>0$。因此\n$$\n\\{n\\ge 1 : (P^{n})_{2,2}>0\\}=\\{2,4,6,\\dots\\}\n$$\n并且\n$$\nd(2)=\\gcd\\{2,4,6,\\dots\\}=2.\n$$\n所以状态 $2$ 是周期的，周期为 $2$，虽然它是正常返的（有限不可约链），但它不是非周期的。在标准分类中，遍历状态是闭合不可约类中的正常返且非周期的状态，因此状态 $2$ 不是遍历的，因为它是周期的。\n\n因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1299388"}, {"introduction": "当一个系统是遍历的时，它的长期行为是稳定且可预测的。这个练习以一个物流卡车的日常运营为背景，构建了一个遍历马尔可夫链模型。通过解决这个问题，你将练习如何建立平稳分布所满足的平衡方程，并求解出系统在每个状态下的长期停留时间比例[@problem_id:1299404]。", "problem": "一家物流公司运营着一辆自动驾驶送货卡车，为三个城市服务：Metropolis (A)、Gotham (B) 和 Zenith (C)。卡车遵循固定的单向每日路线：从 Metropolis 前往 Gotham，从 Gotham 前往 Zenith，再从 Zenith 返回 Metropolis。城市之间的这段行程需要一整天时间。然而，卡车老化的发动机存在可靠性问题。在任何一天，无论其位于何处，卡车都有一个固定的概率 $p$ 发生机械故障。如果发生故障，卡车将在当天停留在当前城市进行维修，其预定的行程将推迟到第二天。故障概率 $p$ 是一个满足 $0 \\lt p \\lt 1$ 的固定值。\n\n假设卡车已经运行了很长时间，卡车位于 Metropolis 的天数在长期来看占多大比例？请以精确分数形式给出你的答案。", "solution": "将该系统建模为在每天开始时观察的离散时间马尔可夫链，状态空间为 $\\{A,B,C\\}$，代表卡车当时所在的城市。每天：\n- 以概率 $p$，发生故障，卡车停留在当前城市，因此第二天的状态与今天的状态相同。\n- 以概率 $1-p$，没有发生故障；卡车完成预定路段，第二天的状态是循环 $A \\to B \\to C \\to A$ 中的下一个城市。\n\n因此，一步转移概率为：\n$$\nP(A \\to A)=p,\\quad P(A \\to B)=1-p,\\quad P(A \\to C)=0,\n$$\n$$\nP(B \\to B)=p,\\quad P(B \\to C)=1-p,\\quad P(B \\to A)=0,\n$$\n$$\nP(C \\to C)=p,\\quad P(C \\to A)=1-p,\\quad P(C \\to B)=0.\n$$\n对于 $0 < p < 1$，链是不可约的（例如，$A \\to B \\to C \\to A$ 构成了一个通信循环）且非周期的（因为每个状态都有自环 $P_{ii}=p>0$）。因此，链是遍历的，存在唯一的平稳分布 $\\pi=(\\pi_{A},\\pi_{B},\\pi_{C})$。\n\n平稳分布满足方程组 $\\pi = \\pi P$：\n$$\n\\pi_{A} = p\\pi_{A} + (1-p)\\pi_{C},\n$$\n$$\n\\pi_{B} = p\\pi_{B} + (1-p)\\pi_{A},\n$$\n$$\n\\pi_{C} = p\\pi_{C} + (1-p)\\pi_{B}.\n$$\n以及归一化条件 $\\pi_A+\\pi_B+\\pi_C=1$。\n\n从第一个方程，我们得到 $(1-p)\\pi_A=(1-p)\\pi_C$。因为 $p \\lt 1$，我们有 $1-p \\ne 0$，因此 $\\pi_A = \\pi_C$。\n从第二个方程，我们得到 $(1-p)\\pi_B=(1-p)\\pi_A$，这意味着 $\\pi_B = \\pi_A$。\n因此，$\\pi_A=\\pi_B=\\pi_C$。\n将此代入归一化条件：\n$$\n\\pi_A + \\pi_A + \\pi_A = 1 \\implies 3\\pi_A = 1 \\implies \\pi_A = \\frac{1}{3}.\n$$\n因此，每个城市的平稳概率都是 $1/3$。在长期来看，卡车位于 Metropolis 的天数比例是 $\\frac{1}{3}$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1299404"}, {"introduction": "对于特定类型的马尔可夫链，例如在无向图上的随机游走，存在比求解一般平衡方程更快捷的分析方法。这个练习探讨了一个“棒棒糖”形状的图结构上的粒子运动，旨在引导你发现并应用一个重要结论：平稳分布与图中节点的度成正比。通过这个练习，你将学会一个强大的工具，用于快速计算复杂网络中的长期概率[@problem_id:1299394]。", "problem": "一个粒子在由四个位置（标记为1、2、3和4）组成的小型网络上进行随机游走。该网络的结构如下：位置1、2和3相互连接形成一个三角形，即每个位置都与另外两个位置相连。位置4仅与位置3相连。\n\n在每个离散时间步，位于某个位置的粒子必须移动到其一个相连的邻居位置。邻居的选择是均匀随机的。例如，如果一个位置有 $k$ 个邻居，那么移动到任何一个特定邻居的概率是 $1/k$。\n\n这个随机游走可以被建模为状态空间 $S = \\{1, 2, 3, 4\\}$ 上的一个离散时间马尔可夫链。经过很长一段时间后，系统会进入一个稳态，该稳态由一个平稳分布来描述，该分布给出了在每个位置找到粒子的概率。\n\n计算在位置3找到粒子的平稳概率。请用精确分数表示你的答案。", "solution": "令 $S=\\{1,2,3,4\\}$。该随机游走是一个离散时间马尔可夫链，其转移概率由下式给出\n$$\nP_{ij}=\\begin{cases}\n\\frac{1}{\\deg(i)}, & \\text{if } i\\text{ and }j\\text{ are connected by an edge},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n一个平稳分布 $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3},\\pi_{4})$ 满足以下定义方程\n$$\n\\pi=\\pi P,\\qquad \\sum_{i\\in S}\\pi_{i}=1,\\qquad \\pi_{i}\\ge 0.\n$$\n对于有限、连通、无向图上的随机游走，一个标准的可逆测度是\n$$\n\\pi_{i}=\\frac{\\deg(i)}{\\sum_{k\\in S}\\deg(k)}.\n$$\n为验证平稳性，检查所有 $i,j\\in S$ 的细致平衡条件：\n$$\n\\pi_{i}P_{ij}=\\frac{\\deg(i)}{\\sum_{k}\\deg(k)}\\cdot\\frac{A_{ij}}{\\deg(i)}=\\frac{A_{ij}}{\\sum_{k}\\deg(k)}=\\frac{A_{ji}}{\\sum_{k}\\deg(k)}=\\pi_{j}P_{ji},\n$$\n其中 $A_{ij}$ 是邻接指示符。因此 $\\pi$ 是平稳的。\n\n从图中计算各个节点的度：\n- 节点1、2、3形成一个三角形。由此可知 $\\deg(1)=2$ 且 $\\deg(2)=2$。节点3除了连接节点1和2之外，还连接节点4，因此 $\\deg(3)=3$。\n- 节点4仅连接到节点3，因此 $\\deg(4)=1$。\n\n因此，\n$$\n\\sum_{k\\in S}\\deg(k)=\\deg(1)+\\deg(2)+\\deg(3)+\\deg(4)=2+2+3+1=8.\n$$\n因此，在位置3的平稳概率是\n$$\n\\pi_{3}=\\frac{\\deg(3)}{\\sum_{k}\\deg(k)}=\\frac{3}{8}.\n$$", "answer": "$$\\boxed{\\frac{3}{8}}$$", "id": "1299394"}]}