{"hands_on_practices": [{"introduction": "掌握马尔可夫链的第一步是通过一个清晰、直接的例子来建立直观理解。这个练习将挑战你分析一个基于抛硬币的随机过程——连续正面朝上的次数。通过考察状态如何从一步演变到下一步，你将直接应用“无记忆性”这一核心性质，它正是定义马尔可夫链的关键。[@problem_id:1295273]", "problem": "考虑一个独立同分布（IID）的掷硬币序列。设得到正面（H）的概率为 $p$，得到反面（T）的概率为 $1-p$，其中 $0  p  1$。\n\n基于这个掷硬币序列定义一个随机过程 $\\{X_n\\}_{n \\geq 1}$。在每个时间步 $n \\geq 1$，随机变量 $X_n$ 表示在时间 $n$ 结束的当前未中断的连续正面的长度。如果第 $n$ 次投掷是反面，则连续正面的序列中断，其长度定义为 0。例如，如果投掷序列是 H、H、T、H，则该过程对应的状态序列为 $X_1 = 1, X_2 = 2, X_3 = 0, X_4 = 1$。这个过程的状态空间是非负整数集合，$S = \\{0, 1, 2, \\dots\\}$。\n\n过程 $\\{X_n\\}_{n \\geq 1}$ 是马尔可夫链吗？请从以下选项中选择正确的陈述和理由。\n\nA. 是，因为 $X_{n+1}$ 的值完全由 $X_n$ 的值确定。\n\nB. 是，因为未来状态 $X_{n+1}$ 的条件概率分布仅取决于当前状态 $X_n$，而不取决于它之前的状态序列。\n\nC. 否，因为要确定 $X_{n+1}$，不仅需要知道 $X_n$，还需要知道第 $(n+1)$ 次掷硬币的结果。\n\nD. 否，因为状态 $X_{n+1}$ 取决于直到时间 $n+1$ 的整个掷硬币历史，而不仅仅是时间 $n$ 的状态。\n\nE. 否，因为状态空间是无限的，而状态空间无限的过程不能是马尔可夫链。", "solution": "设 $\\{Y_{n}\\}_{n \\geq 1}$ 是独立同分布的掷硬币序列，其中正面为 $Y_{n}=1$，反面为 $Y_{n}=0$，且 $\\mathbb{P}(Y_{n}=1)=p$ 和 $\\mathbb{P}(Y_{n}=0)=1-p$。根据定义，$X_n$ 是在时间 $n$ 结束的当前连续正面的长度，因此它满足以下递归更新关系\n$$\nX_{n+1}=\n\\begin{cases}\nX_{n}+1,   \\text{if } Y_{n+1}=1,\\\\\n0,   \\text{if } Y_{n+1}=0.\n\\end{cases}\n$$\n固定 $n \\geq 1$ 和过去状态的任意实现 $X_{1}=x_{1},\\dots,X_{n-1}=x_{n-1},X_{n}=i$。因为 $Y_{n+1}$ 独立于 $(Y_{1},\\dots,Y_{n})$，并且过程 $\\{X_{k}\\}$ 是 $(Y_{1},\\dots,Y_{k})$ 的可测函数，所以我们有 $Y_{n+1}$ 独立于由 $(X_{1},\\dots,X_{n})$ 生成的 sigma-代数。因此，\n$$\n\\mathbb{P}(X_{n+1}=i+1 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})\n= \\mathbb{P}(Y_{n+1}=1 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})=p,\n$$\n和\n$$\n\\mathbb{P}(X_{n+1}=0 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})\n= \\mathbb{P}(Y_{n+1}=0 \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})=1-p,\n$$\n并且\n$$\n\\mathbb{P}(X_{n+1}=j \\mid X_{n}=i, X_{n-1}=x_{n-1},\\dots,X_{1}=x_{1})=0 \\quad \\text{for all } j \\notin \\{0,i+1\\}.\n$$\n这些条件概率中的每一个都只取决于当前状态 $i=X_n$，而不取决于早期的状态 $(X_{1},\\dots,X_{n-1})$。因此，该过程满足马尔可夫性质：\n$$\n\\mathbb{P}(X_{n+1}=j \\mid X_{n}=i, X_{n-1},\\dots,X_{1})=\\mathbb{P}(X_{n+1}=j \\mid X_{n}=i).\n$$\n因此 $\\{X_{n}\\}$ 是一个马尔可夫链，其转移概率为\n$$\n\\mathbb{P}(i \\to i+1)=p,\\quad \\mathbb{P}(i \\to 0)=1-p,\\quad \\mathbb{P}(i \\to j)=0 \\text{ for } j \\notin \\{0,i+1\\}.\n$$\n选项 A 是不正确的，因为 $X_{n+1}$ 并非仅由 $X_n$ 决定；它是由第 $(n+1)$ 次投掷驱动的随机变量。选项 C 错误地陈述了马尔可夫性质：虽然实现值使用了新的随机性，但给定 $X_n$ 的条件分布就足够了。选项 D 是错误的，因为 $X_{n+1}$ 的分布不依赖于整个历史。选项 E 是错误的，因为马尔可夫链可以有无限的状态空间。因此，正确的陈述是 B。", "answer": "$$\\boxed{B}$$", "id": "1295273"}, {"introduction": "并非所有随机过程都具有马尔可夫性，即使它们是由简单的马尔可夫链衍生而来的。本练习将探讨随机游走的“运行最大值”，一个看似简单的概念。你的任务是证明，仅仅知道当前的最大值并不足以预测其未来，从而揭示一个历史信息至关重要的经典案例，其中马尔可夫性质不成立。[@problem_id:730489]", "problem": "一个在整数集 $\\mathbb{Z}$ 上的简单对称随机游走 $\\{S_n\\}_{n \\ge 0}$ 定义为 $S_0 = 0$ 和 $S_n = \\sum_{k=1}^n X_k$ (对于 $n \\ge 1$)，其中 $X_k$ 是独立同分布的随机变量，满足 $P(X_k = 1) = P(X_k = -1) = 1/2$。\n\n该游走的运行最大值是过程 $\\{M_n\\}_{n \\ge 0}$，定义为 $M_n = \\max\\{S_0, S_1, \\dots, S_n\\}$。一个随机过程 $\\{Z_n\\}_{n \\ge 0}$ 是一个马尔可夫链，如果其未来状态的条件概率只依赖于当前状态，而与之前的事件序列无关。也就是说，对于所有 $n \\ge 0$ 和任意状态 $i_0, \\dots, i_{n+1}$，\n$P(Z_{n+1}=i_{n+1} | Z_n=i_n, \\dots, Z_0=i_0) = P(Z_{n+1}=i_{n+1} | Z_n=i_n)$。\n\n为了证明运行最大值过程 $\\{M_n\\}$ 不是一个马尔可夫链，我们可以找到两个截至时间 $n$ 的不同历史，它们在同一状态 $M_n=i$ 结束，但对于时间 $n+1$ 的状态产生不同的概率。\n\n考虑运行最大值过程截至时间 $n=3$ 的以下两个历史：\n1.  历史 A: $(M_0, M_1, M_2, M_3) = (0, 1, 1, 1)$。记该事件为 $H_A$。\n2.  历史 B: $(M_0, M_1, M_2, M_3) = (0, 0, 0, 1)$。记该事件为 $H_B$。\n\n两个历史都结束于状态 $M_3 = 1$。如果 $\\{M_n\\}$ 是一个马尔可夫链，那么达到任何未来状态（例如 $M_4=1$）的概率，将与发生的是历史 A 还是历史 B 无关。\n\n你的任务是计算差值 $D = P(M_4 = 1 | H_A) - P(M_4 = 1 | H_B)$。一个非零的 $D$ 值将正式证明 $\\{M_n\\}$ 不具有马尔可夫性质。", "solution": "我们用 $X_k \\in \\{+1,-1\\}$ 标记增量，因此 $S_n = \\sum_{k=1}^n X_k$ 且 $M_n = \\max_{0 \\le j \\le n} S_j$。定义截至时间 $3$ 的两个历史：\n\n历史 A: $M_1=1, M_2=1, M_3=1$。那么 $M_1=1 \\implies X_1=+1$，并且 $M_2=1 \\implies X_2=-1$ (因为 $X_2=+1$ 会得到 $M_2=2$)。因此在 $H_A$ 条件下我们有\n$$X_1=+1, X_2=-1, \\quad S_2=0,$$\n但 $X_3$ 不受限制 (取 $+1$ 或 $-1$ 均可得到 $M_3=1$)。因此\n$$P(X_3=+1 \\mid H_A) = P(X_3=-1 \\mid H_A) = \\frac{1}{2}.$$\n由于 $S_3=X_3$，我们分两种情况讨论：\n\n情况 1: $S_3=+1$。那么 $S_4=1+X_4$，所以 $M_4=1 \\iff S_4 \\le 1 \\iff X_4=-1$，得到\n$$P(M_4=1 \\mid H_A, S_3=1) = \\frac{1}{2}.$$\n\n情况 2: $S_3=-1$。那么 $S_4=-1+X_4 \\in \\{0,-2\\}$，所以 $M_4=1$ 恒成立，因此\n$$P(M_4=1 \\mid H_A, S_3=-1) = 1.$$\n\n在 $H_A$ 条件下对 $S_3=\\pm 1$ 取平均，\n$$P(M_4=1 \\mid H_A) = \\frac{1}{2} \\cdot \\frac{1}{2} + \\frac{1}{2} \\cdot 1 = \\frac{3}{4}.$$\n\n历史 B: $M_1=0, M_2=0, M_3=1$。可以发现\n$$X_1=-1, X_2=+1, X_3=+1, \\quad S_3=1.$$\n因此在 $H_B$ 条件下我们知道 $S_3=1$，所以 $S_4=1+X_4$ 并且\n$$P(M_4=1 \\mid H_B) = P(X_4=-1) = \\frac{1}{2}.$$\n\n因此差值为\n$$D = P(M_4=1 \\mid H_A) - P(M_4=1 \\mid H_B) = \\frac{3}{4} - \\frac{1}{2} = \\frac{1}{4}.$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "730489"}, {"introduction": "当一个过程的未来似乎依赖于某个隐藏因素时，我们该如何分析？这个问题描述了一辆自动驾驶汽车，其运动取决于天气这个外部随机过程。这个练习揭示了随机建模中的一个强大技巧：状态增广。你将看到，一个本身不具备马尔可夫性质的过程，如何通过巧妙地扩展其状态定义而转变为一个马尔可夫链。[@problem_id:1295253]", "problem": "一辆自动驾驶汽车沿着一条一维轨道行驶，该轨道可以用整数集合 $\\mathbb{Z}$ 表示。汽车的状态在离散的时间步长 $n=0, 1, 2, \\dots$ 更新。令 $V_n$ 表示汽车在时间 $n$ 时在轨道上的位置。\n\n汽车的移动受到天气的影响。令 $W_n$ 为时间 $n$ 时的天气状态，可以是“晴天(Sunny)”或“雨天(Rainy)”。天气过程本身是随机演变的：时间 $n+1$ 的天气仅概率性地依赖于时间 $n$ 的天气。天气状态之间的转移概率都严格介于 0 和 1 之间。\n\n在每个时间步，汽车从其当前位置 $V_n$ 移动一个单位，要么向右 ($V_{n+1} = V_n + 1$)，要么向左 ($V_{n+1} = V_n - 1$)。向右移动的概率取决于该时间步的天气 $W_n$：\n- 如果 $W_n = \\text{晴天}$，向右移动的概率是 $p_S$。\n- 如果 $W_n = \\text{雨天}$，向右移动的概率是 $p_R$。\n\n假设 $0  p_S  1$，$0  p_R  1$，且重要的是，$p_S \\neq p_R$。天气的演变不依赖于汽车的位置或移动历史。\n\n一个随机过程 $\\{X_n\\}$ 被定义为马尔可夫链，如果对于所有时间步 $n$ 和所有可能的状态，给定整个过程历史 $\\{X_0, X_1, \\dots, X_n\\}$ 的条件下，下一个状态 $X_{n+1}$ 的条件概率仅依赖于当前状态 $X_n$。\n\n考虑以下陈述：\nI. 汽车位置的过程 $\\{V_n\\}_{n \\ge 0}$ 是一个马尔可夫链。\nII. 天气过程 $\\{W_n\\}_{n \\ge 0}$ 是一个马尔可夫链。\nIII. 位置和天气组合状态的过程 $\\{(V_n, W_n)\\}_{n \\ge 0}$ 是一个马尔可夫链。\n\n以上陈述中哪个是正确的？\n\nA. 仅 II\n\nB. 仅 III\n\nC. 仅 I 和 II\n\nD. 仅 I 和 III\n\nE. 仅 II 和 III\n\nF. I, II 和 III\n\nG. 所有陈述都不正确。", "solution": "我们根据马尔可夫性质的定义来分析每个陈述：对于一个过程 $\\{X_n\\}$ 要成为马尔可夫链，它必须对所有 $n$ 和所有状态满足\n$$\n\\mathbb{P}(X_{n+1} \\in A \\mid X_0, X_1, \\dots, X_n) = \\mathbb{P}(X_{n+1} \\in A \\mid X_n).\n$$\n\n首先，天气过程 $\\{W_n\\}$ 根据其构造是马尔可夫的：题目规定时间 $n+1$ 的天气仅概率性地依赖于时间 $n$ 的天气，且转移概率严格介于 $0$ 和 $1$ 之间。因此，对于所有 $n$，\n$$\n\\mathbb{P}(W_{n+1}=w' \\mid W_0, W_1, \\dots, W_n) = \\mathbb{P}(W_{n+1}=w' \\mid W_n),\n$$\n所以陈述 II 是正确的。\n\n其次，考虑联合过程 $\\{(V_n, W_n)\\}$。给定 $(V_n, W_n)$，下一个状态对 $(V_{n+1}, W_{n+1})$ 按如下方式确定：\n- 根据天气的马尔可夫性质，$W_{n+1}$ 仅依赖于 $W_n$。\n- $V_{n+1}$ 通过以下方式依赖于 $(V_n, W_n)$：\n$$\n\\mathbb{P}(V_{n+1}=V_n+1 \\mid V_n, W_n) =\n\\begin{cases}\np_S,  W_n=\\text{晴天},\\\\\np_R,  W_n=\\text{雨天},\n\\end{cases}\n$$\n并且 $\\mathbb{P}(V_{n+1}=V_n-1 \\mid V_n, W_n)=1$ 减去上述概率。\n因此，对于任何历史，\n$$\n\\mathbb{P}\\big((V_{n+1}, W_{n+1}) \\in B \\mid (V_0, W_0), \\dots, (V_n, W_n)\\big)\n$$\n仅依赖于 $(V_n, W_n)$，所以 $\\{(V_n, W_n)\\}$ 是一个马尔可夫链，陈述 III 是正确的。\n\n第三，我们检验 $\\{V_n\\}$ 本身是否是马尔可夫的。定义 $\\Delta_n := V_{n+1}-V_n \\in \\{-1, 1\\}$。那么对于任何位置历史，\n$$\n\\mathbb{P}(\\Delta_n=1 \\mid V_0, V_1, \\dots, V_n)\n= \\mathbb{E}\\big[ \\mathbb{P}(\\Delta_n=1 \\mid V_0, \\dots, V_n, W_n) \\mid V_0, \\dots, V_n \\big]\n= p_S \\,\\mathbb{P}(W_n=\\text{晴天} \\mid V_0, \\dots, V_n) + p_R \\,\\mathbb{P}(W_n=\\text{雨天} \\mid V_0, \\dots, V_n).\n$$\n因为 $p_S \\neq p_R$，上式的值取决于后验概率 $\\mathbb{P}(W_n=\\text{晴天} \\mid V_0, \\dots, V_n)$。在给定的模型下，直到时间 $n$ 的位置历史是通过增量序列 $\\Delta_0, \\dots, \\Delta_{n-1}$ 生成的，其中每个 $\\Delta_k$ 都依赖于 $W_k$。由于天气是一个马尔可夫链，$W_n$ 依赖于 $W_{n-1}$，而关于 $W_{n-1}$ 的信息又来自于观测到的过去增量（也就是整个位置历史），而不仅仅是当前位置 $V_n$。因此，过滤概率 $\\mathbb{P}(W_n=\\text{晴天} \\mid V_0, \\dots, V_n)$ 通常是整个历史的函数，而不仅仅是 $V_n$ 的函数。\n为了具体说明这一点，考虑两个都到达相同当前位置 $V_n$ 但历史路径不同的情况。一个包含较多向右移动的历史会让我们推断过去晴天更多，反之亦然。由于天气过程 $\\{W_n\\}$ 自身有记忆，对过去天气的不同推断会影响对当前天气 $W_n$ 状态的后验概率。因为 $p_S \\neq p_R$，下一步的移动概率 $\\mathbb{P}(V_{n+1}=V_n+1 \\mid V_0, \\dots, V_n)$ 就会因历史不同而不同。因此，历史信息在给定当前位置时仍然相关，这违反了马尔可夫性质。所以陈述 I 是错误的。", "answer": "$$\\boxed{E}$$", "id": "1295253"}]}