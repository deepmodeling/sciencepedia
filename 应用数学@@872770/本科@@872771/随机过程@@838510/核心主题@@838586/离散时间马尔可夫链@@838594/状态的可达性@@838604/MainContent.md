## 引言
马尔可夫链为模拟世界中各种随机演化过程提供了强大的数学工具，从股价波动到基因遗传，无不涉及其应用。然而，仅仅定义一个马尔可夫链的转移概率是不够的。为了真正预测和理解一个系统的长期行为，我们必须深入其内部结构：状态之间是如何连接的？过程最终会停留在何处，还是会无限循环？这些问题的核心答案在于“状态的[可达性](@entry_id:271693)”——一个决定了马尔可夫链动态命运的基本属性。本文旨在填补从基本定义到结构化分析之间的知识鸿沟，系统性地阐述状态[可达性](@entry_id:271693)的理论与实践。

在接下来的内容中，我们将分三步构建一个完整的认知框架。首先，在“原理与机制”一章中，我们将精确定义[可达性](@entry_id:271693)、互通性，并将[状态空间](@entry_id:177074)划分为瞬时类与[常返类](@entry_id:273689)，揭示马尔可夫链的拓扑结构。接着，在“应用与跨学科联系”一章中，我们将跨越学科界限，展示这些理论如何在生命科学、计算机算法和工程设计等领域中解决实际问题，彰显其强大的解释力。最后，通过“动手实践”部分的精选练习，您将有机会亲手应用所学知识，巩固对这些关键概念的理解。

让我们从最基本的问题开始：在一个[马尔可夫链](@entry_id:150828)中，从一个状态到另一个状态的旅程是如何被定义和分类的？这便是我们将在第一章中深入探讨的原理与机制。

## 原理与机制

在前一章中，我们介绍了[随机过程](@entry_id:159502)和马尔可夫链的基本概念。现在，我们将深入探讨刻画[马尔可夫链](@entry_id:150828)结构与动态行为的核心原理：状态的可达性与分类。理解这些概念是分析[马尔可夫链](@entry_id:150828)长期行为的基石。我们将从状态间的关系入手，逐步构建一个完整的框架，用以剖析任何有限状态[马尔可夫链](@entry_id:150828)的内在结构。

### [可达性](@entry_id:271693)与互通性的定义

在一个马尔可夫链中，并非所有状态都能从任意一个其他状态到达。[状态空间](@entry_id:177074)中的“连通性”是其最重要的拓扑特性之一。为了精确描述这种连通性，我们引入两个基本概念：**可达性（Accessibility）**和**互通性（Communication）**。

一个状态 $j$ 被称为是从状态 $i$ **可达**的（记作 $i \to j$），如果从状态 $i$ 出发，经过有限步（一步或多步）能够以大于零的概率到达状态 $j$。用数学语言来说，存在某个整数 $n \ge 1$，使得 $n$ 步转移概率 $P_{ij}^{(n)} > 0$。这里的 $P^{(n)}$ 是单步转移[概率矩阵](@entry_id:274812) $P$ 的 $n$ 次幂。值得注意的是，这里的“有限步”可以是任意大的有限整数，因此我们需要考虑所有可能的路径，而不仅仅是单步转移。

可达性关系不一定是对称的。一个常见的例子是存在“单行道”的系统。考虑一个简化的网站导航模型，包含三个页面：主页（H）、关于页（A）和联系页（C）。用户可以从主页链接到关于页，从关于页链接到联系页，但联系页没有任何出站链接。因此，状态 A 可从 H 可达（$H \to A$），状态 C 可从 A 可达（$A \to C$）。通过两步转移 $H \to A \to C$，状态 C 也可从 H 可达（$H \to C$）。然而，反向的路径是不存在的：用户一旦离开主页 H，就无法返回；一旦到达联系页 C，就将被困在该页。因此，H 不可从 A 或 C 可达 [@problem_id:1280491]。这种单向的可达性在许多现实世界的过程中都存在，例如在模拟职业晋升路径时，员工可以从“实习生”晋升到“初级工程师”，再到“高级工程师”，但通常无法降级 [@problem_id:1280499]。

当两个状态可以相互到达时，我们称它们**互通**。形式上，状态 $i$ 与状态 $j$ 互通（记作 $i \leftrightarrow j$），当且仅当 $i \to j$ 且 $j \to i$。互通是一种比[可达性](@entry_id:271693)更强的关系，它要求两个方向的路径都存在。显然，任何状态都与自身互通（通常假设存在一个保持原状态不变的非零概率，即 $P_{ii}>0$）。互通关系是对称的：如果 $i \leftrightarrow j$，那么 $j \leftrightarrow i$。

让我们通过一个例子来阐明互通的概念。假设一只青蛙在三个线性[排列](@entry_id:136432)的睡莲叶（状态1, 2, 3）之间跳跃。从状态1，它总是跳到状态2；从状态2，它可以跳回状态1或跳到状态3；而状态3是一个“粘性”的叶子，一旦到达就无法离开。在这个模型中，状态1和状态2是互通的，因为存在路径 $1 \to 2$（一步）和 $2 \to 1$（一步）。然而，状态2和状态3并不互通，尽管青蛙可以从2跳到3（$2 \to 3$），但它无法从3跳回2（$3 \not\to 2$）[@problem_id:1280484]。

### [互通类](@entry_id:267280)与不可约性

互通关系具有[传递性](@entry_id:141148)：如果 $i \leftrightarrow j$ 且 $j \leftrightarrow k$，那么 $i \leftrightarrow k$。一个既满足[自反性](@entry_id:137262)、对称性又满足[传递性](@entry_id:141148)的关系被称为**[等价关系](@entry_id:138275)**。在数学上，任何等价关系都会将其作用的集合（在这里是马尔可夫链的[状态空间](@entry_id:177074) $S$）划分为若干个互不相交的[子集](@entry_id:261956)，这些[子集](@entry_id:261956)被称为**[等价类](@entry_id:156032)**。在[马尔可夫链](@entry_id:150828)的语境下，这些由互通关系导出的等价类被称为**[互通类](@entry_id:267280)（Communicating Classes）**。

一个[互通类](@entry_id:267280)是一个极大的[互通状态](@entry_id:269327)集合，即类中的任何两个状态都互相连通，并且没有类外的任何状态能与类内的状态互通。因此，整个[状态空间](@entry_id:177074)可以被唯一地划分为一个或多个[互通类](@entry_id:267280)。

在之前的例子中：
- 网站导航模型 [@problem_id:1280491] 中，由于没有两个不同的状态互通，因此[互通类](@entry_id:267280)是三个单元素集合：$\{H\}$, $\{A\}$, $\{C\}$。
- 青蛙跳跃模型 [@problem_id:1280484] 中，状态1和2互通，形成一个[互通类](@entry_id:267280) $\{1, 2\}$。状态3只与自身互通，形成另一个[互通类](@entry_id:267280) $\{3\}$。
- 在一个具有四个状态的马尔可夫链中，如果其[转移矩阵](@entry_id:145510)具有块结构，例如状态 $\{s_1, s_2\}$ 的转移完全独立于状态 $\{s_3, s_4\}$，那么这种分解结构会直接体现在[互通类](@entry_id:267280)的划分上 [@problem_id:1280501]。

当整个[状态空间](@entry_id:177074)只包含一个[互通类](@entry_id:267280)时，我们称这个[马尔可夫链](@entry_id:150828)是**不可约的（Irreducible）**。在不可约的[马尔可夫链](@entry_id:150828)中，从任何状态出发，都有可能到达任何其他状态。这等价于说，[状态转移图](@entry_id:175938)是**强连通的**。例如，一个模拟软件应用状态（运行、最小化、关闭）的模型，如果从任何状态（包括“关闭”后重启到“运行”）最终都能到达其他任何状态，那么这个链就是不可约的 [@problem_id:1280495]。在分析一个系统是否不可约时，关键是检查是否存在从任意状态 $i$ 到任意状态 $j$ 的路径。有时，这需要我们推断出使链不可约的**必要和充分条件**，例如，在图书馆书籍状态模型中，只有当特定的转移概率（如 $p_{12}, p_{23}, p_{31}$）均大于零，从而构成一个完整的循环路径时，链才是不可约的 [@problem_id:1280506]。

### 长远归宿：瞬时类与[常返类](@entry_id:273689)

将[状态空间](@entry_id:177074)划分为[互通类](@entry_id:267280)后，下一个自然的问题是：这个过程在这些类别之间如何移动？长远来看，它会停留在某个类中，还是会在不同类之间穿梭？这引出了对类别的进一步分类：**瞬时类（Transient Classes）**和**[常返类](@entry_id:273689)（Recurrent Classes）**。

如果一个[互通类](@entry_id:267280) $C$ 是**封闭的（Closed）**，即一旦进入该类，就永远无法离开，那么我们称之为一个**[常返类](@entry_id:273689)**。形式上，对于任何 $i \in C$ 和 $j \notin C$，都有 $P_{ij} = 0$。[常返类](@entry_id:273689)中的任何状态都称为**常返状态**。直观地讲，如果你从一个常返状态出发，你不仅会永远留在这个类中，而且你将以概率1无限次地返回到这个起始状态。

相反，如果一个[互通类](@entry_id:267280)不是封闭的，即存在至少一个从类中状态到类外状态的“逃逸路径”，那么我们称之为一个**瞬时类**。瞬时类中的任何状态都称为**瞬时状态**。从一个瞬时状态出发，过程可能会暂时在它的类中徘徊，但最终存在一个大于零的概率，它会离开这个类并且**永不返回**。

在有限状态[马尔可夫链](@entry_id:150828)中，一个重要的结论是：任何状态要么是常返的，要么是瞬时的。[常返类](@entry_id:273689)恰好是那些封闭的[互通类](@entry_id:267280)。

让我们看几个例子来巩固这些概念：
- 社交媒体平台的用户账户状态模型 [@problem_id:1280516] 中，状态为“活跃”（1）和“暂停”（2）。这两个状态可以相互转化，因此构成一个[互通类](@entry_id:267280) $\{1, 2\}$。然而，从“暂停”状态有一定概率会转移到“封禁”（3）状态，而“封禁”状态是一个[吸收态](@entry_id:161036)（即 $P_{33}=1$）。因此，存在从类 $\{1, 2\}$ 到类 $\{3\}$ 的逃逸路径。故 $\{1, 2\}$ 是一个瞬时类。而 $\{3\}$ 本身是一个[互通类](@entry_id:267280)，并且是封闭的，所以它是一个[常返类](@entry_id:273689)。
- 在一个粒子[随机游走模型](@entry_id:180803)中，状态 $\{1, 2, 3\}$ 构成一个循环，但从状态3有概率跳到另一个循环 $\{4, 5, 6\}$。一旦粒子进入 $\{4, 5, 6\}$，它就再也无法返回到 $\{1, 2, 3\}$。因此，$\{1, 2, 3\}$ 是一个瞬时类，而 $\{4, 5, 6\}$ 是一个[常返类](@entry_id:273689) [@problem_id:1280470]。
- 系统的结构属性（从而瞬时类的数量）可能依赖于转移概率的具体数值。在一个棋盘游戏模型中，根据玩家顺时针移动的概率 $p$ 的不同取值（例如 $p=1$ 或 $p=0$），一些状态可能会从属于一个大的[常返类](@entry_id:273689)，变为孤立的瞬时类 [@problem_id:1280522]。

### [可达性](@entry_id:271693)的量化分析

在对状态进行分类之后，我们可以提出更具量化性的问题，例如：“从状态 $i$ 出发，最终到达状态 $j$ 的概率是多少？”或“从状态 $i$ 出发，第一次到达状态 $j$ 平均需要多少步？” 解答这些问题需要一种强大的技术，称为**首步分析（First-Step Analysis）**。其核心思想是通过对过程迈出的第一步进行条件化，从而为我们关心的量（如概率或期望）建立一个线性方程组。

#### 命中概率

我们常常关心的是在一个过程结束之前（例如，在到达某个[吸收态](@entry_id:161036)之前）到达某个中间状态集的概率。这被称为**命中概率（Hitting Probability）**。

经典的例子是**赌徒破产问题**。假设一个赌徒的初始资本为 $k$ 美元，每次赌博他以概率 $p$ 赢1美元，以概率 $q=1-p$ 输1美元。当他的资本达到 $N$ 美元（盈利目标）或 $0$ 美元（破产）时，赌博停止。我们想计算在破产或达到盈利目标之前，资本恰好达到某个中间值 $j$ 美元（$0  k  j  N$）的概率。

由于从 $k$ 到 $N$ 必须经过 $j$，该问题等价于计算在破产前（到达0之前）先到达 $j$ 的概率。设 $u_i$ 为从资本 $i$ 出发，在到达0之前先到达 $j$ 的概率。我们要求的便是 $u_k$。根据首步分析：
- 边界条件是明确的：$u_0 = 0$（已经破产，不可能再到达 $j$）和 $u_j = 1$（已经到达 $j$）。
- 对于 $0  i  j$，赌徒的资本在下一步会变为 $i+1$ 或 $i-1$。因此，我们可以写出[递推关系](@entry_id:189264)：
$$ u_i = p \cdot u_{i+1} + q \cdot u_{i-1} $$
这是一个二阶[线性差分方程](@entry_id:178777)。当 $p \neq q$ 时，其通解形式为 $u_i = A \cdot 1^i + B \cdot (q/p)^i$。利用边界条件 $u_0=0$ 和 $u_j=1$ 解出常数 $A$ 和 $B$，最终得到从初始资本 $k$ 出发，在破产前先到达 $j$ 的概率为 [@problem_id:1280485]：
$$ u_k = \frac{1 - \left(\frac{q}{p}\right)^k}{1 - \left(\frac{q}{p}\right)^j} $$

#### 期望命中时间

另一个重要的量化指标是**期望命中时间（Expected Hitting Time）**，即从一个起始状态首次到达一个目标状态（或状态集）所需的平均步数。

同样，我们可以使用首步分析。设 $h_i$ 为从状态 $i$ 出发，首次到达目标集合 $C$ 的期望步数。
- 如果 $i \in C$，那么 $h_i = 0$，因为已经身在目标集中。
- 如果 $i \notin C$，那么过程将首先花费一步转移到某个状态 $j$，然后从 $j$ 开始继续。对所有可能的下一步状态 $j$ 求期望，可得：
$$ h_i = 1 + \sum_{j \in S} P_{ij} h_j $$
这为所有非目标状态的 $h_i$ 建立了一个线性方程组。

考虑之前提到的粒子游走模型，其中 $\{1,2,3\}$ 是一个瞬时类，$\{4,5,6\}$ 是目标[常返类](@entry_id:273689) $C$ [@problem_id:1280470]。我们想计算从状态1出发，首次进入集合 $C$ 的期望步数 $h(1)$。
- 对于目标态，我们有 $h(4)=h(5)=h(6)=0$。
- 对于瞬时态，我们建立方程：
$$ h(1) = 1 + h(2) $$
$$ h(2) = 1 + h(3) $$
$$ h(3) = 1 + p \cdot h(1) + (1-p) \cdot h(4) = 1 + p \cdot h(1) $$
通过简单的代数替换，我们可以解出这个[方程组](@entry_id:193238)，得到 $h(1) = \frac{3}{1-p}$。这为我们提供了从瞬时部分逃逸到常返部分所需平均时间的精确表达式。

### 特例：确定性链与循环

最后，我们来考察一个特殊但富有启发性的情况：**确定性马尔可夫链**。在这种链中，所有转移概率要么是0，要么是1。从任何状态出发，未来的路径都是唯一确定的。

一个典型的例子是[线性同余生成器](@entry_id:143094)（LCG），常用于生成[伪随机数](@entry_id:196427)序列。其状态更新规则为 $K_{n+1} = (a K_n + b) \pmod M$。给定一个初始种子 $K_0$，整个序列 $\{K_n\}$ 就被唯一确定了。

由于[状态空间](@entry_id:177074) $S = \{0, 1, \dots, M-1\}$ 是有限的，这个序列最终必然会重复。其轨迹结构通常包含两部分：一个初始的、不重复的序列，称为**预周期（pre-period）**或“尾巴”；以及紧随其后的一个重复出现的序列，称为**循环（cycle）**。从一个初始状态可达的所有状态的集合（即[可达集](@entry_id:276191)），其大小等于预周期的长度与循环周期的长度之和 [@problem_id:1280492]。

在这个确定性的框架下，瞬时和常返的概念变得异常清晰：
- 预周期中的状态是**瞬时**的。一旦过程离开这些状态，就再也不会回来。
- 循环中的状态是**常返**的。它们构成一个（或多个）封闭的[互通类](@entry_id:267280)。一旦过程进入一个循环，它将永远在这个循环中按固定顺序运动。

这个简单的确定性模型为我们理解更普遍的随机[马尔可夫链](@entry_id:150828)提供了一个有力的心智模型：瞬时状态就好比是通往最终稳定区域的路径，而常返状态则构成了那些[稳定区域](@entry_id:166035)本身。马尔可夫链的[长期演化](@entry_id:158486)，本质上就是从瞬时状态“逃逸”并最终被某个[常返类](@entry_id:273689)“捕获”的过程。