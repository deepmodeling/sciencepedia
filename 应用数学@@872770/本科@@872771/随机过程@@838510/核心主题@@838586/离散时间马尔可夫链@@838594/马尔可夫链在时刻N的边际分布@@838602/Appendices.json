{"hands_on_practices": [{"introduction": "我们通过一个经典的双状态马尔可夫链模型来开始我们的实践。这个练习将指导你如何为一个系统的状态概率建立并求解一个递推关系，从而得到它在任意时间 $n$ 的精确表达式。这个过程是理解马尔可夫链动态演化规律的基础。[@problem_id:1316056]", "problem": "在一次行为神经科学实验中，一只大鼠被放置在一个有两个杠杆的实验箱中，一个红色，一个蓝色。该实验研究大鼠在一系列试验中的学习和选择模式。在任何给定的试验中，大鼠的选择概率被建模为仅取决于其在前一次试验中的选择。\n\n实验数据表明了以下概率模型：\n- 如果大鼠在一次试验中按下红色杠杆，它在下一次试验中再次按下红色杠杆的概率是 $p$。\n- 如果大鼠在一次试验中按下蓝色杠杆，它在下一次试验中按下红色杠杆的概率是 $q$。\n\n假设在第一次试验（试验1）中，大鼠按下红色杠杆的概率为 $r_1$。\n\n推导一个通用表达式，表示大鼠在第 $n$ 次试验中按下红色杠杆的概率，我们称之为 $P_n$，其中 $n \\geq 1$。你的答案应该是一个用 $n$、$p$、$q$ 和 $r_1$ 表示的封闭形式表达式。为确保模型非平凡并避免某些退化情况，假设 $p \\neq q$ 且 $p-q \\neq 1$。", "solution": "设 $P_n$ 为大鼠在第 $n$ 次试验中按下红色杠杆的概率。设 $R_n$ 和 $B_n$ 分别为大鼠在第 $n$ 次试验中按下红色和蓝色杠杆的事件。我们需要求出 $P_n = P(R_n)$ 的表达式。\n\n我们可以使用全概率定律，根据第 $(n-1)$ 次试验的概率来表示 $P_n$。事件 $R_n$ 可以通过两种互斥的方式发生：大鼠在第 $n-1$ 次试验中选择了红色，然后在第 $n$ 次试验中再次选择红色；或者它在第 $n-1$ 次试验中选择了蓝色，然后在第 $n$ 次试验中选择红色。\n$$P(R_n) = P(R_n | R_{n-1}) P(R_{n-1}) + P(R_n | B_{n-1}) P(B_{n-1})$$\n\n根据题目陈述，我们有以下条件概率：\n1.  $P(R_n | R_{n-1}) = p$\n2.  $P(R_n | B_{n-1}) = q$\n\n此外，在第 $n-1$ 次试验中选择红色的概率是 $P(R_{n-1}) = P_{n-1}$。由于只有两个杠杆，在第 $n-1$ 次试验中选择蓝色的概率是 $P(B_{n-1}) = 1 - P(R_{n-1}) = 1 - P_{n-1}$。\n\n将这些代入 $P(R_n)$ 的方程中：\n$$P_n = p \\cdot P_{n-1} + q \\cdot (1 - P_{n-1})$$\n$$P_n = p P_{n-1} + q - q P_{n-1}$$\n$$P_n = (p - q) P_{n-1} + q$$\n这是一个关于 $P_n$ 的线性一阶非齐次递推关系，对于 $n \\geq 2$ 成立。\n\n为了解这个递推关系，我们首先找到不动点，或称稳态概率 $P^*$。这是使得 $P_n = P_{n-1} = P^*$ 的值。\n$$P^* = (p-q)P^* + q$$\n$$P^*(1 - (p-q)) = q$$\n$$P^* = \\frac{q}{1 - p + q}$$\n这个不动点存在，因为题目说明 $p-q \\neq 1$，这确保了分母 $1-p+q$ 不为零。\n\n现在，我们定义一个新序列 $d_n = P_n - P^*$。\n$$d_n = P_n - \\frac{q}{1-p+q}$$\n让我们代入 $P_n$ 的递推关系：\n$$d_n = ((p-q)P_{n-1} + q) - \\frac{q}{1-p+q}$$\n回顾一下，$P_{n-1} = d_{n-1} + P^* = d_{n-1} + \\frac{q}{1-p+q}$。\n$$d_n = (p-q)\\left(d_{n-1} + \\frac{q}{1-p+q}\\right) + q - \\frac{q}{1-p+q}$$\n$$d_n = (p-q)d_{n-1} + \\frac{(p-q)q}{1-p+q} + \\frac{q(1-p+q) - q}{1-p+q}$$\n$$d_n = (p-q)d_{n-1} + \\frac{pq - q^2}{1-p+q} + \\frac{q - pq + q^2 - q}{1-p+q}$$\n$$d_n = (p-q)d_{n-1} + \\frac{pq - q^2 - pq + q^2}{1-p+q}$$\n$$d_n = (p-q)d_{n-1}$$\n这是一个简单的等比数列。其解为 $d_n = (p-q)^{n-1} d_1$。\n\n现在我们求 $d_1$。初始条件是针对试验1给出的：$P_1 = r_1$。\n$$d_1 = P_1 - P^* = r_1 - \\frac{q}{1-p+q}$$\n将此代回 $d_n$ 的表达式中：\n$$d_n = \\left(r_1 - \\frac{q}{1-p+q}\\right) (p-q)^{n-1}$$\n\n最后，我们通过代回 $d_n = P_n - P^*$ 来求 $P_n$：\n$$P_n - \\frac{q}{1-p+q} = \\left(r_1 - \\frac{q}{1-p+q}\\right) (p-q)^{n-1}$$\n$$P_n = \\frac{q}{1-p+q} + \\left(r_1 - \\frac{q}{1-p+q}\\right) (p-q)^{n-1}$$\n这就是大鼠在第 $n$ 次试验中按下红色杠杆的概率的通用表达式。约束条件 $p \\neq q$ 确保了因子 $(p-q)$ 不为零，我们在推导中已经隐含地使用了这一点。", "answer": "$$\\boxed{\\frac{q}{1-p+q} + \\left(r_1 - \\frac{q}{1-p+q}\\right)(p-q)^{n-1}}$$", "id": "1316056"}, {"introduction": "在掌握了双状态系统的分析方法后，我们来处理一个具有更多状态的有趣例子。这个问题将向你展示如何利用转移矩阵来推导一个耦合的递推方程组，并揭示马尔可夫链可能出现的周期性或振荡行为。通过这个练习，你会发现并非所有马尔可夫链都会收敛到一个唯一的平稳分布。[@problem_id:1316110]", "problem": "一位生物学家正在为一只蜜蜂在三个特定花丛（标记为花丛1、花丛2和花丛3）之间的觅食行为建模。蜜蜂在每次采蜜停留后在花丛之间的移动是概率性的，可以用一组简单的规则来描述：\n\n- 如果蜜蜂在花丛1，它的下一次飞行将以 $1/2$ 的概率飞往花丛2，或以 $1/2$ 的概率飞往花丛3。它从不会连续两次飞行都停留在花丛1。\n- 如果蜜蜂在花丛2或花丛3，它的下一次飞行将总是飞往花丛1。\n\n蜜蜂在时间 $n=0$ 时从花丛1开始其旅程。确定在恰好 $n$ 次飞行后，蜜蜂位置的概率分布，其中 $n$ 为任意整数 $n \\ge 1$。请将您的答案表示为行向量 $[p_1(n), p_2(n), p_3(n)]$，其中 $p_i(n)$ 是蜜蜂在 $n$ 次飞行后位于花丛 $i$ 的概率。您的答案应包含三个关于 $n$ 的封闭形式表达式。", "solution": "将蜜蜂的位置建模为状态为1、2、3的离散时间马尔可夫链，其转移概率由规则给出。设 $v_{n}=[p_{1}(n),p_{2}(n),p_{3}(n)]$ 为 $n$ 次飞行后的概率行向量。马尔可夫性质给出了演化过程\n$$\nv_{n+1}=v_{n}P,\n$$\n其转移矩阵为\n$$\nP=\\begin{pmatrix}\n0  \\frac{1}{2}  \\frac{1}{2}\\\\\n1  0  0\\\\\n1  0  0\n\\end{pmatrix},\n$$\n因为蜜蜂从花丛1飞往2或3的概率各为 $\\frac{1}{2}$，而从花丛2或3飞往1的概率为 $1$。初始条件为 $v_{0}=[1,0,0]$。\n\n记 $v_{n}=[a_{n},b_{n},c_{n}]$。由 $v_{n+1}=v_{n}P$ 可得，\n$$\na_{n+1}=b_{n}+c_{n},\\quad b_{n+1}=\\frac{1}{2}a_{n},\\quad c_{n+1}=\\frac{1}{2}a_{n}.\n$$\n根据对称性，对所有 $n$ 都有 $b_{n}=c_{n}$（在 $n=0$ 时成立，并由递推关系保持）。设 $b_{n}=c_{n}=x_{n}$。则\n$$\na_{n+1}=2x_{n},\\qquad x_{n+1}=\\frac{1}{2}a_{n}.\n$$\n消去 $x_{n}$ 得到关于 $a_{n}$ 的二阶递推关系：\n$$\na_{n+1}=2x_{n}=2\\cdot\\frac{1}{2}a_{n-1}=a_{n-1}.\n$$\n在 $a_{0}=1$ 和 $a_{1}=b_{0}+c_{0}=0$ 的条件下，解为当 $n$ 为偶数时 $a_{n}=1$，当 $n$ 为奇数时 $a_{n}=0$。这可以表示为封闭形式\n$$\na_{n}=\\frac{1+(-1)^{n}}{2}.\n$$\n由于 $b_{n}=c_{n}$ 且 $a_{n}+b_{n}+c_{n}=1$，我们有\n$$\nb_{n}=c_{n}=\\frac{1-a_{n}}{2}=\\frac{1-(-1)^{n}}{4}.\n$$\n因此，对于任意整数 $n\\ge 1$，在 $n$ 次飞行后的分布为\n$$\n[p_{1}(n),p_{2}(n),p_{3}(n)]=\\left[\\frac{1+(-1)^{n}}{2},\\,\\frac{1-(-1)^{n}}{4},\\,\\frac{1-(-1)^{n}}{4}\\right].\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1+(-1)^{n}}{2}  \\frac{1-(-1)^{n}}{4}  \\frac{1-(-1)^{n}}{4}\\end{pmatrix}}$$", "id": "1316110"}, {"introduction": "理论推导之后，我们转向一个更侧重于具体计算的实践问题。这个练习模拟了一个计算机内存控制器，要求你计算系统在未来特定时刻（$n=3$）的概率分布。这个过程不仅能让你熟练运用 $p_n = p_0 P^n$ 这一核心公式，还能让你学会如何处理关于一组状态的概率问题，这在解决实际工程问题时非常常见。[@problem_id:1316084]", "problem": "一个计算机内存控制器的简化模型跟踪两个关键且独立的内存块的状态。该系统可以处于四种状态之一，$\\mathcal{S} = \\{S_1, S_2, S_3, S_4\\}$，代表两个内存块的状况：\n- $S_1$：两个内存块都处于空闲状态。\n- $S_2$：第一个内存块处于活动状态，第二个处于空闲状态。\n- $S_3$：第一个内存块处于空闲状态，第二个处于活动状态。\n- $S_4$：两个内存块都处于活动状态。\n\n系统的状态根据一个齐次马尔可夫链 $X_n$ 在离散时间步上演化。一步转移概率矩阵 $P$（其中 $P_{ij}$ 是在单个时间步内从状态 $S_i$ 转移到状态 $S_j$ 的概率）由下式给出：\n$$\nP = \\begin{pmatrix}\n0.1  0.5  0.3  0.1 \\\\\n0.4  0.2  0.2  0.2 \\\\\n0.2  0.1  0.4  0.3 \\\\\n0.1  0.2  0.3  0.4\n\\end{pmatrix}\n$$\n在时间 $n=0$ 时，系统被初始化为两个内存块都处于空闲状态，这意味着过程从状态 $S_1$ 开始。\n\n计算在时间 $n=3$ 时恰好有一个内存块处于活动状态的概率。将您的最终答案四舍五入到四位有效数字。", "solution": "我们将该系统建模为一个状态空间为 $\\mathcal{S}=\\{S_{1},S_{2},S_{3},S_{4}\\}$、转移矩阵为 $P$ 的齐次马尔可夫链。令 $p_{n}$ 为时间 $n$ 时的状态概率行向量。初始状态为 $S_1$，我们有\n$$\np_{0}=\\begin{pmatrix}1  0  0  0\\end{pmatrix}, \\quad p_{n}=p_{0}P^{n}.\n$$\n计算 $p_{1}=p_{0}P$ 为 $P$ 的第一行：\n$$\np_{1}=\\begin{pmatrix}0.1  0.5  0.3  0.1\\end{pmatrix}.\n$$\n接下来，计算 $p_{2}=p_{1}P$。其分量为\n$$\np_{2}(1)=0.1\\cdot 0.1+0.5\\cdot 0.4+0.3\\cdot 0.2+0.1\\cdot 0.1=0.28,\n$$\n$$\np_{2}(2)=0.1\\cdot 0.5+0.5\\cdot 0.2+0.3\\cdot 0.1+0.1\\cdot 0.2=0.20,\n$$\n$$\np_{2}(3)=0.1\\cdot 0.3+0.5\\cdot 0.2+0.3\\cdot 0.4+0.1\\cdot 0.3=0.28,\n$$\n$$\np_{2}(4)=0.1\\cdot 0.1+0.5\\cdot 0.2+0.3\\cdot 0.3+0.1\\cdot 0.4=0.24,\n$$\n所以\n$$\np_{2}=\\begin{pmatrix}0.28  0.20  0.28  0.24\\end{pmatrix}.\n$$\n然后计算 $p_{3}=p_{2}P$。其分量为\n$$\np_{3}(1)=0.28\\cdot 0.1+0.20\\cdot 0.4+0.28\\cdot 0.2+0.24\\cdot 0.1=0.188,\n$$\n$$\np_{3}(2)=0.28\\cdot 0.5+0.20\\cdot 0.2+0.28\\cdot 0.1+0.24\\cdot 0.2=0.256,\n$$\n$$\np_{3}(3)=0.28\\cdot 0.3+0.20\\cdot 0.2+0.28\\cdot 0.4+0.24\\cdot 0.3=0.308,\n$$\n$$\np_{3}(4)=0.28\\cdot 0.1+0.20\\cdot 0.2+0.28\\cdot 0.3+0.24\\cdot 0.4=0.248,\n$$\n所以\n$$\np_{3}=\\begin{pmatrix}0.188  0.256  0.308  0.248\\end{pmatrix}.\n$$\n恰好有一个内存块处于活动状态对应于状态 $S_{2}$ 或 $S_{3}$，因此\n$$\n\\mathbb{P}(X_{3}\\in\\{S_{2},S_{3}\\}\\mid X_{0}=S_{1})=p_{3}(2)+p_{3}(3)=0.256+0.308=0.564.\n$$\n四舍五入到四位有效数字，结果为 $0.5640$。", "answer": "$$\\boxed{0.5640}$$", "id": "1316084"}]}