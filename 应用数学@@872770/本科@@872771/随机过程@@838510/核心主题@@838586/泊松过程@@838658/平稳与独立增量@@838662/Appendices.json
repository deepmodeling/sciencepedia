{"hands_on_practices": [{"introduction": "维纳过程是模拟连续随机运动的核心模型。这个练习探索了其一个看似反直觉的特性：对过程未来某个时刻位置的观测，将如何改变我们对其过去位置的概率判断。通过这个练习 [@problem_id:1333421]，我们将运用独立增量性质来解决一个关于“回溯”概率的问题，这与布朗桥的概念密切相关。", "problem": "观察到一个纳米粒子沿一根轴进行一维随机运动，在时间 $t=0$ 时从原点出发。其在时间 $t$ 的位置，记为 $X(t)$，可以用一个标准维纳过程来建模。对本题而言，标准维纳过程 $W(t)$ 的关键性质如下：\n1. $W(0) = 0$。\n2. 对任意 $t > 0$，随机变量 $W(t)$ 服从均值为0、方差为 $t$ 的正态分布。\n3. 该过程具有独立增量，这意味着对于任意两个不重叠的时间区间 $[t_1, t_2]$ 和 $[t_3, t_4]$，随机变量 $W(t_2) - W(t_1)$ 和 $W(t_4) - W(t_3)$ 是相互独立的。\n\n一位实验者在时间 $t=4$ 测量了该粒子的位置，发现其位置为 $X(4) = 2$。给定此观测结果，在较早的时刻 $t=1$ 该粒子的位置为正 (即，$X(1) > 0$) 的概率是多少？\n\n将你的答案以小数形式报告，并四舍五入到三位有效数字。", "solution": "我们将位置过程建模为标准维纳过程 $W(t)$。考虑二元正态向量 $(W(1), W(4))$。根据维纳过程的性质：\n- $W(1) \\sim \\mathcal{N}(0,1)$ 且 $W(4) \\sim \\mathcal{N}(0,4)$，因为 $\\operatorname{Var}(W(t))=t$。\n- 利用独立增量性质，可将 $W(4)$ 写成 $W(4)=W(1)+\\big(W(4)-W(1)\\big)$，其中 $W(4)-W(1)$ 与 $W(1)$ 相互独立。因此，\n$$\n\\operatorname{Cov}(W(1), W(4))=\\operatorname{Cov}\\big(W(1), W(1)\\big)+\\operatorname{Cov}\\big(W(1), W(4)-W(1)\\big)=\\operatorname{Var}(W(1)) + 0 = 1.\n$$\n因此，$(W(1), W(4))$ 服从联合正态分布，其协方差矩阵为\n$$\n\\Sigma=\\begin{pmatrix}\n1  1 \\\\\n1  4\n\\end{pmatrix}.\n$$\n\n对于联合正态分布的变量，条件分布 $W(1)\\,|\\,W(4)=2$ 是正态分布，其均值和方差由下式给出\n$$\n\\mu_{1|4}=\\frac{\\operatorname{Cov}(W(1),W(4))}{\\operatorname{Var}(W(4))}\\cdot 2=\\frac{1}{4}\\cdot 2=\\frac{1}{2}, \\quad\n\\sigma_{1|4}^{2}=\\operatorname{Var}(W(1))-\\frac{\\operatorname{Cov}(W(1),W(4))^{2}}{\\operatorname{Var}(W(4))}=1-\\frac{1}{4}=\\frac{3}{4}.\n$$\n因此，\n$$\nW(1)\\,|\\,\\{W(4)=2\\} \\sim \\mathcal{N}\\!\\left(\\frac{1}{2}, \\frac{3}{4}\\right).\n$$\n\n我们要求解的是\n$$\n\\mathbb{P}\\big(W(1)>0 \\,\\big|\\, W(4)=2\\big)=\\mathbb{P}\\!\\left(\\mathcal{N}\\!\\left(\\frac{1}{2},\\frac{3}{4}\\right)>0\\right).\n$$\n使用标准正态变量 $Z\\sim \\mathcal{N}(0,1)$ 进行标准化，\n$$\n\\mathbb{P}\\!\\left(\\mathcal{N}\\!\\left(\\frac{1}{2},\\frac{3}{4}\\right)>0\\right)\n=1-\\Phi\\!\\left(\\frac{0-\\frac{1}{2}}{\\sqrt{\\frac{3}{4}}}\\right)\n=\\Phi\\!\\left(\\frac{\\frac{1}{2}}{\\sqrt{\\frac{3}{4}}}\\right)\n=\\Phi\\!\\left(\\frac{1}{\\sqrt{3}}\\right),\n$$\n其中 $\\Phi(a)=\\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{a}\\exp\\!\\left(-\\frac{u^{2}}{2}\\right)\\,du$ 是标准正态累积分布函数。\n\n数值上，$\\frac{1}{\\sqrt{3}}\\approx 0.577350$，因此\n$$\n\\mathbb{P}\\big(W(1)>0 \\,\\big|\\, W(4)=2\\big)=\\Phi\\!\\left(\\frac{1}{\\sqrt{3}}\\right)\\approx 0.718 \\quad \\text{(保留三位有效数字)}.\n$$", "answer": "$$\\boxed{0.718}$$", "id": "1333421"}, {"introduction": "从连续状态的维纳过程转向离散状态的泊松过程，后者是模拟随机事件（如网络中的数据包到达）的基础。本练习 [@problem_id:1333460] 探讨了一个核心问题：在已知总事件数的情况下，如何确定事件在不同时间段内的分布。这个问题揭示了泊松过程增量性质的一个基本且应用广泛的推论。", "problem": "网络路由器上数据包的到达被建模为一个泊松过程，记为 $\\{N(t), t \\ge 0\\}$，其恒定平均速率为每秒 $\\lambda$ 个数据包。路由器在时间 $t=0$ 开始运行。为了进行计划性维护，路由器在时间区间 $(t_1, t_2]$ 内被关闭，其中 $0  t_1  t_2$。一位观察者在从 $t=0$ 到 $t=t_3$ 的整个时间段内监测该路由器，其中 $t_3 > t_2$。在这整个期间，发现在路由器运行期间总共到达了 $n$ 个数据包。\n\n给定这些信息，在这 $n$ 个数据包中，恰好有 $k$ 个在维护关闭之前（即，在区间 $[0, t_1]$ 内）到达的概率是多少？\n\n请用符号参数 $n$、$k$、$t_1$、$t_2$ 和 $t_3$ 表示，给出一个闭式解析表达式作为你的答案。", "solution": "设 $\\{N(t), t \\ge 0\\}$ 是一个速率为 $\\lambda$ 的齐次泊松过程。路由器在不相交的区间 $[0, t_{1}]$ 和 $(t_{2}, t_{3}]$ 上运行。定义随机变量\n$$\nX = N(t_{1}) - N(0), \\quad Y = N(t_{3}) - N(t_{2}),\n$$\n它们分别计算在 $[0, t_{1}]$ 和 $(t_{2}, t_{3}]$ 期间的到达次数。根据泊松过程的独立增量性质，$X$ 和 $Y$ 是独立的。根据增量的分布，\n$$\nX \\sim \\text{Poisson}(\\lambda t_{1}), \\quad Y \\sim \\text{Poisson}(\\lambda (t_{3} - t_{2})).\n$$\n观察者报告称，在路由器运行时总共到达了 $n$ 个数据包，因此给定条件 $X + Y = n$。我们要求解对于 $k \\in \\{0, 1, \\ldots, n\\}$ 的 $P(X = k \\mid X + Y = n)$。\n\n使用条件概率的定义和独立性，\n$$\nP(X = k \\mid X + Y = n) = \\frac{P(X = k, Y = n - k)}{P(X + Y = n)}.\n$$\n分子中的联合概率可分解为\n$$\nP(X = k, Y = n - k) = P(X = k)\\,P(Y = n - k) = \\exp(-\\lambda t_{1}) \\frac{(\\lambda t_{1})^{k}}{k!} \\cdot \\exp(-\\lambda (t_{3} - t_{2})) \\frac{(\\lambda (t_{3} - t_{2}))^{n - k}}{(n - k)!}.\n$$\n由于独立泊松随机变量的和仍然是泊松分布，其均值为各均值之和，因此分母为\n$$\nP(X + Y = n) = \\exp(-\\lambda (t_{1} + t_{3} - t_{2})) \\frac{(\\lambda (t_{1} + t_{3} - t_{2}))^{n}}{n!}.\n$$\n因此，\n$$\nP(X = k \\mid X + Y = n) = \\frac{\\exp(-\\lambda t_{1}) \\exp(-\\lambda (t_{3} - t_{2})) (\\lambda t_{1})^{k} (\\lambda (t_{3} - t_{2}))^{n - k} \\frac{n!}{k!(n-k)!}}{\\exp(-\\lambda (t_{1} + t_{3} - t_{2})) (\\lambda (t_{1} + t_{3} - t_{2}))^{n}}.\n$$\n消去指数项和 $\\lambda$ 的幂次，得到二项分布形式\n$$\nP(X = k \\mid X + Y = n) = \\binom{n}{k} \\left(\\frac{t_{1}}{t_{1} + t_{3} - t_{2}}\\right)^{k} \\left(\\frac{t_{3} - t_{2}}{t_{1} + t_{3} - t_{2}}\\right)^{n - k}.\n$$\n这就给出了所求的概率，即在观测到的 $n$ 个数据包中，恰好有 $k$ 个在关闭前到达。", "answer": "$$\\boxed{\\binom{n}{k}\\left(\\frac{t_{1}}{t_{1}+t_{3}-t_{2}}\\right)^{k}\\left(\\frac{t_{3}-t_{2}}{t_{1}+t_{3}-t_{2}}\\right)^{n-k}}$$", "id": "1333460"}, {"introduction": "在理论学习之后，检验一个概念是否在一个更复杂的派生过程中依然成立是至关重要的。本练习以金融数学中的基石模型——几何布朗运动（GBM）为例，要求我们严格地根据定义来判断其是否具有平稳或独立增量。这个思辨性练习 [@problem_id:1333464] 能加深我们对这些核心概念的理解，并防止错误地推广结论。", "problem": "在量化金融中，一个不支付股息的股票价格的常用模型是几何布朗运动。考虑一个由随机过程 $\\{S(t)\\}_{t \\ge 0}$ 表示的股票价格模型，其方程如下：\n$$S(t) = S_0 \\exp(\\mu t + \\sigma W(t))$$\n其中 $S_0 > 0$ 是 $t=0$ 时的初始股价，$\\mu$ 是恒定的漂移率，$\\sigma > 0$ 是恒定的波动率，而 $\\{W(t)\\}_{t \\ge 0}$ 是一个标准维纳过程。\n\n一个标准维纳过程 $\\{W(t)\\}_{t \\ge 0}$ 具有以下性质：\n1.  $W(0) = 0$。\n2.  它具有平稳且独立的增量。\n3.  对于任何 $t > 0$，随机变量 $W(t)$ 服从均值为 0、方差为 $t$ 的正态分布，即 $W(t) \\sim N(0, t)$。\n\n对于一个一般的随机过程 $\\{Y(t)\\}_{t \\ge 0}$，平稳增量和独立增量的定义如下：\n-   **独立增量**：对于任意时间序列 $0 \\le t_1  t_2  \\dots  t_n$，代表增量的随机变量 $Y(t_2) - Y(t_1), Y(t_3) - Y(t_2), \\dots, Y(t_n) - Y(t_{n-1})$ 是相互独立的。\n-   **平稳增量**：对于任意两个时间 $s \\ge 0$ 和 $t > 0$，增量 $Y(s+t) - Y(s)$ 的概率分布仅取决于时间区间的长度 $t$，而不取决于起始时间 $s$。\n\n根据这些定义，判断下列哪个关于上述定义的股价过程 $\\{S(t)\\}_{t \\ge 0}$ 的陈述是正确的。\n\nA. 过程 $\\{S(t)\\}$ 具有平稳增量，但不具有独立增量。\nB. 过程 $\\{S(t)\\}$ 具有独立增量，但不具有平稳增量。\nC. 过程 $\\{S(t)\\}$ 同时具有平稳增量和独立增量。\nD. 过程 $\\{S(t)\\}$ 既不具有平稳增量，也不具有独立增量。", "solution": "我们已知过程 $S(t) = S_{0}\\exp(\\mu t + \\sigma W(t))$，其中 $\\{W(t)\\}_{t \\ge 0}$ 是一个标准维纳过程，满足 $W(0)=0$，具有平稳和独立的增量，且 $W(t) \\sim N(0,t)$。\n\n首先，我们表示一个从时间 $s \\ge 0$ 开始、长度为 $t$ 的区间上的增量。利用 $W$ 的独立增量特性，\n$$\nS(s+t) = S_{0}\\exp(\\mu (s+t) + \\sigma W(s+t)) = S_{0}\\exp(\\mu s + \\sigma W(s))\\exp(\\mu t + \\sigma (W(s+t)-W(s))) = S(s)\\exp(\\mu t + \\sigma \\Delta W),\n$$\n其中 $\\Delta W := W(s+t)-W(s)$ 独立于 $\\mathcal{F}_{s}$ 并且 $\\Delta W \\sim N(0,t)$。因此，\n$$\nS(s+t) - S(s) = S(s)\\left[\\exp(\\mu t + \\sigma \\Delta W) - 1\\right].\n$$\n\n要检验增量的平稳性，$S(s+t)-S(s)$ 的分布必须只依赖于 $t$，而不依赖于 $s$。从上面的表达式可以看出，在以 $S(s)$ 为条件的条件下，该增量是 $\\exp(\\mu t + \\sigma \\Delta W) - 1$ 的一个缩放版本，其随机缩放因子为 $S(s)$。由于 $S(s)$ 的分布依赖于 $s$（实际上 $S(s) = S_{0}\\exp(\\mu s + \\sigma W(s))$，因此随 $s$ 变化），$S(s+t)-S(s)$ 的无条件分布也依赖于 $s$。通过一阶矩的具体检验可以证实这种依赖性：\n$$\n\\mathbb{E}[S(s+t)-S(s)\\mid S(s)] = S(s)\\left(\\mathbb{E}\\left[\\exp(\\mu t + \\sigma \\Delta W)\\right]-1\\right) = S(s)\\left(\\exp\\left(\\mu t + \\frac{1}{2}\\sigma^{2}t\\right)-1\\right),\n$$\n所以\n$$\n\\mathbb{E}[S(s+t)-S(s)] = \\mathbb{E}[S(s)]\\left(\\exp\\left(\\mu t + \\frac{1}{2}\\sigma^{2}t\\right)-1\\right).\n$$\n但是 $\\mathbb{E}[S(s)] = S_{0}\\exp\\left(\\mu s + \\frac{1}{2}\\sigma^{2}s\\right)$，因此 $\\mathbb{E}[S(s+t)-S(s)]$ 依赖于 $s$，这违反了增量的平稳性。因此，$\\{S(t)\\}$ 不具有平稳增量。\n\n要检验增量的独立性，考虑不相交的区间 $[t_{1},t_{2}]$ 和 $[t_{2},t_{3}]$，其中 $0 \\le t_{1}  t_{2}  t_{3}$。定义 $\\Delta t_{1} := t_{2}-t_{1}$ 和 $\\Delta t_{2} := t_{3}-t_{2}$ 以及相应的维纳增量 $\\Delta W_{1} := W(t_{2})-W(t_{1})$ 和 $\\Delta W_{2} := W(t_{3})-W(t_{2})$，它们是独立的。那么\n$$\nS(t_{2}) = S(t_{1})\\exp(\\mu \\Delta t_{1} + \\sigma \\Delta W_{1}),\n$$\n并且两个连续的增量是\n$$\nI_{1} := S(t_{2}) - S(t_{1}) = S(t_{1})\\left[\\exp(\\mu \\Delta t_{1} + \\sigma \\Delta W_{1}) - 1\\right],\n$$\n$$\nI_{2} := S(t_{3}) - S(t_{2}) = S(t_{2})\\left[\\exp(\\mu \\Delta t_{2} + \\sigma \\Delta W_{2}) - 1\\right] = S(t_{1})\\exp(\\mu \\Delta t_{1} + \\sigma \\Delta W_{1})\\left[\\exp(\\mu \\Delta t_{2} + \\sigma \\Delta W_{2}) - 1\\right].\n$$\n尽管 $\\Delta W_{1}$ 和 $\\Delta W_{2}$ 是独立的，但 $I_{1}$ 和 $I_{2}$ 都共享了共同的随机因子 $S(t_{1})$ 以及因子 $\\exp(\\mu \\Delta t_{1} + \\sigma \\Delta W_{1})$，后者是关于截至时间 $t_{2}$ 的过去信息可测的。因此，$I_{2}$ 并不独立于由截至时间 $t_{2}$ 的过去信息生成的 sigma-代数，特别是它不独立于 $I_{1}$。因此，$\\{S(t)\\}$ 的增量不是独立的。\n\n由于过程 $\\{S(t)\\}$ 既不具有平稳增量也不具有独立增量，所以正确选项是 D。\n\n（作为背景知识，对数价格过程 $\\ln S(t) = \\ln S_{0} + \\mu t + \\sigma W(t)$ 确实具有平稳和独立的增量，但 $S(t)$ 本身不具有。）", "answer": "$$\\boxed{D}$$", "id": "1333464"}]}