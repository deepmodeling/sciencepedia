{"hands_on_practices": [{"introduction": "非齐次泊松过程，和其齐次形式一样，拥有一个关键特性：独立增量性。这意味着，未来任何时间区间内发生的事件数量，与过去已发生的事件无关。本练习 [@problem_id:1321724] 将挑战你应用这一基本原理，检验你是否能从历史数据中分辨出必要信息和无关信息。", "problem": "一个先进的天文台正在进行一项河外超新星的巡天观测。这些事件的探测被建模为一个非齐次泊松过程 (NHPP)，其探测率随时间变化。探测的强度函数由 $\\lambda(t) = \\beta t$ 给出，其中 $t$ 是自巡天开始以来的年数，常数 $\\beta$ 等于 $0.5$ 事件/年$^2$。\n\n该巡天观测已运行了整整 4 年，在此期间，总共探测到了 10 颗超新星。\n\n计算在巡天的第五年期间（即，在时间区间从 $t=4$ 到 $t=5$）将正好探测到 3 颗新超新星的概率。将您的答案表示为小数，并四舍五入到四位有效数字。", "solution": "对于一个强度函数为 $\\lambda(t)$ 的非齐次泊松过程 (NHPP)，在区间 $[s,t]$ 内的事件数服从泊松分布，其均值等于该区间上的积分强度：\n$$\n\\Lambda(s,t) = \\int_{s}^{t} \\lambda(u)\\,du.\n$$\n此外，NHPP 具有独立增量性，因此在 $[4,5]$ 内的计数与 $t=4$ 之前的任何计数无关。因此，即使已知在 $[0,4]$ 内发生了 10 个事件，在 $[4,5]$ 内的事件数分布也不受影响。\n\n当 $\\lambda(t) = \\beta t$ 且 $\\beta = 0.5$ 时，第五年探测到的平均事件数是\n$$\n\\mu = \\int_{4}^{5} \\beta u\\,du = \\beta \\left[\\frac{u^{2}}{2}\\right]_{4}^{5} = \\beta \\cdot \\frac{25-16}{2} = \\beta \\cdot \\frac{9}{2}.\n$$\n代入 $\\beta = 0.5$ 得\n$$\n\\mu = \\frac{9}{2} \\cdot 0.5 = \\frac{9}{4} = 2.25.\n$$\n因此，在 $[4,5]$ 内发生恰好 $k=3$ 个事件的概率由泊松概率质量函数给出：\n$$\n\\mathbb{P}\\{N(5)-N(4)=3\\} = \\frac{\\exp(-\\mu)\\,\\mu^{3}}{3!} = \\frac{\\exp(-2.25)\\,(2.25)^{3}}{6}.\n$$\n进行数值计算：\n$$\n(2.25)^{3} = 11.390625,\\quad \\frac{11.390625}{6} = 1.8984375,\\quad \\exp(-2.25) \\approx 0.1053992246,\n$$\n所以\n$$\n\\mathbb{P}\\{N(5)-N(4)=3\\} \\approx 1.8984375 \\times 0.1053992246 \\approx 0.2000938404.\n$$\n四舍五入到四位有效数字，结果是 $0.2001$。", "answer": "$$\\boxed{0.2001}$$", "id": "1321724"}, {"introduction": "除了简单地对事件计数，理解事件最可能在*何时*发生也同样重要。在已知某段时间内发生了特定数量事件的条件下，我们可以计算这些事件落在某个特定子区间的概率。本练习 [@problem_id:1321697] 探讨了这一概念，揭示了时变强度函数 $\\lambda(t)$ 与事件发生时间的条件概率之间一个简洁而优美的关系。", "problem": "在对职业足球比赛的统计分析中，发现进球率随时间非恒定，通常随着球员疲劳而增加。这一现象使用一个随时间变化的速率函数 $\\lambda(t)$ 来建模，其中 $t$ 是从比赛开始算起的分钟数。对于某一场特定的比赛，该速率由函数 $\\lambda(t) = A + Bt$ 描述，其中给定常数 $A = 0.01 \\text{ min}^{-1}$ 和 $B = 0.001 \\text{ min}^{-2}$。\n\n假设已知本场比赛的上半场（持续45分钟）内恰好进了一个球。那么这唯一的一个球是在比赛的前15分钟内攻入的概率是多少？\n\n答案以四位有效数字的小数形式给出。", "solution": "将进球建模为速率为 $\\lambda(t)=A+Bt$ 的非齐次泊松过程。其累积强度为\n$$\n\\Lambda(t)=\\int_{0}^{t}\\lambda(u)\\,du=\\int_{0}^{t}\\left(A+Bu\\right)\\,du=At+\\frac{B}{2}t^{2}.\n$$\n令 $T=45$ 且 $s=15$。使用非齐次泊松过程的独立增量特性，$N(s)\\sim \\text{Poisson}(\\Lambda(s))$ 且 $N(T)-N(s)\\sim \\text{Poisson}(\\Lambda(T)-\\Lambda(s))$，两者独立。因此\n$$\n\\mathbb{P}(N(s)=1,\\,N(T)-N(s)=0)=\\exp(-\\Lambda(T))\\,\\Lambda(s),\n$$\n且\n$$\n\\mathbb{P}(N(T)=1)=\\exp(-\\Lambda(T))\\,\\Lambda(T).\n$$\n因此所求的条件概率为\n$$\n\\mathbb{P}(\\text{the single goal occurs by }s \\mid N(T)=1)=\\frac{\\Lambda(s)}{\\Lambda(T)}.\n$$\n当 $A=0.01$ 和 $B=0.001$ 时，\n$$\n\\Lambda(15)=A\\cdot 15+\\frac{B}{2}\\cdot 15^{2}=0.15+0.1125=0.2625,\n$$\n$$\n\\Lambda(45)=A\\cdot 45+\\frac{B}{2}\\cdot 45^{2}=0.45+1.0125=1.4625.\n$$\n因此\n$$\n\\frac{\\Lambda(15)}{\\Lambda(45)}=\\frac{0.2625}{1.4625}=\\frac{21/80}{117/80}=\\frac{21}{117}=\\frac{7}{39}\\approx 0.179487\\ldots\n$$\n四舍五入到四位有效数字，结果为 $0.1795$。", "answer": "$$\\boxed{0.1795}$$", "id": "1321697"}, {"introduction": "我们如何才能生成一个遵循特定时变速率的事件序列？“细化法”（Thinning Method）或称“接受-拒绝法”为此提供了一种强大而直观的算法，可用于模拟非齐次泊松过程。本动手练习 [@problem_id:1332048] 将带你逐步体验这一模拟技术，将抽象的强度函数 $\\lambda(t)$ 转化为一组具体的事件时间点。", "problem": "一家电子商务公司正在分析一次为时10分钟的“闪购”活动期间的服务器请求模式。传入请求的速率 $\\lambda(t)$ 不是恒定的。它被建模为一个随时间变化的强度函数，其中 $t$ 是从 $t=0$ 销售开始时算起的时间（单位：分钟）。该强度函数是三角形的：它从 $t=0$ 时的0线性增加到 $t_{peak} = 4$ 分钟时的峰值 $\\lambda_{max} = 20$ 请求/分钟，然后在销售结束时（$T = 10$ 分钟）线性减少回0。\n\n为了模拟这个非齐次泊松过程，使用了稀疏法（也称为接受-拒绝法）。该方法首先从一个恒定速率为 $\\lambda^*$ 的齐次泊松过程中生成候选事件时间，该齐次泊松过程包络了真实的强度函数，即对于 $[0, T]$ 中的所有 $t$，都有 $\\lambda^* \\geq \\lambda(t)$。使用了最优选择 $\\lambda^* = \\max_{t \\in [0,T]} \\lambda(t)$。\n\n假设已经从这个上界齐次过程中生成了一组五个候选请求时间 $S_i$。对于每个候选时间 $S_i$，从 $[0, 1]$ 上的均匀分布中抽取一个对应的随机数 $U_i$，以决定是“稀疏”（拒绝）还是保留（接受）该候选时间。\n\n生成的数据如下：\n- 候选时间（分钟）：$S_1 = 1.20, S_2 = 3.50, S_3 = 4.80, S_4 = 6.50, S_5 = 9.20$\n- 均匀分布随机数：$U_1 = 0.25, U_2 = 0.90, U_3 = 0.85, U_4 = 0.51, U_5 = 0.15$\n\n使用稀疏法，确定哪些候选请求被接受。计算这些被接受的请求的时间总和。用分钟表示你的最终答案，并四舍五入到三位有效数字。", "solution": "稀疏法以概率 $p(S) = \\lambda(S)/\\lambda^{*}$ 接受候选时间 $S$，其中 $\\lambda^{*} = \\max_{t \\in [0,T]} \\lambda(t)$。对于给定的在 $[0,10]$ 分钟内的三角形强度函数：\n- 对于 $0 \\leq t \\leq 4$，强度从 $0$ 线性增加到 $20$，所以 $\\lambda(t) = 5 t$。\n- 对于 $4  t \\leq 10$，强度从 $20$ 线性减少到 $0$，所以 $\\lambda(t) = 20 - \\frac{10}{3}(t-4) = \\frac{100}{3} - \\frac{10}{3} t$。\n因此 $\\lambda^{*} = 20$，接受概率为\n$$\np(t) = \\frac{\\lambda(t)}{20} =\n\\begin{cases}\n\\frac{t}{4},  0 \\leq t \\leq 4 \\\\\n\\frac{10 - t}{6},  4  t \\leq 10\n\\end{cases}\n$$\n如果 $U_{i} \\leq p(S_{i})$，则接受，否则拒绝。\n\n评估每个候选者：\n1) $S_{1} = 1.20 \\in [0,4]$: $p(S_{1}) = \\frac{1.20}{4} = 0.30 = \\frac{3}{10}$。因为 $U_{1} = 0.25 \\leq 0.30$，所以接受 $S_{1}$。\n\n2) $S_{2} = 3.50 \\in [0,4]$: $p(S_{2}) = \\frac{3.50}{4} = 0.875 = \\frac{7}{8}$。因为 $U_{2} = 0.90  0.875$，所以拒绝 $S_{2}$。\n\n3) $S_{3} = 4.80 \\in (4,10]$: $p(S_{3}) = \\frac{10 - 4.80}{6} = \\frac{5.20}{6} = \\frac{13}{15} \\approx 0.8667$。因为 $U_{3} = 0.85 \\leq \\frac{13}{15}$，所以接受 $S_{3}$。\n\n4) $S_{4} = 6.50 \\in (4,10]$: $p(S_{4}) = \\frac{10 - 6.50}{6} = \\frac{3.50}{6} = \\frac{7}{12} \\approx 0.5833$。因为 $U_{4} = 0.51 \\leq \\frac{7}{12}$，所以接受 $S_{4}$。\n\n5) $S_{5} = 9.20 \\in (4,10]$: $p(S_{5}) = \\frac{10 - 9.20}{6} = \\frac{0.80}{6} = \\frac{2}{15} \\approx 0.1333$。因为 $U_{5} = 0.15  \\frac{2}{15}$，所以拒绝 $S_{5}$。\n\n被接受的候选时间是 $S_{1} = 1.20$、$S_{3} = 4.80$ 和 $S_{4} = 6.50$。被接受的时间总和为\n$$\n1.20 + 4.80 + 6.50 = 12.50 \\text{ minutes}.\n$$\n四舍五入到三位有效数字，结果是 $12.5$ 分钟。", "answer": "$$\\boxed{12.5}$$", "id": "1332048"}]}