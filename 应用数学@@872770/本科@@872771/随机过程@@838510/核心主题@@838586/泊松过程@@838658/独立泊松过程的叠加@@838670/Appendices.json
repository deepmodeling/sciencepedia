{"hands_on_practices": [{"introduction": "本练习探讨了泊松过程叠加的一个基本性质。当我们合并多个独立的泊松事件流时，新合并的事件流中的任何一个事件都可能源自任何一个原始流。这个问题 [@problem_id:1335982] 将帮助我们理解，当总事件数达到一个特定阈值时，如何确定来自每个原始源的事件数量的概率分布。这个概念在竞争风险模型中非常重要，例如在可靠性工程或生物统计学中。", "problem": "一台高性能计算服务器的核心处理单元会受到两种独立的瞬态硬件错误源的影响。来自一个称为源A的过程的错误以泊松过程的形式发生，平均速率为每单位时间 $\\lambda_A$ 个错误。来自另一个过程，源B的错误以独立的泊松过程的形式发生，平均速率为每单位时间 $\\lambda_B$ 个错误。\n\n该服务器具有一个记录错误的容错机制。然而，为了防止关键数据损坏，系统被设计为一旦来自源A和源B的总累积错误数达到一个预定义的整数阈值 $k$，就立即触发紧急关机。\n\n假设系统在时间 $t=0$ 时处于完美状态，请确定在系统关机的确切时刻，恰好有 $n$ 个错误（其中 $n$ 是一个满足 $0 \\le n \\le k$ 的整数）源自源A的概率。将您的答案表示为 $n, k, \\lambda_A$ 和 $\\lambda_B$ 的函数。", "solution": "设 $N_{A}(t)$ 和 $N_{B}(t)$ 分别是速率为 $\\lambda_{A}$ 和 $\\lambda_{B}$ 的独立泊松过程。它们的叠加过程 $N(t)=N_{A}(t)+N_{B}(t)$ 是一个速率为 $\\lambda=\\lambda_{A}+\\lambda_{B}$ 的泊松过程（独立泊松过程的叠加性质）。\n\n设 $T_{k}$ 表示组合过程 $N(t)$ 中第 $k$ 个事件发生的时间。系统在 $T_{k}$ 时刻关机。我们要求解 $\\mathbb{P}\\{N_{A}(T_{k})=n\\}$，其中 $n$ 是满足 $0 \\leq n \\leq k$ 的整数。\n\n考虑组合过程的到达时间序列。在任何一次到达之前，到下一次A错误的时间服从速率为 $\\lambda_{A}$ 的指数分布，到下一次B错误的时间服从速率为 $\\lambda_{B}$ 的指数分布，它们彼此独立且与过去无关（独立增量和无记忆性）。根据竞争指数分布的性质，下一次组合到达来自A的概率等于\n$$\np=\\mathbb{P}\\{\\text{next arrival is from }A\\}=\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}.\n$$\n无记忆性意味着每次到达都适用相同的概率 $p$，且独立于之前的来源标签。因此，前 $k$ 次到达的来源构成一个成功概率为 $p$ 的独立伯努利试验序列。因此，在前 $k$ 个组合错误中源自A的错误数量，即 $N_{A}(T_{k})$，服从二项分布：\n$$\n\\mathbb{P}\\{N_{A}(T_{k})=n\\}=\\binom{k}{n}p^{n}(1-p)^{k-n}, \\quad 0 \\leq n \\leq k.\n$$\n将 $p=\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}$ 和 $1-p=\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}$ 代入可得\n$$\n\\mathbb{P}\\{N_{A}(T_{k})=n\\}=\\binom{k}{n}\\left(\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}\\right)^{n}\\left(\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\right)^{k-n}, \\quad 0 \\leq n \\leq k.\n$$\n这个分布只取决于速率，而与 $T_{k}$ 的实际值无关。", "answer": "$$\\boxed{\\binom{k}{n}\\left(\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}}\\right)^{n}\\left(\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\right)^{k-n}}$$", "id": "1335982"}, {"introduction": "泊松过程的叠加原理不仅限于时间上的事件，它同样可以有力地应用于空间分布。这个问题 [@problem_id:1335979] 挑战我们将这些概念应用于一个涉及半导体晶圆上缺陷分布的二维场景。这是一个很好的练习，可以帮助我们掌握“空隙概率”的计算，即在给定区域内未发现任何事件的概率，这是空间过程分析的基石。", "problem": "在一种先进的半导体制造工艺中，两种类型的微观电学点缺陷，分别称为 A 型和 B 型，可能会出现在硅晶圆的表面。这些缺陷的位置可以通过两个独立的、均匀的二维空间泊松点过程很好地建模。A 型缺陷过程的强度为常数 $\\lambda_A$ 个缺陷/单位面积，B 型缺陷过程的强度为 $\\lambda_B$ 个缺陷/单位面积。\n\n使用自动化光学检测工具扫描晶圆并对这些缺陷进行分类。然而，该工具的分类算法根据其他缺陷的邻近程度存在特定的限制。成功识别的规则如下：\n- 一个 A 型缺陷被成功识别，当且仅当其位置的半径 $R_A$ 范围内没有其他 A 型缺陷，且半径 $R_B$ 范围内没有 B 型缺陷。\n- 一个 B 型缺陷被成功识别，当且仅当其位置的半径 $R_C$ 范围内没有其他*任何*类型（A 或 B）的缺陷。\n\n考虑从一个非常大的晶圆上的所有缺陷中均匀随机选择一个缺陷。计算这个被选中的缺陷被检测工具成功识别的概率。你的答案应该是一个用给定参数 $\\lambda_A$、$\\lambda_B$、$R_A$、$R_B$ 和 $R_C$ 表示的符号表达式。", "solution": "令 $I$ 表示随机选择的缺陷被成功识别的事件。问题要求计算概率 $P(I)$。随机选择的缺陷可以是 A 型或 B 型。令 $T_A$ 为所选缺陷为 A 型的事件，$T_B$ 为所选缺陷为 B 型的事件。根据全概率公式，我们可以写出：\n$$P(I) = P(I | T_A) P(T_A) + P(I | T_B) P(T_B)$$\n\n首先，我们确定概率 $P(T_A)$ 和 $P(T_B)$。对于一个非常大的区域 $S$，A 型缺陷的期望数量为 $N_A = \\lambda_A S$，B 型缺陷的期望数量为 $N_B = \\lambda_B S$。缺陷的总期望数量为 $N_{total} = N_A + N_B = (\\lambda_A + \\lambda_B)S$。随机选择一个缺陷为 A 型的概率是 A 型缺陷数量与总缺陷数量之比，当区域很大时，这趋近于它们强度的比率。\n$$P(T_A) = \\frac{\\lambda_A S}{(\\lambda_A + \\lambda_B)S} = \\frac{\\lambda_A}{\\lambda_A + \\lambda_B}$$\n类似地，\n$$P(T_B) = \\frac{\\lambda_B S}{(\\lambda_A + \\lambda_B)S} = \\frac{\\lambda_B}{\\lambda_A + \\lambda_B}$$\n\n接下来，我们需要求条件概率 $P(I | T_A)$ 和 $P(I | T_B)$。这涉及到泊松点过程的性质。一个关键性质（通常与 Slivnyak 定理或 Palm 分布相关）是，以某个位置存在一个过程点为条件，并不会改变过程中所有其他点的统计分布。\n\n让我们计算 $P(I | T_A)$。这是 A 型缺陷可被识别的概率。让我们假设这个“典型”的 A 型缺陷位于原点。要使其被识别，必须满足两个条件：\n1.  在以原点为中心、半径为 $R_A$ 的圆盘内，没有*其他* A 型缺陷。该圆盘的面积是 $\\pi R_A^2$。此区域内其他 A 型缺陷的数量遵循泊松分布，其均值为 $\\mu_{A_1} = \\lambda_A \\pi R_A^2$。不存在此类缺陷的概率为 $P_1 = \\exp(-\\mu_{A_1}) = \\exp(-\\lambda_A \\pi R_A^2)$。\n2.  在以原点为中心、半径为 $R_B$ 的圆盘内，没有 B 型缺陷。该区域的面积是 $\\pi R_B^2$。此区域内 B 型缺陷的数量遵循泊松分布，其均值为 $\\mu_{A_2} = \\lambda_B \\pi R_B^2$。不存在此类缺陷的概率为 $P_2 = \\exp(-\\mu_{A_2}) = \\exp(-\\lambda_B \\pi R_B^2)$。\n\n由于两个泊松过程（A 型和 B 型缺陷的）是独立的，这两个圆盘为空的事件也是独立的。因此，我们可以将它们的概率相乘：\n$$P(I | T_A) = P_1 \\times P_2 = \\exp(-\\lambda_A \\pi R_A^2) \\exp(-\\lambda_B \\pi R_B^2) = \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2))$$\n\n现在我们计算 $P(I | T_B)$。这是 B 型缺陷可被识别的概率。我们将这个典型的 B 型缺陷置于原点。要使其被识别，半径为 $R_C$ 的范围内必须没有*其他*任何类型（A 或 B）的缺陷。\n根据独立泊松过程的叠加性质，所有缺陷（A 型和 B 型）的组合过程本身也是一个泊松过程，其强度为 $\\lambda_{total} = \\lambda_A + \\lambda_B$。\n当我们以一个 B 型缺陷位于原点为条件时，所有*其他*缺陷（A 型和 B 型）的分布仍然是一个强度为 $\\lambda_{total}$ 的泊松过程。\n我们需要以原点为中心、半径为 $R_C$ 的圆盘内没有这些其他缺陷。该圆盘的面积是 $\\pi R_C^2$。此区域内其他缺陷的数量遵循泊松分布，其均值为 $\\mu_B = \\lambda_{total} \\pi R_C^2 = (\\lambda_A + \\lambda_B) \\pi R_C^2$。\n在该区域内没有缺陷的概率是：\n$$P(I | T_B) = \\exp(-\\mu_B) = \\exp(-(\\lambda_A + \\lambda_B) \\pi R_C^2)$$\n\n最后，我们将这些表达式代入全概率公式中：\n$$P(I) = P(I | T_A) P(T_A) + P(I | T_B) P(T_B)$$\n$$P(I) = \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2)) \\left(\\frac{\\lambda_A}{\\lambda_A + \\lambda_B}\\right) + \\exp(-(\\lambda_A + \\lambda_B) \\pi R_C^2) \\left(\\frac{\\lambda_B}{\\lambda_A + \\lambda_B}\\right)$$\n将各项合并到一个公分母上，得到最终的概率表达式：\n$$P(I) = \\frac{\\lambda_A \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2)) + \\lambda_B \\exp(-\\pi(\\lambda_A + \\lambda_B) R_C^2)}{\\lambda_A + \\lambda_B}$$", "answer": "$$\\boxed{\\frac{\\lambda_A \\exp(-\\pi(\\lambda_A R_A^2 + \\lambda_B R_B^2)) + \\lambda_B \\exp(-\\pi(\\lambda_A + \\lambda_B) R_C^2)}{\\lambda_A + \\lambda_B}}$$", "id": "1335979"}, {"introduction": "现在我们转向一个更具动态性的场景，其中来自叠加泊松过程的事件可以用来模拟系统状态随时间的演变。这个高级问题 [@problem_id:1335999] 介绍了一个具有“记忆”的系统，其对事件的响应取决于过去发生的事件。我们将看到这种情况如何引导我们构建一个连续时间马尔可夫链模型，并学习如何分析其长期稳态行为，这在通信网络和粒子物理等领域都有广泛应用。", "problem": "一个专门的天体物理传感器被设计用于探测两种奇异粒子，A型和B型。A型粒子到达传感器的过程遵循一个泊松过程，其恒定速率为每秒 $\\lambda_A$ 个粒子。独立地，B型粒子到达的过程遵循另一个泊松过程，其恒定速率为每秒 $\\lambda_B$ 个粒子。\n\n该传感器的数据记录系统具有一种特殊的条件记忆功能。它根据以下规则运行：\n1. 每一次探测到的A型粒子总是会被记录。\n2. 一次探测到的B型粒子被记录的*当且仅当*紧邻其前被记录的粒子是A型。如果前一个被记录的粒子是B型，那么任何新的B型粒子探测都将被忽略且不被记录，直到一个A型粒子被记录为止。\n\n假设传感器已经运行了足够长的时间以达到稳态，请确定在时长为 $T$ 的时间间隔内，被记录的B型粒子的期望数量。你的答案应该是一个用 $\\lambda_A$、$\\lambda_B$ 和 $T$ 表示的符号表达式。", "solution": "设 $N_{A}(t)$ 和 $N_{B}(t)$ 分别是速率为 $\\lambda_{A}$ 和 $\\lambda_{B}$ 的独立泊松过程。定义记录状态过程 $S(t)\\in\\{A,B\\}$ 为在时间 $t$ 时最近被记录的粒子的类型。因为每一次A型粒子的探测总是被记录，而B型粒子的探测仅在紧邻其前被记录的粒子是A型时才被记录，所以 $S(t)$ 的演化是一个由粒子到达驱动的连续时间马尔可夫链：\n- 当 $S(t)=A$ 时，任何B型粒子的到达都会被记录，并使状态切换到 $B$。因此，转移速率 $A\\to B$ 是 $\\lambda_{B}$。\n- 当 $S(t)=B$ 时，B型粒子的到达被忽略，状态不改变；下一个A型粒子的到达会被记录，并使状态切换到 $A$。因此，转移速率 $B\\to A$ 是 $\\lambda_{A}$。\n\n因此，这个两状态链的非对角转移速率为 $q_{A,B}=\\lambda_{B}$ 和 $q_{B,A}=\\lambda_{A}$。在稳态下，设 $\\pi_{A}$ 和 $\\pi_{B}$ 为平稳概率。它们满足全局平衡方程和归一化方程\n$$\n\\pi_{A}\\lambda_{B}=\\pi_{B}\\lambda_{A},\\qquad \\pi_{A}+\\pi_{B}=1.\n$$\n求解得到\n$$\n\\pi_{A}=\\frac{\\lambda_{A}}{\\lambda_{A}+\\lambda_{B}},\\qquad \\pi_{B}=\\frac{\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}.\n$$\n\n当 $S(t)=A$ 时，B型粒子被记录的瞬时速率为 $\\lambda_{B}$；当 $S(t)=B$ 时，速率为 $0$。因此，在稳态下，B型粒子被记录的期望速率为\n$$\nr_{B}^{\\text{log}}=\\lambda_{B}\\pi_{A}=\\frac{\\lambda_{A}\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}.\n$$\n根据平稳性，在时长为 $T$ 的时间间隔内，被记录的B型粒子的期望数量是速率乘以 $T$：\n$$\n\\mathbb{E}\\big[N_{B}^{\\text{log}}(T)\\big]=r_{B}^{\\text{log}}\\,T=\\frac{\\lambda_{A}\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\,T.\n$$", "answer": "$$\\boxed{\\frac{\\lambda_{A}\\lambda_{B}}{\\lambda_{A}+\\lambda_{B}}\\,T}$$", "id": "1335999"}]}