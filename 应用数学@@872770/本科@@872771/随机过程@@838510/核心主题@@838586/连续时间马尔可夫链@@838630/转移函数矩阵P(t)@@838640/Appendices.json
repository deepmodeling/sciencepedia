{"hands_on_practices": [{"introduction": "应用马尔可夫链模型最关键的第一步是将真实世界的情景转化为数学语言。这个练习将直接训练这项技能，指导你根据描述性的叙述构建一个单步转移矩阵。通过为一个学生每日的咖啡选择建模，你将学会如何系统地将定性规则转化为定量概率。[@problem_id:1345028]", "problem": "一名大学生的每日咖啡选择可以建模为一个离散时间随机过程。该学生在校园里的三家咖啡店中进行选择：“The Daily Grind”、“Bean Scene”和“Cafe Diem”。我们将此过程的状态空间定义为 {$1, 2, 3$}，分别对应学生光顾 The Daily Grind、Bean Scene 和 Cafe Diem。\n\n该学生的每日转换行为如下：\n- 如果学生某天光顾 The Daily Grind（状态 1），那么第二天有 50% 的概率会再次光顾 The Daily Grind，30% 的概率会换到 Bean Scene，20% 的概率会换到 Cafe Diem。\n- 如果学生某天光顾 Bean Scene（状态 2），那么第二天有 10% 的概率会换到 The Daily Grind，60% 的概率会换到 Cafe Diem。否则，他们会继续光顾 Bean Scene。\n- 如果学生某天光顾 Cafe Diem（状态 3），他们第二天绝不会再光顾 Cafe Diem。相反，他们会以相等的概率转向 The Daily Grind 或 Bean Scene。\n\n为这个马尔可夫链构建一步转移概率矩阵 $P$。矩阵元素 $P_{ij}$ 应表示从状态 $i$ 转移到状态 $j$ 的概率。", "solution": "问题要求解一个具有三个状态的马尔可夫链的一步转移概率矩阵 $P$。状态空间为 $S = \\{1, 2, 3\\}$，其中状态 1 是“The Daily Grind”，状态 2 是“Bean Scene”，状态 3 是“Cafe Diem”。\n\n转移矩阵 $P$ 是一个 $3 \\times 3$ 矩阵，其中第 $i$ 行第 $j$ 列的元素（记为 $P_{ij}$）是在一步内从状态 $i$ 移动到状态 $j$ 的概率。也就是说，$P_{ij} = P(X_{n+1}=j | X_n=i)$。任何转移矩阵的一个关键性质是，每行概率之和必须等于 1，因为从任何给定状态出发，过程必须转移到状态空间中的某个状态。\n\n我们将逐行构建该矩阵。\n\n**第 1 行：从状态 1 (The Daily Grind) 的转移**\n问题陈述，如果学生处于状态 1：\n- 返回 The Daily Grind（状态 1）的概率是 50%。所以，$P_{11} = 0.50$。\n- 转换到 Bean Scene（状态 2）的概率是 30%。所以，$P_{12} = 0.30$。\n- 转换到 Cafe Diem（状态 3）的概率是 20%。所以，$P_{13} = 0.20$。\n我们来检查该行的和：$0.50 + 0.30 + 0.20 = 1.00$。这是正确的。\n因此，$P$ 的第一行是 $[0.50, 0.30, 0.20]$。\n\n**第 2 行：从状态 2 (Bean Scene) 的转移**\n问题陈述，如果学生处于状态 2：\n- 转换到 The Daily Grind（状态 1）的概率是 10%。所以，$P_{21} = 0.10$。\n- 转换到 Cafe Diem（状态 3）的概率是 60%。所以，$P_{23} = 0.60$。\n- 问题陈述他们将“否则返回 Bean Scene”。这意味着剩余的概率对应于停留在状态 2。由于每行的和必须为 1，我们可以计算 $P_{22}$：\n$P_{22} = 1 - P_{21} - P_{23} = 1 - 0.10 - 0.60 = 0.30$。\n我们来检查该行的和：$0.10 + 0.30 + 0.60 = 1.00$。这是正确的。\n因此，$P$ 的第二行是 $[0.10, 0.30, 0.60]$。\n\n**第 3 行：从状态 3 (Cafe Diem) 的转移**\n问题陈述，如果学生处于状态 3：\n- 他们第二天绝不会返回 Cafe Diem（状态 3）。这意味着从状态 3 转移到状态 3 的概率为 0。所以，$P_{33} = 0$。\n- 他们“以相等的概率转换到 The Daily Grind 或 Bean Scene”。该行的总概率必须为 1。移动到状态 3 以外的状态的概率是 $1 - P_{33} = 1 - 0 = 1$。这个剩余的概率在状态 1 和状态 2 之间均等分配。\n- 转换到 The Daily Grind（状态 1）的概率是 $P_{31} = \\frac{1}{2} = 0.50$。\n- 转换到 Bean Scene（状态 2）的概率是 $P_{32} = \\frac{1}{2} = 0.50$。\n我们来检查该行的和：$0.50 + 0.50 + 0 = 1.00$。这是正确的。\n因此，$P$ 的第三行是 $[0.50, 0.50, 0]$。\n\n综合这些行，我们得到完整的转移矩阵 $P$：\n$$\nP = \\begin{pmatrix}\n0.50 & 0.30 & 0.20 \\\\\n0.10 & 0.30 & 0.60 \\\\\n0.50 & 0.50 & 0\n\\end{pmatrix}\n$$\n将条目写成小数是常规做法。\n$$\nP = \\begin{pmatrix}\n0.5 & 0.3 & 0.2 \\\\\n0.1 & 0.3 & 0.6 \\\\\n0.5 & 0.5 & 0.0\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5  & 0.3 & 0.2 \\\\\n0.1  & 0.3 & 0.6 \\\\\n0.5  & 0.5 & 0.0\n\\end{pmatrix}\n}\n$$", "id": "1345028"}, {"introduction": "一个矩阵只有在遵守严格的数学规则时，才能被视为一个随机转移矩阵。这个实践问题通过挑战你求解给定矩阵中的一个未知变量来强化这些基本原则。通过确保所有元素非负且每行之和为一，你将巩固对定义有效转移矩阵基本性质的理解。[@problem_id:1345000]", "problem": "一位理论物理学家正在开发一个简化模型，用于描述量子比特（qubit）在噪声环境中的状态。该模型考虑了量子比特在固定时间间隔后的三种可能的有效状态：态 $|0\\rangle$、态 $|1\\rangle$ 和一个“混合”态 M。这些状态分别被标记为 1、2 和 3。这些状态之间的跃迁由一个马尔可夫链描述，其转移矩阵 $P$ 如下所示：\n\n$$\nP = \\begin{pmatrix}\n0.90  0.05  0.05 \\\\\nx^2  2x  0.25 \\\\\n0.10  0.10  0.80\n\\end{pmatrix}\n$$\n\n此处，$P_{ij}$ 表示从状态 $i$ 跃迁到状态 $j$ 的概率，参数 $x$ 是一个与环境耦合因子相关的实数。确定使 $P$ 成为一个有效的随机转移矩阵的 $x$ 的唯一值。\n\n将您的答案表示为单一的闭式解析表达式。", "solution": "要使一个矩阵成为有效的随机转移矩阵，它必须满足两个条件：\n1. 矩阵的所有元素都必须是非负实数。即，对于所有的 $i, j$，都有 $P_{ij} \\ge 0$。\n2. 每行元素之和必须等于 1。即，对于所有的 $i$，都有 $\\sum_{j} P_{ij} = 1$。\n\n让我们将这些条件应用于给定的矩阵 $P$：\n$$\nP = \\begin{pmatrix}\n0.90  0.05  0.05 \\\\\nx^2  2x  0.25 \\\\\n0.10  0.10  0.80\n\\end{pmatrix}\n$$\n\n首先，我们检查行和条件。\n对于第一行，元素之和为 $0.90 + 0.05 + 0.05 = 1.00$。此条件得到满足。\n对于第三行，元素之和为 $0.10 + 0.10 + 0.80 = 1.00$。此条件也得到满足。\n\n对于第二行，元素之和必须为 1：\n$$\nx^2 + 2x + 0.25 = 1\n$$\n为了求出 $x$ 的值，我们需要解这个二次方程。\n$$\nx^2 + 2x - 0.75 = 0\n$$\n为了便于处理整数，我们可以将整个方程乘以 4：\n$$\n4x^2 + 8x - 3 = 0\n$$\n我们使用二次方程求根公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a=4$，$b=8$，$c=-3$。\n$$\nx = \\frac{-8 \\pm \\sqrt{8^2 - 4(4)(-3)}}{2(4)}\n$$\n$$\nx = \\frac{-8 \\pm \\sqrt{64 + 48}}{8}\n$$\n$$\nx = \\frac{-8 \\pm \\sqrt{112}}{8}\n$$\n我们通过将 112 分解为 $16 \\times 7$ 来简化平方根项。\n$$\n\\sqrt{112} = \\sqrt{16 \\times 7} = 4\\sqrt{7}\n$$\n将此代回 $x$ 的表达式中：\n$$\nx = \\frac{-8 \\pm 4\\sqrt{7}}{8} = \\frac{-2 \\pm \\sqrt{7}}{2}\n$$\n这给出了 $x$ 的两个可能的解：\n$$\nx_1 = \\frac{-2 + \\sqrt{7}}{2} \\quad \\text{和} \\quad x_2 = \\frac{-2 - \\sqrt{7}}{2}\n$$\n\n接下来，我们必须应用非负性条件，$P_{ij} \\ge 0$。\n第一行和第三行的元素都是恒为正的常数，因此它们满足此条件。\n我们必须检查第二行中依赖于 $x$ 的元素：$P_{21} = x^2$，$P_{22} = 2x$ 和 $P_{23} = 0.25$。\n条件 $P_{21} = x^2 \\ge 0$ 对任何实数 $x$ 都成立。\n条件 $P_{23} = 0.25 \\ge 0$ 是一个常数，并且成立。\n条件 $P_{22} = 2x \\ge 0$ 意味着 $x$ 必须是非负的，即 $x \\ge 0$。\n\n现在我们检查我们的两个 $x$ 的解中哪一个满足 $x \\ge 0$。\n对于 $x_1 = \\frac{-2 + \\sqrt{7}}{2}$：因为 $2^2=4$ 且 $3^2=9$，我们有 $2  \\sqrt{7}  3$。因此，$-2 + \\sqrt{7}$ 是正数，且 $x_1 > 0$。这个解是有效的。\n对于 $x_2 = \\frac{-2 - \\sqrt{7}}{2}$：因为 $\\sqrt{7}$ 是正数，分子 $-2 - \\sqrt{7}$ 是负数。因此，$x_2  0$。这个解是无效的，因为它违反了元素 $P_{22}$ 的非负性约束。\n\n因此，使 $P$ 成为一个有效的随机转移矩阵的唯一 $x$ 值是 $x = \\frac{-2 + \\sqrt{7}}{2}$。", "answer": "$$\\boxed{\\frac{-2+\\sqrt{7}}{2}}$$", "id": "1345000"}, {"introduction": "转移矩阵的真正威力在于它能够预测系统的未来状态。这个练习超越了单步转移，探讨了我们如何预测多个时间步长的结果。通过计算两步转移矩阵，你将接触到矩阵乘法这一基本概念，并将其作为推动系统随时间演化的工具，这是马尔可夫链动态建模的基石。[@problem_id:1345030]", "problem": "一个行星科学家团队建立了一个简化的马尔可夫链模型，用于描述一颗新发现的系外行星的每日大气状况。该模型包含两种状态：状态1为“晴朗”大气，状态2为“风暴”大气。\n\n根据观测数据，科学家们确定了单日转移概率如下：\n- 如果某一天大气是“晴朗”的，那么第二天它再次是“晴朗”的概率是 $\\frac{1}{3}$。\n- 如果某一天大气处于“风暴”状态，那么第二天它变为“晴朗”的概率是 $\\frac{3}{4}$。\n\n设单日转移概率矩阵记为 $P$，其中元素 $P_{ij}$ 是在一天内从状态 $i$ 转移到状态 $j$ 的概率。状态排序为（1：晴朗，2：风暴）。\n\n计算两日转移概率矩阵 $P^{(2)}$，它给出了在两天内从一个状态转移到另一个状态的概率。", "solution": "我们将该系统建模为一个两状态马尔可夫链，状态排序为1：晴朗和2：风暴。单日转移概率给出了单步转移矩阵 $P$，其元素 $P_{ij}$ 表示在一天内从状态 $i$ 转移到状态 $j$ 的概率。根据题意：\n- 如果当前状态是晴朗（状态1），保持晴朗的概率是 $P_{11} = \\frac{1}{3}$，因此转移到风暴（状态2）的概率是 $P_{12} = 1-\\frac{1}{3}=\\frac{2}{3}$。\n- 如果当前状态是风暴（状态2），转移到晴朗（状态1）的概率是 $P_{21} = \\frac{3}{4}$，因此保持风暴的概率是 $P_{22} = 1-\\frac{3}{4}=\\frac{1}{4}$。\n因此，\n$$\nP=\\begin{pmatrix}\n\\frac{1}{3}  \\frac{2}{3} \\\\\n\\frac{3}{4}  \\frac{1}{4}\n\\end{pmatrix}.\n$$\n两日转移矩阵是 $P$ 的平方，使用矩阵乘法：\n$$\nP^{(2)}=P^{2}=P\\,P.\n$$\n使用 $(P^{2})_{ij}=\\sum_{k=1}^{2}P_{ik}P_{kj}$ 计算每个元素：\n- $(P^{2})_{11}=P_{11}P_{11}+P_{12}P_{21}=\\frac{1}{3}\\cdot\\frac{1}{3}+\\frac{2}{3}\\cdot\\frac{3}{4}=\\frac{1}{9}+\\frac{1}{2}=\\frac{11}{18}$。\n- $(P^{2})_{12}=P_{11}P_{12}+P_{12}P_{22}=\\frac{1}{3}\\cdot\\frac{2}{3}+\\frac{2}{3}\\cdot\\frac{1}{4}=\\frac{2}{9}+\\frac{1}{6}=\\frac{7}{18}$。\n- $(P^{2})_{21}=P_{21}P_{11}+P_{22}P_{21}=\\frac{3}{4}\\cdot\\frac{1}{3}+\\frac{1}{4}\\cdot\\frac{3}{4}=\\frac{1}{4}+\\frac{3}{16}=\\frac{7}{16}$。\n- $(P^{2})_{22}=P_{21}P_{12}+P_{22}P_{22}=\\frac{3}{4}\\cdot\\frac{2}{3}+\\frac{1}{4}\\cdot\\frac{1}{4}=\\frac{1}{2}+\\frac{1}{16}=\\frac{9}{16}$。\n因此，\n$$\nP^{(2)}=\\begin{pmatrix}\n\\frac{11}{18}  \\frac{7}{18} \\\\\n\\frac{7}{16}  \\frac{9}{16}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{11}{18}  \\frac{7}{18} \\\\ \\frac{7}{16}  \\frac{9}{16}\\end{pmatrix}}$$", "id": "1345030"}]}