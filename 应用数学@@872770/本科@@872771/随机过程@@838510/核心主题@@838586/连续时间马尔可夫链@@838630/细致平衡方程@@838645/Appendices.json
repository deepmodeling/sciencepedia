{"hands_on_practices": [{"introduction": "出生-死亡过程是随机过程中的一个重要模型，它描述了群体数量随时间的变化。由于其状态转移仅在相邻状态间发生，这类过程天然满足细致平衡条件，因此是可逆的。通过这个关于社区配对动态的练习 [@problem_id:1296899]，我们将应用细致平衡方程来计算一个出生-死亡过程的稳态分布，这是一个在生物学、社会学和排队论中都有广泛应用的基本技能。", "problem": "考虑一个用于描述一个由 $N=4$ 个体组成的小型孤立社群中的社会动态的简化模型。每个个体都可以处于两种状态之一：“单身”或“配对”。整个系统的状态由配对的数量 $n$ 来描述。该系统可以被建模为一个关于配对数量的连续时间马尔可夫链，具体来说是一个生灭过程。\n\n状态之间的转移遵循以下规则：\n1.  **配对（出生）：** 任何两个“单身”个体都可以形成一个新的配对。从有 $n$ 个配对的状态转移到有 $n+1$ 个配对的状态的总速率由出生率 $\\lambda_n = \\alpha \\binom{S_n}{2}$ 给出，其中 $S_n$ 是当有 $n$ 个配对时的单身个体数量，$\\alpha$ 是一个常数配对速率参数。\n2.  **分离（死亡）：** 一个已有的配对可以分离，使两个个体都变回“单身”。从有 $n$ 个配对的状态转移到有 $n-1$ 个配对的状态的总速率由死亡率 $\\mu_n = \\beta n$ 给出，其中 $\\beta$ 是一个常数分离速率参数。\n\n假设系统已经运行了足够长的时间以达到平稳（或平衡）状态。已知速率参数之比为 $\\frac{\\alpha}{\\beta} = \\frac{1}{3}$，计算该社群恰好由两个配对组成（即所有个体都已配对）的平稳概率。将你的答案表示为最简分数形式。", "solution": "设系统的状态为配对的数量 $n$。因为总共有 $N=4$ 个个体，所以配对的数量可以是 $n=0$, $n=1$ 或 $n=2$。因此，这个生灭过程的状态空间是 $\\{0, 1, 2\\}$。设 $\\pi_n$ 为处于状态 $n$ 的平稳概率。\n\n首先，我们确定每个状态的出生率 $\\lambda_n$ 和死亡率 $\\mu_n$。\n\n当有 $n$ 个配对时，单身个体的数量 $S_n$ 为 $S_n = N - 2n = 4 - 2n$。\n\n**计算出生率 ($\\lambda_n = \\alpha \\binom{S_n}{2}$):**\n-   对于 $n=0$：有 $S_0 = 4-2(0) = 4$ 个单身个体。出生率为 $\\lambda_0 = \\alpha \\binom{4}{2} = \\alpha \\frac{4 \\times 3}{2} = 6\\alpha$。这是从状态0转移到状态1的速率。\n-   对于 $n=1$：有 $S_1 = 4-2(1) = 2$ 个单身个体。出生率为 $\\lambda_1 = \\alpha \\binom{2}{2} = \\alpha \\frac{2 \\times 1}{2} = \\alpha$。这是从状态1转移到状态2的速率。\n-   对于 $n=2$：有 $S_2 = 4-2(2) = 0$ 个单身个体。出生率为 $\\lambda_2 = \\alpha \\binom{0}{2} = 0$。不能形成新的配对。\n\n**计算死亡率 ($\\mu_n = \\beta n$):**\n-   对于 $n=0$：没有配对可以分离，所以死亡率为 $\\mu_0 = \\beta(0) = 0$。\n-   对于 $n=1$：有一个配对。死亡率为 $\\mu_1 = \\beta(1) = \\beta$。这是从状态1转移到状态0的速率。\n-   对于 $n=2$：有两个配对。死亡率为 $\\mu_2 = \\beta(2) = 2\\beta$。这是从状态2转移到状态1的速率。\n\n在平稳状态下，生灭过程满足细致平衡方程：\n$$ \\pi_n \\lambda_n = \\pi_{n+1} \\mu_{n+1} $$\n\n我们可以使用这些方程将 $\\pi_1$ 和 $\\pi_2$ 用 $\\pi_0$ 来表示。\n\n对于 $n=0$：\n$$ \\pi_0 \\lambda_0 = \\pi_1 \\mu_1 $$\n$$ \\pi_0 (6\\alpha) = \\pi_1 (\\beta) $$\n$$ \\pi_1 = \\pi_0 \\frac{6\\alpha}{\\beta} $$\n\n对于 $n=1$：\n$$ \\pi_1 \\lambda_1 = \\pi_2 \\mu_2 $$\n$$ \\pi_1 (\\alpha) = \\pi_2 (2\\beta) $$\n$$ \\pi_2 = \\pi_1 \\frac{\\alpha}{2\\beta} $$\n\n现在，将 $\\pi_1$ 的表达式代入 $\\pi_2$ 的方程中：\n$$ \\pi_2 = \\left( \\pi_0 \\frac{6\\alpha}{\\beta} \\right) \\frac{\\alpha}{2\\beta} = \\pi_0 \\frac{6\\alpha^2}{2\\beta^2} = 3 \\left( \\frac{\\alpha}{\\beta} \\right)^2 \\pi_0 $$\n\n我们已知速率参数之比为 $\\frac{\\alpha}{\\beta} = \\frac{1}{3}$。我们可以将这个值代入 $\\pi_1$ 和 $\\pi_2$ 的表达式中。\n\n$$ \\pi_1 = 6 \\left( \\frac{\\alpha}{\\beta} \\right) \\pi_0 = 6 \\left( \\frac{1}{3} \\right) \\pi_0 = 2\\pi_0 $$\n$$ \\pi_2 = 3 \\left( \\frac{\\alpha}{\\beta} \\right)^2 \\pi_0 = 3 \\left( \\frac{1}{3} \\right)^2 \\pi_0 = 3 \\left( \\frac{1}{9} \\right) \\pi_0 = \\frac{1}{3}\\pi_0 $$\n\n所有平稳概率的总和必须等于1（归一化条件）：\n$$ \\pi_0 + \\pi_1 + \\pi_2 = 1 $$\n\n代入用 $\\pi_0$ 表示的表达式：\n$$ \\pi_0 + 2\\pi_0 + \\frac{1}{3}\\pi_0 = 1 $$\n$$ \\left(1 + 2 + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\left(3 + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\left(\\frac{9}{3} + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\frac{10}{3} \\pi_0 = 1 $$\n$$ \\pi_0 = \\frac{3}{10} $$\n\n问题要求的是恰好有两个配对的概率，即 $\\pi_2$。我们现在可以计算它的值：\n$$ \\pi_2 = \\frac{1}{3}\\pi_0 = \\frac{1}{3} \\left( \\frac{3}{10} \\right) = \\frac{1}{10} $$", "answer": "$$\\boxed{\\frac{1}{10}}$$", "id": "1296899"}, {"introduction": "并非所有的马尔可夫链都是可逆的。对于包含循环的状态转移图，我们需要一个更强的条件来确保细致平衡成立，即所谓的“科尔莫戈洛夫循环准则”。这个关于交通信号灯控制器的模型 [@problem_id:1296945] 提供了一个绝佳的实例，它要求我们在一个三态循环中确定使系统可逆的转移速率，从而深入理解可逆性的本质条件。", "problem": "一个交通信号灯控制器的简化模型由一个具有三个状态的连续时间马尔可夫链描述：绿灯 ($S_1$)、黄灯 ($S_2$) 和红灯 ($S_3$)。该系统主要按 $S_1 \\to S_2 \\to S_3 \\to S_1$ 的方向循环。然而，由于某些覆盖协议或系统故障，也可能发生与此循环相反的转移。状态之间的转移率定义如下：\n\n-   $r_{12}$：从绿灯到黄灯的速率\n-   $r_{23}$：从黄灯到红灯的速率\n-   $r_{31}$：从红灯到绿灯的速率\n\n对于反向转移：\n\n-   $r_{21}$：从黄灯到绿灯的速率\n-   $r_{32}$：从红灯到黄灯的速率\n-   $r_{13}$：从绿灯到红灯的速率\n\n该系统被设计成使得最终的马尔可夫链是可逆的。此属性对于确保系统的长期统计行为是时间对称的至关重要。给定以下测量的转移率：\n\n-   $r_{12} = 0.500$ 转移/分钟\n-   $r_{23} = 2.00$ 转移/分钟\n-   $r_{31} = 0.250$ 转移/分钟\n-   $r_{21} = 0.100$ 转移/分钟\n-   $r_{32} = 0.0500$ 转移/分钟\n\n确定为确保系统可逆所需的转移率 $r_{13}$ 的值。以转移/分钟为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "问题指出，描述交通灯系统的连续时间马尔可夫链是可逆的。一个马尔可夫链是可逆的，当且仅当它满足细致平衡方程。设处于状态 $S_i$ 的平稳概率为 $\\pi_i$。细致平衡方程指出，对于任意一对状态 $i$ 和 $j$，在平稳分布中，从 $i$ 到 $j$ 的流率等于从 $j$ 到 $i$ 的流率。数学上，这表示为：\n$$ \\pi_i r_{ij} = \\pi_j r_{ji} $$\n对于所有状态对 $i, j$。\n\n对于一个有循环的系统，可逆性等价于柯尔莫哥洛夫循环判据。该判据指出，对于任意状态循环，沿一个方向的转移率乘积等于沿相反方向的转移率乘积。对于本问题中的三态循环 $S_1 \\to S_2 \\to S_3 \\to S_1$，该条件为：\n$$ r_{12} r_{23} r_{31} = r_{21} r_{32} r_{13} $$\n\n这个判据可以通过链式应用细致平衡方程来推导：\n从 $\\pi_1 r_{12} = \\pi_2 r_{21}$ 得到 $\\frac{\\pi_2}{\\pi_1} = \\frac{r_{12}}{r_{21}}$。\n从 $\\pi_2 r_{23} = \\pi_3 r_{32}$ 得到 $\\frac{\\pi_3}{\\pi_2} = \\frac{r_{23}}{r_{32}}$。\n从 $\\pi_3 r_{31} = \\pi_1 r_{13}$ 得到 $\\frac{\\pi_1}{\\pi_3} = \\frac{r_{31}}{r_{13}}$。\n\n将这三个比率相乘：\n$$ \\left(\\frac{\\pi_2}{\\pi_1}\\right) \\left(\\frac{\\pi_3}{\\pi_2}\\right) \\left(\\frac{\\pi_1}{\\pi_3}\\right) = \\left(\\frac{r_{12}}{r_{21}}\\right) \\left(\\frac{r_{23}}{r_{32}}\\right) \\left(\\frac{r_{31}}{r_{13}}\\right) $$\n左侧简化为 1，从而得到循环判据。\n\n我们被要求求出 $r_{13}$ 的值。我们可以从循环判据方程中解出它：\n$$ r_{13} = \\frac{r_{12} r_{23} r_{31}}{r_{21} r_{32}} $$\n\n现在我们代入给定的数值：\n-   $r_{12} = 0.500$ 转移/分钟\n-   $r_{23} = 2.00$ 转移/分钟\n-   $r_{31} = 0.250$ 转移/分钟\n-   $r_{21} = 0.100$ 转移/分钟\n-   $r_{32} = 0.0500$ 转移/分钟\n\n$$ r_{13} = \\frac{(0.500) \\times (2.00) \\times (0.250)}{(0.100) \\times (0.0500)} $$\n\n首先，计算分子：\n$$ 0.500 \\times 2.00 \\times 0.250 = 1.00 \\times 0.250 = 0.250 $$\n\n接下来，计算分母：\n$$ 0.100 \\times 0.0500 = 0.00500 $$\n\n最后，进行除法运算：\n$$ r_{13} = \\frac{0.250}{0.00500} = 50.0 $$\n\n所需的转移率 $r_{13}$ 的值为 50.0 转移/分钟。问题要求答案四舍五入到三位有效数字，50.0 已经是了。", "answer": "$$\\boxed{50.0}$$", "id": "1296945"}, {"introduction": "计算马尔可夫链的稳态分布通常需要解一个线性方程组，当状态空间很大时，这个过程可能非常繁琐。然而，如果一个链是可逆的，我们可以利用更简单的细致平衡方程来大大简化计算。这个关于清洁机器人的问题 [@problem_id:1296904] 旨在练习这一关键技巧：首先验证系统的可逆性，然后利用细致平衡关系轻松地求解其稳态概率。", "problem": "一个机器人清洁设备在一个由四个呈直线排列的房间组成的小型办公套件中工作：房间1、房间2、房间3和房间4。房间1只与房间2相连。房间2与房间1和房间3相连。房间3与房间2和房间4相连。房间4只与房间3相连。\n\n机器人的移动被建模为一个离散时间马尔可夫链，其中状态是机器人当前所在的房间。在每个时间步，机器人的控制系统执行以下算法：\n- 以 $1/2$ 的概率，机器人停留在当前房间进行深度清洁。\n- 以剩余的概率，机器人尝试移动到相邻的房间。如果当前房间有多个相邻房间，机器人会以相等的概率选择其中一个。\n\n经过很长一段时间后，机器人的位置遵循一个平稳概率分布。设 $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$ 为该平稳分布，其中 $\\pi_i$ 是在房间 $i$ 中找到机器人的概率。\n\n确定平稳分布 $\\pi$。将你的答案表示为一个包含四个最简分数的行向量，代表概率 $(\\pi_1, \\pi_2, \\pi_3, \\pi_4)$。", "solution": "首先，我们确定离散时间马尔可夫链的转移概率矩阵 $P$ 的非零元素。根据问题描述：\n- 机器人以概率 $1/2$ 停留在当前房间。\n- 以概率 $1/2$ 移动到相邻房间，如果多于一个邻居，则等概率选择。\n\n对于房间1（邻居：2）：$P_{11} = 1/2$, $P_{12} = 1/2$\n对于房间2（邻居：1, 3）：$P_{22} = 1/2$, $P_{21} = (1/2) \\times (1/2) = 1/4$, $P_{23} = (1/2) \\times (1/2) = 1/4$\n对于房间3（邻居：2, 4）：$P_{33} = 1/2$, $P_{32} = 1/4$, $P_{34} = 1/4$\n对于房间4（邻居：3）：$P_{44} = 1/2$, $P_{43} = 1/2$\n\n这是一个线性链（或出生-死亡过程），这类过程总是时间可逆的，因此其平稳分布 $\\pi$ 满足细致平衡方程：$\\pi_i P_{ij} = \\pi_j P_{ji}$。我们可以利用这个性质来简化求解。\n\n我们应用细致平衡方程于相邻的房间对：\n1.  对于房间1和2：\n    $$ \\pi_1 P_{12} = \\pi_2 P_{21} \\implies \\pi_1 \\left(\\frac{1}{2}\\right) = \\pi_2 \\left(\\frac{1}{4}\\right) \\implies \\pi_2 = 2\\pi_1 $$\n\n2.  对于房间2和3：\n    $$ \\pi_2 P_{23} = \\pi_3 P_{32} \\implies \\pi_2 \\left(\\frac{1}{4}\\right) = \\pi_3 \\left(\\frac{1}{4}\\right) \\implies \\pi_2 = \\pi_3 $$\n\n3.  对于房间3和4：\n    $$ \\pi_3 P_{34} = \\pi_4 P_{43} \\implies \\pi_3 \\left(\\frac{1}{4}\\right) = \\pi_4 \\left(\\frac{1}{2}\\right) \\implies \\pi_3 = 2\\pi_4 $$\n\n现在我们有了一组简单的关系，可以将所有概率用 $\\pi_1$ 表示：\n- 从(1)我们有 $\\pi_2 = 2\\pi_1$。\n- 从(2)我们有 $\\pi_3 = \\pi_2 = 2\\pi_1$。\n- 从(3)我们有 $\\pi_4 = \\frac{1}{2}\\pi_3 = \\frac{1}{2}(2\\pi_1) = \\pi_1$。\n\n接下来，我们使用归一化条件，即所有概率之和必须为1：\n$$ \\pi_1 + \\pi_2 + \\pi_3 + \\pi_4 = 1 $$\n将所有概率替换为以 $\\pi_1$ 表示的表达式：\n$$ \\pi_1 + (2\\pi_1) + (2\\pi_1) + \\pi_1 = 1 $$\n$$ 6\\pi_1 = 1 \\implies \\pi_1 = \\frac{1}{6} $$\n\n最后，我们计算其他概率：\n- $\\pi_2 = 2\\pi_1 = 2 \\times \\frac{1}{6} = \\frac{2}{6} = \\frac{1}{3}$\n- $\\pi_3 = 2\\pi_1 = 2 \\times \\frac{1}{6} = \\frac{2}{6} = \\frac{1}{3}$\n- $\\pi_4 = \\pi_1 = \\frac{1}{6}$\n\n因此，平稳分布 $\\pi$ 为：\n$$ \\pi = \\left(\\frac{1}{6}, \\frac{1}{3}, \\frac{1}{3}, \\frac{1}{6}\\right) $$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\\end{pmatrix}}$$", "id": "1296904"}]}