{"hands_on_practices": [{"introduction": "时间可逆性的核心在于细致平衡方程。这个练习将带你直接实践这一定义：给定一个马尔可夫链的转移矩阵和一个提议的平稳分布，你将通过检验细致平衡方程 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 是否对所有状态成立，来判断该链是否是时间可逆的。这项在 [@problem_id:1346316] 中提出的基础练习是理解和应用时间可逆性概念的第一步。", "problem": "一个描述单个 Web 服务器运行状态的简化模型是一个具有三个状态的离散时间马尔可夫链：状态 1（空闲）、状态 2（处理中）和状态 3（超载）。状态之间的转换在固定的时间间隔内观察，一步转移概率矩阵 $P = (P_{ij})$ 如下所示：\n$$ P = \\begin{pmatrix} 0.5  0.5  0 \\\\ 0.2  0.6  0.2 \\\\ 0  0.7  0.3 \\end{pmatrix} $$\n其中 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。\n\n一名系统工程专业的学生提出，该服务器的长期行为可以用分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3) = \\left(\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}\\right)$ 来描述。\n\n你的任务是判断该马尔可夫链关于这个提出的分布 $\\pi$ 是否是时间可逆的。一个马尔可夫链关于分布 $\\pi$ 是时间可逆的，如果对于所有状态对 $i$ 和 $j$，细致平衡方程 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 都成立。\n\n下列哪个陈述是正确的？\n\nA. 该链关于 $\\pi$ 是时间可逆的。\n\nB. 该链不是时间可逆的，且细致平衡方程仅对状态对 (1, 2)不成立。\n\nC. 该链不是时间可逆的，且细致平衡方程仅对状态对 (2, 3)不成立。\n\nD. 该链不是时间可逆的，且细致平衡方程对状态对 (1, 2) 和 (2, 3) 都不成立。\n\nE. 提出的分布 $\\pi$ 不是一个平稳分布，因此关于它的时间可逆性概念没有意义。", "solution": "一个离散时间马尔可夫链关于分布 $\\pi$ 是时间可逆的，当且仅当对于所有状态对 $i,j$，细致平衡方程都成立：\n$$\n\\pi_{i}P_{ij}=\\pi_{j}P_{ji}.\n$$\n这里，$\\pi=\\left(\\frac{1}{4},\\frac{1}{2},\\frac{1}{4}\\right)$ 且\n$$\nP=\\begin{pmatrix}\n\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n\\frac{1}{5}  \\frac{3}{5}  \\frac{1}{5} \\\\\n0  \\frac{7}{10}  \\frac{3}{10}\n\\end{pmatrix}.\n$$\n我们检查无序对 $(1,2)$，$(2,3)$ 和 $(1,3)$ 的细致平衡方程。\n\n对于状态对 $(1,2)$：\n$$\n\\pi_{1}P_{12}=\\frac{1}{4}\\cdot\\frac{1}{2}=\\frac{1}{8},\\qquad \\pi_{2}P_{21}=\\frac{1}{2}\\cdot\\frac{1}{5}=\\frac{1}{10}.\n$$\n因为 $\\frac{1}{8}\\neq\\frac{1}{10}$，所以细致平衡方程对 $(1,2)$ 不成立。\n\n对于状态对 $(2,3)$：\n$$\n\\pi_{2}P_{23}=\\frac{1}{2}\\cdot\\frac{1}{5}=\\frac{1}{10},\\qquad \\pi_{3}P_{32}=\\frac{1}{4}\\cdot\\frac{7}{10}=\\frac{7}{40}.\n$$\n因为 $\\frac{1}{10}\\neq\\frac{7}{40}$，所以细致平衡方程对 $(2,3)$ 不成立。\n\n对于状态对 $(1,3)$：\n$$\n\\pi_{1}P_{13}=\\frac{1}{4}\\cdot 0=0,\\qquad \\pi_{3}P_{31}=\\frac{1}{4}\\cdot 0=0,\n$$\n所以细致平衡方程对 $(1,3)$ 显然成立。\n\n因此，该链关于 $\\pi$ 不是时间可逆的，且在状态对 $(1,2)$ 和 $(2,3)$ 上都不满足细致平衡方程。(注：对于这个 $P$，$\\pi$ 也不是平稳分布，但这并不意味着关于 $\\pi$ 的时间可逆性问题没有意义；它只是未能通过细致平衡检验。)", "answer": "$$\\boxed{D}$$", "id": "1346316"}, {"introduction": "了解一个系统具有时间可逆性，可以为我们提供强大的分析工具。在这个练习中，我们将反向应用时间可逆性的属性：当你得知一个马尔可夫链对于均匀分布是时间可逆时，你需要利用这一信息来推断其部分未知的转移概率。这个问题 [@problem_id:1346359] 展现了理论知识如何在模型构建中发挥实际作用，帮助我们补全缺失的信息。", "problem": "一个单分子的理论模型通过其在表面上三个可用结合位点之一的位置来描述其状态。设这些位点由集合 $S = \\{1, 2, 3\\}$ 标记。该分子在离散时间步长内在这些位点之间随机跳跃，这个过程被建模为一个时间齐次马尔可夫链。单步转移概率矩阵用 $P$ 表示，其中元素 $P_{ij}$ 是分子从位点 $i$ 转移到位点 $j$ 的概率。\n\n已知该过程相对于这三个位点上的均匀分布是时间可逆的。转移矩阵 $P$ 已通过实验数据部分确定，其形式如下：\n$$\nP = \\begin{pmatrix}\na  0.5  c \\\\\nb  0.2  0.3 \\\\\n0.1  d  e\n\\end{pmatrix}\n$$\n其中 $a, b, c, d,$ 和 $e$ 是未知常数。\n\n确定这五个未知元素的值。将你的答案表示为一个行矩阵，其中包含按特定字母顺序排列的 $a, b, c, d,$ 和 $e$ 的值。", "solution": "问题要求我们找出马尔可夫链转移矩阵 $P$ 中的未知元素。我们有两个关键信息：该链相对于均匀分布是时间可逆的，并且 $P$ 是一个有效的转移矩阵。\n\n首先，我们利用时间可逆性这一性质。一个具有平稳分布 $\\pi = (\\pi_1, \\pi_2, \\ldots)$ 和转移矩阵 $P$ 的马尔可夫链是时间可逆的，如果它满足细致平衡方程：\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{for all states } i, j.\n$$\n在这个问题中，状态空间是 $S = \\{1, 2, 3\\}$，并且该链相对于均匀分布是可逆的。三个状态上的均匀分布由 $\\pi_i = \\frac{1}{3}$ 给出，其中 $i=1, 2, 3$。\n\n将 $\\pi_i = \\pi_j = \\frac{1}{3}$ 代入细致平衡方程，我们得到：\n$$\n\\frac{1}{3} P_{ij} = \\frac{1}{3} P_{ji}\n$$\n这可以简化为：\n$$\nP_{ij} = P_{ji}\n$$\n这个结果意味着转移矩阵 $P$ 必须是对称的。\n\n给定的矩阵是：\n$$\nP = \\begin{pmatrix}\na  0.5  c \\\\\nb  0.2  0.3 \\\\\n0.1  d  e\n\\end{pmatrix}\n$$\n应用对称条件 ($P=P^T$)，我们可以令非对角元素相等：\n1.  $P_{21} = P_{12} \\implies b = 0.5$\n2.  $P_{31} = P_{13} \\implies 0.1 = c$\n3.  $P_{32} = P_{23} \\implies d = 0.3$\n\n因此，我们已经找到了 $b, c,$ 和 $d$ 的值。现在我们可以用这些值更新矩阵 $P$：\n$$\nP = \\begin{pmatrix}\na  0.5  0.1 \\\\\n0.5  0.2  0.3 \\\\\n0.1  0.3  e\n\\end{pmatrix}\n$$\n接下来，我们使用任何随机（或转移）矩阵的基本性质：每行概率之和必须等于1。\n$$\n\\sum_{j} P_{ij} = 1 \\quad \\text{for all } i.\n$$\n让我们将这个条件应用于包含剩余未知数 $a$ 和 $e$ 的行。\n\n对于第一行 ($i=1$)：\n$$\nP_{11} + P_{12} + P_{13} = 1\n$$\n$$\na + 0.5 + 0.1 = 1\n$$\n$$\na + 0.6 = 1\n$$\n$$\na = 0.4\n$$\n\n对于第三行 ($i=3$)：\n$$\nP_{31} + P_{32} + P_{33} = 1\n$$\n$$\n0.1 + 0.3 + e = 1\n$$\n$$\n0.4 + e = 1\n$$\n$$\ne = 0.6\n$$\n\n作为检验，我们可以验证第二行之和也为1：\n$P_{21} + P_{22} + P_{23} = 0.5 + 0.2 + 0.3 = 1.0$。该矩阵是一致的。\n\n未知数的值为：\n$a = 0.4$\n$b = 0.5$\n$c = 0.1$\n$d = 0.3$\n$e = 0.6$\n\n问题要求将答案表示为一个行矩阵，其值按 $a, b, c, d, e$ 的顺序排列。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4  0.5  0.1  0.3  0.6\n\\end{pmatrix}\n}\n$$", "id": "1346359"}, {"introduction": "时间可逆性的一个重要应用是简化寻找平稳分布的过程，尤其是在加权图上的随机游走模型中。在这个场景中，你将发现利用细致平衡方程可以让你绕过复杂的线性方程组求解，直接构建出平稳分布。通过这个练习 [@problem_id:1346362]，你将掌握一种优雅而高效的方法来分析网络中的长期行为，这是计算统计学和物理学中的一项关键技能。", "problem": "一种新型自动维护机器人正在一家工厂进行测试。该机器人在三个特定的工作站（标记为1、2和3）之间运行，这些工作站连接成一个三角形网络。在任何给定的时间，该机器人都位于其中一个工作站。在每个离散时间步，机器人会从当前工作站移动到两个相邻工作站之一。\n\n工作站之间的路径具有不同的优先级，由正常数权重来量化。工作站1和2之间的路径权重为 $w_{12}$，工作站2和3之间的路径权重为 $w_{23}$，工作站3和1之间的路径权重为 $w_{31}$。当机器人位于一个工作站时，它对下一个工作站的选择是概率性的，且与连接路径的权重成正比。例如，从工作站1出发，机器人可以移动到工作站2或3。移动到工作站2的概率由 $\\frac{w_{12}}{w_{12} + w_{31}}$ 给出，移动到工作站3的概率为 $\\frac{w_{31}}{w_{12} + w_{31}}$。同样的逻辑也适用于从工作站2和3出发的移动。\n\n经过长时间运行后，系统达到稳态，此时在任何给定工作站找到机器人的概率变为常数。确定平稳分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$，其中 $\\pi_i$ 是在工作站 $i$ 找到机器人的长期概率。用权重 $w_{12}$、$w_{23}$ 和 $w_{31}$ 表示你的答案。最终答案应以行矩阵 $(\\pi_1 \\ \\ \\pi_2 \\ \\ \\pi_3)$ 的形式呈现。", "solution": "设马尔可夫链的状态空间为 $\\{1,2,3\\}$，转移概率由给定的加权边定义：\n$$\nP_{12}=\\frac{w_{12}}{w_{12}+w_{31}},\\quad P_{13}=\\frac{w_{31}}{w_{12}+w_{31}},\\quad P_{21}=\\frac{w_{12}}{w_{12}+w_{23}},\\quad P_{23}=\\frac{w_{23}}{w_{12}+w_{23}},\\quad P_{31}=\\frac{w_{31}}{w_{31}+w_{23}},\\quad P_{32}=\\frac{w_{23}}{w_{31}+w_{23}}.\n$$\n所有其他的 $P_{ii}=0$ 且非相邻转移概率为零。\n\n将节点 $i$ 处的加权度定义为\n$$\nd_{1}=w_{12}+w_{31},\\quad d_{2}=w_{12}+w_{23},\\quad d_{3}=w_{23}+w_{31}.\n$$\n考虑候选的平稳分布\n$$\n\\pi_{i}=\\frac{d_{i}}{d_{1}+d_{2}+d_{3}},\\quad i\\in\\{1,2,3\\}.\n$$\n我们对每条权重 $w_{ij}>0$ 的边 $\\{i,j\\}$ 验证细致平衡条件：\n$$\n\\pi_{i}P_{ij}=\\frac{d_{i}}{d_{1}+d_{2}+d_{3}}\\cdot\\frac{w_{ij}}{d_{i}}=\\frac{w_{ij}}{d_{1}+d_{2}+d_{3}}=\\frac{d_{j}}{d_{1}+d_{2}+d_{3}}\\cdot\\frac{w_{ij}}{d_{j}}=\\pi_{j}P_{ji}.\n$$\n因此，细致平衡条件成立，所以 $\\pi$ 是平稳分布。为了进行归一化，注意到\n$$\nd_{1}+d_{2}+d_{3}=2\\left(w_{12}+w_{23}+w_{31}\\right).\n$$\n因此，\n$$\n\\pi_{1}=\\frac{w_{12}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)},\\quad\n\\pi_{2}=\\frac{w_{12}+w_{23}}{2\\left(w_{12}+w_{23}+w_{31}\\right)},\\quad\n\\pi_{3}=\\frac{w_{23}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)}.\n$$\n这就得到了所要求的行矩阵形式的平稳分布。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{w_{12}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)}  \\frac{w_{12}+w_{23}}{2\\left(w_{12}+w_{23}+w_{31}\\right)}  \\frac{w_{23}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)}\\end{pmatrix}}$$", "id": "1346362"}]}