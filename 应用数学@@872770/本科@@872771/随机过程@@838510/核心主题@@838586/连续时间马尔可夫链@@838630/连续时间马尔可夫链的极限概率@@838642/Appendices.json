{"hands_on_practices": [{"introduction": "我们从一个最基础的系统开始：一个只有两个状态的连续时间马尔可夫链。这个练习通过一个直观的交通信号灯模型 [@problem_id:1314961]，让你直接应用平衡方程来计算系统在每个状态下花费时间的长期比例。这是建立和求解平稳分布所需的基础技能。", "problem": "一个偏远交叉路口的简化交通控制系统由单个交通信号灯控制，该信号灯可以处于两种状态之一：状态 $M$（主干道绿灯）或状态 $S$（次干道绿灯）。该交通信号灯的行为被建模为一个连续时间马尔可夫链。\n\n系统从状态 $M$ 切换到状态 $S$ 的恒定速率为 $\\lambda_{MS} = 0.025$ 次/秒。它从状态 $S$ 切换回状态 $M$ 的恒定速率为 $\\lambda_{SM} = 0.060$ 次/秒。这些速率意味着系统在转换前在每个状态停留的时间是一个服从指数分布的随机变量。\n\n假设系统已经运行了很长时间，那么交通信号灯为主干道绿灯的时间在长期来看占总时间的比例是多少？计算这个比例，并以小数形式给出答案，保留四位有效数字。", "solution": "将该交叉路口建模为一个具有两个状态 $M$ 和 $S$ 的连续时间马尔可夫链，其从 $M$ 到 $S$ 的转移速率为 $\\lambda_{MS}$，从 $S$ 到 $M$ 的转移速率为 $\\lambda_{SM}$。在稳态下，平稳概率 $\\pi_{M}$ 和 $\\pi_{S}$ 满足全局平衡方程和归一化方程：\n$$\n\\pi_{M}\\lambda_{MS}=\\pi_{S}\\lambda_{SM}, \\quad \\pi_{M}+\\pi_{S}=1.\n$$\n根据平衡方程，\n$$\n\\pi_{S}=\\pi_{M}\\frac{\\lambda_{MS}}{\\lambda_{SM}}.\n$$\n将其代入归一化方程：\n$$\n\\pi_{M}+\\pi_{M}\\frac{\\lambda_{MS}}{\\lambda_{SM}}=1 \\;\\;\\Rightarrow\\;\\; \\pi_{M}\\left(1+\\frac{\\lambda_{MS}}{\\lambda_{SM}}\\right)=1 \\;\\;\\Rightarrow\\;\\; \\pi_{M}=\\frac{1}{1+\\frac{\\lambda_{MS}}{\\lambda_{SM}}}=\\frac{\\lambda_{SM}}{\\lambda_{SM}+\\lambda_{MS}}.\n$$\n代入给定的速率 $\\lambda_{MS}=0.025$ 和 $\\lambda_{SM}=0.060$：\n$$\n\\pi_{M}=\\frac{0.060}{0.060+0.025}=\\frac{0.060}{0.085}=\\frac{60}{85}=\\frac{12}{17}\\approx 0.705882\\ldots\n$$\n四舍五入到四位有效数字，结果为 $0.7059$。", "answer": "$$\\boxed{0.7059}$$", "id": "1314961"}, {"introduction": "在掌握了双状态系统的基础上，我们现在来分析一个更复杂的循环过程。这个练习 [@problem_id:1314964] 模拟了一辆送货卡车的活动，它构成了一个三状态的循环。与上一个问题不同，本题要求你使用符号速率进行推导，这能更好地揭示系统参数如何影响长期行为，并引入“流量守恒”这一优美而强大的概念。", "problem": "一家物流公司将一辆送货卡车的活动建模为一个具有三个状态的连续时间随机过程：“在仓库”、“在出库途中”（派送包裹）和“在返库途中”（返回仓库）。\n\n根据大量的运营数据，该公司确定了以下几点：\n- 当卡车在仓库时，其被派出进行新一轮派送之前的时间服从速率为 $\\lambda_D$ 的指数分布。\n- 一旦踏上出库路线，完成所有派送并开始返程所需的时间服从速率为 $\\lambda_O$ 的指数分布。\n- 最后，返回仓库的入库路线的时长是一个速率为 $\\lambda_I$ 的指数随机变量。\n\n经过非常长时间的运行后，系统达到稳态。请确定卡车“在仓库”的长期时间比例。请将您的答案表示为以速率 $\\lambda_D$、$\\lambda_O$ 和 $\\lambda_I$ 表示的封闭形式解析表达式。", "solution": "将卡车建模为一个连续时间马尔可夫链，其状态为 $D$ (仓库)，$O$ (出库)，和 $I$ (入库)。每个状态的停留时间分别服从速率为 $\\lambda_{D}$、$\\lambda_{O}$ 和 $\\lambda_{I}$ 的指数分布，且唯一的转移是以速率 $\\lambda_{D}$ 从 $D \\to O$、以速率 $\\lambda_{O}$ 从 $O \\to I$、以及以速率 $\\lambda_{I}$ 从 $I \\to D$。生成元 $Q$ 的非对角线上的非零元素为 $q_{DO}=\\lambda_{D}$，$q_{OI}=\\lambda_{O}$，$q_{ID}=\\lambda_{I}$，并且对于 $i \\in \\{D,O,I\\}$ 有 $q_{ii}=-\\lambda_{i}$。\n\n在稳态下，平稳分布 $\\pi=(\\pi_{D},\\pi_{O},\\pi_{I})$ 满足全局平衡（流）方程。因为转移形成一个单向边的循环，所以通过每次转移的稳态吞吐量 $r$ 必须相等：\n$$\n\\pi_{D}\\lambda_{D}=\\pi_{O}\\lambda_{O}=\\pi_{I}\\lambda_{I}=r.\n$$\n因此，\n$$\n\\pi_{D}=\\frac{r}{\\lambda_{D}},\\quad \\pi_{O}=\\frac{r}{\\lambda_{O}},\\quad \\pi_{I}=\\frac{r}{\\lambda_{I}}.\n$$\n施加归一化条件 $\\pi_{D}+\\pi_{O}+\\pi_{I}=1$：\n$$\n\\frac{r}{\\lambda_{D}}+\\frac{r}{\\lambda_{O}}+\\frac{r}{\\lambda_{I}}=1\n\\;\\;\\Longrightarrow\\;\\;\nr\\left(\\frac{1}{\\lambda_{D}}+\\frac{1}{\\lambda_{O}}+\\frac{1}{\\lambda_{I}}\\right)=1\n\\;\\;\\Longrightarrow\\;\\;\nr=\\frac{1}{\\frac{1}{\\lambda_{D}}+\\frac{1}{\\lambda_{O}}+\\frac{1}{\\lambda_{I}}}.\n$$\n因此，\n$$\n\\pi_{D}=\\frac{r}{\\lambda_{D}}=\\frac{\\frac{1}{\\lambda_{D}}}{\\frac{1}{\\lambda_{D}}+\\frac{1}{\\lambda_{O}}+\\frac{1}{\\lambda_{I}}}.\n$$\n等价地，将分子和分母同乘以 $\\lambda_{D}\\lambda_{O}\\lambda_{I}$，\n$$\n\\pi_{D}=\\frac{\\lambda_{O}\\lambda_{I}}{\\lambda_{O}\\lambda_{I}+\\lambda_{D}\\lambda_{I}+\\lambda_{D}\\lambda_{O}}.\n$$\n这个 $\\pi_{D}$ 就是卡车在仓库的长期时间比例。", "answer": "$$\\boxed{\\frac{\\lambda_{O}\\lambda_{I}}{\\lambda_{O}\\lambda_{I}+\\lambda_{D}\\lambda_{I}+\\lambda_{D}\\lambda_{O}}}$$", "id": "1314964"}, {"introduction": "最后，我们将分析扩展到具有无限状态空间的系统——经典的M/M/1排队模型 [@problem_id:1334392]。这个模型是理解从网络路由器到客户服务中心等各种排队系统的基石。通过这个练习，你将学会如何求解无限维的平衡方程组，并利用归一化条件（所有状态概率之和为1）来确定完整的几何稳态分布。", "problem": "考虑一个单个网络路由器的简化模型。数据包根据泊松过程到达路由器，平均速率为每秒 $\\lambda$ 个数据包。该路由器有一个单独的处理核心和一个有效无限的缓冲区。核心处理并转发单个数据包所需的时间是一个指数分布的随机变量，其均值为 $1/\\mu$ 秒。系统在稳定条件下运行，这意味着流量强度（定义为比率 $\\rho = \\lambda / \\mu$）小于 1。\n\n令 $N(t)$ 表示在时间 $t$ 时路由器系统中的数据包总数（即在缓冲区中等待的数据包加上正在处理的数据包）。假设在初始时间 $t=0$ 时，我们观察到系统中恰好有 $n$ 个数据包，其中 $n$ 是一个非负整数。\n\n当时间 $T$ 变得非常大时，在时间 $T$ 于系统中找到特定数量（例如 $j$ 个，其中 $j$ 是一个非负整数）数据包的概率会收敛到一个与初始数据包数量 $n$ 无关的极限值。\n\n请确定这个极限概率 $\\lim_{T \\to \\infty} P(N(T) = j | N(0) = n)$ 的解析表达式，该表达式是到达率 $\\lambda$、服务率 $\\mu$ 和目标数据包数量 $j$ 的函数。", "solution": "这个问题要求解 M/M/1 排队模型中顾客数的长期概率分布。所描述的系统是一个连续时间马尔可夫链，其状态空间为非负整数集合 $\\{0, 1, 2, ...\\}$，其中状态表示系统中数据包的数量 $N(t)$。\n\n令 $P_j(t)$ 为在时间 $t$ 系统中有 $j$ 个数据包的概率。我们所求的极限概率是 $\\pi_j = \\lim_{t \\to \\infty} P_j(t)$。对于一个不可约、正常返的马尔可夫链，该极限存在且与初始状态无关。条件 $\\rho = \\lambda/\\mu  1$ 确保了该链是正常返的，这意味着存在稳态分布。\n\n稳态概率 $\\pi_j$ 的特征是，流入任何状态 $j$ 的概率流率等于流出状态 $j$ 的概率流率。这些被称为平衡方程。\n\n让我们考虑状态之间的转移。\n从状态 $k$ 到 $k+1$ 的转移因一次到达而发生，速率为 $\\lambda$。\n从状态 $k$ 到 $k-1$（对于 $k \\ge 1$）的转移因一次服务完成而发生，速率为 $\\mu$。\n\n离开状态 $j$（对于 $j>0$）的总速率为 $(\\lambda + \\mu)\\pi_j$，这是由于一次到达（转移到状态 $j+1$）或一次服务完成（转移到状态 $j-1$）。进入状态 $j$ 的速率为 $\\lambda \\pi_{j-1}$（当处于状态 $j-1$ 时有一次到达）加上 $\\mu \\pi_{j+1}$（当处于状态 $j+1$ 时有一次服务完成）。\n对于状态 $j=0$，离开的速率是 $\\lambda \\pi_0$（一次到达），进入的速率是 $\\mu \\pi_1$（从状态 1 完成一次服务）。\n\n平衡方程为：\n1. 对于状态 $j=0$：\n流出率 = 流入率\n$$ \\lambda \\pi_0 = \\mu \\pi_1 $$\n这给出 $\\pi_1 = \\frac{\\lambda}{\\mu} \\pi_0 = \\rho \\pi_0$。\n\n2. 对于状态 $j \\geq 1$：\n流出率 = 流入率\n$$ (\\lambda + \\mu) \\pi_j = \\lambda \\pi_{j-1} + \\mu \\pi_{j+1} $$\n我们可以使用这组方程来找到 $\\pi_j$ 和 $\\pi_0$ 之间的一般关系。让我们对 $j=1$ 进行检验：\n$$ (\\lambda + \\mu) \\pi_1 = \\lambda \\pi_0 + \\mu \\pi_2 $$\n代入 $\\pi_1 = \\rho \\pi_0 = (\\lambda/\\mu)\\pi_0$：\n$$ (\\lambda + \\mu) \\frac{\\lambda}{\\mu} \\pi_0 = \\lambda \\pi_0 + \\mu \\pi_2 $$\n$$ \\frac{\\lambda^2 + \\lambda\\mu}{\\mu} \\pi_0 = \\lambda \\pi_0 + \\mu \\pi_2 $$\n$$ \\frac{\\lambda^2}{\\mu} \\pi_0 + \\lambda \\pi_0 = \\lambda \\pi_0 + \\mu \\pi_2 $$\n$$ \\frac{\\lambda^2}{\\mu} \\pi_0 = \\mu \\pi_2 $$\n$$ \\pi_2 = \\frac{\\lambda^2}{\\mu^2} \\pi_0 = \\left(\\frac{\\lambda}{\\mu}\\right)^2 \\pi_0 = \\rho^2 \\pi_0 $$\n这表明存在一个模式：$\\pi_j = \\rho^j \\pi_0$。我们可以使用平衡方程通过数学归纳法证明这一点。假设对于 $k \\le j$，$\\pi_k = \\rho^k \\pi_0$ 成立。根据状态 $j$ 的平衡方程：\n$$ \\mu \\pi_{j+1} = (\\lambda + \\mu) \\pi_j - \\lambda \\pi_{j-1} $$\n代入我们的归纳假设：\n$$ \\mu \\pi_{j+1} = (\\lambda + \\mu) (\\rho^j \\pi_0) - \\lambda (\\rho^{j-1} \\pi_0) $$\n$$ \\mu \\pi_{j+1} = \\pi_0 \\rho^{j-1} \\left[ (\\lambda + \\mu) \\rho - \\lambda \\right] $$\n代入 $\\rho = \\lambda/\\mu$：\n$$ \\mu \\pi_{j+1} = \\pi_0 \\rho^{j-1} \\left[ (\\lambda + \\mu) \\frac{\\lambda}{\\mu} - \\lambda \\right] $$\n$$ \\mu \\pi_{j+1} = \\pi_0 \\rho^{j-1} \\left[ \\frac{\\lambda^2 + \\lambda\\mu}{\\mu} - \\lambda \\right] $$\n$$ \\mu \\pi_{j+1} = \\pi_0 \\rho^{j-1} \\left[ \\frac{\\lambda^2}{\\mu} + \\lambda - \\lambda \\right] = \\pi_0 \\rho^{j-1} \\frac{\\lambda^2}{\\mu} $$\n$$ \\pi_{j+1} = \\pi_0 \\frac{\\rho^{j-1}}{\\mu} \\frac{\\lambda^2}{\\mu} = \\pi_0 \\rho^{j-1} \\left(\\frac{\\lambda}{\\mu}\\right)^2 = \\pi_0 \\rho^{j-1} \\rho^2 = \\pi_0 \\rho^{j+1} $$\n归纳步骤成立。因此，关系式 $\\pi_j = \\rho^j \\pi_0$ 对所有 $j \\geq 0$ 都成立。\n\n最后一步是使用归一化条件来确定 $\\pi_0$，该条件规定所有稳态概率之和必须等于 1。\n$$ \\sum_{j=0}^{\\infty} \\pi_j = 1 $$\n$$ \\sum_{j=0}^{\\infty} \\rho^j \\pi_0 = 1 $$\n$$ \\pi_0 \\sum_{j=0}^{\\infty} \\rho^j = 1 $$\n该求和是一个几何级数。由于系统是稳定的，我们有 $\\rho = \\lambda/\\mu  1$，所以该级数收敛：\n$$ \\sum_{j=0}^{\\infty} \\rho^j = \\frac{1}{1-\\rho} $$\n将此代入归一化方程：\n$$ \\pi_0 \\left( \\frac{1}{1-\\rho} \\right) = 1 $$\n$$ \\pi_0 = 1 - \\rho $$\n现在我们可以写出 $\\pi_j$ 的最终表达式：\n$$ \\pi_j = \\rho^j \\pi_0 = \\rho^j (1-\\rho) $$\n代入 $\\rho = \\lambda/\\mu$：\n$$ \\pi_j = \\left(\\frac{\\lambda}{\\mu}\\right)^j \\left(1 - \\frac{\\lambda}{\\mu}\\right) $$\n这就是在系统中找到 $j$ 个数据包的极限概率，与初始状态 $n$ 无关。", "answer": "$$\\boxed{\\left(1 - \\frac{\\lambda}{\\mu}\\right) \\left(\\frac{\\lambda}{\\mu}\\right)^{j}}$$", "id": "1334392"}]}