{"hands_on_practices": [{"introduction": "柯尔莫哥洛夫前向方程 (Kolmogorov forward equations) 在连续时间马尔可夫链的生成元矩阵和其随时间变化的转移概率之间建立了关键联系。此关系的一个主要应用是验证一个给定的转移矩阵 $P(t)$ 是否准确地描述了系统的动态。这个练习 [@problem_id:1340356] 将指导你完成这一基本验证过程，检验你应用核心微分方程 $P'(t) = P(t)Q$ 的能力。", "problem": "一个神经细胞膜中单个离子通道的简化模型考虑了两种状态：状态 1（开放）和状态 2（关闭）。这些状态之间的转换被建模为连续时间马尔可夫链。从开放状态到关闭状态的转移速率为 $\\lambda > 0$，从关闭状态到开放状态的转移速率为 $\\mu > 0$。该系统的动态可以用生成元矩阵 $Q$ 来描述，其中对于 $i \\neq j$，元素 $Q_{ij}$ 是从状态 $i$到状态 $j$ 的转移速率。\n\n这个双态系统的生成元矩阵由下式给出：\n$$\nQ = \\begin{pmatrix} -\\lambda & \\lambda \\\\ \\mu & -\\mu \\end{pmatrix}\n$$\n\n一位研究人员提出了一个转移概率矩阵 $P(t) = (P_{ij}(t))$ 的模型，其中 $P_{ij}(t)$ 是在时间 $0$ 时通道处于状态 $i$ 的条件下，在时间 $t$ 时通道处于状态 $j$ 的概率。所提出的矩阵是：\n$$\nP(t) = \\begin{pmatrix} \\exp(-\\lambda t) & 1 - \\exp(-\\lambda t) \\\\ 1 - \\exp(-\\mu t) & \\exp(-\\mu t) \\end{pmatrix}\n$$\n\n对于一个具有生成元 $Q$ 的系统的有效转移矩阵，其一个基本性质是其时间导数 $P'(t)$ 必须满足矩阵微分方程 $P'(t) = P(t)Q$。根据这些信息，下列关于所提出的 $P(t)$ 的陈述中，哪一个是正确的？\n\nA. 所提出的矩阵 $P(t)$ 是该系统的有效转移矩阵。\n\nB. 所提出的矩阵 $P(t)$ 无效，因为其行和不等于 1。\n\nC. 所提出的矩阵 $P(t)$ 无效，因为它不满足初始条件 $P(0) = I$，其中 $I$ 是单位矩阵。\n\nD. 所提出的矩阵 $P(t)$ 无效，因为它不满足微分方程 $P'(t) = P(t)Q$。", "solution": "我们有一个双态连续时间马尔可夫链 (CTMC)，其生成元矩阵为\n$$\nQ=\\begin{pmatrix}\n-\\lambda & \\lambda\\\\\n\\mu & -\\mu\n\\end{pmatrix},\n$$\n其中 $\\lambda>0$ 是从开放到关闭的速率，$\\mu>0$ 是从关闭到开放的速率。对于一个有效的转移概率矩阵 $P(t)$，必须满足三个关键性质：\n- 行随机性：对所有 $t\\geq 0$，每一行的和都为 $1$。\n- 初始条件：$P(0)=I$。\n- 柯尔莫哥洛夫前向方程：对所有 $t\\geq 0$，$P'(t)=P(t)Q$。\n\n所提出的矩阵是\n$$\nP(t)=\\begin{pmatrix}\n\\exp(-\\lambda t) & 1-\\exp(-\\lambda t)\\\\\n1-\\exp(-\\mu t) & \\exp(-\\mu t)\n\\end{pmatrix}.\n$$\n\n首先，检查行和。对于第一行，\n$$\n\\exp(-\\lambda t)+\\bigl(1-\\exp(-\\lambda t)\\bigr)=1.\n$$\n对于第二行，\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)+\\exp(-\\mu t)=1.\n$$\n因此，每一行的和都为 $1$，所以该矩阵是行随机的，选项 B 是错误的。\n\n其次，检查初始条件：\n$$\nP(0)=\\begin{pmatrix}\n\\exp(0) & 1-\\exp(0)\\\\\n1-\\exp(0) & \\exp(0)\n\\end{pmatrix}\n=\\begin{pmatrix}\n1 & 0\\\\\n0 & 1\n\\end{pmatrix}=I.\n$$\n因此，选项 C 是错误的。\n\n第三，检查柯尔莫哥洛夫前向方程 $P'(t)=P(t)Q$。通过逐元素求导来计算 $P'(t)$：\n$$\nP'(t)=\\begin{pmatrix}\n-\\lambda\\,\\exp(-\\lambda t) & \\lambda\\,\\exp(-\\lambda t)\\\\\n\\mu\\,\\exp(-\\mu t) & -\\mu\\,\\exp(-\\mu t)\n\\end{pmatrix}.\n$$\n现在计算乘积 $P(t)Q$：\n- 第 $(1,1)$ 个元素：\n$$\n\\exp(-\\lambda t)\\cdot(-\\lambda)+\\bigl(1-\\exp(-\\lambda t)\\bigr)\\cdot\\mu\n= -\\lambda\\,\\exp(-\\lambda t)+\\mu-\\mu\\,\\exp(-\\lambda t)\n= \\mu-(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n- 第 $(1,2)$ 个元素：\n$$\n\\exp(-\\lambda t)\\cdot\\lambda+\\bigl(1-\\exp(-\\lambda t)\\bigr)\\cdot(-\\mu)\n= \\lambda\\,\\exp(-\\lambda t)-\\mu+\\mu\\,\\exp(-\\lambda t)\n= -\\mu+(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n- 第 $(2,1)$ 个元素：\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)\\cdot(-\\lambda)+\\exp(-\\mu t)\\cdot\\mu\n= -\\lambda+\\lambda\\,\\exp(-\\mu t)+\\mu\\,\\exp(-\\mu t)\n= -\\lambda+(\\lambda+\\mu)\\exp(-\\mu t).\n$$\n- 第 $(2,2)$ 个元素：\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)\\cdot\\lambda+\\exp(-\\mu t)\\cdot(-\\mu)\n= \\lambda-\\lambda\\,\\exp(-\\mu t)-\\mu\\,\\exp(-\\mu t)\n= \\lambda-(\\lambda+\\mu)\\exp(-\\mu t).\n$$\n因此\n$$\nP(t)Q=\\begin{pmatrix}\n\\mu-(\\lambda+\\mu)\\exp(-\\lambda t) & -\\mu+(\\lambda+\\mu)\\exp(-\\lambda t)\\\\\n-\\lambda+(\\lambda+\\mu)\\exp(-\\mu t) & \\lambda-(\\lambda+\\mu)\\exp(-\\mu t)\n\\end{pmatrix}.\n$$\n比较 $P'(t)$ 和 $P(t)Q$。对于第 $(1,1)$ 个元素，\n$$\nP'_{11}(t)=-\\lambda\\,\\exp(-\\lambda t),\\quad \\bigl(P(t)Q\\bigr)_{11}=\\mu-(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n仅当 $\\mu=0$ 时，它们才对所有 $t$ 相等，但这与 $\\mu>0$ 相矛盾。更明确地说，\n$$\nP'_{11}(t)-\\bigl(P(t)Q\\bigr)_{11}=\\mu\\bigl(\\exp(-\\lambda t)-1\\bigr)\\neq 0\n$$\n对 $t>0$ 成立。因此，对 $t>0$，有 $P'(t)\\neq P(t)Q$，所以提出的 $P(t)$ 违反了柯尔莫哥洛夫前向方程。因此，选项 D 是正确的。\n\n为了完整起见，注意到 $P'(0)=Q$ 确实成立：\n$$\nP'(0)=\\begin{pmatrix}\n-\\lambda & \\lambda\\\\\n\\mu & -\\mu\n\\end{pmatrix}=Q,\n$$\n但这并不足够；该等式必须对所有 $t\\geq 0$ 成立，而事实并非如此。\n\n因此，所提出的 $P(t)$ 是无效的，因为它不满足 $P'(t)=P(t)Q$。", "answer": "$$\\boxed{D}$$", "id": "1340356"}, {"introduction": "虽然前向方程定义了每个单独状态概率的演化，但它们真正的威力往往在于推导系统宏观属性的动态。这个实践问题 [@problem_id:1340377] 演示了一种经典技巧：直接从完整的柯尔莫哥洛夫方程组中，为期望种群规模 $M(t)$ 推导出一个单一、简洁的微分方程。这种方法优雅地将微观层面的描述与对系统行为的宏观理解联系起来。", "problem": "一个新的去中心化社交网络上线了。上线后任意时刻 $t$ 的活跃用户数 $N(t)$ 被建模为一个连续时间随机过程。用户参与的动态由一个线性生灭过程描述。\n\n一个新用户的“出生”对应于一个个体加入该网络。新用户加入的速率假定与当前活跃用户数 $n$ 成正比，人均加入速率为常数 $\\lambda$。因此，从状态 $n$ 转移到状态 $n+1$ 的总速率是 $\\lambda n$。\n\n一个用户的“死亡”对应于一个个体离开该网络。用户离开的速率也与当前活跃用户数成正比，人均离开速率为常数 $\\mu$。因此，从状态 $n$ 转移到状态 $n-1$ 的总速率是 $\\mu n$。对于零用户状态（$n=0$），离开速率为零。\n\n令 $p_n(t)$ 为时刻 $t$ 网络上恰好有 $n$ 个用户的概率。活跃用户的期望数量由 $M(t) = \\sum_{n=0}^{\\infty} n p_n(t)$ 给出。该期望值的时间演化可以用一个形如 $\\frac{dM(t)}{dt} = f(M(t))$ 的一阶常微分方程来描述。\n\n确定控制期望用户数变化率的函数 $f(M(t))$。你的答案应该是一个用 $M(t)$、$\\lambda$ 和 $\\mu$ 表示的表达式。", "solution": "设 $N(t)$ 是一个线性生灭过程，其从 $n$ 到 $n+1$ 的转移速率为 $\\lambda n$，从 $n$ 到 $n-1$ 的转移速率为 $\\mu n$。令 $p_{n}(t)$ 表示 $\\Pr(N(t)=n)$ 且 $M(t)=\\sum_{n=0}^{\\infty} n p_{n}(t)$。\n\n对于 $n\\geq 1$，柯尔莫哥洛夫前向方程为：\n$$\n\\frac{d p_{n}(t)}{dt}=\\lambda (n-1) p_{n-1}(t)+\\mu (n+1) p_{n+1}(t)-(\\lambda n+\\mu n) p_{n}(t),\n$$\n对于 $n=0$：\n$$\n\\frac{d p_{0}(t)}{dt}=\\mu p_{1}(t).\n$$\n对 $M(t)$ 求导，并交换求和与求导的顺序：\n$$\n\\frac{dM(t)}{dt}=\\sum_{n=0}^{\\infty} n \\frac{d p_{n}(t)}{dt}=\\sum_{n=1}^{\\infty} n \\frac{d p_{n}(t)}{dt}.\n$$\n代入 $n\\geq 1$ 的前向方程：\n$$\n\\frac{dM(t)}{dt}=\\sum_{n=1}^{\\infty} n\\left[\\lambda (n-1) p_{n-1}(t)+\\mu (n+1) p_{n+1}(t)-(\\lambda+\\mu) n p_{n}(t)\\right].\n$$\n通过指标变换处理每个求和。对于出生流入项，令 $m=n-1$：\n$$\n\\sum_{n=1}^{\\infty} n \\lambda (n-1) p_{n-1}(t)=\\lambda \\sum_{m=0}^{\\infty} (m+1) m\\, p_{m}(t)=\\lambda \\left(\\sum_{m=0}^{\\infty} m^{2} p_{m}(t)+\\sum_{m=0}^{\\infty} m p_{m}(t)\\right).\n$$\n对于死亡流入项，令 $k=n+1$：\n$$\n\\sum_{n=1}^{\\infty} n \\mu (n+1) p_{n+1}(t)=\\mu \\sum_{k=2}^{\\infty} (k-1) k\\, p_{k}(t)=\\mu \\left(\\sum_{k=0}^{\\infty} k^{2} p_{k}(t)-\\sum_{k=0}^{\\infty} k p_{k}(t)\\right).\n$$\n对于流出项：\n$$\n\\sum_{n=1}^{\\infty} n (\\lambda+\\mu) n p_{n}(t)=(\\lambda+\\mu)\\sum_{n=0}^{\\infty} n^{2} p_{n}(t).\n$$\n引入 $E[N(t)]=M(t)$ 和 $E[N(t)^{2}]=\\sum_{n=0}^{\\infty} n^{2} p_{n}(t)$ 来合并各项：\n$$\n\\frac{dM(t)}{dt}=\\lambda \\left(E[N(t)^{2}]+M(t)\\right)+\\mu \\left(E[N(t)^{2}]-M(t)\\right)-(\\lambda+\\mu) E[N(t)^{2}].\n$$\n$E[N(t)^{2}]$ 项相互抵消，得到\n$$\n\\frac{dM(t)}{dt}=(\\lambda-\\mu) M(t).\n$$\n因此，控制期望用户数变化率的函数是\n$$\nf(M(t))=(\\lambda-\\mu) M(t).\n$$\n等价地，通过作用于 $f(n)=n$ 的过程的生成元 $\\mathcal{L}$，我们有 $\\mathcal{L}f(n)=\\lambda n[(n+1)-n]+\\mu n[(n-1)-n]=(\\lambda-\\mu) n$，取期望可得到相同的结果。", "answer": "$$\\boxed{(\\lambda-\\mu) M(t)}$$", "id": "1340377"}, {"introduction": "许多现实世界系统，从粒子物理到流行病学，都涉及最终会进入吸收态的过程。在这类系统中，一个关键问题是理解在被吸收之前，在各个暂态上花费的时间。这个练习 [@problem_id:1340402] 探讨了这一重要概念，引导你利用前向方程的结构，为期望逗留时间推导出一个极其简洁和通用的矩阵公式。", "problem": "考虑一个用于描述量子点电子行为的简化模型。该量子点有一个单一基态，我们将其标记为状态 0，以及一组 $N$ 个不同的亚稳激发能级，标记为状态 $1, 2, \\dots, N$。该系统中的一个电子可以在这些状态之间跃迁。其动力学被建模为状态空间 $S = \\{0, 1, 2, \\dots, N\\}$ 上的一个连续时间马尔可夫链 (CTMC)。\n\n基态（状态 0）是一个吸收态；一旦电子进入该状态，它将一直停留在那里。激发能级（状态 $1, 2, \\dots, N$）是暂态。从任何状态 $i \\in S$ 到另一状态 $j \\in S$ ($j \\ne i$) 的恒定跃迁率记为 $q_{ij} \\ge 0$。由于状态 0 是吸收态，因此对于所有 $j \\in S$，$q_{0j} = 0$。系统保证会从任何暂态最终进入吸收态。\n\n该 CTMC 的生成元矩阵是一个 $(N+1) \\times (N+1)$ 矩阵 $Q$，其非对角线元素为 $Q_{ij} = q_{ij}$，对角线元素为 $Q_{ii} = -\\sum_{j \\ne i} q_{ij}$。令 $Q_T$ 为对应于暂态 $\\{1, 2, \\dots, N\\}$ 之间跃迁的 $N \\times N$ 子生成元矩阵。也就是说，对于 $i,j \\in \\{1, \\dots, N\\}$，$Q_T$ 在第 $i$ 行和第 $j$ 列的元素是跃迁率 $q_{ij}$（如果 $i \\ne j$）和 $q_{ii}$（如果 $i=j$）。您可以假设 $Q_T$ 是一个可逆矩阵。\n\n假设在时间 $t=0$ 时，电子初始处于激发态 $i \\in \\{1, 2, \\dots, N\\}$。令 $m_{ij}$ 表示电子在被吸收进入基态 0 之前，在激发态 $j \\in \\{1, 2, \\dots, N\\}$ 中停留的期望总时间。令 $M_T$ 为一个 $N \\times N$ 矩阵，其在第 $i$ 行和第 $j$ 列的元素为 $m_{ij}$。\n\n使用柯尔莫哥洛夫前向方程，推导出用子生成元矩阵 $Q_T$ 表示 $M_T$ 的紧凑矩阵表达式。", "solution": "令 $X_{t}$ 为在状态 $\\{1,\\dots,N\\}$ 上，生成元为 $Q$、暂态子生成元为 $Q_{T}$ 的 CTMC。固定一个初始激发态 $i \\in \\{1,\\dots,N\\}$。令 $p^{(i)}(t)$ 表示在时间 $t$ 的暂态概率行向量，其分量为 $p^{(i)}_{j}(t) = \\mathbb{P}(X_{t}=j \\mid X_{0}=i)$，其中 $j \\in \\{1,\\dots,N\\}$。根据限制在暂态类上的柯尔莫哥洛夫前向方程，\n$$\n\\frac{d}{dt} p^{(i)}(t) = p^{(i)}(t) Q_{T}, \\qquad p^{(i)}(0) = e_{i}^{\\top},\n$$\n其中 $e_{i}$ 是 $\\mathbb{R}^{N}$ 中的第 $i$ 个标准基向量。其解为\n$$\np^{(i)}(t) = e_{i}^{\\top} \\exp(Q_{T} t).\n$$\n从 $i$ 出发，在被吸收前停留在暂态 $j$ 的期望总时间是\n$$\nm_{ij} = \\int_{0}^{\\infty} p^{(i)}_{j}(t)\\, dt = \\int_{0}^{\\infty} \\left(e_{i}^{\\top} \\exp(Q_{T} t)\\right)_{j} \\, dt.\n$$\n将所有 $i$ 对应的这些期望值作为行堆叠起来，得到矩阵\n$$\nM_{T} = \\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt.\n$$\n因为所有暂态都保证被吸收且 $Q_{T}$ 可逆，所以 $Q_{T}$ 的谱位于开放的左半平面，因此该积分收敛。使用矩阵微积分，\n$$\nQ_{T} \\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt = \\left[\\exp(Q_{T} t)\\right]_{0}^{\\infty} = 0 - I,\n$$\n这意味着\n$$\n\\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt = - Q_{T}^{-1}.\n$$\n因此，\n$$\nM_{T} = - Q_{T}^{-1}.\n$$", "answer": "$$\\boxed{-Q_{T}^{-1}}$$", "id": "1340402"}]}