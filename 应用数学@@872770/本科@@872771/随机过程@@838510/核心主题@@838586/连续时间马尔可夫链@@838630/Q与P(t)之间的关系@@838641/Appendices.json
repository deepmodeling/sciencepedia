{"hands_on_practices": [{"introduction": "在随机过程的研究中，$P$ 和 $Q$ 之间的关系有两种核心解读。第一种是在连续时间马尔可夫链的背景下，其中 $Q$ 是生成元矩阵，而 $P(t)$ 是转移概率矩阵。这个练习将带你探索如何从 $Q$ 的代数性质出发，求得 $P(t)$ 的解析表达式。通过利用 $Q$ 满足的特定多项式方程，我们可以将复杂的矩阵指数计算 $P(t) = \\exp(tQ)$ 简化为求解一个简单的线性组合，这是一种求解系统动态演化的强大技巧。[@problem_id:1330447]", "problem": "考虑一个由有限状态连续时间马尔可夫链 (CTMC) 建模的系统。状态概率的动态由生成元矩阵 $Q$ 决定。在时间间隔 $t \\ge 0$ 内的转移概率矩阵由 $P(t) = \\exp(tQ)$ 给出，其中 $\\exp(\\cdot)$ 表示矩阵指数。\n\n假设这个特定系统的生成元矩阵 $Q$ 已知满足以下矩阵多项式方程：\n$$(Q - \\lambda_1 I)(Q - \\lambda_2 I) = 0$$\n其中 $I$ 是与 $Q$ 同维度的单位矩阵，$0$ 是零矩阵，$\\lambda_1$ 和 $\\lambda_2$ 是不相等的负实常数。\n\n推导转移概率矩阵 $P(t)$ 的一个闭式表达式，使其表示为矩阵 $I$ 和 $Q$ 的线性组合。你的最终表达式应具有 $P(t) = a(t)I + b(t)Q$ 的形式，其中 $a(t)$ 和 $b(t)$ 是用 $\\lambda_1$ 和 $\\lambda_2$ 表示的关于时间 $t$ 的标量函数。", "solution": "给定一个有限状态CTMC，其生成元矩阵为 $Q$ 且 $P(t)=\\exp(tQ)$。矩阵 $Q$ 满足二次多项式恒等式 $(Q-\\lambda_{1}I)(Q-\\lambda_{2}I)=0$，其中 $\\lambda_1$ 与 $\\lambda_2$ 为不相等的实数，即 $\\lambda_{1}\\neq\\lambda_{2}$。由于 $Q$ 的最小多项式整除 $(x-\\lambda_{1})(x-\\lambda_{2})$ 并且具有不同的线性因子，因此 $Q$ 的任何解析函数都可以表示为 $Q$ 的一个次数至多为一的多项式。因此，存在标量函数 $a(t)$ 和 $b(t)$ 使得\n$$\nP(t)=\\exp(tQ)=a(t)I+b(t)Q.\n$$\n\n为了确定 $a(t)$ 和 $b(t)$，我们使用基于谱的插值进行函数演算。对于 $Q$ 的任意特征值 $\\lambda$，$\\exp(tQ)$ 在其对应特征空间上的作用等同于乘以 $\\exp(t\\lambda)$。因此，对于 $i=1,2$，$a(t)$ 和 $b(t)$ 必须满足：\n$$\na(t)+b(t)\\lambda_{i}=\\exp(t\\lambda_{i}).\n$$\n这是一个关于 $a(t)$ 和 $b(t)$ 的 $2\\times 2$ 线性方程组：\n$$\n\\begin{cases}\na(t)+b(t)\\lambda_{1}=\\exp(t\\lambda_{1}),\\\\\na(t)+b(t)\\lambda_{2}=\\exp(t\\lambda_{2}).\n\\end{cases}\n$$\n第一个方程减去第二个方程，得到\n$$\nb(t)(\\lambda_{1}-\\lambda_{2})=\\exp(t\\lambda_{1})-\\exp(t\\lambda_{2}),\n$$\n所以\n$$\nb(t)=\\frac{\\exp(t\\lambda_{1})-\\exp(t\\lambda_{2})}{\\lambda_{1}-\\lambda_{2}}.\n$$\n将其代入 $a(t)+b(t)\\lambda_{1}=\\exp(t\\lambda_{1})$ 得到\n$$\na(t)=\\exp(t\\lambda_{1})-\\lambda_{1}\\frac{\\exp(t\\lambda_{1})-\\exp(t\\lambda_{2})}{\\lambda_{1}-\\lambda_{2}}\n=\\frac{\\lambda_{1}\\exp(t\\lambda_{2})-\\lambda_{2}\\exp(t\\lambda_{1})}{\\lambda_{1}-\\lambda_{2}}.\n$$\n\n因此，\n$$\nP(t)=\\frac{\\lambda_{1}\\exp(t\\lambda_{2})-\\lambda_{2}\\exp(t\\lambda_{1})}{\\lambda_{1}-\\lambda_{2}}\\,I\n+\\frac{\\exp(t\\lambda_{1})-\\exp(t\\lambda_{2})}{\\lambda_{1}-\\lambda_{2}}\\,Q.\n$$\n作为一致性检验，在 $t=0$ 时，我们有 $b(0)=0$ 和 $a(0)=1$，所以 $P(0)=I$，这符合转移半群的要求。推导至此完成。", "answer": "$$\\boxed{\\frac{\\lambda_{1}\\exp(t\\lambda_{2})-\\lambda_{2}\\exp(t\\lambda_{1})}{\\lambda_{1}-\\lambda_{2}}\\,I+\\frac{\\exp(t\\lambda_{1})-\\exp(t\\lambda_{2})}{\\lambda_{1}-\\lambda_{2}}\\,Q}$$", "id": "1330447"}, {"introduction": "现在我们转换视角，从观测数据反推系统的内在机制。在许多科学和工程应用中，我们能够通过实验测量系统在一段时间后处于某个状态的概率（即 $P(t)$ 的某些元素），但驱动这些变化的瞬时转移率（即 $Q$ 矩阵的元素）却是未知的。本练习将指导你如何运用柯尔莫哥洛夫向后方程，建立 $P(t)$ 的时间导数与 $Q$ 之间的联系，从而根据给定的概率函数形式反推出生成元矩阵中的关键参数。这就像一位侦探，从结果出发，一步步揭示导致这一切发生的基本规则。[@problem_id:1330404]", "problem": "考虑一个物理系统，它可以存在于三个不同的状态，记为 $S_1$、$S_2$ 和 $S_3$。这些状态之间的随机转换由一个连续时间马尔可夫链建模，其时间无关的生成元矩阵为 $Q$。该矩阵的元素 $q_{ij}$（其中 $i \\neq j$）表示从状态 $S_i$ 到状态 $S_j$ 的转移率。对角线元素由每行之和为零的性质定义，即 $q_{ii} = -\\sum_{j \\neq i} q_{ij}$。\n\n假设实验测量表明，对于一个在时间 $t=0$ 时从状态 $S_1$ 开始的系统，在稍后的时间 $t$ 发现其处于状态 $S_3$ 的概率由函数 $P_{13}(t) = c(1 - \\exp(-\\lambda t))$ 给出，其中 $c$ 和 $\\lambda$ 是已知的正常数。\n\n关于系统动力学的进一步信息如下：\n1. 状态 $S_3$ 是一个“吸收”态，意味着没有从该状态转出的转换。\n2. 从状态 $S_1$ 出发的所有可能转换的总速率是一个常数 $\\alpha$。\n\n根据这些信息，确定转移率 $q_{12}$ 和 $q_{23}$ 的乘积。请用 $c$、$\\lambda$ 和 $\\alpha$ 将你的答案表示为符号表达式。", "solution": "令瞬时状态为 $S_{1}$ 和 $S_{2}$，$S_{3}$ 为吸收态。用 $p_{i}(t)$ 表示在给定 $p_{1}(0)=1$，$p_{2}(0)=0$，$p_{3}(0)=0$ 的情况下，在时间 $t$ 处于状态 $S_{i}$ 的概率。处于状态 $S_{3}$ 的概率为 $P_{13}(t)=p_{3}(t)$，根据 Kolmogorov 前向方程，进入 $S_{3}$ 的瞬时通量为\n$$\n\\frac{d}{dt}P_{13}(t)=q_{13}p_{1}(t)+q_{23}p_{2}(t).\n$$\n给定 $P_{13}(t)=c\\bigl(1-\\exp(-\\lambda t)\\bigr)$，我们有\n$$\nP_{13}'(t)=c\\lambda\\exp(-\\lambda t).\n$$\n在 $t=0$ 处求值并使用 $p_{1}(0)=1$，$p_{2}(0)=0$ 得\n$$\nP_{13}'(0)=q_{13}=c\\lambda.\n$$\n使用从 $S_{1}$ 出发的总速率 $q_{12}+q_{13}=\\alpha$，我们得到\n$$\nq_{12}=\\alpha-q_{13}=\\alpha-c\\lambda.\n$$\n\n接下来，对通量再求一次导数：\n$$\nP_{13}''(t)=q_{13}\\frac{dp_{1}}{dt}(t)+q_{23}\\frac{dp_{2}}{dt}(t).\n$$\n根据瞬时状态集上的前向方程，\n$$\n\\frac{dp_{1}}{dt}=-\\alpha p_{1}+q_{21}p_{2},\\qquad \\frac{dp_{2}}{dt}=q_{12}p_{1}-(q_{21}+q_{23})p_{2}.\n$$\n在 $t=0$ 处求值得\n$$\n\\frac{dp_{1}}{dt}(0)=-\\alpha,\\qquad \\frac{dp_{2}}{dt}(0)=q_{12}.\n$$\n因此，\n$$\nP_{13}''(0)=q_{13}\\bigl(-\\alpha\\bigr)+q_{23}q_{12}=-\\alpha q_{13}+q_{12}q_{23}.\n$$\n但从给定的 $P_{13}''(t)=-c\\lambda^{2}\\exp(-\\lambda t)$，所以 $P_{13}''(0)=-c\\lambda^{2}$。令二者相等得\n$$\n-\\alpha q_{13}+q_{12}q_{23}=-c\\lambda^{2}.\n$$\n代入 $q_{13}=c\\lambda$ 和 $q_{12}=\\alpha-c\\lambda$：\n$$\nq_{12}q_{23}=\\alpha(c\\lambda)-c\\lambda^{2}=c\\lambda(\\alpha-\\lambda).\n$$\n\n注：由于 $S_{3}$ 是吸收态且链是有限的，如果 $S_{3}$ 可以从 $S_{1}$ 到达，那么 $\\lim_{t\\to\\infty}P_{13}(t)=1$，这就要求 $c=1$。在这种（物理上典型的）情况下，表达式简化为 $q_{12}q_{23}=\\lambda(\\alpha-\\lambda)$。上述推导仅使用了给定的函数形式，并且在符号上对 $c$、$\\lambda$ 和 $\\alpha$ 成立。", "answer": "$$\\boxed{c\\,\\lambda\\,(\\alpha-\\lambda)}$$", "id": "1330404"}, {"introduction": "接下来，我们将探讨 $P$ 与 $Q$ 之间第二种截然不同但同等重要的关系：测度变换。在这种情境下，$P$ 和 $Q$ 不再是矩阵，而是描述同一事件空间中事件发生可能性的两种不同概率测度。本练习将向你介绍拉东-尼科迪姆导数（Radon-Nikodym derivative），这是一个强大的工具，它在两个概率世界之间充当“汇率”的角色。你将为一个涉及正态分布的常见场景计算这个导数，这是从信号处理到量化金融等领域都至关重要的一项基本技能。[@problem_id:1330409]", "problem": "在统计信号处理领域，一项常见的任务是区分观测信号的不同模型。考虑一个场景，其中记录了一个由随机变量 $X$ 表示的单次测量。关于底层数据生成过程，存在两个相互竞争的假设。\n\n在基准假设下，我们将其与概率测度 $P$ 相关联，测量值 $X$ 假定服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。\n\n在备择假设下，我们将其与概率测度 $Q$ 相关联，测量值 $X$ 假定服从一个均值偏移为 $\\nu$ 但方差仍为 $\\sigma^2$ 的不同正态分布。均值的变化归因于一个影响信号的持续性、非随机效应。\n\n拉东-尼科迪姆导数，记为 $\\frac{dQ}{dP}$，可作为似然比，并且是构建这两个假设之间最优决策规则的基本工具。它量化了在测度 $Q$ 下，一个给定的观测值 $x$ 相对于测度 $P$ 而言的可能性要大多少。\n\n已知均值为 $m$、方差为 $s^2$ 的正态分布的概率密度函数 (PDF) 为 $f(x) = \\frac{1}{\\sqrt{2\\pi}s} \\exp\\left(-\\frac{(x - m)^2}{2s^2}\\right)$，请确定拉东-尼科迪姆导数 $\\frac{dQ}{dP}$，将其表示为观测值 $x$ 以及参数 $\\mu$、$\\nu$ 和 $\\sigma$ 的函数。", "solution": "在 $P$ 下，$X$ 的密度为 $f_{P}(x)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right)$，而在 $Q$ 下，$X$ 的密度为 $f_{Q}(x)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(x-\\nu)^{2}}{2\\sigma^{2}}\\right)$。由于两个分布都关于勒贝格测度是绝对连续的，因此 $Q$ 相对于 $P$ 在 $x$ 处的拉东-尼科迪姆导数就是似然比\n$$\n\\frac{dQ}{dP}(x)=\\frac{f_{Q}(x)}{f_{P}(x)}.\n$$\n代入给定的高斯密度函数，\n$$\n\\frac{dQ}{dP}(x)=\\frac{\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(x-\\nu)^{2}}{2\\sigma^{2}}\\right)}{\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right)}=\\exp\\left(-\\frac{(x-\\nu)^{2}}{2\\sigma^{2}}+\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n合并指数中的项：\n$$\n\\frac{(x-\\mu)^{2}-(x-\\nu)^{2}}{2\\sigma^{2}}=\\frac{\\left(x^{2}-2\\mu x+\\mu^{2}\\right)-\\left(x^{2}-2\\nu x+\\nu^{2}\\right)}{2\\sigma^{2}}=\\frac{2x(\\nu-\\mu)+(\\mu^{2}-\\nu^{2})}{2\\sigma^{2}}.\n$$\n重写 $\\mu^{2}-\\nu^{2}=-(\\nu^{2}-\\mu^{2})=-(\\nu-\\mu)(\\nu+\\mu)$ 以进行因式分解：\n$$\n\\frac{2x(\\nu-\\mu)-(\\nu-\\mu)(\\nu+\\mu)}{2\\sigma^{2}}=\\frac{(\\nu-\\mu)\\left(2x-(\\nu+\\mu)\\right)}{2\\sigma^{2}}=\\frac{\\nu-\\mu}{\\sigma^{2}}\\left(x-\\frac{\\nu+\\mu}{2}\\right).\n$$\n因此，\n$$\n\\frac{dQ}{dP}(x)=\\exp\\left(\\frac{(\\nu-\\mu)\\left(2x-\\nu-\\mu\\right)}{2\\sigma^{2}}\\right)=\\exp\\left(\\frac{\\nu-\\mu}{\\sigma^{2}}\\left(x-\\frac{\\nu+\\mu}{2}\\right)\\right).\n$$", "answer": "$$\\boxed{\\exp\\!\\left(\\frac{\\nu-\\mu}{\\sigma^{2}}\\left(x-\\frac{\\nu+\\mu}{2}\\right)\\right)}$$", "id": "1330409"}]}