{"hands_on_practices": [{"introduction": "更新回报定理的一个最直接且经典的应用是计算系统在特定状态下花费时间的长期比例。这个练习通过一个冰球比赛中“强力打”的生动场景，帮助我们理解如何定义一个“更新周期”以及与之相关的“回报”。通过计算每个周期内的平均回报并除以平均周期长度，我们可以精确地预测系统在达到稳态后的行为。[@problem_id:1339899]", "problem": "在一场职业冰球比赛中，“Stochastic Strikers”队会经历强力进攻（因对手受罚而获得的人数优势时段）。连续两次强力进攻开始之间的时间间隔（以分钟为单位）是独立同分布的随机变量。这些间隔服从区间 $[a, b]$ 上的连续均匀分布。每次强力进攻一旦开始，会持续固定的 $d$ 分钟。即使在此期间有另一次强力进攻开始，“人数优势”状态也会持续这段时间。假设比赛时间足够长。\n\n给定参数 $a = 1$ 分钟，$b = 5$ 分钟，以及 $d = 2$ 分钟，确定在长期运行中，Strikers 队拥有人数优势（即，处于至少一次强力进攻中）的时间所占的比例。", "solution": "我们将一个强力进攻的开始定义为一个更新事件。因此，两个连续更新事件之间的时间间隔 $X$ 服从 $[a, b]$ 上的均匀分布。一个更新周期的平均长度为 $\\mathbb{E}[X]$。\n\n在一个长度为 $X$ 的更新周期内，球队拥有人数优势的时间为“回报”。由于人数优势从周期开始持续 $d$ 分钟，但不能超过周期本身的长度 $X$，所以这个回报是 $\\min(d, X)$。\n\n根据更新回报定理，在长期运行中球队拥有人数优势的时间比例 $p$ 等于每个周期的期望回报除以期望周期长度：\n$$\np = \\frac{\\mathbb{E}[\\min(d, X)]}{\\mathbb{E}[X]}\n$$\n首先，我们计算期望周期长度：\n$$\n\\mathbb{E}[X] = \\frac{a+b}{2} = \\frac{1+5}{2} = 3 \\text{ 分钟}\n$$\n接下来，我们计算期望回报。对于 $X \\sim \\text{Uniform}[a, b]$，其概率密度函数为 $f_X(x) = \\frac{1}{b-a}$。给定 $a=1, b=5, d=2$，我们有 $a  d  b$。因此，期望回报为：\n$$\n\\mathbb{E}[\\min(d, X)] = \\int_a^b \\min(d, x) f_X(x) dx = \\int_1^5 \\min(2, x) \\frac{1}{4} dx\n$$\n$$\n= \\frac{1}{4} \\left( \\int_1^2 x \\,dx + \\int_2^5 2 \\,dx \\right)\n$$\n$$\n= \\frac{1}{4} \\left( \\left[\\frac{x^2}{2}\\right]_1^2 + [2x]_2^5 \\right)\n$$\n$$\n= \\frac{1}{4} \\left( \\left(\\frac{4}{2} - \\frac{1}{2}\\right) + (10 - 4) \\right) = \\frac{1}{4} \\left( \\frac{3}{2} + 6 \\right) = \\frac{1}{4} \\left( \\frac{15}{2} \\right) = \\frac{15}{8}\n$$\n最后，我们将期望回报除以期望周期长度：\n$$\np = \\frac{15/8}{3} = \\frac{15}{24} = \\frac{5}{8}\n$$\n因此，Strikers 队在长期运行中拥有人数优势的时间比例为 $5/8$。", "answer": "$$\\boxed{\\frac{5}{8}}$$", "id": "1339899"}, {"introduction": "在掌握了计算长期比例之后，我们可以进一步探索系统状态的完整概率分布。这个关于服务器组件年龄的练习，旨在阐明更新过程中的一个核心概念：稳态年龄分布。通过这个练习，你将发现并应用“长度偏差”这一反直觉但至关重要的思想，从而推导出在长期运行后，观测到的组件年龄的概率。[@problem_id:1330923]", "problem": "一个数据中心维护着一台关键服务器，其使用的特定类型的处理单元容易发生故障。任何给定单元的故障时间，以离散时间步长（小时）衡量，是一个随机变量。当一个单元发生故障时，会立即用一个相同的新单元替换它。\n\n设连续单元的寿命 $\\{X_i\\}_{i=1}^{\\infty}$ 是独立同分布 (i.i.d.) 的正整数值随机变量。其共同的概率质量函数 (PMF) 由 $p(j) = \\mathbb{P}(X_1 = j)$ 给出，其中 $j \\in \\{1, 2, 3, \\dots\\}$。一个单元的平均寿命为 $\\mu = \\mathbb{E}[X_1]$，并假设其是有限的。更新过程被认为是非周期的。\n\n在任意给定的整数时间 $t  0$，一位工程师检查该服务器。当前安装单元的“年龄”，记为 $A_t$，是其已经运行的小时数。假设系统已经运行了很长时间并达到了稳态，确定该单元年龄恰好为 $k$ 的极限概率，其中 $k$ 是一个非负整数。\n\n用 $\\mu$ 和概率质量函数 $p(j)$ 表示你对 $\\lim_{t \\to \\infty} \\mathbb{P}(A_t = k)$ 的答案。", "solution": "设 $S_{n}=\\sum_{i=1}^{n} X_{i}$ (其中 $S_{0}=0$) 为更新（故障/替换）时刻，并设 $N(t)=\\max\\{n: S_{n}\\le t\\}$ 为到时间 $t$ 为止的更新次数。在时间 $t$ 的年龄是 $A_{t}=t-S_{N(t)}$，其取值范围为 $\\{0,1,2,\\dots\\}$。\n\n假设过程已达到稳态且是非周期的，在很长的时间 $t$ 进行一次检查，相当于以长度偏倚分布对一个周期（单元寿命）进行抽样。具体来说，如果 $J$ 表示其周期包含检查时间的单元的寿命，那么根据更新理论中的标准长度偏倚论证，\n$$\n\\mathbb{P}(J=j)=\\frac{j\\,p(j)}{\\mu}, \\quad j\\in\\{1,2,3,\\dots\\}.\n$$\n在给定 $J=j$ 的条件下，检查时间在周期内的位置在 $j$ 个整数槽 $\\{0,1,\\dots,j-1\\}$ 上均匀分布，因此\n$$\n\\mathbb{P}(A_{t}=k\\mid J=j)=\\frac{1}{j} \\quad \\text{for } 0\\le k\\le j-1, \\quad \\text{and } 0 \\text{ otherwise}.\n$$\n因此，令 $t\\to\\infty$ 并使用全概率定律，\n$$\n\\lim_{t\\to\\infty} \\mathbb{P}(A_{t}=k)=\\sum_{j=k+1}^{\\infty} \\mathbb{P}(J=j)\\,\\mathbb{P}(A_{t}=k\\mid J=j)\n=\\sum_{j=k+1}^{\\infty} \\frac{j\\,p(j)}{\\mu}\\cdot \\frac{1}{j}\n=\\frac{1}{\\mu}\\sum_{j=k+1}^{\\infty} p(j),\n$$\n对于每一个 $k\\in\\{0,1,2,\\dots\\}$。这等于 $\\frac{1}{\\mu}\\mathbb{P}(X_{1}\\ge k+1)$，并且可以验证这是一个真分布，因为\n$$\n\\sum_{k=0}^{\\infty} \\frac{1}{\\mu}\\sum_{j=k+1}^{\\infty} p(j)\n=\\frac{1}{\\mu}\\sum_{j=1}^{\\infty} p(j)\\sum_{k=0}^{j-1} 1\n=\\frac{1}{\\mu}\\sum_{j=1}^{\\infty} j\\,p(j)\n=\\frac{\\mu}{\\mu}=1.\n$$", "answer": "$$\\boxed{\\frac{1}{\\mu}\\sum_{j=k+1}^{\\infty} p(j)}$$", "id": "1330923"}, {"introduction": "更新理论在分析动态系统性能方面也展现出强大的威力，例如估算系统中处于特定状态的实体平均数量。这个关于计算系统中“僵尸”作业期望数量的练习，巧妙地将更新过程的长期到达率与单个实体在特定状态下停留的期望时间结合起来。这种“到达率 $\\times$ 平均停留时间”的模式是随机建模中的一个普适且有力的工具，通常被称为利特尔定律 (Little's Law)。[@problem_id:1339872]", "problem": "一个分布式计算系统接收任务，其到达时间构成一个更新过程。连续任务到达之间的时间间隔是独立同分布的随机变量，服从区间 $[T_{min}, T_{max}]$ 上的均匀分布。\n\n每个传入的任务立即被分叉成两个并行的子任务：一个“快速”任务和一个“慢速”任务。\n- 快速任务总是在固定的时间 $\\tau$ 内完成。\n- 完成慢速任务所需的时间是一个随机变量 $T$，它服从速率参数为 $\\lambda$ 的指数分布。不同任务的慢速任务持续时间彼此独立，也与任务到达过程无关。\n\n如果一个任务的快速任务已经完成，但其慢速任务尚未结束，则该任务被认为处于“僵尸”状态。假设系统已经运行了足够长的时间以达到稳态，处于僵尸状态的任务的长期期望数量是多少？\n\n您的答案应该是一个关于参数 $T_{min}$、$T_{max}$、$\\tau$ 和 $\\lambda$ 的单一闭式解析表达式。", "solution": "设到达间隔时间为 $A \\sim \\text{Uniform}[T_{min}, T_{max}]$。其均值为\n$$\n\\mathbb{E}[A] = \\frac{T_{min} + T_{max}}{2},\n$$\n因此，长期到达率为\n$$\nr = \\frac{1}{\\mathbb{E}[A]} = \\frac{2}{T_{min} + T_{max}}.\n$$\n\n当且仅当一个任务的慢速任务持续时间超过快速任务的完成时间 $\\tau$ 时，该任务才会产生一个僵尸区间。设慢速任务的持续时间为 $T \\sim \\text{Exp}(\\lambda)$，在不同任务间以及与到达过程无关。由一个任务贡献的僵尸区间的长度为\n$$\nZ = \\max\\{T - \\tau, 0\\} = (T - \\tau)^{+}.\n$$\n根据更新回报定理（或应用于由这些僵尸区间构成的无限服务器占用的利特尔法则），僵尸的长期期望数量等于到达率乘以每个任务的平均僵尸持续时间：\n$$\n\\mathbb{E}[\\text{zombies}] = r \\,\\mathbb{E}[Z].\n$$\n\n我们使用指数分布计算 $\\mathbb{E}[Z]$。将其写成积分形式，\n$$\n\\mathbb{E}[Z] = \\int_{\\tau}^{\\infty} (t - \\tau)\\,\\lambda \\exp(-\\lambda t)\\,dt.\n$$\n代入 $u = t - \\tau$ 得到\n$$\n\\mathbb{E}[Z] = \\int_{0}^{\\infty} u \\,\\lambda \\exp[-\\lambda(u + \\tau)]\\,du\n= \\exp(-\\lambda \\tau)\\int_{0}^{\\infty} u \\,\\lambda \\exp(-\\lambda u)\\,du.\n$$\n使用 $\\int_{0}^{\\infty} u \\,\\lambda \\exp(-\\lambda u)\\,du = \\frac{1}{\\lambda}$，我们得到\n$$\n\\mathbb{E}[Z] = \\frac{\\exp(-\\lambda \\tau)}{\\lambda}.\n$$\n\n因此，\n$$\n\\mathbb{E}[\\text{zombies}] = r \\,\\mathbb{E}[Z] = \\frac{2}{T_{min} + T_{max}} \\cdot \\frac{\\exp(-\\lambda \\tau)}{\\lambda}\n= \\frac{2\\,\\exp(-\\lambda \\tau)}{\\lambda\\,(T_{min} + T_{max})}.\n$$", "answer": "$$\\boxed{\\frac{2\\,\\exp(-\\lambda \\tau)}{\\lambda\\,(T_{min} + T_{max})}}$$", "id": "1339872"}]}