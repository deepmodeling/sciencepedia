{"hands_on_practices": [{"introduction": "我们从一个离散时间的场景开始热身。在许多随机过程中，我们不仅关心事件是否发生，还关心第 $k$ 次事件具体发生在何时。这个问题 [@problem_id:1309338] 探讨了在一系列独立的伯努利试验中，第二次成功恰好发生在第十次试验的概率。这为我们练习和理解负二项分布提供了一个绝佳的实例，该分布是泊松过程中等待时间的离散对应物。", "problem": "一个大型数据中心的服务器处理连续的用户请求流。大多数请求是标准请求，但一小部分是需要特殊处理的“高优先级”请求。每个传入的请求被独立地分类为高优先级，其概率为常数 $p$，其中 $0  p  1$。\n\n一位工程师开始监控请求流。求该工程师观察到的第二个高优先级请求恰好是监控开始后到达服务器的第十个请求的概率。请用含 $p$ 的符号表达式表示你的答案。", "solution": "将请求的到达建模为独立的伯努利试验，其中成功（高优先级）的概率为 $p$。第二个高优先级请求恰好在第十个请求时发生的事件需要满足两个条件：\n1) 在前九个请求中，恰好有一个高优先级请求。\n2) 第十个请求是高优先级请求。\n\n根据独立性，总概率是这两个概率的乘积。\n\n在前九个请求中恰好有一个高优先级的概率是\n$$\n\\binom{9}{1} p^{1} (1-p)^{9-1}=\\binom{9}{1} p (1-p)^{8}.\n$$\n第十个请求是高优先级的概率是\n$$\np.\n$$\n将两者相乘，所求概率为\n$$\n\\binom{9}{1} p (1-p)^{8} \\cdot p=\\binom{9}{1} p^{2} (1-p)^{8}.\n$$\n等价地，使用负二项分布形式来表示第 $r$ 次成功的时间，\n$$\n\\Pr(T=10)=\\binom{10-1}{2-1} p^{2} (1-p)^{10-2}=\\binom{9}{1} p^{2} (1-p)^{8}.\n$$", "answer": "$$\\boxed{\\binom{9}{1}p^{2}(1-p)^{8}}$$", "id": "1309338"}, {"introduction": "现在我们将注意力转向连续时间的泊松过程。泊松过程有一个非常重要且优美的性质：在给定时间间隔 $[0, T]$ 内发生了 $n$ 个事件的条件下，这些事件的到达时间遵循 $n$ 个在 $[0, T]$ 上独立的均匀分布随机变量的顺序统计量。这个问题 [@problem_id:1309329] 要求我们利用这一核心性质来计算第二次事件到达时间的期望值，从而将抽象的理论应用到具体的计算中，加深对事件到达时间分布的理解。", "problem": "一个新发布的软件应用程序收到的错误报告，其到达过程遵循一个齐次泊松过程。在其发布的第一周内，即时间区间从 $t=0$ 到 $t=7$ 天，观测到恰好报告了四个不同的错误。设 $T_1, T_2, T_3, T_4$ 为随机变量，代表这四个错误被报告的有序时间（以天为单位），使得 $0 \\le T_1  T_2  T_3  T_4 \\le 7$。\n\n计算第二个错误报告的期望时间 $E[T_2]$。\n\n以天为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "设 $N(t)$ 是一个率为 $\\lambda$ 的齐次泊松过程。在 $N(7)=4$ 的条件下，有序到达时间 $(T_{1},T_{2},T_{3},T_{4})$ 与 4 个独立的 $\\operatorname{Uniform}(0,7)$ 随机变量的次序统计量具有相同的分布。在单纯形 $0 \\le t_{1}  \\dots  t_{4} \\le 7$ 上的联合条件密度为\n$$\nf_{T_{1},\\dots,T_{4}\\mid N(7)=4}(t_{1},\\dots,t_{4})=\\frac{4!}{7^{4}} \\quad \\text{for } 0 \\le t_{1}  \\dots  t_{4} \\le 7.\n$$\n对于来自 $n=4$ 个 $\\operatorname{Uniform}(0,7)$ 分布样本的第 $k$ 个次序统计量，已知\n$$\n\\frac{T_{k}}{7} \\sim \\operatorname{Beta}(k, n+1-k),\n$$\n所以\n$$\nE\\!\\left[\\frac{T_{k}}{7}\\right]=\\frac{k}{n+1} \\quad \\Rightarrow \\quad E[T_{k}]=\\frac{k}{n+1}\\cdot 7.\n$$\n代入 $k=2$ 和 $n=4$ 得到\n$$\nE[T_{2}]=\\frac{2}{5}\\cdot 7=\\frac{14}{5}=2.8.\n$$\n四舍五入到三位有效数字得到 $2.80$ 天。", "answer": "$$\\boxed{2.80}$$", "id": "1309329"}, {"introduction": "在前一个练习的基础上，我们来挑战一个更复杂的条件期望问题。在科学实验和数据分析中，我们常常需要根据已观测到的结果来更新我们的预测，例如，只有当观测到足够多的事件时，一次实验才被认为是“有效的”。这个问题 [@problem_id:1309347] 正是模拟了这种情况，它要求我们计算在观测到超过一个事件的条件下，第一个事件到达时间的期望。这需要我们综合运用全期望定律和泊松过程的性质，是检验和提升问题解决能力的好机会。", "problem": "在一个粒子物理实验中，设置了一个探测器来记录宇宙射线μ子的到达。这些到达事件被建模为一个齐次泊松过程，其平均速率为每单位时间 $\\lambda$ 次到达。探测器被激活一段固定的时间 $T$。为了使一次实验运行被认为是有效的，探测器必须记录到超过一次μ子到达。已知一次运行是有效的，求第一次μ子到达的期望时间。\n\n请用参数 $\\lambda$ 和 $T$ 给出一个单一的封闭形式解析表达式作为你的答案。", "solution": "设 $N(t)$ 是一个速率为 $\\lambda$ 的齐次泊松过程。在一个固定的时间窗口 $[0,T]$ 内，有效运行的事件是 $V=\\{N(T)\\geq 2\\}$。设 $S_{1}$ 表示在 $[0,T]$ 内第一次到达的时间。我们要求解 $\\mathbb{E}[S_{1}\\mid V]$。\n\n以 $N(T)=n$ 为条件。泊松过程的一个标准性质是，在给定 $N(T)=n$ 的条件下，这 $n$ 个到达时间是 $n$ 个独立同分布的 $\\mathrm{Uniform}(0,T)$ 随机变量的顺序统计量。因此，$S_{1}$ 是 $n$ 个独立同分布的 $\\mathrm{Uniform}(0,T)$ 变量中的最小值。对于 $n\\geq 1$，\n$$\n\\mathbb{P}(S_{1}s\\mid N(T)=n)=\\mathbb{P}(\\text{all }n\\text{ exceed }s) = \\left(1-\\frac{s}{T}\\right)^{n},\\quad 0\\leq s\\leq T,\n$$\n所以\n$$\n\\mathbb{E}[S_{1}\\mid N(T)=n]=\\int_{0}^{T}\\mathbb{P}(S_{1}s\\mid N(T)=n)\\,ds\n=\\int_{0}^{T}\\left(1-\\frac{s}{T}\\right)^{n}ds\n= T\\int_{0}^{1}u^{n}du=\\frac{T}{n+1}.\n$$\n\n对 $V$ 使用全期望定律，\n$$\n\\mathbb{E}[S_{1}\\mid V]=\\sum_{n=2}^{\\infty}\\mathbb{E}[S_{1}\\mid N(T)=n]\\ \\mathbb{P}(N(T)=n\\mid V)\n=\\frac{T}{\\mathbb{P}(V)}\\sum_{n=2}^{\\infty}\\frac{\\mathbb{P}(N(T)=n)}{n+1}.\n$$\n令 $\\mu=\\lambda T$，则 $\\mathbb{P}(N(T)=n)=\\exp(-\\mu)\\mu^{n}/n!$ 且 $\\mathbb{P}(V)=1-\\exp(-\\mu)(1+\\mu)$。因此，分子的求和项为\n$$\n\\sum_{n=2}^{\\infty}\\frac{\\exp(-\\mu)\\mu^{n}}{n!(n+1)}\n=\\exp(-\\mu)\\sum_{n=2}^{\\infty}\\frac{\\mu^{n}}{n!}\\int_{0}^{1}x^{n}dx\n=\\exp(-\\mu)\\int_{0}^{1}\\sum_{n=2}^{\\infty}\\frac{(\\mu x)^{n}}{n!}\\,dx.\n$$\n计算级数，\n$$\n\\sum_{n=2}^{\\infty}\\frac{(\\mu x)^{n}}{n!}=\\exp(\\mu x)-1-\\mu x,\n$$\n所以\n$$\n\\sum_{n=2}^{\\infty}\\frac{\\exp(-\\mu)\\mu^{n}}{n!(n+1)}\n=\\exp(-\\mu)\\int_{0}^{1}\\bigl(\\exp(\\mu x)-1-\\mu x\\bigr)\\,dx\n=\\exp(-\\mu)\\left(\\frac{\\exp(\\mu)-1}{\\mu}-1-\\frac{\\mu}{2}\\right).\n$$\n化简后得到\n$$\n\\sum_{n=2}^{\\infty}\\frac{\\exp(-\\mu)\\mu^{n}}{n!(n+1)}\n=\\frac{1-\\exp(-\\mu)\\left(1+\\mu+\\frac{\\mu^{2}}{2}\\right)}{\\mu}.\n$$\n因此，\n$$\n\\mathbb{E}[S_{1}\\mid V]\n=\\frac{T}{1-\\exp(-\\mu)(1+\\mu)}\\cdot\\frac{1-\\exp(-\\mu)\\left(1+\\mu+\\frac{\\mu^{2}}{2}\\right)}{\\mu}.\n$$\n代入 $\\mu=\\lambda T$ 并化简 $T/\\mu=1/\\lambda$，\n$$\n\\mathbb{E}[S_{1}\\mid N(T)1]\n=\\frac{1}{\\lambda}\\cdot\\frac{1-\\exp(-\\lambda T)\\left(1+\\lambda T+\\frac{(\\lambda T)^{2}}{2}\\right)}{1-\\exp(-\\lambda T)\\left(1+\\lambda T\\right)}.\n$$\n\n作为检验：当 $T\\to\\infty$ 时，条件的作用变得可以忽略不计，表达式趋向于 $1/\\lambda$。对于小的 $T$，它趋向于 $T/3$，这与在 $[0,T]$ 上两个均匀分布点的最小值的期望相匹配。", "answer": "$$\\boxed{\\frac{1}{\\lambda}\\cdot\\frac{1-\\exp(-\\lambda T)\\left(1+\\lambda T+\\frac{(\\lambda T)^{2}}{2}\\right)}{1-\\exp(-\\lambda T)\\left(1+\\lambda T\\right)}}$$", "id": "1309347"}]}