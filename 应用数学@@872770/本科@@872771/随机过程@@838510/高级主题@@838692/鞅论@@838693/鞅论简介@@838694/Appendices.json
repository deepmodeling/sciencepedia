{"hands_on_practices": [{"introduction": "理解鞅的核心在于掌握其定义：在已知当前信息下，未来的期望等于当前值。此练习 [@problem_id:1310299] 提供了一个直观的场景——粒子在圆环上的随机游走——来检验这一定义。虽然在一维直线上的对称随机游走是鞅，但循环边界的存在是否会改变这一性质？通过仔细计算边界点处的条件期望，你将深入理解鞅属性的微妙之处。", "problem": "一个粒子在一组排列成圆环的 $N$ 个顶点上进行对称随机游走，这些顶点标记为 $0, 1, 2, \\dots, N-1$。设粒子在时间步长 $n$ 的位置为离散时间随机过程 $\\{X_n\\}_{n \\ge 0}$，其中 $n$ 是一个非负整数。该过程的状态空间是顶点集合 $S = \\{0, 1, \\dots, N-1\\}$，其中 $N$ 是一个固定的整数且 $N \\ge 3$。\n\n在每个时间步长，粒子从其当前顶点 $k$ 移动到一个相邻的顶点。它以概率 $1/2$ 顺时针移动到顶点 $(k+1) \\pmod N$，并以概率 $1/2$ 逆时针移动到顶点 $(k-1) \\pmod N$。初始位置 $X_0$ 可以是 $S$ 中的任何顶点。\n\n设 $\\{\\mathcal{F}_n\\}_{n \\ge 0}$ 是由该过程生成的自然滤过，即 $\\mathcal{F}_n = \\sigma(X_0, X_1, \\dots, X_n)$。\n\n下列哪个陈述准确地描述了随机过程 $\\{X_n\\}_{n \\ge 0}$ 关于滤过 $\\{\\mathcal{F}_n\\}_{n \\ge 0}$ 的性质？\n\nA. 对于所有整数 $N \\ge 3$，$\\{X_n\\}$ 是一个鞅。\nB. $\\{X_n\\}$ 是一个鞅，但仅当 $N \\ge 3$ 为偶数时成立。\nC. 对于任何整数 $N \\ge 3$，$\\{X_n\\}$ 都不是鞅。\nD. 对于所有整数 $N \\ge 3$，$\\{X_n\\}$ 是一个下鞅。\nE. 对于所有整数 $N \\ge 3$，$\\{X_n\\}$ 是一个上鞅。", "solution": "我们回顾鞅的定义：一个关于滤过 $\\{\\mathcal{F}_{n}\\}$ 的可积、适应过程 $\\{X_{n}\\}$ 是鞅，当且仅当\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid \\mathcal{F}_{n}\\right]=X_{n}\\quad\\text{a.s.}\n$$\n如果 $\\mathbb{E}\\!\\left[X_{n+1}\\mid \\mathcal{F}_{n}\\right]\\geq X_{n}$ 几乎必然成立，则它是一个下鞅；如果 $\\mathbb{E}\\!\\left[X_{n+1}\\mid \\mathcal{F}_{n}\\right]\\leq X_{n}$ 几乎必然成立，则它是一个上鞅。根据构造，过程 $\\{X_{n}\\}$ 对其自然滤过是适应的，并且由于对所有 $n$ 都有 $0\\leq X_{n}\\leq N-1$，所以它是可积的。\n\n因为该过程是循环上的一个时齐马尔可夫链，其转移概率仅取决于当前状态，所以我们有\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid \\mathcal{F}_{n}\\right]=\\mathbb{E}\\!\\left[X_{n+1}\\mid X_{n}\\right].\n$$\n对于当前状态 $k\\in S=\\{0,1,\\dots,N-1\\}$，下一状态以概率 $\\frac{1}{2}$ 等于 $(k+1)\\bmod N$，以概率 $\\frac{1}{2}$ 等于 $(k-1)\\bmod N$。用 $\\tilde{k\\pm1}$ 表示 $(k\\pm1)\\bmod N$ 在集合 $\\{0,1,\\dots,N-1\\}$ 中的代表元。那么\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid X_{n}=k\\right]=\\frac{1}{2}\\,\\tilde{k+1}+\\frac{1}{2}\\,\\tilde{k-1}.\n$$\n对于内部状态 $k\\in\\{1,2,\\dots,N-2\\}$，不存在环绕（wrap-around），且 $\\tilde{k+1}=k+1$, $\\tilde{k-1}=k-1$，因此\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid X_{n}=k\\right]=\\frac{1}{2}(k+1)+\\frac{1}{2}(k-1)=k.\n$$\n在边界状态，环绕效应很重要。对于 $k=0$，相邻顶点是 $1$ 和 $N-1$，所以\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid X_{n}=0\\right]=\\frac{1}{2}\\cdot 1+\\frac{1}{2}\\cdot (N-1)=\\frac{N}{2}\\neq 0\\quad\\text{for any }N\\geq 3.\n$$\n对于 $k=N-1$，相邻顶点是 $0$ 和 $N-2$，所以\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid X_{n}=N-1\\right]=\\frac{1}{2}\\cdot 0+\\frac{1}{2}\\cdot (N-2)=\\frac{N-2}{2}\\neq N-1\\quad\\text{for any }N\\geq 3.\n$$\n因此，对于所有整数 $N\\geq 3$，鞅条件在 $k=0$ 和 $k=N-1$ 处不成立，所以对于任何这样的 $N$，$\\{X_{n}\\}$ 都不是鞅。\n\n对于 $N\\geq 3$ 它也不是一致的下鞅或上鞅：在 $k=0$ 处，有\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid X_{n}=0\\right]=\\frac{N}{2}>0=X_{n},\n$$\n这违反了上鞅不等式，而在 $k=N-1$ 处，有\n$$\n\\mathbb{E}\\!\\left[X_{n+1}\\mid X_{n}=N-1\\right]=\\frac{N-2}{2}  N-1 \\quad\\text{(对于 } N \\ge 3 \\text{)},\n$$\n这违反了下鞅不等式。因此，该过程既不是上鞅也不是下鞅。", "answer": "$$\\boxed{C}$$", "id": "1310299"}, {"introduction": "当一个随机过程不满足“公平游戏”的条件时，我们能否通过某种方式“修正”它？此练习 [@problem_id:1310309] 探讨了这一核心思想，即寻找一个“补偿过程”，使得原过程减去它之后能成为一个鞅。这个问题以一个赌徒的财富变化为背景，让你亲手构建这个可预测的补偿项，从而揭示了鞅分解理论的直观应用。", "problem": "一个赌徒以初始财富 $W_0 > 0$ 开始。在每个离散时间步 $n=1, 2, 3, \\dots$，赌徒根据掷一个公平的六面骰子的结果进行一局游戏。令 $W_{n-1}$ 表示赌徒在第 $n$ 次掷骰子之前的财富。游戏规则如下：\n\n- 如果骰子显示 1 或 2 (概率为 $1/3$)，赌徒的财富减半，因此他们的新财富为 $W_n = \\frac{1}{2}W_{n-1}$。\n- 如果骰子显示 3, 4, 5 或 6 (概率为 $2/3$)，赌徒的财富增加一个分数 $\\alpha = 1/2$，因此他们的新财富为 $W_n = (1 + 1/2)W_{n-1} = \\frac{3}{2}W_{n-1}$。\n\n令 $(\\mathcal{F}_n)_{n \\geq 0}$ 是由掷骰子序列生成的自然滤过，其中 $\\mathcal{F}_0$ 是平凡 σ-代数。财富过程 $(W_n)_{n \\geq 0}$ 相对于此滤过不是一个鞅。\n\n你的任务是找到唯一的“补偿”过程 $(A_n)_{n \\geq 0}$，使得整个游戏在特定意义上是公平的。找到可预测过程 $A_n$ (其中 $A_0=0$)，使得由 $M_n = W_n - A_n$ 定义的新过程是关于滤过 $(\\mathcal{F}_n)_{n \\geq 0}$ 的一个鞅。一个过程 $(A_n)$ 是可预测的，如果对于每个 $n \\geq 1$，$A_n$ 的值在时间 $n-1$ 是已知的（即 $A_n$ 是 $\\mathcal{F}_{n-1}$-可测的）。\n\n请为 $n \\geq 1$ 的 $A_n$ 提供一个闭式表达式。你的答案应该用财富过程的历史，即 $W_0, W_1, \\dots, W_{n-1}$ 来表示。", "solution": "问题要求我们找到一个可预测过程 $A_n$（其中 $A_0=0$），使得 $M_n = W_n - A_n$ 是关于滤过 $(\\mathcal{F}_n)_{n \\geq 0}$ 的一个鞅。\n\n鞅的定义指出，对于所有 $n \\geq 1$，过程 $M_n$ 必须满足 $E[M_n | \\mathcal{F}_{n-1}] = M_{n-1}$。\n\n让我们将 $M_n$ 的定义代入此方程：\n$$\nE[W_n - A_n | \\mathcal{F}_{n-1}] = W_{n-1} - A_{n-1}\n$$\n\n利用条件期望的线性性，我们可以将左边的项分开：\n$$\nE[W_n | \\mathcal{F}_{n-1}] - E[A_n | \\mathcal{F}_{n-1}] = W_{n-1} - A_{n-1}\n$$\n\n过程 $A_n$ 被定义为可预测的。这意味着对于任何 $n \\ge 1$，$A_n$ 是 $\\mathcal{F}_{n-1}$-可测的。一个相对于某个 σ-代数可测的变量，在对该 σ-代数取条件期望时被视为常数。因此，$E[A_n | \\mathcal{F}_{n-1}] = A_n$。\n\n将此结果代回我们的方程，得到：\n$$\nE[W_n | \\mathcal{F}_{n-1}] - A_n = W_{n-1} - A_{n-1}\n$$\n\n我们可以重新整理这个方程，以找到 $A_n$ 的递推关系：\n$$\nA_n - A_{n-1} = E[W_n | \\mathcal{F}_{n-1}] - W_{n-1}\n$$\n\n现在，我们需要计算 $E[W_n | \\mathcal{F}_{n-1}]$。时间 $n$ 的财富 $W_n$ 取决于时间 $n-1$ 的财富 $W_{n-1}$ 和第 $n$ 次掷骰子的结果。在时间 $n-1$，$W_{n-1}$ 的值是已知的，因此它是 $\\mathcal{F}_{n-1}$-可测的，可以从条件期望中提出来。\n\n令 $X_n$ 为第 $n$ 次掷骰子的结果。过程 $W_n$ 可以写成 $W_n = W_{n-1} \\cdot f(X_n)$，其中 $f(X_n)$ 是乘法因子。\n如果 $X_n \\in \\{1, 2\\}$，因子 $f(X_n)$ 为 $\\frac{1}{2}$；如果 $X_n \\in \\{3, 4, 5, 6\\}$，则为 $\\frac{3}{2}$。\n\n所以，我们有：\n$$\nE[W_n | \\mathcal{F}_{n-1}] = E[W_{n-1} \\cdot f(X_n) | \\mathcal{F}_{n-1}] = W_{n-1} E[f(X_n) | \\mathcal{F}_{n-1}]\n$$\n\n由于掷骰子是独立的，第 $n$ 次掷骰子的结果 $X_n$ 与过去的掷骰结果 $(X_1, \\dots, X_{n-1})$ 无关，因此与滤过 $\\mathcal{F}_{n-1}$ 独立。所以，$f(X_n)$ 的条件期望就是它的无条件期望：\n$$\nE[f(X_n) | \\mathcal{F}_{n-1}] = E[f(X_n)]\n$$\n\n我们可以利用结果的概率来计算 $E[f(X_n)]$：\n$$\nE[f(X_n)] = P(X_n \\in \\{1, 2\\}) \\cdot \\left(\\frac{1}{2}\\right) + P(X_n \\in \\{3, 4, 5, 6\\}) \\cdot \\left(\\frac{3}{2}\\right)\n$$\n$$\nE[f(X_n)] = \\left(\\frac{2}{6}\\right) \\cdot \\left(\\frac{1}{2}\\right) + \\left(\\frac{4}{6}\\right) \\cdot \\left(\\frac{3}{2}\\right) = \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{2}\\right) + \\left(\\frac{2}{3}\\right) \\cdot \\left(\\frac{3}{2}\\right)\n$$\n$$\nE[f(X_n)] = \\frac{1}{6} + 1 = \\frac{7}{6}\n$$\n\n所以，$W_n$ 的条件期望是：\n$$\nE[W_n | \\mathcal{F}_{n-1}] = W_{n-1} \\cdot \\frac{7}{6}\n$$\n（这证实了 $W_n$ 是一个下鞅，因为 $E[W_n | \\mathcal{F}_{n-1}] > W_{n-1}$。）\n\n现在我们将这个结果代回 $A_n$ 的递推关系中：\n$$\nA_n - A_{n-1} = \\frac{7}{6}W_{n-1} - W_{n-1} = \\frac{1}{6}W_{n-1}\n$$\n\n这给出了过程 $A_n$ 的增量。为了找到 $A_n$ 本身，我们可以将其写成从 $A_0$ 开始的增量之和。\n$$\nA_n = A_0 + \\sum_{k=1}^{n} (A_k - A_{k-1})\n$$\n\n我们已知 $A_0=0$。代入增量的表达式：\n$$\nA_n = 0 + \\sum_{k=1}^{n} \\left(\\frac{1}{6}W_{k-1}\\right)\n$$\n\n这个和可以通过改变求和指标来写出。令 $j=k-1$。当 $k=1$ 时，$j=0$。当 $k=n$ 时，$j=n-1$。\n$$\nA_n = \\frac{1}{6} \\sum_{j=0}^{n-1} W_j\n$$\n为了符合惯例，将哑指标 $j$ 替换回 $k$，得到补偿过程的最终表达式：\n$$\nA_n = \\frac{1}{6} \\sum_{k=0}^{n-1} W_k\n$$\n$A_n$ 的这个表达式只依赖于 $W_0, W_1, \\ldots, W_{n-1}$，这些在时间 $n-1$ 都是已知的，这证实了 $A_n$ 是一个可预测过程。", "answer": "$$\\boxed{\\frac{1}{6}\\sum_{k=0}^{n-1} W_k}$$", "id": "1310309"}, {"introduction": "除了简单的随机游走本身，我们还可以构造更复杂的鞅。此练习 [@problem_id:1310328] 挑战你处理一个由随机游走的三次方构成的过程。通过寻找一个特定的补偿项，你将把这个非鞅过程转化为一个真正的鞅，这不仅能锻炼你的代数技巧，还能让你熟悉如何从基本过程出发构建出新的、更有用的鞅。", "problem": "考虑一个在整数上的简单对称随机游走 $\\{S_n\\}_{n \\ge 0}$。该游走从 $S_0 = 0$ 开始，并根据 $S_n = \\sum_{i=1}^{n} Y_i$（$n \\ge 1$）演变，其中 $\\{Y_i\\}_{i \\ge 1}$ 是独立同分布的随机变量序列，其概率分布为 $P(Y_i = 1) = P(Y_i = -1) = 1/2$。\n\n令 $\\mathcal{F}_n = \\sigma(Y_1, \\dots, Y_n)$ 是表示直到时间 $n$ 的游走历史的自然滤过。如果一个随机过程 $\\{X_n\\}_{n \\ge 0}$ 对 $\\mathcal{F}_n$ 是适应的，$E[|X_n|]  \\infty$ 对所有 $n$ 成立，并且满足条件 $E[X_{n+1} | \\mathcal{F}_n] = X_n$，那么它就是关于这个滤过的一个鞅。\n\n现在，考虑一个新过程 $\\{M_n\\}_{n \\ge 0}$，定义为 $M_n = S_n^3 - a n S_n$，其中 $a$ 是一个实常数。确定常数 $a$ 的具体值，使得 $\\{M_n\\}$ 是关于滤过 $\\{\\mathcal{F}_n\\}$ 的一个鞅。", "solution": "我们寻求常数 $a$，使得 $M_{n} = S_{n}^{3} - a n S_{n}$ 是关于 $\\{\\mathcal{F}_{n}\\}$ 的一个鞅。鞅条件要求对所有 $n$ 都有 $E[M_{n+1} \\mid \\mathcal{F}_{n}] = M_{n}$。由于 $S_{n+1} = S_{n} + Y_{n+1}$，其中 $Y_{n+1}$ 独立于 $\\mathcal{F}_{n}$，均值为零，且对称，满足 $P(Y_{n+1}=1)=P(Y_{n+1}=-1)=\\frac{1}{2}$，我们使用以下事实：\n- $E[Y_{n+1} \\mid \\mathcal{F}_{n}] = 0$，\n- $E[Y_{n+1}^{2} \\mid \\mathcal{F}_{n}] = 1$，\n- $E[Y_{n+1}^{3} \\mid \\mathcal{F}_{n}] = 0$，\n并且 $S_{n}$ 是 $\\mathcal{F}_{n}$-可测的。\n\n计算条件期望：\n$$\nM_{n+1} = S_{n+1}^{3} - a (n+1) S_{n+1} = (S_{n} + Y_{n+1})^{3} - a (n+1) (S_{n} + Y_{n+1}).\n$$\n使用二项式定理展开立方项：\n$$\n(S_{n} + Y_{n+1})^{3} = S_{n}^{3} + 3 S_{n}^{2} Y_{n+1} + 3 S_{n} Y_{n+1}^{2} + Y_{n+1}^{3}.\n$$\n逐项取关于 $\\mathcal{F}_{n}$ 的条件期望，利用独立性和上面列出的矩：\n$$\nE[S_{n+1}^{3} \\mid \\mathcal{F}_{n}] = S_{n}^{3} + 3 S_{n}^{2} E[Y_{n+1} \\mid \\mathcal{F}_{n}] + 3 S_{n} E[Y_{n+1}^{2} \\mid \\mathcal{F}_{n}] + E[Y_{n+1}^{3} \\mid \\mathcal{F}_{n}] = S_{n}^{3} + 3 S_{n}.\n$$\n此外，\n$$\nE[S_{n+1} \\mid \\mathcal{F}_{n}] = E[S_{n} + Y_{n+1} \\mid \\mathcal{F}_{n}] = S_{n} + E[Y_{n+1} \\mid \\mathcal{F}_{n}] = S_{n}.\n$$\n因此，\n$$\nE[M_{n+1} \\mid \\mathcal{F}_{n}] = E[S_{n+1}^{3} \\mid \\mathcal{F}_{n}] - a (n+1) E[S_{n+1} \\mid \\mathcal{F}_{n}] = (S_{n}^{3} + 3 S_{n}) - a (n+1) S_{n}.\n$$\n对于鞅条件，令上式等于 $M_{n} = S_{n}^{3} - a n S_{n}$：\n$$\nS_{n}^{3} + 3 S_{n} - a (n+1) S_{n} = S_{n}^{3} - a n S_{n}.\n$$\n消去 $S_{n}^{3}$ 并整理：\n$$\n3 S_{n} - a (n+1) S_{n} = - a n S_{n}.\n$$\n两边加上 $a (n+1) S_{n}$：\n$$\n3 S_{n} = a S_{n}.\n$$\n这个等式必须对所有 $S_{n}$ 以正概率取到的值都成立，因此它强制\n$$\na = 3.\n$$\n该过程是适应的，因为 $M_{n}$ 是 $S_{n}$ 的函数；并且是可积的，因为 $|S_{n}| \\leq n$ 意味着 $|S_{n}^{3}| \\leq n^{3}$ 和 $|n S_{n}| \\leq n^{2}$，这保证了 $E[|M_{n}|]  \\infty$。因此，当 $a=3$ 时，$\\{M_{n}\\}$ 是一个鞅。", "answer": "$$\\boxed{3}$$", "id": "1310328"}]}