{"hands_on_practices": [{"introduction": "在对时间序列进行建模之前，确保其平稳性是关键的第一步。自回归 (AR) 模型是分析时间序列的基本工具之一，而模型的稳定性（即平稳性）完全取决于其参数。本练习将指导你通过求解特征方程，亲手检验一个 AR(2) 模型的平稳性，这是理解模型有效性的核心技能。[@problem_id:1312127]", "problem": "一位分析师正在使用一个二阶自回归（AR）模型来为一个金融时间序列（表示为过程 $\\{X_t\\}$）建模。一个AR(2)过程通常由方程 $X_t = c + \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + Z_t$ 定义，其中 $Z_t$ 是一个零均值的白噪声过程。对于这个特定的模型，常数项 $c$ 为零，模型由下式给出：\n\n$$X_t = X_{t-1} - 0.25 X_{t-2} + Z_t$$\n\n该模型的稳定性和性质由其特征多项式 $P(z)$ 决定，该多项式由自回归系数导出。一个关键性质是平稳性，它要求特征方程 $P(z)=0$ 的所有根都位于复平面的单位圆之外（即，每个根的模都必须大于1）。\n\n给定该模型，确定其特征多项式以及该过程是否平稳。下列哪个陈述是正确的？\n\nA. 特征多项式是 $P(z) = 1 - z + 0.25z^2$，且该过程是平稳的。\n\nB. 特征多项式是 $P(z) = 1 - z + 0.25z^2$，且该过程不是平稳的。\n\nC. 特征多项式是 $P(z) = 1 + z - 0.25z^2$，且该过程不是平稳的。\n\nD. 特征多项式是 $P(z) = z^2 - z + 0.25$，且该过程不是平稳的。", "solution": "对于一个AR(2)过程 $X_{t}=\\phi_{1}X_{t-1}+\\phi_{2}X_{t-2}+Z_{t}$，其滞后算子 $B$ 的自回归多项式是 $\\phi(B)=1-\\phi_{1}B-\\phi_{2}B^{2}$，这是通过将方程整理为 $\\phi(B)X_{t}=Z_{t}$ 得到的。那么，关于复变量 $z$ 的特征多项式是 $P(z)=1-\\phi_{1}z-\\phi_{2}z^{2}$。\n\n在给定的模型 $X_{t}=X_{t-1}-0.25\\,X_{t-2}+Z_{t}$ 中，我们确定 $\\phi_{1}=1$ 和 $\\phi_{2}=-0.25$。因此，\n$$\nP(z)=1-\\phi_{1}z-\\phi_{2}z^{2}=1-z+0.25\\,z^{2}.\n$$\n\n为了评估平稳性，我们求解 $P(z)=0$ 并要求所有根都满足 $|z|>1$。求解\n$$\n0.25\\,z^{2}-z+1=0.\n$$\n设 $a=0.25$，$b=-1$，$c=1$，则判别式为\n$$\n\\Delta=b^{2}-4ac=1-4\\cdot 0.25\\cdot 1=0,\n$$\n所以有一个重根\n$$\nz=\\frac{-b}{2a}=\\frac{1}{0.5}=2.\n$$\n由于 $|2|>1$，所有根都位于单位圆之外，因此该过程是平稳的。\n\n因此，正确的陈述是 $P(z)=1-z+0.25z^{2}$ 且该过程是平稳的。", "answer": "$$\\boxed{A}$$", "id": "1312127"}, {"introduction": "除了 AR 模型，移动平均 (MA) 模型是时间序列分析的另一块重要基石。与 AR 模型不同，MA 模型对过去的随机冲击只有有限的“记忆”。本练习将通过计算一个多步预测来探索这一特性，让你直观地理解为何 MA 模型的预测能力会随着预测时间的推移而迅速消失。[@problem_id:1312088]", "problem": "一位量化分析师正在对一个股价预测模型的每日残差 $X_t$ 进行建模。该分析师提出，这些残差可以用一个2阶移动平均(MA(2))过程来描述。该模型由以下方程给出：\n$$X_t = Z_t + \\theta_1 Z_{t-1} + \\theta_2 Z_{t-2}$$\n这里，$\\{Z_t\\}$ 是一个均值为零、方差为常数 $\\sigma_Z^2$ 的白噪声过程。这意味着在任何时间 $t$，噪声项的期望值为 $E[Z_t] = 0$，且噪声项是不相关的，即对于所有 $t \\ne s$，有 $E[Z_t Z_s] = 0$。参数 $\\theta_1$ 和 $\\theta_2$ 是已知的非零常数系数。\n\n在时间 $t$ 对未来 $k$ 步的最优预测，记作 $\\hat{X}_t(k)$。该预测定义为未来值 $X_{t+k}$ 在给定截至时间 $t$ (包含 $t$) 的所有可用信息下的条件期望。在数学上，这表示为：\n$$\\hat{X}_t(k) = E[X_{t+k} | \\mathcal{I}_t]$$\n其中 $\\mathcal{I}_t$ 代表信息集 $\\{X_t, X_{t-1}, \\dots\\}$。可以假设这个信息集等价于知道截至时间 $t$ 的白噪声过程的历史，即 $\\{Z_t, Z_{t-1}, \\dots\\}$。\n\n你的任务是推导最优三步超前预测 $\\hat{X}_t(3)$ 的闭式解析表达式。", "solution": "我们被要求求出MA(2)过程 $X_t = Z_t + \\theta_1 Z_{t-1} + \\theta_2 Z_{t-2}$ 的最优三步超前预测。该预测记为 $\\hat{X}_t(3)$，定义为 $X_{t+3}$ 在给定时间 $t$ 的可用信息下的条件期望，我们将该信息集记为 $\\mathcal{I}_t = \\{Z_t, Z_{t-1}, \\dots\\}$。\n\n预测的正式表达式为：\n$$\\hat{X}_t(3) = E[X_{t+3} | \\mathcal{I}_t]$$\n首先，我们通过移动定义方程中的指数，写出过程在时间 $t+3$ 的表达式：\n$$X_{t+3} = Z_{t+3} + \\theta_1 Z_{t+2} + \\theta_2 Z_{t+1}$$\n现在，我们将其代入条件期望中：\n$$\\hat{X}_t(3) = E[Z_{t+3} + \\theta_1 Z_{t+2} + \\theta_2 Z_{t+1} | \\mathcal{I}_t]$$\n利用期望的线性性质，我们可以将条件期望分配到各项中。由于参数 $\\theta_1$ 和 $\\theta_2$ 是常数，它们可以从期望中提出：\n$$\\hat{X}_t(3) = E[Z_{t+3} | \\mathcal{I}_t] + \\theta_1 E[Z_{t+2} | \\mathcal{I}_t] + \\theta_2 E[Z_{t+1} | \\mathcal{I}_t]$$\n为了计算这些项，我们使用关于白噪声过程 $\\{Z_t\\}$ 的条件期望的性质。信息集 $\\mathcal{I}_t$ 包含了截至时间 $t$ (包含 $t$) 的所有白噪声项。\n\n关键的原则是如何处理白噪声项 $Z_s$ 在给定时间 $t$ 信息下的期望：\n1.  如果 $s > t$，则 $Z_s$ 是一个未来值。其值在时间 $t$ 是未知的。因为 $\\{Z_t\\}$ 是一个零均值白噪声过程，且未来值与过去值不相关，所以对 $Z_s$ 的最佳预测是其无条件均值。因此，对于所有 $s > t$，有 $E[Z_s | \\mathcal{I}_t] = E[Z_s] = 0$。\n2.  如果 $s \\le t$，则 $Z_s$ 是一个过去或现在的值。其值包含在信息集 $\\mathcal{I}_t$ 中，因此在时间 $t$ 是已知的。一个已知值在基于该知识的条件下的期望就是该值本身。因此，对于所有 $s \\le t$，有 $E[Z_s | \\mathcal{I}_t] = Z_s$。\n\n现在我们将这些规则应用于我们预测方程中的每一项。\n第一项是 $E[Z_{t+3} | \\mathcal{I}_t]$。由于时间指数 $t+3$ 大于 $t$，这是对未来噪声项的条件期望。根据我们的第一条规则，该项计算结果为零：\n$$E[Z_{t+3} | \\mathcal{I}_t] = 0$$\n第二项是 $E[Z_{t+2} | \\mathcal{I}_t]$。时间指数 $t+2$ 也大于 $t$，因此该项也为零：\n$$E[Z_{t+2} | \\mathcal{I}_t] = 0$$\n第三项是 $E[Z_{t+1} | \\mathcal{I}_t]$。时间指数 $t+1$ 大于 $t$，因此该项也为零：\n$$E[Z_{t+1} | \\mathcal{I}_t] = 0$$\n将这些结果代回预测方程中：\n$$\\hat{X}_t(3) = 0 + \\theta_1(0) + \\theta_2(0)$$\n简化后得到：\n$$\\hat{X}_t(3) = 0$$\n这个结果展示了MA(q)过程的一个基本性质：对于任何大于阶数 $q$ 的预测期，其预测值为零（即过程的均值）。对于这个MA(2)过程，三步超前预测为零，因为该过程对超过2个时间步之前发生的冲击没有“记忆”。", "answer": "$$\\boxed{0}$$", "id": "1312088"}, {"introduction": "分析师们常常对数据进行平滑处理以降低噪声、凸显趋势，但这一操作可能带来意想不到的后果。这个重要的练习将揭示所谓的“斯卢茨基-尤尔效应”(Slutsky-Yule effect)，展示了对纯粹的随机白噪声序列应用简单的移动平均，便足以在数据中人为地制造出自相关性。这是一个关于区分真实信号与数据处理假象的关键一课。[@problem_id:1925233]", "problem": "一位分析师正在研究一个每日资产回报的时间序列 $\\{X_t\\}$，他们将其建模为一个白噪声过程。这意味着，对于任意整数时间索引 $t$，回报的期望值为 $E[X_t] = 0$，方差为 $Var(X_t) = \\sigma^2$ (对于某个常数 $\\sigma^2 > 0$)，并且不同日期的回报是不相关的，即对于 $t \\neq s$ 有 $Cov(X_t, X_s) = 0$。\n\n为了减少明显的日常波动性，该分析师通过应用一个简单的两期移动平均，创建了一个新的平滑时间序列 $\\{S_t\\}$，定义如下：\n$$S_t = \\frac{1}{2}(X_t + X_{t-1})$$\n虽然这种平滑处理旨在使潜在模式更加明显，但它也可能在新的序列中引入原始数据中不存在的统计相关性。您的任务是量化这种效应。\n\n计算平滑序列 $\\{S_t\\}$ 在滞后1阶时的理论自相关。", "solution": "目标是计算时间序列 $\\{S_t\\}$ 在滞后1阶时的自相关，记为 $\\rho_S(1)$。对于一个平稳过程，其在滞后 $k$ 阶的自相关函数定义为其在滞后 $k$ 阶的自协方差与方差之比。\n$$ \\rho_S(k) = \\frac{\\gamma_S(k)}{\\gamma_S(0)} $$\n其中 $\\gamma_S(k) = Cov(S_t, S_{t-k})$ 是 $\\{S_t\\}$ 的自协方差函数，而 $\\gamma_S(0) = Var(S_t)$ 是 $\\{S_t\\}$ 的方差。我们需要计算 $\\gamma_S(0)$ 和 $\\gamma_S(1)$。\n\n首先，我们来确定原始白噪声过程 $\\{X_t\\}$ 的性质。我们已知：\n1.  对所有 $t$，都有 $E[X_t] = 0$。\n2.  对所有 $t$，都有 $Var(X_t) = E[X_t^2] - (E[X_t])^2 = E[X_t^2] = \\sigma^2$。\n3.  对 $t \\neq s$，有 $Cov(X_t, X_s) = E[X_t X_s] - E[X_t]E[X_s] = E[X_t X_s] = 0$。\n\n平滑序列定义为 $S_t = \\frac{1}{2}(X_t + X_{t-1})$。我们首先检查 $\\{S_t\\}$ 是否为一个零均值过程。\n$$ E[S_t] = E\\left[\\frac{1}{2}(X_t + X_{t-1})\\right] = \\frac{1}{2}(E[X_t] + E[X_{t-1}]) = \\frac{1}{2}(0 + 0) = 0 $$\n由于均值为零且不随时间变化，并且 $S_t$ 的结构是时不变的，我们可以继续计算其方差和自协方差。\n\n接下来，我们计算 $S_t$ 的方差，也就是滞后0阶的自协方差 $\\gamma_S(0)$。\n$$ \\gamma_S(0) = Var(S_t) = Var\\left(\\frac{1}{2}(X_t + X_{t-1})\\right) $$\n使用性质 $Var(aY) = a^2 Var(Y)$，我们得到：\n$$ \\gamma_S(0) = \\left(\\frac{1}{2}\\right)^2 Var(X_t + X_{t-1}) = \\frac{1}{4} Var(X_t + X_{t-1}) $$\n由于 $X_t$ 和 $X_{t-1}$ 是不相关的（因为它们是来自不同时间步的白噪声过程），它们和的方差等于它们方差的和：\n$$ Var(X_t + X_{t-1}) = Var(X_t) + Var(X_{t-1}) = \\sigma^2 + \\sigma^2 = 2\\sigma^2 $$\n将此结果代回，我们求得 $S_t$ 的方差：\n$$ \\gamma_S(0) = \\frac{1}{4}(2\\sigma^2) = \\frac{\\sigma^2}{2} $$\n\n现在，我们计算 $S_t$ 在滞后1阶的自协方差 $\\gamma_S(1)$。\n$$ \\gamma_S(1) = Cov(S_t, S_{t-1}) $$\n由于 $E[S_t]=0$，协方差就是其乘积的期望值：\n$$ \\gamma_S(1) = E[S_t S_{t-1}] = E\\left[ \\left(\\frac{1}{2}(X_t + X_{t-1})\\right) \\left(\\frac{1}{2}(X_{t-1} + X_{t-2})\\right) \\right] $$\n$$ \\gamma_S(1) = \\frac{1}{4} E[(X_t + X_{t-1})(X_{t-1} + X_{t-2})] $$\n我们展开期望内的乘积：\n$$ \\gamma_S(1) = \\frac{1}{4} E[X_t X_{t-1} + X_t X_{t-2} + X_{t-1}^2 + X_{t-1}X_{t-2}] $$\n利用期望算子的线性性质：\n$$ \\gamma_S(1) = \\frac{1}{4} (E[X_t X_{t-1}] + E[X_t X_{t-2}] + E[X_{t-1}^2] + E[X_{t-1}X_{t-2}]) $$\n现在我们使用白噪声过程 $\\{X_t\\}$ 的性质：\n-   $E[X_t X_{t-1}] = Cov(X_t, X_{t-1}) = 0$ (因为 $t \\neq t-1$)\n-   $E[X_t X_{t-2}] = Cov(X_t, X_{t-2}) = 0$ (因为 $t \\neq t-2$)\n-   $E[X_{t-1}^2] = Var(X_{t-1}) = \\sigma^2$\n-   $E[X_{t-1}X_{t-2}] = Cov(X_{t-1}, X_{t-2}) = 0$ (因为 $t-1 \\neq t-2$)\n\n将这些值代入 $\\gamma_S(1)$ 的表达式中：\n$$ \\gamma_S(1) = \\frac{1}{4} (0 + 0 + \\sigma^2 + 0) = \\frac{\\sigma^2}{4} $$\n\n最后，我们可以通过计算滞后1阶的自协方差与方差之比来得到滞后1阶的自相关 $\\rho_S(1)$。\n$$ \\rho_S(1) = \\frac{\\gamma_S(1)}{\\gamma_S(0)} = \\frac{\\frac{\\sigma^2}{4}}{\\frac{\\sigma^2}{2}} $$\n$$ \\rho_S(1) = \\frac{\\sigma^2}{4} \\cdot \\frac{2}{\\sigma^2} = \\frac{2}{4} = \\frac{1}{2} $$\n参数 $\\sigma^2$ 被约去，从而得到滞后1阶自相关的一个常数值。这表明平滑操作确实在新序列 $\\{S_t\\}$ 的连续项之间引入了正相关。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1925233"}]}