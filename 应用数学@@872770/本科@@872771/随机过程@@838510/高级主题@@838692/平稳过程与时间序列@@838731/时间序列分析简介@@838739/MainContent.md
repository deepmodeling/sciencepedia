## 引言
从追踪每日股价波动到监测[气候变化](@entry_id:138893)，按时间顺序展开的数据无处不在。[时间序列分析](@entry_id:178930)为我们提供了一套强大的统计工具，用以揭示这些序列数据中隐藏的结构、模式与内在关联，从而帮助我们理解过去并预测未来。然而，原始的[时间序列数据](@entry_id:262935)往往充满噪声且看似随机，如何从中提取有价值的洞见，是一个巨大的挑战。本文旨在为读者提供一个穿越这种复杂性的综合指南。在第一章“原理与机制”中，我们将奠定理论基础，深入剖析“[平稳性](@entry_id:143776)”等核心概念，并探索时间序列建[模的基](@entry_id:156416)石——自回归（AR）与[移动平均](@entry_id:203766)（MA）模型。接着，在“应用与跨学科联系”一章，我们将见证这些理论的实际威力，领略它们在金融、工程、生态学等不同领域中的具体应用。最后，“动手实践”部分将提供实际问题，帮助您巩固所学知识。现在，让我们一同开启对[时间序列分析](@entry_id:178930)这个迷人世界的探索之旅。

## 原理与机制

在上一章中，我们对[时间序列分析](@entry_id:178930)进行了初步介绍。现在，我们将深入探讨其核心原理与基本机制。理解这些基础概念，特别是**[平稳性](@entry_id:143776) (stationarity)**，是构建和解释更复杂时间序列模型的基石。本章将系统性地阐述平稳性的定义与含义，并详细介绍两类最基础的时间序列模型：**移动平均 (Moving Average, MA)** 模型和**自回归 (Autoregressive, AR)** 模型。

### [平稳性](@entry_id:143776)：[时间序列分析](@entry_id:178930)的基石

在自然界和人类社会中，许多过程的统计特性会随时间演变。例如，一个经济体在不同发展阶段的月度GDP增长率、一个城市在一天中不同时段的交通流量，其均值和波动性都可能不是恒定的。然而，为了建立能够捕捉数据内在规律并进行有效预测的[统计模型](@entry_id:165873)，我们通常需要一个基本假设：过程的某些核心统计特性不随时间改变。这个假设就是**[平稳性](@entry_id:143776)**。

在[时间序列分析](@entry_id:178930)中，我们通常关注**[弱平稳性](@entry_id:171204) (weak stationarity)**，也称为**协[方差](@entry_id:200758)[平稳性](@entry_id:143776) (covariance stationarity)**。一个时间序列过程 $\{X_t\}$ 被定义为弱平稳的，如果它满足以下三个条件：

1.  **均值恒定**: 过程的[期望值](@entry_id:153208)不随时间 $t$ 变化。即，$E[X_t] = \mu$，其中 $\mu$ 是一个常数。
2.  **[方差](@entry_id:200758)恒定**: 过程的[方差](@entry_id:200758)不随时间 $t$ 变化。即，$\text{Var}(X_t) = \sigma^2$，其中 $\sigma^2$ 是一个有限的正常数。
3.  **[自协方差](@entry_id:270483)仅依赖于时间间隔**: 任意两个时间点 $t$ 和 $t+h$ 之间观测值的协[方差](@entry_id:200758)，$\text{Cov}(X_t, X_{t+h})$，仅仅依赖于时间间隔（或称**滞后 (lag)**）$h$，而与具体的时间点 $t$ 无关。

违反这三个条件中的任何一个，过程即为**非平稳 (non-stationary)**。让我们通过几个例子来理解这些条件的重要性。

#### 均值非平稳

想象一个时间序列是通过拼接两个独立的[平稳序列](@entry_id:144560)而成的，这两个序列除了均值不同之外，其他统计特性（如[方差](@entry_id:200758)）均相同。例如，一个过程 $\{X_t\}$ 的前半段（$1 \le t \le N$）来自于一个均值为 $\mu_Y$ 的[白噪声过程](@entry_id:146877)，后半段（$N+1 \le t \le 2N$）来自于一个均值为 $\mu_Z$ 的[白噪声过程](@entry_id:146877)，且 $\mu_Y \neq \mu_Z$ [@problem_id:1925251]。该过程的[期望值](@entry_id:153208)函数为：
$$
E[X_{t}] =
\begin{cases}
\mu_{Y}  \text{for } 1 \leq t \leq N, \\
\mu_{Z}  \text{for } N+1 \leq t \leq 2N.
\end{cases}
$$
由于[期望值](@entry_id:153208)在时间点 $N$ 发生了结构性断裂，它不是一个常数。因此，尽管该过程的[方差](@entry_id:200758)和[自协方差](@entry_id:270483)结构可能仍然是恒定的，但均值的时变性破坏了其平稳性。在实际应用中，趋势（无论是确定性的还是随机的）是导致均值非平稳的常见原因。

#### [方差](@entry_id:200758)非平稳

在金融市场中，资产价格的波动性（即[方差](@entry_id:200758)）常常会发生变化，尤其是在重大经济事件之后。考虑一个资产的日收益率模型 $X_t = \mu + \sigma_t Z_t$，其中 $Z_t$ 是一个标准化的随机冲击（均值为0，[方差](@entry_id:200758)为1）。假设在某个时间点 $T$ 之后，市场波动性永久性地增加了 [@problem_id:1312091]。例如，$\sigma_t$ 在 $t \le 100$ 时为 $\sigma_0$，而在 $t > 100$ 时变为 $1.5\sigma_0$。该过程的[方差](@entry_id:200758)为：
$$
\text{Var}(X_t) = \text{Var}(\mu + \sigma_t Z_t) = \sigma_t^2 \text{Var}(Z_t) = \sigma_t^2
$$
显然，$\text{Var}(X_t)$ 在时间点 $100$ 之后发生了改变，不再是常数。这种现象称为**[异方差性](@entry_id:136378) (heteroskedasticity)**，是[方差](@entry_id:200758)非平稳的一种表现。

#### [自协方差](@entry_id:270483)结构的时[变性](@entry_id:165583)

某些过程的均值和[方差](@entry_id:200758)可能是恒定的，但其内部的关联结构却随时间变化。考虑一个[随机过程](@entry_id:159502) $Y_t = A_1 \sin(\omega t)$，其中 $A_1$ 是一个均值为0、[方差](@entry_id:200758)为 $\sigma^2$ 的[随机变量](@entry_id:195330) [@problem_id:1312108]。该过程的均值为 $E[Y_t] = E[A_1] \sin(\omega t) = 0$，是恒定的。然而，其[方差](@entry_id:200758)为 $\text{Var}(Y_t) = \text{Var}(A_1 \sin(\omega t)) = \sin^2(\omega t) \text{Var}(A_1) = \sigma^2 \sin^2(\omega t)$，这明显依赖于时间 $t$。因此，该过程非平稳。更进一步，其[自协方差函数](@entry_id:262114)为 $\text{Cov}(Y_{t_1}, Y_{t_2}) = \sigma^2 \sin(\omega t_1) \sin(\omega t_2)$，这不仅依赖于滞后 $t_2-t_1$，还依赖于具体的时间点 $t_1$ 和 $t_2$。

有趣的是，对上述模型进行微小的修改，就可以产生一个[平稳过程](@entry_id:196130)。考虑 $X_t = A \sin(\omega t + \Phi)$，其中 $A$ 和 $\omega$ 是常数，而相位 $\Phi$ 是一个在 $[0, 2\pi]$ 上[均匀分布](@entry_id:194597)的[随机变量](@entry_id:195330) [@problem_id:1312108]。通过对随机相位 $\Phi$ 进行积分，可以证明该过程的均值为0，且其[自协方差函数](@entry_id:262114)为 $\text{Cov}(X_{t_1}, X_{t_2}) = \frac{A^2}{2} \cos(\omega(t_2 - t_1))$。这个结果只依赖于时间间隔 $h = t_2 - t_1$，因此该过程是弱平稳的。这个例子揭示了一个深刻的观点：随机性有时是产生统计规律性（即平稳性）的根源。

### 基本时间序列模型

[平稳性假设](@entry_id:272270)为我们使用一类强大的线性时间序列模型铺平了道路。这些模型都基于一个共同的基本构件：**白噪声 (white noise)**。

一个时间序列 $\{W_t\}$ 被称为[白噪声过程](@entry_id:146877)，如果它是一个零均值、同[方差](@entry_id:200758)、序列不相关的[随机变量](@entry_id:195330)序列。即：
1.  $E[W_t] = 0$ 对所有 $t$ 成立。
2.  $\text{Var}(W_t) = \sigma_W^2$ 对所有 $t$ 成立。
3.  $\text{Cov}(W_t, W_s) = 0$ 对所有 $t \neq s$ 成立。

[白噪声过程](@entry_id:146877)本身是一个最简单的[平稳过程](@entry_id:196130)，它代表了纯粹的、不可预测的随机冲击。更复杂的模型则通过对白噪声进行[线性组合](@entry_id:154743)或引入[反馈机制](@entry_id:269921)来构建。

#### [移动平均](@entry_id:203766) (MA) 模型

[移动平均模型](@entry_id:136461)将当前观测值 $X_t$ 描述为当前和过去若干期[白噪声](@entry_id:145248)项的加权平均。一个 **$q$ 阶[移动平均模型](@entry_id:136461)**，记作 **MA(q)**，其定义为：
$$
X_t = \mu + W_t + \theta_1 W_{t-1} + \dots + \theta_q W_{t-q}
$$
其中 $\mu$ 是过程的均值（通常为分析方便设为0），$W_t$ 是[白噪声](@entry_id:145248)，$\theta_1, \dots, \theta_q$ 是模型参数。

[MA模型](@entry_id:191881)的一个极其重要的特性是，**任何有限阶的[MA(q)过程](@entry_id:144037)总是弱平稳的**，无论其参数 $\theta_j$ 的取值如何。我们可以通过计算其均值、[方差](@entry_id:200758)和[自协方差](@entry_id:270483)来验证这一点 [@problem_id:1312119]。

-   **均值**: $E[X_t] = E[\mu + \sum_{j=0}^q \theta_j W_{t-j}] = \mu + \sum_{j=0}^q \theta_j E[W_{t-j}] = \mu$（其中 $\theta_0=1$）。均值是常数。
-   **[方差](@entry_id:200758)**: $\text{Var}(X_t) = \text{Var}(\sum_{j=0}^q \theta_j W_{t-j}) = \sum_{j=0}^q \theta_j^2 \text{Var}(W_{t-j}) = \sigma_W^2 \sum_{j=0}^q \theta_j^2$。由于[白噪声](@entry_id:145248)项在不同时间点不相关，[方差](@entry_id:200758)也是常数。
-   **[自协方差](@entry_id:270483)**: $\gamma(h) = \text{Cov}(X_t, X_{t-h})$。对于 $|h| > q$，$X_t$ 和 $X_{t-h}$ 的表达式中没有共同的[白噪声](@entry_id:145248)项，因此它们的协[方差](@entry_id:200758)为0。对于 $0 \le h \le q$，协[方差](@entry_id:200758)是一个不为零的常数。

这种[自协方差](@entry_id:270483)在滞后 $q$ 之后“截断”为零的特性是 MA(q) 过程的标志性特征，其**[自相关函数](@entry_id:138327) (Autocorrelation Function, ACF)** 也具有相同的**q阶截尾**特性。

##### 可逆性与模型唯一性

[MA模型](@entry_id:191881)存在一个“陷阱”：不同的[MA模型](@entry_id:191881)可能拥有完全相同的[自相关](@entry_id:138991)结构。例如，考虑两个MA(1)过程 [@problem_id:1925218]：
$$
X_t = W_t + 4 W_{t-1}
$$
$$
Y_t = V_t + 0.25 V_{t-1}
$$
假设 $W_t$ 和 $V_t$ 具有相同的[方差](@entry_id:200758)。MA(1)过程 $X_t = W_t + \theta W_{t-1}$ 的滞后1阶自[相关系数](@entry_id:147037)为 $\rho(1) = \frac{\theta}{1+\theta^2}$。对于 $X_t$，$\theta=4$，$\rho_X(1) = \frac{4}{1+16} = \frac{4}{17}$。对于 $Y_t$，$\theta=0.25$，$\rho_Y(1) = \frac{0.25}{1+0.25^2} = \frac{1/4}{17/16} = \frac{4}{17}$。两个过程的ACF完全相同！这说明仅凭ACF无法唯一确定[MA模型](@entry_id:191881)的参数。

为了解决这个问题，我们引入**[可逆性](@entry_id:143146) (invertibility)** 的概念。一个MA过程是可逆的，如果其白噪声项 $W_t$ 可以表示为当前和过去观测值 $X_t, X_{t-1}, \dots$ 的无限收敛和，即一个 AR($\infty$) 过程：
$$
W_t = \sum_{j=0}^{\infty} \pi_j X_{t-j}
$$
对于MA(q)模型，其[可逆性](@entry_id:143146)由特征多项式 $\Theta(z) = 1 + \theta_1 z + \dots + \theta_q z^q$ 的根决定。**可逆性的条件是，所有根的[绝对值](@entry_id:147688)都必须大于1**。对于MA(1)模型 $X_t = W_t + \theta W_{t-1}$，特征多项式为 $1+\theta z=0$，根为 $z = -1/\theta$。可逆性条件 $|-1/\theta| > 1$ 等价于 $|\theta|  1$ [@problem_id:1312132]。

在上面 $\theta=4$ 和 $\theta=0.25$ 的例子中，只有 $\theta=0.25$ 的模型是可逆的。在实践中，我们总是选择可逆的[MA模型](@entry_id:191881)，这保证了模型的唯一性，并使得我们可以从观测数据中有效地估计出潜在的随机冲击。

#### [自回归 (AR) 模型](@entry_id:265459)

与[MA模型](@entry_id:191881)将 $X_t$ 表示为[白噪声](@entry_id:145248)的线性组合不同，[自回归模型](@entry_id:140558)将 $X_t$ 表示为其自身过去值和当前[白噪声](@entry_id:145248)项的线性组合。一个 **$p$ 阶[自回归模型](@entry_id:140558)**，记作 **AR(p)**，其定义为：
$$
X_t = c + \phi_1 X_{t-1} + \phi_2 X_{t-2} + \dots + \phi_p X_{t-p} + W_t
$$
其中 $c$ 是常数（与过程均值 $\mu$ 相关），$\phi_1, \dots, \phi_p$ 是自回归参数，$W_t$ 是白噪声。

与[MA模型](@entry_id:191881)不同，**AR过程不总是平稳的**。其平稳性取决于自回归参数 $\phi_j$ 的取值。

##### 因果性与[平稳性](@entry_id:143776)

对于[AR模型](@entry_id:189434)，我们更关心**因果性 (causality)**。一个AR过程是因果的，如果当前值 $X_t$ 可以表示为当前和过去白噪声项的无限收敛和，即一个 MA($\infty$) 过程：
$$
X_t = \sum_{j=0}^{\infty} \psi_j W_{t-j}
$$
这个表达形式非常重要，因为它保证了 $X_t$ 只依赖于过去和现在的冲击，而不依赖于未来的冲击，这符合物理世界的因果律。

对于[AR(1)模型](@entry_id:265801) $X_t = \phi X_{t-1} + W_t$，我们可以通过反复代换来得到其 MA($\infty$) 形式 [@problem_id:1312144]：
$$
\begin{align}
X_t  = \phi X_{t-1} + W_t \\
 = \phi (\phi X_{t-2} + W_{t-1}) + W_t = \phi^2 X_{t-2} + \phi W_{t-1} + W_t \\
 = \dots \\
 = \phi^k X_{t-k} + \sum_{j=0}^{k-1} \phi^j W_{t-j}
\end{align}
$$
为了让这个表达式收敛为一个 MA($\infty$) 过程，当 $k \to \infty$ 时，第一项 $\phi^k X_{t-k}$ 必须趋于0。这要求 $|\phi|  1$。当这个条件满足时，我们得到：
$$
X_t = \sum_{j=0}^{\infty} \phi^j W_{t-j}
$$
这表明，对于[AR(1)过程](@entry_id:746502)，**[因果性条件](@entry_id:161083)是 $|\phi|  1$**。可以证明，这个条件也恰好是[AR(1)过程](@entry_id:746502)**[平稳性](@entry_id:143776)的条件**。当 $|\phi|  1$ 时，过程的[方差](@entry_id:200758)为 $\text{Var}(X_t) = \frac{\sigma_W^2}{1-\phi^2}$，这是一个有限正常数 [@problem_id:1312092]。

这个概念可以推广到[AR(p)模型](@entry_id:635980)。其因果性（和[平稳性](@entry_id:143776)）条件由特征多项式 $\Phi(z) = 1 - \phi_1 z - \dots - \phi_p z^p$ 的根决定。**一个[AR(p)过程](@entry_id:142888)是因果（和平稳）的，当且仅当其特征多项式 $\Phi(z)=0$ 的所有根的[绝对值](@entry_id:147688)都严格大于1** [@problem_id:1925237]。注意，这个条件与[MA模型](@entry_id:191881)的[可逆性](@entry_id:143146)条件（根在单位圆外）在形式上是相似的，但应用于不同的特征多项式。

##### Yule-Walker 方程

对于一个平稳的[AR(p)过程](@entry_id:142888)，其参数 $\phi_j$ 和其自相关函数 $\rho(h)$ 之间存在一个重要的线性关系，称为**[Yule-Walker方程](@entry_id:267787)**。对于[AR(p)模型](@entry_id:635980) $X_t = \sum_{j=1}^p \phi_j X_{t-j} + W_t$，将等式两边同乘以 $X_{t-h}$（其中 $h > 0$）并取期望，得到：
$$
\gamma(h) = \sum_{j=1}^p \phi_j \gamma(h-j)
$$
两边同除以[方差](@entry_id:200758) $\gamma(0)$，得到关于自[相关系数](@entry_id:147037)的方程：
$$
\rho(h) = \sum_{j=1}^p \phi_j \rho(h-j), \quad \text{for } h=1, 2, \dots, p
$$
这是一个包含 $p$ 个未知参数 $\phi_1, \dots, \phi_p$ 的 $p$ 元[线性方程组](@entry_id:148943)。如果我们能够从数据中估计出样本自相关系数 $\hat{\rho}(1), \dots, \hat{\rho}(p)$，就可以通过解这个[方程组](@entry_id:193238)来得到[AR模型](@entry_id:189434)参数的估计值。

例如，对于一个AR(2)过程，[Yule-Walker方程](@entry_id:267787)为 [@problem_id:1312105]：
$$
\begin{cases}
\rho(1)  = \phi_1 \rho(0) + \phi_2 \rho(-1) = \phi_1 + \phi_2 \rho(1) \\
\rho(2)  = \phi_1 \rho(1) + \phi_2 \rho(0) = \phi_1 \rho(1) + \phi_2
\end{cases}
$$
如果我们已知 $\rho(1)=0.8$ 和 $\rho(2)=0.5$，就可以解出 $\phi_1 = 10/9 \approx 1.11$ 和 $\phi_2 = -7/18 \approx -0.389$。

本章我们系统地学习了[平稳性](@entry_id:143776)的概念，并深入探讨了MA和[AR模型](@entry_id:189434)的基本原理。我们看到，[MA模型](@entry_id:191881)总是平稳的，但存在可逆性问题；而[AR模型](@entry_id:189434)则需要满足[因果性条件](@entry_id:161083)才能保证平稳性。这两个看似不同的模型类别，实际上通过MA($\infty$)和AR($\infty$)表示而紧密相连，构成了[时间序列分析](@entry_id:178930)的理论基础。在接下来的章节中，我们将学习如何将这两种模型结合起来，形成更具普适性的[ARMA模型](@entry_id:139294)，并探讨如何对真实数据进行[模型识别](@entry_id:139651)、估计和诊断。