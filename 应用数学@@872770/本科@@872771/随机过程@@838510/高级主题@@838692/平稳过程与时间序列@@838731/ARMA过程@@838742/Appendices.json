{"hands_on_practices": [{"introduction": "在时间序列分析中，一项核心任务是根据观测数据识别出合适的模型。对于自回归（AR）模型，尤其是最简单的一阶自回归 AR(1) 模型，其参数与数据的自相关性之间存在直接而优美的关系。通过这个练习 [@problem_id:1283011]，你将亲手推导并理解模型参数 $\\phi$ 如何直接由滞后一阶的自相关系数 $\\rho(1)$ 决定，这是利用样本自相关函数（ACF）图来初步判断和构建AR模型的基础。", "problem": "一个时间序列被认为可以由一个平稳的1阶自回归模型，即AR(1)模型，来充分描述。该模型由以下方程给出：\n$$X_t = \\phi X_{t-1} + Z_t$$\n其中，$X_t$ 是序列在时间 $t$ 的值，$\\phi$ 是自回归系数，$Z_t$ 是一个均值为零、方差为常数 $\\sigma_Z^2$ 的白噪声过程。为使该过程平稳，要求 $|\\phi|  1$。\n\n一位分析师在分析数据时计算了样本自相关函数。分析发现，滞后1阶的自相关（记为 $\\rho(1)$）为 0.6。基于这一条信息，这个AR(1)模型的系数 $\\phi$ 的值是多少？", "solution": "我们从平稳的AR(1)模型开始\n$$\nX_{t}=\\phi X_{t-1}+Z_{t},\n$$\n其中 $\\{Z_{t}\\}$ 是白噪声，满足 $\\mathbb{E}[Z_{t}]=0$ 和 $\\operatorname{Var}(Z_{t})=\\sigma_{Z}^{2}$，且平稳性要求 $|\\phi|1$。\n\n定义自协方差函数 $\\gamma(h)=\\operatorname{Cov}(X_{t},X_{t-h})$。将模型方程两边同乘以 $X_{t-1}$ 并取期望：\n$$\n\\mathbb{E}[X_{t}X_{t-1}]=\\phi\\,\\mathbb{E}[X_{t-1}^{2}]+\\mathbb{E}[Z_{t}X_{t-1}].\n$$\n由于 $Z_{t}$ 是白噪声且与过去的值不相关，$\\mathbb{E}[Z_{t}X_{t-1}]=0$。因此，\n$$\n\\gamma(1)=\\phi\\,\\gamma(0).\n$$\n自相关函数为 $\\rho(h)=\\gamma(h)/\\gamma(0)$，所以对于 $h=1$，\n$$\n\\rho(1)=\\frac{\\gamma(1)}{\\gamma(0)}=\\phi.\n$$\n根据 $\\rho(1)=0.6$ 的经验信息，与该模型一致的相应AR(1)系数为\n$$\n\\phi=\\rho(1)=0.6,\n$$\n这也满足平稳性条件 $|\\phi|1$。", "answer": "$$\\boxed{0.6}$$", "id": "1283011"}, {"introduction": "与AR模型不同，移动平均（MA）模型的参数有时无法仅从自相关函数中唯一确定。这个练习 [@problem_id:1283036] 提出了一个有趣的难题：两个参数不同的 MA(1) 模型却拥有完全相同的自相关结构。通过解决这个难题，你将接触到“可逆性”这一至关重要的概念。可逆性确保了MA模型表示的唯一性和稳定性，这对于获得可靠的预测至关重要，因此它是我们在实践中选择模型的关键标准。", "problem": "考虑两个不同的、零均值的一阶移动平均 (MA(1)) 过程，记为 $\\{X_t\\}$ 和 $\\{Y_t\\}$。它们对所有整数 $t$ 由以下方程定义：\n1. $X_t = Z_t + 0.5 Z_{t-1}$\n2. $Y_t = W_t + 2 W_{t-1}$\n\n这里，$\\{Z_t\\}$ 和 $\\{W_t\\}$ 是白噪声过程，每个过程都由均值为0且具有恒定正方差的独立同分布随机变量组成。\n\n在时间序列分析中，移动平均 (MA) 过程的一个关键属性是**可逆性** (invertibility)。形式为 $U_t = \\epsilon_t + \\theta \\epsilon_{t-1}$ 的 MA(1) 过程被定义为可逆的，当且仅当其参数 $\\theta$ 满足条件 $|\\theta|  1$。在实践中，可逆模型是首选，部分原因是它们可以唯一地表示为一个收敛的无限阶自回归 (AR) 过程，这对于预测至关重要。\n\n尽管过程 $X_t$ 和 $Y_t$ 由不同的参数定义，但对于所有非零滞后，它们具有相同的自相关函数 (ACF)。考虑到可逆性的实际重要性，以下哪个陈述是正确的？\n\nA. $X_t$ 是首选，因为它是可逆的。\n\nB. $Y_t$ 是首选，因为它是可逆的。\n\nC. 两者同样可取，因为它们具有相同的自相关函数。\n\nD. 两者都不是首选，因为两个模型都是不可逆的。", "solution": "将这两个 MA(1) 过程定义为通用形式 $U_{t}=\\epsilon_{t}+\\theta\\epsilon_{t-1}$，其中 $\\{\\epsilon_{t}\\}$ 是方差为 $\\sigma^{2}0$ 的白噪声。对于 MA(1) 过程，其自协方差函数为\n$$\n\\gamma(0)=(1+\\theta^{2})\\sigma^{2},\\quad \\gamma(1)=\\theta\\sigma^{2},\\quad \\gamma(h)=0\\ \\text{for}\\ |h|1,\n$$\n其自相关函数 (ACF) 为\n$$\n\\rho(1)=\\frac{\\gamma(1)}{\\gamma(0)}=\\frac{\\theta}{1+\\theta^{2}},\\quad \\rho(h)=0\\ \\text{for}\\ |h|1.\n$$\n$U_{t}=\\epsilon_{t}+\\theta\\epsilon_{t-1}$ 的可逆性成立，当且仅当 $|\\theta|1$。\n\n对于 $X_{t}=Z_{t}+0.5\\,Z_{t-1}$，我们有 $\\theta_{X}=\\frac{1}{2}$，因此 $|\\theta_{X}|=\\frac{1}{2}1$，所以 $X_{t}$ 是可逆的。\n\n对于 $Y_{t}=W_{t}+2\\,W_{t-1}$，我们有 $\\theta_{Y}=2$，因此 $|\\theta_{Y}|=21$，所以 $Y_{t}$ 是不可逆的。\n\n为了比较 ACF，请注意对于 MA(1) 过程，滞后为1的 ACF 是 $\\rho(1)=\\frac{\\theta}{1+\\theta^{2}}$，它在变换 $\\theta\\mapsto\\frac{1}{\\theta}$ 下是不变的：\n$$\n\\frac{1/\\theta}{1+1/\\theta^{2}}=\\frac{1}{\\theta}\\cdot\\frac{\\theta^{2}}{1+\\theta^{2}}=\\frac{\\theta}{1+\\theta^{2}}.\n$$\n由于 $\\theta_{Y}=2=\\frac{1}{\\theta_{X}}$，两个过程在所有非零滞后上都具有相同的 ACF（并且在两种情况下，对于 $|h|1$ 都有 $\\rho(h)=0$）。因此，就 ACF 而言，它们在观测上是等价的，但只有 $X_{t}$ 是可逆的。因为可逆性对于模型的唯一性和预测是首选的，所以 $X_{t}$ 是首选模型。", "answer": "$$\\boxed{A}$$", "id": "1283036"}, {"introduction": "尽管自回归（AR）和移动平均（MA）模型看似不同，但它们之间存在深刻的联系。任何平稳的AR过程都可以被等价地表示为一个无限阶的MA过程（MA($\\infty$)），这一理论对于理解模型结构和进行预测至关重要。这个练习 [@problem_id:1283037] 将引导你具体计算一个AR(2)模型其对应的MA($\\infty$)表示的前几个系数（$\\psi$ 权重），从而将抽象的理论概念转化为具体的计算实践。", "problem": "考虑一个由以下方程定义的平稳二阶自回归 (AR) 过程，记作 AR(2)：\n$$X_t = \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + Z_t$$\n其中 $X_t$ 是时间序列在时间点 $t$ 的值，$Z_t$ 是一个均值为零且方差恒定的白噪声过程。对于一个特定的过程，其参数为 $\\phi_1 = 0.5$ 和 $\\phi_2 = 0.2$。\n\n这个平稳的 AR(2) 过程可以表示为一个无限阶移动平均 (MA) 过程，记作 MA($\\infty$)，其形式为：\n$$X_t = \\sum_{j=0}^{\\infty} \\psi_j Z_{t-j}$$\n其中系数 $\\psi_j$ 为常数，并约定 $\\psi_0 = 1$。\n\n确定系数 $\\psi_1$ 和 $\\psi_2$ 的精确值。", "solution": "一个 AR(2) 过程 $X_t = \\phi_1 X_{t-1} + \\phi_2 X_{t-2} + Z_t$ 具有一个 MA($\\infty$) 表示 $X_t = \\sum_{j=0}^{\\infty} \\psi_j Z_{t-j}$，其中 $\\psi_0 = 1$，且系数满足由算子恒等式 $(1 - \\phi_1 B - \\phi_2 B^{2}) \\sum_{j=0}^{\\infty} \\psi_j B^{j} = 1$ 推导出的递归关系。对于 $j \\geq 1$，令系数相等可得，\n$$\n\\psi_j = \\phi_1 \\psi_{j-1} + \\phi_2 \\psi_{j-2},\n$$\n边界条件为 $\\psi_0 = 1$ 和 $\\psi_{-1} = 0$。\n\n当 $\\phi_1 = \\frac{1}{2}$ 且 $\\phi_2 = \\frac{1}{5}$ 时：\n- 当 $j=1$ 时，\n$$\n\\psi_1 = \\phi_1 \\psi_0 + \\phi_2 \\psi_{-1} = \\frac{1}{2}\\cdot 1 + \\frac{1}{5}\\cdot 0 = \\frac{1}{2}.\n$$\n- 当 $j=2$ 时，\n$$\n\\psi_2 = \\phi_1 \\psi_1 + \\phi_2 \\psi_0 = \\frac{1}{2}\\cdot \\frac{1}{2} + \\frac{1}{5}\\cdot 1 = \\frac{1}{4} + \\frac{1}{5} = \\frac{9}{20}.\n$$\n\n因此，$\\psi_1 = \\frac{1}{2}$ 且 $\\psi_2 = \\frac{9}{20}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2}  \\frac{9}{20}\\end{pmatrix}}$$", "id": "1283037"}]}