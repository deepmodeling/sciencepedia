## 引言
在排队论的研究中，M/M/1模型因其数学上的简便性而成为基础，但其“到达间隔服从指数分布”的假设在许多现实场景中并不成立。从定时发送数据的卫星网络到按预约就诊的医疗系统，到达事件往往比纯粹的泊松过程更有规律或更具变异性。这就引出了一个核心问题：当服务时间保持无记忆性（[指数分布](@entry_id:273894)），但[到达过程](@entry_id:263434)更为普适时，我们该如何对系统进行建模和性能评估？G/M/1[排队模型](@entry_id:275297)正是为解决这一挑战而生的强大工具。

本文将系统地引导您深入G/M/1模型的世界，填补从理想化的M/M/1模型到复杂现实系统之间的知识鸿沟。您将通过三个层层递进的章节，全面掌握该模型：
*   在**“原则与机理”**一章中，我们将建立G/M/1模型，引入其分析的基石——嵌入式[马尔可夫链](@entry_id:150828)，并聚焦于求解核心参数 $\sigma$ 及其在刻画系统[稳态](@entry_id:182458)行为中的关键作用。
*   **“应用与跨学科联系”**一章将展示该模型如何在交通、通信和计算机科学等领域解决实际问题，并探讨其在反馈、[批量到达](@entry_id:262028)等复杂场景下的扩展。
*   最后的**“动手实践”**部分将提供具体的计算和推导练习，帮助您将理论知识转化为解决问题的实践能力。

通过本次学习，您将不仅理解G/M/1模型的数学精髓，更能运用它来分析和优化您在各自领域中遇到的各类随机服务系统。

## 原则与机理

在对[排队系统](@entry_id:273952)进行[数学建模](@entry_id:262517)时，我们经常从具有[马尔可夫性质](@entry_id:139474)的模型（如 M/M/1 模型）开始，因为它们的分析最为直接。然而，在许多现实世界的场景中，[到达过程](@entry_id:263434)并不遵循泊松过程所特有的[无记忆性](@entry_id:201790)。例如，预定的约会、协调的制造流程，或数据包在网络中经历确定性延迟，这些都导致了非[指数分布](@entry_id:273894)的[到达间隔时间](@entry_id:271977)。为了分析这类系统，我们引入 G/M/1 [排队模型](@entry_id:275297)。

### G/M/1 [排队模型](@entry_id:275297)的定义

G/M/1 模型是肯德尔表示法（Kendall's notation）A/B/k 中的一个特定类别，其定义如下：

*   **A = G (General/广义)**：相继到达顾客的**间隔时间**是独立同分布 (i.i.d.) 的[随机变量](@entry_id:195330)，但它们可以服从**任意**[概率分布](@entry_id:146404)。这与 M/M/1 和 M/G/1 模型形成对比，后者要求[到达间隔时间](@entry_id:271977)必须是[指数分布](@entry_id:273894)的（即泊松[到达过程](@entry_id:263434)）。
*   **B = M (Markovian/马尔可夫)**：**服务时间**是[独立同分布](@entry_id:169067)的，且服从**[指数分布](@entry_id:273894)**。指数分布的[无记忆性](@entry_id:201790)是此模型分析的关键。
*   **k = 1**：系统中只有**一个服务台**。

一个典型的例子是银行的自动柜员机 (ATM)。如果数据显示，顾客到达的时间间隔依赖于自上一位顾客到达后经过了多长时间（即不具有[无记忆性](@entry_id:201790)），而每位顾客的交易时间却表现出无记忆性，那么这个系统就可以被精确地建模为一个 G/M/1 队列 [@problem_id:1338310]。

与所有[排队系统](@entry_id:273952)一样，一个关键的宏观参数是**[话务强度](@entry_id:263481) (traffic intensity)**，用 $\rho$ 表示。它定义为平均到达率 $\lambda$ 与平均服务率 $\mu$ 的比值：
$$
\rho = \frac{\lambda}{\mu}
$$
其中，$\lambda = 1 / E[A]$，$E[A]$ 是平均[到达间隔时间](@entry_id:271977)；$\mu = 1 / E[S]$，$E[S]$ 是平均服务时间。因此，$\rho$ 也可以表示为平均服务时间与平均[到达间隔时间](@entry_id:271977)之比：
$$
\rho = \frac{E[S]}{E[A]}
$$
对于任何单服务台系统，$\rho$ 代表了服务台在长期运行中处于繁忙状态的时间比例，即**服务台利用率 (server utilization)**。例如，一个处理数据包的节点，其平均到达间隔为 15.0 毫秒，平均[处理时间](@entry_id:196496)为 12.0 毫秒，那么它的长期繁忙时间比例就是 $\rho = 12.0 / 15.0 = 0.8$ [@problem_id:1338308]。一个[排队系统](@entry_id:273952)要达到**[稳态](@entry_id:182458) (steady state)**，即队列不会无限增长，其必要条件是 $\rho  1$。

### 嵌入式马尔可夫链与关键参数 $\sigma$

G/M/1 模型的核心分析挑战在于，由于[到达间隔时间](@entry_id:271977)是广义的，系统状态（队列中的顾客数）本身并不构成一个[连续时间马尔可夫链](@entry_id:276307)。然而，我们可以通过一种巧妙的方法来恢复其马尔可夫性：我们不在任意时刻观察系统，而是在特定的**到达时刻**进行观察。

我们定义一个[离散时间随机过程](@entry_id:136881)，其状态是每个新顾客到达时在系统中看到的顾客数量。由于服务时间是[指数分布](@entry_id:273894)的，因此在下一个顾客到达之前，系统状态的演变只取决于当前[状态和](@entry_id:193625)服务率 $\mu$，而与过去无关。这使得在到达时刻观察到的系统状态构成了一个**嵌入式[马尔可夫链](@entry_id:150828) (embedded Markov chain)**。

对于一个[稳态](@entry_id:182458)的 G/M/1 系统，这个嵌入式[马尔可夫链](@entry_id:150828)存在一个平稳分布。一个惊人且优美的结果是，一个新到达的顾客发现系统中已有 $n$ 个顾客的概率 $\pi_n$ 服从一个**[几何分布](@entry_id:154371)**：
$$
\pi_n = (1-\sigma)\sigma^n, \quad n = 0, 1, 2, \dots
$$
这里的 $\pi_n$ 被称为**到达[稳态概率](@entry_id:276958) (arrival-stationary probability)**。

参数 $\sigma$ 是 G/M/1 理论的核心。从上述[分布](@entry_id:182848)中我们可以直接看出它的物理意义。一个到达的顾客发现服务台繁忙的概率（即系统中至少有一个顾客）是：
$$
P(\text{到达时系统繁忙}) = \sum_{n=1}^{\infty} \pi_n = \sum_{n=1}^{\infty} (1-\sigma)\sigma^n = (1-\sigma)\frac{\sigma}{1-\sigma} = \sigma
$$
相应地，一个到达的顾客发现服务台空闲的概率是 $P(\text{到达时系统空闲}) = \pi_0 = 1 - \sigma$。因此，$\sigma$ 正是**一个到达的顾客必须等待的概率**。

这个[几何分布](@entry_id:154371)的性质非常强大。例如，一个到达的顾客发现服务台繁忙 (事件 E1) 且队列中至少还有另一个顾客在等待 (事件 E2) 的概率，可以很容易地计算出来。事件 E1 对应于到达时发现 $N \ge 1$ 个顾客，其概率为 $\sigma$。事件 E2 对应于到达时发现 $N \ge 2$ 个顾客，其概率为 $\sum_{n=2}^{\infty} (1-\sigma)\sigma^n = \sigma^2$。因此，这两个事件的概率之比为 $\sigma^2 / \sigma = \sigma$ [@problem_id:1338312]。

### $\sigma$ 的[特征方程](@entry_id:265849)

既然 $\sigma$ 如此重要，我们如何计算它呢？参数 $\sigma$ 是一个[特征方程](@entry_id:265849)的唯一解。这个方程将[到达过程](@entry_id:263434)的特性与服务过程联系起来：
$$
\sigma = A^*(\mu(1-\sigma))
$$
在这个方程中：
*   $\mu$ 是[指数服务时间](@entry_id:262119)的服务率。
*   $A^*(s)$ 是[到达间隔时间](@entry_id:271977)[分布](@entry_id:182848)的**拉普拉斯-斯蒂尔切斯变换 (Laplace-Stieltjes Transform, LST)**，定义为 $A^*(s) = E[\exp(-sA)]$，其中 $A$ 是[到达间隔时间](@entry_id:271977)。LST 唯一地确定了一个非负[随机变量](@entry_id:195330)的[分布](@entry_id:182848)，可以看作是其[分布](@entry_id:182848)的“指纹”。

对于一个稳定的系统 ($\rho  1$)，这个方程在区间 $(0, 1)$ 内有唯一的解 $\sigma$。下面我们通过几个例子来展示如何应用这个方程。

#### 确定性到达 (D/M/1)
假设到达间隔是固定的，比如一个深空卫星每隔固定时间 $T_A$ 发送一个数据包。这种[到达过程](@entry_id:263434)被称为确定性到达 (Deterministic)。其 LST 为 $A^*(s) = \exp(-sT_A)$。[特征方程](@entry_id:265849)变为：
$$
\sigma = \exp(-\mu T_A (1-\sigma))
$$
例如，如果已知 $\mu T_A = \ln(4)$，则方程为 $\sigma = \exp(-\ln(4)(1-\sigma)) = 4^{\sigma-1}$。我们可以验证 $\sigma=0.5$ 是一个解，因为 $4^{0.5-1} = 4^{-0.5} = 1/2$。因此，一个到达的数据包发现服务器空闲的概率是 $1-\sigma = 0.5$ [@problem_id:1338322]。

#### 爱尔朗到达 (Erlang Arrivals)
[爱尔朗分布](@entry_id:264616)常用于模拟多个独立阶段之和的过程，它比[指数分布](@entry_id:273894)更具规律性。一个 $k$ 阶[爱尔朗分布](@entry_id:264616) (Erlang-k) 的 LST 是 $A^*(s) = (\frac{k\lambda}{k\lambda+s})^k$，其中 $\lambda$ 是总的平均[到达率](@entry_id:271803)。
考虑一个网络设备，其数据包到达间隔服从二阶[爱尔朗分布](@entry_id:264616) (Erlang-2)，平均到达率为 $\lambda=2$，服务率为 $\mu=5$ [@problem_id:1338357]。Erlang-2 [分布](@entry_id:182848)的 LST 为 $A^*(s) = (\frac{2\lambda}{2\lambda+s})^2$。特征方程为：
$$
\sigma = \left( \frac{2\lambda}{2\lambda + \mu(1-\sigma)} \right)^2 = \left( \frac{4}{4 + 5(1-\sigma)} \right)^2 = \left( \frac{4}{9 - 5\sigma} \right)^2
$$
通过求解这个方程，可以得到 $\sigma \approx 0.275$。这就是新到达的数据包发现处理器繁忙的概率。

#### 超指数到达 (Hyperexponential Arrivals)
[超指数分布](@entry_id:193765)用于描述一个混合过程，[到达间隔时间](@entry_id:271977)以概率 $p$ 来自一个速率为 $\lambda_1$ 的指数分布，以概率 $1-p$ 来自另一个速率为 $\lambda_2$ 的[指数分布](@entry_id:273894)。这种[到达过程](@entry_id:263434)比泊松过程具有更高的可变性。其 LST 是各个分支 LST 的加权平均：
$$
A^*(s) = p \frac{\lambda_1}{\lambda_1+s} + (1-p) \frac{\lambda_2}{\lambda_2+s}
$$
因此，在这种情况下，$\sigma$ 的[特征方程](@entry_id:265849)为 [@problem_id:1338324]：
$$
\sigma = p \frac{\lambda_1}{\lambda_1 + \mu - \mu\sigma} + (1-p) \frac{\lambda_2}{\lambda_2 + \mu - \mu\sigma}
$$

### 性能指标分析

一旦我们求解出关键参数 $\sigma$，系统的主要性能指标就可以迎刃而解。

#### 平均等待时间
在 G/M/1 队列中，一个到达的顾客如果发现系统中有 $n$ 个人，他需要等待这 $n$ 个人以及正在接受服务的人（如果有的话）完成服务。由于服务时间是指数分布的，等待时间的分析变得可行。一个顾客的**平均排队等待时间 (mean waiting time in queue)** $W_q$ 可以表示为：
$$
W_q = \frac{\sigma}{\mu(1-\sigma)}
$$
这个公式直观地展示了等待时间如何随着 $\sigma$（等待概率）的增加而急剧增加。

#### [到达过程](@entry_id:263434)可变性的影响
G/M/1 模型的一个重要应用是研究[到达过程](@entry_id:263434)的规律性如何影响系统性能。考虑一个交易服务器，其平均服务时间为 5ms，平均到达间隔为 8ms，因此[话务强度](@entry_id:263481) $\rho = 5/8$。我们比较两种到达场景 [@problem_id:1338341]：
1.  **场景 A (Erlang-2 到达)**：到达间隔更规律。通过求解其特征方程，我们得到 $\sigma_A = \frac{7-2\sqrt{6}}{4} \approx 0.525$。
2.  **场景 B (泊松到达, M/M/1)**：这是 G/M/1 的一个特例。对于泊松到达，$A^*(s) = \frac{\lambda}{\lambda+s}$。[特征方程](@entry_id:265849)变为 $\sigma = \frac{\lambda}{\lambda+\mu(1-\sigma)}$。这个方程的解非常简单：$\sigma_B = \frac{\lambda}{\mu} = \rho = 5/8 = 0.625$。

现在我们可以比较两种场景下的平均等待时间。它们的比值为：
$$
\frac{W_{q,A}}{W_{q,B}} = \frac{\sigma_A/(1-\sigma_A)}{\sigma_B/(1-\sigma_B)} = \frac{\sigma_A(1-\rho)}{\rho(1-\sigma_A)} \approx 0.664
$$
结果表明，在[话务强度](@entry_id:263481)相同的情况下，更规律的 Erlang [到达过程](@entry_id:263434)导致的[平均等待时间](@entry_id:275427)，显著低于随机性更强的泊松[到达过程](@entry_id:263434)。这揭示了一个普遍原则：**减少输入过程的变异性可以显著改善[排队系统](@entry_id:273952)的性能**。

通过 G/M/1 模型，我们还可以推导出空闲概率与[话务强度](@entry_id:263481) $\rho$ 之间的显式关系。例如，对于 Erlang-2 [到达过程](@entry_id:263434)，可以证明找到服务器空闲的概率为 $1-\sigma = \frac{1-4\rho+\sqrt{1+8\rho}}{2}$ [@problem_id:1338350]。这再次强调了 $\sigma$ 和 $\rho$ 是两个不同的量，只有在 M/M/1 的特殊情况下它们才相等。

### 高级主题：[稳态概率](@entry_id:276958)与对偶性

#### 时间[稳态](@entry_id:182458)与到达[稳态](@entry_id:182458)
到目前为止，我们讨论的概率 $\pi_n$ 是一个**到达者**在到达瞬间看到的系统状态[分布](@entry_id:182848)。这被称为**到达[稳态](@entry_id:182458) (arrival-stationary)** 或 Palm 概率。另一个重要的[分布](@entry_id:182848)是在一个**随机时刻**观察系统时，系统中顾客数的[分布](@entry_id:182848)，我们称之为**时间[稳态](@entry_id:182458) (time-stationary)** 概率，记为 $p_n$。

对于泊松[到达过程](@entry_id:263434)（如 M/M/1），有一个著名的性质叫做**PASTA (Poisson Arrivals See Time Averages)**，它表明 $\pi_n = p_n$。然而，对于非泊松到达的 G/M/1 队列，PASTA 不再成立。$\pi_n$ 和 $p_n$ 通常是不同的。

通过平衡进入和离开状态 $n$ 的流率，可以建立它们之间的关系。对于一个稳定的 G/M/1 队列 [@problem_id:1338333]：
*   系统为空的概率：$p_0 = 1 - \rho$
*   对于 $n \ge 1$：$p_n = \rho \pi_{n-1}$

将 $\pi_{n-1} = (1-\sigma)\sigma^{n-1}$ 代入，我们得到：
$$
p_n = \rho (1-\sigma) \sigma^{n-1}, \quad \text{for } n \ge 1
$$
这组公式完整地描述了 G/M/1 队列在任意时刻的系统状态[分布](@entry_id:182848)。我们可以看到，$\frac{p_n}{\pi_n} = \frac{\rho}{\sigma}$ (对于 $n \ge 1$)，这清晰地量化了两种[稳态概率](@entry_id:276958)之间的差异。

#### 离去时刻的系统状态
G/M/1 模型还有一个优雅的[对偶性质](@entry_id:276134)。考虑一个顾客完成服务并离开系统时，他/她**留下**的顾客数量。一个重要的结论是，在[稳态](@entry_id:182458)下，一个离去顾客留下的顾客数[分布](@entry_id:182848)，与一个到达顾客看到的顾客数[分布](@entry_id:182848)是**完全相同**的。也就是说，离去顾客留下 $n$ 个顾客的概率也遵循参数为 $\sigma$ 的[几何分布](@entry_id:154371)：
$$
P(\text{离去时留下 } n \text{ 个顾客}) = (1-\sigma)\sigma^n, \quad n=0, 1, 2, \dots
$$
例如，在一个 Erlang-2 到达的 G/M/1 系统中，如果求解得到 $\sigma = \frac{3-\sqrt{5}}{2}$，那么一个离去的作业留下两个其他作业的概率就是 $(1-\sigma)\sigma^2 \approx 0.09017$ [@problem_id:1338348]。

这个性质揭示了 G/M/1 模型与 M/G/1 模型之间深刻的对偶性。可以证明，一个 G/M/1 队列的到达[稳态分布](@entry_id:149079)，与一个将到达和服务过程互换的 M/G/1 队列的时间稳态分布是相同的。这种对称性是[排队论](@entry_id:274141)中一个非常深刻且优美的结果。