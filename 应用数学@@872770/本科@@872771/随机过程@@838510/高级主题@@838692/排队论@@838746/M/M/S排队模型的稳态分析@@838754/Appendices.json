{"hands_on_practices": [{"introduction": "排队论的威力在于它能将现实世界中的服务场景转化为可计算的模型。第一个实践将带你分析一个常见的场景：自动化洗车场。通过这个练习 [@problem_id:1334655]，你将掌握计算M/M/s系统中关键性能指标——平均排队等待时间 ($W_q$)——的基本步骤。这是进行任何稳态分析的基石，能够帮助你量化系统效率和顾客体验。", "problem": "一家名为“SparkleDrive”的自动化洗车设施的管理层正在评估其周末高峰时段的运营效率。该设施有两个相同且并行的洗车位。在一个典型的周六，车辆独立到达，遵循泊松过程，平均到达率为每小时24辆车。单个洗车位完成一次完整洗车周期所需的时间呈指数分布，每辆车的平均服务时间为4分钟。当两个洗车位都被占用时到达的车辆会形成一个单一队列，并按先到先服务的原则进行服务。\n\n假设系统已达到稳态，计算一辆车在进入洗车位前在队列中等待的平均时间。\n\n答案以分钟为单位，保留三位有效数字。", "solution": "将该系统建模为一个遵循先到先服务原则的 $M/M/2$ 队列。到达过程为泊松过程，到达率 $\\lambda=24$ 辆/小时。每个服务台的服务时间呈指数分布，平均值为 $4$ 分钟 $=\\frac{4}{60}$ 小时，因此每个服务台的服务率为 $\\mu=\\frac{1}{4/60}=15$ 辆/小时。有 $s=2$ 个相同的服务台。\n\n系统利用率为 $\\rho=\\frac{\\lambda}{s\\mu}=\\frac{24}{2\\cdot 15}=\\frac{4}{5}  1$，因此存在稳态。定义 $a=\\frac{\\lambda}{\\mu}=\\frac{24}{15}=\\frac{8}{5}$。\n\n对于一个 $M/M/s$ 队列，系统为空的稳态概率为\n$$\nP_{0}=\\left[\\sum_{n=0}^{s-1}\\frac{a^{n}}{n!}+\\frac{a^{s}}{s!}\\cdot\\frac{1}{1-\\rho}\\right]^{-1}.\n$$\n当 $s=2$ 时，可得\n$$\n\\sum_{n=0}^{1}\\frac{a^{n}}{n!}=1+a=1+\\frac{8}{5}=\\frac{13}{5},\\quad\n\\frac{a^{2}}{2}\\cdot\\frac{1}{1-\\rho}=\\frac{\\left(\\frac{8}{5}\\right)^{2}}{2}\\cdot\\frac{1}{1-\\frac{4}{5}}=\\frac{\\frac{64}{25}}{2}\\cdot 5=\\frac{32}{25}\\cdot 5=\\frac{32}{5}.\n$$\n因此方括号内的和为 $\\frac{13}{5}+\\frac{32}{5}=\\frac{45}{5}=9$，所以 $P_{0}=\\frac{1}{9}$。\n\n爱尔朗C（延迟）概率为\n$$\nP_{\\text{wait}}=\\frac{a^{s}}{s!}\\cdot\\frac{1}{1-\\rho}\\cdot P_{0}=\\frac{\\left(\\frac{8}{5}\\right)^{2}}{2!}\\cdot \\frac{1}{1-4/5}\\cdot \\frac{1}{9}=\\frac{32}{5}\\cdot \\frac{1}{9}=\\frac{32}{45}.\n$$\n队列中的平均等待时间为\n$$\nW_{q}=P_{\\text{wait}}\\cdot \\frac{1}{s\\mu-\\lambda}.\n$$\n这里 $s\\mu-\\lambda=2\\cdot 15-24=6$ 辆/小时，所以\n$$\nW_{q}=\\frac{32}{45}\\cdot \\frac{1}{6}=\\frac{16}{135}\\ \\text{hours}.\n$$\n换算成分钟可得\n$$\nW_{q}=\\frac{16}{135}\\cdot 60=\\frac{64}{9}\\ \\text{minutes}\\approx 7.111\\ldots\\ \\text{minutes}.\n$$\n保留三位有效数字，结果为 $7.11$ 分钟。", "answer": "$$\\boxed{7.11}$$", "id": "1334655"}, {"introduction": "掌握了基本计算后，让我们将排队论应用于系统设计决策。这个练习将比较两种常见的服务配置：合并排队与独立排队。通过对一个电动汽车充电站的案例进行分析 [@problem_id:1334632]，你将推导出两种设计下平均等待时间的比值，从而从数学上揭示“资源池化”的效率优势。这个实践展示了排队论模型在优化运营和制定策略中的强大作用。", "problem": "一家公司正在设计一款新型电动汽车（EV）充电站，该充电站将配备两个相同的快速充电端口。目前正在考虑两种主要的排队配置。\n\n配置A，“共享队列”：两个充电端口共用一个队列。队首的车辆会前往第一个可用的充电端口。\n\n配置B，“专用队列”：充电站被分为两个相同且独立的子站。每个子站有一个充电端口和其自己的专用队列。到达的司机必须选择两个队列之一，并且不允许在队列之间切换。\n\n假设车辆按照泊松过程到达充电站，总到达率为 $\\lambda$。在任何一个端口为一辆车充电所需的时间服从指数分布，其速率为 $\\mu$。对于配置B，假设到达的车辆均匀地分配到两个队列中，因此每个专用队列的到达率为 $\\lambda/2$。为使系统稳定，要求 $\\lambda  2\\mu$。\n\n设 $W_{q,A}$ 为在共享队列配置中一辆车在队列中等待的平均时间，设 $W_{q,B}$ 为在专用队列配置中一辆车在队列中等待的平均时间。\n\n求比率 $\\frac{W_{q,B}}{W_{q,A}}$。将您的答案表示为关于系统总服务强度（定义为 $\\rho = \\frac{\\lambda}{2\\mu}$）的解析表达式。", "solution": "设总到达过程为泊松过程，速率为 $\\lambda$；每个服务台的服务时间服从指数分布，速率为 $\\mu$；并定义系统总服务强度 $\\rho = \\frac{\\lambda}{2\\mu}$。由于稳定性条件 $\\lambda  2\\mu$，有 $\\rho \\in (0,1)$。\n\n配置B（专用队列）由两个独立的 $M/M/1$ 队列组成，每个队列的到达率为 $\\lambda' = \\frac{\\lambda}{2}$，服务速率为 $\\mu$。每个队列的利用率是\n$$\n\\rho = \\frac{\\lambda'}{\\mu} = \\frac{\\lambda}{2\\mu}.\n$$\n对于一个 $M/M/1$ 队列，队列中的平均等待时间为\n$$\nW_{q,B} = \\frac{\\rho}{\\mu(1 - \\rho)}.\n$$\n\n配置A（共享队列）是一个 $M/M/2$ 系统，总到达率为 $\\lambda$，有两个服务台，每个服务台的服务速率为 $\\mu$。设 $c=2$ 并定义 $x = \\frac{\\lambda}{\\mu} = 2\\rho$。$M/M/c$ 系统的稳态概率 $p_{0}$ 为\n$$\np_{0} = \\left[\\sum_{n=0}^{c-1} \\frac{x^{n}}{n!} + \\frac{x^{c}}{c!}\\cdot \\frac{1}{1 - \\rho}\\right]^{-1}.\n$$\n对于 $c=2$，这变为\n$$\np_{0} = \\left[1 + x + \\frac{x^{2}}{2}\\cdot \\frac{1}{1 - \\rho}\\right]^{-1}.\n$$\n代入 $x = 2\\rho$ 得\n$$\np_{0} = \\left[1 + 2\\rho + \\frac{(2\\rho)^{2}}{2}\\cdot \\frac{1}{1 - \\rho}\\right]^{-1}\n= \\left[1 + 2\\rho + \\frac{2\\rho^{2}}{1 - \\rho}\\right]^{-1}.\n$$\n使用公分母 $1 - \\rho$ 合并各项：\n$$\n1 + 2\\rho + \\frac{2\\rho^{2}}{1 - \\rho}\n= \\frac{(1 - \\rho)(1 + 2\\rho) + 2\\rho^{2}}{1 - \\rho}\n= \\frac{1 + \\rho}{1 - \\rho},\n$$\n所以\n$$\np_{0} = \\frac{1 - \\rho}{1 + \\rho}.\n$$\n$M/M/2$ 系统的爱尔朗C（延迟）概率为\n$$\nP_{\\text{wait}} = \\frac{x^{2}}{2!}\\cdot \\frac{1}{1 - \\rho}\\, p_{0}\n= \\frac{2\\rho^{2}}{1 - \\rho}\\cdot \\frac{1 - \\rho}{1 + \\rho}\n= \\frac{2\\rho^{2}}{1 + \\rho}.\n$$\n对于 $M/M/c$ 系统，队列中的平均等待时间为\n$$\nW_{q,A} = \\frac{P_{\\text{wait}}}{c\\mu - \\lambda} = \\frac{P_{\\text{wait}}}{2\\mu - \\lambda}\n= \\frac{\\frac{2\\rho^{2}}{1 + \\rho}}{2\\mu(1 - \\rho)}\n= \\frac{\\rho^{2}}{\\mu(1 - \\rho^{2})}.\n$$\n\n现在计算该比率：\n$$\n\\frac{W_{q,B}}{W_{q,A}} = \\frac{\\frac{\\rho}{\\mu(1 - \\rho)}}{\\frac{\\rho^{2}}{\\mu(1 - \\rho^{2})}}\n= \\frac{\\rho}{1 - \\rho}\\cdot \\frac{1 - \\rho^{2}}{\\rho^{2}}\n= \\frac{\\rho}{1 - \\rho}\\cdot \\frac{(1 - \\rho)(1 + \\rho)}{\\rho^{2}}\n= \\frac{1 + \\rho}{\\rho}.\n$$\n因此，用 $\\rho = \\frac{\\lambda}{2\\mu}$ 表示，所求的比率为 $\\frac{1 + \\rho}{\\rho}$。", "answer": "$$\\boxed{\\frac{1+\\rho}{\\rho}}$$", "id": "1334632"}, {"introduction": "平均等待时间是一个有用的宏观指标，但它无法完全描述个别用户的体验。最后一个实践将我们的视角从“平均”转向“概率”，分析在视频流服务中，一个已经开始排队的用户需要等待超过特定时间的可能性 [@problem_id:1334617]。这个练习揭示了M/M/s模型中一个深刻的性质：条件等待时间遵循指数分布。理解这一点对于更精细地管理服务质量和用户期望至关重要。", "problem": "一个名为“StreamVerse”的流行视频流媒体服务使用服务器集群来管理用户请求。新的内容请求根据泊松过程到达，平均速率为每分钟45个请求。该集群由 $s = 10$ 个相同的并行服务器节点组成。当一个请求被分配到一个节点时，处理该请求并开始流式传输所需的时间呈指数分布，平均值为10秒。如果一个新请求到达时所有10个节点都处于繁忙状态，它将被放入一个先进先出队列中，等待下一个可用的节点。\n\n考虑一个用户，其请求在所有服务器节点都被占用时到达，因此被迫等待。计算该用户的请求在被分配到服务器节点之前，在队列中等待超过5秒的概率。\n\n将您的答案以保留三位有效数字的小数形式给出。", "solution": "将该系统建模为一个遵循先进先出规则的 $M/M/s$ 队列。设到达率为 $\\lambda$，每个服务器的服务率为 $\\mu$，有 $s$ 个并行服务器。给定的数据意味着：\n- 到达遵循泊松过程，速率为每分钟 $45$ 个，因此 $\\lambda = \\frac{45}{60} = \\frac{3}{4}$ 每秒。\n- 服务时间呈指数分布，平均值为 $10$ 秒，因此 $\\mu = \\frac{1}{10}$ 每秒。\n- 服务器数量为 $s = 10$。\n\n对于一个 $M/M/s$ 队列，队列中的等待时间 $W_{q}$ 服从一个混合分布：等待时间为零的概率为 $1 - C$（其中 $C$ 是爱尔朗C延迟概率），而在必须等待的条件下（即到达时所有服务器都繁忙），等待时间呈指数分布，其速率为 $s\\mu - \\lambda$。因此，\n$$\n\\mathbb{P}\\!\\left(W_{q}  t \\,\\middle|\\, \\text{wait}\\right) = \\exp\\!\\left(-(s\\mu - \\lambda)\\, t\\right).\n$$\n\n代入给定的参数：\n$$\ns\\mu - \\lambda = 10 \\cdot \\frac{1}{10} - \\frac{3}{4} = 1 - \\frac{3}{4} = \\frac{1}{4}.\n$$\n对于 $t = 5$ 秒，\n$$\n\\mathbb{P}\\!\\left(W_{q}  5 \\,\\middle|\\, \\text{wait}\\right) = \\exp\\!\\left(-\\frac{1}{4} \\cdot 5\\right) = \\exp(-1.25).\n$$\n\n数值上，$\\exp(-1.25) \\approx 0.2865048$，保留三位有效数字为 $0.287$。", "answer": "$$\\boxed{0.287}$$", "id": "1334617"}]}