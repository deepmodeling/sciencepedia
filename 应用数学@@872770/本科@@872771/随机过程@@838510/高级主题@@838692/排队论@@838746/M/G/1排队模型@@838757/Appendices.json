{"hands_on_practices": [{"introduction": "M/G/1 模型的核心洞见之一是服务时间的*变异性*对排队长度有显著影响。本练习通过一个经典对比来阐明这一原理：一个具有指数分布服务时间（高变异性）的系统与一个具有确定性服务时间（零变异性）的系统，两者的平均服务时间相同。通过计算转向更可预测的系统所带来的排队长度缩减，你将亲身体会到降低随机性对提升系统效率的巨大作用。[@problem_id:1341109]", "problem": "一所大学的 IT 部门通过一个单一的自动化服务器来管理用户支持请求。请求以平均速率每小时 $\\lambda$ 个到达，服从泊松过程。该系统目前运行的软件（系统 A）处理单个请求的时间是一个随机变量，服从均值为 $E[S]$ 的指数分布。\n\n该部门正在考虑升级到一个新软件（系统 B）。这个新软件将以一个固定的、确定性的时间处理每个请求，该时间被设计为与旧系统的平均服务时间 $E[S]$ 完全相等。请求的到达过程仍然是泊松过程，速率同样为 $\\lambda$。\n\n假设对于两个系统，服务器利用率 $\\rho = \\lambda E[S]$ 都小于 1，以确保队列是稳定的并能达到稳态。\n\n如果部门从系统 A 切换到系统 B，计算在队列中等待的请求的长期平均数量的比例减少量。比例减少量定义为 $(L_{q,A} - L_{q,B}) / L_{q,A}$，其中 $L_{q,A}$ 和 $L_{q,B}$ 分别是系统 A 和系统 B 队列中的平均请求数。请用小数表示您的答案。", "solution": "我们将两个系统都建模为 M/G/1 队列：到达率为 $\\lambda$ 的泊松到达，单个服务器，以及均值为 $E[S]$ 的通用服务时间分布。令 $\\rho=\\lambda E[S]$ 表示利用率，根据题意 $\\rho  1$。\n\n根据 M/G/1 队列的 Pollaczek–Khinchine 公式，队列中的稳态平均数量为\n$$\nL_{q}=\\lambda W_{q}=\\frac{\\lambda^{2}E[S^{2}]}{2(1-\\rho)}.\n$$\n\n对于系统 A (M/M/1)，服务时间 $S$ 服从均值为 $E[S]$ 的指数分布。因此\n$$\n\\operatorname{Var}(S)=(E[S])^{2},\\quad E[S^{2}]=\\operatorname{Var}(S)+(E[S])^{2}=2(E[S])^{2}.\n$$\n所以，\n$$\nL_{q,A}=\\frac{\\lambda^{2}\\cdot 2(E[S])^{2}}{2(1-\\rho)}=\\frac{\\lambda^{2}(E[S])^{2}}{1-\\rho}=\\frac{\\rho^{2}}{1-\\rho}.\n$$\n\n对于系统 B (M/D/1)，服务时间是确定性的，具有相同的均值 $E[S]$，所以\n$$\n\\operatorname{Var}(S)=0,\\quad E[S^{2}]=(E[S])^{2}.\n$$\n所以，\n$$\nL_{q,B}=\\frac{\\lambda^{2}(E[S])^{2}}{2(1-\\rho)}=\\frac{\\rho^{2}}{2(1-\\rho)}.\n$$\n\n比例减少量为\n$$\n\\frac{L_{q,A}-L_{q,B}}{L_{q,A}}=\\frac{\\frac{\\rho^{2}}{1-\\rho}-\\frac{\\rho^{2}}{2(1-\\rho)}}{\\frac{\\rho^{2}}{1-\\rho}}=\\frac{1-\\frac{1}{2}}{1}= \\frac{1}{2}.\n$$\n\n以小数表示，比例减少量为 $0.5$。", "answer": "$$\\boxed{0.5}$$", "id": "1341109"}, {"introduction": "在理解了服务时间变异性的基本影响后，本练习将引导你进行更深入的分析。我们再次比较两个平均服务时间相同的系统，但这次的对比更加细致：一个是零变异性的确定性系统，另一个是具有高变异性的超指数分布系统。这个练习将引入服务时间变异系数的平方 $C_S^2$ 作为一个关键指标，揭示高变异性如何急剧增加排队等待时间。[@problem_id:1341150]", "problem": "数据中心的中央处理器 (CPU) 接收计算任务，这些任务根据泊松过程到达，平均速率为 $\\lambda = 8$ 个任务/秒。CPU 一次只能处理一个任务，任务按到达顺序处理。该中心正在评估用于稳态系统的两种不同任务管理协议，即协议 A 和协议 B。\n\n在协议 A下，每个任务都是标准化的，需要一个固定的、确定性的处理时间，恰好为 $S_A = 0.1$ 秒。\n\n在协议 B下，处理时间是可变的。任务到达时，有 $p=0.4$ 的概率是“快速”任务，有 $1-p=0.6$ 的概率是“长时”任务。快速任务的处理时间是一个随机变量，服从平均值为 $T_{quick} = 0.05$ 秒的指数分布。长时任务的处理时间也是一个服从指数分布的随机变量，但其平均值为 $T_{long} = \\frac{2}{15}$ 秒。\n\n计算协议 B 的排队等待任务平均数量与协议 A 的排队等待任务平均数量之比。将最终答案四舍五入到三位有效数字。", "solution": "此问题比较了两个 M/G/1 排队系统。关键的洞察在于，平均队长不仅取决于平均服务时间，还取决于其变异性。M/G/1 队列中顾客的平均数量 $L_q$ 的 Pollaczek-Khinchine 公式由下式给出：\n$$L_q = \\frac{\\lambda^2 E[S^2]}{2(1-\\rho)}$$\n其中 $\\lambda$ 是到达率，$S$ 是服务时间随机变量，$E[S^2]$ 是服务时间的二阶矩，$\\rho = \\lambda E[S]$ 是流量强度。使用服务时间的变异系数平方 $C_S^2 = \\frac{\\text{Var}(S)}{(E[S])^2}$ 的另一种形式是：\n$$L_q = \\frac{\\rho^2(1+C_S^2)}{2(1-\\rho)}$$\n我们需要求比值 $\\frac{L_{q,B}}{L_{q,A}}$。我们来分析每个系统。\n\n首先，我们验证两个系统具有相同的流量强度 $\\rho$。两个系统的到达率都是 $\\lambda = 8$ 个任务/秒。\n\n对于协议 A（确定性服务时间）：\n服务时间是常数，$S_A = 0.1$ 秒。\n平均服务时间是 $E[S_A] = 0.1$ 秒。\n流量强度是 $\\rho_A = \\lambda E[S_A] = 8 \\times 0.1 = 0.8$。\n\n对于协议 B（超指数服务时间）：\n服务时间 $S_B$ 是两个指数分布的混合。我们可以使用全期望定律来求其均值：\n$$E[S_B] = p \\cdot T_{quick} + (1-p) \\cdot T_{long}$$\n$$E[S_B] = (0.4)(0.05) + (0.6)\\left(\\frac{2}{15}\\right) = 0.02 + \\frac{1.2}{15} = 0.02 + 0.08 = 0.1 \\text{ s}$$\n流量强度是 $\\rho_B = \\lambda E[S_B] = 8 \\times 0.1 = 0.8$。\n由于 $\\rho_A = \\rho_B = 0.8$，流量强度相同，并且因为 $\\rho  1$，两个系统都是稳定的。\n\n现在，我们可以计算平均队长的比值。使用 Pollaczek-Khinchine 公式的第二种形式：\n$$\\frac{L_{q,B}}{L_{q,A}} = \\frac{\\frac{\\rho_B^2(1+C_{S_B}^2)}{2(1-\\rho_B)}}{\\frac{\\rho_A^2(1+C_{S_A}^2)}{2(1-\\rho_A)}}$$\n由于 $\\rho_A = \\rho_B$，上式简化为：\n$$\\frac{L_{q,B}}{L_{q,A}} = \\frac{1+C_{S_B}^2}{1+C_{S_A}^2}$$\n\n我们需要为每个协议计算变异系数平方，$C_S^2 = \\frac{\\text{Var}(S)}{(E[S])^2}$。\n\n对于协议 A：\n服务时间是常数，所以其方差为零。$\\text{Var}(S_A) = 0$。\n因此，$C_{S_A}^2 = 0$。\n\n对于协议 B：\n我们需要求 $\\text{Var}(S_B) = E[S_B^2] - (E[S_B])^2$。我们已经知道 $E[S_B] = 0.1$。\n为了求二阶矩 $E[S_B^2]$，我们再次使用全期望定律。对于一个均值为 $T$ 的指数随机变量 $X$，其二阶矩是 $E[X^2] = 2T^2$。\n设 $X_{quick}$ 为快速任务的服务时间，$X_{long}$ 为长时任务的服务时间。\n$E[X_{quick}^2] = 2(T_{quick})^2 = 2(0.05)^2 = 2(0.0025) = 0.005$。\n$E[X_{long}^2] = 2(T_{long})^2 = 2\\left(\\frac{2}{15}\\right)^2 = 2\\left(\\frac{4}{225}\\right) = \\frac{8}{225}$。\n现在，我们求 $E[S_B^2]$：\n$$E[S_B^2] = p \\cdot E[X_{quick}^2] + (1-p) \\cdot E[X_{long}^2]$$\n$$E[S_B^2] = (0.4)(0.005) + (0.6)\\left(\\frac{8}{225}\\right) = 0.002 + \\frac{4.8}{225} = \\frac{2}{1000} + \\frac{48}{2250}$$\n$$E[S_B^2] = \\frac{1}{500} + \\frac{16}{750} = \\frac{3}{1500} + \\frac{32}{1500} = \\frac{35}{1500} = \\frac{7}{300}$$\n现在，我们可以计算协议 B 的服务时间的方差：\n$$\\text{Var}(S_B) = E[S_B^2] - (E[S_B])^2 = \\frac{7}{300} - (0.1)^2 = \\frac{7}{300} - \\left(\\frac{1}{10}\\right)^2 = \\frac{7}{300} - \\frac{1}{100} = \\frac{7}{300} - \\frac{3}{300} = \\frac{4}{300} = \\frac{1}{75}$$\n协议 B 的变异系数平方为：\n$$C_{S_B}^2 = \\frac{\\text{Var}(S_B)}{(E[S_B])^2} = \\frac{1/75}{(0.1)^2} = \\frac{1/75}{1/100} = \\frac{100}{75} = \\frac{4}{3}$$\n\n最后，我们计算平均队长的比值：\n$$\\frac{L_{q,B}}{L_{q,A}} = \\frac{1+C_{S_B}^2}{1+C_{S_A}^2} = \\frac{1 + \\frac{4}{3}}{1 + 0} = \\frac{7}{3}$$\n作为小数，这大约是 $2.3333...$。\n四舍五入到三位有效数字，该比值为 $2.33$。", "answer": "$$\\boxed{2.33}$$", "id": "1341150"}, {"introduction": "掌握了如何评估不同服务分布的影响后，让我们转向一个更具动态性的实际问题。本练习模拟了一个常见的系统升级场景：当需求（到达率）增加时，我们提升处理能力（服务速率）来应对。通过分析这种变化对平均等待时间的影响，你将发现系统性能的改善并非线性，而是与初始系统负载率 $\\rho$ 密切相关，这对于现实世界中的容量规划至关重要。[@problem_id:1341170]", "problem": "一个网络路由器被建模为单服务器排队系统。最初，数据包根据泊松过程到达，平均速率为 $\\lambda$。路由器逐一处理数据包，处理一个数据包所需的时间是一个服从一般分布的随机变量。设初始平均服务时间为 $E[S]$，服务时间的变异系数平方为 $C_S^2$。系统处于稳定状态，这意味着初始流量强度（定义为 $\\rho = \\lambda E[S]$）小于 1。\n\n由于网络需求的增加，数据包的到达率增加了一倍。为了应对这种情况，路由器进行了升级，其处理速度（服务率）提高了 50%。假设服务时间的变异系数平方 $C_S^2$ 是数据包大小分布的固有特性，因此在升级后保持不变。已知新配置的系统也是稳定的。\n\n确定新的队列中平均等待时间 $W_{q, \\text{new}}$ 与原始队列中平均等待时间 $W_{q, \\text{old}}$ 的比率。将您的答案表示为初始流量强度 $\\rho$ 的函数。", "solution": "我们将系统在变化前后都建模为 $M/G/1$ 排队。对于 $M/G/1$ 排队，Pollaczek–Khinchine 公式给出了队列中的平均等待时间：\n$$\nW_{q}=\\frac{\\lambda E[S^{2}]}{2\\left(1-\\rho\\right)}, \\quad \\rho=\\lambda E[S].\n$$\n最初，\n$$\nW_{q,\\text{old}}=\\frac{\\lambda E[S^{2}]}{2\\left(1-\\rho\\right)}.\n$$\n当到达率增加一倍时，$\\lambda_{\\text{new}}=2\\lambda$。服务速度提高 50% 意味着所有服务时间都按一个常数因子 $c=\\frac{2}{3}$ 缩放，因此\n$$\nE[S]_{\\text{new}}=c\\,E[S]=\\frac{2}{3}E[S], \\qquad E[S^{2}]_{\\text{new}}=c^{2}E[S^{2}]=\\frac{4}{9}E[S^{2}].\n$$\n新的流量强度为\n$$\n\\rho_{\\text{new}}=\\lambda_{\\text{new}}E[S]_{\\text{new}}=2\\lambda\\cdot\\frac{2}{3}E[S]=\\frac{4}{3}\\rho,\n$$\n新的平均等待时间为\n$$\nW_{q,\\text{new}}=\\frac{\\lambda_{\\text{new}}E[S^{2}]_{\\text{new}}}{2\\left(1-\\rho_{\\text{new}}\\right)}=\\frac{(2\\lambda)\\left(\\frac{4}{9}E[S^{2}]\\right)}{2\\left(1-\\frac{4}{3}\\rho\\right)}.\n$$\n因此，比率为\n$$\n\\frac{W_{q,\\text{new}}}{W_{q,\\text{old}}}\n=\\frac{\\lambda_{\\text{new}}}{\\lambda}\\cdot\\frac{E[S^{2}]_{\\text{new}}}{E[S^{2}]}\\cdot\\frac{1-\\rho}{1-\\rho_{\\text{new}}}\n=2\\cdot\\frac{4}{9}\\cdot\\frac{1-\\rho}{1-\\frac{4}{3}\\rho}\n=\\frac{8}{9}\\cdot\\frac{1-\\rho}{1-\\frac{4}{3}\\rho}\n=\\frac{8(1-\\rho)}{3(3-4\\rho)},\n$$\n该结果在 $0 \\le \\rho  \\frac{3}{4}$ 时有效，以确保升级后的系统是稳定的。", "answer": "$$\\boxed{\\frac{8(1-\\rho)}{3(3-4\\rho)}}$$", "id": "1341170"}]}