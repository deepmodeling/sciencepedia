{"hands_on_practices": [{"introduction": "为了掌握全变差距离，最好的方法是从一个直观的例子开始。这个练习将带你计算一个在方形轨道上移动的机器人的位置分布与均匀分布之间的距离。通过这个基础计算[@problem_id:1346637]，你将直接应用全变差距离的定义，为理解更复杂的场景奠定坚实的基础。", "problem": "一个小型维护机器人在一个正方形轨道上移动。轨道有四个服务站位于其顶点，我们按逆时针顺序将它们标记为 $V_1, V_2, V_3, V_4$。机器人的移动由一个简单的随机过程控制。在每一步中，机器人从其当前位置以相等的概率移动到其两个相邻的服务站之一。\n\n机器人从服务站 $V_1$ 开始。设 $\\mu_1$ 是机器人移动恰好一步后位置的概率分布，设 $\\pi$ 是四个服务站上的均匀概率分布。\n\n计算分布 $\\mu_1$ 和 $\\pi$ 之间的全变差距离。", "solution": "设状态空间为 $\\{V_{1},V_{2},V_{3},V_{4}\\}$。机器人从 $V_{1}$ 开始。移动一步后，它以相等的概率移动到任一相邻顶点，因此\n$$\n\\mu_{1}(V_{2})=\\frac{1}{2},\\quad \\mu_{1}(V_{4})=\\frac{1}{2},\\quad \\mu_{1}(V_{1})=0,\\quad \\mu_{1}(V_{3})=0.\n$$\n四个顶点上的均匀分布 $\\pi$ 指定\n$$\n\\pi(V_{i})=\\frac{1}{4}\\quad \\text{for }i\\in\\{1,2,3,4\\}.\n$$\n在有限集上，两个分布 $P$ 和 $Q$ 之间的全变差距离为\n$$\nd_{\\mathrm{TV}}(P,Q)=\\frac{1}{2}\\sum_{x}|P(x)-Q(x)|.\n$$\n将此应用于 $\\mu_{1}$ 和 $\\pi$，我们计算绝对差：\n$$\n|\\mu_{1}(V_{1})-\\pi(V_{1})|=\\left|0-\\frac{1}{4}\\right|=\\frac{1}{4},\\quad\n|\\mu_{1}(V_{2})-\\pi(V_{2})|=\\left|\\frac{1}{2}-\\frac{1}{4}\\right|=\\frac{1}{4},\n$$\n$$\n|\\mu_{1}(V_{3})-\\pi(V_{3})|=\\left|0-\\frac{1}{4}\\right|=\\frac{1}{4},\\quad\n|\\mu_{1}(V_{4})-\\pi(V_{4})|=\\left|\\frac{1}{2}-\\frac{1}{4}\\right|=\\frac{1}{4}.\n$$\n求和得到 $\\sum_{i=1}^{4}|\\mu_{1}(V_{i})-\\pi(V_{i})|=1$，因此\n$$\nd_{\\mathrm{TV}}(\\mu_{1},\\pi)=\\frac{1}{2}\\cdot 1=\\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1346637"}, {"introduction": "在马尔可夫链的研究中，我们通常使用转移矩阵来描述系统的动态。这个练习[@problem_id:1346634]让你在一个由转移矩阵定义的四状态系统中计算全变差距离。它不仅能让你练习将矩阵运算与全变差距离公式相结合，还能让你了解特殊类型矩阵（如双随机矩阵）与平稳分布之间的重要联系。", "problem": "一个粒子在一组标记为 $S = \\{1, 2, 3, 4\\}$ 的四个位置上进行随机游走。其运动被建模为一个离散时间马尔可夫链。转移概率矩阵 $P$ 由下式给出，其中条目 $P_{ij}$ 是从位置 $i$ 一步移动到位置 $j$ 的概率：\n$$\nP = \\begin{pmatrix}\n0.4  0.3  0.2  0.1 \\\\\n0.1  0.4  0.3  0.2 \\\\\n0.2  0.1  0.4  0.3 \\\\\n0.3  0.2  0.1  0.4\n\\end{pmatrix}\n$$\n该链具有一个均匀的平稳分布 $\\pi_{\\text{stat}}$，其中处于任何位置的概率都相等。\n\n假设粒子在时间 $t=0$ 时从位置 1 开始。令 $\\pi_1$ 为粒子在时间 $t=1$ 时的位置概率分布。计算分布 $\\pi_1$ 和平稳分布 $\\pi_{\\text{stat}}$ 之间的全变差距离。\n\n将你的最终答案表示为精确小数。", "solution": "我们给定一个在 $S=\\{1,2,3,4\\}$ 上的离散时间马尔可夫链，其转移矩阵为 $P$，初始条件为粒子在时间 $t=0$ 时从位置 1 开始。将时间 $t$ 时的分布记为 $\\pi_{t}$。那么初始分布为\n$$\n\\pi_{0} = (1,0,0,0).\n$$\n一步之后的分布通过将初始分布乘以转移矩阵得到：\n$$\n\\pi_{1} = \\pi_{0} P.\n$$\n由于 $\\pi_{0}$ 是状态 1 的单位向量，$\\pi_{1}$ 等于 $P$ 的第一行：\n$$\n\\pi_{1} = (0.4, 0.3, 0.2, 0.1).\n$$\n因为 $P$ 是双随机的（每列的和为 1），所以均匀分布是平稳的。因此，\n$$\n\\pi_{\\text{stat}} = \\left(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}\\right) = (0.25, 0.25, 0.25, 0.25).\n$$\n在有限集上两个分布 $p$ 和 $q$ 之间的全变差距离是\n$$\nd_{\\text{TV}}(p,q) = \\frac{1}{2} \\sum_{i} |p_{i} - q_{i}|.\n$$\n将此应用于 $\\pi_{1}$ 和 $\\pi_{\\text{stat}}$ 得到\n$$\nd_{\\text{TV}}(\\pi_{1}, \\pi_{\\text{stat}}) = \\frac{1}{2}\\left(|0.4 - 0.25| + |0.3 - 0.25| + |0.2 - 0.25| + |0.1 - 0.25|\\right).\n$$\n计算每个绝对差：\n$$\n|0.4 - 0.25| = 0.15,\\quad |0.3 - 0.25| = 0.05,\\quad |0.2 - 0.25| = 0.05,\\quad |0.1 - 0.25| = 0.15.\n$$\n求和，\n$$\n0.15 + 0.05 + 0.05 + 0.15 = 0.40.\n$$\n因此，\n$$\nd_{\\text{TV}}(\\pi_{1}, \\pi_{\\text{stat}}) = \\frac{1}{2} \\times 0.40 = 0.20.\n$$\n因此，全变差距离是精确小数 $0.2$。", "answer": "$$\\boxed{0.2}$$", "id": "1346634"}, {"introduction": "全变差距离的一个核心应用是衡量马尔可夫链收敛到其平稳分布的速度。这个问题[@problem_id:1346612]不再是简单地计算某个时刻的距离，而是要求你反过来求解，确定距离衰减到其初始值一半所需的时间。通过解决这个问题，你将亲身体会到全变差距离如何量化一个系统“混合”或“忘记”其初始状态的速率。", "problem": "考虑一个双选项系统中观点演变的简单模型，例如，一个选民在政党 A 和政党 B 之间进行选择。我们将选民的选择建模为一个双态系统中的一个状态，状态标记为 $\\{A, B\\}$。在初始时刻 $t=0$，该选民支持政党 A。\n\n在随后的每个离散时间步，该选民会重新考虑其立场。选民以概率 $p$ 维持其当前党派，或以概率 $1-p$ 转换到另一党派。这个过程是一个马尔可夫链。维持当前党派的具体概率由 $p = \\frac{1}{2} + \\frac{\\sqrt{2}}{4}$ 给出。经过很长一段时间后，这个过程会趋近一个平稳分布 $\\pi$，在该分布下，选民支持任一政党的可能性是相同的。\n\n令 $\\mu_t$ 为描述选民在时间步 $t$ 的党派偏好的概率分布。在时间步 $t$ 的分布与平稳分布之间的差异由全变差距离来衡量，记为 $d_t$。\n\n确定所需的确切整数时间步数 $t$，使得全变差距离 $d_t$ 恰好变为其初始值 $d_0$ 的一半。", "solution": "设状态空间为 $\\{A,B\\}$，坐标按 $(A,B)$ 排序。转移矩阵为\n$$\nP=\\begin{pmatrix}\np  1-p\\\\\n1-p  p\n\\end{pmatrix},\n$$\n其中 $p=\\frac{1}{2}+\\frac{\\sqrt{2}}{4}$。根据对称性，平稳分布为 $\\pi=\\left(\\frac{1}{2},\\frac{1}{2}\\right)$。设 $x_{t}=\\Pr(\\text{state}=A\\text{ at time }t)$。则 $\\mu_{t}=(x_{t},1-x_{t})$ 且全变差距离为\n$$\nd_{t}=\\frac{1}{2}\\left(\\left|x_{t}-\\frac{1}{2}\\right|+\\left|1-x_{t}-\\frac{1}{2}\\right|\\right)=\\left|x_{t}-\\frac{1}{2}\\right|.\n$$\n\n$x_{t}$ 的单步更新为\n$$\nx_{t+1}=p x_{t}+(1-p)(1-x_{t})=(2p-1)x_{t}+(1-p).\n$$\n两边减去 $\\frac{1}{2}$ 得到\n$$\nx_{t+1}-\\frac{1}{2}=(2p-1)\\left(x_{t}-\\frac{1}{2}\\right),\n$$\n因此通过归纳法\n$$\nx_{t}-\\frac{1}{2}=(2p-1)^{t}\\left(x_{0}-\\frac{1}{2}\\right).\n$$\n在初始条件 $x_{0}=1$ 下，我们有 $x_{0}-\\frac{1}{2}=\\frac{1}{2}$，因此\n$$\nd_{t}=\\left|x_{t}-\\frac{1}{2}\\right|=\\frac{1}{2}\\left|2p-1\\right|^{t}.\n$$\n又因 $d_{0}=\\frac{1}{2}$，所以\n$$\nd_{t}=d_{0}\\left|2p-1\\right|^{t}.\n$$\n计算 $2p-1$：\n$$\n2p-1=2\\left(\\frac{1}{2}+\\frac{\\sqrt{2}}{4}\\right)-1=\\frac{\\sqrt{2}}{2}.\n$$\n因此\n$$\nd_{t}=d_{0}\\left(\\frac{\\sqrt{2}}{2}\\right)^{t}.\n$$\n我们需要 $d_{t}=\\frac{1}{2}d_{0}$，所以\n$$\n\\left(\\frac{\\sqrt{2}}{2}\\right)^{t}=\\frac{1}{2}.\n$$\n因为 $\\frac{\\sqrt{2}}{2}=2^{-1/2}$，此式即 $2^{-t/2}=2^{-1}$，解得 $t=2$。", "answer": "$$\\boxed{2}$$", "id": "1346612"}]}