{"hands_on_practices": [{"introduction": "构建任何吉布斯采样器的第一步都是确定其核心引擎：全条件分布。这个练习将指导你完成这个基本过程，通过一个在简单三角形区域上的均匀分布，来推导每个变量的条件分布。这不仅是数学上的练习，更是理解多维分布如何分解为一系列更简单的一维分布的基础[@problem_id:1338725]。", "problem": "一位统计学家希望在一个特定的二维区域内生成均匀分布的随机点 $(X, Y)$。该区域是笛卡尔平面中由顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 定义的一个三角形。随机向量 $(X,Y)$ 的联合概率密度函数 (PDF) 在此三角形内部为常数，在外部为零。为生成这些点，该统计学家计划使用吉布斯采样器 (Gibbs sampler)，这是一种通过从全条件分布中迭代采样来工作的马尔可夫链蒙特卡洛 (Markov chain Monte Carlo) 算法。\n\n实现吉布斯采样器的核心要求是正确指定这些全条件分布，$p(x|y)$ 和 $p(y|x)$。设 $U(a,b)$ 表示区间 $[a,b]$ 上的连续均匀分布。\n\n下列哪个选项正确指定了吉布斯采样器所需的 $X$ 和 $Y$ 的全条件分布？\n\nA. $X|Y=y \\sim U(0, 1-y)$ and $Y|X=x \\sim U(0, 1-x)$\n\nB. $X|Y=y \\sim U(0, 1)$ and $Y|X=x \\sim U(0, 1)$\n\nC. $X|Y=y \\sim U(0, y)$ and $Y|X=x \\sim U(0, x)$\n\nD. $X|Y=y \\sim U(0, 1-x)$ and $Y|X=x \\sim U(0, 1-y)$\n\nE. $X|Y=y \\sim U(y, 1)$ and $Y|X=x \\sim U(x, 1)$", "solution": "题目要求解在一个由顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 构成的三角形内均匀分布的点 $(X,Y)$ 的全条件分布 $p(x|y)$ 和 $p(y|x)$。\n\n首先，我们来定义该分布的支撑集。该三角形由直线 $x=0$、$y=0$ 以及连接 $(1,0)$ 和 $(0,1)$ 的直线 $x+y=1$ 所界定。因此，概率非零的区域（我们称之为 $R$）由 $R = \\{(x,y) | x \\ge 0, y \\ge 0, x+y \\le 1\\}$ 给出。\n\n分布在该区域上是均匀的。三角形的面积为 $A = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$。$(X,Y)$ 的联合概率密度函数 (PDF) $f(x,y)$ 在三角形内部是面积的倒数，在其他地方为零。\n$$\nf(x,y) =\n\\begin{cases}\n\\frac{1}{A} = 2  \\text{if } x \\ge 0, y \\ge 0, x+y \\le 1 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n为了求条件分布，我们使用公式 $f(x|y) = \\frac{f(x,y)}{f_Y(y)}$ 和 $f(y|x) = \\frac{f(x,y)}{f_X(x)}$，其中 $f_X(x)$ 和 $f_Y(y)$ 是边缘概率密度函数。\n\n我们先求 $Y$ 的边缘概率密度函数 $f_Y(y)$。我们将联合概率密度函数对所有可能的 $x$ 值进行积分。对于一个固定的 $y \\in [0,1]$ 值，对 $x$ 的约束是 $x \\ge 0$ 和 $x \\le 1-y$。\n$$\nf_Y(y) = \\int_{-\\infty}^{\\infty} f(x,y) \\, dx = \\int_{0}^{1-y} 2 \\, dx\n$$\n这个积分对于 $y \\in [0,1]$ 是有效的。对于此区间外的 $y$，$f_Y(y)=0$。\n$$\nf_Y(y) = 2 [x]_0^{1-y} = 2(1-y) \\quad \\text{for } 0 \\le y \\le 1\n$$\n现在我们可以求给定 $Y=y$ 时 $X$ 的条件概率密度函数。\n$$\nf(x|y) = \\frac{f(x,y)}{f_Y(y)} = \\frac{2}{2(1-y)} = \\frac{1}{1-y}\n$$\n这个条件概率密度函数是在给定 $y$ 的情况下 $x$ 的取值范围上定义的，即 $0 \\le x \\le 1-y$。函数 $f(x|y) = \\frac{1}{1-y}$ 相对于 $x$ 是一个常数。这是在区间 $[0, 1-y]$ 上的均匀分布的概率密度函数。因此，我们记为 $X|Y=y \\sim U(0, 1-y)$。\n\n接下来，我们求 $X$ 的边缘概率密度函数 $f_X(x)$。我们将联合概率密度函数对所有可能的 $y$ 值进行积分。对于一个固定的 $x \\in [0,1]$ 值，对 $y$ 的约束是 $y \\ge 0$ 和 $y \\le 1-x$。\n$$\nf_X(x) = \\int_{-\\infty}^{\\infty} f(x,y) \\, dy = \\int_{0}^{1-x} 2 \\, dy\n$$\n这个积分对于 $x \\in [0,1]$ 是有效的。对于此区间外的 $x$，$f_X(x)=0$。\n$$\nf_X(x) = 2 [y]_0^{1-x} = 2(1-x) \\quad \\text{for } 0 \\le x \\le 1\n$$\n现在我们可以求给定 $X=x$ 时 $Y$ 的条件概率密度函数。\n$$\nf(y|x) = \\frac{f(x,y)}{f_X(x)} = \\frac{2}{2(1-x)} = \\frac{1}{1-x}\n$$\n这个条件概率密度函数是在给定 $x$ 的情况下 $y$ 的取值范围上定义的，即 $0 \\le y \\le 1-x$。函数 $f(y|x) = \\frac{1}{1-x}$ 相对于 $y$ 是一个常数。这是在区间 $[0, 1-x]$ 上的均匀分布的概率密度函数。因此，我们记为 $Y|X=x \\sim U(0, 1-x)$。\n\n综合我们的两个发现，全条件分布为：\n$X|Y=y \\sim U(0, 1-y)$\n$Y|X=x \\sim U(0, 1-x)$\n\n将此结果与给定选项进行比较，我们发现它与选项 A 匹配。", "answer": "$$\\boxed{A}$$", "id": "1338725"}, {"introduction": "吉布斯采样器在许多情况下都非常强大，但它也有其局限性。这个思想实验探讨了一种极端情况：当变量之间存在完美的确定性关系时会发生什么[@problem_id:1338719]。通过分析这个场景，你将发现吉布斯采样器在探索这类分布时的一个关键弱点，并理解为什么它会“卡住”而无法移动。", "problem": "一个特殊化学反应器的监控系统跟踪两个相关的温度读数，$X$ 和 $Y$。由于反应器设计带来的严格物理约束，这两个读数的联合概率密度函数 $p(x, y)$ 仅在由方程 $x + y = 10$ 定义的线段上非零，其中 $x$ 和 $y$ 均为非负值（即 $x \\ge 0$ 和 $y \\ge 0$）。沿着这条可及的线段，概率分布是均匀的。\n\n一位数据科学家决定使用 Gibbs 采样器来生成遵循此分布的合成数据点 $(X, Y)$。采样器在点 $(X_0, Y_0) = (4.5, 5.5)$ 处初始化。对于 $t = 1, 2, 3, \\dots$，从当前状态 $(X_{t-1}, Y_{t-1})$ 生成下一个状态 $(X_{t}, Y_{t})$ 的采样过程如下：\n1. 从条件分布 $p(x | Y=Y_{t-1})$ 中为第一个变量 $X_{t}$ 抽取一个新值。\n2. 从条件分布 $p(y | X=X_{t})$ 中为第二个变量 $Y_{t}$ 抽取一个新值。\n\n确定采样器在 100 次完整迭代后的状态 $(X_{100}, Y_{100})$。请用一对数表示你的答案。", "solution": "联合支撑集是线段 $S=\\{(x,y): x\\ge 0,\\ y\\ge 0,\\ x+y=10\\}$。由于 $p(x,y)$ 在这个一维集合上是均匀的，对于任何 $y\\in[0,10]$，条件概率 $p(x\\mid Y=y)$ 将其所有质量集中在满足 $x+y=10$ 的唯一 $x$ 上，即，\n$$\np(x\\mid Y=y)=\\delta\\!\\left(x-(10-y)\\right),\n$$\n同样地，对于任何 $x\\in[0,10]$，\n$$\np(y\\mid X=x)=\\delta\\!\\left(y-(10-x)\\right).\n$$\n因此，Gibbs 更新是确定性的：\n$$\nX_{t}=10-Y_{t-1},\\qquad Y_{t}=10-X_{t}.\n$$\n从 $(X_{0},Y_{0})=(4.5,5.5)$ 开始，第一次迭代产生\n$$\nX_{1}=10-5.5=4.5,\\qquad Y_{1}=10-4.5=5.5,\n$$\n因此状态保持不变。通过归纳法，如果 $(X_{t},Y_{t})=(4.5,5.5)$，那么\n$$\nX_{t+1}=10-5.5=4.5,\\qquad Y_{t+1}=10-4.5=5.5,\n$$\n因此，对于所有的 $t$，链都固定在 $(4.5,5.5)$。特别地，\n$$\n(X_{100},Y_{100})=(4.5,5.5).\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 4.5  5.5 \\end{pmatrix}}$$", "id": "1338719"}, {"introduction": "一个成功的MCMC方法必须能够探索整个目标分布空间。此问题引入了另一个吉布斯采样器可能失败的常见陷阱，即当目标分布的支撑集不连通时。通过这个练习[@problem_id:1338689]，你将了解马尔可夫链的“不可约性”（irreducibility）为何至关重要，以及为什么一个看似设计良好的采样器可能只会探索到概率“岛屿”中的一个。", "problem": "考虑一对离散随机变量 $(X, Y)$，其联合概率质量函数 (PMF) $p(x, y)$ 定义在 $\\mathbb{Z}^2$ 的一个子集上。该分布的支撑集，即点集 $\\{ (x, y) \\mid p(x, y) > 0 \\}$，是两个不相交的方形区域 $U = A_1 \\cup A_2$ 的并集。这些区域由一个正整数参数 $K$ 和一个更大的整数 $L$（满足 $L > K$）定义。具体而言：\n$A_1 = \\{(x, y) \\in \\mathbb{Z}^2 \\mid 0 \\le x \\le K, 0 \\le y \\le K\\}$\n$A_2 = \\{(x, y) \\in \\mathbb{Z}^2 \\mid L \\le x \\le L+K, L \\le y \\le L+K\\}$\n\n联合概率质量函数 $p(x, y)$ 在支撑集 $U$ 上是均匀分布的。\n\n我们采用一个 Gibbs 采样器从该分布中生成样本。采样器在状态 $(x^{(0)}, y^{(0)}) = (0, 0)$ 处初始化。每个后续状态 $(x^{(t+1)}, y^{(t+1)})$ 都是通过以下两步过程从当前状态 $(x^{(t)}, y^{(t)})$ 生成的：\n1. 从全条件分布 $p(x | Y = y^{(t)})$ 中抽取 $x^{(t+1)}$。\n2. 从全条件分布 $p(y | X = x^{(t+1)})$ 中抽取 $y^{(t+1)}$。\n\n经过大量迭代后，生成的状态序列将在分布上收敛到一个平稳分布，记为 $\\pi(x, y)$。求随机变量 $X$ 关于此平稳分布的期望值 $\\mathbb{E}_{\\pi}[X]$。您的答案应该是一个关于 $K$ 的解析表达式。", "solution": "令 $U=A_{1}\\cup A_{2}$，其中 $A_{1}=\\{(x,y)\\in\\mathbb{Z}^{2}\\mid 0\\le x\\le K,\\;0\\le y\\le K\\}$ 且 $A_{2}=\\{(x,y)\\in\\mathbb{Z}^{2}\\mid L\\le x\\le L+K,\\;L\\le y\\le L+K\\}$，并假设 $p(x,y)$ 在 $U$ 上是均匀分布的。因此存在一个常数 $c$，使得当 $(x,y)\\in U$ 时 $p(x,y)=c$，否则 $p(x,y)=0$。由于 $|A_{1}|=|A_{2}|=(K+1)^{2}$ 且 $U$ 是一个不相交并集，所以 $c=\\frac{1}{2(K+1)^{2}}$，尽管在计算条件分布时它的值会被消去。\n\n固定 $y\\in\\mathbb{Z}$。全条件分布 $p(x\\mid y)$ 由下式给出\n$$\np(x\\mid y)=\\frac{p(x,y)}{\\sum_{x'}p(x',y)}.\n$$\n如果 $0\\le y\\le K$，那么 $(x,y)\\in U$ 当且仅当 $0\\le x\\le K$，所以 $\\sum_{x'}p(x',y)=\\sum_{x'=0}^{K}c=c(K+1)$ 且\n$$\np(x\\mid y)=\\begin{cases}\n\\frac{1}{K+1},  0\\le x\\le K,\\\\\n0,  \\text{其它}.\n\\end{cases}\n$$\n如果 $L\\le y\\le L+K$，那么 $(x,y)\\in U$ 当且仅当 $L\\le x\\le L+K$，得到\n$$\np(x\\mid y)=\\begin{cases}\n\\frac{1}{K+1},  L\\le x\\le L+K,\\\\\n0,  \\text{其它}.\n\\end{cases}\n$$\n在马尔可夫链下不会出现其他的 $y$ 值，因为在那些地方 $p(y)=0$。根据对称性，另一个全条件分布 $p(y\\mid x)$ 满足：如果 $0\\le x\\le K$，则 $p(y\\mid x)$ 在 $\\{0,\\dots,K\\}$ 上是均匀分布的；如果 $L\\le x\\le L+K$，则 $p(y\\mid x)$ 在 $\\{L,\\dots,L+K\\}$ 上是均匀分布的。\n\n由于初始化为 $(x^{(0)},y^{(0)})=(0,0)\\in A_{1}$，我们有 $y^{(0)}\\in\\{0,\\dots,K\\}$，因此 $x^{(1)}$ 在 $\\{0,\\dots,K\\}$ 上是均匀分布的。给定任意 $x^{(1)}\\in\\{0,\\dots,K\\}$，$y^{(1)}$ 随后在 $\\{0,\\dots,K\\}$ 上也是均匀分布的。因此，从 $A_{1}$ 中任意状态出发的单步转移，都会生成一个在 $A_{1}$ 上均匀分布的 $(x^{(t+1)},y^{(t+1)})$，且与 $(x^{(t)},y^{(t)})$ 无关。因此，该马尔可夫链是可约的，具有两个闭集 $A_{1}$ 和 $A_{2}$；从 $A_{1}$ 开始，它将一直停留在 $A_{1}$ 中，并且从第一次迭代开始，其分布就是在 $A_{1}$ 上的独立同分布的均匀分布。因此，从给定的初始状态所能达到的平稳分布是 $A_{1}$ 上的均匀分布。\n\n在此平稳分布下，$X$ 的边际分布是在 $\\{0,\\dots,K\\}$ 上的离散均匀分布，因为联合分布在 $A_{1}$ 上是均匀的，并且在此均匀限制下，$X$ 和 $Y$ 是独立的。因此\n$$\n\\mathbb{E}_{\\pi}[X]=\\frac{1}{(K+1)^{2}}\\sum_{x=0}^{K}\\sum_{y=0}^{K} x\n=\\frac{1}{(K+1)^{2}}\\left(\\sum_{x=0}^{K}x\\right)(K+1)\n=\\frac{1}{K+1}\\cdot\\frac{K(K+1)}{2}\n=\\frac{K}{2}.\n$$\n所以，期望值为 $\\frac{K}{2}$。", "answer": "$$\\boxed{\\frac{K}{2}}$$", "id": "1338689"}]}