{"hands_on_practices": [{"introduction": "让我们从一项基本技能开始我们的实践探索：计算随机游走在特定步数后到达某一位置的概率。这个练习 [@problem_id:1329644] 在一个简单的三状态路径上提供了一个具体情景，让你能够追踪所有可能的路径及其概率。掌握这项技能有助于你为随机游走如何随时间演化建立起强大的直觉。", "problem": "一个简化的一维模型用于描述一个小分子的构象动力学，该模型考虑了三个不同的状态，标记为 1、2 和 3。分子可以在离散的时间步长内在这些状态之间转换。这些状态是线性排列的，因此转换只可能在相邻状态之间发生（即，状态 1 和 2 之间，以及状态 2 和 3 之间）。\n\n转换规则如下：\n- 在每个时间步长，从任何状态 $S$ 出发，分子有 $1/2$ 的概率保持在状态 $S$。\n- 以剩余的 $1/2$ 概率，分子尝试转换到相邻状态。\n- 如果分子处于状态 2，该状态有两个相邻状态（1 和 3），它将以 $1/4$ 的概率移动到状态 1，并以 $1/4$ 的概率移动到状态 3。\n- 如果分子处于末端状态（1 或 3），该状态只有一个相邻状态，它将以 $1/2$ 的概率移动到该相邻状态（状态 2）。\n\n假设在时间 $t=0$ 时分子处于状态 1。那么在恰好 3 个时间步长后，分子处于状态 3 的概率是多少？", "solution": "我们将该系统建模为状态集 $\\{1,2,3\\}$ 上的一个离散时间马尔可夫链，其转移概率由以下规则定义：\n- 从状态 $1$：$\\Pr(1\\to 1)=\\frac{1}{2}$，$\\Pr(1\\to 2)=\\frac{1}{2}$，$\\Pr(1\\to 3)=0$。\n- 从状态 $2$：$\\Pr(2\\to 1)=\\frac{1}{4}$，$\\Pr(2\\to 2)=\\frac{1}{2}$，$\\Pr(2\\to 3)=\\frac{1}{4}$。\n- 从状态 $3$：$\\Pr(3\\to 2)=\\frac{1}{2}$，$\\Pr(3\\to 3)=\\frac{1}{2}$，$\\Pr(3\\to 1)=0$。\n\n设 $X_{t}$ 表示时间 $t$ 时的状态，且 $X_{0}=1$。根据马尔可夫性质和应用于最后一步的全概率公式，\n$$\n\\Pr(X_{3}=3 \\mid X_{0}=1)\n= \\Pr(X_{2}=3 \\mid X_{0}=1)\\Pr(3\\to 3) + \\Pr(X_{2}=2 \\mid X_{0}=1)\\Pr(2\\to 3).\n$$\n根据转移规则，$\\Pr(3\\to 3)=\\frac{1}{2}$ 且 $\\Pr(2\\to 3)=\\frac{1}{4}$。我们现在通过枚举所有两步路径来计算两步概率 $\\Pr(X_{2}=3 \\mid X_{0}=1)$ 和 $\\Pr(X_{2}=2 \\mid X_{0}=1)$：\n\n对于 $\\Pr(X_{2}=3 \\mid X_{0}=1)$，从 $1$ 到 $3$ 的唯一可行两步路径是 $1\\to 2\\to 3$，因此\n$$\n\\Pr(X_{2}=3 \\mid X_{0}=1) = \\Pr(1\\to 2)\\Pr(2\\to 3) = \\frac{1}{2}\\cdot \\frac{1}{4} = \\frac{1}{8}.\n$$\n对于 $\\Pr(X_{2}=2 \\mid X_{0}=1)$，从 $1$ 到 $2$ 的可行两步路径是 $1\\to 1\\to 2$ 和 $1\\to 2\\to 2$，因此\n$$\n\\Pr(X_{2}=2 \\mid X_{0}=1) = \\Pr(1\\to 1)\\Pr(1\\to 2) + \\Pr(1\\to 2)\\Pr(2\\to 2) = \\frac{1}{2}\\cdot \\frac{1}{2} + \\frac{1}{2}\\cdot \\frac{1}{2} = \\frac{1}{2}.\n$$\n代入分解式可得\n$$\n\\Pr(X_{3}=3 \\mid X_{0}=1) = \\frac{1}{8}\\cdot \\frac{1}{2} + \\frac{1}{2}\\cdot \\frac{1}{4} = \\frac{1}{16} + \\frac{1}{8} = \\frac{3}{16}.\n$$\n因此，从状态 1 开始，经过恰好 3 个时间步长后，分子处于状态 3 的概率是 $\\frac{3}{16}$。", "answer": "$$\\boxed{\\frac{3}{16}}$$", "id": "1329644"}, {"introduction": "除了短期预测，我们常常想知道随机游走需要多长时间才能到达一个特定的目的地。这个被称为期望首达时间的概念是随机游走分析的基石，有着广泛的应用。在这个练习题 [@problem_id:1329640] 中，你将使用一种称为“一步分析”的强大技巧，来计算一个机器人从走廊一端移动到另一端所需的期望步数。", "problem": "一个自动清洁机器人沿着一条连接三个房间的狭窄走廊移动，我们可以将这些位置标记为一条直线上的 1、2 和 3。位置 2 在中间，与 1 和 3 都相邻。位置 1 和 3 在走廊的两端，各自只与位置 2 相邻。\n\n机器人从位置 1 开始。在每个时间步，它从当前位置移动到一个相邻位置。移动到哪个相邻位置的选择是均匀随机的。例如，从位置 2 出发，它以 1/2 的概率移动到位置 1，以 1/2 的概率移动到位置 3。从一个端点位置（1 或 3）出发，它只有一个相邻位置，所以它以概率 1 移动到那里。\n\n一旦机器人首次到达位置 3，其任务就被视为完成。计算机器人完成其任务所需的期望步数。", "solution": "在位置 $\\{1,2,3\\}$ 上定义一个马尔可夫链，其中位置 $3$ 是一个吸收态（任务在首次到达 $3$ 时完成）。令 $T$ 为到达状态 $3$ 的首达时间，并令 $E_{i}=\\mathbb{E}[T\\mid \\text{start at }i]$ 为从位置 $i$ 出发所需的期望步数，其中 $i\\in\\{1,2,3\\}$。\n\n根据马尔可夫性质和全期望定律（首步分析法）：\n- 从位置 $3$ 出发，任务已完成，所以 $E_{3}=0$。\n- 从位置 $1$ 出发，机器人确定地在一步内移动到 $2$，所以\n$$\nE_{1}=1+E_{2}.\n$$\n- 从位置 $2$ 出发，机器人以 $\\frac{1}{2}$ 的概率移动到 $1$，以 $\\frac{1}{2}$ 的概率移动到 $3$，这会花费一步并加上剩余的期望时间，因此\n$$\nE_{2}=1+\\frac{1}{2}E_{1}+\\frac{1}{2}E_{3}.\n$$\n\n使用 $E_{3}=0$，我们有\n$$\nE_{2}=1+\\frac{1}{2}E_{1}.\n$$\n将此式代入 $E_{1}=1+E_{2}$：\n$$\nE_{1}=1+\\left(1+\\frac{1}{2}E_{1}\\right)=2+\\frac{1}{2}E_{1}.\n$$\n整理方程以解出 $E_{1}$：\n$$\nE_{1}-\\frac{1}{2}E_{1}=2 \\quad \\Rightarrow \\quad \\frac{1}{2}E_{1}=2 \\quad \\Rightarrow \\quad E_{1}=4.\n$$\n\n因此，从位置 $1$ 开始到达位置 $3$ 所需的期望步数是 $4$。", "answer": "$$\\boxed{4}$$", "id": "1329640"}, {"introduction": "最后，让我们通过考察随机游走的稳态分布来研究其长期行为，稳态分布描述了经过许多步后，游走者最可能在什么位置被发现。这个问题 [@problem_id:1329662] 挑战你比较一个简单随机游走和一个“懒惰”随机游走的稳态分布。通过解决这个问题，你将更深入地理解图的哪些结构特性决定了其长期行为，并发现这两种过程之间一个令人惊讶且重要的关系。", "problem": "考虑一个具有三个离散状态的系统，标记为 $\\{1, 2, 3\\}$。这些状态排列成一个线性链，使得状态1仅与状态2相连，状态3仅与状态2相连，而状态2与状态1和3都相连。在这个状态集上定义了两种不同的随机游走过程。\n\n**过程1：简单随机游走**\n一个粒子以离散时间步演化。在每一步，处于当前状态的粒子会移动到其一个相连的邻居状态。粒子以等概率选择每个邻居。\n\n**过程2：懒惰随机游走**\n这个过程也以离散时间步演化。在每一步，粒子有 $\\frac{1}{2}$ 的概率停留在当前状态。以剩余的 $\\frac{1}{2}$ 概率，它会移动到其一个相连的邻居状态，并以等概率选择每个邻居。\n\n令 $\\pi_S = (\\pi_1^S, \\pi_2^S, \\pi_3^S)$ 表示简单随机游走的平稳概率分布，令 $\\pi_L = (\\pi_1^L, \\pi_2^L, \\pi_3^L)$ 表示懒惰随机游走的平稳概率分布。在此记法中，$\\pi_i$ 表示发现粒子处于状态 $i$ 的长期概率。\n\n下列哪个陈述正确描述了 $\\pi_S$ 和 $\\pi_L$ 之间的关系？\n\nA. $\\pi_S = \\pi_L$。\n\nB. 懒惰游走增加了处于中心状态的概率，即 $\\pi_2^L > \\pi_2^S$。\n\nC. 懒惰游走增加了处于末端状态的概率，即 $\\pi_1^L > \\pi_1^S$ 和 $\\pi_3^L > \\pi_3^S$。\n\nD. 懒惰游走的平稳分布是均匀分布，即 $\\pi_L = (1/3, 1/3, 1/3)$。\n\nE. 简单随机游走的平稳分布 $\\pi_S$ 不存在，因为该链是周期性的。", "solution": "我们将这三个状态建模为具有顶点 $\\{1,2,3\\}$ 和边 $\\{(1,2),(2,3)\\}$ 的路径图。各个顶点的度分别为 $d_{1}=1$，$d_{2}=2$ 和 $d_{3}=1$，且 $\\sum_{i=1}^{3} d_{i}=4$。\n\n对于简单随机游走，如果 $i$ 和 $j$ 相邻，则转移概率为 $P_{ij}^{S}=\\frac{1}{d_{i}}$，否则为 $0$。按状态顺序 $(1,2,3)$，这给出了\n$$\nP_{S}=\\begin{pmatrix}\n0 & 1 & 0 \\\\\n\\frac{1}{2} & 0 & \\frac{1}{2} \\\\\n0 & 1 & 0\n\\end{pmatrix}.\n$$\n平稳性的一个标准充分条件是细致平衡。定义 $\\pi_{i}^{S}=\\frac{d_{i}}{\\sum_{k} d_{k}}$，即，\n$$\n\\pi^{S}=\\left(\\frac{1}{4},\\frac{1}{2},\\frac{1}{4}\\right).\n$$\n那么对于相邻的 $i$ 和 $j$，\n$$\n\\pi_{i}^{S} P_{ij}^{S}=\\frac{d_{i}}{4}\\cdot\\frac{1}{d_{i}}=\\frac{1}{4}=\\frac{d_{j}}{4}\\cdot\\frac{1}{d_{j}}=\\pi_{j}^{S} P_{ji}^{S},\n$$\n而对于不相邻的对，两边都为 $0$。因此细致平衡条件成立，所以 $\\pi^{S}$ 是 $P_{S}$ 的平稳分布。尽管 $P_{S}$ 是周期性的（周期为 $2$），因为该图是二分图，但该链是有限且不可约的，因此存在唯一的平稳分布；周期性影响收敛性，但不影响存在性。\n\n对于懒惰随机游走，转移矩阵为\n$$\nP_{L}=\\frac{1}{2} I+\\frac{1}{2} P_{S}=\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{2} & \\frac{1}{4} \\\\\n0 & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}.\n$$\n如果 $\\pi$ 是 $P_{S}$ 的平稳分布，那么\n$$\n\\pi P_{L}=\\pi\\left(\\frac{1}{2} I+\\frac{1}{2} P_{S}\\right)=\\frac{1}{2}\\pi+\\frac{1}{2}(\\pi P_{S})=\\frac{1}{2}\\pi+\\frac{1}{2}\\pi=\\pi.\n$$\n因此，同一个 $\\pi$ 也是 $P_{L}$ 的平稳分布，所以 $\\pi^{L}=\\pi^{S}=\\left(\\frac{1}{4},\\frac{1}{2},\\frac{1}{4}\\right)$。因此：\n- 陈述 A 是正确的。\n- 陈述 B 和 C 是错误的，因为平稳分布是相等的。\n- 陈述 D 是错误的，因为由于度不相等，平稳分布不是均匀分布。\n- 陈述 E 是错误的，因为即使简单链是周期性的，平稳分布也确实存在。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1329662"}]}