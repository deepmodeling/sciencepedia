{"hands_on_practices": [{"introduction": "将离散的随机游走模型通过适当的尺度变换，可以用来近似模拟连续时间过程，如布朗运动。本练习旨在探索这一尺度变换下的一个基本统计特性：方差。通过计算粒子最终位置平方的期望值，你将亲手验证这种尺度关系如何确保随机游走的方差在极限情况下与布朗运动的方差（即时间 $T$）精确吻合，这是理解两者关系的第一步。[@problem_id:1330627]", "problem": "一个简化的流体中粒子扩散的一维模型构造如下。粒子从初始位置零开始。其运动在持续时间为 $T$ 的固定总时间区间内被追踪。该区间被离散化为 $N$ 个独立的时间步长，每个步长的持续时间为 $\\Delta t = T/N$。\n\n在每个时间步结束时，粒子进行一次跳跃。该跳跃是大小为 $\\Delta x$ 的位移，方向为正方向（右）或负方向（左），每种选择的概率均为 $1/2$。空间跳跃的大小通过标度关系 $\\Delta x = \\sqrt{\\Delta t}$ 与时间步长耦合。\n\n设 $Y_i$ 为第 $i$ 次跳跃的随机变量，当向右跳跃时 $Y_i = +1$，向左跳跃时 $Y_i = -1$。跳跃序列 $\\{Y_1, Y_2, \\dots, Y_N\\}$ 由独立同分布 (i.i.d.) 的随机变量组成。粒子在时间 $T$ 的最终位置由所有单个位移的总和给出：\n$$P_N(T) = \\sum_{i=1}^{N} \\Delta x \\cdot Y_i$$\n\n考虑一个具体情景，其中总时间为 $T = 4.5$（以任意时间单位计），离散步数 $N$ 是一个非常大的整数。计算粒子最终位置平方的期望值 $E\\left[\\left(P_N(T)\\right)^2\\right]$。将你的最终答案表示为一个精确的数值。", "solution": "我们将最终位置建模为 $P_{N}(T) = \\sum_{i=1}^{N} \\Delta x \\, Y_{i}$，其中 $\\Delta x = \\sqrt{\\Delta t}$ 且 $\\Delta t = T/N$。由于 $Y_{i} \\in \\{-1, +1\\}$ 且概率相等，并且 $Y_{i}$ 是独立同分布的，我们有 $E[Y_{i}] = 0$ 和 $E[Y_{i}^{2}] = 1$。\n\n位置平方的期望值为\n$$\nE\\left[\\left(P_{N}(T)\\right)^{2}\\right]\n= E\\left[\\left(\\sum_{i=1}^{N} \\Delta x \\, Y_{i}\\right)^{2}\\right]\n= \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\Delta x^{2} \\, E\\left[Y_{i} Y_{j}\\right].\n$$\n利用独立性和零均值，对于 $i \\neq j$，$E[Y_{i} Y_{j}] = E[Y_{i}]E[Y_{j}] = 0$，对于 $i=j$，$E[Y_{i} Y_{i}] = E[Y_{i}^{2}] = 1$。因此，\n$$\nE\\left[\\left(P_{N}(T)\\right)^{2}\\right]\n= \\sum_{i=1}^{N} \\Delta x^{2} = N \\Delta x^{2}.\n$$\n根据耦合关系 $\\Delta x^{2} = \\Delta t$ 和 $\\Delta t = T/N$，我们得到\n$$\nE\\left[\\left(P_{N}(T)\\right)^{2}\\right] = N \\Delta t = N \\cdot \\frac{T}{N} = T.\n$$\n对于给定的 $T = 4.5$，我们将其精确地写为 $T = \\frac{9}{2}$，因此\n$$\nE\\left[\\left(P_{N}(T)\\right)^{2}\\right] = \\frac{9}{2}.\n$$", "answer": "$$\\boxed{\\frac{9}{2}}$$", "id": "1330627"}, {"introduction": "在前一个练习确认了方差的正确尺度变换后，我们更进一步，来考察随机游走在大量步数后的完整概率分布。这个问题将离散的随机游走与中心极限定理联系起来，展示了其位置分布如何收敛于一个正态分布——这正是布朗运动在特定时刻位置的分布。通过这个计算，你将能够应用连续分布的工具来解决一个源于离散过程的问题，亲身体验从随机游走到布朗运动的过渡。[@problem_id:1330659]", "problem": "悬浮在流体中的微观粒子的一维运动可以用离散对称随机游走来近似。粒子在时间 $t=0$ 时从原点 $x=0$ 开始运动。在每个持续时间为 $\\Delta t$ 的离散时间间隔内，粒子会向右或向左发生大小恰好为 $\\Delta x$ 的位移，两个方向的概率相等，均为0.5。\n\n为了确保该离散模型在连续极限下与物理扩散理论一致，步长 $\\Delta x$ 通过标度关系 $\\Delta x = \\sqrt{2D \\Delta t}$ 与时间间隔 $\\Delta t$ 和粒子的扩散系数 $D$ 相关联。\n\n假设一个粒子的扩散系数为 $D = 5.00 \\times 10^{-11} \\, \\text{m}^{2}\\!/\\text{s}$，其运动使用时间步长 $\\Delta t = 1.00 \\times 10^{-3} \\, \\text{s}$ 进行建模。该过程包含非常大量的步数，使得粒子位置的离散概率分布可以被一个连续分布精确地近似。\n\n计算在总时间 $T = 0.500 \\, \\text{s}$ 过去后，粒子被发现在区间 $[-1.00 \\times 10^{-5} \\, \\text{m}, +1.00 \\times 10^{-5} \\, \\text{m}]$ 内的概率。将你的答案表示为保留三位有效数字的小数。你可能需要标准正态分布表或带有统计功能的计算器。", "solution": "在每个持续时间为 $\\Delta t$ 的时间步长内，粒子的位移是一个随机变量 $S_{i}$，以相等的概率 0.5 取值 $\\pm \\Delta x$。因此 $\\mathbb{E}[S_{i}]=0$ 且 $\\mathrm{Var}(S_{i})=(\\Delta x)^{2}$。经过 $N$ 步后，其中 $N=T/\\Delta t$，位置为\n$$\nX_{N}=\\sum_{i=1}^{N} S_{i},\n$$\n因此根据期望和方差的可加性，\n$$\n\\mathbb{E}[X_{N}]=0,\\qquad \\mathrm{Var}(X_{N})=N(\\Delta x)^{2}.\n$$\n使用标度关系 $\\Delta x=\\sqrt{2D\\,\\Delta t}$，方差变为\n$$\n\\mathrm{Var}(X_{N})=N(2D\\,\\Delta t)=2DT.\n$$\n对于大的 $N$，根据中心极限定理（或等效地，扩散极限），$X(T)$ 可以很好地由一个均值为 $0$、方差为 $2DT$ 的正态分布来近似。其概率密度为\n$$\nf(x,T)=\\frac{1}{\\sqrt{4\\pi DT}}\\exp\\!\\left(-\\frac{x^{2}}{4DT}\\right).\n$$\n找到粒子在 $[-a,a]$ 区间内的概率为（其中 $a=1.00\\times 10^{-5}\\,\\text{m}$）\n$$\nP(|X(T)|\\leq a)=\\int_{-a}^{a} f(x,T)\\,dx=\\operatorname{erf}\\!\\left(\\frac{a}{\\sqrt{4DT}}\\right).\n$$\n代入给定值 $D=5.00\\times 10^{-11}\\,\\text{m}^{2}\\!/\\text{s}$ 和 $T=0.500\\,\\text{s}$：\n$$\n4DT=4\\,(5.00\\times 10^{-11})\\,(0.500)=1.00\\times 10^{-10},\\qquad \\sqrt{4DT}=1.00\\times 10^{-5}.\n$$\n因此\n$$\n\\frac{a}{\\sqrt{4DT}}=\\frac{1.00\\times 10^{-5}}{1.00\\times 10^{-5}}=1,\n$$\n所以\n$$\nP(|X(T)|\\leq a)=\\operatorname{erf}(1)\\approx 0.8427007929.\n$$\n保留三位有效数字得到 $0.843$。", "answer": "$$\\boxed{0.843}$$", "id": "1330659"}, {"introduction": "我们之前的分析集中在特定时刻 $T$ 的粒子位置。现在，我们将视角转向整个过程的路径特性，探索一个区分随机过程与普通光滑函数的关键概念：二次变差。此练习要求你计算一个尺度化随机游走的二次变差，你会发现一个深刻的结果：它并不像光滑函数那样趋向于零，而是收敛到一个确定的值——时间 $t$ 本身。这一特性是布朗运动的标志性特征，也是随机积分理论的基石。[@problem_id:1330611]", "problem": "在短时间间隔内，波动性资产价格的一个简化模型是简单对称随机游走。设初始价格归一化为 $S_0 = 0$。在每个离散时间步 $k=1, 2, 3, \\dots$，价格变化量为 $X_k$，其中 $X_k$ 是独立同分布的随机变量，满足 $P(X_k = 1) = P(X_k = -1) = 1/2$。经过 $m$ 步后的累计价格变化由和 $S_m = \\sum_{k=1}^m X_k$ 给出。\n\n为了在连续时间框架下分析此过程，我们可以定义一个尺度化过程。令 $n$ 为一个大整数，表示单位时间（例如，每天）内的价格更新次数。在时间 $t \\ge 0$ 时的尺度化价格变化过程定义为 $W^{(n)}(t) = \\frac{1}{\\sqrt{n}} S_{\\lfloor nt \\rfloor}$，其中 $\\lfloor \\cdot \\rfloor$ 表示向下取整函数。\n\n此过程的总波动性通常由其二次变差来刻画。对于尺度化过程 $W^{(n)}(t)$，其直至时间 $t$ 的二次变差，记为 $[W^{(n)}]_t$，是通过对离散步长上的价格变化平方求和来计算的。其精确定义为：\n$$[W^{(n)}]_t = \\sum_{k=1}^{\\lfloor nt \\rfloor} \\left( W^{(n)}\\left(\\frac{k}{n}\\right) - W^{(n)}\\left(\\frac{k-1}{n}\\right) \\right)^2$$\n\n对于任意给定的整数 $n  0$ 和时间 $t  0$，计算此二次变差 $[W^{(n)}]_t$ 的精确值。你的最终答案应为一个关于 $n$ 和 $t$ 的解析表达式。", "solution": "我们从尺度化过程的定义出发 $W^{(n)}(t)=\\frac{1}{\\sqrt{n}}S_{\\lfloor nt \\rfloor}$，其中 $S_{m}=\\sum_{k=1}^{m}X_{k}$ 且 $X_{k}\\in\\{-1,1\\}$ 是独立的，满足 $P(X_{k}=1)=P(X_{k}=-1)=\\frac{1}{2}$。对于整数 $k\\geq 1$，我们有\n$$\nW^{(n)}\\left(\\frac{k}{n}\\right)=\\frac{1}{\\sqrt{n}}S_{k}, \\quad W^{(n)}\\left(\\frac{k-1}{n}\\right)=\\frac{1}{\\sqrt{n}}S_{k-1}.\n$$\n因此，在区间 $\\left[\\frac{k-1}{n},\\frac{k}{n}\\right]$ 上的增量是\n$$\nW^{(n)}\\left(\\frac{k}{n}\\right)-W^{(n)}\\left(\\frac{k-1}{n}\\right)=\\frac{1}{\\sqrt{n}}\\left(S_{k}-S_{k-1}\\right)=\\frac{1}{\\sqrt{n}}X_{k}.\n$$\n将此增量平方可得\n$$\n\\left(W^{(n)}\\left(\\frac{k}{n}\\right)-W^{(n)}\\left(\\frac{k-1}{n}\\right)\\right)^{2}=\\frac{1}{n}X_{k}^{2}.\n$$\n由于 $X_{k}\\in\\{-1,1\\}$，我们对每个 $k$ 都有 $X_{k}^{2}=1$。因此，直至时间 $t$ 的二次变差，\n$$\n[W^{(n)}]_{t}=\\sum_{k=1}^{\\lfloor nt \\rfloor}\\left(W^{(n)}\\left(\\frac{k}{n}\\right)-W^{(n)}\\left(\\frac{k-1}{n}\\right)\\right)^{2},\n$$\n变为\n$$\n[W^{(n)}]_{t}=\\sum_{k=1}^{\\lfloor nt \\rfloor}\\frac{1}{n}X_{k}^{2}=\\sum_{k=1}^{\\lfloor nt \\rfloor}\\frac{1}{n}=\\frac{\\lfloor nt \\rfloor}{n}.\n$$\n这个结果是逐轨（即几乎必然地）成立的，从而得到了二次变差的精确值。", "answer": "$$\\boxed{\\frac{\\lfloor nt \\rfloor}{n}}$$", "id": "1330611"}]}