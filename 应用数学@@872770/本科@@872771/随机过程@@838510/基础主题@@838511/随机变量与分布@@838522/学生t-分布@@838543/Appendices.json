{"hands_on_practices": [{"introduction": "学生t分布的定义是构造性的，理解其构造是掌握其本质的第一步。这个练习将挑战您从最基本的标准正态随机变量出发，一步步构建出一个服从t分布的随机变量[@problem_id:1335741]。这个过程不仅能加深您对理论定义的理解，也揭示了统计模拟中生成复杂分布的基本方法。", "problem": "一位计算科学家需要编写一个函数，该函数用于从具有指定自由度$\\nu$（其中$\\nu$为正整数）的学生t分布中生成随机变量。唯一可用的工具是一个可以从标准正态分布$N(0,1)$中产生独立随机样本的生成器。该科学家提出了几种算法。\n\n下列哪种算法能正确生成一个服从自由度为$\\nu$的学生t分布的随机数$T$？\n\nA. 生成$\\nu+1$个独立的标准正态样本，记为$Z_0, Z_1, \\ldots, Z_\\nu$。计算值$T = \\frac{Z_0}{\\sqrt{\\frac{1}{\\nu} \\sum_{i=1}^{\\nu} Z_i}}$。\n\nB. 生成$\\nu$个独立的标准正态样本，记为$Z_1, \\ldots, Z_\\nu$。计算样本均值$\\bar{Z} = \\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_i$和样本标准差$s = \\sqrt{\\frac{1}{\\nu-1}\\sum_{i=1}^{\\nu} (Z_i - \\bar{Z})^2}$。计算值$T = \\frac{\\bar{Z}}{s / \\sqrt{\\nu}}$。\n\nC. 生成$\\nu+1$个独立的标准正态样本，记为$Z_0, Z_1, \\ldots, Z_\\nu$。计算值$T = \\frac{Z_0}{\\sqrt{\\frac{1}{\\nu} \\sum_{i=1}^{\\nu} Z_i^2}}$。\n\nD. 生成$\\nu$个独立的标准正态样本，记为$Z_1, \\ldots, Z_\\nu$。计算值$T = \\frac{Z_1}{\\sqrt{\\frac{1}{\\nu-1} \\sum_{i=2}^{\\nu} Z_i^2}}$。\n\nE. 生成$\\nu+1$个独立的标准正态样本，记为$Z_0, Z_1, \\ldots, Z_\\nu$。计算值$T = \\frac{Z_0}{\\frac{1}{\\nu} \\sum_{i=1}^{\\nu} Z_i^2}$。", "solution": "目标：确定哪种算法返回一个服从自由度为$\\nu$的学生t分布的随机变量。其定义构造如下：如果$Z \\sim N(0,1)$和$V \\sim \\chi^{2}_{\\nu}$是独立的，那么\n$$\nT \\equiv \\frac{Z}{\\sqrt{V/\\nu}} \\sim t_{\\nu}.\n$$\n此外，如果$Z_{1},\\ldots,Z_{\\nu}$是独立同分布的$N(0,1)$变量，那么$V=\\sum_{i=1}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu}$。另外，对于大小为$n$的正态样本，统计量\n$$\n\\frac{\\bar{Z}-\\mu}{S/\\sqrt{n}} \\sim t_{n-1},\n$$\n其中$S$是样本标准差，且$\\bar{Z}$和$S^{2}$是独立的；此外，当每个观测值的方差为$\\sigma^{2}$时，有$(n-1)S^{2}/\\sigma^{2} \\sim \\chi^{2}_{n-1}$。\n\n分析每个选项：\n\nA. 分母是$\\sqrt{\\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_{i}}$。由于$\\sum_{i=1}^{\\nu} Z_{i} \\sim N(0,\\nu)$，平方根内的量不是几乎必然非负的，因此该表达式没有良好定义，并且肯定不具有$V \\sim \\chi^{2}_{\\nu}$时所需的$\\sqrt{V/\\nu}$形式。这不会生成$t_{\\nu}$。\n\nB. 此处使用了$n=\\nu$个独立同分布的$N(0,1)$样本。根据经典的t统计量结果，\n$$\nT=\\frac{\\bar{Z}}{s/\\sqrt{\\nu}} \\sim t_{\\nu-1},\n$$\n因为$(\\nu-1)s^{2} \\sim \\chi^{2}_{\\nu-1}$且$\\sqrt{\\nu}\\,\\bar{Z} \\sim N(0,1)$，并且两者独立。其自由度为$\\nu-1$，而非$\\nu$，因此这不会生成$t_{\\nu}$。\n\nC. 设$Z_{0},Z_{1},\\ldots,Z_{\\nu}$是独立的$N(0,1)$变量。定义$V=\\sum_{i=1}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu}$，并注意到$Z_{0}$与$V$是独立的。那么\n$$\nT=\\frac{Z_{0}}{\\sqrt{\\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_{i}^{2}}}=\\frac{Z_{0}}{\\sqrt{V/\\nu}} \\sim t_{\\nu},\n$$\n根据定义关系。这是正确的。\n\nD. 设$V=\\sum_{i=2}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu-1}$，且与$Z_{1} \\sim N(0,1)$独立。那么\n$$\nT=\\frac{Z_{1}}{\\sqrt{\\frac{1}{\\nu-1}\\sum_{i=2}^{\\nu} Z_{i}^{2}}}=\\frac{Z_{1}}{\\sqrt{V/(\\nu-1)}} \\sim t_{\\nu-1}.\n$$\n这个分布具有$\\nu-1$个自由度，而不是$\\nu$个，因此它对于生成$t_{\\nu}$是不正确的。\n\nE. 设$V=\\sum_{i=1}^{\\nu} Z_{i}^{2} \\sim \\chi^{2}_{\\nu}$，且与$Z_{0} \\sim N(0,1)$独立。那么\n$$\nT=\\frac{Z_{0}}{\\frac{1}{\\nu}\\sum_{i=1}^{\\nu} Z_{i}^{2}}=\\frac{\\nu Z_{0}}{V}.\n$$\nt分布要求除以$\\sqrt{V/\\nu}$，而不是$V/\\nu$。一个标准正态变量与一个卡方变量（没有开平方根）的比值会得到一个不同的分布，而不是$t_{\\nu}$分布。\n\n结论：只有算法C能生成$t_{\\nu}$。", "answer": "$$\\boxed{C}$$", "id": "1335741"}, {"introduction": "在了解了t分布的构造之后，我们可以进一步探究其数学性质。与方差恒为1的标准正态分布不同，t分布的方差依赖于其自由度 $\\nu$。这个练习将引导您推导并计算t分布的方差[@problem_id:1335699]，从而量化其“重尾”特性，并理解为什么它能更好地描述某些金融数据中的极端波动。", "problem": "一位量化分析师正在开发一个模型，用以描述一种高波动性金融资产的每日价格波动。实证分析表明，标准化日收益率不遵循正态分布，而更适合用具有更重尾部的分布来描述。该分析师提出了一个模型，其中标准化日收益率是一个服从自由度为 $\\nu = 5$ 的学生t分布的随机变量。\n\n为了验证该模型模拟中使用的随机数生成器，该分析师计划从该分布中生成一个非常大的数字序列。根据大数定律，该序列的样本方差应收敛于该分布的理论方差。这个理论方差是多少？\n\n计算一个服从自由度为 $\\nu = 5$ 的学生t分布的随机变量的理论方差。请将您的答案以数字形式给出，并四舍五入到四位有效数字。", "solution": "设 $X$ 是一个自由度为 $\\nu$ 的标准学生t随机变量。其一个标准的表示是\n$$\nX=\\frac{Z}{\\sqrt{V/\\nu}},\n$$\n其中 $Z\\sim \\mathcal{N}(0,1)$，$V\\sim \\chi^{2}_{\\nu}$，且 $Z$ 和 $V$ 相互独立。\n\n对于 $\\nu1$，$E[X]=0$。因此，\n$$\n\\operatorname{Var}(X)=E[X^{2}]-(E[X])^{2}=E[X^{2}].\n$$\n计算\n$$\nE[X^{2}]=E\\!\\left[\\frac{Z^{2}}{V/\\nu}\\right]=\\nu\\,E\\!\\left[Z^{2}V^{-1}\\right].\n$$\n根据 $Z$ 和 $V$ 的独立性，\n$$\nE[X^{2}]=\\nu\\,E[Z^{2}]\\,E[V^{-1}].\n$$\n由于 $Z\\sim \\mathcal{N}(0,1)$，所以 $E[Z^{2}]=1$。对于 $V\\sim \\chi^{2}_{\\nu}$，我们使用 $V$ 服从形状参数为 $a=\\nu/2$、尺度参数为 $b=2$ 的伽马分布这一性质。对于一个伽马$(a,b)$变量，且 $a1$，\n$$\nE[V^{-1}]=\\frac{1}{(a-1)b}.\n$$\n于是，\n$$\nE[V^{-1}]=\\frac{1}{\\left(\\frac{\\nu}{2}-1\\right)\\cdot 2}=\\frac{1}{\\nu-2}.\n$$\n所以，对于 $\\nu2$，\n$$\n\\operatorname{Var}(X)=\\nu\\cdot 1\\cdot \\frac{1}{\\nu-2}=\\frac{\\nu}{\\nu-2}.\n$$\n当 $\\nu=5$ 时，\n$$\n\\operatorname{Var}(X)=\\frac{5}{5-2}=\\frac{5}{3}.\n$$\n四舍五入到四位有效数字，结果是 $1.667$。", "answer": "$$\\boxed{1.667}$$", "id": "1335699"}, {"introduction": "t分布在统计实践中最核心的应用，是在样本量较小且总体方差未知时进行均值假设检验。本练习将您置于一个经典的商业决策场景中：是否采用一种新的生产工艺[@problem_id:1335684]。您将学习如何根据显著性水平和样本量来确定t分布的临界值，这是构建统计检验决策规则的关键一步。", "problem": "一家小批量精品咖啡公司正在试验一种新的烘焙方案，以提高其咖啡豆的质量。咖啡豆的质量采用标准化的100分制进行评分。该公司传统的烘焙方法有一个早已确立的平均质量得分。为了测试新的方案，他们烘焙了16个独立批次的样本，并对其得分进行评估。\n\n公司决定采用一个统计决策规则。只有当样本提供强有力的证据，表明新的平均分确实高于历史平均分时，他们才会改用新的烘焙方案。他们通过从样本数据中计算一个检验统计量$T$来将此规则形式化：\n\n$$\nT = \\frac{\\bar{X} - \\mu_0}{S / \\sqrt{n}}\n$$\n\n在这里，$\\bar{X}$是16个新批次的平均分，$\\mu_0$是历史平均分，$S$是16个新批次得分的标准差，$n$是样本量。\n\n为了最小化转换到一个实际上并未改善的新流程的风险，他们设定了$\\alpha = 0.05$的显著性水平。只有当他们计算出的$T$值超过一个特定的正阈值（我们称之为$t_{crit}$）时，他们才会采用新的方案。这个阈值由学生t分布确定，该分布适用于总体标准差未知的小样本情况。\n\n公司应为其决策使用的这个临界阈值$t_{crit}$的值是多少？\n\nA. 1.753\nB. 2.131\nC. 1.341\nD. 1.746\nE. 2.602", "solution": "问题要求的是使用学生t分布进行单侧假设检验的临界阈值$t_{crit}$。该公司想确定新的烘焙方案是否更好，这意味着他们正在检验平均分是否增加。这对应于一个上尾（或右尾）检验。\n\n临界值是t分布上的一个点，它将“拒绝域”与“非拒绝域”分开。对于显著性水平为$\\alpha$的上尾检验，临界值$t_{crit}$是这样一个值$t_{\\alpha, df}$，使得其右侧尾部的面积等于$\\alpha$。自由度（记为$df$）根据样本量$n$计算。\n\n首先，我们必须确定自由度。在这种情况下，自由度的计算公式是：\n$$\ndf = n - 1\n$$\n鉴于样本量为$n=16$，自由度为：\n$$\ndf = 16 - 1 = 15\n$$\n\n接下来，我们确定显著性水平。问题陈述公司使用的显著性水平为$\\alpha = 0.05$。\n\n我们正在寻找一个上尾临界值。因此，我们需要从具有15个自由度的学生t分布中找到值$t_{crit}$，使得观察到大于或等于$t_{crit}$的t统计量的概率为0.05。这表示为$t_{0.05, 15}$。\n\n我们可以使用标准的t分布表或统计软件找到这个值。查找t分布表中单尾概率为0.05且自由度为15的值，我们可以找到该值。\n\n- 该行对应于$df = 15$。\n- 该列对应于上尾概率$\\alpha = 0.05$。\n\n此行和此列的交点给出了临界t值。\n$$\nt_{crit} = t_{0.05, 15} \\approx 1.753\n$$\n\n这意味着，如果他们从样本中计算出的检验统计量$T$大于1.753，公司就有统计上显著的证据（在5%的显著性水平下）得出新烘焙方案产生更高平均分的结论。\n\n我们来检查其他选项，以理解它们为什么是错误的：\n- B. 2.131: 这是$t_{0.025, 15}$。对于总显著性水平为$\\alpha=0.05$的双侧检验（每个尾部为0.025），这将是正确的临界值。\n- C. 1.341: 这是$t_{0.10, 15}$。它对应于一个较不严格的显著性水平$\\alpha=0.10$。\n- D. 1.746: 这是$t_{0.05, 16}$。这个值是由于将样本量$n$而不是$n-1$用作自由度这个常见错误而导致的。\n- E. 2.602: 这是$t_{0.01, 15}$。它对应于一个更严格的显著性水平$\\alpha=0.01$。\n\n因此，公司决策规则的正确临界阈值是1.753。", "answer": "$$\\boxed{A}$$", "id": "1335684"}]}