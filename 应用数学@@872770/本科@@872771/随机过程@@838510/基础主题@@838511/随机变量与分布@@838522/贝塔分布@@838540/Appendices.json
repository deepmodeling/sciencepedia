{"hands_on_practices": [{"introduction": "要有效地将贝塔分布应用于现实世界，第一步是能够根据我们已有的信息来确定其参数。这个练习将指导您通过一个常见场景，根据期望的市场份额（均值）和其不确定性（方差），来反向求解贝塔分布的形状参数 $\\alpha$ 和 $\\beta$。这个过程被称为矩匹配法，是统计建模中的一项基本技能 [@problem_id:1900165]。", "problem": "一款新软件产品在发布一年后的市场份额是一个介于0（无市场份额）到1（完全主导市场）之间的值。一位市场分析师使用形状参数为 $\\alpha  0$ 和 $\\beta  0$ 的贝塔分布来为这个市场份额（由随机变量 $X$ 表示）的不确定性建模。\n\n根据初步分析和过去类似产品发布的数据，预期市场份额估计为 $0.6$。与此估计相关的方差为 $0.024$。\n\n确定定义此特定贝塔分布的参数 $\\alpha$ 和 $\\beta$ 的精确数值。请将你的答案以有序对 $(\\alpha, \\beta)$ 的形式表示。", "solution": "对于参数为 $\\alpha0$ 和 $\\beta0$ 的贝塔分布，其均值和方差为\n$$\n\\mathbb{E}[X]=\\frac{\\alpha}{\\alpha+\\beta}, \\quad \\operatorname{Var}(X)=\\frac{\\alpha\\beta}{(\\alpha+\\beta)^{2}(\\alpha+\\beta+1)}.\n$$\n已知 $\\mathbb{E}[X]=0.6=\\frac{3}{5}$ 且 $\\operatorname{Var}(X)=0.024=\\frac{3}{125}$，令 $S=\\alpha+\\beta$。则\n$$\n\\alpha=\\frac{3}{5}S, \\quad \\beta=\\frac{2}{5}S.\n$$\n代入方差公式中：\n$$\n\\frac{\\alpha\\beta}{S^{2}(S+1)}=\\frac{\\left(\\frac{3}{5}S\\right)\\left(\\frac{2}{5}S\\right)}{S^{2}(S+1)}=\\frac{6}{25(S+1)}=\\frac{3}{125}.\n$$\n解出 $S$：\n$$\n\\frac{6}{25(S+1)}=\\frac{3}{125}\\;\\Rightarrow\\;6\\cdot 125=3\\cdot 25\\,(S+1)\\;\\Rightarrow\\;750=75(S+1)\\;\\Rightarrow\\;S+1=10\\;\\Rightarrow\\;S=9.\n$$\n因此，\n$$\n\\alpha=\\frac{3}{5}\\cdot 9=\\frac{27}{5}, \\quad \\beta=\\frac{2}{5}\\cdot 9=\\frac{18}{5}.\n$$", "answer": "$$\\boxed{(\\alpha, \\beta) = \\left(\\frac{27}{5}, \\frac{18}{5}\\right)}$$", "id": "1900165"}, {"introduction": "贝塔分布最强大的应用之一是在贝叶斯推断中作为共轭先验。这个练习将让您亲身体验贝叶斯学习的核心过程：我们将一个代表未知成功概率的先验信念（用贝塔分布表示），通过新的实验数据进行更新，从而得到一个更为精确的后验信念。通过这个练习，您将理解贝塔分布如何优雅地量化和更新我们对不确定性的认知 [@problem_id:876]。", "problem": "在贝叶斯统计中，我们通常使用概率分布来对未知的概率参数 $p$ 进行建模。设参数 $p$（表示单次试验成功的概率）的先验信念由Beta分布描述。Beta分布的概率密度函数 (PDF)，记作 $\\text{Beta}(p | \\alpha, \\beta)$，由下式给出：\n$$\nf(p | \\alpha, \\beta) = \\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)} p^{\\alpha-1} (1-p)^{\\beta-1}\n$$\n其中 $0  p  1$，$\\alpha  0$ 和 $\\beta  0$ 是形状参数，$\\Gamma(z)$ 是伽马函数。为了找到后验分布的形状，我们可以使用分布的核，即概率密度函数中依赖于参数 $p$ 的部分：\n$$\nf(p | \\alpha, \\beta) \\propto p^{\\alpha-1} (1-p)^{\\beta-1}\n$$\n\n假设我们对 $p$ 的先验分布是参数为 $\\alpha=2$ 和 $\\beta=2$ 的 $\\text{Beta}(\\alpha, \\beta)$ 分布。\n\n然后我们进行一个包含 $n=10$ 次独立伯努利试验的实验，并观察到 $k=7$ 次成功。对于给定的 $p$，在 $n$ 次试验中观察到 $k$ 次成功的概率由二项分布描述，它作为我们的似然函数：\n$$\nP(D | p) = \\binom{n}{k} p^k (1-p)^{n-k}\n$$\n其中 $D$ 表示观察到的数据（即在 $n$ 次试验中的 $k$ 次成功）。\n\n根据贝叶斯定理，给定数据 $D$ 后 $p$ 的后验分布与似然和先验的乘积成正比：\n$$\n\\text{Posterior}(p | D) \\propto \\text{Likelihood}(D | p) \\times \\text{Prior}(p)\n$$\n\n通过找到后验分布的核，您会发现它也是一个Beta分布，其更新后的参数为 $\\alpha'$ 和 $\\beta'$。服从 $\\text{Beta}(\\alpha', \\beta')$ 分布的随机变量 $p$ 的期望值（均值）由 $E[p] = \\frac{\\alpha'}{\\alpha'+\\beta'}$ 给出。\n\n推导概率参数 $p$ 的后验均值。", "solution": "我们有先验核\n$$\nf(p|\\alpha,\\beta)\\propto p^{\\alpha-1}(1-p)^{\\beta-1}\\,,\n$$\n和似然\n$$\nP(D|p)\\propto p^k(1-p)^{n-k}\\,.\n$$\n根据贝叶斯定理，后验核为\n$$\nf(p|D)\\propto p^{\\alpha-1}(1-p)^{\\beta-1}\\;p^k(1-p)^{n-k}\n= p^{\\alpha-1+k}(1-p)^{\\beta-1+n-k}\\,.\n$$\n因此后验分布是 $\\mathrm{Beta}(\\alpha',\\beta')$，其中\n$$\n\\alpha'=\\alpha+k,\\quad \\beta'=\\beta+n-k.\n$$\n代入 $\\alpha=2,\\;\\beta=2,\\;k=7,\\;n=10$ 得\n$$\n\\alpha'=2+7=9,\\quad \\beta'=2+(10-7)=5,\n$$\n所以后验均值为\n$$\nE[p|D]=\\frac{\\alpha'}{\\alpha'+\\beta'}=\\frac{9}{9+5}=\\frac{9}{14}\\,.\n$$", "answer": "$$\\boxed{\\frac{9}{14}}$$", "id": "876"}, {"introduction": "在许多实际决策中，如 A/B 测试或评估不同系统的性能，我们需要比较两个不确定的量。本练习模拟了一个这样的场景，要求您计算一个随机变量（代表生产线 A 的良率）严格优于另一个随机变量（代表生产线 B 的良率）的概率。这项实践将帮助您掌握处理和比较两个独立的贝塔分布变量的数学工具，这是在不确定性下做出明智决策的关键一步 [@problem_id:1393229]。", "problem": "在一个半导体制造厂中，有两条独立的生产线，A线和B线，用于制造先进的微处理器。每条生产线的质量由其良率来表征，良率是指生产出的非次品芯片的比例。由于制造过程中固有的复杂性和随机波动，这些良率不是恒定值，而是被建模为随机变量。\n\n基于对历史性能数据的广泛分析，质量控制团队将A线的良率（记为 $p_A$）用参数为 $\\alpha_A = 4$ 和 $\\beta_A = 2$ 的贝塔分布（Beta distribution）进行建模。同样地，B线的良率 $p_B$ 用参数为 $\\alpha_B = 3$ 和 $\\beta_B = 3$ 的贝塔分布进行建模。这两个良率在统计上是独立的。\n\n为了给资源分配的战略决策提供信息，管理层需要评估哪条生产线可能表现更优。作为此评估的关键部分，请计算A线的良率严格大于B线的良率的确切概率。\n\n请将您的答案表示为最简分数形式。", "solution": "设 $p_{A}\\sim \\mathrm{Beta}(\\alpha_{A},\\beta_{A})$，其中 $(\\alpha_{A},\\beta_{A})=(4,2)$，且 $p_{B}\\sim \\mathrm{Beta}(\\alpha_{B},\\beta_{B})$，其中 $(\\alpha_{B},\\beta_{B})=(3,3)$，两者独立。我们感兴趣的概率是\n$$\n\\mathbb{P}(p_{A}p_{B})=\\int_{0}^{1} f_{A}(x) F_{B}(x)\\,dx,\n$$\n其中 $f_{A}$ 是 $p_{A}$ 的密度函数，$F_{B}$ 是 $p_{B}$ 的累积分布函数。对于一个 Beta$(a,b)$ 变量，其密度函数为\n$$\nf(x)=\\frac{1}{\\mathrm{B}(a,b)}x^{a-1}(1-x)^{b-1},\\quad \\mathrm{B}(a,b)=\\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}.\n$$\n计算所需的贝塔函数常数：\n$$\n\\mathrm{B}(4,2)=\\frac{\\Gamma(4)\\Gamma(2)}{\\Gamma(6)}=\\frac{3!\\cdot 1!}{5!}=\\frac{6}{120}=\\frac{1}{20},\\quad \\mathrm{B}(3,3)=\\frac{\\Gamma(3)\\Gamma(3)}{\\Gamma(6)}=\\frac{2!\\cdot 2!}{5!}=\\frac{4}{120}=\\frac{1}{30}.\n$$\n因此\n$$\nf_{A}(x)=\\frac{1}{\\mathrm{B}(4,2)}x^{3}(1-x)^{1}=20x^{3}(1-x)=20x^{3}-20x^{4},\n$$\n以及\n$$\nf_{B}(x)=\\frac{1}{\\mathrm{B}(3,3)}x^{2}(1-x)^{2}=30x^{2}(1-2x+x^{2})=30x^{2}-60x^{3}+30x^{4}.\n$$\n对 $f_{B}$ 进行积分得到累积分布函数 CDF\n$$\nF_{B}(x)=\\int_{0}^{x}\\bigl(30t^{2}-60t^{3}+30t^{4}\\bigr)\\,dt=10x^{3}-15x^{4}+6x^{5}.\n$$\n所以，\n$$\n\\mathbb{P}(p_{A}p_{B})=\\int_{0}^{1}\\bigl(20x^{3}-20x^{4}\\bigr)\\bigl(10x^{3}-15x^{4}+6x^{5}\\bigr)\\,dx.\n$$\n展开被积函数：\n$$\n(20x^{3}-20x^{4})(10x^{3}-15x^{4}+6x^{5})=200x^{6}-500x^{7}+420x^{8}-120x^{9}.\n$$\n在 $[0,1]$ 上逐项积分：\n$$\n\\int_{0}^{1}\\left(200x^{6}-500x^{7}+420x^{8}-120x^{9}\\right)dx=\\frac{200}{7}-\\frac{500}{8}+\\frac{420}{9}-\\frac{120}{10}.\n$$\n使用公分母 $42$ 重写：\n$$\n\\frac{200}{7}-\\frac{500}{8}+\\frac{420}{9}-\\frac{120}{10}=\\frac{1200}{42}-\\frac{2625}{42}+\\frac{1960}{42}-\\frac{504}{42}=\\frac{31}{42}.\n$$\n因此，$p_{A}$ 超过 $p_{B}$ 的确切概率是 $\\frac{31}{42}$。", "answer": "$$\\boxed{\\frac{31}{42}}$$", "id": "1393229"}]}