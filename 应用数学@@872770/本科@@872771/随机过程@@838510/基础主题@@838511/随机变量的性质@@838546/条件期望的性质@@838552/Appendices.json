{"hands_on_practices": [{"introduction": "掌握条件期望的最好方法是通过实践来建立直观的理解。这个练习将通过一个熟悉的场景——投掷两枚骰子——为你提供一个坚实的基础。它将引导你通过仔细定义事件空间并应用基本定义来计算条件期望，从而帮助你理解“条件化”是如何改变我们分析问题的样本空间的。[@problem_id:1381964]", "problem": "设 $X_1$ 和 $X_2$ 为独立投掷一枚公平六面骰子两次的结果。每次投掷的可能结果集合为 $\\{1, 2, 3, 4, 5, 6\\}$，每个结果出现的概率为 $1/6$。\n\n定义两个新的随机变量：和 $S = X_1 + X_2$ 与最大值 $M = \\max(X_1, X_2)$。\n\n求在观察到的最大值为 $k$ 的条件下，和 $S$ 的条件期望，其中 $k$ 为满足 $1 \\le k \\le 6$ 的整数。将您的答案表示为 $k$ 的函数。", "solution": "设 $X_{1}$ 和 $X_{2}$ 独立且均匀分布于 $\\{1,2,3,4,5,6\\}$ 上。定义 $S = X_{1} + X_{2}$ 和 $M = \\max(X_{1}, X_{2})$。我们要求解对于 $1 \\leq k \\leq 6$ 的 $\\mathbb{E}[S \\mid M = k]$。\n\n首先，我们描述事件 $\\{M = k\\}$。它包含了所有满足 $1 \\leq i,j \\leq k$ 且至少有一个坐标等于 $k$ 的有序对 $(i,j)$。此类有序对的总数为\n$$\n|\\{(i,j) : \\max(i,j) = k\\}| = k^{2} - (k-1)^{2} = 2k - 1.\n$$\n由于每个有序对的概率为 $\\frac{1}{36}$，并且以 $\\{M=k\\}$ 为条件意味着我们将范围限制在这 $2k-1$ 个等可能性的有序对上，因此在该集合上的条件分布是均匀的。\n\n因此，\n$$\n\\mathbb{E}[S \\mid M = k] = \\frac{1}{2k - 1} \\sum_{\\max(i,j)=k} (i + j).\n$$\n我们将该求和集合划分为两个不相交的子集：\n$$\nB = \\{(k,j) : 1 \\leq j \\leq k\\}, \\quad C = \\{(i,k) : 1 \\leq i \\leq k-1\\},\n$$\n使得 $|B| = k$，$|C| = k-1$，并且 $B \\cap C = \\varnothing$。然后对每个子集的和进行计算：\n$$\n\\sum_{(i,j)\\in B} (i + j) = \\sum_{j=1}^{k} (k + j) = k^{2} + \\frac{k(k+1)}{2},\n$$\n并且\n$$\n\\sum_{(i,j)\\in C} (i + j) = \\sum_{i=1}^{k-1} (i + k) = \\frac{(k-1)k}{2} + k(k-1) = \\frac{3k(k-1)}{2}.\n$$\n因此，在集合 $\\{(i,j): \\max(i,j)=k\\}$ 上的总和为\n$$\n\\left(k^{2} + \\frac{k(k+1)}{2}\\right) + \\left(\\frac{3k(k-1)}{2}\\right) = k^{2} + \\frac{k^2+k+3k^2-3k}{2} = k^{2} + \\frac{4k^2-2k}{2} = k^2 + 2k^2 - k = 3k^{2} - k.\n$$\n将总和除以等可能性对的数量 $2k - 1$ 得到\n$$\n\\mathbb{E}[S \\mid M = k] = \\frac{3k^{2} - k}{2k - 1}.\n$$\n此式对任意满足 $1 \\leq k \\leq 6$ 的整数 $k$ 都成立。", "answer": "$$\\boxed{\\frac{3k^{2} - k}{2k - 1}}$$", "id": "1381964"}, {"introduction": "从离散的骰子游戏过渡到连续的领域，这个问题探索了一个经典的几何概率场景。它要求我们计算在已知一个断点位置的条件下，另一段长度的期望值。这个练习引入了条件概率密度函数的概念，并演示了如何处理顺序统计量——这是概率论中一个常见的强大工具。[@problem_id:1381953]", "problem": "一根长度为 $L$ 的刚性直杆放置在正 x 轴上，一端在原点 ($x=0$)，另一端在 $x=L$。沿杆选择两个点将其折断。这两个断点的位置由两个随机变量 $X_1$ 和 $X_2$ 决定，它们独立地从区间 $[0, L]$ 上的均匀分布中抽取。\n\n这两个断点将杆分成三个较短的段。令 $U$ 为表示离原点较近的断点位置的随机变量，令 $V$ 为表示离原点较远的断点位置的随机变量。因此，我们有 $U = \\min(X_1, X_2)$ 和 $V = \\max(X_1, X_2)$。中间段的长度因此由随机变量 $M = V - U$ 给出。\n\n您的任务是确定中间段长度 $M$ 的条件期望，条件是第一个断点（离原点较近的那个）出现在特定位置 $u$ 处，其中 $0  u  L$。\n\n请用 $L$ 和 $u$ 的符号表达式表示您的答案。", "solution": "设 $X_1$ 和 $X_2$ 是从 $[0, L]$ 上的均匀分布中独立抽取的随机变量。它们的联合概率密度函数 (PDF) 为 $f_{X_1, X_2}(x_1, x_2) = 1/L^2$，定义域为 $[0, L] \\times [0, L]$。\n\n我们感兴趣的是顺序统计量 $U = \\min(X_1, X_2)$ 和 $V = \\max(X_1, X_2)$。它们的联合 PDF $f_{U,V}(u,v)$ 在区域 $0 \\le u  v \\le L$ 上为非零值。可以通过变量变换得到，雅可比行列式的大小为 2，因此对于 $0 \\le u  v \\le L$，$f_{U,V}(u,v) = 2 f_{X_1,X_2}(u,v) = 2/L^2$。\n\n为了计算条件期望 $E[V-U | U=u]$，我们首先需要 $V$ 在给定 $U=u$ 时的条件 PDF $f_{V|U}(v|u)$。这可以通过将联合 PDF 除以 $U$ 的边际 PDF $f_U(u)$ 得到。\n\n$U$ 的边际 PDF 为：\n$$ f_U(u) = \\int_u^L f_{U,V}(u,v) dv = \\int_u^L \\frac{2}{L^2} dv = \\frac{2(L-u)}{L^2}, \\quad \\text{对于 } 0 \\le u \\le L $$\n\n因此，$V$ 的条件 PDF 为：\n$$ f_{V|U}(v|u) = \\frac{f_{U,V}(u,v)}{f_U(u)} = \\frac{2/L^2}{2(L-u)/L^2} = \\frac{1}{L-u}, \\quad \\text{对于 } u  v \\le L $$\n这表明，在给定 $U=u$ 的条件下，$V$ 在区间 $(u, L]$ 上服从均匀分布。\n\n现在我们可以计算在给定 $U=u$ 时 $V$ 的条件期望：\n$$ E[V | U=u] = \\int_u^L v \\cdot f_{V|U}(v|u) dv = \\int_u^L \\frac{v}{L-u} dv = \\frac{1}{L-u} \\left[ \\frac{v^2}{2} \\right]_u^L = \\frac{L^2 - u^2}{2(L-u)} = \\frac{(L-u)(L+u)}{2(L-u)} = \\frac{L+u}{2} $$\n\n最后，我们计算中间段长度 $M = V-U$ 的条件期望：\n$$ E[M | U=u] = E[V-U | U=u] $$\n利用条件期望的线性性：\n$$ E[V-U | U=u] = E[V | U=u] - E[U | U=u] $$\n因为条件是 $U=u$，所以 $E[U | U=u] = u$。代入我们计算出的 $E[V | U=u]$：\n$$ E[M | U=u] = \\frac{L+u}{2} - u = \\frac{L+u-2u}{2} = \\frac{L-u}{2} $$\n因此，给定较近的断点在 $u$ 处，中间段长度的期望值为 $\\frac{L-u}{2}$。", "answer": "$$\\boxed{\\frac{L-u}{2}}$$", "id": "1381953"}, {"introduction": "这个练习将理论与实际应用联系起来，背景设定为一个数字通信中的信号处理问题。它要求你计算一个信号在其能量（即信号幅度的平方，一个非线性变换）给定的条件下的期望。这个练习展示了如何处理更复杂的条件事件，并揭示了一个对于最优信号估计至关重要的、非直观的优美结果。[@problem_id:1327108]", "problem": "在一个数字通信系统中，接收到的信号脉冲的振幅（用随机变量 $V$ 表示）被建模为高斯分布。该信号有一个非零的直流 (DC) 分量 $\\mu$，并受到零均值的加性高斯噪声的干扰，导致总信号的标准差为 $\\sigma$。因此，$V$ 的概率密度函数由 $f_V(v) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(v-\\mu)^2}{2\\sigma^2}\\right)$ 给出，其中 $\\mu$ 和 $\\sigma$ 是正实数常量。\n\n接收机电路中的一个非线性检测器测量一个量 $P$，它等于信号振幅的平方，即 $P = V^2$。为了实现最优的信号重构，有必要根据这个测量值 $P$ 计算原始振幅 $V$ 的最佳估计。在最小化均方误差的意义上，这个最佳估计是给定 $P$ 时 $V$ 的条件期望。\n\n确定条件期望 $E[V | P]$。您的答案应为测量量 $P$、直流分量 $\\mu$ 和标准差 $\\sigma$ 的函数。", "solution": "设 $V \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，其密度为 $f_{V}(v)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(v-\\mu)^{2}}{2\\sigma^{2}}\\right)$，并设 $P=V^{2}$。我们要求解 $E[V \\mid P]$，它必须是 $P$ 的一个可测函数。对于 $p0$，映射 $h(v)=v^{2}$ 有两个原像 $v_{1}=\\sqrt{p}$ 和 $v_{2}=-\\sqrt{p}$，其导数为 $h'(v)=2v$，因此 $|h'(v_{1})|=|h'(v_{2})|=2\\sqrt{p}$。给定 $P=p$ 时 $V$ 的条件分布是在 $\\{\\sqrt{p},-\\sqrt{p}\\}$ 上的离散分布，其概率质量与 $f_{V}(v_{i})$ 成正比。因此，\n$$\nE[V \\mid P=p]\n=\\frac{\\sqrt{p}\\,f_{V}(\\sqrt{p})+(-\\sqrt{p})\\,f_{V}(-\\sqrt{p})}{f_{V}(\\sqrt{p})+f_{V}(-\\sqrt{p})}\n=\\sqrt{p}\\,\\frac{f_{V}(\\sqrt{p})-f_{V}(-\\sqrt{p})}{f_{V}(\\sqrt{p})+f_{V}(-\\sqrt{p})}.\n$$\n使用高斯密度，\n$$\nf_{V}(\\sqrt{p})=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(\\sqrt{p}-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad\nf_{V}(-\\sqrt{p})=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{(\\sqrt{p}+\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n设\n$$\nA=\\exp\\!\\left(-\\frac{(\\sqrt{p}-\\mu)^{2}}{2\\sigma^{2}}\\right),\\quad\nB=\\exp\\!\\left(-\\frac{(\\sqrt{p}+\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n则\n$$\nA=\\exp\\!\\left(-\\frac{p+\\mu^{2}}{2\\sigma^{2}}\\right)\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right),\\quad\nB=\\exp\\!\\left(-\\frac{p+\\mu^{2}}{2\\sigma^{2}}\\right)\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right),\n$$\n所以\n$$\n\\frac{A-B}{A+B}\n=\\frac{\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)-\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)}{\\exp\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)+\\exp\\!\\left(-\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right)}\n=\\tanh\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right).\n$$\n因此，对于 $p0$，\n$$\nE[V \\mid P=p]=\\sqrt{p}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{p}}{\\sigma^{2}}\\right).\n$$\n在 $p=0$ 时，唯一的原像是 $v=0$，因此 $E[V \\mid P=0]=0$，这与上述表达式当 $p \\to 0^{+}$ 时的极限一致。因此，作为测量量 $P$ 的函数，\n$$\nE[V \\mid P]=\\sqrt{P}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{P}}{\\sigma^{2}}\\right).\n$$", "answer": "$$\\boxed{\\sqrt{P}\\,\\tanh\\!\\left(\\frac{\\mu\\sqrt{P}}{\\sigma^{2}}\\right)}$$", "id": "1327108"}]}