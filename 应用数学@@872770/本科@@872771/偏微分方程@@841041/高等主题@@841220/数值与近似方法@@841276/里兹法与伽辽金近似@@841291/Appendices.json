{"hands_on_practices": [{"introduction": "理论是根基，而动手实践则是通向深刻理解的桥梁。我们从一个基础练习开始，使用一个简单的分段线性“帽子函数”作为基函数来近似求解一个边值问题。这个练习将向你展示伽辽金方法如何巧妙地将一个看似复杂的微分方程问题，转化为求解一个未知系数的简单代数问题，这是有限元方法中最基本的思想。[@problem_id:2149993]", "problem": "考虑由微分方程\n$$ -\\frac{d^2u}{dx^2} = 1 $$\n定义的两点边值问题，其定义域为区间 $x \\in [0, 1]$，边界条件为 $u(0) = 0$ 和 $u(1) = 0$。\n\n我们使用伽辽金法求解该问题的近似解。近似解记作 $u_h(x)$，假设它位于由单个基函数 $\\phi(x)$ 张成的空间中。这个基函数通常称为“帽函数”，是一个分段线性函数，定义如下：\n$$\n\\phi(x) = \\begin{cases}\n2x, & \\text{for } 0 \\le x \\le 1/2 \\\\\n2(1-x), & \\text{for } 1/2 \\le x \\le 1\n\\end{cases}\n$$\n近似解的形式为 $u_h(x) = c \\cdot \\phi(x)$，其中 $c$ 是待确定的常系数。\n\n求近似解 $u_h(x)$。答案应为一个关于 $x$ 的完全指定的分段函数。", "solution": "我们用伽辽金法求解该边值问题。对于带有齐次狄利克雷边界条件的 $-u''=1$，其弱形式为：求 $u \\in V$，其中 $V=\\{v \\in H_{0}^{1}(0,1)\\}$，使得\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} 1\\cdot v(x)\\,dx\n$$\n对于所有 $v \\in V$ 成立。使用由 $\\phi$ 张成的一维试验空间，我们取 $u_{h}(x)=c\\,\\phi(x)$ 并用 $v=\\phi$ 进行检验。这给出了伽辽金方程\n$$\n\\int_{0}^{1} (c\\,\\phi'(x))\\,\\phi'(x)\\,dx=\\int_{0}^{1} \\phi(x)\\,dx,\n$$\n化简为\n$$\nc\\int_{0}^{1} \\left(\\phi'(x)\\right)^{2}\\,dx=\\int_{0}^{1} \\phi(x)\\,dx.\n$$\n基函数的导数为 $\\phi'(x)=2$（当 $0 \\le x  1/2$）和 $\\phi'(x)=-2$（当 $1/2  x \\le 1$）。因此，左侧积分为：\n$$\n\\int_{0}^{1} (\\phi'(x))^2 dx = \\int_{0}^{1/2} 2^2 dx + \\int_{1/2}^{1} (-2)^2 dx = 4 \\cdot \\frac{1}{2} + 4 \\cdot \\frac{1}{2} = 4.\n$$\n右侧积分是 $\\phi(x)$ 下方的面积（一个高为1，底为1的三角形）：\n$$\n\\int_{0}^{1} \\phi(x) dx = \\frac{1}{2} \\cdot 1 \\cdot 1 = \\frac{1}{2}.\n$$\n代入伽辽金方程，我们得到 $4c = 1/2$，解得 $c = 1/8$。因此，近似解为 $u_h(x) = \\frac{1}{8}\\phi(x)$。", "answer": "$$\\boxed{u_h(x) = \\begin{cases} \\frac{x}{4},  0 \\le x \\le \\frac{1}{2} \\\\ \\frac{1-x}{4},  \\frac{1}{2} \\le x \\le 1 \\end{cases}}$$", "id": "2149993"}, {"introduction": "单个基函数通常只能提供一个粗略的近似解，为了获得更高的精度，我们需要使用多个基函数的线性组合。这个练习将近似解扩展为两个三角函数的和，你将从中学习如何通过伽辽金法导出一个线性方程组来确定每个基函数的系数。这是从求解单个标量到求解向量的跨越，也是所有现代数值计算软件的核心步骤。[@problem_id:2149992]", "problem": "考虑二阶常微分方程\n$$\n-u''(x) + u(x) = x\n$$\n在区间 $x \\in (0, 1)$ 上，服从齐次边界条件 $u(0) = 0$ 和 $u(1) = 0$。\n\n我们寻求此边值问题的一个形如下式的近似解\n$$\nu_2(x) = c_1 \\sin(\\pi x) + c_2 \\sin(2\\pi x).\n$$\n未知系数 $c_1$ 和 $c_2$ 通过加权余量法确定。具体来说，我们定义一个余量函数 $R(x) = -u_2''(x) + u_2(x) - x$，它衡量近似的误差。通过施加余量与近似中使用的基函数正交的条件来求得这些系数。这导出以下两个方程组成的方程组：\n$$\n\\int_0^1 R(x) \\sin(\\pi x) dx = 0\n$$\n$$\n\\int_0^1 R(x) \\sin(2\\pi x) dx = 0\n$$\n通过求解系数 $c_1$ 和 $c_2$ 来确定近似解 $u_2(x)$。将您的最终答案表示为 $u_2(x)$ 的解析表达式。", "solution": "我们用 $u_{2}(x)=c_{1}\\sin(\\pi x)+c_{2}\\sin(2\\pi x)$ 来近似解，该近似解满足在 $x=0$ 和 $x=1$ 处的齐次边界条件。余量定义为\n$$\nR(x)=-u_{2}''(x)+u_{2}(x)-x.\n$$\n使用 $d^{2}/dx^{2}\\sin(k\\pi x)=-(k\\pi)^{2}\\sin(k\\pi x)$ 计算 $u_{2}''(x)$，因此\n$$\n-u_{2}''(x)+u_{2}(x)=\\left((\\pi^{2}+1)c_{1}\\sin(\\pi x)+((2\\pi)^{2}+1)c_{2}\\sin(2\\pi x)\\right).\n$$\n于是\n$$\nR(x)=(\\pi^{2}+1)c_{1}\\sin(\\pi x)+\\left(4\\pi^{2}+1\\right)c_{2}\\sin(2\\pi x)-x.\n$$\n使用权重 $\\sin(\\pi x)$ 和 $\\sin(2\\pi x)$ 的加权余量条件给出\n$$\n\\int_{0}^{1}R(x)\\sin(\\pi x)\\,dx=0,\\qquad \\int_{0}^{1}R(x)\\sin(2\\pi x)\\,dx=0.\n$$\n利用当 $m\\neq n$ 时的正交性 $\\int_{0}^{1}\\sin(m\\pi x)\\sin(n\\pi x)\\,dx=0$ 以及 $\\int_{0}^{1}\\sin^{2}(n\\pi x)\\,dx=\\frac{1}{2}$，这些方程简化为\n$$\n(\\pi^{2}+1)c_{1}\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx-\\int_{0}^{1}x\\sin(\\pi x)\\,dx=0,\n$$\n$$\n(4\\pi^{2}+1)c_{2}\\int_{0}^{1}\\sin^{2}(2\\pi x)\\,dx-\\int_{0}^{1}x\\sin(2\\pi x)\\,dx=0.\n$$\n因此\n$$\n\\frac{\\pi^{2}+1}{2}\\,c_{1}=I_{1},\\qquad \\frac{4\\pi^{2}+1}{2}\\,c_{2}=I_{2},\n$$\n其中 $I_{n}=\\int_{0}^{1}x\\sin(n\\pi x)\\,dx$。使用分部积分法计算 $I_{n}$：设 $u=x$, $dv=\\sin(n\\pi x)\\,dx$，则 $du=dx$, $v=-\\cos(n\\pi x)/(n\\pi)$，\n$$\nI_{n}=\\left[-\\frac{x\\cos(n\\pi x)}{n\\pi}\\right]_{0}^{1}+\\int_{0}^{1}\\frac{\\cos(n\\pi x)}{n\\pi}\\,dx\n=-\\frac{\\cos(n\\pi)}{n\\pi}+\\left[\\frac{\\sin(n\\pi x)}{(n\\pi)^{2}}\\right]_{0}^{1}.\n$$\n因为 $\\sin(n\\pi)=0$ 且 $\\cos(n\\pi)=(-1)^{n}$，可得\n$$\nI_{n}=-\\frac{(-1)^{n}}{n\\pi}.\n$$\n因此，\n$$\nI_{1}=\\frac{1}{\\pi},\\qquad I_{2}=-\\frac{1}{2\\pi}.\n$$\n求解 $c_{1}$ 和 $c_{2}$ 得\n$$\nc_{1}=\\frac{2I_{1}}{\\pi^{2}+1}=\\frac{2}{\\pi(\\pi^{2}+1)},\\qquad\nc_{2}=\\frac{2I_{2}}{4\\pi^{2}+1}=-\\frac{1}{\\pi(4\\pi^{2}+1)}.\n$$\n因此近似解为\n$$\nu_{2}(x)=\\frac{2}{\\pi(\\pi^{2}+1)}\\sin(\\pi x)-\\frac{1}{\\pi(4\\pi^{2}+1)}\\sin(2\\pi x).\n$$", "answer": "$$\\boxed{\\frac{2}{\\pi(\\pi^{2}+1)}\\sin(\\pi x)-\\frac{1}{\\pi(4\\pi^{2}+1)}\\sin(2\\pi x)}$$", "id": "2149992"}, {"introduction": "伽辽金法的真正威力在于其广泛的适用性，远不止于求解稳态问题。在此高级练习中，我们将挑战一个随时间演化的动态问题——热传导方程。我们将首先使用伽辽金法对空间变量进行离散化，将一个偏微分方程（PDE）转化为一个关于时间的常微分方程（ODE），然后应用数值方法求解该ODE。这个过程被称为“线方法”（Method of Lines），它完美地展示了如何结合不同领域的数学工具来解决复杂的物理问题。[@problem_id:2149984]", "problem": "考虑一维热传导方程，这是一个偏微分方程(PDE)，其形式为 $\\frac{\\partial u}{\\partial t} = \\frac{\\partial^2 u}{\\partial x^2}$，定义在空间域 $x \\in [0, \\pi]$ 和时间 $t  0$ 上。该系统满足齐次狄利克雷边界条件：$u(0, t) = u(\\pi, t) = 0$。\n\n我们使用单项伽辽金法寻求一个形式为 $\\tilde{u}(x, t) = c(t) \\phi(x)$ 的近似解，其中 $c(t)$ 是含时系数，空间基函数选择为 $\\phi(x) = \\sin(x)$ 以满足边界条件。\n\n这个过程会得到一个关于系数 $c(t)$ 的一阶常微分方程(ODE)。为了数值求解该 ODE，我们应用后向欧拉法，并采用均匀时间步长 $\\Delta t$。\n\n令 $c_n$ 表示系数在时间 $t_n = n \\Delta t$ 处的值。请推导全离散代数更新格式，该格式用当前时间步的值 $c_n$ 和时间步长 $\\Delta t$ 来表示下一时间步的系数 $c_{n+1}$。", "solution": "我们将解近似为 $\\tilde{u}(x,t)=c(t)\\phi(x)$，其中 $\\phi(x)=\\sin(x)$，这满足齐次狄利克雷边界条件。对 $u_{t}=u_{xx}$ 使用伽辽金弱形式，方程两边同乘以检验函数 $\\phi$ 并在 $[0,\\pi]$ 上积分，对扩散项进行分部积分（并利用狄利克雷条件使得边界项为零）：\n$$\n\\int_{0}^{\\pi}\\phi(x)\\,\\frac{\\partial \\tilde{u}}{\\partial t}(x,t)\\,dx+\\int_{0}^{\\pi}\\frac{\\partial \\phi}{\\partial x}(x)\\,\\frac{\\partial \\tilde{u}}{\\partial x}(x,t)\\,dx=0.\n$$\n代入 $\\tilde{u}(x,t)=c(t)\\phi(x)$ 得到\n$$\n\\left(\\int_{0}^{\\pi}\\phi^{2}(x)\\,dx\\right)c'(t)+\\left(\\int_{0}^{\\pi}\\left(\\frac{\\partial \\phi}{\\partial x}(x)\\right)^{2}\\,dx\\right)c(t)=0.\n$$\n当 $\\phi(x)=\\sin(x)$ 时，我们有 $\\frac{\\partial \\phi}{\\partial x}(x)=\\cos(x)$，因此\n$$\nM\\,c'(t)+S\\,c(t)=0,\\quad\\text{其中}\\quad M=\\int_{0}^{\\pi}\\sin^{2}(x)\\,dx,\\quad S=\\int_{0}^{\\pi}\\cos^{2}(x)\\,dx.\n$$\n由于对于这个 $\\phi$ 的选择，有 $M=S=\\pi/2$，所以半离散常微分方程简化为\n$$\nc'(t)+c(t)=0.\n$$\n应用步长为 $\\Delta t$ 的后向欧拉法，得到\n$$\n\\frac{c_{n+1}-c_{n}}{\\Delta t}+c_{n+1}=0,\n$$\n整理后得到全离散更新格式\n$$\n(1+\\Delta t)\\,c_{n+1}=c_{n}\\quad\\Longrightarrow\\quad c_{n+1}=\\frac{c_{n}}{1+\\Delta t}.\n$$", "answer": "$$\\boxed{c_{n+1} = \\frac{c_{n}}{1+\\Delta t}}$$", "id": "2149984"}]}