## 引言
在物理学和工程学的广阔领域中，许多系统的行为都由复杂的[微分方程](@entry_id:264184)所描述。然而，要找到这些方程的精确解析解往往是极其困难甚至是不可能的。因此，开发强大而可靠的近似方法成为科学计算的核心任务。[里兹法](@entry_id:168680)（Ritz method）与[伽辽金法](@entry_id:749698)（Galerkin method）正是这类方法中最基本、也最具影响力的两大支柱，它们为[求解微分方程](@entry_id:137471)提供了一条优雅而系统的途径，并构成了现代有限元法（FEM）的理论基石。

本文旨在系统地揭示这两种方法的内在逻辑和强大功能。我们将不再满足于抽象的理论，而是要深入其核心，理解它们如何巧妙地将一个无限维的函数求解问题，转化为一个有限维的、可用计算机高效求解的代数问题。通过本文的学习，你将能够：

*   在“原理与机制”一节中，你将掌握从[微分方程](@entry_id:264184)的强形式出发，如何构建等价的[变分问题](@entry_id:756445)或[弱形式](@entry_id:142897)，并理解[里兹法](@entry_id:168680)与[伽辽金法](@entry_id:749698)背后的数学原理，以及它们最终如何统一于构建“[刚度矩阵](@entry_id:178659)”和“[载荷向量](@entry_id:635284)”的代数系统。
*   在“应用与[交叉](@entry_id:147634)学科联系”一节中，你将看到这些方法如何在[结构力学](@entry_id:276699)、[流体动力学](@entry_id:136788)、量子力学等不同学科中大放异彩，解决从静态变形到动态演化，从线性到[非线性](@entry_id:637147)的各类实际问题。
*   最后，在“动手实践”部分，你将通过一系列精心设计的练习，亲手将理论付诸实践，体验从构建[基函数](@entry_id:170178)到求解[代数方程](@entry_id:272665)的全过程，从而真正内化所学知识。

让我们一同开启这段探索之旅，揭开连接连续物理世界与离散[计算模型](@entry_id:152639)的关键桥梁。

## 原理与机制

在引言的基础上，本章深入探讨近似方法的核心——[里兹法](@entry_id:168680)（Ritz method）与[伽辽金法](@entry_id:749698)（Galerkin method）的数学原理和实施机制。我们将从一个具体的物理问题出发，揭示如何将一个[微分方程](@entry_id:264184)问题转化为一个等价的[变分问题](@entry_id:756445)或[弱形式](@entry_id:142897)问题，并最终归结为一个线性代数方程组的求解。

### 基础：从[微分方程](@entry_id:264184)到[变分原理](@entry_id:198028)

许多物理系统的平衡状态对应于某个能量泛函的最小值。这一深刻的物理原理为求解描述这些系统的[微分方程](@entry_id:264184)提供了另一条途径。[里兹法](@entry_id:168680)正是建立在这一[变分原理](@entry_id:198028)之上的近似方法。

#### [里兹法](@entry_id:168680)：最小化能量

考虑一个经典的物理模型：一根两端固定、长度为单位1的拉紧的弦，在[分布](@entry_id:182848)式载荷 $f(x)$ 作用下的静态变形。其微小竖直位移 $u(x)$ 由以下[二阶常微分方程](@entry_id:204212)描述，我们称之为问题的**强形式 (strong form)**：

$$
-u''(x) = f(x), \quad x \in (0, 1)
$$

边界条件为 $u(0)=0$ 和 $u(1)=0$。

根据[最小势能原理](@entry_id:173340)，系统稳定的平衡状态是使总[势能](@entry_id:748988)达到最小的位移形态。该系统的总[势能](@entry_id:748988)由一个**泛函 (functional)** $J(v)$ 给出，它由两部分组成：弦拉伸产生的内部弹性应变能和外加载荷所做的功 [@problem_id:2150014]：

$$
J(v) = \frac{1}{2} \int_0^1 (v'(x))^2 dx - \int_0^1 f(x)v(x) dx
$$

这里，$v(x)$ 是满足边界条件的任意一个可能的位移函数，称为**容许函数 (admissible function)**。第一项 $\frac{1}{2} \int_0^1 (v'(x))^2 dx$ 代表了弦的应变能，与[位移梯度](@entry_id:165352)的平方成正比。第二项 $- \int_0^1 f(x)v(x) dx$ 代表了外力 $f(x)$ 在位移 $v(x)$ 上所做的功的[相反数](@entry_id:151709)（即[势能](@entry_id:748988)的减少）。寻找[微分方程](@entry_id:264184)的解 $u(x)$ 等价于在所有满足边界条件的容许函数中，寻找一个能使势能泛函 $J(v)$ 最小化的函数。

直接在无限维的[函数空间](@entry_id:143478)中求解这个最小化问题是困难的。[里兹法](@entry_id:168680)的核心思想是，我们不寻找“绝对”最优解，而是在一个精心选择的、由有限个**[基函数](@entry_id:170178) (basis functions)** 张成的**[试探空间](@entry_id:756166) (trial space)** 中寻找一个“相对”最优的近似解。

我们构造一个近似解 $u_h(x)$，它是 $N$ 个已知[基函数](@entry_id:170178) $\phi_j(x)$ 的线性组合：

$$
u_h(x) = \sum_{j=1}^{N} c_j \phi_j(x)
$$

其中，系数 $c_j$ 是待定的未知数。为了保证近似解满足问题的**[本质边界条件](@entry_id:173524) (essential boundary conditions)**（此处为 $u(0)=u(1)=0$），我们要求每个[基函数](@entry_id:170178) $\phi_j(x)$ 都预先满足这些条件，即 $\phi_j(0)=0$ 和 $\phi_j(1)=0$。

将 $u_h(x)$ 代入势能泛函 $J(v)$，泛函就变成了关于未知系数 $c_1, c_2, \dots, c_N$ 的一个普通[多元函数](@entry_id:145643) $J(c_1, \dots, c_N)$。最小化问题就从一个泛函[极值](@entry_id:145933)问题简化为了一个[多元函数](@entry_id:145643)求极值的问题，只需令 $J$ 对每个系数 $c_j$ 的[偏导数](@entry_id:146280)为零即可：

$$
\frac{\partial J}{\partial c_j} = 0, \quad \text{for } j=1, 2, \dots, N
$$

这是一个包含 $N$ 个方程的[代数方程](@entry_id:272665)组，求解它便可得到系数 $c_j$，从而确定近似解 $u_h(x)$。

例如，让我们用最简单的单项近似 $u_h(x) = c_1 \phi_1(x)$ 来求解上述问题，其中[基函数](@entry_id:170178)选为 $\phi_1(x) = x(1-x)$，载荷为 $f(x) = \sin(\pi x)$ [@problem_id:2150014]。此时，势能泛函是关于单个变量 $c_1$ 的函数：

$$
J(c_1) = \frac{1}{2} \int_0^1 (c_1 \phi_1'(x))^2 dx - \int_0^1 \sin(\pi x) (c_1 \phi_1(x)) dx
$$

通过计算积分，可以得到 $J(c_1) = \frac{c_1^2}{6} - c_1 \frac{4}{\pi^3}$。令其导数 $\frac{dJ}{dc_1} = \frac{c_1}{3} - \frac{4}{\pi^3}$ 等于零，我们轻易解得 $c_1 = \frac{12}{\pi^3}$。这样，我们就得到了一个具体的近似解 $u_h(x) = \frac{12}{\pi^3} x(1-x)$。

### 推广至[伽辽金法](@entry_id:749698)

[里兹法](@entry_id:168680)非常直观，但它的应用范围有一个关键限制：它要求[微分方程](@entry_id:264184)的算子必须是**自伴的 (self-adjoint)**，这样才能确保问题等价于某个[势能](@entry_id:748988)泛函的最小化问题。对于更一般的问题，例如包含一阶导数项的[对流-扩散方程](@entry_id:144002)，我们可能无法构造出这样一个势能泛函。

[伽辽金法](@entry_id:749698)提供了一个更通用、更强大的框架，它不依赖于[变分原理](@entry_id:198028)的存在。

#### [弱形式](@entry_id:142897)与加权余量

[伽辽金法](@entry_id:749698)属于一类被称为**[加权余量法](@entry_id:165159) (method of weighted residuals)** 的方法。其基本思想如下：将近似解 $u_h(x)$ 代入原始的[微分方程](@entry_id:264184) $L(u) = f$，由于 $u_h$ 只是一个近似，它通常不会精确地满足方程。代入后会产生一个**余量 (residual)** $R(x)$:

$$
R(x) = L(u_h(x)) - f(x) \neq 0
$$

我们无法让余量在每一点都为零（那将得到精确解），但我们可以要求余量在某种加权平均的意义下为零。[伽辽金法](@entry_id:749698)的独特之处在于，它选取一组**权函数 (weight functions)**，并要求余量与每一个权函数**正交**（即它们的乘积在整个定义域上的积分为零）。最自然的选择，就是使用构造近似解的同一组[基函数](@entry_id:170178) $\{\phi_i(x)\}$作为权函数。这一要求可以表示为：

$$
\int_{\Omega} R(x) \phi_i(x) d\Omega = 0, \quad \text{for each basis function } \phi_i
$$

将余量的表达式代入，我们得到[伽辽金法](@entry_id:749698)的核心方程：

$$
\int_{\Omega} (L(u_h(x)) - f(x)) \phi_i(x) d\Omega = 0
$$

这个方程通常可以通过分部积分（或高维的[格林公式](@entry_id:173118)）进行变换，这一过程至关重要。通过分部积分，我们可以将[微分算子](@entry_id:140145) $L$ 的部分作用从[试探函数](@entry_id:756165) $u_h$ 转移到测试函数 $\phi_i$ 上，从而降低对近似解[光滑性](@entry_id:634843)的要求（例如，从要求二阶可导降低到一阶可导）。变换后的方程形式被称为**[弱形式](@entry_id:142897) (weak form)**。

[弱形式](@entry_id:142897)通常可以抽象地写成：寻找 $u_h \in V_h$（$V_h$ 是[试探函数](@entry_id:756165)空间），使得对于所有测试函数 $v_h \in V_h$ 都有：

$$
a(u_h, v_h) = L(v_h)
$$

其中 $a(\cdot, \cdot)$ 是一个**双线性形式 (bilinear form)**，它通常包含解和测试函数的导数的积分；$L(\cdot)$ 是一个**[线性泛函](@entry_id:276136) (linear functional)**，通常包含源项和边界项。

以一个非自伴问题为例：$-u''(x) + 2u'(x) = 1$，边界条件为 $u(0)=u(1)=0$ [@problem_id:2149971]。这里的[微分算子](@entry_id:140145) $L[u] = -u''+2u'$ 由于包含奇数阶导数项 $2u'$，它不是自伴的，因此无法应用[里兹法](@entry_id:168680)。我们必须使用[伽辽金法](@entry_id:749698)。

伽辽金方程为：
$$
\int_0^1 (-u_h'' + 2u_h' - 1) \phi_i(x) dx = 0
$$
通过对 $-u_h'' \phi_i$ 项进行分部积分，我们得到弱形式：
$$
\int_0^1 (u_h' \phi_i' + 2u_h' \phi_i) dx = \int_0^1 \phi_i(x) dx
$$
这里的[双线性形式](@entry_id:746794)为 $a(u,v) = \int_0^1 (u'v' + 2u'v) dx$。由于 $a(u,v) \neq a(v,u)$，这个双线性形式是**非对称的**。当我们用[基函数](@entry_id:170178)展开 $u_h$ 并代入后，最终得到的[线性方程组](@entry_id:148943) $A\mathbf{c}=\mathbf{b}$ 的[系数矩阵](@entry_id:151473) $A$ 将是非对称的。这正是[伽辽金法](@entry_id:749698)能够处理非自伴问题的直接体现 [@problem_id:2149971]。

### 等价性与内在结构：统一的观点

现在我们来回答一个关键问题：[里兹法](@entry_id:168680)和[伽辽金法](@entry_id:749698)之间有什么联系？

答案是，当微分算子是自伴的时，[里兹法](@entry_id:168680)是[伽辽金法](@entry_id:749698)的一个特例。对于一个[自伴算子](@entry_id:152188)，其对应的[弱形式](@entry_id:142897)中的双线性形式 $a(u,v)$ 是**对称的**，即 $a(u,v)=a(v,u)$ [@problem_id:2679387]。

在这种情况下，我们可以证明，伽辽金方程 $a(u_h, v_h) = L(v_h)$ 正是与势能泛函 $\Pi(v) = \frac{1}{2}a(v,v) - L(v)$ 相关联的[最小化条件](@entry_id:203120)的数学表达。换句话说，令[势能](@entry_id:748988)泛函对系数 $c_j$ 的[偏导数](@entry_id:146280)为零（[里兹法](@entry_id:168680)的步骤），最终得到的[代数方程](@entry_id:272665)组与通过伽辽金弱形式推导出的[方程组](@entry_id:193238)是完全相同的 [@problem_id:2679387]。

因此，我们可以得到一个统一的观点：[伽辽金法](@entry_id:749698)是一个普适的框架，它基于[弱形式](@entry_id:142897)和余量正交原理。当问题恰好是自伴的时，这个[弱形式](@entry_id:142897)恰好对应某个势能泛函的驻值条件，此时[伽辽金法](@entry_id:749698)与[里兹法](@entry_id:168680)殊途同归。

### 实践应用：构建代数系统

无论是[里兹法](@entry_id:168680)还是[伽辽金法](@entry_id:749698)，最终目标都是将一个连续的[微分方程](@entry_id:264184)问题转化为一个离散的线性[代数方程](@entry_id:272665)组 $A\mathbf{c} = \mathbf{b}$。下面我们来具体看看这个系统的构建过程。

#### [刚度矩阵](@entry_id:178659)与[载荷向量](@entry_id:635284)

我们将近似解写为 $u_h(x) = \sum_{j=1}^{N} c_j \phi_j(x)$。将它代入[弱形式](@entry_id:142897) $a(u_h, v_h) = L(v_h)$，并依次令测试函数 $v_h$ 等于每一个[基函数](@entry_id:170178) $\phi_i(x)$ ($i=1, \dots, N$)，我们得到 $N$ 个线性方程：

$$
a\left(\sum_{j=1}^{N} c_j \phi_j, \phi_i\right) = L(\phi_i), \quad \text{for } i=1, \dots, N
$$

利用[双线性形式](@entry_id:746794) $a(\cdot, \cdot)$ 的线性性质，上式可以写为：

$$
\sum_{j=1}^{N} \left(a(\phi_j, \phi_i)\right) c_j = L(\phi_i)
$$

这正是线性方程组 $A\mathbf{c} = \mathbf{b}$ 的分量形式，其中：

- **刚度矩阵 (Stiffness Matrix)** $A$ 的元素为 $A_{ij} = a(\phi_j, \phi_i)$。它反映了[基函数](@entry_id:170178)之间的相互作用，其性质（如对称性）由[微分算子](@entry_id:140145)决定。
- **[载荷向量](@entry_id:635284) (Load Vector)** $\mathbf{b}$ 的元素为 $b_i = L(\phi_i)$。它反映了外加载荷、[源项](@entry_id:269111)以及某些边界条件对系统的影响。
- **未知向量 (Unknown Vector)** $\mathbf{c}$ 的元素为待求的系数 $c_j$。

例如，对于问题 $-u'' = f(x)$，其[弱形式](@entry_id:142897)的[双线性形式](@entry_id:746794)是 $a(u,v) = \int_0^1 u'v' dx$，线性泛函是 $L(v) = \int_0^1 f v dx$。因此，[刚度矩阵](@entry_id:178659)和[载荷向量](@entry_id:635284)的元素为：

$$
A_{ij} = \int_0^1 \phi_j'(x) \phi_i'(x) dx
$$
$$
b_i = \int_0^1 f(x) \phi_i(x) dx
$$

我们可以用一组简单的多项式[基函数](@entry_id:170178)，如 $\phi_1(x) = x(1-x)$ 和 $\phi_2(x) = x^2(1-x)$，来显式地计算[刚度矩阵](@entry_id:178659)的各个元素。通过直接积分，可以得到一个 $2 \times 2$ 的[对称矩阵](@entry_id:143130) [@problem_id:2150011] [@problem_id:2149982]。同样地，对于不同的载荷函数 $f(x)$，例如 $f(x)=x$ 或 $f(x)=x^2$，我们可以计算出[载荷向量](@entry_id:635284)的不同分量 [@problem_id:2150017]。

#### [基函数](@entry_id:170178)的关键作用

[基函数](@entry_id:170178)的选择对近似方法的效率和精度有决定性的影响。一个好的[基函数](@entry_id:170178)集合不仅应该能很好地逼近真实解，还应使计算过程尽可能简化。

一个极具启发性的对比是使用多项式[基函数](@entry_id:170178)与三角函数[基函数](@entry_id:170178) [@problem_id:2149990]。对于问题 $-u''=f$ on $(0,1)$，如果我们选用三角函数基，如 $\phi_j(x) = \sin(j\pi x)$，我们会发现一个非凡的特性。由于[三角函数](@entry_id:178918)的导数（余弦函数）在 $(0,1)$ 区间上具有正交性，即当 $i \neq j$ 时，

$$
A_{ij} = \int_0^1 (\pi j \cos(j\pi x))(\pi i \cos(i\pi x)) dx = 0
$$

这意味着刚度矩阵 $A$ 是一个**对角矩阵**！当[刚度矩阵](@entry_id:178659)是对角阵时，[线性方程组](@entry_id:148943) $A\mathbf{c}=\mathbf{b}$ 的求解变得异常简单，每个系数 $c_i$ 都可以独立地求出：$c_i = b_i / A_{ii}$。这与[傅里叶级数](@entry_id:139455)的思想一脉相承，并揭示了选择**[正交基](@entry_id:264024)底**的巨大威力。相比之下，多项式[基函数](@entry_id:170178)通常不是正交的，会导致一个满秩的、耦合的刚度矩阵，求解起来更为复杂。

### 理论保证与进阶主题

[伽辽金法](@entry_id:749698)不仅是一个实用的计算工具，其背后还有着坚实的数学理论，保证了其解的质量。

#### [伽辽金正交性](@entry_id:173536)：“最佳”近似

[伽辽金法](@entry_id:749698)的一个最核心的理论结果是**[伽辽金正交性](@entry_id:173536) (Galerkin Orthogonality)**。令 $u$ 为[微分方程](@entry_id:264184)的精确解，$u_h$ 为[伽辽金近似](@entry_id:171392)解。它们都满足弱形式，只是范围不同：
- 精确解：$a(u, v) = L(v)$ 对所有容许函数 $v$ 成立。
- 近似解：$a(u_h, v_h) = L(v_h)$ 对所有[试探空间](@entry_id:756166) $V_h$ 中的函数 $v_h$ 成立。

由于[试探空间](@entry_id:756166) $V_h$ 是整个容许函数空间的一个[子集](@entry_id:261956)，所以精确解 $u$ 对于 $V_h$ 中的函数也满足弱形式，即 $a(u, v_h) = L(v_h)$。将此式与近似解的方程相减，我们得到：

$$
a(u, v_h) - a(u_h, v_h) = 0
$$

利用双线性形式的线性性质，便可得到[伽辽金正交性](@entry_id:173536)条件 [@problem_id:2149977]：

$$
a(u - u_h, v_h) = 0, \quad \text{for all } v_h \in V_h
$$

这个公式的含义是，近似解的误差 $e = u - u_h$ 与[试探空间](@entry_id:756166) $V_h$ 中的任何函数，在由[双线性形式](@entry_id:746794) $a(\cdot,\cdot)$ 定义的“[能量内积](@entry_id:167297)”意义下是**正交的**。这进一步可以证明，在能量范数 $\|v\|_a = \sqrt{a(v,v)}$ 的度量下，伽辽金解 $u_h$ 是在整个[试探空间](@entry_id:756166) $V_h$ 中对精确解 $u$ 的**最佳近似**。

#### 边界条件的处理

在实际问题中，边界条件的处理至关重要。

首先，我们区分**[本质边界条件](@entry_id:173524) (essential boundary conditions)** 和**自然边界条件 (natural boundary conditions)**。[本质边界条件](@entry_id:173524)（如[狄利克雷条件](@entry_id:137096)，指定解的值 $u=g$）必须由[试探函数](@entry_id:756165)空间中的函数显式满足。而自然边界条件（如诺依曼条件，指定解的[法向导数](@entry_id:169511) $\frac{\partial u}{\partial n}=g$）则无需[试探函数](@entry_id:756165)满足，它们会作为[分部积分](@entry_id:136350)过程的一部分被“自然地”包含在[弱形式](@entry_id:142897)中。

例如，在二维泊松问题 $-\nabla^2 u = 1$ 中，如果边界的一部分为诺依曼边界 $\frac{\partial u}{\partial n}=0$ [@problem_id:2150028]，我们在推导弱形式时，通过[格林公式](@entry_id:173118)会产生边界积分项 $\int_{\partial \Omega} \frac{\partial u}{\partial n} v dS$。对于零诺依曼边界，此项直接为零，因此自然边界条件被自动满足，我们无需对[基函数](@entry_id:170178)做任何额外要求。

其次，对于**非齐次[本质边界条件](@entry_id:173524)**（例如 $u(0)=1, u(1)=2$），我们不能再简单地要求[基函数](@entry_id:170178)在边界上为零。一个标准且有效的处理方法是，将解分解为两部分 [@problem_id:2150022]：

$$
u_h(x) = u_{BC}(x) + \sum_{j=1}^{N} c_j \phi_j(x)
$$

这里：
- $u_{BC}(x)$ 是一个已知的、满足[非齐次边界条件](@entry_id:750645)的[简单函数](@entry_id:137521)（例如，对于 $u(0)=1, u(1)=2$，可以取线性函数 $u_{BC}(x) = x+1$）。
- $\phi_j(x)$ 是一组满足相应**齐次**边界条件（即 $\phi_j(0)=0, \phi_j(1)=0$）的[基函数](@entry_id:170178)。
- 待求部分 $\sum c_j \phi_j(x)$ 依然属于一个在边界上为零的[函数空间](@entry_id:143478)。

将这个形式的 $u_h(x)$ 代入弱形式，已知函数 $u_{BC}(x)$ 的贡献会被移到[方程组](@entry_id:193238)的右边，成为[载荷向量](@entry_id:635284)的一部分，而未知系数 $c_j$ 的求解过程与齐次问题完全类似。通过这种方式，我们可以将非齐次边界问题转化为一个等价的、但具有修正[载荷向量](@entry_id:635284)的齐次边界问题进行求解。