{"hands_on_practices": [{"introduction": "我们从基础的热传导方程开始。这个练习使用显式的FTCS（时间前向，空间中心）方法，这是一种直观的离散化技术。本练习的目标是让你看到，数值稳定性条件不仅仅是一个数学上的限制，它与一个基本的物理原理——极值原理——紧密相连，该原理指出热量不会自发地在没有热源的区域产生新的最高温点。[@problem_id:2114210]", "problem": "一根长度为 $L=1.0$ 米的一维金属杆，其热扩散系数为 $\\alpha = 0.01$ 米$^2$/秒。杆中的温度分布 $u(x,t)$ 由热传导方程 $u_t = \\alpha u_{xx}$ 控制。\n\n我们希望使用显式向前时间中心空间 (FTCS) 数值方法来模拟温度演化。该杆被离散为 $J=5$ 个相等的子区间，得到的空间步长为 $\\Delta x = L/J$。模拟使用的时间步长为 $\\Delta t=1.6$ 秒。对于内部空间节点 $j$，FTCS 格式由下式给出：\n$$u_j^{n+1} = u_j^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n其中 $u_j^n$ 是在空间网格点 $x_j = j \\Delta x$ 和时间 $t_n = n \\Delta t$ 处温度的数值近似。\n\n在 $t=0$ 时，杆上的初始温度分布由以下函数给出：\n$$ u(x, 0) = \\begin{cases} 300 + 100x  \\text{对于 } 0 \\le x \\le 0.6 \\\\ 360  \\text{对于 } 0.6  x \\le 1.0 \\end{cases} $$\n其中温度单位为开尔文，$x$ 的单位为米。\n\n对于所有时间 $t  0$，杆的两端保持恒定温度，施加如下边界条件：\n- $u(0, t) = 300$ K\n- $u(1.0, t) = 375$ K\n\n数值解 $u_j^n$ 在相应的网格点上被设定以匹配这些初始条件和边界条件。具体来说，$u_j^0$ 由 $u(x_j, 0)$ 确定，并且对于所有时间步 $n \\ge 0$，有 $u_0^n = 300$ K 和 $u_J^n = 375$ K。\n\n假设模拟运行很长时间，杆上任何网格点所能达到的最高温度是多少？以开尔文为单位表示您的答案，并四舍五入到四位有效数字。", "solution": "我们将长度为 $L$ 的杆离散化为 $J=5$ 个相等的子区间，因此空间步长为\n$$\n\\Delta x=\\frac{L}{J}=\\frac{1.0}{5}=0.2\n$$\n。时间步长为 $\\Delta t=1.6$ 且热扩散系数为 $\\alpha=0.01$，内部节点的 FTCS 格式可以写为\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right) =(1-2r)u_{j}^{n}+r u_{j-1}^{n}+r u_{j+1}^{n}\n$$\n，其中\n$$\nr=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}=\\frac{0.01\\times 1.6}{(0.2)^{2}}=\\frac{0.016}{0.04}=0.4\n$$\n。由于 $r\\leq \\frac{1}{2}$，系数 $(1-2r), r, r$ 是非负的且其和为 1，这使得 $u_{j}^{n+1}$ 成为 $u_{j-1}^{n}$、$u_{j}^{n}$ 和 $u_{j+1}^{n}$ 的凸组合。这确保了离散极值原理：内部不会产生新的极大值，并且在时间 $t_{n+1}$ 时所有网格点上的最大值不会超过时间 $t_{n}$ 时所有网格点上的最大值（包括边界值）。\n\n对于所有 $n\\geq 0$，边界条件设定为 $u_{0}^{n}=300$ 和 $u_{J}^{n}=375$。因此，在每个时间层 $n$，所有网格点上的全局最大值最多为 $375$，并且实际上是在右边界节点 $j=J$ 处取得的，因为对于所有 $n$ 都有 $u_{J}^{n}=375$。因此，任何网格点所能达到的最高温度是 $375$。\n\n当 $t\\to\\infty$ 时，数值解收敛到求解 $u_{xx}=0$ 且满足 $u(0)=300$ 和 $u(1)=375$ 的稳态线性分布，该分布在内部的取值严格小于 $375$，仅在 $x=1$ 处达到 $375$。因此，任何时候内部都不会出现超过 $375$ 的过冲。\n\n因此，杆上任何网格点所能达到的最高温度是 $375$ K。四舍五入到四位有效数字，即为 $375.0$。", "answer": "$$\\boxed{375.0}$$", "id": "2114210"}, {"introduction": "接下来我们转向波动方程，它是双曲型系统的原型。我们将探索一种隐式方法，它通常比许多显式格式具有更好的稳定性。这里的重点是将离散化的偏微分方程转化为一个矩阵方程——这是实现过程中的关键步骤——并识别该矩阵的结构，这对于高效求解至关重要。[@problem_id:2114199]", "problem": "考虑一维波动方程 $u_{tt} = c^2 u_{xx}$，该方程模拟了振动弦在位置 $x$ 和时间 $t$ 的位移 $u(x,t)$。波速为常数，$c  0$。弦的长度为 $L$，两端固定，这对应于对所有时间 $t \\ge 0$ 的齐次狄利克雷边界条件 $u(0, t) = 0$ 和 $u(L, t) = 0$。\n\n为了数值求解此方程，使用间距为 $\\Delta x$ 的均匀空间网格和间距为 $\\Delta t$ 的均匀时间网格对时空域进行离散化。网格点记为 $(x_i, t_n) = (i\\Delta x, n\\Delta t)$，在这些点上解的数值近似为 $u_i^n \\approx u(x_i, t_n)$。内部空间点的索引从 $i=1$ 到 $N_x-1$，其中 $L = N_x \\Delta x$。\n\n构建一个全隐式有限差分格式来近似解。在此格式中，关于时间的二阶偏导数 $u_{tt}$ 由以时间 $t_n$ 为中心的二阶精度中心差分来近似。关于空间的二阶偏导数 $u_{xx}$ 由完全在未来时间层 $t_{n+1}$ 上计算的二阶精度中心差分来近似。\n\n对于每个时间步，此数值格式会为未知位移 $\\mathbf{u}^{n+1} = [u_1^{n+1}, u_2^{n+1}, \\dots, u_{N_x-1}^{n+1}]^T$ 产生一个线性方程组。该系统可以写成矩阵形式 $A \\mathbf{u}^{n+1} = \\mathbf{b}$，其中 $A$ 是一个 $(N_x-1) \\times (N_x-1)$ 的矩阵，其元素取决于离散化参数，而 $\\mathbf{b}$ 是一个由先前时间层上的已知值组成的向量。所得到的矩阵 $A$ 是一个常系数三对角矩阵。\n\n设 $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ 是关联网格间距和波速的无量纲参数。矩阵 $A$ 的三条非零对角线具有恒定的值。确定这些值。最终答案由三个表达式组成，分别对应于次对角线元素 ($a$)、主对角线元素 ($d$) 和超对角线元素 ($c$)。请将这三个表达式以行矩阵的形式给出。", "solution": "我们从一维波动方程 $u_{tt}=c^{2}u_{xx}$（在 $x\\in[0,L]$ 上）和齐次狄利克雷边界条件 $u(0,t)=0$ 及 $u(L,t)=0$ 开始。在均匀网格 $(x_{i},t_{n})=(i\\Delta x,n\\Delta t)$ 上，我们近似\n$$\nu_{tt}(x_{i},t_{n})\\approx \\frac{u_{i}^{n+1}-2u_{i}^{n}+u_{i}^{n-1}}{\\Delta t^{2}},\n\\qquad\nu_{xx}(x_{i},t_{n+1})\\approx \\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}\n$$\n。指定的全隐式格式为\n$$\n\\frac{u_{i}^{n+1}-2u_{i}^{n}+u_{i}^{n-1}}{\\Delta t^{2}}=c^{2}\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}\n$$\n。将时间层 $n+1$ 的未知数收集到左侧，重写后得到\n$$\n\\left(\\frac{1}{\\Delta t^{2}}+\\frac{2c^{2}}{\\Delta x^{2}}\\right)u_{i}^{n+1}\n-\\frac{c^{2}}{\\Delta x^{2}}u_{i-1}^{n+1}\n-\\frac{c^{2}}{\\Delta x^{2}}u_{i+1}^{n+1}\n=\\frac{2}{\\Delta t^{2}}u_{i}^{n}-\\frac{1}{\\Delta t^{2}}u_{i}^{n-1}\n$$\n。引入无量纲参数 $\\lambda=\\frac{c\\Delta t}{\\Delta x}$ 并将两边同乘以 $\\Delta t^{2}$，我们得到\n$$\n(1+2\\lambda^{2})u_{i}^{n+1}-\\lambda^{2}u_{i-1}^{n+1}-\\lambda^{2}u_{i+1}^{n+1}\n=2u_{i}^{n}-u_{i}^{n-1}\n$$\n。因此，在 $A\\mathbf{u}^{n+1}=\\mathbf{b}$ 中的三对角矩阵 $A$ 具有常数元素：\n- 次对角线元素 $a=-\\lambda^{2}$，\n- 主对角线元素 $d=1+2\\lambda^{2}$，\n- 超对角线元素 $c=-\\lambda^{2}$。\n由于边界条件是齐次狄利克雷条件，这些系数中不会出现额外的与边界相关的项。", "answer": "$$\\boxed{\\begin{pmatrix}-\\lambda^{2}  1+2\\lambda^{2}  -\\lambda^{2}\\end{pmatrix}}$$", "id": "2114199"}, {"introduction": "最后的练习将挑战一个更高级的情景：一个带有非局部积分项的扩散方程。这类项出现在某些模型中，其中一个点的变化取决于整个系统的状态。我们将看到这个非局部特性如何将标准扩散问题中的简单三对角矩阵，转变为一个具有特殊且在计算上意义重大的结构的稠密矩阵。[@problem_id:2114206]", "problem": "考虑一个一维系统，其状态 $u(x,t)$ 根据以下非局域扩散方程演化：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + \\alpha \\int_0^L u(x,t) \\,dx\n$$\n该系统定义在空间域 $x \\in [0, L]$ 上，时间 $t  0$。物理参数 $D$、$\\alpha$ 和 $L$ 均为正常数。系统满足齐次狄利克雷边界条件，即对所有 $t  0$ 有 $u(0, t) = 0$ 和 $u(L, t) = 0$，并从给定的初始状态 $u(x, 0) = f(x)$ 开始。\n\n为了数值求解此问题，我们对区域进行离散化。我们使用均匀空间网格 $x_j = j \\Delta x$，$j = 0, 1, \\dots, N$，其中 $N \\Delta x = L$。时间被离散为 $t^n = n \\Delta t$。$u(x_j, t^n)$ 的数值近似值记为 $u_j^n$。\n\n我们采用一种称为后向时间、中心空间 (BTCS) 差分格式的隐式有限差分法。具体来说：\n- 时间导数 $\\frac{\\partial u}{\\partial t}$ 在点 $(x_j, t^{n+1})$ 处使用一阶后向差分进行近似。\n- 空间导数 $\\frac{\\partial^2 u}{\\partial x^2}$ 在点 $(x_j, t^{n+1})$ 处使用二阶中心差分进行近似。\n- 积分项 $\\int_0^L u(x,t) \\,dx$ 在时间 $t^{n+1}$ 处使用梯形法则在所有空间网格点 $x_0, x_1, \\dots, x_N$ 上进行近似。\n\n该格式产生了一个线性方程组，在每个时间步都必须求解该方程组，以找到内部点的未知值。这些未知值由向量 $\\mathbf{u}^{n+1} = (u_1^{n+1}, u_2^{n+1}, \\dots, u_{N-1}^{n+1})^T$ 表示。该系统可以写成矩阵形式 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$，其中矩阵 $A$ 是一个 $(N-1) \\times (N-1)$ 的矩阵，向量 $\\mathbf{b}^n$ 取决于前一个时间步的已知值 $\\mathbf{u}^n$。\n\n假设 $\\alpha \\neq 0$，以下哪个选项最能描述矩阵 $A$ 的结构？\n\nA. 严格三对角矩阵。\n\nB. 稠密的非对称矩阵。\n\nC. 稠密的对称矩阵，且不能表示为稀疏矩阵的低秩更新。\n\nD. 三对角矩阵的秩一修正。\n\nE. 对角矩阵。", "solution": "问题要求确定由给定非局域偏微分方程的隐式有限差分离散化所产生的线性系统 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$ 中矩阵 $A$ 的结构。\n\n偏微分方程为：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + \\alpha \\int_0^L u(x,t) \\,dx\n$$\n\n我们将指定的数值近似方法应用于通用内部网格点 $(x_j, t^{n+1})$，$j = 1, 2, \\dots, N-1$。\n\n1.  **时间导数近似（后向差分）：**\n    $$\n    \\frac{\\partial u}{\\partial t} \\bigg|_{(x_j, t^{n+1})} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n    $$\n\n2.  **空间导数近似（中心差分）：** 由于该格式是隐式的，我们在时间层 $n+1$ 上计算此项。\n    $$\n    \\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{(x_j, t^{n+1})} \\approx \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2}\n    $$\n\n3.  **积分项近似（梯形法则）：** 在时间 $t^{n+1}$ 处的积分近似为：\n    $$\n    \\int_0^L u(x, t^{n+1}) \\,dx \\approx \\Delta x \\left( \\frac{1}{2}u_0^{n+1} + \\sum_{k=1}^{N-1} u_k^{n+1} + \\frac{1}{2}u_N^{n+1} \\right)\n    $$\n    问题陈述了齐次狄利克雷边界条件，$u(0,t)=0$ 和 $u(L,t)=0$。在我们的离散表示法中，这意味着对所有 $n$都有 $u_0^n = 0$ 和 $u_N^n = 0$。因此，积分近似简化为：\n    $$\n    \\int_0^L u(x, t^{n+1}) \\,dx \\approx \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1}\n    $$\n\n现在，我们将这些近似代入原始偏微分方程中：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = D \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right) + \\alpha \\left( \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1} \\right)\n$$\n我们的目标是将其整理成 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$ 的形式。这意味着我们必须将所有包含 $u^{n+1}$ 的项移到左侧（LHS），并将所有包含 $u^n$ 的项移到右侧（RHS）。\n\n将整个方程乘以 $\\Delta t$：\n$$\nu_j^{n+1} - u_j^n = \\frac{D \\Delta t}{(\\Delta x)^2} (u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) + \\alpha \\Delta t \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1}\n$$\n我们定义扩散数 $r = \\frac{D \\Delta t}{(\\Delta x)^2}$ 和积分部分的常数 $C = \\alpha \\Delta t \\Delta x$。方程变为：\n$$\nu_j^{n+1} - u_j^n = r (u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) + C \\sum_{k=1}^{N-1} u_k^{n+1}\n$$\n重新整理，将 $u^{n+1}$ 项组合到左侧：\n$$\n-r u_{j-1}^{n+1} + (1+2r) u_j^{n+1} - r u_{j+1}^{n+1} - C \\sum_{k=1}^{N-1} u_k^{n+1} = u_j^n\n$$\n该方程对每个 $j = 1, 2, \\dots, N-1$ 都成立。这是我们线性系统 $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$ 的第 $j$ 行。向量 $\\mathbf{b}^n$ 就是 $\\mathbf{u}^n$。我们需要确定矩阵 $A$ 的元素 $A_{jk}$。元素 $A_{jk}$ 是第 $j$ 个方程中 $u_k^{n+1}$ 的系数。\n\n我们来分析这些系数：\n前三项 $-r u_{j-1}^{n+1} + (1+2r) u_j^{n+1} - r u_{j+1}^{n+1}$ 构成一个标准的三对角结构。我们将这部分的矩阵称为 $T$。其元素为：\n$T_{j,j-1} = -r$\n$T_{j,j} = 1+2r$\n$T_{j,j+1} = -r$\n$T_{jk} = 0$ for $|j-k|1$。\n\n积分项 $- C \\sum_{k=1}^{N-1} u_k^{n+1}$ 对矩阵 $A$ 的第 $j$ 行中的每个元素都有贡献。对于第 $j$ 个方程，任何 $u_k^{n+1}$（其中 $k=1, \\dots, N-1$）的系数都减少了 $C$。这个贡献可以表示为一个矩阵 $M$，其中每个元素 $M_{jk} = C$。\n\n因此，总矩阵 $A$ 是这两部分之差：$A = T - M$。\n$A$ 的元素是：\n$A_{jk} = T_{jk} - M_{jk} = T_{jk} - C$。\n具体来说：\n-   当 $k = j-1$ 时：$A_{j, j-1} = -r - C$\n-   当 $k = j$ 时：$A_{j,j} = 1+2r - C$\n-   当 $k = j+1$ 时：$A_{j, j+1} = -r - C$\n-   当 $|j-k|  1$ 时：$A_{jk} = 0 - C = -C$\n\n由于 $\\alpha \\neq 0$ 且其他常数为正，所以 $C \\neq 0$。因此，矩阵 $A$ （通常）处处都有非零项。这意味着矩阵 $A$ 是 **稠密** 的。这就排除了选项 A（三对角）和 E（对角）。\n\n现在我们更仔细地研究其结构。所有元素均为 $C$ 的矩阵 $M$ 可以写成一个外积：$M = C (\\mathbf{1} \\cdot \\mathbf{1}^T)$，其中 $\\mathbf{1}$ 是一个所有元素都为 1 的 $(N-1) \\times 1$ 列向量。一个可以表示为两个向量外积的矩阵是一个秩一矩阵。\n因此，矩阵 $A = T - C(\\mathbf{1} \\cdot \\mathbf{1}^T)$ 是一个 **三对角矩阵** ($T$) 的 **秩一修正**。这与选项 D 相符。\n\n我们检查其他选项以确认 D 是最佳描述。\n-   **对称性（选项 B）：** 三对角矩阵 $T$ 是对称的。秩一矩阵 $M = C(\\mathbf{1} \\cdot \\mathbf{1}^T)$ 也是对称的。两个对称矩阵的差是对称的。因此，$A$ 是一个对称矩阵。这排除了选项 B（非对称）。\n-   **秩一更新（选项 C）：** 我们刚才已经证明了 $A$ *可以* 表示为一个稀疏（三对角）矩阵的秩一更新。因此，选项 C 是不正确的。\n\n将剩下的正确陈述“A 是一个稠密的对称矩阵”与选项 D 进行比较，我们发现选项 D 更具体，信息量更大。它解释了矩阵 *为什么* 是稠密和对称的。它是一个著名稀疏矩阵的秩一更新这一事实是一个更有力的描述，因为它允许使用专门、高效的线性求解器（如 Sherman-Morrison 公式），而不是通用的稠密求解器。因此，选项 D 是对矩阵结构最好、最精确的描述。", "answer": "$$\\boxed{D}$$", "id": "2114206"}]}