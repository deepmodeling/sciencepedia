{"hands_on_practices": [{"introduction": "有限元方法将复杂问题分解为简单的部分，其最基本的技能是学习如何在单个“单元”内近似一个函数。这个练习将指导你如何利用节点值来创建一个给定函数的线性近似，这是理解有限元法如何表示连续场的关键第一步[@problem_id:2115140]。", "problem": "在有限元法 (FEM) 中，一个复杂函数通常在一个大域上被一组更简单的分段多项式函数所近似。这些更简单的函数中的每一个都定义在一个称为有限元的小的、不重叠的子域上。\n\n考虑一个表示空间区间 $[0, 2]$ 的一维线性有限元。一个连续函数 $f(x)$ 在此区间上定义为：\n$$f(x) = (x+1)\\exp(-x)$$\n你的任务是确定函数 $f(x)$ 在这个单元上的线性有限元插值函数，我们将其记为 $u_h(x)$。该插值函数是一个线性函数，其在单元的端点（节点）处与 $f(x)$ 具有相同的值。\n\n将你的答案表示为 $x$ 的函数。", "solution": "我们要求解在区间 $[0,2]$ 上，且在端点处与 $f(x)=(x+1)\\exp(-x)$ 相匹配的线性有限元插值函数 $u_{h}(x)$。对于节点位于 $x_{1}=0$ 和 $x_{2}=2$ 的单一线性单元，拉格朗日形函数为\n$$\nN_{1}(x)=\\frac{x_{2}-x}{x_{2}-x_{1}}, \\qquad N_{2}(x)=\\frac{x-x_{1}}{x_{2}-x_{1}}.\n$$\n插值函数为\n$$\nu_{h}(x)=f(x_{1})\\,N_{1}(x)+f(x_{2})\\,N_{2}(x).\n$$\n计算节点值：\n$$\nf(0)=(0+1)\\exp(0)=1, \\qquad f(2)=(2+1)\\exp(-2)=3\\exp(-2).\n$$\n当 $x_{1}=0$ 且 $x_{2}=2$ 时，形函数变为\n$$\nN_{1}(x)=\\frac{2-x}{2}, \\qquad N_{2}(x)=\\frac{x}{2}.\n$$\n因此，\n$$\nu_{h}(x)=1\\cdot\\frac{2-x}{2}+\\left(3\\exp(-2)\\right)\\cdot\\frac{x}{2}\n=\\frac{2-x}{2}+\\frac{3\\exp(-2)\\,x}{2}\n=1+\\frac{x}{2}\\left(3\\exp(-2)-1\\right).\n$$\n这就是所求的线性插值函数。", "answer": "$$\\boxed{1+\\frac{x}{2}\\left(3\\exp(-2)-1\\right)}$$", "id": "2115140"}, {"introduction": "在掌握了单个单元的处理方法后，下一步是将它们连接起来以模拟一个完整的结构。本练习展示了有限元方法的完整工作流程，从底层的物理原理出发，为一个一维杆组装并求解最终的代数方程组[@problem_id:2405079]。你将看到单个单元的属性如何组合起来，共同预测整个系统的力学行为。", "problem": "一根笔直、均质的棱柱杆沿其轴线占据从 $x=0$ 到 $x=L_1+L_2$ 的区间，并发生微小的轴向变形。该杆具有恒定的横截面积 $A$ 和杨氏模量 $E$。左端 $x=0$ 处固定，右端 $x=L_1+L_2$ 处施加一个集中的轴向载荷 $P$。使用有限元方法 (FEM) 将该杆离散化为 2 个不等长的线性两节点单元：单元 $1$ 跨越 $[0,L_1]$，节点为 $1$ 和 $2$；单元 $2$ 跨越 $[L_1,L_1+L_2]$，节点为 $2$ 和 $3$。杆上没有体力作用。\n\n从一维线弹性力学的第一性原理和平衡的变分（弱）形式出发，为该离散化组装全局刚度矩阵，在固定端施加本质边界条件，并求解得到的线性系统，以确定在施加载荷 $P$ 下节点 $3$ 的轴向位移。\n\n以 $P$、$E$、$A$、$L_1$ 和 $L_2$ 的单个简化符号表达式形式给出最终答案。位移以米为单位表示。如果进行任何中间近似，最终表达式必须是精确的（无舍入）。", "solution": "所述问题是在一维线弹性力学中应用有限元方法的入门级有效、适定问题。所有必要信息，包括几何形状、材料属性、边界条件和特定的离散化方案，均已提供。该问题具有科学依据且客观。我们将继续进行求解。\n\n在没有体力作用下，棱柱杆承受轴向载荷的控制微分方程是平衡的强形式，由下式给出：\n$$\n- \\frac{d}{dx} \\left( EA \\frac{du}{dx} \\right) = 0 \\quad \\text{for } x \\in (0, L_1 + L_2)\n$$\n其中 $u(x)$ 是位置 $x$ 处的轴向位移，$E$ 是杨氏模量，$A$ 是横截面积。边界条件是在固定端的本质（狄利克雷）条件 $u(0) = 0$，以及在加载端的自然（诺伊曼）条件 $EA \\frac{du}{dx}|_{x=L_1+L_2} = P$。\n\n为了推导变分或弱形式，我们将强形式乘以一个满足齐次本质边界条件（即 $v(0)=0$）的足够光滑的检验函数 $v(x)$，并在域 $\\Omega = [0, L_1+L_2]$ 上积分：\n$$\n\\int_{0}^{L_1+L_2} v \\left( - \\frac{d}{dx} \\left( EA \\frac{du}{dx} \\right) \\right) dx = 0\n$$\n应用分部积分法 $\\int w \\, dz = wz - \\int z \\, dw$，令 $w=v$ 且 $dz = - \\frac{d}{dx} (EA \\frac{du}{dx}) dx$，得到：\n$$\n\\int_{0}^{L_1+L_2} EA \\frac{dv}{dx} \\frac{du}{dx} dx - \\left[ v \\left( EA \\frac{du}{dx} \\right) \\right]_{0}^{L_1+L_2} = 0\n$$\n计算边界项，我们有 $v(L_1+L_2) \\left( EA \\frac{du}{dx}|_{x=L_1+L_2} \\right) - v(0) \\left( EA \\frac{du}{dx}|_{x=0} \\right)$。由于 $v(0)=0$ 且自然边界条件为 $EA \\frac{du}{dx}|_{x=L_1+L_2} = P$，弱形式变为：求 $u(x)$ 使得 $u(0)=0$ 并且对于所有容许的检验函数 $v(x)$：\n$$\n\\int_{0}^{L_1+L_2} EA \\frac{dv}{dx} \\frac{du}{dx} dx = v(L_1+L_2) P\n$$\n在有限元方法中，域被离散化为单元。对于一个连接节点 $i$ 和 $j$ 的长度为 $L_e$ 的通用线性两节点杆单元，位移场 $u^{(e)}(x)$ 是通过线性形函数 $N_i(x)$ 和 $N_j(x)$ 从节点位移 $d_i$ 和 $d_j$ 插值得到的：$u^{(e)}(x) = N_i(x) d_i + N_j(x) d_j$。应变-位移矩阵 $\\mathbf{B}^{(e)}$ 将应变 $\\epsilon_x = \\frac{du}{dx}$ 与节点位移向量 $\\mathbf{d}^{(e)} = \\begin{pmatrix} d_i & d_j \\end{pmatrix}^T$ 相关联。对于线性单元，$\\mathbf{B}^{(e)} = \\begin{pmatrix} \\frac{dN_i}{dx} & \\frac{dN_j}{dx} \\end{pmatrix} = \\frac{1}{L_e} \\begin{pmatrix} -1 & 1 \\end{pmatrix}$。\n单元刚度矩阵 $\\mathbf{k}^{(e)}$ 由弱形式的左侧推导得出，并在单元域 $\\Omega_e$ 上积分：\n$$\n\\mathbf{k}^{(e)} = \\int_{\\Omega_e} (\\mathbf{B}^{(e)})^T (EA) \\mathbf{B}^{(e)} dx = \\int_{0}^{L_e} \\frac{1}{L_e} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} (EA) \\frac{1}{L_e} \\begin{pmatrix} -1 & 1 \\end{pmatrix} dx\n$$\n由于 $E$、$A$ 和 $L_e$ 在单元上是常数，这可以简化为：\n$$\n\\mathbf{k}^{(e)} = \\frac{EA}{L_e^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\int_{0}^{L_e} dx = \\frac{EA}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n对于我们这个具有 2 个单元的具体问题：\n单元 1 跨越 $[0, L_1]$，节点为 1 和 2。其长度为 $L_e = L_1$。刚度矩阵为：\n$$\n\\mathbf{k}^{(1)} = \\frac{EA}{L_1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\quad \\text{对应于自由度 } d_1, d_2\n$$\n单元 2 跨越 $[L_1, L_1+L_2]$，节点为 2 和 3。其长度为 $L_e = L_2$。刚度矩阵为：\n$$\n\\mathbf{k}^{(2)} = \\frac{EA}{L_2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\quad \\text{对应于自由度 } d_2, d_3\n$$\n3 节点系统的全局刚度矩阵 $\\mathbf{K}$ 是通过对每个单元的贡献求和来组装的：\n$$\n\\mathbf{K} = \\begin{pmatrix}\n\\frac{EA}{L_1} & -\\frac{EA}{L_1} & 0 \\\\\n-\\frac{EA}{L_1} & \\frac{EA}{L_1} + \\frac{EA}{L_2} & -\\frac{EA}{L_2} \\\\\n0 & -\\frac{EA}{L_2} & \\frac{EA}{L_2}\n\\end{pmatrix} = EA \\begin{pmatrix}\n\\frac{1}{L_1} & -\\frac{1}{L_1} & 0 \\\\\n-\\frac{1}{L_1} & \\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n0 & -\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n$$\n全局线性方程组为 $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$，其中 $\\mathbf{d} = \\begin{pmatrix} d_1 & d_2 & d_3 \\end{pmatrix}^T$ 是全局位移向量，$\\mathbf{F} = \\begin{pmatrix} F_1 & F_2 & F_3 \\end{pmatrix}^T$ 是全局力向量。这里，$F_1$ 是节点 1 处的未知反作用力，$F_2 = 0$ 因为节点 2 处没有施加载荷，$F_3 = P$ 是节点 3 处施加的载荷。该系统为：\n$$\nEA \\begin{pmatrix}\n\\frac{1}{L_1} & -\\frac{1}{L_1} & 0 \\\\\n-\\frac{1}{L_1} & \\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n0 & -\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n\\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\end{pmatrix} =\n\\begin{pmatrix} F_1 \\\\ 0 \\\\ P \\end{pmatrix}\n$$\n我们施加本质边界条件 $d_1 = 0$。这使我们能够使用一个简化的系统来求解未知位移 $d_2$ 和 $d_3$。通过消除第一行和第一列（因为它们与已知位移 $d_1$ 相关联），并在其余方程中设置 $d_1=0$，我们得到：\n$$\nEA \\begin{pmatrix}\n\\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n-\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n\\begin{pmatrix} d_2 \\\\ d_3 \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ P \\end{pmatrix}\n$$\n这给出了两个代数方程：\n$$\n(1) \\quad EA \\left( \\left(\\frac{1}{L_1} + \\frac{1}{L_2}\\right) d_2 - \\frac{1}{L_2} d_3 \\right) = 0\n$$\n$$\n(2) \\quad EA \\left( -\\frac{1}{L_2} d_2 + \\frac{1}{L_2} d_3 \\right) = P\n$$\n从方程 $(2)$，我们可以写出：\n$$\n\\frac{EA}{L_2} (d_3 - d_2) = P \\implies d_3 - d_2 = \\frac{PL_2}{EA}\n$$\n这在物理上是正确的：单元 2 的伸长量是 $d_3-d_2$，它等于 $\\frac{F_{int} L_2}{EA}$，其中单元 2 的内力是 $P$。\n从方程 $(1)$，我们有：\n$$\n\\left(\\frac{L_1 + L_2}{L_1 L_2}\\right) d_2 = \\frac{1}{L_2} d_3 \\implies d_2 = \\frac{L_1}{L_1+L_2} d_3\n$$\n现在我们将 $d_2$ 的这个表达式代入重新整理的方程 $(2)$：\n$$\nd_3 - \\left(\\frac{L_1}{L_1+L_2}\\right) d_3 = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( 1 - \\frac{L_1}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( \\frac{L_1+L_2-L_1}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( \\frac{L_2}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n求解节点 3 的位移 $d_3$，我们发现：\n$$\nd_3 = \\frac{PL_2}{EA} \\left( \\frac{L_1+L_2}{L_2} \\right) = \\frac{P(L_1+L_2)}{EA}\n$$\n结果与长度为 $L_1+L_2$ 的杆的总伸长量的精确解析解相同，这对于此问题是预料之中的，因为对于承受点载荷的一维杆，使用线性单元的有限元解对于节点位移是精确的。单位是 $\\frac{[N][m]}{[N/m^2][m^2]} = [m]$，这对于位移是正确的。", "answer": "$$\n\\boxed{\\frac{P(L_1+L_2)}{EA}}\n$$", "id": "2405079"}, {"introduction": "有限元方法的真正威力是通过计算机编程得以实现的，这个练习要求你将理论步骤转化为一个可执行的程序来求解一个边值问题。通过将你的数值结果与不同网格尺寸下的精确解进行比较，你将对该方法的准确性及其局限性获得实践性的洞察，尤其是在近似振荡型函数时[@problem_id:2405065]。", "problem": "考虑一个由常微分方程 (ODE) $u''(x) + 4\\pi^2 u(x) = 0$ 控制的振荡场的边值问题，该问题定义在闭区间 $[0,1]$ 上，边界条件为 $u(0) = 0$ 和 $u'(1) = 1$。所有三角函数的参数都以弧度为单位。令 $k := 2\\pi$。请构建弱问题，并使用有限元法 (Finite Element Method, FEM) 来近似其解，即在 $[0,1]$ 的 $N$ 个子区间的均匀划分上，使用连续分段线性函数的协调子空间进行有限元分析。对于下面指定的测试套件中的每个 $N$，计算有限元近似解 $u_h$ 并评估以下两个相对误差度量：\n- 相对 $L^2$-误差 $\\frac{\\lVert u_h - u \\rVert_{L^2(0,1)}}{\\lVert u \\rVert_{L^2(0,1)}}$。\n- 相对 $H^1$-半范数误差 $\\frac{\\lVert u_h' - u' \\rVert_{L^2(0,1)}}{\\lVert u' \\rVert_{L^2(0,1)}}$。\n\n你的程序必须从第一性原理出发，推导出给定边界条件的常微分方程的精确解析解，并用它来评估误差。构建方法和评估误差所需的所有积分，都必须以足够的数值精度计算，以确保报告的误差在打印的数字尺度上是可信的。\n\n测试套件（均匀子区间数 $N$）：$\\{1, 2, 4, 10, 32\\}$。\n\n要求的最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目本身都是 $[N,\\ \\text{relative\\_}L^2\\text{\\_error},\\ \\text{relative\\_}H^1\\text{\\_seminorm\\_error}]$ 形式的列表。例如，输出行应具有以下形式\n$[[N_1,e_{L^2}^{(1)},e_{H^1}^{(1)}],[N_2,e_{L^2}^{(2)},e_{H^1}^{(2)}],\\dots]$,\n每个 $e$ 都以浮点数形式报告。不允许有其他输出。", "solution": "所述问题具有科学依据，是适定的、客观的。它提出了一个二阶常微分方程的标准边值问题，并要求使用有限元法（计算工程的基石）来求其近似解。所有需要的数据和条件都已提供，且没有矛盾之处。因此，我们开始求解。\n\n问题是求解以下边值问题 (BVP)：\n$$\nu''(x) + k^2 u(x) = 0, \\quad x \\in [0, 1]\n$$\n其中 $k = 2\\pi$，并满足边界条件 $u(0) = 0$ 和 $u'(1) = 1$。\n\n首先，我们推导精确解析解。给定的常微分方程 (ODE) 是一个齐次线性二阶常系数 ODE。其特征方程为 $r^2 + k^2 = 0$，根为纯虚数 $r = \\pm ik$。因此，通解的形式为：\n$$\nu(x) = A \\cos(kx) + B \\sin(kx)\n$$\n我们应用边界条件来确定常数 $A$ 和 $B$。\n条件 $u(0) = 0$ 意味着：\n$$\nu(0) = A \\cos(0) + B \\sin(0) = A \\cdot 1 + B \\cdot 0 = A = 0\n$$\n解简化为 $u(x) = B \\sin(kx)$。其导数为 $u'(x) = Bk \\cos(kx)$。应用第二个边界条件 $u'(1) = 1$：\n$$\nu'(1) = Bk \\cos(k) = 1\n$$\n代入 $k = 2\\pi$，我们得到 $\\cos(k) = \\cos(2\\pi) = 1$。$B$ 的方程变为：\n$$\nB(2\\pi)(1) = 1 \\implies B = \\frac{1}{2\\pi}\n$$\n因此，精确解析解为：\n$$\nu(x) = \\frac{1}{2\\pi} \\sin(2\\pi x)\n$$\n精确解的导数为：\n$$\nu'(x) = \\cos(2\\pi x)\n$$\n\n接下来，我们构建弱问题。我们将 ODE 乘以一个合适的测试函数 $v(x)$，并在定义域 $[0, 1]$ 上积分：\n$$\n\\int_{0}^{1} (u''(x) + k^2 u(x)) v(x) dx = 0\n$$\n我们对第一项应用分部积分法：\n$$\n\\int_{0}^{1} u''(x)v(x)dx = [u'(x)v(x)]_{0}^{1} - \\int_{0}^{1} u'(x)v'(x)dx\n$$\n积分方程变为：\n$$\n[u'(x)v(x)]_{0}^{1} - \\int_{0}^{1} u'(x)v'(x)dx + k^2\\int_{0}^{1} u(x)v(x)dx = 0\n$$\n边界条件 $u(0)=0$ 是一个本质（或 Dirichlet）边界条件。测试函数空间 $V$ 必须满足相应的齐次边界条件，因此我们要求对于所有 $v \\in V$，都有 $v(0)=0$。边界条件 $u'(1)=1$ 是一个自然（或 Neumann）边界条件，它将被并入弱形式中。\n展开边界项：\n$$\n[u'(x)v(x)]_{0}^{1} = u'(1)v(1) - u'(0)v(0)\n$$\n由于 $v(0)=0$ 且 $u'(1)=1$，此项简化为 $v(1)$。将其代入积分方程得到：\n$$\nv(1) - \\int_{0}^{1} u'(x)v'(x)dx + k^2\\int_{0}^{1} u(x)v(x)dx = 0\n$$\n整理后，弱形式为：求 $u \\in U = \\{w \\in H^1(0,1) \\mid w(0)=0\\}$，使得对于所有测试函数 $v \\in V = U$：\n$$\n\\int_{0}^{1} u'(x)v'(x)dx - k^2\\int_{0}^{1} u(x)v(x)dx = v(1)\n$$\n这可以写成抽象形式 $a(u,v) = L(v)$，其中双线性形式为 $a(u,v) = \\int_{0}^{1} u'(x)v'(x)dx - k^2\\int_{0}^{1} u(x)v(x)dx$，线性泛函为 $L(v) = v(1)$。\n\n对于有限元法 (FEM) 离散化，我们将区间 $[0,1]$ 划分为 $N$ 个长度为 $h = 1/N$ 的均匀子区间。节点为 $x_i = ih$，其中 $i = 0, 1, \\dots, N$。我们使用连续的分段线性函数（帽函数）$\\phi_i(x)$ 基，其定义为 $\\phi_i(x_j) = \\delta_{ij}$。\n由于本质边界条件 $u(0)=0$，有限元试探和测试空间 $V_h$ 由与自由节点相对应的基函数张成：$V_h = \\text{span}\\{\\phi_1, \\phi_2, \\dots, \\phi_N\\}$。\nFEM 近似解 $u_h(x)$ 是这些基函数的线性组合：\n$$\nu_h(x) = \\sum_{j=1}^{N} c_j \\phi_j(x)\n$$\n其中系数 $c_j = u_h(x_j)$ 是未知的节点值。\n将 $u_h$ 代入弱形式，并选择 $v = \\phi_i$（其中 $i = 1, \\dots, N$），我们得到一个线性方程组 $A\\mathbf{c} = \\mathbf{b}$，其中 $\\mathbf{c} = [c_1, \\dots, c_N]^T$。系统矩阵 $A$ 和载荷向量 $\\mathbf{b}$ 的各项为：\n$$\nA_{ij} = a(\\phi_j, \\phi_i) = \\int_{0}^{1} \\phi_j'(x)\\phi_i'(x)dx - k^2\\int_{0}^{1} \\phi_j(x)\\phi_i(x)dx\n$$\n$$\nb_i = L(\\phi_i) = \\phi_i(1)\n$$\n令 $K_{ij} = \\int_{0}^{1} \\phi_j'(x)\\phi_i'(x)dx$ （刚度矩阵）和 $M_{ij} = \\int_{0}^{1} \\phi_j(x)\\phi_i(x)dx$ （质量矩阵）。则 $A = K - k^2 M$。对于均匀网格上的分段线性单元，这些矩阵是三对角的。对于索引为 $i, j \\in \\{1,\\dots,N\\}$ 的节点：\n刚度矩阵 $K$ 为：\n$$\nK = \\frac{1}{h} \\begin{pmatrix}\n2 & -1 & & \\\\\n-1 & 2 & -1 & \\\\\n & \\ddots & \\ddots & \\ddots \\\\\n & & -1 & 2 & -1 \\\\\n & & & -1 & 1\n\\end{pmatrix}_{N \\times N}\n$$\n质量矩阵 $M$ 为：\n$$\nM = \\frac{h}{6} \\begin{pmatrix}\n4 & 1 & & \\\\\n1 & 4 & 1 & \\\\\n & \\ddots & \\ddots & \\ddots \\\\\n & & 1 & 4 & 1 \\\\\n & & & 1 & 2\n\\end{pmatrix}_{N \\times N}\n$$\n载荷向量 $\\mathbf{b}$ 为 $b_i = \\phi_i(x_N) = \\delta_{iN}$，这得到 $\\mathbf{b} = [0, 0, \\dots, 1]^T$。\n在求解方程组 $A\\mathbf{c}=\\mathbf{b}$ 得到系数 $\\mathbf{c}$ 后，便可构建 FEM 解 $u_h(x)$。\n\n最后，我们评估指定的误差度量。\n相对 $L^2$-误差为 $\\frac{\\lVert u_h - u \\rVert_{L^2}}{\\lVert u \\rVert_{L^2}}$。\n相对 $H^1$-半范数误差为 $\\frac{\\lvert u_h - u \\rvert_{H^1}}{\\lvert u \\rvert_{H^1}} = \\frac{\\lVert u_h' - u' \\rVert_{L^2}}{\\lVert u' \\rVert_{L^2}}$。\n精确解的范数平方通过解析计算得出：\n$$\n\\lVert u \\rVert_{L^2(0,1)}^2 = \\int_0^1 \\left(\\frac{1}{2\\pi} \\sin(2\\pi x)\\right)^2 dx = \\frac{1}{4\\pi^2} \\int_0^1 \\sin^2(2\\pi x) dx = \\frac{1}{8\\pi^2}\n$$\n$$\n\\lVert u' \\rVert_{L^2(0,1)}^2 = \\int_0^1 \\cos^2(2\\pi x) dx = \\frac{1}{2}\n$$\n误差范数的平方，即 $\\lVert u_h - u \\rVert_{L^2(0,1)}^2$ 和 $\\lVert u_h' - u' \\rVert_{L^2(0,1)}^2$，通过对每个单元 $[x_{e-1}, x_e]$ 上的积分求和来计算。在每个单元上，$u_h(x)$ 是一个线性多项式，$u_h'(x)$ 是一个常数。涉及超越函数 $u(x)$ 及其导数的积分必须使用高精度数值积分来计算，以确保最终误差值的准确性。实现将对测试套件中的每个 $N$ 值执行这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the given BVP using FEM and calculates errors for a suite of mesh sizes.\n    \"\"\"\n    test_cases = [1, 2, 4, 10, 32]\n    k = 2.0 * np.pi\n    \n    # --- Exact Solution and its Norms ---\n    # u(x) = (1/(2*pi)) * sin(2*pi*x)\n    u_exact = lambda x: (1.0 / k) * np.sin(k * x)\n    # u'(x) = cos(2*pi*x)\n    up_exact = lambda x: np.cos(k * x)\n\n    # Analytical norms\n    # ||u||_L2^2 = 1 / (8*pi^2)\n    norm_u_sq = 1.0 / (2.0 * k**2.0)\n    # ||u'||_L2^2 = 1/2\n    norm_up_sq = 0.5\n\n    results = []\n    for N in test_cases:\n        h = 1.0 / N\n        \n        # --- Assemble System Matrix A = K - k^2 * M ---\n        \n        # Stiffness Matrix K (size N x N)\n        K = np.zeros((N, N))\n        # Diagonal entries\n        diag_K = np.full(N, 2.0 / h)\n        diag_K[-1] = 1.0 / h\n        np.fill_diagonal(K, diag_K)\n        # Off-diagonal entries\n        off_diag_K = np.full(N - 1, -1.0 / h)\n        K[np.arange(N - 1), np.arange(N - 1) + 1] = off_diag_K\n        K[np.arange(N - 1) + 1, np.arange(N - 1)] = off_diag_K\n        \n        # Mass Matrix M (size N x N)\n        M = np.zeros((N, N))\n        # Diagonal entries\n        diag_M = np.full(N, 4.0 * h / 6.0)\n        diag_M[-1] = 2.0 * h / 6.0\n        np.fill_diagonal(M, diag_M)\n        # Off-diagonal entries\n        off_diag_M = np.full(N - 1, h / 6.0)\n        M[np.arange(N - 1), np.arange(N - 1) + 1] = off_diag_M\n        M[np.arange(N - 1) + 1, np.arange(N - 1)] = off_diag_M\n        \n        # System Matrix A\n        A = K - (k**2) * M\n        \n        # --- Assemble Load Vector b ---\n        b = np.zeros(N)\n        b[-1] = 1.0\n        \n        # --- Solve for Coefficients c ---\n        c = np.linalg.solve(A, b)\n        \n        # Prepend the coefficient for the Dirichlet boundary condition u(0)=0\n        c_full = np.insert(c, 0, 0)\n        \n        # --- Calculate Error Norms ---\n        error_L2_sq = 0.0\n        error_H1_semi_sq = 0.0\n        \n        for e in range(N):\n            # Element domain\n            x_left, x_right = e * h, (e + 1) * h\n            \n            # Coefficients for this element\n            c_left, c_right = c_full[e], c_full[e+1]\n            \n            # Define FEM solution and its derivative on the element\n            u_h = lambda x: c_left * (x_right - x) / h + c_right * (x - x_left) / h\n            up_h_val = (c_right - c_left) / h\n            \n            # Define integrands for squared errors\n            integrand_L2 = lambda x: (u_h(x) - u_exact(x))**2\n            integrand_H1_semi = lambda x: (up_h_val - up_exact(x))**2\n            \n            # Integrate over the element using high-precision quadrature\n            err_L2_elem, _ = integrate.quad(integrand_L2, x_left, x_right)\n            err_H1_semi_elem, _ = integrate.quad(integrand_H1_semi, x_left, x_right)\n            \n            error_L2_sq += err_L2_elem\n            error_H1_semi_sq += err_H1_semi_elem\n\n        # --- Calculate Relative Errors ---\n        relative_L2_error = np.sqrt(error_L2_sq / norm_u_sq)\n        relative_H1_seminorm_error = np.sqrt(error_H1_semi_sq / norm_up_sq)\n        \n        results.append(f\"[{N},{relative_L2_error},{relative_H1_seminorm_error}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2405065"}]}