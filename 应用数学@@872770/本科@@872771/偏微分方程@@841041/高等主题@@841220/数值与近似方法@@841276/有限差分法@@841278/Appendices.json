{"hands_on_practices": [{"introduction": "有限差分法通过将微分方程转化为代数方程，让我们能够一步步求解。第一个练习将引导你完成最基本的应用：使用前向时间中心空间（FTCS）格式模拟单个时间增量内的热流。通过基于当前温度计算未来某一时刻的温度 [@problem_id:2171703]，你将对离散化在实践中如何工作获得具体的理解。", "problem": "一位材料工程师正在模拟一根细长、均匀杆上的温度分布，该分布由一维热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$ 控制，其中 $u(x, t)$ 是温度，$\\alpha$ 是材料的热扩散率。\n\n该模拟使用一种数值方法，将杆的长度离散化为一系列网格点，其均匀间距为 $\\Delta x = 0.05 \\, \\text{m}$，时间以大小为 $\\Delta t = 5.0 \\, \\text{s}$ 的离散步长推进。所采用的数值格式是前向时间中心空间（FTCS）方法。杆材料的热扩散率给定为 $\\alpha = 1.11 \\times 10^{-4} \\, \\text{m}^2/\\text{s}$。\n\n在一个特定的时间步 $j$，索引为 $i-1$、$i$ 和 $i+1$ 的三个相邻网格点上的温度测量值为：\n- 点 $i-1$ 处的温度：$u_{i-1}^j = 150.0 \\, ^\\circ\\text{C}$\n- 点 $i$ 处的温度：$u_{i}^j = 120.0 \\, ^\\circ\\text{C}$\n- 点 $i+1$ 处的温度：$u_{i+1}^j = 155.0 \\, ^\\circ\\text{C}$\n\n使用这些信息，计算下一个时间步 $j+1$ 时网格点 $i$ 处的温度 $u_{i}^{j+1}$。请以摄氏度（$^\\circ\\text{C}$）表示答案，并四舍五入到四位有效数字。", "solution": "我们使用 FTCS 离散化的一维热方程 $\\frac{\\partial u}{\\partial t}=\\alpha \\frac{\\partial^{2}u}{\\partial x^{2}}$。将 $\\frac{\\partial u}{\\partial t}$ 近似为 $\\frac{u_{i}^{j+1}-u_{i}^{j}}{\\Delta t}$，并将 $\\frac{\\partial^{2}u}{\\partial x^{2}}$ 近似为 $\\frac{u_{i+1}^{j}-2u_{i}^{j}+u_{i-1}^{j}}{(\\Delta x)^{2}}$，则更新公式为\n$$\nu_{i}^{j+1}=u_{i}^{j}+\\lambda \\left(u_{i+1}^{j}-2u_{i}^{j}+u_{i-1}^{j}\\right),\n$$\n其中\n$$\n\\lambda=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}.\n$$\n已知 $\\alpha=1.11\\times 10^{-4}\\ \\text{m}^{2}\\!/\\text{s}$，$\\Delta t=5.0\\ \\text{s}$，以及 $\\Delta x=0.05\\ \\text{m}$，\n$$\n\\lambda=\\frac{\\left(1.11\\times 10^{-4}\\right)\\left(5.0\\right)}{(0.05)^{2}}=\\frac{5.55\\times 10^{-4}}{2.5\\times 10^{-3}}=\\left(\\frac{5.55}{2.5}\\right)\\times 10^{-1}=2.22\\times 10^{-1}=0.222.\n$$\n使用 $u_{i-1}^{j}=150.0$，$u_{i}^{j}=120.0$ 和 $u_{i+1}^{j}=155.0$（单位为摄氏度），\n$$\nu_{i+1}^{j}-2u_{i}^{j}+u_{i-1}^{j}=155.0-2(120.0)+150.0=65.0,\n$$\n所以\n$$\nu_{i}^{j+1}=120.0+0.222\\times 65.0=120.0+14.43=134.43.\n$$\n四舍五入到四位有效数字，结果为 $134.4$。", "answer": "$$\\boxed{134.4}$$", "id": "2171703"}, {"introduction": "有些问题随时间演化，而另一些则描述处于稳态的系统，例如静电场中的电势，这类问题由拉普拉斯方程等椭圆方程控制。本练习介绍雅可比法，这是一种求解区域离散化后产生的大型方程组的迭代方法 [@problem_id:2172039]。你将执行一次迭代，观察解的初始猜测值是如何开始向正确的分布收敛的。", "problem": "考虑在一个方形无电荷区域内确定静电势 $u(x,y)$ 的问题。该电势满足二维拉普拉斯方程：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0\n$$\n该区域被离散化为一个由点 $(x_i, y_j)$ 组成的均匀网格，其中 $x_i = i \\cdot h$ 且 $y_j = j \\cdot h$，对于 $i,j \\in \\{0, 1, 2, 3\\}$。网格间距 $h$ 是一个常数。该网格产生了四个内部点：$(x_1, y_1)$、$(x_1, y_2)$、$(x_2, y_1)$ 和 $(x_2, y_2)$。设这些网格点上的电势表示为 $u_{ij} = u(x_i, y_j)$。\n\n边界上的电势是固定的。与内部网格点相邻的边界点上的值如下所示：\n- 在左边界上：$u_{0,1} = 21.0$ V 且 $u_{0,2} = 21.0$ V。\n- 在右边界上：$u_{3,1} = 41.0$ V 且 $u_{3,2} = 41.0$ V。\n- 在下边界上：$u_{1,0} = 9.0$ V 且 $u_{2,0} = 9.0$ V。\n- 在上边界上：$u_{1,3} = 81.0$ V 且 $u_{2,3} = 81.0$ V。\n\n拉普拉斯方程使用标准的五点中心差分格式进行近似，该公式将内部点的电势与其四个最近邻点联系起来。使用雅可比法求解得到的线性方程组。\n\n从所有四个内部点（其中 $i,j \\in \\{1,2\\}$）的初始猜测值 $u_{ij}^{(0)} = 0$ V 开始，计算雅可比法一次完整迭代后这些点上电势的数值。\n\n按此特定顺序提供 $u_{11}, u_{12}, u_{21}, u_{22}$ 更新后的电势值。最终答案应为一组四个数字。最终答案中不要包含单位。", "solution": "在均匀网格上使用标准五点中心差分格式离散化的二维拉普拉斯方程，对于内部节点 $(i,j)$，可得：\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^{2}}+\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^{2}}=0,\n$$\n可以简化为平均值关系式\n$$\nu_{i,j}=\\frac{1}{4}\\left(u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}\\right).\n$$\n雅可比迭代使用前一次迭代的邻近点值来更新每个内部点：\n$$\nu_{i,j}^{(k+1)}=\\frac{1}{4}\\left(u_{i+1,j}^{(k)}+u_{i-1,j}^{(k)}+u_{i,j+1}^{(k)}+u_{i,j-1}^{(k)}\\right),\n$$\n其中边界值保持固定。给定初始猜测值 $u_{ij}^{(0)}=0$（对于 $i,j\\in\\{1,2\\}$）和已知的边界数据，第一次迭代的更新如下：\n\n对于 $u_{11}$：\n$$\nu_{11}^{(1)}=\\frac{1}{4}\\left(u_{21}^{(0)}+u_{01}+u_{12}^{(0)}+u_{10}\\right)=\\frac{1}{4}\\left(0+21+0+9\\right)=7.5.\n$$\n\n对于 $u_{12}$：\n$$\nu_{12}^{(1)}=\\frac{1}{4}\\left(u_{22}^{(0)}+u_{02}+u_{13}+u_{11}^{(0)}\\right)=\\frac{1}{4}\\left(0+21+81+0\\right)=25.5.\n$$\n\n对于 $u_{21}$：\n$$\nu_{21}^{(1)}=\\frac{1}{4}\\left(u_{31}+u_{11}^{(0)}+u_{22}^{(0)}+u_{20}\\right)=\\frac{1}{4}\\left(41+0+0+9\\right)=12.5.\n$$\n\n对于 $u_{22}$：\n$$\nu_{22}^{(1)}=\\frac{1}{4}\\left(u_{32}+u_{12}^{(0)}+u_{23}+u_{21}^{(0)}\\right)=\\frac{1}{4}\\left(41+0+81+0\\right)=30.5.\n$$\n\n因此，从零开始进行一次雅可比迭代后，按 $(u_{11},u_{12},u_{21},u_{22})$ 顺序更新的电势值为 $(7.5,25.5,12.5,30.5)$。", "answer": "$$\\boxed{\\begin{pmatrix} 7.5  25.5  12.5  30.5 \\end{pmatrix}}$$", "id": "2172039"}, {"introduction": "数值解的准确性取决于其对物理边界的表示。虽然在边界上固定值（狄利克雷条件）很简单，但模拟绝热边界（诺伊曼条件）则需要更巧妙的方法。这个问题将向你展示如何使用“虚拟点”来精确实现诺伊曼条件 [@problem_id:2141799]，这是模拟现实世界中指定了热通量而非温度等场景的一项关键技术。", "problem": "正在对一个方形微电子元件进行热分析。该元件占据由 $0 \\le x \\le L$ 和 $0 \\le y \\le L$ 定义的二维区域。在稳态运行且无内部热源的情况下，元件内部的温度分布 $T(x,y)$ 由二维拉普拉斯方程控制：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 0\n$$\n为了数值求解该方程，将区域离散化为均匀的方形网格，网格间距为 $\\Delta x = \\Delta y = h$。网格节点 $(x_i, y_j) = (ih, jh)$ 处的温度记为 $T_{i,j}$。\n\n沿直线 $x=0$ 和 $y=0$ 的边界是绝热的，这对应于诺伊曼边界条件 $\\frac{\\partial T}{\\partial n} = 0$，其中 $n$ 是边界的法线方向。另外两个边界（$x=L$ 和 $y=L$）上的温度保持在指定值。\n\n您的任务是确定位于两个绝热边界形成的角点处的节点 $(i,j)=(0,0)$ 的未知温度的有限差分方程。使用二阶精度的中心差分近似来处理拉普拉斯方程中的空间导数和边界条件，确定 $T_{0,0}$ 用其位于域内或边界上的相邻节点温度表示的表达式。\n\n下列哪个表达式正确地表示了 $T_{0,0}$？\n\nA. $T_{0,0} = \\frac{1}{4}(T_{1,0} + T_{0,1})$\n\nB. $T_{0,0} = \\frac{1}{4}(T_{1,0} + T_{0,1} + T_{1,1})$\n\nC. $T_{0,0} = \\frac{1}{2}(T_{1,0} + T_{0,1})$\n\nD. $T_{0,0} = \\frac{1}{4}(T_{1,0} + T_{-1,0} + T_{0,1} + T_{0,-1})$\n\nE. $T_{0,0} = \\frac{1}{3}(T_{1,0} + T_{0,1} + T_{1,1})$", "solution": "稳态拉普拉斯方程使用标准的二阶中心差分格式在均匀网格上进行离散化。在内部节点处，可得\n$$\n\\frac{T_{i+1,j} + T_{i-1,j} + T_{i,j+1} + T_{i,j-1} - 4 T_{i,j}}{h^{2}} = 0.\n$$\n在具有诺伊曼条件的边界上，使用虚拟点对法向导数进行二阶精度的中心差分近似。在边界 $x=0$ 处，位于 $(0,j)$ 的条件 $\\partial T/\\partial x=0$ 近似为\n$$\n\\frac{T_{1,j} - T_{-1,j}}{2h} = 0 \\quad \\Rightarrow \\quad T_{-1,j} = T_{1,j}.\n$$\n类似地，在边界 $y=0$ 处，位于 $(i,0)$ 的条件 $\\partial T/\\partial y=0$ 近似为\n$$\n\\frac{T_{i,1} - T_{i,-1}}{2h} = 0 \\quad \\Rightarrow \\quad T_{i,-1} = T_{i,1}.\n$$\n在角点节点 $(i,j)=(0,0)$ 处，应用带有虚拟点的五点拉普拉斯算子：\n$$\n\\frac{T_{1,0} + T_{-1,0} + T_{0,1} + T_{0,-1} - 4 T_{0,0}}{h^{2}} = 0.\n$$\n使用两个边界上的诺伊曼关系，\n$$\nT_{-1,0} = T_{1,0}, \\quad T_{0,-1} = T_{0,1},\n$$\n可得出\n$$\n\\frac{2 T_{1,0} + 2 T_{0,1} - 4 T_{0,0}}{h^{2}} = 0\n\\;\\Rightarrow\\;\n4 T_{0,0} = 2 T_{1,0} + 2 T_{0,1}\n\\;\\Rightarrow\\;\nT_{0,0} = \\frac{1}{2}\\left(T_{1,0} + T_{0,1}\\right).\n$$\n这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "2141799"}]}