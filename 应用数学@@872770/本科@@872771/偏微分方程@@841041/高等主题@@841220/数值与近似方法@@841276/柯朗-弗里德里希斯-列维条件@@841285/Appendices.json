{"hands_on_practices": [{"introduction": "掌握CFL条件的第一步是理解其核心数学关系。这个练习将让你直接应用Courant数的定义，计算在给定的波速、空间步长和目标Courant数下所需的时间步长。这是为任何波动现象设置稳定数值模拟的基石。[@problem_id:2139558]", "problem": "一个计算科学家团队正在模拟信号沿一维传输线的传播。信号电压 $u(x, t)$ 的行为由以下线性平流方程建模：\n$$ \\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = 0 $$\n其中 $v$ 是信号的恒定传播速度。\n\n该模拟在具有均匀空间步长 $\\Delta x$ 的网格上使用有限差分格式。所选的数值方法已知仅在满足 Courant-Friedrichs-Lewy (CFL) 条件时才稳定。库朗数 $C$ 定义为 $C = |v| \\frac{\\Delta t}{\\Delta x}$，其中 $\\Delta t$ 是时间步长。\n\n对于此特定模拟，传播速度为 $v = 2.5 \\times 10^8$ m/s，空间步长为 $\\Delta x = 1.25$ cm。为确保高精度并避免数值振荡，该团队决定在库朗数恰好为 $C = 0.75$ 的条件下运行。\n\n本次模拟所需的时间步长 $\\Delta t$ 是多少？请以纳秒 (ns) 为单位表示您的答案，并四舍五入到两位有效数字。", "solution": "我们使用线性平流方程离散化的库朗数定义：\n$$\nC=\\frac{|v|\\,\\Delta t}{\\Delta x}.\n$$\n求解时间步长可得\n$$\n\\Delta t=\\frac{C\\,\\Delta x}{|v|}.\n$$\n代入给定值，并将空间步长转换为米：$\\Delta x=1.25\\times 10^{-2}\\ \\text{m}$，$|v|=2.5\\times 10^{8}\\ \\text{m/s}$，以及 $C=0.75$：\n$$\n\\Delta t=\\frac{0.75\\,(1.25\\times 10^{-2})}{2.5\\times 10^{8}}\\ \\text{s}.\n$$\n计算数值因子：\n$$\n\\Delta t=\\frac{0.9375\\times 10^{-2}}{2.5\\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{0.9375}{2.5}\\right)\\times 10^{-10}\\ \\text{s}\n=0.375\\times 10^{-10}\\ \\text{s}\n=3.75\\times 10^{-11}\\ \\text{s}.\n$$\n使用 $1\\ \\text{ns}=10^{-9}\\ \\text{s}$ 转换为纳秒：\n$$\n\\Delta t=3.75\\times 10^{-11}\\ \\text{s}=3.75\\times 10^{-2}\\ \\text{ns}=0.0375\\ \\text{ns}.\n$$\n四舍五入到两位有效数字，得到 $0.038\\ \\text{ns}$。", "answer": "$$\\boxed{0.038}$$", "id": "2139558"}, {"introduction": "理解CFL条件不仅在于计算，更在于其背后的物理直觉——信息必须在数值网格的“允许”范围内传播。本练习将挑战你思考当波的传播方向改变时，数值格式应如何调整以保持稳定性，从而引出至关重要的“迎风格式”概念。[@problem_id:2139542]", "problem": "考虑一维线性平流方程 $u_t + c u_x = 0$，它描述了一个以恒定速度 $c$ 传播的波。我们希望在具有均匀空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的网格上数值求解该方程。令 $u_j^n$ 表示解 $u(x, t)$ 在网格点 $x_j = j \\Delta x$ 和时间 $t_n = n \\Delta t$ 处的数值近似。\n\n对于正波速 $c > 0$，一个常用且稳定的数值方法是一阶迎风格式，它对时间导数使用向前差分，对空间导数使用向后差分。该格式由下式给出：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\n只要满足 Courant-Friedrichs-Lewy (CFL) 条件 $0 \\le \\frac{c \\Delta t}{\\Delta x} \\le 1$，该格式就是稳定的。\n\n现在，考虑波速为负常数 $c  0$ 的情况。此时，物理波从右向左传播（沿 $x$ 减小的方向）。为了保持稳定性，有限差分格式必须进行修改，以适应信息流方向的这种变化。\n\n在适当的 CFL 条件下，以下哪个离散格式为 $c  0$ 的平流方程提供了稳定的近似？\n\nA. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$\n\nB. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0$\n\nC. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$\n\nD. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_j^{n+1}}{\\Delta x} = 0$\n\nE. $\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$", "solution": "我们考虑具有恒定速度 $c$ 的线性平流方程 $u_{t} + c u_{x} = 0$。对于 $c  0$，特征线从右向左传播，因此数值格式必须使用来自上风（右侧）的信息才能保持稳定。这导致在当前时间层 $n$ 选择向前空间差分（$x$ 增加的方向）。\n\n引入 Courant 数 $\\nu = \\dfrac{c \\Delta t}{\\Delta x}$。对于候选格式\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} = 0,\n$$\n即选项B，我们进行 von Neumann 分析。假设一个 Fourier 模式 $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)$，其中 $\\theta \\in \\mathbb{R}$。代入格式可得\n$$\n\\hat{u}^{n+1} e^{i \\theta j} = \\hat{u}^{n} e^{i \\theta j} - \\nu \\left(\\hat{u}^{n} e^{i \\theta (j+1)} - \\hat{u}^{n} e^{i \\theta j}\\right),\n$$\n因此，由 $\\hat{u}^{n+1} = G \\hat{u}^{n}$ 定义的放大因子 $G$ 为\n$$\nG = 1 - \\nu \\left(e^{i \\theta} - 1\\right) = (1 + \\nu) - \\nu e^{i \\theta}.\n$$\n然后\n$$\n|G|^{2} = \\left((1+\\nu) - \\nu \\cos \\theta\\right)^{2} + \\left(\\nu \\sin \\theta\\right)^{2}\n= (1+\\nu)^{2} - 2 \\nu (1+\\nu) \\cos \\theta + \\nu^{2}.\n$$\n对于 $c  0$，我们有 $\\nu \\leq 0$。如果 $-1 \\leq \\nu \\leq 0$，系数 $-2 \\nu (1+\\nu) \\geq 0$，因此 $|G|^{2}$ 关于 $\\theta$ 的最大值在 $\\cos \\theta = -1$ 处取得，得到\n$$\n\\max_{\\theta} |G|^{2} = (1+\\nu)^{2} + 2 \\nu (1+\\nu) + \\nu^{2} = (1 + 2 \\nu)^{2} \\leq 1,\n$$\n这恰好在 $-1 \\leq \\nu \\leq 0$ 时成立。因此，在 CFL 条件 $-1 \\leq \\dfrac{c \\Delta t}{\\Delta x} \\leq 0$ 下，选项 B 是稳定的。\n\n为了排除其他选项：\n\n- 选项 A（空间向后差分）：格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} = 0.\n$$\nFourier 分析得出 $G = (1 - \\nu) + \\nu e^{-i \\theta}$ 并且\n$$\n|G|^{2} = (1 - \\nu)^{2} - 2 \\nu (1 - \\nu) \\cos \\theta + \\nu^{2}.\n$$\n对于 $\\nu  0$，系数 $-2 \\nu (1 - \\nu)  0$，所以最大值在 $\\cos \\theta = -1$ 处取得，得到\n$$\n\\max_{\\theta} |G|^{2} = (1 - \\nu)^{2} + 2 \\nu (1 - \\nu) + \\nu^{2} = (1 - 2 \\nu)^{2}  1,\n$$\n因此对于 $c  0$ 是不稳定的。\n\n- 选项 C（FTCS，空间中心差分）：格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} = 0,\n$$\n得到 $G = 1 - i \\nu \\sin \\theta$ 并且\n$$\n|G|^{2} = 1 + \\nu^{2} \\sin^{2} \\theta  1\n$$\n对于任何非零的 $\\nu$ 和 $\\theta \\not\\in \\pi \\mathbb{Z}$；因此是无条件不稳定的。\n\n- 选项 D（在时间层 $n+1$ 处的隐式向前差分）：格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_{j}^{n+1}}{\\Delta x} = 0,\n$$\n这导致\n$$\nG = \\frac{1}{1 + \\nu \\left(e^{i \\theta} - 1\\right)}.\n$$\n对于 $\\nu  0$，可以发现\n$$\n\\min_{\\theta} \\left|1 + \\nu \\left(e^{i \\theta} - 1\\right)\\right|^{2} = 1,\n$$\n所以 $|G| \\leq 1$，没有 CFL 限制。虽然这是稳定的，但它是隐式格式，并且不符合在强调 CFL 条件时所要求的标准显式迎风选择。\n\n- 选项 E（时间上蛙跳格式，空间上单边差分）：递推关系变为\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - 2 \\nu \\left(u_{j}^{n} - u_{j-1}^{n}\\right),\n$$\n这得出了放大因子多项式\n$$\nG^{2} + 2 \\nu \\left(1 - e^{-i \\theta}\\right) G - 1 = 0.\n$$\n根的乘积为 $-1$，因此除非在退化情况下，两个根的模不可能都小于或等于 $1$；因此这是不稳定的。\n\n因此，在适当的 CFL 条件下，对于 $c  0$ 稳定的显式迎风格式是选项 B。", "answer": "$$\\boxed{B}$$", "id": "2139542"}, {"introduction": "现在，让我们将CFL条件应用到更接近实际的场景中。在许多模拟中，为了在特定区域获得更高分辨率，会采用非均匀网格。这个练习将向你展示如何在这种情况下应用CFL条件，强调了必须在整个计算域中找到并满足最严格的稳定性约束。[@problem_id:2139610]", "problem": "一位计算物理学家正在模拟一个一维系统中的守恒量输运，该过程由线性平流方程 $\\frac{\\partial \\psi}{\\partial t} + c \\frac{\\partial \\psi}{\\partial x} = 0$ 描述。恒定的平流速度为 $c = 25.0$ m/s。该模拟采用有限体积法和一阶迎风格式。该数值格式的稳定性受 Courant-Friedrichs-Lewy (CFL) 条件的制约，该条件规定每个计算单元中的局部库朗数 $\\lambda_i$ 必须小于或等于 1。单元 $i$ 的库朗数定义为 $\\lambda_i = \\frac{c \\Delta t}{\\Delta x_i}$，其中 $\\Delta t$ 是时间步长，$\\Delta x_i$ 是单元 $i$ 的宽度。\n\n空间域被离散为 $N=400$ 个单元，索引从 $i=0$ 到 $i=399$。网格是非均匀的，第 $i$ 个单元的宽度由以下函数给出：\n$$\n\\Delta x_i = A \\left[1 - K \\cos\\left(\\frac{2 \\pi i}{N-1}\\right)\\right]\n$$\n网格的参数为 $A = 0.80$ m 和 $K = 0.60$。整个模拟域必须使用一个单一的全局时间步长 $\\Delta t$。为了保持数值稳定性，这个全局时间步长 $\\Delta t$ 的最大可能值是多少？\n\n答案以秒为单位表示，并保留三位有效数字。", "solution": "对于线性平流方程，一阶迎风有限体积格式是稳定的，条件是在每个单元 $i$ 中，库朗数都满足 $\\lambda_{i} \\leq 1$，其中 $\\lambda_{i} = \\frac{c \\Delta t}{\\Delta x_{i}}$。使用单一的全局时间步长 $\\Delta t$，稳定性条件变为\n$$\n\\frac{c \\Delta t}{\\Delta x_{i}} \\leq 1 \\quad \\text{对所有的 } i \\implies \\Delta t \\leq \\min_{i} \\left(\\frac{\\Delta x_{i}}{c}\\right).\n$$\n因此，最大稳定时间步长为\n$$\n\\Delta t_{\\max} = \\frac{\\min_{i} \\Delta x_{i}}{c}.\n$$\n单元宽度由 $\\Delta x_{i} = A \\left[1 - K \\cos\\left(\\frac{2 \\pi i}{N-1}\\right)\\right]$ 给出。由于当 $\\theta = 2\\pi m$（其中 $m$ 为整数）时，$\\cos(\\theta)$ 达到其最大值 1，而在此问题中 $\\theta_{i} = \\frac{2\\pi i}{N-1}$，因此当 $i=0$ 和 $i=N-1$ 时，我们有 $\\cos\\left(\\frac{2\\pi i}{N-1}\\right) = 1$。因此，最小单元宽度为\n$$\n\\Delta x_{\\min} = A \\left(1 - K\\right).\n$$\n因此，\n$$\n\\Delta t_{\\max} = \\frac{A \\left(1 - K\\right)}{c}.\n$$\n代入给定值 $A = 0.80$ m, $K = 0.60$ 和 $c = 25.0$ m/s，\n$$\n\\Delta t_{\\max} = \\frac{0.80 \\times \\left(1 - 0.60\\right)}{25.0} = \\frac{0.80 \\times 0.40}{25.0} = \\frac{0.32}{25.0} = 0.0128 \\text{ s}.\n$$\n保留三位有效数字，结果为 $0.0128$ s。", "answer": "$$\\boxed{0.0128}$$", "id": "2139610"}]}