{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，这个练习将帮助你掌握使用生成函数求解递推关系的核心步骤。通过将一个一阶线性非齐次递推关系 [@problem_id:1413569] 转化为其生成函数的代数方程，我们将学习如何求解该函数，并最终通过展开其幂级数来提取系数，从而得到数列的通项公式。", "problem": "在一个生物技术实验室，一个团队正在研究一种新改造的细菌菌株的种群动态。细菌培养物的质量，记为 $a_n$（单位为毫克 mg），在每天结束时测量，天数记为 $n$。实验从第 $n=0$ 天开始，初始质量为 $a_0 = 2$ mg。培养物经历一个每日生长周期。每天，细菌的质量首先增加，变为前一天结束时记录质量的五倍。在此增长之后，科学家们会收获恒定的 6 mg 用于分析。这个过程定义了当天的质量。\n\n求 $a_n$（即在第 $n$ 天结束时细菌培养物的质量）关于任意整数 $n \\ge 0$ 的封闭形式表达式。", "solution": "问题中的描述可以转化为一阶线性非齐次递推关系：\n$$\na_{n} = 5a_{n-1} - 6, \\quad \\text{对于 } n \\ge 1\n$$\n初始条件为 $a_{0}=2$。\n\n我们使用生成函数方法来求解。设 $A(x) = \\sum_{n=0}^{\\infty} a_n x^n$ 是序列 $\\{a_n\\}$ 的普通生成函数。\n我们将递推关系两边乘以 $x^n$ 并对所有 $n \\ge 1$ 求和：\n$$ \\sum_{n=1}^{\\infty} a_n x^n = 5 \\sum_{n=1}^{\\infty} a_{n-1} x^n - 6 \\sum_{n=1}^{\\infty} x^n $$\n现在，我们将方程的每一部分用 $A(x)$ 表示：\n-   左侧：$\\sum_{n=1}^{\\infty} a_n x^n = A(x) - a_0 = A(x) - 2$。\n-   右侧第一项：$5 \\sum_{n=1}^{\\infty} a_{n-1} x^n = 5x \\sum_{n=1}^{\\infty} a_{n-1} x^{n-1} = 5x \\sum_{k=0}^{\\infty} a_k x^k = 5x A(x)$。\n-   右侧第二项：$-6 \\sum_{n=1}^{\\infty} x^n = -6 \\left( \\frac{1}{1-x} - 1 \\right) = -6 \\left( \\frac{1 - (1-x)}{1-x} \\right) = -\\frac{6x}{1-x}$。\n\n将这些代入方程，我们得到：\n$$ A(x) - 2 = 5x A(x) - \\frac{6x}{1-x} $$\n现在，我们求解 $A(x)$：\n$$ A(x) (1 - 5x) = 2 - \\frac{6x}{1-x} $$\n$$ A(x) (1 - 5x) = \\frac{2(1-x) - 6x}{1-x} = \\frac{2 - 2x - 6x}{1-x} = \\frac{2 - 8x}{1-x} $$\n$$ A(x) = \\frac{2 - 8x}{(1 - 5x)(1 - x)} $$\n为了提取系数 $a_n$，我们使用部分分式分解：\n$$ A(x) = \\frac{C_1}{1 - 5x} + \\frac{C_2}{1 - x} $$\n通过通分并比较分子，我们有 $C_1(1-x) + C_2(1-5x) = 2 - 8x$。\n-   令 $x=1$，我们得到 $C_2(1-5) = 2-8 \\implies -4C_2 = -6 \\implies C_2 = \\frac{3}{2}$。\n-   令 $x=1/5$，我们得到 $C_1(1 - 1/5) = 2 - 8/5 \\implies C_1(4/5) = 2/5 \\implies C_1 = \\frac{1}{2}$。\n\n因此，生成函数为：\n$$ A(x) = \\frac{1/2}{1 - 5x} + \\frac{3/2}{1 - x} $$\n利用几何级数公式 $\\frac{1}{1-ax} = \\sum_{n=0}^{\\infty} a^n x^n$，我们展开 $A(x)$：\n$$ A(x) = \\frac{1}{2} \\sum_{n=0}^{\\infty} (5x)^n + \\frac{3}{2} \\sum_{n=0}^{\\infty} x^n = \\sum_{n=0}^{\\infty} \\left( \\frac{1}{2} \\cdot 5^n + \\frac{3}{2} \\right) x^n $$\n通过比较 $x^n$ 的系数，我们得到 $a_n$ 的封闭形式：\n$$ a_n = \\frac{1}{2} \\cdot 5^n + \\frac{3}{2} = \\frac{1}{2}(5^n + 3) $$\n此表达式对所有 $n \\ge 0$ 均成立。", "answer": "$$\\boxed{\\frac{1}{2}\\left(5^{n}+3\\right)}$$", "id": "1413569"}, {"introduction": "生成函数的真正威力在于它们能够优雅地处理其他方法难以应对的复杂结构。这个练习 [@problem_id:1413554] 中的递推关系包含一个求和项，这通常会使问题变得复杂。我们将看到，通过将序列的求和操作转化为其生成函数的乘积，这个问题可以被系统地解决，这充分展示了生成函数方法在处理卷积类型问题时的优势。", "problem": "在一个数字生命模拟中，研究一种新型的自我复制生物体。令 $a_n$ 表示在第 $n$ 代时该生物体的不同变体的数量。在模拟开始时（第 $n=0$ 代），只有一个始祖变体，因此我们有 $a_0 = 1$。\n\n对于任何后续的世代 $n \\ge 1$，新变体通过两个不同的过程形成：\n1.  来自紧邻前一代（第 $n-1$ 代）的每个变体都会产生一个单一的、唯一的新变体。\n2.  从第 $k=0$ 代到第 $k=n-1$ 代（含）为止曾经存在过的每个变体，都会促成一个额外的新变体的产生。\n\n第 $n$ 代的总变体数，记为 $a_n$，是这两个过程创造的变体数量之和。求出当 $n \\ge 1$ 时 $a_n$ 关于 $n$ 的闭式表达式。", "solution": "问题中描述的过程产生以下递推关系。第 $n \\ge 1$ 代的变体数量 $a_n$ 是过程1产生的变体数量（$a_{n-1}$）和过程2产生的变体数量（$\\sum_{k=0}^{n-1} a_k$）之和。\n因此，我们得到递推关系：\n$$a_n = a_{n-1} + \\sum_{k=0}^{n-1} a_k, \\quad \\text{for } n \\ge 1$$\n初始条件为 $a_0 = 1$。\n\n我们将使用生成函数来求解这个递推关系。设 $A(x)$ 是序列 $\\{a_n\\}$ 的普通生成函数，定义为：\n$$A(x) = \\sum_{n=0}^{\\infty} a_n x^n = a_0 + a_1 x + a_2 x^2 + \\dots$$\n\n我们的目标是找到 $A(x)$ 的一个代数表达式，然后提取系数 $a_n$。我们将递推关系两边乘以 $x^n$ 并对所有有效的 $n$ 值（即 $n \\ge 1$）求和。\n$$ \\sum_{n=1}^{\\infty} a_n x^n = \\sum_{n=1}^{\\infty} a_{n-1} x^n + \\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n $$\n\n我们来分析这个方程中的每一项。\n等式左边是 $\\sum_{n=1}^{\\infty} a_n x^n = A(x) - a_0 = A(x) - 1$。\n\n等式右边的第一项是 $\\sum_{n=1}^{\\infty} a_{n-1} x^n$。提出因子 $x$，我们得到 $x \\sum_{n=1}^{\\infty} a_{n-1} x^{n-1}$。令 $m = n-1$，此项变为 $x \\sum_{m=0}^{\\infty} a_m x^m = x A(x)$。\n\n等式右边的第二项是 $\\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n$。令 $s_m = \\sum_{k=0}^{m} a_k$。这一项是 $\\sum_{n=1}^{\\infty} s_{n-1} x^n = x \\sum_{n=1}^{\\infty} s_{n-1} x^{n-1} = x \\sum_{m=0}^{\\infty} s_m x^m$。\n序列 $\\{s_m\\}$ 是 $\\{a_n\\}$ 的部分和序列。$\\{s_m\\}$ 的生成函数，我们称之为 $S(x)$，与 $A(x)$ 相关。序列 $\\{s_m\\}$ 是序列 $\\{a_n\\}$ 与常数序列 $\\{1, 1, 1, \\dots\\}$ 的卷积。常数序列的生成函数是 $\\frac{1}{1-x}$。因此，$S(x) = A(x) \\cdot \\frac{1}{1-x}$。\n所以，等式右边的第二项变为 $x S(x) = \\frac{x A(x)}{1-x}$。\n\n将这些表达式代回主方程：\n$$ A(x) - 1 = x A(x) + \\frac{x A(x)}{1-x} $$\n\n现在，我们求解 $A(x)$。\n$$ A(x) - 1 = A(x) \\left( x + \\frac{x}{1-x} \\right) $$\n$$ A(x) - 1 = A(x) \\left( \\frac{x(1-x)+x}{1-x} \\right) = A(x) \\left( \\frac{x-x^2+x}{1-x} \\right) = A(x) \\left( \\frac{2x-x^2}{1-x} \\right) $$\n$$ A(x) \\left( 1 - \\frac{2x-x^2}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-x - (2x-x^2)}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-3x+x^2}{1-x} \\right) = 1 $$\n$$ A(x) = \\frac{1-x}{1-3x+x^2} $$\n\n为了求出 $a_n$，我们使用部分分式分解将 $A(x)$ 展开为幂级数。首先，我们找到分母多项式 $1-3x+x^2$ 的根。这些根的倒数是特征多项式 $t^2 - 3t + 1 = 0$ 的根。解得 $t = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$。\n我们定义这两个根为 $r_1 = \\frac{3+\\sqrt{5}}{2}$ 和 $r_2 = \\frac{3-\\sqrt{5}}{2}$。我们还定义黄金比例 $\\phi = \\frac{1+\\sqrt{5}}{2}$ 及其共轭 $\\psi = \\frac{1-\\sqrt{5}}{2}$。可以验证 $r_1 = \\phi^2$ 且 $r_2 = \\psi^2$。\n分母可以因式分解为 $1-3x+x^2 = (1-r_1 x)(1-r_2 x)$。\n我们想要分解 $A(x)$：\n$$ \\frac{1-x}{(1-r_1 x)(1-r_2 x)} = \\frac{C_1}{1-r_1 x} + \\frac{C_2}{1-r_2 x} $$\n使用覆盖法：\n$$ C_1 = \\left. \\frac{1-x}{1-r_2 x} \\right|_{x=1/r_1} = \\frac{1 - 1/r_1}{1 - r_2/r_1} = \\frac{(r_1-1)/r_1}{(r_1-r_2)/r_1} = \\frac{r_1-1}{r_1-r_2} $$\n我们有 $r_1 - 1 = \\phi^2 - 1 = \\frac{1+\\sqrt{5}}{2} = \\phi$，以及 $r_1 - r_2 = \\sqrt{5}$。\n所以，$C_1 = \\frac{\\phi}{\\sqrt{5}}$。\n$$ C_2 = \\left. \\frac{1-x}{1-r_1 x} \\right|_{x=1/r_2} = \\frac{1 - 1/r_2}{1 - r_1/r_2} = \\frac{(r_2-1)/r_2}{(r_2-r_1)/r_2} = \\frac{r_2-1}{r_2-r_1} $$\n我们有 $r_2 - 1 = \\psi^2 - 1 = \\frac{1-\\sqrt{5}}{2} = \\psi$，以及 $r_2 - r_1 = -\\sqrt{5}$。\n所以，$C_2 = \\frac{\\psi}{-\\sqrt{5}}$。\n\n因此，生成函数为：\n$$ A(x) = \\frac{\\phi/\\sqrt{5}}{1-r_1 x} - \\frac{\\psi/\\sqrt{5}}{1-r_2 x} $$\n我们使用几何级数公式 $\\frac{1}{1-u} = \\sum_{n=0}^{\\infty} u^n$ 展开每一项：\n$$ A(x) = \\frac{\\phi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_1 x)^n - \\frac{\\psi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_2 x)^n = \\sum_{n=0}^{\\infty} \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) x^n $$\n$x^n$ 的系数是 $a_n$：\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) $$\n代入 $r_1 = \\phi^2$ 和 $r_2 = \\psi^2$：\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi (\\phi^2)^n - \\psi (\\psi^2)^n) = \\frac{1}{\\sqrt{5}} (\\phi^{2n+1} - \\psi^{2n+1}) $$\n这个公式是斐波那契数 $F_{2n+1}$ 的比内公式（Binet's formula）。\n代入 $\\phi$ 和 $\\psi$ 的值：\n$$ a_n = \\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right] $$\n这个闭式表达式对所有 $n \\ge 0$ 都成立，因此也对所要求的 $n \\ge 1$ 成立。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right]}$$", "id": "1413554"}, {"introduction": "在处理阶乘或与索引 $n$ 相乘的项时，标准生成函数可能显得力不从心，这时指数生成函数（EGF）就派上了用场。这个高级练习 [@problem_id:1413591] 提出了一个耦合递推系统，我们将运用指数生成函数将其转化为一个可解的微分方程组。这个过程不仅展示了 EGF 的强大功能，也揭示了离散数学与连续分析之间深刻而优美的联系。", "problem": "考虑两个数列 $\\{a_n\\}_{n \\ge 0}$ 和 $\\{b_n\\}_{n \\ge 0}$，它们通过一个递推关系式系统耦合。这两个数列由初始值 $a_0 = 1$ 和 $b_0 = 1$ 定义。对于所有整数 $n \\ge 1$，数列的项由以下相互递推关系式生成：\n$$a_n = a_{n-1} + n b_{n-1}$$\n$$b_n = n a_{n-1} + b_{n-1}$$\n求通项 $a_n$ 作为 $n$ 的函数的封闭形式表达式。", "solution": "为求解此递推关系式系统，我们使用指数生成函数（EGFs）的方法。设数列 $\\{a_n\\}$ 和 $\\{b_n\\}$ 的指数生成函数分别为 $A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!}$ 和 $B(x) = \\sum_{n=0}^{\\infty} b_n \\frac{x^n}{n!}$。\n\n我们的目标是将递推关系转化为关于 $A(x)$ 和 $B(x)$ 的微分方程。为此，我们将递推关系两边同乘以 $\\frac{x^{n-1}}{(n-1)!}$ 并对所有 $n \\ge 1$ 求和。\n\n对于第一个递推关系 $a_n = a_{n-1} + n b_{n-1}$：\n$$\\sum_{n=1}^{\\infty} a_n \\frac{x^{n-1}}{(n-1)!} = \\sum_{n=1}^{\\infty} a_{n-1} \\frac{x^{n-1}}{(n-1)!} + \\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^{n-1}}{(n-1)!}$$\n方程左边是 $A'(x)$。右边第一项是 $A(x)$。对于右边第二项，我们有：\n$$ \\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^{n-1}}{(n-1)!} = \\sum_{k=0}^{\\infty} (k+1) b_k \\frac{x^k}{k!} = \\sum_{k=0}^{\\infty} k b_k \\frac{x^k}{k!} + \\sum_{k=0}^{\\infty} b_k \\frac{x^k}{k!} = xB'(x) + B(x) $$\n因此，第一个方程变为：$A'(x) = A(x) + B(x) + xB'(x)$。\n\n对于第二个递推关系 $b_n = n a_{n-1} + b_{n-1}$，进行同样的操作：\n$$\\sum_{n=1}^{\\infty} b_n \\frac{x^{n-1}}{(n-1)!} = \\sum_{n=1}^{\\infty} n a_{n-1} \\frac{x^{n-1}}{(n-1)!} + \\sum_{n=1}^{\\infty} b_{n-1} \\frac{x^{n-1}}{(n-1)!}$$\n这得到：$B'(x) = (A(x) + xA'(x)) + B(x)$。\n\n于是我们得到了微分方程组：\n1) $A'(x) = A(x) + B(x) + x B'(x)$\n2) $B'(x) = A(x) + B(x) + x A'(x)$\n\n现在我们来解这个方程组。将两个方程相减：\n$A'(x) - B'(x) = (A(x) - B(x)) + (x B'(x) - x A'(x))$\n$(A'(x) - B'(x)) = (A(x) - B(x)) - x (A'(x) - B'(x))$\n$(1+x)(A'(x) - B'(x)) = (A(x) - B(x))$\n令 $S(x) = A(x) - B(x)$。方程变为 $(1+x)S'(x) = S(x)$。\n这是一个可分离微分方程：$\\frac{S'(x)}{S(x)} = \\frac{1}{1+x}$。\n两边积分，我们得到 $\\ln|S(x)| = \\ln|1+x| + C$，这意味着 $S(x) = K(1+x)$。\n为了求出常数 $K$，我们使用初始条件：$a_0 = 1$ 和 $b_0 = 1$。\n$A(0) = a_0 = 1$ 且 $B(0) = b_0 = 1$。\n因此，$S(0) = A(0) - B(0) = 1 - 1 = 0$。\n将此代入 $S(x)$ 的解中：$S(0) = K(1+0) \\implies 0 = K$。\n因此，$K=0$，这意味着对所有 $x$ 都有 $S(x) = 0$。这又意味着 $A(x) = B(x)$。\n\n既然我们知道两个生成函数是相同的，我们可以将 $B(x) = A(x)$ 和 $B'(x) = A'(x)$ 代入任一微分方程中。我们使用方程(1)：\n$A'(x) = A(x) + A(x) + x A'(x)$\n$A'(x) = 2A(x) + x A'(x)$\n$A'(x) (1-x) = 2A(x)$\n这是另一个可分离常微分方程：\n$$\\frac{A'(x)}{A(x)} = \\frac{2}{1-x}$$\n两边关于 $x$ 积分：\n$$\\int \\frac{dA}{A} = \\int \\frac{2}{1-x} dx$$\n$$\\ln|A(x)| = -2 \\ln|1-x| + C_0$$\n$$A(x) = e^{C_0} (1-x)^{-2} = C_1 (1-x)^{-2}$$\n为了求出常数 $C_1$，我们使用初始条件 $A(0) = a_0 = 1$。\n$$A(0) = C_1 (1-0)^{-2} \\implies 1 = C_1$$\n因此，$\\{a_n\\}$ 的指数生成函数是：\n$$A(x) = \\frac{1}{(1-x)^2}$$\n我们的最后一步是从这个函数中提取系数 $a_n$。我们可以在 $x=0$ 处找到 $A(x)$ 的泰勒级数展开。使用广义二项式定理：\n$$(1-z)^{-k} = \\sum_{n=0}^{\\infty} \\binom{n+k-1}{k-1} z^n$$\n$$A(x) = (1-x)^{-2} = \\sum_{n=0}^{\\infty} \\binom{n+2-1}{2-1} x^n = \\sum_{n=0}^{\\infty} \\binom{n+1}{1} x^n = \\sum_{n=0}^{\\infty} (n+1) x^n$$\n我们现在已经找到了 $A(x)$ 的幂级数。根据定义，$A(x)$ 是一个指数生成函数，所以我们必须将其幂级数的系数与指数生成函数定义中的项对应起来：\n$$A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!} = \\sum_{n=0}^{\\infty} (n+1) x^n$$\n通过比较两边 $x^n$ 的系数，我们得到：\n$$\\frac{a_n}{n!} = n+1$$\n解出 $a_n$ 即可得到所需的封闭形式表达式：\n$$a_n = (n+1) \\cdot n!$$\n这可以简化为：\n$$a_n = (n+1)!$$\n因为我们发现 $A(x)=B(x)$，所以同样的公式也适用于 $b_n$，即 $b_n = (n+1)!$。", "answer": "$$\\boxed{(n+1)!}$$", "id": "1413591"}]}