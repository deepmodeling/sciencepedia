{"hands_on_practices": [{"introduction": "理论学习的最佳伴侣是实践。本节将通过一系列精心设计的练习，帮助你掌握费马小定理的应用。第一个练习 [@problem_id:1369602] 旨在展示该定理最直接的应用形式。面对一个看似涉及庞大数字的计算，你会发现，利用费马小定理 $a^p \\equiv a \\pmod{p}$ 的形式，可以将其迅速简化为一个基本的算术问题，从而深刻体会到该定理的威力。", "problem": "一个密码学协议依赖于生成一个以素数为模的整数序列。该序列记为 $\\{x_n\\}$，对整数 $n \\ge 1$ 有定义。每一项都由以下公式计算：\n$$x_n = A^n + B^n$$\n其中常数 $A = 246813579$ 和 $B = 987654321$。\n\n该协议的安全性检查需要计算此序列的特定项。请确定当以素数 $p=53$ 为模计算时，项 $x_{53}$ 的值。你的答案应为最小的非负整数。", "solution": "我们需要计算 $x_{53} \\pmod{53}$，其中 $x_{n} = A^{n} + B^{n}$，$A = 246813579$，$B = 987654321$，且 $53$ 是一个素数。\n\n根据费马小定理，对于一个素数 $p$ 和任意整数 $a$，有 $a^{p} \\equiv a \\pmod{p}$。这是因为如果 $p \\nmid a$，则 $a^{p-1} \\equiv 1 \\pmod{p}$，因此 $a^{p} \\equiv a \\pmod{p}$；如果 $p \\mid a$，则两边都是 $0 \\pmod{p}$。将此定理应用于 $p=53$ 可得\n$$\nA^{53} \\equiv A \\pmod{53}, \\quad B^{53} \\equiv B \\pmod{53}.\n$$\n因此，\n$$\nx_{53} = A^{53} + B^{53} \\equiv A + B \\pmod{53}.\n$$\n计算 $A + B$：\n$$\nA + B = 246813579 + 987654321 = 1234467900.\n$$\n现在将 $1234467900$ 对 $53$ 取模，方法是将其表示为 $53q + r$ 的形式，其中 $0 \\le r  53$。分步进行：\n$$\n53 \\cdot 23000000 = 1219000000,\\quad 1234467900 - 1219000000 = 15467900,\n$$\n$$\n53 \\cdot 291000 = 15423000,\\quad 15467900 - 15423000 = 44900,\n$$\n$$\n53 \\cdot 847 = 44891,\\quad 44900 - 44891 = 9.\n$$\n因此，\n$$\n1234467900 = 53 \\cdot 23291847 + 9,\n$$\n所以\n$$\nA + B \\equiv 9 \\pmod{53}.\n$$\n于是，\n$$\nx_{53} \\equiv 9 \\pmod{53},\n$$\n最小的非负余数是 $9$。", "answer": "$$\\boxed{9}$$", "id": "1369602"}, {"introduction": "掌握了直接应用后，我们来探索费马小定理一个更巧妙的用途。定理的另一种形式，$a^{p-1} \\equiv 1 \\pmod{p}$（当 $p$ 不整除 $a$ 时），揭示了模算术中指数的周期性。这个性质在处理“幂塔”这类看似无法计算的巨大指数时尤其有效。本练习 [@problem_id:1369645] 将引导你利用这一原理，通过对指数本身进行模运算，来解决一个复杂的指数问题。", "problem": "在密码密钥交换协议中，涉及指数非常大的模幂运算的计算很常见。考虑一个涉及整数 $N = 5^{3^{16}}$ 的计算。你的任务是求出 $N$ 除以 $17$ 时的余数。", "solution": "我们要求 $N=5^{3^{16}}$ 除以 $17$ 的余数。因为 $\\gcd(5,17)=1$ 且 $17$ 是素数，根据费马小定理可得\n$$\n5^{16} \\equiv 1 \\pmod{17}.\n$$\n因此，对于任意整数指数 $k$，我们可以将指数对 $16$ 取模：\n$$\n5^{k} \\equiv 5^{k \\bmod 16} \\pmod{17}.\n$$\n因此，我们只需计算 $3^{16} \\bmod 16$。观察可得\n$$\n3^{2}=9 \\equiv 9 \\pmod{16}, \\quad 3^{4}=81 \\equiv 1 \\pmod{16}.\n$$\n所以\n$$\n3^{16}=(3^{4})^{4} \\equiv 1^{4} \\equiv 1 \\pmod{16}.\n$$\n令 $k=3^{16}$，我们有 $k \\equiv 1 \\pmod{16}$，从而\n$$\n5^{3^{16}} \\equiv 5^{1} \\equiv 5 \\pmod{17}.\n$$\n因此，$N$ 除以 $17$ 的余数是 $5$。", "answer": "$$\\boxed{5}$$", "id": "1369645"}, {"introduction": "在实际应用中，费马小定理通常不是解题的终点，而是解决更复杂问题的关键一环。这个练习 [@problem_id:1369644] 模拟了一个密码学场景，要求你将费马小定理作为工具来解决一个多步骤问题。你需要首先运用定理来化简一个大指数，然后解决由此产生的线性同余方程，这是模算术中的一项核心技能。", "problem": "一位密码学家正在测试一种新的、简化的密钥交换协议。该协议依赖于一个公开已知的素数模，$p = 29$。一个秘密整数密钥，$x$，在经过伪装后被传输。伪装过程包括将 $x$ 乘以一个系数 $A$，然后将结果对 $p$ 取模。\n\n系数 $A$ 由一个公共底数 $g=5$ 和一个公开已知的大整数指数 $k=88$ 生成，使得 $A = g^k$。\n\n一个对手截获了最终传输的值，$C=10$。原始秘密密钥 $x$、系数 $A$ 和截获值 $C$ 之间的关系由以下关系式给出：\n$$A \\cdot x \\equiv C \\pmod{p}$$\n假设秘密密钥 $x$ 是一个正整数，求 $x$ 的最小可能值。", "solution": "我们已知一个素数模 $p=29$，一个底数 $g=5$，一个指数 $k=88$，以及关系式 $A \\cdot x \\equiv C \\pmod{p}$，其中 $A=g^{k}$ 且 $C=10$。因此，需要求解的同余方程是\n$$5^{88} \\cdot x \\equiv 10 \\pmod{29}.$$\n由于 $p=29$ 是素数且 $\\gcd(5,29)=1$，根据费马小定理，我们有 $5^{28} \\equiv 1 \\pmod{29}$。使用 $88 = 3 \\cdot 28 + 4$ 来化简指数：\n$$5^{88} \\equiv \\left(5^{28}\\right)^{3} \\cdot 5^{4} \\equiv 1^{3} \\cdot 5^{4} \\equiv 5^{4} \\pmod{29}.$$\n计算 $5^{4}$：\n$$5^{2} = 25,\\quad 5^{4} = 25^{2} = 625.$$\n将 $625$ 对 $29$ 取模：\n$$625 = 29 \\cdot 21 + 16 \\implies 625 \\equiv 16 \\pmod{29}.$$\n因此，同余方程变为\n$$16 \\cdot x \\equiv 10 \\pmod{29}.$$\n因为 $\\gcd(16,29)=1$（因为 $29$ 是素数且 $16 \\not\\equiv 0 \\pmod{29}$），所以 $16$ 存在模 $29$ 的乘法逆元。使用扩展欧几里得算法求 $16^{-1} \\pmod{29}$：\n$$29 = 1 \\cdot 16 + 13,$$\n$$16 = 1 \\cdot 13 + 3,$$\n$$13 = 4 \\cdot 3 + 1.$$\n回代以将 $1$ 表示为 $29$ 和 $16$ 的线性组合：\n$$1 = 13 - 4 \\cdot 3,$$\n$$3 = 16 - 1 \\cdot 13 \\implies 1 = 13 - 4(16 - 13) = 5 \\cdot 13 - 4 \\cdot 16,$$\n$$13 = 29 - 1 \\cdot 16 \\implies 1 = 5(29 - 16) - 4 \\cdot 16 = 5 \\cdot 29 - 9 \\cdot 16.$$\n因此\n$$-9 \\cdot 16 \\equiv 1 \\pmod{29} \\implies 16^{-1} \\equiv -9 \\equiv 20 \\pmod{29}.$$\n将 $16x \\equiv 10 \\pmod{29}$ 的两边同乘以 $16^{-1} \\equiv 20$ 得到\n$$x \\equiv 20 \\cdot 10 \\equiv 200 \\pmod{29}.$$\n将 $200$ 对 $29$ 取模：\n$$200 = 29 \\cdot 6 + 26 \\implies 200 \\equiv 26 \\pmod{29}.$$\n因此，最小的正整数解是 $x=26$。", "answer": "$$\\boxed{26}$$", "id": "1369644"}]}