{"hands_on_practices": [{"introduction": "主定理不仅是一个理论公式，更是算法设计者在现实世界中做出决策的有力工具。本练习 [@problem_id:1408675] 将让你直接比较两种具有不同递归结构的分治算法。通过应用主定理，你将能够预测它们在处理大规模数据时的长期性能，从而在不必实际实现和测试的情况下，做出明智的技术选型。", "problem": "一家分布式计算公司正在开发一项新服务，并正在评估两种相互竞争的算法，即算法 A 和算法 B，用于处理一个大小为 $n$ 的数据集的核心任务。\n\n算法 A 是一种分治算法，它将问题分解为 2 个规模为 $n/2$ 的子问题，递归地解决它们，然后合并结果。合并步骤所需时间与 $n^2$ 成正比。其运行时间 $T_A(n)$ 可由递推关系 $T_A(n) = 2T_A(n/2) + n^2$ 描述。\n\n算法 B 是另一种分治算法，它生成 7 个子问题，每个子问题处理大小为 $n/3$ 的数据集，并递归地解决它们。其合并步骤所需时间也与 $n^2$ 成正比。其运行时间 $T_B(n)$ 由递推关系 $T_B(n) = 7T_B(n/3) + n^2$ 描述。\n\n为了进行渐近分析，您可以忽略基准情形和比例常数。基于这些递推关系，以下哪个陈述正确描述了这两种算法之间的渐近效率关系？\n\nA. 算法 A 在渐近上比算法 B 更有效率。用数学术语来说，$T_A(n) \\in o(T_B(n))$。\n\nB. 算法 B 在渐近上比算法 A 更有效率。用数学术语来说，$T_B(n) \\in o(T_A(n))$。\n\nC. 两种算法具有相同的渐近时间复杂度。用数学术语来说，$T_A(n) \\in \\Theta(T_B(n))$。\n\nD. 主定理不适用于至少其中一个递推关系，因此无法用它来确定它们的复杂度。\n\nE. 无法根据所给信息确定其中一个或两个算法的渐近行为。", "solution": "我们使用主定理来分析每个递推关系。对于形式为 $T(n)=a\\,T(n/b)+f(n)$ 的递推关系，定义 $d=\\log_{b}(a)$ 并将 $f(n)$ 与 $n^{d}$ 进行比较。如果对于某个 $\\epsilon0$，有 $f(n)=\\Omega\\!\\left(n^{d+\\epsilon}\\right)$，并且对于某个常数 $c  1$ 和所有足够大的 $n$，正则性条件 $a\\,f(n/b)\\leq c\\,f(n)$ 成立，那么 $T(n)=\\Theta\\!\\left(f(n)\\right)$。\n\n对于算法 A，我们有 $a=2$，$b=2$，$f(n)=n^{2}$。那么\n$$\nd=\\log_{2}(2)=1,\\quad f(n)=n^{2}=\\Omega\\!\\left(n^{1+\\epsilon}\\right)\\ \\text{，其中}\\ \\epsilon=1。\n$$\n检查正则性条件：\n$$\na\\,f(n/b)=2\\left(\\frac{n}{2}\\right)^{2}=\\frac{n^{2}}{2}\\leq c\\,n^{2}\\ \\text{，其中}\\ c=\\frac{1}{2}  1。\n$$\n因此，根据主定理，\n$$\nT_{A}(n)=\\Theta\\!\\left(n^{2}\\right).\n$$\n\n对于算法 B，我们有 $a=7$，$b=3$，$f(n)=n^{2}$。那么\n$$\nd=\\log_{3}(7),\\quad \\text{并且由于 }2\\log_{3}(7),\\ f(n)=n^{2}=\\Omega\\!\\left(n^{\\log_{3}(7)+\\epsilon}\\right)\\ \\text{，其中}\\ \\epsilon=2-\\log_{3}(7)0。\n$$\n检查正则性条件：\n$$\na\\,f(n/b)=7\\left(\\frac{n}{3}\\right)^{2}=\\frac{7}{9}\\,n^{2}\\leq c\\,n^{2}\\ \\text{，其中}\\ c=\\frac{7}{9}  1。\n$$\n因此，根据主定理，\n$$\nT_{B}(n)=\\Theta\\!\\left(n^{2}\\right).\n$$\n\n因为 $T_{A}(n)$ 和 $T_{B}(n)$ 都是 $\\Theta\\!\\left(n^{2}\\right)$，所以可知 $T_{A}(n)\\in\\Theta\\!\\left(T_{B}(n)\\right)$。因此，正确选项是 C，并且主定理适用于这两个递推关系。", "answer": "$$\\boxed{C}$$", "id": "1408675"}, {"introduction": "在掌握了主定理的基本应用之后，我们来探讨一些更细微的情况。本练习 [@problem_id:1408691] 模拟了一个常见的研究场景：当不同算法策略的合并成本在多项式级别上相近，仅相差对数因子时，我们该如何精确评估它们的效率？这需要你运用主定理的扩展情况，深入理解对数因子对整体复杂度的微妙影响，并对不同策略的性能进行精确排序。", "problem": "一个计算机科学研究小组正在为高维数据分析设计一种新颖的递归算法。该算法对于规模为 $n$ 的输入的时间复杂度 $T(n)$ 由一个分治递归关系描述。该递归的一般结构是 $T(n) = 9T(n/3) + f(n)$，其中 $n$ 是3的幂。$f(n)$ 项表示合并递归子问题结果的成本，该团队正在考虑四种不同的合并策略，分别标记为A、B、C和D。每种策略都会产生不同的成本函数：\n\n- **策略 A：** 成本函数为 $f_A(n) = \\Theta(n^2 (\\log n)^{-1})$。\n- **策略 B：** 成本函数为 $f_B(n) = \\Theta(n^2)$。\n- **策略 C：** 成本函数为 $f_C(n) = \\Theta(n^2 \\log n)$。\n- **策略 D：** 成本函数为 $f_D(n) = \\Theta(n)$。\n\n你的任务是确定每种策略的渐近时间复杂度，然后根据它们在 $n$ 很大时的效率对这些策略进行排序。以下哪个选项按从最有效率（时间复杂度增长最慢）到最无效率（时间复杂度增长最快）的顺序列出了这些策略？\n\nA. A, B, C, D\n\nB. D, C, B, A\n\nC. C, B, A, D\n\nD. D, A, B, C\n\nE. 主定理不适用于所有策略。", "solution": "我们分析分治递归关系\n$$\nT(n)=9\\,T\\!\\left(\\frac{n}{3}\\right)+f(n),\\quad \\text{with }n=3^{m}.\n$$\n这里 $a=9$，$b=3$，所以关键指数为\n$$\n\\log_{b}a=\\log_{3}9=2,\n$$\n因此 $n^{\\log_{b}a}=n^{2}$。在整个分析过程中，由于不同底数之间仅相差常数因子，渐近因子中的对数可视为自然对数；我们写作 $\\ln$。\n\n策略D：$f_{D}(n)=\\Theta(n)$。由于当 $\\varepsilon=1$ 时，$n=\\mathcal{O}(n^{2-\\varepsilon})$，适用主定理情况1，得到\n$$\nT_{D}(n)=\\Theta(n^{2}).\n$$\n\n策略B：$f_{B}(n)=\\Theta(n^{2})=\\Theta\\!\\left(n^{2}(\\ln n)^{0}\\right)$。这符合主定理情况2，其中 $k=0$，所以\n$$\nT_{B}(n)=\\Theta\\!\\left(n^{2}\\ln n\\right).\n$$\n\n策略C：$f_{C}(n)=\\Theta\\!\\left(n^{2}\\ln n\\right)$ 符合主定理情况2，其中 $k=1$，因此\n$$\nT_{C}(n)=\\Theta\\!\\left(n^{2}(\\ln n)^{2}\\right).\n$$\n\n策略A：$f_{A}(n)=\\Theta\\!\\left(\\frac{n^{2}}{\\ln n}\\right)$ 比 $n^{2}$ 小一个对数因子，因此我们通过递归树求和来分析。该树有 $L=\\log_{3}n$ 层。第 $i$ 层的总成本是\n$$\n\\text{cost}_{i}=9^{i}\\cdot \\Theta\\!\\left(\\frac{(n/3^{i})^{2}}{\\ln(n/3^{i})}\\right)\n=\\Theta\\!\\left(\\frac{n^{2}}{\\ln n - i\\ln 3}\\right).\n$$\n对 $i=0,1,\\dots,L-1$ 求和，\n$$\n\\sum_{i=0}^{L-1}\\text{cost}_{i}\n=\\Theta\\!\\left(n^{2}\\sum_{i=0}^{L-1}\\frac{1}{\\ln n - i\\ln 3}\\right).\n$$\n令 $j=L-i$，注意到 $L=\\frac{\\ln n}{\\ln 3}$，则 $\\ln n - i\\ln 3=j\\ln 3$，所以\n$$\n\\sum_{i=0}^{L-1}\\text{cost}_{i}\n=\\Theta\\!\\left(\\frac{n^{2}}{\\ln 3}\\sum_{j=1}^{L}\\frac{1}{j}\\right)\n=\\Theta\\!\\left(n^{2}\\,\\ln L\\right)\n=\\Theta\\!\\left(n^{2}\\,\\ln\\!\\ln n\\right).\n$$\n叶子节点的贡献为 $\\Theta(n^{2})$，它被 $\\Theta(n^{2}\\ln\\!\\ln n)$ 所主导。因此，\n$$\nT_{A}(n)=\\Theta\\!\\left(n^{2}\\ln\\!\\ln n\\right).\n$$\n\n对于大的 $n$，从最有效率（增长最慢）到最无效率（增长最快）排序：\n$$\n\\Theta(n^{2})\\ (\\text{D})\\;\\prec\\;\\Theta\\!\\left(n^{2}\\ln\\!\\ln n\\right)\\ (\\text{A})\\;\\prec\\;\\Theta\\!\\left(n^{2}\\ln n\\right)\\ (\\text{B})\\;\\prec\\;\\Theta\\!\\left(n^{2}(\\ln n)^{2}\\right)\\ (\\text{C}).\n$$\n因此，正确的顺序是D、A、B、C。", "answer": "$$\\boxed{D}$$", "id": "1408691"}, {"introduction": "现代算法的设计常常是模块化和层次化的，一个分治算法的合并步骤本身可能就是另一个复杂的递归过程。本练习 [@problem_id:1408677] 就提出了这样一个具有嵌套递归结构的挑战。你需要分两步解决这个问题：首先，使用主定理分析作为子程序的算法复杂度；然后，将该结果代入主算法的递推关系中，进行第二轮分析，最终揭示整个系统的性能瓶颈。", "problem": "一位算法设计者正在开发一种新颖的计算方法，称为层次化数据融合（Hierarchical Data Fusion, HDF）算法，旨在处理大规模结构化数据。对于大小为 $n$ 的输入，HDF 算法的运行方式如下：它将数据分成两个大小为 $n/2$ 的子问题，在每个子问题上递归调用自身，然后合并结果。\n\n合并步骤是计算密集型的，由一个独立的子程序——互相关对齐器（Cross-Correlation Aligner, CCA）处理。对于大小为 $n$ 的输入，CCA 的运行时间（记为 $C(n)$）本身也遵循分治策略。CCA 算法将其任务分解为三个大小为 $n/3$ 的子问题，递归地解决它们，然后在与输入大小 $n$ 成线性关系的时间内合并结果。\n\n设 $T(n)$ 为 HDF 算法在大小为 $n$ 的输入上的总运行时间，设 $C(n)$ 为 CCA 子程序的运行时间，它构成了 HDF 的合并成本。对于 $n  1$，运行时间由以下递推关系描述，假设 $T(1)$ 和 $C(1)$ 是常数。\n\nHDF 的递推关系是：\n$T(n) = 2T(n/2) + C(n)$\n\nCCA 的递推关系是：\n$C(n) = 3C(n/3) + f(n)$，其中 $f(n) = \\Theta(n)$。\n\n确定 HDF 算法运行时间 $T(n)$ 的最紧渐近界。从以下选项中选择。\n\nA. $\\Theta(n^2)$\n\nB. $\\Theta(n \\log \\log n)$\n\nC. $\\Theta(n (\\log n)^2)$\n\nD. $\\Theta(n \\log n)$\n\nE. $\\Theta(n^{\\log_2 3})$", "solution": "我们已知两个递推关系。对于 $n1$，\n$$\nT(n)=2\\,T\\!\\left(\\frac{n}{2}\\right)+C(n),\\qquad C(n)=3\\,C\\!\\left(\\frac{n}{3}\\right)+f(n),\\quad f(n)=\\Theta(n),\n$$\n其中 $T(1)$ 和 $C(1)$ 是常数。我们首先求解 $C(n)$，然后将其代入 $T(n)$。\n\n为了求解 $C(n)$，应用主定理（Master Theorem），其中 $a=3$，$b=3$，$f(n)=\\Theta(n)$。我们计算\n$$\nn^{\\log_{3}3}=n.\n$$\n因此 $f(n)=\\Theta\\!\\big(n^{\\log_{3}3}\\big)$，这符合主定理的第二种情况。所以，\n$$\nC(n)=\\Theta\\!\\big(n\\log_{3}n\\big).\n$$\n由于不同底数的对数之间仅相差一个常数因子，$\\log_{3}n=\\frac{\\log_{2}n}{\\log_{2}3}$，我们可以等价地写成\n$$\nC(n)=\\Theta\\!\\big(n\\log_{2}n\\big).\n$$\n\n现在将此结果代入 $T(n)$ 的递推关系中：\n$$\nT(n)=2\\,T\\!\\left(\\frac{n}{2}\\right)+\\Theta\\!\\big(n\\log_{2}n\\big).\n$$\n这里 $a=2$，$b=2$，所以 $n^{\\log_{2}2}=n$。代价项满足\n$$\nf(n)=\\Theta\\!\\big(n\\log_{2}n\\big)=\\Theta\\!\\big(n^{\\log_{2}2}\\,(\\log_{2}n)^{1}\\big).\n$$\n这符合扩展主定理中 $f(n)=\\Theta\\!\\big(n^{\\log_{b}a}(\\log n)^{k}\\big)$ 且 $k=1$ 的情况。因此，\n$$\nT(n)=\\Theta\\!\\big(n^{\\log_{2}2}(\\log_{2}n)^{k+1}\\big)=\\Theta\\!\\big(n(\\log_{2}n)^{2}\\big).\n$$\n\n为了完整起见，使用递归树求和也能得到相同的结果。在 $T$ 递推的第 $i$ 层（$0\\le i\\le \\log_{2}n-1$），有 $2^{i}$ 个节点，每个节点的大小为 $n/2^{i}$，且每个节点贡献的合并成本为 $C(n/2^{i})=\\Theta\\!\\big(\\frac{n}{2^{i}}\\log_{2}\\frac{n}{2^{i}}\\big)$。第 $i$ 层的总合并成本是\n$$\n2^{i}\\cdot \\Theta\\!\\left(\\frac{n}{2^{i}}\\log_{2}\\frac{n}{2^{i}}\\right)=\\Theta\\!\\big(n(\\log_{2}n-i)\\big).\n$$\n对所有层求和，设 $L=\\log_{2}n$，\n$$\n\\sum_{i=0}^{L-1}\\Theta\\!\\big(n(\\log_{2}n-i)\\big)\n=\\Theta\\!\\left(n\\sum_{i=0}^{L-1}(L-i)\\right)\n=\\Theta\\!\\left(n\\cdot \\frac{L(L+1)}{2}\\right)\n=\\Theta\\!\\big(n(\\log_{2}n)^{2}\\big).\n$$\n叶子节点的贡献为 $\\Theta(n)$，它在渐近意义上被 $\\Theta\\!\\big(n(\\log_{2}n)^{2}\\big)$ 所主导。因此，\n$$\nT(n)=\\Theta\\!\\big(n(\\log_{2}n)^{2}\\big)=\\Theta\\!\\big(n(\\log n)^{2}\\big).\n$$\n\n在给定的选项中，这与选项 C 匹配。", "answer": "$$\\boxed{C}$$", "id": "1408677"}]}