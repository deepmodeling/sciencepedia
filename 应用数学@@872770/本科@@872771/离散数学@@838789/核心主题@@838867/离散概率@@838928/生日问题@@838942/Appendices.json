{"hands_on_practices": [{"introduction": "生日问题的核心在于计算“碰撞”的概率——即至少有两项落入同一个类别。直接计算“至少一个”重复的概率可能很复杂，一个更直接的方法是计算其反面事件：所有项目都完全不重复的概率。本练习将通过一个收集“神秘盲盒”的有趣场景，引导你应用这一关键的补集思想。[@problem_id:1404660]", "problem": "一家专门从事收藏品业务的科技公司发布了一系列新的“CryptoCritters”，这是一套与独特的数字代币相关联的实体微缩模型。完整的第一版套装中共有 50 款不同的 CryptoCritter 模型。这些模型以相同、密封的“盲盒”形式出售，这意味着购买者不知道他们具体购买的是哪一款模型。假设该公司生产的 50 款不同模型的数量相等且极大，因此每次抽选都可以被视为一个具有均等概率的独立事件。\n\n一位收藏家购买了 8 个这样的盲盒。他们在购买的 8 个模型中会收到至少一个重复的模型的概率是多少？\n\n计算你的答案，以小数形式表示并四舍五入到四位有效数字。", "solution": "将每个盒子建模为一次从 50 种等可能类型中的独立抽取。设 $D$ 为 8 次抽取中至少出现一个重复的事件。使用补集法则：$P(D) = 1 - P(\\text{all }8\\text{ distinct})$。\n\n所有 8 个模型都不同的概率是单射序列的数量除以序列总数：\n$$\nP(\\text{all distinct}) = \\frac{50 \\cdot 49 \\cdot 48 \\cdot 47 \\cdot 46 \\cdot 45 \\cdot 44 \\cdot 43}{50^{8}} = \\prod_{k=0}^{7} \\frac{50-k}{50} = 1 \\cdot \\frac{49}{50} \\cdot \\frac{48}{50} \\cdot \\frac{47}{50} \\cdot \\frac{46}{50} \\cdot \\frac{45}{50} \\cdot \\frac{44}{50} \\cdot \\frac{43}{50}.\n$$\n进行数值计算：\n$$\nP(\\text{all distinct}) = 0.98 \\times 0.96 \\times 0.94 \\times 0.92 \\times 0.90 \\times 0.88 \\times 0.86 \\approx 0.55416\n$$\n因此，\n$$\nP(D) = 1 - 0.55416 = 0.44584.\n$$\n四舍五入到四位有效数字，得到 $0.4458$。", "answer": "$$\\boxed{0.4458}$$", "id": "1404660"}, {"introduction": "在现实世界的系统设计中，我们不仅需要计算概率，还需要在不同方案之间做出权衡。这个练习将挑战你的直觉，要求你比较两种不同配置下的数据碰撞风险。通过解决这个问题，你将更深入地理解项目数量（$k$）和可用槽位数（$N$）如何共同影响碰撞概率。[@problem_id:1404673]", "problem": "一家分布式计算公司正在为其新服务评估两种不同的数据存储配置。在这两种配置中，新的数据记录都基于一个简单的均匀随机哈希算法被分配到服务器。当至少有两条记录被分配到同一台服务器时，就会发生“冲突”。公司需要确定哪种配置更容易发生冲突。\n\n这两种配置如下：\n\n- **情景 A**：$4$ 条新的数据记录将被存储在一个由 $20$ 台可用服务器组成的集群中。\n- **情景 B**：$5$ 条新的数据记录将被存储在一个由 $30$ 台可用服务器组成的集群中。\n\n假设对于每条记录，选择任何一台服务器的概率都是相等的，那么以下哪个陈述是正确的？\n\nA. 情景 A 发生冲突的概率更高。\nB. 情景 B 发生冲突的概率更高。\nC. 两种情景发生冲突的概率相等。\nD. 根据所给信息无法确定关系。", "solution": "解读：每条记录独立地、均匀地哈希到任何一台可用的服务器上。如果至少有两条记录被分配到同一台服务器，则发生冲突。对于 $n$ 台服务器和 $k$ 条记录，没有冲突（所有记录都在不同的服务器上）的概率是单射分配的数量除以总分配的数量：\n$$\nP_{\\text{no coll}}(n,k)=\\frac{n(n-1)\\cdots(n-k+1)}{n^{k}}=\\frac{(n)_{k}}{n^{k}}.\n$$\n因此，冲突的概率是\n$$\nP_{\\text{coll}}(n,k)=1-P_{\\text{no coll}}(n,k).\n$$\n我们计算并比较这两种情景下不发生冲突的概率；不发生冲突概率较小的情景，其发生冲突的概率较大。\n\n情景 A：$n=20$, $k=4$,\n$$\nP_{\\text{no coll},A}=\\frac{20\\cdot 19\\cdot 18\\cdot 17}{20^{4}}=\\frac{19}{20}\\cdot\\frac{18}{20}\\cdot\\frac{17}{20}.\n$$\n\n情景 B：$n=30$, $k=5$,\n$$\nP_{\\text{no coll},B}=\\frac{30\\cdot 29\\cdot 28\\cdot 27\\cdot 26}{30^{5}}=\\frac{29}{30}\\cdot\\frac{28}{30}\\cdot\\frac{27}{30}\\cdot\\frac{26}{30}.\n$$\n\n通过比率比较 $P_{\\text{no coll},A}$ 和 $P_{\\text{no coll},B}$\n$$\nR=\\frac{P_{\\text{no coll},A}}{P_{\\text{no coll},B}}=\\frac{\\frac{19\\cdot 18\\cdot 17}{20^{3}}}{\\frac{29\\cdot 28\\cdot 27\\cdot 26}{30^{4}}}=\\frac{19\\cdot 18\\cdot 17}{20^{3}}\\cdot\\frac{30^{4}}{29\\cdot 28\\cdot 27\\cdot 26}.\n$$\n化简 $30^{4}/20^{3}$：\n$$\n\\frac{30^{4}}{20^{3}}=\\frac{3^{4}\\cdot 10^{4}}{2^{3}\\cdot 10^{3}}=\\frac{81}{8}\\cdot 10=\\frac{405}{4}.\n$$\n因此\n$$\nR=\\frac{19\\cdot 18\\cdot 17}{1}\\cdot\\frac{405}{4}\\cdot\\frac{1}{29\\cdot 28\\cdot 27\\cdot 26}.\n$$\n使用 $405=27\\cdot 15$ 来约掉 $27$：\n$$\nR=\\frac{19\\cdot 18\\cdot 17\\cdot 15}{4\\cdot 29\\cdot 28\\cdot 26}.\n$$\n约分 $18/4=9/2$：\n$$\nR=\\frac{19\\cdot 9\\cdot 17\\cdot 15}{2\\cdot 29\\cdot 28\\cdot 26}=\\frac{19\\cdot 17\\cdot 135}{2\\cdot 29\\cdot 28\\cdot 26}.\n$$\n将分子和分母计算为整数：\n$$\n19\\cdot 17=323,\\quad 323\\cdot 135=43605,\n$$\n$$\n29\\cdot 28=812,\\quad 812\\cdot 26=21112,\\quad 2\\cdot 21112=42224.\n$$\n因此\n$$\nR=\\frac{43605}{42224}.\n$$\n因为 $43605>42224$，我们有 $R>1$，所以 $P_{\\text{no coll},A}>P_{\\text{no coll},B}$。所以\n$$\nP_{\\text{coll},A}=1-P_{\\text{no coll},A}  1-P_{\\text{no coll},B}=P_{\\text{coll},B}.\n$$\n因此，情景 B 发生冲突的概率更高。", "answer": "$$\\boxed{B}$$", "id": "1404673"}, {"introduction": "这个练习触及了生日问题最引人入胜且违反直觉的一面：需要多少个项目才能使得出现碰撞的概率超过一个特定阈值（例如 $0.5$）？这个问题不仅仅是一个智力游戏，它在密码学哈希碰撞和数据库负载均衡等领域有重要的实际应用。本题将带你估算在分布式数据库系统中，需要多少个数据键就能以超过 $50\\%$ 的概率引发一次服务器分配冲突。[@problem_id:1404642]", "problem": "一个大规模分布式数据库系统使用一种简单的哈希方案来将其数据键分布到各个服务器上。集群中有 $N=64$ 台服务器。当添加一个新键时，会对其应用一个哈希函数，然后该键被存储在索引为 `hash(key) mod N` 的服务器上。假设哈希函数是理想的，即它将键均匀且随机地分布到各个服务器上。至少需要向数据库中插入多少个键，才能使得至少发生一次“碰撞”（即至少有两个键被分配到同一台服务器）的概率严格大于 $0.5$？", "solution": "设 $N=64$ 为服务器数量，$m$ 为插入的键的数量。当至少有两个键被分配到同一台服务器时，即发生“碰撞”。我们需要找到最小的整数 $m$，使得碰撞概率严格大于 $0.5$。\n\n这个事件的补集是“所有 $m$ 个键都被分配到不同的服务器”。其概率为：\n$$ P(\\text{无碰撞}) = \\frac{N \\times (N-1) \\times \\cdots \\times (N-m+1)}{N^m} = \\prod_{i=0}^{m-1} \\frac{N-i}{N} $$\n我们要找的是最小的 $m$，使得 $P(\\text{碰撞}) = 1 - P(\\text{无碰撞}) > 0.5$，这等价于 $P(\\text{无碰撞})  0.5$。\n\n我们可以通过代入 $m$ 的值来测试这个不等式。根据生日问题的近似公式 $m \\approx \\sqrt{2N \\ln 2} = \\sqrt{2 \\times 64 \\times \\ln 2} \\approx \\sqrt{128 \\times 0.693} \\approx \\sqrt{88.7} \\approx 9.4$，我们可以预期答案在 $m=9$ 或 $m=10$ 左右。\n\n**检验 $m=9$:**\n$$ P_{m=9}(\\text{无碰撞}) = \\prod_{i=0}^{8} \\frac{64-i}{64} = \\frac{64 \\times 63 \\times \\cdots \\times 56}{64^9} \\approx 0.5296 $$\n由于 $P_{m=9}(\\text{无碰撞}) \\approx 0.5296 > 0.5$，当插入9个键时，碰撞概率为 $1 - 0.5296 = 0.4704$，尚未超过 $0.5$。\n\n**检验 $m=10$:**\n我们可以利用上一步的结果来计算：\n$$ P_{m=10}(\\text{无碰撞}) = P_{m=9}(\\text{无碰撞}) \\times \\frac{64-9}{64} \\approx 0.5296 \\times \\frac{55}{64} \\approx 0.5296 \\times 0.859375 \\approx 0.4552 $$\n由于 $P_{m=10}(\\text{无碰撞}) \\approx 0.4552  0.5$，当插入10个键时，碰撞概率为 $1 - 0.4552 \\approx 0.5448$，已经严格大于 $0.5$。\n\n因为 $P(\\text{无碰撞})$ 随着 $m$ 的增加而单调递减，所以使得碰撞概率首次超过 $0.5$ 的最小键数是 $10$。", "answer": "$$\\boxed{10}$$", "id": "1404642"}]}