{"hands_on_practices": [{"introduction": "掌握期望线性性质的最佳方式莫过于亲手实践。这些练习旨在引导你将复杂问题分解为简单、可管理的部分，从而深刻理解其核心思想。我们的第一个练习从一个经典的圆环排列问题开始。即使一个“扣环”的形成似乎会影响其相邻位置（因为它们共享一个珠子），我们也可以通过简单地将每个潜在扣环形成的概率相加来计算期望值，完全无需考虑它们之间的相互依赖性。这完美地展示了期望线性性质的强大之处([@problem_id:1381835])。", "problem": "一个由 $n$ 个珠子构成的圆形项链，其中 $n$ 是一个大于或等于2的整数。这些珠子排列成一个圆圈。对于项链上的 $n$ 个位置，每个位置的珠子颜色是独立选择的。任何一个珠子是黑色的概率是 $p$，是白色的概率是 $1-p$。一个称为“扣环”的特殊装饰，由一对相邻的珠子形成，其中当沿顺时针方向移动时，一个黑色珠子紧随一个白色珠子。确定项链上扣环的期望数量。您的答案应为一个关于 $n$ 和 $p$ 的解析表达式。", "solution": "将项链上的 $n$ 个位置按顺时针顺序标记为 $1,2,\\dots,n$，并将索引 $n+1$ 解释为 $1$ 以考虑其圆形性质。为每一对相邻的珠子定义指示随机变量：\n$$\nX_{i}=\\begin{cases}\n1  \\text{如果位置 } i \\text{ 是黑色且位置 } i+1 \\text{ 是白色}，\\\\\n0  \\text{否则}，\n\\end{cases}\n$$\n对于 $i=1,2,\\dots,n$。扣环的总数则为\n$$\nX=\\sum_{i=1}^{n}X_{i}。\n$$\n根据期望的线性性质，\n$$\n\\mathbb{E}[X]=\\sum_{i=1}^{n}\\mathbb{E}[X_{i}]。\n$$\n对于每个 $i$，利用珠子颜色的独立性，\n$$\n\\mathbb{E}[X_{i}]=\\mathbb{P}(X_{i}=1)=\\mathbb{P}(\\text{位置 } i \\text{ 是黑色且位置 } i+1 \\text{ 是白色})=\\mathbb{P}(\\text{位置 } i \\text{ 是黑色})\\,\\mathbb{P}(\\text{位置 } i+1 \\text{ 是白色})=p(1-p)。\n$$\n因此，\n$$\n\\mathbb{E}[X]=\\sum_{i=1}^{n}p(1-p)=n\\,p(1-p)。\n$$", "answer": "$$\\boxed{n\\,p\\left(1-p\\right)}$$", "id": "1381835"}, {"introduction": "接下来，我们将难度提升一步，从独立的珠子选择转向相互依赖的排列问题。我们的目标是找出一个随机数据序列中“局部最大值”的期望数量。这个练习([@problem_id:1381841])的关键洞见在于，我们可以通过局部地分析每个位置成为峰值的概率，而无需担忧整个排列的复杂结构。这展示了聚焦于简单子问题如何能有效破解看似棘手的难题，并引入了对边界情况和内部情况进行分类讨论的重要技巧。", "problem": "考虑一个序列 $a_1, a_2, \\ldots, a_n$，它是由整数集合 $\\{1, 2, \\ldots, n\\}$ 的一个随机排列构成的，其中 $n$ 是一个满足 $n \\ge 2$ 的整数。在这样的一个排列中，这 $n$ 个整数的每一种可能的排序都是等概率的。\n\n序列中的一个元素 $a_i$ 根据其位置 $i$ 遵循以下规则被定义为一个“局部最大值”：\n- 当 $i=1$ 时，$a_1$ 是一个局部最大值，如果 $a_1  a_2$。\n- 当 $i=n$ 时，$a_n$ 是一个局部最大值，如果 $a_n  a_{n-1}$。\n- 当 $1  i  n$ 时，$a_i$ 是一个局部最大值，如果 $a_i  a_{i-1}$ 并且 $a_i  a_{i+1}$。\n\n确定在这样一个随机排列中局部最大值的期望数量。你的答案应该是一个关于 $n$ 的符号表达式。", "solution": "设 $S$ 为随机排列中局部最大值的总数。对于 $i \\in \\{1,2,\\ldots,n\\}$，定义指示变量 $X_{i}$，如果 $a_{i}$ 是一个局部最大值（根据给定的位置规则），则设 $X_{i}=1$，否则设 $X_{i}=0$。那么\n$$\nS=\\sum_{i=1}^{n} X_{i}.\n$$\n根据期望的线性性质，\n$$\n\\mathbb{E}[S]=\\sum_{i=1}^{n} \\mathbb{E}[X_{i}]=\\sum_{i=1}^{n} \\mathbb{P}(a_{i}\\text{ is a local maximum}).\n$$\n\n对于端点：\n- 在 $i=1$ 处，$a_{1}$ 是一个局部最大值的充要条件是 $a_{1}a_{2}$。由于 $a_{1}$ 和 $a_{2}$ 这两个值以任何一种顺序出现的可能性是相等的，\n$$\n\\mathbb{P}(a_{1}\\text{ is a local maximum})=\\frac{1}{2}.\n$$\n- 类似地，在 $i=n$ 处，$a_{n}$ 是一个局部最大值的充要条件是 $a_{n}a_{n-1}$，得到\n$$\n\\mathbb{P}(a_{n}\\text{ is a local maximum})=\\frac{1}{2}.\n$$\n\n对于内部位置 $1in$，如果 $a_{i}$ 是一个局部最大值，它必须大于它的两个邻居 $a_{i-1}$ 和 $a_{i+1}$。考虑任意三个不同的值 $v_1, v_2, v_3$。当随机分配到位置 $i-1, i, i+1$ 时，最大的值出现在位置 $i$ 的概率是 $1/3$。由于这是一个随机排列，我们可以将这个论证应用于位于 $a_{i-1}, a_i, a_{i+1}$ 的值。因此，\n$$\n\\mathbb{P}(a_{i}\\text{ is a local maximum})=\\frac{1}{3}.\n$$\n总共有 $n-2$ 个这样的内部位置。\n将所有期望加起来：\n$$\n\\mathbb{E}[S] = \\mathbb{E}[X_1] + \\sum_{i=2}^{n-1} \\mathbb{E}[X_i] + \\mathbb{E}[X_n] = \\frac{1}{2} + (n-2)\\cdot\\frac{1}{3} + \\frac{1}{2} = 1 + \\frac{n-2}{3} = \\frac{3+n-2}{3} = \\frac{n+1}{3}.\n$$", "answer": "$$\\boxed{\\frac{n+1}{3}}$$", "id": "1381841"}, {"introduction": "最后一个练习将我们带到一个不同的领域——网络节点配置，这突显了期望线性性质在不同学科中的广泛适用性。在这个场景中，随机事件是对所有节点的完全配对，这创造了复杂的全局依赖关系。然而，其解决方案([@problem_id:1381819])巧妙地聚焦于单个节点的“命运”，然后利用这一结果来构建总体期望。这是一种在概率分析中常见且非常有效的策略，它教会我们如何通过巧妙地定义指示变量来绕过复杂的依赖网络。", "problem": "在一个大型数据中心，一次灾难性的网络交换机故障导致一个集群中的所有 $2n$ 个节点都失去了其指定的连接。这些节点由 $n$ 个专用服务器和 $n$ 个专用客户端组成。一个紧急恢复协议被启动，该协议试图通过将 $2n$ 个节点随机划分为 $n$ 个不同的通信对来恢复连接。将 $2n$ 个节点划分为 $n$ 对的每一种可能划分都是等可能的。\n\n如果一个服务器与另一个服务器配对，或者一个客户端与另一个客户端配对，就会发生“类型不匹配”错误。对于预期的客户端-服务器架构，这样的配对是无法正常工作的。\n\n出现类型不匹配错误的配对的期望数量是多少？请用关于 $n$ 的闭式解析表达式表示你的答案。", "solution": "设这 $2n$ 个节点由 $n$ 个服务器组成的集合 $S$ 和 $n$ 个客户端组成的集合 $C$ 构成。我们均匀地选择一个将节点随机划分为 $n$ 个无序对的划分（一个随机完美匹配）。\n\n对于每个服务器 $i \\in S$，定义指示变量 $I_{i}$：如果服务器 $i$ 与另一个服务器配对，则 $I_{i}=1$；否则 $I_{i}=0$。服务器 $i$ 的配对伙伴是从余下的 $2n-1$ 个节点中均匀选择的，其中有 $n-1$ 个服务器。因此，\n$$\n\\mathbb{P}(I_{i}=1)=\\frac{n-1}{2n-1}.\n$$\n根据期望的线性性质，\n$$\n\\mathbb{E}\\left[\\sum_{i \\in S} I_{i}\\right]=\\sum_{i \\in S} \\mathbb{E}[I_{i}]=n \\cdot \\frac{n-1}{2n-1}.\n$$\n和 $\\sum_{i \\in S} I_{i}$ 将每个服务器-服务器对计算了两次（该配对中的每个服务器各算一次）。因此，服务器-服务器配对的期望数量，记为 $\\mathbb{E}[\\text{SS}]$，是\n$$\n\\mathbb{E}[\\text{SS}]=\\frac{1}{2} \\cdot n \\cdot \\frac{n-1}{2n-1}=\\frac{n(n-1)}{2(2n-1)}.\n$$\n根据对称性，客户端-客户端配对的期望数量 $\\mathbb{E}[\\text{CC}]$ 是相同的：\n$$\n\\mathbb{E}[\\text{CC}]=\\frac{n(n-1)}{2(2n-1)}.\n$$\n类型不匹配配对的总数是 $M=\\text{SS}+\\text{CC}$，因此根据期望的线性性质，\n$$\n\\mathbb{E}[M]=\\mathbb{E}[\\text{SS}]+\\mathbb{E}[\\text{CC}]=\\frac{n(n-1)}{2(2n-1)}+\\frac{n(n-1)}{2(2n-1)}=\\frac{n(n-1)}{2n-1}.\n$$\n因此，出现类型不匹配错误的配对的期望数量是 $\\frac{n(n-1)}{2n-1}$。", "answer": "$$\\boxed{\\frac{n(n-1)}{2n-1}}$$", "id": "1381819"}]}