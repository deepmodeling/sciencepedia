{"hands_on_practices": [{"introduction": "我们将通过一系列精心设计的练习，从基础到进阶，逐步掌握Pólya枚举理论。第一个练习将带我们进入一个熟悉的场景——摩天轮，来处理一个基本的对称性计数问题。通过这个练习 [@problem_id:1391972]，我们将应用Burnside引理来解决纯旋转对称下的着色方案计数，这是理解更复杂群作用的坚实起点。", "problem": "一家公司正在设计一个大型摩天轮，它有10个相同的乘客座舱，呈圆形排列。为了使这个游乐设施在视觉上更具吸引力，需要对座舱进行涂色。现有3种不同的颜色可供使用。一个涂色方案定义为给10个座舱中的每一个分配一种颜色。\n\n如果一个涂色方案可以通过旋转整个摩天轮变换成另一个方案，那么这两个方案被认为是不可区分的。反射不被视为有效的变换（即，我们只关心旋转对称）。\n\n计算所有可能的不同涂色方案的总数。", "solution": "我们将这10个呈圆形排列的座舱建模，其旋转构成循环群 $C_{10}$，该群通过置换座舱位置作用于涂色方案。如果两个涂色方案在这一作用下处于同一轨道，则它们被认为是相同的。根据Burnside引理（Burnside's lemma），不同涂色方案的数量等于被群元素固定的涂色方案数量的平均值：\n$$\nN=\\frac{1}{|C_{10}|}\\sum_{g\\in C_{10}}|\\text{Fix}(g)|.\n$$\n用 $k$ 步表示一次旋转，其中 $k\\in\\{0,1,\\dots,9\\}$。这样的旋转将10个位置分解为 $\\gcd(10,k)$ 个循环，因为每个循环的长度为 $10/\\gcd(10,k)$。一个涂色方案被此旋转固定，当且仅当每个循环中的所有位置都具有相同的颜色，从而得到\n$$\n|\\text{Fix}(k)|=3^{\\gcd(10,k)}.\n$$\n因此，\n$$\nN=\\frac{1}{10}\\sum_{k=0}^{9}3^{\\gcd(10,k)}.\n$$\n我们根据 $\\gcd(10,k)$ 的值对 $k$ 进行分类：\n- 当 $k=0$ 时，为恒等操作，有10个循环，贡献为 $3^{10}$。\n- 当 $k\\in\\{1,3,7,9\\}$ 时，$\\gcd(10,k)=1$，有4个这样的旋转，贡献为 $4\\cdot 3^{1}$。\n- 当 $k\\in\\{2,4,6,8\\}$ 时，$\\gcd(10,k)=2$，有4个这样的旋转，贡献为 $4\\cdot 3^{2}$。\n- 当 $k=5$ 时，$\\gcd(10,5)=5$，有1个这样的旋转，贡献为 $3^{5}$。\n\n因此，\n$$\nN=\\frac{1}{10}\\left(3^{10}+4\\cdot 3^{1}+4\\cdot 3^{2}+3^{5}\\right).\n$$\n计算 $3$ 的幂次方，得到 $3^{10}=59049$，$3^{2}=9$ 和 $3^{5}=243$，所以\n$$\nN=\\frac{1}{10}\\left(59049+4\\cdot 3+4\\cdot 9+243\\right)=\\frac{1}{10}\\left(59049+12+36+243\\right)=\\frac{59340}{10}=5934.\n$$\n因此，不同涂色方案的总数为 $5934$。", "answer": "$$\\boxed{5934}$$", "id": "1391972"}, {"introduction": "在掌握了纯旋转对称之后，我们将挑战一个更复杂的场景，它同时包含旋转和翻转（反射）对称。这个问题 [@problem_id:1391984] 以一个六边形蛋白分子为模型，引入了二面体群 $D_6$。通过解决这个问题，你将学会如何系统地分解二面体群中的所有对称操作，并计算每种操作下保持不变的构型数量，这是处理更广泛对称性问题的关键一步。", "problem": "在合成生物学领域，一位研究人员正在设计一种新型的环状蛋白质。这种蛋白质有六个功能上相同的结合位点，排列在一个正六边形的顶点上。每个结合位点都可以在两种不同的状态之间切换：“活性”或“非活性”。\n\n整个蛋白质分子可以在六边形所在的二维平面内自由旋转，也可以翻转（即沿平面内的一个轴进行反射）。因此，如果一种结合位点构型可以通过这些旋转或反射中的任意一种变换成另一种构型，那么这两种构型就被认为是不可区分的。\n\n你的任务是确定这种蛋白质分子真正不同的构型总数。", "solution": "我们将该蛋白质建模为对正六边形的6个顶点用两种颜色（活性/非活性）进行着色，并在二面体群（旋转和反射）的作用下视为等价。设$G$是阶为$|G|=12$的二面体群$D_{6}$。根据Burnside引理，不同构型的数量为\n$$\nN=\\frac{1}{|G|}\\sum_{g\\in G}|\\mathrm{Fix}(g)|,\n$$\n其中$\\mathrm{Fix}(g)$是在$g$作用下保持不变的着色方案数。一个着色方案在$g$作用下保持不变，当且仅当对于由$g$引起的6个顶点的置换中的每一个轮换，该轮换上的所有顶点颜色都相同。对于两种颜色，这意味着$|\\mathrm{Fix}(g)|=2^{c(g)}$，其中$c(g)$是轮换的数量。\n\n我们按类型对群元素进行分类，并为每种类型计算$2^{c(g)}$。\n\n旋转（6个元素）：\n- 单位元旋转：轮换结构是6个不动点，所以$c=6$，贡献$2^{6}$。\n- 旋转$60^{\\circ}$和$300^{\\circ}$：每个都是一个长度为6的轮换，所以$c=1$，共贡献$2\\cdot 2^{1}$。\n- 旋转$120^{\\circ}$和$240^{\\circ}$：每个都有两个长度为3的轮换，所以$c=2$，共贡献$2\\cdot 2^{2}$。\n- 旋转$180^{\\circ}$：有三个长度为2的轮换，所以$c=3$，贡献$1\\cdot 2^{3}$。\n\n反射（6个元素），对于偶数$n=6$有两种类型：\n- 经过对角顶点的对称轴（3个反射）：轮换结构是2个不动点和2个对换，所以$c=4$，共贡献$3\\cdot 2^{4}$。\n- 经过对边中点的对称轴（3个反射）：轮换结构是3个对换，所以$c=3$，共贡献$3\\cdot 2^{3}$。\n\n将以上各项求和，然后除以$|G|=12$，我们得到\n$$\nN=\\frac{1}{12}\\left(2^{6}+2\\cdot 2^{1}+2\\cdot 2^{2}+1\\cdot 2^{3}+3\\cdot 2^{4}+3\\cdot 2^{3}\\right)\n=\\frac{1}{12}\\left(64+4+8+8+48+24\\right)\n=\\frac{156}{12}\n=13.\n$$\n因此，共有13种真正不同的构型。", "answer": "$$\\boxed{13}$$", "id": "1391984"}, {"introduction": "最后的这个练习将引导我们探索Pólya枚举理论的精髓——模式清单。与之前仅仅计算总数不同，这个问题 [@problem_id:1391993] 要求我们生成一个多项式，其系数详细说明了包含特定数量不同颜色珠子的手镯设计方案。此外，它还引入了一个额外的组合约束（蓝色珠子不能相邻），这要求我们将Burnside引理与组合计数技巧相结合，充分展示了该理论在解决复杂约束问题时的强大威力。", "problem": "要设计一个由8颗珠子组成的圆形手链。每颗珠子可以被染成红色（R）或蓝色（B）。一个设计是有效的，当且仅当手链上没有两颗相邻的蓝色珠子。如果一个手链设计可以通过旋转或翻转变成另一个，那么这两个设计被认为是相同的。这对应于正八边形的对称集，即二面体群 $D_8$。\n\n令变量 $r$ 代表红色珠子，$b$ 代表蓝色珠子。求模式清单（pattern inventory），它是一个关于 $r$ 和 $b$ 的多项式，形式为 $\\sum_{k=0}^{8} c_k r^{8-k} b^k$，其中系数 $c_k$ 是恰好有 $k$ 颗蓝色珠子的不同有效手链设计的数量。", "solution": "我们在阶为16的二面体群 $D_{8}$ 上应用Burnside引理。对于每个 $g \\in D_{8}$，令 $F_{g}(r,b)$ 为由 $g$ 固定的有效着色的权重计数器，其中有效着色没有相邻的蓝色珠子。所求的模式清单为\n$$\nP(r,b)=\\frac{1}{16}\\sum_{g\\in D_{8}}F_{g}(r,b).\n$$\n\n旋转。旋转 $t$ 步有 $d=\\gcd(8,t)$ 个循环，并强制周期为 $d$。8-循环上的有效性约束简化为在 $d$-循环上的相同约束，重复 $m=8/d$ 次。如果 $H_{d}(x,y)$ 是在长度为 $d$ 的循环上有效着色的计数器，其中红色的权重为 $x$，蓝色的权重为 $y$，那么对于旋转 $t$ 步，\n$$\nF_{R_{t}}(r,b)=H_{d}\\!\\left(r^{m},b^{m}\\right),\\quad d=\\gcd(8,t),\\ m=\\frac{8}{d}.\n$$\n对于一个长度为 $n$ 的循环，恰好有 $k$ 个蓝色珠子（循环中不相邻）的数量是 $N(n,k)=\\frac{n}{n-k}\\binom{n-k}{k}$，对于 $0\\leq k\\leq \\lfloor n/2\\rfloor$。因此\n- $H_{1}(x,y)=x$,\n- $H_{2}(x,y)=x^{2}+2xy$,\n- $H_{4}(x,y)=x^{4}+4x^{3}y+2x^{2}y^{2}$,\n- $H_{8}(x,y)=x^{8}+8x^{7}y+20x^{6}y^{2}+16x^{5}y^{3}+2x^{4}y^{4}$.\n\n按旋转类型分类：\n- $t=0$（一个元素）：$F=H_{8}(r,b)=r^{8}+8r^{7}b+20r^{6}b^{2}+16r^{5}b^{3}+2r^{4}b^{4}$。\n- $t=4$（一个元素）：$F=H_{4}(r^{2},b^{2})=r^{8}+4r^{6}b^{2}+2r^{4}b^{4}$。\n- $t=2,6$（两个元素）：$F=H_{2}(r^{4},b^{4})=r^{8}+2r^{4}b^{4}$。\n- $t=1,3,5,7$（四个元素）：$F=H_{1}(r^{8},b^{8})=r^{8}$。\n\n对所有8个旋转求和得到\n$$\n\\text{旋转操作的贡献总和}=8r^{8}+8r^{7}b+24r^{6}b^{2}+16r^{5}b^{3}+8r^{4}b^{4}。\n$$\n\n反射。对于 $n=8$ 有两种类型。\n\n过顶点的对称轴反射（4个元素）：两个相对的顶点是固定的；其他六个顶点形成三对镜像对。不变着色由一个包含五个轨道节点的路径决定，权重为 $(1,2,2,2,1)$（中间三个节点对应于顶点对，贡献双倍权重）。手链上“没有相邻蓝色”的约束变成了这条路径上“没有相邻蓝色”。在独立集 $S\\subset\\{0,1,2,3,4\\}$ 上的权重计数器是\n$$\nG_{V}(r,b)=\\sum_{S\\ \\text{indep.}} r^{8-\\sum_{i\\in S}c_{i}}\\,b^{\\sum_{i\\in S}c_{i}},\\quad (c_{0},c_{1},c_{2},c_{3},c_{4})=(1,2,2,2,1),\n$$\n其计算结果（通过直接枚举或动态规划）为\n$$\nG_{V}(r,b)=r^{8}+2r^{7}b+4r^{6}b^{2}+4r^{5}b^{3}+2r^{4}b^{4}。\n$$\n所有四个此类反射的贡献是\n$$\n4G_{V}=4r^{8}+8r^{7}b+16r^{6}b^{2}+16r^{5}b^{3}+8r^{4}b^{4}。\n$$\n\n过边的对称轴反射（4个元素）：有四对镜像顶点对；其中两对的顶点在对内是相邻的，因此它们不能被染成蓝色（否则会导致两个相邻的蓝色珠子）。因此，这两对必须是红色的。剩下的两对非相邻顶点对可以自由着色，只是不能同时为蓝色（因为它们彼此相邻）。因此，对于一个这样的反射，\n$$\nG_{E}(r,b)=r^{4}\\bigl(r^{4}+2r^{2}b^{2}\\bigr)=r^{8}+2r^{6}b^{2},\n$$\n而对于所有四个，\n$$\n4G_{E}=4r^{8}+8r^{6}b^{2}。\n$$\n\n对所有16个群元素求和并取平均值，\n$$\n\\sum_{g\\in D_{8}}F_{g}=(8+4+4)r^{8}+(8+8)r^{7}b+(24+16+8)r^{6}b^{2}+(16+16)r^{5}b^{3}+(8+8)r^{4}b^{4},\n$$\n即\n$$\n\\sum_{g\\in D_{8}}F_{g}=16r^{8}+16r^{7}b+48r^{6}b^{2}+32r^{5}b^{3}+16r^{4}b^{4}。\n$$\n因此\n$$\nP(r,b)=\\frac{1}{16}\\sum_{g\\in D_{8}}F_{g}(r,b)=r^{8}+r^{7}b+3r^{6}b^{2}+2r^{5}b^{3}+r^{4}b^{4}。\n$$\n因此系数为 $c_{0}=1$，$c_{1}=1$，$c_{2}=3$，$c_{3}=2$，$c_{4}=1$，且对于 $k\\geq 5$，$c_{k}=0$。", "answer": "$$\\boxed{r^{8}+r^{7}b+3r^{6}b^{2}+2r^{5}b^{3}+r^{4}b^{4}}$$", "id": "1391993"}]}