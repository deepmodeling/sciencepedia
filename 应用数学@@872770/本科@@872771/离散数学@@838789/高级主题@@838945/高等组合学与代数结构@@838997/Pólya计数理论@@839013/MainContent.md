## 引言
在科学与工程的诸多领域中，我们常常面临一类特殊的计数问题：当某些对象在旋转、翻转或其他变换下被视为“相同”时，我们该如何计算本质上不同的种类有多少？从计算分子的不同空间构型，到设计不等价的电路板，再到创作独特的图案，对对称性的处理是解决这些问题的核心。直接枚举所有可能性然后剔除重复项，在[组合爆炸](@entry_id:272935)面前往往束手无策。Pólya枚举理论正是为解决这一挑战而生，它提供了一套基于群论的强大而优雅的数学框架，使对称性下的计数变得系统而精确。

本文旨在深入浅出地介绍Pólya枚举理论，帮助读者掌握其强大的分析工具。我们将通过三个章节的探索，带领你从理论基础走向实际应用：

- 在“**原理和机制**”一章中，我们将奠定理论基石，从[对称群](@entry_id:146083)的概念出发，详细解读[Burnside引理](@entry_id:146768)如何计算不等价模式的总数，并进一步学习Pólya枚举定理如何通过[循环指数](@entry_id:263418)实现更精细的计数。
- 接着，在“**应用与跨学科联系**”一章里，我们将展示该理论的非凡威力，通过化学、计算机科学、图论乃至音乐理论中的丰富实例，让你领略其如何跨越学科界限，解决形形色色的实际问题。
- 最后，在“**动手实践**”部分，你将有机会通过一系列精心设计的练习，亲手应用所学知识，将抽象的理论转化为解决具体问题的能力，从而真正内化Pólya枚举理论的精髓。

现在，让我们一同开启这段探索对称之美的数学旅程。

## 原理和机制

在组合数学中，许多计数问题的核心挑战并非仅仅是[排列](@entry_id:136432)或组合，而是在某种对称性下对“等价”的模式进行计数。例如，当我们将珠子串成项链时，旋转或翻转后的项链通常被认为是同一条。同样，在化学中，一个分子在空间中旋转后得到的构型与原始构型是不可区分的。Pólya枚举理论为解决这类问题提供了一个强大而系统的框架。本章将深入探讨该理论的核心工具——[Burnside引理](@entry_id:146768)和Pólya枚举定理，并展示它们在不同场景下的应用。

### 对称性、群论和[轨道](@entry_id:137151)

在深入数学工具之前，我们首先需要精确地定义“对称性”。在数学上，一个对象的**对称操作**是指对该对象进行某种变换后，其外观保持不变。例如，一个正方形旋转90°、180°或270°后，看起来和原来一样。所有这些[对称操作](@entry_id:143398)（包括“旋转0°”，即恒等操作）的集合构成了一个[代数结构](@entry_id:137052)，称为**群 (group)**。

当我们将一个对象（如图形、分子等）的各个部分（如顶点、边、面）进行着色时，我们得到一个**着色方案**或**构型**。[对称操作](@entry_id:143398)不仅作用于对象本身，也作用于其上的着色方案。例如，将一个正方形的左上角涂成红色，然后将正方形顺时针旋转90°，这相当于将右上角涂成红色的构型。

在一个对称群 $G$ 的作用下，所有可以通过群中某个操作相互转换的着色方案被归为一类，这个[等价类](@entry_id:156032)被称为一个**[轨道](@entry_id:137151) (orbit)**。我们的目标，本质上就是计算在给定[对称群](@entry_id:146083)下[轨道](@entry_id:137151)的数量，即“不等价”的着色方案总数。

### [Burnside引理](@entry_id:146768)：计数的基石

[Burnside引理](@entry_id:146768)是群论中一个优雅而强大的计数工具，它直接给出了[轨道](@entry_id:137151)的数量。该引理指出，[轨道](@entry_id:137151)的数量等于所有群元素所固定的着色方案数量的平均值。

**[Burnside引理](@entry_id:146768)**：令 $G$ 是作用在集合 $X$（所有可能的着色方案）上的一个[有限群](@entry_id:139710)。$X$ 在 $G$ 作用下的[轨道](@entry_id:137151)数 $N$ 为：
$$N = \frac{1}{|G|} \sum_{g \in G} |\text{Fix}(g)|$$
其中：
- $|G|$ 是群 $G$ 的阶，即群中对称操作的总数。
- $g$ 是群 $G$ 中的一个元素，代表一个具体的对称操作。
- $\text{Fix}(g)$ 是在操作 $g$ 下保持不变的 $X$ 中元素的集合，即 $\text{Fix}(g) = \{x \in X \mid g(x) = x\}$。这些元素被称为 $g$ 的**[不动点](@entry_id:156394)**。
- $|\text{Fix}(g)|$ 是[不动点](@entry_id:156394)的数量。

为了理解这一定理的应用，我们从最简单的对称性——旋转对称性开始。

#### 应用一：[循环群](@entry_id:138668)和旋转对称

许多问题只涉及旋转对称性，其对称群是**[循环群](@entry_id:138668)** $C_n$。

考虑一个设计成环形的食物分配器，它有6个隔间，每个隔间可以填充两种营养膏中的一种。如果一种布置可以通过旋转得到另一种，则它们被视为相同。我们需要计算有多少种不同的布置方式[@problem_id:1391987]。

这里的对象是环形[排列](@entry_id:136432)的6个隔间，着色集是{蛋白质膏，碳水化合物膏}，共 $m=2$ 种颜色。对称群是6阶[循环群](@entry_id:138668) $C_6$，包含旋转0, 1, 2, 3, 4, 5个位置的操作，因此 $|G|=6$。总的着色方案有 $2^6 = 64$ 种。

我们逐一计算每个旋转操作固定的着色方案数：
- **旋转0位 (恒等操作 $e$)**：该操作不移动任何东西，因此所有 $2^6 = 64$ 种着色方案都保持不变。$|\text{Fix}(e)| = 64$。
- **旋转1位或5位**：要使着色在旋转1位后不变，所有6个隔间必须颜色相同。这形成了一个长度为6的循环。因此，只有两种方案（全为蛋白质膏或全为碳水化合物膏）被固定。$|\text{Fix}(\text{rot}_1)| = |\text{Fix}(\text{rot}_5)| = 2$。
- **旋转2位或4位**：此操作将6个隔间[置换](@entry_id:136432)成2个长度为3的循环（例如，{1,3,5} 和 {2,4,6}）。要使着色不变，每个循环内的隔间颜色必须一致。因为有2个独立的循环，每个循环有2种颜色选择，所以有 $2^2 = 4$ 种固定方案。$|\text{Fix}(\text{rot}_2)| = |\text{Fix}(\text{rot}_4)| = 4$。
- **旋转3位**：此操作产生3个长度为2的循环（{1,4}, {2,5}, {3,6}）。同理，有 $2^3 = 8$ 种固定方案。$|\text{Fix}(\text{rot}_3)| = 8$。

一个普遍的规律是，对于 $n$ 个对象的环形[排列](@entry_id:136432)，旋转 $k$ 个位置产生的循环数为 $n$ 和 $k$ 的[最大公约数](@entry_id:142947)，即 $\gcd(n,k)$。因此，对于 $m$ 种颜色，[不动点](@entry_id:156394)的数量为 $m^{\gcd(n,k)}$。

根据[Burnside引理](@entry_id:146768)，不同的布置方式总数为：
$$N = \frac{1}{6} \left( 2^6 + 2^{\gcd(6,1)} + 2^{\gcd(6,2)} + 2^{\gcd(6,3)} + 2^{\gcd(6,4)} + 2^{\gcd(6,5)} \right)$$
$$N = \frac{1}{6} (64 + 2 + 4 + 8 + 4 + 2) = \frac{84}{6} = 14$$
因此，共有14种不同的布置方式。

同样的方法可以应用于其他只涉及旋转对称的问题，例如一个四角引脚的方形芯片设计，每个引脚有3种功能。这相当于用3种颜色对正方形的4个顶点进行着色，[对称群](@entry_id:146083)为4阶循环群 $C_4$ [@problem_id:1391989]。不等价的设计数为：
$$N = \frac{1}{4} (3^4 + 3^{\gcd(4,1)} + 3^{\gcd(4,2)} + 3^{\gcd(4,3)}) = \frac{1}{4} (81 + 3 + 9 + 3) = \frac{96}{4} = 24$$

### 扩展对称性：[二面体群](@entry_id:143875)

许多平面图形不仅具有[旋转对称](@entry_id:137077)性，还具有反射（翻转）对称性。包含一个 $n$ 边正多边形的所有[旋转和反射](@entry_id:136876)对称的群称为**[二面体群](@entry_id:143875)** $D_n$，其阶为 $|D_n|=2n$。

让我们考虑一个化学问题：一个合成蛋白质的核心结构是正五边形，其五个结合位点每个都可以连接4种不同的[配体](@entry_id:146449)之一。由于分子可以在溶液中自由翻转，旋转或反射后相同的构型被视为化学上不可区分。我们需要计算有多少种不同的蛋白质变体[@problem_id:1392004]。

此问题等价于用4种颜色对正五边形的5个顶点进行着色，对称群是二面体群 $D_5$，其阶为 $|D_5|=10$。
$D_5$ 的元素包括：
1.  **1个恒等操作**：固定所有 $4^5 = 1024$ 种着色。
2.  **4个非平凡旋转操作**（旋转72°, 144°, 216°, 288°）：每个旋转都将5个顶点[置换](@entry_id:136432)成一个长度为5的循环。要使着色不变，所有顶点必须同色。因此，每个旋转固定4种着色。总贡献为 $4 \times 4 = 16$。
3.  **5个反射操作**：对于正五边形，每个反射的[对称轴](@entry_id:177299)都穿过一个顶点和对边的中点。该操作固定一个顶点，并交换两对顶点。因此，它将5个顶点[置换](@entry_id:136432)成一个1-循环和两个2-循环。一个着色方案若被此反射固定，则其在每个循环内的顶点颜色必须一致。我们有3个独立的循环，因此每个反射固定的着色方案数为 $4^3 = 64$。总贡献为 $5 \times 64 = 320$。

应用[Burnside引理](@entry_id:146768)：
$$N = \frac{1}{10} (1024 + 16 + 320) = \frac{1360}{10} = 136$$
因此，可以合成136种化学上不同的蛋白质变体。

### 三维空间的枚举：正[多面体](@entry_id:637910)

[Burnside引理](@entry_id:146768)同样适用于三维物体的对称性。此时，对称群是物体的空间[旋转群](@entry_id:204412)。

#### 示例一：正四面体

考虑甲烷分子 $CH_4$ 的[同位素取代](@entry_id:174631)问题。甲烷的4个氢原子位于一个正四面体的顶点上。我们可以用氘 (D) 替换任意数量的氢 (H)。如果一个分子可以通过空间旋转与另一个分子重合，则它们是相同的。我们需要确定可形成多少种不同的分子[@problem_id:1392017]。

这等价于用2种颜色（H和D）对正四面体的4个顶点进行着色。[对称群](@entry_id:146083)是正四面体的[旋转群](@entry_id:204412)，它同构于[4次交错群](@entry_id:142381) $A_4$，阶为12。
群元素根据[旋转轴](@entry_id:187094)分为几类：
- **1个恒等操作**：将4个顶点[置换](@entry_id:136432)成4个1-循环。固定 $2^4 = 16$ 种着色。
- **8个穿过顶点和对面中心轴的旋转（120°或240°）**：每个旋转固定一个顶点，并[循环置换](@entry_id:272913)另外三个。[置换](@entry_id:136432)结构是1个1-循环和1个3-循环，共2个循环。固定着色数是 $2^2 = 4$。总贡献为 $8 \times 4 = 32$。
- **3个穿过对边中点轴的旋转（180°）**：每个旋转交换两对顶点。[置换](@entry_id:136432)结构是2个2-循环，共2个循环。固定着[色数](@entry_id:274073)是 $2^2 = 4$。总贡献为 $3 \times 4 = 12$。

根据[Burnside引理](@entry_id:146768)，不同分子的数量为：
$$N = \frac{1}{12} (16 + 32 + 12) = \frac{60}{12} = 5$$
这5种分子分别是 $CH_4$, $CH_3D$, $CH_2D_2$, $CHD_3$ 和 $CD_4$。

#### 示例二：正方体

当对称性更复杂时，分类和计算也相应变得复杂。例如，计算一个立方体传感器的不同功能构型数量，其中8个顶点每个都可处于“激活”或“非激活”两种状态之一，且等价性由空间旋转定义[@problem_id:1391998]。

这相当于用2种颜色对立方体的8个顶点进行着色。对称群是立方体的旋转群，阶为24。我们需要分析该群中所有24个旋转操作对8个顶点产生的[置换](@entry_id:136432)，并计算每种[置换](@entry_id:136432)的[循环结构](@entry_id:147026)。
- **恒等操作 (1个)**：8个1-循环。固定 $2^8 = 256$ 种着色。
- **穿过对面中心轴的旋转**：
    - 90°/270°旋转 (6个)：2个4-循环。固定 $2^2 = 4$ 种。
    - 180°旋转 (3个)：4个2-循环。固定 $2^4 = 16$ 种。
- **穿过对角顶点轴的旋转 (8个)**：2个1-循环和2个3-循环，共4个循环。固定 $2^4 = 16$ 种。
- **穿过对边中点轴的旋转 (6个)**：4个2-循环。固定 $2^4 = 16$ 种。

应用[Burnside引理](@entry_id:146768)，总数为：
$$N = \frac{1}{24} (1 \cdot 2^8 + 6 \cdot 2^2 + 3 \cdot 2^4 + 8 \cdot 2^4 + 6 \cdot 2^4) = \frac{1}{24} (256 + 24 + 48 + 128 + 96) = \frac{552}{24} = 23$$
因此，有23种功能上不同的构型。

### Pólya枚举定理：更精细的计数

[Burnside引理](@entry_id:146768)能够告诉我们总共有多少种不等价的着色方案，但它无法回答更精细的问题，比如“有多少种方案恰好使用了3个红色珠子和5个蓝色珠子？” Pólya枚举定理 (PET) 通过引入**[循环指数](@entry_id:263418)多项式**来解决这个问题。

**[循环指数](@entry_id:263418) (Cycle Index)** $P_G(x_1, x_2, \ldots)$ 是一个编码了群 $G$ 作用在集合 $S$ 上的[循环结构](@entry_id:147026)信息的多项式。其定义为：
$$P_G(x_1, x_2, \ldots, x_n) = \frac{1}{|G|} \sum_{g \in G} x_1^{c_1(g)} x_2^{c_2(g)} \cdots x_n^{c_n(g)}$$
其中 $c_k(g)$ 是[置换](@entry_id:136432) $g$ 分解后长度为 $k$ 的循环个数。

**Pólya枚举定理**：将变量 $x_k$ 替换为 $(w_1^k + w_2^k + \cdots + w_m^k)$，其中 $w_i$ 是代表第 $i$ 种颜色的权重。展开这个多项式后，项 $w_1^{n_1} w_2^{n_2} \cdots w_m^{n_m}$ 的系数，就是使用 $n_1$ 个颜色1，$n_2$ 个颜色2，... 的不等价着色方案数。

如果我们只关心总数，不区分颜色数量，只需将每个 $x_k$ 替换为颜色数 $m$。这时，[Pólya定理](@entry_id:264026)就退化为[Burnside引理](@entry_id:146768)，因为 $m^{c_1(g) + c_2(g) + \dots} = m^{\text{总循环数}}$，这正是 $|\text{Fix}(g)|$。

让我们看一个需要区分颜[色数](@entry_id:274073)量的例子。一个由8个单元组成的环形生物反应器阵列，需要用3个B单位、3个F单位和2个A单位填充。设计方案在旋转和翻转下等价，求不同布置方案数[@problem_id:1391982]。

这里的对称群是 $D_8$，作用在8个顶点上。$|D_8|=16$。
1.  **恒等操作 (1个)**：[置换](@entry_id:136432)结构为 $x_1^8$。
2.  **旋转1, 3, 5, 7步 (4个)**：[置换](@entry_id:136432)结构为 $x_8^1$。
3.  **旋转2, 6步 (2个)**：[置换](@entry_id:136432)结构为 $x_4^2$。
4.  **旋转4步 (1个)**：[置换](@entry_id:136432)结构为 $x_2^4$。
5.  **穿过对角的反射 (4个)**：[置换](@entry_id:136432)结构为 $x_1^2 x_2^3$。
6.  **穿过对边中点的反射 (4个)**：[置换](@entry_id:136432)结构为 $x_2^4$。

$D_8$ 的[循环指数](@entry_id:263418)为：
$$P_{D_8}(x_1, \ldots) = \frac{1}{16} (x_1^8 + 4x_8^1 + 2x_4^2 + 5x_2^4 + 4x_1^2 x_2^3)$$
我们用颜色权重 B, F, A 替换 $x_k$ 为 $(B^k + F^k + A^k)$。我们要求的是展开式中 $B^3F^3A^2$ 的系数。
一种有效的方法是使用[Burnside引理](@entry_id:146768)的加权形式，计算每个对称操作固定的、满足特定颜色计数的方案数。
- **恒等操作**：所有[排列](@entry_id:136432)都满足，贡献为[多项式系数](@entry_id:262287) $\frac{8!}{3!3!2!} = 560$。
- **旋转操作**：[置换](@entry_id:136432)的循环长度分别为8, 4, 2。对于一个着色方案要被固定，每个循环内的颜色必须一致。这意味着颜色计数（如3个B）必须是循环长度的倍数。由于3不能被8, 4, 或2整除，因此这些旋转操作对满足(3B, 3F, 2A)计数的方案的贡献为0。
- **穿过对角的反射 ($x_1^2x_2^3$)**：该操作固定2个顶点（1-循环），并交换3对顶点（2-循环）。要得到3B, 3F, 2A的组合，一种可行的分配是：将B和F分配给2个[固定点](@entry_id:156394)，并将(B,B), (F,F), (A,A)这三种颜色对分配给3对交换点。[固定点](@entry_id:156394)分配B和F有 $2!$ 种方式；颜色对分配给3对交换点有 $3!/(1!1!1!) = 6$ 种方式。因此，每个此类反射固定了 $2 \times 6 = 12$ 种方案。有4个此类反射，总贡献为 $4 \times 12 = 48$。
- **穿过对边中点的反射 ($x_2^4$)**：该操作交换4对顶点。要满足颜色计数，每种颜色的数量必须是2的倍数。由于B和F各有3个，这是奇数，因此没有方案能被这种反射固定。贡献为0。

根据[Burnside引理](@entry_id:146768)，总数是 $\frac{1}{16}(560+48) = \frac{608}{16} = 38$。

### 在[图论](@entry_id:140799)中的应用：对图进行计数

Pólya枚举理论的一个经典应用是计算[非同构图](@entry_id:274028)的数量。一个 $n$ 个顶点的简单图由其顶点和顶点间的边确定。两个图是**同构**的，如果可以通过重新标记一个图的顶点，使其边的集合与另一个图完全相同。

计算 $n$ 个顶点的[非同构图](@entry_id:274028)数量，可以看作一个着色问题：
- **被着色的对象**：$n$ 个顶点所有可能的配对，即 $K_n$（完全图）的[边集](@entry_id:267160)，共 $\binom{n}{2}$ 条边。
- **颜色**：2种颜色，{存在，不存在}，代表一条边是否在图中。
- **[对称群](@entry_id:146083)**：作用在 $n$ 个顶点上的[对称群](@entry_id:146083) $S_n$，它会**诱导**出一个作用在[边集](@entry_id:267160)上的[置换群](@entry_id:142907)。

例如，计算4个研究员之间不等价的合作结构数量，等价于计算4个顶点的[非同构图](@entry_id:274028)数量[@problem_id:1391988]。我们需要计算 $S_4$ 作用在 $K_4$ 的6条边上诱导的群的[循环指数](@entry_id:263418)，然后将所有 $x_k$ 替换为2。经过计算，可以得到共有11种不同的图。

一个更复杂的例子是为一个包含5个服务器的全连接[网络设计](@entry_id:267673)链路类型，每条链路可以是“高带宽”或“标准带宽”[@problem_id:1391985]。这等价于对 $K_5$ 的 $\binom{5}{2}=10$ 条边进行2-着色。对称群是作用在5个顶点上的 $S_5$，阶为120。我们需要分析 $S_5$ 中各种类型的[置换](@entry_id:136432)（如恒等、[对换](@entry_id:142115)、3-循环等）在10条边上诱导的[置换](@entry_id:136432)的[循环结构](@entry_id:147026)。
$S_5$ 作用在 $K_5$ [边集](@entry_id:267160)上的[循环指数](@entry_id:263418)为：
$$ P(x_1, \ldots) = \frac{1}{120} \left( x_1^{10} + 10x_1^4 x_2^3 + 15x_1^2 x_2^4 + 20x_1 x_3^3 + 20x_1 x_3 x_6 + 30x_2 x_4^2 + 24x_5^2 \right) $$
将 $x_k=2$ 代入，得到：
$$ N = \frac{1}{120} (2^{10} + 10 \cdot 2^7 + 15 \cdot 2^6 + 20 \cdot 2^4 + 20 \cdot 2^4 + 30 \cdot 2^3 + 24 \cdot 2^2) $$
$$ N = \frac{1}{120} (1024 + 1280 + 960 + 320 + 320 + 240 + 96) = \frac{4240}{120} \approx 35.33 $$
让我们重新检查 $S_5$ 作用在 $K_5$ [边集](@entry_id:267160)上的[循环指数](@entry_id:263418)和计算。
$S_5$ (阶120) 的[置换](@entry_id:136432)类型及其在10条边上诱导的[循环结构](@entry_id:147026)：
- (1) $e$: $x_1^{10}$ (1个)
- (2) $(a,b)$: $x_1^4 x_2^3$ (10个)
- (3) $(a,b)(c,d)$: $x_1^2 x_2^4$ (15个)
- (4) $(a,b,c)$: $x_1 x_3^3$ (20个)
- (5) $(a,b,c)(d,e)$: $x_1 x_3 x_6$ (20个)
- (6) $(a,b,c,d)$: $x_2 x_4^2$ (30个)
- (7) $(a,b,c,d,e)$: $x_5^2$ (24个)
[循环指数](@entry_id:263418)是正确的。重新计算代入 $x_k=2$ 的值：
$$ N = \frac{1}{120} (2^{10} + 10 \cdot 2^7 + 15 \cdot 2^6 + 20 \cdot 2^4 + 20 \cdot 2^4 + 30 \cdot 2^3 + 24 \cdot 2^2) $$
$$ N = \frac{1}{120} (1024 + 10 \cdot 128 + 15 \cdot 64 + 20 \cdot 16 + 20 \cdot 16 + 30 \cdot 8 + 24 \cdot 4) $$
$$ N = \frac{1}{120} (1024 + 1280 + 960 + 320 + 320 + 240 + 96) = \frac{4240}{120} $$
这里似乎有计算错误。让我们核对原始文献。对于5个顶点的[非同构图](@entry_id:274028)数量，正确的总和应该是 $120 \times 34 = 4080$。
$S_5$ 作用在边上的[不动点](@entry_id:156394)总和应为4080。
$1024 + 1280 + 960 + 320 + 240 + 96 = 3920$。 还有一项 $20x_1x_3x_6$ 诱导的[置换](@entry_id:136432)是 $x_1 x_3 x_6$ 吗？ 应该是 $x_1x_3x_6$。 $20 \times 2^{1+1+1} = 20 \times 8=160$.
所以总和是 $1024 + 1280 + 960 + 320 + 160 (\text{not } 320) + 240 + 96 = 4080$。
原稿中 $20x_1x_3$ 和 $20x_1x_3x_6$ 的项可能被混淆了。正确的[循环指数](@entry_id:263418)是 $P(x_1, \ldots) = \frac{1}{120} \left( x_1^{10} + 10x_1^4 x_2^3 + 15x_1^2 x_2^4 + 20x_1 x_3^3 + 20x_1x_3x_6 + 30x_2 x_4^2 + 24x_5^2 \right)$。
$x_1x_3^3$ 项对应 $(a,b,c)$ 型[置换](@entry_id:136432)，[不动点](@entry_id:156394)数 $2^{1+3} = 16$。 $20 \times 16 = 320$.
$x_1x_3x_6$ 项对应 $(a,b,c)(d,e)$ 型[置换](@entry_id:136432)，[不动点](@entry_id:156394)数 $2^{1+1+1} = 8$。$20 \times 8 = 160$.
$$ N = \frac{1}{120} (1024 + 1280 + 960 + 320 + 160 + 240 + 96) = \frac{4080}{120} = 34 $$
因此，共有34种结构上不同的网络配置。类似地，我们可以计算对正八面体的12条边进行3-着色的不等价方案数[@problem_id:1391974]，通过分析八面体[旋转群](@entry_id:204412)在边上作用的[循环结构](@entry_id:147026)，应用[Burnside引理](@entry_id:146768)（或[Pólya定理](@entry_id:264026)）可得结果为22815种。

### 高级主题：颜色的对称性

在某些情况下，不仅被着色的对象有对称性，颜色本身也可能被视为是可交换的。例如，一个用2个红球和3个蓝球构成的项链，与一个用2个蓝球和3个红球构成的项链，在“颜色可互换”的意义下是等价的。

处理这种情况需要一个更广义的[Burnside引理](@entry_id:146768)，此时的对称群是对象对称群 $G$ 和颜色[置换群](@entry_id:142907) $S_k$ 的[直积](@entry_id:143046) $G \times S_k$。

考虑一个立方体[分子结构](@entry_id:140109)，8个顶点可以被3种同位素之一占据。如果一个结构可以通过立方体旋转或全局的同位素类型[置换](@entry_id:136432)（例如，所有1型换成2型，2型换成3型，3型换成1型）得到另一个结构，则它们是等价的[@problem_id:1391981]。

这里的对称群是 $H = G \times S_3$，其中 $G$ 是立方体旋转群 ($|G|=24$)，$S_3$ 是3种同位素的[置换群](@entry_id:142907) ($|S_3|=6$)。群 $H$ 的阶为 $24 \times 6 = 144$。
我们需要计算 $\sum_{(g, \sigma) \in H} |\text{Fix}(g, \sigma)|$，其中 $(g, \sigma)$ 是一个组合操作，$g$ 作用于顶点，$\sigma$ 作用于颜色。一个着色方案 $c$ 被 $(g, \sigma)$ 固定，当且仅当对所有顶点 $v$，满足 $c(v) = \sigma(c(g^{-1}v))$。
这个计算相当复杂，需要分别考虑 $G$ 和 $S_3$ 中各种类型的元素组合。例如：
- 如果 $\sigma$ 是一个3-循环，而 $g$ 的[置换](@entry_id:136432)分解中包含长度不能被3整除的循环（如1-循环，2-循环，4-循环），那么 $|\text{Fix}(g, \sigma)|=0$。
- 如果 $g$ 是一个 $90^\circ$ 旋转 (两个4-循环)，$\sigma$ 是一个对换 (2-循环)，那么一个着色被固定，需要满足在每个4-循环上，颜色序列形如 $c_1, c_2, c_1, c_2$，其中 $c_1, c_2$ 是[对换](@entry_id:142115) $\sigma$ 不固定的两种颜色。这给出了对每个循环的多种选择。

通过对所有144种组合操作 $(g, \sigma)$ 的[不动点](@entry_id:156394)进行细致的分类和求和，最终应用广义[Burnside引理](@entry_id:146768)，可以得出总共有72种化学上不同的分子结构。

本章通过从基础的[Burnside引理](@entry_id:146768)到复杂的Pólya枚举定理及其推广，系统地介绍了处理对称性下计数问题的原理和机制。这些强大的工具不仅在纯数学中占有重要地位，更在化学、物理、计算机科学和工程学的众多领域中找到了深刻而实际的应用。