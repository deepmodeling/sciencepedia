{"hands_on_practices": [{"introduction": "理解马尔可夫链的第一步是学会计算在特定步数内从一个状态转移到另一个状态的概率。这个练习为这项基本技能提供了具体的实践。通过追踪一个粒子在简单图上的可能路径 [@problem_id:1378025]，我们可以直接计算多步转移概率，从而建立起对系统如何随时间演变的直观认识。", "problem": "一个粒子在标记为 A、B、C、D 和 E 的五个顶点集上进行随机游走。这些顶点之间的连接如下：顶点 A、B、C 和 D 形成一个环，其中 A 与 B 相连，B 与 C 相连，C 与 D 相连，D 再与 A 相连。此外，顶点 E 仅与顶点 A 相连。\n\n在每一步中，粒子从当前所在的顶点移动到其相邻（已连接）的一个顶点。移动到哪个相邻顶点的选择是随机的，且移动到每个相邻顶点的概率均相等。\n\n如果粒子从顶点 C 出发，那么经过恰好三步后，它位于顶点 E 的概率是多少？\n\n将你的答案表示为一个最简精确分数。", "solution": "将此运动建模为顶点集 $\\{A,B,C,D,E\\}$ 上的一个离散时间马尔可夫链，其中从一个顶点到其任何一个邻居的转移概率是均匀的。因此，对于任意相连的顶点对 $(v,u)$，一步转移概率为 $P(v \\to u)=\\frac{1}{\\deg(v)}$。各顶点的度分别为 $\\deg(A)=3$（邻居为 B、D、E），$\\deg(B)=\\deg(C)=\\deg(D)=2$，以及 $\\deg(E)=1$。\n\n从 C 出发，要在恰好三步后到达 E，第三步必须是 $A \\to E$，因为 E 仅与 A 相邻。因此，\n$$\n\\mathbb{P}(X_{3}=E \\mid X_{0}=C)=\\mathbb{P}(X_{2}=A \\mid X_{0}=C)\\cdot \\mathbb{P}(A \\to E)=\\mathbb{P}(X_{2}=A \\mid X_{0}=C)\\cdot \\frac{1}{3}.\n$$\n通过枚举从 C 到 A 的两步路径来计算 $\\mathbb{P}(X_{2}=A \\mid X_{0}=C)$。从 C 出发，第一步走到 B 或 D 的概率各为 $\\frac{1}{2}$。从 B 出发，第二步走到 A 的概率为 $\\frac{1}{2}$；从 D 出发，第二步走到 A 的概率也为 $\\frac{1}{2}$。因此，\n$$\n\\mathbb{P}(X_{2}=A \\mid X_{0}=C)=\\left(\\frac{1}{2}\\cdot \\frac{1}{2}\\right)+\\left(\\frac{1}{2}\\cdot \\frac{1}{2}\\right)=\\frac{1}{4}+\\frac{1}{4}=\\frac{1}{2}.\n$$\n因此，\n$$\n\\mathbb{P}(X_{3}=E \\mid X_{0}=C)=\\frac{1}{2}\\cdot \\frac{1}{3}=\\frac{1}{6}.\n$$", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1378025"}, {"introduction": "我们通常使用转移矩阵来预测系统的长期行为，但有时我们也会反向操作：利用观察到的长期数据来为潜在的过程建模。这个练习 [@problem_id:1378050] 挑战你根据一名员工工作习惯的长期稳态分布，来重构其完整的转移矩阵。这展示了稳态分布 $\\pi$ 与转移矩阵 $P$ 之间强大的代数关系，这是马尔可夫链分析的一块基石。", "problem": "一位数据科学家正在使用一个简单的双状态马尔可夫链来为一名远程办公员工的日常工作习惯建模。这两个状态是“专注”（状态 1）和“分心”（状态 2）。模型假设员工在任何一个小时的状态只取决于他们前一个小时的状态。\n\n在收集了大量数据后，科学家观察到，从长远来看，该员工有三分之一的时间处于“专注”状态，三分之二的时间处于“分心”状态。这对应于一个平稳分布向量 $\\pi = \\begin{pmatrix} 1/3 & 2/3 \\end{pmatrix}$。\n\n此外，数据揭示了一个特定的转移概率：如果员工当前处于“分心”状态，那么他们在下一个小时将处于“专注”状态的概率是 $1/4$。\n\n设 $P$ 为该马尔可夫链的 $2 \\times 2$ 右随机转移矩阵，其中元素 $P_{ij}$ 表示从状态 $i$ 转移到状态 $j$ 的概率。确定完整的转移矩阵 $P$。请以一个包含分数项的 $2 \\times 2$ 矩阵的形式给出你的答案。", "solution": "设状态 1 为专注，状态 2 为分心。对于一个右随机转移矩阵 $P$，每一行的和为 $1$，且 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。给定的平稳分布 $\\pi = \\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}$ 满足行向量的平稳性条件：\n$$\n\\pi P = \\pi.\n$$\n\n根据题意，我们有 $P_{21} = \\frac{1}{4}$。根据行随机性，$P_{22} = 1 - P_{21} = \\frac{3}{4}$。设 $P_{11} = x$，则 $P_{12} = 1 - x$。因此\n$$\nP = \\begin{pmatrix}\nx & 1 - x \\\\\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}.\n$$\n\n应用平稳性条件：\n$$\n\\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}\n\\begin{pmatrix}\nx & 1 - x \\\\\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}.\n$$\n令第一个分量相等，可得\n$$\n\\frac{1}{3} x + \\frac{2}{3} \\cdot \\frac{1}{4} = \\frac{1}{3}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{1}{3} x + \\frac{1}{6} = \\frac{1}{3}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{1}{3} x = \\frac{1}{6}\n\\;\\;\\Longrightarrow\\;\\;\nx = \\frac{1}{2}.\n$$\n因此 $P_{11} = \\frac{1}{2}$ 且 $P_{12} = \\frac{1}{2}$，得到\n$$\nP = \\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{2} \\\\\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}.\n$$\n直接验算表明 $\\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix} P = \\begin{pmatrix} \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}$，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{4} & \\frac{3}{4} \\end{pmatrix}}$$", "id": "1378050"}, {"introduction": "我们能否预测一个复杂过程（例如洗牌）的长期结果，而无需详尽地追踪每一种可能性？这个问题 [@problem_id:1378035] 通过将一种特定的洗牌方法建模为马尔可夫链来探讨此问题。通过分析洗牌规则中固有的对称性，你将发现转移矩阵的一个深刻性质，它能让你以一种优雅而富有洞察力的方式确定其稳态分布。", "problem": "一副由三张标有唯一数字1、2、3的牌组成的小牌组，按照一个特定的、重复的程序进行洗牌。牌组的一个状态由牌从上到下的排列顺序定义。例如，状态 (1, 2, 3) 表示牌1在最上面，牌2在中间，牌3在最下面。因此，状态空间由这三张牌所有可能的 $3! = 6$ 种排列组成。\n\n每一步的洗牌程序如下：取出当前在牌组顶部的牌，并将其重新插入到三个可能的位置（顶部、中间或底部）之一，每个位置被选中的概率相等，均为 $1/3$。\n\n这个洗牌过程可以被建模为排列空间上的一个离散时间马尔可夫链。当洗牌过程重复很长时间后，牌组处于任何给定状态的概率将趋于一个平稳分布。\n\n确定牌组处于特定状态 (3, 2, 1) 的长期概率。请用分数表示你的答案。", "solution": "令状态空间为 $\\{1,2,3\\}$ 的六种排列。从一个通用状态 $(a,b,c)$ 开始，洗牌操作“取出顶部的牌并将其均匀地重新插入到三个位置之一”会产生恰好三种可能的下一状态，每种状态的概率为 $\\frac{1}{3}$：\n$$\n(a,b,c)\\xrightarrow[\\text{prob}=\\frac{1}{3}]{}(a,b,c),\\quad\n(a,b,c)\\xrightarrow[\\text{prob}=\\frac{1}{3}]{}(b,a,c),\\quad\n(a,b,c)\\xrightarrow[\\text{prob}=\\frac{1}{3}]{}(b,c,a).\n$$\n因此，转移矩阵 $P$ 定义为\n$$\nP\\big((a,b,c)\\to(a,b,c)\\big)=\\frac{1}{3},\\quad\nP\\big((a,b,c)\\to(b,a,c)\\big)=\\frac{1}{3},\\quad\nP\\big((a,b,c)\\to(b,c,a)\\big)=\\frac{1}{3},\n$$\n其他情况为零。\n\n固定任意一个状态 $s=(x,y,z)$。唯一满足 $P(t\\to s)>0$ 的前驱状态 $t$ 是\n$$\nt_{1}=(x,y,z),\\quad t_{2}=(y,x,z),\\quad t_{3}=(z,x,y),\n$$\n因为：\n- 从 $t_{1}=(x,y,z)$ 开始，将 $x$ 重新插入顶部（位置1），状态保持为 $(x,y,z)$。\n- 从 $t_{2}=(y,x,z)$ 开始，将 $y$ 重新插入中间（位置2），得到状态 $(x,y,z)$。\n- 从 $t_{3}=(z,x,y)$ 开始，将 $z$ 重新插入底部（位置3），得到状态 $(x,y,z)$。\n\n这些转移中的每一个都有概率 $\\frac{1}{3}$，因此对于状态 $s$ 的列和为\n$$\n\\sum_{t}P(t\\to s)=\\frac{1}{3}+\\frac{1}{3}+\\frac{1}{3}=1.\n$$\n由于这对每个状态 $s$ 都成立，所以转移矩阵 $P$ 是双随机矩阵。\n\n考虑六个状态上的均匀分布 $\\pi$，即对所有 $s$ 有 $\\pi(s)=\\frac{1}{6}$。那么对于任何状态 $s$，\n$$\n\\sum_{t}\\pi(t)P(t\\to s)=\\frac{1}{6}\\sum_{t}P(t\\to s)=\\frac{1}{6}\\cdot 1=\\frac{1}{6}=\\pi(s),\n$$\n所以 $\\pi$ 是平稳分布。该链是不可约的（从任何一个排列，通过一系列允许的插入操作可以达到任何其他排列）并且是非周期的（每个状态都有一个概率为 $\\frac{1}{3}$ 的自循环）。因此，根据标准的马尔可夫链理论，平稳分布是唯一的，并且该链从任何初始状态都会收敛到此分布。\n\n因此，长期来看，每个状态的概率都是 $\\frac{1}{6}$。特别是，状态 $(3,2,1)$ 的概率是 $\\frac{1}{6}$。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1378035"}]}