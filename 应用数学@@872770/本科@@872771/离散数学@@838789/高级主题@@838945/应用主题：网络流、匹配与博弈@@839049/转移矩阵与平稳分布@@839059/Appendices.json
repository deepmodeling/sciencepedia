{"hands_on_practices": [{"introduction": "理解马尔可夫链的第一步是计算系统在有限步数后的状态。这个练习将带你通过一个具体的机器人移动场景，实践如何运用转移概率来预测其在几个时间步之后的位置分布。这是掌握马尔可夫链动态演化过程的基础，让你能够追踪系统在短期内的行为变化 [@problem_id:1411969]。", "problem": "一个简单的清洁机器人在一个由四个房间组成的办公套件中工作：房间1、房间2、房间3和房间4。这些房间按循环排列，房间1与房间2和房间4相连，房间2与房间1和房间3相连，依此类推。\n\n机器人的移动是概率性的，并在离散的时间步长上确定。在每一步中，机器人从其当前所在的房间有三种选择：\n1.  以$\\frac{1}{2}$的概率移动到顺时针方向的下一个房间（1 - 2 - 3 - 4 - 1）。\n2.  以$\\frac{1}{4}$的概率移动到逆时针方向的下一个房间（1 - 4 - 3 - 2 - 1）。\n3.  以$\\frac{1}{4}$的概率停留在当前房间。\n\n如果机器人在时间步$t=0$时从房间1开始，那么在恰好三个时间步后（在$t=3$时），机器人分别在房间1、房间2、房间3和房间4的概率是多少？\n\n请按顺序将你的答案表示为一组四个分数，分别代表房间1、房间2、房间3和房间4的概率。", "solution": "将每一步建模为循环上的一个增量$X$，其值为$+1$（顺时针）的概率为$\\frac{1}{2}$，为$-1$（逆时针）的概率为$\\frac{1}{4}$，为$0$（停留）的概率为$\\frac{1}{4}$。设$X_{1},X_{2},X_{3}$是$X$的独立同分布副本，并将三步后的净位移定义为$S=X_{1}+X_{2}+X_{3}$。从房间$1$开始，最终房间的索引$R$满足$R \\equiv 1+S \\pmod{4}$，代表元在$\\{1,2,3,4\\}$中；因此$S \\equiv 0,1,2,3 \\pmod{4}$分别对应房间$1,2,3,4$。\n\n将步数类型写为$(a,b,c)$，其中$a$是$+1$步的数量，$b$是$-1$步的数量，$c$是$0$步的数量，且$a+b+c=3$。给定组合的概率为\n$$\n\\mathbb{P}(a,b,c)=\\frac{3!}{a!\\,b!\\,c!}\\left(\\frac{1}{2}\\right)^{a}\\left(\\frac{1}{4}\\right)^{b}\\left(\\frac{1}{4}\\right)^{c},\n$$\n净位移为$S=a-b$。枚举所有组合可得：\n- $(3,0,0)$: $S=3$，概率为 $\\frac{1}{8}$。\n- $(0,3,0)$: $S=-3$，概率为 $\\frac{1}{64}$。\n- $(0,0,3)$: $S=0$，概率为 $\\frac{1}{64}$。\n- $(2,1,0)$: $S=1$，概率为 $\\frac{3}{16}$。\n- $(2,0,1)$: $S=2$，概率为 $\\frac{3}{16}$。\n- $(1,2,0)$: $S=-1$，概率为 $\\frac{3}{32}$。\n- $(1,0,2)$: $S=1$，概率为 $\\frac{3}{32}$。\n- $(0,2,1)$: $S=-2$，概率为 $\\frac{3}{64}$。\n- $(0,1,2)$: $S=-1$，概率为 $\\frac{3}{64}$。\n- $(1,1,1)$: $S=0$，概率为 $\\frac{3}{16}$。\n\n按$S \\pmod 4$分组以获得房间概率：\n- 房间$1$ ($S \\equiv 0$): $\\mathbb{P}(S=0)=\\frac{1}{64}+\\frac{3}{16}=\\frac{13}{64}$。\n- 房间$2$ ($S \\equiv 1$): $\\mathbb{P}(S=1)+\\mathbb{P}(S=-3)=\\left(\\frac{3}{16}+\\frac{3}{32}\\right)+\\frac{1}{64}=\\frac{19}{64}$。\n- 房间$3$ ($S \\equiv 2$): $\\mathbb{P}(S=2)+\\mathbb{P}(S=-2)=\\frac{3}{16}+\\frac{3}{64}=\\frac{15}{64}$。\n- 房间$4$ ($S \\equiv 3$): $\\mathbb{P}(S=3)+\\mathbb{P}(S=-1)=\\frac{1}{8}+\\left(\\frac{3}{32}+\\frac{3}{64}\\right)=\\frac{17}{64}$。\n\n这些概率之和为$1$，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{13}{64}  \\frac{19}{64}  \\frac{15}{64}  \\frac{17}{64}\\end{pmatrix}}$$", "id": "1411969"}, {"introduction": "当系统运行足够长的时间后，它常常会达到一个稳定的平衡状态，即平稳分布。这个练习探讨了一个高度对称的系统，在这种系统中，直觉告诉我们长期来看所有状态应该是等可能的。通过计算，你将验证这一直觉，并理解对称性如何简化对系统长期行为的分析 [@problem_id:1411954]。", "problem": "考虑一个有四个不同状态的系统，分别标记为 1、2、3 和 4。该系统在离散时间步长下根据特定的概率规则在这些状态之间转换，形成一个马尔可夫链。在每个时间步长，如果系统处于任何给定的状态，它将以相等的概率转移到其他三个状态之一。系统永远不会在连续的时间步长内停留在同一个状态。\n\n这个过程有一个唯一的平稳分布，用向量 $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$ 表示，其中 $\\pi_i$ 代表系统处于状态 $i$ 的长期概率。\n\n确定分量 $\\pi_3$ 的值。请用分数表示你的答案。", "solution": "设状态空间为 $\\{1,2,3,4\\}$。转移概率为 $p_{ii}=0$ 对所有 $i$ 成立，且 $p_{ij}=\\frac{1}{3}$ 对所有 $i \\neq j$ 成立。一个平稳分布 $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3},\\pi_{4})$ 满足 $\\pi=\\pi P$ 且 $\\sum_{i=1}^{4}\\pi_{i}=1$，$\\pi_{i} \\ge 0$。\n\n对于任意固定的状态 $j \\in \\{1,2,3,4\\}$，根据平稳性条件可得\n$$\n\\pi_{j}=\\sum_{i=1}^{4}\\pi_{i}p_{ij}=\\sum_{i \\neq j}\\pi_{i}\\cdot \\frac{1}{3}+\\pi_{j}\\cdot 0=\\frac{1}{3}\\sum_{i \\neq j}\\pi_{i}.\n$$\n使用归一化条件 $\\sum_{i \\neq j}\\pi_{i}=1-\\pi_{j}$，上式变为\n$$\n\\pi_{j}=\\frac{1}{3}\\left(1-\\pi_{j}\\right).\n$$\n解 $\\pi_{j}$ 得，\n$$\n\\pi_{j}=\\frac{1}{3}-\\frac{1}{3}\\pi_{j}\n\\quad \\Rightarrow \\quad\n\\pi_{j}+\\frac{1}{3}\\pi_{j}=\\frac{1}{3}\n\\quad \\Rightarrow \\quad\n\\pi_{j}\\cdot \\frac{4}{3}=\\frac{1}{3}\n\\quad \\Rightarrow \\quad\n\\pi_{j}=\\frac{\\frac{1}{3}}{\\frac{4}{3}}=\\frac{1}{4}.\n$$\n这对每个 $j$ 都成立，因此平稳分布是均匀的。特别地，\n$$\n\\pi_{3}=\\frac{1}{4}.\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1411954"}, {"introduction": "现实世界中的许多系统并不完全对称，那么它们的长期行为是怎样的呢？本练习引入了一个更普遍的工具——细致平衡条件（detailed balance condition）——来分析非均匀随机游走的平稳分布。你将发现，即使在不对称的情况下，平稳概率也与网络的底层结构（在此例中为节点的度）有着深刻的联系 [@problem_id:1412008]。", "problem": "一个量子点系统被建模为一个在四个不同位置（标记为0、1、2和3）之间移动的粒子。该粒子只能在特定的位置对之间跃迁。允许的跃迁是双向的，具体如下：位置0与位置1、2和3相连；位置1与位置0和2相连；位置2与位置0、1和3相连；位置3与位置0和2相连。\n\n粒子的运动是一个离散时间随机过程。在每个时间步，如果粒子位于位置 $i$，它会跳到其一个相连的邻近位置。对邻近位置的选择在所有可能性中是随机且均匀的。因此，从位置 $i$ 跃迁到特定相连邻近位置 $j$ 的概率是 $P_{ij} = 1/d_i$，其中 $d_i$ 是位置 $i$ 的度（即与其相连的其他位置的数量）。粒子不能在连续的时间步内停留在同一位置。\n\n假设系统运行足够长的时间以达到稳态，那么在位置0找到粒子的概率与在位置1找到粒子的概率之比是多少？请用一个单独的闭式解析表达式来表示你的答案。", "solution": "设这些位置为一个无向图的顶点，其边对应于允许的双向跃迁。各位置的度为\n$$\nd_{0}=3,\\quad d_{1}=2,\\quad d_{2}=3,\\quad d_{3}=2,\n$$\n因为位置0与1、2、3相连；位置1与0、2相连；位置2与0、1、3相连；位置3与0、2相连。\n\n跃迁概率定义为\n$$\nP_{ij}=\\begin{cases}\n\\frac{1}{d_{i}},  \\text{如果 } i \\text{ 和 } j \\text{ 相连},\\\\\n0,  \\text{否则}.\n\\end{cases}\n$$\n\n在稳态下，平稳分布 $\\pi=(\\pi_{0},\\pi_{1},\\pi_{2},\\pi_{3})$ 满足无向图的细致平衡（可逆性）关系：\n$$\n\\pi_{i}P_{ij}=\\pi_{j}P_{ji}\\quad \\text{对于每个相连的对 }(i,j).\n$$\n一个充分解是 $\\pi_{i}\\propto d_{i}$。为了验证，设 $\\pi_{i}=c\\,d_{i}$，其中 $c0$ 为某个归一化常数。对于任何相连的 $(i,j)$，\n$$\n\\pi_{i}P_{ij}=c\\,d_{i}\\cdot \\frac{1}{d_{i}}=c,\\qquad \\pi_{j}P_{ji}=c\\,d_{j}\\cdot \\frac{1}{d_{j}}=c,\n$$\n所以细致平衡成立，因此 $\\pi$ 是平稳的。因为只要求一个比率，所以归一化是不必要的。因此，\n$$\n\\frac{\\pi_{0}}{\\pi_{1}}=\\frac{d_{0}}{d_{1}}=\\frac{3}{2}.\n$$\n\n等价地，对单一边 $(0,1)$ 使用细致平衡，\n$$\n\\pi_{0}\\,P_{01}=\\pi_{1}\\,P_{10}\\quad \\Longrightarrow\\quad \\pi_{0}\\cdot \\frac{1}{3}=\\pi_{1}\\cdot \\frac{1}{2}\\quad \\Longrightarrow\\quad \\frac{\\pi_{0}}{\\pi_{1}}=\\frac{3}{2},\n$$\n这得到了相同的结果。", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1412008"}]}