## 引言
图论作为[离散数学](@entry_id:149963)的基石，为分析和解决从社交网络到[分子结构](@entry_id:140109)等各类复杂系统问题提供了强大的形式化语言。然而，现实世界中的连接关系千差万别：好友关系是唯一的，而城市间的航线可以是多样的，系统状态甚至可能循环回自身。这种复杂性引出了一项根本挑战：如何选择最恰当的数学模型来精确捕捉特定系统的本质？若不区分图的不同类型，我们的分析将可能变得模糊甚至错误。

本文旨在系统性地解决这一问题，为读者构建一个关于图论基础模型的清晰认知框架。我们将从第一章“原则与机制”开始，严格定义并辨析[简单图](@entry_id:274882)、[多重图](@entry_id:261576)与[伪图](@entry_id:273987)这三种核心图类型，并探讨如顶点度、握手定理等基本性质。接着，在第二章“应用与跨学科联系”中，我们将通过丰富的实例，展示这些模型如何在计算机科学、工程学和自然科学等领域中发挥关键作用，阐明理论与实践的联系。最后，通过第三章“动手实践”中的精选问题，您将有机会应用所学知识，巩固对这些基本概念的理解和运用能力。通过本次学习，您将能够根据问题情境，自信地选择并运用最合适的图模型进行分析。

## 原则与机制

在深入探讨图论的丰富应用之前，我们必须首先精确地定义研究对象，并理解其内在的基本原则。本章旨在系统地阐述构成图论基础的几种核心图模型：[简单图](@entry_id:274882)、[多重图](@entry_id:261576)和[伪图](@entry_id:273987)。我们将通过严格的定义、关键性质的辨析以及它们在数学和计算问题中的具体表现，来建立一个清晰而稳固的理论框架。

### 图的基本分类：从简单到复杂

在最抽象的层面，一个图 $G$ 由一个顶点集合 $V$ 和一个[边集](@entry_id:267160)合 $E$ 构成，记作 $G=(V, E)$。顶点（vertices）通常被视为点或节点，而边（edges）则表示顶点之间的连接。然而，根据对“连接”所施加的不同规则，图可以被细分为几种不同的类型。这些分类对于精确建模现实世界系统至关重要，因为不同的系统具有不同的连接特性。

#### 简单图 (Simple Graph)

**简单图**是限制最严格、也是最常被研究的图类型。其定义遵循两条核心规则：
1.  **无[多重边](@entry_id:273920)（no multiple edges）**：任意两个不同的顶点之间，最多只能有一条边相连。
2.  **无自环（no loops）**：任何顶点都不能有边与自身相连。

因此，在[简单图](@entry_id:274882)中，[边集](@entry_id:267160) $E$ 是由无序的、两两不同的顶点对组成的集合。例如，在一个代表朋友关系的社交网络中，两个人之间要么是朋友（一条边），要么不是，且一个人不能成为自己的朋友。这种关系天然地构成了一个[简单图](@entry_id:274882)。

#### [多重图](@entry_id:261576) (Multigraph)

**[多重图](@entry_id:261576)**放宽了简单图的一项限制。它允许任意两个不同的顶点之间存在多于一条的边，这些边被称为**[多重边](@entry_id:273920)（multiple edges）**或**平行边（parallel edges）**。然而，[多重图](@entry_id:261576)仍然**禁止[自环](@entry_id:274670)**。

一个典型的例子是交通网络，其中两个城市之间可能存在多条不同的公路或航线。[@problem_id:1400577] 假设一个网络分析师正在记录一个由五个服务器 $(V_1, V_2, V_3, V_4, V_5)$ 组成的网络。如果服务器 $V_1$ 的邻接列表（记录与其直接相连的服务器）为 $[V_2, V_3, V_2]$，这表明 $V_1$ 和 $V_2$ 之间存在两条独立的物理连接。同时，该网络确认没有任何服务器与自身存在连接。这种允许多重连接但禁止自[环的结构](@entry_id:150907)，正是[多重图](@entry_id:261576)的定义。因此，描述该网络最精确的分类就是[多重图](@entry_id:261576)。

#### [伪图](@entry_id:273987) (Pseudograph)

**[伪图](@entry_id:273987)**是这三种图类型中限制最少的。它既允许**[多重边](@entry_id:273920)**，也允许**[自环](@entry_id:274670)（loops）**——即连接顶点到其自身的边。这使得[伪图](@entry_id:273987)成为最通用的图模型。

例如，在[状态机](@entry_id:171352)或有限自动机中，一个状态（顶点）可能通过某个输入转换回自身，这就形成了一个[自环](@entry_id:274670)。同样，在电[路图](@entry_id:274599)中，两个组件之间可能通过多种不同的方式连接。

### 层次关系与关键特征

这三种图类型之间存在一个清晰的层次或包含关系。任何满足简单图条件的图，自然也满足[多重图](@entry_id:261576)的条件（因为它没有[多重边](@entry_id:273920)，而[多重图](@entry_id:261576)允许没有[多重边](@entry_id:273920)的情况），同理，任何[多重图](@entry_id:261576)也满足[伪图](@entry_id:273987)的条件（因为它没有自环，而[伪图](@entry_id:273987)允许没有[自环](@entry_id:274670)的情况）。

我们可以将这种关系形式化为集合的包含关系。令 $\mathcal{S}$、$\mathcal{M}$ 和 $\mathcal{P}$ 分别代表所有简单图、[多重图](@entry_id:261576)和[伪图](@entry_id:273987)的集合。那么，我们有：
$$
\mathcal{S} \subset \mathcal{M} \subset \mathcal{P}
$$
这个问题可以通过一个思维实验来进一步阐明 [@problem_id:1400562]。想象三个网络标准 S（简单）、M（多重）和 P（[伪图](@entry_id:273987)）。如果一个网络符合标准 X，它是否也符合标准 Y？这可以构建一个[有向图](@entry_id:272310)，其中顶点是 $\{S, M, P\}$，当且仅当所有符合 X 的网络都符合 Y 时，存在一条从 X 到 Y 的有向边。
- 任何 S 网络都是 M 网络（$S \to M$）。
- 任何 M 网络都是 P 网络（$M \to P$）。
- 根据[传递性](@entry_id:141148)，任何 S 网络也都是 P 网络（$S \to P$）。
- 反向则不成立，因为存在带有[多重边](@entry_id:273920)的 M 网络不符合 S，也存在带有[自环](@entry_id:274670)的 P 网络不符合 M。
- 每个标准都符合其自身（$S \to S, M \to M, P \to P$）。
由此产生的[邻接矩阵](@entry_id:151010)（行/列顺序为 S, M, P）清晰地展示了这种单向的层次结构：
$$
\begin{pmatrix} 1 & 1 & 1 \\ 0 & 1 & 1 \\ 0 & 0 & 1 \end{pmatrix}
$$

从这个层次结构中，我们可以提炼出区分这些图类型的关键特征：
- 从[多重图](@entry_id:261576)到[伪图](@entry_id:273987)的跃迁，其本质区别在于是否允许**[自环](@entry_id:274670)**。一个非[多重图](@entry_id:261576)的[伪图](@entry_id:273987)必须包含至少一个[自环](@entry_id:274670)。要构造这样一个最小的图，我们只需要最少的顶点来支撑一个[自环](@entry_id:274670)，即一个顶点。然后，我们添加最少的能使其成为[伪图](@entry_id:273987)而非[多重图](@entry_id:261576)的边，即一条自环。因此，一个仅包含单个顶点 $v_1$ 和一条边 $\{v_1, v_1\}$ 的图，是最小的、非[多重图](@entry_id:261576)的[伪图](@entry_id:273987) [@problem_id:1400588]。

- 从简单图到[多重图](@entry_id:261576)的跃迁，其本质区别在于是否允许**[多重边](@entry_id:273920)**。一个非[简单图](@entry_id:274882)的[多重图](@entry_id:261576)必须包含至少一组[多重边](@entry_id:273920)。正如在服务器网络的例子中 [@problem_id:1400577]，顶点 $V_1$ 和 $V_2$ 之间的两条边使其成为一个[多重图](@entry_id:261576)，但不是一个[简单图](@entry_id:274882)。

### [顶点的度](@entry_id:264944)：一个核心度量

顶点的**度 (degree)** 是图论中最基本且最重要的概念之一，它量化了一个顶点的“连接性”。一个顶点 $v$ 的度，记作 $\deg(v)$，定义为与 $v$ 关联的边的端点数。

这个定义在处理不同类型的图时需要特别注意自环的行为。
- 对于一条连接两个不同顶点 $u$ 和 $v$ 的常规边，它为 $\deg(u)$ 和 $\deg(v)$ 各贡献 1。
- 对于一个在顶点 $v$ 上的**[自环](@entry_id:274670)**，它的两个端点都连接在 $v$ 上。因此，根据标准约定，**一个[自环](@entry_id:274670)为其所在顶点的度贡献 2**。

这个“[自环](@entry_id:274670)度为2”的约定至关重要，因为它确保了度的概念在所有图类型中保持一致的代数性质。

度的概念使得我们能够精确描述顶点的局部结构。例如，考虑一个工程问题：一个中心服务器 $v$ 必须具有恰好为 4 的度，但由于物理限制，它只能与另外两个不同的客户端节点 $u$ 和 $w$ 相邻（即存在边）[@problem_id:1495452]。
- 在**[简单图](@entry_id:274882)**中，一个顶点的度等于其邻居的数量。因为 $v$ 只有 $u$ 和 $w$ 两个邻居，所以其度必然为 2，无法满足度为 4 的要求。
- 在**[多重图](@entry_id:261576)**中，这是可能的。例如，我们可以在 $v$ 和 $u$ 之间建立 2 条边，在 $v$ 和 $w$ 之间也建立 2 条边。这样 $\deg(v) = 2 + 2 = 4$，且邻居集合恰好是 $\{u, w\}$。
- 在**[伪图](@entry_id:273987)**中，可能性更多。例如，我们可以在 $v$ 和 $u$ 之间建立 1 条边，在 $v$ 和 $w$ 之间也建立 1 条边，并在 $v$ 上增加一个自环。根据标准定义，$\deg(v) = 1 (\text{到 } u) + 1 (\text{到 } w) + 2 (\text{自环}) = 4$。

这个例子清楚地表明，[多重图](@entry_id:261576)和[伪图](@entry_id:273987)提供的额外灵活性（[多重边](@entry_id:273920)和自环）允许我们构建在简单图中无法实现的度结构。

### 握手定理及其推论

**握手定理 (Handshaking Lemma)** 是图论的基石之一。它指出，在任何有限图中，所有顶点的度之和等于图中边数的两倍。令 $|E|$ 为边的总数，该定理可表示为：
$$
\sum_{v \in V} \deg(v) = 2|E|
$$
这个定理的逻辑非常直观：图中的每一条边都有两个端点。在计算所有[顶点的度](@entry_id:264944)之和时，每一条边都恰好被计算了两次（在其每个端点处各一次）。这个逻辑对于所有类型的图都成立，前提是我们坚持“一个[自环](@entry_id:274670)为其顶点度贡献2”的约定，因为一个自环也恰好贡献了 2 到度数之和中。

握手定理有一个极其重要的推论，它关系到图中顶点度的奇偶性。因为所有顶点度之和 $\sum_{v \in V} \deg(v)$ 是一个偶数 ($2|E|$），所以这个和式中，值为奇数的项（即度为奇数的顶点）必须有偶数个。换言之：

**在任何有限的[简单图](@entry_id:274882)、[多重图](@entry_id:261576)或[伪图](@entry_id:273987)中，度为奇数的顶点的数量必须是偶数。**

这个推论是一个强大的[不变量](@entry_id:148850)，可以用来快速判断某个[度序列](@entry_id:267850)是否可能构成一个图。例如，一个图的[度序列](@entry_id:267850)不可能是 $\{1, 2, 3, 3\}$ [@problem_id:1522863]，因为其度之和为 $1+2+3+3=9$，是一个奇数，这直接违反了握手定理。同时，这也说明了为什么度为奇数的顶点有 3 个（奇数个），这是不可能的。相反，[度序列](@entry_id:267850) $\{3, 3, 3, 3\}$ 是可能的（例如，一个4个顶点的[完全图](@entry_id:266483) $K_4$），因为其度之和为 12，是偶数，且有 4 个（偶数个）奇度顶点。

握手定理也是一个实用的计算工具。考虑一个由8个处理单元组成的网络，建模为一个[伪图](@entry_id:273987)，其中每个[顶点的度](@entry_id:264944)都是 4（即 4-[正则图](@entry_id:265877)）。如果已知系统中总共有 2 个自环，我们可以计算出连接不同单元的标准边的数量 [@problem_id:1400607]。
- 总度数之和为 $\sum_{v \in V} \deg(v) = 8 \times 4 = 32$。
- 令 $m$ 为标准边的数量，$l$ 为[自环](@entry_id:274670)的数量。我们已知 $l=2$。
- 根据握手定理的扩展形式，总度数之和也等于 $2m + 2l$（因为每条标准边贡献2，每个[自环](@entry_id:274670)也贡献2）。
- 因此，$32 = 2m + 2(2) \implies 32 = 2m + 4 \implies 2m = 28 \implies m=14$。
- 这意味着网络中有 14 条标准边。

**关于度定义的特别说明**：虽然“自环度为2”是标准，但在某些特定应用中可能会遇到不同的定义。例如，在一个问题中，一个自环可能被定义为对其[顶点的度](@entry_id:264944)只贡献 1 [@problem_id:1400587]。在这种非标准定义下，握手定理的公式会相应改变为 $\sum_{v \in V} \deg(v) = 2M + N_L$，其中 $M$ 是非自环边的数量，$N_L$ 是自环的数量。在这种特定规则下，可以推导出一些有趣的结论，例如对于一个 $n, k$ 均为奇数的 $k$-[正则图](@entry_id:265877)，其自环数量 $N_L$ 必须是奇数。这提醒我们，在处理[图论](@entry_id:140799)问题时，务必首先确认所有术语（尤其是“度”）的精确定义。

### 图的构造约束与容量

不同类型的图，其结构上的可能性和限制也不同。

对于有 $n$ 个顶点的**[简单图](@entry_id:274882)**，其连接最为稀疏。
- **[最大度](@entry_id:265573)**：任何一个顶点的度最大为 $n-1$，因为在一个没有自环和重边的图中，一个顶点最多只能与所有其他 $n-1$ 个顶点相连 [@problem_id:1400595]。
- **度的组合**：某些度的组合是不可能共存的。例如，在一个简单图中，不可能同时存在一个度为 $n-1$ 的顶点 $u$ 和一个度为 $0$ 的顶点 $w$。因为如果 $\deg(u)=n-1$，则 $u$ 与所有其他顶点相连，包括 $w$，这意味着 $w$ 至少有一条边与 $u$ 相连，所以 $\deg(w) \ge 1$，与 $\deg(w)=0$ 矛盾 [@problem_id:1400595]。

随着我们从[简单图](@entry_id:274882)放宽到[多重图](@entry_id:261576)和[伪图](@entry_id:273987)，图所能容纳的“边容量”也随之增加。我们可以精确地量化在给定约束下，一个有 $n$ 个顶点的图最多可以有多少条边 [@problem_id:1400564]。
- **[简单图](@entry_id:274882) $G_S$**：最大边数等于从 $n$ 个顶点中选取两个顶点的组[合数](@entry_id:263553)，即 $E_S = \binom{n}{2}$。
- **有界[多重图](@entry_id:261576) $G_M$**：如果规定任意两个不同顶点间的[重数](@entry_id:136466)（边的数量）最多为 $k$，那么最大边数为 $E_M = k \cdot \binom{n}{2}$。
- **有界[伪图](@entry_id:273987) $G_P$**：如果在[多重图](@entry_id:261576)的基础上，还允许每个顶点最多有 $m$ 个自环，那么最大边数为 $E_P = k \cdot \binom{n}{2} + m \cdot n$。

这些公式清晰地展示了结构自由度的增加如何直接转化为边承载能力的提升。从简单图到[多重图](@entry_id:261576)，容量的增加来源于[多重边](@entry_id:273920)；从[多重图](@entry_id:261576)到[伪图](@entry_id:273987)，容量的进一步增加来源于自环。

### 图的表示：从理论到实践

为了在计算机上处理图，我们需要有效的[数据结构](@entry_id:262134)来表示它们。**[邻接表](@entry_id:266874)**是一种常用且高效的表示方法，其中我们为每个顶点 $v$ 维护一个列表，记录所有与 $v$ 相关的连接信息。

然而，当从[简单图](@entry_id:274882)推广到[多重图](@entry_id:261576)和[伪图](@entry_id:273987)时，一个关键的挑战出现了：如何**唯一地表示**每一条边？如果两个顶点 $u$ 和 $v$ 之间有多条边，或者一个顶点 $v$ 上有多个[自环](@entry_id:274670)，我们必须有办法区分它们，以便执行诸如“删除其中特定的某一条边”之类的操作 [@problem_id:1400561]。

- 一个只记录邻居顶点索引的列表（例如，`adj[u] = [v, v, w]`）是**不充分**的。因为列表中的两个 `v` 是无法区分的。
- 一个记录邻居顶点及其连接计数的列表（例如，`adj[u] = [(v, 2), (w, 1)]`）也是**不充分**的。因为它丢失了单个边的身份，我们无法指代 $u$ 和 $v$ 之间的“第一条”或“第二条”边。

正确的解决方案是为图中的每一条边分配一个**唯一的边标识符 (edge_id)**。因此，对于一个顶点 $v$，其[邻接表](@entry_id:266874) `adj[v]` 中的每一个条目都应该是一个包含邻居顶点和该特定边标识符的元组。例如，一个条目可以是 `(w, edge_id)`。

这种表示方法确保了即使在存在[多重边](@entry_id:273920)和多重[自环](@entry_id:274670)的情况下，每条边也能被唯一地识别和操作。此外，它与度的计算有着直接的联系。如果我们遵循惯例，在 `adj[v]` 中为每个[自环](@entry_id:274670)包含两个条目（或者一个带标记的条目），那么 `adj[v]` 的长度 $d'_v$ 就精确等于顶点 $v$ 的度 $\deg(v)$。因此，使用这种[数据结构](@entry_id:262134)计算一个顶点的度，其[时间复杂度](@entry_id:145062)为 $O(d'_v)$，即与该顶点的度成正比。这完美地将抽象的[图论](@entry_id:140799)概念与具体的算法实现联系在了一起。