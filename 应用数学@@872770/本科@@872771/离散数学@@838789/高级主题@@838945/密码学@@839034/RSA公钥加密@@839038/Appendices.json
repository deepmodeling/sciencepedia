{"hands_on_practices": [{"introduction": "RSA的安全性基石在于大数分解的困难性。本练习将通过一个`n`值小到可以被轻易分解的例子，让你亲手实践如何从公开的密钥 `(n, e)` 推导出对应的私钥 `d`。这个过程不仅能揭示攻击者破解RSA的思路，更能让你深刻理解RSA系统中各个参数之间环环相扣的数学关系。 [@problem_id:1397836]", "problem": "在 RSA (Rivest–Shamir–Adleman) 公钥密码系统中，公钥由一对整数 `(n, e)` 组成，而对应的私钥是一个整数 `d`。整数 `n` 是两个不同素数 `p` 和 `q` 的乘积，即 `n = pq`。整数 `e` 是公钥指数，`d` 是私钥指数。它们通过同余关系式 `ed ≡ 1 (mod φ(n))` 相关联，其中 `φ(n)` 是欧拉总计函数，对于 `n=pq`，其值为 `φ(n) = (p-1)(q-1)`。\n\n一个攻击者伊芙 (Eve) 截获了用户的公钥，该公钥为 `(n, e) = (91, 5)`。为了破解该系统，伊芙必须确定对应的私钥 `d`。\n\n假设你是伊芙，请计算私钥 `d` 的值。", "solution": "我们要求解私钥指数 $d$，使其满足 RSA 关系式 $ed \\equiv 1 \\pmod{\\varphi(n)}$，其中给定的公钥为 $(n,e)=(91,5)$。对于 $n=pq$ 且 $p$ 和 $q$ 是不同的素数，欧拉总计函数为 $\\varphi(n)=(p-1)(q-1)$。\n\n首先，对 $n$ 进行因式分解：\n$$\n91=7\\cdot 13,\n$$\n所以 $p=7$ 且 $q=13$。那么\n$$\n\\varphi(n)=(p-1)(q-1)=(7-1)(13-1)=6\\cdot 12=72.\n$$\n我们必须在以下同余式中求解 $d$\n$$\n5d \\equiv 1 \\pmod{72},\n$$\n即，求 $5$ 模 $72$ 的模逆元。使用扩展欧几里得算法寻找整数 $x$ 和 $y$ 使得\n$$\n5x+72y=1.\n$$\n计算过程如下：\n$$\n72=14\\cdot 5+2,\\quad 5=2\\cdot 2+1.\n$$\n将 $2=72-14\\cdot 5$ 回代入 $1=5-2\\cdot 2$ 中：\n$$\n1=5-2(72-14\\cdot 5)=5-2\\cdot 72+28\\cdot 5=29\\cdot 5-2\\cdot 72.\n$$\n因此 $x=29$ 得到 $5\\cdot 29\\equiv 1 \\pmod{72}$，所以 $5$ 模 $72$ 的模逆元是 $29$。因此，\n$$\nd \\equiv 29 \\pmod{72}.\n$$\n选择最小正代表元得到 $d=29$。", "answer": "$$\\boxed{29}$$", "id": "1397836"}, {"introduction": "在推导出私钥后，一个自然而然的问题是：这个私钥是唯一的吗？本练习将探讨私钥的等价性，证明私钥 `d` 并非一个孤立的整数，而是一个满足特定模运算关系的整数集合中的任意一员。通过计算另一个有效的私钥，你将加深对模算术在RSA算法中核心作用的理解。 [@problem_id:1397848]", "problem": "在一个基于 Rivest-Shamir-Adleman (RSA) 算法的公钥密码系统中，选择模数 $n$ 使得欧拉函数的值为 $\\phi(n) = 40$。公钥指数选为 $e=7$。一台计算机正确地计算出一个可能的对应私钥指数为 $d_1 = 23$。然而，任何与该私钥模 $\\phi(n)$ 同余的整数也都是一个有效的私钥。求能作为此系统有效私钥的最小正整数 $d_2$，其中 $d_2 \\neq d_1$。", "solution": "在 RSA 算法中，私钥指数 $d$ 满足同余式\n$$\ne d \\equiv 1 \\pmod{\\phi(n)}.\n$$\n此处 $\\phi(n)=40$ 且 $e=7$。给定的 $d_{1}=23$ 是一个解，因为\n$$\n7 \\cdot 23 = 161 \\equiv 1 \\pmod{40},\n$$\n因为 $161 - 4 \\cdot 40 = 1$。\n\n对于一个线性同余式，如果 $d_{1}$ 是一个解，那么所有的解都由下式给出\n$$\nd \\equiv d_{1} \\pmod{\\phi(n)} \\quad \\Longleftrightarrow \\quad d = d_{1} + k\\,\\phi(n), \\quad k \\in \\mathbb{Z}.\n$$\n因此，\n$$\nd = 23 + 40k.\n$$\n为了找到不等于 $d_{1}$ 的最小正整数 $d_{2}$，我们选择能得到一个不同的正值的最小整数 $k$，即 $k=1$：\n$$\nd_{2} = 23 + 40 = 63.\n$$\n验证：\n$$\n7 \\cdot 63 = 441 \\equiv 1 \\pmod{40},\n$$\n因为 $441 - 11 \\cdot 40 = 1$。因此，$d_{2}=63$ 是不同于 $23$ 的最小正整数，且也是一个有效的私钥。", "answer": "$$\\boxed{63}$$", "id": "1397848"}, {"introduction": "尽管RSA加密旨在变换（或“扰乱”）消息，但某些特殊的消息在加密后竟会惊人地保持不变，这些消息被称为“不动点”。本练习将挑战你找出这些特殊的不动点消息。解决这个问题需要你运用中国剩余定理和费马小定理等核心数论工具，从而揭示RSA加密过程中的一些微妙特性。 [@problem_id:1397859]", "problem": "Rivest-Shamir-Adleman (RSA) 算法是一种基础的公钥密码系统。在该系统中，一条表示为整数 $M$ 的消息，使用公钥 $(n, e)$ 通过运算 $C \\equiv M^{e} \\pmod{n}$ 加密为密文 $C$。\n\n考虑一个特定的 RSA 系统，其公钥为 $(n, e) = (77, 13)$。尽管加密旨在转换消息，但可能存在某些“不动点”消息，这些消息在加密操作后保持不变。也就是说，它们满足条件 $M^{e} \\equiv M \\pmod{n}$。\n\n求出在该特定 RSA 系统中，范围 $1  M  77$ 内作为不动点的不同整数消息 $M$ 的总数。", "solution": "我们寻找满足 $1  M  77$ 且 $M^{13} \\equiv M \\pmod{77}$ 的整数 $M$。由于 $77 = 7 \\cdot 11$ 且 $\\gcd(7,11) = 1$，根据中国剩余定理，同余式 $M^{13} \\equiv M \\pmod{77}$ 成立的充要条件是它同时对模 $7$ 和模 $11$ 成立。\n\n将条件改写为\n$$\nM^{13} \\equiv M \\pmod{n} \\quad \\Longleftrightarrow \\quad M\\bigl(M^{12}-1\\bigr) \\equiv 0 \\pmod{n}.\n$$\n\n考虑模 $7$ 的情况。对于 $M \\equiv 0 \\pmod{7}$，该条件平凡地成立。对于 $M \\not\\equiv 0 \\pmod{7}$，根据费马小定理有 $M^{6} \\equiv 1 \\pmod{7}$，因此 $M^{12} \\equiv 1 \\pmod{7}$，所以\n$$\nM\\bigl(M^{12}-1\\bigr) \\equiv M(1-1) \\equiv 0 \\pmod{7}.\n$$\n因此，每个模 $7$ 的剩余类都满足 $M^{13} \\equiv M \\pmod{7}$。在模 $7$ 意义下有 $7$ 个解。\n\n考虑模 $11$ 的情况。对于 $M \\equiv 0 \\pmod{11}$，该条件平凡地成立。对于 $M \\not\\equiv 0 \\pmod{11}$，根据费马小定理有 $M^{10} \\equiv 1 \\pmod{11}$，因此 $M^{12} \\equiv M^{2} \\pmod{11}$。所以\n$$\nM^{13} - M \\equiv M\\bigl(M^{12}-1\\bigr) \\equiv M\\bigl(M^{2}-1\\bigr) \\equiv M(M-1)(M+1) \\pmod{11}.\n$$\n在模 $11$ 的域上，该表达式恰好在 $M \\equiv 0, 1, -1 \\pmod{11}$ 时为零。因此，在模 $11$ 意义下有 $3$ 个解。\n\n根据中国剩余定理，模 $77$ 的总解数等于模 $7$ 和模 $11$ 的解数的乘积，即 $7 \\times 3 = 21$。这些解对应于集合 $\\{0,1,\\dots,76\\}$ 中满足该同余式的 $21$ 个剩余类。\n\n题目要求的范围是 $1  M  77$，即 $M \\in \\{2,3,\\dots,76\\}$。在模 $77$ 的 $21$ 个解中，剩余类 $M \\equiv 0$ 和 $M \\equiv 1$ 被该范围排除。因此，符合条件的 $M$ 的数量为\n$$\n21 - 2 = 19.\n$$", "answer": "$$\\boxed{19}$$", "id": "1397859"}]}