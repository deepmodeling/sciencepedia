{"hands_on_practices": [{"introduction": "要真正掌握 Diffie-Hellman 密钥交换，最好的方法是亲自动手计算一次。这个练习将让你扮演参与者 Alice 的角色，通过试错法找到她的私钥，并最终计算出共享密钥。通过这个基础实践，你将熟悉协议的核心数学步骤，并为理解其安全性奠定基础 [@problem_id:1363105]。", "problem": "两个自治数据中心，名为 Alice 和 Bob，需要建立一个共享密钥以进行安全通信。他们决定使用 Diffie-Hellman 密钥交换协议。他们公开约定一个素数模 $p=23$ 和一个本原根（生成元）$g=5$。\n\nAlice 选择一个秘密整数 $a$ 并计算她的公钥 $A = g^a \\pmod{p}$。\nBob 选择一个秘密整数 $b$ 并计算他的公钥 $B = g^b \\pmod{p}$。\n\n他们通过一个不安全的信道交换他们的公钥。一位窃听者 Eve 截获了这些公钥，并得知 Alice 的公钥是 $A=17$，Bob 的公钥是 $B=11$。然而，Eve 无法轻易确定他们的秘密整数 $a$ 和 $b$。\n\nAlice 计算共享密钥为 $s = B^a \\pmod{p}$。Bob 计算共享密钥为 $s = A^b \\pmod{p}$。根据协议设计，他们的结果将是相同的。\n\n你的任务是扮演 Alice。首先，通过测试整数值来确定你的秘密整数 $a$。然后，使用你的秘密整数 $a$，计算最终的共享密钥 $s$。已知秘密整数 $a$ 和 $b$ 是正整数。共享密钥 $s$ 的值是多少？", "solution": "给定 Diffie-Hellman 设置，其中模为 $p=23$，生成元为 $g=5$，Alice 的公钥为 $A=17$，Bob 的公钥为 $B=11$，我们必须找到 Alice 的秘密整数 $a$ 使得 $A \\equiv g^{a} \\pmod{p}$，然后计算共享密钥 $s \\equiv B^{a} \\pmod{p}$。\n\n为了确定 $a$，通过测试连续的指数来求解 $5^{a} \\equiv 17 \\pmod{23}$：\n$$\n\\begin{aligned}\n5^{1} \\equiv 5 \\pmod{23},\\\\\n5^{2} \\equiv 25 \\equiv 2 \\pmod{23},\\\\\n5^{3} \\equiv 2\\cdot 5=10 \\pmod{23},\\\\\n5^{4} \\equiv 10\\cdot 5=50 \\equiv 4 \\pmod{23},\\\\\n5^{5} \\equiv 4\\cdot 5=20 \\pmod{23},\\\\\n5^{6} \\equiv 20\\cdot 5=100 \\equiv 8 \\pmod{23},\\\\\n5^{7} \\equiv 8\\cdot 5=40 \\equiv 17 \\pmod{23}.\n\\end{aligned}\n$$\n因此 $a=7$。\n\n使用平方求幂法计算共享密钥 $s \\equiv B^{a} \\equiv 11^{7} \\pmod{23}$：\n$$\n11^{2} \\equiv 121 \\equiv 6 \\pmod{23},\\quad\n11^{4} \\equiv 6^{2}=36 \\equiv 13 \\pmod{23},\n$$\n并且\n$$\n11^{7}=11^{4}\\cdot 11^{2}\\cdot 11 \\equiv 13\\cdot 6\\cdot 11 \\pmod{23}.\n$$\n计算乘积模 $23$ 的值：\n$$\n13\\cdot 6=78 \\equiv 9 \\pmod{23},\\quad 9\\cdot 11=99 \\equiv 7 \\pmod{23}.\n$$\n因此，$s \\equiv 7 \\pmod{23}$，所以共享密钥是 $s=7$。\n\n（可选验证，通过群结构：因为 $5$ 是模 $23$ 的一个本原根，所以存在一个 $b$ 使得 $5^{b}\\equiv 11$。继续上表计算可得 $b=9$，因此 $s\\equiv 5^{ab}=5^{63}\\equiv 5^{19}\\equiv 7 \\pmod{23}$，与结果相符。）", "answer": "$$\\boxed{7}$$", "id": "1363105"}, {"introduction": "理解 Diffie-Hellman 协议不仅意味着知道正确的步骤，还包括能够识别错误的实现。在这个练习中，你将分析一个有缺陷的计算过程，并找出其中的概念性错误 [@problem_id:1363053]。这有助于巩固你对模幂运算在协议中关键作用的理解，并避免常见的陷阱。", "problem": "两名学生，Alice和Bob，正在使用Diffie-Hellman密钥交换协议来建立一个共享密钥。他们公开约定了一个素数模数 $p = 23$ 和一个生成元 $g = 5$。\n\nAlice选择了一个秘密私钥 $a = 4$。\nBob选择了一个秘密私钥 $b = 7$。\n\n第三名学生 Charlie 观察了公开信息，并试图遵循协议步骤来从 Alice 的角度确定最终的共享秘密。Charlie 将过程记录如下：\n\n**步骤 1：** Alice 使用公式 $A \\equiv g^a \\pmod p$ 计算她的公钥 $A$。\n计算：$A \\equiv 5^4 \\pmod{23}$。因为 $5^4 = 625$ 且 $625 = 27 \\times 23 + 4$，所以 Alice 的公钥是 $A=4$。\n\n**步骤 2：** Bob 使用公式 $B \\equiv g^b \\pmod p$ 计算他的公钥 $B$。\n计算：$B \\equiv 5^7 \\pmod{23}$。因为 $5^7 = 78125$ 且 $78125 = 3396 \\times 23 + 17$，所以 Bob 的公钥是 $B=17$。\n\n**步骤 3：** Alice 和 Bob 交换他们的公钥。现在 Alice 知道 $B=17$，Bob 知道 $A=4$。\n\n**步骤 4：** 为了计算共享秘密 $s$，Alice 使用她的私钥 $a$ 和 Bob 的公钥 $B$。Charlie 假设用于此组合的公式是 $s \\equiv a \\cdot B \\pmod p$。\n\n**步骤 5：** Charlie 根据步骤 4 中的公式进行计算。\n计算：$s \\equiv 4 \\cdot 17 \\pmod{23}$。因为 $4 \\cdot 17 = 68$ 且 $68 = 2 \\times 23 + 22$，所以共享秘密是 $s=22$。\n\n在 Diffie-Hellman 协议的应用中，第一个概念性错误出现在哪个步骤？\n\nA. 步骤 1：Alice 公钥 $A$ 的计算。\n\nB. 步骤 2：Bob 公钥 $B$ 的计算。\n\nC. 步骤 3：公钥的交换。\n\nD. 步骤 4：用于计算共享秘密 $s$ 的公式。\n\nE. 步骤 5：共享秘密 $s$ 的数值计算。", "solution": "在 Diffie-Hellman 密钥交换中，公开参数是一个素数模数 $p$ 和一个模 $p$ 乘法子群的生成元 $g$。每一方选择一个私钥（Alice: $a$, Bob: $b$），使用模 $p$ 幂运算计算公钥，交换公钥，然后通过将收到的公钥与自己的私有指数进行模 $p$ 幂运算来计算共享秘密：\n$$\nA \\equiv g^{a} \\pmod{p}, \\quad B \\equiv g^{b} \\pmod{p}, \\quad s \\equiv B^{a} \\pmod{p} \\equiv A^{b} \\pmod{p}.\n$$\n\n验证步骤 1：\nAlice 计算 $A \\equiv g^{a} \\pmod{p}$，其中 $g=5$, $a=4$, $p=23$。\n计算 $5^{4} \\pmod{23}$。注意 $5^{2}=25 \\equiv 2 \\pmod{23}$，因此 $5^{4} \\equiv (5^{2})^{2} \\equiv 2^{2} \\equiv 4 \\pmod{23}$。所以 $A=4$，步骤 1 是正确的。\n\n验证步骤 2：\nBob 计算 $B \\equiv g^{b} \\pmod{p}$，其中 $g=5$, $b=7$, $p=23$。\n计算 $5^{7} \\pmod{23}$。写作 $5^{7}=5^{4}\\cdot 5^{3}$。根据上面， $5^{4} \\equiv 4 \\pmod{23}$ 并且 $5^{3}=125 \\equiv 125-5\\cdot 23 \\equiv 10 \\pmod{23}$。因此 $5^{7} \\equiv 4 \\cdot 10 \\equiv 40 \\equiv 17 \\pmod{23}$。所以 $B=17$，步骤 2 是正确的。\n\n验证步骤 3：\n交换公钥是一个正确的程序步骤；在交换 $A$ 和 $B$ 的过程中没有概念性错误。\n\n检查步骤 4：\n正确的 Diffie-Hellman 共享秘密计算（从 Alice 的角度）是 $s \\equiv B^{a} \\pmod{p}$（或等效地，从 Bob 的角度是 $s \\equiv A^{b} \\pmod{p}$）。公式 $s \\equiv a \\cdot B \\pmod p$ 用模乘法代替了模幂运算，这不是 Diffie-Hellman 操作。因此，第一个概念性错误是步骤 4 中使用的公式。\n\n为了完整起见，正确的共享秘密应该是 $s \\equiv 17^{4} \\pmod{23}$。因为 $17 \\equiv -6 \\pmod{23}$，$17^{2} \\equiv 36 \\equiv 13 \\pmod{23}$ 且 $17^{4} \\equiv 13^{2} \\equiv 169 \\equiv 8 \\pmod{23}$。这证实了步骤 5 中的乘法是基于不正确的步骤 4，但第一个错误发生在步骤 4。", "answer": "$$\\boxed{D}$$", "id": "1363053"}, {"introduction": "现在，让我们换个角度，从窃听者的视角来审视协议的安全性。这个练习模拟了一个常见的安全事故：一方意外泄露了自己的私钥 [@problem_id:1363064]。你将扮演窃听者 Eve，利用截获的信息计算出本应保密的共享密钥，从而深刻体会保护私钥的极端重要性。", "problem": "两方，Alice 和 Bob，希望使用 Diffie-Hellman 密钥交换协议建立一个共享密钥以进行安全通信。他们公开商定了一个素数模数 $p=107$ 和一个基 $g=2$，其中 $g$ 是模 $p$ 的一个原根。\n\nAlice 选择一个秘密整数 $a$，计算她的公钥 $A = g^a \\pmod p$，并通过公共信道发送 $A$。\n\nBob 选择一个秘密整数 $b$。他打算计算其公钥 $B = g^b \\pmod p$ 并将其发送给 Alice。然而，由于一个软件故障，Bob 的系统发生故障，并通过公共信道广播了他的秘密整数 $b$ 本身，而不是他的公钥 $B$。\n\n一个窃听者 Eve 正在监听该信道，并截获了所有传输的信息。Eve 截获了 Alice 的公钥，其值为 $A=34$。她还截获了 Bob 错误发送的值，即 $b=25$。\n\n根据这些信息，确定 Eve 现在可以计算出的共享密钥的值。", "solution": "在 Diffie-Hellman 协议中，共享秘密是 $K = g^{ab} \\bmod p$。如果 Eve 知道 $b$ 和 Alice 的公钥 $A = g^{a} \\bmod p$，她可以如下计算共享秘密\n$$\nK \\equiv A^{b} \\pmod p.\n$$\n当 $p=107$，$A=34$ 且 $b=25$ 时，共享秘密为\n$$\nK \\equiv 34^{25} \\pmod{107}.\n$$\n使用重复平方和二进制分解 $25=16+8+1$：\n$$\n34^{2} \\equiv 1156 \\equiv 86 \\pmod{107},\n$$\n$$\n34^{4} \\equiv 86^{2} = 7396 \\equiv 13 \\pmod{107},\n$$\n$$\n34^{8} \\equiv 13^{2} = 169 \\equiv 62 \\pmod{107},\n$$\n$$\n34^{16} \\equiv 62^{2} = 3844 \\equiv 99 \\pmod{107}.\n$$\n因此，\n$$\n34^{25} \\equiv 34^{16}\\cdot 34^{8}\\cdot 34 \\equiv 99 \\cdot 62 \\cdot 34 \\pmod{107}.\n$$\n计算模 $107$ 的乘积：\n$$\n99 \\cdot 62 = 6138 \\equiv 39 \\pmod{107},\n$$\n$$\n39 \\cdot 34 = 1326 \\equiv 42 \\pmod{107}.\n$$\n所以，\n$$\nK \\equiv 42 \\pmod{107}.\n$$\nEve 可以计算出的共享秘密是 $42$。", "answer": "$$\\boxed{42}$$", "id": "1363064"}]}