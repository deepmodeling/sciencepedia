## 引言
当一个图不是平面图时，一个自然的问题随之而来：它“有多非平面”？仅仅知道一个图无法在平面上无[交叉](@entry_id:147634)地绘制是不够的，我们需要更精细的工具来量化其复杂性。[图论](@entry_id:140799)通过引入**厚度 (thickness)** 与**[交叉数](@entry_id:264899) (crossing number)** 这两个核心[不变量](@entry_id:148850)，为我们提供了衡量和比较[非平面图](@entry_id:268333)的强大框架。这两个概念不仅是理论上的好奇，更在电路设计、[网络可视化](@entry_id:272365)和[系统工程](@entry_id:180583)等领域扮演着至关重要的角色，因为它们直接关系到物理布局的成本与可行性。

本文将系统地引导读者深入理解这两个概念。在 **“原理与机制”** 一章中，我们将揭示厚度与[交叉数](@entry_id:264899)的精确定义、基本性质以及计算其下界的关键方法。接着，在 **“应用与跨学科联系”** 一章中，我们将视野扩展到现实世界，探讨这些理论如何在VLSI设计、交通规划乃至神经生物学中找到用武之地。最后，通过 **“动手实践”** 一章中的精选问题，你将有机会亲自应用所学知识，解决具体的图论难题。

通过这三章的学习，你将不仅掌握量化非平面性的数学工具，更能体会到[图论](@entry_id:140799)如何将抽象的理论与具体的工程和科学问题紧密相连。让我们首先进入“原理与机制”的世界，探索这两个基本概念的奥秘。

## 原理与机制

在图论的研究中，我们知道并非所有图都是平面图。[库拉托夫斯基定理](@entry_id:276059)为我们提供了判断一个图是否为平面图的精确准则，即一个图是[平面图](@entry_id:269787)当且仅当它不包含任何与完全图 $K_5$ 或完全[二部图](@entry_id:262451) $K_{3,3}$ [同胚](@entry_id:146933)的子图。然而，这一定理只给出了一个“是”或“否”的答案。对于一个[非平面图](@entry_id:268333)，我们自然会问：它“有多非平面”？为了量化图的非平面性，图论学家引入了多个[图不变量](@entry_id:262729)，其中最核心的两个是 **[交叉数](@entry_id:264899) (crossing number)** 和 **厚度 (thickness)**。本章将深入探讨这两个概念的原理、计算方法以及它们之间的深刻联系与区别。

### [交叉数](@entry_id:264899)：最小化边的交点

想象一下在绘制一个复杂的网络图时，我们总希望边与边的交叉尽可能少，以保持图形的清晰可读。[交叉数](@entry_id:264899)的概念正是对这一直观想法的数学抽象。

一个图 $G$ 的**[交叉数](@entry_id:264899)**，记作 $cr(G)$，是指在平面上绘制该图时，边的交点的**最小**可能数量。这里的“绘制”有一些基本规则：顶点不能与任何不与之关联的边重合，没有三条或更多条边在同一点相交，并且相邻的边不在它们的公共顶点之外相交。

一个至关重要的区别是，特定画法的[交叉数](@entry_id:264899)量与图的[交叉数](@entry_id:264899)是两个不同的概念。[交叉数](@entry_id:264899)是所有可能画法中[交叉数](@entry_id:264899)量的最小值。例如，考虑完全图 $K_5$。如果我们将其五个顶点画成一个正五边形的顶点，然后用直线段连接每对顶点，我们可以数出共有5个[交叉点](@entry_id:147634) [@problem_id:1548709]。这些交叉点恰好由每组四个顶点构成的凸四边形的两条对角线形成，总共有 $\binom{5}{4}=5$ 种选择。然而，这只是 $K_5$ 的一种特定画法。通过更巧妙的布局（例如，将一个顶点放在其他四个顶点形成的四边形内部），我们可以画出一个只有一个交叉点的 $K_5$。事实上，$K_5$ 的[交叉数](@entry_id:264899) $cr(K_5)=1$。

[交叉数](@entry_id:264899)最基本的性质是它与平面性的关系：一个图 $G$ 是[平面图](@entry_id:269787)当且仅当它的[交叉数](@entry_id:264899)为0，即 $cr(G)=0$。对于[非平面图](@entry_id:268333)，其[交叉数](@entry_id:264899)必然大于等于1。

计算[交叉数](@entry_id:264899)的一个强大工具是其**单调性**：如果 $H$ 是 $G$ 的一个[子图](@entry_id:273342)，那么 $cr(H) \le cr(G)$。这个性质的道理很直观：任何 $G$ 的画法都包含了一个 $H$ 的画法，因此 $H$ 的[交叉点](@entry_id:147634)数量不会超过 $G$ 的总交叉点数量。这个性质为我们估计复杂图的[交叉数](@entry_id:264899)下界提供了有力依据。例如，我们已知 $cr(K_{3,3})=1$。因此，任何包含 $K_{3,3}$ 作为子图的图 $G$，其[交叉数](@entry_id:264899)都必须至少为1，即 $cr(G) \ge 1$ [@problem_id:1548728]。

确定一个图的精确[交叉数](@entry_id:264899)是一个非常困难的计算问题（事实上是NP-难问题），对于许多图族来说，其[交叉数](@entry_id:264899)仍然是未解之谜。因此，在实践中，我们常常依赖于寻找[交叉数](@entry_id:264899)的下界。一个非常实用的下界来自于对图的[边密度](@entry_id:271104)的分析。

考虑一个有 $n$ 个顶点和 $m$ 条边的简单图 $G$。假设我们有一个 $G$ 的最优画法，其中有 $cr(G)$ 个交叉点。从这个画法中，我们可以通过移除一些边来构造一个平面图。具体来说，在每个[交叉点](@entry_id:147634)处，我们移除参与交叉的两条边中的任意一条。由于一条边可能参与多个交叉，为了保证消除所有交叉，最坏情况下我们需要为每个交叉移除一条边。这样，我们最多移除 $cr(G)$ 条边，得到一个没有[交叉](@entry_id:147634)的新图，它是一个平面图。这个新的平面图有 $n$ 个顶点和至少 $m - cr(G)$ 条边。根据平面图的性质，一个有 $n \ge 3$ 个顶点的简单平面图至多有 $3n-6$ 条边。因此，我们有：
$m - cr(G) \le 3n-6$
移项后得到一个关于[交叉数](@entry_id:264899)的重要下界，有时被称为**[交叉数不等式](@entry_id:263352) (Crossing Number Inequality)**：
$cr(G) \ge m - (3n - 6)$

如果图 $G$ 是一个二部图，我们可以得到一个更强的界。这是因为不含三角形的简单平面图至多有 $2n-4$ 条边。对于[二部图](@entry_id:262451)（其本身不含奇数长度的圈，因此必然不含三角形），同样的论证可以得出：
$m - cr(G) \le 2n-4$
从而得到二部图的[交叉数](@entry_id:264899)下界：
$cr(G) \ge m - (2n - 4)$

让我们通过一个印刷电路板（PCB）设计的例子来说明这些公式的应用 [@problem_id:1548744]。假设一个电路板上有 $n=12$ 个组件（顶点），连接它们的导线（边）的总度数为86。根据[握手引理](@entry_id:261183)，边的数量 $m = \frac{86}{2} = 43$。
1. 如果我们只知道这是一个简单图，我们可以应用通用下界：
$cr(G) \ge 43 - (3 \times 12 - 6) = 43 - (36 - 6) = 43 - 30 = 13$
因此，这个电路板至少需要13个[交叉点](@entry_id:147634)。
2. 如果我们进一步知道这个连接图是[二部图](@entry_id:262451)，我们可以应用更强的专用下界：
$cr(G) \ge 43 - (2 \times 12 - 4) = 43 - (24 - 4) = 43 - 20 = 23$
这个结果表明，了解图的结构（如二部性）可以显著提高我们对[交叉数](@entry_id:264899)下界的估计精度。

### 厚度：分解为平面层

与[交叉数](@entry_id:264899)不同，厚度从另一个角度来量化非[平面性](@entry_id:274781)。它不是问最少需要多少交叉，而是问最少需要多少个“层面”才能完全无[交叉](@entry_id:147634)地画出整个图。这在多层印刷电路板或VLSI芯片设计中有非常直接的物理对应。

一个图 $G$ 的**厚度**，记作 $\theta(G)$，是这样一个最小的整数 $k$，使得 $G$ 的[边集](@entry_id:267160)可以被划分为 $k$ 个[子集](@entry_id:261956) $E_1, E_2, \dots, E_k$，并且每个子图 $G_i = (V, E_i)$ 都是平面图。

从定义可知，一个图是[平面图](@entry_id:269787)当且仅当其厚度为1，即 $\theta(G)=1$ [@problem_id:1548743]。例如，三角柱图（由两个相距遥远的三角形的对应顶点相连构成）虽然看起来是三维的，但它实际上可以被无[交叉](@entry_id:147634)地画在平面上，因此它是一个平面图，其厚度为1 [@problem_id:1548754]。

与[交叉数](@entry_id:264899)类似，计算厚度也是一个困难的问题。我们同样可以利用[平面图](@entry_id:269787)的[边密度](@entry_id:271104)性质来推导其下界。如果一个有 $n$ 个顶点和 $m$ 条边的图 $G$ 的厚度为 $\theta(G) = k$，这意味着它的 $m$ 条边可以被分配到 $k$ 个平面子图中。由于每个平面子图最多有 $3n-6$ 条边，所以总边数 $m$ 必须满足：
$m \le k \cdot (3n - 6)$
由此可得厚度的下界：
$\theta(G) \ge \lceil \frac{m}{3n-6} \rceil$

同样，如果图 $G$ 是[二部图](@entry_id:262451)，则下界可以加强为：
$\theta(G) \ge \lceil \frac{m}{2n-4} \rceil$

这些下界在确定网络设计的根本性限制时非常有用。例如，在一个无线[传感器网络](@entry_id:272524)设计中，要求网络中的每个节点（顶点）都必须与至少 $\delta_{min}$ 个其他节点直接通信 [@problem_id:1548732]。这意味着图中每个[顶点的度](@entry_id:264944)都至少为 $\delta_{min}$。根据[握手引理](@entry_id:261183)，我们知道 $2m = \sum \deg(v) \ge n \cdot \delta_{min}$，即 $m \ge \frac{n \cdot \delta_{min}}{2}$。
为了保证网络是非平面的（即 $\theta(G) \ge 2$），其边数 $m$ 必须超过[平面图](@entry_id:269787)的边数上限 $3n-6$。因此，我们寻求一个 $\delta_{min}$ 值，使得以下不等式对所有 $n$ 恒成立：
$\frac{n \cdot \delta_{min}}{2} \gt 3n - 6$
$n \cdot \delta_{min} \gt 6n - 12$
$\delta_{min} \gt 6 - \frac{12}{n}$
为了使这个不等式对所有 $n \ge 4$ 都成立，$\delta_{min}$ 必须大于上式的上确界，即 $\lim_{n \to \infty} (6 - \frac{12}{n}) = 6$。由于 $\delta_{min}$ 是整数，最小的取值就是6。当 $\delta_{min}=6$ 时，$m \ge 3n$，这总是大于 $3n-6$，因此图必定是非平面的。而当 $\delta_{min}=5$ 时，我们无法保证非[平面性](@entry_id:274781)，例如，正二十面体图有12个顶点，每个[顶点的度](@entry_id:264944)都是5，但它是一个[平面图](@entry_id:269787)。因此，6是保证任何[网络设计](@entry_id:267673)都无法在单个平面层上实现的[最小度](@entry_id:273557)数阈值。

### [交叉数](@entry_id:264899)与厚度的关联与区别

我们已经看到，[交叉数](@entry_id:264899)和厚度都是从0或1开始度量非[平面性](@entry_id:274781)的。它们之间最基础也是最重要的联系在于对[平面性](@entry_id:274781)的刻画。对于任意[简单图](@entry_id:274882) $G$，以下三个陈述是等价的 [@problem_id:1548743]：
1. $G$ 是平面图。
2. $G$ 的[交叉数](@entry_id:264899) $cr(G) = 0$。
3. $G$ 的厚度 $\theta(G) = 1$。

然而，一旦图是非平面的，这两个[不变量](@entry_id:148850)就开始展现出它们各自独特的“个性”。一个很自然的问题是：一个图的[交叉数](@entry_id:264899)和厚度之间是否存在固定的函数关系？答案是否定的。

让我们考察最简单的[非平面图](@entry_id:268333)。对于完全二部图 $K_{3,3}$，我们有 $cr(K_{3,3})=1$ 且 $\theta(K_{3,3})=2$ [@problem_id:1548710]。对于完全图 $K_5$，同样有 $cr(K_5)=1$ 且 $\theta(K_5)=2$ [@problem_id:1548720]。这表明，即使是[交叉数](@entry_id:264899)最小的[非平面图](@entry_id:268333)，也已经需要两层平面子图才能完全绘制。

尽管在这些基础例子中它们的值看起来相关，但[交叉数](@entry_id:264899)和厚度在图的规模变大时会以截然不同的方式增长。一个有力的反例可以证明，即使两个图的[交叉数](@entry_id:264899)相等，它们的厚度也可能不同 [@problem_id:1548720]。考虑两个图 $G_1 = K_9$ 和 $G_2 = 36K_5$（即36个互不相连的 $K_5$ 的并集）。
- **[交叉数](@entry_id:264899)分析**：[交叉数](@entry_id:264899)在图的不交并运算下是可加的，即 $cr(A \sqcup B) = cr(A) + cr(B)$。而已知 $cr(K_9)=36$ 和 $cr(K_5)=1$。因此，$cr(G_1) = 36$，而 $cr(G_2) = cr(36K_5) = 36 \times cr(K_5) = 36 \times 1 = 36$。它们的[交叉数](@entry_id:264899)是相等的。
- **厚度分析**：厚度在图的不交并运算下取最大值，即 $\theta(A \sqcup B) = \max\{\theta(A), \theta(B)\}$。而已知 $\theta(K_9)=3$ 和 $\theta(K_5)=2$。因此，$\theta(G_1) = 3$，而 $\theta(G_2) = \theta(36K_5) = \theta(K_5) = 2$。它们的厚度是不同的。
这个例子清晰地表明，[交叉数](@entry_id:264899)和厚度是两个独立的度量，它们捕捉了图非[平面性](@entry_id:274781)的不同方面。[交叉数](@entry_id:264899)更关心“局部”的纠缠程度，而厚度则更关心“全局”的结构分解。

最后，需要警惕一个常见的误解：一个图的厚度小，是否意味着它的其他[图不变量](@entry_id:262729)（如图着色数）也小？答案同样是否定的。考虑一个由8颗卫星组成的通信网络，其中每颗卫星都与其他所有卫星相连 [@problem_id:1548702]。这个网络可以用完全图 $K_8$ 来建模。为了避免信号冲突，任何直接相连的卫星必须使用不同的频率信道，这等价于对图进行[顶点着色](@entry_id:267488)。
- 对于 $K_8$，由于每个顶点都与其他7个顶点相邻，所以所有8个顶点都必须使用不同的颜色。因此，其**着[色数](@entry_id:274073)** $\chi(K_8)=8$。这意味着至少需要8个信道。
- 与此同时，图论中一个已知的结论是 $K_8$ 的厚度为2，即 $\theta(K_8)=2$。这意味着 $K_8$ 的所有边可以被分解成两个平面[子图](@entry_id:273342)。
这里出现了一个看似矛盾的情况：既然 $K_8$ 可以被画在两个平面层上，而根据[四色定理](@entry_id:269820)，每个平面层最多只需要4种颜色，为什么我们不能用比如 $4+4=8$ 甚至更少的颜色来为整个 $K_8$ 着色呢？关键在于，顶点的颜色是图的固有属性，与它在哪一层被绘制无关。一个顶点必须有一个确定的颜色，这个颜色要与它所有邻居的颜色都不同，无论这些连接边在哪一个平面层。由于在 $K_8$ 中每个顶点都与其他所有顶点相连，所以无论如何分解，这8个顶点之间都存在邻接关系，因此必须使用8种不同的颜色。这个例子深刻地说明了，一个图的厚度虽小，但其着色数可能很大。厚度只约束了边的布局，而没有直接约束[顶点着色](@entry_id:267488)所需的颜色总数。

总之，[交叉数](@entry_id:264899)和厚度是理解和分析[非平面图](@entry_id:268333)的两个基本工具。它们各自提供了独特的视角来衡量图的复杂性，并在从[电路设计](@entry_id:261622)到[网络可视化](@entry_id:272365)的众多应用领域中发挥着关键作用。理解它们的定义、性质以及它们之间的异同，是深入学习图论的必经之路。