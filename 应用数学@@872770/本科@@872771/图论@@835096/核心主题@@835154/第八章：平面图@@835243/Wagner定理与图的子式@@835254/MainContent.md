## 引言
在探索[复杂网络](@entry_id:261695)的结构时，如图的[平面性](@entry_id:274781)——即能否在平面上绘制而无边交叉——是一个基础而核心的问题。传统的子图概念在捕捉深层结构相似性方面存在不足，因此我们需要一个更强大的框架。本文旨在填补这一空白，深入探讨“[图子式](@entry_id:269769)”这一关键概念，并展示其如何为[图论](@entry_id:140799)中最优雅的定理之一——[瓦格纳定理](@entry_id:267584)——奠定基础。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。第一章 **“原理与机制”** 将详细介绍[图子式](@entry_id:269769)的三种基本操作，阐明其与子图的区别，并最终引出[瓦格纳定理](@entry_id:267584)，揭示$K_5$和$K_{3,3}$作为所有[非平面图](@entry_id:268333)“基因”的本质。第二章 **“应用与[交叉](@entry_id:147634)学科联系”** 将视野扩展到平面性之外，展示子式理论如何用于定义其他图类、指导算法设计，并与计算机科学和[拟阵](@entry_id:273122)理论等领域建立深刻联系。最后，在 **“动手实践”** 部分，读者将通过具体问题，亲手操作和应用所学知识，将抽象的理论转化为解决实际问题的能力。

## 原理与机制

在[图论](@entry_id:140799)中，为了理解和分类图的复杂结构，我们常常需要一种方法来描述一种图“包含”于另一种图之中的概念。[子图](@entry_id:273342)的概念是一种直接的方式，但它在捕捉更深层次的结构相似性方面存在局限。[图子式](@entry_id:269769)（graph minor）提供了一个更强大、更灵活的框架，它允许我们通过一系列基本操作来识别图的内在结构。本章将深入探讨[图子式](@entry_id:269769)的定义、性质，并最终引出图论中一个里程碑式的定理——[瓦格纳定理](@entry_id:267584)（Wagner's theorem），它利用[图子式](@entry_id:269769)为[平面图](@entry_id:269787)提供了一个优美的刻画。

### 定义[图子式](@entry_id:269769)：基本操作

[图子式](@entry_id:269769)的概念建立在三种[基本图](@entry_id:160617)操作之上：**删点 (vertex deletion)**、**删边 (edge deletion)** 和 **[边收缩](@entry_id:265581) (edge contraction)**。前两种操作很容易理解：删除一个顶点会同[时移](@entry_id:261541)除所有与之关联的边；删除一条边则只移除该边，顶点保持不变。

第三种操作，**[边收缩](@entry_id:265581)**，是[图子式理论](@entry_id:264428)的核心。收缩一条边 $e = \{u, v\}$，意味着将顶点 $u$ 和 $v$ 合并成一个单一的新顶点，我们称之为 $w$。原图中所有与 $u$ 或 $v$ 相邻的顶点（除了 $u$ 和 $v$ 自身），现在都与新顶点 $w$ 相邻。如果在收缩过程中，新顶点 $w$ 和另一个顶点之间形成了多条边（即平行边），我们会将它们合并为一条边，以保持图的简单性。同样，由收缩产生的自环（即 $w$ 到自身的边）通常也会被移除。

基于这三种操作，我们可以正式定义**[图子式](@entry_id:269769)**：如果图 $H$ 可以通过对图 $G$ 进行一系列的删点、删边和[边收缩](@entry_id:265581)操作得到，那么我们称 $H$ 是 $G$ 的一个**子式 (minor)**。

这个定义揭示了一个重要的关系：任何图 $G$ 的[子图](@entry_id:273342) $H$ 也必然是 $G$ 的一个子式。这是因为我们可以通过只使用删点和删边操作从 $G$ 得到 $H$。例如，为了从 $G$ 中获得其某个[诱导子图](@entry_id:270312)，我们只需删除所有不在该子图中的顶点。为了获得一个更一般的[子图](@entry_id:273342)，我们可以在此基础上再删除一些不需要的边 [@problem_id:1554500]。因此，子式关系是[子图](@entry_id:273342)关系的一种泛化。

[边收缩](@entry_id:265581)操作的效果可能非常强大。以完全图 $K_n$ 为例，它有 $n$ 个顶点，且每对顶点之间都有一条边。如果在 $K_n$ (对于 $n \ge 2$) 中收缩任意一条边 $\{u, v\}$，会发生什么？新顶点 $w$ 会与所有其他 $n-2$ 个顶点相连，因为原图中 $u$ 和 $v$ 都与这些顶点相连。同时，剩下的 $n-2$ 个顶点之间原有的边都得以保留，它们本身就构成了一个 $K_{n-2}$。因此，收缩后的图恰好是 $K_{n-1}$。这个过程可以被重复。例如，从 $K_5$ 开始，进行一次[边收缩](@entry_id:265581)得到 $K_4$，再进行一次[边收缩](@entry_id:265581)得到 $K_3$。由于 $K_3$ 本身也是一个三顶点[循环图](@entry_id:273723) $C_3$，这说明我们通过两次[边收缩](@entry_id:265581)操作，将非循环的 $K_5$ 转化为了一个[循环图](@entry_id:273723) [@problem_id:1554490]。

### 子式关系的性质

子式关系具有一些深刻的数学性质，这些性质使其成为研究图结构[不变性](@entry_id:140168)的有力工具。

#### 子式闭合族与保持的性质

子式关系的一个基本性质是**传递性 (transitivity)**。如果 $J$ 是 $H$ 的子式，而 $H$ 又是 $G$ 的子式，那么 $J$ 也必然是 $G$ 的子式。这是因为从 $G$ 得到 $H$ 的操作序列，和从 $H$ 得到 $J$ 的操作序列，可以合并成一个单一的、从 $G$ 直接得到 $J$ 的操作序列 [@problem_id:1554471]。

这个性质引出了**子式闭合 (minor-closed)** 图族的想法。一个图的集合（或称为“族”）如果满足以下条件，则称其为子式闭合的：对于族中的任何图 $G$， $G$ 的所有子式也都在该族中。

**平面图 (planar graphs)** 的集合是子式闭合族最经典、最重要的例子。一个图是平面的，如果它可以在平面上被绘制出来而没有任何边交叉。直观上，如果我们从一个平面图的[平面嵌入](@entry_id:263159)中删除一个顶点或一条边，显然不会引入任何交叉，所以得到的[子图](@entry_id:273342)仍然是平面的。[边收缩](@entry_id:265581)操作稍微复杂一些，但同样可以被看作是在[平面嵌入](@entry_id:263159)中将一条边“缩短”至一个点，这个过程同样不会引入边的[交叉](@entry_id:147634)。因此，平面图的任何子式都必定是平面的。这一性质在 **[@problem_id:1554471]** 的例子中得到了体现：一个[非平面图](@entry_id:268333) $G$（$K_5$ 的细分）经过删点操作后，其子式 $H$ 变为平面图，而 $H$ 的任何子式（如 $J$）也因此必然是平面的。

#### 子式操作下不保持的性质

虽然平面性这类“单调”性质在子式操作下得以保持，但许多其他重要的图属性却并非如此。理解这一点对于避免错误的猜想至关重要。

一个常见的误解是，[图子式](@entry_id:269769)的[最大度](@entry_id:265573)数不会超过原图。然而，[边收缩](@entry_id:265581)操作完全可能导致度数的增加。考虑一个图 $G$，其中有两个相邻的顶点 $u$ 和 $v$。如果我们将边 $\{u, v\}$ 收缩成新顶点 $w$，那么 $w$ 的度数将是 $u$ 和 $v$ 的邻居集合（除去 $u, v$ 本身）的并集的大小。在没有公共邻居的简单情况下，新[顶点的度](@entry_id:264944)数是 $\deg(w) = \deg(u) + \deg(v) - 2$。如果 $\deg(u)$ 和 $\deg(v)$ 都比较大，$\deg(w)$ 很容易超过原图的[最大度](@entry_id:265573)数。例如，在一个由六个顶点组成的图中，如果顶点 $v_1$ 的度数为 $3$，与其相邻的 $v_2$ 的度数也为 $3$，那么收缩边 $\{v_1, v_2\}$ 会产生一个度数为 $3+3-2=4$ 的新顶点，而原图的[最大度](@entry_id:265573)数仅为 $3$ [@problem_id:1554450]。

另一个更令人惊讶的例子是**色数 (chromatic number)**，即为图的[顶点着色](@entry_id:267488)以使相邻顶点颜色不同所需的最少颜色数，记为 $\chi(G)$。人们可能猜测 $\chi(H) \le \chi(G)$ 对于任何 $G$ 的子式 $H$ 都成立。然而，这也是错误的。一个经典的的反例是偶环。考虑 $6$ 顶点的[循环图](@entry_id:273723) $C_6$，它是一个偶环，可以用两种颜色着色，因此 $\chi(C_6) = 2$。如果我们收缩 $C_6$ 中的任意一条边，就会得到一个 $5$ 顶点的[循环图](@entry_id:273723) $C_5$。$C_5$ 是一个[奇环](@entry_id:271287)，它需要三种颜色才能正确着色，即 $\chi(C_5) = 3$。这里，$H=C_5$ 是 $G=C_6$ 的子式，但我们有 $\chi(H) = 3 \gt \chi(G) = 2$ [@problem_id:1554467]。这一现象激发了[图论](@entry_id:140799)中一个著名的猜想——哈德威格猜想 (Hadwiger's conjecture)，它断言如果一个图不含 $K_k$ 作为子式，则其色数最多为 $k-1$。

此外，图的连通性等结构属性也可能在子式操作下被破坏。例如，一个图是 **2-连通的 (2-connected)** 是指它至少有3个顶点，并且移除任意单个顶点都不会使其断开。然而，对一个[2-连通图](@entry_id:262525)进行[边收缩](@entry_id:265581)，可能会产生一个不再是2-连通的图，即新图可能包含一个**割点 (cut vertex)**。一个简单的例子是两个三角形通过一条公共边连接而成的图。这个图是2-连通的，但如果收缩这条公共边，新产生的顶点就成为了一个割点，因为它将图分成了两个独立的部分 [@problem_id:1554505]。

### 拓扑子式及其与[图子式](@entry_id:269769)的关系

在讨论平面性时，另一个相关的概念是**拓扑子式 (topological minor)**，或称为**图的细分 (graph subdivision)**。一个图 $S$ 是图 $H$ 的一个细分，如果 $S$ 可以通过在 $H$ 的一些边上插入度为 $2$ 的新顶点来得到。反过来说，这相当于将 $H$ 的一些边替换为内部顶点度为 $2$ 的路径。我们称 $G$ 包含 $H$ 的一个拓扑子式，如果 $G$ 的某个子图是 $H$ 的一个细分。

拓扑子式和[图子式](@entry_id:269769)之间存在着一个至关重要的联系：**如果一个图 $G$ 包含 $H$ 的一个拓扑子式，那么 $H$ 一定是 $G$ 的一个子式。**

这个结论的证明过程本身就很好地说明了[图子式](@entry_id:269769)操作的原理。假设 $G$ 中含有一个子图 $S$，且 $S$ 是 $H$ 的一个细分。我们可以通过以下两个步骤从 $G$ 获得 $H$：
1.  **删除操作**：首先，我们删除 $G$ 中所有不属于[子图](@entry_id:273342) $S$ 的顶点和边。经过这一系列删点和删边操作后，我们得到了图 $S$ 本身。
2.  **收缩操作**：在图 $S$ 中，原图 $H$ 的每条边 $\{u, v\}$ 都对应着一条连接相应“分支顶点”的路径。对于每一条这样的路径，我们沿着路径[连续收缩](@entry_id:154115)其上的边。每收缩一条边，路径长度减一，最终这条路径会变成一条连接 $u$ 和 $v$ 的单边。对所有被细分的边都执行此操作后，我们得到的图就同构于 $H$ [@problem_id:1554466]。

这个关系非常重要，因为它连接了两个不同但相关的“图包含”概念。历史上，[库拉托夫斯基定理](@entry_id:276059) (Kuratowski's theorem) 使用拓扑子式来刻画平面图。而[瓦格纳定理](@entry_id:267584)则使用[图子式](@entry_id:269769)，提供了一个在某些方面更具结构性洞察的等价表述。

### [瓦格纳定理](@entry_id:267584)：平面性的刻画

我们已经知道，平面图族是子式闭合的。一个自然的问题是：我们能否通过“禁止”某些特定的[非平面图](@entry_id:268333)作为子式来完全定义平面图？著名的**[罗伯逊-西摩定理](@entry_id:272110) (Robertson-Seymour theorem)** 保证了对于任何子式闭合的图族，都存在一个有限的“禁止子式”集合。一个图属于该族，当且仅当它不包含这个集合中的任何一个图作为其子式。

对于平面图族，这个禁止子式集合是什么？**[瓦格纳定理](@entry_id:267584)**给出了精确的答案。

**[瓦格纳定理](@entry_id:267584) (Wagner's Theorem)**：一个有限图是平面的，当且仅当它不以**[完全图](@entry_id:266483) $K_5$** 或**[完全二分图](@entry_id:276229) $K_{3,3}$** 作为其子式。

这个定理意味着，非平面性的“根本原因”总可以追溯到这两种结构之一的存在。任何[非平面图](@entry_id:268333)，无论多么庞大和复杂，都必须在其结构深处“隐藏”着一个 $K_5$ 或 $K_{3,3}$ 的子式。因此，集合 $\{K_5, K_{3,3}\}$ 是[平面图](@entry_id:269787)族的完整禁止子式集 [@problem_id:1546331]。

#### 禁止子式与子式极小[非平面图](@entry_id:268333)

$K_5$ 和 $K_{3,3}$ 被称为**子式极小[非平面图](@entry_id:268333) (minor-minimal non-planar graphs)**。这个术语的含义是：
1.  图本身是非平面的。
2.  它的任何**真子式 (proper minor)**（即通过至少一次删点、删边或[边收缩](@entry_id:265581)操作得到的子式）都是平面的。

换言之，它们是“最简单”的[非平面图](@entry_id:268333)。你不能通过移除或收缩它们的任何部分来制造一个更小的[非平面图](@entry_id:268333)。

一个重要的结构性结论是，任何子式极小[非平面图](@entry_id:268333)都必须是 **2-连通的**。如果一个[非平面图](@entry_id:268333) $G$ 有一个割点 $v$，那么 $G$ 可以被分解为两个在 $v$ 处相连的子图 $G_1$ 和 $G_2$。由于 $G$ 是非平面的，它必然包含一个 $K_5$ 或 $K_{3,3}$ 子式。这个子式必须完全位于 $G_1$ 或 $G_2$ 中（因为 $K_5$ 和 $K_{3,3}$ 都是 2-连通的）。这意味着 $G_1$ 或 $G_2$ 本身就已经是一个[非平面图](@entry_id:268333)了。但 $G_1$ 和 $G_2$ 都是 $G$ 的真子式，这与 $G$ 的子式极小性相矛盾。因此，$G$ 不能有割点，必须是 2-连通的。

#### $K_5$ 和 $K_{3,3}$ 的极小性

让我们来验证 $K_{3,3}$ 确实满足子式极小[非平面图](@entry_id:268333)的定义。首先，根据[库拉托夫斯基定理](@entry_id:276059)，$K_{3,3}$ 是非平面的。接下来，我们需要证明对它进行任何一次基本操作都会得到一个[平面图](@entry_id:269787) [@problem_id:1554494]。
*   **删点**：从 $K_{3,3}$ 中删除任意一个顶点，得到的图是 $K_{2,3}$。$K_{2,3}$ 是一个平面图，可以轻松绘制而无边[交叉](@entry_id:147634)。
*   **删边**：从 $K_{3,3}$ 中删除任意一条边，得到的图有 6 个顶点和 8 条边。根据欧拉公式的推论，一个包含 $K_{3,3}$ 细分的图至少需要 9 条边，包含 $K_5$ 细分的图至少需要 10 条边。因此，删除一条边后的图不可能包含 $K_5$ 或 $K_{3,3}$ 的细分，根据[库拉托夫斯基定理](@entry_id:276059)，它是平面的。
*   **[边收缩](@entry_id:265581)**：在 $K_{3,3}$ 中，任何一条边都连接着两个不同部集中的顶点。收缩这样一条边会将其两个端点合并。例如，如果顶点 $u_1$ 和 $v_1$ 合并为新顶点 $w$，那么 $w$ 会与 $u_2, u_3, v_2, v_3$ 相连，同时 $u_2, u_3$ 与 $v_2, v_3$ 之间原有的连接保持不变。最终得到的[图同构](@entry_id:143072)于一个带四个轮辐的[轮图](@entry_id:271886) $W_4$，它是平面的。

对 $K_5$ 也可以进行类似的分析，证明其任何一次删点、删边或[边收缩](@entry_id:265581)操作都会产生一个平面图。因此，$K_5$ 和 $K_{3,3}$ 共同构成了所有[非平面图](@entry_id:268333)的不可约“核心”。

作为对这两个基本[非平面图](@entry_id:268333)的进一步理解，我们可以计算它们的**圈数 (cyclomatic number)** $\mu(G) = |E| - |V| + 1$，这个量度量了图中的独立环路数量。
对于 $K_5$，我们有 $|V|=5, |E|=\binom{5}{2}=10$，因此 $\mu(K_5) = 10 - 5 + 1 = 6$。
对于 $K_{3,3}$，我们有 $|V|=3+3=6, |E|=3 \times 3=9$，因此 $\mu(K_{3,3}) = 9 - 6 + 1 = 4$。
这两个图的圈数之和为 $6+4=10$ [@problem_id:1554459]。

总之，[图子式](@entry_id:269769)和[瓦格纳定理](@entry_id:267584)为我们提供了一套强大的语言和工具，用以从结构上理解和分类图，特别是揭示了平面性的深刻本质。它表明，看似无穷无尽的[非平面图](@entry_id:268333)世界，其根本的复杂性可以归结为两个原型——$K_5$ 和 $K_{3,3}$ 的存在。