{"hands_on_practices": [{"introduction": "理解如何遍历一棵树是基础，但我们能反向这个过程吗？本练习挑战你从一棵二叉树的中序和后序遍历序列中重建出其唯一的结构。掌握这项技能就像学会解读树的结构DNA，能巩固你对遍历方式与底层父子关系之间联系的理解。[@problem_id:1483739]", "problem": "在数据结构的研究中，如果已知一个二叉树的中序遍历和后序遍历序列，那么这个二叉树是唯一确定的。考虑一个有七个不同节点的二叉树，节点用字符标记。经中序遍历访问的节点序列为 `D, B, E, A, F, C, G`，而后序遍历的序列为 `D, E, B, F, G, C, A`。\n\n根据这些信息，确定该二叉树的正确前序遍历序列。\n\n请从以下选项中选择您的答案：\n\nA. `A, B, D, E, C, F, G`\n\nB. `A, C, G, F, B, E, D`\n\nC. `D, E, B, F, G, C, A`\n\nD. `D, B, E, A, F, C, G`\n\nE. `A, B, C, D, E, F, G`\n\nF. `G, C, F, A, E, B, D`", "solution": "我们利用树遍历的性质：\n1) 在后序遍历中，最后一个元素是根节点。给定后序遍历 $D, E, B, F, G, C, A$，根节点是 $A$。\n2) 在中序遍历中，根节点左边的元素属于左子树，右边的元素属于右子树。给定中序遍历 $D, B, E, A, F, C, G$，我们在 $A$ 处分割得到：\n$$\\text{in-order left} = D, B, E \\quad \\text{and} \\quad \\text{in-order right} = F, C, G.$$\n后序遍历序列也相应地在最后一个元素 $A$ 之前（并保持原有顺序）分割成左子树和右子树的部分：\n$$\\text{post-order left} = D, E, B \\quad \\text{and} \\quad \\text{post-order right} = F, G, C.$$\n\n重建左子树：\n- 根据 $\\text{post-order left} = D, E, B$，根节点是 $B$。\n- 在 $\\text{in-order left} = D, B, E$ 中，以 $B$ 为界分割：左边是 $D$，右边是 $E$。\n- 因此，左子树是以 $B$ 为根节点，左孩子为 $D$，右孩子为 $E$ 的树。\n\n重建右子树：\n- 根据 $\\text{post-order right} = F, G, C$，根节点是 $C$。\n- 在 $\\text{in-order right} = F, C, G$ 中，以 $C$ 为界分割：左边是 $F$，右边是 $G$。\n- 因此，右子树是以 $C$ 为根节点，左孩子为 $F$，右孩子为 $G$ 的树。\n\n计算前序遍历（根、左、右）：\n- 访问根节点 $A$。\n- 然后前序遍历左子树：$B, D, E$。\n- 然后前序遍历右子树：$C, F, G$。\n因此，前序遍历序列是 $A, B, D, E, C, F, G$，对应选项 A。", "answer": "$$\\boxed{A}$$", "id": "1483739"}, {"introduction": "在学会重建一棵特定的树之后，一个自然的问题随之而来：给定一定数量的节点，存在多少种不同的树结构？这个问题将我们带入组合计数的迷人领域，揭示了满二叉树与数学中的著名序列——卡特兰数之间的深刻联系。通过解决这个问题，你将从分析单个实例转向理解所有可能树结构的宏观图景。[@problem_id:1483720]", "problem": "在图论中，**有根树**是一种将其中一个顶点指定为根的树。**满二叉树**是一种特殊的有根树，其中每个顶点要么有零个孩子，要么有两个孩子。有零个孩子的顶点称为叶子，有两个孩子的顶点称为内部顶点。如果两个有根树的顶点之间存在一一对应关系，且这种关系保留了根以及所有的父子关系，则称这两个有根树是**同构的**。\n\n确定恰好包含9个顶点的非同构、有根、满二叉树的总数。", "solution": "设 $i$ 为内部顶点的数量，$l$ 为叶子的数量。在任何有根满二叉树中，每个内部顶点恰好有两个孩子，因此出度之和等于 $2i$。在任何树中，边的数量等于顶点的数量减1，因此边的数量为 $(i + l) - 1$。由于出度之和等于边的数量，我们有\n$$\n2i = (i + l) - 1 \\quad \\Longrightarrow \\quad l = i + 1.\n$$\n因此，顶点的总数是\n$$\nn = i + l = i + (i + 1) = 2i + 1.\n$$\n给定 $n = 9$，我们解得\n$$\n2i + 1 = 9 \\quad \\Longrightarrow \\quad i = 4.\n$$\n\n令 $F_{i}$ 表示具有 $i$ 个内部顶点的非同构有根满二叉树的数量。这样的树由一个根和两个孩子组成，其子树本身是满二叉树，对于某个 $j$，分别具有 $j$ 和 $i - 1 - j$ 个内部顶点。因此，$F_{i}$ 满足卡特兰递推关系，且 $F_{0} = 1$：\n$$\nF_{i} = \\sum_{j=0}^{i-1} F_{j} F_{i-1-j}.\n$$\n其唯一解是第 $i$ 个卡特兰数：\n$$\nF_{i} = C_{i} = \\frac{1}{i+1} \\binom{2i}{i}.\n$$\n对于 $i = 4$，\n$$\nC_{4} = \\frac{1}{5} \\binom{8}{4} = \\frac{1}{5} \\cdot 70 = 14.\n$$\n因此，恰好有9个顶点的非同构有根满二叉树的数量为14。", "answer": "$$\\boxed{14}$$", "id": "1483720"}, {"introduction": "树不仅仅是抽象的结构，它们也是在现实世界系统中为分层数据建模的强大工具。这个问题让你扮演系统设计者的角色，分析一个关键算法：寻找两个节点的最低公共祖先（LCA）。通过推导该算法所需的步骤数，你将练习如何将节点的深度等抽象的树属性与具体的性能分析联系起来，这是算法设计中的一项至关重要的技能。[@problem_id:1483709]", "problem": "在一个大规模分布式系统中，一个分层命名空间被建模为一个有根二叉树。树中的每个节点代表一个资源，并被分配一个唯一的标识符。为了执行某些一致性和权限检查，系统需要频繁地查找两个给定节点的最近公共祖先 (LCA)。$u$ 和 $v$ 两个节点的LCA被定义为同时以 $u$ 和 $v$ 为后代的最低（即最深）的节点。\n\n系统中每个节点的数据结构只提供一个与导航树结构相关的操作：`getParent()`，该操作返回父节点的标识符。根节点是唯一一个调用 `getParent()` 会返回特殊 `NULL` 值的节点。“深度”是指从根节点到该节点的路径上的边数，因此根节点的深度为0。\n\n设计了一个算法来查找两个不同节点 $u$ 和 $v$ 的LCA。该算法的操作如下，假设 $u$ 和 $v$ 的深度（分别表示为 $d_u$ 和 $d_v$）是预先计算好的并且无需成本即可获知：\n1.  将两个节点中较深的那个节点通过重复调用 `getParent()` 向上移动，直到它达到与较浅节点相同的深度。\n2.  一旦两个节点处于相同深度，就在每一步中同时对两个节点调用 `getParent()`。重复此过程，直到两个节点变为同一个节点。这个公共节点就是它们的LCA。\n\n设节点 $u$ 和 $v$ 的LCA位于深度 $d_{LCA}$ 处。推导该算法为找到LCA所进行的 `getParent()` 调用的总次数的简化表达式。用 $d_u$、$d_v$ 和 $d_{LCA}$ 来表示你的答案。", "solution": "设节点的深度为 $d_{u}$ 和 $d_{v}$，LCA的深度为 $d_{LCA}$。定义 $m=\\min(d_{u},d_{v})$ 和 $M=\\max(d_{u},d_{v})$。\n\n阶段1（深度对齐）：较深的节点向上移动了恰好 $M-m=|d_{u}-d_{v}|$ 条边，所以此阶段的调用次数为\n$$\n|d_{u}-d_{v}|.\n$$\n\n对齐后，两个节点都处于深度 $m$。阶段2（同时上升）：它们一起向上移动，直到达到深度 $d_{LCA}$。步数是 $m-d_{LCA}$，并且每一步进行两次调用（每个节点一次），所以此阶段的调用次数为\n$$\n2(m-d_{LCA}).\n$$\n\n因此，总调用次数为\n$$\n|d_{u}-d_{v}|+2(m-d_{LCA}).\n$$\n因为 $M-m=|d_{u}-d_{v}|$ 且 $M+m=d_{u}+d_{v}$，我们简化表达式：\n$$\n(M-m)+2m-2d_{LCA}=M+m-2d_{LCA}=d_{u}+d_{v}-2d_{LCA}.\n$$\n\n等价地，这等于 $u$ 和 $v$ 到它们的LCA的距离之和：$(d_{u}-d_{LCA})+(d_{v}-d_{LCA})=d_{u}+d_{v}-2d_{LCA}$。", "answer": "$$\\boxed{d_{u}+d_{v}-2d_{LCA}}$$", "id": "1483709"}]}