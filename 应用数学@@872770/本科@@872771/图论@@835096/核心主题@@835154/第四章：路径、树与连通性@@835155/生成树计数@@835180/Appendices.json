{"hands_on_practices": [{"introduction": "这第一个练习是一个热身。我们将从一个小的、具体的例子——四顶点的完全图 $K_4$ ——开始。这个练习将帮助你直观地理解什么是带标签的生成树，并通过将其分类为不同的结构类型来学习如何计数，同时也将让你接触到著名的凯莱公式 (Cayley's formula) [@problem_id:1492580]。", "problem": "在图论中，一个*图*由一个顶点集合和一个连接顶点对的边集合组成。顶点被认为是不同的且带有标签。一个具有 $n$ 个顶点的*完全图*，记作 $K_n$，是这样一个图，其中每对不同的顶点都由一条唯一的边连接。*树*是一个没有环的连通图。图 $G$ 的*生成树*是 $G$ 的一个子图，它是一棵树并包含 $G$ 的所有顶点。\n\n如果两个图 $G_1$ 和 $G_2$ 的顶点集之间存在一个保持邻接关系的一一对应，则它们是*同构*的。这意味着我们可以通过重新标记 $G_1$ 的顶点来得到 $G_2$。\n\n考虑一个有四个顶点的完全图 $K_4$。它的生成树可以根据其结构进行分类。在四个顶点上的两种重要的树结构是：\n1. *路径图* $P_4$，它有两个度为1的顶点和两个度为2的顶点。\n2. *星形图* $S_4$ (也称为 $K_{1,3}$)，它有一个度为3的中心顶点，连接到其他三个度为1的顶点。\n\n设 $N_P$ 是 $K_4$ 的与 $P_4$ 同构的不同生成树的数量。\n设 $N_S$ 是 $K_4$ 的与 $S_4$ 同构的不同生成树的数量。\n\n计算乘积 $N_P \\times N_S$。", "solution": "我们考虑 $K_{4}$ 的带标签的生成树。根据 Cayley 公式，在 $n$ 个带标签的顶点上，带标签的生成树的数量是 $n^{n-2}$。代入 $n=4$ 得到\n$$\n4^{4-2}=4^{2}=16,\n$$\n所以 $K_{4}$ 总共有 $16$ 棵带标签的生成树。\n\n一棵生成树要么与星形图 $S_{4}$ 同构，要么与路径图 $P_{4}$ 同构，因为在同构意义下，这是四个顶点上仅有的两种树结构。\n\n为了计算与 $S_{4}$ 同构的数量 $N_{S}$，我们选择唯一的度为 $3$ 的中心顶点。在 $4$ 个带标签的顶点中，有 $4$ 种选择中心顶点的方式，一旦中心顶点选定，边就确定了。因此\n$$\nN_{S}=4.\n$$\n\n为了计算与 $P_{4}$ 同构的数量 $N_{P}$，我们可以使用两种等价的论证方法。首先，由于每棵生成树要么是路径图，要么是星形图，\n$$\nN_{P}=16-N_{S}=16-4=12.\n$$\n或者，一个在 $4$ 个顶点上的带标签的路径图是由这 $4$ 个不同标签沿路径的排列顺序决定的，但需要除去反向排列的重复计数，得到\n$$\nN_{P}=\\frac{4!}{2}=12.\n$$\n\n因此，所求的乘积是\n$$\nN_{P}\\times N_{S}=12\\times 4=48.\n$$", "answer": "$$\\boxed{48}$$", "id": "1492580"}, {"introduction": "从稠密图转向稀疏图，这个问题探索了图结构的一个基本原理。通过从一棵树（它本身就是其唯一的生成树）开始，并添加一条边，我们创造了一个简单的环。这个练习揭示了生成树的数量与你刚刚创造的环的长度之间直接而优雅的关系 [@problem_id:1492624]。", "problem": "考虑一个建模为一棵有 $n$ 个顶点（其中 $n \\geq 3$）的树 $T$ 的网络。为了提高网络的弹性，在两个不同的节点 $u$ 和 $v$ 之间建立了一条冗余通信链路，这两个节点在原始树 $T$ 中不直接相邻。在树 $T$ 中，$u$ 和 $v$ 之间的唯一路径恰好由 $k$ 条边组成，其中 $k$ 是一个整数且 $k \\geq 2$。设 $G$ 是表示增强后网络的新图，它是由向 $T$ 中添加边 $(u, v)$ 形成的。$G$ 的一棵生成树对应于网络的一个最小的、完全连通的运行状态。求图 $G$ 中不同生成树的总数。", "solution": "设 $T$ 是一棵有 $n$ 个顶点的树，所以 $|E(T)|=n-1$。添加边 $(u,v)$，其中 $T$ 中唯一的 $u$–$v$ 路径恰有 $k$ 条边，且 $k\\geq 2$。设 $G$ 是得到的图。那么 $|E(G)|=n$，且 $G$ 恰好有一个圈，即\n$$\nC = \\text{(the $u$–$v$ path in $T$)} \\cup \\{(u,v)\\},\n$$\n该圈包含来自路径的 $k$ 条边以及添加的边，因此 $|C|=k+1$。\n\n一棵有 $n$ 个顶点的生成树恰有 $n-1$ 条边。由于 $G$ 有 $n$ 条边，$G$ 的任意一棵生成树都必须通过从 $G$ 中删除恰好一条边得到。为了使得到的子图保持连通（即，成为一棵树），被删除的边必须位于一个圈上；删除桥会使图断开。\n\n在 $G$ 中，唯一的圈是 $C$。不在 $C$ 中的每一条边都是一个桥：如果 $e\\notin C$，那么 $e$ 位于 $T$ 中 $u$–$v$ 路径之外，所以移除 $e$ 会将 $T$ 分割成两个连通分量 $A$ 和 $B$。添加的边 $(u,v)$ 完全位于包含 $u$–$v$ 路径的那个连通分量内，因此不会重新连接 $A$ 和 $B$。因此 $e$ 在 $G$ 中也是一个桥，删除 $e$ 不能得到一棵生成树。\n\n反之，从 $C$ 中删除任意一条边都会打破唯一的圈，并留下一个有 $n-1$ 条边的连通图，因此它是一棵生成树。恰好有 $|C|=k+1$ 种这样的选择（$u$–$v$ 路径上的 $k$ 条边和添加的边 $(u,v)$），且每次删除都会得到一棵不同的生成树。\n\n因此，$G$ 的不同生成树的总数是\n$$\nk+1.\n$$", "answer": "$$\\boxed{k+1}$$", "id": "1492624"}, {"introduction": "我们的最后一个练习介绍了一种强大而通用的生成树计数技术：删除-收缩原理 (deletion-contraction principle)。我们将解决一个更具挑战性的问题：计算在一个完全图中移除一条边后剩余的生成树数量。这个练习展示了如何通过将一个复杂的计数问题分解为两个更简单、相关的子问题来解决它，为你提供一个适用于各种图的工具 [@problem_id:1492636]。", "problem": "考虑一个由$n$台计算机服务器组成的网络，初始时，每台服务器都通过一条直接且唯一的通信链路与其他所有服务器相连。这种配置对应于一个有$n$个节点的完全网络。一个“生成子网络”是指保持所有服务器连通的最小链路集合，这意味着任意两台服务器之间都存在一条路径，但从该集合中移除任何一条链路都会使网络断开成两个或多个连通分量。由于故障，两台不同服务器之间的一条特定通信链路被永久切断。对于一个有$n$台服务器的网络（其中 $n \\ge 3$），请确定使用剩余可用链路可以形成多少个不同的生成子网络。请将你的答案表示为$n$的函数。", "solution": "我们用图论的语言来描述这个问题。这个由$n$台服务器组成的初始网络，其中每台服务器都与其他所有服务器相连，是一个有$n$个顶点的完全图$K_n$。所描述的“生成子网络”是图的一棵生成树。题目指出一条链路被切断，这对应于从$K_n$中移除一条边，我们称之为$e$。我们需要求出所得图 $G = K_n - e$ 的生成树数量。记 $\\tau(H)$ 为图 $H$ 的生成树数量。我们想计算 $\\tau(K_n - e)$。\n\n在一个有$n$个标记顶点的集合上，总的生成树数量就是完全图$K_n$的生成树数量。根据Cayley公式，这个数量是：\n$$ \\tau(K_n) = n^{n-2} $$\n\n$K_n$的所有生成树可以被划分为两个不相交的集合：\n1. 不包含边$e$的$K_n$的生成树集合。\n2. 包含边$e$的$K_n$的生成树集合。\n\n第一个集合中生成树的数量恰好是 $\\tau(K_n - e)$，也就是我们要求解的量。我们将第二个集合中生成树的数量记为 $\\tau_e(K_n)$。于是，我们有以下关系：\n$$ \\tau(K_n) = \\tau(K_n - e) + \\tau_e(K_n) $$\n整理可得：\n$$ \\tau(K_n - e) = \\tau(K_n) - \\tau_e(K_n) = n^{n-2} - \\tau_e(K_n) $$\n因此，我们的任务简化为求出$K_n$中包含特定边$e$的生成树数量。\n\n图论中一个已知的结论是：图$H$中包含特定边$e$的生成树数量，等于通过收缩边$e$形成的图$H/e$的生成树数量。因此，\n$$ \\tau_e(K_n) = \\tau(K_n/e) $$\n设要收缩的边为$e=(u,v)$。图$K_n/e$有$n-1$个顶点。其中一个顶点，我们称之为$w$，是由$u$和$v$合并而成的。另外$n-2$个顶点是$K_n$中除$u$和$v$之外的原始顶点。\n\n我们来分析多重图$K_n/e$的结构：\n- 这$n-2$个顶点（未参与收缩）彼此之间都相连，形成一个完全图$K_{n-2}$。\n- 对于这$n-2$个顶点集合中的任意顶点$x$，它在$K_n$中原本与$u$和$v$都相连。收缩后，这两条边$(x,u)$和$(x,v)$变成了$x$与新顶点$w$之间的两条平行边。\n\n因此，$K_n/e$是一个有$n-1$个顶点的多重图。我们可以使用同样适用于多重图的矩阵树定理来求其生成树的数量。我们为$K_n/e$构建拉普拉斯矩阵$L$。设顶点索引为$v_1, \\dots, v_{n-2}$，收缩后的顶点为$v_{n-1} = w$。\n\n对于$i \\in \\{1, \\dots, n-2\\}$，顶点$v_i$的度为：它与另外$n-3$个顶点（在$K_{n-2}$子图中）各有一条边，并与$w$有两条平行边。所以，$\\deg(v_i) = (n-3) + 2 = n-1$。\n顶点$w$的度为：它与另外$n-2$个顶点中的每一个都有两条平行边。所以，$\\deg(w) = 2(n-2)$。\n\n大小为$(n-1) \\times (n-1)$的拉普拉斯矩阵$L$定义为$L = D - A$，其中$D$是顶点度数构成的对角矩阵，$A$是邻接矩阵。对于多重图，$A_{ij}$是顶点$i$和$j$之间的边数。\n- 对角线元素：当$i=1, \\dots, n-2$时，$L_{ii} = \\deg(v_i) = n-1$。$L_{n-1, n-1} = \\deg(w) = 2(n-2)$。\n- 非对角线元素：当$i,j \\in \\{1, \\dots, n-2\\}$且$i \\neq j$时，$L_{ij} = -1$。当$i \\in \\{1, \\dots, n-2\\}$时，$L_{i, n-1} = -2$（因为有两条平行边）。\n\n生成树的数量$\\tau(K_n/e)$是$L$的任意一个代数余子式。最方便的计算方法是求对应于顶点$w$的代数余子式，即通过移除$L$的最后一行和最后一列。我们将得到的$(n-2) \\times (n-2)$矩阵称为$L^*$。\n$$ L^*_{ij} = \\begin{cases} n-1  \\text{if } i=j \\\\ -1  \\text{if } i \\neq j \\end{cases} \\quad \\text{for } i,j \\in \\{1, \\dots, n-2\\} $$\n该矩阵可以写成 $L^* = (n-1)I - (J-I) = nI - J$，其中$I$是$(n-2) \\times (n-2)$的单位矩阵，$J$是$(n-2) \\times (n-2)$的全一矩阵。\n\n一个大小为$m \\times m$、形式为$aI+bJ$的矩阵的行列式是$(a+mb)a^{m-1}$。这里，我们的矩阵是$nI - J$，所以$a=n, b=-1, m=n-2$。行列式为：\n$$ \\det(L^*) = (n - (n-2))n^{(n-2)-1} = 2n^{n-3} $$\n因此，包含边$e$的生成树数量为：\n$$ \\tau_e(K_n) = \\tau(K_n/e) = \\det(L^*) = 2n^{n-3} $$\n\n最后，我们可以计算出$K_n-e$中生成树的数量：\n$$ \\tau(K_n - e) = n^{n-2} - \\tau_e(K_n) = n^{n-2} - 2n^{n-3} $$\n提取公因式$n^{n-3}$，我们得到：\n$$ \\tau(K_n - e) = n^{n-3}(n-2) $$\n这就是在一条链路被切断后，可能形成的不同的生成子网络的总数。", "answer": "$$\\boxed{(n-2)n^{n-3}}$$", "id": "1492636"}]}