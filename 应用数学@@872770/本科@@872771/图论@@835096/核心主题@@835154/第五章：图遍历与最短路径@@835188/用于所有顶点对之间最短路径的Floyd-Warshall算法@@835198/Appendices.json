{"hands_on_practices": [{"introduction": "这项实践旨在让你具体感受 Floyd-Warshall 算法的迭代过程。通过在一个小型加权有向图上手动追踪算法的前几个步骤，你将直接应用其核心更新规则，并观察算法如何通过引入中间顶点来系统地发现更短的路径。这个基础练习对于建立对算法工作机制的直观理解至关重要。[@problem_id:1504965]", "problem": "考虑一个有4个顶点的加权有向图，顶点标记为1、2、3和4。任意两个顶点之间直接路径的成本由一个初始距离矩阵 $D^{(0)}$ 给出。在该矩阵中，元素 $D^{(0)}_{ij}$ 表示从顶点 $i$ 到顶点 $j$ 的有向边的权重。如果从 $i$ 到 $j$ 不存在直接边，则权重被视为无穷大（$\\infty$）。对于所有顶点，其自身距离 $D^{(0)}_{ii}$ 为0。\n\n初始距离矩阵 $D^{(0)}$ 如下：\n$$ D^{(0)} = \\begin{pmatrix} 0   4  \\infty  7 \\\\ \\infty  0  1  \\infty \\\\ 6  \\infty  0  2 \\\\ 3  -2  \\infty  0 \\end{pmatrix} $$\n\nFloyd-Warshall算法通过迭代更新此矩阵来计算所有顶点对之间的最短路径。在第 $k$ 次迭代中（其中 $k=1, 2, \\dots, 4$），算法考虑使用顶点 $k$ 作为中间顶点的路径，以期找到任意两个顶点 $i$ 和 $j$ 之间可能存在的更短路径。\n\n从给定的矩阵 $D^{(0)}$ 开始，执行Floyd-Warshall算法的前两次迭代，以计算矩阵 $D^{(1)}$（使用 $k=1$）和 $D^{(2)}$（使用 $k=2$）。你的任务是确定第二次迭代后距离矩阵的最终状态 $D^{(2)}$。", "solution": "我们使用Floyd-Warshall更新规则：对于每次迭代 $k$ 以及所有的 $i,j$，\n$$\nD^{(k)}_{ij}=\\min\\left(D^{(k-1)}_{ij},\\,D^{(k-1)}_{ik}+D^{(k-1)}_{kj}\\right).\n$$\n给定\n$$\nD^{(0)}=\\begin{pmatrix}\n0   4  \\infty  7\\\\\n\\infty  0  1  \\infty\\\\\n6  \\infty  0  2\\\\\n3  -2  \\infty  0\n\\end{pmatrix},\n$$\n我们进行第一次迭代，令 $k=1$，使用 $D^{(1)}_{ij}=\\min\\left(D^{(0)}_{ij},\\,D^{(0)}_{i1}+D^{(0)}_{1j}\\right)$。\n\n对于 $i=1$：\n- $j=1$：$\\min(0,\\,0+0)=0$。\n- $j=2$：$\\min(4,\\,0+4)=4$。\n- $j=3$：$\\min(\\infty,\\,0+\\infty)=\\infty$。\n- $j=4$：$\\min(7,\\,0+7)=7$。\n\n对于 $i=2$（因为 $D^{(0)}_{21}=\\infty$，所有经过顶点1的路径长度均为 $\\infty$）：\n- $j=1$：$\\min(\\infty,\\,\\infty)=\\infty$。\n- $j=2$：$\\min(0,\\,\\infty)=0$。\n- $j=3$：$\\min(1,\\,\\infty)=1$。\n- $j=4$：$\\min(\\infty,\\,\\infty)=\\infty$。\n\n对于 $i=3$（其中 $D^{(0)}_{31}=6$）：\n- $j=1$：$\\min(6,\\,6+0)=6$。\n- $j=2$：$\\min(\\infty,\\,6+4)=10$。\n- $j=3$：$\\min(0,\\,6+\\infty)=0$。\n- $j=4$：$\\min(2,\\,6+7)=2$。\n\n对于 $i=4$（其中 $D^{(0)}_{41}=3$）：\n- $j=1$：$\\min(3,\\,3+0)=3$。\n- $j=2$：$\\min(-2,\\,3+4)=-2$。\n- $j=3$：$\\min(\\infty,\\,3+\\infty)=\\infty$。\n- $j=4$：$\\min(0,\\,3+7)=0$。\n\n因此\n$$\nD^{(1)}=\\begin{pmatrix}\n0   4  \\infty  7\\\\\n\\infty  0  1  \\infty\\\\\n6  10  0  2\\\\\n3  -2  \\infty  0\n\\end{pmatrix}.\n$$\n\n接下来，进行第二次迭代，令 $k=2$，使用 $D^{(2)}_{ij}=\\min\\left(D^{(1)}_{ij},\\,D^{(1)}_{i2}+D^{(1)}_{2j}\\right)$。\n\n对于 $i=1$（其中 $D^{(1)}_{12}=4$）：\n- $j=1$：$\\min(0,\\,4+\\infty)=0$。\n- $j=2$：$\\min(4,\\,4+0)=4$。\n- $j=3$：$\\min(\\infty,\\,4+1)=5$。\n- $j=4$：$\\min(7,\\,4+\\infty)=7$。\n\n对于 $i=2$（其中 $D^{(1)}_{22}=0$）：\n- $j=1$：$\\min(\\infty,\\,0+\\infty)=\\infty$。\n- $j=2$：$\\min(0,\\,0+0)=0$。\n- $j=3$：$\\min(1,\\,0+1)=1$。\n- $j=4$：$\\min(\\infty,\\,0+\\infty)=\\infty$。\n\n对于 $i=3$（其中 $D^{(1)}_{32}=10$）：\n- $j=1$：$\\min(6,\\,10+\\infty)=6$。\n- $j=2$：$\\min(10,\\,10+0)=10$。\n- $j=3$：$\\min(0,\\,10+1)=0$。\n- $j=4$：$\\min(2,\\,10+\\infty)=2$。\n\n对于 $i=4$（其中 $D^{(1)}_{42}=-2$）：\n- $j=1$：$\\min(3,\\, -2+\\infty)=3$。\n- $j=2$：$\\min(-2,\\, -2+0)=-2$。\n- $j=3$：$\\min(\\infty,\\, -2+1)=-1$。\n- $j=4$：$\\min(0,\\, -2+\\infty)=0$。\n\n因此，第二次迭代后的矩阵为\n$$\nD^{(2)}=\\begin{pmatrix}\n0   4  5  7\\\\\n\\infty  0  1  \\infty\\\\\n6  10  0  2\\\\\n3  -2  -1  0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0  4  5  7 \\\\ \\infty  0  1  \\infty \\\\ 6  10  0  2 \\\\ 3  -2  -1  0\\end{pmatrix}}$$", "id": "1504965"}, {"introduction": "在掌握了基本计算过程之后，让我们来探讨该算法在特殊图结构下的行为。这个问题提出了一个思想实验：如果图中存在一个孤立顶点，情况会怎样？通过分析这个边界情况，你可以加深对图的拓扑结构如何编码在距离矩阵中的理解，并巩固像 $0$ 和 $\\infty$ 这些数值在算法中的概念意义。[@problem_id:1504983]", "problem": "考虑一个加权有向图 $G = (V, E)$，它有一组 $n$ 个顶点 $V = \\{v_1, v_2, \\dots, v_n\\}$，其边权重可为正或负，但没有负权重环。如果图中没有任何从其他顶点到 $v_i$ 的入边，也没有任何从 $v_i$ 到其他顶点的出边，则顶点 $v_i$ 被定义为**孤立的**。\n\nFloyd-Warshall 算法用于计算所有点对之间的最短路径。该算法按如下方式初始化一个距离矩阵 $D^{(0)}$：\n-   对于所有 $j = k$，$D^{(0)}_{j,k} = 0$。\n-   如果存在一条从 $v_j$ 到 $v_k$ 的有向边，其权重为 $w(v_j, v_k)$，则 $D^{(0)}_{j,k} = w(v_j, v_k)$。\n-   如果 $j \\neq k$ 且不存在从 $v_j$ 到 $v_k$ 的直接边，则 $D^{(0)}_{j,k} = \\infty$。\n\n然后，该算法迭代地优化此矩阵，生成一个最终的距离矩阵 $D^{(n)}$，其中 $D^{(n)}_{j,k}$ 是从顶点 $v_j$ 到顶点 $v_k$ 的最短路径的长度。\n\n假设图中的一个特定顶点 $v_i$ 是孤立的。以下哪个陈述准确地描述了最终距离矩阵 $D^{(n)}$ 的第 $i$ 行和第 $i$ 列？\n\nA. 第 $i$ 行和第 $i$ 列的所有条目都将填充为 $\\infty$，但对角线元素 $D^{(n)}_{i,i}$ 将为 0。\n\nB. 第 $i$ 行和第 $i$ 列将完全填充为 0。\n\nC. 第 $i$ 行和第 $i$ 列将完全填充为 $\\infty$，包括对角线元素 $D^{(n)}_{i,i}$。\n\nD. 第 $i$ 行将填充为 $\\infty$（除了 $D^{(n)}_{i,i} = 0$），但如果其他顶点的路径可以经过 $v_i$，则第 $i$ 列可能包含有限值。\n\nE. 第 $i$ 行和第 $i$ 列的内容取决于算法主循环中顶点的具体处理顺序。", "solution": "设 $G=(V,E)$ 是一个没有负权重环的加权有向图，且 $v_{i}$ 是孤立的，这意味着对于所有 $j \\neq i$，不存在边 $(v_{i},v_{j})$ 和边 $(v_{j},v_{i})$。\n\nFloyd-Warshall 算法维护矩阵 $D^{(r)}$，其中 $r=0,1,\\dots,n$，$D^{(0)}$ 初始化如下：\n- 若 $j=k$, 则 $D^{(0)}_{j,k}=0$,\n- 若 $(v_{j},v_{k}) \\in E$, 则 $D^{(0)}_{j,k}=w(v_{j},v_{k})$,\n- 否则 $D^{(0)}_{j,k}=\\infty$。\n\n对于 $r=1,2,\\dots,n$ 的更新规则是\n$$\nD^{(r)}_{p,q}=\\min\\!\\big(D^{(r-1)}_{p,q},\\,D^{(r-1)}_{p,r}+D^{(r-1)}_{r,q}\\big).\n$$\n\n因为 $v_{i}$ 是孤立的，所以 $D^{(0)}$ 的第 $i$ 行和第 $i$ 列的初始化为\n$$\nD^{(0)}_{i,i}=0,\\quad D^{(0)}_{i,j}=\\infty\\ \\text{for}\\ j\\neq i,\\quad D^{(0)}_{j,i}=\\infty\\ \\text{for}\\ j\\neq i.\n$$\n\n我们对 $r$ 使用数学归纳法证明，对于所有 $r=0,1,\\dots,n$，\n$$\nD^{(r)}_{i,i}=0,\\qquad D^{(r)}_{i,j}=\\infty\\ \\text{for all}\\ j\\neq i,\\qquad D^{(r)}_{j,i}=\\infty\\ \\text{for all}\\ j\\neq i.\n$$\n\n根据初始化，$r=0$ 的基本情况成立。假设该陈述对于某个 $r-1\\geq 0$ 成立。固定 $j\\neq i$。那么\n$$\nD^{(r)}_{i,j}=\\min\\!\\big(D^{(r-1)}_{i,j},\\,D^{(r-1)}_{i,r}+D^{(r-1)}_{r,j}\\big).\n$$\n根据归纳假设，$D^{(r-1)}_{i,j}=\\infty$。如果 $r\\neq i$，那么 $D^{(r-1)}_{i,r}=\\infty$，所以 $D^{(r-1)}_{i,r}+D^{(r-1)}_{r,j}=\\infty$。如果 $r=i$，那么 $D^{(r-1)}_{i,i}=0$ 且 $D^{(r-1)}_{i,j}=\\infty$，因此 $D^{(r-1)}_{i,i}+D^{(r-1)}_{i,j}=\\infty$。在两种情况下，都有 $D^{(r)}_{i,j}=\\min(\\infty,\\infty)=\\infty$。\n\n类似地，\n$$\nD^{(r)}_{j,i}=\\min\\!\\big(D^{(r-1)}_{j,i},\\,D^{(r-1)}_{j,r}+D^{(r-1)}_{r,i}\\big).\n$$\n根据归纳假设，$D^{(r-1)}_{j,i}=\\infty$。如果 $r\\neq i$，那么 $D^{(r-1)}_{r,i}=\\infty$，所以和为 $\\infty$。如果 $r=i$，那么 $D^{(r-1)}_{i,i}=0$ 且 $D^{(r-1)}_{j,i}=\\infty$，所以和为 $\\infty$。因此 $D^{(r)}_{j,i}=\\infty$。\n\n对于对角线元素，\n$$\nD^{(r)}_{i,i}=\\min\\!\\big(D^{(r-1)}_{i,i},\\,D^{(r-1)}_{i,r}+D^{(r-1)}_{r,i}\\big).\n$$\n如果 $r\\neq i$，那么根据归纳假设，$D^{(r-1)}_{i,r}=\\infty$ 或 $D^{(r-1)}_{r,i}=\\infty$，所以和为 $\\infty$ 且 $D^{(r)}_{i,i}=\\min(D^{(r-1)}_{i,i},\\infty)=D^{(r-1)}_{i,i}$。如果 $r=i$，那么 $D^{(r-1)}_{i,i}=0$，所以 $D^{(r)}_{i,i}=\\min(0,0+0)=0$。因此对于所有的 $r$，$D^{(r)}_{i,i}=0$。\n\n因此，在最终矩阵 $D^{(n)}$ 中，第 $i$ 行和第 $i$ 列在所有非对角线位置上的值均为 $\\infty$，对角线上的值为 $0$，这与选项 A 相符。不会出现处理顺序的依赖性，并且由于不存在出入边，因此通过 $v_{i}$ 的路径不可能出现有限值。", "answer": "$$\\boxed{A}$$", "id": "1504983"}, {"introduction": "最后一项实践将挑战你超越简单的算法执行，去思考最短路径更深层次的性质。它探究了一个常见的“假设”场景：如果我们为每条边增加一个固定的正权重 $c$，最短路径会如何变化？这个问题揭示了最短路径在这样的变换下并非总是不变的，从而促使我们对“最短”的真正含义及其与路径边数的关系有更细致的理解。[@problem_id:1504949]", "problem": "考虑一个带权有向图 $G = (V, E)$，其边的权重函数为 $w: E \\to \\mathbb{R}$。该图没有负权重环路。该图的所有顶点对之间的最短路径距离矩阵包含所有顶点对 $(u, v) \\in V \\times V$ 的条目 $d(u, v)$，表示从 $u$ 到 $v$ 的路径上边权重之和的最小值。\n\n现在，我们在相同的顶点集和边集上构造一个新图 $G'$，但使用新的权重函数 $w'$。对于一个给定的正常数 $c  0$，每条边的新权重定义为 $w'(u, v) = w(u, v) + c$。令 $d'(u, v)$ 为这个新图 $G'$ 中从 $u$ 到 $v$ 的最短路径距离。\n\n此外，我们定义 $d_k(u, v)$ 为在原始图 $G$ 中，从顶点 $u$ 到顶点 $v$ 的恰好包含 $k$ 条边的最短路径的权重。如果在 $u$ 和 $v$ 之间不存在恰好有 $k$ 条边的路径，我们认为 $d_k(u, v)$ 是无穷大。\n\n下列哪个表达式正确地将新的最短路径距离 $d'(u, v)$ 与原始图 $G$ 的属性联系起来？\n\nA. $d'(u, v) = d(u, v) + c$\n\nB. $d'(u, v) = d(u, v) \\cdot (1 + c)$\n\nC. $d'(u, v) = d(u, v) + k_{uv} \\cdot c$，其中 $k_{uv}$ 是原始图 $G$ 中从 $u$ 到 $v$ 的一条最短路径上的边数。\n\nD. $G'$ 中的最短路径集合与 $G$ 中的相同，只是它们的总权重增加了。\n\nE. $d'(u, v) = \\min_{k \\ge 1} \\{ d_k(u,v) + k \\cdot c \\}$", "solution": "设 $P$ 是 $G$ 中从 $u$ 到 $v$ 的任意一条恰好使用 $k$ 条边 $e_{1},\\dots,e_{k}$ 的有向路径。它在 $G$ 中的总权重为\n$$\nw(P)=\\sum_{i=1}^{k} w(e_{i}).\n$$\n在 $G'$ 中，每条边的权重都增加了 $c0$，因此同一路径 $P$ 在 $G'$ 中的总权重为\n$$\nw'(P)=\\sum_{i=1}^{k} \\big(w(e_{i})+c\\big)=\\sum_{i=1}^{k} w(e_{i})+kc=w(P)+kc.\n$$\n\n根据定义，$G'$ 中的最短路径距离为\n$$\nd'(u,v)=\\min_{P:u\\to v} w'(P)=\\min_{P:u\\to v} \\big(w(P)+k(P)\\,c\\big),\n$$\n其中 $k(P)$ 表示 $P$ 上的边数。按路径的边数 $k$ 对路径进行分组，并使用 $d_{k}(u,v)$ 作为包含 $k$ 条边的 $u\\to v$ 路径中的最小权重（如果不存在则 $d_{k}(u,v)=\\infty$），我们得到\n$$\nd'(u,v)=\\min_{k\\ge 1}\\left(\\min_{P:u\\to v,\\ |P|=k} w(P)+k\\,c\\right)=\\min_{k\\ge 1}\\big(d_{k}(u,v)+k\\,c\\big).\n$$\n这就证明了选项 E。\n\n我们现在评估其他选项：\n\n- A: $d'(u,v)=d(u,v)+c$ 会忽略对边数的依赖；因为每条边都会产生一个额外的 $c$，增量取决于 $k$，所以 A 通常是错误的。\n\n- B: $d'(u,v)=d(u,v)\\cdot(1+c)$ 是一个乘法缩放，而变换是每条边加法性的；因此 B 是错误的。\n\n- C: $d'(u,v)=d(u,v)+k_{uv}\\,c$，其中 $k_{uv}$ 是 $G$ 中一条 $u\\to v$ 最短路径的边数，这可能会失败，因为每条边加上 $c$ 后，一条具有不同边数的不同路径可能会成为最优路径；因此 C 通常是错误的。\n\n- D: 最短路径的集合不一定保持不变，因为每条边加上 $c$ 会偏好边数较少的路径；因此 D 通常是错误的。\n\n因此，只有 E 正确地描述了 $d'(u,v)$。", "answer": "$$\\boxed{E}$$", "id": "1504949"}]}