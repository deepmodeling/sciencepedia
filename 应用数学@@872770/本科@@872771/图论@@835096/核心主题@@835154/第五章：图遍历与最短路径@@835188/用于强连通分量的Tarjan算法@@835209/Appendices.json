{"hands_on_practices": [{"introduction": "本练习是理解Tarjan算法内部机制的基础。通过在一个简单的有向环上追踪算法的执行过程[@problem_id:1537554]，我们将亲眼看到“发现时间”($\\text{disc}$)和“低链接值”($\\text{low}$)这两个核心变量是如何被计算和更新的。掌握它们在环结构中的行为是理解算法如何识别任何强连通分量的关键。", "problem": "考虑一个有向图 $G = (V, E)$，它由一个长度为 $n$ 的简单环构成，其中 $n \\ge 2$。顶点集为 $V = \\{v_0, v_1, \\ldots, v_{n-1}\\}$。边集为 $E = \\{(v_i, v_{(i+1) \\pmod{n}}) \\mid i = 0, 1, \\ldots, n-1\\}$。\n\n我们对该图应用 Tarjan 算法来寻找强连通分量 (SCCs)。该算法从顶点 $v_0$ 开始启动一次深度优先搜索 (DFS)。在遍历过程中，算法会为每个顶点 $v$ 维护和计算两个值：\n\n1.  一个**发现时间**，记为 $\\text{disc}[v]$。这是一个从 0 开始的全局计数器的整数值。当一个顶点 $v$ 首次被访问时，$\\text{disc}[v]$ 被设置为计数器的当前值，然后计数器递增。\n2.  一个**低链接值**，记为 $\\text{low}[v]$。该值被初始化为 $\\text{low}[v] = \\text{disc}[v]$。顶点 $u$ 的低链接值随后通过取其当前 $\\text{low}[u]$ 值与它在 DFS 树中后继节点的 `low` 值的最小值来更新。此外，如果一条边 $(u, w)$ 指向一个已被访问过且当前位于 DFS 递归栈上的顶点 $w$，则 $\\text{low}[u]$ 通过取其当前值与 $\\text{disc}[w]$ 的最小值来更新。\n\n在算法完成从 $v_0$ 开始的遍历且所有递归调用都返回后，对于一个任意顶点 $v_i$（其中 $0 \\le i \\le n-1$），$\\text{disc}[v_i]$ 和 $\\text{low}[v_i]$ 的最终值是什么？\n\n请用关于 $i$ 的一对符号表达式来表示你的答案。第一个表达式应为 $\\text{disc}[v_i]$，第二个应为 $\\text{low}[v_i]$。", "solution": "我们分析 Tarjan 算法在一个为简单环 $v_{0} \\to v_{1} \\to \\cdots \\to v_{n-1} \\to v_{0}$ 的有向图上的执行过程，其中 DFS 从 $v_{0}$ 开始。用于发现时间的全局计数器从 0 开始，当一个顶点首次被访问时，它被赋予计数器的当前值，然后计数器递增。\n\n首先，由于每个顶点只有唯一的出边，DFS 的顺序是固定的：从 $v_{0}$ 开始，算法访问 $v_{1}$，然后是 $v_{2}$，依此类推，直到 $v_{n-1}$。因此，发现时间是按顺序分配的：\n$$\n\\text{disc}[v_{0}] = 0,\\ \\text{disc}[v_{1}] = 1,\\ \\ldots,\\ \\text{disc}[v_{i}] = i,\\ \\ldots,\\ \\text{disc}[v_{n-1}] = n-1.\n$$\n因此，对于任意 $0 \\leq i \\leq n-1$ 的 $i$，\n$$\n\\text{disc}[v_{i}] = i.\n$$\n\n接下来，当一个顶点 $v$ 首次被访问时，低链接值被初始化为 $\\text{low}[v] = \\text{disc}[v]$。它们随后按如下方式更新：对于一条边 $(u, w)$，\n- 如果 $w$ 未被访问过，在递归访问 $w$ 之后，设置 $\\text{low}[u] = \\min(\\text{low}[u], \\text{low}[w])$；\n- 如果 $w$ 已被访问过且当前在 DFS 栈上，设置 $\\text{low}[u] = \\min(\\text{low}[u], \\text{disc}[w])$。\n\n当探索 $v_{n-1}$ 时，它的后继是 $v_{0}$，该顶点已经被访问过并且仍在递归栈上（因为还没有 SCC 被弹出）。根据第二条更新规则，\n$$\n\\text{low}[v_{n-1}] = \\min(\\text{low}[v_{n-1}], \\text{disc}[v_{0}]) = \\min(n-1, 0) = 0,\n$$\n这里用到了 $n \\geq 2$，所以 $n-1 \\geq 1$。\n\n现在在递归中返回到 $v_{n-2}$，它的树子节点是 $v_{n-1}$。应用第一条更新规则：\n$$\n\\text{low}[v_{n-2}] = \\min(\\text{low}[v_{n-2}], \\text{low}[v_{n-1}]) = \\min(n-2, 0) = 0.\n$$\n依此类推，对于从 $n-3$ 递减至 $0$ 的每个 $k$，\n$$\n\\text{low}[v_{k}] = \\min(\\text{low}[v_{k}], \\text{low}[v_{k+1}]) = \\min(k, 0) = 0.\n$$\n因此，对于每个 $0 \\leq i \\leq n-1$ 的 $i$，\n$$\n\\text{low}[v_{i}] = 0.\n$$\n\n结合两个结果，对于任意顶点 $v_{i}$，\n$$\n\\text{disc}[v_{i}] = i,\\quad \\text{low}[v_{i}] = 0.\n$$\n这些值与以下事实相符：所有顶点都属于同一个 SCC，其根是 $v_{0}$，且最小发现时间为 $0$。", "answer": "$$\\boxed{\\begin{pmatrix} i & 0 \\end{pmatrix}}$$", "id": "1537554"}, {"introduction": "在上一个练习的基础上，我们从追踪具体数值转向分析图的结构。这个问题引导我们思考强连通分量是如何形成的：通过向一条简单的有向路径添加一条“后向边”，我们就能创造出一个环[@problem_id:1537538]。这个练习将帮助我们概括和理解后向边如何将路径的一部分“折叠”成一个单一的强连通分量，并学会量化这种结构变化带来的影响。", "problem": "设一个有向图 $G_0 = (V, E_0)$ 由 $n$ 个顶点的集合 $V = \\{v_1, v_2, \\ldots, v_n\\}$ 和一个边的集合 $E_0 = \\{(v_k, v_{k+1}) \\mid 1 \\le k  n\\}$ 定义。该图构成一个简单的有向路径。\n\n通过向 $G_0$ 添加一条边 $e = (v_i, v_j)$ 来创建一个新图 $G = (V, E)$，其中索引 $i$ 和 $j$ 是满足条件 $1 \\le j  i \\le n$ 的整数。\n\n有向图的强连通分量 (SCC) 是一个极大子图，对于子图中的任意两个顶点 $u$ 和 $w$，都存在一条从 $u$ 到 $w$ 的有向路径和一条从 $w$ 到 $u$ 的有向路径。\n\n确定最终图 $G$ 中 SCC 的总数。用 $n$、$i$ 和 $j$ 的闭式表达式表示你的答案。", "solution": "原始图 $G_0$ 是一个有向路径，包含 $n$ 个强连通分量 (SCC)，每个顶点一个。\n\n添加边 $e = (v_i, v_j)$，其中 $1 \\le j  i \\le n$，创建了一个包含顶点 $\\{v_j, v_{j+1}, \\ldots, v_i\\}$ 的环路。这是因为原始图中存在路径 $v_j \\to \\ldots \\to v_i$，新边 $(v_i, v_j)$ 关闭了这个环。因此，这 $i - j + 1$ 个顶点合并成一个单一的 SCC。\n\n图中的其他顶点不受此合并影响：\n- 顶点 $\\{v_1, \\ldots, v_{j-1}\\}$ 位于环路之前，它们各自仍然是独立的 SCC。这部分有 $j-1$ 个 SCC。\n- 顶点 $\\{v_{i+1}, \\ldots, v_n\\}$ 位于环路之后，它们各自也仍然是独立的 SCC。这部分有 $n-i$ 个 SCC。\n\n因此，SCC 的总数为：\n$$ \\text{总数} = (j-1) + 1 + (n-i) = n - i + j $$", "answer": "$$\\boxed{n - i + j}$$", "id": "1537538"}, {"introduction": "现在，我们将应用所学知识来解决一个网络分析问题。本练习引入了“强桥”的概念[@problem_id:1359489]，即移除后会增加图中强连通分量数量的关键边。解决这个问题不仅需要我们能够识别出强连通分量，还需要我们对其内部结构和脆弱性进行推理，从而评估网络连接的稳健性。", "problem": "在网络可靠性与结构的研究中，我们可以分析有向图中的关键连接。一个有向图 $G = (V, E)$ 由一个顶点集合 $V$ 和一个有向边集合 $E$ 组成。有向图的一个强连通分量 (SCC) 是一个极大的顶点子集 $C \\subseteq V$，使得对于 $C$ 中的任意一对顶点 $u, v$，都存在从 $u$ 到 $v$ 的有向路径和从 $v$ 到 $u$ 的有向路径。\n\n我们将“强桥”定义为图 $E$ 中的一条边，移除该边会增加图中强连通分量的总数。\n\n考虑一个有向图 $G=(V, E)$，其顶点集为 $V = \\{1, 2, 3, 4, 5, 6, 7\\}$，边集 $E$ 如下所示：\n$E = \\{(1, 2), (2, 3), (3, 2), (3, 1), (4, 5), (5, 6), (6, 4), (2, 4), (5, 7), (1, 7)\\}$.\n\n确定图 $G$ 中强桥的总数。", "solution": "给定有向图 $G=(V,E)$，其中 $V=\\{1,2,3,4,5,6,7\\}$ 且\n$$\nE=\\{(1,2),(2,3),(3,2),(3,1),(4,5),(5,6),(6,4),(2,4),(5,7),(1,7)\\}.\n$$\n强桥是一条边，移除它会增加强连通分量 (SCC) 的总数。\n\n首先，确定 $G$ 的强连通分量。考虑由 $\\{1,2,3\\}$ 导出的子图，其边为 $(1,2),(2,3),(3,2),(3,1)$。我们有路径 $1\\to 2\\to 3\\to 1$，因此 $\\{1,2,3\\}$ 中的每个顶点都能到达其他任何顶点，所以 $\\{1,2,3\\}$ 是一个强连通分量。接下来，由 $\\{4,5,6\\}$ 导出的子图，其边为 $(4,5),(5,6),(6,4)$，构成一个有向 3-环，所以 $\\{4,5,6\\}$ 是一个强连通分量。顶点 $7$ 只有入边 $(5,7)$ 和 $(1,7)$，没有出边，所以 $\\{7\\}$ 是一个强连通分量。因此，$G$ 的强连通分量是\n$$\nC_{1}=\\{1,2,3\\},\\quad C_{2}=\\{4,5,6\\},\\quad C_{3}=\\{7\\},\n$$\n所以初始的强连通分量数量为 3。\n\n如果移除一条边会增加这个数量，那么这条边就是强桥。不同强连通分量之间的边不可能位于收缩图的任何有向环上，因此不会影响任何强连通分量内部的强连通性。这里的强连通分量之间的边是从 $C_{1}$ 到 $C_{2}$ 的 $(2,4)$，以及进入 $C_{3}$ 的 $(5,7)$ 和 $(1,7)$。移除 $(2,4)$、$(5,7)$ 或 $(1,7)$ 中任何一条边都不会改变任何强连通分量，所以它们都不是强桥。\n\n现在测试 $C_{1}$ 内部的边：\n- 移除 $(1,2)$。则 $1$ 没有路径到达 $2$ 或 $3$（从 $1$ 出发的唯一内部边是 $(1,2)$，而使用 $(1,7)$ 无法返回到 $\\{1,2,3\\}$），而 $3\\to 1$ 和 $2\\leftrightarrow 3$ 仍然成立。因此 $\\{1\\}$ 和 $\\{2,3\\}$ 成为不同的强连通分量；强连通分量的数量从 3 增加到 4。所以 $(1,2)$ 是一个强桥。\n- 移除 $(2,3)$。则 $2$ 没有路径到达 $1$ 或 $3$（只有外部边 $(2,4)$ 存在且无法返回），$1$ 可以到达 $2$ 但无法返回，而 $3$ 可以到达 $1$ 和 $2$ 但两者都无法到达 $3$。因此 $\\{1\\},\\{2\\},\\{3\\}$ 成为三个强连通分量；强连通分量的数量增加到 5。所以 $(2,3)$ 是一个强桥。\n- 移除 $(3,2)$。剩余的内部边形成有向 3-环 $1\\to 2\\to 3\\to 1$，所以 $\\{1,2,3\\}$ 仍然是一个强连通分量；强连通分量的数量保持为 3。所以 $(3,2)$ 不是强桥。\n- 移除 $(3,1)$。则 $2\\leftrightarrow 3$ 仍然成立，但 $2$ 和 $3$ 都无法到达 $1$，而 $1$ 可以到达 $2$ 和 $3$。因此 $\\{1\\}$ 和 $\\{2,3\\}$ 成为不同的强连通分量；强连通分量的数量增加到 4。所以 $(3,1)$ 是一个强桥。\n\n现在测试 $C_{2}$ 内部的边：\n$(4,5)$、$(5,6)$ 和 $(6,4)$ 中的每一条边都位于有向 3-环 $4\\to 5\\to 6\\to 4$ 上。移除其中任意一条边会破坏 $\\{4,5,6\\}$ 上子图中的所有有向环，使得这三个顶点构成一个有向无环图。在这种情况下，$\\{4,5,6\\}$ 中任意两个顶点都不再相互可达，所以 $\\{4\\},\\{5\\},\\{6\\}$ 成为三个强连通分量。因此，强连通分量的总数从 3 增加到 5，所以 $(4,5)$、$(5,6)$ 和 $(6,4)$ 都是强桥。\n\n将所有强桥汇总，我们有 $(1,2)$、$(2,3)$、$(3,1)$、$(4,5)$、$(5,6)$ 和 $(6,4)$，总共有 6 个强桥。", "answer": "$$\\boxed{6}$$", "id": "1359489"}]}