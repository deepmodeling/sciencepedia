{"hands_on_practices": [{"introduction": "有向无环图（DAG）最核心的特性是“无环”。在项目管理、软件编译或任务调度等现实场景中，依赖关系中的环路意味着逻辑矛盾或死锁，导致任务无法完成。本练习将帮助你将一组依赖关系转化为图模型，并检验其是否满足这一关键的无环特性。[@problem_id:1496996]", "problem": "一家软件公司的项目经理正在为一个新的基于微服务的应用程序规划构建流程。该应用程序由六个不同的模块组成：`Auth`、`Billing`、`Catalog`、`Delivery`、`Frontend` 和 `Orders`。该构建流程受一组依赖关系的约束，其中一个模块必须在另一个模块的构建开始之前成功构建。\n\n这些依赖关系以一组有序对 `(U, V)` 的形式给出，表示模块 `U` 必须在模块 `V` 的构建开始之前成功构建。\n\n该项目的完整依赖关系集合 `D` 为：\n`D = {(Frontend, Auth), (Auth, Orders), (Orders, Billing), (Catalog, Frontend), (Billing, Auth), (Orders, Delivery)}`\n\n分析这组依赖关系，以确定项目构建流程的结构特性。以下哪个陈述准确地描述了这种情况？\n\nA. 依赖关系有效，一个可能的构建顺序是：`Catalog, Frontend, Auth, Orders, Billing, Delivery`。\n\nB. 依赖关系有效，一个可能的构建顺序是：`Catalog, Frontend, Auth, Orders, Delivery, Billing`。\n\nC. 依赖关系包含逻辑矛盾，具体来说，形成了一个长度为3的环。\n\nD. 依赖关系包含逻辑矛盾，具体来说，形成了一个长度为4的环。\n\nE. 依赖关系集合有效，但存在多种不同的构建顺序。", "solution": "定义有向图 $G=(V,E)$，其中 $V=\\{\\text{Auth}, \\text{Billing}, \\text{Catalog}, \\text{Delivery}, \\text{Frontend}, \\text{Orders}\\}$ 且 $E=D=\\{(\\text{Frontend}, \\text{Auth}), (\\text{Auth}, \\text{Orders}), (\\text{Orders}, \\text{Billing}), (\\text{Catalog}, \\text{Frontend}), (\\text{Billing}, \\text{Auth}), (\\text{Orders}, \\text{Delivery})\\}$。一个有效的构建顺序存在，当且仅当 $G$ 是一个有向无环图；等价地，当且仅当不存在有向环，在这种情况下存在拓扑排序。\n\n从 $E$ 中，观察这三条边\n$$(\\text{Auth}, \\text{Orders}),\\quad (\\text{Orders}, \\text{Billing}),\\quad (\\text{Billing}, \\text{Auth}).$$\n这些边意味着存在有向环\n$$\\text{Auth} \\to \\text{Orders} \\to \\text{Billing} \\to \\text{Auth},$$\n这是一个长度为 $3$ 的环。因此，$G$ 不是无环的，并且不存在拓扑排序。所以：\n- 任何提出的具体构建顺序（例如选项A和B中的）都不能满足所有的依赖关系；例如，两者都将 $\\text{Auth}$ 列在 $\\text{Billing}$ 之前，这违反了 $(\\text{Billing}, \\text{Auth})$。\n- 由于存在一个环，依赖关系集合是无效的，因此该集合有效且存在多种不同构建顺序的情况是不成立的。\n\n因此，正确的描述是依赖关系包含一个逻辑矛盾，形成了一个长度为 $3$ 的环，这与选项C相匹配。", "answer": "$$\\boxed{C}$$", "id": "1496996"}, {"introduction": "在理解了图的基本结构后，我们可以开始分析图中的路径。在带权重的DAG中，例如在物流网络或项目规划中，任务步骤的数量（边的数量）和总成本（权重之和）之间常常需要权衡。本练习将阐明“最短路径”可能具有不同的含义，并强调在解决优化问题时精确定义目标函数的重要性。[@problem_id:1497000]", "problem": "一位项目经理正在分析一个项目的工作流程，该流程可以建模为一个加权有向无环图（DAG）。在这个模型中，顶点代表里程碑，一条从里程碑 $U$ 到里程碑 $V$ 且权重为 $w$ 的有向边表示一个从 $U$ 到 $V$ 必须完成的任务，需要 $w$ 小时才能完成。\n\n该项目从源里程碑 $S$ 开始，在汇里程碑 $T$ 完成。该图由顶点集 $V = \\{S, A, B, C, T\\}$ 和以下有向边及其对应所需时间（单位：小时）定义：\n- 从 $S$ 到 $A$ 的边，权重为 8。\n- 从 $S$ 到 $B$ 的边，权重为 3。\n- 从 $A$ 到 $T$ 的边，权重为 4。\n- 从 $B$ 到 $C$ 的边，权重为 2。\n- 从 $C$ 到 $T$ 的边，权重为 5。\n\n项目经理有兴趣比较从起始里程碑 $S$ 到完成里程碑 $T$ 的两种不同类型的路径：\n1. “结构上最简单的路径”，定义为包含最少顺序任务（即最少边数）的路径。\n2. “最快的路径”，定义为完成总时间最短（即边权重之和最小）的路径。\n\n计算结构上最简单的路径与最快的路径之间的总小时数的绝对差。用小时表示你的答案。", "solution": "我们列出所有从 $S$ 到 $T$ 的有向路径，并计算每条路径的边数（用于结构简单性）和总时间（权重之和）。\n\n路径 $P_1: S \\rightarrow A \\rightarrow T$。\n- 边数：$2$。\n- 总时间：$w(S,A)+w(A,T)=8+4=12$。\n\n路径 $P_2: S \\rightarrow B \\rightarrow C \\rightarrow T$。\n- 边数：$3$。\n- 总时间：$w(S,B)+w(B,C)+w(C,T)=3+2+5=10$。\n\n根据定义，结构上最简单的路径是边数最少的路径，即 $P_1$，有 $2$ 条边，总时间为 $12$。\n\n最快的路径是总时间最短的路径，即 $P_2$，总时间为 $10$。\n\n所要求的总小时数的绝对差为\n$$|12-10|=2.$$", "answer": "$$\\boxed{2}$$", "id": "1497000"}, {"introduction": "在路径分析的基础上，我们来挑战一个更复杂的优化问题：“最大权重独立集”。在许多资源选择场景中，我们不能同时选择相互关联的元素（例如，相互冲突的活动或功能相关的蛋白质）。本练习展示了如何利用DAG（在本例中为树）的特殊结构，通过动态规划高效解决在一般图中极其困难的问题。[@problem_id:1496951]", "problem": "一家生物技术研究公司正在为一个复杂的细胞信号网络建模，以优化一种新的药物组合。该网络表示为一个有向无环图（DAG），其中节点是蛋白质，有向边 $(u, v)$ 表示蛋白质 $u$ 直接激活蛋白质 $v$。已知整个网络是一个森林，这意味着它是不相交树的集合，边从父节点指向子节点。\n\n网络中的每个蛋白质 $i$ 都被赋予一个“治疗价值” $w(i)$，这是一个正整数，代表其作为药物靶点的有效性。目标是选择一个蛋白质子集作为药物组合的靶点，以实现可能的最大总治疗价值。\n\n然而，基于结合机制存在一个关键约束：如果两个蛋白质直接相连（即一个是另一个的激活剂），它们不能同时被靶向。用图论的术语来说，所选的蛋白质集合必须形成一个独立集，其中任意两个选定的蛋白质在图中都不相邻。\n\n给定网络中一个这样的信号树的结构，包含8个标记为0到7的蛋白质。\n该结构由以下父子关系定义，其中边 $(u, v)$ 表示 $u$ 是 $v$ 的父节点：\n(0, 1), (0, 2), (0, 3), (1, 4), (1, 5), (3, 6), (3, 7)。\n蛋白质0是这棵树的根节点。\n\n这些蛋白质的治疗价值如下：\n- `w(0) = 3`\n- `w(1) = 5`\n- `w(2) = 6`\n- `w(3) = 2`\n- `w(4) = 8`\n- `w(5) = 4`\n- `w(6) = 7`\n- `w(7) = 3`\n\n计算通过选择一个有效的蛋白质靶点集合可以实现的最大可能总治疗价值。", "solution": "该问题要求在一个给定的顶点加权树中找到最大权重的独立集。独立集是一个顶点集合，其中任意两个顶点之间都没有边相连。由于该图是一棵树（一种特殊的有向无环图），这个问题可以使用动态规划高效地解决。通用策略是计算子树的解，并利用这些结果来计算更大树的解。这通常通过后序遍历来完成，从叶节点开始，向上移动到根节点。\n\n对于树中的每个节点 `u`，我们将计算两个值：\n1. `dp_in(u)`：在以 `u` 为根的子树中，且 `u` **被包含**在独立集内的最大权重独立集。\n2. `dp_out(u)`：在以 `u` 为根的子树中，且 `u` **不被包含**在独立集内的最大权重独立集。\n\n这些值的递推关系如下：\n- 如果我们将节点 `u` 包含在集合中（对于 `dp_in(u)`），它的权重 `w(u)` 会被加到总和中。根据独立集的定义，我们不能包含它的任何邻居。在树中，这意味着我们不能包含它的父节点（这由向上的动态规划流程处理）或任何它的直接子节点。因此，对于 `u` 的每个子节点 `v`，我们必须选择不包含 `v` 的选项。\n    $$dp_{\\text{in}}(u) = w(u) + \\sum_{v \\in \\text{children}(u)} dp_{\\text{out}}(v)$$\n- 如果我们不将节点 `u` 包含在集合中（对于 `dp_out(u)`），我们可以自由地为它的每个子节点的子树独立地做出最优选择。对于每个子节点 `v`，我们可以选择包含 `v` 或不包含 `v`，因此我们为它的子树选择两个选项中的最大值。\n    $$dp_{\\text{out}}(u) = \\sum_{v \\in \\text{children}(u)} \\max(dp_{\\text{in}}(v), dp_{\\text{out}}(v))$$\n\n这个递归的基例是树的叶节点。对于任何叶节点 `l`：\n- `dp_in(l) = w(l)`（集合就是 `{l}`）。\n- `dp_out(l) = 0`（集合是空的）。\n\n我们将从叶节点开始，向上移动到根节点，应用这个过程。给定的树结构是：\n根节点: 0\n0 的子节点: {1, 2, 3}\n1 的子节点: {4, 5}\n3 的子节点: {6, 7}\n叶节点: {2, 4, 5, 6, 7}\n\n权重为：`w = {3, 5, 6, 2, 8, 4, 7, 3}`，对应节点 `0` 到 `7`。\n\n**步骤 1：计算叶节点的动态规划值。**\n-   节点 2: `dp_in(2) = w(2) = 6`, `dp_out(2) = 0`。\n-   节点 4: `dp_in(4) = w(4) = 8`, `dp_out(4) = 0`。\n-   节点 5: `dp_in(5) = w(5) = 4`, `dp_out(5) = 0`。\n-   节点 6: `dp_in(6) = w(6) = 7`, `dp_out(6) = 0`。\n-   节点 7: `dp_in(7) = w(7) = 3`, `dp_out(7) = 0`。\n\n**步骤 2：以后序遍历方式计算内部节点的动态规划值。**\n-   节点 1 (子节点 {4, 5}):\n    -   `dp_in(1) = w(1) + dp_out(4) + dp_out(5) = 5 + 0 + 0 = 5`。\n    -   `dp_out(1) = \\max(dp_in(4), dp_out(4)) + \\max(dp_in(5), dp_out(5)) = \\max(8, 0) + \\max(4, 0) = 8 + 4 = 12`。\n-   节点 3 (子节点 {6, 7}):\n    -   `dp_in(3) = w(3) + dp_out(6) + dp_out(7) = 2 + 0 + 0 = 2`。\n    -   `dp_out(3) = \\max(dp_in(6), dp_out(6)) + \\max(dp_in(7), dp_out(7)) = \\max(7, 0) + \\max(3, 0) = 7 + 3 = 10`。\n\n**步骤 3：计算根节点的动态规划值。**\n-   节点 0 (子节点 {1, 2, 3}):\n    -   `dp_in(0) = w(0) + dp_out(1) + dp_out(2) + dp_out(3) = 3 + 12 + 0 + 10 = 25`。\n    -   `dp_out(0) = \\max(dp_in(1), dp_out(1)) + \\max(dp_in(2), dp_out(2)) + \\max(dp_in(3), dp_out(3)) = \\max(5, 12) + \\max(6, 0) + \\max(2, 10) = 12 + 6 + 10 = 28`。\n\n**步骤 4：确定最终答案。**\n整棵树的最大治疗价值是包含根节点或不包含根节点两者中的最大值。\n最终答案 = `\\max(dp_in(0), dp_out(0)) = \\max(25, 28) = 28`。\n\n为了验证，与 `dp_out(0)=28` 对应的集合是通过向下进行最优选择来构建的：\n- 不包含 0。\n- 对于子树 1，取最大值，即 `dp_out(1)=12`。这意味着我们不包含 1。对于其子节点 4 和 5，我们取最大值，即 `dp_in(4)=8` 和 `dp_in(5)=4`。所以我们选择 {4, 5}。\n- 对于子树 2，取最大值，即 `dp_in(2)=6`。所以我们选择 {2}。\n- 对于子树 3，取最大值，即 `dp_out(3)=10`。这意味着我们不包含 3。对于其子节点 6 和 7，我们取最大值，即 `dp_in(6)=7` 和 `dp_in(7)=3`。所以我们选择 {6, 7}。\n最终得到的独立集是 {2, 4, 5, 6, 7}。\n总权重为 `w(2) + w(4) + w(5) + w(6) + w(7) = 6 + 8 + 4 + 7 + 3 = 28`。这证实了结果。", "answer": "$$\\boxed{28}$$", "id": "1496951"}]}