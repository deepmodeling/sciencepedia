## 引言
在[图论](@entry_id:140799)研究中，如何从图的局部信息（如[顶点的度](@entry_id:264944)数）推断其全局结构特性（如是否存在一条遍历所有顶点的路径）是一个核心且富有挑战性的问题。哈密顿图的存在性判断便是这类问题的典型代表，它在物流规划、[网络路由](@entry_id:272982)和计算科学等领域具有重要的应用价值。然而，直接判断一个图是否为哈密顿图通常是计算困难的。为了解决这一难题，[图论](@entry_id:140799)学家引入了“图的闭包”（Graph Closure）这一精巧的构造性概念。图[闭包](@entry_id:148169)通过一个系统性的加边过程来“饱和”一个图，从而揭示其潜在的哈密顿性质，其理论基石是著名的邦迪-查瓦塔定理（Bondy-Chvátal theorem）。

本文将带领读者系统地学习图闭包的理论与实践。在“原理与机制”一章中，我们将首先深入探讨图闭包的精确定义、构造算法及其良定义性、[单调性](@entry_id:143760)等基本数学性质。接着，在“应用与跨学科联系”一章中，我们将展示[闭包](@entry_id:148169)操作的强大威力，重点讲解如何利用它结合邦迪-查瓦塔定理来判断和证明图的哈密顿性，并探索其与连通性、[独立数](@entry_id:260943)等其他图属性的深刻联系。最后，通过“动手实践”部分提供的精选问题，读者将有机会亲手计算和构造图的闭包，将理论知识转化为解决问题的实际能力。现在，让我们从图闭包最基本的原理与机制开始。

## 原理与机制

在本章中，我们将深入探讨图[闭包](@entry_id:148169)的定义、基本性质及其对图结构的影响。图闭包是研究哈密顿图的一个核心工具，理解其背后的原理与机制对于应用 Bondy-Chvátal 定理至关重要。我们将从闭包的构造过程出发，系统地分析其良定义性、[单调性](@entry_id:143760)等关键属性，并探讨[闭包](@entry_id:148169)操作与其他图操作（如并集、[补图](@entry_id:267681)）之间的关系。

### 图闭包的定义与构造

图[闭包](@entry_id:148169)的概念建立在一个简单的迭代过程之上。这个过程通过系统性地添加边来“饱和”一个图，直到其满足特定的[度数和条件](@entry_id:268883)。

**定义 (图[闭包](@entry_id:148169))**：令 $G$ 是一个具有 $n$ 个顶点的简单图。$G$ 的**闭包** (closure)，记作 $cl(G)$，是通过反复执行以下规则所得到的图：若 $u$ 和 $v$ 是当前图中不相邻的两个顶点，且它们的度数之和满足 $\deg(u) + \deg(v) \ge n$，则在 $u$ 和 $v$ 之间添加一条边。此过程持续进行，直到图中不再有任何满足条件的非邻接顶点对为止。

为了更好地理解这个过程，让我们通过一个具体的例子来演算一个图的[闭包](@entry_id:148169)。

**示例：计算一个5顶点图的[闭包](@entry_id:148169)**

考虑一个包含5个顶点 $V = \{v_1, v_2, v_3, v_4, v_5\}$ 的[简单图](@entry_id:274882) $G$。图 $G$ 的[边集](@entry_id:267160)由[路径图](@entry_id:274599) $P_5$ 的边（即 $(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5)$）以及一条额外的边 $(v_1, v_4)$ 组成。我们将逐步构造该图的闭包 [@problem_id:1484531]。

首先，我们计算初始图中各个顶点的度数。顶点数为 $n=5$。
$$
\deg(v_1)=2, \quad \deg(v_2)=2, \quad \deg(v_3)=2, \quad \deg(v_4)=3, \quad \deg(v_5)=1.
$$
[闭包](@entry_id:148169)规则要求，对于任何非邻接顶点对 $\{u, v\}$，如果它们的度数和 $\deg(u) + \deg(v) \ge 5$，我们就添加边 $(u,v)$。

我们检查初始图中的所有非邻接顶点对：
- $(v_1, v_3)$: $\deg(v_1) + \deg(v_3) = 2+2=4  5$。不添加边。
- $(v_1, v_5)$: $\deg(v_1) + \deg(v_5) = 2+1=3  5$。不添加边。
- $(v_2, v_4)$: $\deg(v_2) + \deg(v_4) = 2+3=5 \ge 5$。**添加边 $(v_2, v_4)$**。
- $(v_2, v_5)$: $\deg(v_2) + \deg(v_5) = 2+1=3  5$。不添加边。
- $(v_3, v_5)$: $\deg(v_3) + \deg(v_5) = 2+1=3  5$。不添加边。

在第一轮迭代中，我们只添加了一条边 $(v_2, v_4)$。添加这条边后，图的结构发生了变化，顶点的度数也相应更新。我们将新图记为 $G'$。在 $G'$ 中，顶点 $v_2$ 和 $v_4$ 的度数各增加1。
$$
\deg_{G'}(v_1)=2, \quad \deg_{G'}(v_2)=3, \quad \deg_{G'}(v_3)=2, \quad \deg_{G'}(v_4)=4, \quad \deg_{G'}(v_5)=1.
$$
现在，我们在这个新图 $G'$ 的基础上，再次检查所有剩余的非邻接顶点对：
- $(v_1, v_3)$: $\deg_{G'}(v_1) + \deg_{G'}(v_3) = 2+2=4  5$。
- $(v_1, v_5)$: $\deg_{G'}(v_1) + \deg_{G'}(v_5) = 2+1=3  5$。
- $(v_2, v_5)$: $\deg_{G'}(v_2) + \deg_{G'}(v_5) = 3+1=4  5$。
- $(v_3, v_5)$: $\deg_{G'}(v_3) + \deg_{G'}(v_5) = 2+1=3  5$。

在更新后的度数下，没有任何非邻接顶点对的度数和达到或超过5。因此，闭包过程终止。最终的[闭包](@entry_id:148169)图 $cl(G)$ 包含了原图的5条边以及新添加的1条边 $(v_2, v_4)$，总共有6条边。

当一个图的[闭包](@entry_id:148169)过程不再能添加任何边时，我们称这个图是**闭合的 (closed)**。形式上，一个图 $G$ 是闭合的，如果 $G=cl(G)$。这等价于说，对于 $G$ 中任意一对不相邻的顶点 $u$ 和 $v$，它们的度数之和都严格小于 $n$，即 $\deg(u) + \deg(v)  n$。

一个常见的误解是，闭包过程总是以一个[完全图](@entry_id:266483) $K_n$ 告终。然而，事实并非如此。例如，考虑8个顶点上的[循环图](@entry_id:273723) $C_8$。这里 $n=8$，每个[顶点的度](@entry_id:264944)数都是2。对于任何不相邻的顶点对 $\{u, v\}$，它们的度数和为 $\deg(u) + \deg(v) = 2+2=4$，这远小于8。因此，$C_8$ 本身就是一个闭合图，但它显然不是[完全图](@entry_id:266483)。同样，一个由两个不相交的 $K_4$ 组成的图（$n=8$）也是闭合的，因为每个顶点的度数都是3，任何跨组件的非邻接点对的度数和为 $\deg(u) + \deg(v) = 3+3=6  8$ [@problem_id:1484533]。

### [闭包](@entry_id:148169)操作的基本性质

闭包操作具有一些非常重要的数学性质，这些性质保证了其在理论分析中的可靠性和一致性。

#### 良定义性 (Well-Definedness)

一个关键问题是：[闭包](@entry_id:148169)的最终结果是否依赖于我们添加边的顺序？如果一次可以添加多条满足条件的边，选择不同的添加顺序是否会产生不同的最终图？答案是不会的，闭包操作是**良定义的 (well-defined)**，即最终的[闭包](@entry_id:148169)图是唯一的，与添加合格边的具体顺序无关 [@problem_id:1484559]。

这一性质的根本原因在于[度数和条件](@entry_id:268883)的**单调性**。假设在某个图 $H$ 中，一对非邻接顶点 $\{u,v\}$ 满足 $\deg_H(u)+\deg_H(v) \ge n$。现在，如果在 $H$ 中添加任何其他的边得到一个超图 $H'$，那么对于所有顶点 $w$，其在 $H'$ 中的度数 $\deg_{H'}(w)$ 必然大于或等于其在 $H$ 中的度数 $\deg_H(w)$。因此，
$$
\deg_{H'}(u)+\deg_{H'}(v) \ge \deg_H(u)+\deg_H(v) \ge n.
$$
这意味着，一旦一对顶点满足了加边条件，在后续的任何加边步骤中，它们将继续满足该条件。因此，任何一个在某个有效添加序列中被加入的边，在任何其他的“最大化”添加序列中也必然会满足条件并最终被加入。这保证了所有可能的添加序列最终都会收敛到同一个、唯一的[边集](@entry_id:267160)合，从而得到唯一的闭包图。

#### [单调性](@entry_id:143760)与[幂等性](@entry_id:190768)

除了良定义性，[闭包算子](@entry_id:747392) $cl(\cdot)$ 还具有另外两个基本的性质：单调性和[幂等性](@entry_id:190768)。

- **[幂等性](@entry_id:190768) (Idempotence)**: 对于任何图 $G$，有 $cl(cl(G)) = cl(G)$。这个性质从定义中直接得出。$cl(G)$ 是[闭包](@entry_id:148169)过程的终点，其本身就是一个闭合图。对一个已经闭合的图再应用闭包操作，不会添加任何新的边。

- **[单调性](@entry_id:143760) (Monotonicity)**: 如果图 $G_1$ 是图 $G_2$ 的一个[子图](@entry_id:273342)（在相同顶点集上），即 $E(G_1) \subseteq E(G_2)$，那么它们的[闭包](@entry_id:148169)也满足相同的关系，即 $cl(G_1) \subseteq cl(G_2)$。这个性质的直观解释是，拥有更多初始边的图，其顶点的初始度数也更高（或相等），这只会使得更多（或相同）的非邻接点对满足[度数和条件](@entry_id:268883)，从而导致一个更大（或相等）的闭包。

单调性是一个非常强大的性质。例如，它告诉我们，向图中添加一条边，其[闭包](@entry_id:148169)只能变得更大或保持不变 [@problem_id:1489481]。反之，从图中移除一条边，其闭包只能变得更小或保持不变 [@problem_id:1489496]。这个性质的证明可以通过对[闭包](@entry_id:148169)构造的步骤进行归纳来完成。

### [闭包](@entry_id:148169)操作与其他图操作的关系

理解[闭包](@entry_id:148169)操作如何与其他[图论](@entry_id:140799)操作（如并集和补集）相互作用，有助于我们更深入地掌握其行为。

#### [闭包](@entry_id:148169)与并集

给定同一顶点集上的两个图 $G_1$ 和 $G_2$，一个自然的问题是 $cl(G_1 \cup G_2)$ 与 $cl(G_1)$ 和 $cl(G_2)$ 之间有何关系。有人可能会猜测 $cl(G_1 \cup G_2) = cl(G_1) \cup cl(G_2)$，但这通常是不成立的。反例可以说明这一点：考虑 $n=4$ 时，图 $G_1$ 的[边集](@entry_id:267160)为 $\{(a,b), (a,c)\}$，图 $G_2$ 的[边集](@entry_id:267160)为 $\{(d,b), (d,c)\}$。在 $G_1$ 和 $G_2$ 中，顶点 $b$ 和 $c$ 的度数和均为 $1+1=2  4$，因此边 $(b,c)$ 不会出现在 $cl(G_1)$ 或 $cl(G_2)$ 中。然而，在它们的并图 $G_1 \cup G_2$ 中，$\deg(b)=2$ 且 $\deg(c)=2$，它们的度数和为 $4 \ge 4$。因此，边 $(b,c)$ 会被添加到 $cl(G_1 \cup G_2)$ 中。这表明，图的合并可以产生一种“协同效应”，使得在单个图中不满足条件的边在合并后的图中得以添加。

正确的恒等关系是 $cl(G_1 \cup G_2) = cl(cl(G_1) \cup cl(G_2))$ [@problem_id:1489471]。这个关系可以利用闭包的[单调性](@entry_id:143760)和[幂等性](@entry_id:190768)来证明。一方面，由于 $G_1 \cup G_2 \subseteq cl(G_1) \cup cl(G_2)$，根据[单调性](@entry_id:143760)有 $cl(G_1 \cup G_2) \subseteq cl(cl(G_1) \cup cl(G_2))$。另一方面，由于 $G_1 \subseteq G_1 \cup G_2$ 和 $G_2 \subseteq G_1 \cup G_2$，再次利用单调性得到 $cl(G_1) \subseteq cl(G_1 \cup G_2)$ 和 $cl(G_2) \subseteq cl(G_1 \cup G_2)$，这意味着 $cl(G_1) \cup cl(G_2) \subseteq cl(G_1 \cup G_2)$。对这个关系两边同时取[闭包](@entry_id:148169)，并利用[幂等性](@entry_id:190768)，我们得到 $cl(cl(G_1) \cup cl(G_2)) \subseteq cl(cl(G_1 \cup G_2)) = cl(G_1 \cup G_2)$。结合两个方向的包含关系，等式得以证明。

#### 闭包与[补图](@entry_id:267681)

[闭包](@entry_id:148169)和补图操作通常是**不可交换的**。也就是说，一个图的补的闭包（$cl(\overline{G})$）通常不等于其闭包的补（$\overline{cl(G)}$）。

我们可以通过一个简单的例子来验证这一点 [@problem_id:1489468]。设 $G$ 是一个5个顶点上的图，其[边集](@entry_id:267160)为 $E = \{(v_1, v_2), (v_2, v_3)\}$。
- 首先计算 $cl(G)$。在 $G$ 中，$n=5$，度数最高的顶点 $v_2$ 度数为2。任何非邻接点对的度数和最大为 $\deg(v_2)+\deg(v_1)=2+1=3  5$。因此，没有边可以被添加，所以 $cl(G)=G$。其[补图](@entry_id:267681)为 $\overline{cl(G)} = \overline{G}$。
- 接着计算 $cl(\overline{G})$。在 $\overline{G}$ 中，非邻接边只有 $(v_1, v_2)$ 和 $(v_2, v_3)$。在 $\overline{G}$ 中，顶点的度数为 $\deg_{\overline{G}}(v_1)=3, \deg_{\overline{G}}(v_2)=2, \deg_{\overline{G}}(v_3)=3$。非邻接点对的度数和为 $\deg_{\overline{G}}(v_1)+\deg_{\overline{G}}(v_2)=3+2=5$ 和 $\deg_{\overline{G}}(v_2)+\deg_{\overline{G}}(v_3)=2+3=5$。两者都满足加边条件。因此，这两条边都会被加入，使得 $cl(\overline{G})$ 成为完全图 $K_5$。
- 比较两者：$cl(\overline{G})=K_5$，而 $\overline{cl(G)}=\overline{G}$，它不是完全图。因此，在这个例子中，$cl(\overline{G}) \neq \overline{cl(G)}$。

这个例子提醒我们，在处理复合图操作时必须小心，不能想当然地假设它们满足[交换律](@entry_id:141214)或分配律。

### [闭包](@entry_id:148169)对图结构的影响

[闭包](@entry_id:148169)操作通过添加边来改变图的结构。这种改变对图的宏观属性，如连通性和直径，会产生什么影响？

#### 连通性

[闭包](@entry_id:148169)操作**不会连接一个不连通的图**。如果一个图 $G$ 是不连通的，那么它的[闭包](@entry_id:148169) $cl(G)$ 也一定是不连通的 [@problem_id:1484545]。

证明这个论断的思路很简单。假设图 $G$ 有多个连通分量。考虑任意两个顶点 $u$ 和 $v$，它们分别属于不同的连通分量 $C_1$ 和 $C_2$。在 $C_1$ 中，$u$ 的度数最多为 $|V(C_1)|-1$，因为它最多只能与 $C_1$ 中的其他所有顶点相连。同理，$v$ 的度数最多为 $|V(C_2)|-1$。因此，它们的度数和满足：
$$
\deg(u) + \deg(v) \le (|V(C_1)|-1) + (|V(C_2)|-1) = |V(C_1)|+|V(C_2)|-2 \le n-2.
$$
由于它们的度数和严格小于 $n$，根据闭包的定义，边 $(u,v)$ 永远不会被添加。这个逻辑在整个[闭包](@entry_id:148169)过程中都成立，因为添加任何边都不会改变顶点所属的连通分量。因此，如果 $G$ 是不连通的，$cl(G)$ 也必然是不连通的，并且其连通分量的划分与 $G$ 相同。

#### [图的直径](@entry_id:271355)

图的**直径** $D(G)$ 定义为图中任意两个顶点之间[最短路径](@entry_id:157568)长度的最大值。由于闭包操作只添加边而不删除边，图中任意两个顶点之间的最短路径长度只会减少或保持不变。因此，闭包[图的直径](@entry_id:271355)必然小于或等于原[图的直径](@entry_id:271355)，即 $D(cl(G)) \le D(G)$。

等号不总是成立。在某些情况下，闭包会显著地“缩小”图。一个经典的例子是4个顶点上的[循环图](@entry_id:273723) $C_4$ [@problem_id:1489507]。在 $C_4$ 中，$n=4$，每个顶点的度数都是2。对角线上的两个顶点不相邻，它们的距离为2，这也是该[图的直径](@entry_id:271355)，所以 $D(C_4)=2$。对于任何一对非邻接顶点 $\{u,v\}$，它们的度数和为 $\deg(u)+\deg(v)=2+2=4=n$。因此，[闭包](@entry_id:148169)操作会添加两条对角线，将 $C_4$ 变为[完全图](@entry_id:266483) $K_4$。在 $K_4$ 中，任何两个不同的顶点都是相邻的，所以其直径为1。在这个例子中，$D(cl(C_4))=1  D(C_4)=2$。

### 深入探究[闭包](@entry_id:148169)机制

闭包的迭代性质意味着，一次加边操作可能会引发后续的连锁反应。精确地刻画闭包过程的结果，有时需要考虑这种级联效应。

让我们思考一个更细致的问题：在什么条件下，[闭包](@entry_id:148169)操作恰好只添加一条边？[@problem_id:1489493]

一个初步的猜想可能是：图中恰好只有一对非邻接顶点 $\{x, y\}$ 满足[度数和条件](@entry_id:268883) $\deg_G(x) + \deg_G(y) \ge n$。这个条件是必要的，但并非充分。为什么呢？因为当我们添加边 $(x,y)$ 得到新图 $G'$后，$x$ 和 $y$ 的度数都增加了1。这可能会使得某个之前不满足条件的顶点对，例如 $\{x,z\}$，在新图 $G'$ 中满足条件 $\deg_{G'}(x)+\deg_{G'}(z) \ge n$，从而触发第二条边的添加。

为了确保只添加一条边，我们必须排除这种连锁反应。设 $\{x,y\}$ 是 $G$ 中唯一满足 $\deg_G(x) + \deg_G(y) \ge n$ 的非邻接点对。为了防止在添加 $(x,y)$ 后能添加第二条边，例如 $(x,z)$，我们必须确保在 $G'$ 中 $\deg_{G'}(x) + \deg_{G'}(z)  n$。由于 $\deg_{G'}(x) = \deg_G(x)+1$ 且 $\deg_{G'}(z) = \deg_G(z)$，这要求 $(\deg_G(x)+1) + \deg_G(z)  n$，即 $\deg_G(x) + \deg_G(z) \le n-2$。

因此，一个图 $G$ 的闭包恰好比 $G$ 多一条边的充分必要条件是：
1. 在 $G$ 中，存在唯一的非邻接顶点对 $\{x,y\}$，满足 $\deg_G(x) + \deg_G(y) \ge n$。
2. 对于任何不与 $x$ 相邻的顶点 $z \notin \{x,y\}$，必须有 $\deg_G(x) + \deg_G(z) \le n-2$。
3. 对于任何不与 $y$ 相邻的顶点 $z \notin \{x,y\}$，必须有 $\deg_G(y) + \deg_G(z) \le n-2$。

这个例子深刻地揭示了[闭包](@entry_id:148169)操作的动态和迭代本质。它不仅仅是一次性的检查，而是一个[度数和条件](@entry_id:268883)不断演化的过程，直到系统达到一个稳定的“闭合”状态。对这种机制的深入理解是掌握哈密顿图相关理论的关键。