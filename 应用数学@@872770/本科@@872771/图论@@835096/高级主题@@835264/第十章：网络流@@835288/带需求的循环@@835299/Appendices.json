{"hands_on_practices": [{"introduction": "许多现实世界中的分配问题都可以归结为一个基本问题：“这个计划可行吗？”本练习 [@problem_id:1488576] 通过一个公司内部预算调配的场景，向你展示如何将一个系统建模为带需求的循环问题。通过检验网络中是否存在足以满足所有需求的路径，你可以学会如何识别潜在的瓶颈，这是分析任何分配网络的第一步。", "problem": "科技公司 Innovate Inc. 正在进行季度预算审查。该公司由五个关键部门组成：研发部（R）、市场部（Marketing）、销售部（Sales）、人力资源部（HR）和运营部（Operations）。\n\n各部门的财务状况如下（正值表示盈余，负值表示赤字），单位均为千预算单位：\n-   研发部（R）：-40\n-   市场部（Marketing）：-25\n-   销售部（Sales）：+50\n-   人力资源部（HR）：-15\n-   运营部（Operations）：+30\n\n然而，内部规定限制了哪些部门可以向哪些部门转移资金。允许的单向转移渠道及其最大转移能力（单位：千预算单位）如下：\n-   销售部可向市场部（最多30）和研发部（最多20）转移。\n-   运营部可向研发部（最多20）和人力资源部（最多10）转移。\n-   人力资源部可向市场部（最多5）转移。\n\n只有当所有部门的赤字都由盈余部门调拨的资金完全弥补，并且遵守所有转移能力限制时，预算分配方案才被认为是可行的。关于此预算分配情景，以下哪个陈述是正确的？\n\nA. 存在一个可行的预算分配方案，可以完全满足所有赤字。\n\nB. 不存在可行的分配方案，因为总预算盈余大于总预算赤字。\n\nC. 不存在可行的分配方案，因为转移渠道的能力不足，导致最小未满足的总赤字为5,000预算单位。\n\nD. 不存在可行的分配方案，因为转移渠道的能力不足，导致最小未满足的总赤字为10,000预算单位。\n\nE. 由于总预算盈余与总预算赤字完全相等，因此保证存在可行的分配方案。", "solution": "我们将此问题建模为一个有容量的转运网络，其中盈余部门为供应点，赤字部门为需求点。我们将各部门索引如下：销售部（S）、运营部（O）、研发部（R）、市场部（M）和人力资源部（H）。供应量和需求量（单位：千）如下：\n- 供应量：$s_{S} = 50$, $s_{O} = 30$。\n- 需求量：$d_{R} = 40$, $d_{M} = 25$, $d_{H} = 15$。\n\n有向转移渠道及其容量如下：\n$$u_{S,M} = 30,\\quad u_{S,R} = 20,\\quad u_{O,R} = 20,\\quad u_{O,H} = 10,\\quad u_{H,M} = 5.$$\n\n令 $f_{i,j} \\ge 0$ 表示从 $i$到 $j$ 的流量，所有列出的弧上都有容量限制 $f_{i,j} \\le u_{i,j}$。净流量平衡约束为：\n- 对于供应节点，总流出量不能超过供应量：\n$$f_{S,M} + f_{S,R} \\leq 50,\\qquad f_{O,R} + f_{O,H} \\leq 30.$$\n- 对于需求节点，净流入量等于该节点被弥补的赤字量：\n$$x_{R} = f_{S,R} + f_{O,R} \\leq 40,\\qquad x_{M} = f_{S,M} + f_{H,M} \\leq 25,\\qquad x_{H} = f_{O,H} - f_{H,M} \\leq 15,$$\n且 $f_{H,M} \\leq 5$。\n\n一个完全可行的分配方案要求同时满足 $x_{R} = 40$，$x_{M} = 25$ 和 $x_{H} = 15$。\n\n人力资源部（HR）处的关键不可行边界：\n人力资源部只有一个来自运营部的输入弧，容量为 $u_{O,H} = 10$。由于人力资源部还有一个到市场部的输出弧，其净流入量满足\n$$x_{H} = f_{O,H} - f_{H,M} \\leq f_{O,H} \\leq 10.$$\n因此 $x_{H} \\le 10  15$，所以在任何分配方案中，人力资源部的赤字至少有 $15 - x_{H} \\ge 5$ 个单位无法被满足。因此，一个完全可行的分配方案是不可能的。\n\n边界的紧密性（可达性）：\n选择流量\n$$f_{S,R} = 20,\\quad f_{O,R} = 20,\\quad f_{S,M} = 25,\\quad f_{O,H} = 10,\\quad f_{H,M} = 0.$$\n这些流量满足所有容量限制。它们弥补了 $x_{R} = 40$（研发部完全满足），$x_{M} = 25$（市场部完全满足），以及 $x_{H} = 10$（人力资源部短缺 $15 - 10 = 5$）。由于 $u_{O,H} = 10$ 的瓶颈限制，没有其他重新分配方案可以将 $x_{H}$ 增加到超过10。因此，最小未满足的总赤字恰好是5千个单位。\n\n由于总盈余等于总赤字，选项B是错误的。总额的完全匹配并不能保证在渠道容量限制下的可行性，所以选项E是错误的。正确的陈述是容量不足，导致最小未满足的总赤字为5,000预算单位，即选项C。", "answer": "$$\\boxed{C}$$", "id": "1488576"}, {"introduction": "在真实世界的物流网络中，我们不仅要考虑运力的上限，有时还必须满足最低运营要求以确保盈利。本练习 [@problem_id:1488617] 在基础模型之上引入了流量下界（minimum flow requirements）这一关键扩展。你需要判断是否存在一个既能满足所有节点的供需平衡，又同时遵守每条路径流量上下限的运输方案。", "problem": "一家名为“A-to-D Express”的物流公司运营着一个连接四个主要配送中心的货运网络：亚特兰大 (A)、波士顿 (B)、芝加哥 (C) 和丹佛 (D)。为了维持盈利能力，某些运输路线有必须承运的最小货运量要求，而所有路线都有最大容量限制。公司需要确定是否存在一个可行的稳态运输调度，使得对于每个配送中心，流入的总货运量等于流出的总货运量。\n\n网络路线及其约束定义如下，所有货运量单位为千吨/周：\n\n*   亚特兰大到波士顿：最小2，最大5\n*   亚特兰大到芝加哥：最小1，最大4\n*   波士顿到芝加哥：最小0，最大3\n*   波士顿到丹佛：最小3，最大6\n*   芝加哥到丹佛：最小2，最大5\n*   丹佛到亚特兰大：最小4，最大8\n\n根据这些约束，是否有可能设计一个运输调度，既满足所有路线的最小和最大货运量要求，又在每个中心保持货物流通守恒？从以下选项中选择最准确的陈述。\n\nA. 不，不存在可行的调度。\n\nB. 是，存在可行的调度，并且所有路线的总最小需求流量为每周10千吨。\n\nC. 是，存在可行的调度，并且所有路线的总最小需求流量为每周12千吨。\n\nD. 只有在增加从丹佛 (D) 到亚特兰大 (A) 路线的容量时，才可能存在可行的调度。", "solution": "设每条有向路线上的流量用变量 $x_{AB}, x_{AC}, x_{BC}, x_{BD}, x_{CD}, x_{DA}$ 表示（单位为千吨/周），并满足以下界限约束：\n$$2 \\leq x_{AB} \\leq 5,\\quad 1 \\leq x_{AC} \\leq 4,\\quad 0 \\leq x_{BC} \\leq 3,$$\n$$3 \\leq x_{BD} \\leq 6,\\quad 2 \\leq x_{CD} \\leq 5,\\quad 4 \\leq x_{DA} \\leq 8.$$\n每个节点的流量守恒要求：\n- 在 $A$：流入量 $x_{DA}$ 等于流出量 $x_{AB}+x_{AC}$，所以 $x_{DA}=x_{AB}+x_{AC}$。\n- 在 $B$：流入量 $x_{AB}$ 等于流出量 $x_{BC}+x_{BD}$，所以 $x_{AB}=x_{BC}+x_{BD}$。\n- 在 $C$：流入量 $x_{AC}+x_{BC}$ 等于流出量 $x_{CD}$，所以 $x_{AC}+x_{BC}=x_{CD}$。\n- 在 $D$：流入量 $x_{BD}+x_{CD}$ 等于流出量 $x_{DA}$，这个等式可以从前三个方程自动得出。\n\n利用 $x_{BC}=x_{AB}-x_{BD}$、$x_{CD}=x_{AC}+x_{BC}=x_{AC}+x_{AB}-x_{BD}$ 和 $x_{DA}=x_{AB}+x_{AC}$ 消去因变量，界限对自变量 $x_{AB}, x_{AC}, x_{BD}$ 施加了以下约束：\n- 来自 $0 \\leq x_{BC} \\leq 3$：$0 \\leq x_{AB}-x_{BD} \\leq 3$，即 $x_{BD} \\leq x_{AB} \\leq x_{BD}+3$。\n- 来自 $2 \\leq x_{CD} \\leq 5$：$2 \\leq x_{AC}+x_{AB}-x_{BD} \\leq 5$。\n- 来自 $4 \\leq x_{DA} \\leq 8$：$4 \\leq x_{AB}+x_{AC} \\leq 8$。\n- 原始的单个变量界限：$2 \\leq x_{AB} \\leq 5$，$1 \\leq x_{AC} \\leq 4$，$3 \\leq x_{BD} \\leq 6$。\n\n一个满足所有约束的可行选择是：\n$$x_{BD}=3,\\quad x_{AB}=3,\\quad x_{AC}=2.$$\n这意味着\n$$x_{BC}=x_{AB}-x_{BD}=0,\\quad x_{CD}=x_{AC}+x_{BC}=2,\\quad x_{DA}=x_{AB}+x_{AC}=5.$$\n检查所有界限：\n$$x_{AB}=3 \\in [2,5],\\quad x_{AC}=2 \\in [1,4],\\quad x_{BC}=0 \\in [0,3],$$\n$$x_{BD}=3 \\in [3,6],\\quad x_{CD}=2 \\in [2,5],\\quad x_{DA}=5 \\in [4,8].$$\n检查守恒性：\n- 在 $A$：$x_{DA}=5$ 等于 $x_{AB}+x_{AC}=3+2=5$。\n- 在 $B$：$x_{AB}=3$ 等于 $x_{BC}+x_{BD}=0+3=3$。\n- 在 $C$：$x_{AC}+x_{BC}=2+0=2$ 等于 $x_{CD}=2$。\n- 在 $D$：$x_{BD}+x_{CD}=3+2=5$ 等于 $x_{DA}=5$。\n\n因此，存在一个可行的稳态调度。\n\n所有路线的最小需求货运量总和是其下界之和：\n$$2+1+0+3+2+4=12.$$\n因此，正确的陈述是：存在可行的调度，并且所有路线的总最小需求流量为每周12千吨。选项B的值10是不正确的，而选项A和D是错误的，因为我们展示了一个无需改变任何容量的可行解。", "answer": "$$\\boxed{C}$$", "id": "1488617"}, {"introduction": "仅仅判断一个计划是否可行是不够的，真正的挑战在于当计划不可行时如何去修正它。这个更进一步的练习 [@problem_id:1488582] 将带你探索如何解决这个问题。通过将带需求的循环问题转化为一个最大流问题，并运用最大流-最小割定理，我们不仅能证明一个网络方案的不可行性，还能精确定位导致流量不足的瓶颈，并计算出修复网络所需的最小成本。", "problem": "一个物流网络被建模为一个有向图 $G=(V, E)$，其中顶点集合 $V = \\{v_1, v_2, v_3, v_4, v_5, v_6\\}$ 代表六个仓库。每个仓库 $v_i$ 都有一个相关的整数需求 $d(v_i)$。正需求表示该仓库的物品净需求量，而负需求表示净供给量。各仓库的需求如下：\n$d(v_1) = -15$, $d(v_2) = -10$, $d(v_3) = 0$, $d(v_4) = 8$, $d(v_5) = 12$, and $d(v_6) = 5$。\n\n这些仓库由单向运输路线连接，表示为集合 $E$ 中的有向边。每条边 $(u, v)$ 都有一个整数容量 $c(u, v)$，代表单位时间内可以运输的最大物品数量。网络路线及其容量如下：\n$c(v_1, v_3) = 10$\n$c(v_1, v_4) = 8$\n$c(v_2, v_3) = 7$\n$c(v_2, v_5) = 5$\n$c(v_3, v_5) = 10$\n$c(v_3, v_6) = 4$\n$c(v_4, v_5) = 3$\n\n如果一个流满足所有容量约束，并且流入每个仓库 $v_i$ 的净流量等于其需求 $d(v_i)$，则该流被认为是可行的。在当前的容量下，不存在可行流。公司计划升级上述七条路线中某一条路线的容量，以实现可行流。\n\n确定为使可行环流成为可能，单条边的容量必须增加的最小整数值是多少。", "solution": "这个问题要求为使带需求的环流可行，单条边容量的最小增量。首先，我们必须检查可行环流的必要条件，即所有需求的总和为零。在这种情况下，$\\sum_{i=1}^{6} d(v_i) = -15 - 10 + 0 + 8 + 12 + 5 = 0$。该条件已满足。\n\n带需求的环流的可行性可以通过将问题转化为一个标准的最大流问题来确定。我们构建一个带有超级源点 $s$ 和超级汇点 $t$ 的新图 $G'$。\n1. 对于每个需求为负 $d(v)  0$ 的顶点 $v$（供给节点），我们添加一条从 $s$ 到 $v$ 的边，容量为 $-d(v)$。\n   - 边 $(s, v_1)$，容量 $c(s, v_1) = -d(v_1) = 15$。\n   - 边 $(s, v_2)$，容量 $c(s, v_2) = -d(v_2) = 10$。\n2. 对于每个需求为正 $d(v) > 0$ 的顶点 $v$（需求节点），我们添加一条从 $v$ 到 $t$ 的边，容量为 $d(v)$。\n   - 边 $(v_4, t)$，容量 $c(v_4, t) = d(v_4) = 8$。\n   - 边 $(v_5, t)$，容量 $c(v_5, t) = d(v_5) = 12$。\n   - 边 $(v_6, t)$，容量 $c(v_6, t) = d(v_6) = 5$。\n3. 所有原始边 $(u, v)$ 及其容量 $c(u, v)$ 都在 $G'$ 中保留。\n\n当且仅当新图 $G'$ 中从 $s$ 到 $t$ 的最大流等于总需求 $D = \\sum_{v | d(v)>0} d(v)$ 时，原始图 $G$ 中存在可行环流。\n总需求为 $D = 8 + 12 + 5 = 25$。\n\n现在我们使用 Ford-Fulkerson 算法和增广路径来寻找 $G'$ 中从 $s$ 到 $t$ 的最大流。我们在残留图中寻找从 $s$ 到 $t$ 的路径，并沿着这些路径增加流量。\n\n1.  增广路径：$s \\rightarrow v_1 \\rightarrow v_4 \\rightarrow t$。\n    瓶颈容量为 $\\min(c(s, v_1), c(v_1, v_4), c(v_4, t)) = \\min(15, 8, 8) = 8$。\n    我们发送 8 个单位的流。总流量 = 8。\n    残留容量：$c_f(s,v_1)=7$, $c_f(v_1,v_4)=0$, $c_f(v_4,t)=0$。\n\n2.  增广路径：$s \\rightarrow v_1 \\rightarrow v_3 \\rightarrow v_5 \\rightarrow t$。\n    瓶颈容量为 $\\min(c_f(s, v_1), c(v_1, v_3), c(v_3, v_5), c(v_5, t)) = \\min(7, 10, 10, 12) = 7$。\n    我们发送 7 个单位的流。总流量 = $8 + 7 = 15$。\n    残留容量：$c_f(s,v_1)=0$, $c_f(v_1,v_3)=3$, $c_f(v_3,v_5)=3$, $c_f(v_5,t)=5$。\n\n3.  增广路径：$s \\rightarrow v_2 \\rightarrow v_5 \\rightarrow t$。\n    瓶颈容量为 $\\min(c(s, v_2), c(v_2, v_5), c_f(v_5, t)) = \\min(10, 5, 5) = 5$。\n    我们发送 5 个单位的流。总流量 = $15 + 5 = 20$。\n    残留容量：$c_f(s,v_2)=5$, $c_f(v_2,v_5)=0$, $c_f(v_5,t)=0$。\n\n4.  增广路径：$s \\rightarrow v_2 \\rightarrow v_3 \\rightarrow v_6 \\rightarrow t$。\n    瓶颈容量为 $\\min(c_f(s, v_2), c(v_2, v_3), c(v_3, v_6), c(v_6, t)) = \\min(5, 7, 4, 5) = 4$。\n    我们发送 4 个单位的流。总流量 = $20 + 4 = 24$。\n    残留容量：$c_f(s,v_2)=1$, $c_f(v_2,v_3)=3$, $c_f(v_3,v_6)=0$, $c_f(v_6,t)=1$。\n\n在这些增广之后，没有更多简单的路径了。让我们检查残留图中是否还有任何剩余的 $s-t$ 路径。顶点 $s$ 可以到达 $v_2$（残留容量为1）。从 $v_2$ 可以到达 $v_3$（残留容量为3）。从 $v_3$ 可以到达 $v_1$（通过反向边）、$v_2$（通过反向边）和 $v_5$（残留容量为3）。从 $v_5$ 出发，所有正向路径都已饱和（例如，$(v_5, t)$ 的残留容量为0）。没有从 $s$ 到 $t$ 的路径了。\n\n最大流为 $F_{max} = 24$。因为 $F_{max} = 24  D = 25$，所以该环流确实是不可行的。流量亏空为 $\\Delta = D - F_{max} = 25 - 24 = 1$。\n\n为了使环流可行，我们必须将最大流至少增加 $\\Delta = 1$。根据最大流最小割定理，最大流等于最小割的容量。只有通过增加从源点侧划分跨越到汇点侧划分的某条边的容量，才能实现最大流的增加。\n\n让我们找到最小割。源点侧划分 $S$ 包含在最终残留图中所有从 $s$ 可达的顶点。\n- $s \\in S$。\n- 存在路径 $s \\rightarrow v_2$，所以 $v_2 \\in S$。\n- 存在路径 $s \\rightarrow v_2 \\rightarrow v_3$，所以 $v_3 \\in S$。\n- 从 $v_3$ 我们可以到达 $v_1$ 和 $v_5$。所以 $v_1, v_5 \\in S$。\n- 从 $S$ 无法到达其他顶点。\n因此，最小割划分为 $S = \\{s, v_1, v_2, v_3, v_5\\}$ 和 $T = V' \\setminus S = \\{v_4, v_6, t\\}$。\n\n割 $C(S,T)$ 的容量是 $G'$ 中所有边 $(u,v)$ 的容量之和，其中 $u \\in S$ 且 $v \\in T$。\n- 边 $(v_1, v_4)$：$v_1 \\in S, v_4 \\in T$。容量 = $c(v_1, v_4) = 8$。\n- 边 $(v_3, v_6)$：$v_3 \\in S, v_6 \\in T$。容量 = $c(v_3, v_6) = 4$。\n- 边 $(v_5, t)$：$v_5 \\in S, t \\in T$。容量 = $c(v_5, t) = 12$。\n注意：$(v_4, v_5)$ 是一条从 $T$ 到 $S$ 的边，不计入割容量。\n最小割容量为 $8 + 4 + 12 = 24$，这与我们计算出的最大流相符。\n\n为了将最大流从 24 增加到 25，我们必须将这个最小割的容量增加 1。这可以通过增加割中某条正向边的容量来实现。\n问题要求升级*原始*网络中的单条边。这个割中来自原始网络的边是 $(v_1, v_4)$ 和 $(v_3, v_6)$。\n\n将这些原始边中任意一条的容量增加一个量 $\\delta$，将使最小割容量增加 $\\delta$。为了弥补 $\\Delta=1$ 的流量亏空，我们需要将这样一条边的容量至少增加 1。因此，所需的最小整数增量是 1。例如，将 $c(v_1, v_4)$ 从 8 增加到 9 将使新的最小割容量变为 $9+4+12=25$，从而允许可行流。", "answer": "$$\\boxed{1}$$", "id": "1488582"}]}