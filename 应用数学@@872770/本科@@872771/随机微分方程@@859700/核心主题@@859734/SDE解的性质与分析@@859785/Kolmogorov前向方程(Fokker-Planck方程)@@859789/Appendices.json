{"hands_on_practices": [{"introduction": "科尔莫戈罗夫前向方程，也称作福克-普朗克方程，是描述概率密度演化的核心。本练习将引导你通过寻找伊藤扩散的无穷小生成元 $L$ 的形式伴随算子 $L^*$，来推导该方程的基本算子形式。掌握这个推导过程 [@problem_id:3063166] 是理解该方程数学起源及其与底层随机过程联系的关键。", "problem": "考虑一个在 $\\mathbb{R}^{d}$ 上的伊藤扩散，由随机微分方程 $dX_{t} = b(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t}$ 定义，其中 $b : \\mathbb{R}^{d} \\to \\mathbb{R}^{d}$ 是一个连续可微的漂移场，$\\sigma : \\mathbb{R}^{d} \\to \\mathbb{R}^{d \\times m}$ 是一个连续可微的扩散矩阵，$W_{t}$ 是一个标准的 $m$ 维维纳过程。令 $a(x) = \\sigma(x)\\sigma(x)^{\\top}$ 表示扩散（协方差）矩阵，其元素为 $a_{ij}(x)$。该扩散的无穷小生成元 $L$ 作用于一个二次连续可微的紧支集检验函数 $f : \\mathbb{R}^{d} \\to \\mathbb{R}$，其形式为 $Lf(x) = b(x)\\cdot \\nabla f(x) + \\frac{1}{2}\\sum_{i,j=1}^{d} a_{ij}(x)\\,\\partial_{x_{i}}\\partial_{x_{j}} f(x)$。\n\n定义关于勒贝格内积的形式伴随算子 $L^{\\ast}$，使得对于所有足够光滑且快速衰减的函数 $f, p : \\mathbb{R}^{d} \\to \\mathbb{R}$，\n$$\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} f(x)\\,L^{\\ast}p(x)\\,dx,$$\n在边界项因在无穷远处衰减而消失的假设下成立。从上述核心定义出发，仅使用分部积分和标准向量微积分，推导 $L^{\\ast}p(x)$ 关于 $b(x)$、$a_{ij}(x)$ 及其空间导数的显式表达式。将你的最终结果以关于 $x$ 的单一闭式解析表达式形式呈现。不需要进行数值近似。", "solution": "用户希望找到无穷小生成元 $L$ 的形式伴随算子 $L^{\\ast}$ 的显式表达式。\n\n### 第一步：提取已知条件\n- 伊藤扩散: $dX_{t} = b(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t}$\n- 定义域: $\\mathbb{R}^{d}$\n- 漂移场: $b : \\mathbb{R}^{d} \\to \\mathbb{R}^{d}$, 连续可微。\n- 扩散矩阵: $\\sigma : \\mathbb{R}^{d} \\to \\mathbb{R}^{d \\times m}$, 连续可微。\n- 维纳过程: $W_{t}$ 是一个标准的 $m$ 维维纳过程。\n- 扩散（协方差）矩阵: $a(x) = \\sigma(x)\\sigma(x)^{\\top}$，其分量为 $a_{ij}(x)$。\n- 无穷小生成元: $Lf(x) = b(x)\\cdot \\nabla f(x) + \\frac{1}{2}\\sum_{i,j=1}^{d} a_{ij}(x)\\,\\partial_{x_{i}}\\partial_{x_{j}} f(x)$。\n- $f$ 的检验函数空间：从 $\\mathbb{R}^{d}$ 到 $\\mathbb{R}$ 的二次连续可微、紧支集函数。\n- 形式伴随算子 $L^{\\ast}$ 的定义：对于足够光滑且快速衰减的函数 $f, p : \\mathbb{R}^{d} \\to \\mathbb{R}$，伴随算子 $L^{\\ast}$ 满足关系式 $\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} f(x)\\,L^{\\ast}p(x)\\,dx$。\n- 假设：由于函数在无穷远处快速衰减，在 $\\mathbb{R}^{d}$ 上进行分部积分所产生的边界项为零。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据：**该问题是随机微分方程理论和数学物理中的一个标准、基础的推导。无穷小生成元及其伴随算子（福克-普朗克算子）是经典概念。\n- **适定性：**问题陈述清晰，提供了所有必要的定义和条件。任务是执行一个确定的数学推导，从而得出一个唯一的表达式。\n- **客观性：**问题以精确、客观的数学语言表述。\n- **无效性检查清单：**\n    - 问题不违反任何科学原理；它是一个核心的理论练习。\n    - 它与科尔莫戈罗夫前向方程的主题直接相关。\n    - 所提供的信息是完整和一致的。\n    - 问题是纯数学的，不存在物理上不可行的问题。\n    - 问题是适定的，并能得出一个唯一的、有意义的结果。\n    - 该推导并非无足轻重，它展示了该领域中的一个关键关系。\n    - 结果在数学上是可验证的。\n\n### 第三步：结论与行动\n问题是有效的。现在将按要求推导算子 $L^{\\ast}$。\n\n我们从形式伴随算子 $L^{\\ast}$ 的定义关系式开始：\n$$\n\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} f(x)\\,L^{\\ast}p(x)\\,dx\n$$\n我们将无穷小生成元 $L$ 的表达式代入方程的左边。为清晰起见，我们将点积明确地写为分量之和，其中 $b(x) = (b_1(x), \\dots, b_d(x))$ 且 $\\nabla f(x) = (\\partial_{x_1}f(x), \\dots, \\partial_{x_d}f(x))$，并使用符号 $\\partial_{x_i}$ 表示偏导数 $\\frac{\\partial}{\\partial x_i}$。\n$$\n\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} p(x) \\left( \\sum_{i=1}^{d} b_i(x) \\partial_{x_i} f(x) + \\frac{1}{2}\\sum_{i,j=1}^{d} a_{ij}(x)\\,\\partial_{x_i}\\partial_{x_j} f(x) \\right) dx\n$$\n我们可以将这个积分分成对应于漂移项和扩散项的两部分：\n$$\n\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\underbrace{\\int_{\\mathbb{R}^{d}} \\sum_{i=1}^{d} p(x) b_i(x) \\partial_{x_i} f(x) \\,dx}_{\\text{漂移项}} + \\underbrace{\\int_{\\mathbb{R}^{d}} \\frac{1}{2}\\sum_{i,j=1}^{d} p(x) a_{ij}(x) \\partial_{x_i}\\partial_{x_j} f(x) \\,dx}_{\\text{扩散项}}\n$$\n我们的目标是使用分部积分将所有作用于 $f(x)$ 的导数转移到其他项上，从而在被积函数中将 $f(x)$ 作为公因子分离出来。无穷远处边界项的消失至关重要，这一点由 $f$ 和 $p$ 是光滑且快速衰减的函数（例如，$f$ 是紧支集函数）的假设所保证。\n\n我们首先分析漂移项。对于和中的每个分量 $i$，我们对变量 $x_i$ 进行分部积分：\n$$\n\\int_{\\mathbb{R}^{d}} p(x) b_i(x) \\partial_{x_i} f(x) \\,dx = - \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_i} [p(x) b_i(x)] \\,dx\n$$\n对所有 $i$ 从 $1$到 $d$ 求和，漂移项变为：\n$$\n\\int_{\\mathbb{R}^{d}} \\sum_{i=1}^{d} p(x) b_i(x) \\partial_{x_i} f(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\left( - \\sum_{i=1}^{d} \\partial_{x_i} [p(x) b_i(x)] \\right) dx\n$$\n现在，我们来分析扩散项。这需要对和中的每个 $(i, j)$ 对应用两次分部积分。\n$$\n\\frac{1}{2}\\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^{d}} p(x) a_{ij}(x) \\partial_{x_i}\\partial_{x_j} f(x) \\,dx = \\frac{1}{2}\\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^{d}} [p(x) a_{ij}(x)] [\\partial_{x_i}\\partial_{x_j} f(x)] \\,dx\n$$\n首先，我们对 $x_j$ 进行分部积分，将导数 $\\partial_{x_j}$ 从 $f(x)$ 转移到项 $p(x) a_{ij}(x)$ 上：\n$$\n\\int_{\\mathbb{R}^{d}} [p(x) a_{ij}(x)] \\partial_{x_j}(\\partial_{x_i} f(x)) \\,dx = - \\int_{\\mathbb{R}^{d}} [\\partial_{x_j}(p(x) a_{ij}(x))] [\\partial_{x_i} f(x)] \\,dx\n$$\n接下来，我们对 $x_i$ 进行分部积分，将剩余的导数 $\\partial_{x_i}$ 从 $f(x)$ 移开：\n$$\n- \\int_{\\mathbb{R}^{d}} [\\partial_{x_i} f(x)] [\\partial_{x_j}(p(x) a_{ij}(x))] \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_i}[\\partial_{x_j}(p(x) a_{ij}(x))] \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_i}\\partial_{x_j} [p(x) a_{ij}(x)] \\,dx\n$$\n将此结果代回和中，扩散项变为：\n$$\n\\int_{\\mathbb{R}^{d}} \\frac{1}{2}\\sum_{i,j=1}^{d} p(x) a_{ij}(x) \\partial_{x_i}\\partial_{x_j} f(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\left( \\frac{1}{2}\\sum_{i,j=1}^{d} \\partial_{x_i}\\partial_{x_j}[p(x) a_{ij}(x)] \\right) dx\n$$\n结合处理后的漂移项和扩散项，我们得到：\n$$\n\\int_{\\mathbb{R}^{d}} p(x) Lf(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\left( - \\sum_{i=1}^{d} \\partial_{x_i}[p(x) b_i(x)] + \\frac{1}{2}\\sum_{i,j=1}^{d} \\partial_{x_i}\\partial_{x_j}[p(x) a_{ij}(x)] \\right) dx\n$$\n通过将此结果与定义关系式 $\\int_{\\mathbb{R}^{d}} p(x) Lf(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) L^{\\ast}p(x) \\,dx$ 进行比较，我们可以直接确定 $L^{\\ast}$ 作用于 $p(x)$ 的表达式：\n$$\nL^{\\ast}p(x) = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} [b_i(x)p(x)] + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} [a_{ij}(x)p(x)]\n$$\n这个表达式是科尔莫戈罗夫前向方程的算子，也称为福克-普朗克算子。它通过偏微分方程 $\\partial_t p = L^{\\ast}p$ 描述了随机过程 $X_t$ 的概率密度函数 $p(x,t)$ 的时间演化。", "answer": "$$\\boxed{L^{\\ast}p(x) = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} [b_i(x)p(x)] + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} [a_{ij}(x)p(x)]}$$", "id": "3063166"}, {"introduction": "一旦我们掌握了前向方程的一般形式，就可以将其应用于具体的物理系统。奥恩斯坦-乌伦贝克过程是描述诸如谐波势阱中的粒子或均值回归的金融资产等现象的基石模型。本练习 [@problem_id:3063158] 将指导你使用傅里叶变换求解该过程的方程，揭示漂移和扩散的相互作用如何塑造概率分布随时间的演变。", "problem": "考虑由伊藤随机微分方程 $dX_{t} = -\\gamma X_{t}\\,dt + \\sqrt{2D}\\,dW_{t}$ 定义的奥恩斯坦-乌伦贝克 (OU) 过程，其中常数 $\\gamma  0$ 和 $D  0$，$W_{t}$ 是标准维纳过程，初始条件为 $X_{0} = x_{0}$。令 $p(x,t)$ 表示 $X_{t}$ 的转移概率密度，使得 $p(x,t)\\,dx = \\mathbb{P}\\{X_{t} \\in dx\\}$，并定义特征函数（等价于 $p$ 的空间傅里叶变换）为 $\\hat{p}(k,t) = \\int_{-\\infty}^{\\infty} \\exp(i k x)\\,p(x,t)\\,dx$。\n\n从伊藤随机微分方程出发，利用无穷小生成元的定义和概率守恒，推导 $p(x,t)$ 满足的科尔莫戈罗夫前向（福克-普朗克）方程。然后，对该偏微分方程进行空间傅里叶变换，以获得 $\\hat{p}(k,t)$ 的演化方程，并使用特征线法在初始条件 $p(x,0) = \\delta(x - x_{0})$ 下求解该方程，其中 $\\delta$ 是狄拉克 delta 分布。解释漂移项和扩散项如何在波数空间中控制特征函数的演化。\n\n您的最终任务是为任意 $t \\geq 0$ 时的特征函数 $\\hat{p}(k,t)$ 提供一个单一的闭式解析表达式。不需要数值近似，最终表达式中不涉及单位。", "solution": "该问题被评估为有效。它在科学上基于随机微分方程理论，特别是关于奥恩斯坦-乌伦贝克过程及其相关的科尔莫戈罗夫前向（福克-普朗克）方程。该问题是适定的，具有明确的目标和足以确定唯一解的初始条件。术语精确，所要求的步骤构成了该领域的标准逻辑程序。\n\n该问题要求几个步骤：首先，推导福克-普朗克方程；其次，对其进行傅里叶变换；第三，求解得到的关于特征函数 $\\hat{p}(k,t)$ 的方程；最后，解释漂移项和扩散项的作用。\n\n**1. 福克-普朗克方程的推导**\n\n奥恩斯坦-乌伦贝克过程由伊藤随机微分方程 (SDE) 描述：\n$$dX_{t} = -\\gamma X_{t}\\,dt + \\sqrt{2D}\\,dW_{t}$$\n过程 $X_t$ 的概率密度函数 $p(x,t)$ 的演化由科尔莫戈罗夫前向方程（也称为福克-普朗克方程）控制。\n\n一般的推导从概率守恒开始，表示为连续性方程：\n$$\\frac{\\partial p(x,t)}{\\partial t} + \\frac{\\partial J(x,t)}{\\partial x} = 0$$\n其中 $J(x,t)$ 是概率流。对于由上述 SDE 描述的随机过程，流由下式给出：\n$$J(x,t) = A_{1}(x) p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} [A_{2}(x) p(x,t)]$$\n系数 $A_{1}(x)$ 和 $A_{2}(x)$ 是第一和第二 Kramers–Moyal 系数，定义为过程增量的无穷小均值和方差：\n$$A_{1}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[\\Delta X_{t} | X_{t}=x]$$\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(\\Delta X_{t})^{2} | X_{t}=x]$$\n其中 $\\Delta X_{t} = X_{t+\\Delta t} - X_{t}$。根据 SDE，对于小的时间步长 $\\Delta t$，增量为 $\\Delta X_t \\approx -\\gamma x \\Delta t + \\sqrt{2D} \\Delta W_t$，其中 $\\Delta W_t = W_{t+\\Delta t} - W_t$。维纳过程的增量具有性质 $\\mathbb{E}[\\Delta W_{t}] = 0$ 和 $\\mathbb{E}[(\\Delta W_{t})^{2}] = \\Delta t$。\n\n计算 $A_{1}(x)$:\n$$A_{1}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[-\\gamma x \\Delta t + \\sqrt{2D} \\Delta W_{t}] = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} (-\\gamma x \\Delta t) = -\\gamma x$$\n计算 $A_{2}(x)$:\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(-\\gamma x \\Delta t + \\sqrt{2D} \\Delta W_{t})^{2}]$$\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(\\gamma x)^{2}(\\Delta t)^{2} - 2\\gamma x \\sqrt{2D} \\Delta t \\Delta W_{t} + 2D (\\Delta W_{t})^{2}]$$\n使用期望的线性性并忽略比 $\\Delta t$ 更高阶的项：\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} [(\\gamma x)^{2}(\\Delta t)^{2} - 0 + 2D \\Delta t] = \\lim_{\\Delta t \\to 0} [(\\gamma x)^{2}\\Delta t + 2D] = 2D$$\n将这些系数代回流 $J(x,t)$ 的表达式中：\n$$J(x,t) = (-\\gamma x) p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} [2D p(x,t)] = -\\gamma x p(x,t) - D \\frac{\\partial p(x,t)}{\\partial x}$$\n于是福克-普朗克方程为 $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$：\n$$\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left(-\\gamma x p(x,t) - D \\frac{\\partial p(x,t)}{\\partial x}\\right)$$\n$$\\frac{\\partial p(x,t)}{\\partial t} = \\gamma \\frac{\\partial}{\\partial x}[x p(x,t)] + D \\frac{\\partial^{2}p(x,t)}{\\partial x^{2}}$$\n这就是所求的奥恩斯坦-乌伦贝克过程的福克-普朗克方程。\n\n**2. 福克-普朗克方程的傅里叶变换**\n\n特征函数 $\\hat{p}(k,t)$ 是 $p(x,t)$ 的空间傅里叶变换，定义为：\n$$\\hat{p}(k,t) = \\mathcal{F}[p(x,t)] = \\int_{-\\infty}^{\\infty} \\exp(ikx) p(x,t) dx$$\n我们将此变换应用于福克-普朗克方程。对于给定的定义，必要的变换性质是：\n$$\\mathcal{F}\\left[\\frac{\\partial^{n} f}{\\partial x^{n}}\\right] = (-ik)^{n} \\hat{f}(k)$$\n关于变换约定有一个微妙之处。问题中给出的是 $\\exp(ikx)$。我们来验证 $\\mathcal{F}[xf(x)]$ 的规则。\n$\\frac{d\\hat{p}}{dk} = \\frac{d}{dk}\\int \\exp(ikx)p(x,t)dx = \\int ix \\exp(ikx)p(x,t) dx = i\\mathcal{F}[xp]$。所以 $\\mathcal{F}[xp] = \\frac{1}{i}\\frac{d\\hat{p}}{dk} = -i\\frac{d\\hat{p}}{dk}$。\n那么，$\\mathcal{F}\\left[\\frac{\\partial}{\\partial x}(x p)\\right] = (-ik)\\mathcal{F}[x p] = (-ik)\\left(-i \\frac{\\partial \\hat{p}}{\\partial k}\\right) = -k \\frac{\\partial \\hat{p}}{\\partial k}$。\n\n逐项变换福克-普朗克方程：\n$$\\mathcal{F}\\left[\\frac{\\partial p}{\\partial t}\\right] = \\frac{\\partial \\hat{p}}{\\partial t}$$\n$$\\mathcal{F}\\left[\\gamma \\frac{\\partial}{\\partial x}(x p)\\right] = \\gamma \\left(-k \\frac{\\partial \\hat{p}}{\\partial k}\\right)$$\n$$\\mathcal{F}\\left[D \\frac{\\partial^{2}p}{\\partial x^{2}}\\right] = D(-ik)^{2}\\hat{p} = -Dk^{2}\\hat{p}$$\n将这些结果结合起来，得到特征函数的演化方程：\n$$\\frac{\\partial \\hat{p}(k,t)}{\\partial t} = -\\gamma k \\frac{\\partial \\hat{p}(k,t)}{\\partial k} - Dk^{2}\\hat{p}(k,t)$$\n\n**3. 特征函数的求解**\n\n我们使用特征线法求解这个一阶线性偏微分方程。该方程为：\n$$\\frac{\\partial \\hat{p}}{\\partial t} + \\gamma k \\frac{\\partial \\hat{p}}{\\partial k} = -Dk^{2}\\hat{p}$$\n特征方程为：\n$$\\frac{dt}{1} = \\frac{dk}{\\gamma k} = \\frac{d\\hat{p}}{-Dk^{2}\\hat{p}}$$\n从第一个等式，$\\frac{dk}{dt} = \\gamma k$。积分得到特征曲线 $k(t) = k_{0} \\exp(\\gamma t)$，其中 $k_{0}$ 是 $k$ 在 $t=0$ 时的值。\n沿着这些曲线，$\\hat{p}$ 的演化由 $\\frac{d\\hat{p}}{dt} = -Dk^{2}\\hat{p}$ 给出。代入 $k(t)$：\n$$\\frac{d\\hat{p}}{dt} = -D(k_{0}\\exp(\\gamma t))^{2}\\hat{p} = -Dk_{0}^{2}\\exp(2\\gamma t)\\hat{p}$$\n这是一个关于 $\\hat{p}(t) = \\hat{p}(k(t),t)$ 的可分离常微分方程：\n$$\\int_{\\hat{p}(k_0,0)}^{\\hat{p}(k(t),t)} \\frac{d\\hat{p}'}{\\hat{p}'} = \\int_{0}^{t} -Dk_{0}^{2}\\exp(2\\gamma \\tau) d\\tau$$\n$$\\ln\\left(\\frac{\\hat{p}(k(t),t)}{\\hat{p}(k_{0},0)}\\right) = -Dk_{0}^{2} \\left[\\frac{\\exp(2\\gamma \\tau)}{2\\gamma}\\right]_{0}^{t} = -\\frac{Dk_{0}^{2}}{2\\gamma}(\\exp(2\\gamma t)-1)$$\n$$\\hat{p}(k(t),t) = \\hat{p}(k_{0},0) \\exp\\left(-\\frac{Dk_{0}^{2}}{2\\gamma}(\\exp(2\\gamma t)-1)\\right)$$\n为了得到以 $(k,t)$ 表示的解，我们使用特征曲线方程将 $k_0$ 表示为 $k$ 和 $t$ 的函数：$k_{0} = k \\exp(-\\gamma t)$。\n将此代入解中得到：\n$$\\hat{p}(k,t) = \\hat{p}(k\\exp(-\\gamma t),0) \\exp\\left(-\\frac{D(k\\exp(-\\gamma t))^{2}}{2\\gamma}(\\exp(2\\gamma t)-1)\\right)$$\n化简指数部分：\n$$-\\frac{Dk^{2}\\exp(-2\\gamma t)}{2\\gamma}(\\exp(2\\gamma t)-1) = -\\frac{Dk^{2}}{2\\gamma}(\\exp(0) - \\exp(-2\\gamma t)) = -\\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))$$\n因此，通解为：\n$$\\hat{p}(k,t) = \\hat{p}(k\\exp(-\\gamma t), 0) \\exp\\left(-\\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)$$\n初始条件为 $p(x,0) = \\delta(x - x_{0})$。其傅里叶变换为：\n$$\\hat{p}(k,0) = \\int_{-\\infty}^{\\infty} \\exp(ikx) \\delta(x - x_{0}) dx = \\exp(ikx_{0})$$\n我们需要 $\\hat{p}(k',0)$，其中 $k' = k\\exp(-\\gamma t)$：\n$$\\hat{p}(k\\exp(-\\gamma t), 0) = \\exp(i(k\\exp(-\\gamma t))x_{0}) = \\exp(ikx_{0}\\exp(-\\gamma t))$$\n将此代入通解中，得到特征函数的最终表达式：\n$$\\hat{p}(k,t) = \\exp(ikx_{0}\\exp(-\\gamma t)) \\exp\\left(-\\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)$$\n这可以写成一个单一的指数形式：\n$$\\hat{p}(k,t) = \\exp\\left(ikx_{0}\\exp(-\\gamma t) - \\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)$$\n\n**4. 解释**\n\n均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布的特征函数是 $\\exp(ik\\mu - \\frac{1}{2}k^{2}\\sigma^{2})$。通过将我们的结果 $\\hat{p}(k,t)$ 与此规范形式进行比较，我们可以确定奥恩斯坦-乌伦贝克过程随时间变化的均值和方差：\n$$\\mu(t) = x_{0}\\exp(-\\gamma t)$$\n$$\\sigma^{2}(t) = \\frac{D}{\\gamma}(1 - \\exp(-2\\gamma t))$$\n演化方程 $\\frac{\\partial \\hat{p}}{\\partial t} = -\\gamma k \\frac{\\partial \\hat{p}}{\\partial k} - Dk^{2}\\hat{p}$ 揭示了漂移和扩散在傅里叶（波数）空间中的作用。\n- SDE中的**漂移项** $-\\gamma X_t dt$ 导致了演化方程中的项 $-\\gamma k \\frac{\\partial \\hat{p}}{\\partial k}$。这是 $k$ 空间中的一个平流项，引起波数的“流动”。它主要影响 $\\hat{p}(k,t)$ 的相位，这对应于 $p(x,t)$ 的均值。解表明均值 $\\mu(t)$ 以速率 $\\gamma$ 指数衰减到 $0$，表示粒子被拉向原点。\n- SDE中的**扩散项** $\\sqrt{2D} dW_t$ 导致了项 $-Dk^{2}\\hat{p}$。这是 $k$ 空间中的一个阻尼项，对于更大的 $|k|$（更高频率）作用更强。这种阻尼对应于实空间中概率分布 $p(x,t)$ 的平滑化，即其扩散性展宽。该项控制着 $|\\hat{p}(k,t)|$ 的幅值，而幅值由方差 $\\sigma^2(t)$ 决定。方差从 $0$ 开始增长，并渐近趋近于稳态值 $D/\\gamma$，代表了扩散性展宽与限制性漂移之间的平衡。", "answer": "$$\\boxed{\\exp\\left(ikx_{0}\\exp(-\\gamma t) - \\frac{Dk^{2}}{2\\gamma}\\left(1 - \\exp(-2\\gamma t)\\right)\\right)}$$", "id": "3063158"}, {"introduction": "许多系统会演化到一个宏观性质恒定的平稳态，但这个状态未必是真正的热力学平衡态。本练习 [@problem_id:3063143] 探讨了这样一个非平衡定常态，其中细致平衡条件的破坏导致了持续存在的循环概率流。通过分析一个二维旋转系统，你将学会识别和量化这些作为系统被主动驱动远离平衡态标志的概率流。", "problem": "考虑二维随机微分方程 (SDE)\n$$\nd\\mathbf{X}_t=\\left(-k\\,\\mathbf{X}_t+\\Omega\\,R\\,\\mathbf{X}_t\\right)dt+\\sqrt{2D}\\,d\\mathbf{W}_t,\n$$\n其中 $\\mathbf{X}_t\\in\\mathbb{R}^2$，$k0$ 和 $D0$ 是常数，$\\Omega\\in\\mathbb{R}$，$\\mathbf{W}_t$ 是标准的二维维纳过程，而 $R$ 是常数反对称矩阵\n$$\nR=\\begin{pmatrix}\n0  -1\\\\\n1  \\phantom{-}0\n\\end{pmatrix}.\n$$\n漂移场为 $\\mathbf{a}(\\mathbf{x})=-k\\,\\mathbf{x}+\\Omega\\,R\\,\\mathbf{x}$，扩散是各向同性的，系数为 $D$。\n\n从上述 SDE 相关的概率密度 $p(\\mathbf{x},t)$ 的柯尔莫哥洛夫前向方程（也称为福克-普朗克方程）出发，完成以下任务：\n\n1. 推导平稳（不依赖于时间）密度 $p_{\\infty}(\\mathbf{x})$ 并确定其协方差矩阵。你可以假设平稳密度（如果存在）以原点为中心并且是可归一化的。\n\n2. 用平稳概率流 $\\mathbf{J}_{\\infty}(\\mathbf{x})$ 陈述细致平衡的条件，并根据 $\\mathbf{a}(\\mathbf{x})$ 的形式解释为什么当 $\\Omega=0$ 时细致平衡成立，而当 $\\Omega\\neq 0$ 时不成立。\n\n3. 计算平稳概率流 $\\mathbf{J}_{\\infty}(\\mathbf{x})$，并证明当 $\\Omega\\neq 0$ 时，其流线是以原点为中心的圆。\n\n4. 定义循环概率流的标量度量\n$$\nJ_{\\infty}:=\\int_{\\mathbb{R}^2}\\left(x_1\\,J_{\\infty,y}(\\mathbf{x})-x_2\\,J_{\\infty,x}(\\mathbf{x})\\right)\\,d^2\\mathbf{x},\n$$\n其中 $J_{\\infty,x}$ 和 $J_{\\infty,y}$ 是 $\\mathbf{J}_{\\infty}(\\mathbf{x})$ 的笛卡尔分量，$d^2\\mathbf{x}$ 表示 $\\mathbb{R}^2$ 上的勒贝格测度。以 $k$、$\\Omega$ 和 $D$ 的函数形式，计算 $J_{\\infty}$ 的闭式解。\n\n将你的最终答案表示为单个解析表达式。无需四舍五入。", "solution": "用户要求我分析一个二维随机微分方程 (SDE)，从相应的柯尔莫哥洛夫前向方程（福克-普朗克方程）推导其平稳态的性质，并计算一个平稳概率流的度量。\n\nSDE 由以下公式给出：\n$$\nd\\mathbf{X}_t=\\left(-k\\,\\mathbf{X}_t+\\Omega\\,R\\,\\mathbf{X}_t\\right)dt+\\sqrt{2D}\\,d\\mathbf{W}_t\n$$\n这是一个线性 SDE，形式为 $d\\mathbf{X}_t = A\\mathbf{X}_t dt + B d\\mathbf{W}_t$，其中状态是 $\\mathbf{X}_t = (x_1, x_2)^T \\in \\mathbb{R}^2$，漂移矩阵是 $A = -kI + \\Omega R$，扩散矩阵由 $B = \\sqrt{2D}I$ 指定。矩阵 $R = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$ 实现逆时针旋转 $\\pi/2$。具体来说，漂移矩阵是：\n$$\nA = \\begin{pmatrix} -k  -\\Omega \\\\ \\Omega  -k \\end{pmatrix}\n$$\n福克-普朗克方程的扩散张量由 $D_{ij} = \\frac{1}{2}(BB^T)_{ij}$ 给出，在这种情况下是 $D \\delta_{ij}$。扩散是各向同性的，系数为 $D$。\n\n概率密度 $p(\\mathbf{x}, t)$ 的柯尔莫哥洛夫前向方程（福克-普朗克方程）是：\n$$\n\\frac{\\partial p(\\mathbf{x}, t)}{\\partial t} = -\\nabla \\cdot \\mathbf{J}(\\mathbf{x}, t)\n$$\n其中 $\\mathbf{J}(\\mathbf{x}, t)$ 是概率流，定义为：\n$$\n\\mathbf{J}(\\mathbf{x}, t) = \\mathbf{a}(\\mathbf{x})p(\\mathbf{x}, t) - D\\nabla p(\\mathbf{x}, t)\n$$\n而 $\\mathbf{a}(\\mathbf{x}) = A\\mathbf{x}$ 是漂移场。\n\n**1. 平稳密度和协方差矩阵**\n\n平稳密度 $p_{\\infty}(\\mathbf{x})$ 是福克-普朗克方程的不依赖于时间的解，它满足 $\\frac{\\partial p}{\\partial t} = 0$。这意味着平稳概率流 $\\mathbf{J}_{\\infty}(\\mathbf{x})$ 的散度必须为零：\n$$\n\\nabla \\cdot \\mathbf{J}_{\\infty}(\\mathbf{x}) = \\nabla \\cdot (\\mathbf{a}(\\mathbf{x}) p_{\\infty}(\\mathbf{x}) - D \\nabla p_{\\infty}(\\mathbf{x})) = 0\n$$\n对于具有恒定扩散的线性 SDE，平稳分布（如果存在）是多元高斯分布。问题陈述假设其中心在原点，这与漂移仅在 $\\mathbf{x}=\\mathbf{0}$ 时为零的情况一致。我们可以通过求解连续时间李雅普诺夫方程来找到其协方差矩阵 $C = \\langle \\mathbf{X}_t \\mathbf{X}_t^T \\rangle_{\\infty}$：\n$$\nAC + CA^T + 2D I = 0\n$$\n这里，$A = \\begin{pmatrix} -k  -\\Omega \\\\ \\Omega  -k \\end{pmatrix}$，$A^T = \\begin{pmatrix} -k  \\Omega \\\\ -\\Omega  -k \\end{pmatrix}$，并且 $I$ 是 $2 \\times 2$ 单位矩阵。设 $C = \\begin{pmatrix} c_{11}  c_{12} \\\\ c_{21}  c_{22} \\end{pmatrix}$ 为对称协方差矩阵（$c_{12}=c_{21}$）。\n\n李雅普诺夫方程展开为：\n$$\n\\begin{pmatrix} -k  -\\Omega \\\\ \\Omega  -k \\end{pmatrix}\\begin{pmatrix} c_{11}  c_{12} \\\\ c_{12}  c_{22} \\end{pmatrix} + \\begin{pmatrix} c_{11}  c_{12} \\\\ c_{12}  c_{22} \\end{pmatrix}\\begin{pmatrix} -k  \\Omega \\\\ -\\Omega  -k \\end{pmatrix} + \\begin{pmatrix} 2D  0 \\\\ 0  2D \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n进行矩阵乘法，得到关于 $C$ 的分量的线性方程组：\n$$\n\\begin{pmatrix} -2kc_{11}-2\\Omega c_{12}  -kc_{12}-\\Omega c_{22} -kc_{12}+\\Omega c_{11} \\\\ \\Omega c_{11}-k c_{12} -kc_{12}-\\Omega c_{22}  2\\Omega c_{12}-2k c_{22} \\end{pmatrix} + \\begin{pmatrix} 2D  0 \\\\ 0  2D \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n这给出了以下方程：\n1.  $-2kc_{11} - 2\\Omega c_{12} + 2D = 0 \\implies -kc_{11} - \\Omega c_{12} + D = 0$\n2.  $-2kc_{22} + 2\\Omega c_{12} + 2D = 0 \\implies -kc_{22} + \\Omega c_{12} + D = 0$\n3.  $\\Omega(c_{11}-c_{22}) - 2k c_{12} = 0$\n\n从(1)和(2)，我们表示 $c_{11}$ 和 $c_{22}$：\n$c_{11} = \\frac{D-\\Omega c_{12}}{k}$ 和 $c_{22} = \\frac{D+\\Omega c_{12}}{k}$。\n将这些代入(3)：\n$$\n\\Omega\\left(\\frac{D-\\Omega c_{12}}{k} - \\frac{D+\\Omega c_{12}}{k}\\right) - 2k c_{12} = 0\n$$\n$$\n\\Omega\\left(-\\frac{2\\Omega c_{12}}{k}\\right) - 2k c_{12} = 0\n$$\n$$\n-2\\left(\\frac{\\Omega^2}{k} + k\\right)c_{12} = -2\\left(\\frac{\\Omega^2+k^2}{k}\\right)c_{12} = 0\n$$\n因为 $k0$，项 $\\frac{\\Omega^2+k^2}{k}$ 是严格为正的。因此，我们必须有 $c_{12} = 0$。\n当 $c_{12}=0$ 时，我们得到 $c_{11}=D/k$ 和 $c_{22}=D/k$。\n协方差矩阵是对角的且各向同性的：\n$$\nC = \\begin{pmatrix} D/k  0 \\\\ 0  D/k \\end{pmatrix} = \\frac{D}{k}I\n$$\n平稳概率密度 $p_{\\infty}(\\mathbf{x})$ 是具有此协方差的零均值高斯分布。逆协方差是 $C^{-1} = \\frac{k}{D}I$。\n$$\np_{\\infty}(\\mathbf{x}) = \\frac{1}{\\sqrt{(2\\pi)^2 \\det(C)}} \\exp\\left(-\\frac{1}{2}\\mathbf{x}^T C^{-1} \\mathbf{x}\\right) = \\frac{1}{2\\pi (D/k)} \\exp\\left(-\\frac{k}{2D}\\mathbf{x}^T\\mathbf{x}\\right)\n$$\n$$\np_{\\infty}(\\mathbf{x}) = \\frac{k}{2\\pi D} \\exp\\left(-\\frac{k(x_1^2+x_2^2)}{2D}\\right)\n$$\n\n**2. 细致平衡**\n\n细致平衡是平稳系统的一个条件，即对于任意一对状态，从状态 A 跃迁到状态 B 的速率等于从状态 B 跃迁到状态 A 的速率。在由福克-普朗克方程描述的连续随机过程中，如果平稳概率流 $\\mathbf{J}_{\\infty}(\\mathbf{x})$ 对所有 $\\mathbf{x}$ 都恒等于零，则细致平衡成立。\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\mathbf{0}\n$$\n我们来计算 $\\mathbf{J}_{\\infty}(\\mathbf{x})$。首先，我们计算 $p_{\\infty}(\\mathbf{x})$ 的梯度：\n$$\n\\nabla p_{\\infty}(\\mathbf{x}) = \\nabla \\left( \\frac{k}{2\\pi D} \\exp\\left(-\\frac{k|\\mathbf{x}|^2}{2D}\\right) \\right) = p_{\\infty}(\\mathbf{x}) \\left(-\\frac{k}{2D} \\nabla(|\\mathbf{x}|^2)\\right) = p_{\\infty}(\\mathbf{x}) \\left(-\\frac{k}{D} \\mathbf{x}\\right)\n$$\n平稳流是：\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\mathbf{a}(\\mathbf{x})p_{\\infty}(\\mathbf{x}) - D\\nabla p_{\\infty}(\\mathbf{x}) = \\mathbf{a}(\\mathbf{x})p_{\\infty}(\\mathbf{x}) - D\\left(-\\frac{k}{D}\\mathbf{x}\\, p_{\\infty}(\\mathbf{x})\\right)\n$$\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = (\\mathbf{a}(\\mathbf{x}) + k\\mathbf{x}) p_{\\infty}(\\mathbf{x})\n$$\n代入 $\\mathbf{a}(\\mathbf{x}) = -k\\mathbf{x} + \\Omega R \\mathbf{x}$：\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = (-k\\mathbf{x} + \\Omega R \\mathbf{x} + k\\mathbf{x}) p_{\\infty}(\\mathbf{x}) = \\Omega R \\mathbf{x}\\,p_{\\infty}(\\mathbf{x})\n$$\n-   当 $\\Omega=0$ 时，$\\mathbf{J}_{\\infty}(\\mathbf{x}) = 0$ 对所有 $\\mathbf{x}$ 成立。因此，系统满足细致平衡。这是因为漂移场 $\\mathbf{a}(\\mathbf{x})=-k\\mathbf{x}$ 是一个梯度场，$\\mathbf{a}(\\mathbf{x}) = -\\nabla U(\\mathbf{x})$，其势为 $U(\\mathbf{x})=\\frac{1}{2}k|\\mathbf{x}|^2$。具有梯度漂移和恒定各向同性扩散的系统满足细致平衡。\n-   当 $\\Omega \\neq 0$ 时，$\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\Omega R \\mathbf{x}\\,p_{\\infty}(\\mathbf{x})$。由于对于 $\\mathbf{x}\\neq\\mathbf{0}$ 有 $R\\mathbf{x} = (-x_2, x_1)^T \\neq \\mathbf{0}$，且 $p_{\\infty}(\\mathbf{x})0$ 处处成立，所以流 $\\mathbf{J}_{\\infty}(\\mathbf{x})$ 是非零的（除了在原点）。因此，细致平衡被破坏。漂移场的部分 $\\Omega R \\mathbf{x}$ 是非保守的（具有非零旋度），这在平稳态下驱动持续的概率流。\n\n**3. 平稳流的流线**\n\n当 $\\Omega \\neq 0$ 时的平稳概率流是：\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\Omega R \\mathbf{x}\\,p_{\\infty}(\\mathbf{x}) = \\Omega \\begin{pmatrix} -x_2 \\\\ x_1 \\end{pmatrix} \\frac{k}{2\\pi D} \\exp\\left(-\\frac{k(x_1^2+x_2^2)}{2D}\\right)\n$$\n流线是一条曲线 $\\mathbf{r}(s)=(x_1(s), x_2(s))^T$，它处处与向量场 $\\mathbf{J}_{\\infty}(\\mathbf{x})$ 相切。在 $\\mathbf{x}$ 处的流方向由向量 $R\\mathbf{x} = (-x_2, x_1)^T$ 给出。我们来研究位置向量 $\\mathbf{x}=(x_1, x_2)^T$ 与流方向之间的关系。它们的点积是：\n$$\n\\mathbf{x} \\cdot (R\\mathbf{x}) = (x_1, x_2) \\cdot (-x_2, x_1) = -x_1 x_2 + x_2 x_1 = 0\n$$\n由于流向量总是与位置向量正交，流线必须是到原点距离恒定的曲线。这些是以原点为中心的圆。\n更正式地说，流线 $\\mathbf{r}(s)$ 满足 $\\frac{d\\mathbf{r}}{ds} \\propto \\mathbf{J}_\\infty(\\mathbf{r}(s))$，这意味着 $\\frac{d\\mathbf{r}}{ds}$ 平行于 $R\\mathbf{r}(s)$。\n考虑半径的平方 $|\\mathbf{r}(s)|^2 = x_1^2(s)+x_2^2(s)$:\n$$\n\\frac{d}{ds}|\\mathbf{r}(s)|^2 = 2\\mathbf{r}(s) \\cdot \\frac{d\\mathbf{r}}{ds}\n$$\n由于 $\\frac{d\\mathbf{r}}{ds}$ 平行于 $R\\mathbf{r}(s)$，并且我们证明了 $\\mathbf{r}(s) \\cdot (R\\mathbf{r}(s)) = 0$，因此可以得出 $\\frac{d}{ds}|\\mathbf{r}(s)|^2 = 0$。这意味着 $|\\mathbf{r}(s)|^2$ 沿着任何流线都是恒定的。因此，流线是以原点为中心的圆 $x_1^2+x_2^2=\\text{constant}$。\n\n**4. 标量流度量 $J_{\\infty}$ 的计算**\n\n该标量度量定义为：\n$$\nJ_{\\infty} := \\int_{\\mathbb{R}^2}\\left(x_1\\,J_{\\infty,y}(\\mathbf{x})-x_2\\,J_{\\infty,x}(\\mathbf{x})\\right)\\,d^2\\mathbf{x}\n$$\n流的分量是 $J_{\\infty,x}(\\mathbf{x}) = -\\Omega x_2 p_{\\infty}(\\mathbf{x})$ 和 $J_{\\infty,y}(\\mathbf{x}) = \\Omega x_1 p_{\\infty}(\\mathbf{x})$。将这些代入被积函数：\n$$\nx_1(\\Omega x_1 p_{\\infty}(\\mathbf{x})) - x_2(-\\Omega x_2 p_{\\infty}(\\mathbf{x})) = \\Omega x_1^2 p_{\\infty}(\\mathbf{x}) + \\Omega x_2^2 p_{\\infty}(\\mathbf{x}) = \\Omega(x_1^2+x_2^2)p_{\\infty}(\\mathbf{x})\n$$\n所以积分变为：\n$$\nJ_{\\infty} = \\int_{\\mathbb{R}^2} \\Omega(x_1^2+x_2^2) p_{\\infty}(\\mathbf{x})\\, d^2\\mathbf{x} = \\Omega \\int_{\\mathbb{R}^2} |\\mathbf{x}|^2 p_{\\infty}(\\mathbf{x})\\, d^2\\mathbf{x}\n$$\n积分 $\\int_{\\mathbb{R}^2} |\\mathbf{x}|^2 p_{\\infty}(\\mathbf{x})\\, d^2\\mathbf{x}$ 是平稳态下范数平方 $|\\mathbf{X}|^2$ 的期望值 $\\mathbb{E}[|\\mathbf{X}|^2]$。这等于协方差矩阵 $C$ 的迹。\n$$\n\\mathbb{E}[|\\mathbf{X}|^2] = \\mathbb{E}[X_1^2 + X_2^2] = \\mathbb{E}[X_1^2] + \\mathbb{E}[X_2^2] = c_{11} + c_{22} = \\mathrm{Tr}(C)\n$$\n从第1部分，我们得到 $C = \\frac{D}{k}I$，所以 $\\mathrm{Tr}(C) = \\frac{D}{k} + \\frac{D}{k} = \\frac{2D}{k}$。\n因此，流的标量度量是：\n$$\nJ_{\\infty} = \\Omega \\cdot \\mathrm{Tr}(C) = \\Omega \\left(\\frac{2D}{k}\\right) = \\frac{2\\Omega D}{k}\n$$\n该表达式提供了最终答案。", "answer": "$$\\boxed{\\frac{2\\Omega D}{k}}$$", "id": "3063143"}]}