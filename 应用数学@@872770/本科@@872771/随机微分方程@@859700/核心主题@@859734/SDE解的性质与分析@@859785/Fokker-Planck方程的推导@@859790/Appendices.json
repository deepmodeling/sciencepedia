{"hands_on_practices": [{"introduction": "本练习是一个奠基性的实践。我们将从一个具体且广泛应用的随机微分方程——Ornstein-Uhlenbeck 过程——出发，并从第一性原理推导出其对应的 Fokker-Planck 方程。通过求解其精确的时间依赖解，这个过程将巩固你对微观随机微分方程（SDE）动力学和其概率密度宏观演化之间直接联系的理解。[@problem_id:3048627]", "problem": "考虑由随机微分方程 $dX_{t} = -\\kappa \\left(X_{t} - \\mu \\right) dt + \\sigma \\, dW_{t}$ 定义的 Ornstein–Uhlenbeck 过程，其中 $\\kappa > 0$ 是均值回复率，$\\mu \\in \\mathbb{R}$ 是长期均值，$\\sigma > 0$ 是波动率参数，而 $W_{t}$ 是一个标准维纳过程（标准布朗运动）。令 $p(x,t \\mid x_{0})$ 表示该过程的转移概率密度（基本解），即从初始条件 $X_{0} = x_{0}$ 几乎必然出发的密度正向演化的解。\n\n仅使用伊藤微积分的基本要素（针对光滑检验函数的伊藤引理）、通过期望定义的概率密度以及在空间无穷远处适当衰减条件下的标准分部积分法，完成以下任务：\n\n1) 推导控制该过程转移密度 $p(x,t \\mid x_{0})$ 时间演化的偏微分方程，以及与 $X_{0} = x_{0}$ 相对应的初始条件。\n\n2) 求解此初值问题，以获得基本解 $p(x,t \\mid x_{0})$ 的闭式解，并明确展示其均值回复行为和随时间变化的方差。\n\n给出 $p(x,t \\mid x_{0})$ 的单一解析表达式，该表达式用 $x$、$t$、$x_{0}$、$\\kappa$、$\\mu$ 和 $\\sigma$ 表示。不需要进行数值计算或四舍五入。最终表达式中不要包含单位。", "solution": "问题是为 Ornstein–Uhlenbeck 过程推导向前 Kolmogorov 方程（Fokker-Planck 方程），然后求解该方程以求得转移概率密度 $p(x,t \\mid x_{0})$。该过程由随机微分方程（SDE）定义：\n$$dX_{t} = -\\kappa (X_{t} - \\mu) dt + \\sigma dW_{t}$$\n初始条件为 $X_{0} = x_{0}$ 几乎必然。参数 $\\kappa>0$、$\\sigma>0$ 和 $\\mu \\in \\mathbb{R}$ 是常数。\n\n### 第1部分：Fokker-Planck 方程的推导\n\n令 $f(x)$ 为一个光滑检验函数，它及其导数在 $|x| \\to \\infty$ 时足够快地衰减。$f(X_{t})$ 的期望可以用概率密度函数 $p(x,t) \\equiv p(x,t \\mid x_{0})$ 表示为：\n$$\\mathbb{E}[f(X_{t})] = \\int_{-\\infty}^{\\infty} f(x) p(x,t) dx$$\n我们用两种方法计算该期望的时间导数。首先，通过在积分号下求导：\n$$\\frac{d}{dt} \\mathbb{E}[f(X_{t})] = \\int_{-\\infty}^{\\infty} f(x) \\frac{\\partial p(x,t)}{\\partial t} dx$$\n其次，我们使用伊万引理。对于函数 $f(X_t)$，伊万引理表明：\n$$df(X_{t}) = f'(X_{t}) dX_{t} + \\frac{1}{2} f''(X_{t}) (dX_{t})^2$$\nOrnstein–Uhlenbeck 过程的漂移系数和扩散系数分别为 $a(x,t) = -\\kappa(x-\\mu)$ 和 $b(x,t) = \\sigma$。二次变分项 $(dX_t)^2$ 使用伊万法则（$dt^2 = 0$, $dt dW_t = 0$, $(dW_t)^2 = dt$）计算：\n$$(dX_{t})^2 = \\left(-\\kappa (X_{t} - \\mu) dt + \\sigma dW_{t}\\right)^2 = \\sigma^2 (dW_t)^2 = \\sigma^2 dt$$\n将 $dX_t$ 和 $(dX_t)^2$ 代入伊万公式得到：\n$$df(X_t) = f'(X_{t})[-\\kappa(X_{t}-\\mu) dt + \\sigma dW_{t}] + \\frac{1}{2} f''(X_{t})[\\sigma^2 dt]$$\n$$df(X_t) = \\left[-\\kappa(X_{t}-\\mu)f'(X_{t}) + \\frac{1}{2}\\sigma^2 f''(X_{t})\\right] dt + \\sigma f'(X_{t}) dW_{t}$$\n对微分 $df(X_t)$ 取期望，我们得到 $\\mathbb{E}[df(X_t)] = d\\mathbb{E}[f(X_t)]$。随机积分项的期望为零，即 $\\mathbb{E}[\\sigma f'(X_{t}) dW_{t}] = 0$。因此：\n$$d\\mathbb{E}[f(X_t)] = \\mathbb{E}\\left[-\\kappa(X_{t}-\\mu)f'(X_{t}) + \\frac{1}{2}\\sigma^2 f''(X_{t})\\right] dt$$\n两边除以 $dt$，我们得到时间导数：\n$$\\frac{d}{dt}\\mathbb{E}[f(X_t)] = \\mathbb{E}\\left[-\\kappa(X_{t}-\\mu)f'(X_{t}) + \\frac{1}{2}\\sigma^2 f''(X_{t})\\right]$$\n将期望写成关于概率密度的积分：\n$$\\frac{d}{dt}\\mathbb{E}[f(X_t)] = \\int_{-\\infty}^{\\infty} \\left[-\\kappa(x-\\mu)f'(x) + \\frac{1}{2}\\sigma^2 f''(x)\\right] p(x,t) dx$$\n现在，我们将 $\\frac{d}{dt}\\mathbb{E}[f(X_t)]$ 的两个表达式相等：\n$$\\int_{-\\infty}^{\\infty} f(x) \\frac{\\partial p}{\\partial t} dx = \\int_{-\\infty}^{\\infty} \\left[-\\kappa(x-\\mu)f'(x)p(x,t) + \\frac{1}{2}\\sigma^2 f''(x)p(x,t)\\right] dx$$\n我们对右侧使用分部积分，将导数从 $f(x)$ 转移到其他项上。由于 $f(x)$ 及其导数在无穷远处的衰减假设，边界项为零。\n对于第一项（漂移项）：\n$$\\int_{-\\infty}^{\\infty} [-\\kappa(x-\\mu)p(x,t)] f'(x) dx = \\left[-\\kappa(x-\\mu)p(x,t)f(x)\\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} f(x) \\frac{\\partial}{\\partial x}[-\\kappa(x-\\mu)p(x,t)] dx$$\n$$= \\int_{-\\infty}^{\\infty} f(x) \\frac{\\partial}{\\partial x}[\\kappa(x-\\mu)p(x,t)] dx$$\n对于第二项（扩散项），进行两次分部积分：\n$$\\int_{-\\infty}^{\\infty} \\left[\\frac{1}{2}\\sigma^2 p(x,t)\\right] f''(x) dx = \\left[\\frac{1}{2}\\sigma^2 p(x,t) f'(x)\\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} f'(x) \\frac{\\partial}{\\partial x}\\left[\\frac{1}{2}\\sigma^2 p(x,t)\\right] dx$$\n$$= -\\left[f(x)\\frac{\\partial}{\\partial x}\\left(\\frac{1}{2}\\sigma^2 p(x,t)\\right)\\right]_{-\\infty}^{\\infty} + \\int_{-\\infty}^{\\infty} f(x) \\frac{\\partial^2}{\\partial x^2}\\left[\\frac{1}{2}\\sigma^2 p(x,t)\\right] dx$$\n$$= \\int_{-\\infty}^{\\infty} f(x) \\frac{\\partial^2}{\\partial x^2}\\left[\\frac{1}{2}\\sigma^2 p(x,t)\\right] dx$$\n将这些结果代回主方程：\n$$\\int_{-\\infty}^{\\infty} f(x) \\frac{\\partial p}{\\partial t} dx = \\int_{-\\infty}^{\\infty} f(x) \\left( \\frac{\\partial}{\\partial x}[\\kappa(x-\\mu)p] + \\frac{\\partial^2}{\\partial x^2}\\left[\\frac{1}{2}\\sigma^2 p\\right] \\right) dx$$\n由于此等式对任意光滑检验函数 $f(x)$ 都必须成立，因此被积函数必须相同。这便给出了 Fokker-Planck 方程：\n$$\\frac{\\partial p(x,t)}{\\partial t} = \\frac{\\partial}{\\partial x}[\\kappa(x-\\mu)p(x,t)] + \\frac{\\sigma^2}{2} \\frac{\\partial^2 p(x,t)}{\\partial x^2}$$\n初始条件是过程在时间 $t=0$ 时从 $x_0$ 开始，这由狄拉克δ函数表示：\n$$p(x,0 \\mid x_0) = \\delta(x-x_0)$$\n\n### 第2部分：初值问题的求解\n\n为求解此偏微分方程，我们首先求解 $X_t$ 的随机微分方程。$X_t$ 的分布律即为解 $p(x,t \\mid x_0)$。\nSDE 为 $dX_{t} + \\kappa X_{t} dt = \\kappa \\mu dt + \\sigma dW_{t}$。我们使用积分因子 $e^{\\kappa t}$。考虑 $d(e^{\\kappa t} X_t)$:\n$$d(e^{\\kappa t} X_t) = \\kappa e^{\\kappa t} X_t dt + e^{\\kappa t} dX_t = e^{\\kappa t}(\\kappa X_t dt + dX_t) = e^{\\kappa t}(\\kappa \\mu dt + \\sigma dW_t)$$\n从 $s=0$ 到 $s=t$ 积分：\n$$e^{\\kappa t} X_t - e^{\\kappa \\cdot 0} X_0 = \\int_0^t \\kappa \\mu e^{\\kappa s} ds + \\int_0^t \\sigma e^{\\kappa s} dW_s$$\n$$e^{\\kappa t} X_t = x_0 + \\kappa \\mu \\left[\\frac{e^{\\kappa s}}{\\kappa}\\right]_0^t + \\sigma \\int_0^t e^{\\kappa s} dW_s$$\n$$e^{\\kappa t} X_t = x_0 + \\mu(e^{\\kappa t} - 1) + \\sigma \\int_0^t e^{\\kappa s} dW_s$$\n求解 $X_t$：\n$$X_t = x_0 e^{-\\kappa t} + \\mu(1 - e^{-\\kappa t}) + \\sigma \\int_0^t e^{-\\kappa(t-s)} dW_s$$\n$$X_t = \\mu + (x_0 - \\mu)e^{-\\kappa t} + \\sigma \\int_0^t e^{-\\kappa(t-s)} dW_s$$\n由于 $X_t$ 是一个确定性项和一个带有确定性被积函数的伊万积分之和，因此对于 $t>0$，$X_t$ 服从正态分布。我们需要求出其均值 $M(t)$ 和方差 $V(t)$。\n\n均值 $M(t) = \\mathbb{E}[X_t]$：\n$$M(t) = \\mathbb{E}\\left[\\mu + (x_0 - \\mu)e^{-\\kappa t} + \\sigma \\int_0^t e^{-\\kappa(t-s)} dW_s\\right]$$\n利用期望的线性性质以及伊万积分的期望为零的事实：\n$$M(t) = \\mu + (x_0 - \\mu)e^{-\\kappa t}$$\n方差 $V(t) = \\text{Var}(X_t) = \\mathbb{E}[(X_t - M(t))^2]$：\n$$X_t - M(t) = \\sigma \\int_0^t e^{-\\kappa(t-s)} dW_s$$\n$$V(t) = \\mathbb{E}\\left[\\left(\\sigma \\int_0^t e^{-\\kappa(t-s)} dW_s\\right)^2\\right]$$\n使用伊万等距性质 $\\mathbb{E}[(\\int_0^t G_s dW_s)^2] = \\int_0^t \\mathbb{E}[G_s^2] ds$：\n$$V(t) = \\sigma^2 \\int_0^t \\left(e^{-\\kappa(t-s)}\\right)^2 ds = \\sigma^2 e^{-2\\kappa t} \\int_0^t e^{2\\kappa s} ds$$\n$$V(t) = \\sigma^2 e^{-2\\kappa t} \\left[\\frac{e^{2\\kappa s}}{2\\kappa}\\right]_0^t = \\frac{\\sigma^2}{2\\kappa} e^{-2\\kappa t} (e^{2\\kappa t} - 1)$$\n$$V(t) = \\frac{\\sigma^2}{2\\kappa} (1 - e^{-2\\kappa t})$$\n服从正态分布 $\\mathcal{N}(M(t), V(t))$ 的随机变量 $X_t$ 的概率密度由以下公式给出：\n$$p(x,t \\mid x_0) = \\frac{1}{\\sqrt{2\\pi V(t)}} \\exp\\left(-\\frac{(x - M(t))^2}{2V(t)}\\right)$$\n代入 $M(t)$ 和 $V(t)$ 的表达式：\n$$p(x,t \\mid x_0) = \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\kappa}(1-e^{-2\\kappa t})}} \\exp\\left(-\\frac{(x - (\\mu + (x_0 - \\mu)e^{-\\kappa t}))^2}{2 \\frac{\\sigma^2}{2\\kappa}(1-e^{-2\\kappa t})}\\right)$$\n化简该表达式即可得到转移概率密度的最终结果：\n$$p(x,t \\mid x_0) = \\sqrt{\\frac{\\kappa}{\\pi\\sigma^2(1 - \\exp(-2\\kappa t))}} \\exp\\left(-\\frac{\\kappa(x - \\mu - (x_0 - \\mu)e^{-\\kappa t})^2}{\\sigma^2(1 - \\exp(-2\\kappa t))}\\right)$$", "answer": "$$\\boxed{\\sqrt{\\frac{\\kappa}{\\pi\\sigma^{2}(1 - \\exp(-2\\kappa t))}} \\exp\\left(-\\frac{\\kappa(x - \\mu - (x_{0} - \\mu)\\exp(-\\kappa t))^{2}}{\\sigma^{2}(1 - \\exp(-2\\kappa t))}\\right)}$$", "id": "3048627"}, {"introduction": "在探讨了时间依赖解之后，我们现在将注意力转向系统的长期行为。本练习引入了 Fokker-Planck 方程的稳态解这一关键概念，它代表了统计平衡的状态。你将看到零概率流的条件如何自然地导出了玻尔兹曼分布，这是一个将随机过程与统计力学联系起来的基本结果。[@problem_id:3048649]", "problem": "考虑一个形式为 $dX_{t} = a(X_{t})\\,dt + \\sqrt{2D}\\,dW_{t}$ 的一维伊藤随机微分方程 (SDE)，其中 $D>0$ 为常数，$W_{t}$ 是标准维纳过程，漂移项由 $a(x) = -D\\,\\beta\\,U'(x)$ 给出，对于一个可微势 $U:\\mathbb{R}\\to\\mathbb{R}$ 和一个常数 $\\beta>0$。从概率守恒和概率流的定义出发，在 $x\\to\\pm\\infty$ 的自然边界条件下，推导相关福克-普朗克方程 (FPE) 的稳态解，直至一个归一化常数。\n\n然后，对于特定势 $U(x) = \\frac{1}{2}\\,\\kappa\\,x^{2}$（其中 $\\kappa>0$），计算在 $x\\in\\mathbb{R}$ 上的完全归一化的稳态概率密度 $p_{\\text{st}}(x)$，用 $x$、$\\beta$ 和 $\\kappa$ 表示您的最终答案。不需要数值近似。", "solution": "首先验证该问题，以确保其科学上合理、适定且客观。\n\n### 第一步：提取已知条件\n-   该过程由一个一维伊藤随机微分方程 (SDE) 描述：$dX_{t} = a(X_{t})\\,dt + \\sqrt{2D}\\,dW_{t}$。\n-   扩散参数 $D$ 是一个正常数，$D>0$。\n-   $W_{t}$ 是一个标准维纳过程。\n-   漂移函数是 $a(x) = -D\\,\\beta\\,U'(x)$，其中 $U(x)$ 是一个可微势函数，$\\beta$ 是一个正常数，$\\beta>0$。\n-   第一个任务是推导相关福克-普朗克方程 (FPE) 的稳态解，直至一个归一化常数，使用 $x\\to\\pm\\infty$ 处的自然边界条件。\n-   第二个任务是考虑特定势 $U(x) = \\frac{1}{2}\\,\\kappa\\,x^{2}$，其中 $\\kappa$ 是一个正常数，$\\kappa>0$。\n-   最后一个任务是计算在定义域 $x\\in\\mathbb{R}$ 上的完全归一化的稳态概率密度 $p_{\\text{st}}(x)$，结果用 $x$、$\\beta$ 和 $\\kappa$ 表示。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题是随机过程和统计力学领域的一个标准和基础范例。该SDE代表了粒子在势 $U(x)$ 中的过阻尼朗之万方程，而福克-普朗克方程正确地描述了其概率密度的演化。漂移、扩散和势梯度之间的关系在物理上是有意义的。所有组成部分都基于已建立的科学原理。\n-   **适定性：** 该问题是适定的。SDE定义清晰。对于一个束缚势 ($U(x) = \\frac{1}{2}\\kappa x^2$)，在自然边界条件（意味着概率和通量在无穷远处消失）下寻找FPE的一个稳态、可归一化的解的任务，保证了存在一个唯一的、稳定的解。\n-   **客观性：** 语言正式且无歧义。所有变量和常数都已定义，目标陈述精确。\n\n### 第三步：结论与行动\n问题有效。现在开始求解过程。\n\n### 稳态福克-普朗克解的推导\n\n对于由SDE $dX_t = A(X_t)dt + B(X_t)dW_t$ 描述的过程，其概率密度 $p(x,t)$ 的福克-普朗克方程的一般形式为：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left[A(x)p(x,t)\\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}\\left[B(x)^2 p(x,t)\\right]\n$$\n根据给定的SDE，$dX_{t} = a(X_{t})\\,dt + \\sqrt{2D}\\,dW_{t}$，我们确定漂移和扩散系数：\n$A(x) = a(x) = -D\\,\\beta\\,U'(x)$\n$B(x) = \\sqrt{2D}$ (一个常数)\n\n将这些代入通用的FPE中得到：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left[(-D\\,\\beta\\,U'(x))p(x,t)\\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}\\left[(\\sqrt{2D})^2 p(x,t)\\right]\n$$\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = \\frac{\\partial}{\\partial x}\\left[D\\,\\beta\\,U'(x)p(x,t)\\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}\\left[2D p(x,t)\\right]\n$$\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = \\frac{\\partial}{\\partial x}\\left[D\\,\\beta\\,U'(x)p(x,t) + D\\frac{\\partial p(x,t)}{\\partial x}\\right]\n$$\n该方程具有连续性方程的形式，$\\frac{\\partial p}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0$，其中 $J(x,t)$ 是概率流。通过比较，我们确定流为：\n$$\nJ(x,t) = -D\\,\\beta\\,U'(x)p(x,t) - D\\frac{\\partial p(x,t)}{\\partial x}\n$$\n我们寻求稳态解 $p_{\\text{st}}(x)$，此时概率密度与时间无关，即 $\\frac{\\partial p_{\\text{st}}}{\\partial t} = 0$。稳态的连续性方程变为：\n$$\n\\frac{d J_{\\text{st}}(x)}{dx} = 0\n$$\n这意味着稳态流 $J_{\\text{st}}(x)$ 必须是一个常数，设为 $J_{\\text{st}}(x) = C$。在 $x \\to \\pm\\infty$ 处的自然边界条件要求概率密度及其梯度消失，即 $p_{\\text{st}}(x) \\to 0$ 和 $\\frac{dp_{\\text{st}}}{dx} \\to 0$，以确保解在 $\\mathbb{R}$ 上可归一化。这对于被势场束缚的粒子是物理上必需的。将这些条件应用于 $J_{\\text{st}}(x)$ 的表达式，意味着 $C$ 必须为零。因此，对于所有 $x$，我们有 $J_{\\text{st}}(x) = 0$。\n$$\n-D\\,\\beta\\,U'(x)p_{\\text{st}}(x) - D\\frac{d p_{\\text{st}}(x)}{dx} = 0\n$$\n由于 $D > 0$，我们可以除以 $-D$：\n$$\n\\beta\\,U'(x)p_{\\text{st}}(x) + \\frac{d p_{\\text st}(x)}{dx} = 0\n$$\n这是一个一阶线性常微分方程。它是可分离变量的：\n$$\n\\frac{1}{p_{\\text{st}}(x)}\\frac{d p_{\\text{st}}(x)}{dx} = -\\beta\\,U'(x)\n$$\n对两边关于 $x$ 积分：\n$$\n\\int \\frac{1}{p_{\\text{st}}(x)}\\,d p_{\\text{st}}(x) = -\\beta \\int U'(x)\\,dx\n$$\n$$\n\\ln(p_{\\text{st}}(x)) = -\\beta\\,U(x) + C_1\n$$\n其中 $C_1$ 是积分常数。对两边取指数，得到稳态解，其形式包含一个归一化常数 $\\mathcal{N} = \\exp(C_1)$：\n$$\np_{\\text{st}}(x) = \\mathcal{N} \\exp(-\\beta\\,U(x))\n$$\n这是稳态解的一般形式，对应于玻尔兹曼分布。\n\n### 针对特定势的归一化\n\n现在，我们考虑特定的谐振子势 $U(x) = \\frac{1}{2}\\,\\kappa\\,x^{2}$。将此代入一般解得到：\n$$\np_{\\text{st}}(x) = \\mathcal{N} \\exp\\left(-\\beta\\,\\frac{1}{2}\\,\\kappa\\,x^{2}\\right) = \\mathcal{N} \\exp\\left(-\\frac{\\beta\\kappa}{2}x^{2}\\right)\n$$\n为了找到归一化常数 $\\mathcal{N}$，我们施加总概率等于 $1$ 的条件：\n$$\n\\int_{-\\infty}^{\\infty} p_{\\text{st}}(x)\\,dx = 1\n$$\n$$\n\\mathcal{N} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta\\kappa}{2}x^{2}\\right)\\,dx = 1\n$$\n该积分为标准高斯积分形式 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,dx = \\sqrt{\\frac{\\pi}{a}}$。在我们的例子中，参数 $a = \\frac{\\beta\\kappa}{2}$。因此，积分的值为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta\\kappa}{2}x^{2}\\right)\\,dx = \\sqrt{\\frac{\\pi}{\\beta\\kappa/2}} = \\sqrt{\\frac{2\\pi}{\\beta\\kappa}}\n$$\n将此结果代回归一化条件：\n$$\n\\mathcal{N} \\sqrt{\\frac{2\\pi}{\\beta\\kappa}} = 1\n$$\n求解 $\\mathcal{N}$ 得到：\n$$\n\\mathcal{N} = \\frac{1}{\\sqrt{\\frac{2\\pi}{\\beta\\kappa}}} = \\sqrt{\\frac{\\beta\\kappa}{2\\pi}}\n$$\n最后，完全归一化的稳态概率密度为：\n$$\np_{\\text{st}}(x) = \\sqrt{\\frac{\\beta\\kappa}{2\\pi}} \\exp\\left(-\\frac{\\beta\\kappa x^{2}}{2}\\right)\n$$\n这是一个均值为 $0$、方差为 $\\sigma^{2} = (\\beta\\kappa)^{-1}$ 的高斯分布。结果完全用指定的变量 $x$、$\\beta$ 和 $\\kappa$ 表示。", "answer": "$$\n\\boxed{\\sqrt{\\frac{\\beta\\kappa}{2\\pi}} \\exp\\left(-\\frac{\\beta\\kappa x^{2}}{2}\\right)}\n$$", "id": "3048649"}, {"introduction": "Fokker-Planck 方程的数学形式必须与有物理意义的约束条件相结合。本练习通过一个误用边界条件的场景，强调了边界条件的至关重要的作用。通过分析概率流，你将诊断出为何该系统未能保持概率守恒，从而对流项及其在建立正确模型中的重要性获得更深刻、更具体的理解。[@problem_id:3048655]", "problem": "考虑一维伊万（Itô）随机微分方程 (SDE)\n$$\n\\mathrm{d}X_t = v\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\n其中漂移 $v$ 和扩散系数 $D>0$ 为常数，$X_t$ 被限制在有界区间 $[0,L]$ 内，$L>0$。令 $p(x,t)$ 表示 $X_t$ 的概率密度函数 (PDF)。\n\n一个实践者打算在 $x=0$ 和 $x=L$ 处建立完美反射边界模型，但错误地施加了吸收（狄利克雷，Dirichlet）边界条件 $p(0,t)=0$ 和 $p(L,t)=0$。从基本的概率守恒和上述 SDE 出发（不引用任何预先给出的福克-普朗克（Fokker–Planck）公式），推导 $p(x,t)$ 的相应连续性方程，并确定与此 SDE 一致的概率通量 $J(x,t)$。然后，通过计算总概率质量\n$$\nM(t) = \\int_{0}^{L} p(x,t)\\,\\mathrm{d}x\n$$\n在时间 $t=0$ 时的瞬时变化率，利用你得到的通量来判断所施加的边界条件是导致了概率的损失还是增加。\n\n假设初始条件为\n$$\np(x,0) = C\\,x\\,(L-x),\n$$\n其中 $C$ 的选择使得 $\\int_{0}^{L} p(x,0)\\,\\mathrm{d}x = 1$。将 $v$ 和 $D$ 视为符号参数，并将你的最终答案表示为关于 $D$ 和 $L$ 的 $\\frac{\\mathrm{d}M}{\\mathrm{d}t}\\big|_{t=0}$ 的单个简化解析表达式。无需四舍五入，也无需报告物理单位。你的最终答案必须是单个封闭形式的表达式。", "solution": "该问题被验证为具有科学依据、提法恰当且客观。这是随机微分方程领域的标准问题，可以使用既定的数学原理解决。\n\n出发点是描述粒子位置 $X_t$ 的一维伊万随机微分方程 (SDE)：\n$$\n\\mathrm{d}X_t = v\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t\n$$\n其中 $v$ 是恒定的漂移速度，$D>0$ 是恒定的扩散系数，$\\mathrm{d}W_t$ 是维纳过程的增量。该过程被限制在区间 $[0,L]$ 内。我们的任务是推导 $X_t$ 的概率密度函数 (PDF) $p(x,t)$ 的控制方程。\n\n首先，我们推导连续性方程并确定概率通量 $J(x,t)$。概率守恒的基本原理指出，在任何任意子区间 $[a,b] \\subseteq [0,L]$ 内概率的变化率必须等于流入该子区间的净概率通量。\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{a}^{b} p(x,t)\\,\\mathrm{d}x = J(a,t) - J(b,t)\n$$\n其中 $J(x,t)$ 是在位置 $x$ 和时间 $t$ 的概率通量，定义为沿正 $x$ 方向的流动为正。\n对右侧使用微积分基本定理，我们得到：\n$$\n\\int_{a}^{b} \\frac{\\partial p(x,t)}{\\partial t}\\,\\mathrm{d}x = -\\int_{a}^{b} \\frac{\\partial J(x,t)}{\\partial x}\\,\\mathrm{d}x\n$$\n由于这对于任何子区间 $[a,b]$ 都必须成立，因此被积函数必须相等，这给出了微分形式的连续性方程：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} + \\frac{\\partial J(x,t)}{\\partial x} = 0\n$$\n为了从 SDE 中确定通量 $J(x,t)$，我们考虑任意光滑测试函数 $\\phi(x)$ 的期望值的时间演化。令 $E[\\cdot]$ 表示期望算子。\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} E[\\phi(X_t)] = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{0}^{L} \\phi(x) p(x,t)\\,\\mathrm{d}x = \\int_{0}^{L} \\phi(x) \\frac{\\partial p(x,t)}{\\partial t}\\,\\mathrm{d}x\n$$\n根据伊万引理，对于函数 $\\phi(X_t)$，其微分为：\n$$\n\\mathrm{d}\\phi(X_t) = \\phi'(X_t)\\,\\mathrm{d}X_t + \\frac{1}{2}\\phi''(X_t)\\,\\mathrm{d}\\langle X \\rangle_t\n$$\n$X_t$ 的二次变分是 $\\mathrm{d}\\langle X \\rangle_t = (\\sqrt{2D})^2 (\\mathrm{d}W_t)^2 = 2D\\,\\mathrm{d}t$。代入此式和 $\\mathrm{d}X_t$ 的 SDE：\n$$\n\\mathrm{d}\\phi(X_t) = \\phi'(X_t) (v\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t) + \\frac{1}{2}\\phi''(X_t) (2D\\,\\mathrm{d}t) = (v\\,\\phi'(X_t) + D\\,\\phi''(X_t))\\,\\mathrm{d}t + \\sqrt{2D}\\,\\phi'(X_t)\\,\\mathrm{d}W_t\n$$\n取期望，涉及 $\\mathrm{d}W_t$ 的项因 $E[\\mathrm{d}W_t]=0$ 而消失。除以 $\\mathrm{d}t$，我们得到期望的时间演化：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} E[\\phi(X_t)] = E[v\\,\\phi'(X_t) + D\\,\\phi''(X_t)] = \\int_{0}^{L} (v\\,\\phi'(x) + D\\,\\phi''(x)) p(x,t)\\,\\mathrm{d}x\n$$\n我们对右侧进行分部积分，将导数从 $\\phi(x)$ 转移到 $p(x,t)$。对于在边界处为零的测试函数 $\\phi(x)$（例如，在 $(0,L)$ 中具有紧支集），边界项为零。\n$$\n\\int_{0}^{L} v\\,\\phi'(x)p(x,t)\\,\\mathrm{d}x = [v\\,\\phi(x)p(x,t)]_{0}^{L} - \\int_{0}^{L} \\phi(x) \\frac{\\partial}{\\partial x}(v\\,p(x,t))\\,\\mathrm{d}x\n$$\n$$\n\\int_{0}^{L} D\\,\\phi''(x)p(x,t)\\,\\mathrm{d}x = [D\\,\\phi'(x)p(x,t)]_{0}^{L} - \\int_{0}^{L} D\\,\\phi'(x)\\frac{\\partial p(x,t)}{\\partial x}\\,\\mathrm{d}x\n$$\n对第二项再次进行分部积分：\n$$\n- \\int_{0}^{L} D\\,\\phi'(x)\\frac{\\partial p}{\\partial x}\\,\\mathrm{d}x = -[D\\,\\phi(x)\\frac{\\partial p}{\\partial x}]_{0}^{L} + \\int_{0}^{L} \\phi(x)\\frac{\\partial}{\\partial x}(D\\,\\frac{\\partial p}{\\partial x})\\,\\mathrm{d}x\n$$\n结合这些并暂时假设边界项为零，我们令 $\\frac{\\mathrm{d}}{\\mathrm{d}t} E[\\phi(X_t)]$ 的两个表达式相等：\n$$\n\\int_{0}^{L} \\phi(x) \\frac{\\partial p}{\\partial t} \\,\\mathrm{d}x = \\int_{0}^{L} \\phi(x) \\left(-\\frac{\\partial}{\\partial x}(v\\,p) + \\frac{\\partial^2}{\\partial x^2}(D\\,p)\\right)\\,\\mathrm{d}x\n$$\n这蕴含了 $p(x,t)$ 的福克-普朗克方程：\n$$\n\\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial x}(v\\,p) + \\frac{\\partial^2}{\\partial x^2}(D\\,p)\n$$\n由于 $v$ 和 $D$ 是常数，方程为 $\\frac{\\partial p}{\\partial t} = -v\\frac{\\partial p}{\\partial x} + D\\frac{\\partial^2 p}{\\partial x^2}$。通过将其与连续性方程 $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$ 进行比较，我们确定概率通量为：\n$$\nJ(x,t) = v\\,p(x,t) - D\\,\\frac{\\partial p(x,t)}{\\partial x}\n$$\n接下来，我们计算总概率质量 $M(t) = \\int_{0}^{L} p(x,t)\\,\\mathrm{d}x$ 的变化率。\n$$\n\\frac{\\mathrm{d}M}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{0}^{L} p(x,t)\\,\\mathrm{d}x = \\int_{0}^{L} \\frac{\\partial p(x,t)}{\\partial t}\\,\\mathrm{d}x\n$$\n代入连续性方程：\n$$\n\\frac{\\mathrm{d}M}{\\mathrm{d}t} = \\int_{0}^{L} \\left(-\\frac{\\partial J(x,t)}{\\partial x}\\right)\\,\\mathrm{d}x = -[J(x,t)]_{0}^{L} = J(0,t) - J(L,t)\n$$\n这证实了总概率的变化率是进入该区域的净通量。我们需要在 $t=0$ 时计算这个值。\n$$\n\\frac{\\mathrm{d}M}{\\mathrm{d}t}\\bigg|_{t=0} = J(0,0) - J(L,0)\n$$\n问题指定了初始条件 $p(x,0) = C\\,x\\,(L-x)$ 和吸收边界条件 $p(0,t)=0$ 和 $p(L,t)=0$。这意味着 $p(0,0)=0$ 和 $p(L,0)=0$，这与给定的初始分布是一致的。\n在时间 $t=0$ 时的通量是 $J(x,0) = v\\,p(x,0) - D\\,\\frac{\\partial p}{\\partial x}(x,0)$。在边界 $x=0$ 和 $x=L$ 处：\n$$\nJ(0,0) = v\\,p(0,0) - D\\,\\frac{\\partial p}{\\partial x}(0,0) = -D\\,\\frac{\\partial p}{\\partial x}(0,0)\n$$\n$$\nJ(L,0) = v\\,p(L,0) - D\\,\\frac{\\partial p}{\\partial x}(L,0) = -D\\,\\frac{\\partial p}{\\partial x}(L,0)\n$$\n请注意，漂移速度 $v$ 对边界处的初始通量没有贡献，因为那里的密度为零。\n我们需要归一化常数 $C$。\n$$\n\\int_{0}^{L} p(x,0)\\,\\mathrm{d}x = \\int_{0}^{L} C\\,x\\,(L-x)\\,\\mathrm{d}x = C \\int_{0}^{L} (Lx - x^2)\\,\\mathrm{d}x = 1\n$$\n$$\nC \\left[\\frac{Lx^2}{2} - \\frac{x^3}{3}\\right]_{0}^{L} = C \\left(\\frac{L^3}{2} - \\frac{L^3}{3}\\right) = C \\left(\\frac{L^3}{6}\\right) = 1 \\implies C = \\frac{6}{L^3}\n$$\n因此，初始 PDF 是 $p(x,0) = \\frac{6}{L^3}(Lx - x^2)$。现在，我们求其空间导数：\n$$\n\\frac{\\partial p}{\\partial x}(x,0) = \\frac{6}{L^3}(L - 2x)\n$$\n计算在边界处的导数：\n$$\n\\frac{\\partial p}{\\partial x}(0,0) = \\frac{6}{L^3}(L) = \\frac{6}{L^2}\n$$\n$$\n\\frac{\\partial p}{\\partial x}(L,0) = \\frac{6}{L^3}(L - 2L) = -\\frac{6}{L^2}\n$$\n现在，将这些代入边界通量的表达式中：\n$$\nJ(0,0) = -D \\left(\\frac{6}{L^2}\\right) = -\\frac{6D}{L^2}\n$$\n$$\nJ(L,0) = -D \\left(-\\frac{6}{L^2}\\right) = \\frac{6D}{L^2}\n$$\n最后，我们计算在 $t=0$ 时总概率质量的变化率：\n$$\n\\frac{\\mathrm{d}M}{\\mathrm{d}t}\\bigg|_{t=0} = J(0,0) - J(L,0) = \\left(-\\frac{6D}{L^2}\\right) - \\left(\\frac{6D}{L^2}\\right) = -\\frac{12D}{L^2}\n$$\n由于 $D>0$ 且 $L>0$，总概率的变化率为负。这表明在 $t=0$ 时，概率质量正在从区间 $[0,L]$ 中损失。这种损失是由于在 $x=0$ 和 $x=L$ 处非零的密度梯度驱动的、从两个边界流出的扩散通量所致。吸收边界条件意味着任何到达端点的概率都会从系统中移除。\n最终结果仅取决于 $D$ 和 $L$，符合要求。", "answer": "$$\n\\boxed{-\\frac{12D}{L^2}}\n$$", "id": "3048655"}]}