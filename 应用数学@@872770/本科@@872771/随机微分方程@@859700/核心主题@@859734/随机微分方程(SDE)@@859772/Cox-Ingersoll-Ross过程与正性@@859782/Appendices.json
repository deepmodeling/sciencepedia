{"hands_on_practices": [{"introduction": "要完全理解一个随机过程，关键在于掌握其长期行为。平稳分布描述了过程在长时间演化后达到的统计平衡状态。通过本练习 [@problem_id:3047712]，您将通过求解福克-普朗克方程来推导CIR过程的平稳分布，揭示其与伽马分布的深刻联系，并加深对费勒条件下过程内在正性的理解。", "problem": "考虑 Cox–Ingersoll–Ross (CIR) 随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; \\kappa\\bigl(\\theta - X_{t}\\bigr)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\sqrt{X_{t}}\\,\\mathrm{d}W_{t},\n$$\n其中 $X_{t} \\in (0,\\infty)$，$\\kappa0$，$\\theta0$，$\\sigma0$，且 $W_{t}$ 是一个标准维纳过程。假设满足 Feller 条件 $2\\,\\kappa\\,\\theta\\sigma^{2}$，因此 $x=0$ 处的边界是不可达的，且该过程严格保持为正。\n\n从随时间变化的概率密度 $p(x,t)$ 的 Kolmogorov 前向方程（Fokker–Planck 方程）出发，并应用细致平衡（稳态概率流为零），推导在 $(0,\\infty)$ 上的稳态密度 $p^{\\ast}(x)$。通过以 $\\kappa$、$\\theta$ 和 $\\sigma$ 明确表示其形状和速率参数，将此密度识别为伽马分布。请以 $x0$ 上关于 $p^{\\ast}(x)$ 的单个闭式解析表达式的形式给出你的最终答案。", "solution": "该问题陈述被认为是有效的，因为它具有科学依据、问题明确且客观。它代表了随机过程理论中的一个标准问题。\n\nCox–Ingersoll–Ross (CIR) 过程由以下随机微分方程 (SDE) 描述：\n$$\n\\mathrm{d}X_{t} \\;=\\; \\kappa(\\theta - X_{t})\\,\\mathrm{d}t \\;+\\; \\sigma\\sqrt{X_{t}}\\,\\mathrm{d}W_{t}\n$$\n这是一个一般形式为 $\\mathrm{d}X_t = A(X_t)\\,\\mathrm{d}t + B(X_t)\\,\\mathrm{d}W_t$ 的一维 Itô 过程。通过比较，我们确定漂移系数 $A(x)$ 和扩散系数 $B(x)$：\n$$\nA(x) = \\kappa(\\theta - x)\n$$\n$$\nB(x) = \\sigma\\sqrt{x}\n$$\n过程 $X_t$ 的概率密度函数 $p(x,t)$ 的演化由 Kolmogorov 前向方程（也称为 Fokker–Planck 方程）控制：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ A(x) p(x,t) \\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\left[ B(x)^2 p(x,t) \\right]\n$$\n代入 CIR 过程的 $A(x)$ 和 $B(x)^2 = \\sigma^2 x$ 的具体形式，我们得到：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ \\kappa(\\theta - x) p(x,t) \\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\left[ \\sigma^2 x p(x,t) \\right]\n$$\n这个方程可以表示为连续性方程 $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$，其中 $J(x,t)$ 是概率流：\n$$\nJ(x,t) = A(x) p(x,t) - \\frac{1}{2}\\frac{\\partial}{\\partial x} \\left[B(x)^2 p(x,t)\\right] = \\kappa(\\theta - x) p(x,t) - \\frac{\\sigma^2}{2}\\frac{\\partial}{\\partial x} \\left[x p(x,t)\\right]\n$$\n为了找到稳态密度 $p^*(x)$，我们令时间导数为零，即 $\\frac{\\partial p}{\\partial t} = 0$。这意味着稳态概率流 $J^*(x)$ 对于 $x$ 必须是一个常数。问题要求应用细致平衡，这对应于稳态概率流处处为零的条件，即 $J^*(x) = 0$。对于在 $(0, \\infty)$ 上的过程，并且在 $x=0$ 处有一个不可达（反射）边界，这个条件是合适的，这一点由 Feller 条件 $2\\kappa\\theta  \\sigma^2$ 保证。将稳态流设为零，得到关于 $p^*(x)$ 的以下常微分方程：\n$$\n\\kappa(\\theta - x) p^*(x) - \\frac{\\sigma^2}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[x p^*(x)\\right] = 0\n$$\n我们可以重新整理这个方程来求解 $p^*(x)$：\n$$\n\\frac{\\sigma^2}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[x p^*(x)\\right] = \\kappa(\\theta - x) p^*(x)\n$$\n对左侧应用乘法法则：\n$$\n\\frac{\\sigma^2}{2}\\left(p^*(x) + x\\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x}\\right) = \\kappa(\\theta - x)p^*(x)\n$$\n我们可以使用分离变量法来解这个一阶线性常微分方程。重新整理各项以分离出 $\\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x}$：\n$$\n\\frac{\\sigma^2}{2} x \\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x} = \\left(\\kappa(\\theta - x) - \\frac{\\sigma^2}{2}\\right)p^*(x) = \\left(\\kappa\\theta - \\frac{\\sigma^2}{2} - \\kappa x\\right)p^*(x)\n$$\n$$\n\\frac{1}{p^*(x)}\\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x} = \\frac{1}{x} \\frac{2}{\\sigma^2} \\left(\\kappa\\theta - \\frac{\\sigma^2}{2} - \\kappa x\\right) = \\frac{2\\kappa\\theta - \\sigma^2}{\\sigma^2 x} - \\frac{2\\kappa}{\\sigma^2}\n$$\n对两边关于 $x$ 积分：\n$$\n\\int \\frac{\\mathrm{d}p^*(x)}{p^*(x)} = \\int \\left(\\frac{2\\kappa\\theta/\\sigma^2 - 1}{x} - \\frac{2\\kappa}{\\sigma^2}\\right)\\mathrm{d}x\n$$\n$$\n\\ln(p^*(x)) = \\left(\\frac{2\\kappa\\theta}{\\sigma^2} - 1\\right)\\ln(x) - \\frac{2\\kappa}{\\sigma^2}x + C'\n$$\n其中 $C'$ 是积分常数。对两边取指数，得到未归一化的密度：\n$$\np^*(x) = \\exp(C') \\exp\\left(\\left(\\frac{2\\kappa\\theta}{\\sigma^2} - 1\\right)\\ln(x)\\right) \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)\n$$\n$$\np^*(x) = C x^{\\frac{2\\kappa\\theta}{\\sigma^2} - 1} \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)\n$$\n其中 $C = \\exp(C')$ 是一个归一化常数。这个函数形式是伽马分布的形式。具有形状参数 $\\alpha$ 和速率参数 $\\beta$ 的伽马分布的概率密度函数由以下公式给出：\n$$\nf(x; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x)\n$$\n通过将我们得到的 $p^*(x)$ 表达式与伽马 PDF 的标准形式进行比较，我们可以确定形状和速率参数：\n形状参数：\n$$\n\\alpha - 1 = \\frac{2\\kappa\\theta}{\\sigma^2} - 1 \\quad \\implies \\quad \\alpha = \\frac{2\\kappa\\theta}{\\sigma^2}\n$$\n速率参数：\n$$\n\\beta = \\frac{2\\kappa}{\\sigma^2}\n$$\n参数 $\\kappa$、$\\theta$ 和 $\\sigma$ 均为正，确保了 $\\alpha  0$ 和 $\\beta  0$。给定的 Feller 条件 $2\\kappa\\theta  \\sigma^2$ 确保了 $\\alpha  1$。\n因此，归一化常数 $C$ 是：\n$$\nC = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} = \\frac{\\left(\\frac{2\\kappa}{\\sigma^2}\\right)^{\\frac{2\\kappa\\theta}{\\sigma^2}}}{\\Gamma\\left(\\frac{2\\kappa\\theta}{\\sigma^2}\\right)}\n$$\n将这个常数代回到我们关于 $p^*(x)$ 的表达式中，我们得到最终的归一化稳态概率密度：\n$$\np^*(x) = \\frac{\\left(\\frac{2\\kappa}{\\sigma^2}\\right)^{\\frac{2\\kappa\\theta}{\\sigma^2}}}{\\Gamma\\left(\\frac{2\\kappa\\theta}{\\sigma^2}\\right)} x^{\\frac{2\\kappa\\theta}{\\sigma^2} - 1} \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)\n$$\n这就是 CIR 过程在定义域 $x \\in (0, \\infty)$ 上的稳态密度。", "answer": "$$\n\\boxed{\\frac{\\left(\\frac{2\\kappa}{\\sigma^2}\\right)^{\\frac{2\\kappa\\theta}{\\sigma^2}}}{\\Gamma\\left(\\frac{2\\kappa\\theta}{\\sigma^2}\\right)} x^{\\frac{2\\kappa\\theta}{\\sigma^2} - 1} \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)}\n$$", "id": "3047712"}, {"introduction": "从解析理论转向数值模拟时，我们会遇到新的挑战。尽管我们知道真实的CIR过程是正的，但其数值近似却不一定能保持这个关键特性。本练习 [@problem_id:3047714] 将让您亲手探究这个常见的陷阱，通过推导并计算朴素的欧拉-丸山格式在单步迭代中产生负值的概率，从而揭示计算金融中的一个核心难题。", "problem": "考虑由 $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$ 给出的 Cox–Ingersoll–Ross (CIR) 随机微分方程 (SDE)，其初始值为 $X_0 \\ge 0$，其中 $\\kappa  0$，$\\theta  0$，$\\sigma \\ge 0$，且 $W_t$ 是标准布朗运动。已知当 $X_0  0$ 时，在 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 下，该 SDE 的精确解是严格为正的。然而，诸如欧拉-丸山法等数值时间离散化方法通常不继承这种正性。\n\n任务：从应用于 Itô SDE 的欧拉-丸山格式的定义以及长度为 $h$ 的时间步上的布朗增量服从均值为 $0$、方差为 $h$ 的正态分布这一事实出发，从第一性原理推导一个表达式，该表达式表示从给定的非负状态 $x \\ge 0$ 开始的 CIR SDE 的单次欧拉-丸山更新产生下一个负值的概率。您的推导必须仅使用正态分布的标准性质，用 $\\kappa$、$\\theta$、$\\sigma$、$x$ 和 $h$ 来表示这个概率。然后，实现一个程序，对下面测试套件中的每个参数集，计算这个单步为负的概率，并将其作为四舍五入到六位小数的浮点数返回。\n\n您必须正确处理任何退化情况。特别是，如果当前状态下的扩散系数为零，导致欧拉-丸山更新中的噪声项消失（例如，当 $\\sigma = 0$ 或 $x = 0$ 时），那么单步更新是确定性的；在这种情况下，概率应为 $0$ 或 $1$，具体取决于确定性更新的符号。\n\n使用以下测试套件。每个测试用例都是一个元组 $(\\kappa,\\theta,\\sigma,x,h)$：\n- 测试用例 1：$(4.0, 0.04, 0.5, 0.04, 0.25)$。\n- 测试用例 2：$(1.2, 0.05, 0.3, 0.0, 0.1)$。\n- 测试用例 3：$(0.3, 0.02, 0.4, 0.02, 0.5)$。\n- 测试用例 4：$(10.0, 0.01, 0.0, 0.03, 0.2)$。\n\n覆盖性设计：\n- 测试用例 1 满足 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 且 $x  0$，说明即使在这种情况下，欧拉-丸山法也可能为下一步赋予一个正的负值概率。\n- 测试用例 2 从 $x = 0$ 开始，此时扩散项消失，单步格式在第一步是确定性的。\n- 测试用例 3 违反 Feller 条件，且 $x  0$ 并具有相对较大的时间步长 $h$，说明穿越到零以下的概率更大。\n- 测试用例 4 中 $\\sigma = 0$ 且选择了一个较大的时间步长 $h$，使得确定性欧拉步变为负值，尽管 $x \\ge 0$，但为负的概率为 1。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序与测试套件相同，每个概率都四舍五入到六位小数（例如，$[0.123456,0.000000,0.654321,1.000000]$）。", "solution": "该问题要求推导 Cox-Ingersoll-Ross (CIR) 过程的欧拉-丸山离散化的单步为负的概率。\n\nCIR 过程由以下随机微分方程 (SDE) 描述：\n$$\ndX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t\n$$\n其中 $X_t$ 是过程在时间 $t$ 的状态，$W_t$ 是标准布朗运动，参数 $\\kappa$、$\\theta$ 和 $\\sigma$ 是满足 $\\kappa  0$、$\\theta  0$ 和 $\\sigma \\ge 0$ 的常数。过程从一个非负初始值 $X_0 \\ge 0$ 开始。\n\n欧拉-丸山数值格式通过将时间离散化为长度为 $h$ 的步长来近似 SDE 的解。对于一般的 Itô SDE $dY_t = a(Y_t, t)\\,dt + b(Y_t, t)\\,dW_t$，该格式由下式给出：\n$$\nY_{n+1} = Y_n + a(Y_n, t_n)h + b(Y_n, t_n)\\Delta W_n\n$$\n其中 $Y_n = Y_{t_n}$，$t_{n+1} = t_n + h$，以及 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 是布朗运动在时间步长上的增量。布朗运动的一个基本性质是其增量服从正态分布，具体来说是 $\\Delta W_n \\sim N(0, h)$。\n\n对于 CIR 过程，漂移系数和扩散系数分别为 $a(x) = \\kappa(\\theta - x)$ 和 $b(x) = \\sigma \\sqrt{x}$。设过程的当前状态为 $X_n = x$，其中 $x \\ge 0$。应用欧拉-丸山格式，下一个状态 $X_{n+1}$ 为：\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\Delta W_n\n$$\n我们需要求出这个下一个状态为负的概率，即 $P(X_{n+1}  0)$。\n\n布朗增量 $\\Delta W_n$ 可以表示为 $\\sqrt{h}Z$，其中 $Z$ 是一个标准正态随机变量，$Z \\sim N(0, 1)$。将此代入 $X_{n+1}$ 的方程中，得到：\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\sqrt{h} Z\n$$\n我们想计算概率 $P(X_{n+1}  0)$，这可以转化为：\n$$\nP(x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\sqrt{h} Z  0)\n$$\n为了解决这个问题，我们必须根据扩散项系数的值分析两种不同的情况。\n\n**情况 1：非退化扩散（$\\sigma  0$ 且 $x  0$）**\n在这种情况下，随机变量 $Z$ 的系数，即 $\\sigma \\sqrt{x} \\sqrt{h}$，是严格为正的。我们可以重新整理不等式以分离 $Z$：\n$$\n\\sigma \\sqrt{x} \\sqrt{h} Z  - (x + \\kappa(\\theta - x)h)\n$$\n$$\nZ  - \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\n$$\n由于 $Z$ 是一个标准正态随机变量，对于某个常数 $c$，概率 $P(Z  c)$ 由标准正态分布的累积分布函数 (CDF) 给出，记为 $\\Phi(c)$。因此，$X_{n+1}$ 为负的概率是：\n$$\nP(X_{n+1}  0) = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\\right)\n$$\n这个表达式根据模型参数、当前状态和时间步长，使用正态分布的标准性质给出了概率，符合要求。\n\n**情况 2：退化扩散（$\\sigma = 0$ 或 $x = 0$）**\n在这种情况下，随机项 $\\sigma \\sqrt{x} \\sqrt{h}Z$ 消失，更新变为确定性的。\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h\n$$\n$X_{n+1}$ 的值是固定的，所以它为负的概率要么是 $0$，要么是 $1$。\n\n子情况 2a：$x = 0$。\n更新方程简化为：\n$$\nX_{n+1} = 0 + \\kappa(\\theta - 0)h = \\kappa\\theta h\n$$\n在 $\\kappa  0$、$\\theta  0$ 的约束下，且时间步长 $h  0$ 的性质下，结果 $\\kappa\\theta h$ 是严格为正的。因此，$X_{n+1}  0$。下一个状态为负的概率是零。\n$$\nP(X_{n+1}  0 \\mid x=0) = 0\n$$\n\n子情况 2b：$\\sigma = 0$（且 $x \\ge 0$）。\nSDE 变成一个常微分方程，$dX_t = \\kappa(\\theta - X_t)dt$，欧拉更新为：\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h\n$$\n一步为负的概率取决于这个确定性值的符号：\n$$\nP(X_{n+1}  0 \\mid \\sigma=0) = \\begin{cases} 1   \\text{如果 } x + \\kappa(\\theta - x)h  0 \\\\ 0  \\text{如果 } x + \\kappa(\\theta - x)h \\ge 0 \\end{cases}\n$$\n\n总而言之，概率 $P_{neg} = P(X_{n+1}  0 \\mid X_n = x)$ 的计算如下：\n1.  如果 $\\sigma = 0$ 或 $x = 0$：\n    - 更新是确定性的：$X_{next} = x + \\kappa(\\theta - x)h$。\n    - 如果 $X_{next}  0$，则 $P_{neg} = 1$。\n    - 如果 $X_{next} \\ge 0$，则 $P_{neg} = 0$。（注意：如上所示，如果 $x=0$，则 $X_{next}  0$，所以 $P_{neg}=0$）\n2.  如果 $\\sigma  0$ 且 $x  0$：\n    - 该概率由标准正态分布的 CDF 给出：\n    $$\n    P_{neg} = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\\right)\n    $$\n这个公式提供了一个完整的方法，用于为任何有效的参数集计算单步为负的概率。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Calculates the one-step negativity probability for the Euler-Maruyama\n    discretization of the Cox-Ingersoll-Ross (CIR) process for several\n    test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (kappa, theta, sigma, x, h)\n    test_cases = [\n        (4.0, 0.04, 0.5, 0.04, 0.25),  # Feller condition satisfied\n        (1.2, 0.05, 0.3, 0.0, 0.1),   # Starts at x=0 (degenerate case)\n        (0.3, 0.02, 0.4, 0.02, 0.5),   # Feller condition violated\n        (10.0, 0.01, 0.0, 0.03, 0.2),  # sigma=0 (degenerate case)\n    ]\n\n    string_results = []\n    for case in test_cases:\n        kappa, theta, sigma, x, h = case\n        \n        prob = 0.0\n\n        # Case 1: Degenerate diffusion term (sigma=0 or x=0)\n        # The update is deterministic.\n        if sigma == 0.0 or x == 0.0:\n            # Deterministic update: X_{n+1} = x + kappa * (theta - x) * h\n            next_val = x + kappa * (theta - x) * h\n            if next_val  0:\n                prob = 1.0\n            else:\n                prob = 0.0\n        \n        # Case 2: Non-degenerate diffusion term (sigma > 0 and x > 0)\n        # The update is stochastic.\n        else:\n            # Argument for the standard normal CDF\n            # C = - (x + kappa*(theta - x)*h) / (sigma * sqrt(x*h))\n            numerator = x + kappa * (theta - x) * h\n            denominator = sigma * np.sqrt(x * h)\n            \n            # The problem of division by zero in the denominator is already\n            # handled by the check for x=0.\n            cdf_arg = -numerator / denominator\n            \n            # The probability is the CDF of the standard normal distribution.\n            prob = norm.cdf(cdf_arg)\n            \n        string_results.append(f\"{prob:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(string_results)}]\")\n\nsolve()\n```", "id": "3047714"}, {"introduction": "认识到简单数值格式的局限性后，自然要寻找更稳健的模拟方法。为了解决负值问题，研究人员已开发出多种修正方案。本练习 [@problem_id:3047718] 将介绍一种流行且直观的“完全截断欧拉格式”，并要求您辨析其正确的构造方式以及它能成功保持非负性的根本原因。", "problem": "考虑 Cox-Ingersoll-Ross 过程，其定义为以下随机微分方程 (SDE) 的解\n$$\ndX_t = \\kappa\\big(\\theta - X_t\\big)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t,\\qquad X_0\\ge 0,\n$$\n其中 $\\kappa0$、$\\theta\\ge 0$ 和 $\\sigma0$ 为常数，$(W_t)_{t\\ge 0}$ 为标准布朗运动。已知其精确解是非负的，并且在 Feller 条件 $2\\kappa\\theta\\ge \\sigma^2$ 下，解是严格为正的。然而，在显式数值模拟中，朴素的近似方法可能会产生负值，这会引发问题，因为扩散系数中包含 $\\sqrt{X_t}$ 项。\n\n本题要求您识别用于在均匀网格 $t_n = n\\,\\Delta t$ 上近似 Cox-Ingersoll-Ross 过程的完全截断欧拉 (Full Truncation Euler, FTE) 离散化的正确描述，其中高斯增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}\\sim\\mathcal{N}(0,\\Delta t)$ 是独立的。具体而言，请选择一个既正确指定了该格式，又正确解释了数值近似在何种意义上保持非负性的陈述。\n\n哪个选项是正确的？\n\nA. 定义 $x^+ = \\max(x,0)$。该格式为：计算一个临时更新值\n$$\n\\widetilde{X}_{n+1} = X_n + \\kappa\\big(\\theta - X_n^+\\big)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n,\n$$\n然后通过设置以下项将其投影到非负轴上\n$$\nX_{n+1} = \\max\\big(\\widetilde{X}_{n+1},\\,0\\big).\n$$\n这保持了数值近似的非负性，因为投影确保了对所有 $n$ 都有 $X_{n+1}\\ge 0$，并且在系数中使用 $X_n^+$ 保证了平方根始终在非负值上求值。\n\nB. 该格式仅在扩散项中使用截断：\n$$\nX_{n+1} = X_n + \\kappa\\big(\\theta - X_n\\big)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n.\n$$\n只要 $2\\kappa\\theta\\ge \\sigma^2$，该格式就能保持非负性，因为 Feller 条件确保了精确过程的正性，因此对于任何时间步长 $\\Delta t0$，离散近似也保持正性。\n\nC. 该格式是隐式的：\n$$\nX_{n+1} = X_n + \\kappa\\big(\\theta - X_{n+1}\\big)\\,\\Delta t + \\sigma \\sqrt{X_{n+1}}\\,\\Delta W_n,\n$$\n而“完全截断”意味着在每一步都精确求解这个非线性方程。非负性得以保持，因为平方根是在 $X_{n+1}$ 处求值，这迫使 $X_{n+1}\\ge 0$。\n\nD. 该格式通过绝对值来反射负值：\n$$\nX_{n+1} = \\big|\\,X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n}\\,\\Delta W_n\\,\\big|.\n$$\n这保持了非负性，因为任何负的更新值都会被翻转为正值，因此后续的平方根是良定义的。", "solution": "评估问题陈述的有效性。\n\n**步骤1：提取给定信息**\n-   过程：Cox-Ingersoll-Ross (CIR)\n-   SDE: $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$\n-   初始条件：$X_0 \\ge 0$\n-   参数：$\\kappa0$, $\\theta\\ge 0$, $\\sigma0$\n-   随机驱动项：$(W_t)_{t\\ge 0}$ 是标准布朗运动。\n-   已知性质1：精确解 $X_t$ 是非负的。\n-   已知性质2 (Feller 条件)：$2\\kappa\\theta\\ge \\sigma^2$ 意味着精确解是严格为正的。\n-   数值背景：在均匀网格 $t_n = n\\,\\Delta t$ 上对 SDE 进行显式模拟，使用独立的高斯增量 $\\Delta W_n \\sim\\mathcal{N}(0,\\Delta t)$。\n-   问题来源：朴素近似可能产生负值，导致 $\\sqrt{X_t}$ 未定义。\n-   问题：识别完全截断欧拉 (FTE) 离散化的正确描述及其保持非负性的机制。\n\n**步骤2：使用提取的给定信息进行验证**\n-   **科学基础：** 该问题牢固地植根于数值求解随机微分方程这一成熟领域，特别是关于广泛使用的 Cox-Ingersoll-Ross 模型。SDE、Feller 条件以及所描述的数值挑战都是计算金融和随机分析中的标准且事实正确的主题。\n-   **良构性：** 问题是具体的，要求识别一个命名数值格式，即“完全截断欧拉”方法的定义和性质。该术语在相关文献中有标准含义，使得问题可回答且无歧义。\n-   **客观性：** 语言技术性强且精确。问题要求识别一个形式化定义和一个因果机制，这些都是客观问题。\n\n**步骤3：结论与行动**\n-   **结论：** 该问题有效。它在科学上是合理的、良构的、客观的，并包含继续进行所需的所有必要信息。\n-   **行动：** 对选项进行全面推导和分析。\n\nCox-Ingersoll-Ross (CIR) 过程由以下 SDE 给出：\n$$\ndX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t\n$$\n在网格 $t_n = n\\Delta t$ 上的一个朴素的 Euler-Maruyama 离散化是：\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n}\\,\\Delta W_n\n$$\n其中 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$。项 $\\Delta W_n$ 可以是负的且量级很大，可能导致总和为负，特别是当 $X_n$ 接近 $0$ 时。如果 $X_{n+1}$ 变为负数，那么在后续的步骤 $n+2$ 中，项 $\\sqrt{X_{n+1}}$ 就没有明确定义，导致模拟失败。为解决此问题已开发了多种格式。问题要求识别“完全截断欧拉”(FTE) 格式。这个名称表明通过全面应用截断来强制实现非负性。\n\n我们来分析各个选项。\n\n**选项 A**\n该格式被指定为一个两步过程：\n1.  计算一个临时值 $\\widetilde{X}_{n+1} = X_n + \\kappa(\\theta - X_n^+)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n$。\n2.  将最终值设为 $X_{n+1} = \\max(\\widetilde{X}_{n+1}, 0)$。\n\n这里，$X_n^+ = \\max(X_n, 0)$。这个表述是完全截断欧拉格式（也称为投影欧拉格式）的标准形式。我们来分析其性质和给定的解释。\n\n过程从 $X_0 \\ge 0$ 开始。在第 $n$ 步，我们假设 $X_n \\ge 0$。\n- 更新的系数是使用 $X_n^+$ 计算的。由于我们假设 $X_n \\ge 0$，我们有 $X_n^+ = X_n$。这意味着项 $\\sqrt{X_n^+}$ 就是 $\\sqrt{X_n}$，并且始终是良定义的。使用正部 $X_n^+$ 是一种保障措施，使定义更加稳健。\n- 如前所述，临时值 $\\widetilde{X}_{n+1}$ 可以是负的。\n- 最后一步，$X_{n+1} = \\max(\\widetilde{X}_{n+1}, 0)$，将（可能为负的）临时值显式地投影到非负实数轴上。根据定义，这保证了 $X_{n+1} \\ge 0$。\n\n提供的解释是：“这保持了数值近似的非负性，因为投影确保了对所有 $n$ 都有 $X_{n+1}\\ge 0$，并且在系数中使用 $X_n^+$ 保证了平方根始终在非负值上求值。” 这是对该机制的完整且正确的描述。该格式确保了每一步的输入有效（通过 $X_n^+$），并确保每一步的输出非负（通过 $\\max(\\cdot, 0)$）。\n**结论：正确**\n\n**选项 B**\n该格式被指定为：\n$$\nX_{n+1} = X_n + \\kappa( \\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n\n$$\n这种格式被称为*部分截断*格式或 Higham-Mao 格式。它只截断了扩散系数的参数。这种格式仍然可能产生负的 $X_{n+1}$ 值，因为没有机制可以阻止总和变为负数。因此，“完全截断”这个名称不适用。\n\n给出的解释是，在 Feller 条件 $2\\kappa\\theta \\ge \\sigma^2$ 下，非负性得以保持。这是不正确的。Feller 条件保证了*连续时间精确过程* $X_t$ 的路径正性，而不是其对于有限时间步长 $\\Delta t  0$ 的离散欧拉类型近似。一个众所周知的事实是，无论 Feller 条件是否成立，这种格式在模拟中都可能并且确实会产生负值。\n**结论：不正确**\n\n**选项 C**\n该格式被指定为一个隐式方程：\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_{n+1})\\,\\Delta t + \\sigma \\sqrt{X_{n+1}}\\,\\Delta W_n\n$$\n这是一个*隐式欧拉格式*。“完全截断欧拉”格式是一种*显式*格式。因此，该选项错误地识别了格式。此外，其解释称非负性得以保持是因为方程中出现了 $\\sqrt{X_{n+1}}$，这也是有问题的。虽然任何实数解 $X_{n+1}$ 都必须是非负的，但这并不能保证对于 $\\Delta W_n$ 的任何实现都存在且唯一这样的实数解。对于一个大的负值 $\\Delta W_n$，可能不存在 $X_{n+1}$ 的实数解。\n**结论：不正确**\n\n**选项 D**\n该格式被指定为：\n$$\nX_{n+1} = \\big|\\,X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n}\\,\\Delta W_n\\,\\big|\n$$\n这种格式被称为*反射欧拉格式*。它通过取更新值的绝对值来强制实现非负性。其在边界 $X=0$ 附近的动态行为与截断格式（它将值设为 $0$，暂时将过程吸收在边界上）不同。“完全截断”这个名称与反射操作（取绝对值）不一致。虽然该格式确实保持了非负性，但它不是问题中所要求的格式。\n**结论：不正确**\n\n总而言之，选项A既提供了完全截断欧拉格式的正确定义，也提供了其如何稳健地保持近似过程非负性的正确解释。", "answer": "$$\\boxed{A}$$", "id": "3047718"}]}