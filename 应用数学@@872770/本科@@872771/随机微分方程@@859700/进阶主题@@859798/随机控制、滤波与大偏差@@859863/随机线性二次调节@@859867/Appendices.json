{"hands_on_practices": [{"introduction": "随机线性二次调节器（SLQR）的目标不仅是找到最优反馈增益，更重要的是理解在随机噪声影响下，受控系统的实际表现。本练习将引导你完成一个典型的标量系统分析，从推导最优控制律开始，到计算系统在最优控制下的稳态方差。通过这个过程，你将学会如何量化控制性能，将抽象的控制理论与具体的系统行为联系起来。[@problem_id:3077740]", "problem": "考虑标量受控的伊藤随机微分方程（SDE）\n$$\n\\mathrm{d}x_t = a\\,x_t\\,\\mathrm{d}t + b\\,u_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $a \\in \\mathbb{R}$，$b \\neq 0$，$\\sigma  0$，并且 $\\{W_t\\}_{t \\ge 0}$ 是一个标准维纳过程。性能准则是无限时域遍历平均成本\n$$\nJ(u) \\;=\\; \\limsup_{T \\to \\infty} \\frac{1}{T}\\,\\mathbb{E}\\!\\left[\\int_0^T \\big(q\\,x_t^2 + r\\,u_t^2\\big)\\,\\mathrm{d}t\\right],\n$$\n其中 $q0$ 且 $r0$。假设状态完全可观测，并将注意力限制在形式为 $u_t = \\pi(x_t)$ 的时不变状态反馈控制上，这类控制能使闭环系统均方稳定。\n\n从遍历成本的动态规划原理和 Hamilton–Jacobi–Bellman (HJB) 方程出发，推导最优的无限时域线性二次调节器 (LQR) 反馈律，并证明闭环动力学是 Ornstein–Uhlenbeck 过程。然后，计算在最优反馈下 $x_t$ 的平稳（稳态）方差 $\\operatorname{Var}_{\\pi}(x_t)$，将其表示为 $a$、$b$、$q$、$r$ 和 $\\sigma$ 的显式函数。最后，定性解释平稳方差如何依赖于扩散强度 $\\sigma$。\n\n你最终报告的答案必须是稳态方差 $\\operatorname{Var}_{\\pi}(x_t)$ 关于 $a$、$b$、$q$、$r$ 和 $\\sigma$ 的单一闭式表达式。无需四舍五入。", "solution": "指定的问题是一个连续时间、无限时域、标量随机线性二次调节器 (LQR) 问题，其性能准则为遍历（平均成本）。我们首先验证问题陈述的有效性。\n\n给定条件如下：\n- 状态动力学，一个线性伊藤随机微分方程 (SDE): $\\mathrm{d}x_t = a\\,x_t\\,\\mathrm{d}t + b\\,u_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$，参数为 $a \\in \\mathbb{R}$，$b \\neq 0$ 和 $\\sigma  0$。\n- 成本泛函：$J(u) = \\limsup_{T \\to \\infty} \\frac{1}{T}\\,\\mathbb{E}\\!\\left[\\int_0^T (q\\,x_t^2 + r\\,u_t^2)\\,\\mathrm{d}t\\right]$，权重因子为 $q0$ 和 $r0$。\n- 容许控制类：时不变状态反馈律 $u_t = \\pi(x_t)$ 确保闭环系统的均方稳定性。\n\n该问题具有科学依据，是适定且客观的。它是随机控制理论中的一个典型问题。系统是可控的（因为 $b \\neq 0$），并且成本函数是凸的，其状态和控制的权重是正定的，这保证了唯一的最优稳定控制律的存在。因此，该问题是有效的。\n\n我们继续求解，从遍历成本问题的动态规划原理开始。该原理引出了 Hamilton–Jacobi–Bellman (HJB) 方程。对于给定的状态 $x$ 和控制 $u$，成本率为 $L(x, u) = q\\,x^2 + r\\,u^2$。作用于二次可微函数 $V(x)$ 的 SDE 的无穷小生成元由下式给出\n$$\n\\mathcal{A}^u V(x) = (a\\,x + b\\,u)\\frac{\\mathrm{d}V}{\\mathrm{d}x} + \\frac{1}{2}\\sigma^2\\frac{\\mathrm{d}^2V}{\\mathrm{d}x^2}.\n$$\n最优平均成本 $\\rho$ 的 HJB 方程为\n$$\n\\rho = \\min_{u \\in \\mathbb{R}} \\left\\{ q\\,x^2 + r\\,u^2 + \\mathcal{A}^u V(x) \\right\\},\n$$\n其中 $V(x)$ 是相对价值函数。代入生成元，我们得到\n$$\n\\rho = \\min_{u \\in \\mathbb{R}} \\left\\{ q\\,x^2 + r\\,u^2 + (a\\,x + b\\,u)V'(x) + \\frac{1}{2}\\sigma^2V''(x) \\right\\}.\n$$\n最小值内部的表达式是关于 $u$ 的凸二次函数。通过将关于 $u$ 的偏导数设为零来找到最小值：\n$$\n\\frac{\\partial}{\\partial u} \\left[ r\\,u^2 + b\\,u\\,V'(x) \\right] = 2\\,r\\,u + b\\,V'(x) = 0.\n$$\n这得到了反馈形式的最优控制律：\n$$\nu^*(x) = -\\frac{b}{2r}V'(x).\n$$\n我们将这个最优控制代回 HJB 方程：\n$$\n\\rho = q\\,x^2 + r\\left(-\\frac{b}{2r}V'(x)\\right)^2 + \\left(a\\,x + b\\left(-\\frac{b}{2r}V'(x)\\right)\\right)V'(x) + \\frac{1}{2}\\sigma^2V''(x).\n$$\n化简表达式可得\n$$\n\\rho = q\\,x^2 + \\frac{b^2}{4r}(V'(x))^2 + a\\,x\\,V'(x) - \\frac{b^2}{2r}(V'(x))^2 + \\frac{1}{2}\\sigma^2V''(x),\n$$\n$$\n\\rho = q\\,x^2 + a\\,x\\,V'(x) - \\frac{b^2}{4r}(V'(x))^2 + \\frac{1}{2}\\sigma^2V''(x).\n$$\n对于具有二次成本的线性系统，我们假设一个二次相对价值函数，其形式为 $V(x) = \\frac{1}{2}Px^2$，其中 $P$ 是一个待定常数。其导数为 $V'(x) = Px$ 和 $V''(x) = P$。将它们代入 HJB 方程：\n$$\n\\rho = q\\,x^2 + a\\,x\\,(Px) - \\frac{b^2}{4r}(Px)^2 + \\frac{1}{2}\\sigma^2P.\n$$\n合并 $x$ 的幂次项：\n$$\n\\rho = \\left(q + aP - \\frac{b^2P^2}{4r}\\right)x^2 + \\frac{1}{2}\\sigma^2P.\n$$\n这个方程必须对所有 $x \\in \\mathbb{R}$ 成立。这只有在 $x^2$ 项的系数为零时才可能。这个要求产生了标量代数 Riccati 方程 (ARE)：\n$$\nq + aP - \\frac{b^2}{4r}P^2 = 0 \\quad \\implies \\quad \\frac{b^2}{4r}P^2 - aP - q = 0.\n$$\n这个二次方程关于 $P$ 的解是\n$$\nP = \\frac{a \\pm \\sqrt{a^2 - 4\\left(\\frac{b^2}{4r}\\right)(-q)}}{2\\left(\\frac{b^2}{4r}\\right)} = \\frac{a \\pm \\sqrt{a^2 + \\frac{b^2q}{r}}}{\\frac{b^2}{2r}} = \\frac{2r}{b^2}\\left(a \\pm \\sqrt{a^2 + \\frac{b^2q}{r}}\\right).\n$$\n问题要求一个能使系统均方稳定的控制。最优控制为 $u_t = u^*(x_t) = -\\frac{b}{2r}V'(x_t) = -\\frac{b P}{2r}x_t$。闭环 SDE 变为\n$$\n\\mathrm{d}x_t = \\left(a - \\frac{b^2P}{2r}\\right)x_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t.\n$$\n为了使这个线性 SDE 均方稳定，漂移系数必须为负：$a_{cl} = a - \\frac{b^2P}{2r}  0$。\n因为 $q0$, $r0$，我们有 $\\sqrt{a^2 + b^2q/r}  \\sqrt{a^2} = |a|$。\n解 $P_{-} = \\frac{2r}{b^2}\\left(a - \\sqrt{a^2 + \\frac{b^2q}{r}}\\right)$ 是负的，因为 $a  \\sqrt{a^2 + \\dots}$。负的 $P$ 将意味着负的价值（成本），这对于一个具有 $q0, r0$ 的成本函数是不一致的。\n另一个解，$P_{+} = \\frac{2r}{b^2}\\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right)$，是正的，因为 $a + \\sqrt{a^2+\\dots}  a+|a| \\ge 0$。让我们用 $P=P_{+}$ 检查稳定性条件：\n$$\na_{cl} = a - \\frac{b^2}{2r} P_{+} = a - \\frac{b^2}{2r} \\frac{2r}{b^2}\\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) = a - \\left(a + \\sqrt{a^2 + \\frac{b^2q}{r}}\\right) = -\\sqrt{a^2 + \\frac{b^2q}{r}}.\n$$\n由于 $b \\neq 0$，$q  0$，$r  0$，平方根下的项是严格为正的，所以 $a_{cl}  0$。因此，$P = P_{+}$ 是 ARE 的唯一正定解，它提供了一个稳定的反馈控制。\n\n闭环系统由以下 SDE 描述\n$$\n\\mathrm{d}x_t = a_{cl}\\,x_t\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t, \\quad \\text{其中} \\quad a_{cl} = -\\sqrt{a^2 + \\frac{b^2q}{r}}.\n$$\n这是一个 Ornstein–Uhlenbeck (OU) 过程的方程，其一般形式为 $\\mathrm{d}X_t = -\\theta X_t \\mathrm{d}t + \\nu \\mathrm{d}W_t$。在我们的例子中，均值回归率为 $\\theta = -a_{cl}  0$，波动率为 $\\nu = \\sigma$。\n\n一个 OU 过程有一个平稳（或遍历）分布，它是一个均值为 $0$、方差为 $\\operatorname{Var}(X) = \\frac{\\nu^2}{2\\theta}$ 的高斯分布。\n将此应用于我们的闭环系统，在最优控制策略 $\\pi$ 下，$x_t$ 的平稳方差是\n$$\n\\operatorname{Var}_{\\pi}(x_t) = \\frac{\\sigma^2}{2(-a_{cl})} = \\frac{\\sigma^2}{2\\sqrt{a^2 + \\frac{b^2q}{r}}}.\n$$\n\n最后，我们分析平稳方差对扩散强度 $\\sigma$ 的依赖性。推导出的公式表明 $\\operatorname{Var}_{\\pi}(x_t)$ 与 $\\sigma^2$ 成正比。定性地看，$\\sigma$ 代表了扰动系统的随机噪声的幅度。$\\sigma$ 的增加意味着更强的随机力，将状态推离其在 $x=0$ 的平衡点。虽然最优控制器持续作用以调节状态，但更大的噪声自然会导致更大的平稳波动。方差，作为与均值的期望平方偏差，随噪声振幅呈二次方比例缩放。这是由白噪声驱动的线性系统的一个基本特征。", "answer": "$$\\boxed{\\frac{\\sigma^2}{2\\sqrt{a^2 + \\frac{b^2 q}{r}}}}$$", "id": "3077740"}, {"introduction": "在许多实际工程问题中，我们可能只关心系统的某些特定状态，例如飞行器的姿态或机械臂的位置，而对其他状态（如角速度或关节速度）没有直接的成本考量。本练习探讨了这样一个场景：成本函数仅惩罚一个两状态系统中的一个状态。你将通过求解代数黎卡提方程（ARE）发现，最优控制器仍然会间接地调节那个未被直接惩罚的状态，这揭示了系统动力学模型在最优控制设计中的关键作用。[@problem_id:3077758]", "problem": "考虑由标准布朗运动（维纳过程）驱动的连续时间线性随机系统\n$$\nd x(t) = \\big(A\\,x(t) + B\\,u(t)\\big)\\,dt + D\\,dW_t,\n$$\n其状态为 $x(t) \\in \\mathbb{R}^{2}$，控制为 $u(t) \\in \\mathbb{R}$，矩阵为\n$$\nA=\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix},\\quad B=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad D=\\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix},\n$$\n其中 $\\sigma0$ 是一个固定常数。考虑无限时域遍历平均成本\n$$\nJ(u) = \\limsup_{T\\to\\infty}\\frac{1}{T}\\,\\mathbb{E}\\left[ \\int_{0}^{T} \\Big(x(t)^{\\top} Q\\, x(t) + u(t)^{\\top} R\\, u(t)\\Big)\\,dt \\right],\n$$\n其中状态惩罚 $Q$ 仅惩罚第一个分量，\n$$\nQ=\\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix},\\quad q0,\n$$\n且控制惩罚为 $R=1$。假设全状态反馈是允许的，并且存在一个平稳最优解。\n\n从随机动态规划原理和遍历平均成本的汉密尔顿-雅可比-贝尔曼（HJB）方程出发，并假设一个二次价值函数，推导形式为 $u(t)=-K\\,x(t)$ 的平稳最优状态反馈控制律，其中 $K\\in\\mathbb{R}^{1\\times 2}$。具体而言：\n\n1. 推导决定价值函数二次型和最优反馈增益的代数条件。\n2. 对当前系统显式求解此代数条件，并计算最优增益 $K$ 作为 $q$ 的函数的精确闭式解。\n3. 在推导过程中，解释为什么噪声强度 $\\sigma$ 不影响最优反馈增益，并阐明第二个（未被惩罚的）状态如何通过系统动力学被间接调节。\n\n请以 $1\\times 2$ 行向量的形式给出最优增益 $K$ 的精确表达式。不需要数值四舍五入。最终答案中不包含单位。请使用 $\\text{pmatrix}$ 格式表示您的最终答案。", "solution": "该问题是有效的，因为它构成了一个适定且标准的随机线性二次调节问题，具有无限时域遍历平均成本。所有必要的参数和条件都已提供，不存在科学或逻辑上的矛盾。\n\n系统动力学由以下随机微分方程（SDE）给出：\n$$\nd x(t) = \\big(A\\,x(t) + B\\,u(t)\\big)\\,dt + D\\,dW_t\n$$\n其状态为 $x(t) \\in \\mathbb{R}^{2}$，控制为 $u(t) \\in \\mathbb{R}$。矩阵为：\n$$\nA=\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix},\\quad B=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad D=\\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix}\n$$\n目标是最小化无限时域遍历平均成本：\n$$\nJ(u) = \\limsup_{T\\to\\infty}\\frac{1}{T}\\,\\mathbb{E}\\left[ \\int_{0}^{T} \\Big(x(t)^{\\top} Q\\, x(t) + u(t)^{\\top} R\\, u(t)\\Big)\\,dt \\right]\n$$\n其中加权矩阵为：\n$$\nQ=\\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix},\\quad q0,\\quad R=1\n$$\n\n### 1. 代数条件的推导\n解是利用随机动态规划的原理找到的。对于遍历平均成本问题，汉密尔顿-雅可比-贝尔曼（HJB）方程为：\n$$\n\\rho = \\min_{u} \\left\\{ \\mathcal{L}^u V(x) + l(x, u) \\right\\}\n$$\n这里，$\\rho$ 是最优平均成本（一个常数），$V(x)$ 是微分价值函数，$l(x, u) = x^{\\top} Q x + u^{\\top} R u$ 是运行成本，而 $\\mathcal{L}^u$ 是给定控制 $u$ 下过程 $x(t)$ 的无穷小生成元。对于给定的SDE，作用于一个二阶可微函数 $V(x)$ 的生成元是：\n$$\n\\mathcal{L}^u V(x) = \\nabla V(x)^{\\top} (Ax + Bu) + \\frac{1}{2} \\text{Tr}\\left( D^{\\top} \\text{Hess}(V(x)) D \\right)\n$$\n其中 $\\nabla V(x)$ 是梯度，$\\text{Hess}(V(x))$ 是 $V(x)$ 的海森矩阵。\n\n给定线性和二次成本，我们假设一个二次微分价值函数，其形式为 $V(x) = x^{\\top} P x$，其中 $P$ 是一个对称半正定矩阵。梯度和海森矩阵分别为 $\\nabla V(x) = 2Px$ 和 $\\text{Hess}(V(x)) = 2P$。将这些代入生成元得到：\n$$\n\\mathcal{L}^u V(x) = (2Px)^{\\top} (Ax + Bu) + \\frac{1}{2} \\text{Tr}(D^{\\top} (2P) D) = 2x^{\\top}P(Ax+Bu) + \\text{Tr}(D^{\\top}PD)\n$$\nHJB 方程变为：\n$$\n\\rho = \\min_{u} \\left\\{ 2x^{\\top}PAx + 2x^{\\top}PBu + \\text{Tr}(D^{\\top}PD) + x^{\\top}Qx + u^{\\top}Ru \\right\\}\n$$\n为了找到最优控制 $u^*$，我们关于 $u$ 最小化该表达式。涉及 $u$ 的项是 $2x^{\\top}PBu + u^{\\top}Ru$。这是一个关于 $u$ 的二次函数。对其关于 $u$ 求导并令其为零，得到：\n$$\n\\frac{\\partial}{\\partial u} (2x^{\\top}PBu + u^{\\top}Ru) = 2(PBx)^{\\top} + 2Ru = 2B^{\\top}Px + 2Ru = 0\n$$\n由于 $R  0$，我们可以解出最优控制律：\n$$\nu^*(t) = -R^{-1}B^{\\top}Px(t)\n$$\n这是一个线性状态反馈控制律 $u(t) = -Kx(t)$，最优增益矩阵为 $K = R^{-1}B^{\\top}P$。\n\n将 $u^*$ 代回 HJB 方程：\n$$\n\\rho = 2x^{\\top}PAx + 2x^{\\top}PB(-R^{-1}B^{\\top}Px) + \\text{Tr}(D^{\\top}PD) + x^{\\top}Qx + (-R^{-1}B^{\\top}Px)^{\\top}R(-R^{-1}B^{\\top}Px)\n$$\n$$\n\\rho = x^{\\top}(A^{\\top}P+PA)x - 2x^{\\top}PBR^{-1}B^{\\top}Px + \\text{Tr}(D^{\\top}PD) + x^{\\top}Qx + x^{\\top}PBR^{-1}B^{\\top}Px\n$$\n$$\n\\rho = x^{\\top}\\left( A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q \\right)x + \\text{Tr}(D^{\\top}PD)\n$$\n此方程必须对所有 $x(t) \\in \\mathbb{R}^2$ 成立。这只有当 $x$ 的二次项恒为零时才可能成立。这给出了决定 $P$ 的代数条件：\n$$\nA^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q = 0\n$$\n这就是连续时间代数黎卡提方程（CARE）。该方程决定了矩阵 $P$，并因此决定了最优反馈增益 $K = R^{-1}B^{\\top}P$。最优平均成本则由 $\\rho = \\text{Tr}(D^{\\top}PD)$ 给出。\n\n### 3. 增益与噪声的无关性及对第二状态的调节\n决定矩阵 $P$ 从而决定最优增益 $K$ 的CARE方程 $A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q = 0$ 不涉及噪声矩阵 $D$ 或其强度 $\\sigma$。这是LQG控制中分离原理或确定性等价的一种体现：最优反馈增益与确定性问题（其中$D=0$）的增益相同。噪声只影响可实现的最小成本 $\\rho = \\text{Tr}(D^{\\top}PD)$，而不影响最优控制策略。\n\n状态向量为 $x(t) = [x_1(t), x_2(t)]^{\\top}$，其中 $x_1$ 是位置，$x_2$ 是速度（$dx_1/dt = x_2$）。成本函数 $x^{\\top}Qx = qx_1^2$ 只惩罚位置 $x_1$。然而，为了保持 $x_1$ 较小，控制器必须调节 $x_2$。如果 $x_2$ 不被驱向零，$x_1$ 将会积分到很大的值，导致高成本。最优控制器利用来自两个状态的反馈 $u = -k_1x_1 - k_2x_2$ 来稳定整个系统。来自 $x_2$ 的反馈（速度反馈）为系统提供了必要的阻尼，确保位置和速度都在随机意义下收敛到原点。\n\n### 2. 最优增益的显式解\n我们现在为给定系统求解CARE。令 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$ 为对称解矩阵。\n矩阵为 $A=\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$，$B=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$Q=\\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix}$ 和 $R=1$。\n\n我们计算CARE的各项：\n$A^{\\top}P + PA = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}\\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  p_{11} \\\\ p_{11}  2p_{12} \\end{pmatrix}$。\n对于二次项 $PBR^{-1}B^{\\top}P$，我们先计算 $PB$ 和 $B^{\\top}P$：\n$PB = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} p_{12} \\\\ p_{22} \\end{pmatrix}$，且 $B^{\\top}P = (PB)^{\\top} = \\begin{pmatrix} p_{12}  p_{22} \\end{pmatrix}$。\n因此，$PBR^{-1}B^{\\top}P = (PB)(1)(B^{\\top}P) = \\begin{pmatrix} p_{12} \\\\ p_{22} \\end{pmatrix} \\begin{pmatrix} p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{12}^2  p_{12}p_{22} \\\\ p_{12}p_{22}  p_{22}^2 \\end{pmatrix}$。\n\nCARE变为：\n$$\n\\begin{pmatrix} 0  p_{11} \\\\ p_{11}  2p_{12} \\end{pmatrix} - \\begin{pmatrix} p_{12}^2  p_{12}p_{22} \\\\ p_{12}p_{22}  p_{22}^2 \\end{pmatrix} + \\begin{pmatrix} q  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} q - p_{12}^2  p_{11} - p_{12}p_{22} \\\\ p_{11} - p_{12}p_{22}  2p_{12} - p_{22}^2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n这产生了一个包含三个代数方程的方程组：\n1. $q - p_{12}^2 = 0 \\implies p_{12}^2 = q$\n2. $2p_{12} - p_{22}^2 = 0 \\implies p_{22}^2 = 2p_{12}$\n3. $p_{11} - p_{12}p_{22} = 0 \\implies p_{11} = p_{12}p_{22}$\n\n由(1)，因为 $q0$，我们有 $p_{12} = \\pm\\sqrt{q}$。为了使闭环系统稳定，解 $P$ 必须是正定的。由(2)，$p_{22}^2 = 2p_{12}$。为了使 $p_{22}$ 是实数，$p_{12}$ 必须是非负的。这要求 $p_{12} = \\sqrt{q}$。\n当 $p_{12} = \\sqrt{q}$ 时，方程(2)给出 $p_{22}^2 = 2\\sqrt{q}$。由于 $p_{22}$ 必须是正定矩阵的正对角元素，我们取正根：$p_{22} = \\sqrt{2\\sqrt{q}}$。\n由(3)，我们得到 $p_{11} = p_{12}p_{22} = \\sqrt{q} \\sqrt{2\\sqrt{q}} = \\sqrt{2}q^{\\frac{3}{4}}$。\n解矩阵为 $P = \\begin{pmatrix} \\sqrt{2}q^{\\frac{3}{4}}  \\sqrt{q} \\\\ \\sqrt{q}  \\sqrt{2\\sqrt{q}} \\end{pmatrix}$。由于 $p_{11}0$ 且 $\\det(P) = p_{11}p_{22} - p_{12}^2 = (\\sqrt{2}q^{\\frac{3}{4}})(\\sqrt{2\\sqrt{q}}) - (\\sqrt{q})^2 = 2q-q=q0$，$P$ 是正定的。\n\n最优反馈增益 $K$ 由下式给出：\n$$\nK = R^{-1}B^{\\top}P = (1) \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{12}  p_{22} \\end{pmatrix}\n$$\n代入推导出的 $p_{12}$ 和 $p_{22}$ 的值：\n$$\nK = \\begin{pmatrix} \\sqrt{q}  \\sqrt{2\\sqrt{q}} \\end{pmatrix}\n$$\n这就是平稳最优状态反馈增益。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{q}  \\sqrt{2\\sqrt{q}} \\end{pmatrix}}\n$$", "id": "3077758"}, {"introduction": "代数黎卡提方程存在唯一的、能使闭环系统稳定的正定解，这并不是一个理所当然的结果，而是依赖于系统本身具备的某些基本性质。本练习可以看作是对LQR理论的一次“压力测试”，它将引导你构建一个“可镇定性”满足但“可检测性”失效的特殊案例。通过亲手找出一个非稳定的ARE解，你将深刻理解LQR框架背后那些重要假设的意义，并认识到为何这些理论保证如此重要。[@problem_id:3077744]", "problem": "考虑伊藤随机微分方程的无穷时域随机线性二次调节器问题\n$$\nd x(t) = A x(t)\\, dt + B u(t)\\, dt + D\\, dW_t,\n$$\n其中 $x(t) \\in \\mathbb{R}^{n}$ 是状态，$u(t) \\in \\mathbb{R}^{m}$ 是控制，$A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$，$D \\in \\mathbb{R}^{n \\times r}$，并且 $W_t$ 是一个 $r$ 维标准维纳过程。代价函数为\n$$\nJ(u) = \\mathbb{E}\\left[ \\int_{0}^{\\infty} x(t)^{\\top} Q\\, x(t) + u(t)^{\\top} R\\, u(t)\\, dt \\right],\n$$\n其中 $Q \\in \\mathbb{R}^{n \\times n}$ 是对称半正定矩阵，$R \\in \\mathbb{R}^{m \\times m}$ 是对称正定矩阵。如果矩阵 $A$ 的所有具有非负实部的特征值都能通过 $B$ 在 Hautus 测试意义下是可控的，则称矩阵对 $(A,B)$ 是可镇定的；如果矩阵 $A$ 的所有具有非负实部的特征值都能通过 $C$ 在 Hautus 测试意义下是可观测的，则称矩阵对 $(C,A)$ 是可检测的。代数 Riccati 方程 (ARE) 是由动态规划和 Hamilton-Jacobi-Bellman (HJB) 方程产生的二次价值函数的稳态条件。\n\n仅使用这些基本定义和事实，执行以下步骤：\n\n- 使用动态规划和 Hamilton-Jacobi-Bellman 方程，推导决定随机线性二次调节器问题二次价值函数 $V(x) = x^{\\top} P x$ 的稳态矩阵方程。清晰解释扩散项 $D\\, dW_t$ 的存在如何进入推导过程，以及为什么它不改变关于 $P$ 的矩阵方程。\n\n- 考虑具体数据 $n=2$，$m=1$，其中\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}, \\quad R = \\begin{pmatrix} 1 \\end{pmatrix},\n$$\n并选择任何具有有限 $r \\geq 1$ 的 $D \\in \\mathbb{R}^{2 \\times r}$。根据第一性原理验证 $(A,B)$ 是可镇定的，而 $(Q^{1/2},A)$ 是不可检测的。你的验证必须依赖于通过 Hautus 秩条件的定义。\n\n- 完全求解 $P \\in \\mathbb{R}^{2 \\times 2}$ 且 $P = P^{\\top}$ 的稳态矩阵方程，并找出所有解。\n\n- 对你找到的解，确定相应的闭环矩阵 $A_{\\text{cl}} = A - B R^{-1} B^{\\top} P$ 并通过计算其特征值来对其稳定性进行分类。从可检测性失效的角度解释，为什么至少有一个矩阵方程的解会产生一个非渐近稳定的闭环矩阵。\n\n作为你最终报告的量，给出与矩阵方程的非镇定解相关的 $A_{\\text{cl}}$ 的不稳定特征值。精确表达你的答案，无需四舍五入。", "solution": "该问题的分析将按要求分四部分进行：通过 Hamilton-Jacobi-Bellman (HJB) 方程推导稳态矩阵方程，验证系统性质（可镇定性和可检测性），求解所得的代数 Riccati 方程 (ARE)，以及分析闭环系统的稳定性。\n\n第一部分：稳态矩阵方程的推导\n\n该问题旨在为由伊藤随机微分方程 (SDE) 描述的系统最小化代价泛函\n$$\nJ(u) = \\mathbb{E}\\left[ \\int_{0}^{\\infty} \\left(x(t)^{\\top} Q\\, x(t) + u(t)^{\\top} R\\, u(t)\\right) dt \\right]\n$$\n$$\nd x(t) = (A x(t) + B u(t))\\, dt + D\\, dW_t.\n$$\n我们使用动态规划方法。设价值函数为 $V(x)$，表示从状态 $x$ 出发的最小期望代价。对于一个无穷时域、时不变问题，我们假设 $V$ 与时间无关。这个随机最优控制问题的 HJB 方程是\n$$\n\\min_{u \\in \\mathbb{R}^m} \\left\\{ \\mathcal{L}^u V(x) + x^{\\top} Q x + u^{\\top} R u \\right\\} = 0,\n$$\n其中 $\\mathcal{L}^u$ 是在控制 $u(t)$ 下过程 $x(t)$ 的无穷小生成元。对于一个伊藤过程 $dx = f(x,u)dt + G(x,u)dW_t$，生成元作用于一个二次可微函数 $\\phi(x)$ 的结果是\n$$\n\\mathcal{L}^u \\phi(x) = \\nabla \\phi(x)^{\\top} f(x,u) + \\frac{1}{2} \\mathrm{Tr}\\left(G(x,u)^{\\top} (\\nabla^2 \\phi(x)) G(x,u)\\right).\n$$\n在我们的情况下，$f(x,u) = Ax + Bu$，且扩散矩阵 $G(x,u) = D$ 是常数。我们假设一个二次价值函数 $V(x) = x^{\\top} P x$，其中 $P \\in \\mathbb{R}^{n \\times n}$ 是一个对称矩阵。$V(x)$ 的梯度是 $\\nabla V(x) = 2Px$，Hessian 矩阵是 $\\nabla^2 V(x) = 2P$。\n\n生成元项变为\n$$\n\\mathcal{L}^u V(x) = (2Px)^{\\top} (Ax + Bu) + \\frac{1}{2} \\mathrm{Tr}(D^{\\top} (2P) D) = 2x^{\\top}P(Ax+Bu) + \\mathrm{Tr}(D^{\\top}PD).\n$$\n将此代入 HJB 方程，我们得到\n$$\n\\min_{u \\in \\mathbb{R}^m} \\left\\{ 2x^{\\top}PAx + 2x^{\\top}PBu + \\mathrm{Tr}(D^{\\top}PD) + x^{\\top}Qx + u^{\\top}Ru \\right\\} = 0.\n$$\n最小化括号内的表达式是哈密顿量。为了找到最优控制 $u^*$，我们将哈密顿量对 $u$ 求导并令其结果为零：\n$$\n\\frac{\\partial}{\\partial u} \\left( \\dots \\right) = 2B^{\\top}Px + 2Ru = 0.\n$$\n由于 $R$ 是正定的，它是可逆的，从而得到最优反馈控制律：\n$$\nu^*(x) = -R^{-1}B^{\\top}Px.\n$$\n现在，我们将 $u^*$ 代回 HJB 方程：\n$$\n2x^{\\top}PAx + 2x^{\\top}PB(-R^{-1}B^{\\top}Px) + \\mathrm{Tr}(D^{\\top}PD) + x^{\\top}Qx + (-R^{-1}B^{\\top}Px)^{\\top}R(-R^{-1}B^{\\top}Px) = 0.\n$$\n简化涉及 $u^*$ 的项：\n$$\n-2x^{\\top}PBR^{-1}B^{\\top}Px + x^{\\top}PB(R^{-1})^{\\top}RR^{-1}B^{\\top}Px = -2x^{\\top}PBR^{-1}B^{\\top}Px + x^{\\top}PBR^{-1}B^{\\top}Px = -x^{\\top}PBR^{-1}B^{\\top}Px.\n$$\n这里我们用到了 $R$ 是对称的，所以 $(R^{-1})^{\\top} = R^{-1}$。HJB 方程变为：\n$$\n2x^{\\top}PAx - x^{\\top}PBR^{-1}B^{\\top}Px + x^{\\top}Qx + \\mathrm{Tr}(D^{\\top}PD) = 0.\n$$\n对对称矩阵 $P$ 使用恒等式 $2x^{\\top}PAx = x^{\\top}(A^{\\top}P + PA)x$：\n$$\nx^{\\top}(A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q)x + \\mathrm{Tr}(D^{\\top}PD) = 0.\n$$\n该方程必须对所有 $x \\in \\mathbb{R}^n$ 成立。这意味着二次部分和常数部分必须分别消失。然而，在长期平均代价的背景下，HJB 方程是 $\\lambda = \\min_u \\{ \\mathcal{L}^u V(x) + l(x,u) \\}$，其中 $\\lambda$ 是最优平均代价。这导致\n$$\nx^{\\top}(A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q)x + \\mathrm{Tr}(D^{\\top}PD) = \\lambda.\n$$\n为了使这对所有 $x$ 都成立，二次型必须为零，从而得到稳态代数 Riccati 方程 (ARE)：\n$$\nA^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q = 0.\n$$\n最优平均代价则为 $\\lambda = \\mathrm{Tr}(D^{\\top}PD)$。\n\n扩散项 $D\\,dW_t$ 通过伊藤微积分项 $\\frac{1}{2} \\mathrm{Tr}(D^{\\top} (\\nabla^2 V) D) = \\mathrm{Tr}(D^{\\top}PD)$ 进入推导过程。因为此项关于状态 $x$ 和控制 $u$ 都是常数，所以它不影响确定最优控制律 $u^*(x)$ 的最小化步骤。因此，通过要求依赖于 $x$ 的项总和为零所导出的关于 $P$ 的矩阵方程，与确定性 ($D=0$) 线性二次调节器问题的 ARE 是相同的。随机项仅影响总代价，给单位时间的最优代价增加了一个常数偏移量 $\\mathrm{Tr}(D^{\\top}PD)$。\n\n第二部分：可镇定性与可检测性的验证\n\n给定 $A = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$，$B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，以及 $Q = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$。$A$ 的特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -1$。\n\n为检查矩阵对 $(A,B)$ 的可镇定性，我们对具有非负实部的特征值 $\\lambda_1 = 1$ 应用 Hautus 测试。如果 $\\mathrm{rank}[\\lambda_1 I - A \\mid B] = n = 2$，则该矩阵对是可镇定的。\n$$\n[\\lambda_1 I - A \\mid B] = \\left[1 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\mid \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\right] = \\left[\\begin{pmatrix} 0  0 \\\\ 0  2 \\end{pmatrix} \\mid \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\right] = \\begin{pmatrix} 0  0  1 \\\\ 0  2  0 \\end{pmatrix}.\n$$\n第二列和第三列是线性无关的，所以这个 $2 \\times 3$ 矩阵的秩是 $2$。由于秩等于 $n$，矩阵对 $(A,B)$ 是可镇定的。\n\n为检查矩阵对 $(Q^{1/2}, A)$ 的可检测性，我们首先计算 $Q^{1/2}$。由于 $Q$ 是对角且半正定的，其主平方根是 $C = Q^{1/2} = \\begin{pmatrix} \\sqrt{0}  0 \\\\ 0  \\sqrt{1} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$。我们对不稳定的特征值 $\\lambda_1=1$ 应用 Hautus 测试于矩阵对 $(C,A)$。如果 $\\mathrm{rank}\\begin{pmatrix} \\lambda_1 I - A \\\\ C \\end{pmatrix} = n = 2$，则该矩阵对是可检测的。\n$$\n\\begin{pmatrix} \\lambda_1 I - A \\\\ C \\end{pmatrix} = \\begin{pmatrix} 1 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\\\ \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  2 \\\\ 0  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n这个 $4 \\times 2$ 矩阵的第一列是零。第二列非零。因此，列秩为 $1$。由于秩 $1  n=2$，与 $\\lambda_1=1$ 相关的不稳定模式通过 $C$ 是不可观测的。因此，矩阵对 $(Q^{1/2}, A)$ 是不可检测的。\n\n第三部分：代数 Riccati 方程的求解\n\nARE 是 $A^{\\top}P + PA - PBR^{-1}B^{\\top}P + Q = 0$。\n使用给定的矩阵，$R=[1]$ 所以 $R^{-1}=[1]$，并且 $BR^{-1}B^{\\top} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} [1] \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。\n设 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$ 是一个对称矩阵。我们计算各项：\n$A^{\\top}P + PA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 2p_{11}  0 \\\\ 0  -2p_{22} \\end{pmatrix}$。\n$PBR^{-1}B^{\\top}P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{11}  0 \\\\ p_{12}  0 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{11}^2  p_{11}p_{12} \\\\ p_{11}p_{12}  p_{12}^2 \\end{pmatrix}$。\nARE 变为：\n$$\n\\begin{pmatrix} 2p_{11}  0 \\\\ 0  -2p_{22} \\end{pmatrix} - \\begin{pmatrix} p_{11}^2  p_{11}p_{12} \\\\ p_{11}p_{12}  p_{12}^2 \\end{pmatrix} + \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n这产生一个标量方程组：\n1. $(1,1)$: $2p_{11} - p_{11}^2 = 0 \\implies p_{11}(2 - p_{11}) = 0$。因此，$p_{11}=0$ 或 $p_{11}=2$。\n2. $(1,2)$: $-p_{11}p_{12} = 0$。\n3. $(2,2)$: $-2p_{22} - p_{12}^2 + 1 = 0$。\n\n情况 1：$p_{11} = 2$。\n由方程 (2)，$-2p_{12} = 0 \\implies p_{12} = 0$。\n由方程 (3)，$-2p_{22} - 0^2 + 1 = 0 \\implies p_{22} = \\frac{1}{2}$。\n这给出了一个解 $P_1 = \\begin{pmatrix} 2  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}$。这个解是正定的，因为它的特征值（$2, 1/2$）都是正的。\n\n情况 2：$p_{11} = 0$。\n由方程 (2)，$-0 \\cdot p_{12} = 0$，此式恒成立。\n由方程 (3)，$-2p_{22} - p_{12}^2 + 1 = 0 \\implies p_{22} = \\frac{1 - p_{12}^2}{2}$。\n这给出一族对称解 $P(p_{12}) = \\begin{pmatrix} 0  p_{12} \\\\ p_{12}  \\frac{1-p_{12}^2}{2} \\end{pmatrix}$。为了使价值函数具有物理意义，$P$ 必须是半正定的。$P(p_{12})$ 的行列式是 $\\det(P) = -p_{12}^2$。为了满足半正定性，我们需要 $\\det(P) \\ge 0$，这意味着 $-p_{12}^2 \\ge 0$，所以 $p_{12}$ 必须是 $0$。\n如果 $p_{12}=0$，那么 $p_{22} = \\frac{1}{2}$。\n这给出了一个解 $P_2 = \\begin{pmatrix} 0  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}$。这个解是半正定的，因为它的特征值（$0, 1/2$）是非负的。\n\nARE 有两个不同的对称半正定解。\n\n第四部分：闭环稳定性分析\n\n闭环动力学矩阵是 $A_{\\text{cl}} = A - BR^{-1}B^{\\top}P$。\n$A_{\\text{cl}} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} - \\begin{pmatrix} p_{11}  p_{12} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1-p_{11}  -p_{12} \\\\ 0  -1 \\end{pmatrix}$。\n这个上三角矩阵的特征值是它的对角线元素：$1-p_{11}$ 和 $-1$。\n\n对于解 $P_1 = \\begin{pmatrix} 2  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}$：\n$p_{11}=2$ 且 $p_{12}=0$。闭环矩阵是 $A_{\\text{cl},1} = \\begin{pmatrix} 1-2  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix}$。\n特征值为 $-1$ 和 $-1$。两者都严格位于左半平面，因此系统是渐近稳定的。这是镇定解。\n\n对于解 $P_2 = \\begin{pmatrix} 0  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}$：\n$p_{11}=0$ 且 $p_{12}=0$。闭环矩阵是 $A_{\\text{cl},2} = \\begin{pmatrix} 1-0  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} = A$。\n特征值为 $1$ 和 $-1$。一个特征值为正，因此系统是不稳定的。\n\n矩阵对 $(Q^{1/2}, A)$ 的可检测性失效是存在非镇定解的原因。$A$ 的不稳定模式（与特征向量 $[1 \\ 0]^{\\top}$ 和特征值 $1$ 相关）没有被代价函数的状态加权部分“看到”，因为 $x^{\\top}Qx = x_2^2$，这与第一个状态分量 $x_1$ 无关。控制 $u$ 只影响 $x_1$ 的动态（$dx_1 = (x_1+u)dt + \\dots$）。因此，优化器可以选择一个忽略不稳定的 $x_1$ 动态的控制律，而不会因其无界增长而产生任何与状态相关的代价。解 $P_2$ 对应于一个反馈增益 $K = R^{-1}B^{\\top}P_2 = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}$，导致零控制 $u=0$。闭环系统就是原来的开环系统，而开环系统是不稳定的。发生这种情况是因为代价泛函没有提供镇定不可观测的不稳定模式的激励。一般而言，当且仅当 $(A,B)$ 是可镇定的且 $(Q^{1/2}, A)$ 是可检测的时，ARE 才有唯一的半正定解，该解能产生一个稳定的闭环系统。由于此处的不可检测性，存在多个半正定解，其中一个不是镇定解。\n\n与非镇定解 $P_2$ 相关的闭环矩阵 $A_{\\text{cl}}$ 的不稳定特征值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3077744"}]}