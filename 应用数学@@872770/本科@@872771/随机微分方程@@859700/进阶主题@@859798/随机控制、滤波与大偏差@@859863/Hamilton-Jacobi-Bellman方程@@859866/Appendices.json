{"hands_on_practices": [{"introduction": "在深入研究最优控制策略之前，我们首先需要扎实掌握随机系统本身的行为。这个练习将带你分析一个基础的线性随机微分方程，通过计算其解的均值和方差，来理解在给定一个简单确定性控制下，系统状态是如何演化的。这为你后续理解更复杂的随机控制问题奠定了数学基础[@problem_id:3080779]。", "problem": "考虑一个受控标量随机微分方程 (SDE)，用于描述在一个满足通常条件的带滤概率空间上，由标准布朗运动 $W_t$ 驱动的状态过程 $X_t$。漂移函数为 $b(t,x,u)=a x + b u$，扩散系数为 $\\sigma(t,x,u)=\\sigma$，其中 $a$、$b$、$\\sigma$、$x_0$ 和 $\\bar{u}$ 是实常数，且满足 $\\sigma \\ge 0$ 和 $a \\ne 0$。在确定性开环控制 $u_t \\equiv \\bar{u}$ 下，状态过程满足\n$$\n\\mathrm{d}X_t = \\left(a X_t + b \\bar{u}\\right)\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t, \\quad X_0 = x_0.\n$$\n在分析用于连续时间随机控制的 Hamilton–Jacobi–Bellman (HJB) 方程时，刻画在给定容许控制下 $X_t$ 的分布是一个基本步骤。从 Itô 积分、Itô 乘积法则和 Itô 等距定理的定义出发，推导对任意 $t \\ge 0$ 的均值 $\\mathbb{E}[X_t]$ 和方差 $\\operatorname{Var}(X_t)$ 的闭式表达式。用 $a$、$b$、$\\sigma$、$x_0$、$\\bar{u}$ 和 $t$ 表示你的最终答案，形式为一个二元行向量 $\\left(\\mathbb{E}[X_t], \\operatorname{Var}(X_t)\\right)$。", "solution": "问题陈述需要经过验证。\n\n### 步骤1：提取已知条件\n- 状态过程 $X_t$ 是一个由随机微分方程 (SDE) 控制的标量过程。\n- 该 SDE 由标准一维布朗运动 $W_t$ 驱动。\n- 漂移函数为 $b(t,x,u) = a x + b u$。\n- 扩散系数为 $\\sigma(t,x,u) = \\sigma$。\n- 常数 $a$、$b$、$\\sigma$、$x_0$ 和 $\\bar{u}$ 均为实数。\n- 对这些常数的约束是 $\\sigma \\ge 0$ 和 $a \\ne 0$。\n- 应用了确定性开环控制 $u_t \\equiv \\bar{u}$。\n- 得到的 SDE 为 $\\mathrm{d}X_t = \\left(a X_t + b \\bar{u}\\right)\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t$。\n- 初始条件为 $X_0 = x_0$。\n- 目标是推导对 $t \\ge 0$ 的均值 $\\mathbb{E}[X_t]$ 和方差 $\\operatorname{Var}(X_t)$ 的闭式表达式。\n- 推导应从 Itô 积分、Itô 乘积法则和 Itô 等距定理的定义出发。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。它提出了一个线性 SDE，一个带有常数强迫项的经典 Ornstein-Uhlenbeck 过程，这是随机微积分中的一个基本模型，在金融、物理和工程领域有广泛应用。所有使用的概念——SDE、布朗运动、Itô 微积分——都是标准且定义明确的。\n\n该问题是适定的。给定的 SDE 是常系数线性的，这保证了强解的存在性和唯一性。提供的信息是完整和充分的，足以确定过程的均值和方差。约束条件 $a \\ne 0$ 和 $\\sigma \\ge 0$ 对于通解形式是恰当且必要的。\n\n该问题是客观的。语言精确且数学化，没有任何模糊性、主观性或非科学性主张。\n\n该问题通过了所有验证标准。这是一个随机微积分中的标准、适定问题。\n\n### 步骤3：结论与行动\n问题有效。现在开始求解过程。\n\n状态过程 $X_t$ 由以下线性 SDE 描述：\n$$\n\\mathrm{d}X_t = (a X_t + b \\bar{u}) \\mathrm{d}t + \\sigma \\mathrm{d}W_t, \\quad X_0 = x_0.\n$$\n这是一个非齐次线性 SDE。为了求解它，我们使用积分因子法，这类似于求解一阶线性常微分方程的方法。我们定义一个辅助过程 $Y_t = \\exp(-at)X_t$。我们希望求出其微分 $\\mathrm{d}Y_t$。对时间的确定性函数 $f(t) = \\exp(-at)$ 和随机过程 $X_t$ 应用 Itô 乘积法则：\n$$\n\\mathrm{d}(f(t)X_t) = \\frac{\\mathrm{d}f(t)}{\\mathrm{d}t} X_t \\mathrm{d}t + f(t) \\mathrm{d}X_t.\n$$\n在我们的例子中，$\\frac{\\mathrm{d}f(t)}{\\mathrm{d}t} = -a \\exp(-at)$。将此式和 $f(t)$ 代入法则中得到：\n$$\n\\mathrm{d}Y_t = \\mathrm{d}(\\exp(-at)X_t) = -a \\exp(-at) X_t \\mathrm{d}t + \\exp(-at) \\mathrm{d}X_t.\n$$\n现在，我们将给定 SDE 中 $\\mathrm{d}X_t$ 的表达式代入：\n$$\n\\mathrm{d}Y_t = -a \\exp(-at) X_t \\mathrm{d}t + \\exp(-at) \\left[ (a X_t + b \\bar{u}) \\mathrm{d}t + \\sigma \\mathrm{d}W_t \\right].\n$$\n分配 $\\exp(-at)$ 项：\n$$\n\\mathrm{d}Y_t = -a \\exp(-at) X_t \\mathrm{d}t + a \\exp(-at) X_t \\mathrm{d}t + b \\bar{u} \\exp(-at) \\mathrm{d}t + \\sigma \\exp(-at) \\mathrm{d}W_t.\n$$\n包含 $X_t \\mathrm{d}t$ 的项相互抵消，从而显著简化了表达式：\n$$\n\\mathrm{d}Y_t = b \\bar{u} \\exp(-as) \\mathrm{d}s + \\sigma \\exp(-as) \\mathrm{d}W_s.\n$$\n为了求得 $Y_t$，我们将此表达式从 $s=0$ 积分到 $s=t$：\n$$\nY_t - Y_0 = \\int_0^t b \\bar{u} \\exp(-as) \\mathrm{d}s + \\int_0^t \\sigma \\exp(-as) \\mathrm{d}W_s.\n$$\n第一个积分是标准的 Riemann 积分，第二个是 Itô 积分。\n初始条件是 $Y_0 = \\exp(-a \\cdot 0) X_0 = x_0$。求解 $Y_t$：\n$$\nY_t = x_0 + b \\bar{u} \\int_0^t \\exp(-as) \\mathrm{d}s + \\sigma \\int_0^t \\exp(-as) \\mathrm{d}W_s.\n$$\n现在，我们求解 $X_t = \\exp(at)Y_t$：\n$$\nX_t = x_0 \\exp(at) + b \\bar{u} \\exp(at) \\int_0^t \\exp(-as) \\mathrm{d}s + \\sigma \\exp(at) \\int_0^t \\exp(-as) \\mathrm{d}W_s.\n$$\n我们来计算 Riemann 积分。由于 $a \\ne 0$：\n$$\n\\int_0^t \\exp(-as) \\mathrm{d}s = \\left[ -\\frac{1}{a} \\exp(-as) \\right]_0^t = -\\frac{1}{a} (\\exp(-at) - \\exp(0)) = \\frac{1}{a}(1 - \\exp(-at)).\n$$\n将此结果代回 $X_t$ 的表达式：\n$$\nX_t = x_0 \\exp(at) + b \\bar{u} \\exp(at) \\frac{1}{a}(1 - \\exp(-at)) + \\sigma \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s.\n$$\n简化确定性部分，得到 $X_t$ 的显式解：\n$$\nX_t = x_0 \\exp(at) + \\frac{b\\bar{u}}{a}(\\exp(at)-1) + \\sigma \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s.\n$$\n有了 $X_t$ 的闭式解，我们就可以计算其均值和方差。\n\n**均值 $\\mathbb{E}[X_t]$**\n我们对 $X_t$ 的表达式求期望。根据期望的线性性质：\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}\\left[ x_0 \\exp(at) + \\frac{b\\bar{u}}{a}(\\exp(at)-1) + \\sigma \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s \\right].\n$$\n前两项是确定性的，所以它们的期望就是它们自身。第三项涉及一个 Itô 积分。Itô 积分的一个基本性质是，对于任何确定性（或更一般地，非预见性）的被积函数 $f(s)$，该积分的期望为零：\n$$\n\\mathbb{E}\\left[ \\int_0^t f(s) \\mathrm{d}W_s \\right] = 0.\n$$\n在我们的例子中，被积函数是 $\\sigma \\exp(a(t-s))$，这是一个关于 $s$ 和 $t$ 的确定性函数。因此：\n$$\n\\mathbb{E}\\left[ \\sigma \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s \\right] = 0.\n$$\n因此，$X_t$ 的均值为：\n$$\n\\mathbb{E}[X_t] = x_0 \\exp(at) + \\frac{b\\bar{u}}{a}(\\exp(at)-1).\n$$\n\n**方差 $\\operatorname{Var}(X_t)$**\n方差定义为 $\\operatorname{Var}(X_t) = \\mathbb{E}\\left[ (X_t - \\mathbb{E}[X_t])^2 \\right]$。\n从 $X_t$ 的解中减去均值：\n$$\nX_t - \\mathbb{E}[X_t] = \\left( x_0 \\exp(at) + \\frac{b\\bar{u}}{a}(\\exp(at)-1) + \\sigma \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s \\right) - \\left( x_0 \\exp(at) + \\frac{b\\bar{u}}{a}(\\exp(at)-1) \\right)\n$$\n$$\nX_t - \\mathbb{E}[X_t] = \\sigma \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s.\n$$\n现在，我们可以计算方差：\n$$\n\\operatorname{Var}(X_t) = \\mathbb{E}\\left[ \\left( \\sigma \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s \\right)^2 \\right] = \\sigma^2 \\mathbb{E}\\left[ \\left( \\int_0^t \\exp(a(t-s)) \\mathrm{d}W_s \\right)^2 \\right].\n$$\n为了计算这个期望，我们使用 Itô 等距定理，该定理指出对于一个确定性的平方可积函数 $f(s)$：\n$$\n\\mathbb{E}\\left[ \\left( \\int_0^t f(s) \\mathrm{d}W_s \\right)^2 \\right] = \\int_0^t f(s)^2 \\mathrm{d}s.\n$$\n这里，我们的函数是 $f(s) = \\exp(a(t-s))$。应用该等距定理：\n$$\n\\operatorname{Var}(X_t) = \\sigma^2 \\int_0^t \\left( \\exp(a(t-s)) \\right)^2 \\mathrm{d}s = \\sigma^2 \\int_0^t \\exp(2a(t-s)) \\mathrm{d}s.\n$$\n我们计算这个定积分，同样利用 $a \\ne 0$ 这一事实：\n$$\n\\int_0^t \\exp(2a(t-s)) \\mathrm{d}s = \\left[ \\frac{\\exp(2a(t-s))}{-2a} \\right]_0^t = -\\frac{1}{2a} \\left( \\exp(2a(t-t)) - \\exp(2a(t-0)) \\right)\n$$\n$$\n= -\\frac{1}{2a} (\\exp(0) - \\exp(2at)) = -\\frac{1}{2a} (1 - \\exp(2at)) = \\frac{\\exp(2at)-1}{2a}.\n$$\n因此，$X_t$ 的方差为：\n$$\n\\operatorname{Var}(X_t) = \\sigma^2 \\frac{\\exp(2at)-1}{2a}.\n$$\n问题要求最终答案以二元行向量 $(\\mathbb{E}[X_t], \\operatorname{Var}(X_t))$ 的形式给出。\n$$\n\\left( x_0 \\exp(at) + \\frac{b\\bar{u}}{a}(\\exp(at) - 1), \\frac{\\sigma^2}{2a}(\\exp(2at) - 1) \\right).\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nx_0 \\exp(at) + \\frac{b\\bar{u}}{a}(\\exp(at) - 1)  \\frac{\\sigma^2}{2a}(\\exp(2at) - 1)\n\\end{pmatrix}\n}\n$$", "id": "3080779"}, {"introduction": "现在，让我们来探索哈密顿-雅可比-贝尔曼（HJB）方程的核心机制。这个练习聚焦于HJB方法中最关键的一步：最小化哈密顿量，它巧妙地结合了系统的动力学、运行成本以及价值函数的信息。通过求解这个最小化问题，你将能推导出最优控制策略的反馈形式，从而深刻理解最优决策是如何依赖于系统状态和价值函数的梯度的[@problem_id:3080765]。", "problem": "考虑一维受控 Itô 随机微分方程\n$$\n\\mathrm{d}X_{t} = b(X_{t},u_{t})\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t},\n$$\n其漂移项为 $b(x,u) = u$，扩散系数为常数 $\\sigma  0$，控制过程 $u_{t}$ 在 $\\mathbb{R}$ 中取值。设运行成本为\n$$\nf(x,u) = \\frac{1}{2} r\\,u^{2} + q\\,x^{2},\n$$\n其中 $r0$ 且 $q0$。对于具有有界连续终端成本 $g(x)$ 的有限时间范围问题，将价值函数 $V(t,x)$ 定义为\n$$\nV(t,x) = \\inf_{u} \\,\\mathbb{E}\\!\\left[ \\int_{t}^{T} f(X_{s},u_{s})\\,\\mathrm{d}s + g(X_{T}) \\,\\middle|\\, X_{t}=x \\right],\n$$\n其中下确界取自所有在 $\\mathbb{R}$ 中取值的循序可测控制。根据动态规划原理以及 Hamilton-Jacobi-Bellman (HJB) 方程中出现的哈密顿量的定义，点 $(x,p,M)$ 处的哈密顿量由受控生成元作用于一个 $C^{2}$ 测试函数与运行成本之和，关于控制 $u \\in \\mathbb{R}$ 的下确界给出。特别地，如果 $p$ 表示一阶空间导数，$M$ 表示二阶空间导数，请计算：\n- 最小化的哈密顿量，作为 $x$、$p$、$M$、$\\sigma$、$r$ 和 $q$ 的显式函数；\n- 相应的最小化状态反馈控制，作为 $p$ 和 $r$ 的显式函数。\n\n请将您的最终答案以一个双元素行矩阵的形式给出，第一个元素是最小化的哈密顿量，第二个元素是最小化反馈控制。不需要数值近似，也不涉及单位。", "solution": "用户要求我解决一个与随机最优控制背景下的 Hamilton-Jacobi-Bellman (HJB) 方程相关的问题。\n\n### 步骤 1：提取已知条件\n- 受控 Itô 随机微分方程 (SDE)：$\\mathrm{d}X_{t} = b(X_{t},u_{t})\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}$。\n- 漂移函数：$b(x,u) = u$。\n- 扩散系数：$\\sigma  0$ 是一个常数。\n- 控制过程 $u_{t}$ 在 $\\mathbb{R}$ 中取值。\n- 运行成本函数：$f(x,u) = \\frac{1}{2} r\\,u^{2} + q\\,x^{2}$。\n- 成本函数中的常数满足：$r0$ 和 $q0$。\n- 价值函数针对有限时间范围 $[t, T]$ 定义为：$V(t,x) = \\inf_{u} \\,\\mathbb{E}\\!\\left[ \\int_{t}^{T} f(X_{s},u_{s})\\,\\mathrm{d}s + g(X_{T}) \\,\\middle|\\, X_{t}=x \\right]$。\n- 终端成本 $g(x)$ 是一个有界连续函数。\n- 点 $(x,p,M)$ 处的哈密顿量定义为受控生成元作用于一个 $C^{2}$ 测试函数与运行成本之和，关于控制 $u \\in \\mathbb{R}$ 的下确界。\n- 变量 $p$ 表示测试函数的一阶空间导数。\n- 变量 $M$ 表示测试函数的二阶空间导数。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行验证。\n\n- **科学依据**：该问题是随机线性二次调节器 (LQR) 问题的标准形式，这是最优控制理论的基石。Hamilton-Jacobi-Bellman (HJB) 方程是通过动态规划解决此类问题的核心工具。所有概念都是随机微分方程和控制理论领域中的标准和成熟概念。\n- **适定性**：该问题是适定的。它要求计算两个具体且定义明确的量：最小化的哈密顿量和最优反馈控制。条件 $r0$ 确保成本函数在控制变量 $u$ 上是严格凸的，这保证了最小值的存在性和唯一性。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有任何主观性或歧义。\n\n该问题没有说明中列出的任何缺陷。它是科学合理的、适定的、客观的、完整的且可形式化的。\n\n### 步骤 3：结论和行动\n问题有效。将提供完整解答。\n\n### 解答\n该问题要求计算给定随机控制问题的最小化哈密顿量和相应的最优控制。在 Hamilton-Jacobi-Bellman (HJB) 方程的背景下，哈密顿量定义为：\n$$\nH(x,p,M) = \\inf_{u \\in \\mathbb{R}} \\left\\{ \\mathcal{L}^{u} + f(x,u) \\right\\}\n$$\n其中 $\\mathcal{L}^{u}$ 是受控随机过程的生成元，作用于一个测试函数（其一阶和二阶空间导数分别用 $p$ 和 $M$ 表示），$f(x,u)$ 是运行成本。\n\n首先，我们确定生成元 $\\mathcal{L}^{u}$。对于由 $\\mathrm{d}X_{t} = \\mu(t, X_{t})\\,\\mathrm{d}t + \\Sigma(t, X_{t})\\,\\mathrm{d}W_{t}$ 给出的一般一维 Itô 过程，作用于 $C^{2}$ 函数 $\\phi(x)$ 的生成元为：\n$$\n\\mathcal{L}\\phi(x) = \\mu(t,x) \\frac{\\partial \\phi}{\\partial x} + \\frac{1}{2} \\Sigma(t,x)^{2} \\frac{\\partial^{2} \\phi}{\\partial x^{2}}\n$$\n在我们的具体问题中，SDE 是 $\\mathrm{d}X_{t} = u_{t}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}$。漂移项是 $\\mu(t,x,u) = u$，扩散项是 $\\Sigma(t,x,u) = \\sigma$。设 $\\phi(x)$ 是一个通用的 $C^2$ 测试函数。根据问题陈述，我们将其导数表示为 $ p = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$ 和 $M = \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2}$。\n因此，受控过程的生成元 $\\mathcal{L}^{u}$ 为：\n$$\n\\mathcal{L}^{u} = u \\cdot p + \\frac{1}{2}\\sigma^{2} \\cdot M\n$$\n接下来，我们加上运行成本 $f(x,u) = \\frac{1}{2} r\\,u^{2} + q\\,x^{2}$。需要关于控制 $u \\in \\mathbb{R}$ 最小化的表达式是：\n$$\nJ(u) = \\mathcal{L}^{u} + f(x,u) = \\left( u p + \\frac{1}{2}\\sigma^{2}M \\right) + \\left( \\frac{1}{2} r\\,u^{2} + q\\,x^{2} \\right)\n$$\n我们可以将此表达式重新整理为 $u$ 的函数：\n$$\nJ(u) = \\frac{1}{2} r\\,u^{2} + p\\,u + \\left( q\\,x^{2} + \\frac{1}{2}\\sigma^{2}M \\right)\n$$\n这是一个关于 $u$ 的二次函数。由于问题陈述 $r0$，该抛物线开口向上，函数有唯一的全局最小值。为了找到使 $J(u)$ 最小化的 $u$ 值，我们计算关于 $u$ 的一阶导数并令其为零。\n$$\n\\frac{\\mathrm{d}J}{\\mathrm{d}u} = \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left( \\frac{1}{2} r\\,u^{2} + p\\,u + q\\,x^{2} + \\frac{1}{2}\\sigma^{2}M \\right) = r\\,u + p\n$$\n将导数设为零，得到最优控制，我们记为 $u^{\\star}$：\n$$\nr\\,u^{\\star} + p = 0 \\implies u^{\\star} = -\\frac{p}{r}\n$$\n这是作为 $p$ 和 $r$ 函数的最小化状态反馈控制。这是所需答案的第二部分。\n\n为了找到最小化的哈密顿量 $H(x,p,M)$，我们将 $u^{\\star}$ 代回 $J(u)$ 的表达式中：\n$$\nH(x,p,M) = J(u^{\\star}) = \\frac{1}{2} r\\left(-\\frac{p}{r}\\right)^{2} + p\\left(-\\frac{p}{r}\\right) + q\\,x^{2} + \\frac{1}{2}\\sigma^{2}M\n$$\n$$\nH(x,p,M) = \\frac{1}{2} r\\left(\\frac{p^{2}}{r^{2}}\\right) - \\frac{p^{2}}{r} + q\\,x^{2} + \\frac{1}{2}\\sigma^{2}M\n$$\n$$\nH(x,p,M) = \\frac{p^{2}}{2r} - \\frac{p^{2}}{r} + q\\,x^{2} + \\frac{1}{2}\\sigma^{2}M\n$$\n合并包含 $p^{2}$ 的项：\n$$\nH(x,p,M) = -\\frac{p^{2}}{2r} + q\\,x^{2} + \\frac{1}{2}\\sigma^{2}M\n$$\n这是作为 $x$、$p$、$M$、$\\sigma$、$r$ 和 $q$ 的显式函数的最小化哈密顿量。这是所需答案的第一部分。\n\n最终答案以一个双元素行矩阵的形式呈现。\n第一个元素：最小化的哈密顿量 $H(x,p,M) = q\\,x^{2} - \\frac{p^{2}}{2r} + \\frac{1}{2}\\sigma^{2}M$。\n第二个元素：最小化控制 $u^{\\star} = -\\frac{p}{r}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} q\\,x^{2} - \\frac{p^{2}}{2r} + \\frac{1}{2}\\sigma^{2}M  -\\frac{p}{r} \\end{pmatrix}}\n$$", "id": "3080765"}, {"introduction": "掌握了核心部件之后，是时候将所有知识融会贯通，解决一个完整的随机最优控制问题了。这个综合性练习将指导你为一个经典的线性二次（LQ）问题建立并求解HJB方程，从推导方程、猜测解的形式，到最终获得一个明确的、可执行的反馈控制律。这个过程完整地展示了HJB框架如何从抽象理论走向具体应用，为你提供了解决实际控制问题的蓝图[@problem_id:3080756]。", "problem": "考虑标量受控随机微分方程（SDE）\n$$\n\\mathrm{d}X_t = \\big(a X_t + b\\,u_t\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t,\\quad X_0 = x,\n$$\n其中 $W_t$ 是标准布朗运动，$u_t$ 是取值于 $\\mathbb{R}$ 的循序可测控制。对于一个固定的有限时域 $T0$，性能准则为\n$$\nJ^{u}(t,x) = \\mathbb{E}\\Bigg[\\int_{t}^{T} \\big(q\\,X_s^2 + r\\,u_s^2\\big)\\,\\mathrm{d}s + s_f\\,X_T^2\\ \\Big|\\ X_t = x\\Bigg].\n$$\n以动态规划原理（DPP）和 Itô 公式为基础出发点，推导值函数 $V(t,x) = \\inf_{u} J^{u}(t,x)$ 的 Hamilton-Jacobi-Bellman (HJB) 方程，陈述在此设定下的验证定理，并由此推导出最优反馈律 $u^{*}(t,x)$。\n\n然后，在时间区间 $[0,T]$（其中 $T0$）上，将参数具体化为 $a=0$, $b=1$, $\\sigma0$（任意），$q=1$, $r=1$, 以及终端权重 $s_f=1$。显式计算最优反馈控制 $u^{*}(t,x)$ 以及在 $u^{*}$下状态SDE的闭环漂移项 $\\mu_{\\mathrm{cl}}(t,x)$。\n\n你的最终答案必须是由 $\\big(u^{*}(t,x),\\,\\mu_{\\mathrm{cl}}(t,x)\\big)$ 对组成的单个闭式解析表达式。无需数值四舍五入。不涉及物理单位。", "solution": "在尝试求解之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n-   状态动态由标量受控随机微分方程（SDE）决定：\n    $$\n    \\mathrm{d}X_t = \\big(a X_t + b\\,u_t\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t,\\quad X_0 = x\n    $$\n-   $W_t$ 是标准布朗运动。\n-   $u_t$ 是取值于 $\\mathbb{R}$ 的循序可测控制。\n-   时间域是一个固定的有限值 $T0$。\n-   待最小化的性能准则为：\n    $$\n    J^{u}(t,x) = \\mathbb{E}\\Bigg[\\int_{t}^{T} \\big(q\\,X_s^2 + r\\,u_s^2\\big)\\,\\mathrm{d}s + s_f\\,X_T^2\\ \\Big|\\ X_t = x\\Bigg]\n    $$\n-   值函数定义为 $V(t,x) = \\inf_{u} J^{u}(t,x)$。\n-   对于问题的第二部分，参数具体化为：在时间区间 $[0,T]$ 上，$a=0$, $b=1$, $\\sigma0$（任意），$q=1$, $r=1$, 以及终端权重 $s_f=1$。\n-   要求的输出是最优反馈控制 $u^{*}(t,x)$ 与由此产生的闭环漂移项 $\\mu_{\\mathrm{cl}}(t,x)$ 组成的对。\n\n### 步骤 2：使用提取的已知条件进行验证\n所给问题是随机最优控制中的一个标准练习，具体来说，是一个随机系统的线性二次（LQ）控制问题。\n\n-   **科学依据**：该问题基于随机微分方程、Itô 微积分和动态规划（特别是 Hamilton-Jacobi-Bellman 框架）等成熟的数学理论。所有组成部分在高等控制理论和金融数学中都是标准的。\n-   **适定性**：该问题是适定的。二次代价函数，其系数 $q \\ge 0$, $r0$ 和 $s_f \\ge 0$（在此具体为 $q=1$, $r=1$, $s_f=1$），确保了最小化问题是凸的，并且通常有唯一解。问题提供了推导解所需的所有必要信息。\n-   **客观性**：问题以精确、客观的数学语言陈述，没有任何歧义或主观因素。\n\n### 步骤 3：结论与行动\n该问题是**有效的**，因为它具有科学依据、是适定的且客观。我们可以继续求解。\n\n### Hamilton-Jacobi-Bellman 方程的推导\n\n推导始于动态规划原理（DPP）。对于任意小的时间增量 $\\delta t  0$，值函数 $V(t,x)$ 满足：\n$$\nV(t,x) = \\inf_{u \\in \\mathcal{U}[t,T]} \\mathbb{E}\\left[ \\int_{t}^{t+\\delta t} (qX_s^2 + r u_s^2)\\,\\mathrm{d}s + V(t+\\delta t, X_{t+\\delta t}) \\mid X_t=x \\right]\n$$\n其中 $\\mathcal{U}[t,T]$ 是在区间 $[t,T]$ 上的容许控制集合。对于一个无穷小区间 $[t, t+\\delta t]$，我们可以近似该积分并假设控制 $u_s=u_t=u$ 是常数。\n$$\nV(t,x) \\approx \\inf_{u} \\mathbb{E}\\left[ (q x^2 + r u^2)\\delta t + V(t+\\delta t, X_{t+\\delta t}) \\mid X_t=x \\right]\n$$\n让我们对过程 $V(t,X_t)$ 应用 Itô 公式。假设 $V \\in C^{1,2}([0,T) \\times \\mathbb{R})$，其微分为：\n$$\n\\mathrm{d}V(t,X_t) = \\left( \\frac{\\partial V}{\\partial t} + (a X_t + b u_t)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right)\\mathrm{d}t + \\sigma \\frac{\\partial V}{\\partial x} \\mathrm{d}W_t\n$$\n从 $t$ 到 $t+\\delta t$ 积分并取条件期望，随机积分项消失，因为 $\\mathbb{E}[\\int_{t}^{t+\\delta t} (\\dots) \\mathrm{d}W_s \\mid \\mathcal{F}_t] = 0$。\n$$\n\\mathbb{E}[V(t+\\delta t, X_{t+\\delta t}) \\mid X_t=x] - V(t,x) = \\mathbb{E}\\left[ \\int_{t}^{t+\\delta t} \\left( \\frac{\\partial V}{\\partial s} + (a X_s + b u_s)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right)\\mathrm{d}s \\mid X_t=x \\right]\n$$\n对于小的 $\\delta t$，这变为：\n$$\n\\mathbb{E}[V(t+\\delta t, X_{t+\\delta t}) \\mid X_t=x] \\approx V(t,x) + \\left( \\frac{\\partial V}{\\partial t} + (a x + b u)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right)\\delta t\n$$\n将此代入 DPP 表达式：\n$$\nV(t,x) \\approx \\inf_{u} \\left\\{ (q x^2 + r u^2)\\delta t + V(t,x) + \\left( \\frac{\\partial V}{\\partial t} + (a x + b u)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right)\\delta t \\right\\}\n$$\n两边减去 $V(t,x)$，除以 $\\delta t$，并取极限 $\\delta t \\to 0$，我们得到 Hamilton-Jacobi-Bellman (HJB) 方程：\n$$\n0 = \\inf_{u} \\left\\{ \\frac{\\partial V}{\\partial t} + (a x + b u)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} + q x^2 + r u^2 \\right\\}\n$$\n这等价于：\n$$\n-\\frac{\\partial V}{\\partial t} = \\inf_{u} \\left\\{ (a x + b u)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} + q x^2 + r u^2 \\right\\}\n$$\n待最小化的项，我们称之为哈密顿量 $\\mathcal{H}(t,x,u,V_x)$，是 $u$ 的二次函数。通过将其关于 $u$ 的导数设为零来找到最小值：\n$$\n\\frac{\\partial \\mathcal{H}}{\\partial u} = b \\frac{\\partial V}{\\partial x} + 2ru = 0\n$$\n由于对于一个有意义的问题必须有 $r0$（在本特例中 $r=1$），我们可以解出最优反馈控制 $u^{*}(t,x)$：\n$$\nu^{*}(t,x) = -\\frac{b}{2r} \\frac{\\partial V}{\\partial x}\n$$\n将此代回 HJB 方程，得到值函数 $V(t,x)$ 的偏微分方程（PDE）：\n$$\n\\frac{\\partial V}{\\partial t} + (a x)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} + q x^2 + b\\left(-\\frac{b}{2r}\\frac{\\partial V}{\\partial x}\\right)\\frac{\\partial V}{\\partial x} + r\\left(-\\frac{b}{2r}\\frac{\\partial V}{\\partial x}\\right)^2 = 0\n$$\n$$\n\\frac{\\partial V}{\\partial t} + (a x)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} + q x^2 - \\frac{b^2}{2r}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 + \\frac{rb^2}{4r^2}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 = 0\n$$\n这简化为 HJB 偏微分方程的最终形式：\n$$\n\\frac{\\partial V}{\\partial t} + (a x)\\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} + q x^2 - \\frac{b^2}{4r}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 = 0\n$$\n这个偏微分方程必须从终端条件 $V(T,x) = s_f x^2$ 开始，在时间上向后求解。\n\n### 验证定理\n验证定理将 HJB 方程的解与值函数正式联系起来。在此背景下，它可以陈述为：\n\n设 $W(t,x) \\in C^{1,2}([0,T] \\times \\mathbb{R})$ 是一个满足 HJB 偏微分方程的函数：\n$$\n\\frac{\\partial W}{\\partial t} + (a x)\\frac{\\partial W}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 W}{\\partial x^2} + q x^2 - \\frac{b^2}{4r}\\left(\\frac{\\partial W}{\\partial x}\\right)^2 = 0\n$$\n其终端条件为 $W(T,x) = s_f x^2$。设 $u^*(t,x) = -\\frac{b}{2r} \\frac{\\partial W}{\\partial x}(t,x)$。如果在此控制下，状态 $X_t^*$ 的随机微分方程对于任何初始条件 $(t,x)$ 都有唯一的强解，并且如果成本满足某些可积性条件，那么 $W(t,x)$ 就是真正的值函数，即 $W(t,x) = V(t,x)$，并且 $u^*$ 是最优控制。\n\n### 具体化与求解\n我们现在将参数具体化为 $a=0$, $b=1$, $\\sigma0$, $q=1$, $r=1$ 和 $s_f=1$。HJB 方程变为：\n$$\n\\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} + x^2 - \\frac{1}{4}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 = 0\n$$\n终端条件为 $V(T,x) = x^2$。考虑到二次代价和线性动态特性，我们假设一个二次形式的解：\n$$\nV(t,x) = P(t)x^2 + S(t)\n$$\n偏导数为：\n$\\frac{\\partial V}{\\partial t} = \\dot{P}(t)x^2 + \\dot{S}(t)$, $\\frac{\\partial V}{\\partial x} = 2P(t)x$, $\\frac{\\partial^2 V}{\\partial x^2} = 2P(t)$。\n将这些代入 HJB 方程：\n$$\n(\\dot{P}(t)x^2 + \\dot{S}(t)) + \\frac{1}{2}\\sigma^2(2P(t)) + x^2 - \\frac{1}{4}(2P(t)x)^2 = 0\n$$\n$$\n\\dot{P}(t)x^2 + \\dot{S}(t) + \\sigma^2 P(t) + x^2 - P(t)^2 x^2 = 0\n$$\n按 $x^2$ 的幂次分组各项：\n$$\n(\\dot{P}(t) - P(t)^2 + 1)x^2 + (\\dot{S}(t) + \\sigma^2 P(t)) = 0\n$$\n为使此式对所有 $x \\in \\mathbb{R}$ 成立，$x$ 的各次幂的系数必须为零。这产生了一个由两个常微分方程（ODE）组成的系统：\n1.  $\\dot{P}(t) = P(t)^2 - 1$ (Riccati 方程)\n2.  $\\dot{S}(t) = -\\sigma^2 P(t)$\n\n终端条件 $V(T,x) = 1 \\cdot x^2$ 意味着 $P(T)x^2 + S(T) = x^2$，这给出了常微分方程的终端条件：$P(T)=1$ 和 $S(T)=0$。\n\n让我们求解 $P(t)$。常微分方程为 $\\frac{\\mathrm{d}P}{\\mathrm{d}t} = P^2-1$。我们观察到 $P_c=1$ 是一个常数（平衡）解，因为 $1^2-1=0$。由于终端条件是 $P(T)=1$，根据常微分方程解的唯一性，解必须是常数函数 $P(t) = 1$ 对所有 $t \\in [0,T]$ 成立。\n\n现在，我们求解 $S(t)$。常微分方程为 $\\dot{S}(t) = -\\sigma^2 P(t)$。代入 $P(t)=1$：\n$$\n\\dot{S}(t) = -\\sigma^2\n$$\n对 $t$ 积分：\n$$\nS(t) = \\int -\\sigma^2 \\mathrm{d}t = -\\sigma^2 t + C\n$$\n使用终端条件 $S(T)=0$：\n$$\nS(T) = -\\sigma^2 T + C = 0 \\implies C = \\sigma^2 T\n$$\n因此，$S(t)$ 的解是 $S(t) = \\sigma^2 T - \\sigma^2 t = \\sigma^2 (T-t)$。\n\n值函数为 $V(t,x) = x^2 + \\sigma^2(T-t)$。\n\n### 最优控制与闭环漂移\n最优反馈控制由我们推导的通用公式给出：\n$$\nu^{*}(t,x) = -\\frac{b}{2r} \\frac{\\partial V}{\\partial x}\n$$\n当 $b=1$, $r=1$ 且 $\\frac{\\partial V}{\\partial x} = 2P(t)x = 2(1)x = 2x$ 时，我们得到：\n$$\nu^{*}(t,x) = -\\frac{1}{2(1)} (2x) = -x\n$$\n闭环漂移项 $\\mu_{\\mathrm{cl}}(t,x)$ 是通过将 $u^*(t,x)$ 代入原始 SDE 的漂移项 $a x_t + b u_t$ 得到的。当 $a=0$ 且 $b=1$ 时：\n$$\n\\mu_{\\mathrm{cl}}(t,x) = a x + b u^{*}(t,x) = (0)x + (1)(-x) = -x\n$$\n得到的最优控制和闭环漂移项均为 $-x$。它们都与时间 $t$ 无关。", "answer": "$$\n\\boxed{\\begin{pmatrix} -x  -x \\end{pmatrix}}\n$$", "id": "3080756"}]}