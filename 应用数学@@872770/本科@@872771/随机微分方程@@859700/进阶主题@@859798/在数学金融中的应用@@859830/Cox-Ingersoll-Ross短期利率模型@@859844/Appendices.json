{"hands_on_practices": [{"introduction": "CIR模型的一个核心特性是均值回归，即利率会趋向一个长期平均水平。通过求解瞬时利率的期望值，本练习将让你亲手推导出该过程的数学表达，从而具体理解利率是如何从初始值$r_0$向长期均值$\\theta$回归的。[@problem_id:3080150] 这是分析任何随机微分方程基本动态的基础技能。", "problem": "考虑 Cox–Ingersoll–Ross 短期利率模型，在该模型中，短期利率过程 $\\{r_t\\}_{t \\geq 0}$ 满足随机微分方程 (SDE; stochastic differential equation)\n$$\ndr_t \\;=\\; \\kappa\\big(\\theta - r_t\\big)\\,dt \\;+\\; \\sigma \\sqrt{r_t}\\,dW_t,\n$$\n其中 $\\kappa>0$、$\\theta>0$ 和 $\\sigma>0$ 为常数，$r_0 \\ge 0$ 是给定的初始短期利率，而 $\\{W_t\\}_{t \\ge 0}$ 是一个标准布朗运动。假设解 $\\{r_t\\}_{t \\ge 0}$ 对每个 $t0$ 都是严格非负的，且具有有限的一阶矩。仅使用伊藤积分的基本性质（特别是在适当的可积性条件下，伊藤积分的期望为零）和期望的线性性，推导一阶矩 $m_1(t)=\\mathbb{E}[r_t \\mid r_0]$ 所满足的常微分方程，并在初始条件 $m_1(0)=r_0$ 下求解该方程。以 $t$、$\\kappa$、$\\theta$ 和 $r_0$ 的单一闭式解析表达式形式给出 $m_1(t)$ 的最终答案。无需数值近似。", "solution": "所述问题构成了随机微分方程领域中一个有效且适定的数学练习。所有参数都已明确定义，目标明确，且框架依赖于 Cox-Ingersoll–Ross 模型的既定科学原理。我们将开始推导。\n\n短期利率 $\\{r_t\\}_{t \\geq 0}$ 的 Cox-Ingersoll–Ross 过程由以下随机微分方程 (SDE) 描述：\n$$\ndr_t = \\kappa(\\theta - r_t)dt + \\sigma \\sqrt{r_t}dW_t\n$$\n其中 $\\kappa$、$\\theta$ 和 $\\sigma$ 为正常数，$r_0 \\ge 0$ 是初始利率，$\\{W_t\\}_{t \\ge 0}$ 是一个标准布朗运动。我们的任务是求一阶矩 $m_1(t) = \\mathbb{E}[r_t \\mid r_0]$。\n\n首先，我们将 SDE 从时间 $s=0$ 积分到 $s=t$，以积分形式表示：\n$$\n\\int_{0}^{t} dr_s = \\int_{0}^{t} \\kappa(\\theta - r_s)ds + \\int_{0}^{t} \\sigma \\sqrt{r_s}dW_s\n$$\n这得到：\n$$\nr_t - r_0 = \\int_{0}^{t} \\kappa(\\theta - r_s)ds + \\int_{0}^{t} \\sigma \\sqrt{r_s}dW_s\n$$\n对 $r_t$ 进行整理，我们得到：\n$$\nr_t = r_0 + \\int_{0}^{t} \\kappa(\\theta - r_s)ds + \\int_{0}^{t} \\sigma \\sqrt{r_s}dW_s\n$$\n现在，我们对等式两边取关于时间 $t=0$ 信息的条件期望，这等价于以给定的 $r_0$ 值为条件。\n$$\n\\mathbb{E}[r_t \\mid r_0] = \\mathbb{E}\\left[r_0 + \\int_{0}^{t} \\kappa(\\theta - r_s)ds + \\int_{0}^{t} \\sigma \\sqrt{r_s}dW_s \\mid r_0\\right]\n$$\n利用期望算子的线性性，我们可以将各项分开：\n$$\n\\mathbb{E}[r_t \\mid r_0] = \\mathbb{E}[r_0 \\mid r_0] + \\mathbb{E}\\left[\\int_{0}^{t} \\kappa(\\theta - r_s)ds \\mid r_0\\right] + \\mathbb{E}\\left[\\int_{0}^{t} \\sigma \\sqrt{r_s}dW_s \\mid r_0\\right]\n$$\n让我们分析右侧的每一项。\n根据定义，$m_1(t) = \\mathbb{E}[r_t \\mid r_0]$。由于 $r_0$ 在时间 $t=0$ 是一个已知常数，其期望就是其自身：$\\mathbb{E}[r_0 \\mid r_0] = r_0$。\n\n对于第二项，它涉及一个标准的黎曼积分，我们可以交换期望和积分算子（根据此处适用的富比尼定理）。\n$$\n\\mathbb{E}\\left[\\int_{0}^{t} \\kappa(\\theta - r_s)ds \\mid r_0\\right] = \\int_{0}^{t} \\mathbb{E}[\\kappa(\\theta - r_s) \\mid r_0]ds\n$$\n在积分内部再次使用期望的线性性：\n$$\n\\int_{0}^{t} (\\mathbb{E}[\\kappa\\theta \\mid r_0] - \\mathbb{E}[\\kappa r_s \\mid r_0])ds = \\int_{0}^{t} (\\kappa\\theta - \\kappa\\mathbb{E}[r_s \\mid r_0])ds = \\int_{0}^{t} (\\kappa\\theta - \\kappa m_1(s))ds\n$$\n第三项是伊藤随机积分的期望。伊藤积分的一个基本性质是，对于任何合适的适应过程 $X_s$，其关于布朗运动的积分的期望为零：$\\mathbb{E}\\left[\\int_{0}^{t} X_s dW_s\\right] = 0$。其必要条件是积分被积函数满足 $\\mathbb{E}\\left[\\int_{0}^{t} X_s^2 ds\\right]  \\infty$。在我们的例子中，被积函数是 $X_s = \\sigma\\sqrt{r_s}$。条件变为 $\\mathbb{E}\\left[\\int_{0}^{t} (\\sigma\\sqrt{r_s})^2 ds\\right] = \\sigma^2 \\int_{0}^{t} \\mathbb{E}[r_s]ds  \\infty$。由于问题陈述假设一阶矩 $m_1(s) = \\mathbb{E}[r_s]$ 对每个 $s>0$ 都是有限的，并且是时间的连续函数（我们将证实这一点），因此该积分对于任何有限的 $t$ 都是有限的。因此，该性质适用：\n$$\n\\mathbb{E}\\left[\\int_{0}^{t} \\sigma \\sqrt{r_s}dW_s \\mid r_0\\right] = 0\n$$\n将这些结果代回期望方程，我们得到关于 $m_1(t)$ 的一个积分方程：\n$$\nm_1(t) = r_0 + \\int_{0}^{t} (\\kappa\\theta - \\kappa m_1(s))ds\n$$\n为了将这个积分方程转换为常微分方程 (ODE)，我们对等式两边关于 $t$ 求导。对积分项应用微积分基本定理：\n$$\n\\frac{d}{dt}m_1(t) = \\frac{d}{dt}r_0 + \\frac{d}{dt}\\left(\\int_{0}^{t} (\\kappa\\theta - \\kappa m_1(s))ds\\right)\n$$\n由于 $r_0$ 是一个常数，其导数为零。这得到：\n$$\n\\frac{dm_1(t)}{dt} = \\kappa\\theta - \\kappa m_1(t)\n$$\n这是一个一阶线性非齐次常微分方程，可以整理成标准形式：\n$$\n\\frac{dm_1(t)}{dt} + \\kappa m_1(t) = \\kappa\\theta\n$$\n初始条件是 $m_1(0) = \\mathbb{E}[r_0 \\mid r_0] = r_0$。\n我们使用积分因子 $I(t)$ 来求解这个常微分方程，其定义为：\n$$\nI(t) = \\exp\\left(\\int \\kappa dt\\right) = \\exp(\\kappa t)\n$$\n将整个常微分方程乘以 $I(t)$：\n$$\n\\exp(\\kappa t)\\frac{dm_1(t)}{dt} + \\kappa\\exp(\\kappa t) m_1(t) = \\kappa\\theta\\exp(\\kappa t)\n$$\n左边是乘积法则对 $\\exp(\\kappa t)m_1(t)$ 求导的结果：\n$$\n\\frac{d}{dt}\\left[\\exp(\\kappa t) m_1(t)\\right] = \\kappa\\theta\\exp(\\kappa t)\n$$\n现在，我们对等式两边从 $s=0$ 积分到 $s=t$：\n$$\n\\int_{0}^{t} \\frac{d}{ds}\\left[\\exp(\\kappa s) m_1(s)\\right]ds = \\int_{0}^{t} \\kappa\\theta\\exp(\\kappa s)ds\n$$\n$$\n\\left[\\exp(\\kappa s) m_1(s)\\right]_{0}^{t} = \\kappa\\theta \\left[\\frac{1}{\\kappa}\\exp(\\kappa s)\\right]_{0}^{t}\n$$\n$$\n\\exp(\\kappa t) m_1(t) - \\exp(0) m_1(0) = \\theta \\left[\\exp(\\kappa t) - \\exp(0)\\right]\n$$\n代入初始条件 $m_1(0) = r_0$ 并注意到 $\\exp(0)=1$：\n$$\n\\exp(\\kappa t) m_1(t) - r_0 = \\theta(\\exp(\\kappa t) - 1)\n$$\n求解 $\\exp(\\kappa t) m_1(t)$：\n$$\n\\exp(\\kappa t) m_1(t) = r_0 - \\theta + \\theta\\exp(\\kappa t)\n$$\n最后，我们通过除以 $\\exp(\\kappa t)$（或乘以 $\\exp(-\\kappa t)$）来分离出 $m_1(t)$：\n$$\nm_1(t) = (r_0 - \\theta)\\exp(-\\kappa t) + \\theta\n$$\n这就是 CIR 过程一阶矩的闭式解析表达式。它表明，期望短期利率 $\\mathbb{E}[r_t]$ 从其初始值 $r_0$ 以由 $\\kappa$ 决定的速率，指数地均值回归到长期均值 $\\theta$。", "answer": "$$\n\\boxed{\\theta + (r_0 - \\theta)\\exp(-\\kappa t)}\n$$", "id": "3080150"}, {"introduction": "在理解了利率的平均路径后，下一步是量化其围绕该路径的波动，即不确定性。本练习将引导你使用随机微积分中的核心工具——伊藤引理（Itô's lemma），来推导CIR模型中利率的方差。[@problem_id:3080159] 这不仅能加深你对模型随机性的理解，也是风险管理和衍生品定价中的关键一步。", "problem": "考虑 Cox–Ingersoll–Ross 短期利率模型，其中短期利率 $r_t$ 的演化遵循随机微分方程 (SDE)\n$$\ndr_t \\;=\\; \\kappa\\left(\\theta - r_t\\right) \\, dt \\;+\\; \\sigma \\sqrt{r_t}\\, dW_t,\n$$\n其中 $\\kappa0$、$\\theta0$、$\\sigma0$，初始条件为 $r_0 \\ge 0$，且 $W_t$ 是一个标准维纳过程。令 $m_1(t) = \\mathbb{E}[\\,r_t \\mid r_0\\,]$ 和 $m_2(t) = \\mathbb{E}[\\,r_t^2 \\mid r_0\\,]$ 分别表示一阶和二阶条件矩。\n\n从条件期望的基本定义、应用于函数 $f(r) = r^2$ 的伊藤引理（Itô’s lemma）以及伊藤积分的性质出发，推导 $m_2(t)$ 所满足的线性常微分方程 (ODE) 及其初始条件。然后，结合由给定 SDE 所蕴含的 $m_1(t)$ 的动态，求解此 ODE，以获得条件方差\n$$\n\\operatorname{Var}\\!\\left(r_t \\mid r_0\\right) \\;=\\; m_2(t) - \\big(m_1(t)\\big)^2\n$$\n关于 $\\kappa$、$\\theta$、$\\sigma$、$t$ 和 $r_0$ 的显式闭式表达式。请将您的最终答案表示为单一的解析表达式。无需四舍五入。", "solution": "该问题要求推导 Cox-Ingersoll-Ross (CIR) 过程的条件方差。短期利率 $r_t$ 由以下随机微分方程 (SDE) 控制：\n$$\ndr_t = \\kappa(\\theta - r_t) \\, dt + \\sigma \\sqrt{r_t}\\, dW_t\n$$\n其中 $\\kappa  0$、$\\theta  0$、$\\sigma  0$、$r_0 \\ge 0$，且 $W_t$ 是一个标准维纳过程。我们需要求解 $\\operatorname{Var}(r_t \\mid r_0) = m_2(t) - (m_1(t))^2$，其中 $m_1(t) = \\mathbb{E}[r_t \\mid r_0]$ 且 $m_2(t) = \\mathbb{E}[r_t^2 \\mid r_0]$。\n\n首先，按照指示，我们推导二阶矩 $m_2(t)$ 的常微分方程 (ODE)。我们将伊藤引理（Itô's lemma）应用于函数 $f(r_t) = r_t^2$。其偏导数为 $f_r = 2r_t$ 和 $f_{rr} = 2$。\n对于一个伊藤过程 $dx_t = a(t, x_t)dt + b(t, x_t)dW_t$，应用于函数 $f(t, x_t)$ 的伊藤引理的一般形式为\n$$\ndf = \\left( \\frac{\\partial f}{\\partial t} + a \\frac{\\partial f}{\\partial x} + \\frac{1}{2} b^2 \\frac{\\partial^2 f}{\\partial x^2} \\right) dt + b \\frac{\\partial f}{\\partial x} dW_t.\n$$\n在我们的情况中，$f$ 不显式依赖于 $t$，该过程为 $r_t$，其漂移项为 $a(r_t) = \\kappa(\\theta - r_t)$，扩散项为 $b(r_t) = \\sigma \\sqrt{r_t}$。\n因此，$r_t^2$ 的 SDE 为：\n$$\nd(r_t^2) = \\left( (2r_t) \\cdot \\kappa(\\theta - r_t) + \\frac{1}{2}(2) \\cdot (\\sigma\\sqrt{r_t})^2 \\right) dt + (2r_t) \\cdot (\\sigma\\sqrt{r_t}) dW_t\n$$\n$$\nd(r_t^2) = (2\\kappa\\theta r_t - 2\\kappa r_t^2 + \\sigma^2 r_t) dt + 2\\sigma r_t^{3/2} dW_t\n$$\n$$\nd(r_t^2) = ((2\\kappa\\theta + \\sigma^2)r_t - 2\\kappa r_t^2) dt + 2\\sigma r_t^{3/2} dW_t\n$$\n为了找到 $m_2(t) = \\mathbb{E}[r_t^2 \\mid r_0]$ 的 ODE，我们对该 SDE 的积分形式取条件期望：\n$$\n\\mathbb{E}[r_t^2 \\mid r_0] = \\mathbb{E}[r_0^2 \\mid r_0] + \\mathbb{E}\\left[\\int_0^t ((2\\kappa\\theta + \\sigma^2)r_s - 2\\kappa r_s^2) ds \\;\\middle|\\; r_0\\right] + \\mathbb{E}\\left[\\int_0^t 2\\sigma r_s^{3/2} dW_s \\;\\middle|\\; r_0\\right]\n$$\n伊藤积分项的期望为零。利用期望的线性和富比尼定理（Fubini's theorem），我们得到：\n$$\nm_2(t) = r_0^2 + \\int_0^t \\left( (2\\kappa\\theta + \\sigma^2)\\mathbb{E}[r_s \\mid r_0] - 2\\kappa\\mathbb{E}[r_s^2 \\mid r_0] \\right) ds\n$$\n$$\nm_2(t) = r_0^2 + \\int_0^t ((2\\kappa\\theta + \\sigma^2)m_1(s) - 2\\kappa m_2(s)) ds\n$$\n对 $t$ 求导，得到 $m_2(t)$ 的线性 ODE：\n$$\n\\frac{dm_2}{dt} = (2\\kappa\\theta + \\sigma^2)m_1(t) - 2\\kappa m_2(t)\n$$\n初始条件为 $m_2(0) = \\mathbb{E}[r_0^2 \\mid r_0] = r_0^2$。\n\n为了继续，我们需要 $m_1(t)$ 的表达式。我们通过对 $r_t$ 的原始 SDE 取期望来找到其控制 ODE：\n$$\n\\mathbb{E}[r_t \\mid r_0] = \\mathbb{E}[r_0 \\mid r_0] + \\mathbb{E}\\left[\\int_0^t \\kappa(\\theta - r_s) ds \\;\\middle|\\; r_0\\right] + \\mathbb{E}\\left[\\int_0^t \\sigma \\sqrt{r_s} dW_s \\;\\middle|\\; r_0\\right]\n$$\n$$\nm_1(t) = r_0 + \\int_0^t \\kappa(\\theta - m_1(s)) ds\n$$\n对 $t$ 求导，得到 $m_1(t)$ 的 ODE：\n$$\n\\frac{dm_1}{dt} = \\kappa(\\theta - m_1(t)) \\quad \\text{或} \\quad \\frac{dm_1}{dt} + \\kappa m_1(t) = \\kappa\\theta\n$$\n初始条件为 $m_1(0) = \\mathbb{E}[r_0 \\mid r_0] = r_0$。这是一个一阶线性 ODE，其积分因子为 $\\exp(\\kappa t)$。解为：\n$$\nm_1(t) = \\theta + (r_0 - \\theta)\\exp(-\\kappa t) = r_0 \\exp(-\\kappa t) + \\theta(1 - \\exp(-\\kappa t))\n$$\n现在，我们来求方差 $V(t) = \\operatorname{Var}(r_t \\mid r_0) = m_2(t) - (m_1(t))^2$ 的 ODE。对 $t$ 求导：\n$$\n\\frac{dV}{dt} = \\frac{dm_2}{dt} - 2m_1(t)\\frac{dm_1}{dt}\n$$\n代入 $m_1(t)$ 和 $m_2(t)$ 的 ODE：\n$$\n\\frac{dV}{dt} = \\left( (2\\kappa\\theta + \\sigma^2)m_1(t) - 2\\kappa m_2(t) \\right) - 2m_1(t) \\left( \\kappa\\theta - \\kappa m_1(t) \\right)\n$$\n$$\n\\frac{dV}{dt} = 2\\kappa\\theta m_1(t) + \\sigma^2 m_1(t) - 2\\kappa m_2(t) - 2\\kappa\\theta m_1(t) + 2\\kappa (m_1(t))^2\n$$\n$$\n\\frac{dV}{dt} = \\sigma^2 m_1(t) - 2\\kappa \\left( m_2(t) - (m_1(t))^2 \\right)\n$$\n$$\n\\frac{dV}{dt} = \\sigma^2 m_1(t) - 2\\kappa V(t)\n$$\n这给出了方差 $V(t)$ 的一个一阶线性 ODE：\n$$\n\\frac{dV}{dt} + 2\\kappa V(t) = \\sigma^2 m_1(t)\n$$\n初始条件为 $V(0) = \\operatorname{Var}(r_0 \\mid r_0) = 0$，因为 $r_0$ 是一个给定的常数。\n将 $m_1(t)$ 的解代入 $V(t)$ 的 ODE：\n$$\n\\frac{dV}{dt} + 2\\kappa V(t) = \\sigma^2 \\left( \\theta + (r_0 - \\theta)\\exp(-\\kappa t) \\right)\n$$\n这个 ODE 的积分因子是 $\\exp(2\\kappa t)$。将方程乘以该因子：\n$$\n\\exp(2\\kappa t)\\frac{dV}{dt} + 2\\kappa \\exp(2\\kappa t)V(t) = \\sigma^2 \\left( \\theta\\exp(2\\kappa t) + (r_0 - \\theta)\\exp(\\kappa t) \\right)\n$$\n$$\n\\frac{d}{dt}\\left( V(t)\\exp(2\\kappa t) \\right) = \\sigma^2 \\theta\\exp(2\\kappa t) + \\sigma^2(r_0 - \\theta)\\exp(\\kappa t)\n$$\n对两边从 $0$ 到 $t$ 积分：\n$$\n\\int_0^t \\frac{d}{ds}\\left( V(s)\\exp(2\\kappa s) \\right) ds = \\int_0^t \\left( \\sigma^2 \\theta\\exp(2\\kappa s) + \\sigma^2(r_0 - \\theta)\\exp(\\kappa s) \\right) ds\n$$\n$$\nV(t)\\exp(2\\kappa t) - V(0)\\exp(0) = \\sigma^2 \\theta \\left[ \\frac{\\exp(2\\kappa s)}{2\\kappa} \\right]_0^t + \\sigma^2(r_0 - \\theta) \\left[ \\frac{\\exp(\\kappa s)}{\\kappa} \\right]_0^t\n$$\n由于 $V(0) = 0$：\n$$\nV(t)\\exp(2\\kappa t) = \\frac{\\sigma^2 \\theta}{2\\kappa}(\\exp(2\\kappa t) - 1) + \\frac{\\sigma^2(r_0 - \\theta)}{\\kappa}(\\exp(\\kappa t) - 1)\n$$\n最后，乘以 $\\exp(-2\\kappa t)$ 来求解 $V(t)$：\n$$\nV(t) = \\frac{\\sigma^2 \\theta}{2\\kappa}(1 - \\exp(-2\\kappa t)) + \\frac{\\sigma^2(r_0 - \\theta)}{\\kappa}(\\exp(-\\kappa t) - \\exp(-2\\kappa t))\n$$\n这个表达式可以重排成更标准的形式。我们按 $r_0$ 和 $\\theta$ 对各项进行分组：\n$$\nV(t) = \\frac{\\sigma^2 r_0}{\\kappa}(\\exp(-\\kappa t) - \\exp(-2\\kappa t)) + \\frac{\\sigma^2 \\theta}{2\\kappa}(1 - \\exp(-2\\kappa t)) - \\frac{\\sigma^2 \\theta}{\\kappa}(\\exp(-\\kappa t) - \\exp(-2\\kappa t))\n$$\n$$\nV(t) = \\frac{\\sigma^2 r_0}{\\kappa}(\\exp(-\\kappa t) - \\exp(-2\\kappa t)) + \\frac{\\sigma^2 \\theta}{2\\kappa}(1 - \\exp(-2\\kappa t) - 2\\exp(-\\kappa t) + 2\\exp(-2\\kappa t))\n$$\n$$\nV(t) = \\frac{\\sigma^2 r_0}{\\kappa}(\\exp(-\\kappa t) - \\exp(-2\\kappa t)) + \\frac{\\sigma^2 \\theta}{2\\kappa}(1 - 2\\exp(-\\kappa t) + \\exp(-2\\kappa t))\n$$\n注意到完全平方公式 $(1-x)^2 = 1 - 2x + x^2$：\n$$\nV(t) = \\frac{\\sigma^2 r_0}{\\kappa}(\\exp(-\\kappa t) - \\exp(-2\\kappa t)) + \\frac{\\sigma^2 \\theta}{2\\kappa}(1 - \\exp(-\\kappa t))^2\n$$\n这就是条件方差的闭式表达式。", "answer": "$$\n\\boxed{\\frac{\\sigma^{2} r_{0}}{\\kappa}\\left(\\exp(-\\kappa t) - \\exp(-2\\kappa t)\\right) + \\frac{\\sigma^{2} \\theta}{2\\kappa}\\left(1 - \\exp(-\\kappa t)\\right)^{2}}\n$$", "id": "3080159"}, {"introduction": "理论模型在实际应用中通常需要通过计算机进行模拟。本练习探讨了最常见的模拟方法——欧拉-丸山（Euler-Maruyama）格式，并揭示了其一个重要缺陷。[@problem_id:1710381] 尽管CIR模型的理论保证了利率的非负性，但你会发现数值近似可能会产生负值，理解这一理论与实践之间的差异对于任何随机模型的实践者都至关重要。", "problem": "Cox-Ingersoll-Ross (CIR) 模型在金融数学中常被用来描述利率随时间的演变。该理论模型的一个关键特性是利率过程 $X_t$ 保持非负性。$X_t$ 的动态由以下随机微分方程 (SDE) 描述：\n$$dX_t = \\kappa(\\theta - X_t)dt + \\sigma \\sqrt{X_t} dW_t$$\n其中 $\\kappa  0$ 是均值回归速率，$\\theta  0$ 是长期均值，$\\sigma  0$ 是波动率参数，$W_t$ 是一个标准维纳过程。对于从正值开始的连续过程 $X_t$ 要保持严格为正，一个充分条件是 $2\\kappa\\theta  \\sigma^2$。\n\n为了对这个过程进行数值模拟，可以采用欧拉-丸山方法 (Euler-Maruyama method)。该方法在时间步长为 $\\Delta t$ 的单步计算中，从时间 $t_n$ 的状态 $X_n$ 开始，计算在时间 $t_{n+1} = t_n + \\Delta t$ 的下一个状态 $X_{n+1}$ 如下：\n$$X_{n+1} = X_n + \\kappa(\\theta - X_n)\\Delta t + \\sigma \\sqrt{X_n} \\Delta W_n$$\n此处，维纳过程的增量 $\\Delta W_n$ 是一个服从均值为 0、方差为 $\\Delta t$ 的正态分布的随机变量。\n\n考虑一个具体的 CIR 模型实例，其参数为 $\\kappa = 0.5$，$\\theta = 0.04$，以及 $\\sigma = 0.3$。这些参数满足正值条件 $2\\kappa\\theta  \\sigma^2$。假设过程的当前状态为 $X_n = 0.01$。我们希望使用欧拉-丸山方法，在单个时间步长 $\\Delta t = 0.25$ 的条件下，模拟下一个状态 $X_{n+1}$。\n\n尽管理论上保证了连续过程的正值性，但这种数值方法可能会产生负值。计算下一个模拟值 $X_{n+1}$ 为负的概率。将最终答案四舍五入到三位有效数字。", "solution": "我们应用一步欧拉-丸山方法：\n$$\nX_{n+1} = X_{n} + \\kappa(\\theta - X_{n})\\Delta t + \\sigma \\sqrt{X_{n}}\\,\\Delta W_{n},\n$$\n其中 $\\Delta W_{n} \\sim \\mathcal{N}(0,\\Delta t)$。在给定 $X_n$ 的条件下，这是一个正态变量的仿射变换，因此 $X_{n+1}$ 服从正态分布，其均值为\n$$\nm = X_{n} + \\kappa(\\theta - X_{n})\\Delta t\n$$\n方差为\n$$\nv = \\sigma^{2} X_{n} \\Delta t,\n$$\n因此标准差为 $s = \\sqrt{v} = \\sigma \\sqrt{X_{n}\\Delta t}$。\n\n欧拉步骤结果为负的概率是\n$$\n\\mathbb{P}(X_{n+1}  0 \\mid X_{n}) = \\mathbb{P}\\!\\left(\\frac{X_{n+1} - m}{s}  \\frac{0 - m}{s}\\right) = \\Phi\\!\\left(-\\frac{m}{s}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。\n\n代入给定值 $\\kappa = 0.5$, $\\theta = 0.04$, $\\sigma = 0.3$, $X_{n} = 0.01$ 和 $\\Delta t = 0.25$，我们计算得出\n$$\nm = 0.01 + 0.5\\,(0.04 - 0.01)\\,0.25 = 0.01 + 0.5 \\cdot 0.03 \\cdot 0.25 = 0.01375,\n$$\n$$\nv = 0.3^{2} \\cdot 0.01 \\cdot 0.25 = 0.000225, \\quad s = \\sqrt{0.000225} = 0.015.\n$$\n因此，\n$$\n\\frac{m}{s} = \\frac{0.01375}{0.015} = \\frac{11}{12}, \\quad \\text{所以} \\quad \\mathbb{P}(X_{n+1}  0) = \\Phi\\!\\left(-\\frac{11}{12}\\right).\n$$\n数值上，$\\Phi(-11/12) \\approx 0.1797$，四舍五入到三位有效数字为 $0.180$。", "answer": "$$\\boxed{0.180}$$", "id": "1710381"}]}