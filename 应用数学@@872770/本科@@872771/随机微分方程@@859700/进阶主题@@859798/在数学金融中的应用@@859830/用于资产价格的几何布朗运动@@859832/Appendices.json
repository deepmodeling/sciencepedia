{"hands_on_practices": [{"introduction": "几何布朗运动是模拟资产价格的常用模型，其价格服从对数正态分布。这种分布是偏态的，意味着其均值和中位数的表现有所不同。本练习旨在让你计算期望价格（均值）和中位数价格达到特定目标水平所需的时间，从而深入理解模型的行为以及偏度的概念。[@problem_id:3057152]", "problem": "一个资产价格过程 $\\{S_t\\}_{t \\ge 0}$ 服从由随机微分方程 (SDE) 给出的几何布朗运动动力学\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t, \\quad S_0>0,\n$$\n其中 $\\mu$ 和 $\\sigma$ 是实常数且 $\\sigma>0$，$\\{W_t\\}_{t\\ge 0}$ 是一个标准布朗运动。设 $L$ 为一个固定水平，且 $L>S_0$。假设 $\\mu>0$ 且 $\\mu>\\sigma^2/2$，因此 $S_t$ 的均值和中位数最终都会超过 $L$。\n\n从SDE的定义和随机微积分的基本原理出发，确定以下两个时间点的精确表达式：\n- 期望 $\\mathbb{E}[S_t]$ 首次达到水平 $L$ 的时间 $t_E^{\\ast}$，即满足 $\\mathbb{E}[S_t] = L$ 的唯一 $t>0$。\n- $S_t$ 的中位数首次达到水平 $L$ 的时间 $t_M^{\\ast}$，即在时间 $t$ 时 $S_t$ 分布的中位数等于 $L$ 的唯一 $t>0$。\n\n以 $S_0$、$L$、$\\mu$ 和 $\\sigma$ 的闭式解析表达式给出您的答案。然后，在给定假设下比较 $t_E^{\\ast}$ 和 $t_M^{\\ast}$。最终答案必须是写成行矩阵形式的数对 $\\big(t_E^{\\ast},\\,t_M^{\\ast}\\big)$。不需要进行数值计算或四舍五入。", "solution": "第一步是通过求解给定的随机微分方程，找到资产价格 $S_t$ 的显式解。我们将 Itô 引理应用于函数 $f(S_t) = \\ln(S_t)$。$f(S)$ 的导数为 $\\frac{\\partial f}{\\partial S} = \\frac{1}{S_t}$ 和 $\\frac{\\partial^2 f}{\\partial S^2} = -\\frac{1}{S_t^2}$。\n\n根据 Itô 引理，$f(S_t)$ 的微分为：\n$$\n\\mathrm{d}(\\ln S_t) = \\frac{\\partial f}{\\partial S} \\mathrm{d}S_t + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial S^2} (\\mathrm{d}S_t)^2\n$$\n代入 $S_t$ 的导数和 SDE：\n$$\n\\mathrm{d}(\\ln S_t) = \\frac{1}{S_t} (\\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right) (\\sigma S_t \\,\\mathrm{d}W_t)^2\n$$\n利用布朗运动的二次变分性质 $(\\mathrm{d}W_t)^2 = \\mathrm{d}t$，我们简化最后一项：\n$$\n(\\sigma S_t \\,\\mathrm{d}W_t)^2 = \\sigma^2 S_t^2 (\\mathrm{d}W_t)^2 = \\sigma^2 S_t^2 \\mathrm{d}t\n$$\n将其代回到 $\\mathrm{d}(\\ln S_t)$ 的表达式中：\n$$\n\\mathrm{d}(\\ln S_t) = (\\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t) - \\frac{1}{2} \\frac{1}{S_t^2} (\\sigma^2 S_t^2 \\mathrm{d}t) = (\\mu - \\frac{1}{2}\\sigma^2)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\n这是一个关于 $\\ln(S_t)$ 的算术布朗运动。我们可以将其从 $0$ 积分到 $t$：\n$$\n\\int_0^t \\mathrm{d}(\\ln S_u) = \\int_0^t (\\mu - \\frac{1}{2}\\sigma^2)\\,\\mathrm{d}u + \\int_0^t \\sigma\\,\\mathrm{d}W_u\n$$\n$$\n\\ln(S_t) - \\ln(S_0) = (\\mu - \\frac{1}{2}\\sigma^2)t + \\sigma(W_t - W_0)\n$$\n已知 $W_0=0$，我们有：\n$$\n\\ln(S_t) = \\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t + \\sigma W_t\n$$\n对两边取指数，得到 $S_t$ 的显式解：\n$$\nS_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)\n$$\n该解表明 $S_t$ 服从对数正态分布，因为 $\\ln(S_t)$ 服从正态分布，其均值为 $\\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t$，方差为 $\\sigma^2 t$。即 $\\ln(S_t) \\sim \\mathcal{N}\\left(\\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t, \\sigma^2 t\\right)$。\n\n**$t_E^{\\ast}$ 的确定**\n\n我们首先计算期望 $\\mathbb{E}[S_t]$：\n$$\n\\mathbb{E}[S_t] = \\mathbb{E}\\left[ S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right) \\right] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right) \\mathbb{E}\\left[\\exp(\\sigma W_t)\\right]\n$$\n项 $\\mathbb{E}[\\exp(\\sigma W_t)]$ 是正态随机变量 $W_t \\sim \\mathcal{N}(0, t)$ 在 $\\sigma$ 处的矩生成函数。对于一个一般的正态随机变量 $X \\sim \\mathcal{N}(\\nu, \\tau^2)$，其矩生成函数为 $\\mathbb{E}[\\exp(k X)] = \\exp(k\\nu + \\frac{1}{2}k^2\\tau^2)$。对于 $W_t$，我们有 $\\nu=0$，$\\tau^2=t$，并且在 $k=\\sigma$ 处求值。\n$$\n\\mathbb{E}[\\exp(\\sigma W_t)] = \\exp\\left(\\sigma \\cdot 0 + \\frac{1}{2}\\sigma^2 t\\right) = \\exp\\left(\\frac{1}{2}\\sigma^2 t\\right)\n$$\n将其代回到 $S_t$ 的期望中：\n$$\n\\mathbb{E}[S_t] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right) \\exp\\left(\\frac{1}{2}\\sigma^2 t\\right) = S_0 \\exp\\left( \\mu t - \\frac{1}{2}\\sigma^2 t + \\frac{1}{2}\\sigma^2 t \\right) = S_0 \\exp(\\mu t)\n$$\n现在，我们通过设置 $\\mathbb{E}[S_t] = L$ 来求解 $t_E^{\\ast}$：\n$$\nS_0 \\exp(\\mu t_E^{\\ast}) = L \\implies \\exp(\\mu t_E^{\\ast}) = \\frac{L}{S_0}\n$$\n对两边取自然对数：\n$$\n\\mu t_E^{\\ast} = \\ln\\left(\\frac{L}{S_0}\\right) \\implies t_E^{\\ast} = \\frac{1}{\\mu} \\ln\\left(\\frac{L}{S_0}\\right)\n$$\n条件 $L>S_0$ 和 $\\mu>0$ 确保了 $t_E^{\\ast}$ 是正的且定义明确。\n\n**$t_M^{\\ast}$ 的确定**\n\n$S_t$ 的中位数，我们记为 $m_t$，是满足 $\\mathbb{P}(S_t \\le m_t) = \\frac{1}{2}$ 的值。由于自然对数是一个严格递增函数，这等价于：\n$$\n\\mathbb{P}(\\ln(S_t) \\le \\ln(m_t)) = \\frac{1}{2}\n$$\n这个陈述意味着 $\\ln(m_t)$ 是正态分布随机变量 $\\ln(S_t)$ 的中位数。对于任何正态分布，中位数等于其均值。$\\ln(S_t)$ 的均值为：\n$$\n\\mathbb{E}[\\ln(S_t)] = \\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t\n$$\n因此，我们有：\n$$\n\\ln(m_t) = \\ln(S_0) + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t\n$$\n对两边取指数得到 $S_t$ 的中位数：\n$$\nm_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right)\n$$\n我们通过将时间 $t$ 的中位数设为 $L$ 来求解 $t_M^{\\ast}$：\n$$\nS_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t_M^{\\ast} \\right) = L \\implies \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t_M^{\\ast} \\right) = \\frac{L}{S_0}\n$$\n对两边取自然对数：\n$$\n\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t_M^{\\ast} = \\ln\\left(\\frac{L}{S_0}\\right) \\implies t_M^{\\ast} = \\frac{1}{\\mu - \\frac{1}{2}\\sigma^2} \\ln\\left(\\frac{L}{S_0}\\right)\n$$\n条件 $L>S_0$ 和 $\\mu > \\sigma^2/2$ 确保了 $t_M^{\\ast}$ 是正的且定义明确。\n\n**$t_E^{\\ast}$ 与 $t_M^{\\ast}$ 的比较**\n\n我们有两个表达式：\n$$\nt_E^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu} \\quad \\text{和} \\quad t_M^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu - \\frac{1}{2}\\sigma^2}\n$$\n由于 $L > S_0$，项 $\\ln(L/S_0)$ 是正的。比较取决于分母。我们已知 $\\sigma>0$，这意味着 $\\frac{1}{2}\\sigma^2 > 0$。因此可得：\n$$\n\\mu > \\mu - \\frac{1}{2}\\sigma^2\n$$\n问题陈述中指出 $\\mu>0$ 且 $\\mu > \\sigma^2/2$，所以两个分母都是正的。对一个正不等式取倒数会反转其方向：\n$$\n\\frac{1}{\\mu}  \\frac{1}{\\mu - \\frac{1}{2}\\sigma^2}\n$$\n乘以正量 $\\ln(L/S_0)$ 保持不等式不变：\n$$\n\\frac{\\ln(L/S_0)}{\\mu}  \\frac{\\ln(L/S_0)}{\\mu - \\frac{1}{2}\\sigma^2} \\implies t_E^{\\ast}  t_M^{\\ast}\n$$\n这个结果与对数正态分布的性质一致，该分布是右偏的。均值被低概率、高价值结果的长尾拉向中位数的右侧。因此，均值以比中位数（速率为 $\\mu-\\sigma^2/2$）更快的有效速率（$\\mu$）增长，从而更早达到水平 $L$。\n\n最终答案要求的是数对 $\\big(t_E^{\\ast},\\,t_M^{\\ast}\\big)$。\n表达式为：\n$t_E^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu}$\n$t_M^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu - \\frac{1}{2}\\sigma^2}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\ln\\left(\\frac{L}{S_0}\\right)}{\\mu}  \\frac{\\ln\\left(\\frac{L}{S_0}\\right)}{\\mu - \\frac{1}{2}\\sigma^2} \\end{pmatrix}}\n$$", "id": "3057152"}, {"introduction": "在理解了资产价格的总体轨迹后，一个关键任务是通过计算概率来量化不确定性。本练习将指导你推导在给定当前价格的情况下，资产价格在未来某个时间点落在特定区间内的概率。掌握这项技能对于风险管理和期权等金融衍生品的定价至关重要。[@problem_id:3057140]", "problem": "考虑一个资产价格过程 $\\{S_{t}\\}_{t \\geq 0}$，其模型为几何布朗运动 (GBM)，遵循随机微分方程 $dS_{t}=\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t}$，其中 $W_{t}$ 是一个标准布朗运动，$\\mu \\in \\mathbb{R}$ 是一个常数漂移，$\\sigma0$ 是一个常数波动率。令 $0 \\leq u  t$ 为固定时间，并假设在 $S_{u}=x$ 处有一个观测值，其中 $x>0$。令 $a$ 和 $b$ 为满足 $0  a  b$ 的两个常数。推导在时间 $t$ 时资产价格 $S_t$ 位于区间 $(a,b)$ 内的条件概率，即 $P(a  S_t  b | S_u = x)$。", "solution": "资产价格过程 $\\{S_{t}\\}_{t \\geq 0}$ 由几何布朗运动 (GBM) 的随机微分方程 (SDE) 控制：\n$$dS_{t}=\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t}$$\n其中 $W_{t}$ 是标准布朗运动，$\\mu$ 是常数漂移，$\\sigma  0$ 是常数波动率。我们给定条件 $S_{u}=x$，其中时间 $u \\geq 0$ 且 $x>0$。我们的目标是对于固定的时间 $0 \\leq u  t$ 和常数 $0  a  b$，推导在时间 $t$ 时资产价格 $S_t$ 位于区间 $(a,b)$ 内的条件概率 $P(a  S_t  b | S_u = x)$。\n\nGBM 的SDE的解为：\n$$S_{t}=S_{0}\\exp\\left(\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)t+\\sigma W_{t}\\right)$$\n对于一个从时间 $u$ 开始，初始值为 $S_u=x$ 的过程，解可以写成：\n$$S_{t}=S_{u}\\exp\\left(\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)+\\sigma(W_{t}-W_{u})\\right)$$\n代入 $S_{u}=x$：\n$$S_{t}=x\\exp\\left(\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)+\\sigma(W_{t}-W_{u})\\right)$$\n我们想要求解概率 $P(a  S_{t}  b | S_u=x)$。由于自然对数 $\\ln(\\cdot)$ 是一个严格单调递增函数，不等式 $a  S_t  b$ 等价于 $\\ln(a)  \\ln(S_t)  \\ln(b)$。因此：\n$$P(a  S_t  b | S_u=x) = P(\\ln(a)  \\ln(S_t)  \\ln(b) | S_u=x)$$\n让我们来处理 $\\ln(S_t)$ 的表达式：\n$$\\ln(S_t) = \\ln(x) + \\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u) + \\sigma(W_{t}-W_{u})$$\n布朗运动的增量 $W_{t}-W_{u}$ 是一个正态分布的随机变量，其均值为 0，方差为 $t-u$。因此，$W_{t}-W_{u} \\sim \\mathcal{N}(0, t-u)$。\n这意味着 $\\ln(S_t)$ 是一个正态分布的随机变量。它的条件分布（给定 $S_u=x$）的均值和方差为：\n$$\\mathbb{E}[\\ln(S_t)|S_u=x] = \\ln(x) + \\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)$$\n$$\\text{Var}(\\ln(S_t)|S_u=x) = \\text{Var}\\left(\\sigma(W_{t}-W_{u})\\right) = \\sigma^{2}\\text{Var}(W_t-W_u) = \\sigma^{2}(t-u)$$\n所以，给定 $S_u=x$，$\\ln(S_t) \\sim \\mathcal{N}\\left(\\ln(x)+\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u), \\sigma^{2}(t-u)\\right)$。\n\n为了计算概率，我们对变量 $\\ln(S_t)$ 进行标准化。我们定义一个标准正态变量 $Z$：\n$$Z = \\frac{\\ln(S_t) - \\mathbb{E}[\\ln(S_t)|S_u=x]}{\\sqrt{\\text{Var}(\\ln(S_t)|S_u=x)}} = \\frac{\\ln(S_t) - \\left(\\ln(x)+\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)\\right)}{\\sigma\\sqrt{t-u}}$$\n其中 $Z \\sim \\mathcal{N}(0,1)$。\n现在我们将不等式 $\\ln(a)  \\ln(S_t)  \\ln(b)$ 转换为关于 $Z$ 的不等式：\n$$\\frac{\\ln(a) - \\left(\\ln(x)+\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)\\right)}{\\sigma\\sqrt{t-u}}  Z  \\frac{\\ln(b) - \\left(\\ln(x)+\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)\\right)}{\\sigma\\sqrt{t-u}}$$\n这个概率可以用标准正态累积分布函数 (CDF) $\\Phi(\\cdot)$ 来表示：\n$$P(\\ln(a)  \\ln(S_t)  \\ln(b) | S_u=x) = \\Phi\\left(\\frac{\\ln(b) - \\ln(x) - \\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)}{\\sigma\\sqrt{t-u}}\\right) - \\Phi\\left(\\frac{\\ln(a) - \\ln(x) - \\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)}{\\sigma\\sqrt{t-u}}\\right)$$\n利用对数性质 $\\ln(a)-\\ln(b) = \\ln(a/b)$，我们可以简化表达式：\n$$P(a  S_t  b | S_u=x) = \\Phi\\left(\\frac{\\ln(b/x) - \\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)}{\\sigma\\sqrt{t-u}}\\right) - \\Phi\\left(\\frac{\\ln(a/x) - \\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)(t-u)}{\\sigma\\sqrt{t-u}}\\right)$$\n这就是最终的公式。", "answer": "$$\\boxed{\\Phi\\left(\\frac{\\ln\\left(\\frac{b}{x}\\right) - \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)(t-u)}{\\sigma\\sqrt{t-u}}\\right) - \\Phi\\left(\\frac{\\ln\\left(\\frac{a}{x}\\right) - \\left(\\mu - \\frac{1}{2}\\sigma^{2}\\right)(t-u)}{\\sigma\\sqrt{t-u}}\\right)}$$", "id": "3057140"}, {"introduction": "虽然解析解能提供深刻的洞见，但许多现实世界中的金融问题都需要数值模拟。本练习要求你推导几何布朗运动的精确模拟方案，这是金融领域蒙特卡洛方法的基础。这个关键步骤将连续时间的随机微分方程（SDE）转化为可在代码中实现的离散时间公式，用于生成资产价格路径。[@problem_id:3057144]", "problem": "一个资产价格过程 $\\{S_t\\}_{t \\ge 0}$ 被建模为几何布朗运动 (GBM)，由随机微分方程 (SDE) 控制\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t,\n$$\n其中 $\\mu \\in \\mathbb{R}$ 和 $\\sigma  0$ 是常数，$\\{W_t\\}_{t \\ge 0}$ 是标准布朗运动。考虑一个等距时间网格 $\\{t_k\\}_{k=0}^{n}$，其中 $t_k = k\\,\\Delta t$，$k \\in \\{0,1,\\dots,n\\}$，且 $\\Delta t  0$ 为固定值。\n\n仅从基本定义和公认事实出发，即伊藤公式 (Itô's formula)、对数链式法则以及布朗运动的独立、平稳、高斯增量性质，推导出一个精确的单步模拟公式，该公式仅用 $S_{t_k}$、参数 $\\mu$、$\\sigma$、步长 $\\Delta t$ 以及一个标准正态随机变量 $Z_k \\sim \\mathcal{N}(0,1)$ 来表示 $S_{t_{k+1}}$。\n\n您的最终答案必须是 $S_{t_{k+1}}$ 关于 $S_{t_k}$、$\\mu$、$\\sigma$、$\\Delta t$ 和 $Z_k$ 的单个显式表达式。不要进行任何近似。不需要四舍五入。", "solution": "问题要求推导几何布朗运动 (GBM) 过程 $\\{S_t\\}_{t \\ge 0}$ 的精确单步模拟公式。该过程由随机微分方程 (SDE) 控制：\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t\n$$\n其中 $\\mu$ 是漂移率，$\\sigma$ 是波动率，$\\{W_t\\}_{t \\ge 0}$ 是标准布朗运动。目标是在时间步长 $\\Delta t = t_{k+1} - t_k$ 上，用 $S_{t_k}$ 来表示 $S_{t_{k+1}}$。\n\n为了求解这个 SDE，我们引入对过程 $S_t$ 的一个变换。噪声项的乘法性质表明可以采用对数变换。让我们定义一个新过程 $X_t = f(S_t) = \\ln(S_t)$。我们可以通过应用伊藤公式 (Itô's formula) 来找到 $X_t$ 的动态过程。\n\n对于一个过程 $X_t = f(t, Y_t)$，其中 $Y_t$ 的动态过程由 $\\mathrm{d}Y_t = a(t, Y_t)\\mathrm{d}t + b(t, Y_t)\\mathrm{d}W_t$ 给出，伊藤公式 (Itô's formula) 表明：\n$$\n\\mathrm{d}X_t = \\left( \\frac{\\partial f}{\\partial t} + a \\frac{\\partial f}{\\partial Y_t} + \\frac{1}{2} b^2 \\frac{\\partial^2 f}{\\partial Y_t^2} \\right) \\mathrm{d}t + b \\frac{\\partial f}{\\partial Y_t} \\mathrm{d}W_t\n$$\n在我们的例子中，$Y_t = S_t$，函数是 $f(S_t) = \\ln(S_t)$，它不显式依赖于 $t$。$S_t$ 的 SDE 的系数是 $a(t, S_t) = \\mu S_t$ 和 $b(t, S_t) = \\sigma S_t$。\n\n我们首先计算 $f(S_t) = \\ln(S_t)$ 关于 $S_t$ 所需的偏导数：\n- 一阶偏导数：$\\frac{\\partial f}{\\partial S_t} = \\frac{1}{S_t}$\n- 二阶偏导数：$\\frac{\\partial^2 f}{\\partial S_t^2} = -\\frac{1}{S_t^2}$\n- 关于时间的偏导数是 $\\frac{\\partial f}{\\partial t} = 0$。\n\n现在，我们将这些导数以及系数 $a$ 和 $b$ 代入伊藤公式 (Itô's formula)，以求得 $X_t = \\ln(S_t)$ 的 SDE：\n$$\n\\mathrm{d}(\\ln S_t) = \\left( 0 + (\\mu S_t) \\left( \\frac{1}{S_t} \\right) + \\frac{1}{2} (\\sigma S_t)^2 \\left( -\\frac{1}{S_t^2} \\right) \\right) \\mathrm{d}t + (\\sigma S_t) \\left( \\frac{1}{S_t} \\right) \\mathrm{d}W_t\n$$\n化简括号内的项得到：\n$$\n\\mathrm{d}(\\ln S_t) = \\left( \\mu - \\frac{1}{2} \\sigma^2 S_t^2 \\frac{1}{S_t^2} \\right) \\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\n这简化为一个具有常数系数的线性 SDE，表示一个漂移率为 $(\\mu - \\frac{1}{2}\\sigma^2)$、波动率为 $\\sigma$ 的算术布朗运动：\n$$\n\\mathrm{d}(\\ln S_t) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\n为了找到单步模拟公式，我们将此 SDE 在时间区间 $[t_k, t_{k+1}]$ 上积分：\n$$\n\\int_{t_k}^{t_{k+1}} \\mathrm{d}(\\ln S_t) = \\int_{t_k}^{t_{k+1}} \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\mathrm{d}t + \\int_{t_k}^{t_{k+1}} \\sigma \\mathrm{d}W_t\n$$\n计算积分得出：\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) (t_{k+1} - t_k) + \\sigma (W_{t_{k+1}} - W_{t_k})\n$$\n令 $\\Delta t = t_{k+1} - t_k$。方程变为：\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma (W_{t_{k+1}} - W_{t_k})\n$$\n问题陈述要求使用标准布朗运动的增量是独立的且服从正态分布的性质。对于任意 $t  s$，增量 $W_t - W_s$ 服从均值为 $0$、方差为 $t-s$ 的正态分布。因此，对于我们的时间间隔 $\\Delta t$：\n$$\nW_{t_{k+1}} - W_{t_k} \\sim \\mathcal{N}(0, \\Delta t)\n$$\n一个从 $\\mathcal{N}(0, \\Delta t)$ 中抽取的随机变量可以表示为 $\\sqrt{\\Delta t}$ 与一个标准正态随机变量 $Z \\sim \\mathcal{N}(0, 1)$ 的乘积。对于每个独立的时间步 $k$，我们可以写出：\n$$\nW_{t_{k+1}} - W_{t_k} = \\sqrt{\\Delta t} \\, Z_k\n$$\n其中 $\\{Z_k\\}$ 是一个独立同分布的标准正态随机变量序列。\n\n将此代入我们的积分方程中得到：\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k\n$$\n为了求得 $S_{t_{k+1}}$ 的显式公式，我们首先分离出 $\\ln(S_{t_{k+1}})$：\n$$\n\\ln(S_{t_{k+1}}) = \\ln(S_{t_k}) + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k\n$$\n最后，我们对两边取指数以解出 $S_{t_{k+1}}$：\n$$\nS_{t_{k+1}} = \\exp\\left( \\ln(S_{t_k}) + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k \\right)\n$$\n使用性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以分离出 $S_{t_k}$ 项：\n$$\nS_{t_{k+1}} = \\exp(\\ln(S_{t_k})) \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k \\right)\n$$\n由于 $\\exp(\\ln(x))=x$，我们得到几何布朗运动的精确单步模拟公式：\n$$\nS_{t_{k+1}} = S_{t_k} \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k \\right)\n$$\n该公式按要求仅用 $S_{t_k}$ 和给定的参数表示 $S_{t_{k+1}}$。", "answer": "$$\n\\boxed{S_{t_k} \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} Z_k \\right)}\n$$", "id": "3057144"}]}