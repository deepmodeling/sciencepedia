{"hands_on_practices": [{"introduction": "在我们运用 Vasicek 模型进行定价等复杂任务之前，我们必须首先理解它所描述的利率过程的基本行为。第一个练习将指导你推导利率的预期未来路径，这对于建立关于“均值回归”的直觉至关重要——这是该模型的核心特征，即利率不断被拉向一个长期平均值。通过这个推导，你将掌握 Vasicek 模型最重要的动态特性之一。[@problem_id:3082515]", "problem": "考虑 Vasicek 模型中的短利率过程，它由瞬时利率的线性随机微分方程 (SDE) 定义，\n$$\n\\mathrm{d}r_{t}=\\kappa\\left(\\theta-r_{t}\\right)\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t},\n$$\n其中 $W_{t}$ 是标准布朗运动（维纳过程），$\\kappa0$、$\\theta\\in\\mathbb{R}$ 和 $\\sigma0$ 是常数。初始条件为 $r_{0}\\in\\mathbb{R}$。从这个 SDE 出发，仅使用随机微积分的核心定义（例如 Itô 积分的性质），推导出期望 $E[r_{t}]$ 作为 $t$、$\\kappa$、$\\theta$ 和 $r_{0}$ 的函数的显式表达式。然后，根据您的表达式，简要解释“期望上的均值回归”在该模型中意味着什么。您最终报告的答案必须是 $E[r_{t}]$ 的单个闭式解析表达式；无需四舍五入。", "solution": "问题陈述经过严格验证，被认为是有效的。它具有科学依据，提法恰当且客观。它为随机微积分和量化金融中的一个标准问题，特别是推导 Vasicek 模型中定义的 Ornstein-Uhlenbeck 过程的期望值，提供了一个完整且一致的设定。所有必要的参数和条件都已给出，没有矛盾或含糊之处。\n\n任务是推导由 Vasicek 模型随机微分方程 (SDE) 控制的短利率过程 $r_t$ 的期望 $E[r_t]$：\n$$\n\\mathrm{d}r_{t}=\\kappa(\\theta-r_{t})\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t}\n$$\n初始条件为 $r_0 \\in \\mathbb{R}$，常数 $\\kappa  0$、$\\theta \\in \\mathbb{R}$ 和 $\\sigma  0$。\n\n首先，我们求解 $r_t$ 的 SDE。该 SDE 可以重写为：\n$$\n\\mathrm{d}r_{t} + \\kappa r_t \\mathrm{d}t = \\kappa\\theta \\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t}\n$$\n这是一个线性 SDE。我们可以使用积分因子法来求解，类似于求解线性常微分方程的方法。设积分因子为 $I_t = \\exp(\\kappa t)$。考虑过程 $Y_t = r_t \\exp(\\kappa t)$。我们使用 Itô 乘积法则来求其微分 $\\mathrm{d}Y_t$。对于一个函数 $f(t, x) = x \\exp(\\kappa t)$，其中 $x$ 是过程 $r_t$，法则是：\n$$\n\\mathrm{d}f(t, r_t) = \\frac{\\partial f}{\\partial t}\\mathrm{d}t + \\frac{\\partial f}{\\partial r_t}\\mathrm{d}r_t + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial r_t^2}(\\mathrm{d}r_t)^2\n$$\n偏导数是：\n$$\n\\frac{\\partial f}{\\partial t} = \\kappa r_t \\exp(\\kappa t)\n$$\n$$\n\\frac{\\partial f}{\\partial r_t} = \\exp(\\kappa t)\n$$\n$$\n\\frac{\\partial^2 f}{\\partial r_t^2} = 0\n$$\n二次变分 $(\\mathrm{d}r_t)^2$ 是从 $r_t$ 的 SDE 计算得出的。只有扩散项有贡献：$(\\mathrm{d}r_t)^2 = (\\sigma \\mathrm{d}W_t)^2 = \\sigma^2 (\\mathrm{d}W_t)^2 = \\sigma^2 \\mathrm{d}t$。然而，由于关于 $r_t$ 的二阶偏导数为零，该项消失。\n将非零偏导数代入 Itô 法则，得到：\n$$\n\\mathrm{d}(r_t \\exp(\\kappa t)) = \\kappa r_t \\exp(\\kappa t) \\mathrm{d}t + \\exp(\\kappa t) \\mathrm{d}r_t\n$$\n现在，我们将原始 SDE 中 $\\mathrm{d}r_t$ 的表达式代入：\n$$\n\\mathrm{d}(r_t \\exp(\\kappa t)) = \\kappa r_t \\exp(\\kappa t) \\mathrm{d}t + \\exp(\\kappa t) \\left( \\kappa(\\theta-r_{t})\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t} \\right)\n$$\n$$\n\\mathrm{d}(r_t \\exp(\\kappa t)) = \\kappa r_t \\exp(\\kappa t) \\mathrm{d}t + \\kappa\\theta\\exp(\\kappa t) \\mathrm{d}t - \\kappa r_t \\exp(\\kappa t) \\mathrm{d}t + \\sigma\\exp(\\kappa t)\\,\\mathrm{d}W_{t}\n$$\n涉及 $r_t$ 的项相互抵消：\n$$\n\\mathrm{d}(r_t \\exp(\\kappa t)) = \\kappa\\theta\\exp(\\kappa t) \\mathrm{d}t + \\sigma\\exp(\\kappa t)\\,\\mathrm{d}W_{t}\n$$\n接下来，我们将此表达式从时间 $s=0$ 积分到 $s=t$：\n$$\n\\int_0^t \\mathrm{d}(r_s \\exp(\\kappa s)) = \\int_0^t \\kappa\\theta\\exp(\\kappa s) \\mathrm{d}s + \\int_0^t \\sigma\\exp(\\kappa s)\\,\\mathrm{d}W_{s}\n$$\n左侧计算结果为 $r_t \\exp(\\kappa t) - r_0 \\exp(\\kappa \\cdot 0)$。\n$$\nr_t \\exp(\\kappa t) - r_0 = \\kappa\\theta \\left[ \\frac{1}{\\kappa}\\exp(\\kappa s) \\right]_0^t + \\sigma \\int_0^t \\exp(\\kappa s)\\,\\mathrm{d}W_{s}\n$$\n$$\nr_t \\exp(\\kappa t) - r_0 = \\theta (\\exp(\\kappa t) - 1) + \\sigma \\int_0^t \\exp(\\kappa s)\\,\\mathrm{d}W_{s}\n$$\n现在，我们通过乘以 $\\exp(-\\kappa t)$ 来求解 $r_t$：\n$$\nr_t = r_0 \\exp(-\\kappa t) + \\theta (1 - \\exp(-\\kappa t)) + \\sigma \\exp(-\\kappa t) \\int_0^t \\exp(\\kappa s)\\,\\mathrm{d}W_{s}\n$$\n随机积分项可以重写为更标准的形式：\n$$\n\\sigma \\exp(-\\kappa t) \\int_0^t \\exp(\\kappa s)\\,\\mathrm{d}W_{s} = \\sigma \\int_0^t \\exp(-\\kappa(t-s))\\,\\mathrm{d}W_{s}\n$$\n因此，$r_t$ 的显式解是：\n$$\nr_t = r_0 \\exp(-\\kappa t) + \\theta (1 - \\exp(-\\kappa t)) + \\sigma \\int_0^t \\exp(-\\kappa(t-s))\\,\\mathrm{d}W_{s}\n$$\n现在，我们取期望 $E[r_t]$。我们将期望算子应用于 $r_t$ 的解，并利用期望的线性性质：\n$$\nE[r_t] = E\\left[ r_0 \\exp(-\\kappa t) + \\theta (1 - \\exp(-\\kappa t)) + \\sigma \\int_0^t \\exp(-\\kappa(t-s))\\,\\mathrm{d}W_{s} \\right]\n$$\n$$\nE[r_t] = E[r_0 \\exp(-\\kappa t)] + E[\\theta (1 - \\exp(-\\kappa t))] + E\\left[\\sigma \\int_0^t \\exp(-\\kappa(t-s))\\,\\mathrm{d}W_{s} \\right]\n$$\n我们对每一项进行求值：\n$1$. 初始条件 $r_0$ 是确定性的（或者，如果是随机的，它也与 $W_t$ 的未来增量无关）。项 $\\exp(-\\kappa t)$ 也是确定性的。因此，$E[r_0 \\exp(-\\kappa t)] = r_0 \\exp(-\\kappa t)$。\n$2$. 参数 $\\theta$ 和 $\\kappa$ 是常数，所以项 $\\theta (1 - \\exp(-\\kappa t))$ 是确定性的。因此，$E[\\theta (1 - \\exp(-\\kappa t))] = \\theta (1 - \\exp(-\\kappa t))$。\n$3$. 第三项是 Itô 积分的期望。对于具有确定性被积函数 $f(s)$（例如 $f(s) = \\exp(-\\kappa(t-s))$）的 Itô 积分，其一个基本性质是期望为零：\n$$\nE\\left[ \\int_0^t f(s)\\,\\mathrm{d}W_{s} \\right] = 0\n$$\n因此，\n$$\nE\\left[\\sigma \\int_0^t \\exp(-\\kappa(t-s))\\,\\mathrm{d}W_{s} \\right] = \\sigma \\cdot 0 = 0\n$$\n结合这些结果，我们得到 $r_t$ 期望的表达式：\n$$\nE[r_t] = r_0 \\exp(-\\kappa t) + \\theta (1 - \\exp(-\\kappa t))\n$$\n这个表达式可以重新整理以便更好地解释：\n$$\nE[r_t] = r_0 \\exp(-\\kappa t) + \\theta - \\theta \\exp(-\\kappa t) = \\theta + (r_0 - \\theta)\\exp(-\\kappa t)\n$$\n这就是 $E[r_t]$ 的最终闭式表达式。\n\n“期望上的均值回归”的解释源于此结果。当时间 $t$ 趋于无穷大（$t \\to \\infty$）时，由于参数 $\\kappa$ 是严格正的（$\\kappa0$），指数项 $\\exp(-\\kappa t)$ 趋于 $0$。\n$$\n\\lim_{t \\to \\infty} E[r_t] = \\lim_{t \\to \\infty} \\left( \\theta + (r_0 - \\theta)\\exp(-\\kappa t) \\right) = \\theta + (r_0 - \\theta) \\cdot 0 = \\theta\n$$\n这表明短利率的期望值 $E[r_t]$ 从其初始值 $r_0$ 指数衰减或增长至长期均值水平 $\\theta$。如果 $r_0  \\theta$，期望利率将随时间推移向 $\\theta$ 下降。如果 $r_0  \\theta$，它将向 $\\theta$ 上升。参数 $\\kappa$ 决定了这种回归的速度。过程的期望未来路径被拉向一个恒定水平的这种趋势，就是期望上的均值回归的含义。", "answer": "$$\\boxed{\\theta + (r_{0} - \\theta)\\exp(-\\kappa t)}$$", "id": "3082515"}, {"introduction": "利率模型的主要目的是为金融工具定价。现在我们已经理解了利率的动态，我们可以将其应用于为一种基础资产——零息债券——估值。这个练习将展示 Vasicek 模型的威力，揭示它如何导出一个“仿射期限结构”，其中债券价格是短期利率的一个优雅的指数仿射函数。你将推导此定价公式的一个关键组成部分，并发现一个关于长期债券利率风险行为的重要经济学见解。[@problem_id:3082492]", "problem": "考虑风险中性测度$\\mathbb{Q}$下的Vasicek短利率模型，其中短利率$r_t$遵循随机微分方程 (SDE)\n$$\n\\mathrm{d}r_t \\;=\\; \\kappa\\big(\\theta - r_t\\big)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_t,\n$$\n其中$\\kappa0$、$\\sigma0$和$\\theta\\in\\mathbb{R}$为常数，$W_t$是标准布朗运动（维纳过程）。一个在时间$T\\ge t$到期的无违约风险零息债券在时间$t$的价格$P(t,T)$由风险中性估值公式给出\n$$\nP(t,T) \\;=\\; \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_t^T r_s\\,\\mathrm{d}s\\right)\\,\\Big|\\,\\mathcal{F}_t\\right].\n$$\n仅使用此设定、Feynman–Kac公式以及无套利原则，推导$P(t,T)$满足的定价偏微分方程(PDE)，并由此证明$P(t,T)$是关于$r_t$的指数仿射形式。令$B(t,T)$表示债券价格表达式的指数部分中，乘以$r_t$并带负号的系数。计算长久期极限$\\lim_{T\\to\\infty} B(t,T)$，以仅含$\\kappa$的闭式解形式给出，并简要解释此极限对于超长久期下利率久期饱和现象的含义。\n\n答案规格：\n- 以仅含$\\kappa$的单个闭式符号表达式形式提供极限的最终答案。\n- 不包含任何单位。\n- 无需四舍五入。", "solution": "起点是风险中性估值公式与费曼-卡茨定理。根据该定理，在风险中性测度 $\\mathbb{Q}$ 下，零息债券价格 $P(t,r) \\equiv P(t,r,T)$ 必须满足以下线性抛物型定价偏微分方程 (PDE)：\n$$\n\\frac{\\partial P}{\\partial t} + \\kappa(\\theta - r)\\frac{\\partial P}{\\partial r} + \\frac{1}{2}\\sigma^2\\frac{\\partial^2 P}{\\partial r^2} - rP = 0\n$$\n该方程的终端条件为 $P(T,r) = 1$。\n\n为了求解此 PDE，我们采用仿射期限结构的拟设，即解的形式为：\n$$\nP(t,T) = \\exp(A(t,T) - B(t,T)r)\n$$\n我们将这个拟设代入 PDE。首先计算 $P$ 对 $t$ 和 $r$ 的偏导数：\n$$\n\\frac{\\partial P}{\\partial t} = \\left(\\frac{\\partial A}{\\partial t} - r\\frac{\\partial B}{\\partial t}\\right)P\n$$\n$$\n\\frac{\\partial P}{\\partial r} = -B \\cdot P\n$$\n$$\n\\frac{\\partial^2 P}{\\partial r^2} = (-B)^2 P = B^2 P\n$$\n将这些导数代入 PDE，并两边同除以 $P$（因为 $P>0$）：\n$$\n\\left(\\frac{\\partial A}{\\partial t} - r\\frac{\\partial B}{\\partial t}\\right) + \\kappa(\\theta - r)(-B) + \\frac{1}{2}\\sigma^2 B^2 - r = 0\n$$\n展开并重新整理各项：\n$$\n\\left(\\frac{\\partial A}{\\partial t} - \\kappa\\theta B + \\frac{1}{2}\\sigma^2 B^2\\right) + r\\left(-\\frac{\\partial B}{\\partial t} + \\kappa B - 1\\right) = 0\n$$\n由于此方程必须对所有利率水平 $r$ 都成立，因此 $r$ 的系数项和常数项必须分别等于零。这给了我们一个常微分方程组 (ODE)：\n1.  $-\\frac{\\partial B}{\\partial t} + \\kappa B - 1 = 0 \\implies \\frac{\\partial B}{\\partial t} = \\kappa B - 1$\n2.  $\\frac{\\partial A}{\\partial t} - \\kappa\\theta B + \\frac{1}{2}\\sigma^2 B^2 = 0 \\implies \\frac{\\partial A}{\\partial t} = \\kappa\\theta B - \\frac{1}{2}\\sigma^2 B^2$\n\n我们关注 $B(t,T)$。其 ODE 为 $\\frac{\\partial B}{\\partial t} = \\kappa B - 1$，终端条件为 $P(T,T) = 1 \\implies A(T,T)=0, B(T,T)=0$。这是一个一阶线性 ODE。它的解是：\n$$\nB(t,T) = \\frac{1}{\\kappa}(1 - e^{-\\kappa(T-t)})\n$$\n现在我们计算长久期极限，即当到期日 $T \\to \\infty$ 时 $B(t,T)$ 的值。由于 $\\kappa > 0$，当 $T \\to \\infty$ 时，期限 $(T-t) \\to \\infty$，因此指数项 $e^{-\\kappa(T-t)}$ 趋于 $0$。\n$$\n\\lim_{T\\to\\infty} B(t,T) = \\lim_{T\\to\\infty} \\frac{1}{\\kappa}(1 - e^{-\\kappa(T-t)}) = \\frac{1}{\\kappa}(1 - 0) = \\frac{1}{\\kappa}\n$$\n这个极限的经济学含义是关于利率久期的饱和现象。久期衡量债券价格对利率变化的敏感度。对于短期和中期债券，久期大致随期限增加而增加。然而，在均值回归的 Vasicek 模型中，长期债券的久期并不会无限增长。它会收敛到一个上限 $1/\\kappa$。这意味着，无论债券的期限有多长，其价格对当前利率变化的敏感度都被限制了。这是因为均值回归机制减弱了当前利率水平对遥远未来现金流贴现值的影响。如果当前利率很高，模型预期它会下降，反之亦然，从而稳定了长期债券的价格。", "answer": "$$\\boxed{\\frac{1}{\\kappa}}$$", "id": "3082492"}, {"introduction": "解析公式固然强大，但在金融世界中，它们通过计算才得以应用。最后的这个练习将理论推导与实际应用联系起来，为你搭建一座从债券定价函数的解析形式到其数值实现的桥梁。通过实现像四阶龙格－库塔法这样的数值求解器，你不仅能验证我们之前讨论过的解析解，还能培养宝贵的计算金融技能。[@problem_id:3082370]", "problem": "考虑风险中性测度下的 Vasicek 短期利率模型，其由以下随机微分方程 (SDE) 给出：\n$$\ndr_t = \\kappa(\\theta - r_t)\\,dt + \\sigma\\,dW_t,\n$$\n其中 $\\kappa \\ge 0$、$\\theta$ 和 $\\sigma$ 是常数，$W_t$ 是一个标准维纳过程。在此模型中，一个在时间 $t$、到期日为 $T$ 的零息债券的价格具有以下仿射形式\n$$\nP(t,T) = A(t,T)\\,\\exp\\!\\big(-B(t,T)\\,r_t\\big),\n$$\n其中 $A(t,T)$ 和 $B(t,T)$ 仅依赖于 $t$ 和 $T$。定义距离到期时间为 $\\tau := T - t$。当将该仿射拟设代入债券定价偏微分方程 (PDE) 并比较系数时，函数 $B(t,T)$ 被刻画为关于 $\\tau$ 的一个线性初值问题的解：\n$$\n\\frac{dB}{d\\tau}(\\tau) = 1 - \\kappa\\,B(\\tau), \\quad B(0) = 0.\n$$\n\n任务：\n- 编写一个程序，对于给定的参数对 $(\\kappa,\\tau)$，使用四阶 Runge–Kutta 方法求解上述常微分方程 (ODE)，从而数值近似 $B(\\tau)$。\n- 对每个测试用例，同时计算该 ODE 的精确解析解，并报告数值解与精确值之间的绝对误差。您必须通过求精确解的适当极限来正确处理 $\\kappa = 0$ 的情况。\n- 您的实现必须是确定性的，并使用双精度浮点运算。\n\n测试集：\n使用以下参数值（每对为 $(\\kappa,\\tau)$，其中 $\\tau = T - t$）：\n- $(0.3,\\,2.0)$\n- $(0.0,\\,1.0)$\n- $(10.0,\\,3.0)$\n- $(1.2,\\,1.0)$\n- $(10^{-6},\\,5.0)$\n- $(0.7,\\,0.0)$\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含测试集的绝对误差，顺序与所列顺序相同，形式为逗号分隔的列表，并用方括号括起来，例如 $[e_1,e_2,\\dots,e_6]$，其中每个 $e_i$ 是一个浮点数。", "solution": "我们从风险中性的 Vasicek 模型开始，其中短期利率 $r_t$ 服从随机微分方程 (SDE)\n$$\ndr_t = \\kappa(\\theta - r_t)\\,dt + \\sigma\\,dW_t.\n$$\n在时间 $t$，到期日为 $T$ 的零息债券的价格为 $P(t,T) = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_t^T r_s\\,ds\\right)\\middle|\\,\\mathcal{F}_t\\right]$，在 Vasicek 模型下，可以假设一个仿射形式 $P(t,T) = A(t,T)\\exp\\!\\left(-B(t,T) r_t\\right)$。将此拟设代入债券定价偏微分方程 (PDE) 并令 $r_t$ 的系数相等，当用距离到期时间 $\\tau := T - t$ 表示时，可以得到关于 $B(t,T)$ 的常微分方程 (ODE)：\n$$\n\\frac{dB}{d\\tau}(\\tau) = 1 - \\kappa\\,B(\\tau), \\quad B(0) = 0.\n$$\n这是一个一阶线性常微分方程。其通解可以通过积分因子法获得。定义积分因子 $I(\\tau) = e^{\\kappa \\tau}$。两边同乘以 $I(\\tau)$ 可得\n$$\ne^{\\kappa \\tau}\\frac{dB}{d\\tau}(\\tau) + \\kappa e^{\\kappa \\tau} B(\\tau) = e^{\\kappa \\tau}.\n$$\n方程左边是 $e^{\\kappa \\tau} B(\\tau)$ 的导数：\n$$\n\\frac{d}{d\\tau}\\left(e^{\\kappa \\tau} B(\\tau)\\right) = e^{\\kappa \\tau}.\n$$\n从 $0$ 到 $\\tau$ 积分，并利用 $B(0)=0$ 可得\n$$\ne^{\\kappa \\tau} B(\\tau) - e^{\\kappa \\cdot 0} B(0) = \\int_0^\\tau e^{\\kappa s}\\,ds = \\frac{e^{\\kappa \\tau} - 1}{\\kappa} \\quad \\text{for } \\kappa \\ne 0.\n$$\n因此，对于 $\\kappa \\ne 0$，\n$$\nB(\\tau) = \\frac{1 - e^{-\\kappa \\tau}}{\\kappa}.\n$$\n对于边界情况 $\\kappa = 0$，该 ODE 简化为 $\\frac{dB}{d\\tau}(\\tau) = 1$ 且 $B(0)=0$，可得\n$$\nB(\\tau) = \\tau.\n$$\n\n为了验证数值方法，我们使用四阶 Runge–Kutta 方法（也称为四阶 Runge–Kutta）计算数值近似解 $B_{\\text{num}}(\\tau)$。对于 ODE\n$$\n\\frac{dB}{d\\tau} = f(B) = 1 - \\kappa B,\n$$\n初始条件为 $B(0)=0$，选择步长 $h$ 和步数 $N = \\lceil \\tau / h \\rceil$（如果 $\\tau=0$ 则 $N=0$）。从 $B_n$ 到 $B_{n+1}$ 的 Runge–Kutta 单步更新公式为\n$$\n\\begin{aligned}\nk_1 = f(B_n), \\\\\nk_2 = f\\!\\left(B_n + \\frac{h}{2} k_1\\right), \\\\\nk_3 = f\\!\\left(B_n + \\frac{h}{2} k_2\\right), \\\\\nk_4 = f\\!\\left(B_n + h\\,k_3\\right), \\\\\nB_{n+1} = B_n + \\frac{h}{6}\\left(k_1 + 2k_2 + 2k_3 + k_4\\right).\n\\end{aligned}\n$$\n初始化 $B_0 = 0$，如果 $\\tau  0$，则以步长 $h = \\tau / N$ 迭代 $N$ 步，否则直接返回 $B(0)=0$。该方法的局部截断误差为 $O(h^5)$ 阶，全局误差为 $O(h^4)$ 阶，因此选择足够小的 $h$ 可以得到高精度的近似值。\n\n为了在计算精确解时保证数值稳定性，特别是当 $\\kappa \\tau$ 很小以至于 $1 - e^{-\\kappa \\tau}$ 遭受相消误差时，按如下方式计算精确值\n$$\nB_{\\text{exact}}(\\kappa,\\tau) =\n\\begin{cases}\n\\tau,  \\text{if } |\\kappa| \\text{ is numerically zero},\\\\\n\\dfrac{1 - e^{-\\kappa \\tau}}{\\kappa},  \\text{otherwise},\n\\end{cases}\n$$\n并通过函数 $\\operatorname{expm1}$ 来实现分子部分，以精确计算 $e^{x} - 1$：\n$$\n\\frac{1 - e^{-\\kappa \\tau}}{\\kappa} = \\frac{-\\operatorname{expm1}(-\\kappa \\tau)}{\\kappa}.\n$$\n\n对于每个测试用例 $(\\kappa,\\tau)$，计算绝对误差\n$$\ne = \\left| B_{\\text{num}}(\\tau) - B_{\\text{exact}}(\\kappa,\\tau) \\right|,\n$$\n并按顺序输出六个指定测试用例的列表 $[e_1,e_2,\\dots]$。使用足够小的步长（例如，$h = 10^{-4}$ 以使 $N \\approx \\tau / 10^{-4}$），对于这个线性 ODE，绝对误差将非常小，通常接近机器精度，包括边界情况 $\\kappa = 0$ 和 $\\tau = 0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef rk4_vasicek_B(kappa: float, tau: float, h_max: float = 1e-4) - float:\n    \"\"\"\n    Numerically solve dB/dtau = 1 - kappa * B, B(0) = 0, up to tau using RK4.\n    Uses step size h = min(h_max, tau) with N = ceil(tau / h). Handles tau=0.\n    \"\"\"\n    if tau == 0.0:\n        return 0.0\n    # Determine number of steps to keep h = h_max, at least 1 step if tau > 0\n    N = max(1, int(np.ceil(tau / h_max)))\n    h = tau / N\n    B = 0.0\n\n    def f(Bval: float) - float:\n        return 1.0 - kappa * Bval\n\n    for _ in range(N):\n        k1 = f(B)\n        k2 = f(B + 0.5 * h * k1)\n        k3 = f(B + 0.5 * h * k2)\n        k4 = f(B + h * k3)\n        B += (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n    return B\n\ndef exact_B(kappa: float, tau: float) - float:\n    \"\"\"\n    Exact solution for B given kappa and tau, with a stable evaluation.\n    \"\"\"\n    if tau == 0.0:\n        return 0.0\n    if abs(kappa)  1e-14:\n        # Limit kappa -> 0 gives B = tau\n        return float(tau)\n    # Use expm1 for numerical stability\n    return float(-np.expm1(-kappa * tau) / kappa)\n\ndef solve():\n    # Define the test cases from the problem statement: (kappa, tau)\n    test_cases = [\n        (0.3, 2.0),\n        (0.0, 1.0),\n        (10.0, 3.0),\n        (1.2, 1.0),\n        (1e-6, 5.0),\n        (0.7, 0.0),\n    ]\n\n    results = []\n    for kappa, tau in test_cases:\n        B_num = rk4_vasicek_B(kappa, tau, h_max=1e-4)\n        B_ex = exact_B(kappa, tau)\n        err = abs(B_num - B_ex)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3082370"}]}