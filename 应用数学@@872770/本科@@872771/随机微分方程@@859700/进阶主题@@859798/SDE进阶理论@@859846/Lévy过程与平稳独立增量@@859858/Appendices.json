{"hands_on_practices": [{"introduction": "本次练习将理论与应用相结合，要求您模拟一个复合泊松过程。通过亲手实现仿真，您将巩固对该过程基本结构的理解——即跳跃次数和跳跃时间都是随机的——并能将经验结果与其统计矩的理论公式进行直接比较。这项练习是培养直觉以及在金融建模或风险理论等领域应用Lévy过程的基础。[@problem_id:3063719]", "problem": "复合泊松过程是具有平稳独立增量的纯跳跃 Lévy 过程的一个典型例子。设 $t \\geq 0$ 并固定一个速率参数 $\\lambda > 0$。考虑一个速率为 $\\lambda$ 的泊松过程 $\\{N_s : s \\geq 0\\}$ 和一个独立的同分布跳跃大小序列 $\\{Y_i\\}_{i \\geq 1}$，其共同分布为 $F$ 且具有有限二阶矩。定义复合泊松过程 $\\{X_s : s \\geq 0\\}$ 为\n$$\nX_s = \\sum_{i=1}^{N_s} Y_i, \\quad s \\geq 0,\n$$\n约定当 $N_s = 0$ 时，$X_s = 0$。过程 $\\{X_s\\}$ 具有平稳独立增量，是一个 Lévy 过程。随机变量 $Z$ 的特征函数 (CF) 定义为 $\\varphi_Z(u) = \\mathbb{E}[e^{i u Z}]$，其中 $i = \\sqrt{-1}$。\n\n仅从泊松过程和独立性的定义出发，推导如何在区间 $[0,t]$ 上通过先抽样跳跃次数再抽样跳跃大小来模拟过程 $X_s$。推导证明该模拟方法所需的分布性质，并用 $\\lambda$、$t$ 和 $Y_1$ 的分布计算期望 $\\mathbb{E}[X_t]$、方差 $\\mathrm{Var}(X_t)$ 以及特征函数 $\\varphi_{X_t}(u)$。\n\n然后，实现一个程序，该程序：\n- 对每个指定的测试用例，通过以下步骤模拟 $X_t$ 的一次实现：\n  1. 从 $\\mathrm{Poisson}(\\lambda t)$ 分布中抽样 $N_t$。\n  2. 从指定的分布 $F$ 中抽样 $N_t$ 个独立同分布的跳跃大小。\n  3. 计算 $X_t = \\sum_{i=1}^{N_t} Y_i$。\n- 对每个测试用例，仅使用您的推导，计算在给定实数参数 $u$ 下的理论推导量 $\\mathbb{E}[X_t]$、$\\mathrm{Var}(X_t)$ 和特征函数 $\\varphi_{X_t}(u)$。\n- 每个测试用例使用固定的随机种子以确保确定性输出。\n\n您的程序必须使用以下参数值测试套件，这些参数共同测试了典型和边界情景：\n1. $t = 5.0$，$\\lambda = 1.2$，$F$ 是均值为 $\\mu = 0.5$、标准差为 $\\sigma = 0.3$ 的正态分布，特征函数参数 $u = 1.0$。种子 $= 42$。\n2. $t = 5.0$，$\\lambda = 0.0$，$F$ 是均值为 $\\mu = 0.5$、标准差为 $\\sigma = 0.3$ 的正态分布，特征函数参数 $u = 1.0$。种子 $= 123$。\n3. $t = 0.0$，$\\lambda = 3.0$，$F$ 是速率为 $\\beta = 2.0$（即均值为 $1/\\beta$）的指数分布，特征函数参数 $u = 0.5$。种子 $= 7$。\n4. $t = 1.0$，$\\lambda = 5.0$，$F$ 是对称伯努利分布，取值为 $\\pm 1$，概率各为 $1/2$，特征函数参数 $u = 2.0$。种子 $= 99$。\n\n对每个测试用例，您的程序必须按以下顺序输出一个列表：\n$$\n\\left[ N_t, \\; X_t, \\; \\mathbb{E}[X_t], \\; \\mathrm{Var}(X_t), \\; \\operatorname{Re}\\left(\\varphi_{X_t}(u)\\right), \\; \\operatorname{Im}\\left(\\varphi_{X_t}(u)\\right) \\right],\n$$\n其中 $N_t$ 是一个整数，其他量是实数。您的程序应生成单行输出，其中包含所有测试用例的结果，形式为这些列表的逗号分隔列表，并用方括号括起来，例如：\n$$\n\\big[ [\\cdots], [\\cdots], [\\cdots], [\\cdots] \\big].\n$$\n不涉及物理单位；特征函数的角度以弧度为单位。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于随机过程理论，特别是 Lévy 过程，并且问题定义明确，为理论推导和计算实现提供了所有必要信息。\n\n解决方案分为两部分。首先，我们提供所要求的关于复合泊松过程的模拟方法、期望、方差和特征函数的理论推导。其次，我们将这些推导应用于测试用例中给出的具体跳跃分布。每个数学实体都按要求使用 LaTeX 渲染。\n\n### 1. 模拟方法的合理性证明\n复合泊松过程 $\\{X_s : s \\geq 0\\}$ 由以下随机和定义：\n$$\nX_s = \\sum_{i=1}^{N_s} Y_i\n$$\n其中 $\\{N_s : s \\geq 0\\}$ 是一个速率为 $\\lambda$ 的泊松过程，$\\{Y_i\\}_{i \\geq 1}$ 是一系列独立同分布 (i.i.d.) 的随机变量，它们也独立于过程 $\\{N_s\\}$。按照约定，如果跳跃次数 $N_s$ 为零，则该和为空，且 $X_s = 0$。\n\n为了在固定时间 $t > 0$ 模拟该过程的一次实现，我们需要先抽样跳跃次数，然后抽样跳跃大小。这个过程是该过程定义的直接实现，并依赖于条件概率的性质。$(N_t, X_t)$ 的联合分布可以分解为 $P(N_t=n, X_t \\leq x) = P(X_t \\leq x | N_t=n) P(N_t=n)$。模拟算法遵循这种分解：\n\n1.  **抽样跳跃次数：** 随机变量 $N_t$ 计算泊松过程在区间 $[0, t]$ 内的事件数量。已知其分布为参数为 $\\lambda t$ 的泊松分布。我们从该分布中抽取一个整数样本，记为 $n$：$n \\sim \\mathrm{Poisson}(\\lambda t)$。\n\n2.  **抽样跳跃大小：** 在 $N_t = n$ 的条件下，过程的值为 $X_t = \\sum_{i=1}^{n} Y_i$。由于跳跃大小 $\\{Y_i\\}$ 是独立同分布的，并且独立于 $N_t$，所以这个条件和就是从它们的共同分布 $F$ 中抽取的 $n$ 个独立同分布随机变量的和。因此，我们从分布 $F$ 中生成 $n$ 个独立样本 $y_1, y_2, \\dots, y_n$。\n\n3.  **计算和：** $X_t$ 的一次实现是这些跳跃大小的和，$x_t = \\sum_{i=1}^{n} y_i$。如果 $n=0$，则该和为空，按照约定 $x_t=0$。\n\n这个模拟过程正确地从 $X_t$ 的分布中生成了一个样本。\n\n### 2. 分布性质的推导\n设 $\\mu_Y = \\mathbb{E}[Y_1]$ 和 $\\sigma_Y^2 = \\mathrm{Var}(Y_1)$ 分别为跳跃大小分布的均值和方差。我们已知二阶矩 $\\mathbb{E}[Y_1^2] = \\sigma_Y^2 + \\mu_Y^2$ 是有限的。对于泊松过程计数器 $N_t$，我们知道 $\\mathbb{E}[N_t] = \\mathrm{Var}(N_t) = \\lambda t$。\n\n#### 期望 $\\mathbb{E}[X_t]$\n我们使用全期望定律（也称为塔性质）：$\\mathbb{E}[Z] = \\mathbb{E}[\\mathbb{E}[Z|W]]$。令 $Z=X_t$ 和 $W=N_t$。\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}\\left[\\mathbb{E}\\left[X_t | N_t\\right]\\right]\n$$\n首先，我们计算内部的期望，以 $N_t = n$ 为条件：\n$$\n\\mathbb{E}[X_t | N_t = n] = \\mathbb{E}\\left[ \\sum_{i=1}^{n} Y_i \\right] = \\sum_{i=1}^{n} \\mathbb{E}[Y_i] = n \\mathbb{E}[Y_1] = n \\mu_Y\n$$\n这对任何特定值 $n$ 都成立。因此，作为一个随机变量，条件期望是 $\\mathbb{E}[X_t | N_t] = N_t \\mu_Y$。\n现在，我们计算外部的期望：\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}[N_t \\mu_Y] = \\mu_Y \\mathbb{E}[N_t] = \\mu_Y (\\lambda t)\n$$\n所以，期望是 $\\mathbb{E}[X_t] = \\lambda t \\mu_Y$。\n\n#### 方差 $\\mathrm{Var}(X_t)$\n我们使用全方差定律：$\\mathrm{Var}(Z) = \\mathbb{E}[\\mathrm{Var}(Z|W)] + \\mathrm{Var}(\\mathbb{E}[Z|W])$。\n$$\n\\mathrm{Var}(X_t) = \\mathbb{E}[\\mathrm{Var}(X_t | N_t)] + \\mathrm{Var}(\\mathbb{E}[X_t | N_t])\n$$\n我们分别计算每一项。\n1.  **第一项：$\\mathbb{E}[\\mathrm{Var}(X_t | N_t)]$**\n    给定 $N_t=n$ 的条件方差是：\n    $$\n    \\mathrm{Var}(X_t | N_t = n) = \\mathrm{Var}\\left(\\sum_{i=1}^{n} Y_i\\right) = \\sum_{i=1}^{n} \\mathrm{Var}(Y_i) = n \\mathrm{Var}(Y_1) = n \\sigma_Y^2\n    $$\n    这里利用了 $Y_i$ 的独立性。因此，$\\mathrm{Var}(X_t | N_t) = N_t \\sigma_Y^2$。对其取期望：\n    $$\n    \\mathbb{E}[\\mathrm{Var}(X_t | N_t)] = \\mathbb{E}[N_t \\sigma_Y^2] = \\sigma_Y^2 \\mathbb{E}[N_t] = \\sigma_Y^2 (\\lambda t)\n    $$\n2.  **第二项：$\\mathrm{Var}(\\mathbb{E}[X_t | N_t])$**\n    从期望的计算中，我们知道 $\\mathbb{E}[X_t | N_t] = N_t \\mu_Y$。我们计算其方差：\n    $$\n    \\mathrm{Var}(\\mathbb{E}[X_t | N_t]) = \\mathrm{Var}(N_t \\mu_Y) = \\mu_Y^2 \\mathrm{Var}(N_t) = \\mu_Y^2 (\\lambda t)\n    $$\n结合这两项：\n$$\n\\mathrm{Var}(X_t) = \\lambda t \\sigma_Y^2 + \\lambda t \\mu_Y^2 = \\lambda t (\\sigma_Y^2 + \\mu_Y^2)\n$$\n由于 $\\mathbb{E}[Y_1^2] = \\mathrm{Var}(Y_1) + (\\mathbb{E}[Y_1])^2 = \\sigma_Y^2 + \\mu_Y^2$，方差可以表示为：\n$$\n\\mathrm{Var}(X_t) = \\lambda t \\mathbb{E}[Y_1^2]\n$$\n\n#### 特征函数 $\\varphi_{X_t}(u)$\n设 $\\varphi_Y(u) = \\mathbb{E}[e^{iuY_1}]$ 是跳跃大小分布的特征函数 (CF)。我们再次使用全期望定律。\n$$\n\\varphi_{X_t}(u) = \\mathbb{E}[e^{iuX_t}] = \\mathbb{E}\\left[\\mathbb{E}[e^{iuX_t} | N_t]\\right]\n$$\n内部的条件期望，给定 $N_t=n$：\n$$\n\\mathbb{E}[e^{iuX_t} | N_t=n] = \\mathbb{E}\\left[e^{iu\\sum_{j=1}^{n} Y_j}\\right] = \\mathbb{E}\\left[\\prod_{j=1}^{n} e^{iuY_j}\\right]\n$$\n由于 $Y_j$ 的独立性，这变为：\n$$\n\\prod_{j=1}^{n} \\mathbb{E}[e^{iuY_j}] = \\prod_{j=1}^{n} \\varphi_Y(u) = (\\varphi_Y(u))^n\n$$\n因此，作为一个随机变量，$\\mathbb{E}[e^{iuX_t} | N_t] = (\\varphi_Y(u))^{N_t}$。现在我们取外部期望：\n$$\n\\varphi_{X_t}(u) = \\mathbb{E}\\left[(\\varphi_Y(u))^{N_t}\\right]\n$$\n这个表达式是 $N_t$ 的概率生成函数 (PGF) $G_{N_t}(z) = \\mathbb{E}[z^{N_t}]$ 在 $z = \\varphi_Y(u)$ 处的值。对于泊松随机变量 $K \\sim \\mathrm{Poisson}(\\Lambda)$，其 PGF 为 $G_K(z) = e^{\\Lambda(z-1)}$。对于 $N_t \\sim \\mathrm{Poisson}(\\lambda t)$，我们有 $\\Lambda = \\lambda t$。代入 $z = \\varphi_Y(u)$，我们得到复合泊松过程的特征函数：\n$$\n\\varphi_{X_t}(u) = \\exp\\left(\\lambda t \\left(\\varphi_Y(u) - 1\\right)\\right)\n$$\n这是复合泊松过程的 Lévy–Khintchine 公式。\n\n### 3. 针对特定测试用例的性质\n我们现在陈述问题中指定的跳跃分布所需的性质。\n\n1.  **正态分布：** $Y \\sim N(\\mu, \\sigma^2)$\n    -   均值：$\\mu_Y = \\mu$\n    -   二阶矩：$\\mathbb{E}[Y^2] = \\sigma^2 + \\mu^2$\n    -   特征函数：$\\varphi_Y(u) = \\exp(i u \\mu - \\frac{1}{2}\\sigma^2 u^2)$\n\n2.  **指数分布：** $Y \\sim \\mathrm{Exponential}(\\beta)$（概率密度函数为 $f(y) = \\beta e^{-\\beta y}$，其中 $y \\ge 0$）\n    -   均值：$\\mu_Y = 1/\\beta$\n    -   方差：$\\sigma_Y^2 = 1/\\beta^2$\n    -   二阶矩：$\\mathbb{E}[Y^2] = \\sigma_Y^2 + \\mu_Y^2 = 2/\\beta^2$\n    -   特征函数：$\\varphi_Y(u) = \\mathbb{E}[e^{iuY}] = \\int_0^\\infty e^{iuy}\\beta e^{-\\beta y} dy = \\beta/(\\beta - iu) = 1/(1 - iu/\\beta)$\n\n3.  **对称伯努利分布：** $P(Y=1) = P(Y=-1) = 1/2$\n    -   均值：$\\mu_Y = (1)(1/2) + (-1)(1/2) = 0$\n    -   二阶矩：$\\mathbb{E}[Y^2] = (1)^2(1/2) + (-1)^2(1/2) = 1$\n    -   特征函数：$\\varphi_Y(u) = e^{iu(1)}(1/2) + e^{iu(-1)}(1/2) = \\frac{e^{iu}+e^{-iu}}{2} = \\cos(u)$\n\n对于 $t=0$ 或 $\\lambda=0$ 的情况，乘积 $\\lambda t = 0$。在这些情景中，$N_t$ 确定为 $0$，这意味着 $X_t=0$。理论公式正确地退化为：\n- $\\mathbb{E}[X_t] = 0 \\cdot \\mu_Y = 0$\n- $\\mathrm{Var}(X_t) = 0 \\cdot \\mathbb{E}[Y_1^2] = 0$\n- $\\varphi_{X_t}(u) = \\exp(0 \\cdot (\\varphi_Y(u)-1)) = e^0 = 1$。常数 $0$ 的特征函数确实是 $\\mathbb{E}[e^{iu \\cdot 0}] = 1$。\n\n现在将根据这些推导出的公式进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not used but is an allowed library.\n\ndef solve():\n    \"\"\"\n    Simulates a compound Poisson process and calculates its theoretical properties\n    for a given set of test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"t\": 5.0, \"lam\": 1.2, \"u\": 1.0, \"seed\": 42,\n            \"dist\": \"normal\", \"params\": {\"mu\": 0.5, \"sigma\": 0.3}\n        },\n        {\n            \"t\": 5.0, \"lam\": 0.0, \"u\": 1.0, \"seed\": 123,\n            \"dist\": \"normal\", \"params\": {\"mu\": 0.5, \"sigma\": 0.3}\n        },\n        {\n            \"t\": 0.0, \"lam\": 3.0, \"u\": 0.5, \"seed\": 7,\n            \"dist\": \"exponential\", \"params\": {\"beta\": 2.0}\n        },\n        {\n            \"t\": 1.0, \"lam\": 5.0, \"u\": 2.0, \"seed\": 99,\n            \"dist\": \"bernoulli\", \"params\": {}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        t, lam, u, seed = case[\"t\"], case[\"lam\"], case[\"u\"], case[\"seed\"]\n        dist, params = case[\"dist\"], case[\"params\"]\n\n        rng = np.random.default_rng(seed)\n\n        # Theoretical properties of the jump distribution Y\n        mu_y, e_y2, phi_y = 0.0, 0.0, 0.0 + 0.0j\n\n        if dist == \"normal\":\n            mu, sigma = params[\"mu\"], params[\"sigma\"]\n            mu_y = mu\n            e_y2 = sigma**2 + mu**2\n            phi_y = np.exp(1j * u * mu - 0.5 * sigma**2 * u**2)\n        elif dist == \"exponential\":\n            beta = params[\"beta\"]\n            mu_y = 1.0 / beta\n            e_y2 = 2.0 / beta**2\n            phi_y = 1.0 / (1.0 - 1j * u / beta)\n        elif dist == \"bernoulli\":\n            mu_y = 0.0\n            e_y2 = 1.0\n            phi_y = np.cos(u)\n\n        # 1. Simulation\n        # Sample N_t from Poisson(lambda*t)\n        lambda_t = lam * t\n        n_t = rng.poisson(lambda_t)\n\n        # Sample N_t jumps and compute X_t\n        x_t = 0.0\n        if n_t  0:\n            if dist == \"normal\":\n                jumps = rng.normal(params[\"mu\"], params[\"sigma\"], size=n_t)\n            elif dist == \"exponential\":\n                jumps = rng.exponential(scale=1.0/params[\"beta\"], size=n_t)\n            elif dist == \"bernoulli\":\n                jumps = rng.choice([-1, 1], size=n_t)\n            x_t = np.sum(jumps)\n        # If n_t is 0, x_t remains 0.0, which is correct.\n\n        # 2. Theoretical Calculations\n        # Expectation E[X_t] = lambda*t*E[Y]\n        e_xt = lambda_t * mu_y\n\n        # Variance Var(X_t) = lambda*t*E[Y^2]\n        var_xt = lambda_t * e_y2\n\n        # Characteristic function phi_Xt(u) = exp(lambda*t*(phi_Y(u) - 1))\n        phi_xt = np.exp(lambda_t * (phi_y - 1))\n\n        # Store results for this case\n        all_results.append([\n            n_t,\n            x_t,\n            e_xt,\n            var_xt,\n            phi_xt.real,\n            phi_xt.imag\n        ])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(all_results)\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3063719"}, {"introduction": "在理解了如何构建复合泊松过程之后，我们现在转向分析其样本路径。本练习将引导您计算两个关键的路径属性：总变差（total variation）和二次变差（quadratic variation）。这些概念对于区分不同类型的随机过程（例如，连续过程与跳跃过程）至关重要，并且是随机积分理论中的基本工具。[@problem_id:3063766]", "problem": "考虑一个复合泊松过程 $\\{X_t\\}_{t \\ge 0}$，定义为 $X_t = \\sum_{k=1}^{N_t} J_k$，其中 $\\{N_t\\}_{t \\ge 0}$ 是一个速率为 $\\lambda > 0$ 的泊松过程，而 $\\{J_k\\}_{k \\ge 1}$ 是独立同分布的跳跃大小，满足 $\\mathbb{E}[|J_1|]  \\infty$，且独立于 $\\{N_t\\}_{t \\ge 0}$。$X$ 的样本路径是右连续且有左极限的，并且只有跳跃间断点。对于一个固定的时间范围 $t > 0$，回顾在 $[0,t]$ 上的路径全变差，\n$$\nV_t(X) \\equiv \\sup_{\\pi} \\sum_{i=1}^{n} \\left| X_{t_i} - X_{t_{i-1}} \\right|, \\quad \\pi = \\{0 = t_0  t_1  \\cdots  t_n = t\\},\n$$\n以及在 $[0,t]$ 上的二次变差，\n$$\n[X]_t \\equiv \\lim_{\\|\\pi\\| \\to 0} \\sum_{i=1}^{n} \\left( X_{t_i} - X_{t_{i-1}} \\right)^2, \\quad \\|\\pi\\| \\equiv \\max_{1 \\le i \\le n} (t_i - t_{i-1}).\n$$\n从这些定义和复合泊松过程的结构性质（特别是，在任何有限区间上几乎必然只有有限次跳跃，且过程在跳跃之间是分段常数）出发，推导在 $[0,t]$ 上 $V_t(X)$ 和 $[X]_t$ 关于 $N_t$ 和跳跃大小 $\\{J_k\\}_{k=1}^{N_t}$ 的显式表达式。使用 $\\mathrm{pmatrix}$ 环境将你的最终答案表示为单个行向量，其中第一个元素等于 $V_t(X)$，第二个元素等于 $[X]_t$。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 一个复合泊松过程 $\\{X_t\\}_{t \\ge 0}$ 定义为 $X_t = \\sum_{k=1}^{N_t} J_k$。\n- $\\{N_t\\}_{t \\ge 0}$ 是一个速率为 $\\lambda > 0$ 的泊松过程。\n- $\\{J_k\\}_{k \\ge 1}$ 是独立同分布 (i.i.d.) 的跳跃大小，满足 $\\mathbb{E}[|J_1|]  \\infty$。\n- 序列 $\\{J_k\\}_{k \\ge 1}$ 独立于过程 $\\{N_t\\}_{t \\ge 0}$。\n- $X$ 的样本路径是右连续且有左极限的 (càdlàg)。\n- 在 $[0,t]$ 上的路径全变差定义为 $V_t(X) \\equiv \\sup_{\\pi} \\sum_{i=1}^{n} | X_{t_i} - X_{t_{i-1}} |$，其中上确界取遍区间 $[0,t]$ 的所有分割 $\\pi = \\{0 = t_0  t_1  \\cdots  t_n = t\\}$。\n- 在 $[0,t]$ 上的二次变差定义为 $[X]_t \\equiv \\lim_{\\|\\pi\\| \\to 0} \\sum_{i=1}^{n} ( X_{t_i} - X_{t_{i-1}} )^2$，其中 $\\|\\pi\\| \\equiv \\max_{1 \\le i \\le n} (t_i - t_{i-1})$ 且极限为依概率收敛。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定的验证标准对问题进行评估。\n- **科学依据**：该问题在随机过程的标准数学框架内提出。复合泊松过程、全变差和二次变差都是该领域中成熟的基本概念。\n- **适定性**：该问题提供了推导所求量所需的所有定义和性质。目标明确：用底层的跳跃过程结构（$N_t$ 和 $J_k$）表示 $V_t(X)$ 和 $[X]_t$。预期有唯一解。\n- **客观性**：该问题使用精确、形式化的数学语言陈述，没有任何主观性或模糊性。\n\n该问题没有任何缺陷。这是随机微积分中关于一类基本Lévy过程的路径性质的标准、形式化练习。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 推导\n设 $\\{X_t\\}_{t \\ge 0}$ 是如上定义的复合泊松过程。该过程的一个关键特征是其样本路径为阶梯函数。对于任何有限时间区间 $[0, t]$，泊松过程 $\\{N_s\\}_{s \\in [0,t]}$ 几乎必然有有限次跳跃，记为 $N_t$ 次。设这些跳跃时间为 $0  \\tau_1  \\tau_2  \\cdots  \\tau_{N_t} \\le t$。过程 $X_t$ 在这些跳跃时间之间是恒定的。过程的值由下式给出\n$$\nX_s = \\sum_{k=1}^{N_s} J_k.\n$$\n在每个跳跃时间 $\\tau_k$，过程有一个间断点。在 $\\tau_k$ 处的跳跃大小由随机变量 $J_k$ 给出。具体来说，在 $\\tau_k$ 处过程值的变化为\n$$\n\\Delta X_{\\tau_k} \\equiv X_{\\tau_k} - X_{\\tau_k^-} = \\left(\\sum_{i=1}^k J_i\\right) - \\left(\\sum_{i=1}^{k-1} J_i\\right) = J_k,\n$$\n其中 $X_{\\tau_k^-} = \\lim_{s \\uparrow \\tau_k} X_s$。对于 $[0,t]$ 中任何非跳跃时间的时刻 $s$，有 $\\Delta X_s = 0$。\n\n**1. 全变差 $V_t(X)$ 的计算**\n\n$X$ 在 $[0,t]$ 上的全变差由 $V_t(X) = \\sup_{\\pi} \\sum_{i=1}^{n} | X_{t_i} - X_{t_{i-1}} |$ 给出。设 $\\pi = \\{0 = t_0  t_1  \\cdots  t_n = t\\}$ 是 $[0,t]$ 的一个任意分割。仅当区间 $(t_{i-1}, t_i]$ 包含至少一个跳跃时间 $\\tau_k$ 时，项 $|X_{t_i} - X_{t_{i-1}}|$ 才非零。变化量 $X_{t_i} - X_{t_{i-1}}$ 是在 $(t_{i-1}, t_i]$ 中发生的所有跳跃之和。\n根据三角不等式，对于任何区间 $(t_{i-1}, t_i]$，我们有\n$$\n|X_{t_i} - X_{t_{i-1}}| = \\left| \\sum_{k: \\tau_k \\in (t_{i-1}, t_i]} J_k \\right| \\le \\sum_{k: \\tau_k \\in (t_{i-1}, t_i]} |J_k|.\n$$\n对分割的所有区间求和，我们得到\n$$\n\\sum_{i=1}^{n} | X_{t_i} - X_{t_{i-1}} | \\le \\sum_{i=1}^{n} \\sum_{k: \\tau_k \\in (t_{i-1}, t_i]} |J_k| = \\sum_{k=1}^{N_t} |J_k|.\n$$\n这个不等式对任何分割 $\\pi$ 都成立。右侧的表达式 $\\sum_{k=1}^{N_t} |J_k|$ 是对所有分割求和的上界。为了证明这是最小上界（上确界），我们需要构造一个分割序列，使得其和逼近这个值。\n\n考虑一个特定的分割 $\\pi^*$，它包含所有跳跃时间 $\\tau_k$ 作为分割点，以及每个跳跃前后紧邻的点。例如，对于一个小的 $\\epsilon > 0$，让分割包含点集 $\\{0, \\tau_1-\\epsilon, \\tau_1, \\tau_2-\\epsilon, \\tau_2, \\ldots, \\tau_{N_t}-\\epsilon, \\tau_{N_t}, t\\}$。对于这样的分割，我们可以隔离每个跳跃。绝对差之和包含诸如 $|X_{\\tau_k} - X_{\\tau_k - \\epsilon}| = |J_k|$ 的项（因为 $X$ 在 $(\\tau_{k-1}, \\tau_k)$ 上是常数）。对于一个包含所有跳跃时间的分割，其和恰好是 $\\sum_{k=1}^{N_t} |J_k|$。因为这个值可以达到，所以它必定是上确界。\n\n因此，全变差是直到时间 $t$ 为止发生的所有跳跃的绝对大小之和。\n$$\nV_t(X) = \\sum_{k=1}^{N_t} |J_k|.\n$$\n\n**2. 二次变差 $[X]_t$ 的计算**\n\n二次变差定义为当分割的网格趋于零时，增量平方和的极限：$[X]_t = \\lim_{\\|\\pi\\| \\to 0} \\sum_{i=1}^{n} ( X_{t_i} - X_{t_{i-1}} )^2$。\n设 $\\pi = \\{0=t_0, t_1, \\ldots, t_n=t\\}$ 是 $[0,t]$ 的一个分割。几乎必然地，在 $[0,t]$ 中有有限次（$N_t$ 次）跳跃。当网格 $\\|\\pi\\| \\to 0$ 时，我们可以确保任何分割区间 $(t_{i-1}, t_i]$ 最多只包含一个跳跃时间 $\\tau_k$。这是因为不同跳跃时间之间的最小距离几乎必然为正。\n\n我们来分析一个精细分割下的和 $\\sum_{i=1}^{n} ( X_{t_i} - X_{t_{i-1}} )^2$。\n- 如果一个区间 $(t_{i-1}, t_i]$ 不包含任何跳跃时间，那么 $X_t$ 在此区间上是常数。因此，$X_{t_i} - X_{t_{i-1}} = 0$，其对总和的贡献是 $0^2 = 0$。\n- 如果一个区间 $(t_{i-1}, t_i]$ 恰好包含一个跳跃时间 $\\tau_k$，那么 $X_{t_i} - X_{t_{i-1}} = X_{\\tau_k} - X_{\\tau_k^-} = J_k$。其对总和的贡献是 $J_k^2$。\n\n当 $\\|\\pi\\| \\to 0$ 时，分割变得足够精细，可以将 $N_t$ 次跳跃中的每一次都隔离到各自不同的区间中。因此，增量平方和将收敛于各个跳跃的平方和。\n$$\n\\lim_{\\|\\pi\\| \\to 0} \\sum_{i=1}^{n} ( X_{t_i} - X_{t_{i-1}} )^2 = \\sum_{k=1}^{N_t} J_k^2.\n$$\n这是纯跳跃过程的一个标准结果。一个 càdlàg 过程的二次变差是其跳跃平方和加上其连续部分的二次变差。对于复合泊松过程，其连续部分为零，因此其二次变差为零。跳跃 $\\Delta X_s$ 仅在 $s \\in \\{\\tau_1, \\dots, \\tau_{N_t}\\}$ 时非零。\n因此，二次变差是直到时间 $t$ 为止所有跳跃的平方和：\n$$\n[X]_t = \\sum_{s \\le t} (\\Delta X_s)^2 = \\sum_{k=1}^{N_t} J_k^2.\n$$\n\n因此，全变差和二次变差的最终表达式分别为 $V_t(X) = \\sum_{k=1}^{N_t} |J_k|$ 和 $[X]_t = \\sum_{k=1}^{N_t} J_k^2$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sum_{k=1}^{N_t} |J_k|  \\sum_{k=1}^{N_t} J_k^2 \\end{pmatrix}}\n$$", "id": "3063766"}, {"introduction": "最后的这项练习深入探讨了Lévy过程的微观属性（跳跃分布）与其宏观行为（过程的方差）之间的关系。通过分析一个具有重尾跳跃的过程，您将确定其方差保持有限的精确条件。这个练习突显了Lévy测度在刻画过程矩时的关键作用，对于理解极端事件模型至关重要。[@problem_id:3063738]", "problem": "考虑一个复合泊松过程 $X_{t}$，其定义为 $X_{t}=\\sum_{i=1}^{N_{t}} Y_{i}$，其中 $\\{N_{t}:t\\geq 0\\}$ 是一个速率为 $\\lambda0$ 的泊松过程，$\\{Y_{i}\\}_{i\\geq 1}$ 是独立同分布的跳跃，且与 $\\{N_{t}\\}$ 独立。假设跳跃分布是对称的重尾分布，其密度为\n$$\nf(y)=\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,|y|^{-(1+\\alpha)}\\,\\mathbf{1}_{\\{|y|\\geq y_{0}\\}},\n$$\n其中 $\\alpha0$ 和 $y_{0}0$ 是固定常数，$\\mathbf{1}_{A}$ 表示事件 $A$ 的指示函数。过程 $\\{X_{t}\\}$ 是一个具有平稳独立增量的Lévy过程。\n\n仅使用复合泊松过程和Lévy测度的定义，以及条件期望和方差的基本性质，完成以下任务：\n\n- 推导尾指数 $\\alpha$ 需满足的充要条件，使得方差 $\\operatorname{Var}(X_{t})$ 对某个（等价地，所有）$t0$ 是有限的。\n- 用 $\\lambda$ 和 $f$ 表示 $X$ 的Lévy测度 $\\nu$，并将你的有限方差条件重述为涉及 $\\int_{\\mathbb{R}} x^{2}\\,\\nu(dx)$ 的可积性条件。\n- 当方差有限时，计算 $\\operatorname{Var}(X_{t})$ 作为 $\\lambda$、$t$、$\\alpha$ 和 $y_{0}$ 的函数的闭式表达式。\n\n你的最终答案必须是在方差有限的情况下，$\\operatorname{Var}(X_{t})$ 关于 $\\lambda$、$t$、$\\alpha$ 和 $y_{0}$ 的单一解析表达式。不需要进行数值计算或四舍五入。", "solution": "该问题是随机过程理论中的一个有效练习。所有给出的定义和条件都是标准的且自洽的。我们可以开始求解。\n\n复合泊松过程定义为 $X_{t}=\\sum_{i=1}^{N_{t}} Y_{i}$，其中 $\\{N_{t}:t\\geq 0\\}$ 是一个速率为 $\\lambda  0$ 的泊松过程，$\\{Y_{i}\\}_{i\\geq 1}$ 是独立同分布（i.i.d.）的随机变量，且与 $N_t$ 独立。$X_t$ 的方差，记为 $\\operatorname{Var}(X_{t})$，可以使用全方差公式（也称为迭代方差公式）计算：\n$$\n\\operatorname{Var}(X_{t}) = \\mathbb{E}[\\operatorname{Var}(X_{t}|N_{t})] + \\operatorname{Var}(\\mathbb{E}[X_{t}|N_{t}])\n$$\n\n首先，我们求在给定 $N_t$ 的条件下 $X_t$ 的条件期望和条件方差。\n给定 $N_{t}=n$，过程 $X_t$ 是 $n$ 个独立同分布的随机变量 $Y_i$ 的和：$X_{t}|_{N_t=n} = \\sum_{i=1}^{n} Y_{i}$。\n条件期望为：\n$$\n\\mathbb{E}[X_{t}|N_{t}=n] = \\mathbb{E}\\left[\\sum_{i=1}^{n} Y_{i}\\right] = \\sum_{i=1}^{n} \\mathbb{E}[Y_{i}] = n\\,\\mathbb{E}[Y_{1}]\n$$\n这意味着随机变量 $\\mathbb{E}[X_{t}|N_{t}]$ 是 $N_{t}\\mathbb{E}[Y_{1}]$。\n\n条件方差为：\n$$\n\\operatorname{Var}(X_{t}|N_{t}=n) = \\operatorname{Var}\\left(\\sum_{i=1}^{n} Y_{i}\\right) = \\sum_{i=1}^{n} \\operatorname{Var}(Y_{i}) = n\\,\\operatorname{Var}(Y_{1})\n$$\n这意味着随机变量 $\\operatorname{Var}(X_{t}|N_{t})$ 是 $N_{t}\\operatorname{Var}(Y_{1})$。\n\n现在，我们将这些代回全方差公式。这两个项是：\n1.  $\\operatorname{Var}(\\mathbb{E}[X_{t}|N_{t}]) = \\operatorname{Var}(N_{t}\\mathbb{E}[Y_{1}]) = (\\mathbb{E}[Y_{1}])^{2} \\operatorname{Var}(N_{t})$。\n2.  $\\mathbb{E}[\\operatorname{Var}(X_{t}|N_{t})] = \\mathbb{E}[N_{t}\\operatorname{Var}(Y_{1})] = \\operatorname{Var}(Y_{1}) \\mathbb{E}[N_{t}]$。\n\n对于速率为 $\\lambda$ 的泊松过程 $N_t$，我们知道 $\\mathbb{E}[N_{t}] = \\lambda t$ 且 $\\operatorname{Var}(N_{t}) = \\lambda t$。代入这些可得：\n$$\n\\operatorname{Var}(X_{t}) = \\lambda t \\operatorname{Var}(Y_{1}) + \\lambda t (\\mathbb{E}[Y_{1}])^{2} = \\lambda t (\\operatorname{Var}(Y_{1}) + (\\mathbb{E}[Y_{1}])^{2})\n$$\n使用方差的定义 $\\operatorname{Var}(Y_{1}) = \\mathbb{E}[Y_{1}^{2}] - (\\mathbb{E}[Y_{1}])^{2}$，我们得到：\n$$\n\\operatorname{Var}(X_{t}) = \\lambda t \\mathbb{E}[Y_{1}^{2}]\n$$\n这个结果也被称为Blackwell-Girshick方程。为了使 $\\operatorname{Var}(X_t)$ 对任何 $t>0$ 都是有限的，$\\mathbb{E}[Y_1^2]$ 必须是有限的。注意，根据柯西-施瓦茨不等式，有限的二阶矩 $\\mathbb{E}[Y_1^2]$ 蕴含着有限的一阶矩 $\\mathbb{E}[|Y_1|]$。\n\n现在，我们必须确定使 $\\mathbb{E}[Y_{1}^{2}]$ 有限的关于 $\\alpha$ 的条件。首先，我们考察均值 $\\mathbb{E}[Y_1]$。跳跃密度是对称的，$f(y) = f(-y)$，由下式给出\n$$\nf(y)=\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,|y|^{-(1+\\alpha)}\\,\\mathbf{1}_{\\{|y|\\geq y_{0}\\}}\n$$\n均值为 $\\mathbb{E}[Y_{1}] = \\int_{-\\infty}^{\\infty} y f(y) dy$。被积函数 $y f(y)$ 是一个奇函数，积分区域 $\\{y:|y| \\ge y_0\\}$ 关于 $y=0$ 对称。因此，如果积分收敛，其值为 $0$。收敛性取决于绝对值的积分：\n$$\n\\int_{-\\infty}^{\\infty} |y| f(y) dy = 2 \\int_{y_0}^{\\infty} y \\left(\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,y^{-(1+\\alpha)}\\right) dy = \\alpha y_0^\\alpha \\int_{y_0}^{\\infty} y^{-\\alpha} dy\n$$\n该积分收敛当且仅当 $-\\alpha  -1$，即 $\\alpha > 1$。如果 $\\alpha \\le 1$，均值 $\\mathbb{E}[Y_1]$ 未定义，因此方差 $\\operatorname{Var}(X_t)$ 是无穷大。如果 $\\alpha > 1$，则 $\\mathbb{E}[Y_{1}] = 0$。\n\n接下来，我们计算二阶矩 $\\mathbb{E}[Y_{1}^{2}]$：\n$$\n\\mathbb{E}[Y_{1}^{2}] = \\int_{-\\infty}^{\\infty} y^{2} f(y) dy\n$$\n被积函数 $y^2 f(y)$ 是一个偶函数，所以我们可以写成：\n$$\n\\mathbb{E}[Y_{1}^{2}] = 2 \\int_{y_{0}}^{\\infty} y^{2} f(y) dy = 2 \\int_{y_{0}}^{\\infty} y^{2} \\left(\\frac{\\alpha\\,y_{0}^{\\alpha}}{2}\\,y^{-(1+\\alpha)}\\right) dy = \\alpha y_{0}^{\\alpha} \\int_{y_{0}}^{\\infty} y^{1-\\alpha} dy\n$$\n该积分收敛当且仅当指数 $1-\\alpha$ 小于 $-1$，即 $1-\\alpha  -1$，化简为 $\\alpha > 2$。当 $\\alpha \\le 2$ 时，$\\mathbb{E}[Y_1^2]$ 是无穷大，因此 $\\operatorname{Var}(X_t)$ 也是无穷大。条件 $\\alpha > 2$ 蕴含 $\\alpha > 1$，所以均值存在的条件是满足的。因此，$\\operatorname{Var}(X_t)$ 为有限的充要条件是 $\\alpha > 2$。\n\n复合泊松过程的Lévy测度 $\\nu$ 由 $\\nu(A) = \\lambda P(Y_1 \\in A)$ 给出，其中 $A \\subset \\mathbb{R}\\setminus\\{0\\}$ 是任意Borel集。用密度表示，这意味着 $\\nu(dx) = \\lambda f(x) dx$。\n我们得到的有限方差条件是 $\\mathbb{E}[Y_1^2]  \\infty$。我们可以用Lévy测度来表示这个条件：\n$$\n\\mathbb{E}[Y_1^2] = \\int_{\\mathbb{R}} x^2 f(x) dx = \\int_{\\mathbb{R}} x^2 \\frac{1}{\\lambda} \\nu(dx) = \\frac{1}{\\lambda} \\int_{\\mathbb{R}} x^2 \\nu(dx)\n$$\n由于 $\\lambda$ 是一个正常数，条件 $\\mathbb{E}[Y_1^2]  \\infty$ 等价于条件 $\\int_{\\mathbb{R}} x^{2}\\,\\nu(dx)  \\infty$。这与Lévy过程的一般理论是一致的，对于没有布朗分量且二阶矩有限的过程，有 $\\operatorname{Var}(X_t) = t \\int_{\\mathbb{R}} x^2 \\nu(dx)$。我们的推导证实了这一点：\n$$\n\\operatorname{Var}(X_t) = \\lambda t \\mathbb{E}[Y_1^2] = \\lambda t \\left(\\frac{1}{\\lambda} \\int_{\\mathbb{R}} x^2 \\nu(dx)\\right) = t \\int_{\\mathbb{R}} x^2 \\nu(dx)\n$$\n\n最后，我们在条件 $\\alpha>2$ 下计算 $\\operatorname{Var}(X_t)$ 的闭式表达式。我们计算 $\\mathbb{E}[Y_{1}^{2}]$ 的积分：\n$$\n\\int_{y_{0}}^{\\infty} y^{1-\\alpha} dy = \\left[ \\frac{y^{2-\\alpha}}{2-\\alpha} \\right]_{y_{0}}^{\\infty}\n$$\n由于 $\\alpha > 2$，指数 $2-\\alpha$ 是负的，所以 $\\lim_{y\\to\\infty} y^{2-\\alpha} = 0$。该积分计算结果为：\n$$\n0 - \\frac{y_{0}^{2-\\alpha}}{2-\\alpha} = \\frac{y_{0}^{2-\\alpha}}{\\alpha-2}\n$$\n将此结果代回二阶矩的表达式：\n$$\n\\mathbb{E}[Y_{1}^{2}] = \\alpha y_{0}^{\\alpha} \\left( \\frac{y_{0}^{2-\\alpha}}{\\alpha-2} \\right) = \\frac{\\alpha y_{0}^{\\alpha+2-\\alpha}}{\\alpha-2} = \\frac{\\alpha y_{0}^{2}}{\\alpha-2}\n$$\n因此，$X_t$ 的方差为：\n$$\n\\operatorname{Var}(X_{t}) = \\lambda t \\mathbb{E}[Y_{1}^{2}] = \\lambda t \\frac{\\alpha y_{0}^{2}}{\\alpha-2}\n$$\n此表达式在 $\\alpha > 2$ 时有效。", "answer": "$$\\boxed{\\frac{\\lambda t \\alpha y_{0}^{2}}{\\alpha-2}}$$", "id": "3063738"}]}