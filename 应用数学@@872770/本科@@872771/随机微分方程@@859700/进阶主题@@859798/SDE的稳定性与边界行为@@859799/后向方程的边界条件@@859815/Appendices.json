{"hands_on_practices": [{"introduction": "随机微分方程理论最强大的功能之一，是将复杂的概率问题转化为确定性的偏微分方程问题。本练习将引导你完成这一转化过程，计算一个随机过程到达特定边界的概率。通过求解一个带有狄利克雷（Dirichlet）边界条件的倒向 Kolmogorov 方程，你将亲身体验如何将“吸收边界”这一概率概念，精确地对应于一个固定的数学边界条件 [@problem_id:3041824]。", "problem": "设 $\\{X_{t}\\}_{t \\ge 0}$ 是一维随机微分方程 (SDE) $\\,\\mathrm{d}X_{t}=\\mu\\,\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t}\\,$ 的解，其中漂移 $\\mu \\in \\mathbb{R}\\setminus\\{0\\}$ 和波动率 $\\sigma0$ 为常数，$\\{W_{t}\\}_{t \\ge 0}$ 是标准布朗运动 (BM)。考虑开区间（域）$D=(0,1)$ 和边界子集 $\\Gamma=\\{1\\}\\subset\\partial D=\\{0,1\\}$。对于一个初始点 $x\\in(0,1)$，定义首次出时 $\\tau=\\inf\\{t\\ge 0: X_{t}\\notin(0,1)\\}$ 和击中事件 $A=\\{X_{\\tau}=1\\}$。\n \n从 $\\{X_{t}\\}_{t \\ge 0}$ 的无穷小生成元和诸如 Dynkin 公式（或生成元的调和函数的鞅刻画）等基本结果出发，推导函数 $u(x)=\\mathbb{P}_{x}(A)$ 在 $(0,1)$ 上的相应逆向边值问题，并附带在 $\\partial D$ 上的边界条件，然后求解以显式获得 $u(x)$。最后，在特定初始条件 $x=\\tfrac{1}{3}$ 处计算该概率。\n \n请仅用 $\\mu$ 和 $\\sigma$ 将最终答案表示为单个闭式解析表达式。不要对答案进行近似或四舍五入；无需进行数值计算。", "solution": "随机过程 $\\{X_{t}\\}_{t \\ge 0}$ 由表示算术布朗运动的一维 SDE 控制：\n$$\n\\mathrm{d}X_{t} = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}\n$$\n其中 $\\mu \\in \\mathbb{R}\\setminus\\{0\\}$ 和 $\\sigma  0$ 是常数，$\\{W_{t}\\}_{t \\ge 0}$ 是标准布朗运动。我们的任务是求事件 $A = \\{X_{\\tau}=1\\}$ 的概率 $u(x) = \\mathbb{P}_{x}(A)$，其中 $\\tau$ 是从域 $D=(0,1)$ 的首次出时，起始点为 $X_0=x \\in (0,1)$。\n\n为了求解 $u(x)$，我们将建立并求解相应的逆向 Kolmogorov 边值问题。根据 SDE 理论，击中概率 $u(x)$ 是过程 $\\{X_{t}\\}_{t \\ge 0}$ 的无穷小生成元 $\\mathcal{L}$ 的一个调和函数，即在域 $D$ 上 $\\mathcal{L}u(x)=0$。这可以使用 Dynkin 公式来正式建立。\n\n对于一个一般的 Itô 过程 $\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + s(X_t)\\,\\mathrm{d}W_t$，作用于二阶连续可微函数 $f(x)$ 的无穷小生成元 $\\mathcal{L}$ 定义为：\n$$\n\\mathcal{L}f(x) = b(x) \\frac{\\mathrm{d}f}{\\mathrm{d}x} + \\frac{1}{2} s(x)^2 \\frac{\\mathrm{d}^2f}{\\mathrm{d}x^2}\n$$\n对于给定的 SDE，漂移系数为 $b(x)=\\mu$，扩散系数为 $s(x)=\\sigma$。因此，生成元为：\n$$\n\\mathcal{L} = \\mu \\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}\\sigma^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}\n$$\n条件 $\\mathcal{L}u(x) = 0$ 提供了 $u(x)$ 的控制性常微分方程 (ODE)：\n$$\n\\frac{1}{2}\\sigma^2 u''(x) + \\mu u'(x) = 0, \\quad \\text{for } x \\in (0,1)\n$$\n边界条件由 $u(x)$ 在边界 $\\partial D = \\{0,1\\}$ 上的定义确定。\n1. 如果过程从 $x=1$ 开始，它已经从右边界出界。出时为 $\\tau=0$，位置为 $X_{\\tau}=X_0=1$。因此，事件 $A$ 以概率 $1$ 发生。这给出了边界条件 $u(1)=1$。\n2. 如果过程从 $x=0$ 开始，它已经从左边界出界。出时为 $\\tau=0$，位置为 $X_{\\tau}=X_0=0$。事件 $A$ 不可能发生。这给出了边界条件 $u(0)=0$。\n\n完整的边值问题是：\n$$\n\\begin{cases}\n\\frac{1}{2}\\sigma^2 u''(x) + \\mu u'(x) = 0,  x \\in (0,1) \\\\\nu(0) = 0 \\\\\nu(1) = 1\n\\end{cases}\n$$\n这是一个二阶、线性、齐次、常系数的常微分方程。我们假设一个形如 $u(x) = \\exp(rx)$ 的解，这导出特征方程：\n$$\n\\frac{1}{2}\\sigma^2 r^{2} + \\mu r = 0 \\implies r\\left(\\frac{1}{2}\\sigma^2 r + \\mu\\right) = 0\n$$\n由于问题陈述 $\\mu \\neq 0$ 且 $\\sigma  0$，特征根是不同的：\n$$\nr_1 = 0 \\quad \\text{and} \\quad r_2 = -\\frac{2\\mu}{\\sigma^2}\n$$\n该常微分方程的通解是基本解 $\\exp(r_1 x)$ 和 $\\exp(r_2 x)$ 的线性组合：\n$$\nu(x) = C_1 \\exp(r_1 x) + C_2 \\exp(r_2 x) = C_1 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n我们通过应用边界条件来确定常数 $C_1$ 和 $C_2$。\n由 $u(0)=0$ 可得：\n$$\n0 = C_1 + C_2 \\exp(0) \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2\n$$\n由 $u(1)=1$ 可得：\n$$\n1 = C_1 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)\n$$\n将 $C_1 = -C_2$ 代入第二个方程：\n$$\n1 = -C_2 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) = C_2 \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1\\right)\n$$\n解出 $C_2$：\n$$\nC_2 = \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1}\n$$\n那么 $C_1 = -C_2$：\n$$\nC_1 = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\n将这些常数代回通解，得到 $u(x)$ 的显式形式：\n$$\nu(x) = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} + \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1}\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n$$\nu(x) = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} - \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n$$\nu(x) = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\n最后，我们在指定的初始条件 $x=\\frac{1}{3}$ 处计算这个概率：\n$$\nu\\left(\\frac{1}{3}\\right) = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2} \\cdot \\frac{1}{3}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{3\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\n这是用参数 $\\mu$ 和 $\\sigma$ 表示的概率的最终表达式。", "answer": "$$\n\\boxed{\\frac{1 - \\exp\\left(-\\frac{2\\mu}{3\\sigma^{2}}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^{2}}\\right)}}\n$$", "id": "3041824"}, {"introduction": "在计算了过程“是否”到达某个点之后，一个自然而然的问题是“何时”到达。本练习将探讨期望首出时间，即一个随机过程首次离开给定区域所需的平均时间。你会发现，这个问题同样可以通过求解一个倒向方程来解决，但与计算概率不同，这次的方程是一个非齐次的泊松型方程 $\\mathcal{L}v(x) = -1$ [@problem_id:3041857]。这个练习展示了倒向方程框架的广泛适用性，只需微调方程，就能解决不同类型的概率问题。", "problem": "考虑一个在$\\mathbb{R}^{n}$中的时间齐次扩散过程$X=(X_t)_{t \\geq 0}$，其无穷小生成元$\\mathcal{L}$作用于二次连续可微函数$f \\in C^{2}(\\mathbb{R}^{n})$，标准定义为$\\mathcal{L} f(x) = \\lim_{t \\downarrow 0} \\frac{\\mathbb{E}_{x}[f(X_{t})] - f(x)}{t}$，其中$\\mathbb{E}_{x}[\\cdot]$表示在$X_{0} = x$条件下的期望。令$D \\subset \\mathbb{R}^{n}$为一个有界开区域，其边界$\\partial D$足够正则。定义首次出流时间为$\\tau_{D} = \\inf\\{t \\geq 0 : X_{t} \\notin D\\}$。考虑对于$x \\in D$的期望出流时间函数$v(x) = \\mathbb{E}_{x}[\\tau_{D}]$。\n\n从基本原理出发——即强马尔可夫性、无穷小生成元的定义和伊藤(Itô)公式——推导$v$在$D$中满足的边值问题。特别地，证明$v$是向后方程$\\mathcal{L} v(x) = -1$在$D$中的唯一解，且满足狄利克雷(Dirichlet)边界条件$v|_{\\partial D} = 0$。\n\n然后，将问题特化到一维情况，令$X$为标准布朗运动(BM)，在区间$(0,a)$上满足随机微分方程(SDE)$dX_{t} = dW_{t}$，其中$a  0$为定值。使用对应的布朗运动生成元，在边界条件$v(0) = v(a) = 0$下，计算$v(x)$对于$x \\in (0,a)$的显式闭式表达式。\n\n你的最终答案必须是$v(x)$关于$x$和$a$的单个闭式解析表达式。不需要进行数值近似。", "solution": "### 边值问题的推导\n\n我们需要推导期望出流时间$v(x) = \\mathbb{E}_{x}[\\tau_{D}]$满足的边值问题。这包括建立在区域$D$内的控制偏微分方程(PDE)以及在其边界$\\partial D$上的条件。\n\n**1. 边界条件**\n\n令 $x \\in \\partial D$。首次出流时间 $\\tau_D$ 定义为 $\\tau_{D} = \\inf\\{t \\geq 0 : X_{t} \\notin D\\}$。因为 $D$ 是一个开集，其边界 $\\partial D$ 不属于 $D$。因此，如果过程从 $X_0 = x \\in \\partial D$ 开始，那么在时间 $t=0$ 时它已经位于 $D$ 之外。因此下确界为 $0$。\n所以，对于任何 $x \\in \\partial D$，我们有 $\\tau_D = 0$。那么期望值 $v(x) = \\mathbb{E}_{x}[0] = 0$。这就给出了狄利克雷边界条件：\n$$v(x) = 0 \\quad \\text{for } x \\in \\partial D$$\n\n**2. 微分方程**\n\n为了推导区域$D$内部的方程，我们假设$v(x)$是充分光滑的，具体来说是$v \\in C^2(D)$，这样它就位于生成元$\\mathcal{L}$的定义域内。我们使用扩散过程$X_t$的强马尔可夫性。\n\n对于一个微小的时间增量$h  0$，我们可以通过对过程在时间$h$之前的状态进行条件化来表示总出流时间$\\tau_D$。\n$$v(x) = \\mathbb{E}_{x}[\\tau_D]$$\n根据条件期望的塔性质和在停时$h \\wedge \\tau_D$处的强马尔可夫性，我们可以写出：\n$$v(x) = \\mathbb{E}_{x}[h \\wedge \\tau_D + (\\tau_D - h)^+ ] = \\mathbb{E}_{x}[h \\wedge \\tau_D] + \\mathbb{E}_{x}[(\\tau_D - h)\\mathbf{1}_{\\{h  \\tau_D\\}}] $$\n其中$\\mathbf{1}_{\\{\\cdot\\}}$是指示函数。第二项，根据在时间$h$处的强马尔可夫性，可以重写为：\n$$ \\mathbb{E}_{x}[(\\tau_D - h)\\mathbf{1}_{\\{h  \\tau_D\\}}] = \\mathbb{E}_{x}[\\mathbf{1}_{\\{h  \\tau_D\\}} \\mathbb{E}_{X_h}[\\tau_D]] = \\mathbb{E}_{x}[\\mathbf{1}_{\\{h  \\tau_D\\}} v(X_h)] $$\n所以，我们有：\n$$ v(x) = \\mathbb{E}_{x}[h \\wedge \\tau_D] + \\mathbb{E}_{x}[v(X_h) \\mathbf{1}_{\\{h  \\tau_D\\}}] $$\n对于一个微小的时间$h$，当$x$不在边界上时，离开区域的概率$P_x(\\tau_D \\le h)$是比$h$更高阶的无穷小（即$o(h)$）。因此，当$h \\downarrow 0$时，我们可以做如下近似：\n$$ \\mathbb{E}_{x}[h \\wedge \\tau_D] = h \\cdot P_x(\\tau_D  h) + \\mathbb{E}_{x}[\\tau_D | \\tau_D \\le h] P_x(\\tau_D \\le h) = h(1 - o(1)) + O(h)o(h) = h + o(h) $$\n$$ \\mathbb{E}_{x}[v(X_h) \\mathbf{1}_{\\{h  \\tau_D\\}}] = \\mathbb{E}_{x}[v(X_h)] - \\mathbb{E}_{x}[v(X_h)\\mathbf{1}_{\\{h \\geq \\tau_D\\}}] = \\mathbb{E}_{x}[v(X_h)] + o(h) $$\n将这些近似代入我们关于$v(x)$的方程：\n$$ v(x) = h + \\mathbb{E}_{x}[v(X_h)] + o(h) $$\n整理各项，我们得到：\n$$ \\mathbb{E}_{x}[v(X_h)] - v(x) = -h + o(h) $$\n两边除以$h$并取$h \\downarrow 0$的极限：\n$$ \\lim_{h \\downarrow 0} \\frac{\\mathbb{E}_{x}[v(X_h)] - v(x)}{h} = -1 $$\n左边恰好是无穷小生成元$\\mathcal{L}$作用于函数$v$在点$x$处的定义。因此，我们得到了偏微分方程：\n$$ \\mathcal{L}v(x) = -1 \\quad \\text{for } x \\in D $$\n这个椭圆型边值问题的解的唯一性是偏微分方程理论中的一个标准结果，我们将其视为已知。因此，$v(x) = \\mathbb{E}_x[\\tau_D]$是该边值问题的唯一解。\n\n### 特化到一维标准布朗运动\n\n现在，我们特化到$X_t$是一维标准布朗运动的情况，满足随机微分方程$dX_t = dW_t$。区域是区间$D = (0,a)$，其中$a0$。\n\n**1. 布朗运动的生成元**\n\n对于一维扩散过程$dX_t = b(X_t)dt + \\sigma(X_t)dW_t$，其一般的无穷小生成元由下式给出：\n$$ \\mathcal{L}f(x) = b(x) \\frac{df}{dx}(x) + \\frac{1}{2}\\sigma(x)^2 \\frac{d^2f}{dx^2}(x) $$\n对于标准布朗运动，漂移系数$b(x) = 0$，扩散系数$\\sigma(x)=1$。将这些代入生成元中，得到：\n$$ \\mathcal{L}f(x) = (0) \\frac{df}{dx}(x) + \\frac{1}{2}(1)^2 \\frac{d^2f}{dx^2}(x) = \\frac{1}{2} \\frac{d^2f}{dx^2}(x) $$\n所以，生成元为$\\mathcal{L} = \\frac{1}{2}\\frac{d^2}{dx^2}$。\n\n**2. 求解边值问题**\n\n我们必须求解的边值问题是在$(0,a)$内$\\mathcal{L}v(x) = -1$，边界条件为$v(0)=0$和$v(a)=0$。\n代入具体的生成元，我们得到常微分方程：\n$$ \\frac{1}{2} v''(x) = -1 $$\n$$ v''(x) = -2 $$\n我们通过两次积分来解这个常微分方程。对$x$积分得到一阶导数：\n$$ v'(x) = \\int -2 \\, dx = -2x + C_1 $$\n其中$C_1$是积分常数。第二次积分得到$v(x)$的通解：\n$$ v(x) = \\int (-2x + C_1) \\, dx = -x^2 + C_1 x + C_2 $$\n其中$C_2$是第二个积分常数。我们用边界条件来确定常数$C_1$和$C_2$。\n\n第一个边界条件是$v(0)=0$：\n$$ v(0) = -(0)^2 + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n这将解简化为$v(x) = -x^2 + C_1 x$。\n\n第二个边界条件是$v(a)=0$：\n$$ v(a) = -a^2 + C_1 a = 0 $$\n因为$a0$，我们可以用$a$除以方程两边：\n$$ -a + C_1 = 0 \\implies C_1 = a $$\n将$C_1=a$和$C_2=0$的值代回通解，我们得到期望出流时间的显式闭式表达式：\n$$ v(x) = -x^2 + ax $$\n这也可以写成$v(x) = x(a-x)$。这代表了一个开口向下的抛物线，其根在$x=0$和$x=a$，并且对于$x \\in (0,a)$是正的，这符合对一个时间长度的预期。", "answer": "$$\\boxed{ax - x^2}$$", "id": "3041857"}, {"introduction": "边界条件是连接随机过程行为与微分方程解的关键。不同的边界行为，如吸收、反射或部分反射，分别对应于狄利克雷（Dirichlet）、诺伊曼（Neumann）和罗宾（Robin）这几种不同的数学边界条件。本练习旨在通过编程实践，系统地比较这些边界条件对命中概率的影响 [@problem_id:3041839]。通过求解并对比不同边界下的解析解，你将深刻理解每种边界条件背后的概率直觉，并巩固理论与实践的联系。", "problem": "考虑一个一维 Itō 扩散过程，该过程由随机微分方程 $dX_t = \\mu\\,dt + \\sigma\\,dW_t$ 在闭区间 $[0,L]$ 上支配。其中 $\\mu \\in \\mathbb{R}$ 是恒定漂移，$\\sigma  0$ 是恒定扩散系数，$L  0$ 是区域长度，$W_t$ 是一个标准维纳过程。令 $u(x)$ 表示从 $X_0 = x$ 开始的过程在到达左端点 $0$ 之前先到达右端点 $L$ 的概率，其中在左端点的相互作用取决于边界类型。\n\n根据后向 Kolmogorov 方程，这个触碰概率 $u(x)$ 满足以下线性二阶常微分方程（一维偏微分方程 (PDE) 的一个特例）：\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) + \\mu\\,u'(x) = 0, \\quad x \\in (0,L),\n$$\n该方程受制于 $x=0$ 处的边界条件（取决于边界类型）和 $x=L$ 处的目标边界条件 $u(L) = 1$。具体来说，考虑并比较以下三种在 $x=0$ 处的边界类型：\n\n- $x=0$ 处的 Dirichlet 边界：$u(0) = 0$（在左边界完全吸收）。\n- $x=0$ 处的 Neumann 边界：$u'(0) = 0$（在左边界完全反射）。\n- $x=0$ 处的 Robin 边界：$u'(0) - \\kappa\\,u(0) = 0$，其中 $\\kappa  0$（在 $\\kappa \\to 0$ 时插值为 Neumann 边界，在 $\\kappa \\to \\infty$ 时插值为 Dirichlet 边界）。\n\n您的任务是实现一个程序，对于给定的参数集 $(\\mu,\\sigma,L,\\kappa,x)$ 和 $x=0$ 处的边界类型，通过求解后向边值问题来计算 $u(x)$ 的相应值。程序必须使用从上述微分方程和边界条件推导出的正确公式。输出不需要任何物理单位。\n\n使用以下参数值测试套件来验证和比较边界类型对 $u(x)$ 的影响，包括代表性案例、边界值和边缘案例：\n\n- 测试案例 1：$x=0$ 处为 Dirichlet 边界，参数为 $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.3)$。\n- 测试案例 2：$x=0$ 处为 Dirichlet 边界，参数为 $(\\mu,\\sigma,L,x) = (-0.5,\\,1.0,\\,1.0,\\,0.7)$。\n- 测试案例 3：$x=0$ 处为 Dirichlet 边界，起点在边界上，参数为 $(\\mu,\\sigma,L,x) = (0.2,\\,1.0,\\,1.0,\\,0.0)$。\n- 测试案例 4：$x=0$ 处为 Dirichlet 边界，起点在目标边界上，参数为 $(\\mu,\\sigma,L,x) = (0.2,\\,1.0,\\,1.0,\\,1.0)$。\n- 测试案例 5：$x=0$ 处为 Neumann 边界，参数为 $(\\mu,\\sigma,L,x) = (0.0,\\,1.0,\\,1.0,\\,0.6)$。\n- 测试案例 6：$x=0$ 处为 Neumann 边界，参数为 $(\\mu,\\sigma,L,x) = (-0.5,\\,1.0,\\,1.0,\\,0.2)$。\n- 测试案例 7：$x=0$ 处为 Robin 边界，$\\kappa = 5.0$，参数为 $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.3)$。\n- 测试案例 8：$x=0$ 处为 Robin 边界，$\\kappa = 0.1$，参数为 $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.7)$。\n- 测试案例 9：$x=0$ 处为 Robin 边界，$\\kappa = 2.0$ 且零漂移，参数为 $(\\mu,\\sigma,L,x) = (0.0,\\,1.0,\\,1.0,\\,0.4)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如 $[r_1,r_2,\\dots,r_9]$），其中每个 $r_i$ 是相应测试案例计算出的 $u(x)$ 值。每个输出都必须是浮点数。程序不要求用户输入，必须是自包含的且可直接运行。", "solution": "该问题是有效的，因为它基于随机微分方程理论，具有科学依据，在数学上是适定的，并且给出了客观、明确的规范。我们接下来推导触碰概率 $u(x)$ 的解析解。\n\n触碰概率 $u(x)$ 是后向 Kolmogorov 方程的解。对于定义在区域 $x \\in (0,L)$ 上、具有恒定漂移 $\\mu$ 和扩散 $\\sigma$ 的一维 Itō 过程，该方程是以下二阶线性常微分方程 (ODE)：\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) + \\mu\\,u'(x) = 0\n$$\n为了求通解，我们可以令 $v(x) = u'(x)$，这将方程转换为一个关于 $v(x)$ 的一阶 ODE：\n$$\n\\frac{\\sigma^2}{2}\\,v'(x) + \\mu\\,v(x) = 0 \\implies v'(x) = -\\frac{2\\mu}{\\sigma^2}v(x)\n$$\n这是一个可分离方程，其解为 $v(x) = C_1 e^{-\\frac{2\\mu}{\\sigma^2}x}$。将 $v(x)$ 对 $x$ 积分得到 $u(x)$。解的形式取决于 $\\mu$ 是否为零。\n\n**情况 1：非零漂移 ($\\mu \\neq 0$)**\n\n我们定义常数 $\\gamma = \\frac{2\\mu}{\\sigma^2}$。$u'(x)$ 的解是 $u'(x) = C_1 e^{-\\gamma x}$。将其对 $x$ 积分，得到 $u(x)$ 的通解：\n$$\nu(x) = \\int C_1 e^{-\\gamma x} dx = -\\frac{C_1}{\\gamma} e^{-\\gamma x} + C_2\n$$\n为简化记法，我们将其表示为：\n$$\nu(x) = A e^{-\\gamma x} + B\n$$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n**情况 2：零漂移 ($\\mu = 0$)**\n\n当 $\\mu=0$ 时，ODE 简化为 $\\frac{\\sigma^2}{2}u''(x) = 0$。由于 $\\sigma  0$，这要求 $u''(x) = 0$。对 $x$ 积分两次，得到通解：\n$$\nu(x) = C_1 x + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的常数。\n\n我们现在为问题中指定的每种边界类型推导特解。\n\n**边界类型分析**\n\n**I. $x=0$ 处的 Dirichlet 边界**\n边界条件为 $u(0)=0$（吸收）和 $u(L)=1$（目标）。\n\n如果 $\\mu \\neq 0$，我们使用 $u(x) = A e^{-\\gamma x} + B$：\n1. $u(0)=0 \\implies A e^0 + B = 0 \\implies A + B = 0 \\implies B = -A$。\n2. $u(L)=1 \\implies A e^{-\\gamma L} + B = 1$。\n将 $B=-A$ 代入第二个方程，得到 $A(e^{-\\gamma L} - 1) = 1$，所以 $A = \\frac{1}{e^{-\\gamma L} - 1}$。\n这意味着 $B = -\\frac{1}{e^{-\\gamma L} - 1}$。解为：\n$$\nu(x) = \\frac{e^{-\\gamma x} - 1}{e^{-\\gamma L} - 1}\n$$\n如果 $\\mu=0$，我们使用 $u(x) = C_1 x + C_2$：\n1. $u(0)=0 \\implies C_1(0) + C_2 = 0 \\implies C_2=0$。\n2. $u(L)=1 \\implies C_1 L + C_2 = 1 \\implies C_1 L = 1 \\implies C_1 = \\frac{1}{L}$。\n解为：\n$$\nu(x) = \\frac{x}{L}\n$$\n\n**II. $x=0$ 处的 Neumann 边界**\n边界条件为 $u'(0)=0$（反射）和 $u(L)=1$（目标）。$x=0$ 处的反射边界意味着过程不能在此处终止。由于区域是有限的，过程最终必须到达另一边界 $x=L$。因此，到达 $L$ 的概率为 $1$，即对所有 $x \\in [0,L]$ 都有 $u(x)=1$。\n我们可以形式化地验证这一点。\n\n如果 $\\mu \\neq 0$，我们有 $u(x) = A e^{-\\gamma x} + B$ 和 $u'(x) = -A\\gamma e^{-\\gamma x}$。\n1. $u'(0)=0 \\implies -A\\gamma e^0 = 0$。由于 $\\mu \\neq 0$ 意味着 $\\gamma \\neq 0$，我们必须有 $A=0$。\n2. $u(L)=1 \\implies u(x) = B$（因为 $A=0$），所以 $B=1$。\n解是 $u(x)=1$。\n\n如果 $\\mu = 0$，我们有 $u(x) = C_1 x + C_2$ 和 $u'(x) = C_1$。\n1. $u'(0)=0 \\implies C_1=0$。\n2. $u(L)=1 \\implies u(x) = C_2$（因为 $C_1=0$），所以 $C_2=1$。\n解同样是 $u(x)=1$。\n\n**III. $x=0$ 处的 Robin 边界**\n边界条件为 $u'(0) - \\kappa u(0) = 0$（部分吸收/反射，其中 $\\kappa  0$）和 $u(L)=1$。\n\n如果 $\\mu \\neq 0$，我们使用 $u(x) = A e^{-\\gamma x} + B$。\n1. $u(L)=1 \\implies A e^{-\\gamma L} + B = 1 \\implies B = 1 - A e^{-\\gamma L}$。\n2. $u'(0) - \\kappa u(0) = 0 \\implies (-A\\gamma) - \\kappa(A+B) = 0$。\n将 $B$ 代入第二个条件：\n$-A\\gamma - \\kappa(A + 1 - A e^{-\\gamma L}) = 0$\n$A(-\\gamma - \\kappa + \\kappa e^{-\\gamma L}) = \\kappa \\implies A = \\frac{\\kappa}{\\kappa e^{-\\gamma L} - \\gamma - \\kappa}$。\n在解出 $B$ 之后，最终解是：\n$$\nu(x) = \\frac{\\kappa e^{-\\gamma x} - \\gamma - \\kappa}{\\kappa e^{-\\gamma L} - \\gamma - \\kappa}\n$$\n该公式在 $\\kappa \\to 0$ 时正确地恢复为 Neumann 解 $u(x)=1$，在 $\\kappa \\to \\infty$ 时恢复为 Dirichlet 解。\n\n如果 $\\mu=0$，我们使用 $u(x) = C_1 x + C_2$。\n1. $u(L)=1 \\implies C_1 L + C_2 = 1 \\implies C_2 = 1 - C_1 L$。\n2. $u'(0) - \\kappa u(0) = 0 \\implies C_1 - \\kappa C_2 = 0 \\implies C_1 = \\kappa C_2$。\n将 $C_2 = C_1/\\kappa$ 代入第一个条件：\n$C_1 L + C_1/\\kappa = 1 \\implies C_1(L+1/\\kappa) = 1 \\implies C_1 = \\frac{\\kappa}{1+\\kappa L}$。\n这得到 $C_2 = C_1/\\kappa = \\frac{1}{1+\\kappa L}$。\n解为：\n$$\nu(x) = \\frac{\\kappa x + 1}{1+\\kappa L}\n$$\n这也与 $\\mu \\neq 0$ 的 Robin 解在 $\\mu \\to 0$ 时的极限一致。\n\n这些推导出的解析公式被用来实现计算，以得出给定测试案例的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the hitting probability u(x) for a 1D Itō diffusion process\n    on [0, L] for various boundary conditions at x=0.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'Dirichlet', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.3},\n        {'type': 'Dirichlet', 'mu': -0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.7},\n        {'type': 'Dirichlet', 'mu': 0.2, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.0},\n        {'type': 'Dirichlet', 'mu': 0.2, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 1.0},\n        {'type': 'Neumann', 'mu': 0.0, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.6},\n        {'type': 'Neumann', 'mu': -0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.2},\n        {'type': 'Robin', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': 5.0, 'x': 0.3},\n        {'type': 'Robin', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': 0.1, 'x': 0.7},\n        {'type': 'Robin', 'mu': 0.0, 'sigma': 1.0, 'L': 1.0, 'kappa': 2.0, 'x': 0.4},\n    ]\n\n    results = []\n    \n    # Epsilon for floating point comparison with zero\n    TOLERANCE = 1e-12\n\n    for case in test_cases:\n        mu = case['mu']\n        sigma = case['sigma']\n        L = case['L']\n        x = case['x']\n        \n        result = 0.0\n\n        if case['type'] == 'Dirichlet':\n            if abs(mu)  TOLERANCE:\n                # Solution for mu = 0\n                if L > TOLERANCE:\n                    result = x / L\n                else: # To handle potential division by zero, though L>0 is given\n                    result = 1.0 if x >= L else 0.0\n            else:\n                # Solution for mu != 0\n                gamma = 2.0 * mu / (sigma**2)\n                numerator = np.exp(-gamma * x) - 1.0\n                denominator = np.exp(-gamma * L) - 1.0\n                if abs(denominator)  TOLERANCE: # Fallback, should not happen for L>0, mu!=0\n                    result = x / L\n                else: \n                    result = numerator / denominator\n\n        elif case['type'] == 'Neumann':\n            # For a reflecting boundary at x=0 and absorbing at x=L on a finite domain,\n            # the particle must eventually hit L.\n            result = 1.0\n\n        elif case['type'] == 'Robin':\n            kappa = case['kappa']\n            if abs(mu)  TOLERANCE:\n                # Solution for mu = 0\n                numerator = kappa * x + 1.0\n                denominator = 1.0 + kappa * L\n                result = numerator / denominator\n            else:\n                # Solution for mu != 0\n                gamma = 2.0 * mu / (sigma**2)\n                numerator = kappa * np.exp(-gamma * x) - gamma - kappa\n                denominator = kappa * np.exp(-gamma * L) - gamma - kappa\n                if abs(denominator)  TOLERANCE: # Unlikely edge case\n                    # This implies kappa(exp(-gamma*L) - 1) = gamma\n                    # We will assume test cases avoid this singularity.\n                    result = np.nan\n                else:\n                    result = numerator / denominator\n        \n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3041839"}]}