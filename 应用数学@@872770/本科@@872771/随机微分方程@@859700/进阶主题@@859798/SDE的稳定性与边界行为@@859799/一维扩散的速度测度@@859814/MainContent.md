## 引言
在[随机过程](@entry_id:159502)理论中，[一维扩散](@entry_id:181320)通常由一个[随机微分方程](@entry_id:146618)（SDE）描述，其漂移和扩散系数决定了过程的瞬时运动。然而，这种表述有时会掩盖过程更深层次的结构特性，例如它在[状态空间](@entry_id:177074)不同区域停留时间的倾向性，其[长期行为](@entry_id:192358)的本质，以及它如何与空间边界相互作用。为了解决这一认知上的差距，概率论学家发展了一套基于**标度函数 (scale function)** 和 **速度测度 (speed measure)** 的典范理论，为理解[一维扩散](@entry_id:181320)提供了更为深刻和直观的视角。

本文旨在全面介绍速度测度这一核心概念。我们将看到，这一测度不仅是一个数学构造，更是一个物理意义丰富的工具，它量化了[扩散过程](@entry_id:170696)的“内在时钟”和空间占据特性。通过学习速度测度，读者将能够超越SDE的表面形式，洞察决定过程长期动态和边界行为的根本机制。

在接下来的章节中，我们将系统地探索这一强大框架。**“原理与机制”**一章将深入推导标度函数与速度测度的定义，并阐明它们与[逗留时间](@entry_id:263953)、[稳态分布](@entry_id:149079)及[Feller边界分类](@entry_id:191175)的内在联系。**“应用与跨学科联系”**一章将通过物理学和金融学中的经典模型（如Ornstein-Uhlenbeck和[CIR过程](@entry_id:634094)），展示该理论在分析[首中时](@entry_id:266524)间、[稳态](@entry_id:182458)和边界分类方面的实际应用。最后，在**“动手实践”**部分，你将有机会通过解决具体问题来巩固和应用所学知识，从而真正掌握这一分析工具。

## 原理与机制

在[一维扩散](@entry_id:181320)过程的研究中，我们经常遇到由[随机微分方程](@entry_id:146618)（SDE）定义的模型：
$$
dX_t = b(X_t) dt + \sigma(X_t) dW_t
$$
其中 $b(x)$ 是[漂移系数](@entry_id:199354)，$\sigma(x)$ 是[扩散](@entry_id:141445)系数。虽然这个形式对于模拟和应用[Itô公式](@entry_id:634674)很方便，但它可能掩盖了过程更深层次的结构特性。为了揭示这些特性，概率论学家，特别是William Feller、Itô Kiyoshi和Henry McKean，发展了一套强大的理论，该理论使用一对基本对象——**标度函数（scale function）** $s$ 和**速度测度（speed measure）** $m$ 来重新刻画扩散过程。

本章旨在阐述标度函数与速度测度的原理和机制。我们将看到，这对组合 $(s, m)$ 不仅唯一地确定了[扩散过程](@entry_id:170696)的内部动态（除去边界行为），而且为我们提供了一种深刻的物理直观，用以理解过程在不同区域花费的时间、其长期[稳态](@entry_id:182458)行为以及边界的性质。

### [一维扩散](@entry_id:181320)的典范表述

让我们从一个定义在开区间 $I \subseteq \mathbb{R}$ 上的正则[一维扩散](@entry_id:181320) $X_t$ 开始。其[无穷小生成元](@entry_id:270424) $L$ 作用于二次连续可微的检验函数 $f$ 上，形式为：
$$
L f(x) = \frac{1}{2} \sigma^2(x) f''(x) + b(x) f'(x)
$$
这个算子包含了[漂移和扩散](@entry_id:148816)的所有信息。我们的目标是将其转化为一个更具结构性的典范形式。

#### 标度函数与速度测度的定义

该理论的核心思想是，存在一个**标度函数** $s(x)$ 和一个**速度测度** $m(dx)$，使得生成元 $L$ 可以被写成一个广义的[Sturm-Liouville算子](@entry_id:171782)形式：
$$
L f = \frac{d}{dm} \left( \frac{d f}{ds} \right)
$$
[@problem_id:3074973] 这是一个深刻的结论。这里的导数是针对函数 $s$ 和测度 $m$ 定义的。对于一个[光滑函数](@entry_id:267124) $g$，其定义为：
$$
\frac{d g}{ds}(x) := \frac{g'(x)}{s'(x)}, \quad \frac{d g}{dm}(x) := \frac{g'(x)}{m'(x)}
$$
其中 $m'(x)$ 是速度测度关于[勒贝格测度](@entry_id:139781)的密度。

通过将这两种生成元表达式等同起来，我们可以推导出 $s(x)$ 和 $m(x)$ 的具体形式。首先，标度函数 $s(x)$ 被定义为一个严格递增的 $C^2$ 函数，它满足[齐次方程](@entry_id:163650) $L s = 0$：
$$
\frac{1}{2} \sigma^2(x) s''(x) + b(x) s'(x) = 0
$$
由于 $s$ 严格递增且 $\sigma^2(x)>0$，我们可以整理得到一个关于 $s'(x)$ 的[一阶常微分方程](@entry_id:264241)：
$$
\frac{s''(x)}{s'(x)} = - \frac{2b(x)}{\sigma^2(x)}
$$
积分后可得：
$$
s'(x) \propto \exp\left( - \int^x \frac{2 b(z)}{\sigma^2(z)} dz \right)
$$
这表明标度函数（在一个正仿射变换 $s \to c_1 s + c_2, c_1>0$ 的意义下）是由漂移与扩散系数之比决定的。[@problem_id:3074962]

一旦确定了标度函数 $s(x)$，我们就可以通过将 $L f$ 的两种形式进行比较来确定速度测度的密度 $m'(x)$。将典范形式展开：
$$
L f = \frac{1}{m'(x)s'(x)}f''(x) - \frac{s''(x)}{m'(x)(s'(x))^2}f'(x)
$$
与 $L f(x) = \frac{1}{2}\sigma^2(x)f''(x) + b(x)f'(x)$ 逐项比较系数，我们得到：
$$
\frac{1}{m'(x)s'(x)} = \frac{1}{2}\sigma^2(x) \quad \implies \quad m'(x) = \frac{2}{\sigma^2(x) s'(x)}
$$
这个表达式给出了速度测度的密度。由于 $\sigma^2(x)>0$ 且 $s'(x)>0$，速度测度密度 $m'(x)$ 总是正的，这符合测度的要求。[@problem_id:3074962] [@problem_id:3074973]

这个 $(s, m)$ 框架的强大之处在于其唯一性。一个[一维扩散](@entry_id:181320)过程的定律，连同其在区间端点的边界行为，被其标度函数（在[仿射变换](@entry_id:144885)下的等价类）和速度测度（在正常数因子下的等价类）完全唯一地确定。[@problem_id:3074973]

### 自然标度与速度测度的诠释

为了更好地理解标度函数和速度测度的作用，让我们考虑一个重要的特殊情况：**自然标度（natural scale）**。

#### 变换到自然标度

标度函数的一个关键性质是它能够“矫直”扩散过程的漂移。考虑经过变换后的过程 $Y_t = s(X_t)$。根据[Itô公式](@entry_id:634674)，其微分形式为：
$$
dY_t = \left( b(X_t) s'(X_t) + \frac{1}{2} \sigma^2(X_t) s''(X_t) \right) dt + s'(X_t) \sigma(X_t) dW_t
$$
注意到括号中的项正是 $L s(X_t)$。根据标度函数的定义 $L s = 0$，这意味着 $Y_t$ 的漂移项消失了！
$$
dY_t = s'(X_t) \sigma(X_t) dW_t
$$
因此，$Y_t = s(X_t)$ 是一个[连续局部鞅](@entry_id:204638)。根据[Dambis-Dubins-Schwarz定理](@entry_id:198595)，任何[连续局部鞅](@entry_id:204638)都可以通过[时间变换](@entry_id:634205)变为一个标准布朗运动。定义[时间变换](@entry_id:634205) $A_t = \langle Y \rangle_t = \int_0^t s'(X_u)^2 \sigma^2(X_u) du$，则 $B_t = Y_{\tau_t}$（其中 $\tau_t$ 是 $A_t$ 的右连续逆）是一个[标准布朗运动](@entry_id:197332)。[@problem_id:3074962]

#### 自然标度下的速度测度

当一个扩散过程本身就是一个[局部鞅](@entry_id:186755)时（即漂移 $b(x) \equiv 0$），我们称该过程处于其**自然标度**。在这种情况下，我们可以简单地取标度函数为 $s(x) = x$（因为 $L s = \frac{1}{2}\sigma^2(x) \cdot 0 + 0 \cdot 1 = 0$ 成立）。此时，生成元简化为 $L f(x) = \frac{1}{2}\sigma^2(x) f''(x)$。[@problem_id:3074965]

在自然标度下，速度测度的密度表达式变得异常简洁。代入 $s'(x)=1$ 到通用公式中，我们得到：
$$
m'(x) = \frac{2}{\sigma^2(x)}
$$
[@problem_id:3074965] [@problem_id:3074973] 这个简单的关系为我们理解速度测度提供了第一个关键直观：**速度测度密度与[扩散](@entry_id:141445)系数的平方成反比**。如果在一个区域 $\sigma^2(x)$ 很大，意味着过程在该处有很强的随机波动，那么 $m'(x)$ 就很小。反之，如果 $\sigma^2(x)$ 很小，过程在该处波动较弱，那么 $m'(x)$ 就很大。这暗示了过程在波动性较弱的地方“移动得更慢”，花费的时间更多。

### 速度测度与[逗留时间](@entry_id:263953)

上面关于“慢”与“快”的直观感觉可以通过**[逗留时间](@entry_id:263953)（occupation time）**的概念变得精确。速度测度的核心物理意义在于，它量化了[扩散过程](@entry_id:170696)在空间不同位置花费时间的倾[向性](@entry_id:144651)。

考虑一个一般的函数 $g(x)$，我们感兴趣的是它在过程路径上的时间累积量，即逗留时间泛函：
$$
A_t := \int_0^t g(X_s) ds
$$
这个量可以通过**[局部时](@entry_id:194383)（local time）** $L_t^y$ 来表示。[局部时](@entry_id:194383) $L_t^y$ 可以被非正式地理解为到时刻 $t$ 为止，过程 $X_s$ 访问点 $y$ 的“次数”或“密度”。

逗留时间、局部时和速度测度之间的基本关系由**[逗留时间公式](@entry_id:634597)**给出：
$$
\int_0^t g(X_s) ds = \int_I g(y) L_t^y m(dy) = \int_I g(y) L_t^y m'(y) dy
$$
[@problem_id:3074937] 这个公式是理解速度测度的关键。它表明，在时刻 $t$ 之前，过程在点 $y$ 的[局部时](@entry_id:194383) $L_t^y$ 对总逗留时间的贡献是被速度测度密度 $m'(y)$ 加权的。换言之，$m'(y)$ 越大，意味着过程在 $y$ 点附近越“黏滞”，单位[局部时](@entry_id:194383)会转化为更多的时钟时间。因此，过程倾向于在速度测度密度大的区域花费更多的时间。

这个公式的严格推导涉及到不同[局部时](@entry_id:194383)标准化之间的关系。对于一个[连续半鞅](@entry_id:636909) $X_t$，其关于二次变差 $\langle X \rangle$ 的逗留密度公式为 $\int_0^t g(X_s)d\langle X \rangle_s=\int_I g(y)\ell_t^y dy$，其中 $\ell_t^y$ 是对称的（Tanaka）[局部时](@entry_id:194383)。对于我们的SDE， $d\langle X \rangle_t = \sigma^2(X_t) dt$。通过巧妙地选择函数 $g$ 并进行比较，可以证明[扩散](@entry_id:141445)理论中的[局部时](@entry_id:194383) $L_t^y$ 与[半鞅](@entry_id:184490)局部时 $\ell_t^y$ 的关系为 $L_t^y = \frac{1}{2}\ell_t^y$，同时再次确认了速度测度密度为 $m'(x) = 2/\sigma^2(x)$（在自然标度下）。[@problem_id:3074934]

### 速度测度与[稳态](@entry_id:182458)行为

速度测度不仅描述了过程的瞬时行为，它还决定了过程的长期渐近行为，特别是其**[平稳分布](@entry_id:194199)（stationary distribution）**。这种联系强烈地依赖于区间的边界条件。

#### [反射边界](@entry_id:634534)与平稳分布

考虑一个在闭区间 $[a,b]$ 上运动且在端点处**反射（reflecting）**的[扩散过程](@entry_id:170696)。反射意味着过程到达边界后会被“推回”到区间内部，不会丢失概率质量。对于这样一个过程，我们期望存在一个**不变测度（invariant measure）**或平稳[概率分布](@entry_id:146404) $\pi$。

[不变测度](@entry_id:202044)的定义是，对于[生成元定义域](@entry_id:202398) $D(L)$ 中的所有函数 $f$（对于[反射边界](@entry_id:634534)，通常要求满足[Neumann边界条件](@entry_id:142124) $f'(a)=f'(b)=0$），都有 $\int Lf(x) \pi(dx) = 0$。这等价于平稳的[Fokker-Planck方程](@entry_id:140155) $L^*\pi = 0$，其中 $L^*$ 是 $L$ 的 adjoint 算子。[@problem_id:3074933]

对于[反射边界](@entry_id:634534)，该方程的物理意义是**[概率流](@entry_id:150949)（probability flux）**在[稳态](@entry_id:182458)时为零。求解零流条件可以得到平稳[概率密度](@entry_id:175496) $p(x)$：
$$
p(x) \propto \frac{1}{\sigma^2(x)} \exp\left( \int^x \frac{2b(y)}{\sigma^2(y)} dy \right)
$$
回顾标度函数的导数 $s'(x) \propto \exp( - \int^x \frac{2 b(z)}{\sigma^2(z)} dz )$，我们可以将上式重写为：
$$
p(x) \propto \frac{1}{\sigma^2(x) s'(x)}
$$
这与我们之前导出的速度测度密度 $m'(x) = \frac{2}{\sigma^2(x)s'(x)}$ 成正比。因此，我们得到了一个极为重要的结论：**对于具有[反射边界](@entry_id:634534)的[扩散过程](@entry_id:170696)，其平稳概率密度正比于速度测度的密度。**[@problem_id:3074938]

这意味着，过程在长期看来花费时间最多的地方，正是速度测度密度最大的地方。这也完美印证了速度测度作为“[逗留时间](@entry_id:263953)密度”的诠释。一个平稳的*概率*测度存在当且仅当总的速度测度是有限的，即 $\int_a^b m(dx)  \infty$。此时，归一化常数就是总速度测度的倒数。[@problem_id:3074938]

#### [吸收边界](@entry_id:201489)与准平稳分布

现在考虑一个在[开区间](@entry_id:157577) $(l,r)$ 上运动，但在边界处被**吸收（absorbing）**的过程。一旦碰到边界，过程就“死亡”了。在这种情况下，无论初始[分布](@entry_id:182848)如何，经过足够长的时间，所有粒子最终都会被吸收，区间内的总概率质量会趋于零。因此，**不存在平稳[概率分布](@entry_id:146404)**。[@problem_id:3074926]

然而，即使没有真正的平[稳态](@entry_id:182458)，我们仍然可以问：在过程尚未被吸收的条件下，它在区间内的[空间分布](@entry_id:188271)会呈现什么形态？这个条件分布被称为**准平稳分布（quasi-stationary distribution, QSD）**。

速度测度在这里依然扮演着核心角色。可以证明，如果存在一个QSD，它由生成元 $L$ 的主[特征函数](@entry_id:186820) $\eta$ （满足[Dirichlet边界条件](@entry_id:142800) $\eta(l)=\eta(r)=0$）决定。具体而言，QSD测度 $\nu$ 的形式为：
$$
d\nu(x) \propto \eta(x) m(dx)
$$
其中 $m(dx)$ 是速度测度。这表明，即使在有吸收的情况下，描述长期条件行为的QSD也是由主特征函数 $\eta$ 对速度测度进行加权得到的。速度测度依然是描述过程空间行为的那个“背景画布”。[@problem_id:3074926]

### 速度测度的推广与边界行为

$(s,m)$ 框架的真正威力在于其普适性，它能够统一描述所有可能的[一维扩散](@entry_id:181320)行为，包括各种复杂的边界现象。

#### [Feller边界分类](@entry_id:191175)

[边界点](@entry_id:176493)的性质（过程是否能到达边界？能否从边界离开？）可以完全由标度函数和速度测度在边界附近的行为来刻画。**Feller的边界分类**将每个边界点（例如左端点 $l$）分为四种类型：正则（regular）、出口（exit）、入口（entrance）或自然（natural）。这个分类依赖于两个关键积分的敛散性：
$$
I_l = \int_{l}^{x_0} (s(x_0) - s(y)) m(dy), \quad J_l = \int_{l}^{x_0} (s(y) - s(l)) m(dy)
$$
其中 $x_0$ 是区间内的一个参考点。例如，一个**正则边界**是指 $I_l$ 和 $J_l$ 都收敛，这意味着过程可以在有限期望时间内到达边界，也可以从边界出发进入区间。一个**自然边界**是指两者都发散，这意味着边界在概率意义上是“遥不可及”的。[@problem_id:3074936] 这个分类方案展示了 $s$ 和 $m$ 的局部性质如何决定了过程的全局行为。

#### 黏滞边界

速度测度甚至不必是关于[勒贝格测度](@entry_id:139781)绝对连续的。它可以在某些点上拥有**原子（atoms）**，即点质量。当速度测度在某个[边界点](@entry_id:176493)（例如 $0$）有一个原子时，例如：
$$
m(dx) = \rho(x) dx + \theta \delta_0(dx), \quad \theta  0
$$
其中 $\delta_0$ 是在 $0$ 点的[狄拉克测度](@entry_id:197577)。这个原子意味着过程在到达 $0$ 点时，会以正的概率“黏”在那里停留一段随机时间，然后再继续运动。这被称为**黏滞边界（sticky boundary）**。

这个测度中的原子会直接反映在生成元的定义域和边界条件上。通过严谨的推导可以发现，对于自然标度下的这种情况，边界条件不再是简单的Neumann型（反射）或Dirichlet型（吸收），而是一种更广义的Wentzell型边界条件：
$$
f'(0+) = \theta Lf(0)
$$
其中 $f$ 是[生成元定义域](@entry_id:202398)中的函数。黏滞程度由原子质量 $\theta$ 直接控制：$\theta$ 越大，过程在边界停留的时间就越长。当 $\theta=0$ 时，该条件退化为标准的[反射边界](@entry_id:634534)条件 $f'(0+)=0$。[@problem_id:3074947] 这清晰地表明，速度测度的结构直接编码了过程在边界上的精细行为。

综上所述，速度测度是一个核心概念，它将扩散过程的随机波动性 ($\sigma^2$)、逗留时间特性以及长期[稳态](@entry_id:182458)行为紧密地联系在一起，并为分析复杂的边界现象提供了统一而强大的数学框架。