{"hands_on_practices": [{"introduction": "本章的第一个练习提供了一个具体的起点，要求你计算一个布朗粒子离开一个简单的一维区间所需的平均时间。通过推导并求解一个简单的常微分方程，你将直接看到一个概率量（期望时间）如何转化为微积分的语言。这项练习是理解随机过程与微分方程之间联系的基础。", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 是一个标准的一维布朗运动，从 $B_{0} = x$ 开始，其中 $x \\in (a,b)$，$a  b$ 是固定的实数。定义从开区间 $D = (a,b)$ 的退出时间为\n$$\n\\tau_{D} := \\inf\\{ t \\geq 0 : B_{t} \\notin (a,b) \\}.\n$$\n考虑函数 $u : (a,b) \\to \\mathbb{R}$，由 $u(x) := \\mathbb{E}_{x}[\\tau_{D}]$ 给出，其中 $\\mathbb{E}_{x}$ 表示在给定 $B_{0} = x$ 的条件下，基于概率测度 $\\mathbb{P}$ 的期望。从随机微积分的基本原理和布朗运动的性质出发，特别是伊藤公式（Itô’s formula）和调和函数的生成元刻画，完成以下任务：\n\n- 通过布朗运动的无穷小生成元来表示直到退出时的预期累积“成本”（时间），从而推导出 $u$ 在 $(a,b)$ 上必须满足的边值问题，包括适当的边界条件。\n- 求解得到的带有导出边界条件的常微分方程（ODE），以获得 $u(x)$ 的一个闭式表达式。\n\n你的最终答案必须是关于 $a$，$b$ 和 $x$ 的单一解析表达式。不需要数值近似，也不涉及物理单位。请提供最终表达式作为你的答案。", "solution": "问题要求推导并求解函数 $u(x) := \\mathbb{E}_{x}[\\tau_{D}]$ 的边值问题，该函数表示标准一维布朗运动从区间 $D = (a,b)$（始于 $x \\in (a,b)$）的预期退出时间。\n\n**第1部分：边值问题的推导**\n\n我们试图找到函数 $u(x) = \\mathbb{E}_{x}[\\tau_{D}]$ 必须满足的微分方程。一个普遍的原理（可以通过伊藤公式推导）是，对于成本函数 $f(x)$，在退出前累积的预期总成本 $v(x) = \\mathbb{E}_x[\\int_0^{\\tau_D} f(B_t) dt]$ 满足泊松方程 $\\mathcal{L}v(x) = -f(x)$，其中 $\\mathcal{L}$ 是过程的无穷小生成元。\n\n对于标准一维布朗运动，其生成元为 $\\mathcal{L} = \\frac{1}{2}\\frac{d^2}{dx^2}$。在我们的问题中，$u(x)$ 是预期退出时间，可以表示为累积成本，其中成本率恒为1，即 $f(x)=1$。因此，我们有：\n$$\nu(x) = \\mathbb{E}_x[\\tau_D] = \\mathbb{E}_x\\left[\\int_0^{\\tau_D} 1 \\, dt\\right]\n$$\n应用上述原理，函数 $u(x)$ 必须满足方程：\n$$\n\\frac{1}{2}u''(x) = -1\n$$\n即：\n$$\nu''(x) = -2\n$$\n接下来，我们建立边界条件。退出时间 $\\tau_D$ 被定义为过程首次 *不* 在开区间 $(a,b)$ 内的时间。如果过程从某个边界开始，即 $x=a$ 或 $x=b$，那么在 $t=0$ 时它就已经在开区间之外了。因此，时间 $t \\geq 0$ 的下确界是 $t=0$。\n这意味着：\n$$\nu(a) = \\mathbb{E}_{a}[\\tau_{D}] = 0\n$$\n$$\nu(b) = \\mathbb{E}_{b}[\\tau_{D}] = 0\n$$\n因此，我们得到了一个完整的边值问题（BVP）：\n$$\n\\begin{cases}\nu''(x) = -2 \\quad \\text{for } x \\in (a,b) \\\\\nu(a) = 0 \\\\\nu(b) = 0\n\\end{cases}\n$$\n\n**第2部分：边值问题的求解**\n\n我们通过直接积分来求解这个常微分方程。将 $u''(x) = -2$ 对 $x$ 积分一次，得到：\n$$\nu'(x) = -2x + C_1\n$$\n其中 $C_1$ 是一个积分常数。再次积分得到 $u(x)$ 的通解：\n$$\nu(x) = -x^2 + C_1x + C_2\n$$\n其中 $C_2$ 是第二个积分常数。\n\n我们使用边界条件来确定常数 $C_1$ 和 $C_2$。\n应用 $u(a) = 0$：\n$$\n-a^2 + C_1a + C_2 = 0 \\quad (1)\n$$\n应用 $u(b) = 0$：\n$$\n-b^2 + C_1b + C_2 = 0 \\quad (2)\n$$\n我们得到了一个关于 $C_1$ 和 $C_2$ 的二元线性方程组。用方程（2）减去方程（1）：\n$$\n(-b^2 - (-a^2)) + (C_1b - C_1a) + (C_2 - C_2) = 0\n$$\n$$\na^2 - b^2 + C_1(b - a) = 0\n$$\n对平方差进行因式分解，$(a-b)(a+b) = a^2 - b^2$：\n$$\n(a - b)(a + b) - C_1(a - b) = 0\n$$\n因为 $a  b$，我们知道 $a-b \\neq 0$，所以我们可以除以 $(a-b)$：\n$$\na + b - C_1 = 0 \\implies C_1 = a + b\n$$\n现在，将 $C_1$ 的值代回方程（1）：\n$$\n-a^2 + (a+b)a + C_2 = 0\n$$\n$$\n-a^2 + a^2 + ab + C_2 = 0\n$$\n$$\nab + C_2 = 0 \\implies C_2 = -ab\n$$\n找到了常数 $C_1 = a+b$ 和 $C_2 = -ab$ 后，我们将它们代入 $u(x)$ 的通解中：\n$$\nu(x) = -x^2 + (a+b)x - ab\n$$\n这个表达式可以通过因式分解来简化。让我们提出一个负号：\n$$\nu(x) = -(x^2 - (a+b)x + ab)\n$$\n括号内的二次表达式的根是 $a$ 和 $b$。因此，它可以被因式分解为 $(x-a)(x-b)$。\n$$\nu(x) = -(x-a)(x-b)\n$$\n重新整理成一个更直观的形式，对于 $x \\in (a,b)$，该形式显然是正的：\n$$\nu(x) = (x-a)(b-x)\n$$\n这就是预期退出时间的闭式表达式。", "answer": "$$\n\\boxed{(x-a)(b-x)}\n$$", "id": "3074769"}, {"introduction": "在计算了平均出射时间之后，这个练习将探讨如何为更一般的边界条件找到解。你将运用强大的鞅可选停止定理来确定粒子在特定端点出射的概率，这是用概率方法解决狄利克雷问题的关键。这个练习突出了鞅在这套理论中的基础性作用。", "problem": "设 $a>0$ 并考虑开区间 $D=(0,a)$。设 $\\{B_{t}\\}_{t\\geq 0}$ 是一维标准布朗运动（也称为维纳过程），满足 $B_{0}=x\\in(0,a)$，并设其首次出时 $D$ 为停时\n$$\n\\tau:=\\inf\\{t\\geq 0:\\,B_{t}\\notin(0,a)\\}.\n$$\n定义边界函数 $f:\\partial D\\to\\mathbb{R}$ 为 $f(y)=y^{2}$，因此 $f(0)=0$ 且 $f(a)=a^{2}$。利用狄利克雷问题的解通过布朗运动的概率表示，即 $u(x)=\\mathbb{E}_{x}\\!\\left[f\\!\\left(B_{\\tau}\\right)\\right]$，结合鞅的可选停止定理 (OST)，来显式确定 $u(x)$。\n\n你的任务是：\n- 从布朗运动和鞅的基本性质（包括伊藤公式）出发，识别出由 $B_{t}$ 导出的鞅。\n- 通过验证适当的可积性和有界性条件，仔细论证为什么可选停止定理适用于在 $\\tau$ 处停止的过程。\n- 使用 OST 计算 $\\mathbb{P}_{x}(B_{\\tau}=a)$ 并推导出 $u(x)=\\mathbb{E}_{x}[f(B_{\\tau})]$。\n\n请以包含 $a$ 和 $x$ 的单一闭式解析表达式给出最终答案。不需要进行数值四舍五入。", "solution": "该问题要求使用概率方法，特别是可选停止定理，来求解狄利克雷问题。问题的解 $u(x)$ 是在边界函数 $f(y)=y^2$ 下，布朗运动首次离开区间 $(0,a)$ 时位置的期望值，即 $u(x) = \\mathbb{E}_x[f(B_\\tau)] = \\mathbb{E}_x[B_\\tau^2]$。\n\n**步骤 1: 将问题分解**\n\n根据期望的定义，我们可以将 $u(x)$ 的计算分解。布朗运动从区间 $(0,a)$ 首次离开时，其位置 $B_\\tau$ 只能是 $0$ 或 $a$。因此，我们可以使用全期望公式：\n$$\nu(x) = \\mathbb{E}_x[B_\\tau^2] = f(a) \\cdot \\mathbb{P}_x(B_\\tau = a) + f(0) \\cdot \\mathbb{P}_x(B_\\tau = 0)\n$$\n其中 $\\mathbb{P}_x(B_\\tau = y)$ 是从 $x$ 出发的布朗运动首次在端点 $y$ 离开的概率。\n代入已知的边界函数值 $f(a)=a^2$ 和 $f(0)=0^2=0$，上式简化为：\n$$\nu(x) = a^2 \\cdot \\mathbb{P}_x(B_\\tau = a)\n$$\n因此，核心任务是计算概率 $\\mathbb{P}_x(B_\\tau = a)$。\n\n**步骤 2: 利用鞅和可选停止定理计算出射概率**\n\n为了计算出射概率，我们利用一个基本事实：标准一维布朗运动 $\\{B_t\\}_{t \\geq 0}$ 本身是一个鞅。\n\n考虑在停时 $\\tau$ 停止的过程 $\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$。\n- **停时**：$\\tau = \\inf\\{t \\ge 0: B_t \\notin (0,a)\\}$ 是一个几乎必然有限的停时，因为布朗运动以概率1会离开任何有界区间。\n- **鞅的有界性**：对于所有 $t \\geq 0$，停止的布朗运动 $B_{t \\wedge \\tau}$ 的值始终位于闭区间 $[0,a]$ 内。因此，$\\{B_{t \\wedge \\tau}\\}_{t \\geq 0}$ 是一个有界鞅。\n- **一致可积性**：一个有界鞅总是一致可积的。\n\n由于这些条件满足，我们可以对鞅 $\\{B_{t \\wedge \\tau}\\}$ 应用可选停止定理 (Optional Stopping Theorem, OST)。该定理指出 $\\mathbb{E}_x[B_\\tau] = \\mathbb{E}_x[B_0]$。\n根据初始条件，$B_0 = x$，所以我们有：\n$$\n\\mathbb{E}_x[B_\\tau] = x\n$$\n我们再次使用全期望公式来展开左侧：\n$$\n\\mathbb{E}_x[B_\\tau] = a \\cdot \\mathbb{P}_x(B_\\tau = a) + 0 \\cdot \\mathbb{P}_x(B_\\tau = 0) = a \\cdot \\mathbb{P}_x(B_\\tau = a)\n$$\n将两个结果结合起来，我们得到：\n$$\na \\cdot \\mathbb{P}_x(B_\\tau = a) = x\n$$\n解出概率：\n$$\n\\mathbb{P}_x(B_\\tau = a) = \\frac{x}{a}\n$$\n这与我们的直觉相符：起始点 $x$ 越接近 $a$，从 $a$ 离开的概率就越大。\n\n**步骤 3: 计算最终解**\n\n现在我们将此概率代入步骤 1 中得到的 $u(x)$ 的表达式：\n$$\nu(x) = a^2 \\cdot \\mathbb{P}_x(B_\\tau = a) = a^2 \\cdot \\left(\\frac{x}{a}\\right) = ax\n$$\n这就是狄利克雷问题的解。我们可以验证它是否满足条件：\n- **微分方程**: $u''(x) = (ax)'' = 0$，满足拉普拉斯方程。\n- **边界条件**: $u(0) = a \\cdot 0 = 0$ (与 $f(0)=0^2=0$ 匹配)，$u(a) = a \\cdot a = a^2$ (与 $f(a)=a^2$ 匹配)。\n\n所有条件均满足。因此，最终的解析表达式为 $ax$。", "answer": "$$\\boxed{ax}$$", "id": "3074772"}, {"introduction": "我们最后的练习将第一个练习中的概念提升到多维空间。你将计算从一个$d$维球体中的平均出射时间，展示相同的原理如何在更复杂的几何环境中应用。这个问题强调了对称性在简化源于随机过程的偏微分方程时的强大威力。", "problem": "设 $\\{B_{t}\\}_{t \\geq 0}$ 为标准的 $d$ 维布朗运动，其无穷小生成元为 $(1/2)\\Delta$，其中 $\\Delta$ 表示 $\\mathbb{R}^{d}$ 上的拉普拉斯算子。对于一个开有界区域 $D \\subset \\mathbb{R}^{d}$，其边界 $\\partial D$ 为 $C^{2}$ 类，定义首次出时 $\\tau_{D} := \\inf\\{t \\geq 0 : B_{t} \\notin D\\}$ 和函数 $u(x) := \\mathbb{E}_{x}[\\tau_{D}]$（对于 $x \\in D$），其中 $\\mathbb{E}_{x}$ 表示在 $B_{0} = x$ 条件下的期望。\n\n从伊藤公式和布朗运动的无穷小生成元 $(1/2)\\Delta$ 的定义出发，推导 $u(x)$ 在 $D$ 内部满足的边值问题以及在 $\\partial D$ 上的边界条件。利用此结果证明对于任何有界区域 $D$，$u(x)$ 都是有限的。然后，取 $D$ 为半径为 $R > 0$ 的球 $B(0,R) := \\{x \\in \\mathbb{R}^{d} : |x|  R\\}$，并通过利用球对称性求解得到的狄利克雷问题，求出 $u(x) = \\mathbb{E}_{x}[\\tau_{B(0,R)}]$ 关于 $R$、$|x|$ 和 $d$ 的闭式解析表达式。\n\n将最终答案表示为单个闭式解析表达式。无需四舍五入。", "solution": "该问题分三部分：推导平均出时 $u(x) = \\mathbb{E}_{x}[\\tau_{D}]$ 满足的边值问题 (BVP)，证明其有限性，并针对 $d$ 维球的特定情况求解此 BVP。\n\n**第一部分：边值问题的推导**\n\n函数 $u(x)$ 是从 $x \\in D$ 出发的布朗运动的平均出时。一个普遍的结论是，$u(x)$ 满足泊松方程 $\\frac{1}{2}\\Delta u(x) = -1$。\n\n边界条件源于 $u(x)$ 的定义。如果起点 $x$ 在边界 $\\partial D$ 上，则过程已经位于开区域 $D$ 之外，因此首次出时为 $\\tau_D = 0$。于是，对于 $x \\in \\partial D$，有 $u(x) = \\mathbb{E}_x[0] = 0$。\n\n为了正式推导该偏微分方程，假设 BVP $\\frac{1}{2}\\Delta v = -1$ 在 $D$ 内且 $v|_{\\partial D}=0$ 存在唯一解 $v(x)$。对过程 $v(B_t)$ 应用伊藤公式，并在停时 $t \\wedge \\tau_D$ 处停止：\n$$v(B_{t \\wedge \\tau_D}) - v(B_0) = \\int_0^{t \\wedge \\tau_D} \\nabla v(B_s) \\cdot dB_s + \\int_0^{t \\wedge \\tau_D} \\frac{1}{2}\\Delta v(B_s) ds$$\n对于 $s  \\tau_D$，$B_s \\in D$，因此 $\\frac{1}{2}\\Delta v(B_s) = -1$。代入并设 $B_0=x$：\n$$v(B_{t \\wedge \\tau_D}) - v(x) = \\int_0^{t \\wedge \\tau_D} \\nabla v(B_s) \\cdot dB_s - (t \\wedge \\tau_D)$$\n对两边取期望 $\\mathbb{E}_x$。在适当的条件下，伊藤积分项的期望为零。因此：\n$$\\mathbb{E}_x[v(B_{t \\wedge \\tau_D})] - v(x) = -\\mathbb{E}_x[t \\wedge \\tau_D]$$\n在 $t \\to \\infty$ 的极限下，由于布朗运动几乎必然离开有界区域 $D$，我们有 $t \\wedge \\tau_D \\to \\tau_D$。同时，$B_{t \\wedge \\tau_D} \\to B_{\\tau_D} \\in \\partial D$，因此 $v(B_{t \\wedge \\tau_D}) \\to v(B_{\\tau_D}) = 0$。通过单调收敛和控制收敛定理，我们可以将极限移入期望内部，得到：\n$$0 - v(x) = -\\mathbb{E}_x[\\tau_D]$$\n因此，$v(x) = \\mathbb{E}_x[\\tau_D] = u(x)$。这证明了 $u(x)$ 确实是 BVP 的解：\n$$\n\\begin{cases}\n\\Delta u(x) = -2  \\text{for } x \\in D \\\\\nu(x) = 0  \\text{for } x \\in \\partial D\n\\end{cases}\n$$\n\n**第二部分：$u(x)$ 的有限性**\n\n根据椭圆型偏微分方程理论，对于具有足够光滑（如 $C^2$）边界的有界区域 $D$，上述泊松方程存在一个属于 $C^2(D) \\cap C(\\bar{D})$ 的唯一解。一个在紧集（这里是闭包 $\\bar{D}$）上连续的函数必定是有界的。因此，对于所有 $x \\in \\bar{D}$，$u(x)$ 必定是有限的。\n\n**第三部分：球 $D = B(0,R)$ 的解**\n\n我们现在求解区域为以原点为中心、半径为 $R$ 的 $d$ 维球的特定问题：$D = B(0,R) = \\{x \\in \\mathbb{R}^d : |x|  R\\}$。\n鉴于区域和边界条件的球对称性，解 $u(x)$ 必定只依赖于径向距离 $r = |x|$。因此，我们寻求形式为 $u(x) = f(r)$ 的解。\n在 $d$ 维球坐标中，作用于径向函数 $f(r)$ 的拉普拉斯算子为：\n$$\\Delta u = f''(r) + \\frac{d-1}{r}f'(r)$$\n该偏微分方程变为关于 $f(r)$ 的常微分方程 (ODE)：\n$$f''(r) + \\frac{d-1}{r}f'(r) = -2, \\quad \\text{for } 0 \\leq r  R$$\n边界条件是 $f(R) = 0$。此外，为了使解 $u(x)$ 在原点处是光滑的，其在 $x=0$ 处的梯度必须为零，这意味着 $f'(0) = 0$。\n\n设 $g(r) = f'(r)$。该常微分方程变为关于 $g(r)$ 的一阶线性方程：\n$$g'(r) + \\frac{d-1}{r}g(r) = -2$$\n积分因子是 $I(r) = \\exp\\left(\\int \\frac{d-1}{r} dr\\right) = r^{d-1}$。将常微分方程乘以积分因子：\n$$\\frac{d}{dr}\\left(r^{d-1}g(r)\\right) = -2r^{d-1}$$\n对 $r$ 积分：\n$$r^{d-1}g(r) = \\int -2r^{d-1} dr = -2\\frac{r^d}{d} + C_1$$\n解出 $g(r)$：\n$$g(r) = f'(r) = -\\frac{2r}{d} + C_1r^{1-d}$$\n应用正则性条件 $f'(0)=0$。对于 $d > 1$，当 $r \\to 0$ 时，项 $C_1r^{1-d}$ 是奇异的，除非 $C_1=0$。对于 $d=1$，$f'(0)=C_1=0$。因此，必须有 $C_1=0$。\n这将导数简化为：\n$$f'(r) = -\\frac{2r}{d}$$\n对 $f'(r)$ 积分以求得 $f(r)$：\n$$f(r) = \\int -\\frac{2r}{d} dr = -\\frac{r^2}{d} + C_2$$\n使用边界条件 $f(R)=0$ 来确定 $C_2$：\n$$0 = f(R) = -\\frac{R^2}{d} + C_2 \\implies C_2 = \\frac{R^2}{d}$$\n将 $C_2$ 代回，我们得到 $f(r)$ 的表达式：\n$$f(r) = \\frac{R^2}{d} - \\frac{r^2}{d} = \\frac{R^2 - r^2}{d}$$\n由于 $u(x) = f(|x|)$，用 $x$ 表示的解为：\n$$u(x) = \\frac{R^2 - |x|^2}{d}$$\n这个表达式表示从位置 $x$ 开始的布朗运动，从半径为 $R$ 的 $d$ 维球中首次出时的平均时间。", "answer": "$$\\boxed{\\frac{R^2 - |x|^2}{d}}$$", "id": "3074767"}]}