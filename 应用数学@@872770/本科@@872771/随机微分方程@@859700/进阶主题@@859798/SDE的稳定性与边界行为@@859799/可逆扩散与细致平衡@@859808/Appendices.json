{"hands_on_practices": [{"introduction": "理论学习的最佳方式之一是将其应用于具体的、基础性的例子。本练习聚焦于随机过程中的一个核心模型——Ornstein–Uhlenbeck (OU) 过程。通过从头开始推导其转移概率密度并验证细致平衡条件，您将深入理解可逆性在数学上的精确含义，并为更复杂的系统建立坚实的直觉。[@problem_id:3072636]", "problem": "考虑一维Ornstein–Uhlenbeck (OU) 过程，它被定义为以下线性随机微分方程 (SDE) 的唯一强解，\n$$\n\\mathrm{d}X_t = -\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t, \\qquad X_0 = x \\in \\mathbb{R},\n$$\n其中 $\\gamma>0$ 和 $\\sigma>0$ 是常数，$(W_t)_{t\\ge 0}$ 是一维标准布朗运动。从随机微积分的核心原理以及线性随机微分方程的性质出发，完成以下任务：\n\n1. 推导作用于有界可测检验函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 的马尔可夫半群 $(P_t)_{t\\ge 0}$ 的显式表达式，其定义为\n$$\n(P_t f)(x) = \\mathbb{E}_x[f(X_t)],\n$$\n通过求出转移密度核 $p_t(x,y)$，使得\n$$\n(P_t f)(x) = \\int_{\\mathbb{R}} f(y)\\, p_t(x,y)\\,\\mathrm{d}y.\n$$\n\n2. 识别此过程的不变概率密度 $\\pi(y)$，并利用你推导出的转移密度，通过检验对称关系来验证细致平衡条件\n$$\n\\pi(x)\\, p_t(x,y) = \\pi(y)\\, p_t(y,x) \\quad \\text{for all } x,y \\in \\mathbb{R}, \\; t>0.\n$$\n\n你的最终答案必须是 OU 过程的转移密度 $p_t(x,y)$ 的一个单一闭式解析表达式。不需要进行数值取整。", "solution": "问题陈述已经过验证，被认为是合理的。这是一个随机微分方程理论中的适定问题，具体涉及 Ornstein–Uhlenbeck 过程、其转移动态及其平衡性质。该问题具有科学依据，是自洽且客观的。我们现在可以进行形式化推导。\n\n问题围绕一维 Ornstein–Uhlenbeck (OU) 过程展开，该过程是以下线性随机微分方程 (SDE) 的解：\n$$\n\\mathrm{d}X_t = -\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t, \\qquad X_0 = x\n$$\n其中 $\\gamma > 0$ 和 $\\sigma > 0$ 是正常数。\n\n**1. 转移密度 $p_t(x,y)$ 的推导**\n\n为了求出转移密度，我们首先求解 $X_t$ 的随机微分方程。这是一个线性 SDE，可以使用积分因子法求解。我们定义一个积分因子 $I_t = \\exp(\\gamma t)$。考虑过程 $Y_t = I_t X_t = \\exp(\\gamma t) X_t$。对微分 $\\mathrm{d}Y_t = \\mathrm{d}(\\exp(\\gamma t) X_t)$ 使用 Itô 乘积法则：\n$$\n\\mathrm{d}Y_t = (\\mathrm{d}\\exp(\\gamma t))X_t + \\exp(\\gamma t)\\mathrm{d}X_t\n$$\n由于 $\\exp(\\gamma t)$ 是时间的确定性函数，其微分为 $\\mathrm{d}\\exp(\\gamma t) = \\gamma \\exp(\\gamma t)\\,\\mathrm{d}t$。代入此式以及 $\\mathrm{d}X_t$ 的 SDE：\n$$\n\\mathrm{d}Y_t = (\\gamma \\exp(\\gamma t) X_t) \\,\\mathrm{d}t + \\exp(\\gamma t) (-\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t)\n$$\n包含 $X_t \\,\\mathrm{d}t$ 的项相互抵消：\n$$\n\\mathrm{d}Y_t = \\gamma \\exp(\\gamma t) X_t \\,\\mathrm{d}t - \\gamma \\exp(\\gamma t) X_t \\,\\mathrm{d}t + \\sigma \\exp(\\gamma t) \\,\\mathrm{d}W_t = \\sigma \\exp(\\gamma t) \\,\\mathrm{d}W_t\n$$\n从 $s=0$ 到 $s=t$ 进行积分：\n$$\nY_t - Y_0 = \\int_0^t \\sigma \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\n将 $Y_t = \\exp(\\gamma t) X_t$ 和 $Y_0 = \\exp(0) X_0 = x$ 代回：\n$$\n\\exp(\\gamma t) X_t - x = \\sigma \\int_0^t \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\n求解 $X_t$ 得到显式解：\n$$\nX_t = x \\exp(-\\gamma t) + \\sigma \\exp(-\\gamma t) \\int_0^t \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\n这可以通过在随机积分中改变积分变量来重写：\n$$\nX_t = x \\exp(-\\gamma t) + \\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\n$$\n根据这个表达式，我们可以确定在 $X_0 = x$ 条件下 $X_t$ 的分布。第一项 $x \\exp(-\\gamma t)$ 是确定性的。第二项是具有确定性被积函数的 Itô 积分。Itô 积分的一个关键性质是，对于一个平方可积的确定性函数 $g(s)$，随机变量 $I = \\int_0^t g(s) \\,\\mathrm{d}W_s$ 是一个高斯随机变量，其均值为 $0$，方差为 $\\int_0^t g(s)^2 \\,\\mathrm{d}s$。\n\n因此，$X_t$ 是一个高斯随机变量，因为它是一个常数与一个高斯随机变量之和。其条件均值为：\n$$\n\\mathbb{E}[X_t | X_0 = x] = \\mathbb{E}[x \\exp(-\\gamma t)] + \\mathbb{E}\\left[\\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right] = x \\exp(-\\gamma t) + 0 = x \\exp(-\\gamma t)\n$$\n其条件方差为：\n$$\n\\mathrm{Var}(X_t | X_0 = x) = \\mathrm{Var}\\left(x \\exp(-\\gamma t) + \\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right)\n$$\n$$\n= \\mathrm{Var}\\left(\\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right) = \\sigma^2 \\int_0^t (\\exp(-\\gamma(t-s)))^2 \\,\\mathrm{d}s\n$$\n$$\n= \\sigma^2 \\int_0^t \\exp(-2\\gamma(t-s)) \\,\\mathrm{d}s = \\sigma^2 \\exp(-2\\gamma t) \\int_0^t \\exp(2\\gamma s) \\,\\mathrm{d}s\n$$\n$$\n= \\sigma^2 \\exp(-2\\gamma t) \\left[\\frac{\\exp(2\\gamma s)}{2\\gamma}\\right]_0^t = \\sigma^2 \\exp(-2\\gamma t) \\left(\\frac{\\exp(2\\gamma t) - 1}{2\\gamma}\\right)\n$$\n$$\n= \\frac{\\sigma^2}{2\\gamma} (1 - \\exp(-2\\gamma t))\n$$\n所以，在给定 $X_0=x$ 的条件下，$X_t$ 的条件分布是一个正态分布：\n$$\nX_t | X_0=x \\sim \\mathcal{N}\\left(x \\exp(-\\gamma t), \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)\n$$\n转移概率密度 $p_t(x,y)$ 是这个正态分布在 $y$ 处的概率密度函数 (PDF)。正态分布 $\\mathcal{N}(\\mu, V)$ 的 PDF 的一般形式为 $\\frac{1}{\\sqrt{2\\pi V}} \\exp\\left(-\\frac{(z-\\mu)^2}{2V}\\right)$。代入我们的均值和方差：\n$$\np_t(x,y) = \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))}} \\exp\\left(-\\frac{(y - x\\exp(-\\gamma t))^2}{2 \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))}\\right)\n$$\n化简表达式得到：\n$$\np_t(x,y) = \\sqrt{\\frac{\\gamma}{\\pi\\sigma^2(1 - \\exp(-2\\gamma t))}} \\exp\\left(-\\frac{\\gamma(y - x\\exp(-\\gamma t))^2}{\\sigma^2(1 - \\exp(-2\\gamma t))}\\right)\n$$\n这就是 OU 过程转移密度的显式表达式。\n\n**2. 不变密度与细致平衡的验证**\n\n不变概率密度 $\\pi(y)$ 是该过程的平稳分布，可以通过取 $t \\to \\infty$ 时 $X_t$ 分布的极限来找到。当 $t \\to \\infty$ 时：\n$$\n\\lim_{t \\to \\infty} \\mathbb{E}[X_t | X_0 = x] = \\lim_{t \\to \\infty} x \\exp(-\\gamma t) = 0\n$$\n$$\n\\lim_{t \\to \\infty} \\mathrm{Var}(X_t | X_0 = x) = \\lim_{t \\to \\infty} \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t)) = \\frac{\\sigma^2}{2\\gamma}\n$$\n因此，不变分布是均值为 $0$、方差为 $\\frac{\\sigma^2}{2\\gamma}$ 的正态分布，即 $\\mathcal{N}(0, \\frac{\\sigma^2}{2\\gamma})$。其概率密度函数 $\\pi(y)$ 为：\n$$\n\\pi(y) = \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\gamma}}} \\exp\\left(-\\frac{y^2}{2 \\frac{\\sigma^2}{2\\gamma}}\\right) = \\sqrt{\\frac{\\gamma}{\\pi\\sigma^2}} \\exp\\left(-\\frac{\\gamma y^2}{\\sigma^2}\\right)\n$$\n现在，我们验证细致平衡条件：$\\pi(x) p_t(x,y) = \\pi(y) p_t(y,x)$。\n我们来分析乘积 $\\pi(x) p_t(x,y)$。为方便起见，令 $V_s = \\frac{\\sigma^2}{2\\gamma}$ 为平稳方差，$V_t = \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))$ 为随时间变化的方差。\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi V_s}} \\exp\\left(-\\frac{x^2}{2V_s}\\right)\n$$\n$$\np_t(x,y) = \\frac{1}{\\sqrt{2\\pi V_t}} \\exp\\left(-\\frac{(y-x\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\n乘积为：\n$$\n\\pi(x) p_t(x,y) = \\frac{1}{2\\pi \\sqrt{V_s V_t}} \\exp\\left(-\\frac{x^2}{2V_s} - \\frac{(y-x\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\n项 $\\pi(y) p_t(y,x)$ 可以通过交换 $x$ 和 $y$ 得到：\n$$\n\\pi(y) p_t(y,x) = \\frac{1}{2\\pi \\sqrt{V_s V_t}} \\exp\\left(-\\frac{y^2}{2V_s} - \\frac{(x-y\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\n要使等式成立，指数部分必须相等。我们来考察 $\\pi(x) p_t(x,y)$ 的指数部分乘以 $-2V_s V_t$：\n$$\nE_{xy} = V_t x^2 + V_s(y-x\\exp(-\\gamma t))^2 = V_t x^2 + V_s(y^2 - 2xy\\exp(-\\gamma t) + x^2\\exp(-2\\gamma t))\n$$\n以及 $\\pi(y) p_t(y,x)$ 的指数部分乘以 $-2V_s V_t$：\n$$\nE_{yx} = V_t y^2 + V_s(x-y\\exp(-\\gamma t))^2 = V_t y^2 + V_s(x^2 - 2xy\\exp(-\\gamma t) + y^2\\exp(-2\\gamma t))\n$$\n交叉项 $-2V_s xy\\exp(-\\gamma t)$ 在两个表达式中都存在。我们必须证明其余各项相等：\n$$\nV_t x^2 + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) \\stackrel{?}{=} V_t y^2 + V_s x^2 + V_s y^2 \\exp(-2\\gamma t)\n$$\n代入定义 $V_t = V_s(1 - \\exp(-2\\gamma t))$：\n$$\nV_s(1 - \\exp(-2\\gamma t)) x^2 + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) \\stackrel{?}{=} V_s(1 - \\exp(-2\\gamma t)) y^2 + V_s x^2 + V_s y^2 \\exp(-2\\gamma t)\n$$\n展开左边：\n$$\nV_s x^2 - V_s x^2 \\exp(-2\\gamma t) + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) = V_s x^2 + V_s y^2\n$$\n展开右边：\n$$\nV_s y^2 - V_s y^2 \\exp(-2\\gamma t) + V_s x^2 + V_s y^2 \\exp(-2\\gamma t) = V_s y^2 + V_s x^2\n$$\n由于 $V_s x^2 + V_s y^2 = V_s y^2 + V_s x^2$，等式成立。这就验证了细致平衡条件，确认了 OU 过程对于其不变测度 $\\pi$ 是可逆的。", "answer": "$$\n\\boxed{\\sqrt{\\frac{\\gamma}{\\pi\\sigma^2(1 - \\exp(-2\\gamma t))}} \\exp\\left(- \\frac{\\gamma(y - x \\exp(-\\gamma t))^2}{\\sigma^2(1 - \\exp(-2\\gamma t))}\\right)}\n$$", "id": "3072636"}, {"introduction": "当扩散系数依赖于状态时，维持系统可逆性的条件会变得更加微妙。一个常见的误解是忽略了由非恒定扩散引起的“噪声诱导漂移”项。本练习通过一个精心设计的反例，要求您计算在忽略此项时产生的非零概率流，从而明确地揭示为何这一项对于满足细致平衡条件至关重要。[@problem_id:3072633]", "problem": "考虑一个伊藤形式的一维随机微分方程 (SDE)，\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\n其中 $W_{t}$ 是标准布朗运动，$a(x) = \\sigma(x)^{2}$ 是状态依赖的扩散系数，$b(x)$ 是漂移项。设目标平稳密度为\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi}}\\,\\exp\\!\\left(-\\frac{x^{2}}{2}\\right),\n$$\n并取非常数扩散系数\n$$\na(x) = 1 + x^{2}.\n$$\n假设我们试图通过选择漂移项来强制实现可逆性（细致平衡），\n$$\nb(x) = \\frac{1}{2}\\,a(x)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log \\pi(x),\n$$\n即省略散度项 $ \\tfrac{1}{2}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}a(x)$。从概率的连续性方程和福克-普朗克方程 (FPE) 出发，推导在此 $b(x)$ 选择下的平稳概率流 $j(x)$，并确定其作为 $x$ 的函数的闭式表达式。你的最终答案必须是 $j(x)$ 的单个简化解析表达式。无需四舍五入。", "solution": "该问题要求解由伊藤方程描述的一维随机过程的平稳概率流 $j(x)$：\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}.\n$$\n该过程的概率密度函数 $p(x,t)$ 的时间演化由福克-普朗克方程 (FPE) 控制，该方程可写为连续性方程：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x}j(x,t),\n$$\n其中 $j(x,t)$ 是概率流。概率流的一般表达式为\n$$\nj(x,t) = b(x) p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} [a(x) p(x,t)],\n$$\n其中 $a(x) = \\sigma(x)^{2}$ 是扩散系数。\n\n平稳状态是指概率密度不随时间变化的状态，即 $\\frac{\\partial p}{\\partial t} = 0$。在这种情况下，FPE 意味着平稳流 $j_s(x)$ 必须满足 $\\frac{\\mathrm{d}j_s(x)}{\\mathrm{d}x} = 0$，即 $j_s(x)$ 是一个常数。对于具有自然边界条件（即概率密度和流在 $x \\to \\pm\\infty$ 时消失）的无限域上的过程，此常数必须为零。如果一个过程相对于平稳密度 $\\pi(x)$ 的平稳流恒为零，$j_s(x) = 0$，则该过程是可逆的，或满足细致平衡。\n\n因此，细致平衡的条件是\n$$\nb(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = 0.\n$$\n求解漂移项 $b(x)$ 得到可逆性所需的形式：\n$$\nb_{rev}(x) = \\frac{1}{2\\pi(x)}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} + \\frac{1}{2}a(x)\\frac{1}{\\pi(x)}\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x} = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} + \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n问题指定了一个省略了第一项（即所谓的散度项或噪声诱导项）的漂移项 $b(x)$：\n$$\nb(x) = \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n任务是找到在这种漂移项选择下的“平稳概率流 $j(x)$”。这被解释为将给定的动力学和目标密度 $\\pi(x)$ 代入流的一般表达式中，从而计算产生的流场。这个量衡量了相对于 $\\pi(x)$ 的细致平衡被破坏的程度。\n\n我们使用提供的函数来计算流的表达式 $j(x) = b(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)]$。首先，让我们展开导数项：\n$$\n\\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x}.\n$$\n使用关系式 $\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x} = \\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)$，上式变为\n$$\n\\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n现在我们组装流 $j(x)$ 的完整表达式：\n$$\nj(x) = b(x)\\pi(x) - \\left( \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x) \\right).\n$$\n代入给定的漂移项 $b(x) = \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)$：\n$$\nj(x) = \\left(\\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)\\right)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) - \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\n第一项和第三项相互抵消，留下一个非常简单的流表达式：\n$$\nj(x) = -\\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x).\n$$\n这个结果表明，非零流与扩散系数的梯度成正比，而这恰好是从可逆漂移项中省略的项。\n\n现在我们代入问题陈述中给出的具体函数：\n目标平稳密度是标准正态分布：\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right).\n$$\n扩散系数为：\n$$\na(x) = 1 + x^{2}.\n$$\n我们计算它关于 $x$ 的导数：\n$$\n\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1 + x^{2}) = 2x.\n$$\n将这些代入我们简化的 $j(x)$ 表达式中：\n$$\nj(x) = -\\frac{1}{2}(2x)\\pi(x) = -x\\pi(x).\n$$\n最后，我们写出 $j(x)$ 的完整表达式：\n$$\nj(x) = -x \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right).\n$$\n这是在指定条件下平稳概率流的闭式表达式。由于 $\\frac{\\mathrm{d}j}{\\mathrm{d}x} \\neq 0$，密度 $\\pi(x)$ 不是具有给定漂移项的过程的真实平稳密度，并且系统不处于平衡状态。计算出的 $j(x)$ 代表了非平衡流场。", "answer": "$$\n\\boxed{-x \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right)}\n$$", "id": "3072633"}, {"introduction": "理解了理论之后，我们可以从分析转向设计。在计算物理和统计学中，我们常常需要构建一个能有效采样特定概率分布的随机过程。本练习将带您实践这一思想：针对一个具有双势阱的复杂目标分布，您需要设计一个具有位置依赖扩散系数的随机过程，并推导出确保其可逆性的相应漂移项，这直接展示了该理论在先进采样算法设计中的应用价值。[@problem_id:3072619]", "problem": "考虑一个一维伊藤随机微分方程 (SDE)，其形式为 $dX_t = b(X_t)\\,dt + \\sqrt{2a(X_t)}\\,dW_t$，其中 $a(x)$ 是一个光滑的严格正函数，$W_t$ 是一个标准维纳过程。目标稳态密度是多峰的，由 $\\pi(x) \\propto \\exp(-U(x))$ 给出，其势函数为 $U(x) = \\tfrac{1}{2}(x^2 - 1)^2$，该势函数在 $x=\\pm 1$ 附近有两个势阱，并在 $x=0$ 附近被一个势垒隔开。为了在保持可逆性的同时预处理几何结构以改善跨越势垒的能力，选择一个与位置相关的扩散 $a(x) = 1 + \\gamma\\,\\exp(-\\kappa x^2)$，其中参数 $\\gamma>0$ 且 $\\kappa>0$，这会增加在 $x=0$ 附近势垒处的扩散率。\n\n仅使用正向柯尔莫哥洛夫（福克-普朗克）方程和细致平衡（可逆性）的定义（即稳态下概率流为零），推导漂移项 $b(x)$，使得该扩散相对于给定的 $\\pi(x)$ 是可逆的。请将您的最终答案表示为 $b(x)$ 关于 $x$、$\\gamma$ 和 $\\kappa$ 的单个简化解析表达式。不需要进行数值近似。", "solution": "该过程始于给定的一般一维伊藤随机微分方程 (SDE)：\n$$dX_t = b(X_t)\\,dt + \\sqrt{2a(X_t)}\\,dW_t$$\n其中 $b(x)$ 是漂移项，$a(x)$ 是与位置相关的扩散函数，$W_t$ 是一个标准维纳过程。\n\n过程 $X_t$ 的概率密度函数 $p(x,t)$ 的演化由正向柯尔莫哥洛夫方程（也称为福克-普朗克方程）描述。对于给定的SDE，福克-普朗克方程为：\n$$\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left( b(x)p(x,t) \\right) + \\frac{\\partial^2}{\\partial x^2} \\left( a(x)p(x,t) \\right)$$\n该方程可以表示为连续性方程 $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$，其中 $J(x,t)$ 是概率流。通过对福克-普朗克方程关于 $x$ 积分一次，我们可以确定概率流为：\n$$J(x,t) = b(x)p(x,t) - \\frac{\\partial}{\\partial x}\\left(a(x)p(x,t)\\right)$$\n在稳态下，概率密度不随时间变化，$p(x,t) = \\pi(x)$，其时间导数为零，即 $\\frac{\\partial \\pi}{\\partial t} = 0$。这意味着稳态概率流 $J_{st}(x)$ 相对于 $x$ 必须是一个常数。\n$$J_{st}(x) = b(x)\\pi(x) - \\frac{d}{dx}\\left(a(x)\\pi(x)\\right) = \\text{常数}$$\n过程可逆的条件比稳态更严格。它要求满足细致平衡条件，这在一维连续过程的背景下，意味着稳态概率流必须处处为零，即对所有 $x$ 都有 $J_{st}(x) = 0$。\n\n将稳态流设为零，我们得到连接漂移项 $b(x)$、稳态密度 $\\pi(x)$ 和扩散函数 $a(x)$ 的方程：\n$$b(x)\\pi(x) - \\frac{d}{dx}\\left(a(x)\\pi(x)\\right) = 0$$\n假设 $\\pi(x)>0$，我们可以解出漂移项 $b(x)$：\n$$b(x) = \\frac{1}{\\pi(x)} \\frac{d}{dx}\\left(a(x)\\pi(x)\\right)$$\n对 $\\frac{d}{dx}(a(x)\\pi(x))$ 项使用乘法法则求导，我们得到：\n$$b(x) = \\frac{1}{\\pi(x)} \\left( a'(x)\\pi(x) + a(x)\\pi'(x) \\right) = a'(x) + a(x)\\frac{\\pi'(x)}{\\pi(x)}$$\n其中 $a'(x)$ 和 $\\pi'(x)$ 分别是 $a(x)$ 和 $\\pi(x)$ 关于 $x$ 的导数。\n\n问题陈述中给出的目标稳态密度为 $\\pi(x) \\propto \\exp(-U(x))$。我们可以将其写作 $\\pi(x) = C \\exp(-U(x))$，其中 $C$ 是一个归一化常数。$\\frac{\\pi'(x)}{\\pi(x)}$ 项可以作为 $\\ln(\\pi(x))$ 的导数来计算：\n$$\\frac{\\pi'(x)}{\\pi(x)} = \\frac{d}{dx}\\ln(\\pi(x)) = \\frac{d}{dx}\\left(\\ln(C) - U(x)\\right) = -U'(x)$$\n将此结果代入 $b(x)$ 的表达式，得到可逆扩散漂移项的一般公式：\n$$b(x) = a'(x) - a(x)U'(x)$$\n现在，我们使用问题陈述中提供的具体函数。势函数为 $U(x) = \\frac{1}{2}(x^2 - 1)^2$。其导数为：\n$$U'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}(x^4 - 2x^2 + 1)\\right) = \\frac{1}{2}(4x^3 - 4x) = 2x^3 - 2x = 2x(x^2 - 1)$$\n扩散函数为 $a(x) = 1 + \\gamma\\,\\exp(-\\kappa x^2)$。其导数为：\n$$a'(x) = \\frac{d}{dx}\\left(1 + \\gamma\\,\\exp(-\\kappa x^2)\\right) = \\gamma\\,\\exp(-\\kappa x^2)(-2\\kappa x) = -2\\kappa \\gamma x \\exp(-\\kappa x^2)$$\n我们将这些导数以及函数 $a(x)$ 代入 $b(x)$ 的公式中：\n$$b(x) = \\left(-2\\kappa \\gamma x \\exp(-\\kappa x^2)\\right) - \\left(1 + \\gamma\\,\\exp(-\\kappa x^2)\\right)\\left(2x(x^2 - 1)\\right)$$\n为了简化，我们展开第二项：\n$$b(x) = -2\\kappa \\gamma x \\exp(-\\kappa x^2) - 2x(x^2 - 1) - 2\\gamma x(x^2 - 1)\\exp(-\\kappa x^2)$$\n接下来，我们将包含因子 $\\exp(-\\kappa x^2)$ 的项组合在一起：\n$$b(x) = -2x(x^2 - 1) - \\left(2\\kappa \\gamma x + 2\\gamma x(x^2 - 1)\\right)\\exp(-\\kappa x^2)$$\n从括号内的表达式中提取公因式 $2\\gamma x$ 得：\n$$b(x) = -2x(x^2 - 1) - 2\\gamma x\\left(\\kappa + (x^2 - 1)\\right)\\exp(-\\kappa x^2)$$\n进一步简化括号内的项得到：\n$$b(x) = -2x(x^2 - 1) - 2\\gamma x(x^2 + \\kappa - 1)\\exp(-\\kappa x^2)$$\n最后，我们可以提取公因式 $-2x$ 来获得漂移项 $b(x)$ 的最终简化表达式：\n$$b(x) = -2x\\left[ (x^2 - 1) + \\gamma(x^2 + \\kappa - 1)\\exp(-\\kappa x^2) \\right]$$\n这就是确保 SDE 相对于稳态分布 $\\pi(x) \\propto \\exp(-U(x))$ 可逆的漂移函数。", "answer": "$$\n\\boxed{-2x\\left[ (x^2 - 1) + \\gamma(x^2 + \\kappa - 1)\\exp(-\\kappa x^2) \\right]}\n$$", "id": "3072619"}]}