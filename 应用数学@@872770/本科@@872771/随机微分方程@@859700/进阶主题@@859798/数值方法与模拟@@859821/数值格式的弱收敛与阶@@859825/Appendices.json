{"hands_on_practices": [{"introduction": "要真正掌握弱收敛，最好的方法莫过于亲手计算其误差。本练习将通过分析金融和物理学中的基石模型——奥恩斯坦-乌伦贝克过程，为您提供一个基础实践。通过为欧拉-丸山格式显式地推导弱误差，您将亲眼见证误差随步长变化的具体行为，并深刻理解为何该格式具有一阶弱收敛性[@problem_id:3083367]。", "problem": "考虑由标准布朗运动 (BM) 驱动的 Ornstein–Uhlenbeck 随机微分方程 (SDE)，该过程在区间 $[0,T]$ 上，具有确定性初始条件 $X_{0}=x_{0}\\in\\mathbb{R}$：\n$dX_{t} = -\\lambda X_{t}\\,dt + \\sigma\\,dW_{t}$，\n其中 $\\lambda>0$，$\\sigma\\in\\mathbb{R}$，且 $W_{t}$ 是一个标准布朗运动。设可观测量为 $\\varphi(x)=x$。 \n\n您的任务是：\n- 仅使用 Itô 积分的基本性质和期望的线性性，从第一性原理出发，通过获得并求解由 $m(t)=\\mathbb{E}[X_{t}]$ 满足的、初始条件为 $m(0)=x_{0}$ 的确定性常微分方程，推导出 $m(T)=\\mathbb{E}[\\varphi(X_{T})]=\\mathbb{E}[X_{T}]$ 的闭式表达式。\n- 考虑 Euler–Maruyama (EM) 方法，其时间步长为均匀的 $h>0$，网格为 $t_{k}=kh$（$k=0,1,\\dots,N$），其中 $N=T/h\\in\\mathbb{N}$。该格式为\n$X^{h}_{k+1}=X^{h}_{k}-\\lambda X^{h}_{k}\\,h+\\sigma\\,(W_{t_{k+1}}-W_{t_{k}})$，\n初始条件为 $X^{h}_{0}=x_{0}$。精确计算 $\\mathbb{E}[X^{h}_{N}]$，用 $x_{0}$、$\\lambda$、 $h$ 和 $N$ 表示。\n- 将时刻 $T$ 时可观测量 $\\varphi$ 的弱误差定义为 $e_{\\text{weak}}(h)=\\mathbb{E}[\\varphi(X_{T})]-\\mathbb{E}[\\varphi(X^{h}_{N})]$。使用您得到的精确表达式，将 $e_{\\text{weak}}(h)$ 显式地写成关于 $x_{0}$、$\\lambda$、 $T$ 和 $h$ 的函数。然后确定当 $h\\to 0$ 时 $e_{\\text{weak}}(h)$ 的主阶行为，并陈述此可观测量上的弱阶，根据您得到的展开式证明您的结论。\n\n作为最终答案，提供 $e_{\\text{weak}}(h)$ 关于 $x_{0}$、$\\lambda$、 $T$ 和 $h$ 的精确闭式表达式。无需四舍五入。", "solution": "该问题被验证为在科学上是合理的、适定的、客观的和自洽的。Ornstein–Uhlenbeck 过程和 Euler–Maruyama 方法是随机微分方程及其数值分析的标准课题。所有提供的信息都是一致的，并且足以推导出所要求的量。\n\n该解答根据问题陈述的要求分为三个部分。\n\n### 第1部分：精确解的均值\n\n我们给定 Ornstein–Uhlenbeck 随机微分方程 (SDE)：\n$$dX_{t} = -\\lambda X_{t}\\,dt + \\sigma\\,dW_{t}$$\n具有确定性初始条件 $X_{0} = x_{0}$，其中 $\\lambda > 0$，$\\sigma \\in \\mathbb{R}$，且 $W_{t}$ 是一个标准布朗运动。我们关心可观测量 $\\varphi(x)=x$，因此需要计算 $m(T) = \\mathbb{E}[\\varphi(X_{T})] = \\mathbb{E}[X_{T}]$。\n\n首先，我们将 SDE 写成其积分形式：\n$$X_{t} = X_{0} + \\int_{0}^{t} (-\\lambda X_{s})\\,ds + \\int_{0}^{t} \\sigma\\,dW_{s}$$\n令 $m(t) = \\mathbb{E}[X_{t}]$。我们对积分方程两边取期望。根据期望算子的线性性，我们有：\n$$m(t) = \\mathbb{E}[X_{t}] = \\mathbb{E}\\left[ X_{0} - \\lambda \\int_{0}^{t} X_{s}\\,ds + \\sigma \\int_{0}^{t} dW_{s} \\right]$$\n$$m(t) = \\mathbb{E}[X_{0}] - \\lambda \\mathbb{E}\\left[\\int_{0}^{t} X_{s}\\,ds\\right] + \\sigma \\mathbb{E}\\left[\\int_{0}^{t} dW_{s}\\right]$$\n\n我们计算每一项：\n1.  初始条件是确定性的，所以 $\\mathbb{E}[X_{0}] = \\mathbb{E}[x_{0}] = x_{0}$。\n2.  关于标准布朗运动的、具有确定性被积函数的 Itô 积分，其期望为零。由于 $X_s$ 是适应过程，随机 Fubini 定理允许我们交换期望和积分，并且对于 Itô 积分，我们有 $\\mathbb{E}\\left[\\int_{0}^{t} dW_{s}\\right] = 0$。这是 Itô 积分的一个基本性质，因为该积分是一个从0开始的鞅。\n3.  在对过程 $X_s$ 的温和条件下（此处满足这些条件），我们可以应用随机 Fubini 定理来交换期望和 Lebesgue 积分：$\\mathbb{E}\\left[\\int_{0}^{t} X_{s}\\,ds\\right] = \\int_{0}^{t} \\mathbb{E}[X_{s}]\\,ds = \\int_{0}^{t} m(s)\\,ds$。\n\n将这些代入关于 $m(t)$ 的方程，我们得到一个关于均值的积分方程：\n$$m(t) = x_{0} - \\lambda \\int_{0}^{t} m(s)\\,ds$$\n这是一个第一类 Volterra 积分方程。使用微积分基本定理对两边关于 $t$ 求导，得到 $m(t)$ 的常微分方程 (ODE)：\n$$\\frac{d m(t)}{dt} = -\\lambda m(t)$$\n通过在积分方程中令 $t=0$ 得到初始条件：$m(0) = x_{0}$。\n\n这是一个一阶线性齐次 ODE。其解为：\n$$m(t) = m(0)\\exp(-\\lambda t) = x_{0}\\exp(-\\lambda t)$$\n在最终时刻 $T$，精确解的均值为：\n$$m(T) = \\mathbb{E}[X_{T}] = x_{0}\\exp(-\\lambda T)$$\n\n### 第2部分：数值解的均值\n\n时间步长为 $h$ 的 Euler–Maruyama (EM) 格式由下式给出：\n$$X^{h}_{k+1} = X^{h}_{k} - \\lambda X^{h}_{k}\\,h + \\sigma\\,(W_{t_{k+1}} - W_{t_{k}})$$\n初始条件为 $X^{h}_{0}=x_{0}$。这可以改写为：\n$$X^{h}_{k+1} = (1 - \\lambda h)X^{h}_{k} + \\sigma\\,\\Delta W_{k}$$\n其中 $\\Delta W_{k} = W_{t_{k+1}} - W_{t_{k}}$ 是布朗运动在区间 $[t_k, t_{k+1}]$ 上的增量。\n\n令 $\\mu_{k} = \\mathbb{E}[X^{h}_{k}]$。我们对该格式取期望：\n$$\\mathbb{E}[X^{h}_{k+1}] = \\mathbb{E}\\left[ (1 - \\lambda h)X^{h}_{k} + \\sigma\\,\\Delta W_{k} \\right]$$\n利用期望的线性性：\n$$\\mu_{k+1} = (1 - \\lambda h)\\mathbb{E}[X^{h}_{k}] + \\sigma\\mathbb{E}[\\Delta W_{k}]$$\n标准布朗运动的增量 $\\Delta W_{k}$ 是独立同分布的正态随机变量，均值为 $0$，方差为 $h$。因此，$\\mathbb{E}[\\Delta W_{k}] = 0$。\n数值解均值的递推关系简化为：\n$$\\mu_{k+1} = (1 - \\lambda h)\\mu_{k}$$\n初始条件为 $\\mu_{0} = \\mathbb{E}[X^{h}_{0}] = \\mathbb{E}[x_{0}] = x_{0}$。\n\n这是一个等比数列。第 $k$ 步的解由下式给出：\n$$\\mu_{k} = (1 - \\lambda h)^{k} \\mu_{0} = x_{0}(1 - \\lambda h)^{k}$$\n我们需要最终时刻 $T$ 的均值，这对应于第 $N$ 步，其中 $N=T/h$。因此，对于 $k=N$：\n$$\\mathbb{E}[X^{h}_{N}] = x_{0}(1 - \\lambda h)^{N}$$\n\n### 第3部分：弱误差和主阶分析\n\n在时刻 $T$ 时，可观测量 $\\varphi(x)=x$ 的弱误差定义为：\n$$e_{\\text{weak}}(h) = \\mathbb{E}[\\varphi(X_{T})] - \\mathbb{E}[\\varphi(X^{h}_{N})] = \\mathbb{E}[X_{T}] - \\mathbb{E}[X^{h}_{N}]$$\n代入前面部分推导出的精确表达式：\n$$\\mathbb{E}[X_{T}] = x_{0}\\exp(-\\lambda T)$$\n$$\\mathbb{E}[X^{h}_{N}] = x_{0}(1 - \\lambda h)^{N}$$\n使用关系式 $N=T/h$，我们可以将 $\\mathbb{E}[X^{h}_{N}]$ 写成 $h$ 和 $T$ 的函数：\n$$\\mathbb{E}[X^{h}_{N}] = x_{0}(1 - \\lambda h)^{T/h}$$\n因此，弱误差的精确表达式为：\n$$e_{\\text{weak}}(h) = x_{0}\\exp(-\\lambda T) - x_{0}(1 - \\lambda h)^{T/h} = x_{0}\\left(\\exp(-\\lambda T) - (1 - \\lambda h)^{T/h}\\right)$$\n\n为了确定当 $h \\to 0$ 时的主阶行为，我们对项 $(1 - \\lambda h)^{T/h}$ 进行泰勒展开。我们可以使用指数函数来写这一项：\n$$(1 - \\lambda h)^{T/h} = \\exp\\left(\\frac{T}{h} \\ln(1 - \\lambda h)\\right)$$\n对于小的 $h$，我们使用自然对数的泰勒级数 $\\ln(1-u) = -u - \\frac{u^2}{2} - O(u^3)$，并令 $u = \\lambda h$：\n$$\\ln(1 - \\lambda h) = -\\lambda h - \\frac{(\\lambda h)^2}{2} - O(h^3)$$\n将此代入指数部分：\n$$\\frac{T}{h}\\ln(1 - \\lambda h) = \\frac{T}{h}\\left(-\\lambda h - \\frac{\\lambda^2 h^2}{2} - O(h^3)\\right) = -\\lambda T - \\frac{\\lambda^2 T}{2}h - O(h^2)$$\n因此，数值均值的表达式变为：\n$$(1 - \\lambda h)^{T/h} = \\exp\\left(-\\lambda T - \\frac{\\lambda^2 T}{2}h - O(h^2)\\right) = \\exp(-\\lambda T)\\exp\\left(-\\frac{\\lambda^2 T}{2}h - O(h^2)\\right)$$\n现在，我们使用指数函数的泰勒级数 $\\exp(v) = 1 + v + O(v^2)$，其中 $v = -\\frac{\\lambda^2 T}{2}h$：\n$$\\exp\\left(-\\frac{\\lambda^2 T}{2}h - O(h^2)\\right) = 1 - \\frac{\\lambda^2 T}{2}h + O(h^2)$$\n综合起来：\n$$(1 - \\lambda h)^{T/h} = \\exp(-\\lambda T)\\left(1 - \\frac{\\lambda^2 T}{2}h + O(h^2)\\right) = \\exp(-\\lambda T) - \\frac{\\lambda^2 T}{2}\\exp(-\\lambda T)h + O(h^2)$$\n现在我们将这个展开式代回弱误差表达式：\n$$e_{\\text{weak}}(h) = x_{0}\\left(\\exp(-\\lambda T) - \\left[\\exp(-\\lambda T) - \\frac{\\lambda^2 T}{2}\\exp(-\\lambda T)h + O(h^2)\\right]\\right)$$\n$$e_{\\text{weak}}(h) = x_{0}\\left(\\frac{\\lambda^2 T}{2}\\exp(-\\lambda T)h + O(h^2)\\right)$$\n$$e_{\\text{weak}}(h) = \\frac{x_{0}\\lambda^2 T}{2}\\exp(-\\lambda T)h + O(h^2)$$\n弱误差的主阶行为与 $h$ 成正比。因此，对于此可观测量，Euler-Maruyama 方法的弱收敛阶为1。", "answer": "$$\\boxed{x_{0}\\left(\\exp(-\\lambda T) - (1 - \\lambda h)^{T/h}\\right)}$$", "id": "3083367"}, {"introduction": "既然我们已经分析了一个数值格式的收敛阶，一个自然的问题是：我们能否提高其精度？本练习将介绍一种强大的通用收敛加速技术——理查森外推法（Richardson extrapolation）。我们将基于前一个练习的结论，巧妙地组合不同步长下的模拟结果，以消除主要的误差项，从而在不设计更复杂格式的情况下，有效地构造出一个更高阶的估计量[@problem_id:3083381]。", "problem": "考虑标量奥恩斯坦-乌伦贝克 (OU) 随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} = -a\\,X_{t}\\,\\mathrm{d}t + b\\,\\mathrm{d}W_{t}, \\qquad X_{0} = x_{0},\n$$\n其中 $a>0$, $b \\in \\mathbb{R}$, $x_{0} \\in \\mathbb{R}$, $T>0$，且 $W_{t}$ 是一个标准维纳过程。令 $\\varphi(x) = x$，并用 $m(T) = \\mathbb{E}[X_{T}]$ 表示在时间 $T$ 的精确均值。定义具有均匀步长 $h = T/N$ 的欧拉-丸山时间步进格式为\n$$\nX_{n+1}^{(h)} = X_{n}^{(h)} - a\\,X_{n}^{(h)}\\,h + b\\,\\Delta W_{n}, \\quad n=0,1,\\dots,N-1, \\qquad X_{0}^{(h)} = x_{0},\n$$\n并令 $m_{h} := \\mathbb{E}[X_{N}^{(h)}]$。类似地，令 $m_{h/2}$ 表示在相同的终端时间 $T$ 上，由步长为 $h/2$ 的欧拉-丸山格式产生的均值。\n\n仅使用线性SDE的基本性质（期望的线性和伊藤积分）以及欧拉-丸山格式的定义，推导出 $m(T)$、$m_{h}$ 和 $m_{h/2}$ 的显式表达式，然后应用理查森外推法构造\n$$\nR(h) := 2\\,m_{h/2} - m_{h}.\n$$\n通过基于光滑函数级数展开的基本原理进行小 $h$ 分析，确定由以下极限定义的前导常数 $L$\n$$\nL := \\lim_{h \\to 0} \\frac{R(h) - m(T)}{h^{2}},\n$$\n该常数仅用 $a$、$T$ 和 $x_{0}$ 的闭式形式表示。你的最终答案必须是单个解析表达式。不需要数值舍入，也不涉及单位。", "solution": "对问题陈述进行有效性分析。\n\n### 第 1 步：提取给定条件\n- **SDE**：$\\mathrm{d}X_{t} = -a\\,X_{t}\\,\\mathrm{d}t + b\\,\\mathrm{d}W_{t}$，初始条件为 $X_{0} = x_{0}$。\n- **参数**：$a>0$, $b \\in \\mathbb{R}$, $x_{0} \\in \\mathbb{R}$, $T>0$。\n- **过程**：$W_{t}$ 是一个标准维纳过程。\n- **测试函数**：$\\varphi(x) = x$。\n- **精确均值**：$m(T) = \\mathbb{E}[X_{T}]$。\n- **数值格式**：具有均匀步长 $h = T/N$ 的欧拉-丸山格式为 $X_{n+1}^{(h)} = X_{n}^{(h)} - a\\,X_{n}^{(h)}\\,h + b\\,\\Delta W_{n}$，对于 $n=0,1,\\dots,N-1$，其中 $X_{0}^{(h)} = x_{0}$。$\\Delta W_n = W_{(n+1)h} - W_{nh}$。\n- **数值均值**：$m_{h} := \\mathbb{E}[X_{N}^{(h)}]$。\n- **精化的数值均值**：$m_{h/2}$ 是由步长为 $h/2$ 的相同格式产生的均值。\n- **理查森外推法**：$R(h) := 2\\,m_{h/2} - m_{h}$。\n- **目标**：确定前导常数 $L := \\lim_{h \\to 0} \\frac{R(h) - m(T)}{h^{2}}$，用 $a$、$T$ 和 $x_{0}$ 表示。\n\n### 第 2 步：使用提取的给定条件进行验证\n- **科学依据**：该问题是随机微分方程数值分析中的一个标准练习。奥恩斯坦-乌伦贝克过程、欧拉-丸山方法和理查森外推法都是该领域基本且成熟的概念。弱收敛阶的分析是一个核心课题。\n- **适定性**：问题陈述清晰，提供了所有必要的参数和定义。它要求一个特定的、可推导的常数 $L$，这指向一个唯一且有意义的解。\n- **客观性**：该问题以精确、客观的数学语言表述，没有歧义或主观论断。\n\n### 第 3 步：结论与行动\n该问题是有效的，因为它是科学合理的、适定的、客观的且自洽的。可以开始求解过程。\n\n### 解的推导\n\n求解需要三个主要部分：精确均值 $m(T)$、数值均值 $m_{h}$ 和 $m_{h/2}$，以及用于评估极限 $L$ 的小 $h$ 渐近分析。\n\n**1. 精确均值 $m(T)$**\n\n奥恩斯坦-乌伦贝克SDE是一个线性SDE。我们可以显式地求解它。其在时间 $t$ 的解由下式给出\n$$\nX_{t} = X_0 \\exp(-at) + \\int_{0}^{t} b \\exp(-a(t-s)) \\mathrm{d}W_s.\n$$\n取期望，我们得到均值 $m(t) = \\mathbb{E}[X_t]$。利用期望的线性性质，\n$$\nm(t) = \\mathbb{E}[X_0 \\exp(-at)] + \\mathbb{E}\\left[\\int_{0}^{t} b \\exp(-a(t-s)) \\mathrm{d}W_s\\right].\n$$\n由于 $X_0 = x_0$ 是一个确定性初始条件，$\\mathbb{E}[X_0 \\exp(-at)] = x_0 \\exp(-at)$。第二项是具有确定性被积函数的伊藤积分的期望，其值为零。\n$$\n\\mathbb{E}\\left[\\int_{0}^{t} b \\exp(-a(t-s)) \\mathrm{d}W_s\\right] = 0.\n$$\n因此，过程在时间 $t$ 的均值为 $m(t) = x_0 \\exp(-at)$。在终端时间 $T$，精确均值为\n$$\nm(T) = x_{0} \\exp(-aT).\n$$\n\n**2. 数值均值 $m_h$**\n\n欧拉-丸山格式由下式给出\n$$\nX_{n+1}^{(h)} = (1 - ah) X_{n}^{(h)} + b \\Delta W_{n}.\n$$\n令 $m_n^{(h)} = \\mathbb{E}[X_{n}^{(h)}]$。对该格式取期望，我们得到均值的递推关系：\n$$\n\\mathbb{E}[X_{n+1}^{(h)}] = \\mathbb{E}[(1 - ah) X_{n}^{(h)}] + \\mathbb{E}[b \\Delta W_{n}].\n$$\n维纳过程的增量 $\\Delta W_n$ 具有零均值，即 $\\mathbb{E}[\\Delta W_n] = 0$。这可将递推关系简化为\n$$\nm_{n+1}^{(h)} = (1 - ah) m_n^{(h)}.\n$$\n根据初始条件 $m_0^{(h)} = \\mathbb{E}[X_0^{(h)}] = x_0$，我们可以解这个等比数列：\n$$\nm_n^{(h)} = (1-ah)^n x_0.\n$$\n我们关心的是终端时间 $T=Nh$ 时的均值，这对应于 $n=N$。因此，\n$$\nm_h = m_N^{(h)} = (1-ah)^N x_0.\n$$\n代入 $N=T/h$，我们得到 $m_h$ 关于 $h$ 的表达式：\n$$\nm_h = x_0 (1-ah)^{T/h}.\n$$\n类似地，对于步长 $h/2$，达到 $T$ 的步数为 $2N$。数值均值为\n$$\nm_{h/2} = x_0 (1-a(h/2))^{2N} = x_0 (1-ah/2)^{2T/h}.\n$$\n\n**3. 小 $h$ 渐近分析**\n\n为了求出极限 $L$，我们需要对 $m_h$ 在 $h=0$ 附近进行泰勒展开。首先展开项 $(1-ah)^{T/h}$ 的对数会很方便。\n对小 $x$ 使用级数展开 $\\ln(1-x) = -x - \\frac{x^2}{2} - \\frac{x^3}{3} - O(x^4)$，我们令 $x=ah$：\n$$\n\\ln\\left((1-ah)^{T/h}\\right) = \\frac{T}{h} \\ln(1-ah) = \\frac{T}{h} \\left( -ah - \\frac{(ah)^2}{2} - \\frac{(ah)^3}{3} - O(h^4) \\right)\n$$\n$$\n= T \\left( -a - \\frac{a^2h}{2} - \\frac{a^3h^2}{3} - O(h^3) \\right) = -aT - \\frac{a^2Th}{2} - \\frac{a^3Th^2}{3} - O(h^3).\n$$\n现在，我们对这个表达式取指数。令 $y = - \\frac{a^2Th}{2} - \\frac{a^3Th^2}{3}$。\n$$\n(1-ah)^{T/h} = \\exp\\left(-aT - \\frac{a^2Th}{2} - \\frac{a^3Th^2}{3} - O(h^3)\\right) = \\exp(-aT) \\exp\\left(y - O(h^3)\\right).\n$$\n使用展开式 $\\exp(y) = 1 + y + \\frac{y^2}{2} + O(y^3)$，我们得到\n$$\n\\exp(y) = 1 + \\left(-\\frac{a^2Th}{2} - \\frac{a^3Th^2}{3}\\right) + \\frac{1}{2}\\left(-\\frac{a^2Th}{2} - \\frac{a^3Th^2}{3}\\right)^2 + O(h^3).\n$$\n展开并保留到 $h^2$ 阶的项：\n$$\n\\exp(y) = 1 - \\frac{a^2T}{2}h - \\frac{a^3T}{3}h^2 + \\frac{1}{2}\\left(-\\frac{a^2Th}{2}\\right)^2 + O(h^3)\n$$\n$$\n= 1 - \\frac{a^2T}{2}h - \\frac{a^3T}{3}h^2 + \\frac{a^4T^2}{8}h^2 + O(h^3) = 1 - \\frac{a^2T}{2}h + \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right)h^2 + O(h^3).\n$$\n因此，$m_h$ 的展开式为\n$$\nm_h = x_0 \\exp(-aT) \\left[ 1 - \\frac{a^2T}{2}h + \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right)h^2 + O(h^3) \\right].\n$$\n这个展开式的形式为 $m_h = m(T) + C_1 h + C_2 h^2 + O(h^3)$，其中 $m(T) = x_0 \\exp(-aT)$，系数为\n$$\nC_1 = -x_0 \\exp(-aT) \\frac{a^2T}{2}\n$$\n$$\nC_2 = x_0 \\exp(-aT) \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right).\n$$\n$m_{h/2}$ 的展开式可以通过将 $h$ 替换为 $h/2$ 得到：\n$$\nm_{h/2} = m(T) + C_1 \\frac{h}{2} + C_2 \\left(\\frac{h}{2}\\right)^2 + O(h^3) = m(T) + \\frac{C_1}{2}h + \\frac{C_2}{4}h^2 + O(h^3).\n$$\n\n**4. 理查森外推法与极限 $L$**\n\n现在我们构造理查森外推值 $R(h)$：\n$$\nR(h) = 2m_{h/2} - m_h\n$$\n$$\n= 2\\left(m(T) + \\frac{C_1}{2}h + \\frac{C_2}{4}h^2\\right) - \\left(m(T) + C_1 h + C_2 h^2\\right) + O(h^3)\n$$\n$$\n= (2m(T) + C_1 h + \\frac{C_2}{2}h^2) - (m(T) + C_1 h + C_2 h^2) + O(h^3)\n$$\n$$\n= m(T) - \\frac{C_2}{2}h^2 + O(h^3).\n$$\n外推值与精确均值之差为\n$$\nR(h) - m(T) = -\\frac{C_2}{2}h^2 + O(h^3).\n$$\n极限 $L$ 于是就是 $h^2$ 项的系数：\n$$\nL = \\lim_{h \\to 0} \\frac{R(h) - m(T)}{h^2} = -\\frac{C_2}{2}.\n$$\n代入 $C_2$ 的表达式：\n$$\nL = -\\frac{1}{2} \\left[ x_0 \\exp(-aT) \\left(\\frac{a^4T^2}{8} - \\frac{a^3T}{3}\\right) \\right]\n$$\n$$\nL = x_0 \\exp(-aT) \\left(-\\frac{a^4T^2}{16} + \\frac{a^3T}{6}\\right).\n$$\n这就是所求的前导常数 $L$ 的闭式表达式。\n$$\nL = x_0 \\exp(-aT) \\left( \\frac{a^3 T}{6} - \\frac{a^4 T^2}{16} \\right).\n$$", "answer": "$$\n\\boxed{x_{0} \\exp(-aT) \\left( \\frac{a^{3} T}{6} - \\frac{a^{4} T^{2}}{16} \\right)}\n$$", "id": "3083381"}, {"introduction": "理论的价值最终体现在实践中，而任何实际的模拟都受限于计算成本。本练习将弱收敛阶的理论概念与计算效率的现实问题联系起来。在蒙特卡洛模拟中，总误差包含两部分：由时间步长 $h$ 引起的离散化误差，以及由有限模拟路径数 $M$ 引起的统计误差。本练习将引导您探索这两个误差来源之间的关键权衡，并确定 $h$ 和 $M$ 的最优关系，从而以最小的计算代价达到给定的精度要求[@problem_id:3083399]。", "problem": "考虑一个一维随机微分方程 (SDE)，由 $dX_{t} = a(X_{t})\\,dt + b(X_{t})\\,dW_{t}$ 给出，在固定的时间区间 $[0,T]$ 上具有确定性初始条件 $X_{0} = x_{0}$，其中 $a$ 和 $b$ 是全局利普希茨连续函数，且 $(W_{t})_{t \\geq 0}$ 是一个标准布朗运动。设 $\\varphi:\\mathbb{R}\\to\\mathbb{R}$ 是一个具有多项式增长的测试函数，并将我们感兴趣的量表示为 $\\mu := \\mathbb{E}[\\varphi(X_{T})]$。\n\n为了近似 $\\mu$，考虑使用时间步长为 $h>0$ 且步数为 $N := T/h \\in \\mathbb{N}$ 的欧拉-丸山 (EM) 格式：\n$$\nY_{0} := x_{0}, \\quad\nY_{n+1} := Y_{n} + a(Y_{n})\\,h + b(Y_{n})\\,\\Delta W_{n}, \\quad \\Delta W_{n} \\sim \\mathcal{N}(0,h), \\quad n=0,1,\\dots,N-1.\n$$\n基于 EM 终端值的 $M \\in \\mathbb{N}$ 条独立同分布的路径 $(Y_{N}^{(m)})_{m=1}^{M}$，定义蒙特卡洛估计量：\n$$\n\\widehat{\\mu}_{M,h} := \\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big).\n$$\n\n假设对于足够小的 $h$，以下两个性质一致成立：\n1. 欧拉-丸山格式的一阶弱收敛性：存在一个常数 $C_{w}>0$，使得\n$$\n\\big|\\mathbb{E}[\\varphi(Y_{N})] - \\mathbb{E}[\\varphi(X_{T})]\\big| \\leq C_{w}\\,h.\n$$\n2. 离散化下支付函数的单位方差界：存在一个常数 $C_{v} \\leq 1$，使得\n$$\n\\mathrm{Var}\\big(\\varphi(Y_{N})\\big) \\leq C_{v} \\leq 1.\n$$\n\n使用估计量 $\\widehat{\\mu}_{M,h}$ 的均方误差 (MSE)，其定义为\n$$\n\\mathrm{MSE}(M,h) := \\mathbb{E}\\Big[\\big(\\widehat{\\mu}_{M,h} - \\mu\\big)^{2}\\Big],\n$$\n推导时间步长 $h$ 和样本数量 $M$ 关于用户给定的精度 $\\varepsilon \\in (0,1)$ 的渐近标度关系，使得均方根误差 $\\sqrt{\\mathrm{MSE}(M,h)}$ 被 $\\varepsilon$ 界定（不计与 $\\varepsilon$ 无关的乘法常数）。将你的最终答案表示为一个单行矩阵，其中包含 $h$ 和 $M$ 关于 $\\varepsilon$ 的主阶标度。", "solution": "问题陈述的解析和验证如下。\n\n### 步骤1：提取已知条件\n- **随机微分方程 (SDE):** $dX_{t} = a(X_{t})\\,dt + b(X_{t})\\,dW_{t}$\n- **初始条件：** $X_{0} = x_{0}$ (确定性的)\n- **时间区间：** $[0,T]$\n- **系数：** $a$ 和 $b$ 是全局利普希茨连续的。\n- **随机过程：** $(W_{t})_{t \\geq 0}$ 是一个标准布朗运动。\n- **测试函数：** $\\varphi:\\mathbb{R}\\to\\mathbb{R}$，具有多项式增长。\n- **待求量：** $\\mu := \\mathbb{E}[\\varphi(X_{T})]$\n- **欧拉-丸山 (EM) 格式：**\n  - 时间步长 $h>0$，步数 $N := T/h \\in \\mathbb{N}$。\n  - $Y_{0} := x_{0}$\n  - $Y_{n+1} := Y_{n} + a(Y_{n})\\,h + b(Y_{n})\\,\\Delta W_{n}$，其中 $n=0,1,\\dots,N-1$。\n  - $\\Delta W_{n}$ 是独立同分布的 (i.i.d.)，且 $\\Delta W_{n} \\sim \\mathcal{N}(0,h)$。\n- **蒙特卡洛估计量：**\n  - $\\widehat{\\mu}_{M,h} := \\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big)$，其中 $M \\in \\mathbb{N}$ 是独立同分布路径的数量。\n- **假设1 (弱收敛阶)：** 存在一个常数 $C_{w}>0$，使得 $\\big|\\mathbb{E}[\\varphi(Y_{N})] - \\mathbb{E}[\\varphi(X_{T})]\\big| \\leq C_{w}\\,h$。\n- **假设2 (方差界)：** 存在一个常数 $C_{v} \\leq 1$，使得 $\\mathrm{Var}\\big(\\varphi(Y_{N})\\big) \\leq C_{v}$。\n- **误差度量：** 均方误差 (MSE)，$\\mathrm{MSE}(M,h) := \\mathbb{E}\\Big[\\big(\\widehat{\\mu}_{M,h} - \\mu\\big)^{2}\\Big]$。\n- **目标：** 推导 $h$ 和 $M$ 关于给定精度 $\\varepsilon \\in (0,1)$ 的渐近标度关系，使得 $\\sqrt{\\mathrm{MSE}(M,h)} \\leq \\varepsilon$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在随机微分方程数值分析领域具有坚实的科学基础。它提出了一个标准任务：分析蒙特卡洛方法与时间离散化格式相结合的误差。包括 SDE 的形式、系数的性质、欧拉-丸山格式以及关于弱收敛阶和方差的假设在内的所有前提条件，在相关文献（例如，Kloeden  Platen 或 Glasserman 的著作）中都是标准的。该问题是适定的、客观的、自洽的，并且没有任何科学或逻辑上的缺陷。\n\n### 步骤3：结论与行动\n问题被判定为有效。将提供完整解法。\n\n### 解法推导\n目标是找到时间步长 $h$ 和蒙特卡洛样本数量 $M$ 的渐近标度关系，以确保均方根误差 (RMSE) 被给定的容差 $\\varepsilon$ 界定。RMSE 定义为 $\\sqrt{\\mathrm{MSE}(M,h)}$。条件为 $\\sqrt{\\mathrm{MSE}(M,h)} \\leq \\varepsilon$，等价于 $\\mathrm{MSE}(M,h) \\leq \\varepsilon^{2}$。\n\n均方误差可以分解为估计量偏差的平方和方差：\n$$\n\\mathrm{MSE}(M,h) = \\mathbb{E}\\Big[\\big(\\widehat{\\mu}_{M,h} - \\mu\\big)^{2}\\Big] = \\Big(\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] - \\mu\\Big)^{2} + \\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big).\n$$\n\n首先，我们分析偏差项 $\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] - \\mu$。估计量 $\\widehat{\\mu}_{M,h}$ 的期望是：\n$$\n\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] = \\mathbb{E}\\left[\\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big)\\right].\n$$\n根据期望的线性性质，并且由于路径 $(Y_{N}^{(m)})_{m=1}^{M}$ 是独立同分布的，我们有：\n$$\n\\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] = \\frac{1}{M}\\sum_{m=1}^{M} \\mathbb{E}\\left[\\varphi\\big(Y_{N}^{(m)}\\big)\\right] = \\frac{1}{M} \\cdot M \\cdot \\mathbb{E}\\left[\\varphi\\big(Y_{N}\\big)\\right] = \\mathbb{E}\\left[\\varphi\\big(Y_{N}\\big)\\right].\n$$\n因此，偏差就是欧拉-丸山格式的弱误差：\n$$\n\\text{Bias} = \\mathbb{E}\\big[\\widehat{\\mu}_{M,h}\\big] - \\mu = \\mathbb{E}\\left[\\varphi\\big(Y_{N}\\big)\\right] - \\mathbb{E}\\left[\\varphi\\big(X_{T}\\big)\\right].\n$$\n使用假设1，偏差的绝对值有界：\n$$\n\\big|\\text{Bias}\\big| \\leq C_{w}h.\n$$\n因此，偏差的平方有界：\n$$\n(\\text{Bias})^{2} \\leq (C_{w}h)^{2} = C_{w}^{2}h^{2}.\n$$\n\n其次，我们分析方差项 $\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big)$。\n$$\n\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big) = \\mathrm{Var}\\left(\\frac{1}{M}\\sum_{m=1}^{M} \\varphi\\big(Y_{N}^{(m)}\\big)\\right).\n$$\n由于路径是独立同分布的，随机变量 $\\varphi\\big(Y_{N}^{(m)}\\big)$ 也是独立同分布的。对于独立同分布随机变量的和，其方差为：\n$$\n\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big) = \\frac{1}{M^{2}}\\sum_{m=1}^{M} \\mathrm{Var}\\left(\\varphi\\big(Y_{N}^{(m)}\\big)\\right) = \\frac{1}{M^{2}} \\cdot M \\cdot \\mathrm{Var}\\left(\\varphi\\big(Y_{N}\\big)\\right) = \\frac{1}{M} \\mathrm{Var}\\left(\\varphi\\big(Y_{N}\\big)\\right).\n$$\n使用假设2，方差有界：\n$$\n\\mathrm{Var}\\big(\\widehat{\\mu}_{M,h}\\big) \\leq \\frac{C_{v}}{M}.\n$$\n\n结合偏差平方和方差的界，我们得到 MSE 的一个上界：\n$$\n\\mathrm{MSE}(M,h) \\leq C_{w}^{2}h^{2} + \\frac{C_{v}}{M}.\n$$\n为了满足精度要求 $\\mathrm{MSE}(M,h) \\leq \\varepsilon^{2}$，我们必须有：\n$$\nC_{w}^{2}h^{2} + \\frac{C_{v}}{M} \\leq \\varepsilon^{2}.\n$$\n为了找到 $h$ 和 $M$ 关于 $\\varepsilon$ 的渐近标度关系，我们需要选择 $h$ 和 $M$ 以满足此不等式。一种标准方法是平衡两个误差分量，即离散化误差（来自 $h$）和统计误差（来自 $M$），使它们与目标总平方误差 $\\varepsilon^{2}$ 具有相同的数量级。我们可以要求每一项都被 $\\frac{\\varepsilon^{2}}{2}$ 界定：\n$$\nC_{w}^{2}h^{2} \\leq \\frac{\\varepsilon^{2}}{2} \\quad \\text{和} \\quad \\frac{C_{v}}{M} \\leq \\frac{\\varepsilon^{2}}{2}.\n$$\n将这两个不等式相加，可以保证总 MSE 被 $\\varepsilon^{2}$ 界定。\n\n从第一个不等式，我们推导出 $h$ 的标度关系：\n$$\nh^{2} \\leq \\frac{\\varepsilon^{2}}{2C_{w}^{2}} \\implies h \\leq \\frac{\\varepsilon}{\\sqrt{2}C_{w}}.\n$$\n这表明为达到所需精度，$h$ 的选择必须与 $\\varepsilon$ 成正比。渐近标度关系为 $h = \\mathcal{O}(\\varepsilon)$。\n\n从第二个不等式，我们推导出 $M$ 的标度关系：\n$$\nM \\geq \\frac{2C_{v}}{\\varepsilon^{2}}.\n$$\n这表明 $M$ 的选择必须与 $\\varepsilon^{-2}$ 成正比。渐近标度关系为 $M = \\mathcal{O}(\\varepsilon^{-2})$。\n\n主阶标度是关于 $\\varepsilon$ 的主要依赖关系，对于 $h$ 是 $\\varepsilon$，对于 $M$ 是 $\\varepsilon^{-2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\varepsilon & \\varepsilon^{-2}\n\\end{pmatrix}\n}\n$$", "id": "3083399"}]}