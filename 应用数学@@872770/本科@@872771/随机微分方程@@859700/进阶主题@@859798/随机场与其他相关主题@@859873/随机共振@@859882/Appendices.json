{"hands_on_practices": [{"introduction": "随机共振的核心在于时间尺度的匹配。一个关键的内在时间尺度是克拉默斯逃逸率，它描述了在噪声作用下，粒子在不同势阱之间跳跃的速率。这个练习 [@problem_id:3078263] 专注于该速率的指前因子，揭示了势的局部形状——即其在极小值点和势垒顶点的曲率——如何影响跳跃的频率。", "problem": "考虑由以下随机微分方程（SDE）描述的一维过阻尼随机动力学\n$$\n\\gamma \\,\\dot{x}(t) \\,=\\, -U'(x(t)) \\,+\\, \\sqrt{2\\,\\gamma\\,k_B T}\\,\\xi(t),\n$$\n其中，$x(t)$ 是坐标，$\\gamma>0$ 是粘性摩擦系数，$k_B$ 是玻尔兹曼常数，$T>0$ 是绝对温度，$\\xi(t)$ 是标准高斯白噪声，满足 $\\langle \\xi(t)\\rangle=0$ 和 $\\langle \\xi(t)\\,\\xi(s)\\rangle=\\delta(t-s)$。设势函数为\n$$\nU(x)\\,=\\,\\frac{1}{4}x^{4}\\,-\\,\\frac{1}{2}x^{2}.\n$$\n该势函数在 $x=\\pm 1$ 处有两个极小值点，在 $x=0$ 处有一个势垒，这是弱力驱动双阱系统中随机共振的典型设置，其中热激活的阱间跳跃起着核心作用。\n\n从与上述SDE对应的Smoluchowski（过阻尼Fokker–Planck）方程出发，并利用 $U(x)$ 在势阱底部和势垒顶部附近的谐波近似，完成以下任务：\n\n- 计算局部曲率 $U''(\\pm 1)$ 和 $U''(0)$。\n- 在小噪声极限（Arrhenius区）下，通过构建一个穿过势垒的微小稳态概率流，解释这些局部曲率如何进入从 $x=+1$ 的右阱越过 $x=0$ 处势垒的逃逸率的乘法前因子。\n- 利用此推理，确定从 $x=+1$ 越过 $x=0$ 处势垒的逃逸事件中，过阻尼Kramers前因子 $A$（逃逸率中主要指数项的乘法因子）的显式解析表达式，该表达式仅用 $\\gamma$ 表示。\n\n请给出 $A$ 的单一闭式解析表达式作为最终答案。前因子 $A$ 在国际单位制（SI）中的量纲为秒分之一。无需进行数值计算或四舍五入。", "solution": "我们从过阻尼随机微分方程（SDE）开始\n$$\n\\gamma \\,\\dot{x}(t) \\,=\\, -U'(x(t)) \\,+\\, \\sqrt{2\\,\\gamma\\,k_B T}\\,\\xi(t),\n$$\n其中 $\\langle \\xi(t)\\rangle=0$ 且 $\\langle \\xi(t)\\,\\xi(s)\\rangle=\\delta(t-s)$。对应的概率密度 $p(x,t)$ 的Smoluchowski（过阻尼Fokker–Planck）方程是经过充分检验且广泛使用的演化方程\n$$\n\\partial_t p(x,t)\\,=\\,\\frac{1}{\\gamma}\\,\\partial_x\\!\\left(U'(x)\\,p(x,t)\\,+\\,k_B T\\,\\partial_x p(x,t)\\right).\n$$\n在小热噪声（低温）区域，从势阱中逃逸是一个稀有事件。逃逸率由穿过势垒顶部的微小、近似稳态的概率流的存在所决定。在领头阶上，可以在势阱底部和势垒顶部附近对势函数进行谐波近似：\n- 在稳定极小值点 $x=x_a$ 附近，有 $U(x)\\approx U(x_a)+\\frac{1}{2}U''(x_a)\\,(x-x_a)^2$，其中 $U''(x_a)>0$。\n- 在不稳定极大值点 $x=x_b$ 附近，有 $U(x)\\approx U(x_b)+\\frac{1}{2}U''(x_b)\\,(x-x_b)^2$，其中 $U''(x_b)<0$。\n\n小稳态流的构建过程是为Smoluchowski方程寻找一个具有恒定概率流 $J$ 的不依赖于时间的解 $p(x)$：\n$$\nJ \\,=\\, -\\frac{1}{\\gamma}\\left(U'(x)\\,p(x)\\,+\\,k_B T\\,\\partial_x p(x)\\right),\n$$\n该解需满足边界条件，$p(x)$ 在势阱区域内是可归一化的，并且解在势垒区域是匹配的。在小噪声极限下，分布在势阱底部附近是准玻尔兹曼分布，而在势垒顶部附近则由局部线性化动力学和所施加的流 $J$ 控制。匹配这些渐近行为并在势阱中归一化概率质量，可得到经典的Eyring–Kramers结果，即从势阱 $x=x_a$ 越过势垒 $x=x_b$ 的逃逸率 $k$：\n$$\nk \\,\\approx\\, \\frac{1}{2\\pi\\gamma}\\,\\sqrt{U''(x_a)\\,\\big|U''(x_b)\\big|}\\,\\exp\\!\\left(-\\frac{\\Delta U}{k_B T}\\right),\n$$\n其中 $\\Delta U = U(x_b)-U(x_a)$ 是势垒高度。该公式展示了一个由势垒高度控制的Arrhenius指数因子，以及一个依赖于势阱和势垒处局部曲率的前因子，这分别反映了势阱附近准稳态分布的归一化和穿过势垒的反应流。\n\n我们现在专门研究给定的势函数\n$$\nU(x)\\,=\\,\\frac{1}{4}x^{4}\\,-\\,\\frac{1}{2}x^{2}.\n$$\n首先计算导数：\n$$\nU'(x)\\,=\\,x^{3}-x,\\qquad U''(x)\\,=\\,3x^{2}-1.\n$$\n临界点满足 $U'(x)=0$，即 $x\\in\\{0,+1,-1\\}$。在这些点计算二阶导数得到局部曲率：\n$$\nU''(+1)\\,=\\,3\\cdot(+1)^{2}-1\\,=\\,2,\\qquad U''(-1)\\,=\\,3\\cdot(-1)^{2}-1\\,=\\,2,\\qquad U''(0)\\,=\\,3\\cdot 0^{2}-1\\,=\\,-1.\n$$\n因此，在势阱底部 $x_a=+1$，曲率为 $U''(x_a)=2>0$，而在势垒顶部 $x_b=0$，曲率为 $U''(x_b)=-1<0$。这些曲率通过因子 $\\sqrt{U''(x_a)\\,|U''(x_b)|}$ 进入Kramers前因子。\n\n势垒高度为\n$$\n\\Delta U \\,=\\, U(0)-U(+1)\\,=\\,\\left(\\frac{1}{4}\\cdot 0^{4}-\\frac{1}{2}\\cdot 0^{2}\\right)-\\left(\\frac{1}{4}\\cdot 1^{4}-\\frac{1}{2}\\cdot 1^{2}\\right)\\,=\\,0-\\left(\\frac{1}{4}-\\frac{1}{2}\\right)\\,=\\,\\frac{1}{4},\n$$\n它控制着Arrhenius指数项。然而，问题要求的是在过阻尼情况下，对于从 $x=+1$ 越过 $x=0$ 的逃逸，乘以该指数项的前因子 $A$ 的显式解析表达式。根据上面的Eyring–Kramers结构，这个前因子是\n$$\nA \\,=\\, \\frac{1}{2\\pi\\gamma}\\,\\sqrt{U''(+1)\\,\\big|U''(0)\\big|}\\,=\\,\\frac{1}{2\\pi\\gamma}\\,\\sqrt{2\\cdot 1}\\,=\\,\\frac{\\sqrt{2}}{2\\pi\\gamma}.\n$$\n这个 $A$ 的物理量纲是秒分之一，它与指数项 $\\exp\\!\\left(-\\Delta U/(k_B T)\\right)$ 一起决定了逃逸率。在随机共振的背景下，该前因子决定了噪声激活的跳跃率的尺度，当跳跃时间尺度与驱动周期相当时，该跳跃率与外部周期性驱动竞争产生共振。", "answer": "$$\\boxed{\\frac{\\sqrt{2}}{2\\pi\\gamma}}$$", "id": "3078263"}, {"introduction": "虽然像克拉默斯率这样的解析公式能提供关键的洞见，但要探索随机共振的完整动力学过程，通常需要进行数值模拟。一个可靠的模拟始于选择一个合适的时间步长。这个实践 [@problem_id:3078198] 将指导你如何建立一个欧拉-丸山（Euler-Maruyama）格式，更重要的是，如何确定一个足够小的时间步长 $\\Delta t$，以精确捕捉势阱内的快速弛豫和较慢的周期性驱动力。", "problem": "考虑 Itô 随机微分方程 (SDE) $dx_t=-U'(x_t)\\,dt+A\\cos(\\omega t)\\,dt+\\sqrt{2D}\\,dW_t$，其中 $U(x)$ 是一个二阶连续可微的势，$A$ 是一个确定性驱动振幅，$\\omega$ 是一个驱动角频率，单位为弧度/秒，$D$ 是一个严格为正的扩散水平，$W_t$ 是一个标准 Wiener 过程。您的任务是：\n1. 从 Itô 随机微分方程的定义和 Wiener 过程增量的性质出发，推导一个单步显式 Euler–Maruyama 更新规则，用于在均匀网格 $t_n=n\\Delta t$ 上近似 $x_t$ 的演化。得到的更新规则必须用 $x_n$、$t_n$ 以及一个均值为零、方差为 $ \\Delta t $ 的高斯增量来表示。\n2. 利用 $U(x)$ 每个局部最小值附近的确定性漂移的线性化以及外部驱动的周期，论证并指定一个时间步长 $\\Delta t$ 的选择，该步长能解析驱动周期和最快的阱内弛豫。将 $\\Delta t$ 限制在小于驱动解析阈值和弛豫解析阈值。使用以下量化解析目标：\n   - 每个驱动周期 $T=\\dfrac{2\\pi}{\\omega}$ 至少包含 $N_T=200$ 个时间步。\n   - 每个最快阱内弛豫时间 $\\tau_{\\min}=\\dfrac{1}{\\max_{x\\in\\mathcal{M}}U''(x)}$ 至少包含 $N_\\tau=20$ 个时间步，其中 $\\mathcal{M}$ 是 $U(x)$ 的局部最小值集合，$U''(x)$ 表示 $U(x)$ 的二阶导数。\n   在这些目标下，设定 $\\Delta t=\\min\\left(\\dfrac{T}{N_T},\\dfrac{\\tau_{\\min}}{N_\\tau}\\right)$。\n3. 实现一个程序，对下面列出的每个测试用例，计算推荐的时间步长 $\\Delta t$（单位为秒），并将结果四舍五入到小数点后 $6$ 位输出。$\\omega$ 的角度单位必须是弧度，所有时间值必须以秒表示。程序可以假设摩擦已被无量纲化为1，因此在最小值点 $x^\\ast$ 处的线性化弛豫率等于 $U''(x^\\ast)$。\n\n使用下面这套势和参数的测试組，其设计旨在探究使用显式 Euler–Maruyama 离散化的随机共振建模中的典型、边界和边缘情景：\n- 测试用例 1 (双阱四次势)：$U(x)=\\dfrac{a}{4}x^4-\\dfrac{b}{2}x^2$，其中 $a=1.0$, $b=1.0$, $A=0.2$, $\\omega=0.5$, $D=0.02$。对于该势，局部最小值位于 $x=\\pm\\sqrt{\\dfrac{b}{a}}$，且每个最小值点的曲率等于 $U''(x)=2b$。\n- 测试用例 2 (谐振势)：$U(x)=\\dfrac{k}{2}x^2$，其中 $k=10.0$, $A=0.05$, $\\omega=5.0$, $D=0.01$。唯一最小值点的曲率等于 $U''(0)=k$。\n- 测试用例 3 (谐振势，刚性漂移)：$U(x)=\\dfrac{k}{2}x^2$，其中 $k=100.0$, $A=0.10$, $\\omega=1.0$, $D=0.05$。\n- 测试用例 4 (谐振势，快速驱动)：$U(x)=\\dfrac{k}{2}x^2$，其中 $k=2.0$, $A=0.10$, $\\omega=100.0$, $D=0.05$。\n- 测试用例 5 (谐振势，慢速驱动)：$U(x)=\\dfrac{k}{2}x^2$，其中 $k=5.0$, $A=0.10$, $\\omega=0.01$, $D=0.05$。\n\n程序要求：\n- 对每个测试用例，使用 $N_T=200$ 和 $N_\\tau=20$ 计算 $\\Delta t=\\min\\left(\\dfrac{2\\pi/\\omega}{N_T},\\dfrac{1/\\max U''(x_{\\min})}{N_\\tau}\\right)$，其中 $\\max U''(x_{\\min})$ 表示所有最小值点中最大的曲率。\n- 输出一行结果，格式为方括号内包含的逗号分隔列表，每个 $\\Delta t$ 值都四舍五入到小数点后 6 位，并以秒为单位。例如，输出格式必须与 $[\\Delta t_1,\\Delta t_2,\\Delta t_3,\\Delta t_4,\\Delta t_5]$ 完全一样。\n- 您的程序必须是一个完整、可运行的实现，且不得读取任何输入或写入任何文件。", "solution": "该问题具有科学依据、问题适定且客观。所有参数和约束都已明确定义，从而可以得出一个唯一且有意义的解。因此，我们可以进行推导和计算。\n\n该问题要求完成三项任务：首先，为给定的 Itô 随机微分方程 (SDE) 推导显式 Euler–Maruyama 更新规则；其次，论证模拟时间步长 $\\Delta t$ 的选择；第三，实现一个程序，为一组测试用例计算此 $\\Delta t$。\n\n**1. Euler–Maruyama 更新规则的推导**\n\n系统的演化由以下 Itô SDE 描述：\n$$dx_t = -U'(x_t)\\,dt + A\\cos(\\omega t)\\,dt + \\sqrt{2D}\\,dW_t$$\n这可以写成积分形式。从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 进行积分，我们得到：\n$$x(t_{n+1}) - x(t_n) = \\int_{t_n}^{t_{n+1}} \\left(-U'(x_s) + A\\cos(\\omega s)\\right) ds + \\int_{t_n}^{t_{n+1}} \\sqrt{2D}\\,dW_s$$\nEuler–Maruyama 方法为该积分方程提供了一阶近似。其核心思想是假设在微小时间区间 $[t_n, t_{n+1}]$ 内被积函数近似为常数，并可在该区间的起点 $t_n$ 处取值。\n\n令 $x_n = x(t_n)$。确定性积分（漂移项）近似为：\n$$\\int_{t_n}^{t_{n+1}} \\left(-U'(x_s) + A\\cos(\\omega s)\\right) ds \\approx \\left(-U'(x_n) + A\\cos(\\omega t_n)\\right) \\Delta t$$\n随机积分（扩散项）的计算如下：\n$$\\int_{t_n}^{t_{n+1}} \\sqrt{2D}\\,dW_s = \\sqrt{2D} \\int_{t_n}^{t_{n+1}} dW_s = \\sqrt{2D} (W_{t_{n+1}} - W_{t_n})$$\nWiener 过程的增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 是一个高斯随机变量，其均值为 $E[\\Delta W_n] = 0$，方差为 $Var[\\Delta W_n] = t_{n+1} - t_n = \\Delta t$。因此，$\\Delta W_n$ 是服从 $\\mathcal{N}(0, \\Delta t)$ 分布的随机变量的一个实现。根据要求，这是一个均值为零、方差为 $\\Delta t$ 的高斯增量。我们可以将此增量表示为 $\\Delta W_n = \\sqrt{\\Delta t} Z_n$，其中 $Z_n$ 是一个标准正态随机变量，$Z_n \\sim \\mathcal{N}(0, 1)$。\n\n将这些近似代回积分方程，得到单步显式 Euler–Maruyama 更新规则：\n$$x_{n+1} = x_n + \\left(-U'(x_n) + A\\cos(\\omega t_n)\\right) \\Delta t + \\sqrt{2D} \\Delta W_n$$\n或者，用标准正态离差 $Z_n$ 来表示：\n$$x_{n+1} = x_n + \\left(-U'(x_n) + A\\cos(\\omega t_n)\\right) \\Delta t + \\sqrt{2D\\Delta t} Z_n$$\n该方程描述了状态变量 $x$ 在离散时间网格 $t_n = n\\Delta t$ 上的近似演化。\n\n**2. 时间步长 $\\Delta t$ 的论证与指定**\n\n数值模拟必须使用足够小的时间步长 $\\Delta t$ 来解析系统中所有相关的物理时间尺度。否则可能导致数值不稳定和结果不准确。给定的 SDE 有两个不同的确定性时间尺度，它们决定了 $\\Delta t$ 的选择。\n\n第一个时间尺度与外部周期性驱动 $A\\cos(\\omega t)$ 相关。该驱动的周期为 $T = \\frac{2\\pi}{\\omega}$。为了准确捕捉正弦变化，时间步长 $\\Delta t$ 必须是该周期的一小部分。问题指定了每个周期至少 $N_T = 200$ 个时间步的解析度要求。这施加了以下约束：\n$$\\Delta t \\le \\frac{T}{N_T} = \\frac{2\\pi}{\\omega N_T}$$\n\n第二个时间尺度是阱内弛豫时间。在没有驱动和噪声的情况下，粒子的动力学由确定性常微分方程(ODE) $\\frac{dx}{dt} = -U'(x)$ 控制。在势 $U(x)$ 的局部最小值 $x^\\ast$ 附近，我们可以通过对 $U'(x)$ 在 $x=x^\\ast$ 周围进行 Taylor 展开来线性化漂移项：\n$U'(x) \\approx U'(x^\\ast) + U''(x^\\ast)(x - x^\\ast)$。\n由于 $x^\\ast$ 是一个最小值点，一阶导数为零，$U'(x^\\ast) = 0$。令 $\\delta x = x - x^\\ast$ 为偏离最小值的位移，线性化的运动方程变为：\n$$\\frac{d(\\delta x)}{dt} = -U''(x^\\ast) \\delta x$$\n这个线性 ODE 的解形式为 $\\delta x(t) = \\delta x(0) e^{-t/\\tau_{relax}}$，其中弛豫时间 $\\tau_{relax}$ 由 $\\tau_{relax} = \\frac{1}{U''(x^\\ast)}$ 给出。这是粒子在受到微小扰动后弛豫回到势阱底部的特征时间。问题陈述通过假设单位摩擦系数来证实这一点。对于像前向 Euler 这样的数值方法，为了保证稳定性和准确性，时间步长 $\\Delta t$ 必须显著小于这个弛豫时间。\n\n势 $U(x)$ 可能有多个局部最小值点，每个点可能具有不同的曲率 $U''(x^\\ast)$，因而有不同的弛豫时间。最严格的约束来自最快的弛豫过程，它发生在曲率最大（即“最陡峭”）的阱中。这对应于最小弛豫时间 $\\tau_{\\min}$：\n$$\\tau_{\\min} = \\frac{1}{\\max_{x\\in\\mathcal{M}} U''(x)}$$\n其中 $\\mathcal{M}$ 是所有局部最小值的集合。问题指定了对这个最快弛豫过程至少 $N_\\tau = 20$ 个时间步的解析度。这施加了第二个约束：\n$$\\Delta t \\le \\frac{\\tau_{\\min}}{N_\\tau} = \\frac{1}{N_\\tau \\max_{x\\in\\mathcal{M}} U''(x)}$$\n\n为确保驱动和最快的内禀动力学过程都能得到解析，$\\Delta t$ 必须同时满足这两个约束。因此，我们必须选择 $\\Delta t$ 不大于这两个上界的最小值。问题指导我们将 $\\Delta t$ 设置为这个最小值：\n$$\\Delta t = \\min\\left(\\frac{T}{N_T}, \\frac{\\tau_{\\min}}{N_\\tau}\\right) = \\min\\left(\\frac{2\\pi}{\\omega N_T}, \\frac{1}{N_\\tau \\max_{x\\in\\mathcal{M}} U''(x)}\\right)$$\n这个选择确保了 Euler–Maruyama 模拟相对于主导的确定性时间尺度的数值稳定性和准确性。\n\n**3. 实现与测试用例计算**\n\n我们现在将实现一个程序，使用推导出的公式为给定的测试用例计算 $\\Delta t$，其中常量 $N_T = 200$ 和 $N_\\tau = 20$。所需的参数是驱动频率 $\\omega$ 和势的最小值点处的最大曲率 $\\max U''(x_{\\min})$。\n\n对每个测试用例：\n- **测试用例 1**：$U(x)=\\frac{a}{4}x^4-\\frac{b}{2}x^2$，其中 $a=1.0, b=1.0$，且 $\\omega=0.5$。最小值点的曲率给定为 $2b=2.0$。\n  $\\Delta t_{force} = \\frac{2\\pi}{0.5 \\times 200} = \\frac{\\pi}{50} \\approx 0.062832$。\n  $\\Delta t_{relax} = \\frac{1}{20 \\times 2.0} = \\frac{1}{40} = 0.025$。\n  $\\Delta t = \\min(0.062832, 0.025) = 0.025$。\n\n- **测试用例 2**：$U(x)=\\frac{k}{2}x^2$，其中 $k=10.0$ 且 $\\omega=5.0$。曲率为 $k=10.0$。\n  $\\Delta t_{force} = \\frac{2\\pi}{5.0 \\times 200} = \\frac{\\pi}{500} \\approx 0.006283$。\n  $\\Delta t_{relax} = \\frac{1}{20 \\times 10.0} = \\frac{1}{200} = 0.005$。\n  $\\Delta t = \\min(0.006283, 0.005) = 0.005$。\n\n- **测试用例 3**：$U(x)=\\frac{k}{2}x^2$，其中 $k=100.0$ 且 $\\omega=1.0$。曲率为 $k=100.0$。\n  $\\Delta t_{force} = \\frac{2\\pi}{1.0 \\times 200} = \\frac{\\pi}{100} \\approx 0.031416$。\n  $\\Delta t_{relax} = \\frac{1}{20 \\times 100.0} = \\frac{1}{2000} = 0.0005$。\n  $\\Delta t = \\min(0.031416, 0.0005) = 0.0005$。\n\n- **测试用例 4**：$U(x)=\\frac{k}{2}x^2$，其中 $k=2.0$ 且 $\\omega=100.0$。曲率为 $k=2.0$。\n  $\\Delta t_{force} = \\frac{2\\pi}{100.0 \\times 200} = \\frac{\\pi}{10000} \\approx 0.000314$。\n  $\\Delta t_{relax} = \\frac{1}{20 \\times 2.0} = \\frac{1}{40} = 0.025$。\n  $\\Delta t = \\min(0.000314, 0.025) = 0.000314$。\n\n- **测试用例 5**：$U(x)=\\frac{k}{2}x^2$，其中 $k=5.0$ 且 $\\omega=0.01$。曲率为 $k=5.0$。\n  $\\Delta t_{force} = \\frac{2\\pi}{0.01 \\times 200} = \\pi \\approx 3.141593$。\n  $\\Delta t_{relax} = \\frac{1}{20 \\times 5.0} = \\frac{1}{100} = 0.01$。\n  $\\Delta t = \\min(3.141593, 0.01) = 0.01$。\n\n最终答案中的程序将实现这些计算。", "answer": "[0.025000,0.005000,0.000500,0.000314,0.010000]", "id": "3078198"}, {"introduction": "一旦我们能够可靠地模拟粒子的运动轨迹，下一步就是量化随机共振效应的强度。最常用的度量标准是信噪比 (SNR)，它衡量了系统的输出与微弱输入信号同步的程度。最后一个练习 [@problem_id:3078235] 提供了一个处理模拟时间序列的完整工作流程，用于计算功率谱并提取信噪比，使你能够观察到当噪声强度变化时共振峰的出现。", "problem": "考虑一个粒子在对称双阱势中受到弱正弦驱动的过阻尼朗之万方程（一种伊藤随机微分方程），其形式如下：\n$$\ndx_t = \\left(x_t - x_t^3 + A \\cos(\\omega t)\\right)\\,dt + \\sqrt{2D}\\,dW_t,\n$$\n其中 $x_t$ 是状态变量，$A$ 是驱动振幅，$\\omega$ 是角频率（单位为弧度/秒），$D$ 是噪声强度（无量纲），$W_t$ 是标准维纳过程。确定性漂移源于势能 $U(x) = \\frac{x^4}{4} - \\frac{x^2}{2}$，因为 $-U'(x) = x - x^3$。$x$ 和 $A$ 使用无量纲单位，时间单位为秒。\n\n您的任务是：\n1. 从伊藤随机微分方程的定义出发，使用欧拉-丸山方法和均匀时间步长 $\\Delta t$ 对动力学进行离散化。在总时间 $T$ 内模拟 $M$ 个独立的轨迹实现 $\\{x_n\\}_{n=0}^{N-1}$，其中 $N = T / \\Delta t$。\n2. 对于每个实现，计算去均值信号 $\\{x_n - \\bar{x}\\}$ 的离散傅里叶变换（DFT），其中 $\\bar{x}$ 是该实现的时间平均值。使用单边周期图估计驱动频率附近的功率谱密度。具体来说，设 $X_k$ 是频率仓 $k$ 处的离散傅里叶变换。单边周期图定义为\n$$\nP_k = \\frac{\\Delta t}{N} \\left|X_k\\right|^2,\n$$\n并进行标准的单边调整，即对于严格介于零频率和奈奎斯特频率之间的频率仓，将其值乘以 $2$。\n3. 将 $M$ 个实现的周期图进行平均以减小方差，得到 $\\overline{P}_k$。\n4. 通过计算驱动频率 $f_0 = \\omega/(2\\pi)$ 对应频率仓 $k_0$ 处的平均周期图值与 $k_0$ 周围一个频带内邻近仓的平均值之比，来估计驱动角频率 $\\omega$ 处的信噪比（SNR）。该频带不包括中心仓及其紧邻的仓。设频率分辨率为 $\\Delta f = 1/T$，且 $k_0 = \\text{round}(f_0 / \\Delta f)$。在两侧使用宽度为 $B$ 个仓的对称频带，并将噪声基底计算为 $k \\in [k_0 - B, k_0 + B]$（不包括 $k_0$、$k_0 - 1$、$k_0 + 1$ 以及任何非正或超出范围的索引）范围内 $\\overline{P}_k$ 的算术平均值。然后定义\n$$\n\\text{SNR} = \\frac{\\overline{P}_{k_0}}{\\text{mean noise floor}}.\n$$\nSNR 是一个无量纲量。\n\n在所有模拟中，除非测试套件中另有说明，否则使用以下参数值：$\\Delta t = 0.01$，$T = 200$，$A = 0.25$，$\\omega = 2\\pi \\cdot 0.05$，$B = 8$。每个实现从 $x_0 = -1$ 开始初始化。为保证可复现性，请使用固定的随机种子，并以弧度表示角度。\n\n测试套件：\n- 情况 1（正常路径，低噪声，小编组）：$D = 0.02$，$M = 5$。\n- 情况 2（近共振噪声，较大编组）：$D = 0.12$，$M = 20$。\n- 情况 3（高噪声，较大编组）：$D = 0.60$，$M = 20$。\n\n您的程序必须：\n- 实现欧拉-丸山方案以模拟轨迹。\n- 按规定计算并平均周期图。\n- 为每个测试用例计算 SNR。\n- 生成单行输出，其中包含三个 SNR 值，以逗号分隔的列表形式封装在方括号内，无空格，并按测试套件的顺序排列，例如 $[s_1,s_2,s_3]$。\n\n无需外部输入。唯一允许使用的库是 Python 标准库、NumPy 和 SciPy。角度必须以弧度处理；时间单位为秒；$x$ 和 $A$ 是无量纲的。最终输出必须是浮点数。数值应由您的程序计算得出。", "solution": "该问题要求对一个由过阻尼朗之万方程描述的系统中的随机共振现象进行数值分析。分析涉及模拟系统动力学、计算其功率谱以及估计不同噪声强度下的信噪比（SNR）。\n\n粒子的状态变量 $x_t$ 根据伊藤随机微分方程（SDE）演化：\n$$\ndx_t = \\left(x_t - x_t^3 + A \\cos(\\omega t)\\right)\\,dt + \\sqrt{2D}\\,dW_t\n$$\n该方程模拟了一个粒子在双稳态势 $U(x) = \\frac{x^4}{4} - \\frac{x^2}{2}$ 中的运动，该粒子受到振幅为 $A$、角频率为 $\\omega$ 的弱周期性驱动力，以及一个以标准维纳过程 $W_t$ 和噪声强度 $D$ 为特征的随机力。项 $x - x^3$ 是确定性力 $-U'(x)$。\n\n解决方案分三个阶段展开：SDE 的数值积分、功率谱密度（PSD）的估计以及 SNR 的计算。\n\n**1. 数值模拟：欧拉-丸山方法**\n为了进行数值模拟，需要将连续的 SDE 离散化。我们使用欧拉-丸山方法，这是一种针对 SDE 的一阶格式。SDE 的一般形式为 $dX_t = f(X_t, t)\\,dt + g(X_t, t)\\,dW_t$。对于均匀时间步长 $\\Delta t$，离散更新规则为：\n$$\nx_{n+1} = x_n + f(x_n, t_n)\\Delta t + g(x_n, t_n)\\Delta W_n\n$$\n其中 $x_n \\approx x(t_n)$ 是在时间 $t_n = n \\Delta t$ 的值。项 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 表示维纳过程在 $\\Delta t$ 内的增量。这些增量是独立的、服从正态分布的随机变量，其均值为 $0$，方差为 $\\Delta t$，即 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$。在计算上，这通过 $\\Delta W_n = \\sqrt{\\Delta t} Z_n$ 实现，其中 $Z_n$ 是从标准正态分布 $Z_n \\sim \\mathcal{N}(0, 1)$ 中抽取的随机变量。\n\n对于给定问题，漂移项为 $f(x, t) = x - x^3 + A \\cos(\\omega t)$，扩散项为常数 $g(x, t) = \\sqrt{2D}$。将这些代入欧拉-丸山公式，我们得到粒子状态的迭代方案：\n$$\nx_{n+1} = x_n + \\left(x_n - x_n^3 + A \\cos(\\omega t_n)\\right)\\Delta t + \\sqrt{2D\\Delta t} Z_n\n$$\n从初始条件 $x_0 = -1$ 开始，我们生成一条总长度为 $N = T/\\Delta t$ 步的轨迹 $\\{x_n\\}_{n=0}^{N-1}$。此过程重复进行 $M$ 次独立实现，以确保结果具有统计鲁棒性。\n\n**2. 功率谱密度（PSD）估计**\nPSD 揭示了信号的功率如何在不同频率上分布。在这里，它使我们能够观察系统对周期性驱动的响应。\n\n对于 $M$ 个模拟轨迹中的每一个，我们首先计算去均值信号 $y_n = x_n - \\bar{x}$，其中 $\\bar{x} = \\frac{1}{N}\\sum_{i=0}^{N-1} x_i$。 $\\{y_n\\}$ 的离散傅里叶变换（DFT）定义为：\n$$\nY_k = \\sum_{n=0}^{N-1} y_n e^{-i 2\\pi kn/N}\n$$\n对于频率仓 $k = 0, 1, \\dots, N-1$。与频率仓 $k$ 对应的频率是 $f_k = k/T = k/(N\\Delta t)$。\n\n问题指定使用单边周期图，这是因为对于实数信号，功率谱围绕直流分量是对称的。首先计算双边周期图 $P_k^{\\text{2-sided}} = \\frac{\\Delta t}{N}|Y_k|^2$。然后通过将负频率分量折叠到正频率分量上获得单边周期图 $P_k$：\n$$\nP_k = \\begin{cases}\n\\frac{\\Delta t}{N} |Y_0|^2  &\\text{for } k=0 \\text{ (DC component)} \\\\\n2 \\cdot \\frac{\\Delta t}{N} |Y_k|^2  &\\text{for } 0 < k < N/2 \\\\\n\\frac{\\Delta t}{N} |Y_{N/2}|^2  &\\text{for } k=N/2 \\text{ (Nyquist frequency, if } N \\text{ is even)} \\\\\n\\end{cases}\n$$\n为了减小估计量的方差，将所有 $M$ 个实现的周期图进行平均：\n$$\n\\overline{P}_k = \\frac{1}{M} \\sum_{m=1}^{M} P_k^{(m)}\n$$\n其中 $P_k^{(m)}$ 是第 $m$ 次实现的周期图。\n\n**3. 信噪比（SNR）计算**\nSNR 是衡量频谱中信号峰值（由外部驱动引起）强度与背景噪声水平相对关系的指标。\n\n首先，我们确定与驱动频率 $f_0 = \\omega/(2\\pi)$ 对应的频率仓 $k_0$。频率分辨率为 $\\Delta f = 1/T$。频率仓索引由 $k_0 = \\text{round}(f_0 / \\Delta f) = \\text{round}(\\omega T / (2\\pi))$ 给出。根据给定的参数 $\\omega = 2\\pi \\cdot 0.05$ 和 $T=200$，信号仓为 $k_0 = \\text{round}(0.05 \\cdot 200) = 10$。信号功率 $S$ 是该仓处平均周期图的值：$S = \\overline{P}_{k_0}$。\n\n接下来，通过对信号峰值附近频带内的周期图进行平均来估计噪声基底 $N_{floor}$，为避免偏差，计算中排除了峰值本身。问题指定在 $k_0$ 两侧各使用一个宽度为 $B=8$ 个仓的对称频带，并排除仓 $\\{k_0-1, k_0, k_0+1\\}$。因此，用于噪声计算的索引集合为 $\\mathcal{K}_{noise} = \\{k \\mid k \\in [k_0-B, k_0+B]\\} \\setminus \\{k_0-1, k_0, k_0+1\\}$，并适当处理边界条件（例如 $k>0$）。对于 $k_0=10$ 和 $B=8$，索引为 $k \\in \\{2, 3, ..., 8\\} \\cup \\{12, 13, ..., 18\\}$。噪声基底是这些仓上值的算术平均值：\n$$\nN_{floor} = \\frac{1}{|\\mathcal{K}_{noise}|} \\sum_{k \\in \\mathcal{K}_{noise}} \\overline{P}_k\n$$\n最后，SNR 计算为信号功率与噪声基底之比：\n$$\n\\text{SNR} = \\frac{S}{N_{floor}} = \\frac{\\overline{P}_{k_0}}{N_{floor}}\n$$\n对测试套件中的每种情况执行此过程，以确定 SNR 作为噪声强度 $D$ 的函数。随机共振现象预测，SNR 将在一个非零的最佳 $D$ 值处达到最大。", "answer": "[0.17066914619717148,8.232585250495393,0.3015941916323635]", "id": "3078235"}]}