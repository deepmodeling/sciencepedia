{"hands_on_practices": [{"introduction": "克拉克-奥肯公式不仅是一个理论上的表达式，它还揭示了随机变量方差与鞅表示积分项范数之间的深刻联系。这个练习将通过一个具体例子 $F = W_T^2$ 来验证这一核心恒等式。通过计算积分项并分别计算等式两边的值，你将亲手验证理论的正确性，从而加深对该公式内在几何意义的理解。[@problem_id:3079912]", "problem": "设 $\\{W_t\\}_{t \\in [0,T]}$ 为在满足通常条件的带域流的概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_t\\}_{t \\in [0,T]},\\mathbb{P})$ 上的标准布朗运动，并令 $F := W_T^2 \\in L^2(\\Omega,\\mathcal{F}_T,\\mathbb{P})$。考虑 Malliavin 导数过程 $\\{D_t F\\}_{t \\in [0,T]}$，其定义为 $D_t W_T = \\mathbf{1}_{\\{t \\leq T\\}}$ 且链式法则成立。定义可料过程 $\\{\\varphi_t\\}_{t \\in [0,T]}$ 为 $\\varphi_t := \\mathbb{E}[D_t F \\mid \\mathcal{F}_t]$。\n\n仅使用布朗运动的基本性质、高斯矩、Malliavin 导数的链式法则以及随机积分的 Itô 等距定理，完成以下任务：\n\n- 显式计算 $\\varphi_t$。\n- 计算量 $A := \\mathbb{E}\\big[(F - \\mathbb{E}[F])^2\\big]$。\n- 计算量 $B := \\mathbb{E}\\!\\left[\\int_0^T \\varphi_t^2 \\, dt\\right]$。\n\n最后，将 $A$ 和 $B$ 的共同值以关于 $T$ 的单一闭式表达式形式报告。将最终答案表示为符号表达式。不包含单位。不要四舍五入。", "solution": "我们从布朗运动的标准性质和随机分析中的相关工具出发，逐步进行。\n\n首先，我们确定 $F = W_T^2$ 的 Malliavin 导数。Malliavin 导数满足 $D_t W_T = \\mathbf{1}_{\\{t \\leq T\\}}$ 并且服从链式法则。因此，\n$$\nD_t F \\;=\\; D_t\\big(W_T^2\\big) \\;=\\; 2 W_T \\, D_t W_T \\;=\\; 2 W_T \\, \\mathbf{1}_{\\{t \\leq T\\}}.\n$$\n根据定义，可料过程 $\\varphi_t$ 由条件期望给出\n$$\n\\varphi_t \\;=\\; \\mathbb{E}\\!\\left[D_t F \\,\\middle|\\, \\mathcal{F}_t\\right] \\;=\\; \\mathbb{E}\\!\\left[2 W_T \\mathbf{1}_{\\{t \\leq T\\}} \\,\\middle|\\, \\mathcal{F}_t\\right] \\;=\\; 2\\,\\mathbf{1}_{\\{t \\leq T\\}}\\, \\mathbb{E}\\!\\left[W_T \\,\\middle|\\, \\mathcal{F}_t\\right].\n$$\n使用布朗运动的独立增量性质，写出 $W_T = W_t + (W_T - W_t)$，其中 $W_T - W_t$ 独立于 $\\mathcal{F}_t$ 且均值为 0。因此，\n$$\n\\mathbb{E}\\!\\left[W_T \\,\\middle|\\, \\mathcal{F}_t\\right] \\;=\\; W_t,\n$$\n从而\n$$\n\\varphi_t \\;=\\; 2 W_t \\quad \\text{对于 } t \\in [0,T].\n$$\n\n接下来，计算 $A := \\mathbb{E}\\big[(F - \\mathbb{E}[F])^2\\big]$，即 $F$ 的方差。由于 $W_T \\sim \\mathcal{N}(0,T)$，我们有 $\\mathbb{E}[W_T^2] = T$ 和 $\\mathbb{E}[W_T^4] = 3 T^2$（中心化高斯分布的四阶矩）。于是，\n$$\nA \\;=\\; \\mathrm{Var}(W_T^2) \\;=\\; \\mathbb{E}[W_T^4] - \\big(\\mathbb{E}[W_T^2]\\big)^2 \\;=\\; 3 T^2 - T^2 \\;=\\; 2 T^2.\n$$\n\n现在计算 $B := \\mathbb{E}\\!\\left[\\int_0^T \\varphi_t^2 \\, dt\\right]$。代入 $\\varphi_t = 2 W_t$ 得到\n$$\nB \\;=\\; \\mathbb{E}\\!\\left[\\int_0^T (2 W_t)^2 \\, dt\\right] \\;=\\; 4 \\int_0^T \\mathbb{E}[W_t^2] \\, dt.\n$$\n对于布朗运动，$\\mathbb{E}[W_t^2] = t$。因此，\n$$\nB \\;=\\; 4 \\int_0^T t \\, dt \\;=\\; 4 \\cdot \\frac{T^2}{2} \\;=\\; 2 T^2.\n$$\n\n我们得到了 $A = 2 T^2$ 和 $B = 2 T^2$，这通过显式计算验证了对于 $F = W_T^2$，这两个范数是相等的，这与 Clark-Ocone 表示和 Itô 等距定理相关的范数恒等式是一致的。\n\n因此，需要报告的共同值为\n$$\n2 T^2.\n$$", "answer": "$$\\boxed{2 T^{2}}$$", "id": "3079912"}, {"introduction": "在许多实际应用，尤其是在金融数学中，我们遇到的随机变量并非总是由光滑函数生成，例如欧式看涨期权的收益 $F = \\max(W_T, 0)$。本练习旨在教你如何处理这类非光滑函数，通过构造一个光滑函数序列来逼近原函数，然后运用克拉克-奥肯公式并取极限。这个方法不仅展示了分析中的一个强大技巧，也揭示了对冲策略（积分项）与概率（正态分布函数）之间的迷人联系。[@problem_id:3000571]", "problem": "设 $\\{W_{t}\\}_{t \\in [0,T]}$ 为一个带滤概率空间 $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\in [0,T]},\\mathbb{P})$ 上的标准布朗运动，该空间满足通常条件。考虑终值泛函 $F = \\max(W_{T},0)$。\n\n1. 构造一族光滑函数 $\\{f_{\\epsilon}\\}_{\\epsilon>0}$，$f_{\\epsilon}:\\mathbb{R}\\to\\mathbb{R}$，使得当 $\\epsilon \\to 0$ 时，$f_{\\epsilon}(x)$ 逐点收敛于 $x^{+}$，并且对于每个固定的 $\\epsilon>0$，$f_{\\epsilon}$ 具有有界且连续的一阶导数。证明当 $\\epsilon \\to 0$ 时，$f_{\\epsilon}(W_{T})$ 在 $L^{2}(\\Omega)$ 空间中收敛于 $F$。\n\n2. 使用 Wiener 空间上 Malliavin 微积分的基本定义（特别是 $W_{T}$ 泛函的 Malliavin 导数和链式法则），计算 Malliavin 导数 $D_{t}\\big(f_{\\epsilon}(W_{T})\\big)$，其中 $t \\in [0,T]$。\n\n3. 利用布朗运动增量的独立性和条件期望的标准性质，将 $\\mathbb{E}\\big[D_{t}\\big(f_{\\epsilon}(W_{T})\\big)\\,|\\,\\mathcal{F}_{t}\\big]$ 用 $W_{t}$ 和 $W_{T}-W_{t}$ 的分布来表示。然后分析当 $\\epsilon \\to 0$ 时的极限，以得到在 $F$ 关于 $\\{W_{t}\\}$ 的鞅表示中出现的可料积分项 $g_{t}$。\n\n你的最终任务是报告在第 3 步中得到的 $g_{t}$ 的极限解析表达式（对 $t \\in [0,T)$ 有效）。最终答案必须是单个闭式表达式。", "solution": "该问题要求在泛函 $F = \\max(W_{T},0) = W_{T}^{+}$ 的 Clark-Ocone 鞅表示中找到可料积分项 $g_{t}$。Clark-Ocone 公式指出，对于一个合适的泛函 $F$，其 Itô 表示为 $F = \\mathbb{E}[F] + \\int_{0}^{T} g_{t} dW_{t}$，其中积分项为 $g_{t} = \\mathbb{E}[D_{t}F | \\mathcal{F}_{t}]$。该问题引导我们通过一个涉及 $F$ 的光滑逼近的三步过程来求解。\n\n函数 $x \\mapsto \\max(x,0)$ 是不可微的，因此我们不能直接应用 Malliavin 微积分的链式法则。我们按照指示进行。\n\n1.  光滑逼近的构造与 $L^{2}$ 收敛。\n待逼近的函数是 $x^{+} = \\max(x,0)$。我们可以将其表示为 $x^{+} = \\frac{1}{2}(x + |x|)$。其非光滑性来自于绝对值函数 $|x| = \\sqrt{x^{2}}$。一个标准的光滑化方法是引入一个小的正参数 $\\epsilon$。\n我们定义函数族 $\\{f_{\\epsilon}\\}_{\\epsilon>0}$ 如下：\n$$f_{\\epsilon}(x) = \\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}})$$\n对于任何固定的 $\\epsilon > 0$，平方根下的项严格为正，因此 $f_{\\epsilon}$ 在 $\\mathbb{R}$ 上是无限可微的（$C^{\\infty}$）。当 $\\epsilon \\to 0$ 时，我们有 $\\sqrt{x^{2} + \\epsilon^{2}} \\to \\sqrt{x^{2}} = |x|$，所以对任意 $x \\in \\mathbb{R}$，$f_{\\epsilon}(x) \\to \\frac{1}{2}(x + |x|) = x^{+}$。这表明了逐点收敛。\n$f_{\\epsilon}$ 的一阶导数为：\n$$f_{\\epsilon}'(x) = \\frac{d}{dx} \\left[ \\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}}) \\right] = \\frac{1}{2}\\left(1 + \\frac{2x}{2\\sqrt{x^{2} + \\epsilon^{2}}}\\right) = \\frac{1}{2}\\left(1 + \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}\\right)$$\n对于 $\\epsilon > 0$，$f_{\\epsilon}'(x)$ 是一个关于 $x$ 的连续函数。为了检查它是否有界，我们分析 $\\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}$ 项。其绝对值为 $\\left|\\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}}\\right| = \\frac{|x|}{\\sqrt{x^{2} + \\epsilon^{2}}} \\le \\frac{|x|}{\\sqrt{x^{2}}} = 1$（对于 $x \\ne 0$）。该不等式对所有 $x$ 都是严格的。因此，$-1 < \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}} < 1$，这意味着 $0 < 1 + \\frac{x}{\\sqrt{x^{2} + \\epsilon^{2}}} < 2$。所以，$0 < f_{\\epsilon}'(x) < 1$。对于每个 $\\epsilon > 0$，导数都是连续且有界的。\n\n为了证明 $f_{\\epsilon}(W_{T})$ 在 $L^{2}(\\Omega)$ 空间中收敛于 $F$，我们必须证明当 $\\epsilon \\to 0$ 时 $\\mathbb{E}\\left[|f_{\\epsilon}(W_{T}) - W_{T}^{+}|^{2}\\right] \\to 0$。我们来考察差值 $|f_{\\epsilon}(x) - x^{+}|: $\n$$|f_{\\epsilon}(x) - x^{+}| = \\left|\\frac{1}{2}(x + \\sqrt{x^{2} + \\epsilon^{2}}) - \\frac{1}{2}(x + |x|)\\right| = \\frac{1}{2}|\\sqrt{x^{2} + \\epsilon^{2}} - |x||$$\n乘以共轭式，我们得到：\n$$\\frac{1}{2} \\left| \\frac{(\\sqrt{x^{2} + \\epsilon^{2}} - |x|)(\\sqrt{x^{2} + \\epsilon^{2}} + |x|)}{\\sqrt{x^{2} + \\epsilon^{2}} + |x|} \\right| = \\frac{1}{2} \\frac{|x^{2} + \\epsilon^{2} - x^{2}|}{\\sqrt{x^{2} + \\epsilon^{2}} + |x|} = \\frac{\\epsilon^{2}}{2(\\sqrt{x^{2} + \\epsilon^{2}} + |x|)}$$\n由于 $\\sqrt{x^{2} + \\epsilon^{2}} \\ge \\sqrt{\\epsilon^{2}} = \\epsilon$ 且 $|x| \\ge 0$，分母至少为 $\\epsilon$。\n$$|f_{\\epsilon}(x) - x^{+}| \\le \\frac{\\epsilon^{2}}{2\\epsilon} = \\frac{\\epsilon}{2}$$\n这个界对 $x$ 是一致的。因此，应用于 $W_{T}$，我们有 $|f_{\\epsilon}(W_{T}) - W_{T}^{+}| \\le \\frac{\\epsilon}{2}$ 对所有 $\\omega \\in \\Omega$ 成立。\n差的 $L^{2}$ 范数则有界于：\n$$\\mathbb{E}\\left[|f_{\\epsilon}(W_{T}) - W_{T}^{+}|^{2}\\right] \\le \\mathbb{E}\\left[\\left(\\frac{\\epsilon}{2}\\right)^{2}\\right] = \\frac{\\epsilon^{2}}{4}$$\n当 $\\epsilon \\to 0$ 时，$\\frac{\\epsilon^{2}}{4} \\to 0$，这证明了 $f_{\\epsilon}(W_{T})$ 在 $L^{2}(\\Omega)$ 空间中收敛于 $W_{T}^{+}$。\n\n2.  Malliavin 导数的计算。\n对于形如 $f(W_{T})$ 的泛函，其中 $f$ 是具有有界导数的连续可微函数，其 Malliavin 导数由链式法则给出：$D_{t}(f(W_{T})) = f'(W_{T}) D_{t}W_{T}$。$W_{T} = \\int_{0}^{T} 1 \\, dW_{s}$ 的 Malliavin 导数为 $D_{t}W_{T} = 1$（对于 $t \\in [0,T]$）。\n将此应用于我们的逼近 $F_{\\epsilon} = f_{\\epsilon}(W_{T})$，我们得到：\n$$D_{t}(f_{\\epsilon}(W_{T})) = f_{\\epsilon}'(W_{T})$$\n对于 $t \\in [0,T]$。代入第 1 步中 $f_{\\epsilon}'(x)$ 的表达式：\n$$D_{t}(f_{\\epsilon}(W_{T})) = \\frac{1}{2}\\left(1 + \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}\\right)$$\n\n3.  条件期望和极限表达式。\n$F$ 的 Clark-Ocone 表示中的积分项是 $g_{t} = \\lim_{\\epsilon \\to 0} \\mathbb{E}[D_{t}(f_{\\epsilon}(W_{T})) | \\mathcal{F}_{t}]$。我们首先计算固定 $\\epsilon$ 时的条件期望：\n$$g_{t}^{\\epsilon} = \\mathbb{E}[D_{t}(f_{\\epsilon}(W_{T})) | \\mathcal{F}_{t}] = \\mathbb{E}\\left[\\frac{1}{2}\\left(1 + \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}\\right) \\bigg| \\mathcal{F}_{t}\\right]$$\n根据条件期望的线性性：\n$$g_{t}^{\\epsilon} = \\frac{1}{2} + \\frac{1}{2}\\mathbb{E}\\left[\\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}} \\bigg| \\mathcal{F}_{t}\\right]$$\n期望内的随机变量 $h_{\\epsilon}(W_{T}) = \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}}$ 的绝对值以 $1$ 为界。当 $\\epsilon \\to 0$ 时，对于 $x \\ne 0$ 有 $h_{\\epsilon}(x) \\to \\text{sgn}(x)$。由于 $\\mathbb{P}(W_{T}=0)=0$，这种收敛是几乎必然发生的。根据条件期望的有界收敛定理，我们可以交换极限和期望：\n$$g_{t} = \\lim_{\\epsilon \\to 0} g_{t}^{\\epsilon} = \\frac{1}{2} + \\frac{1}{2}\\mathbb{E}\\left[\\lim_{\\epsilon \\to 0} \\frac{W_{T}}{\\sqrt{W_{T}^{2} + \\epsilon^{2}}} \\bigg| \\mathcal{F}_{t}\\right] = \\frac{1}{2}\\left(1 + \\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}]\\right)$$\n现在我们计算 $\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}]$。注意到 $\\text{sgn}(x) = \\mathbf{1}_{x>0} - \\mathbf{1}_{x<0}$。\n$$\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}] = \\mathbb{E}[\\mathbf{1}_{W_{T}>0} | \\mathcal{F}_{t}] - \\mathbb{E}[\\mathbf{1}_{W_{T}<0} | \\mathcal{F}_{t}] = \\mathbb{P}(W_{T}>0 | \\mathcal{F}_{t}) - \\mathbb{P}(W_{T}<0 | \\mathcal{F}_{t})$$\n我们将 $W_{T}$ 分解为 $W_{T} = W_{t} + (W_{T} - W_{t})$。给定 $\\mathcal{F}_{t}$，$W_{t}$ 是一个已知值，而增量 $W_{T} - W_{t}$ 独立于 $\\mathcal{F}_{t}$ 且服从均值为 0、方差为 $T-t$ 的正态分布。所以，$W_{T} - W_{t} \\sim N(0, T-t)$。\n对于 $t < T$ 我们有：\n$$\\mathbb{P}(W_{T} > 0 | \\mathcal{F}_{t}) = \\mathbb{P}(W_{t} + (W_{T} - W_{t}) > 0 | \\mathcal{F}_{t}) = \\mathbb{P}(W_{T} - W_{t} > -W_{t})$$\n设 $Z \\sim N(0,1)$ 是一个标准正态变量。那么 $W_{T} - W_{t}$ 与 $\\sqrt{T-t} Z$ 同分布。\n$$\\mathbb{P}(\\sqrt{T-t}Z > -W_{t}) = \\mathbb{P}\\left(Z > -\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n设 $\\Phi(\\cdot)$ 为标准正态分布的累积分布函数（CDF），$\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{x} \\exp(-\\frac{y^{2}}{2}) dy$。\n该概率为 $1 - \\Phi\\left(-\\frac{W_{t}}{\\sqrt{T-t}}\\right)$。利用对称性 $\\Phi(-z) = 1 - \\Phi(z)$，我们得到：\n$$\\mathbb{P}(W_{T} > 0 | \\mathcal{F}_{t}) = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n类似地，$\\mathbb{P}(W_{T} \\le 0 | \\mathcal{F}_{t}) = \\mathbb{P}(Z \\le -\\frac{W_{t}}{\\sqrt{T-t}}) = \\Phi(-\\frac{W_{t}}{\\sqrt{T-t}}) = 1 - \\Phi(\\frac{W_{t}}{\\sqrt{T-t}})$。\n因此，\n$$\\mathbb{E}[\\text{sgn}(W_{T}) | \\mathcal{F}_{t}] = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - \\left(1 - \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)\\right) = 2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - 1$$\n将此代回 $g_{t}$ 的表达式中：\n$$g_{t} = \\frac{1}{2}\\left(1 + \\left(2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right) - 1\\right)\\right) = \\frac{1}{2}\\left(2\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)\\right) = \\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)$$\n该表达式对 $t \\in [0,T)$ 有效。\n\n可料积分项的最终结果是标准正态分布的累积分布函数在 $\\frac{W_{t}}{\\sqrt{T-t}}$ 处的值。", "answer": "$$\\boxed{\\Phi\\left(\\frac{W_{t}}{\\sqrt{T-t}}\\right)}$$", "id": "3000571"}, {"introduction": "虽然克拉克-奥肯公式为我们提供了一个表示鞅积分项的显式期望形式，但在复杂模型中直接计算这个条件期望往往非常困难甚至不可能。本练习将带你探索理论与计算之间的桥梁，首先揭示克拉克-奥肯积分项与热方程解之间的关系。然后，你将学习如何利用这一关系设计一种数值近似方案，并分析其偏差，这是将抽象理论应用于实际计算的关键一步。[@problem_id:3079959]", "problem": "考虑一个在满足通常条件的带滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 上的标准一维布朗运动 $W_t$。设 $f:\\mathbb{R}\\to\\mathbb{R}$ 为一个具有有界导数的足够光滑的函数，并定义平方可积的随机变量 $F=f(W_T)$。Clark-Ocone 公式指出，存在一个 $(\\mathcal{F}_t)$-可料过程 $\\phi_t$，使得 $F-\\mathbb{E}[F]=\\int_0^T \\phi_t\\,\\mathrm{d}W_t$ 且 $\\phi_t=\\mathbb{E}[D_t F\\mid\\mathcal{F}_t]$，其中 $D_t F$ 表示 $F$ 的 Malliavin 导数。仅从布朗运动和热方程的这些基本基础和性质出发，完成以下任务：\n\n1. 利用布朗运动的马尔可夫性质和热半群的生成元刻画，证明对于 $F=f(W_T)$，Clark-Ocone 被积函数可以写成 $\\phi_t=P_{T-t} f'(W_t)$，其中 $P_s$ 是一维热半群，定义为 $P_s g(x)=\\mathbb{E}[g(x+\\sqrt{s}Z)]$，其中 $Z\\sim\\mathcal{N}(0,1)$ 且独立于 $W$。\n\n2. 提出一个近似被积函数 $\\phi_t$ 的时间离散化方案，该方案依赖于截断由二阶导数算子生成的半群的时间幂级数。具体地，将 $m\\in\\mathbb{N}_0$ 阶的截断近似定义为\n$$\nS_m(s,x;g)=\\sum_{n=0}^{m}\\frac{s^n}{2^n\\,n!}\\,\\partial_x^{2n} g(x),\n$$\n并考虑近似 $\\phi_t^{(m)}=S_m(T-t,W_t;f')$。解释为什么这构成了时间离散化，即用半群 $P_s$ 关于时间变量 $s$ 的麦克劳林级数来近似它。\n\n3. 通过热半群结构分析偏差 $b_m(t,x)=\\phi_t(x)-\\phi_t^{(m)}(x)$。对于固定参数 $a\\in\\mathbb{R}$ 的特定选择 $f(x)=\\mathrm{e}^{a x}$，推导 $\\phi_t(x)$、$\\phi_t^{(m)}(x)$ 和 $b_m(t,x)$ 的闭式表达式，并仅使用初等函数化简该偏差。您的推导必须从作用于 $f'$ 的热半群的基本表示和生成元 $(1/2)\\partial_{xx}$ 出发。\n\n4. 实现一个程序，对于下面的测试套件，计算每种情况下的绝对偏差 $|b_m(t,x)|$，并按最终输出格式输出结果。使用您推导出的精确公式（不允许使用蒙特卡洛模拟）。测试套件由参数元组 $(a,T,t,x,m)$ 组成：\n   - 情况 1（一般“顺利”情况）：$(0.7,1.0,0.4,0.3,2)$\n   - 情况 2（接近终端的小剩余时间）：$(1.0,1.0,0.99,-0.5,1)$\n   - 情况 3（初始时间，大剩余时间）：$(0.5,2.0,0.0,0.0,3)$\n   - 情况 4（最低阶截断）：$(1.2,0.5,0.25,1.0,0)$\n   - 情况 5（更高阶截断）：$(1.5,1.0,0.1,-1.0,6)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是相应测试用例计算出的绝对偏差。不涉及物理单位。不涉及角度。不涉及百分比。每个结果必须是一个浮点数。", "solution": "在尝试解决问题之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取已知条件\n-   一个在带滤概率空间 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 上的标准一维布朗运动 $W_t$。\n-   一个具有有界导数的足够光滑的函数 $f:\\mathbb{R}\\to\\mathbb{R}$。\n-   一个平方可积的随机变量 $F=f(W_T)$。\n-   Clark-Ocone 公式：$F-\\mathbb{E}[F]=\\int_0^T \\phi_t\\,\\mathrm{d}W_t$，其被积函数为 $\\phi_t=\\mathbb{E}[D_t F\\mid\\mathcal{F}_t]$。\n-   $D_t F$ 是 $F$ 的 Malliavin 导数。\n-   一维热半群定义为 $P_s g(x)=\\mathbb{E}[g(x+\\sqrt{s}Z)]$，其中 $Z\\sim\\mathcal{N}(0,1)$ 独立于 $W$。\n-   $m\\in\\mathbb{N}_0$ 阶半群的截断近似定义为 $S_m(s,x;g)=\\sum_{n=0}^{m}\\frac{s^n}{2^n\\,n!}\\,\\partial_x^{2n} g(x)$。\n-   近似被积函数是 $\\phi_t^{(m)}=S_m(T-t,W_t;f')$。\n-   偏差定义为 $b_m(t,x)=\\phi_t(x)-\\phi_t^{(m)}(x)$。\n-   一个特定的函数选择是 $f(x)=\\mathrm{e}^{a x}$，其中 $a\\in\\mathbb{R}$ 是一个固定参数。\n-   测试用例以元组 $(a,T,t,x,m)$ 形式提供：\n    -   情况 1：$(0.7,1.0,0.4,0.3,2)$\n    -   情况 2：$(1.0,1.0,0.99,-0.5,1)$\n    -   情况 3：$(0.5,2.0,0.0,0.0,3)$\n    -   情况 4：$(1.2,0.5,0.25,1.0,0)$\n    -   情况 5：$(1.5,1.0,0.1,-1.0,6)$\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n-   **科学性**：该问题牢固地建立在随机微积分这一数学领域，具体涉及 Malliavin 微积分、其与偏微分方程（PDE）的联系以及 Clark-Ocone 表示定理。布朗运动、热半群及其生成元等概念是该领域的标准和核心内容。该问题在数学上和科学上都是合理的。\n-   **适定性**：问题的任务定义明确：推导一个特定的表示，解释一个近似方案，并对一个具体函数形式进行偏差分析。这些推导存在唯一解。\n-   **客观性**：问题以精确、形式化的数学语言陈述，没有歧义或主观内容。\n-   **完整性**：所有必要的定义（Clark-Ocone 公式、热半群、近似算子）和数据（测试用例）都已提供。\n-   **无其他缺陷**：该问题不违反任何其他验证标准。它是一个形式化的、非平凡的且可验证的数学练习。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整、合理的解决方案。\n\n### 第 1 部分：Clark-Ocone 被积函数的表示\n\nClark-Ocone 公式给出了 $F=f(W_T)$ 的鞅表示的被积函数为 $\\phi_t=\\mathbb{E}[D_t F\\mid\\mathcal{F}_t]$。\n对于形式为 $F=f(W_T)$ 的泛函，Malliavin 微积分的链式法则给出其在时间 $t \\in [0,T]$ 对 $W$ 路径的导数为 $D_t F = f'(W_T)$。\n将此代入 $\\phi_t$ 的公式中，我们得到：\n$$\n\\phi_t = \\mathbb{E}[f'(W_T) \\mid \\mathcal{F}_t]\n$$\n滤子 $(\\mathcal{F}_t)$ 是由布朗运动 $W$ 生成的，因此以 $\\mathcal{F}_t$ 为条件等价于以直到时间 $t$ 的过程值为条件。根据布朗运动的马尔可夫性质，条件期望仅取决于过程的当前状态 $W_t$。\n$$\n\\phi_t = \\mathbb{E}[f'(W_T) \\mid W_t]\n$$\n为了计算这个期望，我们将时间 $T$ 的布朗运动分解为其在时间 $t$ 的值与一个未来增量之和：\n$$\nW_T = W_t + (W_T - W_t)\n$$\n增量 $(W_T - W_t)$ 是一个均值为 $0$、方差为 $T-t$ 的正态分布随机变量。此外，它独立于 $\\mathcal{F}_t$，因此也独立于 $W_t$。我们可以将此增量写为 $\\sqrt{T-t}Z$，其中 $Z$ 是一个标准正态随机变量，$Z \\sim \\mathcal{N}(0,1)$，且独立于 $\\mathcal{F}_t$。\n将此结构代入条件期望中，我们有：\n$$\n\\phi_t = \\mathbb{E}[f'(W_t + \\sqrt{T-t}Z) \\mid W_t]\n$$\n由于 $Z$ 独立于 $W_t$，我们可以在期望内将 $W_t$ 视为一个常数参数。如果我们设 $x$ 为 $W_t$ 的一个特定实现，则表达式变为：\n$$\n\\mathbb{E}[f'(x + \\sqrt{T-t}Z)]\n$$\n通过设置时间参数 $s=T-t$ 和函数 $g=f'$，该表达式完全符合热半群的定义 $P_s g(x) = \\mathbb{E}[g(x+\\sqrt{s}Z)]$。因此，我们有：\n$$\n\\mathbb{E}[f'(x + \\sqrt{T-t}Z)] = P_{T-t}f'(x)\n$$\n从特定实现 $x$ 回到随机变量 $W_t$，我们获得了 Clark-Ocone 被积函数所期望的表示：\n$$\n\\phi_t = P_{T-t}f'(W_t)\n$$\n这个结果将随机积分表示与热方程的解联系起来。函数 $u(t,x) = P_{T-t}f'(x)$ 在 $[0,T) \\times \\mathbb{R}$ 上求解后向热方程 $\\partial_t u + \\frac{1}{2}\\partial_{xx} u = 0$，其终端条件为 $u(T,x) = f'(x)$。算子 $\\frac{1}{2}\\partial_{xx}$ 是布朗运动过程和热半群的无穷小生成元。\n\n### 第 2 部分：通过级数截断的时间离散化方案\n\n热半群 $P_s$ 由其生成元 $L = \\frac{1}{2}\\partial_{xx}$ 的指数形式正式定义。即 $P_s = e^{sL} = \\exp(s\\frac{1}{2}\\partial_{xx})$。此算子作用于一个足够光滑的函数 $g(x)$ 的行为可以用其关于时间变量 $s$ 的麦克劳林级数来表示：\n$$\nP_s g(x) = \\left( \\sum_{n=0}^{\\infty} \\frac{(sL)^n}{n!} \\right) g(x) = \\left( \\sum_{n=0}^{\\infty} \\frac{s^n}{n!} \\left(\\frac{1}{2}\\partial_{xx}\\right)^n \\right) g(x)\n$$\n化简算子项，我们得到：\n$$\nP_s g(x) = \\sum_{n=0}^{\\infty} \\frac{s^n}{2^n n!} \\partial_x^{2n} g(x)\n$$\n这个无穷级数表示函数 $g$ 在热流下经过时间 $s$ 的精确演化。问题将近似 $S_m(s,x;g)$ 定义为：\n$$\nS_m(s,x;g)=\\sum_{n=0}^{m}\\frac{s^n}{2^n\\,n!}\\,\\partial_x^{2n} g(x)\n$$\n比较这两个表达式，显然 $S_m(s,x;g)$ 是 $P_s g(x)$ 的麦克劳林级数在 $m$ 阶截断的部分和。这构成了一个时间离散化方案，因为对于小的 $s$，级数中的高阶项变得可以忽略不计，截断和提供了一个很好的近似。因此，近似 $\\phi_t^{(m)} = S_m(T-t, W_t; f')$ 是通过将 $\\phi_t$ 表达式中的精确半群算子 $P_{T-t}$ 替换为其截断级数近似 $S_m$ 作用于点 $W_t$ 上的函数 $f'$ 而得到的。\n\n### 第 3 部分：对 $f(x) = \\mathrm{e}^{ax}$ 的偏差分析\n\n给定 $f(x) = e^{ax}$。一阶导数为 $f'(x) = ae^{ax}$。我们记 $g(x) = f'(x)$。\n\n首先，我们推导精确被积函数 $\\phi_t(x)$ 的闭式表达式，其中 $x$ 代表 $W_t$ 的一个实现。\n$$\n\\phi_t(x) = P_{T-t}g(x) = \\mathbb{E}[g(x+\\sqrt{T-t}Z)] = \\mathbb{E}[a e^{a(x+\\sqrt{T-t}Z)}]\n$$\n其中 $Z \\sim \\mathcal{N}(0,1)$。我们可以提出非随机项：\n$$\n\\phi_t(x) = a e^{ax} \\mathbb{E}[e^{a\\sqrt{T-t}Z}]\n$$\n期望项是正态变量 $Y = a\\sqrt{T-t}Z$ 在 $1$ 处取值的矩生成函数 (MGF)。由于 $Z \\sim \\mathcal{N}(0,1)$，所以 $Y \\sim \\mathcal{N}(0, a^2(T-t))$。正态变量 $N \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的 MGF 是 $M_N(k) = e^{k\\mu + \\frac{1}{2}k^2\\sigma^2}$。这里，$k=1$，$\\mu=0$，$\\sigma^2=a^2(T-t)$。\n$$\n\\mathbb{E}[e^Y] = e^{1 \\cdot 0 + \\frac{1}{2} \\cdot 1^2 \\cdot a^2(T-t)} = e^{\\frac{1}{2}a^2(T-t)}\n$$\n将其代回，我们得到精确的被积函数：\n$$\n\\phi_t(x) = a e^{ax} e^{\\frac{1}{2}a^2(T-t)} = a e^{ax + \\frac{1}{2}a^2(T-t)}\n$$\n接下来，我们推导近似被积函数 $\\phi_t^{(m)}(x)$。这需要计算 $g(x) = ae^{ax}$ 的高阶偶数次导数。$k$ 阶导数是 $\\partial_x^k g(x) = a^{k+1}e^{ax}$。因此，$(2n)$ 阶导数是：\n$$\n\\partial_x^{2n} g(x) = a^{2n+1}e^{ax}\n$$\n将其代入 $S_m$ 的定义中：\n$$\n\\phi_t^{(m)}(x) = S_m(T-t, x; g) = \\sum_{n=0}^{m}\\frac{(T-t)^n}{2^n\\,n!}\\,(a^{2n+1}e^{ax})\n$$\n提出与求和指数 $n$ 无关的项：\n$$\n\\phi_t^{(m)}(x) = a e^{ax} \\sum_{n=0}^{m}\\frac{(T-t)^n a^{2n}}{2^n\\,n!} = a e^{ax} \\sum_{n=0}^{m}\\frac{1}{n!}\\left(\\frac{a^2(T-t)}{2}\\right)^n\n$$\n最后，我们通过计算精确表达式和近似表达式之间的差来找到偏差 $b_m(t,x)$。令 $y = \\frac{a^2(T-t)}{2}$。\n$$\n\\phi_t(x) = a e^{ax} e^y\n$$\n$$\n\\phi_t^{(m)}(x) = a e^{ax} \\sum_{n=0}^{m}\\frac{y^n}{n!}\n$$\n偏差为：\n$$\nb_m(t,x) = \\phi_t(x) - \\phi_t^{(m)}(x) = a e^{ax} e^y - a e^{ax} \\sum_{n=0}^{m}\\frac{y^n}{n!}\n$$\n因式分解后得到偏差的简化闭式表达式，它由初等函数（指数、幂、阶乘）构成：\n$$\nb_m(t,x) = a e^{ax} \\left( e^y - \\sum_{n=0}^{m}\\frac{y^n}{n!} \\right) = a e^{ax + \\frac{a^2(T-t)}{2}} - a e^{ax} \\sum_{n=0}^{m}\\frac{1}{n!}\\left(\\frac{a^2(T-t)}{2}\\right)^n\n$$\n该表达式表示真实值与其在“剩余时间”变量上的 $m$ 阶泰勒近似之间的差。在实现中，我们将计算绝对值 $|b_m(t,x)|$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the absolute bias of a truncated semigroup approximation for the Clark-Ocone integrand\n    for the specific functional F = f(W_T) where f(x) = exp(ax).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (a, T, t, x, m).\n    test_cases = [\n        (0.7, 1.0, 0.4, 0.3, 2),    # Case 1 (general \"happy path\")\n        (1.0, 1.0, 0.99, -0.5, 1),   # Case 2 (near-terminal small time-to-go)\n        (0.5, 2.0, 0.0, 0.0, 3),    # Case 3 (initial time, large time-to-go)\n        (1.2, 0.5, 0.25, 1.0, 0),   # Case 4 (lowest-order truncation)\n        (1.5, 1.0, 0.1, -1.0, 6),   # Case 5 (higher-order truncation)\n    ]\n\n    results = []\n    for case in test_cases:\n        a, T, t, x, m = case\n\n        # The derived formula for the bias is:\n        # b_m(t,x) = a * exp(a*x) * ( exp(y) - sum_{n=0 to m} [y^n / n!] )\n        # where y = a^2 * (T-t) / 2.\n        \n        # Calculate the argument for the Taylor series\n        time_to_go = T - t\n        y = (a**2 * time_to_go) / 2.0\n\n        # Calculate the truncated Taylor series sum for exp(y) of order m.\n        # This is done iteratively for numerical stability and efficiency.\n        # term_n represents y^n / n!\n        # sum_val represents the sum of terms from n=0 to m.\n        term_n = 1.0  # For n=0, y^0 / 0! = 1\n        sum_val = 1.0 # Initialize sum with the n=0 term\n        \n        for n in range(1, m + 1):\n            term_n = term_n * y / n\n            sum_val += term_n\n\n        # Calculate the exact value of exp(y)\n        exp_y = np.exp(y)\n\n        # Calculate the bias using the derived formula\n        factor = a * np.exp(a * x)\n        bias = factor * (exp_y - sum_val)\n\n        # The final result is the absolute value of the bias\n        abs_bias = np.abs(bias)\n        results.append(abs_bias)\n\n    # Final print statement in the exact required format.\n    # The map to str ensures floating point numbers are formatted correctly.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3079959"}]}