{"hands_on_practices": [{"introduction": "在我们深入计算之前，让我们从一个基本概念开始。最小二乘法是为不相容的线性系统设计的，但如果它恰好得到了一个零误差的“完美”拟合，这意味着什么？[@problem_id:1371626]这个练习旨在探索零误差最小二乘解与系统矩阵列空间之间的根本联系，从而阐明“近似”解在何种情况下实际上是精确解。", "problem": "一位工程师正在分析来自一个新实验设备的温度数据。在四个不同的时间点 $t_1, t_2, t_3, t_4$，他们记录了四个相应的温度测量值 $y_1, y_2, y_3, y_4$。为了对设备的热行为进行建模，他们提出了一个形如 $y(t) = c_0 + c_1 t + c_2 t^2$ 的二次关系。\n\n该建模尝试导出了一个超定线性方程组，可以写成矩阵形式 $A\\mathbf{c} = \\mathbf{y}$，其中：\n- $\\mathbf{c} = \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix}$ 是未知模型系数的向量。\n- $\\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\end{pmatrix}$ 是观测温度测量值的向量。\n- $A$ 是一个 $4 \\times 3$ 的矩阵，由时间点和二次模型的结构导出。\n\n工程师使用一个标准的计算库来找到最小二乘解 $\\hat{\\mathbf{c}}$，该解使得误差向量的欧几里得范数的平方 $\\Vert A\\mathbf{c} - \\mathbf{y}\\Vert^2$ 最小化。计算后，工程师惊讶地发现，定义为 $\\Vert A\\hat{\\mathbf{c}} - \\mathbf{y}\\Vert$ 的最小二乘误差恰好为零。\n\n基于这一结果，关于数据向量 $\\mathbf{y}$ 与矩阵 $A$ 的关系，可以得出什么确定性的结论？\n\nA. 向量 $\\mathbf{y}$ 必须是零向量。\nB. 向量 $\\mathbf{y}$ 与 $A$ 的列空间正交。\nC. 向量 $\\mathbf{y}$ 位于 $A$ 的列空间中。\nD. 向量 $\\mathbf{y}$ 是 $\\mathbb{R}^3$ 中的一个向量。\nE. 向量 $\\mathbf{y}$ 位于转置矩阵 $A^T$ 的零空间中。", "solution": "我们通过最小化最小二乘目标来对数据进行建模\n$$\n\\min_{\\mathbf{c}\\in\\mathbb{R}^{3}} \\Vert A\\mathbf{c}-\\mathbf{y}\\Vert^{2}.\n$$\n设残差为 $\\mathbf{r}(\\mathbf{c})=\\mathbf{y}-A\\mathbf{c}$。极小值点 $\\hat{\\mathbf{c}}$ 的必要条件是通过将梯度设为零来获得：\n$$\n\\nabla_{\\mathbf{c}} \\Vert A\\mathbf{c}-\\mathbf{y}\\Vert^{2} = 2 A^{T}(A\\mathbf{c}-\\mathbf{y})=0,\n$$\n这导出了正规方程\n$$\nA^{T}A\\,\\hat{\\mathbf{c}}=A^{T}\\mathbf{y}, \\quad \\text{等价地} \\quad A^{T}\\bigl(\\mathbf{y}-A\\hat{\\mathbf{c}}\\bigr)=\\mathbf{0}.\n$$\n因此，在最小二乘解处，残差 $\\hat{\\mathbf{r}}=\\mathbf{y}-A\\hat{\\mathbf{c}}$ 与 $A$ 的列空间正交。\n\n工程师观察到最小二乘误差范数恰好为零：\n$$\n\\Vert A\\hat{\\mathbf{c}}-\\mathbf{y}\\Vert=0.\n$$\n一个范数等于零，当且仅当其向量为零向量，因此\n$$\nA\\hat{\\mathbf{c}}-\\mathbf{y}=\\mathbf{0} \\quad \\Longrightarrow \\quad \\mathbf{y}=A\\hat{\\mathbf{c}}.\n$$\n根据定义，任何形如 $A\\mathbf{c}$ 的向量都位于 $A$ 的列空间中。因此，\n$$\n\\mathbf{y}\\in \\operatorname{Col}(A).\n$$\n这是由零最小二乘残差所蕴含的确定性结论。", "answer": "$$\\boxed{C}$$", "id": "1371626"}, {"introduction": "最小二乘法的一个常见应用是为一组数据点拟合模型，例如在含噪声的测量数据中寻找最佳的二次曲线。[@problem_id:1371660]本练习将指导你完成此过程中的关键第一步：将一组数据点和一个模型转化为正规方程的矩阵形式。掌握这一构建过程对于将最小二乘法应用于实际问题至关重要。", "problem": "一位信号处理工程师正在分析一个带噪声的信号。他们假设信号的一段 $y(t)$ 可以用一个二次多项式 $p(t) = c_0 + c_1 t + c_2 t^2$ 来近似，其中 $t$ 是以秒为单位的时间。为了确定未知系数 $c_0, c_1, c_2$，该工程师收集了四个数据样本 $(t_i, y_i)$:\n$$(0, 1.0), (1, 0.5), (2, 2.0), (3, 4.5)$$\n将这些数据点代入模型，会得到一个超定线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x} = \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix}$。矩阵 $A$ 是由多项式的基函数在采样时间点上的取值构成的，而向量 $\\mathbf{b}$ 包含观测到的信号值。\n\n最小二乘法原理指出，当误差向量 $\\mathbf{e} = \\mathbf{b} - A\\mathbf{x}$ 与 $A$ 的列空间正交时，可以找到最佳近似。这个正交条件可以转化为一个形如 $M\\mathbf{x} = \\mathbf{v}$ 的可解线性方程组。\n\n您的任务是确定该系统的矩阵 $M$ 和向量 $\\mathbf{v}$。以下哪个选项代表了正确的 $(M, \\mathbf{v})$ 对？\n\nA. $M = \\begin{pmatrix} 4  6  14 \\\\ 6  14  36 \\\\ 14  36  98 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 8 \\\\ 18 \\\\ 49 \\end{pmatrix}$\n\nB. $M = \\begin{pmatrix} 14  36  98 \\\\ 36  98  258 \\\\ 98  258  794 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 18 \\\\ 49 \\\\ 138.5 \\end{pmatrix}$\n\nC. $M = \\begin{pmatrix} 4  6  14 \\\\ 6  14  36 \\\\ 14  36  98 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 8.0 \\\\ 18.0 \\\\ 45.0 \\end{pmatrix}$\n\nD. $M = \\begin{pmatrix} 4  6  14 \\\\ 6  14  36 \\\\ 14  36  98 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 6 \\\\ 14 \\\\ 36 \\end{pmatrix}$\n\nE. $M = \\begin{pmatrix} 4  6  14 \\\\ 6  14  36 \\\\ 14  36  108 \\end{pmatrix}, \\mathbf{v} = \\begin{pmatrix} 8 \\\\ 18 \\\\ 49 \\end{pmatrix}$", "solution": "我们用 $p(t)=c_{0}+c_{1}t+c_{2}t^{2}$ 对数据进行建模。使用采样时间 $t\\in\\{0,1,2,3\\}$，设计矩阵 $A$ 的行是 $[1,\\ t,\\ t^{2}]$ 在每个 $t$ 处的取值，而 $\\mathbf{b}$ 收集了相应的 $y$ 值：\n$$\nA=\\begin{pmatrix}\n1  0  0\\\\\n1  1  1\\\\\n1  2  4\\\\\n1  3  9\n\\end{pmatrix},\\qquad\n\\mathbf{b}=\\begin{pmatrix}\n1.0\\\\\n0.5\\\\\n2.0\\\\\n4.5\n\\end{pmatrix}.\n$$\n最小二乘解满足正规方程\n$$\nA^{\\top}A\\,\\mathbf{x}=A^{\\top}\\mathbf{b},\n$$\n所以 $M=A^{\\top}A$ 且 $\\mathbf{v}=A^{\\top}\\mathbf{b}$。\n\n计算在采样时间 $t_{i}\\in\\{0,1,2,3\\}$ 上的总和：\n$$\nS_{0}=\\sum 1=4,\\quad S_{1}=\\sum t_{i}=0+1+2+3=6,\\quad S_{2}=\\sum t_{i}^{2}=0+1+4+9=14,\n$$\n$$\nS_{3}=\\sum t_{i}^{3}=0+1+8+27=36,\\quad S_{4}=\\sum t_{i}^{4}=0+1+16+81=98.\n$$\n因此\n$$\nM=A^{\\top}A=\\begin{pmatrix}\nS_{0}  S_{1}  S_{2}\\\\\nS_{1}  S_{2}  S_{3}\\\\\nS_{2}  S_{3}  S_{4}\n\\end{pmatrix}\n=\\begin{pmatrix}\n4  6  14\\\\\n6  14  36\\\\\n14  36  98\n\\end{pmatrix}.\n$$\n\n现在按分量计算 $\\mathbf{v}=A^{\\top}\\mathbf{b}$：\n$$\nv_{0}=\\sum y_{i}=1.0+0.5+2.0+4.5=8.0,\n$$\n$$\nv_{1}=\\sum t_{i}y_{i}=0\\cdot 1.0+1\\cdot 0.5+2\\cdot 2.0+3\\cdot 4.5=0.5+4.0+13.5=18.0,\n$$\n$$\nv_{2}=\\sum t_{i}^{2}y_{i}=0^{2}\\cdot 1.0+1^{2}\\cdot 0.5+2^{2}\\cdot 2.0+3^{2}\\cdot 4.5=0+0.5+8.0+40.5=49.0.\n$$\n因此，\n$$\n\\mathbf{v}=\\begin{pmatrix}8 \\\\ 18 \\\\ 49\\end{pmatrix}.\n$$\n与选项比较，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1371660"}, {"introduction": "求解正规方程 $A^T A \\hat{\\mathbf{x}} = A^T \\mathbf{b}$ 的计算量可能很大，但当矩阵 $A$ 具有特殊结构时，求解过程会出人意料地简单。[@problem_id:1371641]本练习展示了使用正交基向量（即矩阵 $A$ 的列向量）所带来的显著优势。你将看到正交性如何将矩阵 $A^TA$ 转化为一个对角矩阵，从而使得最小二乘解的计算变得易如反掌。", "problem": "一个实验室仪器在四个连续的等间隔时间段内记录一个信号。得到的测量值构成一个向量 $b \\in \\mathbb{R}^4$。根据理论，一个没有噪声的“纯”信号必须是三个特定基信号的线性组合。这些基信号由矩阵 $A$ 的列向量给出。具体的矩阵是：\n$$\nA = \\begin{pmatrix} 1  1  1 \\\\ 1  -1  1 \\\\ 1  1  -1 \\\\ 1  -1  -1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 4 \\end{pmatrix}\n$$\n观测到的向量 $b$ 被认为是受噪声污染的纯信号，因此不位于由 $A$ 的列向量所张成的子空间中。为了恢复最可能的纯信号，我们必须找到 $A$ 的列空间中与 $b$ 最接近的向量。这被称为 $b$ 在 $A$ 的列空间上的正交投影。\n\n求此投影相对于由 $A$ 的列向量给出的基的坐标向量 $\\hat{x} \\in \\mathbb{R}^3$。请将您的答案表示为一个精确的列向量。", "solution": "我们寻求 $b$ 在 $A$ 的列空间上的正交投影，也就是 $A \\hat{x} \\approx b$ 的最小二乘解 $\\hat{x}$。这满足正规方程\n$$\nA^{T}A\\,\\hat{x} \\;=\\; A^{T}b.\n$$\n设 $A$ 的列向量为 $c_{1},c_{2},c_{3}$，其中\n$$\nc_{1}=\\begin{pmatrix}1\\\\1\\\\1\\\\1\\end{pmatrix},\\quad\nc_{2}=\\begin{pmatrix}1\\\\-1\\\\1\\\\-1\\endpmatrix},\\quad\nc_{3}=\\begin{pmatrix}1\\\\1\\\\-1\\\\-1\\end{pmatrix}.\n$$\n计算格拉姆矩阵的元素 $c_{i}\\cdot c_{j}$：\n$$\nc_{1}\\cdot c_{1}=4,\\quad c_{2}\\cdot c_{2}=4,\\quad c_{3}\\cdot c_{3}=4,\n$$\n$$\nc_{1}\\cdot c_{2}=0,\\quad c_{1}\\cdot c_{3}=0,\\quad c_{2}\\cdot c_{3}=0.\n$$\n因此，\n$$\nA^{T}A \\;=\\; \\begin{pmatrix}4  0  0\\\\0  4  0\\\\0  0  4\\end{pmatrix} \\;=\\; 4I_{3}.\n$$\n接下来计算 $A^{T}b$，其元素为 $c_{i}\\cdot b$，其中 $b=\\begin{pmatrix}1\\\\2\\\\3\\\\4\\end{pmatrix}$：\n$$\nc_{1}\\cdot b = 1+2+3+4=10,\\quad\nc_{2}\\cdot b = 1-2+3-4=-2,\\quad\nc_{3}\\cdot b = 1+2-3-4=-4,\n$$\n所以\n$$\nA^{T}b \\;=\\; \\begin{pmatrix}10\\\\-2\\\\-4\\end{pmatrix}.\n$$\n解正规方程得到\n$$\n4I_{3}\\,\\hat{x} \\;=\\; \\begin{pmatrix}10\\\\-2\\\\-4\\end{pmatrix}\n\\;\\;\\Longrightarrow\\;\\;\n\\hat{x} \\;=\\; \\frac{1}{4}\\begin{pmatrix}10\\\\-2\\\\-4\\endpmatrix}\n\\;=\\; \\begin{pmatrix}\\frac{5}{2}\\\\ -\\frac{1}{2}\\\\ -1\\end{pmatrix}.\n$$\n因此，$b$ 在 $A$ 的列空间上相对于给定基的正交投影的坐标向量是 $\\hat{x}=\\begin{pmatrix}\\frac{5}{2}\\\\ -\\frac{1}{2}\\\\ -1\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2}\\\\ -\\frac{1}{2}\\\\ -1\\end{pmatrix}}$$", "id": "1371641"}]}