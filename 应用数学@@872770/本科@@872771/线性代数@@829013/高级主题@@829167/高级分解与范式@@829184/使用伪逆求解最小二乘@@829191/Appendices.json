{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是亲自动手计算。这个练习将引导你完成计算伪逆矩阵的基本步骤。我们将从一个实际的数据拟合场景出发，构建设计矩阵，然后应用列满秩矩阵的伪逆公式 $A^+ = (A^T A)^{-1} A^T$ 来求解，这是解决许多最小二乘问题的核心技能。", "problem": "一位实验物理学家正在研究一种新发现的电子元件。他们假设所施加的电压 $V$ 与产生的电流 $I$ 之间的关系遵循 $V = c_1 + c_2 I^2$ 形式的模型，其中 $c_1$ 和 $c_2$ 是未知的设备特定参数。为了确定这些参数，该物理学家在三种不同的电流下进行了三次电压测量。测得的电流为 $I_1=1$，$I_2=2$ 和 $I_3=3$（单位统一）。\n\n这组测量导出了一个形如 $A\\mathbf{x} = \\mathbf{b}$ 的超定线性方程组，其中 $\\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ 包含未知参数，而 $A$ 是根据电流值导出的设计矩阵。参数的最小二乘解可以使用矩阵 $A$ 的 Moore-Penrose 伪逆 $A^+$ 求得。\n\n给定使用的模型和电流值，确定设计矩阵 $A$ 的 Moore-Penrose 伪逆 $A^+$。", "solution": "该问题要求解与模型 $V = c_1 + c_2 I^2$ 以及在电流 $I=1, 2, 3$ 下进行的测量相关联的设计矩阵 $A$ 的 Moore-Penrose 伪逆。\n\n首先，我们构建线性方程组。每次测量 $(I_i, V_i)$ 得到一个方程：\n对于 $I_1=1$：$c_1 \\cdot 1 + c_2 \\cdot 1^2 = V_1 \\implies c_1 + c_2 = V_1$\n对于 $I_2=2$：$c_1 \\cdot 1 + c_2 \\cdot 2^2 = V_2 \\implies c_1 + 4c_2 = V_2$\n对于 $I_3=3$：$c_1 \\cdot 1 + c_2 \\cdot 3^2 = V_3 \\implies c_1 + 9c_2 = V_3$\n\n该方程组可以写成矩阵形式 $A\\mathbf{x} = \\mathbf{b}$：\n$$\n\\begin{pmatrix} 1  1 \\\\ 1  4 \\\\ 1  9 \\end{pmatrix}\n\\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n=\n\\begin{pmatrix} V_1 \\\\ V_2 \\\\ V_3 \\end{pmatrix}\n$$\n因此，设计矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix} 1  1 \\\\ 1  4 \\\\ 1  9 \\end{pmatrix}\n$$\n矩阵 $A$ 是一个 $3 \\times 2$ 矩阵。它的列是线性无关的，因此具有满列秩。对于一个满列秩的矩阵 $A$，其 Moore-Penrose 伪逆 $A^+$ 由以下公式给出：\n$$\nA^+ = (A^T A)^{-1} A^T\n$$\n我们将分步计算。\n\n第1步：计算 $A$ 的转置 $A^T$。\n$$\nA^T = \\begin{pmatrix} 1  1  1 \\\\ 1  4  9 \\end{pmatrix}\n$$\n\n第2步：计算乘积 $A^T A$。\n$$\nA^T A = \\begin{pmatrix} 1  1  1 \\\\ 1  4  9 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  4 \\\\ 1  9 \\end{pmatrix} = \\begin{pmatrix} (1)(1)+(1)(1)+(1)(1)  (1)(1)+(1)(4)+(1)(9) \\\\ (1)(1)+(4)(1)+(9)(1)  (1)(1)+(4)(4)+(9)(9) \\end{pmatrix}\n$$\n$$\nA^T A = \\begin{pmatrix} 1+1+1  1+4+9 \\\\ 1+4+9  1+16+81 \\end{pmatrix} = \\begin{pmatrix} 3  14 \\\\ 14  98 \\end{pmatrix}\n$$\n\n第3步：计算 $A^T A$ 的逆。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆为 $\\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n$A^T A$ 的行列式为：\n$$\n\\det(A^T A) = (3)(98) - (14)(14) = 294 - 196 = 98\n$$\n逆矩阵为：\n$$\n(A^T A)^{-1} = \\frac{1}{98} \\begin{pmatrix} 98  -14 \\\\ -14  3 \\end{pmatrix} = \\begin{pmatrix} \\frac{98}{98}  -\\frac{14}{98} \\\\ -\\frac{14}{98}  \\frac{3}{98} \\end{pmatrix} = \\begin{pmatrix} 1  -\\frac{1}{7} \\\\ -\\frac{1}{7}  \\frac{3}{98} \\end{pmatrix}\n$$\n\n第4步：计算最终乘积 $A^+ = (A^T A)^{-1} A^T$。\n$$\nA^+ = \\begin{pmatrix} 1  -\\frac{1}{7} \\\\ -\\frac{1}{7}  \\frac{3}{98} \\end{pmatrix} \\begin{pmatrix} 1  1  1 \\\\ 1  4  9 \\end{pmatrix}\n$$\n我们逐项进行矩阵乘法：\n元素 (1,1)：$(1)(1) + (-\\frac{1}{7})(1) = 1 - \\frac{1}{7} = \\frac{6}{7}$\n元素 (1,2)：$(1)(1) + (-\\frac{1}{7})(4) = 1 - \\frac{4}{7} = \\frac{3}{7}$\n元素 (1,3)：$(1)(1) + (-\\frac{1}{7})(9) = 1 - \\frac{9}{7} = -\\frac{2}{7}$\n\n元素 (2,1)：$(-\\frac{1}{7})(1) + (\\frac{3}{98})(1) = -\\frac{14}{98} + \\frac{3}{98} = -\\frac{11}{98}$\n元素 (2,2)：$(-\\frac{1}{7})(1) + (\\frac{3}{98})(4) = -\\frac{14}{98} + \\frac{12}{98} = -\\frac{2}{98} = -\\frac{1}{49}$\n元素 (2,3)：$(-\\frac{1}{7})(1) + (\\frac{3}{98})(9) = -\\frac{14}{98} + \\frac{27}{98} = \\frac{13}{98}$\n\n将这些元素组合成矩阵 $A^+$，得到最终结果。\n$$\nA^+ = \\begin{pmatrix} \\frac{6}{7}  \\frac{3}{7}  -\\frac{2}{7} \\\\ -\\frac{11}{98}  -\\frac{1}{49}  \\frac{13}{98} \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{6}{7}  \\frac{3}{7}  -\\frac{2}{7} \\\\ -\\frac{11}{98}  -\\frac{1}{49}  \\frac{13}{98} \\end{pmatrix}\n}\n$$", "id": "1400691"}, {"introduction": "计算出伪逆矩阵本身并不是最终目的，其真正的威力在于解决实际问题。这个练习将带你走完“从问题到解决”的全过程：如何将一个充满噪声的、无精确解的线性系统，通过求解正规方程（等价于使用伪逆）找到其唯一的最小二乘解。这个过程完美诠释了伪逆在线性回归和参数估计中的核心应用。", "problem": "一位工程师正在校准一个新型传感器，其输出 $S$ 被建模为两个可调输入参数 $p_1$ 和 $p_2$ 的线性函数。理论模型由方程 $S = x_1 p_1 + x_2 p_2$ 给出，其中 $x_1$ 和 $x_2$ 是需要确定的未知校准常数。为了求出这些常数，进行了一系列三次实验，得到了以下测量结果：\n\n1.  当 $(p_1, p_2) = (1, 0)$ 时，传感器输出为 $S=1$。\n2.  当 $(p_1, p_2) = (0, 1)$ 时，传感器输出为 $S=2$。\n3.  当 $(p_1, p_2) = (1, 1)$ 时，传感器输出为 $S=2$。\n\n由于测量噪声，这组观测数据构成了一个关于常数 $x_1$ 和 $x_2$ 的超定且不相容的线性方程组。确定构成该系统最小二乘解的 $x_1$ 和 $x_2$ 的值。\n\n请将您的答案表示为列向量 $\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。向量中的分量必须以精确分数的形式给出。", "solution": "模型为 $S = x_{1} p_{1} + x_{2} p_{2}$。将三次实验结果整理成矩阵形式，得到\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix},\\quad\n\\boldsymbol{x} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix},\\quad\n\\boldsymbol{b} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix},\n$$\n因此该系统为 $A \\boldsymbol{x} = \\boldsymbol{b}$，这是一个超定系统。最小二乘解使 $\\|A \\boldsymbol{x} - \\boldsymbol{b}\\|^{2}$ 最小化，并满足正规方程\n$$\nA^{\\top} A \\boldsymbol{x} = A^{\\top} \\boldsymbol{b}.\n$$\n计算\n$$\nA^{\\top} A = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix},\n\\quad\nA^{\\top} \\boldsymbol{b} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}.\n$$\n因此，正规方程为\n$$\n\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix},\n$$\n即\n$$\n\\begin{cases}\n2 x_{1} + x_{2} = 3, \\\\\nx_{1} + 2 x_{2} = 4.\n\\end{cases}\n$$\n由第一个方程，可得 $x_{2} = 3 - 2 x_{1}$。代入第二个方程：\n$$\nx_{1} + 2(3 - 2 x_{1}) = 4 \\;\\Rightarrow\\; x_{1} + 6 - 4 x_{1} = 4 \\;\\Rightarrow\\; -3 x_{1} = -2 \\;\\Rightarrow\\; x_{1} = \\frac{2}{3}.\n$$\n然后\n$$\nx_{2} = 3 - 2 \\cdot \\frac{2}{3} = 3 - \\frac{4}{3} = \\frac{5}{3}.\n$$\n因此，最小二乘解为\n$$\n\\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\end{pmatrix}}$$", "id": "1400693"}, {"introduction": "掌握了计算和应用，我们还需要深入理解伪逆的数学性质，以避免概念上的误区。一个常见的错误是想当然地认为伪逆和常规逆矩阵具有完全相同的性质。这个练习通过一个具体的反例，挑战了乘积的伪逆的“反序定律” ($(AB)^+ = B^+A^+$)，揭示了伪逆的独特性质，从而加深你对这一概念的理解。", "problem": "在线性代数中，对于任意一对相同大小的可逆方阵 $X$ 和 $Y$，其乘积的逆遵循反序定律：$(XY)^{-1} = Y^{-1}X^{-1}$。对于任意矩阵（不一定是方的或可逆的），矩阵逆的一个推广是摩尔-彭若斯伪逆（Moore-Penrose pseudoinverse），用上标“+”表示。一个自然的问题是：反序定律是否也适用于伪逆？也就是说，对于任意一对使得乘积 $AB$ 有定义的矩阵 $A$ 和 $B$，恒等式 $(AB)^+ = B^+A^+$ 是否成立？\n\n本问题要求您用一对特定的奇异矩阵来研究这个问题。考虑由下式给出的实 $2 \\times 2$ 矩阵：\n$$A = \\begin{pmatrix} 1  1 \\\\ 0  0 \\end{pmatrix} \\quad \\text{和} \\quad B = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$$\n\n为了进行计算，您可以不加证明地使用摩尔-彭若斯伪逆的以下性质：\n1. 对于一个可以写成两个非零列向量 $u$ 和 $v$ 的外积的秩为1的矩阵 $M$（即 $M=uv^T$），其伪逆由 $M^+ = \\frac{1}{\\|u\\|_2^2 \\|v\\|_2^2} v u^T$ 给出，其中 $\\| \\cdot \\|_2$ 表示标准欧几里得范数。\n2. 对于一个对称（$M^T = M$）且幂等（$M^2 = M$）的实矩阵 $M$，其伪逆是它自身，即 $M^+ = M$。\n\n计算差分矩阵 $D = (AB)^+ - B^+A^+$。$D$ 的所有元素之和是多少？", "solution": "问题要求计算差分矩阵 $D = (AB)^+ - B^+A^+$ 的所有元素之和。我们需要分别计算 $(AB)^+$ 和 $B^+A^+$ 这两项。这涉及到求矩阵 $A$ 和 $B$ 的伪逆以及它们的乘积 $AB$。\n\n首先，我们来求矩阵 $A = \\begin{pmatrix} 1  1 \\\\ 0  0 \\end{pmatrix}$ 的伪逆。\n矩阵 $A$ 是一个秩为1的矩阵。我们可以将其表示为外积 $uv^T$。我们可以看到第一行是 $\\begin{pmatrix} 1  1 \\end{pmatrix}$，第二行全是零。各列都是 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 的倍数。我们选择 $u = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。然后我们需要一个向量 $v$ 使得 $uv^T = A$。\n设 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$。那么 $uv^T = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} v_1  v_2 \\end{pmatrix} = \\begin{pmatrix} v_1  v_2 \\\\ 0  0 \\end{pmatrix}$。\n将其与 $A$ 比较，我们发现必须有 $v_1=1$ 和 $v_2=1$。所以，我们可以用 $u = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $v = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 将 $A$ 写成 $A = uv^T$。\n现在我们使用给定的秩为1矩阵的伪逆公式：$A^+ = \\frac{1}{\\|u\\|_2^2 \\|v\\|_2^2} v u^T$。\n首先，我们计算范数的平方：\n$\\|u\\|_2^2 = 1^2 + 0^2 = 1$。\n$\\|v\\|_2^2 = 1^2 + 1^2 = 2$。\n现在，我们可以计算 $A^+$：\n$$A^+ = \\frac{1}{1 \\cdot 2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 \\cdot 1  1 \\cdot 0 \\\\ 1 \\cdot 1  1 \\cdot 0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1/2  0 \\\\ 1/2  0 \\end{pmatrix}$$\n\n接下来，我们求矩阵 $B = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$ 的伪逆。\n我们可以使用提供的第二个性质。我们来检查 $B$ 是否对称和幂等。\n对称性：$B^T = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}^T = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = B$。所以，$B$ 是对称的。\n幂等性：$B^2 = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 0  1 \\cdot 0 + 0 \\cdot 0 \\\\ 0 \\cdot 1 + 0 \\cdot 0  0 \\cdot 0 + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = B$。所以，$B$ 是幂等的。\n由于 $B$ 既是对称的又是幂等的，它的伪逆就是它自身：\n$$B^+ = B = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$$\n\n现在我们可以计算乘积 $B^+A^+$：\n$$B^+A^+ = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1/2  0 \\\\ 1/2  0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot (1/2) + 0 \\cdot (1/2)  1 \\cdot 0 + 0 \\cdot 0 \\\\ 0 \\cdot (1/2) + 0 \\cdot (1/2)  0 \\cdot 0 + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1/2  0 \\\\ 0  0 \\end{pmatrix}$$\n\n下一步是计算 $(AB)^+$。首先，我们必须求出乘积 $AB$：\n$$AB = \\begin{pmatrix} 1  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 1 \\cdot 0  1 \\cdot 0 + 1 \\cdot 0 \\\\ 0 \\cdot 1 + 0 \\cdot 0  0 \\cdot 0 + 0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$$\n我们看到乘积 $AB$ 等于矩阵 $B$。因此，该乘积的伪逆就是 $B$ 的伪逆：\n$$(AB)^+ = B^+ = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$$\n\n最后，我们计算差分矩阵 $D = (AB)^+ - B^+A^+$：\n$$D = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} 1/2  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1 - 1/2  0 - 0 \\\\ 0 - 0  0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1/2  0 \\\\ 0  0 \\end{pmatrix}$$\n顺便提一下，由于 $D$ 不是零矩阵，我们证明了对于这一对 $A$ 和 $B$，$ (AB)^+ \\ne B^+A^+$。\n\n问题要求 $D$ 的所有元素之和。\n所有元素之和 = $\\frac{1}{2} + 0 + 0 + 0 = \\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1400678"}]}