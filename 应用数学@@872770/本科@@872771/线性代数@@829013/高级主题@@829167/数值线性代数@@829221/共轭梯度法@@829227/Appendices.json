{"hands_on_practices": [{"introduction": "理论是基础，但亲手实践才是掌握算法的钥匙。这个入门练习 [@problem_id:1393666] 将引导你完成共轭梯度法的第一次完整迭代。通过为一个简单的 $2 \\times 2$ 系统计算第一个近似解 $x_1$，你将熟悉计算残差、确定搜索方向和更新解的核心步骤，为更深入的理解打下坚实基础。", "problem": "考虑线性方程组 $Ax=b$，其中矩阵 $A$ 和向量 $b$ 由下式给出：\n$$\nA = \\begin{pmatrix} 2  -1 \\\\ -1  3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ -3 \\end{pmatrix}\n$$\n矩阵 $A$ 是对称正定的。\n\n从初始猜测 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，应用一次共轭梯度法迭代，求出第一个更新后的解 $x_1$。\n\n将你的答案表示为一个行矩阵，其中包含 $x_1$ 的分量，且分量为精确分数。", "solution": "我们对一个对称正定矩阵 $A$ 应用共轭梯度法，从 $x_{0}$ 开始。标准的第一次迭代公式是：\n$$\nr_{0} = b - A x_{0}, \\quad p_{0} = r_{0}, \\quad \\alpha_{0} = \\frac{r_{0}^{T} r_{0}}{p_{0}^{T} A p_{0}}, \\quad x_{1} = x_{0} + \\alpha_{0} p_{0}.\n$$\n给定 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 和 $b = \\begin{pmatrix} 4 \\\\ -3 \\end{pmatrix}$，计算\n$$\nr_{0} = b - A x_{0} = \\begin{pmatrix} 4 \\\\ -3 \\end{pmatrix}, \\quad p_{0} = r_{0} = \\begin{pmatrix} 4 \\\\ -3 \\end{pmatrix}.\n$$\n接下来，计算 $A p_{0}$：\n$$\nA p_{0} = \\begin{pmatrix} 2  -1 \\\\ -1  3 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} 2 \\cdot 4 + (-1)(-3) \\\\ (-1) \\cdot 4 + 3 \\cdot (-3) \\end{pmatrix} = \\begin{pmatrix} 11 \\\\ -13 \\end{pmatrix}.\n$$\n计算标量积：\n$$\nr_{0}^{T} r_{0} = 4^{2} + (-3)^{2} = 16 + 9 = 25, \\quad p_{0}^{T} A p_{0} = r_{0}^{T} (A p_{0}) = 4 \\cdot 11 + (-3) \\cdot (-13) = 44 + 39 = 83.\n$$\n因此，\n$$\n\\alpha_{0} = \\frac{r_{0}^{T} r_{0}}{p_{0}^{T} A p_{0}} = \\frac{25}{83}.\n$$\n更新解：\n$$\nx_{1} = x_{0} + \\alpha_{0} p_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\frac{25}{83} \\begin{pmatrix} 4 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} \\frac{100}{83} \\\\ -\\frac{75}{83} \\end{pmatrix}.\n$$\n表示为行矩阵，$x_1$ 的分量是 $\\begin{pmatrix} \\frac{100}{83}  -\\frac{75}{83} \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{100}{83}  -\\frac{75}{83} \\end{pmatrix}}$$", "id": "1393666"}, {"introduction": "共轭梯度法作为一个迭代过程，通常需要多次迭代才能收敛。然而，在某些特殊情况下，它竟能一步到位，直接找到精确解。这个引人深思的练习 [@problem_id:1393668] 旨在揭示算法性能与矩阵谱特性（特别是特征向量）之间的深刻联系，让你主动探索并构建实现这种“理想”单步收敛的初始条件。", "problem": "共轭梯度法 (CG) 是一种迭代算法，用于求解形如 $A\\mathbf{x} = \\mathbf{b}$ 的线性方程组，其中 $A$ 是一个对称正定矩阵。该方法的性能可能取决于初始猜测值 $\\mathbf{x}_0$ 的选择。\n\n考虑由矩阵 $A = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$ 和向量 $\\mathbf{b} = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$ 定义的线性系统。CG 方法使用形式为 $\\begin{pmatrix} 1 \\\\ y_0 \\end{pmatrix}$ 的起始向量进行初始化，其中 $y_0$ 是一个实数。\n\n求出所有可能的 $y_0$ 值，使得 CG 方法能在单次迭代内收敛到精确解。这意味着第一次迭代的结果 $\\mathbf{x}_1$ 就是精确解。你可以假设初始猜测值 $\\mathbf{x}_0$ 本身不是精确解。计算所有这些有效的 $y_0$ 值的和。", "solution": "对于对称正定矩阵 $A$ 的共轭梯度法，从 $x_{0}$ 开始，残差为 $r_{0}=b-Ax_{0}$，搜索方向为 $p_{0}=r_{0}$，步长为\n$$\n\\alpha_{0}=\\frac{r_{0}^{T}r_{0}}{p_{0}^{T}Ap_{0}},\n$$\n更新得到 $x_{1}=x_{0}+\\alpha_{0}p_{0}$。精确解 $x^{*}$ 满足 $Ax^{*}=b$。定义初始误差 $e_{0}=x^{*}-x_{0}$。那么\n$$\nr_{0}=b-Ax_{0}=Ax^{*}-Ax_{0}=A(x^{*}-x_{0})=Ae_{0}.\n$$\n单次迭代收敛意味着 $x_{1}=x^{*}$，即\n$$\nx^{*}=x_{0}+\\alpha_{0}r_{0}\\quad\\Longleftrightarrow\\quad e_{0}=\\alpha_{0}r_{0}=\\alpha_{0}Ae_{0}.\n$$\n因此 $Ae_{0}=(1/\\alpha_{0})e_{0}$，所以 $e_{0}$ 必须是 $A$ 的一个特征向量。反之，如果 $Ae_{0}=\\lambda e_{0}$，那么 $r_{0}=\\lambda e_{0}$ 并且\n$$\n\\alpha_{0}=\\frac{r_{0}^{T}r_{0}}{r_{0}^{T}Ar_{0}}=\\frac{\\lambda^{2}e_{0}^{T}e_{0}}{\\lambda^{3}e_{0}^{T}e_{0}}=\\frac{1}{\\lambda},\n$$\n这就得到 $x_{1}=x_{0}+\\alpha_{0}r_{0}=x_{0}+(1/\\lambda)\\lambda e_{0}=x^{*}$。因此，单步收敛的充要条件是 $e_{0}$ 是 $A$ 的一个特征向量。\n\n对于 $A=\\begin{pmatrix}2  -1\\\\ -1  2\\end{pmatrix}$ 和 $b=\\begin{pmatrix}1\\\\ 3\\end{pmatrix}$，计算 $x^{*}$。求解\n$$\n\\begin{cases}\n2x_{1}-x_{2}=1,\\\\\n-x_{1}+2x_{2}=3,\n\\end{cases}\n$$\n解得 $x_{1}=5/3$，$x_{2}=7/3$，因此 $x^{*}=\\begin{pmatrix}5/3\\\\ 7/3\\end{pmatrix}$。\n\n当 $x_{0}=\\begin{pmatrix}1\\\\ y_{0}\\end{pmatrix}$ 时，初始误差为\n$$\ne_{0}=x^{*}-x_{0}=\\begin{pmatrix}5/3-1\\\\ 7/3-y_{0}\\end{pmatrix}=\\begin{pmatrix}2/3\\\\ 7/3-y_{0}\\end{pmatrix}.\n$$\n$A$ 的特征值为 $\\lambda_{1}=1$，对应的特征向量为 $v_{1}=\\begin{pmatrix}1\\\\ 1\\end{pmatrix}$，以及 $\\lambda_{2}=3$，对应的特征向量为 $v_{2}=\\begin{pmatrix}1\\\\ -1\\end{pmatrix}$。因此 $e_{0}$ 必须与 $v_{1}$ 或 $v_{2}$ 平行。\n\n情况1：$e_{0}=c\\begin{pmatrix}1\\\\ 1\\end{pmatrix}$。那么 $2/3=c$ 且 $7/3-y_{0}=c$，所以 $y_{0}=7/3-2/3=5/3$。\n\n情况2：$e_{0}=c\\begin{pmatrix}1\\\\ -1\\end{pmatrix}$。那么 $2/3=c$ 且 $7/3-y_{0}=-c=-2/3$，所以 $y_{0}=7/3+2/3=3$。\n\n这两个值都使得 $e_{0}\\neq 0$，因此 $x_{0}\\neq x^{*}$，符合要求。所有这些 $y_{0}$ 值的和是\n$$\n\\frac{5}{3}+3=\\frac{5}{3}+\\frac{9}{3}=\\frac{14}{3}.\n$$", "answer": "$$\\boxed{\\frac{14}{3}}$$", "id": "1393668"}, {"introduction": "我们通常期望一个有效的迭代算法在每一步都“更接近”解，但这“接近”该如何衡量呢？本练习 [@problem_id:1393663] 通过一个精心设计的例子，揭示了共轭梯度法一个微妙但至关重要的特性。你会发现，尽管该方法确保误差在一种特定范数（即$A$-范数）下是单调递减的，但我们更直观监测的残差欧几里得范数 $\\lVert r_k \\rVert_2$ 有时却可能在迭代中短暂增大。", "problem": "共轭梯度（CG）法是一种用于求解线性方程组 $Ax=b$ 的迭代算法，其中矩阵 $A$ 是对称正定的。该算法生成一个解序列 $x_k$，该序列收敛于真实解。\n\n从初始猜测值 $x_0$ 开始，标准算法定义如下：\n1.  初始化残差 $r_0 = b - Ax_0$ 和搜索方向 $p_0 = r_0$。\n2.  对于 $k = 0, 1, 2, \\dots$，直到收敛：\n    a. 计算步长：$\\alpha_k = \\frac{r_k^T r_k}{p_k^T A p_k}$\n    b. 更新解：$x_{k+1} = x_k + \\alpha_k p_k$\n    c. 更新残差：$r_{k+1} = r_k - \\alpha_k A p_k$\n    d. 计算改进因子：$\\beta_k = \\frac{r_{k+1}^T r_{k+1}}{r_k^T r_k}$\n    e. 更新搜索方向：$p_{k+1} = r_{k+1} + \\beta_k p_k$\n\n考虑线性系统 $Ax=b$，其中矩阵 $A$ 和向量 $b$ 由下式给出：\n$$ A = \\begin{pmatrix} 1  0  0 \\\\ 0  10  0 \\\\ 0  0  100 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0.1 \\\\ 0.01 \\end{pmatrix} $$\n使用初始猜测值 $x_0 = (0, 0, 0)^T$，执行一次完整的共轭梯度算法迭代（即循环中对应于 $k=0$ 的计算），以确定第一个更新后的残差向量 $r_1$。\n\n计算该残差向量的欧几里得范数（也称为 $L^2$-范数）$\\|r_1\\|_2$。将您的答案以四舍五入到四位有效数字的数值形式报告。", "solution": "我们从 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 开始，应用共轭梯度（CG）算法进行一次迭代。\n\n计算初始残差和搜索方向：\n$$\nr_{0} = b - A x_{0} = b = \\begin{pmatrix} 1 \\\\ 0.1 \\\\ 0.01 \\end{pmatrix}, \\quad p_{0} = r_{0}.\n$$\n步长为\n$$\n\\alpha_{0} = \\frac{r_{0}^{T} r_{0}}{p_{0}^{T} A p_{0}} = \\frac{1^{2} + 0.1^{2} + 0.01^{2}}{1 \\cdot 1^{2} + 10 \\cdot (0.1)^{2} + 100 \\cdot (0.01)^{2}} = \\frac{1.0101}{1.11} = 0.91.\n$$\n计算 $A p_{0}$：\n$$\nA p_{0} = A r_{0} = \\begin{pmatrix} 1  0  0 \\\\ 0  10  0 \\\\ 0  0  100 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0.1 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}.\n$$\n更新残差：\n$$\nr_{1} = r_{0} - \\alpha_{0} A p_{0} = \\begin{pmatrix} 1 \\\\ 0.1 \\\\ 0.01 \\end{pmatrix} - 0.91 \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.09 \\\\ -0.81 \\\\ -0.9 \\end{pmatrix}.\n$$\n计算其欧几里得范数：\n$$\n\\|r_{1}\\|_{2} = \\sqrt{(0.09)^{2} + (-0.81)^{2} + (-0.9)^{2}} = \\sqrt{0.0081 + 0.6561 + 0.81} = \\sqrt{1.4742} \\approx 1.214.\n$$\n四舍五入到四位有效数字，范数为 $1.214$。", "answer": "$$\\boxed{1.214}$$", "id": "1393663"}]}