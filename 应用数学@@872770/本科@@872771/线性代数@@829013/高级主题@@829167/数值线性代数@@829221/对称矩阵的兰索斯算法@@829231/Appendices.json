{"hands_on_practices": [{"introduction": "第一个实践练习旨在让你亲自动手体验 Lanczos 算法的核心迭代过程。通过为一个小的 $3 \\times 3$ 矩阵手动计算前两次迭代，你将构建出 $2 \\times 2$ 的三对角矩阵 $T_2$。这个练习是理解该算法如何逐步构建标准正交基和三对角表示的基础。", "problem": "Lanczos算法是数值线性代数中一种强大的迭代方法，尤其适用于求解大型对称矩阵的特征值。当应用于一个 $n \\times n$ 的对称矩阵 $A$ 和一个起始向量 $b$ 时，该算法会构建一个标准正交向量序列，这些向量构成了Krylov子空间的基，并同时生成一个对称三对角矩阵 $T$，其特征值可近似于 $A$ 的特征值。\n\n考虑如下给定的实对称 $3 \\times 3$ 矩阵 $A$ 和起始向量 $b$：\n$$ A = \\begin{pmatrix} 4  1  1 \\\\ 1  2  3 \\\\ 1  3  5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n设 $T_2$ 是对矩阵 $A$ 和起始向量 $b$ 应用Lanczos算法进行两次完整迭代后生成的 $2 \\times 2$ 对称三对角矩阵。您的任务是计算矩阵 $T_2$。", "solution": "为了与文章主体部分的符号保持一致，我们使用以下Lanczos算法步骤来求解。算法从一个单位化的初始向量 $q_1$ 开始。\n对于 $j=1, 2, \\dots, k$：\n1.  计算 $v = A q_j$。\n2.  计算对角项系数 $\\alpha_j = q_j^T v$。\n3.  计算残差向量 $r_j = v - \\alpha_j q_j - \\beta_j q_{j-1}$ (约定 $q_0 = \\mathbf{0}, \\beta_1 = 0$)。\n4.  计算次对角项系数 $\\beta_{j+1} = \\|r_j\\|$。\n5.  如果 $\\beta_{j+1} \\neq 0$，单位化得到下一个基向量 $q_{j+1} = r_j / \\beta_{j+1}$。\n\n经过 $k$ 步迭代，我们得到一个 $k \\times k$ 的三对角矩阵 $T_k$，其对角线元素为 $\\alpha_1, \\dots, \\alpha_k$，次对角线元素为 $\\beta_2, \\dots, \\beta_k$。我们的目标是计算 $T_2$。\n\n**第 1 步：初始化**\n给定 $b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$，我们有 $\\|b\\| = 1$。因此，初始向量为：\n$$ q_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第 2 步：第一次迭代 (j=1)**\n1.  $v = A q_1 = \\begin{pmatrix} 4  1  1 \\\\ 1  2  3 \\\\ 1  3  5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n2.  $\\alpha_1 = q_1^T v = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix} = 4$。\n3.  $r_1 = v - \\alpha_1 q_1 - \\beta_1 q_0 = \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix} - 4 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 0 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n4.  $\\beta_2 = \\|r_1\\| = \\sqrt{0^2 + 1^2 + 1^2} = \\sqrt{2}$。\n5.  $q_2 = \\frac{r_1}{\\beta_2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n\n**第 3 步：第二次迭代 (j=2)**\n1.  $v = A q_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 4  1  1 \\\\ 1  2  3 \\\\ 1  3  5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 5 \\\\ 8 \\end{pmatrix}$。\n2.  $\\alpha_2 = q_2^T v = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0  1  1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 5 \\\\ 8 \\end{pmatrix} \\right) = \\frac{1}{2}(0 \\cdot 2 + 1 \\cdot 5 + 1 \\cdot 8) = \\frac{13}{2}$。\n\n**第 4 步：构建 T_2**\n经过两次迭代，我们得到了 $\\alpha_1=4$, $\\alpha_2=\\frac{13}{2}$ 和 $\\beta_2=\\sqrt{2}$。由此可以构建 $2 \\times 2$ 的三对角矩阵 $T_2$：\n$$ T_2 = \\begin{pmatrix} \\alpha_1  \\beta_2 \\\\ \\beta_2  \\alpha_2 \\end{pmatrix} = \\begin{pmatrix} 4  \\sqrt{2} \\\\ \\sqrt{2}  \\frac{13}{2} \\end{pmatrix} $$", "answer": "$$\\boxed{\\begin{pmatrix} 4  \\sqrt{2} \\\\ \\sqrt{2}  \\frac{13}{2} \\end{pmatrix}}$$", "id": "1371132"}, {"introduction": "在通过上一个练习 [@problem_id:1371132] 掌握了 Lanczos 算法的迭代计算后，现在让我们来探讨一个揭示其与矩阵特征向量之间深层联系的特殊情况。这个问题探讨了当我们用矩阵的一个特征向量作为初始向量启动算法时会发生什么。这个思想实验对于理解 Krylov 子空间的概念以及算法的终止条件至关重要。", "problem": "设 $A$ 是一个实对称 $n \\times n$ 矩阵，设 $b$ 是 $\\mathbb{R}^n$ 中的一个非零向量。已知 $b$ 是 $A$ 的一个特征向量，对应于一个实特征值 $\\lambda$。将兰佐斯算法应用于矩阵 $A$，初始向量为 $b$。该算法过程如下：\n\n1.  初始化：令 $q_1 = b / \\|b\\|_2$，$\\beta_0 = 0$，且 $q_0 = \\vec{0}$ (零向量)。\n2.  对于 $j = 1, 2, \\dots$：\n    a. 计算 $v_j = A q_j$。\n    b. 计算对角元素 $\\alpha_j = q_j^T v_j$。\n    c. 计算残差向量 $w_j = v_j - \\alpha_j q_j - \\beta_{j-1} q_{j-1}$。\n    d. 计算非对角元素 $\\beta_j = \\|w_j\\|_2$。\n    e. 如果 $\\beta_j = 0$，算法终止。令 $m=j$。\n    f. 否则，计算下一个向量 $q_{j+1} = w_j / \\beta_j$。\n\n该算法产生一个 $m \\times m$ 的对称三对角矩阵 $T_m$，其对角线元素为 $\\alpha_1, \\dots, \\alpha_m$，非对角线元素为 $\\beta_1, \\dots, \\beta_{m-1}$。\n\n下列哪个陈述正确描述了此过程的结果？\n\nA. 该算法运行 $m=n$ 次迭代，因为Krylov子空间的维数总是 $n$。\n\nB. 该算法在一次迭代后终止 ($m=1$)，产生的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [\\lambda]$。\n\nC. 该算法在一次迭代后终止 ($m=1$)，产生的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [1]$。\n\nD. 该算法在第一步失败，因为计算 $q_1$ 涉及除以零。\n\nE. 该算法无限运行，因为使用特征向量作为初始向量会产生一个循环。", "solution": "本题要求确定当初始向量是矩阵的特征向量时，兰佐斯算法的行为。让我们根据给定的信息来追踪算法的步骤。\n\n我们给定一个对称矩阵 $A$，一个非零向量 $b$，和一个标量 $\\lambda$，使得 $A b = \\lambda b$。\n\n**步骤 1：初始化**\n算法从初始化第一个向量 $q_1$ 开始。\n$$q_1 = \\frac{b}{\\|b\\|_2}$$\n因为 $b$ 是一个非零向量，所以 $\\|b\\|_2 \\neq 0$，因此 $q_1$ 是良定义的。$q_1$ 是一个与 $b$ 平行的单位向量。\n我们还有 $\\beta_0 = 0$ 和 $q_0 = \\vec{0}$。\n\n**步骤 2：第一次迭代 ($j=1$)**\n现在我们进行循环的第一次迭代。\n\na. 计算 $v_1 = A q_1$。\n由于 $q_1$ 是特征向量 $b$ 的标量倍数，所以 $q_1$ 也是 $A$ 的一个特征向量，对应于相同的特征值 $\\lambda$。\n$$A q_1 = A \\left(\\frac{b}{\\|b\\|_2}\\right) = \\frac{1}{\\|b\\|_2} (A b) = \\frac{1}{\\|b\\|_2} (\\lambda b) = \\lambda \\left(\\frac{b}{\\|b\\|_2}\\right) = \\lambda q_1$$\n所以，$v_1 = \\lambda q_1$。\n\nb. 计算 $\\alpha_1 = q_1^T v_1$。\n代入 $v_1$ 的表达式：\n$$\\alpha_1 = q_1^T (\\lambda q_1) = \\lambda (q_1^T q_1)$$\n由于 $q_1$ 是一个单位向量，所以 $q_1^T q_1 = \\|q_1\\|_2^2 = 1$。\n因此，$\\alpha_1 = \\lambda$。\n\nc. 计算残差向量 $w_1 = v_1 - \\alpha_1 q_1 - \\beta_0 q_0$。\n使用我们已经求得的值：\n$$w_1 = (\\lambda q_1) - (\\lambda) q_1 - (0) \\vec{0} = \\lambda q_1 - \\lambda q_1 - \\vec{0} = \\vec{0}$$\n残差向量是零向量。\n\nd. 计算 $\\beta_1 = \\|w_1\\|_2$。\n$$\\beta_1 = \\|\\vec{0}\\|_2 = 0$$\n\ne. 检查终止条件。\n终止条件是 $\\beta_j = 0$。由于我们发现 $\\beta_1 = 0$，算法在这一步终止。迭代次数为 $m=1$。\n\n算法的输出是 $m \\times m$ 的三对角矩阵 $T_m$。在这种情况下，$m=1$，所以我们得到一个 $1 \\times 1$ 的矩阵 $T_1$。$T_m$ 的一般形式在对角线上有 $\\alpha_j$ 值。对于 $m=1$，矩阵就是：\n$$T_1 = [\\alpha_1]$$\n我们发现 $\\alpha_1 = \\lambda$。因此，得到的矩阵是 $T_1 = [\\lambda]$。\n\n现在，让我们评估给定的选项：\nA. 该算法运行 $m=n$ 次迭代，因为Krylov子空间的维数总是 $n$。这是错误的。算法在 $m=1$ 次迭代后就终止了。Krylov子空间 $\\mathcal{K}_1(A, b) = \\text{span}\\{b\\}$ 是一维的。\nB. 该算法在一次迭代后终止 ($m=1$)，产生的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [\\lambda]$。这正是我们所发现的。\nC. 该算法在一次迭代后终止 ($m=1$)，产生的矩阵是 $1 \\times 1$ 矩阵 $T_1 = [1]$。这是错误的；矩阵元素是特征值 $\\lambda$，它不一定是 1。\nD. 该算法在第一步失败，因为计算 $q_1$ 涉及除以零。这是错误的。问题陈述 $b$ 是一个非零向量，所以它的范数 $\\|b\\|_2$ 是非零的。\nE. 该算法无限运行，因为使用特征向量作为初始向量会产生一个循环。这是错误的。兰佐斯算法保证在最多 $n$ 步内终止。我们已经证明，在这种情况下，它在一步内终止。\n\n因此，唯一正确的陈述是 B。", "answer": "$$\\boxed{B}$$", "id": "1371167"}, {"introduction": "在通过 [@problem_id:1371167] 理解了算法行为与矩阵特征结构之间的联系后，最后一个练习将探讨一个与谱变换相关的强大理论特性。通过分析对矩阵 $A$ 进行一个简单的“平移”变换（即 $A' = A - \\sigma I$）会如何影响最终生成的三对角矩阵 $T_k$，你将揭示一个对于高级技巧（如“位移-反演”方法）至关重要的原理。", "problem": "Lanczos算法是一种迭代方法，用于寻找大型对称矩阵的特征值和特征向量。对于一个给定的 $n \\times n$ 实对称矩阵 $A$ 和一个满足 $\\|v_1\\|_2 = 1$ 的初始向量 $v_1$，该算法生成一系列标准正交向量 $q_1, q_2, \\dots, q_k$（其中 $q_1 = v_1$），这些向量构成一个Krylov子空间的基。这些向量满足以下三项递推关系：\n$$A q_j = \\beta_{j-1} q_{j-1} + \\alpha_j q_j + \\beta_j q_{j+1}$$\n对于 $j=1, \\dots, k$，其中 $q_0 = 0$ 且 $\\beta_0 = 0$。系数 $\\alpha_j = q_j^T A q_j$ 构成一个 $k \\times k$ 对称三对角矩阵 $T_k$ 的对角元素，而 $\\beta_j = \\| A q_j - \\alpha_j q_j - \\beta_{j-1} q_{j-1} \\|_2$ 构成其非对角元素。\n\n现在，考虑对矩阵 $A$ 进行一个实常数位移 $\\sigma$ 的谱变换，得到一个新矩阵 $A' = A - \\sigma I_n$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。假设我们对矩阵 $A'$ 应用同样的Lanczos算法进行 $k$ 步迭代，使用完全相同的初始向量 $v_1$。这个新过程会生成一个新的 $k \\times k$ 对称三对角矩阵，我们称之为 $T'_k$。\n\n请确定 $T'_k$ 和 $T_k$ 之间的关系。用 $T_k$、位移 $\\sigma$ 和 $k \\times k$ 单位矩阵 $I_k$ 来表示 $T'_k$。", "solution": "我们给定一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和从 $q_{1}=v_{1}$（其中 $\\|v_{1}\\|_{2}=1$）开始的Lanczos过程，该过程生成满足三项递推关系的标准正交向量 $q_j$\n$$\nA q_{j}=\\beta_{j-1} q_{j-1}+\\alpha_{j} q_{j}+\\beta_{j} q_{j+1}, \\quad j=1,\\dots,k,\n$$\n其中 $q_{0}=0$ 且 $\\beta_{0}=0$。三对角矩阵 $T_{k}$ 的对角元素为 $\\alpha_{j}=q_{j}^{T} A q_{j}$，非对角元素为 $\\beta_{j}=\\|A q_{j}-\\alpha_{j} q_{j}-\\beta_{j-1} q_{j-1}\\|_{2}$。\n\n考虑使用相同初始向量 $v_{1}$ 的位移矩阵 $A'=A-\\sigma I_{n}$。首先，Krylov子空间是重合的：\n$$\n\\mathcal{K}_{m}(A,v_{1})=\\operatorname{span}\\{v_{1},A v_{1},\\dots,A^{m-1} v_{1}\\}=\\mathcal{K}_{m}(A',v_{1}),\n$$\n因为对于每个 $m \\in \\mathbb{N}$，\n$$\n(A-\\sigma I_{n})^{m} v_{1}=\\sum_{r=0}^{m} \\binom{m}{r} (-\\sigma)^{m-r} A^{r} v_{1},\n$$\n这表明每个 $(A')^{m} v_{1}$ 都位于 $\\mathcal{K}_{m+1}(A,v_{1})$ 中，反之，根据同样的论证，$A^{m} v_{1}$ 也是 $\\{(A')^{r} v_{1}\\}_{r=0}^{m}$ 的一个线性组合。因此，对 $A'$ 和 $v_{1}$ 应用Lanczos算法生成的标准正交基在每一步都必须位于相同的子空间中。\n\n我们现在通过数学归纳法证明，Lanczos向量和非对角系数保持不变，而对角系数被平移了 $-\\sigma$。\n\n对矩阵 $A$，定义残差 $r_{j}=A q_{j}-\\alpha_{j} q_{j}-\\beta_{j-1} q_{j-1}$，使得 $\\beta_{j}=\\|r_{j}\\|_{2}$ 且 $q_{j+1}=r_{j}/\\beta_{j}$。对矩阵 $A'$，定义 $\\alpha'_{j}=q_{j}^{T} A' q_{j}$，$\\beta'_{j}=\\|A' q_{j}-\\alpha'_{j} q_{j}-\\beta'_{j-1} q_{j-1}\\|_{2}$，以及 $r'_{j}=A' q_{j}-\\alpha'_{j} q_{j}-\\beta'_{j-1} q_{j-1}$。\n\n归纳基础 $j=1$：由于 $q_1$ 是单位范数向量，\n$$\n\\alpha'_{1}=q_{1}^{T} A' q_{1}=q_{1}^{T} (A-\\sigma I_{n}) q_{1}=q_{1}^{T} A q_{1}-\\sigma=\\alpha_{1}-\\sigma.\n$$\n同样地，\n$$\nr'_{1}=A' q_{1}-\\alpha'_{1} q_{1}=A q_{1}-\\sigma q_{1}-(\\alpha_{1}-\\sigma) q_{1}=A q_{1}-\\alpha_{1} q_{1}=r_{1},\n$$\n因此 $\\beta'_{1}=\\|r'_{1}\\|_{2}=\\|r_{1}\\|_{2}=\\beta_{1}$ 且 $q_{2}'=r'_{1}/\\beta'_{1}=r_{1}/\\beta_{1}=q_{2}$。\n\n归纳步骤：假设对于某个 $j \\geq 2$，$q_{j-1}$ 和 $q_{j}$ 对于 $A$ 和 $A'$ 是相同的，并且 $\\beta'_{j-1}=\\beta_{j-1}$。那么\n$$\n\\alpha'_{j}=q_{j}^{T} A' q_{j}=q_{j}^{T} (A-\\sigma I_{n}) q_{j}=q_{j}^{T} A q_{j}-\\sigma=\\alpha_{j}-\\sigma,\n$$\n并且\n$$\n\\begin{aligned}\nr'_{j}=A' q_{j}-\\alpha'_{j} q_{j}-\\beta'_{j-1} q_{j-1}\\\\\n=(A-\\sigma I_{n}) q_{j}-(\\alpha_{j}-\\sigma) q_{j}-\\beta_{j-1} q_{j-1}\\\\\n=A q_{j}-\\alpha_{j} q_{j}-\\beta_{j-1} q_{j-1}=r_{j}.\n\\end{aligned}\n$$\n因此 $\\beta'_{j}=\\|r'_{j}\\|_{2}=\\|r_{j}\\|_{2}=\\beta_{j}$ 且 $q'_{j+1}=r'_{j}/\\beta'_{j}=r_{j}/\\beta_{j}=q_{j+1}$。归纳完成。\n\n因此，Lanczos基 $q_{1},\\dots,q_{k}$ 和非对角元素 $\\beta_j$ 保持不变，而对角元素被平移：$\\alpha'_{j}=\\alpha_{j}-\\sigma$。所以，三对角矩阵满足\n$$\nT'_{k}=T_{k}-\\sigma I_{k}.\n$$\n\n一个等价的紧凑推导使用了Lanczos分解 $A Q_{k}=Q_{k} T_{k}+\\beta_{k} q_{k+1} e_{k}^{T}$，其中 $Q_{k}=[q_{1}\\ \\dots\\ q_{k}]$。那么\n$$\nA' Q_{k}=(A-\\sigma I_{n}) Q_{k}=A Q_{k}-\\sigma Q_{k}=Q_{k} (T_{k}-\\sigma I_{k})+\\beta_{k} q_{k+1} e_{k}^{T}.\n$$\n根据 $A'$ 的Lanczos关系中三对角投影的唯一性，这证实了 $T'_{k}=T_{k}-\\sigma I_{k}$。", "answer": "$$\\boxed{T'_{k}=T_{k}-\\sigma I_{k}}$$", "id": "1371119"}]}