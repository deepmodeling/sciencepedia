{"hands_on_practices": [{"introduction": "这个练习将帮助你掌握希尔密码的基本机制。我们将探讨一种被称为“对合密码”的特殊密码，其加密和解密操作是相同的。通过确定密钥矩阵具备此特性的条件，你将更深入地理解矩阵代数和模算术如何结合起来构成一个密码系统。[@problem_id:1348683]", "problem": "在密码学中，希尔密码是一种基于线性代数的多字母替换密码。消息被分成大小为 $n$ 的块，每个块表示为一个列向量 $P$。对应的密文向量 $C$ 通过变换 $C \\equiv KP \\pmod m$ 获得，其中 $K$ 是一个可逆的 $n \\times n$ 密钥矩阵，$m$ 是字母表的大小。\n\n一类特殊的密码是“对合密码”，其加密过程是其自身的逆过程。这意味着将加密变换对任意明文向量应用两次，会返回原始的明文向量。\n\n考虑一个这样的对合希尔密码，它作用于包含 $m=26$ 个字母的英文字母表（映射为 $A=0, B=1, \\dots, Z=25$），并使用一个 $2 \\times 2$ 的密钥矩阵 $K$。该密钥矩阵部分已知，如下所示：\n$$\nK = \\begin{pmatrix} 5  3 \\\\ 18  d \\end{pmatrix}\n$$\n其中 $d$ 是一个整数。\n\n请确定在范围 $0 \\le d  26$ 内 $d$ 的唯一值，使得该密码是对合的。", "solution": "一个对合希尔密码满足 $K^{2} \\equiv I \\pmod{26}$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。对于 $K=\\begin{pmatrix} 5  3 \\\\ 18  d \\end{pmatrix}$，我们计算\n$$\nK^{2}\n=\n\\begin{pmatrix}\n5^{2}+3\\cdot 18  5\\cdot 3+3d \\\\\n18\\cdot 5 + d\\cdot 18  18\\cdot 3 + d^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n79  15+3d \\\\\n90+18d  54+d^{2}\n\\end{pmatrix}.\n$$\n应用条件 $K^{2} \\equiv I \\pmod{26}$ 得到以下四个同余方程：\n$$79 \\equiv 1 \\pmod{26},$$\n$$15+3d \\equiv 0 \\pmod{26},$$\n$$90+18d \\equiv 0 \\pmod{26},$$\n$$54+d^{2} \\equiv 1 \\pmod{26}.$$\n第一个方程成立，因为 $79-1=78=3\\cdot 26$。对于右上角的元素，$15+3d \\equiv 0 \\pmod{26}$ 等价于 $3(5+d) \\equiv 0 \\pmod{26}$。因为 $\\gcd(3,26)=1$，所以两边乘以 $3$ 模 $26$ 的逆元，得到 $5+d \\equiv 0 \\pmod{26}$，因此\n$$d \\equiv -5 \\equiv 21 \\pmod{26}.$$\n对于左下角的元素，$90+18d \\equiv 0 \\pmod{26}$ 即 $18(5+d) \\equiv 0 \\pmod{26}$。当 $d \\equiv 21 \\pmod{26}$ 时，我们有 $5+d \\equiv 0 \\pmod{26}$，所以该方程成立。最后，右下角的元素给出 $d^{2} \\equiv 1-54 \\equiv -53 \\equiv 25 \\pmod{26}$，其模 $26$ 的解为 $d \\equiv 5$ 和 $d \\equiv 21$。非对角线元素的条件 $3(5+d) \\equiv 0 \\pmod{26}$ 排除了 $d \\equiv 5$，留下了在 $0 \\le d  26$ 内的唯一解：\n$$d=21.$$\n作为检验，对于 $d=21$，\n$$K^{2}=\\begin{pmatrix}79  78 \\\\ 468  495\\end{pmatrix} \\equiv \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} \\pmod{26},$$\n且 $\\det K = 5\\cdot 21 - 54 = 51 \\equiv 25 \\pmod{26}$ 且 $\\gcd(25,26)=1$，因此 $K$ 模 $26$ 可逆，该密码是对合的。", "answer": "$$\\boxed{21}$$", "id": "1348683"}, {"introduction": "从密码构建转向密码分析，这个问题探讨了密钥矩阵结构与其特征向量之间的深刻联系。你将分析一个假设情景：攻击者获取了密钥的特征向量。这个思想实验对于理解对角化等基本概念如何揭示密码协议中的漏洞至关重要，并强调了保护密钥本身及其所有相关结构信息的重要性。[@problem_id:1348662]", "problem": "在一个专门的密码协议中，加密密钥由一个实数项的3x3矩阵 $K$ 表示。该密钥使用一个保密的可逆3x3矩阵 $P$ 和一个公开的3x3对角矩阵 $D$ 生成。这些矩阵之间的关系由相似变换 $K = PDP^{-1}$ 给出。\n\n公开矩阵 $D$ 定义如下：\n$$\nD = \\begin{pmatrix} d_1  0  0 \\\\ 0  d_2  0 \\\\ 0  0  d_3 \\end{pmatrix}\n$$\n其中 $d_1, d_2, d_3$ 是互不相同且非零的实数。\n\n一个密码分析者试图找出保密的矩阵 $P$，他设法获取了密钥矩阵 $K$ 的一组三个线性无关的特征向量，记为向量 $v_1, v_2, v_3$。然而，该密码分析者既不知道密钥矩阵 $K$ 本身，也不知道哪个特征向量对应于哪个特征值。\n\n仅根据公开矩阵 $D$ 和泄露的特征向量集合 $\\{v_1, v_2, v_3\\}$，密码分析者能对保密矩阵 $P$ 得出什么最精确的结论？\n\nA. 密码分析者没有获得任何信息。保密矩阵 $P$ 仍然可以是任何可逆的3x3矩阵。\n\nB. 密码分析者可以唯一确定保密矩阵 $P$。\n\nC. 密码分析者可以确定保密矩阵 $P$，但其列的排列是未知的。\n\nD. 密码分析者可以确定保密矩阵 $P$，但其每一列都可以被一个未知的非零常数进行缩放。\n\nE. 密码分析者可以确定保密矩阵 $P$，但其列的排列以及每列独立的非零常数缩放均是未知的。", "solution": "我们给定一个可对角化的矩阵 $K$，它通过 $K=PDP^{-1}$ 与一个对角矩阵 $D=\\operatorname{diag}(d_{1},d_{2},d_{3})$ 相关联，其中对角项互不相同且非零。记 $P=[p_{1}\\ p_{2}\\ p_{3}]$。使用 $K=PDP^{-1}$，在右边乘以 $P$ 得到\n$$\nK P = P D.\n$$\n对两边的列进行比较，对于每个 $i\\in\\{1,2,3\\}$，可得\n$$\nK p_{i} = d_{i} p_{i},\n$$\n因此 $P$ 的列是 $K$ 的特征向量，其中 $p_{i}$ 是对应于特征值 $d_{i}$ 的特征向量。因为 $d_{1},d_{2},d_{3}$ 互不相同，每个特征空间都是一维的，因此每个 $p_{i}$ 只能在乘以一个非零标量的范围内被确定。\n\n密码分析者知道 $K$ 的三个线性无关的特征向量 $\\{v_{1},v_{2},v_{3}\\}$，但不知道哪个特征向量对应于哪个特征值。因此，存在一个 $\\{1,2,3\\}$ 的排列 $\\sigma$ 和非零标量 $c_{1},c_{2},c_{3}$，使得\n$$\np_{i} = c_{i}\\, v_{\\sigma(i)} \\quad \\text{for } i=1,2,3.\n$$\n这表示 $P$ 的列必须是泄露的特征向量，但其顺序（排列）未知，且每列都有一个独立的非零缩放。\n\n此外，即使 $K$ 是已知的，$P$ 也不是唯一的：对于任何具有非零 $s_{i}$ 的可逆对角矩阵 $S=\\operatorname{diag}(s_{1},s_{2},s_{3})$，定义 $P'=P S$。那么\n$$\nP' D (P')^{-1} \\;=\\; (P S) D (S^{-1} P^{-1}) \\;=\\; P (S D S^{-1}) P^{-1} \\;=\\; P D P^{-1} \\;=\\; K,\n$$\n因为 $S$ 和 $D$ 都是对角矩阵且可以交换，这意味着 $S D S^{-1}=D$。因此，将 $P$ 的列乘以任意非零因子不会改变 $K$，并且仅从 $D$ 和特征向量无法消除这种不确定性。此外，由于每个泄露的特征向量与每个特征值 $d_{i}$ 之间的对应关系是未知的，所以 $P$ 的列的顺序在任意排列下都是不确定的。\n\n因此：\n- 不是A：密码分析者确实获得了信息；$P$ 的列必须位于泄露的特征向量所张成的空间中。\n- 不是B：由于上述不确定性，$P$ 不是唯一的。\n- 不是C：列的缩放自由度仍然存在。\n- 不是D：排列的不确定性仍然存在。\n\n最精确的结论是，$P$ 的确定性仅相差其列的一个排列以及每列的一个独立的非零缩放。\n\n因此，正确选项是E。", "answer": "$$\\boxed{E}$$", "id": "1348662"}, {"introduction": "现实世界中的密码学常常需要处理不完美的信息，例如在传输过程中被噪声损坏的数据。这个实践问题将让你扮演一个密码分析员，直面这一挑战。你将应用最小二乘法——一种来自线性代数的强大数据拟合工具——从带噪声的密文中恢复出最可能的加密密钥，从而连接起纯粹的理论模型与实际的数据驱动分析。[@problem_id:1348664]", "problem": "一名密码分析员正在分析一个简化的线性加密方案。该方案将英文字母映射为整数（A=0, B=1, ..., Z=25）。一条明文消息被分解为字母对，表示为2元列向量 $\\vec{p}$。每个明文向量随后通过矩阵-向量乘积 $\\vec{c} = K \\vec{p}$，使用一个秘密的 $2 \\times 2$ 矩阵 $K$ 加密成一个密文向量 $\\vec{c}$。生成的向量通过一个有噪声的信道传输。\n\n分析员截获了三对明文-密文对。由于噪声，接收到的向量（记为 $\\vec{c'}_i$）与原始的 $\\vec{c}_i$ 并不相同。然而，已知原始密钥矩阵 $K$ 的元素均为整数。截获的明文向量和相应的带噪声的接收密文向量如下：\n\n明文向量：\n$$ \\vec{p}_1 = \\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix}, \\quad \\vec{p}_2 = \\begin{pmatrix} 0 \\\\ 19 \\end{pmatrix}, \\quad \\vec{p}_3 = \\begin{pmatrix} 14 \\\\ 13 \\end{pmatrix} $$\n\n带噪声的接收密文向量：\n$$ \\vec{c'}_1 = \\begin{pmatrix} 61.3 \\\\ 22.8 \\end{pmatrix}, \\quad \\vec{c'}_2 = \\begin{pmatrix} 94.5 \\\\ 38.1 \\end{pmatrix}, \\quad \\vec{c'}_3 = \\begin{pmatrix} 107.1 \\\\ 40.4 \\end{pmatrix} $$\n\n你的任务是确定最可能的加密矩阵 $K$。为此，你首先需要找到一个实值 $2 \\times 2$ 矩阵，我们称之为 $K_{ls}$，它在最小二乘意义上最能拟合数据。这意味着要找到矩阵 $K_{ls}$，使得误差向量的欧几里得范数平方和 $\\sum_{i=1}^{3} \\|\\vec{c'}_i - K_{ls} \\vec{p}_i\\|^2$ 最小。然后，通过将 $K_{ls}$ 的每个元素四舍五入到最近的整数，来找到所求的整数矩阵 $K$。\n\n将最终的整数矩阵 $K = \\begin{pmatrix} k_{11}  k_{12} \\\\ k_{21}  k_{22} \\end{pmatrix}$ 的四个元素以单行矩阵的形式 $\\begin{pmatrix} k_{11}  k_{12}  k_{21}  k_{22} \\end{pmatrix}$ 给出。", "solution": "我们将数据以矩阵形式建模。设 $P \\in \\mathbb{R}^{2 \\times 3}$ 的列为 $\\vec{p}_{1},\\vec{p}_{2},\\vec{p}_{3}$，设 $C' \\in \\mathbb{R}^{2 \\times 3}$ 的列为 $\\vec{c'}_{1},\\vec{c'}_{2},\\vec{c'}_{3}$。最小二乘估计 $K_{ls}$ 使得弗罗贝尼乌斯范数 $\\|C' - K_{ls}P\\|_{F}^{2}$ 最小化。这个线性最小二乘问题的正规方程是\n$$\nK_{ls}PP^{T} = C'P^{T},\n$$\n因此，如果 $PP^{T}$ 是可逆的，\n$$\nK_{ls} = C'P^{T}(PP^{T})^{-1}.\n$$\n构造矩阵\n$$\nP = \\begin{pmatrix} 7  0  14 \\\\ 8  19  13 \\end{pmatrix}, \\quad\nC' = \\begin{pmatrix} 61.3  94.5  107.1 \\\\ 22.8  38.1  40.4 \\end{pmatrix}.\n$$\n计算\n$$\nPP^{T} = \\sum_{i=1}^{3} \\vec{p}_{i}\\vec{p}_{i}^{T}\n= \\begin{pmatrix} 245  238 \\\\ 238  594 \\end{pmatrix},\n$$\n其行列式为\n$$\n\\det(PP^{T}) = 245 \\cdot 594 - 238 \\cdot 238 = 88886 \\neq 0,\n$$\n所以\n$$\n(PP^{T})^{-1} = \\frac{1}{88886}\\begin{pmatrix} 594  -238 \\\\ -238  245 \\end{pmatrix}.\n$$\n接下来，\n$$\nC'P^{T} = \\sum_{i=1}^{3} \\vec{c'}_{i}\\vec{p}_{i}^{T}\n= \\begin{pmatrix} 1928.5  3678.2 \\\\ 725.2  1431.5 \\end{pmatrix}.\n$$\n因此\n$$\nK_{ls} = \\left(\\begin{pmatrix} 1928.5  3678.2 \\\\ 725.2  1431.5 \\end{pmatrix}\n\\begin{pmatrix} 594  -238 \\\\ -238  245 \\end{pmatrix}\\right)\\frac{1}{88886}.\n$$\n计算分子乘积：\n$$\n\\begin{pmatrix}\n1928.5 \\cdot 594 + 3678.2 \\cdot (-238)  1928.5 \\cdot (-238) + 3678.2 \\cdot 245 \\\\\n725.2 \\cdot 594 + 1431.5 \\cdot (-238)  725.2 \\cdot (-238) + 1431.5 \\cdot 245\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n270217.9  442176 \\\\\n90071.8  178119.9\n\\end{pmatrix}.\n$$\n所以\n$$\nK_{ls} = \\frac{1}{88886}\\begin{pmatrix}\n270217.9  442176 \\\\\n90071.8  178119.9\n\\end{pmatrix}\n\\approx\n\\begin{pmatrix}\n3.0401  4.9746 \\\\\n1.0133  2.0039\n\\end{pmatrix}.\n$$\n将每个元素四舍五入到最近的整数，得到最可能的整数密钥矩阵\n$$\nK = \\begin{pmatrix} 3  5 \\\\ 1  2 \\end{pmatrix}.\n$$\n作为一个快速的一致性检查，$K\\vec{p}_{1} = \\begin{pmatrix} 61 \\\\ 23 \\end{pmatrix}$，$K\\vec{p}_{2} = \\begin{pmatrix} 95 \\\\ 38 \\end{pmatrix}$，以及 $K\\vec{p}_{3} = \\begin{pmatrix} 107 \\\\ 40 \\end{pmatrix}$，这些值与接收到的 $\\vec{c'}_{i}$ 很接近，这与小噪声的预期相符。", "answer": "$$\\boxed{\\begin{pmatrix} 3  5  1  2 \\end{pmatrix}}$$", "id": "1348664"}]}