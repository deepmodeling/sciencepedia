## 引言
二次型是数学中一个基础而强大的概念，它出现在从物理学的[势能面](@entry_id:147441)到统计学的数据[方差](@entry_id:200758)等众多领域。然而，一个二次型的标准表达式常常包含[交叉](@entry_id:147634)项（如 $x_1x_2$），这使得其几何形状和代数性质难以直观分析。我们如何才能拨开这些交叉项的迷雾，揭示二次型最核心的结构呢？

本文旨在系统地介绍一种核心技术——[变量替换](@entry_id:141386)——来简化并理解二次型。通过巧妙地选择新的[坐标系](@entry_id:156346)，我们可以消除交叉项，将复杂的二次型表达式转化为只包含平方项的简洁形式。这种“[对角化](@entry_id:147016)”过程不仅极大地简化了计算，更揭示了二次型内在的几何与物理意义。

在接下来的内容中，我们将分三步深入探索这一主题。首先，在“原理与机制”一章中，我们将学习变量替换的代数基础，并重点介绍实现对角化的关键工具——[主轴定理](@entry_id:154703)。接着，在“应用与跨学科联系”一章中，我们将看到这一理论如何应用于几何、物理、统计学等不同领域，解决从识别[圆锥曲线](@entry_id:166587)到分析[系统稳定性](@entry_id:273248)等实际问题。最后，通过“动手实践”部分，你将有机会亲自运用这些知识来解决具体问题，巩固所学。

## 原理与机制

在上一章中，我们介绍了二次型的基本概念及其在[多变量函数](@entry_id:145643)近似、物理学和工程学中的核心作用。一个二次型在其标准[坐标系](@entry_id:156346)下的表达式可能包含多个变量的交叉项，这使得分析其性质（如[正定性](@entry_id:149643)）和几何形态变得复杂。本章将深入探讨一个强有力的工具——**[变量替换](@entry_id:141386)（change of variables）**——它能够简化二次型的表达式，揭示其内在的几何与[代数结构](@entry_id:137052)。我们的核心目标是找到一种[坐标变换](@entry_id:172727)，将二次型化为最简洁的形式，即只包含平方项的“对角”形式。

### 二次型及其[变量替换](@entry_id:141386)

一个在 $\mathbb{R}^n$ 上的二次型 $q(\mathbf{x})$ 是一个关于向量 $\mathbf{x} = \begin{pmatrix} x_1,  x_2,  \dots,  x_n \end{pmatrix}^T$ 的二次[齐次多项式](@entry_id:178156)。任何二次型都可以唯一地表示为矩阵形式 $q(\mathbf{x}) = \mathbf{x}^T A \mathbf{x}$，其中 $A$ 是一个 $n \times n$ 的[对称矩阵](@entry_id:143130)。

[变量替换](@entry_id:141386)的本质是引入一组新坐标 $\mathbf{y} = \begin{pmatrix} y_1,  y_2,  \dots,  y_n \end{pmatrix}^T$，它们与旧坐标 $\mathbf{x}$ 通过一个可逆的[线性变换](@entry_id:149133)相关联。这个变换通常写作 $\mathbf{x} = P\mathbf{y}$，其中 $P$ 是一个可逆的 $n \times n$ 矩阵，称为**变换矩阵 (change-of-basis matrix)**。

将 $\mathbf{x} = P\mathbf{y}$ 代入[二次型的矩阵](@entry_id:151206)表达式，我们得到新的二次型 $q'(\mathbf{y})$：

$q(\mathbf{x}) = (P\mathbf{y})^T A (P\mathbf{y}) = \mathbf{y}^T P^T A P \mathbf{y}$

因此，在新的 $\mathbf{y}$ [坐标系](@entry_id:156346)下，二次型 $q'(\mathbf{y})$ 对应的矩阵是 $A' = P^T A P$。矩阵 $A$ 和 $A'$ 通过这种关系联系起来，我们称它们是**合同 (congruent)** 的。

**示例：直接代换**

考虑一个三维空间中的二次型 [@problem_id:1352160]：
$q(\mathbf{x}) = 2x_1^2 + 5x_2^2 + 3x_3^2 + 4x_1x_2 - 2x_1x_3 + 8x_2x_3$

如果我们引入一组新变量 $\mathbf{y}$，其关系如下：
$x_1 = y_1 - y_3$
$x_2 = y_1 + y_2$
$x_3 = 2y_2 + y_3$

我们可以通过直接代数替换来找到新二次型 $q'(\mathbf{y})$ 的表达式。例如，将 $x_1$ 的表达式代入 $2x_1^2$ 得到 $2(y_1 - y_3)^2 = 2y_1^2 - 4y_1y_3 + 2y_3^2$。对所有项进行类似的展开和合并，过程虽然直接但相当繁琐，最终得到：
$q'(\mathbf{y}) = 11y_1^2 + 33y_2^2 + 7y_3^2 + 26y_1y_2 - 2y_1y_3 + 20y_2y_3$

这种代数方法直观地展示了[变量替换](@entry_id:141386)的效果，但也凸显了其计算的复杂性。更系统的方法是使用[矩阵变换](@entry_id:156789)。在上述例子中，变换矩阵 $P$ 为：
$P = \begin{pmatrix} 1  0  -1 \\ 1  1  0 \\ 0  2  1 \end{pmatrix}$

原[二次型的矩阵](@entry_id:151206) $A$ 为：
$A = \begin{pmatrix} 2  2  -1 \\ 2  5  4 \\ -1  4  3 \end{pmatrix}$

通过计算 $A' = P^T A P$，可以得到与直接代换结果一致的新二次型矩阵。例如，在机器学习的一个图像识别模型中，纹理特征的“能量”可以用二次型 $q(x_1, x_2) = 3x_1^2 + 4x_1x_2 - x_2^2$ 来描述 [@problem_id:1352149]。其矩阵形式为 $A = \begin{pmatrix} 3  2 \\ 2  -1 \end{pmatrix}$。若进行[坐标变换](@entry_id:172727) $\mathbf{x} = P\mathbf{y}$，其中 $P = \begin{pmatrix} 2  -1 \\ 1  3 \end{pmatrix}$，那么新[坐标系](@entry_id:156346)下的能量函数矩阵将是 $A' = P^T A P = \begin{pmatrix} 19  1 \\ 1  -18 \end{pmatrix}$。

### [主轴定理](@entry_id:154703)：通过正交变换实现[对角化](@entry_id:147016)

一般而言，[变量替换](@entry_id:141386)后的新矩阵 $A' = P^T A P$ 仍然可能包含非对角项，这意味着新二次型中仍存在交叉项。一个自然的问题是：我们能否找到一个特殊的变换矩阵 $P$，使得新矩阵 $A'$ 是一个**[对角矩阵](@entry_id:637782)**？如果可以，那么新的二次型将只包含平方项，形式极为简洁：$q'(\mathbf{y}) = d_1 y_1^2 + d_2 y_2^2 + \dots + d_n y_n^2$。

答案是肯定的，这正是线性代数中一个至关重要的定理——**[主轴定理](@entry_id:154703) (Principal Axis Theorem)** 的内容。

**[主轴定理](@entry_id:154703)**：对于任意一个 $n \times n$ 的[实对称矩阵](@entry_id:192806) $A$，存在一个**[正交矩阵](@entry_id:169220)** $P$ (即 $P^T P = I$，或等价地 $P^T = P^{-1}$)，使得 $P^T A P = D$ 是一个[对角矩阵](@entry_id:637782)。该[对角矩阵](@entry_id:637782) $D$ 的对角元是矩阵 $A$ 的**[特征值](@entry_id:154894) (eigenvalues)**，而 $P$ 的列向量是 $A$ 对应的**标准[正交特征向量](@entry_id:155522) (orthonormal eigenvectors)**。

这个定理的意义是双重的。首先，它保证了任何二次型都可以通过一个**正交变换** (即保持长度和角度的变换，如[旋转和反射](@entry_id:136876)) 来消除交叉项。其次，它指明了如何构造这个变换：我们只需要求解矩阵 $A$ 的[特征值](@entry_id:154894)和[特征向量](@entry_id:151813)。

**应用：寻找系统的[简正模](@entry_id:139640)**

在物理学中，多自由度系统的势能函数在[平衡点](@entry_id:272705)附近通常可以近似为一个二次型 $U(\mathbf{x}) = \mathbf{x}^T A \mathbf{x}$ [@problem_id:1352138]。交叉项的存在意味着系统中不同部分的运动是耦合的。通过找到一个正交变换 $\mathbf{x} = P\mathbf{y}$ 来对角化矩阵 $A$，我们可以将[势能函数](@entry_id:200753)解耦为 $U(\mathbf{y}) = \lambda_1 y_1^2 + \lambda_2 y_2^2 + \dots + \lambda_n y_n^2$。新的坐标 $y_i$ 称为系统的**[简正坐标](@entry_id:143194) (normal coordinates)**，它们描述了系统独立的[振动](@entry_id:267781)模式，即**简正模 (normal modes)**。新二次型的系数 $\lambda_i$ 正是原系统矩阵 $A$ 的[特征值](@entry_id:154894)。

例如，对于一个[势能矩阵](@entry_id:178016)为 $A = \begin{pmatrix} 5  -2  -2 \\ -2  2  -4 \\ -2  -4  2 \end{pmatrix}$ 的系统，我们可以通过计算其特征方程 $\det(A - \lambda I) = 0$ 来找到[特征值](@entry_id:154894)。计算可得[特征值](@entry_id:154894)为 $\lambda = 6, 6, -3$。因此，在[简正坐标](@entry_id:143194)系下，势能函数简化为 $U(\mathbf{y}) = 6y_1^2 + 6y_2^2 - 3y_3^2$ [@problem_id:1352138]。

**构造变换矩阵 P**

[主轴定理](@entry_id:154703)的实施步骤如下：
1.  写出二次型 $q(\mathbf{x})$ 对应的对称矩阵 $A$。
2.  计算 $A$ 的所有[特征值](@entry_id:154894) $\lambda_1, \lambda_2, \dots, \lambda_n$。
3.  为每个[特征值](@entry_id:154894)找到对应的[特征向量](@entry_id:151813)。对于重根[特征值](@entry_id:154894)，找到一组线性无关的[特征向量](@entry_id:151813)。
4.  使用格拉姆-施密特（Gram-Schmidt）过程将每个特征[子空间的基](@entry_id:160685)[标准正交化](@entry_id:140791)，得到一组标准正交的[特征向量](@entry_id:151813) $\{\mathbf{u}_1, \mathbf{u}_2, \dots, \mathbf{u}_n\}$。
5.  构造[正交矩阵](@entry_id:169220) $P = \begin{pmatrix} \mathbf{u}_1  \mathbf{u}_2  \dots  \mathbf{u}_n \end{pmatrix}$。

通过这个变换 $\mathbf{x} = P\mathbf{y}$，二次型就化为[对角形式](@entry_id:264850) $q'(\mathbf{y}) = \sum_{i=1}^n \lambda_i y_i^2$。

例如，对于二次型 $q(x_1, x_2) = x_1^2 + 6x_1x_2 + x_2^2$ [@problem_id:1352097]，其矩阵为 $A = \begin{pmatrix} 1  3 \\ 3  1 \end{pmatrix}$。[特征值](@entry_id:154894)为 $\lambda_1=4, \lambda_2=-2$。对应的标准[正交特征向量](@entry_id:155522)（在满足特定约束条件下）为 $\mathbf{u}_1 = \frac{1}{\sqrt{2}}\begin{pmatrix} 1 \\ 1 \end{pmatrix}$ 和 $\mathbf{u}_2 = \frac{1}{\sqrt{2}}\begin{pmatrix} -1 \\ 1 \end{pmatrix}$。因此，[变换矩阵](@entry_id:151616) $P = \frac{1}{\sqrt{2}}\begin{pmatrix} 1  -1 \\ 1  1 \end{pmatrix}$ 可以将该二次型化为 $q'(\mathbf{y}) = 4y_1^2 - 2y_2^2$。

### 主轴的几何解释

[主轴定理](@entry_id:154703)的名称来源于其深刻的几何意义。一个二次型的[等值面](@entry_id:196027)（level sets），即满足 $q(\mathbf{x}) = c$（$c$ 为常数）的所有点 $\mathbf{x}$ 的集合，在二维空间中是圆锥曲线（椭圆、[双曲线](@entry_id:174213)），在三维空间中是二次曲面（椭球面、双曲面等）。

这些几何图形通常是“倾斜”的，它们的对称轴并不与标准坐标轴 $x_1, x_2, \dots$ 对齐。**[主轴定理](@entry_id:154703)告诉我们，二次型矩阵 $A$ 的标准[正交特征向量](@entry_id:155522)恰好指向这些几何图形的[对称轴](@entry_id:177299)方向，这些方向被称为[主轴](@entry_id:172691) (principal axes)。**

因此，正交变换 $\mathbf{x} = P\mathbf{y}$ 的几何意义是：对[坐标系](@entry_id:156346)进行一次刚体旋转（可能加上反射），使新的坐标轴 $y_1, y_2, \dots$ 与[二次曲面的主轴](@entry_id:173828)对齐。在这个新的、与图形“自然”对齐的[坐标系](@entry_id:156346)中，二次型的方程不含[交叉](@entry_id:147634)项，其几何形态一目了然。

例如，在一个二维晶体模型中，弹性势能密度由二次型 $q(x, y) = 8x^2 + 6xy + 2y^2$ 给出 [@problem_id:1352101]。等[势能](@entry_id:748988)线 $q(x,y)=c$ 是一系列旋转的椭圆。这些椭圆的对称轴（[主轴](@entry_id:172691)）方向，正是其矩阵 $A = \begin{pmatrix} 8  3 \\ 3  2 \end{pmatrix}$ 的[特征向量](@entry_id:151813)方向。通过求解[特征向量](@entry_id:151813)，我们发现[主轴](@entry_id:172691)方向由向量 $\begin{pmatrix} 1 \\ \sqrt{2}-1 \end{pmatrix}$ 和 $\begin{pmatrix} 1-\sqrt{2} \\ 1 \end{pmatrix}$ 张成。

同样，对于一个[势能面](@entry_id:147441)为 $U(x, y) = 5x^2 - 4xy + 8y^2$ 的力学系统，其[主轴](@entry_id:172691)方向由矩阵 $A = \begin{pmatrix} 5  -2 \\ -2  8 \end{pmatrix}$ 的标准[正交特征向量](@entry_id:155522)给出，即 $\{\frac{1}{\sqrt{5}}\begin{pmatrix} 2 \\ 1 \end{pmatrix}, \frac{1}{\sqrt{5}}\begin{pmatrix} 1 \\ -2 \end{pmatrix}\}$ [@problem_id:1352136]。这个基定义了[简正坐标](@entry_id:143194)系的方向。

### 变量变换下的[不变量](@entry_id:148850)

虽然变量替换改变了二次型的表达式，但其某些基本属性在变换下保持不变，这些属性称为**[不变量](@entry_id:148850) (invariants)**。

#### 正交变换下的[不变量](@entry_id:148850)

当变换是正交的（$\mathbf{x}=P\mathbf{y}$，$P$为[正交矩阵](@entry_id:169220)）时，新旧矩阵的关系是 $A' = P^T A P = P^{-1} A P$。这是一种**相似变换 (similarity transformation)**。[相似变换](@entry_id:152935)保持矩阵的许多性质不变，包括：
- **迹 (Trace)**：$\operatorname{tr}(A') = \operatorname{tr}(P^T A P) = \operatorname{tr}(A P P^T) = \operatorname{tr}(A)$。例如，对于一个二次型 $V(x_1, x_2) = 5x_1^2 + 8x_2^2 - 4x_1x_2$，其矩阵 $A = \begin{pmatrix} 5  -2 \\ -2  8 \end{pmatrix}$ 的迹为 $13$。在任意[正交变换](@entry_id:155650)后，新矩阵 $B$ 的迹仍然是 $13$ [@problem_id:1352130]。
- **[行列式](@entry_id:142978) (Determinant)**：$\det(A') = \det(P^T A P) = \det(P^T)\det(A)\det(P) = \det(A)$。
- **[特征值](@entry_id:154894) (Eigenvalues)**：$A'$ 和 $A$ 有完全相同的[特征值](@entry_id:154894)。这与[主轴定理](@entry_id:154703)一致，即[对角化](@entry_id:147016)后的系数就是原始矩阵的[特征值](@entry_id:154894)。

#### 一般可逆变换下的[不变量](@entry_id:148850)：西尔维斯特惯性律

当变换矩阵 $P$ 仅为可逆矩阵（不一定是[正交矩阵](@entry_id:169220)）时，变换 $A \to P^T A P$ 是一个**[合同变换](@entry_id:154837) (congruence transformation)**。在这种更一般的变换下，迹、[行列式](@entry_id:142978)和[特征值](@entry_id:154894)通常会改变。然而，一个更深刻的[不变量](@entry_id:148850)被保留下来，这由**西尔维斯特惯性律 (Sylvester's Law of Inertia)** 描述。

**西尔维斯特惯性律**：对于任意一个实二次型，无论通过何种[可逆线性变换](@entry_id:149915)将其对角化，得到的[对角形式](@entry_id:264850)中正系数的个数、负系数的个数以及零系数的个数都是唯一的。

这个由正、负、零系数个数组成的数组 $(p, n, z)$ 被称为二次型的**符号差 (signature)**。它是二次型在[合同变换](@entry_id:154837)下的一个基本[不变量](@entry_id:148850)。

这个定律的一个直接推论是，二次型的**定性 (definiteness)** 在任何[可逆线性变换](@entry_id:149915)下保持不变。例如，一个正定二次型（所有[特征值](@entry_id:154894)/[对角化](@entry_id:147016)系数均为正）在变换后仍然是正定的 [@problem_id:1352103]。这是因为变换不改变正系数的个数（$p=n, n=0, z=0$）。

例如，二次型 $q(x_1, x_2, x_3) = x_1 x_2 + x_2 x_3$ 是一个不定的二次型。我们可以用多种不同的非正交变换将其[对角化](@entry_id:147016)。例如，一种方法得到[对角形式](@entry_id:264850) $\frac{1}{4}z_1^2 - \frac{1}{4}z_2^2 + 0 \cdot z_3^2$，另一种方法得到 $\frac{1}{4}u_1^2 - \frac{1}{4}u_2^2 + 0 \cdot u_3^2$。尽管变换过程和新变量都不同，但最终的[对角形式](@entry_id:264850)都包含一个正系数、一个负系数和一个零系数。因此，该[二次型的符号差](@entry_id:150525)是 $(1, 1, 1)$，这是一个不依赖于[对角化方法](@entry_id:273007)的[内禀性质](@entry_id:273674) [@problem_id:1352094]。

### 高等主题与应用

#### [同时对角化](@entry_id:196036)与[广义特征值问题](@entry_id:151614)

一个自然的问题是：我们能否找到一个单一的变换，同时将两个不同的二次型 $Q_A(\mathbf{x}) = \mathbf{x}^T A \mathbf{x}$ 和 $Q_B(\mathbf{x}) = \mathbf{x}^T B \mathbf{x}$ 对角化？

在一般情况下这是不可能的。然而，如果矩阵 $A$ 和 $B$ **可交换 (commute)**，即 $AB = BA$，那么存在一个**正交**矩阵 $P$ 可以[同时对角化](@entry_id:196036) $A$ 和 $B$。

一个更普遍且在应用中常见的问题是寻找函数比率 $R(\mathbf{x}) = \frac{Q_A(\mathbf{x})}{Q_B(\mathbf{x})}$ 的[极值](@entry_id:145933)，其中 $Q_B$ 是正定的。这个问题等价于求解**[广义特征值问题](@entry_id:151614) (generalized eigenvalue problem)**：寻找标量 $\lambda$ 和非零向量 $\mathbf{v}$ 使得 $A\mathbf{v} = \lambda B\mathbf{v}$。这个比率 $R(\mathbf{x})$ 的最大值和最小值就是广义[特征值](@entry_id:154894)中的最大和最小值 [@problem_id:1352145]。

#### 构造性方法：雅可比旋转

[主轴定理](@entry_id:154703)虽然强大，但直接求解高阶[多项式的根](@entry_id:154615)（[特征值](@entry_id:154894)）在数值计算上可能很困难。**[雅可比旋转法](@entry_id:145350) (Jacobi Rotation Method)** 提供了一种迭代构造[正交矩阵](@entry_id:169220) $P$ 的方法。

其核心思想是通过一系列简单的**平面旋转 (planar rotations)** 来逐步消去非对角元。在每一步中，选择一个当前[绝对值](@entry_id:147688)最大的非对角元 $a_{ij}$，然后构造一个仅在第 $i$ 和第 $j$ 维空间中作用的[旋转矩阵](@entry_id:140302) $R_{ij}(\theta)$，使得在新矩阵 $A' = R_{ij}^T A R_{ij}$ 中，对应的 $a'_{ij}$ 和 $a'_{ji}$ 元素变为零。

例如，要消除二次型矩阵 $A = \begin{pmatrix} 3  2  4 \\ 2  0  3 \\ 4  3  1 \end{pmatrix}$ 中的 $a_{13}$ 项，我们可以应用一个在 $x_1-x_3$ 平面上的旋转 [@problem_id:1352152]。通过计算，可以发现使新矩阵 $a'_{13}$ 为零的旋转角 $\theta$ 满足 $\tan(2\theta) = 4$。最小的正角度解为 $\theta = \frac{1}{2}\arctan(4)$。

通过反复应用这种平面旋转，矩阵的非对角元会趋向于零，最终得到的[矩阵近似](@entry_id:149640)为[对角矩阵](@entry_id:637782)。所有[旋转矩阵](@entry_id:140302)的乘积就给出了近似的正交变换矩阵 $P$。这种方法在[数值线性代数](@entry_id:144418)中具有重要地位。