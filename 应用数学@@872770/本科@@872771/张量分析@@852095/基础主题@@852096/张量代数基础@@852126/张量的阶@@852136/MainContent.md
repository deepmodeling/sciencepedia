## 引言
在[多维数据](@entry_id:189051)和物理[系统分析](@entry_id:263805)中，张量提供了一种强大的语言。然而，要真正掌握这种语言，就必须理解其核心语法之一：**[张量秩](@entry_id:266558) (tensor rank)**。与线性代数中直观的[矩阵秩](@entry_id:153017)不同，[张量秩](@entry_id:266558)是一个更深刻、更复杂且充满挑战的概念。它不仅是衡量张量内在复杂度的标尺，更是连接从量子物理到数据科学等多个看似无关领域的桥梁。

本文旨在系统性地揭开[张量秩](@entry_id:266558)的神秘面纱。我们将直面其与[矩阵秩](@entry_id:153017)的根本区别，并阐明为何[高阶张量](@entry_id:200122)的行为常常违反我们在二维世界中建立的直觉。本文将填补从基础张量运算到高级应用的知识鸿沟，为读者构建一个关于[张量秩](@entry_id:266558)的完整知识框架。

在接下来的内容中，读者将首先在 **“原理与机制”** 一章中，深入学习[张量秩](@entry_id:266558)的严格定义、基本性质以及分析其特性的实用工具（如[矩阵化](@entry_id:751739)）。随后，在 **“应用与跨学科联系”** 一章中，我们将穿越物理学、数据科学和[计算理论](@entry_id:273524)等领域，见证[张量秩](@entry_id:266558)如何作为一种通用语言，描述从[量子纠缠](@entry_id:136576)到[算法复杂度](@entry_id:137716)的各种现象。最后，通过 **“动手实践”** 部分，您将有机会将理论应用于具体计算，从而巩固对这一核心概念的理解。

## 原理与机制

在上一章对张量进行了初步介绍后，本章将深入探讨张量理论中一个核心且富有挑战性的概念：**[张量秩](@entry_id:266558) (tensor rank)**。与我们在线性代数中熟悉的[矩阵秩](@entry_id:153017)不同，[张量秩](@entry_id:266558)的性质更为复杂和微妙，它不仅是衡量张量“复杂度”的关键指标，也在信号处理、数据科学、量子物理和[计算复杂性理论](@entry_id:272163)等领域扮演着至关重要的角色。本章将系统地阐述[张量秩](@entry_id:266558)的定义、基本性质、其与相关概念的区别，并探讨其在不同阶数和标量域下的行为，最后介绍一些用于分析和估算[张量秩](@entry_id:266558)的实用工具。

### [张量秩](@entry_id:266558)的核心定义

我们从最基本的构成单元开始。一个**1阶张量 (rank-1 tensor)**，也称为**简单张量 (simple tensor)** 或**纯张量 (pure tensor)**，是指可以表示为多个向量[外积形式](@entry_id:190072)的张量。对于一个 $p$ 阶张量空间 $V_1 \otimes V_2 \otimes \dots \otimes V_p$，一个1阶张量 $T$ 可以写成：

$$
T = v_1 \otimes v_2 \otimes \dots \otimes v_p
$$

其中每个向量 $v_i$ 分别属于其对应的[向量空间](@entry_id:151108) $V_i$。1阶张量在某种意义上是张量空间中最简单的“原子”元素。

基于此，任意张量 $T$ 的**秩**，记作 $\text{rank}(T)$，被定义为能够将 $T$ 表示为1阶张量之和所需的最小项数 $R$。换言之，如果一个张量 $T$ 可以写作：

$$
T = \sum_{i=1}^{R} S_i
$$

其中每个 $S_i$ 都是1阶张量，并且 $R$ 是满足此表达式的最小正整数，那么我们就说 $T$ 的秩为 $R$。这种分解被称为**典范多线性分解 (Canonical Polyadic Decomposition, [CP分解](@entry_id:203488))** 或外积分解。

这个定义引出了一些直接的推论。例如，考虑在任何张量空间中作为加法单位元的**零张量 (zero tensor)** $\mathbf{0}$。它的秩是什么？根据定义，我们需要找到表示 $\mathbf{0}$ 所需的最少1阶张量项数。在数学中，一个[空集](@entry_id:261946)求和（即 $R=0$）被定义为加法单位元，即零。因此，我们可以将零张量写成0个1阶张量的和：

$$
\mathbf{0} = \sum_{i=1}^{0} S_i
$$

由于秩必须是最小的项数，而负数项没有意义，所以零张量的秩就是 $0$ [@problem_id:1535348]。

另一个基本性质涉及[标量乘法](@entry_id:155971)。如果我们有一个秩为 $r$ 的非零张量 $T$，并用一个非零标量 $\alpha$ 去缩放它，得到新张量 $T' = \alpha T$，那么 $T'$ 的秩是多少？由于 $T$ 的秩为 $r$，它可以被写成 $r$ 个1阶张量的和：
$$
T = \sum_{k=1}^{r} \mathbf{v}_{1}^{(k)} \otimes \dots \otimes \mathbf{v}_{n}^{(k)}
$$
那么 $T'$ 可以写作：
$$
T' = \alpha T = \sum_{k=1}^{r} \alpha (\mathbf{v}_{1}^{(k)} \otimes \dots \otimes \mathbf{v}_{n}^{(k)})
$$
由于[标量乘法](@entry_id:155971)可以被吸收到任意一个向量因子中，例如 $\alpha (\mathbf{v}_{1}^{(k)} \otimes \dots) = (\alpha \mathbf{v}_{1}^{(k)}) \otimes \dots$，每一项 $\alpha S_k$ 仍然是一个1阶张量。这意味着 $T'$ 可以表示为 $r$ 个1阶张量的和，因此 $\text{rank}(T') \le r$。反之，我们也可以从 $T'$ 的分解出发，通过乘以 $\alpha^{-1}$ 来构造 $T$ 的分解，这表明 $\text{rank}(T) \le \text{rank}(T')$。综合来看，只要 $\alpha \neq 0$，[标量乘法](@entry_id:155971)不改变张量的秩 [@problem_id:1535329]。

### 辨析：张量阶、[矩阵秩](@entry_id:153017)与[张量秩](@entry_id:266558)

初学者常常混淆三个概念：张量的**阶 (order)**，张量分量矩阵的**[矩阵秩](@entry_id:153017) (matrix rank)**，以及张量本身的**[张量秩](@entry_id:266558) (tensor rank)**。厘清它们的区别至关重要。

- **张量的阶** (在物理学和工程学中也常被称为“rank”)，指的是描述张量任意一个分量所需的索引数量。例如，$T_{ijk}$ 是一个3阶张量，$M_{ij}$ 是一个[2阶张量](@entry_id:187697)。

- **[矩阵秩](@entry_id:153017)**是线性代数中的概念，指一个矩阵的列向量（或行向量）所构成的[向量空间](@entry_id:151108)维数。

- **[张量秩](@entry_id:266558)**如前文所定义，是表示张量所需的最少1阶张量数量。

对于[2阶张量](@entry_id:187697)，这三个概念的关系相对简单，但也足以说明问题。一个[2阶张量](@entry_id:187697) $T$ 在特定基底下可以用一个矩阵 $[T]$ 来表示其分量 $T_{ij}$。在这种情况下，该张量的**[张量秩](@entry_id:266558)**恰好等于其分量矩阵的**[矩阵秩](@entry_id:153017)**。然而，张量的**阶**（此处为2）与秩通常是不同的。

让我们通过一个例子来具体说明。考虑两个[2阶张量](@entry_id:187697) $T$ 和 $S$，它们在某个三维空间标准基下的分量矩阵分别为 [@problem_id:1535344]：
$$
T_{ij} = \begin{pmatrix} \alpha & 2\alpha & 0 \\ 2\alpha & 4\alpha & 0 \\ 0 & 0 & \beta \end{pmatrix}, \quad S_{ij} = \begin{pmatrix} \gamma & 0 & \gamma \\ 0 & \gamma & 0 \\ -\gamma & 0 & \gamma \end{pmatrix}
$$
其中 $\alpha, \beta, \gamma$ 是非零常数。首先，由于它们的分量需要两个索引（$i$ 和 $j$）来指定，所以 $T$ 和 $S$ 都是**2阶**张量。

接下来，我们分析它们分量[矩阵的秩](@entry_id:155507)。对于矩阵 $T_{ij}$，第二列是第一列的两倍，因此它们线性相关。第三列与前两列线性无关。所以，矩阵 $T_{ij}$ 的秩为2。对于矩阵 $S_{ij}$，我们可以计算其[行列式](@entry_id:142978) $\det(S_{ij}) = 2\gamma^3$。由于 $\gamma \neq 0$，[行列式](@entry_id:142978)非零，因此矩阵 $S_{ij}$ 的秩为3。

这个例子清楚地表明：
1. 张量的阶数是一个独立的属性，与秩无关。
2. 即使是相同阶数的张量，其秩也可以不同。

更进一步，[张量秩](@entry_id:266558)是一个**内蕴属性 (intrinsic property)**，它不依赖于我们选择的[坐标系](@entry_id:156346)（基底）。当我们对一个 (0,2) 型张量进行基底变换时，其分量矩阵会发生[合同变换](@entry_id:154837) (congruence transformation)：$[T'] = A^T [T] A$，其中 $A$ 是可逆的基底变换矩阵。在这种变换下，矩阵的行列式、迹、[特征值](@entry_id:154894)等通常会改变，但[矩阵的秩](@entry_id:155507)保持不变 [@problem_id:1535347]。这从根本上保证了[2阶张量](@entry_id:187697)的秩是一个不依赖于观察者[坐标系](@entry_id:156346)的物理或几何量。对于更高阶的张量，这个结论同样成立：[张量秩](@entry_id:266558)是基底变换下的[不变量](@entry_id:148850)。

### [二阶张量](@entry_id:199780)的秩：从矩阵到张量的桥梁

正如前述，二阶张量的秩等于其任意分量[矩阵的秩](@entry_id:155507)。这为我们从熟悉的矩阵理论过渡到更抽象的[张量秩](@entry_id:266558)概念提供了一座桥梁。我们可以通过一个构造性的例子来加深理解。

考虑一个由两个1阶张量相加构成的二阶张量 $S$：
$$
S = u_1 \otimes v_1 + u_2 \otimes v_2
$$
其中 $u_1, u_2, v_1, v_2$ 是非零向量。根据定义，这个张量的秩最多为2。那么，它的秩在什么条件下会是1，又在什么条件下严格等于2呢？

如果张量 $S$ 的秩为1，意味着它可以被写成单一外积 $u \otimes v$ 的形式。让我们探究这种情况何时发生。例如，如果向量集合 $\{u_1, u_2\}$ 是[线性相关](@entry_id:185830)的，即 $u_2 = \alpha u_1$ 对于某个标量 $\alpha$，那么：
$$
S = u_1 \otimes v_1 + (\alpha u_1) \otimes v_2 = u_1 \otimes (v_1 + \alpha v_2)
$$
令 $v = v_1 + \alpha v_2$，则 $S = u_1 \otimes v$，这是一个1阶张量。同理，如果 $\{v_1, v_2\}$ 集合是[线性相关](@entry_id:185830)的，我们也能得到相同的结果。

反之，如果张量 $S$ 的秩要严格为2，那么上述的“合并”过程就不能发生。这要求两个向量集合 $\{u_1, u_2\}$ 和 $\{v_1, v_2\}$ **都必须是线性无关的**。这个条件既是必要的也是充分的 [@problem_id:1535357]。这个例子直观地揭示了[张量秩](@entry_id:266558)的本质：它衡量了表示一个张量所需的“不可约”[外积](@entry_id:147029)组件的数量。

### [高阶张量](@entry_id:200122)秩的复杂性

当张量的阶数大于2时，[张量秩](@entry_id:266558)的许多美好性质便不复存在，其行为变得异常复杂和违反直觉。

#### 最大秩问题
对于 $m \times n$ 的矩阵（[2阶张量](@entry_id:187697)），我们知道其最大秩为 $\min(m, n)$。但对于[高阶张量](@entry_id:200122)，最大秩的计算是一个非常困难的开放问题。例如，考虑 $\mathbb{R}^2 \otimes \mathbb{R}^2 \otimes \mathbb{R}^2$ 空间中的张量，即 $2 \times 2 \times 2$ 的三阶张量。其维度为8。人们可能会猜测最大秩是2（最小维度）或4（例如 $\min(2, 2 \times 2)$）。然而，事实并非如此。该空间中的张量最大可能秩是 **3** [@problem_id:1535397]。这一经典结果说明，[高阶张量](@entry_id:200122)的秩可以超过其任何一个模态的维度，这与矩阵的情况截然不同。

#### 对标量域的依赖
矩阵的秩在[实数域](@entry_id:151347) $\mathbb{R}$ 和[复数域](@entry_id:153768) $\mathbb{C}$ 上是相同的。然而，[张量秩](@entry_id:266558)可能会因为标量域的改变而改变。也就是说，同一个张量，在实数域下分解所需的最小项数，可能比在[复数域](@entry_id:153768)下要多。

让我们构造一个例子。考虑一个由两片 $2 \times 2$ 矩阵 $M_1$ 和 $M_2$ 定义的三阶张量 $T \in \mathbb{R}^2 \otimes \mathbb{R}^2 \otimes \mathbb{R}^2$ [@problem_id:1535349]：
$$
M_1 = \begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix}, \quad M_2 = \begin{pmatrix} 0 & -1 \\ -1 & 0 \end{pmatrix}
$$
判断这个张量的秩，一个有效的方法是分析其“[矩阵束](@entry_id:751760)” (matrix pencil) $M_1 - \lambda M_2$ 的[行列式](@entry_id:142978)。如果[张量秩](@entry_id:266558)为 $r \le 2$，那么 $M_1$ 和 $M_2$ 必须是两个秩1矩阵的[线性组合](@entry_id:154743)，这意味着存在某个 $\lambda$ 使得 $M_1 - \lambda M_2$ 的秩为1（即其[行列式](@entry_id:142978)为0）。对于上述张量，我们计算：
$$
\det(M_1 - \lambda M_2) = \det\begin{pmatrix} 1 & \lambda \\ \lambda & -1 \end{pmatrix} = -1 - \lambda^2
$$
方程 $-1 - \lambda^2 = 0$ 在实数域 $\mathbb{R}$ 内无解，但在[复数域](@entry_id:153768) $\mathbb{C}$ 内有两个解 $\lambda = \pm i$。这意味着在实数域上，我们无法通过线性组合得到一个秩1矩阵，因此其秩不能为2（也显然不为1），根据最大秩为3的结论，其在 $\mathbb{R}$ 上的秩为3。但在[复数域](@entry_id:153768)上，我们可以找到两个复数 $\lambda$ 使得[矩阵束](@entry_id:751760)奇异，从而可以将[张量分解](@entry_id:173366)为两个复系数的1阶张量之和，其在 $\mathbb{C}$ 上的秩为2。这种现象的根源在于[张量分解](@entry_id:173366)问题本质上与解多元多项式[方程组](@entry_id:193238)相关，而[方程组](@entry_id:193238)的[解集](@entry_id:154326)会依赖于所考虑的数域。

### 分析[张量秩](@entry_id:266558)的实用工具：[矩阵化](@entry_id:751739)

由于直接计算[高阶张量](@entry_id:200122)的秩是一个NP-hard问题，在实践中我们通常依赖于一些可以有效计算的界限。**[矩阵化](@entry_id:751739) (Matricization)**，也称为**展开 (unfolding)** 或**扁平化 (flattening)**，是其中最强大的工具之一。[矩阵化](@entry_id:751739)操作将一个[高阶张量](@entry_id:200122)重新[排列](@entry_id:136432)为一个矩阵。

对于一个三阶张量 $\mathcal{T} \in \mathbb{R}^{I_1 \times I_2 \times I_3}$，有三种标准的[矩阵化](@entry_id:751739)方式，分别称为模-1，模-2和模-3展开，记作 $T_{(1)}$, $T_{(2)}$, $T_{(3)}$。
- **模-1展开** $T_{(1)} \in \mathbb{R}^{I_1 \times I_2 I_3}$：将张量的第1个索引作为矩阵的行索引，将第2和第3个索引的组合作为列索引。
- **模-2展开** $T_{(2)} \in \mathbb{R}^{I_2 \times I_1 I_3}$：将张量的第2个索引作为矩阵的行索引。
- **模-3展开** $T_{(3)} \in \mathbb{R}^{I_3 \times I_1 I_2}$：将张量的第3个索引作为矩阵的行索引。

例如，考虑一个由两个 $2 \times 2$ 切片定义的 $2 \times 2 \times 2$ 张量 $\mathcal{T}$ [@problem_id:1535340]：
$$
\mathcal{T}(:,:,1) = \begin{pmatrix} 1 & 2 \\ 2 & 4 \end{pmatrix}, \quad \mathcal{T}(:,:,2) = \begin{pmatrix} 1 & 1 \\ 1 & 1 \end{pmatrix}
$$
它的三个[矩阵化](@entry_id:751739)形式分别为 $2 \times 4$ 的矩阵：
$$
T_{(1)} = \begin{pmatrix} 1 & 2 & 1 & 1 \\ 2 & 4 & 1 & 1 \end{pmatrix}, \quad T_{(2)} = \begin{pmatrix} 1 & 1 & 2 & 1 \\ 2 & 1 & 4 & 1 \end{pmatrix}, \quad T_{(3)} = \begin{pmatrix} 1 & 2 & 2 & 4 \\ 1 & 1 & 1 & 1 \end{pmatrix}
$$
通过计算可以发现，这三个矩阵的秩都为2。

[矩阵化](@entry_id:751739)与[张量秩](@entry_id:266558)之间有一个基本而深刻的联系：**任何一个模态展开矩阵的秩，都是原始[张量秩](@entry_id:266558)的一个下界**。这是因为如果一个张量可以写成 $R$ 个1阶张量的和，那么它的任何一个[矩阵化](@entry_id:751739)形式都可以写成 $R$ 个秩1矩阵的和，因此[矩阵化](@entry_id:751739)后的秩必然小于等于 $R$。
$$
\text{rank}(T) \ge \max_k \{ \text{rank}(T_{(k)}) \}
$$
这些[矩阵的秩](@entry_id:155507)构成的元组 $(r_1, r_2, \dots, r_n)$ 被称为张量的**多线性秩 (multilinear rank)**。多线性秩可以通过奇异值分解（SVD）等标[准线性](@entry_id:637689)代数方法有效计算，从而为难以捉摸的[张量秩](@entry_id:266558)提供了一个实用的下界。

结合多线性秩和另一种称为**[塔克分解](@entry_id:182831) (Tucker decomposition)** 的[张量分解](@entry_id:173366)方法，我们可以得到关于[张量秩](@entry_id:266558)的一个更完整的界限。[塔克分解](@entry_id:182831)将[张量表示](@entry_id:180492)为一个[核心张量](@entry_id:747891)与一系列正交因子矩阵的乘积。这个分解表明，[张量秩](@entry_id:266558)的一个[上界](@entry_id:274738)是其[核心张量](@entry_id:747891)各维度之积。结合下界，我们有 [@problem_id:1535365]：
$$
\max(r_1, r_2, r_3) \le \text{rank}(T) \le r_1 r_2 r_3
$$
这个不等式是在[高维数据](@entry_id:138874)分析中连接理论与实践的重要桥梁。

### 前沿概念：边界秩

最后，我们介绍一个更为精妙的概念：**边界秩 (border rank)**。在某些情况下，一个[高秩张量](@entry_id:200122)可以被一系列低秩张量任意逼近。这个允许逼近的最低秩就被称为边界秩。

让我们通过一个简单的例子来理解这个概念。考虑计算两个一阶多项式 $A(z) = a_0 + a_1 z$ 和 $B(z) = b_0 + b_1 z$ 的乘积 $C(z) = c_0 + c_1 z + c_2 z^2$ 中，截断到一度项的系数 $c_0=a_0b_0$ 和 $c_1=a_0b_1 + a_1b_0$。直接计算需要3次乘法（$a_0b_0, a_0b_1, a_1b_0$），这意味着这个计算对应的[双线性映射](@entry_id:186502)[张量秩](@entry_id:266558)为3。

现在，考虑一个依赖于小参数 $\epsilon \neq 0$ 的[近似算法](@entry_id:139835) [@problem_id:1535354]：
1.  计算两个乘积：$p_1(\epsilon) = a_0 b_0$ 和 $p_2(\epsilon) = (a_0 + \epsilon a_1)(b_0 + \epsilon b_1)$。
2.  构造近似系数：$\tilde{c}_0(\epsilon) = p_1(\epsilon)$ 和 $\tilde{c}_1(\epsilon) = \frac{1}{\epsilon} ( p_2(\epsilon) - p_1(\epsilon) )$。

这个算法只用了2次乘法，因此它对应于一个秩为2的张量。让我们展开 $\tilde{c}_1(\epsilon)$：
$$
\tilde{c}_1(\epsilon) = \frac{1}{\epsilon} \left( (a_0b_0 + \epsilon a_0b_1 + \epsilon a_1b_0 + \epsilon^2 a_1b_1) - a_0b_0 \right) = (a_0b_1 + a_1b_0) + \epsilon a_1b_1
$$
我们发现，近似系数 $\tilde{c}_1(\epsilon)$ 等于真实系数 $c_1$ 加上一个误差项 $\epsilon a_1b_1$。当 $\epsilon \to 0$ 时，这个近似算法的结果收敛到精确结果。

这个例子揭示了一个深刻的现象：一个秩为3的张量，是某个秩为2的张量[序列的极限点](@entry_id:176598)。在这种情况下，我们说这个张量的**秩**是3，但其**边界秩**是2。

边界秩的概念在代数[复杂性理论](@entry_id:136411)中至关重要。例如，著名的[Strassen矩阵乘法](@entry_id:637469)算法，就是通过发现 $2 \times 2$ [矩阵乘法](@entry_id:156035)张量的一种巧妙分解，将乘法次数从8次降低到7次。更快的算法研究，在很大程度上就是寻找具有低边界秩的[张量分解](@entry_id:173366)，并将其转化为实际的近似或精确算法。这表明[张量秩](@entry_id:266558)不仅是一个静态的分类工具，其结构本身也蕴含着计算效率的秘密。