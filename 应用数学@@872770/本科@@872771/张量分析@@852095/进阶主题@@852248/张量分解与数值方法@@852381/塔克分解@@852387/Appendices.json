{"hands_on_practices": [{"introduction": "塔克分解的一个核心应用是处理大规模多维数据时的模型压缩。通过将一个大张量分解为一个较小的核心张量和几个因子矩阵，我们可以显著减少存储数据所需的参数数量。这个练习将通过一个具体案例，让您亲手计算并比较原始张量与分解后各部分所需的存储量，从而直观地感受塔克分解在数据压缩方面的强大能力 [@problem_id:1561886]。", "problem": "在机器学习中，张量分解用于压缩大型多维数据数组，例如视频流或来自传感器阵列的数据。一种常用的方法是 Tucker 分解。\n\n考虑一个尺寸为 $60 \\times 50 \\times 40$ 的三阶张量 $\\mathcal{X}$。我们希望使用 Tucker 分解来近似这个张量，该分解将 $\\mathcal{X}$ 表示为一个较小的核心张量 $\\mathcal{G}$ 和一组因子矩阵。它们之间的关系由 $\\mathcal{X} \\approx \\mathcal{G} \\times_1 A^{(1)} \\times_2 A^{(2)} \\times_3 A^{(3)}$ 给出，其中 $\\times_n$ 表示 n-模积。\n\n各分量的维度由原始张量的维度和所选分解的秩决定。对于我们的张量 $\\mathcal{X} \\in \\mathbb{R}^{60 \\times 50 \\times 40}$，我们选择的秩为 $(R_1, R_2, R_3) = (5, 4, 3)$。这意味着核心张量是 $\\mathcal{G} \\in \\mathbb{R}^{5 \\times 4 \\times 3}$，因子矩阵是 $A^{(1)} \\in \\mathbb{R}^{60 \\times 5}$，$A^{(2)} \\in \\mathbb{R}^{50 \\times 4}$ 和 $A^{(3)} \\in \\mathbb{R}^{40 \\times 3}$。\n\n计算存储此 Tucker 分解所需的参数总数，即核心张量 $\\mathcal{G}$ 和三个因子矩阵 $A^{(1)}$、$A^{(2)}$ 和 $A^{(3)}$ 中所有元素的总和。", "solution": "Tucker 分解存储了核心张量和因子矩阵的所有元素。参数数量是它们条目的总和，计算方式为它们各自维度的乘积。\n\n核心张量有\n$$\nN_{\\mathcal{G}} = R_{1} R_{2} R_{3} = 5 \\times 4 \\times 3 = 60\n$$\n个参数。\n\n因子矩阵有\n$$\nN_{A^{(1)}} = 60 \\times 5 = 300,\\quad N_{A^{(2)}} = 50 \\times 4 = 200,\\quad N_{A^{(3)}} = 40 \\times 3 = 120\n$$\n个参数。\n\n因此，总参数数量为\n$$\nN_{\\text{total}} = N_{\\mathcal{G}} + N_{A^{(1)}} + N_{A^{(2)}} + N_{A^{(3)}} = 60 + 300 + 200 + 120 = 680.\n$$", "answer": "$$\\boxed{680}$$", "id": "1561886"}, {"introduction": "理解了塔克分解的压缩优势后，下一个关键问题是：如何从压缩后的核心张量和因子矩阵中恢复出原始张量？这个练习将带您深入了解塔克分解的“合成”或“重构”过程。通过应用多线性乘法的基本公式，您将动手计算重构张量中的一个特定元素，从而揭开分解后数据恢复过程的神秘面纱 [@problem_id:1561851]。", "problem": "在张量分析中，Tucker 分解提供了一种将高阶张量表示为核心张量与沿每个模的一个矩阵相乘的方法。对于一个大小为 $I_1 \\times I_2 \\times I_3$ 的三阶张量 $\\mathcal{T}$，其分解由下式给出\n$$\n\\mathcal{T} \\approx \\mathcal{G} \\times_1 U^{(1)} \\times_2 U^{(2)} \\times_3 U^{(3)}\n$$\n其中 $\\mathcal{G}$ 是大小为 $J_1 \\times J_2 \\times J_3$ 的核心张量，$U^{(1)}$，$U^{(2)}$，$U^{(3)}$ 分别是大小为 $I_1 \\times J_1$，$I_2 \\times J_2$ 和 $I_3 \\times J_3$ 的因子矩阵。记号 $\\times_n$ 表示 n-模乘积。\n\n张量 $\\mathcal{T}$ 的一个元素 $t_{i_1 i_2 i_3}$ 可以用核心张量的元素 ($g_{j_1 j_2 j_3}$) 和因子矩阵的元素 ($u^{(n)}_{i_n j_n}$) 通过以下公式计算：\n$$\nt_{i_1 i_2 i_3} = \\sum_{j_1=1}^{J_1} \\sum_{j_2=1}^{J_2} \\sum_{j_3=1}^{J_3} g_{j_1 j_2 j_3} u^{(1)}_{i_1 j_1} u^{(2)}_{i_2 j_2} u^{(3)}_{i_3 j_3}\n$$\n\n考虑一个大小为 $2 \\times 3 \\times 2$ 的三阶张量 $\\mathcal{T}$，它是由一个大小为 $2 \\times 2 \\times 2$ 的核心张量 $\\mathcal{G}$ 和三个因子矩阵 $U^{(1)}$，$U^{(2)}$ 和 $U^{(3)}$ 重构而成的。\n\n核心张量 $\\mathcal{G}$ 由其正面切片 $\\mathcal{G}_{:,:,1}$ (其中 $j_3=1$) 和 $\\mathcal{G}_{:,:,2}$ (其中 $j_3=2$) 给出：\n$$\n\\mathcal{G}_{:,:,1} = \\begin{pmatrix} 1  2 \\\\ 0  -1 \\end{pmatrix}, \\quad \\mathcal{G}_{:,:,2} = \\begin{pmatrix} 3  0 \\\\ -2  1 \\end{pmatrix}\n$$\n\n因子矩阵如下：\n$$\nU^{(1)} = \\begin{pmatrix} 1  5 \\\\ 2  1 \\end{pmatrix} \\quad (\\text{大小为 } 2 \\times 2)\n$$\n$$\nU^{(2)} = \\begin{pmatrix} 1  0 \\\\ -1  2 \\\\ 3  1 \\end{pmatrix} \\quad (\\text{大小为 } 3 \\times 2)\n$$\n$$\nU^{(3)} = \\begin{pmatrix} 4  1 \\\\ 0  2 \\end{pmatrix} \\quad (\\text{大小为 } 2 \\times 2)\n$$\n\n利用所提供的信息，计算重构张量 $\\mathcal{T}$ 的元素 $t_{212}$ 的值。", "solution": "我们使用 Tucker 元素重构公式：\n$$\nt_{i_{1}i_{2}i_{3}}=\\sum_{j_{1}=1}^{J_{1}}\\sum_{j_{2}=1}^{J_{2}}\\sum_{j_{3}=1}^{J_{3}} g_{j_{1}j_{2}j_{3}}\\,u^{(1)}_{i_{1}j_{1}}\\,u^{(2)}_{i_{2}j_{2}}\\,u^{(3)}_{i_{3}j_{3}}.\n$$\n对于 $t_{212}$，我们设 $i_{1}=2$，$i_{2}=1$，$i_{3}=2$，且 $J_{1}=J_{2}=J_{3}=2$，得到\n$$\nt_{212}=\\sum_{j_{1}=1}^{2}\\sum_{j_{2}=1}^{2}\\sum_{j_{3}=1}^{2} g_{j_{1}j_{2}j_{3}}\\,u^{(1)}_{2j_{1}}\\,u^{(2)}_{1j_{2}}\\,u^{(3)}_{2j_{3}}.\n$$\n由给定的因子矩阵可知，\n$$\nu^{(1)}_{21}=2,\\quad u^{(1)}_{22}=1,\\quad u^{(2)}_{11}=1,\\quad u^{(2)}_{12}=0,\\quad u^{(3)}_{21}=0,\\quad u^{(3)}_{22}=2.\n$$\n因此，只有 $j_{2}=1$ 和 $j_{3}=2$ 的项有贡献，求和可以简化为\n$$\nt_{212}=\\sum_{j_{1}=1}^{2} g_{j_{1},1,2}\\,u^{(1)}_{2j_{1}}\\,u^{(2)}_{1,1}\\,u^{(3)}_{2,2}\n=2\\sum_{j_{1}=1}^{2} g_{j_{1},1,2}\\,u^{(1)}_{2j_{1}}.\n$$\n从核心切片可知，\n$$\n\\mathcal{G}_{:,:,2}=\\begin{pmatrix}3  0 \\\\ -2  1\\end{pmatrix}\\;\\Rightarrow\\; g_{1,1,2}=3,\\; g_{2,1,2}=-2.\n$$\n于是，\n$$\n\\sum_{j_{1}=1}^{2} g_{j_{1},1,2}\\,u^{(1)}_{2j_{1}}=3\\cdot 2+(-2)\\cdot 1=6-2=4,\n$$\n所以\n$$\nt_{212}=2\\cdot 4=8.\n$$", "answer": "$$\\boxed{8}$$", "id": "1561851"}, {"introduction": "在理论计算之外，理解算法在非理想条件下的行为对于实际应用至关重要。在实践中，我们通常不知道一个张量的精确“多线性秩”。这个练习引导我们进行一个思想实验：当我们使用一个高于真实秩的参数来执行塔克分解（特别是高阶奇异值分解，HOSVD）时，得到的核心张量会呈现出怎样的结构？通过这个练习，您将对秩、HOSVD算法以及核心张量的内在属性建立更深刻的认识 [@problem_id:1561841]。", "problem": "在张量分析中，塔克分解（Tucker decomposition）是一种基本工具，用于将高阶张量表示为一个较小的核心张量和一组因子矩阵。一个三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{I_1 \\times I_2 \\times I_3}$ 的分解由下式给出：\n$$ \\mathcal{X} \\approx \\mathcal{G} \\times_1 U^{(1)} \\times_2 U^{(2)} \\times_3 U^{(3)} $$\n其中 $\\mathcal{G} \\in \\mathbb{R}^{J_1 \\times J_2 \\times J_3}$ 是核心张量，而 $U^{(n)} \\in \\mathbb{R}^{I_n \\times J_n}$ (对于 $n=1,2,3$) 是具有标准正交列的因子矩阵。元组 $(J_1, J_2, J_3)$ 表示核心张量的大小，通常称为目标秩。\n\n计算这种分解最常用的算法之一是高阶奇异值分解（Higher-Order Singular Value Decomposition, HOSVD）。该算法通过张量 $\\mathcal{X}$ 的模-$n$ 展开（或矩阵化）$\\mathbf{X}_{(n)}$ 的奇异向量来确定因子矩阵 $U^{(n)}$。\n\n假设我们有一个张量 $\\mathcal{X}$，其真实多线性秩恰好为 $(R_1, R_2, R_3)$，其中 $R_n$ 是模-$n$ 展开 $\\mathbf{X}_{(n)}$ 的秩。然后我们对 $\\mathcal{X}$ 执行 HOSVD，但指定的目标秩为 $(J_1, J_2, J_3) = (R_1+1, R_2, R_3)$。这意味着我们高估了第一模的秩，而对其他两个模的秩指定正确。在没有任何数值精度误差的情况下，计算出的核心张量 $\\mathcal{G} \\in \\mathbb{R}^{(R_1+1) \\times R_2 \\times R_3}$ 的结构是什么？\n\nA. 额状切片 $\\mathcal{G}(R_1+1, :, :)$ 是一个零矩阵，而子张量 $\\mathcal{G}(1:R_1, :, :)$ 通常不全为零。\n\nB. 额状切片 $\\mathcal{G}(1, :, :)$ 是一个零矩阵，而其他切片通常不全为零。\n\nC. 核心张量 $\\mathcal{G}$ 是对角张量，即除非 $j_1=j_2=j_3$，否则 $\\mathcal{G}(j_1, j_2, j_3) = 0$。\n\nD. 核心张量 $\\mathcal{G}$ 的所有元素通常都是非零的，并且没有保证的零元素结构模式。\n\nE. 前 $R_1$ 个额状切片，包含在子张量 $\\mathcal{G}(1:R_1, :, :)$ 中，都是零矩阵，而最后一个切片 $\\mathcal{G}(R_1+1, :, :)$ 通常是非零的。", "solution": "我们将塔克/HOSVD模型写为：\n$$\n\\mathcal{X}\\approx \\mathcal{G}\\times_{1}U^{(1)}\\times_{2}U^{(2)}\\times_{3}U^{(3)},\n$$\n其中 $U^{(n)}\\in\\mathbb{R}^{I_{n}\\times J_{n}}$ 是标准正交的因子矩阵。在精确的（无噪声的）HOSVD中，核心张量通过正交投影计算得出：\n$$\n\\mathcal{G}=\\mathcal{X}\\times_{1}\\left(U^{(1)}\\right)^{T}\\times_{2}\\left(U^{(2)}\\right)^{T}\\times_{3}\\left(U^{(3)}\\right)^{T}.\n$$\n等价地，对于模-1展开，\n$$\n\\mathbf{G}_{(1)}=\\left(U^{(1)}\\right)^{T}\\mathbf{X}_{(1)}\\left(U^{(3)}\\otimes U^{(2)}\\right),\n$$\n其中 $\\otimes$ 表示克罗内克积（Kronecker product）。\n\n假设真实多线性秩为 $(R_{1},R_{2},R_{3})$，因此 $\\operatorname{rank}\\left(\\mathbf{X}_{(1)}\\right)=R_{1}$。在 HOSVD 中，$U^{(1)}$ 由 $\\mathbf{X}_{(1)}$ 的前 $J_{1}=R_{1}+1$ 个左奇异向量构成。设 $\\mathbf{X}_{(1)}$ 的紧奇异值分解（thin SVD）为：\n$$\n\\mathbf{X}_{(1)}=\\widetilde{U}^{(1)}\\Sigma^{(1)}\\left(\\widetilde{V}^{(1)}\\right)^{T},\n$$\n其中 $\\Sigma^{(1)}\\in\\mathbb{R}^{R_{1}\\times R_{1}}$ 的对角线元素严格为正。将 $\\widetilde{U}^{(1)}$ 扩展，加入一个额外的标准正交向量 $u_{R_{1}+1}$，该向量位于 $\\mathbf{X}_{(1)}$ 列空间的正交补空间中，得到：\n$$\nU^{(1)}=\\begin{bmatrix}\\widetilde{U}^{(1)}  u_{R_{1}+1}\\end{bmatrix}\\in\\mathbb{R}^{I_{1}\\times (R_{1}+1)}.\n$$\n因为 $u_{R_{1}+1}$ 位于 $\\mathbf{X}_{(1)}$ 列空间的正交补空间中，所以它属于 $\\mathbf{X}_{(1)}$ 的左零空间，因此\n$$\nu_{R_{1}+1}^{T}\\mathbf{X}_{(1)}=\\mathbf{0}^{T}.\n$$\n使用核心张量的展开关系，\n$$\n\\mathbf{G}_{(1)}=\\left(U^{(1)}\\right)^{T}\\mathbf{X}_{(1)}\\left(U^{(3)}\\otimes U^{(2)}\\right),\n$$\n$\\mathbf{G}_{(1)}$ 的第 $(R_{1}+1)$ 行为：\n$$\ne_{R_{1}+1}^{T}\\mathbf{G}_{(1)}=e_{R_{1}+1}^{T}\\left(U^{(1)}\\right)^{T}\\mathbf{X}_{(1)}\\left(U^{(3)}\\otimes U^{(2)}\\right)=u_{R_{1}+1}^{T}\\mathbf{X}_{(1)}\\left(U^{(3)}\\otimes U^{(2)}\\right)=\\mathbf{0}^{T}.\n$$\n因此，$\\mathcal{G}$ 中所有第一个索引为 $j_{1}=R_{1}+1$ 的元素都为零，即：\n$$\n\\mathcal{G}(R_{1}+1,:,:)=0.\n$$\n对于 $j_{1}\\leq R_{1}$，我们有：\n$$\ne_{j_{1}}^{T}\\mathbf{G}_{(1)}=e_{j_{1}}^{T}\\left(U^{(1)}\\right)^{T}\\mathbf{X}_{(1)}\\left(U^{(3)}\\otimes U^{(2)}\\right),\n$$\n由于 $e_{j_{1}}^{T}\\left(U^{(1)}\\right)^{T}\\mathbf{X}_{(1)}$ 对应一个非零奇异值行（因为 $j_{1}\\leq R_{1}$），这些行通常是非零的；右乘 $\\left(U^{(3)}\\otimes U^{(2)}\\right)$ 通常不会使它们变为零。因此，子张量 $\\mathcal{G}(1:R_{1},:,:)$ 通常不全为零。\n\n这与选项 A 完全匹配：因高估第一模秩而产生的额外切片恒为零，而其他切片通常非零。", "answer": "$$\\boxed{A}$$", "id": "1561841"}]}