{"hands_on_practices": [{"introduction": "理解一个新数学工具的最佳方式是将其应用于简单但基础的对象上。在此练习中，我们将计算一个基本函数的沃尔什-哈达玛变换——单位汉明权重向量的特征函数。这个练习不仅能帮助我们熟练运用变换的定义，还将揭示一个函数频谱与其组合学概念“汉明权重”之间的优美关系。[@problem_id:829988]", "problem": "考虑阿贝尔群 $V_n = (\\{0,1\\}^n, \\oplus)$，其中向量是长度为 $n$ 的二进制串，群操作 $\\oplus$ 是模 2 的逐分量加法（异或运算）。该群的大小为 $|V_n| = 2^n$。向量 $x \\in V_n$ 的汉明权重（Hamming weight），记作 $w(x)$，是其非零分量的数量。\n\n我们考虑该群上的实值函数构成的向量空间，$f: V_n \\to \\mathbb{R}$。函数 $f$ 的沃尔什-哈达玛变换（Walsh-Hadamard transform）是一个新函数 $\\hat{f}: V_n \\to \\mathbb{R}$，其定义为：\n$$ \\hat{f}(s) = \\sum_{x \\in V_n} f(x) (-1)^{s \\cdot x} $$\n其中 $s \\cdot x = \\sum_{i=1}^n s_i x_i \\pmod{2}$ 是在有限域 $\\mathbb{F}_2$ 上的点积。\n\n两个函数 $f, g: V_n \\to \\mathbb{R}$ 的标准欧几里得内积（Euclidean inner product）由下式给出：\n$$ \\langle f, g \\rangle = \\sum_{x \\in V_n} f(x) g(x) $$\n\n设 $f_1$ 是所有权重为 1 的向量集合 $W_1 = \\{x \\in V_n \\mid w(x)=1\\}$ 的特征函数。这意味着，如果 $w(x)=1$，则 $f_1(x) = 1$，否则 $f_1(x) = 0$。\n\n推导内积 $C = \\langle f_1, \\hat{f_1} \\rangle$ 作为维度 $n$ 的函数的封闭形式表达式。", "solution": "1. 定义：\n   $$\n   f_1(x)=\\begin{cases}\n   1, & \\text{if } w(x)=1, \\\\\n   0, & \\text{otherwise},\n   \\end{cases}\n   \\quad\n   \\hat f_1(s)=\\sum_{x\\in V_n}f_1(x)(-1)^{s\\cdot x}.\n   $$\n2. 计算 $\\hat f_1(s)$：\n   $$\n   \\hat f_1(s)\n   =\\sum_{w(x)=1}(-1)^{s\\cdot x}\n   =\\sum_{i=1}^n(-1)^{s_i}\n   =\\sum_{i=1}^n\\bigl(1-2s_i\\bigr)\n   =n-2\\,w(s).\n   $$\n3. 内积\n   $$\n   C=\\langle f_1,\\hat f_1\\rangle\n   =\\sum_{x\\in V_n}f_1(x)\\,\\hat f_1(x)\n   =\\sum_{w(x)=1}\\hat f_1(x)\n   =\\sum_{i=1}^n\\bigl(n-2\\bigr)\n   =n(n-2).\n   $$", "answer": "$$\\boxed{n(n-2)}$$", "id": "829988"}, {"introduction": "与其它傅里叶变换一样，沃尔什-哈达玛变换也遵循重要的守恒定律。本练习将探讨其中一个定律——帕塞瓦尔定理（Parseval's Theorem），它将函数的总“能量”与其在频率分量上的能量分布联系起来。通过分析一个坐标子空间的特征函数，我们将看到一个函数的几何结构如何反映在其谱功率分布中，并借此机会讨论归一化因子在变换定义中的作用。[@problem_id:829886]", "problem": "考虑阿贝尔群 $G = (\\mathbb{Z}_2)^n$，它由所有长度为 $n$ 的二进制串组成，群运算是模2的分量加法（异或）。$G$ 的元素是向量 $x = (x_1, \\dots, x_n)$，其中 $x_i \\in \\{0, 1\\}$。\n\n这个群的特征标是Walsh函数，由频率向量 $s \\in G$ 索引。对于给定的 $s$，Walsh函数 $\\chi_s: G \\to \\{-1, 1\\}$ 定义为：\n$$\n\\chi_s(x) = (-1)^{s \\cdot x}\n$$\n其中 $s \\cdot x = \\sum_{i=1}^n s_i x_i \\pmod 2$ 是点积。\n\n一个实值函数 $f: G \\to \\mathbb{R}$ 的Walsh-Hadamard变换是一个函数 $\\hat{f}: G \\to \\mathbb{R}$，由下式给出：\n$$\n\\hat{f}(s) = \\frac{1}{2^n} \\sum_{x \\in G} f(x) \\chi_s(x)\n$$\n该变换将函数 $f$ 分解为其频率分量，由系数 $\\hat{f}(s)$ 表示。\n\n令 $V_k$ 为 $G$ 的 $k$ 维坐标子空间，包含所有最后 $n-k$ 个分量为零的向量。即 $V_k = \\{x \\in G \\mid x_i = 0 \\text{ for all } i > k \\}$。我们假设 $1 \\le k  n$。\n\n考虑该子空间的特征函数 $f_{V_k}: G \\to \\mathbb{R}$，定义为：\n$$\nf_{V_k}(x) =\n\\begin{cases}\n1  \\text{if } x \\in V_k \\\\\n0  \\text{if } x \\notin V_k\n\\end{cases}\n$$\n量 $|\\hat{f}_{V_k}(s)|^2$ 可以解释为函数在频率 $s$ 处的功率。\n\n推导所有非零频率所包含的总功率的表达式，该总功率由和式 $P_{nz} = \\sum_{s \\in G, s \\neq \\mathbf{0}} |\\hat{f}_{V_k}(s)|^2$ 给出。你的最终答案应该是一个关于 $n$ 和 $k$ 的闭式表达式。", "solution": "1. Walsh-Hadamard系数为\n$$\n\\hat f_{V_k}(s)\n=\\frac1{2^n}\\sum_{x\\in V_k}(-1)^{s\\cdot x}\\,.\n$$\n2. 因为 $V_k$ 是所有满足 $x_{k+1}=\\cdots=x_n=0$ 的向量 $x$ 的集合，所以当 $s_1=\\cdots=s_k=0$ 时，和式 $\\sum_{x\\in V_k}(-1)^{s\\cdot x}$ 等于 $|V_k|=2^k$，否则为 $0$。因此，\n$$\n\\hat f_{V_k}(s)\n=\\begin{cases}\n2^{k-n},  \\text{if } s_1=\\cdots=s_k=0, \\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n3. 根据Parseval恒等式，\n$$\n\\sum_{s\\in G}|\\hat f_{V_k}(s)|^2\n=\\frac1{2^n}\\sum_{x\\in G}f_{V_k}(x)^2\n=\\frac{|V_k|}{2^n}\n=\\frac{2^k}{2^n}\n=2^{\\,k-n}\\,.\n$$\n4. 零频功率为\n$$\n|\\hat f_{V_k}(0)|^2\n=(2^{\\,k-n})^2\n=2^{\\,2k-2n}\\,.\n$$\n5. 因此，总的非零频率功率为\n$$\nP_{nz}\n=2^{\\,k-n}-2^{\\,2k-2n}\\,.\n$$", "answer": "$$\\boxed{2^{\\,k-n}-2^{\\,2k-2n}}$$", "id": "829886"}, {"introduction": "傅里叶分析最强大的特性之一是它能够简化卷积运算。这个进阶练习将展示卷积定理的实际应用。我们将分析一个由简单“脉冲”函数（狄拉克$\\delta$函数）之差的卷积所构造的函数，通过转换到频率域，我们可以轻松确定其谱支撑集的大小，从而将问题与求解有限域 $\\mathbb{F}_2$ 上的线性方程组联系起来。[@problem_id:829942]", "problem": "设 $G = (\\mathbb{Z}/2\\mathbb{Z})^n$ 是一个由长度为 $n$ 的二进制向量组成的群，其运算为逐分量模2加法（异或运算）。$G$ 中的元素形式为 $x = (x_1, \\dots, x_n)$，其中 $x_i \\in \\{0, 1\\}$。两个向量 $s, x \\in G$ 的点积在域 $\\mathbb{F}_2$ 上定义为 $s \\cdot x = \\sum_{i=1}^n s_i x_i \\pmod 2$。\n\n一个函数 $g: G \\to \\mathbb{C}$ 的 Walsh-Hadamard 变换是一个函数 $\\hat{g}: G \\to \\mathbb{C}$，定义为：\n$$ \\hat{g}(s) = \\sum_{x \\in G} g(x) (-1)^{s \\cdot x} $$\n\n以点 $a \\in G$ 为中心的 Dirac delta 函数定义为：当 $x=a$ 时 $\\delta_a(x) = 1$，当 $x \\neq a$ 时 $\\delta_a(x) = 0$。两个函数 $g_1, g_2: G \\to \\mathbb{C}$ 的卷积由 $(g_1 * g_2)(x) = \\sum_{y \\in G} g_1(y) g_2(x+y)$ 给出，其中向量加法是逐分量模2进行的。\n\n考虑四个不同的非零向量 $a, b, c, d \\in G$。设函数 $f: G \\to \\mathbb{C}$ 定义为卷积 $f = (\\delta_a - \\delta_b) * (\\delta_c - \\delta_d)$。\n\n推导 $f$ 的谱支撑的大小，即满足 $\\hat{f}(s) \\neq 0$ 的元素 $s \\in G$ 的数量。已知向量 $u = a+b$ 和 $v = c+d$ 在域 $\\mathbb{F}_2$ 上线性无关。请用 $n$ 表示你的答案。", "solution": "我们在群 $G=(\\mathbb{Z}/2\\mathbb{Z})^n$ 中进行计算，其加法为模2加法，点积为 $s\\cdot x=\\sum_i s_i x_i\\pmod2$。\n\n1. 卷积 $f=(\\delta_a-\\delta_b)*(\\delta_c-\\delta_d)$ 给出\n$$\nf(x)=\\sum_{y\\in G}(\\delta_a(y)-\\delta_b(y))(\\delta_c(x+y)-\\delta_d(x+y))\n=\\delta_c(x+a)-\\delta_d(x+a)-\\delta_c(x+b)+\\delta_d(x+b).\n$$\n\n2. Walsh–Hadamard 变换\n$$\n\\hat f(s)=\\sum_{x\\in G}f(x)(-1)^{s\\cdot x}.\n$$\n通过平移 $y=x+a$（对 $b$ 也类似）来计算每一项：\n$$\n\\sum_x\\delta_c(x+a)(-1)^{s\\cdot x}\n=\\sum_y\\delta_c(y)(-1)^{s\\cdot(y+a)}\n=(-1)^{s\\cdot a+s\\cdot c},\n$$\n同理\n$$\n\\sum_x\\delta_d(x+a)(-1)^{s\\cdot x}=(-1)^{s\\cdot a+s\\cdot d},\\quad\n\\sum_x\\delta_c(x+b)(-1)^{s\\cdot x}=(-1)^{s\\cdot b+s\\cdot c},\\quad\n\\sum_x\\delta_d(x+b)(-1)^{s\\cdot x}=(-1)^{s\\cdot b+s\\cdot d}.\n$$\n\n3. 因此\n$$\n\\hat f(s)\n=(-1)^{s\\cdot a+s\\cdot c}-(-1)^{s\\cdot a+s\\cdot d}\n-(-1)^{s\\cdot b+s\\cdot c}+(-1)^{s\\cdot b+s\\cdot d}\n=\\bigl((-1)^{s\\cdot a}-(-1)^{s\\cdot b}\\bigr)\\,\n\\bigl((-1)^{s\\cdot c}-(-1)^{s\\cdot d}\\bigr).\n$$\n\n4. 注意到括号项 $(-1)^{s\\cdot a}-(-1)^{s\\cdot b}=0\\iff(-1)^{s\\cdot(a+b)}=1\\iff s\\cdot u=0$，类似地，另一因子为零当且仅当 $s\\cdot v=0$。因此\n$$\n\\hat f(s)\\neq0\\quad\\Longleftrightarrow\\quad s\\cdot u=1\\text{ 且 }s\\cdot v=1.\n$$\n\n5. 由于 $u,v$ 在 $\\mathbb F_2$ 上线性无关，两个方程 $s\\cdot u=1,\\;s\\cdot v=1$ 在 $G$ 中定义了一个余维为2的仿射子空间。因此其大小为\n$$\n2^{n-2}.\n$$", "answer": "$$\\boxed{2^{n-2}}$$", "id": "829942"}]}