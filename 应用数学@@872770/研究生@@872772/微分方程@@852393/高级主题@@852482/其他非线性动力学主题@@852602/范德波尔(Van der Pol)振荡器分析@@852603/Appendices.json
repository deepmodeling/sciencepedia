{"hands_on_practices": [{"introduction": "我们将从分析系统在其原点平衡点附近的行为开始。这项练习 [@problem_id:1067889] 运用了动力系统中一种基本技巧——线性化，来理解范德波尔振子如何启动其自持振荡。通过考察雅可比矩阵的特征值，我们可以确定平衡点的稳定性，并揭示在小位移下导致振幅增大的负阻尼机制。", "problem": "范德波振荡器是一种著名的具有非线性阻尼的非保守振荡器。范德波方程的广义形式由以下二阶常微分方程给出：\n$$ \\frac{d^2x}{dt^2} - \\mu(1-\\alpha x^2)\\frac{dx}{dt} + \\omega_0^2 x = 0 $$\n其中 $x(t)$ 是位移，$\\mu > 0$ 是阻尼系数，$\\alpha > 0$ 是与非线性相关的参数，$\\omega_0 > 0$ 是无阻尼线性振荡器的固有频率。\n\n该系统可以通过将其转换为一个含两个一阶微分方程的方程组来进行分析。其不动点的稳定性由系统在这些点上求值的雅可比矩阵的特征值决定。该系统在原点 $(x, \\frac{dx}{dt}) = (0,0)$ 有一个不动点。\n\n对于系统在原点周围表现出稳定或不稳定螺旋行为的情况，雅可比矩阵的特征值为一对共轭复数。这种情况在参数满足条件 $\\mu^2  4\\omega_0^2$ 时发生。\n\n您的任务是推导这些复数特征值虚部的模（绝对值）。", "solution": "我们设 $x_1=x,\\;x_2=\\dot x$。则该系统变为\n$$x_1' = x_2,$$\n$$x_2' = \\mu\\bigl(1-\\alpha x_1^2\\bigr)x_2-\\omega_0^2x_1.$$\n雅可比矩阵为\n$$J=\\begin{pmatrix} \\frac{\\partial x_1'}{\\partial x_1}  \\frac{\\partial x_1'}{\\partial x_2} \\\\ \\frac{\\partial x_2'}{\\partial x_1}  \\frac{\\partial x_2'}{\\partial x_2} \\end{pmatrix} =\\begin{pmatrix} 0  1\\\\ -2\\mu\\alpha x_1 x_2 - \\omega_0^2  \\mu(1-\\alpha x_1^2) \\end{pmatrix}.$$\n在不动点 $(0,0)$ 处，该矩阵简化为\n$$J(0,0)=\\begin{pmatrix}0  1\\\\-\\omega_0^2  \\mu\\end{pmatrix}.$$\n特征方程为\n$$\\det\\bigl(J(0,0)-\\lambda I\\bigr)\n=\\begin{vmatrix}-\\lambda  1\\\\-\\omega_0^2  \\mu-\\lambda\\end{vmatrix}\n=\\lambda^2-\\mu\\lambda+\\omega_0^2=0.$$\n因此特征值为\n$$\\lambda=\\frac{\\mu\\pm\\sqrt{\\mu^2-4\\omega_0^2}}{2}.$$\n当 $\\mu^24\\omega_0^2$ 时，这些特征值为共轭复数，\n$$\\lambda=\\frac\\mu2\\pm i\\,\\frac{\\sqrt{4\\omega_0^2-\\mu^2}}{2},$$\n因此虚部的模为\n$$\\frac{\\sqrt{4\\omega_0^2-\\mu^2}}{2}\\,. $$", "answer": "$$\\boxed{\\frac{\\sqrt{4\\omega_0^2-\\mu^2}}{2}}$$", "id": "1067889"}, {"introduction": "在完成了对平衡点的局部稳定性分析 [@problem_id:1067889] 后，我们转向强非线性区域（$\\mu \\gg 1$），在该区域系统表现出独特的“弛豫振荡”特性。这项练习 [@problem_id:1943841] 将展示如何运用渐近方法来分析系统的慢速和快速阶段。通过将系统参数与振荡周期等可观测属性联系起来，你将学习到如何从经验数据中反推模型参数，这是理论联系实际的关键一步。", "problem": "自持振荡的动力学可以用 van der Pol 振子方程来建模，其形式如下：\n$$ \\frac{d^{2}x}{dt^{2}} - \\mu(1-x^{2})\\frac{dx}{dt} + x = 0 $$\n其中 $x(t)$ 是作为时间 $t$ 函数的位移，$\\mu$ 是一个控制非线性和阻尼的正无量纲参数。\n\n对该系统进行了一次数值模拟，其中 $\\mu$ 的值未知且较大。观察到系统最终进入一个稳定的极限环，也称为弛豫振荡。在由坐标 $(x, v)$（其中 $v = dx/dt$）定义的相平面中，该极限环由缓慢演化的段落和极其快速的跳跃组成。\n\n发现一次完整振荡的总周期为 $T = 403.4$。\n\n对模拟数据的进一步分析表明，在几乎占据整个周期的缓慢段落中，相平面中的轨迹紧密地贴合由以下方程描述的曲线：\n$$ v = \\frac{x}{\\mu(1-x^{2})} $$\n其中一个缓慢段落对应于轨迹从 $x=2$ 处的极值点移动到 $x=1$ 处的不稳定点。第二个对称的缓慢段落是轨迹从 $x=-2$ 移动到 $x=-1$。您可以假设连接这些缓慢段落的快速跳跃所花费的时间可以忽略不计。\n\n利用这些信息，估算模拟中使用的参数 $\\mu$ 的值。将您的最终答案四舍五入到三位有效数字。", "solution": "题目要求我们根据总振荡周期和在 $\\mu$ 值较大时相平面中的轨迹描述，来估算 van der Pol 振子的参数 $\\mu$。\n\n关键信息是周期 $T$ 主要由两个“缓慢”段落构成，在这些段落中，速度 $v = dx/dt$ 可以很好地近似为 $v = \\frac{x}{\\mu(1-x^2)}$。快速跳跃所花费的时间被认为是可忽略的。\n\n让我们计算其中一个缓慢段落所花费的时间。时间 $t$ 和位置 $x$ 之间的关系由 $v = dx/dt$ 给出。我们可以将一个无穷小的时间间隔 $dt$ 表示为：\n$$ dt = \\frac{dx}{v(x)} $$\n在缓慢段落中，代入给定的 $v(x)$ 表达式：\n$$ dt = \\frac{dx}{\\frac{x}{\\mu(1-x^2)}} = \\frac{\\mu(1-x^2)}{x} dx $$\n题目指出，一个缓慢段落对应于从 $x_i = 2$ 到 $x_f = 1$ 的运动。这个段落的时间，我们称之为 $T_{slow,1}$，可以通过在这些极限之间对 $dt$ 进行积分来求得：\n$$ T_{slow,1} = \\int_{x_i}^{x_f} \\frac{\\mu(1-x^2)}{x} dx = \\int_{2}^{1} \\mu \\left(\\frac{1}{x} - x\\right) dx $$\n我们可以将常数 $\\mu$ 从积分中提出：\n$$ T_{slow,1} = \\mu \\int_{2}^{1} \\left(\\frac{1}{x} - x\\right) dx $$\n现在，我们计算这个定积分：\n$$ T_{slow,1} = \\mu \\left[ \\ln|x| - \\frac{x^2}{2} \\right]_{2}^{1} $$\n代入积分上下限：\n$$ T_{slow,1} = \\mu \\left( \\left(\\ln(1) - \\frac{1^2}{2}\\right) - \\left(\\ln(2) - \\frac{2^2}{2}\\right) \\right) $$\n$$ T_{slow,1} = \\mu \\left( \\left(0 - \\frac{1}{2}\\right) - \\left(\\ln(2) - 2\\right) \\right) $$\n$$ T_{slow,1} = \\mu \\left( -\\frac{1}{2} - \\ln(2) + 2 \\right) = \\mu \\left(\\frac{3}{2} - \\ln(2)\\right) $$\n题目指出，完整的极限环由两个这样对称的缓慢段落组成。第二个段落从 $x=-2$ 运行到 $x=-1$。由于被积函数 $f(x) = \\frac{1}{x}-x$ 的对称性（因为 $f(-x) = -f(x)$）以及对称的积分限，第二个段落的时间 $T_{slow,2}$ 等于 $T_{slow,1}$。\n$$ T_{slow,2} = \\int_{-2}^{-1} \\mu \\left(\\frac{1}{x} - x\\right) dx = \\mu \\left[ \\ln|x| - \\frac{x^2}{2} \\right]_{-2}^{-1} = \\mu \\left( (\\ln(1)-\\frac{1}{2}) - (\\ln(2)-\\frac{4}{2}) \\right) = \\mu \\left(\\frac{3}{2} - \\ln(2)\\right) $$\n总周期 $T$ 是这两个缓慢段落持续时间的总和，因为快速跳跃的时间可以忽略不计。\n$$ T \\approx T_{slow,1} + T_{slow,2} = 2 \\times \\mu \\left(\\frac{3}{2} - \\ln(2)\\right) = \\mu (3 - 2\\ln(2)) $$\n我们已知测得的周期是 $T = 403.4$。现在我们可以求解 $\\mu$：\n$$ 403.4 = \\mu (3 - 2\\ln(2)) $$\n$$ \\mu = \\frac{403.4}{3 - 2\\ln(2)} $$\n现在我们计算数值。使用 $\\ln(2) \\approx 0.693147$：\n$$ 3 - 2\\ln(2) \\approx 3 - 2(0.693147) = 3 - 1.386294 = 1.613706 $$\n$$ \\mu = \\frac{403.4}{1.613706} \\approx 249.989... $$\n题目要求将最终答案四舍五入到三位有效数字。\n$$ \\mu \\approx 250. $$\n为了用三位有效数字明确地表示这个结果，我们将其写成科学记数法。\n$$ \\mu \\approx 2.50 \\times 10^2 $$", "answer": "$$\\boxed{2.50 \\times 10^{2}}$$", "id": "1943841"}, {"introduction": "在分析了系统的理论特性后，包括其在线性 [@problem_id:1067889] 和强非线性 [@problem_id:1943841] 区域的行为，现在我们通过计算将这些概念付诸实践。这个问题 [@problem_id:2395985] 将指导你实现四阶龙格-库塔（RK4）方法来构建范德波尔振子的完整数值模型。通过模拟不同初始条件的轨迹，你将直接观察到极限环的形成，以一种具体、动手的方式验证吸引子的概念。", "problem": "您需要编写一个完整、可运行的程序，使用经典的四阶 Runge–Kutta 方法研究 van der Pol 振子。van der Pol 振子是一个二阶常微分方程 (ODE) $$\\frac{d^2 x}{dt^2} - \\mu \\left(1 - x^2\\right)\\frac{dx}{dt} + x = 0,$$ 您必须通过定义 $y = \\frac{dx}{dt}$ 将其转换为一个一阶系统，从而得到 $$\\frac{dx}{dt} = y,\\quad \\frac{dy}{dt} = \\mu \\left(1 - x^2\\right) y - x.$$ 所有变量均为无量纲。\n\n您的任务是实现采用固定步长的经典四阶 Runge–Kutta 时间步进法，对上述系统在几组参数集和初始条件下进行积分。然后，您必须通过从长时间行为中提取渐近振幅来量化极限环的出现，并证明对于正 $\\mu$ 值，从环内部或外部开始的轨迹都收敛于该极限环。\n\n您可以假定的基础知识：常微分方程的定义、初值问题的概念，以及连接 $\\frac{dx}{dt}$、$\\frac{dy}{dt}$ 和状态演化的牛顿运动学。您不得使用任何预构建的 ODE 求解器。\n\n实现以下步骤：\n- 使用经典的四阶 Runge–Kutta 方法，以固定时间步长 $h$ 对上述定义的右侧函数进行时间推进，从而更新状态 $(x,y)$。不要使用任何自适应时间步进。\n- 对于每次模拟，定义总时间 $T$ 并在分析中舍弃持续时间为 $T_{\\mathrm{trans}}$ 的初始瞬态。在剩余数据上，计算振幅估计值 $$A = \\frac{1}{2}\\left(\\max x - \\min x\\right),$$ 其中极值取自时间区间 $[T - T_{\\mathrm{trans}}, T]$。\n- 对于给定的 $\\mu$，模拟两条具有不同初始条件的轨迹，一条在最终极限环的“内部”，另一条在“外部”，并计算两个振幅 $A_{\\mathrm{in}}$ 和 $A_{\\mathrm{out}}$。然后，根据预设的容差 $\\varepsilon$，计算由 $$\\left|A_{\\mathrm{in}} - A_{\\mathrm{out}}\\right|  \\varepsilon,$$ 定义的布尔收敛指标。\n\n使用以下参数值、时间网格和容差的测试套件：\n- 测试 1 (非刚性，可见收敛到一个唯一的极限环): $\\mu = 1$, $T = 120$, $T_{\\mathrm{trans}} = 60$, $h = 0.01$, 初始条件 $(x_0,y_0) = (0.1,0.1)$ 和 $(x_0,y_0) = (3.0,0.0)$, 容差 $\\varepsilon = 2\\times 10^{-2}$。\n- 测试 2 (更强的非线性，弛豫振荡；使用小的固定步长来控制误差): $\\mu = 5$, $T = 200$, $T_{\\mathrm{trans}} = 100$, $h = 0.002$, 初始条件 $(x_0,y_0) = (0.1,0.1)$ 和 $(x_0,y_0) = (3.0,0.0)$, 容差 $\\varepsilon = 5\\times 10^{-2}$。\n- 测试 3 (边界情况，无非线性，无吸引极限环): $\\mu = 0$, $T = 60$, $T_{\\mathrm{trans}} = 30$, $h = 0.01$, 初始条件 $(x_0,y_0) = (0.1,0.1)$ 和 $(x_0,y_0) = (3.0,0.0)$, 容差 $\\varepsilon = 5\\times 10^{-2}$。\n\n对于每个测试，计算振幅对 $A_{\\mathrm{in}}$ 和 $A_{\\mathrm{out}}$，并计算上面定义的布尔收敛指标。您的程序必须将所有结果汇总到单行输出中，按以下顺序包含这 9 个值：\n$$[A_{1,\\mathrm{in}}, A_{1,\\mathrm{out}}, C_1, A_{2,\\mathrm{in}}, A_{2,\\mathrm{out}}, C_2, A_{3,\\mathrm{in}}, A_{3,\\mathrm{out}}, C_3],$$\n其中 $C_k$ 是测试 $k$ 的布尔收敛指标。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $\\left[\\dots\\right]$。不应打印任何额外文本。\n\n角度单位不适用。由于该系统是无量纲的，因此没有物理单位。在最终输出中，所有数值必须根据需要表示为浮点数或布尔值。程序必须是自包含的，且不得读取任何输入。确保您的实现严格遵守经典的四阶 Runge–Kutta 方法和指定的时间步进参数，不使用任何外部 ODE 求解器。", "solution": "对问题陈述进行验证。\n\n### 第 1 步：提取给定信息\n该问题要求对 van der Pol 振子方程进行数值求解，这是一个二阶常微分方程 (ODE)：\n$$\n\\frac{d^2 x}{dt^2} - \\mu \\left(1 - x^2\\right)\\frac{dx}{dt} + x = 0\n$$\n需要通过定义新变量 $y = \\frac{dx}{dt}$ 将其转换为一个由两个一阶 ODE 组成的系统。得到的系统是：\n$$\n\\frac{dx}{dt} = y\n$$\n$$\n\\frac{dy}{dt} = \\mu \\left(1 - x^2\\right) y - x\n$$\n要使用的数值方法是采用固定时间步长 $h$ 的经典四阶 Runge-Kutta (RK4) 方法。\n\n对于每次在总时间 $T$ 内运行的模拟，需要根据轨迹数据计算振幅 $A$。需要舍弃对应于瞬态时间 $T_{\\mathrm{trans}}$ 的初始部分数据。振幅定义为：\n$$\nA = \\frac{1}{2}\\left(\\max x - \\min x\\right)\n$$\n其中最大值和最小值是在时间区间 $[T - T_{\\mathrm{trans}}, T]$ 上计算的。\n\n对于每组参数，模拟两条轨迹，一条从极限环“内部”开始 ($A_{\\mathrm{in}}$)，另一条从“外部”开始 ($A_{\\mathrm{out}}$)。然后计算布尔收敛指标 $C$ 为：\n$$\nC = \\left(\\left|A_{\\mathrm{in}} - A_{\\mathrm{out}}\\right|  \\varepsilon\\right)\n$$\n其中 $\\varepsilon$ 是给定的容差。\n\n具体的测试用例如下：\n1.  **测试 1**: $\\mu = 1$, $T = 120$, $T_{\\mathrm{trans}} = 60$, $h = 0.01$。\n    初始条件: $(x_0, y_0) = (0.1, 0.1)$ (内) 和 $(x_0, y_0) = (3.0, 0.0)$ (外)。\n    容差: $\\varepsilon = 2 \\times 10^{-2}$。\n2.  **测试 2**: $\\mu = 5$, $T = 200$, $T_{\\mathrm{trans}} = 100$, $h = 0.002$。\n    初始条件: $(x_0, y_0) = (0.1, 0.1)$ (内) 和 $(x_0, y_0) = (3.0, 0.0)$ (外)。\n    容差: $\\varepsilon = 5 \\times 10^{-2}$。\n3.  **测试 3**: $\\mu = 0$, $T = 60$, $T_{\\mathrm{trans}} = 30$, $h = 0.01$。\n    初始条件: $(x_0, y_0) = (0.1, 0.1)$ (内) 和 $(x_0, y_0) = (3.0, 0.0)$ (外)。\n    容差: $\\varepsilon = 5 \\times 10^{-2}$。\n\n最终输出必须是包含九个值的单行，顺序为：$[A_{1,\\mathrm{in}}, A_{1,\\mathrm{out}}, C_1, A_{2,\\mathrm{in}}, A_{2,\\mathrm{out}}, C_2, A_{3,\\mathrm{in}}, A_{3,\\mathrm{out}}, C_3]$。\n\n### 第 2 步：使用提取的给定信息进行验证\n根据验证标准对问题进行评估。\n-   **科学性**：该问题基于 van der Pol 振子，这是非线性动力学和混沌理论领域的经典模型。四阶 Runge-Kutta 方法是求解 ODE 的标准、成熟的数值技术。极限环及其吸引特性是研究此类系统的基础。该问题在科学上是合理的。\n-   **适定性**：该问题是一个 ODE 系统的初值问题。所有必要的参数 ($\\mu$)、初始条件 ($(x_0, y_0)$)、积分参数 ($h, T$) 和后处理步骤 (分析窗口、振幅公式、收敛标准) 都得到了明确无误的定义。对于给定的设置，预期会有一个唯一的数值解。\n-   **客观性**：该问题使用精确的数学语言和客观的量化标准进行规定。没有主观或基于意见的内容。\n-   **无其他缺陷**：该问题是自包含的，没有缺失信息。参数是一致的，对于数值研究而言在物理上是合理的。该问题并非微不足道、比喻性或无法验证。\n\n### 第 3 步：结论与行动\n问题有效。将开发解决方案。\n\n解决方案的核心是为给定的 ODE 系统实现经典的四阶 Runge-Kutta 方法。设系统在时间 $t$ 的状态由向量 $\\mathbf{z}(t) = [x(t), y(t)]^T$ 表示。该 ODE 系统可以写成向量形式 $\\frac{d\\mathbf{z}}{dt} = \\mathbf{f}(\\mathbf{z}, \\mu)$，其中函数 $\\mathbf{f}$ 为：\n$$\n\\mathbf{f}(\\mathbf{z}, \\mu) = \\begin{pmatrix} y \\\\ \\mu(1-x^2)y - x \\end{pmatrix}\n$$\nRK4 方法使用以下步骤将解从时间 $t_n$推进到 $t_{n+1} = t_n + h$：\n1.  计算第一个斜率估计值：$\\mathbf{k}_1 = \\mathbf{f}(\\mathbf{z}_n, \\mu)$。\n2.  使用 $\\mathbf{k}_1$ 在中点计算第二个斜率估计值：$\\mathbf{k}_2 = \\mathbf{f}(\\mathbf{z}_n + \\frac{h}{2}\\mathbf{k}_1, \\mu)$。\n3.  使用 $\\mathbf{k}_2$ 在中点计算第三个斜率估计值：$\\mathbf{k}_3 = \\mathbf{f}(\\mathbf{z}_n + \\frac{h}{2}\\mathbf{k}_2, \\mu)$。\n4.  使用 $\\mathbf{k}_3$ 在区间末端计算第四个斜率估计值：$\\mathbf{k}_4 = \\mathbf{f}(\\mathbf{z}_n + h\\mathbf{k}_3, \\mu)$。\n5.  组合这些斜率以获得下一个时间步的状态：$\\mathbf{z}_{n+1} = \\mathbf{z}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)$。\n\n从给定的初始条件 $\\mathbf{z}_0 = [x_0, y_0]^T$ 开始，此过程重复总步数 $N = T/h$。在积分过程中，存储状态向量的 $x$ 分量的历史记录。\n\n模拟完成后，进行分析。问题规定极值取自时间区间 $[T - T_{\\mathrm{trans}}, T]$。对于所有测试用例，恰好有 $T - T_{\\mathrm{trans}} = T_{\\mathrm{trans}}$。这意味着分析窗口对应于模拟数据的后半部分。在包含 $N+1$ 个点的历史数组中，此分析窗口的起始索引为 $i_{\\mathrm{start}} = T_{\\mathrm{trans}} / h$。然后，算法在历史数组从该索引到末尾的切片中找到 $x$ 的最大值和最小值。这些值用于计算振幅 $A$。\n\n对于每个测试用例，整个过程（模拟和分析）执行两次：一次针对“内部”初始条件以找到 $A_{\\mathrm{in}}$，一次针对“外部”初始条件以找到 $A_{\\mathrm{out}}$。然后评估收敛条件 $|A_{\\mathrm{in}} - A_{\\mathrm{out}}|  \\varepsilon$ 以产生布尔结果 $C$。\n\n特殊情况 $\\mu = 0$ 对应于简谐振子，$\\frac{d^2x}{dt^2} + x = 0$。该系统没有吸引极限环；其振幅是守恒的，完全取决于初始条件。因此，我们预期 $A_{\\mathrm{in}}$ 和 $A_{\\mathrm{out}}$ 会有显著差异，导致收敛指标为 `False`。对于 $\\mu > 0$，系统有一个唯一的、稳定的极限环，因此从内部和外部开始的轨迹预计会收敛到它，只要模拟时间和数值精度足够，收敛指标就会为 `True`。所提供的参数旨在展示这种行为。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the van der Pol oscillator problem for a set of test cases.\n    Implements the classical RK4 method and analyzes trajectory convergence.\n    \"\"\"\n\n    def f(z, mu):\n        \"\"\"\n        Calculates the derivative vector for the van der Pol system.\n        z: state vector [x, y]\n        mu: nonlinearity parameter\n        \"\"\"\n        x, y = z\n        dxdt = y\n        dydt = mu * (1.0 - x**2) * y - x\n        return np.array([dxdt, dydt])\n\n    def rk4_step(z, h, mu):\n        \"\"\"\n        Performs a single step of the classical 4th-order Runge-Kutta method.\n        z: current state vector [x, y]\n        h: time step\n        mu: nonlinearity parameter\n        \"\"\"\n        k1 = f(z, mu)\n        k2 = f(z + 0.5 * h * k1, mu)\n        k3 = f(z + 0.5 * h * k2, mu)\n        k4 = f(z + h * k3, mu)\n        return z + (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n\n    def run_simulation(mu, ic, T, h):\n        \"\"\"\n        Runs a full simulation for the van der Pol oscillator.\n        mu: nonlinearity parameter\n        ic: initial condition (x0, y0)\n        T: total simulation time\n        h: time step\n        Returns: array of x-positions over time.\n        \"\"\"\n        n_steps = int(T / h)\n        x_history = np.zeros(n_steps + 1)\n        \n        z = np.array(ic, dtype=float)\n        x_history[0] = z[0]\n        \n        for i in range(n_steps):\n            z = rk4_step(z, h, mu)\n            x_history[i+1] = z[0]\n            \n        return x_history\n\n    def calculate_amplitude(x_history, T_trans, h):\n        \"\"\"\n        Calculates the asymptotic amplitude from the trajectory.\n        x_history: array of x-positions\n        T_trans: duration of transient to discard\n        h: time step\n        \"\"\"\n        # The analysis is over the interval [T_trans, T].\n        # The start index corresponds to time t = T_trans.\n        analysis_start_index = int(T_trans / h)\n        \n        # Slice the history to get the analysis window\n        analysis_window = x_history[analysis_start_index:]\n        \n        max_x = np.max(analysis_window)\n        min_x = np.min(analysis_window)\n        \n        return 0.5 * (max_x - min_x)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (mu, T, T_trans, h, ic_in, ic_out, epsilon)\n        (1.0, 120.0, 60.0, 0.01, (0.1, 0.1), (3.0, 0.0), 2e-2),\n        (5.0, 200.0, 100.0, 0.002, (0.1, 0.1), (3.0, 0.0), 5e-2),\n        (0.0, 60.0, 30.0, 0.01, (0.1, 0.1), (3.0, 0.0), 5e-2)\n    ]\n\n    all_results = []\n    \n    for mu, T, T_trans, h, ic_in, ic_out, epsilon in test_cases:\n        # Run simulation for the \"inside\" trajectory\n        x_history_in = run_simulation(mu, ic_in, T, h)\n        A_in = calculate_amplitude(x_history_in, T_trans, h)\n        \n        # Run simulation for the \"outside\" trajectory\n        x_history_out = run_simulation(mu, ic_out, T, h)\n        A_out = calculate_amplitude(x_history_out, T_trans, h)\n        \n        # Calculate the boolean convergence indicator\n        C = abs(A_in - A_out)  epsilon\n        \n        all_results.extend([A_in, A_out, C])\n\n    # Final print statement in the exact required format.\n    # map(str, ...) converts floats and booleans to their string representations.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2395985"}]}