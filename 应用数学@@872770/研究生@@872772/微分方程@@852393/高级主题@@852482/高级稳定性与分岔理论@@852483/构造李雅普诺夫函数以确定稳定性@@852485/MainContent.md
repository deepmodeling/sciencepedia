## 引言
在动力系统和控制理论的研究中，判断一个[平衡点](@entry_id:272705)是否稳定是至关重要的问题。[李雅普诺夫第二方法](@entry_id:168377)，或称直接法，为此提供了一个极其强大而优雅的理论框架。它允许我们绕过直接[求解微分方程](@entry_id:137471)的困难，通过考察一个被称为李雅普诺夫函数的辅助标量函数 $V(\mathbf{x})$ 的性质，来推断系统的稳定性。然而，该理论的巨大威力背后隐藏着一个核心的实践挑战：理论本身并未提供一个通用的、系统性的方法来寻找或构造这个关键的李雅普诺夫函数。这一步骤往往需要深刻的洞察力、创造性，甚至是反复的试探。

本文旨在填补这一知识鸿沟，系统性地阐述构造[李雅普诺夫函数](@entry_id:273986)的各种原理、技术和策略。我们的目标是为读者提供一套从基础到前沿的实用工具箱，将寻找李雅普诺夫函数的过程从一门“艺术”转变为一门更具结构性的“科学”。

为了实现这一目标，本文将分为三个核心章节。首先，在“原理与机制”一章中，我们将深入探讨构造[李雅普诺夫函数](@entry_id:273986)的核心思想，从适用于[线性系统](@entry_id:147850)的二次型函数和[李雅普诺夫方程](@entry_id:165178)出发，逐步扩展到非线性系统中常用的对消策略和[LaSalle不变性原理](@entry_id:266201)，并介绍变量梯度法等系统化构造方法。接着，在“应用与跨学科联系”一章中，我们将展示这些理论和方法如何在物理、工程、生物乃至经济学等多个学科中找到具体的应用，揭示李雅普诺夫函数在不同情境下的物理或系统内涵。最后，通过“动手实践”环节，读者将有机会通过解决具体问题，亲手应用所学知识，巩固对李雅普诺夫函数构造技巧的理解。

## 原理与机制

在“引言”章节中，我们已经建立了[李雅普诺夫第二方法](@entry_id:168377)（或直接法）作为分析动力系统[平衡点稳定性](@entry_id:261937)的核心理论框架。该方法的精髓在于，它允许我们通过考察一个标量函数（即李雅普诺夫函数 $V(\mathbf{x})$）的性质，来推断系统的稳定性，而无需直接[求解微分方程](@entry_id:137471)。其核心思想可概括为：如果能为一个系统找到一个在[平衡点](@entry_id:272705)附近表现得像“能量”一样的函数——它在[平衡点](@entry_id:272705)取最小值，且沿系统轨迹其值从不增加——那么该[平衡点](@entry_id:272705)就是稳定的。若其值沿轨迹严格递减，则[平衡点](@entry_id:272705)是[渐近稳定](@entry_id:168077)的。

尽管[李雅普诺夫稳定性理论](@entry_id:177166)优雅且强大，但它本身并未提供一个系统性的方法来寻找这样的函数 $V(\mathbf{x})$。寻找或构造一个合适的李雅普诺夫函数，往往是应用该理论时最具挑战性和创造性的一步。本章的“原理与机制”将深入探讨构造[李雅普诺夫函数](@entry_id:273986)的若干核心原理与关键技术。我们将从最简单的[线性系统](@entry_id:147850)出发，逐步过渡到复杂的非线性系统，并介绍一系列从启发式“猜测”到系统化构造的实用方法。这些方法构成了现代[非线性](@entry_id:637147)控制理论的基石。

### 线性系统的二次型李雅普诺夫函数

对于[线性时不变](@entry_id:276287)（LTI）系统 $\dot{\mathbf{x}} = A\mathbf{x}$，其中 $\mathbf{x} \in \mathbb{R}^n$，$A$ 是一个常数矩阵，最自然也是最常用的一类李雅普诺夫函数候选是二次型函数：
$$
V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}
$$
其中 $P$ 是一个对称正定矩阵。$V(\mathbf{x})$ 的正定性直接由 $P$ 的正定性保证。为了考察其导数 $\dot{V}(\mathbf{x})$ 的性质，我们沿系统轨迹对其求时间导数：
$$
\dot{V}(\mathbf{x}) = \dot{\mathbf{x}}^T P \mathbf{x} + \mathbf{x}^T P \dot{\mathbf{x}}
$$
将 $\dot{\mathbf{x}} = A\mathbf{x}$ 代入，得到：
$$
\dot{V}(\mathbf{x}) = (A\mathbf{x})^T P \mathbf{x} + \mathbf{x}^T P (A\mathbf{x}) = \mathbf{x}^T A^T P \mathbf{x} + \mathbf{x}^T P A \mathbf{x} = \mathbf{x}^T (A^T P + P A) \mathbf{x}
$$
为了使系统是渐近稳定的，我们需要 $\dot{V}(\mathbf{x})$ 是负定的。这等价于要求矩阵 $A^T P + P A$ 是负定的。通常，我们定义一个任意的对称正定矩阵 $Q$，并令：
$$
A^T P + P A = -Q
$$
这个方程被称为**[李雅普诺夫方程](@entry_id:165178)**。因此，对于[LTI系统](@entry_id:271946)，稳定性问题转化为了一个代数问题：给定[系统矩阵](@entry_id:172230) $A$ 和任意一个[对称正定矩阵](@entry_id:136714) $Q$（通常为了简化计算，会选择 $Q=I$，其中 $I$ 是单位矩阵），是否存在一个[对称正定矩阵](@entry_id:136714) $P$ 满足[李雅普诺夫方程](@entry_id:165178)？如果存在这样的 $P$，则原点是全局[渐近稳定](@entry_id:168077)的。

[李雅普诺夫函数](@entry_id:273986) $V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}$ 的几何形态由矩阵 $P$ 决定。如果 $P$ 是[对角矩阵](@entry_id:637782)，例如 $P = \text{diag}(p_1, p_2, \dots, p_n)$，那么[李雅普诺夫函数](@entry_id:273986)就简化为各状态分量加权平方和的形式 $V(\mathbf{x}) = \sum_{i=1}^n p_i x_i^2$。其[等高线](@entry_id:268504)是与坐标轴对齐的椭球。在某些物理系统中，系统参数的特定选择可能导致这种能量函数呈现出特别简洁的“[解耦](@entry_id:637294)”形式。

例如，考虑一个由矩阵 $A$ 描述的二维[LTI系统](@entry_id:271946)，其中 $A$ 包含一个可调参数 $\alpha$ [@problem_id:1088150]。
$$
A = \begin{pmatrix} -k_1  \omega \\ -\omega  -k_2 + \alpha \end{pmatrix}
$$
其中 $k_1, k_2, \omega$ 是正实数。我们希望找到一个 $\alpha$ 值，使得[李雅普诺夫方程](@entry_id:165178) $A^T P + P A = -I$ 的解 $P$ 是一个对角矩阵 $P = \text{diag}(p_1, p_2)$。将 $A$ 和 $P$ 代入方程，我们得到：
$$
\begin{pmatrix} -k_1  -\omega \\ \omega  -k_2+\alpha \end{pmatrix} \begin{pmatrix} p_1  0 \\ 0  p_2 \end{pmatrix} + \begin{pmatrix} p_1  0 \\ 0  p_2 \end{pmatrix} \begin{pmatrix} -k_1  \omega \\ -\omega  -k_2+\alpha \end{pmatrix} = \begin{pmatrix} -1  0 \\ 0  -1 \end{pmatrix}
$$
展开矩阵乘法并相加，可得：
$$
\begin{pmatrix} -2k_1 p_1  \omega(p_1 - p_2) \\ \omega(p_1 - p_2)  -2(k_2 - \alpha)p_2 \end{pmatrix} = \begin{pmatrix} -1  0 \\ 0  -1 \end{pmatrix}
$$
要使这个等式成立，非对角元素必须为零，即 $\omega(p_1 - p_2) = 0$。由于 $\omega$ 通常代表物理系统中的耦合项（如振荡频率），不为零，因此必须有 $p_1 = p_2$。同时，对角元素必须匹配：
$$
-2k_1 p_1 = -1 \implies p_1 = \frac{1}{2k_1}
$$
$$
-2(k_2 - \alpha)p_2 = -1 \implies p_2 = \frac{1}{2(k_2 - \alpha)}
$$
结合 $p_1 = p_2$，我们得到 $\frac{1}{2k_1} = \frac{1}{2(k_2 - \alpha)}$，解得 $\alpha = k_2 - k_1$。这个结果揭示了系统参数之间的一种深刻联系：当参数满足特定关系时，系统的“能量”函数（[李雅普诺夫函数](@entry_id:273986)）可以采取一种物理上直观的、各向同性的形式。

### 非线性系统的二次型李雅普诺夫函数：对消策略

对于非线性系统 $\dot{\mathbf{x}} = \mathbf{f}(\mathbf{x})$，尽管[李雅普诺夫方程](@entry_id:165178)不再直接适用，但二次型函数 $V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}$ 仍然是分析[局部稳定性](@entry_id:751408)的首选候选。其导数为：
$$
\dot{V}(\mathbf{x}) = (\nabla V)^T \mathbf{f}(\mathbf{x}) = (2P\mathbf{x})^T \mathbf{f}(\mathbf{x}) = 2\mathbf{x}^T P \mathbf{f}(\mathbf{x})
$$
与线性情况不同，$\dot{V}(\mathbf{x})$ 通常不再是一个二次型，而是包含与 $\mathbf{f}(\mathbf{x})$ 中[非线性](@entry_id:637147)项相关的高阶项。构造李雅普诺夫函数的关键策略之一，就是通过精心选择 $P$ 的系数，来消除或控制 $\dot{V}(\mathbf{x})$ 中那些符号不定的项（例如，$x_1 x_2$ 这样的[交叉](@entry_id:147634)项），从而使 $\dot{V}$ 的整体符号能够确定下来。

**策略一：调整李雅普诺夫函数的参数**

考虑一个一般的二次型候选函数 $V(x, y) = \frac{1}{2}(ax^2 + by^2)$，其中 $a, b > 0$。我们的目标是选择合适的系数比 $a/b$，以简化 $\dot{V}$。对于一个由以下方程描述的平面非线性系统 [@problem_id:1088128]：
$$
\begin{aligned}
\dot{x} = -x + \alpha y - \mu x^3 \\
\dot{y} = -\beta x - y - \nu y^5
\end{aligned}
$$
其中 $\alpha, \beta, \mu, \nu$ 均为正常数。$\dot{V}$ 的计算如下：
$$
\dot{V} = \frac{\partial V}{\partial x}\dot{x} + \frac{\partial V}{\partial y}\dot{y} = ax\dot{x} + by\dot{y}
$$
$$
\dot{V} = ax(-x + \alpha y - \mu x^3) + by(-\beta x - y - \nu y^5)
$$
展开并整理各项：
$$
\dot{V} = -ax^2 - a\mu x^4 - by^2 - b\nu y^6 + (a\alpha - b\beta)xy
$$
在这个表达式中，$-ax^2, -a\mu x^4, -by^2, -b\nu y^6$ 这些项都是负定的（或半定的）。然而，$xy$ 这一交叉项的符号是不定的，它可能为正也可能为负，这使得我们无法直接判断 $\dot{V}$ 的整体符号。一个非常有效的策略是选择 $a$ 和 $b$ 来消除这个不定项。令其系数为零：
$$
a\alpha - b\beta = 0 \implies \frac{a}{b} = \frac{\beta}{\alpha}
$$
只要我们选择满足此比例的任何正数 $a$ 和 $b$（例如，取 $a=\beta, b=\alpha$），$\dot{V}$ 就简化为 $\dot{V} = -\beta x^2 - \beta\mu x^4 - \alpha y^2 - \alpha\nu y^6$。由于所有系数均为正，这个表达式在原点之外恒为负。因此，我们成功地构造了一个[李雅普诺夫函数](@entry_id:273986)，证明了系统的[渐近稳定性](@entry_id:149743)。

**策略二：调整[系统动力学](@entry_id:136288)的参数**

有时，我们的目标是反过来：给定一个简单的李雅普诺夫函数，如 $V=x_1^2 + x_2^2$，我们想知道系统参数需要满足什么条件才能保证稳定性。这个视角在系统设计和控制中尤为重要。

考虑系统 [@problem_id:1088076]：
$$
\begin{aligned}
\dot{x}_1 = -x_1 - a x_2 + \alpha x_1^2 x_2 \\
\dot{x}_2 = a x_1 - x_2 - x_1^3
\end{aligned}
$$
选择最简单的李雅普诺夫函数 $V(x_1, x_2) = x_1^2 + x_2^2$。其导数为：
$$
\dot{V} = 2x_1\dot{x}_1 + 2x_2\dot{x}_2 = 2x_1(-x_1 - a x_2 + \alpha x_1^2 x_2) + 2x_2(a x_1 - x_2 - x_1^3)
$$
$$
\dot{V} = -2x_1^2 - 2ax_1x_2 + 2\alpha x_1^3 x_2 + 2ax_1x_2 - 2x_2^2 - 2x_1^3 x_2
$$
幸运的是，线性交叉项 $-2ax_1x_2$ 和 $+2ax_1x_2$ 相互抵消了。整理后得到：
$$
\dot{V} = -2x_1^2 - 2x_2^2 + 2(\alpha - 1)x_1^3 x_2
$$
这里的麻烦在于高阶交叉项 $2(\alpha - 1)x_1^3 x_2$。为了使 $\dot{V}$ 尽可能简化为一个负定的二次型，我们可以选择参数 $\alpha$ 来消除这个不定项。令其系数为零：
$$
\alpha - 1 = 0 \implies \alpha = 1
$$
当 $\alpha=1$ 时，$\dot{V} = -2(x_1^2 + x_2^2) = -2V$，这是一个严格的负定函数。这表明，当系统参数 $\alpha=1$ 时，原点是渐近稳定的。

### 超越[渐近稳定性](@entry_id:149743)：[LaSalle不变性原理](@entry_id:266201)

要求 $\dot{V}(\mathbf{x})$ 严格负定是一个非常强的条件，在许多实际系统中难以满足。例如，在存在[能量耗散](@entry_id:147406)但没有位置恢复力的[机械系统](@entry_id:271215)中（如一个仅受[摩擦力](@entry_id:171772)作用在平面上滑动的物体），动能可以作为[李雅普诺夫函数](@entry_id:273986)，其导数（功率）是负半定的（只在静止时为零）。为了处理这类情况，**[LaSalle不变性原理](@entry_id:266201)**提供了一个重要的扩展。

该原理指出：若 $V(\mathbf{x})$ 是一个正定函数，其导数 $\dot{V}(\mathbf{x})$ 在某个区域内是负半定的（即 $\dot{V}(\mathbf{x}) \le 0$），那么从该区域内出发的所有系统轨迹都将收敛到集合 $E = \{\mathbf{x} \mid \dot{V}(\mathbf{x}) = 0\}$ 中的最大**[不变集](@entry_id:275226)**。一个集合是**不变的**，意味着任何从该集合内开始的轨迹将永远停留在该集合内。如果这个最大[不变集](@entry_id:275226)只包含原点 $\mathbf{x}=\mathbf{0}$，那么原点就是渐近稳定的。

LaSalle原理的威力在于，它允许 $\dot{V}$ 在某些地方等于零，只要系统轨迹不会在这些非[平衡点](@entry_id:272705)的零点处“停留”。

**构造满足LaSalle条件的函数**

构造李雅普诺夫函数的策略可以相应调整：我们的目标不再是使 $\dot{V}0$，而是使 $\dot{V} \le 0$，并有意地将 $\dot{V}=0$ 的集合设计得尽可能简单，以便于后续的[不变集](@entry_id:275226)分析。

考虑一个平面系统 [@problem_id:1088093]：
$$
\begin{aligned}
\dot{x} = -y - (x-y)^3 \\
\dot{y} = 2x + 2(x-y)^3
\end{aligned}
$$
我们尝试使用二次型函数 $V(x,y) = ax^2 + y^2$ (其中 $a>0$)。其导数为：
$$
\dot{V} = 2ax\dot{x} + 2y\dot{y} = 2ax(-y - (x-y)^3) + 2y(2x + 2(x-y)^3)
$$
$$
\dot{V} = -2axy + 4xy - 2ax(x-y)^3 + 4y(x-y)^3
$$
整理[交叉](@entry_id:147634)项和高阶项：
$$
\dot{V} = 2(2-a)xy + 2(2y - ax)(x-y)^3
$$
这个表达式看起来很复杂。然而，一个有趣的问题是，我们能否选择 $a$ 使得 $\dot{V}$ 在某个简单的[子空间](@entry_id:150286)（如一条过原点的直线）上恒为零？例如，让我们考察直线 $y=x$。在这条直线上，$x-y=0$，所以 $\dot{V}$ 表达式中的高阶项消失了，剩下：
$$
\dot{V}\big|_{y=x} = 2(2-a)x \cdot x = 2(2-a)x^2
$$
为了让 $\dot{V}$ 在整条直线 $y=x$ 上都为零，我们必须要求其系数为零，即：
$$
2(2-a) = 0 \implies a=2
$$
当 $a=2$ 时，李雅普诺夫函数为 $V = 2x^2 + y^2$。其导数变为 $\dot{V} = 2(2y-2x)(x-y)^3 = -4(x-y)(x-y)^3 = -4(x-y)^4$。这个导数显然是负半定的，因为它恒小于等于零。$\dot{V}=0$ 的集合 $E$ 就是直线 $y=x$。现在我们应用LaSalle原理的第二步：分析 $E$ 上的[不变集](@entry_id:275226)。在 $y=x$ 上，[系统动力学](@entry_id:136288)方程变为：
$$
\dot{x} = -x - (x-x)^3 = -x
$$
$$
\dot{y} = 2x + 2(x-x)^3 = 2x
$$
一个轨迹若要停留在 $y=x$ 这个[不变集](@entry_id:275226)里，它的速度向量 $(\dot{x}, \dot{y})$ 必须始终与该直线相切，即 $\dot{y} = \dot{x}$。但是，我们看到 $\dot{y}=2x$ 而 $\dot{x}=-x$。要使 $\dot{y}=\dot{x}$，必须有 $2x=-x$，这意味着 $x=0$。如果 $x=0$，那么 $y=x$ 也意味着 $y=0$。因此，在 $y=x$ 这条直线上，唯一能让轨迹停留的点就是原点 $(0,0)$。所以，$E$ 中最大的[不变集](@entry_id:275226)就是原点。根据LaSalle原理，原点是渐近稳定的。

这个例子完美地展示了LaSalle原理的应用流程：
1. 构造 $V$ 使得 $\dot{V} \le 0$。
2. 确定集合 $E = \{\mathbf{x} \mid \dot{V}(\mathbf{x})=0\}$。
3. 分析限制在 $E$ 上的[系统动力学](@entry_id:136288)，找出其中最大的[不变集](@entry_id:275226)。
4. 如果该[不变集](@entry_id:275226)仅为原点，则原点是[渐近稳定](@entry_id:168077)的。

一个更复杂的例子是在三维空间中 [@problem_id:1088327]。考虑系统：
$$
\begin{aligned}
\dot{x} = y \\
\dot{y} = -x^3 - y + z \\
\dot{z} = y - \alpha z
\end{aligned}
$$
使用李雅普诺夫函数 $V = \frac{1}{2}x^4 + y^2 + z^2$。其导数为 $\dot{V} = -2(y-z)^2 - 2(\alpha-1)z^2$。为了使 $\dot{V}$ 是负半定的，我们需要 $(\alpha-1)z^2 \ge 0$，且不希望它增加额外的负定项（这会使问题变得平凡）。最有趣的情况是当 $\alpha-1=0$，即 $\alpha=1$ 时。此时，$\dot{V} = -2(y-z)^2 \le 0$。
$\dot{V}=0$ 的集合 $E$ 是平面 $y=z$。现在分析 $E$ 上的[不变集](@entry_id:275226)。在 $y=z$ 上，系统变为：
$$
\dot{x} = y
$$
$$
\dot{y} = -x^3
$$
$$
\dot{z} = y - z = 0
$$
$\dot{z}=0$ 意味着任何停留在 $E$ 中的轨迹，其 $z$ 坐标必须是常数（因此 $y$ 坐标也必须是同一个常数）。但要成为[不变集](@entry_id:275226)，轨迹的所有状态导数都必须为零，或者说轨迹要完全包含在集合内。如果 $y=z=c$（常数），那么 $\dot{y}=0$。代入第二个方程，得到 $-x^3=0 \implies x=0$。如果 $x=0$，第一个方程给出 $\dot{x}=y=c$。但要使 $x$ 保持为0，必须有 $\dot{x}=0$，所以 $c=0$。因此，唯一能让轨迹停留的点是 $(x,y,z) = (0,0,0)$。根据LaSalle原理，原点是[渐近稳定](@entry_id:168077)的。

### [李雅普诺夫函数](@entry_id:273986)的推广：非二次型函数

二次型函数虽然方便，但并非万能。对于含有特定高阶[非线性](@entry_id:637147)项的系统，可能需要构造非二次型的李雅普诺夫函数才能成功证明稳定性。其构造思想与二次型情况类似：让李雅普诺夫函数的形式与系统向量场的形式相匹配，以便在计算 $\dot{V}$ 时能够产生有利的对消。

考虑一个带有高次多项式的系统 [@problem_id:1088133]：
$$
\begin{aligned}
\dot{x}_1 = -x_1^3 + \alpha x_2^5 \\
\dot{x}_2 = -\beta x_1 x_2^2 - \gamma x_2^3
\end{aligned}
$$
其中 $\alpha, \beta, \gamma$ 为正常数。注意到 $\dot{x}_1$ 中有 $x_2^5$ 项，$\dot{x}_2$ 中有 $x_2^2, x_2^3$ 项。这启发我们尝试一个混合阶数的李雅普诺夫函数，如 $V(x_1, x_2) = a x_1^2 + b x_2^4$，其中 $a,b > 0$。选择 $x_2^4$ 而非 $x_2^2$ 的动机在于，它的导数将包含 $x_2^3$ 项，有望与系统中的项相互作用。
计算 $\dot{V}$：
$$
\dot{V} = \frac{\partial V}{\partial x_1}\dot{x}_1 + \frac{\partial V}{\partial x_2}\dot{x}_2 = (2ax_1)\dot{x}_1 + (4bx_2^3)\dot{x}_2
$$
$$
\dot{V} = 2ax_1(-x_1^3 + \alpha x_2^5) + 4bx_2^3(-\beta x_1 x_2^2 - \gamma x_2^3)
$$
展开后得到：
$$
\dot{V} = -2ax_1^4 + 2a\alpha x_1 x_2^5 - 4b\beta x_1 x_2^5 - 4b\gamma x_2^6
$$
将不定符号的[交叉](@entry_id:147634)项 $x_1 x_2^5$ 合并：
$$
\dot{V} = -2ax_1^4 - 4b\gamma x_2^6 + (2a\alpha - 4b\beta)x_1 x_2^5
$$
为了消除这个不定项，我们令其系数为零：
$$
2a\alpha - 4b\beta = 0 \implies \frac{a}{b} = \frac{4\beta}{2\alpha} = \frac{2\beta}{\alpha}
$$
选择满足此比例的 $a,b$，$\dot{V}$ 就简化为 $\dot{V} = -2ax_1^4 - 4b\gamma x_2^6$。由于 $a, b, \gamma$ 均为正，$\dot{V}$ 是负定的。这证明了原点的[渐近稳定性](@entry_id:149743)，并展示了通过匹配函数形式来处理高阶[非线性](@entry_id:637147)的强大能力。

### 系统化构造方法

到目前为止，我们介绍的方法很大程度上依赖于“有根据的猜测”和代数技巧。是否存在更为系统化的方法呢？答案是肯定的。下面我们介绍两种在现代控制理论中占有重要地位的构造方法。

#### 变量梯度法

变量梯度法（Variable Gradient Method）将构造问题从寻找标量函数 $V$ 转化为寻找其[梯度向量](@entry_id:141180)场 $\mathbf{g}(\mathbf{x}) = \nabla V(\mathbf{x})$。其逻辑如下：
1. 我们先“指定”一个期望的 $\dot{V}$ 形式，通常是一个简单的负定函数，例如 $\dot{V} = -\mathbf{x}^T Q \mathbf{x}$。
2. 梯度 $\mathbf{g}$ 和 $\dot{V}$ 通过关系式 $\dot{V} = \mathbf{g}^T \mathbf{f}(\mathbf{x})$ 关联。这通常不足以唯一确定 $\mathbf{g}$。
3. 我们可以对 $\mathbf{g}$ 的某些分量做出一个合理的假设（ansatz），然后利用上述关系式解出其余分量。
4. 一个向量场是某个标量函数的梯度的充要条件是它是**无旋的**。在二维情况下，此条件为 $\frac{\partial g_2}{\partial x_1} = \frac{\partial g_1}{\partial x_2}$；在三维下为 $\nabla \times \mathbf{g} = \mathbf{0}$。我们利用这个条件来确定之前假设中的未知参数。
5. 一旦一个无旋的[梯度场](@entry_id:264143) $\mathbf{g}$ 被确定，相应的李雅普诺夫函数 $V$ 就可以通过对 $\mathbf{g}$ 进行[线积分](@entry_id:141417)得到：$V(\mathbf{x}) = \int_0^\mathbf{x} \mathbf{g}(\mathbf{z})^T d\mathbf{z}$。

让我们通过一个例子来阐明这个过程 [@problem_id:1088097]。考虑系统：
$$
\begin{aligned}
\dot{x_1} = -x_1 - x_2^3 \\
\dot{x_2} = x_1
\end{aligned}
$$
我们设定 $\dot{V} = -x_1^2$。设梯度为 $\mathbf{g} = (g_1, g_2)^T$。关系式为：
$$
\dot{V} = g_1 \dot{x_1} + g_2 \dot{x_2} = g_1(-x_1 - x_2^3) + g_2(x_1) = -x_1^2
$$
现在，我们对梯度的一个分量做出假设，例如，假设 $g_1$ 具有 $g_1(x_1, x_2) = x_1 + \alpha x_2^3$ 的形式，其中 $\alpha$ 是待定常数。将此代入上式解出 $g_2$：
$$
(x_1 + \alpha x_2^3)(-x_1 - x_2^3) + g_2 x_1 = -x_1^2
$$
$$
-x_1^2 - x_1 x_2^3 - \alpha x_1 x_2^3 - \alpha x_2^6 + g_2 x_1 = -x_1^2
$$
$$
g_2 x_1 = (1+\alpha)x_1 x_2^3 + \alpha x_2^6
$$
这个方程需要对所有 $x_1, x_2$ 成立。为了避免 $g_2$ 中出现 $1/x_1$ 这样的奇异项，右侧的项必须能被 $x_1$ 整除。然而，$\alpha x_2^6$ 这一项并不含 $x_1$。为了使等式对所有 $x_1, x_2$ 成立，这个项必须为零，这意味着 $\alpha = 0$。
当 $\alpha=0$ 时，$g_1 = x_1$，且方程变为 $g_2 x_1 = x_1 x_2^3$，所以 $g_2 = x_2^3$。
我们得到的[梯度场](@entry_id:264143)候选为 $\mathbf{g} = (x_1, x_2^3)^T$。现在检查其是否无旋：
$$
\frac{\partial g_1}{\partial x_2} = \frac{\partial}{\partial x_2}(x_1) = 0
$$
$$
\frac{\partial g_2}{\partial x_1} = \frac{\partial}{\partial x_1}(x_2^3) = 0
$$
由于 $\frac{\partial g_1}{\partial x_2} = \frac{\partial g_2}{\partial x_1}$，该[梯度场](@entry_id:264143)是无旋的，确实对应一个[势函数](@entry_id:176105) $V$。通过积分可得 $V(x_1, x_2) = \frac{1}{2}x_1^2 + \frac{1}{4}x_2^4$。这个函数是正定的，其导数 $\dot{V} = -x_1^2$ 是负半定的。利用LaSalle原理可以进一步证明系统的[渐近稳定性](@entry_id:149743)。这个例子展示了变量梯度法如何将构造过程转化为一个更具结构性的代数问题。

#### [克拉索夫斯基方法](@entry_id:172704)

克拉索夫斯基（Krasovskii）方法是另一种系统化方法，适用于 $\mathbf{f}(\mathbf{x})$ 可微且 $\mathbf{f}(\mathbf{0})=\mathbf{0}$ 的系统。该方法直接利用系统的向量场 $\mathbf{f}(\mathbf{x})$ 来构造李雅普诺夫函数：
$$
V(\mathbf{x}) = \mathbf{f}(\mathbf{x})^T P \mathbf{f}(\mathbf{x})
$$
其中 $P$ 是一个对称正定矩阵。如果原点是唯一的[平衡点](@entry_id:272705)，那么 $\mathbf{f}(\mathbf{x})=\mathbf{0}$ 当且仅当 $\mathbf{x}=\mathbf{0}$，因此 $V(\mathbf{x})$ 是正定的。
其导数为 $\dot{V} = \dot{\mathbf{f}}^T P \mathbf{f} + \mathbf{f}^T P \dot{\mathbf{f}}$。利用链式法则，$\dot{\mathbf{f}} = \frac{d\mathbf{f}}{dt} = \frac{\partial \mathbf{f}}{\partial \mathbf{x}}\frac{d\mathbf{x}}{dt} = J(\mathbf{x})\dot{\mathbf{x}} = J(\mathbf{x})\mathbf{f}(\mathbf{x})$，其中 $J(\mathbf{x})$ 是 $\mathbf{f}(\mathbf{x})$ 的雅可比矩阵。代入后得到：
$$
\dot{V} = (J\mathbf{f})^T P \mathbf{f} + \mathbf{f}^T P (J\mathbf{f}) = \mathbf{f}^T (J^T P + P J) \mathbf{f}
$$
为了保证稳定性，我们需要 $\dot{V}$ 是负定的。这引出了克拉索夫斯基稳定性条件：如果存在一个对称正定矩阵 $P$，使得矩阵 $Q(\mathbf{x}) = J(\mathbf{x})^T P + P J(\mathbf{x})$ 对所有 $\mathbf{x} \neq \mathbf{0}$ 都是负定的，那么原点是（全局）渐近稳定的。

该方法将[非线性系统的稳定性](@entry_id:264568)问题转化为了一个对依赖于状态 $\mathbf{x}$ 的矩阵 $Q(\mathbf{x})$ 的负定性检验。

考虑系统 [@problem_id:1088273]：
$$
\mathbf{f}(\mathbf{x}) = \begin{pmatrix} -2x_1 + x_2 - x_1^3 \\ -\alpha x_1 - 3x_2 - x_2^5 \end{pmatrix}
$$
我们使用[克拉索夫斯基方法](@entry_id:172704)并选择最简单的 $P=I$。首先计算雅可比矩阵：
$$
J(\mathbf{x}) = \begin{pmatrix} -2-3x_1^2  1 \\ -\alpha  -3-5x_2^4 \end{pmatrix}
$$
然后构造 $Q(\mathbf{x})$:
$$
Q(\mathbf{x}) = J(\mathbf{x})^T I + I J(\mathbf{x}) = J(\mathbf{x})^T + J(\mathbf{x}) = \begin{pmatrix} -4-6x_1^2  1-\alpha \\ 1-\alpha  -6-10x_2^4 \end{pmatrix}
$$
要使 $Q(\mathbf{x})$ 对所有 $\mathbf{x}$ 都是负定的，需要其主子式满足西尔维斯特判据（Sylvester's criterion）：
1.  第一个主子式（左上角元素）必须为负：$-4-6x_1^2  0$。这个条件对所有 $x_1$ 都成立。
2.  第二个主子式（[行列式](@entry_id:142978)）必须为正：$\det(Q(\mathbf{x})) > 0$。
$$
\det(Q(\mathbf{x})) = (-4-6x_1^2)(-6-10x_2^4) - (1-\alpha)^2 > 0
$$
$$
(4+6x_1^2)(6+10x_2^4) - (1-\alpha)^2 > 0
$$
这个不等式必须对所有 $x_1, x_2$ 成立。我们需要找到这个表达式的最小值，并确保它大于零。其最小值显然在 $x_1=0, x_2=0$ 时取得：
$$
\min_{\mathbf{x}} \det(Q(\mathbf{x})) = (4)(6) - (1-\alpha)^2 = 24 - (1-\alpha)^2
$$
为了保证全局负定性，我们要求 $24 - (1-\alpha)^2 > 0$，即 $(1-\alpha)^2  24$。
解这个不等式得到 $-\sqrt{24}  1-\alpha  \sqrt{24}$，即 $1 - 2\sqrt{6}  \alpha  1 + 2\sqrt{6}$。
这个[开区间](@entry_id:157577)的长度为 $(1+2\sqrt{6}) - (1-2\sqrt{6}) = 4\sqrt{6}$。在此参数范围内，系统原点是全局渐近稳定的。

### 理论的扩展与应用

李雅普诺夫理论不仅能证明稳定性，还能用于证明不稳定性以及量化稳定性的程度（即[吸引域](@entry_id:172179)的大小）。

#### 利用Четаев定理证明不稳定性

与[李雅普诺夫第二方法](@entry_id:168377)相对应，Четаев（Chetaev）定理为证明不稳定性提供了有力的工具。该定理指出：如果能在[平衡点](@entry_id:272705)的任意小邻域内找到一个区域，使得在该区域内存在一个函数 $V(\mathbf{x})$（称为Четаев函数）及其导数 $\dot{V}(\mathbf{x})$ 始终为正，并且该区域的边界上 $V(\mathbf{x})=0$，那么从该区域内出发的轨迹将被“推”离[平衡点](@entry_id:272705)，导致不稳定性。

一个典型的例子是分析[鞍点](@entry_id:142576)（saddle point）的不稳定性。对于一个线性化后具有一个正[特征值](@entry_id:154894)和一个负[特征值](@entry_id:154894)的系统，其[相图](@entry_id:144015)在原点附近呈现鞍状。一个合适的Четаев函数候选是 $V(x_1, x_2) = x_1^2 - x_2^2$。在 $V>0$ 的区域（即 $|x_1| > |x_2|$），如果能证明 $\dot{V}>0$，那么系统就是不稳定的。

考虑系统 [@problem_id:1088144]：
$$
\begin{aligned}
\dot{x}_1 = \frac{\lambda}{2} x_1 + \beta x_2 + \gamma x_2 (x_1-x_2) \\
\dot{x}_2 = \alpha x_1 + \frac{\lambda}{2} x_2 + \gamma x_1 (x_1-x_2)
\end{aligned}
$$
其中 $\lambda, \beta, \gamma$ 是正数。我们选择Четаев函数 $V = x_1^2 - x_2^2$ 并计算其导数：
$$
\dot{V} = 2x_1\dot{x}_1 - 2x_2\dot{x}_2
$$
代入系统方程并化简，可以发现许多高次项恰好抵消：
$$
\dot{V} = 2x_1\left(\frac{\lambda}{2} x_1 + \beta x_2\right) - 2x_2\left(\alpha x_1 + \frac{\lambda}{2} x_2\right) + [2\gamma x_1x_2(x_1-x_2) - 2\gamma x_1x_2(x_1-x_2)]
$$
$$
\dot{V} = \lambda x_1^2 + 2\beta x_1x_2 - 2\alpha x_1x_2 - \lambda x_2^2 = \lambda(x_1^2 - x_2^2) + 2(\beta - \alpha)x_1x_2
$$
$$
\dot{V} = \lambda V + 2(\beta - \alpha)x_1x_2
$$
为了得到一个清晰的不[稳定性判据](@entry_id:755304)，我们希望 $\dot{V}$ 的符号与 $V$ 直接相关。如果能消除交叉项，结论将变得非常优雅。为此，我们设置 $\beta - \alpha = 0$，即 $\alpha = \beta$。
在这种情况下，我们得到一个非常简洁的关系：$\dot{V} = \lambda V$。
因为 $\lambda > 0$，这个关系意味着在 $V>0$ 的区域，$\dot{V}>0$；在 $V0$ 的区域，$\dot{V}0$。根据Четаев定理，原点是不稳定的。这表明，当系统参数满足特定对称性时，不稳定性的“增长率”可以与Четаев函数本身成正比。

#### 估计[吸引域](@entry_id:172179)

对于一个[渐近稳定](@entry_id:168077)的[平衡点](@entry_id:272705)，一个至关重要的问题是：从多大的范围内的初始点出发，系统最终会回到这个[平衡点](@entry_id:272705)？这个范围被称为**[吸引域](@entry_id:172179)**（Region of Attraction, ROA）。李雅普诺夫函数为我们提供了一种估计[吸引域](@entry_id:172179)的系统方法。

其原理是：如果我们找到了一个李雅普诺夫函数 $V(\mathbf{x})$，并且能确定一个区域 $\Omega$，使得在 $\Omega$ 内部（不包括原点），$\dot{V}(\mathbf{x})  0$，那么包含在 $\Omega$ 内的任何 $V$ 的水平集 $S_c = \{\mathbf{x} \mid V(\mathbf{x}) \le c\}$ 都是[吸引域](@entry_id:172179)的一个估计。为了得到尽可能大的估计，我们希望找到最大的 $c$ 值，使得 $S_c \subseteq \Omega$。这个最大的 $c$ 值，$c_{\text{max}}$，通常由 $V$ 在 $\Omega$ 边界上的最小值决定，而 $\Omega$ 的边界通常是集合 $\{\mathbf{x} \mid \dot{V}(\mathbf{x}) = 0\}$。

有趣的是，李雅普诺夫函数的选择不仅影响我们能否证明稳定性，还直接影响我们得到的[吸引域估计](@entry_id:178734)的大小和形状。一个“好”的李雅普诺夫函数，应该使其水平集尽可能地贴合真实的[吸引域](@entry_id:172179)边界。

考虑系统 [@problem_id:1088134]：
$$
\begin{aligned}
\dot{x_1} = -x_1 + x_2 \\
\dot{x_2} = -x_1 - x_2 + x_2^3
\end{aligned}
$$
我们使用带参数的[李雅普诺夫函数](@entry_id:273986) $V(x_1, x_2) = x_1^2 + \alpha x_2^2$（$\alpha>0$）来估计[吸引域](@entry_id:172179)。其导数为：
$$
\dot{V} = 2x_1(-x_1+x_2) + 2\alpha x_2(-x_1-x_2+x_2^3) = -2x_1^2 + (2-2\alpha)x_1x_2 - 2\alpha x_2^2 + 2\alpha x_2^4
$$
这是一个复杂的表达式。为了简化分析，一个常见的方法是找到使[交叉](@entry_id:147634)项消失的 $\alpha$ 值，即 $2-2\alpha=0 \implies \alpha=1$。在这种情况下，$\dot{V} = -2x_1^2 - 2x_2^2 + 2x_2^4 = -2(x_1^2+x_2^2-x_2^4)$。$\dot{V}0$ 的区域是 $x_1^2+x_2^2-x_2^4 > 0$。

然而，这个问题提出了一个更具挑战性的目标：选择 $\alpha$ 来最大化所估计的[吸引域](@entry_id:172179)（一个椭圆区域 $x_1^2 + \alpha x_2^2 \le c$）的面积 $A = \frac{\pi c}{\sqrt{\alpha}}$。这是一个[优化问题](@entry_id:266749)，需要在保证 $\dot{V}0$ 的前提下，权衡 $c$ 和 $\alpha$ 的取值。通过详细分析（例如，使用[拉格朗日乘子法](@entry_id:176596)寻找 $V$ 在 $\dot{V}=0$ 曲线上的最小值 $c_{\text{max}}$），可以发现当 $\alpha=3$ 时，估计的面积达到最大值 [@problem_id:1088134]。这个例子深刻地说明，构造李雅普诺夫函数不仅是一门科学，也是一门艺术，其目标可能不仅仅是证明稳定性，还包括获得关于系统行为的定量信息。

本章通过一系列原理和实例，揭示了构造李雅普诺夫函数的多种策略。从简单的二次型函数到匹配系统特性的非二次型函数，从启发式的对消策略到变量梯度法和[克拉索夫斯基方法](@entry_id:172704)等系统化工具，再到 LaSalle 原理、Четаев 不稳定性定理和[吸引域估计](@entry_id:178734)等理论扩展，我们看到，[李雅普诺夫函数的构造](@entry_id:177727)是一个充满洞察力和技巧的领域，是连接抽象数学理论与具体工程应用的关键桥梁。