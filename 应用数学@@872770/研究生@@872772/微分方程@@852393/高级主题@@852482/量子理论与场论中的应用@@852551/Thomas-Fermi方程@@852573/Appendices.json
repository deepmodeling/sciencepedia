{"hands_on_practices": [{"introduction": "托马斯-费米方程是一个非线性微分方程，没有已知的解析解。为了真正理解作为该模型核心的通用势函数 $\\phi(x)$，我们必须对其进行数值计算。本练习将指导您使用有限差分法和牛顿法来求解这个具有挑战性的边值问题，将一个抽象的方程转化为具体、可用的函数。", "problem": "考虑球对称中性原子的托马斯-费米模型。无量纲化后，有效势 $ \\phi(x) $ 满足如下奇异非线性边值问题：\n$$\n\\phi''(x) \\;=\\; \\frac{\\phi(x)^{3/2}}{\\sqrt{x}}, \\qquad x \\in (0,\\infty),\n$$\n边界条件为\n$$\n\\phi(0)=1, \\qquad \\phi(\\infty)=0,\n$$\n以及物理要求 $ \\phi(x) \\ge 0 $ 且 $ \\phi(x) $ 是单调递减的。$ x=0 $ 处的奇异性源于非线性项前的因子 $ 1/\\sqrt{x} $，但解在 $ \\phi(0) $ 有限且 $ \\phi'(0) $ 有限的意义下保持有限和光滑。为进行数值计算，将域截断为有限区间 $ x \\in [0,L] $，并使用边界条件 $ \\phi(L)=0 $，其中 $ L>0 $ 的取值应足够大以确保 $ \\phi(L) \\approx 0 $。使用一个包含 $ N $ 个区间的均匀网格，网格点为 $ x_i = i h $，$ i=0,1,\\dots,N $，其中 $ h=L/N $。通过在 $ x_0=0 $ 和 $ x_N=L $ 处强制施加边界值来处理奇异性，并仅在 $ x_i>0 $ 的内部节点 $ i=1,2,\\dots,N-1 $ 上对微分方程进行离散化。\n\n仅从二阶导数作为对称差商极限的基本定义以及导数的幂次法则出发，推导该问题在均匀网格上的二阶精度有限差分格式。针对内部未知数 $ \\{\\phi_i\\}_{i=1}^{N-1} $，结合边界值 $ \\phi_0=1 $ 和 $ \\phi_N=0 $，构建所得到的非线性代数方程组。然后，设计并实现一个牛顿迭代法，该方法在每个迭代步中线性化非线性残差，并求解所产生的三对角线性系统。使用阻尼（线搜索）策略以在迭代过程中保持 $ \\phi_i \\ge 0 $。当内部残差向量的无穷范数低于容差 $ \\varepsilon $ 时，或达到最大迭代次数时，您的实现必须停止。您可以假定 $ \\varepsilon = 10^{-10} $ 并设置一个足够大的迭代次数上限以确保收敛。\n\n测试集：\n- 情况 $ A $ (理想情况)：$ L=20 $, $ N=400 $。\n- 情况 $ B $ (更紧的域截断)：$ L=10 $, $ N=200 $。\n- 情况 $ C $ (更粗的网格和更紧的截断)：$ L=5 $, $ N=100 $。\n\n对于每种情况，计算以下两个标量诊断量：\n- 由单边差分 $ (\\phi_1-\\phi_0)/h $ 估算的近似初始斜率 $ \\phi'(0) $。\n- 通过对 $ x=1 $ 周围最近的两个网格点上的网格值进行线性插值得到的 $ \\phi(1) $ 值（如果 $ x=1 $ 与某个网格点重合，则直接使用该网格点的值）。\n\n所有量均为无量纲。您的程序应生成单行输出，其中包含按以下顺序排列的结果，形式为用方括号括起来的逗号分隔列表：\n$$\n[\\;\\phi'_A(0),\\;\\phi_A(1),\\;\\phi'_B(0),\\;\\phi_B(1),\\;\\phi'_C(0),\\;\\phi_C(1)\\;].\n$$\n不应打印任何额外文本。所有计算都必须使用双精度浮点运算进行。", "solution": "所提出的问题是计算原子物理学中一个适定的、有科学依据的边值问题。它要求对托马斯-费米方程进行数值求解，这是一个在原点处具有奇异性的非线性二阶常微分方程。所有参数和要求都已明确指定，构成了一个完整且一致的陈述。该任务是有效的，我将着手解决它。\n\n问题的核心是求解非线性边值问题\n$$\n\\phi''(x) \\;=\\; \\frac{\\phi(x)^{3/2}}{\\sqrt{x}}, \\qquad x \\in (0,L]\n$$\n边界条件为 $\\phi(0)=1$ 和 $\\phi(L)=0$。我们需要推导一个二阶精度的有限差分格式，并使用牛顿法求解得到的非线性代数方程组。\n\n首先，我们对域进行离散化。我们引入一个包含 $N$ 个区间的均匀网格，使得网格间距为 $h=L/N$。网格点为 $x_i = ih$，$i=0, 1, \\dots, N$。我们将这些点上解的数值近似记为 $\\phi_i \\approx \\phi(x_i)$。给定的边界条件规定了 $\\phi_0 = 1$ 和 $\\phi_N = 0$。未知数是内部网格点上的值 $\\{\\phi_i\\}_{i=1}^{N-1}$。\n\n问题要求从二阶导数的基本定义出发进行推导。一阶导数定义为 $\\phi'(x) = \\lim_{\\delta \\to 0} \\frac{\\phi(x+\\delta/2) - \\phi(x-\\delta/2)}{\\delta}$。再次应用此定义可得到对称的二阶导数：\n$$\n\\phi''(x) = \\lim_{h \\to 0} \\frac{\\phi'(x+h/2) - \\phi'(x-h/2)}{h} = \\lim_{h \\to 0} \\frac{\\left(\\frac{\\phi(x+h)-\\phi(x)}{h}\\right) - \\left(\\frac{\\phi(x)-\\phi(x-h)}{h}\\right)}{h} = \\lim_{h \\to 0} \\frac{\\phi(x+h) - 2\\phi(x) + \\phi(x-h)}{h^2}\n$$\n对于一个小的但有限的 $h$，这给出了网格点 $x_i$ 处二阶导数的二阶精度中心差分近似：\n$$\n\\phi''(x_i) \\approx \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\n我们在内部网格点 $x_i$ ($i=1, 2, \\dots, N-1$) 上对微分方程进行离散化，在这些点上 $x_i > 0$ 且方程是良定义的。将有限差分近似代入托马斯-费米方程，得到一个包含 $N-1$ 个非线性代数方程的方程组：\n$$\n\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2} = \\frac{\\phi_i^{3/2}}{\\sqrt{x_i}}, \\qquad i=1, 2, \\dots, N-1\n$$\n为求解该系统，我们为每个内部节点定义一个残差函数 $F_i$，对于一个解，该函数必须为零：\n$$\nF_i(\\phi_1, \\dots, \\phi_{N-1}) = \\phi_{i-1} - 2\\phi_i + \\phi_{i+1} - \\frac{h^2}{\\sqrt{ih}} \\phi_i^{3/2} = 0\n$$\n在这里，$\\phi_0=1$ 和 $\\phi_N=0$ 是已知常数。我们可以将这些方程组合成一个向量方程 $\\vec{F}(\\vec{\\Phi}) = \\vec{0}$，其中 $\\vec{\\Phi} = [\\phi_1, \\phi_2, \\dots, \\phi_{N-1}]^T$ 是由 $M=N-1$ 个未知数组成的向量。\n\n这个非线性系统使用牛顿法求解。给定第 $k$ 次迭代的近似解 $\\vec{\\Phi}^{(k)}$，下一个近似解 $\\vec{\\Phi}^{(k+1)}$ 通过求解线性化系统得到更新量 $\\Delta\\vec{\\Phi}^{(k)}$：\n$$\nJ(\\vec{\\Phi}^{(k)}) \\Delta\\vec{\\Phi}^{(k)} = -\\vec{F}(\\vec{\\Phi}^{(k)})\n$$\n然后解按 $\\vec{\\Phi}^{(k+1)} = \\vec{\\Phi}^{(k)} + \\alpha \\Delta\\vec{\\Phi}^{(k)}$ 进行更新，其中 $\\alpha \\in (0,1]$ 是一个阻尼因子。矩阵 $J$ 是 $\\vec{F}$ 的雅可比矩阵，其元素为 $J_{ij} = \\frac{\\partial F_i}{\\partial \\phi_j}$。该系统的结构使得 $F_i$ 仅依赖于 $\\phi_{i-1}, \\phi_i, \\phi_{i+1}$，这使得雅可比矩阵是三对角的。根据要求，使用导数的幂次法则 $(\\frac{d}{du} u^n = n u^{n-1})$ 推导非零元素：\n次对角线 ($j = i-1$):\n$$\n\\frac{\\partial F_i}{\\partial \\phi_{i-1}} = 1\n$$\n主对角线 ($j=i$):\n$$\n\\frac{\\partial F_i}{\\partial \\phi_i} = -2 - \\frac{h^2}{\\sqrt{ih}} \\frac{\\partial}{\\partial \\phi_i}(\\phi_i^{3/2}) = -2 - \\frac{h^2}{\\sqrt{ih}} \\left(\\frac{3}{2} \\phi_i^{1/2}\\right) = -2 - \\frac{3h^{3/2}}{2\\sqrt{i}} \\sqrt{\\phi_i}\n$$\n超对角线 ($j=i+1$):\n$$\n\\frac{\\partial F_i}{\\partial \\phi_{i+1}} = 1\n$$\n在每个牛顿迭代步中，我们组装这个三对角雅可比矩阵和残差向量，使用高效的三对角求解器求解线性系统以获得 $\\Delta\\vec{\\Phi}^{(k)}$，然后找到一个合适的阻尼因子 $\\alpha$。物理约束 $\\phi(x) \\ge 0$ 要求更新后的解向量 $\\vec{\\Phi}^{(k+1)}$ 的所有分量保持非负。采用一种简单的回溯线搜索方法：我们从 $\\alpha=1$ 开始，并相继将其减半，直到满足条件 $\\vec{\\Phi}^{(k)} + \\alpha \\Delta\\vec{\\Phi}^{(k)} \\ge \\vec{0}$。\n\n作为初始猜测，我们使用连接边界条件的线性剖面：$\\phi_i^{(0)} = 1 - x_i/L = 1-i/N$。迭代将持续进行，直到残差向量的无穷范数 $||\\vec{F}||_\\infty = \\max_{i} |F_i|$ 小于容差 $\\varepsilon=10^{-10}$。\n\n收敛后，我们得到解向量 $\\vec{\\Phi}$。由此，我们计算所需的诊断量：\n1. 初始斜率 $\\phi'(0)$ 使用与可用网格值一致的一阶向前差分进行近似：$\\phi'(0) \\approx \\frac{\\phi_1 - \\phi_0}{h}$。\n2. 确定 $\\phi(1)$ 的值。对于给定的测试用例，$x=1$ 与一个网格点 $x_k = kh = 1$ 重合。该值就是计算出的网格值 $\\phi_k$。如果它不是网格点，则将使用两个包围网格值之间的线性插值：$\\phi(1) \\approx \\phi_{i_{\\text{low}}} + (\\phi_{i_{\\text{high}}} - \\phi_{i_{\\text{low}}})(1-x_{i_{\\text{low}}})/h$。\n\n至此，完成了根据问题陈述求解托马斯-费米方程的推导和算法说明。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to solve the Thomas-Fermi equation for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (20.0, 400), # Case A\n        (10.0, 200), # Case B\n        (5.0, 100),  # Case C\n    ]\n\n    results = []\n    \n    # Parameters for the numerical method\n    epsilon = 1e-10\n    max_iter = 100\n\n    for L, N in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        h = L / N\n        M = N - 1 # Number of interior points\n\n        # Grid for interior points\n        x_interior = np.arange(1, N) * h\n        \n        # Initial guess: linear profile from phi(0)=1 to phi(L)=0\n        phi = 1.0 - x_interior / L\n\n        # Newton's method iteration\n        for k in range(max_iter):\n            # Ensure phi is non-negative for the sqrt in the Jacobian\n            phi[phi  0] = 0\n\n            # 1. Compute residual vector F\n            F = np.zeros(M)\n            \n            # Nonlinear term f(phi) = phi^(3/2) / sqrt(x)\n            f_phi = phi**1.5 / np.sqrt(x_interior)\n            \n            # Assemble residual vector F\n            # F[i] = (phi_{i-1} - 2*phi_i + phi_{i+1})/h^2 - f(phi_i)\n            # Rearranged: h^2 * F_i = phi_{i-1} - 2*phi_i + phi_{i+1} - h^2 * f(phi_i)\n            # We solve for the root of this scaled residual.\n            \n            # For i=1 (j=0 in 0-based index)\n            # phi_0 - 2*phi_1 + phi_2 - h^2 * f(phi_1)\n            # phi_0 = 1\n            F[0] = 1.0 - 2.0 * phi[0] + phi[1] - h**2 * f_phi[0]\n            \n            # For i=2,...,N-2 (j=1,...,M-2)\n            # phi_{i-1} - 2*phi_i + phi_{i+1} - h^2 * f(phi_i)\n            F[1:-1] = phi[:-2] - 2.0 * phi[1:-1] + phi[2:] - h**2 * f_phi[1:-1]\n\n            # For i=N-1 (j=M-1)\n            # phi_{N-2} - 2*phi_{N-1} + phi_N - h^2 * f(phi_{N-1})\n            # phi_N = 0\n            F[-1] = phi[-2] - 2.0 * phi[-1] - h**2 * f_phi[-1]\n            \n            # 2. Check for convergence\n            residual_norm = np.linalg.norm(F, np.inf)\n            if residual_norm  epsilon:\n                break\n\n            # 3. Compute Jacobian matrix J in banded format\n            # J_ii = -2 - (3/2) * h^2 * phi_i^(1/2) / sqrt(x_i)\n            diag_prime = -1.5 * h**1.5 * np.sqrt(phi) / np.sqrt(np.arange(1, N))\n            \n            ab = np.zeros((3, M))\n            ab[0, 1:] = 1.0   # Super-diagonal\n            ab[1, :] = -2.0 + diag_prime # Main diagonal\n            ab[2, :-1] = 1.0  # Sub-diagonal\n            \n            # 4. Solve the linear system J * delta_phi = -F\n            delta_phi = solve_banded((1, 1), ab, -F)\n            \n            # 5. Damping (line search) to ensure phi >= 0\n            alpha = 1.0\n            for _ in range(10): # Max 10 halvings of alpha\n                phi_next = phi + alpha * delta_phi\n                if np.all(phi_next >= 0):\n                    break\n                alpha /= 2.0\n            else:\n                # This should not happen with a good initial guess\n                # If it does, the iteration has failed.\n                # For this problem, we can assume it converges.\n                pass\n            \n            phi = phi_next\n\n        # After convergence, calculate diagnostic quantities\n        # phi_0 = 1.0, phi_1 = phi[0]\n        slope_at_0 = (phi[0] - 1.0) / h\n\n        # Calculate phi(1.0)\n        idx_float = 1.0 / h\n        if np.isclose(idx_float, np.round(idx_float)):\n            idx = int(np.round(idx_float))\n            # Grid point x_idx = 1.0. The value is phi_idx.\n            # phi is vector of phi_1, ..., phi_{N-1}\n            # so phi_idx corresponds to phi[idx-1]\n            if idx == 0:\n                 phi_at_1 = 1.0\n            else:\n                 phi_at_1 = phi[idx - 1]\n        else:\n            # Linear interpolation\n            i_low = int(np.floor(idx_float))\n            # x_low = i_low * h\n            \n            if i_low == 0:\n                phi_low = 1.0\n            else:\n                phi_low = phi[i_low-1]\n            \n            i_high = i_low + 1\n            phi_high = phi[i_high-1]\n            \n            # phi_at_1 = phi_low + (phi_high - phi_low) * (1.0 - x_low)/h\n            phi_at_1 = phi_low + (phi_high - phi_low) * (1.0 - i_low * h) / h\n\n        results.extend([slope_at_0, phi_at_1])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2392752"}, {"introduction": "托马斯-费米模型的应用范围不止于中性原子，也同样适用于离子。其关键区别在于边界条件，这些条件编码了有限电子云和净电荷的物理特性。本练习将展示解在离子边界处的数学性质——即势函数 $\\chi(x_0)$ 的值及其导数 $\\chi'(x_0)$——与一个基本物理性质“电离度”之间的深刻联系。", "problem": "托马斯-费米模型为多电子原子中的电子分布提供了一种半经典描述。该模型用一个通用的托马斯-费米函数 $\\chi(x)$ 来表述，该函数与电子在距离电荷为 $Ze$ 的原子核 $r$ 处所感受到的平均静电势 $\\phi(r)$ 相关。关系式如下：\n$$ \\phi(r) = \\frac{Ze}{4\\pi\\epsilon_0 r}\\chi(x) $$\n此处，$e$ 是基本电荷，$\\epsilon_0$ 是真空介电常数，$x$ 是由 $r = bx$ 定义的无量纲半径，其中标度因子 $b$ 取决于 $Z$。函数 $\\chi(x)$ 是被称为托马斯-费米方程的非线性常微分方程的解：\n$$ \\frac{d^2\\chi}{dx^2} = \\frac{\\chi(x)^{3/2}}{\\sqrt{x}} $$\n对于任何原子或离子，根据在短距离处势必须由原子核主导的要求，可以导出一个通用的边界条件，即 $\\chi(0) = 1$。\n\n对于一个有 $Z$ 个质子和 $N$ 个电子的正离子，其电子云被限制在一个有限的半径 $r_0$ 内（对应于无量纲半径 $x_0 = r_0/b$）。当距离 $r  r_0$ 时，静电势是一个净点电荷 $(Z-N)e$ 所产生的势。通过确保在边界 $r=r_0$ 处电场的连续性，可以建立起电离度 $q = (Z-N)/Z$、函数 $\\chi(x_0)$ 及其导数 $\\chi'(x_0)$ 之间的一般关系。\n\n考虑一个假设的正离子，它处于这样一个状态：在其边界半径 $x_0$ 处，托马斯-费米函数及其导数满足以下特定条件：\n1. $\\chi(x_0) = 1/3$\n2. $\\chi'(x_0) = -\\frac{1}{2x_0}$\n\n基于这些条件，推导出该离子的电离度 $q = (Z-N)/Z$ 的数值。", "solution": "我们从TF模型中的静电势开始，\n$$\n\\phi(r)=\\frac{Ze}{4\\pi\\epsilon_0\\,r}\\,\\chi(x),\n\\quad x=\\frac{r}{b}.\n$$\n电场为 $E=-\\dfrac{d\\phi}{dr}$。求导可得，\n$$\n\\frac{d\\phi}{dr}\n=\\frac{Ze}{4\\pi\\epsilon_0}\\Bigl[-\\frac{\\chi(x)}{r^2}\n+\\frac{1}{r}\\frac{d\\chi}{dx}\\frac{dx}{dr}\\Bigr]\n=\\frac{Ze}{4\\pi\\epsilon_0}\\Bigl[-\\frac{\\chi(x)}{r^2}\n+\\frac{\\chi'(x)}{b\\,r}\\Bigr].\n$$\n因此\n$$\nE_{\\rm int}(r)\n=-\\frac{d\\phi}{dr}\n=\\frac{Ze}{4\\pi\\epsilon_0}\\Bigl[\\frac{\\chi(x)}{r^2}\n-\\frac{\\chi'(x)}{b\\,r}\\Bigr].\n$$\n在离子外部（$rr_0$），电场是点电荷 $(Z-N)e=Zq\\,e$ 产生的电场，\n$$\nE_{\\rm ext}(r_0)\n=\\frac{Zq\\,e}{4\\pi\\epsilon_0\\,r_0^2}.\n$$\n连续性条件 $E_{\\rm int}(r_0)=E_{\\rm ext}(r_0)$ 给出\n$$\n\\frac{Ze}{4\\pi\\epsilon_0}\\Bigl[\\frac{\\chi(x_0)}{r_0^2}\n-\\frac{\\chi'(x_0)}{b\\,r_0}\\Bigr]\n=\\frac{Zq\\,e}{4\\pi\\epsilon_0\\,r_0^2}\n\\;\\Longrightarrow\\;\nq=\\chi(x_0)-x_0\\,\\chi'(x_0).\n$$\n将 $\\chi(x_0)=\\frac13$ 和 $\\chi'(x_0)=-\\frac1{2x_0}$ 代入，得到\n$$\nq=\\frac13 - x_0\\Bigl(-\\frac1{2x_0}\\Bigr)\n=\\frac13+\\frac12\n=\\frac56.\n$$", "answer": "$$\\boxed{5/6}$$", "id": "1162115"}, {"introduction": "一旦我们得到了通用的托马斯-费米函数（无论是通过数值求解还是近似），我们就可以对原子结构进行定量预测。这个问题利用了该函数在远距离处的著名渐近行为来计算特定半径外的电子数。这项练习展示了该模型尽管有其简化假设，但仍然能为我们提供关于重原子中电子空间分布的宝贵见解。", "problem": "托马斯-费米模型为原子序数 $Z \\gg 1$ 的重的中性原子中的电子云提供了一种统计描述。在该模型中，电子被视为处于自洽静电势中的简并费米气体。该模型导出了一个普适的无量纲势函数 $\\phi(x)$，它满足托马斯-费米方程：\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{\\phi(x)^{3/2}}{\\sqrt{x}}\n$$\n距原子核的径向距离 $r$ 通过 $r=bx$ 与无量纲变量 $x$ 相关，其中标度因子 $b$ 由下式给出：\n$$\nb = \\left(\\frac{9\\pi^2}{128}\\right)^{1/3} \\frac{a_0}{Z^{1/3}}\n$$\n且 $a_0$ 是玻尔半径。对于中性原子，势函数的边界条件为 $\\phi(0) = 1$ 和 $\\phi(\\infty) = 0$。\n\n电子数密度 $n(r)$ 可以用 $\\phi(x)$ 表示为：\n$$\nn(r) = \\frac{Z}{4\\pi b^3} \\frac{\\phi(x)^{3/2}}{x^{3/2}}\n$$\n对于大的 $x$ 值，普适函数 $\\phi(x)$ 具有熟知的渐近行为：\n$$\n\\phi(x) \\approx \\frac{144}{x^3}\n$$\n使用该模型，推导在径向距离大于第一玻尔半径 $r  a_0$ 处的电子总数 $N_{out}(a_0)$ 的表达式。结果将是一个与 $Z$ 无关的常数。", "solution": "问题要求解在第一玻尔半径 $a_0$ 以外的电子数。这个量 $N_{out}(a_0)$ 是通过将电子数密度 $n(r)$ 从 $r=a_0$ 积分到无穷大得到的。\n$$\nN_{out}(a_0) = \\int_{a_0}^{\\infty} n(r) 4\\pi r^2 dr\n$$\n我们已知电子数密度 $n(r)$ 用托马斯-费米函数 $\\phi(x)$ 表示的表达式：\n$$\nn(r) = \\frac{Z}{4\\pi b^3} \\frac{\\phi(x)^{3/2}}{x^{3/2}}\n$$\n我们可以使用托马斯-费米方程本身 $\\frac{d^2\\phi}{dx^2} = \\frac{\\phi^{3/2}}{\\sqrt{x}}$ 来简化 $n(r)$ 的表达式：\n$$\n\\phi(x)^{3/2} = \\sqrt{x} \\frac{d^2\\phi}{dx^2}\n$$\n将此代入 $n(r)$ 的表达式：\n$$\nn(r) = \\frac{Z}{4\\pi b^3} \\frac{\\sqrt{x} \\phi''(x)}{x^{3/2}} = \\frac{Z}{4\\pi b^3} \\frac{\\phi''(x)}{x}\n$$\n现在，将这个简化的密度代入 $N_{out}(a_0)$ 的积分中。我们还必须将积分变量从 $r$ 变为 $x$。关系式为 $r = bx$，因此 $dr = bdx$。积分下限 $r=a_0$ 对应于标度坐标 $X_0 = a_0/b$。\n$$\nN_{out}(a_0) = \\int_{X_0}^{\\infty} \\left( \\frac{Z}{4\\pi b^3} \\frac{\\phi''(x)}{x} \\right) 4\\pi (bx)^2 (b dx)\n$$\n简化积分内的各项：\n$$\nN_{out}(a_0) = Z \\int_{X_0}^{\\infty} \\frac{1}{4\\pi b^3} \\frac{\\phi''(x)}{x} 4\\pi b^2 x^2 b dx = Z \\int_{X_0}^{\\infty} x \\phi''(x) dx\n$$\n这个积分可以用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$ 求解。令 $u=x$ 和 $dv = \\phi''(x)dx$，可得 $du=dx$ 和 $v=\\phi'(x)$。\n$$\n\\int_{X_0}^{\\infty} x \\phi''(x) dx = [x \\phi'(x)]_{X_0}^{\\infty} - \\int_{X_0}^{\\infty} \\phi'(x) dx\n$$\n$$\n= \\left(\\lim_{x\\to\\infty} x \\phi'(x) - X_0 \\phi'(X_0)\\right) - [\\phi(x)]_{X_0}^{\\infty}\n$$\n$$\n= \\left(\\lim_{x\\to\\infty} x \\phi'(x) - X_0 \\phi'(X_0)\\right) - \\left(\\lim_{x\\to\\infty} \\phi(x) - \\phi(X_0)\\right)\n$$\n我们使用给定的大 $x$ 值的渐近行为 $\\phi(x) \\approx A/x^3$（其中 $A=144$）。其导数为 $\\phi'(x) \\approx -3A/x^4$。\n在无穷远处的极限为：\n$$\n\\lim_{x\\to\\infty} \\phi(x) = \\lim_{x\\to\\infty} \\frac{A}{x^3} = 0\n$$\n$$\n\\lim_{x\\to\\infty} x \\phi'(x) = \\lim_{x\\to\\infty} x \\left(\\frac{-3A}{x^4}\\right) = \\lim_{x\\to\\infty} \\frac{-3A}{x^3} = 0\n$$\n将这些极限代入积分后的表达式：\n$$\n\\int_{X_0}^{\\infty} x \\phi''(x) dx = (0 - X_0\\phi'(X_0)) - (0 - \\phi(X_0)) = \\phi(X_0) - X_0\\phi'(X_0)\n$$\n因此，对应于半径 $X_0$ 以外的电子数为：\n$$\nN_{out}(X_0) = Z (\\phi(X_0) - X_0\\phi'(X_0))\n$$\n现在我们求出 $r=a_0$ 时 $X_0$ 的值。\n$$\nX_0 = \\frac{a_0}{b} = \\frac{a_0}{\\left(\\frac{9\\pi^2}{128}\\right)^{1/3} \\frac{a_0}{Z^{1/3}}} = \\left(\\frac{128}{9\\pi^2}\\right)^{1/3} Z^{1/3}\n$$\n由于问题考虑的是 $Z \\gg 1$ 的情况，$X_0$ 很大，所以我们可以使用 $\\phi(X_0)$ 和 $\\phi'(X_0)$ 的渐近形式。\n$$\n\\phi(X_0) \\approx \\frac{A}{X_0^3} \\quad, \\quad \\phi'(X_0) \\approx -\\frac{3A}{X_0^4}\n$$\n将这些代入 $N_{out}(a_0)$ 的表达式中：\n$$\nN_{out}(a_0) \\approx Z \\left( \\frac{A}{X_0^3} - X_0 \\left(-\\frac{3A}{X_0^4}\\right) \\right) = Z \\left( \\frac{A}{X_0^3} + \\frac{3A}{X_0^3} \\right) = \\frac{4AZ}{X_0^3}\n$$\n现在我们代入 $X_0$ 的表达式：\n$$\nX_0^3 = \\left( \\left(\\frac{128}{9\\pi^2}\\right)^{1/3} Z^{1/3} \\right)^3 = \\frac{128 Z}{9\\pi^2}\n$$\n最后，我们计算 $N_{out}(a_0)$：\n$$\nN_{out}(a_0) = \\frac{4AZ}{X_0^3} = \\frac{4(144)Z}{(128Z)/(9\\pi^2)} = \\frac{576 Z \\cdot 9\\pi^2}{128 Z}\n$$\n因子 $Z$ 被消掉了，正如预期的那样。\n$$\nN_{out}(a_0) = \\frac{576}{128} \\cdot 9\\pi^2\n$$\n该分数可以简化：$\\frac{576}{128} = \\frac{4 \\cdot 144}{128} = \\frac{144}{32} = \\frac{9 \\cdot 16}{2 \\cdot 16} = \\frac{9}{2}$。\n$$\nN_{out}(a_0) = \\frac{9}{2} \\cdot 9\\pi^2 = \\frac{81\\pi^2}{2}\n$$", "answer": "$$\n\\boxed{\\frac{81\\pi^2}{2}}\n$$", "id": "1161957"}]}