{"hands_on_practices": [{"introduction": "前向欧拉法（Forward Euler method）是数值求解微分方程最基础的方法，但其简洁性的背后隐藏着对稳定性的严格要求。本练习 [@problem_id:1126852] 将欧拉法应用于著名的逻辑斯谛（logistic）人口增长模型，旨在揭示步长的选择对解的物理真实性的关键影响。通过这个实践，你将计算出导致解出现非物理结果（例如负人口）的临界步长，从而深刻理解条件稳定性的概念及其在实际应用中的重要性。", "problem": "逻辑斯谛方程是描述种群增长的常见模型，由以下常微分方程给出：\n$$\ny'(t) = r y(t) \\left(1 - \\frac{y(t)}{K}\\right)\n$$\n此处，$y(t)$ 是时间 $t$ 时的种群数量，$r$ 是内禀增长率，$K$ 是环境承载能力。$r$ 和 $K$ 均为正常数。\n\n考虑初始条件 $y(0) = y_0$，其中初始种群数量大于环境承载能力，即 $y_0 > K$。在这种情况下，其精确解表明种群数量会随时间减少，从上方渐近地趋近于环境承载能力 $K$。\n\n当使用前向欧拉法数值求解此微分方程时，时间步长 $h$ 的选择对于获得具有物理意义的解至关重要。前向欧拉法的更新规则为 $y_{n+1} = y_n + h f(t_n, y_n)$。如果 $h$ 太大，数值解可能会变为负数，而种群数量不可能为负。\n\n确定临界步长 $h_c$，使得从 $y_0$ 开始的前向欧拉法的第一步产生的值恰好为零 ($y_1 = 0$)。该值 $h_c$ 标志着第一步稳定性的阈值；任何大于 $h_c$ 的步长 $h$ 都将导致非物理意义的负种群数量 $y_1  0$。你的最终答案应该是一个用 $r$、$K$ 和 $y_0$ 表示的表达式。", "solution": "我们将前向欧拉法更新应用于逻辑斯谛方程，\n$$\ny_{n+1}=y_n+h\\,r\\,y_n\\Bigl(1-\\frac{y_n}{K}\\Bigr).\n$$\n对于第一步 $n=0$，可得\n$$\ny_1=y_0+h\\,r\\,y_0\\Bigl(1-\\frac{y_0}{K}\\Bigr).\n$$\n我们要求 $y_1=0$，因此\n$$\n0=y_0+h\\,r\\,y_0\\Bigl(1-\\frac{y_0}{K}\\Bigr).\n$$\n两边同除以 $y_0\\neq0$，\n$$\n0=1+h\\,r\\Bigl(1-\\frac{y_0}{K}\\Bigr)\n\\;\\;\\Longrightarrow\\;\\;\nh\\,r\\Bigl(1-\\frac{y_0}{K}\\Bigr)=-1.\n$$\n求解 $h$，\n$$\nh=\\frac{-1}{r\\bigl(1-\\frac{y_0}{K}\\bigr)}\n=\\frac{1}{r\\bigl(\\frac{y_0}{K}-1\\bigr)}\n=\\frac{K}{r\\,(y_0-K)}.\n$$", "answer": "$$\\boxed{\\frac{K}{r\\,(y_0-K)}}$$", "id": "1126852"}, {"introduction": "在认识到一阶欧拉法的局限性后，我们自然会转向更高阶的方法，如龙格-库塔（Runge-Kutta）法族。本练习 [@problem_id:1126960] 旨在比较两种常见的二阶方法：修恩法（Heun's method）和显式中点法（explicit midpoint method）。通过将这两种方法应用于一个一般的线性常微分方程，你将发现它们之间一个令人惊讶但非常重要的关系，这有助于加深对不同数值格式内在联系的理解。", "problem": "考虑一个线性常微分方程的初值问题：\n$$\ny'(t) = a y(t) + b\n$$\n其初始条件为 $y(t_0) = y_0$，其中 $a$ 和 $b$ 是实常数。\n我们希望使用两种不同的二阶 Runge-Kutta 方法，以步长 $h$ 来近似解在 $t_1 = t_0 + h$ 处的值。\n\n第一种方法是**Heun 方法**（也称为改进的 Euler 方法或梯形法则），其对于一般函数 $f(t,y)$ 的迭代定义如下：\n$$\n\\begin{aligned}\nk_1 = f(t_n, y_n) \\\\\nk_2 = f(t_n + h, y_n + h k_1) \\\\\ny_{n+1} = y_n + \\frac{h}{2}(k_1 + k_2)\n\\end{aligned}\n$$\n\n第二种方法是**显式中点法**，其迭代定义如下：\n$$\n\\begin{aligned}\nk_1^* = f(t_n, y_n) \\\\\nk_2^* = f(t_n + \\frac{h}{2}, y_n + \\frac{h}{2} k_1^*) \\\\\ny_{n+1} = y_n + h k_2^*\n\\end{aligned}\n$$\n\n设 $y_1^{\\text{Heun}}$ 是从 $(t_0, y_0)$ 开始，使用 Heun 方法进行一步后对 $y(t_1)$ 的近似值，设 $y_1^{\\text{midpoint}}$ 是使用显式中点法进行一步后对 $y(t_1)$ 的近似值。\n\n推导差值 $D = y_1^{\\text{Heun}} - y_1^{\\text{midpoint}}$ 关于参数 $a, b, y_0,$ 和 $h$ 的表达式。", "solution": "我们有常微分方程\n$$y'=f(t,y)=a\\,y+b,\\quad y(t_0)=y_0.$$\n\n1. Heun 方法：\n$$k_1=f(t_0,y_0)=a y_0+b,$$\n$$k_2=f\\bigl(t_0+h,\\;y_0+h\\,k_1\\bigr)\n   =a\\bigl(y_0+h(a y_0+b)\\bigr)+b\n   =a y_0+a^2y_0h+a b h+b.$$\n因此\n$$y_1^{\\text{Heun}}\n=y_0+\\frac{h}{2}(k_1+k_2)\n=y_0+\\frac{h}{2}\\Bigl(2(a y_0+b)+a^2y_0h+a b h\\Bigr)$$\n$$\\quad\n=y_0+h(a y_0+b)+\\frac{a^2y_0h^2}{2}+\\frac{a b h^2}{2}.$$\n\n2. 显式中点法：\n$$k_1^*=a y_0+b,$$\n$$k_2^*=f\\Bigl(t_0+\\frac{h}{2},\\;y_0+\\frac{h}{2}k_1^*\\Bigr)\n=a\\Bigl(y_0+\\frac{h}{2}(a y_0+b)\\Bigr)+b\n=a y_0+\\frac{a^2y_0h}{2}+\\frac{a b h}{2}+b.$$\n于是\n$$y_1^{\\text{midpoint}}\n=y_0+h k_2^*\n=y_0+h\\Bigl(a y_0+b+\\tfrac{a^2y_0h}{2}+\\tfrac{a b h}{2}\\Bigr)$$\n$$\\quad\n=y_0+h(a y_0+b)+\\frac{a^2y_0h^2}{2}+\\frac{a b h^2}{2}.$$\n\n由于两个公式完全相同，它们的差为\n$$D=y_1^{\\text{Heun}}-y_1^{\\text{midpoint}}=0.$$", "answer": "$$\\boxed{0}$$", "id": "1126960"}, {"introduction": "某些被称为刚性（stiff）方程的微分方程，对许多显式数值方法构成了巨大挑战，因为它们要求极小的步长来维持稳定性。这个高级练习 [@problem_id:1126958] 将通过把修恩法应用于经典的Prothero-Robinson测试问题来探讨这一现象。通过分析局部截断误差的结构，你将理解刚性项如何影响方法的实际精度，并揭示“阶数退化”（order reduction）这一在科学计算中至关重要的概念。", "problem": "Prothero-Robinson 问题是一个标准的测试方程，用于分析数值方法在求解刚性常微分方程 (ODEs) 时的行为。其形式为\n$$\ny'(t) = \\lambda (y(t) - g(t)) + g'(t), \\quad y(0) = g(0)\n$$\n其中 $g(t)$ 是一个光滑的缓变函数，$\\lambda$ 是一个具有大的负实部的复数，即 $\\text{Re}(\\lambda) \\ll 0$。该常微分方程的精确解就是 $y(t) = g(t)$。一个好的刚性问题数值方法的一个关键特性是，其误差不应受到 $\\lambda$ 的大模值的显著影响。\n\n考虑将显式二阶 Runge-Kutta 方法（也称为改进欧拉法或 Heun 方法）应用于此问题。该方法由以下步骤定义：\n$$\n\\begin{align*}\nk_1 = f(t_n, y_n) \\\\\nk_2 = f(t_n + h, y_n + h k_1) \\\\\ny_{n+1} = y_n + \\frac{h}{2} (k_1 + k_2)\n\\end{align*}\n$$\n其中 $h$ 是步长，且 $f(t,y) = \\lambda(y(t)-g(t)) + g'(t)$。\n\n为分析该方法的精度，我们考察单步之后的局部截断误差 (LTE)。假设计算从精确解开始，因此 $y_n = g(t_n)$。LTE 定义为 $LTE = y_{n+1} - y(t_{n+1}) = y_{n+1} - g(t_{n+1})$。对于小步长 $h$，LTE 可以展开为 $h$ 的幂级数。对于 Prothero-Robinson 问题，此展开式的主导项可以写成以下形式：\n$$\nLTE = C_1 \\lambda g''(t_n) h^3 + C_2 g'''(t_n) h^3 + O(h^4)\n$$\n其中 $g''(t_n)$ 和 $g'''(t_n)$ 分别是 $g(t)$ 在 $t_n$ 处的二阶和三阶导数。系数 $C_1$ 量化了来自方程刚性部分的误差贡献。\n\n你的任务是推导出系数 $C_1$ 的值。", "solution": "我们有 Prothero–Robinson 常微分方程\n$$y'(t)=\\lambda\\bigl(y(t)-g(t)\\bigr)+g'(t),\\quad y(0)=g(0),$$  \n其精确解为 $y(t)=g(t)$。应用步长为 $h$ 的 Heun 方法，并假设 $y_n=g(t_n)$，我们设\n$$k_1=f(t_n,y_n)=\\lambda\\bigl(g(t_n)-g(t_n)\\bigr)+g'(t_n)=g'(t_n)\\,, $$  \n$$k_2=f\\bigl(t_n+h,\\;g(t_n)+h\\,k_1\\bigr) \n=\\lambda\\Bigl(g(t_n)+h\\,g'(t_n)-g(t_n+h)\\Bigr)+g'(t_n+h)\\,. $$  \n将 $g$ 在 $t_n$ 处进行泰勒级数展开：\n$$g(t_n+h)=g+hg'+\\tfrac{h^2}{2}g''+\\tfrac{h^3}{6}g'''+O(h^4),$$  \n$$g'(t_n+h)=g'+hg''+\\tfrac{h^2}{2}g'''+\\tfrac{h^3}{6}g''''+O(h^4).$$  \n因此\n$$g(t_n)+h\\,g'(t_n)-g(t_n+h)\n=-\\frac{h^2}{2}g''-\\frac{h^3}{6}g'''+O(h^4),$$  \n所以\n$$k_2\n=g'+h\\,g''+\\frac{h^2}{2}g'''- \\frac{\\lambda h^2}{2}g''\n+\\frac{h^3}{6}g''''-\\frac{\\lambda h^3}{6}g'''+O(h^4).$$  \nHeun 方法的更新步骤给出\n$$y_{n+1}=g+\\frac{h}{2}(k_1+k_2)\n=g+h\\,g'+\\frac{h^2}{2}g''+\\frac{h^3}{4}g'''-\\frac{\\lambda h^3}{4}g''+O(h^4).$$  \n减去在 $t_{n+1}$ 处的精确解，\n$$g(t_n+h)=g+h\\,g'+\\tfrac{h^2}{2}g''+\\tfrac{h^3}{6}g'''+O(h^4),$$  \n得到局部截断误差\n$$LTE=y_{n+1}-g(t_n+h)\n=-\\frac{\\lambda h^3}{4}g''+\\frac{h^3}{12}g'''+O(h^4).$$  \n因此 $\\lambda g''\\,h^3$ 的系数是\n$$C_1=-\\frac14.$$", "answer": "$$\\boxed{-\\frac{1}{4}}$$", "id": "1126958"}]}