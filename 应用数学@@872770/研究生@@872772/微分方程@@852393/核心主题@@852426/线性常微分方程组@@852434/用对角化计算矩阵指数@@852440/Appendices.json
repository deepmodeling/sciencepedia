{"hands_on_practices": [{"introduction": "理论学习之后，让我们通过一系列动手实践来巩固和深化对角化方法。第一个练习将探讨一个由局部相互作用和全局耦合组成的系统。直接对总系统矩阵进行对角化可能看起来很复杂，但本题的巧妙之处在于揭示系统不同部分之间的潜在对称性。通过分析，您会发现，在特定条件下，复杂系统的动力学行为可以通过一个共享的本征基来大大简化，这展示了特征值分析在解决物理问题中的优雅与力量。[@problem_id:1085162]", "problem": "考虑一个由四个相互作用的组件组成的系统，其状态由向量 $\\mathbf{x}(t) = [x_1(t), x_2(t), x_3(t), x_4(t)]^T$ 描述。该系统的演化由线性常微分方程组 $\\frac{d\\mathbf{x}}{dt} = B\\mathbf{x}$ 控制。$4 \\times 4$ 矩阵 $B$ 由两个矩阵之和给出，$B = A + k J$。第一个矩阵 $A$ 代表一个固定的局部相互作用模式：\n$$A = \\begin{pmatrix} -4   1   1   0 \\\\ 1   -4   0   1 \\\\ 1   0   -4   1 \\\\ 0   1   1   -4 \\end{pmatrix}$$\n第二项 $kJ$ 代表一个强度为 $k$ 的均匀全局相互作用，其中 $J$ 是全为1的 $4 \\times 4$ 矩阵，即对所有的 $i,j$ 都有 $J_{ij} = 1$。系统在 $t=0$ 时的初始状态为 $\\mathbf{x}(0) = [1, 0, 0, 0]^T$。\n\n你的任务是找到状态之和 $S(t) = \\sum_{i=1}^4 x_i(t)$ 作为时间 $t$ 和参数 $k$ 的函数的闭式表达式。", "solution": "问题要求解在给定初始条件 $\\mathbf{x}(0)$ 下，常微分方程组 $\\frac{d\\mathbf{x}}{dt} = B\\mathbf{x}$ 的解向量 $\\mathbf{x}(t)$ 各分量之和。\n\n该系统的形式解由矩阵指数给出：\n$$ \\mathbf{x}(t) = e^{Bt} \\mathbf{x}(0) $$\n为了计算矩阵指数 $e^{Bt}$，我们首先需要找到矩阵 $B$ 的特征值和特征向量，即我们需要将其对角化。矩阵 $B$ 由 $B = A + k J$ 给出，其中\n$$ A = \\begin{pmatrix} -4   1   1   0 \\\\ 1   -4   0   1 \\\\ 1   0   -4   1 \\\\ 0   1   1   -4 \\end{pmatrix}, \\quad J = \\begin{pmatrix} 1   1   1   1 \\\\ 1   1   1   1 \\\\ 1   1   1   1 \\\\ 1   1   1   1 \\end{pmatrix} $$\n关键思想是首先找到 $A$ 的特征值和特征向量，然后确定它们如何受到加上项 $kJ$ 的影响。\n\n**步骤1：对角化A**\n\n设 $\\lambda$ 是 $A$ 的一个特征值，$\\mathbf{v}$ 是对应的特征向量，因此 $A\\mathbf{v} = \\lambda\\mathbf{v}$。特征方程为 $\\det(A - \\lambda I) = 0$。令 $x = -4-\\lambda$。\n$$ \\det \\begin{pmatrix} x   1   1   0 \\\\ 1   x   0   1 \\\\ 1   0   x   1 \\\\ 0   1   1   x \\end{pmatrix} = x(x^3-2x) - (x^2) + (-x^2) = x^4 - 4x^2 = x^2(x-2)(x+2) = 0 $$\n$x$ 的根为 $0$（重数为2）、$2$ 和 $-2$。\n$A$ 的特征值为 $\\lambda = -4-x$：\n- $x=2 \\implies \\lambda_1 = -6$\n- $x=0 \\implies \\lambda_2 = \\lambda_3 = -4$\n- $x=-2 \\implies \\lambda_4 = -2$\n（注：我们按值重新排序）。让我们找到对应的特征向量。\n\n对于 $\\lambda_4 = -2$ ($x=-2$)：$(A+2I)\\mathbf{v} = 0$。方程组为 $-2v_1+v_2+v_3=0$, $v_1-2v_2+v_4=0$, $v_1-2v_3+v_4=0$, $v_2+v_3-2v_4=0$。这导致 $v_1=v_2=v_3=v_4$。我们选择 $\\mathbf{v}_4 = [1, 1, 1, 1]^T$。\n\n对于 $\\lambda_1 = -6$ ($x=2$)：$(A+6I)\\mathbf{v} = 0$。方程组为 $2v_1+v_2+v_3=0$, $v_1+2v_2+v_4=0$, $v_1+2v_3+v_4=0$, $v_2+v_3+2v_4=0$。这导致 $v_2=v_3$ 且 $v_1=v_4=-v_2$。我们选择 $\\mathbf{v}_1 = [-1, 1, 1, -1]^T$。\n\n对于 $\\lambda_{2,3} = -4$ ($x=0$)：$(A+4I)\\mathbf{v} = 0$。方程为 $v_2+v_3=0$ 和 $v_1+v_4=0$。这定义了一个二维特征空间。我们可以选择两个满足这些条件的正交向量。\n- 令 $v_1=1, v_2=0$。则 $v_4=-1, v_3=0$。所以 $\\mathbf{v}_2 = [1, 0, 0, -1]^T$。\n- 对于与 $\\mathbf{v}_2$ 正交的第二个向量，令 $\\mathbf{v}_3 = [a,b,c,d]^T$。$\\mathbf{v}_2 \\cdot \\mathbf{v}_3 = a-d=0 \\implies a=d$。根据特征空间的条件，$d=-a \\implies a=d=0$。且 $c=-b$。所以第二个特征向量的形式为 $[0, b, -b, 0]^T$。我们选择 $\\mathbf{v}_3 = [0, 1, -1, 0]^T$。\n\n$A$ 的特征向量是：\n- $\\lambda_1 = -6, \\mathbf{v}_1 = [-1, 1, 1, -1]^T$\n- $\\lambda_2 = -4, \\mathbf{v}_2 = [1, 0, 0, -1]^T$\n- $\\lambda_3 = -4, \\mathbf{v}_3 = [0, 1, -1, 0]^T$\n- $\\lambda_4 = -2, \\mathbf{v}_4 = [1, 1, 1, 1]^T$\n\n**步骤2：对角化B**\n\n现在考虑矩阵 $B = A + k J$。注意到 $J = \\mathbf{1}\\mathbf{1}^T$，其中 $\\mathbf{1}=[1,1,1,1]^T=\\mathbf{v}_4$。\n我们将 $B$ 应用于 $A$ 的特征向量：\n$$ B\\mathbf{v}_i = (A + k\\mathbf{v}_4\\mathbf{v}_4^T)\\mathbf{v}_i = A\\mathbf{v}_i + k\\mathbf{v}_4(\\mathbf{v}_4^T \\mathbf{v}_i) $$\n特征向量 $\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3, \\mathbf{v}_4$ 是正交的。\n- 对于 $i=1, 2, 3$，$\\mathbf{v}_4^T \\mathbf{v}_i = \\mathbf{v}_4 \\cdot \\mathbf{v}_i = 0$。\n所以，对于 $i=1,2,3$，$B\\mathbf{v}_i = A\\mathbf{v}_i = \\lambda_i \\mathbf{v}_i$。\n特征向量 $\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3$ 也是 $B$ 的特征向量，具有相同的特征值 $\\mu_1 = -6$ 和 $\\mu_2 = \\mu_3 = -4$。\n- 对于 $i=4$：$\\mathbf{v}_4^T \\mathbf{v}_4 = \\|\\mathbf{v}_4\\|^2 = 1^2+1^2+1^2+1^2=4$。\n$$ B\\mathbf{v}_4 = A\\mathbf{v}_4 + k\\mathbf{v}_4(\\mathbf{v}_4^T \\mathbf{v}_4) = \\lambda_4 \\mathbf{v}_4 + k\\mathbf{v}_4(4) = (\\lambda_4+4k)\\mathbf{v}_4 = (-2+4k)\\mathbf{v}_4 $$\n所以 $\\mathbf{v}_4$ 是 $B$ 的一个特征向量，其特征值为 $\\mu_4 = -2+4k$。\n\n$B$ 的特征值为 $\\mu_1=-6, \\mu_2=-4, \\mu_3=-4, \\mu_4=4k-2$。特征向量与 $A$ 的相同。\n\n**步骤3：构造解**\n\n解为 $\\mathbf{x}(t) = e^{Bt}\\mathbf{x}(0) = P e^{D_B t} P^{-1} \\mathbf{x}(0)$，其中 $P$ 是特征向量组成的矩阵，$D_B$ 是特征值组成的对角矩阵。\n归一化的特征向量是：\n$\\hat{\\mathbf{v}}_1 = \\frac{1}{2}[-1, 1, 1, -1]^T$, $\\hat{\\mathbf{v}}_2 = \\frac{1}{\\sqrt{2}}[1, 0, 0, -1]^T$, $\\hat{\\mathbf{v}}_3 = \\frac{1}{\\sqrt{2}}[0, 1, -1, 0]^T$, $\\hat{\\mathbf{v}}_4 = \\frac{1}{2}[1, 1, 1, 1]^T$。\n$P = [\\hat{\\mathbf{v}}_1, \\hat{\\mathbf{v}}_2, \\hat{\\mathbf{v}}_3, \\hat{\\mathbf{v}}_4]$。由于 $A$ 和 $B$ 是对称的，$P$ 是正交的，所以 $P^{-1}=P^T$。\n$\\mathbf{x}(0) = [1, 0, 0, 0]^T$。\n我们需要找到 $\\mathbf{x}(0)$ 在特征空间上的投影：$\\mathbf{c} = P^T \\mathbf{x}(0)$。\n$$ \\mathbf{c} = \\begin{pmatrix} -1/2  1/2  1/2  -1/2 \\\\ 1/\\sqrt{2}  0  0  -1/\\sqrt{2} \\\\ 0  1/\\sqrt{2}  -1/\\sqrt{2}  0 \\\\ 1/2  1/2  1/2  1/2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 1/\\sqrt{2} \\\\ 0 \\\\ 1/2 \\end{pmatrix} $$\n解为 $\\mathbf{x}(t) = P e^{D_B t} \\mathbf{c}$。\n$$ e^{D_B t}\\mathbf{c} = \\begin{pmatrix} e^{-6t}  0  0  0 \\\\ 0  e^{-4t}  0  0 \\\\ 0  0  e^{-4t}  0 \\\\ 0  0  0  e^{(4k-2)t} \\end{pmatrix} \\begin{pmatrix} -1/2 \\\\ 1/\\sqrt{2} \\\\ 0 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} -1/2 e^{-6t} \\\\ 1/\\sqrt{2} e^{-4t} \\\\ 0 \\\\ 1/2 e^{(4k-2)t} \\end{pmatrix} $$\n$\\mathbf{x}(t) = P(e^{D_B t}\\mathbf{c}) = -\\frac{1}{2}e^{-6t}\\hat{\\mathbf{v}}_1 + \\frac{1}{\\sqrt{2}}e^{-4t}\\hat{\\mathbf{v}}_2 + 0\\cdot\\hat{\\mathbf{v}}_3 + \\frac{1}{2}e^{(4k-2)t}\\hat{\\mathbf{v}}_4$。\n\n**步骤4：计算和 S(t)**\n\n我们需要计算 $S(t) = \\sum_{i=1}^4 x_i(t) = \\mathbf{1}^T \\mathbf{x}(t)$，其中 $\\mathbf{1}=[1,1,1,1]^T$。\n注意到 $\\mathbf{1} = \\mathbf{v}_4 = 2\\hat{\\mathbf{v}}_4$。\n由于特征向量的正交性，对于 $i=1,2,3$，有 $\\mathbf{1}^T \\hat{\\mathbf{v}}_i = \\mathbf{v}_4^T \\hat{\\mathbf{v}}_i = 0$。而 $\\mathbf{1}^T \\hat{\\mathbf{v}}_4 = \\mathbf{v}_4^T (\\frac{1}{2}\\mathbf{v}_4) = \\frac{1}{2}\\|\\mathbf{v}_4\\|^2 = \\frac{4}{2} = 2$。\n$$ S(t) = \\mathbf{1}^T \\left( -\\frac{1}{2}e^{-6t}\\hat{\\mathbf{v}}_1 + \\frac{1}{\\sqrt{2}}e^{-4t}\\hat{\\mathbf{v}}_2 + \\frac{1}{2}e^{(4k-2)t}\\hat{\\mathbf{v}}_4 \\right) $$\n$$ S(t) = -\\frac{1}{2}e^{-6t}(\\mathbf{1}^T\\hat{\\mathbf{v}}_1) + \\frac{1}{\\sqrt{2}}e^{-4t}(\\mathbf{1}^T\\hat{\\mathbf{v}}_2) + \\frac{1}{2}e^{(4k-2)t}(\\mathbf{1}^T\\hat{\\mathbf{v}}_4) $$\n$$ S(t) = -\\frac{1}{2}e^{-6t}(0) + \\frac{1}{\\sqrt{2}}e^{-4t}(0) + \\frac{1}{2}e^{(4k-2)t}(2) $$\n$$ S(t) = e^{(4k-2)t} $$\n\n**替代方法（捷径）**\n令 $S(t)=\\sum_i x_i(t) = \\mathbf{1}^T \\mathbf{x}(t)$。\n对时间求导：$\\frac{dS}{dt} = \\mathbf{1}^T \\frac{d\\mathbf{x}}{dt} = \\mathbf{1}^T B \\mathbf{x}$。\n我们来分析向量 $\\mathbf{1}^T B$：\n$$ \\mathbf{1}^T B = \\mathbf{1}^T (A + k J) = \\mathbf{1}^T A + k \\mathbf{1}^T J $$\n行向量 $\\mathbf{1}^T A = [1,1,1,1]A = [-2, -2, -2, -2] = -2[1,1,1,1] = -2\\mathbf{1}^T$。\n项 $\\mathbf{1}^T J = [1,1,1,1] \\begin{pmatrix} 1   1   1   1 \\\\ 1   1   1   1 \\\\ 1   1   1   1 \\\\ 1   1   1   1 \\end{pmatrix} = [4,4,4,4] = 4\\mathbf{1}^T$。\n所以，$\\mathbf{1}^T B = -2\\mathbf{1}^T + k(4\\mathbf{1}^T) = (4k-2)\\mathbf{1}^T$。\n将此代入 $S(t)$ 的微分方程：\n$$ \\frac{dS}{dt} = (4k-2)\\mathbf{1}^T \\mathbf{x} = (4k-2)S(t) $$\n这是一个关于 $S(t)$ 的简单一阶常微分方程。其解为 $S(t) = S(0)e^{(4k-2)t}$。\n初始条件是 $S(0) = \\sum x_i(0) = 1+0+0+0=1$。\n因此，最终解为 $S(t) = e^{(4k-2)t}$。", "answer": "$$ \\boxed{e^{(4k-2)t}} $$", "id": "1085162"}, {"introduction": "对角化是一个强大的工具，但它并非万能。理解其适用范围的边界与掌握其应用同样重要。这个练习将引导我们探索一个对角化方法失效的典型案例——一个不可对角化的“缺陷”矩阵。通过从第一性原理出发，我们将验证该矩阵的非正规性，并揭示其代数重数与几何重数的不匹配是如何阻碍对角化的。这个过程不仅能加深您对对角化条件的理解，还将自然地引出处理此类线性系统的更普适方法，即约旦标准型。[@problem_id:2704054]", "problem": "考虑在 $\\mathbb{R}^{2}$ 上的连续时间线性时不变 (LTI) 系统 $\\dot{x}(t)=A x(t)$，其真实矩阵为\n$$\nA=\\begin{bmatrix} 2  0 \\\\ 1  2 \\end{bmatrix},\n$$\n且在 $\\mathbb{R}^{2}$ 上赋予了标准的欧几里得内积。请仅使用核心定义和已验证的事实作为您推理的起点。\n\n- 根据第一性原理，判断 $A$ 是否是关于欧几里得内积的正规矩阵。请直接根据正规性的定义来证明您的结论。\n\n- 解释您的发现对角化的影响：判断 $A$ 是否可以在 $\\mathbb{C}$ 上对角化，以及是否可以酉对角化，并通过诉诸于对角化定义所蕴含的特征结构来证明每个决策。\n\n- 从基本构造推导状态转移矩阵 $e^{A t}$，并计算当 $t\\ge 0$ 时的诱导2-范数 $\\|e^{A t}\\|_{2}$。从您的精确表达式中，得出一个显式的闭式上界 $\\beta(t)$，使得对于所有 $t\\ge 0$ 都有 $\\|e^{A t}\\|_{2}\\le \\beta(t)$，且该上界无需渐近近似。\n\n将 $\\|e^{A t}\\|_{2}$ 作为 $t\\ge 0$ 的函数的精确解析表达式作为您的最终答案报告。不需要数值舍入，也不涉及物理单位。", "solution": "我们从核心定义开始。一个实矩阵 $A$ 是正规的（关于欧几里得内积），当且仅当 $A^{\\top}A=AA^{\\top}$。一个矩阵在 $\\mathbb{C}$ 上可对角化，当且仅当存在一个可逆矩阵 $V$ 使得 $V^{-1} A V$ 是对角矩阵；它是酉可对角化的，当且仅当它是正规的，等价地，存在一个酉矩阵 $U$ 使得 $U^{*} A U$ 是对角矩阵。实矩阵 $M$ 的诱导2-范数是 $\\|M\\|_{2}=\\sqrt{\\lambda_{\\max}(M^{\\top}M)}$，其中 $\\lambda_{\\max}$ 表示最大特征值。\n\n第一步：检验正规性。计算 $A^{\\top}$、$A^{\\top}A$ 和 $AA^{\\top}$：\n$$\nA=\\begin{bmatrix} 2  0 \\\\ 1  2 \\end{bmatrix},\\qquad\nA^{\\top}=\\begin{bmatrix} 2  1 \\\\ 0  2 \\end{bmatrix}.\n$$\n然后\n$$\nA^{\\top}A=\\begin{bmatrix} 2  1 \\\\ 0  2 \\end{bmatrix}\\begin{bmatrix} 2  0 \\\\ 1  2 \\end{bmatrix}\n=\\begin{bmatrix} 5  2 \\\\ 2  4 \\end{bmatrix},\\qquad\nAA^{\\top}=\\begin{bmatrix} 2  0 \\\\ 1  2 \\end{bmatrix}\\begin{bmatrix} 2  1 \\\\ 0  2 \\end{bmatrix}\n=\\begin{bmatrix} 4  2 \\\\ 2  5 \\end{bmatrix}.\n$$\n因为 $A^{\\top}A\\neq AA^{\\top}$，所以矩阵 $A$ 不是正规矩阵。\n\n第二步：对角化的推论。$A$ 的特征多项式是\n$$\n\\chi_{A}(\\lambda)=\\det(\\lambda I - A)=\\det\\!\\begin{bmatrix}\\lambda-2  0\\\\ -1  \\lambda-2\\end{bmatrix}=(\\lambda-2)^{2}.\n$$\n因此，谱由代数重数为 2 的单个特征值 $\\lambda=2$ 组成。特征空间是 $A-2I$ 的零空间：\n$$\nA-2I=\\begin{bmatrix}0  0\\\\ 1  0\\end{bmatrix},\\quad (A-2I)\\begin{bmatrix}x_{1}\\\\ x_{2}\\end{bmatrix}=\\begin{bmatrix}0\\\\ x_{1}\\end{bmatrix},\n$$\n因此特征向量满足 $x_{1}=0$ 且 $x_{2}$ 自由，所以特征空间是一维的，即 $\\mathrm{span}\\{\\begin{bmatrix}0\\\\ 1\\end{bmatrix}\\}$。因此几何重数为 $1$，故 $A$ 在 $\\mathbb{C}$ 上不可对角化。此外，由于 $A$ 不是正规的，它也不是酉可对角化的。不可对角化意味着其若尔当标准型在 $\\lambda=2$ 处包含一个大小为 2 的若尔当块，并且矩阵指数 $e^{A t}$ 将表现出一个多项式增长因子（关于 $t$ 是线性的）乘以一个指数因子 $e^{2 t}$。\n\n第三步：计算 $e^{A t}$ 及其诱导2-范数。将 $A$ 分解为其 Jordan–Chevalley 形式 $A=2I+N$，其中\n$$\nN:=A-2I=\\begin{bmatrix}0  0\\\\ 1  0\\end{bmatrix},\\qquad N^{2}=0.\n$$\n利用 $N^{2}=0$， $N t$ 的指数为\n$$\ne^{N t}=I+N t.\n$$\n由于 $2I$ 与 $N$ 可交换，我们有\n$$\ne^{A t}=e^{(2I+N)t}=e^{2 t}\\,e^{N t}=e^{2 t}\\,(I+N t)=e^{2 t}\\begin{bmatrix}1  0\\\\ t  1\\end{bmatrix}.\n$$\n设 $B:=I+N t=\\begin{bmatrix}1  0\\\\ t  1\\end{bmatrix}$。那么\n$$\n\\|e^{A t}\\|_{2}=e^{2 t}\\,\\|B\\|_{2}.\n$$\n为了计算 $\\|B\\|_{2}$，计算 $B^{\\top}B$：\n$$\nB^{\\top}B=\\begin{bmatrix}1  t\\\\ 0  1\\end{bmatrix}\\begin{bmatrix}1  0\\\\ t  1\\end{bmatrix}\n=\\begin{bmatrix}1+t^{2}  t\\\\ t  1\\end{bmatrix}.\n$$\n对称矩阵 $\\begin{bmatrix}1+t^{2}  t\\\\ t  1\\end{bmatrix}$ 的特征值是以下方程的根\n$$\n\\lambda^{2}-\\mathrm{tr}(B^{\\top}B)\\,\\lambda+\\det(B^{\\top}B)=0,\\qquad \\mathrm{tr}(B^{\\top}B)=2+t^{2},\\quad \\det(B^{\\top}B)=1.\n$$\n因此\n$$\n\\lambda_{\\max}(B^{\\top}B)=\\frac{(2+t^{2})+\\sqrt{(2+t^{2})^{2}-4}}{2}\n=\\frac{2+t^{2}+\\sqrt{t^{4}+4 t^{2}}}{2}\n=\\frac{2+t^{2}+|t|\\sqrt{t^{2}+4}}{2}.\n$$\n对于 $t\\ge 0$，这简化为\n$$\n\\lambda_{\\max}(B^{\\top}B)=\\frac{2+t^{2}+t\\sqrt{t^{2}+4}}{2}.\n$$\n因此\n$$\n\\|B\\|_{2}=\\sqrt{\\lambda_{\\max}(B^{\\top}B)}\n=\\sqrt{\\frac{2+t^{2}+t\\sqrt{t^{2}+4}}{2}},\n$$\n并且状态转移矩阵的精确诱导2-范数为\n$$\n\\|e^{A t}\\|_{2}=e^{2 t}\\sqrt{\\frac{2+t^{2}+t\\sqrt{t^{2}+4}}{2}},\\qquad t\\ge 0.\n$$\n\n从精确表达式直接得到的显式界包括，对于所有 $t\\ge 0$：\n- 使用 Frobenius 范数不等式 $\\|M\\|_{2}\\le \\|M\\|_{F}$ 和 $\\|B\\|_{F}=\\sqrt{2+t^{2}}$，\n$$\n\\|e^{A t}\\|_{2}\\le e^{2 t}\\sqrt{2+t^{2}}.\n$$\n- 使用关于欧几里得范数的对数范数（矩阵测度），$\\mu_{2}(A)=\\lambda_{\\max}\\!\\left(\\tfrac{A+A^{\\top}}{2}\\right)=\\lambda_{\\max}\\!\\left(\\begin{bmatrix}2  1/2\\\\ 1/2  2\\end{bmatrix}\\right)=\\frac{5}{2}$，经典的界给出\n$$\n\\|e^{A t}\\|_{2}\\le \\exp\\!\\big(\\mu_{2}(A)\\,t\\big)=\\exp\\!\\big(\\tfrac{5}{2}\\,t\\big).\n$$\n最后，精确表达式显示了当 $t\\to\\infty$ 时的渐近行为 $\\|e^{A t}\\|_{2}\\sim t\\,e^{2 t}$，这反映了在重复特征值 2 处的非正规、不可对角化的若尔当块结构。", "answer": "$$\\boxed{\\exp(2 t)\\,\\sqrt{\\frac{2+t^{2}+t\\sqrt{t^{2}+4}}{2}}}$$", "id": "2704054"}, {"introduction": "最后一个练习将理论与计算实践联系起来，这是一个在科学与工程计算中至关重要的话题。本题设计为一个计算实验，旨在比较对角化方法与泰勒级数展开法在计算矩阵指数时的数值稳定性。您将通过一系列精心设计的案例发现，一个理论上完美的数学方法在有限精度的计算机上可能表现不佳，特别是在处理病态或接近缺陷的矩阵时。这项实践将为您提供宝贵的经验，帮助您在未来选择稳健有效的数值算法。[@problem_id:2439853]", "problem": "考虑线性时不变常微分方程 (ODE) $\\,\\dot{v}(t) = M\\,v(t)\\,$，其初始条件为 $\\,v(0)\\,$，其中 $\\,M\\,$ 是一个常数实 $\\,2\\times 2\\,$ 矩阵，且 $\\,v(t)\\in\\mathbb{R}^2\\,$。其精确解为 $\\,v(t) = \\exp(M t)\\,v(0)\\,$，其中 $\\,\\exp(\\cdot)\\,$ 表示矩阵指数。您的任务是针对几个指定案例，量化并比较两种不同近似策略在计算 $\\,v(t)\\,$ 时产生的数值误差：\n\n- D方法（对角化）：当 $\\,M\\,$ 可对角化时，令 $\\,M = V \\Lambda V^{-1}\\,$，其中 $\\,\\Lambda\\,$ 为对角矩阵。定义近似解 $\\,\\tilde{v}_D(t) := V\\,\\exp(\\Lambda t)\\,V^{-1}\\,v(0)\\,$，在浮点运算下计算。如果因矩阵奇异而无法计算 $\\,V^{-1}\\,$，您必须将 D 方法的误差报告为“非数值 (not-a-number)”，并将特征向量矩阵的条件数报告为 $+\\infty$。\n- T方法（截断泰勒级数）：使用矩阵指数的 $\\,N\\,$ 阶截断泰勒级数，定义近似解 $\\,\\tilde{v}_T(t) := \\sum_{k=0}^{N} \\frac{(M t)^k}{k!}\\,v(0)\\,$，在浮点运算下计算，其中 $\\,N = 20\\,$。\n\n对于每个测试案例，使用数值上可靠的矩阵指数评估方法，计算一个高精度的参考解 $\\,v_{\\mathrm{ref}}(t) := \\exp(M t)\\,v(0)\\,$。对于每种方法 $\\,X \\in \\{D,T\\}\\,$，计算其相对 $\\,2$-范数误差 $\\,\\varepsilon_X := \\frac{\\lVert \\tilde{v}_X(t) - v_{\\mathrm{ref}}(t)\\rVert_2}{\\lVert v_{\\mathrm{ref}}(t)\\rVert_2}\\,$。对于 D 方法，还需计算特征向量矩阵 $\\,V\\,$ 的 $\\,2$-范数条件数 $\\,\\kappa(V)\\,$。如果在浮点运算中 $\\,M\\,$ 不可对角化（即无法求得 $\\,V^{-1}\\,$），则报告 $\\,\\varepsilon_D = \\mathrm{NaN}\\,$ 和 $\\,\\kappa(V) = +\\infty\\,$。\n\n请使用以下参数值测试套件，这些案例涵盖了不同的数值情景。在每个案例中，$\\,M\\in\\mathbb{R}^{2\\times 2}\\,$, $\\,t\\in\\mathbb{R}\\,$, 且 $\\,v(0)\\in\\mathbb{R}^2\\,$：\n\n- 案例 $\\,1\\,$（对称，良态特征基，适中时间）：\n  $$M_1=\\begin{pmatrix}-1   0.2\\\\ 0.2   -2\\end{pmatrix},\\quad t_1 = 1,\\quad v_1(0)=\\begin{pmatrix}1\\\\ 0\\end{pmatrix}.$$\n- 案例 $\\,2\\,$（非正规，近乎亏损，特征值相近）：\n  $$M_2=\\begin{pmatrix}-1   1\\\\ 0   -1+10^{-6}\\end{pmatrix},\\quad t_2 = 1,\\quad v_2(0)=\\begin{pmatrix}1\\\\ 1\\end{pmatrix}.$$\n- 案例 $\\,3\\,$（亏损若尔当块，在精确算术中对角化失败）：\n  $$M_3=\\begin{pmatrix}-1   1\\\\ 0   -1\\end{pmatrix},\\quad t_3 = 1,\\quad v_3(0)=\\begin{pmatrix}1\\\\ 0\\end{pmatrix}.$$\n- 案例 $\\,4\\,$（刚性衰减，$\\,\\lVert M t\\rVert\\,$ 较大，级数易发生相消误差）：\n  $$M_4=\\begin{pmatrix}-10   0\\\\ 0   -20\\end{pmatrix},\\quad t_4 = 5,\\quad v_4(0)=\\begin{pmatrix}1\\\\ -1\\end{pmatrix}.$$\n- 案例 $\\,5\\,$（纯旋转生成元，短时间）：\n  $$M_5=\\begin{pmatrix}0   -1\\\\ 1   0\\end{pmatrix},\\quad t_5 = 0.1,\\quad v_5(0)=\\begin{pmatrix}1\\\\ 0\\end{pmatrix}.$$\n\n对于每个案例 $\\,i\\in\\{1,2,3,4,5\\}\\,$，生成三元组 $\\,\\big[\\varepsilon_D^{(i)},\\ \\varepsilon_T^{(i)},\\ \\kappa(V^{(i)})\\big]\\,$，其中 $\\,\\kappa(V^{(i)})\\,$ 是案例 $\\,i\\,$ 中 D 方法所使用的特征向量矩阵的 $\\,2$-范数条件数。如果由于无法对 $\\,V\\,$ 求逆导致 D 方法无法应用，则输出 $\\,\\varepsilon_D^{(i)}=\\mathrm{NaN}\\,$ 和 $\\,\\kappa(V^{(i)})=+\\infty\\,$。\n\n最终输出格式：您的程序应生成单行输出，包含一个由列表组成的列表，格式为逗号分隔。每个内部列表包含三个浮点数，均采用科学记数法表示，并保留 $12$ 位有效数字（例如，数字 $\\,\\pi\\,$ 将被打印为 $\\,3.141592653590\\mathrm{e}{+00}\\,$）。最后一行必须严格遵循以下格式：\n$$\\big[\\,[\\varepsilon_D^{(1)},\\varepsilon_T^{(1)},\\kappa(V^{(1)})],\\ [\\varepsilon_D^{(2)},\\varepsilon_T^{(2)},\\kappa(V^{(2)})],\\ \\dots,\\ [\\varepsilon_D^{(5)},\\varepsilon_T^{(5)},\\kappa(V^{(5)})]\\,\\big],$$\n前后无任何额外文本。角度和物理单位不适用于此问题。所有数值答案必须按上述规定以十进制浮点数报告；不要使用百分号，也不要包含单位。", "solution": "该问题要求对求解线性常微分方程（ODE）系统 $\\dot{v}(t) = M v(t)$ 的两种数值方法进行定量比较，其中 $v(t) \\in \\mathbb{R}^2$，$M \\in \\mathbb{R}^{2 \\times 2}$ 是一个常数矩阵。此初值问题的精确解由矩阵指数给出，$v(t) = \\exp(M t) v(0)$。我们必须针对五个不同的测试案例，评估两种近似方案——D方法（对角化）和T方法（截断泰勒级数）——相对于一个高保真度参考解的数值精度。\n\n首先，必须确定每种计算的方法论。\n\n**参考解的计算**\n为了作为基准，需要一个高精度的参考解，记为 $v_{\\mathrm{ref}}(t)$。我们使用一个数值上稳健的矩阵指数库实现来计算它，具体是 `scipy.linalg.expm`。该函数采用缩放平方法（scaling and squaring algorithm）结合帕德近似（Padé approximants），这是数值线性代数中的一种标准且可靠的方法。因此，参考解计算为 $v_{\\mathrm{ref}}(t) = \\text{expm}(M t) v(0)$。任何近似解 $\\tilde{v}(t)$ 的相对误差都将使用 $2$-范数与此参考解进行比较：\n$$\n\\varepsilon = \\frac{\\lVert \\tilde{v}(t) - v_{\\mathrm{ref}}(t) \\rVert_2}{\\lVert v_{\\mathrm{ref}}(t) \\rVert_2}\n$$\n\n**D方法：对角化**\n此方法利用矩阵 $M$ 的特征分解。如果 $M$ 是可对角化的，它可以表示为 $M = V \\Lambda V^{-1}$，其中 $\\Lambda$ 是包含 $M$ 的特征值 $\\lambda_i$ 的对角矩阵，$V$ 的列是相应的特征向量。这种分解使得矩阵指数的计算变得简单：$\\exp(M t) = V \\exp(\\Lambda t) V^{-1}$。对角矩阵 $\\Lambda t$ 的指数是一个对角矩阵，其对角线上的元素为 $e^{\\lambda_i t}$。近似解定义为 $\\tilde{v}_D(t) = V \\exp(\\Lambda t) V^{-1} v(0)$。\n\n该方法的数值稳定性和准确性严重依赖于特征向量矩阵 $V$ 的条件数。条件数 $\\kappa(V) = \\lVert V \\rVert_2 \\lVert V^{-1} \\rVert_2$ 量化了这种敏感性。一个大的 $\\kappa(V)$ 值意味着特征向量近似线性相关，计算 $V$ 或 $v(0)$ 中的任何浮点误差都会在最终结果中被大大放大。如果 $M$ 是亏损的（不可对角化），或者在数值上非常接近亏损以至于 $V$ 在浮点运算中是奇异的，那么它的逆矩阵 $V^{-1}$ 将无法求出。在这种情况下，问题规定误差 $\\varepsilon_D$ 报告为非数值（$\\mathrm{NaN}$），条件数 $\\kappa(V)$ 报告为正无穷大（$+\\infty$）。我们的实现使用 `numpy.linalg.eig` 计算特征值和特征向量，并使用 `try-except` 块来处理在求 $V$ 的逆矩阵时可能出现的 `LinAlgError`。\n\n**T方法：截断泰勒级数**\n此方法使用矩阵指数函数在零点附近的泰勒级数展开式来近似它，截断到指定的阶数 $N=20$。近似式由下式给出：\n$$\n\\exp(A) \\approx \\sum_{k=0}^{N} \\frac{A^k}{k!}\n$$\n代入 $A = M t$，近似解向量为 $\\tilde{v}_T(t) = \\left( \\sum_{k=0}^{N} \\frac{(M t)^k}{k!} \\right) v(0)$。一个直接计算 $(Mt)^k$ 和 $k!$ 的朴素实现容易因潜在的溢出和灾难性相消而导致数值不稳定。一种更好的方法是迭代计算总和。设 $x_k = \\frac{(Mt)^k}{k!} v(0)$ 为级数中的第 $k$ 个向量项。这些项可以通过递推关系生成：\n$$\nx_0 = v(0) \\quad \\text{以及} \\quad x_k = \\frac{Mt}{k} x_{k-1} \\quad \\text{对于 } k \\geq 1\n$$\n最终的近似解是总和 $\\tilde{v}_T(t) = \\sum_{k=0}^{N} x_k$。这种迭代方案避免了直接计算高次幂和阶乘，但如果 $\\lVert Mt \\rVert$ 很大，它仍然容易受到灾难性相消的影响，因为大幅值的项相加可能得到一个很小的结果。\n\n**特定测试案例分析**\n五个测试案例旨在探究这些方法在不同数值条件下的弱点：\n- **案例 1 (对称):** 矩阵 $M_1$ 是对称的，保证其特征向量矩阵 $V_1$ 是正交的，因此 $\\kappa(V_1)=1$。预计D方法会非常准确。\n- **案例 2 (近乎亏损):** $M_2$ 是一个非正规矩阵，其特征值几乎退化。这将导致一个高度病态的特征向量矩阵 $V_2$（即 $\\kappa(V_2) \\gg 1$），从而严重降低D方法的准确性。\n- **案例 3 (亏损):** $M_3$ 是一个若尔当块，在精确算术中是不可对角化的。在数值上，其计算出的特征向量矩阵 $V_3$ 将是奇异或接近奇异的。我们预计尝试对 $V_3$ 求逆会失败，导致 $\\varepsilon_D = \\mathrm{NaN}$ 和 $\\kappa(V_3) = +\\infty$。\n- **案例 4 (刚性系统):** $M_4$ 是对角矩阵，所以D方法应该在机器精度内是精确的。然而，$M_4 t_4$ 的范数很大。大负数的指数（例如 $e^{-50}$ 和 $e^{-100}$）的泰勒级数会遭受极端的灾难性相消。我们预计T方法会产生一个非常不准确的结果。\n- **案例 5 (旋转生成元):** $M_5$ 是斜对称的，生成一个旋转。其特征向量矩阵 $V_5$ 是良态的。参数 $M_5 t_5$ 的范数很小，因此泰勒级数收敛迅速，应该会很准确。预计两种方法都会表现良好。\n\n实现过程是遍历每个案例，按所述进行计算，并根据指定的输出格式格式化结果。", "answer": "[[2.348393529322e-16, 5.558359702213e-16, 1.000000000000e+00], [7.986221191079e-04, 3.829986348618e-16, 1.414213562373e+06], [nan, 4.440892098501e-16, inf], [0.000000000000e+00, 1.000000000000e+00, 1.000000000000e+00], [0.000000000000e+00, 0.000000000000e+00, 1.000000000000e+00]]", "id": "2439853"}]}