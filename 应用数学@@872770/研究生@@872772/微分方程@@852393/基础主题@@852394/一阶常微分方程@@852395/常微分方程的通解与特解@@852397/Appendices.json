{"hands_on_practices": [{"introduction": "解决许多常微分方程（ODE）的一个基本步骤是识别其类型并应用相应的求解技术。本练习聚焦于一类重要的一阶常微分方程——恰当方程，其解可以表示为一个“势函数”的等位线。这项练习要求我们首先通过调整一个参数来满足方程的恰当性条件，然后通过积分来构建其隐式通解，这为我们提供了检验和寻找通解的实践经验[@problem_id:1106019]。", "problem": "给定一个一阶常微分方程\n$$(y^3 \\cos(xy^2) + 2x e^{x^2+y})dx + (\\alpha \\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y})dy = 0$$\n其中 $\\alpha$ 是一个实常数。对于任意值 $\\alpha$，该方程不是恰当方程。\n\n首先，确定使该方程成为恰当微分方程的 $\\alpha$ 的具体值。\n其次，使用这个 $\\alpha$ 值，求出该微分方程的通解。解应表示为隐式形式 $F(x,y) = C$，其中 $C$ 是一个任意积分常数。\n\n你的任务是推导函数 $F(x,y)$ 的表达式。", "solution": "该问题要求我们首先找到使给定的一阶常微分方程成为恰当方程的参数 $\\alpha$ 的值，然后求出这个恰当常微分方程的通解（隐式解）。\n\n给定的微分方程形式为 $M(x,y)dx + N(x,y)dy = 0$，其中：\n$$M(x,y) = y^3 \\cos(xy^2) + 2x e^{x^2+y}$$\n$$N(x,y) = \\alpha \\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y}$$\n\n**第一部分：确定使方程为恰当方程的 $\\alpha$ 值**\n\n形式为 $M(x,y)dx + N(x,y)dy = 0$ 的微分方程是恰当方程，当且仅当以下条件成立：\n$$\\frac{\\partial M}{\\partial y} = \\frac{\\partial N}{\\partial x}$$\n\n我们计算 $M$ 和 $N$ 的偏导数。\n首先，计算 $M$ 对 $y$ 的偏导数：\n$$\\frac{\\partial M}{\\partial y} = \\frac{\\partial}{\\partial y} (y^3 \\cos(xy^2) + 2x e^{x^2+y})$$\n对第一项使用乘法法则，并使用链式法则：\n$$\\frac{\\partial M}{\\partial y} = (3y^2)\\cos(xy^2) + y^3(-\\sin(xy^2) \\cdot (2xy)) + 2x e^{x^2+y}(1)$$\n$$\\frac{\\partial M}{\\partial y} = 3y^2\\cos(xy^2) - 2xy^4\\sin(xy^2) + 2x e^{x^2+y}$$\n\n接下来，计算 $N$ 对 $x$ 的偏导数：\n$$\\frac{\\partial N}{\\partial x} = \\frac{\\partial}{\\partial x} (\\alpha \\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y})$$\n对第二项使用乘法法则，并使用链式法则：\n$$\\frac{\\partial N}{\\partial x} = \\alpha \\cos(xy^2) \\cdot y^2 + [ (2y^2)\\cos(xy^2) + 2xy^2(-\\sin(xy^2) \\cdot y^2) ] + e^{x^2+y}(2x)$$\n$$\\frac{\\partial N}{\\partial x} = \\alpha y^2 \\cos(xy^2) + 2y^2\\cos(xy^2) - 2xy^4\\sin(xy^2) + 2x e^{x^2+y}$$\n$$\\frac{\\partial N}{\\partial x} = (\\alpha+2)y^2\\cos(xy^2) - 2xy^4\\sin(xy^2) + 2x e^{x^2+y}$$\n\n现在，我们令 $\\frac{\\partial M}{\\partial y} = \\frac{\\partial N}{\\partial x}$：\n$$3y^2\\cos(xy^2) - 2xy^4\\sin(xy^2) + 2x e^{x^2+y} = (\\alpha+2)y^2\\cos(xy^2) - 2xy^4\\sin(xy^2) + 2x e^{x^2+y}$$\n等式两边的项 $-2xy^4\\sin(xy^2)$ 和 $2x e^{x^2+y}$ 消去：\n$$3y^2\\cos(xy^2) = (\\alpha+2)y^2\\cos(xy^2)$$\n为了使该等式对所有 $x$ 和 $y$（其中 $y^2\\cos(xy^2)$ 不恒为零）成立，系数必须相等：\n$$3 = \\alpha + 2$$\n解出 $\\alpha$，我们得到：\n$$\\alpha = 1$$\n\n**第二部分：求解恰当常微分方程**\n\n现在我们有了 $\\alpha=1$，恰当微分方程为：\n$$(y^3 \\cos(xy^2) + 2x e^{x^2+y})dx + (\\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y})dy = 0$$\n因为这个方程是恰当的，所以存在一个势函数 $F(x,y)$，使得：\n$$\\frac{\\partial F}{\\partial x} = M(x,y) = y^3 \\cos(xy^2) + 2x e^{x^2+y}$$\n$$\\frac{\\partial F}{\\partial y} = N(x,y) = \\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y}$$\n该常微分方程的通解由 $F(x,y) = C$ 给出，其中 $C$ 是一个任意常数。\n\n我们可以通过将 $\\frac{\\partial F}{\\partial x}$ 对 $x$ 积分来求得 $F(x,y)$：\n$$F(x,y) = \\int M(x,y) dx + g(y) = \\int (y^3 \\cos(xy^2) + 2x e^{x^2+y}) dx + g(y)$$\n我们逐项积分：\n$$\\int y^3 \\cos(xy^2) dx = y^3 \\int \\cos(xy^2) dx = y^3 \\left(\\frac{\\sin(xy^2)}{y^2}\\right) = y\\sin(xy^2)$$\n$$\\int 2x e^{x^2+y} dx = e^y \\int 2x e^{x^2} dx$$\n令 $u=x^2$，则 $du=2x dx$。积分变为 $e^y \\int e^u du = e^y e^u = e^y e^{x^2} = e^{x^2+y}$。\n合并这些结果，我们得到：\n$$F(x,y) = y\\sin(xy^2) + e^{x^2+y} + g(y)$$\n其中 $g(y)$ 是一个关于 $y$ 的任意函数。\n\n为了求出 $g(y)$，我们将 $F(x,y)$ 的表达式对 $y$ 求导，并令其等于 $N(x,y)$：\n$$\\frac{\\partial F}{\\partial y} = \\frac{\\partial}{\\partial y} (y\\sin(xy^2) + e^{x^2+y} + g(y))$$\n对第一项使用乘法法则：\n$$\\frac{\\partial F}{\\partial y} = \\left(1 \\cdot \\sin(xy^2) + y \\cdot \\cos(xy^2) \\cdot (2xy)\\right) + e^{x^2+y} \\cdot (1) + g'(y)$$\n$$\\frac{\\partial F}{\\partial y} = \\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y} + g'(y)$$\n我们将其与 $N(x,y)$ 相等：\n$$\\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y} + g'(y) = \\sin(xy^2) + 2xy^2\\cos(xy^2) + e^{x^2+y}$$\n除 $g'(y)$ 外，所有项都消去了：\n$$g'(y) = 0$$\n对 $y$ 积分得到：\n$$g(y) = K$$\n其中 $K$ 是一个常数。我们可以将这个常数吸收到最终解 $F(x,y)=C$ 的常数 $C$ 中。因此，我们可以设 $K=0$，这意味着 $g(y)=0$。\n\n因此，函数 $F(x,y)$ 是：\n$$F(x,y) = y\\sin(xy^2) + e^{x^2+y}$$\n微分方程的通解是 $y\\sin(xy^2) + e^{x^2+y} = C$。问题要求的是 $F(x,y)$ 的表达式。", "answer": "$$\n\\boxed{y\\sin(xy^2) + e^{x^2+y}}\n$$", "id": "1106019"}, {"introduction": "在处理非齐次线性微分方程时，寻找特解是获得完整通解的关键一步。本题将引导我们使用待定系数法来求解一个四阶常微分方程的特解，其挑战在于驱动项 $\\cosh(kx)$ 与齐次方程的解之间存在“共振”现象。通过解决这个问题，我们可以深入理解当外部驱动力与系统的固有振动模式匹配时，如何调整我们的求解策略[@problem_id:1105817]。", "problem": "考虑如下给定的四阶线性非齐次常微分方程 (ODE)：\n$$\ny''''(x) - k^4 y(x) = \\cosh(kx)\n$$\n其中 $k$ 是一个正常数。\n\n使用待定系数法，求此微分方程的特解 $y_p(x)$。你的最终答案应为一个单一的闭式解析表达式。", "solution": "给定的微分方程是一个四阶线性非齐次常微分方程：\n$$\ny''''(x) - k^4 y(x) = \\cosh(kx)\n$$\n\n为了使用待定系数法求特解 $y_p(x)$，我们首先需要通过求解对应的齐次方程来找到齐次解 $y_c(x)$：\n$$\ny'''' - k^4 y = 0\n$$\n\n特征方程为：\n$$\nm^4 - k^4 = 0\n$$\n这可以因式分解为平方差形式：\n$$\n(m^2 - k^2)(m^2 + k^2) = 0\n$$\n进一步因式分解得到：\n$$\n(m - k)(m + k)(m - ik)(m + ik) = 0\n$$\n特征方程的根为 $m_1 = k$，$m_2 = -k$，$m_3 = ik$ 和 $m_4 = -ik$。\n\n齐次解是与这些根相关的函数的线性组合：\n$$\ny_c(x) = c_1 e^{kx} + c_2 e^{-kx} + c_3 \\cos(kx) + c_4 \\sin(kx)\n$$\n\n接下来，我们分析非齐次项 $R(x) = \\cosh(kx)$。将其用指数函数表示会很有帮助：\n$$\nR(x) = \\cosh(kx) = \\frac{e^{kx} + e^{-kx}}{2} = \\frac{1}{2}e^{kx} + \\frac{1}{2}e^{-kx}\n$$\n我们观察到 $R(x)$ 中的项 $e^{kx}$ 和 $e^{-kx}$ 也出现在齐次解 $y_c(x)$ 中。这表明这是一个共振情况。由于根 $m_1 = k$ 和 $m_2 = -k$ 都是非重复的（重数为1），我们对特解的初始猜测形式必须乘以 $x$。\n\n因此，特解 $y_p(x)$ 的形式为：\n$$\ny_p(x) = x(A e^{kx} + B e^{-kx}) = A x e^{kx} + B x e^{-kx}\n$$\n其中 $A$ 和 $B$ 是待定系数。\n\n我们需要计算 $y_p(x)$ 的前四阶导数：\n$y_p'(x) = A(e^{kx} + kx e^{kx}) + B(e^{-kx} - kx e^{-kx})$\n$y_p''(x) = A(ke^{kx} + ke^{kx} + k^2x e^{kx}) + B(-ke^{-kx} - ke^{-kx} + k^2x e^{-kx})$\n$y_p''(x) = A(2k e^{kx} + k^2x e^{kx}) + B(-2k e^{-kx} + k^2x e^{-kx})$\n$y_p'''(x) = A(2k^2 e^{kx} + k^2e^{kx} + k^3x e^{kx}) + B(2k^2 e^{-kx} - k^2e^{-kx} - k^3x e^{-kx})$\n$y_p'''(x) = A(3k^2 e^{kx} + k^3x e^{kx}) + B(3k^2e^{-kx} - k^3xe^{-kx})$\n$y_p''''(x) = A(3k^3 e^{kx} + k^3e^{kx} + k^4x e^{kx}) + B(-3k^3e^{-kx} - k^3e^{-kx} + k^4xe^{-kx})$\n$y_p''''(x) = A(4k^3 e^{kx} + k^4x e^{kx}) + B(-4k^3 e^{-kx} + k^4x e^{-kx})$\n\n现在，将 $y_p(x)$ 和 $y_p''''(x)$ 代入原常微分方程：\n$$\ny_p'''' - k^4 y_p = \\left[ A(4k^3 e^{kx} + k^4x e^{kx}) + B(-4k^3 e^{-kx} + k^4x e^{-kx}) \\right] - k^4 \\left[ A x e^{kx} + B x e^{-kx} \\right]\n$$\n将各项分组：\n$$\n= (A k^4x e^{kx} - A k^4x e^{kx}) + (B k^4x e^{-kx} - B k^4x e^{-kx}) + 4Ak^3 e^{kx} - 4Bk^3 e^{-kx}\n$$\n含有 $x e^{kx}$ 和 $x e^{-kx}$ 的项相互抵消：\n$$\ny_p'''' - k^4 y_p = 4Ak^3 e^{kx} - 4Bk^3 e^{-kx}\n$$\n\n我们令其等于强迫项 $R(x)$：\n$$\n4Ak^3 e^{kx} - 4Bk^3 e^{-kx} = \\frac{1}{2}e^{kx} + \\frac{1}{2}e^{-kx}\n$$\n通过比较线性无关函数 $e^{kx}$ 和 $e^{-kx}$ 的系数，我们得到关于 $A$ 和 $B$ 的方程组：\n1. $e^{kx}$ 的系数： $4Ak^3 = \\frac{1}{2} \\implies A = \\frac{1}{8k^3}$\n2. $e^{-kx}$ 的系数： $-4Bk^3 = \\frac{1}{2} \\implies B = -\\frac{1}{8k^3}$\n\n将这些系数代回 $y_p(x)$ 的表达式中：\n$$\ny_p(x) = \\frac{1}{8k^3} x e^{kx} - \\frac{1}{8k^3} x e^{-kx}\n$$\n提取公因式：\n$$\ny_p(x) = \\frac{x}{8k^3} (e^{kx} - e^{-kx})\n$$\n回顾双曲正弦函数的定义，$\\sinh(z) = \\frac{e^z - e^{-z}}{2}$。我们可以写出：\n$$\ne^{kx} - e^{-kx} = 2 \\sinh(kx)\n$$\n将此代入我们关于 $y_p(x)$ 的表达式中：\n$$\ny_p(x) = \\frac{x}{8k^3} (2 \\sinh(kx)) = \\frac{x \\sinh(kx)}{4k^3}\n$$\n这就是特解。", "answer": "$$\n\\boxed{\\frac{x\\sinh(kx)}{4k^3}}\n$$", "id": "1105817"}, {"introduction": "在许多科学和工程问题中，我们不仅需要通解，还需要一个满足特定初始条件的唯一解。本题提供了一个综合性的挑战，它要求我们在已知一个齐次解的情况下，求解一个二阶非齐次初值问题。这个过程需要我们依次运用降阶法求出另一个线性无关的齐次解，接着用参数变易法构造特解，最后利用初始条件确定积分常数，从而将通解精化为唯一的物理现实解[@problem_id:1106008]。", "problem": "考虑在定义域 $x0$ 上的函数 $y(x)$ 的二阶线性非齐次微分方程：\n$$x y'' - (2x+1)y' + (x+1)y = 2x^2 e^x$$\n已知 $y_1(x) = e^x$ 是对应齐次方程的一个解。\n\n使用降阶法，求满足初始条件 $y(1) = \\frac{8}{3}e$ 和 $y'(1) = \\frac{20}{3}e$ 的特解 $y(x)$。", "solution": "1. 将方程两边同除以 $x$，改写为标准形式：\n$$y''-\\Bigl(2+\\frac{1}{x}\\Bigr)y'+\\Bigl(1+\\frac{1}{x}\\Bigr)y=2x e^x.$$\n此处 $p(x)=-2-\\frac{1}{x}$，$q(x)=1+\\frac{1}{x}$，且 $r(x)=2x e^x$。\n\n2. 已知一个齐次解为 $y_1=e^x$。用降阶法计算第二个解：\n$$y_2=y_1\\int \\frac{e^{-\\int p\\,dx}}{y_1^2}\\,dx\n=e^x\\int\\frac{x e^{2x}}{e^{2x}}\\,dx\n=e^x\\int x\\,dx\n=\\frac{1}{2} x^2 e^x,$$\n故可取 $y_2=x^2e^x$。\n\n3. 常数变易法：计算朗斯基行列式\n$$W=y_1y_2'-y_2y_1'\n=e^x\\bigl((x^2+2x)e^x\\bigr)-x^2e^x\\cdot e^x\n=2x e^{2x}.$$\n那么\n$$u_1'=-\\frac{y_2\\,r}{W}=-\\frac{x^2e^x\\cdot 2x e^x}{2x e^{2x}}=-x^2,\\quad\nu_2'=\\frac{y_1\\,r}{W}=\\frac{e^x\\cdot 2x e^x}{2x e^{2x}}=1.$$\n积分得：$u_1=-\\frac{x^3}{3}$，$u_2=x$。\n\n4. 一个特解是\n$$y_p=u_1y_1+u_2y_2\n=\\Bigl(-\\frac{x^3}{3}\\Bigr)e^x+x\\cdot x^2e^x\n=\\frac{2x^3}{3}e^x.$$\n\n5. 通解：\n$$y=C_1e^x+C_2x^2e^x+\\frac{2x^3}{3}e^x\n=e^x\\bigl(C_1+C_2x^2+\\frac{2x^3}{3}\\bigr).$$\n\n6. 应用初始条件 $y(1)=\\frac{8}{3}e$ 和 $y'(1)=\\frac{20}{3}e$：\n由 $y(1)=e\\bigl(C_1+C_2+\\frac{2}{3}\\bigr)=\\frac{8}{3}e$ 可得 $C_1+C_2=2$。\n计算 $y'$ 并令 $x=1$ 得 $C_1+3C_2=4$。解得：$C_1=1$，$C_2=1$。\n\n7. 满足初始条件的解是\n$$y(x)=e^x\\Bigl(1+x^2+\\frac{2x^3}{3}\\Bigr).$$", "answer": "$$\\boxed{e^x\\Bigl(1+x^2+\\frac{2x^3}{3}\\Bigr)}$$", "id": "1106008"}]}