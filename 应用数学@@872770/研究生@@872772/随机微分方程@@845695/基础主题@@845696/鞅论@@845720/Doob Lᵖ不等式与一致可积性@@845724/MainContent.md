## 引言
在[随机过程](@entry_id:159502)的世界里，理解和控制[随机变量](@entry_id:195330)的路径行为是核心挑战之一。当我们从单个时间点的分析转向整个时间段内的路径特性时，例如一个[随机过程](@entry_id:159502)的最大值，问题变得远为复杂。同样，在处理无限时间或随机停止时间的极限时，我们何时可以安全地交换期望和极限的顺序？这些问题在金融建模、物理系统和[工程控制](@entry_id:177543)等领域都至关重要，而经典的概率工具往往力不从心。

本文旨在系统性地介绍解决这些问题的两个强大支柱：Doob $L^p$ 不等式与[一致可积性](@entry_id:199715)。我们将深入这两个概念，揭示它们如何为看似棘手的随机性提供确定性的界限和严格的收敛保证。

在接下来的内容中，我们将分三步展开：
- **原理与机制**：我们将首先深入探讨[Doob不等式](@entry_id:636737)族和[一致可积性](@entry_id:199715)的精确定义、核心定理及其内在联系，为后续应用奠定坚实的理论基础。
- **应用与跨学科联系**：随后，我们将展示这些理论如何在[金融数学](@entry_id:143286)、数值分析和高等[随机分析](@entry_id:188809)等领域转化为解决实际问题的有力工具。
- **动手实践**：最后，通过一系列精心设计的问题，你将有机会亲手应用这些概念，加深理解并掌握其精髓。

让我们从这些理论的基石——它们的原理与机制——开始，探索如何精确地量化和控制[随机过程](@entry_id:159502)的动态行为。

## 原理与机制

继引言之后，本章将深入探讨[鞅](@entry_id:267779)论中的两个核心工具：Doob $L^p$ 不等式和[一致可积性](@entry_id:199715)。[Doob不等式](@entry_id:636737)为控制[随机过程](@entry_id:159502)的路径最大值提供了强有力的量化手段，而[一致可积性](@entry_id:199715)则是确保[极限定理](@entry_id:188579)（如[可选停止定理](@entry_id:267890)）在无限时间域或无界随机时间下成立的关键条件。我们将阐明这些概念的原理，并通过具体的例子和反例来揭示其深刻的内涵与应用边界。

### Doob最大值不等式：控制[上确界](@entry_id:140512)

[随机过程](@entry_id:159502)分析中的一个核心挑战是控制其在一段时间内的最大值或上确界，即所谓的 **运行上确界**（running supremum）$X_T^* := \sup_{0 \le t \le T} X_t$。对任意时刻 $t$ 的变量 $X_t$ 进行控制相对容易，但控制整个路径的[上确界](@entry_id:140512) $X_T^*$ 则要困难得多。Doob最大值不等式族为这一挑战提供了优雅的解决方案。在深入探讨这些不等式之前，值得一提的是，$X_T^*$ 本身的可测性是一个需要关注的技术细节。幸运的是，当[随机过程](@entry_id:159502) $X$ 是适应的且其样本路径[几乎必然](@entry_id:262518)是右连续[左极限](@entry_id:139055)（càdlàg）时，或当装备了“通常条件”（即完备且右连续）的滤子时，$X_T^*$ 对于 $\mathcal{F}_T$ 是可测的，这保证了涉及其期望的表达式是良定义的 [@problem_id:2973880]。

#### Lᵖ 不等式 (p > 1)

对于非负[下鞅](@entry_id:263978)，Doob建立了其运行上确界的矩与终值的矩之间的深刻联系。

**Doob $L^p$ 不等式**：令 $(X_t)_{t \in [0,T]}$ 为一个非负的右连续[下鞅](@entry_id:263978)，且 $p>1$。若 $\mathbb{E}[X_T^p]  \infty$，则其运行上确界 $X_T^*$ 亦在 $L^p$ 空间中，且满足：
$$
\mathbb{E}[(X_T^*)^p] \le \left(\frac{p}{p-1}\right)^p \mathbb{E}[X_T^p]
$$
这个不等式意义非凡：它将整个路径的最大值的 $p$ 次矩，通过一个仅依赖于 $p$ 的常数 $(\frac{p}{p-1})^p$，与过程终值的 $p$ 次矩联系起来。

对于一般的[鞅](@entry_id:267779) $(M_t)_{t \in [0,T]}$，由于凸函数（例如 $x \mapsto |x|$）保[下鞅](@entry_id:263978)性，根据[Jensen不等式](@entry_id:144269)，若 $M_t$ 是[鞅](@entry_id:267779)，则 $(|M_t|)_{t \in [0,T]}$ 是一个[下鞅](@entry_id:263978)。因此，我们可以将上述不等式应用于[鞅](@entry_id:267779)的[绝对值](@entry_id:147688)，得到：
$$
\mathbb{E}\left[\left(\sup_{0\le t\le T} |M_t|\right)^p\right] \le \left(\frac{p}{p-1}\right)^p \mathbb{E}\left[|M_T|^p\right]
$$
这个结果构成了[随机分析](@entry_id:188809)的基石之一。

**应用示例：伊藤积分的界**

为了具体感受此不等式的威力，我们考虑一个由随机微分方程定义的[连续鞅](@entry_id:185466) [@problem_id:2973843]。设 $(W_t)_{t \ge 0}$ 为[标准布朗运动](@entry_id:197332)，过程 $(X_t)_{0 \le t \le 1}$ 的解为 $dX_t = \sigma(t) dW_t$，其中 $X_0 = 0$，$\sigma(t)=\sqrt{2}t^{\alpha}$ 且 $\alpha > -1/2$。
1.  首先，$(X_t)$ 是一个[连续鞅](@entry_id:185466)。根据[Jensen不等式](@entry_id:144269)，函数 $\phi(x)=|x|$ 是凸函数，因此 $(|X_t|)$ 是一个非负[下鞅](@entry_id:263978)。
2.  应用Doob $L^p$ 不等式 ($p>1$)，我们得到：
    $$
    \mathbb{E}\left[\sup_{0\le t\le 1}|X_{t}|^{p}\right] \le \left(\frac{p}{p-1}\right)^{p} \mathbb{E}\left[|X_{1}|^{p}\right]
    $$
3.  接下来是计算 $\mathbb{E}[|X_1|^p]$。$X_1 = \int_0^1 \sqrt{2}s^{\alpha} dW_s$ 是一个高斯[随机变量](@entry_id:195330)，均值为0。其[方差](@entry_id:200758) $\nu^2$ 可由[伊藤等距](@entry_id:637467)性质算出：
    $$
    \nu^2 = \mathbb{E}[X_1^2] = \int_0^1 (\sqrt{2}s^\alpha)^2 ds = \int_0^1 2s^{2\alpha} ds = \frac{2}{2\alpha+1}
    $$
    因此，$X_1 \sim N(0, \nu^2)$。一个标准正态变量 $Z$ 的 $p$ 次绝对矩为 $\mathbb{E}[|Z|^p] = \frac{2^{p/2}}{\sqrt{\pi}}\Gamma(\frac{p+1}{2})$。利用 $X_1 = \nu Z$ 的关系，我们有：
    $$
    \mathbb{E}[|X_1|^p] = \nu^p \mathbb{E}[|Z|^p] = \left(\frac{2}{2\alpha+1}\right)^{p/2} \frac{2^{p/2}}{\sqrt{\pi}} \Gamma\left(\frac{p+1}{2}\right) = \frac{2^p}{\sqrt{\pi}(2\alpha+1)^{p/2}} \Gamma\left(\frac{p+1}{2}\right)
    $$
4.  将此结果代入不等式，我们便得到了运行[上确界](@entry_id:140512) $p$ 次矩的一个具体、显式的上界：
    $$
    \mathbb{E}\left[\sup_{0\le t\le 1}|X_{t}|^{p}\right] \le \left(\frac{p}{p-1}\right)^{p} \frac{2^{p}}{\sqrt{\pi} (2\alpha+1)^{p/2}} \Gamma\left(\frac{p+1}{2}\right)
    $$
这个例子清晰地展示了如何结合[Doob不等式](@entry_id:636737)与随机微积分的工具来[量化控制](@entry_id:168852)[随机过程](@entry_id:159502)的路径行为。

#### 弱 L¹ 不等式

当 $p \to 1$ 时，$L^p$ 不等式中的常数 $(\frac{p}{p-1})^p$ 趋于无穷大，这暗示着一个“强的”$L^1$ 不等式，即 $\mathbb{E}[X_T^*] \le C \mathbb{E}[X_T]$ 的形式，通常不成立。一个经典的离散时间反例可以说明这一点 [@problem_id:2973850]。考虑一个鞅 $X_0=1$，$X_{n+1}$ 以 $1/2$ 的概率变为 $2X_n$，以 $1/2$ 的概率变为 $0$。容易验证 $\mathbb{E}[X_n]=1$ 对所有 $n$ 成立。然而，其[上确界](@entry_id:140512) $X_\infty^* = \sup_{n \ge 0} X_n$ 的期望却是无穷大，$\mathbb{E}[X_\infty^*] = \infty$。这表明我们无法用终值的期望来控制上确界的期望。

作为替代，Doob提供了另一个形式上更弱但同样强大的不等式，它控制的是上确界超过某个阈值的 *概率*。

**Doob弱 $L^1$ 不等式** (或 **[下鞅](@entry_id:263978)最大值不等式**): 令 $(X_t)_{t \in [0,T]}$ 为一个非负的、可积的右连续[下鞅](@entry_id:263978)。对任意 $\lambda > 0$，有：
$$
\mathbb{P}(X_T^* \ge \lambda) \le \frac{1}{\lambda}\mathbb{E}[X_T]
$$
这个不等式背后的证明思想极为深刻，它与[可选停止定理](@entry_id:267890)紧密相关。实际上，可以通过对一个精心构造的停止时应用[可选停止定理](@entry_id:267890)来推导它 [@problem_id:2973866]。

在应用此不等式时，必须仔细审视其假设：

*   **可积性**: 不等式的右侧包含 $\mathbb{E}[X_T]$，因此要求终值是可积的。如果 $\mathbb{E}[X_T] = \infty$，则不等式变为 $\mathbb{P}(X_T^* \ge \lambda) \le \infty$，这是一个恒真但毫无用处的平凡界。我们可以构造一个简单的非可积[下鞅](@entry_id:263978)来说明这一点：令 $X_t = 0$ 对 $t  T$ 成立，而 $X_T$ 是一个期望为无穷的[随机变量](@entry_id:195330)（例如，服从某个[帕累托分布](@entry_id:271483)）。此时，不等式无法提供任何有效的控制 [@problem_id:2973852]。

*   **非负性**: 非负性假设至关重要。对于一般的（不一定非负的）可积[下鞅](@entry_id:263978)，不等式的形式变为 [@problem_id:2973876]：
    $$
    \mathbb{P}(X_T^* \ge \lambda) \le \frac{1}{\lambda}\mathbb{E}[X_T^+]
    $$
    其中 $X_T^+ = \max(X_T, 0)$ 是 $X_T$ 的正部。当 $X_t$ 非负时，$X_T^+ = X_T$，我们就回到了之前的形式。非负性不仅简化了公式，在证明中也扮演了关键角色。在标准证明中，为了将离散时间的结论推广到连续时间，需要利用[Fatou引理](@entry_id:147006)。过程的非负性恰好满足了应用[Fatou引理](@entry_id:147006)的条件，从而避免了更强的[一致可积性](@entry_id:199715)假设 [@problem_id:2973876]。

### [一致可积性](@entry_id:199715)：收敛与停止的关键

[Doob不等式](@entry_id:636737)为我们提供了控制[随机过程](@entry_id:159502)的工具，而这些工具的一个主要用武之地，便是证明关于[鞅收敛](@entry_id:262440)性和可选停止的重要定理。在这些应用中，**[一致可积性](@entry_id:199715) (Uniform Integrability, UI)** 扮演了核心角色。

#### 定义与直觉

一个[随机变量](@entry_id:195330)族 $\mathcal{X} \subset L^1(\Omega, \mathcal{F}, \mathbb{P})$ 被称为 **[一致可积](@entry_id:202893)的**，如果：
$$
\lim_{K\to\infty}\ \sup_{X\in\mathcal{X}}\,\mathbb{E}\big[\,|X|\,\mathbf{1}_{|X|K}\, \big] = 0
$$
直观上，这个定义要求族中所有[随机变量](@entry_id:195330)的“尾部期望”能够被一致地控制。也就是说，当我们考虑足够大的阈值 $K$ 时，所有变量取值大于 $K$ 的部分对期望的贡献都可以同时变得任意小。

[一致可积性](@entry_id:199715)是比“一致 $L^1$ 有界”（即 $\sup_{X \in \mathcal{X}} \mathbb{E}[|X|]  \infty$）更强的性质。一个 $L^1$ 有界的族不一定是[一致可积](@entry_id:202893)的。其区别在于，[一致可积性](@entry_id:199715)排除了概率质量“泄露到无穷远”的可能性。一个经典的例子是定义在 $[0,1]$ 上的[随机变量](@entry_id:195330)序列 $X_n = n \mathbf{1}_{[0, 1/n]}$。这个序列是 $L^1$ 有界的（$\mathbb{E}[|X_n|]=1$），但它不是[一致可积](@entry_id:202893)的，因为无论 $K$ 多大，总能找到一个 $X_n$（取 $n>K$），其质量完全集中在大于 $K$ 的区域 [@problem_id:2973879]。

#### 检验[一致可积性](@entry_id:199715)的准则

直接使用定义来检验UI可能很困难。幸运的是，我们有几个等价且更易于操作的准则。

*   **$L^p$ 有界准则**: 如果一个[随机变量](@entry_id:195330)族在某个 $L^p$ 空间 ($p>1$) 中有界，即 $\sup_{X \in \mathcal{X}} \mathbb{E}[|X|^p]  \infty$，那么该族是[一致可积](@entry_id:202893)的。这是一个非常实用的判据。其证明可以通过[Hölder不等式](@entry_id:140161)或简单的代数技巧完成 [@problem_id:2973879]。

*   **de la Vallée-Poussin 准则**: 这是UI的一个深刻而完整的刻画。一个族 $\mathcal{X} \subset L^1$ 是[一致可积](@entry_id:202893)的，当且仅当存在一个凸的、递增的函数 $\Phi: [0, \infty) \to [0, \infty)$，它具有超线性增长性质（即 $\lim_{x\to\infty} \Phi(x)/x = \infty$），使得 $\sup_{X \in \mathcal{X}} \mathbb{E}[\Phi(|X|)]  \infty$ [@problem_id:2973848] [@problem_id:2973879]。$L^p$ 有界准则就是该准则的一个特例，只需取 $\Phi(x) = x^p$ ($p>1$) 即可。

#### [Doob不等式](@entry_id:636737)与[一致可积性](@entry_id:199715)的联系

[Doob不等式](@entry_id:636737)在这里起到了桥梁作用。考虑一个[鞅](@entry_id:267779)序列 $(M_t^{(n)})_{t \in [0,T]}$。
1.  如果[终值](@entry_id:141018)族 $\{M_T^{(n)}\}$ 在 $L^p$ ($p>1$) 中有界，根据 $L^p$ 有界准则，该族是 **[一致可积](@entry_id:202893)的**。
2.  更进一步，根据Doob $L^p$ 不等式，终值族的 $L^p$ 有界性蕴含了[上确界](@entry_id:140512)族 $\{\sup_{0 \le t \le T} |M_t^{(n)}|\}$ 也在 $L^p$ 中有界。
3.  再次应用 $L^p$ 有界准则，我们得出结论：[上确界](@entry_id:140512)族 $\{\sup_{0 \le t \le T} |M_t^{(n)}|\}$ 也是 **[一致可积](@entry_id:202893)的** [@problem_id:2973879] [@problem_id:2973848]。

这个从终值UI到上确界UI的传递，是[Doob不等式](@entry_id:636737)一个极其重要的推论，对证明收敛定理至关重要。

### [可选停止定理](@entry_id:267890)：[一致可积性](@entry_id:199715)的应用

[可选停止定理](@entry_id:267890)（Optional Stopping Theorem, OST）回答了这样一个问题：对于一个鞅 $(M_t)$ 和一个停时 $T$，是否总有 $\mathbb{E}[M_T] = \mathbb{E}[M_0]$ 成立？答案是：不一定。

对于有界[停时](@entry_id:261799)，结论通常成立。但对于无界[停时](@entry_id:261799)，情况就变得非常微妙。许多看似“行为良好”的[鞅](@entry_id:267779)，在无界[停时](@entry_id:261799)下都会导致可选停止失效。

*   **反例1：布朗运动** [@problem_id:2973861]。令 $M_t=W_t$ 为从0出发的[标准布朗运动](@entry_id:197332)，这是一个鞅。令 $T = \inf\{t \ge 0 : W_t = 1\}$ 为首次到达1的时刻。这是一个[几乎必然](@entry_id:262518)有限但期望为无穷的停时。我们有 $\mathbb{E}[M_0]=\mathbb{E}[W_0]=0$，但由于路径的连续性，$M_T = W_T = 1$，所以 $\mathbb{E}[M_T]=1$。显然 $\mathbb{E}[M_T] \neq \mathbb{E}[M_0]$。这里的鞅 $(W_t)_{t \ge 0}$ 不是[一致可积](@entry_id:202893)的。

*   **反例2：简单随机游动** [@problem_id:2973856]。令 $S_n$ 为从1出发的简单对称随机游动，这是一个[鞅](@entry_id:267779)。令 $T = \inf\{n \ge 0: S_n=0\}$ 为首次到达0的时刻。同样，$T$ 几乎必然有限。我们有 $\mathbb{E}[S_0]=1$，但 $S_T=0$，因此 $\mathbb{E}[S_T]=0$。结论再次失效。

这些反例的共同点是，所涉及的鞅族 $\{M_t\}_{t \ge 0}$ 都不是[一致可积](@entry_id:202893)的。这揭示了UI的核心作用：它正是修复[可选停止定理](@entry_id:267890)的“补丁”。

**[可选停止定理](@entry_id:267890) (UI版本)**: 令 $(M_t)_{t \ge 0}$ 是一个右连续的 **[一致可积](@entry_id:202893)** [鞅](@entry_id:267779)。那么对于任意（有限或无限的）停时 $S$ 和 $T$，若 $S \le T$，则：
$$
\mathbb{E}[M_T | \mathcal{F}_S] = M_S \quad \text{a.s.}
$$
特别地，取 $S=0$，我们得到 $\mathbb{E}[M_T]=\mathbb{E}[M_0]$。

这个定理的证明策略清晰地展现了UI的威力 [@problem_id:2973856]。我们用一列有界[停时](@entry_id:261799) $T_n = T \wedge n$ 来逼近无界[停时](@entry_id:261799) $T$。对于每个 $n$，由于 $T_n$ 有界，可选停止成立，即 $\mathbb{E}[M_{T_n}]=\mathbb{E}[M_0]$。我们的目标是证明当 $n \to \infty$ 时，$\mathbb{E}[M_{T_n}] \to \mathbb{E}[M_T]$。要将极限与期望交换位置，我们需要 $L^1$ 收敛，即 $M_{T_n} \to M_T$ in $L^1$。而“[几乎必然收敛](@entry_id:265812)”升级为“$L^1$收敛”的充要条件，正是序列 $\{M_{T_n}\}$ 的[一致可积性](@entry_id:199715)。而鞅 $(M_t)_{t \ge 0}$ 本身的[一致可积性](@entry_id:199715)，可以保证 $\{M_{T_n}\}$ 也是[一致可积](@entry_id:202893)的。

最后，值得注意的是，对于在 **有限时间区间** $[0,T]$ 上的右[连续鞅](@entry_id:185466) $(M_t)_{t \in [0,T]}$，其本身就是[一致可积](@entry_id:202893)的。一个更强的结论是，由所有可能的[停时](@entry_id:261799)变量构成的族 $\{M_\tau : \tau \text{ 是任意停时且 } \tau \le T\}$ 也是[一致可积](@entry_id:202893)的 [@problem_id:2973848]。这背后的原因是，所有这些变量的[绝对值](@entry_id:147688)都被同一个可积的[随机变量](@entry_id:195330) $\sup_{0 \le t \le T} |M_t|$ 所控制，而根据Doob $L^1$ 弱不等式，这个上确界本身是可积的。这一性质确保了[可选停止定理](@entry_id:267890)在有限时间区间内的广泛适用性，并构成了许多其他理论（如随机积分）的坚实基础。