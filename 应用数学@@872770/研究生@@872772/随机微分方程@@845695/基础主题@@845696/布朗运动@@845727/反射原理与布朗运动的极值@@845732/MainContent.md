## 引言
在[随机过程](@entry_id:159502)的宏伟画卷中，布朗运动的**[反射原理](@entry_id:148504) (reflection principle)** 如同一颗璀璨的明珠，以其简洁的形式与深刻的内涵，成为了理解随机路径行为的基石。对于布朗运动这样一个无处不在的模型，仅仅了解其在任意时刻的（正态）[分布](@entry_id:182848)是远远不够的；我们更关心其整个路径的历史行为，例如它所能达到的最大高度，或是首次触及某个关键水平所需的时间。[反射原理](@entry_id:148504)恰好为解决这类 seemingly 复杂的[路径依赖](@entry_id:138606)问题提供了一个异常优美的工具，它巧妙地将路径[极值](@entry_id:145933)的计算转化为对终点位置概率的简单分析。

本文旨在系统性地剖析[反射原理](@entry_id:148504)，带领读者从其数学根基走向广阔的应用前沿。我们将分三个章节展开探讨：
-   在“**原理与机制**”一章中，我们将严格定义路径反射算子，并基于布朗运动的强马尔可夫性和对称性，揭示该原理成立的内在逻辑。随后，我们将推导出一系列经典结论，包括运行[极值](@entry_id:145933)与[首中时](@entry_id:266524)的[分布](@entry_id:182848)，以及最大值与终值的[联合分布](@entry_id:263960)，同时明确该原理的适用边界。
-   接下来，“**应用与跨学科联系**”一章将视野拓宽，展示[反射原理](@entry_id:148504)如何作为一座桥梁，将概率论与[偏微分方程](@entry_id:141332)（[镜像法](@entry_id:163138)）、金融工程（期权定价）、极限理论（[随机游走](@entry_id:142620)）乃至[演化生物学](@entry_id:145480)等领域紧密联系起来，并引出其在现代[随机分析](@entry_id:188809)中的终极推广——[斯科罗霍德问题](@entry_id:192596)与反射随机微分方程。
-   最后，通过“**动手实践**”部分，读者将有机会通过解决一系列精心设计的经典问题，亲手运用[反射原理](@entry_id:148504)及其推论，从而将理论知识内化为强大的分析技能，真正做到学以致用。

## 原理与机制

本章深入探讨布朗运动的**[反射原理](@entry_id:148504) (reflection principle)**，这是[随机过程](@entry_id:159502)理论中一个既优美又强大的工具。作为前一章“引言”的延续，我们不再赘述布朗运动的基本背景，而是直接从其核心机制出发。我们将首先严格定义路径反射算子，阐明其得以成立的深刻的[概率论基础](@entry_id:158925)——即布朗运动的强马尔可夫性和对称性。随后，我们将推导[反射原理](@entry_id:148504)的一系列重要推论，包括布朗运动的运行[极值分布](@entry_id:174061)、[首中时](@entry_id:266524)[分布](@entry_id:182848)，以及最大值与终值的联合分布。最后，我们将探讨该原理的适用边界，分析为何对于有漂移的布朗运动、非[连续路径](@entry_id:187361)过程或在弯曲边界上的运动，简单的反射论证会失效，并介绍如何在这种更复杂的几何情境下运用其思想进行[近似分析](@entry_id:160272)。

### 反射算子与[反射原理](@entry_id:148504)

理解[反射原理](@entry_id:148504)的第一步是精确定义其在路径空间上的作用。对于一个从原点出发的[连续函数](@entry_id:137361) $\omega \in C([0, \infty), \mathbb{R})$（例如布朗运动的一条样本路径），以及一个固定的水平 $a > 0$，我们首先定义其**[首中时](@entry_id:266524) (first hitting time)**：
$$
T_a(\omega) := \inf\{t \ge 0 : \omega(t) = a\}
$$
其中，若集合为空，则 $T_a(\omega) = +\infty$。基于此，我们可以定义**路径反射算子 (pathwise reflection map)** $\mathcal{R}_a$ [@problem_id:2993852]：
$$
\mathcal{R}_a(\omega)(s) := 
\begin{cases}
\omega(s), & s \le T_a(\omega), \\
2a - \omega(s), & s > T_a(\omega).
\end{cases}
$$
这个算子将路径在首次到达水平 $a$ 之前的部分保持不变，而将其后的部分关于水平线 $y=a$ 进行镜像反射。由于原始路径 $\omega$ 是连续的，且在 $s = T_a(\omega)$ 时有 $\omega(T_a(\omega)) = a$，我们可以验证反射后的路径 $\mathcal{R}_a(\omega)$ 仍然是连续的。

该算子具有两个重要的代数与[测度论](@entry_id:139744)性质。首先，$\mathcal{R}_a$ 是一个**对合 (involution)**，即对任意路径 $\omega$ 重复施加该算子会得到原路径：$\mathcal{R}_a(\mathcal{R}_a(\omega)) = \omega$。这是因为反射路径 $\tilde{\omega} = \mathcal{R}_a(\omega)$ 的[首中时](@entry_id:266524)与原路径相同，即 $T_a(\tilde{\omega}) = T_a(\omega)$，对其再次反射将恰好抵消第一次反射的效果 [@problem_id:2993852]。其次，从测度论角度看，该算子是**波莱尔可测的 (Borel measurable)**，这意味着它可以作为定义在概率空间上的[随机变量](@entry_id:195330)之间的有效变换，这是其在概率论中应用的前提 [@problem_id:2993852]。

然而，值得注意的是，尽管 $\mathcal{R}_a$ 在代数上表现良好，但它在装备了[紧集](@entry_id:147575)上[一致收敛](@entry_id:146084)拓扑的[连续函数空间](@entry_id:150395) $C([0, \infty), \mathbb{R})$ 中并非一个[连续算子](@entry_id:143297)。一个很小的扰动，例如将一条恰好在 $t=1$ 时刻触及水平 $a=1$ 的路径 $\omega(t)=t$ 变为 $\omega_n(t) = t - 1/n$，会导致其[首中时](@entry_id:266524)从 $1$ 突变为 $\infty$。这使得反射后的路径从一个[分段函数](@entry_id:160275)突变为一条直线，两者在 $t>1$ 后的函数值差异巨大，破坏了算子的连续性 [@problem_id:2993852]。

[反射原理](@entry_id:148504)的核心论断是：对于标准布朗运动 $(B_t)_{t \ge 0}$，反射算子 $\mathcal{R}_a$ 是一个[保测变换](@entry_id:270827)，即反射后的过程 $(\mathcal{R}_a(B)_t)_{t \ge 0}$ 与原始布朗运动具有相同的概率律。

这一深刻结果的背后是布朗运动的两个基本性质：**强马尔可夫性 (strong Markov property)** 和**增量的对称性 (symmetry of increments)** [@problem_id:2993815]。具体来说：
1.  根据强马尔可夫性，在停时 $T_a$ 之后，过程的行为如同从 $B_{T_a}=a$ 重新开始一个独立的布朗运动。也就是说，过程 $X_s = B_{T_a+s} - B_{T_a}$ (对于 $s \ge 0$) 是一个[标准布朗运动](@entry_id:197332)，并且独立于 $T_a$ 时刻之前的所有历史信息（即 $\mathcal{F}_{T_a}$ 代数）。
2.  [标准布朗运动](@entry_id:197332)的增量服从均值为零的[正态分布](@entry_id:154414)，该[分布](@entry_id:182848)是[中心对称](@entry_id:144242)的。这意味着一个标准布朗运动 $(X_s)_{s \ge 0}$ 与其[相反数](@entry_id:151709)过程 $(-X_s)_{s \ge 0}$ 具有完全相同的概率律。

结合这两点，我们来分析反射算子的作用。对于 $s > T_a$，原始路径为 $B_{T_a+s} = B_{T_a} + X_{s} = a + X_{s}$（此处为修正，应为 $B_{T_a+s} - B_{T_a}$ 是一个新的布朗运动，所以 $B_{T_a+s} = a + (B_{T_a+s} - B_{T_a})$）。而反射路径为 $\mathcal{R}_a(B)_{T_a+s} = 2a - B_{T_a+s} = 2a - (a+ (B_{T_a+s} - B_{T_a})) = a - (B_{T_a+s} - B_{T_a})$。由于 $(B_{T_a+s} - B_{T_a})_{s\ge 0}$ 与 $-(B_{T_a+s} - B_{T_a})_{s\ge 0}$ 同[分布](@entry_id:182848)，且独立于 $\mathcal{F}_{T_a}$，这意味着在给定 $T_a$ 之前的路径历史后，原始路径的“未来” $(a+(B_{T_a+s} - B_{T_a}))_{s\ge 0}$ 与反射路径的“未来” $(a-(B_{T_a+s} - B_{T_a}))_{s\ge 0}$ 具有相同的条件概率律。因为算子不改变 $T_a$ 之前的路径，且保持了 $T_a$ 之后路径的[条件分布](@entry_id:138367)，所以它保持了整个路径的联合分布。这就是[反射原理](@entry_id:148504)的精髓 [@problem_id:2993815] [@problem_id:2993852]。

### [反射原理](@entry_id:148504)的基本推论

[反射原理](@entry_id:148504)最直接且最著名的应用是计算布朗运动**运行最大值 (running maximum)** $M_t = \sup_{0 \le s \le t} B_s$ 的[分布](@entry_id:182848)。

对于任意 $a>0$，事件 $\{M_t \ge a\}$ 等价于布朗运动在 $[0, t]$ 时间内至少到达一次水平 $a$，即 $\{T_a \le t\}$。我们可以根据布朗运动在 $t$ 时刻的终值 $B_t$ 对该事件的概率进行分解：
$$
\mathbb{P}(M_t \ge a) = \mathbb{P}(T_a \le t) = \mathbb{P}(T_a \le t, B_t \ge a) + \mathbb{P}(T_a \le t, B_t  a)
$$
注意，由于 $B_t$ 的[分布](@entry_id:182848)是连续的，$\mathbb{P}(B_t = a)=0$，因此我们只需考虑严格不等式。

分析上式右侧的两项：
1.  如果 $B_t \ge a$，由于 $B_0=0$ 且路径连续，路径必然在 $[0, t]$ 的某个时刻穿过或到达 $a$。因此，事件 $\{B_t \ge a\}$ 是事件 $\{T_a \le t\}$ 的一个[子集](@entry_id:261956)。这意味着 $\mathbb{P}(T_a \le t, B_t \ge a) = \mathbb{P}(B_t \ge a)$。

2.  对于第二项 $\mathbb{P}(T_a \le t, B_t  a)$，我们可以运用[反射原理](@entry_id:148504)。考虑事件 $A = \{T_a \le t, B_t  a\}$ 中的任意一条路径。对其应用反射算子 $\mathcal{R}_a$，我们会得到一条新路径。由于 $t > T_a$，新路径在 $t$ 时刻的值为 $\mathcal{R}_a(B)_t = 2a - B_t$。因为原路径满足 $B_t  a$，所以新路径满足 $\mathcal{R}_a(B)_t > a$。由于[反射原理](@entry_id:148504)断言 $\mathcal{R}_a$ 是保测度的，这意味着事件 $A$ 的概率等于其在[反射变换](@entry_id:175518)下的像的概率。这个像就是事件 $\{ \mathcal{R}_a(B)_t > a \text{ and } T_a(\mathcal{R}_a(B)) \le t \}$。正如我们所知，$T_a(\mathcal{R}_a(B))=T_a(B)$，且 $\mathcal{R}_a(B)$ 与 $B$ 同[分布](@entry_id:182848)。因此，这个像事件的概率等于 $\mathbb{P}(B_t > a, T_a \le t) = \mathbb{P}(B_t > a)$。

综上，我们得到一个关键的等式 [@problem_id:2993817] [@problem_id:2993827]：
$$
\mathbb{P}(T_a \le t, B_t  a) = \mathbb{P}(B_t > a)
$$
将此结果代回最初的分解式，我们得到：
$$
\mathbb{P}(M_t \ge a) = \mathbb{P}(B_t \ge a) + \mathbb{P}(B_t > a) = 2 \mathbb{P}(B_t \ge a)
$$
此即为**Gnedenko-Borovkov公式**或[反射原理](@entry_id:148504)的经典形式 [@problem_id:2993817]。

为了得到一个更具体的表达式，我们利用 $B_t \sim \mathcal{N}(0,t)$ 的性质。令 $Z = B_t / \sqrt{t}$ 为标准正态[随机变量](@entry_id:195330)，其[累积分布函数 (CDF)](@entry_id:264700) 为 $\Phi(x)$。于是：
$$
\mathbb{P}(B_t \ge a) = \mathbb{P}\left(Z \ge \frac{a}{\sqrt{t}}\right) = 1 - \Phi\left(\frac{a}{\sqrt{t}}\right)
$$
所以，运行最大值的尾[分布](@entry_id:182848)为 [@problem_id:2993827]：
$$
\mathbb{P}(M_t \ge a) = 2 \left(1 - \Phi\left(\frac{a}{\sqrt{t}}\right)\right)
$$

这个结果直接引出了[首中时](@entry_id:266524) $T_a$ 的[分布](@entry_id:182848)。$T_a$ 的[累积分布函数](@entry_id:143135) $F_{T_a}(t) = \mathbb{P}(T_a \le t) = \mathbb{P}(M_t \ge a)$。通过对 $t$ 求导，我们可以得到 $T_a$ 的概率密度函数 (PDF) $f_{T_a}(t)$ [@problem_id:2993795]：
$$
f_{T_a}(t) = \frac{d}{dt} \left[ 2 \left(1 - \Phi\left(\frac{a}{\sqrt{t}}\right)\right) \right] = \frac{a}{\sqrt{2\pi t^3}} \exp\left(-\frac{a^2}{2t}\right), \quad t0
$$
这个[分布](@entry_id:182848)被称为**Lévy[分布](@entry_id:182848)**，是[稳定分布](@entry_id:194434)的一个特例。

### 布朗运动最大值与[终值](@entry_id:141018)的[联合分布](@entry_id:263960)

[反射原理](@entry_id:148504)的威力远不止于此，它还能帮助我们刻画最大值 $M_t$ 与[终值](@entry_id:141018) $B_t$ 的联合分布。我们的目标是导出[联合概率密度函数](@entry_id:267139) $f_{M_t, B_t}(m,x)$，其定义域为 $x \le m$。

一个有效的方法是先计算[联合累积分布函数](@entry_id:262093) $F_{M_t, B_t}(m,x) = \mathbb{P}(M_t \le m, B_t \le x)$，然后通过求导得到密度函数 [@problem_id:2993818]。对于 $x \le m$，我们可以进行如下分解：
$$
\mathbb{P}(B_t \le x) = \mathbb{P}(M_t \le m, B_t \le x) + \mathbb{P}(M_t > m, B_t \le x)
$$
移项整理得到：
$$
F_{M_t, B_t}(m,x) = \mathbb{P}(B_t \le x) - \mathbb{P}(M_t > m, B_t \le x)
$$
这里的第二项 $\mathbb{P}(M_t > m, B_t \le x)$ 可以再次通过[反射原理](@entry_id:148504)计算。一个路径在 $t$ 时刻前触及 $m$ 且终值为 $x \le m$，通过在[首中时](@entry_id:266524) $T_m$ 处反射，会映射到一条终值为 $2m-x$ 的路径。由于 $x \le m$，反射后的终点 $2m-x \ge m$。任何终点高于 $m$ 的路径必然在此前已触及 $m$。因此，这个变换给出了一个概率等式：
$$
\mathbb{P}(M_t > m, B_t \le x) = \mathbb{P}(B_t \ge 2m-x)
$$
将此代入，我们得到联合CDF的简洁形式：
$$
F_{M_t, B_t}(m,x) = \mathbb{P}(B_t \le x) - \mathbb{P}(B_t \ge 2m-x) = \Phi_t(x) - (1 - \Phi_t(2m-x))
$$
其中 $\Phi_t(y) = \Phi(y/\sqrt{t})$ 是 $\mathcal{N}(0,t)$ [分布](@entry_id:182848)的CDF。

[联合密度函数](@entry_id:263624) $f_{M_t, B_t}(m,x)$ 通过对CDF求[二阶偏导数](@entry_id:635213)得到 $f_{M_t, B_t}(m,x) = \frac{\partial^2}{\partial m \partial x} F_{M_t, B_t}(m,x)$。经过计算，我们最终得到 [@problem_id:2993818]：
$$
f_{M_t, B_t}(m,x) = \frac{2(2m-x)}{t\sqrt{2\pi t}} \exp\left(-\frac{(2m-x)^2}{2t}\right) = \frac{2(2m-x)}{t} \varphi_t(2m-x)
$$
其中 $\varphi_t(y)$ 是 $\mathcal{N}(0,t)$ [分布](@entry_id:182848)的密度函数。

这个结果也可以从一个与[偏微分方程](@entry_id:141332)相关的角度来理解，即**[镜像法](@entry_id:163138) (method of images)** [@problem_id:2993841] [@problem_id:2993829]。考虑一个在 $y=a$ 处有[吸收边界](@entry_id:201489)的布朗运动，其转移概率密度 $p(t,x,y)$ 满足[热方程](@entry_id:144435) $\frac{\partial p}{\partial t} = \frac{1}{2} \frac{\partial^2 p}{\partial y^2}$，边界条件为 $p(t,x,a) = 0$。从 $0$ 点出发的布朗运动在 $t$ 时刻位于 $x$ 且从未触及 $a$ 的[概率密度](@entry_id:175496) $\mathbb{P}(M_t  a, B_t \in dx)/dx$ 就等于这个被“杀死”的布朗运动的转移密度 $p(t,0,x)$。通过镜像法，我们可以在 $2a$ 处放置一个符号相反的“镜像源”，来构造满足边界条件的解：
$$
\mathbb{P}(M_t  a, B_t \in dx)/dx = \varphi_t(x) - \varphi_t(x-2a)
$$
这实际上就是我们之[前推](@entry_id:158718)导出的 $\frac{\partial}{\partial x}F_{M_t, B_t}(a,x)$。对这个关于 $a$ 的表达式求导，即 $-\frac{\partial}{\partial a}[\varphi_t(x) - \varphi_t(x-2a)]$，同样可以得到联合密度 $f_{M_t, B_t}(a,x)$ [@problem_id:2993841]。这揭示了概率论中的[反射原理](@entry_id:148504)与分析学中的[镜像法](@entry_id:163138)之间的深刻对偶性。

### [反射原理](@entry_id:148504)的适用边界

[反射原理](@entry_id:148504)的优雅与简洁建立在一系列严格的假设之上。当这些假设不被满足时，该原理便不再成立。理解其适用边界，对于正确应用和推广该思想至关重要。

1.  **路径连续性**：[反射原理](@entry_id:148504)的证明依赖于 $B_{T_a}=a$，即过程在首次触及边界时恰好停在边界上，没有**超射 (overshoot)**。对于有跳跃的[Lévy过程](@entry_id:266171)，如**[复合泊松过程](@entry_id:140283) (compound Poisson process)**，路径是不连续的。当这类过程“穿过”一个水平 $a$ 时，它通常会从一个低于 $a$ 的值直接跳到一个严格大于 $a$ 的值，即 $X_{T_a}  a$。此时，关于 $a$ 的反射操作失去了其几何与概率上的对称基础，经典的反射等式不再成立 [@problem_id:2993834]。

2.  **强马尔可夫性**：强马尔可夫性保证了过程在停时 $T_a$ 之后“忘记过去”，重新开始。如果一个过程不具备此性质，例如**分数布朗运动 (fractional Brownian motion)** 当其Hurst指数 $H \ne 1/2$ 时，其增量具有长程或短程相关性。这意味着过程在 $T_a$ 之后如何演化，会依赖于它是如何到达 $a$ 的。这种“记忆”效应破坏了反射论证所依赖的独立性，导致[反射原理](@entry_id:148504)失效 [@problem_id:2993834]。

3.  **增量对称性**：[标准布朗运动](@entry_id:197332)的增量具有关于[原点对称](@entry_id:172995)的[分布](@entry_id:182848)。如果我们在布朗运动中加入一个非零的**漂移项 (drift)** $\mu$，得到过程 $X_t = B_t + \mu t$，那么其在停时 $T_a$ 后的增量过程不再是对称的。例如，当 $\mu  0$ 时，过程在击中 $a$ 后更倾向于继续上升而非下降。这种不对称性破坏了 $\mathbb{P}(T_a \le t, X_t  a) = \mathbb{P}(T_a \le t, X_t > a)$ 这一关键等式，因此标准[反射原理](@entry_id:148504)不再适用 [@problem_id:2993817] [@problem_id:2993834]。对于[带漂移的布朗运动](@entry_id:275071)，其[极值分布](@entry_id:174061)需要通过[Girsanov定理](@entry_id:147068)等更高级的工具来推导。

4.  **边界的几何形状**：标准的[反射原理](@entry_id:148504)适用于**仿射[超平面](@entry_id:268044) (affine hyperplanes)** 边界。这是因为关于[超平面](@entry_id:268044)的反射是一种保持距离和角度的全局**[等距变换](@entry_id:150881) (isometry)**，这种变换同样保持了布朗运动的律。然而，对于**弯曲边界 (curved boundaries)**，不存在这样的[全局等距](@entry_id:184658)变换 [@problem_id:2993823]。任何试图逐点定义的“反射”都将是依赖于随机撞击点的[非线性变换](@entry_id:636115)，它会破坏布朗运动增量的独立性和正态性。因此，对于一般弯曲边界，不存在精确的[反射原理](@entry_id:148504)公式。但是，反射的思想在近似计算中依然有效。对于从点 $x$ 出发，距离边界 $\partial D$ [最近距离](@entry_id:164459)为 $\delta$ 的情况，在**小时间极限 ($t \downarrow 0$)** 下，能够击中边界的路径几乎都是沿最短路径直线运动的。因此，我们可以用边界在最近点 $\hat{x}$ 处的**切超平面 (tangent hyperplane)** 来局部近似弯曲边界。应用一维[反射原理](@entry_id:148504)，我们得到[首中时](@entry_id:266524)概率的领先阶渐近行为 [@problem_id:2993823]：
    $$
    \mathbb{P}_x(\tau_{\partial D} \le t) \sim 2\bar{\Phi}(\delta/\sqrt{t}) \quad \text{as } t \downarrow 0
    $$
    其中 $\bar{\Phi}$ 是标准正态分布的[尾概率](@entry_id:266795)函数。这表明，虽然精确的等式不再成立，[反射原理](@entry_id:148504)的思想为分析复杂几何中的[随机过程](@entry_id:159502)行为提供了强大的启发和近似工具。

### 推广：区间上的反射与热核

我们将[反射原理](@entry_id:148504)与[镜像法](@entry_id:163138)的思想推广到更复杂的情形——在有界区间 $(0,a)$ 内运动的布朗运动。此时，布朗运动在 $0$ 和 $a$ 两点均被吸收。

如前所述，对于半直线 $(0, \infty)$，被杀死过程的转移密度（即[热核](@entry_id:172041)）是通过在 $y=0$ 处作奇延拓得到的：
$$
p_{(0,\infty)}(t,x,y) = p_{\mathbb{R}}(t,x,y) - p_{\mathbb{R}}(t,x,-y)
$$
其中 $p_{\mathbb{R}}$ 是自由空间中的[热核](@entry_id:172041)。

对于区间 $(0,a)$，我们需要同时满足在 $y=0$ 和 $y=a$ 处的[吸收边界条件](@entry_id:164672)，即 $p_{(0,a)}(t,x,0)=0$ 和 $p_{(0,a)}(t,x,a)=0$。这需要通过无穷多次反射来实现，这在概率上对应于应用**容斥原理 (inclusion-exclusion principle)** [@problem_id:2993829]。

考虑从 $x \in (0,a)$ 到 $y \in (0,a)$ 的路径：
- **0次反射**：直接从 $x$ 到 $y$ 的路径，贡献为 $+p_{\mathbb{R}}(t,x,y)$。
- **1次反射**：为了满足边界条件，我们减去那些击中边界的路径。击中 $0$ 的路径等价于从 $x$ 到镜像点 $-y$ 的路径（贡献 $-p_{\mathbb{R}}(t,x,-y)$）；击中 $a$ 的路径等价于从 $x$ 到镜像点 $2a-y$ 的路径（贡献 $-p_{\mathbb{R}}(t,x,2a-y)$）。
- **2次反射**：上述操作重复计算了那些既击中 $0$ 又击中 $a$ 的路径。例如，先击中 $0$ 再击中 $a$ 的路径，等价于将镜像点 $-y$ 再关于 $a$ 反射到 $2a-(-y)=2a+y$。根据[容斥原理](@entry_id:276055)，我们需要加回这部分，贡献为 $+p_{\mathbb{R}}(t,x,y+2a)$。类似地，先击中 $a$ 再击中 $0$ 的路径对应镜像点 $y-2a$，贡献为 $+p_{\mathbb{R}}(t,x,y-2a)$。

这个过程无限进行下去，产生了一系列镜像点。一个镜像点的位置是通过对初始点 $y$ 或 $-y$ 进行形如 $z \mapsto 2ka \pm z$ 的平移和[反射变换](@entry_id:175518)得到的。其贡献的符号由反射次数的奇偶性决定：偶数次反射为正，奇数次反射为负。最终，所有贡献求和，得到区间 $(0,a)$ 上的[热核](@entry_id:172041)表达式 [@problem_id:2993829]：
$$
p_{(0,a)}(t,x,y) = \sum_{k \in \mathbb{Z}} \left[ p_{\mathbb{R}}(t,x,y+2ka) - p_{\mathbb{R}}(t,x,-y+2ka) \right]
$$
这个无穷级数解优雅地编码了布朗运动在受限空间中所有可能路径的概率总和，完美地展现了[反射原理](@entry_id:148504)从单个几何洞察到构造复杂分析解的强大能力。