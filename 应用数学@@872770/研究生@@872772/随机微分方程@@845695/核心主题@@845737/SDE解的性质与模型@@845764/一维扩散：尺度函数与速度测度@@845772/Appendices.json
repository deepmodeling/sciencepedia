{"hands_on_practices": [{"introduction": "理解尺度函数和速度测度的最佳方式，莫过于将其应用于最基础的扩散过程：标准布朗运动。本练习将提供一个具体的起点，引导你从第一性原理出发，为过程 $dX_t = dW_t$ 计算这些工具，并利用它们来严格验证布朗运动众所周知的常返性。这有助于你将抽象的定义与随机过程的具体行为联系起来。[@problem_id:2993119]", "problem": "考虑在整个实直线上的一维扩散，其定义为随机微分方程 (SDE) $dX_{t}=dW_{t}$ 的唯一弱解，其中 $W_{t}$ 是标准一维布朗运动。仅从 Itô 公式、扩散生成元的定义以及一维扩散的标度函数和速度测度的定义出发，完成以下任务：\n\n1. 确定 $X$ 的一个严格递增的标度函数 $s$，并通过施加条件 $s(0)=0$ 和 $s'(0)=1$ 来固定其仿射归一化。\n2. 确定 $X$ 相对于勒贝格测度的速度密度 $m'(x)$。\n3. 使用以标度函数和速度测度表示的一维扩散的一般边界分类准则，推断该扩散在 $\\mathbb{R}$ 上是常返的还是暂留的。\n\n按此顺序将您的最终答案报告为行矩阵 $\\bigl(s(x),\\,m'(x)\\bigr)$。不需要数值近似；请提供精确表达式。常返性/暂留性的结论应在您的解题过程中给出证明，但它不是最终报告矩阵的一部分。", "solution": "用户希望我分析一个一维扩散过程。\n\n### 步骤 1：提取已知条件\n-   随机微分方程 (SDE) 为 $dX_{t}=dW_{t}$。\n-   $W_{t}$ 是一个标准一维布朗运动。\n-   状态空间是实直线 $\\mathbb{R}$。\n-   过程 $X_{t}$ 是该 SDE 的唯一弱解。\n-   使用的工具：Itô 公式、扩散生成元的定义、以及标度函数和速度测度的定义。\n-   任务 1：确定一个严格递增的标度函数 $s(x)$，其归一化条件为 $s(0)=0$ 和 $s'(0)=1$。\n-   任务 2：确定相对于勒贝格测度的速度密度 $m'(x)$。\n-   任务 3：使用标度函数和速度测度推断在 $\\mathbb{R}$ 上的常返性或暂留性。\n-   最终答案：一个包含 $s(x)$ 和 $m'(x)$ 表达式的行矩阵。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数学上和科学上都是合理的。它涉及标准布朗运动的基本性质，这是随机分析的基石。生成元、标度函数、速度测度以及常返性/暂留性的概念在一维扩散理论中都是标准且定义明确的。该问题是自洽的，SDE 提供了关于扩散系数的所有必要信息。标度函数的归一化条件确保了 $s(x)$ 的唯一解。整个问题是适定的、客观的，没有缺失信息、矛盾或主观因素。\n\n### 步骤 3：结论与行动\n该问题有效。我将继续进行解答。\n\n***\n\n给定的随机微分方程是 $dX_{t}=dW_{t}$。这是一个一般形式为 $dX_{t} = b(X_t)dt + \\sigma(X_t)dW_{t}$ 的一维 Itô 扩散，其中漂移系数为 $b(x) = 0$，扩散系数为 $\\sigma(x) = 1$。\n\n该扩散过程的无穷小生成元 $\\mathcal{L}$ 通过 Itô 公式定义。对于一个二次连续可微函数 $f(x)$，生成元由下式给出：\n$$\n\\mathcal{L}f(x) = b(x)\\frac{df}{dx} + \\frac{1}{2}\\sigma(x)^2\\frac{d^2f}{dx^2}\n$$\n代入 $b(x)=0$ 和 $\\sigma(x)=1$，该特定过程的生成元为：\n$$\n\\mathcal{L}f(x) = \\frac{1}{2}\\frac{d^2f}{dx^2}\n$$\n\n**1. 确定标度函数 $s(x)$**\n\n一维扩散的标度函数 $s(x)$ 是一个满足方程 $\\mathcal{L}s(x) = 0$ 的非常数函数。对于此扩散，该条件为：\n$$\n\\frac{1}{2}\\frac{d^2s}{dx^2} = 0\n$$\n可简化为 $s''(x) = 0$。\n将此常微分方程对 $x$ 积分一次，得到：\n$$\n\\frac{ds}{dx} = C_1\n$$\n其中 $C_1$ 是一个积分常数。再次积分，得到标度函数的一般形式：\n$$\ns(x) = C_1 x + C_2\n$$\n其中 $C_2$ 是另一个积分常数。\n\n问题提供了两个归一化条件来唯一确定 $s(x)$。\n首先，$s(0) = 0$。将此应用于通解：\n$$\ns(0) = C_1(0) + C_2 = 0 \\implies C_2 = 0\n$$\n其次，$s'(0) = 1$。$s(x)$ 的导数是 $s'(x) = C_1$。应用该条件：\n$$\ns'(0) = C_1 = 1\n$$\n因此，常数为 $C_1 = 1$ 和 $C_2 = 0$。满足给定归一化条件的唯一的、严格递增的标度函数是：\n$$\ns(x) = x\n$$\n该函数是严格递增的，因为其导数 $s'(x) = 1$ 为正。\n\n**2. 确定速度密度 $m'(x)$**\n\n生成元 $\\mathcal{L}$ 可以用标度函数 $s(x)$ 和速度测度来表示，速度测度相对于勒贝格测度具有密度 $m'(x)$。连接 Itô 生成元 $\\mathcal{L} = b(x)\\partial_x + \\frac{1}{2}\\sigma^2(x)\\partial_x^2$ 与 Feller-McKean 生成元 $G = \\frac{1}{m'(x)}\\frac{d}{dx}(\\frac{1}{s'(x)}\\frac{d}{dx})$ 的标准关系是它们是相同的，即 $\\mathcal{L}=G$。\n\n我们来展开 Feller-McKean 生成元：\n$$\nG f(x) = \\frac{1}{m'(x)} \\frac{d}{dx} \\left( \\frac{f'(x)}{s'(x)} \\right) = \\frac{1}{m'(x)} \\left[ \\frac{f''(x)}{s'(x)} - \\frac{f'(x)s''(x)}{(s'(x))^2} \\right]\n$$\n我们将其等同于 $\\mathcal{L}f(x) = b(x)f'(x) + \\frac{1}{2}\\sigma(x)^2f''(x)$。\n比较 $f''(x)$ 的系数：\n$$\n\\frac{1}{m'(x)s'(x)} = \\frac{1}{2}\\sigma(x)^2 \\implies m'(x) = \\frac{2}{\\sigma(x)^2 s'(x)}\n$$\n比较 $f'(x)$ 的系数：\n$$\n-\\frac{s''(x)}{m'(x)(s'(x))^2} = b(x) \\implies s''(x) = -b(x) m'(x) (s'(x))^2\n$$\n这也得到了关于 $s'(x)$ 的已知常微分方程，因为代入 $m'(x)$ 的表达式可得 $s''(x) = -b(x) \\left( \\frac{2}{\\sigma(x)^2 s'(x)} \\right) (s'(x))^2 = -\\frac{2b(x)}{\\sigma(x)^2}s'(x)$，积分后即可得到标度函数。\n\n使用导出的速度密度公式 $m'(x) = \\frac{2}{\\sigma(x)^2 s'(x)}$，并结合我们的已知值 $\\sigma(x)=1$ 和 $s'(x)=1$：\n$$\nm'(x) = \\frac{2}{1^2 \\cdot 1} = 2\n$$\n因此，速度密度是常数，$m'(x) = 2$。\n\n**3. 常返性与暂留性**\n\n在区间 $(l, r)$ 上的一维扩散根据其标度函数在边界处的行为被分类为常返或暂留。当且仅当过程在有限期望时间内既不能到达 $l$ 也不能到达 $r$ 时，该过程是**常返**的。这对应于标度函数在左边界处趋于 $-\\infty$ 并在右边界处趋于 $+\\infty$。\n在数学上，扩散是常返的当且仅当：\n$$\ns(l) = \\lim_{x \\to l^+} s(x) = -\\infty \\quad \\text{and} \\quad s(r) = \\lim_{x \\to r^-} s(x) = +\\infty\n$$\n如果任一极限是有限的，则过程是暂留的，因为它可以从该边界逃逸。\n\n对于本问题，扩散是在整个实直线上，因此区间是 $(l, r) = (-\\infty, \\infty)$。我们已经求得标度函数为 $s(x) = x$。现在我们计算在边界处的极限：\n-   在右边界，$r = +\\infty$：\n$$\n\\lim_{x \\to \\infty} s(x) = \\lim_{x \\to \\infty} x = +\\infty\n$$\n-   在左边界，$l = -\\infty$：\n$$\n\\lim_{x \\to -\\infty} s(x) = \\lim_{x \\to -\\infty} x = -\\infty\n$$\n由于两个条件（$s(-\\infty) = -\\infty$ 和 $s(+\\infty) = +\\infty$）都满足，该扩散是**常返**的。这是标准一维布朗运动的著名性质。\n\n问题要求提供行矩阵 $(s(x), m'(x))$。根据我们的推导，结果是 $(x, 2)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nx  2\n\\end{pmatrix}\n}\n$$", "id": "2993119"}, {"introduction": "在标准布朗运动的基础上，本练习探讨了引入一个恒定漂移项 $\\mu$ 所带来的影响。通过为随机微分方程 $dX_{t} = \\mu dt + \\sigma dW_{t}$ 计算速度测度，你将直接观察到漂移如何影响过程的长期行为。这个练习将让你运用速度测度的总质量来理解为何当 $\\mu \\neq 0$ 时，过程不存在平稳分布。[@problem_id:2989164]", "problem": "考虑$\\mathbb{R}$上的一维扩散 $X = \\{X_{t}: t \\ge 0\\}$，它被定义为随机微分方程 (SDE) $dX_{t} = \\mu\\,dt + \\sigma\\,dW_{t}$ 的唯一强解，其中漂移 $\\mu \\in \\mathbb{R}$ 和波动率 $\\sigma > 0$ 为常数，$W = \\{W_{t}\\}_{t \\ge 0}$ 是标准布朗运动。假设端点 $-\\infty$ 和 $+\\infty$ 均为自然边界，因此该过程在 $\\mathbb{R}$ 上是保守且正则的。\n\n仅从一维正则扩散的核心定义出发：\n- 标度函数 $s$ 是 $L s = 0$ 的一个严格递增的 $C^{2}$ 解，其中 $L$ 是 $X$ 的无穷小生成元，作用于光滑紧支集检验函数，以及\n- 速度测度 $m$ 是唯一的（在相差一个正常数倍的意义下）$\\sigma$-有限波莱尔测度，它在光滑紧支集函数的核心上使得 $L$ 在 $L = \\frac{d}{dm}\\frac{d}{ds}$ 的意义下形式上自伴，\n\n完成以下步骤：\n1. 确定 $X$ 的生成元 $L$ 并求解 $L s = 0$，以获得标度密度 $s'(x)$（在相差一个正常数倍的意义下）。\n2. 使用恒等式 $L = \\frac{d}{dm}\\frac{d}{ds}$ 以及您得到的 $s'(x)$ 的结果，推导出速度密度 $m'(x)$（即 $m$ 相对于勒贝格测度的拉东-尼科迪姆导数），在相差一个正常数倍的意义下。\n3. 计算总质量 $m(\\mathbb{R}) = \\int_{\\mathbb{R}} m'(x)\\,dx$，并证明当 $\\mu \\ne 0$ 时，该总质量为 $+\\infty$。\n4. 仅使用正则扩散的不变测度（特别是可逆测度）通过速度测度进行的刻画，解释为什么当 $\\mu \\ne 0$ 时，$m(\\mathbb{R}) = \\infty$ 意味着不存在有限不变概率测度。\n\n将 $m(\\mathbb{R})$ 作为您的最终答案（无需四舍五入）。", "solution": "一维扩散 $X_t$ 由随机微分方程 (SDE) $dX_{t} = \\mu\\,dt + \\sigma\\,dW_{t}$ 定义，其中 $\\mu \\in \\mathbb{R}$ 是常数漂移，$\\sigma > 0$ 是常数波动率。\n\n步骤1：确定 $X$ 的生成元 $L$ 并求解标度密度 $s'(x)$。\n对于由 SDE $dX_t = b(X_t)dt + \\eta(X_t)dW_t$ 描述的扩散过程，其无穷小生成元 $L$ 由算子 $L = b(x)\\frac{d}{dx} + \\frac{1}{2}\\eta^2(x)\\frac{d^2}{dx^2}$ 给出。对于给定的 SDE，我们有 $b(x) = \\mu$ 和 $\\eta(x) = \\sigma$。因此，生成元为：\n$$L = \\mu \\frac{d}{dx} + \\frac{\\sigma^2}{2} \\frac{d^2}{dx^2}$$\n根据定义，标度函数 $s(x)$ 是微分方程 $L s(x) = 0$ 的一个严格递增的 $C^2$ 解。\n$$\\mu s'(x) + \\frac{\\sigma^2}{2} s''(x) = 0$$\n令 $u(x) = s'(x)$，我们得到关于标度密度 $s'(x)$ 的一个一阶线性常微分方程：\n$$\\frac{\\sigma^2}{2} u'(x) + \\mu u(x) = 0 \\implies u'(x) = -\\frac{2\\mu}{\\sigma^2} u(x)$$\n其解的形式为 $u(x) = C \\exp\\left(-\\frac{2\\mu}{\\sigma^2} x\\right)$，其中 $C$ 是某个常数。由于 $s(x)$ 是严格递增的，$s'(x) = u(x)$ 必须为正，这意味着 $C > 0$。由于标度密度是在相差一个正常数倍的意义下定义的，我们可以不失一般性地设 $C=1$。\n$$s'(x) = \\exp\\left(-\\frac{2\\mu}{\\sigma^2} x\\right)$$\n\n步骤2：推导速度密度 $m'(x)$。\n速度测度 $m$ 由关系式 $L = \\frac{d}{dm}\\frac{d}{ds}$ 刻画。速度测度相对于勒贝格测度的密度记为 $m'(x)$，因此 $dm = m'(x) dx$。将右侧的算子作用于一个光滑检验函数 $f(x)$，得到：\n$$L f(x) = \\frac{d}{dm}\\left(\\frac{df}{ds}\\right) = \\frac{1}{m'(x)}\\frac{d}{dx}\\left(\\frac{df/dx}{ds/dx}\\right) = \\frac{1}{m'(x)}\\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)$$\n应用微分的商法则，得到：\n$$L f(x) = \\frac{1}{m'(x)} \\frac{f''(x)s'(x) - f'(x)s''(x)}{(s'(x))^2} = \\frac{1}{m'(x)s'(x)}f''(x) - \\frac{s''(x)}{m'(x)(s'(x))^2}f'(x)$$\n将此结果与生成元的已知表达式 $L f(x) = \\frac{\\sigma^2}{2} f''(x) + \\mu f'(x)$ 相等，并比较 $f''(x)$ 项的系数，我们得到：\n$$\\frac{\\sigma^2}{2} = \\frac{1}{m'(x)s'(x)}$$\n由此，我们解出速度密度 $m'(x)$：\n$$m'(x) = \\frac{2}{\\sigma^2 s'(x)}$$\n代入步骤1中求得的 $s'(x)$ 的表达式：\n$$m'(x) = \\frac{2}{\\sigma^2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2} x\\right)} = \\frac{2}{\\sigma^2} \\exp\\left(\\frac{2\\mu}{\\sigma^2} x\\right)$$\n这就是速度密度，在相差一个正常数倍的意义下。\n\n步骤3：计算总质量 $m(\\mathbb{R})$ 并证明当 $\\mu \\ne 0$ 时其值为无穷大。\n速度测度的总质量是其密度在整个状态空间 $\\mathbb{R}$ 上的积分：\n$$m(\\mathbb{R}) = \\int_{-\\infty}^{+\\infty} m'(x) \\,dx = \\int_{-\\infty}^{+\\infty} \\frac{2}{\\sigma^2} \\exp\\left(\\frac{2\\mu}{\\sigma^2} x\\right) \\,dx$$\n令 $k = \\frac{2\\mu}{\\sigma^2}$。积分为 $\\frac{2}{\\sigma^2} \\int_{-\\infty}^{+\\infty} e^{kx} \\,dx$。我们关心的是 $\\mu \\ne 0$ 的情况，这意味着 $k \\ne 0$。\n如果 $\\mu > 0$，则 $k > 0$，积分计算结果为：\n$$\\int_{-\\infty}^{+\\infty} e^{kx} \\,dx = \\left[\\frac{1}{k}e^{kx}\\right]_{-\\infty}^{+\\infty} = \\lim_{b\\to+\\infty} \\frac{e^{kb}}{k} - \\lim_{a\\to-\\infty} \\frac{e^{ka}}{k} = \\infty - 0 = +\\infty$$\n如果 $\\mu  0$，则 $k  0$，积分计算结果为：\n$$\\int_{-\\infty}^{+\\infty} e^{kx} \\,dx = \\left[\\frac{1}{k}e^{kx}\\right]_{-\\infty}^{+\\infty} = \\lim_{b\\to+\\infty} \\frac{e^{kb}}{k} - \\lim_{a\\to-\\infty} \\frac{e^{ka}}{k} = 0 - (-\\infty) = +\\infty$$\n在 $\\mu \\ne 0$ 的两种情况下，积分都发散。因此，速度测度的总质量是无穷大。\n$$m(\\mathbb{R}) = +\\infty$$\n\n步骤4：解释与不变测度的联系。\n对于一个正则一维扩散，任何不变测度的密度 $\\pi(x)$ 都与速度密度 $m'(x)$ 成正比。因此，$\\pi(x) = C \\cdot m'(x)$，其中 $C > 0$ 是某个常数。要使 $\\pi$ 成为一个概率测度，其总质量积分必须为1：\n$$\\int_{\\mathbb{R}} \\pi(x) \\,dx = \\int_{\\mathbb{R}} C \\cdot m'(x) \\,dx = C \\int_{\\mathbb{R}} m'(x) \\,dx = C \\cdot m(\\mathbb{R}) = 1$$\n这个方程只有在 $m(\\mathbb{R})$ 是一个有限非零值时才能成立，此时可以选择 $C = 1/m(\\mathbb{R})$。\n然而，如步骤3所证，当漂移 $\\mu \\ne 0$ 时，速度测度的总质量为 $m(\\mathbb{R}) = +\\infty$。对于任何 $C > 0$，候选不变测度的总质量为 $C \\cdot (+\\infty) = +\\infty$。\n由于总质量是无穷大且无法归一化为1，因此当 $\\mu \\ne 0$ 时，该过程不存在有限不变测度，从而也不存在不变概率测度。这与具有净漂移的过程是暂留的并且不会收敛到 $\\mathbb{R}$ 上的平稳分布的直觉是一致的。", "answer": "$$\\boxed{+\\infty}$$", "id": "2989164"}, {"introduction": "最后的这项练习将抽象理论与计算应用联系起来，要求你像一位量化建模者一样思考，为一维扩散过程设计一个数值模拟方案。你将运用尺度变换和 Dambis-Dubins-Schwarz 时间变换定理，理解如何正确地离散化过程，从而使其模拟出的长期行为（即占有时间）能够精确地反映由速度测度所决定的理论性质。[@problem_id:2989182]", "problem": "考虑一个定义在开区间 $(\\ell,r)$ 上的一维扩散过程，其随机微分方程为 $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$，其中 $b:\\,(\\ell,r)\\to\\mathbb{R}$ 和 $\\sigma:\\,(\\ell,r)\\to(0,\\infty)$ 是充分光滑的函数，$W_t$ 是一个标准维纳过程。令 $L$表示无穷小生成元，它作用于二次连续可微函数 $f$ 上，其形式为 $L f(x) = \\tfrac{1}{2}\\sigma^2(x) f''(x) + b(x) f'(x)$。一个（严格递增的）标度函数 $s$ 由 $L s = 0$ 在 $(\\ell,r)$ 上成立的要求所定义，而速度测度 $m$ 是使得 $L$ 在 $(\\ell,r)$ 上承认分解 $L = \\tfrac{d}{dm}\\tfrac{d}{ds}$ 的唯一测度。\n\n定义标度变换后的过程 $Y_t := s(X_t)$。根据伊藤公式及性质 $L s = 0$，可知 $Y_t$ 是一个具有状态依赖波动率的无漂移连续局部鞅。记 $g(y) := s'(s^{-1}(y))\\,\\sigma(s^{-1}(y))$，则有 $dY_t = g(Y_t)\\,dW_t$，且其二次变差满足 $d\\langle Y\\rangle_t = g^2(Y_t)\\,dt$。Dambis–Dubins–Schwarz (DDS) 定理保证存在一个标准布朗运动 $B_u$，使得 $Y_t = B_{A_t}$，其中 $A_t := \\langle Y\\rangle_t = \\int_0^t g^2(Y_s)\\,ds$，即物理时间 $t$ 和布朗时钟 $u$ 通过 $du = g^2(Y_t)\\,dt$ 相关联。\n\n你的目标是在标度坐标 $Y$ 中设计一个显式欧拉-丸山格式，并评估哪种离散化方法在通过 $X = s^{-1}(Y)$ 映射回原坐标时能正确地近似 $X$ 的速度测度。你必须确定哪个选项实现了基于二次变差的正确时间重标度，从而使得物理时间中的经验逗留测度能够近似连续时间的速度测度。\n\n选择在上述意义下正确的选项。\n\nA. 在标度坐标中使用一个具有恒定方差步长的布朗增量，并通过瞬时二次变差的倒数来调整物理时间：对于一个小的参数 $h0$，设 $Y_{n+1} = Y_n + \\xi_n\\sqrt{h}$，其中 $\\xi_n \\sim \\mathcal{N}(0,1)$ 是独立的，通过 $t_{n+1} = t_n + h/g^2(Y_n)$ 更新物理时间，并通过 $X_{n+1} = s^{-1}(Y_{n+1})$ 映射回原坐标。这保持了布朗时钟增量 $\\Delta u_n = h$ 为常数，并在物理时间内产生与速度测度一致的逗留密度。\n\nB. 在标度坐标中使用标准的欧拉-丸山格式，采用固定的物理时间步长和状态依赖的波动率：设 $Y_{n+1} = Y_n + g(Y_n)\\,\\xi_n\\sqrt{h}$，其中 $\\xi_n \\sim \\mathcal{N}(0,1)$ 是独立的，更新 $t_{n+1} = t_n + h$，并通过 $X_{n+1} = s^{-1}(Y_{n+1})$ 映射回原坐标。由于在标度坐标中漂移项已被移除，因此不需要进行时间重标度来近似正确的速度。\n\nC. 将标度坐标视为一个没有任何状态依赖且不进行时间重标度的标准布朗运动：设 $Y_{n+1} = Y_n + \\xi_n\\sqrt{h}$，$t_{n+1} = t_n + h$，以及 $X_{n+1} = s^{-1}(Y_{n+1})$。这样，物理时间中的逗留测度在 $Y$ 坐标上是均匀分布的，这在映射回原坐标后与速度测度相匹配。\n\nD. 仅使用原始坐标中的扩散系数来重标度物理时间，同时保持标度坐标中的布朗增量：设 $Y_{n+1} = Y_n + \\xi_n\\sqrt{h}$，$t_{n+1} = t_n + h/\\sigma^2(s^{-1}(Y_n))$，以及 $X_{n+1} = s^{-1}(Y_{n+1})$。因子 $s'$ 是不必要的，因为在标度坐标中漂移为零，所以这样的时间重标度足以恢复正确的速度。", "solution": "用户希望对一个关于一维扩散过程的数值模拟及其与标度函数和速度测度的关系的问题进行批判性分析。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n-   一维扩散过程由随机微分方程 (SDE) $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$ 在开区间 $(\\ell,r)$ 上定义。\n-   系数 $b:\\,(\\ell,r)\\to\\mathbb{R}$ 和 $\\sigma:\\,(\\ell,r)\\to(0,\\infty)$ 假定为充分光滑。\n-   $W_t$ 是一个标准维纳过程。\n-   无穷小生成元是 $L f(x) = \\tfrac{1}{2}\\sigma^2(x) f''(x) + b(x) f'(x)$。\n-   一个严格递增的标度函数 $s$ 由条件 $L s = 0$ 在 $(\\ell,r)$ 上成立来定义。\n-   速度测度 $m$ 被定义为使得生成元可以分解为 $L = \\tfrac{d}{dm}\\tfrac{d}{ds}$。\n-   标度变换后的过程是 $Y_t := s(X_t)$。\n-   变换后过程的 SDE 是 $dY_t = g(Y_t)\\,dW_t$，其中 $g(y) := s'(s^{-1}(y))\\,\\sigma(s^{-1}(y))$。\n-   $Y_t$ 的二次变差是 $d\\langle Y\\rangle_t = g^2(Y_t)\\,dt$。\n-   Dambis–Dubins–Schwarz (DDS) 定理意味着存在一个标准布朗运动 $B_u$，使得 $Y_t = B_{A_t}$，其中时间变换是 $A_t := \\langle Y\\rangle_t = \\int_0^t g^2(Y_s)\\,ds$。\n-   物理时间 $t$ 和布朗时钟 $u$ 之间的微分关系是 $du = g^2(Y_t)\\,dt$。\n-   目标是确定一个在 $Y$ 坐标系下的数值离散格式，该格式能正确实现时间重标度，以近似原始过程 $X$ 的速度测度。\n\n**第2步：使用已知条件进行验证**\n\n-   **科学基础**：该问题植根于一维随机微分方程的标准且成熟的数学理论。无穷小生成元、标度函数、速度测度、伊藤公式以及 Dambis–Dubins–Schwarz 定理等概念都是基础且表述正确的。对标度变换后过程 $Y_t$ 的 SDE 的推导是准确的。扩散过程的逗留测度与其速度测度之间的关系是该理论的基石。该问题在科学和数学上是合理的。\n-   **良定性**：该问题是良定的。它提出了一个清晰的理论框架，并要求确定一个与该框架一致的数值格式。目标——通过适当的时间重标度来近似速度测度——是具体的，并且允许通过从所提供的原则进行逻辑推导来确定唯一的正确答案。\n-   **客观性**：该问题以精确、客观和无偏见的数学语言陈述。没有主观因素。\n\n**第3步：结论与行动**\n\n问题陈述是有效的。它在科学上合理、良定且客观。没有矛盾、歧义或缺失信息会妨碍严谨的求解。继续进行求解推导。\n\n### 推导与选项分析\n\n问题的核心在于过程 $X_t$ 的物理时间 $t$ 与标度变换后过程 $Y_t = s(X_t)$ 的内蕴时间（或称“布朗时钟”）$u$ 之间的关系。Dambis–Dubins–Schwarz 定理通过 $Y_t$ 的二次变差提供了这种关系。\n\n$Y_t$ 的 SDE 是 $dY_t = g(Y_t)dW_t$。其二次变差是 $d\\langle Y \\rangle_t = g^2(Y_t)dt$。DDS 定理确立了 $Y_t$ 可以表示为一个标准布朗运动 $B$ 在新时间 $u = A_t = \\langle Y \\rangle_t$ 处的值。这种时间变换的微分形式是：\n$$ du = g^2(Y_t)\\,dt $$\n这个方程是核心。它告诉我们，布朗时钟的一个增量 $du$ 对应于物理时间的一个增量 $dt = du/g^2(Y_t)$。\n\n过程 $X_t$ 的逗留测度描述了它在其状态空间的不同区域花费的物理时间量。对于一个常返扩散，该测度的密度与速度测度的密度 $m'(x)$ 成正比。从分解 $L = \\frac{d}{dm}\\frac{d}{ds}$ 可知，速度测度的密度为 $m'(x) = \\frac{2}{s'(x)\\sigma^2(x)}$。\n\n一个数值格式应该能再现这种逗留密度。基于 DDS 定理构建此类格式的最自然方法是在布朗时钟 $u$ 中对过程进行离散化，因为在此时间标度下，过程表现为一个简单的标准布朗运动。\n\n让我们为布朗时钟选择一个常数步长 $h > 0$，即 $\\Delta u_n = h$。\n1.  **在标度坐标 $Y$ 中更新**：由于 $Y$ 在 $u$-时钟下是一个标准布朗运动，在 $u$ 中一个大小为 $h$ 的步长对应于一个均值为 $0$、方差为 $h$ 的随机增量。更新规则是：\n    $$ Y_{n+1} = Y_n + \\xi_n \\sqrt{h}, \\quad \\text{其中 } \\xi_n \\sim \\mathcal{N}(0,1) \\text{ 是独立同分布的} $$\n2.  **更新物理时间 $t$**：物理时间中对应的增量 $\\Delta t_n = t_{n+1}-t_n$ 通过离散化关系 $dt = du/g^2(Y_t)$ 得到。使用显式近似：\n    $$ \\Delta t_n \\approx \\frac{\\Delta u_n}{g^2(Y_n)} = \\frac{h}{g^2(Y_n)} $$\n    其中 $Y_n$ 是步长开始时的状态。\n3.  **映射回原始坐标 $X$**：原始坐标中的状态通过逆标度函数恢复：$X_{n+1} = s^{-1}(Y_{n+1})$。\n\n我们来验证该格式是否能产生正确的逗留测度。过程以恒定的“布朗时间”长度 $h$ 进行步进。每一步对应的物理时间长度为 $\\Delta t_n = h/g^2(Y_n)$。从长远来看，过程在一个小区间 $[y, y+dy]$ 内所走的步数在 $Y$ 的状态空间上是均匀分布的。因此，在该区间内花费的总物理时间与从该处开始的每一步的持续时间成正比，即与 $1/g^2(y)$ 成正比。所以，$y$ 坐标下的逗留密度 $\\rho_Y(y)$ 满足 $\\rho_Y(y) \\propto 1/g^2(y)$。\n\n为了找到原始坐标下的逗留密度 $\\rho_X(x)$，我们进行变量替换：$\\rho_X(x)dx = \\rho_Y(y)dy$。当 $y=s(x)$ 且 $dy=s'(x)dx$ 时，我们得到 $\\rho_X(x) = \\rho_Y(s(x))s'(x)$。代入我们对 $\\rho_Y(y)$ 的发现：\n$$ \\rho_X(x) \\propto \\frac{1}{g^2(s(x))} s'(x) $$\n现在，我们使用定义 $g(y) = s'(s^{-1}(y))\\sigma(s^{-1}(y))$，这意味着 $g(s(x)) = s'(x)\\sigma(x)$。\n$$ \\rho_X(x) \\propto \\frac{s'(x)}{\\left(s'(x)\\sigma(x)\\right)^2} = \\frac{s'(x)}{(s'(x))^2 \\sigma^2(x)} = \\frac{1}{s'(x)\\sigma^2(x)} $$\n这个得到的逗留密度与速度测度密度 $m'(x) = \\frac{2}{s'(x)\\sigma^2(x)}$ 成正比。因此，该格式是正确的。\n\n现在我们根据此推导来评估给出的选项。\n\n**A.** 该选项提出的格式是：$Y_{n+1} = Y_n + \\xi_n\\sqrt{h}$ 和 $t_{n+1} = t_n + h/g^2(Y_n)$。这与上面推导的格式完全匹配。选项中给出的理由——它保持布朗时钟增量恒定并产生正确的逗留密度——也是正确的。\n**结论：正确。**\n\n**B.** 该选项提出了一个针对 SDE $dY_t = g(Y_t)dW_t$ 的标准欧拉-丸山格式，采用固定的物理时间步长 $h$：$Y_{n+1} = Y_n + g(Y_n)\\,\\xi_n\\sqrt{h}$ 和 $t_{n+1} = t_n + h$。虽然这个格式确实收敛到过程 $Y_t$，并且其平稳（逗留）分布确实与 $1/g^2(y)$ 成正比，从而得到 $X$ 的正确逗留测度，但它没有像问题框架所要求的那样“实现正确的时间重标度”。它使用的是固定的物理时间步长。问题明确要求一个围绕时间变换原理设计的格式。该选项的理由“不需要进行时间重标度”在概念上与问题陈述中概述的基于 DDS 的方法相悖。\n**结论：错误。**\n\n**C.** 该选项建议对 $Y$ 使用恒定方差增量和恒定物理时间步长：$Y_{n+1} = Y_n + \\xi_n\\sqrt{h}$ 和 $t_{n+1} = t_n + h$。在这种情况下，逗留密度 $\\rho_Y(y)$ 将是均匀的。变换回 $X$ 坐标得到 $\\rho_X(x) \\propto s'(x)$。在一般情况下，这与速度测度密度 $m'(x) \\propto 1/(s'(x)\\sigma^2(x))$ 不成正比。\n**结论：错误。**\n\n**D.** 该选项提出了一个错误的时间重标度因子。它建议 $\\Delta t_n = h/\\sigma^2(s^{-1}(Y_n))$。正确的因子是 $1/g^2(Y_n) = 1/[(s'(s^{-1}(Y_n)))^2 \\sigma^2(s^{-1}(Y_n))]$。该格式省略了 $(s')^2$ 项。此格式产生的逗留密度将是 $\\rho_X(x) \\propto s'(x)/\\sigma^2(x)$，这不是正确的速度测度密度。关于 $s'$ 因子不必要的理由是错误的；这个因子是控制时间变换的波动率项 $g(y)$ 的一个关键部分。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2989182"}]}