{"hands_on_practices": [{"introduction": "理论的生命力在于其应用与验证。本节的第一个实践旨在通过计算机模拟来建立对带反射边界的布朗运动的直观理解。我们将模拟一个在圆盘内运动的粒子，通过一个简单的投影算法来强制执行边界约束[@problem_id:2993620]。通过将模拟得到的统计矩与已知的均匀平稳分布的理论值进行比较，我们可以验证我们对斯科罗霍德问题（Skorokhod problem）数值解法的理解和实现的正确性。", "problem": "考虑在以原点为中心、半径为 $R$ 的闭圆盘中的反射平面布朗运动。设 $W_t$ 为一个协方差矩阵为单位矩阵的二维布朗运动，并设 $x_0 \\in \\overline{D}$，其中 $\\overline{D} := \\{ x \\in \\mathbb{R}^2 : \\lVert x \\rVert \\le R \\}$。反射过程 $X_t$ 被定义为圆盘中 Skorokhod 问题的解，即找到一对 $(X_t, L_t)$，使得对于所有 $t \\ge 0$ 都有 $X_t \\in \\overline{D}$，$L_t$ 是一个连续非减过程，且仅当 $X_t$ 位于边界 $\\partial D = \\{ x : \\lVert x \\rVert = R \\}$ 上时才增加，并且\n$$\nX_t = x_0 + W_t + \\int_0^t n\\!\\left(X_s\\right)\\, dL_s,\n$$\n其中 $n(x)$ 是在 $x \\in \\partial D$ 处的内向单位法向量，即 $n(x) = -\\frac{x}{\\lVert x \\rVert}$。\n\n基本事实：\n- 在 $D$ 的内部，$X_t$ 的生成元是 $\\frac{1}{2}\\Delta$，对于生成元定义域中的函数，在边界 $\\partial D$ 上满足 Neumann 边界条件（零法向导数）。\n- 在具有 Neumann 边界条件的连通有界域上，唯一的不变（平稳）概率分布是在该域上的均匀分布。\n\n由此可知，对于圆盘而言，$X_t$ 的不变分布是在 $\\overline{D}$ 上的均匀分布。如果 $(R,\\Theta)$ 表示圆盘上均匀分布点的极坐标，则 $\\Theta$ 在 $[0,2\\pi)$ 上均匀分布且与 $R$ 独立，径向坐标的密度为\n$$\nf_R(r) = \\frac{2r}{R^2}, \\quad 0 \\le r \\le R.\n$$\n因此，不变分布的矩满足\n$$\n\\mathbb{E}[R] = \\frac{2R}{3}, \\quad \\mathbb{E}[R^2] = \\frac{R^2}{2}, \\quad \\mathbb{E}[X] = 0, \\quad \\mathbb{E}[X^2] = \\frac{R^2}{4},\n$$\n其中 $X$ 表示圆盘上一个均匀分布点的某个笛卡尔坐标（根据对称性，另一个坐标也同样成立）。\n\n任务：实现一个完整的程序，通过步长为 $\\Delta t$ 的时间离散化来模拟圆盘内的反射布朗运动。在每一步中，提出一个自由布朗增量，并通过最小的内向法向校正来施加 Skorokhod 约束，以使状态保持在 $\\overline{D}$ 内。在数值上，如果一个自由增量后的建议位置 $Y$ 位于圆盘外，即 $\\lVert Y \\rVert > R$，则通过将 $Y$ 映射到 $\\frac{R}{\\lVert Y \\rVert}Y$ 来校正为到 $\\overline{D}$ 上的欧几里得投影。每个测试用例使用一条长轨迹，舍弃初始的老化部分，并从保留的样本中估计矩 $\\mathbb{E}[R]$、$\\mathbb{E}[R^2]$、$\\mathbb{E}[X]$ 和 $\\mathbb{E}[X^2]$。\n\n验证：对于每个测试用例，将估计的矩与上面给出的理论不变矩进行比较。使用根据每个矩的自然量级缩放的绝对误差阈值：一个特定于用例的容差因子 $\\tau$ 决定了四个阈值\n$$\n\\varepsilon_R = \\tau R, \\quad \\varepsilon_{R^2} = \\tau R^2, \\quad \\varepsilon_X = \\tau R, \\quad \\varepsilon_{X^2} = \\tau R^2.\n$$\n如果所有四个绝对误差都至多为其对应的阈值，则该测试用例通过。\n\n单位：所有量均为无量纲。\n\n测试套件：\n- 用例 1（通用情况，正常路径）：$R=1.0$，$\\Delta t = 0.002$，总模拟时间 $T=400$（因此 $N = T/\\Delta t = 200000$ 步），初期舍弃比例 $b=0.20$，初始位置 $x_0=(0.0,0.0)$，随机种子 $12345$，容差因子 $\\tau=0.02$。\n- 用例 2（边界起始）：$R=2.0$，$\\Delta t = 0.002$，$T=400$，$b=0.20$，$x_0=(R,0)$，种子 $23456$，$\\tau=0.02$。\n- 用例 3（更粗的时间步长）：$R=1.0$，$\\Delta t = 0.05$，$T=2000$，$b=0.20$，$x_0=(0.0,0.0)$，种子 $34567$，$\\tau=0.03$。\n- 用例 4（小半径）：$R=0.25$，$\\Delta t = 0.002$，$T=400$，$b=0.20$，$x_0=(0.0,0.0)$，种子 $45678$，$\\tau=0.02$。\n\n程序要求：\n- 按照描述实现模拟和验证。\n- 对每个测试用例，输出一个布尔值，表示所有四个矩的验证是否都在相应阈值下通过。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[result_1,result_2,result_3,result_4]$，其中每个 $result_i$ 为 $True$ 或 $False$。", "solution": "该问题在科学上基于随机微分方程理论，特别是关于反射布朗运动的 Skorokhod 问题。该问题是适定的，提供了所有必要的参数、初始条件以及一个清晰、客观的验证标准。不变分布矩的理论值是正确的，并源于基本原理。该任务要求实现一个标准的数值方案，并将其输出与理论结果进行直接比较，使其成为一个在计算数学中定义明确的问题。\n\n目标是在以原点为中心、半径为 $R$ 的闭圆盘 $\\overline{D}$ 内模拟一个二维反射布朗运动 $X_t$。已知该过程的长期行为会收敛到圆盘上的均匀概率分布。任务是在数值上验证这一性质。对于一组给定的参数，我们将模拟该过程的一条轨迹，估计其径向坐标 $r = \\lVert X_t \\rVert$ 的前两个矩以及其一个笛卡尔坐标（例如，第一个坐标 $x$）的前两个矩，并将这些估计值与它们的理论值进行比较。\n\n过程 $X_t$ 遵循以下随机微分方程：\n$$\nX_t = x_0 + W_t + \\int_0^t n(X_s)\\, dL_s\n$$\n其中 $W_t$ 是一个标准的二维布朗运动，$x_0$ 是初始位置，$L_t$ 是一个表示反射力的非减过程，而 $n(x) = -x/\\lVert x \\rVert$ 是在边界 $\\partial D$ 上的内向单位法向量。\n\n我们将采用一种基于小时间步长 $\\Delta t$ 的时间离散化的数值方法。这是一种基于投影的 Euler-Maruyama 方案。在每个时间步 $k$，我们首先通过将一个自由布朗增量加到当前位置 $X_k$上来计算一个建议位置 $Y_{k+1}$：\n$$\nY_{k+1} = X_k + \\Delta W_{k+1}\n$$\n其中增量 $\\Delta W_{k+1}$ 是从均值为 $0$、协方差矩阵为 $\\Delta t \\cdot I$（其中 $I$ 是 $2 \\times 2$ 单位矩阵）的二维正态分布中抽取的随机向量。这可以写作 $\\Delta W_{k+1} = \\sqrt{\\Delta t} Z_{k+1}$，其中 $Z_{k+1} \\sim \\mathcal{N}(0, I)$。\n\n接下来，我们施加边界条件。如果建议位置 $Y_{k+1}$ 位于圆盘内部或边界上（即 $\\lVert Y_{k+1} \\rVert \\le R$），我们接受它：$X_{k+1} = Y_{k+1}$。如果它位于圆盘外部（$\\lVert Y_{k+1} \\rVert > R$），我们将其投影回边界上。指定的投影方法将 $Y_{k+1}$ 映射到 $\\overline{D}$ 中最近的点，该点位于边界上：\n$$\nX_{k+1} = \\frac{R}{\\lVert Y_{k+1} \\rVert} Y_{k+1}\n$$\n这个两步过程定义了离散时间过程 $X_k$ 的演化。\n\n对于每个测试用例，我们生成一条长度为 $N = T/\\Delta t$ 步的单条长轨迹。过程 $X_t$ 相对于其均匀不变分布是遍历的。因此，根据遍历定理，沿单条轨迹的时间平均值会收敛到相对于不变测度的空间平均值。为了估计这些矩，我们首先舍弃轨迹的初始部分（比例为 $b$ 的“老化”期），以使过程接近其平稳状态。然后，我们从剩余的 $N(1-b)$ 个数据点中计算四个量的样本均值：径向坐标 $r_k = \\lVert X_k \\rVert$、其平方 $r_k^2$、第一个笛卡尔坐标 $x_k$ 及其平方 $x_k^2$。这些样本均值就是我们对理论矩的估计。\n\n从半径为 $R$ 的圆盘中均匀选取一个点的理论矩为：\n1.  $\\mathbb{E}[r] = \\int_0^R r \\frac{2r}{R^2} dr = \\frac{2R}{3}$\n2.  $\\mathbb{E}[r^2] = \\int_0^R r^2 \\frac{2r}{R^2} dr = \\frac{R^2}{2}$\n3.  $\\mathbb{E}[x] = 0$ (根据对称性)\n4.  $\\mathbb{E}[x^2] = \\frac{1}{2}\\mathbb{E}[r^2] = \\frac{R^2}{4}$ (根据对称性，因为 $\\mathbb{E}[x^2]=\\mathbb{E}[y^2]$ 且 $r^2=x^2+y^2$)\n\n如果所有四个估计矩都接近其理论对应值，则测试用例被认为通过。每个矩的绝对误差必须在特定容差范围内。这些容差定义为：对于 $\\mathbb{E}[r]$ 是 $\\varepsilon_R = \\tau R$，对于 $\\mathbb{E}[r^2]$ 是 $\\varepsilon_{R^2} = \\tau R^2$，对于 $\\mathbb{E}[x]$ 是 $\\varepsilon_X = \\tau R$，对于 $\\mathbb{E}[x^2]$ 是 $\\varepsilon_{X^2} = \\tau R^2$，其中 $\\tau$ 是特定于用例的容差因子。一个测试当且仅当以下条件全部满足时通过：\n-   $|\\text{est}(\\mathbb{E}[r]) - \\frac{2R}{3}| \\le \\tau R$\n-   $|\\text{est}(\\mathbb{E}[r^2]) - \\frac{R^2}{2}| \\le \\tau R^2$\n-   $|\\text{est}(\\mathbb{E}[x]) - 0| \\le \\tau R$\n-   $|\\text{est}(\\mathbb{E}[x^2]) - \\frac{R^2}{4}| \\le \\tau R^2$\n\n最终程序将对问题陈述中指定的每个测试用例执行此模拟和验证过程，并为每个用例报告一个指示成功或失败的布尔值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation_case(R, dt, T, b, x0, seed, tau):\n    \"\"\"\n    Simulates reflected Brownian motion in a disk and validates its moments.\n\n    Args:\n        R (float): Radius of the disk.\n        dt (float): Time step for the simulation.\n        T (float): Total simulation time.\n        b (float): Burn-in fraction to discard.\n        x0 (tuple): Initial position (x, y).\n        seed (int): Random seed for reproducibility.\n        tau (float): Tolerance factor for validation.\n\n    Returns:\n        bool: True if all moment validations pass, False otherwise.\n    \"\"\"\n    # Set the random seed\n    np.random.seed(seed)\n\n    # Simulation parameters\n    num_steps = int(T / dt)\n    burn_in_steps = int(num_steps * b)\n    \n    # Initialize the process\n    x_current = np.array(x0, dtype=float)\n\n    # Lists to store samples after the burn-in period\n    samples_r = []\n    samples_r2 = []\n    samples_x = []\n    samples_x2 = []\n\n    sqrt_dt = np.sqrt(dt)\n\n    # Simulation loop\n    for k in range(num_steps):\n        # Propose a free Brownian step\n        dW = np.random.randn(2) * sqrt_dt\n        y_next = x_current + dW\n        \n        # Enforce the reflection boundary condition\n        norm_y = np.linalg.norm(y_next)\n        if norm_y > R:\n            x_next = y_next * (R / norm_y)\n        else:\n            x_next = y_next\n        \n        x_current = x_next\n        \n        # Collect samples after burn-in\n        if k >= burn_in_steps:\n            r = np.linalg.norm(x_current)\n            x_coord = x_current[0]\n            \n            samples_r.append(r)\n            samples_r2.append(r**2)\n            samples_x.append(x_coord)\n            samples_x2.append(x_coord**2)\n\n    # Estimate moments from samples\n    est_E_r = np.mean(samples_r)\n    est_E_r2 = np.mean(samples_r2)\n    est_E_x = np.mean(samples_x)\n    est_E_x2 = np.mean(samples_x2)\n    \n    # Theoretical moments\n    th_E_r = 2.0 * R / 3.0\n    th_E_r2 = R**2 / 2.0\n    th_E_x = 0.0\n    th_E_x2 = R**2 / 4.0\n\n    # Validation thresholds\n    eps_R = tau * R\n    eps_R2 = tau * R**2\n    eps_X = tau * R\n    eps_X2 = tau * R**2\n    \n    # Perform validation checks\n    check_r = abs(est_E_r - th_E_r) = eps_R\n    check_r2 = abs(est_E_r2 - th_E_r2) = eps_R2\n    check_x = abs(est_E_x - th_E_x) = eps_X\n    check_x2 = abs(est_E_x2 - th_E_x2) = eps_X2\n\n    return all([check_r, check_r2, check_x, check_x2])\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general, happy path\n        {'R': 1.0, 'dt': 0.002, 'T': 400, 'b': 0.20, 'x0': (0.0, 0.0), 'seed': 12345, 'tau': 0.02},\n        # Case 2: boundary start\n        {'R': 2.0, 'dt': 0.002, 'T': 400, 'b': 0.20, 'x0': (2.0, 0.0), 'seed': 23456, 'tau': 0.02},\n        # Case 3: coarser time step\n        {'R': 1.0, 'dt': 0.05, 'T': 2000, 'b': 0.20, 'x0': (0.0, 0.0), 'seed': 34567, 'tau': 0.03},\n        # Case 4: small radius\n        {'R': 0.25, 'dt': 0.002, 'T': 400, 'b': 0.20, 'x0': (0.0, 0.0), 'seed': 45678, 'tau': 0.02}\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation_case(\n            R=case['R'],\n            dt=case['dt'],\n            T=case['T'],\n            b=case['b'],\n            x0=case['x0'],\n            seed=case['seed'],\n            tau=case['tau']\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2993620"}, {"introduction": "在建立了对反射过程的基本直观后，我们转向一个更抽象但高度实用的应用：将排队网络建模为反射布朗运动。在重载（heavy-traffic）条件下，许多随机网络可以被近似为在正象限内运动的多维反射布朗运动。这个练习将引导你实践一项核心的建模技能：将一个具体系统（一个串联排队网络）的物理参数（到达率、服务率、变异系数）转化为半鞅反射布朗运动（SRBM）的数学元素，即漂移向量 $\\theta$、协方差矩阵 $\\Gamma$ 和反射矩阵 $R$ [@problem_id:2993602]。", "problem": "考虑一个在重负载扩散尺度下运行的双服务台串联开放网络。外部顾客根据更新过程到达服务台 $1$，其到达率为 $\\lambda = \\frac{9}{10}$，变异系数的平方为 $c_{a}^{2} = 2$。服务台 $1$ 和 $2$ 的服务时间在不同任务和不同服务台之间是独立的，平均服务率分别为 $\\mu_{1} = 1$ 和 $\\mu_{2} = \\frac{11}{10}$，变异系数的平方分别为 $c_{s,1}^{2} = \\frac{3}{2}$ 和 $c_{s,2}^{2} = \\frac{1}{2}$。所有原始过程都是相互独立的。离开服务台 $1$ 的任务立即以概率 $1$ 进入服务台 $2$，离开服务台 $2$ 的任务则离开网络。假设两个服务台都采用先入先出（FIFO）的服务规则。\n\n在扩散尺度下，对于缓冲区内容向量 $Q(t) \\in \\mathbb{R}_{+}^{2}$，中心化的净输入过程 $W(t)$ 被建模为一个二维布朗运动，其漂移向量为 $\\theta \\in \\mathbb{R}^{2}$，协方差矩阵为 $\\Gamma \\in \\mathbb{R}^{2 \\times 2}$。队长过程通过一个斜向反射的 Skorokhod 映射被约束在非负象限内，因此\n$$\nQ(t) \\;=\\; Q(0) \\;+\\; W(t) \\;+\\; R\\,Y(t),\n$$\n其中 $R \\in \\mathbb{R}^{2 \\times 2}$ 的列是反射方向，$Y(t) \\in \\mathbb{R}_{+}^{2}$ 是一个非递减调节过程的向量，仅当 $Q(t)$ 的相应分量位于边界上时才会增加。反射方向被假设是由与路由一致的瞬时流量守恒引起的：当在服务台 $1$ 发生反射时，一个单位的调节量会增加缓冲区 $1$ 的内容，同时减少向缓冲区 $2$ 的路由推送；当在服务台 $2$ 发生反射时，一个单位的调节量只增加缓冲区 $2$ 的内容（离开的任务退出网络）。\n\n从第一性原理出发，推导描述 $Q(t)$ 的半鞅反射布朗运动（SRBM）的数据 $(\\theta,\\Gamma,R)$。\n\n定义稳定裕度\n$$\nm \\;:=\\; \\max\\bigl\\{ \\bigl(R^{-1}\\theta\\bigr)_{1},\\; \\bigl(R^{-1}\\theta\\bigr)_{2} \\bigr\\}。\n$$\n精确计算 $m$。你的最终答案必须是一个单一的精确值（没有近似或四舍五入）。不需要单位。", "solution": "该问题要求推导一个半鞅反射布朗运动（SRBM）的参数 $(\\theta, \\Gamma, R)$，该模型在重负载下近似一个双服务台串联排队网络。随后，我们必须计算稳定裕度 $m$。\n\n该系统由两个串联的服务台组成。我们将原始随机过程表示如下：\n1.  $A(t)$: 到达服务台 $1$ 的外部到达过程。这是一个更新过程，其速率为 $\\lambda = \\frac{9}{10}$，变异系数的平方 (SCV) 为 $c_{a}^{2} = 2$。\n2.  $S_1(t)$: 服务台 $1$ 的潜在服务完成过程。这是一个更新过程，其速率为 $\\mu_1 = 1$，SCV 为 $c_{s,1}^{2} = \\frac{3}{2}$。\n3.  $S_2(t)$: 服务台 $2$ 的潜在服务完成过程。这是一个更新过程，其速率为 $\\mu_2 = \\frac{11}{10}$，SCV 为 $c_{s,2}^{2} = \\frac{1}{2}$。\n这三个过程被假定为相互独立的。\n\n在扩散尺度下，每个速率为 $\\nu$、SCV 为 $c^2$ 的更新过程 $N(t)$ 可近似为一个带漂移的布朗运动：$N(t) \\approx \\nu t + \\sqrt{\\nu c^2} B(t)$，其中 $B(t)$ 是一个标准的一维布朗运动。\n\n无约束的净输入过程 $W(t) = (W_1(t), W_2(t))^T$ 表示没有边界约束时队长（队列长度）的变化。对于串联队列，流量是顺序的：服务台 $1$ 的到达是外部的，而服务台 $2$ 的到达是服务台 $1$ 的离开。\n服务台 $1$ 的净输入是外部到达与服务台 $1$ 的潜在服务完成之间的差值。\n$$W_1(t) = A(t) - S_1(t)$$\n服务台 $2$ 的净输入是来自服务台 $1$ 的到达（即其潜在离开）与服务台 $2$ 的潜在服务完成之间的差值。\n$$W_2(t) = S_1(t) - S_2(t)$$\n因此，向量净输入过程为 $W(t) = (A(t) - S_1(t), S_1(t) - S_2(t))^T$。\n\n**1. 漂移向量 $\\theta$ 的推导**\n\n布朗运动 $W(t)$ 的漂移向量 $\\theta$ 由净输入过程的平均速率向量给出。\n$$\n\\theta = \\lim_{t\\to\\infty} \\frac{1}{t} E[W(t)] = \\begin{pmatrix} E[A(t)]/t - E[S_1(t)]/t \\\\ E[S_1(t)]/t - E[S_2(t)]/t \\end{pmatrix}\n$$\n平均速率由底层更新过程的速率给出。\n$$\n\\theta = \\begin{pmatrix} \\lambda - \\mu_1 \\\\ \\mu_1 - \\mu_2 \\end{pmatrix}\n$$\n代入给定值：\n$\\theta_1 = \\frac{9}{10} - 1 = -\\frac{1}{10}$\n$\\theta_2 = 1 - \\frac{11}{10} = -\\frac{1}{10}$\n所以，漂移向量为 $\\theta = \\begin{pmatrix} -1/10 \\\\ -1/10 \\end{pmatrix}$。\n\n**2. 协方差矩阵 $\\Gamma$ 的推导**\n\n协方差矩阵 $\\Gamma$ 由 $\\Gamma_{ij} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Cov}(W_i(t), W_j(t))$ 给出。\n独立原始过程的扩散近似为：\n$A(t) \\approx \\lambda t + \\sqrt{\\lambda c_a^2} B_a(t)$\n$S_1(t) \\approx \\mu_1 t + \\sqrt{\\mu_1 c_{s,1}^2} B_1(t)$\n$S_2(t) \\approx \\mu_2 t + \\sqrt{\\mu_2 c_{s,2}^2} B_2(t)$\n其中 $B_a, B_1, B_2$ 是独立的标准布朗运动。\n\n$\\Gamma$ 的对角元素是方差：\n$\\Gamma_{11} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Var}(A(t) - S_1(t)) = \\lambda c_a^2 + \\mu_1 c_{s,1}^2$\n$\\Gamma_{22} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Var}(S_1(t) - S_2(t)) = \\mu_1 c_{s,1}^2 + \\mu_2 c_{s,2}^2$\n\n非对角元素是协方差：\n$\\Gamma_{12} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Cov}(A(t) - S_1(t), S_1(t) - S_2(t))$\n由于 $A(t)$、$S_1(t)$ 和 $S_2(t)$ 是独立过程，协方差仅来自于公共项 $S_1(t)$：\n$\\Gamma_{12} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Cov}(-S_1(t), S_1(t)) = -\\lim_{t\\to\\infty} \\frac{1}{t} \\text{Var}(S_1(t)) = -\\mu_1 c_{s,1}^2$\n由于 $\\Gamma$ 是对称的，所以 $\\Gamma_{21} = \\Gamma_{12}$。\n\n代入给定值：\n$\\lambda c_a^2 = \\frac{9}{10} \\times 2 = \\frac{9}{5}$\n$\\mu_1 c_{s,1}^2 = 1 \\times \\frac{3}{2} = \\frac{3}{2}$\n$\\mu_2 c_{s,2}^2 = \\frac{11}{10} \\times \\frac{1}{2} = \\frac{11}{20}$\n\n$\\Gamma_{11} = \\frac{9}{5} + \\frac{3}{2} = \\frac{18}{10} + \\frac{15}{10} = \\frac{33}{10}$\n$\\Gamma_{22} = \\frac{3}{2} + \\frac{11}{20} = \\frac{30}{20} + \\frac{11}{20} = \\frac{41}{20}$\n$\\Gamma_{12} = \\Gamma_{21} = -\\frac{3}{2}$\n\n所以，协方差矩阵为 $\\Gamma = \\begin{pmatrix} 33/10   -3/2 \\\\ -3/2   41/20 \\end{pmatrix}$。\n\n**3. 反射矩阵 $R$ 的推导**\n\n反射矩阵 $R$ 描述了在状态空间 $\\mathbb{R}_{+}^{2}$ 的边界上施加的控制方向。\n- 当服务台 $1$ 的队列为空时（$Q_1(t) = 0$），调节过程 $Y_1(t)$ 起作用。问题描述这会“增加缓冲区 $1$ 的内容，同时减少向缓冲区 $2$ 的路由推送”。缓冲区 $1$ 内容的增加意味着反射向量 $R_1$ 的第一个分量为正（归一化为 $1$）。向缓冲区 $2$ 的路由推送的减少意味着本应进入服务台 $2$ 的一个到达没有发生，这对队长 $Q_2$ 是一个负贡献。这被建模为 $R_1$ 中的一个负的第二个分量（归一化为 $-1$）。因此，$R$ 的第一列是 $R_1 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n- 当服务台 $2$ 的队列为空时（$Q_2(t) = 0$），调节过程 $Y_2(t)$ 起作用。问题描述这会“只增加缓冲区 $2$ 的内容”。这意味着相应的反射向量 $R_2$ 对于服务台 $1$ 的分量为零，对于服务台 $2$ 的分量为正（归一化为 $1$）。因此，$R$ 的第二列是 $R_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n结合这些，反射矩阵为 $R = \\begin{pmatrix} 1   0 \\\\ -1   1 \\end{pmatrix}$。\nSRBM 的参数为 $(\\theta, \\Gamma, R) = \\left( \\begin{pmatrix} -1/10 \\\\ -1/10 \\end{pmatrix}, \\begin{pmatrix} 33/10   -3/2 \\\\ -3/2   41/20 \\end{pmatrix}, \\begin{pmatrix} 1   0 \\\\ -1   1 \\end{pmatrix} \\right)$。\n\n**4. 稳定裕度 $m$ 的计算**\n\n稳定裕度定义为 $m = \\max\\bigl\\{ \\bigl(R^{-1}\\theta\\bigr)_{1},\\; \\bigl(R^{-1}\\theta\\bigr)_{2} \\bigr\\}$。\n首先，我们求 $R$ 的逆矩阵：\n$\\det(R) = (1)(1) - (0)(-1) = 1$。\n$R^{-1} = \\frac{1}{\\det(R)} \\begin{pmatrix} 1   -0 \\\\ -(-1)   1 \\end{pmatrix} = \\begin{pmatrix} 1   0 \\\\ 1   1 \\end{pmatrix}$。\n\n接下来，我们计算向量 $\\delta = R^{-1}\\theta$，它代表了工作负载过程的漂移。\n$$\n\\delta = R^{-1}\\theta = \\begin{pmatrix} 1   0 \\\\ 1   1 \\end{pmatrix} \\begin{pmatrix} -1/10 \\\\ -1/10 \\end{pmatrix}\n$$\n$\\delta$ 的分量是：\n$\\delta_1 = (1)(-\\frac{1}{10}) + (0)(-\\frac{1}{10}) = -\\frac{1}{10}$\n$\\delta_2 = (1)(-\\frac{1}{10}) + (1)(-\\frac{1}{10}) = -\\frac{2}{10} = -\\frac{1}{5}$\n\n最后，我们通过取这些分量的最大值来计算稳定裕度 $m$：\n$$\nm = \\max\\{-\\frac{1}{10}, -\\frac{1}{5}\\}\n$$\n由于 $-\\frac{1}{10} = -0.1$ 且 $-\\frac{1}{5} = -0.2$，最大值为 $-\\frac{1}{10}$。\n$$\nm = -\\frac{1}{10}\n$$", "answer": "$$\\boxed{-\\frac{1}{10}}$$", "id": "2993602"}, {"introduction": "前面的练习展示了斯科罗霍德问题在凸区域（如圆盘和正象限）中的良好性质。然而，当区域的几何形状变得复杂时，会出现哪些问题？这个高级实践将通过一个精心设计的反例，深入探讨非凸区域中斯科罗霍德映射的理论微妙之处[@problem_id:2998947]。通过为特定的输入路径构造显式解，你将揭示为何区域的凸性对于保证斯科罗霍德映射的利普希茨连续性（Lipschitz continuity）和相应反射随机微分方程解的路径唯一性等基本性质至关重要。", "problem": "考虑在 $\\mathbb{R}^{2}$ 中一个非凸区域内的受约束路径的斯科罗霍德问题，定义如下。设区域为 $$D \\equiv \\{(x_{1},x_{2}) \\in \\mathbb{R}^{2}: x_{2} \\geq -|x_{1}|\\},$$ 其边界由两条射线组成 $$\\Gamma_{+} \\equiv \\{(x,y) \\in \\mathbb{R}^{2}: y=-x,\\ x \\geq 0\\}, \\qquad \\Gamma_{-} \\equiv \\{(x,y) \\in \\mathbb{R}^{2}: y=x,\\ x \\leq 0\\},$$ 这两条射线在凹角 $(0,0)$ 处相交。在每个边界部分上，施加法向反射：在 $\\Gamma_{+}$ 上的内向单位法向量为 $$n_{+} \\equiv \\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right),$$ 在 $\\Gamma_{-}$ 上的内向单位法向量为 $$n_{-} \\equiv \\left(-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right).$$ 在角点 $(0,0)$ 处，法锥是由 $\\{n_{+},n_{-}\\}$ 生成的闭凸锥。\n\n对于一个连续输入路径 $w:[0,T] \\to \\mathbb{R}^{2}$，在 $D$ 上的一个斯科罗霍德解是一对 $(X,L)$，由一个连续路径 $X:[0,T] \\to \\overline{D}$ 和一个非减函数 $L:[0,T] \\to \\mathbb{R}_{+}$（其中 $L(0)=0$）组成，使得\n- 对于 $t \\in [0,T]$，$X(t) = w(t) + \\int_{0}^{t} \\nu(s)\\, \\mathrm{d}L(s)$，其中 $\\nu(s)$ 是在 $X(s)$ 处的内向单位法向量的一个可测选择（即，如果 $X(s) \\in \\Gamma_{+}$，则 $\\nu(s) \\in \\{n_{+}\\}$；如果 $X(s) \\in \\Gamma_{-}$，则 $\\nu(s) \\in \\{n_{-}\\}$；如果 $X(s)=(0,0)$，则 $\\nu(s)$ 位于 $(0,0)$ 处的法锥内），\n- $L$ 仅当 $X$ 位于边界上时才增加，即对于所有 Borel 集 $A \\subset [0,T]$，都有 $$\\int_{A} \\mathbf{1}_{\\{X(s)\\in D^{\\circ}\\}} \\, \\mathrm{d}L(s) = 0,$$ 其中 $D^{\\circ}$ 表示 $D$ 的内部。\n\n设 $\\|\\cdot\\|_{\\infty}$ 表示 $\\mathbb{R}^{2}$ 上的上确界范数，定义为 $\\|(x_{1},x_{2})\\|_{\\infty} \\equiv \\max\\{|x_{1}|,|x_{2}|\\}$。考虑由 $\\epsilon \\in \\mathbb{R}$ 参数化的输入路径族\n$$w^{\\epsilon}(t) \\equiv (\\epsilon,-t), \\qquad t \\in [0,T],$$\n对于 $\\epsilon0$（以及 $\\epsilon0$），取在首次接触边界后沿 $\\Gamma_{+}$（以及沿 $\\Gamma_{-}$）滑动的最小斯科罗霍德解；将这些解记为 $X^{\\epsilon}$。\n\n任务：\n1. 从上述定义出发，通过在首次接触时间后强制边界接触和法向反射，推导出当 $\\epsilon0$ 和 $\\epsilon0$ 时 $X^{\\epsilon}(t)$ 的显式公式。\n2. 使用这些公式，对于固定的 $T0$ 和 $\\epsilon0$，计算商\n$$Q(\\epsilon,T) \\equiv \\frac{\\sup_{0 \\leq t \\leq T}\\big\\|X^{\\epsilon}(t) - X^{-\\epsilon}(t)\\big\\|_{\\infty}}{\\sup_{0 \\leq t \\leq T}\\big\\|w^{\\epsilon}(t) - w^{-\\epsilon}(t)\\big\\|_{\\infty}}.$$\n3. 计算极限 $\\lim_{\\epsilon \\downarrow 0} Q(\\epsilon,T)$ 并将此值作为最终答案。无需四舍五入，也不涉及单位。\n\n解释此构造如何展示一个反例，说明斯科罗霍德映射在非凸区域 $D$ 中不满足利普希茨条件，并解释为什么它意味着对于具有常数漂移 $b \\equiv (0,-1)$ 并在 $\\partial D$ 上进行法向反射的相应反射随机微分方程 (SDE) $\\,\\mathrm{d}X_{t} = b\\, \\mathrm{d}t + \\mathrm{d}K_{t}\\,$，其路径唯一性可能不成立。", "solution": "本问题旨在通过一个具体的例子，展示在非凸区域中斯科罗霍德映射可能失去利普希茨连续性，从而导致反射随机微分方程解的路径唯一性失效。我们将分步进行推导。\n\n**1. $X^{\\epsilon}(t)$ 显式公式的推导**\n\n首先，考虑 $\\epsilon  0$。输入路径为 $w^{\\epsilon}(t) = (\\epsilon, -t)$。路径从区域 $D$ 内部的 $(\\epsilon, 0)$ 点开始，垂直向下移动。它将在时间 $t_c$ 首次接触边界 $\\Gamma_{+}$（其方程为 $x_2 = -x_1$）。接触条件为 $-t_c = -\\epsilon$，因此 $t_c = \\epsilon$。\n- 对于 $t \\in [0, \\epsilon]$，路径在区域内部，无反射发生。因此，$X^{\\epsilon}(t) = w^{\\epsilon}(t) = (\\epsilon, -t)$。\n- 对于 $t  \\epsilon$，路径被要求沿 $\\Gamma_{+}$ 滑动。这意味着 $X^{\\epsilon}(t)$ 的坐标 $(X_1(t), X_2(t))$ 满足 $X_2(t) = -X_1(t)$，并且反射沿法向 $n_{+} = (\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}})$ 发生。斯科罗霍德问题的微分形式为 $dX^{\\epsilon}(t) = dw^{\\epsilon}(t) + n_{+}dL(t)$。由于 $dw^{\\epsilon}(t) = (0, -1)dt$，我们得到：\n  $dX_1(t) = \\frac{1}{\\sqrt{2}}dL(t)$\n  $dX_2(t) = -dt + \\frac{1}{\\sqrt{2}}dL(t)$\n  利用约束 $dX_1(t) = -dX_2(t)$，我们有 $\\frac{1}{\\sqrt{2}}dL(t) = -(-dt + \\frac{1}{\\sqrt{2}}dL(t)) = dt - \\frac{1}{\\sqrt{2}}dL(t)$。\n  这给出 $\\sqrt{2}dL(t) = dt$，即 $dL(t) = \\frac{1}{\\sqrt{2}}dt$。代入 $dX_1(t)$ 的表达式，得 $dX_1(t) = \\frac{1}{2}dt$，因此 $dX_2(t) = -\\frac{1}{2}dt$。\n  从接触点 $(\\epsilon, -\\epsilon)$ 开始积分，对于 $t  \\epsilon$：\n  $X_1(t) = \\epsilon + \\int_{\\epsilon}^{t} \\frac{1}{2}ds = \\frac{t+\\epsilon}{2}$\n  $X_2(t) = -\\epsilon - \\int_{\\epsilon}^{t} \\frac{1}{2}ds = -\\frac{t+\\epsilon}{2}$\n因此，对于 $\\epsilon > 0$，解为：\n$$ X^{\\epsilon}(t) = \\begin{cases} (\\epsilon, -t),  \\text{若 } 0 \\leq t \\leq \\epsilon \\\\ \\left(\\frac{t+\\epsilon}{2}, -\\frac{t+\\epsilon}{2}\\right),  \\text{若 } \\epsilon  t \\leq T \\end{cases} $$\n\n接下来，考虑 $\\epsilon  0$。输入路径 $w^{\\epsilon}(t) = (\\epsilon, -t)$ 将接触边界 $\\Gamma_{-}$（其方程为 $x_2=x_1$）。接触时间为 $-t_c = \\epsilon$，即 $t_c = -\\epsilon  0$。\n- 对于 $t \\in [0, -\\epsilon]$，$X^{\\epsilon}(t) = (\\epsilon, -t)$。\n- 对于 $t  -\\epsilon$，路径沿 $\\Gamma_{-}$ 滑动，反射方向为 $n_{-} = (-\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}})$。约束为 $dX_1(t) = dX_2(t)$。\n  $dX_1(t) = -\\frac{1}{\\sqrt{2}}dL(t)$\n  $dX_2(t) = -dt + \\frac{1}{\\sqrt{2}}dL(t)$\n  约束条件给出 $-\\frac{1}{\\sqrt{2}}dL(t) = -dt + \\frac{1}{\\sqrt{2}}dL(t)$，这同样得到 $dL(t) = \\frac{1}{\\sqrt{2}}dt$。\n  因此，$dX_1(t) = -\\frac{1}{2}dt$，$dX_2(t) = -\\frac{1}{2}dt$。\n  从接触点 $(\\epsilon, \\epsilon)$ 开始积分，对于 $t  -\\epsilon$：\n  $X_1(t) = \\epsilon + \\int_{-\\epsilon}^{t} -\\frac{1}{2}ds = \\epsilon - \\frac{1}{2}(t+\\epsilon) = \\frac{\\epsilon-t}{2}$\n  $X_2(t) = \\epsilon + \\int_{-\\epsilon}^{t} -\\frac{1}{2}ds = \\epsilon - \\frac{1}{2}(t+\\epsilon) = \\frac{\\epsilon-t}{2}$\n因此，对于 $\\epsilon  0$，解为：\n$$ X^{\\epsilon}(t) = \\begin{cases} (\\epsilon, -t),  \\text{若 } 0 \\leq t \\leq -\\epsilon \\\\ \\left(\\frac{\\epsilon-t}{2}, \\frac{\\epsilon-t}{2}\\right),  \\text{若 } -\\epsilon  t \\leq T \\end{cases} $$\n\n**2. 商 $Q(\\epsilon,T)$ 的计算**\n\n对于 $\\epsilon  0$，我们计算商中的分子和分母。\n分母：$w^{\\epsilon}(t) - w^{-\\epsilon}(t) = (\\epsilon, -t) - (-\\epsilon, -t) = (2\\epsilon, 0)$。\n$\\|w^{\\epsilon}(t) - w^{-\\epsilon}(t)\\|_{\\infty} = 2\\epsilon$。因此，$\\sup_{0 \\leq t \\leq T}\\big\\|w^{\\epsilon}(t) - w^{-\\epsilon}(t)\\big\\|_{\\infty} = 2\\epsilon$。\n\n分子：我们需要计算 $X^{\\epsilon}(t) - X^{-\\epsilon}(t)$。使用上述公式，并将第二个解中的 $\\epsilon$ 替换为 $-\\epsilon$。\n- 对于 $t \\in [0, \\epsilon]$，$X^{\\epsilon}(t) - X^{-\\epsilon}(t) = (\\epsilon, -t) - (-\\epsilon, -t) = (2\\epsilon, 0)$。范数为 $2\\epsilon$。\n- 对于 $t \\in (\\epsilon, T]$（假设 $T  \\epsilon$），$X^{\\epsilon}(t) - X^{-\\epsilon}(t) = \\left(\\frac{t+\\epsilon}{2}, -\\frac{t+\\epsilon}{2}\\right) - \\left(\\frac{-\\epsilon-t}{2}, \\frac{-\\epsilon-t}{2}\\right) = (t+\\epsilon, 0)$。范数为 $t+\\epsilon$。\n函数 $f(t) = \\|X^{\\epsilon}(t) - X^{-\\epsilon}(t)\\|_{\\infty}$ 在 $t \\in [0, \\epsilon]$ 上等于 $2\\epsilon$，在 $t \\in (\\epsilon, T]$ 上等于 $t+\\epsilon$。由于 $t+\\epsilon$ 是增函数，其在 $[0, T]$ 上的最大值在 $t=T$ 处取得，为 $T+\\epsilon$。\n所以，$\\sup_{0 \\leq t \\leq T}\\big\\|X^{\\epsilon}(t) - X^{-\\epsilon}(t)\\big\\|_{\\infty} = T+\\epsilon$。\n\n商为 $Q(\\epsilon,T) = \\frac{T+\\epsilon}{2\\epsilon}$。\n\n**3. 极限计算与解释**\n\n极限为 $\\lim_{\\epsilon \\downarrow 0} Q(\\epsilon,T) = \\lim_{\\epsilon \\downarrow 0} \\left(\\frac{T}{2\\epsilon} + \\frac{1}{2}\\right) = +\\infty$。\n这个结果表明，将输入路径映射到反射路径的斯科罗霍德映射不是利普希茨连续的，因为输出路径之间的距离与输入路径之间的距离之比可以任意大，不存在一个有限的利普希茨常数。\n\n对于 SDE $\\mathrm{d}X_{t} = b\\, \\mathrm{d}t + \\mathrm{d}K_{t}$（其中 $b=(0,-1)$），如果从原点 $X_0 = (0,0)$ 开始，驱动它的确定性路径是 $w(t) = (0,-t)$。我们构造的解在 $\\epsilon \\to 0$ 时的极限给出了两个不同的解：\n- $X^+(t) = \\lim_{\\epsilon \\downarrow 0} X^{\\epsilon}(t) = (t/2, -t/2)$\n- $X^-(t) = \\lim_{\\epsilon \\downarrow 0} X^{-\\epsilon}(t) = (-t/2, -t/2)$\n$X^+$ 和 $X^-$ 都是从原点出发的有效解，一个立即沿 $\\Gamma_+$ 滑动，另一个立即沿 $\\Gamma_-$ 滑动。这证明了在凹角处，即使对于确定性输入，解的路径唯一性也可能失效。", "answer": "$$\\boxed{\\infty}$$", "id": "2998947"}]}