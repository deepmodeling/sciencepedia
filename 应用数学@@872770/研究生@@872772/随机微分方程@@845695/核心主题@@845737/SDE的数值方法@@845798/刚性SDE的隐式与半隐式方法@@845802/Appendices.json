{"hands_on_practices": [{"introduction": "为了理解为何隐式方法对刚性随机微分方程至关重要，我们首先需要明白标准显式方法在何种情况下会失效。本练习 [@problem_id:2979927] 阐释了“噪声诱导刚性”这一概念，即当乘性噪声项很大时，即便漂移项是稳定的，它也会对显式欧拉-丸山法的稳定时间步长施加严苛的限制。通过亲手推导这一约束条件，您将对驱动隐式方法发展的挑战建立起一个具体的认识。", "problem": "考虑由标准维纳过程 $W_t$ 驱动的标量随机微分方程，\n$$\n\\mathrm{d}X_t \\;=\\; -\\,X_t\\,\\mathrm{d}t \\;+\\; b\\,X_t\\,\\mathrm{d}W_t,\\qquad X_0\\in L^2(\\Omega),\\quad b0,\n$$\n这是一个线性乘性噪声模型，具有大小为 $1$ 的温和稳定化漂移项和扩散系数 $g(x)=b\\,x$。这是扩散可能引起数值刚性的一个典型实例。请从第一性原理出发，分析其精确的均方动力学，以及使用均匀时间步长 $\\Delta t0$ 的显式欧拉-丸山离散化的均方稳定性：\n$$\nX_{n+1} \\;=\\; X_n \\;-\\; X_n\\,\\Delta t \\;+\\; b\\,X_n\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n:=W_{t_{n+1}}-W_{t_n}$ 且 $t_n:=n\\,\\Delta t$。在您的推导中，仅使用伊藤微积分和维纳增量的基本性质，即 $E[\\Delta W_n]=0$ 和 $E[(\\Delta W_n)^2]=\\Delta t$，以及均方稳定性的定义，即要求 $E[|X_t|^2]$（对于精确解）或 $E[|X_n|^2]$（对于离散解）在 $t\\to\\infty$ 或 $n\\to\\infty$ 时衰减到 $0$。\n\n任务：\n- 推导 $E[|X_t|^2]$ 的精确演化方程，并说明精确解是均方稳定的关于 $b$ 的条件。\n- 推导欧拉-丸山法的单步均方放大因子及其相关的均方稳定性条件。\n- 当漂移项 $-X_t$ 温和但 $b$ 不可忽略时，将此情况解释为噪声诱导的刚性，确定在精确解是均方稳定的前提下，显式欧拉-丸山法保持均方稳定的最大步长 $\\Delta t_{\\max}$（作为 $b$ 的函数）。\n\n请以 $\\Delta t_{\\max}$ 关于 $b$ 的闭式表达式的形式提供您的最终答案。无需进行数值四舍五入。", "solution": "该问题要求分析一个标量线性随机微分方程 (SDE) 及其通过显式欧拉-丸山法离散化后的均方稳定性。我们将首先推导精确解的稳定性条件，然后是数值方法的稳定性条件，最后在精确解稳定的条件下，确定数值方法的最大允许时间步长。\n\n给定的 SDE 是：\n$$\n\\mathrm{d}X_t = -X_t\\,\\mathrm{d}t + b\\,X_t\\,\\mathrm{d}W_t\n$$\n初始条件为 $X_0 \\in L^2(\\Omega)$，参数 $b0$。\n\n**第一部分：精确解的均方稳定性**\n\n为了分析均方稳定性，我们需要找到二阶矩 $E[|X_t|^2]$ 的演化过程。由于 $X_t$ 是一个实值过程，所以 $|X_t|^2 = X_t^2$。我们对函数 $f(x) = x^2$ 应用伊藤公式。其导数为 $f_x(x) = 2x$ 和 $f_{xx}(x) = 2$。\n对于一个过程 $\\mathrm{d}X_t = a(X_t, t)\\mathrm{d}t + g(X_t, t)\\mathrm{d}W_t$，应用于 $f(X_t)$ 的一般伊藤公式是：\n$$\n\\mathrm{d}f(X_t) = \\left( a(X_t, t) f_x(X_t) + \\frac{1}{2} g(X_t, t)^2 f_{xx}(X_t) \\right) \\mathrm{d}t + g(X_t, t) f_x(X_t) \\mathrm{d}W_t\n$$\n在我们的例子中，漂移系数是 $a(x,t) = -x$，扩散系数是 $g(x,t) = b\\,x$。将这些以及 $f(x)=x^2$ 代入伊藤公式：\n$$\n\\mathrm{d}(X_t^2) = \\left( (-X_t)(2X_t) + \\frac{1}{2} (b X_t)^2 (2) \\right) \\mathrm{d}t + (b X_t)(2X_t) \\mathrm{d}W_t\n$$\n$$\n\\mathrm{d}(X_t^2) = \\left( -2X_t^2 + b^2 X_t^2 \\right) \\mathrm{d}t + 2b X_t^2 \\mathrm{d}W_t\n$$\n$$\n\\mathrm{d}(X_t^2) = (-2 + b^2) X_t^2 \\mathrm{d}t + 2b X_t^2 \\mathrm{d}W_t\n$$\n为了找到均方值 $E[X_t^2]$ 的微分方程，我们对上述 SDE 的积分形式取期望：\n$$\nE[X_t^2] - E[X_0^2] = E\\left[\\int_0^t (-2 + b^2) X_s^2 \\mathrm{d}s\\right] + E\\left[\\int_0^t 2b X_s^2 \\mathrm{d}W_s\\right]\n$$\n根据 Fubini 定理，我们可以交换期望和时间积分。伊藤积分项的期望为零，只要被积函数是一个合适的过程，这里情况确实如此。\n$$\nE[X_t^2] - E[X_0^2] = \\int_0^t (-2 + b^2) E[X_s^2] \\mathrm{d}s\n$$\n对 $t$ 求导，我们得到关于 $m(t) := E[X_t^2]$ 的常微分方程 (ODE)：\n$$\n\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t} = (-2 + b^2) m(t)\n$$\n这个线性常微分方程的解是 $m(t) = m(0) \\exp((-2 + b^2)t)$，其中 $m(0)=E[X_0^2]$。\n均方稳定性要求当 $t \\to \\infty$ 时 $m(t) \\to 0$。这当且仅当指数中的系数为负时发生：\n$$\n-2 + b^2  0 \\implies b^2  2\n$$\n由于问题陈述 $b > 0$，精确解的均方稳定性条件是 $0  b  \\sqrt{2}$。\n\n**第二部分：欧拉-丸山法的均方稳定性**\n\n时间步长为 $\\Delta t$ 的欧拉-丸山离散化由下式给出：\n$$\nX_{n+1} = X_n - X_n\\,\\Delta t + b\\,X_n\\,\\Delta W_n = X_n(1 - \\Delta t + b\\,\\Delta W_n)\n$$\n我们分析均方值 $E[X_n^2]$ 的演化。我们将 $X_{n+1}$ 的表达式平方并取期望：\n$$\nE[X_{n+1}^2] = E\\left[ \\left( X_n(1 - \\Delta t + b\\,\\Delta W_n) \\right)^2 \\right] = E\\left[ X_n^2 (1 - \\Delta t + b\\,\\Delta W_n)^2 \\right]\n$$\n使用全期望定律 $E[Z] = E[E[Z|\\mathcal{F}]]$, 我们以直到时间 $t_n = n \\Delta t$ 的维纳过程所生成的 $\\sigma$-代数 $\\mathcal{F}_{t_n}$ 为条件。$X_n$ 是 $\\mathcal{F}_{t_n}$-可测的。\n$$\nE[X_{n+1}^2] = E\\left[ E\\left[ X_n^2 (1 - \\Delta t + b\\,\\Delta W_n)^2 \\big| \\mathcal{F}_{t_n} \\right] \\right] = E\\left[ X_n^2 E\\left[ (1 - \\Delta t + b\\,\\Delta W_n)^2 \\big| \\mathcal{F}_{t_n} \\right] \\right]\n$$\n维纳增量 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 独立于 $\\mathcal{F}_{t_n}$。因此，内部的条件期望是一个简单的期望：\n$$\nE[(1 - \\Delta t + b\\,\\Delta W_n)^2] = E[ (1 - \\Delta t)^2 + 2b(1 - \\Delta t)\\Delta W_n + b^2(\\Delta W_n)^2 ]\n$$\n使用性质 $E[\\Delta W_n]=0$ 和 $E[(\\Delta W_n)^2]=\\Delta t$：\n$$\n= (1 - \\Delta t)^2 + 2b(1 - \\Delta t)E[\\Delta W_n] + b^2 E[(\\Delta W_n)^2] = (1 - \\Delta t)^2 + b^2 \\Delta t\n$$\n$$\n= 1 - 2\\Delta t + (\\Delta t)^2 + b^2\\Delta t = 1 + (b^2 - 2)\\Delta t + (\\Delta t)^2\n$$\n这个表达式是单步均方放大因子 $R(\\Delta t)$。均方值的递推关系为：\n$$\nE[X_{n+1}^2] = R(\\Delta t) E[X_n^2] = \\left( 1 + (b^2 - 2)\\Delta t + (\\Delta t)^2 \\right) E[X_n^2]\n$$\n为使数值方法是均方稳定的，我们要求当 $n \\to \\infty$ 时 $E[X_n^2] \\to 0$，这当且仅当放大因子 $R(\\Delta t)$ 的绝对值小于 $1$ 时成立：\n$$\n|R(\\Delta t)|  1 \\implies -1  1 + (b^2 - 2)\\Delta t + (\\Delta t)^2  1\n$$\n这给出了两个条件：\n1. $1 + (b^2 - 2)\\Delta t + (\\Delta t)^2  1 \\implies (b^2 - 2)\\Delta t + (\\Delta t)^2  0 \\implies \\Delta t (b^2 - 2 + \\Delta t)  0$。由于 $\\Delta t > 0$，我们必须有 $b^2 - 2 + \\Delta t  0$，这意味着 $\\Delta t  2 - b^2$。为了使正的时间步长 $\\Delta t$ 存在，我们必须有 $2 - b^2 > 0$，即 $b^2  2$。\n\n2. $1 + (b^2 - 2)\\Delta t + (\\Delta t)^2 > -1 \\implies (\\Delta t)^2 + (b^2 - 2)\\Delta t + 2 > 0$。令 $q(\\Delta t) = (\\Delta t)^2 + (b^2 - 2)\\Delta t + 2$。这是一个关于 $\\Delta t$ 的开口向上的二次函数。其顶点在 $\\Delta t_v = -(b^2 - 2)/2 = (2 - b^2)/2$。\n如果 $b^2 \\ge 2$，那么 $\\Delta t_v \\le 0$。对于 $\\Delta t > 0$，$q(\\Delta t)$ 是一个增函数且 $q(0)=2$，所以对于所有 $\\Delta t > 0$ 都有 $q(\\Delta t) > 2$。\n如果 $0  b^2  2$，那么 $\\Delta t_v > 0$。对于 $\\Delta t > 0$，$q(\\Delta t)$ 的最小值在顶点处取得：$q(\\Delta t_v) = (\\frac{2-b^2}{2})^2 - (2-b^2)(\\frac{2-b^2}{2}) + 2 = 2 - \\frac{(2-b^2)^2}{4}$。由于 $0  b^2  2$，我们有 $0  2-b^2  2$，所以 $0  (2-b^2)^2  4$。这得出 $0  \\frac{(2-b^2)^2}{4}  1$，因此 $1  q(\\Delta t_v)  2$。\n在这两种情况下，对于所有 $\\Delta t > 0$ 和 $b > 0$ 都有 $q(\\Delta t) > 0$。因此，第二个条件总是满足的。\n\n欧拉-丸山法均方稳定的唯一条件是 $\\Delta t  2 - b^2$，这要求 $b^2  2$。\n\n**第三部分：最大步长 $\\Delta t_{\\max}$ 的确定**\n\n问题要求在精确解稳定的假设下，求使数值方法也稳定的最大步长 $\\Delta t_{\\max}$。\n从第一部分可知，精确解是稳定的当且仅当 $0  b^2  2$。从第二部分可知，对于给定的满足 $b^2  2$ 的 $b$，欧拉-丸山法是稳定的当且仅当步长 $\\Delta t$ 满足 $0  \\Delta t  2 - b^2$。\n使该稳定性条件成立的最大步长是该区间的上界。\n因此，最大允许步长是：\n$$\n\\Delta t_{\\max} = 2 - b^2\n$$\n这个结果凸显了噪声诱导刚性的现象。单独的漂移项表明稳定性极限为 $\\Delta t  2$。然而，由 $b$ 控制的乘性噪声项施加了一个更严格的约束 $\\Delta t  2 - b^2$。当 $b$ 接近连续时间稳定性边界，即 $b \\to \\sqrt{2}^{-}$ 时，显式方法的最大稳定步长 $\\Delta t_{\\max}$ 趋于零，需要越来越小的时间步长才能进行稳定的模拟。", "answer": "$$\\boxed{2 - b^2}$$", "id": "2979927"}, {"introduction": "在认识到显式方法的局限性后，我们现在转向一个强大的替代方案：半隐式格式。本练习 [@problem_id:2980005] 聚焦于漂移项隐式的欧拉-丸山法，这是一种仅将刚性漂移项作隐式处理的常用方法。您的任务是推导其均方放大因子，这将从量化角度揭示这种选择性的隐式处理相比于完全显式方法是如何增强数值稳定性的。", "problem": "考虑标量线性随机微分方程 (SDE) $$\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t},$$ 其中 $W_{t}$ 是一个标准维纳过程，$\\lambda\\in\\mathbb{R}$ 模拟了一个刚性线性漂移（$\\lambda0$），而 $\\mu\\in\\mathbb{R}$ 是乘性噪声强度。设 $h0$ 为一个固定的时间步长，并用 $X_{n}\\approx X_{t_{n}}$ 表示在 $t_{n}=nh$ 时由漂移项隐式欧拉-丸山方法产生的数值近似，该方法隐式处理漂移项，显式处理扩散项。\n\n从伊藤微积分的基本定义以及应用于此SDE的漂移项隐式欧拉-丸山方法的更新规则出发，推导由下式定义的离散单步均方 (MS) 放大因子 $R_{\\text{MS}}(h,\\lambda,\\mu)$：$$R_{\\text{MS}}(h,\\lambda,\\mu)=\\frac{\\mathbb{E}\\!\\left[|X_{n+1}|^{2}\\right]}{\\mathbb{E}\\!\\left[|X_{n}|^{2}\\right]}.$$ 然后，将此离散均方放大因子与从该SDE二阶矩的演化方程中得到的精确连续时间均方衰减/增长率进行比较，并解释关于 $h$ 的主阶关系。\n\n你的最终答案应该是 $R_{\\text{MS}}(h,\\lambda,\\mu)$ 关于 $h$、$\\lambda$ 和 $\\mu$ 的闭式解析表达式。不需要进行数值计算或四舍五入。", "solution": "该问题要求推导漂移项隐式欧拉-丸山方法应用于一个特定的线性随机微分方程 (SDE) 时的均方 (MS) 放大因子，并将此因子与精确的连续时间结果进行比较。\n\n首先，验证问题陈述。\n**第1步：提取已知条件**\n- SDE：$\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t}$\n- $W_t$ 是一个标准维纳过程。\n- $\\lambda \\in \\mathbb{R}$ 且 $\\lambda  0$。\n- $\\mu \\in \\mathbb{R}$。\n- 时间步长：$h > 0$。\n- 数值近似：$X_{n} \\approx X_{t_{n}}$，在 $t_{n} = nh$ 时。\n- 数值方法：漂移项隐式欧拉-丸山方法。\n- 均方放大因子的定义：$R_{\\text{MS}}(h,\\lambda,\\mu)=\\frac{\\mathbb{E}\\!\\left[|X_{n+1}|^{2}\\right]}{\\mathbb{E}\\!\\left[|X_{n}|^{2}\\right]}$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学上成立：** 该问题涉及一个标准的线性SDE（几何布朗运动）、一个成熟的数值方法（漂移项隐式欧拉-丸山方法），以及数值SDE分析中的一个基本概念（均方稳定性）。所有概念都植根于随机微积分和数值分析的既定理论。\n- **适定性：** 该问题提供了推导放大因子的唯一解析表达式所需的所有定义和方程。问题陈述清晰，并能导出一个可确定的解。\n- **客观性：** 语言正式且精确，没有主观或含糊的陈述。\n\n**第3步：结论与行动**\n问题有效。有必要给出完整解。\n\n对于一个SDE $\\mathrm{d}X_t = a(X_t, t)\\mathrm{d}t + b(X_t, t)\\mathrm{d}W_t$，漂移项隐式欧拉-丸山格式的一般形式由下式给出：\n$$X_{n+1} = X_n + a(X_{n+1}, t_{n+1})h + b(X_n, t_n)\\Delta W_n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 是维纳过程在区间 $[t_n, t_{n+1}]$ 上的增量。\n\n对于给定的SDE $\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t}$，漂移项为 $a(X_t) = \\lambda X_t$，扩散项为 $b(X_t) = \\mu X_t$。应用漂移项隐式格式可得：\n$$X_{n+1} = X_n + \\lambda X_{n+1} h + \\mu X_n \\Delta W_n$$\n这是一个关于 $X_{n+1}$ 的隐式方程。我们可以通过代数方法解出 $X_{n+1}$：\n$$X_{n+1} - \\lambda X_{n+1} h = X_n + \\mu X_n \\Delta W_n$$\n$$X_{n+1}(1 - \\lambda h) = X_n(1 + \\mu \\Delta W_n)$$\n假设 $1 - \\lambda h \\neq 0$（因为 $\\lambda  0$ 且 $h > 0$，所以该假设成立），我们有：\n$$X_{n+1} = \\frac{1 + \\mu \\Delta W_n}{1 - \\lambda h} X_n$$\n这就是数值近似的显式单步更新规则。\n\n现在，我们可以计算均方放大因子 $R_{\\text{MS}}(h,\\lambda,\\mu)$。我们首先计算 $X_{n+1}$ 的模的平方：\n$$|X_{n+1}|^2 = \\left| \\frac{1 + \\mu \\Delta W_n}{1 - \\lambda h} X_n \\right|^2 = \\frac{(1 + \\mu \\Delta W_n)^2}{(1 - \\lambda h)^2} |X_n|^2$$\n接下来，我们对该表达式取期望。我们使用全期望定律，以在时间 $t_n$ 可用的信息（由信息流 $\\mathcal{F}_{t_n}$ 表示）为条件。近似值 $X_n$ 是 $\\mathcal{F}_{t_n}$-可测的，而增量 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_n}$。\n$$\\mathbb{E}[|X_{n+1}|^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\frac{(1 + \\mu \\Delta W_n)^2}{(1 - \\lambda h)^2} |X_n|^2 \\bigg| \\mathcal{F}_{t_n} \\right] \\right]$$\n由于 $|X_n|^2$ 和分母 $(1 - \\lambda h)^2$ 是 $\\mathcal{F}_{t_n}$-可测的，它们在内层期望中可以被当作常数：\n$$\\mathbb{E}[|X_{n+1}|^2] = \\mathbb{E}\\left[ \\frac{|X_n|^2}{(1 - \\lambda h)^2} \\mathbb{E}\\left[ (1 + \\mu \\Delta W_n)^2 \\bigg| \\mathcal{F}_{t_n} \\right] \\right]$$\n由于 $\\Delta W_n$ 独立于 $\\mathcal{F}_{t_n}$，条件期望变成了无条件期望：\n$$\\mathbb{E}[|X_{n+1}|^2] = \\frac{1}{(1 - \\lambda h)^2} \\mathbb{E}[|X_n|^2] \\mathbb{E}[(1 + \\mu \\Delta W_n)^2]$$\n增量 $\\Delta W_n$ 是一个均值为 $0$、方差为 $h$ 的正态分布随机变量，即 $\\Delta W_n \\sim \\mathcal{N}(0, h)$。因此，$\\mathbb{E}[\\Delta W_n] = 0$ 且 $\\mathbb{E}[(\\Delta W_n)^2] = h$。我们用此来计算剩余的期望：\n$$\\mathbb{E}[(1 + \\mu \\Delta W_n)^2] = \\mathbb{E}[1 + 2\\mu\\Delta W_n + \\mu^2(\\Delta W_n)^2]$$\n根据期望的线性性：\n$$\\mathbb{E}[(1 + \\mu \\Delta W_n)^2] = 1 + 2\\mu\\mathbb{E}[\\Delta W_n] + \\mu^2\\mathbb{E}[(\\Delta W_n)^2] = 1 + 2\\mu(0) + \\mu^2(h) = 1 + \\mu^2 h$$\n将此结果代回，我们得到连续时间步下二阶矩之间的关系：\n$$\\mathbb{E}[|X_{n+1}|^2] = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2} \\mathbb{E}[|X_n|^2]$$\n因此，离散单步均方放大因子为：\n$$R_{\\text{MS}}(h,\\lambda,\\mu) = \\frac{\\mathbb{E}[|X_{n+1}|^2]}{\\mathbb{E}[|X_n|^2]} = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2}$$\n这是要求回答的第一部分。\n\n为了进行比较，我们必须求出精确的连续时间均方衰减/增长率。令 $m_2(t) = \\mathbb{E}[X_t^2]$。我们使用伊藤公式推导控制 $m_2(t)$ 的常微分方程 (ODE)。对于 $f(x) = x^2$，我们有 $f'(x) = 2x$ 和 $f''(x) = 2$。将伊藤公式应用于 $X_t^2$：\n$$\\mathrm{d}(X_t^2) = \\left( (2X_t)(\\lambda X_t) + \\frac{1}{2}(2)(\\mu X_t)^2 \\right)\\mathrm{d}t + (2X_t)(\\mu X_t)\\mathrm{d}W_t$$\n$$\\mathrm{d}(X_t^2) = (2\\lambda + \\mu^2)X_t^2\\,\\mathrm{d}t + 2\\mu X_t^2\\,\\mathrm{d}W_t$$\n对两边取期望，并注意到伊藤积分项的期望为零（$\\mathbb{E}[\\int_{0}^{t} 2\\mu X_s^2\\,\\mathrm{d}W_s] = 0$）：\n$$\\mathrm{d}(\\mathbb{E}[X_t^2]) = (2\\lambda + \\mu^2)\\mathbb{E}[X_t^2]\\,\\mathrm{d}t$$\n这给出了二阶矩 $m_2(t)$ 的ODE：\n$$\\frac{\\mathrm{d}m_2(t)}{\\mathrm{d}t} = (2\\lambda + \\mu^2)m_2(t)$$\n其解为 $m_2(t) = m_2(0)\\exp((2\\lambda + \\mu^2)t)$。在长度为 $h$ 的时间步长上，二阶矩的精确放大因子为：\n$$R_{\\text{exact}}(h) = \\frac{m_2(t_n+h)}{m_2(t_n)} = \\exp((2\\lambda + \\mu^2)h)$$\n为了比较 $R_{\\text{MS}}$ 和 $R_{\\text{exact}}$，我们对两个表达式在 $h=0$ 附近按 $h$ 的幂次进行泰勒展开。\n对于精确因子：\n$$R_{\\text{exact}}(h) = 1 + (2\\lambda + \\mu^2)h + \\frac{1}{2}(2\\lambda + \\mu^2)^2 h^2 + O(h^3)$$\n对于数值因子，我们使用几何级数展开 $(1-x)^{-2} = 1 + 2x + 3x^2 + \\dots$：\n$$R_{\\text{MS}}(h) = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2} = (1 + \\mu^2 h)(1 - \\lambda h)^{-2}$$\n$$R_{\\text{MS}}(h) = (1 + \\mu^2 h)(1 + 2\\lambda h + 3\\lambda^2 h^2 + O(h^3))$$\n$$R_{\\text{MS}}(h) = 1 + 2\\lambda h + 3\\lambda^2 h^2 + \\mu^2 h + 2\\lambda\\mu^2 h^2 + O(h^3)$$\n$$R_{\\text{MS}}(h) = 1 + (2\\lambda + \\mu^2)h + (3\\lambda^2 + 2\\lambda\\mu^2)h^2 + O(h^3)$$\n比较这两个级数展开，我们看到 $h^0$ 和 $h^1$ 的系数是相同的。\n$$R_{\\text{MS}}(h) - R_{\\text{exact}}(h) = O(h^2)$$\n这意味着漂移项隐式欧拉-丸山方法在步长 $h$ 上再现了精确均方动态性到一阶。主阶关系是，数值均方放大因子是精确因子的一个一阶近似：$R_{\\text{MS}}(h) = R_{\\text{exact}}(h) + O(h^2)$。", "answer": "$$\\boxed{\\frac{1 + \\mu^{2} h}{(1 - \\lambda h)^{2}}}$$", "id": "2980005"}, {"introduction": "在半隐式思想的基础上，我们可以将隐式处理的概念扩展至包含漂移项和扩散项，从而得到一个完全隐式的方法。本练习 [@problem_id:2980028] 为构建此类应用于线性随机微分方程的格式提供了实践机会。通过推导其更新规则，您将学习到在完全隐式离散化中，如何建立并求解由此产生的代数方程，这是实施任何隐式方法的核心步骤。", "problem": "考虑由标准布朗运动 $W_t$ 驱动的标量线性随机微分方程 (SDE) $dX_t = a X_t \\, dt + b X_t \\, dW_t$，其中 $a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}$ 是常数。设 $\\{t_n\\}_{n=0}^{N}$ 是一个步长为 $h = t_{n+1} - t_n$ 的均匀时间网格，并定义布朗增量 $\\Delta W_n := W_{t_{n+1}} - W_{t_n}$，它服从均值为 $0$、方差为 $h$ 的高斯分布。在刚性随机微分方程和面向稳定性的时间步进方法的背景下，人们经常使用一种隐式离散化方法，该方法在下一时刻的状态点上计算漂移项和扩散项。\n\n从伊藤积分形式出发，对勒贝格积分和伊藤积分均采用后向（右端点）近似，即将每个时间步上的被积函数视为分段常数并在 $X_{n+1}$ 处取值，推导出最终的全隐式单步更新格式，并精确求解以获得 $X_{n+1}$ 关于 $X_n$、$a$、$b$、$h$ 和 $\\Delta W_n$ 的闭式表达式。\n\n您的最终答案必须是单个闭式解析表达式。请勿对答案进行四舍五入。", "solution": "问题陈述经评估有效。它在科学上基于随机微分方程理论及其数值近似，问题是适定的、客观的，并包含唯一推导所需的所有必要信息。\n\n所考虑的随机微分方程 (SDE) 是标量线性随机微分方程，也称为几何布朗运动：\n$$dX_t = a X_t \\, dt + b X_t \\, dW_t$$\n其中 $a$ 和 $b$ 是实常数，$W_t$ 是一维标准布朗运动。\n\n为了推导从时间 $t_n$ 到 $t_{n+1}$ 的数值单步更新，我们首先将SDE写成在区间 $[t_n, t_{n+1}]$ 上的伊藤积分形式：\n$$X(t_{n+1}) - X(t_n) = \\int_{t_n}^{t_{n+1}} a X_s \\, ds + \\int_{t_n}^{t_{n+1}} b X_s \\, dW_s$$\n令 $X_n$ 表示 $X(t_n)$ 的数值近似，$h = t_{n+1} - t_n$ 为均匀时间步长，$\\Delta W_n = W(t_{n+1}) - W(t_n)$ 为布朗运动的增量。于是方程可写为：\n$$X_{n+1} - X_n = \\int_{t_n}^{t_{n+1}} a X_s \\, ds + \\int_{t_n}^{t_{n+1}} b X_s \\, dW_s$$\n\n问题要求使用全隐式格式，该格式由对勒贝格积分（漂移项）和伊藤积分（扩散项）的后向或右端点近似推导得出。这种近似方法将区间 $[t_n, t_{n+1}]$ 上的被积函数视为常数，其值等于在端点 $t_{n+1}$ 处的值。\n\n对于勒贝格积分（漂移项），近似为：\n$$\\int_{t_n}^{t_{n+1}} a X_s \\, ds \\approx a X_{n+1} \\int_{t_n}^{t_{n+1}} ds = a X_{n+1} (t_{n+1} - t_n) = a h X_{n+1}$$\n这是对漂移项的标准后向欧拉近似。\n\n对于伊藤积分（扩散项），我们应用问题陈述中指定的相同近似规则，在下一时间步 $t_{n+1}$ 处计算被积函数 $b X_s$：\n$$\\int_{t_n}^{t_{n+1}} b X_s \\, dW_s \\approx b X_{n+1} \\int_{t_n}^{t_{n+1}} dW_s = b X_{n+1} (W(t_{n+1}) - W(t_n)) = b X_{n+1} \\Delta W_n$$\n\n将这两个近似代入积分方程，得到离散时间的全隐式更新规则：\n$$X_{n+1} - X_n = a h X_{n+1} + b \\Delta W_n X_{n+1}$$\n这是一个关于未知状态 $X_{n+1}$ 的代数方程。为了找到单步更新的显式表达式，我们必须解这个关于 $X_{n+1}$ 的方程。我们首先将所有包含 $X_{n+1}$ 的项移到方程的一边，将包含 $X_n$ 的项移到另一边：\n$$X_n = X_{n+1} - a h X_{n+1} - b \\Delta W_n X_{n+1}$$\n\n接下来，我们从右侧的项中提取公因式 $X_{n+1}$：\n$$X_n = X_{n+1} (1 - a h - b \\Delta W_n)$$\n\n最后，在 $(1 - a h - b \\Delta W_n)$ 不为零的情况下，我们可以通过将方程两边同时除以该因子来分离出 $X_{n+1}$：\n$$X_{n+1} = \\frac{X_n}{1 - a h - b \\Delta W_n}$$\n这就是全隐式单步更新的闭式表达式，它将 $X_{n+1}$ 表示为前一状态 $X_n$、模型参数 $a$ 和 $b$、时间步长 $h$ 以及随机布朗增量 $\\Delta W_n$ 的函数。", "answer": "$$\\boxed{\\frac{X_n}{1 - a h - b \\Delta W_n}}$$", "id": "2980028"}]}