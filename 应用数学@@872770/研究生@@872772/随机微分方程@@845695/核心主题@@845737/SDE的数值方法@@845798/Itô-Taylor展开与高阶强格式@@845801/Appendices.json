{"hands_on_practices": [{"introduction": "Itô-Taylor展开式的核心构件是多重随机积分。为了深刻理解数值格式的收敛阶，我们必须首先掌握这些基本构件的行为。本练习聚焦于一个三重Itô积分，通过计算其均值和均方值，我们将揭示其大小如何随时间步长$h$缩放，这一缩放行为是判断它在特定阶数数值格式中重要性的关键。[@problem_id:2982843]", "problem": "考虑一个$d$维标准维纳过程 $W_{t} = \\big(W_{t}^{1},\\dots,W_{t}^{d}\\big)$，其各分量相互独立，定义在一个满足通常条件的带滤概率空间上。对于固定的指标 $j,k,\\ell \\in \\{1,\\dots,d\\}$ 和步长 $h0$，定义三重迭代Itô积分\n$$\nI_{(j,k,\\ell)}(h) \\;=\\; \\int_{0}^{h} \\left( \\int_{0}^{s_{1}} \\left( \\int_{0}^{s_{2}} \\mathrm{d}W^{j}_{s_{3}} \\right) \\mathrm{d}W^{k}_{s_{2}} \\right) \\mathrm{d}W^{\\ell}_{s_{1}}.\n$$\n仅从维纳过程Itô积分的基本性质——即鞅性质和Itô等距性——出发，推导 $I_{(j,k,\\ell)}(h)$ 的主阶矩和其关于 $h$ 的标度律，并确定在用于随机微分方程（SDE）的1.5阶强收敛Itô–Taylor格式所使用的分层指标集中是否包含这类三重维纳积分。具体来说：\n- 计算 $\\mathbb{E}\\!\\left[I_{(j,k,\\ell)}(h)\\right]$。\n- 精确计算 $\\mathbb{E}\\!\\left[I_{(j,k,\\ell)}(h)^{2}\\right]$ 作为 $h$ 的函数。\n- 从你的推导中，提取由 $\\mathbb{E}\\!\\left[I_{(j,k,\\ell)}(h)^{2}\\right] = C\\,h^{2\\alpha}$ 定义的均方标度指数 $\\alpha$，其中 $C$ 是一个不依赖于 $h$ 的常数。\n- 根据“$p$阶强收敛格式保留均方大小标度不快于 $h^p$ 的项”这一原则，说明当 $p=1.5$ 时，$I_{(j,k,\\ell)}(h)$ 是否被保留。\n\n将你的最终答案表示为单行矩阵 $\\big(\\mathbb{E}[I_{(j,k,\\ell)}(h)],\\,\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}],\\,\\alpha,\\,\\chi\\big)$，其中如果该项在1.5阶强收敛格式中被保留，则 $\\chi=1$，否则 $\\chi=0$。无需进行舍入。", "solution": "该问题经验证是良定的、有科学依据且内部一致的。我们可以开始求解。\n\n问题要求分析给定的三重迭代Itô积分\n$$\nI_{(j,k,\\ell)}(h) \\;=\\; \\int_{0}^{h} \\left( \\int_{0}^{s_{1}} \\left( \\int_{0}^{s_{2}} \\mathrm{d}W^{j}_{s_{3}} \\right) \\mathrm{d}W^{k}_{s_{2}} \\right) \\mathrm{d}W^{\\ell}_{s_{1}}\n$$\n对于步长 $h0$ 和指标 $j,k,\\ell \\in \\{1,\\dots,d\\}$。过程 $W_t = (W_t^1, \\dots, W_t^d)$ 是一个标准的$d$维维纳过程。我们将使用鞅性质和Itô等距性来推导所需的量。\n\n为清晰起见，我们逐步定义嵌套积分。\n令 $X_{s_2} = \\int_{0}^{s_{2}} \\mathrm{d}W^{j}_{s_{3}}$。由于被积函数为1，这可简化为 $X_{s_2} = W^{j}_{s_{2}} - W^{j}_{0} = W^{j}_{s_{2}}$，因为 $W^{j}_{0} = 0$。\n令 $Y_{s_1} = \\int_{0}^{s_{1}} X_{s_2} \\mathrm{d}W^{k}_{s_{2}} = \\int_{0}^{s_{1}} W^{j}_{s_{2}} \\mathrm{d}W^{k}_{s_{2}}$。\n于是，完整的积分为 $I_{(j,k,\\ell)}(h) = \\int_{0}^{h} Y_{s_1} \\mathrm{d}W^{\\ell}_{s_{1}}$。\n\n**第一部分：计算 $\\mathbb{E}\\![I_{(j,k,\\ell)}(h)]$。**\n\n对于形如 $M_t = \\int_0^t f(s,\\omega) dW_s$ 的Itô积分，其一个关键性质是它是一个鞅，前提是被积函数 $f$ 是一个适应过程，且满足平方可积条件 $\\mathbb{E}[\\int_0^t f(s,\\omega)^2 ds]  \\infty$。如果 $M_t$ 是一个鞅，那么对于所有 $t \\ge 0$，有 $\\mathbb{E}[M_t] = \\mathbb{E}[M_0]$。\n\n让我们来考察我们的积分层次结构：\n1.  $X_t = W_t^j = \\int_0^t 1 \\, \\mathrm{d}W^j_s$。被积函数 $f(s)=1$ 是适应的，且 $\\mathbb{E}[\\int_0^t 1^2 ds] = t  \\infty$。$X_0=0$，所以 $\\mathbb{E}[X_t]=0$。\n\n2.  $Y_t = \\int_0^t W_s^j \\mathrm{d}W^k_s$。被积函数 $f(s) = W_s^j$ 是适应的。平方可积条件为 $\\mathbb{E}[\\int_0^t (W_s^j)^2 ds] = \\int_0^t \\mathbb{E}[(W_s^j)^2] ds = \\int_0^t s \\, ds = \\frac{t^2}{2}  \\infty$。因此，$Y_t$ 是一个鞅。由于 $Y_0 = 0$，我们有 $\\mathbb{E}[Y_t] = 0$。\n\n3.  $I_{(j,k,\\ell)}(t) = \\int_0^t Y_s \\mathrm{d}W^\\ell_s$。被积函数 $f(s) = Y_s$ 是适应的。使用对 $Y_s$ 的Itô等距性来检验平方可积性：\n    $\\mathbb{E}\\left[\\int_0^t Y_s^2 ds\\right] = \\int_0^t \\mathbb{E}[Y_s^2] ds$。\n    根据Itô等距性：$\\mathbb{E}[Y_s^2] = \\mathbb{E}[(\\int_0^s W_u^j dW_u^k)^2] = \\mathbb{E}[\\int_0^s (W_u^j)^2 du] = \\int_0^s \\mathbb{E}[(W_u^j)^2] du = \\int_0^s u \\, du = \\frac{s^2}{2}$。\n    所以，$\\mathbb{E}[\\int_0^t Y_s^2 ds] = \\int_0^t \\frac{s^2}{2} ds = \\frac{t^3}{6}  \\infty$。\n    因此，$I_{(j,k,\\ell)}(t)$ 是一个鞅。\n\n由于 $I_{(j,k,\\ell)}(t)$ 是一个鞅且 $I_{(j,k,\\ell)}(0) = 0$，其期望在任何时候都为零。对于 $t=h$：\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)] = 0.\n$$\n\n**第二部分：计算 $\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}]$。**\n\n由于 $I_{(j,k,\\ell)}(h)$ 是一个零均值随机变量，其二阶矩等于其方差。我们应用Itô等距性，该性质表明对于一个合适的适应过程 $f(s)$，有 $\\mathbb{E}[(\\int_0^h f(s) dW_s^\\ell)^2] = \\mathbb{E}[\\int_0^h f(s)^2 ds]$。\n在我们的例子中，被积函数是 $Y_{s_1} = \\int_{0}^{s_{1}} W^{j}_{s_{2}} \\mathrm{d}W^{k}_{s_{2}}$。\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}] = \\mathbb{E}\\left[\\left( \\int_{0}^{h} Y_{s_1} \\mathrm{d}W^{\\ell}_{s_{1}} \\right)^{2}\\right] = \\mathbb{E}\\left[\\int_{0}^{h} Y_{s_1}^{2} \\mathrm{d}s_{1}\\right].\n$$\n根据 Fubini 定理，我们可以交换期望和外层的时间积分：\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}] = \\int_{0}^{h} \\mathbb{E}\\![Y_{s_1}^{2}] \\mathrm{d}s_{1}.\n$$\n现在我们必须计算 $\\mathbb{E}[Y_{s_1}^2]$。我们再次对 $Y_{s_1}$ 应用Itô等距性：\n$$\n\\mathbb{E}\\![Y_{s_1}^{2}] = \\mathbb{E}\\left[\\left( \\int_{0}^{s_{1}} W^{j}_{s_{2}} \\mathrm{d}W^{k}_{s_{2}} \\right)^{2}\\right] = \\mathbb{E}\\left[\\int_{0}^{s_{1}} (W^{j}_{s_{2}})^{2} \\mathrm{d}s_{2}\\right].\n$$\n再次，我们交换期望和积分：\n$$\n\\mathbb{E}\\![Y_{s_1}^{2}] = \\int_{0}^{s_{1}} \\mathbb{E}\\![(W^{j}_{s_{2}})^{2}] \\mathrm{d}s_{2}.\n$$\n对于一个标准维纳过程的分量 $W^j$，我们有 $\\mathbb{E}[W^j_{s_2}] = 0$ 和 $\\text{Var}(W^j_{s_2}) = s_2$。因此，$\\mathbb{E}[(W^j_{s_2})^2] = s_2$。\n将此代入 $\\mathbb{E}[Y_{s_1}^2]$ 的表达式中：\n$$\n\\mathbb{E}\\![Y_{s_1}^{2}] = \\int_{0}^{s_{1}} s_{2} \\mathrm{d}s_{2} = \\frac{s_{1}^{2}}{2}.\n$$\n最后，我们将此结果代回到 $I_{(j,k,\\ell)}(h)$ 的二阶矩表达式中：\n$$\n\\mathbb{E}\\![I_{(j,k,\\ell)}(h)^{2}] = \\int_{0}^{h} \\frac{s_{1}^{2}}{2} \\mathrm{d}s_{1} = \\left[ \\frac{s_{1}^{3}}{6} \\right]_{0}^{h} = \\frac{h^{3}}{6}.\n$$\n这个结果与指标 $j,k,\\ell$ 无关。\n\n**第三部分：确定标度指数 $\\alpha$。**\n\n问题通过关系式 $\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}] = C h^{2\\alpha}$ 定义了均方标度指数 $\\alpha$。\n从我们的计算中，我们得到 $\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}] = \\frac{1}{6} h^{3}$。\n比较 $h$ 的指数，我们得到：\n$$\n2\\alpha = 3 \\implies \\alpha = \\frac{3}{2}.\n$$\n\n**第四部分：在1.5阶强收敛格式中的保留问题。**\n\n问题为在$p$阶强收敛格式中保留一个项提供了准则：该项的“均方大小标度不快于$h^p$”。我们给定$p=1.5$。\n我们的项的均方根大小是 $\\sqrt{\\mathbb{E}[I_{(j,k,\\ell)}(h)^2]} = \\sqrt{\\frac{h^3}{6}} = O(h^{1.5})$。\n在SDE数值方法的标准框架中，一个强收敛阶为 $p$ 的格式需要包含所有均方根误差标度为 $O(h^k)$ 且 $k \\le p$ 的项。\n对于我们的项 $I_{(j,k,\\ell)}(h)$，其均方根标度为 $O(h^{1.5})$。由于 $p=1.5$，该标度指数 $k=1.5$ 满足 $k \\le p$。因此，该项必须被保留。\n另一种方法是使用分级规则。对于多重指标 $\\alpha=(j,k,\\ell)$，其中 $j,k,l \\neq 0$，我们有 $n_0(\\alpha)=0$ 个时间积分和 $n_w(\\alpha)=3$ 个维纳积分。分级为 $\\gamma(\\alpha) = n_0(\\alpha) + \\frac{1}{2} n_w(\\alpha) = 0 + \\frac{3}{2} = 1.5$。对于一个 $p=1.5$ 阶的强格式，我们需要保留所有满足 $\\gamma(\\alpha) \\le 1.5$ 的项。由于此项的分级恰好为 $1.5$，它被保留。\n因此，我们设 $\\chi=1$。\n\n最终结果是：\n- $\\mathbb{E}[I_{(j,k,\\ell)}(h)] = 0$\n- $\\mathbb{E}[I_{(j,k,\\ell)}(h)^{2}] = \\frac{h^3}{6}$\n- $\\alpha = \\frac{3}{2}$\n- 该项被保留，所以 $\\chi = 1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0  \\frac{h^{3}}{6}  \\frac{3}{2}  1 \\end{pmatrix}\n}\n$$", "id": "2982843"}, {"introduction": "在掌握了随机积分的基本性质后，下一步是为给定的随机微分方程（SDE）确定这些积分在展开式中的系数。这些系数并非简单的常数，而是状态变量的函数，通过作用特定的微分算子生成。本练习将引导您应用Itô-Taylor展开中的核心算子 $L^0$ 和 $L^k$ 到一个具体SDE的漂移项和扩散项上，从而直接计算构建高阶强格式所需的各项系数。[@problem_id:2982869]", "problem": "考虑二维 Itô 随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} = a(X_{t})\\,\\mathrm{d}t + \\sum_{k=1}^{2} b^{(k)}(X_{t})\\,\\mathrm{d}W_{t}^{(k)},\n$$\n其中 $X_{t} \\in \\mathbb{R}^{2}$，$W^{(1)}$ 和 $W^{(2)}$ 是相互独立标准维纳过程（布朗运动），系数函数为\n$$\na(x) = \\begin{pmatrix} a_{1}(x) \\\\ a_{2}(x) \\end{pmatrix} = \\begin{pmatrix} x_{1} + x_{2}^{2} \\\\ x_{1}x_{2} \\end{pmatrix},\\quad\nb^{(1)}(x) = \\begin{pmatrix} x_{1}^{2} \\\\ \\ln(1 + x_{2}^{2}) \\end{pmatrix},\\quad\nb^{(2)}(x) = \\begin{pmatrix} x_{1}x_{2} \\\\ \\exp(x_{1}) \\end{pmatrix}.\n$$\n这里 $\\ln$ 表示自然对数，$\\exp$ 表示指数函数。使用针对强格式的 Itô-Taylor 展开框架，计算在一般点 $x = (x_{1}, x_{2}) \\in \\mathbb{R}^{2}$ 处的算子应用 $L^{0}b^{(1)}(x)$、$L^{0}b^{(2)}(x)$、$L^{1}a(x)$ 和 $L^{2}a(x)$。然后，根据强格式中使用的多重 Itô 积分的指标-权重结构，指出这四个算子应用中的每一个是否对 1.5 阶强格式有贡献。\n\n将您的最终答案表示为单行矩阵\n$$\n\\begin{pmatrix}\n(L^{0}b^{(1)}(x))_{1}  (L^{0}b^{(1)}(x))_{2}  (L^{0}b^{(2)}(x))_{1}  (L^{0}b^{(2)}(x))_{2}  (L^{1}a(x))_{1}  (L^{1}a(x))_{2}  (L^{2}a(x))_{1}  (L^{2}a(x))_{2}  I_{L^{0}b^{(1)}}  I_{L^{0}b^{(2)}}  I_{L^{1}a}  I_{L^{2}a}\n\\end{pmatrix},\n$$\n其中每个 $I_{\\cdot}$ 是一个指示符，如果对应项对 1.5 阶强格式有贡献，则取值为 1，否则取值为 0。无需数值舍入；请提供精确的符号表达式。不涉及物理单位。", "solution": "用户提供了来自随机微分方程数值分析领域的有效问题陈述。任务是在 Itô-Taylor 展开框架内计算几个算子应用，并确定它们对于 1.5 阶强格式的相关性。\n\n### 步骤 1：Itô-Taylor 算子的定义\n\n对于一个具有 $m$ 个独立维纳过程的通用 $d$ 维 Itô SDE，\n$$\n\\mathrm{d}X_t = a(X_t) \\mathrm{d}t + \\sum_{k=1}^m b^{(k)}(X_t) \\mathrm{d}W_t^{(k)}\n$$\nItô-Taylor 展开使用算子 $L^0, L^1, \\dots, L^m$。对于一个足够光滑的标量函数 $f: \\mathbb{R}^d \\to \\mathbb{R}$，这些算子定义如下：\n$$\nL^0 f(x) = \\sum_{i=1}^d a_i(x) \\frac{\\partial f}{\\partial x_i}(x) + \\frac{1}{2} \\sum_{i,j=1}^d \\left( \\sum_{k=1}^m b_i^{(k)}(x) b_j^{(k)}(x) \\right) \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x)\n$$\n$$\nL^k f(x) = \\sum_{i=1}^d b_i^{(k)}(x) \\frac{\\partial f}{\\partial x_i}(x), \\quad \\text{对于 } k=1, \\dots, m\n$$\n当应用于向量值函数时，该算子应用于函数的每个分量。对于 $k \\ge 1$ 的算子 $L^k$，这可以使用雅可比矩阵简明地写出。如果 $g(x)$ 是一个向量值函数，其雅可比矩阵为 $(\\nabla g)_{ij} = \\frac{\\partial g_i}{\\partial x_j}$，我们有 $L^k g(x) = (\\nabla g(x)) b^{(k)}(x)$。\n\n在此问题中，维度为 $d=2$，维纳过程的数量为 $m=2$。点为 $x = (x_1, x_2)^T$。系数为：\n$$\na(x) = \\begin{pmatrix} x_{1} + x_{2}^{2} \\\\ x_{1}x_{2} \\end{pmatrix}, \\quad\nb^{(1)}(x) = \\begin{pmatrix} x_{1}^{2} \\\\ \\ln(1 + x_{2}^{2}) \\end{pmatrix}, \\quad\nb^{(2)}(x) = \\begin{pmatrix} x_{1}x_{2} \\\\ \\exp(x_{1}) \\end{pmatrix}\n$$\n\n### 步骤 2：算子应用的计算\n\n我们计算所需的项：$L^0 b^{(1)}(x)$、$L^0 b^{(2)}(x)$、$L^1 a(x)$ 和 $L^2 a(x)$。\n\n**$L^1 a(x)$ 和 $L^2 a(x)$ 的计算**\n\n首先，我们求 $a(x)$ 的雅可比矩阵：\n$$\n\\nabla a(x) =\n\\begin{pmatrix}\n\\frac{\\partial a_1}{\\partial x_1}  \\frac{\\partial a_1}{\\partial x_2} \\\\\n\\frac{\\partial a_2}{\\partial x_1}  \\frac{\\partial a_2}{\\partial x_2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  2x_2 \\\\\nx_2  x_1\n\\end{pmatrix}\n$$\n现在我们可以计算 $L^1 a(x)$ 和 $L^2 a(x)$：\n$$\nL^1 a(x) = (\\nabla a(x)) b^{(1)}(x) = \\begin{pmatrix} 1  2x_2 \\\\ x_2  x_1 \\end{pmatrix} \\begin{pmatrix} x_1^2 \\\\ \\ln(1+x_2^2) \\end{pmatrix} = \\begin{pmatrix} x_1^2 + 2x_2 \\ln(1+x_2^2) \\\\ x_1^2 x_2 + x_1 \\ln(1+x_2^2) \\end{pmatrix}\n$$\n$$\nL^2 a(x) = (\\nabla a(x)) b^{(2)}(x) = \\begin{pmatrix} 1  2x_2 \\\\ x_2  x_1 \\end{pmatrix} \\begin{pmatrix} x_1 x_2 \\\\ \\exp(x_1) \\end{pmatrix} = \\begin{pmatrix} x_1 x_2 + 2x_2 \\exp(x_1) \\\\ x_1 x_2^2 + x_1 \\exp(x_1) \\end{pmatrix}\n$$\n\n**$L^0 b^{(1)}(x)$ 的计算**\n\n我们将算子 $L^0$ 应用于 $b^{(1)}(x)$ 的每个分量。\n对于第一个分量，$f(x) = b_1^{(1)}(x) = x_1^2$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = 2x_1$，$\\frac{\\partial f}{\\partial x_2} = 0$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_1^2} = 2$，所有其他二阶偏导数均为零。\n应用 $L^0$ 公式：\n$$\n(L^0 b^{(1)})_1 = a_1 \\frac{\\partial f}{\\partial x_1} + a_2 \\frac{\\partial f}{\\partial x_2} + \\frac{1}{2} \\left( (b_1^{(1)})^2 + (b_1^{(2)})^2 \\right) \\frac{\\partial^2 f}{\\partial x_1^2}\n$$\n$$\n(L^0 b^{(1)})_1 = (x_1+x_2^2)(2x_1) + (x_1 x_2)(0) + \\frac{1}{2} \\left( (x_1^2)^2 + (x_1 x_2)^2 \\right)(2)\n$$\n$$\n(L^0 b^{(1)})_1 = 2x_1^2 + 2x_1 x_2^2 + x_1^4 + x_1^2 x_2^2 = x_1^4 + 2x_1^2 + x_1^2 x_2^2 + 2x_1 x_2^2\n$$\n对于第二个分量，$f(x) = b_2^{(1)}(x) = \\ln(1+x_2^2)$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = 0$，$\\frac{\\partial f}{\\partial x_2} = \\frac{2x_2}{1+x_2^2}$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_2^2} = \\frac{2(1+x_2^2) - 2x_2(2x_2)}{(1+x_2^2)^2} = \\frac{2-2x_2^2}{(1+x_2^2)^2}$，所有其他二阶偏导数均为零。\n应用 $L^0$ 公式：\n$$\n(L^0 b^{(1)})_2 = a_1 \\frac{\\partial f}{\\partial x_1} + a_2 \\frac{\\partial f}{\\partial x_2} + \\frac{1}{2} \\left( (b_2^{(1)})^2 + (b_2^{(2)})^2 \\right) \\frac{\\partial^2 f}{\\partial x_2^2}\n$$\n$$\n(L^0 b^{(1)})_2 = (x_1+x_2^2)(0) + (x_1 x_2) \\left(\\frac{2x_2}{1+x_2^2}\\right) + \\frac{1}{2} \\left( (\\ln(1+x_2^2))^2 + (\\exp(x_1))^2 \\right) \\left(\\frac{2-2x_2^2}{(1+x_2^2)^2}\\right)\n$$\n$$\n(L^0 b^{(1)})_2 = \\frac{2x_1 x_2^2}{1+x_2^2} + \\frac{(1-x_2^2) \\left( (\\ln(1+x_2^2))^2 + \\exp(2x_1) \\right)}{(1+x_2^2)^2}\n$$\n\n**$L^0 b^{(2)}(x)$ 的计算**\n\n我们将算子 $L^0$ 应用于 $b^{(2)}(x)$ 的每个分量。\n对于第一个分量，$f(x) = b_1^{(2)}(x) = x_1 x_2$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = x_2$，$\\frac{\\partial f}{\\partial x_2} = x_1$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_1 \\partial x_2} = 1$，所有其他二阶偏导数均为零。\n对于具有非零混合偏导数的 $L^0$ 公式为：\n$$\nL^0 f = \\sum_i a_i \\frac{\\partial f}{\\partial x_i} + \\sum_{k=1}^m \\left( b_1^{(k)} b_2^{(k)} \\right) \\frac{\\partial^2 f}{\\partial x_1 \\partial x_2}\n$$\n$$\n(L^0 b^{(2)})_1 = a_1(x_2) + a_2(x_1) + \\left( b_1^{(1)} b_2^{(1)} + b_1^{(2)} b_2^{(2)} \\right)(1)\n$$\n$$\n(L^0 b^{(2)})_1 = (x_1+x_2^2)x_2 + (x_1 x_2)x_1 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)\n$$\n$$\n(L^0 b^{(2)})_1 = x_1 x_2 + x_2^3 + x_1^2 x_2 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)\n$$\n对于第二个分量，$f(x) = b_2^{(2)}(x) = \\exp(x_1)$：\n- 一阶导数：$\\frac{\\partial f}{\\partial x_1} = \\exp(x_1)$，$\\frac{\\partial f}{\\partial x_2} = 0$。\n- 二阶导数：$\\frac{\\partial^2 f}{\\partial x_1^2} = \\exp(x_1)$，所有其他二阶偏导数均为零。\n应用 $L^0$ 公式：\n$$\n(L^0 b^{(2)})_2 = a_1 \\frac{\\partial f}{\\partial x_1} + \\frac{1}{2} \\left( (b_1^{(1)})^2 + (b_1^{(2)})^2 \\right) \\frac{\\partial^2 f}{\\partial x_1^2}\n$$\n$$\n(L^0 b^{(2)})_2 = (x_1+x_2^2)\\exp(x_1) + \\frac{1}{2} \\left( (x_1^2)^2 + (x_1 x_2)^2 \\right) \\exp(x_1)\n$$\n$$\n(L^0 b^{(2)})_2 = \\left( x_1 + x_2^2 + \\frac{1}{2}x_1^4 + \\frac{1}{2}x_1^2 x_2^2 \\right)\\exp(x_1)\n$$\n\n### 步骤 3：对 1.5 阶强格式的贡献\n\n强 Itô-Taylor 展开将解 $X_t$ 表示为形如 $f_\\alpha(X_0) I_\\alpha$ 的项之和，其中 $I_\\alpha$ 是对应于多重指标 $\\alpha = (j_1, j_2, \\dots, j_\\ell)$（其中 $j_i \\in \\{0, 1, \\dots, m\\}$）的多重 Itô 积分。一个数值格式要达到强收敛阶 $p$，它必须正确逼近展开式中所有分级 $\\gamma(\\alpha) \\le p$ 的项。分级由 $\\gamma(\\alpha) = n_0(\\alpha) + \\frac{1}{2} n_w(\\alpha)$ 给出，其中 $n_0(\\alpha)$ 是指标 $\\alpha$ 中 0 的数量，$n_w(\\alpha)$ 是非零指标的数量。\n\n我们关心的是 1.5 阶强格式 ($p=1.5$)。我们需要确定计算出的哪些算子对应于分级 $\\le 1.5$ 的积分。\n我们计算的项是以下多重积分的系数：\n- $L^0 b^{(k)}(x)$ 是 $k \\in \\{1, 2\\}$ 时 $I_{(0,k)}$ 的系数。多重指标为 $\\alpha = (0,k)$，因此 $n_0(\\alpha)=1$，$n_w(\\alpha)=1$。分级为 $\\gamma(\\alpha) = 1 + \\frac{1}{2}(1) = 1.5$。由于 $1.5 \\le 1.5$，这些项有贡献。因此，$I_{L^0 b^{(1)}} = 1$ 且 $I_{L^0 b^{(2)}} = 1$。\n- $L^k a(x)$ 是 $k \\in \\{1, 2\\}$ 时 $I_{(k,0)}$ 的系数。多重指标为 $\\alpha = (k,0)$，因此 $n_0(\\alpha)=1$，$n_w(\\alpha)=1$。分级为 $\\gamma(\\alpha) = 1 + \\frac{1}{2}(1) = 1.5$。由于 $1.5 \\le 1.5$，这些项有贡献。因此，$I_{L^1 a} = 1$ 且 $I_{L^2 a} = 1$。\n\n所有四个计算出的算子应用对于构建 1.5 阶强格式都是必需的。\n\n### 步骤 4：最终答案组合\n\n我们按照规定将 12 个所需分量组合成一个单行矩阵。\n1.  $(L^{0}b^{(1)})_1 = x_1^4 + 2x_1^2 + x_1^2 x_2^2 + 2x_1 x_2^2$\n2.  $(L^{0}b^{(1)})_2 = \\frac{2x_1 x_2^2}{1+x_2^2} + \\frac{(1-x_2^2)(\\exp(2x_1) + (\\ln(1+x_2^2))^2)}{(1+x_2^2)^2}$\n3.  $(L^{0}b^{(2)})_1 = x_1 x_2 + x_2^3 + x_1^2 x_2 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)$\n4.  $(L^{0}b^{(2)})_2 = \\left( x_1 + x_2^2 + \\frac{1}{2}x_1^4 + \\frac{1}{2}x_1^2 x_2^2 \\right)\\exp(x_1)$\n5.  $(L^{1}a)_1 = x_1^2 + 2x_2 \\ln(1+x_2^2)$\n6.  $(L^{1}a)_2 = x_1^2 x_2 + x_1 \\ln(1+x_2^2)$\n7.  $(L^{2}a)_1 = x_1 x_2 + 2x_2 \\exp(x_1)$\n8.  $(L^{2}a)_2 = x_1 x_2^2 + x_1 \\exp(x_1)$\n9.  $I_{L^{0}b^{(1)}} = 1$\n10. $I_{L^{0}b^{(2)}} = 1$\n11. $I_{L^{1}a} = 1$\n12. $I_{L^{2}a} = 1$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nx_1^4 + 2x_1^2 + x_1^2 x_2^2 + 2x_1 x_2^2  \\frac{2x_1 x_2^2}{1+x_2^2} + \\frac{(1-x_2^2)(\\exp(2x_1) + (\\ln(1+x_2^2))^2)}{(1+x_2^2)^2}  x_1 x_2 + x_2^3 + x_1^2 x_2 + x_1^2 \\ln(1+x_2^2) + x_1 x_2 \\exp(x_1)  \\left( x_1 + x_2^2 + \\frac{1}{2}x_1^4 + \\frac{1}{2}x_1^2 x_2^2 \\right)\\exp(x_1)  x_1^2 + 2x_2 \\ln(1+x_2^2)  x_1^2 x_2 + x_1 \\ln(1+x_2^2)  x_1 x_2 + 2x_2 \\exp(x_1)  x_1 x_2^2 + x_1 \\exp(x_1)  1  1  1  1\n\\end{pmatrix}\n}\n$$", "id": "2982869"}, {"introduction": "构建高阶数值格式不仅需要计算理论表达式，还需要高效地实现它们。一个关键的方面是理解不同随机积分之间的关系，以及如何对它们进行简化或近似。本练习探讨了迭代积分 $I_{(j,j)}(h)$ 与简单的布朗增量 $\\Delta W^j$ 之间的精确关系，该关系源于Itô公式。它突显了强格式（旨在保持路径属性）和弱格式（侧重于匹配统计矩）在根本要求上的深刻差异。[@problem_id:2982893]", "problem": "考虑一个由标准 $m$ 维布朗运动驱动的 $d$ 维随机微分方程，$dX_t = a(X_t)\\,dt + \\sum_{j=1}^m b_j(X_t)\\,dW_t^j$，其中 $a:\\mathbb{R}^d\\to\\mathbb{R}^d$ 和 $b_j:\\mathbb{R}^d\\to\\mathbb{R}^d$ 足够光滑，并满足保证强解存在的标准增长条件和 Lipschitz 条件。对于大小为 $h0$ 的时间步长，用 $\\Delta W^j = W_{t+h}^j - W_t^j$ 表示布朗增量，用 $I_{(j,k)}(h) = \\int_t^{t+h}\\int_t^{s_1} dW_{s_2}^k\\,dW_{s_1}^j$ 表示迭代 Itô 积分。在强阶最高为 $1.5$ 的 Itô–Taylor 格式中，会出现形如 $I_{(j,j)}(h)$ 的项。\n\n一种常见的实现是在强 Itô–Taylor 积分器中用 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 替换 $I_{(j,j)}(h)$。相比之下，阶数超过 $1.5$ 的弱格式通常对驱动噪声采用矩匹配代理，其中每个 $\\Delta W^j$ 都被一个具有指定有限个匹配矩的非高斯随机变量所取代。\n\n仅使用以下基本事实：\n- Itô 积分和多重 Itô 积分的定义，\n- 布朗运动的二次变差和针对 $f(x)=x^2$ 的 Itô 公式，\n- 强阶（均方路径精度）和弱阶（对光滑测试函数的期望精度）的定义，\n- 以及弱 Taylor 展开的矩要求（驱动随机变量的联合矩直到某个总阶数必须与布朗运动的联合矩相匹配），\n\n选择所有能正确解释为什么替换 $I_{(j,j)}(h)\\mapsto \\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 能保持强阶，但除非施加额外条件，否则可能无法保持超过 $1.5$ 的弱阶的陈述。\n\nA. 对于真实的高斯布朗增量，连接 $I_{(j,j)}(h)$ 和 $\\Delta W^j$ 的恒等式可由 Itô 公式和二次变差导出，因此代入 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 不会改变逐路径的局部截断误差，从而不会降低 Itô–Taylor 格式的强阶。\n\nB. 在用只匹配有限个矩的非高斯代理替换 $\\Delta W^j$ 的弱格式中，将 $I_{(j,j)}(h)$ 定义为 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 通常无法再现 $\\Delta W^j$ 和 $I_{(j,j)}(h)$ 之间所有总阶数最高为 $4$ 的必需联合矩，因此当目标阶数高于 $1.5$ 时，弱阶可能会下降。\n\nC. 该替换是无效的，因为在 Itô 积分学中，$I_{(j,j)}(h)$ 独立于 $\\Delta W^j$；强制施加二次关系会引入伪相关性，并破坏强阶和弱阶。\n\nD. 弱阶仅取决于匹配 $\\mathbb{E}[\\Delta W^j]$ 和 $\\mathbb{E}[I_{(j,j)}(h)]$；因此，任何保持这些均值的替换都能保证任意弱阶。", "solution": "问题要求解释为什么替换 $I_{(j,j)}(h) \\mapsto \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 对强 Itô-Taylor 格式有效，但对高阶弱格式可能有问题。我们将使用所提供的基本事实来分析这一点。\n\n首先，我们来建立标准一维布朗运动 $W_t$ 的迭代 Itô 积分 $I_{(j,j)}(h)$ 与布朗增量 $\\Delta W^j$ 之间的关系。为简单起见，我们省略索引 $j$。$W_t$ 的随机微分方程是 $dW_t = 0 \\cdot dt + 1 \\cdot dW_t$。\n我们将函数 $f(x) = x^2$ 的 Itô 公式应用于过程 $X_t = W_t$。该公式为 $df(X_t) = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) d\\langle X \\rangle_t$。\n对于 $f(x)=x^2$，我们有 $f'(x)=2x$ 和 $f''(x)=2$。布朗运动的二次变差是 $d\\langle W \\rangle_t = dt$。\n将这些代入 Itô 公式得到：\n$$d(W_t^2) = 2W_t dW_t + \\frac{1}{2}(2)dt = 2W_t dW_t + dt$$\n将此随机微分从 $t$ 积分到 $t+h$：\n$$W_{t+h}^2 - W_t^2 = 2\\int_t^{t+h} W_s dW_s + \\int_t^{t+h} ds$$\n$$W_{t+h}^2 - W_t^2 = 2\\int_t^{t+h} W_s dW_s + h$$\n项 $\\int_t^{t+h} W_s dW_s$ 可以使用 Itô 积分的分部积分法展开，或者更直接地通过代入 $W_s = W_t + (W_s - W_t)$ 展开：\n$$ \\int_t^{t+h} W_s dW_s = \\int_t^{t+h} (W_t + (W_s - W_t)) dW_s = W_t \\int_t^{t+h} dW_s + \\int_t^{t+h} (W_s - W_t) dW_s $$\n认识到 $W_s - W_t = \\int_t^s dW_u$ 并使用多重 Itô 积分的定义，第二项是 $\\int_t^{t+h} \\int_t^s dW_u dW_s$，这正是第 $j$ 个分量的 $I_{(j,j)}(h)$。因此，对于单个分量：\n$$ \\int_t^{t+h} W_s dW_s = W_t (W_{t+h}-W_t) + I_{(j,j)}(h) $$\n将此代回到积分后的 Itô 公式中：\n$$W_{t+h}^2 - W_t^2 = 2(W_t \\Delta W^j + I_{(j,j)}(h)) + h$$\n另一方面，我们可以将 $W_{t+h}^2 - W_t^2$ 代数地写为：\n$$W_{t+h}^2 - W_t^2 = (W_t + \\Delta W^j)^2 - W_t^2 = W_t^2 + 2W_t \\Delta W^j + (\\Delta W^j)^2 - W_t^2 = 2W_t \\Delta W^j + (\\Delta W^j)^2$$\n令 $W_{t+h}^2 - W_t^2$ 的两个表达式相等：\n$$2W_t \\Delta W^j + (\\Delta W^j)^2 = 2W_t \\Delta W^j + 2I_{(j,j)}(h) + h$$\n$$(\\Delta W^j)^2 = 2I_{(j,j)}(h) + h$$\n解出迭代积分 $I_{(j,j)}(h)$（重新引入索引 $j$）：\n$$I_{(j,j)}(h) = \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$$\n对于真实的布朗运动，这是一个精确的恒等式，而不是一个近似。\n\n现在我们来评估每个选项。\n\n**A. 对于真实的高斯布朗增量，连接 $I_{(j,j)}(h)$ 和 $\\Delta W^j$ 的恒等式可由 Itô 公式和二次变差导出，因此代入 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 不会改变逐路径的局部截断误差，从而不会降低 Itô–Taylor 格式的强阶。**\n\n这个陈述是正确的。我们上面的推导表明 $I_{(j,j)}(h) = \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 是一个恒等式，是 Itô 公式和布朗运动二次变差的直接结果。强收敛关注解的逐路径近似。由于对于布朗运动的任何给定路径，该替换都是一个精确的恒等式，因此在 Itô-Taylor 展开中用 $\\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 替换 $I_{(j,j)}(h)$ 并不会改变数值格式增量在给定布朗路径实现下的值。因此，该格式的局部截断误差不受此替换的影响。由于强收敛阶取决于局部截断误差的阶，所以强阶得以保持。该陈述准确地描述了强格式的情况。**结论：正确。**\n\n**B. 在用只匹配有限个矩的非高斯代理替换 $\\Delta W^j$ 的弱格式中，将 $I_{(j,j)}(h)$ 定义为 $\\tfrac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 通常无法再现 $\\Delta W^j$ 和 $I_{(j,j)}(h)$ 之间所有总阶数最高为 $4$ 的必需联合矩，因此当目标阶数高于 $1.5$ 时，弱阶可能会下降。**\n\n这个陈述是正确的。弱格式近似期望值，而要达到 $p$ 阶的弱阶，需要数值增量的联合矩与真实增量的联合矩在总阶数最高达到 $2p$ 时相匹配。对于超过 1.5 的阶数（例如，弱阶 $p=2.0$），总阶数最高为 $2p=4$ 的矩必须匹配。在弱格式中，$\\Delta W^j$ 通常被一个计算上更廉价的非高斯随机变量（我们称之为 $\\tilde{W}^j$）所取代。当然后将迭代积分的代理*定义*为 $\\tilde{I}_{(j,j)}(h) = \\frac{1}{2}\\big((\\tilde{W}^j)^2 - h\\big)$ 时，随机变量对 $(\\tilde{W}^j, \\tilde{I}_{(j,j)}(h))$ 的联合矩就完全由 $\\tilde{W}^j$ 自身的矩决定了。\n要使这种方法奏效，必须选择 $\\tilde{W}^j$，使得所有由此产生的联合矩都与真实的联合矩相匹配。虽然可以为 $\\tilde{W}^j$ 构建一个代理（例如，一个特定的三点分布），使其对弱阶 2.0（即总阶数最高为 4 的矩）有效，但一个更简单、更“通用”的、适用于较低阶的代理将会失败。例如，一个满足 $\\mathbb{P}(\\tilde{W}^j = \\pm\\sqrt{h})=1/2$ 的两点随机变量 $\\tilde{W}^j$ 能匹配最高 3 阶的矩（奇数阶矩为 $0$，$\\mathbb{E}[(\\tilde{W}^j)^2]=h$），但在四阶矩上失败了：$\\mathbb{E}[(\\tilde{W}^j)^4]=h^2$，而真实的高斯矩是 $3h^2$。这种差异导致更高阶的联合矩（例如 $\\mathbb{E}[(\\tilde{I}_{(j,j)}(h))^2]$）不正确，从而阻止该格式达到弱阶 2.0。“通常失败”这个措辞准确地抓住了这一点：这种方法不稳健，需要特定且仔细地选择代理。此外，即使有一个对 2.0 阶有效的代理，这种特定的定义对于更高的阶数（例如 3.0，需要匹配总阶数最高为 6 的矩）也将会失败，因为这种函数依赖关系过于死板，无法满足不断扩大的矩条件集合。因此，该陈述正确地指出了高阶弱格式失败的机制。**结论：正确。**\n\n**C. 该替换是无效的，因为在 Itô 积分学中，$I_{(j,j)}(h)$ 独立于 $\\Delta W^j$；强制施加二次关系会引入伪相关性，并破坏强阶和弱阶。**\n\n这个陈述是错误的。$I_{(j,j)}(h)$ 和 $\\Delta W^j$ 独立的前提是错误的。正如恒等式 $I_{(j,j)}(h) = \\frac{1}{2}\\big((\\Delta W^j)^2 - h\\big)$ 所示，$I_{(j,j)}(h)$ 是 $\\Delta W^j$ 的一个确定性函数，这表示一种非常强的依赖形式。虽然它们不相关（$\\text{Cov}(\\Delta W^j, I_{(j,j)}(h)) = 0$），但它们不是独立的。这种替换“破坏强阶和弱阶”的结论也是错误的。正如在选项 A 的分析中所解释的，它完美地保持了强阶。**结论：错误。**\n\n**D. 弱阶仅取决于匹配 $\\mathbb{E}[\\Delta W^j]$ 和 $\\mathbb{E}[I_{(j,j)}(h)]$；因此，任何保持这些均值的替换都能保证任意弱阶。**\n\n这个陈述是错误的。这个前提是对弱收敛要求的极大简化。保持均值 $\\mathbb{E}[\\Delta W^j]=0$ 和 $\\mathbb{E}[I_{(j,j)}(h)]=0$ 是一个必要条件，但远非充分条件。达到 $p$ 阶的弱阶需要匹配数值增量（例如 $\\Delta W^j$，$I_{(j,k)}(h)$ 等）的一整套联合矩层级，直到总阶数为 $2p$。例如，即使是 1.0 阶的弱阶也需要匹配像 $\\mathbb{E}[(\\Delta W^j)^2]=h$ 这样的二阶矩。声称仅匹配均值就“保证任意弱阶”是明显错误的。**结论：错误。**", "answer": "$$\\boxed{AB}$$", "id": "2982893"}]}