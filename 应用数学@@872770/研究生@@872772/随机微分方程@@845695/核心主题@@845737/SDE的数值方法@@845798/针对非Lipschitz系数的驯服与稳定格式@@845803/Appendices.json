{"hands_on_practices": [{"introduction": "要解决一个问题，首先必须精确地理解它。本练习将引导您剖析一个基础却至关重要的现象：标准显式欧拉-丸山（Euler-Maruyama）格式在处理非全局Lipschitz系数（如多项式漂移项）时的失效。通过对一个典型的随机微分方程（SDE）进行单步分析，您将亲手计算并确定导致数值解“爆炸”的条件，即漂移项在何时会压倒性地主导动态。[@problem_id:2999251] 这个实践为理解驯服与稳定格式的必要性提供了第一手经验和坚实的出发点。", "problem": "考虑 Itô 随机微分方程 $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$，其中 $W_{t}$ 是一个标准布朗运动 (BM)，且 $b(x)=-x^{3}$，$\\sigma(x)=x$。令 $t_{n}$ 为一个固定时间，$X_{t_{n}}=x_{n}$ 为当前状态，并令 $h0$ 为一个选定的时间步长。定义布朗增量 $\\Delta W_{n}=W_{t_{n}+h}-W_{t_{n}}$。\n\n仅使用 Itô 随机微分方程的基本定义，以及通过在 $X_{t}$ 处固定系数从积分形式 $X_{t+h}-X_{t}=\\int_{t}^{t+h}b(X_{s})\\,ds+\\int_{t}^{t+h}\\sigma(X_{s})\\,dW_{s}$ 构建显式 Euler-Maruyama (EM) 方法，计算对于给定的 $b$ 和 $\\sigma$，单步 Euler-Maruyama 增量 $\\Delta X_{n}=X_{t_{n}+h}-X_{t_{n}}$，并用 $x_{n}$，$h$ 和 $\\Delta W_{n}$ 表示。然后，通过对大小进行第一性原理比较，确定漂移贡献主导扩散贡献的条件（用 $x_{n}$、$h$ 和 $|\\Delta W_{n}|$ 表示），并解释在纯漂移情况下，这种主导如何通过 $|X_{t_{n}+h}|$ 相对于 $|X_{t_{n}}|$ 的增长，在显式欧拉更新中引起数值不稳定性。\n\n你的最终答案必须是计算出的单步 Euler-Maruyama 增量的单一闭式表达式。无需四舍五入，也不涉及任何单位。", "solution": "出发点是 Itô 随机微分方程的基本积分表示。对于 Itô 随机微分方程 $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$，在长度为 $h0$ 的单个时间步长上的增量由下式给出：\n$$\nX_{t_{n}+h}-X_{t_{n}}=\\int_{t_{n}}^{t_{n}+h}b(X_{s})\\,ds+\\int_{t_{n}}^{t_{n}+h}\\sigma(X_{s})\\,dW_{s}.\n$$\n显式 Euler-Maruyama (EM) 格式的产生，是通过在左端点 $X_{t_{n}}=x_{n}$ 处固定系数来近似漂移和扩散积分中的被积函数，并分别用 $b(x_{n})\\,h$ 和 $\\sigma(x_{n})\\,(W_{t_{n}+h}-W_{t_{n}})$ 来近似这些积分。因此，\n$$\n\\Delta X_{n}:=X_{t_{n}+h}-X_{t_{n}}\\approx b(x_{n})\\,h+\\sigma(x_{n})\\,\\Delta W_{n}.\n$$\n对于给定的系数 $b(x)=-x^{3}$ 和 $\\sigma(x)=x$，上式变为\n$$\n\\Delta X_{n}=-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n}.\n$$\n这就是闭式形式的单步 Euler-Maruyama 增量。\n\n接下来，我们比较漂移和扩散贡献的大小，以确定漂移何时占主导地位。漂移的大小为\n$$\n|\\text{drift}|=|b(x_{n})|\\,h=|x_{n}|^{3}\\,h,\n$$\n扩散的大小为\n$$\n|\\text{diffusion}|=|\\sigma(x_{n})|\\,|\\Delta W_{n}|=|x_{n}|\\,|\\Delta W_{n}|.\n$$\n漂移主导的特征是 $|\\text{drift}||\\text{diffusion}|$，这得到\n$$\n|x_{n}|^{3}\\,h  |x_{n}|\\,|\\Delta W_{n}|.\n$$\n假设 $x_{n}\\neq 0$，两边同除以 $|x_{n}|$ 得到条件\n$$\nh\\,|x_{n}|^{2}  |\\Delta W_{n}|.\n$$\n由于布朗增量 $\\Delta W_{n}$ 是均值为 $0$、方差为 $h$ 的正态分布，其典型大小的量级为 $\\sqrt{h}$。因此，从数量级上看，高概率的漂移主导区域对应于\n$$\nh\\,|x_{n}|^{2} \\gg \\sqrt{h},\n$$\n等价地，\n$$\n|x_{n}| \\gg h^{-1/4}.\n$$\n这表明，当 $|x_{n}|$ 相对于 $h^{-1/4}$ 较大时，漂移贡献高概率地主导扩散贡献。\n\n为了将漂移主导与显式 Euler 方法中的数值不稳定性联系起来，首先考虑常微分方程 $dX_{t}=-X_{t}^{3}\\,dt$ 的确定性纯漂移更新（将扩散增量设为零）。显式 Euler 更新可写为\n$$\nx_{n+1}=x_{n}-h\\,x_{n}^{3}=x_{n}\\left(1-h\\,x_{n}^{2}\\right).\n$$\n其大小根据以下公式演化：\n$$\n|x_{n+1}|=|x_{n}|\\,\\left|1-h\\,x_{n}^{2}\\right|.\n$$\n数值意义上的不稳定性（$|x_{n+1}|$ 相对于 $|x_{n}|$ 的增长）在 $\\left|1-h\\,x_{n}^{2}\\right|1$ 时发生，即：\n$$\n\\left|1-h\\,x_{n}^{2}\\right|1 \\quad\\Longleftrightarrow\\quad h\\,x_{n}^{2}2.\n$$\n因此，如果 $h\\,x_{n}^{2}2$，显式 Euler 映射会放大了状态的大小，并在纯漂移情况下变得数值不稳定，尽管连续时间系统是耗散的。当存在随机项时，漂移主导条件 $h\\,|x_{n}|^{2}|\\Delta W_{n}|$ 将更新置于一个动力学行为被不稳定的纯漂移映射有效控制的区域，该步长可能表现出大的偏移，这促使人们对非 Lipschitz 系数使用驯服或稳定化格式。\n\n总之，对于给定的系数，计算出的单步 Euler-Maruyama 增量为\n$$\n\\Delta X_{n}=-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n},\n$$\n漂移主导由 $h\\,|x_{n}|^{2}|\\Delta W_{n}|$ 表示，这个条件在纯漂移情况下，可以将显式 Euler 更新置于数值不稳定的区域 $h\\,x_{n}^{2}2$。", "answer": "$$\\boxed{-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n}}$$", "id": "2999251"}, {"introduction": "在确认了问题的本质并掌握了系统的内在稳定性后，我们便可以深入研究解决方案。本练习聚焦于两种广泛应用的现代数值格式——驯服欧拉法（tamed Euler）和截断欧拉法（truncated Euler）。您将不再仅仅是应用这些方法，而是通过在一个精心设计的“边界层”渐近区域内计算它们之间的单步弱偏差，来定量地比较它们的性能。[@problem_id:2999335] 这项计算将揭示两者在控制极端漂移增长时策略上的细微差别，从而让您对高级SDE数值方法的误差结构有更深刻的理解。", "problem": "考虑标量伊藤随机微分方程 (SDE)\n$$\ndX_t \\;=\\; b(X_t)\\,dt \\;+\\; \\sigma(X_t)\\,dW_t,\\qquad b(x) \\;=\\; -x^3,\\quad \\sigma(x)\\;=\\; x,\n$$\n该方程由标准一维布朗运动 $W_t$ 驱动。为非全局 Lipschitz 系数设计的两种显式数值格式是截断 Euler–Maruyama 格式 (truncated Euler–Maruyama scheme) 和驯服欧拉格式 (tamed Euler scheme)。使用截断映射定义截断 Euler–Maruyama 格式\n$$\n\\theta_h(x)\\;=\\;\\mathrm{sign}(x)\\,\\min\\{|x|,R(h)\\},\\qquad R(h)\\;=\\;h^{-1/3},\n$$\n因此，在大小为 $h0$ 的一个时间步长内，从当前状态 $x\\in\\mathbb{R}$ 的更新由下式给出\n$$\nX^{\\mathrm{TrE}}_{n+1}\\;=\\;x \\;+\\; b\\!\\left(\\theta_h(x)\\right)\\,h \\;+\\; \\sigma\\!\\left(\\theta_h(x)\\right)\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n\\sim\\mathcal{N}(0,h)$ 并且独立于过去。驯服欧拉格式定义为\n$$\nX^{\\mathrm{TE}}_{n+1}\\;=\\;x \\;+\\; \\frac{b(x)}{1+h\\,|b(x)|}\\,h \\;+\\; \\sigma(x)\\,\\Delta W_n.\n$$\n\n固定一个常数 $\\kappa1$ 并考虑状态变量的边界层缩放\n$$\nx_h \\;=\\; \\kappa\\,R(h) \\;=\\; \\kappa\\,h^{-1/3}.\n$$\n对于此缩放，截断和驯服在主阶上都处于活动状态。将截断格式相对于驯服格式的单步条件弱偏差定义为\n$$\n\\delta(h)\\;:=\\;\\mathbb{E}\\!\\left[\\,X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1}\\,\\big|\\,X_n=x_h\\,\\right].\n$$\n仅从上述定义和伊藤增量的条件期望的基本性质出发，在小时间步长极限的精确意义下，推导由截断引起的主阶偏差\n$$\n\\lim_{h\\to 0}\\,\\delta(h).\n$$\n你的最终答案必须是仅含 $\\kappa$ 的单个封闭形式表达式。不需要数值近似。将最终结果表示为无单位的单个解析表达式。", "solution": "目标是对于给定的随机微分方程 (SDE) 和特定的状态空间缩放，计算截断 Euler–Maruyama 格式相对于驯服欧拉格式的单步条件弱偏差 $\\delta(h)$ 的小时间步长极限。偏差定义为\n$$\n\\delta(h)\\;:=\\;\\mathbb{E}\\!\\left[\\,X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1}\\,\\big|\\,X_n=x_h\\,\\right].\n$$\n首先，在应用特定缩放 $x_h$ 之前，我们写出两种格式在一般状态 $x$ 下的差值表达式。更新规则是：\n$$\nX^{\\mathrm{TrE}}_{n+1}\\;=\\;x \\;+\\; b\\!\\left(\\theta_h(x)\\right)\\,h \\;+\\; \\sigma\\!\\left(\\theta_h(x)\\right)\\,\\Delta W_n\n$$\n$$\nX^{\\mathrm{TE}}_{n+1}\\;=\\;x \\;+\\; \\frac{b(x)}{1+h\\,|b(x)|}\\,h \\;+\\; \\sigma(x)\\,\\Delta W_n\n$$\n差值为\n$$\nX^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1} \\;=\\; \\left( b(\\theta_h(x))h - \\frac{b(x)}{1+h|b(x)|}h \\right) + \\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\Delta W_n.\n$$\n现在我们取给定在时间步 $n$ 的状态为 $X_n = x$ 的条件期望。由于布朗增量 $\\Delta W_n$ 独立于截至时间 $t_n$ 的信息（因此独立于 $X_n=x$）并且均值为零，所以 $\\mathbb{E}[\\Delta W_n | X_n=x] = \\mathbb{E}[\\Delta W_n] = 0$。利用期望的线性性质，我们得到：\n$$\n\\mathbb{E}[X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1} | X_n=x] \\;=\\; \\mathbb{E}\\left[\\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h \\Bigg| X_n=x\\right] + \\mathbb{E}\\left[\\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\Delta W_n \\Bigg| X_n=x\\right]\n$$\n$$\n\\;=\\; \\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h + \\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\mathbb{E}[\\Delta W_n]\n$$\n$$\n\\;=\\; \\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h.\n$$\n现在，我们在特定状态 $x = x_h = \\kappa h^{-1/3}$ 处计算此表达式，其中 $\\kappa1$ 是一个常数。我们必须计算 $\\delta(h)$ 表达式中的每一项：\n$$\n\\delta(h) \\;=\\; \\left( b(\\theta_h(x_h)) - \\frac{b(x_h)}{1+h|b(x_h)|} \\right)h.\n$$\n各组成部分的计算如下：\n1.  缩放后的状态为 $x_h = \\kappa h^{-1/3}$。由于 $\\kappa  1$ 和 $h  0$，我们有 $x_h  0$。\n2.  截断半径为 $R(h) = h^{-1/3}$。\n3.  状态的绝对值为 $|x_h| = |\\kappa h^{-1/3}| = \\kappa h^{-1/3} = \\kappa R(h)$。\n4.  由于 $\\kappa  1$，我们有 $|x_h|  R(h)$。\n5.  截断映射 $\\theta_h(x_h)$ 定义为 $\\theta_h(x_h) = \\mathrm{sign}(x_h) \\min\\{|x_h|, R(h)\\}$。由于 $x_h  0$ 且 $|x_h|  R(h)$，这简化为 $\\theta_h(x_h) = (1) \\min\\{\\kappa R(h), R(h)\\} = R(h) = h^{-1/3}$。\n6.  漂移函数为 $b(x) = -x^3$。我们针对截断状态和原始缩放状态计算它：\n    -   $b(\\theta_h(x_h)) = b(h^{-1/3}) = -(h^{-1/3})^3 = -h^{-1}$。\n    -   $b(x_h) = b(\\kappa h^{-1/3}) = -(\\kappa h^{-1/3})^3 = -\\kappa^3 h^{-1}$。\n7.  在缩放状态下漂移的绝对值为 $|b(x_h)| = |-\\kappa^3 h^{-1}| = \\kappa^3 h^{-1}$。\n8.  驯服格式漂移项分母中的驯服因子为 $1 + h|b(x_h)| = 1 + h(\\kappa^3 h^{-1}) = 1 + \\kappa^3$。\n9.  因此，驯服格式的漂移分量为 $\\frac{b(x_h)}{1+h|b(x_h)|} = \\frac{-\\kappa^3 h^{-1}}{1+\\kappa^3}$。\n\n现在，我们将这些计算出的分量代回到 $\\delta(h)$ 的表达式中：\n$$\n\\delta(h) \\;=\\; \\left( \\left(-h^{-1}\\right) - \\left(\\frac{-\\kappa^3 h^{-1}}{1+\\kappa^3}\\right) \\right)h.\n$$\n首先简化括号内的表达式：\n$$\n-h^{-1} + \\frac{\\kappa^3 h^{-1}}{1+\\kappa^3} \\;=\\; h^{-1} \\left(-1 + \\frac{\\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-(1+\\kappa^3) + \\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-1 - \\kappa^3 + \\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-1}{1+\\kappa^3}\\right).\n$$\n将这个简化后的项代回到 $\\delta(h)$ 的表达式中：\n$$\n\\delta(h) \\;=\\; \\left( h^{-1} \\left(\\frac{-1}{1+\\kappa^3}\\right) \\right) h \\;=\\; \\frac{-1}{1+\\kappa^3}.\n$$\n$\\delta(h)$ 的表达式是一个关于时间步长 $h$ 的常数，这是由于缩放 $x_h = \\kappa h^{-1/3}$ 的特定选择创造了一个完美的平衡。\n\n最后一步是计算 $h\\to 0$ 时的极限：\n$$\n\\lim_{h\\to 0}\\,\\delta(h) \\;=\\; \\lim_{h\\to 0}\\,\\left(-\\frac{1}{1+\\kappa^3}\\right) \\;=\\; -\\frac{1}{1+\\kappa^3}.\n$$\n这就是在指定的渐近区域中，由截断相对于驯服所引起的主阶偏差。", "answer": "$$\n\\boxed{-\\frac{1}{1+\\kappa^3}}\n$$", "id": "2999335"}]}