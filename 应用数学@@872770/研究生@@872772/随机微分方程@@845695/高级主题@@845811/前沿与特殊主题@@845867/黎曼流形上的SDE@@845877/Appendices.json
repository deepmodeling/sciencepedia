{"hands_on_practices": [{"introduction": "在流形上定义随机微分方程的一种直观方法，是将环境空间中的噪声投影到流形的切空间上。本练习将引导你完成在单位球面上的这一具体过程。通过这个练习，你将看到这个几何操作如何自然地产生一个非零的伊藤漂移项，这是弯曲空间上随机微分方程的一个关键特征。[@problem_id:2995674]", "problem": "设 $M \\subset \\mathbb{R}^{n}$ 是一个光滑嵌入子流形，定义为光滑映射 $F : \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$ 的零水平集，其中 $0 \\in \\mathbb{R}^{m}$ 是一个正则值，且对于所有 $x \\in M$，$\\operatorname{rank} D F(x) = m$。使用通过可微曲线对切向量的基本刻画，将在点 $x \\in M$ 的切空间 $T_{x} M$ 构造为微分 $D F(x)$ 的核。然后，对于单位球面 $S^{n-1} = \\{ x \\in \\mathbb{R}^{n} : \\| x \\| = 1 \\}$，将其视为 $F^{-1}(0)$，其中 $F(x) = \\| x \\|^{2} - 1$，显式地验证此构造。\n\n现在考虑黎曼流形 $S^{n-1}$ 上的一个 Stratonovich 意义下的随机微分方程（SDE），该方程是通过将标准 $\\mathbb{R}^{n}$ 值布朗运动正交投影到切丛上得到的。设 $W_{t}$ 是 $\\mathbb{R}^{n}$ 中的标准布朗运动，并定义 Stratonovich SDE\n$$\nd X_{t} = P(X_{t}) \\circ d W_{t}, \\quad X_{t} \\in S^{n-1},\n$$\n其中 $P(x)$ 是 $\\mathbb{R}^{n}$ 中到 $T_{x} S^{n-1}$ 的正交投影。仅使用 $T_{x} S^{n-1}$ 作为 $D F(x)$ 的核这一刻画，以及对于状态相关的扩散系数的 Stratonovich-Itô 转换的基本性质，确定等价的 Itô 形式\n$$\nd X_{t} = b(X_{t}) \\, dt + P(X_{t}) \\, d W_{t}.\n$$\n中的显式 Itô 漂移向量场 $b(x)$。\n你的最终答案必须是 $b(x)$ 的一个单一闭式解析表达式，不带单位。不需要进行数值四舍五入。", "solution": "该问题分为两个主要部分。第一部分要求构造和验证定义为水平集的子流形的切空间。第二部分要求推导单位球面上特定 Stratonovich SDE 的 Itô 漂移。我们将依次解决这些问题。\n\n### 第一部分：切空间的刻画\n\n设 $M \\subset \\mathbb{R}^{n}$ 是一个由 $M = F^{-1}(0)$ 定义的光滑子流形，其中 $F: \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$ 是一个光滑映射，且 $0$ 是一个正则值。在点 $x \\in M$ 的切空间 $T_x M$ 是 $M$ 中所有经过 $x$ 的光滑曲线的速度向量的集合。\n\n设 $\\gamma: (-\\epsilon, \\epsilon) \\to M$ 是一条光滑曲线，使得 $\\gamma(0) = x$。一个向量 $v \\in \\mathbb{R}^{n}$ 属于 $T_x M$ 当且仅当存在这样一条曲线 $\\gamma$ 使得 $\\gamma'(0) = v$。\n由于该曲线完全位于 $M$ 内，对于 $\\gamma$ 定义域中的所有 $t$，我们有 $F(\\gamma(t)) = 0$。我们可以使用链式法则对这个表达式关于 $t$ 求导：\n$$\n\\frac{d}{dt} F(\\gamma(t)) = D F(\\gamma(t)) \\cdot \\gamma'(t) = 0\n$$\n其中 $DF$ 是 $F$ 的微分（雅可比矩阵）。在 $t=0$ 处求值，我们有 $\\gamma(0)=x$ 和 $\\gamma'(0)=v$。这得到：\n$$\nD F(x) \\cdot v = 0\n$$\n这个方程表明任何切向量 $v \\in T_x M$ 都必须属于线性映射 $D F(x): \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$ 的核。因此，我们有包含关系 $T_x M \\subseteq \\ker(D F(x))$。\n\n为证明相等，我们比较这两个向量空间的维数。由于 $0$ 是 $F$ 的一个正则值，水平集 $M = F^{-1}(0)$ 是 $\\mathbb{R}^{n}$ 的一个光滑子流形，其维数为 $\\dim(M) = n-m$。切空间 $T_x M$ 是一个具有相同维数的向量空间，因此 $\\dim(T_x M) = n-m$。\n微分 $D F(x)$ 是一个从 $\\mathbb{R}^{n}$ 到 $\\mathbb{R}^{m}$ 的线性映射。$0$ 是正则值的条件意味着对于所有 $x \\in M$，$D F(x)$ 的秩是最大的，即 $\\operatorname{rank}(D F(x)) = m$。根据秩-零度定理，$D F(x)$ 的核的维数是：\n$$\n\\dim(\\ker(D F(x))) = \\dim(\\mathbb{R}^{n}) - \\operatorname{rank}(D F(x)) = n - m\n$$\n我们已经证明 $T_x M$ 是 $\\ker(D F(x))$ 的一个子空间，并且两个空间具有相同的维数 $n-m$。这意味着这两个空间必然相等：\n$$\nT_x M = \\ker(D F(x))\n$$\n\n### 第二部分：对单位球面 $S^{n-1}$ 的验证\n\n我们现在对单位球面 $S^{n-1} = \\{ x \\in \\mathbb{R}^{n} : \\| x \\| = 1 \\}$ 验证此构造。我们可以将球面定义为函数 $F: \\mathbb{R}^{n} \\to \\mathbb{R}$（由 $F(x) = \\|x\\|^2 - 1$ 给出）的零水平集。这里，$m=1$。\n$x$ 的分量是 $(x_1, \\dots, x_n)$，且 $F(x) = \\sum_{i=1}^n x_i^2 - 1$。\n微分 $D F(x)$ 由 $F$ 的梯度表示为一个 $1 \\times n$ 矩阵（一个行向量）。其偏导数为 $\\frac{\\partial F}{\\partial x_i} = 2x_i$。因此，梯度为 $\\nabla F(x) = 2x$。微分作用于向量 $v$ 的形式为 $D F(x)(v) = \\nabla F(x) \\cdot v = 2x \\cdot v$。\n对于任何点 $x \\in S^{n-1}$，我们有 $\\|x\\|=1$，这意味着 $x \\neq 0$。因此，$\\nabla F(x) = 2x$ 是一个非零向量，$1 \\times n$ 矩阵 $D F(x)$ 的秩为 $1$。所以，$\\operatorname{rank}(D F(x)) = 1 = m$，这证实了 $0$ 是一个正则值。\n\n使用第一部分的结果，在 $x \\in S^{n-1}$ 处的切空间是：\n$$\nT_x S^{n-1} = \\ker(D F(x)) = \\{ v \\in \\mathbb{R}^{n} : D F(x)(v) = 0 \\}\n$$\n这个条件是 $2x \\cdot v = 0$，可以化简为 $x \\cdot v = 0$。\n因此，我们显式地构造了切空间为：\n$$\nT_x S^{n-1} = \\{ v \\in \\mathbb{R}^{n} : x \\cdot v = 0 \\}\n$$\n这是 $\\mathbb{R}^{n}$ 中所有与位置向量 $x$ 正交的向量的集合，这是球面在点 $x$ 处切空间的标准几何描述。\n\n### 第三部分：Itô 漂移计算\n\n给定 $S^{n-1}$ 上的 Stratonovich SDE：\n$$\nd X_{t} = P(X_{t}) \\circ d W_{t}\n$$\n其中 $P(x)$ 是到切空间 $T_x S^{n-1}$ 的正交投影。对应的 Itô SDE 是\n$$\nd X_{t} = b(X_{t}) \\, dt + P(X_{t}) \\, d W_{t}\n$$\n扩散系数是矩阵值函数 $\\sigma(x) = P(x)$。空间 $T_x S^{n-1}$ 是由法向量张成的空间的正交补。对于 $x \\in S^{n-1}$，单位法向量是 $x$ 本身。到法空间的投影由矩阵 $xx^T$ 给出。因此，到切空间的投影是 $P(x) = I - xx^T$，其中 $I$ 是 $n \\times n$ 的单位矩阵。\n所以，$\\sigma(x) = I - xx^T$。该矩阵的分量为 $\\sigma_{ij}(x) = \\delta_{ij} - x_i x_j$。\n\nItô 漂移向量场 $b(x)$ 的分量 $b^i(x)$ 由 Stratonovich-Itô 转换公式给出：\n$$\nb^i(x) = \\frac{1}{2} \\sum_{j=1}^{n} \\sum_{k=1}^{n} \\frac{\\partial \\sigma_{ik}}{\\partial x_j}(x) \\sigma_{jk}(x)\n$$\n首先，我们计算 $\\sigma_{ik}$ 的偏导数：\n$$\n\\frac{\\partial \\sigma_{ik}}{\\partial x_j} = \\frac{\\partial}{\\partial x_j}(\\delta_{ik} - x_i x_k) = - \\left( \\frac{\\partial x_i}{\\partial x_j} x_k + x_i \\frac{\\partial x_k}{\\partial x_j} \\right) = - (\\delta_{ij} x_k + x_i \\delta_{kj})\n$$\n接下来，我们将此结果和 $\\sigma_{jk}(x) = \\delta_{jk} - x_j x_k$ 代入 $b^i(x)$ 的公式中：\n$$\nb^i(x) = \\frac{1}{2} \\sum_{j,k=1}^{n} \\left( - (\\delta_{ij} x_k + x_i \\delta_{kj}) \\right) (\\delta_{kj} - x_j x_k)\n$$\n我们展开求和内的乘积：\n$$\n- (\\delta_{ij} x_k \\delta_{kj} - \\delta_{ij} x_k x_j x_k + x_i \\delta_{kj} \\delta_{kj} - x_i \\delta_{kj} x_j x_k)\n$$\n现在，我们对每一项分别关于 $j$ 和 $k$ 进行求和。\n1. 第一项: $\\sum_{j,k} (-\\delta_{ij} x_k \\delta_{kj}) = -\\sum_k (\\sum_j \\delta_{ij} \\delta_{kj}) x_k = -\\sum_k \\delta_{ik} x_k = -x_i$。\n2. 第二项: $\\sum_{j,k} (\\delta_{ij} x_k x_j x_k) = \\sum_{k} (\\sum_j \\delta_{ij} x_j) x_k^2 = \\sum_{k} x_i x_k^2 = x_i \\sum_{k} x_k^2 = x_i \\|x\\|^2$。\n3. 第三项: $\\sum_{j,k} (-x_i \\delta_{kj} \\delta_{kj}) = -x_i \\sum_j (\\sum_k \\delta_{kj} \\delta_{kj}) = -x_i \\sum_j \\delta_{jj} = -x_i \\sum_j 1 = -n x_i$。\n4. 第四项: $\\sum_{j,k} (x_i \\delta_{kj} x_j x_k) = x_i \\sum_k (\\sum_j \\delta_{kj} x_j) x_k = x_i \\sum_k x_k x_k = x_i \\sum_k x_k^2 = x_i \\|x\\|^2$。\n\n过程 $X_t$ 在 $S^{n-1}$ 上演化，因此我们对满足 $\\|x\\|^2=1$ 的 $x$ 进行求值。将四项相加得到：\n$$\n2 b^i(x) = -x_i + x_i - n x_i + x_i = (1 - n) x_i\n$$\n因此，漂移向量的第 $i$ 个分量是 $b^i(x) = \\frac{1-n}{2} x_i$。以向量形式表示，漂移场为：\n$$\nb(x) = \\frac{1-n}{2} x = -\\frac{n-1}{2} x\n$$\n这个漂移是一个径向朝内的向量场，这是抵消投影布朗运动“偏离”球面趋势所必需的，从而确保过程保持在流形上。这通常被称为 Itô 修正项或伪漂移。\n\n我们可以通过对函数 $f(x) = \\|x\\|^2$ 应用 Itô 引理来验证这个结果。为使过程 $X_t$ 保持在球面上，我们必须有 $d(\\|X_t\\|^2)=0$。\n$d(\\|X_t\\|^2) = 2X_t \\cdot dX_t + [dX, dX]_t$。更精确地说，$d f(X_t) = \\nabla f(X_t) \\cdot dX_t + \\frac{1}{2} \\operatorname{Tr}(\\nabla^2 f(X_t) (d X_t)(d X_t)^T)$。\n二次协变张量是 $(dX_t)(dX_t)^T = \\sigma(X_t) \\sigma(X_t)^T dt = P(X_t) P(X_t)^T dt$。由于 $P(x)$ 是一个对称投影矩阵，所以 $P(x)^T=P(x)$ 且 $P(x)^2=P(x)$。因此，二次协变为 $P(X_t) dt = (I-X_t X_t^T)dt$。\n$d(\\|X_t\\|^2) = 2X_t \\cdot (b(X_t)dt + P(X_t)dW_t) + \\frac{1}{2} \\operatorname{Tr}(2I \\cdot P(X_t)) dt$。\n由于 $X_t$ 与 $T_{X_t}S^{n-1}$ 中的任何向量正交，因此 $X_t \\cdot P(X_t)dW_t = 0$。\n$d(\\|X_t\\|^2) = (2X_t \\cdot b(X_t) + \\operatorname{Tr}(P(X_t))) dt$。\n$\\operatorname{Tr}(P(x)) = \\operatorname{Tr}(I - xx^T) = \\operatorname{Tr}(I) - \\operatorname{Tr}(xx^T) = n - \\|x\\|^2$。对于 $x \\in S^{n-1}$，此值为 $n-1$。\n所以，$d(\\|X_t\\|^2) = (2X_t \\cdot b(X_t) + n-1) dt$。将其设为 $0$ 要求 $2X_t \\cdot b(X_t) = -(n-1)$。\n我们计算出的漂移是 $b(x) = -\\frac{n-1}{2} x$。我们来验证一下：\n$2x \\cdot (-\\frac{n-1}{2} x) = -(n-1) (x \\cdot x) = -(n-1)\\|x\\|^2 = -(n-1)$。\n条件得到满足，证实了我们的结果。", "answer": "$$\\boxed{-\\frac{n-1}{2} x}$$", "id": "2995674"}, {"introduction": "上一个练习揭示了伊藤漂移项的存在，而本练习将深入探讨其存在的*原因*。通过对比一个朴素的伊藤SDE和一个几何上定义的Stratonovich SDE，你将理解为什么前者无法捕捉流形的曲率。你会发现，当Stratonovich表述转换为伊藤形式时，它恰好产生了使过程生成元成为拉普拉斯-贝尔特拉米算子所必需的漂移项。[@problem_id:2970362]", "problem": "设 $S^{2} \\subset \\mathbb{R}^{3}$ 为单位二维球面，赋有其标准的圆形黎曼度量。在球坐标图下，其中余纬 $\\theta \\in (0,\\pi)$，经度 $\\phi \\in (0,2\\pi)$，度量为 $g = d\\theta^{2} + \\sin^{2}(\\theta)\\, d\\phi^{2}$。考虑以下两个用于描述 $S^{2}$ 上扩散的随机模型，它们在此坐标图下表示为：\n\n1. 一个坐标图中的朴素 Itô 模型，该模型假定坐标中存在独立的、未缩放的噪声，\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t},\n$$\n其中 $W^{1}$ 和 $W^{2}$ 是相互独立的一维标准布朗运动。\n\n2. 一个由黎曼度量的局部标准正交标架 $\\{e_{1}, e_{2}\\}$ 定义的 Stratonovich 模型，其中\n$$\ne_{1} = \\partial_{\\theta}, \\qquad e_{2} = \\frac{1}{\\sin(\\theta)}\\, \\partial_{\\phi},\n$$\n以及 Stratonovich 随机微分方程（SDE）\n$$\ndX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}.\n$$\n\n使用以下基本原理：\n- 黎曼流形上的布朗运动是一种扩散，其生成元是 Laplace–Beltrami 算子的一半。\n- 在局部坐标下，Itô SDE $dY_{t} = b(Y_{t})\\, dt + \\sigma(Y_{t})\\, dW_{t}$ 的生成元是 $L f = b \\cdot \\nabla f + \\tfrac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$，其中 $a = \\sigma \\sigma^{\\top}$。\n- Stratonovich 微积分在流形上的坐标图光滑变换下是坐标不变的。\n\n任务：\n(a) 在此坐标图下，计算朴素 Itô 模型的生成元 $L_{\\text{naive}}$，并将其与 $S^{2}$ 上的 Laplace–Beltrami 算子的一半进行比较。解释为什么这个朴素 Itô 模型不具有坐标不变性。\n\n(b) 从 Stratonovich 模型 $dX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}$ 出发，将其转换为坐标图 $(\\theta,\\phi)$ 下等价的 Itô SDE，并确定必须出现的漂移向量分量 $b^{\\theta}(\\theta)$ 和 $b^{\\phi}(\\theta)$，以使得 Itô 生成元等于 Laplace–Beltrami 算子的一半。将你的最终答案表示为行矩阵 $\\pmatrix{b^{\\theta}(\\theta)  b^{\\phi}(\\theta)}$。\n\n你的最终答案必须是一个单一的闭式解析表达式。不需要四舍五入。", "solution": "该问题要求分析单位二维球面 $S^2$ 上的两个不同随机模型，及其与布朗运动几何概念的关系，该概念的特征是其生成元等于 Laplace-Beltrami 算子的一半，即 $\\frac{1}{2}\\Delta_g$。\n\n(a) 朴素 Itô 模型的分析\n\n首先，我们分析由 SDE 在球坐标图 $(\\theta, \\phi)$ 中给出的朴素 Itô 模型：\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t}\n$$\n这可以写成向量形式 $dY_t = b(Y_t) dt + \\sigma(Y_t) dW_t$，其中 $Y_t = (\\theta_t, \\phi_t)^{\\top}$。\n漂移向量为 $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n扩散矩阵为 $\\sigma = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$，即单位矩阵 $I$。\n因此矩阵 $a = \\sigma\\sigma^{\\top}$ 也是单位矩阵 $a=I$，所以其分量为 $a^{11}=1$，$a^{22}=1$，以及 $a^{12}=a^{21}=0$。\n\n该 Itô SDE 的生成元由公式 $L f = b \\cdot \\nabla f + \\frac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$ 给出。\n代入 $b$ 和 $a$ 的分量，我们得到朴素模型的生成元 $L_{\\text{naive}}$：\n$$\nL_{\\text{naive}}f = (0 \\cdot \\partial_{\\theta}f + 0 \\cdot \\partial_{\\phi}f) + \\frac{1}{2} (1 \\cdot \\partial_{\\theta}^2 f + 0 \\cdot \\partial_\\theta\\partial_\\phi f + 0 \\cdot \\partial_\\phi\\partial_\\theta f + 1 \\cdot \\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{naive}}f = \\frac{1}{2}(\\partial_{\\theta}^2 f + \\partial_{\\phi}^2 f)\n$$\n这个算子是极坐标下的标准欧几里得拉普拉斯算子，其中 $\\theta$ 和 $\\phi$ 被视为笛卡尔坐标。\n\n接下来，我们计算给定度量 $g = d\\theta^2 + \\sin^2(\\theta) d\\phi^2$ 的 Laplace-Beltrami 算子 $\\Delta_g$。度量张量及其逆矩阵为：\n$$\ng_{ij} = \\begin{pmatrix} 1  0 \\\\ 0  \\sin^2(\\theta) \\end{pmatrix}, \\qquad g^{ij} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\n行列式为 $\\det(g) = \\sin^2(\\theta)$，因此对于 $\\theta \\in (0, \\pi)$，有 $\\sqrt{\\det(g)} = \\sin(\\theta)$。\n在局部坐标下，Laplace-Beltrami 算子的通用公式是 $\\Delta_g f = \\frac{1}{\\sqrt{\\det(g)}} \\sum_{i,j} \\partial_i (\\sqrt{\\det(g)} g^{ij} \\partial_j f)$。\n对于我们的二维情况 $(x^1, x^2) = (\\theta, \\phi)$，该公式变为：\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) g^{11} \\partial_{\\theta}f) + \\partial_{\\phi}(\\sin(\\theta) g^{22} \\partial_{\\phi}f) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\cdot 1 \\cdot \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\sin(\\theta) \\cdot \\frac{1}{\\sin^2(\\theta)} \\cdot \\partial_{\\phi}f\\right) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\frac{1}{\\sin(\\theta)} \\partial_{\\phi}f\\right) \\right]\n$$\n应用乘法法则，并注意到 $\\sin(\\theta)$ 与 $\\phi$ 无关：\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\cos(\\theta)\\partial_{\\theta}f + \\sin(\\theta)\\partial_{\\theta}^2 f + \\frac{1}{\\sin(\\theta)}\\partial_{\\phi}^2 f \\right]\n$$\n$$\n\\Delta_g f = \\cot(\\theta)\\partial_{\\theta}f + \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f\n$$\n$S^2$ 上布朗运动的生成元是该算子的一半：\n$$\n\\frac{1}{2}\\Delta_g f = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n将 $L_{\\text{naive}}$ 与 $\\frac{1}{2}\\Delta_g$ 进行比较，显然它们不相等。朴素 Itô 模型没有描述球面上的布朗运动。\n\n该模型不具有坐标不变性，因为 Itô 微积分不遵循经典的链式法则。在坐标变换下，Itô SDE 的变换方式涉及变换映射的二阶导数（Itô 引理）。在一个坐标图中具有零漂移和单位扩散的 SDE，在另一个坐标图中通常不会保持这种简单形式。一个具有几何意义的扩散必须由张量变换的对象来描述。朴素模型只是将流形坐标图视为一个平坦的欧几里得空间，忽略了度量中编码的曲率，因此其本质上是依赖于坐标图的。\n\n(b) Stratonovich 模型的分析与 Itô 漂移的确定\n\n该问题提供了一个 Stratonovich 模型，并要求确定一个 Itô 漂移 $b(\\theta, \\phi) = (b^{\\theta}, b^{\\phi})$，使得所得的 Itô SDE 的生成元为 $\\frac{1}{2}\\Delta_g$。Stratonovich 模型由标准正交标架 $\\{e_1, e_2\\}$ 给出：\n$$\ne_1 = \\partial_{\\theta} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad e_2 = \\frac{1}{\\sin(\\theta)}\\partial_{\\phi} = \\begin{pmatrix} 0 \\\\ \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\n所讨论的 Itô SDE 的形式为 $dX_t = b(X_t) dt + \\sigma(X_t) dW_t$。扩散矩阵 $\\sigma$ 由 Stratonovich 模型的向量场指定，其中 $\\sigma$ 的列是在坐标基下 $e_k$ 的分量：\n$$\n\\sigma = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\n那么，Itô 生成元所需的矩阵 $a = \\sigma\\sigma^{\\top}$ 为：\n$$\na = \\sigma\\sigma^{\\top} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\sin(\\theta)} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\sin(\\theta)} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\n我们观察到 $a^{ij} = g^{ij}$，这是扩散矩阵能够表示相对于度量 $g$ 的各向同性扩散的条件。\n\n这个 Itô 过程的生成元是：\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta,\\phi)\\partial_{\\theta}f + b^{\\phi}(\\theta,\\phi)\\partial_{\\phi}f + \\frac{1}{2}(a^{\\theta\\theta}\\partial_{\\theta}^2 f + 2a^{\\theta\\phi}\\partial_{\\theta}\\partial_{\\phi}f + a^{\\phi\\phi}\\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta)\\partial_{\\theta}f + b^{\\phi}(\\theta)\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n(根据对称性，我们假设漂移分量仅依赖于 $\\theta$，这一点将通过计算得到证实)。\n\n我们将这个生成元 $L_{\\text{Itô}}$ 与布朗运动所需的生成元 $\\frac{1}{2}\\Delta_g$（在(a)部分已计算）相等：\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right) = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n两边的二阶导数项相互抵消，留下一个关于一阶项的方程：\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f = \\frac{1}{2} \\cot(\\theta)\\partial_{\\theta}f\n$$\n这个等式必须对任何任意光滑函数 $f(\\theta, \\phi)$ 成立。通过选择测试函数，我们可以确定漂移向量的分量。\n设 $f(\\theta, \\phi) = \\theta$。那么 $\\partial_{\\theta}f = 1$ 且 $\\partial_{\\phi}f = 0$。方程变为：\n$$\nb^{\\theta} \\cdot 1 + b^{\\phi} \\cdot 0 = \\frac{1}{2} \\cot(\\theta) \\cdot 1 \\implies b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)\n$$\n设 $f(\\theta, \\phi) = \\phi$。那么 $\\partial_{\\theta}f = 0$ 且 $\\partial_{\\phi}f = 1$。方程变为：\n$$\nb^{\\theta} \\cdot 0 + b^{\\phi} \\cdot 1 = \\frac{1}{2} \\cot(\\theta) \\cdot 0 \\implies b^{\\phi}(\\theta) = 0\n$$\n因此，所需的 Itô 漂移向量分量是 $b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)$ 和 $b^{\\phi}(\\theta) = 0$。这个漂移项通常被称为 Itô 修正项或流形漂移项，它源于流形的几何结构，并确保该过程是真正的布朗运动。\n最终答案以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\cot(\\theta) & 0\n\\end{pmatrix}\n}\n$$", "id": "2970362"}, {"introduction": "一个真正的几何对象不应依赖于描述它的坐标系。本练习将通过在一个坐标图（球极投影）中定义球面上的布朗运动，然后将其变换到另一个坐标图中来巩固这一原则。通过应用伊藤变换公式，你将验证新坐标图中的过程保持了相同的基础结构，从而证实几何布朗运动的坐标不变性。[@problem_id:2995637]", "problem": "考虑单位球面 $\\mathbb{S}^{2} \\subset \\mathbb{R}^{3}$ 及其标准的圆形黎曼度量。令 $\\varphi_{N} : \\mathbb{S}^{2} \\setminus \\{(0,0,1)\\} \\to \\mathbb{R}^{2}$ 和 $\\varphi_{S} : \\mathbb{S}^{2} \\setminus \\{(0,0,-1)\\} \\to \\mathbb{R}^{2}$ 分别表示从北极和南极出发的球极投影坐标卡。在重叠区域上，关联坐标 $x = \\varphi_{N}(p)$ 和 $y = \\varphi_{S}(p)$ 的转移映射 $\\Phi : \\mathbb{R}^{2} \\setminus \\{0\\} \\to \\mathbb{R}^{2} \\setminus \\{0\\}$ 由 $y = \\Phi(x) = x/|x|^{2}$ 给出。在任一坐标卡中，该圆形度量都是共形欧几里得的：在局部坐标 $u \\in \\mathbb{R}^{2}$ 中，有 $g_{ij}(u) = \\lambda(u)^{2} \\delta_{ij}$，其中共形因子为 $\\lambda(u) = \\frac{2}{1 + |u|^{2}}$。\n\n将 $\\mathbb{S}^{2}$ 上的布朗运动定义为一个扩散过程，其生成元为 $\\frac{1}{2} \\Delta_{g}$，其中 $\\Delta_{g}$ 是该圆形度量的拉普拉斯-贝尔特拉米算子。仅使用拉普拉斯-贝尔特拉米算子的基本定义以及生成元与 Itô 随机微分方程之间的关系，完成以下任务：\n\n1. 在北极坐标卡中，推导坐标过程 $X_{t} \\in \\mathbb{R}^{2}$ 的 Itô 随机微分方程，该过程在 $x$ 坐标下实现生成元 $\\frac{1}{2} \\Delta_{g}$。明确指出出现在 $dX_{t} = \\alpha(X_{t}) \\, dW_{t}$ 中的标量扩散幅值 $\\alpha(x)$。\n\n2. 在重叠区域上，通过令 $Y_{t} = \\Phi(X_{t}) = X_{t}/|X_{t}|^{2}$ 转换到南极坐标卡。使用 Itô 变量转换公式计算得到的 $Y_{t}$ 的 Itô 随机微分方程，并验证其漂移项是否为零。将扩散项表示为各向同性标量幅值 $\\beta(y)$ 与布朗增量之积。\n\n3. 给出标量扩散幅值 $\\beta(y)$ 仅用 $y$ 表示的闭式解析表达式，从而验证布朗运动在由粘合引起的坐标卡重叠区域上的一致性。\n\n你的最终答案必须是 $\\beta(y)$ 的单个闭式解析表达式。", "solution": "该问题要求在两种不同的球极投影坐标卡中推导单位球面 $\\mathbb{S}^{2}$ 上布朗运动的随机微分方程（SDE），并验证该过程在坐标卡重叠区域上的一致性。\n\n分析按要求分三步进行。\n\n**第 1 步：在北极坐标卡中推导 SDE**\n\n黎曼流形 $(M, g)$ 上的布朗运动被定义为一个扩散过程，其生成元为 $\\frac{1}{2}\\Delta_{g}$，其中 $\\Delta_{g}$ 是拉普拉斯-贝尔特拉米算子。在局部坐标 $u=(u^1, \\dots, u^n)$ 中，作用于标量函数 $f$ 的拉普拉斯-贝尔特拉米算子由下式给出\n$$ \\Delta_{g} f = \\frac{1}{\\sqrt{\\det(g)}} \\sum_{i,j=1}^{n} \\frac{\\partial}{\\partial u^i} \\left( \\sqrt{\\det(g)} g^{ij} \\frac{\\partial f}{\\partial u^j} \\right) $$\n其中 $g_{ij}$ 是度量张量的分量，$g^{ij}$ 是其逆矩阵的分量。\n\n在北极坐标卡中，坐标用 $x = (x^1, x^2)$ 表示，维数为 $n=2$。问题陈述该度量是共形欧几里得的，$g_{ij}(x) = \\lambda(x)^{2} \\delta_{ij}$，其中 $\\lambda(x) = \\frac{2}{1+|x|^2}$ 且 $\\delta_{ij}$ 是克罗内克 δ。度量张量是一个对角矩阵：\n$$ g(x) = \\begin{pmatrix} \\lambda(x)^2  0 \\\\ 0  \\lambda(x)^2 \\end{pmatrix} $$\n度量的行列式为 $\\det(g) = \\lambda(x)^4$，因此 $\\sqrt{\\det(g)} = \\lambda(x)^2$。\n逆度量张量 $g^{-1}(x)$ 的分量为 $g^{ij}(x) = \\lambda(x)^{-2} \\delta^{ij}$。\n\n将这些代入 $\\Delta_{g}$ 的公式中：\n$$ \\Delta_{g} f(x) = \\frac{1}{\\lambda(x)^2} \\sum_{i,j=1}^{2} \\frac{\\partial}{\\partial x^i} \\left( \\lambda(x)^2 \\left( \\lambda(x)^{-2} \\delta^{ij} \\right) \\frac{\\partial f}{\\partial x^j} \\right) $$\n$$ \\Delta_{g} f(x) = \\frac{1}{\\lambda(x)^2} \\sum_{i,j=1}^{2} \\frac{\\partial}{\\partial x^i} \\left( \\delta^{ij} \\frac{\\partial f}{\\partial x^j} \\right) = \\frac{1}{\\lambda(x)^2} \\sum_{i=1}^{2} \\frac{\\partial^2 f}{(\\partial x^i)^2} = \\frac{1}{\\lambda(x)^2} \\Delta_{\\mathbb{R}^2} f(x) $$\n其中 $\\Delta_{\\mathbb{R}^2}$ 是 $\\mathbb{R}^2$ 上的标准欧几里得拉普拉斯算子。\n\n该过程的生成元是 $\\mathcal{L} = \\frac{1}{2} \\Delta_{g}$。\n$$ \\mathcal{L} = \\frac{1}{2\\lambda(x)^2} \\Delta_{\\mathbb{R}^2} = \\frac{1}{2\\lambda(x)^2} \\left( \\frac{\\partial^2}{\\partial (x^1)^2} + \\frac{\\partial^2}{\\partial (x^2)^2} \\right) $$\n对于 $\\mathbb{R}^2$ 中的一个一般 Itô SDE，$dX_t = \\mu(X_t) dt + \\sigma(X_t) dW_t$，其中 $\\mu$ 是一个向量，$\\sigma$ 是一个 $2 \\times 2$ 矩阵，其生成元为\n$$ \\mathcal{L} = \\sum_{i=1}^{2} \\mu^i(x) \\frac{\\partial}{\\partial x^i} + \\frac{1}{2} \\sum_{i,j=1}^{2} (\\sigma \\sigma^T)^{ij}(x) \\frac{\\partial^2}{\\partial x^i \\partial x^j} $$\n比较 $\\mathcal{L}$ 的两个表达式，我们可以确定漂移系数和扩散系数。漂移向量 $\\mu(x)$ 为零，因为没有一阶导数项。扩散矩阵 $\\sigma(x)$ 满足：\n$$ (\\sigma \\sigma^T)(x) = \\frac{1}{\\lambda(x)^2} I $$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n问题要求一个各向同性标量扩散幅值 $\\alpha(x)$，意味着 $\\sigma(x) = \\alpha(x) I$。在这种情况下，$\\sigma(x)\\sigma(x)^T = (\\alpha(x)I)(\\alpha(x)I)^T = \\alpha(x)^2 I$。\n因此，我们必须有 $\\alpha(x)^2 = \\frac{1}{\\lambda(x)^2}$。取幅值的正根，我们得到 $\\alpha(x) = \\frac{1}{\\lambda(x)}$。\n使用给定的共形因子 $\\lambda(x) = \\frac{2}{1+|x|^2}$，我们发现\n$$ \\alpha(x) = \\frac{1+|x|^2}{2} $$\n因此，北极坐标卡中坐标过程 $X_t$ 的 SDE 为：\n$$ dX_t = \\frac{1+|X_t|^2}{2} dW_t $$\n其中 $W_t$ 是一个标准的二维布朗运动。\n\n**第 2 步：转换到南极坐标卡**\n\n南极坐标卡中的坐标过程 $Y_t$ 通过转移映射 $\\Phi$ 与 $X_t$ 相关：\n$$ Y_t = \\Phi(X_t) = \\frac{X_t}{|X_t|^2} $$\n我们使用多维 Itô 公式来求 $Y_t$ 的 SDE。对于一个向量值函数 $Y_t^k = \\Phi^k(X_t)$，其公式为：\n$$ dY_t^k = \\sum_{i=1}^2 \\frac{\\partial \\Phi^k}{\\partial x^i}(X_t) dX_t^i + \\frac{1}{2} \\sum_{i,j=1}^2 \\frac{\\partial^2 \\Phi^k}{\\partial x^i \\partial x^j}(X_t) d\\langle X^i, X^j \\rangle_t $$\n$X_t$ 的 SDE 的分量为 $dX_t^i = \\mu_X^i dt + \\sigma_X^{ij} dW_t^j$，其中 $\\mu_X = 0$ 且 $\\sigma_X^{ij}(x) = \\alpha(x)\\delta^{ij}$。\n二次协变是 $d\\langle X^i, X^j \\rangle_t = (\\sigma_X \\sigma_X^T)^{ij} dt = \\alpha(X_t)^2 \\delta^{ij} dt$。\nItô 公式变为：\n$$ dY_t^k = \\sum_{i=1}^2 \\frac{\\partial \\Phi^k}{\\partial x^i} \\alpha(X_t) dW_t^i + \\left( \\frac{1}{2} \\sum_{i=1}^2 \\frac{\\partial^2 \\Phi^k}{(\\partial x^i)^2} \\alpha(X_t)^2 \\right) dt $$\n$Y_t$ 的漂移项是 $\\mu_Y^k = \\frac{1}{2} \\alpha(X_t)^2 \\Delta_{\\mathbb{R}^2} \\Phi^k(X_t)$。为验证它是否为零，我们必须计算 $\\Phi(x) = x/|x|^2$ 各分量的拉普拉斯算子。令 $r^2 = |x|^2$。其分量为 $\\Phi^k(x) = x^k/r^2$。\n映射 $\\Phi(x)$ 是开尔文变换，已知当 $n \\ge 2$ 时，它在 $\\mathbb{R}^n \\setminus \\{0\\}$ 上是调和的，这意味着其分量的拉普拉斯算子为零。我们对 $n=2$ 的情况进行显式验证：\n$$ \\frac{\\partial \\Phi^k}{\\partial x^i} = \\frac{\\delta_{ki}}{r^2} - \\frac{2x^k x^i}{r^4} $$\n$$ \\frac{\\partial^2 \\Phi^k}{\\partial x^i \\partial x^j} = -\\frac{2x^j\\delta_{ki}}{r^4} - \\frac{2x^i\\delta_{kj}}{r^4} - \\frac{2x^k\\delta_{ij}}{r^4} + \\frac{8x^k x^i x^j}{r^6} $$\n对 $i=j$ 求和：\n$$ \\Delta_{\\mathbb{R}^2} \\Phi^k = \\sum_{i=1}^2 \\frac{\\partial^2 \\Phi^k}{(\\partial x^i)^2} = \\sum_{i=1}^2 \\left( -\\frac{2x^i\\delta_{ki}}{r^4} - \\frac{2x^i\\delta_{ki}}{r^4} - \\frac{2x^k\\delta_{ii}}{r^4} + \\frac{8x^k (x^i)^2}{r^6} \\right) $$\n$$ \\Delta_{\\mathbb{R}^2} \\Phi^k = -\\frac{4x^k}{r^4} - \\frac{2x^k(2)}{r^4} + \\frac{8x^k}{r^6} \\sum_{i=1}^2 (x^i)^2 = -\\frac{4x^k}{r^4} - \\frac{4x^k}{r^4} + \\frac{8x^k r^2}{r^6} = -\\frac{8x^k}{r^4} + \\frac{8x^k}{r^4} = 0 $$\n由于 $\\Delta_{\\mathbb{R}^2} \\Phi^k = 0$，过程 $Y_t$ 的漂移项 $\\mu_Y^k$ 为零。这验证了漂移项消失。\n\nSDE 的扩散部分是 $dY_t^{\\text{diff}} = J_\\Phi(X_t) \\sigma_X(X_t) dW_t$，其中 $J_\\Phi$ 是 $\\Phi$ 的雅可比矩阵。$Y_t$ 的扩散矩阵是 $\\sigma_Y(y) = J_\\Phi(x) \\sigma_X(x)$。我们需要找到 $\\beta(y)$ 使得 $(\\sigma_Y \\sigma_Y^T)(y) = \\beta(y)^2 I$。\n$$ \\sigma_Y \\sigma_Y^T = (J_\\Phi \\sigma_X)(J_\\Phi \\sigma_X)^T = J_\\Phi (\\sigma_X \\sigma_X^T) J_\\Phi^T = J_\\Phi (\\alpha(x)^2 I) J_\\Phi^T = \\alpha(x)^2 J_\\Phi J_\\Phi^T $$\n让我们计算矩阵乘积 $J_\\Phi J_\\Phi^T$。雅可比矩阵的分量是 $(J_\\Phi)_{ki} = \\frac{1}{r^2}(\\delta_{ki} - \\frac{2x^k x^i}{r^2})$。\n$$ (J_\\Phi J_\\Phi^T)_{km} = \\sum_{i=1}^2 (J_\\Phi)_{ki} (J_\\Phi)_{mi} = \\sum_{i=1}^2 \\frac{1}{r^4} \\left(\\delta_{ki} - \\frac{2x^k x^i}{r^2}\\right) \\left(\\delta_{mi} - \\frac{2x^m x^i}{r^2}\\right) $$\n$$ = \\frac{1}{r^4} \\left( \\sum_i \\delta_{ki}\\delta_{mi} - \\frac{2x^m x^k}{r^2} - \\frac{2x^k x^m}{r^2} + \\frac{4x^k x^m}{r^4} \\sum_i (x^i)^2 \\right) $$\n$$ = \\frac{1}{r^4} \\left( \\delta_{km} - \\frac{4x^k x^m}{r^2} + \\frac{4x^k x^m}{r^2} \\right) = \\frac{\\delta_{km}}{r^4} $$\n以矩阵形式表示，$J_\\Phi J_\\Phi^T = \\frac{1}{|x|^4} I$。\n因此，$\\sigma_Y \\sigma_Y^T = \\alpha(x)^2 \\frac{1}{|x|^4} I$。\n我们有 $\\beta(y)^2 I = \\alpha(x)^2 \\frac{1}{|x|^4} I$，这意味着 $\\beta(y) = \\frac{\\alpha(x)}{|x|^2}$（取正根）。\n\n**第 3 步：$\\beta(y)$ 的闭式表达式**\n\n我们得到了用 $x$ 坐标表示的 $\\beta$ 表达式。我们需要将其用 $y$ 坐标表示。\n关系式是 $y = x/|x|^2$。取范数，得到 $|y| = |x|/|x|^2 = 1/|x|$，这意味着 $|x| = 1/|y|$。\n我们将 $\\alpha(x) = \\frac{1+|x|^2}{2}$ 和 $|x|^2 = 1/|y|^2$ 代入 $\\beta(y)$ 的表达式中：\n$$ \\beta(y) = \\frac{\\frac{1+|x|^2}{2}}{|x|^2} = \\frac{1+|x|^2}{2|x|^2} = \\frac{1+1/|y|^2}{2(1/|y|^2)} $$\n$$ \\beta(y) = \\frac{(|y|^2+1)/|y|^2}{2/|y|^2} = \\frac{1+|y|^2}{2} $$\n南极坐标卡中的扩散幅值与北极坐标卡中的具有相同的函数形式。这表明布朗运动的定义在不同坐标卡之间是一致的。$Y_t$ 的 SDE 是 $dY_t = \\frac{1+|Y_t|^2}{2} dW'_t$，其中 $W'_t$ 是某个新的二维标准布朗运动。\n标量扩散幅值 $\\beta(y)$ 的闭式解析表达式是 $\\frac{1+|y|^2}{2}$。", "answer": "$$\n\\boxed{\\frac{1+|y|^2}{2}}\n$$", "id": "2995637"}]}