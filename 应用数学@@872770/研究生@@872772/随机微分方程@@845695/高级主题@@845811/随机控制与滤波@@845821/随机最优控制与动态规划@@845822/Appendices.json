{"hands_on_practices": [{"introduction": "本章节通过一系列精心设计的问题，旨在加深您对随机最优控制和动态规划的理解。第一个练习将引导您从基本原理出发，构建汉密尔顿-雅可比-贝尔曼（HJB）方程。通过在离散时间上应用动态规划原理，并取极限过渡到连续时间，您将亲身体验HJB方程的推导过程，这是掌握该领域核心方法的关键一步。[@problem_id:2998133]", "problem": "考虑一个有限时间域 $T0$，并固定任意的 $t \\in [0,T]$ 和 $x \\in \\mathbb{R}$。设 $\\{W_s\\}_{s \\ge 0}$ 是一个标准布朗运动，考虑受控随机微分方程 (SDE) $dX_s = a_s\\,ds + \\sigma\\,dW_s$，对于 $s \\in [t,T]$ 且满足 $X_t = x$，其中 $\\sigma0$ 是常数，控制过程 $\\{a_s\\}_{s \\in [t,T]}$ 相对于由 $\\{W_s\\}_{s \\ge 0}$ 生成的滤子是循序可测的，并且满足 $\\mathbb{E}\\big[\\int_t^T a_s^2\\,ds\\big]  \\infty$。性能准则为运行成本 $f(x,a) = \\frac{1}{2}a^2$ 和终端成本 $g \\equiv 0$，因此价值函数为\n$$\nV(t,x) \\coloneqq \\inf_{\\{a_s\\}} \\,\\mathbb{E}\\!\\left[\\int_t^T \\frac{1}{2}a_s^2\\,ds\\right].\n$$\n使用动态规划原理 (DPP)，通过将控制限制在 $[t,T]$ 的一个网格尺寸为 $\\Delta$ 的均匀划分上的分段常数函数来近似该问题，推导出离散时间动态规划递归式，并通过取极限 $\\Delta \\to 0$ 得到相关的连续时间哈密顿-雅可比-贝尔曼方程。然后求解得到的边值问题，以计算 $V(t,x)$ 作为 $t$、$x$、$\\sigma$ 和 $T$ 的函数的精确解析表达式。你可以假设标准的正则性条件，以确保随机微分方程解的存在性和唯一性，并为泰勒展开和极限与期望的交换提供依据。将你的最终答案表示为单个闭式表达式。无需四舍五入，也无需报告物理单位。", "solution": "所给问题是一个标准的有限时间域随机最优控制问题。目标是通过首先使用动态规划原理 (DPP) 推导相关的哈密顿-雅可比-贝尔曼 (HJB) 方程，然后求解得到的带有终端条件的偏微分方程 (PDE)，来确定价值函数 $V(t,x)$。\n\n**步骤 1：哈密顿-雅可比-贝尔曼方程的推导**\n\n价值函数定义为：\n$$ V(t,x) = \\inf_{\\{a_s\\}} \\mathbb{E}\\left[\\int_t^T \\frac{1}{2}a_s^2\\,ds\\right] $$\n受状态动态性 $dX_s = a_s\\,ds + \\sigma\\,dW_s$ 和 $X_t=x$ 的约束。\n\n动态规划原理指出，对于任何时间 $t \\in [0, T)$ 和一个小的增量 $\\Delta t  0$ 使得 $t+\\Delta t \\le T$，价值函数必须满足：\n$$ V(t,x) = \\inf_{\\{a_s\\}_{s \\in [t, t+\\Delta t]}} \\mathbb{E}\\left[ \\int_t^{t+\\Delta t} \\frac{1}{2}a_s^2\\,ds + V(t+\\Delta t, X_{t+\\Delta t}) \\right] $$\n我们考虑一个分段常数控制近似，其中对于 $s \\in [t, t+\\Delta t]$ 有 $a_s = a_t$。积分项变为 $\\frac{1}{2}a_t^2 \\Delta t$。在时刻 $t+\\Delta t$ 的状态由离散化的随机微分方程给出：\n$$ X_{t+\\Delta t} = x + a_t \\Delta t + \\sigma (W_{t+\\Delta t} - W_t) = x + a_t \\Delta t + \\sigma \\Delta W_t $$\n其中 $\\Delta W_t \\sim N(0, \\Delta t)$。\n\nDPP 方程可以写为：\n$$ V(t,x) \\approx \\inf_{a_t} \\left\\{ \\frac{1}{2} a_t^2 \\Delta t + \\mathbb{E}\\left[ V(t+\\Delta t, x + a_t \\Delta t + \\sigma \\Delta W_t) \\right] \\right\\} $$\n我们假设价值函数 $V(t,x)$ 属于 $C^{1,2}([0,T] \\times \\mathbb{R})$ 类。对 $V(s, X_s)$ 在区间 $[t, t+\\Delta t]$ 上应用伊藤引理得到：\n$$ dV(s,X_s) = \\left( \\frac{\\partial V}{\\partial s} + a_s \\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right) ds + \\sigma \\frac{\\partial V}{\\partial x} dW_s $$\n从 $t$ 到 $t+\\Delta t$ 积分并取期望得到：\n$$ \\mathbb{E}[V(t+\\Delta t, X_{t+\\Delta t})] - V(t,x) = \\mathbb{E}\\left[ \\int_t^{t+\\Delta t} \\left( \\frac{\\partial V}{\\partial s} + a_s \\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right) ds \\right] $$\n对于一个小的 $\\Delta t$，并将被积函数近似为在时刻 $t$ 使用控制 $a_t$ 的常数：\n$$ \\mathbb{E}[V(t+\\Delta t, X_{t+\\Delta t})] - V(t,x) \\approx \\left( \\frac{\\partial V}{\\partial t} + a_t \\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right) \\Delta t $$\n将此代入 DPP 方程：\n$$ V(t,x) \\approx \\inf_{a_t} \\left\\{ \\frac{1}{2}a_t^2 \\Delta t + V(t,x) + \\left( \\frac{\\partial V}{\\partial t} + a_t \\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right) \\Delta t \\right\\} $$\n减去 $V(t,x)$，除以 $\\Delta t  0$，并取极限 $\\Delta t \\to 0$ 得到：\n$$ 0 = \\lim_{\\Delta t \\to 0} \\inf_{a_t} \\left\\{ \\frac{1}{2}a_t^2 + \\frac{\\partial V}{\\partial t} + a_t \\frac{\\partial V}{\\partial x} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} \\right\\} $$\n不依赖于 $a_t$ 的项可以移到下确界符号的外面：\n$$ 0 = \\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} + \\inf_{a \\in \\mathbb{R}} \\left\\{ \\frac{1}{2}a^2 + a \\frac{\\partial V}{\\partial x} \\right\\} $$\n为了找到下确界，我们关于 $a$ 最小化二次函数 $f(a) = \\frac{1}{2}a^2 + a \\frac{\\partial V}{\\partial x}$。一阶条件 $\\frac{df}{da} = 0$ 给出：\n$$ a + \\frac{\\partial V}{\\partial x} = 0 \\implies a^* = -\\frac{\\partial V}{\\partial x} $$\n这是反馈形式的最优控制。将 $a^*$ 代回表达式中：\n$$ \\inf_{a \\in \\mathbb{R}} \\{ f(a) \\} = \\frac{1}{2}\\left(-\\frac{\\partial V}{\\partial x}\\right)^2 + \\left(-\\frac{\\partial V}{\\partial x}\\right)\\frac{\\partial V}{\\partial x} = \\frac{1}{2}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 - \\left(\\frac{\\partial V}{\\partial x}\\right)^2 = -\\frac{1}{2}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 $$\n将此结果代入方程中，得到哈密顿-雅可比-贝尔曼方程：\n$$ \\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} - \\frac{1}{2}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 = 0 $$\n此偏微分方程必须在终端条件 $V(T,x) = g(x)$ 下求解，其中给定 $g(x) = 0$。因此，我们有终端条件：\n$$ V(T,x) = 0 \\quad \\text{对于所有 } x \\in \\mathbb{R} $$\n\n**步骤 2：求解哈密顿-雅可比-贝尔曼方程**\n\n我们有以下终值问题：\n$$ \\frac{\\partial V}{\\partial t} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 V}{\\partial x^2} - \\frac{1}{2}\\left(\\frac{\\partial V}{\\partial x}\\right)^2 = 0, \\quad V(T,x) = 0 $$\n我们观察到运行成本 $f(x,a) = \\frac{1}{2}a^2$ 和终端成本 $g(x)=0$ 都与状态变量 $x$ 无关。这强烈暗示价值函数 $V(t,x)$ 也将与 $x$ 无关。我们做出拟设，$V(t,x)$ 仅是时间的函数，即 $V(t,x) = \\phi(t)$。\n\n根据此拟设，关于 $x$ 的偏导数为零：\n$$ \\frac{\\partial V}{\\partial x} = 0 \\quad \\text{和} \\quad \\frac{\\partial^2 V}{\\partial x^2} = 0 $$\n将这些代入 HJB 方程，将其简化为关于 $\\phi(t)$ 的常微分方程：\n$$ \\frac{d\\phi}{dt} + \\frac{1}{2}\\sigma^2(0) - \\frac{1}{2}(0)^2 = 0 \\implies \\frac{d\\phi}{dt} = 0 $$\n通解为 $\\phi(t) = C$，其中 $C$ 是一个常数。\n我们使用终端条件 $V(T,x) = 0$ 来求解 $C$。该条件转化为 $\\phi(T) = 0$。\n在 $t=T$ 处评估我们的解，得到 $\\phi(T) = C$。因此，我们必须有 $C=0$。\n\n满足终端条件的 HJB 方程的唯一经典解是 $V(t,x) = 0$。\n\n这个结果可以通过直接检查成本泛函来证实。成本为 $J(\\{a_s\\}) = \\mathbb{E}[\\int_t^T \\frac{1}{2}a_s^2 ds]$。由于 $a_s^2 \\ge 0$，成本总是不小于零，所以 $V(t,x) \\ge 0$。对于所有 $s \\in [t,T]$，控制 $a_s = 0$ 是容许的，因为 $\\mathbb{E}[\\int_t^T 0^2 ds] = 0  \\infty$。此控制的成本为 $J(\\{0\\}) = 0$。既然我们找到了一个可以实现成本为 $0$ 的容许控制，并且成本不能低于 $0$，那么下确界必定为 $0$。\n\n因此，对于所有 $(t,x) \\in [0,T] \\times \\mathbb{R}$，价值函数为 $V(t,x) = 0$。", "answer": "$$\\boxed{0}$$", "id": "2998133"}, {"introduction": "在掌握了时变HJB方程的推导后，我们将转向另一类重要的控制问题：首出时问题。在这类问题中，我们的目标是优化一个随机过程，直到它首次离开一个给定区域。这自然地引出了不依赖于时间的静态HJB方程，它是一个椭圆型偏微分方程。通过解决这个带边界条件的问题，您将学会如何处理随机控制中的边界值问题，并加深对静态最优策略的理解。[@problem_id:2998163]", "problem": "考虑开区间 $(0,1)$ 上的受控一维随机微分方程，\n$$\ndX_{t} \\;=\\; a_{t}\\,dt \\;+\\; \\sigma\\,dW_{t}, \\qquad X_{0}=x \\in (0,1),\n$$\n其中 $\\sigma0$ 是一个给定的常数，$W_{t}$ 是标准布朗运动，控制过程 $a_{t}$ 是在紧集 $A=[-1,1]$ 中取值的循序可测过程。设系统在边界处被吸收：定义退出时间\n$$\n\\tau \\;=\\; \\inf\\{t\\ge 0 \\,:\\, X_{t} \\notin (0,1)\\},\n$$\n以及吸收过程 $X_{t\\wedge\\tau}$。性能准则是一个退出时间目标，其运行成本为零，终端收益等于位置，即 $f \\equiv 0$ 和 $h(x)=x$，因此对于一个容许控制 $a=(a_{t})_{t\\ge 0}$，\n$$\nJ^{a}(x) \\;=\\; \\mathbb{E}_{x}\\!\\left[\\,h\\!\\left(X_{\\tau}\\right)\\right] \\;=\\; \\mathbb{E}_{x}\\!\\left[X_{\\tau}\\right],\n$$\n价值函数为\n$$\nV(x) \\;=\\; \\sup_{a}\\, J^{a}(x), \\qquad x\\in(0,1),\n$$\n其吸收边界条件为 $V(0)=h(0)=0$ 和 $V(1)=h(1)=1$。\n\n从退出时间问题的动态规划原理和受控扩散的无穷小生成元出发，推导 $(0,1)$ 上相关的平稳 Hamilton–Jacobi–Bellman (HJB) 方程，并在上述边界条件下显式求解。你的最终答案必须是价值函数 $V(x)$ 关于 $x$ 和 $\\sigma$ 的一个单一闭式解析表达式。", "solution": "我们从随机控制中退出时间问题的动态规划原理开始。对于一个足够光滑的候选价值函数 $V$，该原理意味着 $V$ 应该（在粘性解意义下，如果 $V\\in C^{2}((0,1))$ 则在经典意义下）满足平稳 Hamilton–Jacobi–Bellman (HJB) 方程\n$$\n0 \\;=\\; \\sup_{a\\in A} \\left\\{ \\mathcal{L}^{a} V(x) \\right\\}, \\qquad x\\in(0,1),\n$$\n并满足吸收边界条件 $V(0)=0$ 和 $V(1)=1$。这里 $\\mathcal{L}^{a}$ 是受控扩散的无穷小生成元，\n$$\n\\mathcal{L}^{a} \\phi(x) \\;=\\; a\\,\\phi'(x) \\;+\\; \\frac{\\sigma^{2}}{2}\\,\\phi''(x).\n$$\n将此代入 HJB 方程，得到二阶常微分方程（一维情况下的椭圆 HJB 方程），\n$$\n0 \\;=\\; \\sup_{a\\in[-1,1]} \\left\\{ a\\,V'(x) \\;+\\; \\frac{\\sigma^{2}}{2}\\,V''(x) \\right\\}, \\qquad x\\in(0,1),\n$$\n其中 $V(0)=0$ 且 $V(1)=1$。\n\n线性表达式 $a\\,V'(x)$ 在 $a\\in[-1,1]$ 上的上确界为\n$$\n\\sup_{a\\in[-1,1]} a\\,V'(x) \\;=\\; |V'(x)|.\n$$\n因此 HJB 方程可以写成\n$$\n\\frac{\\sigma^{2}}{2}\\,V''(x) \\;+\\; |V'(x)| \\;=\\; 0, \\qquad x\\in(0,1),\n$$\n其中 $V(0)=0$ 且 $V(1)=1$。\n\n我们将显式求解此方程。由于单调的终端收益 $h(x)=x$，可以预见最优策略会将状态向上推（朝向 $x=1$），因此很自然地去寻找一个非递减的解 $V$。假设在 $(0,1)$ 上 $V'(x)\\ge 0$。那么 $|V'(x)|=V'(x)$，HJB 方程简化为线性常微分方程\n$$\n\\frac{\\sigma^{2}}{2}\\,V''(x) \\;+\\; V'(x) \\;=\\; 0.\n$$\n令 $Y(x)=V'(x)$。则\n$$\n\\frac{\\sigma^{2}}{2}\\,Y'(x) \\;+\\; Y(x) \\;=\\; 0,\n$$\n这是一个一阶线性方程。求解该方程得到\n$$\nY'(x) \\;=\\; -\\frac{2}{\\sigma^{2}}\\,Y(x) \\quad \\Longrightarrow \\quad Y(x) \\;=\\; C\\,\\exp\\!\\left(-\\frac{2x}{\\sigma^{2}}\\right),\n$$\n其中 $C$ 是某个常数。对 $Y$ 积分得到\n$$\nV(x) \\;=\\; \\int_{0}^{x} Y(s)\\,ds \\;+\\; V(0) \\;=\\; \\int_{0}^{x} C\\,\\exp\\!\\left(-\\frac{2s}{\\sigma^{2}}\\right)\\,ds \\;+\\; 0 \\;=\\; \\frac{C\\,\\sigma^{2}}{2}\\left(1 - \\exp\\!\\left(-\\frac{2x}{\\sigma^{2}}\\right)\\right).\n$$\n代入 $x=1$ 处的边界条件，我们得到\n$$\nV(1) \\;=\\; \\frac{C\\,\\sigma^{2}}{2}\\left(1 - \\exp\\!\\left(-\\frac{2}{\\sigma^{2}}\\right)\\right) \\;=\\; 1,\n$$\n所以\n$$\nC \\;=\\; \\frac{2}{\\sigma^{2}\\left(1 - \\exp\\!\\left(-\\frac{2}{\\sigma^{2}}\\right)\\right)}.\n$$\n将 $C$ 代回 $V(x)$ 得到显式表达式\n$$\nV(x) \\;=\\; \\frac{1 - \\exp\\!\\left(-\\frac{2x}{\\sigma^{2}}\\right)}{1 - \\exp\\!\\left(-\\frac{2}{\\sigma^{2}}\\right)}, \\qquad x\\in[0,1].\n$$\n我们验证 $V(0)=0$ 和 $V(1)=1$，并且对于 $x\\in(0,1)$ 有 $V'(x)=\\dfrac{\\frac{2}{\\sigma^{2}}\\exp\\!\\left(-\\frac{2x}{\\sigma^{2}}\\right)}{1 - \\exp\\!\\left(-\\frac{2}{\\sigma^{2}}\\right)} \\ge 0$，因此我们最初的单调性假设是成立的。因此，对于所有 $x\\in(0,1)$，哈密顿量的最大化子是 $a^{*}(x)=1$。\n\n为验证最优性，对任意容许控制 $a_t$ 下的 $V(X_{t\\wedge\\tau})$ 应用 Itô 公式：\n$$\nV(X_{t\\wedge\\tau}) \\;=\\; V(x) \\;+\\; \\int_{0}^{t\\wedge\\tau} \\left(a_{s}\\,V'(X_{s}) + \\frac{\\sigma^{2}}{2}\\,V''(X_{s})\\right)ds \\;+\\; \\int_{0}^{t\\wedge\\tau} \\sigma\\,V'(X_{s})\\,dW_{s}.\n$$\n根据 HJB 方程，$\\sup_{a} \\{ a\\,V'(x) + \\frac{\\sigma^{2}}{2}V''(x) \\}=0$，因此对于任意 $a_{t}$ 我们有 $a_{t}\\,V'(X_{t}) + \\frac{\\sigma^{2}}{2}V''(X_{t}) \\le 0$，这使得 $V(X_{t\\wedge\\tau})$ 成为一个上鞅。取期望并令 $t\\to\\infty$ 可得\n$$\nV(x) \\;\\ge\\; \\mathbb{E}_{x}\\!\\left[V\\!\\left(X_{\\tau}\\right)\\right] \\;=\\; \\mathbb{E}_{x}\\!\\left[h\\!\\left(X_{\\tau}\\right)\\right] \\;=\\; J^{a}(x),\n$$\n对每一个容许控制 $a$。对于反馈控制 $a^{*}(x)=1$，该不等式变为等式，因为 $a^{*}\\,V'(x) + \\frac{\\sigma^{2}}{2}V''(x)=0$ 逐点成立，且 $V(X_{t\\wedge\\tau})$ 是一个鞅。因此 $V$ 确实是价值函数，且 $a^{*}(x)=1$ 是最优的。\n\n因此，相关的椭圆 HJB 方程的显式解为\n$$\nV(x) \\;=\\; \\frac{1 - \\exp\\!\\left(-\\frac{2x}{\\sigma^{2}}\\right)}{1 - \\exp\\!\\left(-\\frac{2}{\\sigma^{2}}\\right)}.\n$$", "answer": "$$\\boxed{\\frac{1 - \\exp\\!\\left(-\\frac{2x}{\\sigma^{2}}\\right)}{1 - \\exp\\!\\left(-\\frac{2}{\\sigma^{2}}\\right)}}$$", "id": "2998163"}, {"introduction": "最后的这个练习旨在探讨最优控制理论中一个更为深刻和微妙的概念。它将动态规划方法与另一强大的工具——庞特里亚金极大值原理（PMP）——进行对比。通过分析一个精心构造的非凸成本函数案例，您将发现极大值原理给出的必要条件可能仅识别出局部最优而非全局最优的候选解。这个练习将突显动态规划和HJB方法的优势，因为它本质上是在寻找全局最优解，从而让您对不同控制理论的适用性和局限性有更精确的认识。[@problem_id:2998136]", "problem": "考虑一个在有限时间域 $[0,1]$ 上的受控随机微分方程（此处特化为扩散系数为零的退化扩散），\n$$\n\\mathrm{d}x_t \\;=\\; u_t\\,\\mathrm{d}t,\\qquad x_0 \\;=\\; 0,\n$$\n其中容许控制满足 $u_t \\in [-1,1]$，代价泛函为\n$$\nJ(u) \\;=\\; \\phi\\!\\big(x_1\\big),\\qquad \\phi(y) \\;=\\; \\big(y^2 - 1\\big)^2.\n$$\n你将使用随机极大值原理（SMP），也称为庞特里亚金极大值原理，以及动态规划来分析此问题。终端代价 $\\phi$ 是非凸的，并且没有运行代价。\n\n任务：\n1. 从最优控制和庞特里亚金极大值原理（SMP）的基本定义出发，推导此问题的最优性必要条件，并明确指出哈密顿量和伴随（协态）动力学。\n2. 证明根据SMP必要条件，控制 $u_t \\equiv 0$ 是一个候选极值，并计算其代价 $J(u)$。\n3. 使用动态规划原理和从第一性原理出发的可达集推理，确定精确的最优值 $J^{\\star} := \\inf_{u} J(u)$ 并找出一个达到该值的控制。\n\n最后，给出次优间隙 $J(u^{\\mathrm{MP}}) - J^{\\star}$ 的精确数值，其中 $u^{\\mathrm{MP}}$ 表示任务2中找到的SMP候选控制。将最终的次优间隙表示为一个精确的实数，无需四舍五入。", "solution": "问题是为由确定性常微分方程 $\\mathrm{d}x_t = u_t\\,\\mathrm{d}t$ 控制的系统找到最优控制，初始条件为 $x_0 = 0$，时间域为 $t \\in [0, 1]$。控制 $u_t$ 被约束在集合 $[-1, 1]$ 内。目标是最小化代价泛函 $J(u) = \\phi(x_1)$，其中终端代价函数由 $\\phi(y) = (y^2 - 1)^2$ 给出。\n\n这是一个确定性最优控制问题，可以看作是随机最优控制在扩散系数为零时的特例。我们将使用庞特里亚金极大值原理（SMP）和动态规划的概念来分析此问题。\n\n**任务1：庞特里亚金极大值原理（SMP）的必要条件**\n\n庞特里亚金极大值原理为控制 $u_t^*$ 及其对应的状态轨迹 $x_t^*$ 是最优的提供了必要条件。我们引入一个伴随（或协态）变量 $p_t$。\n\n该系统的哈密顿量定义为：\n$$\nH(x, u, p) = L(x, u) + p \\cdot f(x, u)\n$$\n其中 $L$ 是运行代价， $f$ 是动力学函数。在这个问题中，运行代价为零，即 $L=0$，动力学为 $f(x, u) = u$。因此，哈密顿量是：\n$$\nH(x_t, u_t, p_t) = p_t u_t\n$$\n状态方程和伴随方程构成一个哈密顿系统。状态方程已给出：\n$$\n\\frac{\\mathrm{d}x_t}{\\mathrm{d}t} = \\frac{\\partial H}{\\partial p} = u_t, \\quad x_0 = 0\n$$\n$p_t$ 的伴随方程由下式给出：\n$$\n\\frac{\\mathrm{d}p_t}{\\mathrm{d}t} = -\\frac{\\partial H}{\\partial x} = -\\frac{\\partial}{\\partial x}(p_t u_t) = 0\n$$\n这意味着伴随变量 $p_t$ 在时间区间 $[0, 1]$ 上是常数。我们用 $p$ 表示这个常数值。\n$$\np_t = p \\quad \\forall t \\in [0, 1]\n$$\n在终端时刻 $t=1$ 的横截条件将伴随变量与终端代价函数 $\\phi$ 联系起来：\n$$\np_1 = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}(x_1)\n$$\n给定 $\\phi(y) = (y^2 - 1)^2$，其导数为 $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}y} = 2(y^2-1)(2y) = 4y(y^2-1)$。\n因此，横截条件是：\n$$\np_1 = 4x_1(x_1^2 - 1)\n$$\n由于 $p_t$ 是常数，我们有 $p = p_1 = 4x_1(x_1^2 - 1)$。\n\n最后的必要条件是庞特里亚金极大值原理本身（对于最小化问题）：对于一个最优控制 $u_t^*$，它必须在几乎所有 $t \\in [0, 1]$ 上最小化哈密顿量：\n$$\nu_t^* \\in \\arg\\min_{v \\in [-1, 1]} H(x_t^*, v, p_t) = \\arg\\min_{v \\in [-1, 1]} (p_t v)\n$$\n因此，最优控制的形式取决于常数伴随状态 $p$ 的符号：\n- 如果 $p > 0$，则 $u_t^* = -1$。\n- 如果 $p  0$，则 $u_t^* = 1$。\n- 如果 $p = 0$，则任何控制 $u_t^* \\in [-1, 1]$ 都能最小化哈密顿量，此时哈密顿量恒等于零。这是奇异情况。\n\n**任务2：候选控制 $u_t \\equiv 0$ 的分析**\n\n我们检验对于所有 $t \\in [0, 1]$，控制 $u_t \\equiv 0$ 是否满足从SMP推导出的必要条件。\n\n首先，我们确定与此控制对应的状态轨迹。对状态方程积分，初始条件为 $x_0=0$：\n$$\nx_t = x_0 + \\int_0^t u_s\\,\\mathrm{d}s = 0 + \\int_0^t 0\\,\\mathrm{d}s = 0\n$$\n所以，对于所有 $t \\in [0, 1]$，$x_t \\equiv 0$。终端状态是 $x_1 = 0$。\n\n接下来，我们使用在 $x_1=0$ 处评估的横截条件来确定相应的伴随状态 $p$：\n$$\np = p_1 = 4x_1(x_1^2 - 1) = 4(0)(0^2 - 1) = 0\n$$\n所以，与此轨迹对应的伴随状态是 $p_t \\equiv 0$。\n\n最后，我们检查控制 $u_t \\equiv 0$ 是否满足 $p_t \\equiv 0$ 时的最小化原理条件。该条件要求对于几乎每个 $t$，\n$$\nu_t \\in \\arg\\min_{v \\in [-1, 1]} (p_t v)\n$$\n代入 $p_t = 0$ 和 $u_t = 0$：\n$$\n0 \\in \\arg\\min_{v \\in [-1, 1]} (0 \\cdot v)\n$$\n需要最小化的表达式是 $0 \\cdot v = 0$，它对于所有 $v \\in [-1, 1]$ 都是常数。因此，任何控制 $v \\in [-1, 1]$ 都是一个最小化器。由于 $0 \\in [-1, 1]$，选择 $u_t \\equiv 0$ 是有效的。\n因此，控制 $u_t \\equiv 0$ 是一个满足庞特里亚金极大值原理必要条件的候选极值轨迹。\n\n与此控制相关的代价，在问题陈述中表示为 $u^{\\mathrm{MP}}$，是：\n$$\nJ(u^{\\mathrm{MP}}) = J(0) = \\phi(x_1) = \\phi(0) = (0^2 - 1)^2 = (-1)^2 = 1\n$$\n\n**任务3：通过动态规划和可达集分析得到最优值**\n\n动态规划原理意味着最优代价 $J^\\star$ 是代价泛函的最小可能值。\n$$\nJ^\\star = \\inf_{u(\\cdot)} J(u) = \\inf_{u(\\cdot)} \\phi(x_1)\n$$\n为了找到这个下确界，我们首先确定终端状态 $x_1$ 的所有可能值的集合。这被称为在时刻 $t=1$ 的可达集。\n时刻 $t=1$ 的状态由控制的积分给出：\n$$\nx_1 = \\int_0^1 u_t\\,\\mathrm{d}t\n$$\n给定约束 $u_t \\in [-1, 1]$，我们可以对该积分进行界定：\n$$\n\\int_0^1 (-1)\\,\\mathrm{d}t \\le \\int_0^1 u_t\\,\\mathrm{d}t \\le \\int_0^1 (1)\\,\\mathrm{d}t\n$$\n这给出：\n$$\n-1 \\le x_1 \\le 1\n$$\n$x_1$ 的可达集是闭区间 $[-1, 1]$。任何值 $y \\in [-1, 1]$ 都是可达的，例如通过使用常数控制 $u_t = y$，由于 $y \\in [-1, 1]$，该控制是容许的。\n\n优化问题现在简化为对一个单变量函数的简单最小化问题：\n$$\nJ^\\star = \\min_{y \\in [-1, 1]} \\phi(y) = \\min_{y \\in [-1, 1]} (y^2 - 1)^2\n$$\n函数 $\\phi(y) = (y^2 - 1)^2$ 对所有实数 $y$ 都是非负的。其值为零当且仅当 $y^2 - 1 = 0$，这发生在 $y = 1$ 和 $y = -1$ 时。\n这两个值 $1$ 和 $-1$ 都在可达集 $[-1, 1]$ 内。\n因此，$\\phi(y)$ 在此区间上的最小值为 $0$。\n$$\nJ^\\star = 0\n$$\n这个最小值是可以达到的。一个最优控制必须产生 $x_1=1$ 或 $x_1=-1$ 的终端状态。\n- 为了达到 $x_1=1$，我们可以使用常数控制 $u_t \\equiv 1$ （对于 $t \\in [0, 1]$）。这是一个容许控制，且 $x_1 = \\int_0^1 1\\,\\mathrm{d}t = 1$。代价是 $J(1) = (1^2 - 1)^2 = 0$。\n- 为了达到 $x_1=-1$，我们可以使用常数控制 $u_t \\equiv -1$ （对于 $t \\in [0, 1]$）。这给出 $x_1 = \\int_0^1 (-1)\\,\\mathrm{d}t = -1$。代价是 $J(-1) = ((-1)^2 - 1)^2 = 0$。\n\n因此，精确的最优值是 $J^\\star = 0$。代价函数 $\\phi(y)$ 的非凸性是关键：它在 $y=0$ 处有一个局部极大值，这对应于SMP找到的次优极值；而在 $y=\\pm 1$ 处有全局最小值，这对应于真正的最优解。\n\n**次优间隙计算**\n\n问题要求计算次优间隙 $J(u^{\\mathrm{MP}}) - J^\\star$，其中 $u^{\\mathrm{MP}}$ 是任务2中的SMP候选控制。\n根据任务2，候选控制是 $u^{\\mathrm{MP}}_t \\equiv 0$，其对应的代价是：\n$$\nJ(u^{\\mathrm{MP}}) = 1\n$$\n根据任务3，真正的最优值是：\n$$\nJ^\\star = 0\n$$\n次优间隙是这两个值之间的差：\n$$\nJ(u^{\\mathrm{MP}}) - J^\\star = 1 - 0 = 1\n$$\n这个间隙凸显了庞特里亚金极大值原理的必要条件并非总是全局最优的充分条件，尤其是在代价函数非凸的问题中。SMP识别出的轨迹是局部平稳的，但却是全局次优的。", "answer": "$$\\boxed{1}$$", "id": "2998136"}]}