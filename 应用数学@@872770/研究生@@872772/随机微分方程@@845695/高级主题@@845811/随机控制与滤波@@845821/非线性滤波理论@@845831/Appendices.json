{"hands_on_practices": [{"introduction": "本练习将引导您推导非线性滤波理论的基石——Kallianpur-Striebel公式。通过运用Girsanov定理进行测度变换，我们将原始的条件期望问题转化为在参考测度下的期望计算，这不仅是理论上的一个优雅技巧，更是解决实际滤波问题的关键一步 [@problem_id:2988875]。", "problem": "考虑一个在满足通常条件的赋流概率空间 $\\left(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\ge 0},\\mathbb{P}\\right)$ 上的连续时间非线性滤波模型。令 $\\{W_{t}\\}_{t \\ge 0}$ 和 $\\{V_{t}\\}_{t \\ge 0}$ 分别为维度是 $d$ 和 $m$ 的独立标准布朗运动，它们都适应于流 $\\{\\mathcal{F}_{t}\\}_{t \\ge 0}$。未观测信号 $\\{X_{t}\\}_{t \\ge 0}$ 满足随机微分方程 (SDE)\n$$\ndX_{t} \\;=\\; a\\!\\left(X_{t}\\right)\\,dt \\;+\\; \\sigma\\!\\left(X_{t}\\right)\\,dW_{t},\n$$\n其中 $X_{0}$ 独立于 $\\{V_{t}\\}_{t \\ge 0}$，且 $a:\\mathbb{R}^{d}\\to\\mathbb{R}^{d}$ 和 $\\sigma:\\mathbb{R}^{d}\\to\\mathbb{R}^{d \\times d}$ 使得该 SDE 存在唯一强解。观测过程 $\\{Y_{t}\\}_{t \\ge 0}$ 由\n$$\ndY_{t} \\;=\\; h\\!\\left(X_{t}\\right)\\,dt \\;+\\; dV_{t},\n$$\n给出，其中 $h:\\mathbb{R}^{d}\\to\\mathbb{R}^{m}$ 是有界可测函数。令 $\\mathcal{Y}_{t}:=\\sigma\\!\\left(Y_{s}:0\\le s\\le t\\right)$ 表示观测 $\\sigma$-代数。对于任意有界可测检验函数 $\\varphi:\\mathbb{R}^{d}\\to\\mathbb{R}$，定义（归一化的）条件期望\n$$\n\\pi_{t}(\\varphi)\\;:=\\;\\mathbb{E}^{\\mathbb{P}}\\!\\left[\\varphi(X_{t})\\mid \\mathcal{Y}_{t}\\right].\n$$\n\n假设 Novikov 条件成立，从而使得下方的指数局部鞅是真鞅。定义似然过程\n$$\nZ_{t}\\;:=\\;\\exp\\!\\left(\\int_{0}^{t} h\\!\\left(X_{s}\\right)^{\\top} dY_{s}\\;-\\;\\frac{1}{2}\\int_{0}^{t}\\big\\|h\\!\\left(X_{s}\\right)\\big\\|^{2}\\,ds\\right),\n$$\n以及在 $\\mathcal{F}_{t}$ 上的概率测度 $\\mathbb{Q}$，其 Radon–Nikodym 导数为\n$$\n\\frac{d\\mathbb{Q}}{d\\mathbb{P}}\\bigg|_{\\mathcal{F}_{t}} \\;=\\; Z_{t}^{-1}.\n$$\n在测度 $\\mathbb{Q}$ 下，过程 $\\{Y_{t}\\}_{t \\ge 0}$ 是一个与 $\\{W_{t}\\}_{t \\ge 0}$ 独立的 $m$ 维标准布朗运动。仅从条件期望的定义、Radon–Nikodym 定理以及 Girsanov 测度变换定理出发，推导 $\\pi_{t}(\\varphi)$ 的一个表示，该表示应使用在测度 $\\mathbb{Q}$ 下的条件期望和权重 $Z_{t}$ 来表达。\n\n然后，使用你的表示来计算 $\\pi_{t}(\\mathbf{1})$ 的精确值，其中 $\\mathbf{1}$ 表示常数函数 $\\mathbf{1}(x)\\equiv 1$。\n\n你的最终答案必须是一个不带单位的精确数值。", "solution": "该问题在非线性滤波理论和随机微积分的数学框架内是适定的且有科学依据的。我们将开始推导。\n\n我们的主要目标是在新测度 $\\mathbb{Q}$ 下，为条件期望 $\\pi_{t}(\\varphi) = \\mathbb{E}^{\\mathbb{P}}[\\varphi(X_{t}) \\mid \\mathcal{Y}_{t}]$ 推导一个表示。这个推导是测度变换技术的一个经典应用，通常被称为 Kallianpur-Striebel 公式。然后我们将使用这个表示来计算 $\\pi_{t}(\\mathbf{1})$。\n\n首先，我们推导条件期望的测度变换通用公式。令 $\\xi$ 是一个有界的 $\\mathcal{F}_{t}$-可测随机变量，$\\mathcal{G}$ 是 $\\mathcal{F}_{t}$ 的一个子 $\\sigma$-代数。根据定义，条件期望 $\\eta := \\mathbb{E}^{\\mathbb{P}}[\\xi \\mid \\mathcal{G}]$ 是满足\n$$\n\\mathbb{E}^{\\mathbb{P}}[\\eta A] = \\mathbb{E}^{\\mathbb{P}}[\\xi A]\n$$\n的唯一的（在几乎必然相等的意义下）有界 $\\mathcal{G}$-可测随机变量，对所有有界的 $\\mathcal{G}$-可测随机变量 $A$ 成立。\n\n问题通过 Radon-Nikodym 导数 $\\frac{d\\mathbb{Q}}{d\\mathbb{P}}\\big|_{\\mathcal{F}_{t}} = Z_{t}^{-1}$ 定义了一个新的概率测度 $\\mathbb{Q}$。因此，其逆关系为 $\\frac{d\\mathbb{P}}{d\\mathbb{Q}}\\big|_{\\mathcal{F}_{t}} = Z_{t}$。根据 Radon-Nikodym 定理，对于 $(\\Omega, \\mathcal{F}_t)$ 上的任意可积随机变量 $U$，其在 $\\mathbb{P}$ 和 $\\mathbb{Q}$ 下的期望关系由\n$$\n\\mathbb{E}^{\\mathbb{P}}[U] = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[U \\frac{d\\mathbb{P}}{d\\mathbb{Q}}\\right] = \\mathbb{E}^{\\mathbb{Q}}[U Z_{t}].\n$$\n给出。将此测度变换应用于条件期望的定义方程，我们得到\n$$\n\\mathbb{E}^{\\mathbb{Q}}[\\eta A Z_{t}] = \\mathbb{E}^{\\mathbb{Q}}[\\xi A Z_{t}].\n$$\n使用条件期望的塔性质，左边可以写成：\n$$\n\\mathbb{E}^{\\mathbb{Q}}[\\eta A Z_{t}] = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\mathbb{E}^{\\mathbb{Q}}[\\eta A Z_{t} \\mid \\mathcal{G}]\\right].\n$$\n由于根据定义 $\\eta$ 和 $A$ 是 $\\mathcal{G}$-可测的，因此在内层条件期望中它们可以被视为常数：\n$$\n\\mathbb{E}^{\\mathbb{Q}}[\\eta A Z_{t}] = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\eta A \\mathbb{E}^{\\mathbb{Q}}[Z_{t} \\mid \\mathcal{G}]\\right].\n$$\n类似地，对于我们主方程的右边：\n$$\n\\mathbb{E}^{\\mathbb{Q}}[\\xi A Z_{t}] = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\mathbb{E}^{\\mathbb{Q}}[\\xi A Z_{t} \\mid \\mathcal{G}]\\right] = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[A \\mathbb{E}^{\\mathbb{Q}}[\\xi Z_{t} \\mid \\mathcal{G}]\\right].\n$$\n令变换后的两边相等，我们有\n$$\n\\mathbb{E}^{\\mathbb{Q}}\\!\\left[A \\eta \\mathbb{E}^{\\mathbb{Q}}[Z_{t} \\mid \\mathcal{G}]\\right] = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[A \\mathbb{E}^{\\mathbb{Q}}[\\xi Z_{t} \\mid \\mathcal{G}]\\right].\n$$\n这个等式必须对任何有界的 $\\mathcal{G}$-可测随机变量 $A$ 成立。这意味着在期望内部与 $A$ 相乘的随机变量在测度 $\\mathbb{Q}$ 下必须几乎必然相等：\n$$\n\\eta \\mathbb{E}^{\\mathbb{Q}}[Z_{t} \\mid \\mathcal{G}] = \\mathbb{E}^{\\mathbb{Q}}[\\xi Z_{t} \\mid \\mathcal{G}].\n$$\n对 $\\eta = \\mathbb{E}^{\\mathbb{P}}[\\xi \\mid \\mathcal{G}]$ 求解，我们得到抽象贝叶斯公式：\n$$\n\\mathbb{E}^{\\mathbb{P}}[\\xi \\mid \\mathcal{G}] = \\frac{\\mathbb{E}^{\\mathbb{Q}}[\\xi Z_{t} \\mid \\mathcal{G}]}{\\mathbb{E}^{\\mathbb{Q}}[Z_{t} \\mid \\mathcal{G}]}.\n$$\n现在，我们将这个通用结果应用于具体的滤波问题。我们设 $\\xi = \\varphi(X_{t})$ 和 $\\mathcal{G} = \\mathcal{Y}_{t}$。这立即得出了我们期望的 $\\pi_{t}(\\varphi)$ 的表示，该表示用在测度 $\\mathbb{Q}$ 下的条件期望来表达：\n$$\n\\pi_{t}(\\varphi) = \\frac{\\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\varphi(X_{t}) Z_{t} \\mid \\mathcal{Y}_{t}\\right]}{\\mathbb{E}^{\\mathbb{Q}}[Z_{t} \\mid \\mathcal{Y}_{t}]}.\n$$\n这个表达式是答案的第一部分。它将后验分布表示为两个未归一化的条件分布之比。问题陈述中提供的一个关键方面是，在测度 $\\mathbb{Q}$ 下，观测过程 $\\{Y_t\\}_{t \\ge 0}$ 是一个标准的布朗运动，并且*独立*于信号过程的驱动噪声 $\\{W_t\\}_{t \\ge 0}$。由于信号 $\\{X_t\\}_{t \\ge 0}$ 是其初始条件 $X_0$ 和 $\\{W_s\\}_{0 \\le s \\le t}$ 路径的泛函，因此在测度 $\\mathbb{Q}$ 下，整个过程 $\\{X_t\\}_{t \\ge 0}$ 独立于流 $\\mathcal{Y}_t$。\n\n这个独立性属性使得条件期望可以被显著简化。对于一个依赖于过程 $X$ 和 $Y$ 路径的泛函 $F(X, Y)$，在测度 $\\mathbb{Q}$ 下给定 $\\mathcal{Y}_t$ 的条件期望可以通过对 $X$ 的路径进行积分来计算，同时将 $Y$ 的路径视为一个固定参数：\n$$\n\\mathbb{E}^{\\mathbb{Q}}[F(X,Y) \\mid \\mathcal{Y}_t] = \\mathbb{E}_{X}^{\\mathbb{Q}}[F(X,Y)].\n$$\n这里，$\\mathbb{E}_{X}^{\\mathbb{Q}}$ 表示关于过程 $X$ 在测度 $\\mathbb{Q}$ 下的分布的期望。由于 Radon-Nikodym 导数 $Z_t^{-1}$ 只涉及 $X$ 和 $V$（通过 $Y$），因此过程 $X$（由 $W$ 驱动）的分布在测度 $\\mathbb{P}$ 和 $\\mathbb{Q}$ 下是相同的。因此我们可以简单地写成 $\\mathbb{E}_X$。将此应用于我们关于 $\\pi_t(\\varphi)$ 的公式：\n分子变为 $\\mathbb{E}_{X}[\\varphi(X_{t}) Z_{t}]$，分母变为 $\\mathbb{E}_{X}[Z_{t}]$。\n这里，$Z_{t} = \\exp(\\int_{0}^{t} h(X_{s})^{\\top} dY_{s} - \\frac{1}{2}\\int_{0}^{t}\\|h(X_{s})\\|^{2}\\,ds)$ 被视为一个泛函，其中的随机积分是关于 $Y$ 的观测路径进行的，而期望则是对 $X$ 的所有路径取平均。\n\n滤波器的最终表示为：\n$$\n\\pi_{t}(\\varphi) = \\frac{\\mathbb{E}_{X}\\!\\left[\\varphi(X_t) \\exp\\!\\left(\\int_{0}^{t} h(X_{s})^{\\top} dY_{s} - \\frac{1}{2}\\int_{0}^{t}\\|h(X_{s})\\|^{2}\\,ds\\right)\\right]}{\\mathbb{E}_{X}\\!\\left[\\exp\\!\\left(\\int_{0}^{t} h(X_{s})^{\\top} dY_{s} - \\frac{1}{2}\\int_{0}^{t}\\|h(X_{s})\\|^{2}\\,ds\\right)\\right]}.\n$$\n\n现在，我们进行任务的第二部分：计算 $\\pi_{t}(\\mathbf{1})$。函数 $\\mathbf{1}$ 是一个常数函数，使得对于所有 $x \\in \\mathbb{R}^d$，都有 $\\mathbf{1}(x) = 1$。我们可以直接从 $\\pi_t(\\varphi)$ 的定义来计算它：\n$$\n\\pi_{t}(\\mathbf{1}) = \\mathbb{E}^{\\mathbb{P}}[\\mathbf{1}(X_{t}) \\mid \\mathcal{Y}_{t}] = \\mathbb{E}^{\\mathbb{P}}[1 \\mid \\mathcal{Y}_{t}].\n$$\n一个常数的条件期望就是该常数本身。因此，\n$$\n\\pi_{t}(\\mathbf{1}) = 1.\n$$\n为了使用推导出的表示来验证这个结果，我们将 $\\varphi(X_t) = \\mathbf{1}(X_t) = 1$ 代入我们的公式：\n$$\n\\pi_{t}(\\mathbf{1}) = \\frac{\\mathbb{E}_{X}[1 \\cdot Z_{t}]}{\\mathbb{E}_{X}[Z_{t}]} = \\frac{\\mathbb{E}_{X}[Z_{t}]}{\\mathbb{E}_{X}[Z_{t}]}.\n$$\n由于假设 Novikov 条件成立，指数鞅 $Z_t$ 具有良定义且为正的期望。因此，分母 $\\mathbb{E}_{X}[Z_{t}]$ 严格为正。所以，该表达式化简为 $1$。两种方法都得到相同的结果。精确值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2988875"}, {"introduction": "理论的威力在于其应用。这个练习提供了一个绝佳的机会，将前一个练习中推导的抽象公式 [@problem_id:2988875] 应用于一个具体且可解的场景：一个隐藏在噪声中的二元状态信号。通过显式计算，您将得出一个经典的滤波器形式，从而将抽象的数学概念与一个直观的解联系起来 [@problem_id:2988892]。", "problem": "考虑一个隐信号过程 $\\{X_t\\}_{t \\in [0,1]}$，其取值于有限状态空间 $\\{-1,+1\\}$，路径是分段常数，由 $X_t \\equiv X_0$ 几乎必然地指定。假设先验分布是对称的，$\\mathbb{P}(X_0=+1)=\\mathbb{P}(X_0=-1)=\\tfrac{1}{2}$。观测过程 $\\{Y_t\\}_{t \\in [0,1]}$ 是一个标量，由随机微分方程 (SDE) 控制：\n$$\n\\mathrm{d}Y_t \\;=\\; \\theta\\, X_t\\, \\mathrm{d}t \\;+\\; \\mathrm{d}W_t,\n$$\n其中 $\\theta0$ 已知，$\\{W_t\\}$ 是一个标准的维纳过程，且独立于 $X_0$。对于一个有界测试函数 $\\varphi:\\{-1,+1\\}\\to\\mathbb{R}$，定义非线性滤波器\n$$\n\\pi_t(\\varphi) \\;=\\; \\mathbb{E}\\!\\left[\\,\\varphi(X_t)\\,\\middle|\\,\\mathcal{F}_t^Y\\right],\n$$\n其中 $\\mathcal{F}_t^Y$ 是由 $\\{Y_s:0\\le s\\le t\\}$ 生成的 $\\sigma$-代数。从条件期望的基本定义出发，利用存在一个参考概率测度（在此测度下 $\\{Y_t\\}$ 是独立于 $\\{X_t\\}$ 的标准维纳过程）以及由 Doléans–Dade 指数表示的 Radon-Nikodym 似然过程，推导在 $\\varphi(x)=x$ 的特殊情况下 $\\pi_t(\\varphi)$ 作为观测路径 $\\{Y_s: 0 \\le s \\le t\\}$ 的泛函的显式闭式表达式。\n\n然后，对于终端值满足 $Y_1=\\frac{1}{2\\theta}\\ln 3$ 的观测，计算你的表达式在时间 $t=1$ 时的值。将最终答案表示为单个实数。无需单位，也无需四舍五入。", "solution": "这个问题是适定的，并且代表了非线性滤波理论中的一个典型例子。我们将着手解决它。目标是推导非线性滤波器 $\\pi_t(\\varphi) = \\mathbb{E}[\\varphi(X_t) \\mid \\mathcal{F}_t^Y]$ 在特殊情况 $\\varphi(x)=x$ 下的显式表达式，然后在一个特定条件下对其求值。\n\n设基础概率空间为 $(\\Omega, \\mathcal{F}, \\mathbb{P})$。观测过程由以下 SDE 给出：\n$$\n\\mathrm{d}Y_t = \\theta X_t \\mathrm{d}t + \\mathrm{d}W_t, \\quad Y_0 = 0\n$$\n其中 $\\{W_t\\}$ 是在 $\\mathbb{P}$ 下的标准维纳过程，且独立于 $X_0$。\n\n解法的核心在于概率测度变换技术。我们定义一个新的参考测度 $\\mathbb{P}_0$，在此测度下，观测过程 $\\{Y_t\\}$ 表现为一个标准维纳过程。根据 Girsanov 定理，我们可以通过其在滤子 $\\mathcal{F}_t = \\sigma(X_0) \\vee \\mathcal{F}_t^W$（其中 $\\mathcal{F}_t^W$ 是由 $\\{W_s: 0 \\le s \\le t\\}$ 生成的滤子）上相对于 $\\mathbb{P}$ 的 Radon-Nikodym 导数来定义这样一个测度 $\\mathbb{P}_0$。让我们定义过程 $Z_t$ 使得 $\\mathrm{d}Y_t = Z_t \\mathrm{d}t + \\mathrm{d}W_t$。这里，$Z_t = \\theta X_t$。Novikov 条件 $\\mathbb{E}[\\exp(\\frac{1}{2}\\int_0^t Z_s^2 \\mathrm{d}s)]  \\infty$ 是满足的，因为 $X_s^2 = 1$，所以 $\\int_0^t Z_s^2 \\mathrm{d}s = \\theta^2 t$，这是确定性的且有限的。\n\n我们将似然过程（或 Radon-Nikodym 密度过程）$L_t$ 定义为 Doléans-Dade 指数：\n$$\nL_t = \\frac{\\mathrm{d}\\mathbb{P}}{\\mathrm{d}\\mathbb{P}_0}\\bigg|_{\\mathcal{F}_t^Y} = \\exp\\left( \\int_0^t \\theta X_s \\mathrm{d}Y_s - \\frac{1}{2} \\int_0^t (\\theta X_s)^2 \\mathrm{d}s \\right)\n$$\n其中，在新测度 $\\mathbb{P}_0$ 下，过程 $\\{Y_t\\}$ 是一个独立于 $\\{X_t\\}$ 的标准维纳过程。积分 $\\int_0^t \\theta X_s \\mathrm{d}Y_s$ 是关于 $\\{Y_t\\}$ 的 Itô 积分，$\\{Y_t\\}$ 在 $\\mathbb{P}$ 下是一个半鞅，但在 $\\mathbb{P}_0$ 下是一个维纳过程。\n\n问题陈述 $X_t \\equiv X_0$ 在 $t \\in [0,1]$ 上几乎必然成立。这简化了指数项：\n$$\n\\int_0^t \\theta X_s \\mathrm{d}Y_s = \\theta X_0 \\int_0^t \\mathrm{d}Y_s = \\theta X_0 Y_t\n$$\n$$\n\\int_0^t (\\theta X_s)^2 \\mathrm{d}s = \\int_0^t \\theta^2 \\mathrm{d}s = \\theta^2 t\n$$\n因此，似然过程变为：\n$$\nL_t = \\exp\\left( \\theta X_0 Y_t - \\frac{1}{2}\\theta^2 t \\right)\n$$\n\n非线性滤波的基本公式，通常称为 Kallianpur-Striebel 公式，将 $\\mathbb{P}$ 下的条件期望与参考测度 $\\mathbb{P}_0$ 下的期望联系起来。对于任意有界测试函数 $\\varphi$，\n$$\n\\pi_t(\\varphi) = \\mathbb{E}[\\varphi(X_t) \\mid \\mathcal{F}_t^Y] = \\frac{\\mathbb{E}_0[\\varphi(X_t) L_t \\mid \\mathcal{F}_t^Y]}{\\mathbb{E}_0[L_t \\mid \\mathcal{F}_t^Y]}\n$$\n由于在 $\\mathbb{P}_0$ 下 $X_t = X_0$ 且 $\\{Y_t\\}$ 独立于 $X_0$，并且 $Y_t$ 是 $\\mathcal{F}_t^Y$-可测的，我们可以简化分子和分母。$L_t$ 项显式地依赖于 $X_0$ 和 $Y_t$。\n分子是：\n$$\n\\mathbb{E}_0[\\varphi(X_0) L_t \\mid \\mathcal{F}_t^Y] = \\mathbb{E}_0\\left[\\varphi(X_0) \\exp\\left( \\theta X_0 Y_t - \\frac{1}{2}\\theta^2 t \\right) \\mid \\mathcal{F}_t^Y\\right]\n$$\n由于在 $\\mathbb{P}_0$ 下 $X_0$ 独立于 $\\mathcal{F}_t^Y$，我们可以只对 $X_0$ 求期望：\n$$\n\\mathbb{E}_0[\\varphi(X_0) L_t \\mid \\mathcal{F}_t^Y] = \\mathbb{E}_0\\left[\\varphi(X_0) \\exp\\left( \\theta X_0 Y_t - \\frac{1}{2}\\theta^2 t \\right)\\right]\n$$\n这个期望是关于 $X_0$ 的分布的，该分布在 $\\mathbb{P}$ 和 $\\mathbb{P}_0$ 下是相同的。项 $\\exp(-\\frac{1}{2}\\theta^2 t)$ 对于随机变量 $X_0$ 是一个常数。\n让我们定义未归一化滤波器 $\\sigma_t(\\varphi) = \\mathbb{E}_0[\\varphi(X_0) L_t]$。那么：\n$$\n\\pi_t(\\varphi) = \\frac{\\sigma_t(\\varphi)}{\\sigma_t(1)}\n$$\n其中 $\\sigma_t(1)$ 对应于 $\\varphi(x)=1$ 的情况。\n\n我们现在使用给定的先验分布 $\\mathbb{P}(X_0=+1) = \\mathbb{P}(X_0=-1) = \\frac{1}{2}$ 来计算 $\\sigma_t(\\varphi)$。\n$$\n\\sigma_t(\\varphi) = \\sum_{k \\in \\{-1, +1\\}} \\varphi(k) \\exp\\left( \\theta k Y_t - \\frac{1}{2}\\theta^2 t \\right) \\mathbb{P}(X_0=k)\n$$\n$$\n\\sigma_t(\\varphi) = \\frac{1}{2}\\exp\\left(-\\frac{1}{2}\\theta^2 t\\right) \\left[ \\varphi(1) \\exp(\\theta Y_t) + \\varphi(-1) \\exp(-\\theta Y_t) \\right]\n$$\n对于特殊情况 $\\varphi(x)=x$，我们有 $\\varphi(1)=1$ 和 $\\varphi(-1)=-1$。\n$$\n\\sigma_t(x) = \\frac{1}{2}\\exp\\left(-\\frac{1}{2}\\theta^2 t\\right) \\left[ \\exp(\\theta Y_t) - \\exp(-\\theta Y_t) \\right]\n$$\n对于分母，我们设 $\\varphi(x)=1$，这给出 $\\varphi(1)=1$ 和 $\\varphi(-1)=1$。\n$$\n\\sigma_t(1) = \\frac{1}{2}\\exp\\left(-\\frac{1}{2}\\theta^2 t\\right) \\left[ \\exp(\\theta Y_t) + \\exp(-\\theta Y_t) \\right]\n$$\n取其比值得到所需的滤波器表达式：\n$$\n\\pi_t(x) = \\frac{\\sigma_t(x)}{\\sigma_t(1)} = \\frac{\\frac{1}{2}\\exp(-\\frac{1}{2}\\theta^2 t) [ \\exp(\\theta Y_t) - \\exp(-\\theta Y_t) ]}{\\frac{1}{2}\\exp(-\\frac{1}{2}\\theta^2 t) [ \\exp(\\theta Y_t) + \\exp(-\\theta Y_t) ]} = \\frac{\\exp(\\theta Y_t) - \\exp(-\\theta Y_t)}{\\exp(\\theta Y_t) + \\exp(-\\theta Y_t)}\n$$\n这个表达式是双曲正切函数的定义。因此，滤波器的显式闭式表达式为：\n$$\n\\pi_t(x) = \\tanh(\\theta Y_t)\n$$\n这是在给定直到时间 $t$ 的观测历史的情况下 $X_t$ 的条件期望，即 $\\mathbb{E}[X_t \\mid \\mathcal{F}_t^Y]$。\n\n现在，我们必须为终端值为 $Y_1 = \\frac{1}{2\\theta}\\ln 3$ 的特定观测路径，在时间 $t=1$ 处计算这个表达式的值。\n我们需要计算 $\\pi_1(x) = \\tanh(\\theta Y_1)$。\n代入给定的 $Y_1$ 值：\n$$\n\\pi_1(x) = \\tanh\\left(\\theta \\cdot \\frac{1}{2\\theta}\\ln 3\\right) = \\tanh\\left(\\frac{1}{2}\\ln 3\\right)\n$$\n我们可以简化这个表达式。首先，使用性质 $a\\ln b = \\ln(b^a)$:\n$$\n\\frac{1}{2}\\ln 3 = \\ln(3^{1/2}) = \\ln(\\sqrt{3})\n$$\n所以，我们需要计算 $\\tanh(\\ln(\\sqrt{3}))$。使用定义 $\\tanh(z) = \\frac{\\exp(z)-\\exp(-z)}{\\exp(z)+\\exp(-z)}$：\n$$\n\\tanh(\\ln(\\sqrt{3})) = \\frac{\\exp(\\ln(\\sqrt{3})) - \\exp(-\\ln(\\sqrt{3}))}{\\exp(\\ln(\\sqrt{3})) + \\exp(-\\ln(\\sqrt{3}))}\n$$\n由于 $\\exp(\\ln a) = a$ 且 $\\exp(-\\ln a) = \\exp(\\ln(1/a)) = 1/a$：\n$$\n\\tanh(\\ln(\\sqrt{3})) = \\frac{\\sqrt{3} - \\frac{1}{\\sqrt{3}}}{\\sqrt{3} + \\frac{1}{\\sqrt{3}}}\n$$\n为了简化分数，我们将分子和分母同乘以 $\\sqrt{3}$：\n$$\n\\tanh(\\ln(\\sqrt{3})) = \\frac{\\sqrt{3}\\left(\\sqrt{3} - \\frac{1}{\\sqrt{3}}\\right)}{\\sqrt{3}\\left(\\sqrt{3} + \\frac{1}{\\sqrt{3}}\\right)} = \\frac{(\\sqrt{3})^2 - 1}{(\\sqrt{3})^2 + 1} = \\frac{3-1}{3+1} = \\frac{2}{4} = \\frac{1}{2}\n$$\n滤波器在 $t=1$ 时的值为 $\\frac{1}{2}$。这意味着，在给定观测路径终点为 $Y_1 = \\frac{1}{2\\theta}\\ln 3$ 的情况下，$X_1$ 为 $+1$ 的条件概率是 $\\mathbb{P}(X_1=+1 \\mid \\mathcal{F}_1^Y) = \\frac{1+\\pi_1(x)}{2} = \\frac{1+1/2}{2} = \\frac{3}{4}$，而其为 $-1$ 的概率是 $\\frac{1}{4}$。条件期望为 $(+1)\\frac{3}{4} + (-1)\\frac{1}{4} = \\frac{2}{4} = \\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2988892"}, {"introduction": "一个成功的滤波器依赖于有信息量的观测。本练习通过一个精心设计的思想实验，挑战了这一基本前提，探索了“可观测性”失效的情形。您将证明，当观测过程的统计规律不依赖于隐藏状态时，即使有无限多的数据，我们也无法更新关于隐藏状态的先验信念，从而深刻理解滤波理论的适用边界 [@problem_id:2988870]。", "problem": "考虑以下隐式静态参数滤波模型，该模型建立在一个完备概率空间上，其滤子由观测过程生成。设隐藏状态为一个随机变量 $X \\in \\{-1,1\\}$，其先验概率为 $\\mathbb{P}(X=1)=\\mathbb{P}(X=-1)=\\tfrac{1}{2}$，且独立于一个标准一维布朗运动 $W=\\{W_t\\}_{t \\ge 0}$。观测过程 $Y=\\{Y_t\\}_{t \\ge 0}$ 满足随机微分方程\n$$\ndY_t \\;=\\; X\\, dW_t, \\qquad Y_0 = 0,\n$$\n观测滤子为 $\\mathcal{Y}_t := \\sigma\\{Y_s: 0 \\le s \\le t\\}^{\\mathbb{P}\\text{-completion}}$。定义后验过程（滤波器）为\n$$\n\\pi_t \\;:=\\; \\mathbb{P}\\big(X=1 \\,\\big|\\, \\mathcal{Y}_t\\big).\n$$\n\n从随机过程和测度论的第一性原理（布朗运动的不变性、作为 $L^1$-投影的条件期望，以及通过路径空间上的拉东-尼科迪姆导数得到的贝叶斯法则）出发，完成以下任务：\n\n1. 严格证明该模型是不可观测的，即在条件 $X=1$ 和 $X=-1$ 下，观测过程的路径空间分布一致，也就是说，\n$$\n\\mathcal{L}\\big((Y_s)_{0 \\le s \\le t} \\,\\big|\\, X=1\\big) \\;=\\; \\mathcal{L}\\big((Y_s)_{0 \\le s \\le t} \\,\\big|\\, X=-1\\big) \\quad \\text{对所有 } t \\ge 0.\n$$\n\n2. 基于上述结论，将后验过程 $\\pi_t$ 显式计算为 $t$ 和观测 $\\mathcal{Y}_t$ 的函数。\n\n3. 计算极限 $\\lim_{t \\to \\infty} \\pi_t$，并解释后验概率在何种精确意义上，即使当 $t \\to \\infty$ 时也未能收敛到真实状态。\n\n你的最终数值答案必须是极限 $\\lim_{t \\to \\infty} \\pi_t$ 的精确值，以单一闭合形式的数字表示。不要四舍五入。", "solution": "该问题在随机微分方程和非线性滤波理论的框架内是适定的，且具有科学依据。我们将按顺序解决问题的每个部分。\n\n### 第1部分：不可观测性的证明\n\n问题要求通过证明在隐藏状态 $X$ 的两种可能取值下，观测过程 $Y$ 的路径空间分布是相同的，来论证该模型是不可观测的。设 $\\mathcal{L}(Z)$ 表示随机过程 $Z$ 的分布。我们需要证明对于任意 $t \\ge 0$：\n$$\n\\mathcal{L}\\big((Y_s)_{0 \\le s \\le t} \\,\\big|\\, X=1\\big) \\;=\\; \\mathcal{L}\\big((Y_s)_{0 \\le s \\le t} \\,\\big|\\, X=-1\\big).\n$$\n这等价于证明在 $t \\in [0, \\infty)$ 上的整个过程的分布是相同的，即 $\\mathcal{L}(Y \\,|\\, X=1) = \\mathcal{L}(Y \\,|\\, X=-1)$。\n\n让我们在每种条件下分析随机过程 $Y$。\n观测过程 $Y$ 由随机微分方程（SDE）定义：\n$$\ndY_t = X \\, dW_t, \\qquad Y_0 = 0.\n$$\n该随机微分方程的解由伊藤积分给出：$Y_t = \\int_0^t X \\, dW_s$。由于 $X$ 是一个不随时间变化的随机变量（静态参数）且独立于布朗运动 $W$，我们可以将其写为：\n$$\nY_t = X \\int_0^t dW_s = X W_t.\n$$\n\n**情况1：以 $X=1$ 为条件。**\n如果我们以事件 $\\{X=1\\}$ 为条件，观测过程由下式给出：\n$$\nY_t = (1) \\cdot W_t = W_t.\n$$\n因此，在 $\\{X=1\\}$ 的条件下，观测过程 $Y$ 本身是一个标准一维布朗运动。过程 $Y$ 的分布是定义在从0开始的连续函数空间上的标准维纳测度。\n\n**情况2：以 $X=-1$ 为条件。**\n如果我们以事件 $\\{X=-1\\}$ 为条件，观测过程由下式给出：\n$$\nY_t = (-1) \\cdot W_t = -W_t.\n$$\n我们定义一个新过程 $Z_t = -W_t$。我们必须验证 $Z$ 也是一个标准布朗运动。一个连续时间随机过程 $\\{Z_t\\}_{t \\ge 0}$ 是标准布朗运动，如果它满足：\n1.  $Z_0 = 0$。\n2.  该过程具有独立增量。\n3.  对于任意 $s  t$，增量 $Z_t - Z_s$ 服从均值为 $0$、方差为 $t-s$ 的正态分布。\n4.  样本路径 $t \\mapsto Z_t$ 几乎必然连续。\n\n让我们检查 $Z_t = -W_t$ 是否满足这些性质：\n1.  $Z_0 = -W_0 = 0$，因为 $W_0=0$。\n2.  对于任意时间序列 $0 \\le t_1  t_2  \\dots  t_n$，$Z$ 的增量为 $Z_{t_{i+1}} - Z_{t_i} = -W_{t_{i+1}} - (-W_{t_i}) = -(W_{t_{i+1}} - W_{t_i})$。由于 $W$ 的增量是独立的，所以 $Z$ 的增量也是独立的。\n3.  增量 $Z_t - Z_s = -(W_t - W_s)$。由于 $W_t - W_s \\sim \\mathcal{N}(0, t-s)$，其相反数 $-(W_t - W_s)$ 也服从正态分布，其均值为 $\\mathbb{E}[-(W_t - W_s)] = -\\mathbb{E}[W_t - W_s] = 0$，方差为 $\\mathrm{Var}[-(W_t - W_s)] = (-1)^2 \\mathrm{Var}[W_t - W_s] = t-s$。所以，$Z_t - Z_s \\sim \\mathcal{N}(0, t-s)$。\n4.  由于 $W$ 的样本路径几乎必然连续，所以 $Z=-W$ 的路径也几乎必然连续。\n\n因此，过程 $Z_t = -W_t$ 是一个标准一维布朗运动。这是布朗运动的一个基本对称性质。\n\n**结论：**\n在 $\\{X=1\\}$ 条件下，过程 $Y$ 的分布是标准布朗运动的分布，$\\mathcal{L}(W)$。在 $\\{X=-1\\}$ 条件下，过程 $Y$ 的分布是过程 $-W$ 的分布，而 $-W$ 也是一个标准布朗运动，因此其分布也是 $\\mathcal{L}(W)$。\n因此，我们严格地证明了：\n$$\n\\mathcal{L}(Y \\,|\\, X=1) \\;=\\; \\mathcal{L}(Y \\,|\\, X=-1).\n$$\n这意味着对于任何时间范围 $t \\ge 0$，路径片段 $(Y_s)_{0 \\le s \\le t}$ 的分布也是相同的，从而证明了系统的不可观测性。观测数据 $(Y_s)_{0 \\le s \\le t}$ 没有提供任何统计信息来区分 $X$ 的两种可能状态。\n\n### 第2部分：后验过程 $\\pi_t$ 的计算\n\n后验过程（或滤波器）定义为 $\\pi_t := \\mathbb{P}(X=1 \\,|\\, \\mathcal{Y}_t)$。这是指示函数 $\\mathbb{1}_{\\{X=1\\}}$ 关于观测滤子 $\\mathcal{Y}_t$ 的条件期望。我们可以使用抽象贝叶斯法则来计算它。\n\n设 $\\mathbf{P}_1$ 和 $\\mathbf{P}_{-1}$ 是在条件 $X=1$ 和 $X=-1$ 下，在 $Y$ 的路径空间上导出的概率测度。从第1部分可知，$\\mathbf{P}_1 = \\mathbf{P}_{-1}$。我们将这个公共测度记为 $\\mathbf{W}$，即维纳测度。\n\n滤波器 $\\pi_t$ 可以用先验概率和截至时间 $t$ 的观测的似然来表示。设先验概率为 $\\pi_0 = \\mathbb{P}(X=1) = \\frac{1}{2}$。对于任何事件 $A \\in \\mathcal{Y}_t$，根据条件概率的定义：\n$$\n\\mathbb{P}(\\{X=1\\} \\cap A) = \\int_A \\pi_t \\, d\\mathbb{P}.\n$$\n我们可以用条件测度来表示左右两边的概率。\n$$\n\\mathbb{P}(\\{X=1\\} \\cap A) = \\mathbb{P}(A | X=1) \\mathbb{P}(X=1) = \\frac{1}{2} \\mathbf{P}_1(A')\n$$\n其中 $A'$ 是路径空间中对应于事件 $A \\in \\mathcal{Y}_t$ 的路径集合。\n事件 A 的全概率是：\n$$\n\\mathbb{P}(A) = \\mathbb{P}(A|X=1)\\mathbb{P}(X=1) + \\mathbb{P}(A|X=-1)\\mathbb{P}(X=-1)\n$$\n$$\n\\mathbb{P}(A) = \\frac{1}{2}\\mathbf{P}_1(A') + \\frac{1}{2}\\mathbf{P}_{-1}(A').\n$$\n使用第1部分的结论 $\\mathbf{P}_1 = \\mathbf{P}_{-1} = \\mathbf{W}$，我们有：\n$$\n\\mathbb{P}(A) = \\frac{1}{2}\\mathbf{W}(A') + \\frac{1}{2}\\mathbf{W}(A') = \\mathbf{W}(A').\n$$\n对于联合事件：\n$$\n\\mathbb{P}(\\{X=1\\} \\cap A) = \\frac{1}{2}\\mathbf{P}_1(A') = \\frac{1}{2}\\mathbf{W}(A').\n$$\n将这些代入条件期望的积分定义中：\n$$\n\\int_A \\pi_t \\, d\\mathbb{P} = \\frac{1}{2}\\mathbf{W}(A').\n$$\n同时，我们有 $\\int_A \\frac{1}{2} d\\mathbb{P} = \\frac{1}{2}\\mathbb{P}(A) = \\frac{1}{2}\\mathbf{W}(A')$。\n因此，对于任何 $A \\in \\mathcal{Y}_t$，我们已经证明了：\n$$\n\\int_A \\pi_t \\, d\\mathbb{P} = \\int_A \\frac{1}{2} \\, d\\mathbb{P}.\n$$\n根据条件期望的唯一性（在几乎必然相等的意义上），我们必有：\n$$\n\\pi_t = \\frac{1}{2} \\quad \\text{对所有 } t \\ge 0 \\text{ 几乎必然成立}.\n$$\n后验概率在所有时间内都等于先验概率。观测没有产生任何新信息来更新我们对 $X$ 状态的信念。\n\n另一种方法是，使用路径空间上的拉东-尼科迪姆导数的概念。设观测过程的总分布为 $\\mathbf{P}_Y$。则 $\\mathbf{P}_Y = \\pi_0 \\mathbf{P}_1 + (1-\\pi_0) \\mathbf{P}_{-1}$。由于 $\\mathbf{P}_1 = \\mathbf{P}_{-1} = \\mathbf{W}$ 且 $\\pi_0 = 1/2$，我们得到 $\\mathbf{P}_Y = \\frac{1}{2}\\mathbf{W} + \\frac{1}{2}\\mathbf{W} = \\mathbf{W}$。条件测度相对于参考测度 $\\mathbf{P}_Y$ 的拉东-尼科迪姆导数是：\n$$\nL_1 = \\frac{d\\mathbf{P}_1}{d\\mathbf{P}_Y} = \\frac{d\\mathbf{W}}{d\\mathbf{W}} = 1.\n$$\n$$\nL_{-1} = \\frac{d\\mathbf{P}_{-1}}{d\\mathbf{P}_Y} = \\frac{d\\mathbf{W}}{d\\mathbf{W}} = 1.\n$$\nKallianpur-Striebel 公式给出滤波器为：\n$$\n\\pi_t = \\frac{\\pi_0 L_1}{\\pi_0 L_1 + (1-\\pi_0) L_{-1}}.\n$$\n代入数值：\n$$\n\\pi_t = \\frac{\\frac{1}{2} \\cdot 1}{\\frac{1}{2} \\cdot 1 + (1-\\frac{1}{2}) \\cdot 1} = \\frac{\\frac{1}{2}}{\\frac{1}{2} + \\frac{1}{2}} = \\frac{1}{2}.\n$$\n这证实了后验过程是恒定的，且等于其初始值。\n\n### 第3部分：$t \\to \\infty$ 时的极限与收敛失效\n\n从第2部分可知，后验过程为 $\\pi_t = \\frac{1}{2}$（对所有 $t \\ge 0$）。因此极限是平凡的：\n$$\n\\lim_{t \\to \\infty} \\pi_t = \\lim_{t \\to \\infty} \\frac{1}{2} = \\frac{1}{2}.\n$$\n问题要求解释后验概率为何未能收敛到真实状态。“真实状态”是随机变量 $X$ 的实现值，即 $1$ 或 $-1$。\n- 如果真实状态是 $X=1$，那么收敛到真实状态意味着当 $t \\to \\infty$ 时，$\\pi_t = \\mathbb{P}(X=1|\\mathcal{Y}_t) \\to 1$。\n- 如果真实状态是 $X=-1$，那么收敛到真实状态意味着当 $t \\to \\infty$ 时，$\\pi_t = \\mathbb{P}(X=1|\\mathcal{Y}_t) \\to 0$。\n\n在这个问题中，无论 $X$ 的真实值是多少，$\\pi_t$ 都收敛到 $\\frac{1}{2}$。这表示滤波过程在学习隐式静态参数方面完全失败。关于 $\\{X=1, X=-1\\}$ 的后验概率分布永远保持为 $(\\frac{1}{2}, \\frac{1}{2})$，与先验分布完全相同。\n\n这种失败的根本原因在于第一部分中建立的不可观测性。路径空间测度 $\\mathbf{P}_1$ 和 $\\mathbf{P}_{-1}$ 不仅仅是等价的（相互绝对连续），而且是完全相同的。在典型的发生学习的滤波问题中，这些测度是等价的但并非相同。Girsanov 定理提供了一个随时间演化的非平凡的拉东-尼科迪姆导数（似然比）。随着观测到更多数据，这个似然比会趋向于0或$\\infty$，从而迫使后验概率收敛到0或1。\n\n在这个特定模型中，似然比在所有时间内恒等于1。这表明在两种假设（$X=1$ 和 $X=-1$）下，观测在统计上是无法区分的。因此，任何数量的观测数据都无助于辨别真实状态，后验信念永远不会从先验信念更新。关于 $X$ 的不确定性在整个过程中保持最大。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2988870"}]}