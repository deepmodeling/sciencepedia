{"hands_on_practices": [{"introduction": "Zakai方程是一个随机偏微分方程（SPDE），其确定性漂移部分由一个被称为伴随生成元的算子（通常记为 $\\mathcal{L}^*$）所支配。这项实践是基础性的，因为它要求我们从第一性原理出发，为一般多维扩散过程推导这个算子。掌握这一推导是理解任何给定信号模型的Zakai方程结构的关键。", "problem": "考虑一个在$\\mathbb{R}^{d}$上的$d$维伊藤随机微分方程 (SDE)，其形式为\n$$\n\\mathrm{d}X_{t} \\;=\\; b(X_{t})\\,\\mathrm{d}t \\;+\\; \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\n其中 $W_{t}$ 是一个 $r$ 维标准布朗运动，$b:\\mathbb{R}^{d}\\to\\mathbb{R}^{d}$ 是一个光滑漂移场，而 $\\sigma:\\mathbb{R}^{d}\\to\\mathbb{R}^{d\\times r}$ 是一个光滑的、依赖于状态的扩散矩阵。令 $a(x) \\coloneqq \\sigma(x)\\sigma(x)^{\\top}\\in\\mathbb{R}^{d\\times d}$，并假设 $a(x)$是一致椭圆且二次连续可微的。令 $\\mathcal{L}$ 表示与此 SDE 相关的作用于光滑紧支集测试函数 $f\\in C_{c}^{\\infty}(\\mathbb{R}^{d})$ 的无穷小生成元，令 $\\mathcal{L}^{*}$ 表示 $\\mathcal{L}$ 关于 $L^{2}(\\mathbb{R}^{d})$ 上的勒贝格内积的形式伴随算子。在用于非归一化滤波的Zakai方程的背景下，$\\mathcal{L}^{*}$是驱动非归一化条件密度演化的漂移算子。\n\n从无穷小生成元和勒贝格内积的定义出发，推导作用于光滑测试函数 $g\\in C_{c}^{\\infty}(\\mathbb{R}^{d})$ 的形式伴随算子 $\\mathcal{L}^{*}$ 的显式表达式。清楚地说明所使用的任何分部积分和边界衰减假设。\n\n然后，限定于漂移是适应于状态依赖扩散的梯度类型的特殊情况，即\n$$\nb(x) \\;=\\; \\tfrac{1}{2}\\,\\nabla\\!\\cdot a(x) \\;-\\; a(x)\\,\\nabla U(x),\n$$\n对于一个光滑势 $U:\\mathbb{R}^{d}\\to\\mathbb{R}$，其中 $\\nabla\\!\\cdot a$ 是一个向量场，其第 $j$ 个分量为 $\\sum_{i=1}^{d}\\partial_{i}a_{ij}$。定义权重\n$$\n\\pi(x) \\;\\propto\\; \\exp\\!\\big(-2\\,U(x)\\big),\n$$\n以及 $L^{2}(\\pi)$ 上的加权内积 $\\langle f,g\\rangle_{\\pi} \\coloneqq \\int_{\\mathbb{R}^{d}} f(x)\\,g(x)\\,\\pi(x)\\,\\mathrm{d}x$。通过从第一性原理直接计算来证实，在这种特殊情况下，生成元 $\\mathcal{L}$ 关于 $\\langle\\cdot,\\cdot\\rangle_{\\pi}$ 是自伴的。\n\n将您的最终答案表示为关于 $b(x)$、$a(x)$ 及其导数的 $\\mathcal{L}^{*}g(x)$ 的单个闭式解析表达式。不需要数值近似。如果引入任何额外的符号，请明确定义它们。假设所有函数及其导数在无穷远处都足够快地衰减，以保证所有分部积分以及微分和积分交换的合理性。", "solution": "用户希望我分两部分解决一个问题。首先，我需要推导一个无穷小生成元的形式伴随算子。其次，我需要证明对于一个特定的漂移，该生成元在一个加权内积下是自伴的。\n\n### 问题验证\n\n我将首先验证问题陈述。\n\n**步骤1：提取已知条件**\n\n-   随机微分方程 (SDE): $\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}$，其中 $X_t \\in \\mathbb{R}^{d}$，$W_t \\in \\mathbb{R}^{r}$。\n-   漂移：$b:\\mathbb{R}^{d}\\to\\mathbb{R}^{d}$ 是一个光滑向量场。\n-   扩散：$\\sigma:\\mathbbR^{d}\\to\\mathbb{R}^{d\\times r}$ 是一个光滑矩阵值函数。\n-   扩散矩阵：$a(x) \\coloneqq \\sigma(x)\\sigma(x)^{\\top}\\in\\mathbb{R}^{d\\times d}$，假设为一致椭圆且 $C^2$。\n-   无穷小生成元 (作用于 $f\\in C_{c}^{\\infty}(\\mathbb{R}^{d})$)：$\\mathcal{L}$。\n-   $\\mathcal{L}$ 关于勒贝格内积的形式伴随算子：$\\mathcal{L}^{*}$。\n-   特殊情况漂移：$b(x) = \\tfrac{1}{2}\\,\\nabla\\!\\cdot a(x) - a(x)\\,\\nabla U(x)$，对于光滑势 $U:\\mathbb{R}^{d}\\to\\mathbb{R}$。\n-   $a(x)$ 散度的定义：向量 $\\nabla\\!\\cdot a$ 的第 $j$ 个分量是 $(\\nabla\\!\\cdot a)_j = \\sum_{i=1}^{d}\\partial_{i}a_{ij}$。\n-   权重函数：$\\pi(x) \\propto \\exp(-2\\,U(x))$。\n-   加权内积：$\\langle f,g\\rangle_{\\pi} \\coloneqq \\int_{\\mathbb{R}^{d}} f(x)\\,g(x)\\,\\pi(x)\\,\\mathrm{d}x$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n该问题是随机微分方程和椭圆算子理论中的一个标准练习。\n-   **科学依据**：无穷小生成元、形式伴随算子（Fokker-Planck算子）和加权自伴性的概念是随机微积分、统计物理和滤波理论（特别是Zakai方程）中的基本概念。该设置是标准的。\n-   **适定性**：该问题要求进行两项具体的推导，这些都是定义明确的数学任务。所有必要的信息和定义都已提供。\n-   **客观性**：该问题以精确的数学语言陈述，没有歧义或主观性主张。\n-   **完整性和一致性**：该问题是自洽的。提供了诸如 $\\nabla \\cdot a$ 的定义，并且假设（系数的光滑性、测试函数的紧支集）是标准的，足以进行所需的推算。\n\n**步骤3：结论与行动**\n\n该问题是**有效的**。我将继续进行解答。\n\n### 第1部分：形式伴随算子 $\\mathcal{L}^{*}$ 的推导\n\n与SDE相关的、作用于测试函数 $f\\in C_{c}^{\\infty}(\\mathbb{R}^{d})$ 的无穷小生成元 $\\mathcal{L}$ 由Itô公式给出：\n$$\n\\mathcal{L}f(x) = \\sum_{i=1}^{d} b_i(x) \\frac{\\partial f}{\\partial x_i}(x) + \\frac{1}{2} \\sum_{i,j=1}^{d} a_{ij}(x) \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x)\n$$\n关于勒贝格内积 $\\langle f, g \\rangle = \\int_{\\mathbb{R}^d} f(x)g(x)\\,\\mathrm{d}x$ 的形式伴随算子 $\\mathcal{L}^*$ 由关系式 $\\langle \\mathcal{L}f, g \\rangle = \\langle f, \\mathcal{L}^*g \\rangle$ 对所有 $f, g \\in C_c^{\\infty}(\\mathbb{R}^d)$ 定义。\n\n我们从左边开始：\n$$\n\\langle \\mathcal{L}f, g \\rangle = \\int_{\\mathbb{R}^d} \\left( \\sum_{i=1}^{d} b_i(x) \\frac{\\partial f}{\\partial x_i}(x) + \\frac{1}{2} \\sum_{i,j=1}^{d} a_{ij}(x) \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x) \\right) g(x) \\,\\mathrm{d}x\n$$\n我们分别分析积分中的两项。\n\n对于第一项（漂移部分），我们对每个分量 $i$ 使用分部积分：\n$$\n\\int_{\\mathbb{R}^d} b_i(x) \\frac{\\partial f}{\\partial x_i}(x) g(x) \\,\\mathrm{d}x = -\\int_{\\mathbb{R}^d} f(x) \\frac{\\partial}{\\partial x_i} (b_i(x)g(x)) \\,\\mathrm{d}x\n$$\n由于 $f$ 和 $g$ 具有紧支集，无穷远处的边界项消失。对 $i=1, \\dots, d$求和：\n$$\n\\int_{\\mathbb{R}^d} \\left( \\sum_{i=1}^{d} b_i(x) \\frac{\\partial f}{\\partial x_i}(x) \\right) g(x) \\,\\mathrm{d}x = -\\int_{\\mathbb{R}^d} f(x) \\left( \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i}(b_i(x)g(x)) \\right) \\,\\mathrm{d}x\n$$\n\n对于第二项（扩散部分），我们进行两次分部积分。首先，关于 $x_j$：\n$$\n\\frac{1}{2} \\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^d} a_{ij}(x) g(x) \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x) \\,\\mathrm{d}x = -\\frac{1}{2} \\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^d} \\frac{\\partial}{\\partial x_j}(a_{ij}(x) g(x)) \\frac{\\partial f}{\\partial x_i}(x) \\,\\mathrm{d}x\n$$\n同样，边界项消失。现在，我们关于 $x_i$ 进行分部积分：\n$$\n-\\frac{1}{2} \\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^d} \\frac{\\partial}{\\partial x_j}(a_{ij}(x) g(x)) \\frac{\\partial f}{\\partial x_i}(x) \\,\\mathrm{d}x = \\frac{1}{2} \\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^d} f(x) \\frac{\\partial}{\\partial x_i} \\left( \\frac{\\partial}{\\partial x_j}(a_{ij}(x) g(x)) \\right) \\,\\mathrm{d}x\n$$\n这等价于：\n$$\n\\int_{\\mathbb{R}^d} f(x) \\left( \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} (a_{ij}(x)g(x)) \\right) \\,\\mathrm{d}x\n$$\n\n结合两项的结果，我们得到：\n$$\n\\langle \\mathcal{L}f, g \\rangle = \\int_{\\mathbb{R}^d} f(x) \\left[ \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} (a_{ij}(x)g(x)) - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} (b_i(x)g(x)) \\right] \\,\\mathrm{d}x\n$$\n根据伴随算子的定义，方括号中的表达式是 $\\mathcal{L}^*g(x)$。这就是Fokker-Planck算子。\n$$\n\\mathcal{L}^{*}g(x) = \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} (a_{ij}(x) g(x)) - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} (b_i(x) g(x))\n$$\n\n### 第2部分：特殊情况下自伴性的确认\n\n我们被要求确认，对于特殊情况 $b(x) = \\frac{1}{2}\\,\\nabla\\!\\cdot a(x) - a(x)\\,\\nabla U(x)$ 和权重 $\\pi(x) \\propto \\exp(-2U(x))$，算子 $\\mathcal{L}$ 关于加权内积 $\\langle f,g\\rangle_{\\pi}$ 是自伴的。这意味着我们必须证明 $\\langle \\mathcal{L}f, g \\rangle_{\\pi} = \\langle f, \\mathcal{L}g \\rangle_{\\pi}$。\n\n一个众所周知的结果表明，如果 $D$ 是一个对称矩阵值函数，那么形式为 $\\mathcal{A}f = \\frac{1}{\\pi} \\nabla \\cdot (\\pi D \\nabla f)$ 的算子关于 $\\langle \\cdot, \\cdot \\rangle_{\\pi}$ 是自伴的。我们的扩散矩阵是 $\\frac{1}{2}a(x)$，它是对称的。我们将证明我们给定的 $\\mathcal{L}$ 正是这种形式。\n\n让我们展开对称算子形式 $\\mathcal{L}_{sym}f = \\frac{1}{2\\pi} \\nabla \\cdot (\\pi a \\nabla f)$：\n$$\n\\mathcal{L}_{sym}f = \\frac{1}{2\\pi} \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} \\left( \\pi(x) \\sum_{j=1}^{d} a_{ij}(x) \\frac{\\partial f}{\\partial x_j}(x) \\right)\n$$\n使用乘法法则：\n$$\n\\mathcal{L}_{sym}f = \\frac{1}{2\\pi} \\sum_{i=1}^{d} \\left[ \\frac{\\partial \\pi}{\\partial x_i} \\sum_{j=1}^{d} a_{ij} \\frac{\\partial f}{\\partial x_j} + \\pi \\frac{\\partial}{\\partial x_i}\\left( \\sum_{j=1}^{d} a_{ij} \\frac{\\partial f}{\\partial x_j} \\right) \\right]\n$$\n$$\n\\mathcal{L}_{sym}f = \\frac{1}{2} \\sum_{i,j=1}^{d} a_{ij} \\left(\\frac{1}{\\pi}\\frac{\\partial \\pi}{\\partial x_i}\\right) \\frac{\\partial f}{\\partial x_j} + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial a_{ij}}{\\partial x_i} \\frac{\\partial f}{\\partial x_j} + \\frac{1}{2} \\sum_{i,j=1}^{d} a_{ij} \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}\n$$\n最后一项是 $\\mathcal{L}f$ 的扩散部分。前两项构成了漂移部分。让我们将它们组合起来：\n$$\n\\text{漂移项} = \\sum_{j=1}^{d} \\left[ \\frac{1}{2} \\sum_{i=1}^{d} a_{ij} \\left(\\frac{\\partial_i \\pi}{\\pi}\\right) + \\frac{1}{2} \\sum_{i=1}^{d} \\partial_i a_{ij} \\right] \\frac{\\partial f}{\\partial x_j}\n$$\n从定义 $\\pi(x) \\propto \\exp(-2U(x))$，我们有 $\\ln(\\pi) = -2U + \\text{常数}$，所以 $\\frac{1}{\\pi}\\frac{\\partial \\pi}{\\partial x_i} = \\frac{\\partial (\\ln \\pi)}{\\partial x_i} = -2\\frac{\\partial U}{\\partial x_i}$。\n将此代入，并使用问题中的定义 $(\\nabla \\cdot a)_j = \\sum_{i=1}^{d} \\partial_i a_{ij}$（注意 $a_{ij}=a_{ji}$），$\\partial_j f$ 的漂移系数为：\n$$\n\\frac{1}{2} \\sum_{i=1}^{d} a_{ij} (-2 \\partial_i U) + \\frac{1}{2} (\\nabla \\cdot a)_j = -\\sum_{i=1}^{d} a_{ji} (\\partial_i U) + \\frac{1}{2} (\\nabla \\cdot a)_j = -(a \\nabla U)_j + \\frac{1}{2}(\\nabla \\cdot a)_j\n$$\n这正是 $b(x) = \\frac{1}{2}\\nabla \\cdot a(x) - a(x)\\nabla U(x)$ 的第 $j$ 个分量。\n因此，我们已经证明，对于这种特殊情况，生成元 $\\mathcal{L}$ 与对称形式的算子 $\\mathcal{L}_{sym}$ 是相同的：\n$$\n\\mathcal{L}f = \\frac{1}{2\\pi} \\nabla \\cdot (\\pi a \\nabla f)\n$$\n为了按要求完成“直接计算”，我们现在确认这种形式是自伴的：\n$$\n\\langle \\mathcal{L}f, g \\rangle_{\\pi} = \\int_{\\mathbb{R}^d} (\\mathcal{L}f)(x) g(x) \\pi(x) \\,\\mathrm{d}x = \\int_{\\mathbb{R}^d} \\left(\\frac{1}{2\\pi} \\nabla \\cdot (\\pi a \\nabla f)\\right) g \\pi \\,\\mathrm{d}x = \\frac{1}{2} \\int_{\\mathbb{R}^d} g \\nabla \\cdot (\\pi a \\nabla f) \\,\\mathrm{d}x\n$$\n使用分部积分（以及散度定理），并注意到 $f,g$ 具有紧支集，因此边界项消失：\n$$\n\\langle \\mathcal{L}f, g \\rangle_{\\pi} = -\\frac{1}{2} \\int_{\\mathbb{R}^d} \\nabla g \\cdot (\\pi a \\nabla f) \\,\\mathrm{d}x = -\\frac{1}{2} \\int_{\\mathbb{R}^d} \\pi(x) (\\nabla g)^{\\top} a(x) (\\nabla f) \\,\\mathrm{d}x\n$$\n由于 $a(x)$ 是一个对称矩阵，$(\\nabla g)^{\\top} a (\\nabla f) = (a^{\\top}\\nabla g)^{\\top} \\nabla f = (a\\nabla g)^{\\top} \\nabla f = (\\nabla f)^{\\top} a (\\nabla g)$。因此，积分内的表达式关于 $f$ 和 $g$ 是对称的。我们可以交换它们：\n$$\n\\langle \\mathcalL f, g \\rangle_{\\pi} = -\\frac{1}{2} \\int_{\\mathbb{R}^d} \\pi(x) (\\nabla f)^{\\top} a(x) (\\nabla g) \\,\\mathrm{d}x\n$$\n反向使用分部积分：\n$$\n= \\frac{1}{2} \\int_{\\mathbb{R}^d} f \\nabla \\cdot (\\pi a \\nabla g) \\,\\mathrm{d}x = \\int_{\\mathbb{R}^d} f(x) \\left( \\frac{1}{2\\pi} \\nabla \\cdot (\\pi a \\nabla g) \\right) \\pi(x) \\,\\mathrm{d}x = \\langle f, \\mathcal{L}g \\rangle_{\\pi}\n$$\n这证实了 $\\mathcal{L}$ 关于加权内积 $\\langle\\cdot, \\cdot\\rangle_{\\pi}$ 是自伴的。这是可逆扩散的一个关键属性，因为它将动力学与平稳分布 $\\pi(x)$ 联系起来。", "answer": "$$\n\\boxed{\\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} (a_{ij}(x) g(x)) - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} (b_i(x) g(x))}\n$$", "id": "3004789"}, {"introduction": "接下来，我们可能会问，为什么我们需要Zakai方程这样描述整个密度函数演化的复杂工具？这个练习通过一个具体的例子给出了一个令人信服的答案。它表明，即使对于一个具有非线性动力学的简单一维系统，一个最初简单的 高斯密度也会迅速演变成一个无法用有限参数描述的更复杂的形状。这种“有限维滤波器”的失效，为我们使用Zakai方程等无限维方法提供了动力。[@problem_id:3004801]", "problem": "考虑一个一维信号观测模型，该模型建立在一个固定的、支撑两个独立标准布朗运动的滤波概率空间上。信号过程 $X_t \\in \\mathbb{R}$ 满足随机微分方程 (SDE) $dX_t = a(X_t)\\,dt + \\sigma\\,dW_t$，观测过程 $Y_t \\in \\mathbb{R}$ 满足 $dY_t = h(X_t)\\,dt + dV_t$，其中 $W_t$ 和 $V_t$ 是独立的标准布朗运动，$a:\\mathbb{R}\\to\\mathbb{R}$ 是漂移项，$h:\\mathbb{R}\\to\\mathbb{R}$ 是观测函数，$\\sigma>0$ 是一个常数扩散系数。$X_t$ 在给定观测下的非归一化条件密度 $\\pi_t(x)$ 根据 Zakai 测度值随机微分方程演化，其确定性漂移项涉及信号生成元的伴随算子。假设 $a(x)=x^3$ 且 $h(x)=x^2$。设初始非归一化密度为 $\\pi_0(x)=\\exp(-\\alpha x^2)$，其中 $\\alpha>0$。\n\n从作用于密度上的伴随信号生成元的定义出发，利用 Itô 积分的第一性原理以及函数空间上的线性算子理论，分析 $\\pi_t(x)$ 在 $t=0$ 附近的短时展开。为进行此计算，重点关注由伴随算子生成的确定性分量，并忽略由 $dY_t$ 驱动的随机观测项。特别地，考虑确定性半群的戴森型展开中的二阶项，该项涉及 $(\\mathcal{L}^*)^2\\pi_0$，其中 $\\mathcal{L}^*$ 表示作用于密度上的伴随生成元。\n\n计算 $(\\mathcal{L}^*)^2\\pi_0(x)$ 中 $x^6\\exp(-\\alpha x^2)$ 的系数，结果表示为关于 $\\alpha$ 和 $\\sigma$ 的显式解析表达式。你的最终答案必须是单一的闭式表达式。答案不带单位。", "solution": "信号的 SDE 为 $dX_t = a(X_t)\\,dt + \\sigma\\,dW_t$，其中 $a(x)=x^3$。作用于密度 $u:\\mathbb{R}\\to\\mathbb{R}$ 上的信号生成元的伴随算子由下式给出\n$$\n\\mathcal{L}^* u(x) \\;=\\; -\\partial_x\\!\\big(a(x)\\,u(x)\\big) \\;+\\; \\frac{1}{2}\\sigma^2\\,\\partial_{xx}u(x).\n$$\n我们考虑 Zakai 演化的确定性部分（由 $\\mathcal{L}^*$ 生成的漂移项），并忽略涉及 $dY_t$ 的随机项，以分离非线性漂移破坏有限维闭包的机制。作用于 $\\pi_0$ 的确定性流的短时展开为\n$$\n\\pi_t \\;=\\; \\pi_0 \\;+\\; t\\,\\mathcal{L}^*\\pi_0 \\;+\\; \\frac{t^2}{2}\\,(\\mathcal{L}^*)^2\\pi_0 \\;+\\; \\cdots,\n$$\n因此，$(\\mathcal{L}^*)^2\\pi_0$ 中更高次多项式因子的出现标志着函数复杂度的增长。\n\n令 $g(x)=\\exp(-\\alpha x^2)$，其中 $\\alpha>0$。我们将计算 $(\\mathcal{L}^*)^2 g$ 并提取 $x^6 g(x)$ 前面的系数。\n\n首先，计算 $\\mathcal{L}^* g$。我们有\n$$\ng'(x) = -2\\alpha x\\,g(x),\\qquad g''(x) = \\big(-2\\alpha + 4\\alpha^2 x^2\\big)\\,g(x).\n$$\n当 $a(x)=x^3$ 时，我们发现\n\\begin{align*}\n\\partial_x\\!\\big(a(x)g(x)\\big) = \\partial_x\\!\\big(x^3 g(x)\\big) \\;=\\; 3x^2 g(x) + x^3 g'(x) \\\\\n= 3x^2 g(x) + x^3\\big(-2\\alpha x g(x)\\big) \\;=\\; 3x^2 g(x) - 2\\alpha x^4 g(x).\n\\end{align*}\n因此，\n\\begin{align*}\n\\mathcal{L}^* g(x)\n= -\\partial_x\\!\\big(x^3 g(x)\\big) + \\frac{1}{2}\\sigma^2 g''(x) \\\\\n= \\big(-3x^2 + 2\\alpha x^4\\big)g(x) + \\frac{1}{2}\\sigma^2\\big(-2\\alpha + 4\\alpha^2 x^2\\big)g(x) \\\\\n= \\Big(-\\alpha\\sigma^2 + \\big(-3 + 2\\alpha^2\\sigma^2\\big)x^2 + 2\\alpha x^4\\Big)\\,g(x).\n\\end{align*}\n定义多项式\n$$\np(x) \\;=\\; c_0 + c_2 x^2 + c_4 x^4\n\\quad\\text{其中}\\quad\nc_0 = -\\alpha\\sigma^2,\\;\\; c_2 = -3 + 2\\alpha^2\\sigma^2,\\;\\; c_4 = 2\\alpha,\n$$\n使得 $\\mathcal{L}^* g = p(x)\\,g(x)$。\n\n接下来，计算 $\\mathcal{L}^*\\big(p(x)g(x)\\big)$。我们使用以下恒等式\n\\begin{align*}\n\\partial_x\\big(p g\\big) = p'(x) g(x) + p(x) g'(x) \\;=\\; \\big(p'(x) - 2\\alpha x p(x)\\big) g(x), \\\\\n\\partial_{xx}\\big(p g\\big) = \\big(p''(x) - 4\\alpha x p'(x) - 2\\alpha p(x) + 4\\alpha^2 x^2 p(x)\\big)\\,g(x),\n\\end{align*}\n以及\n$$\n\\partial_x\\!\\big(x^3 p g\\big) \\;=\\; \\big(3x^2 p(x) + x^3 p'(x) - 2\\alpha x^4 p(x)\\big)\\,g(x).\n$$\n因此，\n\\begin{align*}\n\\mathcal{L}^*\\!\\big(p g\\big)\n= -\\partial_x\\!\\big(x^3 p g\\big) + \\frac{1}{2}\\sigma^2\\,\\partial_{xx}\\!\\big(p g\\big) \\\\\n= \\Big[-3x^2 p(x) - x^3 p'(x) + 2\\alpha x^4 p(x) \\\\\n\\qquad\\quad + \\frac{1}{2}\\sigma^2\\big(p''(x) - 4\\alpha x p'(x) - 2\\alpha p(x) + 4\\alpha^2 x^2 p(x)\\big)\\Big]\\,g(x).\n\\end{align*}\n我们只需要乘以 $x^6 g(x)$ 的系数。计算 $p$ 的导数：\n$$\np'(x) = 2c_2 x + 4c_4 x^3,\\qquad p''(x) = 2c_2 + 12c_4 x^2.\n$$\n现在逐项收集 $x^6$ 的贡献：\n\n- 来自 $-3x^2 p(x)$：$x^6$ 项是 $-3 c_4 x^6$。\n\n- 来自 $-x^3 p'(x)$：$x^6$ 项是 $-4 c_4 x^6$。\n\n- 来自 $2\\alpha x^4 p(x)$：$x^6$ 项是 $2\\alpha c_2 x^6$（还有一个来自 $c_4$ 的 $x^8$ 项，我们忽略它）。\n\n- 来自 $\\frac{1}{2}\\sigma^2 p''(x)$：没有 $x^6$ 项（它只贡献常数项和 $x^2$ 项）。\n\n- 来自 $\\frac{1}{2}\\sigma^2\\big(-4\\alpha x p'(x)\\big)$：没有 $x^6$ 项（它贡献 $x^2$ 和 $x^4$ 项）。\n\n- 来自 $\\frac{1}{2}\\sigma^2\\big(-2\\alpha p(x)\\big)$：没有 $x^6$ 项（它贡献常数项、$x^2$ 和 $x^4$ 项）。\n\n- 来自 $\\frac{1}{2}\\sigma^2\\big(4\\alpha^2 x^2 p(x)\\big)$：$x^6$ 项是 $2\\alpha^2\\sigma^2 c_4 x^6$。\n\n因此，在 $(\\mathcal{L}^*)^2 g(x) = \\mathcal{L}^*\\big(p g\\big)$ 中 $x^6 g(x)$ 前面的系数是\n\\begin{align*}\nC_6\n= -3 c_4 \\;-\\; 4 c_4 \\;+\\; 2\\alpha c_2 \\;+\\; 2\\alpha^2\\sigma^2 c_4 \\\\\n= -7 c_4 \\;+\\; 2\\alpha c_2 \\;+\\; 2\\alpha^2\\sigma^2 c_4.\n\\end{align*}\n代入 $c_4=2\\alpha$ 和 $c_2=-3+2\\alpha^2\\sigma^2$：\n\\begin{align*}\nC_6\n= -7\\cdot(2\\alpha) \\;+\\; 2\\alpha\\big(-3+2\\alpha^2\\sigma^2\\big) \\;+\\; 2\\alpha^2\\sigma^2\\cdot(2\\alpha) \\\\\n= -14\\alpha \\;+\\; \\big(-6\\alpha + 4\\alpha^3\\sigma^2\\big) \\;+\\; 4\\alpha^3\\sigma^2 \\\\\n= -20\\alpha \\;+\\; 8\\alpha^3\\sigma^2.\n\\end{align*}\n因此，$(\\mathcal{L}^*)^2\\pi_0$ 的 $x^6$ 贡献项为 $\\big(-20\\alpha + 8\\alpha^3\\sigma^2\\big)\\,x^6\\,\\exp(-\\alpha x^2)$。\n\n这个显式的非零系数表明，即使从一个有限维参数化（高斯函数）出发，由非线性漂移 $a(x)=x^3$ 生成的 Zakai 流的确定性部分在重复应用下也会产生更高次的多项式因子。由于在后续的阶数中会出现更高的幂次，因此需要无限数量的参数来追踪演化中的形状，从而为一般非线性 $a$ 和 $h$ 的情况下的有限维闭包提供了一个反例；观测项通过 $h(x)$ 乘性地注入 $x^2$ 因子，并通过 Itô 修正和算子非对易性使次数复合增长，从而进一步加剧了这种增长。然而，所要求的计算正是上面求出的系数 $C_6$。", "answer": "$$\\boxed{-20\\alpha + 8\\alpha^{3}\\sigma^{2}}$$", "id": "3004801"}, {"introduction": "在建立了Zakai方程的一般形式并理解其动机之后，是时候将理论应用于一个实际场景了。这个练习考虑了一个在圆周上运动的信号，这是锁相环和其他工程应用中的常见模型。你将为这个特定系统推导出Zakai SPDE，然后使用一种强大的技术——谱投影到傅里叶基上——将这个难以处理的SPDE转换为一个无穷维但耦合的傅里叶系数SDE系统，这通常是数值近似的起点。[@problem_id:3004820]", "problem": "考虑单位圆 $S^{1}$ 上的一个扩散，由角状态过程 $\\theta_{t} \\in [0,2\\pi)$（模 $2\\pi$）描述，该过程由以下Itô随机微分方程（SDE）控制：\n$$\n\\mathrm{d}\\theta_{t} \\;=\\; \\omega\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_{t},\n$$\n其中 $\\omega \\in \\mathbb{R}$ 和 $\\sigma>0$ 是常数，$W_{t}$ 是标准布朗运动。观测过程 $Y_{t}$ 由下式给出：\n$$\n\\mathrm{d}Y_{t} \\;=\\; h(\\theta_{t})\\,\\mathrm{d}t \\;+\\; \\mathrm{d}V_{t}, \\qquad h(\\theta) \\;=\\; \\sin\\theta,\n$$\n其中 $V_{t}$ 是一个独立于 $W_{t}$ 的标准布朗运动。令 $\\mu(\\mathrm{d}\\theta)$ 表示 $S^{1}$ 上的均匀概率测度，等同于在 $[0,2\\pi)$ 上由 $2\\pi$ 归一化的勒贝格测度。定义关于 $\\mu$ 的未归一化滤波密度 $\\rho_{t}(\\theta)$，其性质为：对于任意光滑的 $2\\pi$-周期测试函数 $\\varphi$，\n$$\n\\int_{0}^{2\\pi} \\varphi(\\theta)\\,\\rho_{t}(\\theta)\\,\\mu(\\mathrm{d}\\theta)\n\\;=\\;\n\\mathbb{E}\\!\\left[\\,\\varphi(\\theta_{t})\\,\\Lambda_{t}\\,\\middle|\\, \\mathcal{Y}_{t}\\,\\right],\n$$\n其中 $\\mathcal{Y}_{t}$ 是由 $\\{Y_{s}: 0\\le s \\le t\\}$ 生成的 $\\sigma$-代数，$\\Lambda_{t}$ 是与观测模型相关的似然过程。\n\n从 $\\varphi(\\theta_{t})$ 的Itô公式、 $S^{1}$ 上状态动态的生成元以及似然过程的测度变换构造出发，推导在周期性边界条件下，未归一化密度 $\\rho_{t}(\\theta)$ 在 $S^{1}$ 上满足的线性随机偏微分方程（SPDE）。然后将 $\\rho_{t}(\\theta)$ 在复傅里叶基上展开：\n$$\n\\rho_{t}(\\theta) \\;=\\; \\frac{1}{2\\pi}\\sum_{n\\in\\mathbb{Z}} c_{n}(t)\\,\\exp(i n \\theta),\n$$\n并通过将该SPDE投影到此基上，得到傅里叶系数 $c_{n}(t)$ 的随机微分方程（SDE）。\n\n最后，从你的推导中提取出在 $\\mathrm{d}c_{1}(t)$ 的漂移部分中乘以 $c_{1}(t)$ 的确定性漂移系数 $\\lambda_{1}$，并纯粹用 $\\omega$ 和 $\\sigma$ 表示。请以单一的闭式解析表达式形式提供你的最终答案。不要在最终答案中包含任何中间步骤。", "solution": "用户要求我解决一个随机滤波理论中的问题。\n\n以下是我的计划：\n1.  **验证问题**：我将首先根据所提供的标准，仔细检查问题陈述的有效性。\n2.  **推导Zakai方程**：我将从非线性滤波的一般理论出发，推导未归一化密度 $\\rho_t(\\theta)$ 的随机偏微分方程（SPDE）。\n3.  **投影到傅里叶基**：然后我会将此SPDE投影到复傅里叶基上，以获得傅里叶系数 $c_n(t)$ 的随机微分方程（SDE）组。\n4.  **提取系数**：最后，我将把SDE特化到 $n=1$ 的情况，并确定所要求的确定性漂移系数 $\\lambda_1$。\n\n---\n\n### 第一部分：问题验证\n\n**步骤1：提取已知条件**\n\n*   **状态过程**：$\\mathrm{d}\\theta_{t} = \\omega\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}$，其中 $\\theta_t \\in S^1 \\cong [0, 2\\pi)$。\n*   **常数**：$\\omega \\in \\mathbb{R}$，$\\sigma > 0$。\n*   **状态噪声**：$W_t$ 是标准布朗运动。\n*   **观测过程**：$\\mathrm{d}Y_{t} = h(\\theta_{t})\\,\\mathrm{d}t + \\mathrm{d}V_{t}$。\n*   **观测函数**：$h(\\theta) = \\sin\\theta$。\n*   **观测噪声**：$V_t$ 是标准布朗运动，独立于 $W_t$。\n*   **基测度**：$\\mu(\\mathrm{d}\\theta)$，即 $S^1$ 上的均匀概率测度，等价于在 $[0, 2\\pi)$ 上 $\\frac{1}{2\\pi}\\mathrm{d}\\theta$。\n*   **未归一化密度定义**：对于任意光滑的 $2\\pi$-周期测试函数 $\\varphi$，未归一化密度 $\\rho_t(\\theta)$ 满足 $\\int_{0}^{2\\pi} \\varphi(\\theta)\\,\\rho_{t}(\\theta)\\,\\mu(\\mathrm{d}\\theta) = \\mathbb{E}[\\varphi(\\theta_{t})\\,\\Lambda_{t}\\,|\\, \\mathcal{Y}_{t}]$。\n*   **傅里叶展开**：$\\rho_{t}(\\theta) = \\frac{1}{2\\pi}\\sum_{n\\in\\mathbb{Z}} c_{n}(t)\\,\\exp(i n \\theta)$。\n*   **目标**：求 $c_1(t)$ 的SDE中的确定性漂移系数 $\\lambda_1$。\n\n**步骤2：根据提取的已知条件进行验证**\n\n该问题是随机滤波理论中的一个标准练习，特别是推导在圆环上带有部分噪声观测的扩散的Zakai方程。\n\n*   **科学性**：该问题建立在随机微分方程、Itô微积分和非线性滤波理论等成熟的数学框架之上。该模型是信号处理和物理学（例如锁相）中一个著名的例子。它不违反任何科学或数学原理。\n*   **适定性**：问题表述清晰。动态过程、观测模型以及待推导的量都已精确指定。预期可以得到所求系数的唯一解析解。\n*   **客观性**：问题以精确、客观的数学语言陈述，没有任何主观性或歧义。\n*   **完整性与一致性**：所有必要的组成部分（SDE、定义、基）均已提供。没有矛盾之处。使用关于均匀测度的密度和特定的傅里叶级数归一化是自洽的选择，尽管需要仔细处理。\n*   **其他缺陷**：该问题并非不切实际、不适定、微不足道或无法验证。这是一个实质性的数学物理问题。\n\n**步骤3：结论与行动**\n\n此问题**有效**。我将进行完整推导。\n\n---\n\n### 第二部分：求解推导\n\n求解过程按问题要求分为三个主要步骤。\n\n**1. 推导Zakai方程 (SPDE)**\n\n测试函数 $\\varphi$ 的未归一化条件期望（记为 $\\pi_t(\\varphi) = \\int_0^{2\\pi} \\varphi(\\theta) \\rho_t(\\theta) \\mu(\\mathrm{d}\\theta)$）的演化由Zakai方程的弱形式决定：\n$$\n\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\pi_t(h\\varphi)\\,\\mathrm{d}Y_t\n$$\n这里，$\\mathcal{L}$ 是状态过程 $\\theta_t$ 的生成元。对于一个二次可微的 $2\\pi$-周期函数 $\\varphi(\\theta)$，Itô公式给出：\n$$\n\\mathcal{L}\\varphi(\\theta) = \\omega \\frac{\\mathrm{d}\\varphi}{\\mathrm{d}\\theta} + \\frac{1}{2}\\sigma^2 \\frac{\\mathrm{d}^2\\varphi}{\\mathrm{d}\\theta^2}\n$$\n代入 $\\pi_t(\\varphi)$ 的定义和基测度 $\\mu(\\mathrm{d}\\theta) = \\frac{1}{2\\pi}\\mathrm{d}\\theta$：\n$$\n\\mathrm{d}\\left(\\int_0^{2\\pi} \\varphi(\\theta)\\rho_t(\\theta)\\frac{\\mathrm{d}\\theta}{2\\pi}\\right) = \\left(\\int_0^{2\\pi} (\\mathcal{L}\\varphi)(\\theta)\\rho_t(\\theta)\\frac{\\mathrm{d}\\theta}{2\\pi}\\right)\\mathrm{d}t + \\left(\\int_0^{2\\pi} h(\\theta)\\varphi(\\theta)\\rho_t(\\theta)\\frac{\\mathrm{d}\\theta}{2\\pi}\\right)\\mathrm{d}Y_t\n$$\n假设正则性足够好，可以交换微分和积分，我们可以写出：\n$$\n\\int_0^{2\\pi} \\varphi(\\theta)\\mathrm{d}\\rho_t(\\theta)\\frac{\\mathrm{d}\\theta}{2\\pi} = \\dots\n$$\n核心步骤是利用伴随算子 $\\mathcal{L}^*$ 将算子 $\\mathcal{L}$ 的作用从测试函数 $\\varphi$ 转移到密度 $\\rho_t$ 上。伴随算子是关于标准勒贝格测度内积 $\\langle f, g \\rangle = \\int_0^{2\\pi} f(\\theta)g(\\theta)\\mathrm{d}\\theta$ 定义的，满足 $\\langle \\mathcal{L}f, g \\rangle = \\langle f, \\mathcal{L}^*g \\rangle$。通过两次分部积分并利用函数的周期性（这使得边界项消失）：\n$$\n\\int_0^{2\\pi} (\\mathcal{L}\\varphi)\\rho_t\\,\\mathrm{d}\\theta = \\int_0^{2\\pi} \\left(\\omega \\varphi' + \\frac{1}{2}\\sigma^2 \\varphi''\\right)\\rho_t\\,\\mathrm{d}\\theta = \\int_0^{2\\pi} \\varphi\\left(-\\omega \\rho_t' + \\frac{1}{2}\\sigma^2 \\rho_t''\\right)\\mathrm{d}\\theta\n$$\n因此，伴随算子为 $\\mathcal{L}^*\\rho_t = -\\omega \\frac{\\partial\\rho_t}{\\partial\\theta} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2\\rho_t}{\\partial\\theta^2}$。\n将此代入弱形式，因子 $\\frac{1}{2\\pi}$ 从所有项中约去：\n$$\n\\int_0^{2\\pi} \\varphi(\\theta)\\mathrm{d}\\rho_t(\\theta)\\,\\mathrm{d}\\theta = \\left(\\int_0^{2\\pi} \\varphi(\\theta)(\\mathcal{L}^*\\rho_t)(\\theta)\\,\\mathrm{d}\\theta\\right)\\mathrm{d}t + \\left(\\int_0^{2\\pi} \\varphi(\\theta)h(\\theta)\\rho_t(\\theta)\\,\\mathrm{d}\\theta\\right)\\mathrm{d}Y_t\n$$\n由于这对任意光滑测试函数 $\\varphi$ 都成立，我们可以令被积函数相等，从而得到Zakai方程的强形式，即 $\\rho_t(\\theta)$ 的SPDE：\n$$\n\\mathrm{d}\\rho_t(\\theta) = \\left( -\\omega \\frac{\\partial \\rho_t}{\\partial \\theta} + \\frac{\\sigma^2}{2} \\frac{\\partial^2 \\rho_t}{\\partial \\theta^2} \\right)\\mathrm{d}t + \\sin(\\theta) \\rho_t(\\theta)\\,\\mathrm{d}Y_t\n$$\n\n**2. 推导傅里叶系数的SDE**\n\n接下来，我们将SPDE投影到傅里叶基上。问题将展开式定义为 $\\rho_{t}(\\theta) = \\frac{1}{2\\pi}\\sum_{n\\in\\mathbb{Z}} c_{n}(t)\\,\\exp(i n \\theta)$。为了找到 $c_k(t)$ 的SDE，我们首先将 $c_k(t)$ 表示为 $\\rho_t(\\theta)$ 的积分变换。将级数乘以 $\\exp(-ik\\theta)$ 并在 $[0, 2\\pi]$ 上积分，我们利用正交关系 $\\int_0^{2\\pi} \\exp(in\\theta)\\exp(-ik\\theta)\\mathrm{d}\\theta = 2\\pi\\delta_{nk}$：\n$$\n\\int_0^{2\\pi} \\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta = \\int_0^{2\\pi} \\left(\\frac{1}{2\\pi}\\sum_{n\\in\\mathbb{Z}} c_{n}(t)\\exp(i n \\theta)\\right) \\exp(-ik\\theta) \\mathrm{d}\\theta = c_k(t)\n$$\n现在我们通过对此定义应用Itô引理（或者更形式化地，取随机微分）来找到 $c_k(t)$ 的动态方程：\n$$\n\\mathrm{d}c_k(t) = \\int_0^{2\\pi} \\mathrm{d}\\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta\n$$\n代入 $\\mathrm{d}\\rho_t(\\theta)$ 的SPDE：\n$$\n\\mathrm{d}c_k(t) = \\left( \\int_0^{2\\pi} (\\mathcal{L}^*\\rho_t)(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta \\right) \\mathrm{d}t + \\left( \\int_0^{2\\pi} \\sin(\\theta)\\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta \\right) \\mathrm{d}Y_t\n$$\n我们分别计算这两个积分。\n\n对于漂移项，我们使用伴随性质 $\\int (\\mathcal{L}^*f)g = \\int f(\\mathcal{L}g)$：\n$$\n\\int_0^{2\\pi} (\\mathcal{L}^*\\rho_t)(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta = \\int_0^{2\\pi} \\rho_t(\\theta) \\mathcal{L}(\\exp(-ik\\theta)) \\mathrm{d}\\theta\n$$\n基函数 $\\exp(-ik\\theta)$ 是生成元 $\\mathcal{L}$ 的特征函数：\n$$\n\\mathcal{L}(\\exp(-ik\\theta)) = \\omega(-ik)\\exp(-ik\\theta) + \\frac{\\sigma^2}{2}(-ik)^2\\exp(-ik\\theta) = \\left(-ik\\omega - \\frac{k^2\\sigma^2}{2}\\right)\\exp(-ik\\theta)\n$$\n漂移项积分变为：\n$$\n\\left(-ik\\omega - \\frac{k^2\\sigma^2}{2}\\right) \\int_0^{2\\pi} \\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta = \\left(-ik\\omega - \\frac{k^2\\sigma^2}{2}\\right) c_k(t)\n$$\n对于扩散项，我们使用恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$：\n$$\n\\int_0^{2\\pi} \\sin(\\theta)\\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta = \\frac{1}{2i} \\int_0^{2\\pi} \\left(\\exp(i\\theta) - \\exp(-i\\theta)\\right) \\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta\n$$\n$$\n= \\frac{1}{2i} \\left( \\int_0^{2\\pi} \\rho_t(\\theta)\\exp(-i(k-1)\\theta)\\mathrm{d}\\theta - \\int_0^{2\\pi} \\rho_t(\\theta)\\exp(-i(k+1)\\theta)\\mathrm{d}\\theta \\right)\n$$\n将积分识别为其他傅里叶系数的定义，这可以简化为：\n$$\n= \\frac{1}{2i} \\left(c_{k-1}(t) - c_{k+1}(t)\\right)\n$$\n结合这些结果，第 $k$ 个傅里叶系数的SDE是：\n$$\n\\mathrm{d}c_k(t) = \\left(-ik\\omega - \\frac{k^2\\sigma^2}{2}\\right) c_k(t)\\,\\mathrm{d}t + \\frac{1}{2i}\\left(c_{k-1}(t) - c_{k+1}(t)\\right)\\,\\mathrm{d}Y_t\n$$\n\n**3. 提取系数 $\\lambda_1$**\n\n问题要求在 $c_1(t)$ 的SDE中乘以 $c_1(t)$ 的确定性漂移系数 $\\lambda_1$。我们在一般方程中令 $k=1$ 来得到这个SDE：\n$$\n\\mathrm{d}c_1(t) = \\left(-i(1)\\omega - \\frac{(1)^2\\sigma^2}{2}\\right) c_1(t)\\,\\mathrm{d}t + \\frac{1}{2i}\\left(c_{0}(t) - c_{2}(t)\\right)\\,\\mathrm{d}Y_t\n$$\n$$\n\\mathrm{d}c_1(t) = \\left(-i\\omega - \\frac{\\sigma^2}{2}\\right) c_1(t)\\,\\mathrm{d}t + \\frac{1}{2i}\\left(c_0(t) - c_2(t)\\right)\\,\\mathrm{d}Y_t\n$$\n此SDE的漂移部分是与 $\\mathrm{d}t$ 成比例的项，即 $\\left(-i\\omega - \\frac{\\sigma^2}{2}\\right) c_1(t)\\,\\mathrm{d}t$。在此漂移部分中乘以 $c_1(t)$ 的系数是：\n$$\n\\lambda_1 = -i\\omega - \\frac{\\sigma^2}{2}\n$$\n这就是所要求的确定性漂移系数。", "answer": "$$\n\\boxed{-i\\omega - \\frac{\\sigma^{2}}{2}}\n$$", "id": "3004820"}]}