{"hands_on_practices": [{"introduction": "在最优控制中，价值函数通常不是光滑的，例如简单的函数 $u(x)=|x|$。这个练习 [@problem_id:3005560] 提供了一个亲身实践的机会，让您直接使用粘性解理论的基本定义。通过在一个不可微点上明确地计算亚射流并检验粘性不等式，您将具体理解该框架如何巧妙地推广了经典解的概念。", "problem": "设函数 $u:\\mathbb{R}\\to\\mathbb{R}$ 由 $u(x)=|x|$ 给出。考虑为 $p\\in\\mathbb{R}$ 和 $X\\in\\mathbb{R}$ 定义的 Hamilton–Jacobi–Bellman (HJB) 算子 $F:\\mathbb{R}\\times\\mathbb{R}\\to\\mathbb{R}$：\n$$\nF(p,X) \\;=\\; \\max\\{ -X,\\; 1 - |p| \\}.\n$$\n该算子在粘性理论意义下是退化椭圆的，并且仅依赖于一阶和二阶射流。在点 $x=0$ 处进行分析。\n\n仅使用二阶半射流和粘性上解的基本定义，按以下步骤进行：\n\n1) 从导数的定义出发，解释为什么 $D^2 u(0)$ 不存在。\n\n2) 从二阶次射流 $J^{2,-}u(0)$ 的定义（当 $x\\to 0$ 时，由 $u(x)\\ge u(0)+p(x-0)+\\tfrac{1}{2}X(x-0)^2 + o(|x|^2)$ 定义）出发，刻画全集 $J^{2,-}u(0)$。\n\n3) 论证为什么二阶超射流 $J^{2,+}u(0)$ 是空集。\n\n4) 在方程 $F(Du,D^2u)=0$ 的粘性上解意义下，必须对所有 $(p,X)\\in J^{2,-}u(0)$ 检验 $F(p,X)\\ge 0$。为了量化此不等式在 $x=0$ 处的尖锐性，计算以下表达式的精确值：\n$$\n\\inf_{(p,X)\\in J^{2,-}u(0)} F(p,X).\n$$\n\n你的最终答案必须是一个实数。不需要四舍五入。", "solution": "问题要求在由算子 $F(p,X) = \\max\\{ -X,\\; 1 - |p| \\}$ 控制的 Hamilton-Jacobi-Bellman (HJB) 方程的粘性解框架下，分析函数 $u(x)=|x|$ 在点 $x=0$ 处的性质。我们将依次解决问题的四个部分。\n\n首先，我们讨论 $u(x)$ 在 $x=0$ 处的经典可微性。\n函数 $u$ 在点 $x_0$ 处的一阶导数定义为 $u'(x_0) = \\lim_{h\\to 0} \\frac{u(x_0+h)-u(x_0)}{h}$，前提是该极限存在。对于 $u(x)=|x|$ 在 $x_0=0$ 处，我们考察其单侧极限：\n右极限为：\n$$ \\lim_{h\\to 0^+} \\frac{u(0+h)-u(0)}{h} = \\lim_{h\\to 0^+} \\frac{|h|-|0|}{h} = \\lim_{h\\to 0^+} \\frac{h}{h} = 1 $$\n左极限为：\n$$ \\lim_{h\\to 0^-} \\frac{u(0+h)-u(0)}{h} = \\lim_{h\\to 0^-} \\frac{|h|-|0|}{h} = \\lim_{h\\to 0^-} \\frac{-h}{h} = -1 $$\n由于左极限和右极限不相等，该极限不存在，因此一阶导数 $u'(0)$ 没有定义。二阶导数 $D^2u(0)$ 或 $u''(0)$ 定义为一阶导数 $u'(x)$ 在 $x=0$ 处的导数。由于 $u'(0)$ 不存在，经典的二阶导数 $D^2u(0)$ 也不能存在。\n\n其次，我们刻画二阶次射流 $J^{2,-}u(0)$。根据定义，当且仅当以下条件成立时，$(p,X) \\in \\mathbb{R}\\times\\mathbb{R}$ 是 $J^{2,-}u(0)$ 的一个元素：\n$$ u(y) \\ge u(0) + p(y-0) + \\frac{1}{2}X(y-0)^2 + o(|y|^2) \\quad \\text{当 } y \\to 0. $$\n代入 $u(y)=|y|$ 和 $u(0)=0$，该不等式变为：\n$$ |y| \\ge py + \\frac{1}{2}Xy^2 + o(y^2). $$\n这等价于检验函数 $\\phi(y) = py + \\frac{1}{2}Xy^2$ 在指定意义下于 $y=0$ 附近位于 $u(y)$ 下方。更形式化地，这可以表述为：\n$$ \\liminf_{y \\to 0} \\frac{|y| - py - \\frac{1}{2}Xy^2}{y^2} \\ge 0. $$\n为了分析这一点，我们必须检查当 $y \\to 0^+$ 和 $y \\to 0^-$ 时的极限。\n对于 $y \\to 0^+$：\n$$ \\liminf_{y \\to 0^+} \\frac{y - py - \\frac{1}{2}Xy^2}{y^2} = \\liminf_{y \\to 0^+} \\left( \\frac{1-p}{y} - \\frac{X}{2} \\right) \\ge 0. $$\n如果 $p  1$，则 $1-p  0$，且当 $y \\to 0^+$ 时 $\\frac{1-p}{y} \\to +\\infty$。不等式对任何 $X \\in \\mathbb{R}$ 都成立。\n如果 $p > 1$，则 $1-p  0$，且 $\\frac{1-p}{y} \\to -\\infty$。不等式不成立。\n如果 $p = 1$，表达式变为 $\\liminf_{y \\to 0^+} (-\\frac{X}{2}) = -\\frac{X}{2}$。条件是 $-\\frac{X}{2} \\ge 0$，这意味着 $X \\le 0$。\n对于 $y \\to 0^-$：\n$$ \\liminf_{y \\to 0^-} \\frac{-y - py - \\frac{1}{2}Xy^2}{y^2} = \\liminf_{y \\to 0^-} \\left( \\frac{-(1+p)}{y} - \\frac{X}{2} \\right) \\ge 0. $$\n令 $y = -h$，其中 $h \\to 0^+$。表达式为 $\\liminf_{h \\to 0^+} (\\frac{1+p}{h} - \\frac{X}{2}) \\ge 0$。\n如果 $p  -1$，则 $1+p  0$，且 $\\frac{1+p}{h} \\to +\\infty$。不等式对任何 $X \\in \\mathbb{R}$ 都成立。\n如果 $p  -1$，则 $1+p  0$，且 $\\frac{1+p}{h} \\to -\\infty$。不等式不成立。\n如果 $p = -1$，表达式为 $\\liminf_{h \\to 0^+} (-\\frac{X}{2}) = -\\frac{X}{2}$。条件是 $-\\frac{X}{2} \\ge 0$，这意味着 $X \\le 0$。\n综合这些条件：$p$ 必须在区间 $[-1, 1]$ 内。\n- 如果 $-1  p  1$，对于任何 $X \\in \\mathbb{R}$，两个单侧条件都满足。\n- 如果 $p=1$，我们必须有 $X \\le 0$。\n- 如果 $p=-1$，我们必须有 $X \\le 0$。\n因此，二阶次射流是集合：\n$$ J^{2,-}u(0) = \\{ (p, X) \\in \\mathbb{R} \\times \\mathbb{R} \\mid p \\in (-1, 1), X \\in \\mathbb{R} \\} \\cup \\{ (\\pm 1, X) \\mid X \\le 0 \\}. $$\n\n第三，我们论证二阶超射流 $J^{2,+}u(0)$ 是空集。根据定义，如果以下条件成立，则 $(p,X) \\in J^{2,+}u(0)$：\n$$ u(y) \\le u(0) + py + \\frac{1}{2}Xy^2 + o(|y|^2) \\quad \\text{当 } y \\to 0. $$\n对于 $u(x)=|x|$ 在 $x=0$ 处，这即是 $|y| \\le py + \\frac{1}{2}Xy^2 + o(|y|^2)$。这意味着 $|y| - py \\le O(y^2)$。\n对于 $y \\ne 0$，两边同除以 $|y|$，我们得到 $1 - p \\frac{y}{|y|} \\le O(|y|)$。\n当 $y \\to 0^+$ 时取极限，我们有 $\\frac{y}{|y|}=1$，所以 $1 - p \\le 0$，这意味着 $p \\ge 1$。\n当 $y \\to 0^-$ 时取极限，我们有 $\\frac{y}{|y|}=-1$，所以 $1 - p(-1) \\le 0$，即 $1+p \\le 0$，这意味着 $p \\le -1$。\n一个实数 $p$ 不能同时满足 $p \\ge 1$ 和 $p \\le -1$。这个矛盾表明不存在这样的数对 $(p,X)$。因此，集合 $J^{2,+}u(0)$ 是空集。\n\n第四，我们计算 $F(p,X)$ 在集合 $J^{2,-}u(0)$ 上的下确界。\n函数为 $F(p,X) = \\max\\{ -X,\\; 1 - |p| \\}$。定义域是我们上面确定的集合 $J^{2,-}u(0)$。我们可以通过考虑定义域的两个不相交的部分来计算下确界。\n\n情况1：$(p,X)$ 满足 $-1  p  1$ 且 $X \\in \\mathbb{R}$。\n对于一个固定的 $p \\in (-1,1)$，量 $1-|p|$ 是一个正常数。令 $C = 1-|p|  0$。我们想要求 $\\inf_{X \\in \\mathbb{R}} \\max\\{ -X, C \\}$。\n$\\max\\{-X, C\\}$ 的值总是大于或等于 $C$。当 $-X$ 从下方趋近于 $C$ 时，达到下确界。对于任何满足 $-X \\le C$（即 $X \\ge -C$）的 $X$，最大值是 $C$。因此，$\\inf_{X \\in \\mathbb{R}} \\max\\{ -X, C \\} = C = 1-|p|$。\n现在，我们对 $p \\in (-1,1)$ 取下确界：\n$$ \\inf_{p \\in (-1,1)} (1-|p|). $$\n函数 $1-|p|$ 在 $|p|$ 趋近于 $1$ 时接近其最小值。下确界是 $0$，尽管在定义域的这一部分中无法达到该值。\n\n情况2：$p=\\pm 1$ 且 $X \\le 0$。\n对于这些 $p$ 值，我们有 $|p|=1$。函数变为：\n$$ F(p,X) = \\max\\{ -X, 1 - 1 \\} = \\max\\{ -X, 0 \\}. $$\n我们已知 $X \\le 0$，这意味着 $-X \\ge 0$。\n因此，对于定义域的这一部分，$\\max\\{ -X, 0 \\} = -X$。\n我们想计算 $\\inf_{X \\le 0} (-X)$。\n当 $X$ 在区间 $(-\\infty, 0]$ 上变化时，表达式 $-X$ 在 $[0, \\infty)$ 上变化。\n集合 $[0, \\infty)$ 的下确界是 $0$。当 $X=0$ 时达到该值。点 $(1,0)$ 和 $(-1,0)$ 都在定义域的这一部分。\n\n结合两种情况的结果， $F(p,X)$ 在整个集合 $J^{2,-}u(0)$ 上的下确界是为每个部分找到的下确界的最小值：\n$$ \\inf_{(p,X)\\in J^{2,-}u(0)} F(p,X) = \\min\\{ 0, 0 \\} = 0. $$\n这个值证实了 $u(x)=|x|$ 是 $F(Du,D^2u)=0$ 的一个粘性上解，并且不等式 $F(p,X) \\ge 0$ 是尖锐的，因为其下确界恰好是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3005560"}, {"introduction": "在局部地分析了解之后，一个关键问题是解的存在性。Perron方法通过在亚解和超解之间构造解，为存在性证明提供了一个强大的工具。这个实践 [@problem_id:3005543] 将引导您完成此方法的关键第一步：寻找合适的“障碍”。本练习阐释了如何为一个简单的HJB方程构建这些基本函数，从而让您洞悉一种证明解存在性的基本技巧。", "problem": "考虑一个一维受控动力系统，其控制过程为 $a_{s} \\in [-1,1]$，随时间 $s \\in [t,T]$ 演化，遵循常微分方程 $dX_{s} = a_{s}\\,ds$，初始条件为 $X_{t} = x$。设目标是最小化终端收益，因此值函数为 $u(t,x) = \\inf_{a_{\\cdot}} \\mathbb{E}\\left[g\\left(X_{T}^{t,x,a}\\right)\\right]$，其中终端数据是有界连续函数 $g(x) = \\arctan(x)$。有界系数和动态规划原理共同给出了粘性解意义下的 Hamilton-Jacobi-Bellman (HJB) 方程\n$$\n- u_{t}(t,x) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,u_{x}(t,x) \\right\\} = 0 \\quad \\text{for } (t,x) \\in [0,T) \\times \\mathbb{R},\n$$\n其终端条件为 $u(T,x) = g(x)$，其中 $T0$ 是一个固定的值。\n\n仅使用粘性下解和粘性上解的核心定义以及上述 HJB 方程的结构性质（有界系数、退化椭圆性），构造显式的有界连续函数 $u_{-}(t,x)$ 和 $u_{+}(t,x)$，使得：\n- $u_{-}$ 是 HJB 方程在 $[0,T) \\times \\mathbb{R}$ 上的一个粘性下解，并且对于所有 $x \\in \\mathbb{R}$，有 $u_{-}(T,x) \\le g(x)$，\n- $u_{+}$ 是 HJB 方程在 $[0,T) \\times \\mathbb{R}$ 上的一个粘性上解，并且对于所有 $x \\in \\mathbb{R}$，有 $u_{+}(T,x) \\ge g(x)$。\n\n你的最终答案必须包含 $u_{-}(t,x)$ 和 $u_{+}(t,x)$ 的显式解析表达式，它们是关于 $(t,x)$ 的常数函数，并以单行矩阵的形式按 $\\left(u_{-}, u_{+}\\right)$ 的顺序呈现。不需要进行数值取整。", "solution": "我们从动态优化和粘性解的基本设置开始。受控动力学 $dX_{s} = a_{s}\\,ds$（其中 $a_{s} \\in [-1,1]$）具有有界漂移系数 $a_{s}$ 和零扩散，这是随机微分方程的一个退化情形。与终端收益 $g(x) = \\arctan(x)$ 的最小化问题相关的值函数 $u$ 在粘性解意义下由 Hamilton-Jacobi-Bellman (HJB) 方程刻画：\n$$\n- u_{t}(t,x) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,u_{x}(t,x) \\right\\} = 0,\n$$\n其终端数据为 $u(T,x) = g(x)$。\n\n我们回顾抛物型 HJB 方程的粘性下解和粘性上解的定义。令 $F(t,x,p,q) = -p_{t} + \\inf_{a \\in [-1,1]} \\left\\{ a\\,p_{x} \\right\\}$ 表示作用于检验函数导数的算子。一个有界上半连续函数 $v$ 是粘性下解，如果对于任何光滑检验函数 $\\varphi \\in C^{1,2}([0,T] \\times \\mathbb{R})$，只要 $v - \\varphi$ 在点 $(t_{0},x_{0}) \\in [0,T) \\times \\mathbb{R}$ 处达到局部最大值，我们就有\n$$\n- \\varphi_{t}(t_{0},x_{0}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\varphi_{x}(t_{0},x_{0}) \\right\\} \\le 0.\n$$\n类似地，一个有界下半连续函数 $w$ 是粘性上解，如果对于任何 $\\psi \\in C^{1,2}$，只要 $w - \\psi$ 在点 $(t_{0},x_{0})$ 处达到局部最小值，我们就有\n$$\n- \\psi_{t}(t_{0},x_{0}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\psi_{x}(t_{0},x_{0}) \\right\\} \\ge 0.\n$$\n\n我们将构造显式的常数下解和上解函数。考虑终端数据 $g(x) = \\arctan(x)$。其值域为 $(-\\pi/2,\\pi/2)$，更准确地说，\n$$\n\\lim_{x \\to -\\infty} \\arctan(x) = -\\frac{\\pi}{2}, \\quad \\lim_{x \\to +\\infty} \\arctan(x) = \\frac{\\pi}{2},\n$$\n并且对于所有 $x \\in \\mathbb{R}$，我们有 $-\\frac{\\pi}{2}  \\arctan(x)  \\frac{\\pi}{2}$。因此，常数 $c_{-} := -\\frac{\\pi}{2}$ 和 $c_{+} := \\frac{\\pi}{2}$ 对于所有 $x \\in \\mathbb{R}$ 都满足 $c_{-} \\le g(x) \\le c_{+}$。定义\n$$\nu_{-}(t,x) := c_{-} = -\\frac{\\pi}{2}, \\quad u_{+}(t,x) := c_{+} = \\frac{\\pi}{2}.\n$$\n这些是有界连续函数。\n\n我们验证 $u_{-}$ 是一个粘性下解。令 $\\varphi \\in C^{1,2}$ 并假设 $u_{-} - \\varphi$ 在 $(t_{0},x_{0})$ 处达到局部最大值。由于 $u_{-}$ 是常数，这意味着 $- \\varphi$ 达到局部最大值，等价地，$\\varphi$ 在 $(t_{0},x_{0})$ 处达到局部最小值。在光滑函数 $(t,x)$ 的这样一个局部最小值点上，我们有一阶导数为零且二阶导数非负，具体来说\n$$\n\\varphi_{t}(t_{0},x_{0}) = 0, \\quad \\varphi_{x}(t_{0},x_{0}) = 0, \\quad \\text{and} \\quad \\varphi_{xx}(t_{0},x_{0}) \\ge 0.\n$$\n对于我们的算子，相关的导数只有 $\\varphi_{t}$ 和 $\\varphi_{x}$，因此我们计算\n$$\n- \\varphi_{t}(t_{0},x_{0}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\varphi_{x}(t_{0},x_{0}) \\right\\} = - 0 + \\inf_{a \\in [-1,1]} \\left\\{ a \\cdot 0 \\right\\} = 0 \\le 0,\n$$\n这验证了下解不等式。终端不等式 $u_{-}(T,x) \\le g(x)$ 成立，因为对于所有 $x \\in \\mathbb{R}$，有 $-\\frac{\\pi}{2} \\le \\arctan(x)$。\n\n我们验证 $u_{+}$ 是一个粘性上解。令 $\\psi \\in C^{1,2}$ 并假设 $u_{+} - \\psi$ 在 $(t_{1},x_{1})$ 处达到局部最小值。由于 $u_{+}$ 是常数，这意味着 $\\psi$ 在 $(t_{1},x_{1})$ 处达到局部最大值，或者等价地，$- \\psi$ 达到局部最小值。对于光滑函数 $\\psi$，在其 $(t,x)$ 的局部最大值点，一阶导数为零：\n$$\n\\psi_{t}(t_{1},x_{1}) = 0, \\quad \\psi_{x}(t_{1},x_{1}) = 0.\n$$\n我们再次对该算子进行计算\n$$\n- \\psi_{t}(t_{1},x_{1}) + \\inf_{a \\in [-1,1]} \\left\\{ a\\,\\psi_{x}(t_{1},x_{1}) \\right\\} = - 0 + \\inf_{a \\in [-1,1]} \\left\\{ a \\cdot 0 \\right\\} = 0 \\ge 0,\n$$\n这验证了上解不等式。终端不等式 $u_{+}(T,x) \\ge g(x)$ 成立，因为对于所有 $x \\in \\mathbb{R}$，有 $\\arctan(x) \\le \\frac{\\pi}{2}$。\n\n这些显式的有界连续函数 $u_{-}(t,x) = -\\frac{\\pi}{2}$ 和 $u_{+}(t,x) = \\frac{\\pi}{2}$ 分别构成了给定 HJB 方程（终端条件为 $g(x) = \\arctan(x)$）的有效粘性下解和粘性上解。它们为 Perron 方法提供了初始屏障，确保了围绕终端数据排序的下解族和上解族非空。", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{\\pi}{2}  \\frac{\\pi}{2}\n\\end{pmatrix}}$$", "id": "3005543"}, {"introduction": "Hamilton-Jacobi-Bellman方程的结构与其对应的随机控制问题的动态特性密切相关。这个练习 [@problem_id:3005553] 探索了这一基本联系，重点关注随机微分方程的扩散项如何决定偏微分方程算子的椭圆性。通过为秩亏的扩散矩阵计算算子的二阶部分，您将揭示为什么偏微分方程是“退化”的，以及在没有噪声的方向上为何缺少二阶导数项。", "problem": "考虑受控的随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} = b(X_{t},a_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\n其中 $X_{t} \\in \\mathbb{R}^{n}$ 是状态，$a_{t} \\in A$ 是取值于紧度量集 $A$ 的控制过程，$b:\\mathbb{R}^{n}\\times A \\to \\mathbb{R}^{n}$ 是一个漂移项，$\\sigma:\\mathbb{R}^{n} \\to \\mathbb{R}^{n \\times m}$ 是一个扩散矩阵，而 $W_{t}$ 是一个 $m$ 维布朗运动 (BM)。假设 $b$ 和 $\\sigma$ 有界且一致连续，并满足保证强解存在唯一性的标准增长条件和 Lipschitz 条件。令 $u:\\mathbb{R}^{n} \\to \\mathbb{R}$ 是一个折扣因子为 $\\lambda0$、运行成本为 $L:\\mathbb{R}^{n}\\times A \\to \\mathbb{R}$ 的平稳无限时域折扣控制问题的值函数，并假设 $u$ 是与上述 SDE 和控制相关联的平稳 Hamilton–Jacobi–Bellman (HJB) 偏微分方程 (PDE) 的一个粘性解。\n\n从动态规划原理 (DPP) 和 Itô 公式出发，推导出 HJB 算子中出现的二阶项，并利用此推导研究当扩散协方差矩阵 $\\sigma(x)\\sigma(x)^{\\top}$ 是秩亏时所产生的结构性后果。重点关注在固定点 $x \\in \\mathbb{R}^{n}$ 处，对于一个在 $x$ 点与 $u$ 相切的光滑检验函数 $\\varphi$（其 Hessian 矩阵为 $D^{2}\\varphi(x)=M \\in \\mathbb{S}^{n}$，即对称 $n\\times n$ 矩阵空间），其二阶项是什么。\n\n给定两个具体的、秩亏的常数扩散矩阵：\n\n- 示例 1 (三维状态，二维噪声):\n$$\n\\sigma_{(1)} \\in \\mathbb{R}^{3\\times 2}, \\quad \\sigma_{(1)} = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  1\n\\end{pmatrix}.\n$$\n\n- 示例 2 (二维状态，一维噪声):\n$$\n\\sigma_{(2)} \\in \\mathbb{R}^{2\\times 1}, \\quad \\sigma_{(2)} = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n\n对于每个示例，确定在 $x$ 点作用于 Hessian 矩阵 $M=D^{2}\\varphi(x)$ 的扩散项对 HJB 算子的显式解析形式，即量\n$$\n\\frac{1}{2}\\,\\mathrm{Tr}\\!\\left(\\sigma_{(i)}\\sigma_{(i)}^{\\top} \\, M\\right),\n$$\n直接用 $M$ 的元素表示，其中 $i\\in\\{1,2\\}$ 且 $M \\in \\mathbb{S}^{n}$ 的元素为 $M_{jk}$，对应于相应的状态维度。\n\n然后，仅使用基本定义和经过充分验证的事实（Itô 公式、动态规划原理以及粘性解的定义），推断出对于每个示例，HJB 算子在属于 $\\sigma_{(i)}(x)^{\\top}$ 的核 (kernel) 的方向上的结构性质；即，解释算子的二阶依赖性沿着这些方向会发生什么，以及这如何反映退化椭圆性。\n\n你的最终答案必须是扩散贡献项的一对表达式，每个示例一个，使用 LaTeX 的 pmatrix 环境排列成一个单行矩阵。无需四舍五入。无需单位。", "solution": "该问题是有效的，因为它是随机最优控制理论和 Hamilton-Jacobi-Bellman (HJB) 方程领域内一个定义明确、具有科学依据的问题。所有术语都是标准的，假设也是常规的，用以确保解的存在性和唯一性，为所需的推导和分析提供了坚实的基础。\n\n我们首先从动态规划原理 (DPP) 出发，给出一个启发式推导，以确定平稳 HJB 方程的二阶项。令 $u:\\mathbb{R}^{n} \\to \\mathbb{R}$ 为无限时域折扣成本问题的值函数。DPP 指出，对于任何时间 $t  0$ 和任何容许控制过程 $\\{a_s\\}_{s \\ge 0}$，\n$$\nu(x) = \\inf_{a_{\\cdot}} \\mathbb{E}\\left[ \\int_{0}^{t} e^{-\\lambda s} L(X_s, a_s) \\mathrm{d}s + e^{-\\lambda t} u(X_t) \\bigg| X_0=x \\right].\n$$\n这意味着对于一个小的事件间隔 $h  0$ 和一个常数控制 $a \\in A$，\n$$\nu(x) \\le \\mathbb{E}\\left[ \\int_{0}^{h} e^{-\\lambda s} L(X_s, a) \\mathrm{d}s + e^{-\\lambda h} u(X_h) \\bigg| X_0=x \\right].\n$$\n假设所涉及的函数足够光滑，我们将积分近似为 $\\int_{0}^{h} e^{-\\lambda s} L(X_s, a) \\mathrm{d}s \\approx L(x,a)h$。为了分析项 $e^{-\\lambda h} u(X_h)$，我们对过程 $f(t,X_t) = e^{-\\lambda t} u(X_t)$ 应用 Itô 公式。其随机微分为：\n$$\n\\mathrm{d}(e^{-\\lambda t} u(X_t)) = \\frac{\\partial}{\\partial t}(e^{-\\lambda t} u(X_t)) \\mathrm{d}t + e^{-\\lambda t} Du(X_t)^{\\top} \\mathrm{d}X_t + \\frac{1}{2} e^{-\\lambda t} \\mathrm{Tr}\\left(D^2u(X_t) (\\mathrm{d}X_t)(\\mathrm{d}X_t)^{\\top}\\right).\n$$\n关于时间的偏导数为 $-\\lambda e^{-\\lambda t} u(X_t)$。二次协变项为 $(\\mathrm{d}X_t)(\\mathrm{d}X_t)^{\\top} = \\sigma(X_t)\\sigma(X_t)^{\\top}\\mathrm{d}t$。将 SDE 代入 $\\mathrm{d}X_t$ 中得到：\n$$\n\\mathrm{d}(e^{-\\lambda t} u(X_t)) = e^{-\\lambda t} \\left[ -\\lambda u(X_t) + Du(X_t)^{\\top}b(X_t,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(X_t)\\sigma(X_t)^{\\top}D^2u(X_t)\\right) \\right]\\mathrm{d}t + e^{-\\lambda t}Du(X_t)^{\\top}\\sigma(X_t)\\mathrm{d}W_t.\n$$\n从 $0$ 到 $h$ 积分，并在给定 $X_0=x$ 的条件下取期望，可以消去鞅项：\n$$\n\\mathbb{E}[e^{-\\lambda h} u(X_h)] - u(x) \\approx \\left[ -\\lambda u(x) + Du(x)^{\\top}b(x,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right) \\right]h.\n$$\n将此结果和积分近似代回 DPP 不等式中，得到：\n$$\nu(x) \\le L(x,a)h + u(x) + \\left[ -\\lambda u(x) + Du(x)^{\\top}b(x,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right) \\right]h + o(h).\n$$\n整理、除以 $h  0$，并取 $h \\to 0$ 的极限，得到：\n$$\n0 \\le L(x,a) - \\lambda u(x) + Du(x)^{\\top}b(x,a) + \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right).\n$$\n由于这对任何控制 $a \\in A$ 都成立，并且对于最优控制取等号，我们对 $a$ 取下确界，从而得到平稳 HJB 方程：\n$$\n\\lambda u(x) - \\sup_{a \\in A}\\left\\{ -L(x,a) - b(x,a)^{\\top}Du(x) \\right\\} - \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2u(x)\\right) = 0.\n$$\n值函数 $u$ 通常不是二次可微的。稳健的表述是通过粘性解，其中 $u$ 与光滑的检验函数 $\\varphi$ 进行比较。如果 $u-\\varphi$ 在 $x$ 处有局部最大值（即 $u$ 被 $\\varphi$ 从上方接触），我们有 $Du(x)=D\\varphi(x)$ 和 $D^2u(x) \\le D^2\\varphi(x)$（在矩阵意义下）。粘性次解的定义要求：\n$$\n\\lambda\\varphi(x) - \\sup_{a \\in A}\\left\\{ -L(x,a) - b(x,a)^{\\top}D\\varphi(x) \\right\\} - \\frac{1}{2}\\mathrm{Tr}\\left(\\sigma(x)\\sigma(x)^{\\top}D^2\\varphi(x)\\right) \\le 0.\n$$\n对于超解，存在一个类似的不等式。我们感兴趣的项是扩散项对 HJB 算子的贡献，它作用于检验函数的 Hessian 矩阵 $M=D^2\\varphi(x)$。该项为 $\\frac{1}{2}\\mathrm{Tr}(\\sigma(x)\\sigma(x)^{\\top}M)$。\n\n我们现在为给定的两个示例分析这个项。\n\n示例 1：状态维数为 $n=3$，噪声维数为 $m=2$。扩散矩阵为\n$$\n\\sigma_{(1)} = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  1\n\\end{pmatrix}.\n$$\n协方差矩阵为 $S_{(1)} = \\sigma_{(1)}\\sigma_{(1)}^{\\top}$：\n$$\nS_{(1)} = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0  0 \\\\\n0  1  1\n\\end{pmatrix} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  1 \\\\\n0  1  1\n\\end{pmatrix}.\n$$\n设 $M \\in \\mathbb{S}^3$ 是一个对称的 $3 \\times 3$ 矩阵，其元素为 $M_{jk}$。扩散贡献项使用性质 $\\mathrm{Tr}(AB) = \\sum_{j,k} A_{jk} B_{kj}$ 计算。由于 $M$ 是对称的（$M_{kj}=M_{jk}$），这变为 $\\sum_{j,k} (S_{(1)})_{jk} M_{jk}$。\n$$\n\\mathrm{Tr}(S_{(1)}M) = (S_{(1)})_{11}M_{11} + (S_{(1)})_{22}M_{22} + (S_{(1)})_{33}M_{33} + (S_{(1)})_{23}M_{23} + (S_{(1)})_{32}M_{32}.\n$$\n代入 $S_{(1)}$ 的值并使用 $M_{23}=M_{32}$：\n$$\n\\mathrm{Tr}(S_{(1)}M) = 1 \\cdot M_{11} + 1 \\cdot M_{22} + 1 \\cdot M_{33} + 1 \\cdot M_{23} + 1 \\cdot M_{32} = M_{11} + M_{22} + M_{33} + 2M_{23}.\n$$\n因此，扩散贡献项为：\n$$\n\\frac{1}{2}\\mathrm{Tr}\\left(\\sigma_{(1)}\\sigma_{(1)}^{\\top} M\\right) = \\frac{1}{2}(M_{11} + M_{22} + 2M_{23} + M_{33}).\n$$\n\n示例 2：状态维数为 $n=2$，噪声维数为 $m=1$。扩散矩阵为\n$$\n\\sigma_{(2)} = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n协方差矩阵为 $S_{(2)} = \\sigma_{(2)}\\sigma_{(2)}^{\\top}$：\n$$\nS_{(2)} = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0\n\\end{pmatrix} = \\begin{pmatrix}\n1  0 \\\\\n0  0\n\\end{pmatrix}.\n$$\n设 $M \\in \\mathbb{S}^2$ 是一个对称的 $2 \\times 2$ 矩阵，其元素为 $M_{jk}$。\n$$\n\\mathrm{Tr}(S_{(2)}M) = (S_{(2)})_{11}M_{11} + (S_{(2)})_{22}M_{22} + (S_{(2)})_{12}M_{12} + (S_{(2)})_{21}M_{21} = 1 \\cdot M_{11} + 0 \\cdot M_{22} + 0 + 0 = M_{11}.\n$$\n扩散贡献项为：\n$$\n\\frac{1}{2}\\mathrm{Tr}\\left(\\sigma_{(2)}\\sigma_{(2)}^{\\top} M\\right) = \\frac{1}{2} M_{11}.\n$$\n\n现在我们研究其结构性后果。HJB 方程的椭圆性由矩阵 $\\sigma\\sigma^{\\top}$ 决定。如果该矩阵是正定的，方程就是一致椭圆的。如果它是奇异的（秩亏的），方程则被称为退化椭圆。这种奇异性意味着扩散仅在状态空间的一个子空间中起作用。$\\sigma^{\\top}$ 的核 (kernel) 包含了没有扩散的方向。\n\n对于示例 1，$\\mathrm{rank}(S_{(1)}) = 2  3$，因此它是奇异的。我们求 $\\sigma_{(1)}^{\\top}$ 的核：\n$$\n\\sigma_{(1)}^{\\top}v = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  1\n\\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies\n\\begin{cases}\nv_1 = 0 \\\\\nv_2 + v_3 = 0\n\\end{cases}.\n$$\n该核由向量 $v_{\\ker} = (0, 1, -1)^{\\top}$ 张成。HJB 算子的二阶项对检验函数 $\\varphi$ 在此方向上的曲率不敏感。要理解这一点，考虑一个仅代表该方向曲率的 Hessian 矩阵，$M = v_{\\ker}v_{\\ker}^{\\top}$：\n$$\nM = \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\end{pmatrix}\\begin{pmatrix} 0  1  -1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  1  -1 \\\\ 0  -1  1 \\end{pmatrix}.\n$$\n这里，$M_{11}=0$，$M_{22}=1$，$M_{33}=1$，以及 $M_{23}=-1$。将此代入我们推导出的扩散贡献项形式中：\n$$\n\\frac{1}{2}(M_{11} + M_{22} + 2M_{23} + M_{33}) = \\frac{1}{2}(0 + 1 + 2(-1) + 1) = 0.\n$$\n这明确地表明 HJB 方程没有与方向 $(0, 1, -1)^{\\top}$ 相关的二阶导数项。该偏微分方程是退化的；它在该方向上表现得像一个一阶输运方程，而在由 $\\sigma_{(1)}$ 的列向量（即 $(1,0,0)^{\\top}$ 和 $(0,1,1)^{\\top}$）张成的正交子空间中是二阶的。\n\n对于示例 2，$S_{(2)}$ 也是奇异的，其 $\\mathrm{rank}(S_{(2)})=1  2$。$\\sigma_{(2)}^{\\top}$ 的核通过以下方式找到：\n$$\n\\sigma_{(2)}^{\\top}v = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = 0 \\implies v_1 = 0.\n$$\n核是 $x_2$ 轴，由 $v_{\\ker} = (0, 1)^{\\top}$ 张成。我们推导出的扩散贡献项 $\\frac{1}{2}M_{11}$，即 $\\frac{1}{2}\\frac{\\partial^2\\varphi}{\\partial x_1^2}$，明确地展示了这种结构性后果。该项独立于 $M_{22} = \\frac{\\partial^2\\varphi}{\\partial x_2^2}$ 和 $M_{12} = \\frac{\\partial^2\\varphi}{\\partial x_1 \\partial x_2}$。HJB 方程在 $x_1$ 变量上是二阶的，但在 $x_2$ 变量上仅为一阶。这反映了底层的 SDE 仅在第一个分量上有噪声，使得第二个分量的演化完全由漂移项驱动，而漂移项是一阶效应。这是退化椭圆性的一个典型案例。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}(M_{11} + M_{22} + 2M_{23} + M_{33})  \\frac{1}{2}M_{11}\n\\end{pmatrix}\n}\n$$", "id": "3005553"}]}