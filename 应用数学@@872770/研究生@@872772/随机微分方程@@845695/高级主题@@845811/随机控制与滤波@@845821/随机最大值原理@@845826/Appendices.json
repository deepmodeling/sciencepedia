{"hands_on_practices": [{"introduction": "理解一个普适性新理论的最佳途径之一，是探究其如何在特定条件下退化为我们所熟知的经典理论。本练习旨在通过一个特殊案例，揭示随机最大值原理（SMP）与经典的庞特里亚金最大值原理（PMP）之间的深刻联系。通过分析当控制不再直接影响系统中的随机项时的情况[@problem_id:3003302]，你将亲手推导出随机伴随过程的鞅项为何必须为零，从而使整个随机最优控制框架优雅地回归到其确定性形式，加深对伴随过程物理意义的理解。", "problem": "考虑在有限时间域 $[0,T]$ 上的标量控制系统，由以下随机微分方程给出\n$$\ndX_t \\;=\\; \\big(a\\,X_t + b\\,u_t\\big)\\,dt \\;+\\; D\\,u_t\\,dW_t,\\qquad X_0 = x_0,\n$$\n其中 $a$，$b$，$D$ 和 $x_0$ 是实常数，$u_t$ 是在 $\\mathbb{R}$ 中取值的容许控制过程，$W_t$ 是标准布朗运动。性能指标为\n$$\nJ(u) \\;=\\; \\mathbb{E}\\!\\left[\\,\\frac{1}{2}\\,M\\,X_T^2 \\;+\\; \\int_0^T \\frac{1}{2}\\,\\big(Q\\,X_t^2 + R\\,u_t^2\\big)\\,dt \\right],\n$$\n其中 $M0$，$Q\\ge 0$ 和 $R0$ 是常数。将与随机最大值原理 (Stochastic Maximum Principle, SMP) 相关联的哈密顿量 $H$ 定义为\n$$\nH(t,x,u,p,q) \\;=\\; p\\,\\big(a\\,x + b\\,u\\big) \\;+\\; q\\,\\big(D\\,u\\big) \\;-\\; \\frac{1}{2}\\,\\big(Q\\,x^2 + R\\,u^2\\big),\n$$\n其中 $p_t$ 和 $q_t$ 是进入 SMP 的倒向随机微分方程 (backward stochastic differential equation, BSDE) 的伴随（协态和鞅）过程。\n\n分析 $D=0$ 的特殊情况，并从 SMP 的变分结构以及 Itô 过程和二次变差的基本性质出发，严格地恢复经典的 Pontryagin 最大值原理 (Pontryagin Maximum Principle, PMP) 结构：一个确定性的伴随常微分方程 (ordinary differential equation, ODE) 和一个关于哈密顿量的逐点时间平稳性（最大值）条件。特别地，请识别伴随鞅项 $q_t$ 并解释其作用，然后确定当 $D=0$ 时它的显式表达式。\n\n你的最终答案必须是 $D=0$ 情况下伴随鞅项 $q_t$ 的显式解析表达式。无需四舍五入。请将最终答案表示为单个闭式解析表达式。", "solution": "分析始于回顾给定问题的随机最大值原理 (SMP) 的一般形式。该系统由状态方程\n$$dX_t = f(t, X_t, u_t) dt + \\sigma(t, X_t, u_t) dW_t$$\n和代价泛函\n$$J(u) = \\mathbb{E}\\left[\\Phi(X_T) + \\int_0^T L(t, X_t, u_t) dt\\right]$$\n描述。对于具体的问题陈述，我们识别出以下组成部分：\n- 漂移项：$f(t,x,u) = a\\,x + b\\,u$\n- 扩散项：$\\sigma(t,x,u) = D\\,u$\n- 终端代价：$\\Phi(x) = \\frac{1}{2}\\,M\\,x^2$\n- 运行代价：$L(t,x,u) = \\frac{1}{2}\\,\\big(Q\\,x^2 + R\\,u^2\\big)$\n\n给定的哈密顿量是 $H(t,x,u,p,q) = p\\,(a\\,x + b\\,u) + q\\,(D\\,u) - \\frac{1}{2}\\,\\big(Q\\,x^2 + R\\,u^2\\big)$，这与标准定义 $H = p f + q \\sigma - L$ 相符。\n\n最优控制 $u_t^*$ 和对应状态 $X_t^*$ 的必要条件由 SMP 给出。这些条件涉及一对伴随过程，即协态 $p_t$ 和鞅项 $q_t$，它们满足以下倒向随机微分方程 (BSDE)：\n$$-dp_t = H_x(t, X_t^*, u_t^*, p_t, q_t) dt - q_t dW_t, \\qquad p_T = \\Phi_x(X_T^*)$$\n其中 $H_x$ 表示哈密顿量关于状态变量 $x$ 的偏导数。此外，最优控制 $u_t^*$ 必须满足最大值条件：\n$$H(t, X_t^*, u_t^*, p_t, q_t) = \\sup_{v \\in \\mathbb{R}} H(t, X_t^*, v, p_t, q_t)$$\n对于我们的具体问题，哈密顿量关于 $x$ 的偏导数是：\n$$H_x = \\frac{\\partial}{\\partial x} \\left[ p(ax+bu) + q(Du) - \\frac{1}{2}(Qx^2+Ru^2) \\right] = a\\,p_t - Q\\,X_t^*$$\n$p_t$ 的终端条件是：\n$$p_T = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2} M x^2 \\right) \\bigg|_{x=X_T^*} = M\\,X_T^*$$\n因此，伴随 BSDE 是：\n$$-dp_t = (a\\,p_t - Q\\,X_t^*) dt - q_t dW_t$$\n或者等价地，其前向形式为：\n$$dp_t = (Q\\,X_t^* - a\\,p_t) dt + q_t dW_t$$\n由于控制集是 $\\mathbb{R}$ 且哈密顿量在 $u$ 上是严格凹的（因为 $R0$），最大值条件等价于一阶平稳性条件 $H_u = 0$：\n$$H_u = \\frac{\\partial}{\\partial u} \\left[ p(ax+bu) + q(Du) - \\frac{1}{2}(Qx^2+Ru^2) \\right] = b\\,p_t + D\\,q_t - R\\,u_t = 0$$\n这给出了用伴随过程表示的最优控制：\n$$u_t^* = \\frac{1}{R}(b\\,p_t + D\\,q_t)$$\n\n现在，我们分析 $D=0$ 的特殊情况。\n在这种情况下，系统动力学变为：\n$$dX_t = (a\\,X_t + b\\,u_t)\\,dt, \\qquad X_0 = x_0$$\n对于任何给定的控制函数 $u(t)$，这是一个确定性的常微分方程 (ODE)。布朗运动 $W_t$ 不再驱动状态动力学。代价泛函保持不变：\n$$J(u) = \\mathbb{E}\\!\\left[\\,\\frac{1}{2}\\,M\\,X_T^2 \\;+\\; \\int_0^T \\frac{1}{2}\\,\\big(Q\\,X_t^2 + R\\,u_t^2\\big)\\,dt \\right]$$\n问题是在容许控制类中找到最优控制 $u_t$，这些容许控制是适应于由 $W_t$ 生成的 σ-代数流 $\\mathcal{F}_t$ 的过程。\n\n关键步骤是证明最优控制 $u_t^*$ 必须是确定性的。设 $u_t$ 为任意容许适应控制。我们可以将其分解为确定性均值和一个零均值的随机部分：\n$$u_t = \\bar{u}_t + \\tilde{u}_t, \\quad \\text{其中} \\quad \\bar{u}_t = \\mathbb{E}[u_t] \\quad \\text{且} \\quad \\mathbb{E}[\\tilde{u}_t] = 0$$\n由于状态方程的线性性，状态 $X_t$ 可以类似地分解为 $X_t = \\bar{X}_t + \\tilde{X}_t$，其中：\n$$\\frac{d\\bar{X}_t}{dt} = a\\,\\bar{X}_t + b\\,\\bar{u}_t, \\quad \\bar{X}_0 = x_0$$\n$$\\frac{d\\tilde{X}_t}{dt} = a\\,\\tilde{X}_t + b\\,\\tilde{u}_t, \\quad \\tilde{X}_0 = 0$$\n由于 $\\bar{X}_t$ 和 $\\bar{u}_t$ 是确定性的，并且 $\\mathbb{E}[\\tilde{X}_t] = \\mathbb{E}[\\int_0^t e^{a(t-s)}b\\,\\tilde{u}_s ds] = \\int_0^t e^{a(t-s)}b\\,\\mathbb{E}[\\tilde{u}_s] ds = 0$。\n\n我们来展开代价泛函：\n$$J(u) = \\frac{1}{2} \\mathbb{E} \\left[ M(\\bar{X}_T + \\tilde{X}_T)^2 + \\int_0^T \\left( Q(\\bar{X}_t + \\tilde{X}_t)^2 + R(\\bar{u}_t + \\tilde{u}_t)^2 \\right) dt \\right]$$\n展开二次项并利用期望的线性性：\n$$J(u) = \\frac{1}{2} \\left( M\\bar{X}_T^2 + \\int_0^T (Q\\bar{X}_t^2 + R\\bar{u}_t^2) dt \\right) + \\frac{1}{2} \\mathbb{E}\\left[ M\\tilde{X}_T^2 + \\int_0^T (Q\\tilde{X}_t^2 + R\\tilde{u}_t^2) dt \\right]$$\n所有交叉项都消失了，因为例如 $\\mathbb{E}[\\bar{X}_t \\tilde{X}_t] = \\bar{X}_t \\mathbb{E}[\\tilde{X}_t] = 0$。第一项正是确定性控制 $\\bar{u}_t$ 的代价泛函，即 $J(\\bar{u})$。第二项是一个非负量，因为 $M0$，$Q\\ge 0$ 且 $R0$。\n$$J(u) = J(\\bar{u}) + \\frac{1}{2} \\mathbb{E}\\left[ M\\tilde{X}_T^2 + \\int_0^T (Q\\tilde{X}_t^2 + R\\tilde{u}_t^2) dt \\right]$$\n这个不等式表明 $J(u) \\ge J(\\bar{u})$。当且仅当第二项为零时，达到最小值。由于 $R0$，这要求 $\\mathbb{E}[\\int_0^T R\\tilde{u}_t^2 dt] = 0$，这意味着对于几乎所有的 $t \\in [0,T]$，$\\tilde{u}_t = 0$ 几乎必然成立。因此，任何最优控制 $u_t^*$ 都必须是确定性的。\n\n现在我们回到 $D=0$ 情况下的 SMP 结果。最优控制由下式给出：\n$$u_t^* = \\frac{1}{R}(b\\,p_t + (0)\\,q_t) = \\frac{b}{R}p_t$$\n由于我们已经严格证明了 $u_t^*$ 必须是时间的确定性函数，并且 $b$ 和 $R$ 是常数，所以伴随过程 $p_t$ 也必须是时间的确定性函数。\n\n过程 $p_t$ 是 BSDE 的解：\n$$dp_t = (Q\\,X_t^* - a\\,p_t) dt + q_t dW_t, \\qquad p_T = M\\,X_T^*$$\n一个 Itô 过程是确定性的，当且仅当其随机积分部分恒等于零。一个确定性的、可微的函数 $p(t)$ 的随机微分就是 $dp(t) = \\frac{dp}{dt} dt$。为了使 Itô 过程 $p_t$ 是确定性的，其扩散系数必须为零。$dp_t$ 的扩散部分是 $q_t dW_t$。为了使此项为零，系数过程 $q_t$ 对于几乎所有的 $t \\in [0,T]$ 必须几乎必然为零。\n\n因此，我们必须有 $q_t = 0$。\n\n在一般 SMP 中，伴随鞅项 $q_t$ 的作用是模拟不确定性在伴随系统中的传播效应。它捕捉了“影子价格”$p_t$ 必须如何调整以响应影响状态系统的相同随机冲击。当状态系统的演化变得与随机冲击无关时（即 $D=0$），伴随过程不再有任何随机信息需要反应，其鞅分量 $q_t$ 必须消失。\n\n当 $q_t=0$ 时，SMP 系统简化为：\n1. 状态 ODE：$\\frac{dX_t}{dt} = a\\,X_t + b\\,u_t$\n2. 伴随 ODE：$\\frac{dp_t}{dt} = Q\\,X_t - a\\,p_t$\n3. 横截性条件：$p_T = M\\,X_T$\n4. 最优性条件：$u_t = \\frac{b}{R} p_t$\n\n这恰好是构成相应确定性线性二次最优控制问题的 Pontryagin 最大值原理 (PMP) 的必要条件集。该分析表明，当从系统动力学中移除随机元素时，更一般的 SMP 如何平稳地退化为经典的 PMP。在这种情况下，伴随鞅项 $q_t$ 的显式表达式为零。", "answer": "$$\\boxed{0}$$", "id": "3003302"}, {"introduction": "在优化理论中，一个关键的告诫是“必要条件并非总是充分条件”。本练习旨在通过一个精心设计的反例，让你深刻体会到这一原则在随机最优控制中的体现。随机最大值原理提供的一阶条件能帮助我们筛选出“候选”最优控制，但当哈密顿量不满足特定的凹性假设时，这些候选解未必是真正的全局最优解[@problem_id:3003286]。通过计算一个非凹成本函数下的定常控制策略，你将学会如何审慎评估一阶条件的结论，并理解为何需要更高阶的分析或额外的结构假设来保证最优性。", "problem": "考虑以下在固定时间范围 $T0$ 上的随机控制问题。设 $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$ 承载一个一维标准布朗运动 $W=(W_t)_{t\\in[0,T]}$。标量状态 $X=(X_t)_{t\\in[0,T]}$ 根据随机微分方程\n$$\ndX_t \\;=\\; u_t\\,dt \\;+\\; \\sigma\\,dW_t,\\qquad X_0=x_0,\n$$\n演化，其中 $\\sigma\\in\\mathbb{R}$，控制 $u=(u_t)_{t\\in[0,T]}$ 是关于 $(\\mathcal{F}_t)_{t\\in[0,T]}$ 循序可测的，并满足 $\\mathbb{E}\\!\\left[\\int_0^T |u_t|^2\\,dt\\right]  \\infty$。目标是最小化成本泛函\n$\nJ(u)\\;=\\;\\mathbb{E}\\!\\left[\\int_0^T \\ell(u_t)\\,dt\\right],\n$\n其中运行成本为\n$\n\\ell(u)\\;=\\;(u^2-1)^2,\n$\n且无终端成本。\n\n仅使用随机微分方程的基本定义和随机最大值原理（SMP）给出的一阶必要条件，完成以下任务：\n\n1) 推导哈密顿量、伴随反向随机微分方程，以及刻画该问题中最优控制必要候选者的一阶平稳性条件。不要假设任何凹性或凸性。\n\n2) 找出一个满足平稳性条件但不是 $J(u)$ 全局最小化子的时间常数容许控制 $u^{\\mathrm{stat}}$。\n\n3) 给出一个时间常数容许控制 $u^{\\mathrm{opt}}$，其成本严格优于 $u^{\\mathrm{stat}}$。\n\n4) 计算成本差距 $J(u^{\\mathrm{stat}})-J(u^{\\mathrm{opt}})$ 作为 $T$ 的函数的精确解析值。\n\n将您的最终答案表示为仅含 $T$ 的精确解析表达式。无需四舍五入，不涉及物理单位。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 时间范围：$T0$。\n- 概率空间：$(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t\\in[0,T]},\\mathbb{P})$。\n- 布朗运动：一个一维标准布朗运动 $W=(W_t)_{t\\in[0,T]}$。\n- 状态过程：$X=(X_t)_{t\\in[0,T]}$。\n- 状态随机微分方程：$dX_t = u_t\\,dt + \\sigma\\,dW_t$。\n- 初始条件：$X_0=x_0$。\n- 参数：$\\sigma\\in\\mathbb{R}$ 是一个常数。\n- 控制过程：$u=(u_t)_{t\\in[0,T]}$ 是关于 $(\\mathcal{F}_t)_{t\\in[0,T]}$ 循序可测的。\n- 容许性条件：$\\mathbb{E}\\!\\left[\\int_0^T |u_t|^2\\,dt\\right]  \\infty$。\n- 待最小化的成本泛函：$J(u) = \\mathbb{E}\\!\\left[\\int_0^T \\ell(u_t)\\,dt\\right]$。\n- 运行成本函数：$\\ell(u) = (u^2-1)^2$。\n- 终端成本：零。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题是随机最优控制理论中的一个标准表述。它涉及状态的线性随机微分方程和成本泛函，这是数学及其在工程和金融领域应用的核心课题。对于这类问题，使用随机最大值原理（SMP）是恰当的。\n- **适定性：** 该问题是适定的。动力学、控制约束和目标函数都已明确定义。问题要求基于必要条件进行分析，而不是对最优控制的存在性和唯一性进行完整证明，鉴于运行成本 $\\ell(u)$ 的非凸性质，这是合适的。\n- **客观性：** 该问题使用精确、客观的数学语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n该问题是有效的，因为它具有科学依据、适定且客观。没有矛盾、信息缺失或违反科学原则之处。由于运行成本的非凸性，该问题是随机最大值原理的一个非平凡应用。我将继续进行解答。\n\n---\n\n根据问题陈述的要求，解答分为四个部分。\n\n### 1) 哈密顿量、伴随方程和平稳性条件\n\n随机控制问题由状态动力学 $dX_t = b(X_t, u_t)\\,dt + \\sigma(X_t, u_t)\\,dW_t$ 和成本 $J(u) = \\mathbb{E}[\\int_0^T \\ell(X_t, u_t)\\,dt + g(X_T)]$ 定义。在这个具体问题中，我们有：\n- 漂移项：$b(x,u) = u$。\n- 扩散项：$\\sigma(x,u) = \\sigma$。\n- 运行成本：$\\ell(x,u) = (u^2-1)^2$。\n- 终端成本：$g(x) = 0$。\n请注意，函数 $b$、$\\sigma$ 和 $\\ell$ 均不依赖于状态 $x$。\n\n**哈密顿量：**\n哈密顿量 $H$ 定义为 $H(x, u, p, q) = p \\cdot b(x,u) + q \\cdot \\sigma(x,u) - \\ell(x,u)$。代入给定函数，我们得到：\n$$\nH(x, u, p, q) = p u + q \\sigma - (u^2-1)^2\n$$\n由于这些函数不依赖于 $x$，哈密顿量也独立于 $x$。\n\n**伴随反向随机微分方程 (BSDE)：**\n伴随过程，即标量过程 $p=(p_t)_{t\\in[0,T]}$ 和标量过程 $q=(q_t)_{t\\in[0,T]}$，由以下 BSDE 的解给出：\n$$\ndp_t = -\\frac{\\partial H}{\\partial x}(X_t, u_t, p_t, q_t)\\,dt + q_t\\,dW_t\n$$\n其终端条件为：\n$$\np_T = \\frac{\\partial g}{\\partial x}(X_T)\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial H}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ p u + q \\sigma - (u^2-1)^2 \\right] = 0\n$$\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x} [0] = 0\n$$\n伴随 BSDE 简化为：\n$$\ndp_t = 0 \\cdot dt + q_t\\,dW_t = q_t\\,dW_t, \\quad p_T = 0\n$$\n该 BSDE 的唯一解是对于所有 $t \\in [0,T]$，$(p_t, q_t) = (0, 0)$。这可以通过从 $t$ 到 $T$ 积分看出：$p_T - p_t = \\int_t^T q_s dW_s$。因为 $p_T=0$，我们有 $p_t = -\\int_t^T q_s dW_s$。过程 $p_t$ 是一个鞅且 $p_T=0$，这意味着 $p_t = \\mathbb{E}[p_T | \\mathcal{F}_t] = 0$。由 $dp_t=0$ 可得 $q_t dW_t=0$，这意味着对于几乎所有的 $t$，$q_t=0$。\n\n**一阶平稳性条件：**\n随机最大值原理为最优性提供了一组必要条件。一阶平稳性条件表明，对于最优控制 $u^*_t$，哈密顿量关于控制变量的导数必须为零，前提是控制集是开集。\n$$\n\\frac{\\partial H}{\\partial u}(X_t, u_t, p_t, q_t) = 0\n$$\n我们计算哈密顿量的偏导数：\n$$\n\\frac{\\partial H}{\\partial u} = \\frac{\\partial}{\\partial u} \\left[ p_t u_t + q_t \\sigma - (u_t^2-1)^2 \\right] = p_t - 2(u_t^2-1)(2u_t) = p_t - 4u_t(u_t^2-1)\n$$\n由于我们发现对所有 $t$ 都有 $p_t=0$，平稳性条件变为：\n$$\n-4u_t(u_t^2-1) = 0\n$$\n该方程给出了在任何时间 $t$ 平稳控制的可能取值：\n$$\nu_t(u_t^2-1) = 0 \\implies u_t \\in \\{0, 1, -1\\}\n$$\n因此，任何最优控制在几乎所有 $t \\in [0,T]$ 时都必须在集合 $\\{0, 1, -1\\}$ 中取值。\n\n### 2) 一个非最优的平稳控制 $u^{\\mathrm{stat}}$\n\n问题要求找到一个满足平稳性条件但不是全局最小化子、与时间无关的常数控制 $u^{\\mathrm{stat}}$。根据平稳性条件，候选的时间常数控制为 $u(t) \\equiv 0$，$u(t) \\equiv 1$ 和 $u(t) \\equiv -1$。这三个都是容许的，因为对于任何常数 $c$，$\\mathbb{E}[\\int_0^T |c|^2 dt] = c^2T  \\infty$。\n\n我们来为每个常数控制评估成本 $J(u)$。对于常数控制 $u_t=c$，成本为：\n$$\nJ(c) = \\mathbb{E}\\left[\\int_0^T (c^2-1)^2 dt\\right] = (c^2-1)^2 \\int_0^T dt = T(c^2-1)^2\n$$\n- 对于 $c=0$：$J(0) = T(0^2-1)^2 = T$。\n- 对于 $c=1$：$J(1) = T(1^2-1)^2 = 0$。\n- 对于 $c=-1$：$J(-1) = T((-1)^2-1)^2 = 0$。\n\n成本泛函总是非负的，即 $J(u) = \\mathbb{E}[\\int_0^T (u_t^2-1)^2 dt] \\ge 0$。可能的最小成本是 $0$。\n控制 $u_t=1$ 和 $u_t=-1$ 达到了这个最小成本，因此它们是全局最小化子。\n控制 $u_t=0$ 产生的成本为 $J(0)=T  0$。因此，它满足平稳性条件，但不是全局最小化子。\n我们将 $u^{\\mathrm{stat}}$ 确定为：\n$$\nu^{\\mathrm{stat}}(t) = 0 \\quad \\text{对于所有 } t \\in [0,T]\n$$\n\n### 3) 一个成本优于 $u^{\\mathrm{stat}}$ 的最优控制 $u^{\\mathrm{opt}}$\n\n我们需要给出一个时间常数控制 $u^{\\mathrm{opt}}$，其成本严格优于 $u^{\\mathrm{stat}}$。根据上面的计算，控制 $u_t=1$ 和 $u_t=-1$ 产生的成本都是 $0$，严格小于 $u^{\\mathrm{stat}}$ 的成本 $T$。我们可以任选其一。我们选择：\n$$\nu^{\\mathrm{opt}}(t) = 1 \\quad \\text{对于所有 } t \\in [0,T]\n$$\n此控制的成本为 $J(u^{\\mathrm{opt}}) = J(1) = 0$。$u^{\\mathrm{stat}}$ 的成本为 $J(u^{\\mathrm{stat}}) = J(0) = T$。由于 $T0$，我们有 $J(u^{\\mathrm{opt}})  J(u^{\\mathrm{stat}})$，因此成本是严格改善的。\n\n### 4) 成本差距 $J(u^{\\mathrm{stat}})-J(u^{\\mathrm{opt}})$\n\n我们计算成本差距作为 $T$ 的函数的精确值。\n$$\nJ(u^{\\mathrm{stat}}) = J(0) = T(0^2-1)^2 = T\n$$\n$$\nJ(u^{\\mathrm{opt}}) = J(1) = T(1^2-1)^2 = 0\n$$\n因此，成本差距为：\n$$\nJ(u^{\\mathrm{stat}}) - J(u^{\\mathrm{opt}}) = T - 0 = T\n$$\n最终结果仅取决于时间范围 $T$。", "answer": "$$ \\boxed{T} $$", "id": "3003286"}, {"introduction": "在某些特殊情况下，随机最大值原理的一阶条件可能会完全失效，无法提供任何关于最优性的有用信息，这种情况被称为“奇异控制”。本练习将引导你进入一个更高级的分析领域：当一阶方法束手无策时，如何运用二阶变分条件来判定一个奇异候选控制的优劣[@problem_id:3003273]。通过对一个围绕奇异点的微小控制扰动进行精确的二阶展开，你将计算出代价泛函的二阶变分系数，并依据其符号来判断该奇异控制是局部最优、最差还是鞍点，从而掌握处理这类挑战性问题的关键技巧。", "problem": "考虑一个在一维时间区间 $[0,1]$ 上由标准布朗运动 $W$ 驱动的一维受控随机微分方程，\n$$\ndx_t \\;=\\; u_t\\,dt \\;+\\; \\nu\\,u_t\\,dW_t,\\qquad x_0 \\;=\\; 0,\n$$\n其中 $\\nu\\in\\mathbb{R}$ 是一个给定常数，控制 $u$ 是循序可测的，并且其取值于一个固定的紧区间 $U=[-\\bar{u},\\bar{u}]$，其中 $\\bar{u}0$。需要最大化的性能泛函是\n$$\nJ(u) \\;=\\; \\mathbb{E}\\!\\left[\\tfrac{1}{2}\\,x_1^2\\right].\n$$\n在随机最大值原理 (SMP) 及其二阶扩展的框架内进行分析。从核心定义开始：对于一个运行成本为零的控制仿射系统，其哈密顿量 $H(x,u,p,q)$，以及终端条件由终端成本的梯度给出的一阶伴随倒向随机微分方程。证明对于候选控制 $u_t\\equiv 0$，一阶随机最大值原理是无法得出结论的，即关于 $u$ 的哈密顿量的平稳性条件和勒让德条件没有提供任何用于区分最优性的信息。\n\n然后，分析奇异候选控制 $u_t\\equiv 0$ 周围的一个小控制扰动 $u^{\\varepsilon}_t=\\varepsilon\\,v_t$，其中 $v_t$ 是一个确定性方向，$\\varepsilon$ 是一个满足 $|\\varepsilon|\\leq \\varepsilon_0$ 的小标量，$\\varepsilon_00$ 足够小以确保 $u^{\\varepsilon}$ 保持在 $U$ 内。对于在 $[0,1]$ 上的特定选择 $v_t\\equiv 1$，推导由关系式定义的二阶变分系数 $Q(\\nu)$\n$$\nJ(u^{\\varepsilon}) - J(0) \\;=\\; \\varepsilon^2\\,Q(\\nu) \\;+\\; o(\\varepsilon^2)\\quad\\text{as }\\varepsilon\\to 0,\n$$\n仅使用诸如伊藤等距定理和随机积分的基本性质等已成熟的结论。你的推导必须从受控动力学出发，构建 $u^{\\varepsilon}$ 下的 $x_1$，并精确计算 $J(u^{\\varepsilon})$ 中的期望值。用文字说明 $Q(\\nu)$ 的符号如何通过最大化问题的二阶条件排除了非最优奇异控制 $u\\equiv 0$。将你对 $Q(\\nu)$ 的最终答案表示为关于 $\\nu$ 的闭式解析表达式。不需要四舍五入，也不涉及单位。", "solution": "此问题需经过验证。\n\n### 步骤 1：提取已知条件\n- **状态动力学**：$dx_t = u_t\\,dt + \\nu\\,u_t\\,dW_t$，其中 $W_t$ 是一维标准布朗运动。\n- **初始条件**：$x_0 = 0$。\n- **时间范围**：$t \\in [0, 1]$。\n- **常数参数**：$\\nu \\in \\mathbb{R}$。\n- **控制集**：控制 $u$ 是一个循序可测过程，其值取自紧区间 $U = [-\\bar{u}, \\bar{u}]$，其中 $\\bar{u}  0$。\n- **性能泛函**：最大化 $J(u) = \\mathbb{E}[\\frac{1}{2} x_1^2]$。\n- **任务**：\n    1. 证明对于候选控制 $u_t \\equiv 0$，一阶随机最大值原理 (SMP) 无法得出结论。\n    2. 对于 $u_t \\equiv 0$ 周围的扰动 $u_t^{\\varepsilon} = \\varepsilon v_t$（其中 $v_t \\equiv 1$），推导由 $J(u^{\\varepsilon}) - J(0) = \\varepsilon^2\\,Q(\\nu) + o(\\varepsilon^2)$ 定义的二阶变分系数 $Q(\\nu)$。\n    3. 根据 $Q(\\nu)$ 的符号得出结论。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在随机最优控制的数学理论框架内是良定义的。它处理了奇异控制的重要情况，在这种情况下，一阶最优性条件不足以得出结论，需要进行二阶分析。\n\n- **科学依据**：该问题基于随机微分方程 (SDEs) 和随机最大值原理的既定框架，后者是随机控制理论的基石。\n- **良态性**：问题陈述清晰，提供了进行所需分析的所有必要信息（动力学、成本、约束）。目标是推导一个特定的、良定义的系数 $Q(\\nu)$。\n- **客观性**：该问题使用精确、形式化的数学语言，不含任何主观或基于意见的内容。\n- **完整性与一致性**：问题设置是自洽且内部一致的。\n- **非平凡性**：该问题并非无关紧要，因为它涉及奇异控制弧，这是一种非标准情况，其中二阶条件变得至关重要。\n\n满足有效问题的所有标准。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将提供完整解答。\n\n***\n\n解答按问题陈述的要求分三部分进行。\n\n首先，我们使用一阶随机最大值原理 (SMP) 分析候选控制 $u_t \\equiv 0$。该系统是控制仿射的，其动力学为 $dx_t = b(u_t) dt + \\sigma(u_t) dW_t$，其中 $b(u) = u$ 且 $\\sigma(u) = \\nu u$。运行成本为 $L(x,u) = 0$，终端成本为 $\\Phi(x) = \\frac{1}{2}x^2$。\n\n该系统的哈密顿量定义为：\n$$\nH(x, u, p, q) = p\\,b(u) + q\\,\\sigma(u) - L(x,u) = p u + q (\\nu u) = (p + \\nu q) u\n$$\n伴随过程 $(p_t, q_t)$ 满足倒向随机微分方程 (BSDE)：\n$$\ndp_t = -\\frac{\\partial H}{\\partial x}(x_t, u_t, p_t, q_t) dt + q_t dW_t, \\quad p_1 = \\frac{d\\Phi}{dx}(x_1)\n$$\n由于哈密顿量 $H$ 不依赖于状态 $x$，我们有 $\\frac{\\partial H}{\\partial x} = 0$。终端条件为 $p_1 = \\frac{d}{dx}(\\frac{1}{2}x^2)\\big|_{x=x_1} = x_1$。\n因此，伴随 BSDE 为 $dp_t = q_t dW_t$，且 $p_1 = x_1$。\n\n让我们对奇异候选控制 $u_t \\equiv 0$ 进行评估。对于 $u_t = 0$，状态动力学变为 $dx_t = 0$，且 $x_0 = 0$。这得到确定性状态轨迹 $x_t \\equiv 0$，对所有 $t \\in [0, 1]$ 成立。因此，终端状态为 $x_1 = 0$。\n伴随过程 $p_t$ 的终端条件变为 $p_1 = x_1 = 0$。BSDE $dp_t = q_t dW_t$ 在 $p_1 = 0$ 条件下的唯一解是 $p_t \\equiv 0$ 和 $q_t \\equiv 0$，对所有 $t \\in [0, 1]$ 成立。\n\nSMP 的一阶必要条件（庞特里亚金原理）指出，最优控制 $u^*_t$ 必须对几乎所有的 $t \\in [0, 1]$ 满足：\n$$\nH(x^*_t, u^*_t, p_t, q_t) = \\max_{v \\in U} H(x^*_t, v, p_t, q_t)\n$$\n对于我们的候选控制 $u_t \\equiv 0$，我们有 $p_t = 0$ 和 $q_t = 0$。哈密顿量变为 $H(x_t, u, p_t, q_t) = (0 + \\nu \\cdot 0) u = 0$，对任何 $u \\in U$ 的值都成立。最优性条件简化为 $0 = \\max_{v \\in [-\\bar{u}, \\bar{u}]} 0$，这是一个重言式。它没有提供任何信息来确定最优控制，因为任何 $v \\in U$ 都是最大化者。平稳性条件 $\\frac{\\partial H}{\\partial u} = p_t + \\nu q_t = 0$ 得到满足，而二阶导数（勒让德-克莱布施）条件 $\\frac{\\partial^2 H}{\\partial u^2} = 0$ 同样没有提供信息。因此，一阶 SMP 无法得出结论。\n\n接下来，我们进行二阶分析。我们考虑奇异控制 $u_t \\equiv 0$ 周围的指定控制扰动。扰动控制为 $u_t^\\varepsilon = \\varepsilon v_t$，其中 $v_t \\equiv 1$，因此 $u_t^\\varepsilon = \\varepsilon$，对 $t \\in [0, 1]$ 成立。我们假设 $\\varepsilon$ 足够小，使得 $\\varepsilon \\in [-\\bar{u}, \\bar{u}]$。\n\n$u^\\varepsilon$ 下的状态 SDE 为：\n$$\ndx_t^\\varepsilon = \\varepsilon dt + \\nu \\varepsilon dW_t, \\quad x_0^\\varepsilon = 0\n$$\n这是一个线性 SDE，可以通过直接积分求解：\n$$\nx_t^\\varepsilon = \\int_0^t \\varepsilon ds + \\int_0^t \\nu \\varepsilon dW_s = \\varepsilon t + \\nu \\varepsilon W_t\n$$\n在终端时间 $t=1$ 时，状态为：\n$$\nx_1^\\varepsilon = \\varepsilon (1) + \\nu \\varepsilon W_1 = \\varepsilon (1 + \\nu W_1)\n$$\n此扰动控制的性能泛函为：\n$$\nJ(u^\\varepsilon) = \\mathbb{E}\\left[\\frac{1}{2} (x_1^\\varepsilon)^2\\right] = \\mathbb{E}\\left[\\frac{1}{2} \\left(\\varepsilon (1 + \\nu W_1)\\right)^2\\right] = \\frac{1}{2}\\varepsilon^2 \\mathbb{E}\\left[(1 + \\nu W_1)^2\\right]\n$$\n我们展开期望内的项：\n$$\n\\mathbb{E}\\left[(1 + \\nu W_1)^2\\right] = \\mathbb{E}\\left[1 + 2\\nu W_1 + \\nu^2 W_1^2\\right]\n$$\n利用期望的线性性质，我们得到：\n$$\n\\mathbb{E}\\left[1\\right] + 2\\nu \\mathbb{E}\\left[W_1\\right] + \\nu^2 \\mathbb{E}\\left[W_1^2\\right]\n$$\n对于标准布朗运动 $W_t$，我们有基本性质 $\\mathbb{E}[W_t] = 0$ 和 $\\text{Var}(W_t) = \\mathbb{E}[W_t^2] - (\\mathbb{E}[W_t])^2 = t$。对于 $t=1$，这给出 $\\mathbb{E}[W_1] = 0$ 和 $\\mathbb{E}[W_1^2] = 1$。代入这些值：\n$$\n\\mathbb{E}\\left[(1 + \\nu W_1)^2\\right] = 1 + 2\\nu(0) + \\nu^2(1) = 1 + \\nu^2\n$$\n回到 $J(u^\\varepsilon)$ 的表达式，我们发现：\n$$\nJ(u^\\varepsilon) = \\frac{1}{2}\\varepsilon^2 (1 + \\nu^2)\n$$\n对应于奇异控制 $u_t \\equiv 0$ 的成本为 $J(0) = \\mathbb{E}[\\frac{1}{2} (0)^2] = 0$。\n因此，成本泛函的变分为：\n$$\nJ(u^\\varepsilon) - J(0) = \\frac{1}{2}\\varepsilon^2 (1 + \\nu^2) - 0 = \\frac{1}{2}\\varepsilon^2 (1 + \\nu^2)\n$$\n问题通过展开式 $J(u^\\varepsilon) - J(0) = \\varepsilon^2 Q(\\nu) + o(\\varepsilon^2)$ 定义了二阶变分系数 $Q(\\nu)$。将我们的精确表达式与此定义进行比较，我们确定：\n$$\nQ(\\nu) = \\frac{1}{2}(1 + \\nu^2)\n$$\n$\\varepsilon$ 中没有更高阶的项，所以 $o(\\varepsilon^2)$ 项为零。\n\n最后，我们使用 $Q(\\nu)$ 的符号来得出关于 $u_t \\equiv 0$ 最优性的结论。这是一个最大化问题。$u_t \\equiv 0$ 成为局部最大值的一个必要条件是，对于任何容许的扰动，相应的成本变分必须是非正的，即对于所有足够小的 $\\varepsilon$，$J(u^\\varepsilon) - J(0) \\le 0$。这转化为对于给定类型的扰动，二阶必要条件为 $Q(\\nu) \\le 0$。\n然而，我们发现 $Q(\\nu) = \\frac{1}{2}(1 + \\nu^2)$。因为 $\\nu \\in \\mathbb{R}$，所以 $\\nu^2 \\ge 0$，这意味着 $1 + \\nu^2 \\ge 1$。因此，对于参数 $\\nu$ 的任何值：\n$$\nQ(\\nu) = \\frac{1}{2}(1 + \\nu^2) \\ge \\frac{1}{2}  0\n$$\n由于 $Q(\\nu)$ 是严格为正的，变分 $J(u^\\varepsilon) - J(0) = \\varepsilon^2 Q(\\nu)$ 对于任何 $\\varepsilon \\neq 0$ 都是严格为正的。这意味着任何偏离零的微小常数扰动都会严格增加性能泛函的值。因为这是一个最大化问题，而扰动导致了性能的改善，所以奇异控制 $u_t \\equiv 0$ 不是一个最大化者。$Q(\\nu)$ 的符号为正，这明确地排除了 $u_t \\equiv 0$ 作为最优控制的候选者；事实上，这揭示了它相对于此类扰动是一个严格的局部最小值。", "answer": "$$\\boxed{\\frac{1}{2}(1+\\nu^2)}$$", "id": "3003273"}]}