{"hands_on_practices": [{"introduction": "这项首个实践提供了分析随机 LQR 系统的基础练习 ([@problem_id:2984737])。我们将通过推导和求解状态二阶矩的微分方程，应用 Itô 积分的基本原理，为一个给定反馈控制律下的简单标量系统直接计算期望二次型成本。这个练习将加强随机动态过程与性能评估之间的直接联系。", "problem": "考虑一个标量线性随机微分方程 (SDE)，该方程模拟了一个在线性二次调节器 (LQR) 状态反馈律下的受控对象：\n$$\ndx_t = a\\,x_t\\,dt + b\\,u_t\\,dt + \\sigma\\,dW_t,\n$$\n其中 $W_t$ 是一个标准维纳过程（标准布朗运动）。应用一个由预先计算的线性二次调节器 (LQR) 提供的恒定状态反馈控制 $u_t = -k\\,x_t$。初始条件是随机的，满足 $x_0 \\sim \\mathcal{N}(m_0, v_0)$，因此 $x_0$ 的均值为 $m_0$，方差为 $v_0$。有限时域二次状态成本为\n$$\nJ_Q = \\mathbb{E}\\!\\left[\\int_{0}^{T} x_t^{\\top}Qx_t \\, dt\\right],\n$$\n在标量情况下，$Q = q > 0$，因此 $x_t^{\\top}Q x_t = q x_t^2$。\n\n从 Itô 积分的基本定义和性质以及线性 SDE 的基本矩出发，对以下特定参数值，解析推导并计算期望 $J_Q$：\n$$\na = 0.75,\\quad b = 1.2,\\quad k = 1.5,\\quad \\sigma = 0.9,\\quad q = 2.5,\\quad T = 1.8,\n$$\n以及\n$$\nm_0 = 0.6,\\quad v_0 = 0.4.\n$$\n您的答案必须是等于 $J_Q$ 的单个实数，四舍五入到四位有效数字。无需单位。", "solution": "问题陈述经过形式化验证，是自洽的，在随机微分方程和控制理论方面具有科学依据，并且是适定的。所有必需的参数都已提供，没有矛盾或歧义。因此，我们可以着手推导解决方案。\n\n系统动力学由以下标量线性随机微分方程 (SDE) 描述：\n$$\ndx_t = a\\,x_t\\,dt + b\\,u_t\\,dt + \\sigma\\,dW_t\n$$\n状态反馈控制律由 $u_t = -k\\,x_t$ 给出。将其代入 SDE 得到闭环系统动力学：\n$$\ndx_t = (a - bk)x_t\\,dt + \\sigma\\,dW_t\n$$\n这是一个 Ornstein-Uhlenbeck 过程。我们定义闭环漂移系数为 $\\alpha = a - bk$。SDE 变为：\n$$\ndx_t = \\alpha\\,x_t\\,dt + \\sigma\\,dW_t\n$$\n待求的成本泛函为：\n$$\nJ_Q = \\mathbb{E}\\left[\\int_{0}^{T} q\\,x_t^2 \\, dt\\right]\n$$\n其中 $q$ 是一个正常数。根据随机过程的 Fubini-Tonelli 定理，由于被积函数是非负的，我们可以交换期望和积分：\n$$\nJ_Q = q \\int_{0}^{T} \\mathbb{E}[x_t^2] \\, dt\n$$\n问题的核心是确定状态的二阶矩 $\\mathbb{E}[x_t^2]$ 作为时间 $t$ 的函数。我们记 $S_t = \\mathbb{E}[x_t^2]$。我们可以使用 Itô 引理推导出 $S_t$ 的常微分方程 (ODE)。\n\n令 $f(x) = x^2$。所需的导数为 $f'(x) = 2x$ 和 $f''(x) = 2$。根据 Itô 引理，$f(x_t)$ 的微分为：\n$$\ndf(x_t) = f'(x_t)\\,dx_t + \\frac{1}{2}f''(x_t)\\,(dx_t)^2\n$$\n代入我们的函数及其导数：\n$$\nd(x_t^2) = 2x_t\\,dx_t + \\frac{1}{2}(2)\\,(dx_t)^2 = 2x_t\\,dx_t + (dx_t)^2\n$$\n现在，代入 SDE 中的 $dx_t$：\n$$\nd(x_t^2) = 2x_t(\\alpha\\,x_t\\,dt + \\sigma\\,dW_t) + (\\alpha\\,x_t\\,dt + \\sigma\\,dW_t)^2\n$$\n二次变分项 $(dx_t)^2$ 使用 Itô 积分法则计算：$(dt)^2 = 0$, $dt\\,dW_t = 0$ 和 $(dW_t)^2 = dt$。\n$$\n(\\alpha\\,x_t\\,dt + \\sigma\\,dW_t)^2 = \\alpha^2 x_t^2 (dt)^2 + 2\\alpha\\sigma x_t dt\\,dW_t + \\sigma^2 (dW_t)^2 = \\sigma^2 dt\n$$\n将此代回 $d(x_t^2)$ 的表达式中：\n$$\nd(x_t^2) = (2\\alpha\\,x_t^2\\,dt + 2\\sigma\\,x_t\\,dW_t) + \\sigma^2\\,dt = (2\\alpha\\,x_t^2 + \\sigma^2)\\,dt + 2\\sigma\\,x_t\\,dW_t\n$$\n为了找到 $S_t = \\mathbb{E}[x_t^2]$ 的 ODE，我们对该微分的积分形式取期望：\n$$\n\\mathbb{E}[x_t^2] - \\mathbb{E}[x_0^2] = \\mathbb{E}\\left[\\int_0^t (2\\alpha\\,x_s^2 + \\sigma^2)\\,ds + \\int_0^t 2\\sigma\\,x_s\\,dW_s\\right]\n$$\n利用期望的线性性质并交换期望和时间积分：\n$$\nS_t - S_0 = \\int_0^t (2\\alpha\\,\\mathbb{E}[x_s^2] + \\sigma^2)\\,ds + \\mathbb{E}\\left[\\int_0^t 2\\sigma\\,x_s\\,dW_s\\right]\n$$\n最后一项是零均值 Itô 积分的期望，其值为零。因此：\n$$\nS_t - S_0 = \\int_0^t (2\\alpha\\,S_s + \\sigma^2)\\,ds\n$$\n对 $t$ 求导，得到二阶矩的 Lyapunov 微分方程：\n$$\n\\frac{dS_t}{dt} = 2\\alpha\\,S_t + \\sigma^2\n$$\n初始条件 $S_0 = \\mathbb{E}[x_0^2]$ 是从初始分布 $x_0 \\sim \\mathcal{N}(m_0, v_0)$ 的性质推导得出的。我们有 $\\mathbb{E}[x_0] = m_0$ 和 $\\text{Var}(x_0) = v_0$。二阶矩为 $S_0 = \\mathbb{E}[x_0^2] = \\text{Var}(x_0) + (\\mathbb{E}[x_0])^2 = v_0 + m_0^2$。\n\n这个一阶线性 ODE 可以使用积分因子或通过识别其为标准形式来求解。解为：\n$$\nS_t = S_0 e^{2\\alpha t} + \\frac{\\sigma^2}{2\\alpha}(e^{2\\alpha t} - 1)\n$$\n这在 $\\alpha \\neq 0$ 时成立。\n\n现在我们将 $S_t$ 从 $0$ 积分到 $T$ 以求得总期望成本：\n$$\n\\int_0^T S_t\\,dt = \\int_0^T \\left(S_0 e^{2\\alpha t} + \\frac{\\sigma^2}{2\\alpha}(e^{2\\alpha t} - 1)\\right) dt\n$$\n$$\n\\int_0^T S_t\\,dt = \\int_0^T \\left( \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)e^{2\\alpha t} - \\frac{\\sigma^2}{2\\alpha} \\right) dt\n$$\n$$\n= \\left[ \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha t}}{2\\alpha} - \\frac{\\sigma^2}{2\\alpha}t \\right]_0^T\n$$\n$$\n= \\left( \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T}}{2\\alpha} - \\frac{\\sigma^2 T}{2\\alpha} \\right) - \\left( \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{1}{2\\alpha} - 0 \\right)\n$$\n$$\n= \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T} - 1}{2\\alpha} - \\frac{\\sigma^2 T}{2\\alpha}\n$$\n最后，我们乘以 $q$ 得到 $J_Q$：\n$$\nJ_Q = q \\left[ \\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T} - 1}{2\\alpha} - \\frac{\\sigma^2 T}{2\\alpha} \\right]\n$$\n现在，代入给定的数值：\n$a = 0.75$, $b = 1.2$, $k = 1.5$, $\\sigma = 0.9$, $q = 2.5$, $T = 1.8$, $m_0 = 0.6$, $v_0 = 0.4$。\n\n首先，我们计算中间常数：\n闭环漂移系数：\n$$\n\\alpha = a - bk = 0.75 - (1.2)(1.5) = 0.75 - 1.8 = -1.05\n$$\n初始二阶矩：\n$$\nS_0 = v_0 + m_0^2 = 0.4 + (0.6)^2 = 0.4 + 0.36 = 0.76\n$$\n噪声方差：\n$$\n\\sigma^2 = (0.9)^2 = 0.81\n$$\n让我们计算 $J_Q$ 表达式的各部分。\n$$\n2\\alpha = 2(-1.05) = -2.1\n$$\n$$\n\\frac{\\sigma^2}{2\\alpha} = \\frac{0.81}{-2.1} \\approx -0.385714\n$$\n$$\nS_0 + \\frac{\\sigma^2}{2\\alpha} = 0.76 + (-0.385714) \\approx 0.374286\n$$\n$$\n2\\alpha T = -2.1 \\times 1.8 = -3.78\n$$\n$$\ne^{2\\alpha T} - 1 = \\exp(-3.78) - 1 \\approx 0.022822 - 1 = -0.977178\n$$\n$$\n\\frac{e^{2\\alpha T} - 1}{2\\alpha} = \\frac{-0.977178}{-2.1} \\approx 0.465323\n$$\n方括号内的第一项是：\n$$\n\\left(S_0 + \\frac{\\sigma^2}{2\\alpha}\\right)\\frac{e^{2\\alpha T} - 1}{2\\alpha} \\approx (0.374286)(0.465323) \\approx 0.174160\n$$\n方括号内的第二项是：\n$$\n-\\frac{\\sigma^2 T}{2\\alpha} = -\\frac{0.81 \\times 1.8}{-2.1} = \\frac{1.458}{2.1} \\approx 0.694286\n$$\n对括号内的各项求和：\n$$\n\\approx 0.174160 + 0.694286 = 0.868446\n$$\n最后，我们乘以 $q$：\n$$\nJ_Q = q \\times 0.868446 = 2.5 \\times 0.868446 \\approx 2.171115\n$$\n四舍五入到四位有效数字，结果为 $2.171$。", "answer": "$$\n\\boxed{2.171}\n$$", "id": "2984737"}, {"introduction": "在基础之上，本问题引入了乘性噪声，这是许多现实世界模型中的一个共同特征，其中不确定性与状态成比例 ([@problem_id:2984771])。你将通过应用 Hamilton-Jacobi-Bellman (HJB) 方程，为一个无限时域问题推导最优控制律，并发现乘性噪声如何修正代数 Riccati 方程。这个实践强调了均方稳定性的关键概念，这是一个比其确定性对应概念更强的条件。", "problem": "考虑标量随机微分方程 (SDE)\n$$\n\\mathrm{d}x_t = \\left(a\\,x_t + b\\,u_t\\right)\\mathrm{d}t + \\sigma\\,x_t\\,\\mathrm{d}W_t,\n$$\n其中 $W_t$ 是一个标准维纳过程，$a$、$b$ 和 $\\sigma$ 为常数。性能准则为无限时域期望二次型成本\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left(q\\,x_t^{2} + r\\,u_t^{2}\\right)\\mathrm{d}t\\right],\n$$\n其中 $q0$ 且 $r0$。假设控制被限制为 $u_t = -K\\,x_t$ 形式的状态反馈，并寻求该随机系统的最优线性二次调节器 (LQR)。\n\n仅使用动态规划原理和 Itô 微分作为基本出发点，推导适用于此问题的平稳 Hamilton–Jacobi–Bellman (HJB) 方程，并证明二次型价值函数拟设 $V(x) = P\\,x^{2}$（其中 $P0$ 为常数）的合理性。对于具体参数值 $a = 1$、$b = 2$、$\\sigma = 1$、$q = 1$ 和 $r = 1$：\n\n- 推导 $P$ 必须满足的代数 Riccati 方程并显式求解。\n- 根据 $P$ 计算最优反馈增益 $K$ 并给出其显式值。\n- 解释由乘性噪声引入的额外均方镇定要求，并验证所获得的最优反馈是否满足此要求。\n\n你的最终答案必须是包含最优反馈增益和 Riccati 解的有序对，写成行矩阵的形式。无需四舍五入。不涉及单位。", "solution": "该问题要求推导一个带乘性噪声的标量随机系统的最优线性二次调节器。解法将从第一性原理出发，使用动态规划原理和 Itô 微分进行推导。\n\n随机微分方程 (SDE) 由下式给出：\n$$\n\\mathrm{d}x_t = (a x_t + b u_t) \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t\n$$\n需要最小化的无限时域成本泛函为：\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} (q x_t^2 + r u_t^2) \\mathrm{d}t\\right]\n$$\n其中 $q  0$ 且 $r  0$。价值函数 $V(x)$ 定义为从状态 $x_0 = x$ 出发的最小可能成本：\n$$\nV(x) = \\min_{u} J(u | x_0 = x)\n$$\n对于这个连续时间、无限时域问题，动态规划原理导出了平稳 Hamilton-Jacobi-Bellman (HJB) 方程。HJB 方程指出，在每个时间点，最优成本率必须为零。其形式如下：\n$$\n\\min_{u} \\left\\{ L(x, u) + \\mathcal{L}^u V(x) \\right\\} = 0\n$$\n其中 $L(x, u) = q x^2 + r u^2$ 是瞬时成本，而 $\\mathcal{L}^u$ 是在控制 $u_t$ 下随机过程 $x_t$ 的无穷小生成元。对函数 $V(x_t)$ 使用 Itô 引理，生成元为：\n$$\n\\mathcal{L}^u V(x) = \\frac{\\mathrm{d}V}{\\mathrm{d}x} (a x + b u) + \\frac{1}{2} \\frac{\\mathrm{d}^2V}{\\mathrm{d}x^2} (\\sigma x)^2\n$$\n将生成元和成本代入 HJB 方程，我们得到：\n$$\n0 = \\min_{u} \\left\\{ q x^2 + r u^2 + (a x + b u) V'(x) + \\frac{1}{2} \\sigma^2 x^2 V''(x) \\right\\}\n$$\n其中 $V'(x)$ 和 $V''(x)$ 分别表示 $V(x)$ 对 $x$ 的一阶和二阶导数。\n\n为了找到最小化花括号中表达式的最优控制 $u^*(x)$，我们对 $u$ 求导并令其结果为零。待最小化的项是关于 $u$ 的二次函数，因此最小值是唯一的。\n$$\n\\frac{\\partial}{\\partial u} \\left[ q x^2 + r u^2 + (a x + b u) V'(x) + \\frac{1}{2} \\sigma^2 x^2 V''(x) \\right] = 2 r u + b V'(x) = 0\n$$\n求解 $u$ 得到反馈形式的最优控制策略：\n$$\nu^*(x) = -\\frac{b}{2r} V'(x)\n$$\n关于 $u$ 的二阶导数为 $2r  0$，证实了这是一个最小值。\n\n接下来，我们将此最优控制 $u^*(x)$ 代回 HJB 方程，以获得价值函数 $V(x)$ 的偏微分方程：\n$$\n0 = q x^2 + r \\left(-\\frac{b}{2r} V'(x)\\right)^2 + \\left(a x + b \\left(-\\frac{b}{2r} V'(x)\\right)\\right) V'(x) + \\frac{1}{2}\\sigma^2 x^2 V''(x)\n$$\n$$\n0 = q x^2 + \\frac{b^2}{4r} [V'(x)]^2 + a x V'(x) - \\frac{b^2}{2r} [V'(x)]^2 + \\frac{1}{2}\\sigma^2 x^2 V''(x)\n$$\n简化涉及 $[V'(x)]^2$ 的项：\n$$\n0 = q x^2 + a x V'(x) - \\frac{b^2}{4r} [V'(x)]^2 + \\frac{1}{2}\\sigma^2 x^2 V''(x)\n$$\n问题指定了一个在状态 $x$ 和控制 $u$ 上是二次型的成本泛函。这表明价值函数也应是二次型的。我们作出拟设 $V(x) = P x^2$，其中 $P0$ 为某个常数。要求 $P0$ 是因为成本总是非负的，因此代表总期望成本的价值函数也必须是非负的。\n该拟设的导数为 $V'(x) = 2 P x$ 和 $V''(x) = 2 P$。将它们代入 HJB 方程：\n$$\n0 = q x^2 + a x (2 P x) - \\frac{b^2}{4r} (2 P x)^2 + \\frac{1}{2}\\sigma^2 x^2 (2 P)\n$$\n$$\n0 = q x^2 + 2aP x^2 - \\frac{b^2}{4r} (4 P^2 x^2) + \\sigma^2 P x^2\n$$\n我们可以提出因子 $x^2$。为使此方程对任意状态 $x$ 成立，括号内的表达式必须为零。\n$$\n\\left( q + 2aP + \\sigma^2 P - \\frac{b^2}{r} P^2 \\right) x^2 = 0\n$$\n这就得到了关于 $P$ 的代数 Riccati 方程 (ARE)：\n$$\n(2a + \\sigma^2)P - \\frac{b^2}{r}P^2 + q = 0\n$$\n现在，我们代入具体的参数值：$a = 1$、$b = 2$、$\\sigma = 1$、$q = 1$ 和 $r = 1$。\n$$\n(2(1) + 1^2)P - \\frac{2^2}{1}P^2 + 1 = 0\n$$\n$$\n3P - 4P^2 + 1 = 0\n$$\n整理成标准二次型形式：\n$$\n4P^2 - 3P - 1 = 0\n$$\n我们使用二次公式 $P = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解这个关于 $P$ 的二次方程，其中 $A=4$, $B=-3$, $C=-1$：\n$$\nP = \\frac{3 \\pm \\sqrt{(-3)^2 - 4(4)(-1)}}{2(4)} = \\frac{3 \\pm \\sqrt{9 + 16}}{8} = \\frac{3 \\pm \\sqrt{25}}{8} = \\frac{3 \\pm 5}{8}\n$$\n两个可能的解是 $P_1 = \\frac{3+5}{8} = 1$ 和 $P_2 = \\frac{3-5}{8} = -\\frac{1}{4}$。\n由于价值函数必须是正定的（$V(x) = Px^2 \\ge 0$），我们必须选择正解。因此，$P = 1$。\n\n最优反馈增益 $K$ 是从控制律 $u_t = -K x_t$ 推导出来的。将其与我们对 $u^*(x)$ 的表达式进行比较：\n$$\nu^*(x_t) = -\\frac{b}{2r} V'(x_t) = -\\frac{b}{2r} (2 P x_t) = -\\frac{bP}{r} x_t\n$$\n因此，最优反馈增益为 $K = \\frac{bP}{r}$。代入给定的参数和我们解出的 $P$ 值：\n$$\nK = \\frac{2 \\cdot 1}{1} = 2\n$$\n\n最后，我们必须验证该控制律能导出一个均方稳定的闭环系统。通过将 $u_t = -Kx_t$ 代入 SDE，可以找到闭环动力学：\n$$\n\\mathrm{d}x_t = (a x_t + b(-Kx_t)) \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t = (a - bK)x_t \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t\n$$\n为了检查均方稳定性，我们分析二阶矩 $\\mathbb{E}[x_t^2]$ 的动态。我们对函数 $f(x) = x^2$ 应用 Itô 引理：\n$$\n\\mathrm{d}(x_t^2) = 2x_t \\mathrm{d}x_t + \\frac{1}{2}(2)(\\mathrm{d}x_t)^2 = 2x_t \\mathrm{d}x_t + (\\mathrm{d}x_t)^2\n$$\n代入 $\\mathrm{d}x_t$ 并使用规则 $(\\mathrm{d}t)^2 = 0$, $(\\mathrm{d}t)(\\mathrm{d}W_t) = 0$, $(\\mathrm{d}W_t)^2 = \\mathrm{d}t$：\n$$\n\\mathrm{d}(x_t^2) = 2x_t((a-bK)x_t \\mathrm{d}t + \\sigma x_t \\mathrm{d}W_t) + (\\sigma x_t \\mathrm{d}W_t)^2\n$$\n$$\n\\mathrm{d}(x_t^2) = (2(a-bK)x_t^2 + \\sigma^2 x_t^2) \\mathrm{d}t + 2\\sigma x_t^2 \\mathrm{d}W_t\n$$\n对两边取期望，并注意到随机积分项的期望为零，我们得到关于均方值 $m_2(t) = \\mathbb{E}[x_t^2]$ 的常微分方程：\n$$\n\\frac{\\mathrm{d}m_2(t)}{\\mathrm{d}t} = \\mathbb{E}[(2(a-bK) + \\sigma^2)x_t^2] = (2(a-bK) + \\sigma^2)m_2(t)\n$$\n为使 $m_2(t)$ 在 $t \\to \\infty$ 时收敛到 $0$，其系数必须为负。这就给出了均方稳定性条件：\n$$\n2(a-bK) + \\sigma^2  0\n$$\n项 $\\sigma^2$ 是由乘性噪声引入的额外要求。在确定性系统（$\\sigma=0$）中，稳定性仅要求闭环极点 $a-bK$ 为负。噪声对二阶矩有失稳作用，必须通过一个足够大的负漂移项来抵消。\n\n让我们用我们计算出的值 $a = 1$、$b = 2$、$\\sigma = 1$ 和 $K = 2$ 来验证这个条件：\n$$\n2(1 - 2 \\cdot 2) + 1^2 = 2(1 - 4) + 1 = 2(-3) + 1 = -6 + 1 = -5\n$$\n由于 $-5  0$，均方稳定性的条件得到满足。推导出的最优反馈增益 $K=2$ 确实是镇定的。\n\n要求的答案是最优反馈增益 $K$ 和 Riccati 解 $P$ 的有序对。即 $(K,P) = (2,1)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2  1 \\end{pmatrix}}\n$$", "id": "2984771"}, {"introduction": "我们最后的实践将探讨 LQR 问题中一个重要的话题：适定性 (well-posedness)，特别是当成本函数的标准假设不满足时 ([@problem_id:2984739])。通过使用“配方法”技巧处理状态-控制交叉项，你将重构该问题并分析其内在结构。这个练习展示了如何识别一个不适定的问题——其最优成本可以被驱使至负无穷大，从而让你对最优控制的理论基础有更深刻的理解。", "problem": "考虑$\\mathbb{R}^{2}$中的连续时间随机线性系统，\n$$\ndx(t) = A\\,x(t)\\,dt + B\\,u(t)\\,dt + \\Sigma\\,dW(t),\n$$\n其中 $x(t) \\in \\mathbb{R}^{2}$，$u(t) \\in \\mathbb{R}$，$W(t) \\in \\mathbb{R}^{2}$ 是一个分量独立的标准二维布朗运动，且\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix},\\qquad\nB = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\\qquad\n\\Sigma = \\begin{pmatrix} \\sigma  0 \\\\ 0  0 \\end{pmatrix},\n$$\n其中 $\\sigma \\in (0,\\infty)$ 是一个固定常数。初始条件为 $x(0)=0$。容许控制是所有逐点可测过程 $u$，使得对于任意有限时域 $T0$，都有 $\\mathbb{E}\\!\\left[\\int_{0}^{T} u(t)^{2}\\,dt\\right]  \\infty$。考虑无限时域二次性能指标\n$$\nJ(u) = \\mathbb{E}\\!\\left[\\int_{0}^{\\infty} \\Big( x(t)^{\\top} Q\\, x(t) + 2\\, x(t)^{\\top} N\\, u(t) + r\\, u(t)^{2} \\Big) dt \\right],\n$$\n其中\n$$\nQ = \\begin{pmatrix} -1  0 \\\\ 0  1 \\end{pmatrix}, \\qquad\nN = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad\nr = 1.\n$$\n注意 $Q$ 是不定的。仅使用基础工具（二次型的代数配方法则和 Itô 扩散二阶矩的基本性质），完成以下任务：\n\n- 对 $u$ 进行配方以消除交叉项，并用新控制 $\\tilde{u}$ 和一个等效状态权重矩阵 $Q_{\\mathrm{eff}}$ 来重写运行积分项。明确求出 $Q_{\\mathrm{eff}}$。\n\n- 在控制重参数化 $u(t) = \\tilde{u}(t) - K\\,x(t)$（其中 $K$ 来自配方过程）下，推导动力学方程，并确定所得状态的漂移矩阵。\n\n- 基于你的重构，判断该问题是适定的（最优值为有限）还是不适定的（$J$ 的下确界为 $-\\infty$）。通过构造一个容许控制并利用相应 Itô 过程的二阶矩增长来证明你的结论。\n\n$\\inf_{u} J(u)$ 的值是多少？请以单一解析表达式形式提供最终答案。无需四舍五入。", "solution": "用户提供了一个随机线性二次控制问题，并要求进行分步分析，以确定该问题是否适定并求出成本泛函的下确界。本分析将按要求使用第一性原理进行。\n\n该问题由以下随机微分方程（SDE）定义：\n$$\ndx(t) = A\\,x(t)\\,dt + B\\,u(t)\\,dt + \\Sigma\\,dW(t)\n$$\n矩阵为\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix},\\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\\quad \\Sigma = \\begin{pmatrix} \\sigma  0 \\\\ 0  0 \\end{pmatrix}\n$$\n状态为 $x(t) \\in \\mathbb{R}^2$，控制为 $u(t) \\in \\mathbb{R}$，$W(t) \\in \\mathbb{R}^2$ 是标准布朗运动。初始条件为 $x(0)=0$。需要最小化的成本泛函为：\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( x(t)^{\\top} Q\\, x(t) + 2\\, x(t)^{\\top} N\\, u(t) + r\\, u(t)^{2} \\right) dt \\right]\n$$\n成本参数为\n$$\nQ = \\begin{pmatrix} -1  0 \\\\ 0  1 \\end{pmatrix}, \\quad N = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad r = 1\n$$\n\n分析将按问题陈述的要求分三部分进行。\n\n### 第一部分：配方法与等效状态权重矩阵\n\n成本泛函 $J(u)$ 中的运行积分项是关于控制 $u(t)$ 的二次函数。我们可以对 $u(t)$ 进行配方以简化表达式。该积分项为：\n$$\nL(x(t), u(t)) = x(t)^{\\top} Q x(t) + 2 x(t)^{\\top} N u(t) + r u(t)^2\n$$\n对于标量控制 $u$ 和 $r=1$，该项为 $L(x, u) = u^2 + 2(N^{\\top}x)u + x^{\\top}Qx$。对包含 $u$ 的项进行配方：\n$$\nu^2 + 2(N^{\\top}x)u = (u + N^{\\top}x)^2 - (N^{\\top}x)^2\n$$\n由于 $N^{\\top}x$ 是一个标量，其平方为 $(N^{\\top}x)^2 = (N^{\\top}x)^{\\top}(N^{\\top}x) = x^{\\top}NN^{\\top}x$。\n将其代回积分项表达式中得到：\n$$\nL(x, u) = (u + N^{\\top}x)^2 - x^{\\top}NN^{\\top}x + x^{\\top}Qx = (u + N^{\\top}x)^2 + x^{\\top}(Q - NN^{\\top})x\n$$\n我们定义一个新的控制变量 $\\tilde{u}(t)$ 和一个反馈增益矩阵 $K$ 如下：\n$$\nK = r^{-1}N^{\\top} = 1^{-1} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}^{\\top} = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n$$\n\\tilde{u}(t) = u(t) + Kx(t) = u(t) + N^{\\top}x(t)\n$$\n这意味着控制重参数化为 $u(t) = \\tilde{u}(t) - Kx(t)$。\n现在，积分项可以写成 $\\tilde{u}(t)$ 和等效状态权重矩阵 $Q_{\\mathrm{eff}}$ 的形式：\n$$\nL(x, u) = \\tilde{u}(t)^2 + x(t)^{\\top} Q_{\\mathrm{eff}} x(t)\n$$\n其中\n$$\nQ_{\\mathrm{eff}} = Q - r^{-1}NN^{\\top} = Q - NN^{\\top}\n$$\n我们计算 $NN^{\\top}$：\n$$\nNN^{\\top} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n因此，等效状态权重矩阵为：\n$$\nQ_{\\mathrm{eff}} = \\begin{pmatrix} -1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix}\n$$\n\n### 第二部分：控制重参数化下的动力学\n\n我们将控制重参数化 $u(t) = \\tilde{u}(t) - Kx(t)$ 代入状态动力学 SDE 中：\n$$\ndx(t) = (A x(t) + B(\\tilde{u}(t) - Kx(t))) dt + \\Sigma dW(t)\n$$\n$$\ndx(t) = ((A - BK)x(t) + B\\tilde{u}(t)) dt + \\Sigma dW(t)\n$$\n状态过程 $x(t)$ 的所得漂移矩阵是闭环矩阵 $A_{CL} = A - BK$。我们来计算这个矩阵：\n$$\nBK = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\nA_{CL} = A - BK = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n所以，用新控制 $\\tilde{u}(t)$ 表示的动力学由漂移矩阵 $A_{CL} = \\begin{pmatrix} 0  0 \\\\ 0  -1 \\end{pmatrix}$ 控制。\n\n### 第三部分：适定性分析\n\n通过前几部分的变换，问题等价于最小化\n$$\nJ(\\tilde{u}) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( \\tilde{u}(t)^2 + x(t)^{\\top} Q_{\\mathrm{eff}} x(t) \\right) dt \\right]\n$$\n其约束动力学为\n$$\ndx(t) = (A_{CL} x(t) + B\\tilde{u}(t)) dt + \\Sigma dW(t), \\quad x(0)=0.\n$$\n我们将动力学和成本用 $x(t) = \\begin{pmatrix} x_1(t)  x_2(t) \\end{pmatrix}^{\\top}$ 的分量写出。\n动力学方程为：\n$$\nd\\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} = \\left( \\begin{pmatrix} 0  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\tilde{u}(t) \\right) dt + \\begin{pmatrix} \\sigma  0 \\\\ 0  0 \\end{pmatrix} dW(t)\n$$\n这可以解耦为两个独立的标量 SDE：\n$$\ndx_1(t) = \\tilde{u}(t) dt + \\sigma dW_1(t)\n$$\n$$\ndx_2(t) = -x_2(t) dt\n$$\n成本积分项为：\n$$\n\\tilde{u}(t)^2 + x(t)^{\\top} \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix} x(t) = \\tilde{u}(t)^2 - 2x_1(t)^2 + x_2(t)^2\n$$\n根据 $x_2(t)$ 的 SDE 和初始条件 $x_2(0)=0$，唯一解为对所有 $t \\geq 0$ 都有 $x_2(t) = 0$。这意味着成本泛函中的 $x_2(t)^2$ 项恒为零。\n问题简化为最小化：\n$$\nJ(\\tilde{u}) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( \\tilde{u}(t)^2 - 2x_1(t)^2 \\right) dt \\right]\n$$\n约束条件为 $dx_1(t) = \\tilde{u}(t) dt + \\sigma dW_1(t)$，且 $x_1(0)=0$。\n\n为了确定问题是否适定，我们测试 $J(u)$ 的下确界是否可以被驱动到 $-\\infty$。我们可以通过选择一个特定的容许控制并评估其成本来研究这一点。$x_1(t)^2$ 项的负号表明，使 $x_1(t)$ 的幅值变大会降低成本。\n\n考虑对新控制做最简单的选择：对所有 $t \\geq 0$，$\\tilde{u}(t) = 0$。\n这对应于原始的反馈控制律 $u(t) = -Kx(t) = -x_1(t)$。\n首先，我们验证该控制是容许的。$x_1(t)$ 的动力学变为：\n$$\ndx_1(t) = \\sigma dW_1(t), \\quad x_1(0)=0\n$$\n解为 $x_1(t) = \\sigma W_1(t)$。\n控制为 $u(t) = -x_1(t) = -\\sigma W_1(t)$。为验证容许性，我们必须检查对于任何有限的 $T0$，是否有 $\\mathbb{E}\\left[\\int_{0}^{T} u(t)^2 dt\\right]  \\infty$。\n$$\n\\mathbb{E}\\left[\\int_{0}^{T} u(t)^2 dt\\right] = \\mathbb{E}\\left[\\int_{0}^{T} (-\\sigma W_1(t))^2 dt\\right]\n$$\n根据非负函数的 Fubini 定理，我们可以交换期望和积分的次序：\n$$\n\\mathbb{E}\\left[\\int_{0}^{T} u(t)^2 dt\\right] = \\int_{0}^{T} \\sigma^2 \\mathbb{E}[W_1(t)^2] dt\n$$\n标准一维维纳过程的二阶矩是 $\\mathbb{E}[W_1(t)^2] = t$。\n$$\n\\int_{0}^{T} \\sigma^2 t\\, dt = \\sigma^2 \\left[\\frac{t^2}{2}\\right]_0^T = \\frac{1}{2}\\sigma^2 T^2\n$$\n由于对于任何有限的 $T$，该值都是有限的，所以控制 $u(t)=-x_1(t)$（或等价地 $\\tilde{u}(t)=0$）是容许的。\n\n现在，我们计算该控制下的成本 $J$：\n$$\nJ(u) = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( \\tilde{u}(t)^2 - 2x_1(t)^2 \\right) dt \\right] = \\mathbb{E}\\left[\\int_{0}^{\\infty} \\left( 0^2 - 2(\\sigma W_1(t))^2 \\right) dt \\right]\n$$\n再次根据 Fubini 定理（因为期望积分项是非正的）：\n$$\nJ(u) = \\int_{0}^{\\infty} -2 \\sigma^2 \\mathbb{E}[W_1(t)^2] dt = \\int_{0}^{\\infty} -2 \\sigma^2 t\\, dt\n$$\n这个积分是发散的：\n$$\n\\int_{0}^{\\infty} -2 \\sigma^2 t\\, dt = -2\\sigma^2 \\lim_{T \\to \\infty} \\left[\\frac{t^2}{2}\\right]_0^T = -2\\sigma^2 \\lim_{T \\to \\infty} \\frac{T^2}{2} = -\\infty\n$$\n既然我们构造了一个容许控制，使得性能指标 $J(u)$ 为 $-\\infty$，那么在所有容许控制的集合上，$J(u)$ 的下确界必然为 $-\\infty$。\n因此，该问题是不适定的。\n\n### 结论\n\n该问题是不适定的，因为成本泛函的下确界是 $-\\infty$。这是因为配方过程得到的等效状态权重矩阵 $Q_{\\mathrm{eff}}$ 不是半正定的。$Q_{\\mathrm{eff}}$ 的负特征值对应于一个可控的状态分量，这使得可以通过一个利用这种不稳定性的容许控制策略将成本驱动至 $-\\infty$。因此，下确界的值为 $-\\infty$。", "answer": "$$\n\\boxed{-\\infty}\n$$", "id": "2984739"}]}