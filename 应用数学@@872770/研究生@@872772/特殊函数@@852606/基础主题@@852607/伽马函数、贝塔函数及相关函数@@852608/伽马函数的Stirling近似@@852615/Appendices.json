{"hands_on_practices": [{"introduction": "斯特林公式是组合数学中的一个强大工具，特别适用于处理大数。当直接计算如二项式系数 $\\binom{m}{k}$ 这样包含阶乘的表达式变得不切实际时，斯特林近似提供了一个优雅且准确的估算方法。这个练习 [@problem_id:29074] 将引导你直接应用该公式，来为一个特定形式的二项式系数推导出一个简洁的近似表达式，从而掌握其核心应用。", "problem": "二项式系数 $\\binom{m}{k}$ 表示从一个包含 $m$ 个元素的集合中选取 $k$ 个元素的方法数，其定义为：\n$$\n\\binom{m}{k} = \\frac{m!}{k!(m-k)!}\n$$\n其中 $m!$ 表示 $m$ 的阶乘。当整数 $x$ 的值很大时，阶乘可以用斯特林公式近似：\n$$\nx! \\approx \\sqrt{2\\pi x} \\left(\\frac{x}{e}\\right)^x\n$$\n利用此信息，推导二项式系数 $\\binom{3n}{n}$ 在 $n$ 为大整数时的简化近似表达式。最终表达式应用 $n$、$\\pi$ 和其他数值常数来表示。", "solution": "我们从精确表达式出发：\n$$\n\\binom{3n}{n}=\\frac{(3n)!}{n!\\,(2n)!}\\,.\n$$\n当 $x$ 很大时，斯特林公式为：\n$$\nx!\\approx\\sqrt{2\\pi x}\\,\\bigl(\\tfrac{x}{e}\\bigr)^x.\n$$\n因此\n$$\n(3n)!\\approx\\sqrt{2\\pi\\,3n}\\,\\bigl(\\tfrac{3n}{e}\\bigr)^{3n},\\quad\nn!\\approx\\sqrt{2\\pi n}\\,\\bigl(\\tfrac{n}{e}\\bigr)^n,\\quad\n(2n)!\\approx\\sqrt{2\\pi\\,2n}\\,\\bigl(\\tfrac{2n}{e}\\bigr)^{2n}.\n$$\n代入可得\n$$\n\\binom{3n}{n}\\approx\n\\frac{\\sqrt{2\\pi\\,3n}\\,(3n/e)^{3n}}\n{\\bigl[\\sqrt{2\\pi n}\\,(n/e)^n\\bigl]\\,\n\\bigl[\\sqrt{2\\pi\\,2n}\\,(2n/e)^{2n}\\bigr]}\n=\\frac{\\sqrt{2\\pi\\,3n}}{\\sqrt{2\\pi n}\\,\\sqrt{2\\pi\\,2n}}\n\\frac{(3n)^{3n}}{n^n\\,(2n)^{2n}}.\n$$\n计算前置因子：\n$$\n\\frac{\\sqrt{2\\pi\\,3n}}{\\sqrt{2\\pi n}\\,\\sqrt{2\\pi\\,2n}}\n=\\frac{\\sqrt{6\\pi n}}{2\\pi n\\sqrt2}\n=\\frac{\\sqrt3}{2\\sqrt{\\pi n}}.\n$$\n以及幂律比：\n$$\n\\frac{(3n)^{3n}}{n^n\\,(2n)^{2n}}\n=\\frac{3^{3n}n^{3n}}{n^n\\,2^{2n}n^{2n}}\n=\\frac{3^{3n}}{2^{2n}}\n=\\Bigl(\\frac{27}{4}\\Bigr)^n.\n$$\n合并后得到 $n$ 很大时的近似式：\n$$\n\\binom{3n}{n}\\sim\\frac{\\sqrt3}{2\\sqrt{\\pi n}}\\Bigl(\\frac{27}{4}\\Bigr)^n.\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2\\sqrt{\\pi n}}\\Bigl(\\frac{27}{4}\\Bigr)^n}$$", "id": "29074"}, {"introduction": "斯特林近似的威力不仅限于标准的阶乘函数 $n!$。通过巧妙的代数转换，我们也可以用它来分析其他类似阶乘的函数，例如在物理和数学中常见的双阶乘。这个练习 [@problem_id:776751] 要求你首先将奇数双阶乘 $(2n-1)!!$ 表示为标准阶乘的形式，然后再应用斯特林公式，这不仅能巩固你对该公式的运用，还能提升你解决问题的灵活性。", "problem": "一个正奇数 $2n-1$ 的奇数双阶乘定义为从 $1$ 到 $2n-1$ 的所有奇数的乘积：\n$$\n(2n-1)!! = (2n-1) \\cdot (2n-3) \\cdots 3 \\cdot 1\n$$\n这个量出现在数学和物理的各种情境中，例如在某些函数的泰勒级数系数中，或在计算高斯积分时。\n\n欧拉伽马函数 $\\Gamma(z)$ 是一个强大的工具，用于分析当自变量很大时这类类阶乘积的行为。对于 $\\text{Re}(z)  0$，它由积分定义：\n$$\n\\Gamma(z) = \\int_0^\\infty t^{z-1} e^{-t} dt\n$$\n伽马函数推广了阶乘，满足递推关系 $\\Gamma(z+1) = z\\Gamma(z)$，对于整数自变量，这导致 $\\Gamma(n+1) = n!$。对于非整数自变量，一个关键值是 $\\Gamma(1/2) = \\sqrt{\\pi}$。\n\n对于大的 $|z|$ 且 $|\\arg(z)|  \\pi$，伽马函数有著名的斯特林近似：\n$$\n\\Gamma(z) \\sim \\sqrt{2\\pi} z^{z-1/2} e^{-z}\n$$\n其中符号 $\\sim$ 表示渐近等价，意味着当 $|z| \\to \\infty$ 时，两边的比值趋近于 $1$。\n\n你的任务是找到当整数 $n$ 很大时，奇数双阶乘 $(2n-1)!!$ 的主阶渐近表达式。用 $n$ 和基本数学常数表示你的答案。", "solution": "1. 奇数双阶乘可以用普通阶乘表示：\n$$\n(2n-1)!! \\;=\\;\\frac{(2n)!}{2^n\\,n!}.\n$$\n\n2. 对于大的 $m$，斯特林近似为\n$$\nm! \\sim \\sqrt{2\\pi\\,m}\\;\\Bigl(\\frac{m}{e}\\Bigr)^{m}.\n$$\n\n3. 将此应用于 $(2n)!$ 和 $n!$：\n$$\n(2n)! \\sim \\sqrt{2\\pi\\,2n}\\;\\Bigl(\\frac{2n}{e}\\Bigr)^{2n}, \n\\qquad\nn! \\sim \\sqrt{2\\pi\\,n}\\;\\Bigl(\\frac{n}{e}\\Bigr)^{n}.\n$$\n\n4. 代入 $(2n-1)!!$ 的表达式中：\n$$\n(2n-1)!! \n\\sim\n\\frac{\\sqrt{2\\pi\\,2n}\\,(2n/e)^{2n}}{2^n\\;\\sqrt{2\\pi\\,n}\\,(n/e)^n}\n=\n\\frac{\\sqrt{4\\pi n}\\;2^{2n}n^{2n}e^{-2n}}{2^n\\,\\sqrt{2\\pi n}\\;n^n e^{-n}}\n=\n\\sqrt{2}\\;2^n n^n e^{-n}.\n$$\n\n5. 将 $2^n n^n=(2n)^n$ 改写以得到主阶渐近式：\n$$\n(2n-1)!!\\sim \\sqrt{2}\\,\\Bigl(\\frac{2n}{e}\\Bigr)^{n}.\n$$", "answer": "$$\\boxed{\\sqrt{2}\\,\\left(\\frac{2n}{e}\\right)^n}$$", "id": "776751"}, {"introduction": "一个好的近似公式不仅要有效，我们还希望了解它的精确度。斯特林公式实际上是一个渐近级数的第一项，通过包含更多项，我们可以得到更精确的近似并量化其误差。这个练习 [@problem_id:776750] 深入探讨了斯特林近似的误差分析，要求你使用更高阶的修正项来确定近似的相对误差何时低于一个特定阈值，这对于理解近似的“优良”程度至关重要。", "problem": "对于大整数 $n$，阶乘函数的渐近展开由斯特林级数给出：\n$$n! \\sim \\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O\\left(\\frac{1}{n^3}\\right)\\right)$$\n该展开可用于近似相关的组合量。考虑中心二项式系数，定义为 $C(n) = \\binom{2n}{n}$。使用斯特林公式的首项对 $C(n)$ 进行的最简单近似为 $A_0(n) = \\frac{4^n}{\\sqrt{\\pi n}}$。\n\n通过包含级数的下一项，可以构造一个更精确的近似，其形式为 $A_1(n) = A_0(n) \\left(1 + \\frac{k}{n}\\right)$，其中 $k$ 为某个常数。因此，对于较大的 $n$，简单近似 $A_0(n)$ 的主阶相对误差由 $E(n) = \\frac{C(n) - A_0(n)}{A_0(n)} \\sim \\frac{k}{n}$ 给出。\n\n确定最小的正整数 $n$，使得这个主阶相对误差的绝对值 $|k/n|$ 首次低于容差 $\\epsilon = \\frac{1}{900}$。", "solution": "问题要求满足条件 $|k/n|  \\epsilon$ 的最小正整数 $n$，其中 $k$ 是中心二项式系数 $\\binom{2n}{n}$ 的精确近似中的一个常数，且 $\\epsilon = 1/900$。\n\n首先，我们必须确定常数 $k$。中心二项式系数由以下公式给出：\n$$C(n) = \\binom{2n}{n} = \\frac{(2n)!}{(n!)^2}$$\n我们使用已知的斯特林级数来表示 $n!$：\n$$n! \\sim \\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O(n^{-3})\\right)$$\n我们通过将 $n$ 替换为 $2n$ 来求分子 $(2n)!$ 的展开式：\n$$(2n)! \\sim \\sqrt{2\\pi (2n)} \\left(\\frac{2n}{e}\\right)^{2n} \\left(1 + \\frac{1}{12(2n)} + \\frac{1}{288(2n)^2} + O(n^{-3})\\right)$$\n$$(2n)! \\sim \\sqrt{4\\pi n} \\cdot 4^n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{24n} + \\frac{1}{1152n^2} + O(n^{-3})\\right)$$\n\n接下来，我们求分母 $(n!)^2$ 的展开式：\n$$(n!)^2 \\sim \\left[ \\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O(n^{-3})\\right) \\right]^2$$\n$$(n!)^2 \\sim 2\\pi n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + O(n^{-3})\\right)^2$$\n我们展开平方项，保留到 $1/n^2$ 阶的项：\n$$\\left(1 + \\frac{1}{12n} + \\frac{1}{288n^2} + \\dots\\right)^2 = 1^2 + 2(1)\\left(\\frac{1}{12n}\\right) + \\left[ \\left(\\frac{1}{12n}\\right)^2 + 2(1)\\left(\\frac{1}{288n^2}\\right) \\right] + \\dots$$\n$$= 1 + \\frac{1}{6n} + \\left(\\frac{1}{144n^2} + \\frac{2}{288n^2}\\right) + \\dots = 1 + \\frac{1}{6n} + \\frac{1}{72n^2} + O(n^{-3})$$\n所以，分母是：\n$$(n!)^2 \\sim 2\\pi n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{6n} + \\frac{1}{72n^2} + O(n^{-3})\\right)$$\n\n现在，我们计算 $C(n)$ 的比率：\n$$C(n) \\sim \\frac{\\sqrt{4\\pi n} \\cdot 4^n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{24n} + \\frac{1}{1152n^2} + \\dots\\right)}{2\\pi n \\left(\\frac{n}{e}\\right)^{2n} \\left(1 + \\frac{1}{6n} + \\frac{1}{72n^2} + \\dots\\right)}$$\n前置因子简化为主阶近似 $A_0(n)$：\n$$\\frac{\\sqrt{4\\pi n} \\cdot 4^n}{2\\pi n} = \\frac{2\\sqrt{\\pi n} \\cdot 4^n}{2\\pi n} = \\frac{4^n}{\\sqrt{\\pi n}} = A_0(n)$$\n剩下的部分是修正因子：\n$$C(n) \\sim A_0(n) \\cdot \\frac{1 + \\frac{1}{24n} + O(n^{-2})}{1 + \\frac{1}{6n} + O(n^{-2})}$$\n为了找到大 $n$ 时的行为，我们使用几何级数展开 $(1+x)^{-1} \\approx 1 - x + x^2 - \\dots$。令 $x = \\frac{1}{6n} + O(n^{-2})$。\n$$\\frac{1}{1 + \\frac{1}{6n} + O(n^{-2})} = 1 - \\frac{1}{6n} + O(n^{-2})$$\n将此与分子的级数相乘：\n$$\\left(1 + \\frac{1}{24n} + O(n^{-2})\\right) \\left(1 - \\frac{1}{6n} + O(n^{-2})\\right) = 1 + \\frac{1}{24n} - \\frac{1}{6n} + O(n^{-2})$$\n$$= 1 + \\left(\\frac{1}{24} - \\frac{4}{24}\\right)\\frac{1}{n} + O(n^{-2}) = 1 - \\frac{3}{24n} + O(n^{-2}) = 1 - \\frac{1}{8n} + O(n^{-2})$$\n因此，$C(n)$ 的精确近似为：\n$$C(n) \\sim \\frac{4^n}{\\sqrt{\\pi n}} \\left(1 - \\frac{1}{8n}\\right)$$\n将其与指定形式 $A_1(n) = A_0(n) \\left(1 + \\frac{k}{n}\\right)$ 进行比较，我们确定常数 $k = -1/8$。\n\n主阶相对误差为 $E(n) \\sim k/n = -1/(8n)$。我们需要找到最小的正整数 $n$，使得该误差的绝对值小于 $\\epsilon$。\n$$|E(n)| \\approx \\left|-\\frac{1}{8n}\\right| = \\frac{1}{8n}$$\n条件是：\n$$\\frac{1}{8n}  \\epsilon$$\n解出 $n$：\n$$n > \\frac{1}{8\\epsilon}$$\n问题指定容差为 $\\epsilon = 1/900$。代入此值：\n$$n > \\frac{1}{8 \\cdot (1/900)} = \\frac{900}{8}$$\n$$n > \\frac{225}{2} = 112.5$$\n由于 $n$ 必须是整数，满足此条件的最小整数 $n$ 是 $n=113$。", "answer": "$$\\boxed{113}$$", "id": "776750"}]}