{"hands_on_practices": [{"introduction": "掌握theta函数恒等式通常需要巧妙地结合不同的关系式来计算特定值。第一个练习 [@problem_id:789760] 正是针对这项核心技能的基础训练。你将看到模变换性质和代数加法恒等式如何协同作用，从而确定一个theta常数之和的精确值。", "problem": "雅可比theta函数是一组特殊函数，出现在物理学和数学的许多领域，从数论到弦论。对于复变量 $z$ 和一个参数 $q$（称为nome），它通过 $q = e^{i\\pi\\tau}$ 与半周期比 $\\tau$ 相关联，其中 $\\mathrm{Im}(\\tau)>0$，theta函数由此定义。\n\n在本问题中，我们关注的是两个在 $z=0$ 处求值的雅可比theta函数，其中nome $q$ 为实数且 $q \\in (0, 1)$。它们的级数定义如下：\n$$ \\theta_3(0, q) = \\sum_{n=-\\infty}^{\\infty} q^{n^2} $$\n$$ \\theta_4(0, q) = \\sum_{n=-\\infty}^{\\infty} (-1)^n q^{n^2} $$\n\n这些函数满足大量的恒等式。为解决此问题，你可以使用以下已确立的关系式，这些关系式不加证明地给出：\n1.  一个类加法恒等式：\n    $$ \\theta_3(0,q) + \\theta_4(0,q) = 2\\theta_3(0,q^4) $$\n2.  一个平方恒等式：\n    $$ \\theta_3(0,q)^2 + \\theta_4(0,q)^2 = 2\\theta_3(0,q^2)^2 $$\n3.  $\\theta_3$ 的模变换性质，对 $t>0$ 成立：\n    $$ \\theta_3(0, e^{-\\pi t}) = \\frac{1}{\\sqrt{t}} \\theta_3(0, e^{-\\pi/t}) $$\n4.  一个与欧拉伽玛函数 $\\Gamma(x)$ 相关的已知特殊值：\n    $$ \\theta_3(0, e^{-\\pi}) = \\frac{\\pi^{1/4}}{\\Gamma(3/4)} $$\n\n你的任务是利用这些性质求出表达式 $\\theta_3(0, e^{-\\pi/2}) + \\theta_4(0, e^{-\\pi/2})$ 的精确值。请将你的答案以单个闭式解析表达式的形式给出。", "solution": "1.  令 $q = e^{-\\pi/2}$。根据“类加法”恒等式\n\n$$\n\\theta_3(0,q)+\\theta_4(0,q)\n=2\\,\\theta_3\\!\\bigl(0,q^4\\bigr),\n$$\n\n我们有\n\n$$\nE\\equiv\\theta_3(0,e^{-\\pi/2})+\\theta_4(0,e^{-\\pi/2})\n=2\\,\\theta_3(0,e^{-2\\pi}).\n$$\n\n2.  根据模变换，令 $t=2$，\n\n$$\n\\theta_3(0,e^{-2\\pi})\n=\\frac1{\\sqrt{2}}\\;\\theta_3(0,e^{-\\pi/2}),\n$$\n\n所以\n\n$$\nE=2\\;\\frac1{\\sqrt{2}}\\;\\theta_3(0,e^{-\\pi/2})\n=\\sqrt{2}\\,\\theta_3(0,e^{-\\pi/2}).\n$$\n\n因此\n\n$$\n\\theta_3(0,e^{-\\pi/2})=\\frac{E}{\\sqrt2},\\qquad\n\\theta_4(0,e^{-\\pi/2})=E-\\frac{E}{\\sqrt2}\n=E\\Bigl(1-\\tfrac1{\\sqrt2}\\Bigr).\n$$\n\n3.  对于 $q=e^{-\\pi/2}$，平方恒等式给出：\n\n$$\n\\theta_3(0,q)^2+\\theta_4(0,q)^2\n=2\\,\\theta_3(0,q^2)^2\n\\;\\Longrightarrow\\;\n\\Bigl(\\tfrac{E}{\\sqrt2}\\Bigr)^2\n+\\Bigl(E(1-\\tfrac1{\\sqrt2})\\Bigr)^2\n=2\\,\\theta_3(0,e^{-\\pi})^2.\n$$\n\n计算 $(1-1/\\sqrt2)^2=3/2-\\sqrt2$，所以\n\n$$\nE^2\\Bigl[\\tfrac12+(3/2-\\sqrt2)\\Bigr]\n=2\\,\\theta_3(0,e^{-\\pi})^2\n\\;\\Rightarrow\\;\nE^2(2-\\sqrt2)=2\\,\\theta_3(0,e^{-\\pi})^2\n\\;\\Rightarrow\\;\nE^2=(2+\\sqrt2)\\,\\theta_3(0,e^{-\\pi})^2.\n$$\n\n4.  使用特殊值 \n$\\theta_3(0,e^{-\\pi})=\\pi^{1/4}/\\Gamma(3/4)$，\n我们得到\n\n$$\nE^2=(2+\\sqrt2)\\,\\frac{\\pi^{1/2}}{\\Gamma(3/4)^2}\n\\;\\Longrightarrow\\;\nE=\\frac{\\pi^{1/4}\\,\\sqrt{2+\\sqrt2}}{\\Gamma(3/4)}.\n$$", "answer": "$$\\boxed{\\frac{\\pi^{1/4}\\sqrt{2+\\sqrt{2}}}{\\Gamma\\bigl(\\tfrac34\\bigr)}}$$", "id": "789760"}, {"introduction": "Theta函数并非孤立的数学对象，它们是连接椭圆积分和模形式理论的关键桥梁。这个练习 [@problem_id:789855] 旨在揭示这种深刻的联系，要求你计算一个具有负nome的theta常数。其求解关键在于将theta常数与第一类完全椭圆积分联系起来，展示了一种强大的计算方法。", "problem": "Jacobi theta函数是一组在物理学和数学的许多领域中出现的特殊函数。第三theta函数 $\\theta_3(z, q)$ 由以下级数定义\n$$ \\theta_3(z, q) = \\sum_{n=-\\infty}^{\\infty} q^{n^2} e^{2niz} $$\n其中 $z$ 是一个复变量，而nome $q$ 是一个满足 $|q| < 1$ 的复数。当 $z=0$ 时，该函数被称为theta常数，记作 $\\theta_3(0, q)$。关键在于，通过nome $q=e^{i\\pi\\tau}$（其中 $\\mathrm{Im}(\\tau)>0$），theta常数与模形式和椭圆函数相关联。\n\ntheta常数满足许多恒等式。其中一个恒等式将nome为 $q$ 的theta常数与nome为 $-q$ 的theta常数联系起来：\n$$ \\theta_3(0, -q) = \\theta_4(0, q) $$\n其中 $\\theta_4(0, q) = \\sum_{n=-\\infty}^{\\infty} (-1)^n q^{n^2}$。\n\n您的任务是计算当nome为负值 $q = -e^{-\\pi\\sqrt{2}}$ 时，theta常数 $\\theta_3(0, q)$ 的值。\n\n为此，您可以不加证明地使用第一类完全椭圆积分 $K(k) = \\int_0^{\\pi/2} \\frac{d\\theta}{\\sqrt{1-k^2\\sin^2\\theta}}$ 在一个特定奇异模数下的值：\n$$ K(\\sqrt{2}-1) = \\frac{\\Gamma\\left(\\frac{1}{8}\\right)\\Gamma\\left(\\frac{3}{8}\\right)}{2^{9/4}\\sqrt{\\pi}} $$\n其中 $\\Gamma(x)$ 是 Euler Gamma 函数。", "solution": "1. 相关恒等式：\n\n- 对于负nome的theta常数，其关系为\n$$\\theta_3(0,-q)=\\theta_4(0,q)\\,. $$\n\n- 对于椭圆模数 $k$ 和互补模数 $k'=\\sqrt{1-k^2}$，我们有\n$$q=e^{-\\pi K'(k)/K(k)},$$\n并且theta常数满足\n$$\\theta_3(0,q)=\\sqrt{\\frac{2\\,K(k)}\\pi},\\qquad\n\\theta_4(0,q)=\\theta_3(0,q)\\,\\sqrt{k'}\\,. $$\n\n2. 我们设\n$$q=-e^{-\\pi\\sqrt2}\\quad\\Longrightarrow\\quad -q=e^{-\\pi\\sqrt2}\\,. $$\n奇异模数 $k=\\sqrt2-1$ 满足 $K'(k)/K(k)=\\sqrt2$，所以确实有\n$$-q=e^{-\\pi K'(k)/K(k)}\\,. $$\n\n3. 因此\n$$\\theta_3(0,-e^{-\\pi\\sqrt2})\n=\\theta_4\\bigl(0,e^{-\\pi\\sqrt2}\\bigr)\n=\\sqrt{\\frac{2\\,K(k)}\\pi}\\,\\sqrt{k'}\\,. $$\n\n4. 我们代入\n$$K(k)=\\frac{\\Gamma(\\tfrac18)\\,\\Gamma(\\tfrac38)}{2^{9/4}\\sqrt\\pi}, \n\\quad k'=\\sqrt{1-(\\sqrt2-1)^2}\n=\\sqrt{2(\\sqrt2-1)}\\,. $$\n\n5. 分步计算：\n$$\\frac{2\\,K(k)}\\pi\n=\\frac{2}{\\pi}\\,\\frac{\\Gamma(\\tfrac18)\\,\\Gamma(\\tfrac38)}{2^{9/4}\\sqrt\\pi}\n=2^{-5/4}\\,\\frac{\\Gamma(\\tfrac18)\\,\\Gamma(\\tfrac38)}{\\pi^{3/2}},$$\n$$\\sqrt{\\frac{2\\,K(k)}\\pi}\n=2^{-5/8}\\,\\frac{\\sqrt{\\Gamma(\\tfrac18)\\,\\Gamma(\\tfrac38)}}{\\pi^{3/4}},$$\n$$\\sqrt{k'}=(2(\\sqrt2-1))^{1/4}\n\\;=\\;2^{1/4}\\,(\\sqrt2-1)^{1/4}\\,. $$\n\n6. 合并：\n$$\\theta_3(0,-e^{-\\pi\\sqrt2})\n=2^{-5/8}\\,\\frac{\\sqrt{\\Gamma(\\tfrac18)\\,\\Gamma(\\tfrac38)}}{\\pi^{3/4}}\n\\;\\times\\;2^{1/4}(\\sqrt2-1)^{1/4}\n=2^{-3/8}(\\sqrt2-1)^{1/4}\\,\n\\frac{\\sqrt{\\Gamma(\\tfrac18)\\,\\Gamma(\\tfrac38)}}{\\pi^{3/4}}\\,. $$", "answer": "$$\\boxed{2^{-3/8}(\\sqrt2-1)^{1/4}\\,\\frac{\\sqrt{\\Gamma\\bigl(\\tfrac18\\bigr)\\,\\Gamma\\bigl(\\tfrac38\\bigr)}}{\\pi^{3/4}}}$$", "id": "789855"}, {"introduction": "Theta函数最优雅的应用之一是在数论中充当生成函数。这个练习 [@problem_id:789911] 通过使用theta级数的乘积来解决一个经典的丢番图方程，从而展示了这种威力。通过解释级数展开式的系数，你将能够直接确定形如 $x^2 + 2y^2 = N$ 方程的整数解个数。", "problem": "雅可比 theta 函数 $\\theta_3(z, q)$ 由以下级数定义\n$$ \\theta_3(z, q) = \\sum_{n=-\\infty}^{\\infty} q^{n^2} e^{2niz} $$\n当 $z=0$ 时，我们得到级数 $\\theta_3(0, q) = \\sum_{n=-\\infty}^{\\infty} q^{n^2}$。这个级数可以看作是将一个整数写成一个平方和的方法数的生成函数。\n\n考虑两个这样的级数的乘积 $\\theta_3(0, q) \\theta_3(0, q^2)$。如果我们展开这个乘积，我们得到\n$$ \\theta_3(0, q) \\theta_3(0, q^2) = \\left(\\sum_{x=-\\infty}^{\\infty} q^{x^2}\\right) \\left(\\sum_{y=-\\infty}^{\\infty} q^{2y^2}\\right) = \\sum_{x, y \\in \\mathbb{Z}} q^{x^2+2y^2} = \\sum_{N=0}^{\\infty} r'_2(N) q^N $$\n其中 $r'_2(N)$ 是丢番图方程 $x^2+2y^2=N$ 的整数解 $(x,y)$ 的数量。\n\n模形式理论中的一个非平凡恒等式将此乘积与一个兰伯特级数联系起来：\n$$ \\theta_3(0, q) \\theta_3(0, q^2) = 1 + 2 \\sum_{n=1}^{\\infty} \\left(\\frac{-8}{n}\\right) \\frac{q^n}{1-q^n} $$\n其中 $\\left(\\frac{k}{n}\\right)$ 是雅可比符号。对于一个奇整数 $n > 1$，其素数分解为 $n = p_1^{a_1} \\cdots p_k^{a_k}$，雅可比符号定义为 $\\left(\\frac{k}{n}\\right) = \\left(\\frac{k}{p_1}\\right)^{a_1} \\cdots \\left(\\frac{k}{p_k}\\right)^{a_k}$，其中 $\\left(\\frac{k}{p}\\right)$ 是勒让德符号。我们也定义 $\\left(\\frac{k}{1}\\right)=1$。如果 $\\gcd(k,n) > 1$，则该符号为 0。对于奇素数 $p$，您可以使用以下性质：\n- $\\left(\\frac{ab}{p}\\right) = \\left(\\frac{a}{p}\\right)\\left(\\frac{b}{p}\\right)$ (及其对奇合数分母 $n$ 的推广)\n- $\\left(\\frac{-1}{p}\\right) = (-1)^{(p-1)/2}$\n- $\\left(\\frac{2}{p}\\right) = (-1)^{(p^2-1)/8}$\n\n使用所提供的恒等式，确定方程 $x^2 + 2y^2 = 17$ 的整数解的数量。请用一个整数表示你的答案。", "solution": "1. 我们按系数展开使用兰伯特级数恒等式。由\n$$\\theta_3(0,q)\\,\\theta_3(0,q^2)\n=1+2\\sum_{n=1}^\\infty\\Bigl(\\tfrac{-8}{n}\\Bigr)\\frac{q^n}{1-q^n}\n=1+2\\sum_{n=1}^\\infty\\sum_{k=1}^\\infty\\Bigl(\\tfrac{-8}{n}\\Bigr)q^{nk},$$\n对于 $N>0$，$q^N$ 的系数是\n$$r'_2(N)=2\\sum_{d\\mid N}\\Bigl(\\tfrac{-8}{d}\\Bigr).$$\n\n2. 对于 $N=17$，正因数是 $d=1,17$。因此\n$$r'_2(17)\n=2\\Bigl[\\Bigl(\\tfrac{-8}{1}\\Bigr)+\\Bigl(\\tfrac{-8}{17}\\Bigr)\\Bigr].$$\n我们有 $\\bigl(\\tfrac{-8}{1}\\bigr)=1$。对于模 17 的雅可比符号，\n$$\\Bigl(\\tfrac{-8}{17}\\Bigr)\n=\\Bigl(\\tfrac{-1}{17}\\Bigr)\\Bigl(\\tfrac{8}{17}\\Bigr)\n=(-1)^{(17-1)/2}\\,\\bigl(\\tfrac{2}{17}\\bigr)^3\n=1\\cdot\\bigl((-1)^{(17^2-1)/8}\\bigr)^3\n=1\\cdot1^3\n=1.$$\n\n3. 因此\n$$r'_2(17)\n=2\\,(1+1)\n=4.$$", "answer": "$$\\boxed{4}$$", "id": "789911"}]}