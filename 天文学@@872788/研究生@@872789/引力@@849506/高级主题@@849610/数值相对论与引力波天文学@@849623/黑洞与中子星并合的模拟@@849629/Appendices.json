{"hands_on_practices": [{"introduction": "在数值相对论模拟中，如何处理黑洞中心的奇点是一个核心挑战。一种强大的方法，即“移动奇点”法，通过共形变换将空间度量变得平坦，并选择特定的“号角形”切片，从而将物理奇点“推”到无穷远的固有距离处。这使得计算区域内没有奇点，极大地简化了数值演化。[@problem_id:906998] 这个练习将引导你为一个给定的号角形时空切片计算其径向固有距离，通过亲手计算来验证奇点是如何被有效地从计算网格中“移除”的。", "problem": "在时空的3+1分解中，数值模拟黑洞的一个常用技术是在每个时间切片上使用共形平坦的空间度规。对于一个质量为 $M$ 的不旋转黑洞，其空间几何可以在类球坐标 $(r, \\theta, \\phi)$ 中用线元来描述：\n$$ dl^2 = \\psi^4(r) (dr^2 + r^2 d\\Omega^2) $$\n其中 $d\\Omega^2 = d\\theta^2 + \\sin^2\\theta d\\phi^2$，而 $\\psi(r)$ 是共形因子。$\\psi(r)$ 的选择对应于 Schwarzschild 时空的特定切片。通过将中心奇点推至无穷远固有时距来避免它的切片被称为“小号”（trumpet）切片。\n\n位于坐标半径 $r_1$ 和 $r_2$ 的两个球面之间的固有径向距离 $L$ 由沿径向路径的固有时距元积分给出：\n$$ L = \\int_{r_1}^{r_2} \\psi^2(r) dr $$\n\n考虑一个包含中心质量 $M$ 的时空的假设性小号状切片，其共形因子的平方由下式给出\n$$ \\psi^2(r) = 1 + \\frac{M}{r} + \\frac{\\alpha M^2}{(r+\\beta M)^2} $$\n其中 $\\alpha$ 和 $\\beta$ 是给定的无量纲正常数。\n\n计算坐标半径 $r_1 = M$ 的球面和坐标半径 $r_2 = 2M$ 的球面之间的固有径向距离 $L$。用质量 $M$ 以及常数 $\\alpha$ 和 $\\beta$ 将你的答案表示为一个闭式表达式。", "solution": "1. 将积分写成和的形式：\n$$L=\\int_{M}^{2M}\\Bigl(1+\\frac{M}{r}+\\frac{\\alpha M^2}{(r+\\beta M)^2}\\Bigr)dr\n=\\int_{M}^{2M}dr+\\int_{M}^{2M}\\frac{M}{r}dr+\\int_{M}^{2M}\\frac{\\alpha M^2}{(r+\\beta M)^2}dr.$$\n\n2. 逐项积分：\n$$\\int dr=r,\\quad\n\\int\\frac{M}{r}dr=M\\ln r,\\quad\n\\int\\frac{\\alpha M^2}{(r+\\beta M)^2}dr\n=-\\frac{\\alpha M^2}{r+\\beta M}.$$\n\n3. 合并并计算从 $r=M$ 到 $r=2M$ 的定积分：\n$$L=\\Bigl[r+M\\ln r-\\frac{\\alpha M^2}{r+\\beta M}\\Bigr]_{M}^{2M}.$$\n当 $r=2M$ 时：\n$$2M+M\\ln(2M)-\\frac{\\alpha M^2}{2M+\\beta M}\n=2M+M(\\ln2+\\ln M)-\\frac{\\alpha M}{2+\\beta}.$$\n当 $r=M$ 时：\n$$M+M\\ln M-\\frac{\\alpha M^2}{M+\\beta M}\n=M+M\\ln M-\\frac{\\alpha M}{1+\\beta}.$$\n用上限定积分值减去下限定积分值：\n$$L=\\bigl(2M+M\\ln2+M\\ln M-\\frac{\\alpha M}{2+\\beta}\\bigr)\n-\\bigl(M+M\\ln M-\\frac{\\alpha M}{1+\\beta}\\bigr)$$\n$$=M+M\\ln2\n+\\alpha M\\Bigl(\\frac{1}{1+\\beta}-\\frac{1}{2+\\beta}\\Bigr)\n=M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr).$$", "answer": "$$\\boxed{M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr)}$$", "id": "906998"}, {"introduction": "致密天体并合过程，如中子星并合，不可避免地会产生激波等不连续结构。数值模拟必须使用能够精确捕捉这些特征而又不产生非物理振荡的数值格式。加权基本无振荡（WENO）格式是实现这一目标的主流高精度技术。[@problem_id:906993] 这个练习将让你深入WENO方法的核心，通过一个简化的激波模型，你将亲手计算其非线性权重如何根据解的光滑度自动调整，从而理解该格式在处理激波时的智能行为。", "problem": "在相对论天体物理现象（如黑洞或中子星并合）的数值模拟中，高阶、激波捕捉数值方法对于精确演化广义相对论流体动力学方程至关重要。加权基本无振荡（WENO）重构是一种广泛使用的技术，它可以在解的光滑区域实现高阶精度，同时避免在激波阵面等间断附近产生伪振荡。\n\n本问题涉及5阶精度的WENO格式（WENO5）。考虑一个均匀的一维网格，网格间距为 $\\Delta x$。在网格单元 $i$ 上的标量流体变量 $q$ 的网格平均值记为 $q_i$。WENO5 格式通过组合三个3阶多项式重构来重构网格单元 $i$ 和 $i+1$ 之间界面 $x_{i+1/2}$ 上的 $q$ 值，每个重构都基于一个不同的3网格子模板：$S_0 = \\{q_{i-2}, q_{i-1}, q_i\\}$，$S_1 = \\{q_{i-1}, q_i, q_{i+1}\\}$ 和 $S_2 = \\{q_i, q_{i+1}, q_{i+2}\\}$。\n\n重构值由以下加权平均给出：\n$$\nq_{i+1/2} = w_0 \\hat{q}_0 + w_1 \\hat{q}_1 + w_2 \\hat{q}_2\n$$\n其中 $\\hat{q}_k$ 是从第 $k$ 个子模板的重构多项式得到的值。\n非线性权重 $w_k$ 是WENO方法的核心。它们的计算公式为：\n$$\nw_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j} \\quad , \\quad \\alpha_k = \\frac{d_k}{(\\epsilon + \\beta_k)^p}\n$$\n此处，$d_k$ 是对于光滑解能够产生5阶精度的最优权重。对于界面 $x_{i+1/2}$，它们是 $d_0 = 1/10$，$d_1 = 6/10$ 和 $d_2 = 3/10$。参数 $p$ 通常设为 $p=2$。小常数 $\\epsilon > 0$ 用于防止除以零。量 $\\beta_k$ 是每个子模板的光滑度指示子，定义如下：\n$$\n\\begin{aligned}\n\\beta_0 = \\frac{13}{12}(q_{i-2} - 2q_{i-1} + q_i)^2 + \\frac{1}{4}(q_{i-2} - 4q_{i-1} + 3q_i)^2 \\\\\n\\beta_1 = \\frac{13}{12}(q_{i-1} - 2q_i + q_{i+1})^2 + \\frac{1}{4}(q_{i-1} - q_{i+1})^2 \\\\\n\\beta_2 = \\frac{13}{12}(q_i - 2q_{i+1} + q_{i+2})^2 + \\frac{1}{4}(3q_i - 4q_{i+1} + q_{i+2})^2\n\\end{aligned}\n$$\n这些指示子衡量解在每个模板上的振荡程度。在光滑区域，$\\beta_k$ 很小，且 $w_k \\approx d_k$。在间断附近，跨越间断的模板的 $\\beta_k$ 会变得很大，其相应的权重 $w_k$ 会变得非常小。\n\n**问题：**\n考虑一个5网格模板 $\\{i-2, i-1, i, i+1, i+2\\}$，它描述了相对论流体的静质量密度 $\\rho$ 穿过一个位于界面 $x_{i+1/2}$ 处的静止激波阵面的剖面。网格平均值由下式给出：\n$$\n\\rho_{i-2} = \\rho_L, \\quad \\rho_{i-1} = \\rho_L, \\quad \\rho_i = \\rho_L, \\quad \\rho_{i+1} = \\rho_R, \\quad \\rho_{i+2} = \\rho_R\n$$\n其中 $\\rho_L$ 和 $\\rho_R$ 分别是激波左侧和右侧的恒定密度状态。\n\n使用 $p=2$ 的WENO5公式，确定在界面 $x_{i+1/2}$ 处重构的非线性权重 $w_1$。你的最终答案应该是一个用 $\\rho_L$、$\\rho_R$ 和参数 $\\epsilon$ 表示的符号表达式。", "solution": "1. 定义 $\\Delta\\rho=\\rho_R-\\rho_L$。\n2. 计算光滑度指示子：\n   $$\n   \\beta_0=0,\\quad\n   \\beta_1=\\frac{4}{3}\\,\\Delta\\rho^2,\\quad\n   \\beta_2=\\frac{10}{3}\\,\\Delta\\rho^2.\n   $$\n3. 计算 $\\alpha_k$：\n   $$\n   \\alpha_0=\\frac{1/10}{(\\epsilon+0)^2}\n             =\\frac{1}{10\\,\\epsilon^2},\\quad\n   \\alpha_1=\\frac{6/10}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n             =\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2},\n   $$\n   $$\n   \\alpha_2=\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}.\n   $$\n4. 构造非线性权重 $w_1$：\n   $$\n   w_1\n   =\\frac{\\alpha_1}{\\alpha_0+\\alpha_1+\\alpha_2}\n   =\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}}\n         {\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n          +\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n          +\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}}.\n   $$\n5. 将 $\\Delta\\rho=\\rho_R-\\rho_L$ 代回。", "answer": "$$\\boxed{\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}\n{\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n+\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}\n+\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}}$$", "id": "906993"}, {"introduction": "相对论流体动力学模拟通常演化的是守恒量（如能量密度和动量密度），但物理分析和方程求解（如计算压力）则需要原始物理量（如静止质量密度和速度）。从守恒量恢复原始量的过程被称为“C2P”反演，这是每个时间步都必须执行的关键步骤。[@problem_id:906980] 此练习探讨了一种重要情况：当演化出的守恒量组合超出了物理可能性的范围时，反演会失败。通过推导这个失效判据，你将理解保证模拟鲁棒性的一个基本物理约束。", "problem": "在相对论流体的数值模拟中，一个关键步骤是“原始变量恢复”，即从代码演化的守恒变量中确定压强（$p$）和洛伦兹因子（$W$）等物理量。对于某些物理状态，这种恢复可能会失败，这表明模型失效或由于数值误差出现了非物理条件。\n\n考虑一种一维、非磁化的相对论辐射流体。这种流体由伽马律物态方程描述，该方程通过 $p = (\\Gamma-1)\\mathcal{E}$ 将其压强 $p$ 与其随动参考系能量密度 $\\mathcal{E}$ 联系起来，其中绝热指数 $\\Gamma$ 为常数且 $\\Gamma \\in (1, 2]$。广义相对论定义了以下实验室参考系守恒量（在单位制 $c=1$ 下）：\n- 守恒能量密度，$\\tau = W^2 (\\mathcal{E} + p) - p$。\n- 守恒动量密度，$S = W^2 (\\mathcal{E} + p) v$。\n\n此处，$W = (1-v^2)^{-1/2}$ 是流体的洛伦兹因子，$v$ 是其速度。\n\n原始变量恢复过程涉及从已知的守恒变量（$\\tau$, $S$）求解原始变量（$p$, $v$, $\\mathcal{E}$）。联立以上方程可得到一个关于洛伦兹因子 $W$ 的代数方程。可以证明，这是一个关于 $x = W^2$ 的二次方程。\n\n你的任务是找到一个判据，以一个包含比值 $S^2/\\tau^2$ 和绝热指数 $\\Gamma$ 的不等式来表示。当此判据成立时，关于 $x=W^2$ 的二次方程没有实数解。这种情况代表了一种无法从中恢复出一致的物理原始变量的状态。", "solution": "相关方程：\n$$p=(\\Gamma-1)\\mathcal{E},\\quad\n\\tau=W^2(\\mathcal{E}+p)-p,\\quad\nS=W^2(\\mathcal{E}+p)\\,v,\\quad\nW^2=x,\\quad v=\\sqrt{1-\\frac1x}.$$\n\n1. 写作 $\\mathcal{E}+p=\\Gamma\\mathcal{E}$ 和 $p=\\mathcal{E}(\\Gamma-1)$，于是\n$$\\tau=x\\,\\Gamma\\mathcal{E}-p,\\quad S=x\\,\\Gamma\\mathcal{E}\\,\\sqrt{1-\\frac1x}.$$\n\n2. 从 $\\tau$ 解出 $p$：\n$$\\tau=x\\,\\frac{\\Gamma p}{\\Gamma-1}-p\n\\;\\Longrightarrow\\;p\n=\\frac{\\tau(\\Gamma-1)}{\\Gamma x-(\\Gamma-1)}.$$\n\n3. 对 $S$ 平方：\n$$S^2\n=\\Bigl(x\\,\\frac{\\Gamma p}{\\Gamma-1}\\Bigr)^{2}\\Bigl(1-\\frac1x\\Bigr)\n=\\frac{\\Gamma^2\\,p^2}{(\\Gamma-1)^2}\\,x(x-1).$$\n\n4. 定义 $\\sigma=\\frac{S^2}{\\tau^2}$ 并代入 $p$：\n$$\\sigma\n=\\frac{\\Gamma^2\\,x(x-1)}{\\bigl(\\Gamma x-(\\Gamma-1)\\bigr)^2}.$$\n\n5. 展开以得到关于 $x$ 的二次方程：\n$$\\sigma\\bigl(\\Gamma x-(\\Gamma-1)\\bigr)^2=\\Gamma^2x(x-1)\n\\;\\Longrightarrow\\;\nA\\,x^2+B\\,x+C=0,$$\n其中\n$$A=\\Gamma^2(\\sigma-1),\\quad\nB=\\Gamma^2-2\\Gamma(\\Gamma-1)\\sigma,\\quad\nC=(\\Gamma-1)^2\\sigma.$$\n\n6. 计算判别式 $\\Delta=B^2-4AC$：\n\n$$\n\\Delta\n=\\Gamma^2\\Bigl[\\Gamma-2(\\Gamma-1)\\sigma\\Bigr]^2\n-4\\,\\Gamma^2(\\sigma-1)(\\Gamma-1)^2\\sigma\n=\\Gamma^2\\bigl[\\Gamma^2-4(\\Gamma-1)\\sigma\\bigr].\n$$\n\n\n7. 当 $\\Delta0$ 时无实数解：\n$$\\Gamma^2-4(\\Gamma-1)\\sigma0\n\\;\\Longrightarrow\\;\n\\sigma\\frac{\\Gamma^2}{4(\\Gamma-1)}.$$\n因此失效判据为\n$$\\frac{S^2}{\\tau^2}\\frac{\\Gamma^2}{4(\\Gamma-1)}.$$", "answer": "$$\\boxed{\\frac{S^2}{\\tau^2}\\frac{\\Gamma^2}{4(\\Gamma-1)}}$$", "id": "906980"}]}