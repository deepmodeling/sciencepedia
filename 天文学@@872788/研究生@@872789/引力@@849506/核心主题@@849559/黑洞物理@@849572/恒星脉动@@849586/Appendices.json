{"hands_on_practices": [{"introduction": "要从物理上理解恒星的搏动，一个很好的起点是估算其基本搏动周期。这项实践练习将引导我们使用一个强大的物理工具——维里定理，它建立了恒星的动能和势能之间的联系。通过这种方式，我们可以推导出恒星的基本振动时间尺度是如何由其整体属性（如质量 $M$、半径 $R_0$ 和绝热指数 $\\gamma$）决定的，从而为恒星搏动理论奠定基础。[@problem_id:324283]", "problem": "恒星的径向脉动可以通过分析其在流体静力学平衡附近的小振荡来建模。一个用于此分析的强大工具是运动方程的积分形式，即维里定理。对于一个由具有恒定绝热指数 $\\gamma$ 的气体组成的无自转、无磁场的球形恒星，完整的动力学维里定理（也称为拉格朗日恒等式）可以写成：\n$$\n\\frac{1}{2} \\frac{d^2 I}{dt^2} = 2K_{bulk} + 3(\\gamma-1)E_{th} + U\n$$\n这里，$I$ 是绕恒星中心的转动惯量，$K_{bulk}$ 是径向运动的总动能，$E_{th}$ 是总内能（热能），$U$ 是总引力势能。\n\n考虑一个质量为 $M$、平衡半径为 $R_0$ 的恒星。在其平衡状态下，其引力势能为 $U_0 = -\\alpha \\frac{GM^2}{R_0}$，转动惯量为 $I_0 = \\beta M R_0^2$，其中 $G$ 是引力常数，$\\alpha$ 和 $\\beta$ 是量级为1的无量纲结构常数，取决于恒星的内部密度分布。\n\n现在，假设恒星经历一次微小的、均匀标度的径向脉动。在一次均匀标度脉动中，任意质量壳层的半径 $r$ 在时间 $t$ 的表达式为 $r(t) = r_{eq} (1 + \\epsilon(t))$，其中 $r_{eq}$ 是其平衡半径，$\\epsilon(t)$ 是一个满足 $|\\epsilon(t)| \\ll 1$ 的无量纲、随时间变化的小函数。对于这样的脉动，势能和内能随总半径的变化而变化。如果脉动是绝热的，这些量可以用它们的平衡值（$U_0$，$E_{th,0}$）和微扰 $\\epsilon(t)$ 表示为：\n$$\nU(t) = U_0(1+\\epsilon(t))^{-1} \\quad \\text{and} \\quad E_{th}(t) = E_{th,0} (1+\\epsilon(t))^{3(1-\\gamma)}\n$$\n\n推导恒星基频径向脉动模式的周期 $\\Pi$ 的表达式。用 $M$、$R_0$、$G$、$\\gamma$、$\\alpha$ 和 $\\beta$ 表示你的答案。", "solution": "1. 转动惯量及其微扰。在平衡状态下\n$$I_0=\\beta M R_0^2\\,. $$\n在均匀标度微扰 $r(t)=r_{eq}(1+\\epsilon(t))$下，\n$$I(t)=\\beta M R_0^2(1+\\epsilon)^2\\approx I_0(1+2\\epsilon)\\,,$$ \n所以 \n$$\\frac12\\frac{d^2I}{dt^2}\\approx I_0\\ddot\\epsilon\\,. $$\n\n2. 总动能（取至 $\\dot\\epsilon$ 的最低阶）\n$$K_{bulk}=\\frac12\\int \\!dm\\,(r_{eq}\\dot\\epsilon)^2=\\frac12I_0\\dot\\epsilon^2\\sim\\mathcal O(\\dot\\epsilon^2)\\,,$$ \n在线性化的维里定理中忽略不计。\n\n3. 微扰下的热能和引力能：\n$$U(t)=U_0(1+\\epsilon)^{-1}\\approx U_0(1-\\epsilon),\\quad \nE_{th}(t)=E_{th,0}(1+\\epsilon)^{3(1-\\gamma)}\\approx E_{th,0}\\bigl[1+3(1-\\gamma)\\epsilon\\bigr].$$ \n平衡维里定理给出\n$$0=2\\cdot0+3(\\gamma-1)E_{th,0}+U_0\\quad\\Longrightarrow\\quad U_0=-3(\\gamma-1)E_{th,0}\\,. $$\n\n4. 线性化的维里定理\n$$\\frac12\\frac{d^2I}{dt^2}=2K_{bulk}+3(\\gamma-1)E_{th}+U\\approx\n3(\\gamma-1)E_{th,0}(1+3(1-\\gamma)\\epsilon)+U_0(1-\\epsilon).$$\n减去平衡项并保留线性阶，\n$$I_0\\ddot\\epsilon=\\bigl[-9(\\gamma-1)^2E_{th,0}-U_0\\bigr]\\epsilon\n=(3\\gamma-4)U_0\\,\\epsilon\\,. $$\n\n5. 振荡方程和频率。由于 $U_0=-\\alpha\\,GM^2/R_0$，\n$$\\ddot\\epsilon+\\omega^2\\epsilon=0,\\qquad\n\\omega^2=-\\frac{(3\\gamma-4)U_0}{I_0}=\\frac{(3\\gamma-4)\\alpha\\,G\\,M}{\\beta\\,R_0^3}\\,. $$\n\n6. 基频模式的周期\n$$\\Pi=\\frac{2\\pi}{\\omega}\n=2\\pi\\sqrt{\\frac{\\beta\\,R_0^3}{\\alpha\\,(3\\gamma-4)\\,G\\,M}}\\,. $$", "answer": "$$\\boxed{2\\pi\\sqrt{\\frac{\\beta\\,R_0^3}{\\alpha\\,(3\\gamma-4)\\,G\\,M}}}$$", "id": "324283"}, {"introduction": "在建立了恒星搏动周期的基本物理模型之后，下一步是将其与天文学家的实际观测联系起来。这项练习演示了如何将简谐搏动模型中的理论位移振幅 $\\xi(r_0)$ 和角频率 $\\omega$ 与可测量的量（如表面速度和半径变化）联系起来。这是星震学领域中的一个关键步骤，我们正是利用观测到的这些变化来探测恒星的内部结构。[@problem_id:324296]", "problem": "一颗无自转的球对称恒星处于流体静力学平衡状态，其平衡半径为 $R_0$。该恒星开始经历微小的纯径向脉动。这些脉动可以在拉格朗日框架下描述，在该框架中，我们追踪单个质量壳层相对于其平衡位置的位移。\n\n设 $r_0$ 是某个特定质量壳层的平衡径向坐标。由于脉动，其在时间 $t$ 的瞬时位置由 $r(r_0, t)$ 给出。偏离平衡位置的径向位移定义为 $\\delta r(r_0, t) = r(r_0, t) - r_0$。\n\n我们将这些脉动建模为随时间谐波变化，因此任何质量壳层的位移都可以用一个复数表达式的实部来描述：\n$$\n\\delta r(r_0, t) = \\Re\\left[ \\xi(r_0) e^{i\\omega t} \\right]\n$$\n其中 $\\xi(r_0)$ 是在平衡半径 $r_0$ 处的复位移振幅，而 $\\omega$ 是脉动的实角频率。\n\n在恒星表面（$r_0=R_0$）的两个关键可观测量是径向速度和恒星半径的变化。*表面速度振幅*是恒星表面的最大速度。*半径相对扰动振幅*是半径相对变化量 $|\\delta r(R_0, t)|/R_0$ 的最大值。\n\n假设径向脉动遵循此谐波模型，推导表面速度振幅与表面半径相对扰动振幅之比的表达式。用脉动角频率 $\\omega$ 和恒星的平衡半径 $R_0$ 来表示你的答案。", "solution": "问题要求计算表面速度振幅与表面半径相对扰动振幅之比。我们用 $\\mathcal{R}$ 表示这个比率。\n\n1.  **定义相关物理量。**\n    质量壳层的瞬时径向位置由下式给出：\n    $$\n    r(r_0, t) = r_0 + \\delta r(r_0, t)\n    $$\n    径向位移 $\\delta r(r_0, t)$ 的复数形式为：\n    $$\n    \\delta r(r_0, t) = \\xi(r_0) e^{i\\omega t}\n    $$\n    为方便起见，我们使用复数形式进行计算，因为物理量 $A e^{i\\omega t}$ 的振幅就是 $|A|$。\n\n2.  **计算径向速度。**\n    质量壳层的径向速度 $v(r_0, t)$ 是其位置对时间的导数。在拉格朗日框架中，$r_0$ 是流体元的标记，不随时间变化。\n    $$\n    v(r_0, t) = \\frac{\\partial r(r_0, t)}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ r_0 + \\xi(r_0) e^{i\\omega t} \\right]\n    $$\n    由于 $r_0$ 和 $\\xi(r_0)$ 不依赖于时间，导数为：\n    $$\n    v(r_0, t) = \\xi(r_0) \\frac{\\partial}{\\partial t} \\left( e^{i\\omega t} \\right) = i\\omega \\xi(r_0) e^{i\\omega t}\n    $$\n\n3.  **确定表面速度振幅。**\n    速度是时间的谐波函数。速度的复振幅为 $i\\omega \\xi(r_0)$。速度振幅，即最大速率，是该复振幅的模。\n    $$\n    v_{\\text{amp}}(r_0) = |i\\omega \\xi(r_0)| = |i||\\omega||\\xi(r_0)| = \\omega |\\xi(r_0)|\n    $$\n    我们关心的是表面速度振幅，它发生在平衡半径 $r_0 = R_0$ 处：\n    $$\n    v_{\\text{amp, S}} = \\omega |\\xi(R_0)|\n    $$\n\n4.  **确定半径相对扰动振幅。**\n    半径相对扰动定义为 $\\frac{\\delta r(r_0, t)}{r_0}$。使用复数形式：\n    $$\n    \\frac{\\delta r(r_0, t)}{r_0} = \\frac{\\xi(r_0) e^{i\\omega t}}{r_0} = \\left( \\frac{\\xi(r_0)}{r_0} \\right) e^{i\\omega t}\n    $$\n    这也是一个谐波函数。其振幅是乘以指数项的复数项的模。\n    $$\n    \\left( \\frac{\\delta r}{r} \\right)_{\\text{amp}}(r_0) = \\left| \\frac{\\xi(r_0)}{r_0} \\right| = \\frac{|\\xi(r_0)|}{r_0}\n    $$\n    在表面（$r_0 = R_0$）处，半径相对扰动振幅为：\n    $$\n    \\left( \\frac{\\delta r}{r} \\right)_{\\text{amp, S}} = \\frac{|\\xi(R_0)|}{R_0}\n    $$\n\n5.  **计算最终比率。**\n    所求比率 $\\mathcal{R}$ 是表面速度振幅除以表面的半径相对扰动振幅。\n    $$\n    \\mathcal{R} = \\frac{v_{\\text{amp, S}}}{\\left( \\frac{\\delta r}{r} \\right)_{\\text{amp, S}}}\n    $$\n    代入步骤3和4中推导出的表达式：\n    $$\n    \\mathcal{R} = \\frac{\\omega |\\xi(R_0)|}{\\frac{|\\xi(R_0)|}{R_0}}\n    $$\n    项 $|\\xi(R_0)|$ 代表表面的位移振幅，对于一颗脉动星来说它是一个非零量，因此可以从分子和分母中约去。\n    $$\n    \\mathcal{R} = \\frac{\\omega \\cancel{|\\xi(R_0)|}}{\\frac{\\cancel{|\\xi(R_0)|}}{R_0}} = \\omega R_0\n    $$\n    因此，该比率是脉动角频率与恒星平衡半径的乘积。", "answer": "$$\n\\boxed{\\omega R_0}\n$$", "id": "324296"}, {"introduction": "最后，我们将从理论转向现代天体物理学中的一项重要实践：数据分析。恒星搏动本身是引人入胜的研究课题，但当我们要寻找其他微弱信号（例如系外行星凌星造成的亮度微小下降）时，它也可能成为一种“噪声”。这项计算练习要求我们处理一条模拟的光变曲线，利用傅里叶分析等信号处理技术来识别并滤除恒星搏动信号，从而恢复被掩盖的系外行星凌星信号。这项技能在现代天文数据处理中至关重要。[@problem_id:2395590]", "problem": "你需要编写一个完整的程序，用于构建合成的、均匀采样的光变曲线，应用一个精确定义的频域陷波滤波器以移除已知的恒星脉动频率，并为每组参数计算系外行星凌星深度的定量估计值。光变曲线是无量纲的相对通量，自变量是时间，单位为秒。你的结果必须以无量纲的小数形式报告。\n\n采样定义如下。设 $N$ 为样本数，$\\Delta t$ 为均匀采样间隔。离散时间为 $t_n = n \\,\\Delta t$，其中 $n \\in \\{0,1,\\dots,N-1\\}$。总基线为 $T = N \\,\\Delta t$。在本问题中，$N = 4096$ 且 $\\Delta t = 60 \\,\\mathrm{s}$，因此 $T = 245760 \\,\\mathrm{s}$。\n\n对于一个实值序列 $\\{x_n\\}_{n=0}^{N-1}$，离散傅里叶变换 (DFT) 定义为\n$$\nX_m = \\sum_{n=0}^{N-1} x_n \\, e^{-2\\pi i \\, n m / N}, \\quad m \\in \\{0,1,\\dots,N-1\\},\n$$\n其逆变换为\n$$\nx_n = \\frac{1}{N} \\sum_{m=0}^{N-1} X_m \\, e^{2\\pi i \\, n m / N}.\n$$\n与索引 $m$ 相关的循环频率为 $\\nu_m = \\frac{m}{T}$，单位为 $\\mathrm{Hz}$。\n\n在每个测试案例中，对于 $n \\in \\{0,1,\\dots,N-1\\}$，合成光变曲线定义为\n$$\n\\ell_n = 1 + \\sum_{k=1}^{K} A_k \\, \\sin\\!\\left(2\\pi \\,\\frac{m_k}{N} \\, n + \\phi_k \\right) - d \\, \\mathbf{1}_{\\mathrm{tr}}(n),\n$$\n其中：\n- $K$ 是恒星脉动分量的数量，每个分量都与基线完全相称，其索引为 $m_k \\in \\{0,1,\\dots,N-1\\}$，振幅为 $A_k$，相位为 $\\phi_k$。\n- 周期性的箱形凌星指示函数 $\\mathbf{1}_{\\mathrm{tr}}(n)$ 在 $n \\bmod P_{\\mathrm{steps}} \\in \\{0,1,\\dots,\\tau_{\\mathrm{steps}}-1\\}$ 时等于 $1$，否则等于 $0$。这里 $P_{\\mathrm{steps}}$ 是以样本数为单位的凌星周期，$\\tau_{\\mathrm{steps}}$ 是以样本数为单位的凌星持续时间。物理凌星周期为 $P = P_{\\mathrm{steps}} \\,\\Delta t$ 秒，持续时间为 $\\tau = \\tau_{\\mathrm{steps}} \\,\\Delta t$ 秒。凌星深度 $d$ 是一个相对于单位通量的无量纲小数。\n- 所有通量都是无量纲的；时间单位是秒。\n\n频域陷波滤波器的定义如下。设 $\\{ \\ell_n \\}$ 的 DFT 为 $\\{ L_m \\}$。给定一组脉动索引 $\\{ m_k \\}$ 和一个非负整数半宽 $h$，定义置零索引集\n$$\n\\mathcal{S} = \\bigcup_{k=1}^{K} \\left( \\{ (m_k + j) \\bmod N : j \\in \\{-h,-h+1,\\dots,h\\} \\} \\cup \\{ ( (N - m_k) + j) \\bmod N : j \\in \\{-h,-h+1,\\dots,h\\} \\} \\right).\n$$\n通过将 $m \\in \\mathcal{S}$ 的 $L'_m$ 设为 $0$，否则 $L'_m = L_m$，来形成滤波后的频谱 $L'_m$。滤波后的时间序列 $\\ell'_n$ 通过对 $\\{ L'_m \\}$ 进行逆 DFT 得到。\n\n对于每个测试案例，通过凌星外滤波通量值的中位数与凌星内滤波通量值的中位数之差来估计凌星深度：\n$$\n\\widehat{d} = \\mathrm{median}\\{ \\ell'_n : \\mathbf{1}_{\\mathrm{tr}}(n) = 0 \\} - \\mathrm{median}\\{ \\ell'_n : \\mathbf{1}_{\\mathrm{tr}}(n) = 1 \\}.\n$$\n将 $\\widehat{d}$ 报告为无量纲的小数。\n\n测试套件。所有案例均使用 $N = 4096$ 和 $\\Delta t = 60 \\,\\mathrm{s}$。每个案例指定 $(K, \\{m_k\\}, \\{A_k\\}, \\{\\phi_k\\}, h, P_{\\mathrm{steps}}, \\tau_{\\mathrm{steps}}, d)$：\n\n- 案例 A (一般情况)：$K = 2$, $\\{m_k\\} = \\{300,700\\}$, $\\{A_k\\} = \\{0.01, 0.006\\}$, $\\{\\phi_k\\} = \\{0,0\\}$, $h = 1$, $P_{\\mathrm{steps}} = 512$, $\\tau_{\\mathrm{steps}} = 32$, $d = 0.0015$。\n- 案例 B (无脉动)：$K = 0$, $\\{m_k\\} = \\emptyset$, $\\{A_k\\} = \\emptyset$, $\\{\\phi_k\\} = \\emptyset$, $h = 0$, $P_{\\mathrm{steps}} = 512$, $\\tau_{\\mathrm{steps}} = 64$, $d = 0.002$。\n- 案例 C (脉动位于凌星谐波处)：$K = 1$, $\\{m_k\\} = \\{16\\}$, $\\{A_k\\} = \\{0.01\\}$, $\\{\\phi_k\\} = \\{0\\}$, $h = 0$, $P_{\\mathrm{steps}} = 512$, $\\tau_{\\mathrm{steps}} = 32$, $d = 0.001$。\n- 案例 D (靠近奈奎斯特频率的高频脉动)：$K = 2$, $\\{m_k\\} = \\{2038, 2045\\}$, $\\{A_k\\} = \\{0.008, 0.007\\}$, $\\{\\phi_k\\} = \\{0,0\\}$, $h = 2$, $P_{\\mathrm{steps}} = 256$, $\\tau_{\\mathrm{steps}} = 16$, $d = 0.0012$。\n\n要求的输出格式。你的程序应生成单行输出，其中包含四个估计的深度，按 A、B、C、D 的顺序排列，以逗号分隔，并用方括号括起来。每个数字必须四舍五入到 $6$ 位小数。例如，输出必须如下所示：\n$[x_A,x_B,x_C,x_D]$\n其中每个 $x$ 是一个四舍五入到 $6$ 位的小数，且无附加文本。深度是无量纲的小数（无单位）。", "solution": "所提出的问题是一个定义明确的信号处理计算练习，专门针对天体物理学中的一个应用：在存在恒星变异的情况下探测和表征系外行星凌星。该问题是有效的，因为它具有科学依据、数学上一致，并且所有参数和程序都得到了明确的规定。我的方法将是构建所述过程的数值实现。\n\n每个测试案例的过程包括三个主要阶段：\n1.  时域信号（光变曲线）的合成。\n2.  应用频域陷波滤波器来抑制恒星脉动。\n3.  从滤波后的信号中估计凌星深度。\n\n分析是在一个均匀采样的时间序列上进行的。样本数为 $N = 4096$，采样间隔为 $\\Delta t = 60 \\, \\mathrm{s}$。离散时间点为 $t_n = n \\Delta t$，样本索引 $n \\in \\{0, 1, \\dots, N-1 \\}$。观测的总持续时间（即基线）为 $T = N \\Delta t = 245760 \\, \\mathrm{s}$。\n\n首先，根据提供的模型构建合成光变曲线 $\\ell_n$：\n$$\n\\ell_n = 1 + \\sum_{k=1}^{K} A_k \\, \\sin\\!\\left(2\\pi \\,\\frac{m_k}{N} \\, n + \\phi_k \\right) - d \\, \\mathbf{1}_{\\mathrm{tr}}(n)\n$$\n该模型由三个部分组成：\n- 一个归一化为 $1$ 的恒定基线通量。\n- 一个恒星变异信号，建模为 $K$ 个正弦脉动的总和。每个脉动 $k$ 由其振幅 $A_k$、相位 $\\phi_k$ 和频率索引 $m_k$ 定义，该索引对应于物理频率 $\\nu_{m_k} = m_k / T$。使用整数索引 $m_k$ 确保了每个脉动都与观测基线 $T$ 相称，意味着整数个周期恰好能放入该时间序列中。\n- 一个系外行星凌星信号，$-d \\, \\mathbf{1}_{\\mathrm{tr}}(n)$。函数 $\\mathbf{1}_{\\mathrm{tr}}(n)$ 是一个周期性指示函数，表示行星凌星的时刻。在凌星期间它等于 $1$，否则等于 $0$。凌星的深度为 $d$，周期为 $P_{\\text{steps}}$ 个样本，持续时间为 $\\tau_{\\text{steps}}$ 个样本。这在光变曲线中产生了一系列周期性的箱形下降。\n\n其次，应用频域陷波滤波器来移除恒星脉动信号。这是通过使用离散傅里叶变换 (DFT) 实现的。通过 DFT 将光变曲线 $\\{\\ell_n\\}$ 转换到频域以获得其频谱 $\\{L_m\\}$：\n$$\nL_m = \\sum_{n=0}^{N-1} \\ell_n \\, e^{-2\\pi i \\, n m / N}\n$$\n该滤波器的核心原理是识别与已知恒星脉动相对应的频率仓，并将其振幅设置为零。对于像 $\\{\\ell_n\\}$ 这样的实值信号，其 DFT 表现出厄米对称性，即 $L_m = L_{(N-m) \\pmod N}^*$。为确保滤波后的信号在逆变换后仍为实值，我们必须对称地将系数置零。对于每个脉动索引 $m_k$，我们不仅必须将 $m_k$ 处的频率分量置零，还必须将其对应的负频率分量置零，在标准 DFT 输出中，负频率由索引 $(N-m_k) \\pmod N$ 表示。问题指定了一个滤波器半宽 $h$，它要求我们在每个脉动频率及其共轭频率周围将一个包含 $2h+1$ 个频率仓的小频带置零。因此，要置零的索引集 $\\mathcal{S}$ 是：\n$$\n\\mathcal{S} = \\bigcup_{k=1}^{K} \\left( \\{ (m_k + j) \\bmod N : j \\in \\{-h, \\dots, h\\} \\} \\cup \\{ ((N - m_k) + j) \\bmod N : j \\in \\{-h, \\dots, h\\} \\} \\right)\n$$\n通过将所有 $m \\in \\mathcal{S}$ 的 $L'_m$ 设为 $0$ 并保持其他分量不变（$L'_m = L_m$），来创建一个新的滤波后频谱 $\\{L'_m\\}$。然后通过应用逆 DFT 恢复滤波后的时域信号 $\\{\\ell'_n\\}$：\n$$\n\\ell'_n = \\frac{1}{N} \\sum_{m=0}^{N-1} L'_m \\, e^{2\\pi i \\, n m / N}\n$$\n得到的信号 $\\{\\ell'_n\\}$ 应该是实值的，尽管由于浮点不精确性可能会出现微小的虚部；通过取结果的实部来丢弃这些虚部。\n\n第三，从滤波后的光变曲线 $\\{\\ell'_n\\}$ 中估计凌星深度。深度定义为凌星外通量和凌星内通量之差。为了获得稳健的估计，使用中位数而不是平均值，因为中位数对离群值或滤波过程中的残余伪影不太敏感。估计深度 $\\widehat{d}$ 计算如下：\n$$\n\\widehat{d} = \\mathrm{median}\\{ \\ell'_n : \\mathbf{1}_{\\mathrm{tr}}(n) = 0 \\} - \\mathrm{median}\\{ \\ell'_n : \\mathbf{1}_{\\mathrm{tr}}(n) = 1 \\}\n$$\n将此程序应用于所提供的四个测试案例中的每一个，并以指定格式报告所得的估计深度。该算法使用 Python 的 `numpy` 库实现，该库提供了高效且符合标准的 FFT 和数组操作实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Define global parameters\n    N = 4096\n    dt = 60.0  # seconds\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"K\": 2, \"m_k\": [300, 700], \"A_k\": [0.01, 0.006], \"phi_k\": [0.0, 0.0],\n            \"h\": 1, \"P_steps\": 512, \"tau_steps\": 32, \"d\": 0.0015\n        },\n        {\n            \"name\": \"B\",\n            \"K\": 0, \"m_k\": [], \"A_k\": [], \"phi_k\": [],\n            \"h\": 0, \"P_steps\": 512, \"tau_steps\": 64, \"d\": 0.002\n        },\n        {\n            \"name\": \"C\",\n            \"K\": 1, \"m_k\": [16], \"A_k\": [0.01], \"phi_k\": [0.0],\n            \"h\": 0, \"P_steps\": 512, \"tau_steps\": 32, \"d\": 0.001\n        },\n        {\n            \"name\": \"D\",\n            \"K\": 2, \"m_k\": [2038, 2045], \"A_k\": [0.008, 0.007], \"phi_k\": [0.0, 0.0],\n            \"h\": 2, \"P_steps\": 256, \"tau_steps\": 16, \"d\": 0.0012\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        d_hat = calculate_filtered_depth(N, dt, case)\n        results.append(d_hat)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_filtered_depth(N, dt, params):\n    \"\"\"\n    Calculates the estimated transit depth for a single test case.\n    \n    Args:\n        N (int): Number of samples.\n        dt (float): Sampling interval in seconds.\n        params (dict): Dictionary of parameters for the test case.\n    \n    Returns:\n        float: The estimated transit depth.\n    \"\"\"\n    # Unpack parameters\n    K = params[\"K\"]\n    m_k_list = params[\"m_k\"]\n    A_k_list = params[\"A_k\"]\n    phi_k_list = params[\"phi_k\"]\n    h = params[\"h\"]\n    P_steps = params[\"P_steps\"]\n    tau_steps = params[\"tau_steps\"]\n    d = params[\"d\"]\n\n    # 1. Generate synthetic light curve\n    n = np.arange(N)\n\n    # Pulsation component\n    pulsation_signal = np.zeros(N, dtype=float)\n    if K > 0:\n        for mk, Ak, phik in zip(m_k_list, A_k_list, phi_k_list):\n            pulsation_signal += Ak * np.sin(2.0 * np.pi * mk / N * n + phik)\n\n    # Transit component\n    transit_indicator = ((n % P_steps)  tau_steps).astype(float)\n    \n    # Full light curve\n    l_n = 1.0 + pulsation_signal - d * transit_indicator\n\n    # 2. Apply frequency-domain notch filter\n    \n    # Compute DFT\n    L_m = np.fft.fft(l_n)\n    \n    # Construct the filtered spectrum L_prime_m\n    L_prime_m = L_m.copy()\n    \n    # Determine indices to zero out\n    if K > 0:\n        indices_to_zero = set()\n        for mk in m_k_list:\n            for j in range(-h, h + 1):\n                # Positive frequency component\n                indices_to_zero.add((mk + j) % N)\n                # Negative frequency component (Hermitian symmetry)\n                indices_to_zero.add((N - mk + j) % N)\n        \n        # Apply the filter by zeroing out the specified DFT coefficients\n        L_prime_m[list(indices_to_zero)] = 0.0\n\n    # Compute inverse DFT to get the filtered time series\n    l_prime_n = np.fft.ifft(L_prime_m)\n    \n    # The result should be real; take the real part to discard negligible imaginary parts\n    l_prime_n_real = l_prime_n.real\n\n    # 3. Estimate the transit depth from the filtered curve\n    in_transit_mask = (transit_indicator == 1)\n    out_of_transit_mask = (transit_indicator == 0)\n\n    # Check if there are any in-transit points to avoid errors with median\n    if np.any(in_transit_mask):\n        median_in_transit = np.median(l_prime_n_real[in_transit_mask])\n    else:\n        # This case should not happen with given parameters but is good practice\n        median_in_transit = np.median(l_prime_n_real)\n        \n    median_out_of_transit = np.median(l_prime_n_real[out_of_transit_mask])\n    \n    d_hat = median_out_of_transit - median_in_transit\n    \n    return d_hat\n\nsolve()\n```", "id": "2395590"}]}