{"hands_on_practices": [{"introduction": "本练习将探讨最简单的引力透镜模型：孤立点质量透镜。通过推导著名的“放大率求和规则”，您将亲手实践透镜方程和放大率的定义，揭示点质量透镜的一个基本性质。[@problem_id:345839] 这项实践对于在深入研究更复杂的扩展透镜模型之前，建立起坚实的基础理解至关重要。", "problem": "在引力透镜理论中，一个致密的大质量天体，如恒星或黑洞，可以被建模为一个点质量透镜。该透镜的引力场会使来自遥远光源的光线发生偏折，从而为观测者形成多个像。\n\n考虑一个系统，其中包含一个光源 `S`、一个点质量透镜 `L` 和一个观测者 `O`，它们都共面排列。在没有透镜的情况下，光源在天空中的位置由角位置矢量 `vec(β)` 给出。观测到的像的角位置是 `vec(θ)`。`vec(β)` 和 `vec(θ)` 都是天穹平面上的二维矢量。\n\n真实光源位置与像位置之间的关系由引力透镜方程给出：\n$$\n\\vec{\\beta} = \\vec{\\theta} - \\vec{\\alpha}(\\vec{\\theta})\n$$\n其中 `vec(α)(vec(θ))` 是约化偏折角。对于点质量透镜，该偏折角由下式给出：\n$$\n\\vec{\\alpha}(\\vec{\\theta}) = \\frac{\\theta_E^2}{|\\vec{\\theta}|^2} \\vec{\\theta}\n$$\n此处，`θ_E` 是爱因斯坦半径，这是一个特征角度，其大小取决于透镜的质量以及光源、透镜和观测者之间的距离。只要光源与透镜不完全对齐，点质量透镜总会为单个光源产生两个不同的像。设这两个像的角位置分别为 `vec(θ_1)` 和 `vec(θ_2)`。\n\n像的带符号放大率 `μ` 定义为透镜映射的雅可比矩阵 `A_{ij} = \\frac{\\partial\\beta_i}{\\partial\\theta_j}` 行列式的倒数：\n$$\n\\mu = (\\det(A))^{-1}\n$$\n这个量衡量的是像的立体角与光源立体角之比，它可以是正值（对于宇称保持的像）或负值（对于宇称反转的像）。\n\n对于点质量透镜，存在一个著名的“放大率求和规则”。该规则指出，两个像的带符号放大率之和是一个常数，与光源位置 `β` 和透镜参数 `θ_E` 无关。\n\n推导这个常数的值，`μ_{total} = μ(\\vec{\\theta_1}) + μ(\\vec{\\theta_2})`。", "solution": "推导的起点是点质量透镜的矢量透镜方程：\n$$\n\\vec{\\beta} = \\vec{\\theta} - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2} \\vec{\\theta} = \\vec{\\theta} \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right)\n$$\n该方程意味着矢量 $\\vec{\\beta}$ 和 $\\vec{\\theta}$ 是共线的。因此，我们可以通过使用标量角距离来简化问题。设 $\\beta = |\\vec{\\beta}|$ 且 $\\theta = |\\vec{\\theta}|$。$\\theta$ 的符号将指示像相对于光源出现在透镜的哪一侧。透镜方程变为：\n$$\n\\beta = \\theta - \\frac{\\theta_E^2}{\\theta}\n$$\n重新整理上式，得到关于像位置 $\\theta$ 的一个二次方程：\n$$\n\\theta^2 - \\beta\\theta - \\theta_E^2 = 0\n$$\n该方程的两个根 $\\theta_1$ 和 $\\theta_2$ 对应于两个像的位置。\n\n接下来，我们推导带符号放大率 $\\mu$ 的公式。放大率为 $\\mu = (\\det(A))^{-1}$，其中 $A_{ij} = \\frac{\\partial\\beta_i}{\\partial\\theta_j}$。透镜映射为 $\\beta_i = \\theta_i - \\alpha_i(\\vec{\\theta})$。\n$$\nA_{ij} = \\frac{\\partial}{\\partial\\theta_j}\\left(\\theta_i - \\frac{\\theta_E^2 \\theta_i}{\\theta_k \\theta_k}\\right) = \\delta_{ij} - \\frac{\\partial \\alpha_i}{\\partial \\theta_j}\n$$\n我们来计算张量 $\\frac{\\partial \\alpha_i}{\\partial \\theta_j}$ 的分量：\n$$\n\\frac{\\partial \\alpha_i}{\\partial \\theta_j} = \\frac{\\partial}{\\partial \\theta_j} \\left( \\frac{\\theta_E^2 \\theta_i}{\\theta_1^2 + \\theta_2^2} \\right) = \\frac{\\theta_E^2}{(\\theta_1^2+\\theta_2^2)^2} \\left[ \\delta_{ij}(\\theta_1^2+\\theta_2^2) - \\theta_i (2\\theta_j) \\right] = \\frac{\\theta_E^2}{|\\vec{\\theta}|^4} (\\delta_{ij}|\\vec{\\theta}|^2 - 2\\theta_i\\theta_j)\n$$\n雅可比矩阵为：\n$$\nA = \\begin{pmatrix} 1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^4}(|\\vec{\\theta}|^2 - 2\\theta_1^2)  \\frac{2\\theta_E^2\\theta_1\\theta_2}{|\\vec{\\theta}|^4} \\\\ \\frac{2\\theta_E^2\\theta_1\\theta_2}{|\\vec{\\theta}|^4}  1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^4}(|\\vec{\\theta}|^2 - 2\\theta_2^2) \\end{pmatrix}\n$$\n`A` 的行列式为：\n$$\n\\det(A) = \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2} + \\frac{2\\theta_E^2\\theta_1^2}{|\\vec{\\theta}|^4}\\right) \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2} + \\frac{2\\theta_E^2\\theta_2^2}{|\\vec{\\theta}|^4}\\right) - \\frac{4\\theta_E^4\\theta_1^2\\theta_2^2}{|\\vec{\\theta}|^8}\n$$\n$$\n\\det(A) = \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right)^2 + \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right)\\frac{2\\theta_E^2(\\theta_1^2+\\theta_2^2)}{|\\vec{\\theta}|^4} + \\frac{4\\theta_E^4\\theta_1^2\\theta_2^2}{|\\vec{\\theta}|^8} - \\frac{4\\theta_E^4\\theta_1^2\\theta_2^2}{|\\vec{\\theta}|^8}\n$$\n由于 $\\theta_1^2 + \\theta_2^2 = |\\vec{\\theta}|^2$：\n$$\n\\det(A) = \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right)^2 + \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right)\\frac{2\\theta_E^2}{|\\vec{\\theta}|^2} = \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right) \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2} + \\frac{2\\theta_E^2}{|\\vec{\\theta}|^2}\\right)\n$$\n$$\n\\det(A) = \\left(1 - \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right) \\left(1 + \\frac{\\theta_E^2}{|\\vec{\\theta}|^2}\\right) = 1 - \\frac{\\theta_E^4}{|\\vec{\\theta}|^4}\n$$\n因此，位于位置 $\\theta$ 的像的带符号放大率为：\n$$\n\\mu(\\theta) = (\\det(A))^{-1} = \\frac{1}{1 - \\theta_E^4/|\\vec{\\theta}|^4} = \\frac{|\\vec{\\theta}|^4}{|\\vec{\\theta}|^4 - \\theta_E^4}\n$$\n为了简化代数运算，我们引入归一化变量。设 $u = \\theta/\\theta_E$ 且 $y = \\beta/\\theta_E$。二次透镜方程变为：\n$$\nu^2 - yu - 1 = 0\n$$\n放大率公式变为：\n$$\n\\mu(u) = \\frac{(u\\theta_E)^4}{(u\\theta_E)^4 - \\theta_E^4} = \\frac{u^4}{u^4 - 1}\n$$\n设归一化透镜方程的两个解为 $u_1$ 和 $u_2$。它们对应于两个像的归一化位置。根据二次方程 $ax^2+bx+c=0$ 的韦达定理，两根之积为 $c/a$。对于 $u^2 - yu - 1 = 0$，根 $u_1$ 和 $u_2$ 的乘积为：\n$$\nu_1 u_2 = -1\n$$\n现在我们可以计算放大率之和 $\\mu_{total} = \\mu(u_1) + \\mu(u_2)$。\n$$\n\\mu(u_1) = \\frac{u_1^4}{u_1^4 - 1}\n$$\n对于第二个像，我们使用关系式 $u_2 = -1/u_1$。这意味着 $u_2^4 = (-1/u_1)^4 = 1/u_1^4$。\n$$\n\\mu(u_2) = \\frac{u_2^4}{u_2^4 - 1} = \\frac{1/u_1^4}{1/u_1^4 - 1}\n$$\n为简化此表达式，我们将分子和分母同乘以 $u_1^4$：\n$$\n\\mu(u_2) = \\frac{1}{1 - u_1^4} = -\\frac{1}{u_1^4 - 1}\n$$\n现在我们将两个放大率相加：\n$$\n\\mu_{total} = \\mu(u_1) + \\mu(u_2) = \\frac{u_1^4}{u_1^4 - 1} - \\frac{1}{u_1^4 - 1}\n$$\n$$\n\\mu_{total} = \\frac{u_1^4 - 1}{u_1^4 - 1} = 1\n$$\n带符号放大率之和是一个常数 1，与光源位置 $\\beta$（或 $y$）和爱因斯坦半径 $\\theta_E$ 无关。", "answer": "$$\n\\boxed{1}\n$$", "id": "345839"}, {"introduction": "真实的星系并非点质量，因此我们必须转向扩展质量分布模型。本问题引入了一个更符合实际的、非奇异的“伪等温”密度分布来模拟星系核心。[@problem_id:345872] 通过计算中心像的放大率，您将学会使用描述任何扩展透镜都不可或缺的关键概念——会聚度（$\\kappa$）和剪切（$\\gamma$）。", "problem": "**问题描述**\n\n在引力透镜理论中，源平面（角坐标 $\\vec{\\beta}$）与像平面（角坐标 $\\vec{\\theta}$）之间的映射由透镜方程描述。对于圆形对称透镜，该方程简化为 $\\vec{\\beta} = \\vec{\\theta} - \\alpha(\\theta) \\frac{\\vec{\\theta}}{\\theta}$，其中 $\\alpha(\\theta)$ 是偏折角的大小，且 $\\theta = |\\vec{\\theta}|$。\n\n透镜成像的放大率由透镜映射的雅可比矩阵 $A_{ij} = \\frac{\\partial \\beta_i}{\\partial \\theta_j}$ 决定。总放大率 $\\mu$ 由 $\\mu = (\\det A)^{-1}$ 给出。对于圆形对称透镜，这可以表示为会聚 $\\kappa(\\theta)$ 和剪切大小 $\\gamma(\\theta)$ 的函数：\n$$\n\\mu = \\frac{1}{(1-\\kappa(\\theta))^2 - \\gamma(\\theta)^2}\n$$\n会聚 $\\kappa(\\theta)$ 是由临界表面密度 $\\Sigma_{crit}$ 归一化的透镜表面质量密度。剪切大小由 $\\gamma(\\theta) = \\bar{\\kappa}(\\theta) - \\kappa(\\theta)$ 给出，其中 $\\bar{\\kappa}(\\theta)$ 是角半径 $\\theta$ 内的平均会聚：\n$$\n\\bar{\\kappa}(\\theta) = \\frac{1}{\\pi\\theta^2} \\int_0^\\theta 2\\pi\\theta' \\kappa(\\theta') d\\theta'\n$$\n\n考虑一个星系，其质量分布由非奇异的“伪等温”分布模型描述。此模型的会聚由下式给出：\n$$\n\\kappa(\\theta) = \\frac{\\kappa_c}{1 + (\\theta/\\theta_c)^2}\n$$\n其中 $\\kappa_c$ 是中心会聚，$\\theta_c$ 是角核半径。\n\n对于一个正好位于源平面中心（$\\vec{\\beta}=0$）的点源，其中一个像形成于像平面中心（$\\vec{\\theta}=0$）。推导该中心像的放大率 $\\mu_{cen}$。请用中心会聚 $\\kappa_c$ 表示你的答案。", "solution": "1. 对于圆形对称透镜，总放大率为\n$$\n\\mu(\\theta)=\\frac{1}{(1-\\kappa(\\theta))^2-\\gamma(\\theta)^2}\\,.\n$$\n\n2. 伪等温分布的会聚为\n$$\n\\kappa(\\theta)=\\frac{\\kappa_c}{1+(\\theta/\\theta_c)^2}\\,,\n$$\n因此在中心处（$\\theta\\to0$）\n$$\n\\kappa(0)=\\kappa_c\\,. \n$$\n\n3. $\\theta$ 内的平均会聚为\n$$\n\\bar\\kappa(\\theta)\n=\\frac{1}{\\pi\\theta^2}\\int_0^\\theta2\\pi\\theta'\\kappa(\\theta')\\,d\\theta'\n=\\frac{2\\kappa_c}{\\theta^2}\\int_0^\\theta \\frac{\\theta'}{1+(\\theta'/\\theta_c)^2}\\,d\\theta'\n=\\frac{\\kappa_c\\theta_c^2}{\\theta^2}\\ln\\bigl(1+(\\theta/\\theta_c)^2\\bigr).\n$$\n取极限 $\\theta\\to0$，使用泰勒展开 $\\ln(1+x)\\approx x$ for $x \\to 0$ 可得\n$$\n\\bar\\kappa(0) = \\lim_{\\theta\\to 0} \\frac{\\kappa_c\\theta_c^2}{\\theta^2} \\left( \\frac{\\theta^2}{\\theta_c^2} \\right) = \\kappa_c.\n$$\n\n4. 中心处的剪切为\n$$\n\\gamma(0)=\\bar\\kappa(0)-\\kappa(0)=\\kappa_c-\\kappa_c=0.\n$$\n\n5. 因此，中心像的放大率为\n$$\n\\mu_{cen}=\\frac{1}{(1-\\kappa(0))^2-\\gamma(0)^2}\n=\\frac{1}{(1-\\kappa_c)^2}\\,. \n$$", "answer": "$$\\boxed{\\frac{1}{(1-\\kappa_c)^2}}$$", "id": "345872"}, {"introduction": "引力透镜是宇宙学研究的强大工具，尤其是在通过时间延迟测量哈勃常数（$H_0$）方面。本练习将直面该方法中的一个关键挑战：质量-片简并性（MSD）。[@problem_id:346001] 通过分析 MSD 如何影响推断出的 $H_0$ 值，您将理解透镜建模中一个根本性的系统不确定性，并体会到利用引力透镜进行精确宇宙学研究所涉及的精妙之处。", "problem": "一种测量哈勃常数 $H_0$ 的重要方法依赖于由前景引力透镜（如星系）产生的遥远可变源（如类星体）的多个像之间的时间延迟。然而，这种方法会受到系统不确定性的影响，其中最显著的是质量片简并（MSD）。本问题要求你推导MSD对推断出的 $H_0$ 值的影响。\n\n**背景知识：**\n\n1.  **透镜理论：** 天空上透镜像的位置 $\\vec{\\theta}$ 与真实源的位置 $\\vec{\\beta}$ 通过透镜方程相关联：\n    $$\n    \\vec{\\beta} = \\vec{\\theta} - \\vec{\\alpha}(\\vec{\\theta}),\n    $$\n    其中所有位置都是天空上的二维矢量（单位为弧度）。偏折角 $\\vec{\\alpha}(\\vec{\\theta})$ 是标量透镜势 $\\psi(\\vec{\\theta})$ 的梯度：$\\vec{\\alpha}(\\vec{\\theta}) = \\nabla_{\\vec{\\theta}} \\psi(\\vec{\\theta})$。势 $\\psi$ 通过二维泊松方程与透镜的无量纲表面质量密度 $\\kappa(\\vec{\\theta})$ 相关：$\\nabla^2_{\\vec{\\theta}}\\psi(\\vec{\\theta}) = 2\\kappa(\\vec{\\theta})$。\n\n2.  **时间延迟：** 来自位于 $\\vec{\\theta}$ 处的透镜像的光的到达时间由费马势或时间延迟面描述：\n    $$\n    \\mathcal{T}(\\vec{\\theta}, \\vec{\\beta}) = \\frac{1}{2}|\\vec{\\theta} - \\vec{\\beta}|^2 - \\psi(\\vec{\\theta}).\n    $$\n    观测到的像位置是该曲面的驻点。位于 $\\vec{\\theta}_A$ 和 $\\vec{\\theta}_B$ 的两个像之间的物理时间延迟 $\\Delta t_{AB}$ 与它们的费马势之差成正比：\n    $$\n    \\Delta t_{AB} = \\frac{D_{\\Delta t}}{c} [\\mathcal{T}(\\vec{\\theta}_A, \\vec{\\beta}) - \\mathcal{T}(\\vec{\\theta}_B, \\vec{\\beta})],\n    $$\n    其中 $c$ 是光速，$D_{\\Delta t}$ 是“时间延迟距离”，它取决于观测者、透镜和源之间的角直径距离。对于给定的宇宙学模型，$D_{\\Delta t}$ 与哈勃常数 $H_0$ 成反比。因此，可以从观测到的时间延迟 $\\Delta t_{AB, \\text{obs}}$ 和一个提供 $\\psi$ 和 $\\vec{\\beta}$ 的透镜模型中获得推断的 $H_0$ 值：\n    $$\n    H_0 \\propto \\frac{\\mathcal{T}(\\vec{\\theta}_A, \\vec{\\beta}) - \\mathcal{T}(\\vec{\\theta}_B, \\vec{\\beta})}{\\Delta t_{AB, \\text{obs}}}.\n    $$\n\n3.  **质量片简并 (MSD):** 透镜建模中一个已知的简并性是MSD。一个表面密度为 $\\kappa(\\vec{\\theta})$、从位于 $\\vec{\\beta}$ 的源在位置 $\\vec{\\theta}_i$ 产生像的透镜模型，与一个表面密度为 $\\kappa'(\\vec{\\theta})$ 的变换模型在观测上是无法区分的（仅基于像的位置）：\n    $$\n    \\kappa'(\\vec{\\theta}) = \\lambda \\kappa(\\vec{\\theta}) + (1-\\lambda),\n    $$\n    其中 $\\lambda$ 是一个任意非零常数。当质量分布的这种变换与源位置的相应变换相结合时，会保持透镜像的角位置不变。\n\n**问题：**\n\n假设一位天体物理学家使用一个以 $(\\kappa, \\vec{\\beta})$ 为特征的基准模型来建模一个双像引力透镜系统，该模型精确地再现了观测到的像位置 $\\vec{\\theta}_A$ 和 $\\vec{\\theta}_B$。从观测到的时间延迟 $\\Delta t_{AB, \\text{obs}}$，他们推断出哈勃常数 $H_{0, \\text{fid}}$。\n\n然而，这个基准模型只是由MSD参数 $\\lambda$ 描述的简并模型族中的一员。对于任意给定的 $\\lambda$，存在另一个模型 $(\\kappa', \\vec{\\beta}')$，它能预测出完全相同的像位置。一个不知道这种简并性的观测者可能会选择这个其他的模型。\n\n推导从变换模型推断出的哈勃常数 $H_{0, \\lambda}$ 与从基准模型推断出的哈勃常数 $H_{0, \\text{fid}}$ 之间的关系。具体来说，求出比值 $\\frac{H_{0, \\lambda}}{H_{0, \\text{fid}}}$ 的表达式。", "solution": "我们从模型 $(\\kappa, \\psi, \\vec{\\beta})$ 的费马（时间延迟）势开始：\n$$\n\\mathcal{T}(\\vec{\\theta}, \\vec{\\beta}) = \\frac{1}{2}|\\vec{\\theta} - \\vec{\\beta}|^2 - \\psi(\\vec{\\theta})\n$$\n在MSD变换下，势和源位置变换为：\n$$\n\\psi'(\\vec{\\theta}) = \\lambda\\psi(\\vec{\\theta}) + \\frac{1-\\lambda}{2}|\\vec{\\theta}|^2 \\quad \\text{和} \\quad \\vec{\\beta}' = \\lambda\\vec{\\beta}\n$$\n因此，新的费马势为：\n$$\n\\begin{aligned}\n\\mathcal{T}'(\\vec{\\theta}, \\vec{\\beta}') = \\frac{1}{2}|\\vec{\\theta} - \\vec{\\beta}'|^2 - \\psi'(\\vec{\\theta}) \\\\\n= \\frac{1}{2}|\\vec{\\theta} - \\lambda\\vec{\\beta}|^2 - \\left( \\lambda\\psi(\\vec{\\theta}) + \\frac{1-\\lambda}{2}|\\vec{\\theta}|^2 \\right) \\\\\n= \\lambda \\left[ \\frac{1}{2}|\\vec{\\theta} - \\vec{\\beta}|^2 - \\psi(\\vec{\\theta}) \\right] + \\frac{1}{2}(\\lambda^2-\\lambda)|\\vec{\\beta}|^2 \\\\\n= \\lambda\\mathcal{T}(\\vec{\\theta}, \\vec{\\beta}) + \\text{const.}\n\\end{aligned}\n$$\n其中常数项与像的位置 $\\vec{\\theta}$ 无关。由于加性常数在计算两个像的时间延迟差时会抵消，我们得到：\n$$\n\\Delta\\mathcal{T}'_{AB} = \\mathcal{T}'(\\vec{\\theta}_A, \\vec{\\beta}') - \\mathcal{T}'(\\vec{\\theta}_B, \\vec{\\beta}') = \\lambda\\left(\\mathcal{T}(\\vec{\\theta}_A, \\vec{\\beta}) - \\mathcal{T}(\\vec{\\theta}_B, \\vec{\\beta})\\right) = \\lambda\\Delta\\mathcal{T}_{AB}\n$$\n由于观测到的时间延迟 $\\Delta t_{AB, \\text{obs}}$ 是固定的，并且 $H_0 \\propto \\Delta\\mathcal{T} / \\Delta t_{AB, \\text{obs}}$，所以推断出的哈勃常数按如下方式缩放：\n$$\nH_{0, \\lambda} = \\lambda H_{0, \\text{fid}}\n$$\n因此：\n$$\n\\frac{H_{0, \\lambda}}{H_{0, \\text{fid}}} = \\lambda\n$$", "answer": "$$\\boxed{\\lambda}$$", "id": "346001"}]}