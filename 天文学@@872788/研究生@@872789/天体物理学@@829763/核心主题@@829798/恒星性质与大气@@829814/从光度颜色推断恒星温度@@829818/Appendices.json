{"hands_on_practices": [{"introduction": "在观测天文学中，望远镜时间是宝贵的资源。因此，高效地规划观测以最大化科学产出是一项关键技能。本练习将探讨如何在有限的总观测时间内，通过优化分配在两个不同测光滤光片上的曝光时间，来获得最高精度的恒星颜色测量值。通过解决这个问题 [@problem_id:227062]，您将学会如何平衡每个滤光片的信噪比，以最小化最终 $B-V$ 色指数的总不确定度。", "problem": "一位天文学家正计划进行观测，以测量一颗暗星的颜色。这种颜色由 $B-V$ 色指数来量化，该指数是恒星在蓝色（B）和可见光（V）滤光片中的视星等之差：$B-V = m_B - m_V$。任何滤光片中的视星等 $m$ 都与测得的恒星流量 $F$ 相关，其关系式为 $m = -2.5 \\log_{10}(F) + \\text{常数}$。\n\n对于暗天体，星等测量的精度受到光子统计（散粒噪声）的限制。星等测量的误差 $\\sigma_m$ 与光度测量的信噪比（SNR）相关：\n$$\n\\sigma_m \\approx \\frac{2.5}{\\ln 10} \\frac{1}{\\text{SNR}}\n$$\n此关系在 $\\text{SNR} \\gg 1$ 时有效。假设在 B 和 V 滤光片中的测量是独立的，则 $B-V$ 色的总不确定度由 $\\sigma_{B-V}^2 = \\sigma_{m_B}^2 + \\sigma_{m_V}^2$ 给出。\n\n信号是从恒星收集到的光子数 $N_{star}$。噪声主要来自恒星和恒定天空背景的泊松噪声。在测量孔径内从天空背景探测到的光子数是 $N_{sky}$。总噪声是测得的总光子数的标准差，$\\sigma_{total} = \\sqrt{N_{star} + N_{sky}}$。因此，信噪比为：\n$$\n\\text{SNR} = \\frac{N_{star}}{\\sqrt{N_{star} + N_{sky}}}\n$$\n收集到的光子数是光子探测率与曝光时间的乘积，例如，$N_{star} = R_S t$。\n\n一位天文学家有总观测时间 $T_{tot}$ 用于测量该恒星的 $B-V$ 色指数。这段时间必须分配给 B 滤光片的曝光（时长 $t_B$）和 V 滤光片的曝光（时长 $t_V$），使得 $t_B + t_V = T_{tot}$。来自恒星的恒定平均光子探测率在 B 和 V 滤光片中分别为 $R_{S,B}$ 和 $R_{S,V}$。来自天空背景的相应恒定速率为 $R_{sky,B}$ 和 $R_{sky,V}$。\n\n推导通过在两个滤光片之间优化分配总曝光时间 $T_{tot}$ 所能实现的最小光度误差 $\\sigma_{B-V}$ 的表达式。将你的最终答案表示为给定的光子速率 $R_{S,B}$、$R_{S,V}$、$R_{sky,B}$、$R_{sky,V}$ 和总时间 $T_{tot}$ 的函数。", "solution": "1. 相关关系式：\n$$\\sigma_m\\approx\\frac{2.5}{\\ln10}\\frac1{\\rm SNR},\\quad \n\\mathrm{SNR}=\\frac{N_\\star}{\\sqrt{N_\\star+N_{\\rm sky}}},\\quad \nN_\\star=R_S\\,t,\\;N_{\\rm sky}=R_{\\rm sky}\\,t.$$  \n总的 $B\\!-\\!V$ 误差为\n$$\\sigma_{B-V}^2=\\sigma_{m_B}^2+\\sigma_{m_V}^2\n=\\Bigl(\\frac{2.5}{\\ln10}\\Bigr)^2\\Bigl(\\frac1{\\mathrm{SNR}_B^2}+\\frac1{\\mathrm{SNR}_V^2}\\Bigr).$$  \n2. 表示每个信噪比：\n$$\\mathrm{SNR}_B=\\frac{R_{S,B}\\,t_B}{\\sqrt{(R_{S,B}+R_{sky,B})\\,t_B}}\n=\\frac{R_{S,B}\\sqrt{t_B}}{\\sqrt{R_{S,B}+R_{sky,B}}},\n\\quad\\frac1{\\mathrm{SNR}_B^2}\n=\\frac{R_{S,B}+R_{sky,B}}{R_{S,B}^2\\,t_B},$$  \nV 滤光片的情况与此类似，使用 $t_V$。因此\n$$\\sigma_{B-V}^2\n=\\Bigl(\\frac{2.5}{\\ln10}\\Bigr)^2\\Bigl(\\frac{R_{S,B}+R_{sky,B}}{R_{S,B}^2\\,t_B}\n+\\frac{R_{S,V}+R_{sky,V}}{R_{S,V}^2\\,t_V}\\Bigr).$$  \n3. 在 $t_B+t_V=T_{tot}$ 的约束下，使用拉格朗日乘数法求最小值：\n$$\\frac{R_{S,B}+R_{sky,B}}{R_{S,B}^2\\,t_B^2}\n=\\frac{R_{S,V}+R_{sky,V}}{R_{S,V}^2\\,t_V^2}\n\\;\\Rightarrow\\;\\frac{t_B}{t_V}\n=\\sqrt{\\frac{(R_{S,B}+R_{sky,B})/R_{S,B}^2}{(R_{S,V}+R_{sky,V})/R_{S,V}^2}}\n=\\frac{\\sqrt{R_{S,B}+R_{sky,B}}/R_{S,B}}{\\sqrt{R_{S,V}+R_{sky,V}}/R_{S,V}}.$$  \n因此\n$$t_B=\\frac{T_{tot}\\,\\sqrt{R_{S,B}+R_{sky,B}}/R_{S,B}}\n{\\sqrt{R_{S,B}+R_{sky,B}}/R_{S,B}+\\sqrt{R_{S,V}+R_{sky,V}}/R_{S,V}},$$  \n$$t_V=T_{tot}-t_B.$$  \n4. 代入回去得到最小误差\n$$\\sigma_{B-V,\\min}\n=\\frac{2.5}{\\ln10}\\,\\frac{\\displaystyle\\frac{\\sqrt{R_{S,B}+R_{sky,B}}}{R_{S,B}}\n+\\displaystyle\\frac{\\sqrt{R_{S,V}+R_{sky,V}}}{R_{S,V}}}\n{\\sqrt{T_{tot}}}.$$", "answer": "$$\\boxed{\\frac{2.5}{\\ln10}\\,\\frac{\\frac{\\sqrt{R_{S,B}+R_{sky,B}}}{R_{S,B}}\n+\\frac{\\sqrt{R_{S,V}+R_{sky,V}}}{R_{S,V}}}{\\sqrt{T_{tot}}}}$$", "id": "227062"}, {"introduction": "地面望远镜的测量数据不可避免地会受到地球大气层的影响，它会以与波长相关的方式吸收和散射星光。为了恢复恒星的真实亮度和颜色，天文学家必须对这种大气消光效应进行校正。本练习 [@problem_id:226923] 将引导您使用一个夜晚中对同一颗恒星的多次测光数据来推导其大气外颜色，这是数据处理中一项被称为消光校正的基本技术。", "problem": "在观测天文学中，从地球表面测得的恒星视亮度要比其在大气层外的亮度更暗。这种变暗的现象被称为大气消光，它与波长有关。对于一个中心波长为 $\\lambda$ 的给定测光滤光片，观测到的仪器星等 $m_\\lambda$ 与大气外星等 $(m_\\lambda)_0$ 之间的关系，可以由布格定律一阶近似地建模为：\n\n$$m_\\lambda = (m_\\lambda)_0 + k_\\lambda X$$\n\n此处，$X$ 是大气质量，用于衡量沿恒星视线方向的大气柱密度总量；$k_\\lambda$ 是该滤光片的一阶消光系数。\n\n一位天文学家在整夜观测一颗非变星，并使用两种不同的测光滤光片——B（蓝色）和V（可见光）进行测量。这产生了一系列共 $N$ 次的观测。对于每次观测 $i$（其中 $i=1, \\dots, N$），都记录下一对测量值：大气质量 $X_i$ 和观测到的仪器色指数，其定义为 $C_i = m_{B,i} - m_{V,i}$。\n\n观测到的色指数 $C_i$ 与大气质量 $X_i$ 之间的关系也可以表示为一个线性模型：\n$$C_i \\approx C_0 + k_C X_i$$\n其中 $C_0$ 是恒星的真实大气外色指数，$k_C$ 是色指数消光系数。为了确定 $C_0$ 和 $k_C$ 的最佳拟合值，通常需要最小化观测色指数与模型预测值之间的残差平方和。\n\n假设有一组共 $N$ 个的观测数据点 $(X_i, C_i)$，请推导能够最小化总残差平方和的大气外色指数 $C_0$ 的解析表达式。请用对给定数据的求和（例如 $\\sum_{i=1}^N X_i, \\sum_{i=1}^N C_i, \\sum_{i=1}^N X_i C_i$ 等）和总观测次数 $N$ 来表示你的答案。", "solution": "我们寻求最小化下式的 $C_0$ 和 $k_C$：\n$$S=\\sum_{i=1}^N\\bigl[C_i-(C_0+k_CX_i)\\bigr]^2.$$ \n定义 \n$$S_x=\\sum_{i=1}^N X_i,\\quad S_y=\\sum_{i=1}^N C_i,\\quad \nS_{xx}=\\sum_{i=1}^N X_i^2,\\quad S_{xy}=\\sum_{i=1}^N X_iC_i.$$ \n令 $\\partial S/\\partial C_0=0$ 和 $\\partial S/\\partial k_C=0$ 可得到正规方程组：\n$$S_y = NC_0 + k_CS_x,$$\n$$S_{xy}=C_0S_x + k_CS_{xx}.$$ \n求解 $C_0$：将第一个方程乘以 $S_{xx}$，第二个方程乘以 $S_x$，然后相减：\n$$S_{xx}S_y - S_xS_{xy}\n  = C_0\\bigl(NS_{xx}-S_x^2\\bigr).$$ \n因此\n$$\nC_0=\\frac{S_{xx}S_y - S_xS_{xy}}{\\,N S_{xx}-S_x^2\\,}.\n$$\n将求和的定义代回，即可得到所求的表达式。", "answer": "$$\\boxed{\\frac{\\bigl(\\sum_{i=1}^N X_i^2\\bigr)\\bigl(\\sum_{i=1}^N C_i\\bigr)-\\bigl(\\sum_{i=1}^N X_i\\bigr)\\bigl(\\sum_{i=1}^N X_iC_i\\bigr)}{N\\sum_{i=1}^N X_i^2-\\bigl(\\sum_{i=1}^N X_i\\bigr)^2}}$$", "id": "226923"}, {"introduction": "在获得精确的恒星颜色后，下一步是将其与理论模型进行比较，以推断其有效温度等物理性质。然而，在使用像 $U-B$ 和 $B-V$ 这样相邻的色指数时，它们的测量误差并非相互独立，因为它们共享了 $B$ 波段的测量值。本练习 [@problem_id:226746] 将演示如何构建正确的 $\\chi^2$ 统计量，它精确地考虑了这种协方差，这是进行严谨且统计上可靠的模型拟合时至关重要的一步。", "problem": "在恒星天体物理学中，估算恒星有效温度的一个常用方法是将其观测到的测光色指数与理论恒星大气模型预测的色指数进行比较。这通常通过最小化一个卡方（$\\chi^2$）统计量来完成，该统计量用以量化观测数据与模型预测之间的拟合优度。\n\n考虑一颗恒星，我们对其在三个标准滤光片中进行了测光测量：$U$（紫外）、$B$（蓝光）和 $V$（可见光）。测得的视星等为 $m_U, m_B, m_V$，相应的独立测光测量误差（标准差）为 $\\sigma_U, \\sigma_B, \\sigma_V$。由这些星等可以构成两个色指数：$(U-B)_{obs} = m_U - m_B$ 和 $(B-V)_{obs} = m_B - m_V$。\n\n对于给定的有效温度，一个恒星大气模型会预测出理论内禀色指数，我们将其表示为 $(U-B)_{mod}$ 和 $(B-V)_{mod}$。我们可以将观测色指数与模型色指数之间的残差定义为：\n$\\Delta_{UB} = (U-B)_{obs} - (U-B)_{mod}$\n$\\Delta_{BV} = (B-V)_{obs} - (B-V)_{mod}$\n\n由于 $B$ 波段星等 $m_B$ 被用于计算两个色指数，因此 $(U-B)_{obs}$ 和 $(B-V)_{obs}$ 的误差不是独立的。在构建 $\\chi^2$ 统计量时必须考虑这种相关性。\n\n对于一组相关测量值，$\\chi^2$ 统计量的一般公式为：\n$$\n\\chi^2 = \\mathbf{r}^T \\mathbf{C}^{-1} \\mathbf{r}\n$$\n其中 $\\mathbf{r}$ 是残差的列向量，$\\mathbf{C}$ 是测量的协方差矩阵。\n\n请推导用于将观测色指数拟合到模型色指数的 $\\chi^2$ 统计量的完整解析表达式。你的最终表达式应以残差 $\\Delta_{UB}$ 和 $\\Delta_{BV}$ 以及测光误差 $\\sigma_U, \\sigma_B, \\sigma_V$ 来表示。", "solution": "1. 定义残差向量\n$$\\mathbf{r}=\\begin{pmatrix}\\Delta_{UB}\\\\\\Delta_{BV}\\end{pmatrix}\n=\\begin{pmatrix}(m_U-m_B)-(U\\!-\\!B)_{mod} \\\\ (m_B-m_V)-(B\\!-\\!V)_{mod}\\end{pmatrix}.$$\n\n2. 计算方差和协方差\n由于 $m_U,m_B,m_V$ 是独立的，其方差分别为 $\\sigma_U^2,\\sigma_B^2,\\sigma_V^2$，\n$$\\mathrm{Var}(U-B)=\\sigma_U^2+\\sigma_B^2,\\quad \\mathrm{Var}(B-V)=\\sigma_B^2+\\sigma_V^2,$$\n$$\\mathrm{Cov}(U-B,B-V)=\\mathrm{Cov}(m_U-m_B,\\;m_B-m_V)=-\\sigma_B^2.$$\n\n3. 构建协方差矩阵\n$$\\mathbf{C}=\\begin{pmatrix}\n\\sigma_U^2+\\sigma_B^2   -\\sigma_B^2\\\\\n-\\sigma_B^2   \\sigma_B^2+\\sigma_V^2\n\\end{pmatrix}.$$\n\n4. 求 $\\mathbf{C}$ 的逆矩阵\n行列式\n$$\\Delta=(\\sigma_U^2+\\sigma_B^2)(\\sigma_B^2+\\sigma_V^2)-(\\!-\\sigma_B^2\\!)^2\n=(\\sigma_U^2+\\sigma_B^2)(\\sigma_B^2+\\sigma_V^2)-\\sigma_B^4.$$\n逆矩阵\n$$\\mathbf{C}^{-1}=\\frac{1}{\\Delta}\n\\begin{pmatrix}\n\\sigma_B^2+\\sigma_V^2   \\sigma_B^2\\\\\n\\sigma_B^2   \\sigma_U^2+\\sigma_B^2\n\\end{pmatrix}.$$\n\n5. 计算 $\\chi^2$\n$$\\chi^2=\\mathbf{r}^T\\mathbf{C}^{-1}\\mathbf{r}\n=\\frac{1}{\\Delta}\\Bigl[(\\sigma_B^2+\\sigma_V^2)\\Delta_{UB}^2\n+2\\sigma_B^2\\,\\Delta_{UB}\\Delta_{BV}+(\\sigma_U^2+\\sigma_B^2)\\Delta_{BV}^2\\Bigr].$$", "answer": "$$\\boxed{\\frac{(\\sigma_B^2+\\sigma_V^2)\\,\\Delta_{UB}^2+2\\,\\sigma_B^2\\,\\Delta_{UB}\\,\\Delta_{BV}+(\\sigma_U^2+\\sigma_B^2)\\,\\Delta_{BV}^2}{(\\sigma_U^2+\\sigma_B^2)(\\sigma_B^2+\\sigma_V^2)-\\sigma_B^4}}$$", "id": "226746"}]}