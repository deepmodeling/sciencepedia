{"hands_on_practices": [{"introduction": "在功能强大的计算机时代到来之前，天体物理学家依靠简化的解析模型来掌握恒星内部的基本原理。多方球模型是其中的一个典型例子，它假设压力和密度之间存在幂律关系。这项练习 [@problem_id:349199] 将指导您推导多方球恒星的总质量 $M$、半径 $R$ 和中心压力 $P_c$ 之间的基本关系，揭示支配这些天体的优雅数学结构。", "problem": "一个处于静力学平衡下的自引力、球对称恒星通常可以被建模为一个多方球体。在这样的模型中，压强 $P$ 和密度 $\\rho$ 通过多方物态方程联系起来：\n$$\nP = K \\rho^{\\gamma} = K \\rho^{1 + 1/n}\n$$\n其中 $K$ 是多方常数，$\\gamma$ 是多方指数，而 $n$ 是多方索引。\n\n这种恒星的结构由莱恩-埃姆登方程所支配，这是静力学平衡方程的一种无量纲形式：\n$$\n\\frac{1}{\\xi^2} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right) = - \\theta^n\n$$\n无量纲函数 $\\theta(\\xi)$ 通过 $\\rho(r) = \\rho_c \\theta^n(\\xi)$ 与密度分布 $\\rho(r)$ 相关联，其中 $\\rho_c$ 是中心密度。无量纲半径 $\\xi$ 通过 $r = \\alpha \\xi$ 与物理半径 $r$ 相关联，其中标度因子 $\\alpha$ 由下式给出：\n$$\n\\alpha = \\left( \\frac{(n+1)K}{4\\pi G} \\rho_c^{(1/n)-1} \\right)^{1/2}\n$$\n此处，G 是引力常数。莱恩-埃姆登方程需在边界条件 $\\theta(0) = 1$ 和 $(d\\theta/d\\xi)|_{\\xi=0} = 0$ 下求解。\n\n对于一个“完全多方球体”，恒星具有一个有限的半径 R，该半径由函数 $\\theta(\\xi)$ 的第一个零点定义，记为 $\\xi_1$。因此，$R = \\alpha \\xi_1$ 且 $\\theta(\\xi_1) = 0$。\n\n恒星的总质量 M、总半径 R 和其中心压强 $P_c$ 之间存在一个基本关系。这个关系可以表示为以下形式：\n$$\nM = C_n \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}}\n$$\n其中 $C_n$ 是一个无量纲系数，仅取决于多方索引 $n$ 和相应莱恩-埃姆登方程解的性质。\n\n请用多方索引 $n$ 和莱恩-埃姆登函数在表面处的导数值 $\\theta'(\\xi_1) \\equiv (d\\theta/d\\xi)|_{\\xi=\\xi_1}$ 来推导系数 $C_n$ 的表达式。", "solution": "推导过程如下：首先找到总质量 $M$ 和中心压强 $P_c$ 关于莱恩-埃姆登变量的表达式，然后将它们结合起来以求得所需的关系。\n\n**步骤1：推导总质量 M 的表达式。**\n总质量 $M$ 是通过对恒星从其中心（$r=0$）到其表面（$r=R$）的整个体积积分密度 $\\rho(r)$ 得到的。\n$$\nM = \\int_0^R 4\\pi r^2 \\rho(r) dr\n$$\n我们使用给定的关系式，进行从 $(r, \\rho)$ 到 $(\\xi, \\theta)$ 的变量替换：\n$r = \\alpha \\xi \\implies dr = \\alpha d\\xi$\n$\\rho(r) = \\rho_c \\theta^n(\\xi)$\n积分上下限从 $r \\in [0, R]$ 变为 $\\xi \\in [0, \\xi_1]$。\n将这些代入质量积分中：\n$$\nM = \\int_0^{\\xi_1} 4\\pi (\\alpha \\xi)^2 (\\rho_c \\theta^n) (\\alpha d\\xi)\n$$\n$$\nM = 4\\pi \\alpha^3 \\rho_c \\int_0^{\\xi_1} \\xi^2 \\theta^n d\\xi\n$$\n现在，我们使用莱恩-埃姆登方程来替换 $\\theta^n$ 项：\n$\\theta^n = -\\frac{1}{\\xi^2} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right)$。\n将此代入质量积分中：\n$$\nM = 4\\pi \\alpha^3 \\rho_c \\int_0^{\\xi_1} \\xi^2 \\left( -\\frac{1}{\\xi^2} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right) \\right) d\\xi\n$$\n$$\nM = -4\\pi \\alpha^3 \\rho_c \\int_0^{\\xi_1} \\frac{d}{d\\xi} \\left( \\xi^2 \\frac{d\\theta}{d\\xi} \\right) d\\xi\n$$\n全导数的积分就是该函数在边界处的值：\n$$\nM = -4\\pi \\alpha^3 \\rho_c \\left[ \\xi^2 \\frac{d\\theta}{d\\xi} \\right]_0^{\\xi_1}\n$$\n在积分上下限处求值：\n在 $\\xi = \\xi_1$ 处，该项为 $\\xi_1^2 (d\\theta/d\\xi)|_{\\xi=\\xi_1} = \\xi_1^2 \\theta'(\\xi_1)$。\n在 $\\xi = 0$ 处，该项为 0，因为 $\\xi^2 \\to 0$ 且 $d\\theta/d\\xi \\to 0$。\n因此，总质量的表达式变为：\n$$\nM = -4\\pi \\alpha^3 \\rho_c \\xi_1^2 \\theta'(\\xi_1)\n$$\n\n**步骤2：将中心压强 $P_c$ 与中心密度 $\\rho_c$ 及标度因子 $\\alpha$ 联系起来。**\n中心压强由在中心处取值的多方物态方程给出：\n$$\nP_c = K \\rho_c^{1+1/n}\n$$\n我们需要消去多方常数 K。我们使用标度因子 $\\alpha$ 的定义：\n$$\n\\alpha^2 = \\frac{(n+1)K}{4\\pi G} \\rho_c^{(1/n)-1}\n$$\n解出 K：\n$$\nK = \\frac{4\\pi G \\alpha^2}{n+1} \\rho_c^{1-1/n}\n$$\n将这个 K 的表达式代入 $P_c$ 的方程中：\n$$\nP_c = \\left( \\frac{4\\pi G \\alpha^2}{n+1} \\rho_c^{1-1/n} \\right) \\rho_c^{1+1/n} = \\frac{4\\pi G \\alpha^2}{n+1} \\rho_c^{(1 - 1/n) + (1 + 1/n)}\n$$\n$$\nP_c = \\frac{4\\pi G \\alpha^2 \\rho_c^2}{n+1}\n$$\n\n**步骤3：结合 M 和 $P_c$ 的表达式以消去 $\\alpha$ 和 $\\rho_c$。**\n从 $P_c$ 的关系式中，我们可以用 $P_c$ 和 $\\alpha$ 来表示 $\\rho_c$：\n$$\n\\rho_c^2 = \\frac{(n+1)P_c}{4\\pi G \\alpha^2} \\implies \\rho_c = \\sqrt{\\frac{(n+1)P_c}{4\\pi G \\alpha^2}} = \\frac{1}{2\\alpha} \\sqrt{\\frac{(n+1)P_c}{\\pi G}}\n$$\n现在，将这个 $\\rho_c$ 的表达式代入质量 M 的方程中：\n$$\nM = -4\\pi \\alpha^3 \\left( \\frac{1}{2\\alpha} \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\right) \\xi_1^2 \\theta'(\\xi_1)\n$$\n$$\nM = -2\\pi \\alpha^2 \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\xi_1^2 \\theta'(\\xi_1)\n$$\n我们还需要消去 $\\alpha$。我们使用恒星半径的关系式 $R = \\alpha \\xi_1$，这意味着 $\\alpha = R/\\xi_1$。\n$$\nM = -2\\pi \\left(\\frac{R}{\\xi_1}\\right)^2 \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\xi_1^2 \\theta'(\\xi_1)\n$$\n$\\xi_1^2$ 项被消掉了：\n$$\nM = -2\\pi R^2 \\sqrt{\\frac{(n+1)P_c}{\\pi G}} \\theta'(\\xi_1)\n$$\n我们来简化常数项：\n$$\nM = -2\\pi R^2 \\frac{\\sqrt{n+1} \\sqrt{P_c}}{\\sqrt{\\pi} \\sqrt{G}} \\theta'(\\xi_1)\n$$\n$$\nM = -2\\sqrt{\\pi} \\sqrt{n+1} \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}} \\theta'(\\xi_1)\n$$\n\n**步骤4：确定系数 $C_n$。**\n我们将推导出的表达式重新整理，以匹配问题陈述中给出的形式 $M = C_n \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}}$：\n$$\nM = \\left( -2\\sqrt{\\pi(n+1)} \\theta'(\\xi_1) \\right) \\frac{R^2 \\sqrt{P_c}}{\\sqrt{G}}\n$$\n通过与目标形式进行比较，我们确定系数 $C_n$ 为：\n$$\nC_n = -2\\sqrt{\\pi(n+1)} \\theta'(\\xi_1)\n$$\n注意，对于一个物理上束缚的恒星，密度向外减小，这意味着 $\\theta'(\\xi_1)$ 是负值，从而使得系数 $C_n$ 为正值。", "answer": "$$ \\boxed{-2\\sqrt{\\pi(n+1)} \\theta'(\\xi_1)} $$", "id": "349199"}, {"introduction": "现代恒星建模需要将恒星结构的连续微分方程转化为一组离散的有限差分方程。这个过程中的一个重大挑战是如何在有限的质量壳层上精确地平均高度敏感的物理量，例如核能生成率 $\\epsilon$。这项实践 [@problem_id:349277] 演示了如何推导对数平均值，这是一种比简单算术平均值精确得多的方法，对于保证模型的数值稳定性至关重要。", "problem": "在用拉格朗日质量坐标 $m$ 对恒星模型进行数值构建时，能量产生方程由 $\\frac{dL}{dm} = \\epsilon$ 给出，其中 $L$ 是光度，$\\epsilon$ 是单位质量的能量产生率。这个微分方程通常在离散质量网格 $\\{m_j\\}$ 上使用有限差分格式求解。\n\n对于一个由界面 $m_j$ 和 $m_{j+1}$ 界定的质量壳层，相应的差分方程写为：\n$$\n\\frac{L_{j+1} - L_j}{m_{j+1} - m_j} = \\bar{\\epsilon}_{j+1/2}\n$$\n此处，$L_j$ 和 $L_{j+1}$ 是壳层边界上的光度，而 $\\bar{\\epsilon}_{j+1/2}$ 代表在壳层上适当平均的能量产生率。\n\n能量产生率 $\\epsilon$ 是当地密度和温度 $\\epsilon(\\rho, T)$ 的一个非常强的函数。一个简单的算术平均 $\\bar{\\epsilon}_{j+1/2} = \\frac{1}{2}(\\epsilon_j + \\epsilon_{j+1})$ 可能不准确。通过在壳层上积分可以获得一个更稳健的平均值，$\\bar{\\epsilon}_{j+1/2} = \\frac{1}{m_{j+1}-m_j} \\int_{m_j}^{m_{j+1}} \\epsilon(m) dm$。\n\n假设在小的质量区间 $[m_j, m_{j+1}]$ 内，能量产生率的自然对数 $\\ln \\epsilon$ 随质量坐标 $m$ 线性变化。基于此假设，推导壳层平均能量产生率 $\\bar{\\epsilon}_{j+1/2}$ 的表达式，用其在壳层边界上的值 $\\epsilon_j \\equiv \\epsilon(m_j)$ 和 $\\epsilon_{j+1} \\equiv \\epsilon(m_{j+1})$ 来表示。", "solution": "我们假设 $\\ln\\epsilon(m)$ 在 $[m_j,m_{j+1}]$ 上线性变化：\n$$\n\\ln\\epsilon(m)\n=\\ln\\epsilon_j\n+\\frac{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}{m_{j+1}-m_j}\\,(m-m_j).\n$$\n定义斜率\n$$\n\\alpha\n=\\frac{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}{m_{j+1}-m_j},\n$$\n因此\n$$\n\\epsilon(m)=\\epsilon_j\\,e^{\\alpha\\,(m-m_j)}.\n$$\n壳层平均率为\n$$\n\\bar\\epsilon_{j+1/2}\n=\\frac{1}{m_{j+1}-m_j}\\int_{m_j}^{m_{j+1}}\\epsilon(m)\\,dm\n=\\frac{\\epsilon_j}{\\alpha\\,(m_{j+1}-m_j)}\n\\bigl[e^{\\alpha\\,(m_{j+1}-m_j)}-1\\bigr].\n$$\n注意到 $\\alpha\\,(m_{j+1}-m_j)=\\ln\\epsilon_{j+1}-\\ln\\epsilon_j$ 且 $e^{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}=\\frac{\\epsilon_{j+1}}{\\epsilon_j}$，可得\n$$\n\\bar\\epsilon_{j+1/2}\n=\\frac{\\epsilon_j}{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}\n\\Bigl(\\frac{\\epsilon_{j+1}}{\\epsilon_j}-1\\Bigr)\n=\\frac{\\epsilon_{j+1}-\\epsilon_j}{\\ln\\epsilon_{j+1}-\\ln\\epsilon_j}.\n$$", "answer": "$$\\boxed{\\frac{\\epsilon_{j+1}-\\epsilon_j}{\\ln(\\epsilon_{j+1})-\\ln(\\epsilon_j)}}$$", "id": "349277"}, {"introduction": "Henyey 方法是现代恒星演化代码的主力，以其解决复杂、非线性的恒星结构方程组的强大能力而闻名。该方法的核心在于将方程线性化并迭代地逼近解。这项高级练习 [@problem_id:349285] 通过计算雅可比矩阵的一个特定元素，让您亲身体验这一过程，从而一窥驱动计算天体物理学的复杂机制。", "problem": "在使用数值松弛方法（例如 Henyey 方法）构建恒星模型时，恒星结构微分方程组被转换为一个有限差分方程组。恒星被划分为一个由 $N$ 个质量壳层组成的网格，网格点由 $j=1, \\dots, N$ 索引。每个网格点 $j$ 处的物理状态由一组变量描述，通常是半径 $r_j$、压强 $P_j$、温度 $T_j$ 和光度 $L_j$。\n\n为了计算方便，这 $4N$ 个变量通常被组织成一个一维状态向量 $\\mathbf{Y}$。从网格点 $j$ 处的物理变量到 $\\mathbf{Y}$ 的分量（记为 $y_k$）的映射定义如下：\n$y_{4(j-1)+1} = r_j$\n$y_{4(j-1)+2} = P_j$\n$y_{4(j-1)+3} = T_j$\n$y_{4(j-1)+4} = L_j$\n\n基本恒星结构方程之一是能量产生方程，它决定了光度 $L$ 随质量 $m$ 的变化。对于一个静态恒星，其在网格点 $j$ 和 $j+1$ 之间中心化的离散形式由下式给出：\n$$\nE_{L, j+1/2} \\equiv \\frac{L_{j+1} - L_j}{\\Delta m_j} - \\epsilon_{n, j+1/2} = 0\n$$\n其中 $\\Delta m_j = m_{j+1} - m_j$ 是壳层的质量。单位质量的核能产生率 $\\epsilon_n$ 由幂律 $\\epsilon_n = \\epsilon_0 \\rho^\\lambda T^\\nu$ 建模，其中 $\\epsilon_0, \\lambda,$ 和 $\\nu$ 是常数。假设恒星物质是理想气体，其密度 $\\rho$ 由状态方程 $\\rho = \\frac{\\mu m_u P}{k_B T}$ 给出，其中 $\\mu$ 是平均分子量，$m_u$ 是原子质量单位，$k_B$ 是玻尔兹曼常数。\n\n中点 $j+1/2$ 处的所有物理量都用相邻网格点上值的算术平均值来近似，即对于任何物理变量 $X$，$X_{j+1/2} = \\frac{1}{2}(X_j + X_{j+1})$。\n\nHenyey 方法将方程组线性化，这需要计算雅可比矩阵元 $\\frac{\\partial E}{\\partial y_k}$。你的任务是推导雅可比矩阵元的解析表达式，该矩阵元表示能量产生差分方程 $E_{L, j+1/2}$ 关于外部网格点温度 $T_{j+1}$ 的偏导数。用网格点变量 $P_j, P_{j+1}, T_j, T_{j+1}$ 和相关物理常数（$\\epsilon_0, \\lambda, \\nu, \\mu, m_u, k_B$）来表示你的最终答案。", "solution": "1. 定义\n$$E_{L,j+1/2}=\\frac{L_{j+1}-L_{j}}{\\Delta m_j}-\\epsilon_{n,j+1/2},$$\n因此\n$$\\frac{\\partial E_{L,j+1/2}}{\\partial T_{j+1}}\n=-\\frac{\\partial\\epsilon_{n,j+1/2}}{\\partial T_{j+1}}.$$\n\n2. 在中点处，\n$$T_{j+1/2}=\\frac{T_j+T_{j+1}}2,\\quad\n\\rho_{j+1/2}=\\frac{\\mu m_u}{k_B}\\,\\frac{P_{j+1/2}}{T_{j+1/2}}\n=\\frac{\\mu m_u}{k_B}\\,\\frac{P_j+P_{j+1}}{T_j+T_{j+1}}.$$\n\n3. 因此\n$$\\epsilon_{n,j+1/2}\n=\\epsilon_0\\,\\rho_{j+1/2}^\\lambda\\,T_{j+1/2}^\\nu\n=\\epsilon_0\\Bigl(\\frac{\\mu m_u}{k_B}\\Bigr)^\\lambda\n\\frac{(P_j+P_{j+1})^\\lambda}{(T_j+T_{j+1})^\\lambda}\n\\Bigl(\\frac{T_j+T_{j+1}}2\\Bigr)^\\nu.$$\n\n4. 求导：\n\n$$\n\\frac{\\partial\\epsilon_{n}}{\\partial T_{j+1}}\n=\\epsilon_n\\Bigl[\\frac{\\lambda}{\\rho_{j+1/2}}\\frac{\\partial\\rho_{j+1/2}}{\\partial T_{j+1}}\n+\\frac{\\nu}{T_{j+1/2}}\\frac12\\Bigr].\n$$\n\n由于\n$$\\frac{\\partial\\rho_{j+1/2}}{\\partial T_{j+1}}\n=-\\frac{\\rho_{j+1/2}}{T_j+T_{j+1}},\\quad\n\\frac{\\partial T_{j+1/2}}{\\partial T_{j+1}}=\\frac12,$$\n可得\n$$\\frac{\\partial\\epsilon_n}{\\partial T_{j+1}}\n=\\epsilon_n\\frac{\\nu-\\lambda}{T_j+T_{j+1}}.$$\n\n5. 因此\n\n$$\n\\frac{\\partial E_{L,j+1/2}}{\\partial T_{j+1}}\n=-\\frac{\\partial\\epsilon_n}{\\partial T_{j+1}}\n=-(\\nu-\\lambda)\\,\\epsilon_0\\Bigl(\\frac{\\mu m_u}{k_B}\\Bigr)^\\lambda\n\\frac{(P_j+P_{j+1})^\\lambda}{(T_j+T_{j+1})^\\lambda}\n\\Bigl(\\frac{T_j+T_{j+1}}2\\Bigr)^\\nu\\frac1{T_j+T_{j+1}}.\n$$\n\n\n6. 化简 $(T_j+T_{j+1})$ 的幂和因子 $2^{-\\nu}$：\n\n$$\n\\frac{(T_j+T_{j+1})^\\nu}{(T_j+T_{j+1})^\\lambda\\,(T_j+T_{j+1})}\n=\\,(T_j+T_{j+1})^{\\nu-\\lambda-1},\\quad\n\\Bigl(\\tfrac1{2}\\Bigr)^\\nu=2^{-\\nu}.\n$$\n\n因此最终表达式为\n\n$$\n\\frac{\\partial E_{L,j+1/2}}{\\partial T_{j+1}}\n=-(\\nu-\\lambda)\\,\\epsilon_0\\Bigl(\\frac{\\mu m_u}{k_B}\\Bigr)^\\lambda\n(P_j+P_{j+1})^\\lambda\\,\\frac{(T_j+T_{j+1})^{\\nu-\\lambda-1}}{2^\\nu}\\,. \n$$", "answer": "$$\\boxed{-(\\nu-\\lambda)\\,\\epsilon_0\\Bigl(\\frac{\\mu m_u}{k_B}\\Bigr)^\\lambda (P_j+P_{j+1})^\\lambda \\frac{(T_j+T_{j+1})^{\\nu-\\lambda-1}}{2^\\nu}}$$", "id": "349285"}]}