{"hands_on_practices": [{"introduction": "许多双星系统由于距离遥远，无法在望远镜中分解为两颗独立的恒星。然而，我们仍然可以通过精确测量系统“光心”（即亮度中心）相对于背景恒星的摆动来揭示其双星特性。本练习将引导你学习如何巧妙地结合光心的天体测量轨道与从光谱观测中得到的质量比，来确定该系统的总质量，这展示了天文学家如何从有限的观测数据中提取出关键的物理参数。[@problem_id:236867]", "problem": "一个未分辨的双星系统被观测为单谱线分光双星 (SB1)，同时也是一个天体测量双星。由于该系统未被分辨，天体测量所追踪的是系统光心（光亮度中心）绕质心的轨道，而非主星自身的轨道。\n\n假设这两颗恒星的质量分别为 $M_1$ 和 $M_2$，光度分别为 $L_1$ 和 $L_2$，它们在一个周期为 $P$ 的圆形轨道上运动。该系统所在距离对应的视差为 $\\varpi$。已测得光心轨道的角半长轴为 $\\alpha_{ph}$。\n\n定义质量比为 $q = M_2/M_1$，光度比为 $\\beta = L_2/L_1$。为了本次推导，假设 $q > \\beta$。万有引力常数为 $G$。\n\n请用给定的参数 $P, \\varpi, \\alpha_{ph}, q, \\beta$ 和常数 $G$ 推导出系统总质量 $M_T = M_1 + M_2$ 的闭合形式表达式。", "solution": "目标是推导出双星系统总质量 $M_T = M_1 + M_2$ 的表达式。我们从开普勒第三定律开始，该定律将总质量与轨道周期 $P$以及相对轨道的半长轴 $a$ 联系起来。\n\n开普勒第三定律由下式给出：\n$$\nM_T = M_1 + M_2 = \\frac{4\\pi^2 a^3}{G P^2}\n$$\n此处，$a$ 是两颗恒星相对轨道（$\\vec{r} = \\vec{r}_1 - \\vec{r}_2$）的半长轴。我们的任务是用给定的可观测量和系统参数来表示 $a$。\n\n半长轴 $a$ 可以表示为两颗恒星各自围绕质心运动的轨道半长轴 $a_1$ 和 $a_2$ 之和：\n$$\na = a_1 + a_2\n$$\n质心的位置定义为满足 $M_1 \\vec{r}_1 + M_2 \\vec{r}_2 = 0$。对于轨道的半长轴，这意味着：\n$$\nM_1 a_1 = M_2 a_2\n$$\n使用质量比 $q = M_2/M_1$，我们可以用 $a_1$ 表示 $a_2$：\n$$\na_2 = \\frac{M_1}{M_2} a_1 = \\frac{1}{q} a_1\n$$\n将此式代入总半长轴 $a$ 的表达式中：\n$$\na = a_1 + \\frac{1}{q} a_1 = a_1 \\left(1 + \\frac{1}{q}\\right) = a_1 \\frac{q+1}{q}\n$$\n现在，我们需要将 $a_1$ 与观测量 $\\alpha_{ph}$ 联系起来。天体测量给出的是光心轨道的半长轴 $a_{ph}$。这个物理尺寸通过以下公式与角尺寸 $\\alpha_{ph}$ 和视差 $\\varpi$ 相关：\n$$\na_{ph} = \\frac{\\alpha_{ph}}{\\varpi}\n$$\n光心相对于质心的位置 $\\vec{r}_{ph}$ 是两颗恒星位置的光度加权平均值：\n$$\n\\vec{r}_{ph} = \\frac{L_1 \\vec{r}_1 + L_2 \\vec{r}_2}{L_1 + L_2}\n$$\n我们可以使用质心定义将 $\\vec{r}_2$ 用 $\\vec{r}_1$ 表示：$\\vec{r}_2 = -(M_1/M_2)\\vec{r}_1 = -(1/q)\\vec{r}_1$。将此式代入光心方程：\n$$\n\\vec{r}_{ph} = \\frac{L_1 \\vec{r}_1 + L_2 (-\\frac{1}{q}\\vec{r}_1)}{L_1 + L_2} = \\vec{r}_1 \\left( \\frac{L_1 - L_2/q}{L_1 + L_2} \\right)\n$$\n我们可以从括号中的项里提出公因子 $L_1$，并使用光度比 $\\beta = L_2/L_1$：\n$$\n\\vec{r}_{ph} = \\vec{r}_1 \\left( \\frac{L_1(1 - (L_2/L_1)/q)}{L_1(1 + L_2/L_1)} \\right) = \\vec{r}_1 \\left( \\frac{1 - \\beta/q}{1 + \\beta} \\right)\n$$\n这个关系对半长轴同样成立。由于我们假设 $q > \\beta$，项 $(1 - \\beta/q)$ 是正的。\n$$\na_{ph} = a_1 \\frac{1 - \\beta/q}{1 + \\beta} = a_1 \\frac{q - \\beta}{q(1 + \\beta)}\n$$\n我们现在可以解出 $a_1$（用 $a_{ph}$ 表示）：\n$$\na_1 = a_{ph} \\frac{q(1 + \\beta)}{q - \\beta}\n$$\n代入 $a_{ph} = \\alpha_{ph}/\\varpi$：\n$$\na_1 = \\frac{\\alpha_{ph}}{\\varpi} \\frac{q(1 + \\beta)}{q - \\beta}\n$$\n现在我们将这个 $a_1$ 的表达式代入总半长轴的方程 $a = a_1 \\frac{q+1}{q}$ 中：\n$$\na = \\left( \\frac{\\alpha_{ph}}{\\varpi} \\frac{q(1 + \\beta)}{q - \\beta} \\right) \\left( \\frac{q+1}{q} \\right) = \\frac{\\alpha_{ph}}{\\varpi} \\frac{(1 + \\beta)(1 + q)}{q - \\beta}\n$$\n最后，我们将这个完整的 $a$ 的表达式代入开普勒第三定律，以求得总质量 $M_T$：\n$$\nM_T = \\frac{4\\pi^2}{G P^2} a^3 = \\frac{4\\pi^2}{G P^2} \\left( \\frac{\\alpha_{ph}}{\\varpi} \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3\n$$\n这可以化简为总质量的最终表达式：\n$$\nM_T = \\frac{4\\pi^2 \\alpha_{ph}^3}{G P^2 \\varpi^3} \\left( \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3\n$$", "answer": "$$\n\\boxed{\\frac{4\\pi^2 \\alpha_{ph}^3}{G P^2 \\varpi^3} \\left( \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3}\n$$", "id": "236867"}, {"introduction": "宇宙的复杂性常常超出我们最简单的模型。一个看似是双星的系统，实际上可能是一个层级式三体系统的一部分，其中一颗遥远的第三颗恒星会对内部双星产生扰动。本练习旨在解决这种常见情况：第三体的引力会导致双星的视向速度出现可测量的线性漂移，你将学习如何推导出一个修正公式，以校正由此产生的质量比测量误差。[@problem_id:237039]", "problem": "在双谱分光双星（SB2）的研究中，两颗子星的质量比 $q = m_2/m_1$ 通常根据它们视向速度曲线的半振幅 $K_1$ 和 $K_2$ 来确定。对于圆形轨道，两颗恒星相对于系统质心的视向速度由 $v_{r,1}(t) = K_1 \\sin(\\omega t + \\phi)$ 和 $v_{r,2}(t) = -K_2 \\sin(\\omega t + \\phi)$ 给出。由于质心的定义为 $m_1 v_1 + m_2 v_2 = 0$，因此可以推导出 $m_1 K_1 = m_2 K_2$，从而得到真实质量比的标准公式：$q_{true} = m_2/m_1 = K_1/K_2$。\n\n考虑这样一种情况：该双星系统本身是一个更宽的三体系统的一部分。一个遥远的第三天体的引力影响导致内双星的质心加速。在观测的时间跨度内，这个加速度可以近似为常数，导致观测到的视向速度出现线性漂移。\n\n因此，观测到的两颗恒星的视向速度并非纯正弦形式，而是包含了这种漂移：\n$$ v_{obs,1}(t) = K_1 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t $$\n$$ v_{obs,2}(t) = -K_2 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t $$\n在这里，$K_1$ 和 $K_2$ 是真实的半振幅，$\\omega$ 是内双星的轨道频率，$\\gamma_0$ 是 $t=0$ 时的平均系统速度，而 $\\dot{\\gamma}$ 是系统速度的恒定变化率（即加速度）。为简单起见，通过选择合适的时间起点，将相位 $\\phi$ 设置为零。\n\n一位天文学家未意识到第三天体的存在，通过将标准正弦模型 $v_{fit}(t) = K_{obs} \\sin(\\omega t + \\phi_{obs}) + \\gamma_{obs}$ 拟合到跨越多个轨道周期的时间间隔 $T$ 内的观测视向速度曲线上来分析数据。这个过程得出了观测到的（也是不正确的）半振幅 $K_{obs,1}$ 和 $K_{obs,2}$。根据这些值，计算出观测质量比为 $q_{obs} = K_{obs,1} / K_{obs,2}$。\n\n您的任务是推导一个用观测质量比 $q_{obs}$ 和无量纲参数 $\\alpha = \\frac{2\\dot{\\gamma}}{\\omega K_{obs,2}}$ 表示的真实质量比 $q_{true}$ 的表达式。这个参数 $\\alpha$ 由可通过观测数据确定的量构成：漂移 $\\dot{\\gamma}$（可以从更复杂的拟合或简单正弦拟合的残差中求得）、轨道频率 $\\omega$ 以及次星的观测半振幅 $K_{obs,2}$。", "solution": "1.  **确定观测振幅**：天文学家将模型 $v(t) = A\\sin(\\omega t) + B\\cos(\\omega t) + C$ 拟合到数据。通过傅里叶分析，正弦项的系数 $A$ 由以下积分给出：\n    $$ A = \\frac{2}{T} \\int_{0}^{T} v_{obs}(t) \\sin(\\omega t) dt $$\n    其中 $T$ 是观测总时长，且 $T$ 是轨道周期 $P=2\\pi/\\omega$ 的整数倍。\n    对于主星 (star 1)：\n    $$ A_1 = \\frac{2}{T} \\int_{0}^{T} (K_1 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t) \\sin(\\omega t) dt = K_1 - \\frac{2\\dot{\\gamma}}{\\omega} $$\n    类似地，对于伴星 (star 2)：\n    $$ A_2 = \\frac{2}{T} \\int_{0}^{T} (-K_2 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t) \\sin(\\omega t) dt = -K_2 - \\frac{2\\dot{\\gamma}}{\\omega} $$\n    由于余弦项的系数经计算为零，观测到的振幅就是 $|A|$。定义漂移项 $d \\equiv \\frac{2\\dot{\\gamma}}{\\omega}$。\n    观测到的振幅为 $K_{obs,1} = |A_1| = K_1 - d$ (假设 $K_1>d$) 和 $K_{obs,2} = |A_2| = |-K_2 - d| = K_2 + d$。\n\n2.  **建立观测质量比与真实质量比的关系**：\n    观测质量比由 $q_{obs} = \\frac{K_{obs,1}}{K_{obs,2}} = \\frac{K_1 - d}{K_2 + d}$ 给出。\n    真实质量比为 $q_{true} = \\frac{K_1}{K_2}$，所以 $K_1 = q_{true} K_2$。\n    代入上式：\n    $$ q_{obs} = \\frac{q_{true} K_2 - d}{K_2 + d} $$\n\n3.  **用可观测量表示 $K_2$ 和 $d$**：\n    从上式解出 $K_2$:\n    $$ q_{obs}(K_2 + d) = q_{true} K_2 - d \\implies d(q_{obs} + 1) = K_2(q_{true} - q_{obs}) \\implies K_2 = \\frac{d(q_{obs} + 1)}{q_{true} - q_{obs}} $$\n    我们有 $K_{obs,2} = K_2 + d$。将 $K_2$ 的表达式代入：\n    $$ K_{obs,2} = \\frac{d(q_{obs} + 1)}{q_{true} - q_{obs}} + d = d \\frac{(q_{obs} + 1) + (q_{true} - q_{obs})}{q_{true} - q_{obs}} = d \\frac{q_{true} + 1}{q_{true} - q_{obs}} $$\n\n4.  **引入无量纲参数 $\\alpha$**：\n    问题中定义的参数是 $\\alpha = \\frac{2\\dot{\\gamma}}{\\omega K_{obs,2}} = \\frac{d}{K_{obs,2}}$。\n    将上一步的结果代入：\n    $$ \\alpha = \\frac{d}{d \\frac{q_{true} + 1}{q_{true} - q_{obs}}} = \\frac{q_{true} - q_{obs}}{q_{true} + 1} $$\n\n5.  **求解 $q_{true}$**：\n    现在我们可以从关于 $\\alpha$ 的方程中解出 $q_{true}$：\n    $$ \\alpha (q_{true} + 1) = q_{true} - q_{obs} $$\n    $$ \\alpha q_{true} + \\alpha = q_{true} - q_{obs} $$\n    $$ q_{obs} + \\alpha = q_{true}(1 - \\alpha) $$\n    $$ q_{true} = \\frac{q_{obs} + \\alpha}{1 - \\alpha} $$", "answer": "$$\\boxed{\\frac{q_{obs}+\\alpha}{1-\\alpha}}$$", "id": "237039"}, {"introduction": "在天体物理学中，确定轨道参数只是完成了一半的工作，理解这些参数的不确定性对于科学严谨性而言同等重要。任何天体测量中固有的随机误差，都会不可避免地传播到计算出的轨道根数中。本练习将深入探讨目视双星轨道确定的统计基础，指导你推导 Thiele-Innes 常数的协方差矩阵，它完整地描述了拟合出的轨道参数的不确定性及其相互之间的关联，是任何严谨数据分析中至关重要的一步。[@problem_id:236830]", "problem": "目视双星系统的视轨道可以通过将其真实轨道投影到天球平面上来描述。伴星相对于主星的直角坐标 $(x(t), y(t))$ 是时间 $t$ 的函数。对于一个非线性参数（周期 $P$、近星点通过时间 $T$ 和偏心率 $e$）已知的轨道，其位置坐标可以表示为四个被称为 Thiele-Innes 常数（记为 $A, B, F, G$）的线性组合。该模型为：\n$$\nx(t) = A X(t) + F Y(t) \\\\\ny(t) = B X(t) + G Y(t)\n$$\n此处，$X(t) = \\cos E(t) - e$ 和 $Y(t) = \\sqrt{1-e^2} \\sin E(t)$ 是轨道基函数，其中 $E(t)$ 是偏近点角。对于在时刻 $t_k$ 进行的一组 $N$ 次观测，这些基函数取已知值 $X_k = X(t_k)$ 和 $Y_k = Y(t_k)$。\n\n考虑在时刻 $t_k$（$k=1, \\dots, N$）进行的一组 $N$ 次天体测量观测 $(x_k, y_k)$。与每个坐标 $x_k$ 和 $y_k$ 相关的测量误差是独立同分布的，服从均值为零、方差为已知的常数 $\\sigma^2$ 的高斯分布。不同观测时刻之间的误差也是独立的。\n\nThiele-Innes 常数通过最小化残差平方和（线性最小二乘法）来估计。这些估计参数的不确定性由其协方差矩阵来表征。\n\n你的任务是推导估计参数矢量 $\\mathbf{c} = (A, B, F, G)^T$ 的 $4 \\times 4$ 协方差矩阵 $C_{\\mathbf{c}}$。用测量方差 $\\sigma^2$ 和以下关于已知基函数的求和来表示你的答案：\n$$\nS_{XX} \\equiv \\sum_{k=1}^{N} X_k^2, \\quad S_{YY} \\equiv \\sum_{k=1}^{N} Y_k^2, \\quad S_{XY} \\equiv \\sum_{k=1}^{N} X_k Y_k\n$$", "solution": "1.  **模型分离**: 线性模型 $x(t) = A X(t) + F Y(t)$ 和 $y(t) = B X(t) + G Y(t)$ 是相互独立的。因为对 $(x_k, y_k)$ 的测量误差是独立的，所以我们可以分别对 $x$ 坐标和 $y$ 坐标进行最小二乘拟合。对 $(A, F)$ 的估计只依赖于 $x_k$ 数据，而对 $(B, G)$ 的估计只依赖于 $y_k$ 数据。这意味着 $(A, F)$ 的估计量与 $(B, G)$ 的估计量是不相关的。因此，完整的 $4 \\times 4$ 协方差矩阵 $C_{\\mathbf{c}}$ 将具有块结构，其中 $\\mathrm{Cov}(A,B)$、$\\mathrm{Cov}(A,G)$、$\\mathrm{Cov}(F,B)$、$\\mathrm{Cov}(F,G)$ 均为零。\n\n2.  **为 x 坐标拟合**: 对于 $N$ 个观测点，模型可以写成矩阵形式 $\\mathbf{x} = \\mathbf{D} \\mathbf{p}_x + \\mathbf{\\epsilon}_x$，其中 $\\mathbf{x} = (x_1, \\dots, x_N)^T$，$\\mathbf{p}_x = (A, F)^T$，设计矩阵 $\\mathbf{D}$ 的第 $k$ 行为 $(X_k, Y_k)$。根据最小二乘理论，参数 $\\mathbf{p}_x$ 的协方差矩阵为 $\\mathrm{Cov}(\\mathbf{p}_x) = \\sigma^2 (\\mathbf{D}^T \\mathbf{D})^{-1}$。\n\n3.  **计算 $(\\mathbf{D}^T \\mathbf{D})^{-1}$**: 矩阵 $\\mathbf{D}^T \\mathbf{D}$ 计算如下：\n    $$\n    \\mathbf{D}^T \\mathbf{D} = \\begin{pmatrix} \\sum X_k^2 & \\sum X_k Y_k \\\\ \\sum X_k Y_k & \\sum Y_k^2 \\end{pmatrix} = \\begin{pmatrix} S_{XX} & S_{XY} \\\\ S_{XY} & S_{YY} \\end{pmatrix}\n    $$\n    该 $2 \\times 2$ 矩阵的逆矩阵为：\n    $$\n    (\\mathbf{D}^T \\mathbf{D})^{-1} = \\frac{1}{S_{XX}S_{YY}-S_{XY}^2} \\begin{pmatrix} S_{YY} & -S_{XY} \\\\ -S_{XY} & S_{XX} \\end{pmatrix}\n    $$\n    因此，$\\mathrm{Cov}((A, F)^T) = \\frac{\\sigma^2}{S_{XX}S_{YY}-S_{XY}^2} \\begin{pmatrix} S_{YY} & -S_{XY} \\\\ -S_{XY} & S_{XX} \\end{pmatrix}$。\n\n4.  **组合成完整的协方差矩阵**: 由于对 $y$ 坐标的拟合（参数为 $(B, G)$）使用相同的设计矩阵 $\\mathbf{D}$ 和相同的误差方差 $\\sigma^2$，所以其协方差矩阵 $\\mathrm{Cov}((B, G)^T)$ 与 $\\mathrm{Cov}((A, F)^T)$ 相同。完整的协方差矩阵 $C_{\\mathbf{c}}$ (对应参数矢量 $\\mathbf{c} = (A, B, F, G)^T$) 是：\n    $$\n    C_{\\mathbf{c}} = \\begin{pmatrix}\n    \\mathrm{Var}(A) & \\mathrm{Cov}(A,B) & \\mathrm{Cov}(A,F) & \\mathrm{Cov}(A,G) \\\\\n    \\mathrm{Cov}(B,A) & \\mathrm{Var}(B) & \\mathrm{Cov}(B,F) & \\mathrm{Cov}(B,G) \\\\\n    \\mathrm{Cov}(F,A) & \\mathrm{Cov}(F,B) & \\mathrm{Var}(F) & \\mathrm{Cov}(F,G) \\\\\n    \\mathrm{Cov}(G,A) & \\mathrm{Cov}(G,B) & \\mathrm{Cov}(G,F) & \\mathrm{Var}(G)\n    \\end{pmatrix}\n    $$\n    根据第1步的独立性，非对角块为零，并且 $\\mathrm{Var}(A)=\\mathrm{Var}(B)$、$\\mathrm{Var}(F)=\\mathrm{Var}(G)$、$\\mathrm{Cov}(A,F)=\\mathrm{Cov}(B,G)$。代入数值得到：\n    $$\n    C_{\\mathbf{c}} = \\frac{\\sigma^2}{S_{XX}S_{YY}-S_{XY}^2} \\begin{pmatrix}\n    S_{YY} & 0 & -S_{XY} & 0 \\\\\n    0 & S_{YY} & 0 & -S_{XY} \\\\\n    -S_{XY} & 0 & S_{XX} & 0 \\\\\n    0 & -S_{XY} & 0 & S_{XX}\n    \\end{pmatrix}\n    $$\n    这个结果与最终的答案相匹配。", "answer": "$$\\boxed{\n\\frac{\\sigma^2}{S_{XX}S_{YY}-S_{XY}^2}\n\\begin{pmatrix}\nS_{YY} & 0 & -S_{XY} & 0\\\\\n0 & S_{YY} & 0 & -S_{XY}\\\\\n-S_{XY} & 0 & S_{XX} & 0\\\\\n0 & -S_{XY} & 0 & S_{XX}\n\\end{pmatrix}\n}$$", "id": "236830"}]}