{"hands_on_practices": [{"introduction": "这个练习将我们的理解建立在三角视差法的基本几何原理之上。它探讨了观测基线——即观测者轨道的半径——如何直接影响我们测量的恒星视运动的大小。通过比较从地球和火星上观测到的同一颗恒星的视差椭圆 [@problem_id:318657]，我们可以巩固对这一核心概念的理解，即更长的基线能够产生更大的视差角，从而实现更精确的距离测量。", "problem": "三角视差法是天文学距离测量的基石。当一颗行星围绕其主星运行时，一颗邻近的恒星会在天球上，以更遥远的、看似固定的恒星为背景，描绘出一个小椭圆。这个视路径被称为视差椭圆。对于一颗在半径为 $a$ 的圆形轨道上围绕其主星运行的行星，对于距离为 $d$（其中 $d \\gg a$）的恒星，其视差椭圆的半长轴 $\\alpha$ 由视差角 $p$ 本身（以弧度表示）给出。视差角由小角度近似 $p \\approx a/d$ 定义。\n\n考虑一颗距离太阳固定距离 $d$ 的恒星。从太阳系内的两个不同位置观测其位置：地球和火星。假设两颗行星都围绕太阳在共面的圆形轨道上运行，轨道半径分别为 $a_E$ 和 $a_M$。从每颗行星上的观测者看来，这颗恒星会描绘出不同的视差椭圆。设 $\\alpha_E$ 是从地球测量的视差椭圆的半长轴，$\\alpha_M$ 是从火星测量的视差椭圆的半长轴。\n\n推导比率 $\\alpha_E / \\alpha_M$ 的表达式。", "solution": "1. 视差角的小角度近似为\n$$p\\approx\\frac{a}{d}.$$\n\n2. 对于地球上的观测者（轨道半径 $a_E$），视差椭圆的半长轴为\n$$\\alpha_E=\\frac{a_E}{d}.$$\n\n3. 对于火星上的观测者（轨道半径 $a_M$），半长轴为\n$$\\alpha_M=\\frac{a_M}{d}.$$\n\n4. 两者相比得出\n$$\\frac{\\alpha_E}{\\alpha_M}\n=\\frac{\\displaystyle\\frac{a_E}{d}}{\\displaystyle\\frac{a_M}{d}}\n=\\frac{a_E}{a_M}\\,. $$", "answer": "$$\\boxed{\\frac{a_E}{a_M}}$$", "id": "318657"}, {"introduction": "虽然公式 $d = 1/p$ 看起来很简单，但将一个带有内在不确定性的测量视差（$p$）转换为距离（$d$）并非易事。这个问题揭示了一种由这种非线性转换引起的微妙但至关重要的统计偏差 [@problem_id:318514]，这一现象在天体物理学中通常被称为 Lutz-Kelker 偏差。理解这种偏差对于准确解释视差数据至关重要，并强调了在数据分析中谨慎处理非线性关系的重要性。", "problem": "在天体物理测量中，到近邻恒星的距离 $d$ 通常使用三角视差法来确定。以角秒为单位测量的视差角 $p$ 与以秒差距为单位测量的距离 $d$ 之间存在简单的反比关系 $d=1/p$。\n\n对恒星视差的单次测量并非完全精确，会受到随机误差的影响。设恒星的真实视差为 $p_0$，其对应的真实距离为 $d_0 = 1/p_0$。一次观测测量得到一个值 $p$，它可以被描述为一个随机变量。测量过程是无偏的，这意味着测量值的期望值等于真实值，即 $E[p] = p_0$。测量的不确定度由其标准差 $\\sigma_p = \\sqrt{E[(p-p_0)^2]}$ 来表征。我们假设误差分布关于均值对称，这意味着所有奇数阶中心矩均为零（即，对于整数 $k \\ge 0$，有 $E[(p-p_0)^{2k+1}] = 0$）。\n\n天文学家使用朴素公式 $d_\\text{est} = 1/p$ 来计算估计距离。由于此公式涉及对测量量 $p$ 的非线性变换，因此估计距离的期望值 $E[d_\\text{est}]$ 不会等于真实距离 $d_0$。这会导致系统性偏差。\n\n假设测量不确定度与视差本身相比很小（即 $\\sigma_p \\ll p_0$），推导距离估计中期望分数误差的主导阶近似。分数误差定义为 $\\delta_d = (E[d_\\text{est}] - d_0) / d_0$。你的最终表达式应以真实视差 $p_0$ 及其标准差 $\\sigma_p$ 表示。", "solution": "1. 定义估计距离和分数误差：\n$$d_\\text{est}=\\frac1p,\\quad \\delta_d=\\frac{E[d_\\text{est}]-d_0}{d_0},\\quad d_0=\\frac1{p_0}.$$  \n2. 将 $1/p$ 在 $p_0$ 附近进行泰勒级数展开：\n$$\\frac1p=\\frac1{p_0}+\\Bigl(-\\frac1{p_0^2}\\Bigr)(p-p_0)+\\frac12\\Bigl(\\frac{2}{p_0^3}\\Bigr)(p-p_0)^2+\\cdots.$$  \n3. 取期望值，使用 $E[p-p_0]=0$ 和 $E[(p-p_0)^2]=\\sigma_p^2$：\n$$E\\Bigl[\\frac1p\\Bigr]=\\frac1{p_0}+\\frac{1}{p_0^3}\\,\\sigma_p^2+O(\\sigma_p^4).$$  \n4. 计算分数偏差：\n$$\\delta_d=\\frac{E[d_\\text{est}]-d_0}{d_0}\n=\\frac{\\bigl(\\frac1{p_0}+\\frac{\\sigma_p^2}{p_0^3}\\bigr)-\\frac1{p_0}}{\\frac1{p_0}}\n=\\frac{\\sigma_p^2}{p_0^2}+O(\\sigma_p^4).$$", "answer": "$$\\boxed{\\frac{\\sigma_p^2}{p_0^2}}$$", "id": "318514"}, {"introduction": "现代天体测量学很少直接测量恒星的绝对位置。相反，我们测量的是目标星相对于一组背景参考星的运动，而这些参考星本身并非位于无穷远处。本练习深入探讨了一个现实场景 [@problem_id:318553]，你必须通过同时考虑测量噪声和参考星固有的视差分布（即“宇宙学方差”），来构建目标星绝对视差的最佳（无偏、最小方差）估计值。这个问题演示了在真实的天体测量数据处理中，如何结合先验知识来优化最终结果。", "problem": "在天体物理天体测量学中，目标恒星的绝对视差 $\\pi_T$ 是通过测量其相对于一组更遥远的背景参考星的视运动来确定的。在实践中，这些参考星并非无限远，它们自身也具有微小且未知的视差。观测者进行一系列 $N$ 次独立测量，其中每次测量 $y_i$ ($i = 1, \\dots, N$) 是目标恒星相对于一颗*不同*的参考星 $i$ 的视差。\n\n测量模型由下式给出：\n$$y_i = (\\pi_T - \\pi_i) + \\epsilon_i$$\n其中 $\\pi_i$ 是第 $i$ 颗参考星的真实绝对视差，$\\epsilon_i$ 是随机测量误差，该误差从一个均值 $E[\\epsilon_i] = 0$、方差 $Var(\\epsilon_i) = \\sigma_i^2$ 的分布中抽样得到。\n\n参考星选自一个我们拥有其统计模型的恒星族。它们的真实绝对视差 $\\pi_i$ 被视为随机变量，从一个总体中抽样，该总体的均值取决于一个可测量的属性，例如视星等 $m_i$。该关系由一个已知函数 $E[\\pi_i] = g(m_i)$ 给出。参考星视差围绕该均值的内在弥散被称为“宇宙方差”，并假定对所有参考星都是一个常数，$Var(\\pi_i - g(m_i)) = \\sigma_\\pi^2$。\n\n所有的测量误差 $\\epsilon_i$ 和宇宙弥散项 $\\delta_i = \\pi_i - g(m_i)$ 都是相互不相关的。\n\n我们希望使用一个作为测量值 $y_i$ 的线性函数的估计量，来找到目标恒星绝对视差 $\\pi_T$ 的最佳可能估计：\n$$\\hat{\\pi}_T = \\sum_{i=1}^N w_i y_i + C$$\n其中 $w_i$ 是恒定权重，$C$ 是一个常数偏移量。\n\n首先，通过施加其必须是无偏的条件，即 $E[\\hat{\\pi}_T] = \\pi_T$，来确定该估计量的形式。这将建立起 $C$ 与权重 $w_i$ 之间的关系，以及对权重本身的约束。\n\n然后，找到使该无偏估计量方差 $Var(\\hat{\\pi}_T)$ 最小化的最优权重集 $w_i$。\n\n推导这个最小方差 $Var(\\hat{\\pi}_T)_{min}$ 的表达式。", "solution": "我们有测量值\n$$y_i = (\\pi_T - \\pi_i) + \\epsilon_i,\\quad E[\\epsilon_i]=0,\\;Var(\\epsilon_i)=\\sigma_i^2$$  \n和先验\n$$E[\\pi_i]=g(m_i),\\quad\\pi_i = g(m_i)+\\delta_i,\\;Var(\\delta_i)=\\sigma_\\pi^2.$$  \n\n1. 无偏性\nE[y_i]=\\pi_T - g(m_i)  \n$$E[\\hat\\pi_T]=\\sum_i w_iE[y_i]+C\n=\\pi_T\\sum_i w_i-\\sum_i w_i g(m_i)+C\\stackrel{!}{=}\\pi_T$$  \n得出\n$$\\sum_{i=1}^N w_i=1,\\quad C=\\sum_{i=1}^N w_i g(m_i).$$  \n\n2. 方差\n使用 $y_i=\\pi_T-g(m_i)-\\delta_i+\\epsilon_i$ 我们发现\n$$\\hat\\pi_T=\\pi_T-\\sum_i w_i\\delta_i+\\sum_i w_i\\epsilon_i$$  \n所以\n$$Var(\\hat\\pi_T)=\\sum_{i=1}^N w_i^2\\bigl(\\sigma_\\pi^2+\\sigma_i^2\\bigr).$$  \n\n3. 最优权重\n在 $\\sum_i w_i=1$ 约束下，通过拉格朗日方法最小化 $\\sum_i w_i^2V_i$（其中 $V_i=\\sigma_\\pi^2+\\sigma_i^2$）：\n$$\\frac{\\partial}{\\partial w_i}:\\;2w_iV_i-2\\lambda=0\\;\\Rightarrow\\;w_i=\\frac{\\lambda}{V_i},$$  \n$$\\sum_i w_i=1\\;\\Rightarrow\\;\\lambda=\\Bigl(\\sum_{j=1}^N\\frac1{V_j}\\Bigr)^{-1}.$$  \n因此\n$$w_i=\\frac{1/V_i}{\\sum_j1/V_j},\\quad Var_{\\min}=\\sum_i w_i^2V_i\n=\\frac{1}{\\sum_{i=1}^N\\frac1{V_i}}.$$", "answer": "$$\\boxed{\\frac{1}{\\sum_{i=1}^N \\frac{1}{\\sigma_i^2 + \\sigma_\\pi^2}}}$$", "id": "318553"}]}