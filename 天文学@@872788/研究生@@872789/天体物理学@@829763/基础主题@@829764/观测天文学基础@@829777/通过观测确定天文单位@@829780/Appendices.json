{"hands_on_practices": [{"introduction": "第一个练习探讨了一种巧妙的经典方法来确定天文单位。通过将源自光谱学的太阳自转速度与其在天空中的视大小巧妙地结合起来，我们可以推导出到太阳的距离。这个练习展示了如何统一不同的观测领域来解决一个基本问题 [@problem_id:206168]。", "problem": "一位天文学家试图确定天文单位 $D$ 的值，该值定义为地球与太阳之间的平均距离。这个时代的技术允许对太阳进行精确的光谱学和天体测量学测量。通过结合这些观测数据，可以在不依赖恒星或行星视差的情况下推导出 $D$ 的值。以下与太阳赤道相关的观测数据是可用的：\n\n1.  赤道表面速度 $v_{eq}$，由从太阳相对（接近和后退）边缘观测到的谱线的最大多普勒频移确定。\n2.  从地球观测到的太阳平均角直径 $\\theta$，以弧度表示。已知此角度非常小。\n3.  恒星自转周期 $T_{sid}$，即太阳相对于遥远恒星完成一次完整自转所需的时间。\n\n假设太阳是一个完美的球体，其自转轴垂直于黄道面（地球轨道平面），请为天文单位 $D$ 推导一个纯符号表达式。您的推导应使用给定参数 $v_{eq}$、$\\theta$ 和 $T_{sid}$ 的子集或全部，以及任何必要的数学常数来表示。", "solution": "1. 相关方程：\n   a. 太阳角直径的小角度关系式：  \n      $$\\theta = \\frac{2R}{D}.$$\n   b. 自转产生的赤道表面速度：  \n      $$v_{eq} = \\omega R,\\quad \\omega = \\frac{2\\pi}{T_{sid}}.$$\n2. 用 $v_{eq}$ 和 $T_{sid}$ 表示太阳半径 $R$：  \n   $$v_{eq} = \\frac{2\\pi}{T_{sid}}\\,R \n     \\;\\Longrightarrow\\; \n     R = \\frac{v_{eq}\\,T_{sid}}{2\\pi}.$$\n3. 将 $R$ 代入小角度关系式并求解 $D$：  \n   $$\\theta = \\frac{2R}{D}\n     \\;\\Longrightarrow\\;\n     D = \\frac{2R}{\\theta}\n     = \\frac{2}{\\theta}\\,\\frac{v_{eq}\\,T_{sid}}{2\\pi}\n     = \\frac{v_{eq}\\,T_{sid}}{\\pi\\,\\theta}.$$", "answer": "$$\\boxed{\\frac{v_{eq}\\,T_{sid}}{\\pi\\,\\theta}}$$", "id": "206168"}, {"introduction": "超越经典方法，本实践展示了一种利用动态视差的现代技术。我们将分析从两个独立天文台观测到的小行星掩星事件的时间延迟，进行一种宇宙尺度的三角测量，从而将以公里为单位的已知地球基线直接与天文单位联系起来 [@problem_id:206069]。这个问题凸显了高精度授时在当代天体测量学中的强大作用。", "problem": "观测到一个小行星掩食一颗遥远的恒星。地球上的两个天文台记录了这一事件，它们之间的基线长度已知。通过分析两个观测点观测到掩食的时间差，可以确定天文单位（AU）的长度。\n\n我们在一个二维笛卡尔坐标系 $(x,y)$ 中对此情景进行建模。该坐标系位于“天球平面”上，该平面与恒星位置处的天球相切，并垂直于视线方向。\n\n已知以下量：\n1.  两个天文台之间的基线矢量，投影到天球平面上，由 $\\vec{b} = (b_x, b_y)$ 给出。其分量以千米（km）为单位。假设该矢量在整个观测期间保持不变。\n2.  两个天文台观测到恒星消失的时间差为 $\\Delta t$，以秒（s）为单位。设天文台2在天文台1之后 $\\Delta t$ 时间经历此事件。\n3.  根据地球和小行星已知的轨道根数，计算出小行星相对于地球的横向速度矢量，投影到天球平面上为 $\\vec{V} = (V_x, V_y)$。其分量以天文单位每秒（AU/s）为单位表示。\n\n在掩食扫过天文台基线的短暂时间内，可以做出以下简化假设：\n- 小行星的影子以恒定速度扫过天球平面。\n- 导致恒星消失的小行星影子的前缘，可以近似为一条垂直于其速度矢量运动的直线。\n\n推导一个以千米为单位的天文单位（AU）的公式，用给定的量 $b_x, b_y, V_x, V_y,$ 和 $\\Delta t$ 表示。", "solution": "1. 设 $L$ 表示1个天文单位（AU）的长度，单位为千米（km）。小行星在天球平面上的速度（单位为 km/s）为\n$$\\vec V_{\\rm km} = L\\,\\vec V = \\bigl(LV_x,\\;LV_y\\bigr)\\,. $$\n\n2. 其速率和单位方向为\n$$|\\vec V_{\\rm km}| = L\\,\\sqrt{V_x^2+V_y^2},\\qquad \n\\hat v = \\frac{\\vec V_{\\rm km}}{|\\vec V_{\\rm km}|}\n= \\frac{\\vec V}{\\sqrt{V_x^2+V_y^2}}\\,. $$\n\n3. 两个观测点沿运动方向的投影距离为\n$$\\vec b\\cdot\\hat v = \\frac{b_xV_x+b_yV_y}{\\sqrt{V_x^2+V_y^2}}\\,. $$\n\n4. 时间延迟 $\\Delta t$ 等于这个投影距离除以影子的速度：\n$$\n\\Delta t = \\frac{\\vec b\\cdot\\hat v}{|\\vec V_{\\rm km}|}\n= \\frac{(b_xV_x+b_yV_y)/\\sqrt{V_x^2+V_y^2}}{L\\,\\sqrt{V_x^2+V_y^2}}\n= \\frac{b_xV_x+b_yV_y}{L\\,(V_x^2+V_y^2)}\\,. \n$$\n\n5. 解出 $L$，即可得到以千米为单位的天文单位：\n$$\nL = \\frac{b_xV_x+b_yV_y}{\\Delta t\\,(V_x^2+V_y^2)}\\,. \n$$", "answer": "$$\\boxed{\\frac{b_xV_x+b_yV_y}{\\Delta t\\,(V_x^2+V_y^2)}}$$", "id": "206069"}, {"introduction": "最后一个实践介绍了支撑现代天体物理学精确测量的复杂统计框架。您将扮演一位当代天文学家的角色，使用贝叶斯方法综合多次天体测量观测数据，从而推导出天文单位的最可能值 [@problem_id:206240]。这个练习揭示了我们如何从单一计算转向稳健的、数据驱动的估计，这种估计能够解释不确定性并融合先验知识。", "problem": "基础天文学中的一项基本任务是精确测定天文单位 (AU)，它是一个尺度因子，将太阳系动力学（通常以 AU 为单位建模）与地面测量（以国际单位制单位，例如千米）联系起来。考虑一个贝叶斯实验，旨在通过对一颗近地小行星的天体测量观测来估计天文单位的值，记为 $A_U$。\n\n在 $N$ 个不同的历元（由 $i=1, \\dots, N$ 索引）上，从地球上两个地理上分离的天文台（由 $k \\in \\{1, 2\\}$ 索引）同时对该小行星进行观测。对于每个历元 $t_i$，可获得以下信息：\n- 从天文台 $k$ 观测到的小行星方向由单位向量 $\\hat{\\rho}_{k,i}^{\\text{obs}}$ 给出。\n- 天文台 $k$ 的地心惯性位置向量为 $\\vec{R}_{k,i}$，以千米为单位。\n- 一个高精度的小行星轨道模型为每个历元 $t_i$ 提供了其真实的地心位置向量 $\\vec{d}_i$，以 AU 为单位。令 $d_i = |\\vec{d}_i|$ 且 $\\hat{d}_i = \\vec{d}_i / d_i$。\n\n测量过程建模如下：\n在给定真实方向 $\\hat{\\rho}_{k,i}^{\\text{true}}$ 的情况下，观测到方向 $\\hat{\\rho}_{k,i}^{\\text{obs}}$ 的似然由球面上的 von Mises-Fisher 分布描述，其集中参数 $\\kappa$ 已知。单次观测的似然为：\n$$ P(\\hat{\\rho}_{k,i}^{\\text{obs}} | \\hat{\\rho}_{k,i}^{\\text{true}}) \\propto \\exp(\\kappa \\, \\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\hat{\\rho}_{k,i}^{\\text{true}}) $$\n所有观测都是独立的。\n\n关于 $A_U$ 值的先验信念由一个逆伽马分布描述，其给定的形状超参数为 $\\alpha_0$，尺度超参数为 $\\beta_0$：\n$$ P(A_U) \\propto A_U^{-\\alpha_0-1} \\exp(-\\beta_0/A_U) $$\n\n该问题需在小视差近似下求解，即小行星的地心距离（以千米计）远大于天文台离地心的距离，即 $A_U d_i \\gg |\\vec{R}_{k,i}|$。这允许在小参数 $\\epsilon_{k,i} = |\\vec{R}_{k,i}|/(A_U d_i)$ 上进行一阶泰勒展开。\n\n定义 $\\vec{R}_{k,i}$ 垂直于视线向量 $\\hat{d}_i$ 的向量分量为 $\\vec{R}_{k,i}^{\\perp} = \\vec{R}_{k,i} - \\hat{d}_i (\\hat{d}_i \\cdot \\vec{R}_{k,i})$。\n\n使用所提供的信息和模型，推导天文单位的最大后验 (MAP) 估计值 $A_{U, \\text{MAP}}$。用给定的符号量 $\\alpha_0, \\beta_0, \\kappa, N$ 和提供的数据向量 $\\{\\hat{\\rho}_{k,i}^{\\text{obs}}, \\vec{R}_{k,i}, \\vec{d}_i\\}$ 来表示你的答案。", "solution": "目标是找到天文单位 $A_U$ 的最大后验 (MAP) 估计。MAP 估计是使后验概率密度 $P(A_U | D)$ 最大化的 $A_U$ 值，其中 $D = \\{\\hat{\\rho}_{k,i}^{\\text{obs}}\\}$ 是所有观测的集合。\n\n根据贝叶斯定理，后验概率正比于似然与先验的乘积：\n$$ P(A_U | D) \\propto P(D | A_U) P(A_U) $$\n最大化后验等价于最大化其对数（对数后验）：\n$$ \\ln P(A_U | D) = \\ln P(D | A_U) + \\ln P(A_U) + \\text{常数} $$\n\n**1. 似然函数**\n\n观测是独立的，因此总似然是各个似然的乘积：\n$$ P(D | A_U) = \\prod_{i=1}^{N} \\prod_{k=1}^{2} P(\\hat{\\rho}_{k,i}^{\\text{obs}} | \\hat{\\rho}_{k,i}^{\\text{true}}(A_U)) $$\n对数似然为：\n$$ \\ln L(A_U) \\equiv \\ln P(D | A_U) = \\sum_{i=1}^{N} \\sum_{k=1}^{2} \\ln P(\\hat{\\rho}_{k,i}^{\\text{obs}} | \\hat{\\rho}_{k,i}^{\\text{true}}(A_U)) $$\n使用给定的 von Mises-Fisher 分布形式：\n$$ \\ln L(A_U) = \\sum_{i=1}^{N} \\sum_{k=1}^{2} \\left( \\kappa \\, \\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\right) + \\text{常数} $$\n从天文台 $k$ 到小行星的真实方向向量 $\\hat{\\rho}_{k,i}^{\\text{true}}(A_U)$ 依赖于 $A_U$。其几何关系是，从天文台到小行星的向量 $\\vec{\\Delta}_{k,i}$ 由下式给出：\n$$ \\vec{\\Delta}_{k,i} = (A_U \\vec{d}_i) - \\vec{R}_{k,i} $$\n其中 $A_U \\vec{d}_i$ 是指向小行星的地心向量，单位为千米。真实方向是单位向量：\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) = \\frac{A_U \\vec{d}_i - \\vec{R}_{k,i}}{|A_U \\vec{d}_i - \\vec{R}_{k,i}|} $$\n\n**2. 小视差近似**\n\n我们现在应用近似 $A_U d_i \\gg |\\vec{R}_{k,i}|$。让我们将 $\\hat{\\rho}_{k,i}^{\\text{true}}(A_U)$ 展开到一阶。\n首先，展开分母中的模：\n$$ |A_U \\vec{d}_i - \\vec{R}_{k,i}| = \\sqrt{(A_U \\vec{d}_i - \\vec{R}_{k,i}) \\cdot (A_U \\vec{d}_i - \\vec{R}_{k,i})} = \\sqrt{A_U^2 d_i^2 - 2 A_U (\\vec{d}_i \\cdot \\vec{R}_{k,i}) + |\\vec{R}_{k,i}|^2} $$\n$$ = A_U d_i \\sqrt{1 - \\frac{2 (\\hat{d}_i \\cdot \\vec{R}_{k,i})}{A_U d_i} + O\\left(\\left(\\frac{|\\vec{R}_{k,i}|}{A_U d_i}\\right)^2\\right)} \\approx A_U d_i \\left(1 - \\frac{\\hat{d}_i \\cdot \\vec{R}_{k,i}}{A_U d_i}\\right) = A_U d_i - (\\hat{d}_i \\cdot \\vec{R}_{k,i}) $$\n现在将此代回 $\\hat{\\rho}_{k,i}^{\\text{true}}(A_U)$ 的表达式中：\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\frac{A_U d_i \\hat{d}_i - \\vec{R}_{k,i}}{A_U d_i - (\\hat{d}_i \\cdot \\vec{R}_{k,i})} = \\left(\\hat{d}_i - \\frac{\\vec{R}_{k,i}}{A_U d_i}\\right) \\left(1 - \\frac{\\hat{d}_i \\cdot \\vec{R}_{k,i}}{A_U d_i}\\right)^{-1} $$\n对于小的 $x$，使用一阶二项式近似 $(1-x)^{-1} \\approx 1+x$：\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\left(\\hat{d}_i - \\frac{\\vec{R}_{k,i}}{A_U d_i}\\right) \\left(1 + \\frac{\\hat{d}_i \\cdot \\vec{R}_{k,i}}{A_U d_i}\\right) $$\n$$ \\approx \\hat{d}_i + \\frac{\\hat{d}_i(\\hat{d}_i \\cdot \\vec{R}_{k,i})}{A_U d_i} - \\frac{\\vec{R}_{k,i}}{A_U d_i} - \\frac{\\vec{R}_{k,i}(\\hat{d}_i \\cdot \\vec{R}_{k,i})}{(A_U d_i)^2} $$\n只保留 $1/A_U$ 的一阶项：\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\hat{d}_i - \\frac{1}{A_U d_i} \\left( \\vec{R}_{k,i} - \\hat{d}_i(\\hat{d}_i \\cdot \\vec{R}_{k,i}) \\right) $$\n使用定义 $\\vec{R}_{k,i}^{\\perp} = \\vec{R}_{k,i} - \\hat{d}_i(\\hat{d}_i \\cdot \\vec{R}_{k,i})$：\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\hat{d}_i - \\frac{\\vec{R}_{k,i}^{\\perp}}{A_U d_i} $$\n\n**3. 对数后验**\n\n将此近似真实方向代入对数似然中：\n$$ \\ln L(A_U) \\approx \\kappa \\sum_{i,k} \\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\left(\\hat{d}_i - \\frac{\\vec{R}_{k,i}^{\\perp}}{A_U d_i}\\right) + \\text{常数} $$\n$$ = \\kappa \\sum_{i,k} (\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\hat{d}_i) - \\frac{\\kappa}{A_U} \\sum_{i,k} \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\vec{R}_{k,i}^{\\perp}}{d_i} + \\text{常数} $$\n第一个求和项不依赖于 $A_U$，因此可以并入常数项。令 $S = \\sum_{i,k} \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\vec{R}_{k,i}^{\\perp}}{d_i}$。\n$$ \\ln L(A_U) \\approx -\\frac{\\kappa S}{A_U} + \\text{常数} $$\n先验为 $P(A_U) \\propto A_U^{-\\alpha_0-1} \\exp(-\\beta_0/A_U)$。对数先验是：\n$$ \\ln P(A_U) = -(\\alpha_0+1)\\ln A_U - \\frac{\\beta_0}{A_U} + \\text{常数} $$\n现在，构造对数后验：\n$$ \\ln P(A_U | D) \\approx \\left( -\\frac{\\kappa S}{A_U} \\right) + \\left( -(\\alpha_0+1)\\ln A_U - \\frac{\\beta_0}{A_U} \\right) + \\text{常数} $$\n$$ \\ln P(A_U | D) \\approx -(\\alpha_0+1)\\ln A_U - \\frac{1}{A_U} (\\beta_0 + \\kappa S) + \\text{常数} $$\n这表明后验分布也是一个逆伽马分布， $P(A_U|D) = \\text{Inv-Gamma}(A_U | \\alpha_p, \\beta_p)$，其后验超参数为 $\\alpha_p = \\alpha_0$ 和 $\\beta_p = \\beta_0 + \\kappa S$。\n\n**4. 求解 MAP 估计**\n\n为了找到 MAP 估计，我们通过对对数后验关于 $A_U$ 求导并令其为零来最大化对数后验。\n$$ \\frac{d}{dA_U} \\ln P(A_U | D) = \\frac{d}{dA_U} \\left( -(\\alpha_0+1)\\ln A_U - \\frac{\\beta_0 + \\kappa S}{A_U} \\right) $$\n$$ = -\\frac{\\alpha_0+1}{A_U} + \\frac{\\beta_0 + \\kappa S}{A_U^2} $$\n将导数设为零：\n$$ -\\frac{\\alpha_0+1}{A_{U, \\text{MAP}}} + \\frac{\\beta_0 + \\kappa S}{A_{U, \\text{MAP}}^2} = 0 $$\n$$ \\frac{\\beta_0 + \\kappa S}{A_{U, \\text{MAP}}^2} = \\frac{\\alpha_0+1}{A_{U, \\text{MAP}}} $$\n求解 $A_{U, \\text{MAP}}$：\n$$ A_{U, \\text{MAP}} = \\frac{\\beta_0 + \\kappa S}{\\alpha_0+1} $$\n代入 $S$ 的表达式：\n$$ A_{U, \\text{MAP}} = \\frac{\\beta_0 + \\kappa \\sum_{i=1}^N \\sum_{k=1}^2 \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}}\\cdot\\vec{R}_{k,i}^{\\perp}}{d_i}}{\\alpha_0+1} $$\n展开 $\\vec{R}_{k,i}^{\\perp}$ 得到最终表达式。\n\n$$ A_{U, \\text{MAP}} = \\frac{\\beta_0 + \\kappa \\sum_{i=1}^N \\sum_{k=1}^2 \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}}\\cdot\\left(\\vec{R}_{k,i} - \\hat{d}_i (\\hat{d}_i \\cdot \\vec{R}_{k,i})\\right)}{d_i}}{\\alpha_0+1} $$", "answer": "$$ \\boxed{\\frac{\\beta_0 + \\kappa \\sum_{i=1}^{N} \\sum_{k=1}^{2} \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\vec{R}_{k,i}^{\\perp}}{d_i}}{\\alpha_0 + 1}} $$", "id": "206240"}]}