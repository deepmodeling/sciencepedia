{"hands_on_practices": [{"introduction": "在恒星大气中，谱线的形成深刻地反映了辐射与物质的相互作用。本练习将引导你运用Lambda迭代法，这是解决非局部热动平衡（NLTE）辐射转移问题的基石，通过计算源函数的一阶修正，你将亲身体会谱线源函数如何在恒星表面偏离局部热动平衡(LTE)假设。[@problem_id:209983]", "problem": "恒星大气中光谱线的形成可以用辐射转移方程来建模。对于平行平面、半无限大气，一个二能级原子的线源函数 $S$ 由以下积分方程描述：\n$$\nS(\\tau) = (1-\\epsilon)J(\\tau) + \\epsilon B(\\tau)\n$$\n此处，$\\tau$ 是谱线中特定频率处的垂直光学深度，$\\epsilon$ 是每次散射时光子被摧毁（热化）的常数概率，而 $B(\\tau)$ 是普朗克函数，代表光子的热源。项 $J(\\tau)$ 是平均强度，由 Lambda 算子 $\\Lambda_\\tau$ 作用于源函数得到：\n$$\nJ(\\tau) = \\Lambda_\\tau[S(t)] = \\frac{1}{2} \\int_0^\\infty S(t) E_1(|\\tau - t|) dt\n$$\n其中 $E_1(x)$ 是第一指数积分函数。\n\n这个关于 $S(\\tau)$ 的积分方程可以使用 Lambda 迭代法进行迭代求解。零阶近似 $S^{(0)}(\\tau)$ 取为局域热动平衡（LTE）解，此时源函数等于普朗克函数。后续迭代由下式生成：\n$$\nS^{(n+1)}(\\tau) = (1-\\epsilon)\\Lambda_\\tau[S^{(n)}(t)] + \\epsilon B(\\tau)\n$$\n\n假设在整个谱线形成区，普朗克函数随光学深度线性变化：\n$$\nB(\\tau) = B_0 + B_1 \\tau\n$$\n其中 $B_0$ 和 $B_1$ 是正常数。因此，零阶 LTE 近似为 $S^{(0)}(\\tau) = B_0 + B_1 \\tau$。\n\n请推导源函数的一阶修正 $\\Delta S^{(1)}(\\tau) = S^{(1)}(\\tau) - S^{(0)}(\\tau)$ 在大气表面（$\\tau = 0$）处的值的表达式。\n\n你可以使用以下涉及指数积分函数 $E_n(x)$ 的定积分恒等式：\n$$\n\\int_0^\\infty E_n(x) dx = \\frac{1}{n} \\quad \\text{for } n \\ge 1\n$$\n$$\n\\int_0^\\infty x^m E_n(x) dx = \\frac{m!}{m+n} \\quad \\text{for } m \\ge 0, n \\ge 1\n$$", "solution": "1. 表面处的一阶源函数为\n$$S^{(1)}(0)=(1-\\epsilon)J^{(0)}(0)+\\epsilon B(0)\\,, $$  \n其中\n$$J^{(0)}(0)=\\tfrac12\\int_0^\\infty S^{(0)}(t)E_1(t)\\,dt\\,,\\quad S^{(0)}(t)=B_0+B_1t\\,,\\;B(0)=B_0.$$\n\n2. 使用以下公式计算积分\n$$\\int_0^\\infty E_1(x)\\,dx=1,\\quad \\int_0^\\infty xE_1(x)\\,dx=\\tfrac12.$$  \n因此\n$$\\int_0^\\infty S^{(0)}(t)E_1(t)\\,dt\n=B_0\\!\\int_0^\\infty E_1(t)\\,dt+B_1\\!\\int_0^\\infty tE_1(t)\\,dt\n=B_0+\\tfrac{B_1}{2}$$  \n并且\n$$J^{(0)}(0)=\\tfrac12\\Bigl(B_0+\\tfrac{B_1}{2}\\Bigr)\n=\\tfrac{B_0}{2}+\\tfrac{B_1}{4}.$$\n\n3. 于是\n$$S^{(1)}(0)\n=(1-\\epsilon)\\Bigl(\\tfrac{B_0}{2}+\\tfrac{B_1}{4}\\Bigr)+\\epsilon B_0\n=\\tfrac{1+\\epsilon}{2}B_0+\\tfrac{1-\\epsilon}{4}B_1.$$\n\n4. 零阶表面值为 $S^{(0)}(0)=B_0$，所以一阶修正是\n$$\\Delta S^{(1)}(0)=S^{(1)}(0)-S^{(0)}(0)\n=\\Bigl(\\tfrac{1+\\epsilon}{2}-1\\Bigr)B_0+\\tfrac{1-\\epsilon}{4}B_1\n=\\tfrac{\\epsilon-1}{2}B_0+\\tfrac{1-\\epsilon}{4}B_1\n=(1-\\epsilon)\\Bigl(\\tfrac{B_1}{4}-\\tfrac{B_0}{2}\\Bigr).$$\n  \n5. 化简为\n$$\\Delta S^{(1)}(0)=\\frac{(1-\\epsilon)(B_1-2B_0)}{4}\\,.$$", "answer": "$$\\boxed{\\frac{(1-\\epsilon)(B_1-2B_0)}{4}}$$", "id": "209983"}, {"introduction": "实际的恒星光谱通常非常拥挤，谱线之间的重叠或“混合”是常态。本练习将带你进入一个更实际的场景：利用经典的Milne-Eddington模型，你将推导当一条弱线形成于一条强饱和线翼部时，其等值宽度会受到怎样的抑制。这个过程清晰地展示了如何处理谱线混合问题，并量化其对谱线强度的影响。[@problem_id:210202]", "problem": "在恒星大气的研究中，谱线的形成通常使用 Milne-Eddington (M-E) 模型进行建模。在此模型中，谱线不透明度 $\\alpha_{L,\\nu}$ 与连续谱不透明度 $\\alpha_c$ 的比值被假定为随深度不变的常数，记为 $\\eta_\\nu = \\alpha_{L,\\nu} / \\alpha_c$。源函数被假定为连续谱光学深度 $\\tau_c$ 的线性函数，由 $S(\\tau_c) = S_0 (1 + \\beta \\tau_c)$ 给出。\n\n使用 Eddington-Barbier 近似，出射剩余流量 $r_\\nu = F_\\nu / F_c$（其中 $F_\\nu$ 是频率为 $\\nu$ 处的流量，$F_c$ 是连续谱流量）可以表示为：\n$$\nr_\\nu = \\frac{1 + \\frac{\\beta_0}{1+\\eta_\\nu}}{1+\\beta_0}\n$$\n其中 $\\beta_0$ 是一个与源函数梯度相关的常数。\n\n考虑一个恒星大气，其中总的谱线不透明度是由一条强的光学厚线（谱线1）和一条非常弱的谱线（谱线2）叠加而成。总不透明度比值为 $\\eta_\\nu = \\eta_{1,\\nu} + \\eta_{2,\\nu}$。弱线（谱线2）位于频率 $\\nu_2$ 处，该频率处在强线的远翼部分。由于谱线1翼部的不透明度迅速下降，我们可以假设其不透明度比值 $\\eta_{1,\\nu}$ 在弱线（谱线2）的窄轮廓上近似为常数，其值为 $\\eta_{1,2} \\equiv \\eta_{1,\\nu_2}$。此外，由于谱线2非常弱，其自身的不透明度比值在其整个轮廓的所有频率 $\\nu$ 上都满足 $\\eta_{2,\\nu} \\ll 1+\\eta_{1,2}$。\n\n弱线的等值宽度 $W_2$ 是相对于强线翼部形成的局域连续谱来定义的。其表达式为：\n$$\nW_2 = \\int_{-\\infty}^{\\infty} \\left( 1 - \\frac{r_{\\text{total},\\nu}}{r_{\\text{strong},\\nu_2}} \\right) d\\nu\n$$\n其中 $r_{\\text{total},\\nu}$ 是两条谱线都存在时的剩余流量（$\\eta_\\nu = \\eta_{1,2} + \\eta_{2,\\nu}$），而 $r_{\\text{strong},\\nu_2}$ 是在弱线位置上仅有强线时的剩余流量（$\\eta_\\nu = \\eta_{1,2}$）。\n\n推导压低因子 $\\mathcal{F} = W_2 / W_2^{\\text{unp}}$ 的表达式。这里，$W_2^{\\text{unp}}$ 是在强线1不存在（即 $\\eta_{1,2} = 0$）的情况下，弱线2所具有的等值宽度。你得到的 $\\mathcal{F}$ 的最终表达式应只包含 $\\eta_{1,2}$ 和 $\\beta_0$。", "solution": "我们从频率为 $\\nu$ 处的剩余流量的 Milne–Eddington 表达式开始，\n$$\nr_\\nu \\;=\\;\\frac{1 + \\dfrac{\\beta_0}{1+\\eta_\\nu}}{1+\\beta_0}\\,,\n$$\n其中 $\\eta_\\nu=\\eta_{1,\\nu}+\\eta_{2,\\nu}$。在弱线的频率处，定义\n$$\nA\\equiv 1+\\eta_{1,2}\\,,\\qquad B\\equiv\\beta_0\\,,\\qquad \\eta_{2,\\nu}\\ll A\\,.\n$$\n那么总的剩余流量是\n$$\nr_{\\rm tot}(\\nu)\n=\\frac{1}{1+B}\\Bigl(1+\\frac{B}{A+\\eta_{2,\\nu}}\\Bigr),\n$$\n而在 $\\nu_2$ 处仅有强线时的剩余流量是\n$$\nr_{\\rm str}\n=\\frac{1}{1+B}\\Bigl(1+\\frac{B}{A}\\Bigr).\n$$\n因此\n$$\n\\frac{r_{\\rm tot}(\\nu)}{r_{\\rm str}}\n=\\frac{1+\\dfrac{B}{A+\\eta_{2,\\nu}}}{1+\\dfrac{B}{A}}\n=\\frac{A\\,(A+B+\\eta_{2,\\nu})}{(A+\\eta_{2,\\nu})(A+B)}.\n$$\n对于 $\\eta_{2,\\nu}\\ll A$ 的情况，对 $\\eta_{2,\\nu}$ 进行一阶展开：\n$$\n\\frac{r_{\\rm tot}}{r_{\\rm str}}\n\\approx 1 \\;-\\;\\frac{B\\,\\eta_{2,\\nu}}{A\\,(A+B)}.\n$$\n因此谱线压低为\n$$\n1-\\frac{r_{\\rm tot}}{r_{\\rm str}}\n\\approx \\frac{B\\,\\eta_{2,\\nu}}{A\\,(A+B)}.\n$$\n弱线的等值宽度为\n$$\nW_2\n=\\int\\Bigl(1-\\frac{r_{\\rm tot}}{r_{\\rm str}}\\Bigr)\\,d\\nu\n=\\frac{B}{A\\,(A+B)}\\int\\eta_{2,\\nu}\\,d\\nu.\n$$\n如果强线不存在（$\\eta_{1,2}=0$ 因此 $A=1$），可以得到\n$$\nW_2^{\\rm unp}\n=\\frac{B}{1(1+B)}\\int\\eta_{2,\\nu}\\,d\\nu.\n$$\n因此压低因子为\n$$\n\\mathcal F\n=\\frac{W_2}{W_2^{\\rm unp}}\n=\\frac{\\dfrac{B}{A\\,(A+B)}}{\\dfrac{B}{1+B}}\n=\\frac{1+B}{A\\,(A+B)}\n=\\frac{1+\\beta_0}{(1+\\eta_{1,2})(1+\\beta_0+\\eta_{1,2})}.\n$$", "answer": "$$\\boxed{\\frac{1+\\beta_0}{(1+\\eta_{1,2})(1+\\beta_0+\\eta_{1,2})}}$$", "id": "210202"}, {"introduction": "我们观测到的恒星谱线轮廓并不仅仅由大气微观物理决定，恒星自身的大尺度运动，如自转和对流，也扮演了关键角色。本练习通过一个简化的双半球模型，探讨宏观速度场如何展宽谱线，并让你推导谱线轮廓从单峰向双峰转变的临界条件。这个练习是理解自转展宽等宏观效应如何塑造我们观测到的谱线轮廓的重要一步。[@problem_id:210086]", "problem": "考虑一个恒星的简化模型，其表面速度场由两个巨大的、稳定的对流单元主导，这两个对流单元可被建模为两个半球。一个半球以大小为 $v_0$ 的视向速度朝着一个遥远的观测者运动，而另一个半球以同样的速度 $v_0$ 远离观测者。该恒星的质心保持静止。假设该恒星具有均匀的表面亮度，且两个半球对总观测通量的贡献相等。\n\n在恒星气体的静止参考系中，一次原子跃迁产生一条吸收线。这条谱线的深度作为频率 $\\nu$ 的函数，由一个高斯轮廓描述：\n$$\nD_{int}(\\nu) = D_0 \\exp\\left(-\\frac{(\\nu - \\nu_0)^2}{2\\sigma_\\nu^2}\\right)\n$$\n在此，$\\nu_0$ 是在静止参考系中跃迁的中心频率，$\\sigma_\\nu$ 是量化谱线内禀宽度（由热运动和微湍流运动引起）的标准差，而 $D_0$ 是谱线中心的深度。\n\n从该恒星观测到的复合谱线轮廓是来自两个半球的多普勒频移轮廓的总和。对于以视向速度 $v_{los}$ 运动的源，观测频率 $\\nu_{obs}$ 和发射频率 $\\nu_{em}$ 之间的关系由非相对论性多普勒公式给出：$\\nu_{obs} = \\nu_{em}(1 - v_{los}/c)$，其中 $c$ 是光速，对于远离观测者的运动，$v_{los}$ 为正。\n\n复合谱线轮廓的形状取决于多普勒引起的频移与内禀谱线宽度的比值。对于小的 $v_0$，轮廓是单峰的（吸收深度有一个单一的中心极大值）。对于大的 $v_0$，轮廓变为双峰的（吸收深度有两个极大值，并在 $\\nu = \\nu_0$ 处有一个局部极小值）。\n\n推导无量纲比 $\\mathcal{R} = \\frac{\\nu_0 v_0 / c}{\\sigma_\\nu}$ 的临界值，该值标志着这两种状态之间的转变。该转变点由总谱线深度轮廓对频率的二阶导数在中心频率 $\\nu_0$ 处的值为零这一条件来定义。", "solution": "问题要求解比值 $\\mathcal{R} = (\\nu_0 v_0 / c) / \\sigma_\\nu$ 的临界值，在该临界值下，复合谱线轮廓从单峰转变为双峰。这一转变发生在轮廓在其中心的二阶导数为零时。\n\n首先，我们确定来自两个半球的多普勒频移轮廓的中心频率。由多普勒效应引起的频移大小为 $\\Delta\\nu_D = \\nu_0 (v_0/c)$。\n\n1.  对于远离观测者的半球，其视向速度为 $v_{los} = +v_0$。以 $\\nu_0$ 为中心的内禀谱线轮廓被移动到一个新的中心频率 $\\nu_{-}$：\n    $$\n    \\nu_{-} = \\nu_0 (1 - v_0/c) = \\nu_0 - \\Delta\\nu_D\n    $$\n\n2.  对于接近观测者的半球，其视向速度为 $v_{los} = -v_0$。谱线被移动到一个新的中心频率 $\\nu_{+}$：\n    $$\n    \\nu_{+} = \\nu_0 (1 - (-v_0)/c) = \\nu_0 + \\Delta\\nu_D\n    $$\n\n复合谱线深度轮廓 $D_{comp}(\\nu)$ 是来自两个半球的轮廓之和，因为它们的贡献相等：\n$$\nD_{comp}(\\nu) = D_{int}(\\nu; \\text{shifted to } \\nu_{+}) + D_{int}(\\nu; \\text{shifted to } \\nu_{-})\n$$\n代入高斯形式和移动后的中心频率：\n$$\nD_{comp}(\\nu) = D_0 \\left[ \\exp\\left(-\\frac{(\\nu - \\nu_{+})^2}{2\\sigma_\\nu^2}\\right) + \\exp\\left(-\\frac{(\\nu - \\nu_{-})^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n$$\nD_{comp}(\\nu) = D_0 \\left[ \\exp\\left(-\\frac{(\\nu - (\\nu_0 + \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) + \\exp\\left(-\\frac{(\\nu - (\\nu_0 - \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n复合轮廓的中心位于 $\\nu = \\nu_0$。我们需要通过计算二阶导数 $\\frac{d^2D_{comp}}{d\\nu^2}$ 并在 $\\nu=\\nu_0$ 处求值来分析此点的曲率。\n\n我们来求 $D_{comp}(\\nu)$ 关于 $\\nu$ 的一阶导数：\n$$\n\\frac{dD_{comp}}{d\\nu} = D_0 \\left[ -\\frac{\\nu - (\\nu_0 + \\Delta\\nu_D)}{\\sigma_\\nu^2} \\exp\\left(-\\dots\\right) - \\frac{\\nu - (\\nu_0 - \\Delta\\nu_D)}{\\sigma_\\nu^2} \\exp\\left(-\\dots\\right) \\right]\n$$\n现在，我们使用乘法法则 $\\frac{d}{dx}(f(x)e^{g(x)}) = (f'e^g + f g'e^g)$ 来求二阶导数：\n$$\n\\frac{d^2D_{comp}}{d\\nu^2} = D_0 \\left[ \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(\\nu - (\\nu_0 + \\Delta\\nu_D))^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(\\nu - (\\nu_0 + \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) \\right.\n$$\n$$\n\\left. + \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(\\nu - (\\nu_0 - \\Delta\\nu_D))^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(\\nu - (\\nu_0 - \\Delta\\nu_D))^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n现在，我们在谱线中心 $\\nu = \\nu_0$ 处计算该表达式的值：\n$$\n\\left. \\frac{d^2D_{comp}}{d\\nu^2} \\right|_{\\nu=\\nu_0} = D_0 \\left[ \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(-\\Delta\\nu_D)^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(-\\Delta\\nu_D)^2}{2\\sigma_\\nu^2}\\right) \\right.\n$$\n$$\n\\left. + \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{(\\Delta\\nu_D)^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{(\\Delta\\nu_D)^2}{2\\sigma_\\nu^2}\\right) \\right]\n$$\n方括号中的两项是相同的。\n$$\n\\left. \\frac{d^2D_{comp}}{d\\nu^2} \\right|_{\\nu=\\nu_0} = 2 D_0 \\left( -\\frac{1}{\\sigma_\\nu^2} + \\frac{\\Delta\\nu_D^2}{\\sigma_\\nu^4} \\right) \\exp\\left(-\\frac{\\Delta\\nu_D^2}{2\\sigma_\\nu^2}\\right)\n$$\n我们可以从圆括号中提取因子 $\\sigma_\\nu^4$：\n$$\n\\left. \\frac{d^2D_{comp}}{d\\nu^2} \\right|_{\\nu=\\nu_0} = \\frac{2 D_0}{\\sigma_\\nu^4} (\\Delta\\nu_D^2 - \\sigma_\\nu^2) \\exp\\left(-\\frac{\\Delta\\nu_D^2}{2\\sigma_\\nu^2}\\right)\n$$\n从单峰（凹向下，二阶导数为负）到双峰（凹向上，二阶导数为正）的转变发生在二阶导数为零时。\n$$\n\\frac{2 D_0}{\\sigma_\\nu^4} (\\Delta\\nu_D^2 - \\sigma_\\nu^2) \\exp\\left(-\\frac{\\Delta\\nu_D^2}{2\\sigma_\\nu^2}\\right) = 0\n$$\n由于 $D_0 > 0$，$\\sigma_\\nu > 0$，并且指数项总是为正，因此转变的条件是：\n$$\n\\Delta\\nu_D^2 - \\sigma_\\nu^2 = 0 \\quad \\implies \\quad \\Delta\\nu_D^2 = \\sigma_\\nu^2\n$$\n由于频移大小 $\\Delta\\nu_D$ 和谱线宽度 $\\sigma_\\nu$ 都是正量，我们取正根：\n$$\n\\Delta\\nu_D = \\sigma_\\nu\n$$\n问题要求比值 $\\mathcal{R} = \\frac{\\Delta\\nu_D}{\\sigma_\\nu}$ 的临界值。代入我们的结果：\n$$\n\\mathcal{R}_{crit} = \\frac{\\sigma_\\nu}{\\sigma_\\nu} = 1\n$$\n因此，当多普勒频移的大小精确等于内禀高斯谱线轮廓的标准差时，发生转变。", "answer": "$$\n\\boxed{1}\n$$", "id": "210086"}]}