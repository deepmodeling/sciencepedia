{"hands_on_practices": [{"introduction": "在低温恒星大气中，分子吸收是决定不透明度的关键因素。吸收线的强度取决于分子在不同量子能级上的布居数，这由麦克斯韦-玻尔兹曼分布决定。本练习将微观的量子力学与宏观性质联系起来，通过计算占据数最多的转动能级，帮助你理解如何对分子不透明度进行建模 [@problem_id:271707]。", "problem": "冷恒星大气的不透明度在很大程度上受到分子对辐射吸收的影响。要对此不透明度进行建模，必须理解分子在其各种量子态上的布居分布。\n\n考虑一个温度为 $T$ 的双原子分子热系综。这些分子被建模为刚性转子。在量子数为 $J$ 的状态下，分子的转动能由 $E_J = B J(J+1)$ 给出，其中 $B$ 是转动常数，$J$ 可以是任何非负整数（$J=0, 1, 2, \\dots$）。每个转动能级 $J$ 的统计权重（或称简并度）为 $g_J = 2J+1$。\n\n根据麦克斯韦-玻尔兹曼分布，处于转动能级 $J$ 的分子数 $N_J$ 与其简并度和玻尔兹曼因子的乘积成正比：\n$$\nN_J \\propto g_J \\exp\\left(-\\frac{E_J}{k_B T}\\right)\n$$\n其中 $k_B$ 是玻尔兹曼常数。\n\n这种布居分布 $N_J$ 不是单调的。由于简并度因子，它首先随 $J$ 增加；随后由于指数形式的玻尔兹曼因子而减少。因此，存在一个特定的转动能级，记为 $J_{max}$，其布居数最多。源自不同能级的谱线相对强度关键性地取决于它们的布居数。\n\n推导布居数最多的转动能级 $N_{J_{max}}$ 的粒子数与基态（$J=0$）$N_0$ 的粒子数之比的解析表达式。为此，将量子数 $J$ 视为连续变量，以找到布居分布的极大值。你得到的最终比值 $\\frac{N_{J_{max}}}{N_0}$ 表达式应只包含温度 $T$、转动常数 $B$ 和玻尔兹曼常数 $k_B$。", "solution": "1. 布居分布为\n$$N_J \\propto g_J\\exp\\!\\Bigl(-\\frac{E_J}{k_B T}\\Bigr)\n= (2J+1)\\exp\\!\\Bigl(-\\frac{B\\,J(J+1)}{k_B T}\\Bigr)。$$\n2. 将 $J$ 视为连续变量并对 $\\ln N_J$ 求极大值：\n$$\\ln N_J = \\ln(2J+1)-\\frac{B\\,J(J+1)}{k_B T}。$$\n求导并令其为零：\n$$\\frac{d}{dJ}\\ln N_J\n=\\frac{2}{2J+1}-\\frac{B\\,(2J+1)}{k_B T}=0\n\\;\\Longrightarrow\\;(2J+1)^2=\\frac{2k_B T}{B}。$$\n因此\n$$2J_{\\max}+1=\\sqrt{\\frac{2k_B T}{B}},\\qquad\nJ_{\\max}=\\frac{\\sqrt{2k_B T/B}-1}{2}。$$\n3. 峰值布居数与基态布居数之比为\n$$\\frac{N_{J_{\\max}}}{N_0}\n=(2J_{\\max}+1)\\exp\\!\\Bigl(-\\frac{B\\,J_{\\max}(J_{\\max}+1)}{k_B T}\\Bigr)。$$\n代入 $2J_{\\max}+1=X\\equiv\\sqrt{2k_B T/B}$ 和 \n$J_{\\max}(J_{\\max}+1)=\\frac{X^2-1}{4}$ 可得\n$$\\frac{N_{J_{\\max}}}{N_0}\n=X\\exp\\!\\Bigl(-\\frac{B}{k_B T}\\,\\frac{X^2-1}{4}\\Bigr)\n=\\sqrt{\\frac{2k_B T}{B}}\n\\exp\\!\\Bigl(-\\tfrac12+\\frac{B}{4k_B T}\\Bigr)。$$", "answer": "$$\\boxed{\\sqrt{\\frac{2k_B T}{B}}\\exp\\!\\Bigl(-\\tfrac12+\\frac{B}{4k_B T}\\Bigr)}$$", "id": "271707"}, {"introduction": "在恒星内部的辐射输运模型中，我们需要一个对频率进行平均的不透明度值。Rosseland平均不透明度（$ \\kappa_R $）是描述辐射扩散的恰当平均方法，它对介质较为透明的频率区域赋予更高的权重。本练习将让你直接运用 Rosseland 平均不透明度的积分定义，对一个简化的不透明度谱进行计算，这是掌握恒星结构中辐射输运计算的核心实践 [@problem_id:271545]。", "problem": "恒星内部的辐射转移由罗斯兰平均不透明度 $\\kappa_R$ 决定，$\\kappa_R$ 是单色不透明度 $\\kappa_\\nu$ 的频率平均值。罗斯兰平均的定义由以下关系式给出：\n$$\n\\frac{1}{\\kappa_R} = \\frac{\\int_0^\\infty \\frac{1}{\\kappa_\\nu} \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}{\\int_0^\\infty \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}\n$$\n此处，$T$ 是温度，$B_\\nu(T)$ 是黑体辐射的普朗克函数：\n$$\nB_\\nu(T) = \\frac{2h\\nu^3}{c^2} \\frac{1}{e^{h\\nu/k_BT} - 1}\n$$\n其中 $h$ 是普朗克常数，$c$ 是光速，$k_B$ 是玻尔兹曼常数。\n\n作为参考，分母中的积分与总黑体能量密度随温度的变化率有关，其标准值为：\n$$\n\\int_0^\\infty \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu = \\frac{8\\pi^4 k_B^4 T^3}{15 c^2 h^3}\n$$\n\n**问题：**\n考虑一种假设的恒星物质，其频率依赖的不透明度 $\\kappa_\\nu$ 由一个在频率 $\\nu_0$ 处具有尖锐低频吸收边的幂律连续谱描述。在此频率以下，介质是完全不透明的。该不透明度由下式给出：\n$$\n\\kappa_\\nu =\n\\begin{cases}\n\\infty  \\text{for } \\nu  \\nu_0 \\\\\nK \\nu^{-\\beta}  \\text{for } \\nu \\ge \\nu_0\n\\end{cases}\n$$\n其中 $K$ 和 $\\beta$ 是实常数。\n\n对于幂律指数为 $\\beta = -4$ 的特定情况，推导罗斯兰平均不透明度 $\\kappa_R$ 的闭合形式解析表达式。你的最终答案应以温度 $T$、截止频率 $\\nu_0$、常数 $K$ 以及基本物理常数 $h, c, k_B, \\pi$ 来表示。", "solution": "罗斯兰平均不透明度 $\\kappa_R$ 定义为：\n$$\n\\frac{1}{\\kappa_R} = \\frac{\\int_0^\\infty \\frac{1}{\\kappa_\\nu} \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}{\\int_0^\\infty \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}\n$$\n\n问题指定了不透明度 $\\kappa_\\nu$。对于 $\\nu  \\nu_0$，$\\kappa_\\nu = \\infty$，这意味着其倒数 $1/\\kappa_\\nu = 0$。对于 $\\nu \\ge \\nu_0$，$\\kappa_\\nu = K \\nu^{-\\beta}$，所以 $1/\\kappa_\\nu = \\frac{1}{K}\\nu^{\\beta}$。因此，分子中的积分仅在 $\\nu \\ge \\nu_0$ 时非零。\n$$\n\\frac{1}{\\kappa_R} = \\frac{\\int_{\\nu_0}^\\infty \\frac{1}{K}\\nu^{\\beta} \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}{\\int_0^\\infty \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}\n$$\n\n我们要求解 $\\beta = -4$ 的情况。此问题中，不透明度定义为 $K\\nu^{-\\beta}$，因此对于 $\\beta=-4$，我们有 $\\kappa_\\nu = K\\nu^4$。代入表达式得到：\n$$\n\\frac{1}{\\kappa_R} = \\frac{\\frac{1}{K}\\int_{\\nu_0}^\\infty \\nu^{-4} \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}{\\int_0^\\infty \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}\n$$\n\n首先，我们需要求普朗克函数 $B_\\nu(T)$ 对温度 $T$ 的导数：\n$$\n\\frac{\\partial B_\\nu(T)}{\\partial T} = \\frac{\\partial}{\\partial T} \\left( \\frac{2h\\nu^3}{c^2} \\frac{1}{e^{h\\nu/k_BT} - 1} \\right) = \\frac{2h\\nu^3}{c^2} \\left( -(e^{h\\nu/k_BT} - 1)^{-2} \\cdot e^{h\\nu/k_BT} \\cdot \\left(-\\frac{h\\nu}{k_B T^2}\\right) \\right)\n$$\n$$\n\\frac{\\partial B_\\nu(T)}{\\partial T} = \\frac{2h^2\\nu^4}{c^2 k_B T^2} \\frac{e^{h\\nu/k_B T}}{(e^{h\\nu/k_B T} - 1)^2}\n$$\n\n现在，我们将此导数代入分子积分中，我们将其记为 $N_{int}$：\n$$\nN_{int} = \\frac{1}{K}\\int_{\\nu_0}^\\infty \\nu^{-4} \\left( \\frac{2h^2\\nu^4}{c^2 k_B T^2} \\frac{e^{h\\nu/k_B T}}{(e^{h\\nu/k_B T} - 1)^2} \\right) d\\nu\n$$\n\n$\\nu^{-4}$ 和 $\\nu^4$ 项相互抵消，极大地简化了被积函数：\n$$\nN_{int} = \\frac{2h^2}{K c^2 k_B T^2} \\int_{\\nu_0}^\\infty \\frac{e^{h\\nu/k_B T}}{(e^{h\\nu/k_B T} - 1)^2} d\\nu\n$$\n\n为了计算这个积分，我们进行变量代换。令 $x = \\frac{h\\nu}{k_B T}$。则 $d\\nu = \\frac{k_B T}{h} dx$。积分下限变为 $x_0 = \\frac{h\\nu_0}{k_B T}$。\n$$\nN_{int} = \\frac{2h^2}{K c^2 k_B T^2} \\int_{x_0}^\\infty \\frac{e^x}{(e^x - 1)^2} \\left( \\frac{k_B T}{h} \\right) dx = \\frac{2h}{K c^2 T} \\int_{x_0}^\\infty \\frac{e^x}{(e^x - 1)^2} dx\n$$\n\n所得积分可以精确求解。令 $u = e^x - 1$，则 $du = e^x dx$。\n$$\n\\int \\frac{e^x}{(e^x - 1)^2} dx = \\int \\frac{du}{u^2} = -\\frac{1}{u} + C = -\\frac{1}{e^x - 1} + C\n$$\n计算该定积分：\n$$\n\\int_{x_0}^\\infty \\frac{e^x}{(e^x - 1)^2} dx = \\left[ -\\frac{1}{e^x - 1} \\right]_{x_0}^\\infty = \\lim_{x\\to\\infty}\\left(-\\frac{1}{e^x - 1}\\right) - \\left(-\\frac{1}{e^{x_0} - 1}\\right) = 0 - \\left(-\\frac{1}{e^{x_0} - 1}\\right) = \\frac{1}{e^{x_0} - 1}\n$$\n\n将此结果代回 $N_{int}$ 的表达式中：\n$$\nN_{int} = \\frac{2h}{K c^2 T} \\frac{1}{e^{h\\nu_0/k_B T} - 1}\n$$\n\n分母积分 $D_{int}$ 在题目中已给出：\n$$\nD_{int} = \\int_0^\\infty \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu = \\frac{8\\pi^4 k_B^4 T^3}{15 c^2 h^3}\n$$\n\n现在我们可以计算 $1/\\kappa_R$：\n$$\n\\frac{1}{\\kappa_R} = \\frac{N_{int}}{D_{int}} = \\frac{\\frac{2h}{K c^2 T} \\frac{1}{e^{h\\nu_0/k_B T} - 1}}{\\frac{8\\pi^4 k_B^4 T^3}{15 c^2 h^3}}\n$$\n$$\n\\frac{1}{\\kappa_R} = \\frac{2h}{K c^2 T} \\frac{15 c^2 h^3}{8\\pi^4 k_B^4 T^3} \\frac{1}{e^{h\\nu_0/k_B T} - 1} = \\frac{30 h^4}{8\\pi^4 K k_B^4 T^4} \\frac{1}{e^{h\\nu_0/k_B T} - 1}\n$$\n$$\n\\frac{1}{\\kappa_R} = \\frac{15 h^4}{4\\pi^4 K k_B^4 T^4 (e^{h\\nu_0/k_B T} - 1)}\n$$\n\n最后，我们将此表达式取倒数，求得罗斯兰平均不透明度 $\\kappa_R$：\n$$\n\\kappa_R = \\frac{4\\pi^4 K k_B^4 T^4}{15 h^4} \\left( e^{h\\nu_0/k_B T} - 1 \\right)\n$$", "answer": "$$\n\\boxed{\\frac{4\\pi^4 K k_B^4 T^4}{15 h^4} \\left( \\exp\\left(\\frac{h\\nu_0}{k_B T}\\right) - 1 \\right)}\n$$", "id": "271545"}, {"introduction": "物理学家根据不同应用场景使用不同的平均不透明度，例如 Planck 平均（$ \\kappa_P $）和 Rosseland 平均（$ \\kappa_R $）。本练习通过分析一条窄吸收线对这两种平均值的影响，鲜明地揭示了它们的物理本质差异。这有助于你深刻理解为何 Rosseland 平均是描述辐射能量输运的关键 [@problem_id:271621]。", "problem": "在研究恒星内部的辐射转移时，通常会对频率相关的不透明度 $\\kappa_\\nu$ 进行平均，以简化恒星结构方程。两种常见的平均方案是普朗克平均不透明度 $\\kappa_P$ 和罗斯兰平均不透明度 $\\kappa_R$。\n\n普朗克平均不透明度是一种吸收加权平均，定义为：\n$$\n\\kappa_P = \\frac{\\int_0^\\infty \\kappa_\\nu B_\\nu(T) d\\nu}{\\int_0^\\infty B_\\nu(T) d\\nu}\n$$\n罗斯兰平均不透明度是按普朗克函数的温度导数加权的调和平均，对模拟辐射扩散至关重要。其倒数由下式给出：\n$$\n\\frac{1}{\\kappa_R} = \\frac{\\int_0^\\infty \\frac{1}{\\kappa_\\nu} \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}{\\int_0^\\infty \\frac{\\partial B_\\nu(T)}{\\partial T} d\\nu}\n$$\n在这些表达式中，$T$ 是温度，$B_\\nu(T)$ 是频率为 $\\nu$ 的黑体辐射的普朗克函数：\n$$\nB_\\nu(T) = \\frac{2 h \\nu^3}{c^2} \\frac{1}{e^{h\\nu/(k_B T)} - 1}\n$$\n其中 $h$ 是普朗克常数，$k_B$ 是玻尔兹曼常数，$c$ 是光速。\n\n考虑一个简化的恒星介质，其初始状态是“灰体”，即其不透明度与频率无关，$\\kappa_\\nu = \\kappa_0$。然后，通过引入一条中心频率为 $\\nu_1$ 的单一、弱、窄的吸收线来扰动该介质。由这条线引起的不透明度变化可以建模为 $\\delta\\kappa_\\nu = A \\, \\delta(\\nu - \\nu_1)$，其中 $\\delta(\\nu - \\nu_1)$ 是狄拉克δ函数，$A$ 是谱线的积分强度。该谱线被认为是“弱”的，这为进行一阶微扰分析提供了依据。\n\n现在的总不透明度为 $\\kappa'_\\nu = \\kappa_0 + \\delta\\kappa_\\nu$。这一变化在平均不透明度中引起了微小变化，因此 $\\kappa'_P = \\kappa_P + \\delta\\kappa_P$ 且 $\\kappa'_R = \\kappa_R + \\delta\\kappa_R$。\n\n推导普朗克平均不透明度的相对变化与罗斯兰平均不透明度的相对变化之比 $\\mathcal{R} = \\frac{\\delta\\kappa_P / \\kappa_P}{\\delta\\kappa_R / \\kappa_R}$ 的表达式。用无量纲变量 $x_1 = \\frac{h\\nu_1}{k_B T}$ 表示你的最终答案。", "solution": "1. 普朗克平均不透明度微扰：\n$$\\kappa_P=\\frac{\\int_0^\\infty\\kappa_\\nu B_\\nu\\,d\\nu}{\\int_0^\\infty B_\\nu\\,d\\nu},\\quad \n\\kappa'_\\nu=\\kappa_0+A\\,\\delta(\\nu-\\nu_1)\\;\\implies\\;\n\\delta\\kappa_P=\\frac{A\\,B_{\\nu_1}}{\\displaystyle\\int_0^\\infty B_\\nu\\,d\\nu}\\,. $$\n由于初始时 $\\kappa_P=\\kappa_0$，\n$$\\frac{\\delta\\kappa_P}{\\kappa_P}\n=\\frac{A\\,B_{\\nu_1}}{\\kappa_0\\int_0^\\infty B_\\nu\\,d\\nu}\\,. $$\n\n2. 罗斯兰平均不透明度微扰：\n$$\\frac1{\\kappa_R}\n=\\frac{\\int_0^\\infty\\frac{1}{\\kappa_\\nu}\\,\\partial_T B_\\nu\\,d\\nu}\n{\\displaystyle\\int_0^\\infty\\partial_T B_\\nu\\,d\\nu},\\quad\n\\kappa_\\nu'=\\kappa_0+A\\,\\delta(\\nu-\\nu_1)\\,. $$\n展开至一阶：\n$$\\frac1{\\kappa'_R}\n=\\frac{1}{\\kappa_0}\n-\\frac{A\\,\\partial_T B_{\\nu_1}}{\\kappa_0^2\\int_0^\\infty\\partial_T B_\\nu\\,d\\nu}\\,, $$\n所以 $$\\delta\\Bigl(\\tfrac1\\kappa\\Bigr)=-\\frac{\\delta\\kappa_R}{\\kappa_0^2}\n=-\\frac{A\\,\\partial_T B_{\\nu_1}}{\\kappa_0^2\\int\\partial_T B_\\nu\\,d\\nu},$$\n因此\n$$\\delta\\kappa_R\n=\\frac{A\\,\\partial_T B_{\\nu_1}}{\\int_0^\\infty\\partial_T B_\\nu\\,d\\nu},\\quad\n\\frac{\\delta\\kappa_R}{\\kappa_R}\n=\\frac{A\\,\\partial_T B_{\\nu_1}}{\\kappa_0\\int_0^\\infty\\partial_T B_\\nu\\,d\\nu}\\,. $$\n\n3. 相对变化之比：\n$$\\mathcal R\n=\\frac{\\delta\\kappa_P/\\kappa_P}{\\delta\\kappa_R/\\kappa_R}\n=\\frac{B_{\\nu_1}}{\\partial_T B_{\\nu_1}}\n\\frac{\\int_0^\\infty\\partial_T B_\\nu\\,d\\nu}{\\int_0^\\infty B_\\nu\\,d\\nu}\\,. $$\n\n4. 计算积分：\n$$\\int_0^\\infty B_\\nu\\,d\\nu\\propto T^4\\;\\implies\\;\\int_0^\\infty\\partial_T B_\\nu\\,d\\nu\n=\\frac{d}{dT}\\!\\int_0^\\infty B_\\nu\\,d\\nu\n=4\\,\\frac{\\int_0^\\infty B_\\nu\\,d\\nu}{T}\\,. $$\n\n5. 普朗克函数及其在 $x=h\\nu/(k_BT)$ 处的 $T$ 导数：\n$$B_\\nu=\\frac{2h\\nu^3}{c^2}\\frac1{e^x-1},\\quad\n\\partial_T B_\\nu\n=\\frac{2h\\nu^3}{c^2}\\frac{x\\,e^x}{T(e^x-1)^2}\\,. $$\n因此\n$$\\frac{B_{\\nu_1}}{\\partial_T B_{\\nu_1}}\n=\\frac{T(e^{x_1}-1)}{x_1\\,e^{x_1}}\\,. $$\n\n6. 组合 $\\mathcal R$：\n$$\\mathcal R\n=\\frac{4}{T}\\,\\frac{T(e^{x_1}-1)}{x_1\\,e^{x_1}}\n=\\frac{4\\,(e^{x_1}-1)}{x_1\\,e^{x_1}}\n=\\frac{4\\,(1-e^{-x_1})}{x_1}\\,. $$", "answer": "$$\\boxed{\\frac{4\\,(1-e^{-x_1})}{x_1}}$$", "id": "271621"}]}