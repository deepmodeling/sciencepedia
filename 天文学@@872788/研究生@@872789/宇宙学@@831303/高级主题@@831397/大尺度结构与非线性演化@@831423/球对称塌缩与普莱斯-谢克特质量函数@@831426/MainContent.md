## 引言
宇宙如何从一个近乎均匀、炽热的早期状态演化成我们今天所见的、由星系、星系团和巨大的宇宙网构成的复杂结构？这是[现代宇宙学](@entry_id:752086)的核心问题之一。要回答这个问题，我们需要能够连接[早期宇宙](@entry_id:160168)微小[密度涨落](@entry_id:143540)与晚期形成的宏观天体的理论工具。球对称坍缩模型与 Press-Schechter [质量函数](@entry_id:158970)正是为此而生的两大理论支柱，它们共同构成了我们理解[引力](@entry_id:175476)如何在宇宙尺度上塑造物质[分布](@entry_id:182848)的基石。

本文旨在为读者提供一个关于这两个核心概念的全面而深入的理解。我们面临的挑战在于，真实的[结构形成](@entry_id:158241)过程是极端复杂的[非线性](@entry_id:637147)过程，难以精确求解。然而，通过理想化的球对称坍缩模型，我们可以抓住[引力不稳定性](@entry_id:160721)最本质的物理，而 Press-Schechter 形式论则巧妙地将其与初始条件的统计性质相结合，为预测天体丰度提供了强大的分析工具。

本文将分为三个主要部分，带领读者逐步深入这一领域：
*   在“**原理与机制**”一章中，我们将详细剖析球对称坍缩的动力学过程，推导关键的临界坍缩密度，并阐明 Press-Schechter [质量函数](@entry_id:158970)的统计基础，包括其在涉足集理论框架下的严格推导。
*   在“**应用与跨学科联系**”一章中，我们将展示这一理论框架如何超越其初始设定，被广泛应用于检验修改[引力](@entry_id:175476)、探索暗物质性质、追溯原初宇宙的非高斯性，以及为更真实的[星系形成](@entry_id:160121)模型提供基础。
*   最后，在“**动手实践**”部分，我们提供了一系列精心设计的问题，旨在通过实际计算加深读者对核心概念的掌握，并探索该理论的精妙之处与前沿扩展。

通过学习本文，读者将不仅掌握结构形成的基本分析方法，更能体会到物理学家如何运用简洁的模型来洞察和量化宇宙的宏伟演化图景。

## 原理与机制

在宇宙学中，理解最大尺度上的结构——星系、[星系团](@entry_id:160919)以及连接它们的宇宙网——是如何从早期宇宙近乎均匀的物质[分布](@entry_id:182848)中产生的，是一个核心问题。本章将深入探讨为现代结构形成理论奠定基础的两个基石概念：理想化的球对称坍缩模型，以及由此衍生的，用于预测宇宙中不同质量天体丰度的统计工具——Press-Schechter [质量函数](@entry_id:158970)。

### 球对称坍缩模型

最简单的[引力不稳定性](@entry_id:160721)模型是“顶帽”模型（top-hat model）。该模型考虑在一个膨胀的背景宇宙中，存在一个密度均匀、半径为 $R$ 的球形过密区域。根据 Birkhoff 定理的牛顿近似，我们可以将这个球形区域的演化与其外部的宇宙背景分离开来，并将其视为一个独立的、自身[引力](@entry_id:175476)占主导的“迷你宇宙”。

#### 动力学演化

在一个平坦的、由[物质主导的宇宙](@entry_id:158254)（即 Einstein-de Sitter, EdS 宇宙）中，背景宇宙的尺度因子 $a(t)$ 随[时间演化](@entry_id:153943)为 $a(t) \propto t^{2/3}$。然而，这个过密区域由于其额外的质量，其膨胀速度会比背景宇宙慢。它的动力学行为可以通过一个能量方程来描述，该方程形式上与 Friedmann 方程类似：

$$
\frac{1}{2} \dot{R}^2 - \frac{GM}{R} = E
$$

其中 $R$ 是球形区域的半径，$M$ 是其包含的总质量（在坍缩过程中守恒），$G$ 是引力常数，$E$ 是该球形区域每单位质量的总能量，也是一个[守恒量](@entry_id:150267)。对于一个最终会坍缩的束缚系统，$E$ 必须为负值。

该方程的解描述了过密区域的完整生命周期：
1.  **初始膨胀**：在早期，该区域跟随宇宙的哈勃流一起膨胀，但膨胀速度逐渐减慢。
2.  **周转（Turnaround）**：膨胀最终停止，此时球壳的动能为零（$\dot{R}=0$）。该时刻被称为**[周转时间](@entry_id:756237)** $t_{ta}$，对应的半径为**周转半径** $R_{ta}$。在周转点，总能量完全由势能贡献：$E = -GM/R_{ta}$。
3.  **坍缩（Collapse）**：在达到最大半径后，该区域在自身[引力](@entry_id:175476)作用下开始向内坍缩。
4.  **平衡（Virialization）**：在理想化的模型中，球壳会坍缩至一个[奇点](@entry_id:137764)。然而在现实中，物质壳层会相互穿过，通过一种称为**[剧烈弛豫](@entry_id:158546)**（violent relaxation）的过程重新分配能量，最终形成一个稳定的、处于[引力](@entry_id:175476)束缚下的平衡结构，例如[暗物质晕](@entry_id:147523)。

#### 平衡态：[维里定理](@entry_id:146441)

一个稳定的、[自引力系统](@entry_id:155831)满足**维里定理**（virial theorem）。对于一个只受[引力](@entry_id:175476)作用的系统，其总动能 $K$ 和总[势能](@entry_id:748988) $W$ 之间存在一个简单的关系：$2K + W = 0$。

在周转时，系统的总能量为 $E = W_{ta} = -GM/R_{ta}$（此处我们使用球体的引力势能 $W = -\frac{3}{5}\frac{GM^2}{R}$，因此单位质量能量为 $E = -\frac{3}{5}\frac{GM}{R_{ta}}$）。由于[能量守恒](@entry_id:140514)，在最终的平衡态（virialized state），总能量 $E_{vir} = K_{vir} + W_{vir}$ 必须等于周转时的能量 $E_{ta}$。结合维里定理 $K_{vir} = -W_{vir}/2$，我们得到：

$$
E_{vir} = -\frac{1}{2}W_{vir} + W_{vir} = \frac{1}{2}W_{vir}
$$

由于 $E_{vir} = E_{ta} = W_{ta}$，我们有 $\frac{1}{2}W_{vir} = W_{ta}$。代入势能的表达式 $-\frac{3}{5}\frac{GM^2}{R_{vir}}$ 和 $-\frac{3}{5}\frac{GM^2}{R_{ta}}$，可以得到一个经典结果：

$$
R_{vir} = \frac{1}{2} R_{ta}
$$

这意味着一个通过[剧烈弛豫](@entry_id:158546)[达到平衡](@entry_id:170346)的[暗物质晕](@entry_id:147523)，其最终的维里半径是其最大膨胀半径的一半。

#### 模型的推广与修正

真实的宇宙和结构形成过程比简单的 EdS [球形坍缩模型](@entry_id:159843)要复杂得多。

**宇宙学常数的影响**

在 $\Lambda$CDM 模型中，宇宙学常数 $\Lambda$（或[暗能量](@entry_id:161123)）提供了一种排斥力。这会改变球形区域的能量方程和最终的维里平衡。总[势能](@entry_id:748988)现在包含两部分：引力势能 $W_G = -\frac{3}{5}\frac{GM^2}{R}$ 和与 $\Lambda$ 相关的势能 $W_\Lambda = -\frac{1}{10} M \Lambda c^2 R^2$。维里定理也相应地修正为 $2K_{vir} + W_{G,vir} + W_{\Lambda,vir} = 0$。在这样的宇宙中，坍缩过程会更慢，最终形成的结构也更为松散，$R_{vir}/R_{ta}$ 的比值不再是 $1/2$，而是依赖于坍缩时背景宇宙的[物质密度](@entry_id:263043)参数 $\Omega_m(a_{ta})$ [@problem_id:849809]。

**暗能量背景的压力**

[暗物质晕](@entry_id:147523)并非[孤立系统](@entry_id:159201)，而是浸润在暗能量的背景流体中。如果暗能量具有[状态方程](@entry_id:274378) $P_{DE} = w \rho_{DE} c^2$，它就会在暗物质晕的边界上施加一个外部压力。这为[维里定理](@entry_id:146441)增加了一个表面项 $S = -4\pi w \rho_{DE} c^2 R^3$。修正后的平衡条件变为 $2K + W + S = 0$ [@problem_id:849835]。对于宇宙学常数（$w=-1$），这个表面项提供了一个额外的支持压，有助于抵抗引力坍缩。

**角动量的作用**

初始的物质微扰并非完美球形，它们会受到周围物质[分布](@entry_id:182848)的[潮汐力](@entry_id:159188)矩作用，从而获得**角动量**。在坍缩过程中，[角动量守恒](@entry_id:156798)。如果一个区域拥有足够的角动量，坍缩过程将不会通过[剧烈弛豫](@entry_id:158546)达到平衡，而是被离心力所阻止，形成一个旋转支撑的盘状结构（如星系盘）。

我们可以用无量纲的**自旋参数** $\lambda$ 来量化角动量 $L$ 的大小：

$$
\lambda = \frac{L |E|^{1/2}}{G M^{5/2}}
$$

对于一个给定的质量 $M$ 和周转半径 $R_{ta}$ 的顶帽扰动，其最终由离心力支撑的半径 $R_f$ 与自旋参数的平方成正比，$R_f \propto \lambda^2 R_{ta}$。这意味着具有更高角动量的扰动会形成尺寸更大的盘状结构 [@problem_id:849824]。这为[星系盘](@entry_id:158624)尺寸的[分布](@entry_id:182848)提供了理论基础。

### 线性理论与临界坍缩密度

球对称坍缩模型描述的是一个完全[非线性](@entry_id:637147)的过程。然而，在宇宙学中，我们通常在[早期宇宙](@entry_id:160168)（当[密度扰动](@entry_id:159546)很小，可以用线性理论描述时）设定初始条件。因此，我们需要一个桥梁来连接线性理论的预言和[非线性](@entry_id:637147)坍缩的最终命运。这个桥梁就是**临界坍缩密度** $\delta_c$。

其核心思想是：计算出一个球形过密区域从初始时刻到最终坍缩为一点所需的时间 $t_c$。然后，我们问：在这段时间内，一个遵循线性理论增长的初始[密度扰动](@entry_id:159546) $\delta_i$ 会增长到什么值？这个线性外推的值就是临界坍缩密度 $\delta_c$。

对于 EdS 宇宙，线性[密度扰动](@entry_id:159546)增长为 $\delta_L(t) \propto t^{2/3}$。通过详细计算，可以得到[球形坍缩模型](@entry_id:159843)预言的坍缩时间 $t_c = (\frac{3\pi}{32G\bar{\rho}_i(1+\delta_i)})^{1/2}$。将这个时间代入线性增长公式，可以发现当一个区域发生[非线性](@entry_id:637147)坍缩时，其线性外推的密度达到了一个几乎不依赖于其质量和初始扰动大小的常数：

$$
\delta_c = \frac{3}{5} \left( \frac{3\pi}{2} \right)^{2/3} \approx 1.686
$$

这个值是结构形成理论中最重要的数字之一。它设定了一个阈值：在线性密度场中，任何区域只要其[密度对比](@entry_id:157948)度超过 $\delta_c$，我们就可以预言它将最终形成一个束缚的天体。

$\delta_c$ 的精确值对宇宙学背景有轻微的依赖。例如，在一个物质密度参数 $\Omega_{m,0}  1$ 的开放宇宙中，其值会略有不同 [@problem_id:849794]。

更有趣的是，标准推导是在[牛顿引力](@entry_id:159796)框架下进行的，并假设过密区域内的观察者所经历的固有时与背景宇宙的宇宙时间是相同的。然而，根据广义相对论，更强的[引力场](@entry_id:169425)会导致时间膨胀。一个更精确的计算需要使用 **Tolman-Bondi-Lemaître (TBL)** 度规。分析表明，由于[引力时间膨胀](@entry_id:162143)，过密区域内部的时钟比远处宇宙背景中的时钟走得慢。这意味着，从外部观察者的角度来看，坍缩需要更长的时间 $\tau_c$ 才能完成，即 $\tau_c > t_c$。由于线性扰动是根据背景宇宙时间 $\tau$ 增长的，因此真实的临界密度应该是将线性增长外推到 $\tau_c$ 而非 $t_c$。这导致了一个相对论修正，使得真实的 $\delta_c$ 略大于牛顿理论的计算值 [@problem_id:849800]。修正的大小与扰动壳层的比能 $E$ 有关，其比值为 $(\delta_c / \delta_{c,N}) = (1-2E/c^2)^{2/3}$。

### Press-Schechter [质量函数](@entry_id:158970)

有了球对称坍缩模型和临界密度 $\delta_c$，我们就可以从统计上预测宇宙中不同质量天体的数量。这就是 **Press-Schechter (PS) [质量函数](@entry_id:158970)** $n(M)$ 的目标，它给出了单位体积内，单位质量间隔的暗物质晕的数量。

PS 理论的核心假设是：**在给定的质量尺度 $M$ 上，宇宙中最终坍缩形成质量大于 $M$ 的天体的物质部分，等于初始线性密度场在经过尺度为 $M$ 的平滑后，其[密度对比](@entry_id:157948)度超过 $\delta_c$ 的概率。**

为了计算这个概率，我们需要知道线性密度场 $\delta$ 的[统计分布](@entry_id:182030)。一个关键的假设是，原初[密度扰动](@entry_id:159546)是一个[高斯随机场](@entry_id:749757)。因此，在任何平滑尺度上，$\delta$ 的[分布](@entry_id:182848)也是一个高斯分布，其均值为零，[方差](@entry_id:200758)为 $\sigma^2(M)$：

$$
P(\delta, M) = \frac{1}{\sqrt{2\pi}\sigma(M)} \exp\left(-\frac{\delta^2}{2\sigma^2(M)}\right)
$$

[方差](@entry_id:200758) $\sigma^2(M)$ 是通过对[物质功率谱](@entry_id:161407) $P(k)$ 进行积分得到的，它描述了在质量尺度 $M$ 上[密度涨落](@entry_id:143540)的典型幅度。质量尺度 $M$ 通常与一个[空间平滑](@entry_id:202768)半径 $R$ 相关联，例如通过球形顶帽滤波器 $M = \frac{4\pi}{3}\bar{\rho}R^3$。

根据 PS 的假设，质量大于 $M$ 的天体所占的质量分数 $F(M)$ 是：

$$
F(M) = \int_{\delta_c}^\infty P(\delta, M) d\delta
$$

这个简单的假设存在一个问题：当 $M \to 0$ 时（即 $\sigma \to \infty$），$F(M)$ 趋近于 $1/2$，而不是预期的 $1$（即所有物质最终都应属于某个质量的天体）。Press 和 Schechter 通过一个特别的修正解决了这个问题，他们将上述结果乘以 2，得到了著名的 PS [质量函数](@entry_id:158970)。

#### 涉足集理论：对 PS 理论的严格推导

这个“因子 2”之谜后来在 **涉足集理论**（Excursion Set Formalism）的框架下得到了完美的解释。该理论将结构形成问题重新表述为一个[统计力](@entry_id:194984)学中的“首次穿越”问题。

想象一下，我们从一个非常大的平滑尺度（小 $\sigma^2$）开始，逐渐减小我们的平滑半径 $R$（这对应于增大质量 $M$ 和[方差](@entry_id:200758) $\sigma^2$）。对于宇宙中的任意一个点，其平滑后的[密度对比](@entry_id:157948)度 $\delta$ 会随着平滑尺度 $S = \sigma^2(M)$ 的变化而[随机游走](@entry_id:142620)，形成一条轨迹 $\delta(S)$。所有的轨迹都从 $S=0$ 时的 $\delta=0$ 出发（对应于无限大尺度上的均匀宇宙）。

一个质量为 $M$ 的天体形成，对应于某条轨迹在“时间” $S = \sigma^2(M)$ 首次向上穿越**[吸收边界](@entry_id:201489)** $\delta = \delta_c$。这个问题可以精确地用一个带有[吸收边界](@entry_id:201489)的[一维扩散方程](@entry_id:746146)来描述：

$$
\frac{\partial P}{\partial S} = \frac{1}{2} \frac{\partial^2 P}{\partial\delta^2}
$$

其中 $P(\delta, S)$ 是在“时间” $S$、尚未被吸收的轨迹位于 $\delta$ 的[概率密度](@entry_id:175496)。为了解这个问题，我们可以使用**镜像法**（method of images）。在 $\delta=0$ 处放置一个源，同时在 $\delta=2\delta_c$ 处放置一个等强度但符号相反的“镜像”源。这两个源的叠加自动满足了在 $\delta=\delta_c$ 处概率为零的边界条件。

首次穿越[概率分布](@entry_id:146404) $f(S)$（即首次在 $S$ 处发生坍缩的概率）等于穿过边界 $\delta_c$ 的[概率流](@entry_id:150949)。通过计算这个流，我们能够严格地推导出首次穿越的概率密度 [@problem_id:849785]：

$$
f(S) = \frac{\delta_c}{\sqrt{2\pi} S^{3/2}} \exp\left(-\frac{\delta_c^2}{2S}\right)
$$

这个结果与原始 PS [质量函数](@entry_id:158970)（包含了那个神秘的“因子 2”）完全一致，从而为其提供了坚实的理论基础。这个“因子 2”的物理意义是：在[高斯随机场](@entry_id:749757)中，对于任何最终超过阈值 $\delta_c$ 的轨迹，它们在达到 $\delta_c$ 之前低于该阈值的概率恰好是 $1/2$。

### [质量函数](@entry_id:158970)的应用与扩展

PS [质量函数](@entry_id:158970)及其涉足集理论的推广是分析宇宙[结构形成](@entry_id:158241)的强大工具，它将天体丰度与更基本的[宇宙学参数](@entry_id:161338)和物理过程联系起来。

**[质量函数](@entry_id:158970)的形状**

PS [质量函数](@entry_id:158970)的形式为：
$$
n(M) = \sqrt{\frac{2}{\pi}} \frac{\bar{\rho}}{M^2} \frac{\delta_c}{\sigma(M)} \left| \frac{d \ln \sigma(M)}{d \ln M} \right| \exp\left(-\frac{\delta_c^2}{2\sigma^2(M)}\right)
$$
它的形状由两个主要部分决定：一个低质量端的[幂律](@entry_id:143404)[部分和](@entry_id:162077)一个高质量端的指数截断。
*   **高质量端**：指数项 $\exp(-\nu^2/2)$（其中 $\nu = \delta_c/\sigma(M)$ 被称为峰高）导致大质量天体的数量呈指数级下降。这是因为大质量天体对应于大的平滑尺度，$\sigma(M)$ 很小，因此需要非常罕见的高[密度涨落](@entry_id:143540)（大 $\nu$）才能超过 $\delta_c$。
*   **低质量端**：在 $M \to 0$ 的极限下，$\sigma(M)$ 很大，指数项趋于 1。[质量函数](@entry_id:158970)的行为主要由[幂律](@entry_id:143404)项决定。其斜率 $\alpha$（$n(M) \propto M^\alpha$）直接与[物质功率谱](@entry_id:161407) $P(k) \propto k^n$ 的[谱指数](@entry_id:159172) $n$ 相关。可以证明，当 $n=-3$ 时，PS [质量函数](@entry_id:158970)的低质量端斜率恰好为 $\alpha=-2$ [@problem_id:849848]。

**超越[球形坍缩](@entry_id:161208)：椭球坍缩模型**

真实的初始扰动并非球形，而是椭球形的。**椭球坍缩模型**考虑了初始扰动的形状和周围的潮汐剪切场。在这种更现实的模型中，坍缩阈值不再是一个常数 $\delta_c$，而是依赖于初始扰动变形张量的[特征值](@entry_id:154894)。一个简单的模型将修正后的坍缩阈值 $\delta_{ec}$ 表示为：
$$
\delta_{ec} = \delta_c \left( 1 + C \frac{\sigma_s^2}{\delta^2} \right)
$$
其中 $\sigma_s^2$ 是初始剪切场的大小，$C$ 是一个常数。这种修正会改变[质量函数](@entry_id:158970)中的指数项，从而影响预测的天体丰度。例如，对于一个高度扁平的“薄饼状”初始扰动，这种效应会系统地改变坍缩阈值，导致对天体丰度的预测产生一个依赖于峰高 $\nu$ 的修正因子 [@problem_id:849846]。

**探测基本物理**

[质量函数](@entry_id:158970)的精确形式对宇宙的基本成分和早期宇宙的物理过程极为敏感。
*   **[温暗物质](@entry_id:160015)（WDM）**：与[冷暗物质](@entry_id:158219)（CDM）不同，[温暗物质](@entry_id:160015)粒子在[早期宇宙](@entry_id:160168)中有显著的速度，能够通过“自由流动”抹平小尺度的[密度涨落](@entry_id:143540)。这导致其[物质功率谱](@entry_id:161407)在某个[自由流](@entry_id:159506)动尺度 $k_{fs}$ 以下被截断。这种小尺度功率的缺失会极大地抑制小物质量天体的形成。因此，WDM 宇宙的[质量函数](@entry_id:158970)在低质量端会相对于 CDM 有一个显著的压低。通过测量低质量星系（如银河系的卫星星系）的数量，我们可以对暗物质的“温度”或其[粒子质量](@entry_id:156313)设置强有力的限制 [@problem_id:849810]。
*   **[原初非高斯性](@entry_id:158248)与晕偏袒**：标准模型假设原初密度场是[高斯分布](@entry_id:154414)的。然而，许多[早期宇宙](@entry_id:160168)模型（如一些[暴胀模型](@entry_id:161366)）会产生微小的非高斯性。这种非高斯性可以通过研究**晕偏袒**（halo bias）来探测。晕偏袒 $b$ 描述了暗物质晕的[分布](@entry_id:182848)与下层物质[分布](@entry_id:182848)的偏离程度（$\delta_h = b \delta_m$）。**峰-背景分离**（peak-background split）模型表明，一个长波长的密度模式会调制小尺度上天体形成的环境。在存在[原初非高斯性](@entry_id:158248)（由参数 $f_{NL}$ 描述）的情况下，这种调制效应会引入一个与尺度相关的偏袒修正项。因此，通过精确测量[大尺度结构](@entry_id:158990)中[星系团](@entry_id:160919)的偏袒如何随尺度变化，我们可以探测到 $f_{NL}$ 的信号，从而窥探宇宙诞生之初的物理规律 [@problem_id:849793]。

总之，从简单的[球形坍缩](@entry_id:161208)物理到复杂的[统计场论](@entry_id:155447)方法，[结构形成](@entry_id:158241)理论为我们提供了一个从基本[宇宙学参数](@entry_id:161338)出发，预测和理解宇宙中各类天体[分布](@entry_id:182848)的强大框架。