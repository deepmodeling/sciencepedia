{"hands_on_practices": [{"introduction": "在引力透镜的实际应用中，透镜星系通常并非完美的圆形，而是呈椭圆形。伪等温椭球质量分布是描述这类星系的一个常用且更为真实的模型。本练习 [@problem_id:879971] 将帮助您掌握分析这种椭率如何影响切向临界曲线形状的核心技能，这对于理解像的倍率和多重像的形成至关重要。", "problem": "在引力透镜理论中，源平面（坐标为 $\\vec{\\beta}$）和像平面（坐标为 $\\vec{\\theta}$）之间的映射由透镜方程给出：$\\vec{\\beta} = \\vec{\\theta} - \\vec{\\alpha}(\\vec{\\theta})$，其中 $\\vec{\\alpha}(\\vec{\\theta})$ 是偏折角。对于薄透镜，偏折角可以表示为一个标量透镜势 $\\psi$ 的梯度，即 $\\vec{\\alpha} = \\vec{\\nabla}_\\theta \\psi$。\n\n透镜映射的局部性质由放大率张量 $A_{ij} = \\frac{\\partial \\beta_i}{\\partial \\theta_j} = \\delta_{ij} - \\frac{\\partial^2 \\psi}{\\partial \\theta_i \\partial \\theta_j}$ 描述。一个像的放大率由 $\\mu = (\\det A)^{-1}$ 给出。像平面上放大率发散的位置，即 $\\det A = 0$ 的位置，构成了临界曲线。这些曲线分隔了不同像多重性的区域。放大率张量的行列式可以表示为 $\\det A = (1-\\kappa)^2 - \\gamma^2$，其中 $\\kappa = \\frac{1}{2} \\nabla^2 \\psi$ 是会聚，$\\gamma$ 是复剪切的大小。当 $A$ 的一个特征值趋于零，导致像发生极端的切向拉伸时，所形成的临界曲线称为切向临界曲线。切向临界曲线的条件是 $1 - \\kappa - \\gamma = 0$。\n\n考虑一个常用于描述星系的非奇异椭圆透镜势模型，其形式为：\n$$\n\\psi(\\theta_1, \\theta_2) = b \\sqrt{r_c^2 + \\theta_1^2 + \\frac{\\theta_2^2}{q_p^2}}\n$$\n此处，$(\\theta_1, \\theta_2)$ 是像平面中的角坐标，其中 $\\theta_1$ 与势场的长轴对齐。参数 $b$ 代表透镜强度，$r_c$ 是势场的核半径，$q_p$ 是等势线的轴比（$0  q_p  1$）。\n\n假设条件 $b > r_c / q_p$ 成立，计算该势场下切向临界曲线的长半轴与短半轴之比 $r_{maj} / r_{min}$。", "solution": "我们从切向临界条件开始\n$$\n\\lambda_{t}=1-\\kappa-\\gamma=0\\quad\\Longrightarrow\\quad\\kappa+\\gamma=1\\,,\n$$\n其中对于一个势 $\\psi$，会聚和剪切组合给出\n$$\n\\kappa+\\gamma=\\max(\\psi_{11},\\psi_{22})\\,. \n$$\n在坐标轴上，“切向”方向垂直于径向矢量：\n1. 长轴（$\\theta_2=0$）：径向 $\\parallel\\theta_1$，因此切向 $\\parallel\\theta_2$，条件是\n   $$\\psi_{22}=1.$$  \n   我们有\n   $$\n     \\psi_{22}\n     =\\frac{\\partial}{\\partial\\theta_2}\\Bigl[b\\,\\frac{\\theta_2/q_p^2}{\\sqrt{r_c^2+\\theta_1^2+\\theta_2^2/q_p^2}}\\Bigr]\n     \\Big|_{\\theta_2=0}\n     =\\frac{b}{q_p^2\\sqrt{r_c^2+\\theta_1^2}}\\,,\n   $$\n   因此\n   $$\n     \\frac{b}{q_p^2\\sqrt{r_c^2+r_{maj}^2}}=1\n     \\quad\\Longrightarrow\\quad\n     r_{maj}^2=\\frac{b^2}{q_p^4}-r_c^2\\,. \n   $$\n2. 短轴（$\\theta_1=0$）：径向 $\\parallel\\theta_2$，因此切向 $\\parallel\\theta_1$，条件是\n   $$\\psi_{11}=1.$$  \n   我们有\n   $$\n     \\psi_{11}\n     =\\frac{\\partial}{\\partial\\theta_1}\\Bigl[b\\,\\frac{\\theta_1}{\\sqrt{r_c^2+\\theta_2^2/q_p^2}}\\Bigr]\n     \\Big|_{\\theta_1=0}\n     =\\frac{b}{\\sqrt{r_c^2+\\theta_2^2/q_p^2}}\\,,\n   $$\n   因此\n   $$\n     \\frac{b}{\\sqrt{r_c^2+r_{min}^2/q_p^2}}=1\n     \\quad\\Longrightarrow\\quad\n     r_{min}^2=q_p^2\\bigl(b^2-r_c^2\\bigr)\\,. \n   $$\n\n因此，切向临界曲线的轴比为\n$$\n\\frac{r_{maj}}{r_{min}}\n=\\frac{\\sqrt{\\tfrac{b^2}{q_p^4}-r_c^2}}{q_p\\,\\sqrt{b^2-r_c^2}}\n=\\frac{1}{q_p^3}\\sqrt{\\frac{b^2-r_c^2\\,q_p^4}{\\,b^2-r_c^2\\,}}\\,.\n$$", "answer": "$$\n\\boxed{\\frac{1}{q_p^3}\\sqrt{\\frac{b^2 - r_c^2 q_p^4}{b^2 - r_c^2}}}\n$$", "id": "879971"}, {"introduction": "除了整体的椭球形状，透镜星系的质量分布还可能包含更精细的结构或偏离。我们可以将这些复杂性建模为对简单模型的微扰。本练习 [@problem_id:879969] 运用强大的复数形式体系，通过一个假设的 $m=3$ 方位质量微扰，探索其如何产生特征性的“星形”焦散线，这是诊断透镜质量分布的重要理论工具。", "problem": "在引力透镜的复平面表述中，源 ($\\beta$) 和像 ($\\theta$) 的位置由复数表示。透镜方程通过偏折角 $\\alpha_c$ 将它们联系起来：\n$$ \\beta = \\theta - \\alpha_c(\\theta, \\bar{\\theta}) $$\n临界曲线定义为像平面中放大率发散的位置。这发生在透镜映射的雅可比矩阵行列式 $\\det A = \\left|\\frac{\\partial\\beta}{\\partial\\theta}\\right|^2 - \\left|\\frac{\\partial\\beta}{\\partial\\bar{\\theta}}\\right|^2$ 为零的地方。焦散线是对应的源位置集合，通过将透镜方程应用于临界曲线得到。\n\n考虑一个结合了奇异等温球 (SIS) 和 $m=3$ 方位角微扰的引力透镜模型。该透镜的复偏折角由下式给出：\n$$ \\alpha_c(\\theta, \\bar{\\theta}) = b \\frac{\\theta}{|\\theta|} + \\gamma_3 \\bar{\\theta}^2 $$\n其中 $b$ 是 SIS 透镜的爱因斯坦半径，$\\gamma_3$ 是一个代表微扰强度的小实参数。已知该透镜模型在 $\\gamma_3$ 很小时会产生一个六尖点的“星形”焦散线。\n\n您的任务是计算位于源平面正实轴上的尖点位置。将 $\\gamma_3$ 视为一个小微扰参数。最终答案应为一个用 $b$ 和 $\\gamma_3$ 表示的表达式，精确到并包含 $\\gamma_3^2$ 阶的项。", "solution": "1. 透镜方程和偏折：\n$$\\beta=\\theta-\\alpha_c,\\quad \n\\alpha_c=b\\frac{\\theta}{|\\theta|}+\\gamma_3\\bar\\theta^2.$$\n2. 用于雅可比矩阵的 Wirtinger 导数：\n$$A\\equiv\\frac{\\partial\\beta}{\\partial\\theta}\n=1-\\frac{\\partial\\alpha_c}{\\partial\\theta}\n=1-\\frac{b}{2r},\\quad\nB\\equiv\\frac{\\partial\\beta}{\\partial\\bar\\theta}\n=-\\frac{\\partial\\alpha_c}{\\partial\\bar\\theta}\n=\\frac{b\\,e^{2i\\phi}}{2r}-2\\gamma_3\\,\\bar\\theta,$$\n其中 $\\theta=re^{i\\phi}$。 \n3. 临界曲线条件 $\\det A=|A|^2-|B|^2=0$ 给出\n$$1-\\frac b r+2b\\gamma_3\\cos(3\\phi)-4\\gamma_3^2r^2=0.$$\n4. 微扰拟设 $r=b+r_1\\gamma_3+r_2\\gamma_3^2$：\nO($\\gamma_3$): $r_1=-2b^2\\cos3\\phi$,\nO($\\gamma_3^2$): $r_2=4b^3(1+\\cos^2\\!3\\phi)$.\n5. 在 $\\phi=0$ 处 (正实轴上的尖点)：\n$$r=b-2b^2\\gamma_3+8b^3\\gamma_3^2+O(\\gamma_3^3).$$\n6. 源位置 $\\beta=\\theta-\\bigl[b+\\gamma_3\\theta^2\\bigr]$，其中 $\\theta=r\\in\\mathbb R$：\n\\begin{align*}\n\\beta=(r-b)-\\gamma_3r^2\n=-2b^2\\gamma_3+8b^3\\gamma_3^2-\\gamma_3\\bigl[b^2-4b^3\\gamma_3+O(\\gamma_3^2)\\bigr]\\\\\n=-3b^2\\gamma_3+12b^3\\gamma_3^2+O(\\gamma_3^3).\n\\end{align*}", "answer": "$$\\boxed{-3b^2\\gamma_3+12b^3\\gamma_3^2}$$", "id": "879969"}, {"introduction": "引力透镜不仅会放大背景源，也会改变其图像的表观属性，而真实的背景源并非点源，而是具有一定延伸和内部结构的。本练习 [@problem_id:879997] 将探讨当背景源自身亮度分布不均匀时，其透镜成像的光度中心会如何偏移。这对于利用引力透镜进行高精度天体测量学研究是一个至关重要的概念。", "problem": "一个小的、圆形的遥远源被一个前景天体引力透镜化，该前景天体可建模为奇异等温球（SIS）。该透镜系统的几何结构由角直径距离 $D_L$（观测者-透镜）、$D_S$（观测者-源）和 $D_{LS}$（透镜-源）描述。\n\nSIS透镜位于透镜平面坐标系 $\\vec{\\theta} = (\\theta_x, \\theta_y)$ 的原点。它产生一个大小为常数的偏折角，即Einstein半径 $\\alpha_E$。透镜方程为 $\\vec{\\beta} = \\vec{\\theta} - \\alpha_E \\frac{\\vec{\\theta}}{|\\vec{\\theta}|}$，其中 $\\vec{\\beta}$ 是在源平面中的位置。\n\n源是一个角半径为 $\\epsilon$ 的小的均匀圆形盘。其几何中心位于源平面中的位置 $\\vec{\\beta}_c = (\\beta_0, 0)$，其中 $0  \\beta_0  \\alpha_E$。源很小，意即 $\\epsilon \\ll \\beta_0$。源的表面亮度 $I_S$ 不是均匀的，而是存在一个线性梯度。在一个以源为中心的坐标系 $(\\delta\\beta_x, \\delta\\beta_y)$ 中，位于位置 $\\vec{\\beta}' = \\vec{\\beta}_c + \\delta\\vec{\\beta}$ 的点的表面亮度由下式给出：\n$$\nI_S(\\vec{\\beta}') = I_0(1 + \\vec{g} \\cdot \\delta\\vec{\\beta})\n$$\n其中 $\\delta\\vec{\\beta} = (\\delta\\beta_x, \\delta\\beta_y)$ 且 $|\\delta\\vec{\\beta}| \\le \\epsilon$。$\\vec{g}=(g_x, g_y)$ 是一个代表亮度梯度的恒定矢量，$I_0$ 是一个常数。该梯度很弱，使得 $|\\vec{g}| \\epsilon  1$，从而确保亮度始终为正。\n\n这种配置会产生两个不同的、被扭曲的源的像。我们关心的是两个像中较亮的一个。对于这个像，请计算其光度质心相对于源几何中心被透镜化后的位置的矢量偏移的大小。一个表面亮度为 $I_I(\\vec{\\theta})$ 的像的光度质心 $\\langle\\vec{\\theta}\\rangle_L$ 定义为：\n$$\n\\langle\\vec{\\theta}\\rangle_L = \\frac{\\int_{\\text{image}} \\vec{\\theta} \\, I_I(\\vec{\\theta}) \\, d^2\\theta}{\\int_{\\text{image}} I_I(\\vec{\\theta}) \\, d^2\\theta}\n$$", "solution": "**1. 像的位置和较亮像的确定**\n\n透镜方程为 $\\vec{\\beta} = \\vec{\\theta} - \\alpha_E \\frac{\\vec{\\theta}}{|\\vec{\\theta}|}$。源中心位于 $\\vec{\\beta}_c = (\\beta_0, 0)$。由于偏折场的对称性，源中心的像必须与源和透镜位于同一轴线上，即 $\\vec{\\theta} = (\\theta, 0)$。透镜方程变为关于 $\\theta$ 的标量方程：\n$$\n\\beta_0 = \\theta - \\alpha_E \\operatorname{sgn}(\\theta)\n$$\n这给出了源中心位置的两个解：\n1.  $\\theta > 0$：$\\beta_0 = \\theta_+ - \\alpha_E \\implies \\theta_+ = \\beta_0 + \\alpha_E$。位置为 $\\vec{\\theta}_+ = (\\beta_0 + \\alpha_E, 0)$。\n2.  $\\theta  0$：$\\beta_0 = \\theta_- + \\alpha_E \\implies \\theta_- = \\beta_0 - \\alpha_E$。位置为 $\\vec{\\theta}_- = (\\beta_0 - \\alpha_E, 0)$。由于 $\\beta_0  \\alpha_E$，$\\theta_-  0$ 符合要求。\n\n像的放大率由 $\\mu = |\\det(\\mathcal{A})^{-1}|$ 给出，其中 $\\mathcal{A} = \\frac{\\partial\\vec{\\beta}}{\\partial\\vec{\\theta}}$ 是放大率张量。\n$$\n\\mathcal{A}_{ij} = \\delta_{ij} - \\frac{\\partial\\alpha_i}{\\partial\\theta_j} = \\delta_{ij} - \\frac{\\alpha_E}{|\\vec{\\theta}|} \\left( \\delta_{ij} - \\frac{\\theta_i \\theta_j}{|\\vec{\\theta}|^2} \\right)\n$$\n对于x轴上的像，$\\vec{\\theta}=(\\theta, 0)$，上式简化为：\n$$\n\\mathcal{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 - \\alpha_E/|\\theta| \\end{pmatrix}\n$$\n放大率为 $\\mu = |\\det(\\mathcal{A})^{-1}| = |(1 - \\alpha_E/|\\theta|)^{-1}| = \\frac{|\\theta|}{|| \\theta | - \\alpha_E|}$。\n\n对于第一个位于 $\\vec{\\theta}_+$ 的像：$|\\theta_+| = \\beta_0 + \\alpha_E$。\n$$\n\\mu_+ = \\frac{\\beta_0 + \\alpha_E}{|(\\beta_0 + \\alpha_E) - \\alpha_E|} = \\frac{\\beta_0 + \\alpha_E}{\\beta_0} = 1 + \\frac{\\alpha_E}{\\beta_0}\n$$\n对于第二个位于 $\\vec{\\theta}_-$ 的像：$|\\theta_-| = |\\beta_0 - \\alpha_E| = \\alpha_E - \\beta_0$。\n$$\n\\mu_- = \\frac{\\alpha_E - \\beta_0}{|(\\alpha_E - \\beta_0) - \\alpha_E|} = \\frac{\\alpha_E - \\beta_0}{|-\\beta_0|} = \\frac{\\alpha_E - \\beta_0}{\\beta_0} = \\frac{\\alpha_E}{\\beta_0} - 1\n$$\n由于 $0  \\beta_0  \\alpha_E$，我们有 $\\mu_+ > \\mu_-$。因此，位于 $\\vec{\\theta}_+ = (\\beta_0 + \\alpha_E, 0)$ 的像是较亮的一个。\n\n**2. 线性化透镜映射**\n\n对于小源，从源平面中的一点 $\\delta\\vec{\\beta}$（相对于 $\\vec{\\beta}_c$）到像平面中的一点 $\\delta\\vec{\\theta}$（相对于 $\\vec{\\theta}_+$）的映射是线性的：$\\delta\\vec{\\beta} = \\mathcal{A}_+ \\delta\\vec{\\theta}$，或 $\\delta\\vec{\\theta} = \\mathcal{A}_+^{-1} \\delta\\vec{\\beta}$。\n在 $\\vec{\\theta}_+$ 处，放大率张量为：\n$$\n\\mathcal{A}_+ = \\begin{pmatrix} 1  0 \\\\ 0  1 - \\frac{\\alpha_E}{\\beta_0 + \\alpha_E} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{\\beta_0}{\\beta_0 + \\alpha_E} \\end{pmatrix}\n$$\n其逆矩阵为：\n$$\n\\mathcal{A}_+^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{\\beta_0 + \\alpha_E}{\\beta_0} \\end{pmatrix}\n$$\n\n**3. 光度质心计算**\n\n光度质心 $\\langle\\vec{\\theta}\\rangle_L$ 相对于源中心被透镜化后的位置 $\\vec{\\theta}_+$ 的矢量偏移为 $\\Delta\\vec{\\theta} = \\langle\\vec{\\theta}\\rangle_L - \\vec{\\theta}_+$。\n$$\n\\Delta\\vec{\\theta} = \\frac{\\int_{\\text{image}} (\\vec{\\theta}_+ + \\delta\\vec{\\theta}) I_I(\\vec{\\theta}) d^2\\theta}{\\int_{\\text{image}} I_I(\\vec{\\theta}) d^2\\theta} - \\vec{\\theta}_+ = \\frac{\\int_{\\text{image}} \\delta\\vec{\\theta} I_I(\\vec{\\theta}) d^2\\theta}{\\int_{\\text{image}} I_I(\\vec{\\theta}) d^2\\theta}\n$$\n我们将积分变量更改为源平面坐标 $\\delta\\vec{\\beta}$。表面亮度是守恒的，$I_I(\\vec{\\theta}_+ + \\delta\\vec{\\theta}) = I_S(\\vec{\\beta}_c + \\delta\\vec{\\beta}) = I_0(1+\\vec{g}\\cdot\\delta\\vec{\\beta})$。面积元的变换关系为 $d^2\\theta = |\\det(\\mathcal{A}_+^{-1})| d^2\\beta = \\mu_+ d^2\\beta$。\n$$\n\\Delta\\vec{\\theta} = \\frac{\\int_{\\text{source}} (\\mathcal{A}_+^{-1} \\delta\\vec{\\beta}) I_S(\\delta\\vec{\\beta}) \\mu_+ d^2\\beta}{\\int_{\\text{source}} I_S(\\delta\\vec{\\beta}) \\mu_+ d^2\\beta} = \\frac{\\int_{|\\delta\\beta|\\le\\epsilon} (\\mathcal{A}_+^{-1} \\delta\\vec{\\beta}) I_0(1+\\vec{g}\\cdot\\delta\\vec{\\beta}) d^2\\beta}{\\int_{|\\delta\\beta|\\le\\epsilon} I_0(1+\\vec{g}\\cdot\\delta\\vec{\\beta}) d^2\\beta}\n$$\n我们来计算分子和分母。\n\n分母：\n$$\nD = I_0 \\int_{|\\delta\\beta|\\le\\epsilon} (1 + g_x \\delta\\beta_x + g_y \\delta\\beta_y) d\\delta\\beta_x d\\delta\\beta_y\n$$\n因为圆盘关于原点对称，所以 $\\int \\delta\\beta_x dA=0$ 且 $\\int \\delta\\beta_y dA=0$。\n$$\nD = I_0 \\int_{|\\delta\\beta|\\le\\epsilon} d^2\\beta = I_0 (\\pi \\epsilon^2)\n$$\n分子：\n$$\n\\vec{N} = \\int_{|\\delta\\beta|\\le\\epsilon} \\mathcal{A}_+^{-1} \\delta\\vec{\\beta} \\cdot I_0(1+\\vec{g}\\cdot\\delta\\vec{\\beta}) d^2\\beta = I_0 \\mathcal{A}_+^{-1} \\int_{|\\delta\\beta|\\le\\epsilon} \\delta\\vec{\\beta}(1+g_x\\delta\\beta_x + g_y\\delta\\beta_y) d^2\\beta\n$$\n积分变为：\n$$\n\\int_{|\\delta\\beta|\\le\\epsilon} \\begin{pmatrix} \\delta\\beta_x(1+g_x\\delta\\beta_x + g_y\\delta\\beta_y) \\\\ \\delta\\beta_y(1+g_x\\delta\\beta_x + g_y\\delta\\beta_y) \\end{pmatrix} d^2\\beta = \\int_{|\\delta\\beta|\\le\\epsilon} \\begin{pmatrix} g_x\\delta\\beta_x^2 + g_y\\delta\\beta_x\\delta\\beta_y \\\\ g_x\\delta\\beta_x\\delta\\beta_y + g_y\\delta\\beta_y^2 \\end{pmatrix} d^2\\beta\n$$\n因为 $\\delta\\beta_x, \\delta\\beta_y$ 的线性项积分为零。根据对称性，$\\delta\\beta_x\\delta\\beta_y$ 在圆盘上的积分也为零。我们需要计算 $\\int \\delta\\beta_x^2 d^2\\beta$ 和 $\\int \\delta\\beta_y^2 d^2\\beta$。这些是半径为 $\\epsilon$ 的圆盘的面积二阶矩。\n$$\n\\int_{\\text{disk}} \\delta\\beta_x^2 d^2\\beta = \\int_{\\text{disk}} \\delta\\beta_y^2 d^2\\beta = \\frac{\\pi \\epsilon^4}{4}\n$$\n因此积分矢量为 $\\begin{pmatrix} g_x (\\pi\\epsilon^4/4) \\\\ g_y (\\pi\\epsilon^4/4) \\end{pmatrix} = \\frac{\\pi\\epsilon^4}{4} \\vec{g}$。\n分子是 $\\vec{N} = I_0 \\mathcal{A}_+^{-1} \\left( \\frac{\\pi\\epsilon^4}{4} \\vec{g} \\right)$。\n\n偏移矢量为：\n$$\n\\Delta\\vec{\\theta} = \\frac{\\vec{N}}{D} = \\frac{I_0 \\mathcal{A}_+^{-1} (\\pi\\epsilon^4/4) \\vec{g}}{I_0 (\\pi \\epsilon^2)} = \\frac{\\epsilon^2}{4} \\mathcal{A}_+^{-1} \\vec{g}\n$$\n代入矩阵 $\\mathcal{A}_+^{-1}$ 和矢量 $\\vec{g}$：\n$$\n\\Delta\\vec{\\theta} = \\frac{\\epsilon^2}{4} \\begin{pmatrix} 1  0 \\\\ 0  \\frac{\\beta_0+\\alpha_E}{\\beta_0} \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\frac{\\epsilon^2}{4} \\begin{pmatrix} g_x \\\\ g_y \\left(1 + \\frac{\\alpha_E}{\\beta_0}\\right) \\end{pmatrix}\n$$\n这个矢量代表了偏移。坐标系是对齐的，使得径向为x方向，切向为y方向。\n\n**4. 偏移矢量的大小**\n\n问题要求计算这个矢量偏移的大小。\n$$\n|\\Delta\\vec{\\theta}| = \\left| \\frac{\\epsilon^2}{4} \\sqrt{g_x^2 + \\left(g_y \\left(1 + \\frac{\\alpha_E}{\\beta_0}\\right)\\right)^2} \\right|\n$$\n由于所有参数均为正，我们有：\n$$\n|\\Delta\\vec{\\theta}| = \\frac{\\epsilon^2}{4} \\sqrt{g_x^2 + g_y^2 \\left(1 + \\frac{\\alpha_E}{\\beta_0}\\right)^2}\n$$\n这就是偏移大小的最终表达式。", "answer": "$$\n\\boxed{\\frac{\\epsilon^2}{4} \\sqrt{g_x^2 + g_y^2 \\left(1 + \\frac{\\alpha_E}{\\beta_0}\\right)^2}}\n$$", "id": "879997"}]}