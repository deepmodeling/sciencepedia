{"hands_on_practices": [{"introduction": "The most effective way to grasp the logic of a permutation test is to perform one from the ground up. This practice guides you through the complete process for a small dataset, starting with the calculation of an observed test statistic. You will then generate the entire null distribution by considering every possible reassignment of the data labels to see how your observed result compares, ultimately allowing you to calculate an exact p-value.", "problem": "A biostatistician is analyzing the results of a small pilot study for a new drug. They have collected data from a treatment group (Group A) and a control group (Group B). The measurements for the two groups are as follows:\n\n- Group A (sample size $n_A = 3$): $\\{-4.1, 2.9, 3.5\\}$\n- Group B (sample size $n_B = 2$): $\\{-2.5, -3.8\\}$\n\nThe statistician wants to test the null hypothesis ($H_0$) that the drug has no effect, which implies that the underlying probability distributions of the measurements for both groups are identical. Due to the small sample size and concerns about the non-normality of the data, they decide to perform a non-parametric permutation test.\n\nThe chosen test statistic is the difference between the sample means, $T = \\bar{X}_A - \\bar{X}_B$. The permutation test procedure involves pooling all 5 observations and considering every possible way to partition them into a new \"Group A\" of size 3 and a new \"Group B\" of size 2.\n\nCalculate the two-sided p-value for the observed data. The p-value is the proportion of all possible partitions for which the absolute value of the test statistic is greater than or equal to the absolute value of the test statistic from the original observation. Express your answer as a fully reduced fraction.", "solution": "Under the null hypothesis that the two groups are identically distributed, a permutation test enumerates all ways to assign the pooled observations to a group of size $3$ (new Group A) and a group of size $2$ (new Group B). The chosen statistic is $T=\\bar{X}_{A}-\\bar{X}_{B}$. The two-sided p-value is the proportion of partitions for which $|T|$ is at least as large as the observed $|T|$.\n\nCompute the observed statistic. For Group A, the sample is $\\{-4.1, 2.9, 3.5\\}$ with sum $s_{A}^{\\text{obs}}=-4.1+2.9+3.5=\\frac{23}{10}$ and mean $\\bar{X}_{A}=\\frac{23}{30}$. For Group B, the sample is $\\{-2.5,-3.8\\}$ with sum $s_{B}^{\\text{obs}}=-2.5-3.8=-\\frac{63}{10}$ and mean $\\bar{X}_{B}=-\\frac{63}{20}$. Thus\n$$\nT_{\\text{obs}}=\\bar{X}_{A}-\\bar{X}_{B}=\\frac{23}{30}-\\left(-\\frac{63}{20}\\right)=\\frac{47}{12}.\n$$\nHence $|T_{\\text{obs}}|=\\frac{47}{12}$.\n\nPool all $5$ observations, whose total sum is\n$$\nS_{\\text{total}}=\\frac{23}{10}-\\frac{63}{10}=-4.\n$$\nFor any partition, if $s_{A}$ is the sum of the three values assigned to Group A, then $s_{B}=S_{\\text{total}}-s_{A}=-4-s_{A}$, and the statistic is\n$$\nT=\\frac{s_{A}}{3}-\\frac{s_{B}}{2}=\\frac{s_{A}}{3}-\\frac{-4-s_{A}}{2}=2+\\frac{5}{6}s_{A}.\n$$\n\nThere are $\\binom{5}{3}=10$ partitions. Enumerate all size-$3$ subsets (Group A), compute $s_{A}$ and $T=2+\\frac{5}{6}s_{A}$:\n\n- $\\{-4.1,2.9,3.5\\}$: $s_{A}=\\frac{23}{10}$, $T=\\frac{47}{12}$.\n- $\\{-4.1,2.9,-2.5\\}$: $s_{A}=-\\frac{37}{10}$, $T=-\\frac{13}{12}$.\n- $\\{-4.1,2.9,-3.8\\}$: $s_{A}=-5$, $T=-\\frac{13}{6}$.\n- $\\{-4.1,3.5,-2.5\\}$: $s_{A}=-\\frac{31}{10}$, $T=-\\frac{7}{12}$.\n- $\\{-4.1,3.5,-3.8\\}$: $s_{A}=-\\frac{22}{5}$, $T=-\\frac{5}{3}$.\n- $\\{-4.1,-2.5,-3.8\\}$: $s_{A}=-\\frac{52}{5}$, $T=-\\frac{20}{3}$.\n- $\\{2.9,3.5,-2.5\\}$: $s_{A}=\\frac{39}{10}$, $T=\\frac{21}{4}$.\n- $\\{2.9,3.5,-3.8\\}$: $s_{A}=\\frac{13}{5}$, $T=\\frac{25}{6}$.\n- $\\{2.9,-2.5,-3.8\\}$: $s_{A}=-\\frac{17}{5}$, $T=-\\frac{5}{6}$.\n- $\\{3.5,-2.5,-3.8\\}$: $s_{A}=-\\frac{14}{5}$, $T=-\\frac{1}{3}$.\n\nCompute absolute values and compare to $|T_{\\text{obs}}|=\\frac{47}{12}$:\n- Qualifying (since $|T|\\geq \\frac{47}{12}$): $\\frac{47}{12}$, $-\\frac{20}{3}$, $\\frac{21}{4}$, $\\frac{25}{6}$.\n- Non-qualifying: $-\\frac{13}{12}$, $-\\frac{13}{6}$, $-\\frac{7}{12}$, $-\\frac{5}{3}$, $-\\frac{5}{6}$, $-\\frac{1}{3}$.\n\nThere are $4$ qualifying partitions out of $10$. Therefore, the two-sided p-value is\n$$\np=\\frac{4}{10}=\\frac{2}{5}.\n$$", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "1943765"}, {"introduction": "Having performed a complete exact test [@problem_id:1943765], we now explore a critical feature of this method when applied to small datasets. This exercise highlights the discrete nature of the p-value distribution in a permutation test. By determining the smallest possible non-zero p-value for a given experimental design, you will gain insight into the inherent limitations on statistical significance in studies with limited sample sizes.", "problem": "A team of data scientists at a tech company is conducting an A/B test to see if a new website layout (Layout A) increases user engagement time compared to the old layout (Layout B). Due to budget constraints, they can only run the experiment on a very small sample of users. A total of 7 new users are selected for the study. Of these, 3 are randomly assigned to see Layout A, and the remaining 4 are assigned to see Layout B.\n\nAfter a week, the total engagement time is recorded for each user. To analyze the results, the team decides to perform a one-sided exact permutation test to determine if Layout A leads to a statistically significant increase in engagement time.\n\nAssuming that no two users have the exact same engagement time, what is the smallest possible non-zero p-value that can be obtained from this test? Express your answer as a simplified fraction.", "solution": "In an exact permutation test with fixed group sizes, the null hypothesis implies exchangeability of labels across the observed engagement times. With 7 users, of whom 3 are assigned to Layout A and 4 to Layout B, the permutation distribution is built by considering all distinct assignments of 3 users to Layout A. The total number of such assignments is\n$$\n\\binom{7}{3}.\n$$\nA one-sided test for an increase in engagement under Layout A uses a test statistic that is monotone in the Layout A outcomes (for example, the sum or mean of the Layout A engagement times). Because no two users have the same engagement time, the arrangement that maximizes this statistic is unique: it assigns the three largest engagement times to Layout A. Therefore, the smallest possible non-zero p-value arises when the observed assignment is this unique most-extreme configuration, so the tail probability counts exactly one permutation in the numerator. Hence,\n$$\np_{\\min}=\\frac{1}{\\binom{7}{3}}=\\frac{1}{35}.\n$$\nThis is the smallest possible non-zero p-value for the one-sided exact permutation test under the stated conditions.", "answer": "$$\\boxed{\\frac{1}{35}}$$", "id": "1943794"}, {"introduction": "While exact permutation tests provide a clear theoretical foundation, they are computationally infeasible for all but the smallest datasets. This practice addresses this real-world challenge by introducing the concept of a Monte Carlo approximation. You will learn how to calculate an estimated p-value based on a large but incomplete sample of random permutations, a technique that makes these tests a versatile tool for modern data analysis.", "problem": "Researchers are conducting a study to compare the effectiveness of two different online learning platforms, Platform A and Platform B. They recruit 50 students and randomly assign 25 to learn a specific topic using Platform A and the other 25 to learn the same topic using Platform B. At the end of the study period, all students take a standardized test. The test statistic of interest is the absolute difference in the mean test scores between the two groups, $|\\bar{x}_A - \\bar{x}_B|$. The observed value for this statistic from the experiment is $\\delta_{obs}$.\n\nTo determine if the observed difference is statistically significant, the researchers employ a permutation test. They pool all 50 test scores and generate $N=19,999$ new datasets by randomly re-assigning 25 scores to a \"Platform A\" group and 25 to a \"Platform B\" group. For each of these random permutations, they compute a new test statistic, $\\delta_{perm}$. They find that for $k=99$ of these permutations, the resulting statistic was at least as large as their original observation, i.e., $\\delta_{perm} \\ge \\delta_{obs}$.\n\nThe estimated p-value is the proportion of all considered outcomes (the $N$ random permutations plus the original observed outcome) for which the test statistic is at least as extreme as the one observed. Based on these results, calculate the p-value. Express your answer as a decimal rounded to three significant figures.", "solution": "The permutation test p-value, defined as the proportion of all considered outcomes (the original observed dataset plus the randomly permuted datasets) whose test statistic is at least as extreme as the observed, is computed as\n$$\n\\hat{p}=\\frac{k+1}{N+1},\n$$\nwhere $N$ is the number of random permutations and $k$ is the number of those permutations with $\\delta_{perm}\\ge \\delta_{obs}$. Including the observed dataset contributes the $+1$ in both numerator and denominator.\n\nSubstituting the given values $N=19999$ and $k=99$,\n$$\n\\hat{p}=\\frac{99+1}{19999+1}=\\frac{100}{20000}=\\frac{1}{200}=0.005.\n$$\nExpressed as a decimal rounded to three significant figures, this is\n$$\n0.00500.\n$$", "answer": "$$\\boxed{0.00500}$$", "id": "1943826"}]}