{"hands_on_practices": [{"introduction": "This first exercise provides a foundational scenario for calculating a Bayes factor. We will explore how to quantify the evidence for two competing hypotheses about the mean of a Normal distribution, a common task in fields like quality control or experimental science. By working through this problem [@problem_id:1959110], you will practice the direct application of the likelihood ratio for simple hypotheses.", "problem": "A quality control engineer is monitoring a machine that fills bags of coffee. The machine is calibrated to a target mean weight of $\\mu_0 = 250.0$ grams per bag. The engineer suspects that a recent software update might have shifted this mean. To test this, two simple hypotheses are formulated: a null hypothesis, $H_0$, that the mean weight is unchanged, and an alternative hypothesis, $H_1$, that the mean weight has shifted to a specific new value, $\\mu_1 = 251.0$ grams.\n\nFrom historical data, the weight of a filled bag is known to be well-modeled by a Normal distribution with a known standard deviation of $\\sigma = 2.0$ grams.\n\nTo investigate the hypotheses, the engineer takes a single random sample from the production line and measures its weight to be $x = 250.8$ grams.\n\nAssuming the data-generating process follows a Normal distribution $N(\\mu, \\sigma^2)$, calculate the Bayes factor $B_{01}$ in favor of the null hypothesis $H_0: \\mu = \\mu_0$ against the alternative hypothesis $H_1: \\mu = \\mu_1$. Report your answer as a numerical value rounded to three significant figures.", "solution": "We have two simple hypotheses for the mean of a Normal distribution with known variance: $H_{0}: \\mu=\\mu_{0}$ and $H_{1}: \\mu=\\mu_{1}$. The Bayes factor in favor of $H_{0}$ against $H_{1}$ for a single observation $x$ is the ratio of marginal likelihoods, which for simple hypotheses equals the likelihood ratio:\n$$\nB_{01}=\\frac{f(x \\mid \\mu_{0}, \\sigma^{2})}{f(x \\mid \\mu_{1}, \\sigma^{2})}.\n$$\nFor a Normal model with known standard deviation $\\sigma$, the likelihood is\n$$\nf(x \\mid \\mu, \\sigma^{2})=\\frac{1}{\\sqrt{2 \\pi}\\sigma}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\nTherefore, the common normalizing factor cancels in the ratio, yielding\n$$\nB_{01}=\\exp\\left(\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}\\right).\n$$\nSubstituting the given values $x=250.8$, $\\mu_{0}=250.0$, $\\mu_{1}=251.0$, and $\\sigma=2.0$,\n$$\n(x-\\mu_{1})^{2}=(-0.2)^{2}=0.04,\\quad (x-\\mu_{0})^{2}=(0.8)^{2}=0.64,\n$$\nso\n$$\n\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}=\\frac{0.04-0.64}{2\\cdot 4}=\\frac{-0.60}{8}=-0.075.\n$$\nHence,\n$$\nB_{01}=\\exp(-0.075)\\approx 0.928,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{0.928}$$", "id": "1959110"}, {"introduction": "Moving from continuous measurements to discrete counts, this practice explores a classic scenario involving defect rates. You will use the Binomial distribution to model the data and calculate the Bayes factor, learning how it applies to comparing proportions [@problem_id:1959126]. This exercise demonstrates the versatility of the Bayes factor in handling different types of data common in manufacturing and polling.", "problem": "A manufacturing facility produces high-capacity batteries for electric vehicles. Historically, the production process has maintained a stable defect rate of $1\\%$. Recently, a new supplier for a critical raw material was introduced. A plant manager hypothesizes that this change might have increased the defect rate to $3\\%$. To investigate this, a random sample of 100 batteries is drawn from the new production run, and 2 defective batteries are found.\n\nYou are tasked with quantifying the evidence for the manager's hypothesis. Let $H_0$ be the model where the defect rate is the historical $1\\%$, and let $H_1$ be the model where the defect rate is the suspected $3\\%$. Calculate the Bayes factor, $K$, which is the ratio of the likelihood of the observed data under model $H_1$ to the likelihood of the data under model $H_0$.\n\nGive your answer as a single real number, rounded to three significant figures.", "solution": "We model the number of defectives $X$ in $n=100$ batteries as binomial with parameter $p$. Under $H_{0}$, $p_{0}=0.01$, and under $H_{1}$, $p_{1}=0.03$. The likelihood for observing $x=2$ defectives is\n$$\nL(p)=\\binom{100}{2}p^{2}(1-p)^{98}.\n$$\nThe Bayes factor $K$ (likelihood ratio) comparing $H_{1}$ to $H_{0}$ is\n$$\nK=\\frac{L(p_{1})}{L(p_{0})}=\\frac{\\binom{100}{2}p_{1}^{2}(1-p_{1})^{98}}{\\binom{100}{2}p_{0}^{2}(1-p_{0})^{98}}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{2}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{98}.\n$$\nSubstituting $p_{1}=0.03$ and $p_{0}=0.01$,\n$$\nK= \\left(\\frac{0.03}{0.01}\\right)^{2}\\left(\\frac{0.97}{0.99}\\right)^{98}=9\\left(\\frac{0.97}{0.99}\\right)^{98}.\n$$\nFor numerical evaluation, use logarithms:\n$$\n\\ln K=\\ln 9+98\\left(\\ln 0.97-\\ln 0.99\\right).\n$$\nCompute $98\\left(\\ln 0.97-\\ln 0.99\\right)\\approx -2.00007$, so\n$$\nK\\approx 9\\exp(-2.00007)\\approx 9\\times 0.135326\\approx 1.22,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{1.22}$$", "id": "1959126"}, {"introduction": "This final practice shifts our focus from calculation to interpretation, asking a crucial conceptual question. Instead of computing the evidence from a given data point, we will determine what data point would provide perfectly balanced evidence between two competing theories [@problem_id:1959093]. Solving this reveals the intuitive meaning of a Bayes factor of one and deepens your understanding of how it measures evidential support.", "problem": "A physicist is attempting to measure the true value of a physical constant, $\\mu$. The experimental apparatus is known to yield measurements that are normally distributed around the true value $\\mu$, with a known standard deviation of $\\sigma = 1.0$ (in some arbitrary units). There are two competing theories about this constant. Theory $H_0$ predicts its value to be $\\mu_0 = 5.0$, while Theory $H_1$ predicts its value to be $\\mu_1 = 6.0$.\n\nA single measurement, $x$, is obtained from the experiment. To compare the two theories, the physicist computes the Bayes factor, $B_{10}$, which is defined as the ratio of the probabilities of observing the data point $x$ under each theory:\n$$ B_{10} = \\frac{p(x | H_1)}{p(x | H_0)} $$\nA Bayes factor of 1 indicates that the measurement provides equal support for both theories. Determine the numerical value of the measurement $x$ that would result in a Bayes factor of exactly 1.", "solution": "The measurement model under each theory is a normal likelihood with known standard deviation $\\sigma$, so\n$$\np(x \\mid H_{i})=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(x-\\mu_{i})^{2}}{2\\sigma^{2}}\\right),\\quad i\\in\\{0,1\\}.\n$$\nThe Bayes factor is\n$$\nB_{10}=\\frac{p(x\\mid H_{1})}{p(x\\mid H_{0})}\n=\\frac{\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(x-\\mu_{1})^{2}}{2\\sigma^{2}}\\right)}{\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(x-\\mu_{0})^{2}}{2\\sigma^{2}}\\right)}\n=\\exp\\!\\left(-\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}\\right).\n$$\nSetting $B_{10}=1$ and taking the natural logarithm gives\n$$\n\\ln B_{10}=0 \\;\\;\\Longrightarrow\\;\\; -\\frac{(x-\\mu_{1})^{2}-(x-\\mu_{0})^{2}}{2\\sigma^{2}}=0 \\;\\;\\Longrightarrow\\;\\; (x-\\mu_{1})^{2}=(x-\\mu_{0})^{2}.\n$$\nExpanding and simplifying,\n$$\n(x^{2}-2x\\mu_{1}+\\mu_{1}^{2})-(x^{2}-2x\\mu_{0}+\\mu_{0}^{2})=0\n\\;\\;\\Longrightarrow\\;\\; -2x\\mu_{1}+\\mu_{1}^{2}+2x\\mu_{0}-\\mu_{0}^{2}=0,\n$$\n$$\n2x(\\mu_{0}-\\mu_{1})+\\mu_{1}^{2}-\\mu_{0}^{2}=0\n\\;\\;\\Longrightarrow\\;\\; 2x(\\mu_{0}-\\mu_{1})=\\mu_{0}^{2}-\\mu_{1}^{2}\n\\;\\;\\Longrightarrow\\;\\; x=\\frac{\\mu_{0}^{2}-\\mu_{1}^{2}}{2(\\mu_{0}-\\mu_{1})}.\n$$\nUsing the identity $\\mu_{0}^{2}-\\mu_{1}^{2}=(\\mu_{0}-\\mu_{1})(\\mu_{0}+\\mu_{1})$ and assuming $\\mu_{0}\\neq\\mu_{1}$, we obtain\n$$\nx=\\frac{\\mu_{0}+\\mu_{1}}{2}.\n$$\nSubstituting $\\mu_{0}=5.0$ and $\\mu_{1}=6.0$ gives\n$$\nx=\\frac{5.0+6.0}{2}=5.5.\n$$", "answer": "$$\\boxed{5.5}$$", "id": "1959093"}]}