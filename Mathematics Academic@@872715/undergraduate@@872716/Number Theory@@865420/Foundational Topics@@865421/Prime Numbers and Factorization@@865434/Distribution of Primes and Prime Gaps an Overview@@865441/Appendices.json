{"hands_on_practices": [{"introduction": "Bertrand's Postulate guarantees the existence of at least one prime in the interval $(n, 2n]$ for $n \\ge 2$, but how does the number of primes in this interval behave as $n$ grows? This exercise invites you to investigate this question at a small scale through direct computation. By finding the first instance where more than one prime appears, you will uncover a fundamental truth about the distribution of primes: the count is not a simple, smoothly increasing function, a first hint at the complex and erratic nature of prime gaps. [@problem_id:3084533]", "problem": "Let $\\pi(x)$ denote the prime counting function, and let $\\Delta(n) := \\pi(2n) - \\pi(n)$ denote the number of primes in the interval $(n,2n]$. Using only fundamental definitions and widely accepted facts in number theory—specifically, Bertrand’s postulate (which states that for every integer $n \\geq 2$ there is a prime in $(n,2n)$) and Chebyshev-type bounds for $\\pi(x)$ that compare $\\pi(x)$ to $x / \\ln x$ with absolute constants—address the following:\n\n1. Compute the smallest positive integer $n$ for which the interval $(n,2n]$ contains strictly more than one prime; that is, the smallest $n$ for which $\\Delta(n) \\geq 2$.\n\n2. Explain, by logical reasoning from these facts and definitions, how this computation informs whether the sequence $n \\mapsto \\Delta(n)$ is monotone in $n$. Your explanation should include a specific integer example showing a decrease in $\\Delta(n)$ and a brief argument using Chebyshev-type bounds that $\\Delta(n)$ is unbounded as $n \\to \\infty$.\n\nYour final answer must be the single integer from part $1$.", "solution": "The problem presents two tasks concerning the function $\\Delta(n) := \\pi(2n) - \\pi(n)$, where $\\pi(x)$ is the prime-counting function. The first task is to find the smallest positive integer $n$ for which $\\Delta(n) \\geq 2$. The second is to use this result to discuss the monotonicity of the sequence $n \\mapsto \\Delta(n)$ and to briefly argue for its unboundedness using Chebyshev-type bounds.\n\nFirst, we address the computation of the smallest positive integer $n$ for which the interval $(n, 2n]$ contains at least two primes, i.e., $\\Delta(n) \\geq 2$. We proceed by evaluating $\\Delta(n)$ for successive positive integer values of $n$. The prime numbers are $2, 3, 5, 7, 11, 13, \\dots$. The prime-counting function $\\pi(x)$ gives the number of primes less than or equal to $x$.\n\nFor $n=1$: The interval is $(1, 2]$. The only prime in this interval is $2$.\nTherefore, $\\Delta(1) = \\pi(2 \\cdot 1) - \\pi(1) = \\pi(2) - \\pi(1) = 1 - 0 = 1$.\nSince $\\Delta(1) = 1$, the condition $\\Delta(n) \\geq 2$ is not satisfied.\n\nFor $n=2$: The interval is $(2, 4]$. The only prime in this interval is $3$.\nTherefore, $\\Delta(2) = \\pi(2 \\cdot 2) - \\pi(2) = \\pi(4) - \\pi(2) = 2 - 1 = 1$.\nThe condition is not satisfied. Bertrand's postulate, given for $n \\geq 2$, guarantees $\\Delta(n) \\geq 1$, which is consistent with our finding.\n\nFor $n=3$: The interval is $(3, 6]$. The only prime in this interval is $5$.\nTherefore, $\\Delta(3) = \\pi(2 \\cdot 3) - \\pi(3) = \\pi(6) - \\pi(3) = 3 - 2 = 1$.\nThe condition is not satisfied.\n\nFor $n=4$: The interval is $(4, 8]$. The primes in this interval are $5$ and $7$. There are two primes.\nTherefore, $\\Delta(4) = \\pi(2 \\cdot 4) - \\pi(4) = \\pi(8) - \\pi(4) = 4 - 2 = 2$.\nThe condition $\\Delta(n) \\geq 2$ is satisfied for $n=4$.\nSince the condition was not met for $n=1, 2, 3$, the smallest positive integer for which $\\Delta(n) \\geq 2$ is $n=4$.\n\nNext, we address the monotonicity of the sequence $n \\mapsto \\Delta(n)$. A sequence is monotone if it is either non-decreasing or non-increasing. Our calculations so far give the sequence of values for $\\Delta(n)$ starting from $n=1$: $1, 1, 1, 2$. To test for monotonicity, we compute the next term.\n\nFor $n=5$: The interval is $(5, 10]$. The only prime in this interval is $7$.\nTherefore, $\\Delta(5) = \\pi(2 \\cdot 5) - \\pi(5) = \\pi(10) - \\pi(5) = 4 - 3 = 1$.\n\nThe sequence of values for $\\Delta(n)$ for $n=1, 2, 3, 4, 5$ is $1, 1, 1, 2, 1$.\nWe observe that $\\Delta(3)=1  \\Delta(4)=2$, which shows the sequence is not non-increasing.\nWe also observe that $\\Delta(4)=2  \\Delta(5)=1$, which shows the sequence is not non-decreasing.\nSince the sequence is neither non-decreasing nor non-increasing, it is not monotone. The computation for $n=4$ and $n=5$ provides a specific integer example of a decrease in the value of $\\Delta(n)$.\n\nFinally, we provide a brief argument that $\\Delta(n)$ is unbounded as $n \\to \\infty$, using Chebyshev-type bounds. These bounds state that there exist positive constants $c_1$ and $c_2$ such that for all sufficiently large $x$, the following inequalities hold:\n$$c_1 \\frac{x}{\\ln x}  \\pi(x)  c_2 \\frac{x}{\\ln x}$$\nUsing these bounds, we can establish a lower bound for $\\Delta(n) = \\pi(2n) - \\pi(n)$:\n$$\\Delta(n) = \\pi(2n) - \\pi(n)  c_1 \\frac{2n}{\\ln(2n)} - c_2 \\frac{n}{\\ln n}$$\nWe can rewrite the right-hand side for large $n$:\n$$c_1 \\frac{2n}{\\ln 2 + \\ln n} - c_2 \\frac{n}{\\ln n} = \\frac{n}{\\ln n} \\left( c_1 \\frac{2}{1 + \\frac{\\ln 2}{\\ln n}} - c_2 \\right)$$\nAs $n \\to \\infty$, the term $\\frac{\\ln 2}{\\ln n} \\to 0$. Therefore, the expression in the parenthesis approaches a limit:\n$$\\lim_{n\\to\\infty} \\left( c_1 \\frac{2}{1 + \\frac{\\ln 2}{\\ln n}} - c_2 \\right) = 2c_1 - c_2$$\nA widely accepted fact in number theory, originating from Chebyshev's work and refined since, is that the constants $c_1$ and $c_2$ can be chosen such that $2c_1 - c_2  0$. For example, modern results provide bounds where $c_1$ and $c_2$ are both close to $1$, for which $2c_1-c_2$ is close to $1$.\nLet $K = 2c_1 - c_2  0$. For large $n$, our lower bound for $\\Delta(n)$ is asymptotically equivalent to $K \\frac{n}{\\ln n}$.\nSince $\\lim_{n \\to \\infty} \\frac{n}{\\ln n} = \\infty$, the lower bound for $\\Delta(n)$ also tends to infinity.\nThis implies that the sequence $\\Delta(n)$ is unbounded. The initial, small-scale, non-monotone behavior of $\\Delta(n)$ does not preclude its general trend of growth.", "answer": "$$\\boxed{4}$$", "id": "3084533"}, {"introduction": "While the Prime Number Theorem tells us that the *average* gap between primes near $x$ is about $\\log x$, the behavior of *maximal* gaps is far more mysterious and a subject of deep conjectures. This computational practice challenges you to become an experimental number theorist, using programming to gather empirical data on prime gaps up to ten million. By calculating and comparing the largest observed gaps to the theoretical scales of $\\log x$ and $(\\log x)^2$, you will gain a first-hand appreciation for the difference between average trends and extreme events in the distribution of primes. [@problem_id:3084537]", "problem": "You are to study the empirical behavior of prime gaps through computation. Let $p_n$ denote the $n$-th prime number, and define the prime gap sequence $g(p_n) = p_{n+1} - p_n$ for $n \\geq 1$. Let $\\pi(x)$ denote the prime counting function, that is, the number of primes less than or equal to $x$. Let $\\log x$ denote the natural logarithm of $x$. The fundamental base for this investigation is the Prime Number Theorem (PNT), which states that $\\pi(x) \\sim \\dfrac{x}{\\log x}$ as $x \\to \\infty$. This implies that the average spacing between consecutive primes near $x$ is heuristically of scale $\\log x$. Another widely discussed heuristic, often attributed to Cramér, suggests that the maximal gaps may grow on the scale of $(\\log x)^2$.\n\nYour task is to write a complete, runnable program that:\n\n- Generates all prime numbers up to $X = 10^7$ using an algorithm justified by fundamental number theoretic principles (for example, the Sieve of Eratosthenes).\n- For a given $x$, defines:\n  - The maximal observed gap up to $x$,\n    $$ G_{\\max}(x) = \\max\\{ g(p_n) : p_{n+1} \\leq x \\}. $$\n  - The empirical average gap up to $x$,\n    $$ \\overline{g}(x) = \\frac{p_k - 2}{k - 1}, \\quad \\text{where } p_k = \\max\\{p_n \\leq x\\} \\text{ and } k = \\pi(x). $$\n    This quantity equals the average of the consecutive prime differences $g(p_n)$ for $p_{n+1} \\leq x$ by telescoping, and is a direct computation that can be compared to the $\\log x$ scale suggested by the Prime Number Theorem.\n  - The minimal gap up to $x$ among consecutive primes with both primes at least $5$ (to exclude the exceptional initial gap between $2$ and $3$),\n    $$ G_{\\min}^{\\geq 5}(x) = \\min\\{ g(p_n) : p_n \\geq 5 \\text{ and } p_{n+1} \\leq x \\}. $$\n  - The ratio of the maximal observed gap to the natural logarithm,\n    $$ R_1(x) = \\frac{G_{\\max}(x)}{\\log x}, $$\n    and the ratio of the maximal observed gap to the square of the natural logarithm,\n    $$ R_2(x) = \\frac{G_{\\max}(x)}{(\\log x)^2}. $$\n- Compares $G_{\\max}(x)$ empirically to the baselines $\\log x$ and $(\\log x)^2$ via the ratios $R_1(x)$ and $R_2(x)$.\n\nUse the following test suite of $x$ values:\n- $x = 30$ (small-scale behavior and boundary effects),\n- $x = 10^5$,\n- $x = 10^6$,\n- $x = 3 \\cdot 10^6$,\n- $x = 10^7$ (upper limit).\n\nFor each $x$ in the test suite, compute and report the list\n$$ [\\, x,\\; G_{\\max}(x),\\; \\overline{g}(x),\\; G_{\\min}^{\\geq 5}(x),\\; R_1(x),\\; R_2(x) \\,]. $$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the sublist above for the corresponding test case, in the same order as given. All floating-point values should be printed to six decimal places. For example, the outer structure should look like\n$$ [\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,] $$\nwith no spaces after commas.\n\nAll answers are pure numbers with no physical units. Angles are not involved. Percentages are not involved; ratios are to be expressed as decimals. The program must be self-contained and require no user input, must not access external files or networks, and must run deterministically.", "solution": "The problem posed is a well-defined exercise in computational number theory, requiring an empirical investigation of the distribution of prime numbers and the gaps between them. The problem is scientifically sound, mathematically consistent, and computationally feasible. It is grounded in established number-theoretic concepts such as the Prime Number Theorem and heuristic models of prime gaps. I will therefore proceed with a complete solution.\n\nThe solution methodology is structured into two main phases: first, the efficient generation of a list of prime numbers up to the specified limit $X = 10^7$; and second, the computation of the required statistical measures for each value of $x$ in the provided test suite.\n\n**1. Prime Number Generation: The Sieve of Eratosthenes**\n\nTo perform any analysis of primes, we must first generate them. For the given range up to $X = 10^7$, the most appropriate algorithm is the Sieve of Eratosthenes. This classical algorithm is renowned for its efficiency and conceptual elegance.\n\nThe principle of the sieve is based on a fundamental property of composite numbers: any composite number $n$ has at least one prime factor $p$ such that $p \\leq \\sqrt{n}$. The algorithm works as follows:\n- We create a boolean array, let us call it `is_prime`, of size $X+1$, initializing all entries from $2$ to $X$ as true. The numbers $0$ and $1$ are marked as not prime by definition.\n- We begin with the first prime number, $p=2$. We iterate through its multiples ($2p, 3p, \\dots$) and mark them as not prime in our array.\n- We then find the next number in the array that is still marked as prime; this must be the next prime number, which is $3$. We repeat the process, marking all multiples of $3$ as not prime.\n- This process continues for all primes $p$ up to $\\sqrt{X}$. An optimization is to start marking multiples of $p$ from $p^2$, as any smaller multiple $k \\cdot p$ with $k  p$ would have already been marked as composite by one of $k$'s prime factors (which is smaller than $p$).\n\nThe time complexity of this algorithm is approximately $O(X \\log \\log X)$, which is very efficient and allows for the generation of primes up to $10^7$ in a few seconds on a standard computer. After the sieve has run, the `is_prime` array allows for the extraction of an ordered list of all prime numbers up to $X$.\n\n**2. Computation of Prime Gap Statistics**\n\nWith the ordered list of primes, denoted as the array `primes`, we can proceed to calculate the required quantities for each test value of $x \\in \\{30, 10^5, 10^6, 3 \\cdot 10^6, 10^7\\}$.\n\nFor each value of $x$:\n\nFirst, we must identify the set of primes less than or equal to $x$. Let these be $\\{p_1, p_2, \\dots, p_k\\}$, where $p_k$ is the largest prime not exceeding $x$. The count of these primes is $k = \\pi(x)$. Using a pre-computed sorted array of all primes up to $10^7$, we can efficiently find $k$ by performing a binary search for $x$. The sub-array `primes[0:k]` then contains exactly the primes we need.\n\nThe required statistics are calculated as follows:\n\n-   **Maximal Observed Gap, $G_{\\max}(x)$**: This is defined as $G_{\\max}(x) = \\max\\{ g(p_n) : p_{n+1} \\leq x \\}$. This condition implies we consider all consecutive prime pairs $(p_n, p_{n+1})$ where both primes are less than or equal to $p_k$. This corresponds to the maximum of the differences $p_{n+1} - p_n$ for $n$ from $1$ to $k-1$. This is programmatically found by taking the maximum value of the array of differences computed from the prime subset.\n\n-   **Empirical Average Gap, $\\overline{g}(x)$**: This is defined by the formula $\\overline{g}(x) = \\frac{p_k - 2}{k - 1}$. The validity of this formula rests on the telescoping sum of gaps: $\\sum_{n=1}^{k-1} g(p_n) = \\sum_{n=1}^{k-1} (p_{n+1} - p_n) = p_k - p_1$. Since $p_1 = 2$, the sum is $p_k - 2$. The number of gaps is $k-1$. The calculation is a direct application of this formula using the determined values of $p_k$ and $k$. This empirical average can be compared to the heuristic $\\log x$ from the Prime Number Theorem.\n\n-   **Minimal Gap, $G_{\\min}^{\\geq 5}(x)$**: This is defined as $G_{\\min}^{\\geq 5}(x) = \\min\\{ g(p_n) : p_n \\geq 5 \\text{ and } p_{n+1} \\leq x \\}$. The condition $p_n \\geq 5$ means we begin our search for gaps starting from the pair $(p_3, p_4) = (5, 7)$. We consider all subsequent gaps $g(p_n)$ as long as $p_{n+1} \\leq x$. The Twin Prime Conjecture posits that there are infinitely many prime pairs $(p, p+2)$, which would imply that for sufficiently large $x$, $G_{\\min}^{\\geq 5}(x)$ should be $2$. For all the values of $x$ in the test suite, there exists at least one twin prime pair $(p, p+2)$ with $p \\geq 5$ and $p+2 \\leq x$, so we expect to find $G_{\\min}^{\\geq 5}(x) = 2$.\n\n-   **Ratios $R_1(x)$ and $R_2(x)$**: These are defined as $R_1(x) = \\frac{G_{\\max}(x)}{\\log x}$ and $R_2(x) = \\frac{G_{\\max}(x)}{(\\log x)^2}$. These ratios are computed directly using the natural logarithm function, `numpy.log`, and the previously calculated $G_{\\max}(x)$. $R_1(x)$ measures the maximal gap in units of the average gap size. $R_2(x)$ tests the scale of maximal gaps against the heuristic model proposed by Cramér. While Cramér's original probabilistic model suggests $\\limsup_{n \\to \\infty} \\frac{g(p_n)}{(\\log p_n)^2} = 1$, refined heuristics suggest the constant may be different. These empirical ratios provide a simple numerical test of these ideas.\n\nThe implementation will synthesize these steps into a single program that first builds the prime list and then iterates through the test cases to compute and format the results as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes empirical statistics of prime gaps up to a specified limit.\n    \"\"\"\n\n    # Define the upper bound for prime generation.\n    # The largest test case is 10^7, so we generate primes up to this limit.\n    limit = 10**7\n\n    # Step 1: Generate all primes up to the limit using the Sieve of Eratosthenes.\n    # This function returns a sorted numpy array of prime numbers.\n    def sieve_of_eratosthenes(n):\n        \"\"\"Generates primes up to n using the Sieve of Eratosthenes.\"\"\"\n        # Create a boolean array `is_prime` of size n + 1.\n        is_prime = np.ones(n + 1, dtype=bool)\n        is_prime[0] = is_prime[1] = False  # 0 and 1 are not prime.\n\n        # Iterate from p = 2 up to sqrt(n).\n        for p in range(2, int(np.sqrt(n)) + 1):\n            if is_prime[p]:\n                # Mark all multiples of p as not prime, starting from p*p.\n                is_prime[p*p::p] = False\n        \n        # Extract prime numbers from the boolean array.\n        primes = np.where(is_prime)[0]\n        return primes\n\n    primes = sieve_of_eratosthenes(limit)\n\n    # Step 2: Define the test cases from the problem statement.\n    test_cases = [\n        30,\n        100000,\n        1000000,\n        3000000,\n        10000000,\n    ]\n\n    all_results = []\n    # Step 3: Process each test case.\n    for x in test_cases:\n        # Find all primes less than or equal to x.\n        # np.searchsorted gives the index where x would be inserted to maintain order.\n        # 'right' side ensures that if x is prime, it's included.\n        k = np.searchsorted(primes, x, side='right')\n        primes_subset = primes[:k]\n        \n        # Ensure there are at least two primes to form a gap.\n        if k  2:\n            # This case is not reached with the given test suite.\n            continue\n            \n        p_k = primes_subset[-1]\n\n        # Calculate all gaps between consecutive primes up to x.\n        gaps = primes_subset[1:] - primes_subset[:-1]\n        \n        # a) Maximal observed gap up to x, G_max(x)\n        g_max = np.max(gaps) if gaps.size > 0 else 0\n\n        # b) Empirical average gap up to x, g_bar(x)\n        # Note: k is the count of primes, p_1=2, so k-1 is the number of gaps.\n        g_bar = (p_k - 2) / (k - 1)\n        \n        # c) Minimal gap for primes >= 5, G_min_geq_5(x)\n        # Find the index of the first prime >= 5.\n        # For all test cases, this will be index 2 (prime 5).\n        start_idx = np.searchsorted(primes_subset, 5)\n        \n        # Check if there are any gaps to consider.\n        if start_idx  len(gaps):\n            g_min_geq_5 = np.min(gaps[start_idx:])\n        else:\n            # No primes >= 5, so no such gaps. Not possible with given tests.\n            g_min_geq_5 = float('inf')\n\n        # d) Ratios R1(x) and R2(x)\n        ln_x = np.log(x)\n        r1 = g_max / ln_x\n        r2 = g_max / (ln_x**2)\n        \n        # Store results for this case. x, g_max, g_min are integers.\n        # g_bar, r1, r2 are floating-point values.\n        result_list = [int(x), int(g_max), g_bar, int(g_min_geq_5), r1, r2]\n        all_results.append(result_list)\n\n    # Step 4: Format and print the final output exactly as required.\n    formatted_sublists = []\n    for res in all_results:\n        x_val, gmax_val, gbar_val, gmin_val, r1_val, r2_val = res\n        s = f\"[{x_val},{gmax_val},{gbar_val:.6f},{gmin_val},{r1_val:.6f},{r2_val:.6f}]\"\n        formatted_sublists.append(s)\n\n    # The final print statement must produce a single line in the specified format.\n    print(f\"[{','.join(formatted_sublists)}]\")\n\nsolve()\n```", "id": "3084537"}, {"introduction": "Can the seemingly chaotic distribution of primes be captured by a simple random process? This thought experiment explores that question through Cramér's model, which treats primality as a probabilistic event. This exercise will guide you through calculating the expected behavior of primes in short intervals under this assumption, yielding a beautifully simple prediction. [@problem_id:3084527] You will then contrast this idealized model with the surprising, rigorous results of Maier's theorem, revealing why the primes, despite their apparent randomness, harbor a deep arithmetic structure that defies simple probabilistic descriptions.", "problem": "Let $x$ be a large real parameter and let $\\pi(x)$ denote the prime counting function. Consider the short interval $[x, x+y]$ with $y=\\lambda \\ln x$, where $\\lambda0$ is a fixed constant independent of $x$. In Cramér’s random model for primes, each integer $n\\geq 2$ is independently declared “prime” with probability $1/\\ln n$. Using only this modeling assumption and first principles of probability, derive the leading-order expressions (as $x\\to\\infty$ with fixed $\\lambda$) for the expected value and the variance of the random variable $\\pi(x+y)-\\pi(x)$.\n\nYou must justify the approximations used to replace sums by integrals or by Taylor expansions at scale $y=\\lambda \\ln x$. Then, explain qualitatively how these Cramér-model predictions compare with the actual behavior established by Maier’s phenomenon for primes in short intervals of length comparable to $\\ln x$.\n\nProvide your final answer as the ordered pair consisting of the leading-order mean and variance in terms of $\\lambda$ in the form of a row matrix. Do not provide a numerical approximation.", "solution": "The problem asks for the leading-order expressions for the expected value and variance of the number of primes in a short interval $[x, x+y]$, where $y = \\lambda \\ln x$ for a large parameter $x$ and a fixed constant $\\lambda0$. This is to be done within the framework of Cramér's random model and then compared to the phenomenon described by Maier's theorem.\n\nFirst, we formalize the problem using Cramér's model. In this model, for each integer $n \\ge 2$, we associate an independent Bernoulli random variable $I_n$ such that:\n$$\nI_n = \\begin{cases} 1  \\text{if } n \\text{ is \"prime\"} \\\\ 0  \\text{if } n \\text{ is \"composite\"} \\end{cases}\n$$\nThe probability of success (i.e., of $n$ being \"prime\") is given as $p_n = P(I_n=1) = \\frac{1}{\\ln n}$. The events $\\{I_n=1\\}$ are assumed to be independent for all $n \\ge 2$.\n\nThe number of primes in the interval $[x, x+y]$ is the random variable $N$, defined as the sum of these indicator variables over the integers in the interval. For large $x$, we can consider the integers $n$ satisfying $x  n \\le x+y$.\n$$\nN = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} I_n\n$$\n\n**1. Expected Value**\n\nThe expected value of $N$, denoted $E[N]$, is found by the linearity of expectation:\n$$\nE[N] = E\\left[ \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} I_n \\right] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} E[I_n]\n$$\nThe expectation of a single Bernoulli variable $I_n$ is its success probability, $E[I_n] = p_n = \\frac{1}{\\ln n}$. Therefore,\n$$\nE[N] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n}\n$$\nTo find the leading-order behavior as $x \\to \\infty$, we must approximate this sum. The interval of summation is $[x, x+y]$, which has length $y = \\lambda \\ln x$. The number of integer terms in the sum is $\\lfloor x+y \\rfloor - \\lfloor x \\rfloor \\approx y = \\lambda \\ln x$.\n\nFor any integer $n$ in the summation range, $x  n \\le x+y$. For such $n$, the value of $\\ln n$ is close to $\\ln x$. We can make this precise. Since $x  n \\le x + \\lambda \\ln x$, we have:\n$$\n\\ln x  \\ln n \\le \\ln(x + \\lambda \\ln x) = \\ln\\left(x\\left(1 + \\frac{\\lambda \\ln x}{x}\\right)\\right) = \\ln x + \\ln\\left(1 + \\frac{\\lambda \\ln x}{x}\\right)\n$$\nAs $x \\to \\infty$, the term $\\frac{\\lambda \\ln x}{x} \\to 0$. Using the Taylor expansion $\\ln(1+u) = u + O(u^2)$ for small $u$, we get:\n$$\n\\ln n = \\ln x + O\\left(\\frac{\\ln x}{x}\\right)\n$$\nThis means that for all $n$ in the interval, $\\ln n$ is very close to $\\ln x$. The term $\\frac{1}{\\ln n}$ can be approximated by $\\frac{1}{\\ln x}$.\n$$\n\\frac{1}{\\ln n} = \\frac{1}{\\ln x + O\\left(\\frac{\\ln x}{x}\\right)} = \\frac{1}{\\ln x} \\left(1 + O\\left(\\frac{1}{x}\\right)\\right)^{-1} = \\frac{1}{\\ln x} \\left(1 - O\\left(\\frac{1}{x}\\right)\\right) = \\frac{1}{\\ln x} + O\\left(\\frac{1}{x \\ln x}\\right)\n$$\nThe dominant, or leading-order, term is $\\frac{1}{\\ln x}$. Replacing each term in the sum by this high-accuracy approximation:\n$$\nE[N] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\left(\\frac{1}{\\ln x} + O\\left(\\frac{1}{x \\ln x}\\right)\\right)\n$$\nThe number of terms in the sum is $y$ up to an additive constant of at most $1$, which is negligible. So, approximately $y = \\lambda \\ln x$ terms.\n$$\nE[N] \\approx (\\lambda \\ln x) \\cdot \\frac{1}{\\ln x} = \\lambda\n$$\nThe error term is of order $y \\cdot O\\left(\\frac{1}{x \\ln x}\\right) = (\\lambda \\ln x) \\cdot O\\left(\\frac{1}{x \\ln x}\\right) = O\\left(\\frac{\\lambda}{x}\\right)$, which vanishes as $x \\to \\infty$. Thus, the leading-order expression for the expected value is:\n$$\nE[N] \\approx \\lambda\n$$\nThis can be confirmed by approximating the sum with an integral:\n$$\nE[N] \\approx \\int_x^{x+y} \\frac{dt}{\\ln t}\n$$\nBy the Mean Value Theorem for integrals, for some $c \\in (x, x+y)$, the integral equals $(x+y-x) \\frac{1}{\\ln c} = \\frac{y}{\\ln c}$. Since $c \\sim x$ as $x \\to \\infty$, $\\ln c \\sim \\ln x$. The integral is asymptotic to $\\frac{y}{\\ln x} = \\frac{\\lambda \\ln x}{\\ln x} = \\lambda$.\n\n**2. Variance**\n\nThe variance of $N$, denoted $V[N]$, is calculated next. Since the random variables $I_n$ are independent by the model's assumption, the variance of the sum is the sum of the variances:\n$$\nV[N] = V\\left[ \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} I_n \\right] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} V[I_n]\n$$\nThe variance of a Bernoulli variable with parameter $p_n$ is $V[I_n] = p_n(1-p_n)$. So,\n$$\nV[N] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n}\\left(1 - \\frac{1}{\\ln n}\\right) = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n} - \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{(\\ln n)^2}\n$$\nThe first term is exactly the expected value $E[N]$, for which we have already established the leading-order behavior is $\\lambda$.\n$$\n\\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n} = \\lambda + O\\left(\\frac{1}{x}\\right)\n$$\nFor the second term, we use the same approximation as before: for $n$ in the interval, $\\ln n \\approx \\ln x$.\n$$\n\\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{(\\ln n)^2} \\approx (\\text{number of terms}) \\times \\frac{1}{(\\ln x)^2} \\approx y \\cdot \\frac{1}{(\\ln x)^2}\n$$\nSubstituting $y = \\lambda \\ln x$, we get:\n$$\n\\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{(\\ln n)^2} \\approx (\\lambda \\ln x) \\cdot \\frac{1}{(\\ln x)^2} = \\frac{\\lambda}{\\ln x}\n$$\nThis term tends to $0$ as $x \\to \\infty$. It is a lower-order correction.\nCombining the terms for the variance:\n$$\nV[N] \\approx \\lambda - \\frac{\\lambda}{\\ln x}\n$$\nAs $x \\to \\infty$, the term $\\frac{\\lambda}{\\ln x}$ vanishes, so the leading-order expression for the variance is:\n$$\nV[N] \\approx \\lambda\n$$\nTherefore, within Cramér's model, both the mean and the variance of the number of primes in the interval $[x, x+\\lambda \\ln x]$ are approximately $\\lambda$ for large $x$. This suggests that the distribution of primes in such an interval is well-approximated by a Poisson distribution with parameter $\\lambda$.\n\n**3. Comparison with Maier's Phenomenon**\n\nThe predictions of the Cramér model can be compared with rigorous results from number theory concerning the distribution of primes in short intervals.\n\n*   **Cramér Model Prediction**: The number of primes $N$ in $[x, x+\\lambda \\ln x]$ is a random variable with $E[N] \\approx \\lambda$ and $V[N] \\approx \\lambda$. The distribution of $N$ is approximately Poisson($\\lambda$). Standard deviations from the mean are of the order $\\sqrt{\\lambda}$, and large deviations are exponentially rare. For example, the probability of observing $2\\lambda$ primes when $\\lambda$ are expected is very small.\n\n*   **Maier's Phenomenon (Actual Behavior)**: In 1985, Helmut Maier proved a surprising result that contradicts the simple Poissonian picture. The Prime Number Theorem suggests that the number of primes in $[x, x+y]$ should be approximately $\\text{li}(x+y) - \\text{li}(x) \\approx \\frac{y}{\\ln x}$. For $y=\\lambda \\ln x$, this expected number is $\\lambda$, matching the Cramér model's mean. However, Maier showed that there are systematic, large-scale deviations from this average behavior.\n\nMaier's theorem shows that for any large constant $M  1$, there exist sequences of $x \\to \\infty$ for which the number of primes in the much longer interval $[x, x+(\\ln x)^M]$ is consistently greater than the expected number by a factor, and other sequences where it is consistently smaller. While the original theorem is stated for intervals of length $(\\ln x)^M$, the underlying principle applies to intervals of length $\\lambda \\ln x$ as well. The number of primes $\\pi(x+\\lambda\\ln x) - \\pi(x)$ can exhibit oscillations that are much larger than the $\\sqrt{\\lambda}$ fluctuations predicted by a Poisson model. For certain sequences of $x$, the count can be significantly and persistently different from $\\lambda$.\n\nThe fundamental reason for the failure of the Cramér model is its **independence assumption**. The property of an integer $n$ being prime is not independent of the primality of its neighbors. The distribution of primes is deeply connected to the arithmetic structure of integers. For instance, primality is related to divisibility by small primes. An integer is prime only if it is not divisible by any prime $p \\le \\sqrt{n}$. Maier's proof cleverly exploits the non-uniform distribution of integers that lack small prime factors. By choosing $x$ appropriately within a long arithmetic progression, one can land in regions of integers that are unusually \"favorable\" (having fewer small prime factors than average) or \"unfavorable\" for being prime, leading to clusters (more primes than expected) or voids (fewer primes than expected).\n\nIn summary, the Cramér model provides a useful first-order heuristic giving a mean count of $\\lambda$, but it fails to capture the subtle correlations in the sequence of primes. Maier's theorem demonstrates that the true variance in prime counts in short intervals is significantly larger than the variance of $\\lambda$ predicted by the Cramér model, reflecting the underlying arithmetic, non-random structure of prime numbers.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\lambda  \\lambda \\end{pmatrix}}\n$$", "id": "3084527"}]}