{"hands_on_practices": [{"introduction": "The first step in analyzing the world of quadratic forms for a given discriminant $D$ is to find a complete, unique set of representatives for the different equivalence classes. The theory of reduction provides a concrete set of inequalities that allows us to do just this. This practice ([@problem_id:3082340]) challenges you to translate these mathematical conditions into a computational algorithm, building a powerful tool that can systematically list all reduced forms for any valid negative discriminant.", "problem": "Consider a binary quadratic form $f(x,y)=ax^2+bxy+cy^2$ with integers $a$, $b$, and $c$. The discriminant of $f$ is the integer $D=b^2-4ac$. A form is called positive definite if $D0$ and $a0$. A positive definite form is called reduced if it satisfies the inequalities $|b|\\le a\\le c$ and, in the boundary cases where $|b|=a$ or $a=c$, it additionally satisfies $b\\ge 0$. As a foundational fact, the discriminant of any integral binary quadratic form satisfies $D\\equiv 0$ or $D\\equiv 1\\pmod{4}$.\n\nUsing these core definitions and facts, design and implement an algorithm that, given a negative discriminant $D0$, lists all reduced positive definite binary quadratic forms of discriminant $D$. Your algorithm must rely on the bound $a\\le \\sqrt{|D|/3}$, derived from the reduction inequalities together with $D=b^2-4ac0$, to ensure a finite search over $a$. The algorithm must:\n- Reject $D$ that do not satisfy $D\\equiv 0$ or $D\\equiv 1\\pmod{4}$ by returning an empty list for such $D$.\n- Enumerate all integer triples $(a,b,c)$ with $a0$ satisfying $D=b^2-4ac$, the strict inequality $-ab\\le a$, the inequality $a\\le c$, and the boundary sign condition that if $|b|=a$ or $a=c$ then $b\\ge 0$. Only triples that simultaneously satisfy all these conditions are to be included.\n- Use the bound $a\\le \\sqrt{|D|/3}$ to limit the $a$-search.\n- For each valid $(a,b,c)$, include the reduced form $[a,b,c]$ exactly once.\n\nYour program must evaluate the following test suite of discriminants:\n- $D_1=-3$\n- $D_2=-4$\n- $D_3=-23$\n- $D_4=-20$\n- $D_5=-15$\n- $D_6=-14$\n\nThe answer for each $D_i$ must be a list of lists of integers, each inner list representing a reduced form $[a,b,c]$. Collect the results for all test cases into a single output line. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case result in the same list format and with no spaces. For example, a valid output format is $[[[a_1,b_1,c_1],\\dots],[\\dots],\\dots]$ with no spaces anywhere in the line.", "solution": "The problem as stated is formally sound and constitutes a well-posed question within the mathematical discipline of number theory. All definitions, constraints, and objectives are provided with sufficient clarity and are internally consistent. The problem is grounded in the standard theory of binary quadratic forms, and the proposed algorithmic constraints, including the bound on the coefficient $a$, are correct deductions from the foundational principles. Therefore, I will proceed with a complete solution.\n\nThe objective is to enumerate all reduced positive definite binary quadratic forms $f(x,y) = ax^2 + bxy + cy^2$ for a given negative discriminant $D = b^2 - 4ac  0$. The coefficients $a$, $b$, and $c$ are integers.\n\nA binary quadratic form is defined as positive definite if its discriminant $D  0$ and the leading coefficient $a  0$. Such a form is considered reduced if it satisfies the inequalities $|b| \\le a \\le c$. An additional boundary condition is imposed: if $|b|=a$ or if $a=c$, then the coefficient $b$ must be non-negative, i.e., $b \\ge 0$.\n\nA fundamental property of the discriminant of any integral binary quadratic form is that it must be congruent to $0$ or $1$ modulo $4$. That is, $D \\equiv 0 \\pmod{4}$ or $D \\equiv 1 \\pmod{4}$. Any integer $D$ that does not satisfy this condition cannot be the discriminant of such a form.\n\nThe algorithm to find all reduced forms of a given discriminant $D$ leverages these definitions and properties to construct a finite search.\n\n**Algorithmic Procedure**\n\n1.  **Discriminant Validity Check:** The first step is to validate the input discriminant $D$. If $D$ does not satisfy the congruence $D \\equiv 0 \\pmod{4}$ or $D \\equiv 1 \\pmod{4}$, no integral forms of discriminant $D$ exist. In this case, the set of reduced forms is empty.\n\n2.  **Establish Search Bounds:** For a reduced positive definite form, the coefficients are constrained by the inequalities $|b| \\le a \\le c$. We can use this to derive a bound on the coefficient $a$. The discriminant is $D = b^2 - 4ac$. Since the form is positive definite, $D  0$. Let $|D| = -D$. The discriminant equation can be written as $4ac = b^2 + |D|$.\n    From the reduction conditions, we have $b^2 \\le a^2$ and $c \\ge a$. Substituting these into the discriminant relation yields:\n    $$4a^2 \\le 4ac = b^2 + |D| \\le a^2 + |D|$$\n    This implies $3a^2 \\le |D|$, which gives $a^2 \\le |D|/3$. Since $a  0$ for a positive definite form, we obtain a crucial upper bound for the search on $a$:\n    $$a \\le \\sqrt{\\frac{|D|}{3}}$$\n    This inequality guarantees that the search for the coefficient $a$ is finite.\n\n3.  **Systematic Enumeration:** The algorithm proceeds by iterating through all possible integer values for $a$ and $b$ that satisfy the reduction conditions and the derived bound.\n    - **Loop over $a$:** We iterate through all integers $a$ starting from $1$ up to $\\lfloor\\sqrt{|D|/3}\\rfloor$.\n    - **Loop over $b$:** For each value of $a$, we iterate through possible integer values of $b$. The problem statement specifies the range $-a  b \\le a$. This range is equivalent to the condition $|b| \\le a$, with the specific exclusion of $b = -a$ (for $a0$). This is correct, as the boundary condition for a reduced form states that if $|b| = a$, then $b \\ge 0$. Since $a0$, this forces $b=a$, thereby excluding $b=-a$.\n\n4.  **Determine $c$ and Verify:** For each pair $(a, b)$ found in the loops, the coefficient $c$ is determined by the discriminant formula:\n    $$4ac = b^2 - D \\implies c = \\frac{b^2 - D}{4a}$$\n    For $c$ to be an integer, the numerator $b^2 - D$ must be an integer multiple of $4a$. If this condition is met, we obtain an integer triple $(a, b, c)$.\n\n5.  **Final Reduction Checks:** This triple $(a, b, c)$ must be checked against the remaining reduction conditions:\n    - $a \\le c$: The calculated value of $c$ must be greater than or equal to $a$.\n    - **Boundary Condition:** The condition \"if $|b|=a$ or $a=c$, then $b \\ge 0$\" must be satisfied. As established, the loop for $b$ from $-a+1$ to $a$ automatically handles the case $|b|=a$. Thus, we only need to verify the condition for the case $a=c$: if $a=c$, then we must have $b \\ge 0$.\n\nAny triple $(a, b, c)$ that is generated and passes all these checks corresponds to a unique reduced positive definite binary quadratic form of discriminant $D$. The algorithm collects all such triples.\n\n**Example Walkthrough: $D = -20$**\n\n1.  **Validity:** $D = -20 \\equiv 0 \\pmod{4}$. Valid.\n2.  **Bounds:** $|D| = 20$. The search bound for $a$ is $a \\le \\sqrt{20/3} \\approx 2.58$, so we search for $a \\in \\{1, 2\\}$.\n3.  **Enumeration:**\n    - For $a=1$:\n        - We iterate $b$ in the range $-1  b \\le 1$, so $b \\in \\{0, 1\\}$.\n        - If $b=0$: $c = \\frac{0^2 - (-20)}{4(1)} = 5$. We have the triple $(1, 0, 5)$.\n            - Check: $a \\le c$ ($1 \\le 5$) is true. The boundary cases $|b|=a$ and $a=c$ do not apply. This is a reduced form.\n        - If $b=1$: $1^2 - (-20) = 21$, which is not divisible by $4a=4$. No integer $c$.\n    - For $a=2$:\n        - We iterate $b$ in the range $-2  b \\le 2$, so $b \\in \\{-1, 0, 1, 2\\}$.\n        - If $b=-1, 0, 1$: The numerator $b^2 - (-20)$ is $21, 20, 21$ respectively. None are divisible by $4a=8$. No integer $c$.\n        - If $b=2$: $c = \\frac{2^2 - (-20)}{4(2)} = \\frac{24}{8} = 3$. We have the triple $(2, 2, 3)$.\n            - Check: $a \\le c$ ($2 \\le 3$) is true. The boundary case $|b|=a$ applies ($|2|=2$). The condition $b \\ge 0$ is met ($2 \\ge 0$). This is a reduced form.\n\nThe set of reduced forms for $D=-20$ is thus $\\{[1,0,5], [2,2,3]\\}$. This procedure is applied to all test cases to generate the final output.", "answer": "```python\nimport numpy as np\n\ndef find_reduced_forms(D: int) - list[list[int]]:\n    \"\"\"\n    Calculates all reduced positive definite binary quadratic forms for a given discriminant D.\n\n    Args:\n        D: A negative integer discriminant.\n\n    Returns:\n        A list of lists, where each inner list [a, b, c] represents a\n        reduced form. Returns an empty list if D is not a valid discriminant.\n    \"\"\"\n    # Step 1: Validate the discriminant. D must be negative and congruent to 0 or 1 mod 4.\n    if D = 0 or (D % 4 != 0 and D % 4 != 1):\n        return []\n\n    reduced_forms = []\n    abs_D = -D\n    \n    # Step 2: Establish the search bound for 'a'.\n    a_max = int(np.sqrt(abs_D / 3.0))\n\n    # Step 3: Iterate through possible values of a and b.\n    # Loop over a from 1 up to the calculated max.\n    for a in range(1, a_max + 1):\n        # Loop over b from -a  b = a, which is range(-a + 1, a + 1).\n        # This range for b ensures that if |b|=a, then b=a  0, satisfying one\n        # of the boundary conditions automatically.\n        for b in range(-a + 1, a + 1):\n            \n            # Step 4: Determine c and check for integer divisibility.\n            # From D = b^2 - 4ac, we have 4ac = b^2 - D.\n            numerator = b**2 - D\n            denominator = 4 * a\n            \n            if numerator % denominator == 0:\n                c = numerator // denominator\n                \n                # Step 5: Check the remaining reduction conditions.\n                # The conditions are |b| = a = c and boundary conditions.\n                # The loops for a and b already ensure |b| = a.\n                \n                # Condition 1: a = c\n                cond1_a_le_c = (a = c)\n                \n                # Condition 2: Boundary condition check\n                # If a=c, we must have b = 0. The case |b|=a is handled by the b-loop range.\n                cond2_boundary = (a != c or b = 0)\n                \n                if cond1_a_le_c and cond2_boundary:\n                    reduced_forms.append([a, b, c])\n                        \n    return reduced_forms\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite of discriminants and\n    prints the result in the specified format.\n    \"\"\"\n    test_cases = [\n        -3,\n        -4,\n        -23,\n        -20,\n        -15,\n        -14,\n    ]\n\n    all_results = []\n    for D in test_cases:\n        result = find_reduced_forms(D)\n        all_results.append(result)\n\n    # Format the final output string as per problem specification:\n    # A single line, comma-separated, enclosed in brackets, with no spaces.\n    # Example: [[[1,1,1]],[[1,0,1]],[],...]\n    output_str = '[' + ','.join([str(res).replace(' ', '') for res in all_results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "3082340"}, {"introduction": "Once we can enumerate the reduced forms for a given discriminant, which serve as representatives for the elements of the class group, the next step is to uncover the rich algebraic structure they possess. The equivalence classes of primitive forms can be equipped with a composition law, turning them into a finite abelian group. This exercise ([@problem_id:3083509]) provides a complete pencil-and-paper tour of this structure for the discriminant $D=-20$, guiding you from finding the forms by hand to composing them and determining the order of the class group, known as the class number.", "problem": "Let a binary quadratic form be defined as a function $f(x,y)=a x^{2}+b x y+c y^{2}$ with integer coefficients $a$, $b$, and $c$. Its discriminant is $D=b^{2}-4 a c$. A form is called primitive if $\\gcd(a,b,c)=1$ and positive definite if $D0$ and $a0$. A positive definite form is said to be reduced if it satisfies the reduction inequalities $|b|\\leq a\\leq c$, and whenever $|b|=a$ or $a=c$, additionally $b\\geq 0$. Two forms are properly equivalent if one can be transformed into the other by a change of variables coming from a matrix in the special linear group of $2\\times 2$ integer matrices with determinant $1$.\n\nStarting from these definitions alone, do the following for the discriminant $D=-20$:\n1. Enumerate all reduced positive definite forms of discriminant $D=-20$ directly from the reduction inequalities and the defining condition $b^{2}-4 a c=-20$. For each candidate, verify whether it is primitive by checking $\\gcd(a,b,c)=1$.\n2. Using the classical Gauss composition of binary quadratic forms on equivalence classes with fixed discriminant, compose the nonprincipal reduced form with itself. In this composition, determine the product form $(A,B,C)$ by the method that begins with $g=\\gcd(a,a',(b+b')/2)$, sets $A=\\frac{a a'}{g^{2}}$, and then chooses $B$ to satisfy the congruences $B\\equiv b \\pmod{2 a}$ and $B\\equiv b' \\pmod{2 a'}$ in a manner consistent with $B$ being defined modulo $2 A$, finally determining $C$ from the discriminant condition $B^{2}-4 A C=D$.\n3. From your composition result, deduce the order of the nonprincipal class and determine the class number $h(-20)$, defined as the number of proper equivalence classes of primitive positive definite binary quadratic forms of discriminant $-20$.\n\nExpress your final answer as a single integer equal to $h(-20)$.", "solution": "The problem asks for a three-part analysis of binary quadratic forms of discriminant $D=-20$, culminating in the determination of the class number $h(-20)$. We will validate the problem and then proceed with the solution.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- Binary quadratic form: $f(x,y)=a x^{2}+b x y+c y^{2}$ with integer coefficients $a$, $b$, $c$.\n- Discriminant: $D=b^{2}-4 a c$.\n- Primitive form: $\\gcd(a,b,c)=1$.\n- Positive definite form: $D0$ and $a0$.\n- Reduced form: $|b|\\leq a\\leq c$, and if $|b|=a$ or $a=c$, then $b\\geq 0$.\n- Proper equivalence: Transformation by a matrix in $SL_2(\\mathbb{Z})$.\n- Specific discriminant for the problem: $D=-20$.\n- Task 1: Enumerate all reduced positive definite primitive forms for $D=-20$.\n- Task 2: Compose the nonprincipal form with itself using the specified Gauss composition method. The method is described as: $g=\\gcd(a,a',(b+b')/2)$, $A=\\frac{a a'}{g^{2}}$, $B$ is found via congruences $B\\equiv b \\pmod{2 a}$ and $B\\equiv b' \\pmod{2 a'}$, and $C$ is found via $B^2 - 4AC = D$.\n- Task 3: Deduce the order of the nonprincipal class and determine the class number $h(-20)$.\n- Final Answer: The integer value of $h(-20)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in classical number theory, specifically the theory of binary quadratic forms established by Gauss. All definitions, including those for primitive, positive definite, and reduced forms, are standard and correct. The problem is well-posed, as the reduction procedure for positive definite forms guarantees a unique reduced representative for each equivalence class. The task is objective and formalizable, requiring direct calculation based on the provided definitions and algorithm. There are no contradictions, missing pieces of information, or ambiguities that would prevent a unique solution. The described composition algorithm, while a specific instance of a more general method, is computationally well-defined for the task at hand. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n### Solution\n\n**Part 1: Enumeration of Reduced Forms**\nWe seek to find all integer triples $(a,b,c)$ that satisfy the given conditions for a reduced, primitive, positive definite form of discriminant $D=-20$.\nThe conditions are:\n1. $b^2 - 4ac = -20$, which implies $4ac = b^2 + 20$.\n2. $a  0$.\n3. $|b| \\leq a \\leq c$.\n4. If $|b|=a$ or $a=c$, then $b \\geq 0$.\n5. $\\gcd(a,b,c)=1$.\n\nFrom condition $3$, we have $|b| \\leq a$ and $a \\leq c$.\nSubstituting $a \\leq c$ into the discriminant equation gives $4a^2 \\leq 4ac = b^2 + 20$.\nAlso, $|b| \\leq a$ implies $b^2 \\leq a^2$.\nCombining these inequalities, we get $4a^2 \\leq b^2 + 20 \\leq a^2 + 20$.\nThis leads to the inequality $3a^2 \\leq 20$, which means $a^2 \\leq \\frac{20}{3} \\approx 6.67$.\nSince $a$ must be a positive integer, the only possible values for $a$ are $1$ and $2$.\n\nCase 1: $a=1$.\nThe reduction condition $|b| \\leq a$ implies $|b| \\leq 1$, so $b \\in \\{-1, 0, 1\\}$.\n- If $b=0$: The equation $4ac = b^2 + 20$ becomes $4(1)c = 0^2 + 20$, so $4c=20$, which gives $c=5$. We have the form $(1, 0, 5)$.\n  - Check reduction: $|b|=0 \\leq a=1 \\leq c=5$. The condition $a \\leq c$ is satisfied. The special conditions for $|b|=a$ or $a=c$ do not apply. The form is reduced.\n  - Check primitivity: $\\gcd(1, 0, 5) = 1$. The form is primitive.\n  - Thus, $x^2+5y^2$ is a valid form. This is the principal form.\n\n- If $b=1$: The equation is $4(1)c = 1^2 + 20$, so $4c=21$. This does not yield an integer value for $c$, so no form exists.\n- If $b=-1$: The reduction condition $|b|=1 \\leq a=1$ is satisfied. However, since $|b|=a$, we must have $b \\geq 0$. As $b=-1  0$, this form is not reduced.\n\nCase 2: $a=2$.\nThe reduction condition $|b| \\leq a$ implies $|b| \\leq 2$, so $b \\in \\{-2, -1, 0, 1, 2\\}$.\nThe discriminant equation is $4(2)c = b^2+20$, which is $8c = b^2+20$. For $c$ to be an integer, $b^2+20$ must be divisible by $8$.\n- If $b=0$, $8c=20$, no integer solution for $c$.\n- If $b=\\pm 1$, $8c=21$, no integer solution for $c$.\n- If $b=\\pm 2$, $8c = (\\pm 2)^2+20 = 24$, which gives $c=3$.\n  - Consider the potential form $(2, 2, 3)$ from $b=2$:\n    - Check reduction: $|b|=2 \\leq a=2 \\leq c=3$. The condition $|b|\\leq a \\leq c$ holds. Since $|b|=a=2$, we must check that $b \\geq 0$. As $b=2 \\geq 0$, the form is reduced.\n    - Check primitivity: $\\gcd(2, 2, 3) = 1$. The form is primitive.\n    - Thus, $2x^2+2xy+3y^2$ is a valid form.\n  - Consider the potential form $(2, -2, 3)$ from $b=-2$:\n    - Check reduction: $|b|=2 \\leq a=2 \\leq c=3$ holds. However, since $|b|=a=2$, we must have $b\\geq 0$. As $b=-2  0$, this form is not reduced.\n\nIn summary, there are exactly two reduced, primitive, positive definite forms of discriminant $D=-20$:\n1. $(1, 0, 5)$\n2. $(2, 2, 3)$\n\n**Part 2: Gauss Composition**\nThe principal form, representing the identity element of the class group, is $(1, 0, 5)$. The nonprincipal form is $(2, 2, 3)$. We are asked to compose the nonprincipal form with itself.\nLet the forms to be composed be $f_1 = (a_1, b_1, c_1) = (2, 2, 3)$ and $f_2 = (a_2, b_2, c_2) = (2, 2, 3)$. We use the specified algorithm.\n\n1. Calculate $g$:\n$g = \\gcd(a_1, a_2, (b_1+b_2)/2) = \\gcd(2, 2, (2+2)/2) = \\gcd(2, 2, 2) = 2$.\n\n2. Calculate $A$:\n$A = \\frac{a_1 a_2}{g^2} = \\frac{2 \\times 2}{2^2} = \\frac{4}{4} = 1$.\n\n3. Determine $B$:\nThe problem states that $B$ must satisfy the congruences $B \\equiv b_1 \\pmod{2 a_1}$ and $B \\equiv b_2 \\pmod{2 a_2}$.\n$B \\equiv 2 \\pmod{2 \\times 2} \\implies B \\equiv 2 \\pmod{4}$.\n$B \\equiv 2 \\pmod{2 \\times 2} \\implies B \\equiv 2 \\pmod{4}$.\nThese congruences imply $B$ must be of the form $4k+2$ for some integer $k$. The problem also states this choice must be consistent with \"$B$ being defined modulo $2A$\". Here, $2A = 2(1)=2$. Any number of the form $4k+2$ is even, so $B \\equiv 0 \\pmod{2}$, which is a single value modulo $2$. This is consistent.\n\n4. Calculate $C$:\nThe third coefficient $C$ is determined by the discriminant condition: $B^2 - 4AC = D$.\n$B^2 - 4(1)C = -20 \\implies 4C = B^2 + 20$.\nSubstituting $B=4k+2$:\n$4C = (4k+2)^2 + 20 = 16k^2 + 16k + 4 + 20 = 16k^2+16k+24$.\n$C = 4k^2 + 4k + 6$.\nThe resulting form is $(A, B, C) = (1, 4k+2, 4k^2+4k+6)$. All such forms for different integer values of $k$ belong to the same proper equivalence class. Let's choose the simplest case, $k=0$, which gives $B=2$ and $C=6$.\nThe product form is $(1, 2, 6)$.\n\n5. Reduce the product form:\nThe form $(1, 2, 6)$ is not reduced because $|b|=2  a=1$. We must apply the reduction algorithm. We use an $SL_2(\\mathbb{Z})$ transformation of the type $\\begin{pmatrix} 1  m \\\\ 0  1 \\end{pmatrix}$, which transforms a form $(a,b,c)$ into $(a, b+2am, am^2+bm+c)$.\nWe have $(a,b,c)=(1,2,6)$. We want to choose an integer $m$ to minimize $|b+2am| = |2+2(1)m| = |2+2m|$. Choosing $m=-1$ gives the new middle coefficient $b' = 2+2(-1)=0$.\nThe new form $(a', b', c')$ has:\n$a' = a = 1$.\n$b' = b+2am = 0$.\n$c' = am^2+bm+c = 1(-1)^2 + 2(-1) + 6 = 1-2+6 = 5$.\nThe reduced form is $(1, 0, 5)$.\n\nThe composition of the class of $(2, 2, 3)$ with itself yields the class of $(1, 0, 5)$.\n\n**Part 3: Order and Class Number**\nLet $[f]$ denote the equivalence class of a form $f$. The set of equivalence classes forms a finite abelian group under composition, called the class group. The order of this group is the class number, $h(D)$. The class of the principal form, $[(1,0,5)]$, is the identity element of the group.\nFrom Part 2, we found that the composition of the class of the nonprincipal form $[(2, 2, 3)]$ with itself results in the identity class:\n$$[(2, 2, 3)] \\circ [(2, 2, 3)] = [(1, 0, 5)]$$\nThis means that the class $[(2, 2, 3)]$ is an element of order $2$ in the class group.\nIn Part 1, we found that there are exactly two equivalence classes of primitive, positive definite forms of discriminant $D=-20$, represented by the reduced forms $(1, 0, 5)$ and $(2, 2, 3)$.\nThe class number, $h(-20)$, is by definition the number of such classes.\nTherefore, the class number is $h(-20)=2$. The class group is a group of order $2$, isomorphic to $\\mathbb{Z}/2\\mathbb{Z}$, with elements being the identity class $[(1,0,5)]$ and the order-$2$ class $[(2,2,3)]$. This is consistent with our composition result.\n\nThe final answer requested is the value of $h(-20)$.\n$h(-20) = 2$.", "answer": "$$\\boxed{2}$$", "id": "3083509"}, {"introduction": "The classification of quadratic forms is not merely an abstract sorting exercise; it has profound consequences for one of number theory's central questions: which integers can be represented by a given form $f(x,y)$? A cornerstone of the theory is that forms belonging to different equivalence classes represent fundamentally different sets of numbers. This computational practice ([@problem_id:3082328]) makes this abstract principle tangible by having you compare the integers represented by two non-equivalent forms, providing striking numerical evidence for the power and purpose of the classification.", "problem": "Let $f(x,y)=ax^{2}+bxy+cy^{2}$ be a primitive positive definite binary quadratic form with integer coefficients $a$, $b$, and $c$. The discriminant is $D=b^{2}-4ac$. Two forms are properly equivalent if one can be obtained from the other by an element of the special linear group $\\mathrm{SL}_{2}(\\mathbb{Z})$ acting on the variables. A positive definite form is called reduced if it satisfies the inequalities $|b|\\le a\\le c$, and if either $|b|=a$ or $a=c$ then $b\\ge 0$. The principal form is the unique reduced form in the principal class (the identity element of the class group). A positive integer $n$ is said to be properly represented by $f$ if there exist integers $x$ and $y$ with $\\gcd(x,y)=1$ and $f(x,y)=n$. In this problem, work with discriminant $D=-20$.\n\nStarting from the core definitions above (binary quadratic form, discriminant, proper equivalence, reduced form, and proper representation), carry out the following:\n\n1. Determine all reduced primitive positive definite forms of discriminant $D=-20$, and identify the principal form among them.\n\n2. For the principal form $f_{1}$ and for one other reduced form $f_{2}$ of the same discriminant, compute, for each bound $N\\in\\{30,50,100\\}$, the following sets of positive integers:\n   - $S_{1}(N)=\\{\\,n\\in\\mathbb{Z}_{0}\\mid n\\le N,\\ \\exists x,y\\in\\mathbb{Z},\\ \\gcd(x,y)=1,\\ f_{1}(x,y)=n\\,\\}$.\n   - $S_{2}(N)=\\{\\,n\\in\\mathbb{Z}_{0}\\mid n\\le N,\\ \\exists x,y\\in\\mathbb{Z},\\ \\gcd(x,y)=1,\\ f_{2}(x,y)=n\\,\\}$.\n   - $I(N)=S_{1}(N)\\cap S_{2}(N)$.\n   - $A_{1}(N)=S_{1}(N)\\setminus S_{2}(N)$.\n   - $A_{2}(N)=S_{2}(N)\\setminus S_{1}(N)$.\n\n3. Your program must compute these sets using only first-principles logic derived from the definitions. Specifically, use the positivity of the form and the inequality $f(x,y)\\le N$ to bound the integer search over $(x,y)$. You may use the fact that for fixed $y$, the values of $x$ satisfying $f(x,y)\\le N$ solve a quadratic inequality in $x$, and that for fixed $y$ the minimum of $f(x,y)$ as a function of $x$ occurs at $x=-\\frac{by}{2a}$ with value $\\frac{-D}{4a}\\,y^{2}$, to deduce a bound on $|y|$. No other prepackaged results about representation are allowed.\n\n4. Test suite and required outputs:\n   - Use the two reduced forms you found in step $1$ and take the principal form as $f_{1}$ and the other reduced form as $f_{2}$.\n   - Use the bounds $N=30$, $N=50$, and $N=100$.\n   - For $N=30$ and $N=50$, output summaries consisting of integer counts in the order `[ |S1(N)|, |S2(N)|, |I(N)|, |A1(N)|, |A2(N)| ]`.\n   - For $N=100$, output the detailed sorted lists in the order `[ S1(100), S2(100), I(100), A1(100), A2(100) ]`.\n   - Final output format: Your program should produce a single line of output containing a list of three items, namely the two count summaries for $N=30$ and $N=50$, followed by the detailed lists for $N=100$. Precisely, the line must be of the form `[ [counts_for_N=30], [counts_for_N=50], [lists_for_N=100] ]`.\n   There are no physical units or angles involved.\n\nYour final answer must be a complete, runnable program as specified below that prints exactly one line in the format described above. The answers must be expressed as integers or lists of integers as indicated, with each list sorted in increasing order and without duplicates.", "solution": "We begin from the definitions of a binary quadratic form, discriminant, reduced form, and proper representation. Let $f(x,y)=ax^{2}+bxy+cy^{2}$ be a primitive positive definite form, so $a0$, $c0$, and $D=b^{2}-4ac0$. The reduced condition for $D0$ is $|b|\\le a\\le c$ and, if either $|b|=a$ or $a=c$, then $b\\ge 0$. Proper representation of a positive integer $n$ by $f$ means there exist integers $x$ and $y$ with $\\gcd(x,y)=1$ such that $f(x,y)=n$.\n\nStep $1$: Find reduced forms of discriminant $D=-20$ and identify the principal form.\n\nWe solve $b^{2}-4ac=-20$ under the reduced constraints. Because $D\\equiv 0\\pmod{4}$, the coefficient $b$ must be even. We inspect small even $b$ and integer pairs $(a,c)$.\n\n- Case $b=0$: Then $-4ac=-20$, hence $ac=5$. With $a\\le c$ and $a0$, we obtain $(a,c)=(1,5)$. The form is $(a,b,c)=(1,0,5)$. It satisfies $|b|=0\\le a=1\\le c=5$ and is reduced. This is the principal form, because it has $a=1$ in the reduced list.\n\n- Case $b=\\pm 2$: Then $4-4ac=-20$, hence $4ac=24$ and $ac=6$. Considering $a\\le c$ and $|b|\\le a$, we take $(a,c)=(2,3)$. The reduced condition when $|b|=a$ requires $b\\ge 0$, hence $(a,b,c)=(2,2,3)$ is reduced and primitive.\n\n- Case $|b|\\ge 4$: For $b=\\pm 4$, we get $16-4ac=-20$, hence $ac=9$. The constraint $|b|\\le a$ forces $a\\ge 4$, but the factorization $ac=9$ with $a\\le c$ gives no solution with $a\\ge 4$. Larger $|b|$ give no solutions with $a\\le c$.\n\nTherefore, the reduced primitive positive definite forms of discriminant $D=-20$ are exactly $(1,0,5)$ and $(2,2,3)$, of which $(1,0,5)$ is the principal form.\n\nStep $2$: Represented sets up to a bound $N$ for two forms.\n\nLet $f_{1}(x,y)=x^{2}+5y^{2}$ and $f_{2}(x,y)=2x^{2}+2xy+3y^{2}$. For a given $N$, we define\n- $S_{1}(N)=\\{\\,n\\le N:\\exists x,y\\in\\mathbb{Z},\\ \\gcd(x,y)=1,\\ f_{1}(x,y)=n\\,\\}$,\n- $S_{2}(N)=\\{\\,n\\le N:\\exists x,y\\in\\mathbb{Z},\\ \\gcd(x,y)=1,\\ f_{2}(x,y)=n\\,\\}$,\nand the comparison sets $I(N)=S_{1}(N)\\cap S_{2}(N)$, $A_{1}(N)=S_{1}(N)\\setminus S_{2}(N)$, $A_{2}(N)=S_{2}(N)\\setminus S_{1}(N)$.\n\nStep $3$: Algorithm derived from first principles.\n\nFor fixed $y$, the form $f(x,y)$ is a quadratic function of $x$. The inequality $f(x,y)\\le N$ constrains $x$ to lie between the real roots of $ax^{2}+bxy+cy^{2}-N\\le 0$, provided the discriminant in $x$ is nonnegative. The discriminant in $x$ is\n$$\n\\Delta_{x}(y)=b^{2}y^{2}-4a(cy^{2}-N)=-Dy^{2}+4aN0,\n$$\nsince $D0$. Therefore, the allowed integer $x$ satisfy\n$$\n\\frac{-by-\\sqrt{\\Delta_{x}(y)}}{2a}\\le x\\le \\frac{-by+\\sqrt{\\Delta_{x}(y)}}{2a}.\n$$\nBecause $x$ must be an integer, it suffices to use the integer bound with $\\lfloor \\sqrt{\\Delta_{x}(y)}\\rfloor$, which is exact at the integer level:\n$$\nx_{\\min}(y)=\\left\\lceil\\frac{-by-\\lfloor\\sqrt{\\Delta_{x}(y)}\\rfloor}{2a}\\right\\rceil,\\quad\nx_{\\max}(y)=\\left\\lfloor\\frac{-by+\\lfloor\\sqrt{\\Delta_{x}(y)}\\rfloor}{2a}\\right\\rfloor.\n$$\nFor fixed $y$, the minimal value of $f(x,y)$ as a function of $x$ occurs at $x^{*}=-\\frac{by}{2a}$ and equals\n$$\nf_{\\min}(y)=\\left(c-\\frac{b^{2}}{4a}\\right)y^{2}=\\frac{4ac-b^{2}}{4a}\\,y^{2}=\\frac{-D}{4a}\\,y^{2}.\n$$\nHence $f(x,y)\\le N$ for some $x$ implies $f_{\\min}(y)\\le N$, so\n$$\n|y|\\le \\sqrt{\\frac{4aN}{-D}}.\n$$\nThis yields a complete and finite search over $y$, and for each such $y$ a finite search over integer $x\\in[x_{\\min}(y),x_{\\max}(y)]$. For each integer pair $(x,y)$ encountered, we check $\\gcd(x,y)=1$ and $1\\le f(x,y)\\le N$, and collect $f(x,y)$ into a set. Finally we sort the resulting set.\n\nStep $4$: Applying to $D=-20$.\n\nWe take $f_{1}(x,y)=x^{2}+5y^{2}$ and $f_{2}(x,y)=2x^{2}+2xy+3y^{2}$. For each $N\\in\\{30,50,100\\}$, we compute $S_{1}(N)$ and $S_{2}(N)$ by the algorithm above, then form $I(N)$, $A_{1}(N)$, and $A_{2}(N)$, and produce the outputs in the required format.\n\nThe program implements exactly the bounding strategy derived above, including the bound $|y|\\le \\left\\lfloor \\sqrt{\\frac{4aN}{-D}}\\right\\rfloor$ and the integer interval for $x$ using $\\lfloor\\sqrt{\\Delta_{x}(y)}\\rfloor$. It then returns:\n- For $N=30$: $[\\,|S_{1}(30)|,\\ |S_{2}(30)|,\\ |I(30)|,\\ |A_{1}(30)|,\\ |A_{2}(30)|\\,]$.\n- For $N=50$: $[\\,|S_{1}(50)|,\\ |S_{2}(50)|,\\ |I(50)|,\\ |A_{1}(50)|,\\ |A_{2}(50)|\\,]$.\n- For $N=100$: $[\\,S_{1}(100),\\ S_{2}(100),\\ I(100),\\ A_{1}(100),\\ A_{2}(100)\\,]$ with each list sorted.\n\nBy direct computation (which the program performs), the reduced forms are $f_{1}(x,y)=x^{2}+5y^{2}$ (principal) and $f_{2}(x,y)=2x^{2}+2xy+3y^{2}$, and the resulting sets up to $N=100$ are disjoint with\n$$\nS_{1}(100)=\\{1,5,6,9,14,21,29,30,41,45,46,49,54,61,69,70,81,86,89,94\\},\n$$\n$$\nS_{2}(100)=\\{2,3,7,10,15,18,23,27,35,42,43,47,58,63,67,82,83,87,90,98\\}.\n$$\nThus $I(100)=\\varnothing$, $A_{1}(100)=S_{1}(100)$, and $A_{2}(100)=S_{2}(100)$. For $N=30$ and $N=50$, the corresponding counts computed by the same method are\n$$\n[\\,8,8,0,8,8\\,]\\ \\text{for}\\ N=30,\\quad [\\,12,12,0,12,12\\,]\\ \\text{for}\\ N=50.\n$$\nThe program prints these in the exact single-line format requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport math\nfrom typing import List, Tuple, Set\n\ndef integer_sqrt(n: int) - int:\n    \"\"\"Return floor(sqrt(n)) for n = 0.\"\"\"\n    if n  0:\n        raise ValueError(\"integer_sqrt domain error\")\n    return int(math.isqrt(n))\n\ndef ceil_div(a: int, b: int) - int:\n    \"\"\"Return ceil(a/b) for integers, b != 0.\"\"\"\n    if b == 0:\n        raise ZeroDivisionError(\"division by zero\")\n    # Python's // is floor division; use identity ceil(a/b) = -floor((-a)/b)\n    return -(-a // b)\n\ndef reduced_forms_discriminant_neg(D: int) - List[Tuple[int,int,int]]:\n    \"\"\"\n    Enumerate reduced primitive positive definite binary quadratic forms (a,b,c)\n    of negative discriminant D (0), satisfying |b| = a = c and if |b|=a or a=c then b = 0.\n    Restrict to primitive forms gcd(a,b,c)=1.\n    \"\"\"\n    if D = 0:\n        raise ValueError(\"D must be negative\")\n    forms = []\n    # Standard bound for a in reduced positive definite case: 1 = a = sqrt(|D|/3)\n    a_max = int(math.floor(math.sqrt(abs(D) / 3))) + 5  # generous bound\n    for a in range(1, a_max + 1):\n        # b congruence: D == b^2 mod 4 implies b has parity of D\n        # For D even, b even; for D odd, b odd.\n        b_parity = D  1  # 0 if even, 1 if odd\n        # b ranges from -a to a\n        for b in range(-a, a + 1):\n            if (b  1) != b_parity:\n                continue\n            # compute c from discriminant equation: b^2 - 4ac = D - c = (b^2 - D) / (4a)\n            numer = b*b - D\n            denom = 4 * a\n            if numer % denom != 0:\n                continue\n            c = numer // denom\n            if a  c:\n                continue\n            # positive definite requires a  0 and c  0\n            if c = 0:\n                continue\n            # reduced tie-breaker: if |b| = a or a = c, then b = 0\n            if (abs(b) == a or a == c) and b  0:\n                continue\n            # primitive:\n            if math.gcd(a, math.gcd(b, c)) != 1:\n                continue\n            # verify discriminant exactly\n            if b*b - 4*a*c != D:\n                continue\n            forms.append((a,b,c))\n    # Sort canonically: by a, then by b, then by c\n    forms.sort()\n    return forms\n\ndef represented_set_up_to_N(a: int, b: int, c: int, D: int, N: int, proper: bool = True) - List[int]:\n    \"\"\"\n    Compute sorted list of positive integers n = N that are (properly) represented by f(x,y) = a x^2 + b x y + c y^2\n    with discriminant D = b^2 - 4ac (0). Proper means gcd(x,y)=1.\n    \"\"\"\n    if D != b*b - 4*a*c:\n        raise ValueError(\"Inconsistent discriminant\")\n    if N  1:\n        return []\n    # Bound on y from f_min(y) = (-D/(4a)) y^2 = N\n    # So |y| = sqrt(4 a N / (-D))\n    y_bound_sq = (4 * a * N) // (-D) if D  0 else 0\n    y_bound = int(math.floor(math.sqrt(y_bound_sq)))\n    represented: Set[int] = set()\n    two_a = 2 * a\n    for y in range(-y_bound, y_bound + 1):\n        # Discriminant in x for inequality f(x,y) = N\n        delta_x = -D * (y * y) + 4 * a * N  # guaranteed nonnegative\n        k = integer_sqrt(delta_x)\n        qmin = -b * y - k\n        qmax = -b * y + k\n        x_min = ceil_div(qmin, two_a)\n        x_max = qmax // two_a  # floor division\n        for x in range(x_min, x_max + 1):\n            if proper and math.gcd(x, y) != 1:\n                continue\n            n = a * x * x + b * x * y + c * y * y\n            if 1 = n = N:\n                represented.add(n)\n    return sorted(represented)\n\ndef solve():\n    # Discriminant and forms\n    D = -20\n    forms = reduced_forms_discriminant_neg(D)\n    # Identify principal form: the reduced form with a=1\n    principal_forms = [f for f in forms if f[0] == 1]\n    if not principal_forms:\n        raise RuntimeError(\"Principal form not found\")\n    f1 = principal_forms[0]  # principal: (1,0,5)\n    # Choose another reduced form distinct from principal\n    others = [f for f in forms if f != f1]\n    if not others:\n        raise RuntimeError(\"No other reduced form found\")\n    f2 = others[0]  # e.g., (2,2,3)\n\n    # Test suite bounds\n    test_Ns = [30, 50, 100]\n\n    results = []\n    for N in test_Ns:\n        S1 = represented_set_up_to_N(f1[0], f1[1], f1[2], D, N, proper=True)\n        S2 = represented_set_up_to_N(f2[0], f2[1], f2[2], D, N, proper=True)\n        set_S1 = set(S1)\n        set_S2 = set(S2)\n        I = sorted(set_S1.intersection(set_S2))\n        A1 = sorted(set_S1.difference(set_S2))\n        A2 = sorted(set_S2.difference(set_S1))\n        if N in (30, 50):\n            # summary counts\n            results.append([len(S1), len(S2), len(I), len(A1), len(A2)])\n        else:\n            # detailed lists for N=100\n            results.append([S1, S2, I, A1, A2])\n\n    # Final print statement in the exact required format.\n    print(str(results).replace(\" \", \"\"))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3082328"}]}