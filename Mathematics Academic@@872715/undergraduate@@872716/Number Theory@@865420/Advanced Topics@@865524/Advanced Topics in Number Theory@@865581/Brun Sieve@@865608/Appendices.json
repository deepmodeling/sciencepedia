{"hands_on_practices": [{"introduction": "The power of any sieve method lies in its ability to translate a complex counting problem into a series of local conditions at each prime. The Brun sieve is no exception, and its fundamental building block is the function $g(p)$, which counts the number of \"forbidden\" residue classes modulo a prime $p$. This first exercise [@problem_id:3082606] will guide you through calculating $g(p)$ for both a simple, one-dimensional sieve and a more complex scenario involving two linear forms, helping you build intuition for how the structure of a problem directly influences the sieve's local parameters.", "problem": "Consider the set of integers $\\mathcal{A}=\\{1,2,\\dots,x\\}$ and let $\\mathcal{P}$ be a set of primes. In Brun's sieve, one assigns to each prime $p\\in\\mathcal{P}$ a local count function $g(p)$, defined to be the number of residue classes modulo $p$ that are removed by the sifting condition at $p$. Work in the following two scenarios and determine the exact form of $g(p)$ in each.\n\n(a) One-dimensional sieve. The sifting condition removes precisely those $a\\in\\mathcal{A}$ such that $p\\mid a$ for some $p\\in\\mathcal{P}$. Using only the definition of $g(p)$ as the number of residue classes modulo $p$ eliminated by the condition, compute $g(p)$ for this one-dimensional sieve.\n\n(b) Two-dimensional sieve with two linear forms. Let $L_{1}(n)=2n+1$ and $L_{2}(n)=3n+1$. The sifting condition removes those $n\\in\\mathcal{A}$ for which there exists $p\\in\\mathcal{P}$ with $p\\mid L_{1}(n)L_{2}(n)$. Using the same definition of $g(p)$, compute $g(p)$ for this two-dimensional sieve by counting the number of residue classes modulo $p$ for which $L_{1}(n)L_{2}(n)\\equiv 0\\pmod{p}$. Treat the special primes where one of the linear forms is identically nonzero modulo $p$ carefully, and present your final $g(p)$ as a single closed-form analytic expression in $p$ that covers all primes.\n\nYour final answer must consist of the two expressions for $g(p)$, for parts (a) and (b), arranged as a row matrix using the $\\pmatrix$ environment. No rounding is required.", "solution": "The problem requires the determination of the local count function $g(p)$ for two different sieving scenarios. The function $g(p)$ represents the number of residue classes modulo a prime $p$ that are sifted out. I will address each scenario sequentially.\n\n(a) One-dimensional sieve\n\nThe sifting condition removes any integer $a$ from the set $\\mathcal{A}=\\{1, 2, \\dots, x\\}$ if $p \\mid a$ for some prime $p$ in the set of sifting primes $\\mathcal{P}$. We are tasked with finding $g(p)$ for a given prime $p \\in \\mathcal{P}$.\n\nBy definition, $g(p)$ is the number of residue classes modulo $p$ that satisfy the sifting condition. The condition, when applied for the prime $p$, is that an integer $a$ is removed if it is a multiple of $p$. In the language of modular arithmetic, this corresponds to the congruence:\n$$a \\equiv 0 \\pmod{p}$$\nThe set of residue classes modulo $p$ is $\\mathbb{Z}_p = \\{0, 1, 2, \\dots, p-1\\}$. We need to count how many of these classes satisfy the congruence $a \\equiv 0 \\pmod{p}$.\nThere is precisely one such residue class: the class of $0$.\nTherefore, for any prime $p$, the number of sifted residue classes is $1$.\nThe local count function for this one-dimensional sieve is:\n$$g(p) = 1$$\n\n(b) Two-dimensional sieve with two linear forms\n\nThe sifting is performed on an index set $\\{1, 2, \\dots, x\\}$. The condition for removing an index $n$ is that there exists a prime $p \\in \\mathcal{P}$ such that $p$ divides the product of two linear forms, $L_1(n) = 2n+1$ and $L_2(n) = 3n+1$.\n\nFor a specific prime $p$, $g(p)$ is the number of residue classes $n \\pmod{p}$ for which $L_1(n)L_2(n)$ is divisible by $p$. This can be expressed as the congruence:\n$$(2n+1)(3n+1) \\equiv 0 \\pmod{p}$$\nSince $p$ is a prime, the ring of integers modulo $p$, denoted $\\mathbb{Z}_p$, is an integral domain. Thus, the product is congruent to $0$ if and only if at least one of the factors is congruent to $0$. The condition is equivalent to:\n$$2n+1 \\equiv 0 \\pmod{p} \\quad \\text{or} \\quad 3n+1 \\equiv 0 \\pmod{p}$$\nThe value of $g(p)$ is the number of distinct solutions for $n$ in $\\mathbb{Z}_p = \\{0, 1, \\dots, p-1\\}$. By the principle of inclusion-exclusion, the number of solutions is the sum of the number of solutions to each individual congruence minus the number of solutions common to both.\n\nLet's analyze the number of solutions for each congruence.\n\nFirst congruence: $2n+1 \\equiv 0 \\pmod{p}$, or $2n \\equiv -1 \\pmod{p}$.\n- If $p=2$, the congruence becomes $2n \\equiv -1 \\pmod{2}$, which simplifies to $0 \\equiv 1 \\pmod{2}$. This is a contradiction, so there are $0$ solutions.\n- If $p \\neq 2$, the coefficient $2$ is invertible modulo $p$. The congruence has a unique solution given by $n \\equiv -(2^{-1}) \\pmod{p}$.\nThe number of solutions for this first congruence is $1$ if $p \\neq 2$ and $0$ if $p = 2$. This can be written compactly using the Kronecker delta, $\\delta_{i,j}$, which is $1$ if $i=j$ and $0$ otherwise. The number of solutions is $1 - \\delta_{p,2}$.\n\nSecond congruence: $3n+1 \\equiv 0 \\pmod{p}$, or $3n \\equiv -1 \\pmod{p}$.\n- If $p=3$, the congruence becomes $3n \\equiv -1 \\pmod{3}$, which simplifies to $0 \\equiv 2 \\pmod{3}$. This is a contradiction, so there are $0$ solutions.\n- If $p \\neq 3$, the coefficient $3$ is invertible modulo $p$. The congruence has a unique solution given by $n \\equiv -(3^{-1}) \\pmod{p}$.\nThe number of solutions for this second congruence is $1$ if $p \\neq 3$ and $0$ if $p = 3$. This can be written as $1 - \\delta_{p,3}$.\n\nCommon solutions: We must check if the two congruences can have a common solution for some $n$. A common solution exists only if both congruences are simultaneously solvable, which requires $p \\neq 2$ and $p \\neq 3$. If a common solution exists, it must satisfy $n \\equiv -(2^{-1}) \\pmod{p}$ and $n \\equiv -(3^{-1}) \\pmod{p}$. This implies:\n$$-(2^{-1}) \\equiv -(3^{-1}) \\pmod{p}$$\n$$2^{-1} \\equiv 3^{-1} \\pmod{p}$$\nMultiplying both sides by $6$ (which is invertible since $p \\neq 2, 3$) yields:\n$$3 \\equiv 2 \\pmod{p}$$\nThis implies $1 \\equiv 0 \\pmod{p}$, which is equivalent to $p \\mid 1$. This is impossible for any prime $p$. Therefore, the two congruences never have a common solution. The number of common solutions is always $0$.\n\nThe total number of sifted residue classes, $g(p)$, is the sum of the number of solutions to each congruence:\n$$g(p) = (1 - \\delta_{p,2}) + (1 - \\delta_{p,3}) = 2 - \\delta_{p,2} - \\delta_{p,3}$$\nThis single expression is valid for all primes $p$:\n- If $p=2$, $g(2) = 2 - \\delta_{2,2} - \\delta_{2,3} = 2 - 1 - 0 = 1$.\n- If $p=3$, $g(3) = 2 - \\delta_{3,2} - \\delta_{3,3} = 2 - 0 - 1 = 1$.\n- If $p$ is a prime other than $2$ or $3$, $g(p) = 2 - \\delta_{p,2} - \\delta_{p,3} = 2 - 0 - 0 = 2$.\n\nThis is consistent with our analysis: for $p > 3$, both linear congruences have a unique and distinct solution, yielding $2$ removed classes. For $p=2$ and $p=3$, one of the linear forms becomes a constant which is non-zero modulo $p$, thus providing no solutions from that factor, while the other factor provides exactly one solution.", "answer": "$$\\boxed{\\begin{pmatrix} 1  2 - \\delta_{p,2} - \\delta_{p,3} \\end{pmatrix}}$$", "id": "3082606"}, {"introduction": "Now that we have a general understanding of the parameter $g(p)$, let's apply it to one of the most famous problems in number theory: the twin prime conjecture. When sieving for twin primes, we remove integers $n$ where $n(n+2)$ is divisible by a small prime $p$. This exercise [@problem_id:3082614] focuses on the special case of $p=2$, where the parity relationship between $n$ and $n+2$ causes the forbidden residue classes to coalesce, a crucial detail that affects the overall density of surviving integers.", "problem": "Let $x \\geq 3$ be a large real parameter, and consider the standard setup of Brun's sieve (the sieve method due to Viggo Brun) applied to the set $\\mathcal{A} = \\{1,2,\\dots,\\lfloor x \\rfloor\\}$ in the twin-prime context. For each prime $p$, define the set of forbidden residue classes modulo $p$ by\n$$\n\\Omega(p) \\;=\\; \\{\\, a \\bmod p \\;:\\; p \\mid a(a+2) \\,\\}.\n$$\nLet $g(p) := |\\Omega(p)|$ denote the number of residue classes removed at the prime $p$, and define the local survival proportion\n$$\nS_p \\;=\\; 1 \\;-\\; \\frac{g(p)}{p}.\n$$\nThe parity condition at $p=2$ is special in the twin-prime problem because the two linear forms $n$ and $n+2$ are congruent modulo $2$. Working from the above definitions and first principles in modular arithmetic, do the following:\n\n1. Determine $g(2)$ by analyzing $\\Omega(2)$ and explain conceptually why the two forbidden classes coalesce at $p=2$ for the twin-prime problem.\n\n2. Using your value of $g(2)$, compute the normalized local factor\n$$\nL_2 \\;=\\; \\frac{S_2}{\\bigl(1-\\frac{1}{2}\\bigr)^2},\n$$\nwhich compares the sieve's local density at $p=2$ to the naive baseline for two independent coprimality constraints. Your final answer must be the exact value of $L_2$.\n\nProvide the exact value of $L_2$ as your final answer. No rounding is required.", "solution": "The problem asks for the computation of the normalized local factor $L_2$ in the context of Brun's sieve applied to the twin-prime problem. This requires determining the number of forbidden residue classes modulo $2$, denoted by $g(2)$.\n\nThe set to be sieved is $\\mathcal{A} = \\{1, 2, \\dots, \\lfloor x \\rfloor\\}$. The twin-prime problem seeks integers $n$ such that both $n$ and $n+2$ are prime. The sieve removes integers $n$ for which the product $n(n+2)$ is divisible by some prime $p$ less than a certain bound. The problem defines the set of forbidden residue classes modulo a prime $p$ as\n$$\n\\Omega(p) = \\{a \\bmod p : p \\mid a(a+2)\\}.\n$$\nThe number of such classes is $g(p) = |\\Omega(p)|$.\n\nFirst, we determine $g(2)$. This corresponds to the case where the prime is $p=2$. The definition of $\\Omega(2)$ is\n$$\n\\Omega(2) = \\{a \\bmod 2 : 2 \\mid a(a+2)\\}.\n$$\nTo find the elements of this set, we test the two possible residue classes modulo $2$: $a \\equiv 0 \\pmod{2}$ and $a \\equiv 1 \\pmod{2}$.\n\nCase 1: $a \\equiv 0 \\pmod{2}$.\nIn this case, $a$ is an even integer. The product $a(a+2)$ is certainly divisible by $2$. For instance, substituting $a=0$ into the expression gives $0(0+2) = 0$, which is divisible by $2$. Thus, the residue class $0 \\bmod 2$ is in $\\Omega(2)$.\n\nCase 2: $a \\equiv 1 \\pmod{2}$.\nIn this case, $a$ is an odd integer. The term $a+2$ is also odd. The product of two odd integers, $a(a+2)$, must be odd. An odd number is not divisible by $2$. For instance, substituting $a=1$ into the expression gives $1(1+2) = 3$, which is not divisible by $2$. Therefore, the residue class $1 \\bmod 2$ is not in $\\Omega(2)$.\n\nFrom this analysis, the set of forbidden residue classes modulo $2$ is $\\Omega(2) = \\{0 \\bmod 2\\}$. The size of this set is therefore $g(2) = |\\Omega(2)| = 1$.\n\nConceptually, the coalescence of forbidden classes at $p=2$ is a direct consequence of the structure of the linear forms $n$ and $n+2$. For a general prime $p$, the condition $p \\mid n(n+2)$ is equivalent to $p \\mid n$ or $p \\mid n+2$. These correspond to the forbidden residue classes $n \\equiv 0 \\pmod{p}$ and $n \\equiv -2 \\pmod{p}$.\nFor any odd prime $p > 2$, the residue classes $0 \\pmod p$ and $-2 \\pmod p$ are distinct. Thus, for $p>2$, we have $g(p) = 2$.\nHowever, for the prime $p=2$, the residue classes $0 \\pmod 2$ and $-2 \\pmod 2$ are not distinct, since $-2 \\equiv 0 \\pmod 2$. The two conditions coalesce into a single condition, $n \\equiv 0 \\pmod 2$. This occurs because the integers $n$ and $n+2$ always have the same parity. If $n$ is even, $n+2$ is even. If $n$ is odd, $n+2$ is odd. To ensure that neither $n$ nor $n+2$ is divisible by $2$ (a necessary condition for them to be twin primes, other than the pair $(3,5)$ which is handled by sieving from $p=3$), we only need to impose the single condition that $n$ must be odd, i.e., $n \\not\\equiv 0 \\pmod 2$. This single exclusion removes all integers $n$ for which either $n$ or $n+2$ would be an even number greater than $2$. Thus, we only remove one residue class modulo $2$, which is why $g(2)=1$.\n\nNext, we compute the normalized local factor $L_2$.\nThe local survival proportion at a prime $p$ is defined as\n$$\nS_p = 1 - \\frac{g(p)}{p}.\n$$\nFor $p=2$, using our calculated value $g(2)=1$, we have\n$$\nS_2 = 1 - \\frac{g(2)}{2} = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\nThis quantity, $S_2$, represents the proportion of integers that \"survive\" the sieve at the prime $2$. In other words, it is the density of integers $n$ for which $n(n+2)$ is not divisible by $2$.\n\nThe problem defines the normalized local factor $L_2$ as\n$$\nL_2 = \\frac{S_2}{\\left(1-\\frac{1}{2}\\right)^2}.\n$$\nThe denominator, $\\left(1-\\frac{1}{2}\\right)^2$, represents a naive probabilistic baseline. It is the probability that two independently and randomly chosen integers are both not divisible by $2$. The numerator, $S_2$, is the actual proportion for the correlated pair $(n, n+2)$. The factor $L_2$ corrects for this correlation.\n\nSubstituting the value of $S_2$ into the expression for $L_2$:\n$$\nL_2 = \\frac{\\frac{1}{2}}{\\left(1-\\frac{1}{2}\\right)^2} = \\frac{\\frac{1}{2}}{\\left(\\frac{1}{2}\\right)^2}.\n$$\nSimplifying the denominator gives:\n$$\n\\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}.\n$$\nTherefore, the expression for $L_2$ becomes:\n$$\nL_2 = \\frac{\\frac{1}{2}}{\\frac{1}{4}} = \\frac{1}{2} \\times \\frac{4}{1} = 2.\n$$\nThe exact value of the normalized local factor at $p=2$ is $2$.", "answer": "$$\\boxed{2}$$", "id": "3082614"}, {"introduction": "The Brun sieve provides an estimate for the number of unsifted elements not by using the full inclusion-exclusion principle, which is too cumbersome, but by truncating it. This truncation creates an approximation that serves as an upper or lower bound, a key insight of Viggo Brun. This final practice problem [@problem_id:3082637] makes this idea concrete by having you compute a truncated inclusion-exclusion sum for a specific set, directly demonstrating how the sieve approximates a count in a practical, hands-on calculation.", "problem": "Consider the sifted set associated with Brun's sieve: let $\\mathcal{A}=\\{1,2,\\dots,100\\}$, let $z=10$, and let $\\mathcal{P}(z)$ be the set of primes up to $z$, namely $\\{2,3,5,7\\}$. Define the sifted set $S(\\mathcal{A},\\mathcal{P},z)$ to be the elements of $\\mathcal{A}$ not divisible by any prime in $\\mathcal{P}(z)$. Starting from the Inclusion–Exclusion Principle and the basic counting fact that for a positive integer $d$, the number of elements of $\\mathcal{A}$ divisible by $d$ is $\\left\\lfloor \\frac{100}{d} \\right\\rfloor$, derive the order-$2$ truncated inclusion–exclusion approximation to $\\left|S(\\mathcal{A},\\mathcal{P},z)\\right|$ by subtracting the single-prime divisibility counts and then adding back the pairwise divisibility counts, where pairwise divisibility counts are taken over the Least Common Multiple (LCM) of two distinct primes. Compute this order-$2$ truncated approximation $\\left|S(\\mathcal{A},\\mathcal{P},z)\\right|_{(2)}$ exactly as an integer. No rounding is required. Your final answer must be a single number.", "solution": "The problem requires the computation of an order-$2$ truncated approximation for the size of a sifted set, based on the Principle of Inclusion–Exclusion. We are given the set to be sifted, $\\mathcal{A}=\\{1,2,\\dots,100\\}$, and the set of sifting primes, $\\mathcal{P}$, which are the primes up to $z=10$.\n\nFirst, we identify the given sets and parameters.\nThe set of integers to be sifted is $\\mathcal{A} = \\{n \\in \\mathbb{Z} \\mid 1 \\le n \\le 100\\}$. The size of this set is $|\\mathcal{A}| = 100$.\nThe sifting limit is $z=10$. The set of sifting primes is $\\mathcal{P} = \\{p \\in \\mathbb{P} \\mid p \\le z\\}$, which is $\\mathcal{P} = \\{2, 3, 5, 7\\}$.\nThe sifted set $S(\\mathcal{A}, \\mathcal{P}, z)$ is defined as the set of elements in $\\mathcal{A}$ that are not divisible by any prime in $\\mathcal{P}$.\nWe use the notation $\\mathcal{A}_d = \\{a \\in \\mathcal{A} \\mid d \\text{ divides } a\\}$. The problem provides the formula for the size of this set: $|\\mathcal{A}_d| = \\left\\lfloor \\frac{100}{d} \\right\\rfloor$.\n\nThe Principle of Inclusion–Exclusion states that the exact size of the sifted set is:\n$$|S(\\mathcal{A},\\mathcal{P},z)| = |\\mathcal{A}| - \\sum_{p_i \\in \\mathcal{P}} |\\mathcal{A}_{p_i}| + \\sum_{p_i, p_j \\in \\mathcal{P}, ij} |\\mathcal{A}_{p_i p_j}| - \\sum_{p_i, p_j, p_k \\in \\mathcal{P}, ijk} |\\mathcal{A}_{p_i p_j p_k}| + \\dots$$\nwhere divisibility by a set of distinct primes $\\{p_i, p_j, \\dots\\}$ corresponds to divisibility by their product, since they are coprime.\n\nThe problem asks for the order-$2$ truncated approximation, which we denote by $|S(\\mathcal{A},\\mathcal{P},z)|_{(2)}$. According to the problem description, this is obtained by starting with the total count, subtracting the single-prime divisibility counts, and adding back the pairwise divisibility counts. This corresponds to the first three terms of the inclusion-exclusion formula:\n$$|S(\\mathcal{A},\\mathcal{P},z)|_{(2)} = |\\mathcal{A}| - \\sum_{p \\in \\mathcal{P}} |\\mathcal{A}_p| + \\sum_{p,q \\in \\mathcal{P}, pq} |\\mathcal{A}_{pq}|$$\n\nWe proceed to calculate each term.\nThe size of the initial set is $|\\mathcal{A}| = 100$.\n\nThe sum of single-prime divisibility counts is:\n$$ \\sum_{p \\in \\mathcal{P}} |\\mathcal{A}_p| = |\\mathcal{A}_2| + |\\mathcal{A}_3| + |\\mathcal{A}_5| + |\\mathcal{A}_7| $$\nUsing the given formula $|\\mathcal{A}_d| = \\left\\lfloor \\frac{100}{d} \\right\\rfloor$:\n$|\\mathcal{A}_2| = \\left\\lfloor \\frac{100}{2} \\right\\rfloor = 50$\n$|\\mathcal{A}_3| = \\left\\lfloor \\frac{100}{3} \\right\\rfloor = 33$\n$|\\mathcal{A}_5| = \\left\\lfloor \\frac{100}{5} \\right\\rfloor = 20$\n$|\\mathcal{A}_7| = \\left\\lfloor \\frac{100}{7} \\right\\rfloor = 14$\nThe sum is $50 + 33 + 20 + 14 = 117$.\n\nThe sum of pairwise divisibility counts requires considering all pairs of distinct primes from $\\mathcal{P}$. The pairs are $(2,3)$, $(2,5)$, $(2,7)$, $(3,5)$, $(3,7)$, and $(5,7)$. The corresponding divisors are their products.\n$$ \\sum_{p,q \\in \\mathcal{P}, pq} |\\mathcal{A}_{pq}| = |\\mathcal{A}_{2 \\cdot 3}| + |\\mathcal{A}_{2 \\cdot 5}| + |\\mathcal{A}_{2 \\cdot 7}| + |\\mathcal{A}_{3 \\cdot 5}| + |\\mathcal{A}_{3 \\cdot 7}| + |\\mathcal{A}_{5 \\cdot 7}| $$\nWe calculate each term:\n$|\\mathcal{A}_6| = \\left\\lfloor \\frac{100}{6} \\right\\rfloor = 16$\n$|\\mathcal{A}_{10}| = \\left\\lfloor \\frac{100}{10} \\right\\rfloor = 10$\n$|\\mathcal{A}_{14}| = \\left\\lfloor \\frac{100}{14} \\right\\rfloor = 7$\n$|\\mathcal{A}_{15}| = \\left\\lfloor \\frac{100}{15} \\right\\rfloor = 6$\n$|\\mathcal{A}_{21}| = \\left\\lfloor \\frac{100}{21} \\right\\rfloor = 4$\n$|\\mathcal{A}_{35}| = \\left\\lfloor \\frac{100}{35} \\right\\rfloor = 2$\nThe sum is $16 + 10 + 7 + 6 + 4 + 2 = 45$.\n\nFinally, we substitute these values back into the expression for the order-$2$ truncated approximation:\n$$|S(\\mathcal{A},\\mathcal{P},z)|_{(2)} = 100 - 117 + 45$$\n$$|S(\\mathcal{A},\\mathcal{P},z)|_{(2)} = -17 + 45$$\n$$|S(\\mathcal{A},\\mathcal{P},z)|_{(2)} = 28$$\n\nThe order-$2$ truncated approximation to $|S(\\mathcal{A},\\mathcal{P},z)|$ is $28$.", "answer": "$$\\boxed{28}$$", "id": "3082637"}]}