{"hands_on_practices": [{"introduction": "Understanding the average behavior of arithmetic functions often begins with a clever rearrangement of sums. This first exercise introduces the powerful technique of changing the order of summation to analyze the average value of $\\frac{\\sigma(n)}{n}$. By transforming the sum over integers into a sum over their divisors, you will see how a seemingly complex expression simplifies into a form that can be estimated with standard analytic tools.", "problem": "Let $\\sigma(n)$ denote the sum of positive divisors of the positive integer $n$. For a real parameter $x \\ge 2$, consider the summatory function\n$$\nS(x) \\coloneqq \\sum_{n \\le x} \\frac{\\sigma(n)}{n},\n$$\nwhere the sum is over positive integers $n \\le x$. Starting only from the definition of $\\sigma(n)$ and elementary counting of multiples, derive an asymptotic expression for $S(x)$ with an explicit main term and an error term of at most logarithmic size. You may use the well-tested facts $\\sum_{m=1}^{\\infty} \\frac{1}{m^{2}} = \\frac{\\pi^{2}}{6}$ and $\\sum_{m \\le x} \\frac{1}{m} = \\ln x + \\gamma + O\\!\\left(\\frac{1}{x}\\right)$, where $\\gamma$ is the Euler–Mascheroni constant. Express your final answer as a single analytic expression in $x$ using Landau’s big-$O$ notation.", "solution": "The objective is to find an asymptotic expression for the summatory function $S(x) \\coloneqq \\sum_{n \\le x} \\frac{\\sigma(n)}{n}$ for a real parameter $x \\ge 2$. The derivation will proceed by first expressing the summand $\\frac{\\sigma(n)}{n}$ as a sum over divisors, then changing the order of summation, and finally estimating the resulting sums using the provided facts.\n\nFirst, we rewrite the term $\\frac{\\sigma(n)}{n}$. The function $\\sigma(n)$ is the sum of the positive divisors of $n$, which can be written as $\\sigma(n) = \\sum_{d|n} d$. Thus,\n$$\n\\frac{\\sigma(n)}{n} = \\frac{1}{n} \\sum_{d|n} d = \\sum_{d|n} \\frac{d}{n}.\n$$\nLet's define a new index $k = n/d$. As $d$ runs over all positive divisors of $n$, $k$ also runs over all positive divisors of $n$. Substituting $d = n/k$ into the sum gives\n$$\n\\frac{\\sigma(n)}{n} = \\sum_{k|n} \\frac{n/k}{n} = \\sum_{k|n} \\frac{1}{k}.\n$$\nThis identity holds for any positive integer $n$.\n\nNow, we substitute this back into the definition of $S(x)$:\n$$\nS(x) = \\sum_{n \\le x} \\sum_{k|n} \\frac{1}{k}.\n$$\nThis is a double summation over pairs of positive integers $(n, k)$ where $k$ is a divisor of $n$ and $n \\le x$. We can change the order of summation. Instead of summing over $n$ first, we can sum over $k$ first. A pair $(n, k)$ is included in the sum if $k|n$ and $n \\le x$. This is equivalent to $n = mk$ for some positive integer $m$, and $mk \\le x$.\nSo, we can sum over all possible values of $k$ first. For $n \\le x$ and $k|n$, we must have $k \\le n \\le x$. So $k$ runs from $1$ to $\\lfloor x \\rfloor$. For a fixed $k$, $n$ must be a multiple of $k$ with $n \\le x$. That is, $n \\in \\{k, 2k, 3k, \\dots, \\lfloor x/k \\rfloor k\\}$.\nRewriting the sum by summing over $k$ first and then over the corresponding multiples $n$:\n$$\nS(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\sum_{\\substack{n \\le x \\\\ k|n}} \\frac{1}{k}.\n$$\nThe inner sum is over $n$. The term $\\frac{1}{k}$ is constant with respect to $n$. The number of terms in the inner sum is the number of multiples of $k$ that are less than or equal to $x$, which is precisely $\\lfloor \\frac{x}{k} \\rfloor$.\nTherefore, the sum becomes\n$$\nS(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} \\left\\lfloor \\frac{x}{k} \\right\\rfloor.\n$$\nTo analyze this sum, we express the floor function $\\lfloor u \\rfloor$ as $u - \\{u\\}$, where $\\{u\\}$ is the fractional part of $u$ satisfying $0 \\le \\{u\\} < 1$.\n$$\nS(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} \\left( \\frac{x}{k} - \\left\\{\\frac{x}{k}\\right\\} \\right) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{x}{k^2} - \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}\\left\\{\\frac{x}{k}\\right\\}.\n$$\nWe analyze the two sums on the right-hand side separately.\n\nLet the first sum be $S_1(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{x}{k^2} = x \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k^2}$. Let $N = \\lfloor x \\rfloor$.\nWe can express the finite sum $\\sum_{k=1}^{N} \\frac{1}{k^2}$ using the given infinite series value $\\sum_{k=1}^{\\infty} \\frac{1}{k^2} = \\frac{\\pi^2}{6}$.\n$$\n\\sum_{k=1}^{N} \\frac{1}{k^2} = \\sum_{k=1}^{\\infty} \\frac{1}{k^2} - \\sum_{k=N+1}^{\\infty} \\frac{1}{k^2} = \\frac{\\pi^2}{6} - R_N,\n$$\nwhere $R_N = \\sum_{k=N+1}^{\\infty} \\frac{1}{k^2}$. The tail of the series $R_N$ can be bounded by an integral, since $f(t) = 1/t^2$ is a positive, decreasing function for $t > 0$:\n$$\nR_N < \\int_{N}^{\\infty} \\frac{1}{t^2} dt = \\left[ -\\frac{1}{t} \\right]_N^{\\infty} = 0 - \\left(-\\frac{1}{N}\\right) = \\frac{1}{N}.\n$$\nSo, $R_N = O\\left(\\frac{1}{N}\\right)$. Since $N = \\lfloor x \\rfloor$, we have $x-1 < N \\le x$. For $x \\ge 2$, $N \\ge 2$, so $1/N \\le 1/(x-1) = O(1/x)$. Thus, $R_N = O\\left(\\frac{1}{x}\\right)$.\nSubstituting this back into the expression for $S_1(x)$:\n$$\nS_1(x) = x \\left( \\frac{\\pi^2}{6} - O\\left(\\frac{1}{x}\\right) \\right) = \\frac{\\pi^2}{6}x - O(1).\n$$\nThis gives the main term of our asymptotic formula.\n\nLet the second sum be $S_2(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}\\left\\{\\frac{x}{k}\\right\\}$. This will constitute our error term.\nBy definition of the fractional part, we have $0 \\le \\left\\{\\frac{x}{k}\\right\\} < 1$. This leads to the bounds on $S_2(x)$:\n$$\n0 \\le S_2(x) < \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}.\n$$\nThe sum on the right is the harmonic sum up to $N=\\lfloor x \\rfloor$. We are given the asymptotic formula $\\sum_{m \\le y} \\frac{1}{m} = \\ln y + \\gamma + O\\left(\\frac{1}{y}\\right)$. Applying this with $y=N$:\n$$\n\\sum_{k=1}^{N} \\frac{1}{k} = \\ln N + \\gamma + O\\left(\\frac{1}{N}\\right).\n$$\nTo express this in terms of $x$, we note that $\\ln N = \\ln(\\lfloor x \\rfloor)$. Since $\\ln(x-1) < \\ln(\\lfloor x \\rfloor) \\le \\ln x$ for $x \\ge 2$, and $\\ln(x-1) = \\ln(x(1-1/x)) = \\ln x + \\ln(1-1/x) = \\ln x - O(1/x)$, we have $\\ln(\\lfloor x \\rfloor) = \\ln x + O(1/x)$.\nTherefore,\n$$\n\\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} = \\ln x + O\\left(\\frac{1}{x}\\right) + \\gamma + O\\left(\\frac{1}{x}\\right) = \\ln x + \\gamma + O\\left(\\frac{1}{x}\\right).\n$$\nFrom the bound $0 \\le S_2(x) < \\ln x + \\gamma + O(1/x)$, we can conclude that $S_2(x) = O(\\ln x)$.\n\nFinally, we combine the results for $S_1(x)$ and $S_2(x)$ to obtain the asymptotic formula for $S(x)$:\n$$\nS(x) = S_1(x) - S_2(x) = \\left(\\frac{\\pi^2}{6}x - O(1)\\right) - O(\\ln x).\n$$\nThe error term is the sum of two error terms. The total error is bounded in magnitude by $|-O(1) - O(\\ln x)| \\le |O(1)| + |O(\\ln x)|$. For large $x$, the term $O(\\ln x)$ dominates the $O(1)$ term. Thus, the combined error term is $O(\\ln x)$.\n\nThe final asymptotic expression for $S(x)$ is\n$$\nS(x) = \\frac{\\pi^2}{6}x + O(\\ln x).\n$$\nThis expression provides the main linear term and an error term of logarithmic size, as required.", "answer": "$$\n\\boxed{\\frac{\\pi^2}{6}x + O(\\ln x)}\n$$", "id": "3081674"}, {"introduction": "While sum-swapping is a versatile tool, some problems benefit from a more geometric perspective. This practice introduces the celebrated Dirichlet hyperbola method to find the average order of the divisor function, $\\tau(n)$ [@problem_id:3081675]. By interpreting the sum as a count of integer lattice points under a hyperbola and splitting the region symmetrically, you will derive one of the cornerstone results of analytic number theory and uncover the significance of the Euler–Mascheroni constant $\\gamma$ in this context.", "problem": "Let $\\tau(n)$ denote the number of positive divisors of $n$, and for real $t \\geq 1$ let $H_{t} := \\sum_{n \\leq t} \\frac{1}{n}$ denote the generalized harmonic sum. Consider the summatory function $S(x) := \\sum_{n \\leq x} \\tau(n)$ for real $x \\geq 1$. Starting from the foundational definition of $\\tau(n)$ and the double-counting interpretation of $S(x)$ as the number of integer pairs $(d,m)$ with $d m \\leq x$, derive an exact identity that expresses $S(x)$ in terms of a sum of floor functions. Then, by symmetrically splitting the resulting sum at $n = \\lfloor \\sqrt{x} \\rfloor$, approximate the main term using $x H_{\\lfloor \\sqrt{x} \\rfloor}$ and control the remainder using only elementary bounds. Assume the well-tested asymptotic expansion $H_{t} = \\ln t + \\gamma + O\\!\\left(\\frac{1}{t}\\right)$, where $\\gamma$ is the Euler–Mascheroni constant. Show that there is a constant $C$ such that\n$$\nS(x) = x \\ln x + C x + o(x),\n$$\nand determine the closed-form expression for $C$. Your final answer must be a single analytic expression. No rounding is required.", "solution": "The problem asks for a derivation of the asymptotic formula for the summatory function of the divisor function, $S(x) = \\sum_{n \\leq x} \\tau(n)$, and the determination of a specific constant in this formula. The derivation must follow a prescribed path involving a double-counting argument, a symmetric splitting of the sum, and asymptotic analysis.\n\nFirst, we establish an exact identity for $S(x)$. The divisor function $\\tau(n)$ is defined as the number of positive divisors of an integer $n$, which can be written as $\\tau(n) = \\sum_{d|n, d>0} 1$. Substituting this definition into the expression for $S(x)$ gives:\n$$\nS(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\tau(n) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sum_{d|n} 1\n$$\nWe can interchange the order of summation. The sum is over pairs of positive integers $(n, d)$ such that $d$ divides $n$ and $n \\leq x$. This is equivalent to summing over pairs of positive integers $(d, m)$ such that $n = dm$ and $dm \\leq x$. Therefore, $S(x)$ is the number of integer lattice points $(d, m)$ in the first quadrant satisfying $dm \\leq x$.\n$$\nS(x) = \\sum_{d \\geq 1, m \\geq 1, dm \\leq x} 1\n$$\nTo express this as a sum of floor functions, we can sum over $d$ first. For a fixed positive integer $d$, the condition on $m$ is $m \\leq \\frac{x}{d}$. Since $m$ must be an integer, we have $1 \\leq m \\leq \\lfloor \\frac{x}{d} \\rfloor$. The largest possible value for $d$ is $\\lfloor x \\rfloor$, as for $d > x$, $\\lfloor \\frac{x}{d} \\rfloor = 0$. Thus, we obtain the exact identity:\n$$\nS(x) = \\sum_{d=1}^{\\lfloor x \\rfloor} \\lfloor \\frac{x}{d} \\rfloor\n$$\nNext, we apply the technique known as the Dirichlet hyperbola method, which corresponds to the \"symmetrically splitting\" instruction. The region of summation, $dm \\leq x$ with $d,m \\geq 1$, is symmetric with respect to the line $d=m$. This line intersects the boundary curve $dm=x$ at the point $(\\sqrt{x}, \\sqrt{x})$. Let $N = \\lfloor \\sqrt{x} \\rfloor$. We count the points in two overlapping rectangular regions and subtract the count of their intersection.\nThe first region is defined by $1 \\leq d \\leq N$. The number of points in this region is $\\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor$.\nThe second region is defined by $1 \\leq m \\leq N$. The number of points is $\\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor$.\nThe intersection of these two regions is the square defined by $1 \\leq d \\leq N$ and $1 \\leq m \\leq N$. The number of points in this square is $N \\times N = N^2$.\nBy the Principle of Inclusion-Exclusion, the total number of points is:\n$$\nS(x) = \\left( \\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor \\right) + \\left( \\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor \\right) - N^2 = 2 \\sum_{n=1}^{N} \\lfloor \\frac{x}{n} \\rfloor - N^2\n$$\nwhere we use $n$ as the dummy summation index.\n\nNow we perform the asymptotic analysis. We decompose the floor function as $\\lfloor z \\rfloor = z - \\{z\\}$, where $\\{z\\}$ is the fractional part of $z$, satisfying $0 \\leq \\{z\\} < 1$.\n$$\nS(x) = 2 \\sum_{n=1}^{N} \\left(\\frac{x}{n} - \\left\\{\\frac{x}{n}\\right\\}\\right) - N^2 = 2x \\sum_{n=1}^{N} \\frac{1}{n} - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\nThe first term involves the generalized harmonic sum $H_N = \\sum_{n=1}^{N} \\frac{1}{n}$. So, the expression becomes:\n$$\nS(x) = 2x H_N - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\nLet's analyze the magnitude of each term.\nThe remainder sum is bounded: $0 \\leq \\sum_{n=1}^{N} \\{\\frac{x}{n}\\} < \\sum_{n=1}^{N} 1 = N$. Therefore, $2 \\sum_{n=1}^{N} \\{\\frac{x}{n}\\} = O(N) = O(\\sqrt{x})$.\nFor the term $N^2$, we have $N = \\lfloor\\sqrt{x}\\rfloor = \\sqrt{x} - \\{\\sqrt{x}\\}$.\n$$\nN^2 = (\\sqrt{x} - \\{\\sqrt{x}\\})^2 = x - 2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2\n$$\nSince $0 \\leq \\{\\sqrt{x}\\} < 1$, the term $-2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2$ is $O(\\sqrt{x})$. Thus, we can write $N^2 = x - O(\\sqrt{x})$, or equivalently $-N^2 = -x + O(\\sqrt{x})$.\nSubstituting these estimates back into the expression for $S(x)$:\n$$\nS(x) = 2x H_N - x + O(\\sqrt{x})\n$$\nThe problem provides the asymptotic expansion for the harmonic sum: $H_t = \\ln t + \\gamma + O(\\frac{1}{t})$, where $\\gamma$ is the Euler–Mascheroni constant. We apply this with $t = N = \\lfloor\\sqrt{x}\\rfloor$.\n$$\nH_N = \\ln N + \\gamma + O(\\frac{1}{N})\n$$\nWe need to relate $\\ln N$ to $\\ln x$.\n$$\n\\ln N = \\ln(\\lfloor\\sqrt{x}\\rfloor) = \\ln(\\sqrt{x} - \\{\\sqrt{x}\\}) = \\ln\\left(\\sqrt{x}\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\\right)\n$$\n$$\n\\ln N = \\ln(\\sqrt{x}) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = \\frac{1}{2}\\ln x + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\n$$\nUsing the Taylor expansion $\\ln(1-u) = -u - \\frac{u^2}{2} - \\dots$ for small $u$. Here $u = \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}} = O(\\frac{1}{\\sqrt{x}})$.\n$$\n\\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\nSo, $\\ln N = \\frac{1}{2}\\ln x + O(\\frac{1}{\\sqrt{x}})$. Since $1/N = O(1/\\sqrt{x})$, the approximation for $H_N$ becomes:\n$$\nH_N = \\frac{1}{2}\\ln x + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\nFinally, we substitute this into our expression for $S(x)$:\n$$\nS(x) = 2x \\left(\\frac{1}{2}\\ln x + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) - x + O(\\sqrt{x})\n$$\n$$\nS(x) = x\\ln x + 2\\gamma x + 2x \\cdot O\\left(\\frac{1}{\\sqrt{x}}\\right) - x + O(\\sqrt{x})\n$$\nThe term $2x \\cdot O(\\frac{1}{\\sqrt{x}})$ is $O(\\sqrt{x})$. Combining all error terms gives:\n$$\nS(x) = x\\ln x + (2\\gamma - 1)x + O(\\sqrt{x})\n$$\nWe are asked to show that $S(x) = x \\ln x + C x + o(x)$. An error term of $O(\\sqrt{x})$ is a function $f(x)$ for which there exists a constant $M$ such that $|f(x)| \\leq M\\sqrt{x}$ for sufficiently large $x$. Since $\\lim_{x\\to\\infty} \\frac{\\sqrt{x}}{x} = \\lim_{x\\to\\infty} \\frac{1}{\\sqrt{x}} = 0$, any function that is $O(\\sqrt{x})$ is also $o(x)$.\nTherefore, our derived asymptotic formula has the required form:\n$$\nS(x) = x \\ln x + (2\\gamma - 1) x + o(x)\n$$\nBy comparing this with $S(x) = x \\ln x + C x + o(x)$, we identify the constant $C$.\n$$\nC = 2\\gamma - 1\n$$\nThis is the closed-form expression for the constant $C$.", "answer": "$$\n\\boxed{2\\gamma - 1}\n$$", "id": "3081675"}, {"introduction": "The effectiveness of the hyperbola method hinges on a strategic choice of where to split the summation region. Building upon the previous exercise [@problem_id:3081675], this problem challenges you to generalize the method by using an arbitrary splitting parameter $y$ [@problem_id:3081705]. By analyzing the error term as a function of $y$, you will learn the crucial principle of balancing error contributions to find the optimal strategy, a key insight in both theoretical analysis and computational number theory.", "problem": "Let $x \\geq 1$ be a real parameter and let $\\tau(n)$ denote the number of positive divisors of the integer $n$. Consider the divisor summatory function $D(x) = \\sum_{n \\leq x} \\tau(n)$ and interpret $D(x)$ as the number of pairs of positive integers $(a,b)$ with $ab \\leq x$. Fix a splitting parameter $y$ with $1 \\leq y \\leq \\sqrt{x}$, and decompose the count of pairs $(a,b)$ into those with $a \\leq y$ and those with $b \\leq y$, accounting carefully for overlaps. \n\nStarting from the fundamental definitions of $\\tau(n)$ and the interpretation of $D(x)$ as a lattice point count under the hyperbola $ab \\leq x$, derive a decomposition of $D(x)$ that isolates the contribution of the boundary rectangle produced by the split at $y$. Then, approximate the resulting sum using only well-tested facts from elementary analysis, specifically that the harmonic numbers satisfy $H_{y} = \\sum_{n=1}^{\\lfloor y \\rfloor} \\frac{1}{n} = \\ln y + \\gamma + O\\!\\left(\\frac{1}{y}\\right)$, where $\\gamma$ is the Euler–Mascheroni constant. From this, obtain an explicit main term for $D(x)$ and an explicit error bound in terms of $x$ and $y$.\n\nFinally, minimize the total error as a function of $y$ over the range $1 \\leq y \\leq \\sqrt{x}$, and report the optimal choice of $y$ as a closed-form expression in $x$. No rounding is required, and you must express your final answer as a single analytic expression.", "solution": "The problem asks for an analysis of the divisor summatory function $D(x) = \\sum_{n \\leq x} \\tau(n)$ using the Dirichlet hyperbola method with a general splitting parameter $y$. We are given that $1 \\leq y \\leq \\sqrt{x}$.\n\nFirst, we derive the general identity for $D(x) = \\sum_{ab \\le x} 1$. The sum is over integer points $(a,b)$ under the hyperbola. The Dirichlet hyperbola method provides an exact identity by splitting the summation region.\n$$\nD(x) = \\sum_{a=1}^{\\lfloor y \\rfloor} \\sum_{b=1}^{\\lfloor x/a \\rfloor} 1 + \\sum_{b=1}^{\\lfloor x/y \\rfloor} \\sum_{a=1}^{\\lfloor x/b \\rfloor} 1 - \\left(\\sum_{a=1}^{\\lfloor y \\rfloor} 1\\right) \\left(\\sum_{b=1}^{\\lfloor x/y \\rfloor} 1\\right)\n$$\nThis identity correctly counts the points by summing over two overlapping rectangular regions and subtracting the intersection. Let $Y = \\lfloor y \\rfloor$ and $Z = \\lfloor x/y \\rfloor$.\n$$\nD(x) = \\sum_{a=1}^{Y} \\left\\lfloor \\frac{x}{a} \\right\\rfloor + \\sum_{b=1}^{Z} \\left\\lfloor \\frac{x}{b} \\right\\rfloor - YZ\n$$\nNext, we approximate the terms to find the main term and an error bound. We use $\\lfloor u \\rfloor = u - \\{u\\} = u + O(1)$.\nThe first sum is:\n$$ \\sum_{a=1}^{Y} \\left\\lfloor\\frac{x}{a}\\right\\rfloor = \\sum_{a=1}^{Y} \\left(\\frac{x}{a} - \\left\\{\\frac{x}{a}\\right\\}\\right) = x \\sum_{a=1}^{Y} \\frac{1}{a} - \\sum_{a=1}^{Y} \\left\\{\\frac{x}{a}\\right\\} = x H_Y + O(Y) $$\nUsing the given approximation for the harmonic number $H_Y = \\ln Y + \\gamma + O(1/Y)$:\n$$ x H_Y + O(Y) = x(\\ln Y + \\gamma + O(1/Y)) + O(Y) $$\nSince $Y = y + O(1)$, $\\ln Y = \\ln(y+O(1)) = \\ln y + O(1/y)$. So,\n$$ \\sum_{a=1}^{Y} \\left\\lfloor\\frac{x}{a}\\right\\rfloor = x(\\ln y + \\gamma + O(1/y)) + O(y) = x \\ln y + \\gamma x + O(x/y) + O(y) $$\nThe second sum is treated identically, with $Z$ instead of $Y$:\n$$ \\sum_{b=1}^{Z} \\left\\lfloor\\frac{x}{b}\\right\\rfloor = x H_Z + O(Z) = x(\\ln Z + \\gamma + O(1/Z)) + O(Z) $$\nSince $Z = x/y + O(1)$, $\\ln Z = \\ln(x/y + O(1)) = \\ln(x/y) + O(y/x) = \\ln x - \\ln y + O(y/x)$. So,\n$$ \\sum_{b=1}^{Z} \\left\\lfloor\\frac{x}{b}\\right\\rfloor = x(\\ln x - \\ln y + \\gamma + O(y/x)) + O(x/y) = x \\ln x - x \\ln y + \\gamma x + O(y) + O(x/y) $$\nThe third term is:\n$$ -YZ = -(y+O(1))(x/y + O(1)) = -(x + O(y) + O(x/y) + O(1)) = -x + O(y) + O(x/y) $$\nCombining all three parts:\n$$ D(x) = (x \\ln y + \\gamma x) + (x \\ln x - x \\ln y + \\gamma x) - x + (\\text{all error terms}) $$\nThe error terms from the three main parts are $O(x/y)$, $O(y)$, $O(y)$, $O(x/y)$, $O(y)$, and $O(x/y)$. The total error is $O(x/y + y)$.\n$$ D(x) = x \\ln x + (2\\gamma - 1)x + O(x/y + y) $$\nThis gives the explicit main term $x \\ln x + (2\\gamma-1)x$ and an error bound of $O(x/y + y)$.\n\nFinally, we must find the optimal choice of parameter $y$ in the range $1 \\leq y \\leq x$ that minimizes this error bound. We want to minimize the function $E(y) = C_1 y + C_2 x/y$ for some positive constants $C_1, C_2$. To find the minimum, we can balance the two terms by setting them to be of the same order of magnitude:\n$$ y \\asymp \\frac{x}{y} \\implies y^2 \\asymp x \\implies y \\asymp \\sqrt{x} $$\nMore formally, taking the derivative with respect to $y$ and setting it to zero gives:\n$$ E'(y) = C_1 - C_2 \\frac{x}{y^2} = 0 \\implies y^2 = \\frac{C_2}{C_1} x $$\nThis shows the minimum occurs at $y = \\sqrt{\\frac{C_2}{C_1} x}$, which is proportional to $\\sqrt{x}$. The principle of the method is to balance the error terms. The choice that perfectly balances the order of magnitude of the error terms $y$ and $x/y$ is $y=\\sqrt{x}$. This choice makes both error contributions equal to $O(\\sqrt{x})$, and the total error is minimized to $O(\\sqrt{x})$.\n\nTherefore, the optimal choice for $y$ to minimize the error bound is $\\sqrt{x}$.", "answer": "$$\n\\boxed{\\sqrt{x}}\n$$", "id": "3081705"}]}