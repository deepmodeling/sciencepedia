{"hands_on_practices": [{"introduction": "This first exercise encourages you to think about Möbius inversion from an algebraic perspective. Rather than mechanically applying the inversion formula, you will use the concept of a Dirichlet inverse to solve for an unknown function $f$ in the equation $F = u * f$. This practice illuminates the structure of the ring of arithmetic functions and reveals an elegant relationship between the divisor function $\\tau$ and its sum over divisors [@problem_id:3081482].", "problem": "Let $F:\\mathbb{N}\\to\\mathbb{C}$ be the arithmetic function defined by $F(n)=\\sum_{d\\mid n}\\tau(d)$ for every $n\\in\\mathbb{N}$, where $\\tau(n)$ denotes the number of positive divisors of $n$. Let $*$ denote Dirichlet convolution on arithmetic functions, so that for arithmetic functions $g$ and $h$ one has $(g*h)(n)=\\sum_{d\\mid n}g(d)\\,h\\!\\left(\\frac{n}{d}\\right)$. Let $u$ denote the constant-one arithmetic function given by $u(n)=1$ for all $n\\in\\mathbb{N}$. Assume $F=u*f$ for some arithmetic function $f$. \n\nStarting from the foundational definitions of Dirichlet convolution and the standard properties of the Möbius function $\\mu(n)$, determine a closed-form description of $f(n)$ in terms of the prime power factorization of $n$ and evaluate $f(60)$. Then, decide whether $f$ is multiplicative and justify your conclusion from its structural description. Provide the final requested numerical value as $f(60)$.", "solution": "The problem gives two expressions for the arithmetic function $F$. First, from its definition, $F(n)=\\sum_{d\\mid n}\\tau(d)$ is equivalent to $F = \\tau * u$ in terms of Dirichlet convolution, where $u$ is the constant-one function ($u(n)=1$ for all $n$) and $\\tau$ is the divisor function. Second, we are given the relation $F = u * f$.\n\nEquating these two expressions gives the equation $u * f = \\tau * u$ in the ring of arithmetic functions. Since Dirichlet convolution is commutative, this is equivalent to $u * f = u * \\tau$. The constant-one function $u$ has a Dirichlet inverse (the Möbius function $\\mu$) because $u(1)=1 \\neq 0$. Convolving both sides of the equation on the left with $\\mu$ gives:\n$$ \\mu * (u * f) = \\mu * (u * \\tau) $$\nUsing the associativity of convolution, we get:\n$$ (\\mu * u) * f = (\\mu * u) * \\tau $$\nBy definition, $\\mu * u = \\varepsilon$, where $\\varepsilon$ is the identity element for convolution ($\\varepsilon(1)=1$ and $\\varepsilon(n)=0$ for $n>1$). The equation simplifies to:\n$$ \\varepsilon * f = \\varepsilon * \\tau $$\nConvolution with the identity element leaves a function unchanged, so we conclude that $f = \\tau$. The unknown function $f$ is the divisor function.\n\n**1. Closed-form description:**\nThe divisor function $\\tau(n)$ is multiplicative. For a prime power $p^a$, $\\tau(p^a) = a+1$. If the prime factorization of $n$ is $n = p_1^{a_1} p_2^{a_2} \\cdots p_k^{a_k}$, its closed form is:\n$$ f(n) = \\tau(n) = (a_1+1)(a_2+1)\\cdots(a_k+1) $$\n\n**2. Evaluation of $f(60)$:**\nThe prime factorization of $60$ is $60 = 2^2 \\cdot 3^1 \\cdot 5^1$. Using the formula:\n$$ f(60) = \\tau(60) = (2+1)(1+1)(1+1) = 3 \\cdot 2 \\cdot 2 = 12 $$\n\n**3. Multiplicativity:**\nThe function $f = \\tau$ is multiplicative. As shown by its structural description, if $m = p_1^{a_1} \\cdots p_k^{a_k}$ and $n = q_1^{b_1} \\cdots q_j^{b_j}$ are coprime (meaning the sets of primes $\\{p_i\\}$ and $\\{q_l\\}$ are disjoint), then $f(mn) = ((a_1+1)\\cdots(a_k+1))((b_1+1)\\cdots(b_j+1)) = f(m)f(n)$.\n\nThe final requested numerical value is $f(60)$.", "answer": "$$\n\\boxed{12}\n$$", "id": "3081482"}, {"introduction": "Möbius inversion is a cornerstone of combinatorial number theory, often used to solve counting problems via an inclusion-exclusion-like process. This practice guides you through a classic application involving Jordan's totient function, $J_2(n)$. You will first establish a simple sum over all divisors and then apply inversion to isolate the specific count you need, providing a clear demonstration of the formula's practical power in \"sifting\" through combinatorial sets [@problem_id:3081469].", "problem": "Let $J_{2}(n)$ denote the number of ordered pairs $(a,b)$ of integers with $1 \\leq a,b \\leq n$ such that the greatest common divisor (gcd) of $a$, $b$, and $n$ equals $1$. Assume familiarity with the Möbius function $\\mu(n)$ and the Möbius inversion formula. \n\n(a) Using the combinatorial interpretation of $J_{2}(n)$, justify a divisor-sum relation that expresses the total number $n^{2}$ of ordered pairs $(a,b)$ with $1 \\leq a,b \\leq n$ in terms of $J_{2}(d)$ for divisors $d$ of $n$.\n\n(b) Apply the Möbius inversion formula to the relation from part (a) to obtain an explicit expression for $J_{2}(n)$ in terms of $\\mu$ and a standard arithmetic function.\n\n(c) Evaluate $J_{2}(84)$ using the expression derived in part (b). Give your answer as an exact integer; no rounding is required.\n\n(d) Using the prime factorization $84 = 2^{2} \\cdot 3 \\cdot 7$, verify that the value obtained in part (c) agrees with the value computed by multiplicativity when $J_{2}(n)$ is evaluated on prime powers and extended to all $n$ via the multiplicative property. In your verification, compute the product over the prime powers dividing $84$ to confirm the result from part (c).", "solution": "This problem requires the analysis of the arithmetic function $J_{2}(n)$, a specific instance of Jordan's totient function. We will proceed by addressing each part of the problem sequentially.\n\n(a) To establish the divisor-sum relation, we consider the set $S$ of all ordered pairs of integers $(a,b)$ where $1 \\leq a,b \\leq n$. The total number of such pairs is $n \\times n = n^{2}$. We can partition this set $S$ into disjoint subsets based on the value of $d = \\gcd(a, b, n)$. Since $d$ must divide $a$, $b$, and $n$, it follows that $d$ must be a divisor of $n$. Therefore, we can write the following disjoint union:\n$$S = \\bigcup_{d|n} \\{(a,b) : 1 \\leq a,b \\leq n, \\gcd(a,b,n) = d\\}$$\nBy summing the sizes of these disjoint subsets, we obtain the size of $S$:\n$$n^{2} = \\sum_{d|n} |\\{(a,b) : 1 \\leq a,b \\leq n, \\gcd(a,b,n) = d\\}|$$\nLet's analyze the condition $\\gcd(a,b,n) = d$. For this to hold, $d$ must divide $a$ and $b$. We can write $a = da'$ and $b = db'$ for some integers $a'$ and $b'$. The constraints $1 \\leq a \\leq n$ and $1 \\leq b \\leq n$ imply $1 \\leq da' \\leq n$ and $1 \\leq db' \\leq n$, which simplifies to $1 \\leq a' \\leq n/d$ and $1 \\leq b' \\leq n/d$.\nThe gcd condition becomes $\\gcd(da', db', n) = d$. Let $n = dk$ for some integer $k$. Then the condition is $\\gcd(da', db', dk) = d$. Using the property $\\gcd(cx, cy, cz) = c \\cdot \\gcd(x, y, z)$, we have $d \\cdot \\gcd(a', b', n/d) = d$. This implies $\\gcd(a', b', n/d) = 1$.\nThe number of such pairs $(a',b')$ for a fixed $d$ is, by definition, $J_{2}(n/d)$. Thus, the size of the subset for a given $d$ is $J_{2}(n/d)$. Substituting this into our sum:\n$$n^{2} = \\sum_{d|n} J_{2}(n/d)$$\nAs $d$ runs through all divisors of $n$, the value $k = n/d$ also runs through all divisors of $n$. We can therefore re-index the sum by letting $d$ be the argument of $J_{2}$:\n$$n^{2} = \\sum_{d|n} J_{2}(d)$$\nThis is the required divisor-sum relation, expressing $n^{2}$ as a sum over the divisors of $n$.\n\n(b) The Möbius inversion formula states that if $f(n) = \\sum_{d|n} g(d)$, then $g(n) = \\sum_{d|n} \\mu(d) f(n/d)$, where $\\mu$ is the Möbius function.\nFrom part (a), we have the relation $n^{2} = \\sum_{d|n} J_{2}(d)$.\nWe can identify $f(n) = n^{2}$ and $g(n) = J_{2}(n)$. Applying the Möbius inversion formula directly yields the expression for $J_{2}(n)$:\n$$J_{2}(n) = \\sum_{d|n} \\mu(d) f(n/d)$$\n$$J_{2}(n) = \\sum_{d|n} \\mu(d) \\left(\\frac{n}{d}\\right)^{2}$$\nThis is the explicit expression for $J_{2}(n)$ in terms of the Möbius function $\\mu$ and the arithmetic function $f(n)=n^2$.\n\n(c) We are asked to evaluate $J_{2}(84)$ using the expression derived in part (b). The prime factorization of $84$ is $84 = 2^{2} \\cdot 3 \\cdot 7$.\nThe formula is $J_{2}(84) = \\sum_{d|84} \\mu(d) (84/d)^{2}$.\nThe Möbius function $\\mu(d)$ is non-zero only for square-free divisors $d$. The square-free divisors of $84$ are those formed by products of distinct primes from $\\{2, 3, 7\\}$.\nThe square-free divisors are $1$, $2$, $3$, $7$, $2 \\cdot 3 = 6$, $2 \\cdot 7 = 14$, $3 \\cdot 7 = 21$, and $2 \\cdot 3 \\cdot 7 = 42$.\nWe compute the corresponding values of $\\mu(d)$:\n$\\mu(1) = 1$\n$\\mu(2) = -1$, $\\mu(3) = -1$, $\\mu(7) = -1$\n$\\mu(6) = 1$, $\\mu(14) = 1$, $\\mu(21) = 1$\n$\\mu(42) = -1$\nNow we substitute these into the sum:\n$J_{2}(84) = \\mu(1)\\left(\\frac{84}{1}\\right)^{2} + \\mu(2)\\left(\\frac{84}{2}\\right)^{2} + \\mu(3)\\left(\\frac{84}{3}\\right)^{2} + \\mu(7)\\left(\\frac{84}{7}\\right)^{2} + \\mu(6)\\left(\\frac{84}{6}\\right)^{2} + \\mu(14)\\left(\\frac{84}{14}\\right)^{2} + \\mu(21)\\left(\\frac{84}{21}\\right)^{2} + \\mu(42)\\left(\\frac{84}{42}\\right)^{2}$\n$J_{2}(84) = 1 \\cdot 84^{2} - 1 \\cdot 42^{2} - 1 \\cdot 28^{2} - 1 \\cdot 12^{2} + 1 \\cdot 14^{2} + 1 \\cdot 6^{2} + 1 \\cdot 4^{2} - 1 \\cdot 2^{2}$\n$J_{2}(84) = 7056 - 1764 - 784 - 144 + 196 + 36 + 16 - 4$\nSumming the positive terms: $7056 + 196 + 36 + 16 = 7304$.\nSumming the absolute values of the negative terms: $1764 + 784 + 144 + 4 = 2696$.\n$J_{2}(84) = 7304 - 2696 = 4608$.\n\n(d) To verify the result using multiplicativity, we first note that $J_{k}(n)$ is a multiplicative function for any integer $k \\geq 1$. This means if $\\gcd(m,n)=1$, then $J_{k}(mn) = J_{k}(m)J_{k}(n)$.\nSince $84 = 4 \\cdot 3 \\cdot 7$, and the factors $4$, $3$, and $7$ are pairwise coprime, we have $J_{2}(84) = J_{2}(4) \\cdot J_{2}(3) \\cdot J_{2}(7)$.\nWe need the formula for $J_{2}(n)$ on prime powers, $n=p^{k}$. An equivalent form of the formula for $J_{2}(n)$ is $J_{2}(n) = n^{2}\\prod_{p|n}(1-p^{-2})$, where the product is over the distinct prime divisors of $n$.\nFor a prime power $n=p^{k}$, the only prime divisor is $p$.\nSo, $J_{2}(p^{k}) = (p^{k})^{2} (1 - p^{-2}) = p^{2k} (1 - \\frac{1}{p^{2}}) = p^{2k} \\frac{p^{2}-1}{p^{2}} = p^{2k-2}(p^{2}-1)$.\nWe now evaluate the components:\nFor $p^{k} = 4 = 2^{2}$ ($p=2, k=2$):\n$J_{2}(4) = J_{2}(2^{2}) = 2^{2(2)-2}(2^{2}-1) = 2^{2}(3) = 4 \\cdot 3 = 12$.\nFor $p^{k} = 3 = 3^{1}$ ($p=3, k=1$):\n$J_{2}(3) = J_{2}(3^{1}) = 3^{2(1)-2}(3^{2}-1) = 3^{0}(8) = 1 \\cdot 8 = 8$.\nFor $p^{k} = 7 = 7^{1}$ ($p=7, k=1$):\n$J_{2}(7) = J_{2}(7^{1}) = 7^{2(1)-2}(7^{2}-1) = 7^{0}(48) = 1 \\cdot 48 = 48$.\nFinally, we compute the product:\n$J_{2}(84) = J_{2}(4) \\cdot J_{2}(3) \\cdot J_{2}(7) = 12 \\cdot 8 \\cdot 48 = 96 \\cdot 48$.\n$96 \\cdot 48 = 96 \\cdot (50-2) = 4800 - 192 = 4608$.\nThis value matches the result of $4608$ obtained in part (c), thus verifying the calculation.", "answer": "$$\\boxed{4608}$$", "id": "3081469"}, {"introduction": "This final practice challenges you to generalize the concept of inversion beyond the standard Dirichlet convolution. By introducing the unitary convolution, this problem demonstrates that the inversion principle is a more fundamental algebraic idea. You will derive a new inversion formula from first principles, reinforcing that understanding the underlying structure allows you to adapt these powerful tools to new contexts [@problem_id:3081468].", "problem": "Let $f$ and $F$ be arithmetic functions on the positive integers with the relation\n$$\nF(n)=\\sum_{\\substack{d\\mid n \\\\ \\gcd(d,n/d)=1}} f(d),\n$$\nwhere $\\gcd$ denotes the greatest common divisor (GCD). Define the unitary convolution of arithmetic functions $h$ and $k$ by\n$$\n(h \\star_{u} k)(n) \\coloneqq \\sum_{\\substack{d\\mid n \\\\ \\gcd(d,n/d)=1}} h(d)\\,k(n/d),\n$$\nand let $u$ be the constant-one function $u(n)\\equiv 1$. The unitary Möbius function $\\mu^{\\ast}$ is defined as the inverse of $u$ under the unitary convolution, that is, the unique arithmetic function satisfying\n$$\n(u\\star_{u} \\mu^{\\ast})(n) = \\varepsilon(n),\n$$\nwhere $\\varepsilon$ is the identity for this convolution, given by $\\varepsilon(1)=1$ and $\\varepsilon(n)=0$ for $n1$. Starting from these definitions and standard properties of multiplicative functions and convolution, derive an inversion expressing $f$ in terms of $F$ and $\\mu^{\\ast}$.\n\nNow suppose $F$ is the sum-of-divisors function $\\sigma$, so that $F(n)=\\sigma(n)$ for all positive integers $n$. Compute the exact value of $f(72)$ implied by the above relation between $f$ and $F$. Your final answer must be a single exact number with no rounding.", "solution": "The solution proceeds in two parts as requested by the problem statement. First, we derive the general inversion formula. Second, we apply this formula to the specific case given.\n\n**Part 1: Derivation of the Inversion Formula**\n\nThe given relation is\n$$\nF(n)=\\sum_{\\substack{d\\mid n \\\\ \\gcd(d,n/d)=1}} f(d)\n$$\nThe summation is over the unitary divisors of $n$. A divisor $d$ of $n$ is called a unitary divisor if $\\gcd(d, n/d) = 1$. Let's denote the condition that $d$ is a unitary divisor of $n$ by $d \\mathrel{\\|} n$. The relation can be written as\n$$\nF(n) = \\sum_{d \\mathrel{\\|} n} f(d)\n$$\nWe are given the definition of the unitary convolution of two arithmetic functions $h$ and $k$:\n$$\n(h \\star_{u} k)(n) = \\sum_{d \\mathrel{\\|} n} h(d)k(n/d)\n$$\nLet's consider the unitary convolution of the function $f$ with the constant-one function $u(n)=1$.\n$$\n(f \\star_{u} u)(n) = \\sum_{d \\mathrel{\\|} n} f(d) u(n/d)\n$$\nSince $u(m)=1$ for any integer $m \\ge 1$, we have $u(n/d)=1$. Thus,\n$$\n(f \\star_{u} u)(n) = \\sum_{d \\mathrel{\\|} n} f(d) \\cdot 1 = \\sum_{d \\mathrel{\\|} n} f(d)\n$$\nComparing this with the given relation, we see that $F(n) = (f \\star_{u} u)(n)$. In terms of function identities, this is\n$$\nF = f \\star_{u} u\n$$\nThe set of arithmetic functions $g$ with $g(1) \\neq 0$ forms an abelian group under the unitary convolution $\\star_{u}$. The identity element is $\\varepsilon$, and the existence of inverses is guaranteed. The problem provides that $\\mu^{\\ast}$ is the inverse of $u$ with respect to $\\star_u$, meaning $u \\star_{u} \\mu^{\\ast} = \\varepsilon$.\n\nTo solve for $f$, we convolve both sides of the equation $F = f \\star_{u} u$ with $\\mu^{\\ast}$:\n$$\nF \\star_{u} \\mu^{\\ast} = (f \\star_{u} u) \\star_{u} \\mu^{\\ast}\n$$\nThe unitary convolution is associative, so we can regroup the terms on the right-hand side:\n$$\nF \\star_{u} \\mu^{\\ast} = f \\star_{u} (u \\star_{u} \\mu^{\\ast})\n$$\nUsing the defining property of $\\mu^{\\ast}$, we substitute $u \\star_{u} \\mu^{\\ast} = \\varepsilon$:\n$$\nF \\star_{u} \\mu^{\\ast} = f \\star_{u} \\varepsilon\n$$\nThe function $\\varepsilon$ is the identity element for the convolution. Let's verify this explicitly:\n$$\n(f \\star_{u} \\varepsilon)(n) = \\sum_{d \\mathrel{\\|} n} f(d) \\varepsilon(n/d)\n$$\nBy definition of $\\varepsilon$, the term $\\varepsilon(n/d)$ is non-zero only if $n/d = 1$, which implies $d=n$. The term is $1$ in this case. The divisor $d=n$ is always a unitary divisor of $n$, since $\\gcd(n, n/n) = \\gcd(n,1) = 1$. Therefore, the sum collapses to a single term corresponding to $d=n$:\n$$\n(f \\star_{u} \\varepsilon)(n) = f(n)\\varepsilon(1) = f(n) \\cdot 1 = f(n)\n$$\nSo, $f \\star_{u} \\varepsilon = f$. This gives us the desired inversion:\n$$\nf = F \\star_{u} \\mu^{\\ast}\n$$\nExpressed as a sum, the inversion formula is:\n$$\nf(n) = \\sum_{d \\mathrel{\\|} n} F(d) \\mu^{\\ast}(n/d)\n$$\nThis completes the derivation.\n\n**Part 2: Computation of $f(72)$**\n\nWe are given $F(n)=\\sigma(n)$, the sum-of-divisors function. We need to compute $f(72)$. Using the inversion formula:\n$$\nf(72) = \\sum_{d \\mathrel{\\|} 72} \\sigma(d) \\mu^{\\ast}(72/d)\n$$\nFirst, we find the unitary divisors of $72$. The prime factorization of $72$ is $72 = 8 \\times 9 = 2^3 \\cdot 3^2$. The unitary divisors are formed by taking products of the prime power blocks $2^3$ and $3^2$. The set of unitary divisors of $72$ is $\\{1, 2^3, 3^2, 2^3 \\cdot 3^2\\}$, which is $\\{1, 8, 9, 72\\}$.\n\nNext, we need the values of the function $\\mu^{\\ast}$. The function $\\mu^{\\ast}$ is the inverse of $u$ under $\\star_u$. Since $u$ is a multiplicative function, its inverse $\\mu^{\\ast}$ is also multiplicative. For a prime power $p^k$ with $k \\geq 1$, the unitary divisors are $1$ and $p^k$. The condition $(u \\star_u \\mu^{\\ast})(p^k) = \\varepsilon(p^k)$ gives:\n$$\n\\sum_{d \\mathrel{\\|} p^k} u(d)\\mu^{\\ast}(p^k/d) = 0 \\implies u(1)\\mu^{\\ast}(p^k) + u(p^k)\\mu^{\\ast}(1) = 0\n$$\nSince $\\mu^{\\ast}(1) = \\varepsilon(1) = 1$ and $u(n)=1$ for all $n$, this simplifies to $\\mu^{\\ast}(p^k) + 1 = 0$, so $\\mu^{\\ast}(p^k) = -1$ for any prime $p$ and integer $k \\ge 1$.\nFor a general integer $n = p_1^{k_1} \\cdots p_r^{k_r}$ with $r$ distinct prime factors, by multiplicativity:\n$$\n\\mu^{\\ast}(n) = \\mu^{\\ast}(p_1^{k_1}) \\cdots \\mu^{\\ast}(p_r^{k_r}) = (-1)^r = (-1)^{\\omega(n)}\n$$\nwhere $\\omega(n)$ is the number of distinct prime factors of $n$.\n\nNow we calculate the necessary values for $\\mu^{\\ast}$ and $\\sigma$:\nThe four terms in the sum for $f(72)$ correspond to $d \\in \\{1, 8, 9, 72\\}$:\n1.  For $d=1$: The term is $\\sigma(1)\\mu^{\\ast}(72)$.\n    $\\sigma(1) = 1$.\n    $\\mu^{\\ast}(72) = \\mu^{\\ast}(2^3 \\cdot 3^2) = (-1)^{\\omega(72)} = (-1)^2 = 1$.\n    Term: $1 \\cdot 1 = 1$.\n2.  For $d=8$: The term is $\\sigma(8)\\mu^{\\ast}(72/8) = \\sigma(8)\\mu^{\\ast}(9)$.\n    $\\sigma(8) = \\sigma(2^3) = \\frac{2^{3+1}-1}{2-1} = 15$.\n    $\\mu^{\\ast}(9) = \\mu^{\\ast}(3^2) = (-1)^{\\omega(9)} = (-1)^1 = -1$.\n    Term: $15 \\cdot (-1) = -15$.\n3.  For $d=9$: The term is $\\sigma(9)\\mu^{\\ast}(72/9) = \\sigma(9)\\mu^{\\ast}(8)$.\n    $\\sigma(9) = \\sigma(3^2) = \\frac{3^{2+1}-1}{3-1} = \\frac{26}{2} = 13$.\n    $\\mu^{\\ast}(8) = \\mu^{\\ast}(2^3) = (-1)^{\\omega(8)} = (-1)^1 = -1$.\n    Term: $13 \\cdot (-1) = -13$.\n4.  For $d=72$: The term is $\\sigma(72)\\mu^{\\ast}(72/72) = \\sigma(72)\\mu^{\\ast}(1)$.\n    $\\sigma(72) = \\sigma(2^3 \\cdot 3^2) = \\sigma(2^3)\\sigma(3^2) = 15 \\cdot 13 = 195$.\n    $\\mu^{\\ast}(1) = (-1)^{\\omega(1)} = (-1)^0 = 1$.\n    Term: $195 \\cdot 1 = 195$.\n\nFinally, we sum these four terms to find $f(72)$:\n$$\nf(72) = 1 + (-15) + (-13) + 195 = 1 - 15 - 13 + 195 = 196 - 28 = 168\n$$", "answer": "$$\\boxed{168}$$", "id": "3081468"}]}