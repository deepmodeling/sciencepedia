{"hands_on_practices": [{"introduction": "The Chinese Remainder Theorem (CRT) guarantees a unique solution to a system of congruences with pairwise coprime moduli, but how do we actually find it? This first practice takes you behind the curtain of the theorem's constructive proof. By building a \"reconstruction blueprint\" from first principles, you will create the fundamental components that can be linearly combined to solve for any set of residues, making the abstract theorem a concrete computational tool. [@problem_id:3081036]", "problem": "In a distributed storage setting, an unknown nonnegative integer $x$ is encoded redundantly by storing its residues modulo $3$, $5$, and $7$. You are tasked with designing a reusable numeric reconstruction blueprint based on first principles and then applying it in a concrete instance.\n\nStarting only from the following foundational facts:\n- If integers $m_1,\\dots,m_k$ are pairwise coprime, then for any residues $r_1,\\dots,r_k$ there exists a unique solution modulo $M=m_1\\cdots m_k$ to the simultaneous congruences $x\\equiv r_i \\pmod{m_i}$ (Chinese Remainder Theorem (CRT)).\n- Bézout’s identity: for coprime integers $a$ and $b$, there exist integers $u$ and $v$ such that $au+bv=1$.\n\nComplete the following tasks:\n1) Construct explicit integers $b_3,b_5,b_7$ in the range $\\{0,1,\\dots,104\\}$ such that $b_3\\equiv 1 \\pmod{3}$ and $b_3\\equiv 0 \\pmod{5}$ and $b_3\\equiv 0 \\pmod{7}$; $b_5\\equiv 0 \\pmod{3}$ and $b_5\\equiv 1 \\pmod{5}$ and $b_5\\equiv 0 \\pmod{7}$; $b_7\\equiv 0 \\pmod{3}$ and $b_7\\equiv 0 \\pmod{5}$ and $b_7\\equiv 1 \\pmod{7}$. These integers constitute a reusable numeric reconstruction blueprint in the sense that, once determined, they can be combined linearly with any triple of residues $(r_3,r_5,r_7)$ to yield the unique solution modulo $105$.\n2) Using your blueprint, reconstruct the unique $x\\in[0,105)$ that satisfies $x\\equiv 2 \\pmod{3}$, $x\\equiv 4 \\pmod{5}$, and $x\\equiv 3 \\pmod{7}$.\n3) Justify from the foundational facts why your reconstructed $x$ is unique in the interval $[0,105)$.\n\nReport only the value of $x$ as your final numeric answer. No rounding is required.", "solution": "The problem requires the solution of a system of linear congruences using the principles of the Chinese Remainder Theorem (CRT). The moduli are $m_1 = 3$, $m_2 = 5$, and $m_3 = 7$. These are pairwise coprime integers. The product modulus is $M = m_1 m_2 m_3 = 3 \\times 5 \\times 7 = 105$. The solution is developed in three stages as prescribed.\n\n**1) Construction of the Numeric Reconstruction Blueprint**\n\nThe core of the constructive proof of the CRT is to find a set of integers $b_3, b_5, b_7$, where each $b_i$ is congruent to $1$ modulo $m_i$ and $0$ modulo $m_j$ for $j \\neq i$.\n\n- **Calculation of $b_3$**:\nWe require $b_3 \\equiv 1 \\pmod{3}$, $b_3 \\equiv 0 \\pmod{5}$, and $b_3 \\equiv 0 \\pmod{7}$. The latter two congruences imply that $b_3$ must be a multiple of the product $5 \\times 7 = 35$, as $5$ and $7$ are coprime. We can write $b_3 = 35k$ for some integer $k$. Substituting this into the first congruence gives:\n$$35k \\equiv 1 \\pmod{3}$$\nSince $35 = 11 \\times 3 + 2$, we have $35 \\equiv 2 \\pmod{3}$. The congruence simplifies to:\n$$2k \\equiv 1 \\pmod{3}$$\nTo solve for $k$, we find the multiplicative inverse of $2$ modulo $3$. Finding such an inverse is guaranteed by Bézout's identity for the coprime integers $2$ and $3$. By inspection, we see that $2 \\times 2 = 4 \\equiv 1 \\pmod{3}$, so the inverse of $2$ modulo $3$ is $2$. Multiplying the congruence by $2$:\n$$2(2k) \\equiv 2(1) \\pmod{3} \\implies 4k \\equiv 2 \\pmod{3} \\implies k \\equiv 2 \\pmod{3}$$\nWe select the smallest non-negative integer $k$, so $k=2$. This yields $b_3 = 35 \\times 2 = 70$. This value lies in the required range $\\{0, 1, \\dots, 104\\}$.\n\n- **Calculation of $b_5$**:\nWe require $b_5 \\equiv 0 \\pmod{3}$, $b_5 \\equiv 1 \\pmod{5}$, and $b_5 \\equiv 0 \\pmod{7}$. This means $b_5$ must be a multiple of $3 \\times 7 = 21$. So, $b_5 = 21k$. Substituting into the second congruence:\n$$21k \\equiv 1 \\pmod{5}$$\nSince $21 = 4 \\times 5 + 1$, we have $21 \\equiv 1 \\pmod{5}$. The congruence becomes:\n$$k \\equiv 1 \\pmod{5}$$\nChoosing $k=1$, we find $b_5 = 21 \\times 1 = 21$. This value is in the required range.\n\n- **Calculation of $b_7$**:\nWe require $b_7 \\equiv 0 \\pmod{3}$, $b_7 \\equiv 0 \\pmod{5}$, and $b_7 \\equiv 1 \\pmod{7}$. This means $b_7$ must be a multiple of $3 \\times 5 = 15$. So, $b_7 = 15k$. Substituting into the third congruence:\n$$15k \\equiv 1 \\pmod{7}$$\nSince $15 = 2 \\times 7 + 1$, we have $15 \\equiv 1 \\pmod{7}$. The congruence becomes:\n$$k \\equiv 1 \\pmod{7}$$\nChoosing $k=1$, we find $b_7 = 15 \\times 1 = 15$. This value is in the required range.\n\nThe resulting numeric reconstruction blueprint consists of the integers $b_3 = 70$, $b_5 = 21$, and $b_7 = 15$.\n\n**2) Reconstruction of $x$**\n\nWe are asked to find the unique integer $x \\in [0, 105)$ that satisfies the system of congruences:\n$$x \\equiv 2 \\pmod{3}$$\n$$x \\equiv 4 \\pmod{5}$$\n$$x \\equiv 3 \\pmod{7}$$\nThe solution $x$ can be constructed as a linear combination of the blueprint integers $b_i$ weighted by the corresponding residues $r_i$:\n$$x = r_3 b_3 + r_5 b_5 + r_7 b_7$$\nAny such $x$ satisfies the congruences. For example, modulo $3$, $x \\equiv r_3(1) + r_5(0) + r_7(0) \\equiv r_3 \\pmod{3}$. The same logic applies to moduli $5$ and $7$.\nSubstituting the given residues $r_3 = 2$, $r_5 = 4$, $r_7 = 3$ and the calculated $b_i$ values:\n$$x' = (2)(70) + (4)(21) + (3)(15) = 140 + 84 + 45 = 269$$\nTo find the unique solution in the interval $[0, 105)$, we take the result modulo $105$:\n$$x \\equiv 269 \\pmod{105}$$\nSince $269 = 2 \\times 105 + 59$, the remainder is $59$.\nThus, the unique solution is $x = 59$.\n\n**3) Justification of Uniqueness**\n\nThe uniqueness of the solution in the interval $[0, M)$ is a cornerstone of the Chinese Remainder Theorem. This can be justified from the foundational facts.\nLet's assume there exist two distinct solutions, $x_1$ and $x_2$, within the interval $[0, 105)$. Both solutions must satisfy the given congruences:\n$$x_1 \\equiv r_i \\pmod{m_i} \\quad \\text{and} \\quad x_2 \\equiv r_i \\pmod{m_i} \\quad \\text{for } i \\in \\{1,2,3\\}$$\nBy subtracting the congruences for $x_2$ from those for $x_1$, we get:\n$$x_1 - x_2 \\equiv 0 \\pmod{3}$$\n$$x_1 - x_2 \\equiv 0 \\pmod{5}$$\n$$x_1 - x_2 \\equiv 0 \\pmod{7}$$\nThese congruences mean that the difference $x_1 - x_2$ is a multiple of $3$, $5$, and $7$. Since $3$, $5$, and $7$ are pairwise coprime, their least common multiple is their product, $M=105$. Therefore, $x_1 - x_2$ must be a multiple of $105$. We can write this as:\n$$x_1 - x_2 \\equiv 0 \\pmod{105}$$\nSince both $x_1$ and $x_2$ are in the interval $[0, 105)$, they satisfy $0 \\le x_1  105$ and $0 \\le x_2  105$. Their difference must therefore be in the range $-105  x_1 - x_2  105$. The only integer in this range that is a multiple of $105$ is $0$.\nHence, $x_1 - x_2 = 0$, which implies $x_1 = x_2$.\nThis contradicts the assumption that $x_1$ and $x_2$ are distinct solutions. Therefore, the solution in the interval $[0, 105)$ must be unique.", "answer": "$$\\boxed{59}$$", "id": "3081036"}, {"introduction": "The utility of the Chinese Remainder Theorem extends far beyond solving simple linear systems; its true power lies in its ability to decompose a problem modulo a composite number into simpler problems modulo its prime factors. This exercise demonstrates this \"divide and conquer\" strategy by tackling quadratic congruences. You will see how to find all solutions to an equation like $x^2 \\equiv a \\pmod{n}$ by first solving it modulo the prime factors of $n$ and then using the CRT to elegantly stitch the partial solutions back together into a complete solution set. [@problem_id:3081017]", "problem": "Let $p$ and $q$ be distinct odd primes, let $n=pq$, and let $a$ be an integer that is a quadratic residue modulo both $p$ and $q$. Starting only from the definition of congruence modulo $m$, basic properties of units in the ring $\\mathbb{Z}/m\\mathbb{Z}$, Fermat's little theorem, Euler's criterion, and the statement of the Chinese Remainder Theorem (CRT), derive a computational procedure that constructs all solutions of $x^{2}\\equiv a \\pmod{n}$ by combining the square roots of $a$ modulo $p$ and modulo $q$ and then lifting them to modulo $n$ via CRT. Apply your derivation to the specific instance $p=11$, $q=19$, $n=209$, and $a=5$. Compute the complete set of four residue classes $x\\in\\{0,1,\\dots,n-1\\}$ satisfying $x^{2}\\equiv 5 \\pmod{209}$ and report them in increasing order.\n\nExpress your final answer as a single row matrix using the $\\mathrm{pmatrix}$ environment, with entries listed in increasing order. No rounding is required.", "solution": "The problem is well-posed and scientifically grounded in the principles of elementary number theory. It provides all necessary information and is free from any contradictions or ambiguities. We may therefore proceed with a solution.\n\nThe problem asks for a computational procedure to find all solutions to the congruence $x^{2}\\equiv a \\pmod{n}$, where $n=pq$ for distinct odd primes $p$ and $q$, and $a$ is an integer that is a quadratic residue modulo both $p$ and $q$. This procedure is then to be applied to a specific instance.\n\n**1. Derivation of the General Procedure**\n\nLet the given congruence be $x^{2}\\equiv a \\pmod{n}$. Since $n=pq$ and $p, q$ are distinct primes, they are coprime. By the definition of congruence, $n | (x^{2} - a)$, which implies $p | (x^{2} - a)$ and $q | (x^{2} - a)$. This is equivalent to the system of congruences:\n$$\n\\begin{cases}\nx^{2} \\equiv a \\pmod{p} \\\\\nx^{2} \\equiv a \\pmod{q}\n\\end{cases}\n$$\nThe problem states that $a$ is a quadratic residue modulo both $p$ and $q$. Since $p$ and $q$ are odd primes, and $a$ is a quadratic residue, the Legendre symbols $(\\frac{a}{p})$ and $(\\frac{a}{q})$ must both be equal to $1$. This implies that $a \\not\\equiv 0 \\pmod{p}$ and $a \\not\\equiv 0 \\pmod{q}$. Consequently, each of these quadratic congruences has exactly two distinct solutions.\n\nLet the solutions to $y^{2} \\equiv a \\pmod{p}$ be $y \\equiv \\pm s_p \\pmod{p}$.\nLet the solutions to $z^{2} \\equiv a \\pmod{q}$ be $z \\equiv \\pm s_q \\pmod{q}$.\n\nThe problem of finding $x$ satisfying $x^2 \\equiv a \\pmod{n}$ is now reduced to finding $x$ that simultaneously satisfies one of the four possible pairs of linear congruences:\n$$\n\\text{System 1: } \\begin{cases} x \\equiv s_p \\pmod{p} \\\\ x \\equiv s_q \\pmod{q} \\end{cases}\n\\quad\n\\text{System 2: } \\begin{cases} x \\equiv s_p \\pmod{p} \\\\ x \\equiv -s_q \\pmod{q} \\end{cases}\n$$\n$$\n\\text{System 3: } \\begin{cases} x \\equiv -s_p \\pmod{p} \\\\ x \\equiv s_q \\pmod{q} \\end{cases}\n\\quad\n\\text{System 4: } \\begin{cases} x \\equiv -s_p \\pmod{p} \\\\ x \\equiv -s_q \\pmod{q} \\end{cases}\n$$\nThe Chinese Remainder Theorem (CRT) guarantees that for each of these systems, there exists a unique solution for $x$ modulo $n=pq$.\n\nTo construct these solutions, we first find integers $u$ and $v$ that satisfy Bézout's identity: $up + vq = 1$. This can be done using the Extended Euclidean Algorithm. From this identity, we have $vq \\equiv 1 \\pmod{p}$ and $up \\equiv 1 \\pmod{q}$.\n\nFor a general system of the form $x \\equiv c_1 \\pmod{p}$ and $x \\equiv c_2 \\pmod{q}$, the solution is given by the formula:\n$$\nx \\equiv c_1(vq) + c_2(up) \\pmod{pq}\n$$\nWe verify this construction:\nModulo $p$: $x \\equiv c_1(vq) + c_2(up) \\equiv c_1(1) + c_2(0) \\equiv c_1 \\pmod{p}$.\nModulo $q$: $x \\equiv c_1(vq) + c_2(up) \\equiv c_1(0) + c_2(1) \\equiv c_2 \\pmod{q}$.\n\nApplying this construction to the four systems yields the four distinct solutions for $x^2 \\equiv a \\pmod{n}$.\n\n**2. Application to the Specific Instance**\n\nWe are given $p=11$, $q=19$, $n=pq=209$, and $a=5$. We must find all $x \\in \\{0, 1, \\dots, 208\\}$ such that $x^{2} \\equiv 5 \\pmod{209}$.\n\n**Step 2a: Solve for roots modulo $p=11$.**\nWe need to solve $x^2 \\equiv 5 \\pmod{11}$. Both $p=11$ and $q=19$ are primes congruent to $3 \\pmod{4}$. For such a prime $p$, the square roots of a quadratic residue $a$ are given by $\\pm a^{(p+1)/4} \\pmod{p}$.\nFor $p=11$, the exponent is $(11+1)/4 = 3$.\nSo, the roots are $\\pm 5^3 \\pmod{11}$.\n$5^2 = 25 \\equiv 3 \\pmod{11}$.\n$5^3 = 5 \\cdot 5^2 \\equiv 5 \\cdot 3 = 15 \\equiv 4 \\pmod{11}$.\nThus, $s_p = 4$. The two solutions are $x \\equiv 4 \\pmod{11}$ and $x \\equiv -4 \\equiv 7 \\pmod{11}$.\n\n**Step 2b: Solve for roots modulo $q=19$.**\nWe need to solve $x^2 \\equiv 5 \\pmod{19}$.\nFor $q=19$, the exponent is $(19+1)/4 = 5$.\nSo, the roots are $\\pm 5^5 \\pmod{19}$.\n$5^2 = 25 \\equiv 6 \\pmod{19}$.\n$5^4 \\equiv 6^2 = 36 \\equiv 17 \\equiv -2 \\pmod{19}$.\n$5^5 = 5 \\cdot 5^4 \\equiv 5 \\cdot (-2) = -10 \\equiv 9 \\pmod{19}$.\nThus, $s_q = 9$. The two solutions are $x \\equiv 9 \\pmod{19}$ and $x \\equiv -9 \\equiv 10 \\pmod{19}$.\n\n**Step 2c: Find coefficients for CRT.**\nWe must find integers $u, v$ such that $11u + 19v = 1$. Using the Extended Euclidean Algorithm:\n$19 = 1 \\cdot 11 + 8$\n$11 = 1 \\cdot 8 + 3$\n$8 = 2 \\cdot 3 + 2$\n$3 = 1 \\cdot 2 + 1$\nWorking backwards:\n$1 = 3 - 1 \\cdot 2 = 3 - (8 - 2 \\cdot 3) = 3 \\cdot 3 - 8$\n$1 = 3(11 - 8) - 8 = 3 \\cdot 11 - 4 \\cdot 8$\n$1 = 3 \\cdot 11 - 4(19 - 1 \\cdot 11) = 3 \\cdot 11 - 4 \\cdot 19 + 4 \\cdot 11 = 7 \\cdot 11 - 4 \\cdot 19$.\nSo we have $u=7$ and $v=-4$.\nThe CRT lifting terms are $up = 7 \\cdot 11 = 77$ and $vq = -4 \\cdot 19 = -76$.\n\n**Step 2d: Construct the four solutions modulo $209$.**\nThe general solution form is $x \\equiv c_1(-76) + c_2(77) \\pmod{209}$, where $c_1$ is a root modulo $11$ and $c_2$ is a root modulo $19$.\n\nSystem 1: $c_1=4, c_2=9$.\n$x_1 \\equiv 4(-76) + 9(77) \\pmod{209}$\n$x_1 \\equiv -304 + 693 \\pmod{209}$\n$x_1 \\equiv (-209 - 95) + (3 \\cdot 209 + 66) \\pmod{209}$\n$x_1 \\equiv -95 + 66 = -29 \\equiv 180 \\pmod{209}$.\n\nSystem 2: $c_1=4, c_2=10$.\n$x_2 \\equiv 4(-76) + 10(77) \\pmod{209}$\n$x_2 \\equiv -304 + 770 \\pmod{209}$\n$x_2 \\equiv -95 + (3 \\cdot 209 + 143) \\pmod{209}$\n$x_2 \\equiv -95 + 143 = 48 \\pmod{209}$.\n\nSystem 3: $c_1=7, c_2=9$.\n$x_3 \\equiv 7(-76) + 9(77) \\pmod{209}$\n$x_3 \\equiv -532 + 693 \\pmod{209}$\n$x_3 \\equiv (-3 \\cdot 209 + 95) + 66 \\pmod{209}$\n$x_3 \\equiv 95 + 66 = 161 \\pmod{209}$.\nNote that $x_3 \\equiv -x_2 \\pmod{209}$ since the roots are $( -s_p, s_q )$ and $( s_p, -s_q )$ respectively. Indeed, $161 + 48 = 209 \\equiv 0 \\pmod{209}$.\n\nSystem 4: $c_1=7, c_2=10$.\n$x_4 \\equiv 7(-76) + 10(77) \\pmod{209}$\n$x_4 \\equiv -532 + 770 \\pmod{209}$\n$x_4 \\equiv 95 + 143 = 238 \\pmod{209}$\n$x_4 \\equiv 29 \\pmod{209}$.\nNote that $x_4 \\equiv -x_1 \\pmod{209}$ since the roots are $( -s_p, -s_q )$ and $( s_p, s_q )$ respectively. Indeed, $29 + 180 = 209 \\equiv 0 \\pmod{209}$.\n\nThe four solutions for $x$ in the set $\\{0, 1, \\dots, 208\\}$ are $29$, $48$, $161$, and $180$.\nWe verify one solution: $29^2 = 841 = 4 \\cdot 209 + 5$, so $29^2 \\equiv 5 \\pmod{209}$. Since the other solutions are $\\pm 29 \\pmod{209}$ and $\\pm 48 \\pmod{209}$, their squares will also be congruent to $5 \\pmod{209}$.\n\nArranging the solutions in increasing order, we obtain $29, 48, 161, 180$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 29  48  161  180 \\end{pmatrix}}\n$$", "id": "3081017"}, {"introduction": "While the standard parallel construction of the CRT solution is elegant, an alternative sequential approach known as Mixed Radix Conversion is often more efficient in computational practice. This method represents a number in a system where the bases are the moduli themselves, an idea closely related to place-value notation. This practice challenges you to derive the algorithm for converting from a residue vector to these \"mixed radix digits,\" providing deep insight into an important technique used in computer arithmetic and cryptography. [@problem_id:3081044]", "problem": "Consider the setting of the Chinese Remainder Theorem (CRT) for pairwise coprime moduli. Let $p_1$, $p_2$, $p_3$ be distinct primes and let $M = p_1 p_2 p_3$. For any integer $x$ with $0 \\leq x  M$, define its residue vector $(r_1, r_2, r_3)$ by $r_i \\equiv x \\pmod{p_i}$, and its mixed radix digits $(a_1, a_2, a_3)$ to be the unique integers such that $0 \\leq a_i  p_i$ for $i \\in \\{1,2,3\\}$ and\n$$\nx = a_1 + a_2 p_1 + a_3 p_1 p_2.\n$$\nStarting from the core statement of CRT (existence and uniqueness of $x \\bmod M$ given $(r_1, r_2, r_3)$) and the definitions above (no other pre-specified formulas), do the following:\n\n- Derive a constructive blueprint that, given $(r_1, r_2, r_3)$, computes the mixed radix digits $(a_1, a_2, a_3)$, justifying each step by modular arithmetic and the existence of multiplicative inverses modulo primes.\n- Derive the forward conversion from mixed radix digits $(a_1, a_2, a_3)$ back to the residue vector $(r_1, r_2, r_3)$, and prove that composing the two conversions (residues to mixed radix to integer $x$, then back to residues) recovers the same $x$ and the original $(r_1, r_2, r_3)$.\n- Implement your blueprint concretely for the small prime moduli $p_1 = 7$, $p_2 = 11$, $p_3 = 13$ and the residue vector $(r_1, r_2, r_3) = (5, 8, 12)$. Compute the mixed radix digits $(a_1, a_2, a_3)$, then compute the corresponding $x$ with $0 \\leq x  M$, and verify your forward conversion gives $(5, 8, 12)$.\n\nExpress your final answer as the single integer $x$ in the interval $[0, M)$; no rounding is required.", "solution": "The problem is well-posed and scientifically sound, resting on foundational principles of number theory, namely the Chinese Remainder Theorem (CRT) and mixed radix representations. We can proceed with a full derivation and solution.\n\nThe problem requires a three-part analysis: first, to derive a method for converting from a residue representation to a mixed radix representation; second, to derive the reverse conversion and verify consistency; and third, to apply this method to a specific numerical example.\n\nLet the distinct prime moduli be $p_1$, $p_2$, and $p_3$. Let $M = p_1 p_2 p_3$. We are given an integer $x$ in the range $0 \\leq x  M$.\nIts residue vector is $(r_1, r_2, r_3)$, where $x \\equiv r_i \\pmod{p_i}$ for $i \\in \\{1, 2, 3\\}$.\nIts mixed radix representation is given by $x = a_1 + a_2 p_1 + a_3 p_1 p_2$, where $a_i$ are integer digits satisfying $0 \\leq a_i  p_i$.\n\nFirst, we derive the constructive blueprint to determine the mixed radix digits $(a_1, a_2, a_3)$ from the residue vector $(r_1, r_2, r_3)$. This is achieved by considering the equation for $x$ under each modulus sequentially.\n\nTo find $a_1$, we take the equation for $x$ modulo $p_1$:\n$$x \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_1}$$\nSince $a_2 p_1$ and $a_3 p_1 p_2$ are multiples of $p_1$, they are congruent to $0 \\pmod{p_1}$. The equation simplifies to:\n$$x \\equiv a_1 \\pmod{p_1}$$\nWe are given that $x \\equiv r_1 \\pmod{p_1}$. Therefore, $a_1 \\equiv r_1 \\pmod{p_1}$.\nGiven the constraint $0 \\leq a_1  p_1$ and knowing that $r_1$ is a remainder (typically $0 \\leq r_1  p_1$), we uniquely determine $a_1$:\n$$a_1 = r_1$$\n\nNext, to find $a_2$, we take the equation for $x$ modulo $p_2$:\n$$x \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_2}$$\nThe term $a_3 p_1 p_2$ is a multiple of $p_2$, so it is congruent to $0 \\pmod{p_2}$. The equation simplifies to:\n$$x \\equiv a_1 + a_2 p_1 \\pmod{p_2}$$\nUsing the given residue $x \\equiv r_2 \\pmod{p_2}$, we have:\n$$r_2 \\equiv a_1 + a_2 p_1 \\pmod{p_2}$$\nWe can rearrange this congruence to solve for $a_2$:\n$$a_2 p_1 \\equiv r_2 - a_1 \\pmod{p_2}$$\nTo isolate $a_2$, we must multiply by the multiplicative inverse of $p_1$ modulo $p_2$. This inverse, denoted as $(p_1^{-1} \\pmod{p_2})$, exists and is unique because $p_1$ and $p_2$ are distinct primes, which implies their greatest common divisor is $\\gcd(p_1, p_2) = 1$.\n$$a_2 \\equiv (r_2 - a_1) (p_1^{-1} \\pmod{p_2}) \\pmod{p_2}$$\nThe constraint $0 \\leq a_2  p_2$ ensures that $a_2$ is the unique integer satisfying this congruence in the specified range.\n\nFinally, to find $a_3$, we take the equation for $x$ modulo $p_3$:\n$$x \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_3}$$\nUsing the given residue $x \\equiv r_3 \\pmod{p_3}$, we get:\n$$r_3 \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_3}$$\nRearranging to solve for $a_3$:\n$$a_3 p_1 p_2 \\equiv r_3 - a_1 - a_2 p_1 \\pmod{p_3}$$\nTo isolate $a_3$, we multiply by the multiplicative inverse of $p_1 p_2$ modulo $p_3$. This inverse, $((p_1 p_2)^{-1} \\pmod{p_3})$, exists because $p_1, p_2, p_3$ are distinct primes, so $\\gcd(p_1, p_3) = 1$ and $\\gcd(p_2, p_3) = 1$, which means $\\gcd(p_1 p_2, p_3) = 1$. The inverse can be computed as $(p_1^{-1} \\pmod{p_3}) (p_2^{-1} \\pmod{p_3})$.\n$$a_3 \\equiv (r_3 - a_1 - a_2 p_1) ((p_1 p_2)^{-1} \\pmod{p_3}) \\pmod{p_3}$$\nThe constraint $0 \\leq a_3  p_3$ again ensures $a_3$ is uniquely determined. This completes the blueprint.\n\nSecond, we derive the forward conversion from mixed radix digits $(a_1, a_2, a_3)$ to the residue vector $(r_1, r_2, r_3)$ and prove consistency. Given $(a_1, a_2, a_3)$, $x$ is defined as $x = a_1 + a_2 p_1 + a_3 p_1 p_2$.\nThe residues are computed as follows:\n$r_1 = x \\pmod{p_1} \\equiv (a_1 + a_2 p_1 + a_3 p_1 p_2) \\pmod{p_1} \\equiv a_1 \\pmod{p_1}$. Since $0 \\le a_1  p_1$, $r_1=a_1$.\n$r_2 = x \\pmod{p_2} \\equiv (a_1 + a_2 p_1 + a_3 p_1 p_2) \\pmod{p_2} \\equiv (a_1 + a_2 p_1) \\pmod{p_2}$.\n$r_3 = x \\pmod{p_3} \\equiv (a_1 + a_2 p_1 + a_3 p_1 p_2) \\pmod{p_3}$.\n\nTo prove consistency, we show that starting with a residue vector $(r'_1, r'_2, r'_3)$, applying our blueprint to get $(a_1, a_2, a_3)$, constructing $x$, and then finding its residues $(r_1, r_2, r_3)$ returns the original vector.\nFrom the blueprint, we have $a_1=r'_1$, $a_2 \\equiv (r'_2 - a_1) (p_1^{-1} \\pmod{p_2}) \\pmod{p_2}$, and $a_3 \\equiv (r'_3 - a_1 - a_2 p_1) ((p_1 p_2)^{-1} \\pmod{p_3}) \\pmod{p_3}$.\nLet's find the residues of $x = a_1 + a_2 p_1 + a_3 p_1 p_2$.\n$r_1 \\equiv x \\pmod{p_1} \\equiv a_1 \\pmod{p_1}$. Since $a_1 = r'_1$, we have $r_1 \\equiv r'_1 \\pmod{p_1}$. As both are in $[0, p_1-1]$, $r_1 = r'_1$.\n$r_2 \\equiv x \\pmod{p_2} \\equiv a_1 + a_2 p_1 \\pmod{p_2}$. From the definition of $a_2$, we have $a_2 p_1 \\equiv r'_2 - a_1 \\pmod{p_2}$. Substituting this gives $r_2 \\equiv a_1 + (r'_2 - a_1) \\pmod{p_2} \\equiv r'_2 \\pmod{p_2}$. As both are in $[0, p_2-1]$, $r_2 = r'_2$.\n$r_3 \\equiv x \\pmod{p_3} \\equiv a_1 + a_2 p_1 + a_3 p_1 p_2 \\pmod{p_3}$. From the definition of $a_3$, we have $a_3 p_1 p_2 \\equiv r'_3 - a_1 - a_2 p_1 \\pmod{p_3}$. Substituting this gives $r_3 \\equiv (a_1 + a_2 p_1) + (r'_3 - a_1 - a_2 p_1) \\pmod{p_3} \\equiv r'_3 \\pmod{p_3}$. As both are in $[0, p_3-1]$, $r_3 = r'_3$.\nThe recovered residue vector $(r_1, r_2, r_3)$ is identical to the original vector $(r'_1, r'_2, r'_3)$. The uniqueness of $x$ modulo $M$ guaranteed by the CRT ensures the constructed $x$ is the correct integer.\n\nThird, we implement this blueprint for the given numerical example: $p_1 = 7, p_2 = 11, p_3 = 13$ and $(r_1, r_2, r_3) = (5, 8, 12)$. The modulus is $M = 7 \\times 11 \\times 13 = 1001$.\n\n1.  Compute $a_1$:\n    $a_1 = r_1 = 5$.\n\n2.  Compute $a_2$:\n    $a_2 \\equiv (r_2 - a_1) (p_1^{-1} \\pmod{p_2}) \\pmod{p_2}$\n    $a_2 \\equiv (8 - 5) (7^{-1} \\pmod{11}) \\pmod{11}$\n    $a_2 \\equiv 3 \\cdot (7^{-1} \\pmod{11}) \\pmod{11}$.\n    To find $7^{-1} \\pmod{11}$, we seek an integer $y$ such that $7y \\equiv 1 \\pmod{11}$. By inspection, $7 \\times 8 = 56 = 5 \\times 11 + 1$, so $7^{-1} \\pmod{11} = 8$.\n    $a_2 \\equiv 3 \\times 8 \\pmod{11} \\equiv 24 \\pmod{11} \\equiv 2 \\pmod{11}$.\n    So, $a_2 = 2$.\n\n3.  Compute $a_3$:\n    $a_3 \\equiv (r_3 - a_1 - a_2 p_1) ((p_1 p_2)^{-1} \\pmod{p_3}) \\pmod{p_3}$\n    $a_3 \\equiv (12 - 5 - 2 \\cdot 7) ((7 \\cdot 11)^{-1} \\pmod{13}) \\pmod{13}$\n    $a_3 \\equiv (12 - 5 - 14) (77^{-1} \\pmod{13}) \\pmod{13}$\n    $a_3 \\equiv -7 \\cdot (77^{-1} \\pmod{13}) \\pmod{13}$.\n    First, we simplify the terms modulo $13$:\n    $-7 \\equiv 6 \\pmod{13}$.\n    $77 = 5 \\times 13 + 12$, so $77 \\equiv 12 \\equiv -1 \\pmod{13}$.\n    The inverse is $(77^{-1} \\pmod{13}) \\equiv (-1)^{-1} \\pmod{13} \\equiv -1 \\equiv 12 \\pmod{13}$.\n    Substituting these back:\n    $a_3 \\equiv 6 \\times 12 \\pmod{13} \\equiv 72 \\pmod{13}$.\n    Since $72 = 5 \\times 13 + 7$, we have $a_3 \\equiv 7 \\pmod{13}$.\n    So, $a_3 = 7$.\n\nThe mixed radix digits are $(a_1, a_2, a_3) = (5, 2, 7)$.\n\nNow, we compute the integer $x$:\n$x = a_1 + a_2 p_1 + a_3 p_1 p_2$\n$x = 5 + 2(7) + 7(7 \\cdot 11)$\n$x = 5 + 14 + 7(77)$\n$x = 19 + 539$\n$x = 558$.\n\nWe must verify that this value of $x$ is in the correct range, $0 \\leq 558  1001$, which it is. Finally, we verify its residues:\n$x \\pmod{7} \\equiv 558 \\pmod{7}$. Since $558 = 79 \\times 7 + 5$, $558 \\equiv 5 \\pmod{7}$. Correct.\n$x \\pmod{11} \\equiv 558 \\pmod{11}$. Since $558 = 50 \\times 11 + 8$, $558 \\equiv 8 \\pmod{11}$. Correct.\n$x \\pmod{13} \\equiv 558 \\pmod{13}$. Since $558 = 42 \\times 13 + 12$, $558 \\equiv 12 \\pmod{13}$. Correct.\nThe computed residues match $(5, 8, 12)$, confirming the result.\nThe final answer is the integer $x$.", "answer": "$$\\boxed{558}$$", "id": "3081044"}]}