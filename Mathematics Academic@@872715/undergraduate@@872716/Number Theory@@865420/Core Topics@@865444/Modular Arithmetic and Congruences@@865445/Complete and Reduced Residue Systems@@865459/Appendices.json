{"hands_on_practices": [{"introduction": "Understanding a reduced residue system begins with two fundamental questions: how many elements does it contain, and how can we systematically construct it? This exercise [@problem_id:3083422] provides a hands-on approach to both. You will first calculate the size of the system using the Principle of Inclusion-Exclusion—a core counting technique—and then use the structure guaranteed by the Chinese Remainder Theorem to describe how the system is built from simpler components.", "problem": "Let $n=840$. A complete residue system modulo $n$ is a set of $n$ integers, one from each congruence class modulo $n$. A reduced residue system modulo $n$ is a set of $\\varphi(n)$ integers, one from each congruence class modulo $n$ that is relatively prime to $n$, where $\\varphi(n)$ is Euler’s totient function defined as the number of integers $k$ with $1 \\leq k \\leq n$ and $\\gcd(k,n)=1$. Starting from these definitions and standard counting principles, perform the following:\n- Determine $\\varphi(840)$ purely from the definition, justifying your count from first principles rather than by quoting a closed totient formula.\n- Construct explicitly a reduced residue system modulo $840$ by giving a concrete, finite specification that generates exactly the congruence classes modulo $840$ that are relatively prime to $840$, and explain why your construction yields pairwise incongruent representatives that are all coprime to $840$.\n\nAs your final answer, report only the value of $\\varphi(840)$ as a single integer. Do not include any list in the final answer.", "solution": "The problem requires the determination of Euler's totient function for $n=840$, denoted $\\varphi(840)$, from first principles, and the explicit construction of a reduced residue system modulo $840$.\n\nFirst, we determine the value of $\\varphi(840)$. By definition, $\\varphi(n)$ is the number of positive integers up to $n$ that are relatively prime to $n$. For $n=840$, we must count the integers $k$ such that $1 \\le k \\le 840$ and $\\gcd(k, 840) = 1$.\n\nAn integer $k$ is relatively prime to $840$ if and only if it is not divisible by any of the prime factors of $840$. We begin by finding the prime factorization of $840$:\n$$840 = 84 \\times 10 = (4 \\times 21) \\times (2 \\times 5) = (2^2 \\times 3 \\times 7) \\times (2 \\times 5) = 2^3 \\times 3 \\times 5 \\times 7$$\nThe distinct prime factors of $840$ are $p_1=2$, $p_2=3$, $p_3=5$, and $p_4=7$.\nThus, we need to count the number of integers in the set $S = \\{1, 2, \\dots, 840\\}$ that are not divisible by $2$, $3$, $5$, or $7$. This can be accomplished using the Principle of Inclusion-Exclusion.\n\nLet $A_p$ be the set of integers in $S$ that are divisible by the prime $p$. We wish to find the size of the complement of the union $A_2 \\cup A_3 \\cup A_5 \\cup A_7$ within $S$. The size of this complement is $|S| - |A_2 \\cup A_3 \\cup A_5 \\cup A_7|$.\nBy the Principle of Inclusion-Exclusion:\n$$|A_2 \\cup A_3 \\cup A_5 \\cup A_7| = \\sum_{i} |A_{p_i}| - \\sum_{ij} |A_{p_i} \\cap A_{p_j}| + \\sum_{ijk} |A_{p_i} \\cap A_{p_j} \\cap A_{p_k}| - |A_2 \\cap A_3 \\cap A_5 \\cap A_7|$$\nThe size of $A_d$ for any divisor $d$ of $840$ is the number of multiples of $d$ in $S$, which is $\\frac{840}{d}$.\n\n$1.$ Sum of sizes of individual sets:\n$|A_2| = \\frac{840}{2} = 420$\n$|A_3| = \\frac{840}{3} = 280$\n$|A_5| = \\frac{840}{5} = 168$\n$|A_7| = \\frac{840}{7} = 120$\n$\\sum |A_{p_i}| = 420 + 280 + 168 + 120 = 988$.\n\n$2.$ Sum of sizes of pairwise intersections. An integer is in $A_p \\cap A_q$ if it is divisible by $pq$.\n$|A_2 \\cap A_3| = |A_6| = \\frac{840}{6} = 140$\n$|A_2 \\cap A_5| = |A_{10}| = \\frac{840}{10} = 84$\n$|A_2 \\cap A_7| = |A_{14}| = \\frac840}{14} = 60$\n$|A_3 \\cap A_5| = |A_{15}| = \\frac{840}{15} = 56$\n$|A_3 \\cap A_7| = |A_{21}| = \\frac{840}{21} = 40$\n$|A_5 \\cap A_7| = |A_{35}| = \\frac{840}{35} = 24$\n$\\sum |A_{p_i} \\cap A_{p_j}| = 140 + 84 + 60 + 56 + 40 + 24 = 404$.\n\n$3.$ Sum of sizes of three-wise intersections.\n$|A_2 \\cap A_3 \\cap A_5| = |A_{30}| = \\frac{840}{30} = 28$\n$|A_2 \\cap A_3 \\cap A_7| = |A_{42}| = \\frac{840}{42} = 20$\n$|A_2 \\cap A_5 \\cap A_7| = |A_{70}| = \\frac{840}{70} = 12$\n$|A_3 \\cap A_5 \\cap A_7| = |A_{105}| = \\frac{840}{105} = 8$\n$\\sum |A_{p_i} \\cap A_{p_j} \\cap A_{p_k}| = 28 + 20 + 12 + 8 = 68$.\n\n$4.$ Size of the four-wise intersection.\n$|A_2 \\cap A_3 \\cap A_5 \\cap A_7| = |A_{210}| = \\frac{840}{210} = 4$.\n\nThe number of integers in $S$ divisible by at least one of these primes is:\n$|A_2 \\cup A_3 \\cup A_5 \\cup A_7| = 988 - 404 + 68 - 4 = 648$.\n\nThe number of integers in $S$ that are relatively prime to $840$ is therefore:\n$\\varphi(840) = |S| - |A_2 \\cup A_3 \\cup A_5 \\cup A_7| = 840 - 648 = 192$.\n\nNext, we construct a reduced residue system modulo $840$. We utilize the Chinese Remainder Theorem (CRT). The modulus $n=840$ can be factored into pairwise coprime factors $n_1=2^3=8$, $n_2=3$, $n_3=5$, and $n_4=7$.\n\nThe CRT establishes a bijective mapping between the ring of integers modulo $840$, $\\mathbb{Z}_{840}$, and the direct product of the rings of integers modulo the factors, $\\mathbb{Z}_8 \\times \\mathbb{Z}_3 \\times \\mathbb{Z}_5 \\times \\mathbb{Z}_7$. An integer $x$ corresponds to a tuple $(x \\pmod 8, x \\pmod 3, x \\pmod 5, x \\pmod 7)$.\n\nAn integer $x$ is relatively prime to $840$ if and only if it is relatively prime to each of the coprime factors $8, 3, 5, 7$. That is, $\\gcd(x, 840) = 1$ is equivalent to the simultaneous conditions:\n$\\gcd(x, 8)=1$, $\\gcd(x, 3)=1$, $\\gcd(x, 5)=1$, and $\\gcd(x, 7)=1$.\n\nThis implies that an element $x \\pmod{840}$ belongs to the group of units $(\\mathbb{Z}/840\\mathbb{Z})^\\times$ if and only if its corresponding tuple $(a_1, a_2, a_3, a_4) = (x \\pmod 8, x \\pmod 3, x \\pmod 5, x \\pmod 7)$ has each component $a_i$ belonging to the group of units of the respective modulus.\n\nWe identify the reduced residue systems for each factor:\n- For modulus $8$: An integer is coprime to $8$ if it is odd. The reduced residue system modulo $8$ is $\\{1, 3, 5, 7\\}$. There are $\\varphi(8) = 8 - 4 = 4$ such residues.\n- For modulus $3$: The reduced residue system is $\\{1, 2\\}$. There are $\\varphi(3) = 3 - 1 = 2$ such residues.\n- For modulus $5$: The reduced residue system is $\\{1, 2, 3, 4\\}$. There are $\\varphi(5) = 5 - 1 = 4$ such residues.\n- For modulus $7$: The reduced residue system is $\\{1, 2, 3, 4, 5, 6\\}$. There are $\\varphi(7) = 7 - 1 = 6$ such residues.\n\nThe total number of possible tuples $(a_1, a_2, a_3, a_4)$ where each $a_i$ is chosen from the corresponding reduced residue system is the product of their sizes: $4 \\times 2 \\times 4 \\times 6 = 192$. This confirms our calculation of $\\varphi(840)$.\n\nThe concrete specification for generating a reduced residue system modulo $840$ is as follows: The system consists of the set of unique integers $x$ in the range $1 \\le x \\le 840$ that are solutions to the systems of congruences:\n$$\n\\begin{cases}\nx \\equiv a_1 \\pmod{8} \\\\\nx \\equiv a_2 \\pmod{3} \\\\\nx \\equiv a_3 \\pmod{5} \\\\\nx \\equiv a_4 \\pmod{7}\n\\end{cases}\n$$\nwhere the tuple $(a_1, a_2, a_3, a_4)$ is chosen from the Cartesian product of the individual reduced residue systems: $a_1 \\in \\{1, 3, 5, 7\\}$, $a_2 \\in \\{1, 2\\}$, $a_3 \\in \\{1, 2, 3, 4\\}$, and $a_4 \\in \\{1, 2, 3, 4, 5, 6\\}$.\n\nThis construction is valid for the following reasons:\n$1.$ (All are coprime to $840$): For any such solution $x$, the congruence $x \\equiv a_1 \\pmod 8$ with $\\gcd(a_1, 8)=1$ implies $x$ is odd, so $\\gcd(x, 8)=1$. Similarly, $x \\equiv a_2 \\pmod 3$ with $\\gcd(a_2, 3)=1$ implies $3 \\nmid x$, so $\\gcd(x, 3)=1$. This extends to all prime factors $2, 3, 5, 7$. Since $x$ is not divisible by any of the prime factors of $840$, we have $\\gcd(x, 840)=1$.\n\n$2.$ (Pairwise incongruent): The CRT guarantees that for each of the $192$ distinct tuples $(a_1, a_2, a_3, a_4)$, there exists a unique solution $x$ modulo $840$. If two tuples differ, they must differ in at least one component, say $a_i \\not\\equiv b_i \\pmod{n_i}$. Their respective solutions $x$ and $y$ would then be incongruent modulo $n_i$, and therefore incongruent modulo $840$. This ensures that our construction yields $192$ distinct residue classes modulo $840$.\n\n$3.$ (Completeness): The construction generates exactly $\\varphi(840)=192$ distinct congruence classes modulo $840$, each of which is relatively prime to $840$. Since there are precisely $\\varphi(840)$ such classes in total, this construction generates all of them. Any integer $k$ coprime to $840$ will define a tuple of residues $(k \\pmod 8, \\dots, k \\pmod 7)$ that is one of the $192$ valid tuples, and $k$ will be congruent to the unique solution generated by this tuple.", "answer": "$$\\boxed{192}$$", "id": "3083422"}, {"introduction": "A reduced residue system modulo $n$ is more than just a set of numbers; it forms an important mathematical structure known as a group under multiplication. This practice [@problem_id:3083425] allows you to explore this algebraic structure in a concrete way. By tracing the action of multiplying by a fixed unit, you will see how it permutes the elements of the system, and analyzing the resulting cycle decomposition offers insights into the group's internal properties.", "problem": "Let $n$ be a positive integer and let a unit modulo $n$ be an integer $u$ with $\\gcd(u,n)=1$, where $\\gcd$ denotes the Greatest Common Divisor (GCD). A reduced residue system modulo $n$ is a complete set of representatives of the residue classes coprime to $n$, containing exactly $\\varphi(n)$ elements, where $\\varphi$ is Euler's totient function. Consider the map $f:\\mathbb{Z}\\to\\mathbb{Z}$ given by $f(a)\\equiv ua\\pmod{n}$, and its restriction to a reduced residue system modulo $n$. Because $u$ is a unit, this restriction induces a permutation on the reduced residue system.\n\nWork modulo $n=21$ with the fixed unit $u=10$. Perform the following tasks, starting from first principles:\n- Construct explicitly a reduced residue system modulo $21$, written in increasing order.\n- Using the definition of the induced permutation, compute $f(a)\\equiv 10a\\pmod{21}$ for each element $a$ of the reduced residue system, and write down the resulting permutation.\n- Compute the cycle decomposition of this permutation into disjoint cycles by following the iterates $a, f(a), f^{2}(a),\\dots$ until they return to $a$, for each $a$ not yet assigned to a cycle.\n- Finally, determine the sign of the permutation (that is, whether it is an even permutation or an odd permutation), expressed as $1$ for even and $-1$ for odd.\n\nYour final answer must be a single number, either $1$ or $-1$, written in exact form. No rounding is required.", "solution": "We begin with the definitions. A reduced residue system modulo $n$ is any set of integers each representing a distinct residue class modulo $n$ that is coprime to $n$. The number of such residues is given by Euler's totient function $\\varphi(n)$. If $u$ is a unit modulo $n$, that is, $\\gcd(u,n)=1$, then multiplication by $u$ induces a permutation on this set because the map $a\\mapsto ua\\pmod{n}$ is bijective: it has inverse $a\\mapsto u^{-1}a\\pmod{n}$, where $u^{-1}$ exists modulo $n$ by the definition of a unit.\n\nWe work with $n=21$ and $u=10$. First, we construct a reduced residue system modulo $21$. The integers between $1$ and $21$ that are coprime to $21$ are those not divisible by $3$ or $7$. Listing them in increasing order, we obtain\n$$\n\\{1,2,4,5,8,10,11,13,16,17,19,20\\}.\n$$\nThere are $12$ elements, consistent with $\\varphi(21)=\\varphi(3)\\varphi(7)=2\\cdot 6=12$.\n\nNext, we construct the permutation induced by multiplication by $u=10$ modulo $21$. For each $a$ in the reduced residue system, compute $f(a)\\equiv 10a\\pmod{21}$:\n- $f(1)\\equiv 10\\pmod{21}$, so $1\\mapsto 10$.\n- $f(10)\\equiv 100\\equiv 100-84\\equiv 16\\pmod{21}$, so $10\\mapsto 16$.\n- $f(16)\\equiv 160\\equiv 160-147\\equiv 13\\pmod{21}$, so $16\\mapsto 13$.\n- $f(13)\\equiv 130\\equiv 130-126\\equiv 4\\pmod{21}$, so $13\\mapsto 4$.\n- $f(4)\\equiv 40\\equiv 40-21\\equiv 19\\pmod{21}$, so $4\\mapsto 19$.\n- $f(19)\\equiv 190\\equiv 190-189\\equiv 1\\pmod{21}$, so $19\\mapsto 1$.\n\nThis closes a cycle starting at $1$:\n$$\n(1,10,16,13,4,19).\n$$\nWe continue with the smallest element not yet included, $2$:\n- $f(2)\\equiv 20\\pmod{21}$, so $2\\mapsto 20$.\n- $f(20)\\equiv 200\\equiv 200-189\\equiv 11\\pmod{21}$, so $20\\mapsto 11$.\n- $f(11)\\equiv 110\\equiv 110-105\\equiv 5\\pmod{21}$, so $11\\mapsto 5$.\n- $f(5)\\equiv 50\\equiv 50-42\\equiv 8\\pmod{21}$, so $5\\mapsto 8$.\n- $f(8)\\equiv 80\\equiv 80-63\\equiv 17\\pmod{21}$, so $8\\mapsto 17$.\n- $f(17)\\equiv 170\\equiv 170-168\\equiv 2\\pmod{21}$, so $17\\mapsto 2$.\n\nThis closes the second cycle:\n$$\n(2,20,11,5,8,17).\n$$\nAll $12$ elements are now covered by these two disjoint cycles, so the cycle decomposition of the permutation induced by $a\\mapsto 10a\\pmod{21}$ on the reduced residue system modulo $21$ is\n$$\n(1,10,16,13,4,19)\\,(2,20,11,5,8,17).\n$$\n\nWe now determine the sign of the permutation. A fundamental fact from the theory of permutations is that a cycle of length $\\ell$ can be written as a product of $\\ell-1$ transpositions, and thus has sign $(-1)^{\\ell-1}$. Because disjoint cycles multiply independently, the sign of a product of disjoint cycles is the product of their signs. In our case, both cycles have length $\\ell=6$, hence each has sign $(-1)^{6-1}=(-1)^{5}=-1$. Therefore, the overall sign is\n$$\n(-1)\\cdot(-1)=(-1)^{10}=1.\n$$\nEquivalently, since the permutation acts on $\\varphi(21)=12$ elements and has $2$ cycles, the sign is $(-1)^{12-2}=(-1)^{10}=1$, consistent with the above computation. Hence the permutation is even, and the requested final numerical value is $1$.", "answer": "$$\\boxed{1}$$", "id": "3083425"}, {"introduction": "The most robust way to master a mathematical construction is to teach it to a computer. This practice [@problem_id:3083418] challenges you to translate the constructive proof of the Chinese Remainder Theorem into a concrete algorithm. By writing a program that synthesizes a reduced residue system from its prime-power components, you will solidify your understanding of this powerful theorem and its practical applications in number theory and cryptography.", "problem": "You are to implement a complete, runnable program that constructs a reduced residue system modulo a composite modulus by combining reduced residue systems for prime power components via the Chinese Remainder Theorem (CRT). The program must adhere to the following specification.\n\nFundamental base to use:\n- Definitions: For a positive integer $n$, a complete residue system modulo $n$ is any set of $n$ integers that are pairwise incongruent modulo $n$. A reduced residue system modulo $n$ is any set of $\\varphi(n)$ integers that are pairwise incongruent modulo $n$, each coprime to $n$, and collectively representing all residue classes modulo $n$ that are coprime to $n$, where $\\varphi$ denotes the Euler totient function. The modulus $n$ is assumed composite.\n- Facts: If $n$ factorizes as $n=\\prod_{i=1}^{r}p_i^{k_i}$ with distinct primes $p_i$ and positive integers $k_i$, then $\\varphi(n)=\\prod_{i=1}^{r}\\varphi\\!\\left(p_i^{k_i}\\right)$, and the canonical ring isomorphism from $\\mathbb{Z}/n\\mathbb{Z}$ to $\\prod_{i=1}^{r}\\mathbb{Z}/p_i^{k_i}\\mathbb{Z}$ given by reduction modulo each $p_i^{k_i}$ is bijective. The mapping is underwritten by the Chinese Remainder Theorem (CRT).\n\nTask:\n- Input format and constraints are internal to the program; no external input is read. For each test case, you are given the prime power factorization of a composite modulus as a list of pairs $\\left[(p_1,k_1),(p_2,k_2),\\dots,(p_r,k_r)\\right]$ with distinct primes $p_i$ and positive integers $k_i$, representing $n=\\prod_{i=1}^{r}p_i^{k_i}$. For each test case:\n    1. Construct the reduced residue system $R_i$ modulo $p_i^{k_i}$ as the set of integers in the interval $\\left[0,p_i^{k_i}-1\\right]$ that are coprime to $p_i^{k_i}$.\n    2. Using only the principles of the Chinese Remainder Theorem and the fact that the moduli $p_i^{k_i}$ are pairwise coprime, derive and implement a constructive method to produce a set $R\\subseteq\\left[0,n-1\\right]$ that is the image of the Cartesian product $\\prod_{i=1}^{r}R_i$ under the isomorphism induced by CRT. Do not use or quote any pre-supplied shortcut formulas in the problem statement; instead, implement the constructive synthesis justified by the theorem itself, ensuring each tuple $\\left(a_1,\\dots,a_r\\right)\\in\\prod_{i=1}^{r}R_i$ maps to a unique $x\\in\\left[0,n-1\\right]$ with $x\\equiv a_i\\pmod{p_i^{k_i}}$ for all $i$.\n    3. Verify that the constructed set $R$ is a reduced residue system modulo $n$ by checking:\n        - $\\left|R\\right|=\\varphi(n)$,\n        - every element of $R$ is coprime to $n$,\n        - all elements of $R$ are pairwise incongruent modulo $n$.\n    4. Sort $R$ in increasing order.\n\nTest suite:\n- Use exactly the following four test cases inside your program, in the given order:\n    1. $\\left[(2,3)\\right]$ representing $n=2^3$,\n    2. $\\left[(3,2),(5,1)\\right]$ representing $n=3^2\\cdot 5$,\n    3. $\\left[(2,2),(3,1),(7,1)\\right]$ representing $n=2^2\\cdot 3\\cdot 7$,\n    4. $\\left[(2,3),(3,2)\\right]$ representing $n=2^3\\cdot 3^2$.\n\nRequired final output format:\n- For each test case, produce a two-element list `[system,is_valid]`, where `system` is the sorted reduced residue system $R$ as a list of integers in $\\left[0,n-1\\right]$, and `is_valid` is a boolean indicating whether the validation in step $3$ succeeded.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and with no spaces. For example, the overall output should have the form `[[system_1,is_valid_1],[system_2,is_valid_2],[system_3,is_valid_3],[system_4,is_valid_4]]`.\n\nAngle units and physical units are not applicable. Percentages are not applicable; all counts are integers.\n\nScientific realism:\n- Ensure your construction strictly follows from the definitions and facts above and uses properties guaranteed by coprimality of distinct prime powers.\n\nOutput must be a complete, runnable program; no external inputs are permitted.", "solution": "The problem requires the construction of a reduced residue system modulo a composite number $n$ by synthesizing it from the reduced residue systems of its prime power factors. The procedure is based on the constructive proof of the Chinese Remainder Theorem (CRT).\n\nLet the prime factorization of the composite modulus be $n = \\prod_{i=1}^{r} p_i^{k_i}$, where $p_i$ are distinct primes and $k_i \\ge 1$ are positive integers. We define the component moduli as $m_i = p_i^{k_i}$. Since the primes $p_i$ are distinct, these moduli $m_i$ are pairwise coprime, i.e., $\\text{gcd}(m_i, m_j) = 1$ for $i \\neq j$.\n\nA number $x$ is coprime to $n$ if and only if it is coprime to each of its prime power factors $p_i^{k_i}$. This can be stated as: $\\text{gcd}(x, n) = 1 \\iff \\forall i \\in \\{1, \\dots, r\\}, \\text{gcd}(x, p_i^{k_i}) = 1$.\n\nThe Chinese Remainder Theorem establishes a ring isomorphism between the ring of integers modulo $n$ and the direct product of the rings of integers modulo each prime power factor:\n$$ \\mathbb{Z}/n\\mathbb{Z} \\cong \\prod_{i=1}^{r} \\mathbb{Z}/p_i^{k_i}\\mathbb{Z} $$\nThis isomorphism maps a residue class $[x]_n$ to the tuple of its residue classes $([x]_{m_1}, [x]_{m_2}, \\dots, [x]_{m_r})$. When this isomorphism is restricted to the groups of units (invertible elements) of these rings, it provides an isomorphism of groups:\n$$ (\\mathbb{Z}/n\\mathbb{Z})^\\times \\cong \\prod_{i=1}^{r} (\\mathbb{Z}/p_i^{k_i}\\mathbb{Z})^\\times $$\nThe group of units $(\\mathbb{Z}/n\\mathbb{Z})^\\times$ corresponds to the set of residue classes coprime to $n$, which is precisely the reduced residue system modulo $n$. The size of this group is given by Euler's totient function, $\\varphi(n)$. The isomorphism implies that a reduced residue system modulo $n$ can be constructed by finding the unique integer $x \\in [0, n-1]$ that corresponds to each tuple $(a_1, a_2, \\dots, a_r)$, where each $a_i$ is an element of the reduced residue system modulo $m_i$.\n\nThe algorithmic steps for this construction are as follows:\n\n1.  **Decomposition**: Given the factorization $n = \\prod_{i=1}^{r} p_i^{k_i}$, we identify the set of pairwise coprime moduli $\\{m_1, m_2, \\dots, m_r\\}$, where $m_i = p_i^{k_i}$.\n\n2.  **Component Reduced Residue Systems**: For each modulus $m_i = p_i^{k_i}$, we construct its reduced residue system, $R_i$. This set consists of all integers $a$ in the range $[0, m_i-1]$ such that $\\text{gcd}(a, m_i) = 1$. Since $p_i$ is the only prime factor of $m_i$, this condition simplifies to $p_i \\nmid a$. Note that for $m_i \\ge 2$, $\\text{gcd}(0, m_i) = m_i \\neq 1$, so $0$ is not in $R_i$. The size of this set is $|R_i| = \\varphi(m_i) = \\varphi(p_i^{k_i}) = p_i^{k_i} - p_i^{k_i-1}$.\n\n3.  **CRT Synthesis**: For each tuple $(a_1, a_2, \\dots, a_r)$ from the Cartesian product $R_1 \\times R_2 \\times \\dots \\times R_r$, we must find the unique solution $x \\in [0, n-1]$ to the system of congruences:\n    $$\n    \\begin{cases}\n    x \\equiv a_1 \\pmod{m_1} \\\\\n    x \\equiv a_2 \\pmod{m_2} \\\\\n    \\vdots \\\\\n    x \\equiv a_r \\pmod{m_r}\n    \\end{cases}\n    $$\n    The solution $x$ is given by the constructive formula:\n    $$ x = \\left( \\sum_{i=1}^{r} a_i N_i y_i \\right) \\pmod{n} $$\n    where:\n    - $n = \\prod_{j=1}^{r} m_j$ is the composite modulus.\n    - $N_i = n / m_i = \\prod_{j \\neq i} m_j$.\n    - $y_i$ is the modular multiplicative inverse of $N_i$ modulo $m_i$. That is, $y_i$ is an integer satisfying $N_i y_i \\equiv 1 \\pmod{m_i}$. The existence of this inverse is guaranteed because $N_i$, being a product of $m_j$ for $j \\neq i$, is coprime to $m_i$. The inverse $y_i$ can be calculated using the Extended Euclidean Algorithm. This algorithm, for given integers $A$ and $B$, finds integers $s$ and $t$ such that $As + Bt = \\text{gcd}(A, B)$. To find the an inverse of $N_i$ modulo $m_i$, we solve $N_i s + m_i t = \\text{gcd}(N_i, m_i) = 1$. The coefficient $s$ is the desired modular inverse, so $y_i \\equiv s \\pmod{m_i}$.\n\n4.  **Collection and Verification**: The set $R$ of all solutions $x$ obtained from every tuple in the Cartesian product constitutes the reduced residue system modulo $n$.\n    - **Cardinality Verification**: The size of the resulting set must be $|R| = |R_1 \\times \\dots \\times R_r| = \\prod_{i=1}^{r} |R_i| = \\prod_{i=1}^{r} \\varphi(m_i)$. By the multiplicative property of Euler's function, this product equals $\\varphi(n)$.\n    - **Coprimality Verification**: For any constructed $x$, we have $x \\equiv a_i \\pmod{m_i}$. Since $a_i \\in R_i$, it follows that $\\text{gcd}(a_i, m_i) = 1$, which implies $p_i \\nmid a_i$. The congruence then implies $p_i \\nmid x$. As this holds for all prime factors $p_i$ of $n$, we can conclude that $\\text{gcd}(x, n) = 1$.\n    - **Incongruence Verification**: The CRT guarantees a unique solution modulo $n$ for each distinct input tuple. This ensures that all generated elements are pairwise incongruent modulo $n$. This property is implicitly verified if the size of the constructed set matches $\\varphi(n)$.\n    Finally, the elements of the set $R$ are sorted in increasing order as required.\n\nThis general construction also correctly handles the base case $r=1$ (i.e., $n=p_1^{k_1}$ is a prime power), where the set of congruences has only one equation, $x \\equiv a_1 \\pmod{m_1}$. The \"Cartesian product\" is just $R_1$, and the solution for each $a_1 \\in R_1$ is trivially $x=a_1$, so $R=R_1$. The implemented algorithm reflects this general structure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport math\nimport itertools\n\ndef extended_gcd(a, b):\n    \"\"\"\n    Returns (gcd, x, y) such that a*x + b*y = gcd(a, b).\n    \"\"\"\n    if a == 0:\n        return b, 0, 1\n    d, x1, y1 = extended_gcd(b % a, a)\n    x = y1 - (b // a) * x1\n    y = x1\n    return d, x, y\n\ndef mod_inverse(a, m):\n    \"\"\"\n    Returns the modular multiplicative inverse of a modulo m.\n    \"\"\"\n    d, x, y = extended_gcd(a, m)\n    if d != 1:\n        # This case should not be reached given the problem constraints\n        # where moduli are pairwise coprime.\n        raise ValueError(f\"Modular inverse does not exist for {a} mod {m}\")\n    return x % m\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        [(2, 3)],\n        [(3, 2), (5, 1)],\n        [(2, 2), (3, 1), (7, 1)],\n        [(2, 3), (3, 2)],\n    ]\n\n    results = []\n    for factors in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        if not factors:\n            results.append([[], False])\n            continue\n            \n        # Step 1: Compute component moduli m_i and total modulus n.\n        # Python 3.12 integers have arbitrary precision, so overflow is not a concern.\n        moduli = [p**k for p, k in factors]\n        n = math.prod(moduli)\n        \n        # Step 2: Construct reduced residue system R_i for each m_i.\n        rrs_components = []\n        for p, k in factors:\n            m = p**k\n            # RRS_i is the set of integers in [0, m-1] coprime to m.\n            # For m = p^k, this means numbers not divisible by p.\n            # gcd(0, m) = m != 1 (since m >= 2), so 0 is never in RRS_i.\n            rrs_i = [i for i in range(1, m) if i % p != 0]\n            rrs_components.append(rrs_i)\n            \n        # Step 3: Use CRT to synthesize the final reduced residue system R.\n        # This general implementation correctly handles the r=1 case without special branching.\n        N_vals = [n // m for m in moduli]\n        y_vals = [mod_inverse(N, m) for N, m in zip(N_vals, moduli)]\n        \n        cartesian_product = itertools.product(*rrs_components)\n        \n        R_set = set()\n        for a_tuple in cartesian_product:\n            term_sum = sum(int(a) * int(N) * int(y) for a, N, y in zip(a_tuple, N_vals, y_vals))\n            x = term_sum % n\n            R_set.add(x)\n        \n        # Sort the final system.\n        R = sorted(list(R_set))\n\n        # Step 4: Verify that the constructed set R is a valid RRS.\n        phi_n = 1\n        for p, k in factors:\n            phi_n *= (p**k - p**(k-1))\n\n        # Check 1: Cardinality.\n        is_size_correct = (len(R) == phi_n)\n        # Check 2: Coprimality of all elements.\n        are_all_coprime = all(math.gcd(x, n) == 1 for x in R)\n        # Check 3 (Incongruence) is implicitly verified by using a set and checking size.\n        \n        is_valid = is_size_correct and are_all_coprime\n        \n        results.append([R, is_valid])\n\n    # Final print statement in the exact required format.\n    output_parts = []\n    for system, is_valid in results:\n        system_str = f\"[{','.join(map(str, system))}]\"\n        valid_str = str(is_valid).lower()\n        output_parts.append(f\"[{system_str},{valid_str}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3083418"}]}