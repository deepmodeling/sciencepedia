{"hands_on_practices": [{"introduction": "The entire structure of index arithmetic is built upon the concept of a generator, or a primitive root, which is an element whose powers can produce every member of the multiplicative group. Before we can compute or manipulate discrete logarithms, we must first be able to identify a valid base. This exercise [@problem_id:3084338] provides essential hands-on practice in applying the standard criterion to verify if a given element is a primitive root, a foundational skill for working with cyclic groups.", "problem": "Let $p=229$ be a prime and consider the multiplicative group $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ of units modulo $p$. Using only the fundamental facts that $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ is a finite group of order $p-1$ and that the order of any element divides the group order (by Lagrange's theorem), determine whether the candidate $g=6$ is a primitive root modulo $p$ by analyzing the prime factorization of $p-1$ and testing the necessary orders. Then, deduce the exact multiplicative order of $g$ modulo $p$, denoted $\\operatorname{ord}_{p}(g)$. Provide your final answer as a single integer.", "solution": "The problem is to determine if the integer $g=6$ is a primitive root modulo the prime $p=229$ and to find its multiplicative order, $\\operatorname{ord}_{p}(g)$. A primitive root modulo a prime $p$ is an element $g$ of the multiplicative group $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ whose order is equal to the order of the group itself. The order of $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ is given by Euler's totient function, $\\phi(p)$, which for a prime $p$ is equal to $p-1$.\n\nIn this case, $p=229$, so the order of the group is $p-1 = 229-1 = 228$.\nFor $g=6$ to be a primitive root modulo $229$, its order must be $228$. That is, $\\operatorname{ord}_{229}(6)$ must be $228$.\n\nA standard criterion to check if an element $g$ is a primitive root modulo $p$ relies on the prime factorization of $p-1$. Let the prime factorization of $p-1$ be $p-1 = q_1^{a_1} q_2^{a_2} \\cdots q_k^{a_k}$. An element $g$ is a primitive root modulo $p$ if and only if for all distinct prime factors $q_i$ of $p-1$, the following condition holds:\n$$g^{\\frac{p-1}{q_i}} \\not\\equiv 1 \\pmod{p}$$\nThis is because if the order of $g$ were a proper divisor of $p-1$, it would have to divide at least one of the numbers $\\frac{p-1}{q_i}$.\n\nFirst, we find the prime factorization of $p-1 = 228$:\n$$228 = 2 \\times 114 = 2^2 \\times 57 = 2^2 \\times 3 \\times 19$$\nThe distinct prime factors of $228$ are $q_1=2$, $q_2=3$, and $q_3=19$.\n\nWe must now test the three conditions for $g=6$ and $p=229$:\n1. Check if $6^{\\frac{228}{2}} \\pmod{229} \\not\\equiv 1 \\pmod{229}$. This is $6^{114} \\pmod{229}$.\n2. Check if $6^{\\frac{228}{3}} \\pmod{229} \\not\\equiv 1 \\pmod{229}$. This is $6^{76} \\pmod{229}$.\n3. Check if $6^{\\frac{228}{19}} \\pmod{229} \\not\\equiv 1 \\pmod{229}$. This is $6^{12} \\pmod{229}$.\n\nWe will evaluate these powers using modular exponentiation (the method of repeated squaring).\n\nCalculation for $6^{12} \\pmod{229}$:\n$6^1 \\equiv 6 \\pmod{229}$\n$6^2 \\equiv 36 \\pmod{229}$\n$6^4 \\equiv 36^2 = 1296 \\pmod{229}$. Since $1296 = 5 \\times 229 + 151$, we have $6^4 \\equiv 151 \\pmod{229}$.\n$6^8 \\equiv 151^2 = 22801 \\pmod{229}$. Since $22801 = 99 \\times 229 + 130$, we have $6^8 \\equiv 130 \\pmod{229}$.\nNow we compute $6^{12} = 6^{8+4} = 6^8 \\times 6^4$:\n$6^{12} \\equiv 130 \\times 151 = 19630 \\pmod{229}$. Since $19630 = 85 \\times 229 + 165$, we have:\n$$6^{12} \\equiv 165 \\pmod{229}$$\nSince $165 \\not\\equiv 1 \\pmod{229}$, the third condition is satisfied.\n\nCalculation for $6^{76} \\pmod{229}$:\nWe continue squaring from our previous results:\n$6^{16} \\equiv 130^2 = 16900 \\pmod{229}$. Since $16900 = 73 \\times 229 + 183$, we have $6^{16} \\equiv 183 \\pmod{229}$.\n$6^{32} \\equiv 183^2 = 33489 \\pmod{229}$. Since $33489 = 146 \\times 229 + 55$, we have $6^{32} \\equiv 55 \\pmod{229}$.\n$6^{64} \\equiv 55^2 = 3025 \\pmod{229}$. Since $3025 = 13 \\times 229 + 48$, we have $6^{64} \\equiv 48 \\pmod{229}$.\nThe binary expansion of the exponent $76$ is $64 + 8 + 4$. So, $6^{76} = 6^{64} \\times 6^8 \\times 6^4$:\n$6^{76} \\equiv 48 \\times 130 \\times 151 \\pmod{229}$.\nFirst, $48 \\times 130 = 6240$. $6240 = 27 \\times 229 + 57$, so $48 \\times 130 \\equiv 57 \\pmod{229}$.\nThen, $57 \\times 151 = 8607$. $8607 = 37 \\times 229 + 144$, so:\n$$6^{76} \\equiv 144 \\pmod{229}$$\nSince $144 \\not\\equiv 1 \\pmod{229}$, the second condition is satisfied.\n\nCalculation for $6^{114} \\pmod{229}$:\nThe binary expansion of the exponent $114$ is $64 + 32 + 16 + 2$. So, $6^{114} = 6^{64} \\times 6^{32} \\times 6^{16} \\times 6^2$:\n$6^{114} \\equiv 48 \\times 55 \\times 183 \\times 36 \\pmod{229}$.\nFirst, $48 \\times 55 = 2640$. $2640 = 11 \\times 229 + 121$, so $48 \\times 55 \\equiv 121 \\pmod{229}$.\nNext, $121 \\times 183 = 22143$. $22143 = 96 \\times 229 + 159$, so $121 \\times 183 \\equiv 159 \\pmod{229}$.\nFinally, $159 \\times 36 = 5724$. $5724 = 24 \\times 229 + 228$, so:\n$$6^{114} \\equiv 228 \\pmod{229}$$\nNote that $228 \\equiv -1 \\pmod{229}$. Since $228 \\not\\equiv 1 \\pmod{229}$, the first condition is satisfied.\n\nAll three conditions are satisfied:\n$6^{228/2} \\equiv 228 \\not\\equiv 1 \\pmod{229}$\n$6^{228/3} \\equiv 144 \\not\\equiv 1 \\pmod{229}$\n$6^{228/19} \\equiv 165 \\not\\equiv 1 \\pmod{229}$\n\nTherefore, the candidate $g=6$ is indeed a primitive root modulo $p=229$.\n\nThe problem asks for the exact multiplicative order of $g$ modulo $p$, denoted $\\operatorname{ord}_{p}(g)$. By the definition of a primitive root, its order is the order of the group, which is $p-1$.\nThus, the order of $6$ modulo $229$ is $p-1 = 228$.\n$$\\operatorname{ord}_{229}(6) = 228$$", "answer": "$$\\boxed{228}$$", "id": "3084338"}, {"introduction": "The true power of discrete logarithms lies in their ability to convert complex multiplicative operations into simpler additive ones, much like classical logarithms simplify calculations with real numbers. This practice [@problem_id:3084339] allows you to experience this transformation directly by verifying the fundamental properties of index arithmetic. By calculating a result both through direct modular multiplication and by manipulating indices, you will develop a concrete understanding of the homomorphism that makes discrete logarithms a cornerstone of number theory.", "problem": "Consider a prime modulus $p$ and the multiplicative group of units modulo $p$, denoted $\\mathbb{F}_{p}^{\\times}$. This group is cyclic of order $p-1$. A generator $g \\in \\mathbb{F}_{p}^{\\times}$ is called a primitive root modulo $p$; for such $g$, every $x \\in \\mathbb{F}_{p}^{\\times}$ can be written uniquely as $x \\equiv g^{k} \\pmod{p}$ for some integer $k$ with $0 \\leq k \\leq p-2$. The discrete logarithm of $x$ to the base $g$ modulo $p$, denoted $\\log_{g}(x)$, is the unique integer $k \\in \\{0,1,\\dots,p-2\\}$ such that $g^{k} \\equiv x \\pmod{p}$. Index arithmetic refers to manipulating these exponents using the structure of $\\mathbb{F}_{p}^{\\times}$.\n\nLet $p=29$ and let $g=2$, which is a primitive root modulo $29$. Let $a=5$, $b=7$, and $c=3$ in $\\mathbb{F}_{29}^{\\times}$. Starting from the cyclic group structure of $\\mathbb{F}_{29}^{\\times}$ and the definition of the discrete logarithm, determine $\\log_{g}\\!\\left(\\frac{ab}{c}\\right)$ modulo $p-1$ and separately compute $\\log_{g}(a)$, $\\log_{g}(b)$, and $\\log_{g}(c)$ modulo $p-1$. Compare the value of $\\log_{g}\\!\\left(\\frac{ab}{c}\\right)$ with the combination of the individually computed logarithms justified by the group structure, and report the value of $\\log_{g}\\!\\left(\\frac{ab}{c}\\right)$ as a single integer in $\\{0,1,\\dots,p-2\\}$. No rounding is required.", "solution": "The multiplicative group $\\mathbb{F}_{p}^{\\times}$ is cyclic of order $p-1$. If $g$ is a primitive root modulo $p$, then every $x \\in \\mathbb{F}_{p}^{\\times}$ has the form $x \\equiv g^{k} \\pmod{p}$ for some $k \\in \\{0,1,\\dots,p-2\\}$. The discrete logarithm $\\log_{g}(x)$ is defined by $g^{\\log_{g}(x)} \\equiv x \\pmod{p}$. The cyclic structure implies that exponent arithmetic in the exponent of $g$ corresponds to multiplication in $\\mathbb{F}_{p}^{\\times}$, and exponents are taken modulo $p-1$ because $g^{p-1} \\equiv 1 \\pmod{p}$.\n\nFrom these principles, if $x \\equiv g^{u}$ and $y \\equiv g^{v}$, then $xy \\equiv g^{u} g^{v} \\equiv g^{u+v} \\pmod{p}$, so $\\log_{g}(xy) \\equiv u+v \\equiv \\log_{g}(x) + \\log_{g}(y) \\pmod{p-1}$. Likewise, $x^{-1} \\equiv g^{-u} \\pmod{p}$ implies $\\log_{g}(x^{-1}) \\equiv -u \\equiv -\\log_{g}(x) \\pmod{p-1}$. Therefore, for $x,y,z \\in \\mathbb{F}_{p}^{\\times}$, one has\n$$\n\\log_{g}\\!\\left(\\frac{xy}{z}\\right) \\equiv \\log_{g}(x) + \\log_{g}(y) - \\log_{g}(z) \\pmod{p-1}.\n$$\nWe will compute all relevant quantities concretely for $p=29$ and $g=2$.\n\nFirst, we compute powers of $2$ modulo $29$ to build a table and identify discrete logarithms of $a$, $b$, and $c$. Using repeated squaring and reduction modulo $29$:\n\n$$\n\\begin{aligned}\n2^{1} \\equiv 2,\\quad 2^{2} \\equiv 4,\\quad 2^{3} \\equiv 8,\\quad 2^{4} \\equiv 16,\\quad 2^{5} \\equiv 32 \\equiv 3,\\\\\n2^{6} \\equiv 6,\\quad 2^{7} \\equiv 12,\\quad 2^{8} \\equiv 24,\\quad 2^{9} \\equiv 48 \\equiv 19,\\quad 2^{10} \\equiv 38 \\equiv 9,\\\\\n2^{11} \\equiv 18,\\quad 2^{12} \\equiv 36 \\equiv 7,\\quad 2^{13} \\equiv 14,\\quad 2^{14} \\equiv 28 \\equiv -1,\\\\\n2^{15} \\equiv -2 \\equiv 27,\\quad 2^{16} \\equiv -4 \\equiv 25,\\quad 2^{17} \\equiv -8 \\equiv 21,\\quad 2^{18} \\equiv -16 \\equiv 13,\\\\\n2^{19} \\equiv -32 \\equiv -3 \\equiv 26,\\quad 2^{20} \\equiv -6 \\equiv 23,\\quad 2^{21} \\equiv -12 \\equiv 17,\\quad 2^{22} \\equiv -24 \\equiv 5,\\\\\n2^{23} \\equiv -48 \\equiv -19 \\equiv 10,\\quad 2^{24} \\equiv -38 \\equiv -9 \\equiv 20,\\quad 2^{25} \\equiv -18 \\equiv 11,\\\\\n2^{26} \\equiv -36 \\equiv -7 \\equiv 22,\\quad 2^{27} \\equiv -14 \\equiv 15,\\quad 2^{28} \\equiv 1 \\pmod{29}.\n\\end{aligned}\n$$\n\nFrom the table:\n\n$$\n\\log_{2}(a) = \\log_{2}(5) = 22,\\quad \\log_{2}(b) = \\log_{2}(7) = 12,\\quad \\log_{2}(c) = \\log_{2}(3) = 5.\n$$\n\nNext, compute $\\frac{ab}{c}$ in $\\mathbb{F}_{29}^{\\times}$. First, $ab \\equiv 5 \\cdot 7 \\equiv 35 \\equiv 6 \\pmod{29}$. The inverse of $c=3$ modulo $29$ is the unique $d$ such that $3d \\equiv 1 \\pmod{29}$. Since $3 \\cdot 10 \\equiv 30 \\equiv 1 \\pmod{29}$, the inverse of $3$ modulo $29$ is $10$. Therefore,\n\n$$\n\\frac{ab}{c} \\equiv 6 \\cdot 10 \\equiv 60 \\equiv 2 \\pmod{29}.\n$$\n\nThus $\\log_{2}\\!\\left(\\frac{ab}{c}\\right) = \\log_{2}(2) = 1$.\n\nFinally, compare with the index arithmetic combination modulo $p-1=28$:\n\n$$\n\\log_{2}(a) + \\log_{2}(b) - \\log_{2}(c) \\equiv 22 + 12 - 5 \\equiv 29 \\equiv 1 \\pmod{28},\n$$\n\nwhich agrees with the directly computed value $\\log_{2}\\!\\left(\\frac{ab}{c}\\right) = 1$. Therefore, the required value is $1$.", "answer": "$$\\boxed{1}$$", "id": "3084339"}, {"introduction": "While understanding the properties of discrete logarithms is crucial, the real challenge often lies in computing them, especially when the modulus is large. This practice [@problem_id:3084374] moves beyond theoretical definitions and introduces you to the baby-step giant-step algorithm, a widely-used method that offers a significant speedup over brute-force search. By working through this clever time-space tradeoff, you will gain practical insight into how the discrete logarithm problem is actually solved and appreciate the computational thinking that underpins its applications in cryptography.", "problem": "Let $p$ be a prime and let $\\mathbb{F}_{p}^{\\times}$ denote the multiplicative group of nonzero residue classes modulo $p$. Suppose $g \\in \\mathbb{F}_{p}^{\\times}$ is a generator of $\\mathbb{F}_{p}^{\\times}$, so that the order of $g$ is $p-1$, and let $h \\in \\mathbb{F}_{p}^{\\times}$. The discrete logarithm of $h$ to the base $g$ is defined as the integer $x$ with $0 \\leq x \\leq p-2$ satisfying $g^{x} \\equiv h \\pmod{p}$.\n\nWork in the concrete instance with $p=347$, $g=2$, and $h=15$. Starting from the group-theoretic definitions and using only well-tested facts about finite cyclic groups, determine $\\log_{g}(h)$ by the following reasoning pathway:\n- Justify that $g$ is indeed a generator of $\\mathbb{F}_{p}^{\\times}$ by appealing to the definition of order in a finite group and the factorization of $p-1$.\n- Describe why there exists a decomposition of the exponent $x$ into the form $x = i m + j$ for suitable integers $i$ and $j$, where $m$ is a positive integer you choose, and explain why finding a collision between a precomputed table of powers of $g$ and a sequence involving $h$ reduces the determination of $x$ to solving a linear congruence modulo the group order.\n- Compute the necessary tables explicitly to find such a collision, reduce the problem to a linear congruence in $x$, and solve for the least nonnegative $x$ with $g^{x} \\equiv h \\pmod{p}$.\n\nGive your final answer as the unique least nonnegative integer representative in $\\{0,1,\\dots,p-2\\}$. No rounding is required, and no units are involved. Your final answer must be a single number.", "solution": "The problem asks for the computation of the discrete logarithm of $h=15$ to the base $g=2$ in the multiplicative group of the finite field $\\mathbb{F}_{347}$, denoted $\\mathbb{F}_{347}^{\\times}$. This is equivalent to finding the unique integer $x$ in the range $0 \\leq x \\leq p-2$ that satisfies the congruence $g^x \\equiv h \\pmod{p}$, where $p=347$, $g=2$, and $h=15$. The problem specifies a three-part reasoning pathway which will be followed precisely.\n\nFirst, we must justify that $g=2$ is indeed a generator of the group $\\mathbb{F}_{347}^{\\times}$. The order of this group is $|\\mathbb{F}_{347}^{\\times}| = \\phi(347) = 347-1 = 346$, since $347$ is a prime number. To show that $g=2$ is a generator, we must show that its multiplicative order modulo $347$ is equal to the order of the group, $346$. By Lagrange's theorem, the order of an element must divide the order of the group. The prime factorization of the group order is $346 = 2 \\times 173$. The number $173$ is prime as it is not divisible by any prime less than or equal to its square root, $\\sqrt{173} \\approx 13.15$. The proper divisors of $346$ are $1$, $2$, and $173$. An element $g$ is a generator if and only if $g^{(p-1)/q} \\not\\equiv 1 \\pmod{p}$ for every distinct prime factor $q$ of $p-1$.\nWe must compute two values:\n$1$. For the prime factor $q_1=2$, we check $g^{(p-1)/2} = 2^{346/2} = 2^{173} \\pmod{347}$.\n$2$. For the prime factor $q_2=173$, we check $g^{(p-1)/173} = 2^{346/173} = 2^2 \\pmod{347}$.\n\nFor the second case:\n$$2^2 = 4 \\not\\equiv 1 \\pmod{347}$$\nFor the first case, we compute $2^{173} \\pmod{347}$ using modular exponentiation. We can write $173 = 17 \\times 10 + 3$.\nFirst, $2^{10} = 1024 = 2 \\times 347 + 330 \\equiv 330 \\equiv -17 \\pmod{347}$.\nThen we compute powers of $(-17)$:\n$(-17)^2 \\equiv 289 \\equiv -58 \\pmod{347}$.\n$(-17)^4 \\equiv (-58)^2 = 3364 = 9 \\times 347 + 241 \\equiv 241 \\equiv -106 \\pmod{347}$.\n$(-17)^8 \\equiv (-106)^2 = 11236 = 32 \\times 347 + 132 \\equiv 132 \\pmod{347}$.\n$(-17)^{16} \\equiv 132^2 = 17424 = 50 \\times 347 + 74 \\equiv 74 \\pmod{347}$.\nNow, $(-17)^{17} = (-17)^{16} \\times (-17) \\equiv 74 \\times (-17) = -1258 = -4 \\times 347 + 130 \\equiv 130 \\pmod{347}$.\nFinally, $2^{173} = (2^{10})^{17} \\cdot 2^3 \\equiv (-17)^{17} \\cdot 8 \\equiv 130 \\cdot 8 = 1040 = 2 \\times 347 + 346 \\equiv 346 \\equiv -1 \\pmod{347}$.\nSince $2^{173} \\equiv -1 \\not\\equiv 1 \\pmod{347}$ and $2^2 \\not\\equiv 1 \\pmod{347}$, the order of $2$ is not a proper divisor of $346$. Therefore, the order of $2$ is $346$, and $g=2$ is a generator of $\\mathbb{F}_{347}^{\\times}$.\n\nSecond, we describe the algorithm for finding $x$, known as the Baby-step Giant-step algorithm. The unknown exponent $x$ is in the range $0 \\leq x \\leq 345$. We choose an integer $m = \\lceil\\sqrt{p-1}\\rceil = \\lceil\\sqrt{346}\\rceil = 19$. Any such $x$ can be uniquely written as $x = im+j$, where $i = \\lfloor x/m \\rfloor$ and $j = x \\pmod m$. The ranges for $i$ and $j$ are $0 \\leq j  m$ and $0 \\leq i \\leq \\lfloor (p-2)/m \\rfloor$. The equation $g^x \\equiv h \\pmod{p}$ becomes $g^{im+j} \\equiv h \\pmod{p}$.\nThis can be rearranged as $g^j \\equiv h \\cdot g^{-im} \\pmod{p}$, which is equivalent to $g^j \\equiv h \\cdot (g^{-m})^i \\pmod{p}$.\nThis form of the equation suggests a meet-in-the-middle search. We create two lists of values:\n$1$. The \"baby steps\" list: values of $g^j \\pmod{p}$ for $j \\in \\{0, 1, \\dots, m-1\\}$.\n$2$. The \"giant steps\" list: values of $h \\cdot (g^{-m})^i \\pmod{p}$ for $i \\in \\{0, 1, \\dots, m-1\\}$.\nThe existence of a solution $x$ guarantees that there will be a common value between these two lists. If we find a collision, $g^j \\equiv h \\cdot (g^{-m})^i$, for a specific pair $(i, j)$, then we have found the components of $x$. The original equation $g^x \\equiv h \\pmod p$ is equivalent to the congruence on the exponents $\\log_g(g^x) \\equiv \\log_g(h) \\pmod{p-1}$, which is $x \\equiv \\log_g(h) \\pmod{346}$. Finding the collision $(i,j)$ such that $g^{im+j} \\equiv h \\pmod p$ effectively solves the linear congruence $x \\equiv im+j \\pmod{346}$ for the unknown $x$. The least non-negative solution is then $x = im+j$.\n\nThird, we compute the necessary tables to find the collision and solve for $x$.\nHere $p=347$, $g=2$, $h=15$, and $m=19$.\nThe \"baby steps\" table consists of pairs $(j, 2^j \\pmod{347})$ for $j \\in \\{0, 1, \\dots, 18\\}$:\n$2^0 \\equiv 1$\n$2^1 \\equiv 2$\n$2^2 \\equiv 4$\n$2^3 \\equiv 8$\n$2^4 \\equiv 16$\n$2^5 \\equiv 32$\n$2^6 \\equiv 64$\n$2^7 \\equiv 128$\n$2^8 \\equiv 256$\n$2^9 \\equiv 512 \\equiv 165$\n$2^{10} \\equiv 330$\n$2^{11} \\equiv 660 \\equiv 313$\n$2^{12} \\equiv 626 \\equiv 279$\n$2^{13} \\equiv 558 \\equiv 211$\n$2^{14} \\equiv 422 \\equiv 75$\n$2^{15} \\equiv 150$\n$2^{16} \\equiv 300$\n$2^{17} \\equiv 600 \\equiv 253$\n$2^{18} \\equiv 506 \\equiv 159$\nWe store these values for efficient lookup, for example, in a hash map mapping values to exponents.\n\nFor the \"giant steps,\" we first compute $g^{-m} = 2^{-19} \\pmod{347}$.\n$g^m = 2^{19} = 2^{18} \\cdot 2 \\equiv 159 \\cdot 2 = 318 \\pmod{347}$.\nTo find the inverse of $318$ modulo $347$, we use the Extended Euclidean Algorithm:\n$347 = 1 \\cdot 318 + 29$\n$318 = 10 \\cdot 29 + 28$\n$29 = 1 \\cdot 28 + 1$\nWorking backwards:\n$1 = 29 - 28 = 29 - (318 - 10 \\cdot 29) = 11 \\cdot 29 - 318 = 11 \\cdot (347 - 318) - 318 = 11 \\cdot 347 - 12 \\cdot 318$.\nSo, $-12 \\cdot 318 \\equiv 1 \\pmod{347}$. The inverse is $318^{-1} \\equiv -12 \\equiv 335 \\pmod{347}$.\nLet $\\gamma = g^{-m} \\equiv 335 \\pmod{347}$. We now compute the sequence $h \\cdot \\gamma^i \\pmod{347}$ for $i=0, 1, 2, \\dots$ until we find a value present in our baby steps table.\n$i=0: 15 \\cdot \\gamma^0 \\equiv 15$. Not in the baby steps table.\n$i=1: 15 \\cdot 335 \\equiv 15 \\cdot (-12) = -180 \\equiv 167$. Not in the baby steps table.\n$i=2: 167 \\cdot (-12) = -2004 = -6 \\cdot 347 + 78 \\equiv 78$. Not in the baby steps table.\n$i=3: 78 \\cdot (-12) = -936 = -3 \\cdot 347 + 105 \\equiv 105$. Not in the baby steps table.\n$i=4: 105 \\cdot (-12) = -1260 = -4 \\cdot 347 + 128 \\equiv 128$.\nA collision is found! The value $128$ is in our baby steps table. Specifically, $2^7 \\equiv 128 \\pmod{347}$.\nThe collision occurred for the giant step with $i=4$ and the baby step with $j=7$. We have $h \\cdot (g^{-m})^4 \\equiv g^7 \\pmod{347}$.\nThis gives $h \\equiv g^{4m+j} \\pmod{347}$.\nThe exponent $x$ is thus determined by the congruence $x \\equiv 4m+j \\pmod{346}$.\nSubstituting the values $m=19$, $i=4$, and $j=7$:\n$x = 19 \\cdot 4 + 7 = 76 + 7 = 83$.\nThe least non-negative integer solution is $x=83$. This value is in the required range $0 \\le 83 \\le 345$.\nTo verify, we can compute $2^{83} \\pmod{347}$.\n$2^{83} = 2^{80} \\cdot 2^3$. As shown before, $2^{10} \\equiv -17 \\pmod{347}$.\n$2^{80} = (2^{10})^8 \\equiv (-17)^8 \\pmod{347}$. From our intermediate calculations for the generator test, we found $(-17)^8 \\equiv 132 \\pmod{347}$.\nThus, $2^{83} \\equiv 132 \\cdot 2^3 = 132 \\cdot 8 = 1056 = 3 \\times 347 + 15 \\equiv 15 \\pmod{347}$.\nThe calculation is correct.\nThe discrete logarithm is $\\log_2(15) = 83$.", "answer": "$$\\boxed{83}$$", "id": "3084374"}]}