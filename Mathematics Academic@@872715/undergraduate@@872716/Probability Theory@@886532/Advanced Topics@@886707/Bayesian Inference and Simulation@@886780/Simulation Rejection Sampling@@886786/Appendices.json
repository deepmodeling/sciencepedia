{"hands_on_practices": [{"introduction": "To begin, we tackle the most fundamental task in analyzing a rejection sampler: calculating its efficiency. The efficiency depends on how closely the scaled proposal distribution, $M \\cdot g(x)$, envelops the target distribution, $f(x)$. This first exercise provides practice in the core mechanics of setting up a rejection sampler by finding the optimal constant $M$ and then calculating the theoretical probability of acceptance [@problem_id:1387131].", "problem": "A data scientist is implementing a rejection sampling algorithm to generate random numbers that follow a specific target distribution. The target distribution is a Beta distribution with parameters $\\alpha = 2$ and $\\beta = 2$. The probability density function (PDF) of this target distribution, denoted by $f(x)$, is given by:\n$$f(x) = 6x(1-x) \\quad \\text{for } x \\in [0, 1]$$\nand $f(x) = 0$ otherwise.\n\nFor the proposal distribution, the data scientist uses the standard uniform distribution, U(0, 1). The PDF of this proposal distribution, denoted by $g(x)$, is:\n$$g(x) = 1 \\quad \\text{for } x \\in [0, 1]$$\nand $g(x) = 0$ otherwise.\n\nThe rejection sampling method requires finding a constant $M$ such that the inequality $f(x) \\le M g(x)$ holds for all possible values of $x$. To maximize the efficiency of the sampling process, the smallest possible value of $M$ is chosen. The algorithm then generates a sample $Y$ from the proposal distribution $g(x)$ and accepts it with probability $\\frac{f(Y)}{M g(Y)}$.\n\nCalculate the overall theoretical probability that a sample drawn from the proposal distribution is accepted. Express your answer as an exact fraction.", "solution": "We need the smallest constant $M$ such that $f(x) \\le M g(x)$ for all $x$. Since $g(x)=1$ for $x \\in [0,1]$ and $g(x)=0$ otherwise, the condition reduces on $[0,1]$ to $f(x) \\le M$. Therefore the minimal admissible $M$ is the supremum of $f(x)$ on $[0,1]$.\n\nCompute the maximum of $f(x)=6x(1-x)=6(x - x^{2})$ on $[0,1]$. Differentiate:\n$$\nf'(x)=6(1-2x), \\quad f''(x)=-12.\n$$\nSetting $f'(x)=0$ gives $x=\\frac{1}{2}$. Since $f''(x)<0$, this is a maximum. Evaluate\n$$\nM=\\max_{x \\in [0,1]} f(x)=f\\!\\left(\\tfrac{1}{2}\\right)=6 \\cdot \\tfrac{1}{2} \\cdot \\left(1-\\tfrac{1}{2}\\right)=\\frac{3}{2}.\n$$\n\nGiven $Y \\sim g$, the acceptance probability conditional on $Y=y$ is $\\frac{f(y)}{M g(y)}$. The overall acceptance probability is the expectation under $g$:\n$$\n\\mathbb{P}(\\text{accept})=\\mathbb{E}_{g}\\!\\left[\\frac{f(Y)}{M g(Y)}\\right]=\\int_{0}^{1} \\frac{f(x)}{M g(x)} g(x) \\, dx=\\frac{1}{M} \\int_{0}^{1} f(x) \\, dx.\n$$\nSince $f$ is a probability density on $[0,1]$, $\\int_{0}^{1} f(x) \\, dx=1$. For completeness:\n$$\n\\int_{0}^{1} 6x(1-x)\\,dx=6 \\int_{0}^{1} \\left(x - x^{2}\\right) dx=6 \\left(\\frac{1}{2}-\\frac{1}{3}\\right)=1.\n$$\nTherefore,\n$$\n\\mathbb{P}(\\text{accept})=\\frac{1}{M}=\\frac{1}{\\frac{3}{2}}=\\frac{2}{3}.\n$$", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1387131"}, {"introduction": "Next, we move from direct calculation to a more analytical \"inverse\" problem, a common scenario in experimental analysis. Here, we know the outcome—the sampler's measured efficiency—and must deduce a key parameter of the initial setup. This practice sharpens problem-solving skills by requiring you to work backward, reinforcing the fixed mathematical relationship between efficiency, the distributions, and the enveloping constant $M$ [@problem_id:1387104].", "problem": "In a Monte Carlo simulation for a materials science application, it's necessary to generate random defect locations $x$ within a one-dimensional crystalline structure of length $L$. The desired target probability density function (PDF) for these locations over the interval $[0, L]$ is given by $f(x) = A \\sin(\\frac{\\pi x}{L})$, where $A$ is the appropriate normalization constant.\n\nAn engineer implements a rejection sampling algorithm to generate these random variates. The proposal distribution, $g(x)$, is a uniform distribution over an interval $[0, b]$. For the sampling procedure to be valid, the support of $g(x)$ must contain the support of $f(x)$. The engineer designs an optimal rejection sampler, which means the constant $M$ in the acceptance condition $f(x) \\le M g(x)$ is chosen to be the minimum possible value for the selected $g(x)$, thereby maximizing the sampler's efficiency.\n\nAfter implementation, the measured efficiency (the overall probability of accepting a proposed sample) is found to be $\\eta = 0.625$. Given that the crystalline structure has a length of $L = 5.0$ meters, determine the width $b$ of the uniform proposal distribution's interval.\n\nExpress your answer in meters, rounded to three significant figures.", "solution": "The target density is $f(x)=A\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$ on $[0,L]$. Normalizing $f$ requires\n$$\n\\int_{0}^{L} A \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,dx = 1.\n$$\nCompute the integral:\n$$\n\\int_{0}^{L} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,dx = \\left[-\\frac{L}{\\pi}\\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\right]_{0}^{L} = -\\frac{L}{\\pi}\\left(\\cos(\\pi)-\\cos(0)\\right)=\\frac{2L}{\\pi}.\n$$\nThus $A \\cdot \\frac{2L}{\\pi}=1$, giving\n$$\nA=\\frac{\\pi}{2L}.\n$$\nHence $f_{\\max}=\\max_{x\\in[0,L]} f(x)=A=\\frac{\\pi}{2L}$ at $x=\\frac{L}{2}$.\n\nThe proposal is $g(x)=\\frac{1}{b}$ on $[0,b]$, with the support condition requiring $b\\geq L$. The optimal rejection constant is\n$$\nM=\\sup_{x}\\frac{f(x)}{g(x)}=\\frac{f_{\\max}}{1/b}=b\\,f_{\\max}=\\frac{\\pi b}{2L}.\n$$\nFor an optimal rejection sampler, the acceptance efficiency is\n$$\n\\eta=\\int g(x)\\,\\frac{f(x)}{M g(x)}\\,dx=\\frac{1}{M}\\int f(x)\\,dx=\\frac{1}{M},\n$$\nsince $f$ is normalized. Therefore\n$$\n\\eta=\\frac{2L}{\\pi b}\\quad\\Longrightarrow\\quad b=\\frac{2L}{\\pi \\eta}.\n$$\nWith $L=5.0$ and $\\eta=0.625$, this yields\n$$\nb=\\frac{2\\cdot 5.0}{\\pi\\cdot 0.625}=\\frac{16}{\\pi}\\approx 5.092958\\ldots\n$$\nRounded to three significant figures, $b=5.09$.", "answer": "$$\\boxed{5.09}$$", "id": "1387104"}, {"introduction": "Finally, we address the most practical and advanced task: optimizing the proposal distribution itself to create the most efficient sampler. The choice of a proposal distribution is not arbitrary, and its parameters can be tuned to maximize the acceptance rate. This exercise moves beyond simple analysis to design, where you will use calculus to find the optimal parameter for a proposal distribution, thereby minimizing the expected number of rejections [@problem_id:1387078].", "problem": "An engineer is designing a simulation to generate random numbers from a specific target distribution for a physics model. The target Probability Density Function (PDF), denoted as $f(x)$, is determined from a Bayesian analysis. Specifically, $f(x)$ is the posterior distribution for a parameter $x$ given a series of experimental measurements. The prior distribution for $x$ is assumed to be uniform over the real line. The measurements, $d_1, d_2, \\dots, d_n$, are drawn independently from a Gaussian distribution with a mean of $x$ and a known variance of $\\tau^2$. After collecting the data, it is found that $n=5$, the variance is $\\tau^2 = 2$, and the sum of the measurements is exactly zero, i.e., $\\sum_{i=1}^{n} d_i = 0$.\n\nFor the simulation, the engineer uses rejection sampling. The proposal distribution is a Laplace distribution, which can be generated efficiently. The PDF of this proposal distribution is given by $g(x) = \\frac{1}{2b} \\exp\\left(-\\frac{|x|}{b}\\right)$, where $b>0$ is a tunable scale parameter.\n\nThe efficiency of the rejection sampling method is maximized when the acceptance rate is maximized. The acceptance rate is inversely proportional to the constant $M = \\sup_{x \\in \\mathbb{R}} \\frac{f(x)}{g(x)}$. To optimize the simulation, the engineer needs to find the value of the parameter $b$ that minimizes this constant $M$.\n\nDetermine the exact optimal value of $b$ that maximizes the efficiency of the simulation. Express your final answer as an analytic expression.", "solution": "The prior for $x$ is uniform on $\\mathbb{R}$, which is an improper prior. With known variance $\\tau^{2}$ and $n$ independent Gaussian measurements $d_{i} \\sim \\mathcal{N}(x,\\tau^{2})$, the likelihood is\n$$\nL(x) \\propto \\left(\\frac{1}{\\sqrt{2 \\pi \\tau^{2}}}\\right)^{n} \\exp\\left(-\\frac{1}{2 \\tau^{2}} \\sum_{i=1}^{n} (d_{i}-x)^{2}\\right).\n$$\nCompleting the square,\n$$\n\\sum_{i=1}^{n} (d_{i}-x)^{2} = n(x-\\bar{d})^{2} + \\sum_{i=1}^{n} (d_{i}-\\bar{d})^{2},\n$$\nwhere $\\bar{d} = \\frac{1}{n} \\sum_{i=1}^{n} d_{i}$. With the uniform prior, the posterior is proportional to the likelihood in $x$, hence\n$$\nf(x) = \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\,\\exp\\left(-\\frac{n(x-\\bar{d})^{2}}{2 \\tau^{2}}\\right).\n$$\nGiven $\\sum_{i=1}^{n} d_{i} = 0$ and $n=5$, we have $\\bar{d}=0$, so\n$$\nf(x) = \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\,\\exp\\left(-\\frac{n x^{2}}{2 \\tau^{2}}\\right).\n$$\n\nThe proposal density is Laplace with scale $b>0$:\n$$\ng(x) = \\frac{1}{2 b}\\,\\exp\\left(-\\frac{|x|}{b}\\right).\n$$\nThe rejection constant is\n$$\nM(b) = \\sup_{x \\in \\mathbb{R}} \\frac{f(x)}{g(x)} = 2 b \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\, \\sup_{x \\in \\mathbb{R}} \\exp\\left(-\\frac{n x^{2}}{2 \\tau^{2}} + \\frac{|x|}{b}\\right).\n$$\nDefine\n$$\n\\phi(x) = -\\frac{n x^{2}}{2 \\tau^{2}} + \\frac{|x|}{b}.\n$$\nBy symmetry, maximize over $x \\geq 0$. Then\n$$\n\\phi(x) = -a x^{2} + c x,\\quad a = \\frac{n}{2 \\tau^{2}},\\quad c = \\frac{1}{b}.\n$$\nThis concave quadratic attains its maximum at\n$$\nx^{\\star} = \\frac{c}{2 a} = \\frac{\\tau^{2}}{n b},\n$$\nwith maximum value\n$$\n\\phi(x^{\\star}) = -a \\left(\\frac{\\tau^{2}}{n b}\\right)^{2} + c \\left(\\frac{\\tau^{2}}{n b}\\right) = -\\frac{\\tau^{2}}{2 n b^{2}} + \\frac{\\tau^{2}}{n b^{2}} = \\frac{\\tau^{2}}{2 n b^{2}}.\n$$\nTherefore,\n$$\nM(b) = 2 b \\sqrt{\\frac{n}{2 \\pi \\tau^{2}}}\\, \\exp\\left(\\frac{\\tau^{2}}{2 n b^{2}}\\right).\n$$\nTo minimize $M(b)$ over $b>0$, minimize\n$$\nm(b) = b \\exp\\left(\\frac{\\tau^{2}}{2 n b^{2}}\\right).\n$$\nConsider $\\ln m(b) = \\ln b + \\frac{\\tau^{2}}{2 n b^{2}}$. Differentiate and set to zero:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d} b} \\ln m(b) = \\frac{1}{b} - \\frac{\\tau^{2}}{n b^{3}} = 0 \\quad \\Longrightarrow \\quad b^{2} = \\frac{\\tau^{2}}{n}.\n$$\nThis critical point is a global minimizer because $m(b) \\to \\infty$ as $b \\to 0^{+}$ and as $b \\to \\infty$. Hence the optimal scale is\n$$\nb^{\\star} = \\frac{\\tau}{\\sqrt{n}}.\n$$\nSubstituting the given values $\\tau^{2} = 2$ and $n=5$ gives\n$$\nb^{\\star} = \\sqrt{\\frac{2}{5}}.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{2}{5}}}$$", "id": "1387078"}]}