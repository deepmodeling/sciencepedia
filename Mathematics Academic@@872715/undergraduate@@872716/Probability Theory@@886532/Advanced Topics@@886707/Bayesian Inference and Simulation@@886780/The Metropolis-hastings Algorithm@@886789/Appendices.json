{"hands_on_practices": [{"introduction": "To begin, let's solidify our understanding of the core acceptance mechanism in its simplest form. This exercise uses a symmetric proposal distribution, which reduces the Metropolis-Hastings algorithm to the original Metropolis algorithm. Here, the decision to accept a new state depends solely on the ratio of the target distribution's probabilities at the new and current states, providing a clear look at the 'uphill' versus 'downhill' move logic. [@problem_id:1962612]", "problem": "A statistician is implementing a Markov Chain Monte Carlo (MCMC) simulation to generate samples from a target probability distribution. The chosen target distribution is a Poisson distribution, which models the number of events, $k$, occurring in a fixed interval of time or space. The probability mass function for a Poisson distribution is given by:\n$$ P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!} $$\nwhere $\\lambda$ is the average rate of events. For this specific simulation, the parameter is set to $\\lambda = 5$.\n\nThe simulation uses the Metropolis-Hastings algorithm with a symmetric proposal distribution, meaning the probability of proposing a move from state $k_1$ to state $k_2$ is the same as proposing a move from $k_2$ to $k_1$.\n\nSuppose the current state of the chain is $k=5$. The algorithm then proposes a move to a new state, $k'=6$.\n\nCalculate the acceptance probability for this proposed move from $k=5$ to $k'=6$. Express your answer as a decimal rounded to three significant figures.", "solution": "In the Metropolis-Hastings algorithm with a symmetric proposal distribution, the acceptance probability for a proposed move from state $k$ to $k'$ is\n$$\n\\alpha = \\min\\left(1, \\frac{\\pi(k')}{\\pi(k)}\\right),\n$$\nwhere $\\pi(\\cdot)$ is the target probability mass function. For a Poisson distribution with parameter $\\lambda$, the PMF is\n$$\n\\pi(k) = \\frac{\\lambda^{k} \\exp(-\\lambda)}{k!}.\n$$\nTherefore, the ratio simplifies as\n$$\n\\frac{\\pi(k')}{\\pi(k)} = \\frac{\\lambda^{k'} \\exp(-\\lambda) / k'!}{\\lambda^{k} \\exp(-\\lambda) / k!} = \\lambda^{k'-k} \\frac{k!}{k'!}.\n$$\nWith $k=5$, $k'=6$, and $\\lambda=5$, we have $k'-k=1$ and $6! = 6 \\cdot 5!$, so\n$$\n\\frac{\\pi(6)}{\\pi(5)} = \\lambda \\cdot \\frac{5!}{6!} = \\lambda \\cdot \\frac{1}{6} = \\frac{5}{6}.\n$$\nHence, the acceptance probability is\n$$\n\\alpha = \\min\\left(1, \\frac{5}{6}\\right) = \\frac{5}{6}.\n$$\nExpressed as a decimal rounded to three significant figures, this is $0.833$.", "answer": "$$\\boxed{0.833}$$", "id": "1962612"}, {"introduction": "Building on the symmetric case, we now explore what happens when the proposal distribution is asymmetric, the crucial step that elevates the Metropolis algorithm to the more general Metropolis-Hastings algorithm. This practice demonstrates the importance of the 'Hastings correction'—the ratio of proposal probabilities—which ensures the sampler correctly explores the target distribution by accounting for any bias in the proposed moves. [@problem_id:1343415]", "problem": "A computational physicist is developing a Markov Chain Monte Carlo (MCMC) simulation to generate samples from a specific target probability distribution over the set of positive integers $\\mathbb{Z}^+ = \\{1, 2, 3, \\dots\\}$. The target distribution, $\\pi(k)$, is proportional to $a^{k-1}$ for some constant $a$ where $0 < a < 1$. That is, $\\pi(k) \\propto a^{k-1}$.\n\nThe simulation uses the Metropolis-Hastings algorithm with a random walk proposal mechanism. From a current state $k$, a candidate state $j$ is proposed according to the following rules:\n- With probability $p$, the proposed candidate state is $j = k+1$.\n- With probability $1-p$, the proposed candidate state is $j = k-1$.\n\nTo ensure the process remains on the positive integers, a boundary condition is imposed: if the current state is $k=1$ and a move to $k-1$ is selected, the proposed candidate state is instead taken to be $j=1$. In all other cases, the proposals proceed as described.\n\nThe probability for proposing an upward move is set to $p = \\frac{1}{3}$.\n\nDetermine the value of the parameter $a$ for the target distribution that ensures the Metropolis-Hastings acceptance probability for any proposed move from an arbitrary state $k$ to state $k+1$ is exactly $\\frac{1}{2}$. Express your answer as a single numerical value.", "solution": "We use the Metropolis-Hastings acceptance probability for a proposed move from state $k$ to state $j$, given by\n$$\n\\alpha(k \\to j) = \\min\\left(1, \\frac{\\pi(j)\\, q(k \\mid j)}{\\pi(k)\\, q(j \\mid k)}\\right).\n$$\nThe target distribution is geometric on $\\mathbb{Z}^{+}$ with $\\pi(k) \\propto a^{k-1}$ for $0<a<1$, so for consecutive states we have\n$$\n\\frac{\\pi(k+1)}{\\pi(k)} = a.\n$$\nThe proposal is a nearest-neighbor random walk with\n$$\nq(k+1 \\mid k) = p, \\qquad q(k \\mid k+1) = 1-p,\n$$\nwhich holds for all $k \\geq 1$ under the given boundary rule (the boundary only affects proposals from $k=1$ to $k-1$, not the reverse probabilities needed here).\n\nTherefore, for an upward proposal $j = k+1$, the Metropolis-Hastings acceptance ratio is\n$$\nr(k \\to k+1) = \\frac{\\pi(k+1)\\, q(k \\mid k+1)}{\\pi(k)\\, q(k+1 \\mid k)} = \\frac{a \\, (1-p)}{p}.\n$$\nThe acceptance probability is then\n$$\n\\alpha(k \\to k+1) = \\min\\left(1, \\frac{a \\, (1-p)}{p}\\right).\n$$\nWe are told that the acceptance probability for any proposed move from $k$ to $k+1$ must be exactly $\\frac{1}{2}$. Since $\\alpha$ equals the ratio when the ratio is less than $1$, we enforce\n$$\n\\frac{a \\, (1-p)}{p} = \\frac{1}{2}.\n$$\nWith $p = \\frac{1}{3}$, we compute\n$$\n\\frac{a \\left(1 - \\frac{1}{3}\\right)}{\\frac{1}{3}} = \\frac{a \\left(\\frac{2}{3}\\right)}{\\frac{1}{3}} = 2a = \\frac{1}{2},\n$$\nwhich yields\n$$\na = \\frac{1}{4}.\n$$\nThis value satisfies $0<a<1$ and makes the acceptance probability exactly $\\frac{1}{2}$ for all $k$.", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "1343415"}, {"introduction": "Now we move into a continuous state space and confront one of the most important practical aspects of implementing MCMC: tuning the sampler. This thought experiment contrasts a small, local move with a large, exploratory jump across a low-probability region. By comparing their acceptance probabilities, we can develop an intuition for the critical trade-off between a high acceptance rate and the sampler's ability to efficiently explore the entire state space, a key challenge in real-world applications. [@problem_id:1401728]", "problem": "A researcher is implementing the Metropolis-Hastings (MH) algorithm to generate samples from a one-dimensional target probability distribution. The probability density function, $p(x)$, of this distribution is known to be proportional to a function $f(x)$, where $f(x) = \\exp(8x^2 - x^4)$. The algorithm proceeds by proposing a new state, $x'$, from the current state, $x_t$, using a proposal distribution $q(x'|x_t)$. For this particular implementation, the proposal distribution is a symmetric normal distribution, $q(x'|x_t) = N(x'|x_t, \\sigma^2)$, which simplifies the MH procedure to the Metropolis algorithm.\n\nSuppose the sampler is currently at the state $x_t = 2.0$, which corresponds to a local maximum (a mode) of the target probability density. The researcher wishes to understand how the acceptance probability changes for different types of proposed moves. They consider two specific, hypothetical proposals:\n\n1.  A small, local move to the proposed state $x'_S = 2.1$.\n2.  A large, exploratory move to the proposed state $x'_L = -1.5$, which is on the other side of a low-probability region centered at $x=0$.\n\nLet $A_S$ be the acceptance probability for the small move from $x_t$ to $x'_S$, and let $A_L$ be the acceptance probability for the large move from $x_t$ to $x'_L$.\n\nCalculate the ratio $\\frac{A_S}{A_L}$. Round your final answer to three significant figures.", "solution": "In the Metropolis-Hastings algorithm, the acceptance probability for a proposal from $x_{t}$ to $x'$ is\n$$\nA(x_{t}\\to x')=\\min\\left(1,\\frac{p(x')\\,q(x_{t}|x')}{p(x_{t})\\,q(x'|x_{t})}\\right).\n$$\nFor a symmetric proposal $q(x'|x_{t})=q(x_{t}|x')$, this reduces to the Metropolis rule\n$$\nA(x_{t}\\to x')=\\min\\left(1,\\frac{p(x')}{p(x_{t})}\\right).\n$$\nGiven $p(x)\\propto f(x)$ with $f(x)=\\exp(8x^{2}-x^{4})$, the normalization cancels in the ratio, so\n$$\n\\frac{p(x')}{p(x_{t})}=\\frac{f(x')}{f(x_{t})}=\\exp\\!\\left(8\\bigl(x'^{2}-x_{t}^{2}\\bigr)-\\bigl(x'^{4}-x_{t}^{4}\\bigr)\\right).\n$$\n\nFor the small move $x_{t}=2.0$ to $x'_{S}=2.1$:\n- $x_{t}^{2}=4$, $x_{t}^{4}=16$; $x_{S}'^{2}=4.41$, $x_{S}'^{4}=19.4481$.\n- Exponent difference:\n$$\n8\\bigl(4.41-4\\bigr)-\\bigl(19.4481-16\\bigr)=8\\cdot 0.41-3.4481=3.28-3.4481=-0.1681.\n$$\nThus\n$$\n\\frac{p(x'_{S})}{p(x_{t})}=\\exp(-0.1681)<1,\\quad A_{S}=\\exp(-0.1681).\n$$\n\nFor the large move $x_{t}=2.0$ to $x'_{L}=-1.5$:\n- $x_{L}'^{2}=2.25$, $x_{L}'^{4}=5.0625$.\n- Exponent difference:\n$$\n8\\bigl(2.25-4\\bigr)-\\bigl(5.0625-16\\bigr)=8\\cdot(-1.75)-(-10.9375)=-14+10.9375=-3.0625.\n$$\nThus\n$$\n\\frac{p(x'_{L})}{p(x_{t})}=\\exp(-3.0625)<1,\\quad A_{L}=\\exp(-3.0625).\n$$\n\nTherefore, the ratio of acceptance probabilities is\n$$\n\\frac{A_{S}}{A_{L}}=\\frac{\\exp(-0.1681)}{\\exp(-3.0625)}=\\exp(2.8944)\\approx 18.1\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{18.1}$$", "id": "1401728"}]}