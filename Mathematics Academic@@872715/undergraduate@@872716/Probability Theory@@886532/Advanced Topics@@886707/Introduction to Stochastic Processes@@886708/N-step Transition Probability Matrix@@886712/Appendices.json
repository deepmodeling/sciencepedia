{"hands_on_practices": [{"introduction": "This first exercise provides a direct application of the n-step transition matrix concept. We will model the state of a library book as a simple Markov chain and calculate the probability of its location after two days. This practice [@problem_id:1377143] is fundamental for understanding how squaring the one-step transition matrix, $P$, gives the two-step transition matrix, $P^2$, allowing us to predict future states of the system.", "problem": "The state of a specific book in a university library can be modeled as a discrete-time stochastic process. The state of the book is observed at the end of each day. The possible states for the book are: 'On the Shelf' (S), 'Checked Out' (C), or 'In Reshelving' (R).\n\nThe transitions between these states follow a set of fixed probabilities:\n- If a book is 'On the Shelf' on a given day, there is a 0.15 probability that it will be 'Checked Out' the next day. Otherwise, it remains 'On the Shelf'.\n- If a book is 'Checked Out', there is a 0.25 probability that it will be returned and move to the 'In Reshelving' state the next day. Otherwise, it remains 'Checked Out'.\n- If a book is 'In Reshelving', there is a 0.90 probability that it will be placed 'On the Shelf' the next day. Otherwise, it remains 'In Reshelving'.\n\nAssume that a book cannot move from 'On the Shelf' to 'In Reshelving', from 'Checked Out' to 'On the Shelf', or from 'In Reshelving' to 'Checked Out' in a single day.\n\nSuppose a particular book is currently 'On the Shelf'. What is the probability that this same book will be 'On the Shelf' again exactly two days from now? Express your answer as a decimal rounded to three significant figures.", "solution": "Let the states be $S$ (On the Shelf), $C$ (Checked Out), and $R$ (In Reshelving). The one-step transition matrix $P$ with row/column order $(S,C,R)$ is\n$$\nP=\\begin{pmatrix}\n0.85 & 0.15 & 0 \\\\\n0 & 0.75 & 0.25 \\\\\n0.90 & 0 & 0.10\n\\end{pmatrix}.\n$$\nThe probability that a book starting in $S$ is in $S$ exactly two days later is the two-step transition probability $(P^{2})_{SS}$, given by\n$$\n(P^{2})_{SS}=\\sum_{x\\in\\{S,C,R\\}} P_{Sx}P_{xS}\n= P_{SS}P_{SS}+P_{SC}P_{CS}+P_{SR}P_{RS}.\n$$\nFrom the transition structure, $P_{SS}=0.85$, $P_{SC}=0.15$, $P_{CS}=0$, $P_{SR}=0$, and $P_{RS}=0.90$. Therefore,\n$$\n(P^{2})_{SS}=0.85^{2}+0.15\\cdot 0+0\\cdot 0.90=0.7225.\n$$\nRounding to three significant figures gives $0.723$.", "answer": "$$\\boxed{0.723}$$", "id": "1377143"}, {"introduction": "Building upon the previous example, this problem scales up the timeline to predict outcomes over a longer duration. You will determine the complete 5-step transition matrix for a commuter's daily choice of transport. This exercise [@problem_id:1377157] provides an excellent opportunity to apply more efficient techniques for computing matrix powers, such as diagonalization, which are essential for analyzing the long-term behavior of a Markov chain.", "problem": "A commuter's daily choice of transport to work is between driving their car (State 1) and taking the train (State 2). The choice for any given day is influenced by the choice made on the preceding day. The probabilities governing this daily decision are as follows:\n\n*   If the commuter drives on day $k$, the probability they will also drive on day $k+1$ is $0.7$.\n*   If the commuter takes the train on day $k$, the probability they will drive on day $k+1$ is $0.2$.\n\nAssume that for any given day $k$, the commuter must either drive or take the train, and that these two options are mutually exclusive. The transition probabilities are constant for all days.\n\nDetermine the 5-step transition probability matrix, $P^{(5)}$, where the element $(i, j)$ of the matrix represents the probability that the commuter who uses transport method $i$ on a given day will use transport method $j$ five days later. Present your final answer as a $2 \\times 2$ matrix, rounding each entry to four significant figures.", "solution": "Let State 1 be 'Drive' and State 2 be 'Train'. We are given the probabilities of transitioning from one state to another in a single day. We can use these to construct the one-step transition probability matrix $P$. The element $P_{ij}$ of this matrix is the probability of moving from state $i$ to state $j$ in one day.\n\nFrom the problem statement:\nThe probability of driving on day $k+1$ given the commuter drove on day $k$ is $P_{11} = 0.7$.\nSince there are only two states, the probability of taking the train on day $k+1$ given a drive on day $k$ must be $P_{12} = 1 - P_{11} = 1 - 0.7 = 0.3$.\n\nThe probability of driving on day $k+1$ given the commuter took the train on day $k$ is $P_{21} = 0.2$.\nSimilarly, the probability of taking the train again on day $k+1$ given a train ride on day $k$ is $P_{22} = 1 - P_{21} = 1 - 0.2 = 0.8$.\n\nThe one-step transition matrix $P$ is therefore:\n$$\nP = \\begin{pmatrix} 0.7 & 0.3 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\nThe 5-step transition probability matrix, $P^{(5)}$, is given by the fifth power of the one-step transition matrix, i.e., $P^{(5)} = P^5$. To compute this efficiently, we diagonalize the matrix $P$. The diagonalization of a matrix $P$ is given by $P = VDV^{-1}$, where $D$ is a diagonal matrix of eigenvalues and $V$ is a matrix whose columns are the corresponding eigenvectors.\n\nFirst, we find the eigenvalues ($\\lambda$) of $P$ by solving the characteristic equation $\\det(P - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} 0.7-\\lambda & 0.3 \\\\ 0.2 & 0.8-\\lambda \\end{pmatrix} = (0.7-\\lambda)(0.8-\\lambda) - (0.3)(0.2) = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.56 - 0.06 = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.5 = 0\n$$\nThis quadratic equation can be factored as $(\\lambda - 1)(\\lambda - 0.5) = 0$.\nThe eigenvalues are $\\lambda_1 = 1$ and $\\lambda_2 = 0.5$.\n\nNext, we find the corresponding eigenvectors.\nFor $\\lambda_1 = 1$, we solve $(P - I)v_1 = 0$:\n$$\n\\begin{pmatrix} 0.7-1 & 0.3 \\\\ 0.2 & 0.8-1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} -0.3 & 0.3 \\\\ 0.2 & -0.2 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the equation $-0.3x + 0.3y = 0$, which simplifies to $x=y$. A simple choice for the eigenvector is $v_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nFor $\\lambda_2 = 0.5$, we solve $(P - 0.5I)v_2 = 0$:\n$$\n\\begin{pmatrix} 0.7-0.5 & 0.3 \\\\ 0.2 & 0.8-0.5 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0.2 & 0.3 \\\\ 0.2 & 0.3 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the equation $0.2x + 0.3y = 0$, which simplifies to $2x = -3y$. A simple choice for the eigenvector is $v_2 = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix}$.\n\nNow we construct the matrices $V$, $D$, and $V^{-1}$:\n$$\nV = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.5 \\end{pmatrix}\n$$\nThe inverse of $V$ is:\n$$\nV^{-1} = \\frac{1}{(1)(-2) - (3)(1)} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\frac{1}{-5} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2/5 & 3/5 \\\\ 1/5 & -1/5 \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\nNow we can compute $P^5$ using the formula $P^5 = VD^5V^{-1}$.\nFirst, we find $D^5$:\n$$\nD^5 = \\begin{pmatrix} 1^5 & 0 \\\\ 0 & (0.5)^5 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix}\n$$\nNow, we perform the matrix multiplication $P^5 = V D^5 V^{-1}$:\n$$\nP^5 = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\nFirst, multiply $V D^5$:\n$$\nV D^5 = \\begin{pmatrix} 1 \\cdot 1 & 3 \\cdot 0.03125 \\\\ 1 \\cdot 1 & -2 \\cdot 0.03125 \\end{pmatrix} = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix}\n$$\nThen, multiply the result by $V^{-1}$:\n$$\nP^5 = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\nNow we compute the elements of the final matrix:\n$$\nP^{(5)}_{11} = (1)(0.4) + (0.09375)(0.2) = 0.4 + 0.01875 = 0.41875\n$$\n$$\nP^{(5)}_{12} = (1)(0.6) + (0.09375)(-0.2) = 0.6 - 0.01875 = 0.58125\n$$\n$$\nP^{(5)}_{21} = (1)(0.4) + (-0.0625)(0.2) = 0.4 - 0.0125 = 0.3875\n$$\n$$\nP^{(5)}_{22} = (1)(0.6) + (-0.0625)(-0.2) = 0.6 + 0.0125 = 0.6125\n$$\nSo, the 5-step transition matrix is:\n$$\nP^{(5)} = \\begin{pmatrix} 0.41875 & 0.58125 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$\nFinally, we round each element to four significant figures:\n$P^{(5)}_{11} = 0.41875 \\approx 0.4188$\n$P^{(5)}_{12} = 0.58125 \\approx 0.5813$\n$P^{(5)}_{21} = 0.3875$ (already has four significant figures)\n$P^{(5)}_{22} = 0.6125$ (already has four significant figures)\n\nThe final matrix is:\n$$\nP^{(5)} \\approx \\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}}\n$$", "id": "1377157"}, {"introduction": "Our final practice problem introduces a layer of complexity common in real-world analysis: conditional events. You are asked to calculate the probability of a server's future state, given that a certain intermediate state was avoided. This exercise [@problem_id:1377144] challenges you to integrate your knowledge of n-step transitions with the fundamental principles of conditional probability, demonstrating how to update predictions based on partial information about the system's trajectory.", "problem": "A specialized server in a data center is monitored daily. Its operational status is modeled as a discrete-time Markov chain with four possible states: State 1 (Nominal), State 2 (Throttled), State 3 (Updating), and State 4 (Crashed). The state transitions occur daily according to the following one-step transition probability matrix $P$, where the entry $p_{ij}$ represents the probability of transitioning from state $i$ to state $j$ in one day:\n$$\nP = \\begin{pmatrix}\n1/2 & 1/4 & 1/8 & 1/8 \\\\\n1/4 & 1/2 & 1/4 & 0 \\\\\n3/4 & 0 & 1/4 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nSuppose the server is in the Nominal state (State 1) on Day 0. Given that the server does not enter the Crashed state on Day 1, what is the probability that it will be in the Updating state (State 3) on Day 2?\n\nExpress your answer as a simplified fraction.", "solution": "Let $X_n$ denote the state on Day $n$, with the initial state $X_0=1$. We need to find the conditional probability $P(X_2=3 \\mid X_1 \\neq 4, X_0=1)$.\n\nBy the definition of conditional probability, this is:\n$$\nP(X_2=3 \\mid X_1 \\neq 4, X_0=1) = \\frac{P(X_2=3 \\text{ and } X_1 \\neq 4 \\mid X_0=1)}{P(X_1 \\neq 4 \\mid X_0=1)}\n$$\n\nThe denominator is the probability of not entering the 'Crashed' state on Day 1, which is $P(X_1 \\neq 4 \\mid X_0=1) = 1 - p_{14} = 1 - 1/8 = 7/8$.\n\nFor the numerator, we consider the joint probability of being in State 3 on Day 2 AND not being in State 4 on Day 1. The probability of being in State 3 on Day 2, starting from State 1, is the two-step transition probability $(P^2)_{13}$.\n$$\n(P^2)_{13} = \\sum_{k=1}^{4} p_{1k}p_{k3} = p_{11}p_{13} + p_{12}p_{23} + p_{13}p_{33} + p_{14}p_{43}\n$$\nSince $p_{43}=0$, any path that reaches state 3 at time 2 could not have passed through state 4 at time 1. Therefore, the event $X_2=3$ implies that $X_1 \\neq 4$. The numerator simplifies to just $P(X_2=3 \\mid X_0=1) = (P^2)_{13}$.\nLet's compute this value:\n$$\n(P^2)_{13} = (\\frac{1}{2})(\\frac{1}{8}) + (\\frac{1}{4})(\\frac{1}{4}) + (\\frac{1}{8})(\\frac{1}{4}) + (\\frac{1}{8})(0) = \\frac{1}{16} + \\frac{1}{16} + \\frac{1}{32} = \\frac{5}{32}\n$$\nNow, we can find the conditional probability:\n$$\nP(X_2=3 \\mid X_1 \\neq 4, X_0=1) = \\frac{(P^2)_{13}}{1 - p_{14}} = \\frac{5/32}{7/8} = \\frac{5}{32} \\cdot \\frac{8}{7} = \\frac{5}{28}\n$$\nThe desired probability is $\\frac{5}{28}$.", "answer": "$$\\boxed{\\frac{5}{28}}$$", "id": "1377144"}]}