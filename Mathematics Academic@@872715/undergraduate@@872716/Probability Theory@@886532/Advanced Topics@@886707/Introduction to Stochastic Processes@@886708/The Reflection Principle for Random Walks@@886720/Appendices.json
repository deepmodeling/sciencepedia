{"hands_on_practices": [{"introduction": "The reflection principle's elegance is often revealed in conditional probability scenarios. This first practice problem [@problem_id:1405585] explores a classic question rooted in the \"Ballot Problem\": given a random walk ends at a positive value, what is the chance it remained strictly above its starting point for the entire duration? The surprisingly simple result demonstrates the power of this principle in analyzing the fundamental properties of random paths.", "problem": "An algorithmic trading bot analyzes the price of a volatile cryptocurrency. The bot models the price movement as a simple symmetric random walk. Starting from a reference price, which we set to $0$, the price changes by either +$1 or -$1 at the end of each minute with equal probability.\n\nThe bot is programmed with a specific risk-management rule: it will hold the asset as long as its price remains strictly above the initial purchase price. If the price ever returns to or drops below the initial price at any minute after the purchase, the bot immediately sells the asset.\n\nSuppose the bot purchases the asset and a period of $2n$ minutes elapses. It is observed that at the end of these $2n$ minutes, the asset's price is exactly $2k$ dollars above the initial price, where $n$ and $k$ are positive integers with $n \\ge k$.\n\nGiven this observation that the final price is $2k$, what is the probability that the bot did *not* sell the asset at any point during the $2n$ minute interval? Express your answer as a closed-form analytic expression in terms of $n$ and $k$.", "solution": "Let $\\{X_{t}\\}_{t=1}^{2n}$ be i.i.d. steps with $\\mathbb{P}(X_{t}=1)=\\mathbb{P}(X_{t}=-1)=\\frac{1}{2}$ and define the random walk $S_{0}=0$, $S_{t}=\\sum_{i=1}^{t}X_{i}$. The bot does not sell during the $2n$ minutes if and only if the path stays strictly above the initial price at all intermediate times, i.e., \n$$\nS_{t}0 \\quad \\text{for all } t\\in\\{1,2,\\ldots,2n\\}.\n$$\n\nCondition on the observed final value $S_{2n}=2k$ with $n\\geq k\\geq 1$. Let $U$ and $D$ denote the total numbers of $+1$ and $-1$ steps, respectively. Then\n$$\nU-D=S_{2n}=2k,\\qquad U+D=2n \\;\\;\\Rightarrow\\;\\; U=n+k,\\; D=n-k.\n$$\nUnder this conditioning, all sequences with exactly $U=n+k$ up steps and $D=n-k$ down steps are equally likely, and their total number is\n$$\nN_{\\text{tot}}=\\binom{2n}{n+k}.\n$$\n\nLet $N_{+}$ be the number of such sequences whose partial sums are strictly positive at all times $t=1,\\ldots,2n$. The condition $S_{t}0$ for all $t$ is equivalent to having, for every prefix of the sequence, strictly more up steps than down steps, i.e., $U_{t}D_{t}$ for all $t$. By Bertrandâ€™s ballot theorem, given $UD$, the number of sequences with $U_{t}D_{t}$ for all $t$ is\n$$\nN_{+}=\\frac{U-D}{U+D}\\,N_{\\text{tot}}=\\frac{(n+k)-(n-k)}{(n+k)+(n-k)}\\,\\binom{2n}{n+k}=\\frac{2k}{2n}\\,\\binom{2n}{n+k}.\n$$\nTherefore, the desired conditional probability is\n$$\n\\mathbb{P}\\!\\left(\\text{no sell during }2n\\ \\big|\\ S_{2n}=2k\\right)=\\frac{N_{+}}{N_{\\text{tot}}}=\\frac{2k}{2n}=\\frac{k}{n}.\n$$\nThis is a closed-form expression in terms of $n$ and $k$.", "answer": "$$\\boxed{\\frac{k}{n}}$$", "id": "1405585"}, {"introduction": "Building on the idea of conditioning, we now investigate the entire structure of paths that are constrained to remain non-negative. This exercise [@problem_id:1405580] asks for the conditional probability distribution of the final endpoint, given the walk never dipped below its starting position. Solving this requires a clever application of the reflection principle to count not just one type of path, but a whole family of them, revealing the statistical shape of these \"meandering\" walks.", "problem": "A particle undergoes a one-dimensional simple symmetric random walk on the integers. Its position after $n$ steps is denoted by $S_n$, with the starting position being $S_0=0$. At each step, the particle moves one unit to the right ($+1$) or one unit to the left ($-1$) with equal probability. The position at step $n$ can be expressed as $S_n = \\sum_{i=1}^n X_i$, where the $X_i$ are independent, identically distributed random variables with $P(X_i=1) = P(X_i=-1) = 1/2$.\n\nIn an experiment, only the paths for which the particle's position remains non-negative are considered valid. That is, a path is valid only if $S_i \\geq 0$ for all time steps $i \\in \\{0, 1, \\dots, n\\}$.\n\nGiven that a path of length $n$ is valid, what is the conditional probability that its final position is $S_n = k$? Assume $k$ is a non-negative integer that has the same parity as $n$ (i.e., $n-k$ is an even number) and $k \\leq n$.\n\nChoose the correct expression for this conditional probability from the options below. In the options, $\\binom{n}{k}$ denotes the binomial coefficient \"n choose k\", and $\\lfloor x \\rfloor$ denotes the floor function, which gives the greatest integer less than or equal to $x$.\n\nA. $\\frac{\\binom{n}{(n+k)/2}}{\\binom{n}{\\lfloor n/2 \\rfloor}}$\n\nB. $\\frac{\\binom{n}{(n+k)/2} - \\binom{n-1}{(n+k)/2}}{\\binom{n}{\\lfloor n/2 \\rfloor}}$\n\nC. $\\frac{\\binom{n}{(n+k)/2}}{\\sum_{j=0}^{n} \\binom{n}{j}}$\n\nD. $\\frac{\\binom{n}{(n+k)/2} - \\binom{n}{(n+k+2)/2}}{\\binom{n}{\\lfloor n/2 \\rfloor}}$\n\nE. $\\frac{\\binom{n-1}{(n+k-2)/2}}{\\binom{n-1}{\\lfloor (n-1)/2 \\rfloor}}$", "solution": "Let $A$ be the event that the particle's final position is $S_n = k$.\nLet $B$ be the event that the particle's position remains non-negative for all steps, i.e., $S_i \\ge 0$ for all $i \\in \\{0, 1, \\dots, n\\}$.\nWe are asked to find the conditional probability $P(A|B)$.\n\nUsing the definition of conditional probability, we have:\n$$ P(A|B) = \\frac{P(A \\cap B)}{P(B)} $$\nSince each of the $2^n$ possible paths of length $n$ is equally likely, this probability can be calculated as the ratio of the number of favorable paths:\n$$ P(A|B) = \\frac{|A \\cap B|}{|B|} $$\nwhere $|A \\cap B|$ is the number of paths that end at $S_n=k$ and always stay non-negative, and $|B|$ is the total number of paths that always stay non-negative.\n\nFirst, let's calculate $|A \\cap B|$. This is the number of paths from $(0,0)$ to $(n,k)$ that do not touch the line $y=-1$. We can find this using the reflection principle.\nA path from $(0,0)$ to $(n,k)$ consists of $n$ steps. Let $u$ be the number of steps to the right ($+1$) and $d$ be the number of steps to the left ($-1$). We must have:\n$u + d = n$\n$u - d = k$\nSolving this system of equations gives $u = (n+k)/2$ and $d = (n-k)/2$. The total number of paths from $(0,0)$ to $(n,k)$ without any constraints is given by the binomial coefficient $\\binom{n}{u} = \\binom{n}{(n+k)/2}$.\n\nThe number of \"bad\" paths from $(0,0)$ to $(n,k)$ that touch or cross the line $y=-1$ can be found using the reflection principle. The number of such paths is equal to the total number of paths from a reflected starting point $(0, -2)$ to $(n,k)$. Note that a path hits integer level $-1$. Reflecting the starting point $(0,0)$ across the line $y=-1$ gives $(0,-2)$.\nFor a path from $(0,-2)$ to $(n,k)$:\nThe number of steps is $n$.\nThe net displacement is $k - (-2) = k+2$.\nLet $u'$ be the number of up steps and $d'$ be the number of down steps.\n$u' + d' = n$\n$u' - d' = k+2$\nSolving this gives $u' = (n+k+2)/2$. The number of \"bad\" paths is $\\binom{n}{u'} = \\binom{n}{(n+k+2)/2}$.\n\nThe number of \"good\" paths, $|A \\cap B|$, is the total number of paths minus the number of \"bad\" paths:\n$$ |A \\cap B| = \\binom{n}{(n+k)/2} - \\binom{n}{(n+k+2)/2} $$\n\nNext, we calculate $|B|$, the total number of paths of length $n$ that stay non-negative. This is the sum of the number of non-negative paths to all possible final positions $k$.\n$$ |B| = \\sum_{k} |\\{\\text{path to } S_n=k \\text{ with } S_i \\ge 0\\}| $$\nThe summation is over all possible values of $k$ (non-negative, same parity as $n$).\n$$ |B| = \\sum_{k} \\left( \\binom{n}{(n+k)/2} - \\binom{n}{(n+k+2)/2} \\right) $$\nLet $j = (n+k)/2$. As $k$ increases by 2, $j$ increases by 1. The sum becomes a telescoping series.\nLet's find the range for $j$. The smallest possible value of $k$ is $0$ (if $n$ is even) or $1$ (if $n$ is odd).\nIf $n$ is even, smallest $k=0$, so smallest $j=n/2$.\nIf $n$ is odd, smallest $k=1$, so smallest $j=(n+1)/2$.\nIn both cases, the smallest value of $j$ is $\\lceil n/2 \\rceil$.\nThe largest possible value of $k$ is $n$, so the largest value of $j$ is $(n+n)/2 = n$.\n\nThe sum is:\n$$ |B| = \\left(\\binom{n}{\\lceil n/2 \\rceil} - \\binom{n}{\\lceil n/2 \\rceil+1}\\right) + \\left(\\binom{n}{\\lceil n/2 \\rceil+1} - \\binom{n}{\\lceil n/2 \\rceil+2}\\right) + \\dots + \\left(\\binom{n}{n} - \\binom{n}{n+1}\\right) $$\nThis telescopes to:\n$$ |B| = \\binom{n}{\\lceil n/2 \\rceil} - \\binom{n}{n+1} $$\nSince $\\binom{n}{n+1} = 0$, we have:\n$$ |B| = \\binom{n}{\\lceil n/2 \\rceil} $$\nNote that $\\binom{n}{\\lceil n/2 \\rceil} = \\binom{n}{\\lfloor n/2 \\rfloor}$ because $\\lceil n/2 \\rceil + \\lfloor n/2 \\rfloor = n$. So we can write $|B| = \\binom{n}{\\lfloor n/2 \\rfloor}$.\n\nFinally, we compute the conditional probability:\n$$ P(A|B) = \\frac{|A \\cap B|}{|B|} = \\frac{\\binom{n}{(n+k)/2} - \\binom{n}{(n+k+2)/2}}{\\binom{n}{\\lfloor n/2 \\rfloor}} $$\n\nThis matches option D.", "answer": "$$\\boxed{D}$$", "id": "1405580"}, {"introduction": "Our final practice problem [@problem_id:1405583] pushes the application of the reflection principle to its fullest extent by tackling conditional expectations. Here, we fix the final destination of the random walk and ask for the expected maximum height it achieved along the way. This involves using the reflection principle to derive the conditional probability distribution of the maximum value, a powerful technique for understanding the extreme behavior of random processes.", "problem": "A programmable nanoparticle is constrained to move along a one-dimensional track. Starting from an origin point defined as $x=0$, it performs a series of $n$ discrete steps. For each step, it moves a fixed distance $L$ either in the positive direction or the negative direction, with equal probability of $1/2$ for each choice.\n\nLet the position of the particle after $k$ steps be $x_k$. The entire process consists of $n=10$ steps. At the end of the process, a measurement reveals that the nanoparticle is located at the final position $x_{10} = 2L$.\n\nGiven this final position, what is the expected value of the maximum positive position, $\\max_{0 \\le k \\le 10} \\{x_k\\}$, reached by the nanoparticle during its journey? Express your answer as a single fraction multiplied by $L$.", "solution": "Let $S_{k}$ be the simple symmetric random walk with $S_{0}=0$ and increments $\\pm 1$ with probability $1/2$, so $x_{k}=L S_{k}$. We are given $S_{10}=2$ (equivalently $x_{10}=2L$). Define the maximum of the walk by $M=\\max_{0\\leq k \\leq 10} S_{k}$. The desired expectation is\n$$\n\\mathbb{E}\\!\\left[\\max_{0\\leq k\\leq 10} x_{k}\\,\\big|\\,x_{10}=2L\\right]\n= L\\,\\mathbb{E}\\!\\left[M\\,\\big|\\,S_{10}=2\\right].\n$$\nThus it suffices to compute $\\mathbb{E}[M\\,|\\,S_{10}=2]$.\n\nConditioned on $S_{10}=2$, the walk has exactly $6$ up-steps and $4$ down-steps, and all $\\binom{10}{6}$ such sequences are equally likely. To find the distribution of $M$ conditioned on $S_{10}=2$, we use the reflection principle for an upper barrier. For integers $m$, let $N_{\\leq m}$ denote the number of length-$10$ paths from $0$ to $2$ whose maximum is at most $m$. By the reflection principle, the number of paths that hit level $m+1$ at least once is equal to the number of unrestricted paths from the reflected starting point $2(m+1)$ to $2$ in $10$ steps. Therefore, the number of paths to 2 that hit $m+1$ is $\\binom{10}{\\frac{10+(2-2(m+1))}{2}} = \\binom{10}{5-m}$. Hence\n$$\nN_{\\leq m}\n= \\binom{10}{\\frac{10+2}{2}} - \\binom{10}{5 - m}\n= \\binom{10}{6} - \\binom{10}{5 - m},\n$$\nwith the convention that $\\binom{10}{k}=0$ if $k0$ or $k10$. Hence\n$$\n\\mathbb{P}(M \\leq m \\mid S_{10}=2)\n= \\frac{N_{\\leq m}}{\\binom{10}{6}}\n= 1 - \\frac{\\binom{10}{5 - m}}{\\binom{10}{6}}.\n$$\nBecause $S_{10}=2$, necessarily $M\\in\\{2,3,4,5,6\\}$. Evaluate $\\mathbb{P}(M \\leq m \\mid S_{10}=2)$ for $m=2,3,4,5,6$ using $\\binom{10}{6}=210$ and the values $\\binom{10}{3}=120$, $\\binom{10}{2}=45$, $\\binom{10}{1}=10$, $\\binom{10}{0}=1$:\n$$\n\\mathbb{P}(M \\leq 2 \\mid S_{10}=2)=1 - \\frac{120}{210}=\\frac{90}{210}=\\frac{3}{7},\n$$\n$$\n\\mathbb{P}(M \\leq 3 \\mid S_{10}=2)=1 - \\frac{45}{210}=\\frac{165}{210}=\\frac{11}{14},\n$$\n$$\n\\mathbb{P}(M \\leq 4 \\mid S_{10}=2)=1 - \\frac{10}{210}=\\frac{200}{210}=\\frac{20}{21},\n$$\n$$\n\\mathbb{P}(M \\leq 5 \\mid S_{10}=2)=1 - \\frac{1}{210}=\\frac{209}{210},\n$$\n$$\n\\mathbb{P}(M \\leq 6 \\mid S_{10}=2)=1 - \\frac{0}{210} = 1.\n$$\nThus\n$$\n\\mathbb{P}(M=2 \\mid S_{10}=2)=\\frac{3}{7},\\quad\n\\mathbb{P}(M=3 \\mid S_{10}=2)=\\frac{11}{14}-\\frac{3}{7}=\\frac{5}{14},\n$$\n$$\n\\mathbb{P}(M=4 \\mid S_{10}=2)=\\frac{20}{21}-\\frac{11}{14}=\\frac{1}{6},\\quad\n\\mathbb{P}(M=5 \\mid S_{10}=2)=\\frac{209}{210}-\\frac{20}{21}=\\frac{9}{210}=\\frac{3}{70},\n$$\n$$\n\\mathbb{P}(M=6 \\mid S_{10}=2)=1-\\frac{209}{210}=\\frac{1}{210}.\n$$\nHence\n$$\n\\mathbb{E}[M \\mid S_{10}=2]\n= 2\\cdot\\frac{3}{7}+3\\cdot\\frac{5}{14}+4\\cdot\\frac{1}{6}+5\\cdot\\frac{3}{70}+6\\cdot\\frac{1}{210}.\n$$\nCompute the numerator over the common denominator $210$:\n$$\n\\frac{6 \\cdot 30 + 15 \\cdot 15 + (4/6) \\cdot 210 + (15/70) \\cdot 210 + 6}{210} = \\frac{180 + 225 + 140 + 45 + 6}{210},\n$$\nso\n$$\n\\mathbb{E}[M \\mid S_{10}=2]=\\frac{180+225+140+45+6}{210}=\\frac{596}{210}=\\frac{298}{105}.\n$$\nFinally,\n$$\n\\mathbb{E}\\!\\left[\\max_{0\\leq k\\leq 10} x_{k}\\,\\big|\\,x_{10}=2L\\right]\n= L\\,\\mathbb{E}[M \\mid S_{10}=2] = \\frac{298}{105}\\,L.\n$$", "answer": "$$\\boxed{\\frac{298}{105}L}$$", "id": "1405583"}]}