{"hands_on_practices": [{"introduction": "Before using comparison theorems, we must first master the geometry of the model spaces themselves. This exercise focuses on the standard unit sphere, a space of constant sectional curvature $K=1$. By directly calculating an angle in a given geodesic triangle, you will practice applying the spherical law of cosines, a fundamental tool that forms the basis for Toponogov's theorem when the curvature is bounded below by a positive constant [@problem_id:3078543].", "problem": "Let $S^{2}$ denote the standard two-dimensional sphere of radius $1$ with its round Riemannian metric, so that every sectional curvature equals $1$. Consider three points $p,q,r \\in S^{2}$ such that the pairwise geodesic distances are\n$$d(q,r)=\\frac{\\pi}{2},\\quad d(r,p)=\\frac{\\pi}{3},\\quad d(p,q)=\\frac{\\pi}{4},$$\nwith each distance strictly less than $\\pi$ so that the minimizing geodesic segments are unique. Using the triangle comparison framework of the Toponogov comparison theorem for spaces with sectional curvature bounded below by $1$, and the fact that in constant curvature $1$ the comparison triangle is realized on $S^{2}$ itself, determine the interior angle at the vertex $p$ of the geodesic triangle $\\triangle pqr$. Express your final answer as an exact closed-form expression in radians. No rounding is required.", "solution": "The problem requires the determination of an interior angle of a geodesic triangle on the standard two-dimensional sphere, $S^{2}$, which is defined as having a radius of $1$ and, consequently, a constant sectional curvature of $K=1$.\n\nFirst, we establish the context and interpret the guidance provided in the problem statement. The manifold is the standard sphere $S^{2}$, a space of constant sectional curvature $K=1$. The problem asks to find the angle at vertex $p$ of a geodesic triangle $\\triangle pqr$. The side lengths, given as geodesic distances, are:\n$L_{qr} = d(q,r) = \\frac{\\pi}{2}$\n$L_{rp} = d(r,p) = \\frac{\\pi}{3}$\n$L_{pq} = d(p,q) = \\frac{\\pi}{4}$\n\nThe problem statement directs us to use the Toponogov comparison theorem. This theorem relates the geometry of a Riemannian manifold to that of a model space with constant sectional curvature. For a manifold with sectional curvature $K \\ge \\kappa$, the angles of a geodesic triangle are at least as large as the angles of a comparison triangle with the same side lengths in the model space $S^2_\\kappa$ of constant curvature $\\kappa$.\n\nIn this specific problem, the manifold is $S^2$ with constant curvature $K=1$. We can therefore set the comparison curvature $\\kappa=1$. The model space $S^2_1$ is identical to our manifold $S^2$. The problem explicitly notes this: \"in constant curvature $1$ the comparison triangle is realized on $S^2$ itself\". This means that the inequalities in the comparison theorem become equalities. The relationship between the side lengths and a given interior angle of the geodesic triangle $\\triangle pqr$ is therefore precisely described by the laws of spherical trigonometry for a sphere of unit radius.\n\nWe wish to find the interior angle at the vertex $p$, which we denote as $\\alpha_p$. This angle is opposite the side connecting vertices $q$ and $r$, whose length is $L_{qr} = \\frac{\\pi}{2}$. The sides adjacent to the angle $\\alpha_p$ are those connecting $p$ to $r$ and $p$ to $q$, with lengths $L_{rp} = \\frac{\\pi}{3}$ and $L_{pq} = \\frac{\\pi}{4}$, respectively.\n\nThe spherical law of cosines relates the lengths of the sides of a spherical triangle to the cosine of one of its interior angles. For the angle $\\alpha_p$ at vertex $p$, the formula is:\n$$ \\cos(L_{qr}) = \\cos(L_{rp}) \\cos(L_{pq}) + \\sin(L_{rp}) \\sin(L_{pq}) \\cos(\\alpha_p) $$\nWe can rearrange this equation to solve for $\\cos(\\alpha_p)$:\n$$ \\cos(\\alpha_p) = \\frac{\\cos(L_{qr}) - \\cos(L_{rp}) \\cos(L_{pq})}{\\sin(L_{rp}) \\sin(L_{pq})} $$\nNow, we substitute the given geodesic distances into this formula:\n$$ \\cos(\\alpha_p) = \\frac{\\cos\\left(\\frac{\\pi}{2}\\right) - \\cos\\left(\\frac{\\pi}{3}\\right) \\cos\\left(\\frac{\\pi}{4}\\right)}{\\sin\\left(\\frac{\\pi}{3}\\right) \\sin\\left(\\frac{\\pi}{4}\\right)} $$\nWe proceed by evaluating the required trigonometric functions of the given angles:\n$ \\cos\\left(\\frac{\\pi}{2}\\right) = 0 $\n$ \\cos\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{2} $\n$ \\cos\\left(\\frac{\\pi}{4}\\right) = \\frac{\\sqrt{2}}{2} $\n$ \\sin\\left(\\frac{\\pi}{3}\\right) = \\frac{\\sqrt{3}}{2} $\n$ \\sin\\left(\\frac{\\pi}{4}\\right) = \\frac{\\sqrt{2}}{2} $\n\nSubstituting these values into the expression for $\\cos(\\alpha_p)$:\n$$ \\cos(\\alpha_p) = \\frac{0 - \\left(\\frac{1}{2}\\right) \\left(\\frac{\\sqrt{2}}{2}\\right)}{\\left(\\frac{\\sqrt{3}}{2}\\right) \\left(\\frac{\\sqrt{2}}{2}\\right)} $$\n$$ \\cos(\\alpha_p) = \\frac{-\\frac{\\sqrt{2}}{4}}{\\frac{\\sqrt{6}}{4}} $$\nSimplifying the fraction gives:\n$$ \\cos(\\alpha_p) = -\\frac{\\sqrt{2}}{\\sqrt{6}} = -\\frac{\\sqrt{2}}{\\sqrt{2}\\sqrt{3}} = -\\frac{1}{\\sqrt{3}} $$\nThe angle $\\alpha_p$ is then found by taking the arc-cosine of this value. The principal value of the arc-cosine function, with its range $[0, \\pi]$, provides the unique interior angle of the triangle.\n$$ \\alpha_p = \\arccos\\left(-\\frac{1}{\\sqrt{3}}\\right) $$\nThis expression is the exact, closed-form value for the angle at vertex $p$ in radians, as required.", "answer": "$$\\boxed{\\arccos\\left(-\\frac{1}{\\sqrt{3}}\\right)}$$", "id": "3078543"}, {"introduction": "Here we apply the full power of the Toponogov theorem to translate a lower bound on sectional curvature into a concrete geometric constraint. Given a \"hinge\" (two geodesic sides and the included angle) in a general manifold with curvature $K \\ge 1$, your task is to determine the maximum possible length of the third side. This practice exemplifies the core utility of comparison geometry: using the predictable geometry of the sphere to bound the unknown geometry of a more complex space [@problem_id:3078545].", "problem": "Let $M$ be a complete Riemannian manifold with sectional curvature bounded below by $1$, meaning $K \\geq 1$ at every point and for every two-dimensional tangent plane. Consider a geodesic triangle with vertices $p,q,r \\in M$ such that the geodesic segments $\\overline{pq}$ and $\\overline{pr}$ have lengths $d(p,q) = \\frac{\\pi}{3}$ and $d(p,r) = \\frac{\\pi}{3}$, and the angle at $p$ between the initial tangent vectors of the unit-speed minimizing geodesics from $p$ to $q$ and from $p$ to $r$ is $\\frac{\\pi}{3}$. Using only the foundational definitions of sectional curvature, geodesics, and the Toponogov comparison theorem, compare this hinge at $p$ with its model hinge in the unit $2$-sphere of constant curvature $1$ and determine the sharp Toponogov upper bound for the length $d(q,r)$ of the side opposite the angle at $p$.\n\nExpress your final bound in radians and round your answer to four significant figures.", "solution": "The problem requires the determination of a sharp upper bound on the length of one side of a geodesic triangle in a complete Riemannian manifold $M$ whose sectional curvature $K$ is bounded below by $1$, i.e., $K \\ge 1$. The fundamental tool for this is the Toponogov comparison theorem.\n\nLet $(M, g)$ be a complete Riemannian manifold with sectional curvature $K_M \\ge H$ for some real constant $H$. Let $M_H$ be the simply connected space of constant sectional curvature $H$. For a geodesic triangle $\\triangle pqr$ in $M$ formed by minimizing geodesics, we can construct a comparison triangle $\\triangle \\tilde{p}\\tilde{q}\\tilde{r}$ in $M_H$ such that the lengths of two sides and the included angle are identical:\n$d_M(p,q) = d_{M_H}(\\tilde{p},\\tilde{q})$, $d_M(p,r) = d_{M_H}(\\tilde{p},\\tilde{r})$, and $\\angle_{p}(q,r) = \\angle_{\\tilde{p}}(\\tilde{q},\\tilde{r})$.\nProvided the geodesics $\\overline{pq}$ and $\\overline{pr}$ have lengths less than $\\pi/\\sqrt{H}$ (if $H0$), the Toponogov theorem states that the length of the third side of the triangle in $M$ is less than or equal to the length of the third side of the comparison triangle in $M_H$:\n$$d_M(q,r) \\le d_{M_H}(\\tilde{q},\\tilde{r})$$\nThe value $d_{M_H}(\\tilde{q},\\tilde{r})$ is the sharp upper bound.\n\nIn the given problem:\n- The sectional curvature is $K \\ge 1$, so we take the comparison curvature to be $H=1$.\n- The model space $M_1$ is the unit $2$-sphere, $\\mathbb{S}^2$, which has constant sectional curvature $1$.\n- We have a geodesic triangle with vertices $p,q,r \\in M$.\n- The side lengths adjacent to vertex $p$ are given as $d(p,q) = \\frac{\\pi}{3}$ and $d(p,r) = \\frac{\\pi}{3}$. These lengths are less than $\\pi / \\sqrt{1} = \\pi$, so the condition for applying the theorem is satisfied.\n- The angle at $p$ between the geodesics to $q$ and $r$ is $\\alpha_p = \\frac{\\pi}{3}$.\n\nWe construct the corresponding model triangle $\\triangle \\tilde{p}\\tilde{q}\\tilde{r}$ on the unit sphere $\\mathbb{S}^2$ with the following properties:\n- The arc length from $\\tilde{p}$ to $\\tilde{q}$ is $d_{\\mathbb{S}^2}(\\tilde{p}, \\tilde{q}) = \\frac{\\pi}{3}$.\n- The arc length from $\\tilde{p}$ to $\\tilde{r}$ is $d_{\\mathbb{S}^2}(\\tilde{p}, \\tilde{r}) = \\frac{\\pi}{3}$.\n- The angle at $\\tilde{p}$ is $\\alpha_{\\tilde{p}} = \\frac{\\pi}{3}$.\n\nThe sharp upper bound for $d(q,r)$ is the length of the third side of this spherical triangle, $d_{\\mathbb{S}^2}(\\tilde{q}, \\tilde{r})$. We compute this length using the Spherical Law of Cosines. For a spherical triangle with side lengths $a, b, c$ on a unit sphere, and $A$ being the angle opposite side $a$, the law is:\n$$\\cos(a) = \\cos(b)\\cos(c) + \\sin(b)\\sin(c)\\cos(A)$$\nLet's set $a = d_{\\mathbb{S}^2}(\\tilde{q}, \\tilde{r})$, $b = d_{\\mathbb{S}^2}(\\tilde{p}, \\tilde{r}) = \\frac{\\pi}{3}$, $c = d_{\\mathbb{S}^2}(\\tilde{p}, \\tilde{q}) = \\frac{\\pi}{3}$, and the included angle $A = \\alpha_{\\tilde{p}} = \\frac{\\pi}{3}$.\n\nSubstituting these values into the formula:\n$$\\cos(a) = \\cos\\left(\\frac{\\pi}{3}\\right)\\cos\\left(\\frac{\\pi}{3}\\right) + \\sin\\left(\\frac{\\pi}{3}\\right)\\sin\\left(\\frac{\\pi}{3}\\right)\\cos\\left(\\frac{\\pi}{3}\\right)$$\nThe required trigonometric values are $\\cos(\\frac{\\pi}{3}) = \\frac{1}{2}$ and $\\sin(\\frac{\\pi}{3}) = \\frac{\\sqrt{3}}{2}$.\n$$\\cos(a) = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{\\sqrt{3}}{2}\\right)\\left(\\frac{\\sqrt{3}}{2}\\right)\\left(\\frac{1}{2}\\right)$$\n$$\\cos(a) = \\frac{1}{4} + \\left(\\frac{3}{4}\\right)\\left(\\frac{1}{2}\\right)$$\n$$\\cos(a) = \\frac{1}{4} + \\frac{3}{8}$$\n$$\\cos(a) = \\frac{2}{8} + \\frac{3}{8} = \\frac{5}{8}$$\nThe length $a$ is therefore:\n$$a = \\arccos\\left(\\frac{5}{8}\\right)$$\nThis is the exact expression for the sharp upper bound on the length $d(q,r)$.\n\nThe problem requests a numerical answer in radians, rounded to four significant figures.\n$$a = \\arccos(0.625)$$\nCalculating the value in radians:\n$$a \\approx 0.895660538 \\text{ radians}$$\nRounding to four significant figures, we get:\n$$a \\approx 0.8957 \\text{ radians}$$\nThus, the sharp Toponogov upper bound for the length $d(q,r)$ is approximately $0.8957$ radians.", "answer": "$$\\boxed{0.8957}$$", "id": "3078545"}, {"introduction": "This final practice brings the abstract theorem to life through a tangible, computational verification. You will work with a surface of revolution, a manifold whose curvature varies from point to point, and implement a program to check that the Toponogov angle comparison holds true. By using numerical approximations for geodesic distances and angles, this exercise bridges the gap between pure theory and practical application, allowing you to \"see\" the theorem in action on a non-trivial geometric object [@problem_id:3075672].", "problem": "Consider the surface of revolution given as the graph of the function $z = \\alpha (x^2 + y^2)$ in three-dimensional Euclidean space. The induced Riemannian metric on the parameter domain $(x,y)$ is obtained from the first fundamental form of the graph $z = \\varphi(x,y)$, where $\\varphi(x,y) = \\alpha (x^2 + y^2)$. The first fundamental form coefficients are\n$$\nE = 1 + \\varphi_x^2, \\quad F = \\varphi_x \\varphi_y, \\quad G = 1 + \\varphi_y^2,\n$$\nso at a point $(x,y)$ the metric tensor is\n$$\nG(x,y) = \\begin{pmatrix}\n1 + \\varphi_x^2  \\varphi_x \\varphi_y \\\\\n\\varphi_x \\varphi_y  1 + \\varphi_y^2\n\\end{pmatrix}.\n$$\nFor the graph $z = \\alpha (x^2 + y^2)$, the derivatives are $\\varphi_x = 2 \\alpha x$, $\\varphi_y = 2 \\alpha y$, $\\varphi_{xx} = 2 \\alpha$, $\\varphi_{yy} = 2 \\alpha$, and $\\varphi_{xy} = 0$. The Gaussian curvature $K$ of a graph $z = \\varphi(x,y)$ is given by\n$$\nK(x,y) = \\frac{\\varphi_{xx} \\varphi_{yy} - \\varphi_{xy}^2}{\\left(1 + \\varphi_x^2 + \\varphi_y^2\\right)^2}.\n$$\nFor this surface, the Gaussian curvature simplifies to\n$$\nK(x,y) = \\frac{4 \\alpha^2}{\\left(1 + 4 \\alpha^2 (x^2 + y^2)\\right)^2},\n$$\nwhich varies with $r^2 = x^2 + y^2$.\n\nThe Toponogov comparison theorem states that in a complete Riemannian manifold with sectional curvature bounded below by $\\kappa$, for any geodesic triangle with side lengths $a$, $b$, $c$, the angles at the vertices are greater than or equal to the angles of the comparison triangle in the model space of constant curvature $\\kappa$ with the same side lengths. In spaces of constant curvature, the angle $\\gamma_\\kappa$ opposite the side of length $c$ is related to the adjacent sides $a$ and $b$ by one of the following laws of cosines:\n- If $\\kappa = 0$ (Euclidean case), then\n$$\n\\cos(\\gamma_0) = \\frac{a^2 + b^2 - c^2}{2ab}.\n$$\n- If $\\kappa  0$ (spherical case), with $R = \\frac{1}{\\sqrt{\\kappa}}$ the radius of the sphere, then\n$$\n\\cos(\\gamma_\\kappa) = \\frac{\\cos\\left(\\frac{c}{R}\\right) - \\cos\\left(\\frac{a}{R}\\right)\\cos\\left(\\frac{b}{R}\\right)}{\\sin\\left(\\frac{a}{R}\\right)\\sin\\left(\\frac{b}{R}\\right)}.\n$$\n- If $\\kappa  0$ (hyperbolic case), with $R = \\frac{1}{\\sqrt{-\\kappa}}$, then\n$$\n\\cos(\\gamma_\\kappa) = \\frac{\\cosh\\left(\\frac{a}{R}\\right)\\cosh\\left(\\frac{b}{R}\\right) - \\cosh\\left(\\frac{c}{R}\\right)}{\\sinh\\left(\\frac{a}{R}\\right)\\sinh\\left(\\frac{b}{R}\\right)}.\n$$\nAngles must be expressed in radians.\n\nFor small triangles on the surface, geodesic distances between nearby points and angles between geodesics can be approximated to first order using the Riemannian metric. Given three nearby points $p$, $q$, and $r$ in the parameter domain, we approximate the geodesic distance $d(p,q)$ by\n$$\nd(p,q) \\approx \\sqrt{\\Delta_{pq}^\\top G(m_{pq}) \\Delta_{pq}},\n$$\nwhere $\\Delta_{pq} = q - p$ and $m_{pq} = \\frac{p + q}{2}$ is the midpoint in the parameter domain, and $G(m_{pq})$ is the metric at the midpoint. The angle at a vertex $p$ formed by segments to $q$ and $r$ is approximated by\n$$\n\\gamma_M(p) \\approx \\arccos\\left(\\frac{\\langle \\Delta_{pq}, \\Delta_{pr} \\rangle_{G(p)}}{\\|\\Delta_{pq}\\|_{G(p)} \\, \\|\\Delta_{pr}\\|_{G(p)}}\\right),\n$$\nwhere the inner product and norm are induced by $G(p)$:\n$$\n\\langle u, v \\rangle_{G(p)} = u^\\top G(p) v, \\quad \\|u\\|_{G(p)} = \\sqrt{u^\\top G(p) u}.\n$$\n\nYour task is to implement a program that, for a set of small triangles on the surface $z = \\alpha (x^2 + y^2)$, checks the angle comparison predicted by the Toponogov comparison theorem for curvature bounds $\\kappa \\le 0$. For each test triangle, you must:\n- Construct points $p = (x_0, y_0)$, $q = (x_0 + h, y_0)$, and $r = (x_0, y_0 + h)$.\n- Compute the approximate side lengths $d(p,q)$, $d(p,r)$, and $d(q,r)$ using the midpoint metric rule.\n- Compute the approximate angles at each vertex $p$, $q$, and $r$ using the vertex metric rule.\n- Compute the model angles at $p$, $q$, and $r$ using the appropriate law of cosines for the given $\\kappa$ (Euclidean for $\\kappa = 0$, hyperbolic for $\\kappa  0$), with the same side lengths.\n- Verify that $K \\ge \\kappa$ at each vertex by evaluating $K$ at $p$, $q$, and $r$ using the formula above.\n- Return a boolean that is true if and only if $K \\ge \\kappa$ at all three vertices and the three angles at the vertices satisfy $\\gamma_M \\ge \\gamma_\\kappa$ within a tolerance of $10^{-9}$ radians.\n\nAngles must be expressed in radians. No physical units are involved. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[true,false,true]$).\n\nUse the following test suite of parameter values, which collectively cover a general case, moderate curvature variation, more distant points (smaller curvature), and both $\\kappa = 0$ and $\\kappa  0$ cases:\n- $(\\alpha, x_0, y_0, h, \\kappa) = (0.5, 0.0, 0.0, 0.01, 0.0)$\n- $(\\alpha, x_0, y_0, h, \\kappa) = (0.5, 0.3, 0.0, 0.02, 0.0)$\n- $(\\alpha, x_0, y_0, h, \\kappa) = (0.25, 0.6, 0.6, 0.02, -0.1)$\n- $(\\alpha, x_0, y_0, h, \\kappa) = (1.0, 0.1, 0.1, 0.05, 0.0)$\n- $(\\alpha, x_0, y_0, h, \\kappa) = (0.35, 0.2, -0.25, 0.03, -0.2)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[true,false,true,false,true]$). The angle unit is radians.", "solution": "The solution involves implementing a program to execute the specified verification procedure for each of the provided test cases. A main function will iterate through each test case tuple $(\\alpha, x_0, y_0, h, \\kappa)$, passing the parameters to a core processing function that returns a single boolean result. This core function executes the following sequence of steps.\n\nFirst, the three vertices of the triangle in the parameter domain are defined as $p = (x_0, y_0)$, $q = (x_0 + h, y_0)$, and $r = (x_0, y_0 + h)$, which are represented as $2$-dimensional vectors.\n\nThe necessary geometric quantities of the surface $z = \\alpha (x^2 + y^2)$ are computed by dedicated functions.\n\nThe metric tensor $G(x,y)$ at a point $(x,y)$ is given by\n$$\nG(x,y) = \\begin{pmatrix}\n1 + 4\\alpha^2 x^2  4\\alpha^2 xy \\\\\n4\\alpha^2 xy  1 + 4\\alpha^2 y^2\n\\end{pmatrix}.\n$$\nA function is implemented to compute this $2 \\times 2$ matrix for given parameters $\\alpha$, $x$, and $y$.\n\nThe Gaussian curvature $K(x,y)$ at a point $(x,y)$ is given by\n$$\nK(x,y) = \\frac{4 \\alpha^2}{\\left(1 + 4 \\alpha^2 (x^2 + y^2)\\right)^2}.\n$$\nA function is implemented to compute this scalar value.\n\nThe first condition for the test to pass is the curvature condition. The Gaussian curvature $K$ is evaluated at each of the three vertices $p$, $q$, and $r$. The condition $K(v) \\ge \\kappa$ must hold for all three vertices $v \\in \\{p,q,r\\}$. If this condition is not met for any vertex, the test for the current case fails, and the result is `false`.\n\nIf the curvature condition holds, the side lengths of the triangle on the manifold are approximated. Following the problem's prescription, the squared length of the side connecting two points (e.g., $p$ and $q$) is computed as $d(p,q)^2 \\approx \\Delta_{pq}^\\top G(m_{pq}) \\Delta_{pq}$, where $\\Delta_{pq} = q - p$ is the displacement vector in the parameter domain, and $G(m_{pq})$ is the metric tensor evaluated at the midpoint $m_{pq} = (p+q)/2$. This is performed for all three sides: $d(p,q)$, $d(p,r)$, and $d(q,r)$.\n\nNext, the interior angles of the triangle on the manifold, $\\gamma_M$, are approximated at each vertex. At a vertex, say $p$, the angle is formed by the segments to $q$ and $r$. It is computed using the formula:\n$$\n\\gamma_M(p) \\approx \\arccos\\left(\\frac{\\langle \\Delta_{pq}, \\Delta_{pr} \\rangle_{G(p)}}{\\|\\Delta_{pq}\\|_{G(p)} \\, \\|\\Delta_{pr}\\|_{G(p)}}\\right)\n$$\nHere, the inner product $\\langle u, v \\rangle_{G(p)} = u^\\top G(p) v$ and norm $\\|u\\|_{G(p)} = \\sqrt{\\langle u, u \\rangle_{G(p)}}$ are induced by the metric tensor evaluated at the vertex $p$. Note the distinction: side lengths use the midpoint metric, while angles use the vertex metric. This procedure is repeated for the angles at vertices $q$ (using vectors $p-q$ and $r-q$) and $r$ (using vectors $p-r$ and $q-r$).\n\nSubsequently, the angles of the comparison triangle, $\\gamma_\\kappa$, are calculated. This triangle exists in a model space of constant curvature $\\kappa$ and has the same side lengths $d(p,q)$, $d(p,r)$, and $d(q,r)$ as calculated previously. The calculation depends on the sign of $\\kappa$:\n- If $\\kappa = 0$, the Euclidean law of cosines is used:\n  $\\cos(\\gamma_0) = \\frac{a^2 + b^2 - c^2}{2ab}$\n- If $\\kappa  0$, the hyperbolic law of cosines is used. With $R=1/\\sqrt{-\\kappa}$:\n  $\\cos(\\gamma_\\kappa) = \\frac{\\cosh(a/R)\\cosh(b/R) - \\cosh(c/R)}{\\sinh(a/R)\\sinh(b/R)}$\nIn these formulas, to find the angle at a given vertex, $c$ is the length of the side opposite that vertex, and $a$ and $b$ are the lengths of the two adjacent sides. To prevent numerical errors from floating-point arithmetic, the argument of the `arccos` function is clipped to the interval $[-1, 1]$.\n\nFinally, the angle comparison condition is checked. For each vertex, the manifold angle $\\gamma_M$ must be greater than or equal to the corresponding model angle $\\gamma_\\kappa$. To account for potential floating-point inaccuracies, this check is implemented as $\\gamma_M \\ge \\gamma_\\kappa - \\epsilon$, where the tolerance $\\epsilon$ is $10^{-9}$. This check must pass for all three angles.\n\nThe final boolean result for the test case is `true` if and only if both the initial curvature condition and the angle comparison condition for all three vertices are satisfied. Otherwise, the result is `false`. The program collects these boolean results for all test cases and formats them into the required output string.", "answer": "```python\nimport numpy as np\n\ndef get_metric_tensor(x, y, alpha):\n    \"\"\"Computes the metric tensor G(x,y) for the surface.\"\"\"\n    px = 2 * alpha * x\n    py = 2 * alpha * y\n    return np.array([[1 + px**2, px * py], [px * py, 1 + py**2]])\n\ndef get_gaussian_curvature(x, y, alpha):\n    \"\"\"Computes the Gaussian curvature K(x,y) for the surface.\"\"\"\n    r_sq = x**2 + y**2\n    return (4 * alpha**2) / (1 + 4 * alpha**2 * r_sq)**2\n\ndef compute_manifold_angle(v1, v2, G_vertex):\n    \"\"\"Computes the angle between two tangent vectors in the given metric.\"\"\"\n    inner_prod = v1.T @ G_vertex @ v2\n    norm1 = np.sqrt(v1.T @ G_vertex @ v1)\n    norm2 = np.sqrt(v2.T @ G_vertex @ v2)\n    \n    if norm1 * norm2 == 0:\n        # This case should not be reached with h != 0.\n        return 0.0\n\n    cos_angle = inner_prod / (norm1 * norm2)\n    cos_angle = np.clip(cos_angle, -1.0, 1.0)\n    return np.arccos(cos_angle)\n\ndef compute_model_angle(a, b, c, kappa):\n    \"\"\"\n    Computes the angle opposite side c in a model space of constant curvature kappa.\n    a and b are the adjacent sides.\n    \"\"\"\n    if kappa == 0.0:\n        # Denominator is non-zero as h!=0 implies side lengths  0\n        cos_gamma = (a**2 + b**2 - c**2) / (2 * a * b)\n    elif kappa  0.0:\n        R = 1 / np.sqrt(-kappa)\n        cosh_aR = np.cosh(a / R)\n        cosh_bR = np.cosh(b / R)\n        cosh_cR = np.cosh(c / R)\n        sinh_aR = np.sinh(a / R)\n        sinh_bR = np.sinh(b / R)\n        \n        # Denominator is non-zero as h!=0 implies side lengths  0\n        cos_gamma = (cosh_aR * cosh_bR - cosh_cR) / (sinh_aR * sinh_bR)\n    else: # kappa  0 case not in test suite\n        raise ValueError(\"Positive kappa is not handled.\")\n        \n    cos_gamma = np.clip(cos_gamma, -1.0, 1.0)\n    return np.arccos(cos_gamma)\n\ndef process_case(alpha, x0, y0, h, kappa):\n    \"\"\"Processes a single test case and returns a boolean result.\"\"\"\n    tol = 1e-9\n\n    # 1. Define vertices in the parameter domain\n    p = np.array([x0, y0])\n    q = np.array([x0 + h, y0])\n    r = np.array([x0, y0 + h])\n    vertices = [p, q, r]\n\n    # 2. Verify curvature condition K = kappa at all vertices\n    for v in vertices:\n        K = get_gaussian_curvature(v[0], v[1], alpha)\n        if K  kappa:\n            return False\n\n    # 3. Compute side lengths using the midpoint metric approximation\n    delta_pq = q - p\n    delta_pr = r - p\n    delta_qr = r - q\n    \n    m_pq = (p + q) / 2\n    m_pr = (p + r) / 2\n    m_qr = (q + r) / 2\n    \n    G_mpq = get_metric_tensor(m_pq[0], m_pq[1], alpha)\n    G_mpr = get_metric_tensor(m_pr[0], m_pr[1], alpha)\n    G_mqr = get_metric_tensor(m_qr[0], m_qr[1], alpha)\n    \n    d_pq = np.sqrt(delta_pq.T @ G_mpq @ delta_pq) \n    d_pr = np.sqrt(delta_pr.T @ G_mpr @ delta_pr) \n    d_qr = np.sqrt(delta_qr.T @ G_mqr @ delta_qr) \n    \n    # 4. Compute manifold angles using the vertex metric approximation\n    G_p = get_metric_tensor(p[0], p[1], alpha)\n    G_q = get_metric_tensor(q[0], q[1], alpha)\n    G_r = get_metric_tensor(r[0], r[1], alpha)\n    \n    gamma_M_p = compute_manifold_angle(q - p, r - p, G_p)\n    gamma_M_q = compute_manifold_angle(p - q, r - q, G_q)\n    gamma_M_r = compute_manifold_angle(p - r, q - r, G_r)\n    \n    # 5. Compute model space angles\n    # Side opposite p is d_qr; opposite q is d_pr; opposite r is d_pq.\n    gamma_k_p = compute_model_angle(d_pq, d_pr, d_qr, kappa)\n    gamma_k_q = compute_model_angle(d_pq, d_qr, d_pr, kappa)\n    gamma_k_r = compute_model_angle(d_pr, d_qr, d_pq, kappa)\n    \n    # 6. Verify angle condition gamma_M = gamma_kappa for all three angles\n    if (gamma_M_p  gamma_k_p - tol) or \\\n       (gamma_M_q  gamma_k_q - tol) or \\\n       (gamma_M_r  gamma_k_r - tol):\n        return False\n        \n    return True\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results in the required format.\n    \"\"\"\n    test_cases = [\n        (0.5, 0.0, 0.0, 0.01, 0.0),\n        (0.5, 0.3, 0.0, 0.02, 0.0),\n        (0.25, 0.6, 0.6, 0.02, -0.1),\n        (1.0, 0.1, 0.1, 0.05, 0.0),\n        (0.35, 0.2, -0.25, 0.03, -0.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(*case)\n        results.append(str(result).lower())\n    \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3075672"}]}