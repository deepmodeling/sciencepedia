{"hands_on_practices": [{"introduction": "The geodesic symmetry map $s_p$ has its simplest expression, $x \\mapsto -x$, in the context of normal coordinates centered at a point $p$. This elegant form, however, conceals how the map behaves in more general coordinate systems. This first practice invites you to derive the local expression of $s_p$ in an arbitrary chart, revealing how the manifold's connection structure, encoded in the Christoffel symbols, governs the map's second-order behavior [@problem_id:3071585]. This calculation provides a foundational understanding of how local geometry shapes the symmetry map beyond its linear approximation.", "problem": "Let $(M,g)$ be a smooth Riemannian manifold and let $p \\in M$. Define the geodesic symmetry map $s_p$ by the condition $s_p(\\exp_p(v))=\\exp_p(-v)$ for all $v \\in T_pM$ sufficiently small, where $\\exp_p$ is the exponential map at $p$. Let $x=(x^{a})$ be a normal coordinate chart centered at $p$ (so $x(p)=0$ and the Christoffel symbols $\\Gamma^{a}_{bc}$ of the Levi-Civita connection vanish at $p$ in the $x$-coordinates), and let $y=(y^{i})$ be an arbitrary smooth coordinate chart centered at $p$ (so $y(p)=0$) with Christoffel symbols $\\Gamma^{i}_{jk}(y)$ in these coordinates. In the $x$-coordinates, the geodesic symmetry is given by $x \\mapsto -x$.\n\nUsing only the fundamental definitions of normal coordinates and the standard transformation law for Christoffel symbols under coordinate change, compute the coordinate expression of $s_p$ in the $y$-chart up to and including quadratic order at $p$. Concretely, if $S^{i}(y)$ denotes the $i$-th $y$-coordinate of $s_p$ applied to a point whose $y$-coordinates are $y=(y^{1},\\dots,y^{n})$, determine the first nontrivial terms of the Taylor expansion of $S^{i}(y)$ at $y=0$ through second order, expressed entirely in terms of $y^{j}$ and the Christoffel symbols $\\Gamma^{i}_{jk}(p)$ in the $y$-coordinates.\n\nYour final answer must be a single closed-form analytic expression giving $S^{i}(y)$ to second order. No rounding is required, and there are no physical units.", "solution": "Let $(M,g)$ be a smooth Riemannian manifold. Let $p \\in M$. We are given two coordinate charts centered at $p$:\n1. A normal coordinate chart $x=(x^a)$, in which $x(p)=0$ and the Christoffel symbols of the Levi-Civita connection, denoted $\\bar{\\Gamma}^a_{bc}(x)$, vanish at $p$. That is, $\\bar{\\Gamma}^a_{bc}(p) = 0$.\n2. An arbitrary smooth coordinate chart $y=(y^i)$, in which $y(p)=0$, with Christoffel symbols $\\Gamma^i_{jk}(y)$.\n\nThe geodesic symmetry map $s_p: M \\to M$ is defined locally by $s_p(\\exp_p(v)) = \\exp_p(-v)$ for $v \\in T_pM$. In a normal coordinate system $x$ centered at $p$, the exponential map is given by $\\exp_p(v) \\mapsto (v^1, \\dots, v^n)$ where $v = v^a \\frac{\\partial}{\\partial x^a}|_p$. Thus, the action of $s_p$ corresponds to negating the vector in the tangent space, which translates to negating the coordinates. So, in the $x$-chart, if a point has coordinates $x$, its image under $s_p$ has coordinates $-x$.\n\nOur goal is to find the expression for $s_p$ in the $y$-coordinate chart. Let a point $q$ near $p$ have coordinates $y(q) = (y^1, \\dots, y^n)$. We want to find the coordinates of its image, $S(y) = y(s_p(q))$.\n\nThe strategy is to transform from $y$-coordinates to $x$-coordinates, apply the map, and then transform back to $y$-coordinates. Let the coordinate transformation functions be $x = x(y)$ and its inverse $y = y(x)$. The map $S(y)$ can be expressed as the composition of functions:\n$$S(y) = y(s_p(x(y)))$$\nIn the $x$-coordinates, the map is $x \\mapsto -x$. So we have:\n$$S^i(y^1, \\dots, y^n) = y^i(-x^1(y), \\dots, -x^n(y))$$\nWe will find the Taylor expansion of $S^i(y)$ around $y=0$ up to the second order. This requires the Taylor expansions of the coordinate change functions $x(y)$ and $y(x)$ around the origin. Einstein summation convention is used throughout.\n\nThe Taylor expansion of $x^a(y)$ around $y=0$ is:\n$$x^a(y) = x^a(0) + \\frac{\\partial x^a}{\\partial y^j}\\bigg|_0 y^j + \\frac{1}{2}\\frac{\\partial^2 x^a}{\\partial y^j \\partial y^k}\\bigg|_0 y^j y^k + O(|y|^3)$$\nSince both coordinate systems are centered at $p$, $x(0)=0$. Let us denote the Jacobian and Hessian matrices at the origin as:\n$$J^a_j = \\frac{\\partial x^a}{\\partial y^j}\\bigg|_0 \\quad , \\quad H^a_{jk} = \\frac{\\partial^2 x^a}{\\partial y^j \\partial y^k}\\bigg|_0$$\nSo, $x^a(y) = J^a_j y^j + \\frac{1}{2} H^a_{jk} y^j y^k + O(|y|^3)$.\n\nSimilarly, the Taylor expansion of $y^i(x)$ around $x=0$ is:\n$$y^i(x) = y^i(0) + \\frac{\\partial y^i}{\\partial x^a}\\bigg|_0 x^a + \\frac{1}{2} \\frac{\\partial^2 y^i}{\\partial x^a \\partial x^b}\\bigg|_0 x^a x^b + O(|x|^3)$$\nWith $y(0)=0$ and notations for the derivatives:\n$$\\tilde{J}^i_a = \\frac{\\partial y^i}{\\partial x^a}\\bigg|_0 \\quad , \\quad \\tilde{H}^i_{ab} = \\frac{\\partial^2 y^i}{\\partial x^a \\partial x^b}\\bigg|_0$$\nSo, $y^i(x) = \\tilde{J}^i_a x^a + \\frac{1}{2} \\tilde{H}^i_{ab} x^a x^b + O(|x|^3)$. The matrices $J$ and $\\tilde{J}$ are inverses, so $J^a_i \\tilde{J}^i_b = \\delta^a_b$ and $\\tilde{J}^i_a J^a_j = \\delta^i_j$.\n\nNow, we expand $S^i(y) = y^i(-x(y))$:\n$$S^i(y) = \\tilde{J}^i_a (-x^a(y)) + \\frac{1}{2}\\tilde{H}^i_{ab} (-x^a(y))(-x^b(y)) + O(|x|^3)$$\nSince $x(y)$ is of order $y$, $O(|x|^3) = O(|y|^3)$.\n$$S^i(y) = -\\tilde{J}^i_a x^a(y) + \\frac{1}{2}\\tilde{H}^i_{ab} x^a(y)x^b(y) + O(|y|^3)$$\nSubstitute the expansion of $x^a(y)$:\n$$x^a(y) = J^a_j y^j + \\frac{1}{2}H^a_{jk} y^j y^k + O(|y|^3)$$\nTo compute $S^i(y)$ to second order in $y$, we only need $x^a(y)x^b(y)$ to second order:\n$$x^a(y)x^b(y) = (J^a_j y^j)(J^b_k y^k) + O(|y|^3) = J^a_j J^b_k y^j y^k + O(|y|^3)$$\nSubstituting these into the expansion for $S^i(y)$:\n$$S^i(y) = -\\tilde{J}^i_a \\left( J^a_j y^j + \\frac{1}{2}H^a_{jk} y^j y^k \\right) + \\frac{1}{2}\\tilde{H}^i_{ab} (J^a_j J^b_k y^j y^k) + O(|y|^3)$$\n$$S^i(y) = -(\\tilde{J}^i_a J^a_j) y^j + \\left( -\\frac{1}{2}\\tilde{J}^i_a H^a_{jk} + \\frac{1}{2}\\tilde{H}^i_{ab} J^a_j J^b_k \\right) y^j y^k + O(|y|^3)$$\nUsing $\\tilde{J}^i_a J^a_j = \\delta^i_j$, the linear term is $-\\delta^i_j y^j = -y^i$.\n$$S^i(y) = -y^i + \\frac{1}{2} \\left( \\tilde{H}^i_{ab} J^a_j J^b_k - \\tilde{J}^i_a H^a_{jk} \\right) y^j y^k + O(|y|^3)$$\nThe next step is to relate the Hessian terms $H^a_{jk}$ and $\\tilde{H}^i_{ab}$ to the Christoffel symbols $\\Gamma^i_{jk}(p)$ using their transformation law. Starting with the transformation from $y$-coords to $x$-coords:\n$$\\bar{\\Gamma}^c_{ab}(x) = \\frac{\\partial x^c}{\\partial y^k} \\left( \\Gamma^k_{ij}(y) \\frac{\\partial y^i}{\\partial x^a} \\frac{\\partial y^j}{\\partial x^b} + \\frac{\\partial^2 y^k}{\\partial x^a \\partial x^b} \\right)$$\nEvaluating at $p$ (where $x=0, y=0$), and recalling that $\\bar{\\Gamma}^c_{ab}(p) = 0$:\n$$0 = J^c_k \\left( \\Gamma^k_{ij}(p) \\tilde{J}^i_a \\tilde{J}^j_b + \\tilde{H}^k_{ab} \\right)$$\nSince the Jacobian $J^c_k$ is invertible, the term in parentheses must be zero, which gives us an expression for $\\tilde{H}^k_{ab}$:\n$$\\tilde{H}^k_{ab} = -\\Gamma^k_{ij}(p) \\tilde{J}^i_a \\tilde{J}^j_b$$\nNow consider the reverse transformation law from $x$-coords to $y$-coords:\n$$\\Gamma^k_{ij}(y) = \\frac{\\partial y^k}{\\partial x^c} \\left( \\bar{\\Gamma}^c_{ab}(x) \\frac{\\partial x^a}{\\partial y^i} \\frac{\\partial x^b}{\\partial y^j} + \\frac{\\partial^2 x^c}{\\partial y^i \\partial y^j} \\right)$$\nEvaluating at $p$ and using $\\bar{\\Gamma}^c_{ab}(p)=0$ again:\n$$\\Gamma^k_{ij}(p) = \\tilde{J}^k_c H^c_{ij}$$\nTo solve for $H^c_{ij}$, we multiply by the inverse Jacobian $J^a_k$:\n$$J^a_k \\Gamma^k_{ij}(p) = J^a_k \\tilde{J}^k_c H^c_{ij} = \\delta^a_c H^c_{ij} = H^a_{ij}$$\nSo, $H^a_{ij} = J^a_k \\Gamma^k_{ij}(p)$.\n\nNow we substitute these expressions for $H$ and $\\tilde{H}$ into the quadratic term's coefficient:\nThe coefficient of $\\frac{1}{2}y^j y^k$ is $\\left( \\tilde{H}^i_{ab} J^a_j J^b_k - \\tilde{J}^i_a H^a_{jk} \\right)$. Let's compute each part.\nFirst part:\n$$ \\tilde{H}^i_{ab} J^a_j J^b_k = (-\\Gamma^i_{lm}(p) \\tilde{J}^l_a \\tilde{J}^m_b) J^a_j J^b_k = -\\Gamma^i_{lm}(p) (\\tilde{J}^l_a J^a_j) (\\tilde{J}^m_b J^b_k) = -\\Gamma^i_{lm}(p) \\delta^l_j \\delta^m_k = -\\Gamma^i_{jk}(p) $$\nSecond part:\n$$ -\\tilde{J}^i_a H^a_{jk} = -\\tilde{J}^i_a (J^a_l \\Gamma^l_{jk}(p)) = -(\\tilde{J}^i_a J^a_l) \\Gamma^l_{jk}(p) = -\\delta^i_l \\Gamma^l_{jk}(p) = -\\Gamma^i_{jk}(p) $$\nCombining these, the coefficient of $\\frac{1}{2}y^j y^k$ is $-\\Gamma^i_{jk}(p) - \\Gamma^i_{jk}(p) = -2\\Gamma^i_{jk}(p)$.\nThe total quadratic term in the expansion is therefore:\n$$\\frac{1}{2} (-2\\Gamma^i_{jk}(p)) y^j y^k = -\\Gamma^i_{jk}(p) y^j y^k$$\nFinally, assembling the Taylor series for $S^i(y)$:\n$$S^i(y) = -y^i - \\Gamma^i_{jk}(p) y^j y^k + O(|y|^3)$$\nThis gives the coordinate expression for the geodesic symmetry map in the $y$-chart up to the second order. The Christoffel symbols $\\Gamma^i_{jk}$ are symmetric in their lower indices $j,k$, so the expression is implicitly symmetric in $y^j y^k$.", "answer": "$$\\boxed{-y^{i} - \\Gamma^{i}_{jk}(p) y^{j} y^{k}}$$", "id": "3071585"}, {"introduction": "A key motivation for studying the geodesic symmetry map is its deep connection to the concept of a symmetric space, where $s_p$ acts as a local isometry for every point $p$. This exercise moves from understanding the map's local expression to analyzing its effect on the metric tensor itself. By calculating the difference between the metric $g$ and its pullback $s_p^*g$ on a torus with non-constant curvature, you will quantify the failure of $s_p$ to be an isometry and, through calculation, discover how this failure is directly tied to the spatial variation of the Riemann curvature tensor [@problem_id:3071581]. This provides a concrete verification of the principle that spaces with non-constant curvature are not locally symmetric.", "problem": "Let $\\mathbb{T}^{2}$ denote the two-dimensional torus with global angular coordinates $(x,y)$, each taken modulo $2\\pi$. For a fixed parameter $\\varepsilon$ with $0<\\varepsilon<\\frac{1}{2}$, endow $\\mathbb{T}^{2}$ with the Riemannian metric $g_{\\varepsilon}$ given in the coordinate chart by\n$$\ng_{\\varepsilon} \\;=\\; dx^{2} \\;+\\; \\big(1+\\varepsilon\\cos x\\big)^{2}\\,dy^{2}.\n$$\nConsider the base point $p=(\\tfrac{\\pi}{2},0)$ and let $(u,v)$ be Riemannian normal coordinates centered at $p$. The geodesic symmetry at $p$ is the map $s_{p}$ defined on a normal neighborhood of $p$ by $s_{p}=\\exp_{p}\\circ(-\\mathrm{Id})\\circ\\exp_{p}^{-1}$, so that in the normal coordinates $(u,v)$ one has $s_{p}(u,v)=(-u,-v)$. Define the difference of the $(2,2)$-component of the metric and its pullback under the geodesic symmetry along the $u$-axis by\n$$\n\\Delta(u) \\;:=\\; g_{22}(u,0) \\;-\\; (s_{p}^{*}g)_{22}(u,0),\n$$\nwhere $g_{22}$ denotes the $(2,2)$-component of $g_{\\varepsilon}$ expressed in the normal coordinates $(u,v)$.\n\nStarting from fundamental facts about Riemannian normal coordinates and curvature tensors, compute the leading nonzero term of erections Taylor expansion of $\\Delta(u)$ about $u=0$ along the $u$-axis. Your final answer must be a single closed-form analytic expression in terms of $\\varepsilon$ and $u$. No numerical rounding is required.", "solution": "The quantity to be analyzed is $\\Delta(u) = g_{22}(u,0) - (s_{p}^{*}g)_{22}(u,0)$. The map $s_p$ in normal coordinates $(u,v) \\equiv (u^1, u^2)$ is given by $\\phi(u^1, u^2) = (-u^1, -u^2)$. The components of the pullback metric $s_p^*g$ are given by $(s_p^*g)_{ij}(u,v) = g_{ij}(-u,-v)$.\nTherefore, the function $\\Delta(u)$ is:\n$$\n\\Delta(u) = g_{22}(u,0) - g_{22}(-u,0)\n$$\nThis expression represents the odd part of the Taylor series of the function $h(u) = g_{22}(u,0)$ expanded around $u=0$. Let the Taylor expansion of $h(u)$ be $h(u) = \\sum_{k=0}^{\\infty} c_k u^k$. Then\n$$\n\\Delta(u) = \\sum_{k=0}^{\\infty} c_k u^k - \\sum_{k=0}^{\\infty} c_k (-u)^k = \\sum_{k=0}^{\\infty} c_k (1 - (-1)^k) u^k = 2c_1 u + 2c_3 u^3 + 2c_5 u^5 + \\dots\n$$\nThe standard Taylor expansion of the metric components $g_{ij}$ in a system of normal coordinates $\\{u^k\\}$ centered at a point $p$ is given by:\n$$\ng_{ij}(u) = \\delta_{ij} - \\frac{1}{3} R_{ikjl} u^k u^l - \\frac{1}{6} (\\nabla_m R_{ikjl}) u^k u^l u^m + O(|u|^4)\n$$\nwhere $R_{ikjl}$ is the Riemann curvature tensor and $\\nabla_m$ is the covariant derivative, both evaluated at the point $p$. The indices $i,j,k,l,m$ refer to the basis vectors of the normal coordinate system at $p$.\n\nWe are interested in the component $g_{22}$ along the $u$-axis, which corresponds to the curve $(u^1, u^2) = (u, 0)$. Setting $i=j=2$ and $u^1=u, u^2=0$, the expansion becomes:\n$$\ng_{22}(u,0) = \\delta_{22} - \\frac{1}{3} R_{2121} u^2 - \\frac{1}{6} (\\nabla_1 R_{2121}) u^3 + O(u^4)\n$$\nComparing this with the generic Taylor series $h(u) = c_0 + c_1 u + c_2 u^2 + c_3 u^3 + \\dots$, we identify the coefficients:\n- $c_0 = 1 = g_{22}(0,0)$.\n- $c_1 = 0$, since first derivatives of the metric components vanish at the origin of normal coordinates.\n- $c_2 = -\\frac{1}{3} R_{2121}$.\n- $c_3 = -\\frac{1}{6} \\nabla_1 R_{2121}$.\n\nThe leading term of $\\Delta(u)$ is $2c_3 u^3$, as $c_1=0$. If $c_3 \\neq 0$, the leading term is:\n$$\n\\Delta(u) \\approx -\\frac{1}{3} (\\nabla_1 R_{2121}) u^3\n$$\nOur task reduces to computing the component $\\nabla_1 R_{2121}$ at the point $p=(\\frac{\\pi}{2},0)$. The indices $1$ and $2$ correspond to an orthonormal basis $\\{e_1, e_2\\}$ of the tangent space $T_p\\mathbb{T}^2$ which define the axes of the normal coordinate system.\n\nFirst, let's examine the metric $g_{\\varepsilon} = dx^2 + (1+\\varepsilon\\cos x)^2 dy^2$ at the point $p=(\\frac{\\pi}{2},0)$. At this point, $\\cos x = \\cos(\\frac{\\pi}{2})=0$. The metric tensor at $p$ is:\n$$\ng_p = dx^2 + (1+0)^2 dy^2 = dx^2 + dy^2\n$$\nThis means that the coordinate basis vectors $\\{\\partial_x, \\partial_y\\}$ form an orthonormal basis at $p$. We can thus identify our orthonormal basis $\\{e_1, e_2\\}$ with $\\{\\partial_x, \\partial_y\\}$ respectively. So, index $1$ corresponds to the $x$-direction and index $2$ to the $y$-direction.\n\nThe covariant derivative of the curvature tensor is given by $(\\nabla_k R_{lmji}) = \\partial_k R_{lmji} - \\Gamma^s_{kl} R_{smji} - \\dots$. Since we need to evaluate this at $p$, we first need to compute the components of the Riemann tensor $R_{ikjl}$ at $p$. Let's use the local coordinates $x^1=x, x^2=y$. The metric is diagonal with $g_{11}=1$ and $g_{22} = f(x)^2$, where $f(x) = 1+\\varepsilon\\cos x$. The Gaussian curvature $K$ of a surface with metric $dx^2+f(x)^2dy^2$ is given by $K = -f''(x)/f(x)$.\nHere, $f(x) = 1+\\varepsilon\\cos x$, $f'(x) = -\\varepsilon\\sin x$, and $f''(x) = -\\varepsilon\\cos x$.\nSo, $K(x) = \\frac{-(-\\varepsilon\\cos x)}{1+\\varepsilon\\cos x} = \\frac{\\varepsilon\\cos x}{1+\\varepsilon\\cos x}$.\nThe only non-zero independent component of the Riemann tensor is $R_{1212}$. It is related to the Gaussian curvature by $R_{1212} = K \\det(g) = K g_{11}g_{22}$.\n$$\nR_{1212}(x) = \\frac{\\varepsilon\\cos x}{1+\\varepsilon\\cos x} \\cdot 1 \\cdot (1+\\varepsilon\\cos x)^2 = \\varepsilon\\cos x(1+\\varepsilon\\cos x) = \\varepsilon\\cos x + \\varepsilon^2\\cos^2 x\n$$\nUsing the symmetries of the Riemann tensor, $R_{2121} = R_{1212}$.\nAt the point $p$, $x=\\frac{\\pi}{2}$, so $\\cos x = 0$.\n$$\nR_{2121}(p) = \\varepsilon\\cos(\\tfrac{\\pi}{2}) + \\varepsilon^2\\cos^2(\\tfrac{\\pi}{2}) = 0\n$$\nSince all components of the Riemann tensor are zero at $p$, the formula for the covariant derivative simplifies significantly:\n$$\n(\\nabla_1 R_{2121})_p = (\\partial_1 R_{2121})_p - (\\text{terms involving } R_{ikjl}(p)) = (\\partial_x R_{2121})_p\n$$\nWe need to compute the derivative of $R_{2121}(x)$ with respect to $x$ and evaluate it at $x=\\frac{\\pi}{2}$.\n$$\n\\frac{d}{dx}R_{2121}(x) = \\frac{d}{dx}(\\varepsilon\\cos x + \\varepsilon^2\\cos^2 x) = -\\varepsilon\\sin x - 2\\varepsilon^2\\cos x \\sin x\n$$\nEvaluating at $x=\\frac{\\pi}{2}$:\n$$\n(\\nabla_1 R_{2121})_p = -\\varepsilon\\sin(\\tfrac{\\pi}{2}) - 2\\varepsilon^2\\cos(\\tfrac{\\pi}{2})\\sin(\\tfrac{\\pi}{2}) = -\\varepsilon(1) - 2\\varepsilon^2(0)(1) = -\\varepsilon\n$$\nSince $R_{2121}(p)=0$, the $u^2$ term in the expansion for $g_{22}(u,0)$ vanishes. Since $\\nabla_1 R_{2121}(p) = -\\varepsilon \\neq 0$, the $u^3$ term is the leading non-constant term. The coefficient $c_3$ is non-zero.\nThe leading nonzero term in the expansion of $\\Delta(u)$ is thus:\n$$\n-\\frac{1}{3} (\\nabla_1 R_{2121}) u^3 = -\\frac{1}{3} (-\\varepsilon) u^3 = \\frac{\\varepsilon}{3} u^3\n$$\nThis is the desired leading nonzero term of the Taylor expansion of $\\Delta(u)$ about $u=0$.", "answer": "$$\n\\boxed{\\frac{\\varepsilon}{3}u^{3}}\n$$", "id": "3071581"}, {"introduction": "While analytical exercises provide deep insight, many geometric scenarios are too complex for pen-and-paper solutions. This practice challenges you to build a numerical laboratory to explore the geodesic symmetry map in a more general setting [@problem_id:3071564]. Starting from the fundamental geodesic equations, you will numerically construct the exponential map, establish normal coordinates, and compute the deviation of the geodesic symmetry from being a perfect isometry. This computational approach not only reinforces the entire theoretical chain—from ODEs to curvature effects—but also equips you with practical skills for investigating geometric properties in modern research.", "problem": "Consider the two-dimensional flat torus defined as $$\\mathbb{T}^2 = (\\mathbb{R}/2\\pi\\mathbb{Z})^2,$$ with global coordinates $$u \\in [0,2\\pi), \\quad v \\in [0,2\\pi)$$ understood modulo $$2\\pi.$$ Equip $$\\mathbb{T}^2$$ with a conformal Riemannian metric having a localized bump, given by $$g = \\lambda(u,v)\\left(du^2 + dv^2\\right),$$ where $$\\lambda(u,v) = 1 + \\varepsilon \\exp\\left(-\\frac{\\sin^2(u) + \\sin^2(v)}{\\sigma^2}\\right),$$ with fixed positive constants $$\\varepsilon = 0.5$$ and $$\\sigma = 0.6.$$ Let $$p = (\\pi,\\pi) \\in \\mathbb{T}^2.$$\n\nThe fundamental base consists of: (i) the definition of a geodesic on a Riemannian manifold as a curve $$\\gamma(t)$$ satisfying the geodesic equation $$\\nabla_{\\dot{\\gamma}} \\dot{\\gamma} = 0,$$ which in local coordinates is $$\\ddot{\\gamma}^k + \\Gamma^k_{ij}(\\gamma)\\,\\dot{\\gamma}^i\\,\\dot{\\gamma}^j = 0;$$ (ii) the Levi–Civita connection coefficients $$\\Gamma^k_{ij}$$ computed from the metric components $$g_{ij};$$ (iii) the exponential map $$\\exp_p$$ defined by following geodesics starting at $$p$$ with an initial tangent vector for unit time; (iv) Riemannian normal coordinates at $$p$$ identified via an orthonormal basis of $$T_p\\mathbb{T}^2;$$ and (v) the geodesic symmetry map $$s_p(q) = \\exp_p\\!\\left(-\\exp_p^{-1}(q)\\right).$$\n\nStarting from these definitions, do the following:\n\n1. Derive the Christoffel symbols $$\\Gamma^k_{ij}$$ for the metric $$g_{ij} = \\lambda(u,v)\\,\\delta_{ij}.$$ Using the conformal nature of $$g,$$ express $$\\Gamma^k_{ij}$$ explicitly in terms of $$\\lambda$$ and its partial derivatives $$\\partial_u \\lambda$$ and $$\\partial_v \\lambda.$$\n\n2. Implement the geodesic equations in the coordinates $$u,v$$ on $$\\mathbb{T}^2$$ for the metric above, and numerically integrate them to construct the exponential map $$\\exp_p(x)$$ at time $$t=1,$$ where $$x \\in \\mathbb{R}^2$$ is interpreted in normal coordinates at $$p.$$ Use the identification of $$T_p\\mathbb{T}^2$$ with $$\\mathbb{R}^2$$ via the orthonormal basis $$\\left\\{\\frac{1}{\\sqrt{\\lambda(p)}}\\partial_u, \\frac{1}{\\sqrt{\\lambda(p)}}\\partial_v\\right\\}.$$ That is, for $$x = (x_1,x_2),$$ set the initial velocity for the geodesic at $$t=0$$ to be $$\\dot{u}(0) = \\frac{x_1}{\\sqrt{\\lambda(p)}}, \\quad \\dot{v}(0) = \\frac{x_2}{\\sqrt{\\lambda(p)}},$$ and the initial position $$\\gamma(0) = p.$$\n\n3. Using finite differences, numerically approximate the Jacobian matrix $$J(x) = D\\exp_p(x)$$ of the exponential map at a given $$x,$$ by evaluating $$\\exp_p(x + h e_i)$$ and $$\\exp_p(x - h e_i)$$ for a small $$h > 0$$ and standard basis vectors $$e_1, e_2.$$ Because $$\\mathbb{T}^2$$ is periodic, compute differences of coordinates as minimal signed angle differences to avoid artificial jumps at the $$2\\pi$$ boundary.\n\n4. Define the pulled-back metric in normal coordinates by $$\\tilde{g}(x) = J(x)^\\top\\, g\\big(\\exp_p(x)\\big)\\, J(x),$$ where $$g(u,v) = \\lambda(u,v)\\,I_2.$$ Approximate the local geodesic symmetry map $$s_p$$ by $$x \\mapsto -x$$ and quantify deviations from isometry by computing the matrix difference $$\\tilde{g}(x) - \\tilde{g}(-x).$$ As a scalar measure, report the Frobenius norm $$\\left\\|\\tilde{g}(x) - \\tilde{g}(-x)\\right\\|_F.$$\n\nYour program must implement the above numerics and produce results for the following test suite of normal coordinate inputs $$x$$ (listed as ordered pairs):\n\n- $$x = (0.0, 0.0)$$\n- $$x = (0.05, 0.0)$$\n- $$x = (0.0, 0.05)$$\n- $$x = (0.2, 0.15)$$\n- $$x = (0.4, -0.3)$$\n- $$x = (1.0, 0.0)$$\n\nFor each test case, output the Frobenius norm $$\\left\\|\\tilde{g}(x) - \\tilde{g}(-x)\\right\\|_F$$ as a float rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5,r6]\"), where each $$r_i$$ corresponds to the specified test case in order.\n\nNo physical units are involved. All angles must be treated in radians. Ensure scientific realism by using accurate integration of the geodesic ordinary differential equation and stable finite difference computation of the Jacobian. Avoid providing any shortcut formulas for the exponential map or normal coordinates beyond those derived from the fundamental base specified above.", "solution": "The core task is to compute the Frobenius norm of the difference between the pulled-back metric in normal coordinates at a point `$x$` and at `$-x$`, i.e., `$\\|\\tilde{g}(x) - \\tilde{g}(-x)\\|_F$`. This quantity vanishes if the space is locally symmetric. We will proceed by following the steps outlined in the problem statement.\n\n### Step 1: Christoffel Symbols\n\nThe metric is given in conformal form `$g = \\lambda(u,v)(du^2 + dv^2)$`. Let the coordinates be `$(x^1, x^2) = (u,v)$`. The metric tensor components are:\n$$\ng_{11} = \\lambda(u,v), \\quad g_{22} = \\lambda(u,v), \\quad g_{12} = g_{21} = 0\n$$\nThe inverse metric tensor has components:\n$$\ng^{11} = \\frac{1}{\\lambda(u,v)}, \\quad g^{22} = \\frac{1}{\\lambda(u,v)}, \\quad g^{12} = g^{21} = 0\n$$\nThe Christoffel symbols of the second kind, `$\\Gamma^k_{ij}$`, are given by the formula:\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} g^{kl} (\\partial_i g_{jl} + \\partial_j g_{il} - \\partial_l g_{ij})\n$$\nwhere `$\\partial_1 = \\partial_u$` and `$\\partial_2 = \\partial_v$`. Let `$\\lambda_u = \\partial_u \\lambda$` and `$\\lambda_v = \\partial_v \\lambda$`.\n\nFor a diagonal conformal metric, the formulas simplify considerably. Let's compute each non-zero component:\n*   `$\\Gamma^1_{11} = \\frac{1}{2}g^{11}(\\partial_1 g_{11} + \\partial_1 g_{11} - \\partial_1 g_{11}) = \\frac{1}{2}g^{11}(\\partial_1 g_{11}) = \\frac{1}{2\\lambda}\\lambda_u$`\n*   `$\\Gamma^1_{12} = \\Gamma^1_{21} = \\frac{1}{2}g^{11}(\\partial_1 g_{21} + \\partial_2 g_{11} - \\partial_1 g_{12}) = \\frac{1}{2}g^{11}\\partial_2 g_{11} = \\frac{1}{2\\lambda}\\lambda_v$`\n*   `$\\Gamma^1_{22} = \\frac{1}{2}g^{11}(\\partial_2 g_{21} + \\partial_2 g_{21} - \\partial_1 g_{22}) = \\frac{1}{2}g^{11}(-\\partial_1 g_{22}) = -\\frac{1}{2\\lambda}\\lambda_u$`\n*   `$\\Gamma^2_{11} = \\frac{1}{2}g^{22}(\\partial_1 g_{12} + \\partial_1 g_{12} - \\partial_2 g_{11}) = \\frac{1}{2}g^{22}(-\\partial_2 g_{11}) = -\\frac{1}{2\\lambda}\\lambda_v$`\n*   `$\\Gamma^2_{12} = \\Gamma^2_{21} = \\frac{1}{2}g^{22}(\\partial_1 g_{22} + \\partial_2 g_{12} - \\partial_2 g_{12}) = \\frac{1}{2}g^{22}\\partial_1 g_{22} = \\frac{1}{2\\lambda}\\lambda_u$`\n*   `$\\Gamma^2_{22} = \\frac{1}{2}g^{22}(\\partial_2 g_{22} + \\partial_2 g_{22} - \\partial_2 g_{22}) = \\frac{1}{2}g^{22}(\\partial_2 g_{22}) = \\frac{1}{2\\lambda}\\lambda_v$`\n\nThe partial derivatives of the conformal factor `$\\lambda(u,v) = 1 + \\varepsilon \\exp\\left(-\\frac{\\sin^2(u) + \\sin^2(v)}{\\sigma^2}\\right)$` are:\n$$\n\\lambda_u = \\partial_u \\lambda = -\\frac{2\\varepsilon \\sin u \\cos u}{\\sigma^2} \\exp\\left(-\\frac{\\sin^2 u + \\sin^2 v}{\\sigma^2}\\right)\n$$\n$$\n\\lambda_v = \\partial_v \\lambda = -\\frac{2\\varepsilon \\sin v \\cos v}{\\sigma^2} \\exp\\left(-\\frac{\\sin^2 u + \\sin^2 v}{\\sigma^2}\\right)\n$$\n\n### Step 2: Geodesic Equations and Numerical Integration\n\nThe geodesic equations are `$\\ddot{\\gamma}^k + \\Gamma^k_{ij}(\\gamma)\\dot{\\gamma}^i\\dot{\\gamma}^j = 0$`. For a curve `$\\gamma(t) = (u(t), v(t))$`, this expands to:\n$$\n\\ddot{u} + \\Gamma^1_{11}\\dot{u}^2 + 2\\Gamma^1_{12}\\dot{u}\\dot{v} + \\Gamma^1_{22}\\dot{v}^2 = 0\n$$\n$$\n\\ddot{v} + \\Gamma^2_{11}\\dot{u}^2 + 2\\Gamma^2_{12}\\dot{u}\\dot{v} + \\Gamma^2_{22}\\dot{v}^2 = 0\n$$\nSubstituting the Christoffel symbols, we obtain the system for the second derivatives:\n$$\n\\ddot{u} = -\\frac{1}{2\\lambda} \\left( \\lambda_u(\\dot{u}^2 - \\dot{v}^2) + 2\\lambda_v \\dot{u}\\dot{v} \\right)\n$$\n$$\n\\ddot{v} = -\\frac{1}{2\\lambda} \\left( \\lambda_v(\\dot{v}^2 - \\dot{u}^2) + 2\\lambda_u \\dot{u}\\dot{v} \\right)\n$$\nTo numerically integrate these, we convert them into a first-order system. Let the state vector be `$Y(t) = [u(t), v(t), \\dot{u}(t), \\dot{v}(t)]^T$`. The system is `$\\dot{Y} = f(t, Y)$` where `$f$` is:\n$$\n\\dot{Y} = \\begin{bmatrix} \\dot{u} \\\\ \\dot{v} \\\\ \\ddot{u}(u,v,\\dot{u},\\dot{v}) \\\\ \\ddot{v}(u,v,\\dot{u},\\dot{v}) \\end{bmatrix}\n$$\nThe exponential map `$\\exp_p(x)$` is found by solving this system with specific initial conditions. The base point is `$p = (\\pi, \\pi)$`. The input `$x = (x_1, x_2)$` is a vector in `$T_p\\mathbb{T}^2$` expressed in the orthonormal basis `$\\{\\frac{1}{\\sqrt{\\lambda(p)}}\\partial_u, \\frac{1}{\\sqrt{\\lambda(p)}}\\partial_v\\}$`.\nThe value of the conformal factor at `$p$` is `$\\lambda(p) = \\lambda(\\pi, \\pi) = 1 + \\varepsilon \\exp(0) = 1+\\varepsilon = 1.5$`.\nThe initial conditions at `$t=0$` are:\n*   Position: `$(u(0), v(0)) = (\\pi, \\pi)$`.\n*   Velocity: `$(\\dot{u}(0), \\dot{v}(0)) = \\left(\\frac{x_1}{\\sqrt{\\lambda(p)}}, \\frac{x_2}{\\sqrt{\\lambda(p)}}\\right) = \\left(\\frac{x_1}{\\sqrt{1.5}}, \\frac{x_2}{\\sqrt{1.5}}\\right)`.\n\nWe integrate this system from `$t=0$` to `$t=1$`. The resulting position `$(u(1), v(1)) \\pmod{2\\pi}$` is `$\\exp_p(x)$`.\n\n### Step 3: Numerical Jacobian Computation\n\nThe Jacobian matrix `$J(x) = D\\exp_p(x)$` is a `$2 \\times 2$` matrix whose columns are the partial derivatives of `$\\exp_p(x)$` with respect to `$x_1$` and `$x_2$`. We approximate these derivatives using a central finite difference scheme. Let `$\\exp_p(x) = (U(x), V(x))$`.\n$$\n\\frac{\\partial \\exp_p}{\\partial x_1}(x) \\approx \\frac{\\exp_p(x_1+h, x_2) - \\exp_p(x_1-h, x_2)}{2h}\n$$\n$$\n\\frac{\\partial \\exp_p}{\\partial x_2}(x) \\approx \\frac{\\exp_p(x_1, x_2+h) - \\exp_p(x_1, x_2-h)}{2h}\n$$\nA crucial detail for the torus `$\\mathbb{T}^2$` is that coordinate differences must account for the periodicity. The difference between two angles `$a_1$` and `$a_2$` should be the minimal signed angle `$(a_1 - a_2 + \\pi) \\pmod{2\\pi} - \\pi$`. This prevents large artificial jumps when crossing the `$2\\pi$` boundary. We will use a small step size `$h$`, for instance `$h=10^{-6}$`.\n\n### Step 4: Pulled-Back Metric and Deviation from Isometry\n\nThe pulled-back metric `$\\tilde{g}(x)$` in normal coordinates is given by `$\\tilde{g}(x) = (\\exp_p^*g)(x) = J(x)^\\top g(\\exp_p(x)) J(x)$`. The metric tensor in `$(u,v)$` coordinates is `$g(u,v) = \\lambda(u,v)I_2$`, where `$I_2$` is the `$2 \\times 2$` identity matrix.\nThus,\n$$\n\\tilde{g}(x) = J(x)^\\top \\left( \\lambda(\\exp_p(x)) I_2 \\right) J(x) = \\lambda(\\exp_p(x)) J(x)^\\top J(x)\n$$\nTo quantify the deviation from local symmetry, we compute this matrix for both `$x$` and `$-x$`, take their difference, and find its Frobenius norm:\n$$\n\\text{Deviation} = \\left\\| \\tilde{g}(x) - \\tilde{g}(-x) \\right\\|_F = \\sqrt{\\sum_{i,j=1}^2 (\\tilde{g}_{ij}(x) - \\tilde{g}_{ij}(-x))^2}\n$$\nFor a locally symmetric space, the geodesic symmetry map `$s_p$` is an isometry. In normal coordinates, `$s_p$` is approximated by `$x \\mapsto -x$`, and the isometry condition translates to `$\\tilde{g}(x) = \\tilde{g}(-x)$`. Our calculation measures how much this equality is violated.\nFor the special case `$x=(0,0)$`, the initial velocity is zero, so the geodesic is the constant path `$\\gamma(t) = p$`. Thus `$\\exp_p(0) = p$`. The Jacobian of the exponential map at the origin is the identity, `$J(0) = I_2$`. Therefore, `$\\tilde{g}(0) = I_2^\\top g(p) I_2 = g(p)$`. Since `$-x=x` for `$x=0$`, we have `$\\tilde{g}(0) - \\tilde{g}(-0) = 0$`, and the norm is `$0$`. For all other cases, a numerical computation is required.\nThe constants are `$\\varepsilon = 0.5$` and `$\\sigma = 0.6$`. The solution will be implemented in Python using `scipy.integrate.solve_ivp` for the ODE integration.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Meticulous and exacting professor's implementation\n\n# --- Problem Constants and Definitions ---\n\n# Fixed constants from the problem statement\nEPSILON = 0.5\nSIGMA = 0.6\nSIGMA_SQ = SIGMA**2\n\n# Base point p on the torus\nP_POINT = np.array([np.pi, np.pi])\n\n# Conformal factor lambda(u,v) = 1 + ε * exp(-(sin^2(u) + sin^2(v))/σ^2)\ndef lambda_func(u, v):\n    \"\"\"Computes the conformal factor lambda at coordinates (u, v).\"\"\"\n    sin_u_sq = np.sin(u)**2\n    sin_v_sq = np.sin(v)**2\n    exponent = -(sin_u_sq + sin_v_sq) / SIGMA_SQ\n    return 1.0 + EPSILON * np.exp(exponent)\n\n# Partial derivatives of the conformal factor\ndef lambda_partials(u, v):\n    \"\"\"Computes the partial derivatives ∂λ/∂u and ∂λ/∂v at (u, v).\"\"\"\n    sin_u_sq = np.sin(u)**2\n    sin_v_sq = np.sin(v)**2\n    common_factor = EPSILON * np.exp(-(sin_u_sq + sin_v_sq) / SIGMA_SQ)\n    \n    # ∂λ/∂u = -2ε/σ^2 * sin(u)cos(u) * exp(...)\n    lambda_u = common_factor * (-2.0 / SIGMA_SQ) * np.sin(u) * np.cos(u)\n    \n    # ∂λ/∂v = -2ε/σ^2 * sin(v)cos(v) * exp(...)\n    lambda_v = common_factor * (-2.0 / SIGMA_SQ) * np.sin(v) * np.cos(v)\n    \n    return lambda_u, lambda_v\n\n# --- Geodesic Equation Implementation ---\n\n# The first-order system for the geodesic ODE: dY/dt = f(t, Y)\n# Y = [u, v, u_dot, v_dot]\ndef geodesic_eq(t, y):\n    \"\"\"\n    Defines the system of first-order ODEs for the geodesic equation.\n    y is the state vector [u, v, u_dot, v_dot].\n    \"\"\"\n    u, v, u_dot, v_dot = y\n    \n    # Calculate lambda and its partials at the current position (u,v)\n    lam = lambda_func(u, v)\n    lam_u, lam_v = lambda_partials(u, v)\n    \n    # Common factor in the expressions for u_ddot and v_ddot\n    factor = -1.0 / (2.0 * lam)\n    \n    # dot_u^2 - dot_v^2\n    udot_sq_minus_vdot_sq = u_dot**2 - v_dot**2\n    # 2 * dot_u * dot_v\n    two_udot_vdot = 2.0 * u_dot * v_dot\n    \n    # Second derivatives (accelerations)\n    # u_ddot = -1/(2λ) * (λ_u * (u̇² - v̇²) + 2λ_v * u̇v̇)\n    u_ddot = factor * (lam_u * udot_sq_minus_vdot_sq + lam_v * two_udot_vdot)\n    \n    # v_ddot = -1/(2λ) * (λ_v * (v̇² - u̇²) + 2λ_u * u̇v̇)\n    v_ddot = factor * (lam_v * (-udot_sq_minus_vdot_sq) + lam_u * two_udot_vdot)\n\n    return [u_dot, v_dot, u_ddot, v_ddot]\n\n# --- Exponential Map and its Jacobian ---\n\n# Value of lambda at the base point p=(π,π)\nLAMBDA_P = lambda_func(P_POINT[0], P_POINT[1])\nSQRT_LAMBDA_P = np.sqrt(LAMBDA_P)\n\ndef exponential_map(x_normal_coords):\n    \"\"\"\n    Computes exp_p(x) by integrating the geodesic equation.\n    x_normal_coords: (x1, x2) vector in normal coordinates at p.\n    \"\"\"\n    x1, x2 = x_normal_coords\n    \n    # Initial conditions for the ODE system\n    # Position: p = (π, π)\n    # Velocity: (u̇(0), v̇(0)) = (x1/√λ(p), x2/√λ(p))\n    y0 = [P_POINT[0], P_POINT[1], x1 / SQRT_LAMBDA_P, x2 / SQRT_LAMBDA_P]\n\n    # Integrate from t=0 to t=1\n    sol = solve_ivp(\n        geodesic_eq, \n        [0, 1], \n        y0, \n        method='RK45', \n        dense_output=True, \n        rtol=1e-12, \n        atol=1e-12\n    )\n\n    # The result is the position at t=1\n    final_pos = sol.y[:2, -1]\n    \n    # The result is on a torus, so we wrap coordinates to [0, 2π)\n    return final_pos % (2 * np.pi)\n\ndef angle_diff(a1, a2):\n    \"\"\"\n    Computes the minimal signed difference between two angles.\n    The result is in [-π, π].\n    \"\"\"\n    diff_not_wrapped = a1 - a2\n    return (diff_not_wrapped + np.pi) % (2 * np.pi) - np.pi\n\ndef jacobian_of_exp_map(x_normal_coords, h=1e-6):\n    \"\"\"\n    Computes the Jacobian of the exponential map D(exp_p)(x)\n    using central finite differences.\n    \"\"\"\n    x_vec = np.array(x_normal_coords, dtype=float)\n    \n    # Perturbations along standard basis vectors e1 and e2\n    h_vec1 = np.array([h, 0.0])\n    h_vec2 = np.array([0.0, h])\n\n    # Column 1 of the Jacobian: ∂(exp_p)/∂x1\n    exp_plus_h1 = exponential_map(x_vec + h_vec1)\n    exp_minus_h1 = exponential_map(x_vec - h_vec1)\n    col1_u = angle_diff(exp_plus_h1[0], exp_minus_h1[0]) / (2 * h)\n    col1_v = angle_diff(exp_plus_h1[1], exp_minus_h1[1]) / (2 * h)\n    \n    # Column 2 of the Jacobian: ∂(exp_p)/∂x2\n    exp_plus_h2 = exponential_map(x_vec + h_vec2)\n    exp_minus_h2 = exponential_map(x_vec - h_vec2)\n    col2_u = angle_diff(exp_plus_h2[0], exp_minus_h2[0]) / (2 * h)\n    col2_v = angle_diff(exp_plus_h2[1], exp_minus_h2[1]) / (2 * h)\n    \n    return np.array([[col1_u, col2_u], [col1_v, col2_v]])\n\n# --- Main Solver Function ---\n\ndef solve():\n    \"\"\"\n    Main function to execute the full numerical procedure for all test cases.\n    \"\"\"\n    test_cases = [\n        (0.0, 0.0),\n        (0.05, 0.0),\n        (0.0, 0.05),\n        (0.2, 0.15),\n        (0.4, -0.3),\n        (1.0, 0.0)\n    ]\n    \n    results = []\n    \n    for x_test in test_cases:\n        x_vec = np.array(x_test, dtype=float)\n\n        # Handle the trivial case x=(0,0) where the result is exactly 0\n        if np.allclose(x_vec, 0.0):\n            results.append(0.0)\n            continue\n            \n        neg_x_vec = -x_vec\n\n        # --- Calculate g_tilde(x) ---\n        # 1. Compute exp_p(x)\n        exp_at_x = exponential_map(x_vec)\n        # 2. Compute the metric factor at the endpoint\n        lambda_at_exp_x = lambda_func(exp_at_x[0], exp_at_x[1])\n        # 3. Compute the Jacobian J(x)\n        J_at_x = jacobian_of_exp_map(x_vec)\n        # 4. Compute g_tilde(x) = λ(exp_p(x)) * J(x)^T * J(x)\n        g_tilde_at_x = lambda_at_exp_x * (J_at_x.T @ J_at_x)\n\n        # --- Calculate g_tilde(-x) ---\n        # 1. Compute exp_p(-x)\n        exp_at_neg_x = exponential_map(neg_x_vec)\n        # 2. Compute the metric factor at the endpoint\n        lambda_at_exp_neg_x = lambda_func(exp_at_neg_x[0], exp_at_neg_x[1])\n        # 3. Compute the Jacobian J(-x)\n        J_at_neg_x = jacobian_of_exp_map(neg_x_vec)\n        # 4. Compute g_tilde(-x)\n        g_tilde_at_neg_x = lambda_at_exp_neg_x * (J_at_neg_x.T @ J_at_neg_x)\n\n        # --- Compute the final result for this case ---\n        # 5. Calculate the difference matrix\n        diff_matrix = g_tilde_at_x - g_tilde_at_neg_x\n        # 6. Compute the Frobenius norm of the difference\n        frobenius_norm = np.linalg.norm(diff_matrix, 'fro')\n        \n        results.append(frobenius_norm)\n\n    # Format the output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Run the solver\nsolve()\n\n```", "id": "3071564"}]}