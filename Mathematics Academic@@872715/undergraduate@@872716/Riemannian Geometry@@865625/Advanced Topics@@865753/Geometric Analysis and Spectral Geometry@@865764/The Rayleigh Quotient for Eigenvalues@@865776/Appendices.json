{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will start with the simplest possible Riemannian manifold: a one-dimensional interval. This fundamental exercise bridges the abstract variational principle of the Rayleigh quotient with the concrete and familiar world of ordinary differential equations. By applying the calculus of variations, you will derive and solve the equation that a minimizing function must satisfy, thereby computing the first eigenvalue directly and building intuition for how geometric properties, like the length $L$ of the interval, influence the spectrum [@problem_id:3076328].", "problem": "Consider the one-dimensional Riemannian manifold (interval) $(0,L)$ equipped with the standard metric $g=dx^{2}$ and the associated volume element $dV=dx$. For a function $u$ in the Sobolev space $H_{0}^{1}(0,L)$ (vanishing at the boundary), define the Rayleigh quotient\n$$\nR(u)=\\frac{\\int_{0}^{L} |u'(x)|^{2}\\,dx}{\\int_{0}^{L} |u(x)|^{2}\\,dx},\n$$\nwhere $u\\not\\equiv 0$. The first Dirichlet eigenvalue $\\lambda_{1}$ of the Laplace–Beltrami operator on $(0,L)$ is characterized as the infimum of $R(u)$ over nonzero $u\\in H_{0}^{1}(0,L)$.\n\nStarting from the variational characterization above and fundamental calculus of variations, compute the exact value of $\\lambda_{1}$ by deriving the Euler–Lagrange equation for a minimizer under the unit $L^{2}$-norm constraint and solving the resulting boundary value problem. Then, verify directly from the Rayleigh quotient definition that $\\lambda_{1}$ scales with $L^{-2}$ under a change of variables that rescales the interval length.\n\nProvide your final answer as a single simplified analytic expression in terms of $L$. No rounding is required, and no units are involved.", "solution": "We work on the interval $(0,L)$ with the standard metric $g=dx^{2}$. The Rayleigh quotient for $u\\in H_{0}^{1}(0,L)$, $u\\not\\equiv 0$, is\n$$\nR(u)=\\frac{\\int_{0}^{L} |u'(x)|^{2}\\,dx}{\\int_{0}^{L} |u(x)|^{2}\\,dx}.\n$$\nBy the variational characterization of the first Dirichlet eigenvalue,\n$$\n\\lambda_{1}=\\inf_{u\\in H_{0}^{1}(0,L),\\,u\\not\\equiv 0} R(u).\n$$\nTo compute $\\lambda_{1}$, we set up the constrained minimization problem\n$$\n\\min\\left\\{\\int_{0}^{L} |u'(x)|^{2}\\,dx:\\ u\\in H_{0}^{1}(0,L),\\ \\int_{0}^{L} |u(x)|^{2}\\,dx=1\\right\\}.\n$$\nBy the direct method of the calculus of variations, a minimizer $u$ exists. Introduce a Lagrange multiplier $\\lambda\\in\\mathbb{R}$ for the unit $L^{2}$ constraint and consider the functional\n$$\n\\mathcal{F}(u)=\\int_{0}^{L} |u'(x)|^{2}\\,dx-\\lambda\\left(\\int_{0}^{L} |u(x)|^{2}\\,dx-1\\right).\n$$\nFor a smooth compactly supported variation $\\varphi\\in C_{c}^{\\infty}(0,L)$ with $\\int_{0}^{L} 2u\\varphi\\,dx=0$ at first order (enforcing the constraint), stationarity of $\\mathcal{F}$ at $u$ yields\n$$\n0=\\left.\\frac{d}{d\\epsilon}\\right|_{\\epsilon=0}\\mathcal{F}(u+\\epsilon\\varphi)=2\\int_{0}^{L} u'(x)\\varphi'(x)\\,dx-2\\lambda\\int_{0}^{L} u(x)\\varphi(x)\\,dx.\n$$\nIntegrating by parts the first term and using that $u(0)=u(L)=0$ (hence the boundary term vanishes for $\\varphi$ with compact support or vanishing at the boundary), we obtain\n$$\n\\int_{0}^{L} \\big(-u''(x)-\\lambda u(x)\\big)\\,\\varphi(x)\\,dx=0\\quad\\text{for all}\\ \\varphi.\n$$\nTherefore $u$ satisfies the Euler–Lagrange equation\n$$\n-u''(x)=\\lambda u(x)\\quad\\text{for}\\ x\\in(0,L),\\qquad u(0)=0,\\quad u(L)=0.\n$$\nWe solve this second-order linear ordinary differential equation. If $\\lambda>0$, write $\\lambda=\\mu^{2}$ with $\\mu>0$. Then the general solution is\n$$\nu(x)=A\\sin(\\mu x)+B\\cos(\\mu x).\n$$\nImposing $u(0)=0$ gives $B=0$, so $u(x)=A\\sin(\\mu x)$. Imposing $u(L)=0$ gives $\\sin(\\mu L)=0$, hence $\\mu L=n\\pi$ for some integer $n\\in\\mathbb{Z}$. For a nontrivial solution with $A\\neq 0$, we require $n\\in\\mathbb{Z}\\setminus\\{0\\}$, and since $u$ and $-u$ represent the same eigenfunction up to sign, we take $n\\in\\mathbb{N}$. Therefore the admissible values of $\\lambda$ are\n$$\n\\lambda_{n}=\\mu^{2}=\\left(\\frac{n\\pi}{L}\\right)^{2},\\quad n\\in\\mathbb{N}.\n$$\nThe first Dirichlet eigenvalue is the smallest such value, attained for $n=1$:\n$$\n\\lambda_{1}=\\left(\\frac{\\pi}{L}\\right)^{2}.\n$$\nTo verify the scaling with $L^{-2}$ directly from the Rayleigh quotient, consider any $u\\in H_{0}^{1}(0,L)$ and define $w:(0,1)\\to\\mathbb{R}$ by $w(y)=u(Ly)$. Then $w(0)=u(0)=0$ and $w(1)=u(L)=0$, so $w\\in H_{0}^{1}(0,1)$. Compute the numerator and denominator of $R(u)$ via the change of variables $x=Ly$:\n$$\n\\int_{0}^{L} |u'(x)|^{2}\\,dx=\\int_{0}^{1} \\left|u'(Ly)\\right|^{2} L\\,dy=\\int_{0}^{1} \\left|\\frac{w'(y)}{L}\\right|^{2} L\\,dy=\\frac{1}{L}\\int_{0}^{1} |w'(y)|^{2}\\,dy,\n$$\nand\n$$\n\\int_{0}^{L} |u(x)|^{2}\\,dx=\\int_{0}^{1} |u(Ly)|^{2} L\\,dy=L\\int_{0}^{1} |w(y)|^{2}\\,dy.\n$$\nHence\n$$\nR(u)=\\frac{\\frac{1}{L}\\int_{0}^{1} |w'(y)|^{2}\\,dy}{L\\int_{0}^{1} |w(y)|^{2}\\,dy}=\\frac{1}{L^{2}}\\cdot \\frac{\\int_{0}^{1} |w'(y)|^{2}\\,dy}{\\int_{0}^{1} |w(y)|^{2}\\,dy}.\n$$\nTaking infima over nonzero $u$ on $(0,L)$ corresponds exactly to taking infima over nonzero $w$ on $(0,1)$, so\n$$\n\\lambda_{1}(L)=\\inf_{u\\neq 0} R(u)=\\frac{1}{L^{2}}\\,\\inf_{w\\neq 0}\\frac{\\int_{0}^{1} |w'(y)|^{2}\\,dy}{\\int_{0}^{1} |w(y)|^{2}\\,dy}=\\frac{1}{L^{2}}\\,\\lambda_{1}(1).\n$$\nFrom the boundary value problem with $L=1$, we found $\\lambda_{1}(1)=\\pi^{2}$. Therefore,\n$$\n\\lambda_{1}(L)=\\frac{\\pi^{2}}{L^{2}},\n$$\nwhich both computes $\\lambda_{1}$ and verifies its scaling with $L^{-2}$.", "answer": "$$\\boxed{\\frac{\\pi^{2}}{L^{2}}}$$", "id": "3076328"}, {"introduction": "Having mastered the interval, we now move to a more complex, boundary-less geometry: the flat $n$-torus. This practice introduces a powerful and elegant analytical tool, Fourier analysis, which is perfectly suited for manifolds with periodic structures. By representing functions as superpositions of complex exponentials, you will discover how the spectrum of the Laplacian is elegantly quantized by integer vectors and see firsthand that while the first nonzero eigenvalue is independent of the dimension $n$, its multiplicity is not [@problem_id:3076295].", "problem": "Let $T^{n}$ denote the unit flat $n$-torus, defined as $T^{n} = \\mathbb{R}^{n} / \\mathbb{Z}^{n}$ with the standard Euclidean metric $g$ induced from $\\mathbb{R}^{n}$. Identify $T^{n}$ with the cube $[0,1)^{n}$ with opposite faces identified, and let $dV$ denote the Riemannian volume measure on $T^{n}$ given by Lebesgue measure, so that $\\int_{T^{n}} 1 \\, dV = 1$. Consider the Laplace–Beltrami operator $\\Delta$ associated to $g$, acting on smooth functions $u : T^{n} \\to \\mathbb{C}$, and the Rayleigh quotient\n$$\n\\mathcal{R}[u] = \\frac{\\int_{T^{n}} |\\nabla u|^{2} \\, dV}{\\int_{T^{n}} |u|^{2} \\, dV},\n$$\ndefined for nonzero $u$ that are $L^{2}$-orthogonal to the constants, i.e., $\\int_{T^{n}} u \\, dV = 0$.\n\nA trigonometric polynomial on $T^{n}$ is a finite linear combination of functions of the form $x \\mapsto \\exp(2\\pi i k \\cdot x)$, where $k \\in \\mathbb{Z}^{n}$ and $x \\in T^{n}$ is represented by a vector in $[0,1)^{n}$. By minimizing the Rayleigh quotient $\\mathcal{R}[u]$ over nonzero, mean-zero trigonometric polynomials, compute the first nonzero eigenvalue $\\lambda_{1}$ of $-\\Delta$ on $T^{n}$. Express your final answer as a closed-form analytic expression in terms of $\\pi$. No rounding is required. Additionally, explain what the minimizing functions look like and how the result depends on the dimension $n$.", "solution": "The problem asks for the computation of the first nonzero eigenvalue $\\lambda_{1}$ of the negative Laplace–Beltrami operator, $-\\Delta$, on the unit flat $n$-torus $T^{n} = \\mathbb{R}^{n} / \\mathbb{Z}^{n}$. This is to be achieved by minimizing the Rayleigh quotient,\n$$\n\\mathcal{R}[u] = \\frac{\\int_{T^{n}} |\\nabla u|^{2} \\, dV}{\\int_{T^{n}} |u|^{2} \\, dV}\n$$\nover the set of nonzero trigonometric polynomials $u$ with zero mean, i.e., $\\int_{T^{n}} u \\, dV = 0$.\n\nThe standard approach to problems involving the Laplacian on the flat torus is to use Fourier analysis. The space of square-integrable complex-valued functions $L^{2}(T^{n}, \\mathbb{C})$ has a complete orthonormal basis given by the functions $e_{k}(x) = \\exp(2\\pi i k \\cdot x)$, where $k \\in \\mathbb{Z}^{n}$ and $x \\in T^{n} \\cong [0,1)^{n}$. The dot product $k \\cdot x$ is the standard Euclidean dot product in $\\mathbb{R}^{n}$, $k \\cdot x = \\sum_{j=1}^{n} k_j x_j$. Orthonormality means that the inner product on $L^{2}(T^{n})$ satisfies:\n$$\n\\langle e_k, e_j \\rangle = \\int_{T^{n}} e_k(x) \\overline{e_j(x)} \\, dV = \\int_{[0,1)^{n}} \\exp(2\\pi i k \\cdot x) \\exp(-2\\pi i j \\cdot x) \\, dx = \\delta_{kj}\n$$\nwhere $\\delta_{kj}$ is the Kronecker delta.\n\nThe Laplace–Beltrami operator $\\Delta$ on the flat torus $T^{n}$ with the metric induced from $\\mathbb{R}^{n}$ is simply the standard Laplacian $\\Delta = \\sum_{j=1}^{n} \\frac{\\partial^2}{\\partial x_j^2}$. Let us apply this operator to one of the basis functions $e_k(x)$:\n$$\n\\frac{\\partial}{\\partial x_j} e_k(x) = \\frac{\\partial}{\\partial x_j} \\exp(2\\pi i \\sum_{l=1}^{n} k_l x_l) = 2\\pi i k_j e_k(x)\n$$\n$$\n\\frac{\\partial^2}{\\partial x_j^2} e_k(x) = (2\\pi i k_j)^{2} e_k(x) = -4\\pi^{2} k_j^{2} e_k(x)\n$$\nSumming over all $j$ from $1$ to $n$, we find the action of the Laplacian on $e_k(x)$:\n$$\n\\Delta e_k(x) = \\sum_{j=1}^{n} \\frac{\\partial^2}{\\partial x_j^2} e_k(x) = \\sum_{j=1}^{n} (-4\\pi^{2} k_j^{2}) e_k(x) = -4\\pi^{2} \\left(\\sum_{j=1}^{n} k_j^{2}\\right) e_k(x) = -4\\pi^{2} |k|^{2} e_k(x)\n$$\nwhere $|k|^{2} = \\sum_{j=1}^{n} k_j^{2}$ is the squared Euclidean norm of the integer vector $k$. This demonstrates that the functions $e_k(x)$ are eigenfunctions of $\\Delta$. The corresponding eigenvalues of the negative Laplacian, $-\\Delta$, are therefore $\\lambda_k = 4\\pi^{2} |k|^{2}$.\n\nThe problem specifies that the Rayleigh quotient is to be evaluated for functions $u$ that are $L^{2}$-orthogonal to the constants. The constant function $f(x)=1$ corresponds to the basis function $e_0(x) = \\exp(2\\pi i 0 \\cdot x) = 1$. The condition $\\int_{T^{n}} u \\, dV = 0$ is equivalent to $\\langle u, e_0 \\rangle = 0$.\n\nA trigonometric polynomial $u$ is a finite linear combination of the basis functions: $u(x) = \\sum_{k \\in S} c_k e_k(x)$ for some finite set $S \\subset \\mathbb{Z}^n$. The condition $\\langle u, e_0 \\rangle = 0$ implies that the coefficient $c_0$ must be zero. Thus, we consider functions of the form $u(x) = \\sum_{k \\in S \\setminus \\{0\\}} c_k e_k(x)$, where not all $c_k$ are zero.\n\nLet's evaluate the numerator and denominator of the Rayleigh quotient for such a function $u$.\nThe denominator is the squared $L^{2}$-norm of $u$:\n$$\n\\int_{T^{n}} |u|^{2} \\, dV = \\langle u, u \\rangle = \\left\\langle \\sum_{k \\ne 0} c_k e_k, \\sum_{j \\ne 0} c_j e_j \\right\\rangle = \\sum_{k,j \\ne 0} c_k \\bar{c}_j \\langle e_k, e_j \\rangle = \\sum_{k \\ne 0} |c_k|^{2}\n$$\nThis is a direct consequence of the orthonormality of the basis functions (Parseval's identity).\n\nThe numerator is the Dirichlet energy of $u$. We can relate it to the Laplacian via Green's first identity (or integration by parts). For the torus, which has no boundary, this identity is $\\int_{T^n} \\langle \\nabla u, \\nabla v \\rangle \\, dV = \\int_{T^n} u (-\\Delta \\bar{v}) \\, dV$. For $v=u$, this becomes:\n$$\n\\int_{T^{n}} |\\nabla u|^{2} \\, dV = \\int_{T^{n}} u(-\\Delta \\bar{u}) \\, dV\n$$\nWe have $\\bar{u}(x) = \\sum_{j \\ne 0} \\bar{c}_j \\overline{e_j(x)} = \\sum_{j \\ne 0} \\bar{c}_j e_{-j}(x)$. Applying $-\\Delta$:\n$$\n-\\Delta \\bar{u} = \\sum_{j \\ne 0} \\bar{c}_j (-\\Delta e_{-j}) = \\sum_{j \\ne 0} \\bar{c}_j (4\\pi^2 |-j|^2) e_{-j} = \\sum_{j \\ne 0} \\bar{c}_j (4\\pi^2 |j|^2) \\overline{e_j}\n$$\nSubstituting this into the integral for the numerator:\n$$\n\\int_{T^{n}} u(-\\Delta \\bar{u}) \\, dV = \\left\\langle u, -\\Delta u \\right\\rangle = \\left\\langle \\sum_{k \\ne 0} c_k e_k, \\sum_{j \\ne 0} c_j (4\\pi^2 |j|^2) e_j \\right\\rangle = \\sum_{k,j \\ne 0} c_k \\bar{c}_j (4\\pi^2 |j|^2) \\langle e_k, e_j \\rangle = \\sum_{k \\ne 0} |c_k|^{2} (4\\pi^{2} |k|^{2})\n$$\nThe Rayleigh quotient for the trigonometric polynomial $u$ is therefore:\n$$\n\\mathcal{R}[u] = \\frac{\\sum_{k \\ne 0} |c_k|^{2} (4\\pi^{2} |k|^{2})}{\\sum_{k \\ne 0} |c_k|^{2}} = 4\\pi^{2} \\frac{\\sum_{k \\ne 0} |c_k|^{2} |k|^{2}}{\\sum_{k \\ne 0} |c_k|^{2}}\n$$\nThis expression is a weighted average of the quantities $4\\pi^{2} |k|^{2}$ (the eigenvalues of $-\\Delta$), where the weights are $|c_k|^{2} \\ge 0$. To minimize this average, we must place all the weight on the term with the smallest value of $|k|^{2}$. The sum is over non-zero integer vectors $k \\in \\mathbb{Z}^{n} \\setminus \\{0\\}$. The value of $|k|^{2} = k_1^{2} + k_2^{2} + \\dots + k_n^{2}$ is a sum of squares of integers, and since $k \\ne 0$, at least one $k_j$ must be a non-zero integer. The smallest possible non-zero integer squared is $(\\pm 1)^{2} = 1$. Thus, the minimum value of $|k|^2$ is $1$, achieved when one component $k_j$ is $\\pm 1$ and all other components are $0$.\n\nThe minimum value of the Rayleigh quotient is therefore achieved when the coefficients $c_k$ are non-zero only for those $k$ where $|k|^{2}$ attains its minimum value of $1$.\n$$\n\\min_{u} \\mathcal{R}[u] = 4\\pi^{2} \\min_{k \\in \\mathbb{Z}^{n} \\setminus \\{0\\}} |k|^{2} = 4\\pi^{2} \\cdot 1 = 4\\pi^{2}\n$$\nBy the min-max principle, the first nonzero eigenvalue $\\lambda_{1}$ of $-\\Delta$ is the minimum of the Rayleigh quotient over the space of functions orthogonal to the constants. Since trigonometric polynomials are dense in the relevant function space ($H^{1}(T^{n})$), this minimum is indeed $\\lambda_{1}$.\n\nSo, the first nonzero eigenvalue is $\\lambda_{1} = 4\\pi^{2}$.\n\nThe minimizing functions are the eigenfunctions corresponding to this eigenvalue $\\lambda_1$. They are any non-zero linear combination of the basis functions $e_k(x)$ for which $|k|^2 = 1$. The integer vectors $k \\in \\mathbb{Z}^n$ satisfying $|k|^2=1$ are those with exactly one component equal to $\\pm 1$ and all other components equal to $0$. These vectors are $\\pm e_j$ for $j=1, \\dots, n$, where $e_j$ is the $j$-th standard basis vector of $\\mathbb{R}^n$. There are $2n$ such vectors. The corresponding complex-valued eigenfunctions are $e_{\\pm e_j}(x) = \\exp(\\pm 2\\pi i (e_j \\cdot x)) = \\exp(\\pm 2\\pi i x_j)$ for $j=1, \\dots, n$. Real-valued minimizing functions can be formed by taking linear combinations, for example $\\cos(2\\pi x_j) = \\frac{1}{2}(\\exp(2\\pi i x_j) + \\exp(-2\\pi i x_j))$ and $\\sin(2\\pi x_j) = \\frac{1}{2i}(\\exp(2\\pi i x_j) - \\exp(-2\\pi i x_j))$.\n\nRegarding the dependence on the dimension $n$:\nThe value of the first nonzero eigenvalue, $\\lambda_{1}=4\\pi^{2}$, is independent of the dimension $n$. This is because the minimum non-zero squared length of an integer vector in $\\mathbb{Z}^n$ is always $1$, regardless of $n \\ge 1$.\nHowever, the multiplicity of the eigenvalue $\\lambda_{1}$ does depend on $n$. The multiplicity is the dimension of the corresponding eigenspace, which is the number of distinct vectors $k \\in \\mathbb{Z}^{n}$ such that $|k|^2 = 1$. As determined above, there are $2n$ such vectors. Therefore, the multiplicity of $\\lambda_{1}$ is $2n$. While the eigenvalue itself does not change, the size of the family of minimizing functions grows linearly with the dimension of the torus.", "answer": "$$\\boxed{4\\pi^2}$$", "id": "3076295"}, {"introduction": "While analytical solutions are enlightening, most real-world applications involve geometries far too complex for them. This final practice bridges the gap between pure theory and computational practice by guiding you through a Finite Element Method (FEM) implementation to approximate the Laplacian's eigenvalues. You will see how the continuous variational problem is transformed into a discrete matrix eigenvalue problem and how the Rayleigh quotient itself inspires a potent numerical solver, the Rayleigh Quotient Iteration, demonstrating its central role in both theoretical and applied contexts [@problem_id:3076310].", "problem": "Consider the Laplace–Beltrami operator on a compact Riemannian domain with boundary. On the Euclidean unit square domain $\\Omega = [0,1] \\times [0,1]$ equipped with the Euclidean metric $g = I$, the Laplace–Beltrami operator reduces to the standard Laplacian. Impose homogeneous Dirichlet boundary conditions on $\\partial \\Omega$ so that admissible functions vanish on the boundary. The first Dirichlet eigenvalue is characterized variationally by minimizing the Rayleigh quotient over nonzero admissible functions. In a finite element approximation, the continuous function space is replaced by a piecewise linear space over a triangulation of $\\Omega$, and the continuous bilinear forms are approximated by their discrete analogs to produce a generalized symmetric eigenvalue problem.\n\nTask:\n- From first principles and standard definitions, implement a piecewise linear finite element method on a triangulated partition of $\\Omega$ obtained by subdividing the unit square into a uniform grid of $N_x \\times N_y$ rectangles and splitting each rectangle into two triangles by a consistent diagonal. Assemble the discrete stiffness matrix and mass matrix using the standard definitions of the bilinear forms associated with the Dirichlet energy and the $L^2$ inner product, respectively. Enforce homogeneous Dirichlet boundary conditions by restricting to interior nodes.\n- Implement Rayleigh quotient iteration for the symmetric generalized eigenproblem induced by the assembled matrices, using the inner product defined by the discrete mass matrix. Start from first principles: define the Rayleigh quotient induced by the stiffness and mass bilinear forms, and derive an iterative scheme that repeatedly shifts by the current Rayleigh quotient and solves a linear system to update the eigenvector candidate, normalizing with respect to the mass-inner product after each update. Ensure the implementation is numerically stable and handles near-singularity when the shift approaches an eigenvalue. Use any robust and consistent strategy grounded in the underlying definitions to regularize the shifted system if needed.\n- In the degenerate boundary case where the number of interior degrees of freedom is $1$, detect this and return the Rayleigh quotient of the unique nonzero direction without iteration, citing the variational characterization that the quotient is exact in a one-dimensional trial space.\n\nDefinitions you may use as a fundamental base:\n- The Rayleigh quotient of a nonzero vector in a finite-dimensional inner product space is the ratio of the energy induced by the stiffness bilinear form to the squared norm induced by the mass bilinear form.\n- The first eigenvalue associated with homogeneous Dirichlet boundary conditions is the minimum of the Rayleigh quotient over nonzero admissible functions.\n\nYour program must:\n- Construct the finite element mesh and assemble the matrices for each of the following test cases $(N_x,N_y)$:\n    - Test $1$: $(N_x,N_y)=(2,2)$, representing a very coarse mesh that yields exactly $1$ interior node after enforcing Dirichlet boundary conditions. This is the boundary case.\n    - Test $2$: $(N_x,N_y)=(6,6)$, representing a moderate mesh.\n    - Test $3$: $(N_x,N_y)=(12,12)$, representing a finer mesh approaching the continuum regime.\n- For each test, use Rayleigh quotient iteration with a deterministic initialization. You must ensure the algorithm converges to the first eigenpair, for example by a principled warm start based on the inverse iteration with a sub-extremal shift derived from the definitions.\n- For each test, output the approximation of the first Dirichlet eigenvalue, computed as the Rayleigh quotient of the converged eigenvector with respect to the assembled matrices. There are no physical units in this mathematical setting.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list of real numbers rounded to exactly $6$ decimal places, enclosed in square brackets (e.g., $[19.500000,19.739208,19.739209]$). The three numbers must be ordered according to Tests $1$–$3$.\n\nConstraints and clarifications:\n- Angles are not involved, so no angle units are required.\n- You must not read any input. All parameters are fixed as specified above.\n- The implementation must adhere to the logic of the Rayleigh quotient and its role in eigenvalue problems derived from symmetric bilinear forms on a Riemannian domain.", "solution": "The posed problem is valid. All components are self-contained, scientifically grounded in the theory of partial differential equations and numerical analysis, and stated with objective, mathematical precision. It represents a standard, albeit non-trivial, exercise in computational mathematics.\n\n**1. Problem Validation**\n\n*   **Givens Extraction**:\n    *   **Domain**: Unit square $\\Omega = [0,1] \\times [0,1]$.\n    *   **Operator**: Laplace–Beltrami, reducing to the standard Laplacian $-\\nabla^2$.\n    *   **Boundary Conditions**: Homogeneous Dirichlet ($u=0$ on $\\partial\\Omega$).\n    *   **Variational Principle**: The first eigenvalue $\\lambda_1$ is the minimum of the Rayleigh quotient $R(u) = \\int_\\Omega |\\nabla u|^2 dV / \\int_\\Omega u^2 dV$ over admissible functions $u$.\n    *   **Discretization**: Piecewise linear Finite Element Method (FEM) on a triangulated grid.\n    *   **Mesh**: A uniform $N_x \\times N_y$ grid of rectangles, each split into two triangles by a consistent diagonal.\n    *   **Algebraic Problem**: A generalized symmetric eigenvalue problem $A\\mathbf{u} = \\lambda M\\mathbf{u}$ derived from the FEM discretization, where $A$ is the stiffness matrix and $M$ is the mass matrix.\n    *   **Boundary Implementation**: Restriction to interior nodes of the finite element mesh.\n    *   **Solver**: Rayleigh Quotient Iteration (RQI), implemented from first principles.\n    *   **Special Case**: For a single interior degree of freedom, the Rayleigh quotient is to be computed directly.\n    *   **Test Cases**: $(N_x, N_y) = \\{(2,2), (6,6), (12,12)\\}$.\n    *   **Output**: A list of the computed first eigenvalues for the three test cases, rounded to 6 decimal places.\n\n*   **Validation Verdict**: The problem is well-posed, scientifically sound, and objective. It does not violate any of the invalidity criteria. The formulation is a classic application of FEM to elliptic eigenvalue problems. The request to implement from first principles and handle specific numerical and boundary cases is a rigorous test of understanding. We may proceed.\n\n**2. Solution Derivation**\n\n**Principle-Based Design**\nThe core principle is the translation of the continuous variational problem into a finite-dimensional algebraic one. The function space of admissible functions is approximated by a space of piecewise linear functions defined over a triangulation of the domain $\\Omega$.\n\n**I. Finite Element Discretization**\nThe domain $\\Omega = [0,1]\\times[0,1]$ is partitioned into an $N_x \\times N_y$ grid of rectangles. Each rectangle is then subdivided by a consistent diagonal (e.g., from bottom-left to top-right, or, as implemented, top-left to bottom-right) into two right-triangular elements. This yields a total of $2 N_x N_y$ triangles.\n\nOn this mesh, we define a basis of piecewise linear \"hat\" functions, $\\phi_k(x,y)$, where each $\\phi_k$ is equal to $1$ at node $k$ and $0$ at all other nodes. An arbitrary function $u(x,y)$ in our finite-dimensional space is then a linear combination $u(x,y) = \\sum_k u_k \\phi_k(x,y)$, where $u_k$ are the nodal values.\n\nSubstituting this expansion into the Rayleigh quotient gives:\n$$\nR(u) = \\frac{\\int_\\Omega |\\nabla (\\sum_k u_k \\phi_k)|^2 dA}{\\int_\\Omega (\\sum_k u_k \\phi_k)^2 dA} = \\frac{\\sum_{i,j} u_i u_j \\int_\\Omega \\nabla\\phi_i \\cdot \\nabla\\phi_j dA}{\\sum_{i,j} u_i u_j \\int_\\Omega \\phi_i \\phi_j dA} = \\frac{\\mathbf{u}^T A \\mathbf{u}}{\\mathbf{u}^T M \\mathbf{u}}\n$$\nwhere $\\mathbf{u}$ is the vector of nodal coefficients $[u_k]$, and the matrices $A$ (Stiffness) and $M$ (Mass) have entries:\n*   $A_{ij} = \\int_\\Omega \\nabla\\phi_i \\cdot \\nabla\\phi_j \\, dA$ (from the Dirichlet energy bilinear form).\n*   $M_{ij} = \\int_\\Omega \\phi_i \\phi_j \\, dA$ (from the $L^2$ inner product bilinear form).\n\nThese global matrices are assembled by summing the contributions from local element matrices, $A^e$ and $M^e$, calculated for each triangle. For a triangle $T$ with vertices $p_1, p_2, p_3$, the local stiffness matrix entries are given by $A^e_{ij} = ( \\nabla\\phi_i \\cdot \\nabla\\phi_j ) \\cdot \\text{Area}(T)$. Using barycentric coordinates, this can be computed with the formula $A^e_{ij} = \\frac{1}{4\\cdot \\text{Area}(T)} (b_i b_j + c_i c_j)$, where $b_i$ and $c_i$ depend on the vertex coordinates. The local mass matrix for linear elements has the standard form $M^e = \\frac{\\text{Area}(T)}{12} \\begin{pmatrix} 2&1&1\\\\1&2&1\\\\1&1&2 \\end{pmatrix}$.\n\n**II. Boundary Conditions**\nThe homogeneous Dirichlet condition ($u=0$ on $\\partial\\Omega$) is enforced by eliminating the rows and columns of $A$ and $M$ that correspond to nodes on the boundary. This reduces the system to the $(N_x-1)(N_y-1)$ interior nodes.\n\n**III. The Degenerate Case: $(N_x, N_y) = (2,2)$**\nFor $N_x=2, N_y=2$, there is exactly $(2-1)(2-1)=1$ interior node. The reduced system is $1 \\times 1$: $A_{red} u_1 = \\lambda M_{red} u_1$. By the variational characterization, the Rayleigh quotient is minimized by the first eigenfunction. In a one-dimensional trial space, the quotient is exact for the single basis function. The eigenvalue is therefore given directly by the ratio $\\lambda_1 = A_{red}[0,0] / M_{red}[0,0]$.\n\n**IV. Rayleigh Quotient Iteration (RQI)**\nFor the general case, we must find the smallest eigenvalue $\\lambda_1$ of the reduced system $A_{red}\\mathbf{u} = \\lambda M_{red}\\mathbf{u}$. RQI is a highly efficient iterative method for this purpose. Given an approximation $x_k$ to an eigenvector, the algorithm proceeds as follows:\n1.  **Compute the Rayleigh Quotient:** $\\rho_k = (x_k^T A_{red} x_k) / (x_k^T M_{red} x_k)$.\n2.  **Solve a Shifted System:** Solve $(A_{red} - \\rho_k M_{red}) y_{k+1} = M_{red} x_k$ for $y_{k+1}$.\n3.  **Normalize:** Update the eigenvector approximation $x_{k+1} = y_{k+1} / \\sqrt{y_{k+1}^T M_{red} y_{k+1}}$. The normalization is performed using the inner product induced by the mass matrix $M_{red}$.\n\nTo ensure convergence to the first (smallest) eigenvalue, a suitable starting vector $x_0$ is required. A vector of all ones, $x_0 = [1, 1, \\dots, 1]^T$, serves as a deterministic and principled \"warm start.\" This vector lacks internal sign changes, resembling the shape of the first eigenfunction, thus biasing convergence toward the desired ground state.\n\nThe matrix $(A_{red} - \\rho_k M_{red})$ becomes singular as $\\rho_k$ approaches an eigenvalue. This is the source of RQI's cubic convergence but also a numerical challenge. The implementation handles this by wrapping the linear solve in a `try-except` block. If a `LinAlgError` is raised, it signals that the shift is an excellent approximation of the eigenvalue, and the iteration is terminated.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve as linalg_solve, LinAlgError\n\ndef solve():\n    \"\"\"\n    Main entry point for solving the problem. It iterates through the specified\n    test cases, computes the first eigenvalue for each, and prints the\n    formatted results.\n    \"\"\"\n    test_cases = [\n        (2, 2),    # Test 1: Degenerate case with 1 interior node.\n        (6, 6),    # Test 2: A moderate mesh.\n        (12, 12),  # Test 3: A finer mesh, approaching the continuum.\n    ]\n\n    results = []\n    for nx, ny in test_cases:\n        result = _calculate_first_eigenvalue(nx, ny)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef _calculate_first_eigenvalue(Nx, Ny):\n    \"\"\"\n    Calculates the first Dirichlet eigenvalue for the Laplacian on a unit square\n    using the Finite Element Method with piecewise linear elements and\n    Rayleigh Quotient Iteration for the resulting generalized eigenproblem.\n\n    Args:\n        Nx (int): Number of subdivisions along the x-axis.\n        Ny (int): Number of subdivisions along the y-axis.\n\n    Returns:\n        float: The computed approximation of the first eigenvalue.\n    \"\"\"\n    hx = 1.0 / Nx\n    hy = 1.0 / Ny\n    \n    num_total_nodes = (Nx + 1) * (Ny + 1)\n    num_interior_nodes = (Nx - 1) * (Ny - 1)\n\n    # 1. Mesh Generation and Node Mapping\n    # Create a mapping from an interior node index (0 to num_interior_nodes-1)\n    # to its global node index.\n    interior_to_global = np.zeros(num_interior_nodes, dtype=int)\n    interior_idx = 0\n    for i in range(1, Nx):\n        for j in range(1, Ny):\n            # Global node index from (i, j) grid coordinates\n            g_idx = i * (Ny + 1) + j\n            interior_to_global[interior_idx] = g_idx\n            interior_idx += 1\n\n    # 2. Matrix Assembly\n    A = np.zeros((num_total_nodes, num_total_nodes))\n    M = np.zeros((num_total_nodes, num_total_nodes))\n\n    # Iterate over each rectangle in the grid to assemble element contributions.\n    for i_rect in range(Nx):\n        for j_rect in range(Ny):\n            # Coordinates of the four vertices of the rectangle.\n            p1_coords = (i_rect * hx, j_rect * hy)\n            p2_coords = ((i_rect + 1) * hx, j_rect * hy)\n            p3_coords = (i_rect * hx, (j_rect + 1) * hy)\n            p4_coords = ((i_rect + 1) * hx, (j_rect + 1) * hy)\n\n            # Global indices of the four rectangle vertices.\n            n1_idx = i_rect * (Ny + 1) + j_rect\n            n2_idx = (i_rect + 1) * (Ny + 1) + j_rect\n            n3_idx = i_rect * (Ny + 1) + (j_rect + 1)\n            n4_idx = (i_rect + 1) * (Ny + 1) + (j_rect + 1)\n\n            # Split the rectangle with a consistent diagonal (\\) into two triangles.\n            # Triangle 1: vertices p1, p2, p3. Nodes n1, n2, n3.\n            tri1_verts = [p1_coords, p2_coords, p3_coords]\n            tri1_nodes = [n1_idx, n2_idx, n3_idx]\n            Ae1, Me1 = _get_element_matrices(tri1_verts)\n            _assemble_local(A, M, Ae1, Me1, tri1_nodes)\n            \n            # Triangle 2: vertices p2, p4, p3. Nodes n2, n4, n3.\n            tri2_verts = [p2_coords, p4_coords, p3_coords]\n            tri2_nodes = [n2_idx, n4_idx, n3_idx]\n            Ae2, Me2 = _get_element_matrices(tri2_verts)\n            _assemble_local(A, M, Ae2, Me2, tri2_nodes)\n\n    # 3. Apply Homogeneous Dirichlet Boundary Conditions\n    # Extract submatrices corresponding to interior nodes only.\n    A_red = A[np.ix_(interior_to_global, interior_to_global)]\n    M_red = M[np.ix_(interior_to_global, interior_to_global)]\n\n    # 4. Handle Special Case (1 interior degree of freedom)\n    if num_interior_nodes == 1:\n        # The Rayleigh quotient is exact in a one-dimensional trial space.\n        return A_red[0, 0] / M_red[0, 0]\n\n    # 5. Rayleigh Quotient Iteration\n    # Warm start with a vector of all ones, which approximates the first eigenfunction.\n    x = np.ones(num_interior_nodes)\n    # Normalize with respect to the inner product defined by the mass matrix M.\n    x = x / np.sqrt(x.T @ M_red @ x)\n    \n    rho = 0.0\n    max_iter = 30\n    tolerance = 1e-12\n\n    for _ in range(max_iter):\n        rho_new = (x.T @ A_red @ x) / (x.T @ M_red @ x)\n        \n        if abs(rho_new - rho) < tolerance:\n            rho = rho_new\n            break\n        rho = rho_new\n        \n        # Solve the shifted linear system: (A - rho*M)y = M*x\n        b = M_red @ x\n        S = A_red - rho * M_red\n        \n        try:\n            # If linalg_solve fails, rho is very close to an eigenvalue.\n            # This serves as a robust convergence check.\n            y = linalg_solve(S, b, assume_a='sym')\n        except LinAlgError:\n            break\n            \n        # Normalize the new vector with the M-norm.\n        m_norm_y = np.sqrt(y.T @ M_red @ y)\n        if m_norm_y < np.finfo(float).eps: # Avoid division by zero\n            break\n        x = y / m_norm_y\n\n    return rho\n\ndef _get_element_matrices(vertices):\n    \"\"\"Computes the local stiffness and mass matrices for a single P1 triangular element.\"\"\"\n    (x1, y1), (x2, y2), (x3, y3) = vertices\n    area = 0.5 * abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n\n    # Stiffness Matrix A^e_ij = integral(grad(phi_i) . grad(phi_j)) dA\n    b = np.array([y2 - y3, y3 - y1, y1 - y2])\n    c = np.array([x3 - x2, x1 - x3, x2 - x1])\n    Ae = (1 / (4 * area)) * (np.outer(b, b) + np.outer(c, c))\n\n    # Mass Matrix M^e_ij = integral(phi_i * phi_j) dA\n    Me = (area / 12.0) * np.array([[2, 1, 1],\n                                   [1, 2, 1],\n                                   [1, 1, 2]])\n    return Ae, Me\n\ndef _assemble_local(A_global, M_global, A_local, M_local, nodes):\n    \"\"\"Adds local element matrix contributions into the global matrices.\"\"\"\n    for i in range(3):\n        for j in range(3):\n            A_global[nodes[i], nodes[j]] += A_local[i, j]\n            M_global[nodes[i], nodes[j]] += M_local[i, j]\n\nsolve()\n```", "id": "3076310"}]}