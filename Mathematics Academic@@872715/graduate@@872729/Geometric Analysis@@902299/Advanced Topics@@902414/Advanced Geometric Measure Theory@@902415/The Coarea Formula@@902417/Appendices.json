{"hands_on_practices": [{"introduction": "The coarea formula provides a powerful generalization of the method of slicing, familiar from integral calculus. This first exercise builds a bridge from that intuitive foundation—often known as Cavalieri's principle—to the more rigorous framework of geometric measure theory. By computing the volume of a solid of revolution using level sets of the height function $g(x,y,z) = z$, you will see how the formula simplifies when the gradient magnitude $|\\nabla g|$ is constant, effectively recovering the classic slicing method. [@problem_id:1449845]", "problem": "Let a region $E$ in $\\mathbb{R}^3$ be defined by the set of points $(x,y,z)$ satisfying the inequalities $x^2+y^2 \\le z \\le 1$. Your task is to compute the 3-dimensional Lebesgue measure (i.e., the volume) of this region.\n\nYou must solve this problem by applying the coarea formula, using the level sets of the function $g(x,y,z) = z$. The coarea formula states that for a suitable function $g: \\mathbb{R}^n \\to \\mathbb{R}$ and a Lebesgue measurable set $E \\subset \\mathbb{R}^n$, the following holds for any non-negative measurable function $f$:\n$$ \\int_E f(x) \\, d\\mathcal{L}^n(x) = \\int_{\\mathbb{R}} \\left( \\int_{E \\cap g^{-1}(t)} \\frac{f(y)}{|\\nabla g(y)|} \\, d\\mathcal{H}^{n-1}(y) \\right) dt $$\nwhere $g^{-1}(t)$ is the level set of $g$ for the value $t$, $\\mathcal{L}^n$ is the $n$-dimensional Lebesgue measure, and $\\mathcal{H}^{n-1}$ is the $(n-1)$-dimensional Hausdorff measure (which corresponds to area for surfaces in $\\mathbb{R}^3$).\n\nExpress your final answer as an exact symbolic expression.", "solution": "We wish to compute the volume of the set $E=\\{(x,y,z)\\in\\mathbb{R}^{3}: x^{2}+y^{2}\\leq z\\leq 1\\}$ by the coarea formula using $g(x,y,z)=z$. Set $f\\equiv 1$ on $\\mathbb{R}^{3}$. The coarea formula in this case reads\n$$\n\\int_{E} 1 \\, d\\mathcal{L}^{3} = \\int_{\\mathbb{R}} \\left( \\int_{E \\cap g^{-1}(t)} \\frac{1}{|\\nabla g(y)|} \\, d\\mathcal{H}^{2}(y) \\right) dt.\n$$\nWe compute $|\\nabla g|=|\\nabla z|=1$. The level set $g^{-1}(t)$ is the plane $\\{(x,y,z): z=t\\}$. The slice $E\\cap g^{-1}(t)$ consists of those $(x,y,t)$ with $x^{2}+y^{2}\\leq t$ and $t\\leq 1$. Since $x^{2}+y^{2}\\geq 0$, this slice is nonempty only when $t\\geq 0$. Combining with $t\\leq 1$, the outer integral reduces to $t\\in[0,1]$.\n\nOn the plane $z=t$, the $(n-1)$-dimensional Hausdorff measure $\\mathcal{H}^{2}$ agrees with the usual $2$-dimensional Lebesgue measure in that plane, so\n$$\n\\int_{E \\cap g^{-1}(t)} \\frac{1}{|\\nabla g|} \\, d\\mathcal{H}^{2}\n= \\int_{\\{(x,y): x^{2}+y^{2}\\leq t\\}} 1 \\, dA\n= \\text{area of the disk of radius } \\sqrt{t}\n= \\pi t,\n$$\nfor $t\\in[0,1]$, and it is $0$ otherwise. Therefore,\n$$\n\\int_{E} 1 \\, d\\mathcal{L}^{3} = \\int_{0}^{1} \\pi t \\, dt = \\pi \\int_{0}^{1} t \\, dt = \\pi \\left[\\frac{t^{2}}{2}\\right]_{0}^{1} = \\frac{\\pi}{2}.\n$$\nThus the volume of $E$ is $\\frac{\\pi}{2}$.", "answer": "$$\\boxed{\\frac{\\pi}{2}}$$", "id": "1449845"}, {"introduction": "We now advance to cases where the Jacobian factor, $|\\nabla g|$, is not constant, revealing the coarea formula's true utility. This problem is specifically constructed so that the integrand is precisely $|\\nabla g|$, transforming a seemingly complex double integral into a calculation of the lengths of level sets. It requires a careful analysis of how the geometry of these level sets changes across critical points of the function, providing crucial practice in handling more intricate applications of the formula. [@problem_id:1449839]", "problem": "Consider the two-dimensional domain $D = [-2, 2] \\times [-2, 2]$. Let a function $g: D \\to \\mathbb{R}$ be defined by $g(x, y) = x^3 - 3x$.\n\nYour task is to compute the value of the integral\n$$I = \\int_D |3x^2 - 3| \\, dx \\, dy$$\nby applying the coarea formula with the level sets of the function $g(x,y)$.\n\nProvide the exact numerical value of the integral $I$.", "solution": "We are given $D=[-2,2]\\times[-2,2]$ and $g(x,y)=x^{3}-3x$. The integrand satisfies\n$$\n|3x^{2}-3|=\\left|\\frac{\\partial g}{\\partial x}\\right|=|\\nabla g(x,y)|,\n$$\nsince $\\frac{\\partial g}{\\partial y}=0$. By the coarea formula in two dimensions,\n$$\n\\int_{D}|\\nabla g|\\,dx\\,dy=\\int_{\\mathbb{R}}\\mathcal{H}^{1}\\!\\left(D\\cap g^{-1}(t)\\right)\\,dt,\n$$\nwhere $\\mathcal{H}^{1}$ denotes one-dimensional Hausdorff measure (length).\n\nWe therefore compute the length of the level sets $D\\cap g^{-1}(t)$ for $t\\in\\mathbb{R}$. Because $g$ depends only on $x$, the level set $g(x,y)=t$ within $D$ consists of vertical segments at those $x\\in[-2,2]$ solving\n$$\nx^{3}-3x=t,\n$$\nwith $y\\in[-2,2]$. Let $h(x)=x^{3}-3x$. On $[-2,2]$, $h' (x)=3x^{2}-3$, so $h$ is strictly increasing on $[-2,-1]$, strictly decreasing on $[-1,1]$, and strictly increasing on $[1,2]$. The endpoint values are\n$$\nh(-2)=-2,\\quad h(-1)=2,\\quad h(1)=-2,\\quad h(2)=2,\n$$\nso the range of $h$ on $[-2,2]$ is $[-2,2]$.\n\nHence:\n- For $t\\in(-2,2)$, the equation $x^{3}-3x=t$ has exactly three distinct solutions in $[-2,2]$, one in each of the intervals $[-2,-1]$, $[-1,1]$, and $[1,2]$. Therefore, $D\\cap g^{-1}(t)$ is the union of three vertical segments, each of length $4$ (since $y\\in[-2,2]$), so\n$$\n\\mathcal{H}^{1}\\!\\left(D\\cap g^{-1}(t)\\right)=3\\times 4=12.\n$$\n- For $t=\\pm 2$, there are two distinct $x$ values in $[-2,2]$ (with one double root), producing two vertical segments of length $4$, hence $\\mathcal{H}^{1}=8$. These isolated values do not affect the integral.\n- For $t\\notin[-2,2]$, there are no solutions in $[-2,2]$, so the length is $0$.\n\nTherefore, by the coarea formula,\n$$\nI=\\int_{D}|3x^{2}-3|\\,dx\\,dy=\\int_{\\mathbb{R}}\\mathcal{H}^{1}\\!\\left(D\\cap g^{-1}(t)\\right)\\,dt=\\int_{-2}^{2}12\\,dt=12\\cdot 4=48.\n$$", "answer": "$$\\boxed{48}$$", "id": "1449839"}, {"introduction": "The full power of the coarea formula is realized in its natural setting of Lipschitz functions, which need not be smooth. This advanced practice explores this setting using the canonical example of the distance function $f(x) = \\|x\\|$, which is Lipschitz but famously not differentiable at the origin. By working in general dimension $n$, this exercise demonstrates how the formula rigorously connects the integration of $|\\nabla f|$ to the measure of the underlying domain, reinforcing its deep geometric meaning and its application to functions that are differentiable only almost everywhere. [@problem_id:3034561]", "problem": "Let $n \\geq 2$ and let $R>0$. Consider the function $f:\\mathbb{R}^{n}\\to\\mathbb{R}$ defined by $f(x)=\\|x\\|$, where $\\|\\cdot\\|$ denotes the Euclidean norm. \n\n(a) Verify that $f$ is Lipschitz but not of class $C^{1}$, and explain why the gradient $\\nabla f$ exists almost everywhere (a.e.) in $\\mathbb{R}^{n}$. Identify $\\nabla f(x)$ explicitly for $x\\neq 0$, and determine $|\\nabla f(x)|$ for $x\\neq 0$.\n\n(b) Describe, at a conceptual level and without quoting any pre-stated formula, how slicing $\\mathbb{R}^{n}$ into level sets of $f$ introduces a weighting by $|\\nabla f|$ when one rewrites an $n$-dimensional integral as an integral over the family of level sets $\\{f=t\\}$ endowed with the $(n-1)$-dimensional Hausdorff measure $\\mathcal{H}^{n-1}$. Your explanation should justify why the density $|\\nabla f|$ naturally appears, even though $f$ fails to be of class $C^{1}$ at a set of measure zero.\n\n(c) Using the perspective from part (b), evaluate the integral\n$$\nJ(R,n)\\;=\\;\\int_{B_{R}(0)} |\\nabla f(x)|\\,\\mathrm{d}x,\n$$\nwhere $B_{R}(0)=\\{x\\in\\mathbb{R}^{n}:\\|x\\|\\le R\\}$. Express your final answer in a closed form in terms of $n$, $R$, $\\pi$, and the Gamma function $\\Gamma(\\cdot)$. Your final answer must be a single analytic expression. Do not provide any numerical approximation.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard problem in geometric measure theory and multivariable analysis. All terms are well-defined, and the premises are factually correct. We may proceed with a full solution.\n\n(a) We analyze the function $f(x) = \\|x\\|$ for $x \\in \\mathbb{R}^n$, where $n \\geq 2$.\n\nFirst, we verify that $f$ is Lipschitz continuous. For any $x, y \\in \\mathbb{R}^n$, the reverse triangle inequality for the Euclidean norm states that $|\\|x\\| - \\|y\\|| \\le \\|x-y\\|$. In terms of our function $f$, this is $|f(x) - f(y)| \\le 1 \\cdot \\|x-y\\|$. This is the definition of Lipschitz continuity with a Lipschitz constant $L=1$.\n\nNext, we show that $f$ is not of class $C^1(\\mathbb{R}^n)$. A function is of class $C^1$ if it is differentiable everywhere and its derivative is continuous. We will show that $f$ is not differentiable at $x=0$. The derivative of $f$ at a point $x_0$, if it exists, is a linear map $Df(x_0)$ such that $\\lim_{h\\to 0} \\frac{\\|f(x_0+h) - f(x_0) - Df(x_0)(h)\\|}{\\|h\\|} = 0$. At $x_0=0$, we have $f(0)=0$. If the derivative existed, it would have to be the zero map, since the directional derivative in any direction $v$ would be $\\lim_{t\\to 0} \\frac{\\|tv\\| - 0}{t} = \\|v\\|\\lim_{t\\to 0} \\frac{|t|}{t}$, which does not exist. More formally, consider the path $h_t = tv$ for a unit vector $v \\in \\mathbb{R}^n$.\nThe directional derivative at $0$ in the direction $v$ is:\n$$\n\\lim_{t \\to 0^+} \\frac{f(0+tv)-f(0)}{t} = \\lim_{t \\to 0^+} \\frac{\\|tv\\|}{t} = \\lim_{t \\to 0^+} \\frac{t\\|v\\|}{t} = \\|v\\|=1.\n$$\nHowever, approaching from the negative side:\n$$\n\\lim_{t \\to 0^-} \\frac{f(0+tv)-f(0)}{t} = \\lim_{t \\to 0^-} \\frac{\\|tv\\|}{t} = \\lim_{t \\to 0^-} \\frac{|t|\\|v\\|}{t} = \\lim_{t \\to 0^-} \\frac{-t\\|v\\|}{t} = -\\|v\\|=-1.\n$$\nSince the directional derivatives depend on the direction of approach (and even for a fixed direction, the limit from left and right differ), the function is not differentiable at $x=0$. Since it is not differentiable at a point, it cannot be of class $C^1(\\mathbb{R}^n)$.\n\nThe gradient $\\nabla f$ exists almost everywhere (a.e.) due to Rademacher's theorem, which states that any Lipschitz function from $\\mathbb{R}^n$ to $\\mathbb{R}^m$ is differentiable almost everywhere with respect to the Lebesgue measure. As we have shown $f$ is Lipschitz, it is differentiable a.e. The only point of non-differentiability is $x=0$, which is a set of Lebesgue measure zero in $\\mathbb{R}^n$ for $n \\ge 1$.\n\nFor any $x \\neq 0$, the function $f(x) = (\\sum_{i=1}^n x_i^2)^{1/2}$ is a composition of smooth functions, so we can compute its gradient using the chain rule. The partial derivative with respect to $x_j$ is:\n$$\n\\frac{\\partial f}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left(\\sum_{i=1}^n x_i^2\\right)^{1/2} = \\frac{1}{2} \\left(\\sum_{i=1}^n x_i^2\\right)^{-1/2} (2x_j) = \\frac{x_j}{\\left(\\sum_{i=1}^n x_i^2\\right)^{1/2}} = \\frac{x_j}{\\|x\\|}.\n$$\nThe gradient vector $\\nabla f(x)$ is therefore:\n$$\n\\nabla f(x) = \\left( \\frac{x_1}{\\|x\\|}, \\frac{x_2}{\\|x\\|}, \\dots, \\frac{x_n}{\\|x\\|} \\right) = \\frac{x}{\\|x\\|}.\n$$\nThis is the unit vector in the direction of $x$.\n\nThe magnitude of the gradient for $x \\neq 0$ is the norm of this vector:\n$$\n|\\nabla f(x)| = \\left\\| \\frac{x}{\\|x\\|} \\right\\| = \\frac{1}{\\|x\\|} \\|x\\| = 1.\n$$\n\n(b) The coarea formula provides a way to disintegrate an integral over an $n$-dimensional domain into an iterated integral, where one integrates first over the $(n-1)$-dimensional level sets of a function and then integrates the results over the values of the function. For a function $f:\\mathbb{R}^n \\to \\mathbb{R}$, its level sets are the surfaces $\\{x \\in \\mathbb{R}^n | f(x) = t\\}$ for constants $t$.\n\nConceptually, the appearance of the density $|\\nabla f|$ arises from the geometric change of variables. Consider a small volume element $d\\mathcal{L}^n(x)$ in $\\mathbb{R}^n$. We wish to express this volume element in a coordinate system adapted to the level sets of $f$. This new system can be thought of as having one coordinate representing the level set value, $t=f(x)$, and $n-1$ coordinates parametrizing the position on that level set. The volume element can be locally decomposed into the product of a surface area element $d\\mathcal{H}^{n-1}$ on the level set and an infinitesimal thickness $dh$ perpendicular to the level set. So, $d\\mathcal{L}^n(x) \\approx d\\mathcal{H}^{n-1} \\cdot dh$.\n\nThe thickness $dh$ is the perpendicular distance one must travel to get from the level set $\\{f=t\\}$ to $\\{f=t+dt\\}$. The gradient $\\nabla f(x)$ points in the direction of the fastest increase of $f$, which is perpendicular to the level set at $x$. The magnitude of the gradient, $|\\nabla f(x)|$, represents this rate of increase. By first-order approximation, the change in $f$, $df$, is related to the displacement $dh$ in the normal direction by $df \\approx |\\nabla f(x)| dh$. For an infinitesimal change $dt$, the required normal displacement is $dh \\approx \\frac{dt}{|\\nabla f(x)|}$.\n\nSubstituting this back into the volume decomposition, we get $d\\mathcal{L}^n(x) \\approx d\\mathcal{H}^{n-1} \\frac{dt}{|\\nabla f(x)|}$. This leads to the coarea formula in one of its forms:\n$$\n\\int_{\\mathbb{R}^n} g(x) \\,d\\mathcal{L}^n(x) = \\int_{-\\infty}^{\\infty} \\left( \\int_{f^{-1}(t)} \\frac{g(x)}{|\\nabla f(x)|} \\,d\\mathcal{H}^{n-1}(x) \\right) dt.\n$$\nThe problem statement refers to a weighting by $|\\nabla f|$ when rewriting an $n$-dimensional integral. This points to the more common statement of the coarea formula:\n$$\n\\int_{\\mathbb{R}^n} g(x) |\\nabla f(x)| \\,d\\mathcal{L}^n(x) = \\int_{-\\infty}^{\\infty} \\left( \\int_{f^{-1}(t)} g(x) \\,d\\mathcal{H}^{n-1}(x) \\right) dt.\n$$\nThis form arises directly from the previous one by moving $|\\nabla f(x)|$ to the left side. The factor $|\\nabla f(x)|$ is the Jacobian factor that accounts for the geometric distortion when changing from Cartesian coordinates to level set coordinates. It measures how \"densely packed\" the level surfaces are; where $|\\nabla f|$ is large, the level surfaces are close together, and a smaller volume in space corresponds to a given range of $t$-values.\n\nThe fact that $f(x)=\\|x\\|$ is not $C^1$ at $x=0$ does not invalidate this reasoning. The coarea formula holds for Lipschitz functions like $f$. The derivative $\\nabla f$ exists almost everywhere, and the set $\\{0\\}$ where it is undefined is a set of Lebesgue measure zero. Integrals over sets of measure zero are zero, so such points do not contribute to the value of the integral on the left-hand side. The geometric argument holds for almost every point in the domain.\n\n(c) We are asked to evaluate the integral $J(R,n) = \\int_{B_R(0)} |\\nabla f(x)|\\,d\\mathcal{L}^n(x)$, where $f(x)=\\|x\\|$ and $B_R(0)=\\{x\\in\\mathbb{R}^{n}:\\|x\\|\\le R\\}$.\n\nWe apply the coarea formula:\n$$\n\\int_{\\Omega} g(x) |\\nabla f(x)| \\,d\\mathcal{L}^n(x) = \\int_{-\\infty}^{\\infty} \\left( \\int_{f^{-1}(t) \\cap \\Omega} g(x) \\,d\\mathcal{H}^{n-1}(x) \\right) dt.\n$$\nIn our specific case, the domain is $\\Omega=B_R(0)$, the function is $f(x)=\\|x\\|$, and we take the integrand function to be $g(x)=1$. The integral becomes:\n$$\nJ(R,n) = \\int_{B_R(0)} 1 \\cdot |\\nabla \\|x\\|| \\,d\\mathcal{L}^n(x).\n$$\nThe range of values for $f(x)=\\|x\\|$ over the domain $B_R(0)$ is $[0, R]$. Thus, the outer integral over $t$ will be from $0$ to $R$. For any $t \\in [0, R]$, the level set is $f^{-1}(t)=\\{x \\in \\mathbb{R}^n : \\|x\\|=t\\}$, which is the $(n-1)$-dimensional sphere of radius $t$, denoted $S_t^{n-1}$. The intersection with the domain is $f^{-1}(t) \\cap B_R(0) = S_t^{n-1}$ for $t \\in (0, R]$ and $\\{0\\}$ for $t=0$.\n\nApplying the formula:\n$$\nJ(R,n) = \\int_{0}^{R} \\left( \\int_{S_t^{n-1}} 1 \\,d\\mathcal{H}^{n-1}(x) \\right) dt.\n$$\nThe inner integral is the $(n-1)$-dimensional Hausdorff measure (i.e., the surface area) of the sphere $S_t^{n-1}$. The surface area of an $(n-1)$-dimensional sphere of radius $r$ is given by the formula $A_{n-1}(r) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}r^{n-1}$.\nFor our sphere $S_t^{n-1}$, the radius is $t$, so its surface area is:\n$$\n\\mathcal{H}^{n-1}(S_t^{n-1}) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}t^{n-1}.\n$$\nSubstituting this into the outer integral, we get:\n$$\nJ(R,n) = \\int_{0}^{R} \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}t^{n-1} dt.\n$$\nThe constant factor can be taken outside the integral:\n$$\nJ(R,n) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)} \\int_{0}^{R} t^{n-1} dt.\n$$\nWe evaluate the elementary integral:\n$$\n\\int_{0}^{R} t^{n-1} dt = \\left[ \\frac{t^n}{n} \\right]_0^R = \\frac{R^n}{n} - 0 = \\frac{R^n}{n}.\n$$\nFinally, we obtain the expression for $J(R,n)$:\n$$\nJ(R,n) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)} \\cdot \\frac{R^n}{n} = \\frac{2\\pi^{n/2}R^n}{n\\Gamma(n/2)}.\n$$\nThis result is consistent. From part (a), we know $|\\nabla f(x)|=1$ for almost every $x$. Thus, the integral $J(R,n)$ should be equal to the Lebesgue measure of the domain of integration, $B_R(0)$.\n$$\nJ(R,n) = \\int_{B_R(0)} 1 \\,d\\mathcal{L}^n(x) = \\mathcal{L}^n(B_R(0)).\n$$\nThe expression we derived, $\\frac{2\\pi^{n/2}R^n}{n\\Gamma(n/2)}$, is indeed the well-known formula for the volume of an $n$-dimensional ball of radius $R$. This can be seen by using the identity $\\Gamma(z+1)=z\\Gamma(z)$, which gives $n\\Gamma(n/2) = 2 \\cdot \\frac{n}{2}\\Gamma(\\frac{n}{2}) = 2\\Gamma(\\frac{n}{2}+1)$.\nSo, $J(R,n) = \\frac{2\\pi^{n/2}R^n}{2\\Gamma(n/2+1)} = \\frac{\\pi^{n/2}R^n}{\\Gamma(n/2+1)}$, which is the standard representation of the volume of the $n$-ball.", "answer": "$$\n\\boxed{\\frac{2\\pi^{n/2}R^n}{n\\Gamma(\\frac{n}{2})}}\n$$", "id": "3034561"}]}