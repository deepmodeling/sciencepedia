{"hands_on_practices": [{"introduction": "To build a solid foundation in $p$-adic analysis, one must begin with direct, hands-on computation. This first practice invites you to compute values of the $p$-adic logarithm and exponential functions directly from their defining power series. By working through the calculation of $\\log_5(1+5)$ and $\\exp_5(10)$ to a specified precision [@problem_id:3020586], you will develop the crucial skill of using $p$-adic valuations to determine how many terms of a series are necessary for a desired accuracy. This exercise grounds the abstract theory in concrete arithmetic, reinforcing your understanding of convergence in the $p$-adic metric.", "problem": "Let $p=5$ and work in the field of $5$-adic numbers $\\mathbb{Q}_5$ with the $5$-adic valuation $v_5$ and absolute value $|\\cdot|_5$ defined by $v_5(5)=1$, $v_5(ab)=v_5(a)+v_5(b)$, $v_5(a+b)\\ge \\min\\{v_5(a),v_5(b)\\}$, and $|x|_5=5^{-v_5(x)}$. The $5$-adic logarithm and $5$-adic exponential are defined on their standard domains by the series\n$$\\log_5(1+x)=\\sum_{n\\ge 1}\\frac{(-1)^{n+1}x^n}{n}\\quad\\text{for}\\quad v_5(x)\\ge 1,$$\n$$\\exp_5(x)=\\sum_{n\\ge 0}\\frac{x^n}{n!}\\quad\\text{for}\\quad v_5(x)\\frac{1}{4}.$$\nUsing only these defining series and valuation-based convergence/truncation arguments from first principles, compute the values of $\\log_5(1+5)$ and $\\exp_5(10)$ to $5^4$-adic precision. Concretely, determine their unique representatives modulo $5^4$ in the set $\\{0,1,\\dots,5^4-1\\}$, justifying rigorously which terms of each series contribute to the value modulo $5^4$ by estimating their $5$-adic valuations.\n\nReport your final result as the ordered pair $\\big(\\log_5(1+5)\\bmod 5^4,\\;\\exp_5(10)\\bmod 5^4\\big)$ using the canonical representatives in $\\{0,1,\\dots,624\\}$. No rounding is required.", "solution": "The user wants me to validate the problem statement and, if it is valid, solve it.\n\n### Step 1: Extract Givens\n-   Field: $5$-adic numbers, $\\mathbb{Q}_5$.\n-   Prime: $p=5$.\n-   Valuation: $v_5$, with $v_5(5)=1$, $v_5(ab)=v_5(a)+v_5(b)$, and the non-Archimedean triangle inequality $v_5(a+b)\\ge \\min\\{v_5(a),v_5(b)\\}$.\n-   Absolute value: $|x|_5=5^{-v_5(x)}$.\n-   $5$-adic logarithm definition: $\\log_5(1+x)=\\sum_{n\\ge 1}\\frac{(-1)^{n+1}x^n}{n}$ for $v_5(x)\\ge 1$.\n-   $5$-adic exponential definition: $\\exp_5(x)=\\sum_{n\\ge 0}\\frac{x^n}{n!}$ for $v_5(x)\\frac{1}{4}$.\n-   Task: Compute $\\log_5(1+5)$ and $\\exp_5(10)$ to $5^4$-adic precision.\n-   Output format: The unique integer representatives in the set $\\{0,1,\\dots,624\\}$ for the two values, reported as an ordered pair.\n-   Constraint: Use only the defining series and valuation-based arguments from first principles.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is set in the standard mathematical framework of $p$-adic analysis. The definitions of the $5$-adic valuation, absolute value, logarithm, and exponential series, along with their specified domains of convergence ($v_5(x) \\ge 1$ for $\\log_5$ and $v_5(x)  \\frac{1}{p-1} = \\frac{1}{4}$ for $\\exp_5$), are all standard and correct.\n2.  **Well-Posed:** The problem asks to compute two values modulo $5^4$. Since both series converge for the given arguments, their sums are well-defined elements of $\\mathbb{Q}_5$. The task of finding an integer representative modulo $5^4$ is equivalent to finding the first four \"digits\" of the $5$-adic expansion, which is a well-defined procedure. The required output format is unambiguous.\n3.  **Objective:** The problem is stated using precise mathematical language with no subjective or ambiguous terms.\n4.  **Completeness:** The problem provides all necessary definitions and data to perform the computation.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined computational problem in number theory. I will proceed with the solution.\n\nThe task is to find integers $A$ and $B$ in $\\{0, 1, \\dots, 624\\}$ such that $\\log_5(1+5) \\equiv A \\pmod{5^4}$ and $\\exp_5(10) \\equiv B \\pmod{5^4}$. This is equivalent to requiring $v_5(\\log_5(1+5) - A) \\ge 4$ and $v_5(\\exp_5(10) - B) \\ge 4$.\n\n**Part 1: Computation of $\\log_5(1+5) \\pmod{5^4}$**\n\nThe value to compute is $\\log_5(1+5)$. The argument of the logarithm is $x=5$. Its $5$-adic valuation is $v_5(5)=1$, which satisfies the convergence condition $v_5(x)\\ge 1$. The series is:\n$$ \\log_5(1+5) = \\sum_{n=1}^\\infty \\frac{(-1)^{n+1} 5^n}{n} $$\nLet $T_n = \\frac{(-1)^{n+1} 5^n}{n}$ be the $n$-th term of the series. The $5$-adic valuation of this term is:\n$$ v_5(T_n) = v_5(5^n) - v_5(n) = n - v_5(n) $$\nWe need to determine how many terms of the series must be summed to achieve the desired precision. We will sum the terms $T_n$ up to an index $k$ such that the remainder, $R_k = \\sum_{n=k+1}^\\infty T_n$, has a valuation of at least $4$. By the non-Archimedean property, $v_5(R_k) \\ge \\min_{n \\ge k+1} \\{v_5(T_n)\\}$. Thus, we need to find $k$ such that for all $n \\ge k+1$, we have $v_5(T_n) = n - v_5(n) \\ge 4$.\n\nLet's compute the valuations for the first few terms:\n-   $n=1$: $v_5(T_1) = 1 - v_5(1) = 1-0 = 1$.\n-   $n=2$: $v_5(T_2) = 2 - v_5(2) = 2-0 = 2$.\n-   $n=3$: $v_5(T_3) = 3 - v_5(3) = 3-0 = 3$.\n-   $n=4$: $v_5(T_4) = 4 - v_5(4) = 4-0 = 4$.\n-   $n=5$: $v_5(T_5) = 5 - v_5(5) = 5-1 = 4$.\n\nFor $n \\ge 6$, let's establish that $v_5(T_n) = n - v_5(n) \\ge 5$:\n-   If $5 \\nmid n$, then $v_5(n) = 0$. For $n \\ge 6$, this implies $n - v_5(n) = n \\ge 6$.\n-   If $5 \\mid n$, let $n = 5^k m$ with $k \\ge 1$ and $5 \\nmid m$. Then $v_5(n) = k$. We analyze $n - k = 5^k m - k$. Since $n \\ge 6$, we must have $k \\ge 1$.\n    -   If $k=1$, $n=5m$ and $n \\ge 6$ implies $m \\ge 2$. Thus $n-v_5(n) = 5m-1 \\ge 5(2)-1 = 9 \\ge 5$.\n    -   If $k \\ge 2$, $m \\ge 1$. The function $f(k)=5^k-k$ is increasing for $k \\ge 1$. For $k=2$, $5^2-2 = 23 \\ge 5$. Thus $n-v_5(n) = 5^k m - k \\ge 5^k - k \\ge 23 \\ge 5$.\nIn all cases for $n \\ge 6$, we find $v_5(T_n) \\ge 5$. This means the remainder $R_5 = \\sum_{n=6}^\\infty T_n$ has valuation $v_5(R_5) \\ge \\min_{n \\ge 6} v_5(T_n) \\ge 5$.\nTherefore, $\\log_5(1+5) \\equiv \\sum_{n=1}^5 T_n \\pmod{5^5}$, which is more than the required precision. We compute this sum:\n$$ S_5 = \\sum_{n=1}^5 \\frac{(-1)^{n+1} 5^n}{n} = \\frac{5}{1} - \\frac{5^2}{2} + \\frac{5^3}{3} - \\frac{5^4}{4} + \\frac{5^5}{5} $$\n$$ S_5 = 5 - \\frac{25}{2} + \\frac{125}{3} - \\frac{625}{4} + 625 $$\nTo find the value modulo $5^4 = 625$, we compute this sum in $\\mathbb{Q}$ and then solve the congruence.\n$$ S_5 = \\frac{12 \\cdot 5 - 6 \\cdot 25 + 4 \\cdot 125 - 3 \\cdot 625 + 12 \\cdot 625}{12} = \\frac{60 - 150 + 500 - 1875 + 7500}{12} = \\frac{6035}{12} $$\nWe need to find an integer $A$ such that $A \\equiv \\frac{6035}{12} \\pmod{625}$. This is equivalent to solving the congruence $12A \\equiv 6035 \\pmod{625}$.\nFirst, $6035 = 9 \\times 625 + 410$, so $6035 \\equiv 410 \\pmod{625}$. The congruence becomes $12A \\equiv 410 \\pmod{625}$.\nWe need the inverse of $12$ modulo $625$. Using the extended Euclidean algorithm for $625$ and $12$:\n$625 = 52 \\times 12 + 1$. Thus $1 = 625 - 52 \\times 12$, which implies $12^{-1} \\equiv -52 \\equiv 573 \\pmod{625}$.\nNow we solve for $A$:\n$$ A \\equiv 410 \\times 12^{-1} \\equiv 410 \\times 573 \\pmod{625} $$\n$410 \\times 573 = 234930$. Dividing by $625$: $234930 = 375 \\times 625 + 555$.\nSo, $A \\equiv 555 \\pmod{625}$.\nThe first value is $555$.\n\n**Part 2: Computation of $\\exp_5(10) \\pmod{5^4}$**\n\nThe value to compute is $\\exp_5(10)$. The argument is $x=10$. Its $5$-adic valuation is $v_5(10) = v_5(2 \\cdot 5) = 1$. This satisfies the convergence condition $v_5(x)  \\frac{1}{4}$. The series is:\n$$ \\exp_5(10) = \\sum_{n=0}^\\infty \\frac{10^n}{n!} $$\nLet $U_n = \\frac{10^n}{n!}$ be the $n$-th term. Its $5$-adic valuation is:\n$$ v_5(U_n) = v_5(10^n) - v_5(n!) = n \\cdot v_5(10) - v_5(n!) = n - v_5(n!) $$\nWe use Legendre's formula for the valuation of the factorial: $v_5(n!) = \\sum_{k=1}^\\infty \\lfloor \\frac{n}{5^k} \\rfloor = \\frac{n - S_5(n)}{4}$, where $S_5(n)$ is the sum of the digits of $n$ in base $5$.\nSo, $v_5(U_n) = n - \\frac{n - S_5(n)}{4} = \\frac{3n + S_5(n)}{4}$.\nWe seek to truncate the series at an index $k$ such that for all $n \\ge k+1$, $v_5(U_n) \\ge 4$, which means $\\frac{3n + S_5(n)}{4} \\ge 4$, or $3n + S_5(n) \\ge 16$.\n\nLet's compute the valuations for the first few terms:\n-   $n=0$: $v_5(U_0) = 0 - 0 = 0$.\n-   $n=1$: $v_5(U_1) = 1 - 0 = 1$.\n-   $n=2$: $v_5(U_2) = 2 - 0 = 2$.\n-   $n=3$: $v_5(U_3) = 3 - 0 = 3$.\n-   $n=4$: $v_5(U_4) = 4 - 0 = 4$.\n-   $n=5$: $v_5(U_5) = 5 - v_5(5!) = 5 - 1 = 4$.\n\nFor $n \\ge 6$, let's establish that $v_5(U_n) \\ge 5$. This requires $3n + S_5(n) \\ge 20$.\n-   For $n=6 = 1 \\cdot 5^1 + 1 \\cdot 5^0$, $S_5(6) = 1+1=2$. $3(6)+2 = 20$. So $v_5(U_6) = 20/4 = 5$.\n-   For $n6$, the function $f(n)=3n+S_5(n)$ is strictly increasing. Thus, for all $n \\ge 6$, $3n+S_5(n) \\ge 20$, which implies $v_5(U_n) \\ge 5$.\nThe remainder $R_5' = \\sum_{n=6}^\\infty U_n$ has valuation $v_5(R_5') \\ge \\min_{n \\ge 6} v_5(U_n) = 5$.\nTherefore, $\\exp_5(10) \\equiv \\sum_{n=0}^5 U_n \\pmod{5^5}$. We compute this sum modulo $5^4=625$:\n$$ S_5' = \\sum_{n=0}^5 \\frac{10^n}{n!} = \\frac{10^0}{0!} + \\frac{10^1}{1!} + \\frac{10^2}{2!} + \\frac{10^3}{3!} + \\frac{10^4}{4!} + \\frac{10^5}{5!} $$\n$$ S_5' = 1 + 10 + \\frac{100}{2} + \\frac{1000}{6} + \\frac{10000}{24} + \\frac{100000}{120} $$\n$$ S_5' = 1 + 10 + 50 + \\frac{500}{3} + \\frac{1250}{3} + \\frac{2500}{3} = 61 + \\frac{500+1250+2500}{3} = 61 + \\frac{4250}{3} = \\frac{183+4250}{3} = \\frac{4433}{3} $$\nWe need to find an integer $B$ such that $B \\equiv \\frac{4433}{3} \\pmod{625}$. This is equivalent to solving $3B \\equiv 4433 \\pmod{625}$.\n$4433 = 7 \\times 625 + 58$, so $4433 \\equiv 58 \\pmod{625}$. The congruence becomes $3B \\equiv 58 \\pmod{625}$.\nWe need the inverse of $3$ modulo $625$. From the Euclidean algorithm for $625$ and $3$: $625 = 208 \\times 3 + 1$. Thus $1 = 625 - 208 \\times 3$, which implies $3^{-1} \\equiv -208 \\equiv 417 \\pmod{625}$.\nNow we solve for $B$:\n$$ B \\equiv 58 \\times 3^{-1} \\equiv 58 \\times 417 \\pmod{625} $$\n$58 \\times 417 = 24186$. Dividing by $625$: $24186 = 38 \\times 625 + 436$.\nSo, $B \\equiv 436 \\pmod{625}$.\nThe second value is $436$.\n\nThe ordered pair is $(\\log_5(1+5) \\bmod 5^4, \\exp_5(10) \\bmod 5^4) = (555, 436)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n555  436\n\\end{pmatrix}\n}\n$$", "id": "3020586"}, {"introduction": "Having practiced direct computation, we now move to exploring the profound structural properties that the $p$-adic logarithm and exponential functions provide. These functions establish a powerful isomorphism between the multiplicative group of $p$-adic units congruent to $1$ modulo $p$ (denoted $1+p\\mathbb{Z}_p$) and the additive group of $p$-adic integers divisible by $p$ (denoted $p\\mathbb{Z}_p$). This exercise [@problem_id:3028635] guides you to verify this relationship by confirming the identity $u^n = \\exp(n\\log(u))$ up to terms of order $p^3$. By independently expanding both sides of the equation, you will gain a deeper appreciation for how these transcendental functions elegantly translate between multiplicative and additive structures in the $p$-adic world.", "problem": "Let $p$ be a fixed odd prime with $p \\geq 5$. Let $a \\in \\mathbb{Z}_{p}$ and $b \\in \\mathbb{Z}_{p}$, and set $u = 1 + p a + p^{2} b \\in 1 + p \\mathbb{Z}_{p}$. Let $n \\in \\mathbb{Z}$ be arbitrary. Consider the $p$-adic logarithm defined on $1 + p \\mathbb{Z}_{p}$ by the power series $\\log(1+x) = \\sum_{k=1}^{\\infty} (-1)^{k+1} \\frac{x^{k}}{k}$ for $x \\in p \\mathbb{Z}_{p}$, and the $p$-adic exponential defined on $p \\mathbb{Z}_{p}$ by $\\exp(x) = \\sum_{k=0}^{\\infty} \\frac{x^{k}}{k!}$.\n\nUsing only these defining power series, and basic properties of the $p$-adic valuation on $\\mathbb{Q}_{p}$ and factorials, do the following:\n\n(i) Starting from the definitions, justify the convergence of the required series and compute $\\exp\\!\\big(n \\log(u)\\big)$ up to and including terms of $p$-adic valuation $3$ (that is, determine all terms through $p^{3}$).\n\n(ii) Independently, expand $u^{n} = (1 + p a + p^{2} b)^{n}$ using the binomial expansion through $p^{3}$.\n\n(iii) Reconcile the two computations to validate that the valuations are consistent and that the coefficients agree up to $p^{3}$. Finally, provide the explicit closed-form expression for $u^{n}$ modulo $p^{4}$, written as an expression involving $p$, $n$, $a$, and $b$.\n\nYour final answer must be a single explicit expression giving $u^{n}$ modulo $p^{4}$.", "solution": "The problem is valid. It is a well-defined exercise in $p$-adic analysis, grounded in standard definitions and properties of the $p$-adic logarithm and exponential functions. The givens are self-contained and consistent, and the required computations are feasible. The condition $p \\geq 5$ for the prime $p$ simplifies calculations involving denominators by ensuring that $v_p(k)=0$ for small integers $k$ such as $2$, $3$, $4$, and $6$.\n\nWe proceed to solve the problem in three parts as requested. All congruences are modulo $p^4 \\mathbb{Z}_p$, which means we are working in the quotient ring $\\mathbb{Z}_p/p^4\\mathbb{Z}_p$.\n\n(i) Computation of $\\exp(n \\log(u))$ modulo $p^4$\n\nFirst, we must justify the convergence of the series for the $p$-adic logarithm and exponential for the given arguments. Let $u = 1 + pa + p^2 b$. We write $u = 1+x$ with $x = pa + p^2 b$. Since $a, b \\in \\mathbb{Z}_p$, the $p$-adic valuation $v_p(x) = v_p(p(a+pb)) \\geq 1$.\n\nThe $p$-adic logarithm is defined by $\\log(1+x) = \\sum_{k=1}^{\\infty} (-1)^{k+1} \\frac{x^k}{k}$. The series converges if and only if the $p$-adic norm of its terms tends to zero, $|(-1)^{k+1} \\frac{x^k}{k}|_p \\to 0$ as $k \\to \\infty$. This is equivalent to $v_p(\\frac{x^k}{k}) \\to \\infty$. We have $v_p(\\frac{x^k}{k}) = k v_p(x) - v_p(k)$. Since $v_p(x) \\geq 1$ and $v_p(k) \\leq \\log_p(k)$, it follows that $v_p(\\frac{x^k}{k}) \\geq k - \\log_p(k)$, which tends to infinity as $k \\to \\infty$. Thus, the series for $\\log(u)$ converges.\n\nLet $Y = n \\log(u)$. The $p$-adic exponential is defined by $\\exp(Y) = \\sum_{k=0}^{\\infty} \\frac{Y^k}{k!}$. The valuation of the first term of the series for $\\log(u)$ is $v_p(x) \\geq 1$. For any subsequent term $\\frac{x^k}{k}$ with $k1$, $v_p(\\frac{x^k}{k}) \\geq k v_p(x) - v_p(k)  v_p(x)$ as long as $(k-1)v_p(x)  v_p(k)$, which holds for $k  1$. Therefore, $v_p(\\log u) = v_p(x) \\geq 1$. Since $n \\in \\mathbb{Z}$, $v_p(n) \\geq 0$, so $v_p(Y) = v_p(n \\log u) = v_p(n) + v_p(\\log u) \\geq 1$. The series for $\\exp(Y)$ converges for $v_p(Y)  \\frac{1}{p-1}$. Since $p \\geq 5$, we have $p-1 \\geq 4$, so $\\frac{1}{p-1} \\leq \\frac{1}{4}  1$. As $v_p(Y) \\geq 1$, the convergence condition is satisfied.\n\nNow we compute $\\log(u)$ modulo $p^4$. Let $x = pa + p^2b$.\nWe need to evaluate the series $\\log(1+x) = x - \\frac{x^2}{2} + \\frac{x^3}{3} - \\frac{x^4}{4} + \\dots$\nThe terms $x^k$ are:\n$x = pa + p^2b$\n$x^2 = (pa+p^2b)^2 = p^2a^2 + 2p^3ab + p^4b^2 \\equiv p^2a^2 + 2p^3ab \\pmod{p^4}$\n$x^3 = (pa+p^2b)^3 = p^3a^3 + 3p^4a^2b + \\dots \\equiv p^3a^3 \\pmod{p^4}$\n$x^k \\equiv 0 \\pmod{p^4}$ for $k \\geq 4$, since $v_p(x) \\geq 1$.\n\nSubstituting these into the series for $\\log(u)$:\n$$ \\log(u) \\equiv \\left(pa + p^2b\\right) - \\frac{1}{2}\\left(p^2a^2 + 2p^3ab\\right) + \\frac{1}{3}\\left(p^3a^3\\right) \\pmod{p^4} $$\nThe denominators $2$ and $3$ are invertible in $\\mathbb{Z}_p$ since $p \\geq 5$.\n$$ \\log(u) \\equiv pa + p^2b - \\frac{1}{2}p^2a^2 - p^3ab + \\frac{1}{3}p^3a^3 \\pmod{p^4} $$\nCollecting terms by powers of $p$:\n$$ \\log(u) \\equiv p(a) + p^2\\left(b - \\frac{a^2}{2}\\right) + p^3\\left(-ab + \\frac{a^3}{3}\\right) \\pmod{p^4} $$\nNow, let $Y = n \\log(u)$.\n$$ Y \\equiv n \\left( p a + p^2\\left(b - \\frac{a^2}{2}\\right) + p^3\\left(-ab + \\frac{a^3}{3}\\right) \\right) \\pmod{p^4} $$\nWe compute $\\exp(Y) = 1 + Y + \\frac{Y^2}{2!} + \\frac{Y^3}{3!} + \\dots$ modulo $p^4$.\nSince $v_p(Y) \\geq 1$, $v_p(Y^2) \\geq 2$, $v_p(Y^3) \\geq 3$, and $v_p(Y^k) \\geq 4$ for $k \\geq 4$. Since $p \\geq 5$, $v_p(k!)=0$ for $k  p$. Thus, we only need terms up to $\\frac{Y^3}{3!}$.\n\nPowers of $Y$:\n$Y \\equiv npa + np^2\\left(b-\\frac{a^2}{2}\\right) + \\dots \\pmod{p^3}$\n$Y^2 \\equiv \\left(npa + np^2(\\dots)\\right)^2 \\equiv (npa)^2 + 2(npa)\\left(np^2\\left(b-\\frac{a^2}{2}\\right)\\right) + \\dots \\pmod{p^4}$\n$Y^2 \\equiv n^2p^2a^2 + 2n^2p^3a\\left(b-\\frac{a^2}{2}\\right) \\equiv n^2p^2a^2 + 2n^2p^3ab - n^2p^3a^3 \\pmod{p^4}$\n$Y^3 \\equiv (npa)^3 \\equiv n^3p^3a^3 \\pmod{p^4}$\n\nNow we compute $\\exp(Y)$:\n$$ \\exp(Y) \\equiv 1 + Y + \\frac{Y^2}{2} + \\frac{Y^3}{6} \\pmod{p^4} $$\n$$ \\exp(Y) \\equiv 1 + n\\left(pa + p^2\\left(b - \\frac{a^2}{2}\\right) + p^3\\left(-ab + \\frac{a^3}{3}\\right)\\right) + \\frac{1}{2}\\left(n^2p^2a^2 + 2n^2p^3ab - n^2p^3a^3\\right) + \\frac{1}{6}\\left(n^3p^3a^3\\right) \\pmod{p^4} $$\nCollecting coefficients for each power of $p$:\nCoefficient of $p$: $na$\nCoefficient of $p^2$: $n\\left(b - \\frac{a^2}{2}\\right) + \\frac{n^2a^2}{2} = nb - \\frac{na^2}{2} + \\frac{n^2a^2}{2} = nb + \\frac{n(n-1)}{2}a^2$\nCoefficient of $p^3$: $n\\left(-ab + \\frac{a^3}{3}\\right) + n^2ab - \\frac{n^2a^3}{2} + \\frac{n^3a^3}{6} = (-nab + n^2ab) + \\left(\\frac{na^3}{3} - \\frac{n^2a^3}{2} + \\frac{n^3a^3}{6}\\right)$\nThe $ab$ term is $n(n-1)ab$.\nThe $a^3$ term is $a^3 \\left(\\frac{n}{3} - \\frac{n^2}{2} + \\frac{n^3}{6}\\right) = a^3 \\frac{2n - 3n^2 + n^3}{6} = a^3 \\frac{n(n^2-3n+2)}{6} = a^3 \\frac{n(n-1)(n-2)}{6}$.\n\nSo, the expression for $\\exp(n \\log(u))$ is:\n$$ \\exp(n \\log(u)) \\equiv 1 + p(na) + p^2\\left(nb + \\frac{n(n-1)}{2}a^2\\right) + p^3\\left(n(n-1)ab + \\frac{n(n-1)(n-2)}{6}a^3\\right) \\pmod{p^4} $$\n\n(ii) Binomial expansion of $u^n$ modulo $p^4$\n\nWe expand $u^n = (1 + pa + p^2b)^n$. Let $z = pa + p^2b$. Then we expand $(1+z)^n$ using the generalized binomial theorem, which is valid for $n \\in \\mathbb{Z}$ and $z \\in p\\mathbb{Z}_p$.\n$$ (1+z)^n = \\sum_{k=0}^{\\infty} \\binom{n}{k} z^k = 1 + \\binom{n}{1}z + \\binom{n}{2}z^2 + \\binom{n}{3}z^3 + \\dots $$\nThe binomial coefficients are $\\binom{n}{k} = \\frac{n(n-1)\\dots(n-k+1)}{k!}$. Since $n \\in \\mathbb{Z}$, these are integers. We need to evaluate terms modulo $p^4$.\nThe powers of $z$ are the same as in part (i):\n$z = pa + p^2b$\n$z^2 \\equiv p^2a^2 + 2p^3ab \\pmod{p^4}$\n$z^3 \\equiv p^3a^3 \\pmod{p^4}$\n$z^k \\equiv 0 \\pmod{p^4}$ for $k \\geq 4$.\n\nWe substitute these into the binomial expansion:\n$$ u^n \\equiv 1 + \\binom{n}{1}z + \\binom{n}{2}z^2 + \\binom{n}{3}z^3 \\pmod{p^4} $$\n$$ u^n \\equiv 1 + n(pa + p^2b) + \\frac{n(n-1)}{2}(p^2a^2 + 2p^3ab) + \\frac{n(n-1)(n-2)}{6}(p^3a^3) \\pmod{p^4} $$\nDistributing and collecting terms by powers of $p$:\n$$ u^n \\equiv 1 + p(na) + p^2(nb) + p^2\\left(\\frac{n(n-1)}{2}a^2\\right) + p^3\\left(\\frac{n(n-1)}{2} \\cdot 2ab\\right) + p^3\\left(\\frac{n(n-1)(n-2)}{6}a^3\\right) \\pmod{p^4} $$\n$$ u^n \\equiv 1 + p(na) + p^2\\left(nb + \\frac{n(n-1)}{2}a^2\\right) + p^3\\left(n(n-1)ab + \\frac{n(n-1)(n-2)}{6}a^3\\right) \\pmod{p^4} $$\n\n(iii) Reconciliation and Final Expression\n\nComparing the results from part (i) and part (ii):\nResult (i):\n$$ \\exp(n \\log(u)) \\equiv 1 + p(na) + p^2\\left(nb + \\frac{n(n-1)}{2}a^2\\right) + p^3\\left(n(n-1)ab + \\frac{n(n-1)(n-2)}{6}a^3\\right) \\pmod{p^4} $$\nResult (ii):\n$$ u^n \\equiv 1 + p(na) + p^2\\left(nb + \\frac{n(n-1)}{2}a^2\\right) + p^3\\left(n(n-1)ab + \\frac{n(n-1)(n-2)}{6}a^3\\right) \\pmod{p^4} $$\nThe two expressions are identical. This verifies the property $u^n = \\exp(n \\log(u))$ for $u \\in 1 + p\\mathbb{Z}_p$ and $n \\in \\mathbb{Z}$ up to terms of $p$-adic valuation $3$. The valuations are consistent and the coefficients agree.\n\nThe explicit closed-form expression for $u^n$ modulo $p^4$ is the result of this calculation:\n$$ u^n \\equiv 1 + npa + p^2\\left(nb + \\frac{n(n-1)}{2}a^2\\right) + p^3\\left(n(n-1)ab + \\frac{n(n-1)(n-2)}{6}a^3\\right) \\pmod{p^4} $$\nThis is the final required expression.", "answer": "$$ \\boxed{1 + npa + p^2\\left(nb + \\frac{n(n-1)}{2}a^2\\right) + p^3\\left(n(n-1)ab + \\frac{n(n-1)(n-2)}{6}a^3\\right)} $$", "id": "3028635"}, {"introduction": "The final practice elevates your skills from performing specific calculations to designing a general computational algorithm. You are tasked with creating a systematic method to compute the $p$-adic exponential $\\exp(x)$ to any desired precision $p^m$ [@problem_id:3028640]. This involves not only implementing the series summation but also rigorously determining the minimal number of terms required by analyzing the growth of the $p$-adic valuation of each term. This exercise synthesizes your understanding of convergence, valuation, and modular arithmetic, challenging you to think like a computational number theorist who must develop robust and efficient tools for exploring $p$-adic systems.", "problem": "Let $p$ be a prime, let $m$ be a positive integer, and let $x$ be a $p$-adic integer with $x \\in p\\mathbb{Z}_p$. The $p$-adic exponential is defined by the formal power series $\\exp(x) = \\sum_{n=0}^{\\infty} \\frac{x^n}{n!}$, which converges in the $p$-adic topology for inputs satisfying $v_p(x)  \\frac{1}{p-1}$, where $v_p(\\cdot)$ denotes the $p$-adic valuation. In particular, the series converges for all $x \\in p\\mathbb{Z}_p$ when $p \\ge 3$, and for all $x \\in 4\\mathbb{Z}_2$ when $p=2$.\n\nYour task is to design and implement an algorithm that, for a given target precision $p^m$, computes $\\exp(x)$ modulo $p^m$ with minimal truncation length of the series. The algorithm must be derived from valuation bounds on $n!$, starting from fundamental principles, and must determine the smallest truncation index $N$ such that all tail terms satisfy $v_p\\!\\left(\\frac{x^n}{n!}\\right) \\ge m$ for all $n \\ge N+1$. Then compute\n$$\nS_N(x) \\equiv \\sum_{n=0}^{N} \\frac{x^n}{n!} \\pmod{p^m},\n$$\nwhich equals $\\exp(x)$ modulo $p^m$ by $p$-adic continuity and the valuation bound.\n\nThe key foundational facts you must use to derive your method are:\n- The $p$-adic valuation $v_p(\\cdot)$ and its properties, including $v_p(x^n) = n\\,v_p(x)$ and $v_p\\!\\left(\\frac{x^n}{n!}\\right) = n\\,v_p(x) - v_p(n!)$.\n- Legendre’s formula for factorial valuations: $v_p(n!) = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{n}{p^k} \\right\\rfloor$, together with the inequality $v_p(n!) \\le \\frac{n}{p-1}$.\n- The convergence criterion $v_p(x)  \\frac{1}{p-1}$ for the $p$-adic exponential series.\n\nYour program must:\n1. For each test case, compute the minimal truncation length $N$ defined by\n$$\nN = \\max \\left\\{ n \\in \\mathbb{Z}_{\\ge 0} \\,\\middle|\\, n\\,v_p(x) - v_p(n!)  m \\right\\}.\n$$\n2. Use the identity $x = p^{v} u$ with $v = v_p(x)$ and $u$ a $p$-adic unit to compute each term $\\frac{x^n}{n!}$ modulo $p^m$ by splitting into valuation and unit parts:\n   - Write $v_p\\!\\left(\\frac{x^n}{n!}\\right) = n\\,v - v_p(n!) =: v_n$.\n   - Compute the unit part $U_n \\equiv \\frac{u^n}{n! / p^{v_p(n!)}} \\pmod{p^{m - v_n}}$, which is invertible modulo $p^{m - v_n}$.\n   - Then $\\frac{x^n}{n!} \\equiv p^{v_n} \\cdot U_n \\pmod{p^m}$.\n3. Sum the contributions for $n=0,1,\\dots,N$ to obtain $S_N(x) \\pmod{p^m}$.\n\nDesign constraints:\n- Derive $N$ using valuation bounds on $n!$ without assuming any shortcut formulas beyond the foundational facts listed above.\n- Ensure the algorithm correctly handles the domain of convergence ($p \\ge 3$ with $x \\in p\\mathbb{Z}_p$, or $p=2$ with $x \\in 4\\mathbb{Z}_2$).\n- All mathematical definitions and derivations must be rooted in the stated foundational principles.\n\nTest suite:\nImplement your algorithm for the following parameter sets $(p,m,x)$, where $x$ is given as an ordinary integer representative of the $p$-adic input:\n- $(3,5,21)$ with $21 \\in 3\\mathbb{Z}_3$.\n- $(5,4,60)$ with $60 \\in 5\\mathbb{Z}_5$.\n- $(3,1,3)$ with $3 \\in 3\\mathbb{Z}_3$ (boundary precision).\n- $(2,6,12)$ with $12 \\in 4\\mathbb{Z}_2$ (domain nuance for $p=2$).\n\nAnswer specification:\n- For each test case, output the integer representative of $\\exp(x) \\bmod p^m$ in the range $\\{0,1,\\dots,p^m-1\\}$.\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, with no spaces, in the order listed above. For example: \"[r1,r2,r3,r4]\".\n- No physical units are involved.", "solution": "The user wants a solution to a computational problem in $p$-adic analysis.\n\n### Step 1: Extract Givens\n- **Field**: Number theory, specifically $p$-adic analysis.\n- **Topic**: The $p$-adic exponential function, $\\exp(x)$.\n- **Definitions**:\n    - $p$: a prime number.\n    - $m$: a positive integer.\n    - $x$: a $p$-adic integer with $x \\in p\\mathbb{Z}_p$.\n    - $v_p(\\cdot)$: the $p$-adic valuation.\n    - $p$-adic exponential series: $\\exp(x) = \\sum_{n=0}^{\\infty} \\frac{x^n}{n!}$.\n- **Convergence Conditions**:\n    - General: $v_p(x)  \\frac{1}{p-1}$.\n    - For $p \\ge 3$: $x \\in p\\mathbb{Z}_p$ (i.e., $v_p(x) \\ge 1$). This satisfies the general condition as $1  \\frac{1}{p-1}$ for $p \\ge 3$.\n    - For $p=2$: $x \\in 4\\mathbb{Z}_2$ (i.e., $v_2(x) \\ge 2$). This satisfies the general condition as $2  \\frac{1}{2-1} = 1$.\n- **Task**: Compute $\\exp(x) \\pmod{p^m}$ by summing a truncated series $S_N(x) = \\sum_{n=0}^{N} \\frac{x^n}{n!}$.\n- **Required Derivations and Methods**:\n    1.  Determine the minimal truncation index $N = \\max \\left\\{ n \\in \\mathbb{Z}_{\\ge 0} \\,\\middle|\\, n\\,v_p(x) - v_p(n!)  m \\right\\}$.\n    2.  Use the following foundational facts for the derivation:\n        - $v_p(x^n) = n\\,v_p(x)$ and $v_p\\!\\left(\\frac{x^n}{n!}\\right) = n\\,v_p(x) - v_p(n!)$.\n        - Legendre’s formula: $v_p(n!) = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{n}{p^k} \\right\\rfloor$.\n        - Inequality: $v_p(n!) \\le \\frac{n}{p-1}$.\n    3.  Compute each term $\\frac{x^n}{n!}$ modulo $p^m$ by decomposing it into valuation and unit parts:\n        - Write $v_n = v_p\\!\\left(\\frac{x^n}{n!}\\right) = n\\,v_p(x) - v_p(n!)$.\n        - Compute the unit part $U_n \\equiv \\frac{u^n}{n! / p^{v_p(n!)}} \\pmod{p^{m - v_n}}$, where $x=p^{v_p(x)}u$.\n        - The term is then congruent to $p^{v_n} \\cdot U_n \\pmod{p^m}$.\n- **Test Cases**:\n    - $(p, m, x) = (3, 5, 21)$\n    - $(p, m, x) = (5, 4, 60)$\n    - $(p, m, x) = (3, 1, 3)$\n    - $(p, m, x) = (2, 6, 12)$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific or Factual Unsoundness**: The problem is grounded in the standard theory of $p$-adic analysis. All definitions, formulas (like Legendre's), and concepts (like the $p$-adic exponential function and its domain of convergence) are well-established in mathematics.\n- **Non-Formalizable or Irrelevant**: The problem is a formal computational task within the specified topic.\n- **Incomplete or Contradictory Setup**: The problem is self-contained. All necessary parameters ($p, m, x$) are provided for each test case. The input $x$ for each test case satisfies the stated convergence criteria:\n    - For $(3, 5, 21)$, $p=3$ and $x=21=3 \\cdot 7$. $v_3(21)=1$, so $x \\in 3\\mathbb{Z}_3$. The condition $v_3(x)  1/(3-1)$ is $1  1/2$, which is true.\n    - For $(5, 4, 60)$, $p=5$ and $x=60=5 \\cdot 12$. $v_5(60)=1$, so $x \\in 5\\mathbb{Z}_5$. The condition $v_5(x)  1/(5-1)$ is $1  1/4$, which is true.\n    - For $(3, 1, 3)$, $p=3$ and $x=3$. $v_3(3)=1$, so $x \\in 3\\mathbb{Z}_3$. The condition $1  1/2$ is true.\n    - For $(2, 6, 12)$, $p=2$ and $x=12=4 \\cdot 3$. $v_2(12)=2$, so $x \\in 4\\mathbb{Z}_2$. The condition $v_2(x)  1/(2-1)$ is $2  1$, which is true.\n- **Ill-Posed or Poorly Structured**: The problem is well-posed. The quantity to be computed is uniquely defined, and the method for truncation provides a clear path to a unique answer.\n- **Other Flaws**: The problem is not trivial, unrealistic, or unverifiable. It is a standard, albeit non-trivial, computational problem in number theory.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe problem requires us to compute the $p$-adic exponential $\\exp(x)$ modulo $p^m$. The function is defined by the power series $\\exp(x) = \\sum_{n=0}^{\\infty} \\frac{x^n}{n!}$. We are asked to compute this value by truncating the series at an appropriate index $N$ and computing the partial sum $S_N(x) = \\sum_{n=0}^{N} \\frac{x^n}{n!}$ modulo $p^m$.\n\n**1. Determination of the Truncation Index $N$**\n\nThe approximation $S_N(x) \\equiv \\exp(x) \\pmod{p^m}$ is valid if all subsequent terms in the series are congruent to $0$ modulo $p^m$. This means their $p$-adic valuation must be at least $m$. The valuation of the $n$-th term is given by $v_p\\left(\\frac{x^n}{n!}\\right) = v_p(x^n) - v_p(n!) = n v_p(x) - v_p(n!)$.\nThe condition for a term to be negligible is $n v_p(x) - v_p(n!) \\ge m$.\nThe problem defines the truncation index $N$ as the largest integer $n$ for which this condition is *not* met:\n$$N = \\max \\left\\{ n \\in \\mathbb{Z}_{\\ge 0} \\,\\middle|\\, n\\,v_p(x) - v_p(n!)  m \\right\\}$$\nThis means we must sum all terms up to and including the one with index $N$.\n\nTo find $N$, we must analyze the function $f(n) = n v_p(x) - v_p(n!)$. A new value of $N$ is found whenever we encounter an index $n$ such that $f(n)  m$.\nThe function $f(n)$ is not strictly monotonic because of the behavior of $v_p(n!)$. The change in $f(n)$ from $n-1$ to $n$ is $f(n) - f(n-1) = v_p(x) - v_p(n)$. This difference can be negative if $v_p(n)  v_p(x)$. However, the overall trend of $f(n)$ is increasing. This can be seen using Legendre's formula, which implies $v_p(n!) = \\frac{n - S_p(n)}{p-1}$, where $S_p(n)$ is the sum of the digits of $n$ in base $p$.\nSubstituting this into $f(n)$, we get:\n$$f(n) = n v_p(x) - \\frac{n - S_p(n)}{p-1} = n\\left(v_p(x) - \\frac{1}{p-1}\\right) + \\frac{S_p(n)}{p-1}$$\nThe convergence condition for the $p$-adic exponential series, $v_p(x)  \\frac{1}{p-1}$, guarantees that the coefficient of $n$, which is $v_p(x) - \\frac{1}{p-1}$, is positive. Thus, $f(n)$ has a dominant positive linear growth term, ensuring that for any given $m$, $f(n)$ will eventually exceed and stay above $m$. This guarantees that a finite $N$ exists and can be found by searching.\nThe algorithm to find $N$ is to iterate through $n = 0, 1, 2, \\dots$ up to a reasonable search limit, calculating $v_n = n v_p(x) - v_p(n!)$ at each step. If $v_n  m$, we update our candidate for $N$ to the current $n$. Since $f(n)$ eventually increases without bound, we will find a final value for $N$.\n\n**2. Algorithm for Series Summation**\n\nWith the value of $N$ determined, we compute the sum $S_N(x) = \\sum_{n=0}^{N} \\frac{x^n}{n!}$ modulo $p^m$. The computation of each term $\\frac{x^n}{n!}$ for $n \\in \\{0, 1, \\dots, N\\}$ must be handled carefully to manage large numbers and divisions in modular arithmetic.\n\nAs specified, we write $x = p^v u$, where $v = v_p(x)$ and $u$ is a $p$-adic unit. The $n$-th term is:\n$$\\frac{x^n}{n!} = \\frac{(p^v u)^n}{n!} = \\frac{p^{nv} u^n}{n!}$$\nThe $p$-adic valuation of this term is $v_n = nv - v_p(n!)$. We can rewrite the term as:\n$$\\frac{x^n}{n!} = p^{nv - v_p(n!)} \\cdot \\frac{u^n}{n! / p^{v_p(n!)}} = p^{v_n} \\cdot U_n$$\nwhere $U_n$ is the \"unit part\" of the term. For the term to be non-zero modulo $p^m$, we must have $v_n  m$.\nThe computation of the full sum modulo $p^m$ proceeds as follows:\n- Initialize the total sum to $0$.\n- The term for $n=0$ is $\\frac{x^0}{0!} = 1$. The sum starts at $1$.\n- Iterate for $n = 1, 2, \\dots, N$. In each iteration, we compute the $n$-th term's contribution.\n- We iteratively maintain the values of $v_p(n!)$, $u^n$, and the $p$-free part of the factorial, which we denote as $n!_p = n! / p^{v_p(n!)}$.\n- For each $n$, we update:\n    - $v_p(n!) = v_p((n-1)!) + v_p(n)$.\n    - $u^n \\pmod{p^m} = (u^{n-1} \\pmod{p^m}) \\cdot u \\pmod{p^m}$.\n    - $n!_p \\pmod{p^m} = ((n-1)!_p \\pmod{p^m}) \\cdot (n/p^{v_p(n)}) \\pmod{p^m}$.\n- With these updated values, calculate the term's valuation: $v_n = n \\cdot v - v_p(n!)$.\n- If $v_n \\ge m$, the term is congruent to $0$ modulo $p^m$, so we add nothing to the sum.\n- If $v_n  m$, we must compute the value of the term $p^{v_n} U_n$ modulo $p^m$. The unit part is $U_n = u^n \\cdot (n!_p)^{-1}$. This computation must be performed modulo $p^{m-v_n}$, because after multiplication by $p^{v_n}$, this is the precision required.\n    - Let the modulus for the unit part be $M_n = p^{m-v_n}$.\n    - We compute the modular inverse of $n!_p$ with respect to $M_n$: $(n!_p)^{-1} \\pmod{M_n}$. This inverse exists since $n!_p$ is not divisible by $p$.\n    - The unit part is $U_n \\equiv (u^n \\pmod{M_n}) \\cdot ((n!_p)^{-1} \\pmod{M_n}) \\pmod{M_n}$.\n    - The full term is $p^{v_n} \\cdot U_n \\pmod{p^m}$.\n- Add this term to the total sum, modulo $p^m$.\nAfter iterating through all $n$ up to $N$, the final value of the sum is the desired result, $\\exp(x) \\pmod{p^m}$.\n\nThis procedure provides a complete and robust algorithm for computing the $p$-adic exponential within its domain of convergence to a specified precision, derived from the foundational principles of $p$-adic valuation.", "answer": "```python\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the p-adic exponential problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        (3, 5, 21),\n        (5, 4, 60),\n        (3, 1, 3),\n        (2, 6, 12),\n    ]\n\n    results = []\n    for p, m, x in test_cases:\n        result = compute_padic_exp(p, m, x)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef get_vp(n, p):\n    \"\"\"\n    Calculates the p-adic valuation vp(n).\n    Returns float('inf') for n=0.\n    \"\"\"\n    if n == 0:\n        return float('inf')\n    \n    count = 0\n    if n  0:\n        n = -n\n        \n    while n > 0 and n % p == 0:\n        count += 1\n        n //= p\n    return count\n\ndef compute_padic_exp(p, m, x):\n    \"\"\"\n    Computes exp(x) mod p^m using a truncated power series.\n\n    Args:\n        p: A prime number.\n        m: A positive integer for the precision p^m.\n        x: An integer representing a p-adic number.\n\n    Returns:\n        The integer representative of exp(x) mod p^m.\n    \"\"\"\n    mod_p_m = p**m\n    \n    if x == 0:\n        return 1\n    \n    v = get_vp(x, p)\n    u = x // (p**v)\n\n    # 1. Determine the minimal truncation length N\n    N = 0\n    vp_fact_n = 0  # v_p(n!)\n    \n    # Heuristic search limit for N, based on linear growth of valuation\n    # f(n) ~ n*(v - 1/(p-1)). Find n where f(n) ~ m.\n    # n_approx = m / (v - 1/(p-1)) if v > 1/(p-1) else m*p*2\n    # Add a generous safety margin\n    search_limit = int(m * p * 2)\n\n    for n in range(search_limit + 1):\n        if n > 0:\n            vp_fact_n += get_vp(n, p)\n        v_n = n * v - vp_fact_n\n        if v_n  m:\n            N = n\n\n    # 2. Sum the series up to N\n    total_sum = 0\n    \n    # Iterative calculation of terms for n = 0 to N\n    term_p_free = 1    # (x^n / n!) / p^{v_n}\n    u_pow_p_free = 1   # u^n\n    fact_p_free = 1    # n! / p^{v_p(n!)}\n    \n    vp_fact = 0\n    \n    for n in range(N + 1):\n        if n > 0:\n            vp_of_n = get_vp(n, p)\n            n_p_free = n // (p**vp_of_n)\n            \n            fact_p_free = (fact_p_free * n_p_free)\n            u_pow_p_free = (u_pow_p_free * u)\n            vp_fact += vp_of_n\n\n        v_n = n * v - vp_fact\n        \n        if v_n >= m:\n            continue\n        \n        mod_for_inv = p**(m - v_n)\n\n        # Compute term: p^{v_n} * u^n * (fact_p_free)^{-1} mod p^m\n        try:\n            inv_fact_p_free = pow(fact_p_free, -1, mod_for_inv)\n        except ValueError:\n            # This happens if mod_for_inv is 1. In this case, the unit part is 0 mod 1.\n            if mod_for_inv == 1:\n                inv_fact_p_free = 0\n            else:\n                raise\n\n        unit_part = (u_pow_p_free * inv_fact_p_free) % mod_for_inv\n        \n        term = (pow(p, v_n) * unit_part)\n        total_sum = (total_sum + term)\n\n    return total_sum % mod_p_m\n\n# Execute the solution\nsolve()\n```", "id": "3028640"}]}