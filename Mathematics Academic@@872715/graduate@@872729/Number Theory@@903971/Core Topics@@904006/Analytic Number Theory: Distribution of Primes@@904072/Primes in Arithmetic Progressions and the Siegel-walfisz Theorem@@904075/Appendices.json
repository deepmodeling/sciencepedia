{"hands_on_practices": [{"introduction": "The study of primes in arithmetic progressions is built upon the powerful toolkit of Dirichlet characters. Their most crucial feature is the property of orthogonality, which allows us to use them as a \"filter\" to isolate integers belonging to a specific residue class modulo $q$. This foundational exercise [@problem_id:3021450] has you derive this orthogonality relation from first principles, cementing your understanding of the mechanism that makes characters indispensable in analytic number theory.", "problem": "Let $q \\ge 1$ be a fixed integer and let a Dirichlet character modulo $q$ be a completely multiplicative function $\\chi:\\mathbb{Z}\\to\\mathbb{C}$ that is periodic modulo $q$ and satisfies $\\chi(n)=0$ whenever $\\gcd(n,q)1$. Let $\\varphi(q)$ denote Euler’s totient function, and let $\\mathbf{1}_{E}$ denote the indicator of an event $E$ (equal to $1$ if $E$ holds and $0$ otherwise). For a fixed integer $n$, define\n$$\nS_q(n)\\;=\\;\\sum_{\\chi \\bmod q} \\chi(n),\n$$\nwhere the sum runs over all Dirichlet characters modulo $q$. Starting only from the definitions of Dirichlet characters and basic properties of characters of finite Abelian groups, derive an explicit closed-form expression for $S_q(n)$ in terms of $\\varphi(q)$ and an indicator that depends on the residue class of $n$ modulo $q$, and interpret the answer in terms of the greatest common divisor $\\gcd(n,q)$. Your final answer must be a single closed-form analytic expression for $S_q(n)$ (no rounding is required).", "solution": "The problem asks for an explicit closed-form expression for the sum $S_q(n) = \\sum_{\\chi \\bmod q} \\chi(n)$, where the sum is over all Dirichlet characters $\\chi$ modulo a fixed integer $q \\ge 1$. The derivation must be based on the fundamental definitions of Dirichlet characters and the properties of characters of finite Abelian groups.\n\nLet $G = (\\mathbb{Z}/q\\mathbb{Z})^\\times$ be the multiplicative group of integers modulo $q$. This is a finite Abelian group of order $|G| = \\varphi(q)$, where $\\varphi$ is Euler's totient function. The elements of $G$ are the residue classes $[a]$ such that $\\gcd(a,q)=1$.\n\nA Dirichlet character $\\chi$ modulo $q$ is defined as a function on $\\mathbb{Z}$. When its domain is restricted to integers $n$ coprime to $q$, it acts as a group character on $G$. That is, $\\chi(n)$ depends only on the residue class of $n$ modulo $q$, and the map $[n] \\mapsto \\chi(n)$ is a homomorphism from $G$ to the multiplicative group of complex numbers $\\mathbb{C}^\\times$. By definition, for any $n$ with $\\gcd(n,q)1$, we have $\\chi(n)=0$. The set of all Dirichlet characters modulo $q$ forms a group under multiplication, denoted $\\widehat{G}$, which is isomorphic to $G$ and thus has order $|\\widehat{G}| = \\varphi(q)$.\n\nWe analyze the sum $S_q(n)$ by considering two cases based on the value of $\\gcd(n,q)$.\n\nCase 1: $\\gcd(n,q) > 1$.\nBy the definition of a Dirichlet character modulo $q$, if an integer $n$ is not coprime to $q$, then $\\chi(n)=0$ for every character $\\chi \\pmod q$.\nTherefore, the sum $S_q(n)$ is a sum of terms that are all equal to $0$:\n$$S_q(n) = \\sum_{\\chi \\bmod q} \\chi(n) = \\sum_{\\chi \\bmod q} 0 = 0.$$\n\nCase 2: $\\gcd(n,q) = 1$.\nIn this case, $n$ represents an element of the group $G = (\\mathbb{Z}/q\\mathbb{Z})^\\times$. Since $\\chi(n) \\neq 0$, we can use the properties of the group of characters $\\widehat{G}$. The sum is over all characters in $\\widehat{G}$:\n$$S_q(n) = \\sum_{\\chi \\in \\widehat{G}} \\chi(n).$$\nWe now invoke the first orthogonality relation for characters of a finite Abelian group. Let's derive this property from basic principles as requested. The sum depends on whether $n$ corresponds to the identity element of $G$. The identity element of $G$ is the residue class $1 \\pmod q$.\n\nSubcase 2a: $n \\equiv 1 \\pmod q$.\nSince $n \\equiv 1 \\pmod q$ and $\\gcd(n, q)=1$, $n$ is the identity element of $G$. For any group character $\\chi$, it is a homomorphism, so $\\chi(1)=1$. The complex value $\\chi(n)$ depends on the residue class of $n$ modulo $q$, so $\\chi(n)=\\chi(1)=1$.\nThe sum becomes:\n$$S_q(n) = \\sum_{\\chi \\in \\widehat{G}} 1.$$\nThe number of Dirichlet characters modulo $q$ is $|\\widehat{G}| = \\varphi(q)$.\nThus, when $n \\equiv 1 \\pmod q$,\n$$S_q(n) = \\varphi(q).$$\n\nSubcase 2b: $n \\not\\equiv 1 \\pmod q$.\nSince $\\gcd(n,q)=1$ and $n \\not\\equiv 1 \\pmod q$, $n$ represents a non-identity element of the group $G$. A fundamental property of characters of a finite Abelian group is that they separate points. This means for any non-identity element $g \\in G$, there exists a character $\\psi \\in \\widehat{G}$ such that $\\psi(g) \\neq 1$.\nSo, there exists a character $\\chi_0 \\in \\widehat{G}$ such that $\\chi_0(n) \\neq 1$.\nLet's consider the sum $S_q(n) = \\sum_{\\chi \\in \\widehat{G}} \\chi(n)$. We multiply this sum by the non-unit complex number $\\chi_0(n)$:\n$$\\chi_0(n) S_q(n) = \\chi_0(n) \\sum_{\\chi \\in \\widehat{G}} \\chi(n) = \\sum_{\\chi \\in \\widehat{G}} \\chi_0(n)\\chi(n).$$\nSince characters are homomorphisms, $\\chi_0(n)\\chi(n) = (\\chi_0\\chi)(n)$. The set of characters $\\widehat{G}$ is a group under multiplication. The map $\\chi \\mapsto \\chi_0\\chi$ for a fixed $\\chi_0$ is a permutation of the group $\\widehat{G}$. Therefore, summing over all $\\chi \\in \\widehat{G}$ is equivalent to summing over all characters $\\chi' = \\chi_0\\chi \\in \\widehat{G}$.\n$$\\chi_0(n) S_q(n) = \\sum_{\\chi' \\in \\widehat{G}} \\chi'(n) = S_q(n).$$\nThis gives the equation $(\\chi_0(n) - 1)S_q(n) = 0$.\nBy our choice of $\\chi_0$, we have $\\chi_0(n) \\neq 1$, which implies that the factor $(\\chi_0(n) - 1)$ is non-zero. For the product to be zero, it must be that $S_q(n)=0$.\n\nCombining all cases:\n- If $\\gcd(n,q)1$, then $S_q(n)=0$.\n- If $\\gcd(n,q)=1$ and $n \\not\\equiv 1 \\pmod q$, then $S_q(n)=0$.\n- If $\\gcd(n,q)=1$ and $n \\equiv 1 \\pmod q$, then $S_q(n)=\\varphi(q)$.\n\nWe can unify these results into a single expression. Note that if $n \\equiv 1 \\pmod q$, then $n = kq + 1$ for some integer $k$. From the Euclidean algorithm, $\\gcd(n,q) = \\gcd(kq+1, q) = \\gcd(1, q) = 1$ (since $q \\ge 1$). Thus, the condition $n \\equiv 1 \\pmod q$ automatically implies $\\gcd(n,q)=1$.\nThis means the sum $S_q(n)$ is non-zero if and only if $n \\equiv 1 \\pmod q$.\nWe can express this using the indicator function $\\mathbf{1}_{E}$, which is $1$ if the event $E$ is true, and $0$ otherwise.\nThe final expression is:\n$$S_q(n) = \\varphi(q) \\cdot \\mathbf{1}_{n \\equiv 1 \\pmod q}.$$\n\nThis result is often called the orthogonality relation for characters. It states that the sum of the values of all characters evaluated at a group element $n$ is non-zero if and only if $n$ is the identity element of the group.\n\nInterpreting the answer in terms of $\\gcd(n,q)$:\nThe expression $\\varphi(q) \\mathbf{1}_{n \\equiv 1 \\pmod q}$ demonstrates that the sum $S_q(n)$ acts as a \"detector\" for the specific residue class $1 \\pmod q$. The sum is zero for all integers $n$ that are not congruent to $1 \\pmod q$. This includes two categories of such integers:\n1. All integers $n$ for which $\\gcd(n,q)  1$. As shown, if $\\gcd(n,q)  1$ (and $q1$), then $n$ cannot be congruent to $1$ modulo $q$, so the indicator function is $0$.\n2. All integers $n$ for which $\\gcd(n,q) = 1$ but $n$ is not the identity element in $(\\mathbb{Z}/q\\mathbb{Z})^\\times$ (i.e., $n \\not\\equiv 1 \\pmod q$).\nThe sum is non-zero, taking the value $\\varphi(q)$, only for those integers $n$ that satisfy the stringent condition $n \\equiv 1 \\pmod q$, a condition which implies $\\gcd(n,q)=1$.", "answer": "$$\\boxed{\\varphi(q) \\mathbf{1}_{n \\equiv 1 \\pmod{q}}}$$", "id": "3021450"}, {"introduction": "Prime counting is often performed using two closely related functions: $\\theta(x; q, a)$, which sums $\\log p$ over primes, and the Chebyshev function $\\psi(x; q, a)$, which sums the von Mangoldt function $\\Lambda(n)$ over all prime powers. The Siegel-Walfisz theorem is typically stated for $\\psi(x; q, a)$, and this practice [@problem_id:3021429] challenges you to quantify the difference between these two functions. By proving that this difference is a lower-order error term, you will affirm the critical insight that the asymptotic distribution of primes is unchanged whether we count primes directly or include the contribution of higher prime powers.", "problem": "Let $q \\ge 1$ and let $a$ be an integer with $\\gcd(a,q)=1$. Define the arithmetic progression Chebyshev functions\n$$\n\\theta(x; q,a) := \\sum_{\\substack{p \\le x \\\\ p \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p,\\qquad\n\\psi(x; q,a) := \\sum_{\\substack{n \\le x \\\\ n \\equiv a \\, (\\mathrm{mod}\\ q)}} \\Lambda(n),\n$$\nwhere $\\Lambda(n)$ is the von Mangoldt function, defined by $\\Lambda(n) = \\log p$ if $n = p^{k}$ for some prime $p$ and integer $k \\ge 1$, and $\\Lambda(n) = 0$ otherwise. Let $\\varphi(q)$ denote Euler’s totient function, and recall the classical Siegel–Walfisz theorem, which states that for any fixed $A0$ there exists $c(A)0$ such that uniformly for $q \\le (\\log x)^{A}$ and $\\gcd(a,q)=1$,\n$$\n\\psi(x; q,a) = \\frac{x}{\\varphi(q)} + O\\!\\left( x \\exp\\!\\big(-c(A)\\sqrt{\\log x}\\big) \\right).\n$$\nConsider the effect on asymptotics when replacing $\\theta(x; q,a)$ by $\\psi(x; q,a)$, and quantify the difference $\\psi(x; q,a) - \\theta(x; q,a)$ in terms of prime powers. Which of the following statements are correct?\n\nA. Uniformly in $q \\ge 1$ and $a$ with $\\gcd(a,q)=1$, one has\n$$\n\\psi(x; q,a) - \\theta(x; q,a) \\ll x^{1/2},\n$$\nwith an absolute implied constant, because only prime powers $p^{k}$ with $k \\ge 2$ contribute and their total weighted contribution by $\\log p$ is $O(x^{1/2})$.\n\nB. For any fixed $A0$, if\n$$\n\\psi(x; q,a) = \\frac{x}{\\varphi(q)} + O\\!\\left( x \\exp\\!\\big(-c(A)\\sqrt{\\log x}\\big) \\right)\n$$\nuniformly for $q \\le (\\log x)^{A}$, then\n$$\n\\theta(x; q,a) = \\frac{x}{\\varphi(q)} + O\\!\\left( x \\exp\\!\\big(-c'(A)\\sqrt{\\log x}\\big) \\right)\n$$\nuniformly for $q \\le (\\log x)^{A}$ as well (possibly with a different constant $c'(A)0$), because $\\psi(x; q,a) - \\theta(x; q,a)$ is negligible compared to the Siegel–Walfisz error term.\n\nC. The contribution of prime powers to $\\psi(x; q,a)$ is asymptotically $\\dfrac{x}{\\varphi(q)}$, so replacing $\\theta$ by $\\psi$ changes the main term in the asymptotic for primes in arithmetic progressions.\n\nD. One has the identity\n$$\n\\psi(x; q,a) - \\theta(x; q,a) = \\theta\\!\\left(x^{1/2}; q,a\\right),\n$$\nsince only prime squares contribute to $\\psi(x; q,a)$ beyond $\\theta(x; q,a)$.\n\nE. The bound\n$$\n\\psi(x; q,a) - \\theta(x; q,a) \\ll \\log x\n$$\nholds uniformly in $q \\ge 1$ and $a$ with $\\gcd(a,q)=1$ for all $x \\ge 2$.", "solution": "The user wants me to act as a meticulous and exacting STEM professor to validate and solve a problem in analytic number theory concerning the Chebyshev functions and the Siegel-Walfisz theorem.\n\n### Problem Validation\n\nFirst, I must validate the problem statement as per the provided protocol.\n\n**Step 1: Extract Givens**\n\nThe givens from the problem statement are:\n- $q \\ge 1$ is an integer.\n- $a$ is an integer with $\\gcd(a,q)=1$.\n- The first Chebyshev function for an arithmetic progression is defined as:\n$$ \\theta(x; q,a) := \\sum_{\\substack{p \\le x \\\\ p \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p $$\n- The second Chebyshev function for an arithmetic progression is defined as:\n$$ \\psi(x; q,a) := \\sum_{\\substack{n \\le x \\\\ n \\equiv a \\, (\\mathrm{mod}\\ q)}} \\Lambda(n) $$\n- The von Mangoldt function $\\Lambda(n)$ is defined as $\\Lambda(n) = \\log p$ if $n = p^{k}$ for a prime $p$ and integer $k \\ge 1$, and $\\Lambda(n) = 0$ otherwise.\n- $\\varphi(q)$ denotes Euler’s totient function.\n- The Siegel–Walfisz theorem states that for any fixed $A0$ there exists a constant $c(A)0$ such that uniformly for $q \\le (\\log x)^{A}$ and $\\gcd(a,q)=1$:\n$$ \\psi(x; q,a) = \\frac{x}{\\varphi(q)} + O\\!\\left( x \\exp\\!\\big(-c(A)\\sqrt{\\log x}\\big) \\right) $$\n- The question is to consider the effect on asymptotics when replacing $\\theta(x; q,a)$ by $\\psi(x; q,a)$, quantify the difference $\\psi(x; q,a) - \\theta(x; q,a)$, and evaluate the given statements.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is based entirely on standard, well-established definitions and a major theorem (Siegel-Walfisz) in analytic number theory. All concepts are mathematically rigorous. The problem is scientifically sound.\n- **Well-Posed**: The problem asks for a quantitative analysis of the difference between two well-defined functions and the evaluation of several propositions based on this analysis. This is a clear and well-posed mathematical task.\n- **Objective**: The problem statement uses precise, unambiguous mathematical language and contains no subjective or opinion-based content.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. It is a standard and well-posed question in analytic number theory. I will proceed with deriving a solution and evaluating the options.\n\n### Solution Derivation\n\nThe core of the problem is to analyze the difference $\\psi(x; q,a) - \\theta(x; q,a)$. We begin with the definitions of $\\psi(x; q,a)$ and $\\Lambda(n)$.\n\nThe function $\\psi(x; q,a)$ is the sum of $\\Lambda(n)$ for $n \\le x$ in the arithmetic progression $a \\pmod q$. The von Mangoldt function $\\Lambda(n)$ is non-zero only for integers $n$ that are powers of a prime, i.e., $n=p^k$ for some prime $p$ and integer $k \\ge 1$. Thus, we can write $\\psi(x;q,a)$ as a sum over prime powers:\n$$ \\psi(x; q,a) = \\sum_{\\substack{p^k \\le x \\\\ p^k \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p $$\nWe can split this sum into two parts: the case where the exponent $k=1$ (primes) and the case where $k \\ge 2$ (higher prime powers).\n$$ \\psi(x; q,a) = \\sum_{\\substack{p \\le x \\\\ p \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p + \\sum_{k=2}^{\\infty} \\sum_{\\substack{p^k \\le x \\\\ p^k \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p $$\nThe first term is precisely the definition of $\\theta(x; q,a)$.\n$$ \\psi(x; q,a) = \\theta(x; q,a) + \\sum_{k=2}^{\\infty} \\sum_{\\substack{p^k \\le x \\\\ p^k \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p $$\nTherefore, the difference we need to quantify is the sum over higher prime powers:\n$$ \\psi(x; q,a) - \\theta(x; q,a) = \\sum_{k=2}^{\\infty} \\sum_{\\substack{p^k \\le x \\\\ p^k \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p $$\nThe condition $p^k \\le x$ implies $p \\le x^{1/k}$. Also, for any prime $p \\ge 2$, the condition $2^k \\le x$ implies $k \\le \\log_2 x$. So the sum over $k$ is finite, up to $k = \\lfloor \\log_2 x \\rfloor$.\n\nTo bound this sum, we can drop the congruence condition $p^k \\equiv a \\pmod q$, which will only increase the value of the sum.\n$$ 0 \\le \\psi(x; q,a) - \\theta(x; q,a) \\le \\sum_{k=2}^{\\lfloor \\log_2 x \\rfloor} \\sum_{p \\le x^{1/k}} \\log p $$\nThe inner sum is the classical Chebyshev function $\\theta(x^{1/k})$. It is a well-known consequence of the Prime Number Theorem that $\\theta(y) = O(y)$. More strongly, for all $y \\ge 1$, $\\theta(y)  C y$ for some absolute constant $C$ (e.g., $C=1.02$ works).\n$$ \\psi(x; q,a) - \\theta(x; q,a) \\le \\sum_{k=2}^{\\lfloor \\log_2 x \\rfloor} \\theta(x^{1/k}) = O\\!\\left( \\sum_{k=2}^{\\lfloor \\log_2 x \\rfloor} x^{1/k} \\right) $$\nLet's analyze this sum. We separate the first term ($k=2$) from the rest:\n$$ \\sum_{k=2}^{\\lfloor \\log_2 x \\rfloor} x^{1/k} = x^{1/2} + \\sum_{k=3}^{\\lfloor \\log_2 x \\rfloor} x^{1/k} $$\nThe remaining sum can be bounded:\n$$ \\sum_{k=3}^{\\lfloor \\log_2 x \\rfloor} x^{1/k} \\le x^{1/3} + x^{1/4} + \\dots \\le (\\lfloor \\log_2 x \\rfloor - 2) \\cdot x^{1/3} = O(x^{1/3} \\log x) $$\nThus, the sum is\n$$ O(x^{1/2} + x^{1/3} \\log x) $$\nAs $x \\to \\infty$, the term $x^{1/2}$ dominates $x^{1/3}\\log x$, since $\\lim_{x\\to\\infty} \\frac{x^{1/3} \\log x}{x^{1/2}} = \\lim_{x\\to\\infty} \\frac{\\log x}{x^{1/6}} = 0$.\nSo, we have established the bound:\n$$ \\psi(x; q,a) - \\theta(x; q,a) = O(x^{1/2}) $$\nSince this bound was obtained by dropping all dependence on $q$ and $a$, and the implied constant depends only on the constant in $\\theta(y) = O(y)$, this bound holds uniformly for all $q \\ge 1$ and $a$ with $\\gcd(a,q)=1$, with an absolute implied constant.\n\n### Option-by-Option Analysis\n\n**A. Uniformly in $q \\ge 1$ and $a$ with $\\gcd(a,q)=1$, one has\n$$ \\psi(x; q,a) - \\theta(x; q,a) \\ll x^{1/2}, $$\nwith an absolute implied constant, because only prime powers $p^{k}$ with $k \\ge 2$ contribute and their total weighted contribution by $\\log p$ is $O(x^{1/2})$.**\n\nOur derivation shows that $\\psi(x; q,a) - \\theta(x; q,a)$ is precisely the sum of $\\log p$ over prime powers $p^k$ with $k \\ge 2$. We then showed this sum is bounded by $O(x^{1/2})$, where the bound is uniform and the constant is absolute. The reasoning provided in the option is a correct summary of this derivation.\n**Verdict: Correct**\n\n**B. For any fixed $A0$, if\n$$ \\psi(x; q,a) = \\frac{x}{\\varphi(q)} + O\\!\\left( x \\exp\\!\\big(-c(A)\\sqrt{\\log x}\\big) \\right) $$\nuniformly for $q \\le (\\log x)^{A}$, then\n$$ \\theta(x; q,a) = \\frac{x}{\\varphi(q)} + O\\!\\left( x \\exp\\!\\big(-c'(A)\\sqrt{\\log x}\\big) \\right) $$\nuniformly for $q \\le (\\log x)^{A}$ as well (possibly with a different constant $c'(A)0$), because $\\psi(x; q,a) - \\theta(x; q,a)$ is negligible compared to the Siegel–Walfisz error term.**\n\nWe can write $\\theta(x; q,a)$ as:\n$$ \\theta(x; q,a) = \\psi(x; q,a) - (\\psi(x; q,a) - \\theta(x; q,a)) $$\nSubstituting the Siegel-Walfisz formula for $\\psi(x; q,a)$ and our bound for the difference:\n$$ \\theta(x; q,a) = \\left( \\frac{x}{\\varphi(q)} + O\\!\\left( x \\exp\\!\\big(-c(A)\\sqrt{\\log x}\\big) \\right) \\right) - O(x^{1/2}) $$\nThe error is the sum of two error terms. To verify the claim, we must compare the magnitudes of $x^{1/2}$ and the Siegel-Walfisz error term $E(x) = x \\exp(-c(A)\\sqrt{\\log x})$. Let's examine their ratio:\n$$ \\frac{x^{1/2}}{x \\exp(-c(A)\\sqrt{\\log x})} = x^{-1/2} \\exp(c(A)\\sqrt{\\log x}) = \\exp\\!\\left(-\\frac{1}{2}\\log x + c(A)\\sqrt{\\log x}\\right) $$\nLet $u = \\sqrt{\\log x}$. The exponent is $-\\frac{1}{2}u^2 + c(A)u = u(c(A) - \\frac{1}{2}u)$. As $x \\to \\infty$, $u \\to \\infty$, and the expression $(c(A) - \\frac{1}{2}u)$ goes to $-\\infty$. Thus, the exponent goes to $-\\infty$, and the ratio goes to $0$. This shows that $x^{1/2} = o(x \\exp(-c(A)\\sqrt{\\log x}))$.\nThe term $O(x^{1/2})$ is asymptotically smaller than the Siegel-Walfisz error term and is therefore absorbed into it. The resulting asymptotic formula for $\\theta(x; q,a)$ has the same main term and the same form of error term as for $\\psi(x; q,a)$, possibly requiring an adjustment to the constant $c(A)$. The reasoning that the difference is negligible is correct.\n**Verdict: Correct**\n\n**C. The contribution of prime powers to $\\psi(x; q,a)$ is asymptotically $\\dfrac{x}{\\varphi(q)}$, so replacing $\\theta$ by $\\psi$ changes the main term in the asymptotic for primes in arithmetic progressions.**\n\nThis statement is ambiguous. If \"contribution of prime powers\" means all prime powers ($k \\ge 1$), it refers to $\\psi(x;q,a)$ itself, which is indeed asymptotic to $x/\\varphi(q)$. However, the conclusion \"so replacing $\\theta$ by $\\psi$ changes the main term\" would be a non-sequitur and false, as $\\theta$ and $\\psi$ share the same main term. A more natural interpretation is that \"contribution of prime powers\" refers to the higher prime powers ($k \\ge 2$), which constitutes the difference $\\psi(x;q,a) - \\theta(x;q,a)$. As we've shown, this difference is $O(x^{1/2})$. The main term in the asymptotic is $x/\\varphi(q)$, which is of a much larger order of magnitude. Thus, the contribution of higher prime powers is part of the error term, not the main term. Replacing $\\theta$ by $\\psi$ (or vice versa) does not change the main term. The statement is false under any reasonable interpretation.\n**Verdict: Incorrect**\n\n**D. One has the identity\n$$ \\psi(x; q,a) - \\theta(x; q,a) = \\theta\\!\\left(x^{1/2}; q,a\\right), $$\nsince only prime squares contribute to $\\psi(x; q,a)$ beyond $\\theta(x; q,a)$.**\n\nThis statement is incorrect for two main reasons.\nFirst, the reasoning \"since only prime squares contribute\" is false. The difference includes contributions from all higher prime powers $p^k$ with $k \\ge 2$, such as cubes ($k=3$), fourth powers ($k=4$), and so on.\nSecond, the identity itself is false. The left-hand side is\n$$ \\psi(x; q,a) - \\theta(x; q,a) = \\sum_{k=2}^{\\infty} \\sum_{\\substack{p^k \\le x \\\\ p^k \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p $$\nThe right-hand side is\n$$ \\theta(x^{1/2}; q,a) = \\sum_{\\substack{p \\le x^{1/2} \\\\ p \\equiv a \\, (\\mathrm{mod}\\ q)}} \\log p $$\nEven if we were to ignore the terms for $k\\ge3$ on the LHS, the remaining term for $k=2$ is $\\sum_{p \\le x^{1/2}, \\, p^2 \\equiv a \\pmod q} \\log p$. The congruence condition is $p^2 \\equiv a \\pmod q$, which is in general not the same as $p \\equiv a \\pmod q$. For example, if $q=7, a=2$, then $p^2 \\equiv 2 \\pmod 7$ has solutions $p \\equiv 3 \\pmod 7$ and $p \\equiv 4 \\pmod 7$, neither of which is $p \\equiv 2 \\pmod 7$. Thus, the identity is false.\n**Verdict: Incorrect**\n\n**E. The bound\n$$ \\psi(x; q,a) - \\theta(x; q,a) \\ll \\log x $$\nholds uniformly in $q \\ge 1$ and $a$ with $\\gcd(a,q)=1$ for all $x \\ge 2$.**\n\nAs established in our main derivation and the analysis for option A, $\\psi(x; q,a) - \\theta(x; q,a) = O(x^{1/2})$. Moreover, the main contribution to this difference comes from the sum over prime squares, which is $\\theta(x^{1/2})$ plus contributions from other congruence classes (for $q1$). Since $\\theta(y) \\sim y$, this term is asymptotically proportional to $x^{1/2}$. The function $x^{1/2}$ grows asymptotically faster than $\\log x$. Therefore, the difference cannot be bounded by $O(\\log x)$.\n**Verdict: Incorrect**", "answer": "$$\\boxed{AB}$$", "id": "3021429"}, {"introduction": "Not all Dirichlet characters are fundamental; many are \"imprimitive,\" meaning they are induced by a more basic, primitive character of a smaller modulus known as the conductor. This structural hierarchy is elegantly mirrored in their associated Dirichlet $L$-functions, which differ only by a finite Euler correction factor. This advanced exercise [@problem_id:3021427] provides a concrete opportunity to trace this connection by identifying a character's conductor, constructing its primitive counterpart, and explicitly deriving the analytic relationship between their $L$-functions, thereby deepening your understanding of the interplay between the algebraic and analytic aspects of the theory.", "problem": "Let $q$ be the positive integer $504$, and define a Dirichlet character $\\chi$ modulo $q$ by the following rule: for any integer $n$, set $\\chi(n)=0$ if $\\gcd(n,504)\\neq 1$, and if $\\gcd(n,504)=1$, define $\\chi(n)$ to depend only on the residue class of $n$ modulo $8$ via $\\chi(n)=1$ for $n\\equiv 1,7 \\pmod{8}$ and $\\chi(n)=-1$ for $n\\equiv 3,5 \\pmod{8}$. This defines the unique quadratic character on $(\\mathbb{Z}/8\\mathbb{Z})^{\\times}$ inflated to modulus $504$. Starting from the foundational definitions of Dirichlet characters, conductors, and Dirichlet $L$-functions, identify the conductor $f$ of $\\chi$ and explicitly construct the associated primitive character $\\chi^{\\ast}$ modulo $f$ such that $\\chi$ is the inflation of $\\chi^{\\ast}$ to modulus $504$. Then, using only these foundational definitions and the Euler product for Dirichlet $L$-functions, derive the exact finite Euler correction factor $R(s)$, defined by $R(s)=L(s,\\chi)/L(s,\\chi^{\\ast})$, and simplify $R(s)$ to a single closed-form analytic expression in the complex variable $s$.", "solution": "The problem has been validated and is determined to be a well-posed and scientifically grounded problem in analytic number theory.\n\nThe problem asks for the conductor $f$ of a given Dirichlet character $\\chi$ modulo $q=504$, the explicit form of the associated primitive character $\\chi^{\\ast}$, and the derivation of the Euler correction factor $R(s) = L(s,\\chi)/L(s,\\chi^{\\ast})$.\n\nFirst, we analyze the given character $\\chi$ modulo $q=504$. The modulus is $q = 504 = 8 \\times 63 = 2^3 \\times 3^2 \\times 7$. The character $\\chi$ is defined for an integer $n$ as follows:\n1.  $\\chi(n) = 0$ if $\\gcd(n, 504) \\neq 1$.\n2.  If $\\gcd(n, 504) = 1$, $\\chi(n)$ depends only on the residue class of $n$ modulo $8$. Specifically, $\\chi(n)=1$ if $n\\equiv 1,7 \\pmod{8}$ and $\\chi(n)=-1$ if $n\\equiv 3,5 \\pmod{8}$.\n\nThe fact that $\\chi(n)$ for $\\gcd(n, 504)=1$ depends only on $n \\pmod{8}$ means that $\\chi$ is induced by a character modulo $8$. Let's call this character $\\psi$ on $(\\mathbb{Z}/8\\mathbb{Z})^{\\times}$. The group of units modulo $8$ is $(\\mathbb{Z}/8\\mathbb{Z})^{\\times} = \\{1, 3, 5, 7\\}$. The character $\\psi$ is defined as $\\psi(1)=1$, $\\psi(3)=-1$, $\\psi(5)=-1$, $\\psi(7)=1$. This is a well-defined character, as it is a homomorphism from $(\\mathbb{Z}/8\\mathbb{Z})^{\\times}$ to $\\{\\pm 1\\}$.\n\nThe conductor $f$ of $\\chi$ is the smallest positive integer $d$ for which there exists a character $\\chi'$ modulo $d$ that induces $\\chi$. A character $\\chi$ modulo $q$ is induced by a character $\\chi'$ modulo $d$ (where $d|q$) if $\\chi(n) = \\chi'(n)$ for all $n$ with $\\gcd(n,q)=1$. This implies that for any $n_1, n_2$ with $\\gcd(n_1, q)=\\gcd(n_2, q)=1$ and $n_1 \\equiv n_2 \\pmod{d}$, we must have $\\chi(n_1)=\\chi(n_2)$. The character $\\chi$ is induced by $\\psi$ modulo $8$, so its conductor $f$ must be a divisor of $8$. The divisors of $8$ are $1, 2, 4, 8$.\n\nWe must check if $\\chi$ could be induced by a character modulo a proper divisor of $8$.\n-   A character modulo $1$ or $2$ only depends on whether $n$ is odd, and cannot distinguish between residue classes modulo $8$. $\\chi$ is not the principal character, so $f \\neq 1$.\n-   Let's check if $\\chi$ can be induced by a character modulo $4$. If it could, then for any two integers $n_1, n_2$ that are coprime to $504$ and satisfy $n_1 \\equiv n_2 \\pmod{4}$, we would need to have $\\chi(n_1) = \\chi(n_2)$.\n    Let's find such a pair. We need $n_1, n_2$ to be coprime to $504$, which means they are not divisible by $2, 3, 7$.\n    Consider $n_1 = 11$ and $n_2 = 19$.\n    - $\\gcd(11, 504)=1$ and $\\gcd(19, 504)=1$.\n    - $11 \\equiv 3 \\pmod 4$ and $19 \\equiv 3 \\pmod 4$, so $11 \\equiv 19 \\pmod 4$.\n    - According to the definition of $\\chi$:\n        - $11 \\equiv 3 \\pmod 8$, so $\\chi(11) = -1$.\n        - $19 \\equiv 3 \\pmod 8$, so $\\chi(19) = -1$. This pair is not useful.\n    Let's try another pair. Consider $n_1 = 11$ and $n_2 = 23$.\n    - $\\gcd(11, 504)=1$ and $\\gcd(23, 504)=1$.\n    - $11 \\equiv 3 \\pmod 4$ and $23 \\equiv 3 \\pmod 4$, so $11 \\equiv 23 \\pmod 4$.\n    - According to the definition of $\\chi$:\n        - $11 \\equiv 3 \\pmod 8$, so $\\chi(11) = -1$.\n        - $23 \\equiv 7 \\pmod 8$, so $\\chi(23) = 1$.\n    Since $11 \\equiv 23 \\pmod 4$ but $\\chi(11) \\neq \\chi(23)$, the character $\\chi$ cannot be induced by a character modulo $4$.\nTherefore, the smallest modulus is $8$. The conductor of $\\chi$ is $f=8$.\n\nThe associated primitive character $\\chi^{\\ast}$ is the character modulo the conductor $f=8$ that induces $\\chi$. This is the character $\\psi$ we identified earlier. So, $\\chi^{\\ast}$ is the character modulo $8$ defined by:\n-   $\\chi^{\\ast}(n) = 1$ if $n \\equiv 1, 7 \\pmod{8}$.\n-   $\\chi^{\\ast}(n) = -1$ if $n \\equiv 3, 5 \\pmod{8}$.\n-   $\\chi^{\\ast}(n) = 0$ if $\\gcd(n, 8) \\neq 1$ (i.e., $n$ is even).\nThis is a primitive character because we have shown it cannot be induced from a character of a smaller modulus.\n\nNow, we derive the correction factor $R(s) = L(s,\\chi)/L(s,\\chi^{\\ast})$ using the Euler product representation of Dirichlet $L$-functions. For any character $\\psi$, the $L$-function is given by\n$$L(s, \\psi) = \\prod_{p \\text{ prime}} \\left(1 - \\frac{\\psi(p)}{p^s}\\right)^{-1}$$\nThe ratio $R(s)$ is thus:\n$$R(s) = \\frac{\\displaystyle\\prod_{p} \\left(1 - \\frac{\\chi(p)}{p^s}\\right)^{-1}}{\\displaystyle\\prod_{p} \\left(1 - \\frac{\\chi^{\\ast}(p)}{p^s}\\right)^{-1}} = \\prod_{p} \\frac{1 - \\chi^{\\ast}(p)p^{-s}}{1 - \\chi(p)p^{-s}}$$\nWe analyze the term for each prime $p$.\n-   Case 1: $p$ does not divide $q=504$.\n    In this case, $\\gcd(p, 504) = 1$. By definition, $\\chi(p)$ is given by the value of $\\chi^{\\ast}(p)$. Since $p \\nmid 504$, $p$ is not $2, 3,$ or $7$. In particular, $p \\nmid 8$. So $\\gcd(p, 8)=1$, and $\\chi^{\\ast}(p)$ is non-zero.\n    We have $\\chi(p) = \\chi^{\\ast}(p)$. The term in the product for such a prime is $\\frac{1 - \\chi^{\\ast}(p)p^{-s}}{1 - \\chi^{\\ast}(p)p^{-s}} = 1$.\n\n-   Case 2: $p$ divides $q=504$.\n    The prime divisors of $q=504=2^3 \\cdot 3^2 \\cdot 7$ are $2, 3, 7$. Only these primes can contribute a factor other than $1$.\n    -   For $p=2$:\n        $p=2$ divides $q=504$, so by definition $\\chi(2) = 0$.\n        $p=2$ divides the conductor $f=8$, so by definition $\\chi^{\\ast}(2) = 0$.\n        The factor for $p=2$ is $\\frac{1 - \\chi^{\\ast}(2)2^{-s}}{1 - \\chi(2)2^{-s}} = \\frac{1 - 0}{1 - 0} = 1$.\n    -   For $p=3$:\n        $p=3$ divides $q=504$, so $\\chi(3)=0$.\n        $p=3$ does not divide the conductor $f=8$. So $\\chi^{\\ast}(3)$ is non-zero. Since $3 \\equiv 3 \\pmod 8$, we have $\\chi^{\\ast}(3)=-1$.\n        The factor for $p=3$ is $\\frac{1 - \\chi^{\\ast}(3)3^{-s}}{1 - \\chi(3)3^{-s}} = \\frac{1 - (-1)3^{-s}}{1 - 0} = 1 + 3^{-s}$.\n    -   For $p=7$:\n        $p=7$ divides $q=504$, so $\\chi(7)=0$.\n        $p=7$ does not divide the conductor $f=8$. So $\\chi^{\\ast}(7)$ is non-zero. Since $7 \\equiv 7 \\pmod 8$, we have $\\chi^{\\ast}(7)=1$.\n        The factor for $p=7$ is $\\frac{1 - \\chi^{\\ast}(7)7^{-s}}{1 - \\chi(7)7^{-s}} = \\frac{1 - (1)7^{-s}}{1 - 0} = 1 - 7^{-s}$.\n\nCombining the non-trivial factors, the Euler correction factor $R(s)$ is the product of the factors for $p=3$ and $p=7$:\n$$R(s) = (1 + 3^{-s})(1 - 7^{-s})$$\nThis is the simplified closed-form analytic expression for the correction factor.", "answer": "$$\\boxed{(1 + 3^{-s})(1 - 7^{-s})}$$", "id": "3021427"}]}