{"hands_on_practices": [{"introduction": "This first exercise goes back to the basics to build a solid foundation. By calculating the difference $\\psi(x) - \\vartheta(x)$ directly from the definitions, you will clarify precisely what each function measures. This practice highlights the crucial role of higher prime powers, $p^k$ for $k \\ge 2$, in the structure of $\\psi(x)$, which is essential for understanding its connection to the Riemann zeta function [@problem_id:3029744].", "problem": "Let $x$ be a positive real number and define the von Mangoldt function $\\Lambda(n)$ by $\\Lambda(n) = \\ln p$ if $n$ is an integer power $p^{k}$ of a prime $p$ with $k \\geq 1$, and $\\Lambda(n) = 0$ otherwise. Define the Chebyshev functions $\\vartheta(x)$ and $\\psi(x)$ by\n$$\\vartheta(x) = \\sum_{p \\leq x} \\ln p \\quad \\text{and} \\quad \\psi(x) = \\sum_{n \\leq x} \\Lambda(n),$$\nwhere the first sum is over primes $p$ and the second sum is over positive integers $n$.\n\nStarting solely from these definitions, and without invoking any asymptotic theorems or pre-proved identities, determine the exact value of $\\psi(10000) - \\vartheta(10000)$ by identifying the integers counted by $\\psi(10000)$ but not by $\\vartheta(10000)$. Express your final answer as a single natural logarithm of a product of primes with integer exponents, simplified to one closed-form analytic expression. No numerical approximation is required.", "solution": "The problem requires the exact evaluation of the expression $\\psi(10000) - \\vartheta(10000)$ based solely on the provided definitions of the von Mangoldt function $\\Lambda(n)$ and the Chebyshev functions $\\vartheta(x)$ and $\\psi(x)$.\n\nFirst, let us analyze the definitions provided.\nThe von Mangoldt function, $\\Lambda(n)$, is defined for a positive integer $n$ as:\n$$ \\Lambda(n) = \\begin{cases} \\ln p  \\text{if } n = p^k \\text{ for some prime } p \\text{ and integer } k \\ge 1 \\\\ 0  \\text{otherwise} \\end{cases} $$\nThe Chebyshev functions are defined for a positive real number $x$ as:\n$$ \\vartheta(x) = \\sum_{p \\le x, p \\in \\mathbb{P}} \\ln p $$\n$$ \\psi(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\Lambda(n) $$\nwhere $\\mathbb{P}$ denotes the set of prime numbers.\n\nThe problem asks to determine the value of $\\psi(10000) - \\vartheta(10000)$ by identifying the integers whose contributions are counted in $\\psi(10000)$ but not in $\\vartheta(10000)$.\n\nLet us express $\\psi(x)$ by substituting the definition of $\\Lambda(n)$. The sum is over positive integers $n \\le x$, but the terms $\\Lambda(n)$ are non-zero only when $n$ is a power of a prime number. Therefore, we can write the sum for $\\psi(x)$ over prime powers:\n$$ \\psi(x) = \\sum_{p^k \\le x, p \\in \\mathbb{P}, k \\ge 1} \\ln p $$\nWe can split this sum based on the value of the exponent $k$:\n$$ \\psi(x) = \\sum_{k=1}^{\\infty} \\sum_{p^k \\le x, p \\in \\mathbb{P}} \\ln p $$\nThe sum is finite because for any given $x  1$, the inner sum becomes empty if $2^k  x$, i.e., for $k  \\log_2 x$.\n\nLet's examine the term for $k=1$:\n$$ \\sum_{p^1 \\le x, p \\in \\mathbb{P}} \\ln p = \\sum_{p \\le x, p \\in \\mathbb{P}} \\ln p $$\nThis is precisely the definition of $\\vartheta(x)$.\n\nTherefore, we can write $\\psi(x)$ as:\n$$ \\psi(x) = \\left( \\sum_{p \\le x, p \\in \\mathbb{P}} \\ln p \\right) + \\left( \\sum_{p^2 \\le x, p \\in \\mathbb{P}} \\ln p \\right) + \\left( \\sum_{p^3 \\le x, p \\in \\mathbb{P}} \\ln p \\right) + \\dots $$\n$$ \\psi(x) = \\vartheta(x) + \\sum_{k=2}^{\\infty} \\sum_{p^k \\le x, p \\in \\mathbb{P}} \\ln p $$\n\nThe difference $\\psi(x) - \\vartheta(x)$ is then:\n$$ \\psi(x) - \\vartheta(x) = \\sum_{k=2}^{\\infty} \\sum_{p^k \\le x, p \\in \\mathbb{P}} \\ln p $$\nThe integers counted by $\\psi(x)$ but not by $\\vartheta(x)$ are the higher prime powers, $n = p^k$ where $k \\ge 2$. Each such integer $n \\le x$ contributes a term of $\\Lambda(n) = \\ln p$ to the sum for $\\psi(x)$.\n\nFor the specific problem, we set $x=10000$:\n$$ \\psi(10000) - \\vartheta(10000) = \\sum_{k=2}^{\\infty} \\sum_{p^k \\le 10000, p \\in \\mathbb{P}} \\ln p $$\nThe sum can be regrouped by prime $p$. For each prime $p$, the term $\\ln p$ is added for every integer $k \\ge 2$ such that $p^k \\le 10000$. The number of such values of $k$ for a given prime $p$ is the coefficient of $\\ln p$ in the total sum.\nThe condition $p^k \\le 10000$ is equivalent to $k \\ln p \\le \\ln 10000$, or $k \\le \\log_p(10000)$.\nSince we are summing for $k \\ge 2$, the number of terms for a given prime $p$ is $\\lfloor \\log_p(10000) \\rfloor - 1$. The sum is non-zero only if $\\lfloor \\log_p(10000) \\rfloor \\ge 2$, which implies $p^2 \\le 10000$, so $p \\le \\sqrt{10000} = 100$.\n\nThe total sum is therefore:\n$$ \\psi(10000) - \\vartheta(10000) = \\sum_{p \\le 100, p \\in \\mathbb{P}} (\\lfloor \\log_p(10000) \\rfloor - 1) \\ln p $$\nUsing the property of logarithms, $a \\ln b = \\ln(b^a)$, this can be written as a single natural logarithm:\n$$ \\ln \\left( \\prod_{p \\le 100, p \\in \\mathbb{P}} p^{(\\lfloor \\log_p(10000) \\rfloor - 1)} \\right) $$\nWe now compute the exponents for each prime $p \\le 100$:\n\\begin{itemize}\n    \\item For $p=2$: $\\log_2(10000) = \\frac{\\ln(10000)}{\\ln(2)} \\approx 13.287$. Exponent is $\\lfloor 13.287 \\rfloor - 1 = 13 - 1 = 12$.\n    \\item For $p=3$: $\\log_3(10000) = \\frac{\\ln(10000)}{\\ln(3)} \\approx 8.383$. Exponent is $\\lfloor 8.383 \\rfloor - 1 = 8 - 1 = 7$.\n    \\item For $p=5$: $\\log_5(10000) = \\frac{\\ln(10000)}{\\ln(5)} \\approx 5.722$. Exponent is $\\lfloor 5.722 \\rfloor - 1 = 5 - 1 = 4$.\n    \\item For $p=7$: $\\log_7(10000) = \\frac{\\ln(10000)}{\\ln(7)} \\approx 4.732$. Exponent is $\\lfloor 4.732 \\rfloor - 1 = 4 - 1 = 3$.\n    \\item For primes $p$ where the exponent is $2$: This requires $2 = \\lfloor \\log_p(10000) \\rfloor - 1$, so $3 \\le \\log_p(10000)  4$. This implies $p^3 \\le 10000  p^4$. Taking roots, $p \\le (10000)^{1/3} \\approx 21.54$ and $p  (10000)^{1/4} = 10$. The primes in this range are $11, 13, 17, 19$.\n    \\item For primes $p$ where the exponent is $1$: This requires $1 = \\lfloor \\log_p(10000) \\rfloor - 1$, so $2 \\le \\log_p(10000)  3$. This implies $p^2 \\le 10000  p^3$. Taking roots, $p \\le (10000)^{1/2} = 100$ and $p  (10000)^{1/3} \\approx 21.54$. The primes in this range are $23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97$.\n\\end{itemize}\nCombining these results, the final product inside the logarithm is:\n$$ 2^{12} \\cdot 3^{7} \\cdot 5^{4} \\cdot 7^{3} \\cdot 11^2 \\cdot 13^2 \\cdot 17^2 \\cdot 19^2 \\cdot \\left( \\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p \\right) $$\nThis product represents the exact value requested. The expression is given as a single natural logarithm of this product. Let $\\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p$ denote the product of all prime numbers $p$ such that $23 \\le p \\le 97$.\n\nThe final expression is:\n$$ \\ln \\left( 2^{12} \\cdot 3^7 \\cdot 5^4 \\cdot 7^3 \\cdot 11^2 \\cdot 13^2 \\cdot 17^2 \\cdot 19^2 \\cdot \\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p \\right) $$", "answer": "$$\\boxed{\\ln \\left( 2^{12} \\cdot 3^7 \\cdot 5^4 \\cdot 7^3 \\cdot 11^2 \\cdot 13^2 \\cdot 17^2 \\cdot 19^2 \\cdot \\prod_{\\substack{p \\in \\mathbb{P} \\\\ 23 \\le p \\le 97}} p \\right)}$$", "id": "3029744"}, {"introduction": "The Prime Number Theorem, in its equivalent form $\\psi(n) \\sim n$, is not just a statement about the density of primes; it is a powerful analytical tool. This problem asks you to use this result, in conjunction with the technique of Abel's summation, to determine the asymptotic behavior of a related convolution sum. Mastering this method [@problem_id:393828] is key to analyzing a wide range of sums that appear in analytic number theory.", "problem": "In analytic number theory, the von Mangoldt function, denoted by $\\Lambda(k)$, is an arithmetic function defined for integers $k \\ge 1$. It is defined as $\\Lambda(k) = \\log p$ if $k$ is a power of a prime number $p$, i.e., $k = p^m$ for some prime $p$ and integer $m \\ge 1$, and $\\Lambda(k) = 0$ otherwise. The summatory function of the von Mangoldt function is the Chebyshev function $\\psi(n) = \\sum_{k=1}^{n} \\Lambda(k)$. The Prime Number Theorem is equivalent to the statement that $\\psi(n) \\sim n$ as $n \\to \\infty$.\n\nConsider the convolution sum $S_n(\\alpha)$ defined as:\n$$S_n(\\alpha) = \\sum_{k=1}^{n-1} \\Lambda(k)(n-k)^{-\\alpha}$$\nwhere $\\alpha$ is a fixed real parameter in the range $0  \\alpha  1$.\n\nFor large $n$, this sum exhibits the asymptotic behavior $S_n(\\alpha) \\sim C n^{1-\\alpha}$ for some constant $C$ that depends on $\\alpha$.\nDerive the value of this constant $C$.", "solution": "We are asked to find the constant $C$ in the asymptotic formula $S_n(\\alpha) \\sim C n^{1-\\alpha}$ for the sum $S_n(\\alpha) = \\sum_{k=1}^{n-1} \\Lambda(k)(n-k)^{-\\alpha}$. We can determine this by applying Abel's summation formula (also known as partial summation).\n\nAbel's summation formula states that for a sequence of numbers $(a_k)$ and a continuously differentiable function $f(t)$,\n$$ \\sum_{k=1}^{N} a_k f(k) = A(N)f(N) - \\int_1^N A(t)f'(t)dt $$\nwhere $A(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} a_k$.\n\nIn our problem, we have $a_k = \\Lambda(k)$ and $f(k) = (n-k)^{-\\alpha}$. The sum is up to $N=n-1$.\nThe summatory function is $A(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\Lambda(k) = \\psi(x)$.\nThe function $f(t)$ is $f(t) = (n-t)^{-\\alpha}$. Its derivative with respect to $t$ is:\n$$ f'(t) = \\frac{d}{dt}(n-t)^{-\\alpha} = (-\\alpha)(n-t)^{-\\alpha-1}(-1) = \\alpha(n-t)^{-\\alpha-1} $$\n\nApplying the summation formula to $S_n(\\alpha)$:\n$$ S_n(\\alpha) = \\sum_{k=1}^{n-1} \\Lambda(k)(n-k)^{-\\alpha} = \\psi(n-1)f(n-1) - \\int_1^{n-1} \\psi(t)f'(t)dt $$\nSubstituting the expressions for $f(n-1)$ and $f'(t)$:\n$$ S_n(\\alpha) = \\psi(n-1)(n-(n-1))^{-\\alpha} - \\int_1^{n-1} \\psi(t) \\alpha(n-t)^{-\\alpha-1}dt $$\n$$ S_n(\\alpha) = \\psi(n-1) \\cdot 1^{-\\alpha} - \\alpha \\int_1^{n-1} \\psi(t)(n-t)^{-\\alpha-1}dt = \\psi(n-1) - \\alpha \\int_1^{n-1} \\psi(t)(n-t)^{-\\alpha-1}dt $$\n\nTo find the leading asymptotic behavior, we use the Prime Number Theorem in the form $\\psi(t) = t + E(t)$, where $E(t)=o(t)$ is an error term.\n$$ S_n(\\alpha) = (n-1+E(n-1)) - \\alpha \\int_1^{n-1} (t+E(t))(n-t)^{-\\alpha-1}dt $$\nWe can split this into a main part and a remainder part.\n$$ S_n(\\alpha) = \\left[ (n-1) - \\alpha \\int_1^{n-1} t(n-t)^{-\\alpha-1}dt \\right] + \\left[ E(n-1) - \\alpha \\int_1^{n-1} E(t)(n-t)^{-\\alpha-1}dt \\right] $$\nLet's evaluate the main part first. The integral is:\n$$ I = \\int_1^{n-1} t(n-t)^{-\\alpha-1}dt $$\nWe use the substitution $u = n-t$, which means $t = n-u$ and $dt = -du$. The limits of integration become $u=n-1$ when $t=1$, and $u=1$ when $t=n-1$.\n$$ I = \\int_{n-1}^{1} (n-u)u^{-\\alpha-1}(-du) = \\int_{1}^{n-1} (nu^{-\\alpha-1} - u^{-\\alpha})du $$\n$$ I = \\left[ n\\frac{u^{-\\alpha}}{-\\alpha} - \\frac{u^{1-\\alpha}}{1-\\alpha} \\right]_1^{n-1} = \\left[ -\\frac{n}{\\alpha}u^{-\\alpha} - \\frac{u^{1-\\alpha}}{1-\\alpha} \\right]_1^{n-1} $$\n$$ I = \\left( -\\frac{n}{\\alpha}(n-1)^{-\\alpha} - \\frac{(n-1)^{1-\\alpha}}{1-\\alpha} \\right) - \\left( -\\frac{n}{\\alpha}(1)^{-\\alpha} - \\frac{(1)^{1-\\alpha}}{1-\\alpha} \\right) $$\n$$ I = \\frac{n}{\\alpha} + \\frac{1}{1-\\alpha} - \\frac{n}{\\alpha}(n-1)^{-\\alpha} - \\frac{(n-1)^{1-\\alpha}}{1-\\alpha} $$\nThe main part of $S_n(\\alpha)$ is thus:\n$$ S_{n, \\text{main}} = (n-1) - \\alpha I = (n-1) - \\alpha \\left(\\frac{n}{\\alpha} + \\frac{1}{1-\\alpha} - \\frac{n}{\\alpha}(n-1)^{-\\alpha} - \\frac{(n-1)^{1-\\alpha}}{1-\\alpha}\\right) $$\n$$ S_{n, \\text{main}} = n-1 - n - \\frac{\\alpha}{1-\\alpha} + n(n-1)^{-\\alpha} + \\frac{\\alpha(n-1)^{1-\\alpha}}{1-\\alpha} $$\n$$ S_{n, \\text{main}} = n(n-1)^{-\\alpha} + \\frac{\\alpha}{1-\\alpha}(n-1)^{1-\\alpha} - 1 - \\frac{\\alpha}{1-\\alpha} = n(n-1)^{-\\alpha} + \\frac{\\alpha}{1-\\alpha}(n-1)^{1-\\alpha} - \\frac{1}{1-\\alpha} $$\nNow we find the asymptotic behavior of this expression for large $n$. We use the binomial approximation $(1-x)^p \\approx 1-px$ for small $x$.\n$$ (n-1)^{-\\alpha} = n^{-\\alpha}(1-1/n)^{-\\alpha} \\approx n^{-\\alpha}(1+\\alpha/n) = n^{-\\alpha} + \\alpha n^{-\\alpha-1} $$\n$$ (n-1)^{1-\\alpha} = n^{1-\\alpha}(1-1/n)^{1-\\alpha} \\approx n^{1-\\alpha}(1-(1-\\alpha)/n) = n^{1-\\alpha} - (1-\\alpha)n^{-\\alpha} $$\nSubstituting these into the expression for $S_{n, \\text{main}}$:\n$$ S_{n, \\text{main}} \\approx n(n^{-\\alpha} + \\alpha n^{-\\alpha-1}) + \\frac{\\alpha}{1-\\alpha}(n^{1-\\alpha} - (1-\\alpha)n^{-\\alpha}) - \\frac{1}{1-\\alpha} $$\n$$ S_{n, \\text{main}} \\approx (n^{1-\\alpha} + \\alpha n^{-\\alpha}) + (\\frac{\\alpha}{1-\\alpha}n^{1-\\alpha} - \\alpha n^{-\\alpha}) - \\frac{1}{1-\\alpha} $$\n$$ S_{n, \\text{main}} \\approx \\left(1 + \\frac{\\alpha}{1-\\alpha}\\right)n^{1-\\alpha} + (\\alpha-\\alpha)n^{-\\alpha} - \\frac{1}{1-\\alpha} $$\n$$ S_{n, \\text{main}} \\approx \\left(\\frac{1-\\alpha+\\alpha}{1-\\alpha}\\right)n^{1-\\alpha} - \\frac{1}{1-\\alpha} = \\frac{1}{1-\\alpha}n^{1-\\alpha} - \\frac{1}{1-\\alpha} $$\nThe leading term is $\\frac{1}{1-\\alpha}n^{1-\\alpha}$.\n\nThe remainder part is $R_n = E(n-1) - \\alpha \\int_1^{n-1} E(t)(n-t)^{-\\alpha-1}dt$. Using known bounds on the error term $E(t)$ of the Prime Number Theorem (e.g., $E(t)=O(t/\\log^A t)$ for any $A0$), it can be shown that $R_n=o(n^{1-\\alpha})$. Therefore, the contribution from the error term does not affect the leading asymptotic behavior of $S_n(\\alpha)$.\n\nThus, the asymptotic behavior of $S_n(\\alpha)$ is given by the main part:\n$$ S_n(\\alpha) \\sim \\frac{1}{1-\\alpha}n^{1-\\alpha} $$\nBy comparing this with the given form $S_n(\\alpha) \\sim C n^{1-\\alpha}$, we can identify the constant $C$.\n$$ C = \\frac{1}{1-\\alpha} $$", "answer": "$$ \\boxed{\\frac{1}{1-\\alpha}} $$", "id": "393828"}, {"introduction": "We culminate with the celebrated explicit formula, which provides a direct bridge between the distribution of prime numbers and the zeros of the Riemann zeta function. This computational exercise makes the abstract formula concrete by tasking you with estimating $\\psi(x)$ using a finite number of zeta zeros. By comparing your approximation with the true value, you will gain a tangible appreciation for how the main term $x$ is refined by an oscillating wave arising from the complex zeros, revealing the deep harmony in the \"music of the primes\" [@problem_id:3029734].", "problem": "You are to implement a complete, runnable program that estimates the second Chebyshev function $\\psi(x)$ using an explicit formula derived from fundamental definitions, and compares this explicit-formula estimate against the exact arithmetic sum definition and against $x$. The explicit formula should be derived from first principles and implemented in a truncated, numerically stable form using a finite set of known nontrivial zeros of the Riemann zeta function $\\zeta(s)$.\n\nFundamental base:\n- Define the von Mangoldt function $\\Lambda(n)$ by $\\Lambda(n) = \\log p$ if $n = p^k$ for a prime $p$ and integer $k \\geq 1$, and $\\Lambda(n) = 0$ otherwise.\n- Define the second Chebyshev function $\\psi(x)$ by $\\psi(x) = \\sum_{n \\leq x} \\Lambda(n)$ for real $x \\geq 1$.\n- Define the Riemann zeta function $\\zeta(s)$ for $\\operatorname{Re}(s)  1$ using its Euler product and Dirichlet series, and recall the well-tested identity for $\\operatorname{Re}(s)  1$ connecting the logarithmic derivative to the von Mangoldt function,\n$$\n-\\frac{\\zeta'(s)}{\\zeta(s)} = \\sum_{n=1}^{\\infty} \\frac{\\Lambda(n)}{n^s}.\n$$\n- Recall the analyticity structure of $\\zeta(s)$: a simple pole at $s=1$ with residue $1$, trivial zeros at negative even integers $s=-2,-4,\\dots$, and nontrivial zeros $\\rho$ in the critical strip $0  \\operatorname{Re}(s)  1$. You may assume that the first several nontrivial zeros lie on the critical line $\\operatorname{Re}(\\rho)=\\tfrac{1}{2}$ and are known to high precision.\n\nTask:\n1. Starting from the identity for $-\\zeta'(s)/\\zeta(s)$, derive an explicit formula expression for a smoothed version of $\\psi(x)$ in terms of $x$ and contributions from the singularities of $-\\zeta'(s)/\\zeta(s)$ obtained via Perron's formula and contour shifting. Your derivation must identify separately the contribution from:\n   - the pole at $s=1$,\n   - the nontrivial zeros $\\rho$ of $\\zeta(s)$,\n   - the trivial zeros at negative even integers,\n   - and the term coming from $s=0$ as determined by the functional equation and the analyticity of $\\zeta(s)$.\n   Reformulate this into a truncation that can be implemented numerically using a finite set of nontrivial zeros.\n\n2. Implement two functions for integer inputs $x \\geq 2$:\n   - An exact computation of $\\psi(x)$ by the sum $\\sum_{n \\leq x} \\Lambda(n)$. For practicality, structure this as a sum over prime powers: for each prime $p \\leq x$, include $\\log p$ once for each exponent $k \\geq 1$ with $p^k \\leq x$.\n   - A truncated explicit-formula estimate of the smoothed $\\psi(x)$ using the first $K$ nontrivial zeros $\\rho$ listed by their imaginary parts $\\gamma$ where $\\rho=\\tfrac{1}{2} \\pm i\\gamma$, together with the contributions from the trivial zeros and the constant term identified in your derivation. Implement the sum over zeros in a numerically stable manner by pairing conjugate zeros.\n\n3. Use the following finite set of imaginary parts of the first nontrivial zeros of $\\zeta(s)$ for your truncated sum (units are dimensionless as these are arguments of complex zeros): \n   $[14.134725141734693, 21.022039638771556, 25.010857580145688, 30.424876125859513, 32.935061587739190, 37.586178158825671, 40.918719012147495, 43.327073281693326, 48.005150881167159, 49.773832477672302, 52.970321477714460, 56.446247697063394, 59.347044002602353, 60.831778524609810, 65.112544048082656, 67.079810529494173, 69.546401711173, 72.06715767448191]$.\n\n4. Design the output to compare $\\psi(x)$ with $x$ and to assess the explicit-formula approximation. For each test case $x$, compute and return the list $[x, \\psi(x) - x, \\widehat{\\psi}(x) - x, |\\widehat{\\psi}(x) - \\psi(x)|]$, where $\\widehat{\\psi}(x)$ denotes your truncated explicit-formula estimate for the smoothed $\\psi(x)$.\n\nTest suite:\n- Use the following integer values of $x$ to assess your implementation:\n  - $x = 1000$ (baseline moderate value),\n  - $x = 10000$ (larger value),\n  - $x = 100000$ (happy path, larger scale),\n  - $x = 131072$ (boundary case: a prime power, $2^{17}$),\n  - $x = 999983$ (near one million, a large prime),\n  - $x = 1000000$ (edge of the moderate range).\n\nAnswer format:\n- Your program should produce a single line of output containing the results for the test suite as a comma-separated list enclosed in square brackets. Each element of this top-level list is itself a list in the form $[x, \\psi(x) - x, \\widehat{\\psi}(x) - x, |\\widehat{\\psi}(x) - \\psi(x)|]$. For example, the output must look like:\n  \"[[x1,exact_minus_x1,approx_minus_x1,error1],[x2,exact_minus_x2,approx_minus_x2,error2],...]\".", "solution": "We begin from the foundational identity valid for $\\operatorname{Re}(s)  1$:\n$$\n-\\frac{\\zeta'(s)}{\\zeta(s)} = \\sum_{n=1}^{\\infty} \\frac{\\Lambda(n)}{n^s}.\n$$\nBy Perron's formula, for $x \\geq 2$, one can write a smoothed version of the summatory function of $\\Lambda(n)$ as a complex integral of $-\\zeta'(s)/\\zeta(s)$ against $x^s/s$. A standard approach is to consider\n$$\nI(x; c,T) = \\frac{1}{2\\pi i}\\int_{c-iT}^{c+iT} -\\frac{\\zeta'(s)}{\\zeta(s)} \\frac{x^s}{s}\\, ds,\n$$\nwith $c1$, and then shift the contour leftwards to a vertical line with $\\operatorname{Re}(s)  0$, collecting residues from the singularities of $-\\zeta'(s)/\\zeta(s) \\cdot x^s/s$. The function $-\\zeta'(s)/\\zeta(s)$ has the following singular structure:\n- A simple pole at $s=1$ with residue $1$ (coming from the simple pole of $\\zeta(s)$),\n- Simple poles at the nontrivial zeros $s=\\rho$ of $\\zeta(s)$, each contributing a residue of $-1$ in $-\\zeta'/\\zeta$,\n- Simple poles at trivial zeros $s=-2,-4,-6,\\dots$,\n- A regular point at $s=0$, but a nontrivial contribution arises upon considering the functional equation to evaluate constants.\n\nShifting the contour and summing residues produces the Riemann explicit formula for the smoothed second Chebyshev function,\n$$\n\\psi_0(x) = x - \\sum_{\\rho} \\frac{x^{\\rho}}{\\rho} - \\log(2\\pi) - \\frac{1}{2}\\log\\!\\left(1 - \\frac{1}{x^2}\\right),\n$$\nwhere $\\psi_0(x)$ denotes the symmetric average at discontinuities,\n$$\n\\psi_0(x) = \\frac{1}{2}\\left(\\lim_{\\varepsilon\\to 0^+} \\psi(x+\\varepsilon) + \\lim_{\\varepsilon\\to 0^+} \\psi(x-\\varepsilon)\\right).\n$$\nThe term $x$ is the residue contribution from the pole at $s=1$. The sum $\\sum_{\\rho} x^{\\rho}/\\rho$ is over all nontrivial zeros $\\rho$ of $\\zeta(s)$ and comes from the residues at $s=\\rho$. The constant $-\\log(2\\pi)$ can be derived using the functional equation for $\\zeta(s)$ and carefully accounting for the contribution near $s=0$. The term $-\\tfrac{1}{2}\\log(1-1/x^2)$ arises from the trivial zeros at the negative even integers via a geometric series identity in the contour calculation.\n\nA numerically implementable truncation uses only finitely many nontrivial zeros. Pairing complex conjugate zeros (which come as $\\rho=\\tfrac{1}{2} \\pm i\\gamma$ for $\\gamma0$ under the Riemann hypothesis, though pairing works in general by conjugacy) yields\n$$\n\\sum_{\\rho} \\frac{x^\\rho}{\\rho} = 2\\sum_{\\gamma0} \\operatorname{Re}\\left( \\frac{x^{\\frac{1}{2}+i\\gamma}}{\\frac{1}{2}+i\\gamma} \\right),\n$$\nwhere $x^{\\frac{1}{2}+i\\gamma} = x^{1/2} e^{i\\gamma \\log x}$. Truncating to the first $K$ values of $\\gamma$ gives\n$$\n\\widehat{\\psi}_0(x) = x - 2\\sum_{k=1}^{K} \\operatorname{Re}\\left( \\frac{x^{\\frac{1}{2}+i\\gamma_k}}{\\frac{1}{2}+i\\gamma_k} \\right) - \\log(2\\pi) - \\frac{1}{2}\\log\\!\\left(1 - \\frac{1}{x^2}\\right).\n$$\nThis provides a practical estimator when $x$ is moderately large. The truncation error behaves roughly like $O\\!\\left(\\frac{\\sqrt{x}}{\\gamma_{K}}\\right)$ per omitted zero in magnitude, so including more zeros improves accuracy as $x$ grows. Note that $\\psi(x)$ is a step function with jumps of size $\\Lambda(p^k)$ at prime powers $p^k$, while $\\psi_0(x)$ is the symmetric average at jumps. Therefore, even with many zeros, a discrepancy of up to about $\\tfrac{1}{2}\\Lambda(p^k)$ is expected near $x$ exactly equal to a prime power.\n\nExact arithmetic computation of $\\psi(x)$ can be organized as a sum over prime powers:\n$$\n\\psi(x) = \\sum_{p \\le x} \\left\\lfloor \\frac{\\log x}{\\log p} \\right\\rfloor \\log p,\n$$\nwhich counts $\\log p$ once for each exponent $k$ such that $p^k \\le x$. Algorithmically, it is cleaner to iterate powers: for each prime $p\\le x$, count how many times $p, p^2, p^3, \\dots$ are $\\le x$.\n\nAlgorithmic design:\n- Exact $\\psi(x)$:\n  1. Generate all primes $\\le x$ with the Sieve of Eratosthenes.\n  2. For each prime $p$, iterate $m=p, p^2, \\dots$ while $m \\le x$ and accumulate $\\log p$ once for each $m$ (which counts the contribution of $\\Lambda(m)$).\n- Truncated explicit-formula estimate:\n  1. Preload a list of the first $K$ imaginary parts $\\gamma_k$ of nontrivial zeros.\n  2. Compute the sum $2\\sum_{k=1}^{K} \\operatorname{Re}\\left( x^{\\frac{1}{2}+i\\gamma_k}/(\\frac{1}{2}+i\\gamma_k) \\right)$ using complex arithmetic, which is numerically stable because $|x^{\\frac{1}{2}+i\\gamma}|=x^{1/2}$ and division by $\\frac{1}{2}+i\\gamma$ damps by $|\\frac{1}{2}+i\\gamma|$.\n  3. Form $\\widehat{\\psi}_0(x)$ by adding the pole term $x$ and subtracting the zeros sum, the constant $-\\log(2\\pi)$, and the trivial-zeros term $-\\tfrac{1}{2}\\log(1-1/x^2)$ as derived.\n- Comparison metrics:\n  1. Compute $\\psi(x)-x$ and $\\widehat{\\psi}_0(x)-x$.\n  2. Report the absolute error $|\\widehat{\\psi}_0(x)-\\psi(x)|$.\n\nThe provided test suite spans:\n- A baseline moderate value $x=1000$,\n- Larger values $x=10000$ and $x=100000$,\n- A prime-power boundary case $x=131072=2^{17}$ where $\\psi(x)$ has a jump,\n- A large prime $x=999983$ near $10^6$,\n- An edge of the moderate range $x=1000000$.\n\nThe final program should print a single line that is a comma-separated list of the lists $[x, \\psi(x) - x, \\widehat{\\psi}(x) - x, |\\widehat{\\psi}(x) - \\psi(x)|]$ for each test case, enclosed in square brackets, with no extra text. This line is the only output produced by the program. No physical units apply here; all quantities are dimensionless real numbers.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\nimport cmath\n\ndef primes_upto(n: int):\n    \"\"\"Return list of primes up to n using a memory-efficient sieve.\"\"\"\n    if n  2:\n        return []\n    sieve = bytearray(b'\\x01') * (n + 1)\n    sieve[0:2] = b'\\x00\\x00'\n    limit = int(n**0.5)\n    for i in range(2, limit + 1):\n        if sieve[i]:\n            step = i\n            start = i * i\n            sieve[start:n+1:step] = b'\\x00' * (((n - start) // step) + 1)\n    return [i for i in range(2, n + 1) if sieve[i]]\n\ndef psi_exact(x: int) - float:\n    \"\"\"Compute psi(x) = sum_{n = x} Lambda(n) exactly via prime powers.\"\"\"\n    primes = primes_upto(x)\n    total = 0.0\n    for p in primes:\n        # Count contributions for prime powers p^k = x\n        m = p\n        logp = math.log(p)\n        while m = x:\n            total += logp\n            # Prevent overflow in multiplication for very large p (not relevant here)\n            if x // p  m: # m*p would overflow or be > x\n                break\n            m *= p\n    return total\n\ndef psi_explicit_approx(x: int, gammas: list[float]) - float:\n    \"\"\"\n    Truncated explicit formula approximation for the smoothed psi(x):\n    psi0(x) â‰ˆ x - 2 * sum_{gamma0} Re( x^{1/2 + i gamma} / (1/2 + i gamma) )\n             - log(2*pi) - (1/2) * log(1 - x^{-2}).\n    \"\"\"\n    # Sum over paired zeros (use only positive gamma and double the real part)\n    sum_zeros = 0.0\n    ln_x = math.log(x)\n    for g in gammas:\n        denom = complex(0.5, g)\n        # x^{1/2 + i g} = x**0.5 * exp(i g log x)\n        x_rho = complex(x**0.5, 0.0) * cmath.exp(1j * g * ln_x)\n        term = x_rho / denom\n        sum_zeros += 2.0 * term.real\n    # Constant and trivial zeros contributions\n    const_term = math.log(2.0 * math.pi)\n    trivial_term = 0.5 * math.log(1.0 - (1.0 / (x * x)))\n    # Assemble approximation\n    psi0_hat = x - sum_zeros - const_term - trivial_term\n    return psi0_hat\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        1000,\n        10000,\n        100000,\n        131072,  # 2^17, prime-power boundary case\n        999983,  # a large prime near 1e6\n        1000000\n    ]\n\n    # Imaginary parts of the first several nontrivial zeros of zeta(s).\n    gammas = [\n        14.134725141734693,\n        21.022039638771556,\n        25.010857580145688,\n        30.424876125859513,\n        32.935061587739190,\n        37.586178158825671,\n        40.918719012147495,\n        43.327073281693326,\n        48.005150881167159,\n        49.773832477672302,\n        52.970321477714460,\n        56.446247697063394,\n        59.347044002602353,\n        60.831778524609810,\n        65.112544048082656,\n        67.079810529494173,\n        69.546401711173,\n        72.06715767448191,\n    ]\n\n    results = []\n    for x in test_cases:\n        psi_x = psi_exact(x)\n        psi_hat = psi_explicit_approx(x, gammas)\n        exact_minus_x = psi_x - x\n        approx_minus_x = psi_hat - x\n        abs_err = abs(psi_hat - psi_x)\n        results.append([x, exact_minus_x, approx_minus_x, abs_err])\n\n    # Final print statement in the exact required format.\n    # Single line with list of lists.\n    print(f\"[{','.join(str(item) for item in results)}]\")\n\nsolve()\n```", "id": "3029734"}]}