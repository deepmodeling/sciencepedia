{"hands_on_practices": [{"introduction": "The Tate-Shafarevich group, $\\Sha(E/\\mathbb{Q})$, formalizes the failure of the Hasse or 'local-to-global' principle for elliptic curves. This principle holds if the existence of points in every local field ($\\mathbb{R}$ and all $\\mathbb{Q}_p$) guarantees the existence of a rational point. This first practice provides a direct, computational experience with this concept, tasking you to examine specific genus one curves that represent potential elements of $\\Sha(E/\\mathbb{Q})$. By experimentally testing for local and global solutions, you will gain a concrete intuition for what it means for a curve to be a 'counterexample' to the Hasse principle. [@problem_id:3029554]", "problem": "Let $E/\\mathbb{Q}$ be an elliptic curve, and let the Tate-Shafarevich group (often denoted by the Cyrillic letter $\\Sha$) be the group of isomorphism classes of principal homogeneous spaces under $E$ that are locally trivial over all completions of $\\mathbb{Q}$. A principal homogeneous space $C$ for $E$ is a smooth, projective, geometrically integral curve over $\\mathbb{Q}$ with a simply transitive action of $E$ defined over $\\mathbb{Q}$. By definition, an element $[C] \\in \\Sha(E/\\mathbb{Q})$ is represented by a curve $C$ that has a point over every completion $\\mathbb{Q}_v$ of $\\mathbb{Q}$ (that is, $C(\\mathbb{Q}_v) \\neq \\emptyset$ for all places $v$), but has no rational point over $\\mathbb{Q}$.\n\nThis problem asks you to experimentally and numerically study local solubility and rational solubility for a small family of genus one curves that arise naturally in descent computations:\n- Diagonal cubic torsors of the form $a x^3 + b y^3 + c z^3 = 0$, which are smooth plane cubics when $a,b,c \\in \\mathbb{Z}$ are nonzero and suitably chosen, and\n- Binary quartic torsors of the form $u^2 = d x^4 + e x^2 + f$, which are smooth projective genus one curves when the quartic on the right-hand side has distinct roots over $\\overline{\\mathbb{Q}}$.\n\nYour program must implement the following principle-based experimental procedure:\n1. Base definitions and criteria:\n   - Local fields and local points: For a place $v$ of $\\mathbb{Q}$, a curve $C$ is locally soluble at $v$ if $C(\\mathbb{Q}_v) \\neq \\emptyset$, where $\\mathbb{Q}_\\infty = \\mathbb{R}$ and for a prime $p$, $\\mathbb{Q}_p$ is the field of $p$-adic numbers.\n   - Local solubility via congruences: A necessary condition for $C(\\mathbb{Q}_p) \\neq \\emptyset$ is the existence of solutions modulo $p^n$ for all $n$, and a sufficient condition is the existence of a nonsingular solution modulo $p$, which lifts to a solution over $\\mathbb{Q}_p$ by Hensel’s lemma. In numerical experiments, testing solutions modulo $p$ and $p^2$ at a finite set of primes provides strong evidence for local solubility.\n   - Real solubility: For diagonal cubic $a x^3 + b y^3 + c z^3 = 0$, exhibit real solutions by sign cancellation using the odd power property of cubes when at least two coefficients are nonzero. For binary quartics $u^2 = d x^4 + e x^2 + f$, analyze the real polynomial $g(x) = d x^4 + e x^2 + f$. If $d > 0$, then $g(x) \\to +\\infty$ as $|x| \\to \\infty$, so $g$ attains arbitrarily large positive values and $C(\\mathbb{R}) \\neq \\emptyset$. If $d < 0$, then $g$ attains a finite supremum; compute the supremum by critical points of $g(x)$ using $g'(x) = 4 d x^3 + 2 e x$. If $\\sup_{x \\in \\mathbb{R}} g(x) < 0$, then $C(\\mathbb{R}) = \\emptyset$.\n   - Rational solubility: A rational point on $a x^3 + b y^3 + c z^3 = 0$ corresponds to a nontrivial integer solution $(x,y,z) \\in \\mathbb{Z}^3 \\setminus \\{(0,0,0)\\}$ up to scaling, and for $u^2 = d x^4 + e x^2 + f$ corresponds to integer $(x,u)$ solving $u^2 = d x^4 + e x^2 + f$.\n\n2. Algorithmic tasks for each input curve $C$:\n   - Real place test: Implement a criterion for $C(\\mathbb{R}) \\neq \\emptyset$ as above. If $C(\\mathbb{R}) = \\emptyset$, then $C$ is not locally soluble everywhere; classify this case immediately as not in $\\Sha$.\n   - Finite place tests: For each prime $p$ in a specified finite set, test the existence of solutions modulo $p$ and modulo $p^2$.\n     - For $a x^3 + b y^3 + c z^3 = 0$ modulo $p^n$, search for solutions by enumerating $x,y$ to form the set of residues $a x^3 + b y^3 \\pmod{p^n}$ and check membership of $-c z^3$ in this set for some $z$. Record any solution and check nonsingularity at modulo $p$ by verifying the gradient $$(3 a x^2, 3 b y^2, 3 c z^2) \\not\\equiv (0,0,0) \\pmod{p}.$$ If a nonsingular solution modulo $p$ exists, local solubility over $\\mathbb{Q}_p$ follows; otherwise, in practice also accept the existence of solutions modulo $p^2$ as evidence supporting local solubility.\n     - For $u^2 = d x^4 + e x^2 + f$ modulo $p^n$, enumerate $x$ and check whether $d x^4 + e x^2 + f$ is a square modulo $p^n$. For nonsingularity modulo $p$, verify $$(2 u, - (4 d x^3 + 2 e x)) \\not\\equiv (0,0) \\pmod{p}.$$ As above, accept solutions modulo $p^2$ as experimental evidence of local solubility.\n   - Rational search: Perform a bounded exhaustive search for small integer solutions:\n     - For diagonal cubics, search $(x,y,z)$ with $|x|,|y|,|z| \\leq B$ for some bound $B$ (exclude $(0,0,0)$) and check $a x^3 + b y^3 + c z^3 = 0$.\n     - For quartics, search $(x,u)$ with $|x|,|u| \\leq B$ and check $u^2 = d x^4 + e x^2 + f$.\n     - If such a solution is found, record rational solubility.\n\n3. Classification rule:\n   - Output $0$ if local solubility fails at any tested place (including the real place).\n   - Output $1$ if a rational point is found (within the given bound), which certifies global solubility.\n   - Output $2$ if the curve is locally soluble at all tested places but no rational point is found within the given bound. This outcome identifies the curve as an experimental “candidate” element of $\\Sha$, recognizing that this is only numerical evidence and not a proof.\n\nYou must implement this for the following test suite, which is designed to exercise different behaviors:\n- Test case 1 (diagonal cubic, easy rational point): $a=1$, $b=1$, $c=-1$; search bound $B=60$; primes $\\{2,3,5,7,11\\}$.\n- Test case 2 (diagonal cubic, classical locally soluble torsor): $a=3$, $b=4$, $c=5$ (Selmer’s cubic); search bound $B=120$; primes $\\{2,3,5,7,11\\}$.\n- Test case 3 (binary quartic, real obstruction): $d=-1$, $e=0$, $f=-1$; search bound $B=80$; primes $\\{2,3,5,7,11\\}$.\n- Test case 4 (binary quartic, obvious rational point): $d=1$, $e=-5$, $f=4$; search bound $B=80$; primes $\\{2,3,5,7,11\\}$.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[result1,result2,result3,result4]\"). Each result must be an integer in $\\{0,1,2\\}$ following the classification rule above. No physical units or angle units apply, and all numerical values are dimensionless.", "solution": "The problem requires an experimental procedure to classify genus one curves of two specific forms—diagonal cubics and binary quartics—based on their solubility properties over the real numbers, p-adic numbers, and rational numbers. The classification serves as a numerical analogue for determining whether a curve represents a trivial element, a non-trivial element of the Tate-Shafarevich group ($\\Sha$), or is obstructed from being in $\\Sha$ due to local insolubility.\n\nA curve $C$ represents an element of $\\Sha(E/\\mathbb{Q})$ if it has points in every completion $\\mathbb{Q}_v$ (i.e., it is *locally soluble*), but has no points in $\\mathbb{Q}$ (i.e., it is not *globally soluble*). Our task is to implement an algorithm that tests these properties for a given set of curves and returns a classification:\n- $0$: The curve is not locally soluble at some tested place (real or p-adic).\n- $1$: The curve is globally soluble (a rational point is found).\n- $2$: The curve appears to be locally soluble at all tested places, but no rational point is found within a specified search bound. This identifies experimental candidates for non-trivial elements of $\\Sha$.\n\nThe algorithm is implemented by creating distinct procedures for the two types of curves provided.\n\n### Diagonal Cubic: $ax^3 + by^3 + cz^3 = 0$\n\n1.  **Real Solubility Test ($C(\\mathbb{R}) \\neq \\emptyset$)**: For non-zero integer coefficients $a$, $b$, and $c$, the equation $ax^3 + by^3 + cz^3 = 0$ always possesses a non-trivial real solution. This is because the function $f(t) = t^3$ is surjective from $\\mathbb{R}$ to $\\mathbb{R}$. For instance, one can fix non-zero real values for $y$ and $z$, say $y_0$ and $z_0$, and solve for $x$ via $x = \\sqrt[3]{(-by_0^3 - cz_0^3)/a}$, which is always a well-defined real number. Therefore, these curves are always soluble over $\\mathbb{R}$.\n\n2.  **p-adic Solubility Test ($C(\\mathbb{Q}_p) \\neq \\emptyset$)**: For each prime $p$ in the given set, we test for local solubility. By Hensel's Lemma, the existence of a *non-singular* solution modulo $p$ guarantees a solution in $\\mathbb{Q}_p$. A point $(x_0, y_0, z_0)$ is non-singular modulo $p$ if the gradient vector, $(\\frac{\\partial F}{\\partial x}, \\frac{\\partial F}{\\partial y}, \\frac{\\partial F}{\\partial z}) = (3ax^2, 3by^2, 3cz^2)$, is not congruent to $(0,0,0) \\pmod{p}$ at that point. If all solutions modulo $p$ are singular (which occurs systematically for primes $p$ dividing $3abc$), we take the existence of any non-trivial solution modulo $p^2$ as strong numerical evidence for solubility in $\\mathbb{Q}_p$. The search for modular solutions is optimized by iterating through $x$ and $y$ and using a hash map to find a corresponding $z$.\n\n3.  **Rational Solubility Test ($C(\\mathbb{Q}) \\neq \\emptyset$)**: We perform a bounded search for a non-trivial integer solution $(x,y,z) \\in \\mathbb{Z}^3 \\setminus \\{(0,0,0)\\}$ satisfying $ax^3 + by^3 + cz^3 = 0$ with $|x|, |y|, |z| \\leq B$. The search is implemented by iterating over integer values of $x$ and $y$ within the bound $[-B, B]$ and then calculating the required value of $cz^3 = -(ax^3+by^3)$. If this value is divisible by $c$ and the result is a perfect cube $z^3$ where $|z| \\leq B$, a rational point has been found.\n\n### Binary Quartic: $u^2 = dx^4 + ex^2 + f$\n\n1.  **Real Solubility Test ($C(\\mathbb{R}) \\neq \\emptyset$)**: A real solution exists if and only if the polynomial $g(x) = dx^4 + ex^2 + f$ is non-negative for some $x \\in \\mathbb{R}$.\n    - If $d > 0$, $g(x) \\to +\\infty$ as $|x| \\to \\infty$, guaranteeing that $g(x)$ takes non-negative values. The curve is soluble over $\\mathbb{R}$.\n    - If $d  0$, $g(x) \\to -\\infty$ as $|x| \\to \\infty$. A real solution exists only if the global maximum of $g(x)$ is non-negative. We find the maximum by checking the critical points, where $g'(x) = 4dx^3 + 2ex = 0$. This occurs at $x=0$ and potentially at $x = \\pm\\sqrt{-e/(2d)}$ if $-e/(2d) > 0$. If $\\sup_{x \\in \\mathbb{R}} g(x)  0$, the curve is not soluble over $\\mathbb{R}$.\n\n2.  **p-adic Solubility Test ($C(\\mathbb{Q}_p) \\neq \\emptyset$)**: The principle is the same as for cubics. A solution $(u_0, x_0)$ modulo $p$ is non-singular if the gradient vector $(\\frac{\\partial F}{\\partial u}, \\frac{\\partial F}{\\partial x}) = (2u, -(4dx^3 + 2ex))$ is not $(0,0) \\pmod{p}$ at that point. We search for such a point. If only singular solutions are found, we check for any solution modulo $p^2$. The search involves iterating through $x \\pmod{p^n}$ and checking if $dx^4+ex^2+f$ is a quadratic residue modulo $p^n$.\n\n3.  **Rational Solubility Test ($C(\\mathbb{Q}) \\neq \\emptyset$)**: We search for integer solutions $(x, u)$ within the bound $B$. Since $x$ appears with even powers, we only need to search for $x \\in [0, B]$. For each $x$, we compute $v = dx^4 + ex^2 + f$. If $v \\geq 0$ and is a perfect square, say $v=u^2$, with $|u| \\leq B$, a rational point has been found.\n\nBy combining these tests according to the specified classification rule, we can analyze each curve in the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_cbrt_if_int(n):\n    \"\"\"\n    Returns the integer cube root of n if it exists, otherwise None.\n    \"\"\"\n    if n == 0:\n        return 0\n    # np.cbrt handles signs correctly.\n    root = np.cbrt(n)\n    # Check if the root is an integer within a small tolerance for float inaccuracies.\n    i_root = int(round(root))\n    if i_root**3 == n:\n        return i_root\n    return None\n\ndef classify_cubic(a, b, c, B, primes):\n    \"\"\"\n    Classifies a diagonal cubic curve.\n    Returns 0 (local obstruction), 1 (rational point found), or 2 (candidate).\n    \"\"\"\n    # Step 1: Real Place Test\n    # For a*x^3 + b*y^3 + c*z^3 = 0, with a,b,c non-zero, a non-trivial\n    # real solution always exists. So, this test always passes.\n\n    # Step 2: Finite Place (p-adic) Tests\n    for p in primes:\n        is_locally_soluble_at_p = False\n        \n        # Test for a non-singular solution modulo p\n        cz3_map = { (c * pow(z, 3, p)) % p: z for z in range(p - 1, -1, -1) }\n        found_nonsingular_sol = False\n        for x in range(p):\n            for y in range(p):\n                target = (-a * pow(x, 3, p) - b * pow(y, 3, p)) % p\n                if target in cz3_map:\n                    z = cz3_map[target]\n                    if x != 0 or y != 0 or z != 0:\n                        # Gradient is (3ax^2, 3by^2, 3cz^2)\n                        grad_x = (3 * a * pow(x, 2, p)) % p\n                        grad_y = (3 * b * pow(y, 2, p)) % p\n                        grad_z = (3 * c * pow(z, 2, p)) % p\n                        if grad_x != 0 or grad_y != 0 or grad_z != 0:\n                            is_locally_soluble_at_p = True\n                            found_nonsingular_sol = True\n                            break\n            if found_nonsingular_sol:\n                break\n        \n        if not is_locally_soluble_at_p:\n            # If no non-singular solution mod p, test for any non-trivial solution mod p^2\n            M = p * p\n            cz3_map_p2 = { (c * pow(z, 3, M)) % M: z for z in range(M - 1, -1, -1) }\n            for x in range(M):\n                for y in range(M): # This double loop can be slow for p^2\n                    target = (-a * pow(x, 3, M) - b * pow(y, 3, M)) % M\n                    if target in cz3_map_p2:\n                        z = cz3_map_p2[target]\n                        if x != 0 or y != 0 or z != 0:\n                            is_locally_soluble_at_p = True\n                            break\n                if is_locally_soluble_at_p:\n                    break\n\n\n        if not is_locally_soluble_at_p:\n            return 0 # Fails local solubility test at p\n\n    # Step 3: Rational Point Search\n    for x in range(-B, B + 1):\n        for y in range(-B, B + 1):\n            target_val = -a * x**3 - b * y**3\n            if c != 0 and target_val % c == 0:\n                z3_cand = target_val // c\n                z = get_cbrt_if_int(z3_cand)\n                if z is not None and abs(z) = B:\n                    if x != 0 or y != 0 or z != 0:\n                        return 1 # Found a rational point\n\n    return 2 # Locally soluble, no rational point found\n\ndef classify_quartic(d, e, f, B, primes):\n    \"\"\"\n    Classifies a binary quartic curve.\n    Returns 0 (local obstruction), 1 (rational point found), or 2 (candidate).\n    \"\"\"\n    # Step 1: Real Place Test\n    # Let g(x) = d*x^4 + e*x^2 + f.\n    if d > 0:\n        pass # g(x) -> +inf as |x| -> inf, so real solution exists.\n    else: # d = 0\n        if d == 0: # Not in test suite but handle for completeness\n            if e = 0 and f  0: return 0\n        else: # d  0\n            # g(x) -> -inf. Check supremum. g'(x) = 2x(2dx^2 + e).\n            max_g = float(f) # Value at x=0\n            if -e / (2 * d) > 0:\n                x_sq_crit = -e / (2 * d)\n                g_crit = d * x_sq_crit**2 + e * x_sq_crit + f\n                max_g = max(max_g, g_crit)\n            if max_g  0:\n                return 0 # No real solution\n    \n    # Step 2: Finite Place (p-adic) Tests\n    for p in primes:\n        is_locally_soluble_at_p = False\n\n        # Test for a non-singular solution modulo p\n        mod_sqrt_map = {pow(u, 2, p): u for u in range(p)}\n        found_nonsingular_sol = False\n        for x in range(p):\n            rhs = (d * pow(x, 4, p) + e * pow(x, 2, p) + f) % p\n            if rhs in mod_sqrt_map:\n                u = mod_sqrt_map[rhs]\n                # Gradient is (2u, -(4dx^3+2ex))\n                # Check point (u, x)\n                grad_x = (- (4 * d * pow(x, 3, p) + 2 * e * x)) % p\n                if (2 * u) % p != 0 or grad_x != 0:\n                    is_locally_soluble_at_p = True\n                    found_nonsingular_sol = True\n                    break\n                # Check point (-u, x) if first was singular (must be u=0)\n                if u == 0 and grad_x != 0: # This case is covered above but makes logic clear\n                    is_locally_soluble_at_p = True\n                    found_nonsingular_sol = True\n                    break\n\n        if not found_nonsingular_sol:\n            # Test for any solution mod p^2\n            M = p * p\n            squares_p2 = {pow(i, 2, M) for i in range(M)}\n            for x in range(M):\n                rhs = (d * pow(x, 4, M) + e * pow(x, 2, M) + f) % M\n                if rhs in squares_p2:\n                    is_locally_soluble_at_p = True\n                    break\n        \n        if not is_locally_soluble_at_p:\n            return 0 # Fails local solubility test at p\n\n    # Step 3: Rational Point Search\n    for x in range(B + 1):\n        val = d * x**4 + e * x**2 + f\n        if val >= 0:\n            # Use floating point sqrt and check if it's an integer\n            u_cand = np.sqrt(val)\n            if u_cand == int(u_cand):\n                u = int(u_cand)\n                if u = B:\n                    return 1 # Found a rational point\n\n    return 2 # Locally soluble, no rational point found\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on the test suite.\n    \"\"\"\n    test_cases = [\n        {'type': 'cubic', 'a': 1, 'b': 1, 'c': -1, 'B': 60, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'cubic', 'a': 3, 'b': 4, 'c': 5, 'B': 120, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'quartic', 'd': -1, 'e': 0, 'f': -1, 'B': 80, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'quartic', 'd': 1, 'e': -5, 'f': 4, 'B': 80, 'primes': [2, 3, 5, 7, 11]},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'cubic':\n            result = classify_cubic(case['a'], case['b'], case['c'], case['B'], case['primes'])\n        else: # quartic\n            result = classify_quartic(case['d'], case['e'], case['f'], case['B'], case['primes'])\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3029554"}, {"introduction": "While the previous exercise explored the qualitative nature of the Tate-Shafarevich group, the celebrated Birch and Swinnerton-Dyer (BSD) conjecture proposes a stunning quantitative formula for its size. This conjecture connects the order of $\\Sha(E/\\mathbb{Q})$ to analytic data from the curve's $L$-function and local data from its reduction at primes of bad reduction. This problem guides you through a check of the BSD formula for a specific curve, requiring you to compute a local Tamagawa number $c_p$ using Tate's algorithm—a fundamental tool for analyzing the geometry of an elliptic curve over a local field. [@problem_id:3013137]", "problem": "Let $E/\\mathbb{Q}$ be the elliptic curve given by the minimal Weierstrass equation\n$$\ny^{2}+y \\;=\\; x^{3}-x^{2}-10x-20.\n$$\nThis curve is the strong Weil curve of conductor $11$. Work from the foundational definitions of an elliptic curve, its Néron model, and Tate’s algorithm over a local field $\\mathbb{Q}_{p}$ to explain conceptually how the Tamagawa number $c_{p}$ at a prime $p$ is determined. Then apply this framework to the specific prime $p=11$ for the curve $E$ above to extract $c_{11}$ via Tate’s algorithm. Finally, use the Tamagawa number in a Birch and Swinnerton-Dyer (BSD) check as follows: it is known (and you should assume) that $E(\\mathbb{Q})$ has rank $0$, that the torsion subgroup $E(\\mathbb{Q})_{\\mathrm{tors}}$ has order $5$, and that the Tate–Shafarevich group $\\Sha(E/\\mathbb{Q})$ is finite of order $1$. Under these hypotheses, the Birch and Swinnerton–Dyer (BSD) conjecture predicts that\n$$\n\\frac{L(E,1)}{\\Omega_{E}} \\;=\\; \\frac{|\\Sha(E/\\mathbb{Q})| \\cdot \\prod_{p} c_{p}}{|E(\\mathbb{Q})_{\\mathrm{tors}}|^{2}},\n$$\nwhere $L(E,s)$ is the $L$-function of $E$ and $\\Omega_{E}$ is the real Néron period. Compute the exact value of the right-hand side for the given curve $E$ and present your final answer as a single reduced fraction. No numerical rounding is required.", "solution": "The problem asks for a conceptual explanation of the Tamagawa number $c_p$ for an elliptic curve $E$ over the rational numbers $\\mathbb{Q}$, its calculation for a specific curve at the prime $p=11$, and the subsequent computation of the value predicted by the Birch and Swinnerton-Dyer (BSD) conjecture for the ratio $L(E,1)/\\Omega_E$.\n\n### Conceptual Determination of the Tamagawa Number $c_p$\n\nLet $E$ be an elliptic curve defined over the field of rational numbers, $\\mathbb{Q}$. For any prime number $p$, we can consider $E$ as a curve over the local field of $p$-adic numbers, $\\mathbb{Q}_p$. The ring of integers in $\\mathbb{Q}_p$ is denoted by $\\mathbb{Z}_p$.\n\nA key object for studying the arithmetic of $E$ at the prime $p$ is its Néron model, denoted $\\mathcal{E}$. The Néron model is a smooth, separated group scheme over the ring of $p$-adic integers, $\\mathrm{Spec}(\\mathbb{Z}_p)$, whose generic fiber (over $\\mathbb{Q}_p$) is isomorphic to $E$. The existence and uniqueness of the Néron model is a fundamental result by Néron.\n\nThe special fiber of the Néron model, denoted $\\mathcal{E}_p$, is the fiber over the closed point of $\\mathrm{Spec}(\\mathbb{Z}_p)$, which corresponds to reducing the model modulo $p$. This special fiber $\\mathcal{E}_p$ is an algebraic group over the finite field $\\mathbb{F}_p$. It is not always connected. We denote its connected component of the identity by $\\mathcal{E}_p^0$.\n\nThe component group of the special fiber is the finite group $\\Phi_p(E) = \\mathcal{E}_p(\\mathbb{F}_p) / \\mathcal{E}_p^0(\\mathbb{F}_p)$. The Tamagawa number $c_p$ is defined as the order of this component group:\n$$\nc_p = |\\Phi_p(E)| = [\\mathcal{E}_p(\\mathbb{F}_p) : \\mathcal{E}_p^0(\\mathbb{F}_p)].\n$$\nIf $E$ has good reduction at $p$, the special fiber $\\mathcal{E}_p$ is an elliptic curve itself, which is connected. In this case, $\\mathcal{E}_p = \\mathcal{E}_p^0$, the component group is trivial, and $c_p=1$. If $E$ has bad reduction at $p$, the special fiber is singular, and it may not be connected. In these cases, $c_p$ can be greater than $1$.\n\nTate's algorithm provides a systematic way to determine the structure of the special fiber $\\mathcal{E}_p$ and therefore compute $c_p$ directly from a minimal Weierstrass equation for $E$ at $p$. The algorithm classifies the reduction type according to Kodaira's classification ($I_n, II, III, IV$, etc.) and gives the corresponding value of $c_p$.\n\n### Application to $E$ at $p=11$\n\nThe given curve is $E: y^{2}+y = x^{3}-x^{2}-10x-20$. This is a generalized Weierstrass equation $y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6$, with coefficients $a_1=0, a_3=1, a_2=-1, a_4=-10, a_6=-20$.\n\nWe first compute the discriminant $\\Delta$. The standard invariants are:\n$b_2 = a_1^2 + 4a_2 = -4$\n$b_4 = 2a_4 + a_1a_3 = -20$\n$b_6 = a_3^2 + 4a_6 = -79$\nThe discriminant is $\\Delta = -b_2^2 b_8 - 8b_4^3 - 27b_6^2 + 9b_2 b_4 b_6$. Using standard formulas, this evaluates to $\\Delta = -161051 = -11^5$.\n\nThe $p$-adic valuation of the discriminant at $p=11$ is $v_{11}(\\Delta) = 5$. Since $v_{11}(\\Delta)  12$, the given equation is minimal at $p=11$.\n\nWe now apply Tate's algorithm for $p=11$:\n1.  Since $v_{11}(\\Delta) = 5 > 0$, the curve has bad reduction at $p=11$.\n2.  The invariant $c_4 = b_2^2 - 24b_4 = (-4)^2 - 24(-20) = 496$. Since $496 \\not\\equiv 0 \\pmod{11}$, we have $v_{11}(c_4)=0$.\n3.  According to Tate's algorithm, if $v_p(\\Delta)>0$ and $v_p(c_4)=0$, the reduction is of type $I_n$ (multiplicative reduction), where $n = v_p(\\Delta)$. Here, $n=v_{11}(\\Delta)=5$, so the reduction type is $I_5$.\n\nFor type $I_n$, $c_p=n$ if the reduction is split, and smaller otherwise. To determine if the reduction is split, we analyze the singular point of the reduced curve over $\\mathbb{F}_{11}$. The equation modulo $11$ is:\n$$ \\tilde{E}: y^2+y \\equiv x^3-x^2-10x-20 \\pmod{11} \\implies y^2+y \\equiv x^3+10x^2+x+2 \\pmod{11} $$\nThe singular point $(x_0, y_0)$ makes the partial derivatives zero.\n$\\frac{\\partial \\tilde{E}}{\\partial y} = 2y+1 \\equiv 0 \\implies y_0 \\equiv 5 \\pmod{11}$.\n$\\frac{\\partial \\tilde{E}}{\\partial x} = 3x^2+20x+1 \\equiv 3x^2-2x+1 \\equiv 0 \\pmod{11}$.\nThe roots of $3x^2-2x+1=0$ are $x = \\frac{2 \\pm \\sqrt{4 - 12}}{6} \\equiv \\frac{2 \\pm \\sqrt{3}}{6} \\pmod{11}$. Since $5^2=25\\equiv 3$ and $6^{-1}\\equiv 2$, the roots are $x \\equiv (2 \\pm 5) \\cdot 2$, giving $x_1 \\equiv 3$ and $x_2 \\equiv 5$. We check which point lies on $\\tilde{E}$: at $(5,5)$, $y^2+y = 25+5=30\\equiv 8$, and $x^3+10x^2+x+2 = 125-25+5+2 \\equiv 4-3+5+2 = 8$. The singular point is $(5,5)$.\n\nTo analyze the singularity, we change coordinates to move it to the origin, setting $x=X+5$ and $y=Y+5$. The equation becomes:\n$$ (Y+5)^2+(Y+5) = (X+5)^3+10(X+5)^2+(X+5)+2 $$\nReducing modulo $11$:\n$$ Y^2+10Y+25+Y+5 \\equiv (X^3+15X^2+\\dots) + 10(X^2+10X+\\dots) + (X+5)+2 $$\n$$ Y^2+8 \\equiv X^3+4X^2 + 10X^2 + \\dots \\implies Y^2 \\equiv X^3+3X^2 \\pmod{11} $$\nThe equation of the curve near the singularity is $Y^2 = X^2(X+3)$. The tangent lines at the origin $(X,Y)=(0,0)$ are given by equating the lowest degree terms to zero: $Y^2 = 3X^2$. The slopes $m=Y/X$ of the tangents satisfy $m^2 \\equiv 3 \\pmod{11}$.\nSince $5^2 = 25 \\equiv 3 \\pmod{11}$, the slopes are $m = \\pm 5$, which are distinct values in $\\mathbb{F}_{11}$. The singular point is a node with tangents defined over $\\mathbb{F}_{11}$, so the reduction is split multiplicative.\n\nFor split multiplicative reduction of type $I_n$, the Tamagawa number is $c_p = n$.\nThus, for $E$ at $p=11$, we have $c_{11} = 5$.\n\n### Calculation for the BSD Conjecture\n\nWe are asked to compute the value of the expression $\\frac{|\\Sha(E/\\mathbb{Q})| \\cdot \\prod_{p} c_{p}}{|E(\\mathbb{Q})_{\\mathrm{tors}}|^{2}}$.\nThe product $\\prod_p c_p$ is taken over all prime numbers $p$. The Tamagawa number $c_p=1$ for any prime $p$ where $E$ has good reduction. The primes where $c_p$ can be other than $1$ are the primes of bad reduction, which are precisely the primes dividing the conductor $N$ of the elliptic curve.\nThe problem states that the conductor of $E$ is $N=11$. This means the only prime of bad reduction is $p=11$.\nTherefore, the product of Tamagawa numbers is:\n$$\n\\prod_{p} c_{p} = c_{11} \\cdot \\prod_{p \\ne 11} c_{p} = c_{11} \\cdot \\prod_{p \\ne 11} 1 = c_{11}.\n$$\nWe calculated $c_{11} = 5$.\nSo, $\\prod_{p} c_{p} = 5$.\n\nWe are given the following values:\n$|\\Sha(E/\\mathbb{Q})| = 1$\n$|E(\\mathbb{Q})_{\\mathrm{tors}}| = 5$\n\nSubstituting these values into the expression:\n$$\n\\frac{|\\Sha(E/\\mathbb{Q})| \\cdot \\prod_{p} c_{p}}{|E(\\mathbb{Q})_{\\mathrm{tors}}|^{2}} = \\frac{1 \\cdot 5}{5^2} = \\frac{5}{25} = \\frac{1}{5}.\n$$\nThe value of the right-hand side of the BSD formula for this curve is $\\frac{1}{5}$.", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "3013137"}, {"introduction": "The primary theoretical tool for computing the Tate-Shafarevich group is the method of descent, which gives rise to the Selmer group. The $n$-Selmer group, $\\mathrm{Sel}^{(n)}(E/\\mathbb{Q})$, fits into a fundamental short exact sequence that links it to the Mordell-Weil group $E(\\mathbb{Q})$ and the $n$-torsion of the Tate-Shafarevich group, $\\Sha(E/\\mathbb{Q})[n]$. This exercise focuses on the purely algebraic consequences of this sequence, allowing you to compute the size of $\\Sha(E/\\mathbb{Q})[2]$ by carefully relating the orders of these three crucial groups using data from hypothetical descent computations. [@problem_id:3029567]", "problem": "Let $E/\\mathbb{Q}$ be an elliptic curve and let $\\Sha(E/\\mathbb{Q})$ denote its Tate–Shafarevich group ($\\Sha$). For a positive integer $n$, the $n$-Selmer group $\\mathrm{Sel}^{(n)}(E/\\mathbb{Q})$ is defined as the subgroup of the Galois cohomology group $H^{1}(\\mathbb{Q},E[n])$ consisting of classes that are everywhere locally in the image of the Kummer map $E(\\mathbb{Q}_{v})/nE(\\mathbb{Q}_{v}) \\to H^{1}(\\mathbb{Q}_{v},E[n])$ for all places $v$ of $\\mathbb{Q}$. Starting from the Kummer exact sequence of group schemes over $\\mathbb{Q}$,\n$$\n0 \\longrightarrow E[n] \\longrightarrow E \\xrightarrow{[n]} E \\longrightarrow 0,\n$$\nand applying Galois cohomology together with the global-to-local comparison, one obtains the exact sequence\n$$\n0 \\longrightarrow E(\\mathbb{Q})/nE(\\mathbb{Q}) \\longrightarrow \\mathrm{Sel}^{(n)}(E/\\mathbb{Q}) \\longrightarrow \\Sha(E/\\mathbb{Q})[n] \\longrightarrow 0,\n$$\nwhere $\\Sha(E/\\mathbb{Q})[n]$ denotes the $n$-torsion subgroup of $\\Sha(E/\\mathbb{Q})$.\n\nAssume the following arithmetic invariants for $E/\\mathbb{Q}$ are determined by explicit descent computations:\n- The Mordell–Weil group $E(\\mathbb{Q})$ has rank $r=0$ and torsion subgroup $E(\\mathbb{Q})_{\\mathrm{tors}} \\simeq (\\mathbb{Z}/2\\mathbb{Z})^{2}$, so $|E(\\mathbb{Q})_{\\mathrm{tors}}|=4$ and the torsion is killed by multiplication by $2$.\n- A complete second descent yields $|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})|=2^{5}$.\n- A complete fourth descent yields $|\\mathrm{Sel}^{(4)}(E/\\mathbb{Q})|=2^{7}$.\n\nUsing only the fundamental definitions stated above and consequences thereof, determine the exact cardinality of the $2$-torsion subgroup $\\Sha(E/\\mathbb{Q})[2]$. Express your final result as an exact integer (no rounding is needed or permitted).", "solution": "The problem asks for the cardinality of the $2$-torsion subgroup of the Tate-Shafarevich group, $\\Sha(E/\\mathbb{Q})[2]$, for a given elliptic curve $E/\\mathbb{Q}$. The solution proceeds by analyzing the fundamental short exact sequence that connects the Mordell-Weil group, the Selmer group, and the Tate-Shafarevich group.\n\nThe problem provides the following short exact sequence derived from Galois cohomology:\n$$\n0 \\longrightarrow E(\\mathbb{Q})/nE(\\mathbb{Q}) \\longrightarrow \\mathrm{Sel}^{(n)}(E/\\mathbb{Q}) \\longrightarrow \\Sha(E/\\mathbb{Q})[n] \\longrightarrow 0\n$$\nThis sequence holds for any positive integer $n$. Since all groups in this sequence are finite abelian groups, we can relate their orders. The exactness implies that the order of the middle group is the product of the orders of the groups at the ends:\n$$\n|\\mathrm{Sel}^{(n)}(E/\\mathbb{Q})| = |E(\\mathbb{Q})/nE(\\mathbb{Q})| \\cdot |\\Sha(E/\\mathbb{Q})[n]|\n$$\nWe are interested in the case where $n=2$. The equation becomes:\n$$\n|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})| = |E(\\mathbb{Q})/2E(\\mathbb{Q})| \\cdot |\\Sha(E/\\mathbb{Q})[2]|\n$$\nWe can rearrange this to solve for the desired quantity, $|\\Sha(E/\\mathbb{Q})[2]|$:\n$$\n|\\Sha(E/\\mathbb{Q})[2]| = \\frac{|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})|}{|E(\\mathbb{Q})/2E(\\mathbb{Q})|}\n$$\nThe problem provides the size of the $2$-Selmer group: $|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})| = 2^5 = 32$.\n\nThe next step is to determine the order of the group $E(\\mathbb{Q})/2E(\\mathbb{Q})$. We are given the structure of the Mordell-Weil group $E(\\mathbb{Q})$. Its rank is $r=0$, and its torsion subgroup is $E(\\mathbb{Q})_{\\mathrm{tors}} \\simeq (\\mathbb{Z}/2\\mathbb{Z})^2$.\nThe general structure of the Mordell-Weil group is $E(\\mathbb{Q}) \\simeq \\mathbb{Z}^r \\oplus E(\\mathbb{Q})_{\\mathrm{tors}}$. Since the rank $r=0$, the group consists only of its torsion points:\n$$\nE(\\mathbb{Q}) = E(\\mathbb{Q})_{\\mathrm{tors}} \\simeq (\\mathbb{Z}/2\\mathbb{Z})^2\n$$\nThis is a finite group of order $|(\\mathbb{Z}/2\\mathbb{Z})^2| = 4$.\nTo find the order of the quotient group $E(\\mathbb{Q})/2E(\\mathbb{Q})$, we first identify the subgroup $2E(\\mathbb{Q})$, which is the image of $E(\\mathbb{Q})$ under the multiplication-by-$2$ map. Since every element $P \\in E(\\mathbb{Q})$ has order dividing $2$, we have $2P=O$ for all $P \\in E(\\mathbb{Q})$, where $O$ is the identity element (the point at infinity). Therefore, the image of this map is the trivial group:\n$$\n2E(\\mathbb{Q}) = \\{O\\}\n$$\nThe quotient group is then:\n$$\nE(\\mathbb{Q})/2E(\\mathbb{Q}) = E(\\mathbb{Q})/\\{O\\} \\simeq E(\\mathbb{Q})\n$$\nThe order of this group is thus:\n$$\n|E(\\mathbb{Q})/2E(\\mathbb{Q})| = |E(\\mathbb{Q})| = |(\\mathbb{Z}/2\\mathbb{Z})^2| = 4 = 2^2\n$$\nNow we have all the necessary components to calculate the order of $\\Sha(E/\\mathbb{Q})[2]$:\n$$\n|\\Sha(E/\\mathbb{Q})[2]| = \\frac{|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})|}{|E(\\mathbb{Q})/2E(\\mathbb{Q})|} = \\frac{2^5}{2^2} = 2^{5-2} = 2^3 = 8\n$$\nThe problem also provides the size of the $4$-Selmer group, $|\\mathrm{Sel}^{(4)}(E/\\mathbb{Q})|=2^7$. While not strictly necessary for the calculation above, this information can be used to verify the consistency of the arithmetic data. Using the same logic for $n=4$:\n$$\n|\\Sha(E/\\mathbb{Q})[4]| = \\frac{|\\mathrm{Sel}^{(4)}(E/\\mathbb{Q})|}{|E(\\mathbb{Q})/4E(\\mathbb{Q})|}\n$$\nThe group $4E(\\mathbb{Q})$ is the image of $E(\\mathbb{Q})$ under multiplication-by-$4$. Since $2P=O$ for all $P \\in E(\\mathbb{Q})$, it follows that $4P=2(2P)=2(O)=O$. Thus, $4E(\\mathbb{Q}) = \\{O\\}$, and so $|E(\\mathbb{Q})/4E(\\mathbb{Q})|=|E(\\mathbb{Q})|=4=2^2$.\nThis yields the size of the $4$-torsion of the Tate-Shafarevich group:\n$$\n|\\Sha(E/\\mathbb{Q})[4]| = \\frac{2^7}{2^2} = 2^5 = 32\n$$\nFor any finite abelian group $A$, its $4$-torsion subgroup $A[4]$ and $2$-torsion subgroup $A[2]$ are related. If $A[4]$ has the structure $(\\mathbb{Z}/4\\mathbb{Z})^a \\oplus (\\mathbb{Z}/2\\mathbb{Z})^b$, then its order is $4^a 2^b = 2^{2a+b}$. Its $2$-torsion subgroup $A[2]$ is isomorphic to $(\\mathbb{Z}/2\\mathbb{Z})^{a+b}$, with order $2^{a+b}$.\nApplying this to $A=\\Sha(E/\\mathbb{Q})$, we have:\n$|\\Sha(E/\\mathbb{Q})[4]| = 2^{2a+b} = 32 = 2^5$, so $2a+b=5$.\n$|\\Sha(E/\\mathbb{Q})[2]| = 2^{a+b} = 8 = 2^3$, so $a+b=3$.\nSolving this system of linear equations gives $a=2$ and $b=1$. This implies that the structure of the $4$-torsion is $\\Sha(E/\\mathbb{Q})[4] \\simeq (\\mathbb{Z}/4\\mathbb{Z})^2 \\oplus \\mathbb{Z}/2\\mathbb{Z}$. This is a consistent result, which lends further confidence to the calculation. The primary calculation, however, only requires the data for $n=2$.\n\nThe determined cardinality of the $2$-torsion subgroup is $8$.", "answer": "$$\\boxed{8}$$", "id": "3029567"}]}