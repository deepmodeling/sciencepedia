{"hands_on_practices": [{"introduction": "The analytic class number formula is a cornerstone of algebraic number theory, connecting the residue of the Dedekind zeta function at $s=1$ to fundamental arithmetic invariants of a number field. Before exploring its deeper consequences like the Brauer-Siegel theorem, it is essential to ground our understanding in the simplest non-trivial case: the field of rational numbers, $K = \\mathbb{Q}$. This practice [@problem_id:3025182] walks through the verification of the formula for $\\mathbb{Q}$, reinforcing the definitions of the class number, regulator, and other key invariants in a familiar setting.", "problem": "Let $K=\\mathbb{Q}$ and let $\\zeta_{K}(s)$ denote the Dedekind zeta function of $K$. Work from foundational definitions and standard properties of $K=\\mathbb{Q}$.\n\n(a) Using the definition of the Dedekind zeta function as a Dirichlet series over nonzero ideals of $\\mathcal{O}_{K}$ and the identification $\\mathcal{O}_{\\mathbb{Q}}=\\mathbb{Z}$, determine $\\zeta_{K}(s)$ explicitly in terms of the classical Riemann zeta function and compute the residue $\\operatorname{Res}_{s=1}\\zeta_{K}(s)$.\n\n(b) Determine each of the standard arithmetic invariants of $K=\\mathbb{Q}$: the number $r_{1}$ of real embeddings, the number $r_{2}$ of pairs of complex embeddings, the discriminant $D_{K}$, the class number $h_{K}$, the regulator $R_{K}$, and the number $w_{K}$ of roots of unity in $\\mathcal{O}_{K}$. Use only definitions and well-tested facts about $\\mathbb{Q}$.\n\n(c) Without appealing to any unproven claims, explain why the value obtained in part (a) coincides with the value predicted by the analytic class number formula for a general number field specialized to $K=\\mathbb{Q}$, thereby verifying this base case relevant to the Brauerâ€“Siegel framework.\n\nGive your final answer as a single exact real number for $\\operatorname{Res}_{s=1}\\zeta_{K}(s)$.", "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. We may proceed with the solution.\n\n(a) We are tasked with determining the Dedekind zeta function $\\zeta_{K}(s)$ for the number field $K=\\mathbb{Q}$ and finding its residue at $s=1$.\n\nThe Dedekind zeta function of a number field $K$ is defined for $\\operatorname{Re}(s) > 1$ as the Dirichlet series over the non-zero ideals of its ring of integers $\\mathcal{O}_{K}$:\n$$ \\zeta_{K}(s) = \\sum_{0 \\neq \\mathfrak{a} \\subseteq \\mathcal{O}_{K}} \\frac{1}{(N(\\mathfrak{a}))^s} $$\nwhere $N(\\mathfrak{a}) = |\\mathcal{O}_{K}/\\mathfrak{a}|$ is the norm of the ideal $\\mathfrak{a}$.\n\nFor the number field $K=\\mathbb{Q}$, the ring of integers is $\\mathcal{O}_{\\mathbb{Q}} = \\mathbb{Z}$. Since $\\mathbb{Z}$ is a principal ideal domain (PID), every non-zero ideal $\\mathfrak{a}$ is of the form $(n) = n\\mathbb{Z}$ for some integer $n \\neq 0$. The ideals $(n)$ and $(-n)$ are identical, so we can uniquely represent each non-zero ideal by a positive integer $n \\in \\mathbb{Z}_{>0}$. That is, there is a one-to-one correspondence between the non-zero ideals of $\\mathbb{Z}$ and the positive integers $n=1, 2, 3, \\ldots$.\n\nThe norm of a non-zero principal ideal $(n)$ in $\\mathbb{Z}$ is given by the cardinality of the quotient ring:\n$$ N((n)) = |\\mathbb{Z}/n\\mathbb{Z}| = |n| $$\nSince we are using positive integers $n$ to represent the ideals, the norm is simply $N((n))=n$.\n\nSubstituting these findings into the definition of the Dedekind zeta function for $K=\\mathbb{Q}$, we get:\n$$ \\zeta_{\\mathbb{Q}}(s) = \\sum_{n=1}^{\\infty} \\frac{1}{(N((n)))^s} = \\sum_{n=1}^{\\infty} \\frac{1}{n^s} $$\nThis series is the definition of the classical Riemann zeta function, $\\zeta(s)$. Therefore, we have the identity $\\zeta_{\\mathbb{Q}}(s) = \\zeta(s)$.\n\nThe problem asks for the residue of $\\zeta_{K}(s)$ at the point $s=1$. This is equivalent to finding the residue of the Riemann zeta function at $s=1$. It is a fundamental result in the theory of the Riemann zeta function that $\\zeta(s)$ has an analytic continuation to the complex plane $\\mathbb{C} \\setminus \\{1\\}$ and has a simple pole at $s=1$ with residue $1$.\n$$ \\operatorname{Res}_{s=1}\\zeta_{K}(s) = \\operatorname{Res}_{s=1}\\zeta_{\\mathbb{Q}}(s) = \\operatorname{Res}_{s=1}\\zeta(s) = 1 $$\n\n(b) We now determine the standard arithmetic invariants for $K=\\mathbb{Q}$.\n\n$r_{1}$, $r_{2}$: An embedding of $\\mathbb{Q}$ into $\\mathbb{C}$ is an injective field homomorphism $\\sigma: \\mathbb{Q} \\to \\mathbb{C}$. Since any such homomorphism must map $1$ to $1$, it is the identity on the subfield $\\mathbb{Q}$. Thus, there is only one embedding, $\\sigma(x)=x$ for all $x \\in \\mathbb{Q}$. The image of this embedding is $\\mathbb{Q}$, which is a subset of the real numbers $\\mathbb{R}$. Therefore, this is a real embedding. We have $r_1=1$ real embeddings. The number of pairs of complex conjugate embeddings is $r_2$. The degree of the extension is $[K:\\mathbb{Q}] = n = r_1+2r_2$. For $K=\\mathbb{Q}$, we have $n=1$, so $1 = 1 + 2r_2$, which implies $r_2=0$.\n\n$D_{K}$: The discriminant of the number field $K$ is the discriminant of an integral basis for $\\mathcal{O}_{K}$. For $K=\\mathbb{Q}$, $\\mathcal{O}_{K}=\\mathbb{Z}$, and an integral basis is $\\{1\\}$. The discriminant is defined as $D_K = \\det( (\\sigma_i(b_j)) )^2$, where $\\{\\sigma_i\\}$ are the embeddings and $\\{b_j\\}$ is the integral basis. Here we have one embedding $\\sigma_1 = \\text{id}$ and one basis element $b_1=1$. The matrix is the $1 \\times 1$ matrix $(\\sigma_1(b_1)) = (1)$. Thus, the discriminant is $D_{\\mathbb{Q}} = \\det((1))^2 = 1^2 = 1$.\n\n$h_{K}$: The class number $h_{K}$ is the order of the ideal class group of $K$. The ideal class group measures the extent to which a ring of integers fails to be a PID. As established in part (a), $\\mathcal{O}_{\\mathbb{Q}} = \\mathbb{Z}$ is a PID. This means every ideal is principal, so the ideal class group is trivial. The order of the trivial group is $1$. Hence, the class number is $h_{\\mathbb{Q}} = 1$.\n\n$w_{K}$: The number $w_{K}$ is the count of the roots of unity contained in the ring of integers $\\mathcal{O}_{K}$. For $K=\\mathbb{Q}$, we seek the elements $\\zeta \\in \\mathbb{Z}$ such that $\\zeta^m = 1$ for some integer $m \\ge 1$. The only such integers are $1$ and $-1$. Thus, the group of roots of unity in $\\mathbb{Q}$ is $\\{1, -1\\}$, and their number is $w_{\\mathbb{Q}}=2$.\n\n$R_{K}$: The regulator $R_{K}$ is related to the group of units $\\mathcal{O}_{K}^{\\times}$. By Dirichlet's Unit Theorem, the rank of the unit group is $r = r_1 + r_2 - 1$. For $K=\\mathbb{Q}$, the rank is $r = 1 + 0 - 1 = 0$. A rank of $0$ means the unit group is finite, consisting only of the roots of unity. Indeed, $\\mathcal{O}_{\\mathbb{Q}}^{\\times} = \\mathbb{Z}^{\\times} = \\{1, -1\\}$. For a number field where the rank of the unit group is $0$, the regulator is defined by convention to be $R_{K}=1$. This corresponds to the determinant of a $0 \\times 0$ matrix.\n\n(c) We now verify that the result from part (a) is consistent with the analytic class number formula. The formula states that for a number field $K$, the residue of $\\zeta_{K}(s)$ at $s=1$ is given by:\n$$ \\operatorname{Res}_{s=1}\\zeta_{K}(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K \\sqrt{|D_K|}} $$\nWe substitute the invariants for $K=\\mathbb{Q}$ as determined in part (b):\n- $r_1=1$\n- $r_2=0$\n- $h_K=1$\n- $R_K=1$\n- $w_K=2$\n- $D_K=1$\n\nPlugging these values into the formula yields:\n$$ \\operatorname{Res}_{s=1}\\zeta_{\\mathbb{Q}}(s) = \\frac{2^{1}(2\\pi)^{0} \\cdot 1 \\cdot 1}{2 \\cdot \\sqrt{|1|}} = \\frac{2 \\cdot 1 \\cdot 1 \\cdot 1}{2 \\cdot 1} = \\frac{2}{2} = 1 $$\nThis value of $1$ perfectly matches the value derived in part (a) by direct computation, $\\operatorname{Res}_{s=1}\\zeta_{\\mathbb{Q}}(s)=1$. This demonstrates that the case of $K=\\mathbb{Q}$ serves as a fundamental, confirming base case for the general analytic class number formula. The formula, which relates deep arithmetic invariants of a number field to the analytic behavior of its zeta function, holds true for this simplest number field.\nThe final answer requested is the value of this residue.", "answer": "$$\\boxed{1}$$", "id": "3025182"}, {"introduction": "The true power of the Brauer-Siegel theorem lies in its predictive ability for infinite families of number fields. This exercise [@problem_id:3025206] shifts our focus to the family of imaginary quadratic fields, a rich and historically significant class of fields. By applying the theorem, we can derive a precise asymptotic relationship between the class number $h_K$ and the discriminant $D_K$, revealing how the complexity of the ideal class group grows as the field gets \"larger.\"", "problem": "Let $K$ be an imaginary quadratic number field with absolute discriminant $|d_{K}|$, signature $(r_{1}(K),r_{2}(K))$, class number $h_{K}$, regulator $R_{K}$, and number $w_{K}$ of roots of unity in $\\mathcal{O}_{K}$. \n\n(a) Compute $r_{1}(K)$, $r_{2}(K)$, $R_{K}$, and $w_{K}$ for such $K$, identifying any exceptional cases that occur for special fields $K$.\n\n(b) Consider any sequence $(K_{j})_{j\\geq 1}$ of imaginary quadratic fields with $|d_{K_{j}}|\\to \\infty$. Define\n$$\nL \\;=\\; \\lim_{j\\to\\infty}\\frac{\\log\\!\\big(h_{K_{j}}\\,R_{K_{j}}\\big)}{\\log\\!\\big(\\sqrt{|d_{K_{j}}|}\\big)},\n$$\nprovided the limit exists. Determine the exact value of $L$. Your final answer must be a single exact number; no rounding is required.", "solution": "This problem consists of two parts. Part (a) requires the computation of fundamental invariants for an imaginary quadratic number field $K$. Part (b) asks for the value of a specific limit related to a sequence of such fields, which is an application of the Brauer-Siegel theorem.\n\n(a) Let $K$ be an imaginary quadratic number field. This means $K = \\mathbb{Q}(\\sqrt{m})$ for some square-free integer $m  0$. The degree of the extension is $[K:\\mathbb{Q}] = 2$.\n\nThe signature $(r_{1}(K), r_{2}(K))$ is determined by the number of real and complex embeddings of $K$ into $\\mathbb{C}$. The minimal polynomial of $\\sqrt{m}$ over $\\mathbb{Q}$ is $x^2 - m = 0$, which has roots $\\pm\\sqrt{m} = \\pm i\\sqrt{|m|}$. Since $m  0$, both roots are purely imaginary. Thus, there are no real embeddings, and $r_{1}(K) = 0$. There are two complex embeddings, which come in a conjugate pair: $\\sigma_1: \\sqrt{m} \\mapsto i\\sqrt{|m|}$ and $\\sigma_2 = \\overline{\\sigma_1}: \\sqrt{m} \\mapsto -i\\sqrt{|m|}$. The number of pairs of complex conjugate embeddings is $r_{2}(K) = 1$. The degree is $n = r_1(K) + 2r_2(K) = 0 + 2(1) = 2$, which is consistent.\nTherefore, for any imaginary quadratic field $K$, we have $r_{1}(K) = 0$ and $r_{2}(K) = 1$.\n\nThe regulator $R_K$ is related to the structure of the unit group $\\mathcal{O}_K^\\times$ of the ring of integers $\\mathcal{O}_K$. By Dirichlet's Unit Theorem, the rank of the free part of $\\mathcal{O}_K^\\times$ is $r = r_1(K) + r_2(K) - 1$. For an imaginary quadratic field, this rank is $r = 0 + 1 - 1 = 0$. This means the unit group is finite and consists only of the roots of unity contained in $K$. The regulator $R_K$ is defined as the absolute value of the determinant of the $r \\times r$ matrix formed by the logarithms of the absolute values of a set of fundamental units. Since $r=0$, this is a $0 \\times 0$ matrix. By convention, the determinant of a $0 \\times 0$ matrix is $1$.\nTherefore, for any imaginary quadratic field $K$, the regulator is $R_K = 1$.\n\nThe number $w_K$ is the number of roots of unity in $\\mathcal{O}_K$. These are the elements of the torsion subgroup of $\\mathcal{O}_K^\\times$. For a general number field, the only roots of unity are $\\pm 1$, so $w_K = 2$. However, certain imaginary quadratic fields contain additional roots of unity. An $n$-th root of unity $\\zeta_n$ has degree $\\phi(n)$ over $\\mathbb{Q}$, where $\\phi$ is Euler's totient function. For $\\mathbb{Q}(\\zeta_n)$ to be a subfield of a quadratic field $K$, we must have $\\phi(n) \\le 2$. The values of $n$ for which $\\phi(n) \\le 2$ are $n \\in \\{1, 2, 3, 4, 6\\}$.\n- $n=1, 2$: $\\mathbb{Q}(\\zeta_1) = \\mathbb{Q}(\\zeta_2) = \\mathbb{Q}$. These give the roots $\\pm 1$.\n- $n=4$: $\\mathbb{Q}(\\zeta_4) = \\mathbb{Q}(i) = \\mathbb{Q}(\\sqrt{-1})$. The discriminant is $d_K = -4$. For this field, the roots of unity are $\\{\\pm 1, \\pm i\\}$, so $w_K = 4$.\n- $n=3, 6$: $\\mathbb{Q}(\\zeta_3) = \\mathbb{Q}(\\zeta_6) = \\mathbb{Q}(\\sqrt{-3})$. The discriminant is $d_K = -3$. For this field, the roots of unity are the sixth roots of unity, $\\{\\pm 1, \\frac{\\pm 1 \\pm \\sqrt{-3}}{2}\\}$, so $w_K = 6$.\nFor all other imaginary quadratic fields $K$, the only roots of unity are $\\{\\pm 1\\}$.\nIn summary, for $w_K$, there are two exceptional cases:\n- If $K = \\mathbb{Q}(\\sqrt{-1})$, then $w_K = 4$.\n- If $K = \\mathbb{Q}(\\sqrt{-3})$, then $w_K = 6$.\n- For all other imaginary quadratic fields $K$, $w_K = 2$.\n\n(b) We are asked to determine the value of the limit\n$$ L = \\lim_{j\\to\\infty}\\frac{\\log(h_{K_j} R_{K_j})}{\\log(\\sqrt{|d_{K_j}|})} $$\nfor a sequence of imaginary quadratic fields $(K_j)_{j\\geq 1}$ with $|d_{K_j}|\\to \\infty$.\n\nFrom part (a), we know that for any imaginary quadratic field $K_j$, the regulator is $R_{K_j} = 1$. Substituting this into the expression for $L$ gives:\n$$ L = \\lim_{j\\to\\infty}\\frac{\\log(h_{K_j} \\cdot 1)}{\\log(\\sqrt{|d_{K_j}|})} = \\lim_{j\\to\\infty}\\frac{\\log(h_{K_j})}{\\frac{1}{2}\\log(|d_{K_j}|)} = 2 \\lim_{j\\to\\infty}\\frac{\\log(h_{K_j})}{\\log(|d_{K_j}|)} $$\nThis limit is a well-known result in number theory, a special case of the Brauer-Siegel theorem. We can derive its value using the analytic class number formula. For an imaginary quadratic field $K$, this formula relates the residue of its Dedekind zeta function $\\zeta_K(s)$ at $s=1$ to the invariants of the field:\n$$ \\lim_{s\\to 1} (s-1)\\zeta_K(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K \\sqrt{|d_K|}} $$\nUsing $r_1=0$, $r_2=1$, and $R_K=1$ for $K=K_j$, this becomes:\n$$ \\lim_{s\\to 1} (s-1)\\zeta_{K_j}(s) = \\frac{2\\pi h_{K_j}}{w_{K_j} \\sqrt{|d_{K_j}|}} $$\nThe Dedekind zeta function factors as $\\zeta_{K_j}(s) = \\zeta(s)L(s, \\chi_{K_j})$, where $\\zeta(s)$ is the Riemann zeta function and $L(s, \\chi_{K_j})$ is the Dirichlet L-function associated with the quadratic character $\\chi_{K_j}$ corresponding to the field $K_j$. Since $\\lim_{s\\to 1} (s-1)\\zeta(s) = 1$, we have:\n$$ \\lim_{s\\to 1} (s-1)\\zeta_{K_j}(s) = L(1, \\chi_{K_j}) $$\nEquating the two expressions for the residue, we get:\n$$ L(1, \\chi_{K_j}) = \\frac{2\\pi h_{K_j}}{w_{K_j} \\sqrt{|d_{K_j}|}} $$\nWe can solve for the class number $h_{K_j}$:\n$$ h_{K_j} = \\frac{w_{K_j} \\sqrt{|d_{K_j}|}}{2\\pi} L(1, \\chi_{K_j}) $$\nWe now take the natural logarithm of this expression. The condition $|d_{K_j}| \\to \\infty$ ensures that for all sufficiently large $j$, $K_j$ is neither $\\mathbb{Q}(\\sqrt{-1})$ (where $|d_K|=4$) nor $\\mathbb{Q}(\\sqrt{-3})$ (where $|d_K|=3$). Thus, for large $j$, we have $w_{K_j} = 2$.\n$$ h_{K_j} = \\frac{2 \\sqrt{|d_{K_j}|}}{2\\pi} L(1, \\chi_{K_j}) = \\frac{\\sqrt{|d_{K_j}|}}{\\pi} L(1, \\chi_{K_j}) $$\nTaking the logarithm:\n$$ \\log(h_{K_j}) = \\log\\left(\\frac{|d_{K_j}|^{1/2}}{\\pi} L(1, \\chi_{K_j})\\right) = \\frac{1}{2}\\log(|d_{K_j}|) - \\log(\\pi) + \\log(L(1, \\chi_{K_j})) $$\nNow we substitute this into our expression for $L$:\n$$ L = \\lim_{j\\to\\infty}\\frac{2 \\left( \\frac{1}{2}\\log(|d_{K_j}|) - \\log(\\pi) + \\log(L(1, \\chi_{K_j})) \\right)}{\\log(|d_{K_j}|)} $$\n$$ L = \\lim_{j\\to\\infty}\\left( 1 - \\frac{2\\log(\\pi)}{\\log(|d_{K_j}|)} + \\frac{2\\log(L(1, \\chi_{K_j}))}{\\log(|d_{K_j}|)} \\right) $$\nAs $j \\to \\infty$, we have $|d_{K_j}| \\to \\infty$ and thus $\\log(|d_{K_j}|) \\to \\infty$. The second term vanishes:\n$$ \\lim_{j\\to\\infty} \\frac{-2\\log(\\pi)}{\\log(|d_{K_j}|)} = 0 $$\nFor the third term, we use Siegel's theorem on Dirichlet L-functions. It states that for any $\\epsilon > 0$, there are constants $C_1(\\epsilon) > 0$ and $C_2 > 0$ such that for any primitive quadratic character $\\chi_d$ of discriminant $d$:\n$$ C_1(\\epsilon)|d|^{-\\epsilon}  L(1, \\chi_d)  C_2 \\log|d| $$\nTaking logarithms, we get:\n$$ \\log(C_1(\\epsilon)) - \\epsilon\\log|d|  \\log(L(1, \\chi_d))  \\log(C_2) + \\log(\\log|d|) $$\nDividing by $\\log|d|$:\n$$ \\frac{\\log(C_1(\\epsilon))}{\\log|d|} - \\epsilon  \\frac{\\log(L(1, \\chi_d))}{\\log|d|}  \\frac{\\log(C_2)}{\\log|d|} + \\frac{\\log(\\log|d|)}{\\log|d|} $$\nAs $|d| \\to \\infty$, the terms $\\frac{\\log(C_1(\\epsilon))}{\\log|d|}$, $\\frac{\\log(C_2)}{\\log|d|}$, and $\\frac{\\log(\\log|d|)}{\\log|d|}$ all approach $0$. This leaves us with:\n$$ -\\epsilon \\le \\liminf_{|d|\\to\\infty} \\frac{\\log(L(1, \\chi_d))}{\\log|d|} \\le \\limsup_{|d|\\to\\infty} \\frac{\\log(L(1, \\chi_d))}{\\log|d|} \\le 0 $$\nSince this must hold for any arbitrarily small $\\epsilon > 0$, we conclude that the limit exists and is equal to $0$:\n$$ \\lim_{|d|\\to\\infty} \\frac{\\log(L(1, \\chi_d))}{\\log|d|} = 0 $$\nApplying this to our sequence $(K_j)$:\n$$ \\lim_{j\\to\\infty} \\frac{2\\log(L(1, \\chi_{K_j}))}{\\log(|d_{K_j}|)} = 2 \\cdot 0 = 0 $$\nSubstituting the limits of the individual terms back into the expression for $L$:\n$$ L = 1 - 0 + 0 = 1 $$\nThis result is the statement of the Brauer-Siegel theorem for the family of imaginary quadratic fields.", "answer": "$$ \\boxed{1} $$", "id": "3025206"}, {"introduction": "Theoretical results in number theory gain profound intuitive support when they are confirmed by numerical evidence. Following our theoretical analysis of imaginary quadratic fields, this computational practice [@problem_id:3025202] provides a direct way to \"see\" the Brauer-Siegel theorem in action. You will implement an algorithm to compute class numbers from first principles and observe how the ratio $\\frac{\\log(h_K R_K)}{\\log\\sqrt{|D_K|}}$ numerically converges to $1$ as the discriminant grows, bridging the gap between abstract theory and concrete data.", "problem": "Let $K = \\mathbb{Q}(\\sqrt{d})$ be an imaginary quadratic field, where $d  0$ is squarefree. The discriminant $D_K$ of $K$ is defined by the standard rule: if $d \\equiv 1 \\pmod{4}$, then $D_K = d$, and otherwise $D_K = 4d$. The ideal class number $h_K$ is the cardinality of the ideal class group of $\\mathcal{O}_K$, and the regulator $R_K$ is defined via the logarithmic embedding of the unit group; for imaginary quadratic fields the unit group is finite, so $R_K = 1$ by definition. The Brauer-Siegel theorem asserts that for a sequence of number fields $K$ of fixed degree with $|D_K| \\to \\infty$, one has\n$$\n\\frac{\\log\\left(h_K R_K\\right)}{\\log\\sqrt{|D_K|}} \\to 1.\n$$\n\nYour task is to write a program that, for a collection of imaginary quadratic fields, computes:\n- the product $h_K R_K$,\n- $\\log|D_K|$,\n- and the ratio $\\frac{\\log(h_K R_K)}{\\log\\sqrt{|D_K|}}$,\n\nand numerically examines the trend of this ratio as $|D_K|$ increases. The computation of $h_K$ must be performed from first principles by counting reduced primitive positive definite binary quadratic forms of discriminant $D_K$; more precisely, for $D_K  0$, $h_K$ equals the number of reduced primitive binary quadratic forms $[a,b,c]$ with discriminant $D_K$, where $b^2 - 4ac = D_K$, $\\gcd(a,b,c) = 1$, $|b| \\le a \\le c$, and whenever $|b| = a$ or $a = c$, one additionally requires $b \\ge 0$. Do not use any shortcut formulas beyond these core definitions.\n\nUse the following test suite of squarefree radicands $d$ (all integers, all strictly negative), which is designed to cover the following:\n- typical smaller fields,\n- known edge cases with class number $1$ (which yield ratio $0$),\n- and progressively larger discriminants to observe the asymptotic behavior.\n\nTest suite values for $d$:\n- $-1$, $-2$, $-5$, $-6$, $-7$, $-10$, $-13$, $-37$, $-61$, $-101$, $-1009$, $-5003$, $-9973$, $-100003$.\n\nFor each $d$ in the test suite:\n1. Compute $D_K$.\n2. Compute $h_K$ by counting reduced primitive positive definite binary quadratic forms of discriminant $D_K$.\n3. Set $R_K = 1$.\n4. Compute the ratio $\\frac{\\log(h_K R_K)}{\\log\\sqrt{|D_K|}}$ using the natural logarithm.\n\nAll logarithms must be natural logarithms, and angles do not appear. No physical units are involved. The final output should be a single line with the ratios for the test suite, in the same order, as a comma-separated list enclosed in square brackets, with each ratio rounded to six decimal places (for example, \"[0.000000,0.463210,...]\"). If at any stage $h_K R_K = 1$, then the ratio must be exactly $0.000000$ after rounding.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").", "solution": "The problem is valid. It is a well-defined computational task in algebraic number theory, based on established, non-controversial principles. All required definitions, constants, and data are provided and are mutually consistent. The task is to numerically investigate the trend predicted by the Brauer-Siegel theorem for a specified set of imaginary quadratic fields.\n\nThe solution is constructed by implementing a step-by-step procedure for each given squarefree integer $d  0$ in the test suite.\n\n**1. Discriminant Computation**\n\nThe first step is to compute the discriminant $D_K$ of the imaginary quadratic field $K = \\mathbb{Q}(\\sqrt{d})$. The rule, as stated, is based on the congruence of $d$ modulo $4$:\n- If $d \\equiv 1 \\pmod{4}$, the discriminant is $D_K = d$.\n- If $d \\equiv 2 \\pmod{4}$ or $d \\equiv 3 \\pmod{4}$, the discriminant is $D_K = 4d$.\nSince $d$ is squarefree, $d$ cannot be congruent to $0 \\pmod{4}$. This fundamental invariant $D_K$ is always congruent to $0$ or $1 \\pmod{4}$.\n\n**2. Class Number Computation**\n\nThe most intensive part of the computation is determining the class number $h_K$. The problem mandates a calculation from first principles, specifically by counting the number of reduced primitive positive definite binary quadratic forms of discriminant $D_K$.\n\nA binary quadratic form, denoted as $[a,b,c]$, corresponds to the polynomial $ax^2 + bxy + cy^2$. For this form to be relevant to our problem, it must satisfy a set of specific conditions:\n- **Discriminant**: The discriminant of the form must be $D_K$, i.e., $b^2 - 4ac = D_K$.\n- **Positive Definite**: Since $D_K  0$, this is equivalent to requiring $a > 0$. Given $4ac = b^2 - D_K > 0$, if $a>0$, then $c$ must also be positive.\n- **Primitive**: The coefficients must be coprime, i.e., $\\gcd(a,b,c) = 1$.\n- **Reduced**: The form must satisfy the reduction conditions $|b| \\le a \\le c$. Additionally, if an equality holds, i.e., if $|b| = a$ or $a = c$, then it is required that $b \\ge 0$.\n\nThe value of $h_K$ is precisely the number of unique triples $[a,b,c]$ that satisfy all these conditions. To find this number, we develop an algorithm that enumerates these triples by leveraging constraints derived from the conditions themselves.\n\nFrom $|b| \\le a$ and $a \\le c$, we have $a^2 \\le c \\cdot a$. Thus, $4a^2 \\le 4ac = b^2 - D_K$.\nFrom the same condition, $b^2 \\le a^2$, so $4b^2 \\le 4a^2$.\nCombining these inequalities gives $3b^2 \\le b^2 - D_K$, which rearranges to $3b^2 \\le -D_K = |D_K|$. This provides a crucial search bound for the coefficient $b$:\n$$|b| \\le \\sqrt{\\frac{|D_K|}{3}}$$\nAdditionally, the discriminant equation $b^2 - 4ac = D_K$ implies that $b^2 \\equiv D_K \\pmod 4$. Since $D_K \\equiv 0$ or $1 \\pmod 4$, this means $b$ must have the same parity as $D_K$.\n\nThe algorithm for computing $h_K$ is as follows:\n1. Initialize a counter for $h_K$ to $0$.\n2. Iterate through integer values of $b$ from $0$ up to $\\lfloor\\sqrt{|D_K|/3}\\rfloor$, ensuring $b$ has the same parity as $D_K$.\n3. For each value of $b$, calculate the product $ac = (b^2 - D_K)/4$. This quantity must be an integer.\n4. Iterate through possible integer values for $a$. The reduction conditions constrain $a$. Since $b \\ge 0$ in our loop, $|b| \\le a$ becomes $b \\le a$. The condition $a \\le c$ implies $a^2 \\le ac$, hence $a \\le \\sqrt{ac}$. Thus, we search for divisors $a$ of the product $ac$ within the range $[\\max(1, b), \\lfloor\\sqrt{ac}\\rfloor]$.\n5. For each such divisor $a$, we find $c = ac/a$. We now have a candidate triple $[a,b,c]$.\n6. We verify if the form is primitive by checking if $\\gcd(a,b,c)=1$.\n7. If the form is primitive, we apply the counting rules based on the reduction conditions. Our search strategy considers only $b \\ge 0$:\n   - If the form is on the boundary of the fundamental domain, i.e., $b=0$, $b=a$, or $a=c$, it is counted once. The total count for $h_K$ is incremented by $1$.\n   - If the form is in the interior, i.e., $0  b  a  c$, it represents a pair of reduced forms, $[a,b,c]$ and $[a,-b,c]$. The total count for $h_K$ is incremented by $2$.\n\n**3. Ratio Computation**\n\nThe final step is to compute the ratio specified by the Brauer-Siegel theorem. For imaginary quadratic fields, the regulator $R_K$ is defined to be $1$. The ratio is:\n$$ L = \\frac{\\log(h_K R_K)}{\\log\\sqrt{|D_K|}} $$\nSubstituting $R_K=1$ and using the logarithm property $\\log(x^y) = y \\log(x)$, the expression simplifies:\n$$ L = \\frac{\\log(h_K)}{\\frac{1}{2}\\log|D_K|} = \\frac{2\\log(h_K)}{\\log|D_K|} $$\nThe logarithms used are natural logarithms (base $e$). In the special case where the class number $h_K=1$, the numerator $\\log(1)=0$, making the ratio $0$. The denominator is always non-zero, as $|D_K| \\ge 3$ for all imaginary quadratic fields.\n\nThe provided Python program implements this complete methodology. It iterates through the list of given $d$ values, performs these calculations for each, formats the resulting ratio to six decimal places, and produces the final output as a single comma-separated list.", "answer": "```python\nimport math\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to compute and print the Brauer-Siegel ratio for a test suite.\n    \"\"\"\n\n    def compute_discriminant(d: int) - int:\n        \"\"\"\n        Computes the discriminant D_K for K = Q(sqrt(d)).\n        d must be a squarefree integer.\n        \"\"\"\n        # In Python, for negative d, d % 4 gives a result in {0, 1, 2, 3}.\n        # d = 4k+r, r = d % 4. e.g., -7 = 4*(-2)+1, so -7 % 4 = 1.\n        if d % 4 == 1:\n            return d\n        else:\n            return 4 * d\n\n    def compute_class_number(d_k: int) - int:\n        \"\"\"\n        Computes the class number h_K for a given negative discriminant d_k.\n        This is done by counting reduced primitive binary quadratic forms.\n        \"\"\"\n        h_k = 0\n        abs_dk = abs(d_k)\n        limit_b = int(math.sqrt(abs_dk / 3.0))\n\n        # b must have same parity as d_k since b^2 = d_k (mod 4) is impossible\n        # if they have different parity, and b^2-d_k must be divisible by 4.\n        # d_k % 2 is 0 for even, 1 for odd. range() starts at d_k%2 and steps by 2.\n        for b in range(abs(d_k % 2), limit_b + 1, 2):\n            val = b * b - d_k\n            # This check is technically redundant due to the parity step, but safe.\n            if val % 4 != 0:\n                continue\n            \n            ac_prod = val // 4\n            limit_a = int(math.sqrt(ac_prod))\n            \n            # Per reduction conditions |b| = a. Since b = 0, b = a.\n            # Start a from max(1, b) to ensure a  0.\n            start_a = max(1, b)\n\n            for a in range(start_a, limit_a + 1):\n                if ac_prod % a == 0:\n                    c = ac_prod // a\n                    \n                    # We have a candidate form [a, b, c].\n                    # Conditions |b| = a and a = c are guaranteed by loop bounds.\n                    # We need to check for primitivity: gcd(a,b,c) = 1.\n                    if math.gcd(math.gcd(a, b), c) == 1:\n                        # The form is primitive and reduced (with b = 0).\n                        # Now apply the counting logic.\n                        if b == a or a == c or b == 0:\n                            # Boundary forms are counted once.\n                            h_k += 1\n                        else: # 0  b  a  c\n                            # Interior forms correspond to two reduced forms: [a,b,c] and [a,-b,c].\n                            h_k += 2\n        return h_k\n\n    # Test suite of squarefree radicands d  0\n    test_cases_d = [\n        -1, -2, -5, -6, -7, -10, -13, -37, -61, -101, -1009, -5003, -9973, -100003\n    ]\n\n    results = []\n    for d in test_cases_d:\n        # Step 1: Compute discriminant\n        d_k = compute_discriminant(d)\n        \n        # Step 2: Compute class number\n        h_k = compute_class_number(d_k)\n        \n        # Step 3: Compute the ratio\n        r_k = 1\n        h_r_prod = h_k * r_k\n\n        if h_r_prod == 1:\n            ratio = 0.0\n        else:\n            log_hr = math.log(h_r_prod)\n            # The ratio is log(h_k*R_k) / log(sqrt(|D_k|))\n            # which simplifies to 2 * log(h_k) / log(|D_k|)\n            log_abs_dk = math.log(abs(d_k))\n            ratio = 2 * log_hr / log_abs_dk\n            \n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3025202"}]}