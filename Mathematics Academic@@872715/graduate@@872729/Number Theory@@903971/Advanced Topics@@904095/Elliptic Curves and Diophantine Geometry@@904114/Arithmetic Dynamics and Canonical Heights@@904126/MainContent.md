## Introduction
The field of [arithmetic dynamics](@entry_id:193598) emerges at the vibrant intersection of number theory and [discrete dynamical systems](@entry_id:154936), investigating the arithmetic properties of points on algebraic varieties as they evolve under repeated iteration of a rational map. This dynamic process, where the arithmetic complexity of points can grow exponentially, presents significant challenges to classical tools. The standard Weil height, a fundamental measure of complexity in Diophantine geometry, fails to behave perfectly under iteration, exhibiting an error term that complicates the analysis of long-term behavior.

This article addresses this gap by introducing and exploring the [canonical height](@entry_id:192614), a refined function that is perfectly tailored to the dynamics of an iterated map. It serves as the central organizing principle in the field, transforming complex orbital behavior into a linear structure that is amenable to analysis. Across three chapters, you will gain a comprehensive understanding of this powerful tool. The first chapter, "Principles and Mechanisms," lays the theoretical groundwork, formally defining the [canonical height](@entry_id:192614) and exploring its fundamental properties and connections to the Néron-Tate height. "Applications and Interdisciplinary Connections" demonstrates its utility, showcasing how it solves problems in Diophantine geometry and links [arithmetic dynamics](@entry_id:193598) to fields like complex analysis and algebraic geometry. Finally, "Hands-On Practices" offers exercises to solidify your understanding of both global and local height computations. We begin by establishing the core principles that make the [canonical height](@entry_id:192614) an indispensable tool in modern number theory.

## Principles and Mechanisms

The study of [arithmetic dynamics](@entry_id:193598) lies at the confluence of number theory and dynamical systems. It investigates the arithmetic properties of number-theoretic objects, such as points on a variety, as they evolve under the repeated application of a rational map. This chapter delves into the core principles and mechanisms that govern this evolution, focusing on the central tool of the [canonical height](@entry_id:192614) function. We will formalize the objects of study, construct the [canonical height](@entry_id:192614), explore its local and global properties, and culminate in a discussion of the profound theorems it enables.

### Foundations: Morphisms, Heights, and Iteration

Our primary setting is the projective line $\mathbb{P}^1$ defined over a [number field](@entry_id:148388) $K$. A point in $\mathbb{P}^1(K)$ is an [equivalence class](@entry_id:140585) of pairs $[X:Y]$ with $X, Y \in K$, not both zero, under the relation $[X:Y] \sim [\lambda X : \lambda Y]$ for any $\lambda \in K^\times$. A rational self-map, or **morphism**, $f: \mathbb{P}^1 \to \mathbb{P}^1$ of degree $d \ge 2$ defined over $K$ is a map given by homogeneous polynomials.

Specifically, such a morphism can be represented by a pair of homogeneous polynomials $P, Q \in K[X,Y]$ of the same degree $d$. The map is given by $f([X:Y]) = [P(X,Y):Q(X,Y)]$. For $f$ to be a well-defined morphism on all of $\mathbb{P}^1$, the polynomials $P$ and $Q$ must not vanish simultaneously for any point in $\mathbb{P}^1(\overline{K})$. By Hilbert's Nullstellensatz, this is equivalent to requiring that $P$ and $Q$ have no common non-constant factor in the polynomial ring $\overline{K}[X,Y]$. Such a representation is called **normalized**.

Associated with the morphism $f$ on the [projective space](@entry_id:149949) is a **homogeneous lift**, which is a polynomial map $F: \mathbb{A}^2 \to \mathbb{A}^2$ on the affine space of coordinates, given by $F(X,Y) = (P(X,Y), Q(X,Y))$. This lift is not unique; if $F=(P,Q)$ is a lift, then for any nonzero scalar $c \in K^\times$, the map $F'=(cP, cQ)$ is also a valid lift that induces the same morphism $f$ on $\mathbb{P}^1$ [@problem_id:3008183].

The dynamics of the system are generated by **iteration**. The $n$-th iterate of $f$, denoted $f^n$, is the $n$-fold composition $f \circ f \circ \dots \circ f$. A crucial property is that the degree of the iterates grows exponentially: if $\deg(f) = d$, then $\deg(f^n) = d^n$. This [exponential growth](@entry_id:141869) is a hallmark of complex dynamics and is mirrored in the arithmetic complexity of the points in an orbit. If $F$ is a homogeneous lift of $f$, then the $n$-fold composition of maps $F^{\circ n} = F \circ \dots \circ F$ is a homogeneous lift for the iterate $f^n$ [@problem_id:3008183].

To measure the arithmetic complexity of points, number theory employs **[height functions](@entry_id:181180)**. The fundamental height function is the absolute logarithmic **Weil height**, $h: \mathbb{P}^1(\overline{K}) \to \mathbb{R}_{\ge 0}$. For a point $P=[x:y] \in \mathbb{P}^1(\overline{K})$, one can always find a number field $K$ containing the ratio $x/y$. The height is then defined as a sum over all places of $K$:
$$
h([x:y]) = \frac{1}{[K:\mathbb{Q}]} \sum_{v \in M_K} n_v \log\max\{|x|_v, |y|_v\},
$$
where $M_K$ is the set of places (equivalence classes of absolute values) of $K$, $|\cdot|_v$ is a normalized absolute value in the class $v$, and $n_v = [K_v : \mathbb{Q}_v]$ is the local degree. The definition is independent of the choice of [homogeneous coordinates](@entry_id:154569) for $P$ and the choice of [number field](@entry_id:148388) $K$ containing them, a consequence of the [product formula](@entry_id:137076) $\sum_{v \in M_K} n_v \log |z|_v = 0$ for any $z \in K^\times$.

As a concrete example, let's compute the Weil height of a root $\alpha$ of the [irreducible polynomial](@entry_id:156607) $f(x) = 3x^2 - x - 1 = 0$ [@problem_id:3008195]. The roots are $\alpha_{1,2} = (1 \pm \sqrt{13})/6$. Let $\alpha = \alpha_1$. The [minimal polynomial](@entry_id:153598) of $\alpha$ over $\mathbb{Q}$ is indeed $3x^2-x-1$. Let $K = \mathbb{Q}(\alpha) = \mathbb{Q}(\sqrt{13})$, which has degree $[K:\mathbb{Q}]=2$. We can compute $h(\alpha) = h([\alpha:1])$ by summing the local contributions.
The archimedean (infinite) places correspond to the two real embeddings of $K$: $\sigma_1(\alpha) = (1+\sqrt{13})/6$ and $\sigma_2(\alpha) = (1-\sqrt{13})/6$. Since $|\sigma_1(\alpha)|  1$ and $|\sigma_2(\alpha)|  1$, the archimedean contribution to the height is $\frac{1}{2}(\log\max\{|\sigma_1(\alpha)|, 1\} + \log\max\{|\sigma_2(\alpha)|, 1\}) = \frac{1}{2}(0+0)=0$.
For the non-archimedean (finite) places, a contribution occurs only where $|\alpha|_v > 1$, which means the $v$-adic valuation of $\alpha$ is negative. Writing $\alpha = \beta/3$ where $\beta = (1+\sqrt{13})/2$ is an [algebraic integer](@entry_id:155088), we see that $v_v(\alpha)  0$ only if the prime ideal corresponding to $v$ divides the ideal $(3)$. In $K=\mathbb{Q}(\sqrt{13})$, the prime $3$ splits into two [prime ideals](@entry_id:154026), $(3) = \mathfrak{p}_1 \mathfrak{p}_2$. A detailed analysis shows that $v_{\mathfrak{p}_1}(\alpha) = 0$ and $v_{\mathfrak{p}_2}(\alpha) = -1$. The only non-zero contribution comes from the place $v_{\mathfrak{p}_2}$, where $|\alpha|_{v_{\mathfrak{p}_2}} = N(\mathfrak{p}_2)^{-v_{\mathfrak{p}_2}(\alpha)} = 3^{-(-1)} = 3$. The local degree is $n_{v_{\mathfrak{p}_2}}=1$. The total height is thus $h(\alpha) = \frac{1}{2} (0 + n_{v_{\mathfrak{p}_2}}\log\max\{|\alpha|_{v_{\mathfrak{p}_2}},1\}) = \frac{1}{2} (1 \cdot \log 3) = \frac{1}{2}\ln(3)$.

### The Canonical Height: Definition and Fundamental Properties

The Weil height behaves well with respect to the algebra of varieties, but its interaction with dynamics is imperfect. For a morphism $f$ of degree $d$, [functoriality](@entry_id:150069) implies $h(f(P))$ is approximately $d \cdot h(P)$, but there is an error term: $h(f(P)) = d \cdot h(P) + O(1)$, where the bound depends on $f$. To obtain a tool perfectly adapted to the dynamics, we average out this error.

The **[canonical height](@entry_id:192614)** associated to $f$, denoted $\hat{h}_f$, is defined by the limit construction of Tate:
$$
\hat{h}_f(P) = \lim_{n\to\infty} \frac{1}{d^n} h(f^n(P)).
$$
This limit exists for all $P \in \mathbb{P}^1(\overline{K})$ and defines a function with remarkable properties. It is uniquely characterized by two conditions [@problem_id:3008184] [@problem_id:3008159]:
1.  **Functional Equation**: It transforms perfectly under the dynamics: $\hat{h}_f(f(P)) = d \cdot \hat{h}_f(P)$.
2.  **Normalization**: It is asymptotically equivalent to the Weil height: the difference $h(P) - \hat{h}_f(P)$ is a bounded function on $\mathbb{P}^1(\overline{K})$.

In some elementary cases, the [canonical height](@entry_id:192614) can be equal to the Weil height. Consider the map $f([X:Y]) = [X^d:Y^d]$ on $\mathbb{P}^1$. For a point $P=[\alpha:1]$, we have $f^n(P) = [\alpha^{d^n}:1]$. A direct calculation shows $h([\alpha^m:1])=m \cdot h([\alpha:1])$. Thus, $h(f^n(P)) = h([\alpha^{d^n}:1]) = d^n h([\alpha:1]) = d^n h(P)$. The limit becomes trivial:
$$
\hat{h}_f(P) = \lim_{n\to\infty} \frac{1}{d^n} (d^n h(P)) = h(P).
$$
The same holds for the [point at infinity](@entry_id:154537). Thus, for this special map, the [canonical height](@entry_id:192614) is identical to the Weil height, and the bounded difference is identically zero [@problem_id:3008170]. For most maps, however, this difference is a non-trivial but bounded function.

The most profound property of the [canonical height](@entry_id:192614) is its connection to the orbital structure of the dynamical system. We distinguish two types of finite orbits. A point $P$ is **periodic** if $f^n(P)=P$ for some $n \ge 1$. A point $P$ is **preperiodic** if its forward orbit $\{f^n(P)\}_{n \ge 0}$ is a [finite set](@entry_id:152247), meaning it eventually lands in a cycle. Every periodic point is preperiodic, but the converse is not true. For example, for the map $f(x)=x^2-1$ on $\mathbb{P}^1$, the point $P=1$ has the orbit $1 \mapsto 0 \mapsto -1 \mapsto 0 \mapsto \dots$. The orbit is $\{1, 0, -1\}$, which is finite, so $P=1$ is preperiodic. However, since $f^n(1)$ is never $1$ for $n \ge 1$, the point is not periodic [@problem_id:3008190].

The fundamental theorem, an analogue of Kronecker's theorem for [roots of unity](@entry_id:142597), states that the [canonical height](@entry_id:192614) vanishes precisely on the set of [preperiodic points](@entry_id:201985).
$$
\hat{h}_f(P) = 0 \quad \iff \quad P \text{ is a preperiodic point.}
$$
For the point $P=1$ under $f(x)=x^2-1$, since it is preperiodic, we can immediately conclude $\hat{h}_f(1) = 0$. This can be verified from the limit definition, as the Weil heights of the points in its orbit $\{1, 0, -1\}$ are all zero [@problem_id:3008190].

### Generalizations and Analogies: The Néron-Tate Height

The concept of a [canonical height](@entry_id:192614) is not limited to dynamics on $\mathbb{P}^1$. It exists in a much more general context. A morphism $f: X \to X$ on a projective variety $X$ is said to be **polarizable** if there is an ample line bundle $L$ on $X$ and an integer $q  1$ such that the [pullback bundle](@entry_id:159346) $f^*L$ is isomorphic to the tensor power $L^{\otimes q}$. For any such triple $(X, f, L)$, one can construct a unique [canonical height](@entry_id:192614) $\hat{h}_f$ associated to $L$ satisfying the functional equation $\hat{h}_f(f(P)) = q \cdot \hat{h}_f(P)$ and differing from the Weil height $h_L$ by a bounded amount [@problem_id:3008184].

The most celebrated historical example of this construction comes from the theory of [abelian varieties](@entry_id:199085). Let $E$ be an [elliptic curve](@entry_id:163260) over $K$. The multiplication-by-$m$ map, $[m]: E \to E$ for an integer $m \ge 2$, is a polarizable endomorphism. For any symmetric ample line bundle $L$ on $E$, one has $[m]^*L \cong L^{\otimes m^2}$. This means $f=[m]$ is polarizable with $q=m^2$. The resulting dynamical [canonical height](@entry_id:192614) is precisely the famous **Néron-Tate [canonical height](@entry_id:192614)** $\hat{h}_E$ [@problem_id:3008184].

The Néron-Tate height on an elliptic curve possesses a rich structure [@problem_id:3008199]:
-   It can be constructed via the same limit process: $\hat{h}_E(P) = \lim_{n\to\infty} (m^2)^{-n} h_x([m^n]P)$, where $h_x$ is the Weil height of the $x$-coordinate.
-   It satisfies the quadratic property $\hat{h}_E([m]P) = m^2 \hat{h}_E(P)$, making it a [quadratic form](@entry_id:153497) on the Mordell-Weil group $E(K)$.
-   It vanishes precisely on the [torsion points](@entry_id:192744) of $E$, which are the [preperiodic points](@entry_id:201985) for the endomorphisms $[m]$.

This parallel illustrates that the theory of canonical heights in dynamics is a natural and vast generalization of the classical theory for [abelian varieties](@entry_id:199085).

### Local Decompositions and Adelic Metrics

A deeper understanding of the [canonical height](@entry_id:192614) comes from decomposing it into a sum of local contributions, one for each place of the number field $K$. This [local-global principle](@entry_id:201564) is a powerful theme in modern number theory.

Just as the global Néron-Tate height $\hat{h}_E(P)$ on an elliptic curve can be expressed as a weighted sum of **local Néron heights** $\lambda_v(P)$, which are themselves defined by local limits, the dynamical [canonical height](@entry_id:192614) $\hat{h}_f$ admits a similar decomposition [@problem_id:3008199].
$$
\hat{h}_f(P) = \sum_{v \in M_K} \frac{[K_v:\mathbb{Q}_v]}{[K:\mathbb{Q}]} \lambda_{f,v}(P)
$$
This perspective is best captured in the language of Arakelov geometry. The [canonical height](@entry_id:192614) $\hat{h}_f$ can be understood as the height associated with an **adelic metrized line bundle** $\overline{\mathcal{O}(1)}_f$. This object consists of the standard line bundle $\mathcal{O}(1)$ on $\mathbb{P}^1$ equipped with a special, canonical metric $\|\cdot\|_{f,v}$ on the fibers over the completion $K_v$ for each place $v \in M_K$ [@problem_id:3008177].

These [canonical metrics](@entry_id:266957) are constructed from local [potential functions](@entry_id:176105), often called **Green's functions**, defined by a limit capturing the local [escape rate](@entry_id:199818) of points under iteration of a lift $F$:
$$
G_{f,v}(z) = \lim_{n\to\infty} \frac{1}{d^n} \log \|F^n(z)\|_v \quad \text{for } z \in \mathbb{A}^2(K_v).
$$
The crucial property of this collection of metrics is its equivariance under the dynamics. The pullback of the metrized bundle by $f$ is isometric to its own $d$-th tensor power:
$$
f^*\overline{\mathcal{O}(1)}_f \cong \overline{\mathcal{O}(1)}_f^{\otimes d}.
$$
This isomorphism of metrized line bundles is the geometric underpinning of the functional equation $\hat{h}_f(f(P)) = d \cdot \hat{h}_f(P)$ for the global height [@problem_id:3008177].

The nature of the canonical metric $\|\cdot\|_{f,v}$ depends on the local behavior of the map $f$ at the non-archimedean place $v$. We say $f$ has **dynamical good reduction** at $v$ if it can be represented by a lift $F=(P,Q)$ with coefficients in the valuation ring $\mathcal{O}_v$ whose reduction modulo the [maximal ideal](@entry_id:151331), $\overline{F}$, still defines a morphism of degree $d$. This is equivalent to the resultant of $F$ being a $v$-adic unit. A key property is that good reduction is stable under iteration: if $f$ has good reduction at $v$, then so does $f^n$ for all $n \ge 1$, and the reduction of the iterate is the iterate of the reduction, $(f^n)_v = (f_v)^n$ [@problem_id:3008192]. At such places of good reduction, the canonical metric $\|\cdot\|_{f,v}$ coincides with the standard $v$-adic metric on $\mathcal{O}(1)$. This greatly simplifies local analysis.

### Major Theorems and Conjectures

The [canonical height](@entry_id:192614) is not merely a technical tool; it is the key that unlocks some of the deepest results in [arithmetic dynamics](@entry_id:193598), revealing a profound interplay between local analytic properties and global arithmetic structure.

#### The Equidistribution Theorem

One of the cornerstone results is the **[equidistribution theorem](@entry_id:201508)** of Favre, Rivera-Letelier, Baker, and Rumely. It describes the [asymptotic distribution](@entry_id:272575) of the Galois conjugates of points with small [canonical height](@entry_id:192614). Consider a sequence of distinct points $(P_n)_{n \ge 1}$ in $\mathbb{P}^1(\overline{K})$ that are not preperiodic, but whose canonical heights tend to zero: $\hat{h}_f(P_n) \to 0$. Northcott's property for heights implies that their degrees must tend to infinity: $[K(P_n):K] \to \infty$.

For each point $P_n$ and each place $v$ of $K$, one can form a probability measure $\nu_{n,v}$ on the corresponding analytic space (the Riemann sphere $\mathbb{P}^1(\mathbb{C})$ or the Berkovich line $\mathbb{P}^{1,\text{an}}_{\mathbb{C}_v}$) by placing a point mass at each Galois conjugate of $P_n$ and averaging. The theorem states that this sequence of measures converges weakly to a canonical measure:
$$
\nu_{n,v} \rightharpoonup \mu_{f,v} \quad \text{as } n \to \infty.
$$
The limit measure $\mu_{f,v}$ is the unique $f$-invariant probability measure of maximal entropy, canonically associated to the dynamics of $f$ at the place $v$. At archimedean places, its support is the **Julia set** of $f$ [@problem_id:3008184] [@problem_id:3008203].

The proof elegantly combines the local-global structure of the [canonical height](@entry_id:192614) with [potential theory](@entry_id:141424). The global height $\hat{h}_f(P_n)$ is a sum of non-negative local "energy" terms, $\int g_{f,v} \, d\nu_{n,v}$, where $g_{f,v}$ is the local Green's function. As $\hat{h}_f(P_n) \to 0$, each local energy term must also approach zero. Potential theory dictates that the energy functional has a unique minimizer, which is precisely the equilibrium measure $\mu_{f,v}$. Therefore, the sequence of measures $\nu_{n,v}$ must converge to $\mu_{f,v}$ at every place $v$ [@problem_id:3008203]. This result holds in full generality, with no assumption on the reduction type of $f$.

#### The Dynamical Lehmer Conjecture

While the [canonical height](@entry_id:192614) of a non-preperiodic point is strictly positive, a major open question asks whether there is a uniform lower bound. This is the **dynamical Lehmer conjecture**, formulated in analogy with the classical Lehmer conjecture for heights of [algebraic numbers](@entry_id:150888). A standard version of the conjecture states that for any rational map $f$ of degree $d \ge 2$ over a number field $K$, there exists a constant $c(f,K) > 0$ such that for any non-preperiodic point $P \in \mathbb{P}^1(\overline{K})$, we have
$$
\hat{h}_f(P) \ge \frac{c(f,K)}{[K(P):K]}.
$$
This conjecture posits that while points of small height must have large degree, their height cannot be arbitrarily small relative to their complexity [@problem_id:3008159].

The conjecture remains open, but significant partial results are known.
-   In the function field setting, for a non-isotrivial map $f$ (one that is not constant over the base field after a change of coordinates), the conjecture is true in a much stronger form. A theorem of Matthew Baker shows that there is a uniform lower bound $\hat{h}_f(P) \ge c(f) > 0$, independent of the degree of $P$.
-   For **Lattès maps**, which are induced by endomorphisms of [elliptic curves](@entry_id:152409), the conjecture reduces to finding lower bounds for the Néron-Tate height. The best known results for elliptic curves provide a bound of the conjectured shape.

The dynamical Lehmer conjecture and the [equidistribution theorem](@entry_id:201508) are two sides of the same coin: one describes the [discreteness of the spectrum](@entry_id:636233) of height values, while the other describes the geometric distribution of points whose heights approach the lowest possible non-zero value. Both highlight the remarkable power of the [canonical height](@entry_id:192614) to organize the intricate arithmetic of iterated maps.