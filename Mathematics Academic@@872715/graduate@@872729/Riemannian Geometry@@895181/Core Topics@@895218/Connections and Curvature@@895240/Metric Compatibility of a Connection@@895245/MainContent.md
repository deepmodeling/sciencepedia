## Introduction
On a Riemannian manifold, we have two fundamental structures: an [affine connection](@entry_id:160152) $\nabla$ for differentiating vector fields and a metric tensor $g$ for measuring lengths and angles. A crucial question in differential geometry is how these two structures should interact. Without a guiding principle, [parallel transport](@entry_id:160671)—the process of moving vectors along curves—could arbitrarily stretch, shrink, or distort the very geometric quantities we wish to study. This article addresses this foundational problem by introducing the principle of [metric compatibility](@entry_id:265910), a condition that harmonizes the connection with the metric.

This exploration is divided into three parts. First, in "Principles and Mechanisms," we will formally define [metric compatibility](@entry_id:265910), explore its geometric meaning of preserving lengths and angles, and culminate in the Fundamental Theorem of Riemannian Geometry, which establishes the unique Levi-Civita connection. Next, "Applications and Interdisciplinary Connections" will demonstrate the power of this concept in settings ranging from the curved spacetimes of general relativity to the algebraic structures of Lie groups. Finally, "Hands-On Practices" provides a set of targeted exercises to solidify your understanding of these theoretical and applied concepts. We begin by delving into the core principles that make [metric compatibility](@entry_id:265910) the bedrock of Riemannian geometry.

## Principles and Mechanisms

In the preceding chapter, we introduced the concept of an [affine connection](@entry_id:160152) $\nabla$ on a [smooth manifold](@entry_id:156564), which provides a framework for differentiating vector fields. On a Riemannian manifold $(M,g)$, however, we possess an additional structure: a metric tensor $g$ that equips each [tangent space](@entry_id:141028) with an inner product. A natural and fundamental question arises: how should the notion of differentiation provided by $\nabla$ interact with the geometric structure provided by $g$? This chapter explores the principle of **[metric compatibility](@entry_id:265910)**, a condition that harmonizes the connection with the metric, and investigates its profound mechanical consequences, culminating in the establishment of a unique and canonical connection for any Riemannian manifold.

### The Concept of a Metric-Compatible Connection

An [affine connection](@entry_id:160152) allows for the **parallel transport** of vectors along curves. This process enables us to compare vectors residing in different [tangent spaces](@entry_id:199137). In a purely topological or [smooth manifold](@entry_id:156564), there is no inherent notion of the "length" of a [tangent vector](@entry_id:264836) or the "angle" between two such vectors. On a Riemannian manifold, the metric $g$ provides precisely this geometric information. It is therefore highly desirable for the process of [parallel transport](@entry_id:160671) to respect this geometry. That is, if we transport two vectors along a curve, we would expect their inner product, and consequently their individual lengths and the angle between them, to remain unchanged. A connection that satisfies this property is said to be compatible with the metric.

To appreciate the importance of this condition, let us consider a connection that is *not* [metric-compatible](@entry_id:160255). Imagine a scenario on $M=\mathbb{R}^{2}\setminus\{(0,0)\}$ with the standard Euclidean metric $g_0 = dx^2 + dy^2$. One could define a [torsion-free connection](@entry_id:181337) $\nabla$ whose deviation from [metric compatibility](@entry_id:265910) is governed by a specific [1-form](@entry_id:275851), such as $\omega = k \, d\theta$ for a non-zero constant $k$, where $\theta$ is the [polar angle](@entry_id:175682). The rule for this connection's [non-metricity](@entry_id:180322) might be set as $(\nabla_{X} g_{0})(Y,Z) = \omega(X) g_{0}(Y,Z)$. If we take two vectors $U_0, V_0$ at a point on a circle of radius $R$ and parallel-transport them once around the origin along this circle, their final inner product can be shown to be related to the initial one by a scaling factor [@problem_id:2984100]. The calculation reveals that $g_0(U(2\pi), V(2\pi)) = \exp(2\pi k) g_0(U(0), V(0))$. Since $k \neq 0$, the inner product is not preserved; [parallel transport](@entry_id:160671) along this closed loop stretches or shrinks the vectors' geometric relationships. Such behavior complicates the very notion of a consistent geometry across the manifold.

To prevent such distortion, we impose the condition of [metric compatibility](@entry_id:265910). Formally, a connection $\nabla$ is **[metric-compatible](@entry_id:160255)** if the [covariant derivative of the metric tensor](@entry_id:198162) is zero, i.e., $\nabla g = 0$. The covariant derivative of the $(0,2)$-tensor $g$ with respect to a vector field $X$ is a $(0,3)$-tensor whose action on vector fields $Y$ and $Z$ is defined by the Leibniz rule:
$$ (\nabla_X g)(Y,Z) = X\big(g(Y,Z)\big) - g(\nabla_X Y, Z) - g(Y, \nabla_X Z) $$
The condition $\nabla g = 0$ thus means that $(\nabla_X g)(Y,Z) = 0$ for all smooth [vector fields](@entry_id:161384) $X, Y, Z$. This leads to the most common and intuitive formulation of [metric compatibility](@entry_id:265910), often presented as its definition [@problem_id:2974952] [@problem_id:2974971] [@problem_id:3025041]:
$$ X\big(g(Y,Z)\big) = g(\nabla_X Y, Z) + g(Y, \nabla_X Z) $$
This equation can be interpreted as a product rule for the metric tensor with respect to [covariant differentiation](@entry_id:263981). It states that the change of the inner product of two [vector fields](@entry_id:161384) in the direction of a third field $X$ is determined by how those vector fields themselves change covariantly.

### The Geometric Interpretation: Preservation of Geometry

The abstract condition $\nabla g = 0$ has a powerful and concrete geometric meaning: parallel transport preserves all geometric quantities derived from the metric.

Let $\gamma(t)$ be a smooth curve on $M$, and let $V(t)$ and $W(t)$ be two [vector fields](@entry_id:161384) along $\gamma$. We can investigate how their inner product $g(V(t), W(t))$ changes along the curve by taking its derivative with respect to $t$. Using the product rule formulation derived above, with the [directional derivative](@entry_id:143430) along the curve being the covariant derivative with respect to the [tangent vector](@entry_id:264836) $\dot{\gamma}(t)$, we have:
$$ \frac{d}{dt} g(V(t), W(t)) = g(\nabla_{\dot{\gamma}} V(t), W(t)) + g(V(t), \nabla_{\dot{\gamma}} W(t)) $$
Now, suppose that $V(t)$ and $W(t)$ are **parallel-transported** along $\gamma$. By definition, this means that their covariant derivatives along the curve are zero: $\nabla_{\dot{\gamma}} V(t) = 0$ and $\nabla_{\dot{\gamma}} W(t) = 0$. Substituting this into the equation above yields:
$$ \frac{d}{dt} g(V(t), W(t)) = g(0, W(t)) + g(V(t), 0) = 0 $$
Since the derivative is zero for all $t$, the inner product $g(V(t), W(t))$ must be constant along the curve [@problem_id:2974952] [@problem_id:2974971] [@problem_id:3025041]. This is a profound result. It confirms that a [metric-compatible connection](@entry_id:194538) ensures that [parallel transport](@entry_id:160671) is an isometry between tangent spaces. Specifically:
-   **Lengths are preserved:** For any vector $V$, its length squared is $g(V,V)$. If $V(t)$ is parallel along $\gamma$, then $g(V(t), V(t))$ is constant.
-   **Angles are preserved:** The angle $\theta$ between two non-zero vectors $V$ and $W$ is given by $\arccos\left(\frac{g(V,W)}{\sqrt{g(V,V)g(W,W)}}\right)$. Since parallel transport preserves both the inner product and the lengths, it must also preserve the angle.

A beautiful global consequence of this property relates to the **[holonomy group](@entry_id:160097)**. The [holonomy group](@entry_id:160097) at a point $p$, denoted $\mathrm{Hol}_p(g)$, consists of all [linear transformations](@entry_id:149133) of the tangent space $T_pM$ obtained by parallel transporting vectors around all possible closed loops starting and ending at $p$. Since [parallel transport](@entry_id:160671) along any curve is an [isometry](@entry_id:150881) from the starting [tangent space](@entry_id:141028) to the ending [tangent space](@entry_id:141028), for a loop it is a self-isometry of $T_pM$. This means that every element of the [holonomy group](@entry_id:160097) must preserve the inner product $g_p$. The group of all such linear isometries on $T_pM$ is the [orthogonal group](@entry_id:152531) $O(T_pM, g_p)$. Therefore, [metric compatibility](@entry_id:265910) immediately implies that the [holonomy group](@entry_id:160097) is a subgroup of the [orthogonal group](@entry_id:152531): $\mathrm{Hol}_p(g) \subset O(T_pM, g_p)$ [@problem_id:2999896]. Furthermore, if the manifold is oriented, the connection also preserves the [volume form](@entry_id:161784), which restricts the holonomy transformations to be orientation-preserving, meaning $\mathrm{Hol}_p(g) \subset SO(T_pM, g_p)$ [@problem_id:2999896].

### The Coordinate Expression of Metric Compatibility

To perform concrete calculations, it is essential to express the condition of [metric compatibility](@entry_id:265910) in [local coordinates](@entry_id:181200) $(x^1, \dots, x^n)$. The basis [vector fields](@entry_id:161384) are $\partial_i = \frac{\partial}{\partial x^i}$, the metric components are $g_{ij} = g(\partial_i, \partial_j)$, and the connection is described by the **Christoffel symbols** $\Gamma^k_{ij}$ through the relation $\nabla_{\partial_i} \partial_j = \Gamma^k_{ij} \partial_k$.

The condition $\nabla g = 0$ is equivalent to $(\nabla_{\partial_k} g)(\partial_i, \partial_j) = 0$ for all $i,j,k$. Applying the definition of the [covariant derivative](@entry_id:152476) of $g$:
$$ (\nabla_{\partial_k} g)(\partial_i, \partial_j) = \partial_k\big(g(\partial_i, \partial_j)\big) - g(\nabla_{\partial_k} \partial_i, \partial_j) - g(\partial_i, \nabla_{\partial_k} \partial_j) = 0 $$
Substituting the definitions of $g_{ij}$ and the Christoffel symbols gives:
$$ \partial_k g_{ij} - g(\Gamma^s_{ki} \partial_s, \partial_j) - g(\partial_i, \Gamma^s_{kj} \partial_s) = 0 $$
Using the [bilinearity](@entry_id:146819) of $g$ and the definition of its components, we arrive at the coordinate expression for [metric compatibility](@entry_id:265910) [@problem_id:2974952]:
$$ \partial_k g_{ij} - \Gamma^s_{ki} g_{sj} - \Gamma^s_{kj} g_{is} = 0 $$
This equation must hold for all indices $i, j, k$. For instance, in a 2D manifold with coordinates $(u,v)$, the specific component $\nabla_u g_{vv}=0$ expands to [@problem_id:1525675]:
$$ \frac{\partial g_{vv}}{\partial u} - \Gamma^m_{uv}g_{mv} - \Gamma^m_{uv}g_{vm} = \frac{\partial g_{vv}}{\partial u} - 2\Gamma^u_{uv}g_{uv} - 2\Gamma^v_{uv}g_{vv} = 0 $$
It is crucial to correct a common misconception. Metric compatibility, $\nabla_k g_{ij} = 0$, does *not* imply that the partial derivatives of the metric components, $\partial_k g_{ij}$, are zero [@problem_id:2974952]. The components $g_{ij}$ are functions of the coordinates and will generally change from point to point. The [metric compatibility](@entry_id:265910) equation shows that the Christoffel symbols contain terms that precisely compensate for this coordinate-dependent change, ensuring that the metric tensor *as a geometric object* is constant with respect to [covariant differentiation](@entry_id:263981).

In the special case where one can find a coordinate system in which the metric components $g_{ij}$ are all constant (e.g., Cartesian coordinates on Euclidean space), then $\partial_k g_{ij} = 0$ for all $i,j,k$. For a [metric-compatible](@entry_id:160255) and [torsion-free connection](@entry_id:181337), this forces all the Christoffel symbols $\Gamma^k_{ij}$ to be zero in that specific coordinate system [@problem_id:3025041].

### The Fundamental Theorem of Riemannian Geometry

We have established the desirability of [metric compatibility](@entry_id:265910). Another natural condition to impose on a connection is that it be **torsion-free**. The [torsion tensor](@entry_id:204137) $T(X,Y) = \nabla_X Y - \nabla_Y X - [X,Y]$ measures the failure of the covariant derivative to be symmetric in its arguments, accounting for the Lie bracket. A [torsion-free connection](@entry_id:181337) satisfies $T=0$, which in [local coordinates](@entry_id:181200) corresponds to the symmetry of the Christoffel symbols in their lower indices: $\Gamma^k_{ij} = \Gamma^k_{ji}$.

Metric compatibility ($\nabla g = 0$) and the torsion-free condition ($T=0$) are two independent properties a connection may possess [@problem_id:2974952]. A connection could be [metric-compatible](@entry_id:160255) but have torsion, or be torsion-free but not [metric-compatible](@entry_id:160255). The central result of Riemannian geometry is that imposing both of these conditions simultaneously is not only possible but also leads to a uniquely defined connection.

This is the content of the **Fundamental Theorem of Riemannian Geometry**:
> On any Riemannian (or pseudo-Riemannian) manifold $(M,g)$, there exists a unique [affine connection](@entry_id:160152) $\nabla$ that is both [metric-compatible](@entry_id:160255) and torsion-free.

This unique connection is called the **Levi-Civita connection**. [@problem_id:1535663] [@problem_id:3025041]

The proof of this theorem is constructive and demonstrates why these two properties are so fundamental. The key is the derivation of the **Koszul formula**, which provides an explicit expression for the connection in terms of the metric and its derivatives. We can derive this formula by algebraically manipulating the [metric compatibility](@entry_id:265910) identity. Let's write it three times with cyclically permuted vector fields $X, Y, Z$:
1.  $X(g(Y,Z)) = g(\nabla_X Y, Z) + g(Y, \nabla_X Z)$
2.  $Y(g(Z,X)) = g(\nabla_Y Z, X) + g(Z, \nabla_Y X)$
3.  $Z(g(X,Y)) = g(\nabla_Z X, Y) + g(X, \nabla_Z Y)$

By forming the combination $(1) + (2) - (3)$ and using the torsion-free condition ($\nabla_X Y - \nabla_Y X = [X,Y]$) to rearrange terms, one can isolate the term $g(\nabla_X Y, Z)$. The result is the Koszul formula [@problem_id:2974984]:
$$ 2g(\nabla_X Y, Z) = X(g(Y,Z)) + Y(g(X,Z)) - Z(g(X,Y)) + g([X,Y],Z) - g([X,Z],Y) - g([Y,Z],X) $$
**Uniqueness** follows directly from this formula. The right-hand side depends only on the metric $g$ and the Lie bracket operation, with no mention of $\nabla$. Thus, for any connection that is [metric-compatible](@entry_id:160255) and torsion-free, the scalar value $g(\nabla_X Y, Z)$ is uniquely determined for all $Z$. Since the metric $g$ is non-degenerate, this uniquely determines the vector $\nabla_X Y$ itself. Therefore, there can be at most one such connection.

**Existence** is proven by defining the [connection coefficients](@entry_id:157618) in [local coordinates](@entry_id:181200) using the formula derived from the Koszul identity (by setting $X=\partial_i, Y=\partial_j, Z=\partial_k$ and noting $[\partial_i, \partial_j]=0$):
$$ \Gamma^k_{ij} = \frac{1}{2} g^{km}(\partial_i g_{jm} + \partial_j g_{im} - \partial_m g_{ij}) $$
One must then verify that the connection defined by these Christoffel symbols is indeed both torsion-free (which is evident from the symmetry in $i$ and $j$) and [metric-compatible](@entry_id:160255). The [metric compatibility](@entry_id:265910) check involves substituting this formula for $\Gamma^k_{ij}$ back into the coordinate expression for $\nabla_k g_{ij}$. A direct but somewhat lengthy calculation confirms that all terms cancel out, proving that $\nabla_k g_{ij} = 0$ [@problem_id:2984097]. Thus, a connection with the desired properties exists.

### Connections Beyond Levi-Civita

The fundamental theorem singles out the Levi-Civita connection as the canonical choice for Riemannian geometry. However, other connections are also of interest. For example, one might encounter connections that are [metric-compatible](@entry_id:160255) but possess non-zero torsion, which play a role in physical theories like Einstein-Cartan gravity.

It is instructive to consider the relationship between such a connection and the Levi-Civita connection. Suppose we start with a [metric-compatible connection](@entry_id:194538) $\nabla$ that has torsion $T \neq 0$. Can we "correct" it to obtain the Levi-Civita connection $\nabla^{\text{LC}}$? A naive approach might be to simply symmetrize it by defining a new connection $\nabla^0_X Y = \nabla_X Y - \frac{1}{2} T(X,Y)$. While this new connection $\nabla^0$ is indeed torsion-free, it will not, in general, be [metric-compatible](@entry_id:160255). The act of removing torsion typically breaks [metric compatibility](@entry_id:265910) [@problem_id:2991584].

The correct procedure involves subtracting a different [tensor field](@entry_id:266532), known as the **contorsion tensor** $K$. For a [metric-compatible connection](@entry_id:194538) $\nabla$, the Levi-Civita connection is given by $\nabla^{\text{LC}}_X Y = \nabla_X Y - K_X Y$, where the contorsion tensor is determined uniquely by the [torsion tensor](@entry_id:204137) $T$ and the metric $g$. This subtle relationship underscores the delicate balance between the [metric-compatible](@entry_id:160255) and torsion-free conditions, further emphasizing the special and unique nature of the Levi-Civita connection that satisfies both.