{"hands_on_practices": [{"introduction": "细胞重编程不仅是基因表达的改变，也伴随着剧烈的代谢和表观遗传重塑。本练习旨在建立这两个领域之间的定量联系，让您深入理解代谢状态如何直接调控表观遗传景观。通过模拟关键代谢物比例（如 $NAD^{+}/NADH$）如何影响SIRT1去乙酰化酶的活性，您将能够亲手计算其对组蛋白乙酰化和染色质可及性的最终影响，从而将“代谢调控表观遗传”这一抽象概念具体化 [@problem_id:2644786]。", "problem": "在向诱导性多能干细胞 (iPSCs) 的早期细胞重编程过程中，代谢重塑会改变氧化型与还原型烟酰胺腺嘌呤二核苷酸 (NAD) 辅因子的比率，从而调节依赖NAD的去乙酰化酶（如 Sirtuin 1 (SIRT1)）的活性。请从基本的酶动力学和表观遗传调控原理出发，推导烟酰胺腺嘌呤二核苷酸（氧化型）/烟酰胺腺嘌呤二核苷酸（还原型）(NAD/NADH) 的比率如何控制sirtuin的活性，并预测在一个早期重编程过程中受动态调控的启动子，其组蛋白乙酰化和染色质可及性的下游稳态变化。\n\n假设与基本事实：\n- Sirtuin催化的去乙酰化反应需要烟酰胺腺嘌呤二核苷酸（氧化型）(NAD) 作为共底物，并受到烟酰胺腺嘌呤二核苷酸（还原型）(NADH) 的竞争性抑制。假设其遵循Michaelis–Menten动力学，且受NADH竞争性抑制，其中催化速度取决于NAD（底物）和抑制剂NADH的浓度。\n- 在所考虑的时间尺度上，总核烟酰胺腺嘌呤二核苷酸池是守恒的，总浓度为 $N_T$。比率 $R \\equiv [\\mathrm{NAD}]/[\\mathrm{NADH}]$ 通过守恒定律决定 $[\\mathrm{NAD}]$ 和 $[\\mathrm{NADH}]$ 的值。\n- 启动子处的组蛋白乙酰化分数 $A \\in [0,1]$ 的演化方程为 $dA/dt = k_a\\,(1 - A) - k_d\\,S\\,A$，其中 $k_a$ 是由组蛋白乙酰转移酶产生的有效乙酰化速率常数，$k_d\\,S$ 是由sirtuin活性 $S$ 介导的有效去乙酰化速率常数。假设在感兴趣的时间尺度上，$A$ 处于准稳态。\n- 启动子的标准化转录可及性 $T$ 随乙酰化水平的增加而增加，并遵循一个Hill型占据模型，$T = \\frac{A^n}{K_A^n + A^n}$，其中 $n$ 是Hill系数，$K_A$ 是半最大乙酰化分数。\n\n针对一个增加氧化代谢的特定早期重编程扰动的参数：\n- 初始比率 $R_1 = 2$，最终比率 $R_2 = 5$。\n- 总核烟酰胺腺嘌呤二核苷酸浓度 $N_T = 0.5$ mM。\n- NAD的Michaelis常数：$K_m = 0.05$ mM。NADH的抑制常数：$K_i = 0.10$ mM。\n- 使用分数sirtuin活性 $S \\equiv v/V_{\\max}$，其中 $v$ 是Michaelis–Menten速度；在竞争性抑制条件下，$S$ 依赖于 $[\\mathrm{NAD}]$ 和 $[\\mathrm{NADH}]$。\n- 乙酰化和去乙酰化速率常数：$k_a = 0.05$ min$^{-1}$，$k_d = 0.20$ min$^{-1}$。\n- 可及性映射参数：$n = 2$，$K_A = 0.25$。\n\n任务：\n1. 从具有竞争性抑制的Michaelis–Menten动力学出发，推导分数sirtuin活性 $S$ 关于 $[\\mathrm{NAD}]$、$[\\mathrm{NADH}]$、$K_m$ 和 $K_i$ 的表达式。\n2. 利用烟酰胺腺嘌呤二核苷酸池守恒和比率 $R$，将 $[\\mathrm{NAD}]$ 和 $[\\mathrm{NADH}]$ 表示为 $R$ 和 $N_T$ 的函数。\n3. 计算稳态乙酰化 $A^\\ast$ 作为 $S$、$k_a$ 和 $k_d$ 的函数。\n4. 根据 $A^\\ast$ 计算标准化可及性 $T$。\n5. 对于上述参数值，计算可及性的倍数变化 $F \\equiv T(R_2)/T(R_1)$。用小数表示最终答案。将答案四舍五入到四位有效数字。不要使用百分号。", "solution": "问题陈述经评估有效。其科学基础在于酶动力学、表观遗传学和系统生物学的既定原理。问题提法恰当，提供了一套完整且一致的定义、假设和参数，从而可以推导出唯一且有意义的解。语言客观明确。因此，我们可以进行严谨的分析求解。\n\n任务是推导并计算由于细胞代谢变化（该变化改变了氧化型烟酰胺腺嘌呤二核苷酸/还原型烟酰胺腺嘌呤二核苷酸 ($[\\mathrm{NAD}]/[\\mathrm{NADH}]$) 的比率）所引起的启动子转录可及性的倍数变化。解答过程遵循问题中概述的五个步骤构建。\n\n步骤1：分数sirtuin活性 $S$ 的推导。\n遵循具有竞争性抑制的Michaelis-Menten动力学的酶催化反应速度 $v$ 由以下表达式给出：\n$$v = \\frac{V_{\\max} [\\text{Substrate}]}{K_m \\left(1 + \\frac{[\\text{Inhibitor}]}{K_i}\\right) + [\\text{Substrate}]}$$\n对于sirtuin SIRT1，底物是NAD，竞争性抑制剂是NADH。因此，反应速度为：\n$$v = \\frac{V_{\\max} [\\mathrm{NAD}]}{K_m \\left(1 + \\frac{[\\mathrm{NADH}]}{K_i}\\right) + [\\mathrm{NAD}]}$$\n分数sirtuin活性 $S$ 定义为 $S \\equiv v/V_{\\max}$。将速度方程两边同除以 $V_{\\max}$，得到 $S$ 的表达式：\n$$S = \\frac{[\\mathrm{NAD}]}{K_m \\left(1 + \\frac{[\\mathrm{NADH}]}{K_i}\\right) + [\\mathrm{NAD}]}$$\n\n步骤2：将 $[\\mathrm{NAD}]$ 和 $[\\mathrm{NADH}]$ 用 $R$ 和 $N_T$ 表示。\n我们有两个约束条件：总烟酰胺腺嘌呤二核苷酸池的守恒，即总浓度为 $N_T$，以及比率 $R$ 的定义。\n$$[\\mathrm{NAD}] + [\\mathrm{NADH}] = N_T \\quad (1)$$\n$$\\frac{[\\mathrm{NAD}]}{[\\mathrm{NADH}]} = R \\quad (2)$$\n由方程(2)可得 $[\\mathrm{NAD}] = R \\cdot [\\mathrm{NADH}]$。将其代入方程(1)：\n$$R \\cdot [\\mathrm{NADH}] + [\\mathrm{NADH}] = (R+1)[\\mathrm{NADH}] = N_T$$\n求解 $[\\mathrm{NADH}]$ 得：\n$$[\\mathrm{NADH}] = \\frac{N_T}{R+1}$$\n将此结果代回 $[\\mathrm{NAD}]$ 的表达式得：\n$$[\\mathrm{NAD}] = R \\left(\\frac{N_T}{R+1}\\right) = \\frac{R N_T}{R+1}$$\n\n步骤3：稳态乙酰化 $A^\\ast$ 的计算。\n分数组蛋白乙酰化 $A$ 的动力学由以下方程描述：\n$$\\frac{dA}{dt} = k_a (1 - A) - k_d S A$$\n在准稳态下，我们令 $\\frac{dA}{dt} = 0$。设 $A^\\ast$ 表示稳态乙酰化水平。\n$$k_a (1 - A^\\ast) - k_d S A^\\ast = 0$$\n整理各项以求解 $A^\\ast$：\n$$k_a = k_a A^\\ast + k_d S A^\\ast = (k_a + k_d S)A^\\ast$$\n$$A^\\ast = \\frac{k_a}{k_a + k_d S}$$\n\n步骤4：标准化可及性 $T$ 的计算。\n转录可及性 $T$ 是 $A^\\ast$ 的Hill型函数：\n$$T = \\frac{(A^\\ast)^n}{K_A^n + (A^\\ast)^n}$$\n该公式将表观遗传状态（乙酰化）与功能输出（可及性）联系起来。\n\n步骤5：倍数变化 $F \\equiv T(R_2)/T(R_1)$ 的计算。\n现在我们使用给定的参数来计算初始状态（$R_1 = 2$）和最终状态（$R_2 = 5$）的数值。参数为：$N_T = 0.5$ mM, $K_m = 0.05$ mM, $K_i = 0.10$ mM, $k_a = 0.05$ min$^{-1}$, $k_d = 0.20$ min$^{-1}$, $n = 2$ 以及 $K_A = 0.25$。\n\n对于初始状态 $R_1 = 2$：\n$$[\\mathrm{NAD}]_1 = \\frac{2 \\cdot 0.5}{2+1} = \\frac{1}{3} \\text{ mM}$$\n$$[\\mathrm{NADH}]_1 = \\frac{0.5}{2+1} = \\frac{1}{6} \\text{ mM}$$\n分数sirtuin活性 $S_1$ 为：\n$$S_1 = \\frac{1/3}{0.05 \\left(1 + \\frac{1/6}{0.10}\\right) + 1/3} = \\frac{1/3}{0.05 \\left(1 + \\frac{5}{3}\\right) + 1/3} = \\frac{1/3}{0.05 \\left(\\frac{8}{3}\\right) + 1/3} = \\frac{1/3}{\\frac{2}{15} + \\frac{1}{3}} = \\frac{1/3}{7/15} = \\frac{5}{7}$$\n稳态乙酰化 $A^\\ast_1$ 为：\n$$A^\\ast_1 = \\frac{k_a}{k_a + k_d S_1} = \\frac{0.05}{0.05 + 0.20(5/7)} = \\frac{1}{1 + 4(5/7)} = \\frac{1}{1 + 20/7} = \\frac{7}{27}$$\n相应的可及性 $T_1$ 为：\n$$T_1 = \\frac{(A^\\ast_1)^2}{K_A^2 + (A^\\ast_1)^2} = \\frac{(7/27)^2}{(0.25)^2 + (7/27)^2} = \\frac{49/729}{1/16 + 49/729} = \\frac{49/729}{(729+784)/11664} = \\frac{784}{1513}$$\n\n对于最终状态 $R_2 = 5$：\n$$[\\mathrm{NAD}]_2 = \\frac{5 \\cdot 0.5}{5+1} = \\frac{2.5}{6} = \\frac{5}{12} \\text{ mM}$$\n$$[\\mathrm{NADH}]_2 = \\frac{0.5}{5+1} = \\frac{1}{12} \\text{ mM}$$\n分数sirtuin活性 $S_2$ 为：\n$$S_2 = \\frac{5/12}{0.05 \\left(1 + \\frac{1/12}{0.10}\\right) + 5/12} = \\frac{5/12}{0.05 \\left(1 + \\frac{5}{6}\\right) + 5/12} = \\frac{5/12}{\\frac{11}{120} + \\frac{5}{12}} = \\frac{5/12}{61/120} = \\frac{50}{61}$$\n稳态乙酰化 $A^\\ast_2$ 为：\n$$A^\\ast_2 = \\frac{k_a}{k_a + k_d S_2} = \\frac{0.05}{0.05 + 0.20(50/61)} = \\frac{1}{1 + 4(50/61)} = \\frac{1}{1 + 200/61} = \\frac{61}{261}$$\n相应的可及性 $T_2$ 为：\n$$T_2 = \\frac{(A^\\ast_2)^2}{K_A^2 + (A^\\ast_2)^2} = \\frac{(61/261)^2}{(0.25)^2 + (61/261)^2} = \\frac{3721/68121}{1/16 + 3721/68121} = \\frac{59536}{127657}$$\n\n最后，倍数变化 $F$ 是比值 $T_2/T_1$：\n$$F = \\frac{T_2}{T_1} = \\frac{59536/127657}{784/1513} \\approx \\frac{0.46638053}{0.51817581} \\approx 0.9000455$$\n$[\\mathrm{NAD}]/[\\mathrm{NADH}]$ 比率从 $2$ 增加到 $5$ 增强了sirtuin的活性，导致更强的组蛋白去乙酰化。这反过来又降低了启动子的转录可及性。\n将结果四舍五入到四位有效数字，得到 $0.9000$。", "answer": "$$ \\boxed{0.9000} $$", "id": "2644786"}, {"introduction": "基因调控网络可以被视为决定细胞命运的“操作系统”。本实践将指导您使用布尔网络这一强大而简洁的工具，来模拟山中伸弥因子（OSKM）之间的相互作用逻辑。通过分析该网络，您将探索不同外源因子的组合如何驱动细胞状态转换并稳定在特定“吸引子”（如多能性状态），从而直观地理解细胞命运是如何作为网络动力学的结果而出现的 [@problem_id:2644841]。", "problem": "构造并分析一个用于诱导全能性的Yamanaka因子的最小布尔基因调控网络，该网络基于基因调控的基本原理。其生物学背景是诱导性多能干细胞（iPSCs），这些细胞通过外源性表达八聚体结合转录因子$4$（OCT$4$）、SRY盒$2$（SOX$2$）、Krüppel样因子$4$（KLF$4$）和细胞MYC（c-MYC）（统称为OSKM）进行重编程。使用的基本依据是：(i) 分子生物学中心法则（DNA到RNA到蛋白质）确立了转录因子通过结合调控元件来调控彼此的表达；(ii) 细胞命运对应于基因调控网络中的吸引子这一被广泛接受的观念；以及 (iii) 在细胞状态转变的时间尺度上，基因活性可以粗粒化为布尔变量，并采用同步更新动力学来表示调控逻辑这一经过充分检验的近似方法。为确保科学真实性，仅使用与OSKM作用一致的单调（激活）相互作用：OCT$4$和SOX$2$形成一个核心正反馈回路，KLF$4$支持核心回路的维持并由OCT$4$–SOX$2$复合物诱导，而c-MYC主要起扩增作用，并由全能性活性维持。\n\n根据这些依据，采用以下明确的网络形式化定义。设离散时间 $t$ 的内源状态为一个向量 $(O_t,S_t,K_t,M_t)\\in\\{0,1\\}^4$，分别对应OCT$4$、SOX$2$、KLF$4$和c-MYC。设外源输入为 $(E_O,E_S,E_K,E_M)\\in\\{0,1\\}^4$，其中 $E_X=1$ 表示因子 $X$ 的外部表达，$E_X=0$ 表示无外部表达。通过坐标函数定义同步布尔更新 $F_{E}$：\n$$\n\\begin{aligned}\nO_{t+1} = E_O \\lor \\left(S_t \\land (K_t \\lor O_t)\\right),\\\\\nS_{t+1} = E_S \\lor \\left(O_t \\land (K_t \\lor S_t)\\right),\\\\\nK_{t+1} = E_K \\lor \\left(O_t \\land S_t\\right),\\\\\nM_{t+1} = E_M \\lor \\left(O_t \\lor S_t \\lor K_t\\right),\n\\end{aligned}\n$$\n其中 $\\lor$ 表示布尔析取，$\\land$ 表示布尔合取。一个状态 $x\\in\\{0,1\\}^4$ 是不动点吸引子，当且仅当 $F_E(x)=x$。\n\n对于每个外源输入向量 $E$，将状态 $x=(O,S,K,M)$ 的整数编码定义为 $c(x)=8O+4S+2K+M\\in\\{0,1,\\dots,15\\}$。你的程序必须枚举所有 $2^4$ 个候选状态 $x$，并针对下面测试套件中的每个 $E$，返回所有不动点的整数编码 $c(x)$ 的排序列表。\n\n测试套件（每个元组为 $(E_O,E_S,E_K,E_M)$）：\n- 案例1：$(0,0,0,0)$,\n- 案例2：$(1,0,0,0)$,\n- 案例3：$(0,1,0,0)$,\n- 案例4：$(0,0,1,0)$,\n- 案例5：$(0,0,0,1)$,\n- 案例6：$(1,1,0,0)$,\n- 案例7：$(1,0,1,0)$,\n- 案例8：$(0,1,1,0)$,\n- 案例9：$(1,1,1,0)$,\n- 案例10：$(1,1,1,1)$.\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，且不含空格。第 $i$ 个元素必须是案例 $i$ 的整数编码列表，用方括号括起并以逗号分隔，不含空格。例如，整体格式必须为 “[[result\\_list\\_for\\_case\\_1],[result\\_list\\_for\\_case\\_2],...,[result\\_list\\_for\\_case\\_10]]”，其中每个 “result\\_list\\_for\\_case\\_i” 包含由逗号连接并用方括号括起来的十进制整数。\n\n不涉及物理单位。不涉及角度。不要使用百分号表示任何数量；任何分数数量都必须以小数或分数形式给出，尽管此处不需要。", "solution": "首先将对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n\n- **生物系统**：背景是通过四个Yamanaka转录因子：OCT$4$ ($O$)、SOX$2$ ($S$)、KLF$4$ ($K$) 和 c-MYC ($M$) 诱导多能干细胞 (iPSCs)。\n- **建模框架**：该系统被建模为一个同步布尔基因调控网络。细胞命运被等同于吸引子（在此背景下为不动点）。\n- **状态表示**：四个基因在离散时间 $t$ 的内源状态是一个布尔向量 $x_t = (O_t, S_t, K_t, M_t) \\in \\{0, 1\\}^4$。\n- **输入表示**：外源基因表达由一个布尔向量 $E = (E_O, E_S, E_K, E_M) \\in \\{0, 1\\}^4$ 表示。\n- **更新逻辑**：同步更新函数 $F_E: \\{0, 1\\}^4 \\to \\{0, 1\\}^4$ 由以下坐标函数定义：\n  $$\n  \\begin{aligned}\n  O_{t+1} = E_O \\lor \\left(S_t \\land (K_t \\lor O_t)\\right) \\\\\n  S_{t+1} = E_S \\lor \\left(O_t \\land (K_t \\lor S_t)\\right) \\\\\n  K_{t+1} = E_K \\lor \\left(O_t \\land S_t\\right) \\\\\n  M_{t+1} = E_M \\lor \\left(O_t \\lor S_t \\lor K_t\\right)\n  \\end{aligned}\n  $$\n- **吸引子定义**：一个状态 $x$ 是不动点吸引子，如果它满足条件 $F_E(x) = x$。\n- **状态编码**：一个状态 $x = (O, S, K, M)$ 被映射到一个整数编码 $c(x) = 8O + 4S + 2K + M$。\n- **任务**：对于一个包含10个不同外源输入向量 $E$ 的给定测试套件，为每个 $E$ 找到所有不动点 $x$。每个案例的输出必须是这些不动点的整数编码 $c(x)$ 的排序列表。\n- **测试套件**：一个包含10个 $(E_O, E_S, E_K, E_M)$ 元组的列表：$(0,0,0,0)$、$(1,0,0,0)$、$(0,1,0,0)$、$(0,0,1,0)$、$(0,0,0,1)$、$(1,1,0,0)$、$(1,0,1,0)$、$(0,1,1,0)$、$(1,1,1,0)$、$(1,1,1,1)$。\n\n### 第2步：问题陈述验证\n\n- **科学依据**：该问题基于发育生物学和系统生物学中已确立的原理。使用布尔网络对基因调控进行建模是该领域一种标准（尽管简化）的方法。布尔函数中编码的特定相互作用——例如OCT$4$-SOX$2$核心的相互激活、它们对KLF$4$的诱导以及c-MYC的普遍扩增作用——与关于多能性维持和诱导的实验文献一致。因此，该问题具有科学依据。\n- **适定性**：该问题在数学上是明确的。状态空间是有限的，包含 $2^4 = 16$ 个状态。更新规则是确定性函数。不动点有明确定义。对于任何给定的输入向量 $E$，不动点的集合是唯一的，并且可以通过穷举搜索找到。因此，该问题是适定的。\n- **客观性**：该问题使用精确、形式化的数学语言（布尔代数）进行阐述。它没有主观性、歧义性和非科学性主张。它是客观的。\n\n### 第3步：结论与行动\n\n该问题是**有效的**。它是一个定义明确的计算任务，基于一个公认的科学建模范式。我将继续进行求解。\n\n### 解决方案推导\n\n目标是对于给定的外源输入 $E = (E_O, E_S, E_K, E_M)$，识别出所有作为更新映射 $F_E$ 不动点的状态 $x = (O, S, K, M)$。一个状态 $x$ 是不动点，当且仅当它是以下同步布尔方程组的解：\n$$\n\\begin{aligned}\nO = E_O \\lor \\left(S \\land (K \\lor O)\\right) \\\\\nS = E_S \\lor \\left(O \\land (K \\lor S)\\right) \\\\\nK = E_K \\lor \\left(O \\land S\\right) \\\\\nM = E_M \\lor \\left(O \\lor S \\lor K\\right)\n\\end{aligned}\n$$\n系统的状态空间是集合 $\\{0, 1\\}^4$，仅包含 $2^4 = 16$ 个不同状态。鉴于状态数量少且有限，找到所有不动点最直接可靠的方法是穷举搜索。只要逻辑实现正确，该方法保证能找到所有解，不会有任何出错的可能。\n\n算法如下：\n1. 对10个指定的外源输入向量 $E$ 中的每一个，我们都独立地搜索不动点。\n2. 搜索遍历状态空间中的每一个可能状态 $x = (O, S, K, M)$。我们可以用从0到15的整数 $i$ 来表示这16个状态。单个基因的活性 $(O, S, K, M)$ 可以从 $i$ 的二进制表示中恢复。具体来说，对于一个整数编码 $i$，状态由 $O = (i \\gg 3) \\land 1$、$S = (i \\gg 2) \\land 1$、$K = (i \\gg 1) \\land 1$ 和 $M = i \\land 1$ 给出。\n3. 对于每个状态 $x_t = (O, S, K, M)$，我们使用提供的更新方程计算下一个状态 $x_{t+1} = (O', S', K', M')$。\n4. 然后我们通过比较当前状态和下一个状态来检查该状态是否为不動点。即，我们测试是否有 $x_t = x_{t+1}$，这等同于检查 $O = O'$, $S = S'$, $K = K'$, 和 $M = M'$。或者，可以计算下一个状态的整数编码 $c(x_{t+1})$，并检查它是否等于当前状态的整数编码 $c(x_t) = i$。\n5. 如果一个状态被确定为不动点，则记录其整数编码 $i$。\n6. 对给定的 $E$ 遍历所有16个状态后，收集到的不动点编码列表按要求升序排序。尽管从 $i=0$ 到 $15$ 的迭代自然会产生排序好的结果，但执行排序步骤可确保正确性。\n7. 对所有10个测试案例重复此过程，并将最终结果编译成指定的输出格式。\n\n这个系统化的程序保证了在每种指定条件下，对给定模型的所有不动点吸引子进行完整且正确的枚举。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Boolean gene regulatory network problem by finding all fixed points\n    for a series of exogenous input conditions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0, 0, 0, 0),  # Case 1\n        (1, 0, 0, 0),  # Case 2\n        (0, 1, 0, 0),  # Case 3\n        (0, 0, 1, 0),  # Case 4\n        (0, 0, 0, 1),  # Case 5\n        (1, 1, 0, 0),  # Case 6\n        (1, 0, 1, 0),  # Case 7\n        (0, 1, 1, 0),  # Case 8\n        (1, 1, 1, 0),  # Case 9\n        (1, 1, 1, 1),  # Case 10\n    ]\n\n    all_results = []\n    # There are 2^4 = 16 possible states for the vector (O, S, K, M).\n    num_states = 16\n\n    for case in test_cases:\n        E_O, E_S, E_K, E_M = case\n        fixed_point_codes = []\n\n        # Iterate through every possible state, encoded as an integer from 0 to 15.\n        for i in range(num_states):\n            # Decode the integer 'i' into the Boolean state vector (O, S, K, M).\n            # O is the most significant bit, M is the least significant.\n            O = (i >> 3) & 1\n            S = (i >> 2) & 1\n            K = (i >> 1) & 1\n            M = (i >> 0) & 1\n\n            # Apply the synchronous Boolean update rules to find the next state.\n            # Python's 'or' and 'and' operators work correctly for 0/1 integers.\n            O_next = E_O or (S and (K or O))\n            S_next = E_S or (O and (K or S))\n            K_next = E_K or (O and S)\n            M_next = E_M or (O or S or K)\n\n            # Encode the next state vector into its integer code.\n            next_state_code = (O_next << 3) | (S_next << 2) | (K_next << 1) | M_next\n\n            # A state is a fixed point if it maps to itself.\n            if i == next_state_code:\n                fixed_point_codes.append(i)\n\n        # The problem requires sorting, although iterating from 0 to 15\n        # naturally produces a sorted list.\n        fixed_point_codes.sort()\n        \n        # Format the result for this case as a string, e.g., \"[0,15]\"\n        case_result_str = f\"[{','.join(map(str, fixed_point_codes))}]\"\n        all_results.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    # e.g., \"[[0,15],[9,15],...]\"\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2644841"}, {"introduction": "在将理论模型应用于现实世界时，我们必须面对实验结果的复杂性和不确定性。诱导多能干细胞的生成效率通常不高，因此需要可靠的方法来筛选出真正具有多能性的细胞克隆。本练习将带您进入实验验证的核心环节，通过计算精确率、召回率等关键指标，来评估和比较两种常见的筛选策略。这不仅能锻炼您在生物数据分析方面的关键技能，还将引导您思考在资源和成本限制下如何做出最优的实验设计决策 [@problem_id:2644808]。", "problem": "一个实验室正在筛选从人类成纤维细胞生成诱导性多能干细胞（iPSCs）过程中的克隆。在进行作为多能性（生成所有三个胚层衍生物的能力）金标准功能性读出的权威性体内畸胎瘤形成实验之前，使用了两种筛选检测方法。检测M是基于标记物的免疫染色组合，用于检测OCT4、SOX2和NANOG，而检测F是一种短期的体外功能性检测，基于胚状体（EB）形成及随后的谱系标记物定量。两种筛选检测都与金标准在同一组$N=240$个克隆上进行了比较，得到以下混淆矩阵（计数是相对于畸胎瘤金标准给出的）：\n\n对于检测M（基于标记物）：真阳性 $TP_{M}=60$，假阳性 $FP_{M}=60$，真阴性 $TN_{M}=108$，假阴性 $FN_{M}=12$。\n\n对于检测F（体外功能性）：真阳性 $TP_{F}=54$，假阳性 $FP_{F}=12$，真阴性 $TN_{F}=156$，假阴性 $FN_{F}=18$。\n\n假设每个假阳性的下游预期边际成本为$c_{FP}$，每个假阴性的下游预期边际成本为$c_{FN}$，且$c_{FP}/c_{FN}=3$。基于这些量的定义及其对观测计数和患病率的依赖性，从第一性原理出发，完成以下任务：\n\n1) 仅使用将这些指标与混淆矩阵条目相关联的定义，计算每种检测的精确率、召回率（灵敏度）和$F_{1}$分数。\n\n2) 根据给定的成本比率$c_{FP}/c_{FN}=3$，确定在选择检测和调整阈值时应强调哪个单一数字摘要：精确率、召回率或$F_{1}$分数。为了报告一个数字答案，将您的选择编码为：精确率$s=1$，召回率$s=2$，或$F_{1}$分数$s=3$。\n\n将每个指标表示为最简精确分数（不要小数化），并按以下顺序将最终结果表示为单个行向量：\n$[$ 检测M的精确率, 检测M的召回率, 检测M的$F_{1}$分数, 检测F的精确率, 检测F的召回率, 检测F的$F_{1}$分数, $s ]$。\n无需单位。不要四舍五入。", "solution": "对问题陈述进行验证。\n\n步骤1：提取的已知条件。\n克隆总数：$N=240$。\n检测M的混淆矩阵计数：真阳性 $TP_{M}=60$，假阳性 $FP_{M}=60$，真阴性 $TN_{M}=108$，假阴性 $FN_{M}=12$。\n检测F的混淆矩阵计数：真阳性 $TP_{F}=54$，假阳性 $FP_{F}=12$，真阴性 $TN_{F}=156$，假阴性 $FN_{F}=18$。\n成本比率：$c_{FP}/c_{FN}=3$。\n任务：\n1) 计算每种检测的精确率、召回率和$F_{1}$分数。\n2) 根据成本比率确定要强调哪个指标，并将选择编码为：精确率$s=1$，召回率$s=2$，或$F_{1}$分数$s=3$。\n最终答案将以单个行向量的形式呈现。\n\n步骤2：验证。\n该问题具有科学依据，描述了在生物学背景下评估诊断或筛选检测的标准程序。所提供的数据是完整且自洽的。对于检测M，计数总和为$60+60+108+12 = 240$。对于检测F，总和为$54+12+156+18 = 240$。两个总和都与克隆总数$N=240$相符。根据金标准，真阳性克隆的数量为$P = TP_{M} + FN_{M} = 60+12 = 72$，这与检测F的数据一致，$P = TP_{F} + FN_{F} = 54+18=72$。真阴性克隆的数量为$N_{neg} = FP_{M} + TN_{M} = 60+108 = 168$，这与检测F的数据一致，$N_{neg} = FP_{F} + TN_{F} = 12+156=168$。该问题提法恰当、客观，且不含逻辑或事实错误。\n\n步骤3：结论。\n该问题有效。将提供解答。\n\n这些指标是根据混淆矩阵的组成部分从第一性原理定义的：真阳性（$TP$）、假阳性（$FP$）和假阴性（$FN$）。\n精确率，或称阳性预测值（$PPV$），是指阳性预测中实际正确的比例：\n$$ \\text{Precision} = \\frac{TP}{TP + FP} $$\n召回率，或称灵敏度，是指实际阳性中被正确识别的比例：\n$$ \\text{Recall} = \\frac{TP}{TP + FN} $$\n$F_1$分数是精确率和召回率的调和平均数，提供了一个平衡的度量：\n$$ F_{1} = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN} $$\n\n第1部分：计算每种检测的指标。\n\n对于检测M：\n给定 $TP_{M}=60$, $FP_{M}=60$, 和 $FN_{M}=12$。\n检测M的精确率为：\n$$ \\text{Precision}_{M} = \\frac{TP_{M}}{TP_{M} + FP_{M}} = \\frac{60}{60 + 60} = \\frac{60}{120} = \\frac{1}{2} $$\n检测M的召回率为：\n$$ \\text{Recall}_{M} = \\frac{TP_{M}}{TP_{M} + FN_{M}} = \\frac{60}{60 + 12} = \\frac{60}{72} = \\frac{5 \\cdot 12}{6 \\cdot 12} = \\frac{5}{6} $$\n检测M的$F_{1}$分数为：\n$$ F_{1, M} = \\frac{2 \\cdot TP_{M}}{2 \\cdot TP_{M} + FP_{M} + FN_{M}} = \\frac{2 \\cdot 60}{2 \\cdot 60 + 60 + 12} = \\frac{120}{120 + 72} = \\frac{120}{192} = \\frac{5 \\cdot 24}{8 \\cdot 24} = \\frac{5}{8} $$\n\n对于检测F：\n给定 $TP_{F}=54$, $FP_{F}=12$, 和 $FN_{F}=18$。\n检测F的精确率为：\n$$ \\text{Precision}_{F} = \\frac{TP_{F}}{TP_{F} + FP_{F}} = \\frac{54}{54 + 12} = \\frac{54}{66} = \\frac{9 \\cdot 6}{11 \\cdot 6} = \\frac{9}{11} $$\n检测F的召回率为：\n$$ \\text{Recall}_{F} = \\frac{TP_{F}}{TP_{F} + FN_{F}} = \\frac{54}{54 + 18} = \\frac{54}{72} = \\frac{3 \\cdot 18}{4 \\cdot 18} = \\frac{3}{4} $$\n检测F的$F_{1}$分数为：\n$$ F_{1, F} = \\frac{2 \\cdot TP_{F}}{2 \\cdot TP_{F} + FP_{F} + FN_{F}} = \\frac{2 \\cdot 54}{2 \\cdot 54 + 12 + 18} = \\frac{108}{108 + 30} = \\frac{108}{138} = \\frac{18 \\cdot 6}{23 \\cdot 6} = \\frac{18}{23} $$\n\n第2部分：基于成本选择总结性指标。\n问题陈述了成本比率为$c_{FP}/c_{FN}=3$，意味着假阳性（$c_{FP}$）的边际成本是假阴性（$c_{FN}$）成本的三倍。一个理性的决策过程必须优先考虑最小化成本更高的错误类型。在这种情况下，我们必须特别严格地避免假阳性。\n\n让我们考察这些指标与错误类型的关系：\n- 精确率定义为 $TP / (TP + FP)$。它与假阳性的数量直接成反比。大量的$FP$会严重惩罚精确率分数。\n- 召回率定义为 $TP / (TP + FN)$。它对假阴性敏感，而不是假阳性。\n- $F_1$分数同等地平衡了精确率和召回率，这隐含地假设了$FP$和$FN$的成本相等。\n\n由于假阳性的成本要高得多，必须强调最能直接反映最小化$FP$目标的性能指标。这个指标是精确率。因此，在这种成本结构下比较检测或调整分类阈值时，应优先考虑实现更高的精确率。其通用框架是$F_{\\beta}$分数，其中$\\beta^2$是假阴性成本与假阳性成本的比率，即$\\beta^2 = c_{FN}/c_{FP}$。在这里，$\\beta^2 = 1/3$，所以$\\beta = 1/\\sqrt{3} < 1$。一个$\\beta < 1$的$F_{\\beta}$分数给予精确率比召回率更大的权重。问题要求在三个标准指标（精确率、召回率、$F_1$）中选择一个来强调。鉴于假阳性的高成本，精确率是正确的选择。\n精确率的编码是$s=1$。\n\n最终的结果向量由六个计算出的指标和选择参数$s$组成：\n$[\\text{Precision}_{M}, \\text{Recall}_{M}, F_{1, M}, \\text{Precision}_{F}, \\text{Recall}_{F}, F_{1, F}, s]$。\n代入计算出的值：\n$[\\frac{1}{2}, \\frac{5}{6}, \\frac{5}{8}, \\frac{9}{11}, \\frac{3}{4}, \\frac{18}{23}, 1]$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{5}{6} & \\frac{5}{8} & \\frac{9}{11} & \\frac{3}{4} & \\frac{18}{23} & 1 \\end{pmatrix}}\n$$", "id": "2644808"}]}