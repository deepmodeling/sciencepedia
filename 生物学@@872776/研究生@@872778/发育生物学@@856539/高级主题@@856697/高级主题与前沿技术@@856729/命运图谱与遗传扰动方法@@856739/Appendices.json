{"hands_on_practices": [{"introduction": "在克隆谱系示踪中，确保每个克隆源自一个被独特条形码标记的单细胞，是一项基础性挑战。这项练习利用泊松分布来模拟慢病毒转导的随机过程，从而能够根据感染复数（MOI）预测未标记、单标记和多标记细胞的比例。通过这项实践[@problem_id:2637929]，你将掌握如何在标记效率与“克隆碰撞”（即单个细胞被多个条形码标记，从而混淆分析结果）的风险之间进行权衡，并理解为何在高分辨率谱系示踪研究中通常选择较低的$MOI$。", "problem": "在谱系追踪和命运图谱研究中，一种常见的策略是通过慢病毒转导将一个高复杂度的独特遗传条形码文库引入到一个同质的增殖性祖细胞群体中。假设每个病毒颗粒在每个细胞中最多整合一次，不同细胞间的整合事件是独立的，并且感染体系是稀释的，因此每个细胞的独立整合事件数可以被建模为一个泊松随机变量，其均值等于感染复数（MOI），记为 $\\lambda$。在这些假设下，定义 $K$ 为每个细胞中整合的条形码数量。仅使用泊松分布的标准性质和微积分，完成以下任务：(i) 推导单一标记细胞的比例 $P_{1}(\\lambda)$ 作为 $\\lambda$ 的函数表达式；(ii) 确定使 $P_{1}(\\lambda)$ 最大化的 $\\lambda$ 值；(iii) 用 $\\lambda$ 表示未标记细胞的比例 $P_{0}(\\lambda)$ 和多重标记（两个或更多条形码）细胞的比例 $P_{\\ge 2}(\\lambda)$，并从第一性原理出发，简要论证在克隆命运图谱背景下，选择 $\\lambda$ 值时如何在未标记细胞、多重标记细胞和单一标记细胞之间进行权衡。最终答案只报告使 $P_{1}(\\lambda)$ 最大化的 $\\lambda$ 值。不包含单位。无需四舍五入。", "solution": "所述问题具有科学依据，是适定且客观的。它为发育生物学中一个常见的实验程序提供了一个标准的、尽管简化的模型。其假设阐述清晰，足以得到唯一的数学解。因此，该问题是有效的，我们可以进行求解。\n\n问题陈述，每个细胞中整合的遗传条形码数量（我们用随机变量 $K$ 表示）遵循均值为 $\\lambda$ 的泊松分布。泊松随机变量的概率质量函数 (PMF) 由下式给出：\n$$P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n其中 $k$ 是一个非负整数，表示事件（整合）的数量，而 $\\lambda > 0$ 是每个区间（每个细胞）的平均事件数。\n\n(i) 单一标记细胞的比例 $P_{1}(\\lambda)$ 对应于一个细胞恰好有一次整合事件的概率，即 $P(K=1)$。将 $k=1$ 代入泊松 PMF，我们得到：\n$$P_{1}(\\lambda) = P(K=1) = \\frac{\\lambda^{1} \\exp(-\\lambda)}{1!} = \\lambda \\exp(-\\lambda)$$\n\n(ii) 为了确定使单一标记细胞比例 $P_{1}(\\lambda)$ 最大化的 $\\lambda$ 值，我们必须使用微分学。我们计算 $P_{1}(\\lambda)$ 关于 $\\lambda$ 的一阶导数，并将其设为零以找到临界点。应用微分的乘法法则 $[f(\\lambda)g(\\lambda)]' = f'(\\lambda)g(\\lambda) + f(\\lambda)g'(\\lambda)$，其中 $f(\\lambda) = \\lambda$ 且 $g(\\lambda) = \\exp(-\\lambda)$：\n$$\\frac{d}{d\\lambda} P_{1}(\\lambda) = \\frac{d}{d\\lambda} [\\lambda \\exp(-\\lambda)] = (1) \\cdot \\exp(-\\lambda) + \\lambda \\cdot [-\\exp(-\\lambda)] = \\exp(-\\lambda) - \\lambda \\exp(-\\lambda)$$\n这可以因式分解为：\n$$\\frac{d}{d\\lambda} P_{1}(\\lambda) = \\exp(-\\lambda) (1 - \\lambda)$$\n为了求最大值，我们将导数设为零：\n$$\\exp(-\\lambda) (1 - \\lambda) = 0$$\n由于对于所有有限的 $\\lambda$，$\\exp(-\\lambda)$ 都严格为正，因此该方程仅在另一项为零时才成立：\n$$1 - \\lambda = 0 \\implies \\lambda = 1$$\n为确认 $\\lambda=1$ 对应于一个最大值，我们采用二阶导数检验。我们将 $\\frac{d}{d\\lambda} P_{1}(\\lambda)$ 再次对 $\\lambda$ 求导：\n$$\\frac{d^2}{d\\lambda^2} P_{1}(\\lambda) = \\frac{d}{d\\lambda} [\\exp(-\\lambda) (1 - \\lambda)] = [-\\exp(-\\lambda)](1 - \\lambda) + \\exp(-\\lambda)(-1)$$\n$$= -\\exp(-\\lambda) + \\lambda \\exp(-\\lambda) - \\exp(-\\lambda) = \\exp(-\\lambda) (\\lambda - 2)$$\n现在，我们在临界点 $\\lambda=1$ 处计算二阶导数的值：\n$$\\left. \\frac{d^2}{d\\lambda^2} P_{1}(\\lambda) \\right|_{\\lambda=1} = \\exp(-1) (1 - 2) = -\\exp(-1)$$\n由于 $\\exp(-1) > 0$，二阶导数为负。这证实了 $P_{1}(\\lambda)$ 在 $\\lambda=1$ 处有一个局部最大值。因为这是 $\\lambda > 0$ 的唯一临界点，所以它也是全局最大值。使单一标记细胞比例最大化的 $\\lambda$ 值为 $1$。\n\n(iii) 未标记细胞的比例 $P_{0}(\\lambda)$ 对应于 $P(K=0)$。将 $k=0$ 代入 PMF（并回顾 $0!=1$ 和 $\\lambda^0=1$）：\n$$P_{0}(\\lambda) = P(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n多重标记细胞的比例 $P_{\\ge 2}(\\lambda)$ 对应于有两次或更多次整合的概率，即 $P(K \\ge 2)$。这是有零次或一次整合的补集。因此：\n$$P_{\\ge 2}(\\lambda) = 1 - P(K=0) - P(K=1) = 1 - P_{0}(\\lambda) - P_{1}(\\lambda)$$\n代入我们推导出的表达式：\n$$P_{\\ge 2}(\\lambda) = 1 - \\exp(-\\lambda) - \\lambda \\exp(-\\lambda)$$\n\n在克隆命运图谱实验中选择 $\\lambda$ 的权衡是根本性的。这类实验的主要目标是唯一地标记每个最终克隆的祖细胞。这要求细胞是单一标记的。\n如果选择 $\\lambda=1$ 来最大化单一标记细胞的产率（$P_{1}(1)=\\exp(-1) \\approx 0.368$），则会有相当大比例的细胞保持未标记状态（$P_{0}(1)=\\exp(-1) \\approx 0.368$），这代表了实验材料的浪费。更关键的是，一个显著比例的细胞将是多重标记的（$P_{\\ge 2}(1) = 1 - 2\\exp(-1) \\approx 0.264$）。多重标记细胞是严重分析误差的来源，因为一个带有（例如）条形码 $\\{A, B\\}$ 的细胞的后代，无法与两个独立克隆（一个标记为条形码 A，另一个标记为条形码 B）的混合物区分开来。这种现象被称为克隆碰撞，它会混淆谱系重建。\n为了确保命运图谱的高保真度，必须最小化多重标记细胞的概率。这需要选择一个较小的 $\\lambda$ 值。例如，如果 $\\lambda=0.1$，那么 $P_{\\ge 2}(0.1) = 1 - \\exp(-0.1) - 0.1\\exp(-0.1) \\approx 1 - 0.9048 - 0.0905 = 0.0047$。多重标记细胞的比例低于 $0.5\\%$。然而，这付出了巨大的代价：有用的单一标记细胞的比例也很低（$P_{1}(0.1) \\approx 0.0905$ 或约 $9\\%$），而绝大多数细胞是未标记的（$P_{0}(0.1) \\approx 0.9048$ 或约 $90.5\\%$）。\n因此，实验上的权衡是在效率（单一标记细胞的比例）和准确性（多重标记细胞的比例）之间进行的。通过设置 $\\lambda=1$ 来最大化单一标记细胞的产率在数学上是最优的，但在实验上是不成熟的，因为它会为高分辨率研究产生不可接受的高水平克隆碰撞。在实践中，研究人员会优先考虑准确性，选择一个较低的 $\\lambda$（例如，$0.05$ 到 $0.1$），接受较低的标记效率，然后通过分析一个非常大的初始细胞群体来弥补。", "answer": "$$\\boxed{1}$$", "id": "2637929"}, {"introduction": "精确控制遗传操作的时间和程度是现代发育生物学研究的核心。这项练习将药效学中的经典模型（希尔方程）应用于他莫昔芬（tamoxifen）诱导的CreERT2系统，用以描述诱导剂剂量与细胞重组概率之间的关系[@problem_id:2637954]。通过推导和求解该模型，你将学会如何量化并预测诱导系统的行为，从而为精确调控基因修饰水平的实验设计提供理论依据。", "problem": "在一个使用他莫昔芬响应性Cre重组酶-雌激素受体突变体2 (CreERT2) 的他莫昔芬诱导的命运图谱实验中，每个细胞在指定的诱导窗口期内经历一次重组，其重组概率取决于施用的他莫昔芬剂量 $D$（例如，单位为 $\\mathrm{mg\\cdot kg^{-1}}$）。请考虑以下基本原理，这些原理被广泛用于模拟配体依赖性CreERT2激活对重组的药效学控制：\n\n- 根据具有协同性的质量作用定律，在剂量为 $D$ 时，功能性被他莫昔芬占据的配体结合位点的比例遵循Hill型占据模型，其Hill系数 $n \\ge 1$，占据分数为 $D^{n}/(K_{d}^{n}+D^{n})$，其中 $K_{d}$ 是有效解离常数。\n- 在CreERT2系统中，功能性激活需要配体结合和核转位。在诱导窗口期内，超出基线泄露的单细胞概率增量与活性部分成正比，并因有限的最大重组倾向而饱和。将基线（他莫昔芬非依赖性）重组概率表示为 $p_{0} \\in (0,1)$，将最大可诱导增量表示为 $p_{\\max} \\in (0,1-p_{0})$。\n- 定义 $EC_{50}$ 为可诱导部分达到其最大值一半时的剂量，并假设 $EC_{50}$ 等于占据模型中激活的有效效力标度。\n\n任务：\n\n1) 从这些基本原理出发，推导单细胞重组概率 $p(D)$ 作为 $D$ 函数的显式饱和表达式，并指明哪些参数控制泄露性，哪些参数控制可诱导响应的动态范围。\n\n2) 使用您推导出的模型，将动态范围定义为 $\\Delta \\equiv p(\\infty)-p(0)$，并用模型参数表示 $\\Delta$。\n\n3) 对于可诱导动态范围的一个目标分数 $f \\in (0,1)$，通过 $p(D_{f})-p(0)=f\\,\\Delta$ 隐式定义 $D_{f}$。用 $EC_{50}$、$n$ 和 $f$ 显式求解 $D_{f}$。\n\n用与 $EC_{50}$ 相同的单位（例如 $\\mathrm{mg\\cdot kg^{-1}}$）以符号形式表示您最终的剂量表达式 $D_{f}$。不要代入数值。无需四舍五入，您的最终答案必须是单一的闭式解析表达式。", "solution": "所述问题在科学上是合理的、自洽的且适定的。它提出了一个标准的药效学建模任务，并将其应用于他莫昔芬诱导的Cre-Lox重组背景下，这是发育生物学中的一种常用技术。所有给定的定义和假设都是该领域的标准，从而可以得到一个严谨且唯一的解。我们开始进行推导。\n\n首先，我们的任务是推导单细胞重组概率 $p(D)$ 作为他莫昔芬剂量 $D$ 函数的显式表达式。总概率是一个基线的、剂量无关的部分 $p_{0}$ 与一个剂量依赖的可诱导部分之和。问题陈述，这个可诱导增量与活性位点的占据分数成正比，并在最大值 $p_{\\max}$ 处饱和。占据分数遵循Hill型模型，由表达式 $\\frac{D^{n}}{K_{d}^{n}+D^{n}}$ 给出。因此，概率的可诱导部分恰好是 $p_{\\max}$ 乘以该占据分数。结合基线部分和可诱导部分，我们得到总概率：\n$$p(D) = p_{0} + p_{\\max} \\frac{D^{n}}{K_{d}^{n}+D^{n}}$$\n问题进一步假定，代表半数最大效应剂量的现象学参数 $EC_{50}$ 等同于有效解离常数 $K_{d}$。通过代入 $K_{d} = EC_{50}$，我们得到重组概率的最终模型：\n$$p(D) = p_{0} + p_{\\max} \\frac{D^{n}}{EC_{50}^{n}+D^{n}}$$\n从这个表达式可以清楚地看出，基线泄露，即在没有诱导剂（$D=0$）时的重组，由参数 $p_{0}$ 控制。可诱导响应的动态范围——从基线到完全饱和的变化幅度——由参数 $p_{\\max}$ 控制。\n\n其次，我们必须计算动态范围，其定义为 $\\Delta \\equiv p(\\infty)-p(0)$。这需要计算 $p(D)$ 表达式在极限 $D=0$ 和 $D \\to \\infty$ 处的值。\n在零剂量，$D=0$ 时，概率为：\n$$p(0) = p_{0} + p_{\\max} \\frac{0^{n}}{EC_{50}^{n}+0^{n}} = p_{0}$$\n在无限饱和剂量，当 $D \\to \\infty$ 时，我们计算分数项的极限。通过将分子和分母同时除以 $D^{n}$，我们发现：\n$$p(\\infty) = \\lim_{D \\to \\infty} \\left( p_{0} + p_{\\max} \\frac{D^{n}}{EC_{50}^{n}+D^{n}} \\right) = p_{0} + p_{\\max} \\lim_{D \\to \\infty} \\left( \\frac{1}{\\frac{EC_{50}^{n}}{D^{n}}+1} \\right) = p_{0} + p_{\\max} \\left( \\frac{1}{0+1} \\right) = p_{0} + p_{\\max}$$\n动态范围 $\\Delta$ 是这两个值之差：\n$$\\Delta = p(\\infty) - p(0) = (p_{0} + p_{\\max}) - p_{0} = p_{\\max}$$\n这证实了参数 $p_{\\max}$ 确实是可诱导部分的动态范围。\n\n第三，我们必须找到剂量 $D_{f}$ 的显式表达式，该剂量产生的诱导水平等于总动态范围的分数 $f$。定义方程为 $p(D_{f})-p(0)=f \\Delta$。我们将刚刚推导出的表达式代入此方程：\n$$ \\left( p_{0} + p_{\\max} \\frac{D_{f}^{n}}{EC_{50}^{n}+D_{f}^{n}} \\right) - p_{0} = f \\cdot p_{\\max} $$\n左侧的 $p_{0}$ 项相互抵消：\n$$ p_{\\max} \\frac{D_{f}^{n}}{EC_{50}^{n}+D_{f}^{n}} = f \\cdot p_{\\max} $$\n由于一个非平凡的可诱导系统要求 $p_{\\max} > 0$，我们可以无歧义地将两边同时除以 $p_{\\max}$：\n$$ \\frac{D_{f}^{n}}{EC_{50}^{n}+D_{f}^{n}} = f $$\n现在，我们必须进行代数重排来求解 $D_{f}$。\n$$ D_{f}^{n} = f(EC_{50}^{n}+D_{f}^{n}) $$\n$$ D_{f}^{n} = f \\cdot EC_{50}^{n} + f \\cdot D_{f}^{n} $$\n$$ D_{f}^{n} - f \\cdot D_{f}^{n} = f \\cdot EC_{50}^{n} $$\n$$ D_{f}^{n}(1-f) = f \\cdot EC_{50}^{n} $$\n由于 $f \\in (0,1)$，项 $(1-f)$ 非零，这使我们可以分离出 $D_{f}^{n}$：\n$$ D_{f}^{n} = EC_{50}^{n} \\left( \\frac{f}{1-f} \\right) $$\n最后，我们对两边取 $n$ 次方根。由于 $D_{f}$ 代表一个物理量（剂量），它必须是一个正实数。因为 $EC_{50} > 0$ 且对于 $f \\in (0,1)$，项 $\\frac{f}{1-f}$ 是正的，我们取主实根：\n$$ D_{f} = EC_{50} \\left( \\frac{f}{1-f} \\right)^{\\frac{1}{n}} $$\n这是达到分数 $f$ 激活水平所需剂量的最终显式表达式。", "answer": "$$\n\\boxed{EC_{50} \\left( \\frac{f}{1-f} \\right)^{\\frac{1}{n}}}\n$$", "id": "2637954"}, {"introduction": "在现代发育生物学研究中，一个前沿挑战是如何整合来自不同维度的实验数据，例如揭示细胞状态的单细胞转录组和记录细胞历史的遗传谱系条形码。这项练习将引导你设计一种算法，通过在细胞状态图上对不符合谱系关系的路径施加惩罚，来计算受谱系约束的“伪时间”轨迹[@problem_id:2637982]。这项实践不仅能让你掌握一种解决标准伪时间推断模糊性的先进计算方法，更能展示多模态数据整合在精确重建发育过程中的强大威力。", "problem": "在谱系追踪实验中，当使用可遗传的编辑条形码时，克隆身份会随着细胞分裂而传递。共享编辑信息的两个细胞比不共享的细胞更有可能具有克隆关系。在计算表示中，细胞流形通常由一个$k$最近邻（k-NN）图来近似，而伪时间可以被估计为从一个指定的根细胞出发的图测地线距离。为了整合谱系信息，在计算测地线距离时，对连接没有条形码兼容性的细胞之间的边进行惩罚。\n\n从以下基本原理出发：(i) 遗传性意味着条形码编辑是克隆传播的，因此在相关细胞间是共享的；(ii) 伪时间是发育进程的一个单调替代指标，可以近似为细胞图上的最短路径距离；(iii) 加权图上的最短路径是通过最小化一条路径上所有边的成本总和来获得的。请设计一个算法，在给定一个无向k-NN图、一组每个细胞的谱系条形码、一个惩罚参数和一个兼容性阈值的情况下，计算作为从指定根细胞出发的最小成本距离的谱系约束伪时间。\n\n形式上，假设有$n$个细胞，索引为$i \\in \\{0,\\dots,n-1\\}$，它们之间有无向边$(i,j)$，表示在表达空间中的邻近关系。设任何已存在边的基础成本为$w^{(0)}_{ij} = 1$。每个细胞$i$都有一组条形码编辑$B_i \\subset \\mathbb{N}$。定义杰卡德相似度 (Jaccard similarity) $J(B_i,B_j) = \\frac{|B_i \\cap B_j|}{|B_i \\cup B_j|}$，并约定$J(\\varnothing,\\varnothing) = 1$。对于用户指定的阈值$\\theta \\in [0,1]$和惩罚$\\lambda \\ge 0$，定义谱系惩罚的边成本为\n$$\nc_{ij} = w^{(0)}_{ij} + \\lambda \\cdot \\mathbf{1}\\!\\left[J(B_i,B_j) \\le \\theta\\right],\n$$\n其中$\\mathbf{1}[\\cdot]$是指示函数，且仅当$\\theta$严格小于$J(B_i,B_j)$时，该不等式才为严格不等式。从根$s \\in \\{0,\\dots,n-1\\}$出发的谱系约束伪时间是一个向量$d \\in \\mathbb{R}_{\\ge 0}^n$，其条目为\n$$\nd_k = \\min_{\\pi:s \\to k} \\sum_{(u,v) \\in \\pi} c_{uv},\n$$\n其中最小值取自图中所有从$s$到$k$的路径$\\pi$。如果不存在从$s$到$k$的路径，则$d_k = +\\infty$。\n\n实现一个程序，为以下每个测试用例计算$d$。对于每个测试，输入被指定为节点数、无向边列表、条形码、惩罚$\\lambda$、阈值$\\theta$和根$s$。所有边的基础成本均为$w^{(0)}_{ij} = 1$。\n\n测试用例 1 (混合兼容性的正常路径)：\n- $n = 5$\n- 边: $(0,1),(1,2),(2,3),(3,4)$\n- 条形码: $B_0=\\{1\\}$, $B_1=\\{1\\}$, $B_2=\\{1,2\\}$, $B_3=\\{3\\}$, $B_4=\\{3\\}$\n- 惩罚: $\\lambda = 2.0$\n- 阈值: $\\theta = 0.0$\n- 根: $s = 0$\n\n测试用例 2 (更严格的兼容性阈值)：\n- $n = 5$\n- 边: $(0,1),(1,2),(2,3),(3,4)$\n- 条形码: $B_0=\\{1\\}$, $B_1=\\{1\\}$, $B_2=\\{1,2\\}$, $B_3=\\{3\\}$, $B_4=\\{3\\}$\n- 惩罚: $\\lambda = 2.0$\n- 阈值: $\\theta = 0.75$\n- 根: $s = 0$\n\n测试用例 3 (具有不同谱系惩罚的两条竞争路径)：\n- $n = 4$\n- 边: $(0,1),(1,3),(0,2),(2,3)$\n- 条形码: $B_0=\\{1\\}$, $B_1=\\{1\\}$, $B_2=\\{2\\}$, $B_3=\\{1\\}$\n- 惩罚: $\\lambda = 1.2$\n- 阈值: $\\theta = 0.0$\n- 根: $s = 0$\n\n测试用例 4 (具有不可达节点和空条形码的边界情况)：\n- $n = 3$\n- 边: $(0,1)$\n- 条形码: $B_0=\\varnothing$, $B_1=\\varnothing$, $B_2=\\{3\\}$\n- 惩罚: $\\lambda = 5.0$\n- 阈值: $\\theta = 0.0$\n- 根: $s = 0$\n\n您的程序必须：\n- 使用上面定义的$c_{ij}$构建加权图。\n- 使用适用于非负边权重的正确最短路径算法，从指定的根$s$计算谱系约束伪时间向量$d$。\n- 对于每个测试用例，按节点索引顺序$(0,1,\\dots,n-1)$输出向量$d$。\n\n答案规范：\n- 对于每个测试用例，输出一个浮点数列表，对应于$d_0,\\dots,d_{n-1}$，有限值四舍五入到恰好三位小数。不可达节点必须使用字符串$inf$表示为正无穷大。\n- 通过打印一个包含四个测试列表的单一列表，将所有测试用例的结果聚合到一行中，顺序从测试用例1到测试用例4。\n- 最终输出必须是形如$[[\\dots],[\\dots],[\\dots],[\\dots]]$的单行，方括号内是逗号分隔的值。\n\n不提供外部输入；所有数据都嵌入在程序中。不涉及物理单位，任何角度（如果存在）都与此问题无关。解决方案必须是通用的，并且纯粹是如上所述的算法。", "solution": "在尝试解决方案之前，对问题进行验证。\n\n**步骤 1：提取给定信息**\n- 细胞数量：$n \\in \\mathbb{N}$\n- 图：无向，边为 $(i,j)$，其中 $i,j \\in \\{0, \\dots, n-1\\}$。\n- 基础边成本：$w^{(0)}_{ij} = 1$ 对所有存在的边。\n- 条形码：每个细胞 $i$ 的一组条形码编辑 $B_i \\subset \\mathbb{N}$。\n- 惩罚参数：$\\lambda \\ge 0$。\n- 兼容性阈值：$\\theta \\in [0,1]$。\n- 根细胞：$s \\in \\{0, \\dots, n-1\\}$。\n- 杰卡德相似度 (Jaccard similarity)：$J(B_i,B_j) = \\frac{|B_i \\cap B_j|}{|B_i \\cup B_j|}$，并约定 $J(\\varnothing,\\varnothing) = 1$。\n- 谱系惩罚的边成本：$c_{ij} = w^{(0)}_{ij} + \\lambda \\cdot \\mathbf{1}\\!\\left[J(B_i,B_j) \\le \\theta\\right]$。\n- 谱系约束伪时间：$d_k = \\min_{\\pi:s \\to k} \\sum_{(u,v) \\in \\pi} c_{uv}$，其中 $\\pi$ 是从 $s$ 到 $k$ 的一条路径。若无路径存在，则 $d_k = +\\infty$。\n- 具有特定 $n$、边、条形码、$\\lambda$、$\\theta$ 和 $s$ 值的测试用例。\n\n**步骤 2：使用提取的给定信息进行验证**\n对问题的有效性进行审查。\n- **科学依据**：该问题正确地基于计算发育生物学的原理，特别是谱系追踪、伪时间推断和基于图的细胞状态流形建模。这些概念是标准的且科学上是合理的。\n- **适定性**：目标是计算具有非负边权重的图上的单源最短路径。这是计算机科学和数学中的一个经典的、适定的问题，存在唯一且稳定的解。\n- **客观性**：该问题通过精确的数学公式和客观标准进行定义。\n- **潜在缺陷**：在问题陈述中注意到一个歧义。边成本的数学公式 $c_{ij} = w^{(0)}_{ij} + \\lambda \\cdot \\mathbf{1}\\!\\left[J(B_i,B_j) \\le \\theta\\right]$ 是清晰的。然而，随后的句子，“且仅当 $\\theta$ 严格小于 $J(B_i,B_j)$ 时，该不等式才为严格不等式”，在逻辑上是自相矛盾的。形如“仅当 B 时 A”的断言等价于“如果 A 则 B”。此处，A 是“$J(B_i,B_j)  \\theta$”，B 是“$\\theta  J(B_i,B_j)$”。蕴涵关系“$J(B_i,B_j)  \\theta \\implies \\theta  J(B_i,B_j)$”是一个谬误。这是一个小缺陷（违反了第5条标准，“结构不良”），但并不会使问题无法解决。其意图已通过明确的数学公式清晰传达。解决方案将严格遵守公式 $\\mathbf{1}\\!\\left[J(B_i,B_j) \\le \\theta\\right]$，并忽略矛盾的解释性文本。问题的所有其他方面都是完整、一致且定义明确的。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供解决方案。\n\n**基于原理的算法设计**\n\n该问题要求计算谱系约束伪时间，其定义为加权k-NN图上从根细胞 $s$ 出发的最短路径距离。算法的设计直接源于此定义。\n\n1.  **图表示与边权重计算**：\n    由 $n$ 个细胞及其邻近关系组成的系统被建模为一个无向图 $G = (V, E)$，其中 $V = \\{0, 1, \\dots, n-1\\}$ 是细胞集合，E 是给定的边集合。问题的核心是为每条边 $(u,v) \\in E$ 分配合适的权重或成本 $c_{uv}$。成本定义为：\n    $$\n    c_{uv} = w^{(0)}_{uv} + \\lambda \\cdot \\mathbf{1}\\!\\left[J(B_u,B_v) \\le \\theta\\right]\n    $$\n    基础成本 $w^{(0)}_{uv}$ 给定为 $1$。惩罚项 $\\lambda \\cdot \\mathbf{1}[\\dots]$ 在连接的细胞 $u$ 和 $v$ 不具有克隆关系时（通过其条形码相似度衡量）增加边的成本。杰卡德相似度 $J(B_u, B_v)$ 量化了条形码集 $B_u$ 和 $B_v$ 之间的重叠。低的杰卡德分数表示重叠度低，表明细胞来自不同的克隆。当 $J(B_u, B_v)$ 小于或等于用户定义的阈值 $\\theta$ 时，施加惩罚。为实现这一点，我们首先需要一个函数来计算两组条形码之间的杰卡德相似度，并处理并集为空时的特殊情况 $J(\\varnothing,\\varnothing) = 1$。对于任意两个集合 $B_i$ 和 $B_j$，相似度计算为 $J(B_i, B_j) = \\frac{|B_i \\cap B_j|}{|B_i \\cup B_j|}$。一个大小为 $n \\times n$ 的邻接矩阵，记为 $C$，是表示该加权图的合适数据结构。对于每个给定的边 $(i, j)$，计算相应的权重 $c_{ij}$ 并存储在矩阵中，使得 $C_{ij} = C_{ji} = c_{ij}$。对于没有边连接的节点对 $(i, j)$，相应的矩阵条目设置为无穷大，$C_{ij} = \\infty$。\n\n2.  **最短路径算法**：\n    细胞 $k$ 的谱系约束伪时间 $d_k$ 是加权图中从根细胞 $s$ 到 $k$ 的最短路径长度。这是一个经典的单源最短路径（SSSP）问题。由于基础成本为 $1$ 且惩罚参数 $\\lambda$ 为非负，所有边权重 $c_{ij}$ 都保证为非负。对于具有非负边权重的图上的 SSSP 问题，Dijkstra 算法是标准且最高效的方法。\n\n    Dijkstra 算法从源节点 $s$ 开始，迭代地探索图，维护一个已访问节点的集合和一个距离数组。它不断选择距离源节点已知距离最小的未访问节点，将其标记为已访问，并更新其未访问邻居的距离。这个过程保证能找到从源节点到所有其他可达节点的最短路径。\n\n3.  **总体流程**：\n    每个测试用例的完整算法如下：\n    a. 初始化一个 $n \\times n$ 的邻接矩阵 $C$，所有值设为无穷大，表示没有路径。\n    b. 对于输入列表中的每条边 $(i, j)$：\n        i.  检索条形码集 $B_i$ 和 $B_j$。\n        ii. 计算杰卡德相似度 $J(B_i, B_j)$。\n        iii. 通过检查 $J(B_i, B_j) \\le \\theta$ 来确定是否施加惩罚。\n        iv. 计算权重 $c_{ij} = 1 + \\lambda \\cdot \\mathbf{1}[J(B_i, B_j) \\le \\theta]$。\n        v.  设置 $C_{ij} = c_{ij}$ 和 $C_{ji} = c_{ij}$。\n    c. 对由邻接矩阵 $C$ 表示的图应用 Dijkstra 算法，以指定的根节点 $s$ 为起点。这可以通过使用库函数如 `scipy.sparse.csgraph.dijkstra` 来高效完成。\n    d. 算法返回一个向量 $d = [d_0, d_1, \\dots, d_{n-1}]$，其中 $d_k$ 是从 $s$ 到 $k$ 的最短距离。不可达节点的距离为 $\\infty$。\n    e. 按照规定格式化结果距离向量：将有限值四舍五入到三位小数，并用字符串 'inf' 表示无穷大距离。这个结果列表即为该测试用例的解。\n\n此流程将问题中陈述的生物学和数学原理正确地转化为一个具体且可解的计算任务。", "answer": "[[0.000,1.000,2.000,5.000,6.000],[0.000,1.000,4.000,7.000,8.000],[0.000,1.000,2.200,2.000],[0.000,1.000,inf]]", "id": "2637982"}]}