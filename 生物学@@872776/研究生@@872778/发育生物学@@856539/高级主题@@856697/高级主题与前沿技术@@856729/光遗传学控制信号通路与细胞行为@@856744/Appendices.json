{"hands_on_practices": [{"introduction": "在结合光遗传学控制和荧光报告基因的实验中，一个常见的挑战是光谱串扰。这个问题将带你实践如何基于光遗传学工具和荧光蛋白的光谱特性，定量地选择最佳的滤光片和激发光源组合，从而最大限度地减少信号串扰，确保数据的可靠性。[@problem_id:2658960]", "problem": "一项胚胎尺度的形态发生实验使用来自向光素的光-氧-电压传感结构域 $2$ (LOV$2$) 及其黄素单核苷酸 (FMN) 发色团，在发育中的组织中光遗传学地控制 RhoA 活性，同时使用绿色荧光蛋白 (GFP) 生物传感器报告下游的细胞骨架变化。LOV$2$ 的光循环通过 FMN 吸收蓝光而被激活，而 GFP 的读出则通过在其吸收峰附近进行激发并检测其绿色发射来实现。显微镜采用激光 (Light Amplification by Stimulated Emission of Radiation, LASER) 谱线和带有带通滤波器及二向色镜的发光二极管。交叉激发和串扰源于激活光谱和发射光谱之间的光谱重叠。您必须合理选择一种激活源、一种 GFP 激发源和一种 GFP 发射滤光片，以在保持足够读出信号的同时，最大限度地减少串扰。\n\n请使用以下基本原理和经过充分检验的事实。\n\n- 荧光团或光感受器的吸收驱动激发率，与入射光子通量谱 $I(\\lambda)$ 及其依赖波长的吸收（或消光系数）$\\varepsilon(\\lambda)$ 之间的光谱重叠积分成正比，即 $k \\propto \\int I(\\lambda)\\,\\varepsilon(\\lambda)\\,d\\lambda$。在窄带上采用归一化积分光子通量的离散近似中，这简化为在代表性波长处 $\\varepsilon(\\lambda)$ 的平均值。\n- 通过滤光片检测到的发射信号，与发射体的归一化发射光谱 $E(\\lambda)$ 和滤光片透射率 $T(\\lambda)$ 的重叠成正比，即 $S \\propto \\int E(\\lambda)\\,T(\\lambda)\\,d\\lambda$。在具有均匀透射率的带通窗口上采用离散近似时，这简化为在代表性波长处 $E(\\lambda)$ 的平均值。\n- LOV$2$ 的 FMN 吸收峰在蓝色区域，GFP 的吸收峰在蓝绿色附近；GFP 的发射峰在绿色附近，而 FMN 的发射较弱，其峰值相对于 GFP 略有红移。\n\n假设在离散波长处有以下归一化光谱值（所有值均为无单位值，每个光谱的峰值均归一化为 $1$）。GFP 吸收值 $\\varepsilon_{\\mathrm{GFP}}(\\lambda)$ 和 LOV$2$/FMN 吸收值 $\\varepsilon_{\\mathrm{LOV}}(\\lambda)$ 在 $\\lambda \\in \\{450,465,480,488,500,510\\}\\,\\mathrm{nm}$ 给出，GFP 和 LOV$2$ 的发射值在 $\\lambda \\in \\{505,510,515,525,540\\}\\,\\mathrm{nm}$ 给出。\n\n- GFP 吸收值 $\\varepsilon_{\\mathrm{GFP}}(\\lambda)$: 在 $450\\,\\mathrm{nm}$ 处为 $0.15$；$465\\,\\mathrm{nm}$ 处为 $0.40$；$480\\,\\mathrm{nm}$ 处为 $0.80$；$488\\,\\mathrm{nm}$ 处为 $1.00$；$500\\,\\mathrm{nm}$ 处为 $0.60$；$510\\,\\mathrm{nm}$ 处为 $0.20$。\n- LOV$2$/FMN 吸收值 $\\varepsilon_{\\mathrm{LOV}}(\\lambda)$: 在 $450\\,\\mathrm{nm}$ 处为 $1.00$；$465\\,\\mathrm{nm}$ 处为 $0.80$；$480\\,\\mathrm{nm}$ 处为 $0.50$；$488\\,\\mathrm{nm}$ 处为 $0.35$；$500\\,\\mathrm{nm}$ 处为 $0.20$；$510\\,\\mathrm{nm}$ 处为 $0.10$。\n- GFP 发射值 $E_{\\mathrm{GFP}}(\\lambda)$: 在 $505\\,\\mathrm{nm}$ 处为 $0.90$；$510\\,\\mathrm{nm}$ 处为 $1.00$；$515\\,\\mathrm{nm}$ 处为 $0.90$；$525\\,\\mathrm{nm}$ 处为 $0.60$；$540\\,\\mathrm{nm}$ 处为 $0.20$。\n- LOV$2$/FMN 发射值 $E_{\\mathrm{LOV}}(\\lambda)$: 在 $505\\,\\mathrm{nm}$ 处为 $0.50$；$510\\,\\mathrm{nm}$ 处为 $0.60$；$515\\,\\mathrm{nm}$ 处为 $0.70$；$525\\,\\mathrm{nm}$ 处为 $1.00$；$540\\,\\mathrm{nm}$ 处为 $0.70$。\n\n假设所有候选激发源（激活源或 GFP 激发源）都经过强度归一化，使其通带内的积分光子通量等于 $1$，并且所有发射滤光片在其通带内具有平坦的单位透射率，在通带外为 $0$。将重叠积分近似为落在给定通带内的所列离散波长处的简单平均值。\n\n定义串扰的三个来源：\n\n- 在 LOV$2$ 激活期间对 GFP 的交叉激发：$C_1 \\propto \\int_{\\text{activation band}} \\varepsilon_{\\mathrm{GFP}}(\\lambda)\\,d\\lambda$，近似为激活通带内离散波长处 $\\varepsilon_{\\mathrm{GFP}}(\\lambda)$ 的平均值。\n- 在 GFP 激发期间对 LOV$2$ 的意外激活：$C_2 \\propto \\int_{\\text{GFP excitation band}} \\varepsilon_{\\mathrm{LOV}}(\\lambda)\\,d\\lambda$，近似为 GFP 激发通带内离散波长处 $\\varepsilon_{\\mathrm{LOV}}(\\lambda)$ 的平均值。\n- LOV$2$ 发射渗漏到 GFP 检测通道：$C_3 \\propto \\int_{\\text{GFP emission filter}} E_{\\mathrm{LOV}}(\\lambda)\\,d\\lambda$，近似为发射通带内离散波长处 $E_{\\mathrm{LOV}}(\\lambda)$ 的平均值。\n\n将它们组合成一个标量串扰度量 $C = C_1 + C_2 + w\\,C_3$，权重 $w = 0.20$ 反映了在该系统中 LOV$2$ 的荧光相对于 GFP 较弱。\n\nGFP 读出效率为 $R = R_{\\mathrm{exc}}\\times R_{\\mathrm{em}}$，其中 $R_{\\mathrm{exc}} \\propto \\int_{\\text{GFP excitation band}} \\varepsilon_{\\mathrm{GFP}}(\\lambda)\\,d\\lambda$ 和 $R_{\\mathrm{em}} \\propto \\int_{\\text{GFP emission filter}} E_{\\mathrm{GFP}}(\\lambda)\\,d\\lambda$，每一项都近似为通带内离散波长处的简单平均值。\n\n约束条件：为在动态组织中提供足够的信噪比，要求 $R \\ge 0.60$（无量纲，在这些归一化单位下）。\n\n从以下候选方案中选择满足 $R \\ge 0.60$ 条件下使 $C$ 最小化的单一配置。每个选项都指定了 LOV$2$ 的激活源、GFP 激发源、GFP 发射滤光片和二向色镜截止波长（假设二向色镜在所述截止波长处是理想的长通反射镜，并且在这些计算中不产生额外的泄漏；其作用是确保正确的光路引导）。\n\n- A. 使用 $450/20\\,\\mathrm{nm}$ 带通（覆盖 $440$–$460\\,\\mathrm{nm}$）进行激活，使用 $488/10\\,\\mathrm{nm}$（覆盖 $483$–$493\\,\\mathrm{nm}$）激发 GFP，使用 $510/10\\,\\mathrm{nm}$ 发射滤光片（覆盖 $505$–$515\\,\\mathrm{nm}$）检测 GFP，二向色镜长通截止波长为 $495\\,\\mathrm{nm}$。\n\n- B. 使用 $465/30\\,\\mathrm{nm}$ 带通（覆盖 $450$–$480\\,\\mathrm{nm}$）进行激活，使用 $488/10\\,\\mathrm{nm}$ 激发 GFP，使用 $525/50\\,\\mathrm{nm}$ 发射滤光片（覆盖 $500$–$550\\,\\mathrm{nm}$）检测 GFP，二向色镜长通截止波长为 $470\\,\\mathrm{nm}$。\n\n- C. 使用 $488\\,\\mathrm{nm}$ 线（类 δ 函数）进行激活，使用 $500/20\\,\\mathrm{nm}$（覆盖 $490$–$510\\,\\mathrm{nm}$）激发 GFP，使用 $525/50\\,\\mathrm{nm}$ 发射滤光片检测 GFP，二向色镜长通截止波长为 $495\\,\\mathrm{nm}$。\n\n- D. 使用 $450/20\\,\\mathrm{nm}$ 带通进行激活，使用 $500/20\\,\\mathrm{nm}$ 激发 GFP，使用 $510/10\\,\\mathrm{nm}$ 发射滤光片检测 GFP，二向色镜长通截止波长为 $495\\,\\mathrm{nm}$。\n\n使用上述重叠原理，解释为什么光谱重叠会导致成像中的交叉激发，并在根据所述约束条件选择最佳配置之前，展示您对每个选项的 $C$ 和 $R$ 的计算过程。请勿提供外部资源；您的推理应仅基于此处给出的数据和原理。", "solution": "所述问题是有效的。它在科学上基于光物理学和荧光显微镜的原理，是一个设定良好的优化问题，具有所有必要的数据和清晰、客观的标准。我们现在开始进行分析。\n\n首先，需要解释光谱重叠。光感受器或荧光团的激发并不局限于单一特定波长，而是在由其吸收光谱 $\\varepsilon(\\lambda)$ 定义的一系列波长范围内发生。诸如激光或LED之类的光源也具有光谱分布 $I(\\lambda)$。总激发率与这两个函数的光谱重叠积分成正比：$k \\propto \\int I(\\lambda)\\,\\varepsilon(\\lambda)\\,d\\lambda$。因此，当存在不希望的重叠时，就会出现“串扰”。\n具体而言：\n$1$. **交叉激发 ($C_1$)**: 用于激活 LOV$2$ 系统的光源的光谱分布与 GFP 生物传感器的吸收光谱重叠。这会导致 GFP 的意外激发，增加了一个与所测量的生物过程无关的背景信号。\n$2$. **意外激活 ($C_2$)**: 用于激发 GFP 以进行读出的光源的光谱与 LOV$2$ 吸收光谱重叠。这会导致光遗传学工具的虚假激活，干扰预期的时空控制模式。\n$3$. **发射渗漏 ($C_3$)**: LOV$2$ 系统的发射光谱 $E_{\\mathrm{LOV}}(\\lambda)$ 与用于检测 GFP 发射的滤光片的透射窗口 $T(\\lambda)$ 重叠。这使得不希望的 LOV$2$ 荧光到达检测器，污染了 GFP 信号。\n\n我们的任务是选择光源和滤光片的配置，以在 GFP 读出效率 $R$ 必须至少为 $0.60$ 的约束条件下，最小化总串扰度量 $C = C_1 + C_2 + w\\,C_3$（其中权重 $w=0.20$）。我们将评估四个候选配置中的每一个。\n\n提供的用于吸收的离散光谱点位于 $\\lambda \\in \\{450, 465, 480, 488, 500, 510\\}\\,\\mathrm{nm}$。对于发射，它们位于 $\\lambda \\in \\{505, 510, 515, 525, 540\\}\\,\\mathrm{nm}$。我们使用给定的近似方法，对落在每个指定光学通带内的离散波长处的光谱值进行平均。\n\n**选项 A 分析**\n- LOV$2$ 激活源：$450/20\\,\\mathrm{nm}$ 带通（覆盖 $440$–$460\\,\\mathrm{nm}$）。唯一相关的数据点位于 $\\lambda = 450\\,\\mathrm{nm}$。\n- GFP 激发源：$488/10\\,\\mathrm{nm}$（覆盖 $483$–$493\\,\\mathrm{nm}$）。唯一相关的数据点位于 $\\lambda = 488\\,\\mathrm{nm}$。\n- GFP 发射滤光片：$510/10\\,\\mathrm{nm}$（覆盖 $505$–$515\\,\\mathrm{nm}$）。相关的数据点位于 $\\lambda \\in \\{505, 510, 515\\}\\,\\mathrm{nm}$。\n\n计算：\n- $C_1 = \\varepsilon_{\\mathrm{GFP}}(450) = 0.15$\n- $C_2 = \\varepsilon_{\\mathrm{LOV}}(488) = 0.35$\n- $C_3 = \\frac{E_{\\mathrm{LOV}}(505) + E_{\\mathrm{LOV}}(510) + E_{\\mathrm{LOV}}(515)}{3} = \\frac{0.50 + 0.60 + 0.70}{3} = \\frac{1.80}{3} = 0.60$\n- 总串扰 $C_A = C_1 + C_2 + w\\,C_3 = 0.15 + 0.35 + (0.20)(0.60) = 0.50 + 0.12 = 0.62$\n- $R_{\\mathrm{exc}} = \\varepsilon_{\\mathrm{GFP}}(488) = 1.00$\n- $R_{\\mathrm{em}} = \\frac{E_{\\mathrm{GFP}}(505) + E_{\\mathrm{GFP}}(510) + E_{\\mathrm{GFP}}(515)}{3} = \\frac{0.90 + 1.00 + 0.90}{3} = \\frac{2.80}{3} \\approx 0.933$\n- 总读出效率 $R_A = R_{\\mathrm{exc}} \\times R_{\\mathrm{em}} = 1.00 \\times \\frac{2.80}{3} \\approx 0.933$\n\n约束条件 $R_A \\ge 0.60$ 得到满足。这是一个有效的配置。\n\n**选项 B 分析**\n- LOV$2$ 激活源：$465/30\\,\\mathrm{nm}$ 带通（覆盖 $450$–$480\\,\\mathrm{nm}$）。相关数据点：$\\lambda \\in \\{450, 465, 480\\}\\,\\mathrm{nm}$。\n- GFP 激发源：$488/10\\,\\mathrm{nm}$（覆盖 $483$–$493\\,\\mathrm{nm}$）。相关数据点：$\\lambda = 488\\,\\mathrm{nm}$。\n- GFP 发射滤光片：$525/50\\,\\mathrm{nm}$（覆盖 $500$–$550\\,\\mathrm{nm}$）。相关数据点：$\\lambda \\in \\{505, 510, 515, 525, 540\\}\\,\\mathrm{nm}$。\n\n计算：\n- $C_1 = \\frac{\\varepsilon_{\\mathrm{GFP}}(450) + \\varepsilon_{\\mathrm{GFP}}(465) + \\varepsilon_{\\mathrm{GFP}}(480)}{3} = \\frac{0.15 + 0.40 + 0.80}{3} = \\frac{1.35}{3} = 0.45$\n- $C_2 = \\varepsilon_{\\mathrm{LOV}}(488) = 0.35$\n- $C_3 = \\frac{E_{\\mathrm{LOV}}(505) + E_{\\mathrm{LOV}}(510) + E_{\\mathrm{LOV}}(515) + E_{\\mathrm{LOV}}(525) + E_{\\mathrm{LOV}}(540)}{5} = \\frac{0.50 + 0.60 + 0.70 + 1.00 + 0.70}{5} = \\frac{3.50}{5} = 0.70$\n- 总串扰 $C_B = C_1 + C_2 + w\\,C_3 = 0.45 + 0.35 + (0.20)(0.70) = 0.80 + 0.14 = 0.94$\n- $R_{\\mathrm{exc}} = \\varepsilon_{\\mathrm{GFP}}(488) = 1.00$\n- $R_{\\mathrm{em}} = \\frac{E_{\\mathrm{GFP}}(505) + E_{\\mathrm{GFP}}(510) + E_{\\mathrm{GFP}}(515) + E_{\\mathrm{GFP}}(525) + E_{\\mathrm{GFP}}(540)}{5} = \\frac{0.90 + 1.00 + 0.90 + 0.60 + 0.20}{5} = \\frac{3.60}{5} = 0.72$\n- 总读出效率 $R_B = R_{\\mathrm{exc}} \\times R_{\\mathrm{em}} = 1.00 \\times 0.72 = 0.72$\n\n约束条件 $R_B \\ge 0.60$ 得到满足。这是一个有效的配置。\n\n**选项 C 分析**\n- LOV$2$ 激活源：$488\\,\\mathrm{nm}$ 线。相关数据点：$\\lambda = 488\\,\\mathrm{nm}$。\n- GFP 激发源：$500/20\\,\\mathrm{nm}$（覆盖 $490$–$510\\,\\mathrm{nm}$）。相关数据点：$\\lambda \\in \\{500, 510\\}\\,\\mathrm{nm}$。\n- GFP 发射滤光片：$525/50\\,\\mathrm{nm}$（覆盖 $500$–$550\\,\\mathrm{nm}$）。相关数据点：$\\lambda \\in \\{505, 510, 515, 525, 540\\}\\,\\mathrm{nm}$。\n\n计算：\n- $C_1 = \\varepsilon_{\\mathrm{GFP}}(488) = 1.00$。这是极高的交叉激发，正如在 GFP 吸收峰附近激活时所预期的那样。\n- $C_2 = \\frac{\\varepsilon_{\\mathrm{LOV}}(500) + \\varepsilon_{\\mathrm{LOV}}(510)}{2} = \\frac{0.20 + 0.10}{2} = 0.15$\n- $C_3 = \\frac{0.50 + 0.60 + 0.70 + 1.00 + 0.70}{5} = 0.70$\n- 总串扰 $C_C = C_1 + C_2 + w\\,C_3 = 1.00 + 0.15 + (0.20)(0.70) = 1.15 + 0.14 = 1.29$\n- $R_{\\mathrm{exc}} = \\frac{\\varepsilon_{\\mathrm{GFP}}(500) + \\varepsilon_{\\mathrm{GFP}}(510)}{2} = \\frac{0.60 + 0.20}{2} = 0.40$\n- $R_{\\mathrm{em}} = \\frac{0.90 + 1.00 + 0.90 + 0.60 + 0.20}{5} = 0.72$\n- 总读出效率 $R_C = R_{\\mathrm{exc}} \\times R_{\\mathrm{em}} = 0.40 \\times 0.72 = 0.288$\n\n约束条件 $R_C \\ge 0.60$ **未**得到满足。此配置提供的信号不足。\n\n**选项 D 分析**\n- LOV$2$ 激活源：$450/20\\,\\mathrm{nm}$ 带通（覆盖 $440$–$460\\,\\mathrm{nm}$）。相关数据点：$\\lambda = 450\\,\\mathrm{nm}$。\n- GFP 激发源：$500/20\\,\\mathrm{nm}$（覆盖 $490$–$510\\,\\mathrm{nm}$）。相关数据点：$\\lambda \\in \\{500, 510\\}\\,\\mathrm{nm}$。\n- GFP 发射滤光片：$510/10\\,\\mathrm{nm}$（覆盖 $505$–$515\\,\\mathrm{nm}$）。相关数据点：$\\lambda \\in \\{505, 510, 515\\}\\,\\mathrm{nm}$。\n\n计算：\n- $C_1 = \\varepsilon_{\\mathrm{GFP}}(450) = 0.15$\n- $C_2 = \\frac{\\varepsilon_{\\mathrm{LOV}}(500) + \\varepsilon_{\\mathrm{LOV}}(510)}{2} = \\frac{0.20 + 0.10}{2} = 0.15$\n- $C_3 = \\frac{E_{\\mathrm{LOV}}(505) + E_{\\mathrm{LOV}}(510) + E_{\\mathrm{LOV}}(515)}{3} = \\frac{0.50 + 0.60 + 0.70}{3} = 0.60$\n- 总串扰 $C_D = C_1 + C_2 + w\\,C_3 = 0.15 + 0.15 + (0.20)(0.60) = 0.30 + 0.12 = 0.42$\n- $R_{\\mathrm{exc}} = \\frac{\\varepsilon_{\\mathrm{GFP}}(500) + \\varepsilon_{\\mathrm{GFP}}(510)}{2} = \\frac{0.60 + 0.20}{2} = 0.40$\n- $R_{\\mathrm{em}} = \\frac{E_{\\mathrm{GFP}}(505) + E_{\\mathrm{GFP}}(510) + E_{\\mathrm{GFP}}(515)}{3} = \\frac{0.90 + 1.00 + 0.90}{3} \\approx 0.933$\n- 总读出效率 $R_D = R_{\\mathrm{exc}} \\times R_{\\mathrm{em}} = 0.40 \\times \\frac{2.80}{3} \\approx 0.373$\n\n约束条件 $R_D \\ge 0.60$ **未**得到满足。此配置提供的信号不足。\n\n**结论**\n我们总结有效配置的结果：\n- **选项 A**: $R_A \\approx 0.933$ (有效), $C_A = 0.62$\n- **选项 B**: $R_B = 0.720$ (有效), $C_B = 0.94$\n\n选项 A 和 B 都满足读出效率要求 $R \\ge 0.60$。目标是最小化串扰度量 $C$。比较这两个有效选项，我们发现 $C_A = 0.62$ 显著低于 $C_B = 0.94$。因此，选项 A 代表了最优选择。\n\n**选项 A 是正确的。** 该配置在 GFP 的吸收峰波长（$488\\,\\mathrm{nm}$）处有效激发 GFP，产生高读出效率。它在 $450\\,\\mathrm{nm}$ 处激活 LOV$2$，此处 LOV$2$ 吸收最大而 GFP 吸收较低，从而最小化了 $C_1$。尽管在 GFP 读出期间存在中等程度的 LOV$2$ 交叉激活（$C_2=0.35$），但总体串扰在可行选项中是最低的。\n**选项 B 是不正确的。** 虽然它提供了足够的读出效率，但其串扰值 $C = 0.94$ 远高于选项 A。更宽的激活带和更宽的发射滤光片都导致了串扰的增加。\n**选项 C 是不正确的。** 它未能满足最低读出效率要求（$R \\approx 0.288$），这主要是因为在远离其吸收峰的位置激发 GFP（$R_{\\mathrm{exc}}=0.40$）导致信号不佳。此外，在 $488\\,\\mathrm{nm}$ 处激活 LOV$2$ 会引起对 GFP 的大规模交叉激发（$C_1=1.00$），导致最高的总串扰。\n**选项 D 是不正确的。** 它提供了最低的串扰（$C=0.42$），但代价是牺牲了读出效率。与选项 C 一样，它在非峰值位置激发 GFP，导致信号过低，无法接受（$R \\approx 0.373$）。这展示了在最小化串扰和最大化信号之间的权衡。\n\n在保持足够读出信号的同时最小化串扰的唯一最佳配置是选项 A。", "answer": "$$\\boxed{A}$$", "id": "2658960"}, {"introduction": "解决了光学层面的串扰后，我们还必须考虑生物学通路自身的复杂性。信号通路在细胞内相互交织，一个通路的激活可能无意中影响另一个。这个练习旨在训练你如何设计精巧的时间分辨实验，并结合特异性抑制剂，来严谨地区分直接的光遗传学激活效应与下游的通路间串扰，这是确保结论正确性的关键一步。[@problem_id:2658937]", "problem": "您设计了人类上皮细胞，使其表达一种蓝光响应的隐花色素2 (Cryptochrome 2, CRY2)–Raf融合蛋白，以及其膜锚定蛋白——隐花色素相互作用碱性螺旋-环-螺旋转录因子N端 (Cryptochrome-Interacting Basic-helix-loop-helix N-terminus, CIBN)，这样蓝光就能将Raf招募至质膜，从而在Raf的层面上直接激活丝裂原活化蛋白激酶/细胞外信号调节激酶 (MAPK/ERK) 级联反应。您共表达了两种活细胞生物传感器：一种是ERK激酶易位报告子 (ERK Kinase Translocation Reporter, ERK KTR)，它在ERK被激活时会离开细胞核；另一种是来自AKT1的Pleckstrin同源 (PH) 结构域，它与一种荧光蛋白融合，其向细胞膜的易位量与磷脂酰肌醇$(3,4,5)$-三磷酸的产生量成正比（作为磷脂酰肌醇$3$-激酶 (PI3K) 活性的代理指标）。您还获得了丝裂原活化蛋白激酶/细胞外信号调节激酶的激酶 (MEK) 的抑制剂 (trametinib)，它可以阻断Raf下游的ERK激活；以及一种PI3K抑制剂 (wortmannin)，它可以阻断AKT上游由PI3K生成的脂质产物。\n\n您的目标是设计一个时间分辨实验，利用这些通路特异性抑制剂和定量分析，来区分Raf–MEK–ERK通路的直接光遗传学激活与下游的串扰效应。该设计必须基于信号传导中因果关系的基本原理以及经过充分检验的多步级联反应动力学，而不是基于未经证实的假设。\n\n您可以使用的基本原理：\n- 在因果系统中，结果不能先于其原因。如果一个输入 $I(t)$ 通过一个具有脉冲响应 $h_{\\mathrm{direct}}(t)$ 和延迟 $\\delta_{\\mathrm{d}}$ 的直接通路引发一个输出 $R(t)$，那么 $$R_{\\mathrm{direct}}(t)=\\int_{-\\infty}^{t-\\delta_{\\mathrm{d}}} I(\\tau)\\,h_{\\mathrm{direct}}(t-\\tau-\\delta_{\\mathrm{d}})\\,d\\tau,$$ 这意味着当 $t < \\delta_{\\mathrm{d}}$ 时，$R_{\\mathrm{direct}}(t)=0$。\n- 串联级联会增加延迟；一个具有延迟 $\\delta_{\\mathrm{c}}>\\delta_{\\mathrm{d}}$ 的额外串扰分支会产生 $$R_{\\mathrm{total}}(t)=R_{\\mathrm{direct}}(t)+R_{\\mathrm{cross}}(t),\\quad R_{\\mathrm{cross}}(t)=\\int_{-\\infty}^{t-\\delta_{\\mathrm{c}}} I(\\tau)\\,h_{\\mathrm{cross}}(t-\\tau-\\delta_{\\mathrm{c}})\\,d\\tau.$$\n- 对于一个一阶激活-失活模块，$$\\frac{dr}{dt}=k_{\\mathrm{on}}\\,I(t)-k_{\\mathrm{off}}\\,r(t)$$ 因此，在 $I(t)$ 发生阶跃变化后的早期斜率与 $k_{\\mathrm{on}}$ 成正比，并反映了在下游反馈累积之前直接耦合的强度。\n- 一种阻断通路中必需酶的特异性抑制剂，应该能够消除由该通路介导的相应报告子响应，而与输入强度无关；然而，对平行通路的抑制剂不应消除由未被抑制的分支介导的直接响应。\n\n下面的哪种实验设计和分析最能严格地区分Raf–MEK–ERK的直接光遗传学激活与下游串扰？\n\nA. 给予一个持续时间为 $2$ s 的单次蓝光脉冲，其强度选择为在不产生光毒性的前提下最低限度地招募CRY2，然后在 $20$ 分钟内以 $1$ s 的分辨率记录ERK KTR的核输出和PH(AKT1)的膜易位。量化相对于光照开始时ERK KTR核输出的初始斜率 $\\left.\\frac{d}{dt}\\right|_{t\\in[0,120]\\,\\mathrm{s}}$，并在存在trametinib或wortmannin的情况下重复实验。如果早期的ERK斜率被trametinib消除且不受wortmannin影响，而任何PH(AKT1)的变化仅在 $\\geq 300$ s 后才开始并被wortmannin消除，则得出结论认为ERK激活是直接的。将任一报告子在晚期（$>300$ s）发生的变化解释为串扰。\n\nB. 连续光照 $30$ 分钟，并在光照开始时同时加入trametinib或wortmannin（或不加），在 $4$ 小时后通过定量聚合酶链式反应测量ERK靶基因的表达。如果靶基因的表达在有wortmannin时持续存在，但在有trametinib时不存在，则仅使用 $4$ 小时的终点数据得出结论认为ERK激活是直接的。\n\nC. 给予高强度蓝光 $10$ 分钟以最大化信号。如果在此高光强度下MEK抑制不能完全抑制ERK KTR的核输出，则得出结论认为ERK激活是直接的；如果抑制是完全的，则得出结论认为串扰占主导地位。\n\nD. 用wortmannin预处理，然后给予一个短暂的蓝光脉冲。如果在光照开始后的 $10$ s 内未观察到ERK KTR的核输出，则得出结论认为ERK激活是由PI3K依赖的串扰介导的，而不是直接的Raf激活，因为在许多受体酪氨酸激酶通路中，PI3K位于ERK的上游。", "solution": "问题要求设计一个时间分辨实验，以严格区分Raf-MEK-ERK通路的直接光遗传学激活和潜在的串扰效应，实验需使用一套特定的分子工具并基于所提供的信号动力学第一性原理。\n\n首先，我将重述系统的核心组成部分。\n- **输入：** 蓝光，它将一个CRY2-Raf融合蛋白招募到质膜上。\n- **直接通路：** Raf的招募被设计为直接激活MAPK级联反应：Raf $\\rightarrow$ MEK $\\rightarrow$ ERK。\n- **报告子：**\n    1. ERK活性由ERK激酶易位报告子 (ERK KTR) 测量，该报告子在ERK被激活时会离开细胞核。\n    2. PI3K活性由PH(AKT1)生物传感器测量，该传感器在PIP3产生时会易位到细胞膜。\n- **抑制剂：**\n    1. Trametinib，一种MEK抑制剂，可阻断MEK $\\rightarrow$ ERK这一步骤。\n    2. Wortmannin，一种PI3K抑制剂，可阻断PI3K依赖的PIP3生成。\n\n目标是区分直接通路 (光 $\\rightarrow$ Raf $\\rightarrow$ MEK $\\rightarrow$ ERK) 与任何间接或“串扰”通路。例如，串扰通路可能是在初级ERK激活下游的一个较慢的、次级的PI3K通路激活 (例如，光 $\\rightarrow$ ERK $\\rightarrow \\dots \\rightarrow$ PI3K)，或者是ERK通路对PI3K活性的意外依赖 (例如，光 $\\rightarrow \\dots \\rightarrow$ PI3K $\\rightarrow \\dots \\rightarrow$ ERK)。\n\n为了设计最严谨的实验，我们必须遵守所提供的基本原理。\n\n1.  **因果关系与延迟：** 结果不能先于原因。直接通路的延迟 ($\\delta_{\\mathrm{d}}$) 会比间接或串扰通路的延迟 ($\\delta_{\\mathrm{c}} > \\delta_{\\mathrm{d}}$) 更短。这一原理要求进行高分辨率的时间测量，以捕获并比较不同信号事件的起始时间。\n2.  **初始动力学：** 刺激后激活的初始速率（$t \\approx 0$ 时的 $\\frac{dr}{dt}$）与直接耦合强度成正比，此时较慢的反馈和串扰机制尚未起作用。测量这个初始斜率是量化直接通路活性的有力方法。\n3.  **抑制剂特异性：** 特异性抑制剂应能消除流经其靶点的信号。Trametinib必须阻断直接的Raf $\\rightarrow$ MEK $\\rightarrow$ ERK通路。Wortmannin应阻断任何PI3K依赖的信号传导。通过观察每种抑制剂对每个报告子的影响，可以描绘出因果联系。\n\n结合这些原理，理想的实验设计将包括：\n- 一个急剧、明确的刺激（例如，短暂的光脉冲），以建立一个清晰的 $t=0$。\n- 对ERK KTR和PH(AKT1)生物传感器进行高分辨率、同步的活细胞成像，时间跨度足以捕获快速的初始激活和较慢的次级事件。\n- 在不同的实验中系统地使用特异性抑制剂（trametinib和wortmannin），并与无抑制剂的对照组进行比较。\n- 进行定量分析，重点关注响应的动力学，特别是每种条件下每个报告子激活的延迟和初始斜率。\n\n现在，我将根据这个理想设计来评估每个选项。\n\n**A. 给予一个持续时间为 $2$ s 的单次蓝光脉冲，其强度选择为在不产生光毒性的前提下最低限度地招募CRY2，然后在 $20$ 分钟内以 $1$ s 的分辨率记录ERK KTR的核输出和PH(AKT1)的膜易位。量化相对于光照开始时ERK KTR核输出的初始斜率 $\\left.\\frac{d}{dt}\\right|_{t\\in[0,120]\\,\\mathrm{s}}$，并在存在trametinib或wortmannin的情况下重复实验。如果早期的ERK斜率被trametinib消除且不受wortmannin影响，而任何PH(AKT1)的变化仅在 $\\geq 300$ s 后才开始并被wortmannin消除，则得出结论认为ERK激活是直接的。将任一报告子在晚期（$>300$ s）发生的变化解释为串扰。**\n\n这个实验设计非常出色。\n- 它使用一个短暂的脉冲 ($2$ s) 作为急剧的输入。\n- 它采用高分辨率记录 ($1$ s) 和适当的时间尺度 ($20$ min) 来捕获快速和慢速的动力学。\n- 它明确提出要量化ERK报告子的初始斜率，直接应用了第二个基本原理。\n- 它正确地使用两种抑制剂来测试通路依赖性。其逻辑是合理的：如果初始的ERK激活是直接的，那么它必须被下游抑制剂trametinib阻断，而不受平行通路抑制剂wortmannin的影响。\n- 它正确地使用延迟来识别串扰：与初始ERK响应（斜率来自 $0$-$120$ s）相比，延迟的PH(AKT1)响应（起始于 $\\geq 300$ s）将是次级、下游串扰事件的有力证据。\n此选项完全符合所有提供的原理，代表了一种严谨的方法。\n**结论：正确。**\n\n**B. 连续光照 $30$ 分钟，并在光照开始时同时加入trametinib或wortmannin（或不加），在 $4$ 小时后通过定量聚合酶链式反应测量ERK靶基因的表达。如果靶基因的表达在有wortmannin时持续存在，但在有trametinib时不存在，则仅使用 $4$ 小时的终点数据得出结论认为ERK激活是直接的。**\n\n这个设计存在根本性缺陷。\n- 刺激是一个长时间的连续光照 ($30$ min)，这将初始激活动力学与反馈、适应和稳态响应混为一谈。\n- 读出是在一个非常晚的单一时间点 ($4$ h) 的基因表达。这丢弃了所有动力学信息，而这些信息对于建立因果关系以及区分直接和间接效应至关重要，违反了第一条原理。到 $4$ 小时后，大量的次级效应网络已经发生，不可能对初始信号事件的直接性做出明确的判断。\n- 仅分析一个终点无法解析区分直接和串扰通路的动力学。\n**结论：不正确。**\n\n**C. 给予高强度蓝光 $10$ 分钟以最大化信号。如果在此高光强度下MEK抑制不能完全抑制ERK KTR的核输出，则得出结论认为ERK激活是直接的；如果抑制是完全的，则得出结论认为串扰占主导地位。**\n\n这个选项基于错误的推理。\n- 其主要逻辑前提是不正确的。直接通路被定义为Raf $\\rightarrow$ MEK $\\rightarrow$ ERK。MEK抑制剂trametinib在此级联反应中作用于Raf下游、ERK上游。因此，如果通路确实是按设计的那样直接，那么trametinib *必须* 完全阻断ERK的激活（假设抑制剂浓度足够）。不完全的抑制将表明存在一条不依赖于MEK的旁路通向ERK，这与“直接”Raf-MEK-ERK激活的前提相矛盾。\n- “如果抑制是完全的，则得出结论认为串扰占主导地位”这一结论也毫无意义。完全抑制是直接通路以及任何同样依赖MEK的串扰通路的预期结果。它不能提供任何信息来区分它们。\n- 使用“高强度”光是一种不好的做法，因为它可能诱导非特异性效应和光毒性，从而混淆解释。\n**结论：不正确。**\n\n**D. 用wortmannin预处理，然后给予一个短暂的蓝光脉冲。如果在光照开始后的 $10$ s 内未观察到ERK KTR的核输出，则得出结论认为ERK激活是由PI3K依赖的串扰介导的，而不是直接的Raf激活，因为在许多受体酪氨酸激酶通路中，PI3K位于ERK的上游。**\n\n这个设计不完整，并可能产生误导。\n- $10$ s 的时间窗口过于武断和短暂。虽然光遗传学二聚化速度很快，但整个磷酸化级联反应（Raf $\\rightarrow$ MEK $\\rightarrow$ ERK）以及随后大分子KTR报告子从细胞核的易位，其总延迟时间很容易超过 $10$ s。在此窗口内未观察到信号并不能作为通路不存在的决定性证据。\n- 实验不完整。它只提出了一个条件（wortmannin处理）。严谨的设计需要与无抑制剂的对照组（以建立基线动力学）和trametinib对照组（以确认信号是MEK依赖的）进行比较。如果没有无抑制剂的对照组，人们无法知道即使在没有抑制剂的情况下，信号是否会在 $10$ s 内出现。\n- 推理依赖于一个外部假设（“因为在许多...通路中PI3K位于ERK的上游”），而不是基于一个为测试特定系统而设计的、自洽的实验逻辑，这与问题陈述的要求不符。\n**结论：不正确。**\n\n总而言之，选项A是唯一一个提出了完整且逻辑上合理的实验设计，该设计正确应用了因果关系、动力学和抑制剂特异性原理，从而能够严谨地剖析信号通路。", "answer": "$$\\boxed{A}$$", "id": "2658937"}, {"introduction": "在能够精确控制并验证信号通路后，一个更高级的问题是如何评估我们控制的有效性。此练习引入了信息论的视角，将信号通路视为一个信息通道，通过建立动力学模型和计算互信息，来定量比较不同光刺激编码策略（如幅度、频率或脉宽调制）的信息传输效率。这种方法为优化光遗传学控制方案提供了严谨的理论依据。[@problem_id:2658978]", "problem": "您的任务是设计并实现一个程序，该程序客观地比较三种用于驱动细胞外信号调节激酶（Extracellular signal-Regulated Kinase, ERK）活性的光遗传学编码方案，并计算在指定的噪声模型下，哪种方案能够最大化离散输入（刺激身份）与ERK活性的连续读出之间的互信息。此比较必须基于动力学系统和信息论的基本原理，使用一个最小化的、具有机械论可解释性的模型，以及一个有原则的互信息估计器来执行。\n\n该系统模型如下。一个标量光输入波形 $L(t)$ 驱动一个单极点低通线性系统，该系统描述了有效的ERK激活动力学：\n$$\n\\frac{ds(t)}{dt} \\;=\\; -\\frac{1}{\\tau}\\,s(t) \\;+\\; \\frac{1}{\\tau}\\,L(t),\n\\quad s(0)=0,\n$$\n其中 $\\tau$ 是ERK通路的有效时间常数（单位为秒），$s(t)$ 是一个无量纲的活性代理指标，$L(t)$ 是任意单位下的光输入。一个下游的饱和非线性函数使用希尔函数将 $s(t)$ 映射到一个可观测的活性代理指标，\n$$\nh(u) \\;=\\; \\frac{u^{n}}{K_{h}^{n} + u^{n}},\n$$\n对于持续时间为 $T$ 秒的刺激周期，测得的确定性活性是其时间平均值\n$$\ny_{\\mathrm{det}} \\;=\\; \\frac{1}{T}\\int_{0}^{T} h\\!\\left(s(t)\\right)\\,dt.\n$$\n为在测量前接近周期性稳态，需在前面加上一个长度为 $T_{\\mathrm{w}}$ 秒的预热区间，该区间由相同的波形 $L(t)$ 驱动，并且时间平均仅在最后长度为 $T$ 的窗口上计算。\n\n测量和内在波动被建模为可观测值上的一个对数正态噪声。在给定 $y_{\\mathrm{det}}$ 的条件下，测得的读出值 $Y$ 服从一个对数正态分布，其对数方差依赖于 $y_{\\mathrm{det}}$：\n$$\n\\sigma^{2}\\!\\left(y_{\\mathrm{det}}\\right) \\;=\\; a \\;+\\; \\frac{b}{\\max\\{y_{\\mathrm{det}},\\varepsilon\\}},\n$$\n其中有一个小的数值下限 $\\varepsilon>0$ 以避免除以零，并且对数均值的选择使得 $\\mathbb{E}[Y\\mid y_{\\mathrm{det}}]=y_{\\mathrm{det}}$。具体来说，\n$$\n\\log Y \\;\\Big|\\; y_{\\mathrm{det}} \\sim \\mathcal{N}\\!\\left(\\mu_{L},\\,\\sigma^{2}\\right),\\quad\n\\mu_{L} \\;=\\; \\log(y_{\\mathrm{det}}) \\;-\\; \\frac{1}{2}\\,\\sigma^{2}.\n$$\n\n您必须比较三种编码方案，它们都以振幅为 $A$、频率为 $f$（单位赫兹）、占空比为 $d$（在区间 $\\left(0,1\\right)$ 内）的方波形式驱动 $L(t)$：\n- 振幅调制（Amplitude Modulation, AM）：振幅变化，频率和占空比固定。\n- 频率调制（Frequency Modulation, FM）：频率变化，振幅和占空比固定。\n- 脉冲宽度调制（Pulse-Width Modulation, PWM）：占空比变化，振幅和频率固定。\n\n对于周期为 $P=\\frac{1}{f}$ 的方波，输入为\n$$ L(t) = \\begin{cases} A,  \\text{if } t \\bmod P \\in [0, dP) \\\\ 0,  \\text{otherwise} \\end{cases} $$\n\n对于每种编码方案，定义一组 $K$ 个不同的符号（刺激）。假设这 $K$ 个符号服从均匀先验分布。对于每个符号，通过对 $s(t)$ 的常微分方程在预热和测量窗口上进行数值积分来计算相应的 $y_{\\mathrm{det}}$，然后根据上述噪声模型计算离散符号 $X$ 和连续测量值 $Y$ 之间的互信息 $I(X;Y)$。\n\n要估计 $I(X;Y)$，请使用以下基于原理的程序：\n- 设 $X$ 在 $\\{1,2,\\dots,K\\}$ 上均匀分布。\n- 对于每个符号 $i\\in\\{1,\\dots,K\\}$，计算 $y_{\\mathrm{det},i}$。\n- 对于每个 $i$，计算 $\\sigma_{i}=\\sqrt{a + b/\\max\\{y_{\\mathrm{det},i},\\varepsilon\\}}$ 和 $\\mu_{L,i}=\\log(y_{\\mathrm{det},i})-\\frac{1}{2}\\sigma_{i}^{2}$。\n- 通过从 $\\mathcal{N}\\!\\left(\\mu_{L,i},\\sigma_{i}^{2}\\right)$ 中采样 $Z$ 并令 $Y=\\exp(Z)$，为每个 $Y\\mid X=i$ 抽取 $N$ 个独立样本。\n- 将样本汇集起来，形成一个大小为 $N_{\\mathrm{tot}}=KN$ 的样本池，该样本池来自均匀先验于 $X$ 所诱导的混合分布。\n- 使用一维的 Kozachenko–Leonenko $k$-近邻估计器（使用无穷范数）非参数地估计汇集样本的微分熵 $h(Y)$。在一维中，该估计器为\n$$\n\\widehat{h}(Y) \\;=\\; \\psi\\!\\left(N_{\\mathrm{tot}}\\right) \\;-\\; \\psi(k) \\;+\\; \\log(2) \\;+\\; \\frac{1}{N_{\\mathrm{tot}}}\\sum_{j=1}^{N_{\\mathrm{tot}}} \\log \\varepsilon_{j},\n$$\n其中 $\\psi(\\cdot)$ 是双伽玛函数（digamma function），$\\varepsilon_{j}$ 是样本 $j$ 到其第 $k$ 个近邻的距离（在绝对值度量下）。在一维中，可以从排序后的样本中计算 $\\varepsilon_{j}$，其值为到左侧第 $k$ 个邻居和右侧第 $k$ 个邻居的距离的最大值（带有自然的边界处理）。\n- 通过对 $i\\in\\{1,\\dots,K\\}$ 上的对数正态熵进行平均，解析地计算条件微分熵 $h(Y\\mid X)$：\n$$\nh\\!\\left(Y\\mid X=i\\right) \\;=\\; \\mu_{L,i} \\;+\\; \\frac{1}{2} \\;+\\; \\frac{1}{2}\\log\\!\\left(2\\pi \\sigma_{i}^{2}\\right).\n$$\n- 将互信息估计为\n$$\n\\widehat{I}(X;Y) \\;=\\; \\widehat{h}(Y) \\;-\\; \\frac{1}{K}\\sum_{i=1}^{K} h\\!\\left(Y\\mid X=i\\right).\n$$\n\n对于下面指定的每个测试用例，确定哪种编码方案产生的互信息估计值最大。将每个测试用例的结果报告为编码方案身份的整数：AM 为 $0$，FM 为 $1$，PWM 为 $2$。\n\n物理单位：所有时间（$\\tau$, $T$, $T_{\\mathrm{w}}$）均以秒为单位，频率 $f$ 以赫兹为单位，占空比 $d$ 是无量纲的。最终答案以整数表示；最终输出无需物理单位。本问题不涉及角度。在程序中计算任何数值量时，请一致使用秒作为时间单位，并假设 $1\\,\\mathrm{Hz} = 1/\\mathrm{s}$。\n\n测试套件和所需参数：\n- 每种编码方案使用 $K=4$ 个符号，对 $X$ 使用均匀先验，预热时长 $T_{\\mathrm{w}}$ 按指定值，测量窗口时长 $T$ 按指定值，数值积分步长 $\\Delta t = 0.2$ 秒，数值下限 $\\varepsilon = 10^{-6}$。\n- 在所有情况下，三种方案使用以下符号集：\n  - AM 方案：频率固定为 $f_{0}$，占空比固定为 $d_{0}$，振幅值 $A\\in\\left\\{0.25\\,A_{\\max},\\,0.50\\,A_{\\max},\\,0.75\\,A_{\\max},\\,1.00\\,A_{\\max}\\right\\}$。\n  - FM 方案：振幅固定为 $A=A_{\\max}$，占空比固定为 $d_{0}$，频率值 $f\\in\\left\\{0.005,\\,0.010,\\,0.020,\\,0.040\\right\\}$ 赫兹。\n  - PWM 方案：振幅固定为 $A=A_{\\max}$，频率固定为 $f_{0}$，占空比值 $d\\in\\left\\{0.20,\\,0.40,\\,0.60,\\,0.80\\right\\}$。\n- 在所有情况下，每个符号使用 $N=3000$ 个样本，$k$-近邻熵估计器使用 $k=5$。\n\n实现并评估以下三个测试用例：\n1. 用例 A:\n   - $\\tau = 120$, $T=1200$, $T_{\\mathrm{w}}=600$, $A_{\\max}=1.0$, $f_{0}=0.010$, $d_{0}=0.50$, $K_{h}=0.50$, $n=2.0$, $a=0.040$, $b=0.020$。\n2. 用例 B:\n   - $\\tau = 300$, $T=1200$, $T_{\\mathrm{w}}=600$, $A_{\\max}=1.0$, $f_{0}=0.010$, $d_{0}=0.50$, $K_{h}=0.50$, $n=2.5$, $a=0.160$, $b=0.080$。\n3. 用例 C:\n   - $\\tau = 120$, $T=300$, $T_{\\mathrm{w}}=300$, $A_{\\max}=1.0$, $f_{0}=0.020$, $d_{0}=0.50$, $K_{h}=0.40$, $n=3.0$, $a=0.060$, $b=0.030$。\n\n您的程序必须：\n- 实现 $s(t)$ 的动力学系统积分，并为每种方案中的每个符号计算 $y_{\\mathrm{det}}$。\n- 实现从以 $y_{\\mathrm{det}}$ 为条件的对数正态噪声模型中采样 $Y$。\n- 实现用于 $h(Y)$ 的一维 Kozachenko-Leonenko 估计器，其中 $k=5$。\n- 在每个测试用例中，为 AM、FM 和 PWM 计算 $\\widehat{I}(X;Y)$。\n- 对于每个用例，返回对应于估计互信息最高的方案的整数（在 $\\{0,1,2\\}$ 中）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为逗号分隔的 Python 风格整数列表，顺序为 $\\left[\\text{用例 A},\\text{用例 B},\\text{用例 C}\\right]$，例如 $\\left[1,0,2\\right]$。\n- 输出中不允许有任何额外的文本或格式。", "solution": "问题陈述已经过评估，并被确定为有效。它具有科学依据，问题设定良好、客观，并包含得出唯一解所需的所有信息。该模型虽然经过简化，却是系统生物学中的标准表示方法，而信息论分析是量化信道容量的一种有原则的方法。计算过程定义明确。因此，我们可以着手求解。\n\n目标是通过量化三种光遗传学编码方案——振幅调制（AM）、频率调制（FM）和脉冲宽度调制（PWM）——在通过一个简化的细胞信号通路传输信息时的有效性，来对它们进行比较。有效性的度量是离散输入刺激集合 $X$ 与连续、带噪声的可观测值 $Y$ 之间的互信息 $I(X;Y)$。在指定条件下，最大化 $I(X;Y)$ 的方案被认为是最佳的。该解决方案需要整合动力学系统、信号处理和信息论的概念。\n\n对于每种编码方案，计算过程分为三个主要阶段：\n1.  对通路动力学进行数值模拟，以确定 $K=4$ 个输入符号中每一个的确定性输出 $y_{\\mathrm{det}}$。\n2.  结合解析公式和从模拟数据中进行的数值估计，计算互信息 $\\widehat{I}(X;Y)$。\n3.  比较三种方案得到的互信息值，为每个测试用例确定最优方案。\n\n**1. 动力学系统模拟和确定性输出计算**\n\n系统的核心是控制ERK活性代理指标 $s(t)$ 的线性常微分方程（ODE）：\n$$\n\\frac{ds(t)}{dt} = -\\frac{1}{\\tau} s(t) + \\frac{1}{\\tau} L(t), \\quad s(0) = 0\n$$\n其中 $L(t)$ 是随时间变化的光输入。给定指定的积分时间步长 $\\Delta t$，该ODE使用前向欧拉法进行数值求解。在离散时间步 $t_i = i\\Delta t$ 处 $s(t)$ 的更新规则是：\n$$\ns(t_{i+1}) = s(t_i) + \\Delta t \\left( -\\frac{1}{\\tau} s(t_i) + \\frac{1}{\\tau} L(t_i) \\right) = s(t_i) \\left( 1 - \\frac{\\Delta t}{\\tau} \\right) + \\frac{\\Delta t}{\\tau} L(t_i).\n$$\n光输入 $L(t)$ 是一个周期性方波，具有振幅 $A$、频率 $f$ 和占空比 $d$。周期为 $P=1/f$。在任何时间 $t$，$L(t)$ 的值由下式给出：\n$$\nL(t) = \\begin{cases} A,  \\text{if } t \\bmod P  dP \\\\ 0,  \\text{otherwise} \\end{cases}\n$$\n模拟的总时长为 $T_{\\mathrm{w}} + T$，以使系统在测量窗口开始前能接近周期性稳态。\n\n确定性可观测值 $y_{\\mathrm{det}}$ 是非线性变换后的状态 $h(s(t))$ 在测量窗口 $[T_{\\mathrm{w}}, T_{\\mathrm{w}}+T]$ 上的时间平均。非线性是一个希尔函数：\n$$\nh(u) = \\frac{u^n}{K_h^n + u^n}.\n$$\n$y_{\\mathrm{det}}$ 的积分通过对落在测量窗口内的时间步进行离散求和来近似：\n$$\ny_{\\mathrm{det}} = \\frac{1}{T} \\int_{T_{\\mathrm{w}}}^{T_{\\mathrm{w}}+T} h(s(t)) \\, dt \\approx \\frac{\\Delta t}{T} \\sum_{i=N_w}^{N_{tot}-1} h(s(t_i)),\n$$\n其中 $N_w = \\lfloor T_{\\mathrm{w}} / \\Delta t \\rfloor$ 是预热期内的步数，$N_{tot} = \\lfloor (T_{\\mathrm{w}}+T) / \\Delta t \\rfloor$ 是模拟的总步数。\n\n**2. 互信息计算**\n\n离散符号集 $X = \\{x_1, \\dots, x_K\\}$ 与连续输出 $Y$ 之间的互信息由公式 $I(X;Y) = h(Y) - h(Y|X)$ 给出。\n\n条件微分熵 $h(Y|X)$ 是通过对条件分布 $p(y|x_i)$ 的熵求平均来计算的：\n$$\nh(Y|X) = \\sum_{i=1}^{K} P(x_i) h(Y|X=i).\n$$\n给定均匀先验，$P(x_i) = 1/K$。对于给定的确定性输出 $y_{\\mathrm{det},i}$，读出值 $Y$ 服从对数正态分布，即 $\\log Y | y_{\\mathrm{det},i} \\sim \\mathcal{N}(\\mu_{L,i}, \\sigma_i^2)$。对数正态分布的熵有解析解：\n$$\nh(Y|X=i) = \\mu_{L,i} + \\frac{1}{2} + \\frac{1}{2}\\log(2\\pi \\sigma_i^2).\n$$\n参数 $\\mu_{L,i}$ 和 $\\sigma_i^2$ 是 $y_{\\mathrm{det},i}$ 的函数：\n$$\n\\sigma_i^2 = a + \\frac{b}{\\max\\{y_{\\mathrm{det},i}, \\varepsilon\\}}\n$$\n$$\n\\mu_{L,i} = \\log(y_{\\mathrm{det},i}) - \\frac{1}{2}\\sigma_i^2.\n$$\n代入这些即可得到条件熵的完整表达式。\n\n边际微分熵 $h(Y)$ 是非参数估计的。首先，生成一个代表边际分布 $p(y) = \\frac{1}{K}\\sum_{i=1}^K p(y|x_i)$ 的大型数据集。这是通过为每个符号 $x_i$ 抽取 $N$ 个 $Y$ 的样本并将它们汇集起来实现的，总共得到 $N_{\\mathrm{tot}} = KN$ 个样本。然后，将 Kozachenko-Leonenko $k$-近邻估计器应用于这个汇集的一维数据集。该估计器为：\n$$\n\\widehat{h}(Y) = \\psi(N_{\\mathrm{tot}}) - \\psi(k) + \\log(2) + \\frac{1}{N_{\\mathrm{tot}}} \\sum_{j=1}^{N_{\\mathrm{tot}}} \\log \\varepsilon_j,\n$$\n其中 $\\psi(\\cdot)$ 是来自 `scipy.special` 的双伽玛函数，$k=5$ 是邻居数，$\\varepsilon_j$ 是样本 $y_j$ 到其第 $k$ 个近邻的距离。为了为排序后的汇集数据集 $y'$ 中的每个样本计算 $\\varepsilon_j$，我们遵循规定的特定程序：\n- 对于前 $k$ 个样本（$j  k$），第 $k$ 个邻居在右侧：$\\varepsilon_j = |y'_{j+k} - y'_j|$。\n- 对于后 $k$ 个样本（$j \\ge N_{\\mathrm{tot}}-k$），第 $k$ 个邻居在左侧：$\\varepsilon_j = |y'_j - y'_{j-k}|$。\n- 对于所有其他样本，距离是到左侧第 $k$ 个邻居和右侧第 $k$ 个邻居的距离的最大值：$\\varepsilon_j = \\max(|y'_j - y'_{j-k}|, |y'_{j+k} - y'_j|)$。\n\n最后，互信息被估计为 $\\widehat{I}(X;Y) = \\widehat{h}(Y) - h(Y|X)$。\n\n**3. 方案比较**\n\n对三种编码方案（AM、FM、PWM）中的每一种，使用它们各自的符号集，为三个测试用例中的每一个重复这整个过程。对于给定的测试用例，产生最大 $\\widehat{I}(X;Y)$ 值的方案被确定为最优选择。结果以整数形式报告：AM 为 $0$，FM 为 $1$，PWM 为 $2$。", "answer": "```python\nimport numpy as np\nfrom scipy.special import digamma\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It computes the mutual information for AM, FM, and PWM schemes and determines the best one.\n    \"\"\"\n\n    # Global parameters from the problem statement\n    K = 4\n    DT = 0.2\n    EPSILON = 1e-6\n    N_SAMPLES_PER_SYMBOL = 3000\n    K_NN = 5\n    np.random.seed(0) # for reproducibility\n\n    # Test cases\n    test_cases = [\n        # Case A\n        {'tau': 120.0, 'T': 1200.0, 'T_w': 600.0, 'A_max': 1.0, 'f0': 0.010,\n         'd0': 0.50, 'Kh': 0.50, 'n': 2.0, 'a': 0.040, 'b': 0.020},\n        # Case B\n        {'tau': 300.0, 'T': 1200.0, 'T_w': 600.0, 'A_max': 1.0, 'f0': 0.010,\n         'd0': 0.50, 'Kh': 0.50, 'n': 2.5, 'a': 0.160, 'b': 0.080},\n        # Case C\n        {'tau': 120.0, 'T': 300.0, 'T_w': 300.0, 'A_max': 1.0, 'f0': 0.020,\n         'd0': 0.50, 'Kh': 0.40, 'n': 3.0, 'a': 0.060, 'b': 0.030},\n    ]\n\n    # Symbol sets for the three schemes\n    am_symbols = {'A': np.array([0.25, 0.50, 0.75, 1.00])}\n    fm_symbols = {'f': np.array([0.005, 0.010, 0.020, 0.040])}\n    pwm_symbols = {'d': np.array([0.20, 0.40, 0.60, 0.80])}\n\n    final_results = []\n    \n    for case_params in test_cases:\n        \n        # Define scheme parameters for the current test case\n        schemes = [\n            {'name': 'AM', 'A': am_symbols['A'] * case_params['A_max'], 'f': np.full(K, case_params['f0']), 'd': np.full(K, case_params['d0'])},\n            {'name': 'FM', 'A': np.full(K, case_params['A_max']), 'f': fm_symbols['f'], 'd': np.full(K, case_params['d0'])},\n            {'name': 'PWM', 'A': np.full(K, case_params['A_max']), 'f': np.full(K, case_params['f0']), 'd': pwm_symbols['d']},\n        ]\n        \n        mi_values = []\n        for scheme in schemes:\n            mi = calculate_mutual_information(scheme, case_params, K, DT, EPSILON, N_SAMPLES_PER_SYMBOL, K_NN)\n            mi_values.append(mi)\n        \n        winner_index = np.argmax(mi_values)\n        final_results.append(winner_index)\n\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\ndef compute_y_det(A, f, d, tau, Kh, n, T, T_w, dt):\n    \"\"\"\n    Numerically simulates the dynamical system for a given symbol and computes y_det.\n    \"\"\"\n    total_time = T_w + T\n    t = np.arange(0, total_time, dt)\n    s = np.zeros_like(t)\n    \n    # Input waveform L(t)\n    if f > 0:\n        P = 1.0 / f\n        L = np.where((t % P)  (d * P), A, 0)\n    else: # Handles case of f=0 if it were to occur\n        L = np.full_like(t, A if d > 0 else 0)\n\n    # Euler integration\n    for i in range(len(t) - 1):\n        ds_dt = (-s[i] + L[i]) / tau\n        s[i+1] = s[i] + ds_dt * dt\n\n    # Hill function\n    h_s = (s**n) / (Kh**n + s**n)\n    \n    # Time-average over measurement window\n    warmup_idx = int(T_w / dt)\n    measurement_h_s = h_s[warmup_idx:]\n    y_det = np.sum(measurement_h_s) * dt / T\n    \n    return y_det\n\n\ndef calculate_mutual_information(scheme, params, K, dt, epsilon, N, k):\n    \"\"\"\n    Calculates the mutual information for a given encoding scheme.\n    \"\"\"\n    y_dets = np.zeros(K)\n    for i in range(K):\n        y_dets[i] = compute_y_det(\n            A=scheme['A'][i], f=scheme['f'][i], d=scheme['d'][i],\n            tau=params['tau'], Kh=params['Kh'], n=params['n'],\n            T=params['T'], T_w=params['T_w'], dt=dt\n        )\n\n    # Calculate noise parameters and conditional entropy\n    y_dets_floored = np.maximum(y_dets, epsilon)\n    sigma2 = params['a'] + params['b'] / y_dets_floored\n    mu_L = np.log(y_dets_floored) - 0.5 * sigma2\n    \n    h_Y_given_X_i = mu_L + 0.5 + 0.5 * np.log(2 * np.pi * sigma2)\n    h_Y_given_X = np.mean(h_Y_given_X_i)\n\n    # Generate pooled samples for marginal entropy estimation\n    N_tot = K * N\n    pooled_samples = np.zeros(N_tot)\n    \n    for i in range(K):\n        log_Y_samples = np.random.normal(loc=mu_L[i], scale=np.sqrt(sigma2[i]), size=N)\n        pooled_samples[i*N:(i+1)*N] = np.exp(log_Y_samples)\n\n    # Estimate marginal entropy h(Y) using k-NN estimator\n    pooled_samples.sort()\n    \n    log_epsilons = np.zeros(N_tot)\n    \n    # Boundary conditions\n    for j in range(k):\n        log_epsilons[j] = np.log(pooled_samples[j+k] - pooled_samples[j])\n        log_epsilons[N_tot-1-j] = np.log(pooled_samples[N_tot-1-j] - pooled_samples[N_tot-1-j-k])\n\n    # Core part\n    for j in range(k, N_tot - k):\n        dist_left = pooled_samples[j] - pooled_samples[j-k]\n        dist_right = pooled_samples[j+k] - pooled_samples[j]\n        # Per problem instructions, take the max of distances to k-th left and right neighbors\n        log_epsilons[j] = np.log(max(dist_left, dist_right))\n        \n    h_Y_hat = digamma(N_tot) - digamma(k) + np.log(2) + np.mean(log_epsilons)\n    \n    # Mutual information\n    I_XY = h_Y_hat - h_Y_given_X\n    return I_XY\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "2658978"}]}