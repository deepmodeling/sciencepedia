{"hands_on_practices": [{"introduction": "类器官，与所有缺乏血管的组织一样，其营养供应依赖于简单的扩散。本练习将引导您为球形类器官内的氧气传输建模，从而探索这一根本性的物理限制。通过从第一性原理出发推导最大存活半径，您将对大型类器官核心为何常出现坏死获得定量的理解，并体会到扩大这些模型规模所面临的工程挑战。[@problem_id:2622583]", "problem": "一个在充分混合的生物反应器中维持的脑类器官近似为球形，半径为 $R$。氧气从培养基供应至类器官表面，在该处，溶解氧浓度通过快速的外部输运维持在 $c_{0}$。在类器官内部没有对流，氧气以分子扩散系数 $D$ 穿过均匀的细胞基质进行扩散，该基质以均匀的零级体积速率 $q$ （摩尔/单位体积/单位时间）消耗氧气，这反映了在操作浓度下饱和的细胞内动力学。假设为准稳态。\n\n仅从菲克第一扩散定律 $J=-D \\nabla c$ 和稳态下的质量守恒出发，推导当中心刚好达到缺氧状态（即 $c(0)=0$ 而 $c(R_{\\max})=c_{0}$）时的最大半径 $R_{\\max}$ 的闭合形式表达式。您可以假设球面对称性以及由对称性所暗示的中心处的正则性条件。将 $R_{\\max}$ 的最终答案用 $D$、$q$ 和 $c_{0}$ 表示成一个单一的解析表达式。不要引入任何额外的经验公式或拟合参数。", "solution": "该问题要求推导球形类器官在中心刚好达到缺氧状态时的最大半径 $R_{\\max}$，其中给定恒定的表面氧浓度 $c_0$、均匀的零级消耗速率 $q$ 和恒定的氧扩散系数 $D$。推导必须从菲克第一定律和稳态下的质量守恒原理开始。\n\n我们从控制体积内浓度为 $c$ 的物种的通用微分质量平衡方程开始：\n$$\n\\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J} + S\n$$\n此处，$\\frac{\\partial c}{\\partial t}$ 是物种的累积速率，$\\mathbf{J}$ 是摩尔通量矢量，$S$ 是每单位体积的净生成速率。\n\n问题规定了几个条件：\n1.  **准稳态：** 系统不随时间变化，因此累积项为零：$\\frac{\\partial c}{\\partial t} = 0$。\n2.  **菲克第一定律：** 通量 $\\mathbf{J}$ 是由扩散引起的，由 $\\mathbf{J} = -D \\nabla c$ 给出，其中 $D$ 是分子扩散系数，假设为常数。\n3.  **零级消耗：** 氧气以均匀速率 $q$ 被消耗。这对应于一个消耗项 $S = -q$。\n\n将这些条件代入质量平衡方程，得到：\n$$\n0 = -\\nabla \\cdot (-D \\nabla c) - q\n$$\n假设扩散系数 $D$ 是一个常数，我们可以将其移到散度算子之外：\n$$\n0 = D (\\nabla \\cdot \\nabla c) - q\n$$\n这简化为反应-扩散的泊松方程：\n$$\nD \\nabla^2 c = q\n$$\n\n问题指出类器官是球形的，我们可以假设球面对称。因此，浓度 $c$ 仅是径向坐标 $r$ 的函数，即 $c = c(r)$。在球坐标系中，拉普拉斯算子 $\\nabla^2$ 作用于一个仅是 $r$ 的函数时，其形式为：\n$$\n\\nabla^2 c = \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right)\n$$\n将此代入我们的控制方程，得到浓度分布的常微分方程（ODE）：\n$$\n\\frac{D}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) = q\n$$\n\n为了求解这个关于 $c(r)$ 的常微分方程，我们对 $r$ 进行积分。首先，我们整理方程：\n$$\n\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) = \\frac{q}{D} r^2\n$$\n对 $r$ 积分一次得到：\n$$\nr^2 \\frac{dc}{dr} = \\int \\frac{q}{D} r^2 \\, dr = \\frac{q}{3D} r^3 + C_1\n$$\n其中 $C_1$ 是第一个积分常数。为了求出 $C_1$，我们应用球心 $r=0$ 处的边界条件。由于球面对称性，浓度分布在中心处必须是平滑的，这意味着浓度梯度必须为零。非零的梯度将意味着在原点存在一个物理上不可能的源或汇。这就是正则性条件。\n$$\n\\left. \\frac{dc}{dr} \\right|_{r=0} = 0\n$$\n为了应用这个条件，我们首先求解梯度 $\\frac{dc}{dr}$：\n$$\n\\frac{dc}{dr} = \\frac{q}{3D} r + \\frac{C_1}{r^2}\n$$\n在 $r=0$ 处，除非 $C_1=0$，否则项 $\\frac{C_1}{r^2}$ 是奇异的。因此，我们必须有 $C_1=0$。\n梯度表达式简化为：\n$$\n\\frac{dc}{dr} = \\frac{q}{3D} r\n$$\n现在，我们进行第二次积分以求得浓度分布 $c(r)$：\n$$\nc(r) = \\int \\frac{q}{3D} r \\, dr = \\frac{q}{6D} r^2 + C_2\n$$\n其中 $C_2$ 是第二个积分常数。\n\n我们现在使用临界半径 $R_{\\max}$ 的特定条件。该半径定义为中心刚好变得缺氧时的大小。这为我们的特定情况提供了两个边界条件：\n1.  在中心 $r=0$ 处，浓度为零：$c(0) = 0$。\n2.  在表面 $r=R_{\\max}$ 处，浓度维持在 $c_0$：$c(R_{\\max}) = c_0$。\n\n使用第一个条件 $c(0)=0$：\n$$\nc(0) = \\frac{q}{6D} (0)^2 + C_2 = 0 \\implies C_2 = 0\n$$\n因此，对于具有缺氧核心的类器官，其浓度分布为：\n$$\nc(r) = \\frac{q}{6D} r^2\n$$\n现在，我们在表面 $r=R_{\\max}$ 处应用第二个条件：\n$$\nc(R_{\\max}) = c_0\n$$\n将 $r=R_{\\max}$ 代入浓度分布表达式中，得到：\n$$\nc_0 = \\frac{q}{6D} R_{\\max}^2\n$$\n最后，我们通过整理方程来求解最大半径 $R_{\\max}$：\n$$\nR_{\\max}^2 = \\frac{6 D c_0}{q}\n$$\n取平方根，并注意到半径必须为正，我们得到最终的表达式：\n$$\nR_{\\max} = \\sqrt{\\frac{6 D c_0}{q}}\n$$\n该表达式表示在指定的模型条件下，球形组织在其中心出现完全缺氧（anoxia）区域之前所能拥有的最大半径。", "answer": "$$\\boxed{\\sqrt{\\frac{6 D c_{0}}{q}}}$$", "id": "2622583"}, {"introduction": "除了物理限制，类器官的奇妙之处在于它们能自我组织成包含多种细胞类型的复杂组织。本练习使用一个房室模型来模拟肠道类器官内的细胞动态，平衡干细胞更新、祖细胞扩增和终末分化。通过计算不同细胞类型的稳态数量，您将学会如何利用定量建模来揭示组织稳态的原理，并预测系统对细胞行为变化的响应。[@problem_id:2622421]", "problem": "一个肠道类器官可以被理想化为沿隐窝-绒毛轴的三个串联区室：位于隐窝底部的自我更新干细胞池、一个增殖性的瞬时扩增(TA)祖细胞池，以及终末分化的绒毛肠上皮细胞。假设存在以下基于细胞数量守恒和命运转变一级动力学的机制性特征：\n\n- 干细胞区室的大小通过微环境反馈维持在一个恒定值 $S_{0}$（单位：细胞）。每个干细胞以单位细胞转变速率 $k_{ST}$（单位：$\\mathrm{day}^{-1}$）投入祖细胞状态，从而产生流入TA池的通量。您可以将 $S_{0}$ 视为由微环境从外部固定的，而不由以下的动力学过程决定。\n- 每个TA细胞以净单位细胞分裂速率 $\\lambda_{T}$（单位：$\\mathrm{day}^{-1}$）增殖，以单位细胞速率 $k_{TV}$（单位：$\\mathrm{day}^{-1}$）分化为绒毛细胞，并以单位细胞速率 $\\delta_{T}$（单位：$\\mathrm{day}^{-1}$）丢失（死亡）。所有过程都是独立且无记忆的。\n- 每个绒毛细胞以单位细胞速率 $\\delta_{V}$（单位：$\\mathrm{day}^{-1}$）丢失（脱落/凋亡）。绒毛区室中没有细胞增殖。\n\n假设系统处于稳态（稳定状态），因此TA和绒毛区室中的期望细胞数不随时间变化，且从干细胞到TA的通量等于下游通量。仅使用稳态时每个区室的细胞数量守恒和上述定义，首先推导出稳态TA细胞数 $T^{\\ast}$ 和绒毛细胞数 $V^{\\ast}$ 的表达式，用 $S_{0}$ 和速率 $k_{ST}$、$\\lambda_{T}$、$k_{TV}$、$\\delta_{T}$ 及 $\\delta_{V}$ 表示。\n\n然后，对于参数值 $S_{0}=100$（细胞）、$k_{ST}=0.3\\,\\mathrm{day}^{-1}$、$\\lambda_{T}=0.8\\,\\mathrm{day}^{-1}$、$k_{TV}=1.0\\,\\mathrm{day}^{-1}$、$\\delta_{T}=0.2\\,\\mathrm{day}^{-1}$ 和 $\\delta_{V}=0.5\\,\\mathrm{day}^{-1}$，计算稳态时绒毛细胞在所有细胞中所占的比例，\n$$\nf_{V} \\equiv \\frac{V^{\\ast}}{S_{0}+T^{\\ast}+V^{\\ast}}.\n$$\n将您的最终答案表示为一个无单位小数，四舍五入到四位有效数字。", "solution": "该问题要求基于细胞数量守恒原理，推导瞬时扩增（TA）和绒毛（$V$）区室的稳态细胞数。在稳态条件下，该原理要求流入一个区室的总细胞通量必须等于从该区室流出的总通量。\n\n令 $T^{\\ast}$ 和 $V^{\\ast}$ 分别表示稳态时TA区室和绒毛区室的细胞数。干细胞的数量固定为 $S_{0}$。\n\n对于TA区室，我们平衡其通量：\n流入TA区室的总通量是来自干细胞池的细胞与TA池自身增殖产生的细胞之和。\n$$\n\\text{Flux in}_{T} = k_{ST} S_{0} + \\lambda_{T} T^{\\ast}\n$$\n从TA区室流出的总通量是因分化为绒毛细胞而丢失的细胞与因死亡而丢失的细胞之和。\n$$\n\\text{Flux out}_{T} = k_{TV} T^{\\ast} + \\delta_{T} T^{\\ast} = (k_{TV} + \\delta_{T}) T^{\\ast}\n$$\n在稳态时，$\\text{Flux in}_{T} = \\text{Flux out}_{T}$：\n$$\nk_{ST} S_{0} + \\lambda_{T} T^{\\ast} = (k_{TV} + \\delta_{T}) T^{\\ast}\n$$\n我们求解这个关于 $T^{\\ast}$ 的代数方程：\n$$\nk_{ST} S_{0} = (k_{TV} + \\delta_{T}) T^{\\ast} - \\lambda_{T} T^{\\ast}\n$$\n$$\nk_{ST} S_{0} = (k_{TV} + \\delta_{T} - \\lambda_{T}) T^{\\ast}\n$$\n因此，稳态TA细胞数为：\n$$\nT^{\\ast} = \\frac{k_{ST} S_{0}}{k_{TV} + \\delta_{T} - \\lambda_{T}}\n$$\n\n接下来，我们对绒毛区室进行同样的通量平衡分析。\n流入绒毛区室的通量完全来自TA细胞的分化。该区室中没有细胞增殖。\n$$\n\\text{Flux in}_{V} = k_{TV} T^{\\ast}\n$$\n从绒毛区室流出的通量是由于细胞脱落和凋亡。\n$$\n\\text{Flux out}_{V} = \\delta_{V} V^{\\ast}\n$$\n在稳态时，$\\text{Flux in}_{V} = \\text{Flux out}_{V}$：\n$$\nk_{TV} T^{\\ast} = \\delta_{V} V^{\\ast}\n$$\n求解 $V^{\\ast}$：\n$$\nV^{\\ast} = \\frac{k_{TV} T^{\\ast}}{\\delta_{V}}\n$$\n代入先前推导出的 $T^{\\ast}$ 表达式：\n$$\nV^{\\ast} = \\frac{k_{TV}}{\\delta_{V}} \\left( \\frac{k_{ST} S_{0}}{k_{TV} + \\delta_{T} - \\lambda_{T}} \\right)\n$$\n这些就是所要求的 $T^{\\ast}$ 和 $V^{\\ast}$ 的解析表达式。\n\n现在，我们代入给定的数值来计算具体的细胞数量：\n$S_{0}=100$，$k_{ST}=0.3$，$\\lambda_{T}=0.8$，$k_{TV}=1.0$，$\\delta_{T}=0.2$，和 $\\delta_{V}=0.5$。\n\n首先，我们计算 $T^{\\ast}$：\n$$\nT^{\\ast} = \\frac{(0.3)(100)}{1.0 + 0.2 - 0.8} = \\frac{30}{0.4} = 75\n$$\n所以，在稳态时有 $75$ 个TA细胞。\n\n接着，我们计算 $V^{\\ast}$：\n$$\nV^{\\ast} = \\frac{k_{TV} T^{\\ast}}{\\delta_{V}} = \\frac{1.0 \\times 75}{0.5} = 150\n$$\n所以，在稳态时有 $150$ 个绒毛细胞。\n\n最后一步是计算绒毛细胞在所有细胞中所占的比例 $f_{V}$：\n$$\nf_{V} = \\frac{V^{\\ast}}{S_{0} + T^{\\ast} + V^{\\ast}}\n$$\n该类器官模型中的细胞总数为：\n$$\nS_{0} + T^{\\ast} + V^{\\ast} = 100 + 75 + 150 = 325\n$$\n该比例为：\n$$\nf_{V} = \\frac{150}{325}\n$$\n为了将其表示为小数，我们进行除法运算：\n$$\nf_{V} = \\frac{150}{325} = \\frac{6 \\times 25}{13 \\times 25} = \\frac{6}{13} \\approx 0.46153846...\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nf_{V} \\approx 0.4615\n$$", "answer": "$$\n\\boxed{0.4615}\n$$", "id": "2622421"}, {"introduction": "对于任何类器官模型，一个关键问题是：“它在多大程度上忠实地模拟了真实发育？” 这项计算实践引入了动态时间规整（Dynamic Time Warping, DTW），一种用于比较时间序列数据的强大算法，旨在定量地将类器官的基因表达轨迹与相应的 *in vivo* 轨迹对齐。通过实施该分析，您将掌握一项评估模型保真度和理解异时性（即 *in vitro* 系统中发育时间发生变化的现象）的实用技能。[@problem_id:2622535]", "problem": "您的任务是使用动态时间规整 (Dynamic Time Warping, DTW) 构建一个完整的时间对齐分析，将类器官基因表达轨迹映射到在体 (in vivo) 发育时间线上。目标是，在单调、连续的时间规整约束下，为每个类器官采样时间点计算出能最佳对齐多维基因表达谱的相应在体 (in vivo) 发育时间。\n\n使用的科学基础：\n- 分子生物学的中心法则指出，DNA转录为RNA，RNA翻译为蛋白质；随时间变化的信使RNA丰度谱为器官发生过程中的时间基因调控状态提供了一个经过充分检验的代理指标。\n- 在发育生物学中，异时性 (heterochrony) 是常见的：类器官系统常常会重现在体 (in vivo) 的基因表达程序，但伴有相位偏移或扩张。DTW是一种成熟的方法，通过在单调路径约束下最小化累积距离，来对齐两个可能异相或采样密度不同的序列。\n\n需要实现的数学公式：\n- 设在体 (in vivo) 轨迹为时间点序列 $\\{t_j^{\\mathrm{in}}\\}_{j=0}^{m-1}$ (单位：天)，其对应的基因表达向量为 $\\{\\mathbf{x}_j^{\\mathrm{in}}\\in\\mathbb{R}^G\\}_{j=0}^{m-1}$ (涉及 $G$ 个基因)；类器官轨迹为 $\\{t_i^{\\mathrm{org}}\\}_{i=0}^{n-1}$，其对应的基因表达向量为 $\\{\\mathbf{x}_i^{\\mathrm{org}}\\in\\mathbb{R}^G\\}_{i=0}^{n-1}$。定义点对点成本为欧几里得距离 $d(i,j)=\\lVert \\mathbf{x}_i^{\\mathrm{org}}-\\mathbf{x}_j^{\\mathrm{in}}\\rVert_2$。\n- 使用动态规划计算DTW累积成本矩阵 $D\\in\\mathbb{R}^{n\\times m}$，允许的步长为 $\\{(1,0),(0,1),(1,1)\\}$，强制从 $(0,0)$ 到 $(n-1,m-1)$ 的单调性和连续性。初始化 $D_{0,0}=d(0,0)$，并相应地在首行和首列上使用有效的前驱节点。在每个 $(i,j)$ 处，递推关系将 $d(i,j)$ 加到最小的可接受前驱节点的成本上。当多个前驱节点的成本相同时，按 $(1,1)$ 优先于 $(0,1)$，$(0,1)$ 优先于 $(1,0)$ 的顺序打破平局。\n- 从 $(n-1,m-1)$ 回溯至 $(0,0)$，以提取最优规整路径 $\\mathcal{P}=\\{(i_k,j_k)\\}_{k=0}^{K-1}$，其中 $i_{k+1}-i_k\\in\\{0,1\\}$, $j_{k+1}-j_k\\in\\{0,1\\}$ 且 $(i_{k+1}-i_k)+(j_{k+1}-j_k)\\in\\{1,2\\}$。\n- 通过对最优路径上与每个类器官索引配对的在体 (in vivo) 时间进行平均，定义类器官到在体 (in vivo) 的时间映射 $f:\\{0,\\dots,n-1\\}\\to\\mathbb{R}$：对于每个类器官索引 $i$，令 $J(i)=\\{j\\mid (i,j)\\in\\mathcal{P}\\}$，并设置 $f(i)=\\frac{1}{|J(i)|}\\sum_{j\\in J(i)} t_j^{\\mathrm{in}}$。将 $f(i)$ 以天为单位表示，并四舍五入到三位小数。\n\n您的程序必须：\n- 以数值稳健的方式实现上述DTW算法。\n- 将其应用于下方的测试套件。\n- 对于每个测试用例，输出列表 $[f(0),f(1),\\dots,f(n-1)]$（单位为天），每个值四舍五入到三位小数。\n- 将三个测试用例的结果聚合为单行列表的列表：例如，如果有三个测试用例的结果分别为 $\\mathrm{R}_1$、$\\mathrm{R}_2$、$\\mathrm{R}_3$，则输出必须是 $[\\mathrm{R}_1,\\mathrm{R}_2,\\mathrm{R}_3]$ 形式的单行，其中每个 $\\mathrm{R}_k$ 是一个用方括号括起来、用逗号分隔的小数列表。\n\n距离度量：\n- 在基因表达空间 $\\mathbb{R}^G$ 中使用欧几里得范数。\n\n平局打破规则：\n- 当前驱节点的累积成本在浮点容差范围内完全相等时，优先选择对角步骤 $(1,1)$，其次是垂直步骤 $(0,1)$，最后是水平步骤 $(1,0)$。\n\n角度单位：\n- 不适用。\n\n物理单位：\n- 所有时间必须以天为单位表示。将每个映射的时间报告为以天为单位的实数，并四舍五入到三位小数。\n\n测试套件 (所有数组均为显式给出，必须严格按原样使用)：\n\n测试用例 1 (脑类器官到在体 (in vivo) 皮层样轨迹；$G=3$ 个基因；在体 (in vivo) 时间点 6 个；类器官时间点 6 个)：\n- 在体 (in vivo) 时间 (天)：$[0.0,10.0,20.0,30.0,40.0,50.0]$\n- 类器官时间 (天)：$[0.0,3.0,8.0,15.0,28.0,40.0]$\n- 在体 (in vivo) 表达 $\\mathbf{x}_j^{\\mathrm{in}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[1.000,0.027,0.017]$\n  - $t=10.0$: $[0.717,0.105,0.360]$\n  - $t=20.0$: $[0.513,0.328,1.000]$\n  - $t=30.0$: $[0.368,0.671,0.360]$\n  - $t=40.0$: $[0.264,0.895,0.017]$\n  - $t=50.0$: $[0.189,0.973,0.0001]$\n- 类器官表达 $\\mathbf{x}_i^{\\mathrm{org}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[1.000,0.027,0.017]$\n  - $t=3.0$: $[0.905,0.042,0.052]$\n  - $t=8.0$: $[0.766,0.081,0.230]$\n  - $t=15.0$: $[0.607,0.193,0.775]$\n  - $t=28.0$: $[0.394,0.606,0.520]$\n  - $t=40.0$: $[0.264,0.895,0.017]$\n\n测试用例 2 (肠道类器官到在体 (in vivo) 肠道样轨迹；$G=3$ 个基因；在体 (in vivo) 时间点 6 个；类器官时间点 6 个)：\n- 在体 (in vivo) 时间 (天)：$[0.0,5.0,10.0,15.0,25.0,35.0]$\n- 类器官时间 (天)：$[0.0,2.0,6.0,12.0,18.0,30.0]$\n- 在体 (in vivo) 表达 $\\mathbf{x}_j^{\\mathrm{in}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[0.066,0.249,0.011]$\n  - $t=5.0$: $[0.269,1.000,0.037]$\n  - $t=10.0$: $[0.661,0.249,0.119]$\n  - $t=15.0$: $[0.911,0.0039,0.321]$\n  - $t=25.0$: $[0.997,0.000,0.852]$\n  - $t=35.0$: $[1.000,0.000,0.986]$\n- 类器官表达 $\\mathbf{x}_i^{\\mathrm{org}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[0.066,0.249,0.011]$\n  - $t=2.0$: $[0.119,0.607,0.018]$\n  - $t=6.0$: $[0.339,0.946,0.047]$\n  - $t=12.0$: $[0.791,0.066,0.183]$\n  - $t=18.0$: $[0.966,0.0001,0.500]$\n  - $t=30.0$: $[0.999,0.000,0.953]$\n\n测试用例 3 (具有恒定表达的边界情况；$G=2$ 个基因；在体 (in vivo) 时间点 4 个；类器官时间点 3 个)：\n- 在体 (in vivo) 时间 (天)：$[0.0,1.0,2.0,3.0]$\n- 类器官时间 (天)：$[0.0,1.0,2.0]$\n- 在所有时间点的在体 (in vivo) 表达 $\\mathbf{x}_j^{\\mathrm{in}}=[g_1,g_2]$：$[0.5,0.5]$\n- 在所有时间点的类器官表达 $\\mathbf{x}_i^{\\mathrm{org}}=[g_1,g_2]$：$[0.5,0.5]$\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的列表，该列表包含三个结果列表。例如：$[[1.000,2.000],[3.000,4.000,5.000],[6.000]]$ (这只是格式示例，不是正确答案)。每个值都必须是以天为单位、四舍五入到三位小数的实数，并且每个测试用例的结果必须按照上面列出的测试用例的顺序出现。", "solution": "该问题在科学上基于分子和发育生物学，在数学上是适定的，并为一项计算任务提供了完整、自洽的规范。解决方案通过实现指定的时间对齐分析来进行。该分析的核心是DTW算法，这是一种用于比较两个可能速度不同的时间序列的标准方法。\n\n**方法论**\n\n设在体 (in vivo) 参考轨迹为在时间点 $\\{t_j^{\\mathrm{in}}\\}_{j=0}^{m-1}$ 采样的 $m$ 个基因表达向量序列 $\\{\\mathbf{x}_j^{\\mathrm{in}} \\in \\mathbb{R}^G\\}_{j=0}^{m-1}$。设类器官轨迹为在时间点 $\\{t_i^{\\mathrm{org}}\\}_{i=0}^{n-1}$ 采样的 $n$ 个向量序列 $\\{\\mathbf{x}_i^{\\mathrm{org}} \\in \\mathbb{R}^G\\}_{i=0}^{n-1}$。目标是找到一个映射函数 $f: \\{0, \\dots, n-1\\} \\to \\mathbb{R}$，其中 $f(i)$ 表示与第 $i$ 个类器官时间点相对应的在体 (in vivo) 发育时间。\n\n该过程分四步执行：\n\n**1. 点对点成本矩阵构建**\n首先，我们构建一个点对点成本矩阵 $C \\in \\mathbb{R}^{n \\times m}$。每个元素 $C_{i,j}$ 量化了类器官的第 $i$ 个状态与在体 (in vivo) 参考的第 $j$ 个状态之间的不相似性。根据规定，该成本是相应 $G$ 维基因表达向量之间的欧几里得距离：\n$$C_{i,j} = d(i,j) = \\lVert \\mathbf{x}_i^{\\mathrm{org}} - \\mathbf{x}_j^{\\mathrm{in}} \\rVert_2$$\n\n**2. 累积成本矩阵计算**\n接下来，我们使用动态规划计算累积成本矩阵 $D \\in \\mathbb{R}^{n \\times m}$。一个条目 $D_{i,j}$ 表示从起点 $(0,0)$ 到点 $(i,j)$ 的对齐路径的最小总成本。该矩阵构建如下：\n\n*   **初始化：**\n    *   原点的成本即为局部成本：$D_{0,0} = C_{0,0}$。\n    *   通过水平累积成本填充第一行：$D_{0,j} = C_{0,j} + D_{0,j-1}$，对于 $j=1, \\dots, m-1$。\n    *   通过垂直累积成本填充第一列：$D_{i,0} = C_{i,0} + D_{i-1,0}$，对于 $i=1, \\dots, n-1$。\n\n*   **递推关系：**\n    对于所有其他条目 ($i>0, j>0$)，累积成本是局部成本 $C_{i,j}$ 与允许的前驱节点的最小累积成本之和。\n    $$D_{i,j} = C_{i,j} + \\min(D_{i-1,j-1}, D_{i-1,j}, D_{i,j-1})$$\n    根据平局打破规则（对角 > 垂直 > 水平的原始问题描述有误，标准是 对角 > 水平 > 垂直，这里我们遵循问题描述中正确的向量表示法 `(1,1)` 优先于 `(0,1)`，` (0,1)` 优先于 `(1,0)`，这意味着前驱单元格 $(i-1, j-1)$ 优先于 $(i, j-1)$，后者优先于 $(i-1, j)$），我们选择成本最小的前驱。\n\n*   **平局打破规则：**\n    为确保路径唯一，`min` 运算中的平局根据指定的偏好解决：对角步骤 $(i-1,j-1)$ 优先于水平步骤 $(i,j-1)$，水平步骤优先于垂直步骤 $(i-1,j)$。维护一个前驱矩阵 $P$ 以存储在每个点 $(i,j)$ 上的决策，供后续回溯使用。\n\n**3. 最优路径回溯**\n最优规整路径 $\\mathcal{P}$ 是一个索引对序列 $\\{(i_k, j_k)\\}_{k=0}^{K-1}$，它以最低的总累积成本 $D_{n-1,m-1}$ 连接 $(0,0)$ 和 $(n-1,m-1)$。该路径通过从 $(n-1,m-1)$ 回溯到 $(0,0)$，并遵循存储在矩阵 $P$ 中的前驱节点来提取。最终得到的路径是两个序列时间点之间的一组对应关系。\n\n**4. 类器官到在体 (in vivo) 时间映射**\n最后，使用最优路径 $\\mathcal{P}$ 定义时间映射 $f(i)$。对于每个类器官索引 $i \\in \\{0, \\dots, n-1\\}$，我们找出路径上与 $i$ 配对的所有在体 (in vivo) 索引集合 $J(i) = \\{j \\mid (i,j) \\in \\mathcal{P}\\}$。相应的映射时间 $f(i)$ 是这些索引对应的在体 (in vivo) 时间的算术平均值：\n$$f(i) = \\frac{1}{|J(i)|} \\sum_{j \\in J(i)} t_j^{\\mathrm{in}}$$\n$f(i)$ 的最终值以天为单位报告，并四舍五入到三位小数。此过程将应用于每个测试用例以生成所需的结果。", "answer": "[[0.000, 10.000, 10.000, 20.000, 30.000, 40.000],[0.000, 5.000, 5.000, 10.000, 25.000, 35.000],[0.500, 2.000, 3.000]]", "id": "2622535"}]}