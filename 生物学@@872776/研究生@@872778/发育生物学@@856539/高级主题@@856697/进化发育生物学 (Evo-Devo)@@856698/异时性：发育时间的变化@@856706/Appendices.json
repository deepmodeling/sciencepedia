{"hands_on_practices": [{"introduction": "异时性分析的基础在于准确地对发育时间表中的演化变化进行分类。这项练习 [@problem_id:2641852] 挑战您应用经典框架——将发育分解为起始 ($t_{\\mathrm{on}}$)、终止 ($t_{\\mathrm{off}}$) 和速率 ($k$) 的变化——来处理一个假设的数据集。通过分析所提供的个体发育轨迹，您将能够区分不同模式的幼态持续 (paedomorphosis)，并精确指出早熟 (progenesis) 作为其背后的机制。", "problem": "一个关于某两栖动物谱系的比较数据集，记录了一个体性状（体长）的个体发育轨迹和首次繁殖年龄。对于祖先种群，其性成熟前的体细胞轨迹可由定义在 $t \\in [t_{\\mathrm{on,anc}}, t_{\\mathrm{off,anc}}]$ 上的分段平滑函数 $S_{\\mathrm{anc}}(t)$ 近似表示，其中 $t_{\\mathrm{on,anc}}$ 是性状发育的起始时间，$t_{\\mathrm{off,anc}}$ 与首次繁殖年龄 $t_{\\mathrm{m,anc}}$ 重合。对于后代种群，相应的量为 $S_{\\mathrm{desc}}(t)$、$t_{\\mathrm{on,desc}}$、$t_{\\mathrm{off,desc}}$ 和 $t_{\\mathrm{m,desc}}$。\n\n经验分析表明以下几点：\n- 在性成熟前区间内，$S_{\\mathrm{anc}}(t)$ 和 $S_{\\mathrm{desc}}(t)$ 以相同的平均体细胞生长速率 $k$ 增长（即，对于 $t  t_{\\mathrm{m}}$，有 $\\mathrm{d}S_{\\mathrm{anc}}/\\mathrm{d}t \\approx k$ 和 $\\mathrm{d}S_{\\mathrm{desc}}/\\mathrm{d}t \\approx k$）。\n- 起始时间在测量误差范围内无法区分，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$。\n- 后代种群更早达到性成熟，$t_{\\mathrm{m,desc}}  t_{\\mathrm{m,anc}}$，并且性状生长在 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{m,desc}}$ 时停止（也就是说，体细胞生长在两个种群中均在繁殖时有效终止）。\n\n使用经典的异时性框架，将发育变化分解为目标性状的起始 ($t_{\\mathrm{on}}$)、终止 ($t_{\\mathrm{off}}$) 和速率 ($k$) 等轴，对最能解释这些观察结果的异时性形式进行分类，并通过说明哪些轴发生了变化以及变化的方向来证明该分类的合理性。\n\n选择唯一最佳选项：\n\nA. 早熟导致的幼态延续：由于性成熟提前导致终止时间提前，伴有 $t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$、$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$ 和 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测相对于 $S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}})$，$S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}})$ 会减小，并在繁殖时保留幼年体细胞特征。\n\nB. 幼态持续导致的幼态延续：体细胞速率减慢，伴有 $k_{\\mathrm{desc}}  k_{\\mathrm{anc}}$、$t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$ 和 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测由于速率降低，在相同的繁殖年龄时 $S$ 值会减小。\n\nC. 超度发育导致的过熟形态：由于性成熟延迟导致终止时间推迟，伴有 $t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$、$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$ 和 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测繁殖时的 $S$ 值会更大。\n\nD. 前移导致的过熟形态：体细胞发育起始时间提前，伴有 $t_{\\mathrm{on,desc}}  t_{\\mathrm{on,anc}}$、$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$ 和 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$；预测由于繁殖前发育持续时间延长，在相同的繁殖年龄时 $S$ 值会更大。", "solution": "在尝试解答之前，必须首先验证问题陈述的科学和逻辑完整性。\n\n**步骤1：提取已知条件**\n\n问题提供了关于祖先和后代两栖动物种群的以下信息：\n\n- **祖先种群：**\n    - 体性状轨迹：$S_{\\mathrm{anc}}(t)$\n    - 发育起始：$t_{\\mathrm{on,anc}}$\n    - 发育终止：$t_{\\mathrm{off,anc}}$\n    - 首次繁殖年龄：$t_{\\mathrm{m,anc}}$\n    - 条件：$t_{\\mathrm{off,anc}} = t_{\\mathrm{m,anc}}$\n\n- **后代种群：**\n    - 体性状轨迹：$S_{\\mathrm{desc}}(t)$\n    - 发育起始：$t_{\\mathrm{on,desc}}$\n    - 发育终止：$t_{\\mathrm{off,desc}}$\n    - 首次繁殖年龄：$t_{\\mathrm{m,desc}}$\n    - 条件：$t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{m,desc}}$\n\n- **比较数据：**\n    1. 两个种群的平均体细胞生长速率 $k$ 近似相同：$\\mathrm{d}S_{\\mathrm{anc}}/\\mathrm{d}t \\approx k$ 且 $\\mathrm{d}S_{\\mathrm{desc}}/\\mathrm{d}t \\approx k$。这意味着 $k_{\\mathrm{anc}} \\approx k_{\\mathrm{desc}}$。\n    2. 起始时间近似相等：$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$。\n    3. 后代种群成熟更早：$t_{\\mathrm{m,desc}}  t_{\\mathrm{m,anc}}$。\n\n任务是使用异时性框架对这一演化变化进行分类，该框架分析三个发育参数的变化：起始时间 ($t_{\\mathrm{on}}$)、终止时间 ($t_{\\mathrm{off}}$) 和发育速率 ($k$) 。\n\n**步骤2：使用提取的已知条件进行验证**\n\n该问题在科学上基于演化发育生物学中已建立的异时性理论。参数（$t_{\\mathrm{on}}$、$t_{\\mathrm{off}}$、$k$）是该领域的标准参数。所描述的情景对于两栖动物在生物学上是合理的。所有提供的信息都是自洽、一致且足以形成唯一解的。语言精确客观。没有违反科学原理、逻辑矛盾或含糊不清之处。\n\n**步骤3：结论与行动**\n\n问题陈述有效。将推导解答。\n\n**解答推导**\n\n问题的核心是确定体细胞性状的发育参数从祖先到后代是如何变化的。我们根据给定信息分析异时性的三个轴中的每一个。\n\n1.  **发育速率 ($k$)**：问题明确指出，两个种群的平均体细胞生长速率相同。因此，速率没有变化：\n    $$k_{\\mathrm{desc}} \\approx k_{\\mathrm{anc}}$$\n\n2.  **发育起始 ($t_{\\mathrm{on}}$)**：问题明确指出，起始时间无法区分。因此，起始时间没有变化：\n    $$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$$\n\n3.  **发育终止 ($t_{\\mathrm{off}}$)**：问题将体细胞生长的终止与两个种群的性成熟年龄联系起来 ($t_{\\mathrm{off}} \\approx t_{\\mathrm{m}}$)。已知后代种群比祖先种群更早达到性成熟：\n    $$t_{\\mathrm{m,desc}}  t_{\\mathrm{m,anc}}$$\n    从终止时间与成熟时间的耦合关系可以直接得出，后代种群的体细胞生长终止时间也更早：\n    $$t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$$\n\n**异时性分类**\n\n我们已经确定了以下变化：速率无变化，起始时间无变化，终止时间提前。我们现在必须对这种模式进行分类。\n\n异时性大致分为两大类，基于后代成体形态与祖先个体发育的比较：\n- **幼态延续 (Paedomorphosis)**：后代成体类似于祖先的幼年阶段。这发生在发育被截断或减慢时。\n- **过熟形态 (Peramorphosis)**：后代成体发育超越了祖先的成体形态。这发生在发育被延长或加速时。\n\n为了确定适用哪一类别，我们必须评估终止时的最终体细胞性状大小 $S$。根据指定的线性近似假设，终止时的大小是初始大小 $S(t_{\\mathrm{on}})$、速率 $k$ 和生长持续时间 $(t_{\\mathrm{off}} - t_{\\mathrm{on}})$ 的函数。\n祖先在终止时的大小为：\n$$S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}}) \\approx S(t_{\\mathrm{on,anc}}) + k_{\\mathrm{anc}} \\cdot (t_{\\mathrm{off,anc}} - t_{\\mathrm{on,anc}})$$\n后代在终止时的大小为：\n$$S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}}) \\approx S(t_{\\mathrm{on,desc}}) + k_{\\mathrm{desc}} \\cdot (t_{\\mathrm{off,desc}} - t_{\\mathrm{on,desc}})$$\n鉴于 $k_{\\mathrm{desc}} \\approx k_{\\mathrm{anc}}$，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$，并假设初始大小相当，最终大小的差异由生长持续时间决定。由于 $t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$，后代的生长持续时间更短：\n$$(t_{\\mathrm{off,desc}} - t_{\\mathrm{on,desc}})  (t_{\\mathrm{off,anc}} - t_{\\mathrm{on,anc}})$$\n这导致后代的最终体细胞大小更小：\n$$S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}})  S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}})$$\n后代成体比祖先成体小，在大小上类似于祖先的幼年（亚成体）阶段。根据定义，这就是**幼态延续**。\n\n接下来，我们必须确定幼态延续的具体机制。\n- **早熟 (Progenesis)**：由性早熟引起的体细胞发育提前终止所导致的幼态延续。其特征性变化是终止时间提前 ($t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$)，而速率或起始时间没有变化。\n- **幼态持续 (Neoteny)**：在相似的发育时期内，通过降低体细胞发育速率 ($k_{\\mathrm{desc}}  k_{\\mathrm{anc}}$) 所导致的幼态延续。\n- **后移 (Postdisplacement)**：通过延迟体细胞发育的起始时间 ($t_{\\mathrm{on,desc}}  t_{\\mathrm{on,anc}}$) 所导致的幼态延续。\n\n我们推导出的变化——$t_{\\mathrm{on}}$ 无变化，$k$ 无变化，以及 $t_{\\mathrm{off}}$ 提前——完全符合**早熟**的定义。\n\n**逐项分析**\n\n- **A. 早熟导致的幼态延续：由于性成熟提前导致终止时间提前，伴有 $t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$、$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$ 和 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测相对于 $S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}})$，$S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}})$ 会减小，并在繁殖时保留幼年体细胞特征。**\n此选项正确地将结果识别为幼态延续，机制为早熟。它正确地列出了参数变化：终止时间提前 ($t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$)、速率相同 ($k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$) 和起始时间相同 ($t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$)，这些都与我们的推导一致。它还正确预测了成体体型变小的形态学结果。此描述完全正确。\n结论：**正确**。\n\n- **B. 幼态持续导致的幼态延续：体细胞速率减慢，伴有 $k_{\\mathrm{desc}}  k_{\\mathrm{anc}}$、$t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$ 和 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测由于速率降低，在相同的繁殖年龄时 $S$ 值会减小。**\n此选项提出是幼态持续，这要求发育速率减慢 ($k_{\\mathrm{desc}}  k_{\\mathrm{anc}}$)。这与问题陈述中 $k_{\\mathrm{desc}} \\approx k_{\\mathrm{anc}}$ 的条件相矛盾。它还错误地假设 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$，这与给定的提前成熟条件相矛盾。\n结论：**不正确**。\n\n- **C. 超度发育导致的过熟形态：由于性成熟延迟导致终止时间推迟，伴有 $t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$、$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$ 和 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测繁殖时的 $S$ 值会更大。**\n此选项提出是过熟形态，这与观察到的幼态延续结果相反。它还假定了一个更晚的终止时间 ($t_{\\mathrm{off,desc}}  t_{\\mathrm{off,anc}}$)，这与条件 $t_{\\mathrm{m,desc}}  t_{\\mathrm{m,anc}}$ 直接矛盾。\n结论：**不正确**。\n\n- **D. 前移导致的过熟形态：体细胞发育起始时间提前，伴有 $t_{\\mathrm{on,desc}}  t_{\\mathrm{on,anc}}$、$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$ 和 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$；预测由于繁殖前发育持续时间延长，在相同的繁殖年龄时 $S$ 值会更大。**\n此选项提出是过熟形态，再次与幼态延续的结果相矛盾。前移机制要求起始时间提前 ($t_{\\mathrm{on,desc}}  t_{\\mathrm{on,anc}}$)，这与给定信息 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$ 相矛盾。\n结论：**不正确**。\n\n唯一完全符合问题陈述和异时性原理的选项是A。", "answer": "$$\\boxed{A}$$", "id": "2641852"}, {"introduction": "异时性研究的一个核心挑战是区分发育持续时间的变化（例如，过形成 hypermorphosis）和发育速率的变化（例如，加速 acceleration）。这项练习 [@problem_id:2641827] 提供了一个形式化但直观的分段线性生长模型，以解析地探讨这一区别。您将推导出发育阶段的延长对最终性状大小的精确影响，从而阐明过形成的定义，并揭示不同的测量方案如何可能导致不同的实证结论。", "problem": "一个发育中生物体的性状 $X(t)$ 在 $n$ 个连续阶段中呈分段线性增长。在阶段 $i \\in \\{1,\\dots,n\\}$ 中，该性状以恒定速率 $r_i$ 生长，持续时间为 $\\Delta t_i$，各阶段在时间上连接，因此基线最终年龄为 $T=\\sum_{i=1}^{n}\\Delta t_i$。假设 $X(0)=0$，则基线最终大小是时间积分 $X(T)=\\int_{0}^{T} r(t)\\,dt=\\sum_{i=1}^{n} r_i \\Delta t_i$，其中在阶段 $i$，$r(t)=r_i$。题目告知，“晚期阶段”指的是最后的阶段 $n$。\n\n考虑以下异时性操作：将最后阶段的持续时间延长一个很小的量 $\\epsilon0$，而不改变任何速率 $r_i$。分析两种在实证研究中常被混淆的测量条件：\n- 固定年龄条件：在原始年龄 $T$ 时测量该生物体。\n- 偏移延迟条件：在新的最终年龄 $T' = T + \\epsilon$ 时测量该生物体。\n\n仅使用 $X(T)$ 作为分段恒定速率函数的时间积分的定义，以及发育生物学的标准惯例，即“加速发育”（acceleration）表示在时间不变的情况下速率 $r_i$ 的变化，而“超发育”（hypermorphosis）表示发育终止的延迟（在速率不变的情况下增加终止时间），推导以下各项的闭式解析表达式：\n1) 固定年龄条件下最终性状大小的变化，$\\Delta X_{\\mathrm{fixed}} = X_{\\mathrm{after}}(T) - X_{\\mathrm{before}}(T)$；\n2) 偏移延迟条件下最终性状大小的变化，$\\Delta X_{\\mathrm{offset}} = X_{\\mathrm{after}}(T') - X_{\\mathrm{before}}(T)$；\n并且，仅根据哪些量被改变，将该操作分类为超发育或加速发育。\n\n将你的最终答案表示为一个行矩阵 $\\big[\\Delta X_{\\mathrm{fixed}},\\ \\Delta X_{\\mathrm{offset}},\\ c\\big]$，其中如果操作是超发育，则 $c=1$；如果是加速发育，则 $c=0$。无需四舍五入，你应该用 $r_n$ 和 $\\epsilon$ 的符号形式表示你的答案。", "solution": "所述问题具有科学依据，提法恰当，且客观。它提供了一个用于分析发育中异时性变化的正式模型，并使用了发育生物学领域的标准定义。问题中没有矛盾、歧义或缺失的信息。该问题是有效的，并且允许进行严格的解析求解。我将开始推导。\n\n让我们首先将操作前后的生物体状态形式化。\n\n操作“前”的状态由一个分段恒定的生长速率函数 $r_{\\mathrm{before}}(t)$ 定义，总持续时间为 $T$。令 $T_k = \\sum_{i=1}^{k} \\Delta t_i$ 为阶段 $k$ 结束时的时间，其中 $T_0 = 0$。总持续时间为 $T = T_n$。速率函数为：\n$$\nr_{\\mathrm{before}}(t) = r_i \\quad \\text{for } t \\in [T_{i-1}, T_i) \\text{ where } i \\in \\{1, \\dots, n\\}\n$$\n在任何时间 $t$ 的性状大小是该速率从 $0$ 到 $t$ 的积分。在基线最终年龄 $T$ 时的最终大小由下式给出：\n$$\nX_{\\mathrm{before}}(T) = \\int_{0}^{T} r_{\\mathrm{before}}(t) \\, dt = \\sum_{i=1}^{n} r_i \\Delta t_i\n$$\n\n该操作包括将最后阶段（阶段 $n$）的持续时间延长一个量 $\\epsilon  0$，而所有速率 $r_i$ 保持不变。阶段 $n$ 的新持续时间为 $\\Delta t'_n = \\Delta t_n + \\epsilon$。对于 $i  n$ 的所有其他阶段持续时间 $\\Delta t_i$ 均保持不变。\n\n因此，操作“后”的状态由一个新的速率函数 $r_{\\mathrm{after}}(t)$ 定义，总持续时间为 $T' = T+\\epsilon$。前 $n-1$ 个阶段的时间安排与“前”状态相同。最后阶段，即阶段 $n$，现在从 $T_{n-1}$ 开始，并在新的终止时间 $T' = T_{n-1} + \\Delta t'_n = T_{n-1} + (\\Delta t_n + \\epsilon) = T + \\epsilon$ 结束。速率函数为：\n$$\nr_{\\mathrm{after}}(t) = \\begin{cases}\nr_i  \\text{for } t \\in [T_{i-1}, T_i), \\quad i \\in \\{1, \\dots, n-1\\} \\\\\nr_n  \\text{for } t \\in [T_{n-1}, T+\\epsilon)\n\\end{cases}\n$$\n对于这个被操作的生物体，在其新的终止年龄 $T'$ 测量的最终性状大小为：\n$$\nX_{\\mathrm{after}}(T') = \\int_{0}^{T'} r_{\\mathrm{after}}(t) \\, dt\n$$\n\n有了这些形式化定义，我们就可以处理两种指定的测量条件了。\n\n1.  **固定年龄条件下的变化，$\\Delta X_{\\mathrm{fixed}}$**\n\n我们需要计算 $\\Delta X_{\\mathrm{fixed}} = X_{\\mathrm{after}}(T) - X_{\\mathrm{before}}(T)$。这需要评估被操作生物体的性状大小 $X_{\\mathrm{after}}$ 在原始最终年龄 $T$ 时的值。\n$$\nX_{\\mathrm{after}}(T) = \\int_{0}^{T} r_{\\mathrm{after}}(t) \\, dt\n$$\n为了计算这个积分，我们考察函数 $r_{\\mathrm{after}}(t)$ 在积分区间 $[0, T)$ 上的情况。\n- 对于 $t \\in [0, T_{n-1})$，函数 $r_{\\mathrm{after}}(t)$ 与 $r_{\\mathrm{before}}(t)$ 相同。\n- 对于 $t \\in [T_{n-1}, T)$，速率为 $r_{\\mathrm{after}}(t) = r_n$。这也与 $r_{\\mathrm{before}}(t)$ 在同一区间内的速率相同。\n\n因此，对于整个积分区间 $t \\in [0, T)$，两个速率函数是相同的：$r_{\\mathrm{after}}(t) = r_{\\mathrm{before}}(t)$。因此，它们在此区间上的积分必定相等：\n$$\nX_{\\mathrm{after}}(T) = \\int_{0}^{T} r_{\\mathrm{after}}(t) \\, dt = \\int_{0}^{T} r_{\\mathrm{before}}(t) \\, dt = X_{\\mathrm{before}}(T)\n$$\n因此，在固定年龄条件下性状大小的变化为：\n$$\n\\Delta X_{\\mathrm{fixed}} = X_{\\mathrm{after}}(T) - X_{\\mathrm{before}}(T) = 0\n$$\n\n2.  **偏移延迟条件下的变化，$\\Delta X_{\\mathrm{offset}}$**\n\n我们需要计算 $\\Delta X_{\\mathrm{offset}} = X_{\\mathrm{after}}(T') - X_{\\mathrm{before}}(T)$，其中 $T' = T+\\epsilon$。我们必须评估被操作生物体在其新的最终年龄 $T'$ 时的性状大小。\n$$\nX_{\\mathrm{after}}(T') = \\int_{0}^{T'} r_{\\mathrm{after}}(t) \\, dt = \\int_{0}^{T+\\epsilon} r_{\\mathrm{after}}(t) \\, dt\n$$\n为便于分析，我们可以将此积分在时间 $T$ 处拆分：\n$$\nX_{\\mathrm{after}}(T+\\epsilon) = \\int_{0}^{T} r_{\\mathrm{after}}(t) \\, dt + \\int_{T}^{T+\\epsilon} r_{\\mathrm{after}}(t) \\, dt\n$$\n根据前面的分析，我们知道第一项是 $\\int_{0}^{T} r_{\\mathrm{after}}(t) \\, dt = X_{\\mathrm{before}}(T)$。\n\n对于第二项，我们必须找到在区间 $[T, T+\\epsilon)$ 内的速率 $r_{\\mathrm{after}}(t)$。这个时间区间落在被操作的最后阶段内，该阶段从 $T_{n-1}$ 延伸到 $T+\\epsilon$。因此，此区间内的速率是最后阶段的恒定速率 $r_n$。\n该积分为：\n$$\n\\int_{T}^{T+\\epsilon} r_n \\, dt = r_n \\cdot [t]_{T}^{T+\\epsilon} = r_n \\cdot ((T+\\epsilon) - T) = r_n \\epsilon\n$$\n将这些结果代回，我们得到新的终止时间下的最终大小：\n$$\nX_{\\mathrm{after}}(T') = X_{\\mathrm{before}}(T) + r_n \\epsilon\n$$\n在偏移延迟条件下性状大小的变化为：\n$$\n\\Delta X_{\\mathrm{offset}} = X_{\\mathrm{after}}(T') - X_{\\mathrm{before}}(T) = (X_{\\mathrm{before}}(T) + r_n \\epsilon) - X_{\\mathrm{before}}(T) = r_n \\epsilon\n$$\n\n3.  **操作的分类**\n\n问题提供了两个定义：\n- **加速发育 (Acceleration):** 在时间安排不变的情况下，速率 $r_i$ 发生变化。\n- **超发育 (Hypermorphosis):** 在速率 $r_i$ 不变的情况下，发育终止延迟（即终止时间 $T$ 增加）。\n\n在指定的操作中，速率 $r_i$ 被明确地保持不变。发育终止时间从 $T$ 延长到了 $T' = T+\\epsilon$。这完全符合超发育的定义。因此，此操作是超发育，分类变量 $c$ 必须为 $1$。\n\n将这三个结果组合成所要求的行矩阵，得到 $[\\Delta X_{\\mathrm{fixed}}, \\Delta X_{\\mathrm{offset}}, c] = [0, r_n \\epsilon, 1]$。", "answer": "$$\n\\boxed{\\begin{bmatrix} 0  r_n \\epsilon  1 \\end{bmatrix}}\n$$", "id": "2641827"}, {"introduction": "除了分类，一个关键目标是理解异时性是如何演化的。这项高级练习 [@problem_id:2641788] 利用数量遗传学的反应规范 (reaction norm) 框架，将发育时间与演化预测联系起来。您将实施一个模型来估计开花时间可塑性的遗传变异，并预测其在选择下的单代响应，从而展示异时性变化如何为快速适应环境变化提供原材料。", "problem": "要求您使用反应规范框架来形式化并实现一个异时发育的数量遗传学模型。研究的核心性状是作为温度环境函数的开花时间，用反应规范 $T_f(E)$ 表示，其中 $T_f$ 以天为单位测量，而 $E$ 以摄氏度为单位测量。假设每个基因型 $i$ 的反应规范是线性的，以平均环境 $\\bar{E}$ 为中心，$$T_{f,i}(E) = a_i + b_i\\,(E - \\bar{E}) + \\varepsilon_{i}(E),$$ 其中 $a_i$ 是截距（在 $E = \\bar{E}$ 时的平均开花时间），$b_i$ 是可塑性（斜率，单位为天/摄氏度），而 $\\varepsilon_i(E)$ 是均值为零的误差项。目标是估计不同基因型之间可塑性的遗传变异，并预测在围绕环境追踪最优值的稳定化选择作用下一个世代内可塑性的演化变化。请遵循以下步骤，严格地从第一性原理和广泛接受的数量遗传学概念推导出所有量。\n\n使用的基本定律和核心定义：\n- 线性基因型特异性响应 $T_{f,i}(E)$ 的反应规范定义。\n- 使用最小二乘法进行线性回归，从跨环境的表型测量值中估计 $a_i$ 和 $b_i$。\n- 对具有环境依赖最优值的表型进行稳定化选择，由高斯适应度 $w \\propto \\exp\\big(-c\\,[T_f(E) - T_{\\mathrm{opt}}(E)]^2\\big)$ 建模，其中 $c  0$ 是凸性（曲率）参数，单位为 $\\text{day}^{-2}$。\n- Lande 方程（源于数量遗传学）：性状平均值的每代演化响应等于加性遗传方差乘以选择梯度，即 $\\Delta \\theta = V_A\\,\\beta$，其中 $\\beta$ 是选择梯度（平均相对适应度对性状平均值的导数）。\n\n需要实现的推导：\n1) 对线性模型 $T_{f,i}(E) = a_i + b_i(E - \\bar{E})$ 使用最小二乘法，从观测到的 $(E, T_f)$ 对中估计每个基因型 $i$ 的 $a_i$ 和 $b_i$。使用中心化环境 $E_c = E - \\bar{E}$ 可以确保 $\\hat{a}_i$ 等于基因型 $i$ 的平均观测 $T_f$，而 $\\hat{b}_i$ 等于最小二乘斜率 $\\hat{b}_i = \\frac{\\sum_j E_{c,j}\\,(T_{i,j}-\\bar{T}_i)}{\\sum_j E_{c,j}^2}$。\n2) 将可塑性的遗传方差估计为估计斜率的样本方差，$V_{G,b} = \\mathrm{Var}(\\{\\hat{b}_i\\})$，使用无偏估计量（对于 $n_g$ 个基因型，分母为 $n_g - 1$）。假设加性遗传方差 $V_{A,b}$ 可以很好地由该基因型间方差 $V_{G,b}$ 近似。\n3) 假设环境依赖的最优开花时间是线性的：$T_{\\mathrm{opt}}(E) = T_* + s\\,(E - \\bar{E})$，其中 $s$ 是最优斜率（单位为天/摄氏度）。在弱选择和小编差的条件下，从对环境分布进行平均的高斯适应度函数推导出作用于平均可塑性 $\\bar{b}$ 上的选择梯度。使用选择梯度的定义 $\\beta_b = \\frac{\\partial \\bar{w}}{\\partial \\bar{b}}$（在当前群体均值处），证明它取决于环境方差 $\\mathrm{Var}(E)$ 和曲率参数 $c$。不要假设任何给定的快捷公式；通过围绕 $T_f(E)$ 对平均适应度进行泰勒展开并对 $E$ 的经验分布求期望，从第一性原理进行推导。\n4) 使用 Lande 方程处理斜率性状，得到预测的平均可塑性单代变化，$\\Delta \\bar{b} = V_{A,b}\\,\\beta_b$。\n5) 预测气候变化下群体平均开花时间的后果。设新的平均环境为 $E_{\\mathrm{new}} = \\bar{E} + \\Delta E$，其中 $\\Delta E$ 是指定的温度变化量（摄氏度）。假设截距均值 $\\bar{a}$ 在一代之内不演化（在此时间尺度上，仅截距的演化可忽略不计），计算：\n   - 在 $E_{\\mathrm{new}}$ 处的适应前预测均值：$T_{\\mathrm{before}} = \\bar{a} + \\bar{b}\\,(E_{\\mathrm{new}} - \\bar{E})$。\n   - 在 $E_{\\mathrm{new}}$ 处使用 $\\bar{b}' = \\bar{b} + \\Delta \\bar{b}$ 的适应后预测均值：$T_{\\mathrm{after}} = \\bar{a} + \\bar{b}'\\,(E_{\\mathrm{new}} - \\bar{E})$。\n所有开花时间必须以天为单位报告，所有与温度相关的斜率必须以天/摄氏度为单位。\n\n您的程序必须实现上述推导，并为一组固定的测试数据集生成数值答案（无用户输入）。使用最小二乘法估计 $\\hat{a}_i$ 和 $\\hat{b}_i$，将 $V_{G,b}$ 计算为基因型间的无偏样本方差，将经验环境方差 $\\mathrm{Var}(E)$ 计算为中心化环境 $E_c = E - \\bar{E}$ 的平方均值，根据高斯适应度假设以及量 $c$、$s$ 和 $\\mathrm{Var}(E)$ 推导出选择梯度 $\\beta_b$，然后计算 $\\Delta \\bar{b}$ 和在 $E_{\\mathrm{new}}$ 处的两个预测平均开花时间。\n\n测试套件（每个测试用例提供 $(E, T, s, c, \\Delta E)$，其中 $E$ 是环境列表，单位为 ${}^{\\circ}\\mathrm{C}$，$T$ 是开花时间矩阵，单位为天，行代表基因型，列与 $E$ 对齐）：\n- 情况 A（一般情况）：\n  - $E = \\{15,18,21,24\\}\\,^{\\circ}\\mathrm{C}$。\n  - 基因型 1：$[59,53,47,41]$ 天。\n  - 基因型 2：$[56.5,53.5,50.5,47.5]$ 天。\n  - 基因型 3：$[61.5,52.5,43.5,34.5]$ 天。\n  - $s = -2.0$ 天/${}^{\\circ}\\mathrm{C}$，$c = 0.001$ $\\mathrm{day}^{-2}$，$\\Delta E = 3$ ${}^{\\circ}\\mathrm{C}$。\n- 情况 B（可塑性方差为零的边界情况）：\n  - $E = \\{15,18,21,24\\}\\,^{\\circ}\\mathrm{C}$。\n  - 基因型 1：$[59,53,47,41]$ 天。\n  - 基因型 2：$[69,63,57,51]$ 天。\n  - 基因型 3：$[64,58,52,46]$ 天。\n  - $s = -3.0$ 天/${}^{\\circ}\\mathrm{C}$，$c = 0.001$ $\\mathrm{day}^{-2}$，$\\Delta E = 3$ ${}^{\\circ}\\mathrm{C}$。\n- 情况 C（具有非零预测响应的双环境边缘情况）：\n  - $E = \\{12,28\\}\\,^{\\circ}\\mathrm{C}$。\n  - 基因型 1：$[68,52]$ 天。\n  - 基因型 2：$[94,30]$ 天。\n  - $s = -3.0$ 天/${}^{\\circ}\\mathrm{C}$，$c = 0.0005$ $\\mathrm{day}^{-2}$，$\\Delta E = 2$ ${}^{\\circ}\\mathrm{C}$。\n- 情况 D（多基因型降温情景）：\n  - $E = \\{16,20,24\\}\\,^{\\circ}\\mathrm{C}$。\n  - 基因型 1：$[54,50,46]$ 天。\n  - 基因型 2：$[60,52,44]$ 天。\n  - 基因型 3：$[57,51,45]$ 天。\n  - 基因型 4：$[63,53,43]$ 天。\n  - $s = -2.0$ 天/${}^{\\circ}\\mathrm{C}$，$c = 0.001$ $\\mathrm{day}^{-2}$，$\\Delta E = -2$ ${}^{\\circ}\\mathrm{C}$。\n\n对于每个测试用例，您的程序必须输出一个包含四个浮点值的列表，格式化为六位小数：\n- $V_{G,b}$，单位为 $(\\mathrm{days}/{}^{\\circ}\\mathrm{C})^2$，\n- $\\Delta \\bar{b}$，单位为 $\\mathrm{days}/{}^{\\circ}\\mathrm{C}$ 每代，\n- $T_{\\mathrm{before}}$，在 $E_{\\mathrm{new}}$ 处，单位为天，\n- $T_{\\mathrm{after}}$，在 $E_{\\mathrm{new}}$ 处，单位为天。\n\n最终输出格式：\n- 生成单行包含 Python 风格的列表的列表，每个子列表对应一个测试用例，顺序为 $[V_{G,b}, \\Delta \\bar{b}, T_{\\mathrm{before}}, T_{\\mathrm{after}}]$。数字必须精确到小数点后六位。例如：$[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\ldots]$。", "solution": "所述问题在科学上是合理的、定义明確且客观的。它基于数量遗传学的基本原理，特别是用于研究表型可塑性的反应规范框架、线性模型的最小二乘估计、稳定化选择理论以及用于预测演化响应的 Lande 方程。所提供的数据是完整和一致的，要求的推导遵循了既定理论的逻辑进程。该问题是对数量性状演化建模的一次有效且实质性的练习。因此，我们将着手提供一个完整的解决方案。\n\n解决方案按以下逻辑步骤构建：\n1.  使用最小二乘法估计每个基因型的个体反应规范参数（$a_i$, $b_i$）。\n2.  计算群体平均参数（$\\bar{a}$, $\\bar{b}$）和可塑性的遗传方差（$V_{G,b}$）。\n3.  在弱选择条件下，从给定的适应度函数推导作用于可塑性的选择梯度（$\\beta_b$）。\n4.  使用 Lande 方程预测平均可塑性的单代演化变化（$\\Delta \\bar{b}$）。\n5.  计算在新环境中经过一代选择之前（$T_{\\mathrm{before}}$）和之后（$T_{\\mathrm{after}}$）的预测平均开花时间。\n\n**1. 反应规范参数的估计**\n\n对于每个基因型 $i$，给定一组 $n_E$ 个观测的开花时间 $T_{i,j}$ 及其对应的环境 $E_j$。反应规范的模型是线性的：\n$$T_{f,i}(E) = a_i + b_i(E - \\bar{E})$$\n其中 $\\bar{E} = \\frac{1}{n_E}\\sum_{j=1}^{n_E} E_j$ 是平均环境。令 $E_{c,j} = E_j - \\bar{E}$ 为中心化的环境变量。模型变为 $T_{f,i}(E_j) = a_i + b_i E_{c,j}$。$a_i$ 和 $b_i$ 的最小二乘估计量（表示为 $\\hat{a}_i$ 和 $\\hat{b}_i$）是使残差平方和最小化的值。\n\n由于环境变量经过中心化处理，常数项与 $E_c$ 之间的交叉乘积之和为零，这使得截距和斜率的估计量是正交的。截距 $a_i$ 的估计量是该基因型观测表型的平均值：\n$$\\hat{a}_i = \\bar{T}_i = \\frac{1}{n_E}\\sum_{j=1}^{n_E} T_{i,j}$$\n斜率 $b_i$（代表基因型的可塑性）的估计量由表型与中心化环境的协方差除以中心化环境的方差给出：\n$$\\hat{b}_i = \\frac{\\sum_{j=1}^{n_E} (E_{c,j} - \\bar{E}_c)(T_{i,j} - \\bar{T}_i)}{\\sum_{j=1}^{n_E} (E_{c,j} - \\bar{E}_c)^2}$$\n由于 $\\bar{E}_c = \\frac{1}{n_E}\\sum_{j=1}^{n_E} E_{c,j} = 0$，此公式简化为问题陈述中给出的形式：\n$$\\hat{b}_i = \\frac{\\sum_{j=1}^{n_E} E_{c,j} (T_{i,j} - \\bar{T}_i)}{\\sum_{j=1}^{n_E} E_{c,j}^2}$$\n这些公式将应用于每个测试用例中每个基因型的数据。\n\n**2. 群体参数和遗传方差**\n\n在为所有 $n_g$ 个基因型估计了参数 $\\{\\hat{a}_i\\}$ 和 $\\{\\hat{b}_i\\}$ 之后，我们计算群体平均截距和斜率：\n$$\\bar{a} = \\frac{1}{n_g}\\sum_{i=1}^{n_g} \\hat{a}_i$$\n$$\\bar{b} = \\frac{1}{n_g}\\sum_{i=1}^{n_g} \\hat{b}_i$$\n可塑性的遗传方差 $V_{G,b}$ 被估计为估计斜率的无偏样本方差：\n$$V_{G,b} = \\frac{1}{n_g - 1}\\sum_{i=1}^{n_g} (\\hat{b}_i - \\bar{b})^2$$\n问题指定，这个基因型间方差分量被用作可塑性加性遗传方差的近似值，$V_{A,b} \\approx V_{G,b}$。这是在使用近交系或克隆系（其中所有遗传方差都是加性的）时的一个标准假设。\n\n**3. 可塑性选择梯度的推导**\n\n作用于平均可塑性 $\\bar{b}$ 的选择梯度 $\\beta_b$ 定义为平均相对适应度对 $\\bar{b}$ 的偏导数，在当前群体均值处求值：$\\beta_b = \\frac{\\partial \\bar{w}}{\\partial \\bar{b}}$。\n\n环境 $E$ 中的适应度由一个高斯函数给出：\n$$w(T_f(E)) \\propto \\exp\\left(-c\\,[T_f(E) - T_{\\mathrm{opt}}(E)]^2\\right)$$\n我们考虑作用于群体平均表型的选择，其反应规范为 $\\bar{T}_f(E) = \\bar{a} + \\bar{b}(E - \\bar{E})$。最优表型遵循反应规范 $T_{\\mathrm{opt}}(E) = T_* + s(E - \\bar{E})$。在给定环境 $E$ 中与最优值的偏差为：\n$$d(E) = \\bar{T}_f(E) - T_{\\mathrm{opt}}(E) = (\\bar{a} - T_*) + (\\bar{b} - s)(E - \\bar{E})$$\n平均适应度 $\\bar{w}$ 是 $w$ 在环境分布上的期望值。对于离散环境集合 $\\{E_j\\}$，这是一个平均值：\n$$\\bar{w} = \\frac{1}{n_E}\\sum_{j=1}^{n_E} \\exp\\left(-c \\left[ (\\bar{a} - T_*) + (\\bar{b} - s)(E_j - \\bar{E}) \\right]^2\\right)$$\n假设归一化常数为 1。我们现在对 $\\bar{w}$ 关于 $\\bar{b}$求导：\n$$\\beta_b = \\frac{\\partial \\bar{w}}{\\partial \\bar{b}} = \\frac{1}{n_E}\\sum_{j=1}^{n_E} \\frac{\\partial}{\\partial \\bar{b}} \\exp\\left( -c \\, d(E_j)^2 \\right)$$\n使用链式法则，$\\frac{d}{dx}e^{f(x)} = e^{f(x)}f'(x)$，我们得到：\n$$\\frac{\\partial \\bar{w}}{\\partial \\bar{b}} = \\frac{1}{n_E}\\sum_{j=1}^{n_E} \\exp(-c\\,d(E_j)^2) \\cdot (-2c\\,d(E_j)) \\cdot \\frac{\\partial d(E_j)}{\\partial \\bar{b}}$$\n偏差的偏导数为 $\\frac{\\partial d(E_j)}{\\partial \\bar{b}} = E_j - \\bar{E} = E_{c,j}$。\n所以，$\\beta_b = \\frac{-2c}{n_E}\\sum_{j=1}^{n_E} \\exp(-c\\,d(E_j)^2) \\cdot d(E_j) \\cdot E_{c,j}$。\n\n在弱选择（$c$ 很小）和与最优值偏差很小的假设下，指数项 $\\exp(-c\\,d(E_j)^2)$ 接近于 $1$。应用这个近似可以显著简化表达式：\n$$\\beta_b \\approx \\frac{-2c}{n_E}\\sum_{j=1}^{n_E} d(E_j) \\cdot E_{c,j}$$\n代入 $d(E_j)$ 的表达式：\n$$\\beta_b \\approx \\frac{-2c}{n_E}\\sum_{j=1}^{n_E} \\left[ (\\bar{a} - T_*) + (\\bar{b} - s)E_{c,j} \\right] E_{c,j}$$\n$$\\beta_b \\approx -2c \\left[ (\\bar{a} - T_*) \\left(\\frac{1}{n_E}\\sum_{j=1}^{n_E} E_{c,j}\\right) + (\\bar{b} - s) \\left(\\frac{1}{n_E}\\sum_{j=1}^{n_E} E_{c,j}^2\\right) \\right]$$\n根据定义，中心化环境的平均值为零，$\\frac{1}{n_E}\\sum E_{c,j} = 0$。中心化环境平方的均值是环境的经验方差，$\\mathrm{Var}(E) = \\frac{1}{n_E}\\sum E_{c,j}^2$。这导出了选择梯度的最终简化表达式：\n$$\\beta_b \\approx -2c\\,(\\bar{b} - s)\\,\\mathrm{Var}(E)$$\n这个从第一性原理的推导证实了结果取决于选择强度 $c$、群体平均可塑性与最优可塑性之间的失配 $(\\bar{b} - s)$ 以及环境方差 $\\mathrm{Var}(E)$。注意，问题指定 $\\mathrm{Var}(E)$ 是用分母 $n_E$ 计算的。\n\n**4. 演化响应的预测**\n\nLande 方程给出了性状平均值的每代变化，等于其加性遗传方差与作用于其上的选择梯度的乘积。对于可塑性性状 $b$ 来说，即为：\n$$\\Delta \\bar{b} = V_{A,b} \\beta_b$$\n使用我们的近似 $V_{A,b} \\approx V_{G,b}$ 和推导出的 $\\beta_b$ 表达式：\n$$\\Delta \\bar{b} = V_{G,b} \\left[ -2c\\,(\\bar{b} - s)\\,\\mathrm{Var}(E) \\right]$$\n此方程预测了经过一代选择后群体平均塑性反应的变化。\n\n**5. 气候变化的表型后果**\n\n给定平均环境变化 $\\Delta E$，新的平均环境是 $E_{\\mathrm{new}} = \\bar{E} + \\Delta E$。与历史平均环境的偏差就是 $(E_{\\mathrm{new}} - \\bar{E}) = \\Delta E$。\n\n在这个新环境中，在可塑性发生任何演化适应之前的预测平均开花时间，是使用当前群体平均参数 $\\bar{a}$ 和 $\\bar{b}$ 计算的：\n$$T_{\\mathrm{before}} = \\bar{a} + \\bar{b}\\,(E_{\\mathrm{new}} - \\bar{E}) = \\bar{a} + \\bar{b}\\,\\Delta E$$\n一代之后，平均可塑性演化到一个新值 $\\bar{b}' = \\bar{b} + \\Delta \\bar{b}$。我们假设平均截距 $\\bar{a}$ 在此时间尺度上不发生演化。使用适应后的群体在新环境中的预测平均开花时间为：\n$$T_{\\mathrm{after}} = \\bar{a} + \\bar{b}'\\,(E_{\\mathrm{new}} - \\bar{E}) = \\bar{a} + (\\bar{b} + \\Delta \\bar{b})\\,\\Delta E$$\n这些计算将为每个测试用例提供最终所需的输出。", "answer": "[[1.000000,-0.022500,43.500000,43.432500],[0.000000,0.000000,45.000000,45.000000],[4.000000,-0.256000,46.000000,45.488000],[1.000000,-0.004000,56.000000,56.008000]]", "id": "2641788"}]}