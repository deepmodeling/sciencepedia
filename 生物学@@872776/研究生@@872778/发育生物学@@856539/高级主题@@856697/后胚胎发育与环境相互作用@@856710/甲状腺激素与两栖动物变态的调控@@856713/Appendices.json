{"hands_on_practices": [{"introduction": "理解基因调控的第一步是确定转录因子在基因组上的结合位点。本练习将指导你构建一个计算流程，基于一个生物物理模型来预测甲状腺激素受体（TR）的结合位点，即甲状腺激素反应元件（TREs）。这是一个生物信息学中的核心技能，让你能够从DNA序列出发，对基因调控网络进行初步探索。[@problem_id:2685179]", "problem": "您的任务是实现一个完整的、自包含的计算流程，用于在启动子序列中识别甲状腺激素反应元件 (TRE) 半位点，通过热力学占有模型预测甲状腺激素受体 (TR) 的结合，并使用报告基因分析的倍数变化数据验证这些预测。其生物学基础是：甲状腺激素 (TH; 三碘甲状腺原氨酸) 通过甲状腺激素受体 (TR) 发挥作用，TR通常与维甲酸X受体 (RXR) 形成异源二聚体，并结合到TREs处的DNA上。TREs由两个类AGGTCA半位点以直接重复序列的形式组成，其优选的间隔区为DR$4$（间隔长度为$4$的直接重复序列）。在两栖动物中，未结合配体的TR具有抑制作用，而在变态发育过程中，结合了配体的TR则具有激活作用。\n\n从以下公认的原则和定义开始：\n- DNA结合特异性可以通过位置权重矩阵 (PWM) 进行建模。该矩阵为长度为6个碱基的半位点提供一个相对于背景核苷酸频率的对数几率分数 $w$。对于一个半位点 $x_1 x_2 \\ldots x_6$，其对数几率分数为 $w = \\sum_{k=1}^{6} \\ln\\left(\\frac{P_{k,x_k}}{b(x_k)}\\right)$，其中 $P_{k,x}$ 是在PWM中位置 $k$ 处碱基 $x$ 出现的概率，而 $b(x)$ 是背景频率。\n- 一个TR/RXR位点被建模为一对呈直接重复方向的半位点，其间隔区长度 $n \\in \\{0,1,2,3,4,5,6\\}$，并对DR$4$有强偏好。对于一个总半位点分数为 $S = w_1 + w_2$、间隔区长度为 $n$ 的位点对，其有效结合自由能（以热能单位 $k_B T$ 计）被建模为\n$$\n\\Delta G = G_0 - \\lambda S + \\delta (n-4)^2,\n$$\n其中 $G_0$ 是一个偏移量，$\\lambda$ 用于缩放亲和力与分数的关系，$\\delta$ 对偏离DR$4$的情况进行惩罚。\n- 在一个化学势为 $\\mu$ 的热力学占有模型中，启动子中最强位点的结合概率为\n$$\np = \\frac{1}{1 + \\exp\\left(\\Delta G - \\mu\\right)}.\n$$\n- 假设TR的占有率不依赖于配体状态，但转录输出依赖于配体状态，那么在没有TH（未结合配体的TR，抑制性）的情况下，报告基因的表达量为\n$$\nE_{\\mathrm{off}} = E_0 (1 - p) + E_{\\mathrm{rep}} p,\n$$\n在有饱和TH（结合配体的TR，激活性）的情况下，表达量为\n$$\nE_{\\mathrm{on}} = E_0 (1 - p) + E_{\\mathrm{act}} p.\n$$\n预测的倍数变化是\n$$\nF = \\frac{E_{\\mathrm{on}}}{E_{\\mathrm{off}}}.\n$$\n如果 $F \\ge \\Theta$，则报告基因被分类为阳性，阈值 $\\Theta$ 在下文指定。\n\n您的程序必须以链感知的方式实现以下步骤：\n1. 扫描正向序列及其反向互补序列。\n2. 在每条链上，为每个6-mer窗口计算PWM对数几率分数 $w$。\n3. 对于每个允许的间隔区长度 $n \\in \\{0,1,2,3,4,5,6\\}$，计算所有由同一条链上间隔 $n$ 个碱基的两个6-mer组成的直接重复对。对于每对，计算 $S$，然后计算 $\\Delta G$，并在两条链上选择具有最小 $\\Delta G$（即最强预测结合）的位点对。\n4. 为最强位点计算 $p$、$E_{\\mathrm{off}}$、$E_{\\mathrm{on}}$ 和 $F$。\n5. 如果 $F \\ge \\Theta$，则将该启动子预测分类为阳性。\n6. 使用相同的阈值 $\\Theta$ 将预测的分类与测量的报告基因倍数变化数据进行比较，以得出验证准确率。\n\n使用以下固定参数：\n- 背景频率：$b(A)=b(C)=b(G)=b(T)=0.25$。\n- 类AGGTCA半位点的PWM概率 $P_{k,x}$（行是位置 $k \\in \\{1,\\ldots,6\\}$；列是按A,C,G,T顺序排列的碱基）：\n$$\n\\begin{bmatrix}\n0.75  0.07  0.13  0.05 \\\\\n0.03  0.04  0.90  0.03 \\\\\n0.05  0.05  0.85  0.05 \\\\\n0.05  0.05  0.05  0.85 \\\\\n0.03  0.90  0.04  0.03 \\\\\n0.80  0.05  0.10  0.05 \\\\\n\\end{bmatrix}\n$$\n- 能量和表达参数：$G_0 = 8.0$，$\\lambda = 1.0$，$\\delta = 8.0$，$\\mu = 0.0$，$E_0 = 1.0$，$E_{\\mathrm{rep}} = 0.5$，$E_{\\mathrm{act}} = 1.8$，$\\Theta = 1.5$。\n- 角度单位不适用。无需进行物理单位转换。所有报告的数值输出必须四舍五入到恰好三位小数。\n\n测试套件：\n提供以下启动子序列（大写DNA，正向链）和测量的报告基因倍数变化（定义为实验中的 $E_{\\mathrm{on}}/E_{\\mathrm{off}}$），用以验证预测。程序必须将序列视为纯字符串，并且不得要求任何外部输入。\n\n- 案例 1：序列 = \"GCTAGCAGGTCATTTTAGGTCACGATCGTACGATCGATCG\"，测量的倍数变化 = $3.000$。\n- 案例 2：序列 = \"TTTAGGTCATTTAGGTCAGGCGTACGATC\"，测量的倍数变化 = $1.300$。\n- 案例 3：序列 = \"ACACACGTATATGCGTATACGCGTATATGCGTATAC\"，测量的倍数变化 = $1.000$。\n- 案例 4：序列 = \"GATCTGACCTAAAATGACCTGAGGCTAGC\"，测量的倍数变化 = $2.200$。\n- 案例 5：序列 = \"GGGAGGACATTTTAGGACAGGGTT\"，测量的倍数变化 = $1.600$。\n\n输出规格：\n- 对于案例1到5，按顺序为上文定义的最强位点计算预测的倍数变化 $F$，并四舍五入到三位小数。\n- 计算验证准确率，即预测分类（使用阈值 $\\Theta$）与测量分类（使用相同阈值 $\\Theta$）相匹配的案例所占的比例，四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的6个条目是5个预测的倍数变化，后跟准确率，例如 $[F_1,F_2,F_3,F_4,F_5,{\\mathrm{acc}}]$，其中每个符号表示一个四舍五入到三位小数的十进制数。", "solution": "所提供的问题是计算生物学中一个有效的、适定的且有科学依据的练习。它要求实现一个标准的生物信息学流程来预测转录因子的结合及其对基因表达的影响。所有必要的组成部分，包括数学模型、参数和测试数据，都已明确指定。该问题是自包含的，没有科学或逻辑上的矛盾。因此，我将继续提供一个完整的解决方案。\n\n解决方案的核心是实现一个计算过程，该过程系统地评估给定DNA启动子序列中所有潜在的甲状腺激素受体 (TR) 结合位点，根据指定的能量函数识别出最强的结合位点，然后使用热力学占有模型和两态表达模型预测转录倍数变化。\n\n每个启动子序列的整体处理过程可以分解为以下步骤：\n\n1.  **预处理与参数化**：使用位置权重矩阵 (PWM) 概率 $P_{k,x}$ 和背景核苷酸频率 $b(x)$ 来构建一个对数几率评分矩阵。这个我将表示为 $M$ 的矩阵，其元素为 $M_{k,x} = \\ln\\left(\\frac{P_{k,x}}{b(x_k)}\\right)$。由于背景频率是均匀的 ($b(A)=b(C)=b(G)=b(T)=0.25$)，这可以简化为 $M_{k,x} = \\ln(P_{k,x}) - \\ln(0.25) = \\ln(P_{k,x}) + \\ln(4)$。预先计算这个 $6 \\times 4$ 矩阵可以高效地对所有6碱基对 (6-mer) 序列进行评分。同时，也建立一个从DNA碱基（'A', 'C', 'G', 'T'）到矩阵索引（$0, 1, 2, 3$）的映射。\n\n2.  **链感知分析**：问题要求进行“链感知”分析。这意味着整个过程必须在提供的DNA序列的正向链及其反向互补链上都执行一遍。反向互补链是通过反转序列字符串并将每个碱基替换为其互补碱基（A↔T, C↔G）来生成的。启动子的最终结果由在这两条链上找到的最强结合位点决定。\n\n3.  **半位点评分**：对于给定的链（正向链或反向互补链），我们必须识别所有潜在的半位点。一个半位点是序列中任意一个长度为6的子串 (6-mer)。对于序列中每个位置 $i$ 开始的6-mer $x_1x_2\\ldots x_6$，其对数几率分数 $w_i$ 计算为 $w_i = \\sum_{k=1}^{6} M_{k,x_k}$。这些分数将被存储起来，用于所有可能的半位点。\n\n4.  **识别最强结合位点**：一个完整的TR/RXR结合位点（一个甲状腺激素反应元件，或TRE）被建模为两个半位点的直接重复。我们必须搜索所有这样的位点对。一个位点对由同一条链上两个半位点的起始位置 $i$ 和 $j$ 定义。对于直接重复，$j = i + 6 + n$，其中 $n$ 是间隔序列的长度。问题指定我们测试间隔长度 $n \\in \\{0, 1, 2, 3, 4, 5, 6\\}$。对于每个有效的半位点对（其分数为 $w_i$ 和 $w_j$，间隔长度为 $n$），总分数为 $S = w_i + w_j$。然后使用提供的公式计算结合自由能 $\\Delta G$：\n    $$\n    \\Delta G = G_0 - \\lambda S + \\delta (n-4)^2\n    $$\n    在这里，$\\delta(n-4)^2$ 项惩罚了偏离优选长度 $n=4$ 的间隔。算法必须找到（在所有可能的起始位置 $i$ 和所有允许的间隔长度 $n$ 中）能产生最小 $\\Delta G$ 的半位点对。这个最小能量 $\\Delta G_{\\min}$ 对应于该链上预测的最强结合位点。\n\n5.  **预测转录倍数变化**：比较来自正向链 ($\\Delta G_{\\min, \\text{fwd}}$) 和反向互补链 ($\\Delta G_{\\min, \\text{rev}}$) 的最小自由能，并取其总体最小值：$\\Delta G_{\\text{best}} = \\min(\\Delta G_{\\min, \\text{fwd}}, \\Delta G_{\\min, \\text{rev}})$。如果在某个序列上无法形成有效的直接重复对（例如，序列太短），则其 $\\Delta G_{\\min}$ 被视为无穷大。使用 $\\Delta G_{\\text{best}}$，通过热力学占有模型计算TR结合到这个最强位点的概率 $p$：\n    $$\n    p = \\frac{1}{1 + \\exp(\\Delta G_{\\text{best}} - \\mu)}\n    $$\n    利用这个占有概率，有和没有甲状腺激素(TH)时的表达水平被建模为：\n    $$\n    E_{\\mathrm{off}} = E_0 (1 - p) + E_{\\mathrm{rep}} p\n    $$\n    $$\n    E_{\\mathrm{on}} = E_0 (1 - p) + E_{\\mathrm{act}} p\n    $$\n    预测的倍数变化 $F$ 是这些表达水平的比率：\n    $$\n    F = \\frac{E_{\\mathrm{on}}}{E_{\\mathrm{off}}}\n    $$\n    对每个测试案例计算该值，并四舍五入到三位小数。\n\n6.  **模型验证**：最后一步是验证模型的预测能力。对于每个测试案例，使用预测的倍数变化 $F$ 将启动子分类为“阳性”（如果 $F \\geq \\Theta$）或“阴性”（如果 $F  \\Theta$）。然后将这个预测分类与通过对提供的实验倍数变化数据应用相同阈值 $\\Theta$ 得出的“测量分类”进行比较。验证准确率是预测分类与测量分类相匹配的测试案例所占的比例。这个准确率值也四舍五入到三位小数。\n\n整个过程被封装在一个单一的、自包含的Python程序中，该程序处理五个提供的测试案例，并以指定的格式输出五个预测的倍数变化和最终的验证准确率。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a computational pipeline to identify TREs, predict TR binding,\n    and validate predictions against reporter assay data.\n    \"\"\"\n    \n    # Define fixed parameters from the problem statement.\n    # PWM probabilities for AGGTCA-like half-site (A, C, G, T)\n    pwm_probs = np.array([\n        [0.75, 0.07, 0.13, 0.05],\n        [0.03, 0.04, 0.90, 0.03],\n        [0.05, 0.05, 0.85, 0.05],\n        [0.05, 0.05, 0.05, 0.85],\n        [0.03, 0.90, 0.04, 0.03],\n        [0.80, 0.05, 0.10, 0.05],\n    ])\n    \n    # Background nucleotide frequencies\n    background_freq = 0.25\n    \n    # Energy and expression model parameters\n    G0 = 8.0\n    lam = 1.0\n    delta = 8.0\n    mu = 0.0\n    E0 = 1.0\n    E_rep = 0.5\n    E_act = 1.8\n    Theta = 1.5\n    \n    # Test suite: (Sequence, Measured Fold Change)\n    test_cases = [\n        (\"GCTAGCAGGTCATTTTAGGTCACGATCGTACGATCGATCG\", 3.000),\n        (\"TTTAGGTCATTTAGGTCAGGCGTACGATC\", 1.300),\n        (\"ACACACGTATATGCGTATACGCGTATATGCGTATAC\", 1.000),\n        (\"GATCTGACCTAAAATGACCTGAGGCTAGC\", 2.200),\n        (\"GGGAGGACATTTTAGGACAGGGTT\", 1.600),\n    ]\n\n    # --- Helper Functions ---\n    \n    # Base to index mapping\n    base_map = {'A': 0, 'C': 1, 'G': 2, 'T': 3}\n    \n    # Pre-compute the log-odds PWM\n    log_pwm = np.log(pwm_probs / background_freq)\n\n    def get_reverse_complement(seq):\n        \"\"\"Computes the reverse complement of a DNA sequence.\"\"\"\n        complement_map = {'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C'}\n        return \"\".join(complement_map.get(base, 'N') for base in reversed(seq))\n\n    def get_min_delta_g_for_strand(sequence):\n        \"\"\"\n        Calculates the minimum binding free energy (Delta G) for a single DNA strand.\n        \"\"\"\n        seq_len = len(sequence)\n        half_site_len = 6\n        \n        # A sequence must be long enough for at least one DR with n=0.\n        if seq_len  2 * half_site_len:\n            return float('inf')\n\n        # 1. Compute scores for all 6-mer half-sites\n        half_site_scores = np.full(seq_len, -np.inf, dtype=np.float64)\n        for i in range(seq_len - half_site_len + 1):\n            kmer = sequence[i:i+half_site_len]\n            if all(base in base_map for base in kmer):\n                score = sum(log_pwm[j, base_map[base]] for j, base in enumerate(kmer))\n                half_site_scores[i] = score\n\n        # 2. Find the DR pair with the minimum Delta G\n        min_delta_g = float('inf')\n        allowed_spacers = range(7)  # n in {0, 1, ..., 6}\n\n        for n in allowed_spacers:\n            # Iterate through possible start positions of the first half-site\n            max_i = seq_len - (2 * half_site_len + n)\n            if max_i  0:\n                continue\n\n            for i in range(max_i + 1):\n                j = i + half_site_len + n\n                \n                w1 = half_site_scores[i]\n                w2 = half_site_scores[j]\n\n                # Skip if either half-site score is invalid\n                if np.isneginf(w1) or np.isneginf(w2):\n                    continue\n\n                S = w1 + w2\n                delta_g = G0 - lam * S + delta * ((n - 4)**2)\n\n                if delta_g  min_delta_g:\n                    min_delta_g = delta_g\n        \n        return min_delta_g\n\n    # --- Main Logic ---\n\n    predicted_fold_changes = []\n    correct_predictions = 0\n\n    for seq, measured_fc in test_cases:\n        # 1. Analyze both forward and reverse complement strands\n        rev_comp_seq = get_reverse_complement(seq)\n        \n        delta_g_fwd = get_min_delta_g_for_strand(seq)\n        delta_g_rev = get_min_delta_g_for_strand(rev_comp_seq)\n        \n        # 2. Select the best site (minimum Delta G) across both strands\n        best_delta_g = min(delta_g_fwd, delta_g_rev)\n        \n        # 3. Calculate predicted fold change (F)\n        if np.isinf(best_delta_g):\n            # No valid binding sites found, occupancy is 0.\n            p = 0.0\n        else:\n            p = 1.0 / (1.0 + np.exp(best_delta_g - mu))\n        \n        E_off = E0 * (1.0 - p) + E_rep * p\n        E_on = E0 * (1.0 - p) + E_act * p\n        \n        # Avoid division by zero, though model parameters make it unlikely.\n        predicted_fc = E_on / E_off if E_off != 0 else 1.0\n        predicted_fold_changes.append(predicted_fc)\n        \n        # 4. Compare predicted classification to measured classification for accuracy\n        predicted_is_positive = (predicted_fc >= Theta)\n        measured_is_positive = (measured_fc >= Theta)\n        \n        if predicted_is_positive == measured_is_positive:\n            correct_predictions += 1\n            \n    # Calculate validation accuracy\n    accuracy = correct_predictions / len(test_cases)\n    \n    # Combine results and format for output\n    final_results = predicted_fold_changes + [accuracy]\n    \n    # Format the final output string exactly as specified\n    output_str = \"[\" + \",\".join(f\"{x:.3f}\" for x in final_results) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2685179"}, {"introduction": "在预测了TR的结合位点后，下一步是验证其功能并理解其作用机制。本实践模拟了对真实世界基因组学数据（ChIP-seq和RNA-seq）的分析，旨在定量检验TR结合位点上辅因子交换的核心假说，并探究其与基因表达变化之间的关联。通过这个练习，你将学会如何从高通量数据中提取有意义的生物学洞见。[@problem_id:2685193]", "problem": "给定两栖动物中，在用甲状腺激素三碘甲状腺原氨酸 (T3) 处理前后，于尾部特异性甲状腺激素响应元件 (TREs) 处测得的核受体共抑制因子 (NCoR) 和组蛋白乙酰转移酶 p300 的概念化染色质免疫沉淀测序 (ChIP-seq) 占有数据，以及推定的靶基因的匹配核糖核酸测序 (RNA-seq) 表达计数。从发育生物学的角度来看，一个经过充分验证的观察是：在没有配体的情况下，TREs 上的甲状腺激素受体 (TR) 会招募像 NCoR 这样的共抑制因子；而在与 T3 结合后，TR 会将共抑制因子交换为像 p300 这样的共激活因子，这倾向于增加靶基因的转录。您的任务是形式化并计算一个定量的辅因子交换倍数变化，并将其与表达变化进行关联。\n\n从以下基本依据出发：\n- 在没有配体的情况下，TR 结合的基因倾向于招募共抑制因子，转录活性较低；在配体结合后，TR 结合的基因倾向于招募共激活因子，并增加转录。\n- ChIP-seq 读段密度衍生的占有率是因子在调控 DNA 上结合的一个代理指标。\n- RNA-seq 读段计数（或归一化计数）为基因表达提供了一个代理指标。\n\n为每个索引为 $i$ 的 TRE-基因对定义以下输入：\n- T3 处理前 NCoR 的占有率：$R^{N,\\mathrm{pre}}_i$。\n- T3 处理后 NCoR 的占有率：$R^{N,\\mathrm{post}}_i$。\n- T3 处理前 p300 的占有率：$R^{P,\\mathrm{pre}}_i$。\n- T3 处理后 p300 的占有率：$R^{P,\\mathrm{post}}_i$。\n- T3 处理前 RNA-seq 的表达量：$E^{\\mathrm{pre}}_i$。\n- T3 处理后 RNA-seq 的表达量：$E^{\\mathrm{post}}_i$。\n\n为获得数值稳定的比率，使用一个固定的伪计数 $\\epsilon = 0.5$。对每个 $i$ 定义：\n- 辅因子交换倍数变化（比率的对数比率）：\n$$\nX_i \\equiv \\log_2\\!\\left(\\frac{\\frac{R^{P,\\mathrm{post}}_i + \\epsilon}{R^{N,\\mathrm{post}}_i + \\epsilon}}{\\frac{R^{P,\\mathrm{pre}}_i + \\epsilon}{R^{N,\\mathrm{pre}}_i + \\epsilon}}\\right)\n= \\log_2\\!\\left(\\frac{\\left(R^{P,\\mathrm{post}}_i + \\epsilon\\right)\\left(R^{N,\\mathrm{pre}}_i + \\epsilon\\right)}{\\left(R^{N,\\mathrm{post}}_i + \\epsilon\\right)\\left(R^{P,\\mathrm{pre}}_i + \\epsilon\\right)}\\right).\n$$\n- 表达变化（对数倍数变化）：\n$$\nY_i \\equiv \\log_2\\!\\left(\\frac{E^{\\mathrm{post}}_i + \\epsilon}{E^{\\mathrm{pre}}_i + \\epsilon}\\right).\n$$\n\n在一个测试用例的一组 $n$ 个 TRE-基因对上，计算：\n- $\\{X_i\\}_{i=1}^n$ 和 $\\{Y_i\\}_{i=1}^n$ 之间的皮尔逊相关系数：\n$$\nr \\equiv \\frac{\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sqrt{\\sum_{i=1}^n (X_i - \\bar{X})^2}\\,\\sqrt{\\sum_{i=1}^n (Y_i - \\bar{Y})^2}},\n$$\n其中 $\\bar{X}$ 和 $\\bar{Y}$ 是算术平均值。如果 $\\{X_i\\}$ 或 $\\{Y_i\\}$ 的任一方差为零（分母将为零），则根据本任务的约定，定义 $r \\equiv 0$。\n- $\\{X_i\\}$ 的算术平均值：\n$$\n\\mu_X \\equiv \\frac{1}{n}\\sum_{i=1}^n X_i.\n$$\n- $\\{X_i\\}$ 的总体标准差：\n$$\n\\sigma_X \\equiv \\sqrt{\\frac{1}{n}\\sum_{i=1}^n (X_i - \\mu_X)^2 }.\n$$\n\n实现一个程序，对以下每个测试用例计算 $r$、$\\mu_X$ 和 $\\sigma_X$，将每个值四舍五入到 $6$ 位小数，并在单行中输出所有结果。\n\n测试套件：\n- 测试用例 1（理想情况；强辅因子交换和诱导）：\n  - $R^{N,\\mathrm{pre}} = [\\,50,\\,40,\\,30,\\,20\\,]$\n  - $R^{P,\\mathrm{pre}} = [\\,10,\\,15,\\,12,\\,8\\,]$\n  - $R^{N,\\mathrm{post}} = [\\,15,\\,10,\\,12,\\,5\\,]$\n  - $R^{P,\\mathrm{post}} = [\\,60,\\,55,\\,40,\\,30\\,]$\n  - $E^{\\mathrm{pre}} = [\\,5,\\,10,\\,8,\\,7\\,]$\n  - $E^{\\mathrm{post}} = [\\,50,\\,80,\\,40,\\,30\\,]$\n- 测试用例 2（含零的混合响应；测试伪计数处理和弱相关结构）：\n  - $R^{N,\\mathrm{pre}} = [\\,10,\\,0,\\,20,\\,5\\,]$\n  - $R^{P,\\mathrm{pre}} = [\\,10,\\,0,\\,1,\\,0\\,]$\n  - $R^{N,\\mathrm{post}} = [\\,10,\\,0,\\,5,\\,0\\,]$\n  - $R^{P,\\mathrm{post}} = [\\,10,\\,0,\\,1,\\,0\\,]$\n  - $E^{\\mathrm{pre}} = [\\,10,\\,0,\\,100,\\,5\\,]$\n  - $E^{\\mathrm{post}} = [\\,10,\\,0,\\,200,\\,0\\,]$\n- 测试用例 3（边界条件；无任何变化，零方差）：\n  - $R^{N,\\mathrm{pre}} = [\\,5,\\,5,\\,5,\\,5\\,]$\n  - $R^{P,\\mathrm{pre}} = [\\,5,\\,5,\\,5,\\,5\\,]$\n  - $R^{N,\\mathrm{post}} = [\\,5,\\,5,\\,5,\\,5\\,]$\n  - $R^{P,\\mathrm{post}} = [\\,5,\\,5,\\,5,\\,5\\,]$\n  - $E^{\\mathrm{pre}} = [\\,10,\\,10,\\,10,\\,10\\,]$\n  - $E^{\\mathrm{post}} = [\\,10,\\,10,\\,10,\\,10\\,]$\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由方括号括起来的、逗号分隔的扁平浮点数列表。该列表必须按以下顺序排列：\n$$\n[\\,r_1,\\,\\mu_{X,1},\\,\\sigma_{X,1},\\,r_2,\\,\\mu_{X,2},\\,\\sigma_{X,2},\\,r_3,\\,\\mu_{X,3},\\,\\sigma_{X,3}\\,],\n$$\n其中下标表示测试用例索引。每个浮点数必须四舍五入到 $6$ 位小数。不应打印任何额外文本。", "solution": "问题陈述已经过验证，是**有效的**。其科学依据源于分子内分泌学和发育生物学的既定原则，特别是关于甲状腺激素的作用机制。该问题在数学上是适定的，为所有量提供了明确的定义和清晰的计算目标。输入和所需计算是明确的、无矛盾的，并将一个合理的科学问题形式化为一个可解的数值任务。\n\n任务是量化甲状腺激素响应元件 (TREs) 上的辅因子交换与三碘甲状腺原氨酸 ($T_3$) 处理后靶基因表达变化之间的关系。该模型基于以下原则：\n\n$1$. 量 $X_i$ 被定义为比率的对数比率，用以衡量每个 TRE-基因对 $i$ 的辅因子交换。它由下式给出：\n$$\nX_i \\equiv \\log_2\\!\\left(\\frac{\\frac{R^{P,\\mathrm{post}}_i + \\epsilon}{R^{N,\\mathrm{post}}_i + \\epsilon}}{\\frac{R^{P,\\mathrm{pre}}_i + \\epsilon}{R^{N,\\mathrm{pre}}_i + \\epsilon}}\\right)\n$$\n这里，$R^{P}$ 和 $R^{N}$ 分别代表共激活因子 (p300) 和共抑制因子 (NCoR) 的占有率。“pre” 和 “post” 上标表示 $T_3$ 处理前后的状态。$X_i$ 的正值表示从共抑制因子主导状态 ($R^N > R^P$) 转变为共激活因子主导状态 ($R^P > R^N$)，这是 $T_3$ 与其受体结合的预期结果。使用伪计数 $\\epsilon = 0.5$ 是一种标准且必要的做法，以确保在处理可能包含零的测序实验计数数据时保持数值稳定性。\n\n$2$. 量 $Y_i$ 是相关基因 $i$ 的标准 log$_2$ 倍数变化：\n$$\nY_i \\equiv \\log_2\\!\\left(\\frac{E^{\\mathrm{post}}_i + \\epsilon}{E^{\\mathrm{pre}}_i + \\epsilon}\\right)\n$$\n其中 $E^{\\mathrm{pre}}_i$ 和 $E^{\\mathrm{post}}_i$ 是 RNA-seq 表达计数。正的 $Y_i$ 表示基因上调。\n\n$3$. 分析的核心是检验辅因子交换驱动表达变化的假设。这是通过计算一个测试用例中所有 $n$ 个基因对的 $X_i$ 值集合与 $Y_i$ 值集合之间的皮尔逊相关系数 $r$ 来完成的。\n$$\nr \\equiv \\frac{\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sqrt{\\sum_{i=1}^n (X_i - \\bar{X})^2}\\,\\sqrt{\\sum_{i=1}^n (Y_i - \\bar{Y})^2}}\n$$\n强正相关 ($r \\to 1$) 将支持该生物学模型。问题正确地指定了约定，即如果 $\\{X_i\\}$ 或 $\\{Y_i\\}$ 集合任一者表现出零方差（此时 $r$ 的分母为零），则 $r=0$。\n\n$4$. 最后，计算辅因子交换分数的均值 ($\\mu_X$) 和总体标准差 ($\\sigma_X$)，以描述整个基因集上辅因子交换过程的总体幅度和变异性。\n\n计算过程实现如下：\n首先，对于每个测试用例，将输入的占有率和表达数据列表转换为 NumPy 数组，以便进行高效的向量化计算。将伪计数 $\\epsilon$ 添加到所有数据点。然后使用 NumPy 的逐元素算术和对数函数，直接根据其定义公式计算 $X_i$ 和 $Y_i$ 值的数组。\n\n随后，计算所需的统计数据。均值 $\\mu_X$ 和总体标准差 $\\sigma_X$ 分别使用 `numpy.mean()` 和 `numpy.std()` 计算。对于皮尔逊相关系数 $r$，我们首先检查 $X$ 或 $Y$ 数组的方差是否为零。如果是，则根据问题的指令将 $r$ 设置为 $0.0$。否则，使用 `numpy.corrcoef()` 计算 $r$，该函数提供了相关系数的稳健和标准实现。\n\n对提供的三个测试用例中的每一个重复此过程。收集每个案例得到的 $r$、$\\mu_X$ 和 $\\sigma_X$ 值，四舍五入到 $6$ 位小数，并按要求格式化为单个逗号分隔的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_metrics(case_data):\n    \"\"\"\n    Computes cofactor exchange, expression change, and their statistics for a single test case.\n\n    Args:\n        case_data (tuple): A tuple containing 6 lists of numbers:\n                           R_N_pre, R_P_pre, R_N_post, R_P_post, E_pre, E_post.\n\n    Returns:\n        tuple: A tuple containing the Pearson correlation (r),\n               mean of cofactor exchange (mu_X), and\n               standard deviation of cofactor exchange (sigma_X).\n    \"\"\"\n    R_N_pre, R_P_pre, R_N_post, R_P_post, E_pre, E_post = case_data\n    epsilon = 0.5\n    \n    # Convert lists to NumPy arrays for vectorized operations.\n    R_N_pre_arr = np.array(R_N_pre, dtype=float)\n    R_P_pre_arr = np.array(R_P_pre, dtype=float)\n    R_N_post_arr = np.array(R_N_post, dtype=float)\n    R_P_post_arr = np.array(R_P_post, dtype=float)\n    E_pre_arr = np.array(E_pre, dtype=float)\n    E_post_arr = np.array(E_post, dtype=float)\n    \n    # Calculate the cofactor exchange fold-change (X)\n    # X_i = log2(((R_P_post_i + e)/(R_N_post_i + e)) / ((R_P_pre_i + e)/(R_N_pre_i + e)))\n    # X_i = log2(((R_P_post_i + e) * (R_N_pre_i + e)) / ((R_N_post_i + e) * (R_P_pre_i + e)))\n    numerator_X = (R_P_post_arr + epsilon) * (R_N_pre_arr + epsilon)\n    denominator_X = (R_N_post_arr + epsilon) * (R_P_pre_arr + epsilon)\n    X = np.log2(numerator_X / denominator_X)\n    \n    # Calculate the expression change (Y)\n    # Y_i = log2((E_post_i + e) / (E_pre_i + e))\n    Y = np.log2((E_post_arr + epsilon) / (E_pre_arr + epsilon))\n    \n    # Compute the required statistics for X\n    mu_X = np.mean(X)\n    sigma_X = np.std(X) # Population standard deviation (ddof=0 is default)\n    \n    # Compute the Pearson correlation coefficient (r)\n    # Handle the zero variance case as per the problem description.\n    if np.var(X) == 0 or np.var(Y) == 0:\n        r = 0.0\n    else:\n        # np.corrcoef returns a 2x2 matrix, we need the off-diagonal element.\n        r = np.corrcoef(X, Y)[0, 1]\n        \n    return r, mu_X, sigma_X\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        (\n            [50, 40, 30, 20],  # R_N_pre\n            [10, 15, 12, 8],   # R_P_pre\n            [15, 10, 12, 5],   # R_N_post\n            [60, 55, 40, 30],  # R_P_post\n            [5, 10, 8, 7],     # E_pre\n            [50, 80, 40, 30],  # E_post\n        ),\n        # Test case 2\n        (\n            [10, 0, 20, 5],\n            [10, 0, 1, 0],\n            [10, 0, 5, 0],\n            [10, 0, 1, 0],\n            [10, 0, 100, 5],\n            [10, 0, 200, 0],\n        ),\n        # Test case 3\n        (\n            [5, 5, 5, 5],\n            [5, 5, 5, 5],\n            [5, 5, 5, 5],\n            [5, 5, 5, 5],\n            [10, 10, 10, 10],\n            [10, 10, 10, 10],\n        ),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        r, mu_X, sigma_X = calculate_metrics(case)\n        all_results.extend([r, mu_X, sigma_X])\n\n    # Format the results to 6 decimal places and print in the specified format.\n    formatted_results = [f\"{val:.6f}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solution.\nsolve()\n\n```", "id": "2685193"}, {"introduction": "在建立了基因组范围内的相关性之后，关键是要在活体组织的复杂环境中剖析精确的分子机制。本练习挑战你设计一个精密的实验，利用嵌合体分析来区分细胞自主性（cell-autonomous）和非细胞自主性（non-cell-autonomous）效应。这是一个发育生物学中的基本问题，也是检验你是否能将理论知识转化为可验证假说的试金石。[@problem_id:2685326]", "problem": "您正在研究爪蟾 (Xenopus) 在两栖动物变态过程中的尾部退化，这一过程由甲状腺激素三碘甲状腺原氨酸 (T3) 触发。三碘甲状腺原氨酸 (T3) 会与甲状腺激素受体 (TR) 结合，TR 是一种核受体转录因子。用作起始基础的既定事实和定义如下：(i) 在具有变态能力的组织中，细胞内与 T3 结合的 TR 是激活该细胞内 T3 基因程序所必需的，而未结合配体的 TR 主要作为抑制子起作用；(ii) 在尾部退化过程中，T3 响应细胞会上调蛋白酶和趋化因子，并有巨噬细胞浸润；(iii) 细胞自主性效应是那些需要细胞自身 TR 的效应，而非细胞自主性效应则由来自其他细胞的信号（例如，旁分泌因子和细胞外基质重塑）介导，并可在有限的有效范围内短距离作用。\n\n您计划通过创建含有 TR 充足和 TR 缺陷细胞混合物的嵌合尾部，来测试 T3 对尾部退化的效应是细胞自主性的、非细胞自主性的，还是两者兼有。您将通过在双细胞期的一个卵裂球中注入针对 TR 的 CRISPR (成簇规律间隔短回文重复序列) 试剂和一种谱系示踪剂（红色荧光蛋白, RFP），来产生镶嵌型功能丧失，从而使 RFP$^{+}$ 细胞为 TR 缺陷型 ($\\mathrm{TR}^{-/-}$)，而绿色荧光蛋白 (GFP)$^{+}$ 细胞为 TR 充足型 ($\\mathrm{TR}^{+/+}$)。待动物达到变态能力后，您将施用饱和剂量的外源 T3 (具体为 $10\\,\\mathrm{nM}$) 以同步化响应，然后在 $t = 24\\,\\mathrm{h}$ 时，通过对 RFP$^{+}$ 和 GFP$^{+}$ 尾部细胞进行活化半胱天冬酶染色来量化细胞凋亡。您还可以通过改变注射时间和使用标记细胞片的显微移植技术，在 GFP$^{+}$ 组织内生成 RFP$^{+}$ ($ \\mathrm{TR}^{-/-} $) 和 GFP$^{+}$ ($ \\mathrm{TR}^{+/+} $) 细胞的小型混合斑块（特征直径 $d \\approx 20\\,\\mu\\mathrm{m}$）或大型分离区域（$d \\approx 200\\,\\mu\\mathrm{m}$），从而控制镶嵌体的空间结构。对于旁分泌信号，假设存在一个几十微米量级的有限有效范围 $\\ell$（具体为 $\\ell \\approx 50\\,\\mu\\mathrm{m}$），超出该范围，非细胞自主性因子（例如，蛋白酶或细胞因子）的影响可以忽略不计。您的读出指标将包括：(a) 在两种镶嵌结构下，$t = 24\\,\\mathrm{h}$ 时发生细胞凋亡的 GFP$^{+}$ 和 RFP$^{+}$ 细胞的比例；(b) 在大斑块条件下，RFP$^{+}$ 细胞凋亡对到最近的 GFP$^{+}$ 边界距离的依赖性；以及 (c) 在半径 $r \\approx \\ell$ 内，局部 GFP$^{+}$ 邻近细胞分数 $f$ 与 RFP$^{+}$ 细胞凋亡概率之间的关系。\n\n根据核受体信号传导和局部信号范围的基本原理，以下哪种实验设计和定量结果模式最适合用于区分细胞自主性与非细胞自主性的 T3 效应，并量化嵌合表型？请选择唯一的最佳选项。\n\nA. 实施包含 RFP$^{+}$ ($ \\mathrm{TR}^{-/-} $) 和 GFP$^{+}$ ($ \\mathrm{TR}^{+/+} $) 细胞的小斑块（$d \\ll \\ell$）和大斑块（$d \\gg \\ell$）两种镶嵌体，并在 $t = 24\\,\\mathrm{h}$ 时测量细胞凋亡作为局部邻近细胞组成的函数。预测在饱和 T3 条件下：在全 GFP 尾部中，GFP$^{+}$ 细胞凋亡率约为 $\\approx 80\\%$；在全 RFP 尾部中，RFP$^{+}$ 细胞凋亡率接近基线水平 $\\approx 5\\%$；在小斑块镶嵌体中（各处典型的 $f \\approx 0.5$），RFP$^{+}$ 细胞凋亡率增加到 $\\approx 40\\%$，而 GFP$^{+}$ 细胞凋亡率保持在 $\\approx 80\\%$；在大斑块镶嵌体中，距离 GFP$^{+}$ 边界深度超过 $\\ell$ 的 RFP$^{+}$ 细胞凋亡率保持在 $\\approx 5\\%$ 附近，而距离 GFP$^{+}$ 边界在 $\\ell$ 范围内的 RFP$^{+}$ 细胞则显示出随局部 $f$ 值近似线性的增加，在 $f \\approx 0.5$ 时达到 $\\approx 40\\%$。在小斑块镶嵌体中（$f \\approx 0.5$ 时）定义一个细胞自主性指数 $A = 1 - \\dfrac{P_{\\mathrm{RFP}}}{P_{\\mathrm{GFP}}}$，得出 $A \\approx 0.5$，这与细胞自主性和非细胞自主性混合成分相符。\n\nB. 仅使用小斑块（$d \\ll \\ell$）镶嵌体，并在 $t = 48\\,\\mathrm{h}$ 内评估整体尾长退缩情况，不进行单细胞读出。预测由于 T3 是全身性存在的，GFP$^{+}$ 和 RFP$^{+}$ 细胞都将经历相似的细胞凋亡率 $\\approx 80\\%$，并且 RFP$^{+}$ 细胞的比例对退缩斜率没有可测量的影响。\n\nC. 生成大斑块（$d \\gg \\ell$）镶嵌体，但仅分析 RFP$^{+}$ 岛内部（距离任何边界 $$ $\\ell$）的细胞凋亡。预测非细胞自主性效应占主导地位，因此即使与 GFP$^{+}$ 细胞的距离远大于 $\\ell$，RFP$^{+}$ 细胞的凋亡率也约为 $\\approx 80\\%$，并由此得出结论：细胞内的 TR 对于尾部退化是可有可无的。\n\nD. 实施小斑块（$d \\ll \\ell$）镶嵌体，并清除巨噬细胞以消除非细胞自主性效应，然后从不变的 RFP$^{+}$ 细胞凋亡率中推断细胞自主性。预测在饱和 T3 且没有巨噬细胞的情况下，RFP$^{+}$ 细胞凋亡率仍将约为 $\\approx 40\\%$，GFP$^{+}$ 约为 $\\approx 80\\%$，与局部 $f$ 无关，这表明即使移除了旁分泌源，部分非细胞自主性仍然存在。", "solution": "问题陈述要求设计并解释一个实验，以剖析两栖动物尾部退化过程中甲状腺激素 ($T_3$) 信号传导的细胞自主性与非细胞自主性效应。必须首先评估问题陈述的有效性。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **生物系统：** *爪蟾*在变态过程中的尾部退化。\n*   **诱导剂：** 饱和剂量的三碘甲状腺原氨酸 ($T_3$)，$10\\,\\mathrm{nM}$。\n*   **核心机制：** $T_3$ 与甲状腺激素受体 (TR) 结合，TR 是一种核转录因子。\n*   **原理 (i)：** 细胞内在响应需要同一细胞内与 $T_3$ 结合的 TR 来激活变态基因程序。未结合配体的 TR 是抑制子。这定义了细胞自主性作用的基础。\n*   **原理 (ii)：** $T_3$ 响应细胞产生蛋白酶和趋化因子，并有巨噬细胞浸润。这为非细胞自主性信号提供了来源。\n*   **定义 (iii)：** 细胞自主性效应需要细胞自身的 TR。非细胞自主性效应由来自其他细胞的信号介导，具有有限的有效范围 $\\ell$。\n*   **实验模型：** 含有 TR 充足（$\\mathrm{TR}^{+/+}$，GFP$^{+}$）和 TR 缺陷（$\\mathrm{TR}^{-/-}$，RFP$^{+}$）细胞的嵌合尾部。\n*   **空间结构：** 1. 特征直径 $d \\approx 20\\,\\mu\\mathrm{m}$ 的小型混合斑块。2. 特征直径 $d \\approx 200\\,\\mu\\mathrm{m}$ 的大型分离区域。\n*   **信号长度尺度：** 非细胞自主性因子的有效范围为 $\\ell \\approx 50\\,\\mu\\mathrm{m}$。注意，对于小斑块，$d \\ll \\ell$；对于大斑块，$d \\gg \\ell$。\n*   **主要读出指标：** $T_3$ 处理后 $t = 24\\,\\mathrm{h}$ 时通过活化半胱天冬酶染色量化的细胞凋亡。\n*   **定量读出指标：** (a) 在两种镶嵌结构下 GFP$^{+}$ 和 RFP$^{+}$ 细胞的凋亡比例。(b) 对于大斑块，RFP$^{+}$ 细胞凋亡作为到 GFP$^{+}$ 边界距离的函数。(c) RFP$^{+}$ 细胞凋亡作为半径 $r \\approx \\ell$ 内局部 GFP$^{+}$ 邻近细胞分数 ($f$) 的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n\n问题陈述在科学上是合理的、提法得当且内部一致。\n1.  **科学依据：** 所描述的甲状腺激素作用机制、其在变态中的作用、细胞自主性和非细胞自主性的概念，以及实验技术（CRISPR 镶嵌体、谱系示踪）在现代发育生物学中都是标准且成熟的。\n2.  **提法得当：** 问题的结构旨在得出一个明确的答案。关键在于两种长度尺度的比较：基因斑块的大小（$d$）和旁分泌因子的信号范围（$\\ell$）。通过创建 $d \\ll \\ell$ 和 $d \\gg \\ell$ 的条件，可以创造出不同的环境来分离和观察细胞自主性与非细胞自主性效应。\n3.  **客观性和完整性：** 问题以精确的定量术语（$d$、$\\ell$、浓度、时间点）陈述。所有必要的信息都已提供，可以从第一性原理出发对实验结果进行推理。没有矛盾之处。\n\n**步骤3：结论与行动**\n\n该问题是有效的。将进入解答阶段。\n\n### 解答推导\n\n核心任务是根据所提供的原理区分两种效应。\n\n1.  **细胞自主性效应：** 根据原理 (i)，一个细胞启动 $T_3$ 响应程序的能力由其自身的基因型决定。一个 $\\mathrm{TR}^{+/+}$ (GFP$^{+}$) 细胞可以响应 $T_3$。一个 $\\mathrm{TR}^{-/-}$ (RFP$^{+}$) 细胞不能。在孤立状态下，一个 $\\mathrm{TR}^{-/-}$ 细胞不会因响应 $T_3$ 而发生细胞凋亡。\n\n2.  **非细胞自主性效应：** 根据原理 (ii)，响应的 $\\mathrm{TR}^{+/+}$ 细胞会分泌能够影响其邻近细胞的因子（蛋白酶、趋化因子）。这种效应具有有限的空间范围 $\\ell$。因此，如果一个不响应的 $\\mathrm{TR}^{-/-}$ 细胞距离一个响应的 $\\mathrm{TR}^{+/+}$ 细胞足够近（在距离 $\\ell$ 以内），它可能会被诱导发生细胞凋亡。\n\n这基于实验设计引出了一系列清晰的预测：\n\n*   **在对照组中：** 全-$\\mathrm{TR}^{+/+}$ 的尾部将显示出高水平且均匀的细胞凋亡（最大响应）。全-$\\mathrm{TR}^{-/-}$ 的尾部将只显示出低水平的基线细胞凋亡。\n*   **在大斑块镶嵌体中（$d \\gg \\ell$）：**\n    *   位于大斑块内部、距离任何 $\\mathrm{TR}^{+/+}$ (GFP$^{+}$) 细胞的距离大于 $\\ell$ 的 $\\mathrm{TR}^{-/-}$ (RFP$^{+}$) 细胞，将不会受到非细胞自主性信号的影响。它们的命运是纯粹细胞自主的。它们应该只表现出基线水平的细胞凋亡。\n    *   位于边界附近（距离 $\\ell$ 以内）的 $\\mathrm{TR}^{-/-}$ (RFP$^{+}$) 细胞将暴露于来自相邻 $\\mathrm{TR}^{+/+}$ 细胞的信号。它们应该表现出高于基线水平的细胞凋亡，并且很可能以一种梯度方式表现，具体取决于它们与信号源的接近程度。\n    *   $\\mathrm{TR}^{+/+}$ (GFP$^{+}$) 细胞无论其位置如何，都将表现出高水平的细胞凋亡，因为它们的响应是细胞自主的。\n*   **在小斑块镶嵌体中（$d \\ll \\ell$）：**\n    *   由于斑块大小 $d$ 远小于信号范围 $\\ell$，每个细胞实际上都处于一个混合环境中。\n    *   $\\mathrm{TR}^{-/-}$ (RFP$^{+}$) 细胞将持续暴露于来自其附近 $\\mathrm{TR}^{+/+}$ 邻居的非细胞自主性信号。它们应该表现出中等水平的细胞凋亡：高于基线水平，但低于 $\\mathrm{TR}^{+/+}$ 细胞的最大响应，因为它们缺乏直接的细胞自主性通路。\n    *   $\\mathrm{TR}^{+/+}$ (GFP$^{+}$) 细胞仍将进行最大的、细胞自主性的响应。\n\n理想的实验设计必须包括大斑块和小斑块镶嵌体，以创建这些不同的信号环境，并且必须使用单细胞分辨率的读出指标来区分两种基因型的行为。\n\n### 选项评估\n\n**A. 实施包含 RFP$^{+}$ ($ \\mathrm{TR}^{-/-} $) 和 GFP$^{+}$ ($ \\mathrm{TR}^{+/+} $) 细胞的小斑块（$d \\ll \\ell$）和大斑块（$d \\gg \\ell$）两种镶嵌体，并在 $t = 24\\,\\mathrm{h}$ 时测量细胞凋亡作为局部邻近细胞组成的函数。预测在饱和 T3 条件下：在全 GFP 尾部中，GFP$^{+}$ 细胞凋亡率约为 $\\approx 80\\%$；在全 RFP 尾部中，RFP$^{+}$ 细胞凋亡率接近基线水平 $\\approx 5\\%$；在小斑块镶嵌体中（各处典型的 $f \\approx 0.5$），RFP$^{+}$ 细胞凋亡率增加到 $\\approx 40\\%$，而 GFP$^{+}$ 细胞凋亡率保持在 $\\approx 80\\%$；在大斑块镶嵌体中，距离 GFP$^{+}$ 边界深度超过 $\\ell$ 的 RFP$^{+}$ 细胞凋亡率保持在 $\\approx 5\\%$ 附近，而距离 GFP$^{+}$ 边界在 $\\ell$ 范围内的 RFP$^{+}$ 细胞则显示出随局部 $f$ 值近似线性的增加，在 $f \\approx 0.5$ 时达到 $\\approx 40\\%$。在小斑块镶嵌体中（$f \\approx 0.5$ 时）定义一个细胞自主性指数 $A = 1 - \\dfrac{P_{\\mathrm{RFP}}}{P_{\\mathrm{GFP}}}$，得出 $A \\approx 0.5$，这与细胞自主性和非细胞自主性混合成分相符。**\n该选项提出了一个堪称典范的实验设计。它正确地提议使用大斑块和小斑块两种镶嵌体来探究不同的信号机制。预测的定量结果与从第一性原理进行的逻辑推导完全一致：GFP$^{+}$ 细胞中的最大响应（$\\approx 80\\%$），孤立的 RFP$^{+}$ 细胞中的基线响应（$\\approx 5\\%$），以及暴露于邻近细胞的 RFP$^{+}$ 细胞中的中等、被“拯救”的响应（$\\approx 40\\%$）。预测的大斑块边界附近的细胞凋亡梯度也是正确的。所提出的细胞自主性指数 $A$ 是量化此类现象的标准方法，其中 $A=1$ 表示纯粹的细胞自主性，而 $A=0$ 表示纯粹的非细胞自主性。计算出的值 $A = 1 - (40/80) = 0.5$ 正确地反映了混合贡献。\n**结论：** **正确**。\n\n**B. 仅使用小斑块（$d \\ll \\ell$）镶嵌体，并在 $t = 48\\,\\mathrm{h}$ 内评估整体尾长退缩情况，不进行单细胞读出。预测由于 T3 是全身性存在的，GFP$^{+}$ 和 RFP$^{+}$ 细胞都将经历相似的细胞凋亡率 $\\approx 80\\%$，并且 RFP$^{+}$ 细胞的比例对退缩斜率没有可测量的影响。**\n该选项存在缺陷。首先，实验设计不充分。像尾长这样的全局读出指标无法区分不同细胞类型的贡献，使得 GFP$^{+}$/RFP$^{+}$ 标记变得无用。仅依赖小斑块镶嵌体无法分离出纯粹的细胞自主性效应，而这在大斑块中心是可能实现的。其次，预测 RFP$^{+}$ 细胞的凋亡率将达到 $\\approx 80\\%$ 是不正确的；它假设了完美的非细胞自主性拯救，这忽略了细胞自身的 TR 对于完全响应的必要性（原理 i）。\n**结论：** **不正确**。\n\n**C. 生成大斑块（$d \\gg \\ell$）镶嵌体，但仅分析 RFP$^{+}$ 岛内部（距离任何边界 $$ $\\ell$）的细胞凋亡。预测非细胞自主性效应占主导地位，因此即使与 GFP$^{+}$ 细胞的距离远大于 $\\ell$，RFP$^{+}$ 细胞的凋亡率也约为 $\\approx 80\\%$，并由此得出结论：细胞内的 TR 对于尾部退化是可有可无的。**\n该选项包含一个根本性的矛盾。它声称非细胞自主性效应“占主导”，但又预测其作用距离远大于 $\\ell$（$\\gg \\ell$），这违反了给定的有限信号范围 $\\ell$ 的定义。这在逻辑上是不一致的。一个只分析大 RFP$^{+}$ 斑块内部的实验，恰恰是非细胞自主性效应应该*缺失*的条件，因此 RFP$^{+}$ 细胞凋亡应处于基线水平。因此，其预测和随后的结论都基于有缺陷的推理。\n**结论：** **不正确**。\n\n**D. 实施小斑块（$d \\ll \\ell$）镶嵌体，并清除巨噬细胞以消除非细胞自主性效应，然后从不变的 RFP$^{+}$ 细胞凋亡率中推断细胞自主性。预测在饱和 T3 且没有巨噬细胞的情况下，RFP$^{+}$ 细胞凋亡率仍将约为 $\\approx 40\\%$，GFP$^{+}$ 约为 $\\approx 80\\%$，与局部 $f$ 无关，这表明即使移除了旁分泌源，部分非细胞自主性仍然存在。**\n该选项构思不佳。虽然清除巨噬细胞是测试非细胞自主性信号*来源*的有效实验，但该选项将其作为区分自主性与非自主性的主要方法，而事实并非如此。预测移除一个关键的潜在旁分泌源（巨噬细胞）对非细胞自主性拯救*没有影响*（RFP$^{+}$ 细胞凋亡率仍为 $\\approx 40\\%$）是反直觉的。此外，其结论是荒谬的：它声称通过显示在移除其假定来源后效应依然存在来证明非细胞自主性。这在逻辑上不成立。\n**结论：** **不正确**。", "answer": "$$\\boxed{A}$$", "id": "2685326"}]}