{"hands_on_practices": [{"introduction": "系统发育树的寻根是推断进化历史的关键一步，而外群（outgroup）的选择对此至关重要。一个不当的选择，尤其是使用一个演化距离很远的外群，可能会人为地将一个内群（ingroup）中具有长枝的分类单元吸引过来，导致因长枝吸引（Long-branch Attraction, LBA）而产生的错误寻根。本练习 [@problem_id:2729142] 旨在探讨不同的外群取样策略如何可能诱发或缓解这一众所周知的系统发育重建假象。", "problem": "您正在分析一个包含 $N$ 个独立同分布的核苷酸位点的数据集，这些位点是在 Jukes and Cantor 替换模型 (JC$69$) 下生成的，具有相等的碱基频率和同质、平稳的过程。考虑一个由 $3$ 个分类单元 $\\{A,B,C\\}$ 组成的内群，其真实的定根历史为 $((A,B),C)$，并具有以下枝长（每个位点的预期替换数）：末端枝 $t_A = 0.10$、$t_B = 0.10$、$t_C = 1.80$，以及一个短的内群内部枝 $t_I = 0.05$。您必须选择如何使用外群对内群进行定根，然后使用最大简约法 (MP) 推断有根拓扑，根据定义，该方法会选择具有最小总隐含替换数的拓扑，并且当 $N \\to \\infty$ 时，其简约分数会收敛到预期值。\n\n考虑以下三种连接在内群根部的外群取样策略：\n\n- 策略 $O_1$：一个单一的远缘外群末端，从内群根部到该外群末端的枝长为 $t_{O_1} = 2.00$。\n- 策略 $O_2$：一个单一的近缘外群末端，从内群根部到该外群末端的枝长为 $t_{O_2} = 0.15$。\n- 策略 $O_3$：两个近缘外群 $O_2$ 和 $O_3$ 形成一个演化支：一个长度为 $t_S = 0.05$ 的短柄枝连接着两个末端外群枝 $t_{O_2} = 0.15$ 和 $t_{O_3} = 0.15$。\n\n假设模型误设的唯一来源是在 JC$69$ 生成的数据上使用 MP；不存在位点间速率变异和成分异质性。此处，长枝吸引 (LBA) 定义为最大简约法 (MP) 因趋同替换而倾向于将两个长而不相邻的枝组合在一起，通过将分类单元 $C$ 与外群联合而不是恢复真实的内群演化支 $(A,B)$ 来导致错误的定根。\n\n在这些条件下，当 $N \\to \\infty$ 时，下列关于外群选择和定根谬误的陈述中，哪些是正确的？\n\nA. 在策略 $O_1$ 下，MP 的一致性得到保证；更长的外群枝增加了明确的共衍征数量，因此最小化了 LBA 风险。\nB. 在策略 $O_2$ 下，缩短外群枝相对于 $O_1$ 降低了由 LBA 驱动的错误定根风险，因为它减少了 $C$ 和外群之间独立产生相似性（MP 会将其计为共享衍生状态）的速率。\nC. 在策略 $O_3$ 下，使用形成一个演化支的两个近缘外群，通过将外群侧的路径分解为多个短枝，进一步降低了 LBA 风险（相对于单个近缘外群），从而降低了到 $C$ 的长内群枝与外群被伪联合的可能性。\nD. 对无根内群树进行中点定根（无外群）消除了 LBA，因为将根置于最长路径的中心会自动校正谱系间的速率变异。\nE. 即使使用 JC$69$ 数据且 $N \\to \\infty$，MP 在此枝长配置下使用策略 $O_1$ 也可能在统计上不一致，通过将 $C$ 与外群分组而不是恢复 $(A,B)$ 作为内群演化支来错误地放置根。", "solution": "对用户提供的问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 位点数：$N$，独立同分布。\n- 演化模型：Jukes and Cantor $1969$ (JC$69$)，碱基频率相等，过程同质且平稳。\n- 真实有根内群拓扑：$((A,B),C)$。\n- 内群枝长（每个位点的预期替换数）：\n    - 到 A 的末端枝：$t_A = 0.10$。\n    - 到 B 的末端枝：$t_B = 0.10$。\n    - 到 C 的末端枝：$t_C = 1.80$。\n    - 内群内部枝：$t_I = 0.05$。\n- 推断方法：最大简约法 (MP)。\n- 数据大小：渐近极限，$N \\to \\infty$。\n- 用于定根的外群策略：\n    - 策略 $O_1$：单一远缘外群末端，从内群根部起的枝长为 $t_{O_1} = 2.00$。\n    - 策略 $O_2$：单一近缘外群末端，从内群根部起的枝长为 $t_{O_2} = 0.15$。\n    - 策略 $O_3$：两个近缘外群 $O_2$ 和 $O_3$ 组成一个演化支，带有一个柄枝 $t_S = 0.05$ 和两个长度为 $t_{O_2} = 0.15$ 和 $t_{O_3} = 0.15$ 的末端枝。\n- 长枝吸引 (LBA) 的定义：MP 倾向于错误地将长而不相邻的枝组合在一起，导致将分类单元 $C$ 与外群联合而不是恢复真实的内群演化支 $(A,B)$ 的错误定根。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：**该问题基于分子系统发育学的基本原理，即 JC$69$ 替换模型、最大简约法以及有充分记载的长枝吸引谬误。\n- **良态问题：**该问题在数学上和概念上都定义明确。它提供了一个真实的树、一个数据生成模型、具体的推断方法和精确的参数，从而可以对该方法的一致性进行严格分析。\n- **客观性：**问题以精确、客观的语言陈述。术语 LBA 在上下文中得到了明确定义。\n\n**步骤 3：结论与行动**\n该问题是有效的。它提出了一个经典的“Felsenstein 区”情景，旨在测试对系统发育推断中统计不一致性的理解。有必要进行全面分析。\n\n**推导与选项分析**\n\n该问题要求分析最大简约法 (MP) 在无限数据 ($N \\to \\infty$) 极限下的性能，这是一个关于统计一致性的问题。如果给定足够的数据，MP 收敛于真实拓扑，则它是一致的。如果它收敛于不正确的拓扑，则它是不一致的。\n\nMP 不一致性的主要原因是长枝吸引 (LBA)。在像 JC$69$ 这样的简单模型下，长度为 $t$ 的枝上发生碱基替换的概率是 $p(t) = \\frac{3}{4}(1 - e^{-4t/3})$。对于长枝（大的 $t$），此概率趋近于 $\\frac{3}{4}$，这意味着枝末端的性状状态相对于枝开始时的状态几乎是随机的。当真实树中的两个长枝不相邻时，每个枝上发生的大量独立、趋同的替换可能被 MP 误解为共享衍生性状（共衍征），导致算法错误地将这两个枝组合在一起。\n\n真实的有根树是 $(((A,B),C), \\text{Outgroup})$。对于四分类单元情况 $\\{A, B, C, O\\}$，无根拓扑是 $((A,B),(C,O))$。这个无根树的内部枝长度为 $t_I = 0.05$，它将 $\\{A,B\\}$ 的祖先节点与 $\\{C,O\\}$ 的祖先节点分开。分类单元 $A$ 和 $B$ 位于短的末端枝上（$t_A=0.10$, $t_B=0.10$），而分类单元 $C$ 位于一个非常长的末端枝上（$t_C=1.80$）。如果外群枝也很长，这是一个极易受 LBA 影响的非对称树。\n\n**选项 A 评估**\nA. 在策略 $O_1$ 下，MP 的一致性得到保证；更长的外群枝增加了明确的共衍征数量，因此最小化了 LBA 风险。\n\n策略 $O_1$ 引入了一个位于非常长枝上的外群 $O_1$，$t_{O_1} = 2.00$。现在，在真实树中有两个长而不相邻的枝：通向 $C$ 的枝（$t_C=1.80$）和通向 $O_1$ 的枝（$t_{O_1}=2.00$）。它们被一个非常短的内部枝（$t_I=0.05$）分开。这是诱发 LBA 的典型配置。在通往 $C$ 和 $O_1$ 的枝上发生的大量随机、平行的变化将产生一个强大的误导性信号，该信号会淹没由短内部枝上少量变化所承载的真实系统发育信号。该策略非但不能保证一致性，反而几乎肯定会导致不一致。声称更长的外群枝有帮助是对 LBA 的根本误解。\n该陈述是 **不正确的**。\n\n**选项 B 评估**\nB. 在策略 $O_2$ 下，缩短外群枝相对于 $O_1$ 降低了由 LBA 驱动的错误定根风险，因为它减少了 $C$ 和外群之间独立产生相似性（MP 会将其计为共享衍生状态）的速率。\n\n策略 $O_2$ 使用一个枝长很短的近缘外群，$t_{O_2} = 0.15$。与策略 $O_1$ 相比，这从诱发 LBA 的配对中移除了两个长枝之一。虽然通往 $C$ 的枝仍然很长（$t_C=1.80$），但没有其他长枝可以“吸引”它。外群枝现在很短，因此其上随机替换的数量很少，从而大大降低了 $C$ 谱系和外群谱系之间发生趋同变化的可能性。所提供的理由——即减少枝长会降低 MP 误解为独立相似性（同oplasy）的速率——是完全正确的。这是缓解由远缘外群引起的 LBA 的标准教科书解决方案。\n该陈述是 **正确的**。\n\n**选项 C 评估**\nC. 在策略 $O_3$ 下，使用形成一个演化支的两个近缘外群，通过将外群侧的路径分解为多个短枝，进一步降低了 LBA 风险（相对于单个近缘外群），从而降低了到 $C$ 的长内群枝与外群被伪联合的可能性。\n\n策略 $O_3$ 使用两个近缘外群 $(O_2, O_3)$ 形成一个演化支。这是一种提高定根稳健性的标准技术。与从单个外群末端推断相比，可以更有信心地推断外群演化支下方节点的祖先性状状态。这稳健地“锚定”了根。通过更准确地极化内群基部的性状变化，它减少了长 $C$ 枝上的同塑性状态被误解的机会。该陈述称此策略“将外群侧的路径分解”并“相对于单个近缘外群进一步降低 LBA 风险”，这是对使用多个密切相关的外群的优点的正确描述。这是一个优于 $O_2$ 的策略。\n该陈述是 **正确的**。\n\n**选项 D 评估**\nD. 对无根内群树进行中点定根（无外群）消除了 LBA，因为将根置于最长路径的中心会自动校正谱系间的速率变异。\n\n中点定根是一种将根放置在无根树上任意两个分类单元之间最长路径的中点的方法。该方法关键性地假设了分子钟（即所有谱系的演化速率相等）。问题设置公然违反了这一假设：通往 $C$ 的枝（$t_C=1.80$）远长于通往 $A$ 和 $B$ 的枝（从根到 $A$ 的总路径为 $t_I+t_A = 0.15$）。在内群树 $\\{A,B,C\\}$ 中，最长的路径在 $C$ 和 $A$（或 $B$）之间，长度为 $t_C+t_I+t_A = 1.80+0.05+0.10 = 1.95$。中点定根会将根放置在通往 $C$ 的枝上，距离 $C$ 为 $1.95/2=0.975$ 的位置。这导致了错误的定根拓扑 $(C,(A,B))$，而真实的拓扑是 $((A,B),C)$。声称该方法“自动校正谱系间速率变异”是错误的；实际上，它对此类变异高度敏感并会被其误导。虽然它通过不使用外群避免了与外群相关的 LBA，但它引入了其自身的严重错误。\n该陈述是 **不正确的**。\n\n**选项 E 评估**\nE. 即使使用 JC$69$ 数据且 $N \\to \\infty$，MP 在此枝长配置下使用策略 $O_1$ 也可能在统计上不一致，通过将 $C$ 与外群分组而不是恢复 $(A,B)$ 作为内群演化支来错误地放置根。\n\n该陈述正确地总结了在策略 $O_1$ 下应用 MP 的结果。正如对选项 A 的分析，两个长的非姐妹枝（$C$ 和 $O_1$）被一个短的内部枝（$t_I$）分开的配置是经典的 Felsenstein 区，在此区域 MP 被证明是不一致的。当 $N \\to \\infty$ 时，MP 不会收敛到真实拓扑 $((A,B),(C,O_1))$，而是会收敛到一个不正确的拓扑，该拓扑错误地将长枝组合在一起，例如 $((A,C),(B,O_1))$。在指定的外群 $O_1$ 上对这个不正确的无根树进行定根，会导致根的位置错误和一组不正确的推断关系，其中内群不是单系的。该陈述是对这种情况下 LBA 谬误的精确和准确的描述。\n该陈述是 **正确的**。", "answer": "$$\\boxed{BCE}$$", "id": "2729142"}, {"introduction": "基于前一个练习所展示的最大简约法（Maximum Parsimony）的潜在缺陷，本练习将深入探讨长枝吸引问题的理论核心。不同的系统发育推断方法具有不同的统计学特性，在某些条件下可能导致截然不同的结果。这个思想实验 [@problem_id:2729158] 将在经典的“Felsenstein区”内，对最大简约法（MP）和最大似然法（Maximum Likelihood, ML）进行比较，迫使我们思考统计一致性（statistical consistency）这一关键概念，并理解为何像ML这样的基于模型的方法能够克服困扰简约法的LBA假象。", "problem": "考虑一个无根四分类单元树 $T^{\\star} = ((A,B),(C,D))$，它在 Jukes–Cantor $1969$ (JC$69$) 模型下生成，具有瞬时速率 $\\mu > 0$、独立同分布 (i.i.d.) 的位点和以下分支长度：连接到分类单元 $A$ 和 $C$ 的悬垂分支长度为 $t_{L} > 0$ (长)，连接到分类单元 $B$ 和 $D$ 的悬垂分支长度为 $t_{S} > 0$ (短)，唯一的内部支长度为 $t_{I} > 0$ (短)。假设该过程是稳态且时间齐次的。在 JC$69$ 模型下，对于任意长度为 $t$ 的分支，其转移概率为\n$$\nP_{ii}(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}, \\quad P_{ij}(t) = \\tfrac{1}{4}\\left(1 - e^{-4\\mu t/3}\\right) \\ \\text{for} \\ i \\neq j,\n$$\n而沿着长度为 $t$ 的分支发生任意变化的概率是 $p(t) = \\tfrac{3}{4}\\left(1 - e^{-4\\mu t/3}\\right)$，不发生变化的概率则是 $q(t) = 1 - p(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}$。设 $n$ 表示位点数，并考虑 $n \\to \\infty$ 的渐近状态。\n\n系统发育学中的四分类单元范式通过首先为每组 $\\binom{N}{4}$ 四分类单元推断一个无根拓扑，然后通过超树算法合并得到的四分类单元树，来重建一个大的 $N$-分类单元树。两种常见的四分类单元推断方法是：最大简约法 (MP)，该方法选择使观测位点所隐含的总变化数最小化的拓扑；以及最大似然法 (ML)，该方法在 JC$69$ 模型下选择使模型下的联合位点似然最大化的拓扑和分支长度。\n\n当 $t_{L}$ 足够大且 $t_{I}$ 足够小 (即 Felsenstein 区域) 时，以下哪项陈述最能描述 MP 和 ML 在四分类单元树 $T^{\\star}$ 上的渐近行为，以及这对基于四分类单元方法重建更大树木的影响？\n\nA. 存在 $t_{L} \\gg 0$ 和 $t_{I} \\ll 0$ 使得当 $n \\to \\infty$ 时，MP 收敛到将长分支 $A$ 和 $C$ 组合在一起的错误四分类单元树，而在正确指定的 JC$69$ 模型下，ML 对于真实的四分类单元树 $T^{\\star}$ 仍然是统计一致的。因此，使用 MP 作为四分类单元预言机可能会使超树在体现此类四分类单元的较大树的部分中偏向于错误的解析。\n\nB. 当 $n \\to \\infty$ 时，MP 在四分类单元树上的长分支吸引现象消失，因为同oplasy 模式被平均掉，所以无论 $t_{L}$ 和 $t_{I}$ 如何，MP 和 ML 在 $T^{\\star}$ 上都是统计一致的。\n\nC. 在 Felsenstein 区域，MP 和 ML 在 JC$69$ 模型下的四分类单元树上都是统计不一致的，因为趋同替换占主导地位，并使得任何方法都无法识别树的拓扑。\n\nD. 在四分类单元范式下，MP 和 ML 之间的选择是渐近无关的：即使四分类单元预言机在某些四分类单元上是统计不一致的，$\\binom{N}{4}$ 组四分类单元之间的冗余性也确保了当 $n \\to \\infty$ 时超树是统计一致的。", "solution": "首先将对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- **模型**：Jukes–Cantor $1969$ (JC$69$)。\n- **演化过程**：瞬时替换速率 $\\mu > 0$，独立同分布 (i.i.d.) 的位点，稳态且时间齐次的过程。\n- **树拓扑**：一个无根四分类单元树 $T^{\\star} = ((A,B),(C,D))$。\n- **分支长度**：\n  - 连接到分类单元 $A$ 和 $C$ 的悬垂分支：长度 $t_{L} > 0$ (长)。\n  - 连接到分类单元 $B$ 和 $D$ 的悬垂分支：长度 $t_{S} > 0$ (短)。\n  - 内部支：长度 $t_{I} > 0$ (短)。\n- **转移概率 (JC69)**：对于长度为 $t$ 的分支：\n  - 在某个位点上，特定核苷酸不发生替换的概率：$P_{ii}(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}$。\n  - 在某个位点上，发生特定替换 $i \\to j$ 的概率：$P_{ij}(t) = \\tfrac{1}{4}(1 - e^{-4\\mu t/3})$，对于 $i \\neq j$。\n- **导出概率**：\n  - 沿着长度为 $t$ 的分支发生任意变化的概率：$p(t) = \\tfrac{3}{4}(1 - e^{-4\\mu t/3})$。\n  - 沿着长度为 $t$ 的分支不发生变化的概率：$q(t) = 1 - p(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}$。\n- **渐近状态**：位点数 $n \\to \\infty$。\n- **推断背景**：基于四分类单元的超树重建。\n- **推断方法**：\n  - 最大简约法 (MP)：选择使数据所隐含的总替换数最小化的拓扑。\n  - 最大似然法 (ML)：选择在指定模型 (JC$69$) 下，使观测到的位点数据的联合概率（似然）最大化的拓扑和分支长度。\n- **问题**：描述在“Felsenstein 区域”($t_L$ 大，$t_I$ 小)中 MP 和 ML 在四分类单元树 $T^{\\star}$ 上的渐近行为 ($n \\to \\infty$)，以及其对基于四分类单元的超树方法的影响。\n\n### 步骤2：使用提取的已知条件进行验证\n根据科学和逻辑原则评估问题陈述。\n1.  **科学依据**：该问题建立在分子系统发育学的基础概念之上：Jukes-Cantor 模型、最大简约法、最大似然法以及长分支吸引 (LBA) 现象。所有定义和方程都是标准的且事实上是正确的。\n2.  **适定性**：该问题询问了在精确指定的概率模型和渐近状态下，两种明确定义的估计方法（MP 和 ML）的统计一致性。这种结构允许基于已建立的理论得出一个唯一且有意义的解。\n3.  **客观性**：语言正式、精确，没有主观或模糊的术语。\n4.  **完整性和一致性**：该问题提供了分析渐近行为所需的所有必要信息（模型、树结构、参数、方法）。问题陈述本身没有内部矛盾。选项不属于此验证步骤。\n5.  **相关性**：该问题核心关注长分支吸引，这是演化生物学中的一个关键课题。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的、适定的且内部一致。因此它是有效的。可以进行分析。\n\n---\n\n### 推导\n\n此问题的核心概念是统计一致性。如果当位点数 $n$ 趋于无穷大时，推断出真实拓扑的概率收敛到 $1$，那么该树拓扑的估计量就是统计一致的。我们将分析在指定条件下，最大简约法 (MP) 和最大似然法 (ML) 的一致性。\n\n真实的树是 $T^{\\star} = ((A,B),(C,D))$。由于连接到分类单元 $A$ 和 $C$ 的分支 $t_L$ 很长，长分支吸引现象可能导致推断方法错误地将分类单元 $A$ 和 $C$ 组合在一起，从而得出拓扑 $T_{AC} = ((A,C),(B,D))$。\n\n**最大简约法 (MP) 分析**\n\n最大简约法的操作方式是选择需要最少数量的性状状态变化来解释观测数据的树拓扑。在 $n \\to \\infty$ 的渐近极限下，MP 将收敛到由最多简约信息位点支持的拓扑。\n\n如果一个位点至少有两种不同的性状状态，且每种状态至少出现两次，则该位点对于四分类单元树是简约信息的。例如，跨分类单元 $(A,B,C,D)$ 的位点模式 `GAGA` 就是信息位点。对于此模式，拓扑 $((A,C),(B,D))$ 只需要一次变化，而其他两种拓扑 $((A,B),(C,D))$ 和 $((A,D),(B,C))$ 则至少需要两次变化。因此，此模式支持 $((A,C),(B,D))$。\n\nFelsenstein 区域由分支长度定义，其中 $t_L$ 很长而 $t_I$ 很短。\n- 长分支上发生变化的概率是 $p(t_L) = \\frac{3}{4}(1 - e^{-4\\mu t_L/3})$。当 $t_L \\to \\infty$ 时，$p(t_L) \\to 3/4$。\n- 短内部支上发生变化的概率是 $p(t_I) = \\frac{3}{4}(1 - e^{-4\\mu t_I/3})$。当 $t_I \\to 0$ 时，$p(t_I) \\to 0$。\n\n让我们考虑支持真实树的位点期望数与支持错误地将长分支组合在一起的树的位点期望数。\n- **对真实树 $T^{\\star} = ((A,B),(C,D))$ 的支持**：此拓扑最直接的证据来自进化支 $(A,B)$ 或 $(C,D)$ 的共享衍生性状 (synapomorphy)。这需要在内部支 $t_I$ 上发生单次替换。此类事件的概率与 $p(t_I)$ 成正比。\n- **对错误树 $T_{AC} = ((A,C),(B,D))$ 的支持**：这棵树由同oplasy（具体来说是平行或趋同替换）支持。例如，在真实树 $T^{\\star}$ 上，可以通过两次独立的替换（一次在通往 A 的分支上，一次在通往 C 的分支上）生成支持 $T_{AC}$ 的位点模式。此类联合事件的概率与 $p(t_L) \\times p(t_L) = p(t_L)^2$ 相关。\n\n在 Felsenstein 区域，$t_L$ 很大而 $t_I$ 很小。因此，$p(t_L)$ 很大（接近 $3/4$），而 $p(t_I)$ 很小（接近 $0$）。Felsenstein ($1978$) 证明了，存在一个参数空间区域，其中由于同oplasy 而支持错误树 $T_{AC}$ 的位点期望数，超过了由于共享衍生性状 (synapomorphy) 而支持真实树 $T^{\\star}$ 的位点期望数。在此区域内，$E[\\text{支持 } T_{AC} \\text{ 的位点}] > E[\\text{支持 } T^{\\star} \\text{ 的位点}]$。\n\n根据大数定律，当 $n \\to \\infty$ 时，观测到的位点模式频率将收敛到其期望频率。因此，MP 将选择错误的拓扑 $T_{AC}$。这表明在这些条件下 MP 是统计不一致的。\n\n**最大似然法 (ML) 分析**\n\n最大似然法，当其生成演化模型被正确指定时（本例中即 JC$69$ 模型），是一种统计一致的方法。如果模型是可识别的，即不同的树拓扑不能产生完全相同的位点模式概率分布，那么一致性就得到保证。\n\n对于无根四分类单元树上的 JC$69$ 模型，其拓扑是可识别的。这意味着对于真实树 $T^{\\star}$ 和任何不正确的树 $T' \\neq T^{\\star}$，不存在一组分支长度能使在 $(T', \\text{lengths}')$ 下的数据似然值在期望上等于在 $(T^{\\star}, \\text{真实长度})$ 下的数据似然值。\n\nML 的原理基于最大化全局似然函数。对数似然的期望值在真实的参数值（拓扑和分支长度）处达到最大。当 $n \\to \\infty$ 时，样本对数似然函数收敛到其期望值。因此，最大化样本似然的拓扑将依概率收敛到真实拓扑 $T^{\\star}$。ML 能正确处理长分支上的多次替换，并且不像 MP 那样被同oplasy 误导。因此，即使在 Felsenstein 区域，ML 也是统计一致的。\n\n**对基于四分类单元的重建的影响**\n\n四分类单元范式依赖于一个“四分类单元预言机”来推断拓扑，然后将这些拓扑组装成一棵超树。如果该预言机是统计不一致的，它将产生系统性的偏差结果。\n- 在真实树中具有 Felsenstein 区域几何特征的区域使用 MP 作为预言机，将导致 MP 一致地报告错误的四分类单元拓扑 $((A,C),(B,D))$。\n- 这不是一个可以被平均掉的随机误差。这是一个系统误差。当超树算法从跨越树的这一部分的所有四分类单元接收到一个一致但错误的信号时，它将被偏向于，或者被迫重建一个反映长分支组合的错误的较大树。\n\n### 逐项分析\n\n**A. 存在 $t_{L} \\gg 0$ 和 $t_{I} \\ll 0$ 使得当 $n \\to \\infty$ 时，MP 收敛到将长分支 $A$ 和 $C$ 组合在一起的错误四分类单元树，而在正确指定的 JC$69$ 模型下，ML 对于真实的四分类单元树 $T^{\\star}$ 仍然是统计一致的。因此，使用 MP 作为四分类单元预言机可能会使超树在体现此类四分类单元的较大树的部分中偏向于错误的解析。**\n- 条件 `$t_I \\ll 0$` 是一个印刷错误；分支长度不能为负。它必须被解释为 $t_I > 0$ 且 $t_I \\to 0$，或 $t_I \\ll t_L, t_S$，这定义了 Felsenstein 区域。\n- `'MP 收敛到错误的四分类单元树...'`：如上所述，这是一个描述由 LBA 引起的 MP 不一致性的正确陈述。\n- `'ML... 仍然是统计一致的...'`：如上所述，这也是正确的。\n- `'因此，使用 MP 作为四分类单元预言机可能会使超树产生偏向...'`：这是使用系统性偏差方法进行子问题分析的正确逻辑后果。误差是系统性的，并将破坏最终的超树。\n- 在对印刷错误进行善意解释的情况下，该陈述是对情况的完整而准确的描述。\n- **结论：正确。**\n\n**B. 当 $n \\to \\infty$ 时，MP 在四分类单元树上的长分支吸引现象消失，因为同oplasy 模式被平均掉，所以无论 $t_{L}$ 和 $t_{I}$ 如何，MP 和 ML 在 $T^{\\star}$ 上都是统计一致的。**\n- `'长分支吸引在 MP 上消失...当 n -> infinity 时'`：这根本上是错误的。LBA 正是一种渐近现象；它描述了当数据变为无穷大时 MP 收敛到的错误拓扑。同oplasy 模式不会“平均掉”，而是系统性地误导该方法。\n- `'MP 和 ML 都是统计一致的...无论 t_L 和 t_I 如何'`：这是错误的。MP 通常不具有一致性。\n- **结论：不正确。**\n\n**C. 在 Felsenstein 区域，MP 和 ML 在 JC$69$ 模型下的四分类单元树上都是统计不一致的，因为趋同替换占主导地位，并使得任何方法都无法识别树的拓扑。**\n- `'MP 和 ML 都是统计不一致的'`：错误。使用正确模型的 ML 是一致的。\n- `'使树拓扑不可识别'`：错误。四分类单元上的 JC$69$ 模型是可识别的。高替换率使推断困难（即需要更多数据），但它们不会使拓扑对于一致性方法来说从根本上不可恢复。问题在于推断标准（简约法），而不在于模型的内在可识别性。\n- **结论：不正确。**\n\n**D. 在四分类单元范式下，MP 和 ML 之间的选择是渐近无关的：即使四分类单元预言机在某些四分类单元上是统计不一致的，$\\binom{N}{4}$ 组四分类单元之间的冗余性也确保了当 $n \\to \\infty$ 时超树是统计一致的。**\n- `'MP 和 ML 之间的选择是渐近无关的'`：错误。它们的渐近行为根本不同（不一致 vs. 一致）。这个选择至关重要。\n- `'冗余性...确保超树是统计一致的'`：错误。由 LBA 引起的误差是系统性的，不是随机的。如果真实的 N-分类单元树中存在一个特定的诱发 LBA 的几何结构，那么所有抽样到这些分支的四分类单元都会以同样的方式被错误推断。这种冗余性加强了系统误差，导致超树方法不一致。\n- **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2729158"}, {"introduction": "为了建立更全面的理解，我们必须认识到长枝吸引并不仅仅与快速演化的谱系有关。本练习 [@problem_id:2729157] 将我们的注意力从替换速率转移到另一个同样强大的系统误差来源：非稳态的碱基组成（non-stationary base composition）。通过一个具体的推导，本练习将引导您量化趋同的核苷酸含量变化（例如GC含量偏好）如何能在不相关的分类单元之间产生“额外的一致性”，从而误导推断方法将它们错误地聚在一起。", "problem": "一个由标为 $A$、$B$、$C$ 和 $D$ 的四个分类单元组成的群体，在核苷酸上的连续时间马尔可夫链下演化，但由于非平稳过程，其碱基组成具有谱系特异性。其真实的无根拓扑为 $(A,B)\\,|\\,(C,D)$，内部支路极短。在通往 $A$ 和 $C$ 的末端支路上，发生了朝向鸟嘌呤-胞嘧啶（GC）含量的组成性偏移，因此经过很长时间后，$A$ 和 $C$ 各自的边缘核苷酸组成 $\\mathbf{q}(g)$ 由下式给出：\n$$\n\\mathbf{q}(g) = \\left(\\frac{1-g}{2},\\,\\frac{1-g}{2},\\,\\frac{g}{2},\\,\\frac{g}{2}\\right),\n$$\n其中，各项对应于 $(\\text{A},\\text{T},\\text{G},\\text{C})$，而 $g \\in [0,1]$ 是 GC 比例。在通往 $B$ 和 $D$ 的末端支路上，其组成保持均匀，为 $\\mathbf{u} = \\left(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4},\\frac{1}{4}\\right)$。假设所有末端支路都足够长，以至于位点模式已有效饱和，因此叶节点处的联合状态是从其叶节点特异性的边缘分布中独立抽取的。\n\n在这些条件下，可能会出现长支吸引现象，因为一个平稳的、组成同质的推断方法会隐含地偏好那些因状态而共享更多相同核苷酸的配对。设两个分类单元 $X$ 和 $Y$ 在一个位点上相同的期望概率为\n$$\ns(X,Y) \\equiv \\sum_{i \\in \\{\\text{A},\\text{T},\\text{G},\\text{C}\\}} p_X(i)\\,p_Y(i),\n$$\n其中 $p_X$ 和 $p_Y$ 分别是 $X$ 和 $Y$ 的边缘核苷酸分布。将长支路的期望成对相同性优势定义为\n$$\n\\Delta(g) \\equiv s(A,C) - s(A,B).\n$$\n\n仅从上述定义和饱和状态下的独立性假设出发，推导 $\\Delta(g)$ 作为 $g$ 的函数的闭式表达式。然后，确定为使 $\\Delta(g) \\ge \\delta$（对于目标超额相同性 $\\delta = 0.02$）所需的最小绝对组成偏差\n$$\n\\eta \\equiv \\left|g - \\frac{1}{2}\\right|\n$$\n报告 $\\eta$ 的数值，四舍五入到四位有效数字。无需单位。", "solution": "该问题陈述已经过严格验证，并被认为是有效的。它在科学上基于分子演化的原理，特别是关于由组成异质性引起的长支吸引假象。该问题是良定的，为求得唯一且有意义的解提供了所有必要的定义和条件。它以客观、正式的语言表述，没有歧义或矛盾。\n\n目标是推导期望成对相同性优势 $\\Delta(g)$ 的表达式，然后确定使该优势达到某一阈值所需的最小组成偏差 $\\eta$。\n\n该问题提供了标为 $A$、$B$、$C$ 和 $D$ 的四个分类单元的边缘核苷酸频率分布。对于分类单元 $A$ 和 $C$，该分布是鸟嘌呤-胞嘧啶（GC）比例 $g \\in [0,1]$ 的函数：\n$$\np_A = p_C = \\mathbf{q}(g) = \\left(\\frac{1-g}{2}, \\frac{1-g}{2}, \\frac{g}{2}, \\frac{g}{2}\\right)\n$$\n其中各分量对应于核苷酸 $(\\text{A}, \\text{T}, \\text{G}, \\text{C})$。\n对于分类单元 $B$ 和 $D$，该分布是均匀的：\n$$\np_B = p_D = \\mathbf{u} = \\left(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}\\right)\n$$\n问题陈述指出，由于长支路上的饱和，叶节点处的状态是从这些边缘分布中独立抽取的。两个分类单元 $X$ 和 $Y$ 之间的相同性期望概率定义为：\n$$\ns(X,Y) \\equiv \\sum_{i \\in \\{\\text{A},\\text{T},\\text{G},\\text{C}\\}} p_X(i)\\,p_Y(i)\n$$\n这是它们各自频率向量的点积。我们需要求出 $\\Delta(g) \\equiv s(A,C) - s(A,B)$ 的表达式。\n\n首先，我们计算 $s(A,C)$。由于 $p_A = p_C = \\mathbf{q}(g)$，这是 $\\mathbf{q}(g)$ 各分量的平方和：\n$$\ns(A,C) = \\left(\\frac{1-g}{2}\\right)^2 + \\left(\\frac{1-g}{2}\\right)^2 + \\left(\\frac{g}{2}\\right)^2 + \\left(\\frac{g}{2}\\right)^2\n$$\n$$\ns(A,C) = 2 \\left(\\frac{(1-g)^2}{4}\\right) + 2 \\left(\\frac{g^2}{4}\\right) = \\frac{(1-g)^2 + g^2}{2}\n$$\n展开分子：\n$$\ns(A,C) = \\frac{(1 - 2g + g^2) + g^2}{2} = \\frac{2g^2 - 2g + 1}{2} = g^2 - g + \\frac{1}{2}\n$$\n\n接下来，我们计算 $s(A,B)$。这是 $p_A = \\mathbf{q}(g)$ 和 $p_B = \\mathbf{u}$ 的点积：\n$$\ns(A,B) = \\left(\\frac{1-g}{2}\\right)\\left(\\frac{1}{4}\\right) + \\left(\\frac{1-g}{2}\\right)\\left(\\frac{1}{4}\\right) + \\left(\\frac{g}{2}\\right)\\left(\\frac{1}{4}\\right) + \\left(\\frac{g}{2}\\right)\\left(\\frac{1}{4}\\right)\n$$\n我们可以提出常数项 $\\frac{1}{4}$：\n$$\ns(A,B) = \\frac{1}{4} \\left[ \\left(\\frac{1-g}{2}\\right) + \\left(\\frac{1-g}{2}\\right) + \\left(\\frac{g}{2}\\right) + \\left(\\frac{g}{2}\\right) \\right]\n$$\n$$\ns(A,B) = \\frac{1}{4} \\left[ (1-g) + g \\right] = \\frac{1}{4} [1] = \\frac{1}{4}\n$$\n这个结果与 $g$ 无关，因为任何概率向量与同一空间上的均匀概率向量的点积就是该空间维度的倒数。\n\n现在，我们可以组合出 $\\Delta(g)$ 的表达式：\n$$\n\\Delta(g) = s(A,C) - s(A,B) = \\left(g^2 - g + \\frac{1}{2}\\right) - \\frac{1}{4}\n$$\n$$\n\\Delta(g) = g^2 - g + \\frac{1}{4}\n$$\n这个表达式是一个完全平方式：\n$$\n\\Delta(g) = \\left(g - \\frac{1}{2}\\right)^2\n$$\n这就是所求的期望成对相同性优势的闭式表达式。这个量总是非负的，且仅当 $g = \\frac{1}{2}$ 时为零，这对应于所有分类单元都具有均匀碱基组成的情况，因此组成假象的来源不存在。\n\n问题的最后一部分要求找到最小绝对组成偏差 $\\eta \\equiv \\left|g - \\frac{1}{2}\\right|$，使得对于目标 $\\delta = 0.02$ 有 $\\Delta(g) \\ge \\delta$。\n将我们推导出的 $\\Delta(g)$ 表达式和 $\\eta$ 的定义代入不等式：\n$$\n\\left(g - \\frac{1}{2}\\right)^2 \\ge \\delta\n$$\n$$\n\\left(\\left|g - \\frac{1}{2}\\right|\\right)^2 \\ge \\delta\n$$\n$$\n\\eta^2 \\ge \\delta\n$$\n给定 $\\delta = 0.02$，我们有：\n$$\n\\eta^2 \\ge 0.02\n$$\n由于 $\\eta$ 代表绝对偏差，根据定义它是非负的（$\\eta \\ge 0$）。我们可以对两边取正平方根：\n$$\n\\eta \\ge \\sqrt{0.02}\n$$\n因此，满足此条件的 $\\eta$ 的最小值是 $\\eta = \\sqrt{0.02}$。我们现在必须提供四舍五入到四位有效数字的数值。\n$$\n\\eta = \\sqrt{0.02} = \\sqrt{\\frac{2}{100}} = \\frac{\\sqrt{2}}{10} \\approx \\frac{1.41421356...}{10} = 0.141421356...\n$$\n将该值四舍五入到四位有效数字得出 $0.1414$。\n这意味着，与均匀情况（$g=0.5$）相比，GC 比例需要有大约 $14.14\\%$ 的偏差，才能在有组成偏差的分类单元 $A$ 和 $C$ 之间产生至少 $2\\%$ 的超额相同性，该相同性是与有偏差分类单元 $A$ 和无偏差分类单元 $B$ 之间的相同性相比。", "answer": "$$\n\\boxed{0.1414}\n$$", "id": "2729157"}]}