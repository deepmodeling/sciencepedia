{"hands_on_practices": [{"introduction": "任何$d_N/d_S$分析的第一步都是从序列比对中精确计算潜在的同义和非同义位点数，以及观察到的差异数。这个练习为这些核心定义提供了基础性的实践，这些定义是所有后续进化速率估算的基础。通过手动处理一个简短的序列比对，你将掌握Nei-Gojobori等经典方法的基本逻辑，从而深刻理解$p_N$和$p_S$这两个关键观测值的由来。[@problem_id:2754869]", "problem": "下面给出两个直系同源蛋白质编码序列的成对密码子比对。这些序列是同框的、密码子对齐的，并按 $5^{\\prime}\\to 3^{\\prime}$ 方向读取。比对的序列跨越 $4$ 个密码子（即 $12$ 个核苷酸）。\n\n序列 1（参考）：GCT TTT AGA GAA\n序列 2（查询）：    GCC TAT GCA GAC\n\n仅使用以下基本定义和假设：\n\n- 同义替换是指密码子内不改变其编码的氨基酸的单核苷酸变异；非同义替换是指会改变其编码的氨基酸的变异。产生终止密码子的单核苷酸变异应计为非同义替换。\n- 对于每个密码子，同义位点的数量定义为在该密码子三个位置上，每个位置可能发生的三种单核苷酸变异中属于同义替换的比例之和。非同义位点的数量是剩余部分，因此每个密码子的同义和非同义位点之和等于 $3$。\n- 对于具有多个核苷酸差异的密码子对，将差异分解为沿所有最短路径（即密码子之间的汉明距离）的单核苷酸步骤，计算每条路径上的同义与非同义步骤，并对这些路径取平均值（等路径加权，如 Nei–Gojobori 框架中所示）。\n- 使用标准核基因密码，并提供以下相关的密码子家族：丙氨酸由 GCT、GCC、GCA、GCG 编码；苯丙氨酸由 TTT、TTC 编码；酪氨酸由 TAT、TAC 编码；精氨酸由 CGT、CGC、CGA、CGG、AGA、AGG 编码；谷氨酸由 GAA、GAG 编码；天冬氨酸由 GAT、GAC 编码。不需要其他遗传密码细节。\n\n任务：\n\n1. 首先计算两个序列中每个密码子的同义位点数和非同义位点数，然后对每个位置上配对密码子的位点数进行平均，最后对 $4$ 个密码子位置求和，从而计算出比对的总同义位点数 $S$ 和总非同义位点数 $N$。\n2. 对于单核苷酸差异，使用单步分类法；对于具有两个差异的密码子对，使用等路径加权法，计算整个比对中预期的同义差异数 $S_{d}$ 和非同义差异数 $N_{d}$。\n3. 由此推导出 $p_{S} = S_{d}/S$ 和 $p_{N} = N_{d}/N$。\n\n将你的最终答案以有序对 $(p_{S}, p_{N})$ 的形式报告。将 $p_{S}$ 和 $p_{N}$ 的值均四舍五入至四位有效数字。最终答案不带单位。", "solution": "该问题要求计算给定成对密码子比对中，每个同义位点的同义差异比例 $p_{S}$，以及每个非同义位点的非同义差异比例 $p_{N}$。验证已确认该问题具有科学依据，提法明确，并包含足够的信息以得出唯一解。计算将按指定分为三个阶段执行。\n\n**阶段 1：总同义位点数（$S$）和非同义位点数（$N$）的计算**\n\n首先，我们必须确定比对中每个独特密码子的同义位点数（$s$）和非同义位点数（$n$）。每个密码子的位点数为 $3$。一个密码子的同义位点数计算公式为 $s = \\sum_{i=1}^{3} f_{i,S}$，其中 $f_{i,S}$ 是在位置 $i$ 处单核苷酸变异中同义替换的比例。非同义位点数是 $n = 3 - s$。相关的遗传密码已提供。\n\n比对如下：\n序列 1：GCT TTT AGA GAA\n序列 2：GCC TAT GCA GAC\n\n每个独特密码子的计算：\n- **GCT（丙氨酸）：** 第 $1$ 和第 $2$ 位是非简并的。第 $3$ 位是一个 $4$ 重简并位点。\n  $s_{\\text{GCT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{3}{3} = 1$。因此，$n_{\\text{GCT}} = 3 - 1 = 2$。\n- **GCC（丙氨酸）：** 与 GCT 属性相同。\n  $s_{\\text{GCC}} = 1$ 和 $n_{\\text{GCC}} = 2$。\n- **TTT（苯丙氨酸）：** 第 $1$ 和第 $2$ 位是非简并的。在第 $3$ 位，三种可能的变异中有一种（变为 TTC）是同义的。\n  $s_{\\text{TTT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。因此，$n_{\\text{TTT}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n- **TAT（酪氨酸）：** 第 $1$ 和第 $2$ 位是非简并的。在第 $3$ 位，三种可能的变异中有一种（变为 TAC）是同义的。\n  $s_{\\text{TAT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。因此，$n_{\\text{TAT}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n- **AGA（精氨酸）：** 在第 $1$ 位，一种变异（变为 CGA）是同义的。在第 $2$ 位，所有变异都是非同义的。在第 $3$ 位，一种变异（变为 AGG）是同义的。\n  $s_{\\text{AGA}} = \\frac{1}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{2}{3}$。因此，$n_{\\text{AGA}} = 3 - \\frac{2}{3} = \\frac{7}{3}$。\n- **GCA（丙氨酸）：** 与 GCT 属性相同。\n  $s_{\\text{GCA}} = 1$ 和 $n_{\\text{GCA}} = 2$。\n- **GAA（谷氨酸）：** 第 $1$ 和第 $2$ 位是非简并的。在第 $3$ 位，一种变异（变为 GAG）是同义的。\n  $s_{\\text{GAA}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。因此，$n_{\\text{GAA}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n- **GAC（天冬氨酸）：** 第 $1$ 和第 $2$ 位是非简并的。在第 $3$ 位，一种变异（变为 GAT）是同义的。\n  $s_{\\text{GAC}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。因此，$n_{\\text{GAC}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n\n接下来，我们对比对中每个密码子对的位点数进行平均。\n1.  **密码子对 1 (GCT, GCC):**\n    $\\bar{s}_1 = \\frac{s_{\\text{GCT}} + s_{\\text{GCC}}}{2} = \\frac{1+1}{2} = 1$。\n    $\\bar{n}_1 = \\frac{n_{\\text{GCT}} + n_{\\text{GCC}}}{2} = \\frac{2+2}{2} = 2$。\n2.  **密码子对 2 (TTT, TAT):**\n    $\\bar{s}_2 = \\frac{s_{\\text{TTT}} + s_{\\text{TAT}}}{2} = \\frac{1/3+1/3}{2} = \\frac{1}{3}$。\n    $\\bar{n}_2 = \\frac{n_{\\text{TTT}} + n_{\\text{TAT}}}{2} = \\frac{8/3+8/3}{2} = \\frac{8}{3}$。\n3.  **密码子对 3 (AGA, GCA):**\n    $\\bar{s}_3 = \\frac{s_{\\text{AGA}} + s_{\\text{GCA}}}{2} = \\frac{2/3+1}{2} = \\frac{5/3}{2} = \\frac{5}{6}$。\n    $\\bar{n}_3 = \\frac{n_{\\text{AGA}} + n_{\\text{GCA}}}{2} = \\frac{7/3+2}{2} = \\frac{13/3}{2} = \\frac{13}{6}$。\n4.  **密码子对 4 (GAA, GAC):**\n    $\\bar{s}_4 = \\frac{s_{\\text{GAA}} + s_{\\text{GAC}}}{2} = \\frac{1/3+1/3}{2} = \\frac{1}{3}$。\n    $\\bar{n}_4 = \\frac{n_{\\text{GAA}} + n_{\\text{GAC}}}{2} = \\frac{8/3+8/3}{2} = \\frac{8}{3}$。\n\n最后，我们将这些平均计数相加，以找到比对的总 $S$ 和 $N$。\n$S = \\bar{s}_1 + \\bar{s}_2 + \\bar{s}_3 + \\bar{s}_4 = 1 + \\frac{1}{3} + \\frac{5}{6} + \\frac{1}{3} = \\frac{6+2+5+2}{6} = \\frac{15}{6} = 2.5$。\n$N = \\bar{n}_1 + \\bar{n}_2 + \\bar{n}_3 + \\bar{n}_4 = 2 + \\frac{8}{3} + \\frac{13}{6} + \\frac{8}{3} = \\frac{12+16+13+16}{6} = \\frac{57}{6} = 9.5$。\n总和 $S+N = 2.5+9.5 = 12$，这对于一个 $4$ 密码子的比对是正确的。\n\n**阶段 2：同义差异（$S_d$）和非同义差异（$N_d$）的计算**\n\n我们现在对每个密码子对的核苷酸差异进行分类。\n1.  **对 1 (GCT vs GCC):** 有 $1$ 个差异 (T $\\to$ C)。GCT (丙氨酸) $\\to$ GCC (丙氨酸) 是一个同义替换。\n    $s_{d,1} = 1$, $n_{d,1} = 0$。\n2.  **对 2 (TTT vs TAT):** 有 $1$ 个差异 (T $\\to$ A)。TTT (苯丙氨酸) $\\to$ TAT (酪氨酸) 是一个非同义替换。\n    $s_{d,2} = 0$, $n_{d,2} = 1$。\n3.  **对 3 (AGA vs GCA):** 有 $2$ 个差异 (A $\\to$ G, G $\\to$ C)。我们检查两条最短的进化路径：\n    - 路径 A: AGA (精氨酸) $\\to$ GGA (甘氨酸) $\\to$ GCA (丙氨酸)。两个步骤都是非同义的。路径 A：$0$ 个同义步骤，$2$ 个非同义步骤。\n    - 路径 B: AGA (精氨酸) $\\to$ ACA (苏氨酸) $\\to$ GCA (丙氨酸)。两个步骤都是非同义的。路径 B：$0$ 个同义步骤，$2$ 个非同义步骤。\n    对路径进行平均：$s_{d,3} = \\frac{0+0}{2}=0$, $n_{d,3} = \\frac{2+2}{2}=2$。\n4.  **对 4 (GAA vs GAC):** 有 $1$ 个差异 (A $\\to$ C)。GAA (谷氨酸) $\\to$ GAC (天冬氨酸) 是一个非同义替换。\n    $s_{d,4} = 0$, $n_{d,4} = 1$。\n\n总差异数：\n$S_d = \\sum s_{d,i} = 1 + 0 + 0 + 0 = 1$。\n$N_d = \\sum n_{d,i} = 0 + 1 + 2 + 1 = 4$。\n\n**阶段 3：$p_S$ 和 $p_N$ 的计算**\n\n比例计算为差异数除以位点数。\n$p_S = \\frac{S_d}{S} = \\frac{1}{2.5} = 0.4$。\n$p_N = \\frac{N_d}{N} = \\frac{4}{9.5} = \\frac{4}{19/2} = \\frac{8}{19}$。\n\n最后，我们将这些值以十进制形式表示，并四舍五入到四位有效数字。\n$p_S = 0.4000$。\n$p_N = \\frac{8}{19} \\approx 0.4210526...$，四舍五入后为 $0.4211$。\n\n最终答案是有序对 $(p_S, p_N)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4000  0.4211\n\\end{pmatrix}\n}\n$$", "id": "2754869"}, {"introduction": "直接观察到的差异比例（$p_S$和$p_N$）往往会低估真实的替换事件数量，因为同一位点可能发生多次替换而未被观察到。这个练习将引导你从第一性原理出发，推导经典的Jukes-Cantor校正公式，这是分子进化中用于解决多重替换问题的一个基础工具。通过将观察值$p_S$和$p_N$转换为估计的替换率$d_S$和$d_N$，你将能计算出更有生物学意义的$\\omega$比率。[@problem_id:2754886]", "problem": "两条直系同源的蛋白质编码序列在没有空位的情况下进行了比对。在被分类为同义和非同义的位点上，两条序列之间观察到的核苷酸差异比例分别为 $p_{S}=0.3$ 和 $p_{N}=0.05$。假设在每个位点类别内，核苷酸替换遵循连续时间 Jukes–Cantor 模型（所有不同核苷酸对之间具有相等的平衡碱基频率和相等的瞬时速率），各位点独立进化，且位点间没有速率异质性。\n\n从具有相同非对角线元素的生成元矩阵的连续时间马尔可夫链的定义出发，并使用 Kolmogorov 前向方程，推导出 Jukes–Cantor 校正公式。该公式将时间 $t$ 时观察到的差异比例 $p$ 映射到该模型下每个位点的预期替换数 $d$。将此校正独立应用于同义和非同义位点类别，从 $p_{S}$ 和 $p_{N}$ 中获得 $d_{S}$ 和 $d_{N}$。然后计算非同义与同义替换速率比 $\\omega = d_{N}/d_{S}$。\n\n最终答案仅提供 $\\omega$ 的值。将您报告的 $\\omega$ 值四舍五入到四位有效数字。不包括单位。", "solution": "该问题要求从第一性原理推导 Jukes-Cantor 校正，并应用它来计算非同义与同义替换速率比 $\\omega$。\n\n首先，我们验证问题的有效性。已知条件如下：\n- 同义位点的观察差异比例，$p_{S} = 0.3$。\n- 非同义位点的观察差异比例，$p_{N} = 0.05$。\n- 替换过程遵循连续时间 Jukes–Cantor (JC69) 模型。\n该问题在进化生物学方面有科学依据，问题阐述清晰且信息充分，并使用了客观的标准术语。没有逻辑矛盾、事实错误或含糊之处。该问题是有效的。\n\n我们现在开始求解。\n\nJukes-Cantor 模型将核苷酸替换描述为在四个核苷酸状态空间上的连续时间马尔可夫过程。该模型假设任何一对不同核苷酸之间的替换速率 $\\alpha$ 相等。包含瞬时转换速率的生成元矩阵 $Q$ 如下所示：\n$$\nQ =\n\\begin{pmatrix}\n-3\\alpha  \\alpha  \\alpha  \\alpha \\\\\n\\alpha  -3\\alpha  \\alpha  \\alpha \\\\\n\\alpha  \\alpha  -3\\alpha  \\alpha \\\\\n\\alpha  \\alpha  \\alpha  -3\\alpha\n\\end{pmatrix}\n$$\n对角线元素 $Q_{ii} = -3\\alpha$ 表示从核苷酸 $i$ 发生替换的总速率，这确保了 $Q$ 矩阵的行和为零。\n\n转移概率矩阵 $P(t)$，其中 $P_{ij}(t)$ 是在 $t=0$ 时处于状态 $i$ 的条件下，在时间 $t$ 处于状态 $j$ 的概率，它根据 Kolmogorov 前向方程演化：\n$$ \\frac{d P(t)}{dt} = P(t) Q $$\n初始条件为 $P(0) = I$，即单位矩阵。\n\n由于 $Q$ 矩阵的对称性，转移概率仅取决于初始状态和最终状态是相同还是不同。设 $P_{ii}(t)$ 是在时间 $t$ 内没有发生变化的概率，而对于 $i \\neq j$，$P_{ij}(t)$ 是发生特定变化的概率。对于任何 $i$，概率之和必须为1：\n$$ P_{ii}(t) + \\sum_{j \\neq i} P_{ij}(t) = 1 $$\n根据对称性，对于所有 $i \\neq j$，$P_{ij}(t)$ 都相等。因此，$P_{ii}(t) + 3P_{ij}(t) = 1$，这意味着 $P_{ij}(t) = \\frac{1 - P_{ii}(t)}{3}$。\n\n我们可以从矩阵方程中写出关于 $P_{ii}(t)$ 的微分方程。对于任意行 $i$：\n$$ \\frac{dP_{ii}(t)}{dt} = \\sum_{k=1}^{4} P_{ik}(t) Q_{ki} = P_{ii}(t) Q_{ii} + \\sum_{k \\neq i} P_{ik}(t) Q_{ki} $$\n$$ \\frac{dP_{ii}(t)}{dt} = P_{ii}(t)(-3\\alpha) + 3 P_{ij}(t)(\\alpha) $$\n代入 $P_{ij}(t) = \\frac{1 - P_{ii}(t)}{3}$：\n$$ \\frac{dP_{ii}(t)}{dt} = -3\\alpha P_{ii}(t) + 3\\alpha \\left(\\frac{1 - P_{ii}(t)}{3}\\right) = -3\\alpha P_{ii}(t) + \\alpha - \\alpha P_{ii}(t) $$\n$$ \\frac{dP_{ii}(t)}{dt} = \\alpha - 4\\alpha P_{ii}(t) $$\n这是一个一阶线性常微分方程。在初始条件 $P_{ii}(0) = 1$ 下，解为：\n$$ P_{ii}(t) = \\frac{1}{4} + \\frac{3}{4} \\exp(-4\\alpha t) $$\n\n两条序列在 $t$ 个时间单位前从共同祖先分化而来，它们之间观察到的差异比例 $p$ 是同源位点上的核苷酸不同的概率。分隔这两条序列的总进化时间是 $2t$。序列之间的差异概率等同于单个谱系在 $2t$ 的时间间隔内改变其状态的概率。\n设 $T = 2t$。在整个时间段内观察到没有变化的概率是 $P_{ii}(T) = P_{ii}(2t)$。\n$$ P_{\\text{same}} = \\frac{1}{4} + \\frac{3}{4} \\exp(-4\\alpha(2t)) = \\frac{1}{4} + \\frac{3}{4} \\exp(-8\\alpha t) $$\n观察到差异的概率 $p$ 是 $1 - P_{\\text{same}}$：\n$$ p = 1 - \\left( \\frac{1}{4} + \\frac{3}{4} \\exp(-8\\alpha t) \\right) = \\frac{3}{4} (1 - \\exp(-8\\alpha t)) $$\n\n每个位点的预期替换数 $d$ 是替换速率乘以总流逝时间。从任何核苷酸开始的替换速率是 $3\\alpha$。在总时间 $2t$ 内，预期的替换数是：\n$$ d = (3\\alpha) \\times (2t) = 6\\alpha t $$\n\n我们现在必须用 $p$ 来表示 $d$。从 $p$ 的方程开始：\n$$ \\frac{4p}{3} = 1 - \\exp(-8\\alpha t) $$\n$$ \\exp(-8\\alpha t) = 1 - \\frac{4p}{3} $$\n$$ -8\\alpha t = \\ln\\left(1 - \\frac{4p}{3}\\right) $$\n我们需要 $d = 6\\alpha t$。我们可以从 $8\\alpha t$ 计算得出：\n$$ 6\\alpha t = \\frac{6}{8} (8\\alpha t) = \\frac{3}{4} (8\\alpha t) = \\frac{3}{4} \\left[ -\\ln\\left(1 - \\frac{4p}{3}\\right) \\right] $$\n因此，Jukes-Cantor 校正公式为：\n$$ d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p\\right) $$\n\n现在，我们将此公式独立应用于同义和非同义位点。\n已知 $p_{S} = 0.3$：\n$$ d_S = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_S\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.3\\right) $$\n$$ d_S = -\\frac{3}{4} \\ln(1 - 0.4) = -\\frac{3}{4} \\ln(0.6) $$\n\n已知 $p_{N} = 0.05$：\n$$ d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_N\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.05\\right) $$\n$$ d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{1}{15}\\right) = -\\frac{3}{4} \\ln\\left(\\frac{14}{15}\\right) $$\n\n非同义与同义替换速率比 $\\omega$ 计算为 $d_N$与 $d_S$ 的比值：\n$$ \\omega = \\frac{d_N}{d_S} = \\frac{-\\frac{3}{4} \\ln\\left(\\frac{14}{15}\\right)}{-\\frac{3}{4} \\ln(0.6)} = \\frac{\\ln(14/15)}{\\ln(0.6)} $$\n我们现在计算数值：\n$$ \\ln(0.6) \\approx -0.5108256 $$\n$$ \\ln(14/15) \\approx \\ln(0.9333...) \\approx -0.0689929 $$\n$$ \\omega \\approx \\frac{-0.0689929}{-0.5108256} \\approx 0.135061 $$\n将结果四舍五入到四位有效数字，我们得到 $\\omega \\approx 0.1351$。", "answer": "$$\\boxed{0.1351}$$", "id": "2754886"}, {"introduction": "虽然替换模型对于估算进化距离至关重要，但它们的应用并非没有限制。本练习将Jukes-Cantor模型推向其理论极限，以探讨“饱和”（saturation）这一关键概念，即由于过多的多重替换导致系统发育信号丢失。理解这种饱和现象及其对$d_S$估计值可靠性的影响，对于正确解读$\\omega$比率和避免对选择压力做出错误推断至关重要。[@problem_id:2754872]", "problem": "比较两条蛋白质编码序列。根据遗传密码，已知在这些比较的位点上，替换绝大多数是同义的，这些位点被称为四重简并位点。设 $p_{S}$ 表示在这些同义位点上观察到的成对差异比例。假设这些同义位点的演化遵循 Jukes and Cantor (Jukes–Cantor 1969, JC69) 的等速率、等碱基频率的脱氧核糖核酸 (DNA) 替换模型，其中各位点随时间独立且以恒定速率演化，并且长期平衡碱基频率相等。设 $d_{S}$ 表示分隔这两条序列的每个同义位点的预期同义替换数。\n\n从 JC69 模型的连续时间马尔可夫链公式以及 $d_{S}$ 作为每位点预期替换数的定义出发，推导可观测量 $p_{S}$ 与校正距离 $d_{S}$ 之间的函数关系。然后，给定经验观察值 $p_{S} = 0.7$，计算相应的经 JC69 校正的 $d_{S}$。\n\n最后，基于模型的推理，而不是依赖经验法则，讨论这个 $d_{S}$ 的估计值在用于计算比率 $\\omega = d_{N}/d_{S}$ 时是否可靠，其中 $d_{N}$ 是非同义距离，尤其是在 $d_{N}$ 为中等大小（例如，数量级为 $0.2$）的情况下。您的讨论应考虑可识别性、因多次替换导致的方差膨胀以及与模型设定边界的接近程度。\n\n将校正后的同义距离 $d_{S}$ 表示为包含自然对数的精确解析表达式；不要对最终值进行近似或四舍五入。无需单位。", "solution": "该问题陈述是分子演化理论中一个有效的练习。它具有科学依据，提法得当且客观。我们将按要求进行推导和分析。\n\nJukes-Cantor (JC69) 模型是用于核苷酸替换的连续时间马尔可夫链。它假设从任何一种核苷酸替换为任何其他特定核苷酸的速率是一个常数 $\\alpha$。四个状态（例如，腺嘌呤、胞嘧啶、鸟嘌呤、胸腺嘧啶）的速率矩阵 $Q$ 如下所示：\n$$\nQ = \\begin{pmatrix}\n-3\\alpha  \\alpha  \\alpha  \\alpha \\\\\n\\alpha  -3\\alpha  \\alpha  \\alpha \\\\\n\\alpha  \\alpha  -3\\alpha  \\alpha \\\\\n\\alpha  \\alpha  \\alpha  -3\\alpha\n\\end{pmatrix}\n$$\n时间间隔 $t$ 的概率转移矩阵为 $P(t) = \\exp(Qt)$。通过对角化 $Q$，我们可以求出变化的概率。一个位点在时间 $t$ 后保持相同核苷酸的概率是：\n$$\nP_{\\text{same}}(t) = \\frac{1}{4} + \\frac{3}{4} \\exp(-4\\alpha t)\n$$\n它变为其他三种核苷酸中任意一种的概率是：\n$$\nP_{\\text{diff}}(t) = 1 - P_{\\text{same}}(t) = \\frac{3}{4} - \\frac{3}{4} \\exp(-4\\alpha t)\n$$\n\n我们正在比较两条序列，它们在过去的时间点 $t$ 从一个共同祖先分化而来。分隔这两条序列的总演化时间为 $T = 2t$。我们需要找到这两条序列中位点不同的概率。这等同于找到一个位点在经过总时间 $T = 2t$ 后与其祖先状态不同的概率。然而，一个更严谨的推导会考虑两个独立的谱系。\n\n在两个后代序列中，一个位点具有相同核苷酸的概率可以通过对祖先状态 $i$ 和后代状态 $k$ 的所有可能性求和来找到。假设所有 $i \\in \\{A, C, G, T\\}$ 的平衡频率为 $\\pi_i = 1/4$：\n$$\nP(\\text{sites are same}) = \\sum_{k} P(\\text{seq1 is } k, \\text{seq2 is } k) = \\sum_{k} \\sum_{i} \\pi_i P_{ik}(t) P_{ik}(t)\n$$\n由于 JC69 模型的对称性，$\\sum_i P_{ik}(t)^2$ 与 $k$ 无关。我们可以对 $k=A$ 进行计算：\n$$\n\\sum_{i} P_{iA}(t)^2 = P_{AA}(t)^2 + 3 P_{CA}(t)^2\n$$\n代入 $P_{AA}(t) = P_{\\text{same}}(t)$ 和 $P_{CA}(t) = \\frac{1}{3}P_{\\text{diff}}(t) = \\frac{1}{4} - \\frac{1}{4}\\exp(-4\\alpha t)$ 的表达式：\n$$\n\\sum_{i} P_{iA}(t)^2 = \\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha t)\\right)^2 + 3\\left(\\frac{1}{4} - \\frac{1}{4}\\exp(-4\\alpha t)\\right)^2\n$$\n$$\n= \\frac{1}{16} \\left[ (1+3\\exp(-4\\alpha t))^2 + 3(1-\\exp(-4\\alpha t))^2 \\right]\n$$\n$$\n= \\frac{1}{16} \\left[ (1 + 6\\exp(-4\\alpha t) + 9\\exp(-8\\alpha t)) + 3(1 - 2\\exp(-4\\alpha t) + \\exp(-8\\alpha t)) \\right]\n$$\n$$\n= \\frac{1}{16} [4 + 12\\exp(-8\\alpha t)] = \\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t)\n$$\n观察到的差异比例 $p_S$ 是位点不同的概率：\n$$\np_S = 1 - P(\\text{sites are same}) = 1 - \\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t)\\right) = \\frac{3}{4}(1 - \\exp(-8\\alpha t))\n$$\n量 $d_S$ 是分隔两条序列的每个同义位点的预期替换数。任何核苷酸每位点的替换速率为 $3\\alpha$。该速率适用于两个谱系。因此，在长度为 $t$ 的两个分支上预期的总替换数为：\n$$\nd_S = (3\\alpha)t + (3\\alpha)t = 6\\alpha t\n$$\n现在我们必须用 $d_S$ 来表示 $p_S$。从 $d_S = 6\\alpha t$ 可得 $8\\alpha t = \\frac{8}{6}d_S = \\frac{4}{3}d_S$。将此代入 $p_S$ 的方程：\n$$\np_S = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4}{3}d_S\\right)\\right)\n$$\n这就是可观测量 $p_S$ 与校正距离 $d_S$ 之间的函数关系。为了用 $p_S$ 求解 $d_S$，我们对该函数求逆：\n$$\n\\frac{4}{3}p_S = 1 - \\exp\\left(-\\frac{4}{3}d_S\\right)\n$$\n$$\n\\exp\\left(-\\frac{4}{3}d_S\\right) = 1 - \\frac{4}{3}p_S\n$$\n$$\n-\\frac{4}{3}d_S = \\ln\\left(1 - \\frac{4}{3}p_S\\right)\n$$\n$$\nd_S = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}p_S\\right)\n$$\n这就是 Jukes-Cantor 校正公式。\n\n给定经验观察值 $p_S = 0.7$，我们计算相应的校正距离 $d_S$：\n$$\nd_S = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}(0.7)\\right) = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}\\frac{7}{10}\\right) = -\\frac{3}{4}\\ln\\left(1 - \\frac{28}{30}\\right)\n$$\n$$\nd_S = -\\frac{3}{4}\\ln\\left(1 - \\frac{14}{15}\\right) = -\\frac{3}{4}\\ln\\left(\\frac{1}{15}\\right) = -\\frac{3}{4}(-\\ln(15)) = \\frac{3}{4}\\ln(15)\n$$\n最后，我们必须讨论这个估计值在用于计算比率 $\\omega = d_N/d_S$ 时的可靠性。\n\n估计值 $d_S = \\frac{3}{4}\\ln(15)$ 的可靠性因模型和数据固有的三个相关问题而受到严重影响。\n\n1.  **接近模型设定的边界和饱和状态**：JC69 模型对可观察的差异比例有一个理论上限。当真实距离 $d_S$ 趋于无穷大时，$p_S$ 会渐近地接近一个最大值。从方程 $p_S = \\frac{3}{4}(1 - \\exp(-\\frac{4}{3}d_S))$ 可以看出，当 $d_S \\to \\infty$ 时，指数项趋于 $0$，因此 $p_S \\to \\frac{3}{4} = 0.75$。这种状态被称为饱和，此时系统发育信号丢失，序列之间相对于彼此呈现随机性。给定的观察值 $p_S = 0.7$ 极其接近这个 $0.75$ 的饱和边界。校正函数 $d_S = -\\frac{3}{4}\\ln(1 - \\frac{4}{3}p_S)$ 在 $p_S = 0.75$ 处有一条垂直渐近线。这意味着一个非常宽范围的大真实距离都会映射到非常接近 $0.75$ 的观察差异上，使得距离估计在该区域内不可识别。\n\n2.  **方差膨胀**：校正函数在饱和点附近的极端非线性导致抽样方差的巨大膨胀。估计距离的方差 $\\text{Var}(\\hat{d}_S)$ 可以使用 delta 方法来近似。设 $f(p_S) = -\\frac{3}{4}\\ln(1 - \\frac{4}{3}p_S)$。方差近似为 $\\text{Var}(\\hat{d}_S) \\approx [f'(p_S)]^2 \\text{Var}(\\hat{p}_S)$。其导数为：\n    $$\n    f'(p_S) = \\frac{d}{dp_S}\\left[-\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}p_S\\right)\\right] = -\\frac{3}{4} \\cdot \\frac{1}{1-\\frac{4}{3}p_S} \\cdot \\left(-\\frac{4}{3}\\right) = \\frac{1}{1-\\frac{4}{3}p_S}\n    $$\n    对于 $p_S = 0.7$，导数为 $f'(0.7) = \\frac{1}{1 - \\frac{4}{3}(0.7)} = \\frac{1}{1 - 14/15} = 15$。因此，相对于观察比例 $\\hat{p}_S$ 的方差，距离估计的方差被放大了 $(f'(0.7))^2 = 15^2 = 225$ 倍。由于序列长度有限，对 $p_S$ 测量的任何微小误差（这是不可避免的）都将被这个巨大的因子放大，导致 $d_S$ 的估计值具有一个极大的置信区间。\n\n3.  **$\\omega$ 比率的不可靠性**：我们的目的是计算 $\\omega = d_N/d_S$。给定一个中等大小的 $d_N$ 约等于 $0.2$，$\\omega$ 的点估计大约为 $0.2 / (\\frac{3}{4}\\ln(15)) \\approx 0.2 / 2.03 \\approx 0.099$。这表明存在强烈的纯化选择。然而，分母 $d_S$ 不是一个可靠的数字；它是一个具有巨大方差的点估计。因为 $d_S$ 在分母中，$\\omega$ 估计量的结果分布将是高度偏斜且异常宽广的。$\\omega$ 的置信区间很可能会非常宽，以至于包含对应于中性演化（$\\omega=1$）甚至可能正选择（$\\omega1$）的值，从而使 $0.099$ 这个点估计实际上毫无意义。对作用于蛋白质的选择的性质做出任何统计上可靠的推断都将是不可能的。\n\n总之，虽然计算得出了 $d_S$ 的一个具体值，但这个值并不可靠。用它来计算 $\\omega$ 将是一种科学上不合理的做法，因为结果将主要由统计噪声和模型饱和的假象所主导。", "answer": "$$\\boxed{\\frac{3}{4}\\ln(15)}$$", "id": "2754872"}]}