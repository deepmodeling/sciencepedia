## 引言
自然选择如何塑造蕴藏于DNA中的生命蓝图？在分子水平上量化选择的强度与方向，是[演化生物学](@entry_id:145480)的一项核心挑战。[非同义替换](@entry_id:164124)率与[同义替换](@entry_id:167738)率之比，即 dN/dS（或写作 ω），为这一难题提供了强大而广泛应用的解决方案。通过比较改变蛋白质序列的替换与不改变[蛋白质序列](@entry_id:184994)的替换，该比率成为了衡量作用于基因的[选择压力](@entry_id:175478)的量化指标，使我们能够区分功能约束、中性漂变和适应性演化。

本文旨在为研究生及研究人员提供一次对 dN/dS 分析的全面探索，从基础理论到实际应用，助您掌握有效使用这一工具并批判性地解读其结果的知识。

在第一章 **原理与机制** 中，我们将深入剖析 dN/dS 比率，探索其从遗传密码到群体遗传学的理论基础。您将学习计算该比率的具体方法，并理解用于处理现实世界复杂性的精密[统计模型](@entry_id:165873)。

接下来，在 **应用与跨学科连接** 章节中，我们将通过一系列案例研究，展示 dN/dS 分析的广泛适用性。您将看到它如何被用于剖析基因功能、揭示[物种适应](@entry_id:199873)新环境的遗传基础、追踪演化军备竞赛，甚至阐明癌症和病毒感染等疾病的演化过程。

最后，**动手实践** 章节将提供应用这些概念的机会。通过引导性练习，您将从基础计算逐步进阶到实现先进的、基于[系统发育](@entry_id:137790)的方法来检测[正选择](@entry_id:165327)，从而巩固您的理解并为自己的研究建立实用技能。

## 原理与机制

本章深入探讨了用于检测自然选择的[非同义替换](@entry_id:164124)率与[同义替换](@entry_id:167738)率之比（$d_N/d_S$）的理论基础、计算方法和解释框架。我们将从分子生物学的基本概念出发，逐步构建起一个严谨的体系，用于理解和应用这一分子进化研究中的核心工具。我们将揭示该比率如何与群体遗传学原理相关联，并讨论在实际数据分析中必须考虑的各种复杂因素。

### 基本定义：从[密码子](@entry_id:274050)到替换

[分子生物学](@entry_id:140331)的[中心法则](@entry_id:136612)阐明了遗传信息从DNA流向RNA，再到蛋白质的过程。在蛋白质编码基因中，DNA序列上的[核苷酸](@entry_id:275639)以三个一组的形式被读取，每一组称为一个**[密码子](@entry_id:274050)**。遗传密码表将这64个可能的[密码子](@entry_id:274050)（由4种[核苷酸](@entry_id:275639)组成）映射到20种[标准氨基酸](@entry_id:166527)或一个终止信号。由于[密码子](@entry_id:274050)数量多于氨基酸种类，遗传密码具有**简并性**（degeneracy），即多种[密码子](@entry_id:274050)可以编码同一个氨基酸。

这种简并性是理解 $d_N/d_S$ 的关键。[编码序列](@entry_id:204828)中的单[核苷酸](@entry_id:275639)突变可以根据其对所编码[蛋白质序列](@entry_id:184994)的影响分为两类：

1.  **[同义替换](@entry_id:167738)（Synonymous Substitution）**：指一个[核苷酸](@entry_id:275639)的改变导致[密码子](@entry_id:274050)改变，但所编码的氨基酸保持不变。例如，在标准遗传密码下，从 `GAG`（谷氨酸）变为 `GAA`（谷氨酸）就是一个[同义替换](@entry_id:167738)。

2.  **[非同义替换](@entry_id:164124)（Nonsynonymous Substitution）**：指一个[核苷酸](@entry_id:275639)的改变导致所编码的氨基酸发生改变。例如，从 `GAG`（谷氨酸）变为 `GAC`（天冬氨酸），或从 `ATG`（甲硫氨酸）变为 `ATA`（异亮氨酸），都属于[非同义替换](@entry_id:164124)。凡是导致[蛋白质序列](@entry_id:184994)发生改变的替换，包括变为[终止密码子](@entry_id:275088)的替换，都计入[非同义替换](@entry_id:164124)。

我们需要严谨地区分这些术语与其他相关概念。例如，“沉默突变”（silent mutation）通常指不改变蛋白质序列的突变，这在功能上与“同义”的定义重合。然而，这并不意味着同义突变在演化上是完全“沉默”或中性的。即使[氨基酸序列](@entry_id:163755)不变，选择压力仍可能作用于[同义密码子](@entry_id:175611)，例如通过影响翻译效率和准确性（**[密码子使用偏好](@entry_id:143761)**，codon usage bias）、改变mRNA的二级结构稳定性，或破坏[剪接](@entry_id:181943)增[强子](@entry_id:158325)等调控元件。另一方面，“[保守性替换](@entry_id:165507)”（conservative substitution）指的是一种[非同义替换](@entry_id:164124)，其中新的氨基酸与原始氨基酸具有相似的理化性质（如[电荷](@entry_id:275494)、极性或大小）。它描述的是[非同义替换](@entry_id:164124)的一个[子集](@entry_id:261956)，而不是其同义词。在计算 $d_N/d_S$ 时，任何改变氨基酸的替换，无论是保守的还是激进的，都必须被归类为[非同义替换](@entry_id:164124) [@problem_id:2757612]。

### 量化演化机会：计算同义与非同义位点数

为了有意义地比较同义和非同义变化的速率，我们必须对每种变化类型的“机会”数量进行归一化。一个简单的碱基对差异计数是不足够的，因为在[基因序列](@entry_id:191077)中，并非所有潜在的突变都有相同的效应。因此，我们引入了**同义位点数（$S_S$）**和**非同义位点数（$S_N$）**的概念。这些数值代表了在整个序列中，分别有多少比例的潜在突变是同义的或非同义的。

计算这些位点数有多种方法，最直观的一种是基于计数的近似方法。其核心思想是检查序列中每个[核苷酸](@entry_id:275639)位置所有可能发生的单步突变，并根据遗传密码表对这些突变进行分类。对于一个给定的[核苷酸](@entry_id:275639)位点 $i$，我们可以定义其非同义位点贡献 $f_i$ 为在该位置上三种可能的单[核苷酸](@entry_id:275639)变化中导致[非同义替换](@entry_id:164124)的比例。相应地，同义位点贡献为 $s_i = 1 - f_i$。整个序列的总非同义位点数 $S_N$ 和总同义位点数 $S_S$ 就是所有位点贡献的总和：$S_N = \sum_i f_i$ 且 $S_S = \sum_i s_i$。

让我们通过一个具体的例子来说明这个过程 [@problem_id:2757608]。考虑一段DNA编码序列 `GCT GGT TTT`，它编码丙氨酸-甘氨酸-苯丙氨酸。我们逐个分析每个[核苷酸](@entry_id:275639)位点：

*   **[密码子](@entry_id:274050)1：GCT (丙氨酸)**
    *   位置1 (G)：所有3种变化（`ACT`→苏氨酸, `CCT`→脯氨酸, `TCT`→丝氨酸）都是非同义的。因此，$f_1 = 3/3 = 1$。
    *   位置2 (C)：所有3种变化（`GAT`→天冬氨酸, `GGT`→甘氨酸, `GTT`→缬氨酸）都是非同义的。因此，$f_2 = 3/3 = 1$。
    *   位置3 (T)：所有3种变化（`GCA`, `GCC`, `GCG`）仍然编码丙氨酸，都是同义的。因此，$f_3 = 0/3 = 0$。

*   **[密码子](@entry_id:274050)2：GGT (甘氨酸)**
    *   位置4 (G) 和 位置5 (G)：与上面类似，这两个位置的所有变化都是非同义的。因此，$f_4 = 1$，$f_5 = 1$。
    *   位置6 (T)：所有3种变化（`GGA`, `GGC`, `GGG`）仍然编码甘氨酸，都是同义的。因此，$f_6 = 0$。

*   **[密码子](@entry_id:274050)3：TTT (苯丙氨酸)**
    *   位置7 (T) 和 位置8 (T)：这两个位置的所有变化都是非同义的。因此，$f_7 = 1$，$f_8 = 1$。
    *   位置9 (T)：在3种变化中，`TTC` 仍然编码苯丙氨酸（同义），而 `TTA` 和 `TTG` 编码亮氨酸（非同义）。因此，$f_9 = 2/3$。

将所有位点的非同义贡献相加，我们得到总的非同义位点数：
$S_N = \sum_{i=1}^{9} f_i = 1 + 1 + 0 + 1 + 1 + 0 + 1 + 1 + \frac{2}{3} = 6 + \frac{2}{3} = \frac{20}{3}$。
同样地，我们可以计算总的同义位点数 $S_S = \sum (1-f_i) = 9 - S_N = 9 - \frac{20}{3} = \frac{7}{3}$。这个例子清晰地展示了，即使在很短的序列中，不同位点对同义和[非同义替换](@entry_id:164124)的贡献也存在显著差异。

### 从观察差异到替换率：估算 $d_N$ 和 $d_S$

在比较两个同源序列时，我们直接观察到的是它们之间的[核苷酸](@entry_id:275639)差异。然而，这个观察值往往低估了[演化过程](@entry_id:175749)中发生的真实替换事件总数。这是因为随着时间的推移，同一个位点可能发生多次替换（即**多重打击**，multiple hits），例如一个碱基从A变为G，之后又变回A。这些隐藏的替换事件无法通过简单的成对比较被观察到。

因此，为了准确估算**每个非同义位点的[非同义替换](@entry_id:164124)数（$d_N$）**和**每个同义位点的[同义替换](@entry_id:167738)数（$d_S$）**，我们需要进行多重打击校正。一个标准流程如下 [@problem_id:2757595]：

1.  **计算观察差异比例**：首先，我们将观察到的同义差异数（$X_S$）和非同义差异数（$X_N$）分别除以对应的位点总数（$S_S$ 和 $S_N$），得到观察差异比例 $p_S = X_S / S_S$ 和 $p_N = X_N / S_N$。

2.  **应用多重打击校正**：接下来，我们使用一个[核苷酸](@entry_id:275639)[替换模型](@entry_id:177799)来校正这些比例。最简单的模型之一是**[Jukes-Cantor (JC69)](@entry_id:176270) 模型**，它假设所有类型的[核苷酸](@entry_id:275639)替换以相同的速率发生。该模型提供了一个将观察差异比例 $p$ 转换为估计替换数 $d$ 的公式：
    $d = -\frac{3}{4} \ln\left(1 - \frac{4}{3}p\right)$

    这个公式分别应用于同义和非同义位点类别，以获得校正后的 $d_S$ 和 $d_N$。例如，如果观察到的同义差异比例 $p_S = 130/720$ 且非同义差异比例 $p_N = 240/1980$，我们可以计算：
    $d_S = -\frac{3}{4} \ln\left(1 - \frac{4}{3} \cdot \frac{130}{720}\right) \approx 0.2754$
    $d_N = -\frac{3}{4} \ln\left(1 - \frac{4}{3} \cdot \frac{240}{1980}\right) \approx 0.1763$

3.  **计算 $\omega$ 比率**：最后，将校正后的 $d_N$ 和 $d_S$ 相除，得到最终的 $\omega$ 值：
    $\omega = \frac{d_N}{d_S} \approx \frac{0.1763}{0.2754} \approx 0.6401$

这个 $\omega$ 值是衡量蛋白质编码基因所受[选择压力](@entry_id:175478)的核心指标。

### $d_N/d_S$ 的[群体遗传学](@entry_id:146344)基础

$d_N/d_S$ 比率的解释力根植于[群体遗传学](@entry_id:146344)的基本原理。一个等位基因在群体中的演化命运取决于突变和选择的相互作用。一个关键的公式是：**替换率 = [突变率](@entry_id:136737) × [固定概率](@entry_id:178551)**。

*   **$d_S$ 作为中性基准**：[同义替换](@entry_id:167738)通常被假定为（或接近于）选择中性。对于一个[中性突变](@entry_id:176508)，其在[二倍体](@entry_id:268054)群体中的**[固定概率](@entry_id:178551)（probability of fixation）**为 $1/(2N_e)$，其中 $N_e$ 是**有效群体大小**。因此，中性位点的替换率等于每个位点的[中性突变](@entry_id:176508)率。$d_S$ 因此被用作衡量背景[中性演化](@entry_id:172700)速率的基准。

*   **$d_N$ 反映选择效应**：[非同义替换](@entry_id:164124)的命运则受到其对[个体适应](@entry_id:190630)度（fitness）影响的调控。一个新突变的适应度效应通常用[选择系数](@entry_id:155033) $s$ 来量化。根据木村资生的[扩散近似](@entry_id:147930)理论，一个具有选择系数 $s$ 的新突变在[二倍体](@entry_id:268054)群体中的[固定概率](@entry_id:178551)为：
    $\nu(s) = \frac{1 - \exp(-2s)}{1 - \exp(-4N_e s)}$

这个公式揭示了 $\omega = d_N/d_S$ 比率的生物学意义，它[实质](@entry_id:149406)上是新产生的非[同义突变](@entry_id:185551)的平均[固定概率](@entry_id:178551)相对于[中性突变](@entry_id:176508)[固定概率](@entry_id:178551)的比值。

#### 纯化选择 ($\omega  1$)

当非同义突变平均上是有害的（$s  0$）时，我们称之为**纯化选择（purifying selection）**或[负选择](@entry_id:170615)。有害突变的[固定概率](@entry_id:178551) $\nu(s)$ 会低于中性[固定概率](@entry_id:178551) $\nu(0)$。因此，[非同义替换](@entry_id:164124)的速率会低于[同义替换](@entry_id:167738)的速率，导致 $\omega  1$。$\omega$ 值越接近0，表明[纯化选择](@entry_id:170615)越强，蛋白质的功能约束越强。

选择的效率取决于标度选择系数 $|N_e s|$。当 $|N_e s| \gtrsim 1$ 时，选择能有效地清除有害突变，使其[固定概率](@entry_id:178551)接近于0。当 $|N_e s| \ll 1$ 时，突变的行为接近中性，其[固定概率](@entry_id:178551)约等于 $1/(2N_e)$。一个基因的整体 $\omega$ 值是其所有新发非[同义突变](@entry_id:185551)的**[适应度效应分布](@entry_id:181443)（Distribution of Fitness Effects, DFE）**的加权平均结果。例如，考虑一个假想的DFE，其中60%的突变是强有害的（$s = -10^{-2}$），30%是弱有害的（$s = -10^{-5}$），9%是中性的，1%是弱有利的。在一个 $N_e = 10^5$ 的群体中，强[有害突变](@entry_id:175618)的 $|N_e s| = 1000 \gg 1$，其[固定概率](@entry_id:178551)几乎为0。弱有害突变的 $|N_e s| = 1$，其[固定概率](@entry_id:178551)也被显著降低。最终，只有那些接近中性或有利的突变对 $d_N$ 有显著贡献，导致整体的 $\omega$ 远小于1（在此例中约为0.12） [@problem_id:2757629]。

#### [中性演化](@entry_id:172700) ($\omega = 1$)

当非[同义突变](@entry_id:185551)和[同义突变](@entry_id:185551)一样都是中性时，它们的[固定概率](@entry_id:178551)相同。因此，$d_N$ 将等于 $d_S$，导致 $\omega = 1$。这通常被解释为相应蛋白质区域缺乏功能约束，或者说正在经历[假基因化](@entry_id:177383)（pseudogenization）的过程。

#### 正选择 ($\omega > 1$)

当非[同义突变](@entry_id:185551)平均上是有利的（$s > 0$）时，我们称之为**[正选择](@entry_id:165327)（positive selection）**或适应性演化。有利突变的[固定概率](@entry_id:178551) $\nu(s)$ 高于中性[固定概率](@entry_id:178551)。如果有利突变的贡献足够大，足以抵消DFE中[有害突变](@entry_id:175618)的抑制作用，那么整体的[非同义替换](@entry_id:164124)率 $d_N$ 就会超过[同义替换](@entry_id:167738)率 $d_S$，导致 $\omega > 1$。因此，$\omega > 1$ 是检测适应性[分子演化](@entry_id:148874)的一个有力信号。

$\omega > 1$ 的条件可以通过一个简单的模型推导出来 [@problem_id:2757632]。假设非同义突变由比例为 $f_a$ 的有利突变（[选择系数](@entry_id:155033) $s_a > 0$）、比例为 $f_d$ 的[有害突变](@entry_id:175618)（$s_d  0$）和比例为 $f_n$ 的[中性突变](@entry_id:176508)组成。$\omega > 1$ 的条件可以表示为：
$f_a(R(s_a) - 1) > f_d(1 - R(s_d))$
其中 $R(s) = 2N_e \nu(s)$ 是突变相对于[中性突变](@entry_id:176508)的[固定概率](@entry_id:178551)。这个不等式表明，要使 $\omega > 1$，来自有利突变类别的总“超额”固定率必须超过来自有害突变类别的总“亏损”固定率。即使有利突变的比例 $f_a$ 很小，只要选择足够强（即 $s_a$ 较大）且/或群体足够大（$N_e$ 较大），也可能驱动 $\omega$ 超过1。

### 高级模型与实践考量

在实际应用中，简单的 $d_N/d_S$ 计算和解释会遇到多种复杂情况。现代分子进化分析已经发展出更复杂的模型来应对这些挑战。

#### 方法论偏差：计数法 vs. 基于模型的估计

早期的 $d_N/d_S$ 估算方法，如**Nei-Gojobori (NG86) 方法**，依赖于对位点和差异进行计数，并应用简单的多重打击校正（如JC69）。这类方法虽然直观，但在许多生物学现实场景中会产生偏差 [@problem_id:2757620]：

*   **转换/[颠换](@entry_id:270979)偏倚（Transition/Transversion Bias）**：在真实演化中，转换（嘌呤之间或嘧啶之间的替换）通常比[颠换](@entry_id:270979)（嘌呤与嘧啶之间的替换）更频繁。NG86的位点计数方法假设所有突变路径等概率，这会低估同义位点的有效数量（因为许多同义路径是高频的转换），从而高估 $d_S$ 并最终低估 $\omega$。
*   **饱和效应（Saturation Effect）**：随着[演化距离](@entry_id:177968)增加，同义位点由于其更高的替换率，会比非同义位点更快地达到饱和（即观察到的差异比例停止增长）。使用JC69等单一速率模型进行校正，会严重低估真实的 $d_S$，导致 $\omega$ 被高估。

相比之下，现代的**最大似然（Maximum Likelihood, ML）[密码子模型](@entry_id:203002)**，如Goldman和Yang（1994）的模型，在一个统一的概率框架内对[密码子](@entry_id:274050)替换过程进行建模。这些模型可以显式地包含转换/[颠换](@entry_id:270979)率比（$\kappa$）、[密码子](@entry_id:274050)频率偏倚等参数，并能更准确地处理多重打击和[路径依赖性](@entry_id:186326)，从而提供更无偏的 $\omega$ 估计。在理想化的条件下（如 $\kappa=1$，[密码子](@entry_id:274050)频率均等，[演化距离](@entry_id:177968)极小），ML方法和NG86方法的结果会趋于一致 [@problem_id:2757620]。

#### 位点异质性：为何单一 $\omega$ 值不足够

蛋白质的不同位点承担着不同的功能，因此受到的[选择压力](@entry_id:175478)也各不相同。一些位点（如[活性中心](@entry_id:136476)）可能受到极强的纯化选择，而另一些位点（如表面抗原决定簇）则可能经历反复的[正选择](@entry_id:165327)。如果将一个单一的 $\omega$ 值强加于整个基因，该值将是所有位点选择压力的平均值。当大部分位点是保守的而只有少数位点经历正选择时，这个平均的 $\omega$ 值几乎肯定会小于1，从而掩盖了适应性演化的真实信号 [@problem_id:2844388]。

为了解决这个问题，研究者开发了**[位点异质性模型](@entry_id:262819)（site-heterogeneity models）**。这些模型允许 $\omega$ 值在不同位点间变化。常见的方法包括：
*   **离散类别模型**：假设存在有限个（例如2个、3个或更多）$\omega$ 类别，每个类别有其自身的 $\omega$ 值和在所有位点中所占的比例。例如，一个模型可能包含一个代表纯化选择的类别（$\omega_0  1$）、一个代表[中性演化](@entry_id:172700)的类别（$\omega_1 = 1$）和一个代表正选择的类别（$\omega_2 > 1$）。
*   **连续分布模型**：假设 $\omega$ 值遵循某个[连续概率分布](@entry_id:636595)，如在区间 (0, 1) 上的Beta[分布](@entry_id:182848)，有时会额外增加一个允许 $\omega > 1$ 的类别。

通过将$\omega$的位点间变异显式地纳入模型，我们可以更准确地估计不同[选择压力](@entry_id:175478)下的位点比例，并识别出那些可能受[正选择](@entry_id:165327)驱动的特定位点。这种做法不仅能显著提高模型的统计拟合度，还能减少因错误建模而导致的对其他参数（如[分支长度](@entry_id:177486)）的偏误估计 [@problem_id:2844388]。

#### 时间[异质性](@entry_id:275678)：种群统计历史的影响

选择的效率与有效群体大小 $N_e$ 密切相关。在大的群体中，即使是选择效应微弱的突变（小的 $|s|$），其命运也主要由选择决定。相反，在小的群体中，遗传漂变（genetic drift）的作用增强，使得弱有害突变更容易被固定，弱有利突变更容易丢失。

这意味着，沿着一个系统发育树的分支，如果 $N_e$ 发生波动，那么[选择压力](@entry_id:175478)和 $\omega$ 值也可能随之变化 [@problem_id:2757617]。例如，一个分支可能经历了一个 $N_e$ 较小的时期（瓶颈期），随后进入一个 $N_e$ 较大的时期。
*   在 $N_e$ 较小的时期，纯化选择被削弱（弱[有害突变](@entry_id:175618)表现得像[中性突变](@entry_id:176508)），$\omega$ 会趋近于1。同时，[正选择](@entry_id:165327)的效率也降低。
*   在 $N_e$ 较大的时期，[纯化选择](@entry_id:170615)变得非常高效，会压低 $\omega$。然而，[正选择](@entry_id:165327)的效率也大大增强，因为有利突变的[固定概率](@entry_id:178551)（$2s$）在乘以群体突变输入（$2N_e \mu$）后，对替换率的贡献（$4N_e s \mu$）与 $N_e$ 成正比。

因此，一个大的 $N_e$ 可以同时增强[纯化选择](@entry_id:170615)和正选择。在某些DFE下，后者的效应可能更强，导致在 $N_e$ 较大的时期观察到更高的 $\omega$ 值。一个标准的、对整个分支只估计一个 $\omega$ 值的模型，会得到一个对不同时期 $\omega$ 值的加权平均值。这个复合的 $\omega$ 值会掩盖底层复杂的演化动态，使得对选择历史的解释变得困难。例如，一个复合 $\omega=2.5$ 的分支，可能实际上是由一个近中性的时期（$\omega \approx 1$）和一个强正选择的时期（$\omega = 4$）组成的 [@problem_id:2757617]。

#### 基因内重组的混淆效应

标准的[最大似然](@entry_id:146147)[密码子模型](@entry_id:203002)有一个基本假设：被分析的比对序列中的所有位点都共享同一个[系统发育树](@entry_id:140506)。然而，**基因内重组（intragenic recombination）**会破坏这个假设。重组事件会在不同谱系之间交换遗传物质，导致一个基因的不同区段拥有不同的演化历史（即不同的[树拓扑](@entry_id:165290)结构）。

如果一个包含重组的[序列比对](@entry_id:172191)被强制用单一的[系统发育树](@entry_id:140506)进行分析，就会产生严重的[统计偏差](@entry_id:275818) [@problem_id:2757621]。在错误的拓扑结构下，那些在真实树上只需一次突变就能解释的共享衍生特征，会被错误地解释为多次独立的平行或趋同替换（**同塑性**，homoplasy）。模型为了解释这些人为制造的同塑性，会不正确地推断出大量的替换事件，从而不成比例地夸大 $d_N$ 的值，因为非同义位点通常远未饱和，对这种人为增加的替换数更敏感。其结果是，$d_N/d_S$ 比率被虚假地推高，可能将一个真实处于[纯化选择](@entry_id:170615)下的基因（$\omega  1$）错误地判断为经历了正选择（$\omega > 1$）。

处理重组问题的正确策略包括：
1.  **检测**：使用正式的统计检验方法（如四配子检验、成对同塑性指数PHI等）来检测重组信号并识别潜在的断点。
2.  **分割**：将[序列比对](@entry_id:172191)分割成多个据信没有发生重组的区段。
3.  **独立分析**：为每个区段分别推断其自身的[系统发育树](@entry_id:140506)，并在此树下进行独立的 $d_N/d_S$ 分析。或者，只分析最长的、没有显著重组证据的区段，以牺牲统计功效为代价换取模型的充分性 [@problem_id:2757621]。

#### 一个正式的数学框架

最后，值得一提的是，所有这些现代[密码子模型](@entry_id:203002)都建立在**[连续时间马尔可夫链](@entry_id:276307)（Continuous-Time Markov Chain, CTMC）**的数学框架之上。在这个框架中，[密码子](@entry_id:274050)之间的替换被描述为一个速率矩阵 $Q$，其中元素 $q_{ij}$ 表示从[密码子](@entry_id:274050) $i$ 到[密码子](@entry_id:274050) $j$ 的瞬时替换率。

$d_N$ 和 $d_S$ 可以被严格地定义为在一段演化时间内，每个相应位点上发生的预期替换次数 [@problem_id:2757615]。预期的总替换数可以通过对整个序列在整个时间段内所有可能的替换路径的速率进行积分得到。然后，这个总数再通过相应的位点数进行归一化。这个位点数本身需要通过一个独立于选择的纯突变模型来计算，以准确反映突变过程本身提供的同义和非同义“机会”。这个严谨的框架将突变过程（提供变异）和选择过程（筛选变异）清晰地分离开来，为我们理解和应用 $d_N/d_S$ 比率提供了坚实的理论基石。