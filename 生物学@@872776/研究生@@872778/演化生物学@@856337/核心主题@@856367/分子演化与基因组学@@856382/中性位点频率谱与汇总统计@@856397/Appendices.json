{"hands_on_practices": [{"introduction": "在群体遗传学中，第一步通常是利用测序数据估算关键的群体参数。Watterson的估计量 $\\hat{\\theta}_W$ 是一个基础工具，它将样本中可观测的变量——分离位点数 $S$——与群体尺度的突变率 $\\theta = 4N_e\\mu$ 联系起来。这个练习将引导你通过从合并理论的第一性原理出发，推导并计算 $\\hat{\\theta}_W$，将抽象理论与具体的计算技能相结合，为更复杂的分析奠定基础。[@problem_id:2739378]", "problem": "考虑一个在标准中性溯祖模型下演化的泛交二倍体种群，其有效种群大小恒定，并遵循无限位点突变模型。设每个位点的定标突变率为 $\\theta = 4 N_{e} \\mu$，其中 $N_{e}$ 是有效种群大小，$\\mu$ 是每个位点每代的突变率。您从单个种群中获得了大小为 $n=25$ 的染色体样本。在一个长度为 $L=50\\,\\text{kb}$ 的连续可检测区域（假设在无限位点模型下，$L$ 恰好为 $50{,}000$ 个独立位点）中，您在样本中观察到 $S=120$ 个分离位点。利用中性位点频率谱框架，并从分离位点的期望数量与突变率和一个源于谱系的、依赖于样本大小的谐波因子呈线性关系这一事实出发，推导出一个基于 $S$ 的每个位点定标突变率的无偏矩估计量，并为这些数据计算其数值。然后，通过乘以 $1000$，将此单位点估计值转换为单位千碱基（per-kilobase）的估计值。按顺序报告这两个数值：单位点值，然后是单位千碱基值。将两个报告的数值均四舍五入至四位有效数字。在最终的方框答案中不要包含单位；应分别将其解释为“单位点”和“单位kb”。", "solution": "所提供的问题具有科学依据、提法明确且客观。它代表了中性溯祖理论在群体遗传学中的一个基本应用。因此，该问题是有效的，并将提供解答。\n\n目标是推导每个位点定标突变率 $\\theta = 4N_{e}\\mu$ 的一个无偏矩估计量，并根据一个大小为 $n=25$ 的染色体样本计算其值，在该样本中，于一个长度为 $L=50000$ 个位点的区域内观察到 $S=120$ 个分离位点。\n\n推导始于标准中性溯祖模型的框架，该模型适用于一个有效种群大小 $N_e$ 恒定的二倍体泛交种群。此模型中的时间通常以 $2N_e$ 代为单位进行度量。对于一个包含 $n$ 个单倍体序列（染色体）的样本，其谱系是向后追溯的。该过程从 $n$ 个不同的谱系开始。在每一步中，两个谱系合并（溯祖）成一个共同祖先。这个过程一直持续到只剩下一个谱系，即样本的最近共同祖先（MRCA）。\n\n当存在 $k$ 个活跃谱系时的时间 $T_k$ 是一个指数分布的随机变量，其速率参数为 $\\binom{k}{2}$，因为任何一对谱系都可能发生溯祖。因此，存在 $k$ 个谱系的期望时间为 $E[T_k] = \\frac{1}{\\binom{k}{2}}$。在此区间内，谱系中所有分支的总长度为 $k \\cdot T_k$。在有 $k$ 个谱系的区间内，对总树长的期望贡献是：\n$$E[k T_k] = k \\cdot E[T_k] = k \\cdot \\frac{1}{\\binom{k}{2}} = k \\cdot \\frac{1}{\\frac{k(k-1)}{2}} = \\frac{2}{k-1}$$\n这些时间单位是 $2N_e$ 代。\n\n谱系的总期望长度 $E[T_{\\text{total}}]$ 是从 $k=n$ 到 $k=2$ 的这些期望长度之和：\n$$E[T_{\\text{total}}] = \\sum_{k=2}^{n} E[k T_k] = \\sum_{k=2}^{n} \\frac{2}{k-1}$$\n通过代换 $i=k-1$，此和变为：\n$$E[T_{\\text{total}}] = 2 \\sum_{i=1}^{n-1} \\frac{1}{i} = 2a_{n-1}$$\n其中 $a_{n-1} = \\sum_{i=1}^{n-1} \\frac{1}{i}$ 是第 $(n-1)$ 个调和数。这是以 $2N_e$ 代为单位的总期望谱系分支长度。为了将其转换为以代为单位，我们乘以 $2N_e$：\n$$E[T_{\\text{gen}}] = E[T_{\\text{total}}] \\cdot (2N_e) = (2a_{n-1}) \\cdot (2N_e) = 4N_e a_{n-1}$$\n\n在无限位点模型下，每次突变都会产生一个新的分离位点。假定突变沿着谱系的分支以泊松过程发生。每个位点每代的突变率为 $\\mu$。对于一个长度为 $L$ 个位点的区域，每代的总突变率为 $\\mu L$。分离位点的期望数量 $E[S]$ 是每代总突变率与以代为单位的总期望分支长度的乘积：\n$$E[S] = (\\mu L) \\cdot E[T_{\\text{gen}}] = (\\mu L) \\cdot (4N_e a_{n-1}) = (4N_e\\mu) L a_{n-1}$$\n使用每个位点定标突变率的定义 $\\theta = 4N_e\\mu$，我们得到基本关系式：\n$$E[S] = \\theta L a_{n-1}$$\n这证实了分离位点的期望数量与突变率（$\\theta$）和依赖于样本大小的谐波因子（$a_{n-1}$）均呈线性关系的假设。\n\n矩估计法包括将观察到的统计量与其理论期望值相等，以推导目标参数的估计量。我们将观察到的分离位点数 $S$ 与其期望值相等：\n$$S = \\widehat{E[S]} = \\hat{\\theta} L a_{n-1}$$\n其中 $\\hat{\\theta}$ 是每个位点定标突变率的估计量。求解 $\\hat{\\theta}$ 得到矩估计量，即著名的 Watterson 单位点估计量：\n$$\\hat{\\theta} = \\frac{S}{L a_{n-1}}$$\n这个估计量是无偏的，可以通过求其期望值来证明：\n$$E[\\hat{\\theta}] = E\\left[\\frac{S}{L a_{n-1}}\\right] = \\frac{1}{L a_{n-1}} E[S] = \\frac{1}{L a_{n-1}} (\\theta L a_{n-1}) = \\theta$$\n现在，我们计算该估计量的数值。已知条件是 $S=120$，$n=25$ 和 $L=50000$。首先，我们必须计算 $a_{n-1}$：\n$$a_{n-1} = a_{24} = \\sum_{i=1}^{24} \\frac{1}{i} = 1 + \\frac{1}{2} + \\frac{1}{3} + \\dots + \\frac{1}{24}$$\n这个和的值约为 $a_{24} \\approx 3.77588149$。\n将这些值代入估计量公式：\n$$\\hat{\\theta} = \\frac{120}{50000 \\cdot a_{24}} \\approx \\frac{120}{50000 \\cdot 3.77588149} \\approx \\frac{120}{188794.0745} \\approx 0.0006356103$$\n四舍五入到四位有效数字，单位点估计值为 $\\hat{\\theta} \\approx 0.0006356$。\n\n问题的第二部分要求将此单位点估计值转换为单位千碱基（per-kb）的估计值。一千碱基包含 $1000$ 个位点。因此，我们将单位点估计值乘以 $1000$：\n$$\\hat{\\theta}_{\\text{kb}} = 1000 \\cdot \\hat{\\theta} \\approx 1000 \\cdot 0.0006356103 \\approx 0.6356103$$\n四舍五入到四位有效数字，单位kb估计值为 $\\hat{\\theta}_{\\text{kb}} \\approx 0.6356$。\n\n要求的两个值按顺序分别是单位点估计值和单位千碱基估计值。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0006356  0.6356 \\end{pmatrix}}\n$$", "id": "2739378"}, {"introduction": "尽管分离位点的总数很有信息价值，但等位基因频率的分布包含了更多关于演化历史的信息。Tajima的 $D$ 统计量旨在捕捉位点频率谱（SFS）相对于标准中性模型的偏差。它通过比较两个对 $\\theta$ 的估计量来实现这一点：$\\hat{\\theta}_W$（对稀有变异敏感）和成对核苷酸多样性 $\\pi$（对中频变异更敏感）。这个练习将让你计算Tajima的 $D$ 的核心组成部分，即差值 $\\pi - \\hat{\\theta}_W$，帮助你直观地理解该统计量如何反映SFS的偏斜。[@problem_id:2739336]", "problem": "在无穷位点模型下，对一个大小为 $n=20$ 的单倍体基因组样本中 $L=1$ 兆碱基 (Mb) 的非编码DNA进行了测序。在该区域内，有 $S=200$ 个分离位点，测得的平均成对核苷酸多样性为每个位点 $\\pi=0.007$ 个差异。仅使用以下基本定义：(i) Watterson估计量（单位点）通过将分离位点的数量除以样本大小的调和因子和序列长度得到，以及(ii) Tajima's $D$ 统计量的未标准化分子是平均成对多样性（单位点）与Watterson估计量（单位点）之间的差值，计算该样本的 $D$ 值的未标准化分子。此处，调和因子是 $(n-1)$ 项的调和数 $a_{n-1}=\\sum_{i=1}^{n-1}\\frac{1}{i}$。\n\n以单位点值的形式报告该未标准化的分子，并将您的答案四舍五入至六位有效数字。然后，简要说明其符号是正还是负，以及该符号相对于中性平衡期望所指示的等位基因频率偏斜情况。", "solution": "所述问题有效、自洽，并且在群体遗传学原理上具有科学依据。我们将直接进行求解。\n\n任务是计算Tajima's $D$ 统计量的未标准化分子，以单位点值的形式给出。问题为此量提供了直接定义，我们将其指定为 $D_{num}$。它是平均成对核苷酸多样性（单位点）$\\pi$ 与群体突变参数的Watterson估计量（单位点）$\\hat{\\theta}_{W}$ 之间的差值。\n$$D_{num} = \\pi - \\hat{\\theta}_{W}$$\n问题提供了以下数值：\n- 单倍体基因组的样本大小为 $n = 20$。\n- 测序的非编码区域长度为 $L = 1$ 兆碱基，相当于 $L = 1 \\times 10^{6}$ 个碱基对。\n- 观测到的分离位点（多态性）总数为 $S = 200$。\n- 平均成对核苷酸多样性（单位点）为 $\\pi = 0.007$。\n\n第一步是计算Watterson估计量（单位点）$\\hat{\\theta}_{W}$。问题陈述指明，该值通过“将分离位点的数量除以样本大小的调和因子和序列长度”得到。这可转换为以下公式：\n$$\\hat{\\theta}_{W} = \\frac{S}{a_{n-1}L}$$\n其中 $a_{n-1}$ 是定义为 $(n-1)$ 项调和数的调和因子：\n$$a_{n-1} = \\sum_{i=1}^{n-1} \\frac{1}{i}$$\n给定样本大小 $n = 20$，我们必须计算 $n-1 = 19$ 时的 $a_{n-1}$。这是第 $19$ 个调和数，记为 $H_{19}$。\n$$a_{n-1} = H_{19} = \\sum_{i=1}^{19} \\frac{1}{i} = 1 + \\frac{1}{2} + \\frac{1}{3} + \\dots + \\frac{1}{19}$$\n这个求和的精确值是一个有理数，但对于计算而言，高精度的十进制近似值就足够了。\n$$a_{n-1} \\approx 3.54774395474$$\n现在，可以将 $S$、$a_{n-1}$ 和 $L$ 的值代入 $\\hat{\\theta}_{W}$ 的表达式中。\n$$\\hat{\\theta}_{W} = \\frac{200}{(H_{19}) \\times (1 \\times 10^{6})} \\approx \\frac{200}{3.54774395474 \\times 10^{6}} \\approx 0.000056374937$$\n我们现在有了计算未标准化分子 $D_{num}$ 所需的两个组成部分。\n$$D_{num} = \\pi - \\hat{\\theta}_{W} \\approx 0.007 - 0.000056374937$$\n$$D_{num} \\approx 0.006943625063$$\n问题要求将此结果四舍五入至六位有效数字。前六位有效数字是 $6, 9, 4, 3, 6, 2$。第七位数字是 $5$，因此需要将第六位数字向上取整。\n$$D_{num} \\approx 0.00694363$$\n问题的第二部分关注该值的符号及其生物学解释。计算出的值 $D_{num} \\approx 0.00694363$ 是正数。\n\nTajima's $D$ 统计量或其分子的符号，反映了位点频率谱相对于标准中性模型在种群平衡状态下的期望值的偏斜情况。该统计量比较了群体突变参数 $\\theta$ 的两个估计量：$\\pi$，即平均成对差异数；以及 $\\hat{\\theta}_{W}$，其基于分离位点的数量。估计量 $\\pi$ 对中等频率的多态性最为敏感，而 $\\hat{\\theta}_{W}$ 则更多地受稀有变异数量的加权影响。\n\n如本例中得到的正值（$D_{num}  0$）意味着 $\\pi  \\hat{\\theta}_{W}$。这表明与中性平衡期望相比，处于中等频率的等位基因过多。位点频率谱中的这种模式可能是平衡选择的信号，平衡选择会维持群体中的多样性；也可能是一个近期种群瓶颈（收缩）的信号，这倾向于移除稀有等位基因，同时增加中等频率等位基因的相对比例。", "answer": "$$\\boxed{6.94363 \\times 10^{-3}}$$", "id": "2739336"}, {"introduction": "当有外群数据可用时，我们可以通过识别祖先等位基因和衍生等位基因来“展开”位点频率谱。这使得我们可以进行更强大的检验，例如Fay和Wu的 $H$ 统计量，它专门用于检测近期选择性扫描等特定模式。$H$ 统计量通过寻找高频衍生等位基因的超量来工作，这是有益突变在群体中快速固定时留下的典型信号。通过直接从一个展开的SFS计算相关估计量，你将具体理解一个特定的演化事件（如选择性扫描）如何在基因组数据中产生可预测、可量化的模式。[@problem_id:2739363]", "problem": "一项种群遗传学研究对一个长度为 $L = 100{,}000$ 个碱基对的连续基因组区域进行了测序，样本来自 $n = 30$ 个单倍体基因组。由于有可用的外群来确定突变的极性，因此观测到了非折叠位点频率谱。在整个区域内，恰好有 $S = 12$ 个非折叠的双等位基因分离位点，其衍生等位基因计数直方图由计数 $\\{\\xi_{i}\\}$（其中 $i \\in \\{1,2,\\dots,n-1\\}$）给出如下（所有未列出的计数均为零）：\n- $\\xi_{24} = 2$\n- $\\xi_{25} = 1$\n- $\\xi_{26} = 3$\n- $\\xi_{27} = 2$\n- $\\xi_{28} = 3$\n- $\\xi_{29} = 1$\n\n该区域中所有其余位点均为单态的。请仅使用以下基本定义：(i) 核苷酸多样性是所有采样基因组对间的平均每位点杂合度；(ii) Fay and Wu 估计量在标准中性模型下根据衍生等位基因频率的平方对位点进行加权。基于这些定义，从非折叠位点频率谱计算每位点估计量 $\\hat{\\theta}_{\\pi}$ 和 $\\hat{\\theta}_{H}$，然后计算由 $H = \\hat{\\theta}_{\\pi} - \\hat{\\theta}_{H}$ 定义的未标准化的 Fay and Wu’s $H$。最后，通过报告 $\\operatorname{sgn}(H) \\in \\{-1, 0, 1\\}$ 来编码其符号的解释。\n\n请按顺序 $\\left(\\hat{\\theta}_{\\pi}, \\hat{\\theta}_{H}, H, \\operatorname{sgn}(H)\\right)$ 报告所有三个估计量和符号。提供精确值，不要四舍五入。", "solution": "该问题要求根据给定的非折叠位点频率谱（SFS）计算几个种群遗传学摘要统计量。对问题陈述的验证证实了其具有科学依据、提法恰当，并包含了所有必要且一致的信息。我们将开始解题。\n\n提供的参数如下：\n- 样本大小：$n = 30$\n- 位点长度：$L = 100{,}000$\n- 非折叠SFS中的非零计数 $\\xi_{i}$（即衍生等位基因出现 $i$ 次的位点数）如下：\n  - $\\xi_{24} = 2$\n  - $\\xi_{25} = 1$\n  - $\\xi_{26} = 3$\n  - $\\xi_{27} = 2$\n  - $\\xi_{28} = 3$\n  - $\\xi_{29} = 1$\n分离位点的总数为 $S = \\sum_{i=1}^{n-1} \\xi_{i} = 2+1+3+2+3+1 = 12$。\n\n首先，我们计算每位点核苷酸多样性 $\\hat{\\theta}_{\\pi}$。该统计量定义为序列间成对差异的平均数，并按区域长度进行归一化。对于一个衍生等位基因计数为 $i$ 的单个位点，存在差异的序列对的数量为 $i(n-i)$。序列对的总数为 $\\binom{n}{2}$。SFS为每类位点提供了计数 $\\xi_i$。因此，每位点估计量 $\\hat{\\theta}_{\\pi}$ 的公式为：\n$$\n\\hat{\\theta}_{\\pi} = \\frac{1}{L} \\frac{\\sum_{i=1}^{n-1} i(n-i)\\xi_{i}}{\\binom{n}{2}}\n$$\n我们首先计算分母中包含 $L$ 和 $n$ 的项：\n$$\nL \\binom{n}{2} = L \\frac{n(n-1)}{2} = 100{,}000 \\times \\frac{30(30-1)}{2} = 100{,}000 \\times \\frac{30 \\times 29}{2} = 100{,}000 \\times 435 = 43{,}500{,}000\n$$\n接下来，我们使用给定的SFS数据（$n=30$）计算分子中的求和项：\n$$\n\\sum_{i=1}^{n-1} i(n-i)\\xi_{i} = 24(30-24)\\xi_{24} + 25(30-25)\\xi_{25} + 26(30-26)\\xi_{26} + 27(30-27)\\xi_{27} + 28(30-28)\\xi_{28} + 29(30-29)\\xi_{29}\n$$\n$$\n= (24 \\times 6 \\times 2) + (25 \\times 5 \\times 1) + (26 \\times 4 \\times 3) + (27 \\times 3 \\times 2) + (28 \\times 2 \\times 3) + (29 \\times 1 \\times 1)\n$$\n$$\n= 288 + 125 + 312 + 162 + 168 + 29 = 1084\n$$\n因此，估计量 $\\hat{\\theta}_{\\pi}$ 为：\n$$\n\\hat{\\theta}_{\\pi} = \\frac{1084}{43{,}500{,}000} = \\frac{271}{10,875,000}\n$$\n\n其次，我们计算每位点 Fay and Wu 估计量 $\\hat{\\theta}_{H}$。该估计量基于衍生等位基因频率的平方和，从而给予高频衍生变异更大的权重。公式为：\n$$\n\\hat{\\theta}_{H} = \\frac{1}{L} \\frac{\\sum_{i=1}^{n-1} 2i^2\\xi_{i}}{n(n-1)} = \\frac{1}{L} \\frac{\\sum_{i=1}^{n-1} i^2\\xi_{i}}{\\binom{n}{2}}\n$$\n分母项与之前相同。我们计算新的求和项：\n$$\n\\sum_{i=1}^{n-1} i^2\\xi_{i} = (24^2)\\xi_{24} + (25^2)\\xi_{25} + (26^2)\\xi_{26} + (27^2)\\xi_{27} + (28^2)\\xi_{28} + (29^2)\\xi_{29}\n$$\n$$\n= (576 \\times 2) + (625 \\times 1) + (676 \\times 3) + (729 \\times 2) + (784 \\times 3) + (841 \\times 1)\n$$\n$$\n= 1152 + 625 + 2028 + 1458 + 2352 + 841 = 8456\n$$\n因此，估计量 $\\hat{\\theta}_{H}$ 为：\n$$\n\\hat{\\theta}_{H} = \\frac{8456}{43{,}500{,}000} = \\frac{2114}{10,875,000} = \\frac{1057}{5,437,500}\n$$\n\n第三，我们计算未标准化的 Fay and Wu's $H$ 统计量，定义为 $H = \\hat{\\theta}_{\\pi} - \\hat{\\theta}_{H}$：\n$$\nH = \\frac{1084}{43{,}500{,}000} - \\frac{8456}{43{,}500{,}000} = \\frac{1084 - 8456}{43{,}500{,}000} = \\frac{-7372}{43{,}500{,}000}\n$$\n化简该分数可得：\n$$\nH = -\\frac{1843}{10,875,000}\n$$\n\n最后，我们确定 $H$ 的符号。由于 $H$ 是一个负值，其符号为 $-1$。\n$$\n\\operatorname{sgn}(H) = -1\n$$\n$H$ 的这个负值表明，与标准中性模型下的期望值相比，高频衍生变异存在过量。这种模式是近期选择性清除的典型特征，即一个有益突变频率迅速增加，并携带连锁的中性变异一同增加。观测到的SFS仅包含频率大于或等于 $24/30$ 的等位基因，强烈偏向高频，这与该解释一致。\n\n结果总结：\n$\\hat{\\theta}_{\\pi} = \\frac{271}{10,875,000}$\n$\\hat{\\theta}_{H} = \\frac{1057}{5,437,500}$\n$H = -\\frac{1843}{10,875,000}$\n$\\operatorname{sgn}(H) = -1$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{271}{10875000}  \\frac{1057}{5437500}  -\\frac{1843}{10875000}  -1 \\end{pmatrix}}\n$$", "id": "2739363"}]}