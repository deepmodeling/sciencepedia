## 引言
群体内个体间的DNA序列差异，即遗传变异，是演化过程的原材料，其模式记录了塑造一个物种历史的复杂力量，包括种群大小的变迁和自然选择的作用。然而，从海量的基因组数据中解读这些历史印记，需要一套强大的理论框架和分析工具。本文的核心正是介绍这一框架的基石：**[位点频率谱](@entry_id:163689) (Site Frequency Spectrum, SFS)** 及其相关的**汇总统计量**。这些工具为我们提供了一扇窗口，让我们能够系统性地量化遗传变异，并将其与不同演化情景下的理论预测进行比较，从而推断过去发生的事件。

本文旨在带领读者深入理解如何利用SFS从基因组数据中提取生物学意义。在“**原则与机制**”一章中，我们将奠定理论基础，定义SFS，推导其在标[准中性](@entry_id:184567)模型下的期望形式，并介绍Watterson估计量、[Tajima's D](@entry_id:166949)等关键统计量。接着，在“**应用与跨学科联系**”一章中，我们将展示这些理论工具在解决实际问题中的威力，探讨如何利用它们推断人口历史、寻找自然选择的信号，并直面区分这两种效应的核心挑战。最后，通过“**动手实践**”部分，读者将有机会亲手计算这些统计量，将抽象的理论知识转化为具体的分析技能。

## 原则与机制

群体遗传变异的模式蕴含了塑造其演化的进化力量的丰富信息。通过分析从群体中抽取的样本的DNA[序列数据](@entry_id:636380)，我们可以推断其人口历史（如群体扩张或收缩）和选择的作用（如[正选择](@entry_id:165327)或[平衡选择](@entry_id:150481)）。本章将深入探讨总结和解释[遗传多态性](@entry_id:194311)数据的核心工具之一：**[位点频率谱](@entry_id:163689) (Site Frequency Spectrum, SFS)**，以及一系列基于它的关键汇总统计量。我们将从基本定义出发，构建一个理论框架，用于理解在[中性演化](@entry_id:172700)下的期望模式，并最终阐明各种进化情景如何导致与该期望的特征性偏离。

### 作为遗传变异总结的[位点频率谱](@entry_id:163689)

当我们比对从一个群体中抽取的多个个体的同源DNA序列时，我们会观察到一些[核苷酸](@entry_id:275639)位点在不同个体间存在差异。这些位点被称为**分离位点 (segregating sites)** 或多态性位点。为了系统地量化这些多态性，群体遗传学家构建了[位点频率谱](@entry_id:163689)。

**展开式[位点频率谱](@entry_id:163689) (unfolded site frequency spectrum, SFS)** 是一个[直方图](@entry_id:178776)，记录了在所有分离位点上，**衍生等位基因 (derived allele)** 出现的次数[分布](@entry_id:182848) [@problem_id:2739326]。衍生等位基因是指相对于群体共同祖先的等位基因状态（即**祖先等位基因, ancestral allele**）而言，由于突变而新产生的等位基因。对于一个大小为 $n$ 的样本（即 $n$ 条[染色体](@entry_id:276543)序列），在任意一个双[等位基因分离](@entry_id:267039)位点上，衍生等位基因的计数 $i$ 可以从 $1$ 到 $n-1$。SFS向量中的元素 $\xi_i$ 就代表了衍生等位基因计数恰好为 $i$ 的分离位点的数量。

构建展开式SFS的一个关键前提是能够准确地推断每个分离位点的祖先状态，这一过程被称为**祖先状态极化 (ancestral state polarization)**。最常用的方法是使用**外群 (outgroup)** [@problem_id:2739370]。外群是一个与我们研究的物种（内群, ingroup）[亲缘关系](@entry_id:172505)较近，但在内群所有样本的[最近共同祖先](@entry_id:136722)之前就已经分化的物种。其基本逻辑基于简约性原则：如果在内群中一个位点存在等位基因A和G，而外群中该位点的同源等位基因为A，那么最简约的解释是A为祖先状态，而G是在内群演化历史中由A突变而来的衍生状态 [@problem_id:2739370]。

然而，准确的极化并非轻而易举，它面临着诸多挑战。选择一个合适的外群至关重要，这其中存在一个微妙的权衡。
*   如果外群与内群的分化时间太近，可能会发生**[不完全谱系分选](@entry_id:141497) (Incomplete Lineage Sorting, ILS)**。这意味着在物种分化事件中，祖先群体的多态性可能持续存在于两个物种中，导致外群固定的等位基因并非内群[多态性](@entry_id:159475)的真正祖先状态，从而造成错误极化。理论上，物种分化时间应远大于内群的溯祖深度（对于一个恒定大小的群体，约为 $2N_e$ 代，其中 $N_e$ 是有效群体大小），以最大程度减少ILS [@problem_id:2739370]。
*   相反，如果外群与内群的分化时间太远，虽然ILS的风险降低了，但**[同源异形](@entry_id:261061) (homoplasy)** 的风险却增加了。[同源异形](@entry_id:261061)指在不同谱系中独立发生相同突变（平行突变）或突变恢复到原始状态（[回复突变](@entry_id:163326)）。随着[演化距离](@entry_id:177968)的增加，在同一位点发生多次突变的概率上升，这会混淆祖先状态的推断 [@problem_id:2739365]。

因此，理想的外群应处于一个“恰到好处”的[演化距离](@entry_id:177968)上——既足够远以避免严重的ILS，又足够近以将[同源异形](@entry_id:261061)的概率降至最低 [@problem_id:2739370]。此外，严谨的研究还需要确保比较的是真正的**[直系同源](@entry_id:163003)基因 (orthologs)** 而非[旁系同源基因](@entry_id:263736)，并排除那些在多个外群物种中状态不一致或在外群内部本身就存在[多态性](@entry_id:159475)的位点，以提高极化结果的可靠性 [@problem_id:2739370]。

### 中性条件下的理论期望：标[准中性](@entry_id:184567)模型

为了解释观测到的SFS，我们需要一个基准模型来描述在没有任何特殊进化力量作用下我们期望看到的模式。这个基准就是**标[准中性](@entry_id:184567)模型 (Standard Neutral Model, SNM)** [@problem_id:2739356]。SNM的核心假设包括：
1.  **群体大小恒定**：有效群体大小 $N_e$ 不随时间改变。
2.  **[随机交配](@entry_id:149892)**：群体内个体随机交配（即泛交，panmixia），不存在群体结构。
3.  **无自然选择**：所有突变均为中性，对个体的生存和繁殖没有影响。
4.  **突变**：突变以一个恒定的速率 $\mu$ 发生，且符合**无限位点模型 (infinite-sites model)**。该模型假定基因组中的位点数量如此之多，以至于每个新突变都发生在一个前所未有突变过的位点上。这意味着在样本的家谱中，任何位点最多只发生一次突变，不存在[同源异形](@entry_id:261061) [@problem_id:2739365]。

在这些假设下，我们可以使用**[Kingman溯祖](@entry_id:169191)理论 (Kingman's coalescent)** 来描述样本的基因家谱 [@problem_id:2739431]。想象一下，我们从当今的 $n$ 条[染色体](@entry_id:276543)出发，沿着时间回溯它们的祖先。在任何一代，任意两条谱系追溯到同一个祖先（发生一次“溯祖事件”）的概率都很小。在以 $2N_e$ 代为单位的重标时间下，当有 $k$ 条独立的祖先谱系时，下一次溯祖事件（使谱系数目减少到 $k-1$）的等待时间服从速率为 $\binom{k}{2}$ 的[指数分布](@entry_id:273894) [@problem_id:2739431]。这意味着谱系越少，下一次溯祖事件的等待时间就越长。

突变则可以被看作是随机“散落”在这些基因家谱的枝桠上。一个突变所产生的衍生等位基因在样本中的频率，取决于该突变发生在哪一段枝桠上。发生在连接样本中一个末端节点的“外部枝”上的突变，只会产生一个衍生等位基因（即单例，singleton, $i=1$）。而发生在连接多个末端节点的“内部枝”上的突变，则会产生频率更高的衍生等位基因。

一个关键的理论结果是，在中性溯祖树中，所有能够追溯到 $i$ 个样本后代的枝桠的总期望长度与 $i$ 成反比。由于突变在中性模型下均匀地[分布](@entry_id:182848)在家谱树上，这就直接导出了SFS的期望形式 [@problem_id:2739356] [@problem_id:2739413]：
$$ \mathbb{E}[\xi_i] = \frac{\theta}{i} $$
其中 $i$ 的范围是 $1, \dots, n-1$。参数 $\theta$ 是群体尺度突变率，对于[二倍体](@entry_id:268054)生物，其定义为 $\theta = 4N_e\mu$。这个简单的 $1/i$ 定律表明，在中性平衡状态下，我们期望观察到大量的低频衍生等位基因（因为 $1/i$ 在 $i$ 较小时值很大），而高频衍生等位基因则非常稀少。这种模式构成了我们检验[中性演化](@entry_id:172700)的基础。

### 总结SFS：$\theta$的估计量

SFS的不同方面反映了群体[演化过程](@entry_id:175749)的不同特征。我们可以利用SFS的形状来构建群体尺度突变率 $\theta$ 的不同估计量。由于这些估计量对SFS的不同频率区间的权重不同，比较它们之间的差异就成为了一种有力的推断进化力量的方法。

#### Watterson估计量 ($\hat{\theta}_W$)
最直观的估计 $\theta$ 的方法是基于样本中的总分离位点数 $S$。根据中性SFS的期望公式，我们可以计算 $S$ 的[期望值](@entry_id:153208)：
$$ \mathbb{E}[S] = \mathbb{E}\left[\sum_{i=1}^{n-1} \xi_i\right] = \sum_{i=1}^{n-1} \mathbb{E}[\xi_i] = \sum_{i=1}^{n-1} \frac{\theta}{i} = \theta \sum_{i=1}^{n-1} \frac{1}{i} $$
我们定义一个只与样本大小 $n$ 相关的常数 $a_n = \sum_{i=1}^{n-1} 1/i$。因此，$\mathbb{E}[S] = \theta a_n$。由此可以构建一个[无偏估计量](@entry_id:756290)，即**Watterson估计量** [@problem_id:2739413]：
$$ \hat{\theta}_W = \frac{S}{a_n} $$
由于 $\hat{\theta}_W$ 是基于分离位点的总数 $S = \sum \xi_i$ 构建的，它对SFS中所有频率的变异赋予了相同的权重。这意味着它对数量众多的低频变异（如单例）尤为敏感。

#### Tajima估计量 ($\hat{\theta}_{\pi}$)
另一种估计 $\theta$ 的方法是基于样本中任意两条序列之间的[平均核](@entry_id:746606)苷酸差异数，记为 $\pi$。这个量也被称为**[核苷酸多样性](@entry_id:164565) (nucleotide diversity)**。$\pi$ 也可以表示为SFS的加权和。在一个有 $i$ 个衍生等位基因和 $n-i$ 个祖先等位基因的位点上，随机抽取两条序列，它们之间存在差异的组[合数](@entry_id:263553)是 $i(n-i)$。总的配对组合数是 $\binom{n}{2}$。因此，$\pi$ 的计算公式为：
$$ \hat{\theta}_{\pi} = \pi = \sum_{i=1}^{n-1} \frac{i(n-i)}{\binom{n}{2}} \xi_i $$
可以证明，在中性模型下，$\mathbb{E}[\hat{\theta}_{\pi}] = \theta$ [@problem_id:2739356]。因此，$\hat{\theta}_{\pi}$ 也是 $\theta$ 的一个[无偏估计量](@entry_id:756290)。观察其权重系数 $i(n-i)$，我们发现它在 $i \approx n/2$ 时达到最大值。这意味着 $\hat{\theta}_{\pi}$ 对中等频率的变异最为敏感 [@problem_id:2739407]。

#### Fay and Wu估计量 ($\hat{\theta}_H$)
为了探测SFS高频部分的信号，Fay和Wu引入了另一个估计量 $\hat{\theta}_H$。它通过对高频衍生等位基因赋予极大的权重来构建 [@problem_id:2739369]：
$$ \hat{\theta}_H = \sum_{i=1}^{n-1} \frac{2i^2}{n(n-1)} \xi_i $$
同样可以证明，在中性模型下，$\mathbb{E}[\hat{\theta}_H] = \theta$ [@problem_id:2739369]。其权重系数 $i^2$ 随 $i$ 的增加而迅速增大，使得该估计量对高频衍生等位基因的存在极其敏感。这使得它成为检测近期[正选择](@entry_id:165327)（选择性清除）的有力工具。

### 检验中性模型：基于SFS的统计量

标[准中性](@entry_id:184567)模型的关键预测是 $\mathbb{E}[\hat{\theta}_W] = \mathbb{E}[\hat{\theta}_{\pi}] = \mathbb{E}[\hat{\theta}_H] = \theta$。如果群体的演化历史偏离了SNM的假设（例如，经历了群体大小变化或自然选择），SFS的形状就会被扭曲，导致这几个估计量的值系统性地偏离彼此。比较这些估计量的差异，就构成了检验中性模型的系列统计量的基础。

#### Tajima's $D$
**Tajima's $D$** 统计量旨在通过比较对SFS不同部分敏感的两个估计量 $\hat{\theta}_{\pi}$ 和 $\hat{\theta}_W$ 来检测与中性模型的偏离 [@problem_id:2739407]。其定义为：
$$ D = \frac{\hat{\theta}_{\pi} - \hat{\theta}_W}{\sqrt{\hat{V}(\hat{\theta}_{\pi} - \hat{\theta}_W)}} $$
其中分母是差值 $\hat{\theta}_{\pi} - \hat{\theta}_W$ 在中性模型下的期望[方差](@entry_id:200758)的估计，用于[标准化](@entry_id:637219)。因此，$D$ 的符号由分子 $\hat{\theta}_{\pi} - \hat{\theta}_W$ 的符号决定。
*   **$D \approx 0$**：当观测数据符合SNM的期望时，$\hat{\theta}_{\pi}$ 和 $\hat{\theta}_W$ 的值会很接近，导致 $D$ 接近于0。
*   **$D  0$**：这意味著 $\hat{\theta}_{\pi}  \hat{\theta}_W$。由于 $\hat{\theta}_W$ 对稀有等位基因敏感，而 $\hat{\theta}_{\pi}$ 对中频等位基因敏感，这种情况表明SFS中存在过量的稀有等位基因和/或中频等位基因的缺失。
*   **$D  0$**：这意味著 $\hat{\theta}_{\pi}  \hat{\theta}_W$。这表明稀有等位基因相对较少，而中频等位基因过量。

例如，在一个包含20条序列、长度为 $10^6$ 个位点的样本中，若观测到 $S = 1200$ 个分离位点，而平均成对差异 $\pi = 2.0 \times 10^{-4}$，我们可以计算出 $\hat{\theta}_{\pi} = 2.0 \times 10^{-4}$。对于 $n=20$，$a_{19} \approx 3.547$，因此 $\hat{\theta}_W = (S/L)/a_n = (1200/10^6)/3.547 \approx 3.38 \times 10^{-4}$。由于 $\hat{\theta}_{\pi}  \hat{\theta}_W$，该样本的Tajima's $D$ 值为负 [@problem_id:2739407]。

#### Fay and Wu's $H$
**Fay and Wu's $H$** 统计量通过比较 $\hat{\theta}_{\pi}$ 和对高频衍生等位基因极为敏感的 $\hat{\theta}_H$ 来探测特定的[选择模式](@entry_id:144214)，尤其是正选择 [@problem_id:2739369]。其原始形式定义为：
$$ H = \hat{\theta}_{\pi} - \hat{\theta}_H $$
*   **$H \approx 0$**：在中性模型下，两个估计量的期望相等，因此 $H$ 期望为0。
*   **$H  0$**：这意味著 $\hat{\theta}_{\pi}  \hat{\theta}_H$。由于 $\hat{\theta}_H$ 对高频衍生等位基因有二次方的加权，一个强烈的负 $H$ 值是高频衍生等位基因显著过量的明确信号。

例如，对于一个 $n=6$ 的样本，如果SFS为 $\xi_1 = 1, \xi_4 = 2, \xi_5 = 3$，而其他 $\xi_i$ 均为0。我们可以计算出 $\hat{\theta}_{\pi} = \frac{1}{15}(5 \cdot 1 + 8 \cdot 2 + 5 \cdot 3) = 2.4$，而 $\hat{\theta}_H = \frac{1}{15}(1^2 \cdot 1 + 4^2 \cdot 2 + 5^2 \cdot 3) = 7.2$。因此，$H = 2.4 - 7.2 = -4.8$，一个强烈的负值，反映了数据中高频衍生等位基因的极端过量 [@problem_id:2739369]。

### 解读与中性期望的偏离

不同的进化情景会以特征性的方式扭曲基因家谱的形状，从而在SFS以及Tajima's $D$ 和 Fay and Wu's $H$ 统计量上留下独特的印记 [@problem_id:2739368]。

#### [人口统计学](@entry_id:143605)历史
*   **近期快速群体扩张**：当一个群体从一个小规模快速扩张时，其基因家谱会呈现出“星状”结构：许[多谱](@entry_id:200847)系在近期迅速溯祖到一个共同的祖先。这导致家谱的外部枝非常长，而内部枝相对较短。长外部枝上积累的大量突变造成了稀有等位基因（特别是单例）的显著过量。这种SFS的扭曲导致 $\hat{\theta}_W$ 被不成比例地放大，而 $\hat{\theta}_{\pi}$ 变化不大，因此 **Tajima's $D$ 表现为负值**。由于高频衍生等位基因并未过量，**Fay and Wu's $H$ 通常接近于0**。

*   **[群体瓶颈](@entry_id:154577)或结构**：经历瓶颈效应（群体规模急剧缩小后恢复）或存在亚[群体结构](@entry_id:148599)的群体，其家谱中谱系要么在瓶颈期内迅速溯祖，要么来自不同亚群而在很早之前才溯祖。这两种情况都可能导致稀有等位基因的缺失和中频等位基因的相对过量。因此，**Tajima's $D$ 倾向于为正值**。

#### 自然选择
*   **选择性清除 (Selective Sweep)**：当一个有利突变出现并迅速在群体中固定时，它会通过“搭便车效应 (hitchhiking)”将其所在的[染色体](@entry_id:276543)背景一同带到高频。这导致在有利突变位点附近的基因家谱也呈现出星状结构，产生大量低频变异。然而，与纯粹的群体扩张不同，[选择性清除](@entry_id:169307)还有一个独特的标志：在清除过程中，通过重组进入有利背景的一些原有等位基因会被一同“带”到高频。这造成了**高频衍生等位基因的显著过量**。因此，选择性清除的典型信号是**Tajima's $D$ 为负值**（由低频变异过量导致），同时**Fay and Wu's $H$ 为强烈的负值**（由高频衍生变异过量导致）。这一组合是区分群体扩张和[正选择](@entry_id:165327)的关键。

*   **[平衡选择](@entry_id:150481) (Balancing Selection)**：当[杂合子优势](@entry_id:143056)或[频率依赖性选择](@entry_id:155870)等机制长期维持多个等位基因在一个位点共存时，该位点的基因家谱会呈现一个非常深的“分叉”，对应着两个或多个被选择维持的古老等位[基因家族](@entry_id:266446)。连接这些家族的内部枝变得极长，其上积累的突变导致了**中频等位基因的显著过量**。这使得 $\hat{\theta}_{\pi}$ 远大于 $\hat{\theta}_W$，从而导致**Tajima's $D$ 为强烈的正值**。

*   **[背景选择](@entry_id:167635) (Background Selection, BGS)**：在基因组中，有害突变会不断产生并被纯化选择所清除。与有害突变紧密连锁的中性位点也可能随之从群体中消失。这种效应等同于局部地降低了有效群体大小 $N_e$。一个较小的 $N_e$ 意味着溯祖速率加快，整个家谱被“压缩”，导致整体[多态性](@entry_id:159475)水平下降。BGS对SFS形状的影响通常较弱，但它可能导致类似于群体扩张的轻微的低频变异过量，从而使**Tajima's $D$ 略微为负**。它不会产生高频衍生等位基因的过量，因此对 $H$ 统计量影响不大。

### 高级考量：连锁与模型假设

在进行SFS分析时，还必须考虑一些更深层次的理论问题，它们可能影响我们对数据的解读。

#### 连锁的作用
我们通常的分析隐含了一个简化假设：基因组上的每个位点都是独立演化的。然而，当**[重组率](@entry_id:203271)很低**时，这个假设就不再成立。在低重组区域，一个很长的[染色体](@entry_id:276543)片段上的所有位点可能共享同一个随机的基因家谱。这种**连锁 (linkage)** 关系对SFS统计量的性质有重要影响 [@problem_id:2739401]。
*   **期望不变**：在中性模型下，连锁关系**不改变**SFS的期望形状，因此也不改变Tajima's $D$或Fay and Wu's $H$等统计量的[期望值](@entry_id:153208)（它们仍然期望为0）。
*   **[方差膨胀](@entry_id:756433)**：连锁会极大地增加这些统计量的**[方差](@entry_id:200758)**。这是因为，如果一个随机家谱碰巧有很长的外部枝，那么共享这个家谱的所有位点都会倾向于产生稀有等位基因，导致它们的变异模式高度相关。这种正协[方差](@entry_id:200758)使得统计量的实际[方差](@entry_id:200758)远大于在位点独立假设下计算出的理论[方差](@entry_id:200758)。
*   **统计检验**：如果在低重组区域使用基于独立假设的[方差](@entry_id:200758)来进行[假设检验](@entry_id:142556)，将会导致**[假阳性率](@entry_id:636147)的显著升高**。因为真实的[零分布](@entry_id:195412)比理论预期的更宽，一个实际上并不显著的观测值也可能被错误地判定为极端值。这种检验是“反保守的”(anti-conservative)。对于那些对家谱特定部分（如深层内部枝）长度变化特别敏感的统计量（如Fay and Wu's $H$），由连锁引起的[方差膨胀](@entry_id:756433)效应尤为剧烈 [@problem_id:2739401]。

#### 有限位点模型的效应
无限位点模型是一个有用的数学简化，但真实基因组的位点是有限的。当每个位点的[突变率](@entry_id:136737)相对较高时（例如，在病毒中或在CpG等高突变率位点），**[回复突变](@entry_id:163326)**或**平行突变**的概率变得不可忽略 [@problem_id:2739365]。这会带来两个主要后果：
1.  **低估分离位点数**：在同一个位点上发生多次突变可能不会产生新的分离位点（例如，一个位点从A突变为G，然后又发生一次G突变为C，最终只产生一个分离位点，但发生了两次突变事件）。这会导致Watterson估计量 $\hat{\theta}_W$ 低估真实的突变输入。
2.  **Tajima's $D$ 的正向偏倚**：相比于 $\hat{\theta}_W$，$\hat{\theta}_{\pi}$ 受多次突变的影响较小。多次突变仍然可以增加成对序列间的差异。因此，在存在显著[回复突变](@entry_id:163326)的情况下，即使在中性模型下，也可能出现 $\hat{\theta}_{\pi}  \hat{\theta}_W$ 的情况，导致Tajima's $D$ 产生正向偏倚。如果不考虑这一点，可能会将这种由突变模型本身造成的偏倚错误地解读为[平衡选择](@entry_id:150481)或[群体瓶颈](@entry_id:154577)的信号 [@problem_id:2739365]。

综上所述，[位点频率谱](@entry_id:163689)及其相关统计量为我们提供了一个强大的、多层次的框架，用以从基因组数据中解读群体的演化历史。然而，对这些工具的明智运用，不仅需要理解它们在理想模型下的行为，还需要对模型假设的局限性及其对推断结果的潜在影响有深刻的认识。