{"hands_on_practices": [{"introduction": "掌握麦当劳-克雷特曼（MK）检验的第一步是熟练其核心计算。这个练习提供了一个经典场景，你需要根据同义和非同义替换在种内多态性和种间分歧中的观察计数，来量化自然选择的信号[@problem_id:2731810]。通过这个计算，你将亲手推导出关键统计量，例如比值比（odds ratio）和适应性替换比例（$\\hat{\\alpha}$），从而将原始数据转化为有意义的演化推断。", "problem": "在一个物种内对一个单拷贝核基因进行调查，并与一个姐妹种进行比较。物种内的分离位点被分类为非同义多态性和同义多态性，而物种间的固定差异被分类为非同义分化和同义分化。假设位点间相互独立，测序误差可忽略不计，且物种内样本足够大，可将观察到的计数视为有效精确值。您将使用 McDonald–Kreitman 检验 (MK; McDonald–Kreitman) 框架，其中性基线假设是物种内和物种间的非同义变化与同义变化的相对速率相同。您还将对具有固定边际的相关二乘二列联表使用 Fisher 精确检验 (Fisher’s exact test)。\n\n观察到的计数如下：\n- 非同义多态性：$P_{n} = 40$。\n- 同义多态性：$P_{s} = 100$。\n- 非同义固定差异：$D_{n} = 120$。\n- 同义固定差异：$D_{s} = 200$。\n\n仅使用中性基线下列联表的第一性原理定义和 Fisher 精确检验的精确超几何抽样，执行一个单一的、内部一致的工作流程来：\n1. 计算比值比（odds ratio），该值比较了分化类别中的非同义与同义几率（odds）和多态性类别中的非同义与同义几率。\n2. 计算双侧 Fisher 精确检验的 $p$ 值，其原假设为该列联表与中性基线一致（即行和列的分类是独立的）。\n3. 根据与中性基线的偏离，推断由正选择驱动的非同义替换的估计比例，记为 $\\hat{\\alpha}$。\n\n最后，仅报告 $\\hat{\\alpha}$ 的数值，以小数形式表示，并四舍五入到四位有效数字。不要报告百分比；报告一个没有单位的纯数字。", "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于分子进化的原理，问题提出得当且数据充分，表述客观。我们将继续进行解答。\n\n该问题要求基于 McDonald-Kreitman (MK) 检验框架进行分析。所提供的数据可以整理成一个 $2 \\times 2$ 列联表，这是此检验的标准表示方法。行代表核苷酸替换的类型（非同义或同义），列代表变异的类别（物种内的多态性或物种间的固定差异）。\n\n观察到的计数如下：\n- 非同义多态性：$P_{n} = 40$\n- 同义多态性：$P_{s} = 100$\n- 非同义固定差异（分化）：$D_{n} = 120$\n- 同义固定差异（分化）：$D_{s} = 200$\n\n因此，列联表如下：\n\n| | 多态性 | 分化 | 总计 |\n| :--- | :---: | :---: | :---: |\n| **非同义** | $P_n=40$ | $D_n=120$ | 160 |\n| **同义** | $P_s=100$ | $D_s=200$ | 300 |\n| **总计** | 140 | 320 | 460 |\n\nMK 检验的原假设 ($H_0$) 是中性进化。在严格中性条件下，物种内多态性的非同义与同义变化之比应与物种间固定差异的非同义与同义变化之比相同。这意味着变化的分类（行）与进化时间尺度（列）之间是统计独立的。用数学方式表示为：\n$$ \\frac{P_n}{P_s} = \\frac{D_n}{D_s} $$\n问题要求计算三个量。我们按逻辑顺序进行处理。\n\n1.  **比值比 ($\\text{OR}$)**\n    比值比定义为，分化类别中一个变化为非同义的几率（odds）与多态性类别中一个变化为非同义的几率的比值。\n    分化类别的几率为 $\\frac{D_n}{D_s}$。\n    多态性类别的几率为 $\\frac{P_n}{P_s}$。\n    因此，比值比为：\n    $$ \\text{OR} = \\frac{D_n / D_s}{P_n / P_s} = \\frac{D_n P_s}{D_s P_n} $$\n    代入给定值：\n    $$ \\text{OR} = \\frac{120 \\times 100}{200 \\times 40} = \\frac{12000}{8000} = 1.5 $$\n    大于 $1$ 的比值比表明，与由多态性类别设定的中性期望相比，分化类别中存在过量的非同义变化。\n\n2.  **Fisher 精确检验 $p$ 值**\n    Fisher 精确检验评估了偏离原假设的统计显著性。在给定列联表的固定边际总计（行总计 $R_1 = 160$, $R_2 = 300$；列总计 $C_1 = 140$, $C_2 = 320$；总计 $N = 460$）的情况下，在原假设下观察到特定列联表配置的概率遵循超几何分布。观察到恰好 $P_n=k$ 个非同义多态性的概率为：\n    $$ P(P_n=k) = \\frac{\\binom{R_1}{k} \\binom{R_2}{C_1-k}}{\\binom{N}{C_1}} = \\frac{\\binom{160}{k} \\binom{300}{140-k}}{\\binom{460}{140}} $$\n    观察到的列联表有 $P_n = 40$。期望值为 $E[P_n] = \\frac{R_1 C_1}{N} = \\frac{160 \\times 140}{460} \\approx 48.7$。\n    双侧 $p$ 值是所有与观察到的列联表同样极端或更极端的列联表的概率之和。虽然计算该值对于完整的统计报告是必要的，但对于计算最终要求的量 $\\hat{\\alpha}$ 并非必需。问题的结构暗示我们应假定这种偏离是有意义的，并继续量化其大小。\n\n3.  **适应性驱动的替换比例 ($\\hat{\\alpha}$)**\n    数量 $\\hat{\\alpha}$ 代表物种间由正选择固定的非同义固定差异的估计比例。其逻辑是计算在中性条件下预期的非同义固定数量，并将其从观察到的数量中减去。剩余部分归因于适应性进化。\n    中性期望是非同义与同义分化之比等于多态性的相应比率：\n    $$ \\left( \\frac{D_n}{D_s} \\right)_{\\text{neutral}} = \\frac{P_n}{P_s} $$\n    预期的中性非同义固定差异数 $D_{n, \\text{neutral}}$ 为：\n    $$ D_{n, \\text{neutral}} = D_s \\times \\frac{P_n}{P_s} $$\n    适应性非同义固定数 $D_{n, \\text{adaptive}}$ 是观察到的总数减去中性期望值：\n    $$ D_{n, \\text{adaptive}} = D_n - D_{n, \\text{neutral}} = D_n - D_s \\frac{P_n}{P_s} $$\n    比例 $\\hat{\\alpha}$ 是适应性固定数与非同义固定总数的比率：\n    $$ \\hat{\\alpha} = \\frac{D_{n, \\text{adaptive}}}{D_n} = \\frac{D_n - D_s \\frac{P_n}{P_s}}{D_n} = 1 - \\frac{D_s P_n}{D_n P_s} $$\n    这个公式等价于 $1 - \\frac{1}{\\text{OR}}$。\n    将给定的数值代入 $\\hat{\\alpha}$ 的公式中：\n    $$ \\hat{\\alpha} = 1 - \\frac{200 \\times 40}{120 \\times 100} = 1 - \\frac{8000}{12000} = 1 - \\frac{8}{12} = 1 - \\frac{2}{3} $$\n    $$ \\hat{\\alpha} = \\frac{1}{3} $$\n    问题要求将此值以小数形式表示，并四舍五入到四位有效数字。\n    $$ \\hat{\\alpha} \\approx 0.333333... $$\n    四舍五入到四位有效数字得到 $0.3333$。这个结果意味着，在这些物种间固定的非同义替换中，估计有 $33.33\\%$ 是由正选择驱动的。", "answer": "$$\\boxed{0.3333}$$", "id": "2731810"}, {"introduction": "计算本身只是工具，真正的洞察力来自于解释其结果的生物学意义。此练习将挑战你将MK检验的统计模式与一个具体的演化过程——长期平衡选择——联系起来。你需要预测，在一个以维持等位基因多样性为特征的基因（如MHC基因）中，MK检验的各项计数会呈现出何种模式，以及中性指数（Neutrality Index）会反映出怎样的信号[@problem_id:1971688]。", "problem": "一个进化生物学家团队正在研究一种啮齿动物中的一个名为免疫识别因子1（IRF1）的基因。该基因在功能上类似于脊椎动物的主要组织相容性复合体（MHC）基因，并且已知其受到长期平衡选择的作用，以维持种群中等位基因的高度多样性。\n\n为了量化选择压力，研究人员对该物种内多个个体的IRF1基因进行了测序，以测量多态性。他们还将该序列与其近缘姐妹物种中的直系同源基因进行了比较，以测量分化。他们将观察到的DNA变化分为四类：\n\n-   $P_n$：物种内的非同义多态性位点数。\n-   $P_s$：物种内的同义多态性位点数。\n-   $D_n$：两个物种间的非同义固定差异数。\n-   $D_s$：两个物种间的同义固定差异数。\n\n这些计数被用于McDonald-Kreitman检验，该检验比较了物种内非同义与同义变异的比率与物种间非同义与同义分化的比率。中性指数（$NI$）是根据此检验得出的一个统计量，计算公式为：\n$$NI = \\frac{P_n D_s}{P_s D_n}$$\n\n鉴于IRF1基因受到强烈的长期平衡选择，以下哪组观测值及相应的中性指数（$NI$）是研究人员进行McDonald-Kreitman检验最可能得到的结果？\n\nA. $P_n = 40$，$P_s = 10$，$D_n = 4$，$D_s = 5$；得出 $NI = 5.0$\nB. $P_n = 10$，$P_s = 10$，$D_n = 10$，$D_s = 5$；得出 $NI = 0.5$\nC. $P_n = 20$，$P_s = 10$，$D_n = 10$，$D_s = 5$；得出 $NI = 1.0$\nD. $P_n = 5$，$P_s = 10$，$D_n = 8$，$D_s = 4$；得出 $NI = 0.25$", "solution": "McDonald-Kreitman框架比较了物种内非同义与同义变异的比率与物种间的相应比率。中性指数定义为\n$$\nNI = \\frac{P_{n} D_{s}}{P_{s} D_{n}} = \\frac{P_{n}/P_{s}}{D_{n}/D_{s}}\n$$\n在长期平衡选择下，我们预期物种内的非同义多态性相对于物种间的非同义分化会过量，从而得出 $NI>1$。这是因为平衡选择在长时间尺度上维持物种内的多个等位基因，增加了 $P_{n}$，并可能由于跨物种多态性而减少表观的 $D_{n}$。\n\n评估每个选项：\n\n对于A：$P_{n}/P_{s} = \\frac{40}{10} = 4$ 且 $D_{n}/D_{s} = \\frac{4}{5}$。因此 $NI_{A} = \\frac{4}{4/5} = 5.0$。这显示出相对于分化的过量非同义多态性，与平衡选择一致。\n\n对于B：$P_{n}/P_{s} = \\frac{10}{10} = 1$ 且 $D_{n}/D_{s} = \\frac{10}{5} = 2$。因此 $NI_{B} = \\frac{1}{2} = 0.5$，这表明存在过量的非同义分化，与平衡选择不一致。\n\n对于C：$P_{n}/P_{s} = \\frac{20}{10} = 2$ 且 $D_{n}/D_{s} = \\frac{10}{5} = 2$。因此 $NI_{C} = \\frac{2}{2} = 1.0$，与中性选择一致，而非平衡选择。\n\n对于D：$P_{n}/P_{s} = \\frac{5}{10} = \\frac{1}{2}$ 且 $D_{n}/D_{s} = \\frac{8}{4} = 2$。因此 $NI_{D} = \\frac{1/2}{2} = \\frac{1}{4} = 0.25$，再次显示出过量的非同义分化，而不是平衡选择。\n\n只有选项A产生了 $NI>1$，同时具有高 $P_{n}$ 和相对低的 $D_{n}$，这是在一个免疫基因中，强烈的长期平衡选择下预期的典型模式。", "answer": "$$\\boxed{A}$$", "id": "1971688"}, {"introduction": "标准的MK检验建立在一系列简化假设之上，而理解这些假设的局限性是进行严谨演化分析的关键。这个高级练习将引导你从第一性原理出发，探索当非同义突变包含大量弱有害变异时，MK检验的结果会如何变化[@problem_id:2731698]。通过推导天真估计量（naive estimator）与真实适应性比例之间的偏差，你将深刻理解为何现代MK检验的扩展方法对于准确量化正选择至关重要。", "problem": "一个有效种群大小恒定为 $N_{e}$ 的二倍体种群，在基因选择下以低突变率演化，因此新突变是罕见的且互不干扰。考虑一个基因，它有 $L_{s}$ 个同义位点和 $L_{n}$ 个非同义位点，其每个位点的突变率分别为 $\\mu_{s}$ 和 $\\mu_{n}$。同义突变是中性的。非同义突变以三峰分布的效应出现：比例为 $p_{b}$ 的突变是有益的，比例为 $p_{0}$ 的突变是有效中性的，剩余比例 $q = 1 - p_{b} - p_{0}$ 的突变是有害的，其具有一个在负选择系数上定义的连续适合度效应分布（DFE）。假设有益突变能快速席卷整个种群，因此在取样的时间尺度上，它们对现存多态性的贡献可以忽略不计，但其固定概率相对于中性突变提高了一个常数因子 $\\rho_{b} > 1$（即，每个突变相对于中性突变的固定概率乘以 $\\rho_{b}$）。对于有害的非同义突变，定义两个相对于中性情况、经 DFE 平均的无量纲衰减因子：\n- $c_{p} \\in (0,1)$：一个有害非同义突变对期望多态性的平均贡献（相对于一个中性突变），通过在有害效应的 DFE 上积分得到。\n- $c_{d} \\in (0,1)$：一个有害非同义突变对期望分化（固定）的平均贡献（相对于一个中性突变），通过在有害效应的 DFE 上积分得到。\n\n在 McDonald–Kreitman 框架内进行分析，该框架通过比较非同义与同义的多态性和分化之比来推断适应性非同义替换的比例。仅使用基本原则：(i) 类别 $x \\in \\{s,n\\}$ 的期望多态性与 $4 N_{e} \\mu_{x} L_{x}$ 成比例，再乘以一个特定类别、依赖于选择的因子，该因子在中性条件下平均为 $1$；(ii) 类别 $x$ 的期望分化与 $\\mu_{x} L_{x}$ 成比例，再乘以一个特定类别、依赖于选择的固定因子，该因子在中性条件下等于 $1$，对有益变化大于 $1$，而对有害变化小于 $1$；(iii) 每个混合组分对多态性或分化的贡献由其混合比例加权。\n\n1. 用 $p_{b}$、$p_{0}$、$q$、$c_{p}$、$c_{d}$ 和 $\\rho_{b}$ 推导出期望比率 $P_{n}/P_{s}$ 和 $D_{n}/D_{s}$ 的符号表达式，其中 $P_{x}$ 和 $D_{x}$ 分别表示类别 $x$ 的多态性位点和固定差异的期望计数。\n2. 使用这些表达式和 McDonald–Kreitman 方法的标准比率之比逻辑，写出忽略有害 DFE 的朴素估计量 $\\hat{\\alpha}_{\\mathrm{naive}}$（即将所有非同义多态性视为由中性突变产生），并与之对比，写出真实适应性比例 $\\alpha_{\\mathrm{true}}$，其定义为适应性非同义固定在所有非同义固定中所占的比例。\n3. 用 $p_{b}$、$p_{0}$、$q$、$c_{p}$、$c_{d}$ 和 $\\rho_{b}$ 推导偏差 $B = \\hat{\\alpha}_{\\mathrm{naive}} - \\alpha_{\\mathrm{true}}$ 的闭式表达式。尽可能地进行简化。\n4. 对参数集 $p_{b} = 0.02$、$p_{0} = 0.18$、$q = 0.80$、$c_{p} = 0.50$、$c_{d} = 0.01$ 和 $\\rho_{b} = 10$ 计算 $B$ 的值。提供 $B$ 的最终数值答案，四舍五入到四位有效数字。将最终答案表示为一个纯数（无量纲）。", "solution": "我们从第一性原理出发，研究在一个大的、恒定的、低突变率的种群中，多态性和分化如何随着选择和突变而变化。\n\n设 $P_{x}$ 表示在一个标准化样本中观察到的类别 $x \\in \\{s,n\\}$ 的多态性位点的期望计数（或速率），设 $D_{x}$ 表示在一个标准化的分化时间内累积的固定差异的期望计数（或速率）。在无限位点近似和罕见突变的条件下，我们有：\n\n- 期望多态性与以下表达式成比例：\n$$\nP_{x} \\propto 4 N_{e} \\mu_{x} L_{x} \\times \\Phi_{x},\n$$\n其中 $\\Phi_{x}$ 是一个无量纲因子，对于中性突变，其值为 $1$；对于受选择的突变，其值会减小（在我们的设定中，有益突变对现存多态性的贡献可以忽略不计，因为它们会快速席卷）。\n\n- 期望分化与以下表达式成比例：\n$$\nD_{x} \\propto \\mu_{x} L_{x} \\times F_{x},\n$$\n其中 $F_{x}$ 是一个无量纲固定因子，对于中性突变等于 $1$，对于有益突变大于 $1$，对于有害突变小于 $1$。\n\n由于 McDonald–Kreitman (MK) 方法使用比率 $P_{n}/P_{s}$ 和 $D_{n}/D_{s}$，许多常数项会相互抵消。我们现在通过将非同义贡献分解到各种效应的混合中来表达这些比率。\n\n同义类别 ($s$)：根据假设，所有同义突变都是中性的。因此，\n$$\n\\Phi_{s} = 1, \\quad F_{s} = 1.\n$$\n\n非同义类别 ($n$)：该混合有三个组分：\n\n- 有益部分 $p_{b}$：对多态性的贡献可忽略不计，因此其多态性因子约等于 $0$。对于分化，相对于中性的固定因子为 $\\rho_{b} > 1$。\n\n- 中性部分 $p_{0}$：对多态性和分化均有完全贡献，因子均为 $1$。\n\n- 有害部分 $q = 1 - p_{b} - p_{0}$：以平均因子 $c_{p} \\in (0,1)$ 贡献于多态性，以平均因子 $c_{d} \\in (0,1)$ 贡献于分化，每个因子都是通过在负效应的 DFE 上对适当的、依赖于选择的权重进行积分得到的。\n\n因此，在不考虑特定类别的突变-位点常数的情况下，非同义因子为：\n$$\n\\Phi_{n} = p_{0} \\cdot 1 + q \\cdot c_{p} + p_{b} \\cdot 0 = p_{0} + q c_{p},\n$$\n$$\nF_{n} = p_{0} \\cdot 1 + q \\cdot c_{d} + p_{b} \\cdot \\rho_{b} = p_{0} + q c_{d} + p_{b} \\rho_{b}.\n$$\n\n因此，期望的 MK 比率为\n$$\n\\frac{P_{n}}{P_{s}} = \\frac{4 N_{e} \\mu_{n} L_{n} \\, \\Phi_{n}}{4 N_{e} \\mu_{s} L_{s} \\, \\Phi_{s}} = \\frac{\\mu_{n} L_{n}}{\\mu_{s} L_{s}} \\left(p_{0} + q c_{p}\\right),\n$$\n$$\n\\frac{D_{n}}{D_{s}} = \\frac{\\mu_{n} L_{n} \\, F_{n}}{\\mu_{s} L_{s} \\, F_{s}} = \\frac{\\mu_{n} L_{n}}{\\mu_{s} L_{s}} \\left(p_{0} + q c_{d} + p_{b} \\rho_{b}\\right).\n$$\n\n标准的 MK 逻辑通过比较这些比率来构建适应性非同义替换比例的估计量。忽略有害 DFE 的朴素估计量将非同义多态性视为仅由中性突变产生。以比率之比的形式，朴素估计量为\n$$\n\\hat{\\alpha}_{\\mathrm{naive}} \\;=\\; 1 \\;-\\; \\frac{P_{n}/P_{s}}{D_{n}/D_{s}} \\;=\\; 1 \\;-\\; \\frac{p_{0} + q c_{p}}{p_{0} + q c_{d} + p_{b} \\rho_{b}},\n$$\n其中特定类别的常数 $\\mu_{x} L_{x}$ 相互抵消。\n\n根据定义，非同义固定中的真实适应性比例是适应性非同义固定在所有非同义固定中所占的比例：\n$$\n\\alpha_{\\mathrm{true}} \\;=\\; \\frac{\\text{适应性非同义固定}}{\\text{所有非同义固定}}\n\\;=\\; \\frac{p_{b} \\rho_{b}}{p_{0} + q c_{d} + p_{b} \\rho_{b}}.\n$$\n\n我们现在推导偏差\n$$\nB \\;=\\; \\hat{\\alpha}_{\\mathrm{naive}} - \\alpha_{\\mathrm{true}} \\;=\\; \\left[1 - \\frac{p_{0} + q c_{p}}{p_{0} + q c_{d} + p_{b} \\rho_{b}}\\right] \\;-\\; \\frac{p_{b} \\rho_{b}}{p_{0} + q c_{d} + p_{b} \\rho_{b}}.\n$$\n在共同分母 $T = p_{0} + q c_{d} + p_{b} \\rho_{b}$ 上合并各项：\n$$\nB \\;=\\; 1 \\;-\\; \\frac{p_{0} + q c_{p} + p_{b} \\rho_{b}}{T} \\;=\\; \\frac{T - \\left(p_{0} + q c_{p} + p_{b} \\rho_{b}\\right)}{T}.\n$$\n因为 $T = p_{0} + q c_{d} + p_{b} \\rho_{b}$，分子简化为\n$$\n\\left(p_{0} + q c_{d} + p_{b} \\rho_{b}\\right) - \\left(p_{0} + q c_{p} + p_{b} \\rho_{b}\\right) \\;=\\; q \\left(c_{d} - c_{p}\\right).\n$$\n因此，闭式偏差为\n$$\nB \\;=\\; \\frac{q \\left(c_{d} - c_{p}\\right)}{p_{0} + q c_{d} + p_{b} \\rho_{b}}.\n$$\n因为对于有害突变，$c_{p} > c_{d}$（它们对多态性的相对贡献大于对分化的贡献），分子 $q(c_{d} - c_{p})$ 是负的，所以 $B < 0$。因此，忽略有害的 DFE 会使朴素估计量产生负向偏差。\n\n最后，对指定的参数 $p_{b} = 0.02$、$p_{0} = 0.18$、$q = 0.80$、$c_{p} = 0.50$、$c_{d} = 0.01$ 和 $\\rho_{b} = 10$ 计算 $B$ 的值：\n$$\n\\text{分子} = q(c_{d} - c_{p}) = 0.80 \\times (0.01 - 0.50) = 0.80 \\times (-0.49) = -0.392.\n$$\n$$\n\\text{分母} = p_{0} + q c_{d} + p_{b} \\rho_{b} = 0.18 + 0.80 \\times 0.01 + 0.02 \\times 10 = 0.18 + 0.008 + 0.20 = 0.388.\n$$\n因此，\n$$\nB = \\frac{-0.392}{0.388} = -\\frac{392}{388} = -\\frac{98}{97} \\approx -1.010309278\\ldots\n$$\n四舍五入到四位有效数字，结果是 $-1.010$。", "answer": "$$\\boxed{-1.010}$$", "id": "2731698"}]}