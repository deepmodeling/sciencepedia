{"hands_on_practices": [{"introduction": "我们从一个基本问题开始：新的转座元件（TE）插入如何在群体中被固定下来，成为基因组的永久特征？这个练习将转座元件动力学与分子演化的中性理论这一群体遗传学的基石联系起来。通过从第一性原理出发，你将推导在有效中性选择条件下转座元件的固定速率，揭示遗传漂变在基因组演化中的关键作用。[@problem_id:2760153]", "problem": "考虑一个大的、随机交配的二倍体种群，该种群在 Wright–Fisher 模型下演化，有效种群大小为 $N_{e}$。一个转座元件（TE；transposable element）家族以每个单倍体基因组每代 $u$ 的速率产生新的插入。假设采用无限位点近似，因此每次 TE 插入都发生在一个先前未被占据的位点上，并且插入之间的连锁和干扰可以忽略不计。每次新插入对携带者具有加性适合度效应 $s$，使得携带一个新插入拷贝的杂合子的相对适合度为 $1 - \\frac{s}{2}$，纯合子的相对适合度为 $1 - s$，其中 $|s| \\ll 1$。TE 插入不存在切除或删除。\n\n从群体遗传学关于有限种群中突变输入和固定概率的基本原理出发，确定在何种参数范围内，对单个 TE 插入的选择相对于遗传漂变是有效中性的，并推导在有效中性极限下，固定 TE 插入在整个基因组中累积的预期长期速率，该速率以整个种群中每代新固定的 TE 插入的预期数量来衡量。将您的最终答案表示为仅含 $u$ 的封闭形式解析表达式。最终答案中不要包含任何不等式。", "solution": "该问题要求在 Wright–Fisher 模型下，推导一个二倍体种群中固定转座元件（TE）累积的长期速率，特别是在选择是有效中性的极限情况下。这个速率，通常表示为替换率 $K$，基本上由两个量决定：整个种群中每代新突变（在此案例中为 TE 插入）产生的速率，以及这样一个新突变最终达到固定（频率为 $1$）的概率。\n\n首先，我们确定每代引入种群的新 TE 插入总数。该种群是二倍体，有效大小为 $N_{e}$，这意味着它包含 $2N_{e}$ 个单倍体基因组。问题陈述了新 TE 插入以每个单倍体基因组每代 $u$ 的速率发生。因此，整个种群的新 TE 插入总速率 $\\mu_{total}$ 为：\n$$ \\mu_{total} = 2N_{e}u $$\n\n接下来，我们必须确定单个新 TE 插入的固定概率 $P_{fix}$。问题指定了一个加性适合度模型。相对于野生型适合度 $1$，携带一个 TE 拷贝的杂合子适合度为 $1 - s/2$，携带两个拷贝的纯合子适合度为 $1 - s$。这对应于一个基因选择模型，其中含有 TE 的等位基因在杂合子中具有选择系数 $s_{het} = -s/2$，假设 TE 是有害的（$s  0$）。\n\n在一个大小为 $N_{e}$ 的二倍体种群中，一个在杂合子中具有选择效应 $s_{het}$ 的新突变的固定概率由 Kimura 的公式给出：\n$$ P_{fix} = \\frac{1 - \\exp(-2s_{het})}{1 - \\exp(-4N_{e}s_{het})} $$\n将我们的值 $s_{het} = -s/2$ 代入这个通用表达式，我们得到：\n$$ P_{fix} = \\frac{1 - \\exp\\left(-2\\left(-\\frac{s}{2}\\right)\\right)}{1 - \\exp\\left(-4N_{e}\\left(-\\frac{s}{2}\\right)\\right)} = \\frac{1 - \\exp(s)}{1 - \\exp(2N_{e}s)} $$\n这个公式对任意 $s$ 和 $N_{e}$ 的值都有效。\n\n问题指示我们在“有效中性极限”下进行。当选择力的量级远小于遗传漂变力的量级时，一个等位基因表现为有效中性。对稀有等位基因的选择强度由其在杂合子中的效应 $|s_{het}|$ 决定，而漂变的强度约为 $1/(2N_{e})$。比较这两种力量的参数是 $2N_{e}s_{het}$。有效中性的条件是 $|2N_{e}s_{het}| \\ll 1$。对于本问题，该条件变为：\n$$ \\left|2N_{e}\\left(-\\frac{s}{2}\\right)\\right| \\ll 1 \\implies |N_{e}s| \\ll 1 $$\n在此条件下，$P_{fix}$ 公式分母中指数的参数 $2N_{e}s$ 的量级很小。问题还陈述了 $|s| \\ll 1$，这确保了分子中指数的参数也很小。因此，我们可以对小的 $|x|$ 使用泰勒级数近似 $\\exp(x) \\approx 1 + x$。\n\n将此近似应用于我们 $P_{fix}$ 表达式的分子和分母：\n- 分子变为：$1 - \\exp(s) \\approx 1 - (1 + s) = -s$。\n- 分母变为：$1 - \\exp(2N_{e}s) \\approx 1 - (1 + 2N_{e}s) = -2N_{e}s$。\n\n因此，在有效中性极限下，固定概率简化为：\n$$ P_{fix} \\approx \\frac{-s}{-2N_{e}s} = \\frac{1}{2N_{e}} $$\n这个结果与一个基本原理相符，即一个严格中性突变的固定概率等于其在种群中的初始频率，对于一个在有效大小为 $N_{e}$ 的二倍体种群中的单个拷贝来说，该频率为 $1/(2N_{e})$。\n\n最后，固定 TE 的累积速率 $K$ 是每代每个种群的总突变率与每个新突变的固定概率的乘积。\n$$ K = \\mu_{total} \\times P_{fix} $$\n代入我们推导出的表达式：\n$$ K = (2N_{e}u) \\times \\left(\\frac{1}{2N_{e}}\\right) $$\n涉及有效种群大小 $2N_{e}$ 的项相互抵消，得到最终结果：\n$$ K = u $$\n这表明，在有效中性极限下，整个种群每代新 TE 插入的固定速率就等于每个单倍体基因组的插入速率。这是分子演化中性理论的一个经典结果，表明中性突变的替换率与种群大小无关。", "answer": "$$ \\boxed{u} $$", "id": "2760153"}, {"introduction": "在理解了单个TE的固定过程后，我们将尺度放大到整个基因组。转座元件不断插入（DNA增加）和小型缺失（DNA减少）这两种相互拮抗的力量，是如何共同决定基因组大小的演化方向——扩张还是收缩？这个练习引导你构建一个简洁的平衡模型，来量化这些力量之间的博弈，并计算决定基因组演化方向的“临界损失率”。[@problem_id:2760197]", "problem": "一个大型真核生物基因组包含许多转座元件（TE; transposable elements）。考虑一个由TE插入和DNA丢失驱动的、关于每代预期基因组大小变化的最小平衡模型。设 $n$ 表示基因组中活跃TE拷贝的数量，$u$ 为每拷贝每代的转座率，$\\gamma$ 为导致成功插入并保留在生殖系中的转座事件的比例，$\\ell$ 为以碱基对（bp; base pairs）为单位的平均插入长度，$\\delta$ 为每代因小规模缺失和移除过程而预期的DNA丢失量。假设TE拷贝之间以及各代之间是独立的，并线性处理期望值。\n\n1. 根据基本原理，将每代基因组大小的预期净变化量 $\\Delta G$ 写为成功插入所增加的预期DNA与缺失所丢失的预期DNA之差的表达式，并用 $\\gamma$、$u$、$n$、$\\ell$ 和 $\\delta$ 来表示。\n\n2. 将临界丢失率 $\\delta_{\\mathrm{crit}}$ 定义为使预期净变化满足 $\\Delta G = 0$ 时的 $\\delta$ 值。以符号形式求解 $\\delta_{\\mathrm{crit}}$，用 $\\gamma$、$u$、$n$ 和 $\\ell$ 表示。用文字或符号简要说明，在长期预期中基因组扩张的条件（用 $\\delta$ 和 $\\delta_{\\mathrm{crit}}$ 表示）。\n\n3. 使用参数值 $\\gamma = 0.3$，$u = 1.0 \\times 10^{-4}$ 每拷贝每代，$n = 1200$ 以及 $\\ell = 3000$ bp，计算 $\\delta_{\\mathrm{crit}}$ 的数值。将最终值以“碱基对/代”为单位表示，并将答案四舍五入到四位有效数字。最终结果只提供数值；不要在最终的方框答案中包含单位。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n首先，逐字提取所有给定条件。\n- $n$：基因组中活跃TE拷贝的数量\n- $u$：每拷贝每代的转座率\n- $\\gamma$：导致成功插入并保留在生殖系中的转座事件的比例\n- $\\ell$：以碱基对（bp）为单位的平均插入长度\n- $\\delta$：每代预期的DNA丢失量\n- $\\Delta G$：每代基因组大小的预期净变化量\n- 假设：TE拷贝之间以及各代之间是独立的\n- 假设：期望值被线性处理\n- 第3部分的数值：$\\gamma = 0.3$，$u = 1.0 \\times 10^{-4}$ 每拷贝每代，$n = 1200$，$\\ell = 3000$ bp。\n\n其次，评估问题的有效性。该问题提出了一个简化但标准的基因组大小演化平衡模型，这是演化基因组学中的一个基本概念。参数定义明确，独立性和线性假设是构建此类一阶模型的标准做法。该问题具有科学依据、问题明确、客观且内部一致。它没有违反任何指定的无效标准。该模型是期望原理在生物过程中的正确和直接应用。\n\n因此，该问题被判定为**有效**。将提供解答。\n\n1. 每代基因组大小的预期净变化量 $\\Delta G$ 是由新的TE插入所增加的预期总DNA长度与丢失的预期总DNA长度之差。\n\n每代预期的DNA丢失量由参数 $\\delta$ 直接给出。\n\n每代预期的DNA增加量必须推导得出。我们从单个活跃的TE拷贝开始。\n- 单个拷贝的转座率为每代 $u$ 次事件。\n- 并非所有转座事件都能导致稳定的插入。成功且可遗传的事件比例为 $\\gamma$。\n- 因此，每个TE拷贝成功且可遗传的插入率为 $\\gamma u$ 的乘积。\n- 由于基因组中有 $n$ 个活跃的TE拷贝，并且假设它们的活动是独立的，因此每代成功插入的总预期数量是每个拷贝期望值的总和，即 $n \\gamma u$。\n- 每次成功插入平均向基因组增加长度为 $\\ell$ 的碱基对。\n- 根据期望的线性性质，每代增加的总预期DNA是成功插入的预期数量与每次插入的平均长度的乘积。\n- 预期增加的DNA = $(n \\gamma u) \\times \\ell = n \\gamma u \\ell$。\n\n基因组大小的预期净变化量 $\\Delta G$ 是预期增加量减去预期丢失量：\n$$ \\Delta G = n \\gamma u \\ell - \\delta $$\n\n2. 临界丢失率 $\\delta_{\\mathrm{crit}}$ 定义为基因组大小预期净变化为零时的 $\\delta$ 值，即 $\\Delta G = 0$。使用第一部分推导出的表达式，我们建立方程：\n$$ n \\gamma u \\ell - \\delta_{\\mathrm{crit}} = 0 $$\n求解该方程以得到 $\\delta_{\\mathrm{crit}}$ 是很简单的：\n$$ \\delta_{\\mathrm{crit}} = n \\gamma u \\ell $$\n这就是临界丢失率的符号表达式。\n\n当基因组大小的净变化为正时，即条件 $\\Delta G  0$ 成立时，会出现长期的预期基因组扩张。代入 $\\Delta G$ 的表达式：\n$$ n \\gamma u \\ell - \\delta  0 $$\n认识到 $n \\gamma u \\ell$ 是 $\\delta_{\\mathrm{crit}}$ 的定义，我们可以用 $\\delta$ 和 $\\delta_{\\mathrm{crit}}$ 来写出基因组扩张的条件：\n$$ \\delta_{\\mathrm{crit}}  \\delta \\quad \\text{或等价地} \\quad \\delta  \\delta_{\\mathrm{crit}} $$\n换言之，如果由缺失导致的DNA丢失率小于由TE插入导致的DNA增加率，则基因组预期会扩张。\n\n3. 我们需要使用提供的参数值来计算 $\\delta_{\\mathrm{crit}}$ 的数值：\n- $n = 1200$\n- $\\gamma = 0.3$\n- $u = 1.0 \\times 10^{-4}$ 每代\n- $\\ell = 3000$ bp\n\n我们将这些值代入 $\\delta_{\\mathrm{crit}}$ 的表达式中：\n$$ \\delta_{\\mathrm{crit}} = n \\gamma u \\ell = (1200) \\times (0.3) \\times (1.0 \\times 10^{-4}) \\times (3000) $$\n计算过程如下：\n$$ \\delta_{\\mathrm{crit}} = (1.2 \\times 10^{3}) \\times (3 \\times 10^{-1}) \\times (1.0 \\times 10^{-4}) \\times (3 \\times 10^{3}) $$\n$$ \\delta_{\\mathrm{crit}} = (1.2 \\times 3 \\times 1.0 \\times 3) \\times 10^{(3 - 1 - 4 + 3)} $$\n$$ \\delta_{\\mathrm{crit}} = 10.8 \\times 10^{(1)} $$\n$$ \\delta_{\\mathrm{crit}} = 108 $$\n单位是一致的，结果为 bp/代。问题要求答案四舍五入到四位有效数字。精确整数值 $108$ 必须表示为四位有效数字，即 $108.0$。", "answer": "$$\\boxed{108.0}$$", "id": "2760197"}, {"introduction": "理论模型的力量在于其预测能力，但这依赖于对关键参数（如转座率$u$和选择系数$s$）的准确估计。我们如何从真实的群体数据中获得这些参数值呢？这个实践练习将理论与数据分析联系起来，介绍一种利用群体中TE拷贝数的均值和方差来推断这些隐藏演化参数的强大方法。[@problem_id:2760164]", "problem": "您将要完成一个种群遗传学建模任务，该任务针对一个在随机交配、有效种群大小（Effective Population Size (N_e)）恒定的种群中，遵循复制-粘贴动态的单一转座元件（TE; Transposable Element）家族。假设以下经过充分检验的基础模型，该模型将转座、选择、漂变与每个个体观测到的TE拷贝数联系起来：\n\n- 在一代之内，每个携带着基因组中新TE拷贝的产生遵循一个泊松过程，其每个基因组的速率为每代 $u$。每个个体的总TE拷贝数由非负整数随机变量 $K$ 表示。\n- 选择会随着拷贝数的增加而以乘法方式降低适应度，其关系为 $w = \\exp(-s K)$，其中 $s \\ge 0$ 是单拷贝选择系数。\n- 遗传漂变在弱选择和弱突变条件下，通过一个具有恒定 $N_e$ 的扩散近似来捕捉。\n\n在这些假设下，并考虑到由于转座、选择和漂变的平衡，在平稳状态下个体间变化的潜在每个基因组泊松速率 $m$，一个标准结果是 $m$ 近似服从伽马分布，其形状参数为 $\\alpha = 2 N_e u$，速率参数为 $\\beta = 2 N_e s$。在给定 $m$ 的条件下，观测到的拷贝数 $K \\mid m \\sim \\mathrm{Poisson}(m)$。在携带着（拥有至少一个能够转座的自主元件的个体）中，由于是泊松-伽马混合，$K$ 的边际分布遵循负二项分布（Negative Binomial (NB)）。由此产生的携带着中的矩为\n$$\n\\mu \\equiv \\mathbb{E}[K \\mid \\text{carrier}] = \\frac{\\alpha}{\\beta} = \\frac{u}{s}, \\quad\n\\sigma^2 \\equiv \\mathrm{Var}(K \\mid \\text{carrier}) = \\mu + \\frac{\\mu^2}{\\alpha} = \\frac{u}{s} + \\frac{u}{2 N_e s^2}.\n$$\n这种基于扩散近似的矩结构允许从携带着中的拷贝数联合信息和已知的 $N_e$ 来识别 $u$ 和 $s$，条件是携带着中的样本方差超过样本均值。\n\n对于几个情景中的每一个，您都观测到从一个大型队列中计算出的以下汇总统计量，该队列具有已知的携带着状态 $C \\in \\{0,1\\}$（其中 $C=1$ 表示携带着一个能够实现持续转座的自主元件）：\n- 携带着（$C=1$）中 $K$ 的样本均值 $\\hat{\\mu}$，\n- 携带着（$C=1$）中 $K$ 的样本方差 $\\hat{\\sigma}^2$，\n- 有效种群大小 $N_e$（假设已知），\n- 队列中携带着的比例 $\\hat{f} \\in [0,1]$。\n\n您可以假设非携带着（$C=0$）的持续转座可忽略不计（$u \\approx 0$），因此它们的拷贝数分布集中在 $K=0$ 附近；因此，$u$ 和 $s$ 的推断以携带着为条件，并使用上述基于扩散近似的矩。此处所有量均为每代的无量纲量；请以小数形式报告所有输出。\n\n任务：\n- 通过消去 $m$ 和 $\\alpha$，从上述等式中推导 $u$ 和 $s$ 的估计量。您的推导必须从本说明中给出的基本模型假设开始，并且只使用所述的矩关系。\n- 实现一个程序，对于下面指定的每个测试用例，仅使用来自携带着的 $(\\hat{\\mu}, \\hat{\\sigma}^2, N_e)$ 来计算估计值 $(\\hat{u}, \\hat{s})$。如果 $\\hat{\\sigma}^2 \\le \\hat{\\mu}$，则对于该用例，将 $\\hat{u}$ 和 $\\hat{s}$ 都设置为 $\\mathrm{NaN}$。\n- 将每个 $\\hat{u}$ 和 $\\hat{s}$ 表示为四舍五入到小数点后六位的小数。\n\n测试套件（每个用例是一个元组 $(\\hat{\\mu}, \\hat{\\sigma}^2, N_e, \\hat{f})$）：\n- 用例 1（通用）：$(20.0, 21.0, 1000, 0.70)$。\n- 用例 2（中度过离散）：$(10.0, 12.0, 500, 0.80)$。\n- 用例 3（在大 $N_e$ 下接近泊松极限）：$(10.0, 10.0001, 1000000, 0.95)$。\n- 用例 4（低均值，轻微过离散）：$(2.0, 2.00005, 100000, 0.60)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含所有用例结果的有序连接列表，格式为用方括号括起来的逗号分隔列表。对于每个用例，先输出 $\\hat{u}$，然后是 $\\hat{s}$。例如，包含两个用例的输出应如下所示：$[\\hat{u}_1,\\hat{s}_1,\\hat{u}_2,\\hat{s}_2]$。\n- 因此，对于这个包含四个用例的问题，您的程序应输出 $[\\hat{u}_1,\\hat{s}_1,\\hat{u}_2,\\hat{s}_2,\\hat{u}_3,\\hat{s}_3,\\hat{u}_4,\\hat{s}_4]$，其中每个条目都四舍五入到小数点后六位。", "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于已确立的种群遗传学理论，提法得当，目标明确，数据充分，并以客观、无歧义的语言表述。该模型涉及使用泊松-伽马混合来描述转座元件拷贝数，是进化生物学中的一个标准框架。该任务是矩量法在该模型上的直接应用。\n\n转座速率 $u$ 和选择系数 $s$ 的估计量的推导从提供的携带着拷贝数 $K$ 的矩方程开始。这些方程是在转座、选择和遗传漂变作用下，转座元件动态的扩散近似的结果。潜在的每个基因组转座速率 $m$ 被假设遵循伽马分布，$m \\sim \\Gamma(\\alpha, \\beta)$，其形状参数为 $\\alpha = 2 N_e u$，速率参数为 $\\beta = 2 N_e s$。在给定 $m$ 的条件下，观测到的拷贝数 $K$ 服从泊松分布，$K \\mid m \\sim \\mathrm{Poisson}(m)$。因此，$K$ 的边际分布是负二项分布，其均值和方差如下：\n$$\n\\mu = \\mathbb{E}[K \\mid \\text{carrier}] = \\frac{\\alpha}{\\beta}\n\\quad (1)\n$$\n$$\n\\sigma^2 = \\mathrm{Var}(K \\mid \\text{carrier}) = \\mu + \\frac{\\mu^2}{\\alpha}\n\\quad (2)\n$$\n此处，$\\mu$ 和 $\\sigma^2$ 分别是真实均值和方差，$N_e$ 是有效种群大小。我们的目标是找出用 $\\mu$、$\\sigma^2$ 和 $N_e$ 表示 $u$ 和 $s$ 的表达式。\n\n首先，将给定的定义 $\\alpha = 2 N_e u$ 和 $\\beta = 2 N_e s$ 代入方程 $(1)$：\n$$\n\\mu = \\frac{2 N_e u}{2 N_e s} = \\frac{u}{s}\n\\quad (3)\n$$\n该方程将平均拷贝数与转座速率和选择系数的比率直接联系起来。\n\n接下来，我们重排方程 $(2)$ 以求解形状参数 $\\alpha$：\n$$\n\\sigma^2 - \\mu = \\frac{\\mu^2}{\\alpha}\n$$\n在 $\\sigma^2  \\mu$ 的条件下，这表明相对于泊松分布存在过离散，我们可以写出：\n$$\n\\alpha = \\frac{\\mu^2}{\\sigma^2 - \\mu}\n\\quad (4)\n$$\n条件 $\\sigma^2  \\mu$ 是 $\\alpha$ 为正所必需的，而这是有效伽马分布的要求。如果样本方差不超过样本均值，则该模型不适用，参数也未定义。\n\n现在，我们将方程 $(4)$ 中 $\\alpha$ 的表达式与其用基本参数 $u$ 和 $N_e$ 表示的定义相等同：\n$$\n2 N_e u = \\frac{\\mu^2}{\\sigma^2 - \\mu}\n$$\n求解 $u$ 得到转座速率的估计量：\n$$\nu = \\frac{\\mu^2}{2 N_e (\\sigma^2 - \\mu)}\n\\quad (5)\n$$\n为了求出选择系数 $s$，我们将方程 $(3)$ 重排为 $s = u/\\mu$。代入方程 $(5)$ 中 $u$ 的表达式，我们得到：\n$$\ns = \\frac{1}{\\mu} \\left( \\frac{\\mu^2}{2 N_e (\\sigma^2 - \\mu)} \\right) = \\frac{\\mu}{2 N_e (\\sigma^2 - \\mu)}\n\\quad (6)\n$$\n使用矩量法，我们将总体参数 $\\mu$ 和 $\\sigma^2$ 替换为它们的样本估计值 $\\hat{\\mu}$ 和 $\\hat{\\sigma}^2$，以获得估计量 $\\hat{u}$ 和 $\\hat{s}$：\n$$\n\\hat{u} = \\frac{\\hat{\\mu}^2}{2 N_e (\\hat{\\sigma}^2 - \\hat{\\mu})}\n$$\n$$\n\\hat{s} = \\frac{\\hat{\\mu}}{2 N_e (\\hat{\\sigma}^2 - \\hat{\\mu})}\n$$\n这些估计量将用于计算任务。\n\n实现部分将包含一个函数，该函数以元组 $(\\hat{\\mu}, \\hat{\\sigma}^2, N_e)$ 作为输入。它首先验证条件 $\\hat{\\sigma}^2  \\hat{\\mu}$。如果不满足此条件，该函数将按规定为 $\\hat{u}$ 和 $\\hat{s}$ 返回非数值（$\\mathrm{NaN}$）。否则，它使用推导出的公式计算 $\\hat{u}$ 和 $\\hat{s}$。程序将遍历提供的测试用例，为每个用例计算估计值，将其格式化为六位小数，并以要求的格式打印出扁平化的结果列表。携带着的比例 $\\hat{f}$ 对此特定计算是无关信息，并被正确地忽略了。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes estimators for transposition rate (u) and selection coefficient (s)\n    based on a population-genetic model of transposable elements.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (mu_hat, sigma_sq_hat, N_e, f_hat).\n    # The last element, f_hat, is not used in the calculation as per the problem.\n    test_cases = [\n        (20.0, 21.0, 1000, 0.70),\n        (10.0, 12.0, 500, 0.80),\n        (10.0, 10.0001, 1000000, 0.95),\n        (2.0, 2.00005, 100000, 0.60),\n    ]\n\n    # A list to store the final flattened results [u1, s1, u2, s2, ...].\n    results = []\n\n    for case in test_cases:\n        mu_hat, sigma_sq_hat, N_e, _ = case\n\n        # The model is only valid if the variance is greater than the mean\n        # (overdispersion relative to Poisson).\n        if sigma_sq_hat = mu_hat:\n            u_hat = np.nan\n            s_hat = np.nan\n        else:\n            # Calculate the denominator term, which is common for both estimators.\n            # Denominator = 2 * N_e * (sigma^2 - mu)\n            denominator = 2 * N_e * (sigma_sq_hat - mu_hat)\n\n            # Estimator for the transposition rate u:\n            # u_hat = mu_hat^2 / denominator\n            u_hat = (mu_hat ** 2) / denominator\n\n            # Estimator for the selection coefficient s:\n            # s_hat = mu_hat / denominator\n            s_hat = mu_hat / denominator\n        \n        results.append(u_hat)\n        results.append(s_hat)\n\n    # Format the results for the final output string. Each number is formatted\n    # to a string with six decimal places. NaN values are formatted as 'nan'.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Print the final output as a single line, comma-separated list\n    # enclosed in square brackets, as required.\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2760164"}]}