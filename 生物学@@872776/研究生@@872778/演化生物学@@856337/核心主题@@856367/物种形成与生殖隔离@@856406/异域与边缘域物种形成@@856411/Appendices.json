{"hands_on_practices": [{"introduction": "异域物种形成（allopatric speciation）的标志是地理隔离的种群之间遗传差异的累积。本练习将深入分子群体遗传学的核心，运用溯祖理论（coalescent theory）来模拟这一过程。通过推导过去分离的两个种群之间的预期遗传分化，您将构建一个从基因组数据中估算物种形成时间的基础工具 [@problem_id:2690475]。", "problem": "考虑两个异域种群 $X$ 和 $Y$，它们在 $T$ 代前从一个有效种群大小恒为 $N_{eA}$ 的祖先随机交配种群中分化开来。假设一个中性、无限位点突变模型，每个位点、每代的突变率为 $\\mu$，分化后无基因流，且没有选择改变中性突变率。设从种群 $X$ 和 $Y$ 中各抽样一个个体单倍体基因组，它们之间的期望成对分化度（每位点）记为 $d_{XY}$。该祖先种群常用的种群遗传学参数为 $\\theta_{A} = 4 N_{eA} \\mu$。\n\n任务：\n1) 从溯祖推断和谱系上的泊松突变过程（在无限位点模型下）出发，推导从异域分化了 $T$ 代的种群 $X$ 和 $Y$ 中抽样的两个谱系的期望分化度 $d_{XY} = 2 \\mu T + \\theta_{A}$。\n\n2) 假设你对来自种群 $X$ 和 $Y$ 的各一个单倍体基因组进行了测序，比对了 $L$ 个独立的中性进化位点，并统计出成对差异数为 $D$。使用 $\\hat{d}_{XY} = D/L$ 作为 $d_{XY}$ 的估计量。假设你有一个对祖先参数 $\\theta_{A}$ 的独立估计，并且 $\\mu$ 已知。请用 $\\hat{d}_{XY}$、$\\theta_{A}$ 和 $\\mu$ 推导分化时间 $T$ 的估计量 $\\hat{T}$。\n\n3) 将你的估计量应用于以下数据，以获得分化时间的数值估计。使用 $L = 3.0 \\times 10^{6}$ 个位点，$D = 6.6 \\times 10^{4}$ 个成对差异，每个位点每代的突变率 $\\mu = 1.0 \\times 10^{-8}$，以及祖先种群参数 $\\theta_{A} = 2.0 \\times 10^{-3}$。用“代”作为单位表示最终的 $T$ 的估计值，并将答案四舍五入到三位有效数字。", "solution": "所提出的问题是溯祖理论和种群遗传学中的一个标准练习。它具有科学依据，问题陈述清晰且客观，其表述没有缺陷。我们将按要求进行推导和计算。\n\n问题分为三个部分。我们将依次解决每个部分。\n\n第1部分：期望成对分化度 $d_{XY}$ 的推导。\n我们考虑从种群 $X$ 和 $Y$ 中各抽样的一个单倍体基因组。我们向过去追溯这两个谱系的祖先。种群 $X$ 和 $Y$ 已经隔离了 $T$ 代。在此期间，这两个谱系位于不同的种群中，不能合并。在异域分化阶段，这两个谱系所经历的总时间为：来自 $X$ 的谱系 $T$ 代，来自 $Y$ 的谱系 $T$ 代，总计为 $2T$ 代的独立进化时间。\n\n在过去的 $T$ 代时，两个谱系都进入了共同的祖先种群，该种群的有效大小恒为 $N_{eA}$。在针对二倍体种群的标准 Wright-Fisher 模型下，两个随机选择的谱系在任何一代中合并的概率是 $\\frac{1}{2N_{eA}}$。直到合并的时间 $T_c$ 是一个几何分布的随机变量，其成功概率为 $p = \\frac{1}{2N_{eA}}$。因此，在这个祖先种群中，期望的合并时间是 $E[T_c] = \\frac{1}{p} = 2N_{eA}$ 代。\n\n从现在到两个抽样谱系的最近共同祖先（MRCA）的总期望时间 $E[T_{MRCA}]$，是在分离种群中度过的时间与在祖先种群中期望合并时间的总和：\n$$E[T_{MRCA}] = T + E[T_c] = T + 2N_{eA}$$\n\n连接两个谱系的谱系总长度，从末端（现今）到它们的 MRCA，是到 MRCA 时间的两倍。设这个总期望分支长度为 $E[L_{total}]$。\n$$E[L_{total}] = 2 \\times E[T_{MRCA}] = 2(T + 2N_{eA}) = 2T + 4N_{eA}$$\n\n在无限位点模型下，突变沿着谱系的分支以每个位点每代 $\\mu$ 的恒定速率作为泊松过程积累。每位点的期望替换数 $d_{XY}$ 是总期望分支长度与突变率的乘积。\n$$d_{XY} = E[L_{total}] \\times \\mu = (2T + 4N_{eA})\\mu = 2\\mu T + 4N_{eA}\\mu$$\n\n问题将祖先种群遗传学参数定义为 $\\theta_A = 4N_{eA}\\mu$。将此定义代入我们关于 $d_{XY}$ 的表达式中：\n$$d_{XY} = 2\\mu T + \\theta_{A}$$\n这完成了第一部分所要求的推导。\n\n第2部分：分化时间 $T$ 的估计量的推导。\n我们从第1部分推导出的关系开始：\n$$d_{XY} = 2\\mu T + \\theta_A$$\n我们的目标是用其他参数表示 $T$。这是一个简单的代数重排。\n$$d_{XY} - \\theta_A = 2\\mu T$$\n$$T = \\frac{d_{XY} - \\theta_A}{2\\mu}$$\n为了构建 $T$ 的估计量，记为 $\\hat{T}$，我们将理论量 $d_{XY}$ 替换为其经验估计值 $\\hat{d}_{XY}$。值 $\\hat{d}_{XY}$ 是通过观察到的成对差异数 $D$ 除以比对的总位点数 $L$ 来计算的。参数 $\\theta_A$ 和 $\\mu$ 作为已知常数给出。\n因此，分化时间的估计量是：\n$$\\hat{T} = \\frac{\\hat{d}_{XY} - \\theta_A}{2\\mu}$$\n其中 $\\hat{d}_{XY} = \\frac{D}{L}$。这完成了第二部分。\n\n第3部分：分化时间 $T$ 的数值估计。\n我们得到以下数据：\n-   比对位点数, $L = 3.0 \\times 10^{6}$。\n-   成对差异数, $D = 6.6 \\times 10^{4}$。\n-   每个位点、每代的突变率, $\\mu = 1.0 \\times 10^{-8}$。\n-   祖先种群参数, $\\theta_A = 2.0 \\times 10^{-3}$。\n\n首先，我们计算成对分化度的估计值 $\\hat{d}_{XY}$：\n$$\\hat{d}_{XY} = \\frac{D}{L} = \\frac{6.6 \\times 10^{4}}{3.0 \\times 10^{6}} = 2.2 \\times 10^{-2}$$\n\n接下来，我们将 $\\hat{d}_{XY}$ 以及 $\\theta_A$ 和 $\\mu$ 的给定值代入我们的 $T$ 估计量中：\n$$\\hat{T} = \\frac{\\hat{d}_{XY} - \\theta_A}{2\\mu} = \\frac{(2.2 \\times 10^{-2}) - (2.0 \\times 10^{-3})}{2 \\times (1.0 \\times 10^{-8})}$$\n\n我们进行计算。分子是：\n$$2.2 \\times 10^{-2} - 2.0 \\times 10^{-3} = 0.022 - 0.002 = 0.020 = 2.0 \\times 10^{-2}$$\n分母是：\n$$2 \\times (1.0 \\times 10^{-8}) = 2.0 \\times 10^{-8}$$\n现在我们计算最终的比率：\n$$\\hat{T} = \\frac{2.0 \\times 10^{-2}}{2.0 \\times 10^{-8}} = 1.0 \\times 10^{6}$$\n估计的分化时间是 $1,000,000$ 代。问题要求答案四舍五入到三位有效数字。用科学记数法表示，即为 $1.00 \\times 10^{6}$。", "answer": "$$ \\boxed{1.00 \\times 10^{6}} $$", "id": "2690475"}, {"introduction": "缘域物种形成（peripatric speciation）是异域物种形成的一种特殊情况，它发生在小而边缘的隔离种群中，在这些种群中遗传漂变（genetic drift）可能产生巨大的影响。本练习探讨了漂变如何克服微弱的负选择，从而固定新的突变（例如染色体重排），这些突变在杂合子中是不利的。理解这一过程对于解释奠基者种群中合子后生殖隔离屏障的快速进化至关重要 [@problem_id:2690538]。", "problem": "一个大陆种群经历了范围扩张，在一个离岸岛屿上建立了一个小的奠基者种群，形成了一个边缘隔离群体。假设在殖民之后，岛屿种群与大陆之间的基因流可以忽略不计，并且可以被建模为一个具有恒定有效种群大小（Effective Population Size (N_e)）$N_e$的Wright–Fisher种群。岛上出现了一个新的染色体倒位，只有一个拷贝。该倒位是杂合劣势的（underdominant）：与两种纯合子相比，杂合子具有相对适合度劣势 $s_h0$，因此当该倒位稀有时，它会经历阻止其频率增加的定向选择。\n\n使用Wright–Fisher种群中选择-漂变动态的扩散近似，以及一个经过充分检验的中性基准，即单个新等位基因的固定概率为 $1/(2N_e)$。在轻度杂合劣势和初始频率较小的情况下，普遍观察到有害变异的固定概率相对于中性情况呈指数级抑制，抑制量与乘积 $N_e s_h$ 成正比。在这种边缘隔离的背景下，定义“漂变可以将杂合劣势的倒位推向固定”，如果其在岛上的固定概率至少是中性固定概率的 $r$ 倍。\n\n推导出在该条件下漂变可以将倒位推向固定的、关联 $N_e$、$s_h$ 和 $r$ 的解析条件，然后计算当 $N_e = 500$ 和 $r = 0.2$ 时，仍然满足此条件的最大杂合子劣势 $s_h^{\\ast}$。将 $s_h^{\\ast}$ 报告为一个纯数字（无单位），并将您的答案四舍五入到四位有效数字。", "solution": "首先对问题陈述进行验证。\n\n逐字提取给定条件：\n- 一个大陆种群在一个离岸岛屿上建立了一个奠基者种群（边缘隔离群体）。\n- 岛屿种群的基因流可以忽略不计，并被建模为一个Wright–Fisher种群。\n- 恒定的有效种群大小为 $N_e$。\n- 一个新的染色体倒位以单个拷贝的形式出现。\n- 该倒位是杂合劣势的：杂合子具有相对适合度劣势 $s_h  0$。\n- 单个新等位基因的中性基准固定概率为 $\\frac{1}{2N_e}$。\n- 有害变异的固定概率相对于中性情况呈指数级抑制，抑制量与乘积 $N_e s_h$ 成正比。\n- “漂变可以将杂合劣势的倒位推向固定”的条件被定义为其固定概率至少是中性固定概率的 $r$ 倍。\n- 用于计算的值：$N_e = 500$ 和 $r = 0.2$。\n- 目标是推导出关联 $N_e$、$s_h$ 和 $r$ 的解析条件，然后为给定值计算满足此条件的最大杂合子劣势 $s_h^{\\ast}$，并四舍五入到四位有效数字。\n\n验证结论：\n该问题具有科学依据，提法明确，且客观。它描述了理论群体遗传学中的一个经典场景，利用了像Wright–Fisher过程和扩散近似这样的标准模型。由于遗传漂变导致杂合劣势等位基因在小种群中固定的前提是演化生物学中一个有效且重要的概念，尤其是在物种形成模型中。所提供的信息是自洽的，足以推导出一个唯一的解。因此，该问题被认为是有效的。\n\n解答：\n设 $P_{neutral}$ 为一个新中性等位基因的固定概率。问题给出其表达式为：\n$$ P_{neutral} = \\frac{1}{2N_e} $$\n这对应于一个新突变以单个拷贝的形式出现，在一个有效大小为 $N_e$ 的二倍体种群中，其初始频率为 $p_0 = \\frac{1}{2N_e}$。\n\n设 $P_{fix}(s_h)$ 为该杂合劣势倒位的固定概率。问题陈述该倒位在稀有时是有害的，并且其固定概率相对于中性情况呈指数级抑制。抑制因子与乘积 $N_e s_h$ 成正比。这可以数学上表示为：\n$$ P_{fix}(s_h) = P_{neutral} \\cdot \\exp(-k N_e s_h) $$\n其中 $k$ 为某个比例常数。对于一个具有恒定选择系数 $s$ 的轻微有害等位基因，其固定概率的既定扩散近似为 $P_{fix}(s) \\approx P_{neutral} \\exp(-2 N_e s)$。在杂合劣势等位基因的情况下，杂合子适合度为 $1-s_h$（相对于野生型纯合子适合度为1），当该等位基因稀有时，它主要存在于杂合子中。因此，它经历的有效选择系数大小为 $s_h$。因此，我们采用标准近似，其中比例常数 $k=2$。该倒位固定概率的模型为：\n$$ P_{fix}(s_h) = \\frac{1}{2N_e} \\exp(-2 N_e s_h) $$\n问题将漂变可能将倒位推向固定的条件定义为其固定概率至少是中性概率的 $r$ 倍。我们可以将其写成一个不等式：\n$$ P_{fix}(s_h) \\ge r \\cdot P_{neutral} $$\n代入概率的表达式得到：\n$$ \\frac{1}{2N_e} \\exp(-2 N_e s_h) \\ge r \\left( \\frac{1}{2N_e} \\right) $$\n由于 $N_e$ 是种群大小，它是正数，因此 $\\frac{1}{2N_e}$ 也是正数。我们可以在不等式两边同乘以 $2N_e$ 而不改变不等号的方向：\n$$ \\exp(-2 N_e s_h) \\ge r $$\n为了求解包含 $s_h$ 的关系，我们对两边取自然对数。自然对数是一个单调递增函数，所以不等号的方向保持不变：\n$$ \\ln(\\exp(-2 N_e s_h)) \\ge \\ln(r) $$\n$$ -2 N_e s_h \\ge \\ln(r) $$\n为了分离出 $s_h$，我们必须除以 $-2 N_e$。由于 $N_e  0$，项 $-2N_e$ 是负数。不等式两边同除以一个负数会反转不等号的方向：\n$$ s_h \\le \\frac{\\ln(r)}{-2 N_e} $$\n$$ s_h \\le -\\frac{\\ln(r)}{2 N_e} $$\n这就是关联 $N_e$、$s_h$ 和 $r$ 的解析条件。这也可以写成 $s_h \\le \\frac{\\ln(1/r)}{2 N_e}$。由于 $r$ 是一个满足 $0  r \\le 1$ 的分数，$\\ln(r)$ 是非正数，因此右侧是非负数，这与当 $r  1$ 时给定条件 $s_h  0$ 一致。\n\n问题的第二部分要求计算当 $N_e = 500$ 和 $r = 0.2$ 时，满足此条件的最大杂合子劣势，我们记为 $s_h^{\\ast}$。$s_h$ 的最大值出现在不等式取等号时：\n$$ s_h^{\\ast} = -\\frac{\\ln(r)}{2 N_e} $$\n代入给定值：\n$$ N_e = 500 $$\n$$ r = 0.2 $$\n我们计算 $s_h^{\\ast}$：\n$$ s_h^{\\ast} = -\\frac{\\ln(0.2)}{2 \\cdot 500} = -\\frac{\\ln(0.2)}{1000} $$\n0.2的自然对数是 $\\ln(0.2) = \\ln(\\frac{1}{5}) = -\\ln(5)$。\n$$ s_h^{\\ast} = -\\frac{-\\ln(5)}{1000} = \\frac{\\ln(5)}{1000} $$\n使用值 $\\ln(5) \\approx 1.609437912$：\n$$ s_h^{\\ast} \\approx \\frac{1.609437912}{1000} = 0.001609437912 $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$6$、$0$ 和 $9$。后一位数字是 $4$，小于 $5$，所以我们向下舍入。\n$$ s_h^{\\ast} \\approx 0.001609 $$\n这是在有效种群大小为500的情况下，杂合劣势倒位的固定概率至少是中性固定概率20%时，杂合子劣势的最大值。", "answer": "$$\\boxed{0.001609}$$", "id": "2690538"}, {"introduction": "当分化的种群重新建立联系时，物种形成的故事并不总会就此结束。如果种间杂交产生的后代适应性较低，自然选择会偏好那些能避免此类交配的性状的演化，这一过程被称为强化（reinforcement）。本练习要求您推导一种促进同型交配（assortative mating）的等位基因得以传播的精确条件，从而从定量的角度审视合子前隔离如何演化以最终完成物种形成过程 [@problem_id:2690459]。", "problem": "两个异域种群进入次级接触。它们之间的杂交后代相对于同种后代，其生存力遭受了量级为 $s \\in (0,1)$ 的成比例下降。在焦点种群中，一个稀有等位基因 $A$ 按如下方式增加了同型交配：在其携带者中，一部分比例为 $\\alpha \\in (0,1)$ 的潜在异种交配被避免，转而成为同种交配。等位基因 $A$ 的携带者每次交配需支付一个直接的乘性繁殖力代价 $c \\in (0,1)$，该代价与配偶类型无关。设 $p \\in (0,1)$ 表示随机遇到的潜在配偶是异种的概率。假设每次繁殖机会只有一次交配尝试，生存力选择前的基准繁殖力为单位1，并且同型回避将避免的异种交配转化为同种交配，除了直接代价 $c$ 外，不产生额外的生存力惩罚。\n\n使用自然选择入侵的定义（当一个性状的携带者的期望绝对适合度超过非携带者时，该性状在稀有时频率会增加），从第一性原理出发，以 $s$、$p$ 和 $\\alpha$ 的函数形式，推导出代价阈值 $c^{*}$ 的闭式解，使得增强（有利于增加同型交配的选择）加强合子前隔离当且仅当 $c  c^{*}$。将您的最终结果表示为 $c^{*}$ 的单一解析表达式，不带单位。最终答案中不要提供不等式。", "solution": "该问题要求在一个增强模型中，推导出一个促进同型交配的等位基因受到自然选择青睐的代价阈值 $c^{*}$。稀有等位基因 $A$ 的入侵条件是，其携带者的期望绝对适合度 $W_A$ 超过非携带者（等位基因 $a$ 的野生型纯合子）的期望绝对适合度 $W_a$。阈值 $c^{*}$ 是使得这两个适合度值相等的代价 $c$ 的值，即 $W_A = W_a$。\n\n首先，我们必须构建非携带者的绝对适合度 $W_a$ 的表达式。拥有野生型等位基因 $a$ 的个体随机交配。它不支付与等位基因 $A$ 相关的繁殖力代价 $c$。\n遇到同种配偶的概率是 $1-p$。产生的后代是同种的，其标准化生存力为 $1$。\n遇到异种配偶的概率是 $p$。产生的后代是杂交的，其生存力遭受了 $s$ 的成比例下降，因此其相对生存力为 $1-s$。\n由于基准繁殖力为 $1$，期望绝对适合度 $W_a$ 是这两种交配类型的适合度贡献之和，按其概率加权：\n$$W_a = (1-p) \\times 1 + p \\times (1-s)$$\n化简此表达式得：\n$$W_a = 1 - p + p - ps = 1 - ps$$\n\n接下来，我们构建稀有等位基因 $A$ 携带者的绝对适合度（表示为 $W_A$）的表达式。等位基因 $A$ 的携带者每次交配尝试都支付一个乘性繁殖力代价 $c$。因此，其整个适合度表达式将乘以一个因子 $(1-c)$。等位基因 $A$ 携带者的交配结果因同型交配偏好而改变。\n遇到同种配偶的概率是 $1-p$。这次相遇导致同种交配，产生的后代生存力为 $1$。\n遇到异种配偶的概率是 $p$。对于等位基因 $A$ 的携带者，一部分比例为 $\\alpha$ 的潜在异种交配被避免并转化为同种交配。因此，这些交配产生的后代生存力为 $1$。剩余的比例 $1-\\alpha$ 的异种相遇则按异种交配进行，产生的杂交后代生存力为 $1-s$。\n\n在考虑代价 $c$ 之前，预期的有生存能力的后代总数是所有可能相遇结果的总和：\n$$ \\text{Fecundity}_{\\text{pre-cost}} = \\underbrace{(1-p) \\times 1}_{\\text{conspecific encounter}} + \\underbrace{p \\left[ \\alpha \\times 1 + (1-\\alpha)(1-s) \\right]}_{\\text{heterospecific encounter}} $$\n让我们化简计算代价前的繁殖力表达式：\n$$ \\text{Fecundity}_{\\text{pre-cost}} = 1 - p + p\\alpha + p(1-\\alpha)(1-s) $$\n$$ = 1 - p + p\\alpha + p - ps - p\\alpha + p\\alpha s $$\n$$ = 1 - ps + p\\alpha s $$\n绝对适合度 $W_A$ 是这个计算代价前的繁殖力乘以繁殖力代价因子 $(1-c)$：\n$$ W_A = (1-c)(1 - ps + p\\alpha s) $$\n\n如果 $W_A > W_a$，则等位基因 $A$ 的频率将会增加，因此增强将会发生。定义了对该等位基因有利和不利选择之间边界的阈值条件是 $W_A = W_a$。我们令适合度表达式相等来求解阈值代价 $c^*$：\n$$ (1-c^*)(1 - ps + p\\alpha s) = 1 - ps $$\n我们可以求解 $c^*$。由于 $p, s, \\alpha \\in (0,1)$，项 $1 - ps + p\\alpha s = (1-ps) + p\\alpha s > 0$，因此可以用它相除而不会有问题。\n$$ 1 - c^* = \\frac{1 - ps}{1 - ps + p\\alpha s} $$\n现在，我们分离出 $c^*$：\n$$ c^* = 1 - \\frac{1 - ps}{1 - ps + p\\alpha s} $$\n为了合并这些项，我们进行通分：\n$$ c^* = \\frac{(1 - ps + p\\alpha s) - (1 - ps)}{1 - ps + p\\alpha s} $$\n$$ c^* = \\frac{1 - ps + p\\alpha s - 1 + ps}{1 - ps + p\\alpha s} $$\n化简分子得到代价阈值的最终表达式：\n$$ c^* = \\frac{p\\alpha s}{1 - ps + p\\alpha s} $$\n如果偏好等位基因的代价 $c$ 小于这个阈值，即 $c  c^*$，则增强会加强合子前隔离。", "answer": "$$\\boxed{\\frac{p \\alpha s}{1 - ps + p \\alpha s}}$$", "id": "2690459"}]}