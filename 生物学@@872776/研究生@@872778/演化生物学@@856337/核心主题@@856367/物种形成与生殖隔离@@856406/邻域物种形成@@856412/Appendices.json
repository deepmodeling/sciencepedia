{"hands_on_practices": [{"introduction": "为了定量研究邻域物种形成，我们首先需要一个稳健的数学模型来描述等位基因频率的转变，即基因渐渗层（cline）。本练习将使用经典的双曲正切函数模型 [@problem_id:2740352]，探讨渐渗层的基本几何属性，例如其陡峭程度或梯度。通过推导空间梯度的表达式，您将更深刻地理解渐渗层宽度参数 $w$ 如何与其最大陡峭度成反比，这是解释渐渗层数据的核心关系。", "problem": "在一个一维邻域接触区中，考虑一个由扩散和空间变化的自然选择之间的平衡所维持的等位基因频率梯度。一个被广泛使用且有经验支持的、用于描述平衡状态下等位基因频率作为位置 $x$ 的函数的近似方法是双曲正切梯度\n$$\np(x) \\;=\\; \\frac{1}{2}\\Big[1+\\tanh\\!\\Big(\\frac{2(x-c)}{w}\\Big)\\Big],\n$$\n其中 $c$ 是梯度中心（即 $p(x)=\\frac{1}{2}$ 的空间位置），而 $w0$ 是一个由扩散和选择决定的宽度参数。请仅使用微积分的基本定义以及双曲函数 $\\sinh$、$\\cosh$ 和 $\\tanh$，推导空间梯度 $\\frac{dp}{dx}$ 的精确解析表达式，并确定其在梯度中心的最大值。请根据双曲函数的性质，清楚地证明为什么最大值出现在中心位置。\n\n请以行矩阵的形式提供您的最终答案，其第一个元素为 $\\frac{dp}{dx}$ 关于 $x$、$c$ 和 $w$ 的精确表达式，第二个元素为梯度中心处最大梯度的精确值。无需进行数值四舍五入，也无需单位。您的答案必须以精确的闭合形式表达式给出。", "solution": "问题陈述在科学上是合理的，提法恰当，并包含了所有必要信息。这是将微分学应用于群体遗传学中一个著名模型的标准练习。双曲正切梯度是从更复杂的反应-扩散模型中推导出的一个正确且广泛使用的近似。因此，该问题是有效的，并将提供解答。\n\n等位基因频率作为空间位置 $x$ 的函数由下式给出：\n$$\np(x) = \\frac{1}{2}\\left[1+\\tanh\\left(\\frac{2(x-c)}{w}\\right)\\right]\n$$\n其中 $c$ 是梯度中心，$w  0$ 是宽度。\n\n目标是推导空间梯度 $\\frac{dp}{dx}$ 并确定其最大值。我们将使用链式法则进行微分。设双曲正切的参数为 $u(x) = \\frac{2(x-c)}{w}$。那么 $p(x) = \\frac{1}{2}(1 + \\tanh(u(x)))$。\n\n$p(x)$ 关于 $x$ 的导数是\n$$\n\\frac{dp}{dx} = \\frac{dp}{du} \\frac{du}{dx}\n$$\n\n首先，我们求内函数 $u(x)$ 关于 $x$ 的导数：\n$$\n\\frac{du}{dx} = \\frac{d}{dx}\\left(\\frac{2(x-c)}{w}\\right) = \\frac{d}{dx}\\left(\\frac{2x}{w} - \\frac{2c}{w}\\right) = \\frac{2}{w}\n$$\n接下来，我们求 $p$ 关于 $u$ 的导数。这需要求 $\\tanh(u)$ 的导数。根据定义，$\\tanh(u) = \\frac{\\sinh(u)}{\\cosh(u)}$。使用商法则，我们有：\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{\\frac{d}{du}(\\sinh(u))\\cosh(u) - \\sinh(u)\\frac{d}{du}(\\cosh(u))}{\\cosh^2(u)}\n$$\n使用基本定义 $\\frac{d}{du}(\\sinh(u)) = \\cosh(u)$ 和 $\\frac{d}{du}(\\cosh(u)) = \\sinh(u)$，上式变为：\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{\\cosh^2(u) - \\sinh^2(u)}{\\cosh^2(u)}\n$$\n应用基本双曲恒等式 $\\cosh^2(u) - \\sinh^2(u) = 1$，我们简化表达式：\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{1}{\\cosh^2(u)}\n$$\n现在，我们可以求出 $\\frac{dp}{du}$：\n$$\n\\frac{dp}{du} = \\frac{d}{du}\\left(\\frac{1}{2}(1 + \\tanh(u))\\right) = \\frac{1}{2}\\left(0 + \\frac{d}{du}(\\tanh(u))\\right) = \\frac{1}{2 \\cosh^2(u)}\n$$\n使用链式法则结合这些结果，得到空间梯度的表达式：\n$$\n\\frac{dp}{dx} = \\frac{dp}{du} \\frac{du}{dx} = \\left(\\frac{1}{2 \\cosh^2(u)}\\right) \\left(\\frac{2}{w}\\right) = \\frac{1}{w \\cosh^2(u)}\n$$\n将 $u(x)$ 的表达式代回，我们得到答案的第一部分，即空间梯度：\n$$\n\\frac{dp}{dx} = \\frac{1}{w \\cosh^2\\left(\\frac{2(x-c)}{w}\\right)}\n$$\n为了找到该梯度的最大值，我们分析这个表达式。参数 $w$ 是一个正常数。因此，当 $\\cosh^2\\left(\\frac{2(x-c)}{w}\\right)$ 项取最小值时，$\\frac{dp}{dx}$ 的值最大。\n\n最大值位置的证明是基于双曲余弦函数的基本性质。函数 $\\cosh(z)$ 在 $z=0$ 处有全局最小值，为 $\\cosh(0)=1$。对于任何非零实数 $z$，$\\cosh(z)  1$。因此，函数 $\\cosh^2(z)$ 也在 $z=0$ 处有其全局最小值 $1^2 = 1$。\n\n在我们的例子中，参数是 $z = \\frac{2(x-c)}{w}$。为了使分母最小化，我们必须将此参数设为零：\n$$\n\\frac{2(x-c)}{w} = 0\n$$\n因为 $w \\neq 0$，这意味着 $x-c=0$，即 $x=c$。这证明了最大梯度恰好出现在梯度中心 $x=c$ 处。\n\n为了求梯度的最大值，我们将 $x=c$ 代入 $\\frac{dp}{dx}$ 的表达式中：\n$$\n\\left(\\frac{dp}{dx}\\right)_{\\text{max}} = \\frac{1}{w \\cosh^2\\left(\\frac{2(c-c)}{w}\\right)} = \\frac{1}{w \\cosh^2(0)}\n$$\n因为 $\\cosh(0)=1$，所以最大值为：\n$$\n\\left(\\frac{dp}{dx}\\right)_{\\text{max}} = \\frac{1}{w \\cdot 1^2} = \\frac{1}{w}\n$$\n这是答案的第二部分。这两个结果分别是梯度的表达式及其最大值。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{w \\cosh^{2}\\left(\\frac{2(x-c)}{w}\\right)}  \\frac{1}{w} \\end{pmatrix}}\n$$", "id": "2740352"}, {"introduction": "理论模型为我们提供了框架，但最终目标是将其与经验数据联系起来。本练习将从渐渗层的抽象属性转向一项具体任务：如何从沿样带收集的遗传样本中估计其参数。您将通过最大似然估计（MLE）的原理 [@problem_id:2740240]——这是统计遗传学的基石——学习如何从基因型计数中推断渐渗层的中心 $c$ 和宽度 $w$，以及如何量化这些估计值的不确定性。", "problem": "在经历邻域物种形成的分化种群接触处，会形成一个一维杂交带，沿着线性样带坐标 $x \\in \\mathbb{R}$ 产生等位基因频率的空间过渡。考虑一个具有等位基因 $A$ 和 $a$ 的双等位基因座。假设在位置 $x$ 处，等位基因 $A$ 的频率由逻辑斯谛渐渗层模型描述\n$$\np(x)=\\frac{1}{1+e^{-4(x-c)/w}},\n$$\n其中 $c \\in \\mathbbR$ 是渐渗层中心，$w \\in \\mathbb{R}_{0}$ 是渐渗层宽度。在坐标为 $\\{x_i\\}_{i=1}^I$ 的 $I$ 个抽样地点，您观察到基因型计数 $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$，其总数为 $m_i=n_{AA,i}+n_{Aa,i}+n_{aa,i}$。假设在每个地点，个体都处于哈迪-温伯格平衡（HWE）状态，并且样本在个体间和地点间是独立的。以哈迪-温伯格平衡和独立性所隐含的多项式抽样模型以及最大似然（ML）的定义为基础，从基因型计数中推导出 $(c,w)$ 的对数似然形式，通过对 $p(x_i)$ 应用链式法则获得得分函数，并陈述一个有原则的计算策略来获得最大似然估计及其近似标准误。\n\n哪个选项正确地指明了以下所有与所述假设一致的元素：(i) 给定基因型计数下 $(c,w)$ 的有效对数似然，(ii) 对于 $p_i=p(x_i)$ 的导数 $\\partial p_i/\\partial c$ 和 $\\partial p_i/\\partial w$，以及 (iii) 一个适当的最大似然估计策略，包括参数约束和标准误量化？\n\nA. 联合对数似然为\n$$\n\\ell(c,w)=\\sum_{i=1}^I\\Big[2\\,n_{AA,i}\\ln p_i+n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big)+2\\,n_{aa,i}\\ln(1-p_i)\\Big],\n$$\n其中 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。导数为\n$$\n\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=-\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\n得分函数的各分量通过链式法则获得，\n$$\n\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^I\\left[\\frac{2n_{AA,i}+n_{Aa,i}}{p_i}-\\frac{2n_{aa,i}+n_{Aa,i}}{1-p_i}\\right]\\frac{\\partial p_i}{\\partial \\theta},\\quad \\theta\\in\\{c,w\\}.\n$$\n使用二阶可微优化器（如牛顿-拉弗森法或拟牛顿法），在强制 $w0$ 的条件下（例如通过重参数化 $w=e^{\\gamma}$）数值最大化 $\\ell(c,w)$。从观测信息的逆（即 $\\ell(c,w)$ 在最大值点处的Hessian矩阵的负逆矩阵）获得近似标准误。\n\nB. 似然仅基于杂合子计数，对数似然为\n$$\n\\ell(c,w)=\\sum_{i=1}^I n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big),\n$$\n且 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。导数为\n$$\n\\frac{\\partial p_i}{\\partial c}=+\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=+\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\n通过将导数设为零获得最大似然估计的闭合形式解，得到 $\\hat{c}$ 等于 $n_{Aa,i}$ 最大的那些地点的均值，$\\hat{w}$ 等于那些地点的范围。\n\nC. 将基因型合并为等位基因计数 $K_i=2n_{AA,i}+n_{Aa,i}$，并建立模型 $K_i\\sim\\mathrm{Binomial}(m_i,p_i)$，得到\n$$\n\\ell(c,w)=\\sum_{i=1}^I\\Big[K_i\\ln p_i+(m_i-K_i)\\ln(1-p_i)\\Big],\n$$\n其中 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。导数为\n$$\n\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=+\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\n对 $(c,w)$ 使用无约束的牛頓-拉弗森法，并从曲率矩阵报告标准误。\n\nD. 将观察到的等位基因频率 $y_i=\\dfrac{2n_{AA,i}+n_{Aa,i}}{2m_i}$ 视为均值为 $p_i$、方差为 $\\sigma^2/m_i$ 的高斯分布，并通过最小化\n$$\n\\sum_{i=1}^I m_i\\big(y_i-p_i\\big)^2\n$$\n来估计 $(c,w)$，其中 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。标准误遵循线性回归公式，并且不需要对 $w$ 进行约束，因为在解附近平方和是 $(c,w)$ 的凸函数。", "solution": "问题陈述提出了一个群体遗传学中的标准最大似然估计任务。在继续之前，我们必须验证其组成部分。\n\n### 问题验证\n\n**第1步：提取已知条件**\n-   位置 $x$ 处等位基因 $A$ 的频率模型是逻辑斯谛渐变群：$p(x)=\\frac{1}{1+e^{-4(x-c)/w}}$。\n-   待估计的参数是渐变群中心 $c \\in \\mathbb{R}$ 和渐变群宽度 $w \\in \\mathbb{R}_{0}$。\n-   数据是在坐标为 $\\{x_i\\}_{i=1}^I$ 的 $I$ 个抽样地点的基因型计数 $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$。\n-   地点 $i$ 的个体总数为 $m_i=n_{AA,i}+n_{Aa,i}+n_{aa,i}$。\n-   假设1：在每个地点 $i$，个体都处于哈迪-温伯格平衡（HWE）状态。\n-   假设2：样本在个体间和地点间是独立的。\n-   任务是推导出 $(c,w)$ 的对数似然、得分函数，以及获得最大似然（ML）估计及其标准误的计算策略。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据。逻辑斯谛渐变群是描述杂交带中等位基因频率转变的典型模型。在每个空间位置上假定哈迪-温伯格平衡是此类模型中标准的简化假设。基于每个地点独立多项式样本的抽样模型在统计上是常规的。问题提得很明确，要求推导似然函数及其相关的估计机制，这是统计推断中的一个教科书式问题。术语精确客观。设置自洽且一致；约束 $w0$ 具有物理意义，因为宽度不能为负。不存在违反科学原理、逻辑不一致或模糊不清之处。\n\n**第3步：结论与行动**\n问题陈述是有效的。我将继续进行推导并评估所提供的选项。\n\n### 推导与选项分析\n\n**1. 对数似然函数的推导**\n\n在每个地点 $i$ 均处于哈迪-温伯格平衡的假设下，基因型 $AA$、$Aa$ 和 $aa$ 的期望频率分别为 $p_i^2$、$2p_i(1-p_i)$ 和 $(1-p_i)^2$，其中 $p_i = p(x_i)$。对于样本量为 $m_i$ 的个体，观察到的计数 $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$ 服从多项式分布。单个地点 $i$ 的似然，作为通过 $p_i$ 体现的参数 $(c,w)$ 的函数，由多项式概率质量函数给出：\n$$ L_i(c,w) = \\frac{m_i!}{n_{AA,i}!n_{Aa,i}!n_{aa,i}!} (p_i^2)^{n_{AA,i}} (2p_i(1-p_i))^{n_{Aa,i}} ((1-p_i)^2)^{n_{aa,i}} $$\n由于各地点的样本是独立的，总似然是每个地点似然的乘积：$L(c,w) = \\prod_{i=1}^I L_i(c,w)$。对数似然 $\\ell(c,w) = \\ln L(c,w)$ 是各个对数似然之和：\n$$ \\ell(c,w) = \\sum_{i=1}^I \\ln L_i(c,w) = \\sum_{i=1}^I \\left( \\ln\\left(\\frac{m_i!}{n_{AA,i}!n_{Aa,i}!n_{aa,i}!}\\right) + n_{AA,i}\\ln(p_i^2) + n_{Aa,i}\\ln(2p_i(1-p_i)) + n_{aa,i}\\ln((1-p_i)^2) \\right) $$\n为了对 $(c,w)$ 进行最大化，我们可以舍去常数项，从而得到对数似然的核：\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( 2n_{AA,i}\\ln p_i + n_{Aa,i}\\ln(2p_i(1-p_i)) + 2n_{aa,i}\\ln(1-p_i) \\right) $$\n这个表达式是一个有效的对数似然函数。它可以被简化。利用对数的性质：\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( 2n_{AA,i}\\ln p_i + n_{Aa,i}(\\ln 2 + \\ln p_i + \\ln(1-p_i)) + 2n_{aa,i}\\ln(1-p_i) \\right) $$\n再次舍去常数项 $\\sum_i n_{Aa,i}\\ln 2$：\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( (2n_{AA,i} + n_{Aa,i})\\ln p_i + (n_{Aa,i} + 2n_{aa,i})\\ln(1-p_i) \\right) $$\n这是一组独立二项试验的对数似然，其中对于每个地点 $i$，我们在总共 $2m_i$ 个等位基因中观察到 $K_i = 2n_{AA,i} + n_{Aa,i}$ 个等位基因 $A$ 的拷贝。在哈迪-温伯格平衡下，等位基因计数是 $p_i$ 的充分统计量。\n\n**2. 得分函数分量的推导**\n\n得分函数是对数似然的梯度。对于参数 $\\theta \\in \\{c,w\\}$，我们使用链式法则：$\\frac{\\partial \\ell}{\\partial \\theta} = \\sum_{i=1}^I \\frac{\\partial \\ell}{\\partial p_i} \\frac{\\partial p_i}{\\partial \\theta}$。\n从对数似然的二项形式，第一项是：\n$$ \\frac{\\partial \\ell}{\\partial p_i} = \\frac{2n_{AA,i} + n_{Aa,i}}{p_i} - \\frac{n_{Aa,i} + 2n_{aa,i}}{1-p_i} $$\n接下来，我们需要 $p_i = p(x_i) = (1+e^{-z_i})^{-1}$ 的导数，其中 $z_i = 4(x_i-c)/w$。逻辑斯谛函数的导数是 $\\frac{dp}{dz} = p(1-p)$。\n$z_i$ 的偏导数是：\n$$ \\frac{\\partial z_i}{\\partial c} = \\frac{\\partial}{\\partial c} \\left(\\frac{4(x_i-c)}{w}\\right) = -\\frac{4}{w} $$\n$$ \\frac{\\partial z_i}{\\partial w} = \\frac{\\partial}{\\partial w} \\left(4(x_i-c)w^{-1}\\right) = -4(x_i-c)w^{-2} = -\\frac{4(x_i-c)}{w^2} $$\n对 $\\partial p_i / \\partial \\theta$ 应用链式法则：\n$$ \\frac{\\partial p_i}{\\partial c} = \\frac{dp_i}{dz_i} \\frac{\\partial z_i}{\\partial c} = p_i(1-p_i) \\left(-\\frac{4}{w}\\right) = -\\frac{4}{w} p_i(1-p_i) $$\n$$ \\frac{\\partial p_i}{\\partial w} = \\frac{dp_i}{dz_i} \\frac{\\partial z_i}{\\partial w} = p_i(1-p_i) \\left(-\\frac{4(x_i-c)}{w^2}\\right) = -\\frac{4(x_i-c)}{w^2} p_i(1-p_i) $$\n\n**3. 最大似然估计的计算策略**\n\n对数似然函数是关于参数 $(c,w)$ 的非线性函数，因此需要数值优化来找到最大似然估计值 $(\\hat{c}, \\hat{w})$。参数 $w$ 被约束为正数，$w0$。处理此类约束的标准方法是进行重参数化，例如，设置 $w = e^{\\gamma}$，并对 $(c, \\gamma) \\in \\mathbb{R}^2$ 进行无约束优化。适用于光滑函数的算法包括二阶导数方法，如牛顿-拉弗森法或拟牛頓法（例如，L-BFGS-B，它也可以直接处理对 $w$ 的箱式约束）。\n\n根据标准的最大似然理论，最大似然估计的方差-协方差矩阵可以通过费雪信息矩阵的逆来近似。该矩阵可以通过观测信息矩阵来估计，即对数似然的Hessian矩阵（二阶偏导数矩阵）在最大似然估计点处取负值：\n$$ \\mathrm{Cov}(\\hat{c}, \\hat{w}) \\approx \\left( - \\mathbf{H}_{\\ell}(\\hat{c}, \\hat{w}) \\right)^{-1} = \\begin{pmatrix} -\\frac{\\partial^2 \\ell}{\\partial c^2}  -\\frac{\\partial^2 \\ell}{\\partial c \\partial w} \\\\ -\\frac{\\partial^2 \\ell}{\\partial w \\partial c}  -\\frac{\\partial^2 \\ell}{\\partial w^2} \\end{pmatrix}_{(\\hat{c},\\hat{w})}^{-1} $$\n该逆矩阵对角线元素的平方根提供了 $\\hat{c}$ 和 $\\hat{w}$ 的近似标准误。\n\n### 选项评估\n\n**选项A:**\n-   **(i) 对数似然**: 给出的形式 $\\ell(c,w)=\\sum_{i=1}^I\\Big[2\\,n_{AA,i}\\ln p_i+n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big)+2\\,n_{aa,i}\\ln(1-p_i)\\Big]$ 是正确完整的多项式对数似然，保留了杂合子的 $\\ln 2$ 项。这是有效的。\n-   得分函数的一般形式也是正确的，它是通过对对数似然函数应用链式法则推导出来的：$\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^I\\left[\\frac{2n_{AA,i}+n_{Aa,i}}{p_i}-\\frac{2n_{aa,i}+n_{Aa,i}}{1-p_i}\\right]\\frac{\\partial p_i}{\\partial \\theta}$，这与我推导的 $\\sum_i (\\partial \\ell/\\partial p_i) (\\partial p_i/\\partial \\theta)$ 相匹配。\n-   **(ii) 导数**: 导数 $\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i)$ 和 $\\frac{\\partial p_i}{\\partial w}=-\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i)$ 如上文推导，均是正确的。\n-   **(iii) 估计策略**: 所提出的策略——使用牛顿-拉弗森法或拟牛顿法进行数值最大化，通过重参数化强制 $w0$，并使用观测信息的逆（负Hessian矩阵的逆）来计算标准误——是解决此问题的标准、正确且有原则的方法。\n\n**选项A的结论：正确。**\n\n**选项B:**\n-   **(i) 对数似然**: 此选项仅使用杂合子计数。这丢弃了纯合子计数中存在的大量信息，并且不符合应用于完整数据集的最大似然原则。这是一种不正确且低效的方法。\n-   **(ii) 导数**: 两个导数 $\\partial p_i/\\partial c$ 和 $\\partial p_i/\\partial w$ 的符号都错误地为正。\n-   **(iii) 估计策略**: 提出了一个不存在的闭合形式解和一些临时的估计量。这从根本上是错误的；该问题需要数值优化。\n\n**选项B的结论：不正确。**\n\n**选项C:**\n-   **(i) 对数似然**: 此选项正确地识别出问题可以简化为关于等位基因计数 $K_i=2n_{AA,i}+n_{Aa,i}$ 的二项似然。但是，它错误地将“失败”次数指定为 $m_i-K_i$，而正确的应为 $2m_i-K_i$，因为等位基因总数为 $2m_i$。这是似然公式中的一个关键错误。\n-   **(ii) 导数**: 导数 $\\partial p_i/\\partial w$ 的符号错误地为正。\n-   **(iii) 估计策略**: 它提出了无约束优化，这是不正确的，因为它未能强制执行必要的约束 $w0$。\n\n**选项C的结论：不正确。**\n\n**选项D:**\n-   **(i) 似然/模型**: 此选项放弃了问题陈述中指定的多项式抽样模型，转而采用加权非线性最小二乘法，假设观察到的等位基因频率呈高斯误差。这是一个不同的统计模型，是一种近似方法，不是题目所要求的。\n-   **(iii) 估计策略**: 它错误地声称不需要对 $w$ 进行约束，并且目标函数是凸函数。该问题是非凸的，并且约束 $w0$ 对参数的物理意义至关重要。声称可以从“线性回归公式”获得标准误对于非线性模型而言是明显错误的。\n\n**选项D的结论：不正确。**\n\n基于此分析，只有选项A提供了问题所要求的对数似然、必要导数以及适当的估计和推断统计程序的完整且正确的描述。", "answer": "$$\\boxed{A}$$", "id": "2740240"}, {"introduction": "观察到等位基因频率的渐渗层本身并不能明确证明是迁移-选择平衡沿环境梯度作用的结果，因为其他过程也可能产生相似的模式。本练习提出了数据解释中的一个关键挑战：如何区分真实的渐渗层与由两个不同种群简单机械混合（即瓦伦德效应）造成的伪影。通过学习将观察到的模式分解为其潜在的组成部分 [@problem_id:2740258]，您将培养出必要的批判性思维，以避免常见的陷阱，并从空间遗传数据中得出更稳健的结论。", "problem": "一个长度为 $L = 100\\,\\mathrm{km}$ 的一维栖息地中，生活着两个在接触区相遇的近缘生态型，$A$ 和 $B$。在每个生态型内部，Hardy–Weinberg 平衡（HWE）成立，并且在所关注的双等位基因座上没有生态型内部的空间趋势：等位基因 $A$ 的频率在生态型 $A$ 中恒为 $p_{A} = 0.6$，在生态型 $B$ 中恒为 $p_{B} = 0.4$。然而，在每个采样点 $x \\in [0, L]$，由于栖息地镶嵌和扩散，野外采样方案将从两个生态型中抽取的个体以空间线性变化的比例混合。具体来说，在位置 $x$ 的混合样本中，生态型 $A$ 的比例为 $w(x) = 1 - x/L$，因此生态型 $B$ 的比例为 $1 - w(x) = x/L$。假设基因型是独立抽样的，并且在 HWE 下，位点内的等位基因拷贝抽样遵循二项式抽样方案。\n\n五个采样点位于 $x \\in \\{0, 25, 50, 75, 100\\}\\,\\mathrm{km}$ 的位置。在每个位点，对 $n = 50$ 个二倍体个体进行基因分型，得到 $2n = 100$ 个等位基因拷贝。在这些位点观察到的等位基因 $A$ 的计数分别为 $\\{58, 56, 50, 45, 43\\}$。\n\n从亚群混合、Hardy–Weinberg 平衡和最小二乘回归的定义出发，并仅使用关于二项式抽样的经过充分检验的统计事实，执行以下推理步骤：\n\n- 推导在位置 $x$ 处观察到的期望等位基因频率作为 $w(x)$、$p_{A}$ 和 $p_{B}$ 的函数，并说明即使每个生态型的等位基因频率在空间上是恒定的，空间变化的混合比例如何能够引起一个渐渗层。\n\n- 使用上述计数得到的五个观察等位基因频率，通过普通最小二乘法（OLS）估计整个样带上等位基因频率相对于距离 $x$ 的斜率 $\\hat{b}$。\n\n- 使用推导出的混合诱导的期望等位基因频率表达式，在给定的 $w(x)$、$p_{A}$ 和 $p_{B}$ 条件下，计算纯粹由空间变化混合引起的期望斜率贡献（一种 Wahlund 型混合效应），称之为 $b_{\\mathrm{W}}$。\n\n- 提出一种校正方法，从观察到的斜率中移除 Wahlund 型混合贡献，以估计在没有空间变化混合的情况下仍然存在的生态型内部的渐渗层斜率 $b_{\\mathrm{corr}}$。然后根据数据和模型计算校正后的斜率 $b_{\\mathrm{corr}}$。\n\n将最终的校正斜率以每公里（$\\mathrm{km}^{-1}$）为单位表示。将最终答案四舍五入至四位有效数字。", "solution": "所提出的问题在科学上是合理的、定义明确的，并包含了唯一解所需的所有信息。它基于群体遗传学的基本原理，即 Hardy-Weinberg 平衡（HWE）和 Wahlund 效应，并结合了普通最小二乘（OLS）回归等标准统计方法。所有参数和数据都已提供且一致。因此，我们开始求解。\n\n该问题需要通过四个步骤的分析来剖析一个空间遗传格局。\n\n首先，我们推导在给定空间位置 $x$ 处的期望等位基因频率。任何位置 $x$ 处的样本都是两个生态型 $A$ 和 $B$ 的混合体。生态型 $A$ 的比例由 $w(x) = 1 - x/L$ 给出，生态型 $B$ 的比例为 $1 - w(x) = x/L$。目标等位基因（我们称之为等位基因 '$\\mathcal{A}$'）的频率在生态型 $A$ 中为 $p_A = 0.6$，在生态型 $B$ 中为 $p_B = 0.4$。混合样本中的期望等位基因频率，记为 $\\bar{p}(x)$，是贡献生态型中频率的加权平均值：\n$$\n\\bar{p}(x) = w(x) \\cdot p_A + (1 - w(x)) \\cdot p_B\n$$\n代入给定的混合比例表达式 $w(x)$：\n$$\n\\bar{p}(x) = \\left(1 - \\frac{x}{L}\\right) p_A + \\left(\\frac{x}{L}\\right) p_B\n$$\n为了说明这种混合如何引起空间渐变群，我们重新整理表达式以显示其对空间坐标 $x$ 的依赖性：\n$$\n\\bar{p}(x) = p_A - \\frac{x}{L}p_A + \\frac{x}{L}p_B = p_A + \\left(\\frac{p_B - p_A}{L}\\right)x\n$$\n这个方程是线性形式 $y = c + mx$，其中期望等位基因频率 $\\bar{p}(x)$ 是距离 $x$ 的线性函数。截距是 $p_A$，斜率是 $(p_B - p_A)/L$。根据定义，等位基因频率的空间梯度就是一个渐变群。因此，即使每个源生态型（$p_A$ 和 $p_B$）内的等位基因频率是恒定的，空间变化的混合比例 $w(x)$ 也会在观察到的等位基因频率中产生一个线性渐变群。\n\n其次，我们使用普通最小二乘（OLS）回归从提供的数据中估计观察到的等位基因频率渐变群的斜率。数据包括 $N=5$ 个采样点 $x_i$ 和相应的观察等位基因计数。我们首先将这些计数转换为等位基因频率 $\\hat{p}_i$。在每个位点采样的等位基因拷贝总数为 $2n = 2 \\times 50 = 100$。\n数据点 $(x_i, \\hat{p}_i)$ 如下：\n- 在 $x_1=0\\,\\mathrm{km}$，计数为 $58$，所以 $\\hat{p}_1 = 58/100 = 0.58$。\n- 在 $x_2=25\\,\\mathrm{km}$，计数为 $56$，所以 $\\hat{p}_2 = 56/100 = 0.56$。\n- 在 $x_3=50\\,\\mathrm{km}$，计数为 $50$，所以 $\\hat{p}_3 = 50/100 = 0.50$。\n- 在 $x_4=75\\,\\mathrm{km}$，计数为 $45$，所以 $\\hat{p}_4 = 45/100 = 0.45$。\n- 在 $x_5=100\\,\\mathrm{km}$，计数为 $43$，所以 $\\hat{p}_5 = 43/100 = 0.43$。\n\nOLS 斜率，我们记为 $\\hat{b}$，由以下公式给出：\n$$\n\\hat{b} = \\frac{\\sum_{i=1}^{N} (x_i - \\bar{x})(\\hat{p}_i - \\bar{p})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2} = \\frac{N \\sum x_i \\hat{p}_i - (\\sum x_i)(\\sum \\hat{p}_i)}{N \\sum x_i^2 - (\\sum x_i)^2}\n$$\n我们计算所需的总和：\n- $\\sum x_i = 0 + 25 + 50 + 75 + 100 = 250$\n- $\\sum \\hat{p}_i = 0.58 + 0.56 + 0.50 + 0.45 + 0.43 = 2.52$\n- $\\sum x_i^2 = 0^2 + 25^2 + 50^2 + 75^2 + 100^2 = 0 + 625 + 2500 + 5625 + 10000 = 18750$\n- $\\sum x_i \\hat{p}_i = (0)(0.58) + (25)(0.56) + (50)(0.50) + (75)(0.45) + (100)(0.43) = 0 + 14 + 25 + 33.75 + 43 = 115.75$\n\n将这些值代入 $N=5$ 的斜率公式中：\n$$\n\\hat{b} = \\frac{5 \\times 115.75 - (250)(2.52)}{5 \\times 18750 - (250)^2} = \\frac{578.75 - 630}{93750 - 62500} = \\frac{-51.25}{31250} = -0.00164\n$$\n斜率的单位是等位基因频率每公里，或 $\\mathrm{km}^{-1}$。所以，观察到的斜率为 $\\hat{b} = -0.00164\\,\\mathrm{km}^{-1}$。\n\n第三，我们计算由模型描述的纯粹由空间变化混合效应产生的期望斜率 $b_{\\mathrm{W}}$。这是对渐变群的 Wahlund 型贡献。根据我们第一步的推导，渐变群的理论斜率是 $x$ 的系数：\n$$\nb_{\\mathrm{W}} = \\frac{p_B - p_A}{L}\n$$\n使用给定的参数 $p_A = 0.6$，$p_B = 0.4$ 和 $L = 100\\,\\mathrm{km}$：\n$$\nb_{\\mathrm{W}} = \\frac{0.4 - 0.6}{100} = \\frac{-0.2}{100} = -0.002\n$$\n因此，由混合模型得到的期望斜率为 $b_{\\mathrm{W}} = -0.002\\,\\mathrm{km}^{-1}$。\n\n第四，我们提出并计算校正后的斜率 $b_{\\mathrm{corr}}$，它表示在考虑了 Wahlund 型混合效应后的残余渐变变异。总的观察斜率 $\\hat{b}$ 可以建模为混合效应引起的斜率 $b_{\\mathrm{W}}$ 和任何额外的潜在渐变群斜率 $b_{\\mathrm{corr}}$ 之和，后者可能存在于生态型内部（例如，由于选择梯度）。\n$$\n\\hat{b} = b_{\\mathrm{W}} + b_{\\mathrm{corr}}\n$$\n这种加性模型使我们能够分离出不能被简单的机械混合所解释的渐变群斜率分量。因此，校正方法是从经验观察到的斜率中减去理论上预期的由混合引起的斜率：\n$$\nb_{\\mathrm{corr}} = \\hat{b} - b_{\\mathrm{W}}\n$$\n使用我们计算出的值：\n$$\nb_{\\mathrm{corr}} = -0.00164\\,\\mathrm{km}^{-1} - (-0.002\\,\\mathrm{km}^{-1}) = -0.00164 + 0.002 = 0.00036\\,\\mathrm{km}^{-1}\n$$\n观察到的斜率（$\\hat{b} = -0.00164\\,\\mathrm{km}^{-1}$）的负值小于仅由混合模型预测的斜率（$b_{\\mathrm{W}} = -0.002\\,\\mathrm{km}^{-1}$）。这意味着存在一个与之相反的、正向的渐变趋势。校正后的斜率 $b_{\\mathrm{corr}} = 0.00036\\,\\mathrm{km}^{-1}$ 量化了这一潜在趋势。这表明，在没有混杂的混合效应的情况下，等位基因 '$\\mathcal{A}$' 的频率会随着样带上的距离 $x$ 的增加而微弱增加。\n\n最终答案必须以 $\\mathrm{km}^{-1}$ 为单位表示，并四舍五入至四位有效数字。\n$b_{\\mathrm{corr}} = 0.0003600\\,\\mathrm{km}^{-1}$，用科学记数法表示为 $3.600 \\times 10^{-4}\\,\\mathrm{km}^{-1}$。", "answer": "$$\n\\boxed{3.600 \\times 10^{-4}}\n$$", "id": "2740258"}]}