## 引言
性状如何代代相传是进化生物学的核心问题之一。可遗传的变异是自然选择得以进行的原材料，而量化这种变异的程度——即估算[遗传力](@entry_id:151095)——对于理解和预测进化轨迹至关重要。在众多方法中，[亲子回归](@entry_id:192145)（parent-offspring regression）因其直观的原理和强大的实用性，成为了[定量遗传学](@entry_id:154685)的经典基石。然而，从观察到的[亲子相似性](@entry_id:180502)中准确提炼出遗传信号，需要克服诸多生物学和统计学上的挑战，这构成了本领域的一个核心知识缺口。

本文旨在为读者提供一个关于利用[亲子回归](@entry_id:192145)估算遗传力的全面指南。我们将从第一章“原理与机制”开始，深入剖析该方法背后的遗传学和统计学基础，阐明为何亲子间的协[方差](@entry_id:200758)能反映[加性遗传方差](@entry_id:154158)，并探讨各种潜在的混淆变量。接下来，在第二章“应用与跨学科联系”中，我们将展示这一经典方法如何在[进化生态学](@entry_id:204543)、农学、医学等多个领域中被用于预测演化、设计实验和解析复杂的遗传结构。最后，在第三章“动手实践”中，你将有机会通过具体问题，将理论知识应用于实际数据分析中。通过本篇章的学习，您将掌握[亲子回归](@entry_id:192145)的核心思想，并学会如何严谨地应用它来解决实际的科学问题。

## 原理与机制

定量性状在亲代与子代之间的[表观遗传](@entry_id:186440)相似性是遗传学研究的基石。这种相似性，或者说亲属间的相关性，为我们提供了一个估算性状[遗传力](@entry_id:151095)（heritability）的窗口。本章将深入探讨利用[亲子回归](@entry_id:192145)（parent-offspring regression）方法估算[遗传力](@entry_id:151095)的基本原理和核心机制。我们将从理想化的模型出发，逐步引入现实世界中的各种生物学和统计学复杂因素，以构建一个全面而严谨的理论框架。

### 基础：亲属间的协[方差](@entry_id:200758)

理解遗传力的核心在于理解亲属间表型相似性的来源。在一个群体中，任何个体的表型值（phenotypic value, $P$）都可以被看作是其基因型值（genotypic value, $G$）和环境偏差（environmental deviation, $E$）的总和，即 $P = G + E$。

基因型值 $G$ 本身又可以被进一步分解。对于一个给定的[基因座](@entry_id:177958)，等位基因的效应可能不是简单相加的。因此，我们将 $G$ 分解为三个部分：**加性遗传值（additive genetic value, $A$）**、**显性偏差（dominance deviation, $D$）**和**[上位性](@entry_id:136574)偏差（epistatic deviation, $I$）**。加性遗传值 $A$（也称为[育种值](@entry_id:196154)，breeding value）代表了等位基因效应的线性总和，是能够直接从亲代传递给子代的部分。显性偏差 $D$ 源于同一[基因座](@entry_id:177958)上两个等位基因间的相互作用，而上位性偏差 $I$ 则源于不同[基因座](@entry_id:177958)上等位基因间的相互作用。因此，完整的表型模型是 $P = A + D + I + E$。

相应地，群体的总[表型方差](@entry_id:274482)（phenotypic variance, $V_P$）也可以被分解为各个组分的[方差](@entry_id:200758)（假设各组分不相关）：
$$V_P = V_G + V_E = V_A + V_D + V_I + V_E$$
其中，$V_A$ 是[加性遗传方差](@entry_id:154158)，$V_D$ 是[显性遗传方差](@entry_id:197376)，$V_I$ 是上位性遗传[方差](@entry_id:200758)，$V_E$ 是环境[方差](@entry_id:200758)。

基于这些[方差](@entry_id:200758)组分，我们可以定义两种[遗传力](@entry_id:151095) [@problem_id:2704568]：

1.  **[狭义遗传力](@entry_id:262760)（narrow-sense heritability, $h^2$）**：指[加性遗传方差](@entry_id:154158)占总[表型方差](@entry_id:274482)的比例。
    $$h^2 = \frac{V_A}{V_P}$$
    这个量至关重要，因为它衡量了性状中能够响应自然选择或[人工选择](@entry_id:269785)的部分，即能够稳定遗传给下一代的部分。

2.  **[广义遗传力](@entry_id:267885)（broad-sense heritability, $H^2$）**：指总遗传[方差](@entry_id:200758)占总[表型方差](@entry_id:274482)的比例。
    $$H^2 = \frac{V_G}{V_P} = \frac{V_A + V_D + V_I}{V_P}$$
    它衡量了性状在多大程度上由基因决定，包括了加性和非加性效应。

### 作为[遗传力](@entry_id:151095)估计量的[亲子回归](@entry_id:192145)

[线性回归](@entry_id:142318)的斜率 $b_{Y|X}$ 由 $X$ 和 $Y$ 的协[方差](@entry_id:200758)除以 $X$ 的[方差](@entry_id:200758)定义，即 $b_{Y|X} = \frac{\mathrm{Cov}(X,Y)}{\mathrm{Var}(X)}$。通过将子代表型 $P_O$ 对亲代表型 $P_P$ 进行回归，我们可以利用亲子间的协[方差](@entry_id:200758)来洞察遗传[方差](@entry_id:200758)。

这里的关键在于，亲子间的[遗传协方差](@entry_id:174971)主要由加性遗传值贡献。在有性生殖过程中，亲代传递给子代的是单倍体的配子（等位基因），而不是[二倍体的](@entry_id:173042)基因型。这意味着产生于特定等位基因组合的显性效应和上位性效应在[减数分裂](@entry_id:140926)过程中被打破，并不会作为一个整体传递下去。因此，在[随机交配](@entry_id:149892)的群体中，子代的显性偏差和[上位性](@entry_id:136574)偏差与亲代的相应偏差是不相关的 [@problem_id:2704541]。

形式上，亲代（parent, $P$）与子代（offspring, $O$）的表型协[方差](@entry_id:200758) $\mathrm{Cov}(P_O, P_P)$ 可以展开为：
$$\mathrm{Cov}(P_O, P_P) = \mathrm{Cov}(A_O+D_O+I_O+E_O, A_P+D_P+I_P+E_P)$$
在标准假设下（例如，亲子间没有共享环境），所有非加性遗传组分和环境组分的跨代协[方差](@entry_id:200758)均为零。协[方差](@entry_id:200758)的核心仅剩下加性遗传值之间的协[方差](@entry_id:200758) $\mathrm{Cov}(A_O, A_P)$。由于子代从该亲本处获得其一半的等位基因，其期望加性遗传值是该亲本加性遗传值的一半。因此，可以证明：
$$\mathrm{Cov}(P_O, P_P) \approx \mathrm{Cov}(A_O, A_P) = \frac{1}{2}V_A$$

基于这一核心关系，我们可以推导出两种常用的回归估计方法。

#### 单亲回归

当我们将子代表型 $P_O$ 对单个亲本（例如母亲或父亲）的表型 $P_P$ 进行回归时，回归斜率的[期望值](@entry_id:153208)为：
$$b_{O|P} = \frac{\mathrm{Cov}(P_O, P_P)}{\mathrm{Var}(P_P)} = \frac{\frac{1}{2}V_A}{V_P} = \frac{1}{2}h^2$$
因此，通过单亲回归得到的斜率是[狭义遗传力](@entry_id:262760)的一半。为了估计遗传力，我们需要将回归斜率乘以2，即 $h^2 = 2 b_{O|P}$ [@problem_id:2704568]。

#### 中亲回归

为了减少随机性并获得更稳健的估计，研究者常常使用“中亲”表型值（mid-parent phenotype, $P_{MP}$），即父母双方表型值的算术平均数：$P_{MP} = \frac{P_S + P_D}{2}$ （其中 $S$ 代表父本，sire；$D$ 代表母本，dam）。

在这种情况下，回归斜率 $b_{O|MP}$ 的分子（子代与中亲的协[方差](@entry_id:200758)）变为：
$$\mathrm{Cov}(P_O, P_{MP}) = \mathrm{Cov}\left(P_O, \frac{P_S + P_D}{2}\right) = \frac{1}{2}[\mathrm{Cov}(P_O, P_S) + \mathrm{Cov}(P_O, P_D)] = \frac{1}{2}\left(\frac{1}{2}V_A + \frac{1}{2}V_A\right) = \frac{1}{2}V_A$$
斜率的分母（中亲表型的[方差](@entry_id:200758)）在[随机交配](@entry_id:149892)（父母表型不相关）的假设下为：
$$\mathrm{Var}(P_{MP}) = \mathrm{Var}\left(\frac{P_S + P_D}{2}\right) = \frac{1}{4}[\mathrm{Var}(P_S) + \mathrm{Var}(P_D)] = \frac{1}{4}(V_P + V_P) = \frac{1}{2}V_P$$
因此，子代对中亲的回归斜率直接等于[狭义遗传力](@entry_id:262760)：
$$b_{O|MP} = \frac{\mathrm{Cov}(P_O, P_{MP})}{\mathrm{Var}(P_{MP})} = \frac{\frac{1}{2}V_A}{\frac{1}{2}V_P} = \frac{V_A}{V_P} = h^2$$
这种方法提供了一个对 $h^2$ 的直接估计，并且由于平均了双亲的表型，通常比单亲回归更精确 [@problem_id:2704568]。

举一个计算实例 [@problem_id:2704448]，假设在一个理想模型下，研究人员通过大量样本估计出子代与单亲表型的协[方差](@entry_id:200758)为 $\mathrm{Cov}(O,P) = 2.13$（单位平方），亲代群体的[表型方差](@entry_id:274482)为 $V_P = 9.70$（单位平方）。根据单亲回归的原理，$h^2 = 2 \times \frac{\mathrm{Cov}(O,P)}{V_P} = 2 \times \frac{2.13}{9.70} \approx 0.4392$。

### 预测的剖析：理解[回归残差](@entry_id:163301)

[回归模型](@entry_id:163386)将子代表型 $P_o$ 分为两部分：由亲代表型预测的部分和未能预测的**残差（residual）**。深入理解残差的构成，对于我们认识预测的局限性至关重要 [@problem_id:2704494]。

让我们首先设想一个“理想”的回归：将子代表型 $P_o$ 对其**真实的**中亲[育种值](@entry_id:196154) $\bar{A}_p = \frac{1}{2}(A_m + A_f)$ 进行回归。可以证明，这个理想回归的斜率为1。在这种情况下，预测值就是 $\bar{A}_p$。那么，理想的残差 $\delta_o$ 就是：
$$\delta_o = P_o - \bar{A}_p$$
子代的加性遗传值 $A_o$ 可以写成其父母[育种值](@entry_id:196154)的均值加上一个偏差项，这个偏差项源于减数分裂中等位基因的随机分离，称为**孟德尔分离偏差（Mendelian segregation deviation, $s_o$）**。即 $A_o = \bar{A}_p + s_o$。该偏差的[方差](@entry_id:200758)，即**分离[方差](@entry_id:200758)（segregation variance）**，等于 $\frac{1}{2}V_A$。
代入上式，我们得到理想残差的构成：
$$\delta_o = (\bar{A}_p + s_o + D_o + I_o + E_o) - \bar{A}_p = s_o + D_o + I_o + E_o$$
这个理想残差的[方差](@entry_id:200758)为 $\mathrm{Var}(\delta_o) = \frac{1}{2}V_A + V_D + V_I + V_E$。这代表了即使我们完美地知道了父母传递给后代的期望遗传贡献，后代表型仍然存在的不可预测性。这种不确定性来源于孟德尔分离的随机性、子代自身产生的非加性效应以及子代自身的环境经历。

然而，在现实中，我们无法观测到真实的[育种值](@entry_id:196154) $\bar{A}_p$。我们只能对**观测到的**中亲表型 $M$ 进行回归。$M$ 可以看作是 $\bar{A}_p$ 的一个“含噪”代理，其中的“噪声”来自于父母自身的非加性遗传偏差（$D_p, I_p$）和环境偏差（$E_p$）。在统计学上，这种在预测变量（[自变量](@entry_id:267118)）中存在的误差会导致回归的解释力下降，从而使得[普通最小二乘法](@entry_id:137121)（OLS）回归的残差[方差](@entry_id:200758)**大于**理想情况下的残差[方差](@entry_id:200758)。因此，实际回归中的残差不仅包含了孟德尔分离和子代自身的环境与非加性效应，还吸收了来自父母表型“噪声”的影响。

### 复杂因素与混淆变量

上述推导建立在一系列理想化假设之上。在真实生物系统中，这些假设往往不成立，导致遗传力估计出现偏差。理解这些混淆因素是进行严谨遗传学研究的关键。

#### 非[加性遗传方差](@entry_id:154158)

如前所述，在[随机交配](@entry_id:149892)下，[显性方差](@entry_id:184256)（$V_D$）和[上位性方差](@entry_id:263723)（$V_I$）不影响亲子协[方差](@entry_id:200758)的线性部分。然而，这并不意味着它们毫无影响。非加性效应的存在可能导致亲子关系偏离严格的线性。例如，具有极端表型的亲本可能携带了能产生巨大非加性效应的特定等位基因组合。这些组合在[减数分裂](@entry_id:140926)时会被打破，导致其子代的表型可能不会像[线性模型](@entry_id:178302)预测的那样极端。这种效应可能在亲子关系图上表现为**曲率（curvature）**，即回归的斜率随亲本表型值的变化而变化 [@problem_id:2704463]。

#### 共享环境效应

当亲代和子代共享相似的环境时（例如，共同的巢穴、食物资源或社会环境），它们的环境偏差可能会相关。我们用 $\mathrm{Cov}(E_P, E_O) = C_{PE}$ 来表示这种**亲子环境协[方差](@entry_id:200758)**。这个协[方差](@entry_id:200758)项会直接加到表型协[方差](@entry_id:200758)的分子上 [@problem_id:2704546]：
$$\mathrm{Cov}(P_O, P_P) = \frac{1}{2}V_A + C_{PE}$$
这将导致回归斜率变为：
$$\beta_{O|P} = \frac{\frac{1}{2} V_A + C_{PE}}{V_P}$$
如果研究者忽略了 $C_{PE}$ 的存在，并仍使用 $h^2 = 2\beta$ 来估计[遗传力](@entry_id:151095)，那么估计值将会产生偏差。偏差的大小为 $\frac{2C_{PE}}{V_P}$ [@problem_id:2704488]。如果共享环境使亲子更相似（$C_{PE} > 0$），[遗传力](@entry_id:151095)将被高估。反之，如果共享环境使亲子更不相似（例如，资源竞争导致 $C_{PE}  0$），遗传力将被低估。
例如，假设在一个鸟类种群中，$V_A = 2.0$，$V_E = 3.0$。在没有共享环境的情况下，单亲回归的期望斜率是 $\frac{1}{2} \frac{2.0}{2.0+3.0} = 0.2$。如果由于[亲代抚育](@entry_id:261485)，存在一个正的环境协[方差](@entry_id:200758) $C_{PE} = 0.6$，那么期望斜率会变为 $\frac{\frac{1}{2}(2.0) + 0.6}{2.0+3.0} = \frac{1.6}{5.0} = 0.32$，导致[遗传力](@entry_id:151095)被显著高估 [@problem_id:2704546]。

#### [亲本效应](@entry_id:173818)

**[亲本效应](@entry_id:173818)（parental effects）**是指亲本的表型通过影响子代发育环境而对子代表型产生的、超越等位基因直接传递的因果影响 [@problem_id:2704596]。这可以分为：
- **母体/父体遗传效应（maternal/paternal genetic effects）**：亲本的基因型影响其自身表型（如泌乳能力、护幼行为），进而影响子代表型。这是一种间接的遗传效应。
- **母体/父体环境效应（maternal/paternal environmental effects）**：亲本所处的环境或其身体状况（如营养水平）影响其对子代的投入，进而影响子代表型。

这些效应为[亲子相似性](@entry_id:180502)提供了额外的路径，从而使亲子[协方差膨胀](@entry_id:635604)，导致遗传力估计产生偏差。例如，如果存在[母体效应](@entry_id:172404)，母子协[方差](@entry_id:200758)将大于父子协[方差](@entry_id:200758)，导致母子回归斜率系统性地高于父子回归斜率。这种不对称性可以作为诊断[亲本效应](@entry_id:173818)是否存在的线索。实验上，**[交叉](@entry_id:147634)抚养（cross-fostering）**实验，即将新生子代随机分配给无关的养父母，是分离先天遗传和后天抚养效应的有力工具 [@problem_id:2704596]。

#### 测量误差

表型测量不可避免地存在误差。**测量误差（measurement error）**对[回归分析](@entry_id:165476)的影响取决于它出现在哪个变量中 [@problem_id:2704503]。
- **预测变量（亲代表型）中的误差**：假设我们观测到的亲代表型 $X$ 是真实表型 $P_P$ 加上一个独立的、均值为零的误差 $M$，即 $X = P_P + M$。这个误差会使预测变量的[方差膨胀](@entry_id:756433)：$\mathrm{Var}(X) = \mathrm{Var}(P_P) + \mathrm{Var}(M) = V_P + V_M$。然而，由于误差 $M$ 与子代表型无关，协[方差](@entry_id:200758)项保持不变：$\mathrm{Cov}(P_O, X) = \mathrm{Cov}(P_O, P_P) = \frac{1}{2}V_A$。因此，回归斜率变为：
  $$\beta = \frac{\frac{1}{2} V_{A}}{V_{P} + V_{M}}$$
  这导致斜率被**衰减（attenuation）**，即其[绝对值](@entry_id:147688)变小，从而使[遗传力](@entry_id:151095)被低估。例如，若 $V_A = 2, V_E = 6$，没有测量误差时斜率为 $\frac{1}{2} \frac{2}{8} = 0.125$。若存在[方差](@entry_id:200758)为 $V_M=4$ 的测量误差，斜率将被衰减至 $\frac{1}{2} \frac{2}{2+6+4} = \frac{1}{12} \approx 0.0833$ [@problem_id:2704503]。
- **响应变量（子代表型）中的误差**：如果[测量误差](@entry_id:270998)仅存在于子代表型中，它不会系统性地改变回归斜率的[期望值](@entry_id:153208)。这种误差会被吸收到模型的残差项中，增加残差的[方差](@entry_id:200758)，从而降低估计的精度（即增大了[标准误](@entry_id:635378)），但不会导致偏差。

#### 基因型-环境相互作用（GxE）

**基因型-环境相互作用（Genotype-by-Environment interaction, GxE）**指不同基因型在不同环境下的表型反应不同。在图形上，这意味着不同基因型的“反应[范式](@entry_id:161181)”（reaction norms）不互相平行 [@problem_id:2704456]。GxE的存在意味着性状的遗传结构是环境依赖的。我们需要用特定于环境的参数来描述遗传力，如 $h_1^2$ 和 $h_2^2$。

当存在GxE时，[亲子回归](@entry_id:192145)的斜率不仅取决于亲子是否在相同环境中，还取决于它们所处的具体环境组合。例如，在环境1中测量的亲本和在环境2中测量的子代之间的回归斜率，其[期望值](@entry_id:153208)为：
$$b_{(O \in 2) \leftarrow (P \in 1)} = \frac{\frac{1}{2} \mathrm{Cov}(A^{(1)}, A^{(2)})}{V_P^{(1)}}$$
其中 $\mathrm{Cov}(A^{(1)}, A^{(2)})$ 是同一个体在两种环境下表达的性状的加性[遗传协方差](@entry_id:174971)，它可以通过[跨环境遗传相关](@entry_id:200564)系数 $r_A$ 计算。由于分母是特定于亲本环境的[表型方差](@entry_id:274482) $V_P^{(1)}$，交换亲子所处的环境会改变分母，从而导致回归斜率不同。例如，基于一组参数，我们可能计算出 $b_{(O \in 2) \leftarrow (P \in 1)} = 0.0625$，而 $b_{(O \in 1) \leftarrow (P \in 2)} = 0.125$ [@problem_id:2704456]。这凸显了GxE如何使[遗传预测](@entry_id:143218)变得复杂。

#### 其他因素

除了上述主要因素，其他一些过程也能影响遗传力估计。例如，**[选型交配](@entry_id:270038)（assortative mating）**，即表型相似的个体更倾向于交配，会增加亲代间的[遗传相关性](@entry_id:172505)，从而抬高亲子协[方差](@entry_id:200758)和回归斜率，导致遗传力被高估。对于**[阈值性状](@entry_id:274281)（threshold traits）**，即由一个连续的潜在“易感性”（liability）变量超过某个阈值决定的0/1性状，其在观测尺度上的亲子关系通常呈S形的**[S型曲线](@entry_id:139002)（sigmoidal curve）**，而[非线性](@entry_id:637147) [@problem_id:2704463]。

总之，[亲子回归](@entry_id:192145)是估算[狭义遗传力](@entry_id:262760)的一个强大而直观的工具。然而，它的应用需要对其背后的生物学和统计学假设有深刻的理解。对各种潜在混淆因素的识别和处理，是获得可靠遗传参数和做出准确进化预测的先决条件。