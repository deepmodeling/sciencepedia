## 引言
[等位基因频率](@entry_id:146872)和[基因型频率](@entry_id:141286)是群体遗传学的基石，是量化和理解[演化过程](@entry_id:175749)的基本语言。从物种的[遗传多样性](@entry_id:201444)到适应性演化的轨迹，再到疾病易感性的[分布](@entry_id:182848)，这些频率的变化揭示了生命演化的核心动态。然而，从简单地计数等位基因到深刻理解驱动其变化的复杂力量，需要一个严谨的理论框架和强大的分析工具。本文旨在系统性地构建这一知识体系，填补基础定义与前沿研究应用之间的鸿沟。

为了实现这一目标，本文分为三个循序渐进的部分。我们将在“原理与机制”一章中，从第一性原理出发，建立等位基因和[基因型频率](@entry_id:141286)的数学基础，引入作为[零模型](@entry_id:181842)的哈迪-温伯格平衡，并系统剖析选择、[非随机交配](@entry_id:184998)等偏离该平衡的[演化机制](@entry_id:196221)。接下来，在“应用与跨学科联系”一章，我们将展示这些理论如何在现实世界中发挥作用，内容涵盖从样本数据进行统计推断，到处理现代基因组学数据的挑战，再到它们在[法医学](@entry_id:170501)、[医学遗传学](@entry_id:262833)等领域的关键应用。最后，“动手实践”部分将提供一系列精心设计的练习，旨在通过解决实际问题来巩固理论知识并培养计算技能。通过这一结构化的学习路径，读者将不仅掌握等位基因和[基因型频率](@entry_id:141286)的核心概念，更能洞悉其在整个现代生物学研究中的深刻影响和广泛应用。

## 原理与机制

本章将深入探讨群体遗传学的核心基石：等位基因频率和[基因型频率](@entry_id:141286)。我们将从第一性原理出发，建立这些概念的数学框架，并考察在理想化条件下预测[基因型频率](@entry_id:141286)的基准模型——哈迪-温伯格平衡。随后，我们将系统性地分析导致群体偏离这一理想状态的各种[进化机制](@entry_id:169522)，包括[非随机交配](@entry_id:184998)、[群体结构](@entry_id:148599)、以及自然选择。最后，我们将把视野从单个[基因座](@entry_id:177958)扩展到多个[基因座](@entry_id:177958)，以区分哈迪-温伯格平衡与连锁平衡这两个基本概念。

### 基本定义：等位基因频率与[基因型频率](@entry_id:141286)

在[群体遗传学](@entry_id:146344)中，我们的分析单元是**群体 (population)**——一个由特定物种的个体组成的集合。为了进行定量分析，我们可以将一个包含 $N$ 个二倍体个体的群体，在某个特定时间点 $t$ 的状态，想象成一个有限的集合。[群体遗传学](@entry_id:146344)的参数，如频率，本质上是基于从这个集合中进行特定抽样方案所定义的概率。

首先，我们关注个体的遗传构成。对于一个常[染色体](@entry_id:276543)上的双等位[基因座](@entry_id:177958)，假设存在等位基因 $A$ 和 $a$，那么群体中可能存在三种基因型：$AA$、$Aa$ 和 $aa$。**[基因型频率](@entry_id:141286) (genotype frequency)** 被定义为从该群体中随机均匀地抽取一个个体时，该个体属于特定基因型的概率。例如，$AA$ 基因型的频率，记为 $f_{AA}(t)$，就是群体中 $AA$ 型个体数 $N_{AA}(t)$ 与总个体数 $N$ 的比值：$f_{AA}(t) = N_{AA}(t)/N$。相应地，我们有 $f_{Aa}(t)$ 和 $f_{aa}(t)$，并且三者之和恒为 $1$。

接下来，我们将视角从个体转向基因本身。在一个包含 $N$ 个二倍体个体的群体中，每个常[染色体](@entry_id:276543)[基因座](@entry_id:177958)都存在 $2N$ 个基因拷贝。这些基因拷贝的集合构成了群体的**基因库 (gene pool)**。**[等位基因频率](@entry_id:146872) (allele frequency)** 则被定义为从该基因库中随机均匀地抽取一个基因拷贝时，该拷贝是特定等位基因的概率 [@problem_id:2690174]。以等位基因 $A$ 为例，其频率 $p_A(t)$ 是基因库中 $A$ 等位基因的总数除以基因拷贝总数 $2N$。

我们可以从[基因型频率](@entry_id:141286)出发，推导出等位基因频率。由于每个 $AA$ 个体携带两个 $A$ 等位基因，每个 $Aa$ 个体携带一个 $A$ 等位基因，因此群体中 $A$ 等位基因的总数为 $2N_{AA}(t) + N_{Aa}(t)$。于是，$A$ 的等位基因频率为：
$$
p_A(t) = \frac{2 N_{AA}(t) + N_{Aa}(t)}{2N}
$$
这个表达式可以改写为：
$$
p_A(t) = \frac{N_{AA}(t)}{N} + \frac{1}{2} \frac{N_{Aa}(t)}{N} = f_{AA}(t) + \frac{1}{2} f_{Aa}(t)
$$
这个关系式是群体遗传学中的一个基本恒等式，它精确地连接了等位基因频率和[基因型频率](@entry_id:141286)。重要的是，该关系式不依赖于任何关于[交配系统](@entry_id:151977)或进化状态的假设，它在任何二倍体群体中都成立 [@problem_id:2690174]。

在实际研究中，我们通常无法普查整个群体，而是通过分析一个大小为 $n$ 的样本来估计这些参数。假设样本中观测到的三种基因型个体数分别为 $n_{AA}$、$n_{Aa}$ 和 $n_{aa}$，样本总数为 $n=n_{AA}+n_{Aa}+n_{aa}$。依据等位基因频率的定义，我们可以通过“数等位基因”的方法计算样本等位基因频率。样本中 $A$ 等位基因的总数是 $2n_{AA} + n_{Aa}$，而样本中基因拷贝的总数是 $2n$。因此，$A$ 的样本等位基因频率 $p$ 的估计值为 [@problem_id:2690228]：
$$
p = \frac{2n_{AA} + n_{Aa}}{2n}
$$
同理，$a$ 的等位基因频率 $q$ 为 $q = \frac{2n_{aa} + n_{Aa}}{2n}$。由于该[基因座](@entry_id:177958)是双等位基因的，必然有 $p+q=1$。根据大数定律，当样本是独立、无偏地从群体中抽取时，随着样本量 $n$ 的增大，这些样本频率会收敛于真实的群体参数 $p_A(t)$ 和 $f_{AA}(t)$ [@problem_id:2690174]。

### 基准模型：哈迪-温伯格平衡

理解了频率的定义后，我们需要一个理论基准来预测在没有进化力量作用时，[基因型频率](@entry_id:141286)应有的状态。这个基准就是**哈迪-温伯格平衡 (Hardy-Weinberg Equilibrium, HWE)**。HWE描述了一个理想化群体中[等位基因频率](@entry_id:146872)和[基因型频率](@entry_id:141286)之间的稳定关系。其核心假设是**配子的随机结合 (random union of gametes)**，即形成合子的两个配子是从[基因库](@entry_id:267957)中独立随机抽取的。

这个简单的[概率模型](@entry_id:265150)引出一个深刻的预测。考虑一个拥有 $k$ 个等位基因 $\{A_1, \dots, A_k\}$ 的[基因座](@entry_id:177958)，其在[基因库](@entry_id:267957)中的频率分别为 $(p_1, \dots, p_k)$。由于配子随机且独立地结合，形成一个纯[合子](@entry_id:146894)基因型 $A_iA_i$ 的概率是两次独立抽中 $A_i$ 的概率乘积，即 $p_i \times p_i = p_i^2$。形成一个杂合子基因型 $A_iA_j$（其中 $i \neq j$）有两种方式：母本配子为 $A_i$ 且父本为 $A_j$（概率 $p_ip_j$），或者母本为 $A_j$ 且父本为 $A_i$（概率 $p_jp_i$）。因此，形成无序基因型 $A_iA_j$ 的总概率是 $2p_ip_j$ [@problem_id:2690193]。

在HWE下，[基因型频率](@entry_id:141286)完全由等位基因频率决定：
- **纯[合子](@entry_id:146894)频率**: $f_{A_iA_i} = p_i^2$
- **杂合子频率**: $f_{A_iA_j} = 2p_ip_j$ (for $i \neq j$)

这些频率被称为哈迪-温伯格比例。对于最简单的双等位基因情况（$A$ 和 $a$，频率为 $p$ 和 $q=1-p$），[基因型频率](@entry_id:141286)为：
$$
f_{AA} = p^2, \quad f_{Aa} = 2pq, \quad f_{aa} = q^2
$$
值得强调的是，这些关系并非定义，而是在特定假设（如随机交配）下的一个结论。任何偏离这些假设的因素都可能导致[基因型频率](@entry_id:141286)偏离哈迪-温伯格比例 [@problem_id:2690174]。

在HWE模型下，我们可以定义一个重要的群体[遗传多样性](@entry_id:201444)度量——**预期[杂合度](@entry_id:166208) (expected heterozygosity, $H$)**。它被定义为一个个体是杂合子的概率。我们可以通过计算所有[杂合子](@entry_id:276964)[基因型频率](@entry_id:141286)的总和来得到它，但更简洁的方法是计算其补集事件——纯合的概率。一个个体是纯合子的概率是它为 $A_1A_1$ 或 $A_2A_2$ ... 或 $A_k A_k$ 的概率之和，即 $\sum_{i=1}^{k} f_{A_iA_i} = \sum_{i=1}^{k} p_i^2$。因此，[杂合度](@entry_id:166208)为 [@problem_id:2690193] [@problem_id:2690198]：
$$
H = 1 - \sum_{i=1}^{k} p_i^2
$$
这个表达式的概率学含义是：从[基因库](@entry_id:267957)中独立、有放回地抽取两个基因拷贝，它们属于不同等位基因的概率。对于双等位[基因座](@entry_id:177958)，该公式简化为 $H = 1 - (p^2 + q^2) = 1 - (p^2 + (1-p)^2) = 2p(1-p) = 2pq$。

函数 $H(p) = 2p(1-p)$ 是一个开口向下的抛物线，它在 $p=0$ 和 $p=1$ 时取最小值为 $0$，在 $p=0.5$ 时达到最大值 $H_{max}=0.5$ [@problem_id:2690195]。这表明，当等位基因频率均等时，群体的[遗传多样性](@entry_id:201444)最高。

### 偏离哈迪-温伯格比例的机制

哈迪-温伯格平衡是一个理想化的[零模型](@entry_id:181842)。在现实世界中，许多因素会导致[基因型频率](@entry_id:141286)偏离其预测值。这些因素可以分为两类：一类主要改变[基因型频率](@entry_id:141286)而不改变等位基因频率（如[非随机交配](@entry_id:184998)），另一类则同时改变两者（如选择）。

#### [非随机交配](@entry_id:184998)

[非随机交配](@entry_id:184998)系统直接违反了HWE的核心假设。

**近亲繁殖 (Inbreeding)**：[近亲繁殖](@entry_id:263386)是指[亲缘关系](@entry_id:172505)较近的个体之间的交配概率高于随机预期的现象。这会导致后代中来自同一祖先的等位基因相遇的概率增加。这个概率用**[近交系数](@entry_id:190186) ($F$)** 来度量，它被定义为一个个体内的两个等位基因**同源 (identical by descent, IBD)** 的概率。

我们可以使用[全概率定律](@entry_id:268479)推导近交下的[基因型频率](@entry_id:141286) [@problem_id:2690232]。考虑一个个体，其两个等位基因同源的概率为 $F$，非同源的概率为 $1-F$。
- 如果两个等位基因是同源的，它们必然是相同的拷贝，因此个体不可能是杂合子 $Aa$。
- 如果两个等位基因非同源，它们可以看作是从[基因库](@entry_id:267957)中的两次独立抽取，形成 $Aa$ 杂合子的概率就是HWE下的 $2pq$。

因此，群体中[杂合子](@entry_id:276964)的总频率 $H$ 是：
$$
H = P(Aa) = P(Aa | \text{IBD}) \cdot P(\text{IBD}) + P(Aa | \text{not IBD}) \cdot P(\text{not IBD}) = 0 \cdot F + 2pq \cdot (1-F) = 2pq(1-F)
$$
与HWE预期的[杂合度](@entry_id:166208) $H_{HWE} = 2pq$ 相比，近交导致了杂合子的缺失。$F$ 本身可以被解释为[杂合度](@entry_id:166208)相对于HWE预期的比例亏损：
$$
F = \frac{H_{HWE} - H}{H_{HWE}}
$$
相应地，纯[合子](@entry_id:146894)的频率会增加。$AA$ 的频率变为 $f_{AA} = p^2 + pqF$，$aa$ 的频率变为 $f_{aa} = q^2 + pqF$。

**[选型交配](@entry_id:270038) (Assortative Mating)**：这是另一种[非随机交配](@entry_id:184998)形式，个体倾向于选择与自身表型（在此为基因型）相似或不相似的配偶。**正向[选型交配](@entry_id:270038)**，即相似个体间的交配，其效果类似于[近交](@entry_id:263386)。在一个模型中，假设群体中比例为 $\alpha$ 的交配是严格的同基因型交配（如 $AA \times AA$），而比例为 $1-\alpha$ 的交配是随机的。可以证明，经过一代交配后，杂合子的频率会从 $2p(1-p)$ 减少到 $(2-\alpha)p(1-p)$，而纯合子的频率则相应增加 [@problem_id:2690160]。与近交一样，这种[交配系统](@entry_id:151977)只改变[基因型频率](@entry_id:141286)，而不改变等位基因频率。

#### 群体结构 ([瓦伦德效应](@entry_id:151966))

当一个大群体实际上由若干个亚群体组成，且交配主要在亚群体内部随机进行时，也会出现[杂合子亏损](@entry_id:200653)现象，这被称为**[瓦伦德效应](@entry_id:151966) (Wahlund effect)**。假设有两个亚群体，它们在总群体中所占比例分别为 $w$ 和 $1-w$，等位基因 $A$ 的频率分别为 $p_1$ 和 $p_2$。在每个亚群体内部，[基因型频率](@entry_id:141286)遵循HWE，其[杂合度](@entry_id:166208)分别为 $2p_1(1-p_1)$ 和 $2p_2(1-p_2)$。

如果我们从整个混合群体中抽样，观察到的总[杂合度](@entry_id:166208)将是各亚群体[杂合度](@entry_id:166208)的加权平均：$H_{obs} = w \cdot 2p_1(1-p_1) + (1-w) \cdot 2p_2(1-p_2)$。而整个混合群体的平均等位基因频率为 $\bar{p} = wp_1 + (1-w)p_2$。根据这个平均频率计算的HWE预期[杂合度](@entry_id:166208)为 $H_{exp} = 2\bar{p}(1-\bar{p})$。

由于函数 $H(p)=2p(1-p)$ 是一个严格的[凹函数](@entry_id:274100)，根据琴生不等式，我们有 $H_{obs} \le H_{exp}$，当且仅当 $p_1=p_2$ 时等号成立 [@problem_id:2690195]。这意味着，只要亚群体间的[等位基因频率](@entry_id:146872)存在差异，混合抽样就会导致观测到的[杂合子](@entry_id:276964)数量低于基于混合等位基因频率计算的哈迪-温伯格预期值。这种“虚假”的[杂合子亏损](@entry_id:200653)是由于未识别出的群体结构造成的。

### 等位基因频率的动态学：自然选择

上述机制主要影响基因型的包装方式，而**自然选择 (natural selection)** 则是改变等位基因频率本身的核心驱动力。我们将重点讨论**生存选择 (viability selection)**，即不同基因型个体从合子存活到成年的能力不同。

我们用**[相对适应度](@entry_id:153028) (relative fitness)** ($w_{AA}$, $w_{Aa}$, $w_{aa}$) 来量化这种差异。在一个经典的群体遗传学模型中，生命周期如下：
1.  在 $t$ 代，成体[随机交配](@entry_id:149892)，产生频率为 $p$ 和 $q$ 的配子池。
2.  合子按哈迪-温伯格比例形成：$p^2$ ($AA$), $2pq$ ($Aa$), $q^2$ ($aa$)。
3.  选择发生：不同基因型的个体以其[相对适应度](@entry_id:153028)为比例存活下来。存活到成年的基因型相对比例变为 $p^2w_{AA}$, $2pqw_{Aa}$, $q^2w_{aa}$。
4.  为了使频率归一化，我们需要除以**平均适应度 ($\bar{w}$)**。$\bar{w}$ 是群体适应度的加权平均值：
    $$
    \bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa}
    $$
5.  存活下来的成年群体中，$A$ 等位基因的新频率 $p'$ 为：
    $$
    p' = \frac{p^2 w_{AA} + \frac{1}{2}(2pq w_{Aa})}{\bar{w}} = \frac{p(p w_{AA} + q w_{Aa})}{\bar{w}}
    $$
6.  这些成年个体再随机交配，产生 $t+1$ 代的[合子](@entry_id:146894)，其[基因型频率](@entry_id:141286)将是基于新频率 $p'$ 和 $q'$ 的哈迪-温伯格比例：$(p')^2$, $2p'q'$, $(q')^2$ [@problem_id:2690227]。

这个迭代过程描述了[等位基因频率](@entry_id:146872)在选择作用下的演化。一个关键问题是，这个动态系统将演化向何方？这取决于是否存在**[平衡点](@entry_id:272705) (equilibria)**，即 $\Delta p = p' - p = 0$ 的频率，以及这些[平衡点的稳定性](@entry_id:177203)。

[平衡点](@entry_id:272705)存在于 $p=0$ 和 $p=1$（[等位基因丢失](@entry_id:175439)或固定），以及可能存在的内部[平衡点](@entry_id:272705) $p^*$，其值由[适应度](@entry_id:154711)决定 [@problem_id:2690177]：
$$
p^* = \frac{w_{Aa} - w_{aa}}{(w_{Aa} - w_{aa}) + (w_{Aa} - w_{AA})}
$$
该内部[平衡点](@entry_id:272705)的存在性与稳定性取决于适应度值的相对关系：
- **[超显性](@entry_id:268017) (Overdominance)** 或[杂合子优势](@entry_id:143056)：$w_{Aa} > w_{AA}$ 且 $w_{Aa} > w_{aa}$。在这种情况下，存在一个唯一的、稳定的内部[平衡点](@entry_id:272705) $p^*$。无论初始频率如何（只要 $p \in (0,1)$），群体最终都会演化到这个[多态性](@entry_id:159475)平衡状态。这种情况也称为**受保护的多态性 (protected polymorphism)**，因为当任一等位基因稀有时，它都能因在[杂合子](@entry_id:276964)中获得[适应度](@entry_id:154711)优势而频率增加，从而避免被淘汰 [@problem_id:2690177]。
- **亚显性 (Underdominance)** 或[杂合子劣势](@entry_id:175739)：$w_{Aa}  w_{AA}$ 且 $w_{Aa}  w_{aa}$。此时，内部[平衡点](@entry_id:272705) $p^*$ 存在但是不稳定的。演化的最终结果取决于初始频率：如果 $p > p^*$，群体将演化至 $p=1$；如果 $p  p^*$，则演化至 $p=0$。$p^*$ 成为一个分水岭。
- **[定向选择](@entry_id:136267) (Directional Selection)**：$w_{AA} \ge w_{Aa} \ge w_{aa}$ 或 $w_{AA} \le w_{Aa} \le w_{aa}$。此时，没有稳定的内部[平衡点](@entry_id:272705)。选择将持续朝着固定适应度最高的纯[合子](@entry_id:146894)所对应的等位基因方向进行。适应度呈加性（$w_{Aa} = (w_{AA} + w_{aa})/2$）是[定向选择](@entry_id:136267)的一个特例。
- **无选择 (Neutrality)**: $w_{AA}=w_{Aa}=w_{aa}$。此时 $\Delta p=0$，任何频率都是中性稳定的[平衡点](@entry_id:272705) [@problem_id:2690177]。

### 扩展到多[基因座](@entry_id:177958)：连锁平衡与不平衡

到目前为止，我们的讨论都局限于单个[基因座](@entry_id:177958)。当考虑两个或多个[基因座](@entry_id:177958)时，我们需要引入新的概念来描述它们之间的关系。

考虑两个双等位[基因座](@entry_id:177958) $A/a$ 和 $B/b$。在减数分裂过程中，一个配子会同时携带这两个[基因座](@entry_id:177958)上的一个等位基因，形成一个**单倍型 (haplotype)**，如 $AB$、$Ab$、$aB$ 或 $ab$。

**连锁平衡 (Linkage Equilibrium, LE)** 是指在一个群体的配子池中，不同[基因座](@entry_id:177958)上的等位基因是统计独立的。这意味着，一个配子同时携带 $A$ 和 $B$ 的概率，等于它携带 $A$ 的概率乘以它携带 $B$ 的概率。用数学语言表达，如果 $P_A$ 和 $P_B$ 是边际等位基因频率，$P_{AB}$ 是 $AB$ 单倍型频率，则连锁平衡意味着：
$$
P_{AB} = P_A P_B
$$
所有四种单倍型频率都遵循这种乘法关系。任何偏离这种状态的情况都称为**连锁不平衡 (Linkage Disequilibrium, LD)**，其程度通常用系数 $D = P_{AB} - P_A P_B$ 来衡量 [@problem_id:2690199]。

区分HWE和LE至关重要，它们是两个逻辑上独立的概念 [@problem_id:2690199]：
- **HWE** 描述的是在**单个[基因座](@entry_id:177958)**上，等位基因频率与**二倍体基因型**频率之间的关系。它是由**配子间的随机组合**（即随机交配）造成的，并且在一个世代内即可达到。
- **LE** 描述的是在**单个单倍体配子**上，**不同[基因座](@entry_id:177958)**的等位基因之间的[统计关联](@entry_id:172897)。它是由重组、突变、选择和[遗传漂变](@entry_id:145594)等因素共同决定的。在[有性生殖](@entry_id:143318)群体中，[基因座](@entry_id:177958)间的重组会逐步瓦解[连锁不平衡](@entry_id:146203)，但这个过程可能需要许多世代。

一个群体可以在所有[基因座](@entry_id:177958)上都处于HWE，但同时在这些[基因座](@entry_id:177958)之间存在强烈的LD。例如，即使在一个经历了随机交配的群体中，其合子在每个[基因座](@entry_id:177958)上都遵循哈迪-温伯格比例，但如果形成这些[合子](@entry_id:146894)的配子库本身就处于[连锁不平衡](@entry_id:146203)状态（例如，由于近期发生了两个具有不同单倍型频率的群体混合），那么LD就会存在。反之，一个处于LE状态的配子库如果经历了[非随机交配](@entry_id:184998)（如[近交](@entry_id:263386)），其产生的后代[基因型频率](@entry_id:141286)也不会符合HWE [@problem_id:2690199]。理解这种区别是从单[基因座](@entry_id:177958)思维迈向基因组演化思维的关键一步。