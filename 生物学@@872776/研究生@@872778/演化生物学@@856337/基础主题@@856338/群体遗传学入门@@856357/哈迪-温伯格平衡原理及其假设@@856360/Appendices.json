{"hands_on_practices": [{"introduction": "在应用哈代-温伯格原理之前，我们必须首先从样本数据中稳健地估计等位基因频率。本练习将通过最大似然估计（MLE）的视角，从第一性原理出发，推导等位基因频率 $p$ 的估计量。通过证明在无约束的多项式模型和哈迪-温伯格约束模型下得到的估计量是相同的，我们为直观的“等位基因计数”法提供了坚实的统计学基础 [@problem_id:2721753]。", "problem": "对一个随机交配的二倍体群体中单个常染色体基因座进行抽样，该基因座有两个等位基因，记为 $A$ 和 $a$。从随机抽样的 $n$ 个个体中，你观察到基因型计数为 $(n_{AA}, n_{Aa}, n_{aa})$，且 $n_{AA} + n_{Aa} + n_{aa} = n$。令 $p$ 表示等位基因 $A$ 的群体频率。仅使用以下基本原理：基因型计数的多项抽样模型、作为基因型概率函数的等位基因频率定义，以及在其标准假设（随机交配、无选择、无突变、无迁移和有效无限大的群体规模）下的哈代-温伯格平衡（HWE）原则，用两种方法推导 $p$ 的最大似然估计。\n\n1) 首先，将基因型概率 $\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}$ 视为自由参数，仅受限于约束条件 $\\theta_{AA} \\ge 0$, $\\theta_{Aa} \\ge 0$, $\\theta_{aa} \\ge 0$ 和 $\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} = 1$，同时将 $p$ 定义为诱导的等位基因频率 $p = \\theta_{AA} + \\frac{1}{2}\\theta_{Aa}$。推导出最大似然估计 $\\hat{p}$ 关于 $(n_{AA}, n_{Aa}, n_{aa})$ 的闭式解。\n\n2) 其次，施加哈迪-温伯格平衡（HWE）约束，即基因型概率由等位基因频率 $p$ 通过 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}) = (p^{2}, 2p(1-p), (1-p)^{2})$ 确定，并通过最大化关于 $p$ 的多项似然来推导最大似然估计 $\\hat{p}$。\n\n从第一性原理出发，解释为什么这两个估计量是相同的。将你的最终估计量表示为关于 $(n_{AA}, n_{Aa}, n)$ 的单个精确代数表达式，其中 $n = n_{AA} + n_{Aa} + n_{aa}$。提供最终答案时，应为精确表达式，无需四舍五入或单位。", "solution": "该问题要求在基因型计数的多项抽样模型的两种不同参数化下，推导等位基因 $A$ 频率（表示为 $p$）的最大似然估计（MLE）。观测数据是从 $n$ 个二倍体个体样本中得到的基因型计数 $(n_{AA}, n_{Aa}, n_{aa})$，其中 $n = n_{AA} + n_{Aa} + n_{aa}$。\n\n此问题的基础是观察到这些基因型计数的似然函数，它遵循多项分布。设基因型的群体概率为 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa})$。似然函数 $L$ 由下式给出：\n$$ L(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa} | n_{AA}, n_{Aa}, n_{aa}) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} \\theta_{AA}^{n_{AA}} \\theta_{Aa}^{n_{Aa}} \\theta_{aa}^{n_{aa}} $$\n为了最大化，可以忽略常数组合项。使用对数似然函数 $\\ell = \\ln(L)$ 更为方便。\n$$ \\ell \\propto n_{AA}\\ln(\\theta_{AA}) + n_{Aa}\\ln(\\theta_{Aa}) + n_{aa}\\ln(\\theta_{aa}) $$\n\n**1) 使用自由基因型概率进行推导**\n\n在第一种情况下，基因型概率 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa})$ 被视为自由参数，仅受限于概率分布的标准约束条件：$\\theta_{AA} \\ge 0$, $\\theta_{Aa} \\ge 0$, $\\theta_{aa} \\ge 0$ 以及总和为一的约束 $\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} = 1$。等位基因频率 $p$ 被定义为一个诱导量：$p = \\theta_{AA} + \\frac{1}{2}\\theta_{Aa}$。\n\n为了找到 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa})$ 的最大似然估计，我们在约束条件 $\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} = 1$ 下最大化对数似然。这是拉格朗日乘数法的标准应用。拉格朗日函数 $\\mathcal{L}$ 为：\n$$ \\mathcal{L}(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}, \\lambda) = n_{AA}\\ln(\\theta_{AA}) + n_{Aa}\\ln(\\theta_{Aa}) + n_{aa}\\ln(\\theta_{aa}) - \\lambda(\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} - 1) $$\n我们对每个 $\\theta_{ij}$ 求偏导数并令其为零：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\theta_{AA}} = \\frac{n_{AA}}{\\theta_{AA}} - \\lambda = 0 \\implies \\hat{\\theta}_{AA} = \\frac{n_{AA}}{\\lambda} $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\theta_{Aa}} = \\frac{n_{Aa}}{\\theta_{Aa}} - \\lambda = 0 \\implies \\hat{\\theta}_{Aa} = \\frac{n_{Aa}}{\\lambda} $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\theta_{aa}} = \\frac{n_{aa}}{\\theta_{aa}} - \\lambda = 0 \\implies \\hat{\\theta}_{aa} = \\frac{n_{aa}}{\\lambda} $$\n为了找到拉格朗日乘数 $\\lambda$ 的值，我们使用约束条件：\n$$ \\hat{\\theta}_{AA} + \\hat{\\theta}_{Aa} + \\hat{\\theta}_{aa} = \\frac{n_{AA}}{\\lambda} + \\frac{n_{Aa}}{\\lambda} + \\frac{n_{aa}}{\\lambda} = 1 $$\n$$ \\frac{n_{AA} + n_{Aa} + n_{aa}}{\\lambda} = \\frac{n}{\\lambda} = 1 \\implies \\lambda = n $$\n将 $\\lambda = n$ 代回估计量的表达式中，得到基因型概率的最大似然估计：\n$$ \\hat{\\theta}_{AA} = \\frac{n_{AA}}{n}, \\quad \\hat{\\theta}_{Aa} = \\frac{n_{Aa}}{n}, \\quad \\hat{\\theta}_{aa} = \\frac{n_{aa}}{n} $$\n这些就是观察到的基因型样本频率。\n\n问题要求的是 $p$ 的最大似然估计。根据最大似然估计的不变性，参数函数的最大似然估计就是将该函数应用于参数的最大似然估计。因此，$p$ 的最大似然估计（表示为 $\\hat{p}$）是：\n$$ \\hat{p} = \\hat{\\theta}_{AA} + \\frac{1}{2}\\hat{\\theta}_{Aa} = \\frac{n_{AA}}{n} + \\frac{1}{2}\\frac{n_{Aa}}{n} = \\frac{2n_{AA} + n_{Aa}}{2n} $$\n\n**2) 使用哈代-温伯格平衡（HWE）约束进行推导**\n\n在第二种情况下，我们施加 HWE 约束，该约束将基因型概率建模为单个参数（等位基因频率 $p$）的函数：\n$$ (\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}) = (p^{2}, 2p(1-p), (1-p)^{2}) $$\n我们将这些代入对数似然函数，创建一个仅关于 $p$ 的函数：\n$$ \\ell(p) \\propto n_{AA}\\ln(p^{2}) + n_{Aa}\\ln(2p(1-p)) + n_{aa}\\ln((1-p)^{2}) $$\n$$ \\ell(p) = 2n_{AA}\\ln(p) + n_{Aa}(\\ln(2) + \\ln(p) + \\ln(1-p)) + 2n_{aa}\\ln(1-p) $$\n$$ \\ell(p) = (2n_{AA} + n_{Aa})\\ln(p) + (n_{Aa} + 2n_{aa})\\ln(1-p) + n_{Aa}\\ln(2) $$\n为了找到 $p$ 的最大似然估计，我们对 $\\ell(p)$ 关于 $p$ 求导并令其为零。常数项 $n_{Aa}\\ln(2)$ 在求导时消失。\n$$ \\frac{d\\ell}{dp} = \\frac{2n_{AA} + n_{Aa}}{p} - \\frac{n_{Aa} + 2n_{aa}}{1-p} = 0 $$\n求解 $p$：\n$$ \\frac{2n_{AA} + n_{Aa}}{p} = \\frac{n_{Aa} + 2n_{aa}}{1-p} $$\n$$ (2n_{AA} + n_{Aa})(1-p) = p(n_{Aa} + 2n_{aa}) $$\n$$ 2n_{AA} + n_{Aa} - p(2n_{AA} + n_{Aa}) = p(n_{Aa} + 2n_{aa}) $$\n$$ 2n_{AA} + n_{Aa} = p(2n_{AA} + n_{Aa} + n_{Aa} + 2n_{aa}) $$\n$$ 2n_{AA} + n_{Aa} = p(2n_{AA} + 2n_{Aa} + 2n_{aa}) $$\n由于 $n = n_{AA} + n_{Aa} + n_{aa}$，我们有：\n$$ 2n_{AA} + n_{Aa} = p \\cdot 2n $$\n因此，在 HWE 约束下的最大似然估计是：\n$$ \\hat{p} = \\frac{2n_{AA} + n_{Aa}}{2n} $$\n\n**等价性解释**\n\n两种推导过程得出了相同的 $p$ 的估计量。这不是巧合，而是源于 HWE 模型的特定代数结构。\n第一种推导在一般的、无约束的参数空间（三个概率的 $2$-单纯形）中寻找最大似然估计。第二种推导将最大化限制在该空间内的一个 $1$ 维弯曲子流形上，该子流形由 HWE 参数方程 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}) = (p^{2}, 2p(1-p), (1-p)^{2})$ 定义。\n\n估计量相同的根本原因在于，HWE 参数化的构造使得诱导的等位基因频率恒等于参数 $p$ 本身。也就是说，如果我们取 HWE 基因型频率并应用等位基因频率的一般定义，我们会恢复得到 $p$：\n$$ \\theta_{AA} + \\frac{1}{2}\\theta_{Aa} = p^{2} + \\frac{1}{2}(2p(1-p)) = p^{2} + p(1-p) = p^{2} + p - p^{2} = p $$\n这表明 HWE 模型中的参数 $p$ 与我们在第一部分中希望估计的量具有完全相同的定义。\n\nHWE 约束模型的得分方程（对数似然的导数设为零）是 $\\frac{d\\ell}{dp} = 0$，我们发现这导致了以下条件：\n$$ \\hat{p} = \\frac{2n_{AA} + n_{Aa}}{2n} $$\n如果我们将基因型频率的无约束最大似然估计 $\\hat{\\theta}_{ij} = n_{ij}/n$ 代入第一部分中 $\\hat{p}$ 的表达式，我们得到：\n$$ \\hat{p} = \\frac{n_{AA}}{n} + \\frac{1}{2}\\frac{n_{Aa}}{n} = \\hat{\\theta}_{AA} + \\frac{1}{2}\\hat{\\theta}_{Aa} $$\n将这些结合起来表明，HWE下的最大似然估计 $\\hat{p}$ 满足 $\\hat{p} = \\hat{\\theta}_{AA} + \\frac{1}{2}\\hat{\\theta}_{Aa}$。这意味着在 HWE 假设下的最大似然估计恰好是从观察到的样本基因型比例计算出的等位基因频率。\n\n本质上，HWE 曲线上的“最佳拟合”点是其参数 $p$ 与从更大的无约束空间中的全局最优点计算出的等位基因频率相匹配的点。这是一个特殊性质，不适用于任意的重参数化。它在这里之所以成立，是因为 HWE 模型属于指数分布族，并且等位基因频率 $p$ 是无约束模型中自然参数的线性函数，此处的自然参数对应于基因型频率。无论是在全参数空间还是在 HWE 子流形上最大化似然，都会将样本等位基因频率确定为群体等位基因频率的最优估计。数量 $2n_{AA} + n_{Aa}$ 代表样本中等位基因 $A$ 的总数，而 $2n$ 是等位基因拷贝的总数。因此，该估计量是等位基因 $A$ 的样本比例，这个结果在两种建模情景下既直观又具有数学上的稳健性。", "answer": "$$\n\\boxed{\\frac{2n_{AA} + n_{Aa}}{2n}}\n$$", "id": "2721753"}, {"introduction": "估计了等位基因频率后，下一步便是检验观察到的群体是否符合哈迪-温伯格平衡。本练习提供了一个在多等位基因座上应用皮尔逊卡方检验的实践案例 [@problem_id:2721768]。通过处理一个包含四种等位基因的具体数据集，您将逐步完成计算预期基因型频率、确定检验的自由度，并最终量化观察数据与HWE模型预测之间的偏差。", "problem": "在一个随机交配的二倍体群体中，对 $N$ 个无亲缘关系个体的单个常染色体基因座进行分型。该基因座有 $k=4$ 个等位基因，分别标记为 $A_1,A_2,A_3,A_4$。假设该群体满足经典的哈迪-温伯格假设（随机交配、无选择、无突变、无迁移和有效无限的群体大小），因此基因型频率仅由等位基因频率决定。基因型被记录为无序类别 $A_iA_j$（其中 $i \\le j$）。观测到的基因型计数如下：\n- $A_1A_1$: $135$\n- $A_2A_2$: $70$\n- $A_3A_3$: $29$\n- $A_4A_4$: $6$\n- $A_1A_2$: $180$\n- $A_1A_3$: $130$\n- $A_1A_4$: $60$\n- $A_2A_3$: $105$\n- $A_2A_4$: $53$\n- $A_3A_4$: $32$\n\n仅从哈迪-温伯格定义（即纯合子和杂合子的基因型概率是等位基因频率的函数）出发，按顺序完成以下任务：\n1. 根据哈迪-温伯格平衡（HWE）下多项分布计数的似然法，从样本中获得等位基因频率的估计值 $\\hat{p}_1,\\hat{p}_2,\\hat{p}_3,\\hat{p}_4$。\n2. 使用这些 $\\hat{p}_i$ 计算在 HWE 下每个基因型类别的期望计数。\n3. 从第一性原理出发，通过计算参数和约束条件，论证一个具有 $k$ 个等位基因的基因座在 HWE 下进行 Pearson 卡方拟合优度检验的自由度，并将其表示为 $k$ 的函数。\n4. 使用步骤 2 中得到的期望计数，为观测数据计算 Pearson 卡方统计量。\n\n报告步骤 4 中得到的卡方统计量的数值，四舍五入到四位有效数字，作为你的最终答案。不要报告 $p$ 值。最终答案必须是一个无单位的单个实数。", "solution": "该问题要求对一个具有四个等位基因的基因座的样本数据进行哈代-温伯格平衡（HWE）的卡方拟合优度检验，并按四个步骤进行。\n\n**步骤 1：估计等位基因频率**\n首先，计算总样本量 $N$：\n$N = 135+70+29+6+180+130+60+105+53+32 = 800$ 个个体。\n在HWE假设下，等位基因频率的最大似然估计可以通过基因计数法获得。对于等位基因 $A_i$，其频率估计值 $\\hat{p}_i$ 的计算公式为：\n$$ \\hat{p}_i = \\frac{2 \\times n_{ii} + \\sum_{j \\neq i} n_{ij}}{2N} $$\n- $\\hat{p}_1 = \\frac{2 \\times 135 + 180 + 130 + 60}{2 \\times 800} = \\frac{640}{1600} = 0.4$\n- $\\hat{p}_2 = \\frac{2 \\times 70 + 180 + 105 + 53}{2 \\times 800} = \\frac{478}{1600} = 0.29875$\n- $\\hat{p}_3 = \\frac{2 \\times 29 + 130 + 105 + 32}{2 \\times 800} = \\frac{325}{1600} = 0.203125$\n- $\\hat{p}_4 = \\frac{2 \\times 6 + 60 + 53 + 32}{2 \\times 800} = \\frac{157}{1600} = 0.098125$\n作为验证，我们检查频率之和：$0.4 + 0.29875 + 0.203125 + 0.098125 = 1.0$。\n\n**步骤 2：计算期望的基因型计数**\n在HWE下，纯合子 $A_iA_i$ 的期望计数为 $E_{ii} = N \\times \\hat{p}_i^2$，杂合子 $A_iA_j$ 的期望计数为 $E_{ij} = N \\times 2\\hat{p}_i\\hat{p}_j$。\n- $E_{11} = 800 \\times (0.4)^2 = 128$\n- $E_{22} = 800 \\times (0.29875)^2 \\approx 71.4025$\n- $E_{33} = 800 \\times (0.203125)^2 \\approx 33.0078$\n- $E_{44} = 800 \\times (0.098125)^2 \\approx 7.7028$\n- $E_{12} = 800 \\times 2 \\times 0.4 \\times 0.29875 = 191.2$\n- $E_{13} = 800 \\times 2 \\times 0.4 \\times 0.203125 = 130$\n- $E_{14} = 800 \\times 2 \\times 0.4 \\times 0.098125 = 62.8$\n- $E_{23} = 800 \\times 2 \\times 0.29875 \\times 0.203125 \\approx 97.03$\n- $E_{24} = 800 \\times 2 \\times 0.29875 \\times 0.098125 \\approx 46.906$\n- $E_{34} = 800 \\times 2 \\times 0.203125 \\times 0.098125 \\approx 31.894$\n\n**步骤 3：论证自由度**\n对于一个具有 $k$ 个等位基因的基因座，存在 $k$ 种纯合子和 $\\binom{k}{2} = k(k-1)/2$ 种杂合子，总共有 $\\frac{k(k+1)}{2}$ 种不同的基因型。\nPearson卡方拟合优度检验的自由度（df）通用公式为：\n$df = (\\text{类别数}) - 1 - (\\text{从数据中估计的独立参数个数})$\n- 类别数（基因型数量）为 $\\frac{k(k+1)}{2}$。\n- 我们从数据中估计了 $k$ 个等位基因频率 $\\{p_1, \\dots, p_k\\}$。由于这些频率必须满足约束条件 $\\sum p_i = 1$，因此只有 $k-1$ 个参数是独立的。\n将这些代入公式：\n$$ df = \\frac{k(k+1)}{2} - 1 - (k-1) = \\frac{k^2+k}{2} - k = \\frac{k^2+k-2k}{2} = \\frac{k^2-k}{2} = \\frac{k(k-1)}{2} $$\n对于本问题，$k=4$，因此自由度为 $df = \\frac{4(4-1)}{2} = 6$。\n\n**步骤 4：计算 Pearson 卡方统计量**\n卡方统计量 $\\chi^2$ 的计算公式为 $\\sum \\frac{(\\text{观测值} - \\text{期望值})^2}{\\text{期望值}}$。\n- $\\frac{(135 - 128)^2}{128} \\approx 0.38281$\n- $\\frac{(70 - 71.4025)^2}{71.4025} \\approx 0.02755$\n- $\\frac{(29 - 33.0078)^2}{33.0078} \\approx 0.48663$\n- $\\frac{(6 - 7.7028)^2}{7.7028} \\approx 0.37639$\n- $\\frac{(180 - 191.2)^2}{191.2} \\approx 0.65607$\n- $\\frac{(130 - 130)^2}{130} = 0$\n- $\\frac{(60 - 62.8)^2}{62.8} \\approx 0.12484$\n- $\\frac{(105 - 97.03)^2}{97.03} \\approx 0.65463$\n- $\\frac{(53 - 46.906)^2}{46.906} \\approx 0.79174$\n- $\\frac{(32 - 31.894)^2}{31.894} \\approx 0.00035$\n\n将所有项相加：\n$\\chi^2 \\approx 0.38281 + 0.02755 + 0.48663 + 0.37639 + 0.65607 + 0 + 0.12484 + 0.65463 + 0.79174 + 0.00035 = 3.49101$\n\n四舍五入到四位有效数字，最终的卡方统计量为 3.491。", "answer": "$$\\boxed{3.491}$$", "id": "2721768"}, {"introduction": "哈迪-温伯格原理最强大的功能之一是作为检测进化力量的零假设。当观察数据偏离平衡状态时，我们可以构建模型来探究其背后的原因。本练习探讨了当孟德尔遗传的基本假设之一——公平分离——被破坏时（即存在分离畸变）的情况 [@problem_id:2721761]，要求您推导这种非孟德尔过程如何影响配子库，并确定恢复平衡的条件。", "problem": "考虑一个随机交配的、雌雄异体的二倍体物种，其某个常染色体基因座上有两个等位基因 $A$ 和 $a$。设成年雄性群体中的等位基因频率为 $\\pi_m$，成年雌性群体中的等位基因频率为 $\\pi_f$。假定在每个性别内部，基因型比例相对于其性别特定的等位基因频率，均符合哈迪-温伯格平衡。在配子发生过程中，雌性减数分裂是孟德尔式的（杂合子以 $1/2$ 的概率传递等位基因 $A$），但雄性减数分裂表现出分离畸变：雄性杂合子以概率 $k$（其中 $0 \\leq k \\leq 1$）传递等位基因 $A$。纯合子以概率 $1$ 传递其等位基因。假设从减数分裂到合子形成之间没有其他因素作用，并且合子由雌雄配子随机结合形成，且雌雄双方贡献相等。\n\n任务：\n1) 推导雄性配子中 $A$ 的等位基因频率 $p_m$ 和雌性配子中 $A$ 的等位基因频率 $p_f$，将其表示为 $\\pi_m$、$\\pi_f$ 和 $k$ 的函数。\n2) 仅使用哈迪-温伯格平衡（HWE）的基本定义，写出以 $p_m$ 和 $p_f$ 表示的合子基因型频率，并确定合子处于 HWE 的条件。特别地，评估当 $p_m \\neq p_f$ 时 HWE 是否能够成立，除非可能是在配子中某个等位基因被固定的边界情况下。\n3) 求解能使合子恢复 HWE 的畸变参数值 $k^{\\star}$，用成年群体等位基因频率 $\\pi_m$ 和 $\\pi_f$ 表示，并假设 $0  \\pi_m  1$。\n\n请以 $\\pi_m$ 和 $\\pi_f$ 的闭式解析表达式形式给出 $k^{\\star}$ 的最终答案。无需进行数值计算。", "solution": "该问题经核实是科学上合理、表述清晰且客观的。这是理论群体遗传学中的一个标准练习。我们开始进行解答。\n\n该问题要求针对一个雌雄异体、具有性别特定等位基因频率且其中一个性别存在非孟德尔式分离的二倍体群体，进行一个关于哈迪-温伯格平衡（HWE）的分为三部分的推导。\n\n首先，我们解决任务1：推导雄性配子中 $A$ 的等位基因频率 $p_m$ 和雌性配子中 $A$ 的等位基因频率 $p_f$。\n\n假设成年雌性群体处于哈迪-温伯格平衡，其等位基因 $A$ 的频率为 $\\pi_f$。因此，雌性的基因型频率为：\n- $AA$ 雌性的频率：$\\pi_f^2$\n- $Aa$ 雌性的频率：$2\\pi_f(1-\\pi_f)$\n- $aa$ 雌性的频率：$(1-\\pi_f)^2$\n\n雌性减数分裂是孟德尔式的。$AA$ 个体只产生 $A$ 配子（概率为 $1$），$Aa$ 个体以概率 $\\frac{1}{2}$ 产生 $A$ 配子，$aa$ 个体不产生 $A$ 配子（概率为 $0$）。雌性配子库中等位基因 $A$ 的频率 $p_f$ 是各种基因型产生 $A$ 配子的加权平均值：\n$$p_f = (1) \\cdot (\\pi_f^2) + \\left(\\frac{1}{2}\\right) \\cdot (2\\pi_f(1-\\pi_f)) + (0) \\cdot ((1-\\pi_f)^2)$$\n$$p_f = \\pi_f^2 + \\pi_f(1-\\pi_f) = \\pi_f^2 + \\pi_f - \\pi_f^2 = \\pi_f$$\n正如孟德尔遗传所预期的，配子中的等位基因频率与亲代中的相同。\n\n成年雄性群体处于哈迪-温伯格平衡，其等位基因 $A$ 的频率为 $\\pi_m$。雄性的基因型频率为：\n- $AA$ 雄性的频率：$\\pi_m^2$\n- $Aa$ 雄性的频率：$2\\pi_m(1-\\pi_m)$\n- $aa$ 雄性的频率：$(1-\\pi_m)^2$\n\n雄性减数分裂表现出分离畸变，其中杂合（$Aa$）雄性以概率 $k$ 传递 $A$ 等位基因。纯合雄性则确定地传递其等位基因。因此，雄性配子库中等位基因 $A$ 的频率 $p_m$ 为：\n$$p_m = (1) \\cdot (\\pi_m^2) + (k) \\cdot (2\\pi_m(1-\\pi_m)) + (0) \\cdot ((1-\\pi_m)^2)$$\n$$p_m = \\pi_m^2 + 2k\\pi_m(1-\\pi_m)$$\n\n这就完成了第一个任务。对于第二个任务，我们必须找出合子处于 HWE 的条件。合子由雌雄配子随机结合形成。合子代的基因型频率为：\n- $AA$ 合子的频率：$P(AA) = p_m p_f$\n- $Aa$ 合子的频率：$P(Aa) = p_m(1-p_f) + p_f(1-p_m)$\n- $aa$ 合子的频率：$P(aa) = (1-p_m)(1-p_f)$\n\n合子群体中等位基因 $A$ 的总频率，我们称之为 $p_{zygote}$，是两个配子库频率的平均值，因为每个性别的贡献相等：\n$$p_{zygote} = \\frac{p_m + p_f}{2}$$\n为使合子群体处于 HWE，其基因型频率必须满足 $P(AA) = p_{zygote}^2$，$P(Aa) = 2 p_{zygote}(1-p_{zygote})$ 和 $P(aa) = (1-p_{zygote})^2$。我们可以使用任何一种基因型频率来检验这个条件。让我们使用 $P(AA)$：\n$$P(AA) = p_{zygote}^2$$\n$$p_m p_f = \\left(\\frac{p_m + p_f}{2}\\right)^2$$\n展开右侧：\n$$p_m p_f = \\frac{p_m^2 + 2p_m p_f + p_f^2}{4}$$\n两边乘以 $4$ 并整理各项：\n$$4p_m p_f = p_m^2 + 2p_m p_f + p_f^2$$\n$$0 = p_m^2 - 2p_m p_f + p_f^2$$\n这是一个平方差的展开式：\n$$0 = (p_m - p_f)^2$$\n这个方程成立的充要条件是 $p_m - p_f = 0$，即 $p_m = p_f$。因此，合子群体处于哈迪-温伯格平衡的基本条件是，雄性和雌性配子库中的等位基因频率必须相同。如果 $p_m \\neq p_f$（且我们不在某个等位基因被固定的边界上），那么 $(p_m - p_f)^2 > 0$，条件不满足，合子群体将不处于 HWE。\n\n最后，对于第三个任务，我们必须求解能使合子恢复 HWE 的畸变参数值 $k^{\\star}$。这需要应用在任务2中推导出的条件 $p_m = p_f$，并使用在任务1中推导出的 $p_m$ 和 $p_f$ 的表达式。\n$$p_f = \\pi_f$$\n$$p_m = \\pi_m^2 + 2k\\pi_m(1-\\pi_m)$$\n令它们相等以求解 $k^{\\star}$：\n$$\\pi_m^2 + 2k^{\\star}\\pi_m(1-\\pi_m) = \\pi_f$$\n我们现在求解 $k^{\\star}$。整理方程：\n$$2k^{\\star}\\pi_m(1-\\pi_m) = \\pi_f - \\pi_m^2$$\n鉴于假设 $0  \\pi_m  1$，项 $\\pi_m(1-\\pi_m)$ 非零，我们可以除以 $2\\pi_m(1-\\pi_m)$ 来分离出 $k^{\\star}$：\n$$k^{\\star} = \\frac{\\pi_f - \\pi_m^2}{2\\pi_m(1-\\pi_m)}$$\n这就是所求的、能使配子等位基因频率相等，从而确保所得合子群体处于哈迪-温伯格平衡的分离畸变参数 $k^{\\star}$ 的闭式表达式。", "answer": "$$\\boxed{\\frac{\\pi_f - \\pi_m^{2}}{2 \\pi_m (1 - \\pi_m)}}$$", "id": "2721761"}]}