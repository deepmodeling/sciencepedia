{"hands_on_practices": [{"introduction": "进化生物学的一个核心目标是预测可遗传性状在自然选择作用下的演化速率。育种家方程（Breeder's Equation），即 $R = h^2 S$，为此提供了最基本的定量框架，它将性状的遗传力（$h^2$）、选择强度（$S$）与世代间的进化响应（$R$）联系起来。本练习将引导你应用这一关键方程，通过分析一个模拟的田野研究数据来量化表型性状的演化，这是演化生物学家必备的核心技能之一 ([@problem_id:2705800])。", "problem": "在一项对食籽雀形目鸟类自然种群的长期野外研究中，研究人员通过测量干旱期间的生存力选择，并根据随后繁殖季节的亲子回归估算狭义遗传力，直接量化了喙深的当代进化。在一次严重干旱之前，研究人员测量了一个重点队列中所有幼鸟离巢时的喙深（单位：毫米），并对在干旱后存活下来并在次年繁殖的成年个体再次进行了测量。基于 $N_{\\text{pre}} = 412$ 只鸟的数据，选择前队列的平均喙深为 $\\mu_{\\text{pre}} = 9.75$ 毫米。在干旱后从同一队列中选出的繁殖个体中，基于 $N_{\\text{breed}} = 128$ 只鸟的数据，平均喙深为 $\\mu_{\\text{breed}} = 10.12$ 毫米。独立地，在下一代中，后代被交叉抚养以最小化共同环境效应，子代平均喙深对单个生物学亲本喙深的线性回归得出的斜率为 $b_{\\text{OP}} = 0.27$，标准误 (SE) $= 0.03$。经证实，交配相对于喙深是随机的，并且未发现可检测的母体效应。\n\n假设采用具有纯粹加性基因作用的无限小模型，遗传方差在一代内保持稳定，这两个季节之间无基因型与环境的交互作用，并且测得的选择差捕捉了决定哪些个体进行繁殖的相关选择事件。使用狭义遗传力和选择差的定义，并假设在随机交配条件下，子代对单个亲本回归的斜率与狭义遗传力之间存在通常的关系，计算下一代幼鸟队列相对于选择前队列的种群平均喙深的预期单代变化。\n\n将您的答案四舍五入到四位有效数字。以毫米 (mm) 为单位表示您的最终答案。", "solution": "在尝试进行任何解答之前，需对所提供的问题进行验证。\n\n首先，从问题陈述中逐字提取已知条件：\n- 选择前队列的平均喙深：$\\mu_{\\text{pre}} = 9.75$ 毫米\n- 选择前队列的大小：$N_{\\text{pre}} = 412$\n- 选择后繁殖个体的平均喙深：$\\mu_{\\text{breed}} = 10.12$ 毫米\n- 繁殖种群的大小：$N_{\\text{breed}} = 128$\n- 子代平均喙深对单个生物学亲本喙深的线性回归斜率：$b_{\\text{OP}} = 0.27$\n- 斜率的标准误：$\\text{SE} = 0.03$\n\n还提供了以下假设和条件：\n- 假设采用具有纯粹加性基因作用的无限小模型。\n- 遗传方差在一代内保持稳定。\n- 无基因型与环境的交互作用。\n- 测得的选择差捕捉了完整的选择事件。\n- 交配相对于喙深是随机的。\n- 无可检测的母体效应。\n- 采用交叉抚养以最小化共同环境效应。\n\n问题验证过程如下。该问题具有科学依据，描述了数量进化遗传学中的一个经典情景，与有充分记录的野外研究（例如，加拉帕戈斯群岛上的 *Geospiza fortis*）相符。这是一个适定问题，提供了所有必要的数据和清晰的理论框架（无限小模型）来计算唯一答案。语言客观、精确。该问题不违反任何无效标准；它是进化生物学中一个标准的、可形式化的问题。因此，该问题被视为有效，并将提供解答。\n\n目标是计算种群平均喙深的预期单代变化。这个量被称为选择响应，用 $R$ 表示。连接选择响应、遗传力和选择差的数量遗传学基本方程是育种家方程：\n$$R = h^2 S$$\n其中 $h^2$ 是性状的狭义遗传力，$S$ 是选择差。每个组成部分都必须根据所提供的数据来确定。\n\n首先，我们计算选择差 $S$。选择差定义为被选择的亲本的平均表型与选择前整个种群的平均表型之间的差值。\n选择前队列的平均值已知为 $\\mu_{\\text{pre}} = 9.75$ 毫米。\n在干旱中存活下来并成为繁殖种群的个体的平均值是 $\\mu_{\\text{breed}} = 10.12$ 毫米。\n因此，选择差 $S$ 为：\n$$S = \\mu_{\\text{breed}} - \\mu_{\\text{pre}}$$\n$$S = 10.12 \\, \\text{mm} - 9.75 \\, \\text{mm} = 0.37 \\, \\text{mm}$$\n\n接下来，我们确定狭义遗传力 $h^2$。狭义遗传力定义为加性遗传方差 ($V_A$) 与总表型方差 ($V_P$) 的比值：\n$$h^2 = \\frac{V_A}{V_P}$$\n问题提供了子代表型对单个亲本表型回归的斜率 $b_{\\text{OP}} = 0.27$。对于由加性基因作用决定的性状，在随机交配和亲子代之间无共同环境效应（通过交叉抚养确保）的所述条件下，单个亲本与其子代之间的理论协方差为 $\\text{Cov}(\\text{P, O}) = \\frac{1}{2} V_A$。\n子代对单个亲本的线性回归斜率定义为：\n$$b_{\\text{OP}} = \\frac{\\text{Cov}(\\text{P, O})}{V_P}$$\n代入协方差的表达式：\n$$b_{\\text{OP}} = \\frac{\\frac{1}{2} V_A}{V_P} = \\frac{1}{2} \\left( \\frac{V_A}{V_P} \\right) = \\frac{1}{2} h^2$$\n因此，狭义遗传力可以估计为单个亲子回归斜率的两倍：\n$$h^2 = 2 \\times b_{\\text{OP}}$$\n使用给定值 $b_{\\text{OP}} = 0.27$：\n$$h^2 = 2 \\times 0.27 = 0.54$$\n遗传力是一个无量纲的量。提供了斜率的标准误 $\\text{SE} = 0.03$，以表明估计的精度，但在计算 $h^2$ 的点估计值时不需要它。\n\n最后，我们可以使用育种家方程以及计算出的 $h^2$ 和 $S$ 的值来计算预期的选择响应 $R$：\n$$R = h^2 S$$\n$$R = (0.54) \\times (0.37 \\, \\text{mm})$$\n$$R = 0.1998 \\, \\text{mm}$$\n\n这个值 $R = 0.1998$ 毫米，代表了下一代幼鸟队列在经历选择之前的平均喙深相对于亲代队列选择前平均值的预期变化。问题要求将答案四舍五入到四位有效数字，而结果 $0.1998$ 已经满足此要求。", "answer": "$$\\boxed{0.1998}$$", "id": "2705800"}, {"introduction": "在理解了表型如何演化之后，我们将深入到更基础的等位基因层面。并非所有遗传变异都是适应性的；有害等位基因之所以能在群体中持续存在，往往是由于新的突变不断产生，与负向选择的力量达到了一个动态平衡。本练习模拟了一个微生物连续培养实验，旨在阐明如何为这种突变-选择平衡（mutation-selection balance）建立数学模型，并计算有害等位基因的期望平衡频率 ([@problem_id:2705754])。掌握这一概念对于理解群体的遗传负荷（genetic load）以及某些遗传病的发生频率至关重要。", "problem": "在恒化器中，对克隆、无性、单倍体的 Escherichia coli 种群在恒定环境和恒定种群大小下进行了一项微生物进化实验。有效种群大小（Ne）维持在 $10^{9}$ 以上，因此遗传漂变可以忽略不计。野生型菌株是非荧光的。报告基因座上的一个功能丧失性突变会产生一种在此环境中具有危害性的荧光表型。突变是单向的：从野生型到荧光型的正向突变以每次分裂为 $\\mu$ 的速率发生，而从荧光型到野生型的回复突变可以忽略不计。竞争实验表明，相对于适应度为 $1$ 的野生型，荧光突变体的Wrightian适应度为 $1 - s$，其中 $s \\in (0,1)$ 是针对该突变体的选择系数。\n\n直接观察方案：通过波动测试测量每次分裂的正向突变率 $\\mu$，并通过在相同恒化器条件下野生型和荧光突变体之间的成对竞争来测量选择系数 $s$。然后将种群繁殖多代，每天通过流式细胞术追踪荧光表型的频率 $q_{t}$。经过很长一段时间后，观察到的频率接近一个稳定的平台期，这与突变-选择平衡相符。\n\n从单倍体的Wrightian适应度的基本定义、选择作用作为差异性增殖后通过平均适应度进行归一化、以及从野生型类别中以速率 $\\mu$ 发生正向突变引入新突变体出发，推导在回复突变可忽略不计的情况下，突变-选择平衡下有害等位基因频率的平衡条件。然后，使用测量值 $\\mu = 3.4 \\times 10^{-7}$ 每次分裂和 $s = 3.7 \\times 10^{-3}$，计算预测的荧光突变体平衡频率，以小数形式表示。将您的答案四舍五入到四位有效数字。不要用百分比表示您的答案。", "solution": "问题陈述经验证。\n\n逐字提取已知条件：\n- *Escherichia coli*的克隆、无性、单倍体种群。\n- 恒定环境和恒定种群大小。\n- 有效种群大小 $N_e > 10^{9}$，遗传漂变可以忽略不计。\n- 野生型为非荧光，适应度为 $1$。\n- 功能丧失性突变产生荧光表型。\n- 荧光突变体是有害的，其Wrightian适应度为 $1-s$，其中 $s \\in (0,1)$ 是选择系数。\n- 突变是单向的：从野生型到荧光型的正向突变以每次分裂为 $\\mu$ 的速率发生。\n- 回复突变可以忽略不计。\n- 测得的正向突变率（每次分裂）$\\mu = 3.4 \\times 10^{-7}$。\n- 测得的选择系数 $s = 3.7 \\times 10^{-3}$。\n- 追踪荧光表型的频率 $q_t$。\n- 种群达到稳定的突变-选择平衡。\n\n验证结论：\n该问题具有科学依据，描述了群体遗传学中突变-选择平衡的经典模型，这是进化生物学的核心概念。实验背景（恒化器、*E. coli*、波动测试、竞争实验）是标准方法。提供的参数值在物理和生物学上都是现实的。问题提法得当，提供了足够的信息来推导所要求的平衡条件并计算数值结果。语言客观明确。因此，该问题是有效的。\n\n开始求解。\n\n设 $q_t$ 为第 $t$ 代有害荧光等位基因的频率，$p_t$ 为野生型等位基因的频率。根据定义，$p_t + q_t = 1$。野生型的Wrightian适应度为 $w_{WT} = 1$，荧光突变体的适应度为 $w_{M} = 1-s$。从野生型到突变体的正向突变率为 $\\mu$。回复突变可以忽略不计。\n\n我们通过考虑突变和选择的相继作用来模拟一代中等位基因频率的变化。\n\n首先，发生突变。一部分比例为 $\\mu$ 的野生型种群突变为荧光型。突变后的频率，用撇号表示，为：\n$$q' = q_t + \\mu p_t = q_t + \\mu(1-q_t)$$\n$$p' = p_t - \\mu p_t = p_t(1-\\mu) = (1-q_t)(1-\\mu)$$\n\n接下来，选择作用于这些新频率。每种类型对下一代的贡献与其频率乘以其适应度成正比。下一代中荧光等位基因的频率 $q_{t+1}$ 是选择后总人口中选择后荧光个体的比例。\n\n荧光个体的数量与 $q'(1-s)$ 成正比。野生型个体的数量与 $p'(1)$ 成正比。种群的平均适应度 $\\bar{w}$ 是这些贡献的总和，它将为下一代归一化频率。\n$$\\bar{w} = p'(1) + q'(1-s) = (1-q_t)(1-\\mu) + (q_t + \\mu(1-q_t))(1-s)$$\n那么，在第 $t+1$ 代，荧光等位基因的频率是：\n$$q_{t+1} = \\frac{q'(1-s)}{\\bar{w}} = \\frac{(q_t + \\mu(1-q_t))(1-s)}{(1-q_t)(1-\\mu) + (q_t + \\mu(1-q_t))(1-s)}$$\n这是突变等位基因频率的完整递推关系。\n\n在平衡状态下，等位基因频率是稳定的，即 $q_{t+1} = q_t$。设这个平衡频率为 $\\hat{q}$。\n$$\\hat{q} = \\frac{(\\hat{q} + \\mu(1-\\hat{q}))(1-s)}{(1-\\hat{q})(1-\\mu) + (\\hat{q} + \\mu(1-\\hat{q}))(1-s)}$$\n为求解 $\\hat{q}$，我们对这个方程进行变换。\n$$\\hat{q} \\left( (1-\\hat{q})(1-\\mu) + (\\hat{q} + \\mu(1-\\hat{q}))(1-s) \\right) = (\\hat{q} + \\mu(1-\\hat{q}))(1-s)$$\n$$\\hat{q}(1-\\hat{q})(1-\\mu) + \\hat{q}(\\hat{q} + \\mu(1-\\hat{q}))(1-s) = (\\hat{q} + \\mu(1-\\hat{q}))(1-s)$$\n$$\\hat{q}(1-\\hat{q})(1-\\mu) = (1-\\hat{q})(\\hat{q} + \\mu(1-\\hat{q}))(1-s)$$\n我们关心的是两种等位基因都存在的非平凡平衡，因此先验地 $\\hat{q} \\neq 1$。所以我们可以将方程两边同时除以 $(1-\\hat{q})$。\n$$\\hat{q}(1-\\mu) = (\\hat{q} + \\mu(1-\\hat{q}))(1-s)$$\n$$\\hat{q} - \\hat{q}\\mu = (\\hat{q} + \\mu - \\mu\\hat{q})(1-s)$$\n$$\\hat{q} - \\hat{q}\\mu = \\hat{q}(1-s) + \\mu(1-s) - \\mu\\hat{q}(1-s)$$\n$$\\hat{q} - \\hat{q}\\mu = \\hat{q} - \\hat{q}s + \\mu - \\mu s - \\mu\\hat{q} + \\mu\\hat{q}s$$\n消去两边的相同项（$\\hat{q}$ 和 $-\\hat{q}\\mu$），得到：\n$$0 = -\\hat{q}s + \\mu - \\mu s + \\mu\\hat{q}s$$\n我们重新整理以求解 $\\hat{q}$。\n$$\\hat{q}s - \\mu\\hat{q}s = \\mu - \\mu s$$\n$$\\hat{q}s(1-\\mu) = \\mu(1-s)$$\n这就给出了该模型下有害等位基因频率的精确平衡条件：\n$$\\hat{q} = \\frac{\\mu(1-s)}{s(1-\\mu)}$$\n一个常见的教科书近似是 $\\hat{q} \\approx \\mu/s$，这在 $\\mu \\ll 1$ 和 $s \\ll 1$ 时成立。我们将使用推导出的精确形式。\n\n现在，我们使用给定的数据计算数值：$\\mu = 3.4 \\times 10^{-7}$ 和 $s = 3.7 \\times 10^{-3}$。\n$$\\hat{q} = \\frac{(3.4 \\times 10^{-7})(1 - 3.7 \\times 10^{-3})}{(3.7 \\times 10^{-3})(1 - 3.4 \\times 10^{-7})}$$\n$$\\hat{q} = \\frac{(3.4 \\times 10^{-7})(0.9963)}{(3.7 \\times 10^{-3})(0.99999966)}$$\n$$\\hat{q} = \\frac{3.38742 \\times 10^{-7}}{3.699998742 \\times 10^{-3}}$$\n$$\\hat{q} \\approx 0.9155193 \\times 10^{-4}$$\n$$\\hat{q} \\approx 9.155193 \\times 10^{-5}$$\n题目要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$9.155 \\times 10^{-5} = 0.00009155$$\n这就是预测的荧光突变体的平衡频率。", "answer": "$$ \\boxed{0.00009155} $$", "id": "2705754"}, {"introduction": "现代演化生物学研究越来越依赖于从复杂和充满噪声的真实世界数据中精确推断选择等演化参数。本练习将你带到该领域的前沿，处理一个在流行病学研究中普遍存在的挑战：超级传播事件。这些事件会使后代数量的分布变得高度离散，从而导致对病原体谱系增长率的朴素估计产生偏差。你将通过实现一个基于分支过程（branching process）的统计校正模型，来学习如何量化并修正这种偏差，从而更准确地估计选择系数 ([@problem_id:2705795])。这体现了演化理论与现代数据科学的交叉融合。", "problem": "您正在研究一场发生超级传播事件的流行病中病原体谱系增长的直接观测数据。超级传播产生的后代数量呈过度离散分布，这违背了简单的泊松分布假设，并对根据谱系增长率推断选择系数造成了混淆。您必须基于一个后代数量服从负二项分布的离散时间分支过程，实现一种校正方法，以消除在从观测到的谱系时间序列估计选择系数时由过度离散引起的偏差。\n\n基本原理：\n- 对于谱系 $i$，其离散时间分支过程的每一代后代分布被建模为负二项分布，人均均值为 $R_i$，离散度为 $k$（较小的 $k$ 表示更强的超级传播）。对所有个体求和，总数转换也服从负二项分布，其均值为 $\\mu_{t+1}^i = N_t^i R_i$，方差为 $\\sigma_{t+1}^{2,i} = \\mu_{t+1}^i + (\\mu_{t+1}^i)^2/(N_t^i k)$。\n- 两个谱系 $A$ 和 $B$ 之间的选择系数定义为 $s = \\ln R_A - \\ln R_B$。\n- 在 $T$ 个离散世代内，对于 $i \\in \\{A,B\\}$，可获得观测到的数量 $\\{N_t^i\\}_{t=0}^{T}$，其中 $N_t^i \\in \\mathbb{N}$ 且 $N_t^i \\ge 1$。\n\n目标：\n- 阐明为什么在超级传播条件下，基于平均对数增长率的朴素估计量是有偏的，并实现一个从分支过程模型推导出的偏差校正估计量。\n\n需要实现的推导目标：\n- 谱系 $i$ 在 $T$ 个世代内的朴素平均对数增长率为 $g_i = \\dfrac{\\ln N_T^i - \\ln N_0^i}{T}$，从而得到 $s_{\\text{naive}} = g_A - g_B$。\n- 在负二项转换和对数函数 $\\ln$ 围绕条件均值的二阶泰勒展开下，每代对数增量的条件期望近似为\n$$\n\\mathbb{E}\\big[\\ln N_{t+1}^i - \\ln N_t^i \\mid N_t^i\\big] \\approx \\ln R_i - \\dfrac{1}{2}\\left(\\dfrac{1}{N_t^i R_i} + \\dfrac{1}{N_t^i k}\\right).\n$$\n- 对 $t \\in \\{0,\\dots,T-1\\}$ 进行平均，\n$$\n\\ln R_i \\approx g_i + \\dfrac{1}{2T}\\sum_{t=0}^{T-1}\\left(\\dfrac{1}{N_t^i R_i} + \\dfrac{1}{N_t^i k}\\right).\n$$\n- 使用该式获得 $\\ln R_i$ 的不动点更新，并对两个谱系进行迭代直至收敛，然后输出校正后的选择估计值 $s_{\\text{corr}} = \\ln R_A - \\ln R_B$。\n\n编程任务：\n- 实现一个程序，在每个测试用例中，通过不动点迭代计算 $s_{\\text{corr}}$：\n    - 初始化 $R_i^{(0)} = \\exp(g_i)$。\n    - 迭代\n    $$\n    \\ln R_i^{(m+1)} \\leftarrow g_i + \\dfrac{1}{2T}\\sum_{t=0}^{T-1}\\left(\\dfrac{1}{N_t^i R_i^{(m)}} + \\dfrac{1}{N_t^i k}\\right),\n    \\quad R_i^{(m+1)} \\leftarrow \\exp\\!\\big(\\ln R_i^{(m+1)}\\big),\n    $$\n    直到 $|\\ln R_i^{(m+1)} - \\ln R_i^{(m)}|  \\varepsilon$（其中 $\\varepsilon$ 是一个很小的容差），或达到最大迭代次数。然后返回 $s_{\\text{corr}} = \\ln R_A - \\ln R_B$。\n- 每个谱系每个测试用例使用 $\\varepsilon = 10^{-12}$ 和最多 $10000$ 次迭代。\n- 所有对数均为自然对数。\n\n测试套件：\n对于每个案例，您将获得一个元组 $(\\{N_t^A\\}_{t=0}^T, \\{N_t^B\\}_{t=0}^T, k)$。整数 $T$ 隐含为序列长度减 1。所有计数均为严格正整数。\n\n- 案例 1 (中等过度离散，中等数量):\n    - $\\{N_t^A\\} = [5, 7, 11, 16, 24, 36, 54]$\n    - $\\{N_t^B\\} = [5, 6, 8, 11, 15, 22, 32]$\n    - $k = 50.0$\n- 案例 2 (强超级传播，小数量伴有爆发):\n    - $\\{N_t^A\\} = [3, 9, 5, 25, 30, 55]$\n    - $\\{N_t^B\\} = [3, 4, 5, 7, 10, 14]$\n    - $k = 0.2$\n- 案例 3 (大数量，轻度过度离散):\n    - $\\{N_t^A\\} = [1000, 1300, 1690, 2197, 2856, 3713]$\n    - $\\{N_t^B\\} = [1000, 1200, 1440, 1728, 2074, 2488]$\n    - $k = 10.0$\n- 案例 4 (相同轨迹的健全性检查):\n    - $\\{N_t^A\\} = [10, 15, 22, 33, 49]$\n    - $\\{N_t^B\\} = [10, 15, 22, 33, 49]$\n    - $k = 0.1$\n\n要求输出：\n- 对于每个案例，返回一个单一实数 $s_{\\text{corr}}$，四舍五入到 $6$ 位小数。\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[s_1,s_2,s_3,s_4]$）。不应打印任何其他文本。", "solution": "该问题提出了一个在演化动力学领域中有效且适定的任务。它在科学上基于分支过程理论，这是一个用于建模种群增长的标准框架。使用负二项后代分布是解释繁殖成功中过度离散现象的一种恰当且常用的方法，这种现象在流行病中经常观察到，并被称为超级传播。选择系数的偏差校正估计量的推导是基于对数函数的标准二阶泰勒展开，这是一种有效的数学近似技术。所有参数、数据和算法步骤都已明确定义，使得问题清晰无歧义且可解。因此，我将着手解决该问题。\n\n问题的核心在于理解当后代数量呈过度离散分布时，病原体谱系增长率的朴素估计量所存在的偏差。一个简单的增长度量是在 $T$ 个世代内的平均对数增长率，对于谱系 $i$ 定义为：\n$$\ng_i = \\dfrac{\\ln N_T^i - \\ln N_0^i}{T}\n$$\n其中 $N_t^i$ 是谱系 $i$ 在第 $t$ 代的个体数量。选择系数 $s = \\ln R_A - \\ln R_B$ 的朴素估计量就是 $s_{\\text{naive}} = g_A - g_B$，其中 $R_i$ 是谱系 $i$ 的真实人均平均繁殖数。\n\n如果每个个体的后代数量遵循泊松分布，那么这个估计量是无偏的。然而，在存在超级传播的情况下，负二项分布更为合适。负二项分布的方差大于其均值。下一代后代总数 $N_{t+1}^i$ 在当前种群规模 $N_t^i$ 条件下的方差为：\n$$\n\\sigma_{t+1}^{2,i} = \\text{Var}(N_{t+1}^i | N_t^i) = \\mu_{t+1}^i + \\dfrac{(\\mu_{t+1}^i)^2}{N_t^i k} = N_t^i R_i + \\dfrac{(N_t^i R_i)^2}{N_t^i k} = N_t^i R_i \\left( 1 + \\dfrac{R_i}{k} \\right)\n$$\n其中 $\\mu_{t+1}^i = \\mathbb{E}[N_{t+1}^i | N_t^i] = N_t^i R_i$，$k$ 是离散参数。较小的 $k$ 表示高度的过度离散（大方差）。\n\n对数增长率估计量的偏差源于凹函数对数函数的琴生不等式，即 $\\mathbb{E}[\\ln X] \\le \\ln \\mathbb{E}[X]$。通过对 $\\ln(N_{t+1}^i)$ 在条件均值 $\\mu_{t+1}^i$ 附近进行二阶泰勒展开，可以得到一个更精确的关系：\n$$\n\\mathbb{E}[\\ln N_{t+1}^i | N_t^i] \\approx \\ln(\\mu_{t+1}^i) - \\dfrac{\\text{Var}(N_{t+1}^i | N_t^i)}{2(\\mu_{t+1}^i)^2}\n$$\n代入均值和方差的表达式，并考虑对数尺度的变化，我们得到：\n$$\n\\mathbb{E}[\\ln N_{t+1}^i - \\ln N_t^i | N_t^i] = \\mathbb{E}[\\ln N_{t+1}^i | N_t^i] - \\ln N_t^i \\approx \\ln(N_t^i R_i) - \\ln N_t^i - \\dfrac{N_t^i R_i(1 + R_i/k)}{2(N_t^i R_i)^2}\n$$\n这可以简化为问题描述中给出的表达式：\n$$\n\\mathbb{E}[\\ln N_{t+1}^i - \\ln N_t^i | N_t^i] \\approx \\ln R_i - \\dfrac{1}{2}\\left(\\dfrac{1}{N_t^i R_i} + \\dfrac{1}{N_t^i k}\\right)\n$$\n第二项代表一个负偏差；观测到的对数增长增量平均而言小于真实的对数繁殖数 $\\ln R_i$。对于较小的种群规模 $N_t^i$、较低的繁殖数 $R_i$ 和较小的离散参数 $k$，此偏差更大。\n\n为了校正此偏差，我们对 $T$ 个世代进行平均。我们用观测到的平均对数增长率 $g_i = \\frac{1}{T}\\sum_{t=0}^{T-1}(\\ln N_{t+1}^i - \\ln N_t^i)$ 来近似条件期望的平均值：\n$$\ng_i \\approx \\ln R_i - \\dfrac{1}{2T}\\sum_{t=0}^{T-1}\\left(\\dfrac{1}{N_t^i R_i} + \\dfrac{1}{N_t^i k}\\right)\n$$\n重新整理此方程以求解 $\\ln R_i$，便得到了我们校正方法的基础：\n$$\n\\ln R_i \\approx g_i + \\dfrac{1}{2T}\\sum_{t=0}^{T-1}\\left(\\dfrac{1}{N_t^i R_i} + \\dfrac{1}{N_t^i k}\\right)\n$$\n这是一个关于 $R_i$ 的隐式方程，因为 $R_i$ 出现在方程的两边。它必须通过数值方法求解。问题指定了一个不动点迭代方案。我们从一个朴素估计 $R_i^{(0)} = \\exp(g_i)$ 开始，并使用以下更新规则迭代地对其进行优化：\n$$\n\\ln R_i^{(m+1)} \\leftarrow g_i + \\dfrac{1}{2T}\\sum_{t=0}^{T-1}\\left(\\dfrac{1}{N_t^i R_i^{(m)}} + \\dfrac{1}{N_t^i k}\\right)\n$$\n然后我们更新 $R_i^{(m+1)} = \\exp(\\ln R_i^{(m+1)})$ 并重复此过程，直到连续迭代中 $\\ln R_i$ 的变化量 $|\\ln R_i^{(m+1)} - \\ln R_i^{(m)}|$ 小于指定的容差 $\\varepsilon = 10^{-12}$。\n\n实现将对每个谱系 $A$ 和 $B$ 遵循此过程，以找到它们校正后的对数繁殖数 $\\ln R_A$ 和 $\\ln R_B$。最终的校正选择系数则计算为 $s_{\\text{corr}} = \\ln R_A - \\ln R_B$。\n\n算法如下：\n1. 对于每个测试用例，它由计数序列 $\\{N_t^A\\}$、$\\{N_t^B\\}$ 和离散度 $k$ 组成，我们独立处理每个谱系。\n2. 对于给定的谱系 $i$，我们定义一个函数，该函数：\n    a. 计算世代数 $T$ 和朴素对数增长率 $g_i$。\n    b. 初始化繁殖数 $R_i^{(0)} = \\exp(g_i)$。\n    c. 为提高效率，预先计算总和 $\\sum_{t=0}^{T-1} (1/N_t^i)$。\n    d. 迭代应用 $\\ln R_i$ 的更新规则直至收敛，同时遵守最大迭代次数限制。\n    e. 返回收敛后的 $\\ln R_i$ 值。\n3. 我们对谱系 $A$ 和谱系 $B$ 都调用此函数。\n4. 校正后的选择系数计算为返回值的差。\n5. 对所有测试用例重复此过程，并按指定格式化结果。", "answer": "[0.068374,0.276825,0.080041,0.000000]", "id": "2705795"}]}