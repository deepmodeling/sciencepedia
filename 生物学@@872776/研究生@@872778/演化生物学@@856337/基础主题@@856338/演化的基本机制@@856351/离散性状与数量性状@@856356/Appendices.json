{"hands_on_practices": [{"introduction": "育种家方程是定量遗传学的基石，它精确地描述了选择与遗传力如何共同作用以预测下一代的表型变化。这个练习将带你从第一性原理出发，推导出这个至关重要的方程 $R = h^2 S$ [@problem_id:2701484]，从而深刻理解定量性状演化的核心机制。", "problem": "一个大的、随机交配的二倍体群体表现出单一的数量性状。设每个个体的表型值用 $P$ 表示，它可以分解为 $P = A + E$，其中 $A$ 是加性遗传值（育种值），$E$ 是残差非遗传组分，满足 $E[A] = 0$，$E[E] = 0$，$\\operatorname{Var}(A) = V_{A}$，$\\operatorname{Var}(E) = V_{E}$，并且在基础群体中 $A$ 和 $E$ 相互独立。表型方差为 $V_{P} = V_{A} + V_{E}$。仅通过表型选择来挑选一个亲本群，产生选择差 $S = \\bar{P}_{\\text{sel}} - \\bar{P}$，其中 $\\bar{P}$ 是选择前的表型均值，$\\bar{P}_{\\text{sel}}$ 是被选中的亲本的表型均值。被选中的亲本随机交配，子代在与基础群体环境分布相同的环境中发育。\n\n仅使用上述定义和概率论的基本结果（期望的线性性、协方差恒等式 $\\operatorname{Cov}(X,Y) = E[XY] - E[X]E[Y]$ 和全期望定律），从第一性原理推导表型均值预期单代变化的闭式表达式，\n$$\nR \\equiv \\bar{P}' - \\bar{P},\n$$\n其中 $\\bar{P}'$ 是子代的表型均值。您的推导除了关于 $P$ 的可测性外，不得假定任何特定的选择规则形式（例如，不要假定截尾选择），并且必须阐明是哪些方差分量决定了从 $P$ 预测 $A$ 的最佳线性预测器的斜率。仅用 $S$、$V_{A}$ 和 $V_{P}$ 表示您的最终答案，然后用由 $h^2 = V_A/V_P$ 定义的狭义遗传力 $h^2$ 重写它。\n\n最后，陈述该单代预测为无偏的最小生物学和统计学假设，并简要解释为什么对于纯粹的离散性状，除非存在具有相同结构的未观察到的数量易患性，否则类似的推理会失败。最终报告的答案必须是仅用 $h^2$ 和 $S$ 表示的 $R$ 的单个闭式表达式（无单位）。不需要进行数值计算，也不需要四舍五入。", "solution": "该问题要求从第一性原理推导单代选择响应 $R$。分析过程首先将响应 $R$ 与被选亲本的平均育种值联系起来，其次，通过回归论证将被选亲本的平均育种值与平均表型联系起来。\n\n设 $\\bar{P}$ 和 $\\bar{A}$ 分别表示选择前基础群体中的平均表型和平均加性遗传值（育种值）。设 $\\bar{P}'$ 和 $\\bar{A}'$ 是子代中相应的均值。选择响应定义为 $R \\equiv \\bar{P}' - \\bar{P}$。\n\n子代的表型为 $P_{o} = A_{o} + E_{o}$。子代的平均表型是其期望值，$\\bar{P}' = E[P_{o}] = E[A_{o} + E_{o}]$。根据期望的线性性，$\\bar{P}' = E[A_{o}] + E[E_{o}]$。问题陈述子代环境的分布与基础群体相同，这意味着平均环境效应不变：$E[E_{o}] = E[E]$。基础群体中的平均表型为 $\\bar{P} = E[P] = E[A+E] = E[A] + E[E] = \\bar{A} + E[E]$。\n\n因此，选择响应为：\n$$\nR = \\bar{P}' - \\bar{P} = (E[A_{o}] + E[E_{o}]) - (\\bar{A} + E[E]) = E[A_{o}] - \\bar{A}\n$$\n这表明平均表型的变化完全由平均育种值的变化决定。\n\n接下来，我们将子代的平均育种值 $E[A_{o}]$ 与其亲本的育种值联系起来。对于二倍体生物，子代的育种值 $A_{o}$ 是其亲本（父本 $A_{s}$ 和母本 $A_{d}$）育种值的平均值，再加上一个期望为零的孟德尔分离（Mendelian segregation）偏差。因此，$A_{o} = \\frac{1}{2}A_{s} + \\frac{1}{2}A_{d} + \\epsilon_{\\text{mendel}}$，其中 $E[\\epsilon_{\\text{mendel}}] = 0$。使用全期望定律，子代群体的预期育种值为：\n$$\nE[A_{o}] = E\\left[ E[A_{o} | A_s, A_d] \\right] = E\\left[ \\frac{1}{2}A_{s} + \\frac{1}{2}A_{d} \\right] = \\frac{1}{2}E[A_{s}] + \\frac{1}{2}E[A_{d}]\n$$\n父本和母本都从被选中的亲本群体中抽取。由于它们随机交配，父本的预期育种值与母本相同，并且都等于所有被选亲本的平均育种值，我们将其表示为 $\\bar{A}_{\\text{sel}}$。\n$$\nE[A_{s}] = E[A_{d}] = \\bar{A}_{\\text{sel}}\n$$\n将此代入 $E[A_{o}]$ 的表达式中得到：\n$$\nE[A_{o}] = \\frac{1}{2}\\bar{A}_{\\text{sel}} + \\frac{1}{2}\\bar{A}_{\\text{sel}} = \\bar{A}_{\\text{sel}}\n$$\n因此，选择响应等同于育种值的选择差：\n$$\nR = \\bar{A}_{\\text{sel}} - \\bar{A}\n$$\n\n最后也是最关键的一步，是将在育种值上的选择差 $R$ 与在表型上的选择差 $S = \\bar{P}_{\\text{sel}} - \\bar{P}$ 联系起来，其中 $\\bar{P}_{\\text{sel}}$ 是被选亲本的平均表型。这种关系由育种值 $A$ 对表型 $P$ 的回归给出。\n\n从 $P$ 预测 $A$ 的最佳线性预测器是使均方误差 $E[(A-L(P))^2]$ 最小化的直线 $L(P) = \\alpha + \\beta P$。该直线的斜率 $\\beta$ 由下式给出：\n$$\n\\beta = \\frac{\\operatorname{Cov}(A, P)}{\\operatorname{Var}(P)}\n$$\n该斜率由加性遗传方差和表型方差决定。我们使用恒等式 $\\operatorname{Cov}(X,Y) = \\operatorname{Cov}(X, Y_1+Y_2) = \\operatorname{Cov}(X, Y_1) + \\operatorname{Cov}(X,Y_2)$ 来计算协方差：\n$$\n\\operatorname{Cov}(A, P) = \\operatorname{Cov}(A, A+E) = \\operatorname{Cov}(A, A) + \\operatorname{Cov}(A, E)\n$$\n鉴于 $\\operatorname{Cov}(A, A) = \\operatorname{Var}(A) = V_A$ 并且 $A$ 和 $E$ 是独立的，所以 $\\operatorname{Cov}(A, E) = 0$。因此：\n$$\n\\operatorname{Cov}(A, P) = V_{A}\n$$\n分母是表型方差 $\\operatorname{Var}(P) = V_{P}$。因此，最佳线性预测器的斜率为：\n$$\n\\beta = \\frac{V_{A}}{V_{P}}\n$$\n如果 $A$ 对 $P$ 的真实回归是线性的，则 $E[A|P=p] = \\bar{A} + \\beta(p-\\bar{P})$。我们可以通过对被选群体求这个条件期望的期望值，来找到被选个体的平均育种值 $\\bar{A}_{\\text{sel}} = E[A|\\text{selection}]$。根据全期望定律，并且由于选择仅基于 $P$：\n$$\n\\bar{A}_{\\text{sel}} = E[A|\\text{selection}] = E[E[A|P]|\\text{selection}]\n$$\n代入线性回归方程：\n$$\n\\bar{A}_{\\text{sel}} = E[\\bar{A} + \\beta(P - \\bar{P}) | \\text{selection}]\n$$\n使用期望的线性性：\n$$\n\\bar{A}_{\\text{sel}} = \\bar{A} + \\beta E[P - \\bar{P} | \\text{selection}] = \\bar{A} + \\beta (E[P|\\text{selection}] - \\bar{P})\n$$\n根据定义，$E[P|\\text{selection}] = \\bar{P}_{\\text{sel}}$，所以：\n$$\n\\bar{A}_{\\text{sel}} = \\bar{A} + \\beta (\\bar{P}_{\\text{sel}} - \\bar{P}) = \\bar{A} + \\beta S\n$$\n整理可得 $\\bar{A}_{\\text{sel}} - \\bar{A} = \\beta S$。由于我们已经确定 $R = \\bar{A}_{\\text{sel}} - \\bar{A}$，我们有：\n$$\nR = \\beta S = \\frac{V_A}{V_P} S\n$$\n这就用 $S$、$V_A$ 和 $V_P$ 表示了选择响应。使用狭义遗传力 $h^2 = V_A/V_P$ 的定义，该表达式变为：\n$$\nR = h^2 S\n$$\n这就是育种家方程。\n\n该预测为无偏的最小生物学和统计学假设是：\n1.  **统计学假设：** 育种值（$A$）对表型（$P$）的回归是线性的。如果 $A$ 和 $E$ 服从多元正态分布，则此假设成立，否则这是一个强假设。没有这个假设，$R=h^2 S$ 只是最佳线性预测，但可能是有偏的。\n2.  **生物学假设：**\n    (a) 加性模型（$P=A+E$）是充分的描述；在随机交配下，非加性遗传效应（显性、上位性）的平均值不发生改变。\n    (b) 性状仅通过加性遗传值 $A$ 从亲本传递给子代，如 $A_o = \\frac{1}{2}(A_s+A_d)$ 所描述。\n    (c) 被选亲本间的交配是随机的。\n    (d) 不存在基因型-环境相关性（$\\operatorname{Cov}(A,E)=0$）。\n    (e) 环境效应的分布在亲代和子代之间不发生变化。\n    (f) 群体足够大，可以忽略遗传漂变。\n    (g) 没有新的遗传方差引入（例如，通过突变或迁移）。\n\n对于纯粹的离散性状，类似的推理会失败，因为基础模型无效。一个离散性状（例如，表型为 $0$ 或 $1$）不具有连续分布，其值不能分解为连续分布的加性遗传组分和环境组分之和。育种值 $A$ 对二元表型 $P$ 的回归必然是非线性的，仅由两个点组成，$E[A|P=0]$ 和 $E[A|P=1]$。这里使用的线性回归和方差/协方差分解的整个框架是不合适的。只有通过假设存在一个遵循 $L = A+E$ 模型的、未被观察到的潜在数量性状——易患性（liability）——才能挽救这种推理。当易患性 $L$ 超过某个阈值时，就会表现出离散表型。在这个易患性-阈值模型中，对离散表型的选择意味着对潜在易患性的选择，育种家方程可以用来预测平均易患性的响应。", "answer": "$$\n\\boxed{h^2 S}\n$$", "id": "2701484"}, {"introduction": "离散性状和定量性状之间的明确界限常常变得模糊，阈值模型为此提供了有力的解释。该模型假设一个连续的潜在“易感性”变量，当其超过某个阈值时，便会触发一个离san的表型结果 [@problem_id:2701495]。这个练习将通过一个具体案例，让你亲手计算在一个受随机基因表达噪音影响的系统中，不同离散表型出现的预期比例，从而揭示连续过程如何产生不连续的结果。", "problem": "在进化生物学中，离散性状和数量性状之间的表面二分法可以通过阈值模型来调和，在该模型中，一个连续的、有噪声的潜在易感性通过一个发育开关映射到一个离散表型。考虑一个单一位点的发育开关，如果在关键的发育时期，某个转录因子的表达量超过一个阈值，该开关就会触发一个形态结构的形成。设个体的分子表达水平为一个随机变量 $X$，它捕捉了由许多独立分子事件引起的随机基因表达。根据中心极限定理，假设在一个遗传上同质的群体中，$X$ 近似服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布。该发育开关实现了一个硬阈值：如果 $X \\ge T$，观测到的表型 $Y$ 为 $Y=1$（“开启”模式）；如果 $X  T$，则为 $Y=0$（“关闭”模式），其中 $T$ 是一个固定的阈值。尽管潜在的易感性 $X$ 是单峰和定量的，但这种机制产生了一个双峰的表型分布。\n\n仅使用累积分布函数的基本概率定义，从第一性原理推导“关闭”和“开启”模式下个体所占的期望比例的表达式，这些表达式是关于 $\\mu$、$\\sigma$ 和 $T$ 的函数。然后，对于参数值 $\\mu = 50$ 分子，$\\sigma^{2} = 100$ 分子$^{2}$，以及 $T = 60$ 分子，计算这些比例。将你的最终数值答案以行向量 $\\begin{pmatrix} p_{\\mathrm{OFF}}  p_{\\mathrm{ON}} \\end{pmatrix}$ 的形式报告，并四舍五入到4位有效数字。不要用百分号表示你的答案，请使用小数。最终答案中不需要物理单位。", "solution": "题目陈述经验证。\n\n**第一步：提取已知条件**\n- 潜在易感性是一个随机变量 $X$。\n- $X$ 的分布近似为高斯分布，均值为 $\\mu$，方差为 $\\sigma^{2}$，因此 $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$。\n- 观测到的表型是一个离散变量 $Y$。\n- 从 $X$ 到 $Y$ 的映射由一个固定阈值 $T$ 定义：\n  - 如果 $X \\ge T$，则 $Y=1$（开启模式）。\n  - 如果 $X  T$，则 $Y=0$（关闭模式）。\n- 任务是从第一性原理推导处于关闭和开启模式的个体所占的期望比例 $p_{\\mathrm{OFF}}$ 和 $p_{\\mathrm{ON}}$。\n- 任务是使用特定的参数值计算这些比例：\n  - $\\mu = 50$\n  - $\\sigma^{2} = 100$\n  - $T = 60$\n- 最终答案必须是一个行向量 $\\begin{pmatrix} p_{\\mathrm{OFF}}  p_{\\mathrm{ON}} \\end{pmatrix}$，数值四舍五入到4位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了数量遗传学中的阈值模型，这是一个成熟的概念，用于将连续的遗传和环境变异与离散的表型结果联系起来。应用中心极限定理将由许多微小、独立效应产生的生物变量建模为高斯分布，是定量生物学中一种标准且有效的方法。\n- **适定性**：该问题是适定的。变量、它们的分布以及它们之间的关系都得到了清晰的定义。所有必要的参数（$\\mu$、$\\sigma^{2}$、$T$）都已提供，可得到唯一的数值解。\n- **客观性**：该问题以精确、客观和科学的语言陈述，没有歧义或主观陈述。\n\n**结论**\n该问题在科学上是合理的，说明是完整的，并且在数学上是适定的。它是在生物学背景下的一个有效的应用概率论问题。我将继续进行解答。\n\n问题要求计算表现出“关闭”和“开启”表型的群体所占的期望比例。这些比例分别对应于概率 $P(Y=0)$ 和 $P(Y=1)$。\n\n表型 $Y$ 由潜在的连续随机变量 $X$ 的值决定，该变量服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。我们记为 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$。$X$ 的概率密度函数 (PDF) 由下式给出：\n$$f_X(x) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$$\n如果表达水平 $X$ 小于阈值 $T$，则表型处于“关闭”状态 ($Y=0$)。此事件的概率，我们记为 $p_{\\mathrm{OFF}}$，是：\n$$p_{\\mathrm{OFF}} = P(Y=0) = P(X  T)$$\n如果表达水平 $X$ 大于或等于阈值 $T$，则表型处于“开启”状态 ($Y=1$)。此事件的概率，$p_{\\mathrm{ON}}$，是：\n$$p_{\\mathrm{ON}} = P(Y=1) = P(X \\ge T)$$\n由于 $X$ 是一个连续随机变量，所以 $X$ 精确等于任何特定值（包括 $T$）的概率为零。即 $P(X=T)=0$。因此，$P(X  T) = P(X \\le T)$。\n\n从第一性原理出发，概率 $P(X \\le t)$ 是 $X$ 的累积分布函数 (CDF) 的定义，记为 $F_X(t)$。它通过对概率密度函数从 $-\\infty$ 到 $t$ 积分计算得出：\n$$F_X(t) = P(X \\le t) = \\int_{-\\infty}^{t} f_X(x) \\,dx$$\n使用此定义，我们可以将 $p_{\\mathrm{OFF}}$ 表示为：\n$$p_{\\mathrm{OFF}} = P(X  T) = P(X \\le T) = F_X(T) = \\int_{-\\infty}^{T} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right) \\,dx$$\n事件 $Y=0$ 和 $Y=1$ 是互斥且穷尽的，所以它们的概率之和必须为 $1$。\n$$p_{\\mathrm_{\\mathrm{OFF}}} + p_{\\mathrm{ON}} = 1$$\n因此，$p_{\\mathrm{ON}}$ 可以表示为：\n$$p_{\\mathrm{ON}} = 1 - p_{\\mathrm{OFF}} = 1 - F_X(T) = P(X > T) = \\int_{T}^{\\infty} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right) \\,dx$$\n为了计算这些表达式，我们对随机变量 $X$进行标准化。令 $Z = \\frac{X-\\mu}{\\sigma}$。变量 $Z$ 服从标准正态分布 $Z \\sim \\mathcal{N}(0,1)$，其概率密度函数为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$，累积分布函数为 $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t) \\,dt$。\n\n我们将不等式 $X \\le T$ 转换为关于 $Z$ 的等价不等式：\n$$X \\le T \\iff X-\\mu \\le T-\\mu \\iff \\frac{X-\\mu}{\\sigma} \\le \\frac{T-\\mu}{\\sigma}$$\n因此，我们可以用标准正态累积分布函数 $\\Phi$ 来表示 $p_{\\mathrm{OFF}}$：\n$$p_{\\mathrm{OFF}} = P\\left(Z \\le \\frac{T-\\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{T-\\mu}{\\sigma}\\right)$$\n因此，$p_{\\mathrm{ON}}$ 的表达式是：\n$$p_{\\mathrm{ON}} = 1 - p_{\\mathrm{OFF}} = 1 - \\Phi\\left(\\frac{T-\\mu}{\\sigma}\\right)$$\n这些是在关闭和开启模式下个体所占比例的一般表达式。\n\n现在，我们用给定的参数值 $\\mu = 50$，$\\sigma^2 = 100$ 和 $T = 60$ 来计算这些表达式。\n首先，我们求标准差 $\\sigma$：\n$$\\sigma = \\sqrt{\\sigma^2} = \\sqrt{100} = 10$$\n接下来，我们计算标准化值，也就是 $\\Phi$ 函数的自变量：\n$$z = \\frac{T-\\mu}{\\sigma} = \\frac{60-50}{10} = \\frac{10}{10} = 1$$\n将这个值代入我们推导出的表达式中：\n$$p_{\\mathrm{OFF}} = \\Phi(1)$$\n$$p_{\\mathrm{ON}} = 1 - \\Phi(1)$$\n标准正态累积分布函数在 $z=1$ 处的值是一个标准结果，约为 $\\Phi(1) \\approx 0.8413447$。\n使用这个值，我们求得数值比例：\n$$p_{\\mathrm{OFF}} \\approx 0.8413447$$\n$$p_{\\mathrm{ON}} \\approx 1 - 0.8413447 = 0.1586553$$\n题目要求将结果四舍五入到4位有效数字。\n对于 $p_{\\mathrm{OFF}}$，将 $0.8413447$ 四舍五入到4位有效数字得到 $0.8413$。\n对于 $p_{\\mathrm{ON}}$，将 $0.1586553$ 四舍五入到4位有效数字得到 $0.1587$。\n\n最终结果是行向量 $\\begin{pmatrix} p_{\\mathrm{OFF}}  p_{\\mathrm{ON}} \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8413  0.1587\n\\end{pmatrix}\n}\n$$", "id": "2701495"}, {"introduction": "在获得了离散性状数据后，我们需要强大的统计工具来检验其背后的遗传关联。逻辑回归正是在这种情况下分析基因型与二元结果（如成功/失败）之间关系的核心方法。本练习提供了一个实际操作案例 [@problem_id:2701557]，指导你如何应用逻辑回归模型，通过计算沃尔德检验统计量来评估等位基因剂量效应对离散性状概率的影响。", "problem": "一位研究人员正在研究一种基因型与一种离散性状（成功与失败）之间的关联。该基因型以加性剂量来衡量，其中 $g \\in \\{0,1,2\\}$ 表示特定等位基因的拷贝数。对于每个剂量类别 $g$，研究人员在 $n_g$ 个个体中观察到 $y_g$ 次成功，具体如下：对于 $g=0$，$n_0=50$ 中有 $y_0=10$ 次成功；对于 $g=1$，$n_1=40$ 中有 $y_1=20$ 次成功；对于 $g=2$，$n_2=50$ 中有 $y_2=40$ 次成功。\n\n将离散性状视为成功概率为 $p_g$（对应剂量 $g$）的伯努利分布，考虑使用 logit 链接的逻辑斯谛回归模型，\n$$\n\\log\\left(\\frac{p_g}{1-p_g}\\right) = \\alpha + \\beta g,\n$$\n其中 $\\alpha$ 和 $\\beta$ 是未知参数。仅使用分组伯努利结果的二项似然函数的基本定义以及最大似然估计量（MLE）的渐近正态性，完成以下任务：\n\n1. 写出聚合数据的二项对数似然函数，并求出 $(\\alpha,\\beta)$ 的得分向量和费雪信息矩阵。\n2. 通过求解似然方程，根据给定数据计算 MLE $\\hat{\\alpha}$ 和 $\\hat{\\beta}$。\n3. 使用由费雪信息矩阵的逆给出的 $\\hat{\\beta}$ 的渐近方差，构建用于检验 $H_0:\\beta=0$ 与 $H_1:\\beta \\neq 0$ 的瓦尔德检验统计量，并说明其大样本零分布。\n4. 根据数据计算瓦尔德统计量的数值并报告该值。\n\n将瓦尔德统计量的最终数值答案四舍五入到四位有效数字。将该统计量表示为纯数（无单位）。", "solution": "问题陈述具有科学依据，提法得当，客观且自洽。它描述了广义线性模型（逻辑斯谛回归）在分析二项数据中的一个标准应用，这是生物统计学和统计遗传学中的一项常见任务。数据和模型定义清晰，任务具体且可形式化。不存在矛盾、歧义或违反基本原则之处。因此，该问题被认为是有效的，可以构建一个完整的解答。\n\n该问题要求使用逻辑斯谛回归模型对二项数据进行分析。对于给定的基因型剂量 $g \\in \\{0, 1, 2\\}$，在 $n_g$ 次试验中成功的次数 $y_g$ 假定服从二项分布，$Y_g \\sim \\text{Binomial}(n_g, p_g)$。成功概率 $p_g$ 通过 logit 链接函数与基因型剂量 $g$ 相关联：\n$$ \\text{logit}(p_g) = \\log\\left(\\frac{p_g}{1-p_g}\\right) = \\alpha + \\beta g $$\n给定的数据是：\n对于 $g=0$：$y_0 = 10$，$n_0 = 50$。\n对于 $g=1$：$y_1 = 20$，$n_1 = 40$。\n对于 $g=2$：$y_2 = 40$，$n_2 = 50$。\n\n**1. 对数似然函数、得分向量和费雪信息矩阵**\n\n对于观测数据 $(\\mathbf{y}, \\mathbf{n}) = ((y_0, n_0), (y_1, n_1), (y_2, n_2))$，其似然函数是每组 $g$ 在 $n_g$ 次试验中观测到 $y_g$ 次成功的概率的乘积：\n$$ L(\\alpha, \\beta; \\mathbf{y}) = \\prod_{g=0}^{2} \\binom{n_g}{y_g} p_g^{y_g} (1-p_g)^{n_g - y_g} $$\n对数似然函数 $\\ell(\\alpha, \\beta) = \\log L(\\alpha, \\beta)$ 为：\n$$ \\ell(\\alpha, \\beta) = \\sum_{g=0}^{2} \\left[ \\log\\binom{n_g}{y_g} + y_g \\log(p_g) + (n_g - y_g) \\log(1-p_g) \\right] $$\n根据模型，我们可以用 $\\alpha$ 和 $\\beta$ 表示 $p_g$ 和对数优势比：\n$p_g = \\frac{\\exp(\\alpha + \\beta g)}{1 + \\exp(\\alpha + \\beta g)}$ 和 $1-p_g = \\frac{1}{1 + \\exp(\\alpha + \\beta g)}$。\n将这些代入对数似然函数，并忽略不依赖于 $\\alpha$ 或 $\\beta$ 的常数项 $\\sum_{g} \\log\\binom{n_g}{y_g}$，我们得到：\n$$ \\ell(\\alpha, \\beta) = \\sum_{g=0}^{2} \\left[ y_g (\\alpha + \\beta g) - (n_g-y_g)\\log(1+\\exp(\\alpha+\\beta g)) - y_g \\log(1+\\exp(\\alpha+\\beta g)) \\right] $$\n$$ \\ell(\\alpha, \\beta) \\propto \\sum_{g=0}^{2} \\left[ y_g(\\alpha + \\beta g) - n_g \\log(1 + \\exp(\\alpha + \\beta g)) \\right] $$\n得分向量 $U(\\alpha, \\beta)$ 是 $\\ell$ 关于参数 $(\\alpha, \\beta)$ 的一阶偏导数向量。\n$$ \\frac{\\partial \\ell}{\\partial \\alpha} = \\sum_{g=0}^{2} \\left[ y_g - n_g \\frac{\\exp(\\alpha + \\beta g)}{1 + \\exp(\\alpha + \\beta g)} \\right] = \\sum_{g=0}^{2} (y_g - n_g p_g) $$\n$$ \\frac{\\partial \\ell}{\\partial \\beta} = \\sum_{g=0}^{2} \\left[ y_g g - n_g g \\frac{\\exp(\\alpha + \\beta g)}{1 + \\exp(\\alpha + \\beta g)} \\right] = \\sum_{g=0}^{2} g(y_g - n_g p_g) $$\n得分向量为 $U(\\alpha, \\beta) = \\begin{pmatrix} \\sum_{g} (y_g - n_g p_g) \\\\ \\sum_{g} g(y_g - n_g p_g) \\end{pmatrix}$。\n\n费雪信息矩阵 $I(\\alpha, \\beta)$ 是黑塞矩阵期望值的负数。对于具有规范链接的广义线性模型（GLM），例如用于二项数据的 logit 链接，费雪信息矩阵等于黑塞矩阵的负数，并由 $I(\\alpha, \\beta) = X^T W X$ 给出，其中 $X$ 是设计矩阵，$W$ 是一个对角权重矩阵。\n二阶偏导数为：\n$$ \\frac{\\partial^2 \\ell}{\\partial \\alpha^2} = -\\sum_{g=0}^{2} n_g \\frac{\\partial p_g}{\\partial \\alpha} = -\\sum_{g=0}^{2} n_g p_g(1-p_g) $$\n$$ \\frac{\\partial^2 \\ell}{\\partial \\beta^2} = -\\sum_{g=0}^{2} n_g g^2 \\frac{\\partial p_g}{\\partial \\beta} = -\\sum_{g=0}^{2} n_g g^2 p_g(1-p_g) $$\n$$ \\frac{\\partial^2 \\ell}{\\partial \\alpha \\partial \\beta} = -\\sum_{g=0}^{2} n_g g \\frac{\\partial p_g}{\\partial \\alpha} = -\\sum_{g=0}^{2} n_g g p_g(1-p_g) $$\n由于这些导数不依赖于数据 $y_g$，费雪信息矩阵 $I(\\alpha, \\beta)$ 是黑塞矩阵的负数：\n$$ I(\\alpha, \\beta) = \\begin{pmatrix} \\sum_{g} n_g p_g(1-p_g)  \\sum_{g} n_g g p_g(1-p_g) \\\\ \\sum_{g} n_g g p_g(1-p_g)  \\sum_{g} n_g g^2 p_g(1-p_g) \\end{pmatrix} $$\n\n**2. 计算 MLE $\\hat{\\alpha}$ 和 $\\hat{\\beta}$**\n\n最大似然估计（MLE）$\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 通过将得分方程设为零来求得：\n$$ \\sum_{g=0}^{2} (y_g - n_g \\hat{p}_g) = 0 \\quad \\implies \\quad \\sum_{g=0}^{2} y_g = \\sum_{g=0}^{2} n_g \\hat{p}_g $$\n$$ \\sum_{g=0}^{2} g(y_g - n_g \\hat{p}_g) = 0 \\quad \\implies \\quad \\sum_{g=0}^{2} g y_g = \\sum_{g=0}^{2} g n_g \\hat{p}_g $$\n其中 $\\hat{p}_g = \\frac{\\exp(\\hat{\\alpha} + \\hat{\\beta} g)}{1 + \\exp(\\hat{\\alpha} + \\hat{\\beta} g)}$。通常，这些方程必须通过数值方法求解。然而，我们首先从数据中计算经验概率 $\\tilde{p}_g = y_g/n_g$：\n$\\tilde{p}_0 = 10/50 = 0.2$\n$\\tilde{p}_1 = 20/40 = 0.5$\n$\\tilde{p}_2 = 40/50 = 0.8$\n如果我们设 $\\hat{p}_g = \\tilde{p}_g$，则得分方程变为 $\\sum (y_g - n_g \\tilde{p}_g) = \\sum (y_g - y_g) = 0$ 和 $\\sum g(y_g - n_g \\tilde{p}_g) = \\sum g(y_g - y_g) = 0$。两个方程都得到满足。这意味着 MLE 是产生 $\\hat{p}_g = \\tilde{p}_g$ 的 $\\alpha$ 和 $\\beta$ 的值。我们可以通过对经验 logit $\\text{logit}(\\tilde{p}_g)$ 进行线性拟合来找到它们：\n$\\text{logit}(\\tilde{p}_0) = \\log\\left(\\frac{0.2}{0.8}\\right) = \\log(0.25) = -\\ln(4)$。\n$\\text{logit}(\\tilde{p}_1) = \\log\\left(\\frac{0.5}{0.5}\\right) = \\log(1) = 0$。\n$\\text{logit}(\\tilde{p}_2) = \\log\\left(\\frac{0.8}{0.2}\\right) = \\log(4) = \\ln(4)$。\n我们求解关于 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 的线性方程组：\n$\\hat{\\alpha} + \\hat{\\beta} \\cdot 0 = -\\ln(4) \\implies \\hat{\\alpha} = -\\ln(4)$。\n$\\hat{\\alpha} + \\hat{\\beta} \\cdot 1 = 0 \\implies \\hat{\\beta} = -\\hat{\\alpha} = \\ln(4)$。\n我们用第三个点来检验：$\\hat{\\alpha} + \\hat{\\beta} \\cdot 2 = -\\ln(4) + 2\\ln(4) = \\ln(4)$，这是正确的。\n因此，MLE为 $\\hat{\\alpha} = -\\ln(4)$ 和 $\\hat{\\beta} = \\ln(4)$。\n\n**3. 瓦尔德检验统计量**\n\n瓦尔德检验用于检验原假设 $H_0: \\beta=0$ 与备择假设 $H_1: \\beta \\neq 0$。瓦尔德统计量由下式给出：\n$$ W = \\frac{(\\hat{\\beta} - \\beta_0)^2}{\\widehat{\\text{Var}}(\\hat{\\beta})} = \\frac{\\hat{\\beta}^2}{\\widehat{\\text{Var}}(\\hat{\\beta})} $$\n方差 $\\widehat{\\text{Var}}(\\hat{\\beta})$ 是 $\\hat{\\beta}$ 的渐近方差，由在 MLE $(\\hat{\\alpha}, \\hat{\\beta})$ 处求值的费雪信息矩阵的逆矩阵的相应元素来估计。\n首先，我们使用 $\\hat{p}_g = \\tilde{p}_g = (0.2, 0.5, 0.8)$ 计算 $I(\\hat{\\alpha}, \\hat{\\beta})$。\n权重 $w_g = n_g \\hat{p}_g(1-\\hat{p}_g)$ 为：\n$w_0 = 50 \\cdot 0.2 \\cdot 0.8 = 8$。\n$w_1 = 40 \\cdot 0.5 \\cdot 0.5 = 10$。\n$w_2 = 50 \\cdot 0.8 \\cdot 0.2 = 8$。\n现在，我们计算 $I(\\hat{\\alpha}, \\hat{\\beta})$ 的元素：\n$I_{11} = \\sum_{g} w_g = 8 + 10 + 8 = 26$。\n$I_{12} = I_{21} = \\sum_{g} g w_g = (0 \\cdot 8) + (1 \\cdot 10) + (2 \\cdot 8) = 0 + 10 + 16 = 26$。\n$I_{22} = \\sum_{g} g^2 w_g = (0^2 \\cdot 8) + (1^2 \\cdot 10) + (2^2 \\cdot 8) = 0 + 10 + 32 = 42$。\n因此，估计的费雪信息矩阵是：\n$$ I(\\hat{\\alpha}, \\hat{\\beta}) = \\begin{pmatrix} 26  26 \\\\ 26  42 \\end{pmatrix} $$\n该矩阵的逆矩阵是 $(\\hat{\\alpha}, \\hat{\\beta})$ 的估计协方差矩阵：\n$$ \\widehat{\\text{Cov}}(\\hat{\\alpha}, \\hat{\\beta}) = I(\\hat{\\alpha}, \\hat{\\beta})^{-1} = \\frac{1}{(26)(42) - (26)(26)} \\begin{pmatrix} 42  -26 \\\\ -26  26 \\end{pmatrix} $$\n$$ = \\frac{1}{26(42-26)} \\begin{pmatrix} 42  -26 \\\\ -26  26 \\end{pmatrix} = \\frac{1}{26 \\cdot 16} \\begin{pmatrix} 42  -26 \\\\ -26  26 \\end{pmatrix} = \\frac{1}{416} \\begin{pmatrix} 42  -26 \\\\ -26  26 \\end{pmatrix} $$\n$\\hat{\\beta}$ 的估计方差是该矩阵的 $(2,2)$ 元素：\n$$ \\widehat{\\text{Var}}(\\hat{\\beta}) = \\frac{26}{416} = \\frac{1}{16} $$\n那么瓦尔德统计量是：\n$$ W = \\frac{\\hat{\\beta}^2}{\\widehat{\\text{Var}}(\\hat{\\beta})} = \\frac{(\\ln(4))^2}{1/16} = 16(\\ln(4))^2 $$\n在原假设 $H_0: \\beta=0$ 下，瓦尔德统计量 $W$ 渐近服从自由度为 1 的卡方分布，$W \\sim \\chi^2_1$。\n\n**4. 瓦尔德统计量的数值**\n\n我们现在计算 $W$ 的数值：\n$$ \\ln(4) = 2\\ln(2) \\approx 2 \\times 0.693147 = 1.386294 $$\n$$ W = 16 \\times (1.386294...)^2 \\approx 16 \\times 1.921860... \\approx 30.749766... $$\n四舍五入到四位有效数字，我们得到 $W \\approx 30.75$。\n该检验统计量的较大值表明，有强有力的证据反对基因型与性状之间没有关联的原假设。", "answer": "$$\\boxed{30.75}$$", "id": "2701557"}]}