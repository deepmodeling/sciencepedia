{"hands_on_practices": [{"introduction": "最大简约法（Maximum Parsimony, MP）是一种基于特征的方法，旨在寻找需要最少特征状态变化的演化树。Fitch算法是计算这种最小变化次数的经典高效方法，尤其适用于无序特征。本练习 [@problem_id:2691502] 将通过一个具体的逐步应用，帮助您掌握简约法逻辑的基础，并为更复杂的模型打下坚实的基础。", "problem": "给定一个以 Newick 格式表示的全分叉有根系统发育树 $((A,B),(C,D))$，以及一个单一的二元形态特征，其观察到的叶尖状态为 $A=0$，$B=1$，$C=1$ 和 $D=1$。使用最大简约法（MP）标准，特别是针对无序二元特征的 Fitch 简约法，确定每个内部节点可能的祖先状态集，并计算整个进化树上所需的状态变化的最小次数。请将变化的最小次数作为您的最终数值答案。不假设任何转换偏好或速率异质性。无需四舍五入。", "solution": "所提供的问题具有科学依据、问题明确且客观。所有求解所需的数据均已提供，问题要求应用演化生物学中一个标准、定义明确的算法。因此，该问题是有效的，并将提供解答。\n\n目标是应用 Fitch 最大简约算法来确定给定系统发育树上一个二元特征所需状态变化的最小次数。系统发育树为 $((A,B),(C,D))$，叶尖的特征状态为 $A=0$，$B=1$，$C=1$ 和 $D=1$。\n\n首先，我们必须定义拓扑结构并一致地标记节点。设叶尖为 $A$、$B$、$C$ 和 $D$。设 $A$ 和 $B$ 的最近共同祖先的内部节点为 $N_1$。设 $C$ 和 $D$ 的最近共同祖先的内部节点为 $N_2$。树的根节点，即 $N_1$ 和 $N_2$ 的最近共同祖先，记为 $N_R$。任何节点 $k$ 的状态由一个可能的特征状态集 $S_k$ 表示。\n\n给定的叶尖状态为：\n$$S_A = \\{0\\}$$\n$$S_B = \\{1\\}$$\n$$S_C = \\{1\\}$$\n$$S_D = \\{1\\}$$\n\nFitch 算法分两个阶段进行。阶段 1 是从叶尖到根节点的自下而上遍历，该阶段确定所有内部节点的初步状态集，并计算总简约分数（变化的最小次数）。阶段 2 是从根节点到叶尖的自上而下遍历，该阶段解决状态集中的任何模糊性，以描绘出最简约重构（MPRs）的集合。\n\n**阶段 1：自下而上遍历**\n\n确定一个祖先节点 $k$（其两个直接后代为 $i$ 和 $j$）的状态集 $S_k$ 的规则如下：\n1. 如果后代状态集的交集非空，$S_i \\cap S_j \\neq \\emptyset$，则 $S_k = S_i \\cap S_j$。此分支上的变化次数为 $0$。\n2. 如果后代状态集的交集为空，$S_i \\cap S_j = \\emptyset$，则 $S_k = S_i \\cup S_j$。此分支上的变化次数为 $1$。\n\n总简约分数是所有内部节点上变化次数的总和。\n\n设 $L$ 为总变化次数。初始时，$L=0$。\n\n我们从朝向叶尖的节点向上遍历到根节点。\n\n**步骤 1：确定节点 $N_1$ 的状态集。**\n节点 $N_1$ 是节点 $A$ 和 $B$ 的父节点。\n状态集为 $S_A = \\{0\\}$ 和 $S_B = \\{1\\}$。\n交集为 $S_A \\cap S_B = \\{0\\} \\cap \\{1\\} = \\emptyset$。\n由于交集为空，我们使用并集规则。节点 $N_1$ 的状态集为 $S_{N_1} = S_A \\cup S_B = \\{0, 1\\}$。\n这表示需要一次特征状态变化。我们将总分数加一：$L = L + 1 = 1$。\n\n**步骤 2：确定节点 $N_2$ 的状态集。**\n节点 $N_2$ 是节点 $C$ 和 $D$ 的父节点。\n状态集为 $S_C = \\{1\\}$ 和 $S_D = \\{1\\}$。\n交集为 $S_C \\cap S_D = \\{1\\} \\cap \\{1\\} = \\{1\\}$。\n由于交集非空，我们使用交集规则。节点 $N_2$ 的状态集为 $S_{N_2} = S_C \\cap S_D = \\{1\\}$。\n不需要变化。分数保持为 $L=1$。\n\n**步骤 3：确定根节点 $N_R$ 的状态集。**\n节点 $N_R$ 是节点 $N_1$ 和 $N_2$ 的父节点。\n状态集为 $S_{N_1} = \\{0, 1\\}$ 和 $S_{N_2} = \\{1\\}$。\n交集为 $S_{N_1} \\cap S_{N_2} = \\{0, 1\\} \\cap \\{1\\} = \\{1\\}$。\n由于交集非空，我们使用交集规则。根节点 $N_R$ 的状态集为 $S_{N_R} = S_{N_1} \\cap S_{N_2} = \\{1\\}$。\n不需要变化。分数保持为 $L=1$。\n\n自下而上遍历完成。整个树所需的状态变化的最小次数为 $L=1$。\n\n_为求完整，我们讨论可能的祖先状态集。_\n初步状态集为 $S_{N_1} = \\{0, 1\\}$，$S_{N_2} = \\{1\\}$ 和 $S_{N_R} = \\{1\\}$。节点 $N_1$ 的状态集是模糊的。为了确定在任何最简约重构（MPR）中每个节点上可能存在的实际状态集，我们必须确保任何赋值都与最小总分数 $L=1$ 一致。\n\n根节点 $N_R$ 的状态明确为 $\\{1\\}$。节点 $N_2$ 的状态明确为 $\\{1\\}$。\n我们必须检查节点 $N_1$ 的模糊性。其初步状态集为 $\\{0, 1\\}$。\n- 如果我们将状态 $1$ 赋给节点 $N_1$：状态变化发生在通往分类单元 $A$ 的分支上（$1 \\to 0$）。所有其他分支没有变化（$N_R(1) \\to N_1(1)$、$N_1(1) \\to B(1)$、$N_R(1) \\to N_2(1)$ 等）。总变化次数为 $1$。这是一个最简约的重构。\n- 如果我们将状态 $0$ 赋给节点 $N_1$：一个状态变化发生在通往分类单元 $B$ 的分支上（$0 \\to 1$）。此外，由于根节点 $N_R$ 的状态必须为 $1$，连接 $N_R$ 和 $N_1$ 的分支上也必须发生一次变化（$1 \\to 0$）。这个重构需要 $2$ 次变化。由于 $2 > 1$，这不是一个最简约的重构。\n\n因此，只有一个最简约重构。在这个重构中，节点 $N_1$ 的状态必须是 $1$。内部节点可能的祖先状态集是：\n- 节点 $N_1$：$\\{1\\}$\n- 节点 $N_2$：$\\{1\\}$\n- 根节点 $N_R$：$\\{1\\}$\n唯一的演化事件是在通往分类单元 $A$ 的分支上从状态 $1$ 变为状态 $0$。\n\n然而，问题要求的是所需状态变化的最小次数，这在 Fitch 算法的第一阶段已经计算出来了。\n\n最终结果是简约分数 $L$。", "answer": "$$\\boxed{1}$$", "id": "2691502"}, {"introduction": "Fitch算法虽然强大，但它假设所有状态变化的成本都相同。Sankoff算法是一种更灵活的简约法，它允许不同状态之间存在不同的转换成本，因此非常适合处理有序或多状态特征。本练习 [@problem_id:2691545] 将要求您应用动态规划来寻找最低成本的重建方案，这是进行更高级别系统发育分析的一项关键技能。", "problem": "在一个有序多状态性状的离散祖先状态重建问题中，总简约性分数定义为所有边上相连节点状态之间转换成本的总和。考虑一个拓扑结构为 $\\bigl((A,B),(C,D)\\bigr)$ 的有根二叉树，以及一个在有序集合 $\\{0,1,2\\}$ 中取值的单一性状。叶尖的观测值为 $A=0$，$B=2$，$C=2$ 和 $D=1$。任意两个状态 $i$ 和 $j$ 之间的转换成本是可加的，由 $C_{ij}=|i-j|$ 给出。使用 Sankoff 动态规划简约性方法，计算最小总简约性分数和根节点的最优状态。如果存在多个最优根状态，则报告最小的状态值。将你的最终答案表示为一个双元素行矩阵，第一个元素是最小分数，第二个元素是最优根状态。无需四舍五入，答案应为不带单位的精确整数。", "solution": "所述问题具有科学依据，定义明确且客观。它展示了在简约性准则下，Sankoff 算法在祖先状态重建中的一个标准应用，这是计算系统发育学中的一项基本技术。所有必要信息——树的拓扑结构、叶尖的性状状态以及转换成本函数——都已提供，且不存在矛盾。因此，该问题被认为是有效的，可以进行正式求解。\n\n目标是找到给定性状在系统发育树上的最小简约性分数，并确定根节点的最优状态。我们将采用 Sankoff 动态规划算法，该算法以后序遍历（从叶尖到根）的方式计算每个节点的成本向量。\n\n设有根二叉树记为 $T$。内部节点是根节点 $R$ 及其两个子节点 $N_1$ 和 $N_2$。节点 $N_1$ 是叶尖 $A$ 和 $B$ 的父节点，节点 $N_2$ 是叶尖 $C$ 和 $D$ 的父节点。树的拓扑结构为 $\\bigl((A,B),(C,D)\\bigr)$。\n性状可以在有序集合 $S = \\{0, 1, 2\\}$ 中取值。\n叶尖的观测状态为：$s_A = 0$，$s_B = 2$，$s_C = 2$ 和 $s_D = 1$。\n$S$ 中任意两个状态 $i$ 和 $j$ 之间的转换成本由可加成本函数 $C_{ij} = |i-j|$ 给出。\n\nSankoff 算法为树中的每个节点 $k$ 和每个可能的状态 $s \\in S$ 计算一个分数 $S_k(s)$，表示在节点 $k$ 处于状态 $s$ 的条件下，以 $k$ 为根的子树的最小简约性成本。计算过程从叶尖向根节点进行。\n\n对于一个观测状态为 $s_u$ 的叶尖节点 $u$，其初始分数向量 $S_u$ 定义为 $S_u(s_u) = 0$ 且对于所有 $s \\neq s_u$ 都有 $S_u(s) = \\infty$。这反映了观测状态解释其自身的成本为 $0$，而任何其他状态都是不可能的。\n叶尖的初始分数向量为：\n- 对于状态 $\\{0, 1, 2\\}$，$S_A = (0, \\infty, \\infty)$。\n- 对于状态 $\\{0, 1, 2\\}$，$S_B = (\\infty, \\infty, 0)$。\n- 对于状态 $\\{0, 1, 2\\}$，$S_C = (\\infty, \\infty, 0)$。\n- 对于状态 $\\{0, 1, 2\\}$，$S_D = (\\infty, 0, \\infty)$。\n\n对于一个有子节点 $i$ 和 $j$ 的内部节点 $k$，状态 $s \\in S$ 的分数 $S_k(s)$ 是通过将其子节点的最小成本相加来计算的：\n$$S_k(s) = \\min_{s_i \\in S} \\bigl(C_{s,s_i} + S_i(s_i)\\bigr) + \\min_{s_j \\in S} \\bigl(C_{s,s_j} + S_j(s_j)\\bigr)$$\n\n我们现在计算内部节点 $N_1$ 和 $N_2$ 的分数向量。\n\n对于内部节点 $N_1$（$A$ 和 $B$ 的父节点）：\n$S_{N_1}(s) = \\min_{s_A \\in S} \\bigl(C_{s,s_A} + S_A(s_A)\\bigr) + \\min_{s_B \\in S} \\bigl(C_{s,s_B} + S_B(s_B)\\bigr)$\n根据 $A$ 和 $B$ 的初始分数，最小化过程选择 $s_A=0$ 和 $s_B=2$。\n$S_{N_1}(s) = \\bigl(C_{s,0} + S_A(0)\\bigr) + \\bigl(C_{s,2} + S_B(2)\\bigr) = |s-0| + 0 + |s-2| + 0 = |s| + |s-2|$.\n我们对每个可能的状态 $s \\in \\{0, 1, 2\\}$ 进行评估：\n- $S_{N_1}(0) = |0| + |0-2| = 0 + 2 = 2$.\n- $S_{N_1}(1) = |1| + |1-2| = 1 + 1 = 2$.\n- $S_{N_1}(2) = |2| + |2-2| = 2 + 0 = 2$.\n节点 $N_1$ 的分数向量为 $S_{N_1} = (2, 2, 2)$。\n\n对于内部节点 $N_2$（$C$ 和 $D$ 的父节点）：\n$S_{N_2}(s) = \\min_{s_C \\in S} \\bigl(C_{s,s_C} + S_C(s_C)\\bigr) + \\min_{s_D \\in S} \\bigl(C_{s,s_D} + S_D(s_D)\\bigr)$\n这简化为使用 $s_C=2$ 和 $s_D=1$。\n$S_{N_2}(s) = \\bigl(C_{s,2} + S_C(2)\\bigr) + \\bigl(C_{s,1} + S_D(1)\\bigr) = |s-2| + 0 + |s-1| + 0 = |s-2| + |s-1|$.\n我们对每个状态 $s \\in \\{0, 1, 2\\}$ 进行评估：\n- $S_{N_2}(0) = |0-2| + |0-1| = 2 + 1 = 3$.\n- $S_{N_2}(1) = |1-2| + |1-1| = 1 + 0 = 1$.\n- $S_{N_2}(2) = |2-2| + |2-1| = 0 + 1 = 1$.\n节点 $N_2$ 的分数向量为 $S_{N_2} = (3, 1, 1)$。\n\n最后，我们计算根节点 $R$（$N_1$ 和 $N_2$ 的父节点）的分数向量：\n$S_R(s) = \\min_{s_{N_1} \\in S} \\bigl(C_{s,s_{N_1}} + S_{N_1}(s_{N_1})\\bigr) + \\min_{s_{N_2} \\in S} \\bigl(C_{s,s_{N_2}} + S_{N_2}(s_{N_2})\\bigr)$。\n\n让我们分别计算这两项。\n第一项，对于子节点 $N_1$：$\\min_{s_{N_1} \\in \\{0,1,2\\}} \\bigl(|s-s_{N_1}| + S_{N_1}(s_{N_1})\\bigr)$。\n- 对于 $s=0$：$\\min(|0-0|+2, |0-1|+2, |0-2|+2) = \\min(2, 3, 4) = 2$。\n- 对于 $s=1$：$\\min(|1-0|+2, |1-1|+2, |1-2|+2) = \\min(3, 2, 3) = 2$。\n- 对于 $s=2$：$\\min(|2-0|+2, |2-1|+2, |2-2|+2) = \\min(4, 3, 2) = 2$。\n\n第二项，对于子节点 $N_2$：$\\min_{s_{N_2} \\in \\{0,1,2\\}} \\bigl(|s-s_{N_2}| + S_{N_2}(s_{N_2})\\bigr)$。\n- 对于 $s=0$：$\\min(|0-0|+3, |0-1|+1, |0-2|+1) = \\min(3, 2, 3) = 2$。\n- 对于 $s=1$：$\\min(|1-0|+3, |1-1|+1, |1-2|+1) = \\min(4, 1, 2) = 1$。\n- 对于 $s=2$：$\\min(|2-0|+3, |2-1|+1, |2-2|+1) = \\min(5, 2, 1) = 1$。\n\n现在，我们将这些项相加，得到根节点的分数向量 $S_R$：\n- $S_R(0) = 2 + 2 = 4$。\n- $S_R(1) = 2 + 1 = 3$。\n- $S_R(2) = 2 + 1 = 3$。\n根节点的最终分数向量为 $S_R = (4, 3, 3)$。\n\n整个树的最小总简约性分数是根节点分数向量中的最小值：\n最小分数 $= \\min\\bigl(S_R(0), S_R(1), S_R(2)\\bigr) = \\min(4, 3, 3) = 3$。\n\n根节点的最优状态是产生此最小分数的那些状态。在这种情况下，状态为 $1$ 和 $2$，因为 $S_R(1)=3$ 且 $S_R(2)=3$。问题规定，如果存在多个最优根状态，必须选择最小的状态值。\n最优状态的集合是 $\\{1, 2\\}$。此集合中的最小值为 $1$。\n因此，要报告的最优根状态是 $1$。\n\n最终答案由最小分数和其后的最优根状态组成。\n最小分数：$3$。\n最优根状态：$1$。", "answer": "$$\\boxed{\\begin{pmatrix} 3  1 \\end{pmatrix}}$$", "id": "2691545"}, {"introduction": "从简约法过渡到概率方法，后者通过使用分支长度来明确地对随时间发生的演化变化进行建模。本节介绍最大似然（Maximum Likelihood, ML）法和连续时间马尔可夫模型（如Mk模型）。本练习 [@problem_id:2691564] 将指导您完成ML重建的核心计算，包括推导转移概率和应用Felsenstein的剪枝算法来计算似然值，这些都是现代演化生物学的核心。", "problem": "考虑一个二元性状在具有拓扑结构 $((A,B),(C,D))$ 的固定四分类单元系统发育树上进化。从内部分支节点到末端的四个悬垂分支的长度均为 $0.1$。连接两个内部分支节点的内部分支长度为 $0.4$，根位于其中点，因此从根到每个内部分支节点的分支长度均为 $0.2$。该性状根据双态马尔可夫 $k$ 态（Mk）模型进化，在本例中，这是一个在状态空间 $\\{0,1\\}$ 上的连续时间马尔可夫链（CTMC），其瞬时速率矩阵为\n$$\nQ \\;=\\; \\begin{pmatrix}\n-q  q\\\\\nq  -q\n\\end{pmatrix},\n$$\n其中 $q=2$。该对称模型的平稳分布为 $(\\tfrac{1}{2},\\tfrac{1}{2})$。观察到的末端状态为 $A=0$，$B=1$，$C=1$ 和 $D=1$。\n\n从树上连续时间马尔可夫链（CTMC）的基本原理和剪枝算法（树上的动态规划）出发，完成以下任务：\n- 推导双态对称 CTMC 的转移概率矩阵 $P(t)=\\exp(Qt)$，并用 $q$ 和 $t$ 表示其元素。\n- 使用这些转移概率，计算紧邻 $(A,B)$ 和 $(C,D)$ 的两个祖先内部分支节点处的条件似然向量。\n- 利用从根到内部分支节点的两条长度为 $0.2$ 的分支，将这些条件似然传播到根，并假设根处的平稳先验为 $(\\tfrac{1}{2},\\tfrac{1}{2})$，计算在给定数据的情况下根处于状态 $1$ 的后验概率。\n\n仅报告最终的后验概率，以十进制表示并四舍五入到四位有效数字。不需要单位。", "solution": "该问题是有效的，因为它科学地基于系统发育树上的连续时间马尔可夫链原理，这是计算进化生物学中的一种标准方法。该问题是适定的、客观的，并包含计算唯一解所需的所有信息。\n\n设二元性状的状态空间为 $S = \\{0, 1\\}$。其进化由瞬时速率矩阵决定：\n$$\nQ = \\begin{pmatrix} -q  q \\\\ q  -q \\end{pmatrix}\n$$\n其中速率参数给定为 $q=2$。\n\n首先，我们推导转移概率矩阵 $P(t) = \\exp(Qt)$。矩阵 $Q$ 可以写成 $Q = q \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix}$。我们求 $Q$ 的特征值和特征向量。特征方程为 $\\det(Q - \\lambda I) = 0$：\n$$\n(-q - \\lambda)^2 - q^2 = 0 \\implies \\lambda^2 + 2q\\lambda = 0 \\implies \\lambda(\\lambda + 2q) = 0\n$$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = -2q$。对应的特征向量为 $v_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $v_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n特征向量矩阵为 $V = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$，其逆矩阵为 $V^{-1} = \\frac{1}{2} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$。\n转移矩阵由 $P(t) = V \\exp(Dt) V^{-1}$ 给出，其中 $D$ 是特征值的对角矩阵：\n$$\nP(t) = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} \\exp(0 \\cdot t)  0 \\\\ 0  \\exp(-2qt) \\end{pmatrix} \\frac{1}{2} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}\n$$\n$$\nP(t) = \\frac{1}{2} \\begin{pmatrix} 1  \\exp(-2qt) \\\\ 1  -\\exp(-2qt) \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 + \\exp(-2qt)  1 - \\exp(-2qt) \\\\ 1 - \\exp(-2qt)  1 + \\exp(-2qt) \\end{pmatrix}\n$$\n转移矩阵的元素为：\n$P_{00}(t) = P_{11}(t) = \\frac{1}{2}(1 + \\exp(-2qt))$（在时间 $t$ 内保持同一状态的概率）。\n$P_{01}(t) = P_{10}(t) = \\frac{1}{2}(1 - \\exp(-2qt))$（在时间 $t$ 内改变状态的概率）。\n\n接下来，我们应用 Felsenstein 的剪枝算法。设末端 $A$ 和 $B$ 的祖先内部分支节点为 $N_{AB}$，末端 $C$ 和 $D$ 的祖先节点为 $N_{CD}$。树的根是 $N_R$。节点 $u$ 的条件似然向量 $L_u$ 是一个向量 $[L_u(0), L_u(1)]^T$，其中 $L_u(i)$ 是在给定 $u$ 处于状态 $i$ 的情况下，由 $u$ 所生成的子树中观测数据的概率。\n\n对于末端，似然向量由观察到的状态决定：$A=0, B=1, C=1, D=1$。\n$L_A = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$L_B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$L_C = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，$L_D = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n所有悬垂分支的长度均为 $t_p = 0.1$。我们计算节点 $N_{AB}$ 处的条件似然：\n$L_{N_{AB}}(i) = \\left( \\sum_{j \\in S} P_{ij}(t_p) L_A(j) \\right) \\times \\left( \\sum_{k \\in S} P_{ik}(t_p) L_B(k) \\right)$。\n$L_{N_{AB}}(0) = (P_{00}(t_p) \\cdot 1 + P_{01}(t_p) \\cdot 0) \\times (P_{00}(t_p) \\cdot 0 + P_{01}(t_p) \\cdot 1) = P_{00}(t_p) P_{01}(t_p)$。\n$L_{N_{AB}}(1) = (P_{10}(t_p) \\cdot 1 + P_{11}(t_p) \\cdot 0) \\times (P_{10}(t_p) \\cdot 0 + P_{11}(t_p) \\cdot 1) = P_{10}(t_p) P_{11}(t_p)$。\n由于 $P_{00}=P_{11}$ 且 $P_{01}=P_{10}$，我们有 $L_{N_{AB}}(0) = L_{N_{AB}}(1) = P_{00}(t_p) P_{01}(t_p)$。\n\n类似地，对于节点 $N_{CD}$：\n$L_{N_{CD}}(i) = \\left( \\sum_{j \\in S} P_{ij}(t_p) L_C(j) \\right) \\times \\left( \\sum_{k \\in S} P_{ik}(t_p) L_D(k) \\right)$。\n$L_{N_{CD}}(0) = (P_{01}(t_p))^2$。\n$L_{N_{CD}}(1) = (P_{11}(t_p))^2$。\n\n现在，我们将这些似然传播到根 $N_R$。从根到 $N_{AB}$ 和 $N_{CD}$ 的分支长度均为 $t_r = 0.2$。根处的条件似然为：\n$L_{N_R}(i) = \\left( \\sum_{j \\in S} P_{ij}(t_r) L_{N_{AB}}(j) \\right) \\times \\left( \\sum_{k \\in S} P_{ik}(t_r) L_{N_{CD}}(k) \\right)$。\n\n对于 $i=0$：\n$L_{N_R}(0) = [P_{00}(t_r)L_{N_{AB}}(0) + P_{01}(t_r)L_{N_{AB}}(1)] \\times [P_{00}(t_r)L_{N_{CD}}(0) + P_{01}(t_r)L_{N_{CD}}(1)]$。\n代入 $L_{N_{AB}}(0)=L_{N_{AB}}(1)$，第一项变为 $(P_{00}(t_r) + P_{01}(t_r))L_{N_{AB}}(0)$。由于 $P_{00}(t_r) + P_{01}(t_r) = 1$，这简化为 $L_{N_{AB}}(0)$。\n$L_{N_R}(0) = P_{00}(t_p)P_{01}(t_p) \\times [P_{00}(t_r)(P_{01}(t_p))^2 + P_{01}(t_r)(P_{11}(t_p))^2]$。\n\n对于 $i=1$：\n$L_{N_R}(1) = [P_{10}(t_r)L_{N_{AB}}(0) + P_{11}(t_r)L_{N_{AB}}(1)] \\times [P_{10}(t_r)L_{N_{CD}}(0) + P_{11}(t_r)L_{N_{CD}}(1)]$。\n第一项类似地简化为 $L_{N_{AB}}(1)$。\n$L_{N_R}(1) = P_{10}(t_p)P_{11}(t_p) \\times [P_{10}(t_r)(P_{01}(t_p))^2 + P_{11}(t_r)(P_{11}(t_p))^2]$。\n\n数据的总似然为 $P(D) = \\sum_{i \\in S} \\pi_i L_{N_R}(i)$，其中 $\\pi = (\\frac{1}{2}, \\frac{1}{2})$ 是根处的平稳分布。根处于状态 $1$ 的后验概率是：\n$$\nP(\\text{root}=1|D) = \\frac{\\pi_1 L_{N_R}(1)}{\\pi_0 L_{N_R}(0) + \\pi_1 L_{N_R}(1)} = \\frac{L_{N_R}(1)}{L_{N_R}(0) + L_{N_R}(1)}\n$$\n公因子 $P_{00}(t_p)P_{01}(t_p)$（因为 $P_{00}=P_{11}, P_{01}=P_{10}$）从分子和分母中约去。设 $p_s = P_{11}(t_p)$，$p_d = P_{01}(t_p)$，$p'_s = P_{11}(t_r)$，以及 $p'_d = P_{01}(t_r)$。\n$$\nP(\\text{root}=1|D) = \\frac{p'_d(p_d)^2 + p'_s(p_s)^2}{[p'_s(p_d)^2 + p'_d(p_s)^2] + [p'_d(p_d)^2 + p'_s(p_s)^2]}\n$$\n分母简化为 $(p'_s+p'_d)(p_d)^2 + (p'_d+p'_s)(p_s)^2 = (p_d)^2 + (p_s)^2$。\n$$\nP(\\text{root}=1|D) = \\frac{p'_d(p_d)^2 + p'_s(p_s)^2}{(p_d)^2 + (p_s)^2}\n$$\n我们有 $q=2$。对于 $t_p=0.1$，$2qt_p=0.4$。对于 $t_r=0.2$，$2qt_r=0.8$。\n$p_s = P_{11}(0.1) = \\frac{1}{2}(1 + \\exp(-0.4))$。\n$p_d = P_{01}(0.1) = \\frac{1}{2}(1 - \\exp(-0.4))$。\n$p'_s = P_{11}(0.2) = \\frac{1}{2}(1 + \\exp(-0.8))$。\n$p'_d = P_{01}(0.2) = \\frac{1}{2}(1 - \\exp(-0.8))$。\n\n我们来计算分母：$(p_d)^2 + (p_s)^2 = \\frac{1}{4}(1-\\exp(-0.4))^2 + \\frac{1}{4}(1+\\exp(-0.4))^2 = \\frac{1}{4}(1 - 2\\exp(-0.4) + \\exp(-0.8) + 1 + 2\\exp(-0.4) + \\exp(-0.8)) = \\frac{1}{2}(1+\\exp(-0.8)) = p'_s$。\n后验概率变为：\n$$\nP(\\text{root}=1|D) = \\frac{p'_d (p_d)^2 + p'_s (p_s)^2}{p'_s}\n$$\n代入概率的表达式：\n设 $u = \\exp(-0.4)$，则 $u^2 = \\exp(-0.8)$。\n$p_s = \\frac{1}{2}(1+u)$, $p_d = \\frac{1}{2}(1-u)$, $p'_s = \\frac{1}{2}(1+u^2)$, $p'_d = \\frac{1}{2}(1-u^2)$.\n分子：$\\frac{1}{2}(1-u^2)\\frac{1}{4}(1-u)^2 + \\frac{1}{2}(1+u^2)\\frac{1}{4}(1+u)^2$\n$= \\frac{1}{8}[(1-u^2)(1-2u+u^2) + (1+u^2)(1+2u+u^2)]$\n$= \\frac{1}{8}[(1-2u+u^2 - u^2+2u^3-u^4) + (1+2u+u^2 + u^2+2u^3+u^4)]$\n$= \\frac{1}{8}[2+2u^2+4u^3] = \\frac{1}{4}(1+u^2+2u^3)$。\n所以，$P(\\text{root}=1|D) = \\frac{\\frac{1}{4}(1+u^2+2u^3)}{\\frac{1}{2}(1+u^2)} = \\frac{1}{2}\\frac{1+u^2+2u^3}{1+u^2} = \\frac{1}{2}\\frac{1+\\exp(-0.8)+2\\exp(-1.2)}{1+\\exp(-0.8)}$。\n数值计算：\n$\\exp(-0.8) \\approx 0.449329$\n$\\exp(-1.2) \\approx 0.301194$\n$P(\\text{root}=1|D) \\approx \\frac{1}{2} \\frac{1+0.449329+2(0.301194)}{1+0.449329} = \\frac{1}{2} \\frac{1.449329+0.602388}{1.449329} = \\frac{1}{2} \\frac{2.051717}{1.449329} \\approx \\frac{1}{2}(1.415635) \\approx 0.7078175$。\n四舍五入到四位有效数字，后验概率为 $0.7078$。", "answer": "$$\\boxed{0.7078}$$", "id": "2691564"}]}