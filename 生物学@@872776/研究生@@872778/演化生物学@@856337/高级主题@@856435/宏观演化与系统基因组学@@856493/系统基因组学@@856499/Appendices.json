{"hands_on_practices": [{"introduction": "分子钟假设是系统发育基因组学的核心，它使我们能够估算物种分化时间。这个假设的有效性可以通过检验进化距离数据是否满足超度量性（ultrametricity）来评估。这个练习 [@problem_id:2743629] 提供了一个直接应用三点条件来量化数据与严格分子钟模型偏差的机会，这是进行时间校准的系统发育分析前一个至关重要的诊断步骤。", "problem": "一个基因组学联合会从五个标为 $\\{A,B,C,D,E\\}$ 的分类单元中，组装了五个单拷贝直系同源基因的全基因组比对。根据这些比对，他们在一个时间可逆的替换模型下估计了成对的进化路径距离，并以每个位点的替换数报告了这些距离。对于严格符合分子钟（超度量）的分化过程，三点条件规定：对于任意三个分类单元 $\\{i,j,k\\}$ 的组合，在三个成对距离 $\\{d_{ij},d_{ik},d_{jk}\\}$ 中，在无噪声的极限情况下，最大的两个值是相等的。为了实施一个与树拓扑无关的超度量性检验，定义了超度量偏差指数\n$$\nU \\equiv \\max_{\\{i,j,k\\}} \\left(\\max\\{d_{ij},d_{ik},d_{jk}\\} - \\text{second\\_largest}\\{d_{ij},d_{ik},d_{jk}\\}\\right),\n$$\n当且仅当所有三元组都精确满足三点条件时，该指数为零。给定以下按分类单元顺序 $(A,B,C,D,E)$ 排列的对称距离矩阵 $\\mathbf{D}=(d_{ij})$，其对角线元素等于 $0$：\n$$\n\\mathbf{D}=\n\\begin{pmatrix}\n0  & 0.608 & 0.992 & 0.998 & 1.004 \\\\\n0.608 & 0  & 0.996 & 1.006 & 1.002 \\\\\n0.992 & 0.996 & 0 & 0.406 & 0.398 \\\\\n0.998 & 1.006 & 0.406 & 0  & 0.304 \\\\\n1.004 & 1.002 & 0.398 & 0.304 & 0\n\\end{pmatrix}.\n$$\n仅从通过三点条件定义的超度量性核心定义出发，计算该矩阵的超度量偏差指数 $U$。然后，基于一个常用的决策规则——如果 $U \\leq \\delta$（其中 $\\delta=0.020$ 每个位点的替换数，反映了典型的基因组尺度采样噪声），则严格分子钟模型是合理的——在你的推理中评估其合理性。仅报告 $U$ 的值，四舍五入到四位有效数字，并以每个位点的替换数表示结果。", "solution": "该问题要求针对给定的成对距离矩阵 $\\mathbf{D}$，计算超度量偏差指数 $U$。问题陈述的有效性已确认，因为它具有科学依据、问题明确且客观。我将开始解题。\n\n这五个分类单元的集合标记为 $\\{A,B,C,D,E\\}$，我们可以分别将其索引为 $\\{1,2,3,4,5\\}$。所提供的对称距离矩阵为：\n$$\n\\mathbf{D}=\n\\begin{pmatrix}\n0  & 0.608 & 0.992 & 0.998 & 1.004 \\\\\n0.608 & 0  & 0.996 & 1.006 & 1.002 \\\\\n0.992 & 0.996 & 0 & 0.406 & 0.398 \\\\\n0.998 & 1.006 & 0.406 & 0  & 0.304 \\\\\n1.004 & 1.002 & 0.398 & 0.304 & 0\n\\end{pmatrix}.\n$$\n超度量偏差指数 $U$ 定义为在所有可能的分类单元三元组 $\\{i,j,k\\}$ 中，与三点条件的最大偏差：\n$$\nU \\equiv \\max_{\\{i,j,k\\}} \\left(\\max\\{d_{ij},d_{ik},d_{jk}\\} - \\text{second\\_largest}\\{d_{ij},d_{ik},d_{jk}\\}\\right).\n$$\n对于 $n=5$ 个分类单元，有 $\\binom{5}{3} = \\frac{5!}{3!2!} = 10$ 个唯一的三元组需要评估。令 $\\Delta_{ijk}$ 表示给定三元组 $\\{i,j,k\\}$ 的偏差。我们必须计算所有 $10$ 个三元组的 $\\Delta_{ijk}$。\n\n成对距离 $d_{ij}$ 如下：\n$d_{12} = 0.608$, $d_{13} = 0.992$, $d_{14} = 0.998$, $d_{15} = 1.004$\n$d_{23} = 0.996$, $d_{24} = 1.006$, $d_{25} = 1.002$\n$d_{34} = 0.406$, $d_{35} = 0.398$\n$d_{45} = 0.304$\n\n我们现在评估每个三元组的偏差：\n\n$1$. 三元组 $\\{1,2,3\\}$：距离为 $\\{d_{12}, d_{13}, d_{23}\\} = \\{0.608, 0.992, 0.996\\}$。\n最大的两个值为 $0.996$ 和 $0.992$。\n$\\Delta_{123} = 0.996 - 0.992 = 0.004$。\n\n$2$. 三元组 $\\{1,2,4\\}$：距离为 $\\{d_{12}, d_{14}, d_{24}\\} = \\{0.608, 0.998, 1.006\\}$。\n最大的两个值为 $1.006$ 和 $0.998$。\n$\\Delta_{124} = 1.006 - 0.998 = 0.008$。\n\n$3$. 三元组 $\\{1,2,5\\}$：距离为 $\\{d_{12}, d_{15}, d_{25}\\} = \\{0.608, 1.004, 1.002\\}$。\n最大的两个值为 $1.004$ 和 $1.002$。\n$\\Delta_{125} = 1.004 - 1.002 = 0.002$。\n\n$4$. 三元组 $\\{1,3,4\\}$：距离为 $\\{d_{13}, d_{14}, d_{34}\\} = \\{0.992, 0.998, 0.406\\}$。\n最大的两个值为 $0.998$ 和 $0.992$。\n$\\Delta_{134} = 0.998 - 0.992 = 0.006$。\n\n$5$. 三元组 $\\{1,3,5\\}$：距离为 $\\{d_{13}, d_{15}, d_{35}\\} = \\{0.992, 1.004, 0.398\\}$。\n最大的两个值为 $1.004$ 和 $0.992$。\n$\\Delta_{135} = 1.004 - 0.992 = 0.012$。\n\n$6$. 三元组 $\\{1,4,5\\}$：距离为 $\\{d_{14}, d_{15}, d_{45}\\} = \\{0.998, 1.004, 0.304\\}$。\n最大的两个值为 $1.004$ 和 $0.998$。\n$\\Delta_{145} = 1.004 - 0.998 = 0.006$。\n\n$7$. 三元组 $\\{2,3,4\\}$：距离为 $\\{d_{23}, d_{24}, d_{34}\\} = \\{0.996, 1.006, 0.406\\}$。\n最大的两个值为 $1.006$ 和 $0.996$。\n$\\Delta_{234} = 1.006 - 0.996 = 0.010$。\n\n$8$. 三元组 $\\{2,3,5\\}$：距离为 $\\{d_{23}, d_{25}, d_{35}\\} = \\{0.996, 1.002, 0.398\\}$。\n最大的两个值为 $1.002$ 和 $0.996$。\n$\\Delta_{235} = 1.002 - 0.996 = 0.006$。\n\n$9$. 三元组 $\\{2,4,5\\}$：距离为 $\\{d_{24}, d_{25}, d_{45}\\} = \\{1.006, 1.002, 0.304\\}$。\n最大的两个值为 $1.006$ 和 $1.002$。\n$\\Delta_{245} = 1.006 - 1.002 = 0.004$。\n\n$10$. 三元组 $\\{3,4,5\\}$：距离为 $\\{d_{34}, d_{35}, d_{45}\\} = \\{0.406, 0.398, 0.304\\}$。\n最大的两个值为 $0.406$ 和 $0.398$。\n$\\Delta_{345} = 0.406 - 0.398 = 0.008$。\n\n计算出的偏差集合为 $\\{0.004, 0.008, 0.002, 0.006, 0.012, 0.006, 0.010, 0.006, 0.004, 0.008\\}$。\n超度量偏差指数 $U$ 是这些值的最大值：\n$$\nU = \\max\\{0.004, 0.008, 0.002, 0.006, 0.012, 0.006, 0.010, 0.006, 0.004, 0.008\\} = 0.012.\n$$\n值 $0.012$ 是减法运算的精确结果。问题要求四舍五入到四位有效数字。$0.012$ 中的有效数字是 $1$ 和 $2$。要用四位有效数字表示，我们必须添加后缀零，得到 $0.01200$。\n\n最后，问题要求根据决策规则 $U \\leq \\delta$（阈值 $\\delta = 0.020$ 每个位点的替换数）来评估其合理性。我们计算出 $U = 0.012$。将其与阈值进行比较：\n$$\n0.012 \\leq 0.020.\n$$\n由于计算出的超度量偏差指数 $U$ 小于或等于指定的阈值 $\\delta$，因此根据给定的决策规则，严格分子钟（超度量性）的假设对于此数据集是合理的。\n最终要求的输出是四舍五入到四位有效数字的 $U$ 值。", "answer": "$$\\boxed{0.01200}$$", "id": "2743629"}, {"introduction": "在系统发育基因组学研究中，研究人员经常会遇到一个棘手的问题：使用最大似然法和贝叶斯推断等不同但同样强大的统计学方法分析同一数据集时，可能会得出相互冲突的进化树。这种方法论上的不一致性通常源于模型选择不当、数据质量问题（如替换饱和）或分析过程本身的缺陷（如MCMC链未收敛）。这个练习 [@problem_id:2307600] 旨在培养您的批判性思维和解决问题的能力，引导您设计一套系统的诊断流程来探究并解决这种方法间的冲突，从而确保系统发育推断的稳健性。", "problem": "一个病毒学家团队正在研究一种新出现的快速突变RNA病毒的进化。他们从不同的患者样本中获得了20个完整的病毒基因组序列。为了推断其进化历史，他们对这些基因组进行了多序列比对，并进行了两种独立的系统发育分析。\n\n第一种分析使用最大似然法（ML），通过软件RAxML实现。分支支持度通过1000次非参数自举重复进行评估。该分析以高自举值（95%）表明，来自患者A的病毒株是该进化分支中最基底的成员（即最先分化的）。\n\n第二种分析使用贝叶斯推断（BI），通过软件MrBayes实现。该分析包括运行四个独立的马尔可夫链蒙特卡罗（MCMC）链，共计2000万代，每1000代采样一次。最终得到的一致树强烈支持一种不同的拓扑结构，以后验概率0.99表明来自患者B的病毒株是最基底的谱系。\n\n这两种强大的统计方法之间出现的强烈冲突被称为方法论不一致性。该团队需要确定这种差异的潜在原因，以便对他们的进化结论有信心。\n\n以下哪种方法是调查此冲突来源的有效且有信息价值的后续步骤？选择所有适用项。\n\nA. 结论认为贝叶斯结果更可靠，因为其后验概率（0.99）在数值上高于ML的自举值（0.95），并且这两个指标是可直接比较的准确性度量。\n\nB. 使用像UPGMA（非加权配对算术平均法）这样的快速、基于算法的方法构建第三个系统发育树，以观察它支持哪一个冲突的假设（患者A为基底 vs. 患者B为基底）。\n\nC. 仔细检查贝叶斯分析的MCMC运行，以确保链已收敛。这包括检查诸如潜在尺度缩减因子（PSRF）接近1.0之类的诊断指标，并确保所有参数的有效样本量（ESS）远高于200。\n\nD. 通过绘制观察到的转换和颠换替换数量与遗传距离度量的关系图，系统地测试替换饱和。如果在某些数据分区（例如，密码子第三位）中检测到显著饱和，则在排除了这些饱和位点的比对上重新运行ML和BI分析。\n\nE. 使用正式的统计程序，如赤池信息准则（AIC），测试多种核苷酸替换模型以确定数据的最佳拟合模型，然后使用该最优模型重复ML和BI分析。", "solution": "我们通过诉诸系统发育推断、模型比较和MCMC诊断的核心原则来评估每种提议的方法。\n\n选项A是无效的。最大似然自举支持率和贝叶斯后验概率不是可直接比较的度量。自举支持率估计了在所选模型和方法下，一个进化分支在重采样数据集中被恢复的频率，而后验概率是在给定数据和先验概率的情况下，根据所选模型得出的进化分支的概率。它们的数值处于不同的尺度上，并受到不同不确定性来源的影响；因此，仅仅因为0.99大于0.95就断定贝叶斯结果更可靠是没有道理的，也无法解释方法论上的不一致性。\n\n选项B不是一个有信息价值的后续步骤。UPGMA假设一个超度量树（严格分子钟），并对成对距离使用简单的凝聚聚类。对于像快速进化的RNA病毒这样通常在谱系和位点间存在速率异质性的情况，UPGMA容易产生系统性误差和长枝吸引。引入第三种、不太合适的方法并不能诊断ML和BI之间冲突的原因，也不太可能为基底位置的判定提供可靠的裁决。因此，以这种方式使用UPGMA不是调查不一致性来源的有效方法。\n\n选项C是有效的。贝叶斯推断中一个至关重要的首要步骤是验证MCMC的收敛性和充分混合。检查诸如潜在尺度缩减因子接近$1.0$以及所有参数的有效样本量远高于$200$等诊断指标，有助于确保后验摘要（包括拓扑结构和进化分支支持度）是可靠的。收敛性差或ESS低可能导致误导性的后验概率和拓扑结构，从而直接解释与ML的冲突。\n\n选项D是有效的。替换饱和（尤其是在快速突变基因组的密码子第三位）会掩盖真实的系统发育信号，并引发方法依赖性偏差。通过绘制观察到的转换和颠换替换与遗传距离度量的关系图来检测平台期，可以识别饱和；如果存在饱和，排除饱和位点或对其进行适当的分区或建模可以消除误导性信号。在过滤后或重新分区的比对上重新运行ML和BI，可以直接检验饱和是否是不一致性的根本原因。\n\n选项E是有效的。模型错误设定是方法间拓扑冲突的常见来源。使用诸如AIC（或AICc/BIC）之类的形式化准则在核苷酸替换模型中进行选择，然后在使用最佳拟合模型的情况下重复ML和BI分析，可以解决由不充分模型引入的偏差。这可以调和或至少阐明分歧的来源。\n\n因此，有效且有信息价值的后续步骤是选项C、D和E。", "answer": "$$\\boxed{CDE}$$", "id": "2307600"}, {"introduction": "系统发育基因组学为检验复杂的进化假说（例如染色体倒位在物种形成中的作用）提供了强有力的工具。通过整合来自基因组不同区域的进化信号，我们可以重建复杂性状的演化历史。本练习 [@problem_id:2307569] 引导您综合运用分子钟理论、群体遗传学概念以及系统发育基因组学校正方法，来量化一个跨物种多态性（trans-species polymorphism）的持续时间。您将通过计算来检验一个关键的进化假说，即一个古老的染色体倒位是否先于物种形成事件出现，并可能驱动了物种分化。", "problem": "为了解两种亲缘关系密切的昆虫物种 *Divergens volans* 和 *Divergens quietus* 的物种形成基因组基础，我们对它们进行了研究。已知 *D. volans* 在其第三条染色体上存在一个大的染色体倒位，并表现出多态性，其个体携带标准（S）或倒位（I）排列。相比之下，其姐妹物种 *D. quietus* 被发现完全固定为倒位（I）排列。对一个远缘外群物种 *Divergens primus* 的遗传分析证实，该物种固定为标准（S）排列，从而确定 S 为祖先状态。\n\n一个主要假说认为，这种倒位是跨物种多态性的一个案例，即该倒位出现在 *D. volans* 和 *D. quietus* 的共同祖先种群中。根据该模型，在物种形成事件发生前，S 和 I 两种排列通过平衡选择被维持了相当长的一段时间，然后在两个子代谱系中被差异性地分选。\n\n为了检验这一假说，您获得了以下系统基因组学数据：\n1.  从 *D. volans* 种群内部采样的标准（S）和倒位（I）单倍型之间的平均成对核苷酸分歧，使用倒位内部的基因座计算得出，为 $d_{in} = 0.050$。\n2.  *D. volans* 和 *D. quietus* 之间的平均成对核苷酸分歧，使用远离倒位且重组频繁的大量常染色体基因座计算得出，为 $d_{out} = 0.031$。\n3.  该属的化石校准中性突变率为 $\\mu = 1.25 \\times 10^{-3}$ 替换数/位点/百万年。您可以使用分子钟公式 $T = \\frac{d}{2\\mu}$ 将分歧（$d$）与时间（$T$）联系起来，其中系数 2 表示分歧在两个独立的谱系上累积。\n4.  考虑了不完全谱系分选（ILS）等因素的先进种群统计模型揭示，在两个物种最初分化后，它们之间发生了持续的低水平基因流。这种基因渗入仅影响了基因组的自由重组区域（即倒位之外的区域）。这种基因流的可量化影响是，在这些非连锁基因座上观察到的分歧（$d_{out}$）得出的表观物种形成时间比真实的、实际的物种形成时间短 25%。\n\n基于以上信息，计算在导致 *D. volans* 和 *D. quietus* 的谱系分化之前，S/I 多态性在共同祖先种群中维持了多长时间（以百万年为单位）。请以百万年为单位表示您的答案，并四舍五入到两位有效数字。", "solution": "题目要求我们计算在物种形成分化之前，S/I 倒位多态性在共同祖先种群中维持的时间区间。设 $T_{\\text{inv}}$ 为倒位的年龄（即 S 和 I 单倍型类别开始分化的时间），$T_{\\text{spec}}$ 为真实的物种形成时间。所求的时长为\n$$\nT_{\\text{ancestral}}=T_{\\text{inv}}-T_{\\text{spec}}.\n$$\n\n根据分子钟，对于两个中性分化的谱系，\n$$\nT=\\frac{d}{2\\mu}.\n$$\n因此，使用 D. volans 内部倒位区域中 S 和 I 之间的分歧，\n$$\nT_{\\text{inv}}=\\frac{d_{\\text{in}}}{2\\mu}.\n$$\n\n对于物种形成时间，自由重组的基因座给出了一个表观时间\n$$\nT_{\\text{app}}=\\frac{d_{\\text{out}}}{2\\mu},\n$$\n但分化后的基因渗入使得这个表观时间比真实时间要短，为真实时间的 $1-0.25=0.75$ 倍，即\n$$\nT_{\\text{app}}=0.75\\,T_{\\text{spec}} \\quad \\Rightarrow \\quad T_{\\text{spec}}=\\frac{T_{\\text{app}}}{0.75}.\n$$\n\n综合起来，\n$$\nT_{\\text{ancestral}}=\\frac{d_{\\text{in}}}{2\\mu}-\\frac{1}{0.75}\\cdot\\frac{d_{\\text{out}}}{2\\mu}.\n$$\n\n现在代入给定值 $d_{\\text{in}}=0.050$、$d_{\\text{out}}=0.031$，以及 $\\mu=1.25 \\times 10^{-3}$ 替换数/位点/百万年：\n$$\nT_{\\text{inv}}=\\frac{0.050}{2\\cdot 1.25\\times 10^{-3}}=\\frac{0.050}{2.5\\times 10^{-3}}=20,\n$$\n$$\nT_{\\text{app}}=\\frac{0.031}{2\\cdot 1.25\\times 10^{-3}}=\\frac{0.031}{2.5\\times 10^{-3}}=12.4,\n$$\n$$\nT_{\\text{spec}}=\\frac{12.4}{0.75}=16.533\\overline{3},\n$$\n$$\nT_{\\text{ancestral}}=20-16.533\\overline{3}=3.466\\overline{6}.\n$$\n\n四舍五入到两位有效数字，结果是 $3.5$ 百万年。", "answer": "$$\\boxed{3.5}$$", "id": "2307569"}]}