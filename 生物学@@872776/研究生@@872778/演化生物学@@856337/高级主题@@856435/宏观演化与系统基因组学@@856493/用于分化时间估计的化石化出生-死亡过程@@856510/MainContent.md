## 引言
准确重建生命之树的时间尺度，即估计物种间的分化时间，是[演化生物学](@entry_id:145480)的核心任务之一。它不仅为我们理解生物多样性的起源和[演化速率](@entry_id:202008)提供了时间框架，也为探索生物演化与地球环境历史之间的联系奠定了基础。然而，仅凭现代物种的分子数据难以确定[绝对时间](@entry_id:265046)，这导致了传统定年方法（如节点定年法）严重依赖于对化石记录的主观解读和稀疏标定，其结果往往受制于研究者的先验假设。为了克服这些局限，[化石化生死过程](@entry_id:187738)（FBD）模型应运而生，提供了一个整合化石与分子数据的统一概率框架。

本文旨在系统性地介绍[化石化生死过程](@entry_id:187738)，并展示其在现代系统发育年代学中的强大应用。读者将通过三个循序渐进的章节，全面掌握这一前沿方法：

*   在**“原理与机制”**一章中，我们将深入剖析FBD模型的数学基础，解释其如何通过[物种形成](@entry_id:147004)、绝灭和化石采样这几个核心参数来模拟宏观[演化过程](@entry_id:175749)，并阐明其作为[贝叶斯分析](@entry_id:271788)中“树先验”的关键作用。
*   **“应用与跨学科联系”**一章将展示FBD模型如何应用于“[全证据定年](@entry_id:163840)”框架，整合分子、形态和[地层学](@entry_id:189703)证据来检验关于演化速率变化、关键创新、大灭绝事件及生物地理历史的复杂假说。
*   最后，在**“动手实践”**部分，我们通过一系列精心设计的练习，引导读者从理论走向实践，亲身体验模型的核心计算、理解潜在的分析偏差，并掌握评估模型假设的基本技能。

通过本文的学习，您将不仅理解FBD模型的“是什么”和“为什么”，更能掌握“如何”将其应用于自己的研究中，从而更严谨、更全面地揭示深时（deep time）中的演化奥秘。

## 原理与机制

本章旨在深入阐述[化石化生死过程](@entry_id:187738)（Fossilized Birth-Death, FBD）的理论基础和核心机制。作为整合化石与分子数据的现代[系统发育推断](@entry_id:182186)框架，FBD模型不仅为物种分化时间估计提供了强大的工具，也加深了我们对宏观演化动态的理解。我们将从该过程的基本构成要素出发，逐步解析其在[贝叶斯推断](@entry_id:146958)中的作用，并探讨与模型应用相关的关键概念和技术细节。

### [化石化生死过程](@entry_id:187738)：一个生成性模型

从根本上说，[化石化生死过程](@entry_id:187738)是一个[随机过程](@entry_id:159502)，它为包含现生和已灭绝谱系的系统发育树的生成提供了一个[概率模型](@entry_id:265150)。该模型由四个核心参数共同定义：物种形成率（speciation rate）、绝灭率（extinction rate）、化石[采样率](@entry_id:264884)（fossil sampling rate）和现生谱系采样概率（extant sampling probability）。

首先，FBD过程的核心是一个经典的**生死过程（birth-death process）**。在此过程中，每个独立的谱系在任何时刻都面临两种可能的[基本事件](@entry_id:265317)：以速率 $\lambda$ 发生**[物种形成](@entry_id:147004)（speciation）**，或以速率 $\mu$ 发生**绝灭（extinction）**。这里的速率表示单位时间内每个谱系发生相应事件的瞬时概率。物种形成事件对应于系统发育树中的一个[分叉](@entry_id:270606)节点，而绝灭事件则是一个谱系的终结。

FBD模型通过引入**化石采样（fossil sampling）**过程，将古生物学记录整合到生死过程中。化石的形成被建模为一个沿着每个存活谱系发生的**泊松过程（Poisson process）**，其速率为 $\psi$。这个参数 $\psi$ 代表每个谱系在单位时间内留下一个可被发现的化石的速率，其单位是 $[\text{时间}]^{-1}$（例如，每百万年每个谱系产生化石的期望数量）。理解 $\psi$ 的性质至关重要：它是一个速率，而非一个无量纲的概率。因此，$\psi$ 的取值可以大于 $1$。例如，如果时间单位是百万年，$\psi = 1.5$ 意味着平均每个谱系每百万年产生 $1.5$ 个化石。[@problem_id:2714643]

从更实际的古生物学角度看，$\psi$ 可以被理解为一个复合参数。假设化石床（fossil beds）的出现本身是一个速率为 $\beta$ 的泊松过程，而在每个化石床出现的瞬间，一个存活的谱系有概率 $p$ 被保存下来并被发现。在这种情况下，沿着单个谱系的化石发现事件，其有效速率就是 $\psi = \beta p$。因此，标准的FBD模型估计的是这个复合速率 $\psi$，而无法区分化石床的形成速率 $\beta$ 和单个谱系的保存概率 $p$。[@problem_id:2714643]

在整个演化历史中，当谱系树在时间 $t$ 有 $L(t)$ 个存活谱系时，整个[演化支](@entry_id:171685)产生化石的总[瞬时速率](@entry_id:182981)是 $L(t)\psi$。因此，在任何时间区间内，预期的化石总数等于 $\psi$ 乘以该区间内[系统发育树](@entry_id:140506)的总枝长（即所有谱系存活时长的总和）。[@problem_id:2714643]

最后，FBD模型考虑了在**现生时刻（present time）**（通常定义为时间 $0$）对存活谱系的**不完全采样**。每个在时间 $0$ 依然存活的谱系，会以概率 $\rho$ 被独立地采样并包含在我们的数据集中。这是一个**伯努利采样（Bernoulli sampling）**过程。

当 $\rho  1$ 时，即存在未被采样的现生谱系，模型必须对此进行解释。具体而言，FBD[似然函数](@entry_id:141927)的计算会包含两部分贡献：对于 $n$ 个被采样的现生[类群](@entry_id:182524)，会有一个因子 $\rho^n$；同时，对于树中任何一个祖先谱系，其必须至少留下一个被采样后代（无论是化石还是现生样本）的概率计算，会受到 $(1-\rho)$ 的影响，因为该祖先的某些现生后代可能因为未被采样而“丢失”。模型通过包含 $(1-\rho)$ 的项来整合这些未观测到的现生谱系。[@problem_id:2714546]

当 $\rho = 1$ 时，意味着所有现生谱系都被采样。这是一个特殊情况，模型似然函数会简化，因为不再有关于“错过”现生样本的概率项。参数 $\rho$ 在这种情况下会从[似然函数](@entry_id:141927)的大部分计算中消失。[@problem_id:2714546]

综上所述，FBD过程由四个参数 $(\lambda, \mu, \psi, \rho)$ 完整定义，它模拟了谱系随时间的分化、绝灭、化石记录的形成以及在现生时刻对幸存者的采样。重要的是，化石采样事件被视为在谱系存续期间发生的观察事件，它本身并不终止该谱系。这一特性引出了一个关键概念：**采样祖先**。[@problem_id:2714587]

### FBD过程下的树结构

FBD模型生成的[系统发育树](@entry_id:140506)具有独特的结构，因为它明确区分了不同类型的节点：物种形成节点、化石采样节点和现生类群节点。这其中，**采样祖先（sampled ancestor）**的概念尤为重要，也是FBD模型区别于许多其他[系统发育](@entry_id:137790)模型的关键特征之一。

一个**采样祖先**是指在时间 $t_f$ 被采样的化石，其所在的谱系在该采样事件之后并未绝灭，而是继续存续，并最终留下了至少一个其他的被采样后代（无论是另一个化石还是一个现生[类群](@entry_id:182524)）。在用于推断的重构树中，这样的化石被表示为一个[出度](@entry_id:263181)（outdegree）为 $1$ 的节点。这意味着有一条边从其祖先节点指向它，也有一条边从它指向其后代节点。该节点本身并不代表[物种形成](@entry_id:147004)事件（物种形成节点的[出度](@entry_id:263181)为 $2$）。[@problem_id:2714553]

与之相对的是**终端化石（terminal fossil tip）**。这是一个化石样本，其所在的谱系在重构树中没有留下任何其他被采样的后代。这可能是因为该谱系在被采样后不久就绝灭了，或者其所有后代谱系都未能留下任何（化石或现生的）样本。在树的图形表示中，这样的化石是一个[出度](@entry_id:263181)为 $0$ 的节点，即树的一个[叶节点](@entry_id:266134)（tip）。[@problem_id:2714553]

因此，FBD模型允许化石样本直接位于系统发育树的内部枝干上，而不仅仅是作为终端的[叶节点](@entry_id:266134)。这一特性为我们提供了一种更符合生物学实际的方式来整合化石证据，承认[化石记录](@entry_id:136693)中的样本可能直接是后来物种的祖先。

### FBD过程在[贝叶斯推断](@entry_id:146958)中的应用

FBD过程最重要的应用是在贝叶斯[系统发育分析](@entry_id:172534)中作为**树先验（tree prior）**，尤其是在**尖端定年（tip dating）**和**[全证据定年](@entry_id:163840)（total-evidence dating）**方法中。为了理解其优势，我们首先需要审视传统定年方法的局限性。

#### 传统节点定年法的局限

在FBD模型普及之前，**节点定年（node dating）**是估计分化时间的主要方法。该方法通常仅使用现生类群的分子序列数据。然而，仅凭分子数据本身难以确定绝对的分化时间。这是因为序列间的遗传距离（通常以每位点期望替换数计）是演化速率 $r$ 和时间 $t$ 的乘积 ($b = r \times t$)。在没有外部信息的情况下，我们无法唯一地从乘积 $b$ 中分离出速率 $r$ 和时间 $t$。例如，一个快速的演化速率和短时间，与一个慢速的演化速率和长时间，可能产生相同的遗传距离。这就是**速率-时间混淆（rate-time confounding）**的根本问题。[@problem_id:2714604] [@problem_id:2714582]

为了打破这种混淆，节点定年法依赖于外部的**节点标定（node calibration）**。研究者根据化石记录，为系统发育树中的某些内部节点（即特定演化支的[最近共同祖先](@entry_id:136722)）设置一个[先验概率](@entry_id:275634)[分布](@entry_id:182848)（例如，[对数正态分布](@entry_id:261888)或[均匀分布](@entry_id:194597)）来约束其年龄。这些化石本身并不作为分析中的[类群](@entry_id:182524)。[@problem_id:2714511]

这种方法的关键问题在于标定先验的选择带有很强的主观性。当分子数据的信息量有限时（例如，序列较短或演化速率变异较大），似然函数对于时间尺度的约束能力很弱。在这种情况下，[后验分布](@entry_id:145605)会过度地被研究者设定的标定先验所主导。分析结果可能更多地反映了研究者的先验假设，而非数据本身提供的信号。这种**先验主导（prior dominance）**现象，使得分化时间的估计结果对标定先验的微小变化非常敏感。[@problem_id:2714582]

#### 使用FBD先验的尖端定年与[全证据定年](@entry_id:163840)

**尖端定年（tip dating）**通过一种根本不同的方式来整合化石证据，从而有效缓解了节点定年的问题。在尖端定年框架下，化石不再被用作构建外部标定先验的间接证据，而是被直接作为带有确切地质年龄的**终端[类群](@entry_id:182524)（dated tips）**包含在[系统发育分析](@entry_id:172534)中。[@problem_id:2714511]

此时，FBD过程不再仅仅是一个理论模型，而是成为了一个**机制性的树先验**。它为包含了现生类群和化石尖端的整棵树的拓扑结构和节点年龄提供了联合先验概率。一棵树的先验概率，是根据其形成过程中发生的[物种形成](@entry_id:147004)、绝灭和化石采样事件的序列，由FBD模型的参数 $(\lambda, \mu, \psi, \rho)$ 计算得出的。[@problem_id:2714490]

这种方法的优越性在于，关于[绝对时间](@entry_id:265046)的信息不再来源于少数几个主观设定的节点先验，而是来源于[分布](@entry_id:182848)在整棵树上的多个化石尖端的绝对年龄。这些化石的年龄直接锚定了树的时间尺度。因为FBD先验本身就是关于[绝对时间](@entry_id:265046)的函数（例如，一个谱系在时间 $\Delta t$ 内未发生任何事件的概率与 $\Delta t$ 直接相关），它与拥有[绝对时间](@entry_id:265046)信息的化石数据相结合，能够有效地打破速率-时间的混淆。时间尺度由化石和FBD过程共同约束，分子数据则可以更准确地用于推断演化速率。这使得整个推断过程对任何单个化石或先验假设的敏感性大大降低。[@problem_id:2714604] [@problem_id:2714582]

**[全证据定年](@entry_id:163840)（total-evidence dating, TED）**是尖端定年的自然延伸。它在同一个分析框架中，整合了所有可用的数据源：现生[类群](@entry_id:182524)的分子数据、现生和化石[类群](@entry_id:182524)的[形态学](@entry_id:273085)数据，以及化石的地质年龄。[系统发育](@entry_id:137790)关系由分子和形态数据共同推断，而时间尺度则由FBD树先验和化石年龄共同校准。这是目前整合化石与分子数据进行分化时间估计最完整和最强大的方法。[@problem_id:2714511]

### 高级主题与[模型可辨识性](@entry_id:186414)

在实际应用FBD模型时，研究者还需要考虑一些更技术性的问题，例如如何对过程进行合理的条件化，以及模型参数是否能够被数据所唯一确定。

#### 过程的条件化：干群 vs. 冠群

我们观察到的[演化支](@entry_id:171685)，必然是经历了演化历史并存活至今的。因此，在进行[贝叶斯推断](@entry_id:146958)时，需要将FBD过程**条件化（condition）**在我们观察到“成功”演化支这一事实上。主要有两种条件化方案：**干群条件化（stem conditioning）**和**冠群条件化（crown conditioning）**。

**干群条件化**将分析的根节点设为该演化支的**起源时间（origin time）** $t_{\mathrm{or}}$，也称为干群年龄。推断过程条件化于“从 $t_{\mathrm{or}}$ 开始的谱系，至少留下了一个被采样的现生后代”这一事件。树先验的计算需要除以该事件发生的总概率。

**冠群条件化**则将分析的根节点设为所有被采样**现生**类群的[最近共同祖先](@entry_id:136722)，其年龄为**冠群年龄（crown age）** $t_{\mathrm{c}}$。该方案条件化于“从某个起源时间开始的谱系，至少留下了两个被采样的现生后代”这一事件（因为冠群的存在至少需要两个谱系）。这种方法在数学上更为复杂，因为它需要从以 $t_{\mathrm{or}}$ 为参数的模型，通过对干群部分的演化历史进行积分（边际化），转换到一个以 $t_{\mathrm{c}}$ 为参数的模型。[@problem_id:2714600]

选择哪种条件化方案取决于研究的问题和可用的化石信息。例如，如果有一个可靠的化石可以确定干群的最小年龄，那么干群条件化可能更合适。

#### 参数的[可辨识性](@entry_id:194150)

一个[统计模型](@entry_id:165873)的**可辨识性（identifiability）**问题，是指其参数是否能被数据唯一地确定。FBD模型虽然强大，但在某些数据受限的情况下，其参数也可能存在不可辨识的问题。

一个经典的例子是，如果我们只有**混合的（pooled）**化石出现时间数据，而没有任何系统发育树结构信息（即不知道哪个化石属于哪个谱系），那么我们将很难区分[物种形成](@entry_id:147004)率 $\lambda$ 和绝灭率 $\mu$。这是因为化石出现的强度（intensity）主要由**净分化率（net diversification rate）** $r = \lambda - \mu$ 和化石[采样率](@entry_id:264884) $\psi$ 决定。不同的 $(\lambda, \mu)$ 组合只要有相同的差值 $r$，就能产生非常相似的化石出现模式。在这种情况下，我们只能很好地估计 $r$ 和 $\psi$，而无法单独估计 $\lambda$ 和 $\mu$。这表明，[系统发育树](@entry_id:140506)的拓扑和分支时间信息，对于估计物种的**周转率（turnover）**（即 $\lambda$ 和 $\mu$ 的相对大小）至关重要。[@problem_id:2714493]

即使在[全证据定年](@entry_id:163840)的框架下，当数据信息量不足时，FBD模型的各个参数之间也可能存在较强的后验相关性，导致估计的不确定性增加。因此，在解释FBD模型的分析结果时，审慎评估参数的后验分布、相关性和收敛性是至关重要的一步。