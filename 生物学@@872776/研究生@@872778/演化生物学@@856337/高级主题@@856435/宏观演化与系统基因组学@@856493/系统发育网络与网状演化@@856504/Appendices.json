{"hands_on_practices": [{"introduction": "基于距离的方法，如NeighborNet，提供了一种从数据中直观地可视化演化冲突的有效途径。本练习 [@problem_id:2743224] 将指导您完成NeighborNet算法关键的第一步，展示网络的基本结构是如何从成对距离矩阵中产生的。通过亲手计算Q标准并构建环形排序，您将深入理解这些方法如何将非树状的距离信号转化为网状演化假说的图形表示。", "problem": "一个研究团队正在使用一种旨在恢复分裂网络的基于距离的方法，分析五个分类单元间的网状进化。他们计划使用 NeighborNet 算法的第一个凝聚步骤来初始化分类单元的环形排序，并由此构建一个网络。给定关于分类单元 $\\{A,B,C,D,E\\}$ 的对称距离矩阵 $D=\\left(d_{ij}\\right)$：\n$$\nD \\;=\\;\n\\begin{pmatrix}\n0  2  8  9  9 \\\\\n2  0  9  9  10 \\\\\n8  9  0  3  8 \\\\\n9  9  3  0  9 \\\\\n9  10  8  9  0\n\\end{pmatrix},\n$$\n其中 $(i,j)$ 项 $d_{ij}$ 是分类单元 $i$ 和 $j$ 之间的观测进化距离，且对所有 $i$ 都有 $d_{ii}=0$。假设这些距离是与标准序列进化随机模型一致的加性近似。\n\n使用凝聚式距离方法的基本原理，按以下步骤进行。\n\n- 使用邻接法 $Q$ 准则（正如 NeighborNet 算法第一步中，当所有簇都为单元簇时所应用的）来选择第一个凝聚对。对于具有两两之间距离 $d_{ij}$ 和行和 $r_i=\\sum_{k\\neq i} d_{ik}$ 的 $n$ 个分类单元，计算\n$$\nQ(i,j) \\;=\\; (n-2)\\,d_{ij} \\;-\\; r_i \\;-\\; r_j,\n$$\n当 $n=5$ 时，对所有无序对 $\\{i,j\\}$ 计算该值，并选择具有最小 $Q$ 值的对。\n\n- 从这个凝聚对 $(u,v)$ 开始，通过以下最近邻扩展规则生成所有五个分类单元的环形排序：用 $(u,v)$ 初始化一个排序；在每一步中，从剩余的分类单元中选择使 $\\min\\{d_{ux},\\,d_{vx}\\}$ 最小的分类单元 $x$，并将其连接到当前排序中它更近的那个末端（$u$ 端或 $v$ 端），若出现平局则选择 $r_x$ 较小者，若仍然持平则选择 $d_{ux}$ 较小者；连接后，相应地更新当前末端；重复此过程直到所有分类单元都被放置，从而获得一个在旋转和反转意义下唯一的环形排序。\n\n展示您的中间计算过程，包括 $r_i$ 值、$Q(i,j)$ 值、所选的配对以及构建的环形排序。然后，作为您最终报告的量，提供您为第一次凝聚找到的最小 $Q$ 值。将最终值表示为精确整数（不进行四舍五入）。最终答案中不要包含任何单位。", "solution": "题干已经过验证。\n\n**步骤 1：提取已知条件**\n- 分类单元集：$\\{A, B, C, D, E\\}$\n- 分类单元数量：$n=5$\n- 对称距离矩阵 $D = (d_{ij})$：\n$$\nD = \\begin{pmatrix}\n0  2  8  9  9 \\\\\n2  0  9  9  10 \\\\\n8  9  0  3  8 \\\\\n9  9  3  0  9 \\\\\n9  10  8  9  0\n\\end{pmatrix}\n$$\n- 凝聚的 $Q$ 准则：$Q(i,j) = (n-2)d_{ij} - r_i - r_j$\n- 行和定义：$r_i = \\sum_{k \\neq i} d_{ik}$\n- 环形排序构建规则：\n    1. 用使 $Q(i,j)$ 最小的对 $(u,v)$ 初始化排序。\n    2. 在每一步中，选择一个未放置的分类单元 $x$，使其最小化 $\\min\\{d_{ux}, d_{vx}\\}$，其中 $u$ 和 $v$ 是当前排序列表的末端。\n    3. 将 $x$ 连接到其更近的那个末端（$u$ 或 $v$）。\n    4. 若出现平局，首先选择 $r_x$ 较小者，然后选择 $d_{ux}$ 较小者。\n    5. 重复此过程直到所有分类单元都被放置。\n\n**步骤 2：使用提取的已知条件进行验证**\n对问题进行有效性评估。\n- **科学依据**：该问题基于邻接法（$Q$ 准则）和 NeighborNet 算法，这些是计算进化生物学中用于从距离数据构建系统发育树和网络的标准且成熟的方法。该前提具有科学合理性。\n- **良态问题**：该问题提供了所有必要的数据（距离矩阵 $D$）、定义（$r_i$ 和 $Q(i,j)$ 的公式）以及一个用于构建环形排序的完整、确定性的算法，包括明确的平局打破规则。保证存在唯一解。\n- **客观性**：该问题以精确、正式的语言陈述，没有歧义或主观陈述。\n- **完整性和一致性**：该问题是自洽的。矩阵的大小（$5 \\times 5$）与分类单元的数量（$n=5$）相匹配。没有信息缺失或相互矛盾。\n\n**步骤 3：结论与行动**\n该问题是有效的。这是一个关于应用已知系统发育算法的定义明确的计算练习。将提供完整解答。\n\n第一个任务是识别出使 $Q$ 准则最小化的分类单元对 $\\{i,j\\}$。这需要计算每个分类单元的行和 $r_i$，然后计算所有不同对的 $Q(i,j)$ 值。分类单元的数量为 $n=5$。\n\n首先，我们计算每个分类单元 $i \\in \\{A, B, C, D, E\\}$ 的行和 $r_i = \\sum_{k \\neq i} d_{ik}$。\n$$r_A = d_{AB} + d_{AC} + d_{AD} + d_{AE} = 2 + 8 + 9 + 9 = 28$$\n$$r_B = d_{BA} + d_{BC} + d_{BD} + d_{BE} = 2 + 9 + 9 + 10 = 30$$\n$$r_C = d_{CA} + d_{CB} + d_{CD} + d_{CE} = 8 + 9 + 3 + 8 = 28$$\n$$r_D = d_{DA} + d_{DB} + d_{DC} + d_{DE} = 9 + 9 + 3 + 9 = 30$$\n$$r_E = d_{EA} + d_{EB} + d_{EC} + d_{ED} = 9 + 10 + 8 + 9 = 36$$\n\n接下来，我们使用公式 $Q(i,j) = (n-2)d_{ij} - r_i - r_j$ 计算 $Q(i,j)$ 值。当 $n=5$ 时，公式变为 $Q(i,j) = 3 d_{ij} - r_i - r_j$。有 $\\binom{5}{2} = 10$ 个唯一的对需要评估。\n\n$Q(A,B) = 3 \\cdot d_{AB} - r_A - r_B = 3(2) - 28 - 30 = 6 - 58 = -52$\n$Q(A,C) = 3 \\cdot d_{AC} - r_A - r_C = 3(8) - 28 - 28 = 24 - 56 = -32$\n$Q(A,D) = 3 \\cdot d_{AD} - r_A - r_D = 3(9) - 28 - 30 = 27 - 58 = -31$\n$Q(A,E) = 3 \\cdot d_{AE} - r_A - r_E = 3(9) - 28 - 36 = 27 - 64 = -37$\n$Q(B,C) = 3 \\cdot d_{BC} - r_B - r_C = 3(9) - 30 - 28 = 27 - 58 = -31$\n$Q(B,D) = 3 \\cdot d_{BD} - r_B - r_D = 3(9) - 30 - 30 = 27 - 60 = -33$\n$Q(B,E) = 3 \\cdot d_{BE} - r_B - r_E = 3(10) - 30 - 36 = 30 - 66 = -36$\n$Q(C,D) = 3 \\cdot d_{CD} - r_C - r_D = 3(3) - 28 - 30 = 9 - 58 = -49$\n$Q(C,E) = 3 \\cdot d_{CE} - r_C - r_E = 3(8) - 28 - 36 = 24 - 64 = -40$\n$Q(D,E) = 3 \\cdot d_{DE} - r_D - r_E = 3(9) - 30 - 36 = 27 - 66 = -39$\n\n比较计算出的 $Q$ 值：$\\{-52, -32, -31, -37, -31, -33, -36, -49, -40, -39\\}$。最小值为 $-52$，对应于配对 $\\{A, B\\}$。这是第一个凝聚对。\n\n要求报告的最终量是这个最小 $Q$ 值。然而，为了按照指示保持完整性，我们继续构建环形排序。\n\n初始排序为 $(A, B)$。排序的末端是 $u=A$ 和 $v=B$。剩余未放置的分类单元是 $\\{C, D, E\\}$。\n\n**迭代 1：**\n我们必须从 $\\{C, D, E\\}$ 中选择使 $\\min\\{d_{Ax}, d_{Bx}\\}$ 最小的分类单元 $x$。\n- 对于 $x=C$：$\\min\\{d_{AC}, d_{BC}\\} = \\min\\{8, 9\\} = 8$。\n- 对于 $x=D$：$\\min\\{d_{AD}, d_{BD}\\} = \\min\\{9, 9\\} = 9$。\n- 对于 $x=E$：$\\min\\{d_{AE}, d_{BE}\\} = \\min\\{9, 10\\} = 9$。\n最小值为 $8$，所以我们选择分类单元 $C$。我们将 $C$ 连接到它更近的那个末端。由于 $d_{AC} = 8$ 小于 $d_{BC} = 9$，我们将 $C$ 连接到 $A$ 端。\n新的排序是 $(C, A, B)$。现在的末端是 $u=C$ 和 $v=B$。剩余的分类单元是 $\\{D, E\\}$。\n\n**迭代 2：**\n我们从 $\\{D, E\\}$ 中选择使 $\\min\\{d_{Cx}, d_{Bx}\\}$ 最小的分类单元 $x$。\n- 对于 $x=D$：$\\min\\{d_{CD}, d_{BD}\\} = \\min\\{3, 9\\} = 3$。\n- 对于 $x=E$：$\\min\\{d_{CE}, d_{BE}\\} = \\min\\{8, 10\\} = 8$。\n最小值为 $3$，所以我们选择分类单元 $D$。我们将 $D$ 连接到它更近的那个末端。由于 $d_{CD} = 3$ 小于 $d_{BD} = 9$，我们将 $D$ 连接到 $C$ 端。\n新的排序是 $(D, C, A, B)$。现在的末端是 $u=D$ 和 $v=B$。唯一剩余的分类单元是 $\\{E\\}$。\n\n**迭代 3：**\n最后一个分类单元是 $E$。我们必须将它连接到 $D$ 端或 $B$ 端。\n我们比较 $d_{DE} = 9$ 和 $d_{BE} = 10$。由于 $d_{DE}  d_{BE}$，我们将 $E$ 连接到 $D$ 端。\n最终的线性排序是 $(E, D, C, A, B)$。这对应于环形排序 $(A-B-E-D-C-A)$。\n\n因此，中间计算过程如下：\n- 行和：$r_A=28, r_B=30, r_C=28, r_D=30, r_E=36$。\n- $Q$ 值：$Q(A,B)=-52$, $Q(A,C)=-32$, $Q(A,D)=-31$, $Q(A,E)=-37$, $Q(B,C)=-31$, $Q(B,D)=-33$, $Q(B,E)=-36$, $Q(C,D)=-49$, $Q(C,E)=-40$, $Q(D,E)=-39$。\n- 所选配对：$\\{A, B\\}$，最小 $Q$ 值为 $-52$。\n- 构建的环形排序：$(A, B, E, D, C)$（在旋转和反转意义下唯一）。\n\n问题要求的是为第一次凝聚找到的最小 $Q$ 值。该值已确定为 $-52$。", "answer": "$$\\boxed{-52}$$", "id": "2743224"}, {"introduction": "系统发育网络不仅是一个图形，它更是一个关于基因层面历史的概率模型。带有遗传概率（$\\gamma$）的网状节点定义了网络中“展示”不同基因树的可能性。本练习 [@problem_id:2743232] 要求您在给定一个具有明确网状事件和相关概率的网络下，计算一个特定基因树拓扑的概率。通过这个计算，您将巩固对网络如何定量描述群体基因组中混合演化历史的理解。", "problem": "一个以 $a$、$b$、$c$ 和 $d$ 为叶的有根二叉系统发育网络的定义如下。根节点 $\\rho$ 在一个内部分叉点分裂成两个祖先谱系，产生内部节点 $L$ 和 $M$。节点 $L$ 物种形成叶节点 $a$ 和一个延续谱系 $L'$。节点 $M$ 物种形成叶节点 $d$ 和一个延续谱系 $M'$。随后发生两个网状进化事件：\n- 网状进化事件 $R_1$ 的父节点是 $L'$ 和 $M'$，其唯一的子节点直接导向叶节点 $b$。在此网状进化事件中，单位点从父节点 $L'$ 遗传的概率为 $\\gamma_1$，从 $M'$ 遗传的概率为 $1-\\gamma_1$。\n- 网状进化事件 $R_2$ 的父节点是 $L'$ 和 $M'$，其唯一的子节点直接导向叶节点 $c$。在此网状进化事件中，单位点从父节点 $L'$ 遗传的概率为 $\\gamma_2$，从 $M'$ 遗传的概率为 $1-\\gamma_2$。\n\n假设采用标准的单位点、无重组的网状进化模型：在每个网状进化事件中，根据其遗传概率精确选择一条传入的父系边，不同网状进化事件的选择是相互独立的，并且通过压缩所有入度为 $1$ 和出度为 $1$ 的节点，将得到的有向无环图简化为所显示的根树。\n\n设遗传概率为 $\\gamma_1 = 0.73$ 和 $\\gamma_2 = 0.41$。计算所显示的根树具有拓扑结构 $T = ((a,b),(c,d))$ 的概率。请以 $[0,1]$ 范围内的精确小数形式给出答案。", "solution": "该问题要求计算在单位点遗传模型下，从一个给定的系统发育网络中实现特定根树拓扑结构 $T = ((a,b),(c,d))$ 的概率。该过程由网状进化事件中的随机选择决定。\n\n首先，我们必须形式化系统发育网络的结构以及从中生成树的过程。该网络包含四个叶：$a$、$b$、$c$ 和 $d$。根节点 $\\rho$ 分叉为节点 $L$ 和 $M$。节点 $L$ 产生叶节点 $a$ 和一个内部谱系 $L'$。节点 $M$ 产生叶节点 $d$ 和一个内部谱系 $M'$。存在两个网状进化节点 $R_1$ 和 $R_2$，它们分别决定了叶节点 $b$ 和 $c$ 的祖先。$R_1$ 和 $R_2$ 都有相同的父系谱系 $L'$ 和 $M'$。\n\n通过解析每个网状进化事件来生成单位点树。在每个网状进化节点，会选择两个父系谱系中的一个。这些选择是独立事件。\n- 对于源自网状进化事件 $R_1$ 的叶节点 $b$，其父系谱系为 $L'$ 的概率是 $\\gamma_1$，为 $M'$ 的概率是 $1-\\gamma_1$。\n- 对于源自网状进化事件 $R_2$ 的叶节点 $c$，其父系谱系为 $L'$ 的概率是 $\\gamma_2$，为 $M'$ 的概率是 $1-\\gamma_2$。\n\n由于存在两个独立的二元选择，因此有 $2 \\times 2 = 4$ 种可能的生成树。我们必须分析这四种可能结果中每一种的拓扑结构，并计算它们各自的概率。\n\n让我们将叶节点 $x$ 的父节点选择表示为 $x \\leftarrow P$，其中 $P$ 是父系谱系。\n\n情况1：$b \\leftarrow L'$ 且 $c \\leftarrow L'$。\n这个联合事件的概率是 $P_1 = \\gamma_1 \\gamma_2$。\n在这种情况下，从根节点 $\\rho$到各叶节点的路径是：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $b$ 的路径：$\\rho \\to L \\to L' \\to R_1 \\to b$\n- 到 $c$ 的路径：$\\rho \\to L \\to L' \\to R_2 \\to c$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n叶节点 $b$ 和 $c$ 的最近共同祖先 (MRCA) 是节点 $L'$ 的后代。$a$ 与 $(b,c)$ 对的 MRCA 是节点 $L$。分支 $(a,b,c)$ 与叶节点 $d$ 的 MRCA 是根节点 $\\rho$。在压缩入度为1和出度为1的节点后，得到的树拓扑结构是 $((a,(b,c)),d)$。这不是目标拓扑结构。\n\n情况2：$b \\leftarrow L'$ 且 $c \\leftarrow M'$。\n这个联合事件的概率是 $P_2 = \\gamma_1 (1-\\gamma_2)$。\n从根节点 $\\rho$到各叶节点的路径是：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $b$ 的路径：$\\rho \\to L \\to L' \\to R_1 \\to b$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n- 到 $c$ 的路径：$\\rho \\to M \\to M' \\to R_2 \\to c$\n在压缩单分叉节点（如 $L'$, $M'$, $R_1$, $R_2$）后，基本的分支结构变为：\n- 到达 $a$ 的谱系和到达 $b$ 的谱系在节点 $L$ 处合并。因此，MRCA($a,b$) 是 $L$。\n- 到达 $c$ 的谱系和到达 $d$ 的谱系在节点 $M$ 处合并。因此，MRCA($c,d$) 是 $M$。\n两个分支 $(a,b)$ 和 $(c,d)$ 在根节点 $\\rho$ 处合并。\n得到的树拓扑结构是 $((a,b),(c,d))$。这与目标拓扑结构 $T$ 相匹配。\n\n情况3：$b \\leftarrow M'$ 且 $c \\leftarrow L'$。\n这个联合事件的概率是 $P_3 = (1-\\gamma_1) \\gamma_2$。\n从根节点 $\\rho$到各叶节点的路径是：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $c$ 的路径：$\\rho \\to L \\to L' \\to R_2 \\to c$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n- 到 $b$ 的路径：$\\rho \\to M \\to M' \\to R_1 \\to b$\n通过与情况2类似的分析，MRCA($a,c$) 是节点 $L$，而 MRCA($b,d$) 是节点 $M$。得到的树拓扑结构是 $((a,c),(b,d))$。这不是目标拓扑结构。\n\n情况4：$b \\leftarrow M'$ 且 $c \\leftarrow M'$。\n这个联合事件的概率是 $P_4 = (1-\\gamma_1) (1-\\gamma_2)$。\n从根节点 $\\rho$到各叶节点的路径是：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $b$ 的路径：$\\rho \\to M \\to M' \\to R_1 \\to b$\n- 到 $c$ 的路径：$\\rho \\to M \\to M' \\to R_2 \\to c$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n$b$ 和 $c$ 的 MRCA 是节点 $M'$ 的后代。$(b,c)$ 对与叶节点 $d$ 的 MRCA 是节点 $M$。分支 $(b,c,d)$ 与叶节点 $a$ 的 MRCA 是根节点 $\\rho$。得到的树拓扑结构是 $(a,(d,(b,c)))$，也可以写成 $(a,((b,c),d))$。这不是目标拓扑结构。\n\n目标拓扑结构 $T = ((a,b),(c,d))$ 仅由情况2产生。因此，观察到拓扑结构 $T$ 的概率，记作 $P(T)$，等于情况2的概率。\n$$P(T) = P_2 = \\gamma_1 (1 - \\gamma_2)$$\n我们已知遗传概率的数值为：$\\gamma_1 = 0.73$ 和 $\\gamma_2 = 0.41$。将这些值代入 $P(T)$ 的表达式中：\n$$P(T) = 0.73 \\times (1 - 0.41)$$\n$$P(T) = 0.73 \\times 0.59$$\n计算很简单：\n$$P(T) = 0.4307$$\n此结果是所要求的精确小数。", "answer": "$$\\boxed{0.4307}$$", "id": "2743232"}, {"introduction": "在构建复杂的系统发育网络之前，一个关键步骤是判断一个更简单的模型，例如仅考虑不完全谱系分选（ILS）的物种树，是否足以解释数据。本练习 [@problem_id:2743287] 使用四分类群协调因子来探索ILS与网状演化之间的界限。您将推导并应用一个基本检验，以判断观测到的基因树频率是否仅与ILS过程相符，从而掌握一个用于诊断是否存在网状演化的有力工具。", "problem": "考虑一个由四个物种组成的四元组，其有三种可能的无根基因树拓扑，由分裂 $(ab|cd)$、$(ac|bd)$ 和 $(ad|bc)$ 表示。设观察到的四元组一致性因子（支持三种已解析拓扑中每一种的基因座比例）为 $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$，它们满足 $q_{ab|cd} + q_{ac|bd} + q_{ad|bc} = 1$ 以及对于所有三种拓扑都有 $q_{ij|kl} \\ge 0$。假设有大量独立的基因座，因此可以忽略抽样噪音，并假设采用无基因流的多物种溯祖（MSC）模型，物种树上存在一个长度为 $x$（以溯祖单位计）的内部支。在无网状进化的 MSC 模型下，不完全谱系分选（ILS）是与主导拓扑产生不一致性的唯一来源。\n\n从 MSC 的第一性原理出发（谱系在群体内以每对每溯祖单位为 1 的速率发生溯祖；未能在内部支上溯祖的谱系会进入祖先群体，其中三个谱系间的成对溯祖是可交换的），推导当不一致性仅由某个物种树拓扑和某个内部支长度 $x \\ge 0$ 上的 ILS 引起时，预期的一致性因子三元组必须满足的充分必要约束条件。使用这些约束条件来检验一个给定的观测三元组是否可以仅由主导拓扑（三元组中具有最大坐标值的拓扑）的 ILS 来解释。\n\n对于下面的每个选项，三元组按 $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$ 的顺序列出。选择所有其与主导拓扑的偏差可以完全由 MSC 模型下某个内部支长度 $x \\ge 0$ 的 ILS 解释的选项（即，该三元组位于其主导拓扑的 MSC 溯祖锥内）。\n\nA. $\\left(\\dfrac{29}{50}, \\dfrac{21}{100}, \\dfrac{21}{100}\\right)$\n\nB. $\\left(\\dfrac{2}{5}, \\dfrac{3}{10}, \\dfrac{3}{10}\\right)$\n\nC. $\\left(\\dfrac{7}{10}, \\dfrac{1}{10}, \\dfrac{2}{10}\\right)$\n\nD. $\\left(\\dfrac{8}{25}, \\dfrac{17}{50}, \\dfrac{17}{50}\\right)$", "solution": "问题要求在多物种溯祖（MSC）模型下，以不完全谱系分选（ILS）作为基因树不一致性的唯一来源，推导四元组一致性因子 $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$ 所受的约束条件。然后，这些约束条件将用于评估给定的四个一致性因子三元组的有效性。\n\n首先，我们来推导预期一致性因子与物种树内部支长度之间的关系。不失一般性，假设无根物种树的拓扑为 $((a,b),(c,d))$，对应于分裂 $(ab|cd)$。设将 $(a,b)$ 支系与 $(c,d)$ 支系分开的内部支长度为 $x$，以溯祖单位计量。根据题意，我们假设有大量独立的基因座，因此观察到的一致性因子 $q$ 可以视为每种基因树拓扑的预期概率 $p$。\n\n设 $p_{ab|cd}$、$p_{ac|bd}$ 和 $p_{ad|bc}$ 分别为观察到该四元组三种可能的无根基因树拓扑的概率。在 MSC 模型下，基因树拓扑由追溯四个谱系（每个物种 $\\{a,b,c,d\\}$ 各一个）向后追溯时发生的溯祖事件序列决定。\n\n题目陈述为推导提供了一个关键提示：“未能在内部支上溯祖的谱系会进入祖先群体，其中三个谱系间的成对溯祖是可交换的”。这描述了三分类单元树的标准模型，我们可以将其应用于四分类单元的情况。考虑物种树 $((a,b),(c,d))$，让我们从现在开始向后追溯谱系 $l_a, l_b, l_c, l_d$。由于假设有大量从平稳过程中抽取的基因座，我们可以通过首先假设两个谱系（例如 $l_c$ 和 $l_d$）已经溯祖成一个单一的祖先谱系 $L_{cd}$ 来概念化这个过程。现在，我们考虑三个谱系 $l_a, l_b$ 和 $L_{cd}$ 在物种树 $((a,b), (cd))$ 上的演化。\n\n谱系 $l_a$ 和 $l_b$ 进入它们的共同祖先群体，该群体存在的时间对应于长度为 $x$ 的内部支，之后与包含谱系 $L_{cd}$ 的群体合并。\n\n两个谱系 $l_a$ 和 $l_b$ 在这个长度为 $x$ 的分支内发生溯祖的概率由 $P(\\text{溯祖}) = 1 - e^{-x}$ 给出。如果此事件发生，产生的基因树将首先将 $a$ 和 $b$ 分组在一起，得到拓扑 $(ab|cd)$，这与物种树一致。\n\n$l_a$ 和 $l_b$ 未能在此内部支上溯祖的概率为 $P(\\text{不溯祖}) = e^{-x}$。在这种情况下，三个不同的谱系——$l_a$、$l_b$ 和 $L_{cd}$——进入三分类单元子树根部的更深层祖先群体。在这个深层群体中，物种树是未解析的（“星状”系统发育），任何一对谱系首先发生溯祖的可能性都相等。三种可能的配对是 $(l_a, l_b)$、$(l_a, L_{cd})$ 和 $(l_b, L_{cd})$。每对首先发生溯祖的概率都是 $\\dfrac{1}{3}$。\n\n*   如果 $(l_a, l_b)$ 首先溯祖，基因树拓扑为 $(ab|cd)$。此路径的概率是 $e^{-x} \\cdot \\dfrac{1}{3}$。\n*   如果 $(l_a, L_{cd})$ 首先溯祖，谱系 $a$ 与 $c$ 和 $d$ 的祖先分组。无根拓扑为 $((a,(c,d)),b)$，对应于分裂 $(ac|bd)$。此路径的概率是 $e^{-x} \\cdot \\dfrac{1}{3}$。\n*   如果 $(l_b, L_{cd})$ 首先溯祖，谱系 $b$ 与 $c$ 和 $d$ 的祖先分组。无根拓扑为 $((b,(c,d)),a)$，对应于分裂 $(ad|bc)$。此路径的概率是 $e^{-x} \\cdot \\dfrac{1}{3}$。\n\n将每种拓扑的概率相加：\n一致拓扑 $(ab|cd)$ 的概率是在内部支上溯祖的概率与在深层祖先群体中相应溯祖的概率之和：\n$$p_{ab|cd} = (1 - e^{-x}) + \\dfrac{1}{3}e^{-x} = 1 - \\dfrac{2}{3}e^{-x}$$\n两种不一致拓扑的概率是：\n$$p_{ac|bd} = \\dfrac{1}{3}e^{-x}$$\n$$p_{ad|bc} = \\dfrac{1}{3}e^{-x}$$\n\n设主导拓扑的观测一致性因子为 $q_1$，两个次要拓扑的为 $q_2$ 和 $q_3$。为了使数据能够仅由某个物种树上的 ILS 解释，必须满足以下充分必要条件：\n1.  两个次要（不一致）一致性因子必须相等：$q_2 = q_3$。这是由深层祖先群体中溯祖过程的对称性引起的。\n2.  分支长度 $x$ 必须为非负数，$x \\ge 0$。关系式 $q_2 = \\dfrac{1}{3}e^{-x}$ 意味着 $e^{-x} = 3q_2$。对于 $x \\ge 0$，我们需要 $e^{-x} \\le 1$，即 $3q_2 \\le 1$，或 $q_2 \\le \\dfrac{1}{3}$。由于 $q_3 = q_2$，这也意味着 $q_3 \\le \\dfrac{1}{3}$。\n\n如果第一个条件满足且各因子之和为1，则条件 $q_1+2q_2=1$（因为 $q_2=q_3$ 且 $\\sum q_i=1$）会自动满足。条件 $q_1 \\ge 1/3$ 是 $q_2 \\le 1/3$ 的直接结果。因此，对于给定的 $q_1$ 是最大坐标的三元组，约束条件简化为：\n(i) 两个较小的坐标必须相等。\n(ii) 较小坐标的值不得超过 $\\dfrac{1}{3}$。\n\n我们现在用这些约束来检验每个选项。\n\n**A. $\\left(\\dfrac{29}{50}, \\dfrac{21}{100}, \\dfrac{21}{100}\\right)$**\n我们将坐标写成小数形式：$(0.58, 0.21, 0.21)$。\n主导拓扑是第一个，其 $q_1 = 0.58$。次要一致性因子为 $q_2 = 0.21$ 和 $q_3 = 0.21$。\n1.  检查次要因子是否相等：$q_2 = q_3$ ($0.21 = 0.21$)。此条件满足。\n2.  检查次要因子的上限：$q_2 = 0.21 \\le \\dfrac{1}{3} \\approx 0.333$。此条件满足。\n两个条件都满足。这个三元组可以仅由具有拓扑 $(ab|cd)$ 的物种树上的 ILS 解释。相应的内部支长度为 $x = -\\ln(3q_2) = -\\ln(3 \\times 0.21) = -\\ln(0.63) \\ge 0$。\n**结论：正确**\n\n**B. $\\left(\\dfrac{2}{5}, \\dfrac{3}{10}, \\dfrac{3}{10}\\right)$**\n我们将坐标写成小数形式：$(0.4, 0.3, 0.3)$。\n主导拓扑是第一个，其 $q_1 = 0.4$。次要一致性因子为 $q_2 = 0.3$ 和 $q_3 = 0.3$。\n1.  检查次要因子是否相等：$q_2 = q_3$ ($0.3 = 0.3$)。此条件满足。\n2.  检查次要因子的上限：$q_2 = 0.3 \\le \\dfrac{1}{3} \\approx 0.333$。此条件满足。\n两个条件都满足。这个三元组可以仅由具有拓扑 $(ab|cd)$ 的物种树上的 ILS 解释。相应的内部支长度为 $x = -\\ln(3q_2) = -\\ln(3 \\times 0.3) = -\\ln(0.9) \\ge 0$。\n**结论：正确**\n\n**C. $\\left(\\dfrac{7}{10}, \\dfrac{1}{10}, \\dfrac{2}{10}\\right)$**\n我们将坐标写成小数形式：$(0.7, 0.1, 0.2)$。\n主导拓扑是第一个，其 $q_1 = 0.7$。次要一致性因子为 $q_2 = 0.1$ 和 $q_3 = 0.2$。\n1.  检查次要因子是否相等：$q_2 \\ne q_3$ ($0.1 \\ne 0.2$)。此条件不满足。\n不一致拓扑中的不对称性无法仅由 ILS 解释，这表明可能存在其他进化过程，如网状进化。\n**结论：错误**\n\n**D. $\\left(\\dfrac{8}{25}, \\dfrac{17}{50}, \\dfrac{17}{50}\\right)$**\n我们将坐标写成小数形式：$(0.32, 0.34, 0.34)$。\n最大的坐标值为 $0.34$，对应于两种拓扑：$(ac|bd)$ 和 $(ad|bc)$。没有唯一的主导拓扑。问题要求评估主导拓扑的一致性。这种情况是模糊的，但我们可以测试每种可能性。\n假设物种树对应于拓扑 $(ac|bd)$。那么主导一致性因子是 $q_1' = q_{ac|bd} = 0.34$。两个次要因子必须是另外两种拓扑 $(ab|cd)$ 和 $(ad|bc)$ 的频率，即 $q_2' = 0.32$ 和 $q_3' = 0.34$。\n1.  检查次要因子是否相等：$q_2' \\ne q_3'$ ($0.32 \\ne 0.34$)。此条件不满足。\n如果我们假设物种树是 $(ad|bc)$，也会得到相同的结论。\n此外，两个所谓的次要频率必须小于或等于 $\\dfrac{1}{3}$。在这里，非主导频率（$0.32$ 和 $0.34$）中的一个或两个都是不一致频率的候选者。值 $0.34$ 大于 $\\dfrac{1}{3} \\approx 0.333$。在 MSC 模型下，一个不一致的基因树拓扑的概率不能大于 $\\dfrac{1}{3}$。这提供了第二个独立的拒绝理由。\n因此，对于任何物种树拓扑，这个三元组都与 MSC/ILS 模型不一致。\n**结论：错误**", "answer": "$$\\boxed{AB}$$", "id": "2743287"}]}