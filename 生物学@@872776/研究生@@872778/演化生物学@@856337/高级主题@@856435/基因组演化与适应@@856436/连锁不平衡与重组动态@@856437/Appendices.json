{"hands_on_practices": [{"introduction": "重组是打破基因座之间关联的主要力量，理解其衰减速率是群体遗传学的基础。本练习将引导您从第一性原理推导连锁不平衡（$D$）的衰减方程。通过解决这个问题[@problem_id:2728798]，您将核心掌握物理距离（通过重组分数 $r$）如何决定遗传关联随时间推移的持续性。", "problem": "考虑一个大型、随机交配、世代不重叠的群体，其演化过程不受选择、突变和迁移的影响。两个双等位基因座，记为 $A/a$ 和 $B/b$，位于同一条染色体上，它们之间的重组率为 $r$，其中 $0  r \\le \\frac{1}{2}$。设第 $t$ 代的单倍型频率为 $p_{AB,t}$、$p_{Ab,t}$、$p_{aB,t}$ 和 $p_{ab,t}$，它们的总和为 $1$。设等位基因频率为 $p_{A,t} = p_{AB,t} + p_{Ab,t}$ 和 $p_{B,t} = p_{AB,t} + p_{aB,t}$。定义双基因座连锁不平衡（LD）系数为 $D_t = p_{AB,t} - p_{A,t} p_{B,t}$。\n\n仅从这些定义和重组率为 $r$ 的孟德尔重组出发，首先推导出单倍型频率 $p_{AB,t+1}$ 关于 $p_{AB,t}$、$p_{Ab,t}$、$p_{aB,t}$、$p_{ab,t}$ 和 $r$ 的递归式。然后用它来获得 $D_t$ 作为 $t$、$r$ 和 $D_0$ 的函数的闭式表达式。\n\n最后，对于 $r = 0.02$ 的情况，计算使得 $|D_t| \\leq \\frac{1}{2} |D_0|$ 成立所需的最小整数代数 $t_{\\frac{1}{2}}$。以整数形式报告 $t_{\\frac{1}{2}}$（无单位）。", "solution": "所陈述的问题在科学上是合理的、自洽的且提法得当。它代表了经典群体遗传学中的一个基本练习。我们将进行推导和计算。\n\n问题包含三个部分。首先，我们必须推导出单倍型频率 $p_{AB,t+1}$ 的递归式。其次，我们必须推导出连锁不平衡系数 $D_t$ 的闭式表达式。第三，我们必须计算在特定重组率下连锁不平衡的半衰期。\n\n第一部分：推导 $p_{AB,t+1}$ 的递归式\n\n我们考虑一个大型的随机交配群体。第 $t+1$ 代配子库中任何单倍型的频率取决于第 $t$ 代的频率以及包含重组的减数分裂过程。第 $t+1$ 代中的一个 $AB$ 单倍型可以通过以下两种方式之一形成：\n\n1. 它是未经重组而传递的亲本 $AB$ 单倍型的直接拷贝。第 $t$ 代配子库中 $AB$ 单倍型的频率是 $p_{AB,t}$。这样一个单倍型在 $A$ 和 $B$ 基因座之间不发生重组的概率是 $(1-r)$。因此，非重组配子对下一代 $AB$ 频率的贡献是 $(1-r)p_{AB,t}$。\n\n2. 它是由重组事件新形成的。在一个随机交配的群体中，个体中进行减数分裂的两条同源染色体是从上一代的配子库中独立抽取的。如果一条亲本染色体携带等位基因 $A$ 而另一条携带等位基因 $B$，并且它们之间发生了一次交换，就会形成一个新的 $AB$ 单倍型。抽到一条带有等位基因 $A$ 的染色体的概率是 $p_{A,t}$，抽到一条带有等位基因 $B$ 的染色体的概率是 $p_{B,t}$。由于随机交配，由含有这些等位基因的配子（以任何组合形式存在于两条染色体上）形成的合子频率为重组提供了来源。重组将一条染色体上的 $A$ 等位基因和同源染色体上的 $B$ 等位基因组合到一条新的染色体上的总频率，由重组率 $r$ 与群体中相应等位基因的频率 $p_{A,t}$ 和 $p_{B,t}$ 的乘积给出。这对下一代 $AB$ 的频率贡献了 $r p_{A,t} p_{B,t}$。\n\n结合这两种可能性，第 $t+1$ 代中 $AB$ 单倍型的总频率是这两部分贡献的总和：\n$$p_{AB, t+1} = (1-r)p_{AB,t} + r p_{A,t} p_{B,t}$$\n这就是所求的单倍型频率 $p_{AB,t+1}$ 的递归式。\n\n第二部分：推导 $D_t$ 的闭式表达式\n\n第 $t$ 代的连锁不平衡系数定义为 $D_t = p_{AB,t} - p_{A,t} p_{B,t}$。我们寻求一个用 $D_0$、$r$ 和 $t$ 表示 $D_t$ 的表达式。\n\n首先，我们确定在给定条件下（没有选择、突变或迁移），等位基因频率在各代之间是恒定的。第 $t+1$ 代中等位基因 $A$ 的频率是 $p_{A,t+1} = p_{AB,t+1} + p_{Ab,t+1}$。一个与为 $p_{AB,t+1}$ 推导出的递归式类似的递归式也适用于 $p_{Ab,t+1}$：\n$$p_{Ab, t+1} = (1-r)p_{Ab,t} + r p_{A,t} p_{b,t}$$\n其中 $p_{b,t} = 1 - p_{B,t}$。\n将这些代入 $p_{A,t+1}$ 的表达式中：\n$$p_{A,t+1} = \\left( (1-r)p_{AB,t} + r p_{A,t} p_{B,t} \\right) + \\left( (1-r)p_{Ab,t} + r p_{A,t} p_{b,t} \\right)$$\n$$p_{A,t+1} = (1-r)(p_{AB,t} + p_{Ab,t}) + r p_{A,t}(p_{B,t} + p_{b,t})$$\n使用定义 $p_{A,t} = p_{AB,t} + p_{Ab,t}$ 和 $p_{B,t} + p_{b,t} = 1$：\n$$p_{A,t+1} = (1-r)p_{A,t} + r p_{A,t}(1) = p_{A,t} - r p_{A,t} + r p_{A,t} = p_{A,t}$$\n因此，等位基因频率 $p_A$ 随时间保持不变。根据相同的逻辑，$p_B$ 也保持不变。因此，我们可以省略等位基因频率的时间下标：对于所有 $t \\ge 0$，有 $p_A \\equiv p_{A,t}$ 和 $p_B \\equiv p_{B,t}$。\n\n现在，我们来写出 $D_t$ 的递归式。\n$$D_{t+1} = p_{AB,t+1} - p_{A,t+1} p_{B,t+1} = p_{AB,t+1} - p_A p_B$$\n代入 $p_{AB,t+1}$ 的表达式：\n$$D_{t+1} = \\left( (1-r)p_{AB,t} + r p_A p_B \\right) - p_A p_B$$\n$$D_{t+1} = (1-r)p_{AB,t} - (1-r)p_A p_B$$\n$$D_{t+1} = (1-r)(p_{AB,t} - p_A p_B)$$\n根据定义，$D_t = p_{AB,t} - p_A p_B$。所以，我们得到了一个简单的几何递归式：\n$$D_{t+1} = (1-r)D_t$$\n这个关系表明连锁不平衡每代都以 $(1-r)$ 的因子衰减。从初始状态 $D_0$ 开始，将此递归应用 $t$ 次，可得到闭式表达式：\n$$D_t = (1-r)^t D_0$$\n\n第三部分：LD半衰期的计算\n\n我们需要找到使连锁不平衡的量值减少到其初始量值的至多一半所需的最小整数代数 $t_{\\frac{1}{2}}$。这可以用不等式表示为：\n$$|D_t| \\le \\frac{1}{2} |D_0|$$\n代入 $D_t$ 的表达式：\n$$|(1-r)^t D_0| \\le \\frac{1}{2} |D_0|$$\n如果 $D_0 \\neq 0$，我们可以除以 $|D_0|$：\n$$|(1-r)^t| \\le \\frac{1}{2}$$\n问题陈述 $0  r \\le \\frac{1}{2}$，这意味着 $\\frac{1}{2} \\le 1-r  1$。对于任何非负整数 $t$，$(1-r)^t$ 都是正数，所以绝对值是多余的。\n$$(1-r)^t \\le \\frac{1}{2}$$\n为了解出 $t$，我们对两边取自然对数。\n$$\\ln((1-r)^t) \\le \\ln\\left(\\frac{1}{2}\\right)$$\n$$t \\ln(1-r) \\le -\\ln(2)$$\n因为 $0  1-r  1$，其对数 $\\ln(1-r)$ 是一个负数。用这个负数除以不等式两边会反转不等号的方向：\n$$t \\ge \\frac{-\\ln(2)}{\\ln(1-r)} = \\frac{\\ln(2)}{-\\ln(1-r)}$$\n给定 $r = 0.02$。代入这个值：\n$$t \\ge \\frac{\\ln(2)}{-\\ln(1-0.02)} = \\frac{\\ln(2)}{-\\ln(0.98)}$$\n数值上，$\\ln(2) \\approx 0.693147$ 且 $\\ln(0.98) \\approx -0.020203$。\n$$t \\ge \\frac{0.693147}{-(-0.020203)} \\approx 34.309$$\n由于 $t$ 必须是整数代数，满足此条件的 $t$ 的最小整数值是大于或等于 $34.309$ 的最小整数。\n$$t_{\\frac{1}{2}} = \\lceil 34.309 \\ldots \\rceil = 35$$\n因此，连锁不平衡衰减到其原始值的一半或更少需要 $35$ 代。", "answer": "$$\\boxed{35}$$", "id": "2728798"}, {"introduction": "虽然系数 $D$ 定义了连锁不平衡，但其原始值依赖于等位基因频率，这使得跨群体或基因座的比较变得困难。为了解决这个问题，研究人员开发了几种标准化的测量方法。本练习将使您熟悉最常见的连锁不平衡度量，包括 $D'$、$r^2$ 以及信息论中的互信息 $I(X;Y)$。通过一个给定的数据集 [@problem_id:2728701] 计算和比较这些值，您将学会理解它们在分析真实群体数据时的独特属性和应用。", "problem": "考虑一个随机交配群体中的两个双等位基因座，其等位基因为 $A/a$ 和 $B/b$。设单倍型频率为 $f_{AB}$、$f_{Ab}$、$f_{aB}$ 和 $f_{ab}$，它们满足 $f_{AB} + f_{Ab} + f_{aB} + f_{ab} = 1$ 且均为非负值。设等位基因频率为 $p_A = f_{AB} + f_{Ab}$、$p_a = 1 - p_A$、$p_B = f_{AB} + f_{aB}$ 和 $p_b = 1 - p_B$。连锁不平衡定义为 $D = f_{AB} - p_A p_B$。\n\n您的任务是：\n1. 仅从四个单倍型频率为非负且总和为 $1$ 的约束条件出发，推导 $D$ 作为 $p_A$ 和 $p_B$ 的函数必须满足的紧确界限。根据这些界限，在给定 $p_A$ 和 $p_B$ 的情况下，当 $D>0$ 和 $D0$ 时，求出 $D$ 可达到的理论最大绝对值。然后，将归一化连锁不平衡 $D'$ 定义为 $D$ 除以相应符号情况下的理论最大值。\n2. 将等位基因 $A$ 的存在视为伯努利随机变量 $X \\in \\{0,1\\}$，其中 $\\Pr(X=1)=p_A$；将等位基因 $B$ 的存在视为伯努利随机变量 $Y \\in \\{0,1\\}$，其中 $\\Pr(Y=1)=p_B$。使用概率论中相关性的定义，用 $D$、$p_A$、$p_a$、$p_B$ 和 $p_b$ 表示 $X$ 和 $Y$ 之间的 Pearson 相关系数 $r$，并定义 $r^2$。\n3. 使用信息论中互信息的定义，用单倍型和等位基因频率表示两个基因座之间的互信息 $I(X;Y)$。使用自然对数 $\\ln$，并以奈特 (nats) 为单位表示互信息。\n4. 现在假设观测到的单倍型频率为 $f_{AB} = 0.32$、$f_{Ab} = 0.18$、$f_{aB} = 0.28$ 和 $f_{ab} = 0.22$。计算 $p_A$、$p_B$、$D$，然后利用您的推导计算这些数据的 $D'$、$r$、$r^2$ 和 $I(X;Y)$。\n5. 简要解释 $D$ 和 $D'$ 在尺度、跨等位基因频率体系的可比性方面的解释性差异，以及在一个没有其他作用力的随机交配群体中，在现实的重组动态下，接近其极值的值表示什么。\n\n仅报告 $D'$、$r$、$r^2$ 和 $I(X;Y)$ 这四个数值，按此顺序排列，并四舍五入到四位有效数字。互信息以奈特 (nats) 为单位。您最终报告的答案必须是包含这四个值的单行矩阵，并按指定顺序排列。", "solution": "问题陈述已通过验证。\n\n**第 1 步：提取已知条件**\n- 两个双等位基因座，等位基因为 $A/a$ 和 $B/b$。\n- 随机交配群体。\n- 单倍型频率：$f_{AB}$、$f_{Ab}$、$f_{aB}$、$f_{ab}$。\n- 约束条件：$f_{AB} \\ge 0$、$f_{Ab} \\ge 0$、$f_{aB} \\ge 0$、$f_{ab} \\ge 0$ 且 $f_{AB} + f_{Ab} + f_{aB} + f_{ab} = 1$。\n- 等位基因频率：$p_A = f_{AB} + f_{Ab}$、$p_a = 1 - p_A$、$p_B = f_{AB} + f_{aB}$、$p_b = 1 - p_B$。\n- 连锁不平衡：$D = f_{AB} - p_A p_B$。\n- 等位基因 $A$ 的伯努利随机变量 $X \\in \\{0,1\\}$，$\\Pr(X=1)=p_A$；等位基因 $B$ 的伯努利随机变量 $Y \\in \\{0,1\\}$，$\\Pr(Y=1)=p_B$。\n- 用于计算的指定数据：$f_{AB} = 0.32$、$f_{Ab} = 0.18$、$f_{aB} = 0.28$、$f_{ab} = 0.22$。\n- 任务：\n    1. 推导 $D$ 的界限并定义 $D'$。\n    2. 用 $D$ 和等位基因频率表示 Pearson 相关系数 $r$ 和 $r^2$。\n    3. 用频率表示互信息 $I(X;Y)$。\n    4. 使用给定数据计算 $D'$、$r$、$r^2$ 和 $I(X;Y)$ 的数值。\n    5. 解释 $D$ 和 $D'$ 之间的解释性差异。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题定义明确，科学上基于群体遗传学、概率论和信息论的既定原理。定义是标准的，给定的数值数据是一致的，因为 $0.32 + 0.18 + 0.28 + 0.22 = 1.00$。该问题不含矛盾、歧义或事实上的不健全之处。它是自洽且可形式化的。\n\n**第 3 步：结论与行动**\n问题有效。将提供完整解答。\n\n**第 1 部分：D 的界限推导与 D' 的定义**\n四个单倍型频率可以用等位基因频率和连锁不平衡参数 $D$ 来表示。\n根据定义 $p_A = f_{AB} + f_{Ab}$ 和 $p_B = f_{AB} + f_{aB}$，以及 $D = f_{AB} - p_A p_B$，我们推导出：\n$f_{AB} = p_A p_B + D$\n$f_{Ab} = p_A - f_{AB} = p_A - (p_A p_B + D) = p_A(1 - p_B) - D = p_A p_b - D$\n$f_{aB} = p_B - f_{AB} = p_B - (p_A p_B + D) = p_B(1 - p_A) - D = p_a p_B - D$\n由于频率总和必须为 $1$，第四个频率是：\n$f_{ab} = 1 - f_{AB} - f_{Ab} - f_{aB} = 1 - (p_A p_B + D) - (p_A p_b - D) - (p_a p_B - D) = 1 - p_A(p_B+p_b) - p_a p_B + D = 1 - p_A - p_a p_B + D = p_a - p_a p_B + D = p_a(1-p_B) + D = p_a p_b + D$。\n\n基本约束是所有频率必须为非负 ($f_{ij} \\ge 0$)。将此应用于四个表达式中的每一个：\n1. $f_{AB} \\ge 0 \\implies p_A p_B + D \\ge 0 \\implies D \\ge -p_A p_B$\n2. $f_{Ab} \\ge 0 \\implies p_A p_b - D \\ge 0 \\implies D \\le p_A p_b$\n3. $f_{aB} \\ge 0 \\implies p_a p_B - D \\ge 0 \\implies D \\le p_a p_B$\n4. $f_{ab} \\ge 0 \\implies p_a p_b + D \\ge 0 \\implies D \\ge -p_a p_b$\n\n结合这些不等式，可得到 $D$ 的紧确界限：\n下界为 $D \\ge \\max(-p_A p_B, -p_a p_b) = -\\min(p_A p_B, p_a p_b)$。设其为 $D_{\\min}$。\n上界为 $D \\le \\min(p_A p_b, p_a p_B)$。设其为 $D_{\\max}$。\n因此，紧确界限为 $D_{\\min} \\le D \\le D_{\\max}$。\n\n归一化连锁不平衡 $D'$ 定义为将 $D$ 除以其在给定等位基因频率下的理论最大绝对值。\n如果 $D > 0$，最大可能值为 $D_{\\max}$。因此，$D' = \\frac{D}{D_{\\max}} = \\frac{D}{\\min(p_A p_b, p_a p_B)}$。\n如果 $D  0$，最小可能值为 $D_{\\min}$，因此最大绝对值为 $|D_{\\min}| = -D_{\\min}$。因此，$D' = \\frac{D}{|D_{\\min}|} = \\frac{D}{-D_{\\min}} = \\frac{D}{\\min(p_A p_B, p_a p_b)}$。\n如果 $D = 0$，$D'$ 为 $0$。\n\n**第 2 部分：Pearson 相关系数 r**\nPearson 相关系数为 $r = \\frac{\\text{Cov}(X,Y)}{\\sigma_X \\sigma_Y}$。\n伯努利随机变量 $X$ 和 $Y$ 的均值为 $E[X] = p_A$ 和 $E[Y] = p_B$。\n它们乘积的期望为 $E[XY] = \\Pr(X=1, Y=1) = f_{AB}$。\n协方差为 $\\text{Cov}(X,Y) = E[XY] - E[X]E[Y] = f_{AB} - p_A p_B = D$。\n伯努利变量的方差为 $\\sigma_X^2 = p_A(1-p_A) = p_A p_a$ 和 $\\sigma_Y^2 = p_B(1-p_B) = p_B p_b$。\n标准差为 $\\sigma_X = \\sqrt{p_A p_a}$ 和 $\\sigma_Y = \\sqrt{p_B p_b}$。\n将这些代入 $r$ 的公式：\n$$r = \\frac{D}{\\sqrt{p_A p_a p_B p_b}}$$\n相关系数的平方 $r^2$ 是连锁不平衡的一个常用度量：\n$$r^2 = \\frac{D^2}{p_A p_a p_B p_b}$$\n\n**第 3 部分：互信息 I(X;Y)**\n两个离散随机变量 $X$ 和 $Y$ 之间的互信息由下式给出：\n$$I(X;Y) = \\sum_{x,y} \\Pr(x,y) \\ln\\left(\\frac{\\Pr(x,y)}{\\Pr(x)\\Pr(y)}\\right)$$\n在此背景下，联合概率 $\\Pr(x,y)$ 是单倍型频率 $f_{ij}$，边际概率 $\\Pr(x)$ 和 $\\Pr(y)$ 是等位基因频率 $p_i$ 和 $p_j$。求和遍及所有四个单倍型。\n$$I(X;Y) = f_{AB} \\ln\\left(\\frac{f_{AB}}{p_A p_B}\\right) + f_{Ab} \\ln\\left(\\frac{f_{Ab}}{p_A p_b}\\right) + f_{aB} \\ln\\left(\\frac{f_{aB}}{p_a p_B}\\right) + f_{ab} \\ln\\left(\\frac{f_{ab}}{p_a p_b}\\right)$$\n由于使用自然对数，该值以奈特 (nats) 为单位。\n\n**第 4 部分：数值计算**\n给定单倍型频率：$f_{AB} = 0.32$、$f_{Ab} = 0.18$、$f_{aB} = 0.28$、$f_{ab} = 0.22$。\n1. 计算等位基因频率：\n$p_A = f_{AB} + f_{Ab} = 0.32 + 0.18 = 0.50$\n$p_a = 1 - p_A = 0.50$\n$p_B = f_{AB} + f_{aB} = 0.32 + 0.28 = 0.60$\n$p_b = 1 - p_B = 0.40$\n\n2. 计算 $D$：\n$D = f_{AB} - p_A p_B = 0.32 - (0.50)(0.60) = 0.32 - 0.30 = 0.02$\n\n3. 计算 $D'$：\n由于 $D = 0.02 > 0$，我们使用 $D' = \\frac{D}{\\min(p_A p_b, p_a p_B)}$。\n$p_A p_b = (0.50)(0.40) = 0.20$\n$p_a p_B = (0.50)(0.60) = 0.30$\n$D_{\\max} = \\min(0.20, 0.30) = 0.20$\n$D' = \\frac{0.02}{0.20} = 0.1$\n\n4. 计算 $r$ 和 $r^2$：\n$r = \\frac{D}{\\sqrt{p_A p_a p_B p_b}} = \\frac{0.02}{\\sqrt{(0.50)(0.50)(0.60)(0.40)}} = \\frac{0.02}{\\sqrt{0.06}} \\approx 0.081649658$\n$r^2 = \\frac{D^2}{p_A p_a p_B p_b} = \\frac{(0.02)^2}{0.06} = \\frac{0.0004}{0.06} = \\frac{1}{150} \\approx 0.0066666...$\n\n5. 计算 $I(X;Y)$：\n$I(X;Y) = 0.32 \\ln\\left(\\frac{0.32}{0.5 \\times 0.6}\\right) + 0.18 \\ln\\left(\\frac{0.18}{0.5 \\times 0.4}\\right) + 0.28 \\ln\\left(\\frac{0.28}{0.5 \\times 0.6}\\right) + 0.22 \\ln\\left(\\frac{0.22}{0.5 \\times 0.4}\\right)$\n$I(X;Y) = 0.32 \\ln\\left(\\frac{0.32}{0.30}\\right) + 0.18 \\ln\\left(\\frac{0.18}{0.20}\\right) + 0.28 \\ln\\left(\\frac{0.28}{0.30}\\right) + 0.22 \\ln\\left(\\frac{0.22}{0.20}\\right)$\n$I(X;Y) \\approx 0.32(0.0645385) + 0.18(-0.1053605) + 0.28(-0.0689928) + 0.22(0.0953102)$\n$I(X;Y) \\approx 0.0206523 - 0.0189649 - 0.0193180 + 0.0209682 \\approx 0.0033376$ nats。\n\n将结果四舍五入到四位有效数字：\n$D' = 0.1000$\n$r = 0.08165$\n$r^2 = 0.006667$\n$I(X;Y) = 0.003338$\n\n**第 5 部分：解释性差异**\n度量 $D$ 是两个基因座上等位基因存在之间的基本协方差。然而，其值受到群体等位基因频率的限制。范围 $[D_{\\min}, D_{\\max}]$ 通常是不对称的，其宽度在很大程度上取决于 $p_A$ 和 $p_B$。例如，如果一个等位基因很稀有，那么 $D$ 的最大可能值就很小。这使得仅使用 $D$ 无法比较具有不同等位基因频率的群体或基因座之间的连锁不平衡强度。\n\n归一化度量 $D'$ 校正了这种依赖性。通过将 $D$ 按其在给定等位基因频率下的最大可能值进行缩放，$D'$ 的范围总是在 $-1$ 到 $1$ 之间。$D'=-1$ 或 $D'=1$ 的值表示完全连锁不平衡，此时四个单倍型中至少有一个缺失。这种归一化使得该度量在不同系统之间具有可比性。在随机交配群体中，重组会打破关联，推动 $D$ 和 $D'$ 趋向于 $0$。因此，$|D'|$ 的值接近 $1$ 意味着重组在打破等位基因之间的非随机关联方面是无效的。这可能是由于非常紧密的物理连锁（低重组率）、近期事件（如突变或群体混合）或偏好某些单倍型组合的强烈自然选择所致。", "answer": "$$\\boxed{\\begin{pmatrix} 0.1000  0.08165  0.006667  0.003338 \\end{pmatrix}}$$", "id": "2728701"}, {"introduction": "虽然 $D'$ 和 $r^2$ 都是标准化的连锁不平衡度量，但它们捕捉了非随机关联的不同方面，并且在某些情况下表现出令人惊讶的差异，尤其是在等位基因频率极端偏斜时。通过这个思想实验[@problem_id:2728810]，您将构建一个完全连锁不平衡（$|D'|=1$）但 $r^2$ 值很小的场景。这个反直觉的例子对于培养在全基因组关联研究和进化推断中如何精确解读这些广泛使用的统计数据的深刻理解至关重要。", "problem": "考虑一个具有 $2$ 个双等位基因座（表示为 $A/a$ 和 $B/b$）的大型随机交配群体，其世代为离散的，且无突变、迁移、选择或遗传漂变。设一代开始时的等位基因频率为 $p_{A}=\\epsilon$（其中 $0  \\epsilon  \\frac{1}{2}$）和 $p_{B}=\\frac{1}{2}$。您可以假设单倍型频率 $x_{AB}$、$x_{Ab}$、$x_{aB}$ 和 $x_{ab}$ 满足 $x_{AB}+x_{Ab}+x_{aB}+x_{ab}=1$ 以及边际约束 $p_{A}=x_{AB}+x_{Ab}$ 和 $p_{B}=x_{AB}+x_{aB}$ 精确成立。\n\n仅使用连锁不平衡系数 $D$、标准化连锁不平衡 $D'$（定义为将 $D$ 按给定等位基因频率下的代数最大值进行归一化）以及两个基因座上等位基因状态之间的相关系数平方 $r^2$ 的标准定义，构建一个与给定等位基因频率一致且能得出 $|D'|=1$ 的明确单倍型构型。然后，为您的构型计算 $r^2$ 作为 $\\epsilon$ 函数的精确闭式表达式。以 $\\epsilon$ 的单个简化表达式形式提供您的最终答案。不需要进行数值近似。", "solution": "所提出的问题是有效的、有科学依据且定义明确的。我们开始进行解答。\n\n该问题考虑了一个大型随机交配群体中的双基因座、双等位基因系统，并设定了特定的简化假设（无突变、迁移、选择或漂变）。给定的等位基因频率为 $p_{A} = \\epsilon$ 和 $p_{B} = \\frac{1}{2}$，约束条件为 $0  \\epsilon  \\frac{1}{2}$。因此，另一等位基因的频率为 $p_{a} = 1 - p_{A} = 1 - \\epsilon$ 和 $p_{b} = 1 - p_{B} = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n\n连锁不平衡系数 $D$ 定义为 $D = x_{AB} - p_A p_B$，其中 $x_{AB}$ 是 $AB$ 单倍型的频率。四种可能的单倍型（$AB$、$Ab$、$aB$、$ab$）的频率可以用等位基因频率和 $D$ 表示如下：\n$$x_{AB} = p_{A}p_{B} + D$$\n$$x_{Ab} = p_{A}p_{b} - D$$\n$$x_{aB} = p_{a}p_{B} - D$$\n$$x_{ab} = p_{a}p_{b} + D$$\n\n由于单倍型频率必须为非负数（$x_{ij} \\ge 0$），因此 $D$ 的值受到限制。这些约束导致了 $D$ 的以下界限：\n$$\\max(-p_{A}p_{B}, -p_{a}p_{b}) \\le D \\le \\min(p_{A}p_{b}, p_{a}p_{B})$$\n令 $D_{min} = \\max(-p_{A}p_{B}, -p_{a}p_{b})$ 且 $D_{max} = \\min(p_{A}p_{b}, p_{a}p_{B})$。\n\n我们将给定的等位基因频率代入这些界限表达式中：\n$p_{A}p_{b} = \\epsilon \\cdot \\frac{1}{2} = \\frac{\\epsilon}{2}$\n$p_{a}p_{B} = (1-\\epsilon) \\cdot \\frac{1}{2} = \\frac{1-\\epsilon}{2}$\n在给定条件 $0  \\epsilon  \\frac{1}{2}$ 下，可得 $\\epsilon  1-\\epsilon$，因此 $\\frac{\\epsilon}{2}  \\frac{1-\\epsilon}{2}$。\n因此，$D$ 的最大可能值为 $D_{max} = \\min(\\frac{\\epsilon}{2}, \\frac{1-\\epsilon}{2}) = \\frac{\\epsilon}{2}$。\n\n对于最小界限：\n$-p_{A}p_{B} = -\\epsilon \\cdot \\frac{1}{2} = -\\frac{\\epsilon}{2}$\n$-p_{a}p_{b} = -(1-\\epsilon) \\cdot \\frac{1}{2} = -\\frac{1-\\epsilon}{2}$\n同样，由于 $\\epsilon  1-\\epsilon$，我们有 $-\\epsilon > -(1-\\epsilon)$，因此 $-\\frac{\\epsilon}{2} > -\\frac{1-\\epsilon}{2}$。\n因此，$D$ 的最小可能值为 $D_{min} = \\max(-\\frac{\\epsilon}{2}, -\\frac{1-\\epsilon}{2}) = -\\frac{\\epsilon}{2}$。\n\n问题指出，标准化连锁不平衡 $|D'|$ 等于 $1$。$D'$ 的定义是在给定等位基因频率下，$D$ 除以其与零的最大可能偏差值进行归一化。也就是说，如果 $D>0$，则 $D' = D/D_{max}$；如果 $D0$，则 $D' = D/|D_{min}|$。条件 $|D'|=1$ 意味着 $D$ 必须取其极值之一，即 $D = D_{max}$ 或 $D = D_{min}$。\n在我们的情况下，这意味着 $D = \\frac{\\epsilon}{2}$ 或 $D = -\\frac{\\epsilon}{2}$。\n\n我们被要求构建一个明确的单倍型构型。让我们选择 $D = D_{max} = \\frac{\\epsilon}{2}$ 的情况。现在我们可以计算四种单倍型的频率：\n$x_{AB} = p_{A}p_{B} + D = (\\epsilon \\cdot \\frac{1}{2}) + \\frac{\\epsilon}{2} = \\epsilon$\n$x_{Ab} = p_{A}p_{b} - D = (\\epsilon \\cdot \\frac{1}{2}) - \\frac{\\epsilon}{2} = 0$\n$x_{aB} = p_{a}p_{B} - D = ((1-\\epsilon) \\cdot \\frac{1}{2}) - \\frac{\\epsilon}{2} = \\frac{1-\\epsilon-\\epsilon}{2} = \\frac{1-2\\epsilon}{2}$\n$x_{ab} = p_{a}p_{b} + D = ((1-\\epsilon) \\cdot \\frac{1}{2}) + \\frac{\\epsilon}{2} = \\frac{1-\\epsilon+\\epsilon}{2} = \\frac{1}{2}$\n\n这个构型是一致的。所有频率均为非负（因为 $0  \\epsilon  \\frac{1}{2}$ 意味着 $1-2\\epsilon > 0$），且它们的和为 1：$x_{AB}+x_{Ab}+x_{aB}+x_{ab} = \\epsilon + 0 + \\frac{1-2\\epsilon}{2} + \\frac{1}{2} = \\epsilon + \\frac{1}{2} - \\epsilon + \\frac{1}{2} = 1$。当其中一种单倍型（$Ab$）缺失时，会出现这种构型，导致在给定等位基因频率下的最大（完全）连锁不平衡。\n\n接下来，我们必须计算该构型的相关系数平方 $r^2$。$r^2$ 的定义是：\n$$r^{2} = \\frac{D^2}{p_{A}p_{a}p_{B}p_{b}}$$\n我们将已知量代入此公式：\n$D = \\frac{\\epsilon}{2}$\n$p_{A} = \\epsilon$\n$p_{a} = 1-\\epsilon$\n$p_{B} = \\frac{1}{2}$\n$p_{b} = \\frac{1}{2}$\n\n这得出：\n$$r^{2} = \\frac{(\\frac{\\epsilon}{2})^2}{\\epsilon(1-\\epsilon)(\\frac{1}{2})(\\frac{1}{2})} = \\frac{\\frac{\\epsilon^2}{4}}{\\frac{\\epsilon(1-\\epsilon)}{4}}$$\n通过简化表达式，我们消去分子和分母中的因子 $\\frac{1}{4}$：\n$$r^{2} = \\frac{\\epsilon^2}{\\epsilon(1-\\epsilon)}$$\n假设 $\\epsilon \\neq 0$（由 $0  \\epsilon  \\frac{1}{2}$ 给出），我们可以将分子和分母同除以 $\\epsilon$：\n$$r^{2} = \\frac{\\epsilon}{1-\\epsilon}$$\n这是 $r^2$ 作为 $\\epsilon$ 函数的最终表达式。请注意，如果我们选择 $D=D_{min}=-\\frac{\\epsilon}{2}$，则 $D^2$ 的值将相同，从而得到相同的 $r^2$ 结果。", "answer": "$$ \\boxed{\\frac{\\epsilon}{1-\\epsilon}} $$", "id": "2728810"}]}