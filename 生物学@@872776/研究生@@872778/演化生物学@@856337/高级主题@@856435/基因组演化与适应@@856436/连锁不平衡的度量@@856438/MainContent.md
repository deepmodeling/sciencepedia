## 引言
连锁不平衡（Linkage Disequilibrium, LD）是群体遗传学的核心概念，描述了基因组中不同位点等位基因之间非随机关联的现象。这种关联性的存在与否及其强度，是群体进化历史（如重组、选择、漂变和迁移）的直接体现，也是解读[基因型与表型](@entry_id:142682)关系的关键。然而，仅仅识别出[连锁不平衡](@entry_id:146203)的存在是远远不够的；如何准确地量化它，并正确地解读不同度量指标所蕴含的生物学意义，是遗传学研究面临的关键挑战。不同的度量方法，如基础的 $D$ 系数及其标准化的形式 $D'$ 和 $r^2$，各自捕捉了[连锁不平衡](@entry_id:146203)的不同侧面，其适用场景和局限性常被混淆，可能导致对遗传结构和关联信号的错误判断。

本文旨在系统性地阐明[连锁不平衡](@entry_id:146203)的度量方法及其应用。在接下来的内容中，你将学到：

*   **第一章：原理与机制** 将深入剖析度量[连锁不平衡](@entry_id:146203)的核心指标 $D$、$D'$ 和 $r^2$，阐明它们的数学基础、统计学解释以及彼此间的关键差异。我们还将探讨重组如何导致[连锁不平衡衰减](@entry_id:202099)，以及[群体结构](@entry_id:148599)等因素如何产生伪关联信号。
*   **第二章：应用与跨学科联系** 将展示这些度量方法在人类遗传学、进化生物学和结构[基因组学](@entry_id:138123)等领域的强大应用，例如在全基因组关联研究（GWAS）中定位疾病基因、重建重组图谱、探测自然选择的印记等。
*   **第三章：动手实践** 将通过一系列精心设计的问题，让你亲手计算和解释[连锁不平衡](@entry_id:146203)，将理论知识转化为实践技能。

通过这一结构化的学习路径，本文将为你构建一个关于连锁不平衡度量的完整知识框架，从基本原理出发，逐步深入到前沿应用。让我们首先从[连锁不平衡](@entry_id:146203)度量的核心原理与机制开始。

## 原理与机制

在群体遗传学中，**连锁不平衡 (Linkage Disequilibrium, LD)** 是指在给定群体的基因组中，不同座位（locus）上的等位基因（allele）之间出现非随机关联的现象。如果等位基因在群体中以随机组合的方式形成单倍型（haplotype），我们就称之为连锁平衡。然而，多种进化力量，如选择、突变、[遗传漂变](@entry_id:145594)和群体结构，尤其是有限的重组，都会导致等位基因之间产生统计学上的关联，即[连锁不平衡](@entry_id:146203)。本章将深入探讨度量[连锁不平衡](@entry_id:146203)的核心原理和关键机制。

### 连锁不平衡的基本度量：系数 $D$

度量连锁不平衡最基础的出发点是比较观测到的单倍型频率与在连锁平衡（即等位基因间统计独立）假设下期望的单倍型频率之间的差异。

考虑两个双等位[基因座](@entry_id:177958)位，其等位基因分别为 $A/a$ 和 $B/b$。群体中存在四种可能的单倍型：$AB$、$Ab$、$aB$ 和 $ab$，其频率分别表示为 $P_{AB}$、$P_{Ab}$、$P_{aB}$ 和 $P_{ab}$，且它们的总和为 1。各位点上的等位基因频率可以通过[边缘化](@entry_id:264637)单倍型频率得到：$A$ 的频率 $p_A = P_{AB} + P_{Ab}$，$B$ 的频率 $p_B = P_{AB} + P_{aB}$。

如果两个座位是连锁平衡的，那么任何特定单倍型的频率都应等于其构成等位基因频率的乘积。例如，在平衡状态下，我们期望 $P_{AB} = p_A p_B$。连锁不平衡系数 **$D$** 正是用来量化观测频率与此期望频率之间的偏差：

$$ D = P_{AB} - p_A p_B $$

一个正的 $D$ 值表示 $AB$ 单倍型（以及互补的 $ab$ 单倍型）的频率高于预期，这通常被称为**耦合相 (coupling phase)**。相反，一个负的 $D$ 值表示 $Ab$ 和 $aB$ 单倍型（通常称为**斥离相 (repulsion phase)**）的频率高于预期。当 $D=0$ 时，群体处于连锁平衡状态。

例如，假设在一个包含 100 条[染色体](@entry_id:276543)的样本中，我们观测到单倍型计数为 $C_{AB} = 46$，$C_{Ab} = 14$，$C_{aB} = 14$ 和 $C_{ab} = 26$。由此我们可以估计单倍型频率为 $P_{AB} = 0.46$，$P_{Ab} = 0.14$，$P_{aB} = 0.14$ 和 $P_{ab} = 0.26$。等位基因频率为 $p_A = 0.46 + 0.14 = 0.60$ 和 $p_B = 0.46 + 0.14 = 0.60$。因此，[连锁不平衡](@entry_id:146203)系数为：

$$ D = 0.46 - (0.60)(0.60) = 0.46 - 0.36 = 0.10 $$

这个正值表明，与随机组合的预期相比，$A$ 和 $B$ 等位基因更倾向于出现在同一条[染色体](@entry_id:276543)上。[@problem_id:2732241]

$D$ 系数还有一个等价的定义形式，它不直接依赖于等位基因频率的计算，而是通过四种单倍型频率的[交叉](@entry_id:147634)乘积差来表示：

$$ D = P_{AB}P_{ab} - P_{Ab}P_{aB} $$

使用上述例子中的数据，我们得到 $D = (0.46)(0.26) - (0.14)(0.14) = 0.1196 - 0.0196 = 0.10$，结果完全一致。这个形式揭示了 $D$ 的一个重要代数性质：如果我们对其中一个座位（比如 $A \leftrightarrow a$）进行等位基因重命名，新计算出的 $D$ 值将与原值大小相等但符号相反。而如果同时对两个座位进行重命名，则 $D$ 的值保持不变。[@problem_id:2732243]

从更严格的统计学角度来看，$D$ 系数可以被诠释为两个[指示变量](@entry_id:266428)之间的**协[方差](@entry_id:200758) (covariance)**。设 $X$ 和 $Y$ 为两个[随机变量](@entry_id:195330)，分别代表在随机抽取的单倍型上，座位1和座位2的等位基因状态。例如，如果座位1是 $A$，$X=1$；如果是 $a$，$X=0$。同理，如果座位2是 $B$，$Y=1$；如果是 $b$，$Y=0$。那么，根据定义，$E[X] = p_A$，$E[Y] = p_B$，$E[XY]$ 等于 $X$ 和 $Y$ 同时为 1 的概率，即 $P_{AB}$。因此，协[方差](@entry_id:200758)为：

$$ \operatorname{Cov}(X,Y) = E[XY] - E[X]E[Y] = P_{AB} - p_A p_B = D $$

这种解释将[连锁不平衡](@entry_id:146203)置于一个坚实的统计学框架中，并为后续的标准化度量（如相关系数）奠定了基础。[@problem_id:2732260]

### $D$ 的标准化：$D'$ 与 $r^2$

尽管 $D$ 是衡量连锁不平衡的基础，但它有一个显著的局限性：其取值范围严重依赖于相关等位基因的频率。这使得在不同群体或不同座位间直接比较 $D$ 值变得困难。因此，研究人员开发了标准化的度量方法。

#### $D$ 的局限性：[等位基因频率](@entry_id:146872)的依赖性

$D$ 的取值范围受到一个基本物理约束的限制：所有四种单倍型频率都必须是非负的。我们可以将四种单倍型频率表示为等位基因频率和 $D$ 的函数：

- $P_{AB} = p_A p_B + D$
- $P_{Ab} = p_A p_b - D$
- $P_{aB} = p_a p_B - D$
- $P_{ab} = p_a p_b + D$

为了使所有频率 $P_{ij} \ge 0$， $D$ 的值必须满足以下不等式：

$$ \max(-p_A p_B, -p_a p_b) \le D \le \min(p_A p_b, p_a p_B) $$

这个区间的上下界分别被称为 $D_{\min}$ 和 $D_{\max}$。[@problem_id:2825935]

这个约束的后果是，当一个或两个座位上的[等位基因频率](@entry_id:146872)非常悬殊时，$D$ 的可能取值范围会变得非常小且不对称。例如，假设 $p_A=0.1$ 和 $p_B=0.9$。那么 $p_a=0.9$，$p_b=0.1$。$D$ 的取值范围是：

- $D_{\max} = \min((0.1)(0.1), (0.9)(0.9)) = \min(0.01, 0.81) = 0.01$
- $D_{\min} = \max(-(0.1)(0.9), -(0.9)(0.1)) = \max(-0.09, -0.09) = -0.09$

因此，对于这些等位基因频率，$D$ 的允许范围是 $[-0.09, 0.01]$。这个范围相对于 $D=0$ 是高度不对称的。生物学上的解释是，当 $A$ 和 $b$ 都是稀有等位基因时，要产生一个显著的正 $D$（即过量的 $AB$ 和 $ab$ 单倍型），就必须以消耗 $Ab$ 和 $aB$ 单倍型为代价。但 $Ab$ 单倍型的期望频率本身就非常低（$p_A p_b = 0.01$），所以它能被“消耗”的余地很小，从而严格限制了 $D$ 的上界。[@problem_id:2825921]

#### Lewontin 的[标准化](@entry_id:637219)不平衡系数 $D'$

为了克服 $D$ 的频率依赖性，Richard Lewontin 提出了[标准化](@entry_id:637219)的系数 **$D'$**（读作 D-prime）。其定义是将观测到的 $D$ 值除以在给定等位基因频率下可能达到的最大[绝对值](@entry_id:147688)。

- 如果 $D > 0$, $D' = \frac{D}{D_{\max}} = \frac{D}{\min(p_A p_b, p_a p_B)}$
- 如果 $D  0$, $D' = \frac{D}{|D_{\min}|} = \frac{D}{\min(p_A p_B, p_a p_b)}$

$D'$ 的取值范围是 $[-1, 1]$。$|D'|=1$ 具有特殊的生物学意义：它意味着在四个可能的单倍型中，至少有一个的频率为零。这通常被解释为在观察到的样本中，这两个特定座位上的等位基因之间没有发生过重组事件。例如，如果 $D > 0$ 且 $D'=1$，则意味着 $P_{Ab}=0$ 或 $P_{aB}=0$。[@problem_id:2825935]

#### 平方相关系数 $r^2$

另一个重要的标准化度量是 **$r^2$**，它直接源于 $D$ 作为协[方差](@entry_id:200758)的统计解释。$r^2$ 就是先前定义的[指示变量](@entry_id:266428) $X$ 和 $Y$ 之间 Pearson [相关系数](@entry_id:147037)的平方。

$$ r^2 = \frac{\operatorname{Cov}(X,Y)^2}{\operatorname{Var}(X)\operatorname{Var}(Y)} = \frac{D^2}{p_A(1-p_A)p_B(1-p_B)} $$

$r^2$ 的取值范围是 $[0, 1]$。它量化了一个座位上的等位基因状态能在多大程度上预测另一个座位上的等位基因状态。$r^2=1$ 意味着完美的预测能力（两个座位完全关联），而 $r^2=0$ 意味着没有关联（连锁平衡）。$r^2$ 的一个关键优点是它与关联检验的统计功效直接相关。[@problem_id:2732260]

### 度量比较及其在关联研究中的应用

$D'$ 和 $r^2$ 虽然都对 $D$ 进行了[标准化](@entry_id:637219)，但它们捕捉了[连锁不平衡](@entry_id:146203)的不同方面，因此在解释和应用上存在关键差异。

#### 频率依赖性与核心差异

$D'$ 和 $r^2$ 对[等位基因频率](@entry_id:146872)的依赖方式截然不同。$D'$ 通过将 $D$ 调整到其理论边界来衡量连锁不平衡的“完整性”，而 $r^2$ 则衡量关联的统计强度或可预测性。当[等位基因频率](@entry_id:146872)悬殊时，这种差异尤为突出。

考虑一个情景，其中 $p_A=0.05$，$p_B=0.5$，并且观察到的单倍型频率为 $P_{AB}=0.05, P_{Ab}=0, P_{aB}=0.45, P_{ab}=0.50$。在这种情况下：
- $D = 0.05 - (0.05)(0.5) = 0.025$
- $D_{\max} = \min((0.05)(0.5), (0.95)(0.5)) = 0.025$
- $D' = \frac{0.025}{0.025} = 1$
- $r^2 = \frac{0.025^2}{(0.05)(0.95)(0.5)(0.5)} \approx 0.053$

这个例子 [@problem_id:2732234] 戏剧性地说明，$D'=1$（表示 $Ab$ 单倍型缺失，历史关联完整）可以与一个非常低的 $r^2$ 值共存。这是因为即使 $A$ 等位基因总是与 $B$ 等位基因一起出现，但由于 $A$ 本身非常罕见，知道一个[染色体](@entry_id:276543)携带 $A$ 并不能显著减少我们关于它在座位 B 状态的不确定性。

反之，即使两个情景的等位基因频率和 $|D'|$ 值完全相同，它们的 $r^2$ 值也可能大相径庭。这取决于 $D$ 的符号（耦合相或斥离相），因为用于计算 $D'$ 的分母 ($D_{max}$ 或 $|D_{min}|$) 会因此而不同，而 $r^2$ 的分母则保持不变。这进一步证明了 $|D'|$ 并不等同于关联强度。[@problem_id:2732231]

#### 在[关联作图](@entry_id:189453)中的选择

在**全基因组关联研究 (GWAS)** 等应用中，一个核心任务是选择**标签[单核苷酸多态性](@entry_id:173601) (tag SNPs)** 来代表基因组中的其他未分型变异。这里的目标是最大化预测能力。由于关联检验的[统计功效](@entry_id:197129)和[基因型填充](@entry_id:163993)（imputation）的准确性都与 $r^2$ 成正比，因此 **$r^2$ 是选择标签 SNP 时更可取、更具[信息量](@entry_id:272315)的度量**。一个高的 $r^2$ 值确保了标签 SNP 能够可靠地代表目标变异，而一个高的 $D'$ 值在稀有等位基因存在时可能会产生误导，因为它并不保证强大的[统计关联](@entry_id:172897)。[@problem_id:2732234] [@problem_id:2732231] [@problem_id:2825914]

### [连锁不平衡](@entry_id:146203)的动态与混淆因素

连锁不平衡不是一个静态的群体属性，它会随着时间的推移而演变，并且其表观信号可能受到群体采样方式的严重影响。

#### 重组导致的 LD 衰减

在随机交配的群体中，如果没有其他进化力量的作用，[连锁不平衡](@entry_id:146203)会因减数分裂期间的**重组 (recombination)** 而逐渐衰减。设两个座位间的[重组率](@entry_id:203271)为 $r$（$0 \le r \le 0.5$）。在每一代中，一部分单倍型会通过重组被“打断”，而新的单倍型组合会以与等位基因频率成比例的方式形成。

我们可以从第一性原理推导出 $D$ 值随时间变化的递归关系。在第 $t+1$ 代， $AB$ 单倍型的频率 $P_{AB}(t+1)$ 由两部分组成：未发生重组而直接继承自上一代的 $AB$ 单倍型，其比例为 $(1-r)P_{AB}(t)$；以及通过重组新形成的 $AB$ 单倍型，其比例为 $r p_A p_B$。因此：

$$ P_{AB}(t+1) = (1-r)P_{AB}(t) + r p_A p_B $$

由于在这些假设下等位基因频率保持不变，我们可以推导出 $D$ 的动态方程：

$$ D(t+1) = P_{AB}(t+1) - p_A p_B = (1-r)P_{AB}(t) + r p_A p_B - p_A p_B = (1-r)(P_{AB}(t) - p_A p_B) = (1-r)D(t) $$

这个简单的[几何级数](@entry_id:158490)关系表明，LD 会以 $(1-r)$ 的速率指数衰减。其解为 $D(t) = (1-r)^t D(0)$。这意味着对于紧密连锁的座位（$r$ 很小），LD 会持续很多代；而对于非连锁座位（$r=0.5$），LD 会在每一代减半，迅速趋近于平衡。[@problem_id:2825913]

#### [群体结构](@entry_id:148599)导致的伪 LD：Wahlund 效应

[连锁不平衡](@entry_id:146203)的测量值对**群体结构 (population structure)** 非常敏感。如果将来自两个或多个[遗传分化](@entry_id:163113)的亚群体的样本混合在一起进行分析，即使在每个亚群体内部都不存在[连锁不平衡](@entry_id:146203)，混合样本中也可能出现显著的（伪）连锁不平衡。这种现象是 **Wahlund 效应** 的一个表现。

考虑这样一个例子：两个亚群体（Deme 1 和 Deme 2）内部均为连锁平衡（$D=0$）。但在 Deme 1 中，$p_A=0.8, p_B=0.2$；在 Deme 2 中，$p_A=0.2, p_B=0.8$。当等量混合两个亚群体的样本时，我们观察到在混合群体中 $p_A=p_B=0.5$，但计算出的 $D$ 值为 $-0.09$，$r^2$ 值为 $0.1296$。[@problem_id:2732248]

这种伪关联的产生，是因为混合导致了[等位基因频率](@entry_id:146872)的共变异。在混合样本中观测到的总 LD ($D_{pooled}$) 可以分解为亚群体内 LD 的平均值（$\bar{D}$）和亚群体间等位基因频率的协[方差](@entry_id:200758) ($\operatorname{Cov}(p_A, p_B)$)：

$$ D_{pooled} = \bar{D} + \operatorname{Cov}(p_A, p_B) $$

在我们的例子中，$\bar{D}=0$，所以观测到的 LD 完全是由[等位基因频率](@entry_id:146872)在亚群体间的负协[方差](@entry_id:200758)造成的。因此，在解释 LD 信号时，必须警惕潜在的群体结构混淆。一个有效的诊断方法是进行**分层分析 (stratified analysis)**，即在已知的亚群体内部单独计算 LD。如果分层后的 LD 值显著低于混合样本的 LD 值，则表明 Wahlund 效应是主要原因。诸如 **Cochran–Mantel–Haenszel (CMH) 检验** 等统计方法可以正式检验在控制了[群体分层](@entry_id:175542)变量后的关联是否存在。[@problem_id:2732248]

### 超越两座位模型：高阶[连锁不平衡](@entry_id:146203)

[连锁不平衡](@entry_id:146203)的概念可以扩展到两个以上的座位，从而引出**高阶连锁不平衡 (higher-order linkage disequilibrium)** 的概念。令人惊讶的是，一个系统可以表现出完全的 pairwise 连锁平衡，但同时又存在显著的三座位[连锁不平衡](@entry_id:146203)。

考虑一个三座位系统（$A/a, B/b, C/c$）。三座位 LD 系数 $D_{ABC}$ 旨在捕捉不能被任何单座位效应或两座位（pairwise）效应所解释的残余关联。其定义可通过一个层级模型给出：

$$ P_{ABC} = p_A p_B p_C + p_C D_{AB} + p_B D_{AC} + p_A D_{BC} + D_{ABC} $$

现在，设想一个群体，其中只存在四种单倍型，每种频率均为 $0.25$：$ABC, Abc, aBc, abC$。在这个群体中，我们可以计算出：
- 所有等位基因的频率均为 $0.5$ ($p_A=p_B=p_C=0.5$)。
- 所有的 pairwise LD 系数均为零（$D_{AB} = D_{AC} = D_{BC} = 0$）。例如，$P_{AB} = P_{ABC} + P_{ABc} = 0.25 + 0 = 0.25$，而 $p_A p_B = (0.5)(0.5)=0.25$，因此 $D_{AB}=0$。

尽管任意两个座位之间都处于连锁平衡，但这个系统远非随机。我们可以计算三座位 LD：

$$ D_{ABC} = P_{ABC} - p_A p_B p_C = 0.25 - (0.5)^3 = 0.25 - 0.125 = 0.125 $$

这个非零的 $D_{ABC}$ 值揭示了一种微妙的三向交互。在这个例子中，存在的单倍型都有偶数个“小写”等位基因。这种非随机的模式只有在同时考虑所有三个座位时才能被检测到。这个例子 [@problem_id:2732262] 强调了连锁平衡是一个多层次的属性，仅仅 pairwise 的平衡并不能保证整个多座位系统的完全随机组合。