{"hands_on_practices": [{"introduction": "掌握任何演化理论的第一步都是理解其核心预测。Fisher的性别比理论指出，在特定条件下，演化会倾向于亲代在两性后代上投入相等的资源。这项练习将通过推导在两性生产成本不等时的演化稳定策略（ESS），来帮助你从根本上理解这一“均等投入”原则，这是性别比演化研究的基石[@problem_id:2709671]。", "problem": "一个大型、随机交配、有性生殖的种群中，初级性比由母体控制，初级性比定义为受孕时合子中雄性的比例。假设同性个体间交配机会均等，出生后除了性别特异的生产成本外，没有存活率或生育力的差异，并且母体投资是唯一的限制性资源。设生产一个儿子的成本为$c_m$，生产一个女儿的成本为$c_f$，成本以相同的资源单位计量。每个母亲有固定的预算$B$，并且可以将其预算的$x$比例持续分配给儿子，剩余的$1-x$分配给女儿。假设给定性别的后代在种群性比条件下，其预期存活率和未来交配成功率是相同的，并且通过儿子和女儿的基因传递是对称的，因此任何恒定的孟德尔传递因子在两性之间比较时都会被抵消。\n\n仅使用基本定义和经过充分检验的事实，包括(i)随机交配意味着给定性别个体的平均交配成功率与其性别频率成反比，以及(ii)在进化稳定策略(ESS)下，单位投资的边际适合度回报在不同投资选择间是均等的，从第一性原理推导出一个条件，使得固有种群按数量计算的初级性比$p$成为一个ESS。然后，计算当$c_m=2$和$c_f=1$时，按数量计算的ESS初级性比。你的最终答案必须是一个数字。如果你选择近似，则四舍五入到四位有效数字；否则，提供不带近似的精确值。不要包含单位。", "solution": "问题要求推导按数量计算的初级性比（表示为$p$）成为进化稳定策略(ESS)的条件，并根据给定的雄性和雌性生产成本计算该比率。分析将基于进化博弈论的原理。\n\n一位母亲的进化适合度与其孙代的总数成正比。在一个二倍体、有性生殖的种群中，每个后代都是由一个雄性配子和一个雌性配子融合而成。因此，一代中所有雄性的总繁殖价值必须等于所有雌性的总繁殖价值。设$N_m$为繁殖年龄种群中雄性的总数，$N_f$为雌性的总数。设单个雄性的平均繁殖价值为$v_m$，单个雌性的平均繁殖价值为$v_f$。总繁殖价值相等意味着$N_m v_m = N_f v_f$。由此我们看到，个体的繁殖价值与其性别在种群中的频率成反比，这与问题陈述中的事实(i)一致。具体来说，$v_m \\propto \\frac{1}{N_m}$ 且 $v_f \\propto \\frac{1}{N_f}$。\n\n问题陈述中提到，一位母亲有固定的预算$B$，并将其预算的$x$比例分配给儿子，将$1-x$分配给女儿。生产一个儿子的成本是$c_m$，生产一个女儿的成本是$c_f$。一位母亲生产的儿子数量为$n_m = \\frac{xB}{c_m}$，女儿数量为$n_f = \\frac{(1-x)B}{c_f}$。她的适合度$W$是其后代繁殖价值的总和：\n$$W = n_m v_m + n_f v_f = \\left(\\frac{xB}{c_m}\\right)v_m + \\left(\\frac{(1-x)B}{c_f}\\right)v_f$$\n$v_m$和$v_f$的值由整个种群的性比决定，该性比是由固有策略设定的，而不是由单个（可能是突变的）母亲的策略决定的。\n\n根据事实(ii)，当单位投资的边际适合度回报在所有可能的投资选择之间均等时，就达到了ESS。这里的选择是投资于儿子与投资于女儿。对儿子的投资是预算部分$xB$，对女儿的投资是$(1-x)B$。\n\n投资于儿子的边际适合度回报是来自儿子的适合度分量$n_m v_m$相对于对儿子的投资$I_m = xB$的导数：\n$$\\frac{\\partial (n_m v_m)}{\\partial I_m} = \\frac{\\partial}{\\partial (xB)} \\left(\\frac{xB}{c_m}v_m\\right) = \\frac{v_m}{c_m}$$\n同样，投资于女儿的边际适合度回报是来自女儿的适合度分量$n_f v_f$相对于对女儿的投资$I_f = (1-x)B$的导数：\n$$\\frac{\\partial (n_f v_f)}{\\partial I_f} = \\frac{\\partial}{\\partial ((1-x)B)} \\left(\\frac{(1-x)B}{c_f}v_f\\right) = \\frac{v_f}{c_f}$$\n在ESS时，这些边际回报必须相等：\n$$\\frac{v_m}{c_m} = \\frac{v_f}{c_f}$$\n代入比例关系$v_m \\propto \\frac{1}{N_m}$和$v_f \\propto \\frac{1}{N_f}$（其中比例常数对两者是相同的），我们得到：\n$$\\frac{1}{c_m N_m} = \\frac{1}{c_f N_f}$$\n这简化为ESS种群状态的核心条件，即著名的Fisher原理：\n$$c_m N_m = c_f N_f$$\n这个条件表明，在ESS时，种群中对儿子的总亲代投资必须等于对女儿的总亲代投资。\n\n问题要求按数量计算的初级性比$p$的条件。根据定义，$p = \\frac{N_m}{N_m + N_f}$，雌性的比例是$1-p = \\frac{N_f}{N_m + N_f}$。我们可以用$p$和种群总规模$N_{tot} = N_m + N_f$来表示$N_m$和$N_f$：\n$$N_m = p N_{tot}$$\n$$N_f = (1-p) N_{tot}$$\n将这些表达式代入ESS条件$c_m N_m = c_f N_f$中：\n$$c_m (p N_{tot}) = c_f ((1-p) N_{tot})$$\n由于$N_{tot}$是非零的，可以从两边消去，得到固有种群初级性比$p$成为ESS的条件：\n$$c_m p = c_f (1-p)$$\n这是所需推导的第一部分。\n\n为了计算给定成本下的ESS初级性比，我们解这个关于$p$的方程：\n$$c_m p = c_f - c_f p$$\n$$c_m p + c_f p = c_f$$\n$$p(c_m + c_f) = c_f$$\n$$p = \\frac{c_f}{c_m + c_f}$$\n这是按数量计算的ESS初级性比的通用表达式。\n\n问题给出了具体成本$c_m = 2$和$c_f = 1$。将这些值代入$p$的表达式中：\n$$p = \\frac{1}{2 + 1} = \\frac{1}{3}$$\n这就是按数量计算的ESS初级性比。在受孕时，种群应由三分之一的雄性和三分之二的雌性组成。这个结果很直观：因为生产儿子的成本是女儿的两倍，所以种群稳定在一个儿子数量是女儿一半的点上，从而使对每个性别的总亲代投资相等。答案是一个精确的有理数。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2709671"}, {"introduction": "Fisher的理论假设了随机交配，但当交配发生在局部小种群内时，情况会发生巨大变化。这项练习探讨了经典的局部配偶竞争（LMC）模型，在这种极端情况下，一个奠基雌性的后代在扩散前进行近亲繁殖[@problem_id:2709690]。通过确定最优的儿子数量，你将亲身体会到种群结构如何能够戏剧性地改变演化稳定的性别比，使其严重偏离均等投入的预期。", "problem": "一个结构化种群由多个亚种群构成，每个亚种群在每一代都由单个受精雌性建立，因此交配完全在其后代之间进行，之后才有扩散。这是局部配偶竞争（Local Mate Competition, LMC）的典型案例。设 $B \\in \\mathbb{N}$ 且 $B \\ge 2$ 表示奠基雌性产生的有限的育雏规模（窝卵数）。她将这 $B$ 个后代中的 $S \\in \\{0,1,2,\\ldots,B\\}$ 个分配为雄性，其余 $B-S$ 个为雌性。假设雄性不扩散，也不在出生亚种群之外繁殖，并且每个雄性都具有无限的交配能力。所有雌性后代在扩散前都在亚种群内部交配，并且只有受精的雌性后代会扩散并对下一代做出贡献。假设在有配偶可用的条件下，兄弟姐妹之间随机配对，因此当 $S \\ge 1$ 时，所有 $B-S$ 个雌性后代都能受精；当 $S=0$ 时，没有雌性后代能受精。\n\n仅使用这些假设和雄性后代预期交配机会的定义（即，当 $S \\ge 1$ 时，在兄弟姐妹间随机匹配的条件下，每个雄性后代的预期交配次数等于 $\\frac{B-S}{S}$；当 $S=0$ 时为 $0$），从第一性原理推导出能使奠基雌性预期受精女儿数量最大化的整数 $S$，从而最大化她通过女儿的预期基因传递。明确说明最佳雄性后代整数数量作为 $B$ 的函数，并根据雄性后代的预期交配机会提供清晰的论证。你的最终答案必须是最佳整数。无需四舍五入，也无需单位。", "solution": "该问题要求推导奠基雌性在固定规模为 $B$ 的一窝后代中应产生的最佳雄性后代数量 $S$，以最大化其预期受精女儿的数量。育雏规模 $B$ 是一个整数，满足 $B \\ge 2$，雄性后代的数量 $S$ 是集合 $\\{0, 1, 2, \\ldots, B\\}$ 中的一个整数。\n\n设 $N_d(S)$ 表示预期受精女儿数量，是雄性后代数量 $S$ 的函数。窝中的雌性后代数量为 $B-S$。题目陈述提供了雌性后代受精的条件：\n1.  如果 $S=0$，窝中没有雄性，因此没有雌性后代可以受精。所以，$N_d(0) = 0$。\n2.  如果 $S \\ge 1$，至少存在一个雄性。鉴于雄性具有无限的交配能力且在兄弟姐妹间随机交配，窝中所有 $B-S$ 个雌性后代都将受精。因此，对于 $S \\in \\{1, 2, \\ldots, B\\}$，$N_d(S) = B-S$。\n\n结合这两个条件，需要最大化的目标函数是：\n$$\nN_d(S) = \\begin{cases} 0  \\text{if } S = 0 \\\\ B-S  \\text{if } S \\in \\{1, 2, \\ldots, B\\} \\end{cases}\n$$\n我们的目标是找到定义域 $\\{0, 1, \\ldots, B\\}$ 中使 $N_d(S)$ 最大化的整数 $S$。\n\n我们首先比较 $S=0$ 和 $S=1$ 的结果。\n对于 $S=0$，$N_d(0) = 0$。\n对于 $S=1$，$N_d(1) = B-1$。\n根据题目的已知条件，$B \\ge 2$，这意味着 $B-1 \\ge 1$。\n因此，$N_d(1) = B-1  0 = N_d(0)$。这表明产生一个雄性后代是比不产生雄性后代更优的策略。因此，$S$ 的最优值必须大于或等于 $1$。\n\n接下来，我们在受限定义域 $S \\in \\{1, 2, \\ldots, B\\}$ 上分析函数 $N_d(S)$。在这个范围内，函数为 $N_d(S) = B-S$。这是一个关于 $S$ 的线性函数，斜率为 $-1$。因此，对于 $S \\ge 1$，$N_d(S)$ 是一个关于 $S$ 的严格递减函数。\n这意味着对于任意两个整数 $S_1$ 和 $S_2$ 满足 $1 \\le S_1  S_2 \\le B$，以下不等式成立：\n$$N_d(S_1) = B - S_1 > B - S_2 = N_d(S_2)$$\n因此，在定义域 $S \\in \\{1, 2, \\ldots, B\\}$ 内，函数 $N_d(S)$ 在 $S$ 的最小可能整数值处取得其最大值，即 $S=1$。\n\n由于 $S=1$ 在 $S \\ge 1$ 的范围内使 $N_d(S)$ 最大化，并且我们已经证明 $S=1$ 处的值大于 $S=0$ 处的值，我们得出结论：在整个定义域 $S \\in \\{0, 1, \\ldots, B\\}$ 上，$N_d(S)$ 的全局最大值出现在 $S=1$ 处。\n\n从雄性后代预期交配机会的角度来看，其论证如下。奠基雌性在将固定的繁殖投入 $B$ 分配给雄性和雌性后代时面临一种权衡。她的目标是最大化受精女儿的数量。\n第一个雄性后代的产生（即选择 $S=1$ 而不是 $S=0$）至关重要。它将结果从 $0$ 个受精女儿转变为 $B-1$ 个受精女儿。这个唯一的雄性后代不面临来自其他雄性的竞争，并有望获得窝内所有可用的交配机会，数量为 $B-1$。这个雄性后代的预期交配次数为 $\\frac{B-1}{1} = B-1$。\n\n现在，考虑产生第二个雄性后代的边际效应（将 $S$ 从 $1$ 增加到 $2$）。这个分配决策的直接成本是减少一个雌性后代，使雌性后代的数量从 $B-1$ 减少到 $B-2$。因此，受精女儿的数量也减少到 $B-2$。就其既定目标而言，第二个雄性后代没有为奠基雌性提供任何额外的好处，因为由于无限交配能力的假设，第一个雄性后代已经足以使所有可用的雌性后代受精。相反，第二个雄性后代的存在引入了竞争。这两个雄性后代现在必须共享 $B-2$ 次可用的交配机会，每个雄性后代的预期交配次数下降到 $\\frac{B-2}{2}$。\n\n总的来说，对于任何 $S \\ge 1$，每多产生一个雄性后代，都是以牺牲一个雌性后代为代价的。这直接导致受精女儿的数量减少一个，从 $B-S$ 减少到 $B-(S+1)$。额外的雄性后代只会加剧兄弟之间为争夺日益缩小的姐妹群体而进行的局部配偶竞争的强度，这反映在随着 $S$ 增加，每个雄性后代的预期交配次数 $\\frac{B-S}{S}$ 的值在减小。由于目标是严格最大化受精女儿的数量，并且任何超过第一个的雄性后代都对这个目标有害，因此奠基雌性的最优策略是产生确保受精所需的绝对最少数量的雄性后代。这个数量恰好是1。\n\n因此，最佳雄性后代整数数量是 $1$。", "answer": "$$\\boxed{1}$$", "id": "2709690"}, {"introduction": "理解演化稳定策略（ESS）是什么固然重要，但探索种群如何随时间演化到该策略同样关键。此练习将引导你使用适应性动力学（adaptive dynamics）的框架，这是一个强大的工具，用于模拟连续性状的长期演化[@problem_id:2709650]。你将推导出性别分配性状的演化轨迹，从而将静态的ESS概念与种群性状在演化时间尺度上的动态变化过程联系起来。", "problem": "考虑一个处于种群动态平衡状态下的大型、均匀混合的无性单倍体种群，其中个体表达一个连续的性分配性状 $z \\in (0,1)$，该性状被解释为投入到雄性后代上的繁殖资源比例（因此投入到雌性后代上的比例为 $1 - z$）。一个驻留种群在性状值 $z$ 上是单态的，并且稀有突变体以性状值 $z_{\\mathrm{m}}$ 出现。假设每单位投入到雄性后代的资源返回的繁殖价值与 $1/z$ 成正比，每单位投入到雌性后代的资源返回的繁殖价值与 $1/(1 - z)$ 成正比，这反映了 Fisher 的繁殖价值论，即在随机交配下，较稀有的性别具有更高的边际繁殖成功率。因此，一个性状为 $z_{\\mathrm{m}}$ 的稀有突变体在驻留环境 $z$ 中的期望个体马尔萨斯适应度可以写成\n$$\nW(z_{\\mathrm{m}},z) \\propto z_{\\mathrm{m}} \\cdot \\frac{1}{z} + (1 - z_{\\mathrm{m}})\\cdot \\frac{1}{1 - z}.\n$$\n假设演化在适应性动态学（AD）的假设下通过性状替代序列进行：突变是稀有的，效应小，并以每个新生个体 $\\mu$ 的速率出现；驻留种群维持一个恒定的种群动态平衡规模 $N$；$z$ 的突变偏差呈对称分布，均值为零，方差为 $V_{m}$；成功的突变体替代具有小的选择系数，该系数由在 $z_{\\mathrm{m}} = z$ 处评估的入侵适应度梯度确定。从这些假设和定义出发，完成以下任务：\n\n- 推导关于突变性状在 $z_{\\mathrm{m}} = z$ 处评估的选择梯度，并用它来获得在小突变步长和方差 $V_{m}$ 下 $z(t)$ 的适应性动态学标准方程，将方程右侧用 $\\mu$、$N$、$V_{m}$ 和选择梯度表示。\n- 确定使选择梯度为零的奇异策略 $z^{\\ast}$。\n- 使用选择梯度在 $z^{\\ast}$ 邻域内的一阶（线性）近似，求解所得的关于演化轨迹 $z(t)$ 的微分方程，其初始条件为 $z(0) = z_{0} \\in (0,1)$，并提供 $z(t)$ 的一个用 $z_{0}$、$\\mu$、$N$、$V_{m}$ 和 $t$ 表示的显式闭式表达式。\n\n将你的最终答案表述为 $z(t)$ 的显式表达式。无需四舍五入。性状 $z$ 是无量纲的。", "solution": "该问题陈述经过评估，被确定在适应性动态学框架的标准解释下具有科学依据、内部一致且是良定的。因此，我们可以着手求解。\n\n该问题描述了性分配性状 $z \\in (0,1)$ 的演化，它代表对雄性后代的投资。在一个性状为 $z$ 的驻留种群中，一个性状为 $z_{\\mathrm{m}}$ 的稀有突变体的个体马尔萨斯适应度由 $W(z_{\\mathrm{m}},z) \\propto z_{\\mathrm{m}} \\cdot \\frac{1}{z} + (1 - z_{\\mathrm{m}})\\cdot \\frac{1}{1 - z}$ 给出。使用正比符号引入了一个任意正常数。我们不失一般性地将此常数设为 $1$，因为它只会缩放演化速率，而不会改变选择方向或演化平衡点的位置。因此，我们使用以下入侵适应度函数：\n$$\nW(z_{\\mathrm{m}},z) = \\frac{z_{\\mathrm{m}}}{z} + \\frac{1 - z_{\\mathrm{m}}}{1 - z}\n$$\n\n**1. 选择梯度和标准方程的推导**\n\n选择梯度 $S(z)$ 是入侵适应度函数关于突变性状 $z_{\\mathrm{m}}$ 的导数，在突变体和驻留性状相等的点 $z_{\\mathrm{m}} = z$ 处求值。\n$$\nS(z) = \\frac{\\partial W(z_{\\mathrm{m}}, z)}{\\partial z_{\\mathrm{m}}} \\bigg|_{z_{\\mathrm{m}}=z}\n$$\n首先，我们计算关于 $z_{\\mathrm{m}}$ 的偏导数：\n$$\n\\frac{\\partial W(z_{\\mathrm{m}}, z)}{\\partial z_{\\mathrm{m}}} = \\frac{\\partial}{\\partial z_{\\mathrm{m}}} \\left( \\frac{z_{\\mathrm{m}}}{z} + \\frac{1 - z_{\\mathrm{m}}}{1 - z} \\right) = \\frac{1}{z} - \\frac{1}{1 - z}\n$$\n该导数与 $z_{\\mathrm{m}}$ 无关，因此在 $z_{\\mathrm{m}} = z$ 处求值得到：\n$$\nS(z) = \\frac{1}{z} - \\frac{1}{1 - z} = \\frac{(1-z) - z}{z(1-z)} = \\frac{1 - 2z}{z(1-z)}\n$$\n适应性动态学的标准方程描述了驻留性状 $z$ 随演化时间 $t$ 的变化。在给定假设（稀有且效应小的突变，恒定的种群大小）下，该方程可表述为：\n$$\n\\frac{dz}{dt} = \\frac{1}{2} \\mu N V_{m} S(z)\n$$\n其中 $\\mu$ 是突变率，$N$ 是种群大小，$V_{m}$ 是突变效应分布的方差。代入选择梯度的表达式，我们得到：\n$$\n\\frac{dz}{dt} = \\frac{1}{2} \\mu N V_{m} \\left( \\frac{1 - 2z}{z(1-z)} \\right)\n$$\n\n**2. 奇异策略的确定**\n\n奇异策略（记为 $z^{\\ast}$）是使选择梯度为零的性状值。它代表了一个潜在的演化终点。\n$$\nS(z^{\\ast}) = 0\n$$\n使用我们得到的 $S(z)$ 表达式：\n$$\n\\frac{1 - 2z^{\\ast}}{z^{\\ast}(1-z^{\\ast})} = 0\n$$\n因为 $z^{\\ast} \\in (0,1)$，分母 $z^{\\ast}(1-z^{\\ast})$ 非零。因此，分子必须为零：\n$$\n1 - 2z^{\\ast} = 0 \\implies z^{\\ast} = \\frac{1}{2}\n$$\n该奇异策略是对雄性和雌性后代进行均等投资，即经典的Fisherian性别比。\n\n**3. 演化轨迹的线性化与求解**\n\n为了找到 $z(t)$ 的显式解，我们通过线性化选择梯度来分析奇异策略 $z^{\\ast} = \\frac{1}{2}$ 邻域内的动态。我们使用 $S(z)$ 在 $z^{\\ast}$ 附近的一阶泰勒展开：\n$$\nS(z) \\approx S(z^{\\ast}) + (z - z^{\\ast}) \\frac{dS}{dz}\\bigg|_{z=z^{\\ast}}\n$$\n由于 $S(z^{\\ast}) = 0$，上式简化为 $S(z) \\approx (z - z^{\\ast})S'(z^{\\ast})$。我们必须计算 $S(z)$ 的导数：\n$$\nS(z) = z^{-1} - (1-z)^{-1}\n$$\n$$\nS'(z) = \\frac{dS}{dz} = -1 \\cdot z^{-2} - (-1)(1-z)^{-2}(-1) = -\\frac{1}{z^{2}} - \\frac{1}{(1-z)^{2}}\n$$\n在奇异策略 $z^{\\ast} = \\frac{1}{2}$ 处计算该导数：\n$$\nS'\\left(\\frac{1}{2}\\right) = -\\frac{1}{(\\frac{1}{2})^{2}} - \\frac{1}{(1-\\frac{1}{2})^{2}} = -\\frac{1}{1/4} - \\frac{1}{1/4} = -4 - 4 = -8\n$$\n线性化后的选择梯度为 $S(z) \\approx -8(z - \\frac{1}{2})$。将其代入标准方程，得到线性化的常微分方程（ODE）：\n$$\n\\frac{dz}{dt} = \\frac{1}{2} \\mu N V_{m} \\left[ -8\\left(z - \\frac{1}{2}\\right) \\right] = -4 \\mu N V_{m} \\left(z - \\frac{1}{2}\\right)\n$$\n这是一个一阶线性常微分方程。为了求解它，令 $y(t) = z(t) - \\frac{1}{2}$。这意味着 $\\frac{dy}{dt} = \\frac{dz}{dt}$。初始条件为 $y(0) = z(0) - \\frac{1}{2} = z_{0} - \\frac{1}{2}$。该常微分方程变为：\n$$\n\\frac{dy}{dt} = -4 \\mu N V_{m} y\n$$\n这是指数衰减方程，其解为 $y(t) = y(0) \\exp(-4 \\mu N V_{m} t)$。代回 $z(t)$：\n$$\nz(t) - \\frac{1}{2} = \\left(z_{0} - \\frac{1}{2}\\right) \\exp(-4 \\mu N V_{m} t)\n$$\n解出 $z(t)$，我们得到演化轨迹的最终表达式：\n$$\nz(t) = \\frac{1}{2} + \\left(z_{0} - \\frac{1}{2}\\right) \\exp(-4 \\mu N V_{m} t)\n$$\n该解表明，性分配性状 $z(t)$ 从任何初始条件 $z_{0} \\in (0,1)$ 指数收敛到奇异策略 $z^{\\ast} = \\frac{1}{2}$。$S'(z^{\\ast})$ 的负号证实了 $z^{\\ast}$ 是一个收敛稳定策略。", "answer": "$$\n\\boxed{\\frac{1}{2} + \\left(z_{0} - \\frac{1}{2}\\right) \\exp(-4 \\mu N V_{m} t)}\n$$", "id": "2709650"}]}