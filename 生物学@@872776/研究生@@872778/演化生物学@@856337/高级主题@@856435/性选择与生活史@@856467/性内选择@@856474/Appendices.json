{"hands_on_practices": [{"introduction": "理论是重要的，但进化生物学最终是一门依赖于可衡量指标的科学。为了量化性选择的强度，研究人员开发了两个核心概念：性选择的机会 ($I_s$) 和贝特曼梯度 ($\\beta_{ss}$)。这个练习将指导你从基本的种群统计数据（例如交配成功的均值和方差）中推导出这些关键指标，让你亲身体验如何将观察数据转化为对性选择潜力的有意义的衡量。[@problem_id:2727284]", "problem": "您正在研究一个性别内的性内选择，该性别中的个体为争夺配偶而竞争。设交配成功数为随机变量 $m$（即个体在一次繁殖期内获得的配偶数量），其样本均值为 $\\bar{m}=2.0$，样本方差为 $\\mathrm{Var}(m)=3.0$。个体繁殖成功度（绝对适合度）建模为 $w=1+0.8\\,m+\\varepsilon$，其中 $\\varepsilon$ 是一个均值为零的残差，代表围绕线性均值的、具有泊松误差结构的随机人口噪音。假设 $m$ 和 $\\varepsilon$ 是独立的，并且对于给定 $m$ 时 $w$ 的条件均值，回归设定是正确的。\n\n仅从性选择理论和回归分析的核心定义出发，不使用任何现成公式，完成以下任务：\n\n1) 定义相对交配成功数 $\\tilde{m}$ 和相对适合度 $\\tilde{w}$，并从基本原理出发，将性选择机会 $I_{s}$ 推导为相对交配成功数的方差。然后根据所提供的汇总统计量计算 $I_{s}$。\n\n2) 将特定性别的贝特曼梯度 $\\beta_{ss}$ 定义为目标性别内相对适合度对相对交配成功数的线性回归斜率。从给定的 $w$ 的条件均值模型和相对量的定义出发，推导出一个用回归和样本矩表示的 $\\beta_{ss}$ 表达式，并根据所提供的信息计算其数值。\n\n明确说明您所需要的任何假设，并根据基本的统计恒等式（如期望的性质、尺度缩放下的方差以及线性回归斜率与条件期望之间的关系）来证明每个代数步骤的合理性。将最终数值答案四舍五入至四位有效数字，并以无量纲小数形式报告。", "solution": "所述问题具有科学依据、良定且客观。它基于演化生物学的既定原则，特别是性选择的定量分析。所有必要的数据和定义均已提供，不存在会妨碍得出严谨、唯一解的矛盾或含糊之处。该问题要求从基本原理进行推导，而不是应用现成公式，这是一项有效的学术练习。因此，我将开始解答。\n\n主要假设是，为了本次分析的目的，所提供的样本矩（均值 $\\bar{m}$ 和方差 $\\mathrm{Var}(m)$）被视为潜在分布的真实参数。所有推导都将依赖于基本的统计恒等式。\n\n第1部分：性选择机会，$I_{s}$\n\n首先，我们定义相对量。相对交配成功数 $\\tilde{m}$ 是个体的交配成功数 $m$ 按该性别的平均交配成功数 $\\bar{m}$ 进行缩放后的结果。\n$$ \\tilde{m} = \\frac{m}{\\bar{m}} $$\n类似地，相对适合度 $\\tilde{w}$是个体的适合度 $w$ 按该性别的平均适合度 $\\bar{w}$ 进行缩放后的结果。\n$$ \\tilde{w} = \\frac{w}{\\bar{w}} $$\n性选择机会 $I_{s}$ 定义为相对交配成功数的方差。\n$$ I_{s} = \\mathrm{Var}(\\tilde{m}) $$\n我们从此定义推导 $I_{s}$ 的表达式。使用尺度缩放下的方差性质 $\\mathrm{Var}(aX) = a^2 \\mathrm{Var}(X)$，其中 $a$ 是一个常数。在此背景下，$\\bar{m}$ 对于种群样本是一个常数标量。\n$$ I_{s} = \\mathrm{Var}\\left(\\frac{m}{\\bar{m}}\\right) = \\left(\\frac{1}{\\bar{m}}\\right)^2 \\mathrm{Var}(m) = \\frac{\\mathrm{Var}(m)}{\\bar{m}^2} $$\n问题提供了数值 $\\bar{m} = 2.0$ 和 $\\mathrm{Var}(m) = 3.0$。将这些值代入推导出的表达式中：\n$$ I_{s} = \\frac{3.0}{(2.0)^2} = \\frac{3.0}{4.0} = 0.75 $$\n作为一个四位有效数字的无量纲小数，结果是 $0.7500$。\n\n第2部分：特定性别的贝特曼梯度，$\\beta_{ss}$\n\n特定性别的贝特曼梯度 $\\beta_{ss}$ 定义为相对适合度 $\\tilde{w}$ 对相对交配成功数 $\\tilde{m}$ 的线性回归斜率。简单线性回归斜率的公式是两个变量的协方差除以预测变量的方差。\n$$ \\beta_{ss} = \\frac{\\mathrm{Cov}(\\tilde{m}, \\tilde{w})}{\\mathrm{Var}(\\tilde{m})} $$\n分母是我们已经推导出的性选择机会 $I_{s}$。\n$$ \\mathrm{Var}(\\tilde{m}) = I_{s} = \\frac{\\mathrm{Var}(m)}{\\bar{m}^2} $$\n现在我们必须推导分子 $\\mathrm{Cov}(\\tilde{m}, \\tilde{w})$ 的表达式。使用性质 $\\mathrm{Cov}(aX, bY) = ab \\, \\mathrm{Cov}(X, Y)$：\n$$ \\mathrm{Cov}(\\tilde{m}, \\tilde{w}) = \\mathrm{Cov}\\left(\\frac{m}{\\bar{m}}, \\frac{w}{\\bar{w}}\\right) = \\frac{1}{\\bar{m}\\bar{w}} \\mathrm{Cov}(m, w) $$\n为了继续推导，我们需要 $\\bar{w}$ 和 $\\mathrm{Cov}(m, w)$ 的表达式。\n绝对适合度的模型是 $w = 1 + 0.8m + \\varepsilon$。平均适合度 $\\bar{w}$ 是 $w$ 的期望值。\n$$ \\bar{w} = E[w] = E[1 + 0.8m + \\varepsilon] $$\n根据期望的线性性质：\n$$ \\bar{w} = E[1] + 0.8E[m] + E[\\varepsilon] $$\n鉴于 $\\varepsilon$ 是均值为零的残差，所以 $E[\\varepsilon]=0$。我们使用样本均值 $\\bar{m}$ 作为 $E[m]$ 的估计量。\n$$ \\bar{w} = 1 + 0.8\\bar{m} $$\n接下来，我们确定 $\\mathrm{Cov}(m, w)$。\n$$ \\mathrm{Cov}(m, w) = \\mathrm{Cov}(m, 1 + 0.8m + \\varepsilon) $$\n使用协方差的双线性性质：\n$$ \\mathrm{Cov}(m, w) = \\mathrm{Cov}(m, 1) + \\mathrm{Cov}(m, 0.8m) + \\mathrm{Cov}(m, \\varepsilon) $$\n与常数的协方差为零，所以 $\\mathrm{Cov}(m, 1) = 0$。一个变量与其自身缩放版本的协方差是 $\\mathrm{Cov}(m, 0.8m) = 0.8\\mathrm{Cov}(m,m) = 0.8\\mathrm{Var}(m)$。问题陈述 $m$ 和 $\\varepsilon$ 是独立的随机变量。独立性的一个关键性质是独立变量之间的协方差为零。因此，$\\mathrm{Cov}(m, \\varepsilon) = 0$。\n结合这些结果可得：\n$$ \\mathrm{Cov}(m, w) = 0.8\\mathrm{Var}(m) $$\n请注意，关于 $\\varepsilon$ 的泊松误差结构的信息意味着异方差性，即 $\\mathrm{Var}(\\varepsilon|m) = 1+0.8m$。这对于评估回归斜率的精度很重要，但如此处所示，它不影响斜率点估计本身的计算。\n\n现在我们组合出 $\\beta_{ss}$ 的表达式：\n$$ \\beta_{ss} = \\frac{\\mathrm{Cov}(\\tilde{m}, \\tilde{w})}{\\mathrm{Var}(\\tilde{m})} = \\frac{\\frac{1}{\\bar{m}\\bar{w}} \\mathrm{Cov}(m, w)}{\\frac{\\mathrm{Var}(m)}{\\bar{m}^2}} = \\frac{\\bar{m}}{\\bar{w}} \\frac{\\mathrm{Cov}(m, w)}{\\mathrm{Var}(m)} $$\n代入我们关于 $\\mathrm{Cov}(m, w)$ 和 $\\bar{w}$ 的表达式：\n$$ \\beta_{ss} = \\frac{\\bar{m}}{1 + 0.8\\bar{m}} \\frac{0.8\\mathrm{Var}(m)}{\\mathrm{Var}(m)} $$\n$\\mathrm{Var}(m)$ 项相互消去，前提是 $\\mathrm{Var}(m) \\neq 0$，而这是成立的，因为 $\\mathrm{Var}(m)=3.0$。这样就得出了贝特曼梯度的最终推导表达式：\n$$ \\beta_{ss} = \\frac{0.8\\bar{m}}{1 + 0.8\\bar{m}} $$\n最后，我们使用 $\\bar{m} = 2.0$ 计算其数值：\n$$ \\beta_{ss} = \\frac{0.8(2.0)}{1 + 0.8(2.0)} = \\frac{1.6}{1 + 1.6} = \\frac{1.6}{2.6} = \\frac{16}{26} = \\frac{8}{13} $$\n作为一个无量纲小数，其值约为 $0.6153846...$。四舍五入到四位有效数字，结果是 $0.6154$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7500  0.6154\n\\end{pmatrix}\n}\n$$", "id": "2727284"}, {"introduction": "在同性竞争中，个体的成功往往不取决于其策略的绝对好坏，而是取决于种群中其他个体在做什么，这就是频率依赖性选择。进化博弈论是分析这类策略互动并预测其进化结果的强大工具。通过一个经典的“守卫者”与“偷袭者”博弈模型，本练习将让你学会如何确定一个稳定的策略混合，在这种状态下，不同的繁殖策略可以在种群中稳定共存。[@problem_id:2727329]", "problem": "在一个充分混合的无限大种群中，雄性个体为了争夺每次竞争中的单一交配机会而进行性内竞争，个体可以采取两种可替代的繁殖策略之一：“守卫”或“偷袭”。互动是成对的，收益代表每次相遇的预期受精成功率，其中包含了竞争和特定策略行为的收益与成本。假设适应度与预期收益成正比，并且在随机匹配下，选择是频率依赖的。\n\n假设一个使用策略 $i \\in \\{\\text{guard}, \\text{sneak}\\}$ 的焦点个体对抗一个使用策略 $j \\in \\{\\text{guard}, \\text{sneak}\\}$ 的对手时，其收益由以下矩阵给出（矩阵元素为焦点个体每次相遇的预期受精成功率）：\n$$\n\\begin{pmatrix}\na  b \\\\\nc  d\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.2  0.8 \\\\\n0.3  0.5\n\\end{pmatrix},\n$$\n其中，行代表焦点策略，列代表对手策略。例如，$a=0.2$ 是一个“守卫”策略者与另一个“守卫”策略者匹配时的预期收益，而 $c=0.3$ 是一个“偷袭”策略者与一个“守卫”策略者匹配时的预期收益。\n\n请仅使用以下基本原理：(i) 适应度与预期收益成正比；(ii) 在频率依赖选择下，一个包含两种策略的混合策略均衡要求这些策略在种群中具有相等的预期适应度；(iii) 在大种群中的随机匹配产生的预期收益是根据对手频率计算的平均值。从第一性原理出发，推导“守卫”和“偷袭”策略的混合策略均衡频率。将你的最终答案表示为一个单行矩阵，按顺序包含“守卫”和“偷袭”的均衡频率。如果均衡是内部均衡，请提供精确值，不要四舍五入。如果不存在内部均衡，请提供在这些假设下与进化稳定性一致的边界构成。\n\n无需单位。最终答案必须是指定的单行矩阵。", "solution": "此问题已经过验证，被认为是科学上可靠、定义明确且客观的。它提出了一个进化博弈论中的标准问题，为严谨求解提供了所有必要的参数和假设。不存在逻辑矛盾或事实错误。我们可以继续。\n\n设 $p$ 为种群中“守卫”策略的频率，$q$ 为“偷袭”策略的频率。由于只有这两种策略，它们的频率之和必须为1：\n$$p + q = 1$$\n因此，$q = 1 - p$。\n\n问题陈述了互动是成对的，且在无限大的充分混合种群中匹配是随机的。个体的适应度与其预期收益成正比。我们可以将每种策略的预期收益（我们用 $W_G$ 表示守卫策略，用 $W_S$ 表示偷袭策略）表示为守卫策略频率 $p$ 的函数。\n\n使用“守卫”策略的焦点个体的预期收益是其对抗守卫者和偷袭者的收益的加权平均值，权重是这些策略在种群中的频率：\n$$W_G(p) = p \\cdot \\text{Payoff(Guard, Guard)} + (1-p) \\cdot \\text{Payoff(Guard, Sneak)}$$\n使用给定的收益矩阵值 $a = 0.2$ 和 $b = 0.8$，这变为：\n$$W_G(p) = p(0.2) + (1-p)(0.8)$$\n\n类似地，使用“偷袭”策略的焦点个体的预期收益是：\n$$W_S(p) = p \\cdot \\text{Payoff(Sneak, Guard)} + (1-p) \\cdot \\text{Payoff(Sneak, Sneak)}$$\n使用给定的收益矩阵值 $c = 0.3$ 和 $d = 0.5$，这变为：\n$$W_S(p) = p(0.3) + (1-p)(0.5)$$\n\n根据频率依赖选择的基本原理，一个稳定的混合策略均衡，即两种策略在种群中共存（也就是一个内部均衡，其中 $0  p  1$），要求每种策略的预期适应度（收益）相等。设守卫策略的均衡频率为 $p^*$。在此均衡点，我们必须有：\n$$W_G(p^*) = W_S(p^*)$$\n\n代入预期收益的表达式：\n$$p^*(0.2) + (1-p^*)(0.8) = p^*(0.3) + (1-p^*)(0.5)$$\n\n我们现在求解这个关于 $p^*$ 的线性方程。\n首先，展开各项：\n$$0.2p^* + 0.8 - 0.8p^* = 0.3p^* + 0.5 - 0.5p^*$$\n合并两边包含 $p^*$ 的项：\n$$0.8 - 0.6p^* = 0.5 - 0.2p^*$$\n现在，我们将含有 $p^*$ 的项分离到一边，常数项分离到另一边：\n$$0.8 - 0.5 = 0.6p^* - 0.2p^*$$\n$$0.3 = 0.4p^*$$\n求解 $p^*$：\n$$p^* = \\frac{0.3}{0.4} = \\frac{3}{4}$$\n\n这是“守卫”策略的均衡频率。由于 $0  \\frac{3}{4}  1$，这是一个内部均衡。\n“偷袭”策略的均衡频率 $q^*$ 是：\n$$q^* = 1 - p^* = 1 - \\frac{3}{4} = \\frac{1}{4}$$\n\n为了使这个混合均衡是进化稳定策略，一个稀有策略必须能够入侵由另一种策略主导的种群。这对应于条件 $c > a$（偷袭者入侵守卫者种群）和 $b > d$（守卫者入侵偷袭者种群）。\n让我们用给定的收益来检查这些条件：\n1. 是否 $c > a$？即 $0.3 > 0.2$？是的，此条件成立。\n2. 是否 $b > d$？即 $0.8 > 0.5$？是的，此条件也成立。\n由于两个条件都满足，计算出的内部不动点是一个进化稳定策略（ESS）。\n\n均衡频率是“守卫”策略为 $p^* = \\frac{3}{4}$，“偷袭”策略为 $q^* = \\frac{1}{4}$。问题要求将答案表示为按此顺序包含这些频率的单行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{4}  \\frac{1}{4}\n\\end{pmatrix}\n}\n$$", "id": "2727329"}, {"introduction": "生物体的性状通常不是孤立的；它们通过发育和功能上的联系而相互关联。因此，作用于一个性状（如体型）的选择可能会间接导致另一个相关性状（如武器尺寸）的进化。为了区分直接选择和这种由性状相关引起的间接选择，Lande 和 Arnold 提出了一个多变量选择框架。这个练习将让你应用这一重要方法，通过分析一个包含多个相关性状的假设数据集，来精确地估算作用于武器长度的直接选择梯度 $\\boldsymbol{\\beta}$，从而揭示选择的真实目标。[@problem_id:2727317]", "problem": "在一个进行性内竞争的雄性犀牛甲虫种群中，假设有三个数量性状通过其对争斗的影响来影响交配成功率：武器（角）长度 $W$、体型大小 $B$ 和攻击性展示强度 $A$。在分析之前，这些性状被标准化为均值为 $0$、方差为 $1$。相对适合度被测量为个体交配成功率除以种群平均交配成功率，因此种群平均相对适合度等于 $1$。\n\n给定：\n- 标准化性状间的表型方差-协方差矩阵，\n$$\n\\mathbf{P} \\;=\\;\n\\begin{pmatrix}\n1.00  0.40  0.20\\\\\n0.40  1.00  0.30\\\\\n0.20  0.30  1.00\n\\end{pmatrix},\n$$\n- 表型选择差异向量（即，每个标准化性状与相对适合度之间的协方差），\n$$\n\\mathbf{S} \\;=\\;\n\\begin{pmatrix}\n0.12\\\\\n0.08\\\\\n-0.02\n\\end{pmatrix}.\n$$\n\n使用多元选择框架，其中定向选择梯度被定义为相对适合度对各性状的偏回归系数向量，推断武器长度 $W$ 的定向选择梯度分量。请将您的答案报告为一个无单位小数，并四舍五入到四位有效数字。", "solution": "该问题是有效的。这是由 Lande 和 Arnold 发展的多元选择框架的一个标准应用，该框架是数量演化遗传学中将选择分解为直接和间接分量的基本工具。\n\n关联选择差异向量 $\\mathbf{S}$、表型方差-协方差矩阵 $\\mathbf{P}$ 和定向选择梯度向量 $\\boldsymbol{\\beta}$ 的核心方程是一个多元回归模型：\n$$ \\mathbf{S} = \\mathbf{P} \\boldsymbol{\\beta} $$\n在这里，性状是武器长度（$W$）、体型大小（$B$）和攻击性展示强度（$A$）。向量 $\\mathbf{S}$ 表示对每个性状的总选择（直接和间接），测量为性状与相对适合度之间的协方差。向量 $\\boldsymbol{\\beta}$ 表示对每个性状的直接选择，同时在统计上保持其他性状不变。它是相对适合度对标准化性状的偏回归系数向量。\n\n给定的量是：\n$$ \\mathbf{P} \\;=\\; \\begin{pmatrix} 1.00  0.40  0.20\\\\ 0.40  1.00  0.30\\\\ 0.20  0.30  1.00 \\end{pmatrix} $$\n$$ \\mathbf{S} \\;=\\; \\begin{pmatrix} 0.12\\\\ 0.08\\\\ -0.02 \\end{pmatrix} $$\n选择梯度向量是 $\\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_W \\\\ \\beta_B \\\\ \\beta_A \\end{pmatrix}$。我们的目标是确定武器长度的分量 $\\beta_W$。\n\n为了求出 $\\boldsymbol{\\beta}$，我们必须求解这个线性方程组。这可以通过在方程两边左乘表型方差-协方差矩阵的逆矩阵 $\\mathbf{P}^{-1}$ 来实现：\n$$ \\mathbf{P}^{-1} \\mathbf{S} = \\mathbf{P}^{-1} \\mathbf{P} \\boldsymbol{\\beta} $$\n$$ \\boldsymbol{\\beta} = \\mathbf{P}^{-1} \\mathbf{S} $$\n第一步是计算 $\\mathbf{P}$ 的逆矩阵。一个矩阵 $\\mathbf{A}$ 的逆矩阵由 $\\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\text{adj}(\\mathbf{A})$ 给出，其中 $\\text{adj}(\\mathbf{A})$ 是 $\\mathbf{A}$ 的伴随矩阵。\n\n首先，我们计算 $\\mathbf{P}$ 的行列式：\n$$ \\det(\\mathbf{P}) = 1.00((1.00)(1.00) - (0.30)(0.30)) - 0.40((0.40)(1.00) - (0.30)(0.20)) + 0.20((0.40)(0.30) - (1.00)(0.20)) $$\n$$ \\det(\\mathbf{P}) = 1.00(1.00 - 0.09) - 0.40(0.40 - 0.06) + 0.20(0.12 - 0.20) $$\n$$ \\det(\\mathbf{P}) = 1.00(0.91) - 0.40(0.34) + 0.20(-0.08) $$\n$$ \\det(\\mathbf{P}) = 0.91 - 0.136 - 0.016 = 0.758 $$\n由于行列式不为零，该矩阵是可逆的。\n\n接下来，我们求 $\\mathbf{P}$ 的伴随矩阵，它是其代数余子式矩阵的转置。对于像 $\\mathbf{P}$ 这样的对称矩阵，其代数余子式矩阵也是对称的，因此伴随矩阵等于代数余子式矩阵。代数余子式矩阵的元素 $C_{ij}$ 由 $(-1)^{i+j}$ 乘以去掉第 $i$ 行和第 $j$ 列后得到的子矩阵的行列式给出。\n$$\nC_{11} = (1.00)(1.00) - (0.30)(0.30) = 0.91 \\\\\nC_{12} = -((0.40)(1.00) - (0.30)(0.20)) = -0.34 \\\\\nC_{13} = (0.40)(0.30) - (1.00)(0.20) = -0.08 \\\\\nC_{21} = C_{12} = -0.34 \\\\\nC_{22} = (1.00)(1.00) - (0.20)(0.20) = 0.96 \\\\\nC_{23} = -((1.00)(0.30) - (0.40)(0.20)) = -0.22 \\\\\nC_{31} = C_{13} = -0.08 \\\\\nC_{32} = C_{23} = -0.22 \\\\\nC_{33} = (1.00)(1.00) - (0.40)(0.40) = 0.84\n$$\n所以，逆矩阵 $\\mathbf{P}^{-1}$ 是：\n$$ \\mathbf{P}^{-1} = \\frac{1}{0.758} \\begin{pmatrix} 0.91  -0.34  -0.08 \\\\ -0.34  0.96  -0.22 \\\\ -0.08  -0.22  0.84 \\end{pmatrix} $$\n现在我们可以通过将 $\\mathbf{P}^{-1}$ 乘以 $\\mathbf{S}$ 来计算选择梯度向量 $\\boldsymbol{\\beta}$：\n$$ \\boldsymbol{\\beta} = \\frac{1}{0.758} \\begin{pmatrix} 0.91  -0.34  -0.08 \\\\ -0.34  0.96  -0.22 \\\\ -0.08  -0.22  0.84 \\end{pmatrix} \\begin{pmatrix} 0.12 \\\\ 0.08 \\\\ -0.02 \\end{pmatrix} $$\n我们被要求求这个向量的第一个分量 $\\beta_W$：\n$$ \\beta_W = \\frac{1}{0.758} [(0.91)(0.12) + (-0.34)(0.08) + (-0.08)(-0.02)] $$\n$$ \\beta_W = \\frac{1}{0.758} [0.1092 - 0.0272 + 0.0016] $$\n$$ \\beta_W = \\frac{1}{0.758} [0.0836] $$\n$$ \\beta_W \\approx 0.110290237... $$\n问题要求答案四舍五入到四位有效数字。这得到：\n$$ \\beta_W \\approx 0.1103 $$\n这个结果，即武器长度的选择梯度，表明对角长度存在直接的正向定向选择。其大小略小于选择差异（$S_W = 0.12$），这意味着对相关性状（体型大小和攻击性）的选择所产生的间接效应轻微地夸大了角长度上的表观总选择，但选择的主要驱动力是直接的。", "answer": "$$\\boxed{0.1103}$$", "id": "2727317"}]}