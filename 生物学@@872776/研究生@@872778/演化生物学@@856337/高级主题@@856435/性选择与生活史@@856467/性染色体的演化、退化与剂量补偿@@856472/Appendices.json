{"hands_on_practices": [{"introduction": "要理解性染色体为何会退化，我们必须首先掌握起作用的基本群体遗传学力量。本练习将引导您从第一性原理出发，推导不同类型染色体的预期溯祖时间。通过这一过程，您将定量地证明Y染色体拷贝数的减少如何导致更强的遗传漂变，从而为其进化衰退奠定了基础。[@problem_id:2750928]", "problem": "在一个全随机交配 (panmictic)、大小恒定的 Wright–Fisher 种群中，世代不重叠且个体随机交配，考虑一个由 $N$ 个二倍体个体组成的种群，其性别比相等，即每代有 $N/2$ 个雌性和 $N/2$ 个雄性。假设是中性的，没有种群结构，并且子代的每个基因拷贝根据其遗传方式，从上一代亲本的相应基因拷贝库中随机均匀地选择其亲本基因拷贝。对于常染色体位点，每个二倍体个体携带 $2$ 个拷贝；对于X连锁位点，每个雌性携带 $2$ 个拷贝，每个雄性携带 $1$ 个拷贝；对于Y连锁位点，只有雄性携带 $1$ 个拷贝。\n\n仅使用关于 Wright–Fisher 抽样和孟德尔遗传的基本原理，并且不引用现成的有效种群大小公式，推导从当前世代随机抽取的 $2$ 个序列样本在以下每种位点类型（常染色体、X连锁和Y连锁）上到达最近共同祖先（MRCA）的预期时间（以世代为单位）。将您的最终结果表示为关于 $N$ 的单个行向量 $(T_{A}, T_{X}, T_{Y})$，其中 $T_{A}$ 是常染色体位点的预期成对溯祖时间，$T_{X}$ 是X连锁位点的预期成对溯祖时间，$T_{Y}$ 是Y连锁位点的预期成对溯祖时间。不需要四舍五入。仅提供最终表达式；最终方框答案中不要包含单位。\n\n在推导过程中，简要说明不同位点类型的基因拷贝数量差异如何与随机遗传漂变强度的差异相关联，这些差异是性染色体退化模式的基础，并促使了剂量补偿机制的产生，但不要提供定性论述。答案必须是封闭形式的表达式。", "solution": "我们从 Wright–Fisher 模型的定义开始：在每一代中，子代的每个基因拷贝都会从上一代能够产生该位点类型的基因拷贝库中，独立地、随机均匀地选择其亲本基因拷贝。考虑将谱系向后追溯。对于同一位点类型的 $2$ 个谱系的样本，它们在上一代发生溯祖合并的每代概率，是两个独立的亲本基因拷贝随机选择事件选中了同一个祖先基因拷贝的概率。如果在上一代的相关基因库中有 $M$ 个基因拷贝，那么这两个选择是独立的，并且在 $\\{1,\\dots,M\\}$ 上均匀分布。因此，它们选择同一个亲本拷贝的概率是\n$$\np_{\\text{coal}} \\;=\\; \\sum_{i=1}^{M} \\left(\\frac{1}{M}\\right)^{2} \\;=\\; \\frac{1}{M}.\n$$\n这对谱系发生溯祖合并的等待时间 $T$（以离散世代为单位）服从几何分布，每代的成功概率为 $p_{\\text{coal}}$，因此预期等待时间为\n$$\n\\mathbb{E}[T] \\;=\\; \\frac{1}{p_{\\text{coal}}} \\;=\\; M.\n$$\n因此，要获得预期的成对溯祖时间，只需确定 $M$，即在给定世代中该位点类型的基因拷贝数。\n\n常染色体位点：\n$N$ 个二倍体个体中的每一个都携带 $2$ 个常染色体基因拷贝。因此，\n$$\nM_{A} \\;=\\; 2N,\n$$\n预期的成对溯祖时间为\n$$\nT_{A} \\;=\\; \\mathbb{E}[T] \\;=\\; M_{A} \\;=\\; 2N.\n$$\n\nX连锁位点：\n$N/2$ 个雌性中的每一个携带 $2$ 条X染色体，贡献了 $2\\cdot (N/2)=N$ 个X拷贝，$N/2$ 个雄性中的每一个携带 $1$ 条X染色体，贡献了 $(N/2)$ 个X拷贝。因此，每代X连锁基因拷贝的总数为\n$$\nM_{X} \\;=\\; N \\;+\\; \\frac{N}{2} \\;=\\; \\frac{3}{2}N.\n$$\n因为 Wright–Fisher 抽样意味着子代的每个X连锁基因拷贝都会从上一代的整个X拷贝库中均匀地选择其亲本X拷贝（通过孟德尔遗传：雌性后代中的X染色体同样可能来自其母亲或父亲，而雄性后代中的X染色体必须来自其母亲；在随机交配和性别比相等的情况下，这些遗传规则共同地、均匀地将祖先关系重新分配到上一代的 $M_{X}$ 个X拷贝上），所以两个X连锁谱系的每代溯祖合并概率为 $1/M_{X}$，预期的成对溯祖时间为\n$$\nT_{X} \\;=\\; \\mathbb{E}[T] \\;=\\; M_{X} \\;=\\; \\frac{3}{2}N.\n$$\n\nY连锁位点：\n只有雄性携带Y染色体，每个雄性一个拷贝。有 $N/2$ 个雄性，所以Y连锁基因拷贝的数量是\n$$\nM_{Y} \\;=\\; \\frac{N}{2}.\n$$\n根据同样的论证，两个Y连锁谱系在上一代发生溯祖合并的概率为 $1/M_{Y}$，因此预期的成对溯祖时间为\n$$\nT_{Y} \\;=\\; \\mathbb{E}[T] \\;=\\; M_{Y} \\;=\\; \\frac{N}{2}.\n$$\n\n汇总结果，以世代为单位的预期成对溯祖时间的行向量是\n$$\n\\left(T_{A},\\, T_{X},\\, T_{Y}\\right) \\;=\\; \\left(2N,\\, \\frac{3}{2}N,\\, \\frac{1}{2}N\\right).\n$$\n\n与漂变、退化和剂量补偿的联系：基因拷贝数 $M$ 决定了每代溯祖合并概率 $1/M$，从而决定了中性（及弱选择）变异所经历的随机遗传漂变的强度。较小的 $M$ 意味着更快的溯祖合并和更强的漂变。排序 $\\frac{N}{2}  \\frac{3}{2}N  2N$ 意味着Y连锁位点具有最短的谱系时间尺度（最强的漂变），这促进了有害突变的积累，并导致了Y染色体的退化。X连锁位点具有中等强度的漂变，而常染色体位点的漂变最弱。尽管性别间的染色体拷贝数不同，但这些在拷贝数和漂变上的差异是驱动剂量补偿机制演化的演化动力之一，该机制旨在平衡不同性别间的基因表达。", "answer": "$$\\boxed{\\begin{pmatrix}2N  \\tfrac{3}{2}N  \\tfrac{1}{2}N\\end{pmatrix}}$$", "id": "2750928"}, {"introduction": "明确了Y染色体上的基因容易丢失后，下一个关键问题是这种丢失如何影响适应度。本题使用一个更贴近现实的模型来探讨此问题，其中适应度是基因表达水平的一个直接但非线性的函数。通过这个练习，您将学会量化抵抗基因丢失的选择压力，并理解剂量补偿机制如何能够减轻这些负面影响，从而影响Y染色体上基因的命运。[@problem_id:2750941]", "problem": "在一个雄性为XY型、雌性为XX型的物种中，一个剂量敏感基因最初以同源对的形式存在于X和Y染色体上。在祖先状态下，雄性携带两个功能性拷贝（一个在X上，一个在Y上），雌性携带两个功能性拷贝（两个都在X上）。假设基因表达量与功能性拷贝数乘以每个拷贝的表达量成正比。设祖先状态下每个拷贝的表达量归一化为$1$，因此总表达量等于功能性拷贝数。\n\n假设一个功能丧失性突变删除了雄性中Y染色体上的拷贝，使雄性的功能性拷贝数从$2$减少到$1$。假设存在部分剂量补偿：雄性中剩余的单个X连锁拷贝的表达量相对于祖先每个拷贝的水平上调了$\\delta$的比例，因此Y染色体丢失后雄性的总表达量为$x_{\\mathrm{loss}} = (1+\\delta)$。设野生型雄性的表达量为$x_{\\mathrm{wt}}=2$。\n\n考虑一个凹的、递增的适应度-表达量关系，该关系捕捉了表达量对生物体适应度的边际效益递减，由幂律函数给出\n$$\nW(x) = \\left(\\frac{x}{2}\\right)^{\\gamma},\n$$\n其中$0\\gamma1$量化了凹度，并且$W(2)=1$将祖先野生型雄性的适应度设定为$1$。\n\n使用针对雄性Y基因丢失突变的选择系数的定义\n$$\ns_Y \\equiv 1 - \\frac{W(x_{\\mathrm{loss}})}{W(x_{\\mathrm{wt}})},\n$$\n从第一性原理出发，推导$s_Y$关于$\\gamma$和$\\delta$的表达式。然后，对$\\gamma = 0.5$和$\\delta = 0.2$的情况，计算$s_Y$的数值。\n\n将$s_Y$的最终数值以小数形式表示，并四舍五入到四位有效数字。不需要单位，也不要使用百分号。", "solution": "该问题已经过验证，被认为是科学上合理、阐述清晰且客观的。它提出了一个关于基因剂量和性染色体进化的演化遗传学标准理论模型。我们将着手进行推导和计算。\n\n目标是推导出针对雄性Y连锁基因丢失突变的选择系数$s_Y$的表达式，然后计算其在特定参数下的数值。\n\n选择系数定义为：\n$$\ns_Y \\equiv 1 - \\frac{W(x_{\\mathrm{loss}})}{W(x_{\\mathrm{wt}})}\n$$\n其中$W(x_{\\mathrm{wt}})$是野生型雄性的适应度，$W(x_{\\mathrm{loss}})$是携带Y基因丢失突变的雄性的适应度。\n\n适应度函数由幂律关系给出：\n$$\nW(x) = \\left(\\frac{x}{2}\\right)^{\\gamma}\n$$\n其中$x$是总基因表达水平。\n\n首先，我们确定野生型雄性的适应度。题目说明野生型雄性有两个功能性基因拷贝，每个拷贝的表达水平为$1$。因此，总表达量为$x_{\\mathrm{wt}} = 2$。将此代入适应度函数，得到：\n$$\nW(x_{\\mathrm{wt}}) = W(2) = \\left(\\frac{2}{2}\\right)^{\\gamma} = 1^{\\gamma} = 1\n$$\n这证实了题目陈述中的归一化，即祖先野生型适应度为$1$。\n\n接下来，我们确定具有Y基因丢失突变的雄性的适应度。该突变删除了Y连锁拷贝，只留下一个X连锁拷贝。存在部分剂量补偿，即这个剩余拷贝的表达量相对于祖先每个拷贝的水平$1$上调了$\\delta$的比例。因此，每个拷贝的表达量变为$1+\\delta$。由于只有一个拷贝，突变雄性的总表达量为：\n$$\nx_{\\mathrm{loss}} = 1 \\cdot (1+\\delta) = 1+\\delta\n$$\n因此，这个突变雄性的适应度为：\n$$\nW(x_{\\mathrm{loss}}) = W(1+\\delta) = \\left(\\frac{1+\\delta}{2}\\right)^{\\gamma}\n$$\n现在，我们可以将$W(x_{\\mathrm{wt}})$和$W(x_{\\mathrm{loss}})$的表达式代回选择系数$s_Y$的定义中：\n$$\ns_Y = 1 - \\frac{\\left(\\frac{1+\\delta}{2}\\right)^{\\gamma}}{1}\n$$\n这简化为选择系数关于参数$\\gamma$和$\\delta$的一般表达式：\n$$\ns_Y = 1 - \\left(\\frac{1+\\delta}{2}\\right)^{\\gamma}\n$$\n这完成了任务的第一部分。\n\n对于第二部分，我们必须计算在特定参数值$\\gamma = 0.5$和$\\delta = 0.2$下$s_Y$的值。将这些值代入我们推导出的表达式中：\n$$\ns_Y = 1 - \\left(\\frac{1+0.2}{2}\\right)^{0.5}\n$$\n我们分步进行计算：\n$$\ns_Y = 1 - \\left(\\frac{1.2}{2}\\right)^{0.5} = 1 - (0.6)^{0.5} = 1 - \\sqrt{0.6}\n$$\n计算数值：\n$$\n\\sqrt{0.6} \\approx 0.77459666924\n$$\n因此，\n$$\ns_Y \\approx 1 - 0.77459666924 = 0.22540333076\n$$\n题目要求最终答案四舍五入到四位有效数字。前四位有效数字是$2$、$2$、$5$和$4$。其后的数字是$0$，所以我们不进行进位。\n$$\ns_Y \\approx 0.2254\n$$\n这是在指定条件下针对Y基因丢失突变的选择系数。$s_Y = 0.2254$的值表示携带该突变的雄性与野生型雄性相比，适应度降低了约$22.54\\%$。", "answer": "$$\n\\boxed{0.2254}\n$$", "id": "2750941"}, {"introduction": "剂量补偿的进化是对基因丢失的一种响应，但这种调控机制在分子水平上是如何实时运作的？最后一个练习将我们的焦点从长期进化转移到基因调控的即时动态。您将建立一个动力学模型，并将其应用于时间序列转录组数据，以估计剂量补偿背后关键过程的速率，从而将抽象的进化理论与系统生物学中具体的数据分析联系起来。[@problem_id:2750868]", "problem": "您的任务是形式化并解决一个基于性染色体剂量补偿生物学原理的参数估计问题。考虑一个单基因转录本，其表达受到调控，以缓冲新进化出的性染色体上的拷贝数变化。使用以下从转录动力学和稳态调节的第一性原理推導出的最小模型。\n\n基本假设和定义：\n- 转录本的产生和降解遵循分子生物学中心法则和标准的一级动力学：产生速率与基因拷贝数成正比，降解速率与转录本丰度成正比。\n- 设 $E(t)$ 表示在时间 $t$（单位：分钟）时每个细胞的转录本丰度，并设 $E^\\ast$ 表示扰动前的基线稳态转录本丰度。基因剂量（拷贝数）在 $t=0$ 时从 $1$ 变为 $D$。\n- 一级降解由降解速率 $\\,\\beta\\,$（单位：$\\text{min}^{-1}$）表征。\n- 剂量补偿被建模为一个线性稳态反馈，其有效速率常数为 $\\,k\\,$（单位：$\\text{min}^{-1}$），该反馈将 $E(t)$ 驱动回 $E^\\ast$。\n\n任务 1 (建模)：\n- 从以下事实出发：(i) 产生速率与拷贝数成正比；(ii) 降解是一级动力学；并加入一个将系统拉向 $E^\\ast$ 的线性稳态项，证明 $E(t)$ 满足一个形式如下的标量常微分方程（ODE）：\n  $$\\frac{dE}{dt} = -(\\beta + k)\\,E(t) + \\left(\\beta D + k\\right) E^\\ast,$$\n  初始条件为 $E(0)=E^\\ast$。\n- 解释为什么解具有以下通用形式：\n  $$E(t) \\;=\\; E_{\\infty} \\;+\\; \\left(E^\\ast - E_{\\infty}\\right)\\,e^{-(\\beta + k)t},$$\n  其中扰动后稳态 $E_{\\infty}$ 等于\n  $$E_{\\infty} \\;=\\; \\frac{\\beta D + k}{\\beta + k}\\,E^\\ast.$$\n\n任务 2 (估计策略)：\n- 使用上述解的形式，概述并实施一个估计策略，该策略使用时间序列转录组学数据，从 $E(t)$ 的观测值 $\\{(t_i, y_i)\\}$ 中推断未知参数 $\\beta$ 和 $k$。假设 $E^\\ast$ 和 $D$ 已知，并且 $E(0)=E^\\ast$ 已被测量。您的策略必须：\n  1. 通过非线性最小二乘法拟合简化的双参数模型 $E(t) = A + (E^\\ast - A)\\,e^{-\\lambda t}$ 以求解参数 $A$ 和 $\\lambda$，其中 $A0$ 且 $\\lambda0$。\n  2. 仅使用代数和ODE解所蕴含的关系，将拟合的 $(A,\\lambda)$ 映射到生物学参数 $(\\beta,k)$，且不引入额外假设。具体来说，定义 $s = A/E^\\ast$，然后计算\n     $$\\beta \\;=\\; \\frac{s-1}{D-1}\\,\\lambda,\\qquad k \\;=\\; \\lambda - \\beta,$$\n     该式在 $D \\neq 1$ 时有效。\n\n任务 3 (测试套件、要求输出和单位)：\n- 使用以下三个时间序列数据集，每个数据集描述了在 $t=0$ 时的一次基因剂量扰动，其基线 $E^\\ast$ 和基因剂量 $D$ 均为已知。所有时间单位为分钟，所有转录本丰度单位为“每个细胞的转录本数”，所有速率常数必须以 $\\text{min}^{-1}$ 为单位报告。\n- 对每个数据集，估计 $(\\beta,k)$ 并将两个值作为四舍五入到六位小数的浮点数报告。\n\n测试套件：\n- 共享时间点（分钟）：$[0,10,20,30,40,50,60]$。\n\n案例 1 (部分补偿的重复)：\n- $E^\\ast = 100$, $D = 2$.\n- 观测值 $y$ (每个细胞的转录本数)：$[100.0000,116.6667,125.0000,129.1667,131.2500,132.2917,132.8125]$。\n\n案例 2 (强补偿的缺失)：\n- $E^\\ast = 80$, $D = 0.5$.\n- 观测值 $y$ (每个细胞的转录本数)：$[80.0000,70.0000,65.0000,62.5000,61.2500,60.6250,60.3125]$。\n\n案例 3 (无补偿的重复)：\n- $E^\\ast = 50$, $D = 2$.\n- 观测值 $y$ (每个细胞的转录本数)：$[50.0000,75.0000,87.5000,93.7500,96.8750,98.4375,99.2188]$。\n\n最终输出格式：\n- 您的程序必须嵌入上述测试套件，并生成一行输出，其中包含按 $[\\beta_1,k_1,\\beta_2,k_2,\\beta_3,k_3]$ 顺序连接的三个案例的六个估计速率常数列表，每个值都四舍五入到六位小数，单位默认为 $\\text{min}^{-1}$。\n- 例如，输出必须看起来像一行上的单个列表：$[0.012345,0.067890,0.012345,0.067890,0.012345,0.000000]$。", "solution": "所述问题具有科学依据、是良定的，并且内部一致。它展示了系统生物学背景下一个关于数学建模和参数估计的标准练习。所有必要的数据和定义都已提供，可得到唯一解。我将按要求进行推导和计算。\n\n解答分为三个部分，对应于问题陈述中的任务。\n\n任务 1：数学模型的推导与分析\n\n转录本丰度 $E(t)$ 的动力学由产生和降解之间的平衡决定。我们将其形式化为一个微分方程。\n\n首先，我们来建立速率项。转录本的降解遵循一级动力学，意味着降解速率与当前的转录本丰度 $E(t)$ 成正比。我们可以将此项写为 $-\\beta E(t)$，其中 $\\beta  0$ 是降解速率常数。\n\n产生速率更为复杂。在 $t=0$ 的剂量扰动之前，系统处于稳态，记为 $E^\\ast$。在此稳态下，基因拷贝数为 $1$，变化率为零。设每个基因拷贝的基础产生速率为 $\\alpha$。稳态时的速率方程为：\n$$\n\\frac{dE}{dt} \\bigg|_{t0} = \\alpha \\cdot 1 - \\beta E^\\ast = 0\n$$\n由此，我们推断出每个拷贝的基础产生速率常数为 $\\alpha = \\beta E^\\ast$。\n\n对于时间 $t \\ge 0$，基因剂量从 $1$ 变为 $D$。假设每个拷贝的产生速率 $\\alpha$ 保持不变，则新的总产生速率变为 $\\alpha D = (\\beta E^\\ast)D$。仅考虑产生和降解的速率方程是：\n$$\n\\frac{dE}{dt} = \\beta D E^\\ast - \\beta E(t)\n$$\n\n接下来，我们引入稳态反馈机制。这是一个补偿过程，试图将转录本水平 $E(t)$ 恢复到其原始基线 $E^\\ast$。问题指定了一个线性反馈模型，其中校正“力”与偏离设定点（即 $E^\\ast - E(t)$）的量成正比。这个反馈项可以写成 $k(E^\\ast - E(t))$，其中 $k \\ge 0$ 是补偿的有效速率常数。将此项加入到我们的速率方程中，得到：\n$$\n\\frac{dE}{dt} = \\left(\\beta D E^\\ast - \\beta E(t)\\right) + k(E^\\ast - E(t))\n$$\n我们可以收集包含 $E(t)$ 的项和常数项：\n$$\n\\frac{dE}{dt} = -\\beta E(t) - k E(t) + \\beta D E^\\ast + k E^\\ast\n$$\n因式分解后得到所要求的常微分方程（ODE）的最终形式：\n$$\n\\frac{dE}{dt} = -(\\beta + k) E(t) + (\\beta D + k) E^\\ast\n$$\n这是一个一阶线性非齐次常系数常微分方程。初始条件为 $E(0) = E^\\ast$，代表系统在扰动发生瞬间的状态。\n\n为了求解这个ODE，我们求其通解，通解是齐次解 ($E_h$) 和一个特解 ($E_p$) 的和。齐次方程为 $\\frac{dE_h}{dt} = -(\\beta + k) E_h$，其解为 $E_h(t) = C e^{-(\\beta+k)t}$，其中 $C$ 为某个常数。由于ODE的非齐次部分是一个常数，我们寻找一个常数特解 $E_p(t) = E_{\\infty}$。将其代入完整的ODE中，我们找到新的稳态：\n$$\n0 = -(\\beta + k) E_{\\infty} + (\\beta D + k) E^\\ast\n$$\n解出 $E_{\\infty}$：\n$$\nE_{\\infty} = \\frac{\\beta D + k}{\\beta + k} E^\\ast\n$$\n这是当 $t \\to \\infty$ 时系统将趨近的新平衡丰度。通解为 $E(t) = E_h(t) + E_p(t) = C e^{-(\\beta+k)t} + E_{\\infty}$。我们使用初始条件 $E(0) = E^\\ast$ 来确定积分常数 $C$：\n$$\nE(0) = C e^0 + E_{\\infty} = C + E_{\\infty} = E^\\ast\n$$\n因此，$C = E^\\ast - E_{\\infty}$。将其代回通解，得到该初值问题的特定解：\n$$\nE(t) = E_{\\infty} + (E^\\ast - E_{\\infty}) e^{-(\\beta+k)t}\n$$\n这证明了解具有问题陈述中指定的通用形式，其中系统以特征速率 $\\beta+k$ 从其初始状态 $E^\\ast$ 指数式地松弛到新的稳态 $E_{\\infty}$。\n\n任务 2：参数估计策略\n\n目标是根据已知值 $E^\\ast$ 和 $D$，从时间序列数据 $\\{(t_i, y_i)\\}$ 中估计生物学参数 $\\beta$ 和 $k$。该策略分两步进行。\n\n首先，我们将一个简化的唯象模型拟合到数据上。通过将解析解\n$$E(t) = E_{\\infty} + (E^\\ast - E_{\\infty})e^{-(\\beta+k)t}$$\n与提出的拟合函数\n$$E(t) = A + (E^\\ast - A)e^{-\\lambda t}$$\n进行比较，我们可以在模型参数之间建立以下等同关系：\n$$\nA = E_{\\infty} \\quad \\text{和} \\quad \\lambda = \\beta + k\n$$\n参数 $A$ 和 $\\lambda$ 是通过找到使模型的预测值与实验观测值 $y_i$ 之间平方差之和最小化的值来估计的。这是一个非线性最小二乘问题。我们寻求找到：\n$$\n(\\hat{A}, \\hat{\\lambda}) = \\arg\\min_{A, \\lambda} \\sum_i \\left( y_i - \\left[A + (E^\\ast - A)e^{-\\lambda t_i}\\right] \\right)^2\n$$\n这个优化是数值进行的，并受到具有生物物理学动机的约束条件 $A  0$ 和 $\\lambda  0$ 的限制。\n\n第二步，一旦获得估计值 $\\hat{A}$ 和 $\\hat{\\lambda}$，我们将它们映射回底层的生物学参数 $\\beta$ 和 $k$。我们有一个包含两个未知数的二元代数方程组：\n1.  $A = \\frac{\\beta D + k}{\\beta + k} E^\\ast$\n2.  $\\lambda = \\beta + k$\n\n我们求解这个方程组以得到 $\\beta$ 和 $k$。从第二个方程，我们可以将 $k$ 表示为 $k = \\lambda - \\beta$。我们定义归一化的稳态表达水平 $s = A/E^\\ast$。将这些代入第一个方程：\n$$\ns = \\frac{\\beta D + (\\lambda - \\beta)}{\\beta + (\\lambda - \\beta)} = \\frac{\\beta(D-1) + \\lambda}{\\lambda}\n$$\n现在，我们求解 $\\beta$：\n$$\ns\\lambda = \\beta(D-1) + \\lambda\n$$\n$$\ns\\lambda - \\lambda = \\beta(D-1)\n$$\n$$\n\\lambda(s-1) = \\beta(D-1)\n$$\n假设 $D \\neq 1$（对于任何剂量变化这都是成立的），我们可以解出 $\\beta$：\n$$\n\\beta = \\frac{s-1}{D-1}\\lambda\n$$\n这就是所要求的 $\\beta$ 的表达式。找到 $\\beta$ 后，我们可以直接计算 $k$：\n$$\nk = \\lambda - \\beta\n$$\n这个两步法允许从更易于直接估计的唯象参数 $A$ 和 $\\lambda$ 中稳健地估计出生物学参数。\n\n任务 3：应用于测试套件\n\n上述估计策略被实施并应用于提供的三个测试数据集。对于每个案例，都使用了已知的 $E^\\ast$ 和 $D$ 值，以及时间点 $t_i$ 和观测到的丰度 $y_i$。采用非线性最小二乘拟合程序来找到最优的 $A$ 和 $\\lambda$。然后用这些值来计算相应的 $\\beta$ 和 $k$。执行这些计算的代码在最终答案中提供。三个案例的结果被连接起来并以指定格式打印。问题陈述中提供的数据是无噪声的，直接由模型方程生成，这允许精确拟合和精确的参数恢复。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the parameter estimation problem for the three given test cases.\n    \"\"\"\n    \n    # Shared time points for all experiments\n    t_obs = np.array([0, 10, 20, 30, 40, 50, 60], dtype=float)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case 1: Duplication with partial compensation\",\n            \"E_star\": 100.0,\n            \"D\": 2.0,\n            \"y_obs\": np.array([100.0000, 116.6667, 125.0000, 129.1667, 131.2500, 132.2917, 132.8125])\n        },\n        {\n            \"name\": \"Case 2: Deletion with strong compensation\",\n            \"E_star\": 80.0,\n            \"D\": 0.5,\n            \"y_obs\": np.array([80.0000, 70.0000, 65.0000, 62.5000, 61.2500, 60.6250, 60.3125])\n        },\n        {\n            \"name\": \"Case 3: Duplication with no compensation\",\n            \"E_star\": 50.0,\n            \"D\": 2.0,\n            \"y_obs\": np.array([50.0000, 75.0000, 87.5000, 93.7500, 96.8750, 98.4375, 99.2188])\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E_star = case[\"E_star\"]\n        D = case[\"D\"]\n        y_obs = case[\"y_obs\"]\n\n        # Define the model function to be fitted.\n        # E_star is a known constant for each case. We use a closure to fix its value.\n        def model_func(t, A, lam):\n            \"\"\"\n            This is the function E(t) = A + (E* - A) * exp(-lambda * t).\n            \"\"\"\n            return A + (E_star - A) * np.exp(-lam * t)\n\n        # Set bounds for the parameters A and lambda to be positive.\n        # A represents a steady-state concentration, lam is a rate constant.\n        bounds = ([0, 1e-9], [np.inf, np.inf])\n        \n        # Initial guess can help, but for this data scipy is robust enough.\n        # Guess A from the last data point, guess lambda as some small positive number.\n        p0 = [y_obs[-1], 0.1]\n\n        # Perform nonlinear least squares fitting to find A and lambda\n        try:\n            params, _ = curve_fit(model_func, t_obs, y_obs, p0=p0, bounds=bounds)\n        except RuntimeError as e:\n            # Handle cases where the fit fails.\n            print(f\"Error fitting case '{case['name']}': {e}\")\n            all_results.extend([np.nan, np.nan])\n            continue\n\n        A_fit, lambda_fit = params\n\n        # Map the fitted parameters (A, lambda) to biological parameters (beta, k)\n        # s = A / E*\n        # beta = ((s - 1) / (D - 1)) * lambda\n        # k = lambda - beta\n        \n        if D == 1:\n            # The formula is not valid for D=1, although no test case has D=1.\n            # This indicates perfect compensation from the start, beta and k are not identifiable.\n            beta = np.nan\n            k = np.nan\n        else:\n            s = A_fit / E_star\n            beta = ((s - 1) / (D - 1)) * lambda_fit\n            k = lambda_fit - beta\n\n        all_results.extend([beta, k])\n\n    # Format the final output string as specified\n    # e.g., [0.012345,0.067890,...]\n    # The formatting string \"{:.6f}\" handles rounding to six decimal places.\n    output_str = \"[\" + \",\".join(f\"{val:.6f}\" for val in all_results) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2750868"}]}