{"hands_on_practices": [{"introduction": "要理解遗传同化，核心在于弄清反应规范（reaction norm）本身是如何演化的。本练习使用多变量育种者方程，这是数量遗传学的一块基石，旨在数学上形式化选择压力如何同时塑造一个性状的平均值及其可塑性。掌握这一推导将为您提供一个预测演化轨迹的基本工具。[@problem_id:2717165]", "problem": "一个种群在非生物环境中对某一数量性状表现出线性反应范式。设在环境 $E$ 中表达的表型为 $z(E) = a + b E$，其中 $a$ 是截距（在 $E=0$ 时的表型），$b$ 是斜率（可塑性）。$a$ 和 $b$ 的加性遗传值的均值为 $\\bar{a}$ 和 $\\bar{b}$，其遗传方差-协方差矩阵为 $\\mathbf{G}$，元素为 $G_{aa}$、$G_{ab}=G_{ba}$ 和 $G_{bb}$。遇到环境 $E$ 的概率密度为 $p(E)$，该密度具有有限矩。在环境 $E$ 中的相对适合度通过一个未知但平滑的函数依赖于 $z(E)$；定义表型上的环境特异性定向选择梯度为 $\\beta_{z}(E) = \\partial \\ln W(z,E)/\\partial z \\big|_{z=z(E)}$，其中 $W$ 是相对适合度。\n\n使用多变量育种家方程（也称为Lande方程），该方程指出，加性遗传性状均值向量的每代变化等于遗传方差-协方差矩阵乘以这些性状上的定向选择梯度向量。仔细应用链式法则和环境分布 $p(E)$，将对 $z(E)$ 的选择与对 $a$ 和 $b$ 的选择联系起来。\n\n对于上面定义的反应范式，哪个选项正确地用 $\\mathbf{G}$、$p(E)$ 和 $\\beta_{z}(E)$ 给出了每代响应 $\\Delta \\bar{a}$ 和 $\\Delta \\bar{b}$，从而阐明了在环境分布中，对 $z(E)$ 的选择如何引起 $a$ 和 $b$ 的相关响应？\n\nA. $\\Delta \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix} = \\mathbf{G} \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ 其中 $\\beta_{a} = \\int \\beta_{z}(E)\\, p(E)\\, dE$ 且 $\\beta_{b} = \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$，因此明确地表示为\n$\\Delta \\bar{a} = G_{aa}\\!\\int \\beta_{z}(E)p(E)dE + G_{ab}\\!\\int E\\,\\beta_{z}(E)p(E)dE$ 且\n$\\Delta \\bar{b} = G_{ab}\\!\\int \\beta_{z}(E)p(E)dE + G_{bb}\\!\\int E\\,\\beta_{z}(E)p(E)dE$。\n\nB. $\\Delta \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix} = \\mathbf{P} \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ 其中 $\\beta_{a} = \\int \\beta_{z}(E)\\, p(E)\\, dE$ 且 $\\beta_{b} = \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$，其中 $\\mathbf{P}$ 是 $a$ 和 $b$ 的表型方差-协方差矩阵。\n\nC. $\\Delta \\bar{a} = G_{aa} \\int \\beta_{z}(E)\\, p(E)\\, dE$ 且 $\\Delta \\bar{b} = G_{bb} \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$ （没有非对角线项），因为选择分别作用于 $a$ 和 $b$。\n\nD. $\\Delta \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix} = \\mathbf{G} \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ 其中 $\\beta_{a} = \\int \\beta_{z}(E)\\, p(E)\\, dE$ 且 $\\beta_{b} = \\int \\dfrac{\\partial \\beta_{z}(E)}{\\partial E}\\, p(E)\\, dE$，因为斜率 $b$ 与跨 $E$ 的变化有关。\n\n选择唯一最佳选项。", "solution": "我们从核心的数量遗传学原理和定义出发，推导其响应。反应范式为 $z(E) = a + b E$，其中加性遗传参数为 $a$ 和 $b$。遗传方差-协方差矩阵为 $\\mathbf{G} = \\begin{pmatrix}G_{aa}  G_{ab}\\\\ G_{ab}  G_{bb}\\end{pmatrix}$。多变量育种家方程（Lande方程）指出\n$$\n\\Delta \\boldsymbol{\\bar{\\theta}} = \\mathbf{G}\\, \\boldsymbol{\\beta},\n$$\n其中 $\\boldsymbol{\\bar{\\theta}} = \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix}$，$\\boldsymbol{\\beta} = \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ 是作用于遗传参数 $a$ 和 $b$ 的定向选择梯度向量。性状上的定向选择梯度定义为平均相对适合度对该性状均值的偏导数，在弱选择下，这等同于相对适合度与该性状之间的协方差除以表型方差。在这里，选择直接作用于每个环境 $E$ 中的 $z(E)$，其环境特异性表型选择梯度为\n$$\n\\beta_{z}(E) \\equiv \\frac{\\partial \\ln W(z,E)}{\\partial z}\\Big|_{z=z(E)}.\n$$\n因为每个个体根据 $p(E)$ 遭遇环境 $E$，所以作用于遗传参数的总体选择梯度是环境特异性梯度乘以表型对这些参数的敏感性（链式法则）的 $p(E)$ 加权期望。敏感性为\n$$\n\\frac{\\partial z(E)}{\\partial a} = 1, \\quad \\frac{\\partial z(E)}{\\partial b} = E.\n$$\n因此，\n$$\n\\beta_{a} = \\int \\beta_{z}(E)\\, \\frac{\\partial z(E)}{\\partial a}\\, p(E)\\, dE = \\int \\beta_{z}(E)\\, p(E)\\, dE,\n$$\n$$\n\\beta_{b} = \\int \\beta_{z}(E)\\, \\frac{\\partial z(E)}{\\partial b}\\, p(E)\\, dE = \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE.\n$$\n代入多变量育种家方程可得\n$$\n\\Delta \\bar{a} = G_{aa}\\, \\beta_{a} + G_{ab}\\, \\beta_{b}\n= G_{aa}\\!\\int \\beta_{z}(E)\\, p(E)\\, dE \\;+\\; G_{ab}\\!\\int E\\, \\beta_{z}(E)\\, p(E)\\, dE,\n$$\n$$\n\\Delta \\bar{b} = G_{ab}\\, \\beta_{a} + G_{bb}\\, \\beta_{b}\n= G_{ab}\\!\\int \\beta_{z}(E)\\, p(E)\\, dE \\;+\\; G_{bb}\\!\\int E\\, \\beta_{z}(E)\\, p(E)\\, dE.\n$$\n这些表达式显示了在环境分布上对 $z(E)$ 的选择如何引起 $a$ 和 $b$ 的直接响应和相关响应，这是通过 $p(E)$ 对环境的加权和遗传协方差 $G_{ab}$ 共同介导的。特别地，如果 $p(E)$ 在某个 $E^{\\ast}$ 附近变窄，且 $\\beta_{z}(E)$ 平滑变化，则 $\\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$ 趋向于 $E^{\\ast}\\int \\beta_{z}(E)\\, p(E)\\, dE$，这减少了当在 $E=0$ 附近测量时，专门针对 $b$ 的选择分量。在持续的新环境 $E^{\\ast}$ 下，选择将主要改变 $\\bar{a}$，并通过 $G_{ab}$ 引起 $\\bar{b}$ 的相关变化；如果环境随后稳定下来，$\\beta_{b}$ 会趋近于 $0$，有利于降低可塑性（与遗传同化一致），而在短暂的环境异质性期间，非零的 $\\beta_{b}$ 可能有利于适应性可塑性（通往Baldwin效应的一条途径）。\n\n逐项分析选项：\n- 选项A：这与推导相符。它使用了多变量育种家方程，并通过 $\\partial z/\\partial a = 1$ 和 $\\partial z/\\partial b = E$ 将 $\\beta_{z}(E)$ 正确地通过链式法则映射到 $\\beta_{a}$ 和 $\\beta_{b}$，并且通过 $G_{ab}$ 包含了相关响应项。结论 — 正确。\n- 选项B：此选项错误地使用了表型方差-协方差矩阵 $\\mathbf{P}$ 来代替遗传方差-协方差矩阵 $\\mathbf{G}$。育种家方程要求使用加性遗传方差和协方差来计算进化响应。结论 — 错误。\n- 选项C：此选项忽略了非对角线的遗传协方差项 $G_{ab}$。除非假设 $G_{ab}=0$，否则它无法捕捉相关响应，也不是题目所要求的一般表达式。结论 — 错误。\n- 选项D：此选项错误地识别了 $\\beta_{b}$。作用于 $b$ 的选择梯度来自于 $z(E)$ 对 $b$ 的敏感性（即 $E$），而不是来自于 $\\partial \\beta_{z}(E)/\\partial E$。对环境求导混淆了选择如何作用于表型与表型如何依赖于遗传参数这两个概念。结论 — 错误。", "answer": "$$\\boxed{A}$$", "id": "2717165"}, {"introduction": "在演化生物学中，一个关键挑战是将真正的遗传同化与表观遗传的跨代表达区分开来，因为后者可以产生相似的表型模式。本练习提供了一个真实而复杂的实验数据集，要求您设计统计标准来区分这两种机制。这项实践旨在检验您整合现代基因组学数据与经典实验设计，以解决前沿演化谜题的能力。[@problem_id:2717213]", "problem": "一个种群表现出一种由环境诱导的可塑性表型，这种表型在新的环境中能提高其适应度。在暴露于新环境几代后，该表型也出现在了原始（祖先）环境中。您获得了一个多代实验的数据集，该实验旨在区分遗传同化（genetic assimilation，即由于对可塑性背后的遗传变异进行选择，导致最初的可塑性表型得以稳定表达，通常在鲍德温效应的背景下讨论）和持续性表观遗传（persistent epigenetic inheritance，即表型通过表观遗传标记跨代传递，而没有稳定的潜在遗传变化）。\n\n实验设计与数据：\n- 从同一基础种群建立了两个重复品系集：一个来自原始环境，另一个来自诱导可塑性表型的新环境。这些品系在严格的共同园（common garden）中维持了 $g = 5$ 代，以消除直接的环境诱导效应。\n- 在第 $g = 3$ 代时，对一部分品系在原始环境和新环境之间进行了一代相互移植（reciprocal transplant），之后所有品系都返回共同园。\n- 在每一代 $g \\in \\{1,\\dots,5\\}$，测量了个体表型值 $y_{i,g,e}$，收集了全基因组单核苷酸多态性（SNP）基因型以构建基因组亲缘关系矩阵（Genomic Relatedness Matrix, GRM），并以单碱基分辨率获得了胞嘧啶甲基化图谱以识别差异甲基化区域（Differentially Methylated Regions, DMRs）。在第 $g = 4$ 代，一部分个体接受了一代短暂的去甲基化处理。在第 $g = 5$ 代进行了相互杂交（reciprocal crosses），以产生 $\\mathrm{F}_1$ 和 $\\mathrm{F}_2$ 子代，并记录了谱系、母本和父本信息。\n- 您可以假设等位基因遵循孟德尔分离定律，甲基化遗传（当独立于基因型时）由于部分生殖系重编程而随代际衰减，以及顺式调控的甲基化数量性状位点（cis-regulatory Methylation Quantitative Trait Loci, meQTLs）可以产生稳定的甲基化-等位基因关联。\n\n基本定义与预期：\n- 遗传同化预测，在共同园中，表型随代际变化而变得独立于诱导环境，反应规范（reaction norms）变平，可遗传的变异由加性遗传效应解释；甲基化差异（如果存在）由基因型（例如 meQTLs）解释，而不是作为一个独立的可遗传原因。\n- 持续性表观遗传预测，由于不能被基因型解释的甲基化状态，表型在共同园中会传递有限的代数，表现出亲源效应（parent-of-origin effects）或母系效应，并由于部分重编程而随代际指数呈几何级数衰减。\n\n根据此数据集，以下哪几组统计标准是充分且可实施的，用以区分遗传同化和持续性表观遗传？选择所有适用选项。\n\nA. 对多代共同园和相互移植数据拟合一个动物模型（animal model，一种线性混合模型），其中表型向量 $\\mathbf{y}$ 建模为\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}_a \\mathbf{a} + \\mathbf{Z}_{g \\times e}\\mathbf{u} + \\mathbf{Z}_m \\mathbf{m} + \\mathbf{Z}_d \\mathbf{d} + \\mathbf{Z}_s \\mathbf{s} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\mathrm{Var}(\\mathbf{a}) = V_A \\mathbf{K}$（$\\mathbf{K}$ 为基因组亲缘关系矩阵 GRM），$\\mathrm{Var}(\\mathbf{u}) = V_{G\\times E} \\mathbf{K} \\otimes \\mathbf{I}_E$，$\\mathrm{Var}(\\mathbf{m}) = V_M \\mathbf{R}(\\rho) \\otimes \\mathbf{I}$（$\\mathbf{R}(\\rho)$ 是参数为 $\\rho \\in (0,1)$ 的跨代一阶自回归协方差），$\\mathbf{d}, \\mathbf{s}$ 分别是母本和父本的随机效应。通过中介检验（mediation tests）进行补充，其中 DMRs 的甲基化状态被建模为对附近基因型的响应，以检测顺式 meQTLs。如果在共同园中培养 $g \\geq 3$ 代后，出现以下情况，则宣布为遗传同化的证据：(i) $V_A > 0$ 且似然比检验 $p \\ll 0.05$，(ii) $V_{G\\times E} \\approx 0$ 且检验不显著，(iii) 在以基因型为条件后 $V_M$ 变得不显著，并且 DMR 甲基化可由顺式 meQTLs 解释（在多重检验校正后，基因型-甲基化之间存在强关联， $p \\ll 0.05$），以及 (iv) 去甲基化处理不改变表型均值（处理主效应 $p \\geq 0.05$）。如果出现以下情况，则宣布为持续性表观遗传的证据：(i) $V_A \\approx 0$ 且 $V_{G\\times E} \\approx 0$，(ii) $V_M > 0$ 且 $\\rho \\in (0,1)$ 显著大于 $0$（似然比检验 $p \\ll 0.05$），(iii) DMR 甲基化不能由附近的基因型解释（无 meQTLs），(iv) 去甲基化处理降低了表型值（处理效应 $p \\ll 0.05$），以及 (v) 相互杂交显示出亲源效应（母本效应与父本效应不同， $p \\ll 0.05$）。\n\nB. 使用相互移植的反应规范和分离分析。首先，对所有品系和环境拟合一个基因型-环境相互作用的混合模型\n$$\ny_{i,g,e} = \\mu + b_e + \\alpha_{\\ell(i)} + (\\alpha \\times e)_{\\ell(i),e} + \\varepsilon_{i,g,e},\n$$\n其中 $\\alpha_{\\ell(i)}$ 是一个随机品系效应，其协方差与 GRM 成正比，$(\\alpha \\times e)_{\\ell(i),e}$ 是一个随机的基因型-环境相互作用项。检验在共同园中培养 $g \\geq 3$ 代后，反应规范的斜率是否消失。接下来，进行相互杂交，并在共同园条件下，使用数量性状位点（QTL）扫描和亲源效应比较，检验 $\\mathrm{F}_2$ 代中表型的孟德尔分离情况。如果反应规范的斜率与 $0$ 没有差异，并且 $\\mathrm{F}_2$ 代的分离与映射到基因组区域的孟德尔遗传一致，且没有亲源效应（$p \\geq 0.05$），则宣布为遗传同化。如果在共同园中反应规范的斜率仍然依赖于亲代环境或母系，表型无法通过孟德尔遗传映射到基因型，并且存在母本或亲源效应（$p \\ll 0.05$），且效应大小随代际指数大致呈指数衰减，则宣布为持续性表观遗传。\n\nC. 只要表型在共同园中持续至少 $2$ 代，就归类为遗传同化，因为考虑到生殖系重编程，超过 $1$ 代的持续性不可能是由表观遗传引起的。\n\nD. 只要品系间存在任何差异甲基化区域（DMRs），就归类为持续性表观遗传，无论甲基化差异是否作为顺式 meQTLs 与基因型共分离，也无论去甲基化处理后表型是否改变。\n\nE. 仅从表型均值的时间序列数据中估计表观突变率 $\\mu_e$ 和作用于表型的选择系数 $s$；如果 $s > \\mu_e$，则归类为遗传同化，否则归类为持续性表观遗传，而不使用基因型、甲基化、谱系或相互杂交的信息。\n\n选择所有能利用给定数据提供充分且可实施的统计标准，以区分遗传同化和持续性表观遗传的选项。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取给定信息**\n- **背景**：一个种群表现出一种由环境诱导的可塑性表型，在几代后，即使在原始环境中也变得稳定表达。目标是区分遗传同化和持续性表观遗传。\n- **实验数据**：\n    - 来自同一基础种群的重复品系，在最初暴露于原始环境与新环境后，在共同园中维持了 $g=5$ 代。\n    - 在第 $g=3$ 代时进行了一代相互移植。\n    - 在每一代 $g \\in \\{1, \\dots, 5\\}$，收集了以下数据：\n        - 表型值 $y_{i,g,e}$。\n        - 全基因组单核苷酸多态性（SNP）基因型，用于构建基因组亲缘关系矩阵（GRM）。\n        - 单碱基分辨率的胞嘧啶甲基化图谱，用于识别差异甲基化区域（DMRs）。\n    - 在第 $g=4$ 代，对一部分个体施加了短暂的去甲基化处理。\n    - 在第 $g=5$ 代，进行相互杂交以产生 $\\mathrm{F}_1$ 和 $\\mathrm{F}_2$ 子代，并提供完整的谱系信息（母本和父本）。\n- **假设**：\n    - 等位基因的孟德尔分离。\n    - 独立于基因型的甲基化遗传由于部分生殖系重编程而跨代衰减。\n    - 顺式调控的甲基化数量性状位点（meQTLs）可以产生甲基化状态和等位基因之间的稳定关联。\n- **定义**：\n    - **遗传同化**：表型变得独立于诱导环境，反应规范变平，可遗传变异是加性遗传的，任何相关的甲基化差异都由基因型解释（例如，meQTLs）。\n    - **持续性表观遗传**：表型通过不能被基因型解释的甲基化状态传递有限的代数，可能显示亲源效应，并随代际呈几何级数衰减。\n- **问题**：确定哪些统计标准集是充分且可实施的，能用给定数据来区分这两种机制。\n\n**步骤2：使用提取的给定信息进行验证**\n- **科学依据**：该问题牢固地植根于现代进化生物学和数量遗传学。遗传同化、鲍德温效应、表型可塑性、持续性表观遗传以及实验工具（共同园、相互杂交、基因组和表观基因组数据、去甲基化试剂）等概念都是该领域当前研究的标准和核心内容。所提供的定义是正确的，反映了科学共识。\n- **适定性**：问题是适定的。它要求使用一个全面且描述清晰的数据集，来找出一套标准以区分两个互斥且定义明确的假说。可以推导出确切的答案。\n- **客观性**：问题以精确、客观和技术性的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。它不包含任何使其无效的缺陷。因此，该问题是有效的。我们继续评估所提供的选项。\n\n**逐项分析**\n\n**选项A**\n该选项提出了一个使用线性混合模型的综合统计框架，在数量遗传学中通常称为“动物模型”，旨在将表型方差分解为多个来源。该模型为：\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}_a \\mathbf{a} + \\mathbf{Z}_{g \\times e}\\mathbf{u} + \\mathbf{Z}_m \\mathbf{m} + \\mathbf{Z}_d \\mathbf{d} + \\mathbf{Z}_s \\mathbf{s} + \\boldsymbol{\\varepsilon}\n$$\n这个模型非常适合这项任务。\n- 项 $\\mathbf{Z}_a \\mathbf{a}$ 和 $\\mathrm{Var}(\\mathbf{a}) = V_A \\mathbf{K}$ 直接使用 GRM 估计加性遗传方差（$V_A$），这是检验遗传基础的基石。\n- 项 $\\mathbf{Z}_{g \\times e}\\mathbf{u}$ 模拟基因型-环境相互作用，从而可以直接检验反应规范是否变平，这是遗传同化的一个关键预测。\n- 项 $\\mathbf{Z}_m \\mathbf{m}$ 使用自回归协方差结构 $\\mathbf{R}(\\rho)$，这是一种专门设计用来模拟随代际衰减的可遗传效应的复杂方法，而这正是所给出的持续性表观遗传的精确定义。\n- 母本（$\\mathbf{d}$）和父本（$\\mathbf{s}$）效应允许检验亲源效应，这是非孟德尔遗传（如表观遗传）的另一个标志。\n- 提出的遗传同化标准（$V_A > 0$，$V_{G\\times E} \\approx 0$，辅助的甲基化效应可由顺式-meQTLs解释，以及去甲基化无效应）是一套完整且逻辑上连贯的检验。它们确认了遗传基础，排除了可塑性，并将表观遗传标记置于遗传控制之下。\n- 提出的持续性表观遗传标准（$V_A \\approx 0$，$V_M > 0$ 且存在衰减，甲基化不能由基因型解释，以及去甲基化导致表型改变）同样合理。它们确认了表型的一个非遗传的、衰减的、且机制上是表观遗传的基础。\n该选项以一种综合且统计上严谨的方式，充分利用了所提供数据集的全部功能。该方法既充分又可实施。\n**结论：正确。**\n\n**选项B**\n该选项提出了一个两部分分析：反应规范模型后跟杂交分离分析。\n- 第一部分将表型 $y_{i,g,e}$ 建模为环境和随机品系效应的函数，并包含一个基因型-环境相互作用项 $(\\alpha \\times e)_{\\ell(i),e}$。检验该项（从而反应规范斜率）是否消失，是对遗传同化一个关键预测的直接检验。这是一个标准且有效的方法。\n- 第二部分使用相互杂交，这是区分遗传与其他遗传形式的经典方法。使用QTL扫描检验 $\\mathrm{F}_2$ 代的孟德尔分离是确定遗传基础的决定性方法。相反，缺乏孟德尔模式并伴有显著的亲源效应，是支持非孟德尔遗传（如通过表观遗传机制）的有力证据。关于这些效应随代际衰减的预期陈述也是正确的。\n- 尽管这种方法不像选项A那样将所有数据明确地整合到单个模型中（它没有提到使用DMR或去甲基化数据），但反应规范分析和基于经典杂交的分离分析相结合，是区分这两个假说的强大且充分的方法。为两种情况提出的标准都是正确的，并直接解决了问题的核心。\n**结论：正确。**\n\n**选项C**\n该选项声称，任何在共同园中持续2代或更长时间的表型都足以作为遗传同化的证据。这个前提是根本错误的。“持续性表观遗传”（或跨代表观遗传）的概念，其定义就是由于*不完全*或*部分*的生殖系重编程，使其能够持续多代。这种不完全的重置允许表观遗传标记被传递，尽管会有所衰减，但仍能跨越多代。因此，观察到2代的持续性不足以排除表观遗传。该标准无效。\n**结论：错误。**\n\n**选项D**\n该选项建议，只要在品系间发现差异甲基化区域（DMRs），就将该现象归类为持续性表观遗传。这是一个幼稚且不正确的标准。正如问题的假设和定义中明确指出的，甲基化模式可以通过顺式作用的甲基化数量性状位点（meQTLs）受到直接的遗传控制。在这种情况下，DMR仅仅是潜在DNA序列多态性的下游结果。甲基化状态的遗传与等位基因的遗传完全耦合，使得遗传的最终基础是遗传性的，而非表观遗传。正确的分析*必须*区分由遗传决定的甲基化和独立于局部序列遗传的甲基化状态。通过忽略这一关键区别，该标准是不充分的，并将导致错误的结论。\n**结论：错误。**\n\n**选项E**\n该选项建议仅使用表型均值的时间序列数据来估计表观突变率 $\\mu_e$ 和选择系数 $s$，然后基于武断的规则 $s > \\mu_e$ 进行分类。这种方法有多个致命缺陷。\n- 首先，它丢弃了绝大多数丰富的、能提供机理信息的的数据（基因型、甲基化图谱、谱系、杂交结果、去甲基化处理效应），而这些数据正是为解决这个问题而专门收集的。\n- 其次，在没有潜在遗传机理模型的情况下，仅从表型均值估计 $\\mu_e$ 和 $s$ 等参数是一个不适定的问题；这些参数将无法识别且混淆不清。\n- 第三，决策规则 $s > \\mu_e$ 在区分遗传同化和持续性表观遗传方面没有任何理论基础。遗传同化的动态涉及对现有遗传变异进行可塑性选择，这是一个比简单比较选择系数和突变率复杂得多的过程。表观遗传的动态涉及传递保真度和衰减，而不仅仅是表观突变率。这是一种极端的简化，在科学上是站不住脚的。\n**结论：错误。**\n\n**结论**\n选项A和B都描述了有效、充分且可实施的统计策略，它们利用提供的实验数据来严格区分遗传同化和持续性表观遗传。选项A通过提出一个综合模型而更全面，而选项B代表了一种更经典但仍然强大的方法。选项C、D和E基于不正确的前提、过度简化或未能使用区分机理所需的关键数据。", "answer": "$$\\boxed{AB}$$", "id": "2717213"}, {"introduction": "个体为本的模拟是探索那些难以实时研究的演化过程的强大工具。这项动手编程练习要求您建立一个“虚拟实验室”，以观察遗传同化的动态过程。通过亲手实现选择、遗传和发育等核心要素，您可以直接检验理论预测，并直观地理解可塑性成本等因素如何影响演化结果。[@problem_id:2717245]", "problem": "设计并实现一个基于个体的 Wright–Fisher 模拟，以测试在不同表型可塑性成本下，遗传同化是否会出现。此模拟基于自然选择、基因型-表型映射和稳定性选择的定义。您的程序必须实现以下模型、规则和检测标准，然后运行指定的测试套件。最终输出必须是单行，包含一个按末尾规定格式的整数列表。\n\n基本基础。使用以下广为接受的定义和规则：\n- 自然选择被建模为与适应度成比例的差异性繁殖，其中适应度是表型与环境不匹配以及任何内在成本的非负函数。\n- 基因型-表型映射是一个从遗传变量到性状值的确定性或随机性函数。\n- 在围绕最优值的稳定性选择下，表型的适应度是与偏离最优值的平方偏差的减函数。\n- Wright–Fisher 种群在离散的、世代不重叠的条件下演化，其繁殖由与适应度成比例的多项式抽样给出。\n\n模型规范：\n1) 基因型。每个个体 $i$ 携带一个双位点数量基因型 $\\mathbf{g}_i(t) = (a_i(t), b_i(t))$，其中 $a_i(t)$ 是遗传编码的基线（截距），$b_i(t)$ 是遗传编码的线性可塑性系数（斜率）。\n2) 发育映射。在世代 $t$，个体 $i$ 的表达表型为\n$$\nz_i(t) = a_i(t) + b_i(t) \\, c_t,\n$$\n其中 $c_t$ 是一个环境线索。不存在额外的发育噪音。\n3) 环境。环境有两个阶段：\n   - 阶段 I（转变前）：对于 $t \\in \\{0,1,\\dots,T_{\\mathrm{shift}}-1\\}$，抽取 $c_t \\sim \\mathcal{N}(0,1)$ 并将适应度最优值设为 $\\theta_t = c_t$。\n   - 阶段 II（转变后）：对于 $t \\in \\{T_{\\mathrm{shift}}, T_{\\mathrm{shift}}+1, \\dots, G-1\\}$，设置 $c_t = 0$ 并将适应度最优值固定在 $\\theta_t = \\theta^\\star$。\n4) 适应度。设围绕最优值的稳定性选择具有高斯形式，宽度参数为 $\\omega > 0$，并施加一个与 $b_i(t)^2$ 成比例的可塑性乘法成本，成本系数为 $k \\ge 0$：\n$$\nw_i(t) = \\exp\\!\\left( - \\frac{(z_i(t) - \\theta_t)^2}{2 \\, \\omega^2} \\right) \\cdot \\exp\\!\\left( - k \\, b_i(t)^2 \\right).\n$$\n5) 繁殖与突变。使用种群大小为 $N$ 的 Wright–Fisher 模型。在每个世代中，按与 $w_i(t)$ 成比例的概率，有放回地抽取 $N$ 个亲本。每个后代继承其亲本的基因型，并伴随加性高斯突变：\n$$\na_i(t+1) = a_{\\pi(i)}(t) + \\varepsilon_{a,i}(t), \\quad \\varepsilon_{a,i}(t) \\sim \\mathcal{N}(0,\\sigma_a^2), \\\\\nb_i(t+1) = b_{\\pi(i)}(t) + \\varepsilon_{b,i}(t), \\quad \\varepsilon_{b,i}(t) \\sim \\mathcal{N}(0,\\sigma_b^2),\n$$\n这些突变在个体和基因座之间独立发生，其中 $\\pi(i)$ 表示后代 $i$ 的被选中的亲本索引。通过突变后的截断，将 $b_i(t)$ 约束在一个有限区间内。\n6) 初始化。在 $t=0$ 时，将 $a_i(0)$ 和 $b_i(0)$ 独立地初始化为 $\\mathcal{N}(0,\\sigma_{\\mathrm{init}}^2)$。\n\n遗传同化的检测。此处将遗传同化定义为：在恒定的转变后环境中，不再依赖可塑性，同时所需表型发生遗传固定。操作上，对于阶段 II 中一个大小为 $W$ 的连续世代的滑动窗口，当且仅当两个条件同时满足时，在最早的世代 $t \\ge T_{\\mathrm{shift}} + W - 1$ 宣布发生同化：\n- 低可塑性标准：对于所有世代 $g \\in \\{t-W+1,\\dots,t\\}$，$\\lvert \\bar{b}(g) \\rvert \\le \\varepsilon_b$ 成立，其中 $\\bar{b}(g)$ 是世代 $g$ 时 $b$ 的种群平均值。\n- 遗传固定标准：对于所有 $g \\in \\{t-W+1,\\dots,t\\}$，$\\lvert \\bar{a}(g) - \\theta^\\star \\rvert \\le \\varepsilon_a$ 成立，其中 $\\bar{a}(g)$ 是 $a$ 的种群平均值。\n如果在 $G-1$ 之前不存在这样的 $t$，则报告未发生同化。\n\n使用的模拟参数：\n- 种群大小 $N = 200$。\n- 总世代数 $G = 800$。\n- 环境转变世代 $T_{\\mathrm{shift}} = 400$。\n- 转变后的最优值 $\\theta^\\star = 1.0$。\n- 稳定性选择宽度 $\\omega = 0.5$。\n- 突变标准差 $\\sigma_a = 0.02$ 和 $\\sigma_b = 0.02$。\n- 初始化标准差 $\\sigma_{\\mathrm{init}} = 0.01$。\n- 可塑性截断边界 $b_{\\min} = -5$ 和 $b_{\\max} = 5$（在每个世代突变后通过截断应用）。\n- 同化窗口大小 $W = 10$。\n- 阈值 $\\varepsilon_b = 0.05$ 和 $\\varepsilon_a = 0.05$。\n- 随机性。对所有随机过程使用固定的种子 $12345$，以便结果可复现。\n\n数值细节：\n- 使用对数适应度来稳定计算抽样概率，方法是在指数化之前减去最大对数适应度。\n- 如果数值下溢导致所有未归一化的权重都为零，则退回到均匀抽样。\n\n测试套件。运行四个独立的案例，它们仅在可塑性成本系数 $k$ 上有所不同：\n- 案例 1：$k = 0.0$。\n- 案例 2：$k = 0.001$。\n- 案例 3：$k = 0.01$。\n- 案例 4：$k = 0.05$。\n\n答案规范：\n- 对于每个案例，输出一个整数：满足同化标准的最早世代索引 $t$；如果始终不满足，则输出 $-1$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$）。", "solution": "问题陈述经过严格验证，确认有效。它科学地基于演化群体遗传学的既定原理，特别是 Wright–Fisher 模型，并提出了一个定义明确的计算任务。模型、参数和目标标准都以足够的精度指定，没有内部矛盾或歧义。该问题是理论生物学中一个标准但并非微不足道的练习。将构建一个解决方案。\n\n该解决方案实现了一个基于个体的模拟，以根据规定对变化环境条件下数量性状的演化进行建模。算法的核心是根据 Wright–Fisher 模型，对一个大小为 $N$ 的种群在 $G$ 个不重叠的世代中进行离散时间模拟。\n\n**1. 模型与状态表示**\n在任何世代 $t$，种群由 $N=200$ 个个体组成。每个个体 $i$ 的基因型由一对连续值 $\\mathbf{g}_i(t) = (a_i(t), b_i(t))$ 表示，对应于遗传基线和可塑性系数。这些值存储在两个数值数组中，一个用于所有 $a_i$ 值的集合，另一个用于 $b_i$ 值的集合。\n\n**2. 模拟初始化**\n在初始世代 $t=0$ 时，通过从一个独立同分布的高斯分布 $\\mathcal{N}(0, \\sigma_{\\mathrm{init}}^2)$ 中为所有 $i \\in \\{1, \\dots, N\\}$ 抽取 $a_i(0)$ 和 $b_i(0)$ 的值来初始化基因型，其中 $\\sigma_{\\mathrm{init}}=0.01$。然后将可塑性系数 $b_i(0)$ 截断到区间 $[b_{\\min}, b_{\\max}]$，即 $[-5, 5]$。对于四个测试案例中的每一个，都使用固定的种子 $12345$ 初始化一个专用的伪随机数生成器，以确保随机轨迹（环境波动、突变）完全相同，从而隔离可塑性成本系数 $k$ 的影响。\n\n**3. 世代循环**\n模拟从 $t=0$ 到 $G-1=799$ 迭代进行。在每个世代，发生以下一系列事件：\n\n*   **环境定义**：确定环境线索 $c_t$ 和表型最优值 $\\theta_t$。\n    *   在阶段 I ($t < T_{\\mathrm{shift}}=400$)，环境是可变的。从标准正态分布 $\\mathcal{N}(0,1)$ 中抽取 $c_t$，并将最优值设为与线索匹配，即 $\\theta_t = c_t$。这种选择机制偏好可塑性，因为它允许个体追踪波动的最优值。\n    *   在阶段 II ($t \\ge T_{\\mathrm{shift}}=400$)，环境变为恒定。线索固定为 $c_t=0$，最优值固定为一个新值 $\\theta_t = \\theta^\\star = 1.0$。\n\n*   **表型表达**：每个个体的表型 $z_i(t)$ 根据其基因型和环境线索通过线性发育映射计算得出：\n    $$\n    z_i(t) = a_i(t) + b_i(t) c_t\n    $$\n\n*   **适应度计算**：每个个体的适应度 $w_i(t)$ 基于其表型与最优值的匹配程度以及可塑性的内在成本来计算。适应度函数由两个指数项的乘积给出：\n    $$\n    w_i(t) = \\exp\\left( - \\frac{(z_i(t) - \\theta_t)^2}{2 \\omega^2} \\right) \\cdot \\exp\\left( - k b_i(t)^2 \\right)\n    $$\n    其中 $\\omega=0.5$ 是稳定性选择的宽度，$k$ 是成本系数。为保持数值稳定性，计算使用对数适应度。在进行指数运算前，通过减去其最大值来平移对数适应度值，以防止在计算相对适应度权重以供抽样时发生浮点下溢。在极少数情况下，如果计算出的所有适应度值均为零，则使用均匀抽样作为备用方案。\n\n*   **繁殖**：下一代是通过从当前代中有放回地抽取 $N$ 个亲本形成的。个体 $i$ 被选为亲本的概率与其适应度成正比，即 $p_i \\propto w_i(t)$。这是 Wright–Fisher 模型的决定性步骤。\n\n*   **遗传与突变**：$N$ 个后代中的每一个都继承其所选亲本的基因型。然后该基因型会发生突变。新的遗传值 $a_i(t+1)$ 和 $b_i(t+1)$ 是通过在亲本值上添加一个从高斯分布中抽取的小随机扰动来生成的：\n    $$\n    a_i(t+1) = a_{\\pi(i)}(t) + \\varepsilon_{a,i}(t), \\quad \\text{其中 } \\varepsilon_{a,i}(t) \\sim \\mathcal{N}(0, \\sigma_a^2) \\\\\n    b_i(t+1) = b_{\\pi(i)}(t) + \\varepsilon_{b,i}(t), \\quad \\text{其中 } \\varepsilon_{b,i}(t) \\sim \\mathcal{N}(0, \\sigma_b^2)\n    $$\n    其中 $\\sigma_a = \\sigma_b = 0.02$。突变后，新的可塑性系数 $b_i(t+1)$ 被截断，以确保它们保持在区间 $[-5, 5]$ 内。\n\n**4. 遗传同化的检测**\n模拟在阶段 II 期间检查遗传同化的发生。检查从世代 $t = T_{\\mathrm{shift}} + W - 1 = 409$ 开始，其中 $W=10$ 是窗口大小。对于随后的每个世代 $t$ 直到 $G-1$，算法检查最后 $W$ 个世代（从 $g=t-W+1$ 到 $g=t$）的滑动窗口内的种群平均基因型 $\\bar{a}(g)$ 和 $\\bar{b}(g)$。在第一个世代 $t$ 处宣布同化，在该世代，以下两个条件在窗口内的所有 $g$ 上同时满足：\n1.  **低可塑性标准**：平均可塑性系数的绝对值很小：$|\\bar{b}(g)| \\le \\varepsilon_b$，其中 $\\varepsilon_b = 0.05$。\n2.  **遗传固定标准**：平均基线属性接近新的最优值：$|\\bar{a}(g) - \\theta^\\star| \\le \\varepsilon_a$，其中 $\\varepsilon_a=0.05$ 且 $\\theta^\\star=1.0$。\n\n如果这些条件得到满足，世代索引 $t$ 被记录为同化时间，并且针对该 $k$ 值的模拟终止。如果模拟完成所有 $G$ 个世代而未满足标准，则记录值 $-1$，表示未发生同化。\n\n**5. 测试套件的执行**\n整个模拟被封装在一个函数中，该函数对可塑性成本 $k \\in \\{0.0, 0.001, 0.01, 0.05\\}$ 的每个指定值执行一次，共四次。这四次运行的结果被收集并格式化为所需的输出列表。", "answer": "```python\nimport numpy as np\n\ndef run_simulation(k, rng, N, G, T_shift, theta_star, omega, sigma_a, sigma_b, sigma_init, b_min, b_max, W, epsilon_a, epsilon_b):\n    \"\"\"\n    Runs a single Wright-Fisher simulation for genetic assimilation.\n\n    Args:\n        k (float): The cost coefficient for plasticity.\n        rng (numpy.random.Generator): The random number generator to use.\n        ... other parameters as specified in the problem ...\n\n    Returns:\n        int: The generation index of assimilation, or -1 if none occurred.\n    \"\"\"\n    # 1. Initialization\n    a = rng.normal(loc=0.0, scale=sigma_init, size=N)\n    b = rng.normal(loc=0.0, scale=sigma_init, size=N)\n    b = np.clip(b, b_min, b_max)\n\n    mean_a_history = []\n    mean_b_history = []\n    \n    assimilation_time = -1\n\n    # 2. Main generation loop\n    for t in range(G):\n        # 2a. Environment\n        if t  T_shift:\n            c_t = rng.normal(loc=0.0, scale=1.0)\n            theta_t = c_t\n        else:\n            c_t = 0.0\n            theta_t = theta_star\n\n        # 2b. Phenotype\n        z = a + b * c_t\n\n        # 2c. Fitness calculation (using log-fitness for stability)\n        log_w = -((z - theta_t)**2 / (2 * omega**2)) - k * (b**2)\n        \n        # Numerical stability: shift log-fitness values before exponentiation\n        max_log_w = np.max(log_w)\n        if np.isinf(max_log_w): # handle case where all log_w are -inf\n             w = np.zeros_like(log_w)\n        else:\n             w = np.exp(log_w - max_log_w)\n        \n        # Normalize to get sampling probabilities\n        sum_w = np.sum(w)\n        if sum_w == 0.0:\n            # Fallback to uniform sampling if all weights are zero\n            probs = np.full(N, 1.0 / N)\n        else:\n            probs = w / sum_w\n\n        # 2d. Reproduction (Wright-Fisher sampling)\n        parent_indices = rng.choice(N, size=N, p=probs, replace=True)\n        a_parents = a[parent_indices]\n        b_parents = b[parent_indices]\n\n        # 2e. Mutation\n        a_new = a_parents + rng.normal(loc=0.0, scale=sigma_a, size=N)\n        b_new = b_parents + rng.normal(loc=0.0, scale=sigma_b, size=N)\n        \n        # 2f. Truncation of plasticity coefficient\n        b_new = np.clip(b_new, b_min, b_max)\n        \n        # Update genotypes for the next generation\n        a = a_new\n        b = b_new\n\n        # 3. Data recording for assimilation check\n        mean_a_history.append(np.mean(a))\n        mean_b_history.append(np.mean(b))\n\n        # 4. Check for genetic assimilation\n        # Start checking only after W generations into Phase II\n        if t >= T_shift + W - 1:\n            # Get the window of the last W generations\n            window_start_idx = t - W + 1\n            \n            a_mean_window = np.array(mean_a_history[window_start_idx : t + 1])\n            b_mean_window = np.array(mean_b_history[window_start_idx : t + 1])\n            \n            # Check if both conditions are met for the entire window\n            fixation_condition = np.all(np.abs(a_mean_window - theta_star) = epsilon_a)\n            plasticity_condition = np.all(np.abs(b_mean_window) = epsilon_b)\n            \n            if fixation_condition and plasticity_condition:\n                assimilation_time = t\n                break  # Found the earliest time, exit this simulation run\n\n    return assimilation_time\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # --- Simulation parameters ---\n    N = 200\n    G = 800\n    T_shift = 400\n    theta_star = 1.0\n    omega = 0.5\n    sigma_a = 0.02\n    sigma_b = 0.02\n    sigma_init = 0.01\n    b_min, b_max = -5.0, 5.0\n    W = 10\n    epsilon_a = 0.05\n    epsilon_b = 0.05\n    seed = 12345\n    \n    # --- Test suite ---\n    k_values = [0.0, 0.001, 0.01, 0.05]\n    \n    results = []\n    \n    for k in k_values:\n        # Re-initialize the random number generator for each case to ensure\n        # that the stochastic trials are based on the same sequence of random numbers.\n        rng = np.random.default_rng(seed)\n        \n        result = run_simulation(\n            k, rng, N, G, T_shift, theta_star, omega, \n            sigma_a, sigma_b, sigma_init, b_min, b_max, \n            W, epsilon_a, epsilon_b\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2717245"}]}