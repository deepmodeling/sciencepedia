{"hands_on_practices": [{"introduction": "研究整合的第一步通常是将其量化为一个简洁的指标。通过分析协方差矩阵的特征值，我们可以评估变异在表型空间中的分布情况。当性状高度整合时，大部分变异会集中在少数几个维度上，导致特征值之间存在巨大差异。这个练习将指导你计算一个基于特征值方差的整合指数，从而掌握从协方差数据中量化整合程度的基本方法。[@problem_id:2736008]", "problem": "一位研究人员正在研究一个脊椎动物支系中的三个同源颅骨性状，并根据一个大样本中在可通约尺度上测量的性状值，估计了表型协方差矩阵 $P$。该矩阵为\n$$\nP \\;=\\; \\begin{pmatrix}\n2  1  0\\\\\n1  2  0\\\\\n0  0  1\n\\end{pmatrix}.\n$$\n在表型整合与模块化的框架下，$P$ 的特征分解被用来量化方差如何沿着少数几个协同方向集中，如同在主成分分析 (PCA) 中一样。$P$ 的特征值等于捕捉了协变主要方向的正交轴上的方差。考虑以下在 $p$ 个性状上定义的整合指数，即相对特征值方差：\n$$\nV_{\\mathrm{rel}} \\;=\\; \\frac{\\frac{1}{p}\\sum_{i=1}^{p}\\left(\\lambda_{i}-\\bar{\\lambda}\\right)^{2}}{\\bar{\\lambda}^{2}},\n$$\n其中 $\\lambda_{i}$ 是 $P$ 的特征值，而 $\\bar{\\lambda} \\,=\\, \\frac{1}{p}\\sum_{i=1}^{p}\\lambda_{i}$。较大的 $V_{\\mathrm{rel}}$ 值表示方差更集中于较少的维度上（即更强的表型整合），而 $V_{\\mathrm{rel}}=0$ 对应于相等的特征值（即没有协变的优选方向）。\n\n从协方差矩阵及其特征分解的定义出发，并援引特征值代表表型协变正交轴上的方差这一标准解释，完成以下任务：\n\n1. 计算矩阵 $P$ 的所有特征值 $\\lambda_{1},\\lambda_{2},\\lambda_{3}$。\n2. 使用这些特征值，计算 $V_{\\mathrm{rel}}$。\n\n请以 $V_{\\mathrm{rel}}$ 的单个标量值的形式给出你的最终答案，采用精确的分数形式（不要四舍五入）。无需单位。", "solution": "必须首先严格验证问题陈述的科学性和逻辑完整性。\n\n首先，逐字提取已知条件：\n- 表型协方差矩阵：$P \\;=\\; \\begin{pmatrix} 2  1  0\\\\ 1  2  0\\\\ 0  0  1 \\end{pmatrix}$。\n- 性状数量：$p=3$。\n- 整合指数定义：$V_{\\mathrm{rel}} \\;=\\; \\frac{\\frac{1}{p}\\sum_{i=1}^{p}\\left(\\lambda_{i}-\\bar{\\lambda}\\right)^{2}}{\\bar{\\lambda}^{2}}$。\n- $P$ 的特征值用 $\\lambda_{i}$ 表示。\n- 特征值的平均值为 $\\bar{\\lambda} \\,=\\, \\frac{1}{p}\\sum_{i=1}^{p}\\lambda_{i}$。\n\n接下来，根据验证标准对这些已知条件进行评估。\n1.  **科学依据**：该问题基于既定原则。它使用了线性代数——特别是协方差矩阵的特征分解——这是主成分分析（PCA）的标准数学基础。在演化生物学和形态计量学中，使用PCA通过检验方差（特征值）的分布来分析表型整合是一种常用且有效的方法。矩阵 $P$ 是对称的，这是协方差矩阵的一个必要属性。将计算其特征值并检查其非负性，这是另一个要求。\n2.  **适定性**：该问题在数学上是适定的。它提供了一个特定的矩阵和一个精确定义的公式。任务是计算该矩阵的特征值，然后将这些值代入给定的公式。这种结构确保了存在唯一、稳定且有意义的解。\n3.  **客观性与完备性**：问题以客观、定量的术语陈述，没有歧义或主观解释。所有必要信息均已提供：矩阵 $P$、性状数量 $p$ 以及整合指数 $V_{\\mathrm{rel}}$ 的明确公式。\n\n结论是该问题是有效的。它在科学上是合理的、适定的，并包含了严谨求解所需的所有必要组成部分。我们可以继续进行。\n\n求解过程分为两步。首先，我们计算矩阵 $P$ 的特征值。其次，我们使用这些特征值来计算整合指数 $V_{\\mathrm{rel}}$。\n\n步骤1：计算特征值。\n矩阵 $P$ 的特征值 $\\lambda$ 是特征方程 $\\det(P - \\lambda I) = 0$ 的根，其中 $I$ 是单位矩阵。\n对于给定的矩阵 $P$，我们有：\n$$\nP - \\lambda I = \\begin{pmatrix} 2  1  0\\\\ 1  2  0\\\\ 0  0  1 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0  0\\\\ 0  1  0\\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 2-\\lambda  1  0\\\\ 1  2-\\lambda  0\\\\ 0  0  1-\\lambda \\end{pmatrix}\n$$\n我们现在计算这个矩阵的行列式。沿着第三行进行余子式展开：\n$$\n\\det(P - \\lambda I) = (1-\\lambda) \\det \\begin{pmatrix} 2-\\lambda  1 \\\\ 1  2-\\lambda \\end{pmatrix}\n$$\n$$\n\\det(P - \\lambda I) = (1-\\lambda) \\left[ (2-\\lambda)(2-\\lambda) - (1)(1) \\right]\n$$\n$$\n\\det(P - \\lambda I) = (1-\\lambda) \\left[ (2-\\lambda)^2 - 1 \\right]\n$$\n展开二次项：\n$$\n\\det(P - \\lambda I) = (1-\\lambda) \\left[ \\lambda^2 - 4\\lambda + 4 - 1 \\right] = (1-\\lambda)(\\lambda^2 - 4\\lambda + 3)\n$$\n我们通过将特征多项式设为零来求根。二次因子 $\\lambda^2 - 4\\lambda + 3$ 可以因式分解为 $(\\lambda-1)(\\lambda-3)$。\n所以，特征方程是：\n$$\n(1-\\lambda)(\\lambda-1)(\\lambda-3) = 0\n$$\n$$\n-(\\lambda-1)(\\lambda-1)(\\lambda-3) = 0\n$$\n该方程的根是 $\\lambda = 1$（代数重数为2）和 $\\lambda = 3$。因此，矩阵 $P$ 的三个特征值是 $\\lambda_1 = 3$，$\\lambda_2 = 1$ 和 $\\lambda_3 = 1$。所有特征值均为正，这证实了 $P$ 是一个正定矩阵，也是一个有效的协方差矩阵。\n\n步骤2：计算整合指数 $V_{\\mathrm{rel}}$。\n整合指数由以下公式给出：\n$$\nV_{\\mathrm{rel}} = \\frac{\\frac{1}{p}\\sum_{i=1}^{p}\\left(\\lambda_{i}-\\bar{\\lambda}\\right)^{2}}{\\bar{\\lambda}^{2}}\n$$\n我们有 $p=3$ 个性状，特征值为 $\\{3, 1, 1\\}$。\n首先，我们计算平均特征值 $\\bar{\\lambda}$：\n$$\n\\bar{\\lambda} = \\frac{1}{3}\\sum_{i=1}^{3}\\lambda_{i} = \\frac{1}{3}(3 + 1 + 1) = \\frac{5}{3}\n$$\n作为检验，平均特征值也等于矩阵的迹除以其维度：$\\bar{\\lambda} = \\frac{\\text{Tr}(P)}{p} = \\frac{2+2+1}{3} = \\frac{5}{3}$。这是正确的。\n\n接下来，我们计算 $V_{\\mathrm{rel}}$ 的分子，也就是特征值的方差。我们从离均差平方和开始：\n$$\n\\sum_{i=1}^{3}(\\lambda_i - \\bar{\\lambda})^2 = (3 - \\frac{5}{3})^2 + (1 - \\frac{5}{3})^2 + (1 - \\frac{5}{3})^2\n$$\n$$\n= \\left(\\frac{9-5}{3}\\right)^2 + \\left(\\frac{3-5}{3}\\right)^2 + \\left(\\frac{3-5}{3}\\right)^2\n$$\n$$\n= \\left(\\frac{4}{3}\\right)^2 + \\left(-\\frac{2}{3}\\right)^2 + \\left(-\\frac{2}{3}\\right)^2\n$$\n$$\n= \\frac{16}{9} + \\frac{4}{9} + \\frac{4}{9} = \\frac{16+4+4}{9} = \\frac{24}{9} = \\frac{8}{3}\n$$\n特征值的方差是 $\\frac{1}{p}\\sum(\\lambda_i - \\bar{\\lambda})^2$：\n$$\n\\frac{1}{3} \\times \\frac{8}{3} = \\frac{8}{9}\n$$\n现在，我们计算 $V_{\\mathrm{rel}}$ 的分母，即平均特征值的平方：\n$$\n\\bar{\\lambda}^2 = \\left(\\frac{5}{3}\\right)^2 = \\frac{25}{9}\n$$\n最后，我们将分子除以分母来计算 $V_{\\mathrm{rel}}$：\n$$\nV_{\\mathrm{rel}} = \\frac{8/9}{25/9} = \\frac{8}{25}\n$$\n要求以精确的分数形式给出值。结果是 $\\frac{8}{25}$。", "answer": "$$\\boxed{\\frac{8}{25}}$$", "id": "2736008"}, {"introduction": "在量化了整体整合之后，下一步是检验关于模块化结构的具体假说。模块化的核心特征是模块内部性状高度相关，而模块之间则相对独立。Escoufier的RV系数是衡量两组变量（即假定的模块）之间关联强度的有力工具。通过这个练习，你将学会如何利用RV系数来检验一个基于相关矩阵的模块化假说，这在形态计量学研究中是一项关键技能。[@problem_id:2736055]", "problem": "在对一个进化支的形态特征进行比较研究时，三个特征的表型相关矩阵（一个标准化的表型方差-协方差矩阵）被估计为\n$$\nP \\;=\\;\n\\begin{pmatrix}\n1  0.8  0 \\\\\n0.8  1  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n假设该特征集被假设为模块化的，模块为 $\\{1,2\\}$ 和 $\\{3\\}$。使用Escoufier的RV系数（RV）的定义作为衡量两组标准化特征之间关联的度量，该度量从表型相关矩阵的相应块子矩阵计算得出，推导并计算量化两个模块之间表型整合程度的RV系数。将RV系数表示为一个精确值（不进行四舍五入）。此外，简要解释这些数据在模块间整合方面是否与假设的模块划分一致。您最终报告的答案必须仅为RV系数的数值。", "solution": "该问题要求计算Escoufier的RV系数，以基于给定的表型相关矩阵 $P$ 来量化两个假设模块之间的表型整合程度。\n\nRV系数是平方相关系数的一个多变量推广。对于由矩阵 $X$ 和 $Y$ 表示的两组中心化变量，其各自的协方差矩阵为 $S_{XX}$ 和 $S_{YY}$，交叉协方差矩阵为 $S_{XY}$，RV系数定义为：\n$$ \\text{RV}(X, Y) = \\frac{\\text{tr}(S_{XY} S_{YX})}{\\sqrt{\\text{tr}(S_{XX}^2) \\text{tr}(S_{YY}^2)}} $$\n其中 $\\text{tr}(A)$ 表示矩阵 $A$ 的迹，且 $S_{YX} = S_{XY}^T$。\n\n在这个问题中，变量是标准化的特征，所以协方差矩阵就是相关矩阵。这两组变量对应于假设的模块：模块 $1 = \\{1, 2\\}$ 和模块 $2 = \\{3\\}$。总的表型相关矩阵 $P$ 必须根据这个划分被分割成块子矩阵。\n\n给定的矩阵是：\n$$ P = \\begin{pmatrix} 1  0.8  0 \\\\ 0.8  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n\n令 $P_{11}$ 为模块1的模块内相关矩阵，$P_{22}$ 为模块2的模块内相关矩阵，$P_{12}$ 和 $P_{21}$ 为模块间相关矩阵。划分后的矩阵为：\n$$\nP = \\left(\n\\begin{array}{cc|c}\n1  0.8  0 \\\\\n0.8  1  0 \\\\\n\\hline\n0  0  1\n\\end{array}\n\\right) = \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{21}  P_{22} \\end{pmatrix}\n$$\n\n从这个划分中，我们识别出块子矩阵：\n$$ P_{11} = \\begin{pmatrix} 1  0.8 \\\\ 0.8  1 \\end{pmatrix} $$\n$$ P_{22} = \\begin{pmatrix} 1 \\end{pmatrix} $$\n$$ P_{12} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n$$ P_{21} = P_{12}^T = \\begin{pmatrix} 0  0 \\end{pmatrix} $$\n\n量化模块1和模块2之间整合程度的RV系数是通过将这些块矩阵代入通用公式来计算的：\n$$ \\text{RV} = \\frac{\\text{tr}(P_{12} P_{21})}{\\sqrt{\\text{tr}(P_{11}^2) \\text{tr}(P_{22}^2)}} $$\n\n首先，我们计算分子项 $\\text{tr}(P_{12} P_{21})$：\n$$ P_{12} P_{21} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 0  0 \\end{pmatrix} = \\begin{pmatrix} 0 \\cdot 0  0 \\cdot 0 \\\\ 0 \\cdot 0  0 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} $$\n这个结果零矩阵的迹是：\n$$ \\text{tr}(P_{12} P_{21}) = 0 + 0 = 0 $$\n\n由于分子为 $0$，只要分母不为零，RV系数就为 $0$。为了完整性，我们验证分母。\n\n接下来，我们计算分母项 $\\sqrt{\\text{tr}(P_{11}^2) \\text{tr}(P_{22}^2)}$。\n我们计算 $P_{11}^2$：\n$$ P_{11}^2 = \\begin{pmatrix} 1  0.8 \\\\ 0.8  1 \\end{pmatrix} \\begin{pmatrix} 1  0.8 \\\\ 0.8  1 \\end{pmatrix} = \\begin{pmatrix} 1^2 + 0.8^2  1 \\cdot 0.8 + 0.8 \\cdot 1 \\\\ 0.8 \\cdot 1 + 1 \\cdot 0.8  0.8^2 + 1^2 \\end{pmatrix} $$\n$$ P_{11}^2 = \\begin{pmatrix} 1 + 0.64  0.8 + 0.8 \\\\ 0.8 + 0.8  0.64 + 1 \\end{pmatrix} = \\begin{pmatrix} 1.64  1.6 \\\\ 1.6  1.64 \\end{pmatrix} $$\n$P_{11}^2$ 的迹是：\n$$ \\text{tr}(P_{11}^2) = 1.64 + 1.64 = 3.28 $$\n\n我们计算 $P_{22}^2$：\n$$ P_{22}^2 = \\begin{pmatrix} 1 \\end{pmatrix}^2 = \\begin{pmatrix} 1 \\end{pmatrix} $$\n$P_{22}^2$ 的迹是：\n$$ \\text{tr}(P_{22}^2) = 1 $$\n\n现在，我们可以计算RV系数：\n$$ \\text{RV} = \\frac{0}{\\sqrt{3.28 \\cdot 1}} = \\frac{0}{\\sqrt{3.28}} = 0 $$\n分母不为零，因此结果是明确定义的。\n\n计算出的RV系数恰好为 $0$。RV系数的范围是 $0$到$1$，其中 $0$ 表示两组特征（模块）之间完全没有线性关联，$1$ 表示完全关联。值为 $0$ 表示模块1（特征 $\\{1, 2\\}$）和模块2（特征 $\\{3\\}$）之间没有表型整合。\n\n这一结果与假设的模块划分高度一致。特征的模块化组织特点是模块内部整合强，模块之间整合弱。数据显示模块1内部有高相关性（$\\rho_{12} = 0.8$），而模块之间没有相关性（由非对角块矩阵 $P_{12}$ 和 $P_{21}$ 为零矩阵所捕获）。因此，RV系数为 $0$ 为特征 $\\{1, 2\\}$ 和特征 $\\{3\\}$ 形成两个完全独立的模块这一假设提供了最强有力的定量支持。", "answer": "$$\n\\boxed{0}\n$$", "id": "2736055"}, {"introduction": "表型整合和模块化的静态模式对其动态的演化后果具有深远影响。多变量育种者方程 $\\Delta \\mathbf{\\bar{z}} = \\mathbf{G} \\mathbf{\\beta}$ 揭示了遗传结构（$\\mathbf{G}$）如何引导对选择（$\\mathbf{\\beta}$）的响应。这个练习通过一个具体的例子，展示了遗传协方差（一种整合形式）如何导致未受直接选择的性状发生演化，从而帮助你理解整合在演化过程中所扮演的约束和引导角色。[@problem_id:2736009]", "problem": "在一个$2$个数量性状存在遗传相关的群体中，考虑加性遗传方差-协方差矩阵 $G$ 和定义在均值标准化性状上的方向选择梯度向量 $\\mathbf{\\beta}$。加性遗传方差-协方差矩阵 $G$ 的对角线元素为加性遗传方差，非对角线元素为加性遗传协方差。当非对角线元素不为零时，表示表型整合。方向选择梯度 $\\mathbf{\\beta}$ 给出相对适合度对每个性状均值的偏导数（保持其他性状不变），因此指定了对每个性状的直接选择。假设性状均值经过$1$代的演化与适合度的加性遗传协方差成正比。\n\n已知\n$$\nG \\;=\\; \\begin{pmatrix} 1  0.5 \\\\ 0.5  1 \\end{pmatrix}, \n\\qquad\n\\mathbf{\\beta} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n所有量均以性状标准差为单位表示，因此您应以相同的无量纲尺度报告变化。\n\n任务：\n- 仅使用将演化变化与适合度的加性遗传协方差联系起来的数量遗传学基本原理，计算性状均值向量在一代内的预测变化量 $\\Delta \\mathbf{\\bar{z}}$。\n- 简要解释响应的哪个部分完全由表型整合（性状间的遗传协方差）引起，并说明其大小。\n\n将 $\\Delta \\mathbf{\\bar{z}}$ 的数值结果以行向量形式报告。无需四舍五入。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n步骤1：提取已知条件。\n提供的信息如下：\n- 一个具有$2$个数量性状的群体。\n- 加性遗传方差-协方差矩阵为 $G = \\begin{pmatrix} 1  0.5 \\\\ 0.5  1 \\end{pmatrix}$。\n- 方向选择梯度向量为 $\\mathbf{\\beta} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- 性状是均值标准化的。\n- 所有量均以性状标准差为单位。\n- 指导原则是“性状均值经过$1$代的演化与适合度的加性遗传协方差成正比”。\n- 任务是计算性状均值向量在一代内的预测变化量 $\\Delta \\mathbf{\\bar{z}}$，并解释由表型整合引起的响应部分。\n\n步骤2：验证。\n该问题提法明确且有科学依据。它描述了多变量数量遗传学中的一个经典情景。选择响应（$\\Delta \\mathbf{\\bar{z}}$）、遗传方差-协方差矩阵（$G$）和选择梯度（$\\mathbf{\\beta}$）之间的关系是演化生物学的一项基本原则，由一个公认的方程形式化。所提供的矩阵 $G$ 是一个有效的对称正定协方差矩阵，方差为$1$（与标准化性状一致），遗传相关为 $\\rho = \\frac{0.5}{\\sqrt{1 \\times 1}} = 0.5$，这是一个物理上现实的数值。选择梯度 $\\mathbf{\\beta}$ 表明仅对第一个性状有直接选择，这是研究间接选择的标准设置。没有矛盾、歧义或缺失信息。该问题是有效的。\n\n步骤3：求解。\n问题中陈述的基本原则，即平均表型的演化变化与适合度的加性遗传协方差成正比，由多变量育种家方程（也称为 Lande 方程）正式表达：\n$$\n\\Delta \\mathbf{\\bar{z}} = G \\mathbf{\\beta}\n$$\n此处，$\\Delta \\mathbf{\\bar{z}}$ 是表示一代内性状均值变化的向量，$G$ 是加性遗传方差-协方差矩阵，$\\mathbf{\\beta}$ 是方向选择梯度向量。\n\n已知：\n$$\nG = \\begin{pmatrix} 1  0.5 \\\\ 0.5  1 \\end{pmatrix}\n$$\n和\n$$\n\\mathbf{\\beta} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n我们计算矩阵 $G$ 和向量 $\\mathbf{\\beta}$ 的乘积，以求得选择响应 $\\Delta \\mathbf{\\bar{z}}$。\n$$\n\\Delta \\mathbf{\\bar{z}} = \\begin{pmatrix} \\Delta \\bar{z}_1 \\\\ \\Delta \\bar{z}_2 \\end{pmatrix} = \\begin{pmatrix} 1  0.5 \\\\ 0.5  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n计算过程如下：\n$$\n\\Delta \\bar{z}_1 = (1)(1) + (0.5)(0) = 1\n$$\n$$\n\\Delta \\bar{z}_2 = (0.5)(1) + (1)(0) = 0.5\n$$\n因此，性状均值向量在一代内的预测变化为：\n$$\n\\Delta \\mathbf{\\bar{z}} = \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix}\n$$\n任务的第二部分要求解释完全由表型整合引起的响应部分。在此遗传背景下，表型整合由 $G$ 矩阵的非零非对角线元素表示，具体来说是遗传协方差 $G_{12} = G_{21} = 0.5$。\n\n选择梯度 $\\mathbf{\\beta} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 表明，仅对性状1存在直接选择（因为 $\\beta_1 = 1$），而对性状2没有直接选择（因为 $\\beta_2 = 0$）。\n\n因此，性状2的变化量 $\\Delta \\bar{z}_2 = 0.5$ 是一个间接选择响应。它的发生不是因为性状2本身受到选择，而是因为它与受到选择的性状1存在遗传相关。这种演化变化完全归因于两个性状之间的遗传协方差。在 $\\Delta\\bar{z}_2$ 方程的展开式中，$G_{21}\\beta_1 = (0.5)(1) = 0.5$ 这一项代表了这种间接效应。\n\n因此，完全由表型整合引起的响应部分，是未受直接选择的性状的演化变化。这部分是 $\\Delta\\bar{z}_2$，其大小为 $0.5$ 个标准差单位。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  0.5 \\end{pmatrix}}\n$$", "id": "2736009"}]}