{"hands_on_practices": [{"introduction": "演化发育生物学的核心在于理解基因调控网络如何随时间演化，并产生形态多样性。为了精确描述这一过程，我们需要一个能够量化基因表达的数学框架。本练习将引导你从统计力学的基本原理出发，构建一个基因增强子的热力学模型([@problem_id:2710366])，该模型是理解顺式调控元件如何整合多个转录因子信号以决定基因开启或关闭概率的基础。", "problem": "在一个发育中的胚胎中，一个单一的增强子通过整合来自一种激活子（activator）的 $2$ 个结合位点和一种阻遏子（repressor）的 $1$ 个结合位点的输入来控制一个核心启动子。核心启动子与RNA聚合酶（RNA Pol；记为RNAP）结合。假设一个基因调控的热力学平衡（统计力学）模型，其中转录输出与RNAP结合到启动子的概率（占据假说）成正比。使用以下基本原则：\n\n- 在平衡状态下，调控DNA的每个微观状态 $s$（由哪些位点被占据定义）都有一个统计权重 $w(s)$，其大小与该状态下被占据位点的结合权重的乘积，再乘以存在的任何相互作用（协同性）因子成正比。\n- 状态 $s$ 的概率为 $P(s) = w(s)/Z$，其中配分函数 $Z = \\sum_{s} w(s)$ 是所有允许的微观状态的权重之和。\n- 对于一个结合因子 $X$ 的位点，若其自由核浓度为 $[X]$，解离常数为 $K_{X}$，则相对于未结合位点，其结合权重为 $[X]/K_{X}$。\n- 每个结合位点都是二元的（要么为空，要么最多被一个分子占据），并且除了明确指定的相互作用外，所有结合事件都是独立的。\n\n模型设定：\n\n- 有两个激活子结合位点，索引为 $i \\in \\{1,2\\}$。两者都结合相同的激活子 $A$，其浓度为 $[A]$，解离常数分别为 $K_{A1}$ 和 $K_{A2}$。\n- 有一个阻遏子结合位点，用于结合阻遏子 $R$，其浓度为 $[R]$，解离常数为 $K_{R}$。\n- 启动子与RNAP结合，其浓度为 $[P]$，解离常数为 $K_{P}$。\n- 当两个激活子位点同时被占据时，该状态的权重乘以一个激活子-激活子协同性因子 $\\omega_{AA}$。\n- 当RNAP结合，且激活子位点 $i$ 也被占据时，该状态的权重乘以一个激活子-聚合酶相互作用因子 $\\omega_{AP,i}$（对于 $i \\in \\{1,2\\}$）。\n- 阻遏子通过空间位阻排斥RNAP：任何阻遏子和RNAP同时结合的状态都是不允许的（权重为 $0$）。除排斥RNAP外，阻遏子不改变激活子的结合或激活子-激活子之间的相互作用（没有额外的相互作用）。\n- 不存在其他相互作用。\n\n仅使用上述原则，推导转录概率（与RNAP占据率成正比）$p_{\\mathrm{on}}([A],[R],[P])$ 的闭式表达式，该表达式是 $[A]$、$[R]$、$[P]$、$K_{A1}$、$K_{A2}$、$K_{R}$、$K_{P}$、$\\omega_{AA}$、$\\omega_{AP,1}$ 和 $\\omega_{AP,2}$ 的函数。将最终答案表示为单个代数表达式。不要简化为小数或代入数值。最终表达式中不要包含任何单位。无需四舍五入。", "solution": "问题陈述经评估有效。其科学基础是应用于基因调控的统计力学原理（Shea-Ackers模型），问题设定良好，所有必要的参数和条件都已定义，并以客观、正式的语言表述。它提出了一个可解的问题，没有矛盾、歧义或依赖于非科学前提。\n\n目标是推导RNA聚合酶（RNAP）结合到启动子的概率，记为 $p_{\\mathrm{on}}$。根据所指定的热力学模型，此概率是所有RNAP结合状态的统计权重之和（$Z_{\\mathrm{on}}$）与所有可能状态的统计权重之和（配分函数 $Z$）的比值。\n$$p_{\\mathrm{on}} = \\frac{Z_{\\mathrm{on}}}{Z}$$\n\n该系统包含四个结合位点：两个用于激活子（$A$），一个用于阻遏子（$R$），一个用于RNAP（$P$）。一个微观状态 $s$ 由这四个位点的占据情况定义。设一个状态由向量 $(s_{A1}, s_{A2}, s_R, s_P)$ 表示，其中 $s_i \\in \\{0, 1\\}$ 表示位点是空的（$0$）还是被占据的（$1$）。\n\n浓度为 $[X]$、解离常数为 $K_X$ 的因子 $X$ 的相对结合权重为 $[X]/K_X$。为方便起见，我们定义以下无量纲浓度：\n- 激活子在位点1：$c_{A1} = \\frac{[A]}{K_{A1}}$\n- 激活子在位点2：$c_{A2} = \\frac{[A]}{K_{A2}}$\n- 阻遏子：$c_{R} = \\frac{[R]}{K_{R}}$\n- RNAP：$c_{P} = \\frac{[P]}{K_{P}}$\n\n任何微观状态的统计权重 $w(s)$ 是所有被占据位点的结合权重的乘积，再乘以任何相关的协同性因子。配分函数 $Z$ 是所有允许的微观状态的 $w(s)$ 之和。\n\n一个关键约束是阻遏子 $R$ 通过空间位阻排斥RNAP $P$。这意味着任何 $R$ 和 $P$ 同时结合的状态都是不允许的，因此其统计权重为 $0$。总共有 $2^4 = 16$ 个潜在的微观状态，但其中 $s_R=1$ 且 $s_P=1$ 的状态是被禁止的。\n\n我们将通过对所有允许状态的权重求和来计算配分函数 $Z$。根据阻遏子位点的占据情况来组织求和会很方便。\n\n情况1：阻遏子位点未被占据（$s_R = 0$）。\n在这种情况下，RNAP可以自由结合。我们对剩下三个位点（A1、A2、P）的所有可能构型进行求和。\n这些状态的权重之和，我们称之为 $Z_{R=0}$，可以根据RNAP的占据情况进行因式分解。\n子情况1a：RNAP未结合（$s_P=0$）。激活子的可能构型有：\n- 没有激活子结合：权重 = $1$。\n- 只有激活子1结合：权重 = $c_{A1}$。\n- 只有激活子2结合：权重 = $c_{A2}$。\n- 两个激活子都结合（有协同性）：权重 = $c_{A1}c_{A2}\\omega_{AA}$。\n这个子情况的权重和为 $Z_{R=0, P=0} = 1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA}$。\n\n子情况1b：RNAP结合（$s_P=1$）。基础权重乘以 $c_P$。激活子相互作用因子 $\\omega_{AP,i}$ 也适用。\n- 只有RNAP结合：权重 = $c_P$。\n- RNAP和激活子1结合：权重 = $c_P c_{A1} \\omega_{AP,1}$。\n- RNAP和激活子2结合：权重 = $c_P c_{A2} \\omega_{AP,2}$。\n- RNAP和两个激活子都结合：权重 = $c_P c_{A1} c_{A2} \\omega_{AA} \\omega_{AP,1} \\omega_{AP,2}$。注意，两个激活子-聚合酶相互作用以及激活子-激活子协同性都适用。\n这个子情况的权重和为 $Z_{R=0, P=1} = c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})$。\n\n所以，阻遏子位点为空的状态的总配分函数是 $Z_{R=0} = Z_{R=0, P=0} + Z_{R=0, P=1}$。\n\n情况2：阻遏子位点被占据（$s_R = 1$）。\n基础权重乘以 $c_R$。由于空间位阻，RNAP不能结合，所以所有状态都有 $s_P=0$。除了排斥RNAP之外，激活子的构型与阻遏子无关。\n这些状态的权重之和 $Z_{R=1}$ 是：\n$Z_{R=1} = c_R(1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA})$。这正好是 $c_R \\cdot Z_{R=0, P=0}$。\n\n总配分函数 $Z$ 是所有允许状态的总和：\n$Z = Z_{R=0} + Z_{R=1} = (Z_{R=0, P=0} + Z_{R=0, P=1}) + Z_{R=1}$\n$Z = Z_{R=0, P=0} + Z_{R=0, P=1} + c_R \\cdot Z_{R=0, P=0}$\n$Z = (1+c_R)Z_{R=0, P=0} + Z_{R=0, P=1}$\n\n代入子配分函数的表达式：\n$$Z = (1+c_R)(1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA}) + c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})$$\n\n现在，我们求 $Z_{\\mathrm{on}}$，即RNAP结合状态的权重之和。根据定义，这些是 $s_P=1$ 的状态。排斥规则意味着对于这些状态，$s_R$ 必须为 $0$。因此，$Z_{\\mathrm{on}}$ 正好是我们计算出的 $Z_{R=0, P=1}$。\n$$Z_{\\mathrm{on}} = c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})$$\n\n最后，转录概率为 $p_{\\mathrm{on}} = Z_{\\mathrm{on}} / Z$。\n$$p_{\\mathrm{on}} = \\frac{c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})}{(1+c_R)(1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA}) + c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})}$$\n我们将 $c_{A1}$、$c_{A2}$、$c_R$ 和 $c_P$ 的原始定义代回：\n$c_{A1} = \\frac{[A]}{K_{A1}}$, $c_{A2} = \\frac{[A]}{K_{A2}}$, $c_{R} = \\frac{[R]}{K_{R}}$, $c_{P} = \\frac{[P]}{K_{P}}$。\n项 $c_{A1}c_{A2}$ 变为 $\\frac{[A]^2}{K_{A1}K_{A2}}$。\n\n最终表达式为：\n$$p_{\\mathrm{on}}([A],[R],[P]) = \\frac{\\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}{\\left(1+\\frac{[R]}{K_R}\\right)\\left(1 + \\frac{[A]}{K_{A1}} + \\frac{[A]}{K_{A2}} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\right) + \\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}$$\n这就是作为给定参数函数的转录概率的完整闭式表达式。", "answer": "$$\\boxed{\\frac{\\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}{\\left(1+\\frac{[R]}{K_R}\\right)\\left(1 + \\frac{[A]}{K_{A1}} + \\frac{[A]}{K_{A2}} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\right) + \\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}}$$", "id": "2710366"}, {"introduction": "基因调控的演化是形态演化的主要驱动力，而这种演化可以发生在两个层面：顺式（cis）调控元件（如增强子）的序列改变，或反式（trans）调控因子（如转录因子）的改变。区分这两种演化模式对于理解发育系统的演化轨迹至关重要。通过分析种间杂交体的等位基因特异性表达数据，我们可以量化顺式和反式效应对基因表达差异的贡献，这一方法已成为演化发育生物学的标准工具([@problem_id:2710400])。这个编程练习将让你亲手实现这一分类算法，从而深入理解包括“系统漂变”在内的重要演化概念。", "problem": "给定一组源自种间杂交体等位基因特异性表达的基因水平汇总统计数据，用于推断顺式和反式调控对表达差异的贡献。其科学基础是，在子一代（F1）杂交体中，两个等位基因都暴露在相同的反式作用因子细胞环境中，因此杂交体中任何等位基因特异性的表达差异都反映了顺式作用调控差异，而亲本表达差异与杂交体等位基因差异之间的残差则反映了反式作用调控差异。这些思想是演化发育生物学的基础，其中顺式和反式变化的组合可以通过补偿性演化产生保守的表型，这一现象被称为系统漂变。您的任务是使用标准正态近似和误差传播来实现以下定量分类方案。\n\n基本出发点和定义：\n- 对于给定基因，设 $E_A$ 和 $E_B$ 分别表示物种 A 和物种 B 中的稳态表达，设 $H_A$ 和 $H_B$ 分别表示 F1 杂交体中源自物种 A 和 B 的等位基因的特异性表达。将以2为底的表达比率对数视为效应量。\n- 定义亲本对数倍数变化为 $L_P = \\log_2\\left(\\dfrac{E_B}{E_A}\\right)$。\n- 定义杂交体等位基因对数倍数变化为 $L_C = \\log_2\\left(\\dfrac{H_B}{H_A}\\right)$，它估计了顺式调控效应，因为在杂交体中两个等位基因共享相同的反式环境。\n- 通过减法在对数尺度上定义反式调控效应为 $L_T = L_P - L_C$。这源于对数尺度上效应的可加性。\n- 假设 $L_P$ 和 $L_C$ 的估计量近似服从正态分布，其标准误分别为 $s_P$ 和 $s_C$，这些标准误源自生物学或技术重复。在亲本和杂交体估计量相互独立的假设下，使用误差传播计算差值的标准误，得到 $\\mathrm{SE}(L_T) = \\sqrt{s_P^2 + s_C^2}$。\n- 对于双侧显著性水平 $\\alpha = 0.05$ 的假设检验，使用标准正态临界值 $z^\\star = \\Phi^{-1}(1 - \\alpha/2)$，其中 $\\Phi^{-1}$ 是概率单位函数。数值上，$z^\\star \\approx 1.959963984540054$。\n- 定义顺式效应的检验统计量为 $z_C = \\dfrac{L_C}{s_C}$，反式效应的检验统计量为 $z_T = \\dfrac{L_T}{\\sqrt{s_P^2 + s_C^2}}$，亲本差异的检验统计量为 $z_P = \\dfrac{L_P}{s_P}$。当且仅当 $|z| > z^\\star$ 时，检验结果被判定为统计显著。\n\n每个基因的分类规则，返回一个整数代码：\n- $4$ (顺-反式补偿性系统漂变): 顺式和反式均显著， $L_C$ 和 $L_T$ 的符号相反，且亲本差异不显著，即 $|z_C| > z^\\star$，$|z_T| > z^\\star$，$L_C \\cdot L_T  0$ 且 $|z_P| \\le z^\\star$。\n- $3$ (顺式和反式增强性差异): 顺式和反式均显著， $L_C$ 和 $L_T$ 的符号相同，且亲本差异显著，即 $|z_C|  z^\\star$，$|z_T|  z^\\star$，$L_C \\cdot L_T  0$ 且 $|z_P|  z^\\star$。\n- $1$ (仅顺式): 顺式显著而反式不显著，即 $|z_C|  z^\\star$ 且 $|z_T| \\le z^\\star$。\n- $2$ (仅反式): 反式显著而顺式不显著，即 $|z_T|  z^\\star$ 且 $|z_C| \\le z^\\star$。\n- $0$ (无证据): 顺式和反式均不显著，即 $|z_C| \\le z^\\star$ 且 $|z_T| \\le z^\\star$。\n\n程序的输入是固定的，为以下基因测试套件，每个基因由一个四元组 $(L_P, s_P, L_C, s_C)$ 指定，其中效应值和标准误的单位均为以2为底的对数单位：\n- 基因 $1$: $(1.05, 0.25, 1.00, 0.20)$.\n- 基因 $2$: $(1.20, 0.20, 0.05, 0.25)$.\n- 基因 $3$: $(1.00, 0.10, 0.60, 0.10)$.\n- 基因 $4$: $(0.10, 0.15, 0.70, 0.10)$.\n- 基因 $5$: $(0.05, 0.20, 0.10, 0.20)$.\n- 基因 $6$: $(-0.80, 0.10, -0.02, 0.20)$.\n- 基因 $7$: $(-0.46, 0.20, -0.50, 0.10)$.\n- 基因 $8$: $(0.39, 0.20, 0.39, 0.20)$.\n\n角度单位和物理单位不适用，因为所有量都是无量纲的以2为底的对数或其标准误。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\mathrm{result}_1,\\mathrm{result}_2,\\dots]$），其中每个 $\\mathrm{result}_i$ 是根据上述规则为基因 $i$ 分配的整数代码，顺序与测试套件中的基因顺序相同。", "solution": "问题陈述已经过严格验证，并被确认为有效。\n\n**步骤 1：提取给定信息**\n\n问题提供了以下定义和数据：\n-   亲本对数倍数变化：$L_P = \\log_2\\left(\\dfrac{E_B}{E_A}\\right)$。\n-   杂交体等位基因对数倍数变化（顺式调控效应）：$L_C = \\log_2\\left(\\dfrac{H_B}{H_A}\\right)$。\n-   反式调控效应：$L_T = L_P - L_C$。\n-   $L_P$ 和 $L_C$ 估计量的标准误分别表示为 $s_P$ 和 $s_C$。\n-   $L_T$ 估计量的标准误通过误差传播给出：$\\mathrm{SE}(L_T) = \\sqrt{s_P^2 + s_C^2}$。\n-   双侧检验的显著性水平：$\\alpha = 0.05$。\n-   标准正态临界值：$z^\\star = \\Phi^{-1}(1 - \\alpha/2) \\approx 1.959963984540054$。\n-   检验统计量：$z_P = \\dfrac{L_P}{s_P}$，$z_C = \\dfrac{L_C}{s_C}$，以及 $z_T = \\dfrac{L_T}{\\sqrt{s_P^2 + s_C^2}}$。\n-   统计显著性的条件：$|z|  z^\\star$。\n-   一个包含五条规则的分类方案，用于根据 $z_C$, $z_T$, $z_P$ 的显著性以及乘积 $L_C \\cdot L_T$ 的符号来分配整数代码（$0$, $1$, $2$, $3$, $4$）。\n-   一个包含八个基因的测试套件，每个基因由一个元组 $(L_P, s_P, L_C, s_C)$ 指定。输入数据中的 `$` 符号是明显的印刷错误，应被忽略，其值被解释为标准浮点数。\n\n**步骤 2：验证结论**\n\n该问题是**有效的**。它在科学上基于演化遗传学中划分顺式和反式调控差异的既定原则。其数学和统计框架是自洽且定义明确的。所提供的数据是现实的，分类规则虽然没有穷尽所有理论可能性，但对于给定的测试用例是充分且明确的，这使得问题适定且可解。\n\n**步骤 3：求解方法**\n\n任务是根据一组规定的规则对每个基因进行分类。这需要对每个基因进行系统性计算，遵循以下步骤：\n\n1.  给定输入元组 $(L_P, s_P, L_C, s_C)$，计算衍生量。\n    -   反式调控效应：$L_T = L_P - L_C$。\n    -   反式效应估计量的标准误：$s_T = \\sqrt{s_P^2 + s_C^2}$。\n\n2.  计算三个检验统计量。\n    -   亲本差异：$z_P = L_P / s_P$。\n    -   顺式效应：$z_C = L_C / s_C$。\n    -   反式效应：$z_T = L_T / s_T$。\n\n3.  通过将其检验统计量的绝对值与临界值 $z^\\star \\approx 1.959963984540054$ 进行比较，来评估每个效应的显著性。\n    -   如果 $|z_C|  z^\\star$，则顺式效应显著。\n    -   如果 $|z_T|  z^\\star$，则反式效应显著。\n    -   如果 $|z_P|  z^\\star$，则亲本差异显著。\n\n4.  按特定顺序应用分类规则以确定整数代码。这套规则在结果空间上定义了一个划分。一个逻辑实现将对每个类别进行测试。\n\n    -   **类别 4 (补偿性):** 如果 $|z_C|  z^\\star$, $|z_T|  z^\\star$, $L_C \\cdot L_T  0$, 且 $|z_P| \\le z^\\star$。\n    -   **类别 3 (增强性):** 如果 $|z_C|  z^\\star$, $|z_T|  z^\\star$, $L_C \\cdot L_T  0$, 且 $|z_P|  z^\\star$。\n    -   **类别 1 (仅顺式):** 如果 $|z_C|  z^\\star$ 且 $|z_T| \\le z^\\star$。\n    -   **类别 2 (仅反式):** 如果 $|z_T|  z^\\star$ 且 $|z_C| \\le z^\\star$。\n    -   **类别 0 (无证据):** 如果 $|z_C| \\le z^\\star$ 且 $|z_T| \\le z^\\star$。\n\n实现将通过此计算和逻辑流程处理测试套件中的每个基因，以生成最终的分类代码列表。\n\n**每个基因的计算过程演练：**\n\n-   **基因 1:** $(L_P, s_P, L_C, s_C) = (1.05, 0.25, 1.00, 0.20)$。\n    $L_T = 1.05 - 1.00 = 0.05$。$s_T = \\sqrt{0.25^2 + 0.20^2} \\approx 0.3202$。\n    $z_C = 1.00 / 0.20 = 5.00$。$z_T = 0.05 / 0.3202 \\approx 0.156$。\n    $|z_C|  z^\\star$ 且 $|z_T| \\le z^\\star$。类别为 **1 (仅顺式)**。\n\n-   **基因 2:** $(L_P, s_P, L_C, s_C) = (1.20, 0.20, 0.05, 0.25)$。\n    $L_T = 1.20 - 0.05 = 1.15$。$s_T = \\sqrt{0.20^2 + 0.25^2} \\approx 0.3202$。\n    $z_C = 0.05 / 0.25 = 0.20$。$z_T = 1.15 / 0.3202 \\approx 3.592$。\n    $|z_C| \\le z^\\star$ 且 $|z_T|  z^\\star$。类别为 **2 (仅反式)**。\n\n-   **基因 3:** $(L_P, s_P, L_C, s_C) = (1.00, 0.10, 0.60, 0.10)$。\n    $L_T = 1.00 - 0.60 = 0.40$。$s_T = \\sqrt{0.10^2 + 0.10^2} \\approx 0.1414$。\n    $z_P = 1.00 / 0.10 = 10.00$。$z_C = 0.60 / 0.10 = 6.00$。$z_T = 0.40 / 0.1414 \\approx 2.828$。\n    所有效应均显著。$L_C \\cdot L_T = 0.60 \\cdot 0.40  0$。且 $|z_P|  z^\\star$。类别为 **3 (增强性)**。\n\n-   **基因 4:** $(L_P, s_P, L_C, s_C) = (0.10, 0.15, 0.70, 0.10)$。\n    $L_T = 0.10 - 0.70 = -0.60$。$s_T = \\sqrt{0.15^2 + 0.10^2} \\approx 0.1803$。\n    $z_P = 0.10 / 0.15 \\approx 0.667$。$z_C = 0.70 / 0.10 = 7.00$。$z_T = -0.60 / 0.1803 \\approx -3.328$。\n    $|z_C|  z^\\star$，$|z_T|  z^\\star$。$L_C \\cdot L_T = 0.70 \\cdot (-0.60)  0$。且 $|z_P| \\le z^\\star$。类别为 **4 (补偿性)**。\n\n-   **基因 5:** $(L_P, s_P, L_C, s_C) = (0.05, 0.20, 0.10, 0.20)$。\n    $L_T = 0.05 - 0.10 = -0.05$。$s_T = \\sqrt{0.20^2 + 0.20^2} \\approx 0.2828$。\n    $z_C = 0.10 / 0.20 = 0.50$。$z_T = -0.05 / 0.2828 \\approx -0.177$。\n    $|z_C| \\le z^\\star$ 且 $|z_T| \\le z^\\star$。类别为 **0 (无证据)**。\n\n-   **基因 6:** $(L_P, s_P, L_C, s_C) = (-0.80, 0.10, -0.02, 0.20)$。\n    $L_T = -0.80 - (-0.02) = -0.78$。$s_T = \\sqrt{0.10^2 + 0.20^2} \\approx 0.2236$。\n    $z_C = -0.02 / 0.20 = -0.10$。$z_T = -0.78 / 0.2236 \\approx -3.488$。\n    $|z_C| \\le z^\\star$ 且 $|z_T|  z^\\star$。类别为 **2 (仅反式)**。\n\n-   **基因 7:** $(L_P, s_P, L_C, s_C) = (-0.46, 0.20, -0.50, 0.10)$。\n    $L_T = -0.46 - (-0.50) = 0.04$。$s_T = \\sqrt{0.20^2 + 0.10^2} \\approx 0.2236$。\n    $z_C = -0.50 / 0.10 = -5.00$。$z_T = 0.04 / 0.2236 \\approx 0.179$。\n    $|z_C|  z^\\star$ 且 $|z_T| \\le z^\\star$。类别为 **1 (仅顺式)**。\n\n-   **基因 8:** $(L_P, s_P, L_C, s_C) = (0.39, 0.20, 0.39, 0.20)$。\n    $L_T = 0.39 - 0.39 = 0.0$。$s_T = \\sqrt{0.20^2 + 0.20^2} \\approx 0.2828$。\n    $z_C = 0.39 / 0.20 = 1.95$。$z_T = 0.0 / 0.2828 = 0.0$。\n    由于 $1.95  z^\\star \\approx 1.96$，我们有 $|z_C| \\le z^\\star$。我们也有 $|z_T| \\le z^\\star$。类别为 **0 (无证据)**。\n\n最终的整数代码序列是 $[1, 2, 3, 4, 0, 2, 1, 0]$。", "answer": "```python\nimport numpy as np\n# The problem statement indicates scipy is available, but it is not strictly\n# necessary as the critical value z* is provided numerically.\n# from scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Applies a quantitative classification scheme to infer cis and trans\n    regulatory contributions from gene expression summary statistics.\n    \"\"\"\n\n    # The critical value z* for a two-sided test at alpha = 0.05\n    # z_star = norm.ppf(1 - 0.05 / 2) - 1.959963984540054\n    z_star = 1.959963984540054\n\n    # Test suite of genes, each specified by (L_P, s_P, L_C, s_C).\n    # The '$' symbols from the problem description are ignored.\n    test_cases = [\n        (1.05, 0.25, 1.00, 0.20),  # Gene 1\n        (1.20, 0.20, 0.05, 0.25),  # Gene 2\n        (1.00, 0.10, 0.60, 0.10),  # Gene 3\n        (0.10, 0.15, 0.70, 0.10),  # Gene 4\n        (0.05, 0.20, 0.10, 0.20),  # Gene 5\n        (-0.80, 0.10, -0.02, 0.20), # Gene 6\n        (-0.46, 0.20, -0.50, 0.10), # Gene 7\n        (0.39, 0.20, 0.39, 0.20),  # Gene 8\n    ]\n\n    results = []\n    for case in test_cases:\n        L_P, s_P, L_C, s_C = case\n\n        # Calculate the trans-regulatory effect and its standard error\n        L_T = L_P - L_C\n        s_T = np.sqrt(s_P**2 + s_C**2)\n\n        # Calculate the test statistics for parental, cis, and trans effects.\n        # Ensure no division by zero, although problem inputs have s > 0.\n        z_P = L_P / s_P if s_P > 0 else 0\n        z_C = L_C / s_C if s_C > 0 else 0\n        z_T = L_T / s_T if s_T > 0 else 0\n        \n        # Determine significance of each effect\n        is_cis_sig = np.abs(z_C) > z_star\n        is_trans_sig = np.abs(z_T) > z_star\n        is_parental_sig = np.abs(z_P) > z_star\n        \n        # Apply the classification rules using a nested conditional structure.\n        # This structure directly implements the logic from the problem statement.\n        code = -1 # Default/error code\n        if is_cis_sig and is_trans_sig:\n            if (L_C * L_T  0) and (not is_parental_sig):\n                code = 4  # cis-trans compensatory\n            elif (L_C * L_T > 0) and is_parental_sig:\n                code = 3  # cis and trans reinforcing\n        elif is_cis_sig and not is_trans_sig:\n            code = 1  # cis-only\n        elif not is_cis_sig and is_trans_sig:\n            code = 2  # trans-only\n        elif not is_cis_sig and not is_trans_sig:\n            code = 0  # no evidence\n\n        results.append(code)\n    \n    # Format and print the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2710400"}, {"introduction": "发育过程由复杂的基因调控网络控制，网络中不同基因的突变效应并非简单叠加。这种非加性效应被称为“基因上位性”（epistasis），它揭示了基因间的相互作用方式和发育通路的底层架构。在本练习中，你将使用定量遗传学的方法，根据一系列基因型（包括双突变体）的表型数据来计算上位性系数([@problem_id:2710401])。通过解读上位性系数的符号，你将能够推断基因是在同一线性通路中起作用，还是在平行的、具有冗余性的通路中发挥功能，从而将分子水平的互作与宏观的表型联系起来。", "problem": "在一个模式脊椎动物肢芽系统中，考虑一个用 $z$ 表示的定量形态性状，其定义为沿近-远轴的远端信号区域范围（例如，成纤维细胞生长因子 $8$ 表达范围）的一个无量纲、归一化的度量。归一化的方式使得野生型的中位数接近 $1$。研究了两个基因座：一个是对远端间充质进行模式构建的转录因子基因座（基因座 $A$），另一个是调节上皮-间充质反馈的细胞外信号配体基因座（基因座 $B$）。对于每种基因型，在相同的环境条件下，对六个独立饲养的胚胎测量了性状 $z$。\n\n各基因型及其重复测量值如下：\n- 野生型：$z_{0}$ 重复测量值 $\\{1.02, 0.98, 1.01, 0.99, 1.00, 1.00\\}$。\n- 基因座 $A$ 的单突变体：$z_{1}$ 重复测量值 $\\{0.80, 0.77, 0.79, 0.78, 0.78, 0.76\\}$。\n- 基因座 $B$ 的单突变体：$z_{2}$ 重复测量值 $\\{0.85, 0.86, 0.84, 0.85, 0.83, 0.87\\}$。\n- 双突变体 $A$,$B$：$z_{12}$ 重复测量值 $\\{0.56, 0.54, 0.55, 0.55, 0.55, 0.56\\}$。\n\n采用数量遗传学和演化发育生物学中弱效应近似下的标准加性零模型：在没有上位性的情况下，双突变体表型的预测值是通过将各个单突变体与野生型的偏差相加得到的。使用 $z_{0}$、$z_{1}$、$z_{2}$ 和 $z_{12}$ 的样本均值，将上位性系数定义为观察到的双突变体均值与此加性零模型预测值之间的有符号偏差。\n\n使用这些数据计算上位性系数，并将其报告为一个无量纲数，四舍五入到三位有效数字。在你的论证中，从演化发育生物学的基本原理出发，论证为何该系数的符号能够提供关于基因座 $A$ 和 $B$ 是在共享饱和模块内相互作用，还是在具有非线性表型图谱的并行模块中相互作用的信息。最终答案中不要包含任何单位。", "solution": "该问题要求根据模式脊椎动物系统中一个定量性状的实验数据计算上位性系数，并随后基于演化发育生物学的原理对其符号进行解释。\n\n首先，必须验证问题的有效性。给定的是四种基因型——野生型 ($z_0$)、两种单突变体 ($z_1$, $z_2$) 和一种双突变体 ($z_{12}$)——的一个无量纲性状 $z$ 的重复测量值。问题提供了加性零模型和上位性系数 $\\epsilon$（作为与该模型的偏差）的定义。该问题在数量遗传学和发育生物学方面具有科学依据，问题陈述清晰，信息充分且一致，表述客观。因此，该问题是有效的，我们可以继续求解。\n\n上位性系数 $\\epsilon$ 定义为观察到的双突变体平均表型 $\\bar{z}_{12}$ 与加性零模型下预测的表型 $\\hat{z}_{12}$ 之间的差值。\n加性模型假设双突变效应是单个突变相对于野生型效应的总和。基因座 $A$ 的突变效应为 $\\Delta_1 = \\bar{z}_1 - \\bar{z}_0$，基因座 $B$ 的突变效应为 $\\Delta_2 = \\bar{z}_2 - \\bar{z}_0$。\n\n预测的双突变体表型 $\\hat{z}_{12}$ 由下式给出：\n$$\n\\hat{z}_{12} = \\bar{z}_0 + \\Delta_1 + \\Delta_2 = \\bar{z}_0 + (\\bar{z}_1 - \\bar{z}_0) + (\\bar{z}_2 - \\bar{z}_0) = \\bar{z}_1 + \\bar{z}_2 - \\bar{z}_0\n$$\n那么，上位性系数 $\\epsilon$ 的计算公式为：\n$$\n\\epsilon = \\bar{z}_{12} - \\hat{z}_{12} = \\bar{z}_{12} - (\\bar{z}_1 + \\bar{z}_2 - \\bar{z}_0)\n$$\n\n为了计算 $\\epsilon$，我们首先根据提供的 $n=6$ 个重复测量值计算每种基因型的样本均值。\n\n对于野生型 ($z_0$)：\n$$\n\\bar{z}_0 = \\frac{1}{6} (1.02 + 0.98 + 1.01 + 0.99 + 1.00 + 1.00) = \\frac{6.00}{6} = 1.00\n$$\n对于基因座 $A$ 的单突变体 ($z_1$)：\n$$\n\\bar{z}_1 = \\frac{1}{6} (0.80 + 0.77 + 0.79 + 0.78 + 0.78 + 0.76) = \\frac{4.68}{6} = 0.78\n$$\n对于基因座 $B$ 的单突变体 ($z_2$)：\n$$\n\\bar{z}_2 = \\frac{1}{6} (0.85 + 0.86 + 0.84 + 0.85 + 0.83 + 0.87) = \\frac{5.10}{6} = 0.85\n$$\n对于双突变体 $A,B$ ($z_{12}$)：\n$$\n\\bar{z}_{12} = \\frac{1}{6} (0.56 + 0.54 + 0.55 + 0.55 + 0.55 + 0.56) = \\frac{3.31}{6}\n$$\n现在，我们计算预测的双突变体表型 $\\hat{z}_{12}$：\n$$\n\\hat{z}_{12} = 0.78 + 0.85 - 1.00 = 0.63\n$$\n最后，我们计算上位性系数 $\\epsilon$：\n$$\n\\epsilon = \\bar{z}_{12} - \\hat{z}_{12} = \\frac{3.31}{6} - 0.63 \\approx 0.55166... - 0.63 = -0.07833...\n$$\n按要求四舍五入到三位有效数字，我们得到：\n$$\n\\epsilon \\approx -0.0783\n$$\n问题的第二部分是论证 $\\epsilon$ 符号的生物学解释。计算出的系数是负数。这是一个负上位性或称加剧性上位性的案例，因为观察到的双突变体表型 ($\\bar{z}_{12} \\approx 0.552$) 比加性模型预测的 ($\\hat{z}_{12} = 0.63$) 更为严重（即性状值更小）。\n\n从发育生物学的基本原理来看，上位性的符号为底层调控网络中基因之间的功能关系提供了关键信息。\n正上位性系数 ($\\epsilon  0$) 表示两个突变的组合效应小于它们各自效应的总和。观察到的双突变体表型比预测的要轻 ($\\bar{z}_{12}  \\hat{z}_{12}$)。这是一个“共享饱和模块”的标志。如果两个基因在同一个线性通路中起作用，一个基因的突变会减少通路的输出。那么，同一通路中的第二个突变所产生的影响就会减弱，因为它所作用的底物或信号已经被第一个突变所减少。这种收益递减或饱和的现象导致了正上位性。\n\n相反，此处计算出的负上位性系数 ($\\epsilon  0$) 意味着协同相互作用。两个突变的组合效应大于它们各自效应的总和。这是在并行、冗余或补偿性通路中起作用的基因的特征。在这种“并行模块”的结构中，生物系统具有鲁棒性；一条通路的存在可以缓冲或补偿另一条通路的缺失。因此，单突变体表现出相对温和的表型。然而，当双突变体中两条通路都被灭活时，这种缓冲能力完全丧失，导致系统性崩溃，其严重程度远超简单地将单个缺陷相加所预测的。这正是数据中所观察到的情况。\n\n“非线性表型图谱”的概念是对这一现象的形式化描述。如果两个基因座控制的并行通路其输出结合形成一个中间信号，而最终表型是该信号的凸函数，那么随着信号水平的下降，对扰动的表型响应会变得越来越严重。这种数学条件会产生负上位性，并且在生物学上等同于并行系统中冗余性的崩溃。\n\n因此，上位性系数的负号 ($\\epsilon \\approx -0.0783$) 是反对基因座 $A$ 和 $B$ 在一个简单的共享饱和模块中起作用的有力证据。相反，它支持了它们在有助于形成远端信号区域的并行通路中运作的假说，从而提供了一定程度的相互功能冗余。", "answer": "$$\n\\boxed{-0.0783}\n$$", "id": "2710401"}]}