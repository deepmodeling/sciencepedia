{"hands_on_practices": [{"introduction": "一个成功的古基因组学项目始于周密的规划。本练习将引导你完成一项基本计算：确定所需的测序深度，它关联了预期的内源DNA含量、文库复杂度和目标基因组覆盖度等关键因素。掌握这项技能对于设计性价比高且行之有效的古DNA研究至关重要。[@problem_id:2691892]", "problem": "在古DNA（aDNA）测序项目中，规划测序深度需要将预期的内源性DNA含量、重复率和读长与目标基因组的有效唯一覆盖度联系起来。考虑一个单端Illumina测序，读长为 $75 \\ \\mathrm{bp}$，基因组大小为 $3 \\times 10^{9} \\ \\mathrm{bp}$。您的目标是在目标基因组上实现去除重复序列后 $0.5\\times$ 的有效覆盖度。预实验数据表明内源性DNA含量为 $0.05$（即原始读段中有 $0.05$ 的比例来源于目标分类单元），文库复杂度表明 $0.30$ 的内源性读段将被标记为重复并在去重过程中被移除。\n\n假设遵循古基因组学实践中的以下标准近似：\n- 覆盖度定义为比对到目标上的唯一碱基总数除以单倍体基因组大小。\n- 内源性比例均匀适用于所有原始读段，并且所有内源性读段均能以完整的 $75 \\ \\mathrm{bp}$ 有效长度正确比对。\n- 去重过程移除了 $0.30$ 比例的内源性读段，留下 $0.70$ 比例的内源性读段作为唯一读段。污染读段不提供任何目标覆盖度。\n- 因接头修剪、碱基质量过滤以及超出上述假设的比对失败所造成的损失在此计算中可忽略不计。\n\n在这些假设下，计算达到目标有效覆盖度所需的原始读段数量。将您的最终答案表示为读段数，并四舍五入至三位有效数字。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n- 读长：$L = 75 \\ \\mathrm{bp}$\n- 基因组大小：$G = 3 \\times 10^{9} \\ \\mathrm{bp}$\n- 目标去重后有效覆盖度：$C_{eff} = 0.5\\times$\n- 内源性DNA含量：$f_{endo} = 0.05$\n- 内源性读段的重复比例：$f_{dup} = 0.30$\n- 内源性读段的唯一比例：$1 - f_{dup} = 1 - 0.30 = 0.70$\n- 覆盖度定义：比对到目标上的唯一碱基总数除以单倍体基因组大小。\n- 假设：内源性比例是均匀的；所有内源性读段都以全长 $L$ 进行比对；去重移除了比例为 $f_{dup}$ 的读段；其他损失可忽略不计。\n- 要求输出：所需的原始读段数量，四舍五入至三位有效数字。\n\n验证结论：该问题有效。它在科学上基于基因组学和测序分析的原理，提供了一个定义明确、客观且独立的定量问题，并带有现实的参数。它没有违反任何无效标准。所提供的假设是古基因组学中用于此类初步计算的标准简化方法。\n\n解题过程如下。\n\n设 $N_{raw}$ 为所需的原始读段总数。\n目标有效覆盖度 $C_{eff}$ 定义为唯一的、位于目标上的碱基总数（我们称之为 $B_{eff}$）除以基因组大小 $G$。\n$$C_{eff} = \\frac{B_{eff}}{G}$$\n由此，达到目标覆盖度所需的有效碱基总数为：\n$$B_{eff} = C_{eff} \\times G$$\n现在，我们必须将 $B_{eff}$ 与原始读段总数 $N_{raw}$ 联系起来。这个过程涉及反映数据处理流程的几个步骤。\n\n首先，原始读段总数 $N_{raw}$ 乘以内源性DNA含量比例 $f_{endo}$，以确定源自目标基因组的读段数量 $N_{endo}$。\n$$N_{endo} = N_{raw} \\times f_{endo}$$\n其次，这些内源性读段需要进行去重处理。其中比例为 $f_{dup}$ 的读段被识别为重复并被移除。剩余的唯一读段比例为 $(1 - f_{dup})$。因此，唯一的内源性读段数量 $N_{unique}$ 为：\n$$N_{unique} = N_{endo} \\times (1 - f_{dup}) = N_{raw} \\times f_{endo} \\times (1 - f_{dup})$$\n根据问题的假设，每个唯一的内源性读段都以其全长 $L$ 贡献给有效碱基计数。因此，有效碱基总数 $B_{eff}$ 可以表示为：\n$$B_{eff} = N_{unique} \\times L = N_{raw} \\times f_{endo} \\times (1 - f_{dup}) \\times L$$\n我们现在有两个关于 $B_{eff}$ 的表达式。通过将它们相等，我们可以构建一个方程来求解未知量 $N_{raw}$。\n$$C_{eff} \\times G = N_{raw} \\times f_{endo} \\times (1 - f_{dup}) \\times L$$\n重新整理以求解 $N_{raw}$：\n$$N_{raw} = \\frac{C_{eff} \\times G}{f_{endo} \\times (1 - f_{dup}) \\times L}$$\n现在，我们将给定值代入此表达式中：\n- $C_{eff} = 0.5$\n- $G = 3 \\times 10^{9}$\n- $f_{endo} = 0.05$\n- $f_{dup} = 0.30$\n- $L = 75$\n\n$$N_{raw} = \\frac{0.5 \\times (3 \\times 10^{9})}{0.05 \\times (1 - 0.30) \\times 75}$$\n我们分别计算分子和分母。\n分子：\n$$0.5 \\times 3 \\times 10^{9} = 1.5 \\times 10^{9}$$\n分母：\n$$0.05 \\times (1 - 0.30) \\times 75 = 0.05 \\times 0.70 \\times 75 = 0.035 \\times 75 = 2.625$$\n现在，我们进行除法运算：\n$$N_{raw} = \\frac{1.5 \\times 10^{9}}{2.625}$$\n$$N_{raw} = \\frac{1500}{2.625} \\times 10^{6} \\approx 571428571.43$$\n为了用标准科学记数法表示，我们写作：\n$$N_{raw} \\approx 5.7142857... \\times 10^{8}$$\n问题要求答案四舍五入到三位有效数字。\n$$N_{raw} \\approx 5.71 \\times 10^{8}$$\n这是在给定条件下，为达到指定的有效覆盖度目标所必须生成的原始测序读段的总数。", "answer": "$$\\boxed{5.71 \\times 10^8}$$", "id": "2691892"}, {"introduction": "我们如何确定一个DNA片段是真正古老的？本练习探讨了古DNA最著名的标志：死后损伤，特别是在分子末端胞嘧啶到胸腺嘧啶（$C \\to T$）的错配率升高。你将学习如何利用这一标志性特征来计算似然比，从而为单个测序读段的真实性提供定量评估。[@problem_id:2691924]", "problem": "古代脱氧核糖核酸 (DNA) 中死后胞嘧啶脱氨的一个基本标志是，相对于全基因组背景，其 $5^{\\prime}$ 末端的胞嘧啶到胸腺嘧啶的错配概率升高。考虑一个生成模型，其中一个读段 (read) 中每个比对上的胞嘧啶位置都属于两种结构类别之一：$5^{\\prime}$ 末端位置（第一个比对上的碱基）或内部位置（所有其余比对上的位置）。假设给定其类别和潜在的生成过程，各位点之间条件独立，并且在每个胞嘧啶位置观察到胞嘧啶到胸腺嘧啶的错配是一个伯努利试验。\n\n给定以下针对双组分位置损伤图谱的经验校准错配概率：\n- 在古代DNA模型下，$5^{\\prime}$ 末端位置发生胞嘧啶到胸腺嘧啶错配的概率为 $p_{\\mathrm{end}}^{\\mathrm{A}} = 0.25$，而全基因组背景（内部位置）的概率为 $p_{\\mathrm{bg}}^{\\mathrm{A}} = 0.02$。\n- 在现代DNA模型下，没有 $5^{\\prime}$ 富集现象，$5^{\\prime}$ 末端位置和内部位置的错配概率均为 $p^{\\mathrm{M}} = 0.02$。\n\n一个单独的比对上的读段，其第一个比对位置与参考序列的一个胞嘧啶重叠，并在这个 $5^{\\prime}$ 位置显示出胞嘧啶到胸腺嘧啶的错配。在该读段的其余部分，有 $k = 12$ 个额外的比对位置，其参考碱基是胞嘧啶，而这些内部位置均未显示出胞嘧啶到胸腺嘧啶的错配。\n\n仅使用独立性假设下的似然定义和这些经过充分检验的错配概率，计算似然比\n$$\n\\Lambda \\;=\\; \\frac{\\Pr(\\text{data} \\mid \\text{ancient-DNA model})}{\\Pr(\\text{data} \\mid \\text{modern-DNA model})}.\n$$\n将你的最终答案表示为一个实数。无需四舍五入。", "solution": "我们从独立性假设下的似然定义开始。将每个比对上的胞嘧啶位置视为一次胞嘧啶到胸腺嘧啶错配的伯努利试验，其概率由结构类别（$5^{\\prime}$ 末端位置与内部位置）和生成模型（古代DNA与现代DNA）决定。\n\n设观测数据为：在 $5^{\\prime}$ 末端位置有一次错配，在 $k=12$ 个内部胞嘧啶位置上没有错配。\n\n在古代DNA模型下，观测数据的概率是\n$$\n\\Pr(\\text{data} \\mid \\text{A}) \\;=\\; \\underbrace{p_{\\mathrm{end}}^{\\mathrm{A}}}_{\\text{$5^{\\prime}$ terminal hit}} \\times \\underbrace{(1 - p_{\\mathrm{bg}}^{\\mathrm{A}})^{k}}_{\\text{no hits at $k$ internal positions}} \\;=\\; 0.25 \\times (1 - 0.02)^{12}.\n$$\n\n在现代DNA模型下，$5^{\\prime}$ 末端位置没有富集，与内部位置共享相同的错配概率，因此\n$$\n\\Pr(\\text{data} \\mid \\text{M}) \\;=\\; \\underbrace{p^{\\mathrm{M}}}_{\\text{$5^{\\prime}$ terminal hit}} \\times \\underbrace{(1 - p^{\\mathrm{M}})^{k}}_{\\text{no hits at $k$ internal positions}} \\;=\\; 0.02 \\times (1 - 0.02)^{12}.\n$$\n\n根据似然比的定义，\n$$\n\\Lambda \\;=\\; \\frac{\\Pr(\\text{data} \\mid \\text{A})}{\\Pr(\\text{data} \\mid \\text{M})} \\;=\\; \\frac{0.25 \\times (1 - 0.02)^{12}}{0.02 \\times (1 - 0.02)^{12}} \\;=\\; \\frac{0.25}{0.02}.\n$$\n\n全基因组背景因子被约掉了，因为在两种模型下，它们对于内部位置是相同的。因此，\n$$\n\\Lambda \\;=\\; \\frac{0.25}{0.02} \\;=\\; 12.5.\n$$\n\n这个值是在观测到 $5^{\\prime}$ 末端胞嘧啶到胸腺嘧啶的错配以及在 $k=12$ 个内部胞嘧啶位置上没有内部胞嘧啶到胸腺嘧啶错配的情况下，支持古代DNA模型的似然比。", "answer": "$$\\boxed{12.5}$$", "id": "2691924"}, {"introduction": "要对群体历史得出准确的结论，就必须处理古DNA数据中的系统性偏差。这个高级练习将处理两个主要问题：参考偏好和现代DNA污染，并展示它们如何扭曲像D-统计量这样的群体遗传学统计值。你将推导出一个校正后的估计量来修正这些人为因素，这是进行稳健的进化推断的关键一步。[@problem_id:2691814]", "problem": "您正在使用基于ABBA和BABA位点模式计数的D统计量，分析四个分类单元 $H_1$、$H_2$、$H_3$ 和 $O$（其中 $O$ 为外群）之间的等位基因共享情况。设D统计量定义为\n$$\nD \\equiv \\frac{\\sum I_{\\mathrm{ABBA}} - \\sum I_{\\mathrm{BABA}}}{\\sum I_{\\mathrm{ABBA}} + \\sum I_{\\mathrm{BABA}}},\n$$\n其中 $I_{\\mathrm{ABBA}}$ 和 $I_{\\mathrm{BABA}}$ 是双等位基因位点上ABBA和BABA构型的指示变量，通过相对于 $O$ 的衍生与祖先状态来定义。考虑到样本 $H_1$ 是一个古老的基因组，同时受到参考偏好和污染的影响。两个经过充分检验的事实构成了建模假设：\n- 对线性参考基因组的优先比对会增加那些测序碱基与某个位点的参考碱基相匹配的读段（reads）的保留率。具体来说，假设如果测序的碱基与该位点的线性参考碱基相同，则读段被比对器保留的可能性是其不同时的 $\\alpha$ 倍。因此，由匹配参考序列的等位基因支持的事件的观测计数，相对于由不匹配参考序列的等位基因支持的事件，会乘性地膨胀一个因子 $\\alpha$。\n- 每个读段的死后损伤（Post-Mortem Damage, PMD）权重 $w \\in [0,1]$ 近似表示了一个读段是真实古代DNA的后验概率。将这些权重在所有读段上求和，可以得到一个经污染衰减的有效计数。\n\n您获得了一些汇总观察数据，这些数据根据支持ABBA或BABA判定的 $H_1$ 中的等位基因是否与参考碱基匹配进行了划分。对于ABBA，设 $n_{Ar}$ 表示由 $H_1$ 中匹配参考序列的等位基因支持的ABBA判定的观测数量，$n_{An}$ 表示由 $H_1$ 中不匹配参考序列的等位基因支持的观测数量。对于BABA，类似地定义 $n_{Br}$ 和 $n_{Bn}$。设 $\\bar{w}_{Ar}$、$\\bar{w}_{An}$、$\\bar{w}_{Br}$ 和 $\\bar{w}_{Bn}$ 表示对每个类别有贡献的读段的相应平均PMD权重。\n\n从 $D$ 的定义和上述两个建模假设出发，推导一个经过偏好校正和PMD加权的估计量 $\\hat{D}_{\\mathrm{corr}}$，该估计量能消除由参考偏好引起的匹配参考序列类别的乘性膨胀，并使用PMD权重对可能的污染读段进行降权。然后，使用以下经验汇总值计算 $\\hat{D}_{\\mathrm{corr}}$：\n- $\\alpha = 1.2$,\n- $n_{Ar} = 720$, $n_{An} = 480$, $n_{Br} = 360$, $n_{Bn} = 640$,\n- $\\bar{w}_{Ar} = 0.6$, $\\bar{w}_{An} = 0.9$, $\\bar{w}_{Br} = 0.5$, $\\bar{w}_{Bn} = 0.85$.\n\n将您的最终答案表示为既约分数（不要四舍五入）。答案必须是单个值。", "solution": "该问题在科学上是合理的、提法得当且客观的，基于古基因组学中的既定原则（D统计量、参考偏好、基于PMD的真实性验证），提供了一个清晰、可形式化的任务。所有必要的数据都已提供，术语精确，数值也符合实际。\n\n目标是推导一个校正后的估计量 $\\hat{D}_{\\mathrm{corr}}$，该估计量考虑了两个指定的系统误差来源：参考偏好和现代DNA污染。\n\n设 $N_{ABBA}$ 和 $N_{BABA}$ 代表ABBA和BABA位点的真实、未观测到的计数。D统计量是这些计数的函数。我们的观测值是这些真实计数的带偏好版本。我们必须首先建立一个模型，将观测到的计数 ($n_{Ar}, n_{An}, n_{Br}, n_{Bn}$) 与校正指定偏好后的真实基础计数联系起来。\n\n我们寻求找到校正后的总计数，我们将其表示为 $N'_{\\mathrm{ABBA}}$ 和 $N'_{\\mathrm{BABA}}$。\n\n首先，我们处理参考偏好。问题指出，由匹配参考序列的等位基因支持的事件的观测计数被一个因子 $\\alpha$ 膨胀了。这意味着观测计数 $n_{Ar}$ 和 $n_{Br}$ 被夸大了。为了获得在没有这种比对偏好的情况下本应观测到的位点计数的估计值，我们必须将这些观测计数除以 $\\alpha$。非参考等位基因的计数 $n_{An}$ 和 $n_{Bn}$ 不受此偏好影响。\n-   ABBA-参考的偏好校正计数：$\\frac{n_{Ar}}{\\alpha}$\n-   BABA-参考的偏好校正计数：$\\frac{n_{Br}}{\\alpha}$\n\n其次，我们处理污染问题。读段的PMD权重 $w$ 是其真实性的估计。问题指出，将这些权重求和得到一个“经污染衰减的有效计数”。对于位点的聚合，有效计数是观测计数乘以该类别的平均PMD权重。这个校正必须应用于已经为参考偏好校正过的位点计数。\n\n我们将每个类别的完全校正计数公式化如下：\n-   ABBA，匹配参考序列的校正计数 ($N'_{Ar}$): \n    $$N'_{Ar} = \\frac{n_{Ar}}{\\alpha} \\bar{w}_{Ar}$$\n-   ABBA，不匹配参考序列的校正计数 ($N'_{An}$): \n    $$N'_{An} = n_{An} \\bar{w}_{An}$$\n-   BABA，匹配参考序列的校正计数 ($N'_{Br}$):\n    $$N'_{Br} = \\frac{n_{Br}}{\\alpha} \\bar{w}_{Br}$$\n-   BABA，不匹配参考序列的校正计数 ($N'_{Bn}$):\n    $$N'_{Bn} = n_{Bn} \\bar{w}_{Bn}$$\n\nABBA模式的总校正计数 $N'_{\\mathrm{ABBA}}$ 是两个子类别校正贡献的总和：\n$$N'_{\\mathrm{ABBA}} = N'_{Ar} + N'_{An} = \\frac{n_{Ar}}{\\alpha} \\bar{w}_{Ar} + n_{An} \\bar{w}_{An}$$\n类似地，BABA模式的总校正计数 $N'_{\\mathrm{BABA}}$ 是：\n$$N'_{\\mathrm{BABA}} = N'_{Br} + N'_{Bn} = \\frac{n_{Br}}{\\alpha} \\bar{w}_{Br} + n_{Bn} \\bar{w}_{Bn}$$\n\n然后，使用这些校正后的计数，代入标准的D统计量公式，构建出经偏好校正和PMD加权的估计量 $\\hat{D}_{\\mathrm{corr}}$：\n$$\\hat{D}_{\\mathrm{corr}} = \\frac{N'_{\\mathrm{ABBA}} - N'_{\\mathrm{BABA}}}{N'_{\\mathrm{ABBA}} + N'_{\\mathrm{BABA}}} = \\frac{\\left(\\frac{n_{Ar}}{\\alpha} \\bar{w}_{Ar} + n_{An} \\bar{w}_{An}\\right) - \\left(\\frac{n_{Br}}{\\alpha} \\bar{w}_{Br} + n_{Bn} \\bar{w}_{Bn}\\right)}{\\left(\\frac{n_{Ar}}{\\alpha} \\bar{w}_{Ar} + n_{An} \\bar{w}_{An}\\right) + \\left(\\frac{n_{Br}}{\\alpha} \\bar{w}_{Br} + n_{Bn} \\bar{w}_{Bn}\\right)}$$\n\n我们现在代入所提供的数值：\n$\\alpha = 1.2$, $n_{Ar} = 720$, $n_{An} = 480$, $n_{Br} = 360$, $n_{Bn} = 640$, $\\bar{w}_{Ar} = 0.6$, $\\bar{w}_{An} = 0.9$, $\\bar{w}_{Br} = 0.5$, $\\bar{w}_{Bn} = 0.85$.\n\n首先，计算总的校正后ABBA计数，$N'_{\\mathrm{ABBA}}$：\n$$N'_{\\mathrm{ABBA}} = \\frac{720}{1.2} \\cdot 0.6 + 480 \\cdot 0.9$$\n$$N'_{\\mathrm{ABBA}} = 600 \\cdot 0.6 + 480 \\cdot 0.9 = 360 + 432 = 792$$\n接下来，计算总的校正后BABA计数，$N'_{\\mathrm{BABA}}$：\n$$N'_{\\mathrm{BABA}} = \\frac{360}{1.2} \\cdot 0.5 + 640 \\cdot 0.85$$\n$$N'_{\\mathrm{BABA}} = 300 \\cdot 0.5 + 640 \\cdot 0.85 = 150 + 544 = 694$$\n\n现在，我们计算校正后估计量 $\\hat{D}_{\\mathrm{corr}}$ 的值：\n$$\\hat{D}_{\\mathrm{corr}} = \\frac{N'_{\\mathrm{ABBA}} - N'_{\\mathrm{BABA}}}{N'_{\\mathrm{ABBA}} + N'_{\\mathrm{BABA}}} = \\frac{792 - 694}{792 + 694}$$\n分子是 $792 - 694 = 98$。\n分母是 $792 + 694 = 1486$。\n$$\\hat{D}_{\\mathrm{corr}} = \\frac{98}{1486}$$\n为了以既约分数的形式提供答案，我们找到分子和分母的最大公约数。两者都可以被 $2$ 整除：\n$$\\frac{98}{1486} = \\frac{2 \\cdot 49}{2 \\cdot 743} = \\frac{49}{743}$$\n分子是 $49 = 7^2$。我们检查 $743$ 是否能被 $7$ 整除：$743 \\div 7 \\approx 106.14$。由于 $743$ 不是 $7$ 的倍数，因此分数 $\\frac{49}{743}$ 是最简形式。", "answer": "$$\\boxed{\\frac{49}{743}}$$", "id": "2691814"}]}