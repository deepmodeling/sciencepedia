{"hands_on_practices": [{"introduction": "病原体毒力的演化并非总是朝着更强的方向发展，其核心在于权衡假说。这个练习提供了一个亲手实践的机会，来形式化地分析这种权衡：高毒力引起的症状可能会降低宿主的接触率，从而限制传播。通过推导选择梯度（selection gradient），你将掌握一个预测病原体演化方向的基本工具[@problem_id:2710055]。", "problem": "考虑一个在封闭宿主种群中的急性、直接传播的病原体，时间尺度为短暂的疫情暴发（忽略宿主的出生和自然死亡）。病原体的毒力，用 $\\alpha$ 表示，会增加症状的严重程度，并导致卧床休息，从而将人均接触率降低为一个可微函数 $c(\\alpha)$，且满足 $c'(\\alpha)  0$。假设每次接触的传播概率为常数 $p$，且与 $\\alpha$ 无关。受感染的宿主以速率 $\\gamma$ 康复，并以速率 $\\alpha$ 因病死亡而被移除，因此总的人均移除率为 $\\gamma + \\alpha$。令 $S(t)$、$I(t)$ 和 $R(t)$ 分别表示易感、感染和康复宿主的数量，并令 $N = S(t) + I(t) + R(t)$ 为恒定的种群大小。假设在入侵时间尺度上为频率依赖（标准发生率）传播，因此感染力为 $\\lambda(t) = \\frac{c(\\alpha) p}{N} I(t)$。\n\n流行病动态由以下方程组给出：\n$$\n\\frac{dS}{dt} = - \\frac{c(\\alpha) p}{N} S I, \\quad\n\\frac{dI}{dt} = \\frac{c(\\alpha) p}{N} S I - (\\gamma + \\alpha) I, \\quad\n\\frac{dR}{dt} = \\gamma I.\n$$\n\n从基本再生数和在完全易感宿主种群中（即在 $S \\approx N$ 的无病状态下）的入侵适应度的定义出发，推导 $\\alpha$ 的选择梯度。该选择梯度定义为基本再生数的自然对数相对于 $\\alpha$ 的导数。你的推导必须明确显示症状引起的卧床休息如何通过 $c(\\alpha)$ 进入模型，以及移除如何通过 $\\gamma + \\alpha$ 发生。请以 $c(\\alpha)$、$c'(\\alpha)$、$\\gamma$ 和 $\\alpha$ 表示的单个闭式解析表达式 $g(\\alpha)$ 的形式给出你的最终结果。不要引入此处定义之外的任何额外参数。最终答案必须仅为 $g(\\alpha)$ 的表达式，不含任何文字或单位。", "solution": "该问题要求推导病原体毒力 $\\alpha$ 的选择梯度 $g(\\alpha)$。选择梯度定义为病原体入侵适应度的自然对数相对于性状 $\\alpha$ 的导数。在流行病入侵一个完全易感种群的短暂时间尺度上，合适的适应度度量是基本再生数 $R_0$。\n\n首先，我们必须推导基本再生数 $R_0(\\alpha)$ 作为毒力函数的表达式。$R_0$ 定义为单个感染个体被引入一个完全易感的种群后所产生的预期二次感染数。它等于每个感染个体的传播率与平均感染期的乘积。\n\n新感染的速率由项 $\\frac{c(\\alpha) p}{N} S I$ 给出。因此，每个感染个体产生的新感染速率为 $\\frac{c(\\alpha) p S}{N}$。在流行病开始时，种群被认为是完全易感的，所以我们取极限 $S \\to N$。在此极限下，每个感染个体的传播率变为 $\\frac{c(\\alpha) p N}{N} = c(\\alpha) p$。\n\n感染类的动态由 $\\frac{dI}{dt} = \\frac{c(\\alpha) p}{N} S I - (\\gamma + \\alpha) I$ 给出。项 $(\\gamma + \\alpha)I$ 表示个体从感染类中被移除的总速率，移除方式包括康复（速率为 $\\gamma$）或因病死亡（速率为 $\\alpha$）。因此，人均移除率为 $\\gamma + \\alpha$。平均感染期是该速率的倒数，即 $\\frac{1}{\\gamma + \\alpha}$。\n\n结合这些组成部分，基本再生数是传播率和感染期的乘积：\n$$\nR_0(\\alpha) = (c(\\alpha) p) \\times \\left(\\frac{1}{\\gamma + \\alpha}\\right) = \\frac{c(\\alpha) p}{\\gamma + \\alpha}\n$$\n这个表达式代表了病原体在入侵点的适应度。\n\n问题将选择梯度 $g(\\alpha)$ 定义为 $R_0(\\alpha)$ 的自然对数相对于 $\\alpha$ 的导数。\n$$\ng(\\alpha) \\equiv \\frac{d}{d\\alpha} \\ln(R_0(\\alpha))\n$$\n我们将 $R_0(\\alpha)$ 的表达式代入这个定义中。\n$$\ng(\\alpha) = \\frac{d}{d\\alpha} \\ln\\left(\\frac{c(\\alpha) p}{\\gamma + \\alpha}\\right)\n$$\n利用对数的性质，我们可以展开表达式以简化微分：\n$$\n\\ln\\left(\\frac{c(\\alpha) p}{\\gamma + \\alpha}\\right) = \\ln(c(\\alpha)) + \\ln(p) - \\ln(\\gamma + \\alpha)\n$$\n现在，我们对这个表达式逐项关于 $\\alpha$ 求导：\n$$\ng(\\alpha) = \\frac{d}{d\\alpha} \\left[ \\ln(c(\\alpha)) + \\ln(p) - \\ln(\\gamma + \\alpha) \\right]\n$$\n$$\ng(\\alpha) = \\frac{d}{d\\alpha}\\ln(c(\\alpha)) + \\frac{d}{d\\alpha}\\ln(p) - \\frac{d}{d\\alpha}\\ln(\\gamma + \\alpha)\n$$\n我们计算每个导数：\n1.  对于第一项，我们应用链式法则：$\\frac{d}{d\\alpha}\\ln(c(\\alpha)) = \\frac{1}{c(\\alpha)} \\cdot c'(\\alpha) = \\frac{c'(\\alpha)}{c(\\alpha)}$。\n2.  对于第二项，$p$ 是一个关于 $\\alpha$ 的常数，所以它的导数为零：$\\frac{d}{d\\alpha}\\ln(p) = 0$。\n3.  对于第三项，我们再次使用链式法则：$\\frac{d}{d\\alpha}\\ln(\\gamma + \\alpha) = \\frac{1}{\\gamma + \\alpha} \\cdot \\frac{d}{d\\alpha}(\\gamma + \\alpha) = \\frac{1}{\\gamma + \\alpha} \\cdot (0 + 1) = \\frac{1}{\\gamma + \\alpha}$。\n\n将这些结果代回 $g(\\alpha)$ 的表达式中：\n$$\ng(\\alpha) = \\frac{c'(\\alpha)}{c(\\alpha)} + 0 - \\frac{1}{\\gamma + \\alpha}\n$$\n这简化为选择梯度的最终闭式表达式：\n$$\ng(\\alpha) = \\frac{c'(\\alpha)}{c(\\alpha)} - \\frac{1}{\\gamma + \\alpha}\n$$\n这个表达式量化了对毒力的净选择压力。项 $\\frac{c'(\\alpha)}{c(\\alpha)}$ 表示通过毒力对接触率的影响产生的边际适应度变化，而项 $-\\frac{1}{\\gamma + \\alpha}$ 表示通过毒力对感染期持续时间的影响产生的边际适应度变化。推导完成。", "answer": "$$\n\\boxed{\\frac{c'(\\alpha)}{c(\\alpha)} - \\frac{1}{\\gamma + \\alpha}}\n$$", "id": "2710055"}, {"introduction": "公共卫生干预措施，如疫苗接种，会深刻地改变病原体的“选择地貌”（selective landscape）。这项实践将演化权衡框架应用于一个更复杂的现实场景中，即疫苗压力下的毒力演化。你将运用下一代矩阵（next-generation matrix）方法来量化一个疫苗逃逸突变株的入侵适应度，从而揭示疫苗接种为何可能无意中筛选出具有不同特征的病原体[@problem_id:2710061]。", "problem": "考虑一个易感-感染-移除 (SIR) 模型，该模型在一个大小归一化为1的均匀混合宿主种群中，以人均速率 $\\mu$ 考虑了人口动态。一种预防性疫苗以 $v \\in [0,1]$ 的覆盖率进行接种，使得比例为 $v$ 的宿主在出生时接种疫苗，并此后保持接种状态。疫苗接种通过改变已接种宿主中发生的感染的传播率和恢复率来影响感染动态。存在两种病原体毒株：一种是常驻的野生型，另一种是毒力更强的罕见突变株。对于被毒株 $i \\in \\{w,m\\}$ 感染的宿主，令 $\\beta_i$ 表示每次接触的传播率，$\\gamma_i$ 表示恢复率，$\\alpha_i$ 表示疾病引发的死亡率（毒力）。假设为均匀质量作用传播，且无共同感染或重叠感染。\n\n疫苗接种具有两个效力组成部分，它们对宿主内的传染性和清除率起乘性作用：\n- 在感染野生型的已接种宿主中，有效传播率减少一个因子 $(1 - \\epsilon_{\\beta})$，因此传播率为 $\\beta_w (1 - \\epsilon_{\\beta})$；恢复率增加一个因子 $(1 + \\epsilon_{\\gamma})$，因此恢复率为 $\\gamma_w (1 + \\epsilon_{\\gamma})$。\n- 突变株是一种具有部分逃逸能力的疫苗逃逸变种。在感染突变株的已接种宿主中，只有比例为 $r_{\\beta} \\in [0,1]$ 的传播阻断效应和比例为 $r_{\\gamma} \\in [0,1]$ 的恢复增强效应起作用。因此，传播率为 $\\beta_m \\bigl(1 - r_{\\beta} \\epsilon_{\\beta}\\bigr)$，恢复率为 $\\gamma_m \\bigl(1 + r_{\\gamma} \\epsilon_{\\gamma}\\bigr)$。\n\n假设人口动态处于平衡状态，因此在接种疫苗后的无病平衡点附近，未接种宿主中的易感者比例为 $S_u = 1 - v$，已接种宿主中的易感者比例为 $S_v = v$。假设对于每个感染个体，其接触在不同宿主类别之间是随机的。\n\n使用下一代矩阵框架（基本再生数等于下一代矩阵的谱半径），考虑按疫苗接种状态对突变株 $(I_m^u, I_m^v)$ 和野生型 $(I_w^u, I_w^v)$ 的感染仓室进行排序。在接种疫苗后的无病平衡点，完整的双毒株下一代矩阵是块对角的，其中一个 $2 \\times 2$ 的块对应突变株，另一个 $2 \\times 2$ 的块对应野生型。关注突变株块，并推导其 $2 \\times 2$ 下一代矩阵的主特征值，将其表示为 $v$, $\\beta_m$, $\\gamma_m$, $\\alpha_m$, $\\mu$, $\\epsilon_{\\beta}$, $\\epsilon_{\\gamma}$, $r_{\\beta}$ 和 $r_{\\gamma}$ 的函数。\n\n作为最终答案，报告此主特征值的精确解析表达式闭式解（突变株作为疫苗覆盖率函数的入侵再生数），该表达式应纯粹用上述参数表示。不要提供不等式，也不要进行近似或四舍五入。无需单位。", "solution": "该问题要求推导在一个疫苗接种计划下，突变病原体毒株入侵处于无病平衡（DFE）状态的种群时，其下一代矩阵的主特征值。这个特征值是突变株的入侵再生数 $R_{0,m}(v)$，是疫苗覆盖率 $v$ 的函数。\n\n根据问题描述，该系统由一个包含人口动态的SIR模型描述。种群按疫苗接种状态（未接种和已接种）和感染状态进行划分。我们关注用下标 $m$ 表示的突变株。突变株的感染仓室是 $I_m^u$（未接种感染者）和 $I_m^v$（已接种感染者）。感染动态的状态向量是 $x = (I_m^u, I_m^v)^T$。\n\n下一代矩阵方法要求将在DFE处的线性化系统动力学分解为一个新感染矩阵 $\\mathcal{F}$ 和一个转移矩阵 $\\mathcal{V}$。那么，下一代矩阵是 $K = \\mathcal{F} \\mathcal{V}^{-1}$。\n\n首先，我们构建新感染矩阵 $\\mathcal{F}$。元素 $\\mathcal{F}_{ij}$ 表示由仓室 $j$ 中的个体在仓室 $i$ 中产生新感染的速率。在DFE处，易感种群由比例为 $S_u = 1-v$ 的未接种个体和比例为 $S_v = v$ 的已接种个体组成。\n来自未接种感染个体 ($I_m^u$) 的人均传播率为 $\\beta_m$。来自已接种感染个体 ($I_m^v$) 的人均传播率为 $\\beta_m(1 - r_{\\beta}\\epsilon_{\\beta})$。假设在一个大小为1的种群中均匀混合，来自突变株的总感染力为 $\\lambda_m = \\beta_m I_m^u + \\beta_m(1 - r_{\\beta}\\epsilon_{\\beta}) I_m^v$。\n\n未接种类别 $I_m^u$ 中的新感染产生于感染个体与未接种易感者 $S_u$ 之间的接触。其速率为 $\\lambda_m S_u = (\\beta_m I_m^u + \\beta_m(1 - r_{\\beta}\\epsilon_{\\beta}) I_m^v)(1-v)$。\n已接种类别 $I_m^v$ 中的新感染产生于与已接种易感者 $S_v$ 的接触。其速率为 $\\lambda_m S_v = (\\beta_m I_m^u + \\beta_m(1 - r_{\\beta}\\epsilon_{\\beta}) I_m^v)v$。\n根据这些速率，我们可以将矩阵 $\\mathcal{F}$ 写为：\n$$\n\\mathcal{F} = \\begin{pmatrix}\n\\beta_m (1-v)  \\beta_m (1 - r_{\\beta}\\epsilon_{\\beta})(1-v) \\\\\n\\beta_m v  \\beta_m (1 - r_{\\beta}\\epsilon_{\\beta})v\n\\end{pmatrix}\n$$\n\n接下来，我们构建转移矩阵 $\\mathcal{V}$。元素 $\\mathcal{V}_{ij}$ 表示个体通过非感染途径从仓室 $j$ 转移到仓室 $i$ 的速率。对于一个简单的SIR类型模型，该矩阵是对角的，其中 $\\mathcal{V}_{ii}$ 是离开感染仓室 $i$ 的总速率。\n对于一个未接种的感染个体 ($I_m^u$)，离开该仓室的总速率是自然死亡率 $\\mu$、疾病引发的死亡率 $\\alpha_m$ 和恢复率 $\\gamma_m$ 的总和。因此，离开速率为 $\\mu + \\alpha_m + \\gamma_m$。\n对于一个已接种的感染个体 ($I_m^v$)，恢复率被修改为 $\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma})$。问题没有指明毒力有任何变化，因此 $\\alpha_m$ 保持不变。总离开速率为 $\\mu + \\alpha_m + \\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma})$。\n因此，矩阵 $\\mathcal{V}$ 为：\n$$\n\\mathcal{V} = \\begin{pmatrix}\n\\gamma_m + \\alpha_m + \\mu  0 \\\\\n0  \\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu\n\\end{pmatrix}\n$$\n\n下一代矩阵为 $K = \\mathcal{F}\\mathcal{V}^{-1}$。首先，我们求 $\\mathcal{V}^{-1}$：\n$$\n\\mathcal{V}^{-1} = \\begin{pmatrix}\n\\frac{1}{\\gamma_m + \\alpha_m + \\mu}  0 \\\\\n0  \\frac{1}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu}\n\\end{pmatrix}\n$$\n现在，我们计算 $K$：\n$$\nK = \\begin{pmatrix}\n\\beta_m (1-v)  \\beta_m (1 - r_{\\beta}\\epsilon_{\\beta})(1-v) \\\\\n\\beta_m v  \\beta_m (1 - r_{\\beta}\\epsilon_{\\beta})v\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{\\gamma_m + \\alpha_m + \\mu}  0 \\\\\n0  \\frac{1}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu}\n\\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix}\n\\frac{\\beta_m (1-v)}{\\gamma_m + \\alpha_m + \\mu}  \\frac{\\beta_m (1 - r_{\\beta}\\epsilon_{\\beta})(1-v)}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu} \\\\\n\\frac{\\beta_m v}{\\gamma_m + \\alpha_m + \\mu}  \\frac{\\beta_m v (1 - r_{\\beta}\\epsilon_{\\beta})}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu}\n\\end{pmatrix}\n$$\n$K$ 的主特征值是其谱半径 $\\rho(K)$。对于一个 $2 \\times 2$ 矩阵 $M = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，特征值 $\\lambda$ 是特征方程 $\\lambda^2 - \\text{tr}(M)\\lambda + \\det(M) = 0$ 的解。\n$K$ 的迹是 $\\text{tr}(K) = K_{11} + K_{22}$。$K$ 的行列式是 $\\det(K) = K_{11}K_{22} - K_{12}K_{21}$。\n让我们计算行列式：\n$$\nK_{11}K_{22} = \\left( \\frac{\\beta_m (1-v)}{\\gamma_m + \\alpha_m + \\mu} \\right) \\left( \\frac{\\beta_m v (1 - r_{\\beta}\\epsilon_{\\beta})}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu} \\right)\n$$\n$$\nK_{12}K_{21} = \\left( \\frac{\\beta_m (1 - r_{\\beta}\\epsilon_{\\beta})(1-v)}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu} \\right) \\left( \\frac{\\beta_m v}{\\gamma_m + \\alpha_m + \\mu} \\right)\n$$\n我们观察到 $K_{11}K_{22} = K_{12}K_{21}$，这意味着 $\\det(K)=0$。这是新感染矩阵 $\\mathcal{F}$ 的秩为1结构的结果。\n特征方程简化为 $\\lambda^2 - \\text{tr}(K)\\lambda = 0$，其特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\text{tr}(K)$。\n由于所有参数都是非负的，$K$ 的元素是非负的，其迹也是非负的。因此，主特征值为 $\\lambda_2 = \\text{tr}(K)$。\n$$\n\\rho(K) = K_{11} + K_{22} = \\frac{\\beta_m (1-v)}{\\gamma_m + \\alpha_m + \\mu} + \\frac{\\beta_m v (1 - r_{\\beta}\\epsilon_{\\beta})}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu}\n$$\n该表达式是突变株的入侵再生数。它是未接种亚群（第一项）和已接种亚群（第二项）中发生的感染所产生的再生贡献的总和，并按这些亚群在DFE处的各自比例加权。", "answer": "$$\n\\boxed{\\frac{\\beta_m(1-v)}{\\gamma_m + \\alpha_m + \\mu} + \\frac{\\beta_m v (1 - r_{\\beta}\\epsilon_{\\beta})}{\\gamma_m(1 + r_{\\gamma}\\epsilon_{\\gamma}) + \\alpha_m + \\mu}}\n$$", "id": "2710061"}, {"introduction": "本章的最后一个练习将从预测演化转向主动引导演化，这是一个前瞻性的计算挑战。该问题利用适应性动力学（adaptive dynamics）模型，模拟如何通过一次定时的干预措施，将病原体从一个高毒力的演化结局引导至一个低毒力的良性状态。这个强大的练习展示了理论模型如何为设计新颖的“演化鲁棒”或“演化感知”干预策略提供信息[@problem_id:2710106]。", "problem": "考虑一个病原体在大型宿主种群中演化其毒力性状 $ \\alpha \\in \\mathbb{R}_{\\ge 0} $，在生态动力学相对于演化变化能快速达到平衡的标准时间尺度分离假设下。在适应性动力学（Adaptive Dynamics, AD）中，典范方程假设性状动力学遵循入侵适应度 $ W(\\alpha; p) $ 相对于 $ \\alpha $ 的梯度上升，并由一个吸收了突变率、突变方差和种群大小的正常数 $ \\kappa $ 进行缩放。具体来说，假设演化动力学由以下公式给出\n$$\n\\frac{d \\alpha}{dt} \\;=\\; \\kappa \\, g(\\alpha; p(t)), \\quad \\text{其中 } g(\\alpha; p) \\equiv \\frac{\\partial W(\\alpha; p)}{\\partial \\alpha}.\n$$\n假设入侵适应度 $ W(\\alpha; p) $ 由基本再生数的对数近似，\n$$\nW(\\alpha; p) \\;=\\; \\ln R_0(\\alpha; p) \\;=\\; \\ln \\beta(\\alpha; p) \\;-\\; \\ln(\\alpha + \\gamma + d),\n$$\n其中恢复率 $ \\gamma  0 $ 和背景死亡率 $ d \\ge 0 $ 均为常数。传播率 $ \\beta(\\alpha; p) $ 反映了两种传播途径，它们对毒力的依赖性相反：一种是社区接触途径，由于宿主移动性降低，该途径随毒力增加而下降；另一种是照护者接触途径，由于症状驱动的接触强度更高，该途径随毒力增加而上升。设\n$$\n\\beta(\\alpha; p) \\;=\\; \\beta_c \\, (1-p) \\, v(\\alpha)\\, m(\\alpha) \\;+\\; \\beta_h \\, p \\, v(\\alpha)\\, h(\\alpha),\n$$\n其中 $ p \\in [0,1] $ 是一个可控的环境参数（例如，由干预措施调节的、在照护者环境中发生的接触比例），$ \\beta_c  0 $ 和 $ \\beta_h  0 $ 是特定途径的系数，宿主体内和接触函数为\n$$\nv(\\alpha) \\;=\\; \\frac{\\alpha}{\\alpha + K}, \\quad\nm(\\alpha) \\;=\\; \\frac{1}{1 + \\alpha/M}, \\quad\nh(\\alpha) \\;=\\; \\frac{\\alpha}{\\alpha + H},\n$$\n其中 $ K0 $，$ M0 $，$ H0 $。组合 $ v(\\alpha) m(\\alpha) $ 产生一个峰形的社区接触贡献，而 $ v(\\alpha) h(\\alpha) $ 产生一个递增至饱和的照护者接触贡献。\n\n干预措施通过 $ p(t) $ 的时间变化来建模，使用单个矩形脉冲：\n$$\np(t) \\;=\\; \\begin{cases}\np_{\\mathrm{hi}},  0 \\le t  T,\\\\\np_{\\mathrm{lo}},  t \\ge T,\n\\end{cases}\n$$\n其中 $ p_{\\mathrm{lo}} $ 是基线环境，$ p_{\\mathrm{hi}} $ 是干预设置。目标是利用脉冲期间的瞬时选择，将系统在基线 $ p_{\\mathrm{lo}} $ 下从一个高毒力吸引盆推向一个低毒力吸引盆。\n\n在固定 $ p $ 值下的演化稳定状态（ESS）满足 $ g(\\alpha^*; p) = 0 $。在上述梯度流下的稳定性由 $ \\partial g/\\partial \\alpha $ 的符号决定：如果 $ \\partial g/\\partial \\alpha  0 $，则根是局部吸引的（稳定的）；如果 $ \\partial g/\\partial \\alpha  0 $，则是排斥的（不稳定的）。在某些参数体系下，基线 $ p_{\\mathrm{lo}} $ 存在双稳态，即有两个稳定的ESS（一个低毒力 $ \\alpha_{\\mathrm{L}} $ 和一个高毒力 $ \\alpha_{\\mathrm{H}} $），由一个不稳定的平衡点 $ \\alpha_{\\mathrm{U}} $ 分隔。从高毒力盆中的初始性状 $ \\alpha(0)=\\alpha_0 $（$ \\alpha_0  \\alpha_{\\mathrm{U}} $）开始，在 $ p_{\\mathrm{hi}} $ 下施加一个足够长的脉冲 $ T $，可以将 $ \\alpha(t) $ 移动到 $ \\alpha_{\\mathrm{U}} $ 以下，之后基线动力学将驱动 $ \\alpha(t) $ 趋向 $ \\alpha_{\\mathrm{L}} $。\n\n你的任务是：\n- 实现性状动力学 $ d\\alpha/dt = \\kappa \\, g(\\alpha; p(t)) $，其中 $ g(\\alpha;p) = \\partial W/\\partial \\alpha $ 且 $ W(\\alpha;p) = \\ln \\beta(\\alpha;p) - \\ln(\\alpha+\\gamma+d) $，使用可靠的数值微分计算 $ g $，并使用定步长显式 Runge–Kutta 积分器进行时间步进。\n- 给定基线 $ p_{\\mathrm{lo}} $，通过扫描 $ \\alpha \\in [\\alpha_{\\min}, \\alpha_{\\max}] $ 来计算所有ESS，检查 $ g(\\alpha; p_{\\mathrm{lo}}) $ 的符号变化，并通过稳健的区间法定位根。通过数值估计 $ \\partial g/\\partial \\alpha $ 来对每个根的稳定性进行分类。\n- 如果基线是双稳态的，有三个ESS（低稳定、中不稳定、高稳定），则将盆地分离阈值定义为不稳定的平衡点 $ \\alpha_{\\mathrm{U}} $。否则，定义一个目标阈值 $ \\alpha_{\\mathrm{goal}} $（每个测试用例提供），它代表一个实际的低毒力目标。在双稳态情况下，如果干预后轨迹以 $ \\alpha_{\\text{end}}  \\alpha_{\\mathrm{U}} $ 结束（等效于在低毒力盆内），则视为成功；在单稳态情况下，如果 $ \\alpha_{\\text{end}} \\le \\alpha_{\\mathrm{goal}} $，则视为成功。\n- 通过计算能达到成功的最小脉冲持续时间 $ T^{\\star} \\in [0, T_{\\max}] $（如果存在）来设计一个方案。使用二分法在指定的容差内对 $ T $ 进行搜索，如果在 $ [0, T_{\\max}] $ 内无法成功，则报告失败为 $ -1.0 $。\n- 对于每个测试的 $ T $，从 $ t=0 $ 到 $ t = T + T_{\\mathrm{relax}} $ 积分动力学，其中 $ T_{\\mathrm{relax}} $ 是在基线 $ p_{\\mathrm{lo}} $ 下足够长的松弛时间，以接近脉冲后的吸引盆。使用固定步长 $ \\Delta t $ 进行数值积分，并通过反射或钳位处理下界 $ \\alpha_{\\min} $，以避免非物理的负值。\n\n在所有测试中使用以下固定的模型参数：\n- $ \\beta_c = 3.0 $, $ \\beta_h = 9.0 $,\n- $ K = 0.2 $, $ M = 0.5 $, $ H = 0.1 $,\n- $ \\gamma = 0.3 $, $ d = 0.0 $,\n- $ \\kappa $ 根据测试用例指定，\n- $ \\alpha_{\\min} = 10^{-6} $, $ \\alpha_{\\max} = 5.0 $,\n- 数值微分步长 $ \\varepsilon = 10^{-6} $,\n- 时间步长 $ \\Delta t = 0.05 $, 松弛时间 $ T_{\\mathrm{relax}} = 800.0 $,\n- 根扫描分辨率 $ N_{\\alpha} = 1000 $。\n\n要求的输出：\n- 对于每个测试用例，返回区间 $ [0, T_{\\max}] $ 内的浮点数最小脉冲持续时间 $ T^{\\star} $，通过标准字符串格式化进行四舍五入（无明确的四舍五入约束），如果无法实现，则返回 $ -1.0 $。\n\n测试套件（每个测试用例是一个指定 $ (\\alpha_0, p_{\\mathrm{lo}}, p_{\\mathrm{hi}}, \\kappa, T_{\\max}, \\alpha_{\\mathrm{goal}}) $ 的元组）：\n- 案例 1（理想路径双稳态，强干预）：$ (1.5, 0.25, 0.85, 0.04, 500.0, 0.5) $。\n- 案例 2（干预幅度不足）：$ (1.5, 0.25, 0.50, 0.04, 500.0, 0.5) $。\n- 案例 3（接近阈值的初始条件）：$ (0.6, 0.25, 0.85, 0.04, 500.0, 0.5) $。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含三个案例的结果，格式为逗号分隔的列表，并用方括号括起来（例如，\"[result1,result2,result3]\"）。\n- 所有输出必须是实数（浮点数），使用十进制表示法。\n\n注意：不需要物理单位；所有量都是无量纲的或采用任意一致的单位。不使用角度。如果存在百分比，必须如前所述，以 $ [0,1] $ 区间内的小数表示。", "solution": "所提出的问题是演化建模中一个适定且有科学依据的练习。它要求在特定的干预情景下，分析病原体的毒力演化。任务是确定所需的最小干预持续时间，以将演化轨迹从一个不受欢迎的高毒力平衡态引导到一个更良性的低毒力状态。该问题是有效的，将基于适应性动力学和数值分析的原理构建一个解决方案。\n\n分析分几个阶段进行：\n1.  演化动力学的公式化。\n2.  演化稳定状态（ESS）的识别和稳定性分析。\n3.  脉冲干预下性状轨迹的数值模拟。\n4.  干预持续时间的优化。\n\n毒力性状（记为 $\\alpha \\in \\mathbb{R}_{\\ge 0}$）的演化动力学由适应性动力学的典范方程控制：\n$$\n\\frac{d \\alpha}{dt} = \\kappa \\, g(\\alpha; p(t))\n$$\n其中 $\\kappa$ 是一个代表演化速度的正常数，而 $g(\\alpha; p)$ 是选择梯度。此梯度是入侵适应度 $W(\\alpha; p)$ 相对于性状 $\\alpha$ 的偏导数：\n$$\ng(\\alpha; p) \\equiv \\frac{\\partial W(\\alpha; p)}{\\partial \\alpha}\n$$\n入侵适应度定义为基本再生数 $R_0(\\alpha; p)$ 的自然对数：\n$$\nW(\\alpha; p) = \\ln R_0(\\alpha; p) = \\ln \\beta(\\alpha; p) - \\ln(\\alpha + \\gamma + d)\n$$\n在这里，$\\beta(\\alpha; p)$ 是依赖于毒力和环境的传播率，$\\gamma$ 是宿主恢复率，$d$ 是背景死亡率。环境由一个控制参数 $p(t)$ 调节。\n\n传播率 $\\beta(\\alpha; p)$ 是两个部分的加权和：一个社区接触途径和一个照护者接触途径。\n$$\n\\beta(\\alpha; p) = \\beta_c \\, (1-p) \\, v(\\alpha)\\, m(\\alpha) + \\beta_h \\, p \\, v(\\alpha)\\, h(\\alpha)\n$$\n各组成函数定义如下：\n$$\nv(\\alpha) = \\frac{\\alpha}{\\alpha + K}, \\quad m(\\alpha) = \\frac{1}{1 + \\alpha/M}, \\quad h(\\alpha) = \\frac{\\alpha}{\\alpha + H}\n$$\n这些形式为社区传播建立了对毒力的峰形依赖关系，并为与照护者相关的传播建立了递增至饱和的依赖关系。参数 $p$ 在这两种选择机制之间转换选择压力。\n\n演化稳定状态（ESS）$\\alpha^*$ 是一个选择梯度为零的性状值，即 $g(\\alpha^*; p) = 0$。ESS 的局部稳定性由适应度函数的二阶导数符号决定，等效于 $\\frac{\\partial g}{\\partial \\alpha}$ 在 $\\alpha^*$ 处的符号：\n-   如果 $\\frac{\\partial g}{\\partial \\alpha}(\\alpha^*)  0$，该 ESS 是局部稳定的（一个演化吸引子）。\n-   如果 $\\frac{\\partial g}{\\partial \\alpha}(\\alpha^*) > 0$，该 ESS 是不稳定的（一个演化排斥子）。\n\n对于某些参数值，系统在基线环境 $p_{\\mathrm{lo}}$ 下可以表现出双稳态，意味着存在两个稳定的ESS，$\\alpha_{\\mathrm{L}}$（低毒力）和 $\\alpha_{\\mathrm{H}}$（高毒力），由一个不稳定的ESS $\\alpha_{\\mathrm{U}}$ 分隔。干预策略包括施加一个持续时间为 $T$ 的不同环境 $p_{\\mathrm{hi}}$ 的临时脉冲。\n$$\np(t) = \\begin{cases}\np_{\\mathrm{hi}},  0 \\le t  T, \\\\\np_{\\mathrm{lo}},  t \\ge T.\n\\end{cases}\n$$\n目标是找到最小的脉冲持续时间 $T^{\\star}$，该时间足以将性状值 $\\alpha(t)$ 从 $\\alpha_{\\mathrm{H}}$ 的吸引盆（其中 $\\alpha(0) = \\alpha_0 > \\alpha_{\\mathrm{U}}$）推入 $\\alpha_{\\mathrm{L}}$ 的吸引盆。如果在一段长的松弛期结束时，性状值 $\\alpha_{\\mathrm{end}} = \\alpha(T + T_{\\mathrm{relax}})$ 处于低毒力盆中，则视为成功。在双稳态系统中，这意味着 $\\alpha_{\\mathrm{end}}  \\alpha_{\\mathrm{U}}$。如果系统是单稳态的，则成功定义为 $\\alpha_{\\mathrm{end}} \\le \\alpha_{\\mathrm{goal}}$。\n\n实施计划如下：\n\n首先，对于一个给定的具有基线环境 $p_{\\mathrm{lo}}$ 的测试用例，我们必须描绘其演化景观。这通过在 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 范围内数值定位所有的ESS来完成。我们在一个精细的 $\\alpha$ 值网格上计算选择梯度 $g(\\alpha; p_{\\mathrm{lo}})$。通过识别符号变化来定位 $g$ 的根，然后使用稳健的数值求根算法（如Brent方法）来精确化位置。然后通过数值评估 $\\frac{\\partial g}{\\partial \\alpha}$ 在 $\\alpha^*$ 处的符号来确定每个根 $\\alpha^*$ 的稳定性。此分析揭示了系统是否是双稳态的，并识别出分隔吸引盆的不稳定平衡点 $\\alpha_{\\mathrm{U}}$。\n\n其次，我们必须模拟系统在给定脉冲持续时间 $T$ 下的轨迹。$\\alpha(t)$ 的微分方程将进行数值积分。定步长的四阶Runge-Kutta（RK4）方法是一个合适且标准的选择。积分从 $t=0$ 进行到 $t = T + T_{\\mathrm{relax}}$。对于 $t \\in [0, T)$，参数为 $p = p_{\\mathrm{hi}}$；对于 $t \\in [T, T + T_{\\mathrm{relax}}]$，它恢复为 $p = p_{\\mathrm{lo}}$。RK4积分器每一步所需的梯度选择 $g(\\alpha; p)$ 将使用一个中心有限差分近似，以小步长 $\\varepsilon$ 来计算 $W(\\alpha; p)$ 的导数。在积分过程中，性状值通过钳位被限制在不小于 $\\alpha_{\\min}$。\n\n第三，为了找到最小的成功脉冲持续时间 $T^{\\star}$，我们在区间 $[0, T_{\\max}]$ 上采用二分法搜索。定义一个函数 `check_success(T)`，它对持续时间为 $T$ 的脉冲执行完整模拟，并在最终状态 $\\alpha_{\\mathrm{end}}$ 满足成功标准时返回true。二分算法过程如下：\n1. 初始化搜索边界：$T_{\\mathrm{low}} = 0$, $T_{\\mathrm{high}} = T_{\\max}$。\n2. 首先，检查平凡失败：如果 `check_success(T_max)` 为false，则在给定范围内不存在解，此时 $T^{\\star} = -1.0$。\n3. 然后，检查平凡成功：如果 `check_success(0)` 为true，则不需要干预，此时 $T^{\\star} = 0.0$。\n4. 否则，迭代足够多的次数（例如100次）以达到高精度：\n    a. 设置 $T_{\\mathrm{mid}} = (T_{\\mathrm{low}} + T_{\\mathrm{high}}) / 2$。\n    b. 如果 `check_success(T_mid)` 为true，则可能更短的脉冲也有效，因此我们更新 $T_{\\mathrm{high}} = T_{\\mathrm{mid}}$。\n    c. 如果 `check_success(T_mid)` 为false，则需要更长的脉冲，因此我们更新 $T_{\\mathrm{low}} = T_{\\mathrm{mid}}$。\n最终的 $T_{\\mathrm{high}}$ 值为所需最小持续时间 $T^{\\star}$ 提供了一个紧密的上界。此过程将应用于每个测试用例，以生成所需的输出。", "answer": "[130.6396484,-1.0000000,16.9677734]", "id": "2710106"}]}