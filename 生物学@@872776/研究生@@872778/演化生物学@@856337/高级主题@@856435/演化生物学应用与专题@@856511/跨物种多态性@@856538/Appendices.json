{"hands_on_practices": [{"introduction": "跨物种多态性的一个核心特征是共享等位基因的共同祖先早于物种的分化。本练习提供了一个量化该信号的基本方法，即利用分子钟原理从序列分歧度估算等位基因的共祖时间，并将其与物种分化时间进行比较。通过这个计算[@problem_id:2759487]，你将掌握检验跨物种多态性候选基因的第一步。", "problem": "两个姐妹种 $\\mathrm{S_1}$ 和 $\\mathrm{S_2}$ 在 $T_{\\mathrm{spec}} = 2.5 \\times 10^{6}$ 年前发生分化。在一个推定经历了平衡选择的单一非重组位点上，从这两个物种中采样的单倍型形成了两个物种间共享的深远等位基因支系。设代表这两个等位基因支系的共有单倍型之间观测到的原始分化度为 $d = 0.015$ 个差异/位点（即，支系代表之间存在差异的核苷酸位点比例）。假设每个位点每代的突变率为 $\\mu = 1.2 \\times 10^{-8}$，核苷酸替换适用 Jukes–Cantor 模型，且世代时间为 $g = 6$ 年/代。\n\n从带有 Jukes–Cantor 模型一致的点突变和有限位点校正的中性溯祖理论的基本原理出发，根据观测到的 $d$ 估计以年为单位的等位基因到最近共同祖先的时间（最近共同祖先时间（TMRCA）），然后通过计算比率将其与物种分化时间进行比较：\n$$\nR \\equiv \\frac{T_{\\mathrm{allele}}}{T_{\\mathrm{spec}}}.\n$$\n若 $R > 1$，则该结果与跨物种多态性一致。\n\n$R$ 的数值是多少？将你的最终答案表示为一个纯数（无单位），并四舍五入到四位有效数字。", "solution": "问题要求计算比率 $R \\equiv \\frac{T_{\\mathrm{allele}}}{T_{\\mathrm{spec}}}$，其中 $T_{\\mathrm{allele}}$ 是两个等位基因支系到最近共同祖先的时间（TMRCA），而 $T_{\\mathrm{spec}}$ 是物种分化时间。这是分子进化中用于检验跨物种多态性的一个标准程序。\n\n首先，有必要对问题陈述进行验证。\n提供的已知条件如下：\n物种分化时间，$T_{\\mathrm{spec}} = 2.5 \\times 10^{6}$ 年。\n观测到的原始分化度（差异位点比例），$d = 0.015$。\n每个位点每代的突变率，$\\mu = 1.2 \\times 10^{-8}$。\n世代时间，$g = 6$ 年。\n问题采用 Jukes–Cantor 模型进行替换校正。\n该问题具有科学依据，提法恰当且客观。它提供了所有必要的参数，并使用了进化遗传学中已建立的模型。这些数值在物理上和生物学上都是合理的。因此，该问题是有效的，我们可以继续进行求解。\n\n第一步是将观测到的原始分化度 $d$ 转换为每个位点的预期替换数 $K$ 的估计值。原始分化度 $d$ 低估了真实的遗传距离，因为在同一核苷酸位点上发生的多次替换事件无法被直接观测到。Jukes–Cantor 模型为这些多次命中提供了校正。公式为：\n$$K = -\\frac{3}{4} \\ln \\left(1 - \\frac{4}{3}d\\right)$$\n代入给定值 $d = 0.015$：\n$$K = -\\frac{3}{4} \\ln \\left(1 - \\frac{4}{3}(0.015)\\right) = -\\frac{3}{4} \\ln (1 - 0.02) = -\\frac{3}{4} \\ln (0.98)$$\n\n第二步是将这个遗传距离 $K$ 与分化时间联系起来。根据分子钟假说，两个同源序列之间每个位点的预期替换数由 $K = 2 \\mu t$ 给出，其中 $\\mu$ 是每个位点每代的突变率，而 $t$ 是自最近共同祖先以来的世代数。因子 2 是因为突变在从祖先分化出来的两个谱系上独立积累。在本例中，$t$ 对应于以世代为单位的等位基因 TMRCA，我们将其记为 $t_{\\mathrm{allele}}$。\n$$K = 2 \\mu t_{\\mathrm{allele}}$$\n我们可以解出 $t_{\\mathrm{allele}}$：\n$$t_{\\mathrm{allele}} = \\frac{K}{2\\mu}$$\n问题要求以年为单位的时间 $T_{\\mathrm{allele}}$。这可以通过将世代数乘以世代时间 $g$ 得到：\n$$T_{\\mathrm{allele}} = t_{\\mathrm{allele}} \\cdot g = \\frac{Kg}{2\\mu}$$\n\n现在，我们将从 Jukes-Cantor 模型导出的 $K$ 的表达式代入 $T_{\\mathrm{allele}}$ 的方程中：\n$$T_{\\mathrm{allele}} = \\frac{\\left(-\\frac{3}{4} \\ln(0.98)\\right) g}{2\\mu}$$\n代入 $g$ 和 $\\mu$ 的给定数值：\n$$T_{\\mathrm{allele}} = \\frac{-\\frac{3}{4} \\ln(0.98) \\cdot 6}{2 \\cdot (1.2 \\times 10^{-8})} = \\frac{-4.5 \\ln(0.98)}{2.4 \\times 10^{-8}}$$\n\n最后一步是计算所要求的比率 $R$：\n$$R = \\frac{T_{\\mathrm{allele}}}{T_{\\mathrm{spec}}}$$\n代入 $T_{\\mathrm{allele}}$ 的表达式和 $T_{\\mathrm{spec}} = 2.5 \\times 10^{6}$ 的给定值：\n$$R = \\frac{\\frac{-4.5 \\ln(0.98)}{2.4 \\times 10^{-8}}}{2.5 \\times 10^{6}} = \\frac{-4.5 \\ln(0.98)}{(2.4 \\times 10^{-8}) \\cdot (2.5 \\times 10^{6})}$$\n我们化简分母：\n$$(2.4 \\times 10^{-8}) \\cdot (2.5 \\times 10^{6}) = (2.4 \\cdot 2.5) \\times 10^{-8+6} = 6.0 \\times 10^{-2} = 0.06$$\n因此，$R$ 的表达式为：\n$$R = \\frac{-4.5 \\ln(0.98)}{0.06}$$\n现在，我们计算其数值。\n$0.98$ 的自然对数约为 $\\ln(0.98) \\approx -0.0202027$。\n$$R \\approx \\frac{-4.5 \\times (-0.0202027)}{0.06} \\approx \\frac{0.09091215}{0.06} \\approx 1.5152025$$\n根据问题陈述的要求，将结果四舍五入到四位有效数字，我们得到：\n$$R \\approx 1.515$$\n这个值大于 1，表明等位基因的估计分化时间早于物种的分化时间，这与这些等位基因是跨物种多态性的情况一致。", "answer": "$$\\boxed{1.515}$$", "id": "2759487"}, {"introduction": "仅仅估算等位基因年龄可能具有误导性，因为物种形成后的基因渗入也能造成跨物种的等位基因共享。因此，严谨的结论需要区分这两种过程。这个练习[@problem_id:2759485]挑战你综合运用多种基因组学证据——如D统计量、基因树拓扑结构和共祖时间——来制定一个决策规则，从而在跨物种多态性和基因渗入之间做出判断。", "problem": "建立了一个四分类单元检验，以研究在两个姐妹物种中观察到的共享功能性等位基因是反映了跨物种多态性（在物种形成事件中得以维持的古老平衡多态性）还是基因渗入（物种形成后的基因流）。这些分类单元的排列如下：拥有共享等位基因的物种是 $P_1$ 和 $P_2$，一个亲缘关系较远的物种是 $P_3$，外群是 $O$。在围绕焦点位点的基因组区域收集了独立的证据线索：\n\n1. 全基因组背景：滑动窗口检验得出 $D(P_1,P_2,P_3,O)$ 的均值约为 $0$，且在大多数窗口中 $|Z|  1.5$；$f_4$比率估计的 $P_1$ 和 $P_2$ 之间的混合接近 $0$，且置信区间很窄。\n\n2. 焦点位点附近的局部信号：在以焦点多态性为中心的 $2$ 千碱基窗口内，有 $n = 35$ 个信息位点，估计的 $D \\approx 0.06$，标准误约为 $0.07$（$Z \\approx 0.86$）。在两侧紧邻的 $50$ 千碱基窗口中，$D \\approx 0.00 \\pm 0.01$，且 $f_4$比率混合估计值 $\\hat{\\alpha} \\approx 0.00$，其 $95\\%$ 置信区间大约为 $[-0.02, 0.02]$。\n\n3. 基因树拓扑结构：在包含焦点多态性的 $500$ 碱基对片段中，单倍型按跨物种的等位基因状态聚类（所有携带等位基因 $A$ 的 $P_1$ 和 $P_2$ 单倍型聚在一起，所有携带等位基因 $B$ 的 $P_1$ 和 $P_2$ 单倍型聚在一起）。在相邻的 $10$ 千碱基侧翼区域，谱系与物种树匹配，$P_1$ 是单系的，$P_2$ 也是单系的。\n\n4. 时间和单倍型长度证据：在焦点位点，两个长寿的等位基因支系到最近共同祖先的时间估计为 $T_{\\text{MRCA}} \\approx 3.2$ 百万年，其 $95\\%$ 置信区间为 $[2.5, 3.9]$ 百万年，而 $P_1$–$P_2$ 的物种分化时间可追溯到 $T_S \\approx 1.1$ 百万年，其 $95\\%$ 置信区间为 $[0.9, 1.3]$ 百万年。在焦点区域，携带相同等位基因的 $P_1$ 和 $P_2$ 个体之间共享的平均同源状态（identical-by-state）片段很短（约 $0.3$ 千碱基），没有延长的共享单倍型。\n\n从第一性原理出发，构建一个决策规则，该规则结合使用位点模式统计量（例如 $D$统计量或 $f_4$比率）和基因树拓扑结构，以便在这些数据下，为共享等位基因拒绝基因渗入假说，支持跨物种多态性假说。以下哪个选项最严谨地描述了这样一条规则？\n\nA. 如果在焦点位点侧翼的重组界定窗口中，检验 $P_1$–$P_2$ 基因流的 $D$ 和 $f_4$比率估计值与 $0$ 没有显著差异，焦点位点的谱系按跨物种的等位基因状态将单倍型分组，而相邻的侧翼区域恢复了物种树，并且等位基因支系的 $T_{\\text{MRCA}}$ 超过了 $T_S$，则拒绝基因渗入，支持跨物种多态性。在这些共同条件下，推断为古老的平衡多态性而非基因渗入。\n\nB. 每当跨越焦点位点的任何窗口得出非零的 $D$ 值时，无论其符号、大小或统计显著性如何，都拒绝基因渗入，支持跨物种多态性，因为任何偏离 $0$ 的情况都与无基因流的原假设不相容。\n\nC. 每当焦点位点的局部基因树混合了 $P_1$ 和 $P_2$ 的单倍型时，即使侧翼的 $D$ 值显著非零，也拒绝基因渗入，支持跨物种多态性，因为一个支系内物种的混合必然反映了祖先多态性。\n\nD. 仅当 $D$ 在焦点位点的两侧显著非零且符号相反时，才拒绝基因渗入，支持跨物种多态性，因为侧翼区域 $D$ 值的符号翻转表明不完全谱系分选无法解释该数据。\n\nE. 当 $P_1$ 和 $P_2$ 之间的 $f_4$比率混合估计值 $\\hat{\\alpha}$ 特别是在焦点窗口内显著大于 $0$ 时，拒绝基因渗入，支持跨物种多态性，理由是焦点区域的过度共享必定反映了古老的多态性而非近期的基因流。", "solution": "首先必须验证问题陈述的科学连贯性和逻辑一致性。\n\n**第一步：提取已知信息**\n\n该问题提供了关于一个四分类单元系统（物种 $P_1$、$P_2$、$P_3$ 和外群 $O$）的数据，其物种树拓扑为 $((P_1, P_2), P_3), O)$。$P_1$ 和 $P_2$ 是共享一个等位基因的姐妹物种。研究旨在确定这种共享是由于跨物种多态性（TSP）还是基因渗入。\n\n1.  **全基因组背景**：\n    *   滑动窗口 $D(P_1,P_2,P_3,O)$ 的均值约为 $0$。\n    *   对于大多数窗口，Z-score的绝对值 $|Z|$ 小于 $1.5$。\n    *   $f_4$比率估计的 $P_1$ 和 $P_2$ 之间的混合接近 $0$，且置信区间很窄。\n\n2.  **局部信号**：\n    *   在以焦点多态性为中心的 $2$ 千碱基（$kb$）窗口内，有 $n = 35$ 个信息位点。\n    *   在这个焦点窗口中，估计的 $D$统计量为 $D \\approx 0.06$，标准误约为 $0.07$，得出的 Z-score 为 $Z \\approx 0.86$。\n    *   在两个侧翼的 $50$ 千碱基（$kb$）窗口中，$D \\approx 0.00 \\pm 0.01$。\n    *   在这些相同的侧翼窗口中，$f_4$比率混合估计值为 $\\hat{\\alpha} \\approx 0.00$，其 $95\\%$ 置信区间约为 $[-0.02, 0.02]$。\n\n3.  **基因树拓扑结构**：\n    *   在一个包含焦点位点的 $500$ 碱基对（$bp$）片段中，来自 $P_1$ 和 $P_2$ 的单倍型按等位基因状态聚类（例如，来自两个物种的等位基因 $A$ 形成一个支系，来自两个物种的等位基因 $B$ 形成另一个支系）。这是一个跨物种的谱系。\n    *   在相邻的 $10$ 千碱基（$kb$）侧翼区域，谱系恢复了物种树，$P_1$ 的单倍型形成一个单系群， $P_2$ 的单倍型形成另一个单系群。\n\n4.  **时间和单倍型长度证据**：\n    *   两个等位基因支系的最近共同祖先时间（$T_{\\text{MRCA}}$）估计为 $T_{\\text{MRCA}} \\approx 3.2$ 百万年（Mya），其 $95\\%$ 置信区间为 $[2.5, 3.9]$ Mya。\n    *   $P_1$ 和 $P_2$ 之间的物种分化时间（$T_S$）可追溯到 $T_S \\approx 1.1$ Mya，其 $95\\%$ 置信区间为 $[0.9, 1.3]$ Mya。\n    *   在 $P_1$ 和 $P_2$ 中携带相同等位基因的个体之间共享的平均同源状态（IBS）片段很短，约为 $0.3$ 千碱基（$kb$）。\n\n**第二步：验证问题陈述**\n\n该问题在科学上是成立的。它提出了演化基因组学中的一个经典情景：区分基因渗入和不完全谱系分选（ILS），特别是导致跨物种多态性的长期平衡选择案例。所引用的方法——$D$统计量（ABBA-BABA检验）、$f_4$比率、基因树拓扑分析、合并时间估计（$T_{\\text{MRCA}}$）和单倍型片段长度分析——都是解决这个问题的标准且合适的方法。所提供的数据内部一致且合理。例如，全基因组背景显示没有大规模基因流的证据，从而正确地将问题聚焦于一个局部的基因组区域。局部数据在焦点位点及其侧翼之间呈现出明显的对比，这是一个局部演化过程的预期模式。时间数据（$T_{\\text{MRCA}} > T_S$）是关键证据之一。该问题提法得当、客观，并包含足够的信息来形成严谨的科学结论。\n\n**结论：问题有效。**\n\n**解题推导**\n\n任务是利用所提供的证据线索，构建一个决策规则，以拒绝基因渗入假说，支持跨物种多态性假说。我们必须从第一性原理分析每种现象的预期特征。\n\n**跨物种多态性（Trans-Species Polymorphism, TSP）**产生于一个存在于祖先群体中的多态性通过平衡选择跨越物种形成事件而得以维持时。其特征性标志是：\n1.  **深层合并**：多态性等位基因的共同祖先（$T_{\\text{MRCA}}$）必须早于物种形成事件（$T_S$）。因此，一个关键标志是 $T_{\\text{MRCA}} > T_S$。\n2.  **局部的谱系不一致性**：在受选择的位点，基因树将与物种树不匹配。单倍型将按等位基因类型而非物种聚类。然而，由于重组，这种不一致的信号被限制在一个非常小的区域内。在侧翼区域，谱系应该恢复为物种树拓扑结构。\n3.  **侧翼区域无基因渗入信号**：由于该模式并非由物种形成后的基因流引起，因此不应存在延长的共享祖先块。用于检验基因渗入的统计检验，如 $D$统计量或 $f_4$比率，在受选择位点侧翼的基因组区域应得出不显著的结果（即值接近 $0$）。\n4.  **短的共享单倍型**：等位基因谱系已经分化了很长时间（自 $T_S$ 之前）。在这段漫长时期内发生的重组会打破祖先的单倍型，只留下围绕受选择位点本身的非常短的同源片段。\n\n**基因渗入（Introgression）**是物种分化后它们之间的遗传物质转移。其标志是：\n1.  **近期合并**：一个渗入的等位基因在供体和受体谱系之间的合并时间会比物种分化时间更近。\n2.  **延长的谱系不一致块**：基因渗入会转移一个DNA块。虽然重组会随时间分解这个块，但近期的基因渗入将导致一个相对较长的共享单倍型，以及一个相应较大的基因组窗口，其中基因树与物种树不一致。\n3.  **显著的混合信号**：由基因渗入导致的衍生等位基因的过度共享，将在渗入区域及其紧邻的侧翼产生一个统计上显著的非零 $D$统计量或 $f_4$比率，直到重组完全破坏连锁。\n\n**将这些原理应用于数据**\n所提供的数据与跨物种多态性的预期完全一致，而与基因渗入的预期相矛盾。\n-   **时间证据**：$T_{\\text{MRCA}} \\approx 3.2$ Mya 显著大于 $T_S \\approx 1.1$ Mya。这是支持TSP的最有力证据。\n-   **谱系证据**：基因树在焦点位点是跨物种的，但在侧翼与物种树匹配。这使信号局部化，符合TSP的预期。\n-   **混合统计**：在侧翼区域，$D$统计量和 $f_4$比率约等于 $0$，且置信区间很窄。这为反对存在任何相当规模的渗入块提供了有力证据。焦点窗口本身不显著的 $D$统计量（$Z \\approx 0.86$）进一步反驳了基因渗入。\n-   **单倍型证据**：共享的IBS片段非常短（$\\approx 0.3$ kb），这与近期的基因渗入不一致，而与一个被数百万年重组侵蚀的古老共享多态性一致。\n\n因此，一个正确的决策规则必须整合这些观察结果。拒绝基因渗入、支持TSP的规则必须要求（1）在位点周围的基因组背景中缺乏基因渗入的统计证据，（2）基因树拓扑从位点处的跨物种谱系转变为侧翼区域的物种一致谱系，以及（3）等位基因的合并时间显著早于物种分化时间。\n\n**评估所给选项**\n\n**A. 如果在焦点位点侧翼的重组界定窗口中，检验 $P_1$–$P_2$ 基因流的 $D$ 和 $f_4$比率估计值与 $0$ 没有显著差异，焦点位点的谱系按跨物种的等位基因状态将单倍型分组，而相邻的侧翼区域恢复了物种树，并且等位基因支系的 $T_{\\text{MRCA}}$ 超过了 $T_S$，则拒绝基因渗入，支持跨物种多态性。在这些共同条件下，推断为古老的平衡多态性而非基因渗入。**\n该选项正确地综合了多条关键的证据线索。它要求侧翼无基因流信号（$D \\approx 0, f_4 \\approx 0$），特定的局部谱系不一致模式，以及决定性的时间标准（$T_{\\text{MRCA}} > T_S$）。这是一条全面且科学严谨的规则。\n**结论：正确。**\n\n**B. 每当跨越焦点位点的任何窗口得出非零的 $D$ 值时，无论其符号、大小或统计显著性如何，都拒绝基因渗入，支持跨物种多态性，因为任何偏离 $0$ 的情况都与无基因流的原假设不相容。**\n这个选项根本上是错误的。$D$统计量是一个随机变量；由于随机性（例如ILS、抽样误差），它预期会偏离 $0$。科学推断需要通过假设检验来确定这种偏离是否具有统计显著性。忽略统计显著性是一个严重的错误。\n**结论：不正确。**\n\n**C. 每当焦点位点的局部基因树混合了 $P_1$ 和 $P_2$ 的单倍型时，即使侧翼的 $D$ 值显著非零，也拒绝基因渗入，支持跨物种多态性，因为一个支系内物种的混合必然反映了祖先多态性。**\n这个选项犯了两个错误。首先，一个混合的（跨物种的）基因树是TSP和基因渗入*共同*的特征；它本身无法区分两者。其次，“即使侧翼的 $D$ 值显著非零”也认为其反映了祖先多态性的断言恰恰是错误的。侧翼区域显著的 $D$ 值是*支持*基因渗入的有力证据。\n**结论：不正确。**\n\n**D. 仅当 $D$ 在焦点位点的两侧显著非零且符号相反时，才拒绝基因渗入，支持跨物种多态性，因为侧翼区域 $D$ 值的符号翻转表明不完全谱系分选无法解释该数据。**\n这描述了一种特定、复杂的模式，有时可能在平衡选择下出现，但它不是一个必要或普遍的特征。将其作为*唯一*条件（“仅当”）限制性太强。更基本的证据，如 $T_{\\text{MRCA}} > T_S$ 和侧翼 $D$ 为空值，更为通用和有力。这条规则与所提供的数据（侧翼 $D \\approx 0$）不一致。\n**结论：不正确。**\n\n**E. 当 $P_1$ 和 $P_2$ 之间的 $f_4$比率混合估计值 $\\hat{\\alpha}$ 特别是在焦点窗口内显著大于 $0$ 时，拒绝基因渗入，支持跨物种多态性，理由是焦点区域的过度共享必定反映了古老的多态性而非近期的基因流。**\n这个选项从根本上误解了该统计量。一个显著为正的混合估计值（$\\hat{\\alpha} > 0$）是因基因渗入导致的过度等位基因共享的典型信号。声称这“必定反映了古老的多态性”直接违背了该统计量的目的和标准解释。\n**结论：不正确。**\n\n基于此分析，只有选项A根据所提供的数据和演化遗传学的既定原则，构建了一个科学正确且全面的决策规则。", "answer": "$$\\boxed{A}$$", "id": "2759485"}, {"introduction": "理论模拟是理解不同演化模型如何产生可观测数据特征的强大工具。通过亲手实现一个简化的确定性模拟器[@problem_id:2759424]，你将从第一性原理出发，探索跨物种多态性和基因渗入这两种情景下预期的遗传分歧模式。这项练习旨在加深你对模型背后核心演化过程的理解。", "problem": "要求您编写一个完整、可运行的程序，该程序实现一个确定性模拟器，用于模拟两个物种间共享等位基因的两种相对演化情景，并使用它计算一个判别统计量，该统计量可用于评估区分基因流和真实跨物种多态性的方法。\n\n背景与定义：\n- 考虑两个物种，它们在 $T_{\\mathrm{div}}$ 代前从一个有效群体大小恒为 $N_e$ 的共同祖先群体分化而来。为简化起见，假设采用单倍体表示，因此成对溯祖量指的是单倍体谱系。\n- 跨物种多态性定义为由于长期平衡选择，等位基因谱系跨越物种边界持续存在的现象。在这里，我们将其表示为在祖先群体中，两个等位基因类别在时间 $T_{\\mathrm{bal}}$（以代为单位）发生的一次古代分裂，该分裂早于物种形成（$T_{\\mathrm{bal}} > T_{\\mathrm{div}}$），且分裂后两个等位基因类别在两个后代物种中都被保留下来。\n- 基因渗入（基因流）定义为在物种形成后的时间 $T_{\\mathrm{mig}}$（以代为单位）发生的一次脉冲式迁移（$0 \\le T_{\\mathrm{mig}} \\le T_{\\mathrm{div}}$），将一个谱系从一个物种移动到另一个物种。\n- 使用无限位点突变模型。每碱基、每代的突变率为 $\\mu$，序列长度为 $L$（以碱基为单位）。在无限位点模型下，两条序列之间的期望成对差异数等于 $2 \\mu L$ 乘以这两条谱系的期望溯祖时间。\n\n使用的基本原理：\n- 在溯祖理论下，对于一个恒定大小的中性群体，从同一个随机交配群体中抽样的两个谱系之间的期望成对溯祖时间为 $2 N_e$ 代。\n- 在无限位点模型下，如果两条谱系在过去的 $t$ 代发生溯祖，则期望成对差异数为 $2 \\mu L \\, t$。\n- 为解决此问题，您必须按如下方式对特定谱系配对的期望溯祖时间进行建模，这是一种为获得可处理的期望值而使用的标准简化方法：\n  - 跨物种多态性情景（伴有长期平衡选择）：\n    - 物种内配对：期望溯祖时间为 $2 N_e$。\n    - 携带相同古代等位基因类别的跨物种配对：期望溯祖时间为 $T_{\\mathrm{bal}}$。\n    - 携带不同古代等位基因类别的跨物种配对：期望溯祖时间为 $T_{\\mathrm{bal}} + 2 N_e$。\n  - 基因渗入情景（物种形成后的单次脉冲式基因流）：\n    - 物种内配对：期望溯祖时间为 $2 N_e$。\n    - 近期迁移体和供体组成的跨物种配对（由于基因流而在物种间拥有相同等位基因）：期望溯祖时间为 $T_{\\mathrm{mig}} + 2 N_e$。\n    - 没有近期基因流的跨物种配对（物种间拥有不同等位基因）：期望溯祖时间为 $T_{\\mathrm{div}} + 2 N_e$。\n\n任务要求：\n- 实现一个确定性模拟器，在给定参数 $(N_e, T_{\\mathrm{div}}, T_{\\mathrm{bal}}, T_{\\mathrm{mig}}, \\mu, L)$ 的情况下，通过将期望溯祖时间与无限位点模型相结合，计算每种情景下上述三种比较的期望成对差异。\n- 根据这些期望值，为每种情景计算以下无量纲的判别统计量：\n  - 令 $D_{\\mathrm{cross\\_same}}$ 表示携带相同等位基因的跨物种配对的期望成对差异数，令 $D_{\\mathrm{cross\\_diff}}$ 表示携带不同等位基因的跨物种配对的期望成对差异数。定义\n    $$ S \\equiv \\frac{D_{\\mathrm{cross\\_diff}} - D_{\\mathrm{cross\\_same}}}{2 \\mu L \\, T_{\\mathrm{div}}}. $$\n  - 为提供的参数集计算跨物种多态性情景和基因渗入情景下的 $S$ 值。\n- 对于每个参数集，您的程序必须输出一个包含三个浮点数的列表 $[S_{\\mathrm{TSP}}, S_{\\mathrm{IGF}}, \\Delta]$，其中 $S_{\\mathrm{TSP}}$ 是跨物种多态性模型下的 $S$ 值，$S_{\\mathrm{IGF}}$ 是基因渗入模型下的 $S$ 值，而 $\\Delta = S_{\\mathrm{IGF}} - S_{\\mathrm{TSP}}$ 是一个无量纲的分离指数。从解释上看，更大的正值 $\\Delta$ 表明存在更清晰的分离，这种情况与基因流一致，而非深度的跨物种多态性。\n- 时间量必须以代为单位。突变率 $\\mu$ 是每碱基每代。序列长度 $L$ 以碱基为单位。输出是无量纲的浮点数，必须以十进制数报告。\n\n测试套件：\n- 使用以下参数集，每个参数集定义为一个有序元组 $(N_e, T_{\\mathrm{div}}, T_{\\mathrm{bal}}, T_{\\mathrm{mig}}, \\mu, L)$，单位如上所述。所有时间单位为代，$N_e$ 的单位为个体数，$\\mu$ 的单位为每碱基每代，$L$ 的单位为碱基。\n  - 案例A：$(N_e = 1 \\times 10^{5},\\; T_{\\mathrm{div}} = 2 \\times 10^{6},\\; T_{\\mathrm{bal}} = 4 \\times 10^{6},\\; T_{\\mathrm{mig}} = 5 \\times 10^{5},\\; \\mu = 1 \\times 10^{-8},\\; L = 1000)$。\n  - 案例B（边界条件 $T_{\\mathrm{mig}} = T_{\\mathrm{div}}$）：$(N_e = 1 \\times 10^{4},\\; T_{\\mathrm{div}} = 1 \\times 10^{5},\\; T_{\\mathrm{bal}} = 2 \\times 10^{5},\\; T_{\\mathrm{mig}} = 1 \\times 10^{5},\\; \\mu = 2 \\times 10^{-8},\\; L = 2000)$。\n  - 案例C（小 $N_e$，近期迁移）：$(N_e = 1 \\times 10^{3},\\; T_{\\mathrm{div}} = 1 \\times 10^{6},\\; T_{\\mathrm{bal}} = 5 \\times 10^{6},\\; T_{\\mathrm{mig}} = 1 \\times 10^{5},\\; \\mu = 1 \\times 10^{-9},\\; L = 10000)$。\n  - 案例D（古代分化）：$(N_e = 5 \\times 10^{4},\\; T_{\\mathrm{div}} = 1 \\times 10^{7},\\; T_{\\mathrm{bal}} = 2 \\times 10^{7},\\; T_{\\mathrm{mig}} = 5 \\times 10^{6},\\; \\mu = 1.5 \\times 10^{-8},\\; L = 500)$。\n  - 案例E（相对于 $T_{\\mathrm{div}}$ 而言 $N_e$ 较大）：$(N_e = 4 \\times 10^{5},\\; T_{\\mathrm{div}} = 5 \\times 10^{5},\\; T_{\\mathrm{bal}} = 1 \\times 10^{6},\\; T_{\\mathrm{mig}} = 1 \\times 10^{5},\\; \\mu = 1 \\times 10^{-8},\\; L = 1500)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个列表，每个测试案例对应一个条目，顺序与上述相同。每个条目必须是该案例的列表 $[S_{\\mathrm{TSP}}, S_{\\mathrm{IGF}}, \\Delta]$。最后一行必须看起来像一个有效的 Python 列表字面量，例如 $[[0.1,0.2,0.1],[\\dots],\\dots]$。所有结果均以十进制数报告（无百分号）。不应打印其他任何文本。", "solution": "问题陈述经过了严格验证，被认为是有效的。它以群体遗传学原理为科学基础，提法明确，提供了所有必要信息，并且表述客观。问题明确指出，简化的溯祖时间模型是该问题的基础，这对于一个理论练习来说是一个可接受的前提。因此，我们可以着手推导解决方案。\n\n目标是为两种不同的演化情景——跨物种多態性（TSP）和基因渗入（IGF）——计算一个判别统计量 $S$。该统计量 $S$ 定义如下：\n$$\nS \\equiv \\frac{D_{\\mathrm{cross\\_diff}} - D_{\\mathrm{cross\\_same}}}{2 \\mu L \\, T_{\\mathrm{div}}}\n$$\n此处，$D_{\\mathrm{cross\\_diff}}$ 和 $D_{\\mathrm{cross\\_same}}$ 分别表示携带不同等位基因和相同等位基因的跨物种配对序列之间的期望成对差异数。参数包括每碱基每代的突变率 $\\mu$、序列长度 $L$ 以及以代为单位的物种分化时间 $T_{\\mathrm{div}}$。\n\n根据无限位点模型，两条谱系之间的期望成对差异数 $D$ 由两倍突变率（$2\\mu L$）与其期望溯祖时间 $T_c$ 的乘积给出。\n$$\nD = 2 \\mu L \\, T_c\n$$\n将此关系代入 $S$ 的定义中，我们可以简化表达式。\n$$\nS = \\frac{(2 \\mu L \\cdot T_{c, \\mathrm{cross\\_diff}}) - (2 \\mu L \\cdot T_{c, \\mathrm{cross\\_same}})}{2 \\mu L \\, T_{\\mathrm{div}}}\n$$\n项 $2 \\mu L$ 是分子中的公因子，也出现在分母中。假设 $\\mu > 0$ 且 $L > 0$，该因子可以消去：\n$$\nS = \\frac{T_{c, \\mathrm{cross\\_diff}} - T_{c, \\mathrm{cross\\_same}}}{T_{\\mathrm{div}}}\n$$\n这个简化的公式表明，统计量 $S$ 根据其设计与突变率 $\\mu$ 和序列长度 $L$ 无关。它是时间尺度的比率。现在，我们将使用提供的期望溯祖时间模型，将此公式应用于每种情景。\n\n首先，考虑跨物种多态性（TSP）情景。问题指定了以下期望溯祖时间：\n- 对于具有不同古代等位基因类别的跨物种配对：$T_{c, \\mathrm{cross\\_diff}}^{\\mathrm{TSP}} = T_{\\mathrm{bal}} + 2 N_e$。\n- 对于具有相同古代等位基因类别的跨物种配对：$T_{c, \\mathrm{cross\\_same}}^{\\mathrm{TSP}} = T_{\\mathrm{bal}}$。\n\n此处，$T_{\\mathrm{bal}}$ 是古代等位基因分裂的时间，$N_e$ 是有效群体大小。将这些值代入我们简化的 $S$ 公式中：\n$$\nS_{\\mathrm{TSP}} = \\frac{(T_{\\mathrm{bal}} + 2 N_e) - T_{\\mathrm{bal}}}{T_{\\mathrm{div}}} = \\frac{2 N_e}{T_{\\mathrm{div}}}\n$$\n这个结果非常简单。对于指定的 TSP 模型，统计量 $S$ 是两倍有效群体大小与物种分化时间之比。请注意，参数 $T_{\\mathrm{bal}}$ 并未出现在 $S_{\\mathrm{TSP}}$ 的最终表达式中。\n\n接下来，考虑基因渗入（IGF）情景。问题提供了以下期望溯祖时间：\n- 对于没有近期基因流的跨物种配对（不同等位基因）：$T_{c, \\mathrm{cross\\_diff}}^{\\mathrm{IGF}} = T_{\\mathrm{div}} + 2 N_e$。\n- 对于作为近期迁移体/供体的跨物种配对（相同等位基因）：$T_{c, \\mathrm{cross\\_same}}^{\\mathrm{IGF}} = T_{\\mathrm{mig}} + 2 N_e$。\n\n此处，$T_{\\mathrm{mig}}$ 是迁移脉冲发生的时间。将这些值代入 $S$ 的公式中：\n$$\nS_{\\mathrm{IGF}} = \\frac{(T_{\\mathrm{div}} + 2 N_e) - (T_{\\mathrm{mig}} + 2 N_e)}{T_{\\mathrm{div}}} = \\frac{T_{\\mathrm{div}} - T_{\\mathrm{mig}}}{T_{\\mathrm{div}}} = 1 - \\frac{T_{\\mathrm{mig}}}{T_{\\mathrm{div}}}\n$$\n对于 IGF 模型，统计量 $S$ 仅取决于迁移时间与分化时间之比。它与有效群体大小 $N_e$ 无关。\n\n最后，分离指数 $\\Delta$ 定义为两种情景下统计量值的差：\n$$\n\\Delta = S_{\\mathrm{IGF}} - S_{\\mathrm{TSP}}\n$$\n使用我们推导出的表达式：\n$$\n\\Delta = \\left(1 - \\frac{T_{\\mathrm{mig}}}{T_{\\mathrm{div}}}\\right) - \\left(\\frac{2 N_e}{T_{\\mathrm{div}}}\\right) = \\frac{T_{\\mathrm{div}} - T_{\\mathrm{mig}} - 2 N_e}{T_{\\mathrm{div}}}\n$$\n较大的正值 $\\Delta$ 表示，如果观测数据由 $S$ 概括，则该数据与基因渗入情景的一致性要高于与跨物种多态性情景的一致性。\n\n剩下的任务是实现这些推导出的公式，并为给定的测试参数集计算 $[S_{\\mathrm{TSP}}, S_{\\mathrm{IGF}}, \\Delta]$ 的值。程序将执行这些直接的计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a discrimination statistic to distinguish trans-species polymorphism (TSP)\n    from introgression (IGF) for a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Ne, T_div, T_bal, T_mig, mu, L)\n    test_cases = [\n        # Case A\n        (1e5, 2e6, 4e6, 5e5, 1e-8, 1000),\n        # Case B\n        (1e4, 1e5, 2e5, 1e5, 2e-8, 2000),\n        # Case C\n        (1e3, 1e6, 5e6, 1e5, 1e-9, 10000),\n        # Case D\n        (5e4, 1e7, 2e7, 5e6, 1.5e-8, 500),\n        # Case E\n        (4e5, 5e5, 1e6, 1e5, 1e-8, 1500),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case.\n        # Note: T_bal, mu, and L are not required for the simplified formulas,\n        # but are defined in the problem.\n        Ne, T_div, T_bal, T_mig, mu, L = case\n\n        # Ensure T_div is non-zero to avoid division by zero errors,\n        # although this is guaranteed by the problem's test data.\n        if T_div == 0:\n            # This case should not be reached with the given test data.\n            # Assign NaN or handle as an error if necessary.\n            s_tsp = float('nan')\n            s_igf = float('nan')\n            delta = float('nan')\n        else:\n            # Calculate S_TSP based on the derived formula: 2 * Ne / T_div\n            s_tsp = (2 * Ne) / T_div\n\n            # Calculate S_IGF based on the derived formula: 1 - (T_mig / T_div)\n            s_igf = 1 - (T_mig / T_div)\n\n            # Calculate the separation index Delta\n            delta = s_igf - s_tsp\n\n        # Append the list of results for this case.\n        results.append([s_tsp, s_igf, delta])\n\n    # The final print statement must produce a single line containing\n    # a Python list literal of lists, as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2759424"}]}