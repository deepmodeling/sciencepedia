{"hands_on_practices": [{"introduction": "定向演化的第一步是创造遗传多样性。本练习引入了一个基本的统计模型——泊松分布，用于预测通过易错PCR等方法产生的突变文库的构成。理解这一点使研究人员能够调整诱变率，以实现每个基因所需的突变数量，这对于成功的演化实验至关重要。[@problem_id:2701249]", "problem": "在对一个脱氧核糖核酸（DNA）基因进行定向进化的一轮文库生成中，您使用易错聚合酶链式反应（PCR）对一个长度为 $L=1000$ 个核苷酸的编码序列进行诱变。假设在这一轮中，每个核苷酸独立地发生点突变的概率为 $\\mu$，并且在同一轮中同一核苷酸上发生多次突变的情况可以忽略不计。设 $K$ 表示这一轮后一个克隆中突变位点的总数。\n\n仅从以下基本原则出发：\n1. $L$ 个位点上每个位点的突变事件是独立的，每个事件都可建模为突变概率为 $\\mu$ 的伯努利试验。\n2. 独立同分布的伯努利试验之和的分布是二项分布。\n3. 当试验次数很多、成功概率很小且均值保持不变时，二项分布收敛于泊松分布的经典极限，\n\n推导当 $L \\to \\infty$ 和 $\\mu \\to 0$ 且 $\\lambda \\equiv \\mu L$ 保持恒定时 $K$ 的极限分布，然后使用此模型，在 $L=1000$ 的情况下，获得携带 $0$、 $1$ 和 $2$ 个总突变的克隆的预期比例的显式解析表达式。将您的最终答案表示为一个单行向量，其中包含这三个比例，仅用 $\\mu$ 表示，不带单位，也无需四舍五入。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 编码序列长度：$L=1000$ 个核苷酸。\n- 每个核苷酸每轮发生点突变的概率：$\\mu$。\n- 每个核苷酸位点的突变是独立事件。\n- 一轮内单个位点发生多次突变的情况可忽略不计。\n- $K$ 是表示一个克隆中突变位点总数的随机变量。\n- 推导必须基于三个原则：\n    1. 每个位点的突变是一个成功概率为 $\\mu$ 的伯努利试验。\n    2. $K$ 的分布，即 $L$ 个独立同分布（i.i.d.）伯努利试验之和，是二项分布。\n    3. 在 $L \\to \\infty$ 和 $\\mu \\to 0$ 的极限下，当均值 $\\lambda \\equiv \\mu L$ 保持恒定时，二项分布收敛于泊松分布。\n- 最终目标是，使用推导出的极限分布，在 $L=1000$ 的情况下，为含有 $0$、 $1$ 和 $2$ 个突变的克隆的预期比例提供显式解析表达式。结果必须是一个仅用 $\\mu$ 表示的行向量。\n\n**步骤2：验证**\n该问题具有科学依据，提法明确且客观。它描述了分子进化和群体遗传学中的一个标准基本模型——使用泊松分布来近似大量试验（核苷酸位点）中稀有、独立事件（突变）的数量。前提条件是一致的，并为得出唯一、有意义的解提供了完整的基础。没有违反科学原理之处，没有歧义，也没有信息缺失。该问题是将统计力学应用于生物学的一个正式练习。\n\n**步骤3：结论**\n问题有效。将提供解答。\n\n推导过程按指示进行。设特定核苷酸位点 $i$（其中 $i \\in \\{1, 2, \\dots, L\\}$）发生突变的事件为一个伯努利试验模型。我们为每个位点定义一个随机变量 $X_i$：\n$$\nX_i = \\begin{cases} 1  \\text{如果位点 } i \\text{ 发生突变} \\\\ 0  \\text{如果位点 } i \\text{ 未发生突变} \\end{cases}\n$$\n发生突变的概率为 $P(X_i=1) = \\mu$，因此，不发生突变的概率为 $P(X_i=0) = 1-\\mu$。\n\n长度为 $L$ 的序列中突变位点的总数 $K$ 是这些独立同分布的伯努利随机变量之和：\n$$ K = \\sum_{i=1}^{L} X_i $$\n正如问题的基本原则所述，$L$ 个独立同分布的伯努利试验之和服从二项分布。因此，$K$ 的精确分布是 $K \\sim \\text{Binomial}(L, \\mu)$。观测到恰好 $k$ 个突变的概率质量函数（PMF）由下式给出：\n$$ P(K=k) = \\binom{L}{k} \\mu^k (1-\\mu)^{L-k} $$\n其中 $\\binom{L}{k} = \\frac{L!}{k!(L-k)!}$。\n\n根据指示，我们需要在均值突变数 $\\lambda = \\mu L$ 保持恒定的条件下，推导当 $L \\to \\infty$ 和 $\\mu \\to 0$ 时的极限分布。我们从二项分布的概率质量函数开始，并代入 $\\mu = \\lambda/L$：\n$$ P(K=k) = \\frac{L!}{k!(L-k)!} \\left(\\frac{\\lambda}{L}\\right)^k \\left(1-\\frac{\\lambda}{L}\\right)^{L-k} $$\n我们现在分析在 $L \\to \\infty$ 的极限下每一项的行为。\n首先，考虑组合项：\n$$ \\frac{L!}{k!(L-k)!} = \\frac{L(L-1)(L-2)\\cdots(L-k+1)}{k!} $$\n当 $L \\to \\infty$ 时，对于固定的 $k$，分子是 $L$ 的一个 $k$ 次多项式。其首项是 $L^k$。因此，该表达式渐近等价于 $\\frac{L^k}{k!}$。\n$$ \\lim_{L\\to\\infty} \\frac{L(L-1)\\cdots(L-k+1)}{L^k} = 1 $$\n所以我们可以写出：\n$$ \\frac{L!}{k!(L-k)!} \\approx \\frac{L^k}{k!} \\quad \\text{对于大的 } L $$\n接下来，考虑项 $\\left(\\frac{\\lambda}{L}\\right)^k = \\frac{\\lambda^k}{L^k}$。\n最后，分析项 $\\left(1-\\frac{\\lambda}{L}\\right)^{L-k}$：\n$$ \\left(1-\\frac{\\lambda}{L}\\right)^{L-k} = \\left(1-\\frac{\\lambda}{L}\\right)^L \\left(1-\\frac{\\lambda}{L}\\right)^{-k} $$\n使用指数函数的基本极限定义 $\\lim_{n\\to\\infty} (1 + x/n)^n = e^x$，我们有：\n$$ \\lim_{L\\to\\infty} \\left(1-\\frac{\\lambda}{L}\\right)^L = e^{-\\lambda} $$\n对于第二部分：\n$$ \\lim_{L\\to\\infty} \\left(1-\\frac{\\lambda}{L}\\right)^{-k} = (1-0)^{-k} = 1 $$\n结合这些结果，概率质量函数的极限形式是：\n$$ \\lim_{L\\to\\infty, \\mu\\to 0, \\mu L=\\lambda} P(K=k) = \\left(\\frac{L^k}{k!}\\right) \\left(\\frac{\\lambda^k}{L^k}\\right) (e^{-\\lambda}) (1) = \\frac{\\lambda^k e^{-\\lambda}}{k!} $$\n这是均值为 $\\lambda$ 的泊松分布的概率质量函数。因此，$K$ 的极限分布是 $K \\sim \\text{Poisson}(\\lambda)$。\n\n现在问题要求我们使用这个泊松模型来求出具有 $k=0$、$k=1$ 和 $k=2$ 个突变的克隆的预期比例。具有 $k$ 个突变的克隆比例由 $P(K=k)$ 给出。我们已知 $L=1000$，均值为 $\\lambda = \\mu L = 1000\\mu$。\n\n对于 $k=0$ 个突变（野生型或未突变序列）：\n比例为 $P(K=0) = \\frac{\\lambda^0 e^{-\\lambda}}{0!}$。由于 $\\lambda^0=1$ 且 $0!=1$，该式可简化为：\n$$ P(K=0) = e^{-\\lambda} = \\exp(-1000\\mu) $$\n\n对于 $k=1$ 个突变（单突变克隆）：\n比例为 $P(K=1) = \\frac{\\lambda^1 e^{-\\lambda}}{1!}$。该式可简化为：\n$$ P(K=1) = \\lambda e^{-\\lambda} = 1000\\mu \\exp(-1000\\mu) $$\n\n对于 $k=2$ 个突变（双突变克隆）：\n比例为 $P(K=2) = \\frac{\\lambda^2 e^{-\\lambda}}{2!}$。该式可简化为：\n$$ P(K=2) = \\frac{\\lambda^2}{2} e^{-\\lambda} = \\frac{(1000\\mu)^2}{2} \\exp(-1000\\mu) = \\frac{1000000\\mu^2}{2} \\exp(-1000\\mu) = 500000\\mu^2 \\exp(-1000\\mu) $$\n\n这三个表达式代表了所要求的比例，仅用 $\\mu$ 表示。它们需要以单个行向量的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp(-1000\\mu) & 1000\\mu \\exp(-1000\\mu) & 500000\\mu^2 \\exp(-1000\\mu) \\end{pmatrix}}\n$$", "id": "2701249"}, {"introduction": "在创建了多样化的文库之后，下一个挑战是将基因型的改变与可被选择的优势联系起来。本练习探讨了一个核心概念：基因型-表型-适应度图谱。通过构建一个模型，将酶的催化效率（$k_{\\text{cat}}/K_M$）与细胞的生长速率相联系，我们可以量化不同变体之间的相对适应度，并理解连续演化系统中的选择原理。[@problem_id:2701222]", "problem": "在恒浊器中进行的连续定向进化实验中，宿主细胞的生长与一种工程改造的酶所提供的通量紧密耦合，该酶将一种限制性前体转化为一种必需的代谢物。在未饱和的底物浓度下，每个酶分子的有效活性与催化效率成正比，因此增加转换数与米氏常数的比率会提高代谢物的供应速率。种群的马尔萨斯增长率（单位时间）被建模为催化效率的线性函数，直至达到一个生理上限，这反映了全局资源的限制。具体来说，适应度图谱为\n$$\nr = \\min\\!\\big(r_0 + \\beta \\,(k_{\\text{cat}}/K_M), \\, r_{\\max}\\big),\n$$\n其中 $r$ 是以 $\\mathrm{h}^{-1}$ 为单位的马尔萨斯增长率，$r_0$ 是在没有功能性酶的情况下的基线增长率，$\\beta$ 是一个将催化效率转换为增长率的比例常数，而 $r_{\\max}$ 是在给定环境中的最大可达增长率。此处 $(k_{\\text{cat}}/K_M)$ 的单位是 $\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$，因此 $\\beta$ 的单位是 $\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}$，而 $r$ 的单位是 $\\mathrm{h}^{-1}$。\n\n两种变体 $\\mathrm{A}$ 和 $\\mathrm{B}$，在筛选所用的测定条件下测得以下动力学参数：\n- 变体 $\\mathrm{A}$：$k_{\\text{cat},\\mathrm{A}} = 120\\,\\mathrm{s}^{-1}$，$K_{M,\\mathrm{A}} = 60\\,\\mu\\mathrm{M}$。\n- 变体 $\\mathrm{B}$：$k_{\\text{cat},\\mathrm{B}} = 400\\,\\mathrm{s}^{-1}$，$K_{M,\\mathrm{B}} = 50\\,\\mu\\mathrm{M}$。\n\n环境参数为 $r_0 = 0.15\\,\\mathrm{h}^{-1}$，$\\beta = 0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}$，以及 $r_{\\max} = 0.80\\,\\mathrm{h}^{-1}$。\n\n使用连续时间中相对适应度的定义，即马尔萨斯增长率的比值 $w_{\\mathrm{A}/\\mathrm{B}} = r_{\\mathrm{A}}/r_{\\mathrm{B}}$，计算变体 $\\mathrm{A}$ 相对于变体 $\\mathrm{B}$ 的相对适应度。将您的最终答案表示为一个无量纲小数，并四舍五入到四位有效数字。", "solution": "解析并验证问题陈述。已知条件如下：\n马尔萨斯增长率 $r$（单位 $\\mathrm{h}^{-1}$）的适应度图谱为：\n$$\nr = \\min\\!\\big(r_0 + \\beta \\,(k_{\\text{cat}}/K_M), \\, r_{\\max}\\big)\n$$\n变体 $\\mathrm{A}$ 的参数：\n$k_{\\text{cat},\\mathrm{A}} = 120\\,\\mathrm{s}^{-1}$\n$K_{M,\\mathrm{A}} = 60\\,\\mu\\mathrm{M}$\n\n变体 $\\mathrm{B}$ 的参数：\n$k_{\\text{cat},\\mathrm{B}} = 400\\,\\mathrm{s}^{-1}$\n$K_{M,\\mathrm{B}} = 50\\,\\mu\\mathrm{M}$\n\n环境参数：\n$r_0 = 0.15\\,\\mathrm{h}^{-1}$\n$\\beta = 0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}$\n$r_{\\max} = 0.80\\,\\mathrm{h}^{-1}$\n\n相对适应度的定义为 $w_{\\mathrm{A}/\\mathrm{B}} = r_{\\mathrm{A}}/r_{\\mathrm{B}}$。\n\n该问题具有科学依据，是良定的，并包含了得出唯一解所需的所有信息。单位是内部一致的：乘积 $\\beta \\cdot (k_{\\text{cat}}/K_M)$ 的单位是 $(\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}) \\cdot (\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) = \\mathrm{h}^{-1}$，这与 $r$、$r_0$ 和 $r_{\\max}$ 的单位一致。因此，该问题是有效的，我们开始求解。\n\n求解过程需要根据所提供的适应度图谱，计算每种变体（$r_{\\mathrm{A}}$ 和 $r_{\\mathrm{B}}$）的马尔萨斯增长率。这首先涉及到确定催化效率，其定义为比值 $k_{\\text{cat}}/K_M$。\n\n对于变体 $\\mathrm{A}$，其催化效率为：\n$$\n\\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{A}} = \\frac{k_{\\text{cat},\\mathrm{A}}}{K_{M,\\mathrm{A}}} = \\frac{120\\,\\mathrm{s}^{-1}}{60\\,\\mu\\mathrm{M}} = 2.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}\n$$\n然后使用适应度图谱的线性部分计算其潜在增长率：\n$$\nr_{0} + \\beta \\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{A}} = 0.15\\,\\mathrm{h}^{-1} + (0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}) \\cdot (2.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) = 0.15\\,\\mathrm{h}^{-1} + 0.40\\,\\mathrm{h}^{-1} = 0.55\\,\\mathrm{h}^{-1}\n$$\n实际增长率 $r_{\\mathrm{A}}$ 是该值与生理最大值 $r_{\\max}$ 中的较小者。\n$$\nr_{\\mathrm{A}} = \\min(0.55\\,\\mathrm{h}^{-1}, 0.80\\,\\mathrm{h}^{-1}) = 0.55\\,\\mathrm{h}^{-1}\n$$\n\n接下来，我们对变体 $\\mathrm{B}$ 进行同样的计算。其催化效率为：\n$$\n\\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{B}} = \\frac{k_{\\text{cat},\\mathrm{B}}}{K_{M,\\mathrm{B}}} = \\frac{400\\,\\mathrm{s}^{-1}}{50\\,\\mu\\mathrm{M}} = 8.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}\n$$\n其潜在增长率则为：\n$$\nr_{0} + \\beta \\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{B}} = 0.15\\,\\mathrm{h}^{-1} + (0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}) \\cdot (8.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) = 0.15\\,\\mathrm{h}^{-1} + 1.60\\,\\mathrm{h}^{-1} = 1.75\\,\\mathrm{h}^{-1}\n$$\n实际增长率 $r_{\\mathrm{B}}$ 是该值与生理最大值 $r_{\\max}$ 中的较小者。在这种情况下，计算出的线性增长率超过了上限。\n$$\nr_{\\mathrm{B}} = \\min(1.75\\,\\mathrm{h}^{-1}, 0.80\\,\\mathrm{h}^{-1}) = 0.80\\,\\mathrm{h}^{-1}\n$$\n\n最后，变体 $\\mathrm{A}$ 相对于变体 $\\mathrm{B}$ 的相对适应度是它们马尔萨斯增长率的比值。\n$$\nw_{\\mathrm{A}/\\mathrm{B}} = \\frac{r_{\\mathrm{A}}}{r_{\\mathrm{B}}} = \\frac{0.55\\,\\mathrm{h}^{-1}}{0.80\\,\\mathrm{h}^{-1}} = \\frac{0.55}{0.80}\n$$\n此计算得出一个无量纲值：\n$$\nw_{\\mathrm{A}/\\mathrm{B}} = 0.6875\n$$\n问题要求答案表示为四位有效数字。计算值 $0.6875$ 恰好有四位有效数字，因此无需进一步四舍五入。", "answer": "$$\n\\boxed{0.6875}\n$$", "id": "2701222"}, {"introduction": "一旦鉴定出具有适应度优势的有益突变体，我们便可以预测其在种群中的演化轨迹。本练习深入探讨了如噬菌体辅助连续演化（PACE）等连续演化系统中的种群动态。通过推导并求解复制子方程，您将能够模拟一个变体的频率如何随时间变化，并计算其最终在种群中被固定的时间，这是衡量选择策略效率的一个关键指标。[@problem_id:2701202]", "problem": "考虑一个使用噬菌粒系统 (PACEmid) 的噬菌体辅助连续进化 (Phage-Assisted Continuous Evolution, PACE) 的简化确定性模型，这是一种与 PACE 相关的实现。在一个连续培养系统中，存在两个竞争的谱系：一个有益变体和一个野生型。令 $x_v(t)$ 和 $x_w(t)$ 表示它们在时间 $t$ 的绝对丰度，并令 $p(t) = \\dfrac{x_v(t)}{x_v(t) + x_w(t)}$ 表示有益变体的频率。假设存在带稀释的指数增长，因此每个谱系 $i \\in \\{v,w\\}$ 遵循\n$$\n\\frac{dx_i}{dt} = m_i(\\sigma)\\, x_i,\n$$\n其中 $m_i(\\sigma) = r_i(\\sigma) - D$ 是净马尔萨斯增长率，$r_i(\\sigma)$ 是内禀复制速率，$D$ 是培养池的稀释速率，$\\sigma \\ge 0$ 是一个由实验者控制的标量选择严谨性参数。变体的复制速率依赖于 $\\sigma$，如下所示：\n$$\nr_v(\\sigma) = r_0 + k\\,\\sigma,\n$$\n而野生型的复制速率为\n$$\nr_w(\\sigma) = r_0,\n$$\n其中 $r_0 > 0$ 和 $k > 0$ 是常数。假设在所考虑的时间尺度上，突变和随机漂变可以忽略不计，且系统是充分混合的。\n\n从上述基本定义出发，推导控制 $p(t)$ 的常微分方程，以及变体频率从初始频率 $p_0$ 达到预设目标 $p^\\star$ 所需的相应闭式时间，该时间表示为 $\\sigma$ 的函数。然后实现一个程序，对于一组给定的 $\\sigma$ 值，该程序能够 (i) 使用固定步长的显式欧拉积分器数值模拟富集轨迹 $p(t)$，以及 (ii) 计算达到 $p^\\star$ 的闭式时间；程序最终应仅输出指定测试套件的闭式时间。\n\n使用以下参数化，这在连续进化环境中是科学合理的：\n- 基础复制速率: $r_0 = 0.6$ 每小时。\n- 选择增益系数: $k = 0.2$ 每小时每单位 $\\sigma$。\n- 稀释速率: $D = 0.5$ 每小时。\n- 初始变体频率: $p_0 = 10^{-4}$ (无量纲)。\n- 固定阈值: $p^\\star = 0.99$ (无量纲)，解释为实际固定。\n- 时间单位：所有时间必须以小时为单位报告。\n- 模拟积分器步长: $\\Delta t = 0.01$ 小时。\n- 最大模拟时间范围: $T_{\\max} = 10000$ 小时。\n\n任务：\n- 根据给定的增长定律，推导出关于 $p(t)$ 的精确微分方程，以及从 $p_0$ 达到 $p^\\star$ 所需时间的闭式表达式，该表达式为 $\\sigma$ 的函数。不要假设任何未从给定定义中推导出的简化公式。\n- 实现一个程序，对于下面测试套件中的每个 $\\sigma$ 值，执行以下操作：\n  - 使用推导出的 $p(t)$ 动力学和显式欧拉法模拟富集轨迹 $p(t)$，并检测第一个满足 $p(t) \\ge p^\\star$ 的时间 $t$（如果这在 $T_{\\max}$ 内发生）。在最后一步中使用线性插值来精确估计到达时间。\n  - 使用您推导的公式计算闭式时间。\n  - 使用闭式时间作为测试套件的最终答案。\n- 如果对于给定的 $\\sigma$，对变体的选择不是有利的（即变体在频率空间中是中性选择或处于劣势），则将固定时间定义为 $-1.0$（一个表示模型中未发生固定的哨兵值）。\n\n测试套件（选择严谨性值）：\n- $\\sigma = 0.0$\n- $\\sigma = 0.1$\n- $\\sigma = 0.5$\n- $\\sigma = 1.0$\n- $\\sigma = 2.0$\n- $\\sigma = 5.0$\n\n输出规范：\n- 您的程序应生成一行输出，其中包含测试套件中从 $p_0$ 达到 $p^\\star$ 的闭式时间，按顺序排列，形式为用方括号括起的逗号分隔列表。\n- 时间必须四舍五入到3位小数，并以小时为单位报告。对于模型下不可能固定的情况，用精确的 $-1.0$（一位小数）代替时间。\n- 示例格式：`[t_1,t_2,t_3,t_4,t_5,t_6]`，其中每个 $t_i$ 都是如上指定的浮点数。\n\n您的解决方案必须普遍适用且自成一体，仅依赖于所述的数学和算法逻辑。程序没有外部输入；它必须在内部使用上面指定的测试套件。", "solution": "该问题要求推导连续培养系统中有益变体的种群动力学，并随后计算该变体达到指定频率所需的时间。我们将首先推导变体频率 $p(t)$ 的控制性常微分方程（ODE），并求解它以找到固定时间的闭式表达式。然后，我们将描述如何实现一个程序来为一组给定的参数计算这个时间。\n\n首先，我们推导有益变体频率 $p(t)$ 的微分方程。频率定义为：\n$$\np(t) = \\frac{x_v(t)}{x_v(t) + x_w(t)}\n$$\n其中 $x_v(t)$ 和 $x_w(t)$ 分别是变体和野生型谱系的绝对丰度。为了求出 $p(t)$ 的变化率，我们使用商法则对时间 $t$ 求导：\n$$\n\\frac{dp}{dt} = \\frac{\\frac{dx_v}{dt}(x_v + x_w) - x_v\\left(\\frac{dx_v}{dt} + \\frac{dx_w}{dt}\\right)}{(x_v + x_w)^2}\n$$\n问题陈述丰度遵循带稀释的指数增长：$\\frac{dx_i}{dt} = m_i(\\sigma) x_i$ 对 $i \\in \\{v, w\\}$ 成立，其中 $m_i(\\sigma)$ 是净马尔萨斯增长率。将这些表达式代入导数中得到：\n$$\n\\frac{dp}{dt} = \\frac{(m_v x_v)(x_v + x_w) - x_v(m_v x_v + m_w x_w)}{(x_v + x_w)^2}\n$$\n展开分子，我们发现：\n$$\nm_v x_v^2 + m_v x_v x_w - m_v x_v^2 - m_w x_v x_w = (m_v - m_w)x_v x_w\n$$\n因此，导数简化为：\n$$\n\\frac{dp}{dt} = (m_v - m_w) \\frac{x_v x_w}{(x_v + x_w)^2}\n$$\n我们可以将项 $\\frac{x_v x_w}{(x_v + x_w)^2}$ 表示为 $p$ 的函数。根据定义，$p = \\frac{x_v}{x_v + x_w}$ 且 $1 - p = \\frac{x_w}{x_v + x_w}$。因此，$p(1-p) = \\frac{x_v x_w}{(x_v + x_w)^2}$。这导出了著名的复制子方程：\n$$\n\\frac{dp}{dt} = (m_v - m_w) p(1-p)\n$$\n项 $s(\\sigma) = m_v - m_w$ 代表选择系数，即净增长率的差异。使用给定的表达式 $m_v(\\sigma) = r_v(\\sigma) - D$ 和 $m_w(\\sigma) = r_w(\\sigma) - D$，以及 $r_v(\\sigma) = r_0 + k\\sigma$ 和 $r_w(\\sigma) = r_0$，选择系数为：\n$$\ns(\\sigma) = (r_0 + k\\sigma - D) - (r_0 - D) = k\\sigma\n$$\n因此，控制变体频率的最终常微分方程为：\n$$\n\\frac{dp}{dt} = k\\sigma\\, p(1-p)\n$$\n接下来，我们求解此常微分方程，以找到频率从初始值 $p_0$ 增加到目标值 $p^\\star$ 所需的时间 $T$。该方程是可分离的：\n$$\n\\frac{dp}{p(1-p)} = k\\sigma\\, dt\n$$\n我们对两边从初始状态 $(t=0, p=p_0)$ 积分到最终状态 $(t=T, p=p^\\star)$：\n$$\n\\int_{p_0}^{p^\\star} \\frac{dp}{p(1-p)} = \\int_0^T k\\sigma\\, dt\n$$\n左边的积分通过部分分式分解来解决，其中 $\\frac{1}{p(1-p)} = \\frac{1}{p} + \\frac{1}{1-p}$。\n$$\n\\int_{p_0}^{p^\\star} \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = [\\ln(p) - \\ln(1-p)]_{p_0}^{p^\\star} = \\left[\\ln\\left(\\frac{p}{1-p}\\right)\\right]_{p_0}^{p^\\star}\n$$\n计算定积分得到：\n$$\n\\ln\\left(\\frac{p^\\star}{1-p^\\star}\\right) - \\ln\\left(\\frac{p_0}{1-p_0}\\right) = \\ln\\left(\\frac{p^\\star(1-p_0)}{p_0(1-p^\\star)}\\right)\n$$\n右边的积分就是 $k\\sigma T$。将两个结果相等并求解 $T$，得到固定时间的闭式表达式：\n$$\nT = \\frac{1}{k\\sigma} \\ln\\left(\\frac{p^\\star(1-p_0)}{p_0(1-p^\\star)}\\right)\n$$\n该公式仅在对变体的选择是有利的情况下有效，即 $s(\\sigma) = k\\sigma > 0$。由于 $k > 0$ 且 $\\sigma \\ge 0$，此条件简化为 $\\sigma > 0$。如果 $\\sigma=0$，选择系数为零，$\\frac{dp}{dt}=0$，频率保持在 $p_0$ 不变。在这种中性情况下，永远不会达到目标 $p^\\star$，对应于无限的固定时间。根据规定，我们将报告这种情况下的时间为 $-1.0$。\n\n待实现的程序将对测试套件中的每个 $\\sigma$ 值执行两项任务。首先，它使用推导出的闭式公式计算固定时间。其次，为了完整性和遵守问题要求，它使用步长为 $\\Delta t$ 的显式欧拉法对常微分方程 $\\frac{dp}{dt} = k\\sigma\\, p(1-p)$ 进行数值模拟。更新规则是 $p_{n+1} = p_n + \\Delta t \\cdot k\\sigma \\cdot p_n(1-p_n)$。模拟从 $p(0)=p_0$ 开始，直到 $p(t) \\ge p^\\star$ 为止，穿越时间通过线性插值进行精确化。然而，最终输出将仅包含根据解析公式计算并按规定四舍五入的时间。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the time to fixation for a beneficial variant\n    in a simplified PACEmid model. It computes the closed-form time for a suite of\n    selection stringencies and formats the output as specified.\n    \"\"\"\n    \n    # Define the parameters from the problem statement.\n    # Basal replication rate (per hour)\n    r0 = 0.6\n    # Selection gain coefficient (per hour per unit sigma)\n    k = 0.2\n    # Dilution rate (per hour)\n    D = 0.5\n    # Initial variant frequency (dimensionless)\n    p0 = 1e-4\n    # Fixation threshold (dimensionless)\n    p_star = 0.99\n    # Simulation integrator step size (hours)\n    dt = 0.01\n    # Maximum simulated time horizon (hours)\n    T_max = 10000\n\n    # Test suite of selection stringency values (dimensionless)\n    test_suite_sigmas = [0.0, 0.1, 0.5, 1.0, 2.0, 5.0]\n\n    # List to store the final results (closed-form times)\n    results = []\n\n    # Although the problem requires implementing the numerical simulation,\n    # the final output is based only on the closed-form solution.\n    # The numerical simulation serves as a verification of the analytical derivation.\n    # We will compute both as requested.\n    \n    for sigma in test_suite_sigmas:\n        # The selection coefficient in the frequency dynamics is s = k*sigma\n        selection_coefficient = k * sigma\n        \n        # Case 1: Favorable selection (s > 0)\n        if selection_coefficient > 0:\n            # (ii) Compute the closed-form time to fixation\n            # T = (1/(k*sigma)) * ln( (p_star*(1-p0)) / (p0*(1-p_star)) )\n            log_term_numerator = p_star * (1 - p0)\n            log_term_denominator = p0 * (1 - p_star)\n            closed_form_time = (1 / selection_coefficient) * np.log(log_term_numerator / log_term_denominator)\n            \n            # (i) Numerically simulate the trajectory using explicit Euler method\n            # This part is implemented as per the problem description but its result is not used in the final output.\n            p = p0\n            t = 0.0\n            time_steps = int(T_max / dt)\n            \n            numerical_time = -1.0 # Default value if threshold is not reached\n            found_crossing = False\n            for step in range(1, time_steps + 1):\n                p_prev = p\n                t_prev = t\n                \n                # Update frequency using explicit Euler for dp/dt = s * p * (1-p)\n                p = p + dt * selection_coefficient * p * (1 - p)\n                t = step * dt\n                \n                if p >= p_star:\n                    # Linearly interpolate to find the precise crossing time\n                    if (p - p_prev) > 0:\n                        t_cross = t_prev + dt * (p_star - p_prev) / (p - p_prev)\n                        numerical_time = t_cross\n                    else: # p == p_prev (or floating point issue), unlikely\n                        numerical_time = t\n                    found_crossing = True\n                    break\n            \n            # Append the analytical result to the list for output\n            results.append(closed_form_time)\n\n        # Case 2: Neutral or disadvantageous selection (s = 0)\n        else:\n            # Fixation is not possible, time is defined as -1.0\n            results.append(-1.0)\n\n    # Format the results for the final output string\n    # Times are rounded to 3 decimal places, or -1.0 for non-fixation cases.\n    output_list = []\n    for time_val in results:\n        if time_val == -1.0:\n            output_list.append(\"-1.0\")\n        else:\n            output_list.append(f\"{time_val:.3f}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(output_list)}]\")\n\n# Execute the main function to solve the problem and print the answer.\nsolve()\n```", "id": "2701202"}]}