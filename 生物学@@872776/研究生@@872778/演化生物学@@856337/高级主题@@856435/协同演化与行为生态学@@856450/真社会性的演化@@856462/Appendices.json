{"hands_on_practices": [{"introduction": "第一个练习将我们带入亲缘选择的基本逻辑。我们将运用内含适应性理论的基石——汉密尔顿法则，来分析一个单倍二倍性系统中的经典情景，判断一个导致利他性不育的等位基因能否扩散。这个练习阐明了当帮助近亲时，看似自我牺牲的行为如何在进化上变得有利。[@problem_id:2708185]", "problem": "一个单后制、单雄配制的单倍二倍性群体（一个蚁后，一次交配）产生的全同胞姐妹，她们的赖特亲缘关系系数为 $r=0.75$。考虑一个稀有、加性、弱选择的等位基因，该基因仅在杂合子雌性携带者中表达，并导致她们表现出不育的助手表型。假设该等位基因的表达导致行为者永久放弃 $C=1.2$ 个单位的预期终生个人繁殖量（以雌性繁殖等价单位衡量），同时通过帮助使其一个全同胞姐妹的预期终生繁殖量增加 $B=2.0$ 个单位。不存在额外的种群统计学或生态学反馈；所有效应都是边际和加性的；并且种群结构在其他方面是恒定的，因此亲缘关系 $r$ 捕捉了行为者和接受者之间同源共祖（IBD）的概率高于种群平均水平。\n\n使用广义适合度核算，计算一个等位基因携带者从独立繁殖转向不育和帮助时，贡献给下一代的IBD基因拷贝预期数量的净边际变化，给定值 $r=0.75$、$B=2.0$ 和 $C=1.2$。将此净变化报告为一个实数，四舍五入到四位有效数字。在你的推理过程中，指明这个符号意味着选择是有利于还是不利于该不育等位基因，并解释该符号在真社会性演化背景下的生物学意义。最终报告的数值必须是无单位的，且不包含任何解释性文字。", "solution": "恰当的基础是 Hamilton 的广义适合度框架，该框架将行为者表型对基因拷贝预期传递的影响分解为通过行为者自身繁殖产生的直接部分，以及通过对社会伙伴繁殖的影响产生的间接部分（按其亲缘关系系数加权）。形式上，在弱选择和加性条件下，基因频率的变化与广义适合度的变化成正比，广义适合度是行为者的直接适合度效应加上对接受者影响的亲缘关系加权和。\n\n定义 $r$ 为行为者与接受者之间的赖特亲缘关系系数，$B$ 为行为者的行为导致的接受者预期繁殖量的边际增加值，$C$ 为行为者因表现该行为而导致的自身预期繁殖量的边际减少值。当一个稀有等位基因的携带者从独立繁殖转向帮助单个接受者时，其经历的广义适合度变化是接受者中同源共祖（IBD）拷贝获得的间接收益减去行为者的直接损失。因此，贡献给下一代的IBD基因拷贝预期数量的净边际变化为\n$$\n\\Delta W_{I} \\;=\\; r\\,B \\;-\\; C.\n$$\n该表达式是通过将直接部分（损失 $C$）和间接部分（收益 $rB$）相加得出的，其中 $r$ 将接受者的收益换算为可归因于焦点等位基因的IBD基因拷贝。\n\n代入给定值 $r=0.75$、$B=2.0$ 和 $C=1.2$：\n$$\n\\Delta W_{I} \\;=\\; (0.75)\\times(2.0)\\;-\\;1.2 \\;=\\; 1.5 \\;-\\; 1.2 \\;=\\; 0.3.\n$$\n\n因为 $\\Delta W_{I} = 0.3 > 0$，符号为正。在弱选择下，一个正的 $\\Delta W_{I}$ 意味着选择有利于不育与帮助的表型：通过全同胞姐妹间接传递的同源共祖基因拷贝的预期数量（按 $r=0.75$ 加权）足以补偿行为者放弃的直接繁殖。从生物学上讲，这意味着在一个具有高姐妹间亲缘关系的单倍二倍性系统中，以 $C=1.2$ 的个人成本将姐妹的繁殖力提高 $B=2.0$ 的帮助行为可以受到青睐，这阐明了真社会性（伴随工蚁不育）可以演化的一条途径。\n\n最后，将数值四舍五入到四位有效数字：\n$$\n0.3 \\;\\to\\; 0.3000.\n$$", "answer": "$$\\boxed{0.3000}$$", "id": "2708185"}, {"introduction": "在亲缘关系原则的基础上，本练习旨在探索真社会性群体内部可能出现的利益冲突。我们将研究“工蜂监管”现象，即工蜂阻止彼此繁殖。通过推导蜂后交配频率的临界阈值，您将理解群体层面的特征如何塑造个体层面的选择压力并解决内部冲突。[@problem_id:2708209]", "problem": "考虑一种单倍二倍性真社会性昆虫，其蜂王与 $m$ 个不同且无亲缘关系的雄性交配。假设工蜂中的父系关系在 $m$ 个雄性中平均分配，不存在近亲繁殖，且任何产卵的工蜂来自任一父系的可能性均等。雄性由未受精的卵发育而来，是单倍体；雌性由受精卵发育而来，是二倍体。定义行为者和接受者之间的遗传相关度 $r$ 为：相对于群体基线，从接受者中随机选择一个基因拷贝与从行为者中随机选择一个基因拷贝是同源（identical by descent）的概率。\n\n工蜂可能会监管工蜂产下的卵。忽略任何直接成本或群体层面的效率影响，假设对工蜂监管的选择完全取决于一个焦点工蜂与其蜂王之子（她的兄弟）的平均相关度是否高于其与其他工蜂所产之子（她的外甥）的平均相关度。仅使用上述遗传规则和相关度的定义，并且不使用任何预先推导的亲缘关系捷径，完成以下任务：\n\n1. 推导焦点工蜂与随机选择的一个兄弟（蜂王所产的雄性）之间的相关度。\n2. 在给定 $m$ 和所述假设的情况下，推导焦点工蜂与随机选择的一个外甥（工蜂所产的雄性）之间的相关度，该相关度需对甥侄的母亲是焦点工蜂的全姐妹还是半姐妹进行平均。\n3. 通过比较这两种相关度，求出蜂王交配数阈值 $m^{*}$。当交配数超过此阈值时，根据此相关度标准，焦点工蜂与其兄弟的平均相关度高于其与外甥的平均相关度，从而使工蜂监管行为受到青睐。\n\n将 $m^{*}$ 的最终答案表示为一个无单位的精确整数。", "solution": "该问题要求推导蜂王交配数 $m$ 的一个阈值，该阈值决定了在特定的相关度标准下，工蜂对工蜂所产卵的监管行为是否受到青睐。此分析必须从单倍二倍性系统遗传的第一性原理出发，并严格遵守所给出的相关度定义。该系统是单倍二倍性的，雌性为二倍体，雄性为单倍体。蜂王与 $m$ 个不同且无亲缘关系的雄性交配。\n\n行为者与接受者之间的相关度 $r$ 定义为：从接受者中随机选择一个基因拷贝与从行为者中随机选择一个基因拷贝是同源（IBD）的概率。我们必须比较焦点工蜂与其兄弟（蜂王所产的雄性）的相关度，以及她与外甥（工蜂所产的雄性）的平均相关度。\n\n设 W 为焦点工蜂（二倍体行为者），B 为其兄弟（单倍体接受者），N 为其外甥（单倍体接受者）。蜂王记为 Q，蜂王的配偶（父本）记为 $F_i$。\n\n首先，我们推导工蜂对其兄弟的相关度 $r_{W \\rightarrow B}$。\n兄弟 B 是蜂王的儿子，由未受精的卵发育而来。因此，他的整个单倍体基因组是蜂王两套同源染色体中一套的随机样本。设 $g_B$ 是从 B 中随机选择的一个基因；该基因来自 Q。\n工蜂 W 是二倍体。从她身上随机选择的一个基因 $g_W$，有 $\\frac{1}{2}$ 的概率来自蜂王，有 $\\frac{1}{2}$ 的概率来自其父本。\n为了计算 $r_{W \\rightarrow B}$，我们计算 $g_W$ 和 $g_B$ 是同源的概率。我们对 $g_W$ 的可能来源进行概率求和：\n$1$. 基因 $g_W$ 来自蜂王。这种情况发生的概率为 $\\frac{1}{2}$。在这种情况下，$g_W$ 和 $g_B$ 都是从蜂王的二倍体基因组中随机抽取的。假设蜂王没有近亲繁殖，这两个基因是同源的概率为 $\\frac{1}{2}$。此路径对总相关度的贡献是 $\\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n$2$. 基因 $g_W$ 来自父本。这种情况发生的概率为 $\\frac{1}{2}$。兄弟的基因 $g_B$ 来自蜂王。由于蜂王和她的配偶没有亲缘关系，工蜂体内的父源基因与来自蜂王的基因同源的概率为 $0$。此路径的贡献是 $\\frac{1}{2} \\times 0 = 0$。\n总相关度是这些互斥路径的概率之和：\n$$r_{W \\rightarrow B} = \\frac{1}{4} + 0 = \\frac{1}{4}$$\n\n其次，我们推导工蜂对其外甥的相关度 $r_{W \\rightarrow N}$。\n外甥 N 是另一个工蜂（我们称之为 W'）的单倍体儿子。因为 N 是由 W' 的未受精卵发育而来，所以他的基因组与 W' 两套基因中的一套完全相同。这意味着焦点工蜂 W 对其外甥 N 的相关度等于她对外甥母亲 W' 的相关度。\n$$r_{W \\rightarrow N} = r_{W \\rightarrow W'}$$\n问题指出，产卵的工蜂 W' 是从群体中随机选择的。焦点工蜂 W 和另一个工蜂 W' 共享同一个母亲 Q。如果她们也共享同一个父亲，她们就是全姐妹；如果她们的父亲不同，她们就是半姐妹。在有 $m$ 个雄性和父权均等的情况下，W' 与 W 有相同父亲的概率是 $\\frac{1}{m}$。W' 有不同父亲的概率是 $\\frac{m-1}{m}$。\n因此，平均相关度 $r_{W \\rightarrow W'}$ 是一个加权平均值：\n$$r_{W \\rightarrow W'} = \\left(\\frac{1}{m}\\right) r_{\\text{full-sis}} + \\left(\\frac{m-1}{m}\\right) r_{\\text{half-sis}}$$\n我们必须计算全姐妹和半姐妹的相关度。\n对于共享母亲 Q 和父亲 F 的全姐妹，其相关度 $r_{\\text{full-sis}}$ 的计算方法是从 W 和 W' 中各随机抽取一个基因。\n- 如果来自 W 的基因是母源的（来自 Q，概率为 $\\frac{1}{2}$），它与来自 W' 的随机基因同源的概率为 $\\frac{1}{4}$（如姐妹-兄弟计算所示，这是通过母亲与同胞的相关度）。此路径贡献了 $\\frac{1}{2} \\times \\frac{1}{4} = \\frac{1}{8}$。\n- 如果来自 W 的基因是父源的（来自 F，概率为 $\\frac{1}{2}$），我们将其与来自 W' 的随机基因进行比较。来自 W' 的这个基因有 $\\frac{1}{2}$ 的概率是母源的（IBD 概率为 $0$），有 $\\frac{1}{2}$ 的概率是父源的。如果是父源的，两个基因都来自同一个单倍体父亲 F，因此它们同源的概率为 $1$。此路径贡献了 $\\frac{1}{2} \\times (\\frac{1}{2} \\times 1) = \\frac{1}{4}$。\n所以，$r_{\\text{full-sis}} = \\frac{1}{8} + \\frac{1}{4} = \\frac{3}{8}$。\n对于共享母亲 Q 但父亲不同且无亲缘关系的 $F_1$ 和 $F_2$ 的半姐妹，计算方法类似。\n- 母源路径是相同的，对相关度的贡献为 $\\frac{1}{8}$。\n- 父源路径涉及来自无亲缘关系父亲的基因，所以它们的 IBD 概率为 $0$。此路径贡献为 $0$。\n所以，$r_{\\text{half-sis}} = \\frac{1}{8} + 0 = \\frac{1}{8}$。\n现在我们可以计算与外甥的平均相关度：\n$$r_{W \\rightarrow N} = \\left(\\frac{1}{m}\\right) \\left(\\frac{3}{8}\\right) + \\left(\\frac{m-1}{m}\\right) \\left(\\frac{1}{8}\\right) = \\frac{3 + m - 1}{8m} = \\frac{m+2}{8m}$$\n\n第三，我们求出使监管行为受到青睐的蜂王交配数阈值 $m^{*}$。这种情况发生在与兄弟的相关度大于与外甥的平均相关度时。\n$$r_{W \\rightarrow B} > r_{W \\rightarrow N}$$\n代入推导出的表达式：\n$$\\frac{1}{4} > \\frac{m+2}{8m}$$\n因为 $m$ 是交配数，$m \\ge 1$；因此 $8m$ 是一个正值。我们可以在不等式两边同乘以 $8m$ 而不改变其方向：\n$$2m > m+2$$\n两边同时减去 $m$ 得到条件：\n$$m > 2$$\n这个不等式表明，当蜂王与超过 2 个雄性交配时，根据相关度标准，工蜂监管行为会受到青睐。因此，阈值 $m^{*}$ 是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2708209"}, {"introduction": "虽然亲缘选择为真社会性提供了强有力的遗传学解释，但生态因素同样至关重要。最后一个练习将我们的焦点转移到人口学模型，将真社会性的演化构建为一个生活史的权衡。通过比较独居和群居策略的终身繁殖成功率，我们将确定有利于复杂社会出现的生态条件，例如死亡风险和抚育者效率。[@problem_id:2708160]", "problem": "一只单倍二倍性昆虫的创始雌性在种群建立初期可以采取两种生活史策略之一。在独居策略中，她从一开始就以恒定速率 $\\lambda$（单位时间的后代数量）只产下繁殖型后代，直到死亡。在真社会性策略中，她首先在时间 $t=0$ 时产下 $n$ 个工蜂型后代，并且在这些工蜂经过固定的发育时间 $D>0$ 后开始发挥作用之前，不产下任何繁殖型后代；此后，协助者会供养蜂后，使其繁殖型后代的生产速率变为 $\\lambda\\,(1+b\\,n)$，其中 $b>0$ 是一个常数。假设：\n- 在两种策略中，蜂后的死亡率都是无记忆且密度无关的，具有恒定的风险率 $h>0$。因此，生存函数为 $S(t)=\\exp(-h\\,t)$。\n- 工蜂的生产（产卵和卵分配）发生的时间尺度与 $D$ 相比可以忽略不计，因此对于任何 $n$，工蜂开始发挥作用的延迟时间都是固定的 $D$。\n- 工蜂不直接改变蜂后的死亡风险；它们唯一的作用是在时间 $D$ 之后，通过乘法因子 $(1+b\\,n)$ 增加蜂后的繁殖率。\n\n将一个策略的预期终身繁殖成功率 (LRS) 定义为蜂后在其一生中产生的繁殖型后代的预期总数，即 $\\mathrm{LRS}=\\int_{0}^{\\infty}\\lambda(t)\\,S(t)\\,dt$，其中 $\\lambda(t)$ 是该策略下繁殖型后代的时间依赖性生产速率。\n\n1. 仅使用上述假设和预期终身繁殖成功率的定义，推导独居策略的预期终身繁殖成功率 $\\mathrm{LRS}_{\\mathrm{sol}}$ 和有 $n$ 个协助者的真社会性策略的预期终身繁殖成功率 $\\mathrm{LRS}_{\\mathrm{eus}}(n)$ 的闭式表达式。\n2. 通过比较 $\\mathrm{LRS}_{\\mathrm{eus}}(n)$ 和 $\\mathrm{LRS}_{\\mathrm{sol}}$，确定在边界 $\\mathrm{LRS}_{\\mathrm{eus}}(n^{\\ast})=\\mathrm{LRS}_{\\mathrm{sol}}$ 上的协助者确切阈值数量 $n^{\\ast}$（视为一个实值决策变量）。用 $h$、$D$ 和 $b$ 表示 $n^{\\ast}$，给出一个单一的闭式解析表达式作为最终答案。\n3. 用一句话简要解释有利于真社会性的区域与 $n^{\\ast}$ 之间的关系。\n\n你的最终答案应该是 $n^{\\ast}$ 的精确符号表达式。不要计算任何数值近似值。最终答案中不要包含单位。", "solution": "该问题要求推导两种不同繁殖策略——独居策略和真社会性策略——的预期终身繁殖成功率 (LRS)，并确定一个协助者数量的临界阈值，在该阈值下，真社会性策略等同于独居策略。分析必须基于所提供的定义和假设进行。\n\n预期终身繁殖成功率定义为 $\\mathrm{LRS} = \\int_{0}^{\\infty} \\lambda(t) S(t) dt$，其中 $\\lambda(t)$ 是繁殖型后代的时间依赖性生产速率，而 $S(t)$ 是蜂后的生存函数。生存函数给定为 $S(t) = \\exp(-ht)$，其中 $h > 0$ 是恒定的死亡风险率。\n\n首先，我们推导独居策略的 LRS 表达式，记为 $\\mathrm{LRS}_{\\mathrm{sol}}$。\n对于独居策略，蜂后从时间 $t=0$ 开始以恒定速率 $\\lambda$ 产下繁殖型后代。因此，速率函数为 $\\lambda_{\\mathrm{sol}}(t) = \\lambda$，对于所有 $t \\ge 0$。\n通过将这些函数代入定义积分来计算 LRS：\n$$\n\\mathrm{LRS}_{\\mathrm{sol}} = \\int_{0}^{\\infty} \\lambda \\exp(-ht) dt\n$$\n常数 $\\lambda$ 可以移到积分外。该积分为一个标准的指数积分：\n$$\n\\mathrm{LRS}_{\\mathrm{sol}} = \\lambda \\int_{0}^{\\infty} \\exp(-ht) dt = \\lambda \\left[ -\\frac{1}{h} \\exp(-ht) \\right]_{0}^{\\infty}\n$$\n在积分上下限处对表达式求值：\n$$\n\\mathrm{LRS}_{\\mathrm{sol}} = \\lambda \\left( \\lim_{t \\to \\infty} \\left(-\\frac{1}{h} \\exp(-ht)\\right) - \\left(-\\frac{1}{h} \\exp(-h \\cdot 0)\\right) \\right)\n$$\n由于 $h > 0$，极限项的值为 $0$。第二项变为 $-\\frac{1}{h} \\exp(0) = -\\frac{1}{h}$。\n$$\n\\mathrm{LRS}_{\\mathrm{sol}} = \\lambda \\left( 0 - \\left(-\\frac{1}{h}\\right) \\right) = \\frac{\\lambda}{h}\n$$\n这就是独居策略的终身繁殖成功率的闭式表达式。\n\n接下来，我们推导有 $n$ 个协助者的真社会性策略的 LRS 表达式，记为 $\\mathrm{LRS}_{\\mathrm{eus}}(n)$。\n对于真社会性策略，蜂后的繁殖产出是延迟的。在时间区间 $0 \\le t  D$ 内，蜂后只生产工蜂型后代，因此繁殖型后代的生产速率为 $\\lambda_{\\mathrm{eus}}(t) = 0$。对于时间 $t \\ge D$，在工蜂成熟后，蜂后的繁殖速率提高到 $\\lambda_{\\mathrm{eus}}(t) = \\lambda(1+bn)$。\nLRS 积分必须根据这两个时间区间分成两部分：\n$$\n\\mathrm{LRS}_{\\mathrm{eus}}(n) = \\int_{0}^{D} \\lambda_{\\mathrm{eus}}(t) S(t) dt + \\int_{D}^{\\infty} \\lambda_{\\mathrm{eus}}(t) S(t) dt\n$$\n代入分段定义的速率函数 $\\lambda_{\\mathrm{eus}}(t)$ 和生存函数 $S(t) = \\exp(-ht)$：\n$$\n\\mathrm{LRS}_{\\mathrm{eus}}(n) = \\int_{0}^{D} 0 \\cdot \\exp(-ht) dt + \\int_{D}^{\\infty} \\lambda(1+bn) \\exp(-ht) dt\n$$\n第一个积分为 $0$。第二个积分为：\n$$\n\\mathrm{LRS}_{\\mathrm{eus}}(n) = \\lambda(1+bn) \\int_{D}^{\\infty} \\exp(-ht) dt\n$$\n我们计算这个积分：\n$$\n\\mathrm{LRS}_{\\mathrm{eus}}(n) = \\lambda(1+bn) \\left[ -\\frac{1}{h} \\exp(-ht) \\right]_{D}^{\\infty}\n$$\n$$\n\\mathrm{LRS}_{\\mathrm{eus}}(n) = \\lambda(1+bn) \\left( \\lim_{t \\to \\infty} \\left(-\\frac{1}{h} \\exp(-ht)\\right) - \\left(-\\frac{1}{h} \\exp(-hD)\\right) \\right)\n$$\n同样，极限为 $0$。表达式简化为：\n$$\n\\mathrm{LRS}_{\\mathrm{eus}}(n) = \\lambda(1+bn) \\left( 0 - \\left(-\\frac{1}{h} \\exp(-hD)\\right) \\right) = \\frac{\\lambda(1+bn)\\exp(-hD)}{h}\n$$\n这就是真社会性策略的终身繁殖成功率的闭式表达式。\n\n现在，我们确定协助者的阈值数量 $n^{\\ast}$，在该值下两种策略产生相等的适应度结果，即 $\\mathrm{LRS}_{\\mathrm{eus}}(n^{\\ast}) = \\mathrm{LRS}_{\\mathrm{sol}}$。\n我们将两个推导出的表达式设为相等：\n$$\n\\frac{\\lambda(1+bn^{\\ast})\\exp(-hD)}{h} = \\frac{\\lambda}{h}\n$$\n由于问题陈述 $\\lambda > 0$ 和 $h > 0$，我们可以从等式两边消去项 $\\frac{\\lambda}{h}$ 而不失一般性：\n$$\n(1+bn^{\\ast})\\exp(-hD) = 1\n$$\n我们求解这个关于 $n^{\\ast}$ 的方程。首先，分离出包含 $n^{\\ast}$ 的项：\n$$\n1+bn^{\\ast} = \\frac{1}{\\exp(-hD)} = \\exp(hD)\n$$\n接下来，两边都减去 $1$：\n$$\nbn^{\\ast} = \\exp(hD) - 1\n$$\n最后，由于 $b > 0$，我们可以除以 $b$ 来得到 $n^{\\ast}$ 的表达式：\n$$\nn^{\\ast} = \\frac{\\exp(hD) - 1}{b}\n$$\n这就是所要求的协助者阈值数量。\n\n对于第三部分，关于有利于真社会性的区域的解释，我们比较 $\\mathrm{LRS}_{\\mathrm{eus}}(n)$ 和 $\\mathrm{LRS}_{\\mathrm{sol}}$。当 $\\mathrm{LRS}_{\\mathrm{eus}}(n) > \\mathrm{LRS}_{\\mathrm{sol}}$ 时，真社会性策略更有利。代入表达式并如前简化，该不等式变为 $n > n^{\\ast}$。因此，只要协助者的数量 $n$ 大于阈值 $n^{\\ast}$，真社会性策略就比独居策略更有利。", "answer": "$$\n\\boxed{\\frac{\\exp(hD) - 1}{b}}\n$$", "id": "2708160"}]}