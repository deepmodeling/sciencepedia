{"hands_on_practices": [{"introduction": "洛特卡-沃尔泰拉（Lotka-Volterra）模型是理解种群动态的基础工具。在研究协同进化之前，我们必须首先理解允许互利共生物种稳定共存的生态条件。这项练习 [@problem_id:2738742] 将演示如何找到平衡种群数量，以及至关重要的、防止“失控增长”的条件，从而将互利共生的强度与生态稳定性联系起来。", "problem": "考虑两种互利共生的物种，$A$ 和 $B$，其生态种群动态的时间尺度比其相互作用性状的进化要快。假设每个物种的人均增长遵循密度依赖性（逻辑斯谛调控），并通过线性互利效应（理论生态学中用于弱互利共生的广泛基线）随伙伴物种的密度增加而增加。用 $N_A$ 和 $N_B$ 表示丰度，用 $r_A$ 和 $r_B$ 表示内禀增长率，用 $K_A$ 和 $K_B$ 表示环境承载力，用人均互利相互作用系数 $a$（$B$ 对 $A$ 的影响）和 $b$（$A$ 对 $B$ 的影响）表示。耦合的常微分方程（ODE）为\n$$\n\\frac{dN_A}{dt} \\;=\\; r_A\\,N_A\\left(1 - \\frac{N_A}{K_A} + a\\,N_B\\right), \n\\qquad\n\\frac{dN_B}{dt} \\;=\\; r_B\\,N_B\\left(1 - \\frac{N_B}{K_B} + b\\,N_A\\right).\n$$\n从确定性种群动态中的平衡定义以及上述系统中密度依赖和互利贡献的结构出发，解析地推导出内部平衡点 $(N_A^{*},N_B^{*})$（两个分量均严格为正），用 $K_A$、$K_B$、$a$ 和 $b$ 表示，并说明在线性互利共生情况下该平衡点可行（为正且有限）的参数条件。然后，在 $r_A=r_B=1$、$K_A=K_B=100$ 和 $a=b=0.005$ 的条件下，评估您的表达式，并计算 $(N_A^{*},N_B^{*})$ 的数值。最后，根据线性互利共生假设，判断您找到的平衡点在有界（无失控增长）和为正的意义上是否生物学上合理。以个体的绝对数量报告平衡丰度。对于这组参数，无需四舍五入。", "solution": "所提出的问题是理论种群动态中的一个标准练习。它具有科学依据，问题明确且客观。它描述了一个经典的 Lotka-Volterra 模型，用于两个具有线性相互作用项和逻辑斯谛自我调控的互利共生物种。任务是找到内部平衡点，确定其可行性条件，并为一组给定的参数计算其值。问题的所有组成部分都是标准的、可形式化的。我将开始解题。\n\n种群动态由以下耦合常微分方程控制：\n$$\n\\frac{dN_A}{dt} = r_A N_A\\left(1 - \\frac{N_A}{K_A} + a N_B\\right)\n$$\n$$\n\\frac{dN_B}{dt} = r_B N_B\\left(1 - \\frac{N_B}{K_B} + b N_A\\right)\n$$\n平衡点，记作 $(N_A^{*}, N_B^{*})$，被定义为种群丰度不随时间变化的状态。在数学上，这对应于时间导数为零的条件：\n$$\n\\frac{dN_A}{dt} = 0 \\quad \\text{和} \\quad \\frac{dN_B}{dt} = 0\n$$\n该系统在 $(0,0)$、$(K_A, 0)$ 和 $(0, K_B)$ 处有平凡和半平凡平衡点。我们的任务是找到内部平衡点，为此需要 $N_A^{*}  0$ 和 $N_B^{*}  0$。要使之成立，括号内的表达式必须等于零，因为 $r_A, r_B, N_A, N_B$ 均为正。这为平衡丰度 $N_A^{*}$ 和 $N_B^{*}$ 产生了一个由两个线性方程组成的方程组：\n$$\n1 - \\frac{N_A^{*}}{K_A} + a N_B^{*} = 0\n$$\n$$\n1 - \\frac{N_B^{*}}{K_B} + b N_A^{*} = 0\n$$\n这些分别是物种 $A$ 和物种 $B$ 的零增长等斜线方程。为了解出 $(N_A^{*}, N_B^{*})$，我们可以重排这个方程组：\n$$\n\\frac{1}{K_A} N_A^{*} - a N_B^{*} = -1\n$$\n$$\n-b N_A^{*} + \\frac{1}{K_B} N_B^{*} = -1\n$$\n将两个方程的右边变为正1，我们得到：\n$$\n-\\frac{1}{K_A} N_A^{*} + a N_B^{*} = 1\n$$\n$$\nb N_A^{*} - \\frac{1}{K_B} N_B^{*} = 1\n$$\n我们可以用多种方法解这个方程组。使用代入法，从第二个原始方程中，我们将 $N_B^{*}$ 表示为 $N_A^{*}$ 的函数：\n$$\n1 - \\frac{N_B^{*}}{K_B} + b N_A^{*} = 0 \\implies \\frac{N_B^{*}}{K_B} = 1 + b N_A^{*} \\implies N_B^{*} = K_B (1 + b N_A^{*})\n$$\n将 $N_B^{*}$ 的这个表达式代入第一个原始方程：\n$$\n1 - \\frac{N_A^{*}}{K_A} + a [K_B (1 + b N_A^{*})] = 0\n$$\n展开并重排以解出 $N_A^{*}$:\n$$\n1 - \\frac{N_A^{*}}{K_A} + a K_B + abK_B N_A^{*} = 0\n$$\n$$\n1 + a K_B = \\frac{N_A^{*}}{K_A} - abK_B N_A^{*}\n$$\n$$\n1 + a K_B = N_A^{*} \\left(\\frac{1}{K_A} - abK_B\\right)\n$$\n$$\n1 + a K_B = N_A^{*} \\left(\\frac{1 - abK_A K_B}{K_A}\\right)\n$$\n解出 $N_A^{*}$ 得到：\n$$\nN_A^{*} = \\frac{K_A (1 + a K_B)}{1 - a b K_A K_B}\n$$\n根据原始方程的对称性，通过交换下标 $A$ 和 $B$ 以及系数 $a$ 和 $b$，可以得到 $N_B^{*}$ 的表达式：\n$$\nN_B^{*} = \\frac{K_B (1 + b K_A)}{1 - a b K_A K_B}\n$$\n问题要求该平衡点可行的条件，这意味着它必须是正的（$N_A^{*}  0, N_B^{*}  0$）且有限的。\n根据其生物学定义，参数 $K_A, K_B, a, b$ 均为正。因此，$N_A^{*}$ 和 $N_B^{*}$ 表达式的分子总是正的：$K_A (1 + a K_B)  0$ 和 $K_B (1 + b K_A)  0$。\n因此，平衡点的正性和有限性完全取决于共同的分母 $1 - a b K_A K_B$。为了使平衡点为正且有明确定义（不是无限大），分母必须严格为正：\n$$\n1 - a b K_A K_B  0\n$$\n这导出了该模型中稳定、有界互利共生的关键条件：\n$$\na b K_A K_B  1\n$$\n如果违反此条件（$a b K_A K_B \\ge 1$），则互利反馈过强，种内竞争无法调节种群，导致无限增长。问题中将此称为“失控增长”，这使得该平衡点在生物学上是不合理的。因此，条件 $a b K_A K_B  1$ 是一个合理的、有界的、正的平衡点的条件。\n\n接下来，我们为给定的参数集计算平衡丰度：$r_A=1$, $r_B=1$, $K_A=100$, $K_B=100$, $a=0.005$ 及 $b=0.005$。内禀增长率 $r_A$ 和 $r_B$ 不影响平衡点的值，只影响达到平衡点的时间尺度。\n首先，我们检查可行性条件：\n$$\na b K_A K_B = (0.005)(0.005)(100)(100) = (25 \\times 10^{-6})(1 \\times 10^4) = 25 \\times 10^{-2} = 0.25\n$$\n由于 $0.25  1$，该条件得到满足，存在一个可行的、生物学上合理的平衡点。\n现在我们计算 $N_A^{*}$ 和 $N_B^{*}$ 的数值：\n由于参数的对称性（$K_A=K_B$ 和 $a=b$），我们预计 $N_A^{*} = N_B^{*}$。我们计算 $N_A^{*}$：\n$$\nN_A^{*} = \\frac{K_A (1 + a K_B)}{1 - a b K_A K_B} = \\frac{100 (1 + (0.005)(100))}{1 - 0.25}\n$$\n$$\nN_A^{*} = \\frac{100 (1 + 0.5)}{0.75} = \\frac{100(1.5)}{0.75} = \\frac{150}{0.75} = \\frac{150}{3/4} = 150 \\times \\frac{4}{3} = 200\n$$\n正如由于对称性所预期的，$N_B^{*}$ 将具有相同的值：\n$$\nN_B^{*} = \\frac{K_B (1 + b K_A)}{1 - a b K_A K_B} = \\frac{100 (1 + (0.005)(100))}{1 - 0.25} = 200\n$$\n内部平衡点位于 $(N_A^{*}, N_B^{*}) = (200, 200)$。这些值是正的且有限的，证实了在给定参数下，根据模型的假设，该平衡点在生物学上是合理的。互利共生的存在使得两个种群都超过了它们各自的环境承载力。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n200  200\n\\end{pmatrix}\n}\n$$", "id": "2738742"}, {"introduction": "现在我们将视角从生态稳定性转向进化稳定性，探讨一个互利共生的核心问题：为什么一方不会进化成“欺骗者”，即只索取利益而不付出成本？这项练习 [@problem_id:2738741] 探讨了一个关键的解决方案——伙伴惩罚机制。你将运用博弈论模型来计算合作者和欺骗者的适应度，从而确定合作在何种条件下是进化稳定的。", "problem": "考虑一个大的、充分混合的种群，该种群在两个物种之间进行两两互利共生，其中个体对伙伴投入精力。设原住民合作策略对其伙伴的投入水平为 $y^{\\ast}$。一个稀有的突变“欺骗者”将其投入减少到 $y^{\\ast}-\\Delta y$，其中 $\\Delta y0$。投入对行为者产生线性成本，每单位精力的成本为 $c$，而焦点个体的收益等于其伙伴投入给它的总精力。伙伴采用带侦测的惩罚机制：如果一个个体偏离原住民水平 $y^{\\ast}$ 的量为 $\\Delta y$，其伙伴会减少对它的投入，减少量与偏离量成正比，比例系数为惩罚强度 $s$ 与侦测概率 $q$ 的乘积。具体来说，如果焦点个体投入 $y_{i}$，而原住民规范为 $y^{\\ast}$，那么它从伙伴处获得的投入为 $y^{\\ast}-s\\,q\\,(y^{\\ast}-y_{i})$。\n\n假设种群在其他方面在 $y^{\\ast}$ 处是单态的，并且一个稀有突变体的命运取决于其适应度是否超过原住民策略的适应度，其中适应度是（从伙伴处获得的投入）减去（焦点个体自身投入的成本）。仅使用上述定义和“稀有突变体入侵当且仅当其相对于原住民的适应度优势为正”的原则，计算当参数值为 $c=0.2$, $\\Delta y=0.5$, $s=0.6$, $q=0.7$ 时，欺骗者的适应度优势（欺骗者适应度减去原住民适应度），并以单个实数表示。正值表示欺骗者可能入侵；负值表示欺骗者被选择淘汰。请以单个无量纲数报告您的最终答案。无需四舍五入；提供由这些数字所隐含的精确值。", "solution": "问题要求计算在一个两两互利共生模型中，一个稀有的“欺骗者”突变体相对于一个原住民合作者的适应度优势。在继续之前，我们必须首先验证问题的有效性。\n\n第1步：提取已知条件。\n- 原住民合作策略投入的精力水平为 $y^{\\ast}$。\n- 一个稀有的突变欺骗者投入 $y^{\\ast}-\\Delta y$，其中 $\\Delta y0$。\n- 投入的成本是线性的，系数为 $c$。一个个体投入 $y$ 的成本是 $c \\cdot y$。\n- 焦点个体的收益是其伙伴投入给它的总精力。\n- 如果一个焦点个体投入 $y_i$，它从伙伴处获得的投入是 $y^{\\ast}-s\\,q\\,(y^{\\ast}-y_{i})$，其中 $s$ 是惩罚强度，$q$ 是侦测概率。\n- 适应度定义为（从伙伴处获得的投入）减去（焦点个体自身投入的成本）。\n- 一个稀有突变体入侵，如果其相对于原住民的适应度优势为正。\n- 给定的参数值为 $c=0.2$, $\\Delta y=0.5$, $s=0.6$, $q=0.7$。\n\n第2步：使用提取的已知条件进行验证。\n该问题陈述在演化博弈论和理论生物学领域具有科学依据。它提出了一个用于研究带有惩罚或制裁的合作演化的标准模型。语言精确客观。所有必要的定义和参数都已提供，可以计算出唯一且有意义的解。该问题是适定的、自洽的，并且没有违反任何数学或逻辑原则。在计算相对适应度优势时，未知的原住民投入水平 $y^{\\ast}$ 预计会消去，这是线性博弈论模型的一个共同特征。因此，该问题被认为是有效的。\n\n第3步：开始求解。\n我们首先形式化一个投入精力为 $y_i$ 的焦点个体的适应度函数 $W$。根据问题陈述，适应度是获得的收益减去产生的成本。\n收益是从伙伴处获得的投入，由表达式 $y^{\\ast}-s\\,q\\,(y^{\\ast}-y_i)$ 给出。\n成本是该个体自身投入的成本，由 $c\\,y_i$ 给出。\n因此，一般适应度函数是：\n$$W(y_i) = \\left( y^{\\ast}-s\\,q\\,(y^{\\ast}-y_i) \\right) - c\\,y_i$$\n\n接下来，我们计算一个原住民个体的适应度 $W_{res}$。一个原住民投入 $y_i = y^{\\ast}$。将此代入适应度函数：\n$$W_{res} = W(y^{\\ast}) = \\left( y^{\\ast}-s\\,q\\,(y^{\\ast}-y^{\\ast}) \\right) - c\\,y^{\\ast}$$\n$$W_{res} = \\left( y^{\\ast}-s\\,q\\,(0) \\right) - c\\,y^{\\ast}$$\n$$W_{res} = y^{\\ast} - c\\,y^{\\ast}$$\n这个结果是合乎逻辑的：一个原住民与其他原住民互动，获得标准投入 $y^{\\ast}$ 并支付标准成本 $c\\,y^{\\ast}$。\n\n现在，我们计算稀有欺骗者突变体的适应度 $W_{mut}$。欺骗者投入 $y_i = y^{\\ast}-\\Delta y$。将此代入适应度函数：\n$$W_{mut} = W(y^{\\ast}-\\Delta y) = \\left( y^{\\ast}-s\\,q\\,(y^{\\ast}-(y^{\\ast}-\\Delta y)) \\right) - c\\,(y^{\\ast}-\\Delta y)$$\n项 $(y^{\\ast}-(y^{\\ast}-\\Delta y))$ 简化为 $\\Delta y$。\n$$W_{mut} = \\left( y^{\\ast}-s\\,q\\,\\Delta y \\right) - c\\,(y^{\\ast}-\\Delta y)$$\n\n问题要求我们计算欺骗者的适应度优势 $\\Delta W$，其定义为突变体的适应度与原住民的适应度之差：$\\Delta W = W_{mut} - W_{res}$。\n$$\\Delta W = \\left( (y^{\\ast}-s\\,q\\,\\Delta y) - c\\,(y^{\\ast}-\\Delta y) \\right) - \\left( y^{\\ast} - c\\,y^{\\ast} \\right)$$\n我们展开各项并简化表达式：\n$$\\Delta W = y^{\\ast} - s\\,q\\,\\Delta y - c\\,y^{\\ast} + c\\,\\Delta y - y^{\\ast} + c\\,y^{\\ast}$$\n项 $+y^{\\ast}$ 和 $-y^{\\ast}$ 相互抵消。项 $-c\\,y^{\\ast}$ 和 $+c\\,y^{\\ast}$ 也相互抵消。剩下：\n$$\\Delta W = c\\,\\Delta y - s\\,q\\,\\Delta y$$\n这个表达式可以因式分解为：\n$$\\Delta W = \\Delta y (c - s\\,q)$$\n这个结果表明，适应度优势与基线投入水平 $y^{\\ast}$ 无关。$\\Delta W$ 的符号取决于减少投入所节省的成本（$c\\,\\Delta y$）与伙伴制裁所造成的损失（$s\\,q\\,\\Delta y$）之间的平衡。\n\n最后，我们将给定的数值参数代入 $\\Delta W$ 的表达式中：\n$c = 0.2$\n$\\Delta y = 0.5$\n$s = 0.6$\n$q = 0.7$\n$$\\Delta W = 0.5 \\times (0.2 - 0.6 \\times 0.7)$$\n$$\\Delta W = 0.5 \\times (0.2 - 0.42)$$\n$$\\Delta W = 0.5 \\times (-0.22)$$\n$$\\Delta W = -0.11$$\n适应度优势为负，这表明在这种条件下，欺骗者突变体被选择淘汰，无法入侵原住民种群。惩罚机制足够强大，足以维持合作策略。", "answer": "$$\\boxed{-0.11}$$", "id": "2738741"}, {"introduction": "理论模型固然强大，但我们需要有效的方法来衡量自然种群中的协同进化力量，从而弥合理论与实证研究之间的鸿沟。这项练习 [@problem_id:2738886] 介绍了兰德-阿诺德（Lande-Arnold）框架，这是一种量化自然选择的强大统计方法。通过这个练习，你将实践如何从性状和适应度数据中计算互惠选择梯度，这是任何实证进化生物学家都应具备的基本技能。", "problem": "给定两个一对一相互作用的互利共生物种的成对观测数据。对于每一对，你观测到它们的标准化性状和相对适合度。在 Lande–Arnold 选择分析框架中，定向选择梯度是通过使用普通最小二乘法 (OLS) 将相对适合度对标准化性状进行回归所获得的偏回归系数。在互利共演化中，交互选择由跨伙伴选择梯度来量化：即物种 B 的性状对物种 A 适合度的影响，反之亦然。你的任务是为多个数据集计算这些偏回归系数，并以跨伙伴系数的绝对值形式报告交互选择的强度。\n\n基本依据与假设：\n- 所有观测数据的性状被标准化为均值 $0$ 和标准差 $1$，使用样本标准差（除以 $n-1$）。\n- 相对适合度被缩放至均值为 $1$（标准相对适合度）。\n- 定向选择梯度定义为，在包含截距项的情况下，将相对适合度对一组标准化性状进行多元回归得到的偏回归系数。\n- 普通最小二乘法 (OLS) 提供唯一的系数 $\\hat{\\boldsymbol{\\beta}}$，该系数能最小化残差平方和，通过求解正规方程得到，并与线性模型的 Gauss–Markov 假设一致。\n\n数学形式化：\n- 对于物种 A，将 $w_A$ 对一个截距项和性状向量 $[z_A, z_B]$ 进行回归，以获得系数 $[\\alpha_A, \\beta_{AA}, \\beta_{AB}]$。B 对 A 的交互选择由 $\\beta_{AB}$ 量化。\n- 对于物种 B，将 $w_B$ 对一个截距项和性状向量 $[z_A, z_B]$ 进行回归，以获得系数 $[\\alpha_B, \\beta_{BA}, \\beta_{BB}]$。A 对 B 的交互选择由 $\\beta_{BA}$ 量化。\n- 使用 OLS，其中设计矩阵为 $X = [\\mathbf{1}, z_A, z_B]$（该矩阵包含一列全为 1 和两个性状列），响应向量为 $w_A$ 或 $w_B$。\n\n计算要求：\n- 对于下面的每个数据集，计算两种回归（针对 $w_A$ 和 $w_B$）的 OLS 系数。提取跨伙伴系数 $\\beta_{AB}$ 和 $\\beta_{BA}$。报告带符号的值，并将交互选择的强度解释为绝对值 $|\\beta_{AB}|$ 和 $|\\beta_{BA}|$。\n- 将所有报告的数字四舍五入到小数点后 4 位。\n\n测试套件（每个数据集都明确提供性状向量；适合度根据给定的线性模型确定性地生成，因此 OLS 会恢复出真实系数）：\n- 数据集 $1$ （一般正向交互选择）：\n  - $z_A = [-1, 0, 1]$\n  - $z_B = [-1, 1, 0]$\n  - $w_A = 1 + 0.4\\, z_B + 0.1\\, z_A$\n  - $w_B = 1 + 0.5\\, z_A + 0.05\\, z_B$\n- 数据集 $2$ （边界情况：零交互选择）：\n  - $z_A = [-1, 0, 1]$\n  - $z_B = [0, 1, -1]$\n  - $w_A = 1 + 0.3\\, z_A$\n  - $w_B = 1 - 0.2\\, z_B$\n- 数据集 $3$ （负向交互选择）：\n  - $z_A = [-1, 0, 1]$\n  - $z_B = [1, -1, 0]$\n  - $w_A = 1 - 0.35\\, z_B + 0.05\\, z_A$\n  - $w_B = 1 - 0.25\\, z_A + 0.02\\, z_B$\n- 数据集 $4$ （纯交互选择：仅有交叉效应）：\n  - $z_A = [-1, 0, 1]$\n  - $z_B = [0, -1, 1]$\n  - $w_A = 1 + 0.6\\, z_B$\n  - $w_B = 1 + 0.6\\, z_A$\n\n最终输出规范：\n- 对于每个数据集 $i$，生成四舍五入到 4 位小数的数对 $[\\beta_{AB}^{(i)}, \\beta_{BA}^{(i)}]$。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素是针对一个数据集的双元素列表，例如：$[[x_1,y_1],[x_2,y_2],\\dots]$。\n- 不涉及单位，所有角度或百分比均与此任务无关。\n\n你的程序必须是一个完整、可运行的脚本，使用 OLS 执行这些计算，并以指定的精确格式打印最后一行。不要从输入中读取数据；直接根据所提供的数据集进行计算。", "solution": "该问题陈述已经过严格验证，被认为具有科学依据、提法恰当且客观。它基于已建立的用于分析自然选择的 Lande-Arnold 框架，提出了一个明确的计算任务。所有必要的数据和定义均已提供，不存在内部矛盾或歧义。因此，该问题被视为有效，并将提供解决方案。\n\n目标是为四个代表两个物种 A 和 B 之间互利相互作用的不同数据集，计算交互选择梯度 $\\beta_{AB}$ 和 $\\beta_{BA}$。这些梯度量化了一个物种的性状对另一个物种适合度施加的定向选择。指定的方法是普通最小二乘法 (OLS) 多元回归。\n\n对于每个物种，我们将其相对适合度 $w$ 建模为一个截距项以及两个物种的标准化性状 $z_A$ 和 $z_B$ 的线性函数。物种 A 的模型是：\n$$\nw_A = \\alpha_A + \\beta_{AA} z_A + \\beta_{AB} z_B + \\epsilon_A\n$$\n物种 B 的模型是：\n$$\nw_B = \\alpha_B + \\beta_{BA} z_A + \\beta_{BB} z_B + \\epsilon_B\n$$\n这里，系数 $\\beta_{AB}$ 和 $\\beta_{BA}$ 是我们感兴趣的跨伙伴选择梯度。\n\nOLS 方法提供了一组唯一的系数估计值，用向量 $\\hat{\\boldsymbol{\\beta}}$ 表示，该估计值能够最小化残差平方和。这些系数通过求解正规方程得到：\n$$\n(X^T X) \\hat{\\boldsymbol{\\beta}} = X^T \\mathbf{y}\n$$\n其中 $\\mathbf{y}$ 是观测到的相对适合度值的向量，$X$ 是设计矩阵。其解由以下公式给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (X^T X)^{-1} X^T \\mathbf{y}\n$$\n前提是矩阵 $X^T X$ 是可逆的，如果 $X$ 的列是线性无关的，这个条件就成立。\n\n对于这个问题，$n$ 对个体的性状 $z_A$ 和 $z_B$ 的观测值是给定的。设计矩阵 $X$ 是通过为性状向量增加一列代表截距项的全 1 列来构建的。对于 $n$ 个观测值，$X$ 是一个 $n \\times 3$ 的矩阵：\n$$\nX = [\\mathbf{1} \\quad \\mathbf{z}_A \\quad \\mathbf{z}_B] = \\begin{pmatrix} 1  z_{A,1}  z_{B,1} \\\\ 1  z_{A,2}  z_{B,2} \\\\ \\vdots  \\vdots  \\vdots \\\\ 1  z_{A,n}  z_{B,n} \\end{pmatrix}\n$$\n估计系数的向量将是 $\\hat{\\boldsymbol{\\beta}} = [\\hat{\\alpha}, \\hat{\\beta}_1, \\hat{\\beta}_2]^T$。当将 $w_A$ 对性状进行回归时，得到的系数对应于 $[\\hat{\\alpha}_A, \\hat{\\beta}_{AA}, \\hat{\\beta}_{AB}]^T$。交互选择梯度是第三个元素 $\\beta_{AB}$。当对 $w_B$ 进行回归时，系数对应于 $[\\hat{\\alpha}_B, \\hat{\\beta}_{BA}, \\hat{\\beta}_{BB}]^T$。交互选择梯度是第二个元素 $\\beta_{BA}$。\n\n问题陈述中指出，性状 $z_A$ 和 $z_B$ 被标准化为均值为 $0$，样本标准差为 $1$。相对适合度值 $w_A$ 和 $w_B$ 是根据每个数据集指定的真实线性模型确定性地生成的。这意味着误差项 $\\epsilon_A$ 和 $\\epsilon_B$ 为零。因此，OLS 将能精确地恢复出真实系数，不受抽样误差的影响。\n\n让我们演示数据集 $1$ 的计算过程：\n给定：\n$z_A = [-1, 0, 1]^T$\n$z_B = [-1, 1, 0]^T$\n$w_A = 1 + 0.1 z_A + 0.4 z_B$\n$w_B = 1 + 0.5 z_A + 0.05 z_B$\n\n首先，我们构建设计矩阵 $X$ 和响应向量 $\\mathbf{y}_A$ 和 $\\mathbf{y}_B$。\n$$\nX = \\begin{pmatrix} 1  -1  -1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix}\n$$\n$$\n\\mathbf{y}_A = \\begin{pmatrix} 1 + 0.1(-1) + 0.4(-1) \\\\ 1 + 0.1(0) + 0.4(1) \\\\ 1 + 0.1(1) + 0.4(0) \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ 1.4 \\\\ 1.1 \\end{pmatrix}\n$$\n$$\n\\mathbf{y}_B = \\begin{pmatrix} 1 + 0.5(-1) + 0.05(-1) \\\\ 1 + 0.5(0) + 0.05(1) \\\\ 1 + 0.5(1) + 0.05(0) \\end{pmatrix} = \\begin{pmatrix} 0.45 \\\\ 1.05 \\\\ 1.50 \\end{pmatrix}\n$$\n接下来，我们计算 $X^T X$ 及其逆矩阵：\n$$\nX^T X = \\begin{pmatrix} 1  1  1 \\\\ -1  0  1 \\\\ -1  1  0 \\end{pmatrix} \\begin{pmatrix} 1  -1  -1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix} = \\begin{pmatrix} 3  0  0 \\\\ 0  2  1 \\\\ 0  1  2 \\end{pmatrix}\n$$\n$$\n(X^T X)^{-1} = \\frac{1}{3(4-1)} \\begin{pmatrix} 3  0  0 \\\\ 0  6  -3 \\\\ 0  -3  6 \\end{pmatrix} = \\begin{pmatrix} 1/3  0  0 \\\\ 0  2/3  -1/3 \\\\ 0  -1/3  2/3 \\end{pmatrix}\n$$\n现在，我们计算 $w_A$ 回归的系数：\n$$\nX^T \\mathbf{y}_A = \\begin{pmatrix} 1  1  1 \\\\ -1  0  1 \\\\ -1  1  0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.4 \\\\ 1.1 \\end{pmatrix} = \\begin{pmatrix} 3.0 \\\\ 0.6 \\\\ 0.9 \\end{pmatrix}\n$$\n$$\n\\hat{\\boldsymbol{\\beta}}_A = (X^T X)^{-1} (X^T \\mathbf{y}_A) = \\begin{pmatrix} 1/3  0  0 \\\\ 0  2/3  -1/3 \\\\ 0  -1/3  2/3 \\end{pmatrix} \\begin{pmatrix} 3.0 \\\\ 0.6 \\\\ 0.9 \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 0.1 \\\\ 0.4 \\end{pmatrix}\n$$\n系数向量为 $[\\hat{\\alpha}_A, \\hat{\\beta}_{AA}, \\hat{\\beta}_{AB}]^T = [1.0, 0.1, 0.4]^T$。因此，$\\beta_{AB} = 0.4$。\n\n类似地，对于 $w_B$ 的回归：\n$$\nX^T \\mathbf{y}_B = \\begin{pmatrix} 1  1  1 \\\\ -1  0  1 \\\\ -1  1  0 \\end{pmatrix} \\begin{pmatrix} 0.45 \\\\ 1.05 \\\\ 1.50 \\end{pmatrix} = \\begin{pmatrix} 3.0 \\\\ 1.05 \\\\ 0.6 \\end{pmatrix}\n$$\n$$\n\\hat{\\boldsymbol{\\beta}}_B = (X^T X)^{-1} (X^T \\mathbf{y}_B) = \\begin{pmatrix} 1/3  0  0 \\\\ 0  2/3  -1/3 \\\\ 0  -1/3  2/3 \\end{pmatrix} \\begin{pmatrix} 3.0 \\\\ 1.05 \\\\ 0.6 \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 0.5 \\\\ 0.05 \\end{pmatrix}\n$$\n系数向量为 $[\\hat{\\alpha}_B, \\hat{\\beta}_{BA}, \\hat{\\beta}_{BB}]^T = [1.0, 0.5, 0.05]^T$。因此，$\\beta_{BA} = 0.5$。\n数据集 $1$ 的交互选择梯度对是 $[0.4, 0.5]$。\n\n这一精确的流程被系统地应用于所有四个指定的数据集。实现过程将使用数值线性代数程序来高效且准确地执行这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for reciprocal selection gradients for four datasets using OLS regression.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"id\": 1,\n            \"z_A\": np.array([-1, 0, 1]),\n            \"z_B\": np.array([-1, 1, 0]),\n            \"w_A_coeffs\": {\"intercept\": 1, \"beta_AA\": 0.1, \"beta_AB\": 0.4},\n            \"w_B_coeffs\": {\"intercept\": 1, \"beta_BA\": 0.5, \"beta_BB\": 0.05},\n        },\n        {\n            \"id\": 2,\n            \"z_A\": np.array([-1, 0, 1]),\n            \"z_B\": np.array([0, 1, -1]),\n            \"w_A_coeffs\": {\"intercept\": 1, \"beta_AA\": 0.3, \"beta_AB\": 0.0},\n            \"w_B_coeffs\": {\"intercept\": 1, \"beta_BA\": 0.0, \"beta_BB\": -0.2},\n        },\n        {\n            \"id\": 3,\n            \"z_A\": np.array([-1, 0, 1]),\n            \"z_B\": np.array([1, -1, 0]),\n            \"w_A_coeffs\": {\"intercept\": 1, \"beta_AA\": 0.05, \"beta_AB\": -0.35},\n            \"w_B_coeffs\": {\"intercept\": 1, \"beta_BA\": -0.25, \"beta_BB\": 0.02},\n        },\n        {\n            \"id\": 4,\n            \"z_A\": np.array([-1, 0, 1]),\n            \"z_B\": np.array([0, -1, 1]),\n            \"w_A_coeffs\": {\"intercept\": 1, \"beta_AA\": 0.0, \"beta_AB\": 0.6},\n            \"w_B_coeffs\": {\"intercept\": 1, \"beta_BA\": 0.6, \"beta_BB\": 0.0},\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        z_A = case[\"z_A\"]\n        z_B = case[\"z_B\"]\n        w_A_coeffs = case[\"w_A_coeffs\"]\n        w_B_coeffs = case[\"w_B_coeffs\"]\n        \n        # Generate fitness vectors deterministically\n        w_A = w_A_coeffs[\"intercept\"] + w_A_coeffs[\"beta_AA\"] * z_A + w_A_coeffs[\"beta_AB\"] * z_B\n        w_B = w_B_coeffs[\"intercept\"] + w_B_coeffs[\"beta_BA\"] * z_A + w_B_coeffs[\"beta_BB\"] * z_B\n\n        # Construct the design matrix X\n        # Column of 1s for the intercept, followed by trait columns\n        n = len(z_A)\n        X = np.stack([np.ones(n), z_A, z_B], axis=1)\n\n        # Solve the normal equations: (X'X)B = X'y => B = solve(X'X, X'y)\n        # This is more numerically stable than computing the inverse of X'X.\n        \n        # Regression for species A\n        # w_A = alpha_A + beta_AA * z_A + beta_AB * z_B\n        coeffs_A = np.linalg.solve(X.T @ X, X.T @ w_A)\n        beta_AB = coeffs_A[2]\n\n        # Regression for species B\n        # w_B = alpha_B + beta_BA * z_A + beta_BB * z_B\n        coeffs_B = np.linalg.solve(X.T @ X, X.T @ w_B)\n        beta_BA = coeffs_B[1]\n\n        # Round results to 4 decimal places\n        beta_AB_rounded = round(beta_AB, 4)\n        beta_BA_rounded = round(beta_BA, 4)\n        \n        results.append([beta_AB_rounded, beta_BA_rounded])\n\n    # Format the final output string as specified: [[x1,y1],[x2,y2],...]\n    # Using f-strings to format each inner list and join them.\n    # The format specifier ensure trailing zeros are shown, e.g., 0.4000\n    sub_results = [f'[{res[0]:.4f},{res[1]:.4f}]' for res in results]\n    final_output_string = f\"[{','.join(sub_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2738886"}]}