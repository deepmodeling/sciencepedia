{"hands_on_practices": [{"introduction": "虽然亨德森-哈塞尔巴尔赫方程为计算提供了捷径，但真正的理解源于从第一性原理推导缓冲液的组分。这项练习将指导您完成这一基本过程，解决一个常见的实验室任务：将缓冲液精确配制到特定的$pH$值。通过从质量守恒、电荷守恒和酸解离平衡出发，您可以加深对缓冲作用核心原理的理解。[@problem_id:2611463]", "problem": "您正在使用一种一元弱酸（表示为 $HA$）的储备液和一种标准化的强碱——氢氧化钠（$\\mathrm{NaOH}$）来配制一种缓冲溶液。目标缓冲溶液在最终体积为 $1.000$ L 时的分析浓度 $C_T$（稀释后定义为 $C_T \\equiv [HA] + [A^{-}]$）为 $50$ mM，氢离子电势（pH）为 $7.20$。在 $25\\,^{\\circ}\\mathrm{C}$ 时，该酸的 $pK_a = 7.20$。您有浓度为 $0.500$ M 的纯酸储备液和浓度为 $0.1000$ M 的标准化 $\\mathrm{NaOH}$ 溶液。操作流程如下：取一定体积的酸储备液放入一个 $1.000$ L 的容量瓶中，加入足量的 $\\mathrm{NaOH}$ 滴定剂以部分中和该酸，然后用 $25\\,^{\\circ}\\mathrm{C}$ 的水稀释至刻度线。\n\n仅从酸解离平衡、电中性原理和质量守恒出发，不使用任何现成的缓冲溶液公式，确定需要加入多少 $\\mathrm{NaOH}$ 才能在指定 pH 下达到目标组分。假设在这些条件下 $HA$ 和 $A^{-}$ 的活度系数相等，因此活度比可以用浓度比代替，并忽略水的自偶电离相对于缓冲溶液浓度的影响。\n\n以毫升为单位，给出需要加入的 $\\mathrm{NaOH}$ 溶液的体积。答案保留四位有效数字。", "solution": "在尝试求解之前，将根据所需标准对所述问题进行验证。\n\n### 第一步：提取已知条件\n- **酸的类型**：一元弱酸，$HA$。\n- **滴定剂**：强碱，氢氧化钠（$\\mathrm{NaOH}$）。\n- **目标分析浓度**：$C_T \\equiv [HA] + [A^{-}] = 50$ mM。\n- **目标最终体积**：$V_f = 1.000$ L。\n- **目标 pH**：$7.20$。\n- **酸解离常数**：在 $25\\,^{\\circ}\\mathrm{C}$ 时，$pK_a = 7.20$。\n- **酸储备液浓度**：$C_{\\text{stock}, HA} = 0.500$ M。\n- **碱滴定剂浓度**：$C_{NaOH} = 0.1000$ M。\n- **约束条件**：\n    - 必须从酸解离平衡、电中性原理和质量守恒出发推导求解。\n    - 不能使用现成的缓冲溶液公式（例如，Henderson–Hasselbalch 方程）。\n- **假设**：\n    - $HA$ 和 $A^{-}$ 的活度系数相等。\n    - 水的自偶电离相对于缓冲溶液浓度可以忽略。\n- **目标**：确定需要加入的 $\\mathrm{NaOH}$ 溶液的体积 $V_{NaOH}$，单位为毫升，保留四位有效数字。\n\n### 第二步：根据提取的已知条件进行验证\n该问题是定量化学分析中的一个标准练习，特别是缓冲溶液的配制。\n- **科学依据**：该问题基于酸碱化学的基本原理，包括平衡、质量守恒和电荷守恒。所有数值在实验室环境中都是物理上现实的。\n- **问题明确**：该问题提供了充分、一致的数据和明确的约束条件，以确定 $\\mathrm{NaOH}$ 体积的唯一值。\n- **客观性**：该问题以精确、定量的术语陈述，没有歧义或主观内容。\n\n该问题不违反任何指定的无效标准。明确指示将最终答案保留四位有效数字，这意味着输入值“$50$ mM”应被视为具有足够的精度，即 $50.00$ mM 或 $0.05000$ M。\n\n### 第三步：结论与行动\n问题有效。将按要求从第一性原理推导严谨的解法。\n\n### 解题推导\n解题过程必须源于三个基本原理：酸解离平衡、酸物质的质量守恒以及最终溶液的电中性原理。\n\n1.  **酸解离平衡**：弱酸 $HA$ 在水中的解离由以下平衡描述：\n    $$HA \\rightleftharpoons H^+ + A^-$$\n    酸解离常数 $K_a$ 定义为：\n    $$K_a = \\frac{[H^+][A^{-}]}{[HA]}$$\n    问题陈述 $HA$ 和 $A^-$ 的活度系数相等，这证明了可以使用浓度代替活度。重新整理该表达式得到共轭碱与酸的比率：\n    $$\\frac{[A^{-}]}{[HA]} = \\frac{K_a}{[H^+]}$$\n    我们已知 $pH = 7.20$ 且 $pK_a = 7.20$。根据定义，$pH = -\\log_{10}([H^+])$ 且 $pK_a = -\\log_{10}(K_a)$。因此，$[H^+] = 10^{-7.20}$ M 且 $K_a = 10^{-7.20}$。将这些值代入比率表达式中：\n    $$\\frac{[A^{-}]}{[HA]} = \\frac{10^{-7.20}}{10^{-7.20}} = 1$$\n    这从第一性原理证明了，要达到目标 pH，弱酸及其共轭碱的浓度必须相等：$[A^{-}] = [HA]$。\n\n2.  **质量守恒**：缓冲组分的总分析浓度 $C_T$ 是未解离的酸及其共轭碱的浓度之和。\n    $$C_T = [HA] + [A^{-}]$$\n    已知 $C_T = 50$ mM $= 0.050$ M。根据验证，为满足输出精度要求，我们取 $C_T = 0.05000$ M。\n    将平衡分析的结果 $[HA] = [A^{-}]$ 代入质量守恒方程：\n    $$C_T = [A^{-}] + [A^{-}] = 2[A^{-}]$$\n    求解所需的共轭碱浓度 $[A^{-}]$：\n    $$[A^{-}] = \\frac{C_T}{2} = \\frac{0.05000 \\text{ M}}{2} = 0.02500 \\text{ M}$$\n\n3.  **电中性与化学计量**：电中性原理要求溶液中总正电荷浓度等于总负电荷浓度。溶液中存在的离子有 $Na^+$（来自 $\\mathrm{NaOH}$）、$H^+$（来自酸和水）、$A^-$（来自酸解离）和 $OH^-$（来自水）。电荷平衡方程为：\n    $$[Na^+] + [H^+] = [A^{-}] + [OH^-]$$\n    问题允许忽略水的自偶电离。在 $pH = 7.20$ 时，我们有 $[H^+] = 10^{-7.20}$ M $\\approx 6.31 \\times 10^{-8}$ M 和 $[OH^-] = 10^{-(14.00 - 7.20)}$ M $= 10^{-6.80}$ M $\\approx 1.58 \\times 10^{-7}$ M。这两个浓度都比目标缓冲物质浓度 $0.02500$ M 小几个数量级。因此该近似是合理的。电荷平衡方程简化为：\n    $$[Na^+] \\approx [A^{-}]$$\n    最终溶液中的钠离子完全来自于加入的 $\\mathrm{NaOH}$ 溶液的体积 $V_{NaOH}$。$Na^+$ 的总摩尔数为 $n_{Na^+} = C_{NaOH} \\times V_{NaOH}$。在最终体积 $V_f$ 中的浓度为：\n    $$[Na^+] = \\frac{C_{NaOH} V_{NaOH}}{V_f}$$\n    将此与简化的电荷平衡和所需的 $[A^{-}]$ 浓度结合起来：\n    $$[A^{-}] = \\frac{C_{NaOH} V_{NaOH}}{V_f}$$\n    这个方程将所需的共轭碱浓度与必须加入的强碱体积联系起来。现在我们可以求解 $V_{NaOH}$：\n    $$V_{NaOH} = \\frac{[A^{-}] V_f}{C_{NaOH}}$$\n    代入已知值：\n    $$V_{NaOH} = \\frac{(0.02500 \\text{ M})(1.000 \\text{ L})}{0.1000 \\text{ M}}$$\n    $$V_{NaOH} = \\frac{0.02500}{0.1000} \\text{ L} = 0.2500 \\text{ L}$$\n    问题要求以毫升为单位给出答案。要将升转换为毫升，我们乘以 $1000$：\n    $$V_{NaOH} = 0.2500 \\text{ L} \\times 1000 \\frac{\\text{mL}}{\\text{L}} = 250.0 \\text{ mL}$$\n    该结果有四位有效数字，符合要求。", "answer": "$$\\boxed{250.0}$$", "id": "2611463"}, {"introduction": "在掌握了如何制备缓冲液后，下一个关键步骤是理解其抵抗$pH$值变化的能力，即缓冲容量。本练习提供了一个实际情景来量化这一重要属性。通过计算需要多少强酸才能使缓冲液的$pH$值发生特定偏移，您将进一步巩固对缓冲体系动态平衡的认识，并学会如何评估缓冲液在实验条件下的稳定性。[@problem_id:2611469]", "problem": "由共轭酸碱对 $\\mathrm{HA}/\\mathrm{A}^{-}$ 制备了一个单质子弱酸缓冲溶液，其总分析浓度为 $C_{T} = [\\mathrm{HA}] + [\\mathrm{A}^{-}] = 50~\\mathrm{mM}$。在 $25~^{\\circ}\\mathrm{C}$ 下，其酸解离常数的特征为 $pK_{a} = 6.8$。初始时，缓冲溶液的 $\\mathrm{pH} = 6.8$。现有 $1.000~\\mathrm{L}$ 该缓冲溶液。向其中加入少量浓强酸（假设为 $\\mathrm{HCl}$），使得总体积的变化可以忽略不计，且溶液表现为理想溶液（活度系数为1）。最终的目标 $\\mathrm{pH}$ 值为 $6.6$。\n\n仅从酸解离常数 $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{-}$ 的定义、$\\mathrm{pH}$ 的定义、质量平衡以及 $25~^{\\circ}\\mathrm{C}$ 时水的自电离出发，确定为使 $1.000~\\mathrm{L}$ 缓冲溶液达到目标 $\\mathrm{pH}$ 值必须加入的强酸的量。明确说明你所使用的任何近似，并从第一性原理出发证明其合理性。\n\n以毫摩尔为单位报告你的最终答案，并保留三位有效数字。最终结果以 mmol 表示。", "solution": "所述问题具有科学依据，提法明确且客观。这是一个酸碱化学中的标准问题，适合进行严谨的分析。所有必要的数据均已提供，且内部没有矛盾。因此，将提供一个解答。\n\n该问题要求从第一性原理出发进行推导，即酸解离常数的定义、pH 的定义、质量平衡和水的自电离。我们需要确定将 $1.000~\\mathrm{L}$ 缓冲溶液的 $\\mathrm{pH}$ 值从初始值 $\\mathrm{pH}_i = 6.8$ 变为最终值 $\\mathrm{pH}_f = 6.6$ 所需强酸的量。\n\n我们来定义这个体系。溶液中的物种有共轭酸碱对 $\\mathrm{HA}$ 和 $\\mathrm{A}^{-}$、氢离子 $\\mathrm{H}^{+}$、氢氧根离子 $\\mathrm{OH}^{-}$、来自强酸的阴离子（此处为 $\\mathrm{Cl}^{-}$）以及一个必须存在以平衡 $\\mathrm{A}^{-}$ 初始电荷的旁观者阳离子（例如 $\\mathrm{Na}^{+}$）。\n\n控制方程如下：\n$1$. 缓冲组分的质量平衡：\n$$[\\mathrm{HA}] + [\\mathrm{A}^{-}] = C_{T} = 0.050~\\mathrm{M}$$\n$2$. 弱酸解离平衡：\n$$K_{a} = \\frac{[\\mathrm{H}^{+}] [\\mathrm{A}^{-}]}{[\\mathrm{HA}]}$$\n其中 $pK_{a} = -\\log_{10}(K_a) = 6.8$，所以 $K_a = 10^{-6.8}~\\mathrm{M}$。\n$3$. 水的自电离平衡（在 $25~^{\\circ}\\mathrm{C}$）：\n$$K_{w} = [\\mathrm{H}^{+}] [\\mathrm{OH}^{-}] = 10^{-14}~\\mathrm{M}^2$$\n$4$. 电中性（电荷平衡）。令 $[\\mathrm{C}^{+}]$ 为旁观者阳离子的浓度。\n$$[\\mathrm{H}^{+}] + [\\mathrm{C}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}] + [\\mathrm{Cl}^{-}]$$\n加入的强酸浓度 $C_{\\mathrm{acid}}$ 等于其阴离子浓度 $[\\mathrm{Cl}^{-}]$。加入的酸的摩尔量为 $n_{\\mathrm{acid}} = C_{\\mathrm{acid}} \\times V$，其中 $V = 1.000~\\mathrm{L}$。\n\n我们可以为初始状态（下标 $i$）和最终状态（下标 $f$）写出电荷平衡方程。\n初始状态（$[\\mathrm{Cl}^{-}]_i = 0$）：\n$$[\\mathrm{H}^{+}]_i + [\\mathrm{C}^{+}] = [\\mathrm{A}^{-}]_i + [\\mathrm{OH}^{-}]_i$$\n最终状态：\n$$[\\mathrm{H}^{+}]_f + [\\mathrm{C}^{+}] = [\\mathrm{A}^{-}]_f + [\\mathrm{OH}^{-}]_f + [\\mathrm{Cl}^{-}]_f$$\n由于旁观者阳离子浓度 $[\\mathrm{C}^{+}]$ 不变，我们可以用最终状态的方程减去初始状态的方程来消去它：\n$$([\\mathrm{H}^{+}]_f - [\\mathrm{H}^{+}]_i) = ([\\mathrm{A}^{-}]_f - [\\mathrm{A}^{-}]_i) + ([\\mathrm{OH}^{-}]_f - [\\mathrm{OH}^{-}]_i) + [\\mathrm{Cl}^{-}]_f$$\n重新整理以求解加入的酸的浓度 $C_{\\mathrm{acid}} = [\\mathrm{Cl}^{-}]_f$：\n$$C_{\\mathrm{acid}} = ([\\mathrm{H}^{+}]_f - [\\mathrm{H}^{+}]_i) - ([\\mathrm{OH}^{-}]_f - [\\mathrm{OH}^{-}]_i) - ([\\mathrm{A}^{-}]_f - [\\mathrm{A}^{-}]_i)$$\n这个表达式是精确的，并且是从第一性原理推导出来的。我们现在计算每一项。\n\n初始状态分析（$\\mathrm{pH}_i = 6.8$）：\n$[\\mathrm{H}^{+}]_i = 10^{-\\mathrm{pH}_i} = 10^{-6.8}~\\mathrm{M}$。\n$[\\mathrm{OH}^{-}]_i = K_w / [\\mathrm{H}^{+}]_i = 10^{-14} / 10^{-6.8} = 10^{-7.2}~\\mathrm{M}$。\n从 $K_a$ 表达式，我们可以推导出共轭碱的组分分数 $\\alpha_{\\mathrm{A}^{-}} = [\\mathrm{A}^{-}]/C_T$：\n$$[\\mathrm{A}^{-}] = C_T \\left( \\frac{K_a}{K_a + [\\mathrm{H}^{+}]} \\right)$$\n在初始状态，$[\\mathrm{H}^{+}]_i = K_a$，所以：\n$$[\\mathrm{A}^{-}]_i = C_T \\left( \\frac{K_a}{K_a + K_a} \\right) = \\frac{C_T}{2} = \\frac{0.050~\\mathrm{M}}{2} = 0.025~\\mathrm{M}$$\n\n最终状态分析（$\\mathrm{pH}_f = 6.6$）：\n$[\\mathrm{H}^{+}]_f = 10^{-\\mathrm{pH}_f} = 10^{-6.6}~\\mathrm{M}$。\n$[\\mathrm{OH}^{-}]_f = K_w / [\\mathrm{H}^{+}]_f = 10^{-14} / 10^{-6.6} = 10^{-7.4}~\\mathrm{M}$。\n对最终状态使用组分分数公式：\n$$[\\mathrm{A}^{-}]_f = C_T \\left( \\frac{K_a}{K_a + [\\mathrm{H}^{+}]_f} \\right) = 0.050~\\mathrm{M} \\times \\left( \\frac{10^{-6.8}}{10^{-6.8} + 10^{-6.6}} \\right)$$\n$$[\\mathrm{A}^{-}]_f = 0.050~\\mathrm{M} \\times \\left( \\frac{1}{1 + 10^{0.2}} \\right)$$\n\n现在，我们计算浓度的变化：\n$\\Delta[\\mathrm{H}^{+}] = [\\mathrm{H}^{+}]_f - [\\mathrm{H}^{+}]_i = 10^{-6.6} - 10^{-6.8} = 10^{-6.8}(10^{0.2} - 1)~\\mathrm{M}$。\n$\\Delta[\\mathrm{OH}^{-}] = [\\mathrm{OH}^{-}]_f - [\\mathrm{OH}^{-}]_i = 10^{-7.4} - 10^{-7.2} = 10^{-7.4}(1 - 10^{0.2})~\\mathrm{M}$。\n$\\Delta[\\mathrm{A}^{-}] = [\\mathrm{A}^{-}]_f - [\\mathrm{A}^{-}]_i = \\left( 0.050~\\mathrm{M} \\times \\frac{1}{1 + 10^{0.2}} \\right) - 0.025~\\mathrm{M}$。\n\n将这些代入 $C_{\\mathrm{acid}}$ 的表达式中：\n$C_{\\mathrm{acid}} = \\Delta[\\mathrm{H}^{+}] - \\Delta[\\mathrm{OH}^{-}] - \\Delta[\\mathrm{A}^{-}]$。\n数值计算：\n$10^{0.2} \\approx 1.5849$。\n$\\Delta[\\mathrm{H}^{+}] \\approx 1.5849 \\times 10^{-7} \\times (1.5849 - 1) \\approx 9.27 \\times 10^{-8}~\\mathrm{M}$。\n$\\Delta[\\mathrm{OH}^{-}] \\approx 3.981 \\times 10^{-8} \\times (1 - 1.5849) \\approx -2.33 \\times 10^{-8}~\\mathrm{M}$。\n$[\\mathrm{A}^{-}]_f \\approx 0.050 / (1 + 1.5849) \\approx 0.019344~\\mathrm{M}$。\n$\\Delta[\\mathrm{A}^{-}] \\approx 0.019344 - 0.025 = -0.005656~\\mathrm{M}$。\n\n$C_{\\mathrm{acid}} \\approx (9.27 \\times 10^{-8}) - (-2.33 \\times 10^{-8}) - (-0.005656)~\\mathrm{M}$\n$C_{\\mathrm{acid}} \\approx 1.16 \\times 10^{-7} + 0.005656~\\mathrm{M} = 0.005656116~\\mathrm{M}$。\n\n需要加入的强酸的量为 $n_{\\mathrm{acid}} = C_{\\mathrm{acid}} \\times V$：\n$n_{\\mathrm{acid}} = 0.005656116~\\mathrm{mol/L} \\times 1.000~\\mathrm{L} = 0.005656116~\\mathrm{mol}$。\n转换为毫摩尔：\n$n_{\\mathrm{acid}} = 5.656116~\\mathrm{mmol}$。\n保留三位有效数字，其量为 $5.66~\\mathrm{mmol}$。\n\n问题要求明确说明所做的近似。以上的计算是精确的，没有使用任何近似。然而，考虑在此类问题中常用的近似是有益的。通常会使用亨德森-哈塞尔巴赫方程，而该方程本身就是一个近似。其基本假设是，与缓冲组分 $\\mathrm{HA}$ 和 $\\mathrm{A}^{-}$ 浓度的变化相比，$\\mathrm{H}^{+}$ 和 $\\mathrm{OH}^{-}$ 浓度的变化可以忽略不计。\n在我们关于 $C_{\\mathrm{acid}}$ 的精确方程中，这等同于忽略 $\\Delta[\\mathrm{H}^{+}]$ 和 $\\Delta[\\mathrm{OH}^{-}]$ 项：\n$C_{\\mathrm{acid}} \\approx -\\Delta[\\mathrm{A}^{-}] = -([\\mathrm{A}^{-}]_f - [\\mathrm{A}^{-}]_i) = [\\mathrm{A}^{-}]_i - [\\mathrm{A}^{-}]_f$。\n这个近似意味着所有加入的酸都用于将共轭碱 $\\mathrm{A}^{-}$ 转化为酸 $\\mathrm{HA}$。\n我们来检验这个近似的有效性。\n我们忽略的项是 $\\Delta[\\mathrm{H}^{+}] - \\Delta[\\mathrm{OH}^{-}] \\approx 1.16 \\times 10^{-7}~\\mathrm{M}$。\n我们保留的项是 $-\\Delta[\\mathrm{A}^{-}] \\approx 0.005656~\\mathrm{M}$。\n被忽略的项与主导项的比值为 $(1.16 \\times 10^{-7}) / (0.005656) \\approx 2 \\times 10^{-5}$。\n这个近似引入的误差约为 $0.002\\%$，这是微不足道的。因此，该近似是完全合理的。这种基于亨德森-哈塞尔巴赫关系的标准简化，在这种情况下对于几乎所有实际应用都是足够的。\n\n最终答案是强酸的量，单位为毫摩尔，保留三位有效数字。\n$n_{\\mathrm{acid}} = 5.66~\\mathrm{mmol}$。", "answer": "$$\\boxed{5.66}$$", "id": "2611469"}, {"introduction": "标准的亨德森-哈塞尔巴尔赫方程是在理想溶液的假设下运行的，其中浓度等于活度。这项计算练习挑战了这一基本假设，引入了离子强度和活度系数的概念，这对于研究生水平的生物化学研究至关重要。您将构建一个更精确、考虑活度校正的模型，并将其拟合到模拟的实验数据中，这项任务代表了现代生物物理化学中理论与数据分析的融合。[@problem_id:2611480]", "problem": "您将设计一个计算实验，通过拟合一个考虑活度的 Henderson–Hasselbalch 模型，根据作为离子强度函数的氢离子活度指数 (pH) 测量值，来估算单质子酸体系的单离子活度系数。目标是将其工作流程形式化为一个程序，该程序以测量的 pH 值和已知的组成为输入，推导出共轭碱的活度系数，并通过拟合 Davies 型活度模型来估算 Debye–Hückel 常数。\n\n从单质子弱酸 $\\mathrm{HA}$ 电离的质量作用定律（使用活度）开始：\n$$\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-,$$\n其标准态下的热力学平衡常数 $K_\\mathrm{a}^\\circ$ 定义为\n$$K_\\mathrm{a}^\\circ \\equiv \\frac{a_{\\mathrm{H}^+} a_{\\mathrm{A}^-}}{a_{\\mathrm{HA}}},$$\n以及氢离子活度指数 (pH) 的定义，\n$$\\mathrm{pH} \\equiv -\\log_{10} a_{\\mathrm{H}^+}.$$\n假设中性酸的活度系数 $\\gamma_{\\mathrm{HA}} \\approx 1$，因此 $a_{\\mathrm{HA}} \\approx [\\mathrm{HA}]$，并定义组成比 $R \\equiv [\\mathrm{A}^-]/[\\mathrm{HA}]$，该比例由制备过程确定，并在通过添加惰性盐来调节离子强度时保持不变。仅使用这些定义和质量作用定律作为出发点；不要引用任何预先推导出的缓冲方程。\n\n在温度 $T \\approx 298.15\\,\\mathrm{K}$ 时，使用 Davies 方程对单价共轭碱 $\\mathrm{A}^-$ 的活度系数进行建模：\n$$\\log_{10} \\gamma_{\\mathrm{A}^-}(I) = -A \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right),$$\n其中 $I$ 是以 $\\mathrm{mol\\,L^{-1}}$ 为单位的离子强度，$\\gamma_{\\mathrm{A}^-}$ 是无量纲的，$A$ 是一个待从数据中估算的未知常数（在 $25^\\circ\\mathrm{C}$ 时，其典型值接近 $0.509$，但在拟合步骤中不要假设此值）。\n\n您的程序必须对下面的每个测试用例执行以下操作：\n1) 使用带活度的质量作用定律和 pH 的定义，推导出一个表达式，该表达式根据测量的 $\\mathrm{pH}$、已知的 $\\mathrm{p}K_\\mathrm{a}^\\circ \\equiv -\\log_{10} K_\\mathrm{a}^\\circ$ 以及已知的比率 $R \\equiv [\\mathrm{A}^-]/[\\mathrm{HA}]$ 来分离出 $\\log_{10}\\gamma_{\\mathrm{A}^-}$。您必须在内部逻辑中清楚地说明您的假设（例如，$\\gamma_{\\mathrm{HA}} \\approx 1$）。基于该推导出的关系，为测试用例中的每个离子强度点计算 $\\log_{10}\\gamma_{\\mathrm{A}^-}$。\n2) 定义 Davies 基函数\n$$f(I) \\equiv \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I,$$\n并通过约束通过原点的最小二乘法（即无截距项）拟合线性模型\n$$y_i = -A\\, f(I_i), \\quad \\text{其中} \\quad y_i \\equiv \\log_{10}\\gamma_{\\mathrm{A}^-}(I_i),$$\n从而得到估计量\n$$\\hat{A} = -\\frac{\\sum_i f(I_i)\\, y_i}{\\sum_i f(I_i)^2}.$$\n3) 对于每个测试用例，返回拟合值 $\\hat{A}$，形式为四舍五入到六位小数的浮点数。\n\n物理和数值单位：离子强度 $I$ 以 $\\mathrm{mol\\,L^{-1}}$ 为单位；活度系数和常数 $A$ 是无量纲的；pH 和 $\\mathrm{p}K_\\mathrm{a}^\\circ$ 是无量纲的。\n\n程序的测试套件和数据（请完全按照所提供的数据使用）：\n- 测试用例 1（一般情况；中等离子强度，等摩尔缓冲液）：\n  - $\\mathrm{p}K_\\mathrm{a}^\\circ = 4.760$\n  - $R = 1.0$\n  - 离子强度 $I$ (单位 $\\mathrm{mol\\,L^{-1}}$): $[0.01, 0.04, 0.09]$\n  - 测量的 $\\mathrm{pH}$: $[4.7152542727274, 4.68127466666665, 4.6562814615385]$\n- 测试用例 2（边界情况；极低离子强度，等摩尔缓冲液）：\n  - $\\mathrm{p}K_\\mathrm{a}^\\circ = 6.500$\n  - $R = 1.0$\n  - 离子强度 $I$ (单位 $\\mathrm{mol\\,L^{-1}}$): $[0.0001, 0.0004, 0.0025]$\n  - 测量的 $\\mathrm{pH}$: $[6.494975666039604, 6.490080687843137, 6.476143654761905]$\n- 测试用例 3（组成边界情况；$R \\neq 1$）：\n  - $\\mathrm{p}K_\\mathrm{a}^\\circ = 7.200$\n  - $R = 0.1$\n  - 离子强度 $I$ (单位 $\\mathrm{mol\\,L^{-1}}$): $[0.01, 0.04, 0.16]$\n  - 测量的 $\\mathrm{pH}$: $[6.155254272727273, 6.121274666666667, 6.079003428571429]$\n\n最终输出格式：您的程序应生成单行输出，其中包含三个测试用例的拟合值 $\\hat{A}$，形式为方括号内以逗号分隔的列表，每个值都四舍五入到六位小数。例如，输出必须看起来像 $[a_1,a_2,a_3]$，其中每个 $a_j$ 是小数点后有六位数的小数，不打印任何其他字符。\n\n您的程序必须是自包含的，不需要用户输入，并且仅依赖于指定的运行时环境。", "solution": "问题陈述经评估有效。它在科学上基于化学热力学原理，在数学上是一致的，并为一个计算任务提供了完整且适定的描述。解决方案的推导和实现如下。\n\n问题的核心是从实验测量中确定单离子活度系数 $\\gamma_{\\mathrm{A}^-}$。这需要基于基本原理，推导出测量量 $\\mathrm{pH}$ 和目标量 $\\gamma_{\\mathrm{A}^-}$ 之间的函数关系。\n\n出发点是单质子酸 $\\mathrm{HA}$ 电离的质量作用定律：\n$$\n\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-\n$$\n热力学平衡常数 $K_\\mathrm{a}^\\circ$ 以活度（$a_i$）表示：\n$$\nK_\\mathrm{a}^\\circ = \\frac{a_{\\mathrm{H}^+} a_{\\mathrm{A}^-}}{a_{\\mathrm{HA}}}\n$$\n为了对该表达式进行线性化，我们取两边的负常用对数：\n$$\n-\\log_{10}(K_\\mathrm{a}^\\circ) = -\\log_{10}\\left(\\frac{a_{\\mathrm{H}^+} a_{\\mathrm{A}^-}}{a_{\\mathrm{HA}}}\\right)\n$$\n$$\n-\\log_{10}(K_\\mathrm{a}^\\circ) = -\\log_{10}(a_{\\mathrm{H}^+}) - \\log_{10}(a_{\\mathrm{A}^-}) + \\log_{10}(a_{\\mathrm{HA}})\n$$\n根据定义，$\\mathrm{p}K_\\mathrm{a}^\\circ \\equiv -\\log_{10}(K_\\mathrm{a}^\\circ)$ 和 $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H}^+})$。将这些代入方程可得：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(a_{\\mathrm{A}^-}) + \\log_{10}(a_{\\mathrm{HA}})\n$$\n活度 $a_i$ 通过关系式 $a_i = \\gamma_i [i]$ 与摩尔浓度 $[i]$ 和无量纲活度系数 $\\gamma_i$ 相关。将这些关系式代入酸及其共轭碱：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-} [\\mathrm{A}^-]) + \\log_{10}(\\gamma_{\\mathrm{HA}} [\\mathrm{HA}])\n$$\n问题指定了标准且物理上合理的假设，即中性酸物质的活度系数为1，$\\gamma_{\\mathrm{HA}} \\approx 1$。应用此假设简化了最后一项：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ \\approx \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-} [\\mathrm{A}^-]) + \\log_{10}([\\mathrm{HA}])\n$$\n使用对数性质 $\\log(xy) = \\log(x) + \\log(y)$，我们展开共轭碱的项：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - (\\log_{10}(\\gamma_{\\mathrm{A}^-}) + \\log_{10}([\\mathrm{A}^-])) + \\log_{10}([\\mathrm{HA}])\n$$\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-}) - \\log_{10}([\\mathrm{A}^-]) + \\log_{10}([\\mathrm{HA}])\n$$\n重新排列并使用性质 $\\log(x) - \\log(y) = \\log(x/y)$：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-}) - (\\log_{10}([\\mathrm{A}^-]) - \\log_{10}([\\mathrm{HA}]))\n$$\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-}) - \\log_{10}\\left(\\frac{[\\mathrm{A}^-]}{[\\mathrm{HA}]}\\right)\n$$\n问题将组成比定义为 $R \\equiv [\\mathrm{A}^-]/[\\mathrm{HA}]$。将 $R$ 代入方程，得到 Henderson-Hasselbalch 关系式的活度校正形式：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(R) - \\log_{10}(\\gamma_{\\mathrm{A}^-})\n$$\n该方程是测量的 $\\mathrm{pH}$、已知的系统参数 $\\mathrm{p}K_\\mathrm{a}^\\circ$ 和 $R$ 以及未知量 $\\gamma_{\\mathrm{A}^-}$ 之间的关键联系。我们现在可以分离出活度系数项：\n$$\n\\log_{10}(\\gamma_{\\mathrm{A}^-}) = \\mathrm{pH} - \\mathrm{p}K_\\mathrm{a}^\\circ - \\log_{10}(R)\n$$\n这个推导出的表达式允许为每个数据点 $(I_i, \\mathrm{pH}_i)$ 计算 $\\log_{10}(\\gamma_{\\mathrm{A}^-})$ 的实验值。我们将此计算值表示为 $y_i$：\n$$\ny_i \\equiv \\log_{10}(\\gamma_{\\mathrm{A}^-}(I_i)) = \\mathrm{pH}_i - \\mathrm{p}K_\\mathrm{a}^\\circ - \\log_{10}(R)\n$$\n问题规定将这些值 $y_i$ 拟合到 Davies 方程，该方程将单价离子 $\\mathrm{A}^-$ 的活度系数建模为离子强度 $I$ 的函数：\n$$\n\\log_{10} \\gamma_{\\mathrm{A}^-}(I) = -A \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right)\n$$\n我们将 Davies 基函数 $f(I)$ 定义为：\n$$\nf(I) \\equiv \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I\n$$\n因此，要拟合的模型是一个没有截距的简单线性关系：\n$$\ny_i = -A\\, f(I_i)\n$$\n目标是找到参数 $A$ 的最佳拟合估计值，记为 $\\hat{A}$。问题提供了强制通过原点的直线（形式为 $y=mx$，其中 $m = -A$ 且 $x = f(I)$）的普通最小二乘估计量的公式：\n$$\n\\hat{A} = -\\frac{\\sum_i f(I_i)\\, y_i}{\\sum_i f(I_i)^2}\n$$\n每个测试用例的计算过程如下：\n1.  对于给定的一组离子强度 $I_i$ 和测量的 $\\mathrm{pH}$ 值 $\\mathrm{pH}_i$，以及固定的 $\\mathrm{p}K_\\mathrm{a}^\\circ$ 和 $R$，计算实验值向量 $y_i = \\mathrm{pH}_i - \\mathrm{p}K_\\mathrm{a}^\\circ - \\log_{10}(R)$。\n2.  对于同一组离子强度 $I_i$，计算基函数值向量 $f(I_i) = \\frac{\\sqrt{I_i}}{1+\\sqrt{I_i}} - 0.3 I_i$。\n3.  计算估计量所需的两个总和：点积 $\\sum_i f(I_i) y_i$ 和平方和 $\\sum_i f(I_i)^2$。\n4.  使用提供的公式计算估计值 $\\hat{A}$。\n5.  报告 $\\hat{A}$ 的值，四舍五入到六位小数。\n\n对指定的三个测试用例中的每一个都执行此过程。使用 `numpy` 数组可以高效地进行这些向量和求和运算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Davies parameter A by fitting an activity-aware\n    Henderson-Hasselbalch model to pH-ionic strength data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"pKa_circ\": 4.760,\n            \"R\": 1.0,\n            \"I_values\": np.array([0.01, 0.04, 0.09]),\n            \"pH_values\": np.array([4.7152542727274, 4.68127466666665, 4.6562814615385])\n        },\n        {\n            \"pKa_circ\": 6.500,\n            \"R\": 1.0,\n            \"I_values\": np.array([0.0001, 0.0004, 0.0025]),\n            \"pH_values\": np.array([6.494975666039604, 6.490080687843137, 6.476143654761905])\n        },\n        {\n            \"pKa_circ\": 7.200,\n            \"R\": 0.1,\n            \"I_values\": np.array([0.01, 0.04, 0.16]),\n            \"pH_values\": np.array([6.155254272727273, 6.121274666666667, 6.079003428571429])\n        }\n    ]\n\n    results = []\n    \n    # Define the Davies basis function f(I)\n    def davies_basis_function(I):\n        \"\"\"\n        Calculates the Davies basis function f(I) = sqrt(I)/(1+sqrt(I)) - 0.3*I\n        Args:\n            I (np.ndarray): Ionic strength(s) in mol/L.\n        Returns:\n            np.ndarray: The value(s) of the basis function.\n        \"\"\"\n        sqrt_I = np.sqrt(I)\n        return (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I\n\n    for case in test_cases:\n        pKa_circ = case[\"pKa_circ\"]\n        R = case[\"R\"]\n        I_vals = case[\"I_values\"]\n        pH_vals = case[\"pH_values\"]\n\n        # Step 1: Compute experimental y_i = log10(gamma_A_minus)\n        # y_i = pH_i - pKa_circ - log10(R)\n        log10_R = np.log10(R)\n        y_i = pH_vals - pKa_circ - log10_R\n        \n        # Step 2: Compute the Davies basis function f(I_i) for each ionic strength\n        f_I_i = davies_basis_function(I_vals)\n        \n        # Step 3: Fit the linear model y_i = -A * f(I_i) using the provided OLS estimator\n        # A_hat = - (sum(f_i * y_i)) / (sum(f_i^2))\n        sum_f_y = np.sum(f_I_i * y_i)\n        sum_f_sq = np.sum(f_I_i**2)\n        \n        A_hat = -sum_f_y / sum_f_sq\n        \n        # Round the result to six decimal places and append\n        results.append(round(A_hat, 6))\n\n    # Final print statement in the exact required format.\n    # The format f-string with .6f ensures correct rounding and decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2611480"}]}