{"hands_on_practices": [{"introduction": "我们的第一个练习将我们对mRNA加帽的理解建立在基础生物化学之上。通过计算加帽过程中发生的质量变化，我们可以将这个复杂的酶促过程理解为一个具体的化学转化。这个练习不仅加深了我们对 $m^{7}G$ 帽子分子组成的认识，还锻炼了我们基于生物化学途径进行化学计量计算的技能。", "problem": "一个由DNA依赖性RNA聚合酶合成的纯化的$50$个核苷酸的信使核糖核酸（mRNA）以其新生形式被分离出来，其带有一个$5^{\\prime}$三磷酸末端，记作$5^{\\prime}$–$ppp\\mathrm{N}$，其中$\\mathrm{N}$是第一个核糖核苷酸。在典型的真核生物加帽反应中，以下步骤在同一个RNA分子上依次发生：(i) 一种RNA $5^{\\prime}$-三磷酸酶从$5^{\\prime}$末端移除末端的$\\gamma$-磷酸基团，生成$5^{\\prime}$–$pp\\mathrm{N}$；(ii) 一种鸟苷酰转移酶将鸟苷三磷酸（GTP）中的鸟苷单磷酸转移到$5^{\\prime}$二磷酸RNA上，形成$5^{\\prime}$–$5^{\\prime}$三磷酸连接，在 (iii) 一种S-腺苷-L-甲硫氨酸（SAM）依赖性甲基转移酶在加帽鸟嘌呤碱基的$\\mathrm{N}7$位置上添加一个甲基基团后，生成$m^{7}\\mathrm{G}ppp\\mathrm{N}$。\n\n从以下第一性原理出发：(a) 摩尔质量在反应中守恒，且等于组分原子质量的总和，以及 (b) $5^{\\prime}$–$5^{\\prime}$加帽重排了磷酸基团的分布，使得$5^{\\prime}$末端的磷酸基团总数在加帽前（$5^{\\prime}$–$ppp\\mathrm{N}$）和加帽后（$m^{7}\\mathrm{G}ppp\\mathrm{N}$）均为$3$，计算该RNA分子从$5^{\\prime}$–$ppp\\mathrm{N}$完全转化为$m^{7}\\mathrm{G}ppp\\mathrm{N}$时的净质量增加。假设：\n- 聚合物的唯一净增加物是一个鸟苷核苷和一个甲基基团（步骤(i)中末端磷酸基团的暂时性丢失被步骤(ii)中随转移的鸟苷酰基团引入的磷酸基团所平衡，使得磷酸基团总数相对于初始的$5^{\\prime}$三磷酸末端保持不变）。\n- 使用平均原子质量：碳$C$：$12.011$，氢$H$：$1.008$，氮$N$：$14.007$，氧$O$：$15.999$（单位为$\\mathrm{g}\\,\\mathrm{mol}^{-1}$）。\n- 使用鸟苷核苷的实验式 $C_{10}H_{13}N_{5}O_{5}$。\n- 将添加的甲基基团视为 $CH_{3}$。\n\n以道尔顿（Da）为单位表示净质量增加的最终结果，并四舍五入到四位有效数字。最终答案只写数值；不要在最终的方框答案中包含单位。", "solution": "题目要求计算一个信使核糖核酸（mRNA）分子在经历典型的真核生物加帽过程后的净质量增加。\n\n首先，必须确定问题陈述的有效性。\n题目详细描述了mRNA加帽的生化途径，从带有$5^{\\prime}$三磷酸末端（$5^{\\prime}-ppp\\mathrm{N}$）的新生转录本开始，到甲基化的鸟苷帽（$m^{7}\\mathrm{G}ppp\\mathrm{N}$）结束。所有必要的数据，包括实验式和原子质量，都已提供。该问题在科学上基于已确立的生物化学，表述清晰且客观。它包含一个关键的简化假设：“假设：聚合物的唯一净增加物是一个鸟苷核苷和一个甲基基团”。这个假设为计算提供了明确的指导，简化了多步酶促反应的复杂化学计量。虽然这是对真实原子平衡（这将涉及计算水解/缩合中的水分子以及释放的磷酸物种的确切组成）的过度简化，但它是一种常见的教学工具，用以将问题集中于特定概念。在问题的背景下，该假设没有造成逻辑矛盾或事实上的不可能性。因此，该问题被认为是有效的，并且解答必须严格遵守此提供的假设。\n\n任务是计算净质量增加量 $\\Delta M$。根据明确的假设，这是鸟苷核苷的质量（$M_{\\text{guanosine}}$）和一个甲基基团的质量（$M_{\\text{methyl}}$）之和。\n$$\n\\Delta M = M_{\\text{guanosine}} + M_{\\text{methyl}}\n$$\n我们使用提供的原子质量计算这些质量中的每一个：碳（$M_C = 12.011 \\, \\mathrm{Da}$）、氢（$M_H = 1.008 \\, \\mathrm{Da}$）、氮（$M_N = 14.007 \\, \\mathrm{Da}$）和氧（$M_O = 15.999 \\, \\mathrm{Da}$）。\n\n首先，我们计算鸟苷核苷的质量，其实验式为 $C_{10}H_{13}N_{5}O_{5}$。\n$$\nM_{\\text{guanosine}} = 10 \\times M_C + 13 \\times M_H + 5 \\times M_N + 5 \\times M_O\n$$\n代入给定的原子质量：\n$$\nM_{\\text{guanosine}} = 10 \\times 12.011 + 13 \\times 1.008 + 5 \\times 14.007 + 5 \\times 15.999\n$$\n$$\nM_{\\text{guanosine}} = 120.11 + 13.104 + 70.035 + 79.995\n$$\n$$\nM_{\\text{guanosine}} = 283.244 \\, \\mathrm{Da}\n$$\n\n接下来，我们计算甲基基团的质量，其化学式为 $CH_{3}$。\n$$\nM_{\\text{methyl}} = 1 \\times M_C + 3 \\times M_H\n$$\n代入给定的原子质量：\n$$\nM_{\\text{methyl}} = 1 \\times 12.011 + 3 \\times 1.008\n$$\n$$\nM_{\\text{methyl}} = 12.011 + 3.024\n$$\n$$\nM_{\\text{methyl}} = 15.035 \\, \\mathrm{Da}\n$$\n\n总的净质量增加是这两个组分之和。\n$$\n\\Delta M = M_{\\text{guanosine}} + M_{\\text{methyl}} = 283.244 + 15.035\n$$\n$$\n\\Delta M = 298.279 \\, \\mathrm{Da}\n$$\n\n题目要求最终结果四舍五入到四位有效数字。计算值为$298.279$。前四位有效数字是 $2$、$9$、$8$ 和 $2$。第五位数字是$7$，大于或等于$5$，所以我们将第四位有效数字向上取整。\n$$\n\\Delta M \\approx 298.3 \\, \\mathrm{Da}\n$$\n关于mRNA长度（$50$个核苷酸）的信息与计算无关，因为加帽修饰仅发生在$5^{\\prime}$末端，其质量效应与聚合物的长度无关。", "answer": "$$\n\\boxed{298.3}\n$$", "id": "2579246"}, {"introduction": "从5'端帽子转向3'端，这个问题挑战我们像酶学家一样思考，去剖析一个复杂反应。通过预测不同离子螯合剂和阳离子“加回”实验对3'末端切割和多聚腺苷酸化反应的影响，我们得以探索金属辅因子在催化中的关键作用。这个练习揭示了核心酶（如CPSF73和多聚腺苷酸聚合酶）独特的生物化学需求，这也是在真实实验室研究中剖析酶促反应的常用策略。[@problem_id:2579248]", "problem": "一个研究小组在HeLa核提取物中研究真核前体信使RNA（pre-mRNA）$3^{\\prime}$末端加工的核酸内切酶切割步骤。该切割反应由嵌入一个多蛋白复合物中的切割和多聚腺苷酸化特异性因子（CPSF）的核酸内切酶亚基CPSF73催化，随后由多聚(A)聚合酶（PAP）进行多聚腺苷酸化。该小组使用一个带有经典多聚腺苷酸化信号的放射性标记的前体信使RNA底物，并平行监测两个输出：(i) 在poly(A)位点的精确切割（出现明确的$5^{\\prime}$和$3^{\\prime}$片段）和 (ii) 随后由PAP进行的加尾反应（出现多聚(A)延伸的产物）。他们在标准的反应缓冲液中进行以下扰动，除非特别指明，该缓冲液除了从提取物中带入的之外，不含额外添加的游离二价阳离子：\n- 加入浓度为$2\\,\\mathrm{mM}$的乙二胺四乙酸（EDTA）。\n- 加入浓度为$2\\,\\mathrm{mM}$的乙二醇-双($\\beta$-氨基乙基醚)-$N,N,N^{\\prime},N^{\\prime}$-四乙酸（EGTA）。\n- 在经EDTA处理的反应中，回补单一二价阳离子：$2\\,\\mathrm{mM}$的氯化镁、$2\\,\\mathrm{mM}$的氯化锰、$0.1\\,\\mathrm{mM}$的氯化锌或$2\\,\\mathrm{mM}$的氯化钙。\n- 在经EGTA处理的反应中，回补$0.1\\,\\mathrm{mM}$的氯化锌或$2\\,\\mathrm{mM}$的氯化镁。\n\n依据以下基本原理：(a) 分子生物学的中心法则，其中前体RNA的加工是由酶催化的；(b) 金属酶催化原理，其中二价阳离子可以是磷酸二酯键断裂或形成所必需的辅因子；(c) 螯合化学，其中像EDTA这样的广谱螯合剂能高亲和力地隔离多种二价阳离子，而EGTA优先螯合钙离子而非镁离子，但仍能强力结合锌离子；以及(d) 核糖核酸酶和核苷酰转移酶对二价阳离子的公认需求。你可以假设核酸内切酶CPSF73属于金属-$\\beta$-内酰胺酶折叠的核酸酶家族，并且多聚(A)聚合酶的催化需要二价阳离子辅因子。\n\n在这些扰动下，哪个选项最能描述切割与多聚腺苷酸化的预期定性模式，以及特定二价阳离子最可能带来的恢复效果？\n\nA. $2\\,\\mathrm{mM}$的EDTA会废除切割和多聚腺苷酸化；回补$0.1\\,\\mathrm{mM}$的锌能恢复切割但不能恢复多聚腺苷酸化；回补$2\\,\\mathrm{mM}$的镁能恢复多聚腺苷酸化，但最多只能产生部分切割；回补$2\\,\\mathrm{mM}$的锰能同时恢复切割和多聚腺苷酸化；回补$2\\,\\mathrm{mM}$的钙两者都不能恢复。$2\\,\\mathrm{mM}$的EGTA显著抑制切割，但对多聚腺苷酸化的影响很小，在EGTA处理的反应中，回补锌优先恢复切割，而回补镁主要支持多聚腺苷酸化。\n\nB. $2\\,\\mathrm{mM}$的EDTA废除切割，但基本不影响多聚腺苷酸化；回补$2\\,\\mathrm{mM}$的钙最能恢复切割；$0.1\\,\\mathrm{mM}$的锌会进一步抑制这两个步骤；$2\\,\\mathrm{mM}$的EGTA对切割和多聚腺苷酸化均无明显影响。\n\nC. $2\\,\\mathrm{mM}$的EDTA通过移除抑制性的镁来增强切割；回补$2\\,\\mathrm{mM}$的镁会逆转这种增强效果；$0.1\\,\\mathrm{mM}$的锌是惰性的；$2\\,\\mathrm{mM}$的锰抑制多聚腺苷酸化但刺激切割；$2\\,\\mathrm{mM}$的EGTA阻断多聚腺苷酸化但不阻断切割。\n\nD. $2\\,\\mathrm{mM}$的EDTA仅废除切割；回补$2\\,\\mathrm{mM}$的镁能完全恢复切割，而$0.1\\,\\mathrm{mM}$的锌无法恢复；$2\\,\\mathrm{mM}$的锰强烈抑制这两个步骤；$2\\,\\mathrm{mM}$的EGTA产生与EDTA相同的强抑制模式，没有选择性效应。\n\nE. $2\\,\\mathrm{mM}$的EDTA废除切割和多聚腺苷酸化；只有$2\\,\\mathrm{mM}$的钙能有效恢复这两个步骤，而镁、锰和锌均无效；$2\\,\\mathrm{mM}$的EGTA选择性地抑制多聚腺苷酸化但不抑制切割，回补镁两者都不能恢复。", "solution": "该问题陈述是基于既定酶学原理的一次有效的生物化学推理练习，且问题提取得当。我们将着手进行解答。\n\n该问题要求分析真核生物$3^\\prime$末端加工中两个关键酶的活性：执行切割的核酸内切酶CPSF73，以及执行后续多聚腺苷酸化的多聚(A)聚合酶（PAP）。它们的活性在涉及二价阳离子螯合剂和特定阳离子回补的各种条件下进行探究。解答取决于理解每种酶特定的金属辅因子需求，正如所提供的基本原理所提示的那样。\n\n**1. 辅因子需求**\n\n*   **CPSF73（切割）：** 问题陈述指出CPSF73属于金属-$\\beta$-内酰胺酶折叠的核酸酶家族。这个超家族的酶是典型的依赖锌的水解酶。它们的催化机制依赖于活性位点中的一个或两个$\\mathrm{Zn}^{2+}$离子来激活一个水分子，以便对RNA的磷酸二酯骨架进行亲核攻击。因此，我们假定CPSF73的核酸内切活性需要$\\mathrm{Zn}^{2+}$。其他二价阳离子通常是较差的替代品，其中$\\mathrm{Mg}^{2+}$和$\\mathrm{Ca}^{2+}$尤其无效。$\\mathrm{Mn}^{2+}$有时可以在某些金属酶中替代$\\mathrm{Zn}^{2+}$，但$\\mathrm{Zn}^{2+}$仍然是经典且最有效的辅因子。\n\n*   **多聚(A)聚合酶（PAP）（多聚腺苷酸化）：** 问题陈述指出PAP是一种需要二价阳离子的核苷酰转移酶。这类酶，包括DNA和RNA聚合酶，几乎普遍利用$\\mathrm{Mg}^{2+}$作为辅因子。催化作用通常涉及两个$\\mathrm{Mg}^{2+}$离子，一个用于定位底物核苷三磷酸（对PAP而言是ATP），另一个用于激活引物的$3^\\prime$-羟基以进行攻击。$\\mathrm{Mn}^{2+}$通常是$\\mathrm{Mg}^{2+}$的功能性替代品，有时甚至能赋予更高的活性，而$\\mathrm{Zn}^{2+}$和$\\mathrm{Ca}^{2+}$通常无效或具有抑制作用。\n\n**2. 螯合剂的影响**\n\n*   **EDTA（乙二胺四乙酸）：** EDTA是一种广谱螯合剂，对包括$\\mathrm{Mg}^{2+}$、$\\mathrm{Ca}^{2+}$、$\\mathrm{Mn}^{2+}$和$\\mathrm{Zn}^{2+}$在内的多种二价和三价阳离子具有高亲和力。在$2\\,\\mathrm{mM}$的浓度下，它将有效隔离HeLa核提取物中所有游离的二价阳离子，从而使CPSF73和PAP都失活。\n\n*   **EGTA（乙二醇-双($\\beta$-氨基乙基醚)-$N,N,N^{\\prime},N^{\\prime}$-四乙酸）：** EGTA以其对$\\mathrm{Ca}^{2+}$的高选择性（相比于$\\mathrm{Mg}^{2+}$）而闻名。然而，它对其他行为上重要的二价阳离子，如$\\mathrm{Zn}^{2+}$和$\\mathrm{Mn}^{2+}$的亲和力也非常高，与其对$\\mathrm{Ca}^{2+}$的亲和力相当。因此，在$2\\,\\mathrm{mM}$浓度下，EGTA将有效螯合CPSF73所需的内源性$\\mathrm{Zn}^{2+}$，从而抑制切割。相比之下，它对游离$\\mathrm{Mg}^{2+}$（在细胞/提取物中通常为毫摩尔级别）浓度的影响很小，使得PAP的内在催化潜力基本保持完整。\n\n**3. 扰动和恢复效果分析**\n\n*   **条件：加入$2\\,\\mathrm{mM}$ EDTA**\n    *   由于EDTA同时螯合$\\mathrm{Zn}^{2+}$和$\\mathrm{Mg}^{2+}$，它将抑制CPSF73和PAP。\n    *   **预测：** 切割和多聚腺苷酸化均被废除。\n\n*   **条件：EDTA + 回补**\n    *   **回补$0.1\\,\\mathrm{mM}$ $\\mathrm{ZnCl}_2$：** $\\mathrm{Zn}^{2+}$是CPSF73的特异性辅因子。尽管EDTA过量（$2\\,\\mathrm{mM}$ 对 $0.1\\,\\mathrm{mM}$），但酶活性位点对$\\mathrm{Zn}^{2+}$的极高亲和力使其能够成功竞争该离子，从而恢复切割。$\\mathrm{Zn}^{2+}$不是PAP的辅因子。\n        *   **预测：** 切割被恢复，但多聚腺苷酸化未被恢复。\n    *   **回补$2\\,\\mathrm{mM}$ $\\mathrm{MgCl}_2$：** $\\mathrm{Mg}^{2+}$是PAP的特异性辅因子。以与EDTA相匹配的浓度回补它，将产生大量游离的$\\mathrm{Mg}^{2+}$，从而恢复PAP的活性。$\\mathrm{Mg}^{2+}$对于金属-$\\beta$-内酰胺酶CPSF73来说不是一个有效的辅因子。充其量，它可能支持一个非常低的、残余水平的活性。\n        *   **预测：** 多聚腺苷酸化被恢复，而切割未被恢复或最多仅被部分恢复。\n    *   **回补$2\\,\\mathrm{mM}$ $\\mathrm{MnCl}_2$：** $\\mathrm{Mn}^{2+}$是PAP（替代$\\mathrm{Mg}^{2+}$）和一些锌金属酶（替代$\\mathrm{Zn}^{2+}$）的已知替代辅因子。\n        *   **预测：** 多聚腺苷酸化和切割均被恢复。\n    *   **回补$2\\,\\mathrm{mM}$ $\\mathrm{CaCl}_2$：** $\\mathrm{Ca}^{2+}$的离子半径和配位化学性质通常与PAP和CPSF73的活性位点不相容。\n        *   **预测：** 两种活性均未被恢复。\n\n*   **条件：加入$2\\,\\mathrm{mM}$ EGTA**\n    *   EGTA螯合$\\mathrm{Zn}^{2+}$但不螯合$\\mathrm{Mg}^{2+}$。因此，它会抑制CPSF73的切割作用，但不会抑制PAP的内在活性。\n    *   **预测：** 切割被显著抑制。多聚腺苷酸化的内在催化潜力受影响极小。\n\n*   **条件：EGTA + 回补**\n    *   **回补$0.1\\,\\mathrm{mM}$ $\\mathrm{ZnCl}_2$：** 这将补充被EGTA隔离的CPSF73的特异性辅因子。\n        *   **预测：** 切割被优先恢复。\n    *   **回补$2\\,\\mathrm{mM}$ $\\mathrm{MgCl}_2$：** PAP活性并未被EGTA显著抑制，所以添加更多的$\\mathrm{Mg}^{2+}$只会继续支持多聚腺苷酸化。它不会恢复切割。\n        *   **预测：** 主要支持多聚腺苷酸化。\n\n**评估选项**\n\n*   **A. $2\\,\\mathrm{mM}$的EDTA会废除切割和多聚腺苷酸化；回补$0.1\\,\\mathrm{mM}$的锌能恢复切割但不能恢复多聚腺苷酸化；回补$2\\,\\mathrm{mM}$的镁能恢复多聚腺苷酸化，但最多只能产生部分切割；回补$2\\,\\mathrm{mM}$的锰能同时恢复切割和多聚腺苷酸化；回补$2\\,\\mathrm{mM}$的钙两者都不能恢复。$2\\,\\mathrm{mM}$的EGTA显著抑制切割，但对多聚腺苷酸化的影响很小，在EGTA处理的反应中，回补锌优先恢复切割，而回补镁主要支持多聚腺苷酸化。**\n    该选项与我们从第一性原理推导出的每一个预测都精确匹配。每一项陈述都与所涉及的酶和螯合剂的已知生物化学性质相符。\n    **结论：正确。**\n\n*   **B. $2\\,\\mathrm{mM}$的EDTA废除切割，但基本不影响多聚腺苷酸化；回补$2\\,\\mathrm{mM}$的钙最能恢复切割；$0.1\\,\\mathrm{mM}$的锌会进一步抑制这两个步骤；$2\\,\\mathrm{mM}$的EGTA对切割和多聚腺苷酸化均无明显影响。**\n    这个选项在多个方面是错误的。首先，EDTA螯合$\\mathrm{Mg}^{2+}$，因此必须抑制多聚腺苷酸化。其次，$\\mathrm{Ca}^{2+}$不是切割反应的有效辅因子。第三，EGTA必须通过螯合$\\mathrm{Zn}^{2+}$来抑制切割。\n    **结论：错误。**\n\n*   **C. $2\\,\\mathrm{mM}$的EDTA通过移除抑制性的镁来增强切割；回补$2\\,\\mathrm{mM}$的镁会逆转这种增强效果；$0.1\\,\\mathrm{mM}$的锌是惰性的；$2\\,\\mathrm{mM}$的锰抑制多聚腺苷酸化但刺激切割；$2\\,\\mathrm{mM}$的EGTA阻断多聚腺苷酸化但不阻断切割。**\n    这个选项存在根本性缺陷。EDTA移除了*必需*的辅因子$\\mathrm{Zn}^{2+}$，因此它不能增强切割。对于一个锌酶来说，$\\mathrm{Zn}^{2+}$不可能是惰性的。EGTA阻断的是切割，而不是多聚腺苷酸化。\n    **结论：错误。**\n\n*   **D. $2\\,\\mathrm{mM}$的EDTA仅废除切割；回补$2\\,\\mathrm{mM}$的镁能完全恢复切割，而$0.1\\,\\mathrm{mM}$的锌无法恢复；$2\\,\\mathrm{mM}$的锰强烈抑制这两个步骤；$2\\,\\mathrm{mM}$的EGTA产生与EDTA相同的强抑制模式，没有选择性效应。**\n    这个选项包含许多错误。EDTA抑制两个步骤。$\\mathrm{Mg}^{2+}$不能恢复切割。$\\mathrm{Zn}^{2+}$才是应该恢复切割的辅因子。EGTA和EDTA具有不同的、选择性的效应。\n    **结论：错误。**\n\n*   **E. $2\\,\\mathrm{mM}$的EDTA废除切割和多聚腺苷酸化；只有$2\\,\\mathrm{mM}$的钙能有效恢复这两个步骤，而镁、锰和锌均无效；$2\\,\\mathrm{mM}$的EGTA选择性地抑制多聚腺苷酸化但不抑制切割，回补镁两者都不能恢复。**\n    这个选项是错误的。其核心论点，即$\\mathrm{Ca}^{2+}$是唯一能恢复活性的阳离子，与这些酶家族的所有既定原理相悖。此外，它错误地陈述了EGTA的选择性。\n    **结论：错误。**\n\n基于这一严谨的分析，选项A是唯一正确描述预期实验模式的选项。", "answer": "$$\\boxed{A}$$", "id": "2579248"}, {"introduction": "我们最后的练习将分析从静态快照提升到动态过程，要求我们为多聚腺苷酸（poly(A)）尾的合成建立一个定量模型。这个问题要求我们将生物学原理——持续的聚合反应与负反馈的竞争——转化为数学和计算框架。通过实施这个动力学模型，我们可以预测最终poly(A)尾长的分布，从而展示复杂的生物学特征是如何从简单的竞争规则中涌现出来的。[@problem_id:2579285]", "problem": "要求您形式化并计算在真核信使核糖核酸 (mRNA) $3^{\\prime}$ 端加工过程中，受多聚(A)结合蛋白核1 (PABPN1) 负反馈作用下的多聚腺苷酸尾长度的生物物理学分布。建模必须从基本的连续时间化学动力学出发：一个速率为 $k$ 的无记忆通道的下一次反应时间呈指数分布，并且，对于多个速率为 $\\{k_i\\}$ 的独立无记忆通道，下一次事件由通道 $i$ 执行的概率等于 $k_i / \\sum_j k_j$。多聚(A)聚合酶 (PAP) 催化腺苷酸逐个核苷酸地添加到 mRNA $3^{\\prime}$ 端。PABPN1 结合到正在增长的多聚(A)尾上，其占据会引发负反馈，提高有效终止速率，最终停止尾部延伸。\n\n将尾长建模为一个以核苷酸 (nt) 为单位的离散非负整数值随机变量 $N$。从 $n=0$ 开始。假设在任何长度 $n$ 处存在两个竞争性的无记忆事件通道：\n- 以速率 $k_{pol} > 0$（单位为 $\\mathrm{s}^{-1}$）添加下一个腺苷酸。\n- 以依赖于长度的速率 $k_{stop}(n)$（单位为 $\\mathrm{s}^{-1}$）进行反馈增强的终止。\n\n设终止速率为一个基础组分与一个 PABPN1 依赖的反馈组分之和：\n\n$$\nk_{stop}(n) \\equiv k_{0} + k_{fb}\\,\\theta(n),\n$$\n\n其中 $k_{0} \\ge 0$（单位为 $\\mathrm{s}^{-1}$）是基础终止速率，$k_{fb} \\ge 0$（单位为 $\\mathrm{s}^{-1}$）是反馈强度，而 $\\theta(n)$ 是一个唯象的 PABPN1 占据函数，它随 $n$ 增加并根据希尔系数为 $1$ 的希尔型形式饱和：\n\n$$\n\\theta(n) \\equiv \\frac{n}{n + K},\n$$\n\n其中 $K > 0$ 是一个半占据长度标度（单位为 nt）。在标准的无记忆竞争下，长度为 $n$ 时下一个事件是添加的概率等于\n\n$$\np_{add}(n) \\equiv \\frac{k_{pol}}{k_{pol} + k_{stop}(n)},\n$$\n\n而长度为 $n$ 时下一个事件是终止的概率等于\n\n$$\np_{term}(n) \\equiv \\frac{k_{stop}(n)}{k_{pol} + k_{stop}(n)} = 1 - p_{add}(n).\n$$\n\n将尾长分布 $P(N=n)$ 定义为从 $0$ 开始，终止事件恰好在长度 $n$ 处发生的概率。换句话说，聚合酶必须连续添加 $n$ 个腺苷酸，每次都竞争过终止事件，然后在长度为 $n$ 时竞争失败于终止事件。\n\n任务：\n- 仅使用上述原理，构建一个算法来计算概率质量函数 $P(N=n)$，其中 $n=0,1,2,\\dots$，计算至预设的最大长度 $n_{max}$（单位为 nt）或直到存活概率 $\\sum_{m>n} P(N=m)$ 低于容差 $\\varepsilon$ 为止。\n- 如果当 $n$ 达到 $n_{max}$ 时仍有剩余概率质量，则将所有剩余概率聚合到 $P(N=n_{max})$ 中，以确保 $\\sum_{n=0}^{n_{max}} P(N=n) = 1$ 在数值精度上成立。\n- 根据计算出的分布，计算期望尾长 $\\mathbb{E}[N] = \\sum_{n=0}^{n_{max}} n\\,P(N=n)$。\n- 以核苷酸 (nt) 为单位表示 $\\mathbb{E}[N]$，并四舍五入到恰好 $3$ 位小数。\n\n测试集：\n对下面给出的每组参数 $(k_{pol}, k_{0}, k_{fb}, K, n_{max}, \\varepsilon)$ 计算 $\\mathbb{E}[N]$。所有速率单位为 $\\mathrm{s}^{-1}$，长度单位为 nt。\n- 案例 $1$：$(k_{pol}, k_{0}, k_{fb}, K, n_{max}, \\varepsilon) = (\\,50.0,\\, 0.10,\\, 1.0,\\, 250.0,\\, 2000,\\, 10^{-12}\\,)$.\n- 案例 $2$：$(k_{pol}, k_{0}, k_{fb}, K, n_{max}, \\varepsilon) = (\\,50.0,\\, 0.0,\\, 10.0,\\, 150.0,\\, 2000,\\, 10^{-12}\\,)$.\n- 案例 $3$：$(k_{pol}, k_{0}, k_{fb}, K, n_{max}, \\varepsilon) = (\\,50.0,\\, 0.50,\\, 0.0,\\, 100.0,\\, 2000,\\, 10^{-12}\\,)$.\n- 案例 $4$：$(k_{pol}, k_{0}, k_{fb}, K, n_{max}, \\varepsilon) = (\\,5.0,\\, 2.0,\\, 5.0,\\, 100.0,\\, 1000,\\, 10^{-12}\\,)$.\n- 案例 $5$：$(k_{pol}, k_{0}, k_{fb}, K, n_{max}, \\varepsilon) = (\\,100.0,\\, 0.05,\\, 0.20,\\, 1000.0,\\, 5000,\\, 10^{-12}\\,)$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表顺序与上述案例相同，其中每个条目是四舍五入到恰好 $3$ 位小数的 $\\mathbb{E}[N]$（单位为 nt）；例如 $[\\mathbb{E}[N]_1,\\mathbb{E}[N]_2,\\dots]$。", "solution": "问题陈述已经过严格评估，并被确定为有效。它为模拟多聚(A)尾长分布提供了一个自洽、有科学依据且适定的表述。该问题基于化学动力学和分子生物学的既定原理，并且所有参数和目标都已足够精确地定义，以允许一个唯一且有意义的解。因此，我们将着手构建解决方案。\n\n核心任务是计算最终多聚(A)尾长 $N$ 的概率质量函数 (PMF)，记为 $P(N=n)$，其中 $n$ 是一个非负整数。该过程被建模为从初始长度 $n=0$ 开始的一系列竞争事件。为了使过程在特定长度 $n$ 处终止，它必须首先成功地通过 $n$ 个连续的添加步骤（从长度 $i=0$ 到 $i=n-1$）进行延伸，然后在长度 $n$ 处发生终止事件。\n\n设 $p_{add}(i)$ 为尾长为 $i$ 时添加一个腺苷酸的概率，设 $p_{term}(i)$ 为在相同长度下终止的概率。这些概率源于两个独立的无记忆过程之间的竞争：速率为 $k_{pol}$ 的聚合过程和速率依赖于长度的 $k_{stop}(i)$ 的终止过程。这些概率由下式给出：\n$$\np_{add}(i) = \\frac{k_{pol}}{k_{pol} + k_{stop}(i)}\n$$\n$$\np_{term}(i) = \\frac{k_{stop}(i)}{k_{pol} + k_{stop}(i)} = 1 - p_{add}(i)\n$$\n终止速率 $k_{stop}(i)$ 包含了负反馈，定义为：\n$$\nk_{stop}(i) = k_0 + k_{fb} \\frac{i}{i+K}\n$$\n\n为了推导 PMF，我们首先引入存活概率 $S(n)$ 的概念，它是指尾长达到至少为 $n$ 的值的概率。这需要一个不间断的成功添加序列。从长度为 $0$ 开始是确定的，我们定义 $S(0) = 1$。对于任何长度 $n > 0$，其存活概率是所有先前添加概率的乘积：\n$$\nS(n) = P(N \\ge n) = \\prod_{i=0}^{n-1} p_{add}(i)\n$$\n最终长度恰好为 $n$ 的事件，即 $N=n$，发生在聚合过程存活到长度 $n$ 然后终止的情况下。因此，其概率是存活到长度 $n$ 的概率 $S(n)$ 与在长度 $n$ 处的终止概率 $p_{term}(n)$ 的乘积：\n$$\nP(N=n) = S(n) \\cdot p_{term}(n)\n$$\n对于计算实现，更稳定的递推公式是更可取的。步骤 $n+1$ 的存活概率可以用步骤 $n$ 的存活概率来表示：\n$$\nS(n+1) = \\prod_{i=0}^{n} p_{add}(i) = \\left( \\prod_{i=0}^{n-1} p_{add}(i) \\right) \\cdot p_{add}(n) = S(n) \\cdot p_{add}(n)\n$$\n通过代入 $p_{add}(n) = 1 - p_{term}(n)$，我们得到了一个关键的递推关系：\n$$\nS(n+1) = S(n) \\cdot (1 - p_{term}(n)) = S(n) - S(n) \\cdot p_{term}(n) = S(n) - P(N=n)\n$$\n这个关系式，$S(n+1) = S(n) - P(N=n)$，表明存活超过长度 $n$ 的概率等于存活到长度 $n$ 的概率减去恰好在长度 $n$ 处终止的概率。这避免了将许多小的浮点数相乘可能导致的数值不稳定性。\n\n计算期望尾长 $\\mathbb{E}[N]$ 的算法如下：\n1.  初始化期望值累加器 $\\mathbb{E}[N] = 0$ 和初始存活概率 $S(0) = 1$。\n2.  使用长度索引 $n$ 从 $0$ 迭代至（但不包括）指定的最大长度 $n_{max}$。\n3.  在每次对给定 $n$ 的迭代中：\n    a. 使用参数 $k_0$、$k_{fb}$ 和 $K$ 计算终止速率 $k_{stop}(n)$。\n    b. 使用 $k_{pol}$ 和 $k_{stop}(n)$ 计算终止概率 $p_{term}(n)$。\n    c. 计算长度为 $n$ 的概率质量：$P(N=n) = S(n) \\cdot p_{term}(n)$。\n    d. 更新期望值：$\\mathbb{E}[N] \\leftarrow \\mathbb{E}[N] + n \\cdot P(N=n)$。\n    e. 使用递推关系更新下一步的存活概率：$S(n+1) \\leftarrow S(n) - P(N=n)$。\n    f. 检查提前终止条件：如果更新后的存活概率 $S(n+1)$ 低于容差 $\\varepsilon$，则剩余的分布质量可以忽略不计。循环终止，并将当前的 $\\mathbb{E}[N]$ 值视为最终结果。\n4.  如果循环完成而存活概率没有降到 $\\varepsilon$ 以下，这意味着分布在 $n_{max}$ 或更长处有显著的质量。在这种情况下，问题规定必须将全部剩余概率质量（即最终的存活概率 $S(n_{max})$）聚合到 $n_{max}$ 的区间中。\n5.  将这个聚合的尾部概率对期望的贡献加上：$\\mathbb{E}[N] \\leftarrow \\mathbb{E}[N] + n_{max} \\cdot S(n_{max})$。\n6.  然后按要求将 $\\mathbb{E}[N]$ 的最终结果四舍五入到 $3$ 位小数。\n\n该算法正确地实现了指定的生物物理模型及其对每个测试用例的计算要求。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected poly(A) tail length for a series of test cases\n    based on a kinetic model of polymerization and termination.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (k_pol, k_0, k_fb, K, n_max, eps)\n    test_cases = [\n        (50.0, 0.10, 1.0, 250.0, 2000, 1e-12),\n        (50.0, 0.0, 10.0, 150.0, 2000, 1e-12),\n        (50.0, 0.50, 0.0, 100.0, 2000, 1e-12),\n        (5.0, 2.0, 5.0, 100.0, 1000, 1e-12),\n        (100.0, 0.05, 0.20, 1000.0, 5000, 1e-12),\n    ]\n\n    results = []\n    for case in test_cases:\n        k_pol, k_0, k_fb, K, n_max, eps = case\n        \n        expected_length = 0.0\n        # survival_prob represents S(n), the probability of reaching length n.\n        survival_prob = 1.0\n\n        # Loop from n=0 to n=n_max-1\n        for n in range(n_max):\n            # Calculate PABPN1 occupancy function theta(n)\n            # K > 0 is a given constraint, so n + K is safe.\n            theta_n = n / (n + K)\n            \n            # Calculate length-dependent termination rate k_stop(n)\n            k_stop_n = k_0 + k_fb * theta_n\n            \n            # Calculate total rate of events\n            # k_pol > 0 is a given constraint, so total_rate > 0.\n            total_rate = k_pol + k_stop_n\n            \n            # Probability of termination at length n\n            p_term_n = k_stop_n / total_rate\n            \n            # Probability mass P(N=n) is S(n) * p_term(n)\n            prob_at_n = survival_prob * p_term_n\n            \n            # Add contribution to the expected length\n            expected_length += n * prob_at_n\n            \n            # Update survival probability for length n+1: S(n+1) = S(n) - P(N=n)\n            survival_prob -= prob_at_n\n            \n            # Check for early termination if survival probability becomes negligible\n            # The survival probability here is now P(N > n) = S(n+1)\n            if survival_prob  eps:\n                # The remaining probability is negligible, so its contribution\n                # to the expectation can be ignored.\n                break\n        else:\n            # This 'else' block executes only if the loop completes without a 'break'.\n            # This corresponds to the case where the distribution is truncated at n_max.\n            # Aggregate all remaining probability into the n_max bin.\n            # The final 'survival_prob' is P(N = n_max).\n            expected_length += n_max * survival_prob\n            \n        results.append(f\"{expected_length:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2579285"}]}