{"hands_on_practices": [{"introduction": "本练习将带您深入了解支序分类学的核心方法——最大简约法（Maximum Parsimony）。在系统发育分析中，我们常常面临多种可能的进化树拓扑结构，而简约法原则（即奥卡姆剃刀原则）为我们提供了一个选择最佳假说的标准。通过亲手计算不同拓扑结构下解释性状数据所需的最小演化步数（即“简约性得分”），您将掌握评估和比较进化树的核心技能 [@problem_id:2554471]。", "problem": "给定四个末端分类单元，记为 $A$、$B$、$C$ 和 $D$。它们从一个中等分化程度的单个演化支中取样，该演化支属于一项涵盖动物学和植物学数据集的比较研究。考虑以下针对这些分类单元编码的离散形态特征矩阵。所有特征均被视为无序、等权重的，并依据最大简约法 (MP) 原则进行分析。数据中没有缺失值，也没有多态性编码。\n\n特征状态：\n-   特征 $1$：$A=0$, $B=0$, $C=1$, $D=1$。\n-   特征 $2$：$A=0$, $B=1$, $C=0$, $D=1$。\n-   特征 $3$：$A=0$, $B=1$, $C=1$, $D=0$。\n-   特征 $4$：$A=0$, $B=0$, $C=1$, $D=1$。\n-   特征 $5$：$A=1$, $B=0$, $C=0$, $D=0$。\n-   特征 $6$：$A=0$, $B=2$, $C=2$, $D=0$。\n\n假设四个分类单元存在标准的三种无根二叉拓扑结构。请为以下三种不同的无根分叉树中的每一种，计算其总简约分数（即所有特征的最小特征状态变化数之和）：\n-   $T_{1}$：划分 $AB|CD$，\n-   $T_{2}$：划分 $AC|BD$，\n-   $T_{3}$：划分 $AD|BC$。\n\n从第一性原理出发：使用最大简约法的定义，为每种拓扑结构上的每个特征确定解释其在末端观察到的状态所需的最小变化数，然后将所有特征的变化数相加，以获得该拓扑结构的总简约分数。根据这些总分，确定最简约的一棵或多棵树。\n\n重要提示：作为最终答案，只需报告最小总简约分数（记为 $S_{\\min}$），该分数为一个整数。最终答案中请勿包含任何拓扑结构的描述。无需进行四舍五入。", "solution": "该问题是有效的，因为它在系统发育学领域提出了一个适定问题，并提供了获得唯一解所需的所有必要数据和约束条件。其科学基础是已确立的最大简约法原则。\n\n任务是为一个给定的、针对 $4$ 个分类单元（$A$、$B$、$C$ 和 $D$）编码的特征矩阵，确定其最小总简约分数，记为 $S_{\\min}$。该分析必须考虑 $4$ 个分类单元可能存在的三种不同的无根二分拓扑结构。特征被指定为无序且等权重，这决定了必须使用 Fitch 简约法算法来计算每个特征在每种拓扑结构上的演化成本（即步数）。\n\n这 $3$ 种拓扑结构由其中心内部分支所创造的分类单元二分法定义：\n-   $T_{1}$：该拓扑结构将 $\\{A,B\\}$ 与 $\\{C,D\\}$ 分开，记为划分 $AB|CD$。\n-   $T_{2}$：该拓扑结构将 $\\{A,C\\}$ 与 $\\{B,D\\}$ 分开，记为划分 $AC|BD$。\n-   $T_{3}$：该拓扑结构将 $\\{A,D\\}$ 与 $\\{B,C\\}$ 分开，记为划分 $AD|BC$。\n\n任何拓扑结构的总简约分数是解释所有特征的观察状态所需的最小特征状态变化数的总和。我们将通过计算每个特征在每种拓扑结构上的分数来完成此任务。在一个有 $4$ 个分类单元的情况下，一个特征的分数可以由其状态分布模式确定：\n\n-   如果一个特征是恒定的（例如，状态为 $(0,0,0,0)$），或者只有一个分类单元拥有一个独特的状态（一个独征，例如，状态为 $(1,0,0,0)$），那么这个特征在系统发育上是无信息量的。一个恒定的特征在任何树上都需要 $0$ 步。一个独征在任何树上都需要恰好 $1$ 步，因为必须有一条分支来解释这个独特的状态变化。\n-   如果一个特征至少有两个状态，且每个状态至少出现在两个分类单元中，那么它就是简约信息性的。对于 $4$ 个分类单元，这对应于形式为 $(x,x,y,y)$ 的状态模式。这样的特征在将具有相同状态的分类单元分组的拓扑结构上需要 $1$ 步，而在另外两种拓扑结构上需要 $2$ 步。\n\n我们现在将此逻辑应用于所提供的 $6$ 个特征。设 $S(C_i, T_j)$ 为特征 $C_i$ 在拓扑结构 $T_j$ 上的简约分数。\n\n特征 $1$：状态为 $(A=0, B=0, C=1, D=1)$。这是一个 $(0,0,1,1)$ 类型的简约信息性模式，它支持划分 $AB|CD$。\n$$S(C_1, T_1) = 1, \\quad S(C_1, T_2) = 2, \\quad S(C_1, T_3) = 2$$\n\n特征 $2$：状态为 $(A=0, B=1, C=0, D=1)$。这是一个信息性模式 $(0,1,0,1)$，它支持划分 $AC|BD$。\n$$S(C_2, T_1) = 2, \\quad S(C_2, T_2) = 1, \\quad S(C_2, T_3) = 2$$\n\n特征 $3$：状态为 $(A=0, B=1, C=1, D=0)$。这是一个信息性模式 $(0,1,1,0)$，它支持划分 $AD|BC$。\n$$S(C_3, T_1) = 2, \\quad S(C_3, T_2) = 2, \\quad S(C_3, T_3) = 1$$\n\n特征 $4$：状态为 $(A=0, B=0, C=1, D=1)$。该模式与特征 $1$ 的模式相同，支持划分 $AB|CD$。\n$$S(C_4, T_1) = 1, \\quad S(C_4, T_2) = 2, \\quad S(C_4, T_3) = 2$$\n\n特征 $5$：状态为 $(A=1, B=0, C=0, D=0)$。该模式代表分类单元 $A$ 的一个独征，是简约非信息性的。它在任何拓扑结构上都需要 $1$ 步。\n$$S(C_5, T_1) = 1, \\quad S(C_5, T_2) = 1, \\quad S(C_5, T_3) = 1$$\n\n特征 $6$：状态为 $(A=0, B=2, C=2, D=0)$。由于特征是无序的，这是一个 $(x,y,y,x)$ 类型的信息性模式，它支持划分 $AD|BC$。\n$$S(C_6, T_1) = 2, \\quad S(C_6, T_2) = 2, \\quad S(C_6, T_3) = 1$$\n\n每个拓扑结构的总简约分数 $S(T_j)$ 是各个特征分数的总和：$S(T_j) = \\sum_{i=1}^{6} S(C_i, T_j)$。\n\n拓扑结构 $T_{1}$ ($AB|CD$) 的总分：\n$$S(T_1) = 1 + 2 + 2 + 1 + 1 + 2 = 9$$\n\n拓扑结构 $T_{2}$ ($AC|BD$) 的总分：\n$$S(T_2) = 2 + 1 + 2 + 2 + 1 + 2 = 10$$\n\n拓扑结构 $T_{3}$ ($AD|BC$) 的总分：\n$$S(T_3) = 2 + 2 + 1 + 2 + 1 + 1 = 9$$\n\n比较总分，我们得到 $S(T_1)=9$，$S(T_2)=10$ 和 $S(T_3)=9$。最大简约法原则偏好得分最低的一棵或多棵树。此处，拓扑结构 $T_1$ 和 $T_3$ 是同等最简约的。最小总简约分数 $S_{\\min}$ 是这些值中的最小值。\n$$S_{\\min} = \\min(9, 10, 9) = 9$$\n这就是最终要求的值。", "answer": "$$\\boxed{9}$$", "id": "2554471"}, {"introduction": "与关注共享祖先的支序分类学不同，表征分类学（Phenetics），或称数值分类学，侧重于根据生物体间的总体相似性进行分组。本练习将引导您解决一个在实践中常见的问题：如何处理混合类型的性状数据（如连续测量值、有序等级和二元状态）。您将学习并应用高尔距离（Gower distance）这一通用工具来量化不同分类单元间的相异度，这对于理解基于相似性的分类方法至关重要 [@problem_id:2554427]。", "problem": "在比较动物学和植物学的表型系统学中，总体相似性是在不预设共同祖先的前提下，对异质性状进行量化。当样本由混合类型的性状——连续形态计量、等级评分和二元存在或缺失——描述时，一个可解释的相异性度量应尊重性状尺度，允许合理的性状加权，并恰当处理存在或缺失状态的不对称信息含量。从以下基本要求出发：两个分类单元之间的表型相异性应为闭区间 $\\left[0,1\\right]$ 内各性状标准化相异性的平均值；连续测量值应通过极差标准化在线性重缩放下保持尺度不变；等级性状应基于其等级顺序而非标签进行比较；对于不对称二元状态，共同缺失不应与共同存在具有相同的证据权重。请基于这些要求，为使用Gower型相异性提供一个论证，并推导出其适用于此混合数据设置的加权形式。您的推导必须明确说明如何使用权重组合各性状的相异性，以及如何通过各性状的包含指示符排除无信息量的比较。\n\n给定三个分类单元，记为 $T_{1}$、$T_{2}$ 和 $T_{3}$，每个单元由四个性状描述：\n- 连续形态计量：叶长（厘米）：$T_{1} = 5.2$, $T_{2} = 7.1$, $T_{3} = 6.0$。\n- 等级形态学：三级量表上的刺密度 $\\{\\text{低}, \\text{中}, \\text{高}\\}$，编码为等级 $\\{1,2,3\\}$：$T_{1} = 1$ (\\text{低}), $T_{2} = 3$ (\\text{高}), $T_{3} = 2$ (\\text{中})。\n- 对称二元生态学：昼行性（$1$ 表示昼行，$0$ 表示夜行）：$T_{1} = 1$, $T_{2} = 1$, $T_{3} = 0$。\n- 不对称二元化学：生物碱存在与否（$1$ 表示存在，$0$ 表示缺失），作为不对称性状处理，因此共同缺失的情况在该性状的比较中被排除：$T_{1} = 0$, $T_{2} = 1$, $T_{3} = 0$。\n\n使用以下反映测量可靠性和预期演化不稳定性的非负性状权重：连续形态计量权重 $w_{c} = 0.4$，等级形态学权重 $w_{o} = 0.3$，对称二元性状权重 $w_{b} = 0.2$，以及不对称二元性状权重 $w_{a} = 0.1$。\n\n任务：\n- 从上述基本原则出发，论证为混合数据选择Gower型相异性的合理性，并推导适用于这四个性状的加权成对相异性，明确指定每种数据类型的各性状相异性函数，以及在归一化中排除无信息量的不对称二元性状共同缺失的规则。\n- 计算 $T_{1}$、$T_{2}$ 和 $T_{3}$ 之间的所有三个成对相异性，构成完整的 $3 \\times 3$ 相异性矩阵（对角线元素为零）。\n- 仅报告 $T_{1}$ 和 $T_{3}$ 之间的相异性作为您的最终答案。将此最终相异性表示为一个四舍五入到四位有效数字的无单位数。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了数值分类学中的一个标准任务：为具有混合性状类型的数据集计算表型相异性矩阵。为相异性度量提供的原则是Gower通用相异性系数的定义性公理。数据、权重和目标都以足够的精度指定，可以得到唯一且可验证的解。因此，该问题是有效的，我们可以进行推导和计算。\n\n目标是为混合数据类型构建一个广义相异性度量，并将其应用于给定的分类单元。基本要求是，两个分类单元 $T_i$ 和 $T_j$ 之间的总相异性 $D(T_i, T_j)$ 是对所有 $p$ 个性状的各性状相异性 $d_{ijk}$ 的加权平均值。每个 $d_{ijk}$ 都必须归一化到闭区间 $[0,1]$。这由Gower相异性的一般公式表示：\n$$\nD(T_i, T_j) = \\frac{\\sum_{k=1}^{p} \\delta_{ijk} w_k d_{ijk}}{\\sum_{k=1}^{p} \\delta_{ijk} w_k}\n$$\n此处，$k$ 是性状的索引，从 $k=1$ 到 $p=4$。项 $w_k$ 代表用户为性状 $k$ 定义的权重。项 $d_{ijk}$ 是分类单元 $i$ 和 $j$ 之间关于性状 $k$ 的相异性得分。关键组成部分是指示变量 $\\delta_{ijk}$，如果分类单元 $i$ 和 $j$ 之间关于性状 $k$ 的比较是有效且信息量丰富的，则其值为 $1$，否则为 $0$。该指示符对于处理缺失数据，或如本问题中，对于排除无信息量的比较（例如不对称二元性状的共同缺失）至关重要。\n\n现在，我们将根据问题中阐述的原则，为四种性状类型中的每一种定义 $d_{ijk}$ 和 $\\delta_{ijk}$ 的具体形式。\n\n1.  **连续形态计量性状 ($k=c$)：叶长**\n    原则是通过极差标准化实现尺度不变性。对于一个连续性状测量值 $x_k$，值 $x_{ic}$ 和 $x_{jc}$ 之间的相异性 $d_{ijc}$ 是这两个值的绝对差除以数据集中所有分类单元该性状的总极差 $R_c$。\n    $$\n    d_{ijc} = \\frac{|x_{ic} - x_{jc}|}{R_c}\n    $$\n    其中 $R_c = \\max_h(x_{hc}) - \\min_h(x_{hc})$。对于给定的分类单元，叶长分别为 $5.2$、$7.1$ 和 $6.0$。极差为 $R_c = 7.1 - 5.2 = 1.9$。对于此性状类型，比较始终有效，因此 $\\delta_{ijc} = 1$。给定的权重为 $w_c = 0.4$。\n\n2.  **等级形态学性状 ($k=o$)：刺密度**\n    原则是基于等级顺序进行比较。该性状有 $M_o = 3$ 个水平，编码为等级 $\\{1, 2, 3\\}$。为了将相异性归一化到 $[0,1]$，我们将等级的绝对差除以最大可能的等级差，即 $M_o - 1$。\n    $$\n    d_{ijo} = \\frac{|r_{io} - r_{jo}|}{M_o - 1}\n    $$\n    对于等级 $r_{io}$ 和 $r_{jo}$，当 $M_o=3$ 时，公式变为 $d_{ijo} = \\frac{|r_{io} - r_{jo}|}{2}$。比较始终有效，因此 $\\delta_{ijo} = 1$。权重为 $w_o = 0.3$。\n\n3.  **对称二元性状 ($k=b$)：昼行性**\n    对于对称二元性状，两种状态（$0$ 和 $1$）携带同等信息。匹配（$0-0$ 或 $1-1$）对相异性的贡献为 $0$，而不匹配（$0-1$ 或 $1-0$）的贡献为 $1$。\n    $$\n    d_{ijb} = \\begin{cases} 0  \\text{if } x_{ib} = x_{jb} \\\\ 1  \\text{if } x_{ib} \\neq x_{jb} \\end{cases}\n    $$\n    这是简单匹配相异性。比较始终有效，因此 $\\delta_{ijb} = 1$。权重为 $w_b = 0.2$。\n\n4.  **不对称二元性状 ($k=a$)：生物碱存在与否**\n    此处的原则是，共同存在（$1-1$）是信息丰富的，但共同缺失（$0-0$）则不是。这使得指示符 $\\delta_{ija}$ 的使用成为必要。不匹配（$0-1$ 或 $1-0$）表示相异性为 $1$。共同存在（$1-1$）表示相似，因此相异性为 $0$。\n    $$\n    d_{ija} = \\begin{cases} 0  \\text{if } x_{ia} = 1 \\text{ and } x_{ja} = 1 \\\\ 1  \\text{if } x_{ia} \\neq x_{ja} \\end{cases}\n    $$\n    指示符 $\\delta_{ija}$ 的定义是为了排除共同缺失这一无信息量的情况：\n    $$\n    \\delta_{ija} = \\begin{cases} 0  \\text{if } x_{ia} = 0 \\text{ and } x_{ja} = 0 \\\\ 1  \\text{otherwise} \\end{cases}\n    $$\n    权重为 $w_a = 0.1$。\n\n现在，我们计算所需的成对相异性 $D(T_1, T_3)$。\n分类单元 $T_1$ 和 $T_3$ 的数据为：\n- $T_1$: $x_{1c}=5.2$, $r_{1o}=1$, $x_{1b}=1$, $x_{1a}=0$。\n- $T_3$: $x_{3c}=6.0$, $r_{3o}=2$, $x_{3b}=0$, $x_{3a}=0$。\n\n我们计算对 $(T_1, T_3)$ 的每个性状的加权相异性。\n\n- **连续性状 ($k=c$)**：\n    $d_{13c} = \\frac{|5.2 - 6.0|}{1.9} = \\frac{0.8}{1.9}$。\n    $\\delta_{13c} = 1$。\n    对分子的贡献：$\\delta_{13c} w_c d_{13c} = 1 \\times 0.4 \\times \\frac{0.8}{1.9} = \\frac{0.32}{1.9}$。\n\n- **等级性状 ($k=o$)**：\n    $d_{13o} = \\frac{|1 - 2|}{3 - 1} = \\frac{1}{2} = 0.5$。\n    $\\delta_{13o} = 1$。\n    对分子的贡献：$\\delta_{13o} w_o d_{13o} = 1 \\times 0.3 \\times 0.5 = 0.15$。\n\n- **对称二元性状 ($k=b$)**：\n    $x_{1b} = 1$ 且 $x_{3b} = 0$，因此这是一个不匹配。\n    $d_{13b} = 1$。\n    $\\delta_{13b} = 1$。\n    对分子的贡献：$\\delta_{13b} w_b d_{13b} = 1 \\times 0.2 \\times 1 = 0.2$。\n\n- **不对称二元性状 ($k=a$)**：\n    $x_{1a} = 0$ 且 $x_{3a} = 0$。这是一个共同缺失的情况。\n    根据我们的定义，这个比较是无信息量的。\n    $\\delta_{13a} = 0$。\n    对分子的贡献：$\\delta_{13a} w_a d_{13a} = 0 \\times 0.1 \\times d_{13a} = 0$。\n\n现在，我们将这些贡献相加，以构成 $D(T_1, T_3)$ 的分子和分母。\n分子：\n$$\n\\sum_{k=1}^{4} \\delta_{13k} w_k d_{13k} = \\frac{0.32}{1.9} + 0.15 + 0.2 + 0 = \\frac{0.32}{1.9} + 0.35\n$$\n分母：\n$$\n\\sum_{k=1}^{4} \\delta_{13k} w_k = (1 \\times w_c) + (1 \\times w_o) + (1 \\times w_b) + (0 \\times w_a) = 0.4 + 0.3 + 0.2 + 0 = 0.9\n$$\n相异性为：\n$$\nD(T_1, T_3) = \\frac{\\frac{0.32}{1.9} + 0.35}{0.9} = \\frac{\\frac{0.32 + 0.35 \\times 1.9}{1.9}}{0.9} = \\frac{0.32 + 0.665}{1.9 \\times 0.9} = \\frac{0.985}{1.71}\n$$\n执行最后的除法：\n$$\nD(T_1, T_3) \\approx 0.575994152...\n$$\n问题要求将此值四舍五入到四位有效数字。\n$D(T_1, T_3) \\approx 0.5760$。\n\n为求完整，我们指出，其他成对相异性将以类似方式计算，以构成完整的相异性矩阵。\n对于 $D(T_1, T_2)$：所有 $\\delta_{12k}=1$。 $D(T_1, T_2) = (0.4 \\times \\frac{|5.2-7.1|}{1.9} + 0.3 \\times \\frac{|1-3|}{2} + 0.2 \\times 0 + 0.1 \\times 1) / (0.4+0.3+0.2+0.1) = (0.4 \\times 1 + 0.3 \\times 1 + 0 + 0.1)/1 = 0.8$。\n对于 $D(T_2, T_3)$：所有 $\\delta_{23k}=1$。 $D(T_2, T_3) = (0.4 \\times \\frac{|7.1-6.0|}{1.9} + 0.3 \\times \\frac{|3-2|}{2} + 0.2 \\times 1 + 0.1 \\times 1) / 1 = 0.4 \\times \\frac{1.1}{1.9} + 0.3 \\times 0.5 + 0.2 + 0.1 \\approx 0.2316 + 0.15 + 0.3 \\approx 0.6816$。\n\n最终要求的值仅为 $D(T_1, T_3)$。", "answer": "$$\n\\boxed{0.5760}\n$$", "id": "2554427"}, {"introduction": "在确定了最优的进化树之后，下一步是解读其所讲述的演化故事。本练习探讨了当数据存在多种同等简约的解释时，如何重建祖先节点的性状状态。通过应用ACCTRAN（加速演化）和DELTRAN（延迟演化）两种优化算法，您将亲身体验不同的重建偏好如何导致截然不同的生物学叙事（例如，一次性状获得后多次丢失，还是多次独立获得），从而深刻理解系统发育分析中的解释深度 [@problem_id:2554461]。", "problem": "给定一个包含 $5$ 个末端分类单元的有根系统发育树，其拓扑结构为 $T = \\big((A,B),(C,(D,E))\\big)$，根位于分支 $\\big(A,B\\big)$ 和分支 $\\big(C,(D,E)\\big)$ 之间的分歧点。考虑一个单一的、无序、等权重的二态性状，其中状态 $1$ 表示一个推定的衍生性状的存在，状态 $0$ 表示其不存在。观察到的末端状态为：$A=1$，$B=0$，$C=1$，$D=0$ 和 $E=0$。根节点的状态没有事先指定。使用最大简约法（MP）和 Fitch 算法计算最小步数，并在加速转换优化（ACCTRAN）和延迟转换优化（DELTRAN）两种方法下优化性状变化。具体要求如下：\n\n- 从 MP 和针对无序二态性状的 Fitch 集合并集/交集算法的基本定义出发，在给定的有根树上执行一次自下而上的集合计算，以确定最小简约长度。\n- 然后，在 ACCTRAN 和 DELTRAN 方法下分别进行自上而下的重构，以在每种情况下都保持最小步数不变的方式来定位变化。\n- 对于每种优化方法，确定状态变化（最小步数）的数量，并将每次变化分类为获得（$0 \\to 1$）或逆转（$1 \\to 0$）。\n- 从生物学角度简要解释 ACCTRAN 与 DELTRAN 如何改变推断的演化情景（单次早期起源并伴随丢失 vs. 多次独立起源），并评论这与基于总体相似性的纯表征学观点有何不同。\n\n作为你的最终数值答案，报告 $\\Delta G = G_{\\mathrm{DELTRAN}} - G_{\\mathrm{ACCTRAN}}$ 的值，其中 $G_{\\mathrm{ACCTRAN}}$ 和 $G_{\\mathrm{DELTRAN}}$ 分别是在 ACCTRAN 和 DELTRAN 方法下推断出的获得次数。无需四舍五入。请以不带单位的纯数字形式提供你的最终数值答案。", "solution": "所提出的问题是使用最大简约法原理进行系统发育推断的一个标准练习。该问题具有科学依据，定义明确，并包含了在指定算法下获得唯一解所需的所有信息。我们将进行形式化分析。\n\n该问题要求在一个给定的、包含五个分类单元的有根系统发育树上分析一个单一的二态性状。拓扑结构为 $T = \\big((A,B),(C,(D,E))\\big)$，观察到的末端性状状态为 $s_A=1$，$s_B=0$，$s_C=1$，$s_D=0$ 和 $s_E=0$。该性状是无序的，意味着从状态 $0$ 变为 $1$ 的代价与从 $1$ 变为 $0$ 的代价相同，均为一步。\n\n首先，为了清晰起见，我们必须标记树的内部节点。设 $N_1$ 是分类单元 $A$ 和 $B$ 的最近共同祖先（MRCA）。设 $N_2$ 是 $D$ 和 $E$ 的 MRCA。设 $N_3$ 是 $C$ 和分支 $(D,E)$ 的 MRCA。最后，设 $N_4$ 是树的根，即所有五个分类单元的 MRCA。树的结构因此如下：\n$$\n\\text{Root } N_4 \\rightarrow (N_1, N_3)\n$$\n$$\nN_1 \\rightarrow (A, B)\n$$\n$$\nN_3 \\rightarrow (C, N_2)\n$$\n$$\nN_2 \\rightarrow (D, E)\n$$\n\n分析分三部分进行：首先，使用 Fitch 算法进行一次自下而上的过程，以确定性状状态变化的最小数量（简约分数）；其次，根据 ACCTRAN 和 DELTRAN 优化标准，进行两次自上而下的过程来分配特定的祖先状态；第三，根据结果进行计算。\n\n**第一部分：使用 Fitch 算法进行自下而上的过程以确定简约分数**\n\nFitch 算法从末端开始向根部移动，确定每个内部节点的可能状态集。对于任意一个具有两个后代节点 $i$ 和 $j$（其状态集分别为 $S_i$ 和 $S_j$）的节点 $k$，其状态集 $S_k$ 计算如下：\n- 如果 $S_i \\cap S_j \\neq \\emptyset$，则 $S_k = S_i \\cap S_j$。在该节点增加的长度（步数）为 $0$。\n- 如果 $S_i \\cap S_j = \\emptyset$，则 $S_k = S_i \\cup S_j$。在该节点增加的长度为 $1$。\n\n我们将此过程应用于给定的树。\n\n1.  **末端节点（叶节点）：** 状态集由观测数据确定。\n    - $S_A = \\{1\\}$\n    - $S_B = \\{0\\}$\n    - $S_C = \\{1\\}$\n    - $S_D = \\{0\\}$\n    - $S_E = \\{0\\}$\n\n2.  **内部节点 $N_2$（$D, E$ 的 MRCA）：**\n    - 其后代的状态集为 $S_D=\\{0\\}$ 和 $S_E=\\{0\\}$。\n    - $S_D \\cap S_E = \\{0\\} \\cap \\{0\\} = \\{0\\}$。交集非空。\n    - 因此，$S_{N_2} = \\{0\\}$。\n    - 长度增量：$L_{N_2} = 0$。\n\n3.  **内部节点 $N_1$（$A, B$ 的 MRCA）：**\n    - 其后代的状态集为 $S_A=\\{1\\}$ 和 $S_B=\\{0\\}$。\n    - $S_A \\cap S_B = \\{1\\} \\cap \\{0\\} = \\emptyset$。交集为空。\n    - 因此，$S_{N_1} = S_A \\cup S_B = \\{0, 1\\}$。\n    - 长度增量：$L_{N_1} = 1$。\n\n4.  **内部节点 $N_3$（$C, N_2$ 的 MRCA）：**\n    - 其后代的状态集为 $S_C=\\{1\\}$ 和 $S_{N_2}=\\{0\\}$。\n    - $S_C \\cap S_{N_2} = \\{1\\} \\cap \\{0\\} = \\emptyset$。交集为空。\n    - 因此，$S_{N_3} = S_C \\cup S_{N_2} = \\{0, 1\\}$。\n    - 长度增量：$L_{N_3} = 1$。\n\n5.  **根节点 $N_4$（$N_1, N_3$ 的 MRCA）：**\n    - 其后代的状态集为 $S_{N_1}=\\{0, 1\\}$ 和 $S_{N_3}=\\{0, 1\\}$。\n    - $S_{N_1} \\cap S_{N_3} = \\{0, 1\\} \\cap \\{0, 1\\} = \\{0, 1\\}$。交集非空。\n    - 因此，$S_{N_4} = \\{0, 1\\}$。\n    - 长度增量：$L_{N_4} = 0$。\n\n该性状的总简约分数是每个内部节点长度增量的总和：\n$$\nL_{Total} = L_{N_1} + L_{N_2} + L_{N_3} + L_{N_4} = 1 + 0 + 1 + 0 = 2\n$$\n在这棵树上解释观察到的性状分布所需的最小步数为 $2$。\n\n**第二部分：ACCTRAN 和 DELTRAN 祖先状态重构**\n\nFitch 的自下而上过程导致节点 $N_1$、$N_3$ 和 $N_4$ 的状态集是模糊的。这意味着有多种分配祖先状态的方式可以得到相同的最小分数 $2$。ACCTRAN（加速转换）和 DELTRAN（延迟转换）是次级优化标准，它们通过提供在树上定位变化的规则来解决这种模糊性。\n\n**ACCTRAN 优化：** ACCTRAN 偏好发生在树中较早位置（更靠近根部）的转换。该算法偏好涉及单次获得后多次逆转的演化情景，而不是多次独立获得的情景。它通过偏好父节点的状态来解决模糊性。对于没有父节点的根节点，它实际上选择了将变化推向树更深处的状态。在这种情况下，它导致了一个重构，该重构意味着整个分支的状态 $1$ 是单次起源，随后发生了丢失（逆转为状态 $0$）。\n\n-   **状态分配：** ACCTRAN 将状态 $1$ 分配给根节点 $N_4$。然后这个状态向下传递。\n    - $s_{N_4} = 1$。\n    - 对于 $N_1$，其父节点状态 $s_{N_4}=1$ 在其状态集 $S_{N_1}=\\{0, 1\\}$ 中，所以 $s_{N_1}=1$。\n    - 对于 $N_3$，其父节点状态 $s_{N_4}=1$ 在其状态集 $S_{N_3}=\\{0, 1\\}$ 中，所以 $s_{N_3}=1$。\n    - 对于 $N_2$，其父节点状态 $s_{N_3}=1$ 不在其状态集 $S_{N_2}=\\{0\\}$ 中，因此必须发生一次变化。其状态必须是 $s_{N_2}=0$。\n-   **ACCTRAN 下的变化：**\n    - 从 $N_1$ 到末端 $B$ 的分支需要一次从 $s_{N_1}=1$ 到 $s_B=0$ 的变化。这是一次逆转（$1 \\to 0$）。\n    - 从 $N_3$ 到节点 $N_2$ 的分支需要一次从 $s_{N_3}=1$ 到 $s_{N_2}=0$ 的变化。这也是一次逆转（$1 \\to 0$）。\n    - 所有其他分支都不需要变化。\n-   **ACCTRAN 总结：**\n    - 总步数 = $2$。\n    - 获得次数（$0 \\to 1$）：$G_{\\mathrm{ACCTRAN}} = 0$。\n    - 逆转次数（$1 \\to 0$）：$R_{\\mathrm{ACCTRAN}} = 2$。\n    - 这种情景意味着该类群的共同祖先拥有该性状（状态 $1$），之后独立地丢失了两次。\n\n**DELTRAN 优化：** DELTRAN 偏好发生在树中较晚位置（更靠近末端）的转换。该算法偏好多重独立获得（平行演化）的情景，而不是单次获得后发生逆转的情景。它通过偏好与后代节点共享的状态来解决模糊性。对于根节点，它实际上选择了将变化推离根部的状态。\n\n-   **状态分配：** DELTRAN 将状态 $0$ 分配给根节点 $N_4$。\n    - $s_{N_4} = 0$。\n    - 对于 $N_1$，其父节点状态 $s_{N_4}=0$ 在其状态集 $S_{N_1}=\\{0, 1\\}$ 中，所以 $s_{N_1}=0$。\n    - 对于 $N_3$，其父节点状态 $s_{N_4}=0$ 在其状态集 $S_{N_3}=\\{0, 1\\}$ 中，所以 $s_{N_3}=0$。\n    - 对于 $N_2$，其父节点状态 $s_{N_3}=0$ 在其状态集 $S_{N_2}=\\{0\\}$ 中，所以 $s_{N_2}=0$。所有内部节点都被分配了状态 $0$。\n-   **DELTRAN 下的变化：**\n    - 从 $N_1$ 到末端 $A$ 的分支需要一次从 $s_{N_1}=0$ 到 $s_A=1$ 的变化。这是一次获得（$0 \\to 1$）。\n    - 从 $N_3$ 到末端 $C$ 的分支需要一次从 $s_{N_3}=0$ 到 $s_C=1$ 的变化。这也是一次获得（$0 \\to 1$）。\n    - 所有其他分支都不需要变化。\n-   **DELTRAN 总结：**\n    - 总步数 = $2$。\n    - 获得次数（$0 \\to 1$）：$G_{\\mathrm{DELTRAN}} = 2$。\n    - 逆转次数（$1 \\to 0$）：$R_{\\mathrm{DELTRAN}} = 0$。\n    - 这种情景意味着共同祖先缺少该性状（状态 $0$），并且它在通往 $A$ 的谱系和通往 $C$ 的谱系中被独立获得。\n\n**生物学解释及与表征学的对比**\n\n这两种同样简约的情景（$ACCTRAN$ 和 $DELTRAN$）的存在揭示了数据中固有的模糊性。MP 提供了变化的最小数量，但没有提供其唯一的位置或类型。ACCTRAN 的情景（一次起源，两次丢失）支持同源性，表明 $A$ 和 $C$ 中的性状具有共同的起源。DELTRAN 的情景（两次独立起源）支持同塑性（具体来说是平行演化），表明 $A$ 和 $C$ 中的性状是同塑的。这两者之间的选择取决于关于该性状的外部知识；例如，一个复杂的性状不太可能多次演化，因此更倾向于类似 ACCTRAN 的解释。\n\n一个严格的表征学分类（它根据总体相似性对生物进行分组）会被这个性状误导。状态为 $\\{A,C\\}=\\{1\\}$ 和 $\\{B,D,E\\}=\\{0\\}$。表征学会将 $A$ 和 $C$ 分为一组，将 $B$、$D$ 和 $E$ 分为一组，从而产生一个类似 $((A,C),(B,D,E))$ 的拓扑结构。这与给定的支序图 $((A,B),(C,(D,E)))$ 直接矛盾，后者是基于演化关系（支序学）的。支序学通过使用树，正确地识别出，相对于给定的系统发育树，$A$ 和 $C$ 之间共享的状态 $1$ 是一种同塑性（非同源相似性），而不是近亲关系的指标。\n\n**最终计算**\n\n问题要求计算 $\\Delta G = G_{\\mathrm{DELTRAN}} - G_{\\mathrm{ACCTRAN}}$。根据我们的分析：\n- DELTRAN 下的获得次数为 $G_{\\mathrm{DELTRAN}} = 2$。\n- ACCTRAN 下的获得次数为 $G_{\\mathrm{ACCTRAN}} = 0$。\n\n因此，$\\Delta G$ 的值为：\n$$\n\\Delta G = 2 - 0 = 2\n$$", "answer": "$$\\boxed{2}$$", "id": "2554461"}]}