{"hands_on_practices": [{"introduction": "螺旋和辐射卵裂的区别是原口动物和后口动物二分法的基石。本次实践超越了简单的形态描述，要求你从第一性原理出发建立一个生物物理模型。通过基于细胞骨架作用力推导稳定的卵裂角，你将对这些基础发育模式的形成机制获得更深刻的理解。[@problem_id:2606641]", "problem": "一个单细胞胚胎进行其第一次卵裂。在动物中，卵裂方向受限于卵裂球皮层的细胞骨架几何形状和卵黄的分布。许多原口动物谱系表现出螺旋卵裂，通常与动植物轴成斜角并具有确定的手性，而许多后口动物谱系则表现出与动植物轴对齐的辐射卵裂。考虑一个简化的、基于生物物理学的模型，其中球形卵裂球在赤道平面上被近似为一个圆形皮层。一个双极有丝分裂纺锤体由星状微管和dynein产生的皮层拉力定向，其方向由与动植物轴（设为 $\\phi_{y} = 0$）的夹角 $\\theta$ 来表征。假设如下：\n\n1) 在极角 $\\psi$ 处，单位弧长的局部皮层牵引力具有一个基线各向同性的大小和一个小的各向异性二次谐波分量，这与双极纺锤体的偶对称性一致：对于在角度 $\\phi_{c}$ 处对齐的细胞骨架各向异性（由肌动球蛋白结构和手性信号设定），牵引力密度为 $f_{c}(\\psi) = f_{c0}\\left[1 + \\alpha \\cos\\big(2(\\psi - \\phi_{c})\\big)\\right]$，其中 $0  \\alpha \\ll 1$。对于在 $\\phi_{y}$ 处对齐的卵黄耦合各向异性，类似地写为 $f_{y}(\\psi) = f_{y0}\\left[1 + \\beta \\cos\\big(2(\\psi - \\phi_{y})\\big)\\right]$，其中 $0  \\beta \\ll 1$。\n\n2) 在角度 $\\psi$ 处的每个皮层元素对纺锤体施加一个定向力矩，该力矩与局部牵引力振幅乘以一个遵循纺锤体双极对称性的几何核成正比。将星状锚定能量建模为与 $\\cos^{2}(\\theta - \\psi)$ 成正比，并利用皮层处的力-力矩平衡，单位弧长的主导阶力矩与 $\\sin\\big(2(\\theta - \\psi)\\big)$ 成比例。\n\n3) 关于细胞中心的总力矩是细胞骨架和卵黄贡献之和在皮层上的线积分，每个贡献都由其耦合系数加权。将有效耦合系数记为 $k_{c}$ 和 $k_{y}$，细胞半径记为 $R$。计算到 $\\alpha$ 和 $\\beta$ 的主导阶，只保留在 $\\psi \\in [0,2\\pi)$ 上的角度平均中不为零的项。\n\n仅使用上述物理前提和静态平衡要求（$\\text{净力矩} = 0$），从第一性原理推导稳定平衡方向 $\\theta^{\\ast}$ 的闭式解析表达式，用二次谐波强度和轴 $\\{A,\\phi_{c}\\}$ 与 $\\{B,\\phi_{y}\\}$ 表示，其中 $A$ 和 $B$ 分别与 $k_{c} f_{c0}\\alpha R$ 和 $k_{y} f_{y0}\\beta R$ 成正比。然后评估由以下定义的螺旋式原口动物案例和辐射式后口动物案例之间的卵裂角预测差异：\n\n- 螺旋式（原口动物）：$\\phi_{c} = \\frac{\\pi}{4}$（右旋偏移），$\\phi_{y} = 0$，其中 $k_{c} f_{c0}\\alpha = 20 \\times 0.2$ 且 $k_{y} f_{y0}\\beta = 10 \\times 0.1$。\n- 辐射式（后口动物）：$\\phi_{c} = 0$，$\\phi_{y} = 0$，其中 $k_{c} f_{c0}\\alpha$ 和 $k_{y} f_{y0}\\beta$ 与上述相同。\n\n报告量 $\\Delta \\theta = \\theta^{\\ast}_{\\text{spiral}} - \\theta^{\\ast}_{\\text{radial}}$ 的值，以弧度为单位，并四舍五入到四位有效数字。最终答案以单个实数表示。不要在最终的方框答案中包含单位，但在推导过程中要说明单位，并遵守此处的四舍五入规范。", "solution": "首先必须验证问题陈述的科学合理性、自洽性和客观性。\n\n步骤 1：提取的已知条件\n-   模型：单细胞胚胎被建模为赤道平面上半径为 $R$ 的圆形皮层。\n-   纺锤体方向：有丝分裂纺锤体的方向由相对于动植物轴的角度 $\\theta$ 给出，动植物轴定义在角度 $\\phi_{y} = 0$ 处。\n-   细胞骨架牵引力密度：$f_{c}(\\psi) = f_{c0}\\left[1 + \\alpha \\cos\\big(2(\\psi - \\phi_{c})\\big)\\right]$，各向异性轴为 $\\phi_{c}$，强度为 $0  \\alpha \\ll 1$。\n-   卵黄耦合牵引力密度：$f_{y}(\\psi) = f_{y0}\\left[1 + \\beta \\cos\\big(2(\\psi - \\phi_{y})\\big)\\right]$，各向异性轴为 $\\phi_{y}$，强度为 $0  \\beta \\ll 1$。动植物轴给出为 $\\phi_{y}=0$。\n-   力矩核：在皮层角 $\\psi$ 处，单位弧长的定向力矩与局部牵引力乘以一个与 $\\sin\\big(2(\\theta - \\psi)\\big)$ 成比例的几何核成正比。\n-   总力矩：净力矩是在皮层上对细胞骨架和卵黄贡献之和的积分，并由有效耦合系数 $k_c$ 和 $k_y$ 加权。\n-   平衡条件：静态平衡要求净力矩为零，$\\tau(\\theta^*) = 0$。\n-   近似：分析必须做到 $\\alpha$ 和 $\\beta$ 的主导阶。\n-   参数定义：$A \\propto k_{c} f_{c0}\\alpha R$ 和 $B \\propto k_{y} f_{y0}\\beta R$。\n-   任务1：推导稳定平衡方向 $\\theta^{\\ast}$ 的闭式解析表达式。\n-   任务2：计算两种特定情况下的 $\\Delta \\theta = \\theta^{\\ast}_{\\text{spiral}} - \\theta^{\\ast}_{\\text{radial}}$。\n-   螺旋式案例：$\\phi_{c} = \\frac{\\pi}{4}$，$\\phi_{y} = 0$，$k_{c} f_{c0}\\alpha = 4$，$k_{y} f_{y0}\\beta = 1$。\n-   辐射式案例：$\\phi_{c} = 0$，$\\phi_{y} = 0$，$k_{c} f_{c0}\\alpha = 4$，$k_{y} f_{y0}\\beta = 1$。\n-   最终答案格式：一个表示 $\\Delta\\theta$ 的实数，以弧度为单位，四舍五入到四位有效数字。\n\n步骤 2：验证\n该问题具有科学依据，采用了细胞力学（皮层力、力矩平衡、各向异性的傅里叶级数表示）的标准生物物理建模方法。数学结构是适定的，为从第一性原理到可解方程提供了清晰的路径。前提是客观、自洽且一致的。该问题不违反任何无效标准。\n\n结论：问题有效。开始求解。\n\n纺锤体上的总力矩 $\\tau(\\theta)$ 是细胞骨架和卵黄分布贡献的总和，在整个圆形皮层上积分。由角度 $\\psi$ 处弧长为 $ds = R d\\psi$ 的皮层段产生的力矩元 $d\\tau$ 是加权牵引力与力矩核相乘的总和。\n\n$$\nd\\tau = \\left[ k_c f_c(\\psi) + k_y f_y(\\psi) \\right] \\sin(2(\\theta - \\psi)) R d\\psi\n$$\n\n总力矩是 $d\\tau$ 在 $\\psi$ 从 $0$ 到 $2\\pi$ 上的积分。\n$$\n\\tau(\\theta) = R \\int_0^{2\\pi} \\left[ k_c f_{c0}\\left(1 + \\alpha \\cos(2(\\psi - \\phi_{c}))\\right) + k_y f_{y0}\\left(1 + \\beta \\cos(2(\\psi - \\phi_{y}))\\right) \\right] \\sin(2(\\theta - \\psi)) d\\psi\n$$\n我们逐项分析积分。各向同性分量（与 $1$ 成正比）的贡献为：\n$$\n\\int_0^{2\\pi} (k_c f_{c0} + k_y f_{y0}) \\sin(2(\\theta - \\psi)) d\\psi = (k_c f_{c0} + k_y f_{y0}) \\left[ \\frac{1}{2}\\cos(2(\\theta - \\psi)) \\right]_0^{2\\pi} = 0\n$$\n正如预期的那样，各向同性的力分布不会产生净定向力矩。各向异性分量是 $\\alpha$ 和 $\\beta$ 的主导阶，它们提供了净力矩。我们来评估细胞骨架的贡献：\n$$\n\\tau_c(\\theta) = k_c f_{c0} \\alpha R \\int_0^{2\\pi} \\cos(2(\\psi - \\phi_c)) \\sin(2(\\theta - \\psi)) d\\psi\n$$\n使用三角恒等式 $\\cos A \\sin B = \\frac{1}{2}(\\sin(A+B) - \\sin(A-B))$，其中 $A = 2\\psi - 2\\phi_c$ 且 $B = 2\\theta - 2\\psi$：\n\\begin{align*}\n\\cos(2(\\psi - \\phi_c)) \\sin(2(\\theta - \\psi)) = \\frac{1}{2} \\left[ \\sin( (2\\psi - 2\\phi_c) + (2\\theta - 2\\psi) ) - \\sin( (2\\psi - 2\\phi_c) - (2\\theta - 2\\psi) ) \\right] \\\\\n= \\frac{1}{2} \\left[ \\sin(2\\theta - 2\\phi_c) - \\sin(4\\psi - 2\\theta - 2\\phi_c) \\right]\n\\end{align*}\n积分变为：\n$$\n\\int_0^{2\\pi} \\frac{1}{2} \\left[ \\sin(2\\theta - 2\\phi_c) - \\sin(4\\psi - 2\\theta - 2\\phi_c) \\right] d\\psi\n$$\n$\\sin(4\\psi - \\text{const})$ 在 $[0, 2\\pi)$ 上的积分为零。第一项相对于 $\\psi$ 是常数。\n$$\n\\tau_c(\\theta) = k_c f_{c0} \\alpha R \\left( \\frac{1}{2} \\cdot 2\\pi \\sin(2\\theta - 2\\phi_c) \\right) = \\pi R (k_c f_{c0} \\alpha) \\sin(2(\\theta - \\phi_c))\n$$\n通过类比，卵黄的贡献为：\n$$\n\\tau_y(\\theta) = \\pi R (k_y f_{y0} \\beta) \\sin(2(\\theta - \\phi_y))\n$$\n总力矩为 $\\tau(\\theta) = \\tau_c(\\theta) + \\tau_y(\\theta)$。我们定义有效各向异性强度 $A' = k_c f_{c0} \\alpha$ 和 $B' = k_y f_{y0} \\beta$。这些量与问题陈述中的 $A$ 和 $B$ 成正比，并且由于我们将总力矩设为零，任何公共的比例常数都将被抵消。\n$$\n\\tau(\\theta) = \\pi R \\left[ A' \\sin(2(\\theta - \\phi_c)) + B' \\sin(2(\\theta - \\phi_y)) \\right]\n$$\n对于静态平衡，$\\tau(\\theta^*) = 0$：\n$$\nA' \\sin(2(\\theta^* - \\phi_c)) + B' \\sin(2(\\theta^* - \\phi_y)) = 0\n$$\n展开正弦项：\n$$\nA'(\\sin(2\\theta^*)\\cos(2\\phi_c) - \\cos(2\\theta^*)\\sin(2\\phi_c)) + B'(\\sin(2\\theta^*)\\cos(2\\phi_y) - \\cos(2\\theta^*)\\sin(2\\phi_y)) = 0\n$$\n按 $\\sin(2\\theta^*)$ 和 $\\cos(2\\theta^*)$ 分组：\n$$\n\\sin(2\\theta^*)[A'\\cos(2\\phi_c) + B'\\cos(2\\phi_y)] = \\cos(2\\theta^*)[A'\\sin(2\\phi_c) + B'\\sin(2\\phi_y)]\n$$\n这给出了平衡角 $\\theta^*$ 的一般表达式：\n$$\n\\tan(2\\theta^*) = \\frac{A' \\sin(2\\phi_c) + B' \\sin(2\\phi_y)}{A' \\cos(2\\phi_c) + B' \\cos(2\\phi_y)}\n$$\n这就是所要求的闭式表达式。对于稳定平衡，势能 $U(\\theta) = -\\int \\tau(\\theta) d\\theta$ 必须处于最小值，这要求 $d^2U/d\\theta^2 > 0$。这等价于 $d\\tau/d\\theta  0$。\n$$\n\\frac{d\\tau}{d\\theta} = 2\\pi R \\left[ A' \\cos(2(\\theta - \\phi_c)) + B' \\cos(2(\\theta - \\phi_y)) \\right]\n$$\n设 $S = A' \\sin(2\\phi_c) + B' \\sin(2\\phi_y)$ 且 $C = A' \\cos(2\\phi_c) + B' \\cos(2\\phi_y)$。平衡条件是 $\\tan(2\\theta^*) = S/C$。稳定性条件是 $d\\tau/d\\theta  0$。$d\\tau/d\\theta$ 的表达式可以重写为 $2\\pi R [C \\cos(2\\theta) + S \\sin(2\\theta)]$。\n$2\\theta^*$ 的两个解系相差 $\\pi$。设 $\\Phi = \\text{atan2}(S, C)$ 为主角。解为 $2\\theta^* = \\Phi$ 和 $2\\theta^* = \\Phi + \\pi$。\n当 $2\\theta^* = \\Phi$ 时，我们有 $\\cos(2\\theta^*) \\propto C$ 和 $\\sin(2\\theta^*) \\propto S$。项 $C\\cos(2\\theta^*) + S\\sin(2\\theta^*) \\propto C^2+S^2 > 0$，所以 $d\\tau/d\\theta > 0$。这是一个不稳定平衡。\n当 $2\\theta^* = \\Phi + \\pi$ 时，我们有 $\\cos(2\\theta^*) \\propto -C$ 和 $\\sin(2\\theta^*) \\propto -S$。项 $C\\cos(2\\theta^*) + S\\sin(2\\theta^*) \\propto -(C^2+S^2)  0$，所以 $d\\tau/d\\theta  0$。这是稳定平衡。\n因此，稳定方向由 $2\\theta^* = \\text{atan2}(S, C) + \\pi$ 给出。\n\n现在我们对给定的两种情况进行评估。\n1.  辐射式（后口动物）：\n    参数：$\\phi_c = 0$，$\\phi_y = 0$，$A' = 4$，$B' = 1$。\n    $S_{\\text{radial}} = 4 \\sin(0) + 1 \\sin(0) = 0$。\n    $C_{\\text{radial}} = 4 \\cos(0) + 1 \\cos(0) = 4 + 1 = 5$。\n    $\\tan(2\\theta^*_{\\text{radial}}) = 0/5 = 0$。\n    角度 $\\Phi_{\\text{radial}} = \\text{atan2}(0, 5) = 0$。\n    稳定解为 $2\\theta^*_{\\text{radial}} = 0 + \\pi = \\pi$。\n    因此，$\\theta^*_{\\text{radial}} = \\frac{\\pi}{2}$。\n\n2.  螺旋式（原口动物）：\n    参数：$\\phi_c = \\frac{\\pi}{4}$，$\\phi_y = 0$，$A' = 4$，$B' = 1$。\n    $S_{\\text{spiral}} = 4 \\sin(2 \\cdot \\frac{\\pi}{4}) + 1 \\sin(0) = 4 \\sin(\\frac{\\pi}{2}) = 4$。\n    $C_{\\text{spiral}} = 4 \\cos(2 \\cdot \\frac{\\pi}{4}) + 1 \\cos(0) = 4 \\cos(\\frac{\\pi}{2}) + 1 = 1$。\n    $\\tan(2\\theta^*_{\\text{spiral}}) = 4/1 = 4$。\n    角度 $\\Phi_{\\text{spiral}} = \\text{atan2}(4, 1) = \\arctan(4)$。\n    稳定解为 $2\\theta^*_{\\text{spiral}} = \\arctan(4) + \\pi$。\n    因此，$\\theta^*_{\\text{spiral}} = \\frac{1}{2}(\\arctan(4) + \\pi) = \\frac{1}{2}\\arctan(4) + \\frac{\\pi}{2}$。\n\n所求的差异是 $\\Delta \\theta = \\theta^{\\ast}_{\\text{spiral}} - \\theta^{\\ast}_{\\text{radial}}$。\n$$\n\\Delta\\theta = \\left( \\frac{1}{2}\\arctan(4) + \\frac{\\pi}{2} \\right) - \\frac{\\pi}{2} = \\frac{1}{2}\\arctan(4)\n$$\n我们现在计算以弧度为单位的数值。\n$$\n\\arctan(4) \\approx 1.32581766~\\text{rad}\n$$\n$$\n\\Delta\\theta = \\frac{1}{2} \\times 1.32581766 \\approx 0.66290883~\\text{rad}\n$$\n四舍五入到四位有效数字得到 $0.6629$。", "answer": "$$\\boxed{0.6629}$$", "id": "2606641"}, {"introduction": "血红蛋白和血蓝蛋白等呼吸蛋白的演化反映了动物界多样的生理适应性。本次练习提供了将基础生物物理模型——希尔方程——与实验数据进行拟合的实践经验。通过估算不同氧合分子的协同性，你将学会如何量化生理特征，并将其与原口动物和后口动物谱系的宏观演化背景联系起来。[@problem_id:2606708]", "problem": "给定四个代表性动物分类单元的血氧结合数据集，涵盖原口动物和后口动物谱系。每个数据集由多对氧分压值和相应的分数饱和度值组成。氧分压 (pO2) 的单位是千帕 (kPa)，分数饱和度是无量纲的。您必须使用经验模型估计协同性参数，并以精确的格式输出结果。\n\n基本原理。在比较生理学中，血氧结合大分子的分数饱和度 $Y$ 作为氧分压 $p$ 的函数，可以很好地由希尔方程这一经验公式描述\n$$\nY(p; n, P_{50}) \\;=\\; \\frac{p^{n}}{P_{50}^{\\,n} + p^{n}},\n$$\n其中，$n$（希尔系数）量化了表观协同性，$P_{50}$ 是半饱和时的氧分压。估计 $n$ 和 $P_{50}$ 的问题可以看作一个优化问题，即在 $n>0$ 和 $P_{50}>0$ 的约束下，最小化观测饱和度与模型预测值之间的残差平方和 (SSE)。\n\n任务。对于下面的每个数据集，使用希尔方程，通过最小化以下公式来估计 $n$ 和 $P_{50}$\n$$\n\\mathrm{SSE}(n,P_{50}) \\;=\\; \\sum_{i=1}^{m} \\left(Y_{i}^{\\mathrm{obs}} - \\frac{p_{i}^{\\,n}}{P_{50}^{\\,n} + p_{i}^{\\,n}}\\right)^{2},\n$$\n约束条件为 $n>0$ 和 $P_{50}>0$。然后，仅报告每个数据集估计出的 $n$ 值。\n\n数据集（测试套件）。每个数据集提供一个 $p$ 值列表（单位为 $\\mathrm{kPa}$）和相应的 $Y$ 值列表（无量纲）。所有数值均应按十进制解释。\n\n- 数据集 A（后口动物，脊椎动物血红蛋白）：$p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.0006,\\,0.0043,\\,0.0291,\\,0.1725,\\,0.5930,\\,0.9100,\\,0.9693,\\,0.9925\\,]$。\n\n- 数据集 B（后口动物，肌红蛋白样）：$p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.3333,\\,0.5000,\\,0.6667,\\,0.8000,\\,0.8889,\\,0.9412,\\,0.9600,\\,0.9756\\,]$。\n\n- 数据集 C（原口动物，节肢动物/软体动物血蓝蛋白样）：$p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.0130,\\,0.0314,\\,0.0739,\\,0.1641,\\,0.3262,\\,0.5434,\\,0.6684,\\,0.7969\\,]$。\n\n- 数据集 D（原口动物，环节动物细胞外血红蛋白样）：$p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.0004,\\,0.0051,\\,0.0670,\\,0.5000,\\,0.9338,\\,0.9954,\\,0.9990,\\,0.9998\\,]$。\n\n数值要求。\n- 按给定值使用 $p$（单位为 $\\mathrm{kPa}$）和无量纲的 $Y$。\n- 通过最小化所述的 $\\mathrm{SSE}$ 函数进行拟合，约束条件为 $n>0$ 和 $P_{50}>0$。\n- 最终输出没有物理单位，必须是实数。\n\n最终输出格式。您的程序应生成单行输出，其中包含四个估计的协同性值（每个数据集一个，按 A、B、C、D 的顺序排列），形式为用方括号括起来的逗号分隔列表，每个值四舍五入到小数点后三位（例如，$[\\,2.800,1.000,1.300,3.800\\,]$）。\n\n覆盖性设计。\n- 数据集 A 是具有 S 型上升曲线的一般协同情况。\n- 数据集 B 近似于非协同结合，其中 $n$ 接近 1，是一种类边界条件。\n- 数据集 C 是中等协同性，具有较大的 $P_{50}$，强调较低的亲和力。\n- 数据集 D 是高度协同性的，并包含一个数据点，当 $p=P_{50}$ 时 $Y=0.5000$。\n\n答案类型。要求的输出是一个包含4个浮点数的单行列表，按规定四舍五入到三位小数，并打印在同一行上。", "solution": "所提出的问题是根据实验数据估计血氧结合大分子的协同性。这是生物物理化学和比较生理学中的一项标准任务。在继续之前，必须对问题陈述进行严格验证。\n\n**问题验证**\n\n**步骤 1：提取的已知信息**\n- **模型方程（希尔方程）：** 分数饱和度 $Y$ 作为氧分压 $p$ 的函数由以下公式给出：\n$$\nY(p; n, P_{50}) \\;=\\; \\frac{p^{n}}{P_{50}^{\\,n} + p^{n}}\n$$\n其中 $n$ 是希尔系数，$P_{50}$ 是半饱和氧分压。\n- **目标函数（残差平方和）：** 参数 $n$ 和 $P_{50}$ 将通过最小化以下函数来确定：\n$$\n\\mathrm{SSE}(n,P_{50}) \\;=\\; \\sum_{i=1}^{m} \\left(Y_{i}^{\\mathrm{obs}} - \\frac{p_{i}^{\\,n}}{P_{50}^{\\,n} + p_{i}^{\\,n}}\\right)^{2}\n$$\n- **约束条件：** 参数必须满足 $n > 0$ 和 $P_{50} > 0$。\n- **数据集：** 提供了四个数据集（A、B、C、D），每个数据集都包含一个以 $\\mathrm{kPa}$ 为单位的氧分压 $p$ 列表和对应的无量纲分数饱和度 $Y$。\n    - 数据集 A: $p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.0006,\\,0.0043,\\,0.0291,\\,0.1725,\\,0.5930,\\,0.9100,\\,0.9693,\\,0.9925\\,]$。\n    - 数据集 B: $p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.3333,\\,0.5000,\\,0.6667,\\,0.8000,\\,0.8889,\\,0.9412,\\,0.9600,\\,0.9756\\,]$。\n    - 数据集 C: $p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.0130,\\,0.0314,\\,0.0739,\\,0.1641,\\,0.3262,\\,0.5434,\\,0.6684,\\,0.7969\\,]$。\n    - 数据集 D: $p = [\\,0.25,\\,0.50,\\,1.00,\\,2.00,\\,4.00,\\,8.00,\\,12.00,\\,20.00\\,]$, $Y = [\\,0.0004,\\,0.0051,\\,0.0670,\\,0.5000,\\,0.9338,\\,0.9954,\\,0.9990,\\,0.9998\\,]$。\n- **输出要求：** 一个单行列表，包含四个估计的 $n$ 值，四舍五入到三位小数。\n\n**步骤 2：已知信息验证**\n- **科学依据：** 该问题在科学上是合理的。希尔方程是描述配体结合系统中协同性的基石性经验模型。对于所描述的动物分类单元，这些数据集在生理上是合理的。\n- **适定性：** 该问题是一个适定的非线性最小二乘优化问题。目标函数定义明确，约束条件具有物理意义，确保参数搜索保持在有效域内。预计每个数据集都有一个唯一且稳定的解。\n- **客观性：** 问题陈述使用了精确、客观和定量的语言，没有歧义和主观论断。\n- **结论：** 该问题遵循所有科学和数学有效性原则。它是完整的、一致的并且是可解的。\n\n**步骤 3：判定与行动**\n- **判定：** 问题是 **有效的**。\n- **行动：** 继续提供完整、合理的解决方案。\n\n**求解推导**\n\n任务是找到参数向量 $\\boldsymbol{\\theta} = [n, P_{50}]^T$，使每个数据集的残差平方和 ($\\mathrm{SSE}$) 最小化。这是一个受边界约束的非线性优化问题。\n\n目标函数为：\n$$\n\\underset{n, P_{50}}{\\operatorname{minimize}} \\quad \\mathrm{SSE}(n, P_{50})\n$$\n约束条件为：\n$$\nn > 0 \\quad \\text{and} \\quad P_{50} > 0\n$$\n\n解决此类问题的标准数值方法是采用迭代优化算法。拟牛顿法，例如 Broyden–Fletcher–Goldfarb–Shanno (BFGS) 算法，非常适用。具体来说，L-BFGS-B 变体专为处理箱式约束而设计，这直接适用于我们的问题，通过将 $n$ 和 $P_{50}$ 的下界设置为一个很小的正值（例如，$10^{-9}$）来强制执行严格不等式。\n\n该解决方案将通过计算实现如下：\n1.  **定义数值模型：** 编码一个代表希尔方程 $Y(p, n, P_{50})$ 的函数。\n2.  **定义目标函数：** 创建一个计算 $\\mathrm{SSE}(n, P_{50})$ 的函数。该函数将以参数向量 $[n, P_{50}]$ 和数据数组 $(p_i, Y_i^{\\mathrm{obs}})$ 作为输入，并返回标量 SSE 值。\n3.  **提供初始猜测值：** 为使迭代优化有效收敛，需要为参数 $(n_0, P_{50,0})$ 提供合理的初始猜测值。\n    -   一个稳健的 $P_{50}$ 初始猜测值是与最接近 $0.5$ 的观测饱和度 $Y_i^{\\mathrm{obs}}$ 相对应的氧分压 $p_i$。这利用了 $P_{50}$ 的定义。\n    -   希尔系数的一个通用初始猜测值（例如 $n_0 = 2.0$）是足够的。优化器将对该值进行优化。\n4.  **执行优化：** 对每个数据集，调用 `scipy.optimize.minimize` 函数。该函数需要目标函数、参数的初始猜测值、实验数据、所选方法（`'L-BFGS-B'`）和参数边界。\n5.  **提取并报告结果：** 优化程序返回 $n$ 和 $P_{50}$ 的最优参数值。按照要求，仅提取 $n$ 的值，四舍五入到三位小数，并为最终输出进行编译。对所有四个数据集重复此过程。\n\n所提供的数据集旨在测试此程序的稳健性。例如，数据集 B 的构造使得解析解恰好为 $n=1.0$ 和 $P_{50}=0.5\\,\\mathrm{kPa}$。数据集 D 在半饱和时包含一个精确点（当 $p=2.0\\,\\mathrm{kPa}$ 时，$Y=0.5$），这将强制解的 $P_{50}=2.0\\,\\mathrm{kPa}$，从而将优化简化为对 $n$ 的一维搜索。实现必须足够通用，以处理所有这些情况，而无需特殊逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Validates and solves the problem of estimating the Hill coefficient for four\n    oxygen-binding datasets.\n    \"\"\"\n\n    # Define the datasets from the problem statement.\n    test_cases = [\n        # Dataset A (Deuterostome, vertebrate hemoglobin)\n        {'p': np.array([0.25, 0.50, 1.00, 2.00, 4.00, 8.00, 12.00, 20.00]),\n         'Y': np.array([0.0006, 0.0043, 0.0291, 0.1725, 0.5930, 0.9100, 0.9693, 0.9925])},\n\n        # Dataset B (Deuterostome, myoglobin-like)\n        {'p': np.array([0.25, 0.50, 1.00, 2.00, 4.00, 8.00, 12.00, 20.00]),\n         'Y': np.array([0.3333, 0.5000, 0.6667, 0.8000, 0.8889, 0.9412, 0.9600, 0.9756])},\n\n        # Dataset C (Protostome, arthropod/molluscan hemocyanin-like)\n        {'p': np.array([0.25, 0.50, 1.00, 2.00, 4.00, 8.00, 12.00, 20.00]),\n         'Y': np.array([0.0130, 0.0314, 0.0739, 0.1641, 0.3262, 0.5434, 0.6684, 0.7969])},\n\n        # Dataset D (Protostome, annelid extracellular hemoglobin-like)\n        {'p': np.array([0.25, 0.50, 1.00, 2.00, 4.00, 8.00, 12.00, 20.00]),\n         'Y': np.array([0.0004, 0.0051, 0.0670, 0.5000, 0.9338, 0.9954, 0.9990, 0.9998])}\n    ]\n\n    def hill_equation(p, n, P50):\n        \"\"\"Calculates fractional saturation using the Hill equation.\"\"\"\n        p_n = p**n\n        P50_n = P50**n\n        return p_n / (P50_n + p_n)\n\n    def sse_objective(params, p_data, y_obs):\n        \"\"\"Objective function: Sum of Squared Errors.\"\"\"\n        n, P50 = params\n        y_pred = hill_equation(p_data, n, P50)\n        return np.sum((y_obs - y_pred)**2)\n\n    results = []\n    for case in test_cases:\n        p_data = case['p']\n        y_data = case['Y']\n\n        # Provide a smart initial guess for P50 and a general one for n.\n        # Find the index of the pressure value where saturation is closest to 0.5.\n        idx_p50_guess = np.argmin(np.abs(y_data - 0.5))\n        P50_initial_guess = p_data[idx_p50_guess]\n        n_initial_guess = 2.0  # A general starting point for cooperativity.\n        \n        initial_params = [n_initial_guess, P50_initial_guess]\n        \n        # Define bounds to enforce n  0 and P50  0.\n        # Use a small positive number as the lower bound to satisfy strict inequality.\n        bounds = [(1e-9, None), (1e-9, None)]\n\n        # Perform the minimization using L-BFGS-B which handles bounds.\n        opt_result = minimize(\n            sse_objective,\n            initial_params,\n            args=(p_data, y_data),\n            method='L-BFGS-B',\n            bounds=bounds\n        )\n\n        n_estimated = opt_result.x[0]\n        results.append(n_estimated)\n\n    # Format the final output as specified.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2606708"}, {"introduction": "现代系统发育基因组学为解决关于动物深度演化关系的长期争议问题（例如珍涡虫动物门等神秘类群的系统位置）提供了强大的工具。这项高级实践让你沉浸于前沿的系统发育假说检验过程。你将使用位点异质性模型和贝叶斯因子来定量比较相互竞争的演化情景，从而在解释复杂基因组数据以做出稳健的演化推断方面，获得关键技能。[@problem_id:2606724]", "problem": "您将评估关于 Xenacoelomorpha 在 Bilateria 范畴内相对于 Ambulacraria 位置的两个竞争性系统发育假说：假说 $H_1$ 将 Xenacoelomorpha 置于 Deuterostomia 内，作为 Ambulacraria 的姊妹群；假说 $H_2$ 则将 Xenacoelomorpha 置于 Deuterostomia 之外。您将获得一个位点异质性替换模型的简化数据，该模型表示为具有固定混合权重的 $K$ 个位点类别的有限混合。位点异质性假设意味着每个比对位点由 $K$ 个类别中的一个生成，使用类别 $k$ 的概率为 $w_k$，其中权重向量 $w = (w_1,\\dots,w_K)$ 满足 $w_k \\ge 0$ 且 $\\sum_{k=1}^{K} w_k = 1$。对于每个位点 $i \\in \\{1,\\dots,S\\}$ 和类别 $k \\in \\{1,\\dots,K\\}$，您将获得在假说 $H_h$ 下的每个位点、每个类别的似然 $L_{ik}^{(h)} = p(d_i \\mid \\text{class } k, H_h)$，其中 $h \\in \\{1,2\\}$ 且 $d_i$ 表示观测到的位点 $i$ 的字符模式。\n\n您的任务是仅使用给定的似然和固定的混合权重，在此混合模型下计算比较 $H_1$ 与 $H_2$ 的贝叶斯因子 (BF)。使用以下基本原理：\n- 贝叶斯定理和贝叶斯因子 (BF) 的定义：比较 $H_1$ 与 $H_2$ 的贝叶斯因子是 $BF_{12} = \\dfrac{p(D \\mid H_1)}{p(D \\mid H_2)}$，其中 $D$ 是完整的比对数据。\n- 在给定模型下各位点独立的条件下，对于位点异质性混合模型，在具有固定混合权重 $w$ 的假说 $H_h$ 下，模型证据（边缘似然）为\n$$\np(D \\mid H_h, w) = \\prod_{i=1}^{S} \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\n您必须计算贝叶斯因子的自然对数，\n$$\n\\ln BF_{12} = \\ln p(D \\mid H_1, w) - \\ln p(D \\mid H_2, w),\n$$\n为每个提供的测试数据集计算。为保证数值稳定性，您应通过累积每位点混合和的对数来避免下溢；即计算\n$$\n\\ln p(D \\mid H_h, w) = \\sum_{i=1}^{S} \\ln\\!\\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\n\n每个测试数据集的输入包括：\n- 位点类别数 $K$。\n- 混合权重向量 $w = (w_1,\\dots,w_K)$。\n- 对于每个位点 $i \\in \\{1,\\dots,S\\}$，两个长度为 $K$ 的向量：在 $H_1$ 下的类别条件似然 $[L_{i1}^{(1)},\\dots,L_{iK}^{(1)}]$，以及在 $H_2$ 下的类别条件似然 $[L_{i1}^{(2)},\\dots,L_{iK}^{(2)}]$。\n\n您的程序必须为每个数据集计算标量值 $\\ln BF_{12}$，并将所有数据集的结果以逗号分隔列表的形式输出在单行，并用方括号括起来。每个值表示为四舍五入到六位小数。无需单位。不涉及角度。不得使用百分比。\n\n测试套件：\n- 数据集 A（平衡的位点异质性；混合信号）：\n  - $K = 3$\n  - $w = [\\,0.5,\\,0.3,\\,0.2\\,]$\n  - $S = 4$ 个位点，在 $H_1$ 和 $H_2$ 下的类别条件似然为：\n    - 位点 $1$：$H_1 = [\\,0.9,\\,0.6,\\,0.4\\,]$，$H_2 = [\\,0.3,\\,0.5,\\,0.4\\,]$\n    - 位点 $2$：$H_1 = [\\,0.2,\\,0.3,\\,0.2\\,]$，$H_2 = [\\,0.4,\\,0.5,\\,0.4\\,]$\n    - 位点 $3$：$H_1 = [\\,0.6,\\,0.6,\\,0.6\\,]$，$H_2 = [\\,0.6,\\,0.6,\\,0.6\\,]$\n    - 位点 $4$：$H_1 = [\\,0.7,\\,0.2,\\,0.2\\,]$，$H_2 = [\\,0.4,\\,0.2,\\,0.2\\,]$\n- 数据集 B（极端的位点异质性；主导类别偏向 $H_2$；类边界权重）：\n  - $K = 3$\n  - $w = [\\,0.95,\\,0.04,\\,0.01\\,]$\n  - $S = 4$ 个位点：\n    - 位点 $1$：$H_1 = [\\,0.2,\\,0.9,\\,0.9\\,]$，$H_2 = [\\,0.8,\\,0.1,\\,0.1\\,]$\n    - 位点 $2$：$H_1 = [\\,0.1,\\,0.9,\\,0.9\\,]$，$H_2 = [\\,0.7,\\,0.1,\\,0.1\\,]$\n    - 位点 $3$：$H_1 = [\\,0.5,\\,0.6,\\,0.6\\,]$，$H_2 = [\\,0.5,\\,0.6,\\,0.6\\,]$\n    - 位点 $4$：$H_1 = [\\,0.3,\\,0.2,\\,0.2\\,]$，$H_2 = [\\,0.6,\\,0.2,\\,0.2\\,]$\n- 数据集 C（均匀的位点异质性；一个对 $H_1$ 有决定性作用的位点）：\n  - $K = 3$\n  - $w = [\\,0.3333333333333333,\\,0.3333333333333333,\\,0.3333333333333333\\,]$\n  - $S = 3$ 个位点：\n    - 位点 $1$：$H_1 = [\\,0.99,\\,0.99,\\,0.99\\,]$，$H_2 = [\\,0.01,\\,0.01,\\,0.01\\,]$\n    - 位点 $2$：$H_1 = [\\,0.5,\\,0.01,\\,0.5\\,]$，$H_2 = [\\,0.5,\\,0.99,\\,0.5\\,]$\n    - 位点 $3$：$H_1 = [\\,0.5,\\,0.5,\\,0.5\\,]$，$H_2 = [\\,0.5,\\,0.5,\\,0.5\\,]$\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如 $[r_1,r_2,r_3]$），其中 $r_j$ 是数据集 $j$ 的 $\\ln BF_{12}$ 值，四舍五入到六位小数。", "solution": "我们从贝叶斯定理和贝叶斯因子 (BF) 的定义开始。对于两个假说 $H_1$ 和 $H_2$ 以及数据 $D$，比较 $H_1$ 和 $H_2$ 的贝叶斯因子定义为\n$$\nBF_{12} = \\frac{p(D \\mid H_1)}{p(D \\mid H_2)}.\n$$\n贝叶斯因子的自然对数则为\n$$\n\\ln BF_{12} = \\ln p(D \\mid H_1) - \\ln p(D \\mid H_2).\n$$\n在我们的设定中，位点异质性模型是一个具有 $K$ 个类别和固定混合权重 $w = (w_1,\\dots,w_K)$ 的有限混合，其中 $w_k \\ge 0$ 且 $\\sum_{k=1}^{K} w_k = 1$。每个位点 $i \\in \\{1,\\dots,S\\}$ 在假说 $H_h$ 下具有类别条件似然 $L_{ik}^{(h)} = p(d_i \\mid \\text{class } k, H_h)$。\n\n假设在给定模型下各位点条件独立，在固定 $w$ 的假说 $H_h$ 下，模型证据（边缘似然）为\n$$\np(D \\mid H_h, w) = \\prod_{i=1}^{S} \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\n取自然对数以避免下溢并将乘积转换为和，我们得到\n$$\n\\ln p(D \\mid H_h, w) = \\sum_{i=1}^{S} \\ln \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\n因此，所求量为\n$$\n\\ln BF_{12} = \\sum_{i=1}^{S} \\left[ \\ln \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(1)} \\right) - \\ln \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(2)} \\right) \\right].\n$$\n\n基于原则的算法设计：\n1. 对每个数据集，读取 $K$、权重向量 $w$ 以及在 $H_1$ 和 $H_2$ 下的每位点、每类别的似然数组。确保所有似然 $L_{ik}^{(h)}$ 和权重 $w_k$ 均为严格正数，且 $\\sum_{k} w_k = 1$（如所提供）。\n2. 对每个位点 $i$，计算每个假说下的混合似然为 $M_i^{(h)} = \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)}$。\n3. 为保持数值稳定性，特别是对于许多小项的乘积，应累积 $\\ln M_i^{(h)}$ 而非 $M_i^{(h)}$ 本身。尽管混合内部的和不是乘积，但它可能涉及小的加数；如果需要，可以使用稳定的变换计算 $\\ln M_i^{(h)}$：\n   - 写作 $M_i^{(h)} = \\sum_{k=1}^{K} \\exp(\\ln w_k + \\ln L_{ik}^{(h)})$。\n   - 然后使用 log-sum-exp 技巧：\n     $$\n     \\ln M_i^{(h)} = m + \\ln \\left( \\sum_{k=1}^{K} \\exp\\left( (\\ln w_k + \\ln L_{ik}^{(h)}) - m \\right) \\right),\n     $$\n     其中 $m = \\max_{k} (\\ln w_k + \\ln L_{ik}^{(h)})$。\n   当各项跨越多个数量级时，这能保证稳定性。\n4. 对所有位点求和 $\\ln M_i^{(1)}$ 以获得 $\\ln p(D \\mid H_1, w)$，对 $H_2$ 做类似操作以获得 $\\ln p(D \\mid H_2, w)$。\n5. 将这些和的差作为 $\\ln BF_{12}$ 进行计算。\n6. 将每个得到的 $\\ln BF_{12}$ 四舍五入到六位小数，并按要求格式在单行上输出所有数据集的结果。\n\n在比较动物学背景下的科学解释：\n- $\\ln BF_{12}$ 的正值表示，在指定的位点异质性混合模型下，数据支持 $H_1$（Xenacoelomorpha 作为 Deuterostomia 内 Ambulacraria 的姊妹群）相对于 $H_2$。\n- 负值表示支持 $H_2$（Xenacoelomorpha 被置于 Deuterostomia 之外）。\n- $\\lvert \\ln BF_{12} \\rvert$ 的大小反映了在该混合模型下证据的强度。\n\n将该方法应用于提供的测试套件：\n- 数据集 A 使用平衡的权重和跨位点的混合信号；结果预计为轻微正值（支持 $H_1$），因为有几个位点在 $H_1$ 下具有更高的混合似然。\n- 数据集 B 使用类边界权重，其中主导类别强烈支持 $H_2$；结果预计为强负值。\n- 数据集 C 使用均匀权重，其中一个位点对 $H_1$ 起决定性作用，另一个位点在单个类别中支持 $H_2$；由于在 $H_1$ 下的决定性位点，结果预计为强正值。\n\n该实现完全遵循上述步骤，使用 log-sum-exp 技巧确保稳健性，并将三个 $\\ln BF_{12}$ 值四舍五入到六位小数，以单个方括号列表的形式打印出来。", "answer": "```python\nimport numpy as np\n\ndef logsumexp(a: np.ndarray) - float:\n    \"\"\"\n    Compute log(sum(exp(a))) in a numerically stable way.\n    \"\"\"\n    m = np.max(a)\n    return float(m + np.log(np.sum(np.exp(a - m))))\n\ndef log_marginal_likelihood(weights: np.ndarray, lik_matrix: np.ndarray) - float:\n    \"\"\"\n    Compute log p(D | H, w) for a site-heterogeneous mixture with fixed weights.\n\n    weights: shape (K,), strictly positive, sum to 1.\n    lik_matrix: shape (S, K), per-site, per-class likelihoods under a hypothesis.\n    \"\"\"\n    # Precompute log-weights\n    log_w = np.log(weights)\n    total = 0.0\n    for i in range(lik_matrix.shape[0]):\n        # log of mixture sum for site i: log(sum_k w_k * L_{ik})\n        log_terms = log_w + np.log(lik_matrix[i, :])\n        total += logsumexp(log_terms)\n    return total\n\ndef ln_bayes_factor(weights: np.ndarray, lik_h1: np.ndarray, lik_h2: np.ndarray) - float:\n    \"\"\"\n    Compute ln BF_12 = ln p(D|H1,w) - ln p(D|H2,w)\n    \"\"\"\n    ln_p_h1 = log_marginal_likelihood(weights, lik_h1)\n    ln_p_h2 = log_marginal_likelihood(weights, lik_h2)\n    return ln_p_h1 - ln_p_h2\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Dataset A\n    w_A = np.array([0.5, 0.3, 0.2], dtype=float)\n    H1_A = np.array([\n        [0.9, 0.6, 0.4],  # Site 1\n        [0.2, 0.3, 0.2],  # Site 2\n        [0.6, 0.6, 0.6],  # Site 3\n        [0.7, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n    H2_A = np.array([\n        [0.3, 0.5, 0.4],  # Site 1\n        [0.4, 0.5, 0.4],  # Site 2\n        [0.6, 0.6, 0.6],  # Site 3\n        [0.4, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n\n    # Dataset B\n    w_B = np.array([0.95, 0.04, 0.01], dtype=float)\n    H1_B = np.array([\n        [0.2, 0.9, 0.9],  # Site 1\n        [0.1, 0.9, 0.9],  # Site 2\n        [0.5, 0.6, 0.6],  # Site 3\n        [0.3, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n    H2_B = np.array([\n        [0.8, 0.1, 0.1],  # Site 1\n        [0.7, 0.1, 0.1],  # Site 2\n        [0.5, 0.6, 0.6],  # Site 3\n        [0.6, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n\n    # Dataset C\n    w_C = np.array([0.3333333333333333, 0.3333333333333333, 0.3333333333333333], dtype=float)\n    H1_C = np.array([\n        [0.99, 0.99, 0.99],  # Site 1\n        [0.5,  0.01, 0.5 ],  # Site 2\n        [0.5,  0.5,  0.5 ],  # Site 3\n    ], dtype=float)\n    H2_C = np.array([\n        [0.01, 0.01, 0.01],  # Site 1\n        [0.5,  0.99, 0.5 ],  # Site 2\n        [0.5,  0.5,  0.5 ],  # Site 3\n    ], dtype=float)\n\n    test_cases = [\n        (w_A, H1_A, H2_A),\n        (w_B, H1_B, H2_B),\n        (w_C, H1_C, H2_C),\n    ]\n\n    results = []\n    for weights, lik_h1, lik_h2 in test_cases:\n        ln_bf = ln_bayes_factor(weights, lik_h1, lik_h2)\n        results.append(f\"{ln_bf:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2606724"}]}