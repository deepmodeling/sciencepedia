{"hands_on_practices": [{"introduction": "杂交事件发生后，重组会将来自亲本物种的染色体分解成越来越小的片段。此练习旨在探索时间、祖源比例和重组在塑造杂交后代基因组图景中的定量关系。通过从第一性原理推导祖源片段的预期数量和长度，您将对混合信号如何随世代衰减建立基础性理解 [@problem_id:2607831]。", "problem": "一个二倍体动物谱系在 $t$ 代前经历了亲本物种 $\\mathrm{A}$ 和 $\\mathrm{B}$ 之间的一次单一杂交脉冲，产生了一个混合群体。此后，该群体在一个非常大的、没有选择压力的群体中随机交配。在杂交脉冲时，物种 $\\mathrm{A}$（供体）对混合基因库的贡献为 $m$，因此此后每个基因座上来自 $\\mathrm{A}$ 的边际祖源频率均为 $m$。假设以下基本原则：\n- 沿着遗传长度为 $L$ 摩尔根（Morgans）的染色体，每次减数分裂的预期交换次数等于 $L$，且交换位置遵循无干涉的泊松过程。\n- 在一个大的随机交配群体中，在没有选择或漂变的情况下，一个位点的祖源杂合性在各代中保持为 $2 m (1-m)$。\n- 当减数分裂中，在祖源杂合的位置发生交换时，就会产生一个祖源连接点。\n\n给你三个常染色体的重组图谱，以厘摩（cM）为单位的遗传标记位置给出，其中 $1$ 厘摩（cM）$= 0.01$ 摩尔根（M）。对于每条染色体，标记点涵盖了从第一个到最后一个所列标记的整条染色体（即，在所列范围之外没有额外的遗传长度），并且相邻标记之间的区间是完全覆盖的。\n\n染色体 1 标记点 (cM): $0, 20, 55, 95, 135$。\n\n染色体 2 标记点 (cM): $0, 30, 60, 95$。\n\n染色体 3 标记点 (cM): $0, 25, 48, 70$。\n\n设供体祖源比例为 $m = 0.30$，混合脉冲以来的时间为 $t = 20$ 代。在连续基因组极限下进行计算，并忽略由染色体末端引起的末端效应。\n\n仅使用上述基本原则，从第一性原理推导出以下表达式：\n1) $t$ 代后，三个常染色体上物种 $\\mathrm{A}$ 祖源片段的预期数量。\n2) $t$ 代后，物种 $\\mathrm{A}$ 祖源片段的平均长度。\n\n然后根据给定数据对这些表达式进行数值计算。将预期数量表示为纯数，平均长度以摩尔根为单位。将两个数值结果四舍五入到四位有效数字。按（预期数量，平均长度）的顺序提供你的最终答案。", "solution": "该问题经验证是自洽的、有科学依据的、且定义明确的。解题过程通过从提供的基本原理推导所需表达式来进行。\n\n设 $m$ 为来自物种 A 的供体祖源比例，$t$ 为自混合脉冲以来的世代数。基因组的总遗传长度为 $L_{total}$，由 $N_{chr} = 3$ 条染色体组成。\n\n**1. 祖源片段预期数量的推导**\n\n我们首先推导祖源连接点的预期密度。祖源连接点是染色体上祖源发生转换的点（例如，从物种 A 转换为 B，或从 B 转换为 A）。\n\n根据问题陈述的基本原则：\n- 当减数分裂中，在祖源杂合的位置发生交换时，就会产生一个连接点。\n- 沿长度为 $L$ 摩尔根的染色体，每次减数分裂的预期交换次数为 $L$。对于泊松过程，这意味着每摩尔根每次减数分裂的交换率为 $1$。\n- 任何位点的祖源杂合性，即二倍体个体在该位点为祖源杂合的概率，给定为一个恒定值 $H = 2m(1-m)$。\n\n每摩尔根、每代新连接点形成率是交换率与祖源杂合性概率的乘积。设 $\\rho(t)$ 为第 $t$ 代时每摩尔根的连接点密度。该密度的变化率为：\n$$\n\\frac{d\\rho(t)}{dt} = (\\text{交换率}) \\times (\\text{祖源杂合性}) = 1 \\times [2m(1-m)] = 2m(1-m)\n$$\n我们假设在混合脉冲时，$t=0$，染色体是纯 A 或纯 B 祖源，因此任何染色体内都没有连接点。因此，初始条件是 $\\rho(0) = 0$。\n\n将此微分方程从 $t=0$ 积分到当前代 $t$，得到总累积连接点密度：\n$$\n\\rho(t) = \\int_{0}^{t} 2m(1-m) \\,d\\tau = 2m(1-m)t\n$$\n整个基因组的预期连接点总数 $E[N_J]$ 是此密度与基因组总遗传长度 $L_{total}$ 的乘积：\n$$\nE[N_J] = \\rho(t) \\times L_{total} = 2m(1-m)tL_{total}\n$$\n问题要求 A 祖源片段的预期数量 $E[N_A]$。我们被指示忽略染色体末端引起的末端效应。这意味着模型假设基因组足够长，以至于染色体末端的片段不会显著改变整体统计数据。在此极限下，A 片段的数量预期等于 B 片段的数量，因为任何从 A 到 B 的转换之后都必须跟随着一个从 B 到 A 的转换以产生下一个 A 片段。片段的总数约等于连接点的总数。因此，A 片段的数量是连接点总数的一半。\n$$\nE[N_A] = \\frac{1}{2} E[N_J]\n$$\n代入我们为 $E[N_J]$ 推导的表达式，我们得到第一个所需表达式：\n$$\nE[N_A] = \\frac{1}{2} [2m(1-m)tL_{total}] = m(1-m)tL_{total}\n$$\n\n**2. 祖源片段平均长度的推导**\n\nA 祖源片段的平均长度是所有 A 祖源区段的总预期长度除以 A 祖源片段的预期数量。\n\n在总长度为 $L_{total}$ 的基因组中，物种 A 祖源的总预期长度 $E[L_{A,total}]$ 由 A 祖源的比例 $m$ 乘以总长度给出：\n$$\nE[L_{A,total}] = m \\times L_{total}\n$$\nA 片段的平均长度 $E[\\bar{L}_A]$ 则是：\n$$\nE[\\bar{L}_A] = \\frac{E[L_{A,total}]}{E[N_A]}\n$$\n代入我们为 $E[L_{A,total}]$ 和 $E[N_A]$ 推导的表达式：\n$$\nE[\\bar{L}_A] = \\frac{m L_{total}}{m(1-m)tL_{total}}\n$$\n项 $m$ 和 $L_{total}$ 被消去，得到第二个所需表达式：\n$$\nE[\\bar{L}_A] = \\frac{1}{(1-m)t}\n$$\n这个结果与总基因组长度无关，仅取决于混合以来的时间和另一祖源的比例。\n\n**3. 数值计算**\n\n首先，我们根据提供的标记数据计算总遗传长度 $L_{total}$。单位换算为 $1 \\text{ cM} = 0.01 \\text{ M}$。\n- 染色体 1 长度: $L_1 = (135 - 0) \\text{ cM} = 135 \\text{ cM} = 1.35 \\text{ M}$。\n- 染色体 2 长度: $L_2 = (95 - 0) \\text{ cM} = 95 \\text{ cM} = 0.95 \\text{ M}$。\n- 染色体 3 长度: $L_3 = (70 - 0) \\text{ cM} = 70 \\text{ cM} = 0.70 \\text{ M}$。\n\n三个常染色体的总长度是：\n$$\nL_{total} = L_1 + L_2 + L_3 = 1.35 \\text{ M} + 0.95 \\text{ M} + 0.70 \\text{ M} = 3.00 \\text{ M}\n$$\n给定的参数是 $m = 0.30$ 和 $t = 20$ 代。\n\n现在我们计算推导出的表达式，并按要求四舍五入到四位有效数字。\n\n物种 A 祖源片段的预期数量：\n$$\nE[N_A] = m(1-m)tL_{total} = (0.30)(1 - 0.30)(20)(3.00) = (0.30)(0.70)(60) = 0.21 \\times 60 = 12.6\n$$\n四舍五入到四位有效数字，结果是 $12.60$。\n\n物种 A 祖源片段的平均长度（以摩尔根为单位）：\n$$\nE[\\bar{L}_A] = \\frac{1}{(1-m)t} = \\frac{1}{(1 - 0.30)(20)} = \\frac{1}{(0.70)(20)} = \\frac{1}{14} \\text{ M}\n$$\n换算成小数，约等于 $0.07142857...$ M。四舍五入到四位有效数字，结果是 $0.07143$ M。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n12.60  0.07143\n\\end{pmatrix}\n}\n$$", "id": "2607831"}, {"introduction": "研究网状进化的一个关键任务是统计上检测物种间的基因流（基因渗入）。Patterson的$D$统计量，也称为ABBA-BABA测试，通过检验衍生等位基因共享的不对称性，为此提供了一种强有力的方法。本练习将指导您完成$D$统计量及其标准误的计算（使用刀切法），让您亲手体验系统发育基因组学中的一个基本工具 [@problem_id:2607877]。", "problem": "您正在使用四分类单元检验法，研究与同倍体杂交物种形成相关的潜在基因渗入。该检验法用于分析三个内群分类单元与一个外群（排列为 $((P_1,P_2),P_3)$ 及外群 $O$）之间衍生等位基因共享的不对称性。在一个双等位基因单核苷酸多态性（SNP）位点上，相对于外群的祖先等位基因 $A$，如果衍生等位基因 $B$ 出现在 $P_2$ 和 $P_3$ 中但未出现在 $P_1$ 中，则该位点为 $ABBA$ 位点；如果衍生等位基因 $B$ 出现在 $P_1$ 和 $P_3$ 中但未出现在 $P_2$ 中，则为 $BABA$ 位点。在没有基因渗入的零假设下，仅由于不完全谱系分选，各处位点的 $ABBA$ 和 $BABA$ 计数预期是对称的。\n\n为处理连锁问题，您已将基因组划分为 $50$ 个不重叠的区块。您在每个区块中计数了信息性 $ABBA$ 和 $BABA$ 位点的数量。各个区块的信息位点总数相等。数据如下：\n\n- 区块 $1$ 至 $10$：$ABBA=55$, $BABA=45$。\n- 区块 $11$ 至 $20$：$ABBA=53$, $BABA=47$。\n- 区块 $21$ 至 $30$：$ABBA=52$, $BABA=48$。\n- 区块 $31$ 至 $40$：$ABBA=51$, $BABA=49$。\n- 区块 $41$ 至 $50$：$ABBA=49$, $BABA=51$。\n\n使用 Patterson $D$ 统计量的标准定义（即所有位点上 $ABBA$ 和 $BABA$ 计数的标准化差异），并通过对 $50$ 个区块使用删除一块区块的刀切法来估计 $D$ 的标准误，计算：\n- 使用所有区块的 $D$ 的点估计值，\n- $D$ 的刀切法标准误，\n- 在标准正态近似下的相应 $Z$ 分数。\n\n假设每个区块贡献了相同数量的信息位点，并使用用于比率统计量的常规删除一块区块的刀切法方差估计量。根据 $Z$ 分数的大小，在 $\\alpha=0.05$ 的显著性水平上检验基因渗入，但仅报告数值。\n\n将您的最终数值答案表示为单个行向量，顺序为 $D$、标准误、$Z$ 分数，并四舍五入至三位有效数字。不要包含单位。", "solution": "该问题陈述已经过验证，被认为是具有科学依据、提法得当且客观的。这是群体遗传学中 ABBA-BABA 检验和刀切法重抽样的标准应用。我们可以继续进行求解。\n\n任务是计算 Patterson $D$ 统计量、通过删除一块区块的刀切法得到的其标准误以及相应的 $Z$ 分数。该系统由三个内群分类单元 $(P_1, P_2, P_3)$ 和一个外群 $O$ 组成，指定的系统发育关系为 $((P_1,P_2),P_3)$。\n\n首先，我们将所有区块中 $ABBA$ 位点的总计数记为 $N_{ABBA}$，$BABA$ 位点的总计数记为 $N_{BABA}$。数据是为 $n=50$ 个区块提供的，这些区块被分为五组，每组 $10$ 个区块。\n\n每组 $10$ 个区块的计数如下：\n- 第 1 组（区块 $1-10$）：$C_{ABBA}=55$, $C_{BABA}=45$。\n- 第 2 组（区块 $11-20$）：$C_{ABBA}=53$, $C_{BABA}=47$。\n- 第 3 组（区块 $21-30$）：$C_{ABBA}=52$, $C_{BABA}=48$。\n- 第 4 组（区块 $31-40$）：$C_{ABBA}=51$, $C_{BABA}=49$。\n- 第 5 组（区块 $41-50$）：$C_{ABBA}=49$, $C_{BABA}=51$。\n\n总计数是通过将所有 $50$ 个区块的贡献相加计算得出的：\n$$ N_{ABBA} = 10 \\times 55 + 10 \\times 53 + 10 \\times 52 + 10 \\times 51 + 10 \\times 49 $$\n$$ N_{ABBA} = 10 \\times (55 + 53 + 52 + 51 + 49) = 10 \\times 260 = 2600 $$\n$$ N_{BABA} = 10 \\times 45 + 10 \\times 47 + 10 \\times 48 + 10 \\times 49 + 10 \\times 51 $$\n$$ N_{BABA} = 10 \\times (45 + 47 + 48 + 49 + 51) = 10 \\times 240 = 2400 $$\n\nPatterson $D$ 统计量定义为 $ABBA$ 和 $BABA$ 位点计数之间的标准化差异：\n$$ D = \\frac{N_{ABBA} - N_{BABA}}{N_{ABBA} + N_{BABA}} $$\n使用总计数，$D$ 的点估计值为：\n$$ D = \\frac{2600 - 2400}{2600 + 2400} = \\frac{200}{5000} = \\frac{1}{25} = 0.04 $$\n\n接下来，我们使用删除一块区块的刀切法计算 $D$ 的标准误。设 $n=50$ 为区块数。设 $D_i$ 为移除第 $i$ 个区块后数据集上计算的 $D$ 统计量的估计值。$D$ 的刀切法方差由下式给出：\n$$ \\text{Var}_{\\text{jack}}(D) = \\frac{n-1}{n} \\sum_{i=1}^{n} (D_i - \\bar{D}_{\\text{jack}})^2 $$\n其中 $\\bar{D}_{\\text{jack}} = \\frac{1}{n} \\sum_{i=1}^{n} D_i$。\n\n设 $C_{ABBA,i}$ 和 $C_{BABA,i}$ 是第 $i$ 个区块中的计数。问题陈述指出，每个区块的信息位点总数是恒定的。对于任何区块 $i$，该总数为 $C_{ABBA,i} + C_{BABA,i} = 100$。设这个常数为 $s = 100$。\n所有 $n$ 个区块的信息位点总数为 $S = N_{ABBA} + N_{BABA} = 5000$。\n\n当移除区块 $j$ 时，重新计算的 $D$ 统计量 $D_j$ 为：\n$$ D_j = \\frac{(N_{ABBA} - C_{ABBA,j}) - (N_{BABA} - C_{BABA,j})}{(N_{ABBA} - C_{ABBA,j}) + (N_{BABA} - C_{BABA,j})} = \\frac{(N_{ABBA} - N_{BABA}) - (C_{ABBA,j} - C_{BABA,j})}{(N_{ABBA} + N_{BABA}) - (C_{ABBA,j} + C_{BABA,j})} $$\n$$ D_j = \\frac{200 - (C_{ABBA,j} - C_{BABA,j})}{5000 - 100} = \\frac{200 - (C_{ABBA,j} - C_{BABA,j})}{4900} $$\n因为对于所有的 $j$，分母都是常数，所以 $\\bar{D}_{\\text{jack}}$ 精确等于完整的估计值 $D$。\n$\\bar{D}_{\\text{jack}} = \\frac{1}{n}\\sum D_j = \\frac{1}{n(S-s)} \\sum( (N_{ABBA}-N_{BABA}) - (C_{ABBA,j} - C_{BABA,j}) ) = \\frac{1}{n(S-s)} (n(N_{ABBA}-N_{BABA}) - \\sum(C_{ABBA,j}-C_{BABA,j}))$.\n由于 $\\sum(C_{ABBA,j}-C_{BABA,j}) = N_{ABBA}-N_{BABA}$，我们有 $\\bar{D}_{\\text{jack}} = \\frac{(n-1)(N_{ABBA}-N_{BABA})}{n(S-s)}$。\n让我们检查一下推导过程。对于分母贡献恒定的比率统计量，这是一个已知的性质。\n思考过程中的原始推导是正确的：$\\sum D_i = Y/c$ 其中 $Y = N_{ABBA}-N_{BABA}$ 而 $c$ 是分母的贡献。这导致 $\\bar{D}_{jack} = Y/(nc) \\neq D$。让我们重新评估。\n设 $y_i = C_{ABBA,i}-C_{BABA,i}$ 且 $x_i = C_{ABBA,i}+C_{BABA,i}=s=100$。设 $Y=\\sum y_i$ 且 $X=\\sum x_i = ns$。\n$D = Y/X = Y/(ns)$。\n$D_i = (\\sum_{j \\neq i} y_j) / (\\sum_{j \\neq i} x_j) = (Y-y_i)/(X-x_i) = (Y-y_i)/((n-1)s)$。\n$\\bar{D}_{\\text{jack}} = \\frac{1}{n} \\sum D_i = \\frac{1}{n(n-1)s} \\sum(Y-y_i) = \\frac{1}{n(n-1)s} (nY-Y) = \\frac{Y(n-1)}{n(n-1)s} = \\frac{Y}{ns} = D$。\n这个简化成立。方差估计量为 $\\text{Var}_{\\text{jack}}(D) = \\frac{n-1}{n} \\sum_{i=1}^{n} (D_i - D)^2$。\n\n我们有五组不同的 $D_i$ 值。设 $d_j = C_{ABBA,j} - C_{BABA,j}$。并且，$D = 0.04 = \\frac{196}{4900}$。\n- 对于区块 $1-10$：$d_j = 55-45=10$。$D_j = \\frac{200-10}{4900} = \\frac{190}{4900}$。$D_j-D = \\frac{190-196}{4900} = -\\frac{6}{4900}$。\n- 对于区块 $11-20$：$d_j = 53-47=6$。$D_j = \\frac{200-6}{4900} = \\frac{194}{4900}$。$D_j-D = \\frac{194-196}{4900} = -\\frac{2}{4900}$。\n- 对于区块 $21-30$：$d_j = 52-48=4$。$D_j = \\frac{200-4}{4900} = \\frac{196}{4900}$。$D_j-D = 0$。\n- 对于区块 $31-40$：$d_j = 51-49=2$。$D_j = \\frac{200-2}{4900} = \\frac{198}{4900}$。$D_j-D = \\frac{198-196}{4900} = \\frac{2}{4900}$。\n- 对于区块 $41-50$：$d_j = 49-51=-2$。$D_j = \\frac{200-(-2)}{4900} = \\frac{202}{4900}$。$D_j-D = \\frac{202-196}{4900} = \\frac{6}{4900}$。\n\n差值的平方和为：\n$$ \\sum_{i=1}^{50} (D_i - D)^2 = 10 \\left[ \\left(-\\frac{6}{4900}\\right)^2 + \\left(-\\frac{2}{4900}\\right)^2 + (0)^2 + \\left(\\frac{2}{4900}\\right)^2 + \\left(\\frac{6}{4900}\\right)^2 \\right] $$\n$$ \\sum_{i=1}^{50} (D_i - D)^2 = \\frac{10}{4900^2} [36 + 4 + 0 + 4 + 36] = \\frac{10 \\times 80}{4900^2} = \\frac{800}{4900^2} $$\n刀切法方差为：\n$$ \\text{Var}_{\\text{jack}}(D) = \\frac{50-1}{50} \\times \\frac{800}{4900^2} = \\frac{49}{50} \\times \\frac{800}{(49 \\times 100)^2} = \\frac{49}{50} \\times \\frac{800}{49^2 \\times 100^2} $$\n$$ \\text{Var}_{\\text{jack}}(D) = \\frac{1}{50} \\times \\frac{800}{49 \\times 10000} = \\frac{16}{49 \\times 10000} = \\frac{16}{490000} $$\n刀切法标准误 $SE_{\\text{jack}}(D)$ 是方差的平方根：\n$$ SE_{\\text{jack}}(D) = \\sqrt{\\frac{16}{490000}} = \\frac{4}{700} = \\frac{1}{175} $$\n数值上，$SE_{\\text{jack}}(D) \\approx 0.00571428...$。\n\n最后，在零假设 $H_0: D=0$ 下计算 $Z$ 分数。\n$$ Z = \\frac{D - 0}{SE_{\\text{jack}}(D)} = \\frac{D}{SE_{\\text{jack}}(D)} $$\n$$ Z = \\frac{1/25}{1/175} = \\frac{175}{25} = 7 $$\n问题要求报告 $D$、标准误和 $Z$ 分数的数值，均四舍五入至三位有效数字。\n- $D = 0.04$。保留三位有效数字为 $0.0400$。\n- $SE_{\\text{jack}}(D) = 1/175 \\approx 0.00571428...$。保留三位有效数字为 $0.00571$。\n- $Z = 7$。保留三位有效数字为 $7.00$。\n\n计算出的 $Z$ 分数值 $7.00$ 在量级上远大于显著性水平 $\\alpha = 0.05$ 对应的标准临界值 $1.96$，这表明强烈拒绝无基因渗入的零假设。然而，根据指示，只报告数值结果。\n最终结果是：\n- $D$ 的点估计值：$0.0400$\n- $D$ 的刀切法标准误：$0.00571$\n- $Z$ 分数：$7.00$", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0400  0.00571  7.00 \\end{pmatrix} } $$", "id": "2607877"}, {"introduction": "将基因渗入的信号与不完全谱系分选（ILS）区分开来是一项核心挑战，需要严谨的统计方法。基因渗入统计检验的有效性取决于正确的零模型，在多物种溯祖模型下，该模型预测了不一致基因树拓扑结构的特定对称性。通过批判性地评估几种统计检验方案，您将加深对检测基因渗入的理论基础的理解，并学会从有缺陷的方法中识别出方法论上可靠的途径 [@problem_id:2607882]。", "problem": "您正在研究一个由三个近缘物种$A$、$B$和$C$组成的演化支，怀疑其中发生了同倍体杂交物种形成。一个外群$O$可用于确定演化关系的极性。您在$L=600$个不连锁的基因座（每个基因座跨越一个无重组区域）上推断出了有根基因树。限制在四分类单元组$\\{A,B,C,O\\}$内，推断出的拓扑结构总结如下：\n- 与物种树$((A,B),C)$一致：$n_{\\text{conc}}=330$。\n- 不一致的拓扑结构$((A,C),B)$：$n_{AC|B}=180$。\n- 不一致的拓扑结构$((B,C),A)$：$n_{BC|A}=90$。\n假设基因树推断错误可以忽略不计，并且在不同的不一致拓扑结构之间近似对称。\n\n背景和第一性原理：\n- 在多物种溯祖模型（MSC）下，即使没有基因流，不完全谱系分选（ILS）也会产生与物种树不一致的基因树。对于一个内部支长度为$t$（以溯祖单位计）的有根三分类单元物种树，MSC的一个核心性质是，在仅有ILS的情况下，两种不一致的基因树拓扑结构具有相等的概率。这源于祖先种群中谱系的可交换性，该性质意味着，在内部支上未能发生溯祖合并的条件下，三对谱系中的任何一对在更深的祖先种群中首先发生溯祖合并的概率是相等的。\n- 通过基因渗入进行的网状演化会打破这种对称性，因为它会提高将发生基因渗入的谱系分组在一起的不一致拓扑结构的频率。\n\n您的目标是选择一个有效的统计检验程序，该程序应满足以下条件：\n- 明确陈述用于区分仅有ILS和存在基因渗入的原假设与备择假设。\n- 指定一个具有已知或可计算的零分布的检验统计量。\n- 在预先设定的水平$\\alpha=0.05$上控制I类错误。\n- 当应用于上述数据集时，在有充分理由的情况下，会拒绝仅有ILS的模型。\n\n以下哪个选项满足这些要求，并且在应用于上述计数时，会在$\\alpha=0.05$的水平上拒绝仅有ILS的模型？\n\nA. 将原假设$H_{0}$定义为MSC下的仅有ILS，这意味着两种不一致的拓扑结构以相等的概率出现。以不一致基因树的总数$k=n_{AC|B}+n_{BC|A}$为条件，使用精确二项检验来检验$H_{0}: p=\\tfrac{1}{2}$与$H_{A}: p\\neq \\tfrac{1}{2}$，其中$p$是一个不一致基因树属于$((A,C),B)$类型的概率。使用检验统计量$T=\\lvert n_{AC|B}-k/2\\rvert$和精确二项零分布计算双边p值，当p值小于$\\alpha=0.05$时拒绝原假设。为考虑任何残余连锁，将基因座划分为近似独立的基因组块，并通过块自举法（在重抽样的块上重新计算$T$）来验证校准。将此检验应用于上述数据。\n\nB. 将$H_{0}$定义为MSC下的仅有ILS，且所有三种有根基因树拓扑结构具有相等的概率。对3个拓扑结构类别进行卡方拟合优度检验，每个类别的期望计数为$L/3$，当卡方p值小于$\\alpha=0.05$时拒绝原假设。将此检验应用于上述数据。\n\nC. 拟合一个包含单条基因渗入边的系统发育网络模型，并计算其在$L$个基因树上的最大似然值。拟合一个不含基因渗入的物种树模型，并计算其最大似然值。使用似然比检验（LRT），其零分布为渐近$\\chi^{2}$分布，自由度等于增加的基因渗入参数的数量，当LRT的p值小于$\\alpha=0.05$时拒绝原假设。\n\nD. 将$H_{0}$定义为在物种树$((A,B),C)$上仅有ILS的MSC模型，其参数（分歧时间和有效种群大小）根据数据估计。定义检验统计量$T=\\lvert n_{AC|B}-n_{BC|A}\\rvert$。通过参数自举法校准$T$的零分布：在拟合的MSC模型下，模拟$M=10{,}000$个包含$L=600$个独立基因树的重复数据集，为每个数据集计算$T^{*}$，并将$T^{*}\\ge T_{\\text{obs}}$的重复样本比例估计为p值。如果自举p值小于$\\alpha=0.05$，则拒绝原假设。将此程序应用于上述数据。\n\n选择所有适用项。", "solution": "该问题要求评估用于在不完全谱系分选（ILS）背景下，利用基因树拓扑结构计数来检测基因渗入的统计程序。该检验的基本原理源于多物种溯祖模型（MSC）。对于一个三分类单元物种树，如本文所考虑的$((A,B),C)$，MSC模型在无基因流的原假设（$H_0$：仅有ILS）下作出了一个特定的预测。虽然对于足够长的内部支，与物种树$((A,B),C)$一致的基因树拓扑结构预期是最常见的，但两种不一致的拓扑结构$((A,C),B)$和$((B,C),A)$被预测以相等的概率出现。这是因为，在发生ILS的条件下（即$A$和$B$的祖先谱系未能在其最近的共同祖先种群中溯祖合并），留在$(A,B,C)$的更深层祖先种群中的三个谱系是可交换的，这意味着任何一对谱系首先溯祖合并的概率都是相等的。\n\n网状演化，例如物种$A$和$C$之间的基因渗入，会转移遗传物质，从而增加它们之间共享祖先的频率，提高了具有$((A,C),B)$拓扑结构的基因树的数量。这打破了仅在ILS条件下预期的对称性。因此，检验基因渗入的统计检验可以表述为检验两种不一致拓扑结构的计数是否显著偏离1:1的比例。\n\n提供的数据是：\n-   总基因座数：$L=600$。\n-   一致拓扑结构$((A,B),C)$的计数：$n_{\\text{conc}}=330$。\n-   不一致拓扑结构$((A,C),B)$的计数：$n_{AC|B}=180$。\n-   不一致拓扑结构$((B,C),A)$的计数：$n_{BC|A}=90$。\n\n不一致基因树的总数是$k = n_{AC|B} + n_{BC|A} = 180 + 90 = 270$。原假设$H_0$（仅有ILS）预测，在这$k=270$个不一致的树中，两种类型的期望计数是相等的：$E(n_{AC|B}) = E(n_{BC|A}) = k/2 = 135$。观测到的计数显示出强烈的非对称性（180对90），我们现在必须使用每个选项中提出的程序，在$\\alpha=0.05$的显著性水平上对其进行正式检验。\n\nA. 该选项提出了一个基于不一致拓扑结构对称性的检验。\n-   **假设**：原假设是$H_{0}: p=\\tfrac{1}{2}$，其中$p$是一个随机选择的不一致基因树具有$((A,C),B)$拓扑结构的概率。备择假设是$H_{A}: p\\neq \\tfrac{1}{2}$。这正确地将检验基因渗入导致的对称性破缺形式化了。\n-   **检验与统计量**：它以不一致树的总数$k=270$为条件，并使用精确二项检验。这是一种标准的、统计上有效的方法。它正确地将“试验”次数确定为$k=270$，将“成功”次数（例如，拓扑结构$((A,C),B)$）确定为$n_{AC|B}=180$。检验统计量$T=\\lvert n_{AC|B}-k/2\\rvert$衡量了与原假设期望的偏差。\n-   **应用**：我们检验在$270$次试验中观察到$180$次成功是否与$H_0: p=0.5$下的期望值$135$有显著差异。双边p值是观察到至少与$180$一样极端的结果的概率，即$P(X \\ge 180) + P(X \\le 90)$，其中$X \\sim B(270, 0.5)$。由于样本量大，我们可以使用带连续性校正的正态分布近似二项分布。均值为$\\mu = kp = 270 \\times 0.5 = 135$，标准差为$\\sigma = \\sqrt{kp(1-p)} = \\sqrt{270 \\times 0.5 \\times 0.5} = \\sqrt{67.5} \\approx 8.216$。Z-分数为：\n$$ Z = \\frac{\\lvert n_{AC|B} - \\mu \\rvert - 0.5}{\\sigma} = \\frac{\\lvert 180 - 135 \\rvert - 0.5}{8.216} = \\frac{44.5}{8.216} \\approx 5.416 $$\n在$\\alpha=0.05$水平下的双边检验的临界Z值为$Z_{\\alpha/2} = 1.96$。由于我们观察到的Z分数$5.416$远大于$1.96$，因此p值极小（$p \\ll 0.05$）。因此，原假设将被拒绝。提及块自举法是关于处理潜在连锁数据的良好实践的一个额外细节，但它不改变核心统计程序本身的有效性。\n-   **结论**：**正确**。该程序在统计上是有效的，并且使用给定数据会导致拒绝原假设。\n\nB. 该选项提出了一个卡方拟合优度检验。\n-   **假设**：$H_0$是所有三种有根基因树拓扑结构具有相等的概率，即$P(((A,B),C)) = P(((A,C),B)) = P(((B,C),A)) = 1/3$。\n-   **评判**：这个原假设在科学上是不合理的。对于一个分叉的物种树，MSC模型并不预测三种拓扑结构具有相等的概率，除非是内部支长度$t=0$（一个硬多歧分枝）的特殊情况。对于任何$t0$，一致拓扑结构的概率是$P_{\\text{conc}} = 1 - \\frac{2}{3}e^{-t}$，而每种不一致拓扑结构的概率是$P_{\\text{disc}} = \\frac{1}{3}e^{-t}$。因此，对于任何已解析的物种历史，$P_{\\text{conc}}  P_{\\text{disc}}$。针对一个不正确的原假设进行检验，并不构成一个用于在特定物种树上区分ILS和基因渗入的有效检验。\n-   **结论**：**不正确**。该程序无效，因为其原假设是对仅有ILS模型的不正确表述。\n\nC. 该选项提出了一个在系统发育网络和物种树之间的似然比检验（LRT）。\n-   **程序**：这是一种强大的、基于模型的方法，它直接比较数据在有基因渗入的模型（$H_A$）和没有基因渗入的模型（$H_0$）下的似然值。\n-   **评判**：该程序指定为LRT统计量使用一个渐近$\\chi^{2}$零分布。在这种情况下，这是一个关键的统计错误。无基因渗入的原假设将基因渗入概率参数$\\gamma$设为零。由于$\\gamma$不能为负，这是一个在参数空间边界上的检验。标准的LRT理论（其产生渐近$\\chi^2$分布）在这种情况下不成立。正确的渐近零分布是$\\chi^2$分布的混合（例如，一个在0处的点质量和一个$\\chi^2_1$分布的$50:50$混合）。使用标准的$\\chi^2$分布将导致一个未被正确校准的检验，通常会伴随一个膨胀的I类错误率。一个未能在指定水平$\\alpha$上控制I类错误的程序是无效的。\n-   **结论**：**不正确**。所述程序因错误指定了检验统计量的零分布而在统计上是无效的。\n\nD. 该选项提出了一个参数自举程序。\n-   **假设与统计量**：原假设是在物种树$((A,B),C)$上仅有ILS，检验统计量是$T=\\lvert n_{AC|B}-n_{BC|A}\\rvert$。该统计量直接量化了作为基因渗入标志的非对称性。对于观测数据，$T_{\\text{obs}} = \\lvert 180 - 90 \\rvert = 90$。\n-   **程序**：使用参数自举法来生成$T$的零分布。这包括（1）使用观测数据在$H_0$下估计MSC模型的参数（例如，支长），（2）从此拟合的零模型中模拟大量包含$L=600$个基因树的重复数据集，（3）为每个重复计算统计量$T^*$，以及（4）将$T^* \\ge T_{\\text{obs}}$的重复样本比例计算为p值。\n-   **评判**：这是一个统计上严谨且有效的框架。参数自举法是复杂模型中进行假设检验的金标准方法，因为它不依赖于可能不适用（如选项C中）的渐近理论。它构建了一个能准确反映原假设的经验零分布。\n-   **应用**：在$H_0$下，两种不一致拓扑结构的比率是相等的。一致树的比例是$330/600 = 0.55$。这允许在MSC下估计内部支的长度：$1 - \\frac{2}{3}e^{-t} = 0.55 \\implies t \\approx 0.393$。因此，每种不一致拓扑结构的期望比例是$\\frac{1}{3}e^{-t} \\approx 0.225$。因此期望计数为$n_{AC|B} = n_{BC|A} = 600 \\times 0.225 = 135$。观测到的统计量$T_{\\text{obs}} = 90$代表了与期望差异$0$的巨大偏离。几乎可以肯定，参数自举法将产生远小于$0.05$的p值，从而导致拒绝$H_0$。\n-   **结论**：**正确**。该程序在统计上是有效且稳健的，并且使用给定数据会拒绝原假设。\n\n总而言之，选项A和选项D都描述了检验基因渗入假说的有效统计程序，并且鉴于所提供的基因树计数中存在显著的非对称性，两者都会导致强烈拒绝仅有ILS的原假设。", "answer": "$$\\boxed{AD}$$", "id": "2607882"}]}