{"hands_on_practices": [{"introduction": "哺乳动物和鸟类演化过程中的一项关键创新是毛发和羽毛等隔热层的出现。为了理解这一转变背后强大的选择压力，我们可以对这些附肢的热学特性进行建模。本练习将要求您运用傅里叶热传导定律，量化并比较毛发和羽毛相对于原始鳞片状皮肤的保温能力，从第一性原理的视角审视恒温调节带来的功能优势。[@problem_id:2572030]", "problem": "哺乳动物的毛发和鸟类的羽毛等表皮附属物的一个核心选择优势是调节皮肤与环境之间的热传递。考虑一个简化的纯传导模型，该模型比较了三种被认为是进化相关的表皮状态结构：致密的鳞片状角蛋白层（祖先状态）、毛垫和羽绒层。将每个附属物模型化为一个位于皮肤和环境空气之间、厚度均为 $L$ 的均匀、各向同性平板。假设平板内为稳态一维传导，物性恒定，界面处为完美热接触，并忽略由附属物结构维持的静止微环境所产生的对流和热辐射。设皮肤与环境的温差为 $\\Delta T>0$。将鳞片状角蛋白、毛垫（有效值，包括滞留的空气）和羽绒（有效值，包括滞留的空气）的热导率分别记为 $k_{s}$、$k_{h}$ 和 $k_{f}$。\n\n将通过任一平板的稳态热通量大小定义为 $q$，并将替代附属物 $X\\in\\{\\text{毛发, 羽毛}\\}$ 相对于鳞片状角蛋白层的热通量减少量定义为\n$$R_{X} \\equiv q_{\\text{scale}} - q_{X}.$$\n仅使用稳态一维热传导在本构定律中的表述以及给定的边界条件，推导毛垫和羽绒层实现的热通量减少量之比 $R_{\\text{hair}}/R_{\\text{feather}}$，并用 $k_{s}$、$k_{h}$ 和 $k_{f}$ 将你的最终答案表示为一个单一的简化解析表达式。无需进行数值计算，最终表达式中不应报告单位。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n已知条件逐字提取如下：\n- 模型：一个比较三种表皮结构的简化纯传导模型：致密的鳞片状角蛋白层、毛垫和羽绒层。\n- 几何形状：每个附属物都是一个厚度均为 $L$ 的均匀、各向同性平板。\n- 边界条件：平板位于皮肤和环境空气之间，皮肤与环境的温差为 $\\Delta T > 0$。假设界面处为完美热接触。\n- 假设：稳态、平板内一维传导、物性恒定、忽略对流和热辐射。\n- 参数：热导率分别为 $k_{s}$（鳞片状角蛋白）、$k_{h}$（毛垫）和 $k_{f}$（羽绒）。\n- 定义：稳态热通量大小为 $q$。替代附属物 $X\\in\\{\\text{毛发, 羽毛}\\}$ 的热通量减少量定义为 $R_{X} \\equiv q_{\\text{scale}} - q_{X}$。\n- 目标：推导热通量减少量之比 $R_{\\text{hair}}/R_{\\text{feather}}$，并用 $k_{s}$、$k_{h}$ 和 $k_{f}$ 表示为一个简化的解析表达式。\n\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题基于傅里叶热传导定律，这是物理学和热工程学中一个基本且公认的原理。其生物学背景是科学合理的，并为物理模型提供了有效的动机。\n- **适定性：** 所有必要的参数（$L$, $\\Delta T$, $k_s$, $k_h$, $k_f$）和定义（$q$, $R_X$）都已给出，足以推导出所要求的比率。该问题是自洽的，并能导出一个唯一解。\n- **客观性：** 问题使用精确、定量和无偏见的专业技术语言进行表述。\n\n问题陈述没有科学不健全、模糊不清和内部矛盾之处。它提出了一个标准的、尽管经过简化的、可以形式化和求解的物理问题。因此，该问题被认为是有效的。我们继续进行求解。\n\n控制该问题的基本原理是稳态一维热传导的本构定律，即傅里叶定律。对于一个厚度为 $L$、均匀热导率为 $k$、两面承受恒定温差 $\\Delta T$ 的平板，其稳态热通量大小 $q$ 由下式给出：\n$$q = k \\frac{\\Delta T}{L}$$\n该方程是在稳态条件下，对傅里叶定律的微分形式 $q = -k \\frac{dT}{dx}$ 沿平板厚度积分的直接结果，这会导致线性温度分布。\n\n我们将此通用公式应用于三种指定的表皮结构，注意根据问题陈述，所有情况下的厚度 $L$ 和温差 $\\Delta T$ 都是相同的。\n\n对于鳞片状角蛋白层，热通量 $q_{\\text{scale}}$ 为：\n$$q_{\\text{scale}} = k_{s} \\frac{\\Delta T}{L}$$\n对于毛垫，热通量 $q_{\\text{hair}}$ 为：\n$$q_{\\text{hair}} = k_{h} \\frac{\\Delta T}{L}$$\n对于羽绒层，热通量 $q_{\\text{feather}}$ 为：\n$$q_{\\text{feather}} = k_{f} \\frac{\\Delta T}{L}$$\n问题将附属物 $X$ 相对于祖先鳞片状层的热通量减少量 $R_{X}$ 定义为 $R_{X} \\equiv q_{\\text{scale}} - q_{X}$。我们现在将为毛垫和羽绒层计算这个量。\n\n毛垫的热通量减少量 $R_{\\text{hair}}$ 为：\n$$R_{\\text{hair}} = q_{\\text{scale}} - q_{\\text{hair}} = k_{s} \\frac{\\Delta T}{L} - k_{h} \\frac{\\Delta T}{L}$$\n提取公因式 $\\frac{\\Delta T}{L}$，我们得到：\n$$R_{\\text{hair}} = (k_{s} - k_{h}) \\frac{\\Delta T}{L}$$\n类似地，羽绒层的热通量减少量 $R_{\\text{feather}}$ 为：\n$$R_{\\text{feather}} = q_{\\text{scale}} - q_{\\text{feather}} = k_{s} \\frac{\\Delta T}{L} - k_{f} \\frac{\\Delta T}{L}$$\n提取公因式 $\\frac{\\Delta T}{L}$ 得到：\n$$R_{\\text{feather}} = (k_{s} - k_{f}) \\frac{\\Delta T}{L}$$\n目标是求出这两个热通量减少量之比 $\\frac{R_{\\text{hair}}}{R_{\\text{feather}}}$。我们使用上面推导出的表达式来构建这个比率：\n$$\\frac{R_{\\text{hair}}}{R_{\\text{feather}}} = \\frac{(k_{s} - k_{h}) \\frac{\\Delta T}{L}}{(k_{s} - k_{f}) \\frac{\\Delta T}{L}}$$\n项 $\\frac{\\Delta T}{L}$ 非零（因为 $\\Delta T > 0$ 且 $L$ 必须是正厚度），并且同时出现在分子和分母中。因此可以消去。这个消去是预料之中的，因为在给定的相同几何和热边界条件下，该比率应仅取决于材料的内在属性（热导率）。\n\n该比率的最终简化表达式为：\n$$\\frac{R_{\\text{hair}}}{R_{\\text{feather}}} = \\frac{k_{s} - k_{h}}{k_{s} - k_{f}}$$\n此结果完全由热导率 $k_{s}$、$k_{h}$ 和 $k_{f}$ 表示，符合题目要求。从物理上看，这个比率比较了毛发与羽毛相对于基准的鳞片皮肤所提供的隔热性能的改善程度。较大的 $k_{s}$ 值和较小的 $k_{h}$、$k_{f}$ 值会导致更大的热通量减少，这与隔热的进化优势是一致的。", "answer": "$$\\boxed{\\frac{k_{s} - k_{h}}{k_{s} - k_{f}}}$$", "id": "2572030"}, {"introduction": "除了隔热功能，羽毛等附肢的演化还涉及为适应力学性能而产生的非凡结构。例如，羽轴必须既轻便又足够坚固，以抵抗飞行中的空气动力。在本练习中，您将运用欧拉-伯努利梁理论，将羽轴作为一个工程结构进行建模，并计算其临界屈曲载荷，从而揭示自然选择如何优化其几何形状以实现力学稳定性。[@problem_id:2572047]", "problem": "羽轴可被理想化为一根细长的、初始笔直的生物梁，其主要由皮质β-角蛋白构成。自然选择使其几何形状得以优化，以抵抗飞行过程中的气动载荷和肌肉载荷引起的屈曲。考虑一段长度为 $L$ 的羽轴，其沿形心轴承受轴向压缩载荷 $P$，两端可自由转动但横向位移受约束（两端铰接条件）。假设小挠度和线性弹性，并使用欧拉-伯努利梁理论对弯曲行为进行建模。\n\n任务：\n1) 从弯曲的本构关系 $M(x) = E I \\kappa(x)$ 出发，结合小斜率曲率近似 $\\kappa(x) \\approx y''(x)$ 以及轴向载荷 $P$ 下的静力矩平衡，推导羽轴横向挠度 $y(x)$ 的控制常微分方程 (ODE) 及其边界条件。不要事先假设任何试探模态函数。\n2) 求解所得的特征值问题，得到临界屈曲载荷 $P_{n}$ 的表达式，并确定以 $E$、$I$ 和 $L$ 表示的最小临界载荷 $P_{c}$。\n3) 羽轴的横截面近似为空心椭圆，其外半长轴为 $a$，外半短轴为 $b$，皮质壳厚度 $t$ 均匀；髓芯的刚度可忽略不计。使用面积差法，以内半轴 $a-t$ 和 $b-t$ 计算截面关于弱弯曲轴（$I$ 值最小的轴）的截面二次矩。将 $I$ 的结果用 $a$、$b$ 和 $t$ 以闭合形式表示。\n4) 使用参数 $E = 4.5 \\times 10^{9}\\,\\mathrm{Pa}$、$a = 2.0 \\times 10^{-3}\\,\\mathrm{m}$、$b = 1.5 \\times 10^{-3}\\,\\mathrm{m}$、$t = 0.25 \\times 10^{-3}\\,\\mathrm{m}$ 和 $L = 0.25\\,\\mathrm{m}$，计算最小临界屈曲载荷。最终载荷以牛顿为单位表示，并将答案四舍五入至三位有效数字。最终答案仅报告数值（不带单位）。", "solution": "所述问题具有科学依据、提法明确且客观。它提出了一个应用于生物力学系统的弹性稳定理论中的标准问题。我们将进行推导和求解。\n\n1) 控制方程和边界条件的推导。\n我们将羽轴建模为一根长度为 $L$、承受轴向压缩载荷为 $P$ 的细长梁。设 $x$ 为沿梁未变形形心轴的坐标，从 $x=0$ 到 $x=L$。设 $y(x)$ 为梁在位置 $x$ 处的横向挠度。根据欧拉-伯努利梁理论，内弯矩 $M(x)$ 与曲率 $\\kappa(x)$ 通过本构关系 $M(x) = E I \\kappa(x)$ 相关联，其中 $E$ 是杨氏模量，$I$ 是横截面的截面二次矩。对于小挠度，曲率近似为 $\\kappa(x) \\approx y''(x) \\equiv \\frac{d^2y}{dx^2}$。因此，内部弹性力矩为 $M_{elastic}(x) = E I y''(x)$。\n\n当梁发生 $y(x)$ 的挠曲时，轴向载荷 $P$ 对 $x$ 点产生一个力矩。梁段的受力体图显示，该力矩为 $M_{load}(x) = -P y(x)$。负号表示对于正挠度（$y>0$），该力矩倾向于使曲率朝负方向增加（下凹），从而促进进一步的挠曲。\n\n对于静力平衡，任何横截面上的力矩之和必须为零。正确的列式方法是，本构关系中出现的内力矩 $M(x)$ 正是由外部载荷产生的力矩。因此，我们将 $M(x) = E I y''(x)$ 与 $M(x) = -P y(x)$ 等同起来。\n$$\nE I y''(x) = -P y(x)\n$$\n整理各项，我们得到挠度 $y(x)$ 的控制常微分方程 (ODE)：\n$$\nE I y''(x) + P y(x) = 0\n$$\n这可以写成二阶线性齐次常微分方程的标准形式：\n$$\ny''(x) + k^2 y(x) = 0\n$$\n其中我们定义参数 $k^2 = \\frac{P}{EI}$，要发生屈曲，该参数必须为正（$P>0$, $E>0$, $I>0$）。\n\n边界条件为两端铰接，意味着在 $x=0$ 和 $x=L$ 处的端点横向位移被固定，但可以自由转动。这可转化为挠度 $y(x)$ 的以下数学条件：\n1. 在 $x=0$ 处无挠度：$y(0) = 0$。\n2. 在 $x=L$ 处无挠度：$y(L) = 0$。\n\n2) 临界屈曲载荷的求解。\n常微分方程 $y''(x) + k^2 y(x) = 0$ 的通解为：\n$$\ny(x) = C_1 \\sin(kx) + C_2 \\cos(kx)\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n应用第一个边界条件 $y(0) = 0$：\n$$\ny(0) = C_1 \\sin(0) + C_2 \\cos(0) = C_1 \\cdot 0 + C_2 \\cdot 1 = C_2 = 0\n$$\n这使解简化为 $y(x) = C_1 \\sin(kx)$。\n应用第二个边界条件 $y(L) = 0$：\n$$\ny(L) = C_1 \\sin(kL) = 0\n$$\n该方程允许两种可能性。第一种是 $C_1 = 0$，这导致对所有 $x$ 都有 $y(x) = 0$。这是平凡解，代表梁未屈曲的笔直构型。只有当第二种可能性成立时，才存在代表屈曲形状的非平凡解：\n$$\n\\sin(kL) = 0\n$$\n当正弦函数的参数是 $\\pi$ 的整数倍时，此条件得到满足：\n$$\nkL = n\\pi, \\quad \\text{for } n = 1, 2, 3, \\dots\n$$\n排除 $n=0$ 的情况，因为它会导致 $k=0$ 和平凡解。$n$ 取负整数不会产生新的载荷解，因为 $k$ 是平方项。\n将 $k = \\sqrt{P/EI}$ 的定义代回，我们找到允许屈曲状态的载荷 $P$ 的值：\n$$\n\\sqrt{\\frac{P_n}{EI}} L = n\\pi \\implies \\frac{P_n}{EI} = \\left(\\frac{n\\pi}{L}\\right)^2\n$$\n求解 $P_n$ 得到一组离散的临界屈曲载荷，它们是该问题的特征值：\n$$\nP_n = \\frac{n^2 \\pi^2 E I}{L^2}\n$$\n最小临界载荷 $P_c$（低于此载荷梁不会屈曲）对应于 $n$ 的最小非零整数值，即 $n=1$。这便是基本屈曲模态。\n$$\nP_c = \\frac{\\pi^2 E I}{L^2}\n$$\n\n3) 空心椭圆截面的截面二次矩。\n对于半轴为 $h$ 和 $w$ 的实心椭圆，其关于主轴（与 $x$ 和 $y$ 轴对齐，其中沿 $x$ 轴的半轴为 $h$，沿 $y$ 轴的半轴为 $w$）的截面二次矩分别为 $I_x = \\frac{\\pi}{4} h w^3$ 和 $I_y = \\frac{\\pi}{4} h^3 w$。\n问题指定了外半长轴 $a$ 和外半短轴 $b$，因此 $a > b$。设长轴与坐标 $x$ 轴对齐，短轴与 $y$ 轴对齐。外椭圆的截面二次矩为：\n$$\nI_{x,outer} = \\frac{\\pi}{4} a b^3\n$$\n$$\nI_{y,outer} = \\frac{\\pi}{4} a^3 b\n$$\n弱弯曲轴是截面二次矩最小的轴，因为这是抗弯能力最弱的轴。由于 $a > b > 0$，可推得 $a^2 > b^2$，因此 $a^3 b > a b^3$。所以 $I_{y,outer} > I_{x,outer}$。屈曲将通过绕长轴（$x$ 轴）的弯曲发生。相关的截面二次矩是最小值，即 $I = I_{x}$。\n\n问题通过面积差法定义了空心横截面，其内半轴为 $a_i = a - t$ 和 $b_i = b - t$。空心截面的截面二次矩等于外椭圆的截面二次矩减去内椭圆的截面二次矩。\n$$\nI_{weak} = I_{x,outer} - I_{x,inner} = \\frac{\\pi}{4} a b^3 - \\frac{\\pi}{4} a_i b_i^3\n$$\n代入内半轴的表达式，我们得到关于弱轴的 $I$ 的闭合形式结果：\n$$\nI = \\frac{\\pi}{4} \\left[ a b^3 - (a-t)(b-t)^3 \\right]\n$$\n\n4) 最小临界屈曲载荷的数值计算。\n我们现在将给定的数值代入 $I$ 和 $P_c$ 的表达式中。\n参数如下：\n$E = 4.5 \\times 10^9 \\, \\mathrm{Pa}$\n$L = 0.25 \\, \\mathrm{m}$\n$a = 2.0 \\times 10^{-3} \\, \\mathrm{m}$\n$b = 1.5 \\times 10^{-3} \\, \\mathrm{m}$\n$t = 0.25 \\times 10^{-3} \\, \\mathrm{m}$\n\n首先，计算截面二次矩 $I$：\n$$\na-t = (2.0 - 0.25) \\times 10^{-3} = 1.75 \\times 10^{-3} \\, \\mathrm{m}\n$$\n$$\nb-t = (1.5 - 0.25) \\times 10^{-3} = 1.25 \\times 10^{-3} \\, \\mathrm{m}\n$$\n$$\nI = \\frac{\\pi}{4} \\left[ (2.0 \\times 10^{-3})(1.5 \\times 10^{-3})^3 - (1.75 \\times 10^{-3})(1.25 \\times 10^{-3})^3 \\right]\n$$\n$$\nI = \\frac{\\pi}{4} \\left[ (2.0 \\times 10^{-3})(3.375 \\times 10^{-9}) - (1.75 \\times 10^{-3})(1.953125 \\times 10^{-9}) \\right] \\, \\mathrm{m^4}\n$$\n$$\nI = \\frac{\\pi}{4} \\left[ 6.75 \\times 10^{-12} - 3.41796875 \\times 10^{-12} \\right] \\, \\mathrm{m^4}\n$$\n$$\nI = \\frac{\\pi}{4} \\left[ 3.33203125 \\times 10^{-12} \\right] \\, \\mathrm{m}^4 \\approx 2.6169045 \\times 10^{-12} \\, \\mathrm{m}^4\n$$\n现在，计算最小临界屈曲载荷 $P_c$：\n$$\nP_c = \\frac{\\pi^2 E I}{L^2} = \\frac{\\pi^2 (4.5 \\times 10^9 \\, \\mathrm{Pa}) (2.6169045 \\times 10^{-12} \\, \\mathrm{m}^4)}{(0.25 \\, \\mathrm{m})^2}\n$$\n$$\nP_c = \\frac{\\pi^2 (4.5 \\times 10^9) (2.6169045 \\times 10^{-12})}{0.0625} \\, \\mathrm{N}\n$$\n$$\nP_c \\approx \\frac{(9.8696044)(4.5 \\times 10^9)(2.6169045 \\times 10^{-12})}{0.0625} \\, \\mathrm{N}\n$$\n$$\nP_c \\approx \\frac{0.1162234}{0.0625} \\, \\mathrm{N} \\approx 1.85957 \\, \\mathrm{N}\n$$\n根据要求将结果四舍五入到三位有效数字，我们得到 $P_c \\approx 1.86 \\, \\mathrm{N}$。", "answer": "$$\\boxed{1.86}$$", "id": "2572047"}, {"introduction": "皮肤附肢的多样形态最终源于一套古老且共享的发育工具包，包括基因和信号通路。理解这些通路如何被调控以产生不同结果，是演化发育生物学的核心目标。这项计算练习将指导您完成一项因果中介分析，量化外异蛋白A（EDA）信号通路如何通过Wnt通路影响基板的密度，为您提供一个亲手实践用统计方法剖析发育遗传网络的宝贵机会。[@problem_id:2572083]", "problem": "您将处理一个基于脊椎动物皮肤附属物进化与发育的因果问题。外异构蛋白A（EDA）是一种信号配体。根据比较发育生物学的研究，已知其通过激活外异构蛋白A受体（EDAR）来影响鳞片、羽毛、毛发和乳腺原基等不同类型的表皮基板的模式形成。在许多脊椎动物中，Wnt（Wingless-related integration site）信号通路的活性是基板起始的近端生化介导物。该通路活性可通过RNA测序（RNA-seq）得到的典型Wnt靶基因的log倍数变化来衡量。假设以下基本前提：(i) 分子生物学中心法则确保了基因表达水平能够反映通路活性；(ii) EDA到EDAR的信号轴通过Wnt通路活性调节基板形成；(iii) 在满足线性、可加性和误差独立的标准假设下，通过普通最小二乘法（OLS）估计的线性回归是一个无偏估计量。\n\n使用一个线性的、可加的、无交互作用的中介结构来对该系统建模：一个暴露变量 $X$（EDA激活幅度），一个中介变量 $M$（Wnt通路的总激活水平，量化为每个样本中典型Wnt靶基因RNA-seq log倍数变化的算术平均值），以及一个结果变量 $Y$（基板密度，单位为 基板数/$\\mathrm{mm}^{2}$）。使用以下结构方程\n$$\nM = \\alpha + a X + \\varepsilon_M, \\quad\nY = \\beta_0 + b M + c' X + \\varepsilon_Y,\n$$\n其中 $a$、$b$ 和 $c'$ 是未知的实系数，$\\varepsilon_M$ 和 $\\varepsilon_Y$ 是均值为零的噪声项。在此线性模型下，$X$ 通过 $M$ 对 $Y$ 的间接（中介）效应，是指由 $X$ 引起 $M$ 的变化，进而传递给 $Y$ 的那部分效应。\n\n您的任务是编写一个程序，对下方的每个测试用例执行以下步骤：\n- 对每个样本 $i$，计算中介变量值 $M_i$，即该样本中Wnt靶基因的RNA-seq log倍数变化的算术平均值。\n- 通过对 $M$ 和 $X$ 进行带截距项的OLS回归来估计 $a$。\n- 通过对 $Y$、$M$ 和 $X$ 进行带截距项的OLS回归来估计 $b$ 和 $c'$。\n- 根据这些拟合模型，计算在线性、可加、无交互作用的中介模型下，$X$ 通过 $M$ 对 $Y$ 的估计间接效应。将该效应表示为 $X$ 每增加一个单位时，基板密度（单位：基板数/$\\mathrm{mm}^{2}$）的变化量，结果四舍五入到六位小数，以十进制数表示（而非百分比）。\n\n请使用以下测试套件。在所有情况下，$X$ 是无单位的（相对EDA激活水平），$M$ 是无量纲的（log$_2$倍数变化），$Y$ 的单位是 基板数/$\\mathrm{mm}^{2}$。\n\n测试用例A（一般性、非退化情况）：\n- $X$ 值：$[0,1,2,3,4]$。\n- 对每个样本 $i$，三个典型Wnt靶基因的RNA-seq log$_2$倍数变化为：\n  - 样本 $0$：$[0.0,0.1,-0.1]$。\n  - 样本 $1$：$[0.5,0.7,0.6]$。\n  - 样本 $2$：$[1.0,1.2,1.1]$。\n  - 样本 $3$：$[1.6,1.7,1.5]$。\n  - 样本 $4$：$[2.1,1.9,2.0]$。\n- 基板密度 $Y$ (基板数/$\\mathrm{mm}^{2}$)：$[10.0,14.0,17.5,21.0,24.0]$。\n\n测试用例B（边界情况，无中介效应）：\n- $X$ 值：$[0,2,4,6]$。\n- 每个样本的三个Wnt靶基因的RNA-seq log$_2$倍数变化（无变化）：所有样本均为 $[0.0,0.0,0.0]$。\n- 基板密度 $Y$ (基板数/$\\mathrm{mm}^{2}$)：$[8.0,12.0,16.0,20.0]$。\n\n测试用例C（边缘情况，近乎完全中介且无直接效应）：\n- $X$ 值：$[0,1,2,3]$。\n- 每个样本的两个Wnt靶基因的RNA-seq log$_2$倍数变化：\n  - 样本 $0$：$[0.0,0.0]$。\n  - 样本 $1$：$[0.70,0.94]$。\n  - 样本 $2$：$[1.47,1.69]$。\n  - 样本 $3$：$[2.29,2.45]$。\n- 基板密度 $Y$ (基板数/$\\mathrm{mm}^{2}$)：$[12.0,15.2,18.4,21.6]$。\n\n约束与要求：\n- 所有回归必须包含截距项。\n- 将样本 $i$ 的聚合中介变量 $M_i$ 计算为所提供的Wnt靶基因log$_2$倍数变化的算术平均值。\n- 对每个测试用例，报告 $X$ 每增加一个单位时，估计的间接效应（单位：基板数/$\\mathrm{mm}^{2}$），结果四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含测试用例A、B、C的三个结果。结果按顺序排列，以逗号分隔，并用方括号括起，例如 $[r_A,r_B,r_C]$，其中每个 $r_\\cdot$ 是一个四舍五入到六位小数的十进制数，不打印单位。\n\n科学真实性说明：\n- 所选数值在生物学上是合理的，其前提假设是EDA调节Wnt通路活性，且Wnt活性影响基板密度，这与脊椎动物皮肤附属物发育中公认的观察结果一致。", "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于发育生物学的既定原则，并采用标准的、明确定义的统计方法。所提供的数据是完整且充分的，可以按要求为每个测试用例计算出唯一解。该问题是客观、定量且没有逻辑矛盾或含糊之处的。\n\n任务是为三种不同的生物学情景计算线性中介模型中的间接效应。模型结构由两个线性方程给出：\n$$M = \\alpha + a X + \\varepsilon_M$$\n$$Y = \\beta_0 + b M + c' X + \\varepsilon_Y$$\n这里，$X$ 是暴露变量（EDA激活），$M$ 是中介变量（Wnt通路激活），$Y$ 是结果变量（基板密度）。系数 $a$、$b$ 和 $c'$ 代表了因果路径的强度。$X$ 通过中介变量 $M$ 传递给 $Y$ 的间接效应通过路径系数 $a$ 和 $b$ 的乘积来量化，即 $IE = a \\cdot b$。\n\n这些系数使用普通最小二乘法（OLS）回归进行估计。\n1.  系数 $\\hat{a}$ 是 $M$ 对 $X$ 进行回归（带截距项 $\\alpha$）得到的斜率。\n2.  系数 $\\hat{b}$ 是 $Y$ 对 $M$ 和 $X$ 进行多元回归（带截距项 $\\beta_0$ 和直接效应系数 $c'$）时 $M$ 的斜率。\n\n系数向量 $\\boldsymbol{\\beta}$ 的OLS估计值由公式 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X_{design}}^T \\mathbf{X_{design}})^{-1} \\mathbf{X_{design}}^T \\mathbf{Y}$ 给出，其中 $\\mathbf{Y}$ 是因变量观测值向量，$\\mathbf{X_{design}}$ 是设计矩阵，其包含一个由1构成的首列以表示截距项。\n\n我们现在将此过程应用于每个测试用例。\n\n### 测试用例A\n提供的数据如下：\n- 暴露变量 $X = [0, 1, 2, 3, 4]^T$。\n- 基板密度 $Y = [10.0, 14.0, 17.5, 21.0, 24.0]^T$。\n- 5个样本的RNA-seq log$_2$倍数变化，每个样本有3个基因测量值。\n\n首先，我们通过计算每个样本log倍数变化的算术平均值来计算中介变量向量 $M$：\n$M_0 = \\frac{0.0 + 0.1 - 0.1}{3} = 0.0$\n$M_1 = \\frac{0.5 + 0.7 + 0.6}{3} = 0.6$\n$M_2 = \\frac{1.0 + 1.2 + 1.1}{3} = 1.1$\n$M_3 = \\frac{1.6 + 1.7 + 1.5}{3} = 1.6$\n$M_4 = \\frac{2.1 + 1.9 + 2.0}{3} = 2.0$\n这得到中介变量向量 $M = [0.0, 0.6, 1.1, 1.6, 2.0]^T$。\n\n为了估计 $a$，我们对 $M$ 和 $X$ 进行回归。设计矩阵为 $\\mathbf{X_1} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\\\ 1  3 \\\\ 1  4 \\end{pmatrix}$。应用OLS得到的估计系数为 $\\hat{a} = 0.5$。\n\n为了估计 $b$，我们对 $Y$、$M$ 和 $X$ 进行回归。设计矩阵为 $\\mathbf{X_2} = \\begin{pmatrix} 1  0.0  0 \\\\ 1  0.6  1 \\\\ 1  1.1  2 \\\\ 1  1.6  3 \\\\ 1  2.0  4 \\end{pmatrix}$。应用OLS得到的 $M$ 的估计系数为 $\\hat{b} = \\frac{10}{3} \\approx 3.333333$。\n\n用例A的间接效应是这些估计值的乘积：\n$IE_A = \\hat{a} \\cdot \\hat{b} = 0.5 \\cdot \\frac{10}{3} = \\frac{5}{3} \\approx 1.666666...$\n四舍五入到六位小数，结果是 $1.666667$。\n\n### 测试用例B\n提供的数据如下：\n- 暴露变量 $X = [0, 2, 4, 6]^T$。\n- 基板密度 $Y = [8.0, 12.0, 16.0, 20.0]^T$。\n- 所有样本的RNA-seq log$_2$倍数变化均为 $[0.0, 0.0, 0.0]$。\n\n首先，我们计算中介变量向量 $M$。由于所有输入测量值均为0，每个样本的均值也为0。\n因此，中介变量向量为 $M = [0, 0, 0, 0]^T$。\n\n为了估计 $a$，我们对 $M$ 和 $X$ 进行回归。由于 $M$ 是一个由零组成的常数向量，其与 $X$ 的协方差为0。因此，回归斜率恰好为零，即 $\\hat{a} = 0$。\n\n间接效应为 $IE_B = \\hat{a} \\cdot \\hat{b} = 0 \\cdot \\hat{b}$。无论 $\\hat{b}$ 的值是多少，乘积都为0。这是合乎逻辑的：如果暴露变量不影响中介变量，就不可能存在通过中介变量传递的效应。\n为了完整起见，在 $Y$ 对 $M$ 和 $X$ 的第二次回归中，中介变量 $M$ 是一个零向量，它与截距项完全共线性（因为 $M = 0 \\times \\text{截距向量}$）。标准的OLS求解器要么会丢弃这个变量，要么会将其系数赋值为0以确保唯一解。无论哪种情况，间接效应的计算结果都为0。\n\n用例B的间接效应为0。\n四舍五入到六位小数，结果是 $0.000000$。\n\n### 测试用例C\n提供的数据如下：\n- 暴露变量 $X = [0, 1, 2, 3]^T$。\n- 基板密度 $Y = [12.0, 15.2, 18.4, 21.6]^T$。\n- 4个样本的RNA-seq log$_2$倍数变化，每个样本有2个基因测量值。\n\n首先，我们计算中介变量向量 $M$：\n$M_0 = \\frac{0.0 + 0.0}{2} = 0.0$\n$M_1 = \\frac{0.70 + 0.94}{2} = 0.82$\n$M_2 = \\frac{1.47 + 1.69}{2} = 1.58$\n$M_3 = \\frac{2.29 + 2.45}{2} = 2.37$\n这得到中介变量向量 $M = [0.0, 0.82, 1.58, 2.37]^T$。\n\n为了估计 $a$，我们对 $M$ 和 $X$ 进行回归。设计矩阵为 $\\mathbf{X_1} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\\\ 1  3 \\end{pmatrix}$。应用OLS得到的估计系数为 $\\hat{a} = 0.787$。\n\n为了估计 $b$，我们对 $Y$、$M$ 和 $X$ 进行回归。设计矩阵为 $\\mathbf{X_2} = \\begin{pmatrix} 1  0.00  0 \\\\ 1  0.82  1 \\\\ 1  1.58  2 \\\\ 1  2.37  3 \\end{pmatrix}$。应用OLS得到的 $M$ 的估计系数为 $\\hat{b} = 4.0$。直接效应 $c'$ 的系数约为 $-0.002$，这与问题描述中“近乎完全中介且无直接效应”的说法一致。\n\n用例C的间接效应是这些估计值的乘积：\n$IE_C = \\hat{a} \\cdot \\hat{b} = 0.787 \\cdot 4.0 = 3.148$。\n四舍五入到六位小数，结果是 $3.148000$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the indirect effect in a linear mediation model for three test cases.\n    The indirect effect is the product of two coefficients, a and b, estimated\n    via Ordinary Least Squares (OLS) regression.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A\n        {\n            \"X\": np.array([0, 1, 2, 3, 4]),\n            \"rna_seq_log_fc\": [\n                [0.0, 0.1, -0.1],\n                [0.5, 0.7, 0.6],\n                [1.0, 1.2, 1.1],\n                [1.6, 1.7, 1.5],\n                [2.1, 1.9, 2.0],\n            ],\n            \"Y\": np.array([10.0, 14.0, 17.5, 21.0, 24.0]),\n        },\n        # Test Case B\n        {\n            \"X\": np.array([0, 2, 4, 6]),\n            \"rna_seq_log_fc\": [\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0],\n            ],\n            \"Y\": np.array([8.0, 12.0, 16.0, 20.0]),\n        },\n        # Test Case C\n        {\n            \"X\": np.array([0, 1, 2, 3]),\n            \"rna_seq_log_fc\": [\n                [0.0, 0.0],\n                [0.70, 0.94],\n                [1.47, 1.69],\n                [2.29, 2.45],\n            ],\n            \"Y\": np.array([12.0, 15.2, 18.4, 21.6]),\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        X = case[\"X\"]\n        Y = case[\"Y\"]\n        rna_data = case[\"rna_seq_log_fc\"]\n\n        # Step 1: Compute the mediator M as the arithmetic mean of RNA-seq data.\n        M = np.array([np.mean(sample) for sample in rna_data])\n\n        # Step 2: Estimate 'a' by OLS regression of M on X with an intercept.\n        # Design matrix for M ~ a*X + alpha\n        X1_design = np.vstack([np.ones(len(X)), X]).T\n        # numpy.linalg.lstsq returns a tuple; the coefficients are the first element.\n        # The coefficients are [intercept, slope]. We need the slope 'a'.\n        a_hat = np.linalg.lstsq(X1_design, M, rcond=None)[0][1]\n\n        # Step 3: Estimate 'b' and 'c'' by OLS regression of Y on M and X.\n        # Design matrix for Y ~ b*M + c'*X + beta_0\n        X2_design = np.vstack([np.ones(len(X)), M, X]).T\n        # The coefficients are [intercept, slope_M, slope_X]. We need slope_M 'b'.\n        b_hat = np.linalg.lstsq(X2_design, Y, rcond=None)[0][1]\n        \n        # Step 4: Compute the estimated indirect effect (a*b).\n        indirect_effect = a_hat * b_hat\n        \n        results.append(indirect_effect)\n\n    # Format the final output as specified.\n    # Each result is a decimal number rounded to six decimal places.\n    formatted_results = [f'{r:.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2572083"}]}