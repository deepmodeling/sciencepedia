{"hands_on_practices": [{"introduction": "形态整合的研究始于量化性状间的协同变异。本练习将从一个给定的协方差矩阵入手，指导你计算相关矩阵并评估基本的整合指数，这是理解更复杂形态计量学分析的基础。通过这个实践，你将掌握如何从原始变异数据中提取标准化的整合强度信息[@problem_id:2591594]。", "problem": "一项关于某谱系的形态整合的比较研究，考察了在 $n=30$ 个个体中测量的 $3$ 个线性性状间的协变。这些性状的样本协方差矩阵为\n$$\nS=\\begin{pmatrix}\n2  1  0 \\\\\n1  1  0.5 \\\\\n0  0.5  0.5\n\\end{pmatrix}.\n$$\n仅使用基本定义，完成以下任务：\n1) 计算由 $S$ 推导出的性状相关矩阵 $R$。\n2) 将两个性状间的两两形态整合定义为其相关系数的绝对值。基于此，计算总体整合指数\n$$\nI=\\frac{|r_{12}|+|r_{13}|+|r_{23}|}{3},\n$$\n其中 $r_{ij}$ 是性状 $i$ 和性状 $j$ 之间的相关系数。\n3) 根据 $R$，简要解释哪些性状对表现出更强的形态整合。\n\n仅报告 $I$ 的值作为最终数值答案，以无单位的纯数表示，并将其四舍五入至四位有效数字。", "solution": "问题陈述前后一致且数学上是适定的。所提供的样本协方差矩阵 $S$ 是对称且半正定的，这是此类矩阵的一个必要且有效的条件。个体数量 $n=30$ 是背景信息，所要求的具体计算并不需要用到。我们通过完成三个指定的任务来求解该问题。\n\n首先，我们根据给定的协方差矩阵 $S$ 计算性状相关矩阵 $R$。性状 $i$ 和性状 $j$ 之间的相关系数 $r_{ij}$ 由以下关系式定义：\n$$\nr_{ij} = \\frac{s_{ij}}{\\sqrt{s_{ii}s_{jj}}}\n$$\n其中 $s_{ij}$ 是性状 $i$ 和 $j$ 之间的协方差，$s_{ii}$ 和 $s_{jj}$ 分别是性状 $i$ 和 $j$ 的方差。方差是协方差矩阵 $S$ 的对角元素。\n\n从给定的矩阵\n$$\nS=\\begin{pmatrix}\n2  1  0 \\\\\n1  1  0.5 \\\\\n0  0.5  0.5\n\\end{pmatrix}\n$$\n可知，方差为 $s_{11} = 2$，$s_{22} = 1$ 和 $s_{33} = 0.5$。对应的标准差为 $\\sigma_1 = \\sqrt{s_{11}} = \\sqrt{2}$，$\\sigma_2 = \\sqrt{s_{22}} = \\sqrt{1} = 1$ 和 $\\sigma_3 = \\sqrt{s_{33}} = \\sqrt{0.5} = \\frac{1}{\\sqrt{2}}$。\n\n现在我们计算相关矩阵 $R$ 的非对角元素：\n对于性状 $1$ 和 $2$：\n$$\nr_{12} = \\frac{s_{12}}{\\sqrt{s_{11}s_{22}}} = \\frac{1}{\\sqrt{2 \\cdot 1}} = \\frac{1}{\\sqrt{2}}\n$$\n对于性状 $1$ 和 $3$：\n$$\nr_{13} = \\frac{s_{13}}{\\sqrt{s_{11}s_{33}}} = \\frac{0}{\\sqrt{2 \\cdot 0.5}} = \\frac{0}{\\sqrt{1}} = 0\n$$\n对于性状 $2$ 和 $3$：\n$$\nr_{23} = \\frac{s_{23}}{\\sqrt{s_{22}s_{33}}} = \\frac{0.5}{\\sqrt{1 \\cdot 0.5}} = \\frac{0.5}{\\sqrt{0.5}} = \\sqrt{0.5} = \\frac{1}{\\sqrt{2}}\n$$\n根据定义，任何相关矩阵的对角元素都等于 $1$。因此，完整的相关矩阵 $R$ 为：\n$$\nR = \\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  0 \\\\\n\\frac{1}{\\sqrt{2}}  1  \\frac{1}{\\sqrt{2}} \\\\\n0  \\frac{1}{\\sqrt{2}}  1\n\\end{pmatrix}\n$$\n\n第二，我们计算总体整合指数 $I$。题目将此指数定义为两两形态整合的算术平均值，其中每个两两整合值是对应相关系数的绝对值。\n$$\nI=\\frac{|r_{12}|+|r_{13}|+|r_{23}|}{3}\n$$\n代入计算所得的值：\n$$\nI = \\frac{\\left|\\frac{1}{\\sqrt{2}}\\right| + |0| + \\left|\\frac{1}{\\sqrt{2}}\\right|}{3} = \\frac{\\frac{1}{\\sqrt{2}} + 0 + \\frac{1}{\\sqrt{2}}}{3} = \\frac{\\frac{2}{\\sqrt{2}}}{3} = \\frac{\\sqrt{2}}{3}\n$$\n题目要求数值答案保留四位有效数字。\n$$\nI = \\frac{\\sqrt{2}}{3} \\approx \\frac{1.41421356}{3} \\approx 0.4714045...\n$$\n四舍五入到四位有效数字，我们得到 $I \\approx 0.4714$。\n\n第三，我们解释哪些性状对表现出更强的形态整合。一对性状之间的整合强度由其相关系数的绝对值给出。\n两两整合值分别为：\n$|r_{12}| = \\frac{1}{\\sqrt{2}} \\approx 0.7071$\n$|r_{13}| = 0$\n$|r_{23}| = \\frac{1}{\\sqrt{2}} \\approx 0.7071$\n根据这些值，性状对 $(1, 2)$ 和 $(2, 3)$ 表现出同等强度的形态整合。性状对 $(1, 3)$ 表现出零整合，意味着这两个性状不相关。这种结构表明，性状 $2$ 可能在性状 $1$ 和性状 $3$ 之间充当了发育或功能上的中介角色。", "answer": "$$\\boxed{0.4714}$$", "id": "2591594"}, {"introduction": "当我们将研究从单个的性状对扩展到功能或发育模块时，我们需要更强大的工具来量化模块间的整合程度。本练习介绍了一个广泛使用的度量——Escoufier RV系数，它能够衡量两组性状之间的整体协变关系。通过计算RV系数值，你将学会如何评估支持模块化（低整合）与整合（高协变）的证据强度[@problem_id:2591710]。", "problem": "在比较动物学和植物学中，形态整合指的是解剖或功能模块内部及模块之间性状的协同协变，而形态差异则指形态空间中性状值的离散程度。量化两个预定义性状模块之间协变程度的一种常用策略是，使用一种基于块的度量方法，该方法通过模块内的协方差来标准化模块间的互协方差，从而得出一个介于0和1之间的无量纲系数，该系数可在不同数据集之间直接比较。考虑两个性状模块，模块 $X$ 包含 $p=q=2$ 个线性无关的形状变量，模块 $Y$ 包含 $2$ 个线性无关的形状变量。这些变量在一组物种中进行测量，并经过适当缩放，使得经验块协方差矩阵具有以下形式\n$$\nS \\;=\\; \\begin{pmatrix}\nS_{XX}  S_{XY}\\\\\nS_{YX}  S_{YY}\n\\end{pmatrix}, \\quad S_{YX}=S_{XY}^{\\top},\n$$\n其中\n$$\nS_{XX}=\\begin{pmatrix}2  0.5\\\\ 0.5  1\\end{pmatrix}, \\quad\nS_{YY}=\\begin{pmatrix}1  0.2\\\\ 0.2  0.5\\end{pmatrix}, \\quad\nS_{XY}=\\begin{pmatrix}0.1  0\\\\ 0  0.05\\end{pmatrix}.\n$$\n仅使用协方差矩阵的基本性质和广泛使用的 Escoufier RV 系数（一种通过给定协方差块乘积的迹构建的块协变标准化度量）的定义，计算量化模块 $X$ 和 $Y$ 之间整合程度的 RV 系数的点估计。然后，仅根据该系数的大小（不进行任何假设检验），说明它更符合弱整合还是强整合，并从模块化与整合的角度解释其原因。\n\n最终答案只报告 RV 系数的数值，表示为无量纲小数，并四舍五入到四位有效数字。任何定性评估只应出现在计算过程中，而不应出现在最终报告的值中。", "solution": "目标是根据所提供的块协方差矩阵计算 Escoufier RV 系数。其基本依据包括协方差矩阵和矩阵范数及迹的标准性质：\n\n1. 对于任意矩阵 $A$，其弗罗贝尼乌斯范数的平方满足 $||A||_{F}^{2}=\\operatorname{tr}(A A^{\\top})$。\n2. 对于任意对称矩阵 $M$（例如协方差矩阵），$M^{\\top}=M$，因此 $\\operatorname{tr}(M^{2})=\\operatorname{tr}(M^{\\top}M)=||M||_{F}^{2}$。\n3. 模块 $X$ 和 $Y$ 之间的 Escoufier RV 系数是一种标准化的互协方差度量，定义为\n$$\n\\mathrm{RV} \\;=\\; \\frac{\\operatorname{tr}\\!\\left(S_{XY}S_{YX}\\right)}{\\sqrt{\\operatorname{tr}\\!\\left(S_{XX}^{2}\\right)\\,\\operatorname{tr}\\!\\left(S_{YY}^{2}\\right)}}\n\\;=\\; \\frac{||S_{XY}||_{F}^{2}}{\\sqrt{||S_{XX}||_{F}^{2}\\,||S_{YY}||_{F}^{2}}}.\n$$\n该定义确保了 $\\mathrm{RV}$ 是无量纲的，且界于 0 和 1 之间。接近 0 的值表示模块间的协变较弱（与模块化一致），而接近 1 的值表示模块间的协变较强（整合）。\n\n我们现在来计算每个组成部分。\n\n分子：\n$$\n\\operatorname{tr}\\!\\left(S_{XY}S_{YX}\\right)\n= \\operatorname{tr}\\!\\left(S_{XY}S_{XY}^{\\top}\\right)\n= ||S_{XY}||_{F}^{2}\n= \\sum_{i,j} \\left(S_{XY}\\right)_{ij}^{2}.\n$$\n已知\n$$\nS_{XY}=\\begin{pmatrix}0.1  0\\\\ 0  0.05\\end{pmatrix},\n$$\n我们有\n$$\n||S_{XY}||_{F}^{2} = (0.1)^{2} + 0^{2} + 0^{2} + (0.05)^{2} = 0.01 + 0 + 0 + 0.0025 = 0.0125.\n$$\n\n分母：\n因为 $S_{XX}$ 和 $S_{YY}$ 是对称的，所以 $\\operatorname{tr}(S_{XX}^{2})=||S_{XX}||_{F}^{2}$ 且 $\\operatorname{tr}(S_{YY}^{2})=||S_{YY}||_{F}^{2}$，即各元素平方的和。\n\n对于 $S_{XX}=\\begin{pmatrix}2  0.5\\\\ 0.5  1\\end{pmatrix}$，\n$$\n\\operatorname{tr}(S_{XX}^{2}) = 2^{2} + (0.5)^{2} + (0.5)^{2} + 1^{2} = 4 + 0.25 + 0.25 + 1 = 5.5.\n$$\n\n对于 $S_{YY}=\\begin{pmatrix}1  0.2\\\\ 0.2  0.5\\end{pmatrix}$，\n$$\n\\operatorname{tr}(S_{YY}^{2}) = 1^{2} + (0.2)^{2} + (0.2)^{2} + (0.5)^{2} = 1 + 0.04 + 0.04 + 0.25 = 1.33.\n$$\n\n因此分母为\n$$\n\\sqrt{\\operatorname{tr}(S_{XX}^{2})\\,\\operatorname{tr}(S_{YY}^{2})} \\;=\\; \\sqrt{5.5 \\times 1.33} \\;=\\; \\sqrt{7.315}.\n$$\n精确计算得出\n$$\n\\sqrt{7.315} \\approx 2.704626.\n$$\n\n因此，\n$$\n\\mathrm{RV} \\;=\\; \\frac{0.0125}{\\sqrt{7.315}} \\;\\approx\\; \\frac{0.0125}{2.704626} \\;\\approx\\; 0.0046217\\ldots\n$$\n四舍五入到四位有效数字（无量纲小数），\n$$\n\\mathrm{RV} \\approx 0.004622.\n$$\n\n关于模块化与整合的解释：接近于零的 Escoufier RV 系数表明，相对于模块内协变，模块间的协变非常弱。所得数值非常小，作为一个点估计，这与模块 $X$ 和 $Y$ 之间的弱整合相一致，符合模块化的组织结构。对支持程度的正式评估通常需要一个假设检验框架（例如，置换检验）来评估观察到的 RV 值是否显著低于随机关联下的预期值；然而，仅从数值大小来看，它与强模块化（弱整合）最为一致。", "answer": "$$\\boxed{0.004622}$$", "id": "2591710"}, {"introduction": "计算出一个整合或模块化的指标值只是第一步；更关键的是要确定这个结果在统计上是否显著。本练习将引导你使用置换检验（permutation test）这一强大的非参数方法，来评估观察到的模块化模式是否比随机预期的更强。你将通过计算p值和效应大小，学会如何从描述性统计走向严谨的统计推断[@problem_id:2591618]。", "problem": "一项关于某草本植物分支形态整合的比较研究，评估了两个性状集（一个叶片模块和一个茎模块）之间的模块性。模块化假说认为，模块间的协变要弱于模块内的协变。为评估此假说，该研究使用了协方差比率（CR）统计量，其值越低，表示对模块化组织的支持越强。观测到的协方差比率为 $\\mathrm{CR}_{\\mathrm{obs}} = 0.892$。为了构建一个与无模块化结构假设一致的零分布，研究人员对 $p$ 个性状的模块标签进行了均匀随机置换，同时保持了两个模块的大小不变，并对每次置换重新计算了协方差比率。总共进行了 $N = 10000$ 次置换。在此零分布下，经验均值为 $\\mu_{0} = 1.010$，经验标准差为 $\\sigma_{0} = 0.045$。在这些置换中，有 $k = 44$ 次置换得到的结果满足 $\\mathrm{CR}_{\\mathrm{perm}} \\le \\mathrm{CR}_{\\mathrm{obs}}$。假设一个用于检验模块性的单侧检验，其备择假设 $H_{A}$ 为：$\\mathrm{CR}_{\\mathrm{obs}}$ 小于零假设下的期望值。使用标准的置换p值估计量，该估计量通过“加一”调整来避免p值为零。同时，计算标准化效应大小，公式为 $z = \\left(\\mathrm{CR}_{\\mathrm{obs}} - \\mu_{0}\\right)/\\sigma_{0}$。将您的p值四舍五入到四位有效数字。将最终的方框答案表示为仅p值（无单位）。在您的解题过程中提供对统计显著性和效应大小的文字解释，但不要在最终的方框答案中包含任何解释。", "solution": "所述问题在科学上是合理的，在计算上是明确定义的。它展示了非参数置换检验的一个标准应用，这是形态计量学和进化生物学等领域统计分析的基石。所有必要的数据均已提供，不存在内部矛盾或违反基本原则的情况。我们可以着手求解。\n\n该问题要求计算置换p值和标准化效应大小，以检验形态模块化的假说。背景是一项比较研究，其中模块化假说认为，一个模块内部性状之间的协变要强于来自不同模块的性状之间的协变。协方差比率（$\\mathrm{CR}$）统计量对此进行量化，其值越低，表示模块化程度越高。\n\n零假设 $H_{0}$ 是不存在模块化结构。在 $H_{0}$ 成立的条件下，观测到的性状分组到模块的排列被视为随机的，并且观测统计量 $\\mathrm{CR}_{\\mathrm{obs}}$ 与通过随机置换生成的 $\\mathrm{CR}$ 值分布相比，不应有显著差异。备择假设 $H_{A}$ 是存在模块化结构，这对应于一个单侧检验，其中我们预期 $\\mathrm{CR}_{\\mathrm{obs}}$ 会显著小于来自零分布的值。\n\n通过对性状标签进行 $N = 10000$ 次置换，经验性地构建了零分布，并为每次置换计算了一个 $\\mathrm{CR}_{\\mathrm{perm}}$ 值。这个零分布的经验均值和标准差分别为 $\\mu_{0} = 1.010$ 和 $\\sigma_{0} = 0.045$。观测值为 $\\mathrm{CR}_{\\mathrm{obs}} = 0.892$。\n\n首先，我们计算置换p值。该值表示在零假设为真的前提下，观测到与观测值一样极端或更极端的检验统计量的概率。对于这个单侧检验，“更极端”意味着小于或等于 $\\mathrm{CR}_{\\mathrm{obs}}$。问题陈述，有 $k = 44$ 次置换得到的值满足 $\\mathrm{CR}_{\\mathrm{perm}} \\le \\mathrm{CR}_{\\mathrm{obs}}$。\n\n问题指定在计算p值时使用“加一”调整。这种方法将观测数据本身视为可能的随机结果之一，它纠正了p值可能被低估的问题，并避免了得到零p值的情况。其公式为：\n$$p = \\frac{k + 1}{N + 1}$$\n代入给定值：\n$$p = \\frac{44 + 1}{10000 + 1} = \\frac{45}{10001}$$\n进行除法运算：\n$$p \\approx 0.00449955...$$\n问题要求将此值四舍五入到四位有效数字。第一位有效数字是4，后面跟着4、9和9。接下来的数字是5，因此我们将最后一位有效数字向上取整。\n$$p \\approx 0.004500$$\n$0.004500$ 的p值远低于常规的显著性阈值（例如 $\\alpha = 0.05$ 或 $\\alpha = 0.01$），表明结果具有统计显著性。因此，我们应该拒绝无模块化的零假设，并得出结论：数据为植物性状中存在模块化结构提供了强有力的支持。\n\n接下来，我们计算标准化效应大小 $z$，它以标准差为单位，衡量观测统计量偏离零分布均值的程度。提供的公式为：\n$$z = \\frac{\\mathrm{CR}_{\\mathrm{obs}} - \\mu_{0}}{\\sigma_{0}}$$\n代入给定值：\n$$z = \\frac{0.892 - 1.010}{0.045} = \\frac{-0.118}{0.045}$$\n$$z \\approx -2.6222...$$\n约 $-2.62$ 的z分数表明，观测到的协方差比率比无模块化零假设下预期的分布均值低了 $2.62$ 个标准差。这是一个显著的偏差，量化了反对零假设的证据强度，证实了从小p值得出的结论。效应大小可被认为是中等到大，这表明观测到的模块化模式不仅在统计上是显著的，而且在其量级上也是具有生物学意义的。\n\n最终要求的答案是四舍五入到四位有效数字的p值。", "answer": "$$\\boxed{0.004500}$$", "id": "2591618"}]}