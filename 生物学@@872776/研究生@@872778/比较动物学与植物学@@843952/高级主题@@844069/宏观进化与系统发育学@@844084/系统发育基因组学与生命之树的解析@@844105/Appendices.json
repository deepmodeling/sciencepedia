{"hands_on_practices": [{"introduction": "基因树与物种树之间的冲突是系统基因组学中的一个核心现象，其主要原因是不完全谱系分选（Incomplete Lineage Sorting, ILS）。本练习将引导你通过第一性原理，深入理解ILS的根本机制。你将学习如何将群体遗传学参数，如有效种群大小（$N_e$）和分化时间（$\\tau$），与可观测的系统发育模式联系起来，从而定量计算预期的基因树冲突概率。这项实践是理解和解释复杂进化历史的基础。[@problem_id:2598316]", "problem": "一个有根三物种分支的物种树拓扑为 $\\left((A,B),C\\right)$，物种形成时间（以代为单位）为 $\\tau_{1}$ 和 $\\tau_{2}$，其中物种 $A$ 和 $B$ 在 $\\tau_{1} = 1.2 \\times 10^{6}$ 代前分化，而它们的共同祖先与物种 $C$ 在 $\\tau_{2} = 2.3 \\times 10^{6}$ 代前分化。在这两个物种形成事件之间的内部节点上（从 $\\tau_{1}$ 回溯到 $\\tau_{2}$），祖先群体的有效群体大小（定义为 Wright–Fisher 方差有效大小）是分段恒定的：从 $\\tau_{1}$ 到 $\\tau_{1} + 4.0 \\times 10^{5}$ 代，其值为 $N_{e} = 1.0 \\times 10^{5}$；从 $\\tau_{1} + 4.0 \\times 10^{5}$ 代回溯到 $\\tau_{2}$，其值为 $N_{e} = 2.5 \\times 10^{5}$。\n\n假设以标准多物种溯祖（MSC）模型为基本依据，该模型包含以下要素：在一个有效大小为 $N_{e}$ 的单一随机交配群体中，一对谱系的溯祖等待时间服从速率为 $1/\\left(2N_{e}\\right)$ 每代的指数分布；不同群体中的谱系不能发生溯祖合并；在群体合并时（时间上回溯的物种形成事件），谱系进入祖先群体；当三个谱系存在于一个单一随机交配群体中时，任何一对谱系率先发生溯祖合并的可能性均等。\n\n每个物种在每个基因座上采样一个单倍体序列；基因座之间不连锁；没有分化后的基因流；基因座内没有重组。\n\n任务：仅使用上述基本依据，首先通过计算累积溯祖长度，将从 $\\tau_{1}$ 到 $\\tau_{2}$ 的内部支转换为溯祖单位\n$$\nt_{c} \\;=\\; \\int_{\\tau_{1}}^{\\tau_{2}} \\frac{1}{2\\,N_{e}(t)}\\,dt,\n$$\n其中 $N_{e}(t)$ 是分段恒定的。然后，从第一性原理推导出其基因树与物种树拓扑不一致（即两种替代有根拓扑的概率之和）的不连锁基因座的预期总比例，并对其进行数值计算。\n\n将最终答案表示为一个无单位小数，并四舍五入到四位有效数字。", "solution": "首先根据所需标准对问题进行验证。\n\n逐字提取给定条件：\n- 物种树拓扑：$\\left(\\left(A,B\\right),C\\right)$\n- 物种 $A$ 和 $B$ 的物种形成时间：$\\tau_{1} = 1.2 \\times 10^{6}$ 代前。\n- $\\left(A,B\\right)$ 的祖先与物种 $C$ 的物种形成时间：$\\tau_{2} = 2.3 \\times 10^{6}$ 代前。\n- 从 $t=\\tau_{1}$到 $t=\\tau_{2}$ 的内部节点上的有效群体大小 $N_{e}(t)$：\n  - $N_{e} = 1.0 \\times 10^{5}$ 对于 $\\tau_{1} \\le t  \\tau_{1} + 4.0 \\times 10^{5}$ 代。\n  - $N_{e} = 2.5 \\times 10^{5}$ 对于 $\\tau_{1} + 4.0 \\times 10^{5} \\le t \\le \\tau_{2}$ 代。\n- 多物种溯祖（MSC）模型假设：\n  - 一对谱系的溯祖等待时间服从速率为 $1/\\left(2N_{e}\\right)$ 每代的指数分布。\n  - 不同群体中的谱系不能发生溯祖合并。\n  - 在物种形成时，谱系进入祖先群体。\n  - 对于一个群体中的三个谱系，任何一对谱系率先发生溯祖合并的可能性均等。\n- 采样和基因座条件：每个物种每个基因座一个单倍体序列；不连锁的基因座；无分化后基因流；无基因座内重组。\n- 溯祖长度的任务公式：$t_{c} = \\int_{\\tau_{1}}^{\\tau_{2}} \\frac{1}{2\\,N_{e}(t)}\\,dt$。\n- 任务目标：从第一性原理推导不一致基因树的预期总比例，并进行数值计算。\n\n该问题被判定为有效。它在科学上基于标准多物种溯祖模型，这是现代系统发育基因组学的基石。问题是良定的，为求得唯一解提供了所有必要的参数和定义。其语言客观而精确。该问题未违反任何指定的无效标准。因此，将推导求解。\n\n解题过程按要求分两个阶段进行。首先，计算内部支的溯祖长度 $t_{c}$。其次，推导并计算基因树不一致的概率。\n\n阶段1：计算溯祖长度 $t_{c}$。\n\n物种树的内部支存在于从过去 $\\tau_{1}$ 到 $\\tau_{2}$ 的时间区间内。该分支以溯祖单位计的长度 $t_{c}$ 是溯祖速率 $1/\\left(2N_{e}(t)\\right)$ 在此时间区间上的积分。有效群体大小 $N_{e}(t)$ 是分段恒定的。我们将 $N_{e}$ 发生变化的时间点定义为 $\\tau' = \\tau_{1} + 4.0 \\times 10^{5}$ 代。\n$t_{c}$ 的积分必须根据 $N_{e}$ 的两个恒定值分成两部分。\n\n设 $N_{e,1} = 1.0 \\times 10^{5}$ 是区间 $[\\tau_{1}, \\tau')$ 内的有效大小，而 $N_{e,2} = 2.5 \\times 10^{5}$ 是区间 $[\\tau', \\tau_{2}]$ 内的有效大小。\n\n积分为：\n$$\nt_{c} = \\int_{\\tau_{1}}^{\\tau_{2}} \\frac{1}{2 N_{e}(t)} dt = \\int_{\\tau_{1}}^{\\tau'} \\frac{1}{2 N_{e,1}} dt + \\int_{\\tau'}^{\\tau_{2}} \\frac{1}{2 N_{e,2}} dt\n$$\n由于 $N_{e,1}$ 和 $N_{e,2}$ 在各自的区间内是常数，积分计算是直接的：\n$$\nt_{c} = \\frac{\\tau' - \\tau_{1}}{2 N_{e,1}} + \\frac{\\tau_{2} - \\tau'}{2 N_{e,2}}\n$$\n我们代入给定值。\n$\\tau_{1} = 1.2 \\times 10^{6}$\n$\\tau_{2} = 2.3 \\times 10^{6}$\n$\\tau' = \\tau_{1} + 4.0 \\times 10^{5} = 1.2 \\times 10^{6} + 0.4 \\times 10^{6} = 1.6 \\times 10^{6}$\n\n两个区段的持续时间为：\n- 第一区段持续时间：$\\tau' - \\tau_{1} = (1.6 \\times 10^{6}) - (1.2 \\times 10^{6}) = 4.0 \\times 10^{5}$ 代。\n- 第二区段持续时间：$\\tau_{2} - \\tau' = (2.3 \\times 10^{6}) - (1.6 \\times 10^{6}) = 7.0 \\times 10^{5}$ 代。\n\n现在我们计算每个区段对 $t_{c}$ 的贡献：\n$$\nt_{c} = \\frac{4.0 \\times 10^{5}}{2 \\times (1.0 \\times 10^{5})} + \\frac{7.0 \\times 10^{5}}{2 \\times (2.5 \\times 10^{5})} = \\frac{4.0 \\times 10^{5}}{2.0 \\times 10^{5}} + \\frac{7.0 \\times 10^{5}}{5.0 \\times 10^{5}}\n$$\n$$\nt_{c} = 2.0 + 1.4 = 3.4\n$$\n内部支以溯祖单位计的长度为 $3.4$。\n\n阶段2：推导不一致基因树的概率。\n\n我们考虑从物种 $A$、$B$ 和 $C$ 各采样一个的三个谱系的历史，并将其在时间上回溯。\n- 从现在（$t=0$）到时间 $\\tau_{1}$，来自 $A$ 和 $B$ 的谱系处于分离的祖先群体中。它们彼此之间不能发生溯祖合并，也不能与来自 $C$ 的谱系发生溯祖合并。\n- 在时间 $\\tau_{1}$， $A$ 和 $B$ 的祖先群体合并。在从 $\\tau_{1}$ 到 $\\tau_{2}$ 的时间区间内，来自 $A$ 和 $B$ 的谱系处于一个共同的祖先群体中。来自 $C$ 的谱系仍处于一个分离的群体中。\n- 如果谱系 $A$ 和 $B$ 在它们任何一个与谱系 $C$ 发生溯祖合并之前彼此先发生溯祖合并，则物种树拓扑 $\\left(\\left(A,B\\right),C\\right)$ 就能在基因树中得到恢复（一致性）。这可能在两种情形下发生：\n  1. 谱系 $A$ 和 $B$ 在内部支群体中发生溯祖合并，这个时间区间的溯祖长度为 $t_{c} = 3.4$。\n  2. 谱系 $A$ 和 $B$ 未能在此区间内发生溯祖合并，并且所有三个谱系（$A$、$B$、$C$）在时间 $\\tau_{2}$ 进入单一的深层祖先群体。在这种情况下，一致性要求该深层群体中的第一个溯祖合并事件发生在 $A$ 和 $B$ 之间。\n- 一个不一致的基因树——$\\left(\\left(A,C\\right),B\\right)$ 或 $\\left(\\left(B,C\\right),A\\right)$——只有在谱系 $A$、$B$ 和 $C$ 都作为不同谱系存在于同一群体中时才会出现。这要求谱系 $A$ 和 $B$ *没有* 在内部支群体中发生溯祖合并。\n\n让我们将该概率公式化。根据MSC模型，当以溯祖单位（1 单位 = $2N_{e}$ 代）衡量时，两个谱系发生溯祖合并的等待时间服从速率参数为 $\\lambda=1$ 的指数分布。\n这两个谱系（$A$ 和 $B$）在长度为 $t_{c}$ 的区间内不发生溯祖合并的概率由指数分布的生存函数给出：\n$$\nP(\\text{内部支上无溯祖合并}) = \\exp(-1 \\times t_{c}) = \\exp(-t_{c})\n$$\n如果这个事件发生（概率为 $\\exp(-t_{c})$），那么在时间 $\\tau_{2}$，所有三个谱系（$A$、$B$、$C$）都进入同一个祖先群体。\n问题陈述指出，当存在三个谱系时，三个可能的谱系对——$(A,B)$、$(A,C)$ 或 $(B,C)$——中的任何一对率先发生溯祖合并的可能性均等。\n$$\nP(\\text{谱系对 } (A,B) \\text{ 先溯祖合并} | \\text{3个谱系}) = \\frac{1}{3}\n$$\n$$\nP(\\text{谱系对 } (A,C) \\text{ 先溯祖合并} | \\text{3个谱系}) = \\frac{1}{3}\n$$\n$$\nP(\\text{谱系对 } (B,C) \\text{ 先溯祖合并} | \\text{3个谱系}) = \\frac{1}{3}\n$$\n如果第一个溯祖合并事件发生在 $(A,C)$ 之间或 $(B,C)$ 之间，则会产生不一致的拓扑。在所有三个谱系都存在的条件下，不一致拓扑的总概率是这两个概率之和：\n$$\nP(\\text{不一致} | \\text{3个谱系}) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}\n$$\n观察到不一致基因树的总概率是内部支上没有发生溯祖合并的概率乘以深层祖先群体中发生不一致溯祖合并事件的概率。\n$$\nP(\\text{不一致树}) = P(\\text{内部支上无溯祖合并}) \\times P(\\text{不一致} | \\text{3个谱系})\n$$\n$$\nP(\\text{不一致树}) = \\exp(-t_{c}) \\times \\frac{2}{3}\n$$\n这个公式就是所要求的第一性原理推导。现在，我们使用计算出的值 $t_{c} = 3.4$ 对此表达式进行数值计算。\n$$\nP(\\text{不一致树}) = \\frac{2}{3} \\exp(-3.4)\n$$\n使用计算器计算数值：\n$\\exp(-3.4) \\approx 0.03337327$\n$$\nP(\\text{不一致树}) \\approx \\frac{2}{3} \\times 0.03337327 \\approx 0.022248847\n$$\n按照问题陈述的要求，四舍五入到四位有效数字，我们得到 $0.02225$。\n这就是具有不一致基因树拓扑的不连锁基因座的预期总比例。", "answer": "$$\n\\boxed{0.02225}\n$$", "id": "2598316"}, {"introduction": "系统发育不变量提供了一种强大的、基于模型的方法，可以直接从序列联配的位点模式中推断进化关系。与先构建大量基因树再进行物种树推断的传统方法不同，这种代数方法直接检验哪种树拓扑结构与观测数据在特定演化模型下最为兼容。本练习将通过一个具体案例，演示如何应用基于不变量的检验来从四分类群数据中选择支持度最高的拓扑结构，从而让你掌握一种前沿的系统发育分析技术。[@problem_id:2598356]", "problem": "给定一个四分类单元比对，它是在 $N$ 个独立位点上，将性状重编码为二态（嘌呤编码为 $0$，嘧啶编码为 $1$）得到。该比对数据来源于对比较动物学和植物学（两个植物谱系和两个动物谱系）中取样的直系同源位点的系统基因组学串联。假设这些位点在树上遵循二态通用马尔可夫模型（GMM）进行演化（等价于没有转换概率对称性约束的 Cavender–Farris–Neyman (CFN) 模型）。对于此类模型，一个经过充分检验的事实是：对于正确的无根四分支拓扑，跨越相应二分的联合位点模式分布的 $4\\times 4$ 扁平化矩阵的秩最多为 $2$，这意味着该扁平化矩阵的每个 $3\\times 3$ 子式都为零。您将使用这个由秩约束导出的不变量来检验三种无根四分支假设。\n\n分类单元标记为 $A$、$B$、$C$ 和 $D$。对于 $(A,B,C,D)$，其二元模式按字典序列出的经验位点模式计数如下。每个模式写作 $(a,b,c,d)$，其中 $a,b,c,d\\in\\{0,1\\}$，其后是它的计数值：\n- $(0,0,0,0):\\, 880$\n- $(0,0,0,1):\\, 880$\n- $(0,0,1,0):\\, 440$\n- $(0,0,1,1):\\, 0$\n- $(0,1,0,0):\\, 528$\n- $(0,1,0,1):\\, 672$\n- $(0,1,1,0):\\, 480$\n- $(0,1,1,1):\\, 360$\n- $(1,0,0,0):\\, 352$\n- $(1,0,0,1):\\, 568$\n- $(1,0,1,0):\\, 500$\n- $(1,0,1,1):\\, 540$\n- $(1,1,0,0):\\, 0$\n- $(1,1,0,1):\\, 360$\n- $(1,1,1,0):\\, 540$\n- $(1,1,1,1):\\, 900$\n\n任务：\n1) 计算总位点数 $N$，并通过除以 $N$ 将计数转换为经验联合概率 $P(a,b,c,d)$。\n\n2) 对于三种无根四分支拓扑中的每一种，分别对应于二分 $AB|CD$、$AC|BD$ 和 $AD|BC$，构建 $4\\times 4$ 扁平化矩阵 $\\mathrm{Flat}_{X|Y}$。其行由第一对分类单元 $X$ 的联合二元状态按字典序 $\\{00,01,10,11\\}$ 索引，列由第二对分类单元 $Y$ 的联合二元状态按字典序 $\\{00,01,10,11\\}$ 索引。$\\mathrm{Flat}_{X|Y}$ 的第 $(i,j)$ 个元素是相应联合模式的经验概率。\n\n3) 仅使用秩约束（在二态 GMM 下，对于正确的分支，秩最多为 $2$），从 $\\mathrm{Flat}_{X|Y}$ 推导出一个基于标量不变量的检验统计量 $S_{X|Y}$，该统计量在正确的拓扑上理论值为 $0$，而在不正确的拓扑上通常非零。通过计算 $\\mathrm{Flat}_{X|Y}$ 的首部 $3\\times 3$ 子矩阵（行索引为 $00,01,10$，列索引为 $00,01,10$）的行列式来实现这一点；将 $S_{X|Y}$ 定义为该行列式的绝对值。\n\n4) 根据经验概率计算 $S_{AB|CD}$、$S_{AC|BD}$ 和 $S_{AD|BC}$。通过找出最小的 $S_{X|Y}$ 来决定哪种拓扑得到最佳支持。\n\n作为您的最终答案，报告最小值 $S_{\\min}=\\min\\{S_{AB|CD},S_{AC|BD},S_{AD|BC}\\}$，以单个实数形式呈现。不要包含单位。如果您的计算得出精确值，请精确报告该值；无需四舍五入。", "solution": "所提出的问题是计算系统发育学中一个有效且定义明确的练习，其基础是关于离散性状演化的系统发育不变量的既定理论。它要求将特定的代数检验应用于经验数据，以推断演化关系。该问题是自洽的、科学上合理的，并且其指令是明确的。我们将开始解题。\n\n任务是确定对于标记为 $A$、$B$、$C$ 和 $D$ 的四个分类单元，三种可能的无根拓扑中哪一种最受所提供的位点模式计数支持。这些分类单元在二态通用马尔可夫模型（GMM）下演化，该模型的一个已知属性是，对于真实拓扑，特定矩阵扁平化的秩最多为 $2$。这意味着该矩阵的所有 $3 \\times 3$ 子式都必须为零。问题将检验统计量 $S_{X|Y}$ 定义为给定二分 $X|Y$ 的扁平化概率矩阵的首部 $3 \\times 3$ 子矩阵的行列式的绝对值。与该统计量最小值相对应的拓扑被认为是得到最佳支持的假设。\n\n首先，我们必须通过对所有 $2^4=16$ 种可能的位点模式的计数求和来计算总位点数 $N$。\n计数值为：$880$、$880$、$440$、$0$、$528$、$672$、$480$、$360$、$352$、$568$、$500$、$540$、$0$、$360$、$540$ 和 $900$。\n总和是：\n$$N = 880 + 880 + 440 + 0 + 528 + 672 + 480 + 360 + 352 + 568 + 500 + 540 + 0 + 360 + 540 + 900 = 8000$$\n一个模式 $(a,b,c,d)$ 的经验联合概率是其计数值 $c(a,b,c,d)$ 除以 $N$。例如，$P(0,0,0,0) = \\frac{880}{8000}$。对于一个二分，$检验统计量 S_{X|Y}$ 是 $4 \\times 4$ 概率矩阵 $\\mathrm{Flat}_{X|Y}$ 的首部 $3 \\times 3$ 子矩阵的行列式的绝对值。如果 $M'_{X|Y}$ 是*计数*矩阵的首部 $3 \\times 3$ 子矩阵，则关系为 $S_{X|Y} = \\frac{1}{N^3} |\\det(M'_{X|Y})|$。我们将为三种可能的二分分别计算这个值。\n\n1. 二分 $AB|CD$：\n扁平化矩阵 $\\mathrm{Flat}_{AB|CD}$ 是一个 $4 \\times 4$ 矩阵，其行由 $(A,B)$ 的状态索引，列由 $(C,D)$ 的状态索引，两者均按字典序 $\\{00, 01, 10, 11\\}$。行 $(a,b)$ 和列 $(c,d)$ 对应的元素是 $P(a,b,c,d)$。相应的计数矩阵是：\n$$\n\\begin{pmatrix}\nc(0,0,0,0)  c(0,0,0,1)  c(0,0,1,0)  c(0,0,1,1) \\\\\nc(0,1,0,0)  c(0,1,0,1)  c(0,1,1,0)  c(0,1,1,1) \\\\\nc(1,0,0,0)  c(1,0,0,1)  c(1,0,1,0)  c(1,0,1,1) \\\\\nc(1,1,0,0)  c(1,1,0,1)  c(1,1,1,0)  c(1,1,1,1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n880  880  440  0 \\\\\n528  672  480  360 \\\\\n352  568  500  540 \\\\\n0  360  540  900\n\\end{pmatrix}\n$$\n计数的首部 $3 \\times 3$ 子矩阵 $M'_{AB|CD}$ 是：\n$$ M'_{AB|CD} = \\begin{pmatrix} 880  880  440 \\\\ 528  672  480 \\\\ 352  568  500 \\end{pmatrix} $$\n为计算其行列式，我们可以执行行变换。设 $R_1, R_2, R_3$ 为各行。\n创建一个新矩阵，其中 $R'_2 = R_2 - \\frac{528}{880}R_1 = R_2 - \\frac{3}{5}R_1$ 并且 $R'_3 = R_3 - \\frac{352}{880}R_1 = R_3 - \\frac{2}{5}R_1$。\n$R'_2 = [528 - \\frac{3}{5}(880), 672 - \\frac{3}{5}(880), 480 - \\frac{3}{5}(440)] = [528-528, 672-528, 480-264] = [0, 144, 216]$。\n$R'_3 = [352 - \\frac{2}{5}(880), 568 - \\frac{2}{5}(880), 500 - \\frac{2}{5}(440)] = [352-352, 568-352, 500-176] = [0, 216, 324]$。\n这些变换不改变行列式的值：\n$$ \\det(M'_{AB|CD}) = \\det \\begin{pmatrix} 880  880  440 \\\\ 0  144  216 \\\\ 0  216  324 \\end{pmatrix} = 880 \\times \\det \\begin{pmatrix} 144  216 \\\\ 216  324 \\end{pmatrix} $$\n这个 $2 \\times 2$ 子矩阵的行是 $[144, 216]$ 和 $[216, 324]$。我们观察到 $[216, 324] = 1.5 \\times [144, 216]$，因为 $216 = 1.5 \\times 144$ 并且 $324 = 1.5 \\times 216$。由于行是线性相关的，该子矩阵的行列式为 $0$。\n$$ \\det \\begin{pmatrix} 144  216 \\\\ 216  324 \\end{pmatrix} = 144 \\times 324 - 216 \\times 216 = 46656 - 46656 = 0 $$\n因此，$\\det(M'_{AB|CD}) = 880 \\times 0 = 0$。\n统计量为 $S_{AB|CD} = \\frac{|0|}{8000^3} = 0$。\n\n2. 二分 $AC|BD$：\n矩阵 $\\mathrm{Flat}_{AC|BD}$ 的行由 $(A,C)$ 索引，列由 $(B,D)$ 索引。行 $(a,c)$ 和列 $(b,d)$ 对应的元素是 $P(A=a, B=b, C=c, D=d) = p_{abcd}$。计数矩阵是：\n$$\n\\begin{pmatrix}\nc(0,0,0,0)  c(0,0,0,1)  c(0,1,0,0)  c(0,1,0,1) \\\\\nc(0,0,1,0)  c(0,0,1,1)  c(0,1,1,0)  c(0,1,1,1) \\\\\nc(1,0,0,0)  c(1,0,0,1)  c(1,1,0,0)  c(1,1,0,1) \\\\\nc(1,0,1,0)  c(1,0,1,1)  c(1,1,1,0)  c(1,1,1,1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n880  880  528  672 \\\\\n440  0  480  360 \\\\\n352  568  0  360 \\\\\n500  540  540  900\n\\end{pmatrix}\n$$\n计数的首部 $3 \\times 3$ 子矩阵 $M'_{AC|BD}$ 是：\n$$ M'_{AC|BD} = \\begin{pmatrix} 880  880  528 \\\\ 440  0  480 \\\\ 352  568  0 \\end{pmatrix} $$\n$$ \\det(M'_{AC|BD}) = 880(0 \\cdot 0 - 480 \\cdot 568) - 880(440 \\cdot 0 - 480 \\cdot 352) + 528(440 \\cdot 568 - 0 \\cdot 352) $$\n$$ = 880(-272640) - 880(-168960) + 528(249920) $$\n$$ = -239923200 + 148684800 + 131957760 = 40719360 $$\n统计量为 $S_{AC|BD} = \\frac{|40719360|}{8000^3} = \\frac{40719360}{512 \\times 10^9} = \\frac{79530}{10^9} = \\frac{7953}{100000000} = 0.00007953$。\n\n3. 二分 $AD|BC$：\n矩阵 $\\mathrm{Flat}_{AD|BC}$ 的行由 $(A,D)$ 索引，列由 $(B,C)$ 索引。行 $(a,d)$ 和列 $(b,c)$ 对应的元素是 $P(A=a, B=b, C=c, D=d) = p_{abcd}$。计数矩阵是：\n$$\n\\begin{pmatrix}\nc(0,0,0,0)  c(0,0,1,0)  c(0,1,0,0)  c(0,1,1,0) \\\\\nc(0,0,0,1)  c(0,0,1,1)  c(0,1,0,1)  c(0,1,1,1) \\\\\nc(1,0,0,0)  c(1,0,1,0)  c(1,1,0,0)  c(1,1,1,0) \\\\\nc(1,0,0,1)  c(1,0,1,1)  c(1,1,0,1)  c(1,1,1,1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n880  440  528  480 \\\\\n880  0  672  360 \\\\\n352  500  0  540 \\\\\n568  540  360  900\n\\end{pmatrix}\n$$\n计数的首部 $3 \\times 3$ 子矩阵 $M'_{AD|BC}$ 是：\n$$ M'_{AD|BC} = \\begin{pmatrix} 880  440  528 \\\\ 880  0  672 \\\\ 352  500  0 \\end{pmatrix} $$\n$$ \\det(M'_{AD|BC}) = 880(0 \\cdot 0 - 672 \\cdot 500) - 440(880 \\cdot 0 - 672 \\cdot 352) + 528(880 \\cdot 500 - 0 \\cdot 352) $$\n$$ = 880(-336000) - 440(-236544) + 528(440000) $$\n$$ = -295680000 + 104079360 + 232320000 = 40719360 $$\n统计量为 $S_{AD|BC} = \\frac{|40719360|}{8000^3} = \\frac{7953}{100000000} = 0.00007953$。\n\n统计量比较：\n$S_{AB|CD} = 0$\n$S_{AC|BD} = 0.00007953$\n$S_{AD|BC} = 0.00007953$\n\n最小值为 $S_{\\min} = 0$。这一结果强烈支持与二分 $AB|CD$ 相对应的拓扑。不变量恰好为零的事实表明，数据是在没有抽样噪声的情况下，从与该拓扑一致的树生成的。其他拓扑的非零值正确地表明，在假设的模型下，它们与数据不一致。最终答案是计算出的最小值。", "answer": "$$\\boxed{0}$$", "id": "2598356"}, {"introduction": "虽然不完全谱系分选是基因树冲突的主要来源，但杂交或基因渗入等其他进化过程同样会产生冲突信号。ABBA-BABA检验（或称D统计量）是检测这种古老基因流的经典工具，在揭示网状进化中扮演着关键角色。本练习将让你亲手计算D统计量及其统计显著性，这是一项区分不同进化信号、解析复杂进化历史的关键技能。[@problem_id:2598312]", "problem": "在一项系统发育基因组学分析中，进行了一项四分类群不对称性检验，以评估一个包含动物和植物范例的进化支内谱系间的基因流。该检验使用三个内群分类群和一个外群来极化衍生状态。该检验依赖于全基因组中分布的双等位基因单核苷酸位点上被称为ABBA和BABA的模式。在一个没有基因渗入的不完全谱系分选的零模型下，ABBA和BABA的全基因组预期计数是相等的。为了以无标度的方式量化与该零模型的偏差，系统发育基因组学中常用的一种统计量通过将计数的差异除以其总和来进行归一化。该统计量的标准误可以通过对基因组区块进行区块刀切法获得，对于大量的区块，该统计量与其标准误的比值近似于标准正态分布，从而可以进行双侧显著性检验。\n\n在一个真实数据集中，跨区块汇总的全基因组计数得出 $n_{ABBA}=120$ 和 $n_{BABA}=80$。对整个基因组进行的区块刀切法得出了全基因组统计量的标准误 $SE=0.05$。使用这些值：\n- 根据计数计算归一化不对称性统计量 $D$。\n- 通过将 $D$ 除以其标准误来计算相应的 $Z$-分数（其中 $Z$-分数表示标准化正态离差）。\n- 在显著性水平 $\\alpha=0.05$ 下，判断该偏差在双侧检验下是否具有统计显著性。\n\n将您的最终结果报告为单行矩阵 $\\big[D,\\;Z,\\;I\\big]$，其中如果在 $\\alpha=0.05$（双侧）下显著，则 $I=1$，否则 $I=0$。将每个数值条目四舍五入到三位有效数字。不需要单位。", "solution": "该问题要求根据提供的基因组计数数据和标准误，计算Patterson's D-统计量、其相关的Z-分数，并判断统计显著性。\n\n首先，我将验证问题陈述。\n\n步骤1：提取给定条件。\n- 检验：四分类群不对称性检验（ABBA-BABA检验）。\n- 零模型：没有基因渗入的不完全谱系分选。\n- 归一化不对称性统计量：$D$ 定义为计数之差除以其总和的归一化值。\n- 检验统计量的分布：$D$ 与其标准误的比值 $Z$ 近似于标准正态分布。\n- ABBA位点的计数：$n_{ABBA} = 120$。\n- BABA位点的计数：$n_{BABA} = 80$。\n- D-统计量的标准误：$SE = 0.05$。\n- 双侧检验的显著性水平：$\\alpha = 0.05$。\n- 要求输出：一个行矩阵 $[D, Z, I]$，其中 $D$ 是统计量，$Z$ 是Z-分数，$I$ 是显著性指示符（$I=1$ 表示显著，$I=0$ 表示不显著），所有数值四舍五入到三位有效数字。\n\n步骤2：使用提取的给定条件进行验证。\n该问题描述了系统发育基因组学中的一个标准统计程序，即用于检测基因渗入的ABBA-BABA检验。D-统计量的公式、使用区块刀切法估计标准误以及应用Z-检验进行显著性判断在方法上都是合理且内部一致的。提供的数值（$n_{ABBA}$、$n_{BABA}$、$SE$、$\\alpha$）是合理的，并且足以得出一个唯一的解。提到的生物学背景——“一个包含动物和植物范例的进化支”——非常不寻常且在生物学上不合理，因为动物和植物在这种意义上不形成一个进化支，也不会杂交。然而，这种背景上的特殊性并不会使问题的数学和统计核心失效，该核心是基于给定数据执行计算。问题不要求解释这种生物学情景，而是要求执行一个定义明确的统计检验。因此，该问题是可形式化且可解的。该问题在其统计方法上被认为是具有科学依据的、提法得当且客观的。\n\n步骤3：结论与行动。\n问题有效。我将继续进行解答。\n\n归一化不对称性统计量，记为 $D$，是根据ABBA和BABA模式的计数计算的。问题中提供的定义，“通过将计数的差异除以其总和来进行归一化”，对应于标准公式：\n$$D = \\frac{n_{ABBA} - n_{BABA}}{n_{ABBA} + n_{BABA}}$$\n代入给定值，$n_{ABBA} = 120$ 和 $n_{BABA} = 80$：\n$$D = \\frac{120 - 80}{120 + 80} = \\frac{40}{200} = \\frac{1}{5} = 0.2$$\n四舍五入到三位有效数字，我们得到 $D = 0.200$。\n\n接下来，计算Z-分数。问题陈述这是统计量 $D$ 与其标准误 $SE$ 的比值。\n$$Z = \\frac{D}{SE}$$\n使用计算出的 $D$ 值和给定的标准误 $SE = 0.05$：\n$$Z = \\frac{0.2}{0.05} = 4$$\n四舍五入到三位有效数字，得到 $Z = 4.00$。\n\n最后，我们必须确定这个结果是否具有统计显著性。这是一个双侧检验，显著性水平为 $\\alpha = 0.05$。在零假设下，检验统计量 $Z$ 假定服从标准正态分布 $N(0, 1)$。对于 $\\alpha = 0.05$ 的双侧检验，临界区由 $|Z|  z_{\\alpha/2}$ 定义，其中 $z_{\\alpha/2}$ 是标准正态分布中对应于尾部概率 $\\alpha/2 = 0.025$ 的临界值。\n标准临界值为 $z_{0.025} \\approx 1.96$。\n我们必须将我们计算出的Z-分数的绝对值与此临界值进行比较。\n$$|Z| = |4.00| = 4.00$$\n统计显著性的条件是：\n$$|Z|  1.96$$\n由于 $4.00  1.96$，条件满足。我们拒绝ABBA和BABA模式计数相等的零假设，这意味着观察到的偏差具有统计显著性。因此，指示变量 $I$ 为 $1$。\n\n最终结果是行矩阵 $[D, Z, I]$，其值四舍五入到三位有效数字。\n$D = 0.200$\n$Z = 4.00$\n$I = 1$\n得到的矩阵是 $[0.200, 4.00, 1]$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.200  4.00  1 \\end{pmatrix}}$$", "id": "2598312"}]}