{"hands_on_practices": [{"introduction": "要可靠地研究表型可塑性，第一步是设计能够有效分离遗传、环境、亲代效应及它们之间相互作用的实验。本练习将探讨三种经典的实验设计——普通花园、相互移植和分窝设计，它们是生态学和进化生物学中分离这些效应的基石。掌握这些设计的原理和局限性对于严谨地检验关于发育偏向和表型可塑性的假说是至关重要的。[@problem_id:2565334]", "problem": "一位比较生物学家旨在阐明栖息在成对的冷湿与暖干山谷中的两栖动物和一年生禾本科植物谱系的发育偏向和表型可塑性。目标表型包括幼体肢体长度和叶片厚度。该研究者采用数量遗传学分解方法，其中观测表型 $P$ 表示为基因型 $G$、环境 $E$、基因型与环境互作 $G \\times E$ (GxE)、亲代或母体效应 $M$ 以及残差 $\\epsilon$ 的函数，即 $P = G + E + G \\times E + M + \\epsilon$。总体目标是选择能够移除或明确估计这些组分子集的实验设计，以分离可塑性并评估发育偏向。\n\n选择所有能够正确定每种实验设计（同质园、交互移植、分窝）并准确陈述在可塑性研究背景下每种设计能控制哪些混杂因素的选项。\n\nA. 同质园：从不同来源的种群中收集多个基因型，并在相同的标准化环境中对其进行早期发育阶段的饲养/培育。这种设计控制了测量时的环境异质性（标准化了 $E$ 和测试地点效应），并允许将 $P$ 的差异归因于 $G$ 和任何持续存在的 $M$。它本身无法消除创始代从野外携带的 $M$，并且除非在不同环境中进行重复，否则无法估计 $G \\times E$。\n\nB. 交互移植：在相同的生命阶段和时间，将每个种群的个体或家系移入其原生生境和替代生境，并在每个地点测量其表现和形态。这种设计通过在环境中对称放置来控制来源基因型和测试地点之间的混杂，能够通过跨原生环境的反应规范来估计可塑性和局域适应（即，它可以估计 $G \\times E$），但其本身并不能移除亲代 $M$ 或由操作引起的移植休克，除非实施额外的控制措施。\n\nC. 分窝：将来自相同亲本的全同胞或克隆后代分配到不同的环境中，将同胞随机分配到不同处理组，并进行并行饲养/培育。这种设计通过使用家系内对比，控制了家系间的遗传和母体供给混杂因素，直接估计了环境对 $P$ 的影响（可塑性），并且可以在家系或基因型水平上检验 $G \\times E$；如果分组发生在早期发育之后，它无法移除分组前共同的饲养/培育影响。\n\nD. 同质园：因为在测量时母体环境不再有差异，所以这种设计消除了 $M$，即使使用了野外收集的胚胎或种子并在测量前进行了短暂的饲养/培育；因此任何剩余的变异必定是 $G$。\n\nE. 交互移植：因为移植是双向进行的，操作效应和移植休克会自动抵消，所以这种设计无需额外程序即可同时控制 $E$ 和 $M$，只剩下 $G$ 和 $G \\times E$ 有待估计。\n\nF. 分窝：通过将同胞分布在不同环境中，这种设计消除了遗传方差，所以任何观测到的 $P$ 的差异必定纯粹是环境性的和可塑性的；因此它不能用于估计 $G \\times E$。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **研究主题**：区分发育偏向和表型可塑性。\n- **研究生物**：两栖动物和一年生禾本科植物的谱系。\n- **环境**：成对的冷湿与暖干山谷。\n- **目标表型**：幼体肢体长度和叶片厚度。\n- **数量遗传模型**：表型 $P$ 是各种效应的总和: $P = G + E + G \\times E + M + \\epsilon$。\n    - $P$：观测表型。\n    - $G$：基因型效应。\n    - $E$：环境效应。\n    - $G \\times E$：基因型与环境互作。\n    - $M$：亲代或母体效应。\n    - $\\epsilon$：残差。\n- **目标**：选择对实验设计（同质园、交互移植、分窝）的正确描述，以及它们在可塑性研究中控制混杂变量的能力。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于数量遗传学和演化生态学中实验设计的基本原则。模型 $P = G + E + G \\times E + M + \\epsilon$ 是一个用于分解表型方差的标准线性模型。所列出的实验设计是该领域的经典方法。生物学背景是现实的。\n2.  **适定性**：该问题是适定的。它要求根据已建立的科学定义和原则对几个陈述进行评估。基于实验设计理论，存在一组明确的正确和不正确的陈述。\n3.  **客观性**：该问题使用来自演化生物学领域的精确、客观和标准的术语进行陈述。没有歧义或主观语言。\n\n### 步骤3：结论与行动\n问题陈述是有效的。这是一个关于数量遗传学中实验设计主题的、格式良好的问题。我将继续分析每个选项。\n\n### 选项分析\n根本目标是将表型方差 $\\text{Var}(P)$ 分解为其因果组分：$\\text{Var}(G)$、$\\text{Var}(E)$、$\\text{Var}(G \\times E)$、$\\text{Var}(M)$ 和 $\\text{Var}(\\epsilon)$，以及协方差项。实验设计是构建实验的一种特定方式，旨在使某些组分为零或允许对其进行估计。表型可塑性是一种基因型 ($G$) 在不同环境 ($E$) 中产生不同表型 ($P$) 的现象。这由 $E$ 项（对于平均可塑性响应）和 $G \\times E$ 项（对于基因型间可塑性的变异）来捕捉。\n\n**选项A：同质园**\n该陈述将同质园实验定义为在单一、标准化的环境中饲养/培育来自不同来源的多个基因型。这是一个正确的定义。根据设计，实验中所有个体的环境 ($E$) 保持恒定。因此，任何观察到的表型 ($P$) 变异都不能归因于当前环境的变异。这种变异必须源于个体间不同的因素，即它们的基因型 ($G$) 和它们从来源环境或亲本携带的任何亲代或母体效应 ($M$) 。该陈述正确地指出，这种设计本身并不能消除这些遗留的母体效应 ($M$)。此外，由于所有个体都在单一环境中，因此无法测量基因型对*不同*环境的反应，所以无法估计基因型与环境的互作 ($G \\times E$)。这需要将基因型在至少两个不同的环境中进行重复。该陈述完全准确。\n**结论：正确**\n\n**选项B：交互移植**\n这种设计涉及将每个来源种群的生物体移入所有其他来源种群的生境，从而创建一个基因型来源和目标环境的完全交叉设计。这准确地描述了交互移植。这样的设计并不保持 $E$ 恒定，而是与 $G$ 一起对其进行因子化操作。这允许分别估计基因型 ($G$) 的主效应、环境 ($E$) 的主效应以及它们的互作 ($G \\times E$)。如果“本地”基因型表现优于“外地”基因型，那么 $G \\times E$ 项就是局域适应的统计特征。该陈述正确地指出，这种设计本身并不能消除亲代效应 ($M$) 或移植带来的生理休克。这些是众所周知 的混杂因素，需要额外的控制措施，例如在其原生地点内移植生物体以估计操作效应。该陈述在其描述和局限性评估方面是准确的。\n**结论：正确**\n\n**选项C：分窝**\n这种设计涉及从一组亲本（一个家系或一窝，可以是全同胞或克隆）中取出后代，并将它们分布在不同的实验环境中。这是一个正确的定义。关键特征是，在家系内部，比较是在有遗传关系的个体之间进行的（对于克隆是相同的，对于全同胞平均亲缘度为 $0.5$）。这控制了存在于家系*之间*的遗传差异，也控制了来自同一母亲的所有后代所共有的母体效应 ($M$)（例如，卵黄供给）。不同环境中同胞之间的表型差异是对该特定家系（基因型）可塑性的直接估计。通过为多个家系重复此操作，可以比较家系间的可塑性响应。如果响应不同，这就是在家系水平上存在 $G \\times E$ 互作的证据。关于分组前共同的环境效应未被控制的注意事项也是一个重要且正确的观点。该陈述是准确的。\n**结论：正确**\n\n**选项D：同质园**\n该陈述声称同质园设计消除了母体效应 ($M$)，因为在测量时母体环境已无差异。这是一个根本性的误解。根据定义，母体效应是亲本的表型或环境对后代表型的影响。这些效应在实验开始*前*就已确立（例如，种子供给、卵质量、母体激素）。在共同环境中饲养/培育后代并不会消除这些预先存在的差异。因此，任何剩余变异都必定纯粹是遗传性的 ($G$) 的断言也是错误的；它是 $G$ 和 $M$ 的组合。\n**结论：不正确**\n\n**选项E：交互移植**\n该陈述声称移植休克效应会“自动抵消”，因为移植是双向的。没有任何物理或生物学原理能保证这一点。从冷环境移到暖环境的压力可能在生理上与从暖环境移到冷环境的压力非常不同。这些效应不一定是对称的，也不会抵消。该陈述进一步声称该设计控制了 $E$ 和 $M$。它并没有控制 $E$；它是有意地改变 $E$。如前所述，它也没有控制 $M$。因此，只有 $G$ 和 $G \\times E$ 有待估计的结论是不正确的。\n**结论：不正确**\n\n**选项F：分窝**\n该陈述声称分窝设计“消除了遗传方差”。这是不精确的，并导致了错误的结论。该设计通过在进行*家系内*比较时控制*家系间*的遗传方差来起作用。遗传方差在总实验种群（所有家系）中绝对仍然存在，并且事实上，它是估计 $G \\times E$ 所必需的。声称该设计*不能*用于估计 $G \\times E$ 与事实完全相反。比较不同家系（即不同基因型）的可塑性响应，正是使用这种设计检测 $G \\times E$ 的方式。\n**结论：不正确**\n\n总而言之，选项 A、B 和 C 提供了实验设计的正确定义和解释，而选项 D、E 和 F 包含重大的概念错误。", "answer": "$$\\boxed{ABC}$$", "id": "2565334"}, {"introduction": "在完成实验设计并收集数据后，下一步便是解读结果以揭示生物学规律。本练习提供了一个模拟真实研究的场景，要求您根据一个普通花园实验的数据和统计分析结果，来判断表型模式是由可塑性、遗传分化还是两者共同驱动的。通过分析反应规范，您将实践如何将统计显著性与表型可塑性、遗传分化以及指示发育偏向的平行反应等核心概念联系起来。[@problem_id:2565345]", "problem": "一位植物生态学家比较了沿海拔梯度的气孔密度，以区分表型可塑性与遗传分化。从同一物种的两个种群中收集种子：一个来自低海拔地区（$L$），另一个来自高海拔地区（$H$）。从每个来源地中，取样了 $n = 10$ 个母系家庭，并在模拟低海拔（$E_L$：较高的二氧化碳分压、较温暖、较高的水汽压差）和高海拔（$E_H$：较低的二氧化碳分压、较凉爽、较低的水汽压差）的两个受控同质园环境中，采用“分窝”（split-brood）设计进行种植。每个家庭在每个环境中提供 $2$ 个克隆繁殖的个体。在成熟后，测量完全展开叶片上的气孔密度（每 $\\mathrm{mm}^2$ 的气孔数）。\n\n作为基础，回顾以下核心定义。反应范是给定基因型从环境到表型的映射。表型可塑性是基因型在不同环境下的表型变化，通常由其反应范的斜率反映。当来自不同来源地的基因型在同一环境中测量时表型不同，则存在种群间的遗传分化。当环境对表型的影响因基因型或来源地而异时，就存在基因型与环境的相互作用，这通常通过不平行的反应范来反映。发育偏向是指发育过程在不同基因型和环境中倾向于优先产生某些表型变化而非其他变化的趋势，当偏向是共享的时，它预示着反应范方向的一致或受限。\n\n该研究报告了以下气孔密度的总平均值（各家庭的平均值；平均值 $\\pm$ 标准误）：\n- 来源地 $L$：在 $E_L$ 中为 $155 \\pm 5$；在 $E_H$ 中为 $222 \\pm 6$。\n- 来源地 $H$：在 $E_L$ 中为 $165 \\pm 5$；在 $E_H$ 中为 $232 \\pm 6$。\n\n一个线性混合模型，包含环境（$E$）、来源地（$O$）及其交互作用（$E \\times O$）的固定效应，以及嵌套在来源地内的家庭随机效应，得出以下结果：\n- 环境主效应：$F_{1,36} = 128.4$, $p  0.0001$。\n- 来源地主效应：$F_{1,18} = 5.6$, $p = 0.028$。\n- 交互作用 $E \\times O$：$F_{1,36} = 0.31$, $p = 0.58$。\n\n根据这些结果和上述基础定义，哪种解释得到了最强的支持？\n\nA. 该模式仅由表型可塑性解释；没有证据表明存在遗传分化或共享的发育偏向使反应方向一致。\n\nB. 该模式仅由遗传分化解释；没有证据表明存在跨环境的表型可塑性。\n\nC. 表型可塑性和遗传分化都存在；不同来源地的反应范实际上是平行的（没有基因型与环境的相互作用），这与共享的发育偏向一致，该偏向将反应引导至在高海拔条件下产生更高的气孔密度。\n\nD. 存在强烈的基因型与环境相互作用以及交叉的反应范；可塑性在不同来源地之间差异显著，这与共享发育偏向的观点相矛盾。", "solution": "首先将验证问题陈述的科学合理性、自我一致性和清晰性。\n\n**步骤 1：提取已知信息**\n\n*   **实验对象：** 来自两个来源地的单一植物物种：低海拔（$L$）和高海拔（$H$）。\n*   **实验设计：** 一项同质园实验，每个来源地有 $n = 10$ 个母系家庭。每个家庭通过克隆繁殖（每个环境 $2$ 个个体）并采用“分窝”（split-brood）设计进行种植。\n*   **实验环境：** 两个受控的同质园，模拟低海拔（$E_L$）和高海拔（$E_H$）。\n    *   $E_L$：较高的二氧化碳分压、较温暖、较高的水汽压差。\n    *   $E_H$：较低的二氧化碳分压、较凉爽、较低的水汽压差。\n*   **测量性状：** 气孔密度（每 $\\mathrm{mm}^2$ 的气孔数）。\n*   **核心定义：**\n    *   反应范：给定基因型从环境到表型的映射。\n    *   表型可塑性：基因型在不同环境下的表型变化，由其反应范的斜率表示。\n    *   遗传分化：在同一环境中测量时，来自不同来源地的表型差异。\n    *   基因型与环境相互作用（$G \\times E$）：不平行的反应范，即环境的影响因基因型/来源地而异。\n    *   发育偏向：发育过程倾向于产生某些表型变异的趋势，导致反应范方向一致或受限。\n*   **平均气孔密度数据（平均值 $\\pm$ 标准误）：**\n    *   来源地 $L$：在 $E_L$ 中为 $155 \\pm 5$；在 $E_H$ 中为 $222 \\pm 6$。\n    *   来源地 $H$：在 $E_L$ 中为 $165 \\pm 5$；在 $E_H$ 中为 $232 \\pm 6$。\n*   **线性混合模型结果：**\n    *   环境（$E$）主效应：$F_{1,36} = 128.4$, $p  0.0001$。\n    *   来源地（$O$）主效应：$F_{1,18} = 5.6$, $p = 0.028$。\n    *   交互作用效应（$E \\times O$）：$F_{1,36} = 0.31$, $p = 0.58$。\n\n**步骤 2：使用提取的已知信息进行验证**\n\n问题陈述在科学上是有效的。\n*   **科学依据：** 实验设计（同质园）是演化生态学中划分遗传和环境对表型影响的标准方法。表型可塑性、遗传分化、基因型与环境相互作用以及发育偏向等概念是该领域的核心原则。使用线性混合模型适用于这种分层数据结构（来源地内的家庭内的克隆）。观察到的趋势——高海拔条件下（较低的 $pCO_2$）气孔密度更高——与已建立的植物生态生理学知识一致。\n*   **问题明确且客观：** 问题提供了清晰的定义、定量数据和正式的统计结果，并要求给出最有支持的解释。问题是客观的，并且根据所提供的信息有一个唯一的、可推导的答案。\n*   **完整性和一致性：** 问题是自洽的。提供的统计结果与平均值和实验设计一致。$F$ 检验的自由度对于此类模型是合理的。不存在矛盾或缺失关键信息。\n\n**步骤 3：结论与行动**\n\n问题是有效的。可以构建一个严谨的解决方案。\n\n**求解过程**\n\n目标是在给定定义的背景下解释所提供的统计结果和平均值。\n\n1.  **表型可塑性分析：** 表型可塑性是表型在不同环境间的变化。环境（$E$）的主效应为此提供了证据。统计结果为 $F_{1,36} = 128.4$，$p  0.0001$。这一高度显著的结果表明，平均而言，气孔密度在两个环境 $E_L$ 和 $E_H$ 之间存在差异。对于两个来源地，从 $E_L$ 迁移到 $E_H$ 都会导致气孔密度大幅增加（来源地 $L$ 从 $155$ 增至 $222$；来源地 $H$ 从 $165$ 增至 $232$）。因此，有强有力的证据表明存在表型可塑性。\n\n2.  **遗传分化分析：** 如果来自不同来源地的基因型在同一环境中的表型不同，则存在遗传分化。来源地（$O$）的主效应为此提供了证据。统计结果为 $F_{1,18} = 5.6$，$p = 0.028$。这一显著结果表明，在所有环境的平均水平上，来自来源地 $L$ 和来源地 $H$ 的植物具有不同的平均气孔密度。检查每个环境内的平均值证实了这一点：在 $E_L$ 中，来源地 $L$ 的平均密度为 $155$，来源地 $H$ 为 $165$；在 $E_H$ 中，来源地 $L$ 的平均密度为 $222$，来源地 $H$ 为 $232$。在这两种情况下，高海拔来源地（$H$）的气孔密度都高于低海拔来源地（$L$）。这表明该性状存在遗传分化。\n\n3.  **基因型与环境相互作用（$G \\times E$）分析：** 当不同基因型的反应范不平行时，就会发生 $G \\times E$ 相互作用。这通过交互作用项 $E \\times O$ 进行检验。统计结果为 $F_{1,36} = 0.31$，$p = 0.58$。这个高 $p$ 值表明缺乏交互作用的统计证据。因此，反应范被认为是平行的。我们可以通过计算平均值得出反应范的斜率来验证这一点。\n    *   来源地 $L$ 的斜率：$\\Delta(\\text{density})_L = 222 - 155 = 67$。\n    *   来源地 $H$ 的斜率：$\\Delta(\\text{density})_H = 232 - 165 = 67$。\n    斜率完全相同，与不显著的交互作用项完美匹配。这意味着两种来源地对环境的塑性反应幅度是相同的。\n\n4.  **发育偏向分析：** 发育偏向被定义为发育过程倾向于优先产生某些表型结果的趋势。观察到两个来源地的反应范不仅方向一致（都有正斜率），而且是平行的，这是与共享发育偏向一致的有力证据。这意味着该物种的发育系统受到约束或“引导”，以一种高度特定和一致的方式对从 $E_L$ 到 $E_H$ 的环境变化做出反应，而与遗传来源无关。\n\n**选项评估**\n\n*   **A. 该模式仅由表型可塑性解释；没有证据表明存在遗传分化或共享的发育偏向使反应方向一致。**\n    这个说法是**不正确的**。有显著的遗传分化证据（来源地主效应，$p = 0.028$）。平行的反应范实际上与共享的发育偏向一致，而不是缺乏它。\n\n*   **B. 该模式仅由遗传分化解释；没有证据表明存在跨环境的表型可塑性。**\n    这个说法是**不正确的**。有极其强烈的表型可塑性证据（环境主效应，$p  0.0001$）。\n\n*   **C. 表型可塑性和遗传分化都存在；不同来源地的反应范实际上是平行的（没有基因型与环境的相互作用），这与共享的发育偏向一致，该偏向将反应引导至在高海拔条件下产生更高的气孔密度。**\n    这个说法是**正确的**。它准确地综合了所有证据：\n    1.  可塑性（显著的 $E$ 效应）和遗传分化（显著的 $O$ 效应）都存在。\n    2.  反应范是平行的（不显著的 $E \\times O$ 交互作用）。\n    3.  这种平行的反应范模式是一个教科书式的例子，说明该现象与共享发育偏向的运作相一致。\n\n*   **D. 存在强烈的基因型与环境相互作用以及交叉的反应范；可塑性在不同来源地之间差异显著，这与共享发育偏向的观点相矛盾。**\n    这个说法是**不正确的**。统计检验显示没有基因型与环境的相互作用（$p = 0.58$），而不是强烈的相互作用。反应范是平行的，而不是交叉的（来源地 $H$ 的密度始终高于来源地 $L$）。可塑性在不同来源地之间没有变化；表型变化是相同的（$67$ 个单位）。这种模式支持而非反驳了共享发育偏向的观点。", "answer": "$$\\boxed{C}$$", "id": "2565345"}, {"introduction": "宏观的表型模式，如发育偏向，最终源于底层的分子和发育过程。本练习将视角从整体生物体转向基因调控网络，通过构建和模拟一个经典的“拨动开关”模型来探索发育偏向的机制。您将亲手操作，观察在一个完全对称的环境信号输入下，基因网络中微小的参数不对称性如何被放大，从而导致系统倒向一个特定的表型状态，这为理解发育系统如何“偏爱”某些结果提供了具体的、可计算的见解。[@problem_id:2565363]", "problem": "为一种双基因相互抑制拨动开关构建一个机制性的、无量纲化的常微分方程 (ODE) 模型。该开关的两个基因接收相同的瞬时环境输入。使用以下原则作为基本基础：(i) 每个基因产物的产生速率等于一个受调控的合成项减去一个一阶衰变项，以及 (ii) 相互抑制可以通过 Hill 型抑制函数来捕捉，这是一种在基因调控中经过充分检验的唯象公式。假设环境扰动是一个矩形脉冲，相同地施加于两个合成项。您的任务是实现该模型，针对几组参数集模拟其动力学，并将产生的表型结果量化分类为某个基因对另一个基因的显性，从而展示参数不对称性如何在相同的扰动下产生有偏向的结果。\n\n模型定义。令 $x(t)$ 和 $y(t)$ 表示两种基因产物的无量纲浓度（无单位）。其动力学为\n$$\n\\frac{dx}{dt} = \\frac{s_1}{1 + \\left(\\frac{y}{K_1}\\right)^n} - d_1\\,x + u(t), \\qquad\n\\frac{dy}{dt} = \\frac{s_2}{1 + \\left(\\frac{x}{K_2}\\right)^n} - d_2\\,y + u(t),\n$$\n其中 $s_1,s_2$ 是最大合成参数，$d_1,d_2$ 是一阶衰变率，$K_1,K_2$ 是抑制阈值，$n$ 是 Hill 系数。环境输入 $u(t)$ 对两个基因是相同的，由下式给出\n$$\nu(t) = \\begin{cases}\nA,  t_0 \\le t \\le t_1,\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n振幅为 $A$，在时间 $t_0$ 和 $t_1$ 之间为矩形支撑域。所有变量和参数都是无量纲化的；不使用物理单位。\n\n表型分类。在终止时间 $T$ 定义一个表型分类器 $\\phi$ 如下\n$$\n\\phi = \\begin{cases}\n+1,  x(T) - y(T)  \\tau,\\\\\n-1,  y(T) - x(T)  \\tau,\\\\\n0,  |x(T) - y(T)| \\le \\tau,\n\\end{cases}\n$$\n其中 $\\tau$ 是一个小的数值容差。将 $\\phi=+1$ 解释为 $x$ 占优，$\\phi=-1$ 解释为 $y$ 占优，$\\phi=0$ 解释为对称。\n\n模拟协议。对于下面的每一组参数，使用初始条件 $x(0)=x_0$ 和 $y(0)=y_0$ 对 ODE 从 $t=0$ 积分到 $t=T$。使用任何适用于光滑右端项的数值稳定 ODE 求解器。因为模型是无量纲的，所以不需要物理单位。确保对所有测试案例，相同的扰动 $u(t)$ 都按照指定的方式精确施加。\n\n测试套件。模拟以下四组参数集，这些参数集被选择用来探究对称性、强不对称性和双稳态的丧失。在指定的情况下，每个案例使用相同的扰动参数 $A$、$t_0$ 和 $t_1$。\n\n- 案例 $1$（对称拨动开关，初始略微偏向 $y$）：\n  - $s_1 = 6.0$, $s_2 = 6.0$, $d_1 = 1.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 2.0$,\n  - $x_0 = 0.2$, $y_0 = 0.2001$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$。\n- 案例 $2$（不对称合成有利于 $x$，初始同样略微偏向 $y$）：\n  - $s_1 = 8.0$, $s_2 = 6.0$, $d_1 = 1.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 2.0$,\n  - $x_0 = 0.2$, $y_0 = 0.2001$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$。\n- 案例 $3$（不对称衰变不利于 $x$，初始偏向 $x$）：\n  - $s_1 = 6.0$, $s_2 = 6.0$, $d_1 = 2.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 2.0$,\n  - $x_0 = 0.2001$, $y_0 = 0.2$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$。\n- 案例 $4$（低协同性，对称，初始条件相同）：\n  - $s_1 = 6.0$, $s_2 = 6.0$, $d_1 = 1.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 1.0$,\n  - $x_0 = 0.2$, $y_0 = 0.2$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含案例 $1$ 至 $4$ 的四个整数表型分类，形式为方括号内以逗号分隔的列表（例如，$[1,-1,0,1]$）。每个案例只允许输出整数 $-1$、$0$ 或 $+1$，并按此顺序排列。", "solution": "问题陈述经过验证。\n\n给定条件被逐字提取。\n系统动力学由耦合的常微分方程 (ODE) 定义：\n$$\n\\frac{dx}{dt} = \\frac{s_1}{1 + \\left(\\frac{y}{K_1}\\right)^n} - d_1\\,x + u(t)\n$$\n$$\n\\frac{dy}{dt} = \\frac{s_2}{1 + \\left(\\frac{x}{K_2}\\right)^n} - d_2\\,y + u(t)\n$$\n其中 $x(t)$ 和 $y(t)$ 是无量纲浓度。参数包括合成率 $s_1, s_2$；衰变率 $d_1, d_2$；抑制阈值 $K_1, K_2$；以及 Hill 系数 $n$。\n环境输入 $u(t)$ 是一个矩形脉冲：\n$$\nu(t) = \\begin{cases}\nA,  t_0 \\le t \\le t_1,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n在终止时间 $T$ 的表型结果由 $\\phi$ 分类：\n$$\n\\phi = \\begin{cases}\n+1,  x(T) - y(T)  \\tau,\\\\\n-1,  y(T) - x(T)  \\tau,\\\\\n0,  |x(T) - y(T)| \\le \\tau.\n\\end{cases}\n$$\n指定了四个测试案例，它们具有独特的参数集 ($s_1, s_2, d_1, d_2, K_1, K_2, n$)、初始条件 ($x_0, y_0$)，以及共享的扰动 ($A, t_0, t_1$) 和模拟 ($T, \\tau$) 参数。\n\n验证结论：问题有效。\n它具有科学依据，采用了经典的 Gardner-Collins 拨动开关模型，这是合成生物学和系统生物学中的一个基本范式。该模型基于已确立的生物物理学原理，即酶促反应的 Michaelis-Menten 型动力学（在此由用于协同调控的 Hill 函数表示）和一阶衰变。该问题是适定的：它指定了一个具有光滑右端项的常微分方程组，以及初始条件和所有必要的参数。根据 Picard-Lindelöf 定理，存在唯一的解并且是可计算的。该问题是客观的、定量的且无歧义。这是一个计算建模中的标准且不平凡的练习，阐明了双稳态、对称性破缺和发育偏向等概念。\n\n解决方案通过对所提供的 ODE 系统进行直接数值积分来推进。由于方程是非线性的，解析解通常是不可行的。需要一个数值求解器。SciPy 库中的 `solve_ivp` 函数是用于此目的的标准且鲁棒的工具，能够处理刚性和非刚性系统。\n\n算法的核心是一个定义 ODE 系统右端项 (RHS) 的函数。这个函数，我们称之为 $\\vec{f}(t, \\vec{z})$，其中 $\\vec{z}(t) = [x(t), y(t)]^T$，必须正确地实现动力学。它以当前时间 $t$ 和状态向量 $\\vec{z}$ 作为输入，并返回导数向量 $[dx/dt, dy/dt]^T$。外部扰动 $u(t)$ 必须在此函数内根据 $t$ 相对于 $t_0$ 和 $t_1$ 的值进行正确评估。\n\n总体流程如下：\n1.  定义 RHS 函数，该函数以时间 $t$、状态向量 $\\vec{z}=[x, y]$ 以及所有模型参数 ($s_1, s_2, d_1, d_2, K_1, K_2, n, A, t_0, t_1$) 为参数。\n2.  遍历四个指定的测试案例。\n3.  对于每个案例，建立初始状态向量 $\\vec{z_0} = [x_0, y_0]$ 和积分时间区间 $[0, T]$。\n4.  使用 RHS 函数、时间区间、初始状态以及当前案例的参数集调用数值 ODE 求解器 (`scipy.integrate.solve_ivp`)。求解器计算区间上的轨迹 $\\vec{z}(t)$。\n5.  从求解器的输出中提取系统的最终状态 $\\vec{z}(T) = [x(T), y(T)]$。\n6.  通过计算差值 $x(T) - y(T)$ 并与容差 $\\tau = 10^{-3}$ 进行比较来应用表型分类器 $\\phi$。结果是一个整数：$+1$ ($x$ 占优)、$-1$ ($y$ 占优) 或 $0$ (对称)。\n7.  收集所有四个案例的分类结果，并将它们格式化为方括号内以逗号分隔的单个列表。\n\n这四个测试案例旨在探究拨动开关的不同行为：\n- 案例 1：系统参数 ($s_1, s_2, d_1, d_2, K_1, K_2$) 是完全对称的，Hill 系数 $n=2.0$ 确保了双稳态。初始状态有微小的偏向 $y$ ($y_0 = x_0 + 10^{-4}$)。在一个对称的双稳态系统中，一个小的初始不对称性通常会被放大，将系统驱动到相应的稳定状态。因此，预期会得到一个 $y$ 占优的结果 ($\\phi = -1$)。\n- 案例 2：在合成率中引入了不对称性，其中 $s_1 = 8.0$ 而 $s_2 = 6.0$，从而产生一个偏向 $x$ 占优状态的内在偏向。这种偏向与仍然略微有利于 $y$ 的初始条件相竞争。问题在于，$x$ 的更强合成是否能克服 $y$ 的初始优势。合成率的显著差异应足以迫使系统进入 $x$ 占优状态 ($\\phi = +1$)。这说明了遗传参数如何能够产生发育偏向。\n- 案例 3：在衰变率中引入了不对称性，其中 $d_1 = 2.0$ 而 $d_2 = 1.0$。$x$ 的较高衰变率不利于其积累，从而产生一个偏向 $y$ 占优状态的内在偏向。这与现在有利于 $x$ 的初始条件相竞争。两倍高的衰变率是一个强大的劣势，预计系统将解析到 $y$ 占优状态 ($\\phi = -1$)。\n- 案例 4：Hill 系数降至 $n=1.0$。对于相互抑制的拨动开关，低协同性（$n \\le 1.5 - 2$，取决于其他参数）会使双稳态消失。当 $n=1.0$ 时，系统拥有一个单一的、全局稳定的稳态。考虑到对称的参数和完全对称的初始条件 ($x_0 = y_0$)，轨迹必须在所有时间 $t \\ge 0$ 内都保持在直线 $x(t) = y(t)$ 上。最终状态将是 $x(T) = y(T)$，导致对称分类 ($\\phi = 0$)。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the gene toggle switch ODE model for four test cases and\n    classifies the phenotypic outcome.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: symmetric toggle, slight initial bias toward y\n        {'s1': 6.0, 's2': 6.0, 'd1': 1.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 2.0,\n         'x0': 0.2, 'y0': 0.2001, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n        # Case 2: asymmetric synthesis favoring x, same initial bias toward y\n        {'s1': 8.0, 's2': 6.0, 'd1': 1.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 2.0,\n         'x0': 0.2, 'y0': 0.2001, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n        # Case 3: asymmetric decay penalizing x, initial bias toward x\n        {'s1': 6.0, 's2': 6.0, 'd1': 2.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 2.0,\n         'x0': 0.2001, 'y0': 0.2, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n        # Case 4: low cooperativity, symmetric, identical initial condition\n        {'s1': 6.0, 's2': 6.0, 'd1': 1.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 1.0,\n         'x0': 0.2, 'y0': 0.2, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n    ]\n\n    def toggle_switch_rhs(t, z, s1, s2, d1, d2, K1, K2, n, A, t0, t1):\n        \"\"\"\n        Right-hand side of the ODE system for the toggle switch.\n        \n        Args:\n            t (float): Current time.\n            z (list or np.ndarray): State vector [x, y].\n            All other args are model parameters.\n        \n        Returns:\n            list: The derivatives [dx/dt, dy/dt].\n        \"\"\"\n        x, y = z\n        \n        # Environmental input u(t)\n        u_t = A if t0 = t = t1 else 0.0\n        \n        # Hill repression terms\n        repression_of_x = 1.0 + (y / K1)**n\n        repression_of_y = 1.0 + (x / K2)**n\n        \n        # ODEs\n        dxdt = (s1 / repression_of_x) - d1 * x + u_t\n        dydt = (s2 / repression_of_y) - d2 * y + u_t\n        \n        return [dxdt, dydt]\n\n    results = []\n    for case in test_cases:\n        # Initial conditions\n        z0 = [case['x0'], case['y0']]\n        \n        # Time span for integration\n        t_span = (0, case['T'])\n        \n        # Pack parameters for the solver\n        params = (case['s1'], case['s2'], case['d1'], case['d2'], \n                  case['K1'], case['K2'], case['n'], \n                  case['A'], case['t0'], case['t1'])\n        \n        # Solve the ODE\n        sol = solve_ivp(\n            fun=toggle_switch_rhs,\n            t_span=t_span,\n            y0=z0,\n            method='LSODA',  # Robust for stiff and non-stiff problems\n            args=params,\n            dense_output=False,\n            vectorized=False\n        )\n        \n        # Get final state\n        x_T, y_T = sol.y[:, -1]\n        \n        # Phenotype classification\n        diff = x_T - y_T\n        tau = case['tau']\n        \n        if diff > tau:\n            phi = 1\n        elif diff  -tau:\n            phi = -1\n        else:\n            phi = 0\n            \n        results.append(phi)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2565363"}]}