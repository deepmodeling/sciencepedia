{"hands_on_practices": [{"introduction": "植物的资源是有限的。投资于一种防御策略通常意味着用于另一种策略的资源就会减少。本练习旨在模拟这一基本限制，通过运用质量守恒定律，您将推导出一个描述两种共享同一代谢前体的防御性化合物之间此消彼长的数学关系，从而揭示基础生理学原理如何为进化策略设定严格的边界。[@problem_id:2554952]", "problem": "一种植物与特化的食草动物进行协同进化军备竞赛，它投入生产两种化学上不同的防御性毒素，分别记为 $A$ 类和 $B$ 类。这两类毒素都是由单一的限制性前体 $P$ 生物合成而来，前体 $P$ 由初级代谢以恒定速率 $J$（摩尔/单位生物量/单位时间）供应。生物合成一个 $A$ 毒素分子需要 $s_{A}$ 个 $P$ 分子，生物合成一个 $B$ 毒素分子需要 $s_{B}$ 个 $P$ 分子，其中 $s_{A} > 0$ 和 $s_{B} > 0$ 是由途径化学决定的化学计量系数。\n\n假设以下广为接受的基础：\n- 前体库的稳态质量守恒：如果细胞内 $P$ 的库很小且不累积，则其供应速率等于所有消耗途径的消耗速率之和。\n- 植物中毒素的一级损失（稀释或降解）：对于浓度为 $T_{i}$（摩尔/单位生物量）、合成通量为 $v_{i}$（摩尔/单位生物量/单位时间）、一级损失速率常数为 $d_{i} > 0$（每单位时间）的毒素 $i \\in \\{A,B\\}$，稳态满足 $T_{i} = v_{i}/d_{i}$。\n\n食草动物的压力使得同时维持两种毒素是有利的，但这两种毒素的生物合成途径竞争共享的前体 $P$。除了这两条途径外，$P$ 没有其他消耗途径，也没有 $P$ 的储存。\n\n仅使用上述原理（质量守恒和一级损失），推导两种稳态毒素水平之间的精确归一化权衡关系，该关系由无量纲变量定义：\n$$\n\\theta_{A} \\equiv \\frac{s_{A} d_{A} T_{A}}{J}\n\\quad \\text{和} \\quad\n\\theta_{B} \\equiv \\frac{s_{B} d_{B} T_{B}}{J}.\n$$\n将最终结果表示为 $\\theta_{B}$ 作为 $\\theta_{A}$ 函数的单个闭式解析表达式。不需要进行数值计算，最终表达式中不应包含任何单位。", "solution": "问题陈述经过验证，被认为是科学上可靠、良定且客观的。这是一个定量生物学中的标准问题，依赖于质量守恒的基本原理。它没有使其无效的缺陷。因此，我们可以进行推导。\n\n这个问题的核心在于将质量守恒原理应用于稳态下的前体分子 $P$。问题陈述指出，前体以恒定速率 $J$ 供应，并完全被毒素 $A$ 和 $B$ 的生物合成途径消耗，没有累积或其他消耗途径。\n\n设 $v_{A}$ 和 $v_{B}$ 分别为毒素 $A$ 和 $B$ 的合成通量，单位为摩尔/单位生物量/单位时间。一个 $A$ 毒素分子的合成需要 $s_{A}$ 个 $P$ 分子，一个 $B$ 毒素分子的合成需要 $s_{B}$ 个 $P$ 分子。因此，前体 $P$ 的总消耗速率是每个途径消耗速率的总和。因此，稳态下前体 $P$ 的质量平衡方程为：\n$$\nJ = s_{A} v_{A} + s_{B} v_{B}\n$$\n该方程表明，前体的总流入量 $J$ 必须等于流入两个生物合成途径的总流出量。\n\n接下来，我们使用提供的第二条信息：毒素本身的稳态条件。问题陈述指出，对于毒素 $i \\in \\{A, B\\}$，其浓度 $T_{i}$ 处于稳态，其中合成通量 $v_{i}$ 与速率常数为 $d_{i}$ 的一级损失过程相平衡。该关系式如下：\n$$\nT_{i} = \\frac{v_{i}}{d_{i}}\n$$\n我们可以重新整理这个表达式，以毒素浓度 $T_{i}$ 和损失速率常数 $d_{i}$ 来表示合成通量 $v_{i}$：\n$$\nv_{i} = d_{i} T_{i}\n$$\n将此应用于毒素 $A$ 和 $B$，我们得到：\n$$\nv_{A} = d_{A} T_{A}\n$$\n$$\nv_{B} = d_{B} T_{B}\n$$\n现在，我们将 $v_{A}$ 和 $v_{B}$ 的表达式代入前体质量平衡方程中：\n$$\nJ = s_{A} (d_{A} T_{A}) + s_{B} (d_{B} T_{B})\n$$\n这个方程表示了两种毒素的稳态浓度 $T_{A}$ 和 $T_{B}$ 之间的基本权衡关系，该关系由固定的总资源供应量 $J$ 决定。\n\n问题要求用归一化的无量纲变量 $\\theta_{A}$ 和 $\\theta_{B}$ 来表示该关系，其定义如下：\n$$\n\\theta_{A} \\equiv \\frac{s_{A} d_{A} T_{A}}{J}\n$$\n$$\n\\theta_{B} \\equiv \\frac{s_{B} d_{B} T_{B}}{J}\n$$\n这些变量分别表示分配给毒素 $A$ 和毒素 $B$ 合成的总前体通量 $J$ 的分数。\n\n为了将我们的权衡方程转换为这些变量，我们可以将整个方程除以恒定的总供应通量 $J$（由于 $J$ 是一个速率，它不为零）：\n$$\n\\frac{J}{J} = \\frac{s_{A} d_{A} T_{A}}{J} + \\frac{s_{B} d_{B} T_{B}}{J}\n$$\n$$\n1 = \\frac{s_{A} d_{A} T_{A}}{J} + \\frac{s_{B} d_{B} T_{B}}{J}\n$$\n通过直接代入 $\\theta_{A}$ 和 $\\theta_{B}$ 的定义，我们得到归一化的权衡关系：\n$$\n1 = \\theta_{A} + \\theta_{B}\n$$\n最后，问题要求给出 $\\theta_{B}$ 作为 $\\theta_{A}$ 函数的表达式。对上述方程进行简单的代数重排即可得到结果：\n$$\n\\theta_{B} = 1 - \\theta_{A}\n$$\n这就是归一化稳态毒素水平之间权衡的精确解析表达式。该关系是一种简单的线性权衡，是支配共享、有限前体的守恒定律的直接结果。", "answer": "$$\\boxed{1 - \\theta_{A}}$$", "id": "2554952"}, {"introduction": "“基因对基因”模型是理解植物与其天敌之间遗传“拉锯战”的经典框架。本练习将指导您推导不同植物和植食性动物基因型的适合度，并求解其协同进化平衡点。通过求解该平衡点，您将揭示植物的抗性成本（$c_{R}$）和植食性动物的毒性成本（$c_{V}$）如何共同维持一种稳定的多态性，使得攻击和防御策略得以在种群中共存。[@problem_id:2554981]", "problem": "考虑一个单倍体植物种群和一个单倍体食草动物种群，它们在“基因对基因”关系下相互作用。该植物有一个抗性基因座，其等位基因为 $R$ 和 $r$，频率分别为 $p$ 和 $1 - p$。该食草动物有一个毒力基因座，其等位基因为 $V$ 和 $v$，频率分别为 $q$ 和 $1 - q$。假设每一代中植物个体和食草动物个体之间随机相遇。\n\n假设宿主-天敌选择动态包含以下基本且广泛使用的要素：\n- 下一代的基因型频率由每个物种内各基因型的相对适应度在离散世代中决定，其中基因型适应度等于遭遇事件中的预期繁殖成功率。\n- 抗性等位基因 $R$ 给植物带来一个构成性成本 $c_{R}$，无论相遇结果如何，其中 $0  c_{R}  1$。毒力等位基因 $V$ 给食草动物带来一个构成性成本 $c_{V}$，无论相遇结果如何，其中 $0  c_{V}  1$。\n- 如果食草行为在某个植物个体上成功，该植物的适应度将乘以一个损害因子 $s$ 而降低，其中 $0  s  1$。如果食草行为失败，除了任何构成性成本外，植物不会受到损害。\n- 在“基因对基因”相互作用下，无毒力食草动物 $v$ 在 $R$ 植物上失败，在 $r$ 植物上成功；有毒力食草动物 $V$ 在 $R$ 和 $r$ 植物上均成功。\n- 成功的食草行为为食草动物带来归一化的收益 $1$（在扣除任何构成性成本之前），失败则带来收益 $0$。\n\n任务：\n1. 仅使用上述定义和假设，推导植物和食草动物的边际适应度，将其表示为 $p$、$q$、$c_{R}$、$c_{V}$ 和 $s$ 的函数。然后，推导由每个物种内的比例选择所隐含的等位基因频率递推关系 $p \\mapsto p^{\\prime}$ 和 $q \\mapsto q^{\\prime}$。\n2. 通过令每个物种内竞争等位基因的边际适应度相等，找出内部多态性平衡点 $(p^{\\ast}, q^{\\ast})$，其中 $0  p^{\\ast}  1$ 且 $0  q^{\\ast}  1$。将 $p^{\\ast}$ 和 $q^{\\ast}$ 用 $c_{R}$、$c_{V}$ 和 $s$ 以闭合形式表示，并说明内部平衡点存在所需的任何参数限制。\n\n以解析形式的行向量 $(p^{\\ast}, q^{\\ast})$ 提供最终答案。不要进行近似或四舍五入。", "solution": "首先根据所需标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- 种群：单倍体植物，单倍体食草动物。\n- 相互作用：“基因对基因”关系。\n- 植物基因座：等位基因 $R$（抗性，频率 $p$）和 $r$（易感性，频率 $1-p$）。\n- 食草动物基因座：等位基因 $V$（毒力，频率 $q$）和 $v$（无毒力，频率 $1-q$）。\n- 相遇：在每个离散世代中随机发生。\n- 适应度模型：下一代频率由相对基因型适应度（预期繁殖成功率）决定。\n- 成本和损害：\n    - 抗性 ($R$) 的构成性成本：$c_{R}$，其中 $0  c_{R}  1$。\n    - 毒力 ($V$) 的构成性成本：$c_{V}$，其中 $0  c_{V}  1$。\n    - 成功食草行为导致的植物适应度降低：乘以因子 $s$，其中 $0  s  1$。\n- 相互作用矩阵：\n    - 食草动物 $v$ 对植物 $R$：失败。\n    - 食草动物 $v$ 对植物 $r$：成功。\n    - 食草动物 $V$ 对植物 $R$：成功。\n    - 食草动物 $V$ 对植物 $r$：成功。\n- 食草动物收益：\n    - 成功的食草行为：归一化收益为 $1$（扣除成本前）。\n    - 失败的食草行为：收益为 $0$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个经典的“基因对基因”模型，这是协演化动态研究中的一个基本概念。它在科学上是合理的，并基于群体遗传学的既定原则。\n- **适定性**：该问题定义清晰，包含了所有必要的参数和相互作用规则。它要求进行标准分析：推导适应度函数、递推关系以及确定内部平衡点。其结构允许得出唯一且有意义的解。\n- **客观性**：问题陈述精确、量化，并且没有主观或模棱两可的语言。\n\n**结论：** 该问题有效。这是一个在理论生物学中被良好表述的问题，可以使用标准的数学方法解决。\n\n**任务1：适应度和递推关系的推导**\n\n设 $W_R$ 和 $W_r$ 分别为植物等位基因 $R$ 和 $r$ 的边际适应度。设 $W_V$ 和 $W_v$ 分别为食草动物等位基因 $V$ 和 $v$ 的边际适应度。由于种群是单倍体，基因型适应度等同于等位基因的边际适应度。我们将两个物种的基准适应度归一化为 $1$。\n\n**植物适应度**\n植物的适应度由其基因型以及与每种食草动物类型相遇的概率决定。\n- **等位基因 $R$ 的适应度 ($W_R$)**：带有等位基因 $R$ 的植物会产生构成性成本 $c_{R}$，使其基准适应度降至 $1-c_{R}$。它有 $q$ 的概率遇到有毒力的食草动物 ($V$)，导致食草成功，适应度进一步乘以因子 $s$ 而降低。它有 $1-q$ 的概率遇到无毒力的食草动物 ($v$)，食草行为失败，因此没有进一步的适应度降低。预期适应度为：\n$$W_{R} = q \\cdot (1-c_{R})(1-s) + (1-q) \\cdot (1-c_{R}) = (1-c_{R}) [q(1-s) + (1-q)] = (1-c_{R})(1-qs)$$\n- **等位基因 $r$ 的适应度 ($W_r$)**：带有等位基因 $r$ 的植物不承担抗性成本。然而，有毒力 ($V$) 和无毒力 ($v$) 的食草动物都能成功侵害它。因此，它在每次相遇时总会遭受 $s$ 的损害。预期适应度为：\n$$W_{r} = 1-s$$\n植物种群的平均适应度为 $\\bar{W}_{\\text{plant}} = p W_{R} + (1-p) W_{r}$。$R$ 等位基因频率的递推关系 $p' = p \\frac{W_R}{\\bar{W}_{\\text{plant}}}$ 为：\n$$p^{\\prime} = \\frac{p(1-c_{R})(1-qs)}{p(1-c_{R})(1-qs) + (1-p)(1-s)}$$\n\n**食草动物适应度**\n食草动物的适应度由其从相遇中获得的预期收益减去任何构成性成本决定。\n- **等位基因 $V$ 的适应度 ($W_V$)**：带有等位基因 $V$ 的食草动物是有毒力的，因此在 $R$ 和 $r$ 植物上都能成功。其预期收益为 $1$。它会产生构成性成本 $c_{V}$。我们将其适应度建模为预期收益减去成本。\n$$W_{V} = (p \\cdot 1 + (1-p) \\cdot 1) - c_V = 1 - c_{V}$$\n- **等位基因 $v$ 的适应度 ($W_v$)**：带有等位基因 $v$ 的食草动物是无毒力的。它在 $R$ 植物上失败（收益 $0$），在 $r$ 植物上成功（收益 $1$）。它不承担成本。其预期适应度为：\n$$W_{v} = p \\cdot 0 + (1-p) \\cdot 1 = 1-p$$\n食草动物种群的平均适应度为 $\\bar{W}_{\\text{herb}} = q W_{V} + (1-q) W_{v}$。$V$ 等位基因频率的递推关系 $q' = q \\frac{W_V}{\\bar{W}_{\\text{herb}}}$ 为：\n$$q^{\\prime} = \\frac{q(1-c_{V})}{q(1-c_{V}) + (1-q)(1-p)}$$\n\n**任务2：内部多态性平衡点的确定**\n\n一个内部多态性平衡点 $(p^{\\ast}, q^{\\ast})$ 是指等位基因频率在世代间保持不变（$p' = p$ 且 $q' = q$）且满足 $0  p^{\\ast}  1$ 和 $0  q^{\\ast}  1$ 的状态。这种情况发生在每个物种内部竞争等位基因的边际适应度相等时。\n\n**食草动物多态性条件 ($W_V = W_v$)**\n为了使食草动物种群在两种等位基因都存在的情况下达到平衡（$0  q^*  1$），$V$ 和 $v$ 等位基因的适应度必须相等。\n$$W_{V} = W_{v}$$\n$$1 - c_{V} = 1 - p^{\\ast}$$\n求解 $p^{\\ast}$ 可得植物种群中抗性等位基因的平衡频率：\n$$p^{\\ast} = c_{V}$$\n\n**植物多态性条件 ($W_R = W_r$)**\n为了使植物种群在两种等位基因都存在的情况下达到平衡（$0  p^*  1$），$R$ 和 $r$ 等位基因的适应度必须相等。\n$$W_{R} = W_{r}$$\n$$(1-c_{R})(1-q^{\\ast}s) = 1-s$$\n我们求解 $q^{\\ast}$，即食草动物种群中毒力等位基因的平衡频率。\n$$1-q^{\\ast}s = \\frac{1-s}{1-c_{R}}$$\n$$q^{\\ast}s = 1 - \\frac{1-s}{1-c_{R}}$$\n$$q^{\\ast}s = \\frac{(1-c_{R}) - (1-s)}{1-c_{R}} = \\frac{1-c_{R}-1+s}{1-c_{R}} = \\frac{s-c_{R}}{1-c_{R}}$$\n$$q^{\\ast} = \\frac{s-c_{R}}{s(1-c_{R})}$$\n\n**内部平衡点的存在条件**\n平衡点 $(p^{\\ast}, q^{\\ast})$ 只有在 $0  p^{\\ast}  1$ 和 $0  q^{\\ast}  1$ 时才具有生物学意义。\n1.  对于 $p^{\\ast}$：我们要求 $0  p^{\\ast}  1$，这意味着 $0  c_{V}  1$。这个条件在问题陈述中已经给出。\n2.  对于 $q^{\\ast}$：我们要求 $0  q^{\\ast}  1$。\n    - 分母 $s(1-c_{R})$ 总是正数，因为 $0  s  1$ 且 $0  c_{R}  1$。\n    - 条件 $q^{\\ast} > 0$ 要求分子为正：$s - c_{R} > 0$，即 $s > c_{R}$。这意味着食草行为造成的损害必须超过抗性成本。\n    - 条件 $q^{\\ast}  1$ 要求 $\\frac{s-c_{R}}{s(1-c_{R})}  1$。这意味着 $s-c_{R}  s(1-c_{R})$，可简化为 $s-c_{R}  s - s c_{R}$。这进一步简化为 $-c_{R}  -s c_{R}$。由于 $c_R > 0$，我们可以除以 $-c_R$ 并反转不等号，得到 $1 > s$。这个条件也在问题陈述中给出。\n\n因此，唯一内部多态性平衡点存在的唯一参数限制是 $s > c_{R}$。\n\n内部多态性平衡点由数对 $(p^{\\ast}, q^{\\ast})$ 给出。\n$$p^{\\ast} = c_{V}$$\n$$q^{\\ast} = \\frac{s-c_{R}}{s(1-c_{R})}$$\n这个点代表了一种协演化平衡，其中植物的抗性频率由食草动物的毒力成本决定，而食草动物的毒力频率由植物抗性成本和食草损害之间的权衡决定。", "answer": "$$ \\boxed{ \\begin{pmatrix} c_{V}  \\frac{s - c_{R}}{s(1 - c_{R})} \\end{pmatrix} } $$", "id": "2554981"}, {"introduction": "本练习超越了静态平衡点的分析，要求您模拟数量性状的动态协同进化轨迹。您将运用数量遗传学中的兰德方程（Lande equation），构建一个植物与植食性动物相互作用的确定性模型。这项动手计算实践将展示遗传结构（$\\mathbf{G}$ 矩阵）和选择压力如何共同驱动性状随时间演化，为连接理论模型与连续的进化过程搭建了一座有力的桥梁。[@problem_id:2555040]", "problem": "你需要使用数量遗传学来构建一个植物-食草动物拮抗相互作用的确定性协同进化模拟。其基本依据是数量遗传学中的 Lande 方程：每一代，数量性状向量均值的变化等于作用于选择梯度的加性遗传方差-协方差。假设植物和食草动物各有两种连续性状。使用以下定义和假设作为起点。\n\n从 Fisher 无穷小模型和 Lande 方程开始：对于任何平均性状向量为 $\\mathbf{z} \\in \\mathbb{R}^{2}$ 的物种，其每代响应为 $\\Delta \\mathbf{z} = \\mathbf{G} \\, \\boldsymbol{\\beta}$，其中 $\\mathbf{G} \\in \\mathbb{R}^{2 \\times 2}$ 是加性遗传方差-协方差（G）矩阵，$\\boldsymbol{\\beta} \\in \\mathbb{R}^{2}$ 是作用于平均性状的选择梯度。\n\n通过对食草动物和植物性状之间的失配进行线性定向选择，并结合对各物种自身性状的稳定性选择，来模拟拮抗协同进化。设植物的平均性状向量为 $\\mathbf{z}_{p} \\in \\mathbb{R}^{2}$，食草动物的平均性状向量为 $\\mathbf{z}_{h} \\in \\mathbb{R}^{2}$。设相互作用映射为 $\\mathbf{M} \\in \\mathbb{R}^{2 \\times 2}$。定义失配为 $\\mathbf{m} = \\mathbf{z}_{h} - \\mathbf{M} \\mathbf{z}_{p}$。选择机制由四个正标量指定：$b_{p}$ 和 $b_{h}$ 分别控制植物和食草动物性状的拮抗定向选择，$s_{p}$ 和 $s_{h}$ 分别控制其稳定性选择强度。选择梯度为\n$\\boldsymbol{\\beta}_{h} = b_{h} \\, \\mathbf{m} - s_{h} \\, \\mathbf{z}_{h}$ 和 $\\boldsymbol{\\beta}_{p} = - b_{p} \\, \\mathbf{M}^{\\top} \\mathbf{m} - s_{p} \\, \\mathbf{z}_{p}$。\n假设所有适用的矩阵都是对称的，并且所有参数作为实值标量和矩阵在生物学上是合理的。\n\n使用 $\\mathbf{z}_{h}^{(t+1)} = \\mathbf{z}_{h}^{(t)} + \\mathbf{G}_{h} \\, \\boldsymbol{\\beta}_{h}^{(t)}$ 和 $\\mathbf{z}_{p}^{(t+1)} = \\mathbf{z}_{p}^{(t)} + \\mathbf{G}_{p} \\, \\boldsymbol{\\beta}_{p}^{(t)}$ 模拟 $T$ 代的离散时间动力学，初始值为 $\\mathbf{z}_{h}^{(0)}$ 和 $\\mathbf{z}_{p}^{(0)}$。系统中没有随机性；这是一个纯粹的确定性递归。\n\n实现一个程序，对每个测试用例，计算最终的平均性状向量 $\\mathbf{z}_{p}^{(T)}$ 和 $\\mathbf{z}_{h}^{(T)}$，并将它们连接并展平为 $[\\mathbf{z}_{p,1}^{(T)}, \\mathbf{z}_{p,2}^{(T)}, \\mathbf{z}_{h,1}^{(T)}, \\mathbf{z}_{h,2}^{(T)}]$ 的形式输出。将每个值四舍五入到 $6$ 位小数。不涉及物理单位。\n\n使用以下测试套件（每个用例提供 $\\mathbf{G}_{p}$、$\\mathbf{G}_{h}$、$\\mathbf{M}$、$b_{p}$、$b_{h}$、$s_{p}$、$s_{h}$、$\\mathbf{z}_{p}^{(0)}$、$\\mathbf{z}_{h}^{(0)}$ 和 $T$）：\n\n- 用例 A（一般拮抗协同进化，中等协方差）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.08  0.02 \\\\ 0.02  0.05 \\end{bmatrix}$，\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.06  0.01 \\\\ 0.01  0.07 \\end{bmatrix}$，\n    $\\mathbf{M} = \\begin{bmatrix} 1.0  0.3 \\\\ 0.2  0.9 \\end{bmatrix}$，\n    $b_{p} = 0.5$，$b_{h} = 0.5$，$s_{p} = 0.1$，$s_{h} = 0.1$，\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} 0.2 \\\\ 0.1 \\end{bmatrix}$，\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} 0.1 \\\\ 0.3 \\end{bmatrix}$，\n    $T = 50$。\n\n- 用例 B（边界条件：零代）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.08  0.02 \\\\ 0.02  0.05 \\end{bmatrix}$，\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.06  0.01 \\\\ 0.01  0.07 \\end{bmatrix}$，\n    $\\mathbf{M} = \\begin{bmatrix} 1.0  0.3 \\\\ 0.2  0.9 \\end{bmatrix}$，\n    $b_{p} = 0.5$，$b_{h} = 0.5$，$s_{p} = 0.1$，$s_{h} = 0.1$，\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} 0.4 \\\\ -0.2 \\end{bmatrix}$，\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} -0.1 \\\\ 0.0 \\end{bmatrix}$，\n    $T = 0$。\n\n- 用例 C（食草动物某一性状的近奇异响应）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.01  0.0 \\\\ 0.0  0.01 \\end{bmatrix}$，\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.0001  0.0 \\\\ 0.0  0.02 \\end{bmatrix}$，\n    $\\mathbf{M} = \\begin{bmatrix} 1.0  0.0 \\\\ 0.0  1.0 \\end{bmatrix}$，\n    $b_{p} = 0.3$，$b_{h} = 0.6$，$s_{p} = 0.2$，$s_{h} = 0.2$，\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} 0.5 \\\\ 0.5 \\end{bmatrix}$，\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} 0.4 \\\\ 0.1 \\end{bmatrix}$，\n    $T = 100$。\n\n- 用例 D（强拮抗作用和强稳定性选择）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.05  -0.015 \\\\ -0.015  0.04 \\end{bmatrix}$，\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.07  0.02 \\\\ 0.02  0.05 \\end{bmatrix}$，\n    $\\mathbf{M} = \\begin{bmatrix} 0.8  0.2 \\\\ 0.4  1.2 \\end{bmatrix}$，\n    $b_{p} = 1.5$，$b_{h} = 1.5$，$s_{p} = 0.8$，$s_{h} = 0.8$，\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} -0.2 \\\\ 0.2 \\end{bmatrix}$，\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} 0.0 \\\\ -0.1 \\end{bmatrix}$，\n    $T = 30$。\n\n你的程序应严格按照规定实现确定性递归，为每个用例独立执行模拟，并生成单行输出，其中包含所有连接成一个扁平列表的结果，每个浮点数四舍五入到 $6$ 位小数，并用方括号括起来。例如，格式必须像 $[\\text{result}_{1},\\text{result}_{2},\\ldots]$，其中序列是用例 A、用例 B、用例 C 和用例 D 的四维向量按此顺序连接而成。", "solution": "问题陈述已经过验证，被认为是具有科学依据、提法明确且客观的。它描述了一个基于数量遗传学基础 Lande 方程的拮抗协同进化确定性模拟。所有参数、初始条件和控制方程都以数学精度指定，从而允许一个唯一且可计算的解。因此，可以继续进行求解。\n\n该模型描述了两个物种（一种植物和一种食草动物）的协同进化，每个物种由一个二维平均性状向量表征，分别表示为 $\\mathbf{z}_{p} \\in \\mathbb{R}^{2}$ 和 $\\mathbf{z}_{h} \\in \\mathbb{R}^{2}$。这些性状在离散世代中的演化由 Lande 方程控制，该方程指出，每代的选择响应是加性遗传方差-协方差矩阵 $\\mathbf{G}$ 和选择梯度向量 $\\boldsymbol{\\beta}$ 的乘积。\n\n动力学由以下离散时间递归给出：\n$$ \\mathbf{z}_{p}^{(t+1)} = \\mathbf{z}_{p}^{(t)} + \\Delta \\mathbf{z}_{p}^{(t)} = \\mathbf{z}_{p}^{(t)} + \\mathbf{G}_{p} \\, \\boldsymbol{\\beta}_{p}^{(t)} $$\n$$ \\mathbf{z}_{h}^{(t+1)} = \\mathbf{z}_{h}^{(t)} + \\Delta \\mathbf{z}_{h}^{(t)} = \\mathbf{z}_{h}^{(t)} + \\mathbf{G}_{h} \\, \\boldsymbol{\\beta}_{h}^{(t)} $$\n其中 $t$ 是世代数，$\\mathbf{G}_{p}$ 和 $\\mathbf{G}_{h}$ 是植物和食草动物的恒定加性遗传方差-协方差矩阵，$\\boldsymbol{\\beta}_{p}^{(t)}$ 和 $\\boldsymbol{\\beta}_{h}^{(t)}$ 是在第 $t$ 代的选择梯度。\n\n选择梯度来自两个来源：由性状间失配驱动的拮抗选择，以及对各物种自身性状的稳定性选择。失配向量 $\\mathbf{m}$ 定义为食草动物的性状与由相互作用矩阵 $\\mathbf{M} \\in \\mathbb{R}^{2 \\times 2}$ 介导的、被食草动物感知的植物性状之间的差异：\n$$ \\mathbf{m}^{(t)} = \\mathbf{z}_{h}^{(t)} - \\mathbf{M} \\mathbf{z}_{p}^{(t)} $$\n\n然后，食草动物和植物的选择梯度公式化为：\n$$ \\boldsymbol{\\beta}_{h}^{(t)} = b_{h} \\, \\mathbf{m}^{(t)} - s_{h} \\, \\mathbf{z}_{h}^{(t)} $$\n$$ \\boldsymbol{\\beta}_{p}^{(t)} = - b_{p} \\, \\mathbf{M}^{\\top} \\mathbf{m}^{(t)} - s_{p} \\, \\mathbf{z}_{p}^{(t)} $$\n这里，$b_{h}  0$ 和 $b_{p}  0$ 是来自拮抗相互作用的定向选择系数，而 $s_{h}  0$ 和 $s_{p}  0$ 是稳定性选择的系数。$\\boldsymbol{\\beta}_{p}$ 中的负号和转置 $\\mathbf{M}^{\\top}$ 反映了拮抗选择压力的相互性。\n\n问题要求从初始条件 $\\mathbf{z}_{p}^{(0)}$ 和 $\\mathbf{z}_{h}^{(0)}$ 开始，计算经过 $T$ 代后的最终性状向量 $\\mathbf{z}_{p}^{(T)}$ 和 $\\mathbf{z}_{h}^{(T)}$。解是通过对该方程组进行直接数值模拟获得的。对于从 $0$ 到 $T-1$ 的每一代 $t$，执行以下计算序列：\n$1$. 使用当前的性状向量 $\\mathbf{z}_{p}^{(t)}$ 和 $\\mathbf{z}_{h}^{(t)}$ 计算失配向量 $\\mathbf{m}^{(t)}$。\n$2$. 基于 $\\mathbf{m}^{(t)}$ 和当前性状向量计算选择梯度 $\\boldsymbol{\\beta}_{p}^{(t)}$ 和 $\\boldsymbol{\\beta}_{h}^{(t)}$。\n$3$. 确定每个物种的进化响应（性状变化），$\\Delta \\mathbf{z}_{p}^{(t)} = \\mathbf{G}_{p} \\boldsymbol{\\beta}_{p}^{(t)}$ 和 $\\Delta \\mathbf{z}_{h}^{(t)} = \\mathbf{G}_{h} \\boldsymbol{\\beta}_{h}^{(t)}$。\n$4$. 更新平均性状向量以获得下一代的状态：$\\mathbf{z}_{p}^{(t+1)} = \\mathbf{z}_{p}^{(t)} + \\Delta \\mathbf{z}_{p}^{(t)}$ 和 $\\mathbf{z}_{h}^{(t+1)} = \\mathbf{z}_{h}^{(t)} + \\Delta \\mathbf{z}_{h}^{(t)}$。\n\n这个迭代过程会执行指定的世代数 $T$。对于 $T=0$ 的特殊情况，不执行任何迭代，最终状态与初始状态相同，即 $\\mathbf{z}_{p}^{(0)}$ 和 $\\mathbf{z}_{h}^{(0)}$。\n\n实现将独立处理每个测试用例。对于每个用例，给定的参数（$\\mathbf{G}_p, \\mathbf{G}_h, \\mathbf{M}, b_p, b_h, s_p, s_h, \\mathbf{z}_{p}^{(0)}, \\mathbf{z}_{h}^{(0)}, T$）将用于初始化和运行模拟。最终向量 $\\mathbf{z}_{p}^{(T)}$ 和 $\\mathbf{z}_{h}^{(T)}$ 被连接成一个单一的 $4$ 分量向量 $[\\mathbf{z}_{p,1}^{(T)}, \\mathbf{z}_{p,2}^{(T)}, \\mathbf{z}_{h,1}^{(T)}, \\mathbf{z}_{h,2}^{(T)}]$，每个分量按要求四舍五入到 $6$ 位小数。然后将所有测试用例的结果汇总到一个扁平列表中作为最终输出。所有的矩阵和向量代数将使用 `numpy` 库来处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the coevolutionary dynamics problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Case A: general antagonistic coevolution, moderate covariances\n            \"Gp\": np.array([[0.08, 0.02], [0.02, 0.05]]),\n            \"Gh\": np.array([[0.06, 0.01], [0.01, 0.07]]),\n            \"M\": np.array([[1.0, 0.3], [0.2, 0.9]]),\n            \"bp\": 0.5, \"bh\": 0.5, \"sp\": 0.1, \"sh\": 0.1,\n            \"zp0\": np.array([0.2, 0.1]),\n            \"zh0\": np.array([0.1, 0.3]),\n            \"T\": 50\n        },\n        {\n            # Case B: boundary condition: zero generations\n            \"Gp\": np.array([[0.08, 0.02], [0.02, 0.05]]),\n            \"Gh\": np.array([[0.06, 0.01], [0.01, 0.07]]),\n            \"M\": np.array([[1.0, 0.3], [0.2, 0.9]]),\n            \"bp\": 0.5, \"bh\": 0.5, \"sp\": 0.1, \"sh\": 0.1,\n            \"zp0\": np.array([0.4, -0.2]),\n            \"zh0\": np.array([-0.1, 0.0]),\n            \"T\": 0\n        },\n        {\n            # Case C: nearly singular response in one herbivore trait\n            \"Gp\": np.array([[0.01, 0.0], [0.0, 0.01]]),\n            \"Gh\": np.array([[0.0001, 0.0], [0.0, 0.02]]),\n            \"M\": np.array([[1.0, 0.0], [0.0, 1.0]]),\n            \"bp\": 0.3, \"bh\": 0.6, \"sp\": 0.2, \"sh\": 0.2,\n            \"zp0\": np.array([0.5, 0.5]),\n            \"zh0\": np.array([0.4, 0.1]),\n            \"T\": 100\n        },\n        {\n            # Case D: strong antagonism and strong stabilizing selection\n            \"Gp\": np.array([[0.05, -0.015], [-0.015, 0.04]]),\n            \"Gh\": np.array([[0.07, 0.02], [0.02, 0.05]]),\n            \"M\": np.array([[0.8, 0.2], [0.4, 1.2]]),\n            \"bp\": 1.5, \"bh\": 1.5, \"sp\": 0.8, \"sh\": 0.8,\n            \"zp0\": np.array([-0.2, 0.2]),\n            \"zh0\": np.array([0.0, -0.1]),\n            \"T\": 30\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Gp, Gh, M = case[\"Gp\"], case[\"Gh\"], case[\"M\"]\n        bp, bh, sp, sh = case[\"bp\"], case[\"bh\"], case[\"sp\"], case[\"sh\"]\n        zp, zh = case[\"zp0\"], case[\"zh0\"]\n        T = case[\"T\"]\n        \n        # Perform the deterministic simulation for T generations\n        for _ in range(T):\n            # Calculate mismatch\n            m = zh - (M @ zp)\n            \n            # Calculate selection gradients\n            beta_h = bh * m - sh * zh\n            beta_p = -bp * (M.T @ m) - sp * zp\n            \n            # Update trait vectors\n            zp = zp + (Gp @ beta_p)\n            zh = zh + (Gh @ beta_h)\n\n        # Concatenate and flatten the final trait vectors\n        final_vector = np.concatenate((zp, zh))\n        \n        # Round the results to 6 decimal places\n        rounded_vector = np.round(final_vector, 6)\n        \n        all_results.extend(rounded_vector.tolist())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2555040"}]}