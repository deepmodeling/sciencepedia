{"hands_on_practices": [{"introduction": "在野外研究中，能够根据可观察的特征快速准确地对植物器官进行分类是一项基本技能。本练习将引导你构建一个二歧分类检索表，这是一个系统性的工具，用于区分四种基本的果实类型。通过这个思维实验，你将深化对果实形态学关键定义（如肉质与干质，开裂与闭果）的理解，并锻炼严谨的逻辑推理能力。", "problem": "您正在进行一项季末调查，调查样带沿线被子植物的果序，该样带跨越了一个落叶林地和草地之间的群落交错区。您必须构建一个二歧分类检索表，将遇到的任何成熟果实分类到由两个正交轴定义的四个组合类别之一：干果与肉果，以及开裂果与不开裂果。您仅限于使用野外可观察的果实性状，这些性状可以通过非破坏性方式或通过检查母本植物下方自然脱落的果实来评分。作为基本依据，请使用以下核心定义和事实：如果果实在成熟时沿预成形的线裂开以释放种子，则为开裂果；如果不裂开，则为不开裂果。如果果皮是薄壁组织的并且在成熟时保留大量水分，则为肉果；如果果皮是非薄壁组织的或在成熟时自由水分极少，则为干果。这些定义源于标准的形态植物学，并广泛适用于被子植物。种子传播综合征通常与这些类别相关（例如，肉质不开裂果经常表现出动物内传播），但传播方式不能直接用作分类性状。\n\n您被精确地提供了四个可观察性状，每个性状都应在同一植物的多个成熟果实上进行评分，以避免特殊变异：\n\n- 性状 $\\mathcal{A}$：轻轻挤压一个成熟、完整的果实，果皮中很容易挤出自由水状汁液。\n- 性状 $\\mathcal{B}$：种子在成熟时直接包埋在柔软的薄壁组织中，而不是游离在一个空腔内。\n- 性状 $\\mathcal{C}$：果实在成熟时沿预成形的线（缝线或孔）裂开以释放种子；如果植物上的多个成熟果实表现出明显的裂口或瓣，则此项记为存在。\n- 性状 $\\mathcal{D}$：整个果实在成熟时通常完整脱落，并在地面上被发现，且没有证据表明在附着于母体时已经裂开。\n\n请选择下面的二歧分类检索表，该表仅使用这四个性状，正确且无歧义地将任何遇到的成熟果实分类到四个目标类别之一，同时遵循基本定义。每个对句都应按可观察状态进行划分，并导向正确的终端类别。\n\nA.\n$1$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 转到 $2$。\n$1$b. $\\mathcal{C}$ 不存在且 $\\mathcal{D}$ 存在 $\\rightarrow$ 转到 $3$。\n$2$a. $\\mathcal{A}$ 存在且 $\\mathcal{B}$ 存在 $\\rightarrow$ 肉质开裂果。\n$2$b. $\\mathcal{A}$ 不存在且 $\\mathcal{B}$ 不存在 $\\rightarrow$ 干性开裂果。\n$3$a. $\\mathcal{A}$ 存在且 $\\mathcal{B}$ 存在 $\\rightarrow$ 肉质不开裂果。\n$3$b. $\\mathcal{A}$ 不存在且 $\\mathcal{B}$ 不存在 $\\rightarrow$ 干性不开裂果。\n\nB.\n$1$a. $\\mathcal{A}$ 存在 $\\rightarrow$ 转到 $2$。\n$1$b. $\\mathcal{A}$ 不存在 $\\rightarrow$ 转到 $3$。\n$2$a. $\\mathcal{D}$ 存在 $\\rightarrow$ 肉质开裂果。\n$2$b. $\\mathcal{D}$ 不存在 $\\rightarrow$ 肉质不开裂果。\n$3$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 干性不开裂果。\n$3$b. $\\mathcal{C}$ 不存在 $\\rightarrow$ 干性开裂果。\n\nC.\n$1$a. 果实颜色鲜艳或对人有强烈气味 $\\rightarrow$ 转到 $2$。\n$1$b. 果实颜色暗淡且对人无明显气味 $\\rightarrow$ 转到 $3$。\n$2$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 肉质不开裂果。\n$2$b. $\\mathcal{C}$ 不存在 $\\rightarrow$ 肉质开裂果。\n$3$a. $\\mathcal{D}$ 存在 $\\rightarrow$ 干性不开裂果。\n$3$b. $\\mathcal{D}$ 不存在 $\\rightarrow$ 干性开裂果。\n\nD.\n$1$a. $\\mathcal{B}$ 存在 $\\rightarrow$ 转到 $2$。\n$1$b. $\\mathcal{B}$ 不存在 $\\rightarrow$ 转到 $3$。\n$2$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 肉质不开裂果。\n$2$b. $\\mathcal{C}$ 不存在 $\\rightarrow$ 肉质开裂果。\n$3$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 干性开裂果。\n$3$b. $\\mathcal{C}$ 不存在 $\\rightarrow$ 干性不开裂果。\n\n选择唯一最佳选项。", "solution": "在尝试任何解答之前，必须首先验证问题陈述的科学合理性、清晰性和完整性。\n\n**第一步：提取已知条件**\n\n问题要求选择一个正确的二歧分类检索表，以根据两个轴将成熟果实分为四类：（1）干性与肉质，（2）开裂与不开裂。\n\n核心定义：\n*   **开裂果**：在成熟时沿预成形的线裂开以释放种子。\n*   **不开裂果**：在成熟时不裂开。\n*   **肉果**：果皮是薄壁组织的，并在成熟时保留大量水分。\n*   **干果**：果皮是非薄壁组织的，或在成熟时自由水分极少。\n\n目标类别：\n1.  肉质开裂果\n2.  肉质不开裂果\n3.  干性开裂果\n4.  干性不开裂果\n\n可观察性状（仅限于这四个）：\n*   性状 $\\mathcal{A}$：轻轻挤压一个成熟、完整的果实，果皮中很容易挤出自由水状汁液。\n*   性状 $\\mathcal{B}$：种子在成熟时直接包埋在柔软的薄壁组织中，而不是游离在一个空腔内。\n*   性状 $\\mathcal{C}$：果实在成熟时沿预成形的线（缝线或孔）裂开；如果植物上的多个成熟果实表现出明显的裂口或瓣，则此项记为存在。\n*   性状 $\\mathcal{D}$：整个果实在成熟时通常完整脱落，并在地面上被发现，且没有证据表明在附着于母体时已经裂开。\n\n约束条件：\n*   检索表必须是二歧的。\n*   它必须仅使用性状 $\\mathcal{A}$、$\\mathcal{B}$、$\\mathcal{C}$ 和 $\\mathcal{D}$。\n*   它必须正确且无歧义地将任何成熟果实分类到四个目标类别之一。\n\n**第二步：使用提取的已知条件进行验证**\n\n该问题在科学上基于形态植物学的标准原理。所提供的果实类型定义是正确的。四个可观察性状（$\\mathcal{A}$、$\\mathcal{B}$、$\\mathcal{C}$、$\\mathcal{D}$）被设计为正式定义的实用、野外可观察的代理指标：\n*   性状 $\\mathcal{C}$ 是对**开裂**这一决定性特征的直接观察。其不存在表示**不开裂**。\n*   性状 $\\mathcal{D}$ 描述了**不开裂**果实的典型结局，可作为一种确认性状。一个用于传播种子的不开裂果，必须作为一个整体从母本植物上脱落。\n*   性状 $\\mathcal{A}$（存在自由水分）和 $\\mathcal{B}$（存在柔软的薄壁组织）是对定义**肉果**的两个组成部分的直接观察。两者皆无是**干果**的强有力指标。\n\n问题提取得很好，提供了一个明确的目标、一组受限的工具（四个性状）和一组待评估的候选解决方案（四个检索表）。它是客观且自成体系的。问题设置本身没有科学或逻辑上的矛盾。\n\n**第三步：结论与行动**\n\n问题陈述是有效的。我将通过评估每个提议的检索表来推导出正确答案。\n\n**正确分类逻辑的推导**\n\n必须根据提供的定义和性状建立一个逻辑映射。\n*   **开裂与不开裂轴**：最直接、最明确的性状是 $\\mathcal{C}$。\n    *   如果 $\\mathcal{C}$ 存在，则果实是开裂的。\n    *   如果 $\\mathcal{C}$ 不存在，则果实是不开裂的。性状 $\\mathcal{D}$（完整果实脱落）是大多数不开裂果实的必然结果，因此可作为一个有用的核对。\n*   **肉质与干性轴**：肉质的定义要求同时具有薄壁组织和水分。一个稳健的分类应同时使用这两个代理指标。\n    *   如果 $\\mathcal{A}$ 存在 且 $\\mathcal{B}$ 存在，则果实是肉质的。\n    *   如果果实缺乏这些特性，则为干果。为了得到一个无歧义的检索表，其反面最为可靠：如果 $\\mathcal{A}$ 不存在 且 $\\mathcal{B}$ 不存在，则果实是干性的。\n\n这些逻辑联系将用于分析所提供的选项。\n\n**逐项分析**\n\n**选项 A：**\n$1$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 转到 $2$。（这正确地将果实识别为开裂果。）\n$1$b. $\\mathcal{C}$ 不存在且 $\\mathcal{D}$ 存在 $\\rightarrow$ 转到 $3$。（这正确地将果实识别为不开裂果。同时使用性状 $\\mathcal{C}$ 和 $\\mathcal{D}$ 提供了一个稳健的条件。）\n$2$a. $\\mathcal{A}$ 存在且 $\\mathcal{B}$ 存在 $\\rightarrow$ 肉质开裂果。（从 $1$a 开始，此分支用于开裂果。条件“$\\mathcal{A}$ 存在且 $\\mathcal{B}$ 存在”正确地将果实识别为肉质。分类是正确的。）\n$2$b. $\\mathcal{A}$ 不存在且 $\\mathcal{B}$ 不存在 $\\rightarrow$ 干性开裂果。（从 $1$a 开始，此分支用于开裂果。条件“$\\mathcal{A}$ 不存在且 $\\mathcal{B}$ 不存在”正确地将果实识别为干性。分类是正确的。）\n$3$a. $\\mathcal{A}$ 存在且 $\\mathcal{B}$ 存在 $\\rightarrow$ 肉质不开裂果。（从 $1$b 开始，此分支用于不开裂果。条件“$\\mathcal{A}$ 存在且 $\\mathcal{B}$ 存在”正确地将果实识别为肉质。分类是正确的。）\n$3$b. $\\mathcal{A}$ 不存在且 $\\mathcal{B}$ 不存在 $\\rightarrow$ 干性不开裂果。（从 $1$b 开始，此分支用于不开裂果。条件“$\\mathcal{A}$ 不存在且 $\\mathcal{B}$ 不存在”正确地将果实识别为干性。分类是正确的。）\n\n该检索表首先根据开裂/不开裂做出了一个逻辑上的主要划分，然后正确地使用其余性状来确定肉质/干性。所有四个终端分类都是通过逻辑上合理的路径达成的。\n结论：**正确**。\n\n**选项 B：**\n$1$a. $\\mathcal{A}$ 存在 $\\rightarrow$ 转到 $2$。\n$1$b. $\\mathcal{A}$ 不存在 $\\rightarrow$ 转到 $3$。\n该检索表首先尝试仅用性状 $\\mathcal{A}$ 来按肉质/干性轴对果实进行分离，这是一个比使用 $\\mathcal{C}$ 更弱的初始选择。\n$2$a. $\\mathcal{D}$ 存在 $\\rightarrow$ 肉质开裂果。（性状 $\\mathcal{D}$，即完整脱落，是**不开裂**果的标志。该检索表却得出果实是开裂果的结论。这是一个逻辑矛盾。）\n$2$b. $\\mathcal{D}$ 不存在 $\\rightarrow$ 肉质不开裂果。（性状 $\\mathcal{D}$ 不存在，即不完整脱落，是那些在植株上裂开以释放种子的果实的特征，即**开裂**果。该检索表却得出果实是不开裂果的结论。这是一个逻辑矛盾。）\n$3$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 干性不开裂果。（性状 $\\mathcal{C}$，即沿缝线裂开，是**开裂**的定义。该检索表却得出果实是不开裂果的结论。这是一个直接的矛盾。）\n$3$b. $\\mathcal{C}$ 不存在 $\\rightarrow$ 干性开裂果。（性状 $\\mathcal{C}$ 不存在是**不开裂**的定义。该检索表却得出果实是开裂果的结论。这是一个直接的矛盾。）\n这个检索表在根本上是有缺陷的，存在多个逻辑矛盾。\n结论：**错误**。\n\n**选项 C：**\n$1$a. 果实颜色鲜艳或对人有强烈气味 $\\rightarrow$ 转到 $2$。\n此对句引入了“颜色鲜艳”、“有强烈气味”等性状，这些不属于四个允许的性状（$\\mathcal{A}$、$\\mathcal{B}$、$\\mathcal{C}$、$\\mathcal{D}$）。这违反了问题陈述的一个主要约束。此外，这类性状是主观的，并与传播综合征有关，而问题明确禁止直接使用传播综合征。该检索表因违反问题的明确规则而从表面上看就是无效的。\n结论：**错误**。\n\n**选项 D：**\n$1$a. $\\mathcal{B}$ 存在 $\\rightarrow$ 转到 $2$。\n$1$b. $\\mathcal{B}$ 不存在 $\\rightarrow$ 转到 $3$。\n与检索表 B 类似，此检索表首先根据一个单一的肉质/干性轴代理性状进行划分，这不够稳健。\n$2$a. $\\mathcal{C}$ 存在 $\\rightarrow$ 肉质不开裂果。（性状 $\\mathcal{C}$ 存在表示果实是**开裂**的。该检索表却得出它是不开裂果的结论。这是一个逻辑矛盾。）\n$2$b. $\\mathcal{C}$ 不存在 $\\rightarrow$ 肉质开裂果。（性状 $\\mathcal{C}$ 不存在表示果实是**不开裂**的。该检索表却得出它是开裂果的结论。这是一个逻辑矛盾。）\n尽管该检索表的后半部分（步骤 $3$a 和 $3$b）正确地对干果进行了分类，但一个二歧分类检索表必须整体都是正确的。从 $1$a 引出的第一个主要分支在根本上是有缺陷的。\n结论：**错误**。\n\n分析总结表明，只有选项 A 提供了一个逻辑上连贯且合理的二歧分类检索表，并且遵守了问题的所有约束。", "answer": "$$\\boxed{A}$$", "id": "2574760"}, {"introduction": "将生态过程转化为数学模型是理解其动态和后果的关键一步。本练习介绍了一个核心概念——种子扩散核（dispersal kernel），并使用负指数分布这一经典模型来描述风媒传播。通过从基本定义出发推导并计算特定情景下的扩散概率，你将体验到如何用定量方法来预测种子传播的生态结果。", "problem": "一种长有翅果的多年生河岸树木依靠风力（风媒传播）沿着一条笔直的河道传播种子。在一个空间均匀的流态中，瞬时单位距离沉降风险是恒定的，传播距离随机变量 $D$（沿河道从母树传播的距离）可以很好地被建模为一个非负连续变量，其概率密度函数 (PDF) $k(d)$ 由下式给出：\n$$\nk(d)=\\lambda \\exp(-\\lambda d)\\ \\text{for}\\ d\\ge 0,\\quad k(d)=0\\ \\text{for}\\ d0,\n$$\n其中速率参数 $\\lambda0$，单位为 $\\text{m}^{-1}$。从基本定义出发，对于任何具有概率密度函数 $k(d)$ 的非负连续随机变量，其在阈值 $r\\ge 0$ 处的超越（生存）概率为\n$$\n\\Pr(Dr)=\\int_{r}^{\\infty} k(d)\\, \\mathrm{d}d,\n$$\n推导在此核函数下 $D$ 的生存函数。然后，使用 $\\lambda=0.02\\ \\text{m}^{-1}$，计算一颗种子沿河道传播超过 $100\\ \\text{m}$ 的概率。\n\n将您的最终答案表示为用指数函数表示的精确解析表达式，不要提供数值近似值。答案是无单位的，且不得用百分号表示。", "solution": "所提出的问题是概率论在传播生态学领域应用的一个标准练习。它具有科学依据，问题提法恰当，并包含获得唯一解所需的所有信息。因此，我将进行验证和随后的推导。\n\n首先，我们通过提取给定信息来形式化地描述问题。\n随机变量 $D$ 代表传播距离。\n$D$ 的概率密度函数 (PDF) 由指数分布给出：\n$$\nk(d) = \\begin{cases} \\lambda \\exp(-\\lambda d)  \\text{for } d \\ge 0 \\\\ 0  \\text{for } d  0 \\end{cases}\n$$\n其中速率参数 $\\lambda  0$。\n生存函数，即超越概率 $\\Pr(Dr)$，由以下积分定义：\n$$\n\\Pr(Dr) = \\int_{r}^{\\infty} k(d)\\, \\mathrm{d}d\n$$\n对于任何阈值距离 $r \\ge 0$。\n问题要求完成两个任务：\n1. 推导生存函数的一般形式，我们将其表示为 $S(r) = \\Pr(Dr)$。\n2. 使用参数值 $\\lambda = 0.02\\ \\text{m}^{-1}$ 计算特定概率 $\\Pr(D  100)$。\n\n让我们从第一个任务开始：推导生存函数 $S(r)$。\n我们将给定的PDF $k(d)$ 代入生存函数的定义中。由于积分从 $r \\ge 0$ 开始，我们只需要考虑 $k(d) = \\lambda \\exp(-\\lambda d)$ 的情况。\n$$\nS(r) = \\Pr(Dr) = \\int_{r}^{\\infty} \\lambda \\exp(-\\lambda d)\\, \\mathrm{d}d\n$$\n这是一个瑕积分。我们通过取极限来计算它：\n$$\nS(r) = \\lim_{b \\to \\infty} \\int_{r}^{b} \\lambda \\exp(-\\lambda d)\\, \\mathrm{d}d\n$$\n为了找到 $\\lambda \\exp(-\\lambda d)$ 的反导数，我们可以使用一个简单的换元法。令 $u = -\\lambda d$，则 $\\mathrm{d}u = -\\lambda\\, \\mathrm{d}d$。积分变为：\n$$\n\\int \\lambda \\exp(-\\lambda d)\\, \\mathrm{d}d = \\int -\\exp(u)\\, \\mathrm{d}u = -\\exp(u) + C = -\\exp(-\\lambda d) + C\n$$\n其中 $C$ 是积分常数。\n现在，我们计算从 $r$ 到 $b$ 的定积分：\n$$\n\\int_{r}^{b} \\lambda \\exp(-\\lambda d)\\, \\mathrm{d}d = \\left[ -\\exp(-\\lambda d) \\right]_{r}^{b} = (-\\exp(-\\lambda b)) - (-\\exp(-\\lambda r)) = \\exp(-\\lambda r) - \\exp(-\\lambda b)\n$$\n最后，我们取 $b \\to \\infty$ 的极限：\n$$\nS(r) = \\lim_{b \\to \\infty} \\left( \\exp(-\\lambda r) - \\exp(-\\lambda b) \\right)\n$$\n由于 $\\lambda$ 是一个给定的正常数（$\\lambda  0$），当 $b \\to \\infty$ 时，项 $-\\lambda b$ 趋近于 $-\\infty$。因此，$\\exp(-\\lambda b)$ 趋近于 $0$。\n$$\n\\lim_{b \\to \\infty} \\exp(-\\lambda b) = 0\n$$\n因此，生存函数是：\n$$\nS(r) = \\exp(-\\lambda r) - 0 = \\exp(-\\lambda r)\n$$\n这就完成了问题的第一部分。指数分布随机变量的生存函数本身也是一个指数函数。\n\n对于第二个任务，我们必须计算种子传播超过 $100\\ \\text{m}$ 的概率，即 $\\Pr(D  100)$。这等同于在特定距离 $r = 100\\ \\text{m}$ 处计算生存函数 $S(r)$ 的值。我们已知参数值为 $\\lambda = 0.02\\ \\text{m}^{-1}$。\n\n使用推导出的生存函数 $S(r) = \\exp(-\\lambda r)$，我们代入给定的值：\n$$\n\\Pr(D  100) = S(100) = \\exp(-\\lambda \\times 100)\n$$\n现在，代入 $\\lambda$ 的数值：\n$$\n\\Pr(D  100) = \\exp(-0.02 \\times 100)\n$$\n指数中的乘积很容易计算：\n$$\n-0.02 \\times 100 = -2\n$$\n因此，所求概率为：\n$$\n\\Pr(D  100) = \\exp(-2)\n$$\n问题要求答案为精确的解析表达式，而非数值近似值。表达式 $\\exp(-2)$ 是最终的精确形式。", "answer": "$$\\boxed{\\exp(-2)}$$", "id": "2574712"}, {"introduction": "现代生态学研究越来越依赖于计算模型来探索复杂过程。本练习要求你从第一性原理出发，通过编写代码来构建一个种子风力传播的蒙特卡洛模拟器。你将亲手模拟并比较两种不同果实形态（带冠毛的瘦果和带翅的翅果）的传播潜力，从而深入理解果实形态、生物学特性和环境因素如何共同决定种子的扩散格局。", "problem": "您将使用基于平流和沉降第一性原理的蒙特卡洛方法，为两种截然不同的果实类型建立风驱种子传播模型。这两种重点研究的繁殖体代表了不同的果实类型：一种是带有冠毛的瘦果（物种 P；菊科植物的典型特征），另一种是翅果（物种 S；槭属植物的典型特征）。给定终端下落速度和野外风速分布。假设以下基本原理：在静止空气中，从地面以上高度 $H$ 释放的繁殖体以其终端速度 $v_t$ 下落，因此其空中停留时间为 $t_f = H / v_t$；在空中时，它被环境风水平平流输送。对于每次传播事件，从表征释放地点和时间的特定 Weibull 分布中随机抽取近地表水平风速 $u$；在该事件的下落期间，将 $u$ 视为恒定。沿平均风向的水平位移是平流速度在空中停留时间上的路径积分。这通过重复事件的水平距离分布定义了传播核。\n\n实现一个蒙特卡洛模拟器，对于每个测试用例，为每个物种生成 $N$ 个独立的传播事件，从指定的 Weibull 分布中采样风速，并计算由此产生的水平传播距离。为保证可复现性，请使用固定的随机种子。\n\n需使用的科学和建模假设：\n- 终端速度 $v_t$ 是物种特异的且为常数：对于带冠毛的瘦果（物种 P），使用 $v_t^{(P)} = 0.35\\,\\mathrm{m/s}$；对于翅果（物种 S），使用 $v_t^{(S)} = 1.60\\,\\mathrm{m/s}$。\n- 释放高度为 $H$（单位：$\\mathrm{m}$）。\n- 对于每个事件，水平风速 $u$（单位：$\\mathrm{m/s}$）是从形状参数（无量纲）为 $k$、尺度参数（单位：$\\mathrm{m/s}$）为 $\\lambda$ 的 Weibull 分布中独立抽取的。假设 $u \\ge 0$ 且与固定的平均风向一致，因此距离为非负值。\n- 忽略湍流、上升气流和垂直风切变；下落时间为 $t_f = H / v_t$，水平距离是 $u$ 在 $t_f$ 上的时间积分。\n- 每个测试用例中，每物种使用 $N = 200000$ 次蒙特卡洛事件，并使用固定的随机种子 $s = 20231105$。\n\n对于每个测试用例，计算物种 P 和物种 S 之间的以下两种标量比较：\n1. 双侧 Kolmogorov–Smirnov (KS) 统计量，定义为两个模拟距离分布的经验累积分布函数（$x$ 的函数）之间绝对差的上确界，其中 $x \\in [0,\\infty)$。将此值报告为四舍五入到 $4$ 位小数的无单位浮点数。\n2. 两个距离分布的 $0.90$ 分位数之差，计算公式为 $\\Delta Q_{0.90} = Q_{0.90}^{(P)} - Q_{0.90}^{(S)}$，以 $\\mathrm{m}$ 为单位表示，并四舍五入到 $2$ 位小数。正值表示带冠毛的物种获得了更大的 $0.90$ 分位数距离。\n\n测试套件（每个用例指定 $(H, k, \\lambda)$）：\n- 用例 $1$：$H = 1.00\\,\\mathrm{m}$，$k = 2.00$，$\\lambda = 4.00\\,\\mathrm{m/s}$。\n- 用例 $2$：$H = 0.30\\,\\mathrm{m}$，$k = 2.00$，$\\lambda = 4.00\\,\\mathrm{m/s}$。\n- 用例 $3$：$H = 1.50\\,\\mathrm{m}$，$k = 1.50$，$\\lambda = 1.50\\,\\mathrm{m/s}$。\n- 用例 $4$：$H = 2.00\\,\\mathrm{m}$，$k = 2.00$，$\\lambda = 6.00\\,\\mathrm{m/s}$。\n\n角度单位无关紧要，因为只考虑沿平均风向的标量距离。所有距离单位必须是 $\\mathrm{m}$，风速单位必须是 $\\mathrm{m/s}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的扁平列表，用方括号括起来。对于从 $1$ 到 $4$ 的每个测试用例，按顺序附加两个数字：首先是 KS 统计量（四舍五入到 $4$ 位小数），然后是 $\\Delta Q_{0.90}$（以 $\\mathrm{m}$ 为单位，四舍五入到 $2$ 位小数）。例如，输出应具有 $[ks_1,\\Delta q_1,ks_2,\\Delta q_2,ks_3,\\Delta q_3,ks_4,\\Delta q_4]$ 的形式，总共 $8$ 个数字。\n\n约束和实现细节：\n- 所有随机抽样均使用固定的随机种子 $s = 20231105$。\n- 每个测试用例中，每物种使用 $N = 200000$ 次传播事件。\n- 用于抽样 $u$ 的 Weibull 分布采用标准形状参数化，其概率密度函数为 $f(u;k,\\lambda) = \\frac{k}{\\lambda}\\left(\\frac{u}{\\lambda}\\right)^{k-1}\\exp\\left[-\\left(\\frac{u}{\\lambda}\\right)^k\\right]$，其中 $u \\ge 0$。\n- 以概率 $0.90$ 计算分位数作为标准经验分位数。\n- 确保所有四舍五入仅应用于报告的输出，而不在中间计算过程中使用。", "solution": "该问题要求使用蒙特卡洛模拟，对两种不同果实类型——带冠毛的瘦果（物种 P）和翅果（物种 S）——的风驱种子传播进行比较分析。该分析必须基于平流和引力沉降的第一性原理。\n\n水平传播距离 $d$ 的基本物理模型基于两个简化假设。首先，从高度 $H$ 释放的种子以其物种特异性的恒定终端速度 $v_t$ 垂直下落。因此，其空中停留时间 $t_f$ 由简单的运动学关系给出：\n$$t_f = \\frac{H}{v_t}$$\n其次，在飞行期间，种子被速度恒为 $u$ 的风水平平流。水平传播的距离是风速与空中停留时间的乘积：\n$$d = u \\cdot t_f = u \\cdot \\left(\\frac{H}{v_t}\\right)$$\n该模型建立了风速分布与最终传播距离分布之间的直接关系。\n\n物种由其终端速度来表征：带冠毛的瘦果为 $v_t^{(P)} = 0.35\\,\\mathrm{m/s}$，翅果为 $v_t^{(S)} = 1.60\\,\\mathrm{m/s}$。对于任何给定的释放高度 $H$，物种 P 的空中停留时间 $t_f^{(P)} = H/v_t^{(P)}$ 显著长于物种 S 的空中停留时间 $t_f^{(S)} = H/v_t^{(S)}$。这意味着物种 P 的传播距离 $d^{(P)}$ 是风速 $u$ 的一个更大倍数，相较于物种 S 的距离 $d^{(S)}$。因此，与物种 S 相比，物种 P 的距离概率分布是风速分布的一个更“拉伸”的版本。\n\n模拟将使用蒙特卡洛方法进行。对于每个由参数 ($H$, $k$, $\\lambda$) 定义的测试用例，我们执行以下步骤：\n1.  使用固定的种子 $s = 20231105$ 初始化一个伪随机数生成器，以确保可复现性。\n2.  从具有指定形状参数 $k$ 和尺度参数 $\\lambda$ 的 Weibull 分布中，为水平风速生成一个包含 $N = 200000$ 个独立随机变量的大样本 $\\{u_i\\}_{i=1}^N$。其概率密度函数由下式给出：\n    $$f(u; k, \\lambda) = \\frac{k}{\\lambda}\\left(\\frac{u}{\\lambda}\\right)^{k-1}\\exp\\left[-\\left(\\frac{u}{\\lambda}\\right)^k\\right] \\quad \\text{for } u \\ge 0$$\n3.  为了在相同的风况下直接比较物种的传播潜力，每个模拟的风速 $u_i$ 都用于计算一对传播距离：一个用于物种 P，另一个用于物种 S。这种方法被称为共同随机数，是一种方差缩减技术，可以提高比较的精度。\n    $$d_i^{(P)} = u_i \\cdot \\frac{H}{v_t^{(P)}}$$\n    $$d_i^{(S)} = u_i \\cdot \\frac{H}{v_t^{(S)}}$$\n    此过程产生两组成对的传播距离样本，$\\{d_i^{(P)}\\}_{i=1}^N$ 和 $\\{d_i^{(S)}\\}_{i=1}^N$。\n\n根据这两个模拟的距离分布，我们计算两个比较统计量：\n\n1.  **Kolmogorov-Smirnov (KS) 统计量**：该统计量 $D$ 是两个距离样本的经验累积分布函数 (ECDF) $\\hat{F}_N^{(P)}(x)$ 和 $\\hat{F}_N^{(S)}(x)$ 之间的最大绝对差。\n    $$D = \\sup_{x} |\\hat{F}_N^{(P)}(x) - \\hat{F}_N^{(S)}(x)|$$\n    这个值量化了两个累积分布之间的最大差异，提供了一个衡量它们总体差异的指标。它将使用 `scipy.stats.ks_2samp` 函数计算。\n\n2.  **0.90 分位数之差**：我们为每个距离分布计算第 $90$ 百分位数（即 $0.90$ 分位数），记为 $Q_{0.90}^{(P)}$ 和 $Q_{0.90}^{(S)}$。这些值代表了仅有 $10\\%$ 的传播事件会超过的距离，是衡量远距离传播潜力的指标。所需的输出是这些分位数之差：\n    $$\\Delta Q_{0.90} = Q_{0.90}^{(P)} - Q_{0.90}^{(S)}$$\n    正值表示物种 P 在分布的这个上尾部实现了更长的传播距离。分位数使用 `numpy.quantile` 函数计算。\n\n对四个指定的测试用例中的每一个都重复此整个过程。将得出的统计数据按规定进行四舍五入，并汇总到单个列表中作为最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import ks_2samp\n\ndef solve():\n    \"\"\"\n    Solves the seed dispersal simulation problem.\n\n    For each test case, this function simulates wind-driven seed dispersal for two\n    species (P and S) using a Monte Carlo approach. It calculates and reports\n    the Kolmogorov-Smirnov statistic and the difference in 0.90 quantiles\n    between the two resulting distance distributions.\n    \"\"\"\n    \n    # Define problem constants\n    v_t_p = 0.35  # Terminal velocity for Species P (m/s)\n    v_t_s = 1.60  # Terminal velocity for Species S (m/s)\n    N = 200000    # Number of Monte Carlo events\n    s = 20231105  # Fixed random seed\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (H, k, lambda)\n    test_cases = [\n        (1.00, 2.00, 4.00),  # Case 1\n        (0.30, 2.00, 4.00),  # Case 2\n        (1.50, 1.50, 1.50),  # Case 3\n        (2.00, 2.00, 6.00),  # Case 4\n    ]\n\n    results = []\n    \n    # Initialize a single random number generator for reproducibility\n    rng = np.random.default_rng(s)\n\n    for H, k, lambda_val in test_cases:\n        # Main logic to calculate the result for one case goes here.\n\n        # 1. Generate N wind speed samples from the Weibull distribution.\n        # numpy.random.weibull(a) generates samples with shape `a` and scale 1.\n        # We must multiply by `lambda_val` to set the correct scale.\n        # We use common random numbers for a more precise comparison.\n        u_samples = lambda_val * rng.weibull(k, size=N)\n\n        # 2. Calculate fall times for each species.\n        t_f_p = H / v_t_p\n        t_f_s = H / v_t_s\n\n        # 3. Calculate dispersal distances for each species.\n        distances_p = u_samples * t_f_p\n        distances_s = u_samples * t_f_s\n\n        # 4. Compute the required statistics.\n\n        # a. Two-sided Kolmogorov-Smirnov statistic\n        # ks_2samp returns a statistic and a p-value; we only need the statistic.\n        ks_statistic = ks_2samp(distances_p, distances_s).statistic\n        \n        # b. Difference between the 0.90 quantiles\n        q_p_90 = np.quantile(distances_p, 0.90)\n        q_s_90 = np.quantile(distances_s, 0.90)\n        delta_q_90 = q_p_90 - q_s_90\n\n        # 5. Round the results as specified and append to the list.\n        results.append(round(ks_statistic, 4))\n        results.append(round(delta_q_90, 2))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2574770"}]}