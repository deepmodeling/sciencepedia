{"hands_on_practices": [{"introduction": "生物体如何产生有序的结构，例如水螅体上芽体的规则排列，是发育生物学中的一个核心问题。反应-扩散模型，如Gierer-Meinhardt模型，为解释这种自组织模式提供了强有力的理论框架。本练习将通过量纲分析和标度论证，探讨如何从激活剂和抑制剂这两种信号分子的基本特性（如扩散速率）来预测芽体的特征间距，从而将分子机制与宏观形态学联系起来 [@problem_id:2549946]。", "problem": "在通过出芽生殖进行繁殖的水螅纲刺胞动物（如淡水水螅）中，沿体柱的初生芽的间距通常用 Gierer–Meinhardt 类型的双组分激活剂-抑制剂反应扩散系统来建模。设激活剂浓度为 $a(\\mathbf{x},t)$，抑制剂浓度为 $h(\\mathbf{x},t)$，它们定义在一维上皮片坐标 $x \\in \\mathbb{R}$ 上。其动力学遵循菲克扩散定律和局部反应动力学，因此可以写成如下的耦合偏微分方程 (PDE)\n$$\n\\frac{\\partial a}{\\partial t} \\;=\\; D_a \\nabla^2 a \\;+\\; f(a,h),\\qquad\n\\frac{\\partial h}{\\partial t} \\;=\\; D_i \\nabla^2 h \\;+\\; g(a,h),\n$$\n其中 $D_a$ 和 $D_i$ 是正常数扩散系数，$f$ 和 $g$ 描述了在动力学的一个空间均匀稳态 $(a_0,h_0)$ 附近的局部激活剂-抑制剂的产生、降解和自催化过程。假设以下基本事实成立：(i) 在 $(a_0,h_0)$ 附近，线性化动力学对 $a$ 和 $h$ 分别具有特征衰减率 $ \\mu_a > 0 $ 和 $ \\mu_i > 0 $；(ii) 图灵机制中的模式选择由均匀态线性稳定性分析中出现的最不稳定波数决定；(iii) 在与无脊椎动物出芽生殖相关的此类激活剂-抑制剂系统中，抑制剂是长程的 ($D_i \\gg D_a$)，激活剂是短程的，且动力学时间尺度为同一量级，$ \\mu_i / \\mu_a = \\mathcal{O}(1) $。\n\n请仅从菲克扩散和动力学时间尺度 $ \\mu_a $ 和 $ \\mu_i $ 的存在出发，使用无量纲化和量纲分析来确定扩散长度 $ \\ell_a = \\sqrt{D_a / \\mu_a} $ 和 $ \\ell_i = \\sqrt{D_i / \\mu_i} $ 是该线性化问题的唯二内禀长度尺度。然后，基于适用于 Gierer–Meinhardt 机制中芽抑制范围的标度论证，论证特征芽间距 $ \\lambda $ 与以激活剂扩散长度为单位测量的抑制剂扩散长度成正比。对于量级估计，取比例因子为 $1$ 且 $ \\mu_i / \\mu_a = 1 $。\n\n最后，在长度以激活剂扩散长度 $ \\ell_a $ 为单位、时间以 $ \\mu_a^{-1} $ 为单位的无量纲化体系中进行计算，使得无量纲扩散系数为 $ D_a = 1 $ 和 $ D_i = 10 $。在这些假设下，计算由此产生的特征芽间距 $ \\lambda $ 的精确表达式。将最终间距以激活剂扩散长度为单位表示，并提供未经四舍五入的精确值。", "solution": "首先将验证问题陈述的科学性和逻辑一致性。\n\n**问题验证**\n\n**第 1 步：提取已知条件**\n- 控制方程：\n$$ \\frac{\\partial a}{\\partial t} = D_a \\nabla^2 a + f(a,h) $$\n$$ \\frac{\\partial h}{\\partial t} = D_i \\nabla^2 h + g(a,h) $$\n- 变量：激活剂浓度 $a(\\mathbf{x},t)$，抑制剂浓度 $h(\\mathbf{x},t)$。\n- 定义域：一维坐标 $x \\in \\mathbb{R}$。\n- 参数：扩散系数 $D_a > 0$ 和 $D_i > 0$。\n- 动力学：反应项 $f(a,h)$ 和 $g(a,h)$，具有一个均匀稳态 $(a_0, h_0)$。\n- 动力学速率：在稳态附近，$a$ 和 $h$ 的特征衰减率分别为 $\\mu_a > 0$ 和 $\\mu_i > 0$。\n- 系统特性 (Gierer–Meinhardt 类型)：长程抑制剂 ($D_i \\gg D_a$)，短程激活剂。\n- 时间尺度：$\\mu_i / \\mu_a = \\mathcal{O}(1)$。\n- 模式选择：特征芽间距 $\\lambda$ 由图灵失稳机制中最不稳定的波数决定。\n- 用于计算的具体任务和假设：\n    1. 使用量纲分析确定扩散长度 $\\ell_a = \\sqrt{D_a/\\mu_a}$ 和 $\\ell_i = \\sqrt{D_i/\\mu_i}$。\n    2. 基于标度论证，论证特征芽间距 $\\lambda$ “与以激活剂扩散长度为单位测量的抑制剂扩散长度成正比”。\n    3. 对于估计，使用比例因子 $1$ 和 $\\mu_i / \\mu_a = 1$。\n    4. 对于最终计算，使用一种无量纲化方案，其中长度以 $\\ell_a$ 为单位，时间以 $\\mu_a^{-1}$ 为单位。\n    5. 在这种无量纲化方案中，给定的无量纲扩散系数为 $D_a = 1$ 和 $D_i = 10$。这意味着物理扩散系数之比为 $D_i/D_a = 10$。\n\n**第 2 步：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学性：** 该问题描述了一个经典的 Gierer-Meinhardt 激活剂-抑制剂系统，这是发育生物学和模式形成领域中一个基础且成熟的模型。使用反应扩散方程和图灵的模式选择机制是标准且科学合理的。\n- **适定性：** 问题在语言上存在一些不精确之处。\n    - “$\\lambda$ 与以激活剂扩散长度为单位测量的抑制剂扩散长度成正比”这一表述如果按字面解释 ($\\lambda \\propto \\ell_i/\\ell_a$)，在量纲上是不一致的。一个长度不能与一个无量纲的量成正比。唯一在物理和数学上一致的解释是，无量纲间距 $\\lambda/\\ell_a$ 与无量纲比率 $\\ell_i/\\ell_a$ 成正比，这等价于物理上直观的标度关系 $\\lambda \\propto \\ell_i$。在此必要解释下，问题是可解的。\n    - 问题要求一个最终的数值答案，但只为前面的“量级估计”给出了条件 $\\mu_i / \\mu_a = 1$。为避免问题条件不足，有必要假设此条件延续到最终计算中。鉴于问题的结构和时间尺度为同一量级的一般性陈述，这是一个合理的推断。\n- **客观性：** 除了上述模糊之处，问题以客观、科学的语言陈述。\n\n**第 3 步：结论与行动**\n该问题被认为是**有效的**，但这取决于对其模糊陈述的合理解释。严谨的解答需要明确说明这些解释。可以开始求解过程。\n\n**解答**\n\n问题要求从基本原理和标度论证出发进行解答。我们将按指示分阶段进行。\n\n首先，我们使用量纲分析来确定系统的内禀长度尺度。令 $[L]$ 表示长度量纲，$[T]$ 表示时间量纲。根据菲克定律，扩散系数 $D_a$ 和 $D_i$ 的量纲为 $[L]^2 [T]^{-1}$。特征动力学速率 $\\mu_a$ 和 $\\mu_i$ 的量纲为 $[T]^{-1}$。为了从这些参数构造一个具有长度量纲 $[L]$ 的量，我们必须以一种消除时间量纲的方式组合它们。\n对于激活剂，考虑比率 $D_a / \\mu_a$：\n$$ \\left[\\frac{D_a}{\\mu_a}\\right] = \\frac{[L]^2 [T]^{-1}}{[T]^{-1}} = [L]^2 $$\n因此，量 $\\ell_a = \\sqrt{D_a / \\mu_a}$ 具有长度量纲。通过完全相同的推理，量 $\\ell_i = \\sqrt{D_i / \\mu_i}$ 也具有长度量纲。它们分别是激活剂和抑制剂的扩散长度，代表了每种物质在其特征动力学寿命期间扩散的特征距离。这是能从线性化问题的基本参数（$D_a, D_i, \\mu_a, \\mu_i$）构造出的仅有的两个长度尺度。\n\n其次，我们需要为特征芽间距 $\\lambda$ 提供一个标度论证。在图灵类型的激活剂-抑制剂系统中，模式形成源于短程激活和长程抑制的相互作用。在某一点产生的激活剂分子会自催化其自身的产生，导致局部浓度出现一个峰值。这种激活剂也会刺激抑制剂的产生。抑制剂由于具有大得多的扩散系数（$D_i \\gg D_a$），其扩散范围比激活剂更广。这种抑制作用的特征范围是其扩散长度 $\\ell_i$。扩散的抑制剂会抑制其邻近区域其他激活剂峰的形成。因此，由此产生的激活剂峰（对应于初生芽）的周期性模式将具有一个由抑制场范围决定的特征间距 $\\lambda$。因此，最直接的物理标度论证是，模式波长必须与抑制剂的扩散长度成正比：\n$$ \\lambda \\propto \\ell_i $$\n这可以写成 $\\lambda = C \\ell_i$，其中 $C$ 是一个无量纲比例常数。问题要求将其与激活剂扩散长度 $\\ell_a$ 联系起来。两边同除以 $\\ell_a$，我们得到无量纲间距 $\\tilde{\\lambda} = \\lambda/\\ell_a$ 的关系式：\n$$ \\frac{\\lambda}{\\ell_a} = C \\frac{\\ell_i}{\\ell_a} $$\n这与对问题陈述的唯一可行解释相符。\n\n第三，我们被要求使用特定的假设进行估计。比例常数取为 $C = 1$，并且动力学时间尺度假定相等，这意味着它们的逆速率相等：$\\mu_a = \\mu_i$。在这些假设下，标度关系变为 $\\lambda = \\ell_i$。为了以所要求的无量纲形式（以激活剂扩散长度为单位）表示，我们计算该比率：\n$$ \\tilde{\\lambda} = \\frac{\\lambda}{\\ell_a} = \\frac{\\ell_i}{\\ell_a} $$\n代入 $\\ell_a$ 和 $\\ell_i$ 的定义：\n$$ \\tilde{\\lambda} = \\frac{\\sqrt{D_i / \\mu_i}}{\\sqrt{D_a / \\mu_a}} = \\sqrt{\\frac{D_i}{D_a} \\cdot \\frac{\\mu_a}{\\mu_i}} $$\n应用假设 $\\mu_i / \\mu_a = 1$，这简化为：\n$$ \\tilde{\\lambda} = \\sqrt{\\frac{D_i}{D_a}} $$\n\n最后，我们必须计算这个无量纲间距的精确值。我们给定了一个无量纲化方案，其产生的无量纲扩散系数（我们用波浪号表示）为 $\\tilde{D}_a = 1$ 和 $\\tilde{D}_i = 10$。根据使用长度尺度 $\\ell_a = \\sqrt{D_a/\\mu_a}$ 和时间尺度 $\\mu_a^{-1}$ 的标准无量纲化过程，无量纲抑制剂扩散系数恰好是物理系数的比值：$\\tilde{D}_i = D_i / D_a$。因此，我们已知 $D_i / D_a = 10$。\n如在验证期间所指出的，为了得到一个单一的数值结果，我们必须继续使用 $\\mu_i / \\mu_a = 1$ 的假设。将这些值代入我们推导出的无量纲间距表达式中：\n$$ \\tilde{\\lambda} = \\sqrt{\\frac{D_i}{D_a} \\cdot \\frac{\\mu_a}{\\mu_i}} = \\sqrt{10 \\cdot 1} = \\sqrt{10} $$\n最终答案是以激活剂扩散长度 $\\ell_a$ 为单位表示的特征芽间距 $\\lambda$。根据定义，这正是无量纲间距 $\\tilde{\\lambda}$。", "answer": "$$ \\boxed{\\sqrt{10}} $$", "id": "2549946"}, {"introduction": "个体的繁殖策略直接影响其种群的动态和命运。矩阵种群模型（如Leslie或Lefkovitch模型）是生态学中用于预测种群增长的标准工具。本练习演示了如何构建一个包含出芽生殖生命周期的阶段结构模型，并利用该模型来评估环境因素（如温度）如何通过影响关键生命史参数来决定种群的长期增长率 [@problem_id:2549927]。", "problem": "您的任务是为一种通过出芽生殖繁殖的无脊椎动物建立一个分阶段、离散时间的克隆投影模型，以便比较不同温度处理的效果，并找出能使长期增长最大化的处理方法。该生物系统概括如下。种群被划分为 $3$ 个阶段：芽体 ($B$)、附着的幼体 ($J$) 和有繁殖能力的成体 ($A$)。时间以等长的离散步长推进。对于给定的温度 $T$，种群状态向量为 $n_t(T) = [B_t, J_t, A_t]^\\top$，其到下一个时间步长的投影由 $n_{t+1}(T) = A(T)\\, n_t(T)$ 给出，其中 $A(T)$ 是一个由存活和转移概率以及一个繁殖力参数构建的 $3 \\times 3$ 非负矩阵。$A(T)$ 的元素由以下基本规则和定义确定。\n\n- 阶段存活和转移：\n  - 芽体在一个时间步长内以概率 $s_B(T)$ 存活，并在存活的条件下，以概率 $g_B$ 附着成为幼体，否则以概率 $1 - g_B$ 保持为芽体。\n  - 幼体在一个时间步长内以概率 $s_J$ 存活，并在存活的条件下，以概率 $g_J$ 成熟为成体，否则以概率 $1 - g_J$ 保持为幼体。\n  - 成体在一个时间步长内以概率 $s_A$ 存活并保持为成体。\n- 芽体产生（繁殖力）：每个成体在每个时间步长内产生 $f$ 个新芽体，这些芽体在下一次普查时进入芽体阶段（繁殖后普查约定）。\n\n根据这些规则，依赖于温度的阶段投影矩阵为\n$$\nA(T) =\n\\begin{bmatrix}\ns_B(T)\\,(1 - g_B)  0  f \\\\\ns_B(T)\\,g_B        s_J\\,(1 - g_J)  0 \\\\\n0                  s_J\\,g_J        s_A\n\\end{bmatrix}.\n$$\n长期渐近增长因子是 $A(T)$ 的主特征值（Perron根），记作 $\\lambda_{\\max}(T)$，对于非负矩阵，它就是谱半径。\n\n您的任务是实现一个程序，对于下面测试套件中的每一组参数，为每个提供的温度 $T$ 构建 $A(T)$，计算作为谱半径的 $\\lambda_{\\max}(T)$（即 $A(T)$ 特征值中的最大绝对值），并找出使 $\\lambda_{\\max}(T)$ 最大化的温度 $\\hat{T}$。如果在数值容差 $\\epsilon = 10^{-9}$ 内有多个温度达到相同的最大值，则选择这些最大化温度中的最小值。最终答案必须以摄氏度（单位：$\\degree$C）表示，并格式化为带一位小数的小数。\n\n测试套件。每个测试用例都是一个元组，包含：\n- 一个温度列表 $[T_1, T_2, \\dots]$，单位为 $\\degree$C，\n- 一个对应的芽体存活概率列表 $[s_B(T_1), s_B(T_2), \\dots]$，\n- 以及常数 $(f, s_J, s_A, g_B, g_J)$，除非在特定用例中被明确覆盖。\n\n除非另有说明，所有用例均使用以下默认常数：$f = 5.0$，$s_J = 0.8$，$s_A = 0.9$，$g_B = 0.4$，$g_J = 0.5$。\n\n请提供以下四个用例的结果：\n- 用例 $1$（一般情况，上升的中程最优值）：温度为 $[10.0, 15.0, 20.0, 25.0]$，芽体存活概率为 $[0.2, 0.5, 0.8, 0.7]$。\n- 用例 $2$（适应寒冷）：温度为 $[5.0, 10.0, 15.0, 20.0]$，芽体存活概率为 $[0.7, 0.6, 0.3, 0.1]$。\n- 用例 $3$（最大增长率持平）：温度为 $[12.0, 16.0, 20.0]$，芽体存活概率为 $[0.3, 0.3, 0.1]$。\n- 用例 $4$（零繁殖力边界情况）：温度为 $[10.0, 20.0]$，芽体存活概率为 $[0.9, 0.9]$，但此处设置 $f = 0.0$；其他常数使用默认值。\n\n算法要求：\n- 对于每个用例，计算每个 $T$ 对应的 $A(T)$ 的谱半径 $\\lambda_{\\max}(T)$。\n- 将 $\\hat{T}$ 确定为具有最大 $\\lambda_{\\max}(T)$ 的温度；如果在 $\\epsilon = 10^{-9}$ 容差内出现持平情况，则选择持平温度中的最小值。\n- 每个用例报告一个 $\\hat{T}$，以 $\\degree$C 为单位，表示为一位小数的浮点数。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[x_1, x_2, x_3, x_4]$，其中每个 $x_i$ 是对应案例选择的温度 $\\hat{T}$，以 $\\degree$C 为单位，保留一位小数。", "solution": "该问题要求对一个分阶段种群模型进行形式化分析，以确定实现长期种群增长的最优温度。该模型是一个离散时间线性系统，由矩阵方程 $n_{t+1}(T) = A(T)n_t(T)$ 描述，其中 $n_t(T) = [B_t, J_t, A_t]^\\top$ 是在时间 $t$ 和温度 $T$ 下芽体、幼体和成体的状态向量。\n\n种群投影矩阵 $A(T)$ 如下所示：\n$$\nA(T) =\n\\begin{bmatrix}\ns_B(T)\\,(1 - g_B)  0  f \\\\\ns_B(T)\\,g_B        s_J\\,(1 - g_J)  0 \\\\\n0                  s_J\\,g_J        s_A\n\\end{bmatrix}\n$$\n该矩阵的元素由生命周期的基本参数构成：\n- $a_{11} = s_B(T)(1 - g_B)$：在一个时间步长内，存活并保持为芽体的芽体比例。\n- $a_{13} = f$：繁殖力，定义为每个成体在每个时间步长内产生的新芽体数量。\n- $a_{21} = s_B(T)g_B$：存活并转移到幼体阶段的芽体比例。\n- $a_{22} = s_J(1 - g_J)$：存活并保持为幼体的幼体比例。\n- $a_{32} = s_J g_J$：存活并成熟为成体的幼体比例。\n- $a_{33} = s_A$：存活并保持为成体的成体比例。\n\n种群的长期渐近增长率由矩阵 $A(T)$ 的主特征值给出，我们将其记为 $\\lambda_{\\max}(T)$。对于一个非负不可约矩阵，Perron-Frobenius 定理断言该特征值是实数、正数且唯一的。它等价于矩阵的谱半径，定义为 $\\rho(A(T)) = \\max_i |\\lambda_i(T)|$，其中 $\\lambda_i(T)$ 是 $A(T)$ 的特征值。我们的任务是从一个离散的候选温度集合中找到使该值最大化的温度 $\\hat{T}$：\n$$\n\\hat{T} = \\arg\\max_{T \\in \\{T_1, T_2, \\dots\\}} \\lambda_{\\max}(T)\n$$\n为比较 $\\lambda_{\\max}(T)$ 的浮点数值，指定了数值容差 $\\epsilon = 10^{-9}$。如果最大值出现持平，必须选择这些最大化温度中的最小值。\n\n给出的默认参数为 $f = 5.0$，$s_J = 0.8$，$s_A = 0.9$，$g_B = 0.4$ 和 $g_J = 0.5$。由此，我们计算出矩阵的常数部分：\n- $1 - g_B = 1 - 0.4 = 0.6$\n- $s_J(1 - g_J) = 0.8 \\times (1 - 0.5) = 0.4$\n- $s_J g_J = 0.8 \\times 0.5 = 0.4$\n\n因此，用例 $1$、$2$ 和 $3$ 的矩阵一般形式为：\n$$\nA(T) =\n\\begin{bmatrix}\n0.6 \\cdot s_B(T)  0  5.0 \\\\\n0.4 \\cdot s_B(T)  0.4  0 \\\\\n0  0.4  0.9\n\\end{bmatrix}\n$$\n现在我们继续评估每个用例，为每个温度构建特定矩阵并计算其谱半径。\n\n**用例 1：一般情况**\n- 温度 $T_i$：$[10.0, 15.0, 20.0, 25.0]$\n- 芽体存活概率 $s_B(T_i)$：$[0.2, 0.5, 0.8, 0.7]$\n\n对于每个温度，我们构建 $A(T_i)$ 并计算其谱半径 $\\lambda_{\\max}(T_i)$。\n- $T_1 = 10.0, s_B(10.0) = 0.2$：$A(10.0) = \\begin{bmatrix} 0.12  0  5.0 \\\\ 0.08  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(10.0) \\approx 1.0363$。\n- $T_2 = 15.0, s_B(15.0) = 0.5$：$A(15.0) = \\begin{bmatrix} 0.30  0  5.0 \\\\ 0.20  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(15.0) \\approx 1.1114$。\n- $T_3 = 20.0, s_B(20.0) = 0.8$：$A(20.0) = \\begin{bmatrix} 0.48  0  5.0 \\\\ 0.32  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(20.0) \\approx 1.1444$。\n- $T_4 = 25.0, s_B(25.0) = 0.7$：$A(25.0) = \\begin{bmatrix} 0.42  0  5.0 \\\\ 0.28  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(25.0) \\approx 1.1390$。\n\n比较增长率，最大值约为 $1.1444$，出现在 $T_3=20.0$ 时。因此，$\\hat{T} = 20.0^{\\circ}\\text{C}$。\n\n**用例 2：适应寒冷**\n- 温度 $T_i$：$[5.0, 10.0, 15.0, 20.0]$\n- 芽体存活概率 $s_B(T_i)$：$[0.7, 0.6, 0.3, 0.1]$\n\n- $T_1 = 5.0, s_B(5.0) = 0.7$：$A(5.0) = \\begin{bmatrix} 0.42  0  5.0 \\\\ 0.28  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(5.0) \\approx 1.1390$。\n- $T_2 = 10.0, s_B(10.0) = 0.6$：$A(10.0) = \\begin{bmatrix} 0.36  0  5.0 \\\\ 0.24  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(10.0) \\approx 1.1273$。\n- $T_3 = 15.0, s_B(15.0) = 0.3$：$A(15.0) = \\begin{bmatrix} 0.18  0  5.0 \\\\ 0.12  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(15.0) \\approx 1.0664$。\n- $T_4 = 20.0, s_B(20.0) = 0.1$：$A(20.0) = \\begin{bmatrix} 0.06  0  5.0 \\\\ 0.04  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(20.0) \\approx 1.0114$。\n\n最大增长率约为 $1.1390$，出现在 $T_1=5.0$ 时。因此，$\\hat{T} = 5.0^{\\circ}\\text{C}$。\n\n**用例 3：最大增长率持平**\n- 温度 $T_i$：$[12.0, 16.0, 20.0]$\n- 芽体存活概率 $s_B(T_i)$：$[0.3, 0.3, 0.1]$\n\n- $T_1 = 12.0, s_B(12.0) = 0.3$：$A(12.0) = \\begin{bmatrix} 0.18  0  5.0 \\\\ 0.12  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(12.0) \\approx 1.0664$。\n- $T_2 = 16.0, s_B(16.0) = 0.3$：$A(16.0) = \\begin{bmatrix} 0.18  0  5.0 \\\\ 0.12  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(16.0) \\approx 1.0664$。\n- $T_3 = 20.0, s_B(20.0) = 0.1$：$A(20.0) = \\begin{bmatrix} 0.06  0  5.0 \\\\ 0.04  0.4  0 \\\\ 0  0.4  0.9 \\end{bmatrix}$。谱半径为 $\\lambda_{\\max}(20.0) \\approx 1.0114$。\n\n最大增长率约为 $1.0664$，在 $T_1 = 12.0$ 和 $T_2 = 16.0$ 时均达到此值。根据指定的持平处理规则，我们必须选择最小的温度。因此，$\\hat{T} = 12.0^{\\circ}\\text{C}$。\n\n**用例 4：零繁殖力边界情况**\n- 温度 $T_i$：$[10.0, 20.0]$\n- 芽体存活概率 $s_B(T_i)$：$[0.9, 0.9]$\n- 繁殖力设置为 $f=0.0$。其他参数使用默认值。\n\n当 $f=0.0$ 时，矩阵变为下三角矩阵：\n$$\nA(T) =\n\\begin{bmatrix}\n0.6 \\cdot s_B(T)  0  0 \\\\\n0.4 \\cdot s_B(T)  0.4  0 \\\\\n0  0.4  0.9\n\\end{bmatrix}\n$$\n三角矩阵的特征值是其对角线元素：$\\lambda_1 = 0.6 \\cdot s_B(T)$、$\\lambda_2 = 0.4$ 和 $\\lambda_3 = 0.9$。谱半径是这些值的最大值。\n- 对于温度 $T_1=10.0$ 和 $T_2=20.0$，芽体存活概率均为 $s_B(T) = 0.9$。\n- 因此第一个特征值为 $\\lambda_1 = 0.6 \\times 0.9 = 0.54$。\n- 两种温度下的特征值集合均为 $\\{0.54, 0.4, 0.9\\}$。\n- 谱半径为 $\\lambda_{\\max}(T) = \\max(0.54, 0.4, 0.9) = 0.9$。\n\n两种温度下的最大增长率均为 $0.9$。应用持平处理规则，我们选择最小的温度。因此，$\\hat{T} = 10.0^{\\circ}\\text{C}$。\n\n总而言之，最优温度为：用例 1 是 $20.0$，用例 2 是 $5.0$，用例 3 是 $12.0$，用例 4 是 $10.0$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimal temperature that maximizes long-run population growth\n    for a stage-structured model.\n    \"\"\"\n\n    def find_optimal_T(case_params):\n        \"\"\"\n        Processes a single test case to find the optimal temperature.\n        \"\"\"\n        temperatures = case_params[\"temps\"]\n        sB_values = case_params[\"sB_values\"]\n        f = case_params.get(\"f\", 5.0)\n        sJ = case_params.get(\"sJ\", 0.8)\n        sA = case_params.get(\"sA\", 0.9)\n        gB = case_params.get(\"gB\", 0.4)\n        gJ = case_params.get(\"gJ\", 0.5)\n        \n        epsilon = 1e-9\n        \n        max_lambda = -1.0\n        # Initialize best_T to a value larger than any possible temperature\n        best_T = float('inf') \n        \n        # Pre-compute derived constants\n        sJ_gJ = sJ * gJ\n        sJ_1_minus_gJ = sJ * (1.0 - gJ)\n        _1_minus_gB = 1.0 - gB\n\n        for i, T in enumerate(temperatures):\n            sB = sB_values[i]\n            \n            # Construct the projection matrix A(T)\n            A_T = np.array([\n                [sB * _1_minus_gB,   0.0,             f],\n                [sB * gB,            sJ_1_minus_gJ,   0.0],\n                [0.0,                sJ_gJ,           sA]\n            ], dtype=float)\n            \n            # Compute eigenvalues and the spectral radius\n            eigenvalues = np.linalg.eigvals(A_T)\n            spectral_radius = np.max(np.abs(eigenvalues))\n            \n            # Update optimal temperature based on maximization and tie-breaking rule.\n            # If the new spectral radius is larger, it's the new optimum.\n            # If it's a tie (within tolerance), choose the smaller temperature.\n            if spectral_radius > max_lambda + epsilon:\n                max_lambda = spectral_radius\n                best_T = T\n            elif abs(spectral_radius - max_lambda) = epsilon:\n                if T  best_T:\n                    best_T = T\n        \n        return best_T\n\n    # Define the test cases from the problem statement as a list of dictionaries.\n    test_cases = [\n        {\n            \"temps\": [10.0, 15.0, 20.0, 25.0],\n            \"sB_values\": [0.2, 0.5, 0.8, 0.7]\n        },\n        {\n            \"temps\": [5.0, 10.0, 15.0, 20.0],\n            \"sB_values\": [0.7, 0.6, 0.3, 0.1]\n        },\n        {\n            \"temps\": [12.0, 16.0, 20.0],\n            \"sB_values\": [0.3, 0.3, 0.1]\n        },\n        {\n            \"temps\": [10.0, 20.0],\n            \"sB_values\": [0.9, 0.9],\n            \"f\": 0.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        optimal_temp = find_optimal_T(case)\n        # Format the result to one decimal place as required\n        results.append(f\"{optimal_temp:.1f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2549927"}, {"introduction": "为了在更宏大的尺度上理解无性繁殖，我们可以追溯其演化历史。系统发育比较方法使我们能够定量地研究像出芽这类性状的演化过程。本练习将运用基于马尔可夫链的概率模型，计算在给定的系统发育树上，关于出芽能力演化的不同假说（例如，单次起源与多次独立起源）的似然值，从而为推断演化模式提供定量依据 [@problem_id:2549924]。", "problem": "给定一个包含四种海洋无脊椎动物的有根、经时间校准的系统发育树，其从根到每个末端的总路径长度等于 $1.0$ 个时间单位。其拓扑结构和分支长度如下：根节点分裂成两条长度为 $0.6$ 的内部分支；每条内部分支再分裂成两条长度为 $0.4$ 的末端分支。将演化支表示为 $\\big((\\text{Hydra},\\ \\text{Obelia}):0.4,\\ (\\text{Nereis},\\ \\text{Asterias}):0.4\\big)$，每个演化支都由一条从根节点延伸出来的长度为 $0.6$ 的内部分支所支持。现存性状为无性出芽的存在（$1$）或不存在（$0$）。在末端上的观测值为：$\\text{Hydra}=1$，$\\text{Obelia}=1$，$\\text{Nereis}=0$，$\\text{Asterias}=0$。\n\n考虑在该树上出芽性状演化的两种备选模型，每种模型都在马尔可夫 $k$ 状态（Mk）框架下表示为一个连续时间马尔可夫链（CTMC），且根节点状态固定为 $0$：\n\n- 模型 $\\mathcal{M}_{\\text{single}}$（单一来源）：不可逆两状态 Mk 模型，其中获得（gain）的速率为 $q_{01}=\\lambda$，而丢失（loss）被禁止 $q_{10}=0$。假设的演化历史（一个完全指定的随机性状图谱）是在通往 $(\\text{Hydra},\\ \\text{Obelia})$ 演化支的内部分支基部（时间 $0$）发生了一次 $0\\to 1$ 的变化；该演化支的其余所有部分均处于状态 $1$，而其姐妹演化支 $(\\text{Nereis},\\ \\text{Asterias})$ 则始终保持在状态 $0$。使用 $\\lambda=1.2$ 每单位时间。\n\n- 模型 $\\mathcal{M}_{\\text{multiple}}$（两个独立来源）：可逆两状态等速率 Mk 模型，其中 $q_{01}=q_{10}=\\mu$。假设的演化历史有两次独立的 $0\\to 1$ 变化，分别发生在通往 $\\text{Hydra}$ 和 $\\text{Obelia}$ 的两条末端分支上；所有其他分支均保持在状态 $0$。使用 $\\mu=0.8$ 每单位时间。\n\n使用 Mk 模型下 CTMC 路径似然度的基本定义，并根据上述完全指定的演化图谱，计算似然比\n$$\n\\Lambda \\equiv \\frac{L\\big(\\text{history} \\mid \\mathcal{M}_{\\text{single}},\\ \\lambda\\big)}{L\\big(\\text{history} \\mid \\mathcal{M}_{\\text{multiple}},\\ \\mu\\big)}.\n$$\n将您计算出的 $\\Lambda$ 的最终数值四舍五入到四位有效数字。最终答案应该是一个无单位的实数。", "solution": "该问题要求计算一个二元性状在给定系统发育树上两种不同且完全指定的演化历史的似然比。其理论框架是连续时间马尔可夫链（CTMC）。首先，我们必须验证问题的陈述。\n\n已知条件如下：\n- 一个包含四物种的有根、经时间校准的系统发育树：$((\\text{Hydra},\\ \\text{Obelia}):0.4,\\ (\\text{Nereis},\\ \\text{Asterias}):0.4)$，其内部分支长度为 $0.6$。从根到末端的总路径长度为 $0.6 + 0.4 = 1.0$。\n- 一个二元性状（出芽的存在/不存在），其末端状态为：$\\text{Hydra}=1$，$\\text{Obelia}=1$，$\\text{Nereis}=0$，$\\text{Asterias}=0$。\n- 根节点状态固定为 $0$。\n- 模型 $\\mathcal{M}_{\\text{single}}$：一个不可逆两状态马尔可夫模型，速率为 $q_{01}=\\lambda=1.2$ 和 $q_{10}=0$。指定的演化历史涉及在通往 $(\\text{Hydra},\\ \\text{Obelia})$ 演化支的分支上，于根部（$t=0$）发生的一次 $0 \\to 1$ 转换。\n- 模型 $\\mathcal{M}_{\\text{multiple}}$：一个可逆、等速率的两状态马尔可夫模型，速率为 $q_{01}=q_{10}=\\mu=0.8$。指定的演化历史涉及两次独立的 $0 \\to 1$ 转换，分别发生在通往 $\\text{Hydra}$ 和 $\\text{Obelia}$ 的末端分支上。\n\n该问题在科学上基于系统发育树上的随机过程理论，这是计算生物学中的一个标准课题。问题陈述清晰、客观且信息自足。在描述模型 $\\mathcal{M}_{\\text{multiple}}$ 的演化历史时存在一个潜在的模糊之处，即两次变化的确切时间未被指定。然而，对于给定的等速率模型，其速率矩阵 $Q$ 的对角线元素相同（$q_{00} = q_{11} = -\\mu$），路径似然度与跳变的时间无关，仅取决于跳变的次数和总时间长度。因此，该问题并未被低度指定，可以计算出唯一解。问题是有效的。\n\n核心计算依赖于一个 CTMC 完全指定路径的似然度。对于树上的一个给定演化历史，该似然度是所有状态跳变速率的乘积，再乘以在每个状态中停留时间的稳态概率。通用公式为：\n$$\nL(\\text{history}) = \\left( \\prod_{\\text{all jumps } i \\to j} q_{ij} \\right) \\times \\exp\\left( \\sum_{\\text{all states } k} q_{kk} T_k \\right)\n$$\n其中 $T_k$ 是整个过程中在全树上处于状态 $k$ 的总时间，$q_{kk}$ 是速率矩阵 $Q$ 的对角线元素。根节点状态固定为 $0$ 是一个初始条件。\n\n让我们计算每个模型的似然度。\n\n**1. 模型 $\\mathcal{M}_{\\text{single}}$ 的似然度**\n\n此不可逆模型的速率矩阵为 $Q_{\\text{single}} = \\begin{pmatrix} -\\lambda  \\lambda \\\\ 0  0 \\end{pmatrix}$。\n因此，$q_{01} = \\lambda$，$q_{10} = 0$，$q_{00} = -\\lambda$，$q_{11} = 0$。\n该演化历史指定了一次跳变，即一次 $0 \\to 1$ 的转换。这次跳变的贡献是 $q_{01} = \\lambda$。\n\n指定的演化历史将树分为两部分：\n- 演化支 $(\\text{Nereis},\\ \\text{Asterias})$ 在其整个演化历史中都保持状态 $0$。总时长为一条长度为 $0.6$ 的内部分支和两条长度各为 $0.4$ 的末端分支。因此，处于状态 $0$ 的总时间为 $T_0 = 0.6 + 0.4 + 0.4 = 1.4$。\n- 演化支 $(\\text{Hydra},\\ \\text{Obelia})$ 在根部发生瞬时跳变后，其整个演化历史都处于状态 $1$。总时长为一条长度为 $0.6$ 的内部分支和两条长度各为 $0.4$ 的末端分支。因此，处于状态 $1$ 的总时间为 $T_1 = 0.6 + 0.4 + 0.4 = 1.4$。\n\n那么似然度为：\n$$\nL(\\text{history} \\mid \\mathcal{M}_{\\text{single}}, \\lambda) = q_{01} \\times \\exp(q_{00} T_0 + q_{11} T_1)\n$$\n$$\nL_{\\text{single}} = \\lambda \\exp(-\\lambda T_0 + 0 \\cdot T_1) = \\lambda \\exp(-\\lambda T_0)\n$$\n代入给定值 $\\lambda = 1.2$ 和 $T_0 = 1.4$：\n$$\nL_{\\text{single}} = 1.2 \\times \\exp(-1.2 \\times 1.4) = 1.2 \\exp(-1.68)\n$$\n\n**2. 模型 $\\mathcal{M}_{\\text{multiple}}$ 的似然度**\n\n此等速率模型的速率矩阵为 $Q_{\\text{multiple}} = \\begin{pmatrix} -\\mu  \\mu \\\\ \\mu  -\\mu \\end{pmatrix}$。\n因此，$q_{01} = \\mu$，$q_{10} = \\mu$，$q_{00} = -\\mu$，$q_{11} = -\\mu$。\n该演化历史指定了两次跳变，均为 $0 \\to 1$。这些跳变的贡献是 $q_{01} \\times q_{01} = \\mu^2$。\n\n在此演化历史中，状态变化仅发生在通往 $\\text{Hydra}$ 和 $\\text{Obelia}$ 的两条末端分支上。特定路径的先验似然度取决于在每个状态中停留的总时间 $T_0$ 和 $T_1$。然而，由于 $q_{00} = q_{11} = -\\mu$，指数项可以简化为：\n$$\n\\exp(q_{00} T_0 + q_{11} T_1) = \\exp(-\\mu T_0 - \\mu T_1) = \\exp(-\\mu (T_0 + T_1))\n$$\n总和 $T_0 + T_1$ 就是树中所有分支的总长度，这是一个与跳变发生时间无关的常数。\n树的总长度 = $2 \\times (\\text{内部分支长度}) + 4 \\times (\\text{末端分支长度})$\n$$\nT_{\\text{total}} = T_0 + T_1 = 2 \\times 0.6 + 4 \\times 0.4 = 1.2 + 1.6 = 2.8\n$$\n那么似然度为：\n$$\nL(\\text{history} \\mid \\mathcal{M}_{\\text{multiple}}, \\mu) = (q_{01} \\cdot q_{01}) \\times \\exp(-\\mu(T_0 + T_1))\n$$\n$$\nL_{\\text{multiple}} = \\mu^2 \\exp(-\\mu T_{\\text{total}})\n$$\n代入给定值 $\\mu = 0.8$ 和 $T_{\\text{total}} = 2.8$：\n$$\nL_{\\text{multiple}} = (0.8)^2 \\exp(-0.8 \\times 2.8) = 0.64 \\exp(-2.24)\n$$\n\n**3. 似然比 $\\Lambda$**\n\n我们现在必须计算比率 $\\Lambda = L_{\\text{single}} / L_{\\text{multiple}}$。\n$$\n\\Lambda = \\frac{1.2 \\exp(-1.68)}{0.64 \\exp(-2.24)}\n$$\n$$\n\\Lambda = \\frac{1.2}{0.64} \\times \\exp(-1.68 - (-2.24))\n$$\n$$\n\\Lambda = 1.875 \\times \\exp(2.24 - 1.68)\n$$\n$$\n\\Lambda = 1.875 \\times \\exp(0.56)\n$$\n现在，我们计算其数值：\n$$\n\\exp(0.56) \\approx 1.75067055\n$$\n$$\n\\Lambda \\approx 1.875 \\times 1.75067055 \\approx 3.28250728\n$$\n四舍五入到四位有效数字得到 $3.283$。", "answer": "$$\\boxed{3.283}$$", "id": "2549924"}]}