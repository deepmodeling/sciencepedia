{"hands_on_practices": [{"introduction": "胎生并非一个简单的“有或无”特征，而是一个涵盖从完全依赖卵黄营养（卵养胎生，lecithotrophy）到高度依赖母体营养（母养胎生，matrotrophy）的连续谱。为了对这一连续谱进行量化比较，生物学家引入了母养指数（Matrotrophy Index, $MI$）。本练习将指导您使用此指数，通过分析一组假设物种的数据来计算和解释母体投资的程度，从而加深对不同胎生策略的理解。[@problem_id:2621385]", "problem": "在对脊椎动物和一些具有胎生性状的植物的繁殖模式进行比较分析时，一个常用的产前营养供给的定量描述符是对数转换后的母体营养指数（LMI），其定义为新生个体质量与受精时（或可被可靠测量的最早受精后阶段）胚胎质量之比的自然对数。形式上，对于每个物种，对数转换后的母体营养指数定义为\n$$\nLMI \\equiv \\ln\\!\\left(\\frac{m_{\\text{birth}}}{m_{\\text{egg}}}\\right),\n$$\n其中$m_{\\text{egg}}$是受精时（或最早可用的胚胎阶段）的干重，$m_{\\text{birth}}$是出生时（或足月时）的干重。\n\n给定一个包含六个胎生物种的数据集，其干重以克为单位记录：\n- 物种A：$m_{\\text{egg}} = 1.20$克，$m_{\\text{birth}} = 1.05$克。\n- 物种B：$m_{\\text{egg}} = 0.018$克，$m_{\\text{birth}} = 0.045$克。\n- 物种C：$m_{\\text{egg}} = 50.0$克，$m_{\\text{birth}} = 47.0$克。\n- 物种D：$m_{\\text{egg}} = 80.0$克，$m_{\\text{birth}} = 320.0$克。\n- 物种E：$m_{\\text{egg}} = 0.75$克，$m_{\\text{birth}} = 1.05$克。\n- 物种F：$m_{\\text{egg}} = 0.60$克，$m_{\\text{birth}} = 0.48$克。\n\n任务：\n- 使用上述定义，计算每个物种的对数转换后的母体营养指数$LMI$。简要说明$LMI$的符号和大小如何将每个物种定位在卵黄营养-母体营养连续谱上。\n- 然后计算所有六个物种的对数转换后的母体营养指数值的算术平均值。\n\n仅报告对数转换后的母体营养指数的算术平均值作为最终答案。由于$LMI$是无量纲的，因此不报告单位。将平均值四舍五入到四位有效数字。", "solution": "问题陈述经验证具有科学依据，阐述清晰且客观。它为一项标准的生物学指标提供了正确的定义，附有完整的数据和明确且计算上可行的任务。陈述中没有矛盾、歧义或事实错误。下面我们进行求解。\n\n对数转换后的母体营养指数（$LMI$）定义为：\n$$\nLMI \\equiv \\ln\\left(\\frac{m_{\\text{birth}}}{m_{\\text{egg}}}\\right)\n$$\n其中$m_{\\text{birth}}$是出生时的质量，$m_{\\text{egg}}$是初始卵质量。该指数用于量化发育期间胚胎质量的净变化，可作为营养供给模式的替代指标。\n\n$LMI$的符号决定了其在卵黄营养-母体营养连续谱上的分类：\n- 如果$LMI > 0$，则$m_{\\text{birth}} > m_{\\text{egg}}$。这表示母体营养，即胚胎在发育过程中从母体获得大量营养，导致净质量增加。$LMI$的大小与母体供给的程度相关。\n- 如果$LMI  0$，则$m_{\\text{birth}}  m_{\\text{egg}}$。这表示卵黄营养，即胚胎主要由卵内的卵黄储备提供营养。质量的减少是由于发育的代谢成本，其中有机物被转化为能量，质量以二氧化碳和水等废物的形式损失。\n- 如果$LMI \\approx 0$，这代表纯粹的卵黄营养，其代谢质量损失可忽略不计，这是一个理论极限。\n\n我们现在为数据集中的每个物种计算$LMI$。\n\n对于物种A：$m_{\\text{egg}} = 1.20$克，$m_{\\text{birth}} = 1.05$克。\n$$\nLMI_A = \\ln\\left(\\frac{1.05}{1.20}\\right) = \\ln(0.875) \\approx -0.1335\n$$\n负值表示卵黄营养。\n\n对于物种B：$m_{\\text{egg}} = 0.018$克，$m_{\\text{birth}} = 0.045$克。\n$$\nLMI_B = \\ln\\left(\\frac{0.045}{0.018}\\right) = \\ln(2.5) \\approx 0.9163\n$$\n正值表示母体营养。\n\n对于物种C：$m_{\\text{egg}} = 50.0$克，$m_{\\text{birth}} = 47.0$克。\n$$\nLMI_C = \\ln\\left(\\frac{47.0}{50.0}\\right) = \\ln(0.94) \\approx -0.0619\n$$\n负值表示卵黄营养。相对于初始质量，质量损失很小，表明效率高或卵较大。\n\n对于物种D：$m_{\\text{egg}} = 80.0$克，$m_{\\text{birth}} = 320.0$克。\n$$\nLMI_D = \\ln\\left(\\frac{320.0}{80.0}\\right) = \\ln(4.0) \\approx 1.3863\n$$\n大的正值表示非常高程度的母体营养。\n\n对于物种E：$m_{\\text{egg}} = 0.75$克，$m_{\\text{birth}} = 1.05$克。\n$$\nLMI_E = \\ln\\left(\\frac{1.05}{0.75}\\right) = \\ln(1.4) \\approx 0.3365\n$$\n正值表示母体营养。\n\n对于物种F：$m_{\\text{egg}} = 0.60$克，$m_{\\text{birth}} = 0.48$克。\n$$\nLMI_F = \\ln\\left(\\frac{0.48}{0.60}\\right) = \\ln(0.8) \\approx -0.2231\n$$\n负值表示卵黄营养。\n\n最后的任务是计算这些值的算术平均值$\\overline{LMI}$。\n$$\n\\overline{LMI} = \\frac{1}{N} \\sum_{i=1}^{N} LMI_i\n$$\n对于我们包含$N=6$个物种的数据集：\n$$\n\\overline{LMI} = \\frac{LMI_A + LMI_B + LMI_C + LMI_D + LMI_E + LMI_F}{6}\n$$\n代入计算值（使用更高精度进行计算）：\n$$\n\\overline{LMI} \\approx \\frac{(-0.133546) + (0.916291) + (-0.061875) + (1.386294) + (0.336472) + (-0.223144)}{6}\n$$\n$$\n\\overline{LMI} \\approx \\frac{2.220492}{6} \\approx 0.370082\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n\\overline{LMI} \\approx 0.3701\n$$\n这个正的平均值表明，在这个特定的胎生物种样本中，母体营养策略比卵黄营养策略更为显著，这尤其受到高度母体营养的物种D的驱动。", "answer": "$$\\boxed{0.3701}$$", "id": "2621385"}, {"introduction": "在量化了母体投资的“结果”之后，我们来探讨其背后的“机制”。胎盘的效率本质上受到物质运输物理定律的制约，其结构必须能满足胎儿快速增长的代谢需求。本练习运用量纲分析和基本的扩散原理，来模拟营养物质穿过胎盘屏障的时间尺度与胎儿消耗这些物质的时间尺度之间的关系，这有助于我们理解生物结构的功能限制与适应性。[@problem_id:2621373]", "problem": "在脊椎动物胎生和胎盘的演化过程中，绒毛膜屏障的厚度调节着被动分子交换相对于胎儿代谢消耗的时间尺度。考虑一种中性单糖（葡萄糖类似物），它通过扩散穿过厚度为 $L$ 的绒毛膜屏障，在含水组织基质中的有效扩散系数为 $D$。在胎儿靶组织中，该代谢物的细胞内池浓度为 $C_{i}$，并因新陈代谢以体积速率 $J_{\\mathrm{met}}$ 被消耗。\n\n从屏障内的质量守恒和扩散通量定律出发，以扩散方程为基本依据，通过量纲分析得到穿过屏障的特征扩散时间 $t_{\\mathrm{diff}}$，作为 $L$ 和 $D$ 的函数。同样地，用 $C_{i}$ 和 $J_{\\mathrm{met}}$ 表示胎儿组织中的代谢周转时间尺度 $t_{\\mathrm{met}}$。然后，对于胎生有鳞目动物的绒毛尿囊胎盘，使用以下生理学上合理的参数，计算无量纲比 $R = t_{\\mathrm{diff}}/t_{\\mathrm{met}}$：\n\n- 屏障厚度 $L = 8\\,\\mu\\text{m}$，\n- 溶质在屏障中的有效扩散系数 $D = 6.4 \\times 10^{-10}\\ \\text{m}^{2}\\ \\text{s}^{-1}$，\n- 细胞内浓度 $C_{i} = 1.0\\ \\text{mM}$，\n- 体积代谢消耗速率 $J_{\\mathrm{met}} = 1.0 \\times 10^{-2}\\ \\text{mol}\\ \\text{m}^{-3}\\ \\text{s}^{-1}$。\n\n假设穿过屏障的扩散是一维的，对流可忽略不计，并且在所研究的尺度上，代谢池是充分混合的。将你的最终答案表示为 $R$ 的值（一个无单位的纯数），并四舍五入到三位有效数字。", "solution": "所述问题在科学上是合理的且提法适定。我们通过系统地处理每一个要求的部分来求解。\n\n首先，我们必须使用量纲分析，将特征扩散时间 $t_{\\mathrm{diff}}$ 表示为屏障厚度 $L$ 和有效扩散系数 $D$ 的函数。扩散的基本方程是菲克第二定律，其一维形式为：\n$$ \\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2} $$\n此处，$C$ 代表浓度，$t$ 是时间，$x$ 是空间坐标。为了进行量纲分析，我们检查这些参数的物理量纲。长度的量纲用 $\\text{L}$ 表示，时间用 $\\text{T}$ 表示。\n给定参数的量纲是：\n- 屏障厚度 $[L] = \\text{L}$\n- 扩散系数 $[D] = \\text{L}^2 \\text{T}^{-1}$\n\n我们寻求 $L$ 和 $D$ 的一个组合，其结果是一个具有时间量纲 $[\\text{T}]$ 的量。我们假设一个形式为 $t_{\\mathrm{diff}} \\propto L^a D^b$ 的关系，其中 $a$ 和 $b$ 是无量纲指数。用基本量纲表示这个关系：\n$$ [\\text{T}]^1 = [\\text{L}]^a ([\\text{L}]^2 [\\text{T}]^{-1})^b = [\\text{L}]^{a+2b} [\\text{T}]^{-b} $$\n为了满足这个量纲方程，等式两边各基本量纲的指数必须相等。这给出了一个包含两个线性方程的方程组：\n1. 对于量纲 T: $1 = -b \\implies b = -1$\n2. 对于量纲 L: $0 = a + 2b \\implies a = -2b$\n\n将 $b = -1$ 代入第二个方程，得到 $a = -2(-1) = 2$。\n因此，特征扩散时间必须与 $L^2 D^{-1}$ 成正比。我们定义特征扩散时间为：\n$$ t_{\\mathrm{diff}} = \\frac{L^2}{D} $$\n\n第二，我们必须用细胞内浓度 $C_i$ 和体积代谢消耗速率 $J_{\\mathrm{met}}$ 来表示代谢周转时间尺度 $t_{\\mathrm{met}}$。这个时间尺度代表了代谢过程消耗掉全部现有代谢物池所需的时间。相关参数的量纲如下，其中 $\\text{N}$ 代表物质的量（摩尔）的量纲：\n- 细胞内浓度 $[C_i] = \\text{N}\\text{L}^{-3}$\n- 体积代谢速率 $[J_{\\mathrm{met}}] = \\text{N}\\text{L}^{-3}\\text{T}^{-1}$\n\n该时间尺度是单位体积内的物质的量与单位体积内物质消耗速率的比值：\n$$ t_{\\mathrm{met}} = \\frac{C_i}{J_{\\mathrm{met}}} $$\n量纲检查证实了此表达式的有效性：$[\\text{T}] = \\frac{[\\text{N}\\text{L}^{-3}]}{[\\text{N}\\text{L}^{-3}\\text{T}^{-1}]}$。\n\n第三，我们计算无量纲比 $R = t_{\\mathrm{diff}}/t_{\\mathrm{met}}$。代入上面推导出的表达式：\n$$ R = \\frac{t_{\\mathrm{diff}}}{t_{\\mathrm{met}}} = \\frac{L^2 / D}{C_i / J_{\\mathrm{met}}} = \\frac{L^2 J_{\\mathrm{met}}}{D C_i} $$\n这个比值通常被称为 Damköhler 数，它比较了输运（扩散）时间尺度与反应（代谢）时间尺度。\n\n为了计算 $R$ 的数值，我们必须将所有给定参数转换为一组一致的国际单位制基本单位（米、秒、摩尔）。\n- 屏障厚度: $L = 8\\,\\mu\\text{m} = 8 \\times 10^{-6}\\ \\text{m}$\n- 有效扩散系数: $D = 6.4 \\times 10^{-10}\\ \\text{m}^{2}\\ \\text{s}^{-1}$\n- 细胞内浓度: $C_{i} = 1.0\\ \\text{mM} = 1.0\\ \\text{毫摩尔/升}$。由于 $1\\ \\text{升} = 10^{-3}\\ \\text{m}^3$ 且 $1\\ \\text{毫摩尔} = 10^{-3}\\ \\text{mol}$，我们有：\n$$ C_i = 1.0 \\frac{10^{-3}\\ \\text{mol}}{10^{-3}\\ \\text{m}^3} = 1.0\\ \\text{mol}\\ \\text{m}^{-3} $$\n- 体积代谢消耗速率: $J_{\\mathrm{met}} = 1.0 \\times 10^{-2}\\ \\text{mol}\\ \\text{m}^{-3}\\ \\text{s}^{-1}$\n\n现在我们将这些值代入 $R$ 的表达式中：\n$$ R = \\frac{(8 \\times 10^{-6}\\ \\text{m})^2 \\times (1.0 \\times 10^{-2}\\ \\text{mol}\\ \\text{m}^{-3}\\ \\text{s}^{-1})}{(6.4 \\times 10^{-10}\\ \\text{m}^{2}\\ \\text{s}^{-1}) \\times (1.0\\ \\text{mol}\\ \\text{m}^{-3})} $$\n$$ R = \\frac{64 \\times 10^{-12}\\ \\text{m}^2 \\times 1.0 \\times 10^{-2}\\ \\text{mol}\\ \\text{m}^{-3}\\ \\text{s}^{-1}}{6.4 \\times 10^{-10}\\ \\text{m}^{2}\\ \\text{s}^{-1} \\times 1.0\\ \\text{mol}\\ \\text{m}^{-3}} $$\n单位相互抵消，证实了 $R$ 是无量纲的。\n$$ R = \\frac{64 \\times 10^{-14}}{6.4 \\times 10^{-10}} $$\n$$ R = 10 \\times 10^{-14 - (-10)} = 10 \\times 10^{-4} = 10^{-3} $$\n计算值为 $R = 0.001$。问题要求将其表示为三位有效数字。用科学记数法，这写作 $1.00 \\times 10^{-3}$。", "answer": "$$ \\boxed{1.00 \\times 10^{-3}} $$", "id": "2621373"}, {"introduction": "像胎盘这样的复杂器官的演化，必然伴随着基因层面的深刻变革。我们如何才能在基因组中找到这些适应性演化的“确凿证据”？本练习介绍了一种分子演化领域的基石性技术——$d_N/d_S$ 比率检验，用于检测正选择。通过这项计算实践，您将学习如何分析基因序列数据，以识别可能驱动了胎盘发育和功能演化的关键演化动力。[@problem_id:2621367]", "problem": "一项比较动物学和植物学的研究旨在评估胎盘哺乳动物中与胎生相关的基因在胎盘演化过程中是否经历了阵发性正选择。考虑一个简化的、关注分支的密码子替换框架，其中沿着一个分支的非同义替换（改变氨基酸）和同义替换（沉默）作为两个独立的泊松过程产生。设 $k_N$ 和 $k_S$ 表示经过祖先重建后，一个分支上观测到的非同义和同义替换的计数，并设 $E_N$ 和 $E_S$ 表示相应的密码子机会暴露度（例如，预期的非同义和同义位点数乘以分支时间）。假设以下模型：预期的非同义计数为 $\\mu_N = E_N \\, d_N$，预期的同义计数为 $\\mu_S = E_S \\, d_S$，其中 $d_N$ 和 $d_S$ 是每机会替换率。定义比率 $\\omega = d_N / d_S$（非同义与同义替换率之比），当 $\\omega  1$ 时，该比率将正选择的解释操作化。\n\n以此为基本基础：替换的独立泊松过程假设、将 $\\omega$ 定义为速率比，以及最大似然估计 (MLE) 选择使泊松似然最大化的参数值的原则。将 $d_S$ 视为讨厌参数，并对 $H_0: \\omega = 1$ 与 $H_1: \\omega  1$ 进行似然比检验 (LRT)，自由度 (DOF) 为1，显著性阈值 $\\alpha = 0.05$（以小数表示）。检验统计量为 $T = 2 \\left[\\log L(\\hat{\\omega}) - \\log L(\\omega = 1)\\right]$，其中 $\\hat{\\omega}$ 是备择假设下的最大似然估计。在 $H_0$ 下，$T$ 渐近服从自由度为1的 $\\chi^2$ 分布。当且仅当 $\\hat{\\omega}  1$ 且根据 $T$ 值从 $\\chi^2$ 生存函数计算出的 $p$ 值小于 0.05（以小数表示）时，得出存在正选择的结论。不涉及角度。不需要物理单位。所有输出应为纯数字或布尔值。\n\n你的任务是编写一个完整的、可运行的程序，为下面的每个测试用例计算：\n- 在剖掉 $d_S$ 后，通过在 $\\omega  0$ 上最大化剖面对数似然来计算最大似然估计 $\\hat{\\omega}$，\n- 用于 $H_0: \\omega = 1$ 的似然比检验的检验统计量 $T$，\n- 正选择的布尔决策，定义为 $\\left(\\hat{\\omega}  1\\right)$ 且 $\\left(p  0.05\\right)$，其中 $p$ 是自由度为1时在 $T$ 处的 $\\chi^2$ 尾概率。\n\n每个测试用例仅返回布尔决策。\n\n测试套件（每个用例是一个元组 $(E_N, E_S, k_N, k_S)$）：\n- 用例 A（真兽类主干分支候选基因）：$(1200, 600, 50, 12)$\n- 用例 B（胎盘谱系，受约束基因）：$(1500, 750, 18, 20)$\n- 用例 C（有袋类外群分支）：$(1100, 550, 12, 11)$\n- 用例 D（短分支，稀疏变化）：$(1000, 1000, 0, 1)$\n- 用例 E（短分支，仅非同义信号）：$(900, 900, 3, 0)$\n- 用例 F（类中性对照）：$(5000, 2500, 100, 50)$\n\n科学真实性约束：\n- 假设 $k_N$ 和 $k_S$ 是均值为 $\\mu_N$ 和 $\\mu_S$ 的独立泊松计数。\n- 假设 $d_N = \\omega \\, d_S$，因此 $\\mu_N = E_N \\, \\omega \\, d_S$ 且 $\\mu_S = E_S \\, d_S$。\n- 对于任何固定的 $\\omega$，解析地剖掉 $d_S$ 以形成仅关于 $\\omega$ 的剖面似然，然后在 $\\omega  0$ 上进行优化以获得 $\\hat{\\omega}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个以逗号分隔的Python风格布尔值列表形式的结果，顺序与测试套件相同，例如，“[True,False,True,False,True,False]”。", "solution": "问题要求执行似然比检验（LRT）来评估正选择的假设，该假设操作化为非同义与同义替换率之比 $\\omega = d_N/d_S$ 大于1。必须对几个测试用例进行分析，每个用例都提供观测到的非同义（$k_N$）和同义（$k_S$）替换计数，以及它们对应的位点暴露度（$E_N$ 和 $E_S$）。每个用例的结论是一个布尔决策，指示正选择的证据是否在统计上显著。\n\n首先，我们形式化统计模型。计数 $k_N$ 和 $k_S$ 被假定为来自泊松分布的独立观测值：\n$$k_N \\sim \\text{Poisson}(\\mu_N)$$\n$$k_S \\sim \\text{Poisson}(\\mu_S)$$\n均值参数 $\\mu_N$ 和 $\\mu_S$ 由替换率 $d_N$ 和 $d_S$ 以及暴露度 $E_N$ 和 $E_S$ 定义。我们使用 $\\omega = d_N/d_S$ 和讨厌参数 $d_S$ 对模型进行重新参数化：\n$$\\mu_N = E_N d_N = E_N \\omega d_S$$\n$$\\mu_S = E_S d_S$$\n\n观测到计数 $(k_N, k_S)$ 的似然函数 $L(\\omega, d_S)$ 是两个泊松概率质量函数的乘积：\n$$L(\\omega, d_S) = \\frac{e^{-\\mu_N} \\mu_N^{k_N}}{k_N!} \\cdot \\frac{e^{-\\mu_S} \\mu_S^{k_S}}{k_S!}$$\n对数似然 $\\ell(\\omega, d_S) = \\log L(\\omega, d_S)$，忽略不影响最大化的常数项，为：\n$$\\ell(\\omega, d_S) \\propto - (E_N \\omega + E_S) d_S + (k_N + k_S) \\log d_S + k_N \\log \\omega$$\n\n为了找到 $\\omega$ 的最大似然估计 (MLE)，我们首先通过对于任何固定的 $\\omega$ 解析地最大化关于讨厌参数 $d_S$ 的 $\\ell(\\omega, d_S)$ 来推导 $\\omega$ 的剖面对数似然。取关于 $d_S$ 的偏导数并将其设为0，得到以 $\\omega$ 为条件的 $d_S$ 的最大似然估计：\n$$\\frac{\\partial \\ell}{\\partial d_S} = -(E_N \\omega + E_S) + \\frac{k_N + k_S}{d_S} = 0 \\implies \\hat{d}_S(\\omega) = \\frac{k_N + k_S}{E_N \\omega + E_S}$$\n\n将 $\\hat{d}_S(\\omega)$ 代回到 $\\ell(\\omega, d_S)$ 中，得到 $\\omega$ 的剖面对数似然 $\\ell_p(\\omega)$。最大化关于 $\\omega$ 的 $\\ell_p(\\omega)$ 得到最大似然估计 $\\hat{\\omega}$。\n$$\\frac{d \\ell_p(\\omega)}{d \\omega} \\propto \\frac{d}{d \\omega} \\left[ k_N \\log \\omega - (k_N + k_S) \\log(E_N \\omega + E_S) \\right] = 0$$\n$$\\frac{k_N}{\\omega} - \\frac{(k_N + k_S)E_N}{E_N \\omega + E_S} = 0$$\n在 $k_N  0$ 且 $k_S  0$ 的条件下求解此方程，得到 $\\omega$ 的最大似然估计：\n$$\\hat{\\omega} = \\frac{k_N E_S}{k_S E_N} = \\frac{k_N/E_N}{k_S/E_S}$$\n这是观测到的每位点非同义替换率与观测到的每位点同义替换率之比。\n\n我们必须处理边界情况：\n- 如果 $k_N = 0$（且 $k_S  0$），$\\ell_p(\\omega)$ 的导数恒为负，因此函数在边界 $\\omega \\to 0$ 处最大化。因此，$\\hat{\\omega} = 0$。\n- 如果 $k_S = 0$（且 $k_N  0$），导数恒为正，因此函数在边界 $\\omega \\to \\infty$ 处最大化。因此，$\\hat{\\omega} = \\infty$。\n- 如果 $k_N = 0$ 且 $k_S = 0$，似然函数是平坦的，参数是不可识别的。LRT统计量为0。将 $\\hat{\\omega}=1$ 是合理的。\n\n问题要求对 $H_0: \\omega = 1$ 与 $H_1: \\omega  1$ 进行似然比检验。检验统计量是 $T = 2(\\ell(H_1) - \\ell(H_0))$，其中 $\\ell(H_1)$ 和 $\\ell(H_0)$ 分别是备择假设和原假设下的最大化对数似然。\n\n这个统计量可以方便地表示。在 $H_1$ 下，平均计数的最大似然估计就是观测到的计数本身：$\\hat{\\mu}_N = k_N$ 和 $\\hat{\\mu}_S = k_S$（假设 $k_N, k_S  0$）。在 $H_0$ 下，我们约束 $\\omega=1$，意味着 $d_N=d_S=d$。公共速率 $d$ 的最大似然估计是 $\\hat{d}_0 = (k_N+k_S)/(E_N+E_S)$。在 $H_0$ 下的预期计数是 $\\hat{\\mu}_{N,0} = E_N \\hat{d}_0$ 和 $\\hat{\\mu}_{S,0} = E_S \\hat{d}_0$。检验统计量简化为G检验形式：\n$$T = 2 \\left( k_N \\log\\frac{k_N}{\\hat{\\mu}_{N,0}} + k_S \\log\\frac{k_S}{\\hat{\\mu}_{S,0}} \\right)$$\n此形式在 $k_N  0$ 且 $k_S  0$ 时有效。\n\n对于 $T$ 的边界情况：\n- 如果 $k_S=0$ 且 $k_N0$，可以证明 $T = 2 k_N \\log(1 + E_S / E_N)$。\n- 如果 $k_N=0$ 且 $k_S0$，可以证明 $T = 2 k_S \\log(1 + E_N / E_S)$。然而，由于在这种情况下 $\\hat{\\omega}=0$，正选择的检验立即失败。\n\n决策规则是当且仅当 $(\\hat{\\omega}  1)$ 且 $(p  0.05)$ 时得出存在正选择的结论，其中 $p$ 值是根据指定的自由度为1的 $\\chi^2$ 分布的生存函数推导出来的。\n\n我们现在将此程序应用于每个测试用例 $(E_N, E_S, k_N, k_S)$。\n\n用例 A: $(1200, 600, 50, 12)$\n- $k_N0$，$k_S0$。\n- $\\hat{\\omega} = \\frac{50 \\cdot 600}{12 \\cdot 1200} = \\frac{25}{12} \\approx 2.083$。由于 $\\hat{\\omega}  1$，我们继续。\n- 在 $H_0$ 下：$\\hat{d}_0 = \\frac{50+12}{1200+600} = \\frac{62}{1800}$。\n- $\\hat{\\mu}_{N,0} = 1200 \\cdot \\frac{62}{1800} = \\frac{124}{3} \\approx 41.333$。\n- $\\hat{\\mu}_{S,0} = 600 \\cdot \\frac{62}{1800} = \\frac{62}{3} \\approx 20.667$。\n- $T = 2 \\left( 50 \\log\\frac{50}{124/3} + 12 \\log\\frac{12}{62/3} \\right) \\approx 5.99$。\n- 在 $\\alpha=0.05$ 时，$\\chi^2_1$ 的临界值约为 $3.841$。由于 $T  3.841$，p值小于0.05。\n- 两个条件都满足。决策：True。\n\n用例 B: $(1500, 750, 18, 20)$\n- $\\hat{\\omega} = \\frac{18 \\cdot 750}{20 \\cdot 1500} = \\frac{18}{40} = 0.45$。\n- 由于 $\\hat{\\omega} \\le 1$，正选择的第一个条件未满足。\n- 决策：False。\n\n用例 C: $(1100, 550, 12, 11)$\n- $\\hat{\\omega} = \\frac{12 \\cdot 550}{11 \\cdot 1100} = \\frac{12}{22} = \\frac{6}{11} \\approx 0.545$。\n- 由于 $\\hat{\\omega} \\le 1$，正选择的条件未满足。\n- 决策：False。\n\n用例 D: $(1000, 1000, 0, 1)$\n- $k_N=0$。这导致 $\\hat{\\omega} = 0$。\n- 由于 $\\hat{\\omega} \\le 1$，正选择的条件未满足。\n- 决策：False。\n\n用例 E: $(900, 900, 3, 0)$\n- $k_S=0$ 且 $k_N  0$。这导致 $\\hat{\\omega} = \\infty$。条件 $\\hat{\\omega}1$ 被满足。\n- 我们必须计算这个边界情况的LRT统计量：\n- $T = 2 k_N \\log(1 + E_S/E_N) = 2 \\cdot 3 \\log(1 + 900/900) = 6 \\log(2) \\approx 4.159$。\n- 由于 $T \\approx 4.159  3.841$，p值小于0.05。\n- 两个条件都满足。决策：True。\n\n用例 F: $(5000, 2500, 100, 50)$\n- $\\hat{\\omega} = \\frac{100 \\cdot 2500}{50 \\cdot 5000} = \\frac{2 \\cdot 2500}{5000} = 1$。\n- 由于 $\\hat{\\omega} \\le 1$，正选择的条件未满足。数据完美拟合原假设。\n- 决策：False。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Test suite from the problem statement.\n    # Each case is a tuple (E_N, E_S, k_N, k_S).\n    test_cases = [\n        (1200, 600, 50, 12),    # Case A\n        (1500, 750, 18, 20),    # Case B\n        (1100, 550, 12, 11),    # Case C\n        (1000, 1000, 0, 1),     # Case D\n        (900, 900, 3, 0),       # Case E\n        (5000, 2500, 100, 50),  # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        E_N, E_S, k_N, k_S = case\n        \n        # The decision rule for positive selection requires two conditions to be met:\n        # 1. The Maximum Likelihood Estimate (MLE) of omega must be greater than 1.\n        # 2. The p-value from the Likelihood Ratio Test (LRT) must be less than 0.05.\n        \n        # Convert inputs to float for calculations to avoid integer division issues.\n        E_N, E_S, k_N, k_S = float(E_N), float(E_S), float(k_N), float(k_S)\n        \n        # --- Handle edge cases for omega_hat calculation ---\n\n        if k_N == 0:\n            # If there are no nonsynonymous substitutions, the MLE of the nonsynonymous\n            # rate is 0, so omega_hat is 0. This cannot be positive selection.\n            # This also covers the k_N=0, k_S=0 case.\n            is_positive_selection = False\n        elif k_S == 0:\n            # If k_N  0 and k_S == 0, the MLE for omega is infinity.\n            # The first condition (omega_hat  1) is met. We must check the p-value.\n            omega_hat = np.inf\n            \n            # The LRT statistic T for this boundary case has a specific formula:\n            # T = 2 * k_N * log(1 + E_S / E_N)\n            # We use np.log1p(x) which calculates log(1+x) for better precision.\n            T = 2.0 * k_N * np.log1p(E_S / E_N)\n            \n            # The p-value is obtained from the survival function (1-CDF) of the\n            # chi-squared distribution with 1 degree of freedom.\n            p_value = chi2.sf(T, df=1)\n            \n            is_positive_selection = (omega_hat  1.0) and (p_value  0.05)\n        else:\n            # --- General case: k_N  0 and k_S  0 ---\n            \n            # Calculate the MLE of omega.\n            omega_hat = (k_N / E_N) / (k_S / E_S)\n            \n            # Check the first condition. If not met, no need for further calculation.\n            if omega_hat = 1.0:\n                is_positive_selection = False\n            else:\n                # Calculate the LRT statistic T. It simplifies to the G-test form.\n                # T = 2 * sum(O * log(O/E))\n                \n                # Expected counts under the null hypothesis (H0: omega = 1).\n                d0_hat = (k_N + k_S) / (E_N + E_S)\n                mu_N0 = E_N * d0_hat\n                mu_S0 = E_S * d0_hat\n                \n                # Calculate T.\n                term1 = k_N * np.log(k_N / mu_N0)\n                term2 = k_S * np.log(k_S / mu_S0)\n                T = 2.0 * (term1 + term2)\n                \n                # Calculate the p-value.\n                p_value = chi2.sf(T, df=1)\n                \n                # Apply the final decision rule.\n                is_positive_selection = (omega_hat  1.0) and (p_value  0.05)\n                \n        results.append(is_positive_selection)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2621367"}]}