{"hands_on_practices": [{"introduction": "理论是实验的基石。在深入研究连接蛋白和潘星蛋白的实验细节之前，掌握它们在细胞间通讯中扮演的角色的基本物理原理至关重要。本练习将引导您从第一性原理（基尔霍夫电流定律和欧姆定律）出发，推导两个由缝隙连接耦合的神经元之间的稳态耦合系数。通过这个推导，您将深刻理解细胞自身的膜属性（$G_m$）和连接通道的属性（$G_j$）如何共同决定电突触的信号传递效率，为后续定量分析实验数据打下坚实的理论基础。[@problem_id:2706189]", "problem": "在许多中枢神经系统制备中，电突触是由connexin蛋白（Cx）形成的间隙连接通道介导的，在某些脊椎动物的情况下，也由可以组装成细胞间通道的pannexin蛋白（Panx）介导。考虑由一个单一的、线性的、以连接电导$G_j$为特征的间隙连接耦合的$2$个相同神经元。每个神经元的细胞膜被建模为一个被动漏电，其膜电导为$G_m$，连接到一个等电位细胞外液（接地），并与一个膜电容$C_m$并联。一个恒定电流$I$被注入到神经元1中，而神经元2没有接收到直接的电流注入。假设在恒定电流$I$下，系统具有纯被动、时不变的特性（没有电压依赖性电导）和稳态条件，因此在稳态下电容电流为零。\n\n将稳态耦合系数$k$定义为比率$k = \\Delta V_2 / \\Delta V_1$，其中$\\Delta V_1$和$\\Delta V_2$分别是神经元1和神经元2在响应注入电流$I$时，相对于静息电位的稳态电压偏转。\n\n仅从Kirchhoff电流定律和Ohm定律（即电流等于电导乘以电压差）出发，推导一个仅用$G_j$和$G_m$表示的$k$的解析表达式。将您的最终答案表示为单个闭式表达式。耦合系数$k$是无量纲的；不要包含单位。无需四舍五入；报告精确表达式。", "solution": "该场景是一个等效线性电路，其中每个神经元的细胞膜由一个到地的漏电导$G_m$表示，一个间隙连接电导$G_j$连接两个胞内节点。在恒定电流$I$和稳态下，电容电流消失，因为当$dV/dt = 0$时，$I_C = C_m \\, dV/dt = 0$。因此，只有电阻性（导电性）通路承载电流。\n\n设神经元1和神经元2相对于静息电位的稳态电压分别为$V_1$和$V_2$。根据每个节点的Kirchhoff电流定律，离开胞内节点的电流的代数和等于该节点的净注入电流。使用Ohm定律，通过任何电导的电流等于该电导乘以其两端的电压。\n\n对于神经元1，到地的膜漏电流为$G_m V_1$，从神经元1流向神经元2的连接电流为$G_j (V_1 - V_2)$。注入电流$I$进入神经元1。将离开节点的电流取为正值，Kirchhoff电流定律给出\n$$\nI = G_m V_1 + G_j (V_1 - V_2).\n$$\n\n对于神经元2，没有注入电流。到地的膜漏电流为$G_m V_2$，离开神经元2流向神经元1的连接电流为$G_j (V_2 - V_1)$。在神经元2处的Kirchhoff电流定律得出\n$$\n0 = G_m V_2 + G_j (V_2 - V_1).\n$$\n\n我们要求解稳态耦合系数$k$，其定义为\n$$\nk = \\frac{V_2}{V_1}.\n$$\n\n从神经元2的方程，\n$$\nG_m V_2 + G_j (V_2 - V_1) = 0\n\\;\\;\\Longrightarrow\\;\\;\n(G_m + G_j) V_2 = G_j V_1\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{V_2}{V_1} = \\frac{G_j}{G_m + G_j}.\n$$\n\n因此，\n$$\nk = \\frac{G_j}{G_m + G_j}.\n$$\n\n此表达式仅依赖于$G_j$和$G_m$，是无量纲的，并反映了两个相同的、通过由connexin或（在适当情况下）pannexin蛋白形成的间隙连接被动耦合的神经元之间，连接通路和膜漏通路上的稳态分压。", "answer": "$$\\boxed{\\frac{G_j}{G_m+G_j}}$$", "id": "2706189"}, {"introduction": "在建立了电耦合的理论框架后，下一步是将其应用于真实的电生理数据分析。这个练习模拟了一个典型的电压钳实验场景，要求您根据测得的跨连接电流和电压，反向计算出连接的总电导以及构成该连接的单个通道的数量。这项实践旨在连接宏观测量（皮安级的电流）与微观世界（单个离子通道的开放），让您亲手体验如何从实验数据中提取关于缝隙连接斑（junctional plaque）分子组成和门控状态的关键信息。[@problem_id:2706271]", "problem": "两个电耦合的抑制性中间神经元被电压钳制，它们之间的跨连接电压 $V_j$ 保持恒定。间隙连接由连接蛋白-36 (Cx36) 通道构成。假设在小的指令电压范围内呈欧姆行为，并且每个细胞间间隙连接通道贡献一个恒定的单位电导。在稳态下获得以下数据：在跨连接电压 $V_j = 9.0$ mV 时，测得连接电流 $I_j = 16.2$ pA。单个 Cx36 间隙连接通道的单位电导为 $12$ pS。假设通道是独立同分布的门控通道，在此电压下其开放概率 ($P_o$) 为 $0.5$。\n\n仅从连接处的欧姆定律和独立并联通道电导可加性定义出发，确定：\n1) 连接电导 $G_j$，\n2) 在此稳态下开放的 Cx36 通道的期望数量 $N_{\\text{open}}$，\n3) 连接斑中存在的 Cx36 通道的估计总数 $N_{\\text{total}}$。\n\n将 $G_j$ 以纳西门子 (nS) 表示。将最终答案以行向量 $\\big[G_j\\ \\text{(nS)},\\ N_{\\text{open}},\\ N_{\\text{total}}\\big]$ 的形式报告。无需四舍五入；如果选择四舍五入，请使用四位有效数字。", "solution": "该问题经检验具有科学依据、提法明确且客观。它提供了基于电生理学基本原理确定所求量所需的所有信息。给出的连接电流、电压和单位通道电导值对于由Connexin-36组成的神经元间隙连接是生理学上合理的。我将继续进行解答。\n\n该问题要求计算三个量：总连接电导 $G_j$、开放通道的期望数量 $N_{\\text{open}}$ 和通道总数 $N_{\\text{total}}$。这将通过顺序应用问题中陈述的基本原理来完成。\n\n首先，我们确定连接电导 $G_j$。问题陈述连接表现出欧姆行为，这由欧姆定律描述。对于一个导电元件，欧姆定律通过方程 $I = G V$ 将通过它的电流 $I$、其两端的电压 $V$ 及其电导 $G$ 联系起来。对于间隙连接，这变为：\n$$I_j = G_j V_j$$\n其中 $I_j$ 是连接电流，$V_j$ 是跨连接电压。给定 $I_j = 16.2$ pA 和 $V_j = 9.0$ mV。为了求得 $G_j$，我们重新整理方程：\n$$G_j = \\frac{I_j}{V_j}$$\n在计算中我们必须使用一致的国际单位制单位。前缀皮(p)对应于因子 $10^{-12}$，毫(m)对应于 $10^{-3}$。\n$$G_j = \\frac{16.2 \\times 10^{-12} \\text{ A}}{9.0 \\times 10^{-3} \\text{ V}} = 1.8 \\times 10^{-9} \\text{ S}$$\n电导的单位是西门子 (S)。问题要求结果以纳西门子 (nS) 表示，其中前缀纳 (n) 对应于因子 $10^{-9}$。因此：\n$$G_j = 1.8 \\text{ nS}$$\n\n其次，我们确定开放通道的期望数量 $N_{\\text{open}}$。问题陈述连接的总电导是单个开放通道的电导之和，这些通道作为独立的并联导体。这就是电导可加性原理。总连接电导 $G_j$ 是开放通道数 $N_{\\text{open}}$ 与单个通道的单位电导（我们记作 $\\gamma_{ch}$）的乘积。\n$$G_j = N_{\\text{open}} \\cdot \\gamma_{ch}$$\n给定单位电导 $\\gamma_{ch} = 12$ pS。我们可以解出 $N_{\\text{open}}$：\n$$N_{\\text{open}} = \\frac{G_j}{\\gamma_{ch}}$$\n使用先前计算的 $G_j$ 值并确保单位一致（皮，p，是 $10^{-12}$），我们有：\n$$N_{\\text{open}} = \\frac{1.8 \\times 10^{-9} \\text{ S}}{12 \\times 10^{-12} \\text{ S}} = \\frac{1.8}{12} \\times 10^3 = 0.15 \\times 1000 = 150$$\n因此，稳态下开放通道的期望数量是 $150$。由于这是一个期望值，它不要求是整数，但在这种特殊情况下，计算结果为一个整数。\n\n第三，我们估计连接斑中的通道总数 $N_{\\text{total}}$。开放概率 $P_o$ 定义为开放通道的期望数量与可开放通道总数之比。\n$$P_o = \\frac{N_{\\text{open}}}{N_{\\text{total}}}$$\n给定在此跨连接电压下，$P_o = 0.5$。我们可以重新整理这个定义来求解 $N_{\\text{total}}$：\n$$N_{\\text{total}} = \\frac{N_{\\text{open}}}{P_o}$$\n代入先前计算的 $N_{\\text{open}}$ 值和给定的 $P_o$ 值：\n$$N_{\\text{total}} = \\frac{150}{0.5} = 300$$\n我们估计连接中Connexin-36通道的总数为 $300$。\n\n所求的三个值是：$G_j = 1.8$ nS，$N_{\\text{open}} = 150$，以及 $N_{\\text{total}} = 300$。", "answer": "$$\\boxed{\\begin{pmatrix} 1.8 & 150 & 300 \\end{pmatrix}}$$", "id": "2706271"}, {"introduction": "连接蛋白介导的通讯不仅限于神经元之间的直接耦合，在胶质细胞网络中也扮演着核心角色。本练习将挑战您通过计算机编程，构建一个模拟海马区神经网络的计算模型，以探索星形胶质细胞通过连接蛋白 $43$ (Cx$43$) 形成的合胞体如何影响癫痫波的传播。这项高级实践将理论知识和计算技能相结合，展示了如何利用计算神经科学的方法来研究分子层面的特性（如缝隙连接的耦合强度）如何涌现为复杂的系统级生理或病理现象（如癫痫阈值的改变）。[@problem_id:2706252]", "problem": "设计并实现一个完整的、可运行的程序，进行一项计算实验，以测试在一维海马网络模型中，增强星形胶质细胞连接蛋白 $43$ (Cx$43$) 间隙连接耦合是否会改变癫痫传播阈值。该实验必须基于以下基本原则和核心定义构建：\n\n- 菲克扩散定律：通量与浓度梯度成正比，这在离散一维晶格中通过离散拉普拉斯算子来描述。由连接蛋白 $43$ (Cx$43$) 介导的星形胶质细胞间隙连接耦合会增加有效的合胞体扩散。\n- 阈值神经元激活：当一个有效兴奋性变量超过阈值时，神经元放电；细胞外钾离子浓度调节兴奋性。\n- 线性摄取和边界清除：细胞外钾以一级动力学被星形胶质细胞摄取，并在血管化边界被清除，清除率与耦合强度成正比，以反映星形胶质细胞合胞体对汇（sinks）的增强接触。\n\n模型规格：\n\n- 具有 $N$ 个节点（索引 $i \\in \\{0, \\dots, N-1\\}$）的一维链在 $T$ 个离散时间步长 $t \\in \\{0, \\dots, T-1\\}$ 内进行模拟。\n- 令 $K_i(t)$ 表示细胞外钾（任意单位），$x_i(t) \\in \\{0,1\\}$ 表示神经元活动（静息或放电）。\n- 时间 $t$ 时的有效兴奋性为\n$$\nE_i(t) = \\beta\\,K_i(t) + \\gamma\\,[x_{i-1}(t) + x_{i+1}(t)] + S\\,\\delta_{i,0}\\,\\delta_{t,0},\n$$\n其中 $\\delta$ 表示克罗内克 δ，$S$ 是仅在节点 $i=0$ 和时间 $t=0$ 施加的刺激振幅，$\\beta$ 缩放细胞外钾对兴奋性的贡献，$\\gamma$ 缩放最近邻突触/电场效应驱动。链外的边界索引贡献为零。\n- 阈值放电规则：\n$$\nx_i(t+1) = \\begin{cases}\n1 & \\text{if } E_i(t) \\ge \\theta,\\\\\n0 & \\text{otherwise.}\n\\end{cases}\n$$\n- 细胞外钾动力学包含神经元释放、摄取、通过星形胶质细胞合胞体的离散扩散以及边界清除：\n$$\nK_i(t+1) = K_i(t) + r_{\\text{rel}}\\,x_i(t+1) - u\\,[K_i(t) - K_{\\text{rest}}] + D_a\\,\\Delta K_i(t) - \\kappa\\,D_a\\,b_i\\,[K_i(t) - K_{\\text{rest}}],\n$$\n其中 $r_{\\text{rel}}$ 是每个放电步骤的释放量，$u$ 是摄取率，$K_{\\text{rest}}$ 是静息钾浓度，$D_a$ 是星形胶质细胞耦合强度，与 Cx$43$ 介导的间隙连接扩散成正比，$\\kappa$ 是边界清除系数，$b_i=1$ 对应 $i \\in \\{0, N-1\\}$ 且在其他情况下 $b_i=0$。具有反射边界的离散拉普拉斯算子为\n$$\n\\Delta K_i(t) =\n\\begin{cases}\nK_{1}(t) - K_{0}(t) & \\text{if } i=0,\\\\\nK_{i-1}(t) - 2K_i(t) + K_{i+1}(t) & \\text{if } 1\\le i \\le N-2,\\\\\nK_{N-2}(t) - K_{N-1}(t) & \\text{if } i=N-1.\n\\end{cases}\n$$\n- 初始条件：对于所有 $i$，$K_i(0) = K_{\\text{rest}}$，且对于所有 $i$，$x_i(0)=0$。\n\n癫痫传播阈值的定义：\n\n- 对于给定的 $D_a$，定义传播成功指示器为真，如果在模拟窗口 $t \\in \\{0, \\dots, T\\}$ 期间，任何索引 $i \\ge \\lfloor N/2 \\rfloor$ 的节点至少放电一次。定义阈值 $S^\\star(D_a)$ 为使传播成功为真的最小 $S$。如果在闭区间 $[0, S_{\\max}]$ 内的所有 $S$ 都导致传播成功为假，则定义 $S^\\star(D_a)=+\\infty$。\n\n您的程序必须：\n- 精确实现上述动力学，并利用成功指示器在 $S$ 上的单调性，通过在 $S \\in [0, S_{\\max}]$ 上进行二分搜索来确定 $S^\\star(D_a)$。\n- 使用以下固定参数：\n  - $N=64$, $T=400$,\n  - $K_{\\text{rest}}=3.0$, $r_{\\text{rel}}=1.0$, $u=0.02$, $\\kappa=0.1$,\n  - $\\beta=1.2$, $\\gamma=1.0$, $\\theta=5.0$,\n  - $S_{\\max}=20.0$,\n  - 二分法绝对容差 $\\varepsilon=10^{-3}$ 和最大迭代次数 $40$。\n- 将所有量视为无量纲，并以任意单位将 $S^\\star$ 报告为实数。将每个报告的阈值四舍五入到 $4$ 位小数。\n- 忽略潘星蛋白半通道通量；仅通过 $D_a$ 模拟 Cx$43$ 介导的合胞体扩散。\n\n测试套件：\n- 评估以下星形胶质细胞耦合强度 $D_a$ 的阈值：\n  - 情况 1：$D_a=0.0$（无 Cx$43$ 耦合；边界情况），\n  - 情况 2：$D_a=0.02$（弱耦合），\n  - 情况 3：$D_a=0.05$（中等耦合），\n  - 情况 4：$D_a=0.1$（强耦合）。\n  \n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表，按测试套件案例的顺序排列结果，例如 $[s_1, s_2, s_3, s_4]$，其中每个 $s_j$ 是四舍五入到 $4$ 位小数的 $S^\\star(D_a)$，而 $+\\infty$ 则打印为正无穷的字符串表示（例如，$inf$）。", "solution": "该问题要求设计并实现一个计算实验，以研究在一个简化的一维神经元网络模型中，由连接蛋白 $43$ (Cx$43$) 介导的星形胶质细胞间隙连接耦合对癫痫传播阈值的影响。验证和解决方案设计过程如下。\n\n首先，对问题陈述进行验证。提取所有给定的数据、方程和参数。该模型是一个耦合差分方程组，表示在一维晶格上的反应扩散过程。它基于已建立的神经生理学原理：基于阈值的神经元放电、细胞外钾 $[K^+]_o$ 对兴奋性的调节，以及通过离散拉普拉斯算子建模的 $K^+$ 星形胶质细胞合胞体扩散。所有参数都已指定，初始和边界条件也已定义，目标——为不同星形胶质细胞耦合强度 $D_a$ 找到癫痫传播的最小刺激 $S^\\star$——是明确的。鉴于刺激强度 $S$ 和传播成功之间预期的单调关系，寻找此阈值的方法（二分搜索）也已指定且是适当的。离散拉普拉斯算子 $\\Delta K_i(t)$ 在边界（$i=0$ 和 $i=N-1$）的定义是非标准的，但已明确提供，因此必须按规定实现。该问题具有科学依据、良定、客观，且不含不一致或缺失的信息。结论是该问题有效。\n\n该解决方案构建为一个 Python 程序，包含两个主要函数：一个模拟引擎和一个阈值查找例程。\n\n$1$. **模拟算法**：设计一个函数 `run_simulation(S, Da)`，用于为给定的刺激振幅 $S$ 和星形胶质细胞耦合强度 $D_a$ 执行网络的时间演化。\n在每个时间步长 $t$，系统的状态由两个大小为 $N$ 的向量描述：$K(t)$ 表示细胞外钾浓度，$x(t)$ 表示二元神经元活动状态。这些向量根据问题陈述进行初始化：对于所有节点 $i \\in \\{0, \\dots, N-1\\}$，$K_i(0) = K_{\\text{rest}}$ 且 $x_i(0)=0$。\n\n模拟进行 $T$ 个时间步长。在每个步长 $t \\in \\{0, \\dots, T-1\\}$ 中，下一个时间步长 $t+1$ 的状态按如下方式计算：\n- 使用状态 $K_i(t)$ 和 $x_i(t)$ 计算每个神经元 $i$ 的有效兴奋性 $E_i(t)$：\n$$\nE_i(t) = \\beta\\,K_i(t) + \\gamma\\,[x_{i-1}(t) + x_{i+1}(t)] + S\\,\\delta_{i,0}\\,\\delta_{t,0}\n$$\n对于边界神经元 $i=0$ 和 $i=N-1$，通过假设 $x_{-1}(t)=0$ 和 $x_{N}(t)=0$ 来处理突触邻居的贡献。刺激 $S$ 仅加到 $E_0(0)$ 上。\n- 下一个时间步长的神经元活动 $x_i(t+1)$ 由一个简单的阈值规则确定：\n$$\nx_i(t+1) = 1 \\text{ if } E_i(t) \\ge \\theta, \\text{ and } 0 \\text{ otherwise.}\n$$\n- 在计算完 $x(t+1)$ 后，进行传播成功检查。如果链的远端一半（$i \\ge \\lfloor N/2 \\rfloor$）中的任何神经元变为活动状态，`run_simulation` 会立即返回 `True`，因为条件已满足。\n- 然后计算下一步的钾浓度 $K_i(t+1)$。更新过程包含几个效应：放电神经元的释放、星形胶质细胞的摄取、通过星形胶质细胞合胞体的扩散以及在边界处的清除。\n$$\nK_i(t+1) = K_i(t) + r_{\\text{rel}}\\,x_i(t+1) - u\\,[K_i(t) - K_{\\text{rest}}] + D_a\\,\\Delta K_i(t) - \\kappa\\,D_a\\,b_i\\,[K_i(t) - K_{\\text{rest}}]\n$$\n离散拉普拉斯算子 $\\Delta K_i(t)$ 完全按照为内部和边界节点指定的公式计算。所有这些计算都使用 NumPy 的向量化操作实现以提高效率。\n- 如果模拟完成所有 $T$ 个时间步长而未触发传播成功，则函数返回 `False`。\n\n$2$. **阈值确定**：第二个函数 `find_threshold(Da)` 负责搜索传播阈值 $S^\\star(D_a)$。它在区间 $[0, S_{\\max}]$ 上对刺激振幅 $S$ 使用二分搜索算法。\n- 首先，它通过调用 `run_simulation(S_{\\max}, Da)` 来检查即使在最大刺激 $S_{\\max}$ 下传播是否可能。如果失败，则认为阈值 $S^\\star$ 大于 $S_{\\max}$，函数返回 $+\\infty$。\n- 二分法进行最大迭代次数，或直到搜索区间 $[S_{\\text{low}}, S_{\\text{high}}]$ 小于指定的绝对容差 $\\varepsilon = 10^{-3}$ 为止。在每次迭代中，测试中点 $S_{\\text{mid}}$。如果 `run_simulation(S_{\\text{mid}}, Da)` 返回 `True`，则阈值必定在下半部分，因此将 $S_{\\text{high}}$ 设置为 $S_{\\text{mid}}$。否则，阈值必定在上半部分，并将 $S_{\\text{low}}$ 设置为 $S_{\\text{mid}}$。\n- $S_{\\text{high}}$ 的最终值作为最小阈值 $S^\\star$ 的估计值返回。\n\n主程序遍历 $D_a$ 的四个指定测试用例，从 $0.0$ 到 $0.1$。对于每个用例，它调用 `find_threshold` 来计算 $S^\\star(D_a)$，将结果四舍五入到 $4$ 位小数，并将其格式化为最终输出字符串，用 `inf` 表示正无穷大。对给定参数下的系统动力学进行分析表明，要使传播从神经元 $i$ 发生到 $i+1$，要么突触耦合项 $\\gamma$ 本身足够强，要么钾扩散必须将 $K_{i+1}$ 提升到足够高的水平。初步的纸笔分析表明，在给定参数（$\\gamma=1.0$，$\\beta=1.2$ 等）下，即使星形胶质细胞耦合 $D_a$ 高达 $0.1$，这两种机制都不足以维持传播波。这意味着在所有测试用例中，传播阈值 $S^\\star$ 可能都是无穷大。所实现的计算实验将为该模型提供明确的答案。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a computational experiment to test whether strengthening\n    astrocyte Connexin 43 (Cx43) gap junction coupling alters seizure propagation\n    thresholds in a one-dimensional hippocampal network model.\n    \"\"\"\n    \n    # Fixed parameters from the problem statement\n    N = 64\n    T = 400\n    K_rest = 3.0\n    r_rel = 1.0\n    u = 0.02\n    kappa = 0.1\n    beta = 1.2\n    gamma = 1.0\n    theta = 5.0\n    S_max = 20.0\n    epsilon = 1e-3\n    max_iter = 40\n    \n    # Test suite for astrocyte coupling strength Da\n    test_cases_Da = [0.0, 0.02, 0.05, 0.1]\n    \n    # Pre-calculated boundary indicator vector b_i\n    b = np.zeros(N, dtype=np.float64)\n    b[0] = 1.0\n    b[-1] = 1.0\n    \n    # Propagation target check: nodes from the middle to the end of the chain\n    propagation_slice = slice(N // 2, N)\n\n    def run_simulation(S, Da):\n        \"\"\"\n        Simulates the network dynamics for a given stimulus S and coupling strength Da.\n        Returns True if seizure propagation is successful, False otherwise.\n        \"\"\"\n        K = np.full(N, K_rest, dtype=np.float64)\n        x = np.zeros(N, dtype=np.int8)\n        \n        for t in range(T):\n            # 1. Calculate effective excitability E_i(t)\n            E = np.zeros(N, dtype=np.float64)\n            \n            # Synaptic/ephaptic drive from neighbors\n            E[1:-1] = gamma * (x[:-2] + x[2:])\n            E[0] = gamma * x[1]\n            E[-1] = gamma * x[-2]\n            \n            # Contribution from extracellular potassium\n            E += beta * K\n            \n            # Apply stimulus S at t=0, i=0\n            if t == 0:\n                E[0] += S\n            \n            # 2. Determine neuronal firing for the next step, x_i(t+1)\n            x_next = (E >= theta).astype(np.int8)\n            \n            # 3. Check for propagation success\n            if np.any(x_next[propagation_slice]):\n                return True\n            \n            # 4. Calculate extracellular potassium for the next step, K_i(t+1)\n            # Calculate discrete Laplacian\n            lap_K = np.zeros(N, dtype=np.float64)\n            lap_K[1:-1] = K[:-2] - 2 * K[1:-1] + K[2:]\n            lap_K[0] = K[1] - K[0]\n            lap_K[-1] = K[-2] - K[-1]\n            \n            # Update potassium concentration\n            K_next = K + r_rel * x_next - u * (K - K_rest) \\\n                     + Da * lap_K - kappa * Da * b * (K - K_rest)\n            \n            # Update state for the next iteration\n            K = K_next\n            x = x_next\n            \n        return False\n\n    def find_threshold(Da):\n        \"\"\"\n        Finds the minimal stimulus threshold S* for a given coupling strength Da\n        using a bisection search.\n        \"\"\"\n        # If propagation fails even at S_max, threshold is effectively infinite\n        if not run_simulation(S_max, Da):\n            return np.inf\n\n        # Bisection search for the threshold S*\n        S_low, S_high = 0.0, S_max\n        for _ in range(max_iter):\n            if S_high - S_low  epsilon:\n                break\n                \n            S_mid = S_low + (S_high - S_low) / 2\n            if run_simulation(S_mid, Da):\n                S_high = S_mid  # Midpoint is a new upper bound\n            else:\n                S_low = S_mid   # Midpoint is a new lower bound\n\n        return S_high\n\n    results = []\n    for Da in test_cases_Da:\n        threshold = find_threshold(Da)\n        if np.isinf(threshold):\n            results.append('inf')\n        else:\n            results.append(f\"{threshold:.4f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2706252"}]}