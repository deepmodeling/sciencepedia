{"hands_on_practices": [{"introduction": "要理解不同多巴胺受体家族的独特作用，我们首先必须量化它们的基本结合特性。本练习提供了应用质量作用定律的基础实践，用于计算和比较高亲和力的 D2 样受体和低亲和力的 D1 样受体在持续性（tonic）多巴胺浓度下的稳态占有率。这是量化受体行为的第一步。", "problem": "纹状体中的一个中型多棘神经元同时表达多巴胺 (DA) $D_1$样和$D_2$样受体家族。在紧张性条件下，细胞外多巴胺浓度近似均匀，为 $[\\mathrm{DA}] = 30\\,\\mathrm{nM}$，并且相对于总受体浓度，多巴胺的量大大过量，因此游离配体浓度可视为 $[\\mathrm{L}] \\approx [\\mathrm{DA}]$。假设多巴胺与每个受体家族的结合是单一位点、可逆、非协同的，并处于一个充分混合的稳态。解离常数由质量作用定律定义为 $K_{d} = \\frac{[\\mathrm{R}][\\mathrm{L}]}{[\\mathrm{RL}]}$，其中 $[\\mathrm{R}]$ 是游离受体浓度，$[\\mathrm{L}]$ 是游离配体浓度，而 $[\\mathrm{RL}]$ 是受体-配体复合物浓度。设总受体浓度为 $R_{T} = [\\mathrm{R}] + [\\mathrm{RL}]$，并定义分数占据率为 $\\theta = \\frac{[\\mathrm{RL}]}{R_{T}}$。实验测得的$D_1$样受体的解离常数为 $K_{d}^{\\mathrm{D1}} = 1\\,\\mu\\mathrm{M}$，$D_2$样受体的解离常数为 $K_{d}^{\\mathrm{D2}} = 50\\,\\mathrm{nM}$。\n\n从上述 $K_{d}$ 的定义和 $R_{T}$ 的守恒关系出发，推导出 $\\theta$ 作为 $[\\mathrm{L}]$ 和 $K_{d}$ 的函数的表达式，然后计算在 $[\\mathrm{DA}] = 30\\,\\mathrm{nM}$ 时，$D_1$样和$D_2$样受体的分数占据率。将您的最终答案表示为行矩阵 $\\begin{pmatrix}\\theta_{\\mathrm{D1}}  \\theta_{\\mathrm{D2}}\\end{pmatrix}$，使用精确的简化分数，不带单位。无需四舍五入。", "solution": "多巴胺（配体）与受体的结合在稳态下被建模为一个可逆反应 $\\mathrm{R} + \\mathrm{L} \\rightleftharpoons \\mathrm{RL}$。根据质量作用定律，解离常数定义为\n$$\nK_{d} = \\frac{[\\mathrm{R}][\\mathrm{L}]}{[\\mathrm{RL}]}.\n$$\n我们还有受体守恒关系\n$$\nR_{T} = [\\mathrm{R}] + [\\mathrm{RL}],\n$$\n和分数占据率\n$$\n\\theta = \\frac{[\\mathrm{RL}]}{R_{T}}.\n$$\n我们的目标是用 $[\\mathrm{L}]$ 和 $K_{d}$ 来表示 $\\theta$。从 $K_{d}$ 的定义中，解出 $[\\mathrm{RL}]$：\n$$\n[\\mathrm{RL}] = \\frac{[\\mathrm{R}][\\mathrm{L}]}{K_{d}}.\n$$\n将 $[\\mathrm{R}] = R_{T} - [\\mathrm{RL}]$ 代入此表达式：\n$$\n[\\mathrm{RL}] = \\frac{(R_{T} - [\\mathrm{RL}])[\\mathrm{L}]}{K_{d}}.\n$$\n重新整理以合并 $[\\mathrm{RL}]$ 项：\n$$\n[\\mathrm{RL}] = \\frac{R_{T}[\\mathrm{L}]}{K_{d}} - \\frac{[\\mathrm{RL}][\\mathrm{L}]}{K_{d}} \\quad \\Rightarrow \\quad [\\mathrm{RL}]\\left(1 + \\frac{[\\mathrm{L}]}{K_{d}}\\right) = \\frac{R_{T}[\\mathrm{L}]}{K_{d}}.\n$$\n因此，\n$$\n[\\mathrm{RL}] = \\frac{R_{T}[\\mathrm{L}]}{K_{d} + [\\mathrm{L}]}.\n$$\n两边同时除以 $R_{T}$ 得到分数占据率：\n$$\n\\theta = \\frac{[\\mathrm{RL}]}{R_{T}} = \\frac{[\\mathrm{L}]}{K_{d} + [\\mathrm{L}]}.\n$$\n在所述假设下，$[\\mathrm{L}] \\approx [\\mathrm{DA}] = 30\\,\\mathrm{nM}$。对于$D_1$样受体， $K_{d}^{\\mathrm{D1}} = 1\\,\\mu\\mathrm{M} = 1000\\,\\mathrm{nM}$。因此，\n$$\n\\theta_{\\mathrm{D1}} = \\frac{30\\,\\mathrm{nM}}{1000\\,\\mathrm{nM} + 30\\,\\mathrm{nM}} = \\frac{30}{1030} = \\frac{3}{103}.\n$$\n对于$D_2$样受体， $K_{d}^{\\mathrm{D2}} = 50\\,\\mathrm{nM}$，所以\n$$\n\\theta_{\\mathrm{D2}} = \\frac{30\\,\\mathrm{nM}}{50\\,\\mathrm{nM} + 30\\,\\mathrm{nM}} = \\frac{30}{80} = \\frac{3}{8}.\n$$\n要求的最终形式是表示为精确简化分数的行矩阵 $\\begin{pmatrix}\\theta_{\\mathrm{D1}}  \\theta_{\\mathrm{D2}}\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3}{103}  \\frac{3}{8}\\end{pmatrix}}$$", "id": "2708837"}, {"introduction": "现实世界中的多巴胺信号通常是短暂的、时相性（phasic）的瞬变，受体可能没有足够的时间达到平衡。本练习挑战了前一个问题 [@problem_id:2708837] 中的稳态观点，探讨了动力学速率常数（$k_{on}$ 和 $k_{off}$），而不仅仅是亲和力，如何决定受体对神经递质快速脉冲的响应能力。", "problem": "纹状体中的多巴胺能瞬变被建模为一个细胞外多巴胺浓度的矩形脉冲，其振幅为 $[DA]_{p}$，持续时间为 $T$，叠加在一个可忽略的基线上。考虑多巴胺 $D_2$ 样受体（一个 G 蛋白偶联受体家族），其与游离受体和多巴胺之间的结合动力学遵循标准的质量作用定律。令 $R_{T}$ 表示总受体浓度，$B(t)$ 表示配体结合受体的浓度，$k_{on}$ 为二级结合速率常数，$k_{off}$ 为一级解离速率常数。在脉冲期间，多巴胺浓度在 $0 \\le t \\le T$ 时近似恒定于 $[DA](t)= [DA]_{p}$，之后迅速返回基线水平。假设 $B(0) = 0$（基线占用率可忽略不计），并且在感兴趣的时间尺度上，受体可用性不受其他相互作用的限制，因此标准的质量作用动力学适用：\n$$\n\\frac{dB}{dt} = k_{on}\\,[DA](t)\\,\\big(R_{T}-B(t)\\big) - k_{off}\\,B(t).\n$$\n操作上将“在脉冲期间达到平衡”定义为：结合受体浓度 $B(T)$ 达到稳态值 $B_{\\infty}$ 的至少 $90\\%$，其中 $B_{\\infty}$ 是在 $[DA]$ 无限期地保持在 $[DA]_{p}$ 恒定时将建立的稳态值。设脉冲参数为 $[DA]_{p} = 1\\,\\mu\\mathrm{M}$ 和 $T = 0.5\\,\\mathrm{s}$。\n\n以下哪种参数体系会导致动力学限制，阻止 $D_2$ 占用率在短暂脉冲期间达到平衡（即，$B(T)  0.9\\,B_{\\infty}$）？\n\nA. $k_{on} = 1.0\\times 10^{6}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 0.5\\,\\mathrm{s}^{-1}$\n\nB. $k_{on} = 5.0\\times 10^{6}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 0.1\\,\\mathrm{s}^{-1}$\n\nC. $k_{on} = 1.0\\times 10^{7}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 0.05\\,\\mathrm{s}^{-1}$\n\nD. $k_{on} = 2.0\\times 10^{5}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 1.0\\,\\mathrm{s}^{-1}$\n\nE. $k_{on} = 1.0\\times 10^{6}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 5.0\\,\\mathrm{s}^{-1}$", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 多巴胺瞬变模型：浓度为 $[DA]_{p}$、持续时间为 $T$ 的矩形脉冲。\n- 基线多巴胺浓度：可忽略不计。\n- 脉冲期间的配体浓度 ($0 \\le t \\le T$)：$[DA](t) = [DA]_{p} = 1\\,\\mu\\mathrm{M} = 10^{-6}\\,\\mathrm{M}$。\n- 脉冲持续时间：$T = 0.5\\,\\mathrm{s}$。\n- 受体类型：D$_2$ 样受体，一种 G 蛋白偶联受体。\n- 动力学模型：标准质量作用结合。\n- 总受体浓度：$R_{T}$。\n- 时间 $t$ 时的结合受体浓度：$B(t)$。\n- 结合速率常数：$k_{on}$。\n- 解离速率常数：$k_{off}$。\n- 控制微分方程：$\\frac{dB}{dt} = k_{on}\\,[DA](t)\\,\\big(R_{T}-B(t)\\big) - k_{off}\\,B(t)$。\n- 初始条件：$B(0) = 0$。\n- 平衡的定义：如果 $[DA]$ 无限期地保持在 $[DA]_{p}$，将达到的稳态结合受体浓度 $B_{\\infty}$。\n- “达到平衡”的条件：$B(T) \\ge 0.9\\,B_{\\infty}$。\n- 问题：确定在哪些参数体系下，动力学限制会阻止达到平衡，即 $B(T)  0.9\\,B_{\\infty}$。\n\n步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用了一个基于质量作用定律的、标准的、成熟的配体-受体结合动力学模型。这是药理学、生物物理学和神经科学中的一个基本概念。参数和条件都在现实的生物物理范围内。该问题在科学上是合理的。\n- **适定性**：该问题提供了一个具有常系数（在脉冲期间）和指定初始条件的一阶线性常微分方程。这种配置保证了 $B(t)$ 有一个唯一的、稳定的、有意义的解。问题以数学上精确的方式陈述。\n- **客观性**：该问题使用客观、定量的语言表述，没有歧义或主观论断。\n- **完整性和一致性**：解决该问题所需的所有必要参数和条件都已提供。问题是自洽且内部一致的。\n\n步骤 3：结论与行动\n问题陈述有效。可以推导出严谨的解。\n\n通过求解给定的微分方程来进行分析。在多巴胺脉冲期间，对于 $0 \\le t \\le T$，多巴胺浓度是恒定的，$[DA](t) = [DA]_{p}$。控制方程为：\n$$\n\\frac{dB}{dt} = k_{on}\\,[DA]_{p}\\,(R_{T}-B(t)) - k_{off}\\,B(t)\n$$\n该方程可以重排为一阶线性常微分方程的标准形式：\n$$\n\\frac{dB}{dt} + \\big(k_{on}[DA]_{p} + k_{off}\\big)B(t) = k_{on}[DA]_{p}R_{T}\n$$\n我们定义观测速率常数 $k_{obs}$ 为：\n$$\nk_{obs} = k_{on}[DA]_{p} + k_{off}\n$$\n微分方程简化为：\n$$\n\\frac{dB}{dt} + k_{obs}B(t) = k_{on}[DA]_{p}R_{T}\n$$\n首先，我们确定稳态浓度 $B_{\\infty}$，即当 $t \\to \\infty$ 时 $B(t)$ 的值。在稳态时，$\\frac{dB}{dt} = 0$。\n$$\n0 = k_{on}[DA]_{p}(R_{T}-B_{\\infty}) - k_{off}B_{\\infty}\n$$\n求解 $B_{\\infty}$：\n$$\n(k_{on}[DA]_{p} + k_{off})B_{\\infty} = k_{on}[DA]_{p}R_{T}\n$$\n$$\nB_{\\infty} = \\frac{k_{on}[DA]_{p}R_{T}}{k_{on}[DA]_{p} + k_{off}} = \\frac{k_{on}[DA]_{p}}{k_{obs}}R_{T}\n$$\n接下来，我们在初始条件 $B(0) = 0$ 下求解含时方程 $B(t)$。通解是齐次解和特解之和。特解是 $B_{\\infty}$。齐次方程 $\\frac{dB}{dt} + k_{obs}B(t) = 0$ 的解为 $A e^{-k_{obs}t}$。\n因此，通解为：\n$$\nB(t) = B_{\\infty} + A e^{-k_{obs}t}\n$$\n应用初始条件 $B(0)=0$：\n$$\n0 = B_{\\infty} + A e^{0} \\implies A = -B_{\\infty}\n$$\n结合受体浓度随时间变化的解为：\n$$\nB(t) = B_{\\infty}(1 - e^{-k_{obs}t})\n$$\n问题要求找出动力学限制阻止系统达到平衡的条件。这被定义为 $B(T)  0.9\\,B_{\\infty}$。我们将 $t=T$ 时 $B(t)$ 的表达式代入：\n$$\nB_{\\infty}(1 - e^{-k_{obs}T})  0.9\\,B_{\\infty}\n$$\n假设受体数量不为零 ($R_T > 0$)，$B_{\\infty}$ 为正，我们可以将不等式两边同时除以 $B_{\\infty}$：\n$$\n1 - e^{-k_{obs}T}  0.9\n$$\n$$\n0.1  e^{-k_{obs}T}\n$$\n对两边取自然对数：\n$$\n\\ln(0.1)  -k_{obs}T\n$$\n$$\n-\\ln(10)  -k_{obs}T\n$$\n两边乘以 -1 会使不等号反向：\n$$\nk_{obs}T  \\ln(10)\n$$\n问题要求确定满足此不等式的参数体系。给定 $T=0.5\\,\\mathrm{s}$ 和 $[DA]_{p} = 1\\,\\mu\\mathrm{M} = 10^{-6}\\,\\mathrm{M}$。$\\ln(10)$ 的值约为 2.3026。\n条件变为：\n$$\n(k_{on}\\,[DA]_{p} + k_{off}) \\times T  \\ln(10)\n$$\n$$\n(k_{on} \\times 10^{-6}\\,\\mathrm{M} + k_{off}) \\times 0.5\\,\\mathrm{s}  2.3026\n$$\n除以 $0.5\\,\\mathrm{s}$：\n$$\nk_{on} \\times 10^{-6} + k_{off}  \\frac{2.3026}{0.5}\\,\\mathrm{s}^{-1} \\approx 4.605\\,\\mathrm{s}^{-1}\n$$\n我们现在使用这个不等式来评估每个选项。\n\nA. $k_{on} = 1.0\\times 10^{6}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 0.5\\,\\mathrm{s}^{-1}$\n$$\nk_{obs} = (1.0 \\times 10^{6} \\times 10^{-6}) + 0.5 = 1.0 + 0.5 = 1.5\\,\\mathrm{s}^{-1}\n$$\n检验条件：$1.5\\,\\mathrm{s}^{-1}  4.605\\,\\mathrm{s}^{-1}$。此为真。\n结论：**正确**。动力学限制阻止了平衡的达到。\n\nB. $k_{on} = 5.0\\times 10^{6}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 0.1\\,\\mathrm{s}^{-1}$\n$$\nk_{obs} = (5.0 \\times 10^{6} \\times 10^{-6}) + 0.1 = 5.0 + 0.1 = 5.1\\,\\mathrm{s}^{-1}\n$$\n检验条件：$5.1\\,\\mathrm{s}^{-1}  4.605\\,\\mathrm{s}^{-1}$。此为假。\n结论：**错误**。根据指定标准达到了平衡。\n\nC. $k_{on} = 1.0\\times 10^{7}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 0.05\\,\\mathrm{s}^{-1}$\n$$\nk_{obs} = (1.0 \\times 10^{7} \\times 10^{-6}) + 0.05 = 10.0 + 0.05 = 10.05\\,\\mathrm{s}^{-1}\n$$\n检验条件：$10.05\\,\\mathrm{s}^{-1}  4.605\\,\\mathrm{s}^{-1}$。此为假。\n结论：**错误**。迅速达到了平衡。\n\nD. $k_{on} = 2.0\\times 10^{5}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 1.0\\,\\mathrm{s}^{-1}$\n$$\nk_{obs} = (2.0 \\times 10^{5} \\times 10^{-6}) + 1.0 = 0.2 + 1.0 = 1.2\\,\\mathrm{s}^{-1}\n$$\n检验条件：$1.2\\,\\mathrm{s}^{-1}  4.605\\,\\mathrm{s}^{-1}$。此为真。\n结论：**正确**。动力学限制阻止了平衡的达到。\n\nE. $k_{on} = 1.0\\times 10^{6}\\,\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{off} = 5.0\\,\\mathrm{s}^{-1}$\n$$\nk_{obs} = (1.0 \\times 10^{6} \\times 10^{-6}) + 5.0 = 1.0 + 5.0 = 6.0\\,\\mathrm{s}^{-1}\n$$\n检验条件：$6.0\\,\\mathrm{s}^{-1}  4.605\\,\\mathrm{s}^{-1}$。此为假。\n结论：**错误**。达到了平衡。\n\n在脉冲期间，动力学限制阻止 D$_2$ 占用率达到其稳态值至少 90% 的参数体系是选项 A 和 D。", "answer": "$$\\boxed{AD}$$", "id": "2708819"}, {"introduction": "在结合动力学概念框架 [@problem_id:2708819] 的基础上，这个计算练习让您可以直接对受体动力学进行建模。通过模拟 D1 样和 D2 样受体对一个真实多巴胺瞬变信号的响应占有率，您将能亲自量化动态过程与平衡状态的偏离，从而对受体特性如何塑造神经信号的时间动态获得一个强有力的、可预测的理解。", "problem": "要求您编写一个完整的程序，使用机制性结合动力学模型模拟多巴胺 D1 样和 D2 样受体家族的时间依赖性受体占有率，并在相同的配体时间进程下，将模拟的占有率与瞬时平衡预测进行比较。\n\n请使用以下具有科学依据的基础和场景：\n- 配体是多巴胺，以瞬态形式施加，其时间进程为高斯分布，中心在时间 $t = 0$，峰值浓度为 $L_{\\max} = 500$ nM，半峰全宽为 $0.2$ s。因此，配体浓度随时间变化的函数必须遵循具有指定峰值和半峰全宽的高斯函数；峰值出现在 $t=0$。\n- 模拟的时间域为从 $t = -1.0$ s 到 $t = 2.0$ s，固定时间步长为 $\\Delta t = 0.0005$ s。假设在瞬态之外，基线多巴胺浓度可忽略不计。\n- 受体占有率根据单个结合位点的标准质量作用动力学演变：占有率分数 $f(t)$ 是无量纲的，并满足一个由配体浓度 $L(t)$ 和动力学速率常数（结合速率 $k_{\\text{on}}$，单位为 nM$^{-1}$ s$^{-1}$；解离速率 $k_{\\text{off}}$，单位为 s$^{-1}$）驱动的常微分方程。请使用分数形式，这样总受体浓度就不会显式出现。\n\n对于每个受体家族（D1 样和 D2 样），将瞬时平衡占有率定义为：在使用质量作用所隐含的平衡条件下，如果结合在瞬时 $L(t)$ 下无限快地达到平衡，所能获得的占有率分数。\n\n初始条件：在模拟开始时（$t_0 = -1.0$ s）设置占有率为 $f(t_0) = 0$，这与基线时配体可忽略并处于平衡状态的情况一致。\n\n单位：\n- 配体浓度 $L(t)$ 的单位应为 nM。\n- 时间单位为 s。\n- 速率常数 $k_{\\text{on}}$ 的单位为 nM$^{-1}$ s$^{-1}$，$k_{\\text{off}}$ 的单位为 s$^{-1}$。\n- 占有率分数为无量纲。\n\n测试套件（为实现覆盖率提供三组参数）：\n- 情况 A（标称动力学）：\n  - D1-like: $k_{\\text{on}} = 0.05$ nM$^{-1}$ s$^{-1}$, $k_{\\text{off}} = 80.0$ s$^{-1}$。\n  - D2-like: $k_{\\text{on}} = 0.05$ nM$^{-1}$ s$^{-1}$, $k_{\\text{off}} = 2.5$ s$^{-1}$。\n- 情况 B（快速动力学边界，与情况 A 具有相同的平衡亲和力，但速率快 10 倍）：\n  - D1-like: $k_{\\text{on}} = 0.5$ nM$^{-1}$ s$^{-1}$, $k_{\\text{off}} = 800.0$ s$^{-1}$。\n  - D2-like: $k_{\\text{on}} = 0.5$ nM$^{-1}$ s$^{-1}$, $k_{\\text{off}} = 25.0$ s$^{-1}$。\n- 情况 C（慢速动力学边缘，与情况 A 具有相同的平衡亲和力，但速率慢 10 倍）：\n  - D1-like: $k_{\\text{on}} = 0.005$ nM$^{-1}$ s$^{-1}$, $k_{\\text{off}} = 8.0$ s$^{-1}$。\n  - D2-like: $k_{\\text{on}} = 0.005$ nM$^{-1}$ s$^{-1}$, $k_{\\text{off}} = 0.25$ s$^{-1}$。\n\n您的程序必须为每种情况执行以下任务：\n1. 通过对给定 $k_{\\text{on}}$、$k_{\\text{off}}$ 和 $L(t)$ 的动力学进行数值积分，在指定的时间网格上模拟占有率 $f_{\\text{dyn}}^{\\text{D1}}(t)$ 和 $f_{\\text{dyn}}^{\\text{D2}}(t)$ 的时间进程。\n2. 基于相同的 $L(t)$ 和动力学参数，使用质量作用所隐含的平衡定义，计算瞬时平衡占有率的时间进程 $f_{\\text{eq}}^{\\text{D1}}(t)$ 和 $f_{\\text{eq}}^{\\text{D2}}(t)$。\n3. 对于每个受体家族，计算动态占有率和平衡占有率随时间变化的最大绝对偏差：$\\max_t \\left| f_{\\text{dyn}}(t) - f_{\\text{eq}}(t) \\right|$。\n4. 在 $t=0$ 时，评估两个受体家族的动态占有率是否同时在平衡占有率的 $0.05$ 相对误差范围内。如果 $t=0$ 时的平衡占有率为零，则对该受体使用绝对误差而非相对误差。\n\n输出规格：\n- 对于每种情况（A、B、C），生成一个包含三个值的列表：D1 样的最大绝对偏差、D2 样的最大绝对偏差，以及一个布尔值，指示在 $t=0$ 时 D1 样和 D2 样的动态占有率是否都在其平衡值的指定容差范围内。\n- 将两个最大绝对偏差四舍五入到小数点后六位。\n- 将这三种情况的列表按 A、B、C 的顺序聚合到一个列表中。\n- 您的程序应生成单行输出，包含此聚合列表，格式为无空格的逗号分隔列表，内部列表也用逗号分隔且无空格。例如：“[[x11,x12,b1],[x21,x22,b2],[x31,x32,b3]]”，其中 $x_{ij}$ 是小数点后恰好有六位的浮点数，$b_j$ 是布尔值。\n- 因此，预期的最终输出类型是一个列表的列表，每个内部列表包含两个浮点数和一个布尔值，全部在单行上并采用指定格式。不应读取任何用户输入；所有值均在此说明中于程序内部定义。", "solution": "问题陈述已经过验证，被认定为具有科学依据、适定且客观。它描述了计算药理学中一个基于质量作用动力学（一项基本原理）的标准问题。所有必需的参数、初始条件和数值规格均已提供，不存在内部矛盾或歧义。因此，该问题被视为**有效**，并将提供完整的解决方案。\n\n任务是模拟两种多巴胺受体家族 D₁ 样和 D₂ 样在响应多巴胺瞬态脉冲时的随时间变化的分数占有率，并将此动态行为与理论上的瞬时平衡进行比较。\n\n首先，我们必须定义配体浓度分布 $L(t)$。问题陈述指出它是一个高斯函数，在时间 $t=0$ s 时达到峰值浓度 $L_{\\max} = 500$ nM，半峰全宽 (FWHM) 为 $0.2$ s。以 $t=0$ 为中心的高斯函数的一般形式为：\n$$\nL(t) = L_{\\max} \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)\n$$\nFWHM 通过公式 FWHM $= 2\\sqrt{2\\ln(2)}\\sigma$ 与标准差 $\\sigma$ 相关。给定 FWHM $= 0.2$ s，我们可以解出 $\\sigma$：\n$$\n\\sigma = \\frac{\\text{FWHM}}{2\\sqrt{2\\ln(2)}} = \\frac{0.2}{2\\sqrt{2\\ln(2)}} = \\frac{0.1}{\\sqrt{2\\ln(2)}} \\text{ s}\n$$\n因此，在任意时间 $t$（单位为秒）下，配体浓度（单位为 nM）为：\n$$\nL(t) = 500 \\exp\\left(-\\frac{t^2 \\cdot 2\\ln(2)}{(0.2)^2}\\right) = 500 \\exp\\left(-\\frac{2 t^2 \\ln(2)}{0.04}\\right) = 500 \\exp(-50 \\ln(2) t^2)\n$$\n\n接下来，我们建立控制受体占有率分数 $f(t)$ 的常微分方程 (ODE)。根据单一位点结合模型的标准质量作用动力学，复合物浓度 $[LR]$ 的变化率由结合与解离的平衡给出：\n$$\n\\frac{d[LR]}{dt} = k_{\\text{on}} [L] [R] - k_{\\text{off}} [LR]\n$$\n其中 $[L]$ 是配体浓度，$[R]$ 是游离受体浓度，$k_{\\text{on}}$ 是结合速率常数，$k_{\\text{off}}$ 是解离速率常数。占有率分数定义为 $f(t) = [LR]/R_T$，其中 $R_T$ 是总受体浓度。由于总受体浓度是恒定的，$R_T = [R] + [LR]$，我们有 $[R] = R_T(1-f)$。将此代入速率方程并除以 $R_T$，得到与 $R_T$ 无关的分数占有率 ODE：\n$$\n\\frac{df}{dt} = k_{\\text{on}} L(t) (1 - f(t)) - k_{\\text{off}} f(t)\n$$\n这是一个我们将进行数值求解的一阶线性常微分方程。问题指定了从 $t = -1.0$ s 到 $t = 2.0$ s 的时间域，时间步长为 $\\Delta t = 0.0005$ s，初始条件为 $f(-1.0) = 0$。我们将采用前向欧拉法，因为它简单，并且在此背景下，指定的小时间步长足以获得稳定且足够精确的解。该 ODE 的离散化形式为：\n$$\nf(t_{i+1}) = f(t_i) + \\Delta t \\left[ k_{\\text{on}} L(t_i) (1 - f(t_i)) - k_{\\text{off}} f(t_i) \\right]\n$$\n其中 $t_{i+1} = t_i + \\Delta t$。此数值积分将产生动态占有率时间进程 $f_{\\text{dyn}}(t)$。\n\n为了比较，我们定义瞬时平衡占有率 $f_{\\text{eq}}(t)$。这是在结合动力学无限快的情况下（意味着系统始终与当前配体浓度 $L(t)$ 处于平衡状态）所能达到的假设占有率。在平衡状态下，$\\frac{df}{dt} = 0$，可得：\n$$\nk_{\\text{on}} L(t) (1 - f_{\\text{eq}}(t)) - k_{\\text{off}} f_{\\text{eq}}(t) = 0\n$$\n解出 $f_{\\text{eq}}(t)$ 得到我们熟悉的 Hill-Langmuir 方程：\n$$\nf_{\\text{eq}}(t) = \\frac{k_{\\text{on}} L(t)}{k_{\\text{on}} L(t) + k_{\\text{off}}} = \\frac{L(t)}{L(t) + K_D}\n$$\n其中 $K_D = k_{\\text{off}}/k_{\\text{on}}$ 是平衡解离常数。这将使用相同的 $L(t)$ 分布在每个时间点进行计算。\n\n该分析要求在每个测试案例中对每种受体类型进行两项计算：\n1.  在整个模拟过程中，动态占有率和平衡占有率之间的最大绝对偏差：\n    $$\n    \\Delta f_{\\max} = \\max_{t} |f_{\\text{dyn}}(t) - f_{\\text{eq}}(t)|\n    $$\n2.  在时间 $t = 0$ s 进行检查，以确定动态占有率是否在平衡占有率的相对误差 $\\epsilon = 0.05$ 范围内。此条件必须对 D₁ 样和 D₂ 样受体同时成立。对于给定的受体，其条件为：\n    $$\n    \\frac{|f_{\\text{dyn}}(0) - f_{\\text{eq}}(0)|}{|f_{\\text{eq}}(0)|} \\le 0.05\n    $$\n    由于 $L(0) = L_{\\max} > 0$，分母 $f_{\\text{eq}}(0)$ 非零，因此零平衡占有率的特殊情况在 $t=0$ 时不适用。\n\n程序将为三个测试案例（A、B、C）中的每一个实施此完整过程，这些案例改变了动力学速率常数，但保持了每个受体家族在所有案例中具有相同的平衡解离常数 $K_D$。最终输出将结构化为一个列表的列表，每个内部列表包含两个计算出的最大偏差（针对 D₁ 样和 D₂ 样），四舍五入到小数点后六位，以及在 $t=0$ 时检查的布尔结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates dopamine receptor occupancy, compares with equilibrium, and computes specified metrics.\n    \"\"\"\n\n    # --- Problem constants ---\n    # Ligand profile parameters\n    L_max = 500.0   # nM\n    t_peak = 0.0    # s\n    fwhm = 0.2      # s\n    # Simulation time parameters\n    t_start = -1.0  # s\n    t_end = 2.0     # s\n    dt = 0.0005     # s\n    # Analysis parameters\n    rel_error_tol = 0.05\n\n    # --- Test suite cases ---\n    # (k_on_d1, k_off_d1, k_on_d2, k_off_d2)\n    test_cases = {\n        \"A\": (0.05, 80.0, 0.05, 2.5),\n        \"B\": (0.5, 800.0, 0.5, 25.0),\n        \"C\": (0.005, 8.0, 0.005, 0.25),\n    }\n\n    # --- Pre-computation for ligand profile ---\n    # sigma from FWHM: FWHM = 2 * sqrt(2*ln(2)) * sigma\n    sigma = fwhm / (2.0 * np.sqrt(2.0 * np.log(2.0)))\n    \n    # Time grid\n    t_grid = np.arange(t_start, t_end + dt, dt)\n    num_steps = len(t_grid) - 1\n    \n    # Ligand concentration time course L(t)\n    L_t = L_max * np.exp(-((t_grid - t_peak)**2) / (2.0 * sigma**2))\n\n    # --- Main processing loop ---\n    results_agg = []\n    \n    for case_name in [\"A\", \"B\", \"C\"]:\n        params = test_cases[case_name]\n        k_on_d1, k_off_d1, k_on_d2, k_off_d2 = params\n\n        # Helper function to run a single receptor simulation\n        def run_receptor_simulation(k_on, k_off):\n            # Dynamic occupancy simulation using Forward Euler\n            f_dyn = np.zeros(num_steps + 1)\n            f_dyn[0] = 0.0  # Initial condition\n            for i in range(num_steps):\n                df_dt = k_on * L_t[i] * (1.0 - f_dyn[i]) - k_off * f_dyn[i]\n                f_dyn[i+1] = f_dyn[i] + dt * df_dt\n            \n            # Instantaneous equilibrium occupancy\n            # K_D = k_off / k_on\n            # f_eq = L_t / (L_t + K_D)\n            # To avoid potential division by zero if k_on=0, use the full form:\n            f_eq = (k_on * L_t) / (k_on * L_t + k_off)\n            \n            # Maximum absolute deviation\n            max_dev = np.max(np.abs(f_dyn - f_eq))\n            \n            return f_dyn, f_eq, max_dev\n\n        # Run for D1-like receptor\n        f_dyn_d1, f_eq_d1, max_dev_d1 = run_receptor_simulation(k_on_d1, k_off_d1)\n        \n        # Run for D2-like receptor\n        f_dyn_d2, f_eq_d2, max_dev_d2 = run_receptor_simulation(k_on_d2, k_off_d2)\n\n        # --- Analysis at t=0 ---\n        t_zero_idx = np.where(t_grid >= 0)[0][0]\n        \n        # Check D1 relative error at t=0\n        f_dyn_d1_t0 = f_dyn_d1[t_zero_idx]\n        f_eq_d1_t0 = f_eq_d1[t_zero_idx]\n        err_d1_ok = False\n        if f_eq_d1_t0 > 0:\n            rel_err_d1 = np.abs(f_dyn_d1_t0 - f_eq_d1_t0) / f_eq_d1_t0\n            if rel_err_d1 = rel_error_tol:\n                err_d1_ok = True\n        else: # Absolute error check if equilibrium is zero\n            if np.abs(f_dyn_d1_t0 - f_eq_d1_t0) = rel_error_tol:\n                err_d1_ok = True\n                \n        # Check D2 relative error at t=0\n        f_dyn_d2_t0 = f_dyn_d2[t_zero_idx]\n        f_eq_d2_t0 = f_eq_d2[t_zero_idx]\n        err_d2_ok = False\n        if f_eq_d2_t0 > 0:\n            rel_err_d2 = np.abs(f_dyn_d2_t0 - f_eq_d2_t0) / f_eq_d2_t0\n            if rel_err_d2 = rel_error_tol:\n                err_d2_ok = True\n        else: # Absolute error check\n            if np.abs(f_dyn_d2_t0 - f_eq_d2_t0) = rel_error_tol:\n                err_d2_ok = True\n\n        # Final boolean check: both must be within tolerance\n        both_ok_at_t0 = err_d1_ok and err_d2_ok\n        \n        results_agg.append([max_dev_d1, max_dev_d2, both_ok_at_t0])\n\n    # --- Format and print final output ---\n    output_parts = []\n    for res in results_agg:\n        max_dev1_str = f\"{res[0]:.6f}\"\n        max_dev2_str = f\"{res[1]:.6f}\"\n        bool_str = str(res[2]).lower()  # Convert Python True/False to JSON-like true/false\n        output_parts.append(f\"[{max_dev1_str},{max_dev2_str},{bool_str}]\")\n    \n    final_output_str = f\"[{','.join(output_parts)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2708828"}]}