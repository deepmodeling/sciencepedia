{"hands_on_practices": [{"introduction": "理解细胞内钙信号的第一步是掌握其浓度如何被精确地缓冲。这个练习将引导你从基本原理出发，运用质量作用定律来推导游离钙离子浓度与钙结合缓冲蛋白之间的定量关系[@problem_id:2746473]。通过这个基础计算，你将能更好地理解细胞如何通过缓冲作用来应对剧烈的钙离子内流，并为后续更复杂的钙动力学分析打下坚实的理论基础。", "problem": "神经元的胞质溶胶中含有一种可移动的钙结合缓冲剂，该缓冲剂具有单个结合位点，根据热力学平衡下的一对一可逆反应与钙离子 $Ca^{2+}$ 结合。设游离缓冲剂浓度为 $[B]$，钙结合缓冲剂浓度为 $[BC]$，总缓冲剂浓度为 $B_T$，游离钙浓度为 $[\\mathrm{Ca}^{2+}]_f$。该结合平衡由质量作用定律定义的解离常数 $K_d$ 来表征。假设没有协同性，只有一类结合位点，并且 $[\\mathrm{Ca}^{2+}]_f$ 由外部控制（例如，通过钳制钙微域条件），因此缓冲剂的结合不会改变 $[\\mathrm{Ca}^{2+}]_f$。\n\n仅从质量作用定律定义的解离常数和缓冲剂的质量守恒出发，推导结合分数 $f_B \\equiv [BC]/B_T$ 作为 $[\\mathrm{Ca}^{2+}]_f$ 和 $K_d$ 的函数表达式。然后，在两个游离钙水平下：$[\\mathrm{Ca}^{2+}]_f = 100\\,\\mathrm{nM}$ 和 $[\\mathrm{Ca}^{2+}]_f = 1\\,\\mu\\mathrm{M}$，对于 $B_T = 50\\,\\mu\\mathrm{M}$ 和 $K_d = 200\\,\\mathrm{nM}$ 计算该分数的值。\n\n将你的两个 $f_B$ 数值结果按照 $\\big(100\\,\\mathrm{nM},\\,1\\,\\mu\\mathrm{M}\\big)$ 的顺序以一个含两个条目的行向量形式报告。将你的最终答案表示为无量纲分数，并四舍五入到四位有效数字。", "solution": "所述问题是基础生物物理化学领域一个有效且适定的练习。它具有科学依据，内部一致，并需要应用第一性原理。我们将进行推导和后续计算。\n\n该问题描述了缓冲剂 $B$ 和钙离子 $Ca^{2+}$ 之间形成复合物 $BC$ 的可逆结合反应。该反应表示为：\n$$\nB + Ca^{2+} \\rightleftharpoons BC\n$$\n该反应受两个基本原理支配：平衡时的质量作用定律和缓冲剂物种的质量守恒。\n\n1. 质量作用定律：\n平衡状态由解离常数 $K_d$ 来表征，其定义如下：\n$$\nK_d = \\frac{[B] [\\mathrm{Ca}^{2+}]_f}{[BC]}\n$$\n此处，$[B]$ 是游离缓冲剂的浓度，$[\\mathrm{Ca}^{2+}]_f$ 是游离钙离子的浓度，$[BC]$ 是钙结合缓冲剂的浓度。\n\n2. 质量守恒：\n缓冲剂的总浓度 $B_T$ 是其游离形式和结合形式浓度之和：\n$$\nB_T = [B] + [BC]\n$$\n\n目标是推导结合分数 $f_B$ 的表达式，其定义为结合缓冲剂浓度与总缓冲剂浓度之比：\n$$\nf_B \\equiv \\frac{[BC]}{B_T}\n$$\n该表达式必须用 $[\\mathrm{Ca}^{2+}]_f$ 和 $K_d$ 来表示。\n\n我们首先重排质量守恒方程，用 $B_T$ 和 $[BC]$ 表示游离缓冲剂浓度 $[B]$：\n$$\n[B] = B_T - [BC]\n$$\n接下来，我们将这个关于 $[B]$ 的表达式代入解离常数 $K_d$ 的方程中：\n$$\nK_d = \\frac{(B_T - [BC]) [\\mathrm{Ca}^{2+}]_f}{[BC]}\n$$\n该方程建立了各浓度、游离钙水平和解离常数之间的关系。我们的目标是求解比率 $\\frac{[BC]}{B_T}$。为此，我们进行代数运算。首先，方程两边同乘以 $[BC]$：\n$$\nK_d [BC] = (B_T - [BC]) [\\mathrm{Ca}^{2+}]_f\n$$\n将右侧的项 $[\\mathrm{Ca}^{2+}]_f$ 展开：\n$$\nK_d [BC] = B_T [\\mathrm{Ca}^{2+}]_f - [BC] [\\mathrm{Ca}^{2+}]_f\n$$\n为了解出 $[BC]$，我们将所有包含 $[BC]$ 的项移到方程的一边：\n$$\nK_d [BC] + [BC] [\\mathrm{Ca}^{2+}]_f = B_T [\\mathrm{Ca}^{2+}]_f\n$$\n从左侧提出公因子 $[BC]$：\n$$\n[BC] (K_d + [\\mathrm{Ca}^{2+}]_f) = B_T [\\mathrm{Ca}^{2+}]_f\n$$\n最后，为了得到所求的结合分数 $f_B = \\frac{[BC]}{B_T}$，我们将方程两边同除以 $B_T$ 和 $(K_d + [\\mathrm{Ca}^{2+}]_f)$：\n$$\nf_B = \\frac{[BC]}{B_T} = \\frac{[\\mathrm{Ca}^{2+}]_f}{K_d + [\\mathrm{Ca}^{2+}]_f}\n$$\n这就是所求的结合分数表达式。对于具有单类非协同性结合位点的系统，这是 Hill-Langmuir 方程的一个特例。值得注意的是，总缓冲剂浓度 $B_T$ 并未出现在分数 $f_B$ 的最终公式中。因此，给定的值 $B_T = 50\\,\\mu\\mathrm{M}$ 与此计算无关。\n\n现在，我们用给定的数值来计算这个表达式。解离常数为 $K_d = 200\\,\\mathrm{nM}$。我们必须在两个不同的游离钙浓度下计算 $f_B$。\n\n情况 1：$[\\mathrm{Ca}^{2+}]_f = 100\\,\\mathrm{nM}$\n将数值代入推导出的表达式：\n$$\nf_B = \\frac{100\\,\\mathrm{nM}}{200\\,\\mathrm{nM} + 100\\,\\mathrm{nM}} = \\frac{100}{300} = \\frac{1}{3}\n$$\n表示为四舍五入到四位有效数字的小数，结果是 $0.3333$。\n\n情况 2：$[\\mathrm{Ca}^{2+}]_f = 1\\,\\mu\\mathrm{M}$\n首先，我们必须确保单位一致。我们将 $1\\,\\mu\\mathrm{M}$ 转换为纳摩尔浓度：$1\\,\\mu\\mathrm{M} = 1000\\,\\mathrm{nM}$。\n代入数值：\n$$\nf_B = \\frac{1000\\,\\mathrm{nM}}{200\\,\\mathrm{nM} + 1000\\,\\mathrm{nM}} = \\frac{1000}{1200} = \\frac{10}{12} = \\frac{5}{6}\n$$\n表示为四舍五入到四位有效数字的小数，结果是 $0.8333$。\n\n最终答案应报告为包含这两个结果并按指定顺序排列的含两个条目的行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3333  0.8333 \\end{pmatrix}}\n$$", "id": "2746473"}, {"introduction": "细胞器，特别是内质网（ER），是细胞内主要的钙储存库，对钙信号的形成和调控至关重要。这项练习将带领你从静态的缓冲概念进入动态稳态的建模，通过构建一个描述内质网膜上钙离子主动泵入（SERCA）和被动泄漏之间通量平衡的模型，来计算内质网腔内稳定的高钙浓度[@problem_id:2746401]。这个练习将帮助你理解细胞如何建立并维持关键的跨膜钙离子浓度梯度。", "problem": "一个单室神经元内质网 (ER) 通过一层膜与胞质溶胶隔开，钙离子通过该膜进行运输。假设胞质溶胶的自由钙离子浓度被强大的外排和缓冲机制钳制在一个恒定值。设胞质溶胶自由钙离子浓度为 $[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}} = 0.2\\,\\mu\\mathrm{M}$。肌浆/内质网钙ATP酶 (SERCA) 将钙离子从胞质溶胶泵入内质网腔，其摄取通量密度 $J_{\\mathrm{SERCA}}$ 通过协同结合依赖于胞质溶胶的钙离子浓度；而被动泄漏通量密度 $J_{\\mathrm{leak}}$ 在浓度差的驱动下将钙离子从内质网腔运回胞质溶胶。使用以下单位膜面积通量密度的生物物理学标准本构关系：\n- SERCA 摄取：$J_{\\mathrm{SERCA}} = V_{\\max} \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}{K^{n} + [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}$，\n- 被动泄漏：$J_{\\mathrm{leak}} = P_{\\mathrm{leak}} ([\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} - [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}})$，\n\n其中 $[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}}$ 是内质网腔中的自由钙离子浓度。所有代入通量公式的浓度都必须以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 为单位表示。参数如下：\n- 最大 SERCA 摄取速率 $V_{\\max} = 1.6 \\times 10^{-8}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，\n- 半激活常数 $K = 0.3\\,\\mu\\mathrm{M}$，\n- 希尔系数 $n = 2$，\n- 被动渗透性 $P_{\\mathrm{leak}} = 1.0 \\times 10^{-8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n假设系统处于稳态，内质网中没有钙的净积累（即膜通量达到平衡）。从膜上的质量守恒和上述定义出发，推导并计算稳态下的 $[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}}$。用 $\\mu\\mathrm{M}$ 单位表示你的最终数值答案，并将答案四舍五入到四位有效数字。", "solution": "所述问题是生物物理建模中的一个适定练习，并且在科学上是合理的。所有必要的参数和条件都已提供，可得到唯一解。我们开始进行推导。\n\n基本原理是质量守恒。在稳态下，穿过内质网 (ER) 膜的钙离子净通量为零。这意味着流入内质网的通量必须与流出内质网的通量完全平衡。流入由SERCA泵介导，通量密度为 $J_{\\mathrm{SERCA}}$，流出为被动泄漏，通量密度为 $J_{\\mathrm{leak}}$。因此，稳态条件为：\n$$\nJ_{\\mathrm{SERCA}} = J_{\\mathrm{leak}}\n$$\n问题给出了这些通量的本构关系：\n$$\nJ_{\\mathrm{SERCA}} = V_{\\max} \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}{K^{n} + [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}\n$$\n$$\nJ_{\\mathrm{leak}} = P_{\\mathrm{leak}} ([\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} - [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}})\n$$\n这里，$[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}$ 是胞质溶胶的自由钙离子浓度，$[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}}$ 是内质网腔中的自由钙离子浓度，$V_{\\max}$ 是最大SERCA泵速率，$K$ 是SERCA的半激活常数，$n$ 是希尔系数，$P_{\\mathrm{leak}}$ 是膜的泄漏渗透性。\n\n将这些表达式代入稳态平衡方程，我们得到：\n$$\nV_{\\max} \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}{K^{n} + [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}} = P_{\\mathrm{leak}} ([\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} - [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}})\n$$\n我们的目标是确定 $[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}}$ 的稳态值。我们重排方程以求解该变量。首先，两边同除以 $P_{\\mathrm{leak}}$：\n$$\n\\frac{V_{\\max}}{P_{\\mathrm{leak}}} \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}{K^{n} + [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}} = [\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} - [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}\n$$\n接下来，我们在方程两边同时加上 $[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}$ 来分离出 $[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}}$：\n$$\n[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} = [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}} + \\frac{V_{\\max}}{P_{\\mathrm{leak}}} \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}{K^{n} + [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}\n$$\n这就是稳态下内质网钙离子浓度的符号解。\n\n现在我们必须进行数值计算。一个关键点是单位的处理。问题规定，通量方程中的浓度必须使用国际单位制单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。给定的浓度值单位是微摩尔 ($\\mu\\mathrm{M}$)。换算关系为 $1\\,\\mu\\mathrm{M} = 10^{-6}\\,\\mathrm{mol}\\,\\mathrm{L}^{-1} = 10^{-6}\\,\\mathrm{mol}\\,(10^{-3}\\,\\mathrm{m}^3)^{-1} = 10^{-3}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n给定的参数是：\n- $[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}} = 0.2\\,\\mu\\mathrm{M} = 0.2 \\times 10^{-3}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $K = 0.3\\,\\mu\\mathrm{M} = 0.3 \\times 10^{-3}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $n = 2$\n- $V_{\\max} = 1.6 \\times 10^{-8}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n- $P_{\\mathrm{leak}} = 1.0 \\times 10^{-8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n\n我们首先计算无量纲的希尔项，$\\mathcal{H} = \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}{K^{n} + [\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}}^{n}}$。由于这是具有相同单位的项之比，我们可以直接使用以 $\\mu\\mathrm{M}$ 为单位的值：\n$$\n\\mathcal{H} = \\frac{(0.2)^{2}}{(0.3)^{2} + (0.2)^{2}} = \\frac{0.04}{0.09 + 0.04} = \\frac{0.04}{0.13} = \\frac{4}{13}\n$$\n接下来，我们计算 $\\frac{V_{\\max}}{P_{\\mathrm{leak}}}$ 项：\n$$\n\\frac{V_{\\max}}{P_{\\mathrm{leak}}} = \\frac{1.6 \\times 10^{-8}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}}{1.0 \\times 10^{-8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = 1.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n该项的单位正确地为浓度单位，这证实了我们推导的符号表达式的量纲一致性。\n\n现在我们将这些值代入 $[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}}$ 的方程中，确保所有项都使用国际单位制单位 ($\\mathrm{mol}\\,\\mathrm{m}^{-3}$)：\n$$\n[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} = (0.2 \\times 10^{-3}) + (1.6) \\times \\left(\\frac{4}{13}\\right)\n$$\n所有项的单位都是 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n$$\n[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} = 0.0002 + \\frac{6.4}{13} \\approx 0.0002 + 0.49230769\n$$\n$$\n[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} \\approx 0.49250769\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n问题要求最终答案以 $\\mu\\mathrm{M}$ 为单位。我们使用换算因子 $1\\,\\mathrm{mol}\\,\\mathrm{m}^{-3} = 10^3\\,\\mu\\mathrm{M}$。\n$$\n[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} \\approx 0.49250769 \\times 10^3\\,\\mu\\mathrm{M} = 492.50769\\,\\mu\\mathrm{M}\n$$\n最后，我们按照要求将答案四舍五入到四位有效数字：\n$$\n[\\mathrm{Ca}^{2+}]_{\\mathrm{ER}} \\approx 492.5\\,\\mu\\mathrm{M}\n$$\n这个结果在生物物理学上是合理的，因为内质网腔的钙离子浓度通常在数百微摩尔的范围内，而静息胞质溶胶的钙离子浓度要低几个数量级。", "answer": "$$\\boxed{492.5}$$", "id": "2746401"}, {"introduction": "计算建模是研究复杂生物系统的强大工具，在现代神经科学中扮演着越来越重要的角色。这项综合性练习将挑战你构建并分析一个神经元钙动力学的多室模型，该模型整合了钙内流、外排、缓冲以及扩散等多个关键过程[@problem_id:2746415]。通过执行灵敏度分析，你将学会如何定量地识别出对钙信号（如峰值振幅和衰减时间）影响最大的关键参数，这是定量神经科学研究中的一项核心技能。", "problem": "要求您编写一个完整、可运行的程序，对一个双室神经元模型中胞质钙离子浓度的峰值振幅和衰减时间进行局部、一次一个参数的灵敏度分析。这两个室代表胞体和树突，它们之间存在扩散耦合。目的是为每个给定的参数集，确定哪个单一参数对胞体中的两个指标（峰值振幅和衰减时间）影响最强。\n\n基本原理与模型构建：\n- 从每个室的质量平衡出发：变化率等于源项和汇项之和。使用菲克定律（Fick's law）描述室间扩散，使用一级动力学描述质膜钙ATP酶（PMCA）和钠钙交换体（NCX）等膜泵的外排作用。通过一个恒定的缓冲容量来表示快速缓冲，该容量会减少有效的游离钙变化。\n- 令 $c_s(t)$ 和 $c_d(t)$ 分别表示胞体和树突中游离胞质钙离子的浓度，单位为微摩尔（表示为 $\\mu\\mathrm{M}$）。令 $c_0$ 为静息状态下的游离钙水平，单位为 $\\mu\\mathrm{M}$。\n- 令 $J_{\\text{in},s}(t)$ 和 $J_{\\text{in},d}(t)$ 分别为进入胞体和树突的外部钙离子内流，模拟电压门控钙通道（VGCC）的短暂开放。使用一个带有单一参数 $\\tau_{\\text{in}}$ 的 $\\alpha$-函数时间进程 $g(t)$ 来塑造内流：$$g(t) = \\begin{cases}\\dfrac{t}{\\tau_{\\text{in}}}\\exp\\!\\left(1-\\dfrac{t}{\\tau_{\\text{in}}}\\right),  & t \\ge 0 \\\\ 0,  & t  0\\end{cases}$$ 该函数在 $t=\\tau_{\\text{in}}$ 时达到无量纲峰值 $1$。然后设置 $$J_{\\text{in},s}(t) = V_{\\text{in},s}\\, g(t), \\quad J_{\\text{in},d}(t) = V_{\\text{in},d}\\, g(t),$$ 其中 $V_{\\text{in},s}$ 和 $V_{\\text{in},d}$ 是内流振幅，单位为 $\\mu\\mathrm{M}/\\mathrm{s}$。\n- 令 $k_{\\text{out},s}$ 和 $k_{\\text{out},d}$ 为一级外排速率常数（单位为 $\\mathrm{s}^{-1}$），将 PMCA 和 NCX 建模为 $J_{\\text{out},x} = k_{\\text{out},x}\\,(c_x - c_0)$，对于室 $x\\in\\{s,d\\}$。\n- 令 $\\kappa_s$ 和 $\\kappa_d$ 分别为胞体和树突的无量纲缓冲容量。快速缓冲将每个室的有效时间导数减小一个因子 $(1+\\kappa_x)$。\n- 令 $D_{sd}$ 为室间的有效扩散耦合速率（单位为 $\\mathrm{s}^{-1}$），产生通量 $J_{\\text{diff},s} = D_{sd}\\,(c_d - c_s)$ 和 $J_{\\text{diff},d} = D_{sd}\\,(c_s - c_d)$。\n- 最终得到的方程组为\n$$\\frac{dc_s}{dt} = \\frac{1}{1+\\kappa_s}\\left[J_{\\text{in},s}(t) - k_{\\text{out},s}\\,\\big(c_s-c_0\\big) + D_{sd}\\,\\big(c_d - c_s\\big)\\right],$$\n$$\\frac{dc_d}{dt} = \\frac{1}{1+\\kappa_d}\\left[J_{\\text{in},d}(t) - k_{\\text{out},d}\\,\\big(c_d-c_0\\big) + D_{sd}\\,\\big(c_s - c_d\\big)\\right],$$\n初始条件为 $c_s(0)=c_d(0)=c_0$。\n\n根据胞体轨迹 $c_s(t)$ 计算的指标：\n- 相对于基线的峰值振幅：$$A = \\max_{t\\in[0,T_{\\max}]} c_s(t) - c_0,$$ 以 $\\mu\\mathrm{M}$ 表示。\n- 衰减到峰值 $1/e$ 分数所需的时间：如果峰值在时间 $t_{\\text{peak}}$ 出现，振幅为 $A$，则设置阈值 $c_{\\text{thr}} = c_0 + A/e$。衰减时间为 $$\\tau_{\\text{decay}} = t_{\\text{cross}} - t_{\\text{peak}},$$ 其中 $t_{\\text{cross}}$ 是第一个满足 $c_s(t) \\le c_{\\text{thr}}$ 的时间 $t \\ge t_{\\text{peak}}$。$\\tau_{\\text{decay}}$ 以秒表示。如果在模拟时程 $[0,T_{\\max}]$ 内未达到阈值，则视为不可测量。\n\n灵敏度定义：\n- 对于一个标量指标 $M$（$A$ 或 $\\tau_{\\text{decay}}$）和一个参数 $p$，将无量纲局部灵敏度系数定义为 $$S_M(p) = \\frac{p}{M}\\,\\frac{dM}{dp},$$ 通过一个具有小的相对扰动 $\\delta=0.05$ 的中心有限差分进行数值近似：\n$$S_M(p) \\approx \\frac{p}{M(p)}\\cdot \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,p} = \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,M(p)}.$$\n通过扰动单个参数并将其余参数固定在基线值来计算一次一个参数的灵敏度。\n\n模拟方案与常数：\n- 使用 $c_0 = 0.1\\,\\mu\\mathrm{M}$（在代码中写为 $c_0 = 0.1$，因为浓度单位是 $\\mu\\mathrm{M}$）。\n- 使用 $\\tau_{\\text{in}} = 0.02\\,\\mathrm{s}$（在代码中写为 $\\tau_{\\text{in}} = 0.02$）。\n- 在 $[0,T_{\\max}]$ 上进行模拟，其中 $T_{\\max} = 4.0\\,\\mathrm{s}$（在代码中写为 $T_{\\max} = 4.0$）。\n- 使用相对扰动 $\\delta = 0.05$（在代码中写为 $\\delta = 0.05$）。\n- 使用初始条件 $c_s(0)=c_d(0)=c_0$。\n\n参数向量与索引：\n- 参数向量的顺序为 $$\\mathbf{p} = \\big[V_{\\text{in},s},\\, V_{\\text{in},d},\\, k_{\\text{out},s},\\, k_{\\text{out},d},\\, \\kappa_s,\\, \\kappa_d,\\, D_{sd}\\big].$$\n- 使用零基索引：$V_{\\text{in},s}$ 的索引为 $0$，$V_{\\text{in},d}$ 为 $1$，$k_{\\text{out},s}$ 为 $2$，$k_{\\text{out},d}$ 为 $3$，$\\kappa_s$ 为 $4$，$\\kappa_d$ 为 $5$，$D_{sd}$ 为 $6$。\n\n测试套件：\n提供以下四个基线参数集（所有浓度单位为 $\\mu\\mathrm{M}$，时间单位为 s）：\n- 情况 1：$[6.0,\\,3.0,\\,3.0,\\,3.0,\\,20.0,\\,20.0,\\,1.0]$。\n- 情况 2：$[6.0,\\,6.0,\\,3.5,\\,3.5,\\,60.0,\\,60.0,\\,10.0]$。\n- 情况 3：$[6.0,\\,3.0,\\,3.0,\\,3.0,\\,300.0,\\,50.0,\\,1.0]$。\n- 情况 4：$[6.0,\\,3.0,\\,3.0,\\,0.5,\\,80.0,\\,50.0,\\,2.0]$。\n\n程序需要完成的任务：\n- 对每个测试用例，模拟该模型，计算如上定义的胞体峰值振幅 $A$ 和衰减时间 $\\tau_{\\text{decay}}$。\n- 使用中心差分近似和 $\\delta$ 计算所有七个参数 $p_i$ 的一次一个参数的无量纲局部灵敏度 $S_A(p_i)$ 和 $S_{\\tau}(p_i)$。\n- 对于每个指标，找出具有最大绝对灵敏度值的单一参数的索引 $i$。\n\n最终输出规范：\n- 您的程序应生成一行输出，其中包含一个逗号分隔的Python风格整数列表。对于每个测试用例，按给定顺序连接两个整数：首先是具有最大 $|S_A|$ 的参数索引，然后是具有最大 $|S_{\\tau}|$ 的参数索引。例如，输出应具有以下形式：$$[i_{A,1},i_{\\tau,1},i_{A,2},i_{\\tau,2},i_{A,3},i_{\\tau,3},i_{A,4},i_{\\tau,4}],$$ 其中每个 $i$ 是集合 $\\{0,1,2,3,4,5,6\\}$ 中的一个整数索引。", "solution": "用户提供的问题陈述已经过严格验证。\n\n### 第一步：提取已知条件\n\n- **模型变量**：胞体和树突中的游离胞质钙离子浓度 $c_s(t)$ 和 $c_d(t)$。\n- **模型方程**：\n$$\n\\frac{dc_s}{dt} = \\frac{1}{1+\\kappa_s}\\left[J_{\\text{in},s}(t) - k_{\\text{out},s}\\,\\big(c_s-c_0\\big) + D_{sd}\\,\\big(c_d - c_s\\big)\\right]\n$$\n$$\n\\frac{dc_d}{dt} = \\frac{1}{1+\\kappa_d}\\left[J_{\\text{in},d}(t) - k_{\\text{out},d}\\,\\big(c_d-c_0\\big) + D_{sd}\\,\\big(c_s - c_d\\big)\\right]\n$$\n- **内流项**：\n$J_{\\text{in},x}(t) = V_{\\text{in},x}\\, g(t)$，对于 $x \\in \\{s, d\\}$，其中时间分布由α-函数给出：\n$$\ng(t) = \\begin{cases}\\dfrac{t}{\\tau_{\\text{in}}}\\exp\\!\\left(1-\\dfrac{t}{\\tau_{\\textin}}}\\right),   t \\ge 0 \\\\ 0,   t  0\\end{cases}\n$$\n- **初始条件**：$c_s(0) = c_0$, $c_d(0) = c_0$。\n- **常数**：\n    - 静息钙浓度：$c_0 = 0.1\\,\\mu\\mathrm{M}$。\n    - 内流时间常数：$\\tau_{\\text{in}} = 0.02\\,\\mathrm{s}$。\n    - 模拟时间范围：$T_{\\max} = 4.0\\,\\mathrm{s}$。\n    - 灵敏度分析的相对扰动：$\\delta = 0.05$。\n- **参数向量**：$\\mathbf{p} = \\big[V_{\\text{in},s},\\, V_{\\text{in},d},\\, k_{\\text{out},s},\\, k_{\\text{out},d},\\, \\kappa_s,\\, \\kappa_d,\\, D_{sd}\\big]$。参数索引是从0到6的零基索引。\n- **指标**：\n    - 峰值振幅：$A = \\max_{t\\in[0,T_{\\max}]} c_s(t) - c_0$。\n    - 衰减时间：$\\tau_{\\text{decay}} = t_{\\text{cross}} - t_{\\text{peak}}$，其中 $t_{\\text{peak}}$ 是峰值时间，而 $t_{\\text{cross}}$ 是第一个满足 $c_s(t) \\le c_0 + A/e$ 的时间 $t \\ge t_{\\text{peak}}$。\n- **灵敏度定义**：\n$$\nS_M(p) \\approx \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,M(p)}\n$$\n- **测试用例（基线参数集）**：\n    - 情况 1：$[6.0,\\,3.0,\\,3.0,\\,3.0,\\,20.0,\\,20.0,\\,1.0]$。\n    - 情况 2：$[6.0,\\,6.0,\\,3.5,\\,3.5,\\,60.0,\\,60.0,\\,10.0]$。\n    - 情况 3：$[6.0,\\,3.0,\\,3.0,\\,3.0,\\,300.0,\\,50.0,\\,1.0]$。\n    - 情况 4：$[6.0,\\,3.0,\\,3.0,\\,0.5,\\,80.0,\\,50.0,\\,2.0]$。\n- **任务**：对于每个测试用例，确定对峰值振幅 $A$ 和衰减时间 $\\tau_{\\text{decay}}$ 具有最大绝对灵敏度的参数索引。\n- **输出格式**：一个包含8个整数的单行Python风格列表：$[i_{A,1},i_{\\tau,1},i_{A,2},i_{\\tau,2},i_{A,3},i_{\\tau,3},i_{A,4},i_{\\tau,4}]$。\n\n### 第二步：使用提取的已知条件进行验证\n\n- **科学依据充分**：该问题描述了一个标准的钙动力学双室模型，基于质量平衡原理、离子传输的一级动力学和扩散耦合（菲克定律）。快速缓冲近似和用于突触输入的α-函数是计算神经科学中常见且有效的简化方法。该模型在科学上是合理的。\n- **适定性**：该问题是一个包含两个耦合的线性一阶常微分方程（ODE）的系统，带有一个时变驱动项。在指定的初始条件下，对于任何给定的参数集，都存在唯一解。指标和灵敏度分析的定义明确。该问题是适定的。\n- **客观性**：所有术语、变量、参数和任务都经过了数学上的精确定义。该问题是客观的，没有主观解释的余地。\n- **不完整或矛盾的设置**：问题是自洽的。所有必需的方程、常数、参数值、初始条件和程序定义都已提供。没有矛盾之处。\n- **不切实际或不可行**：参数值在简化神经元模型的生理学合理范围内。该设置是可行的。\n\n### 第三步：结论与行动\n\n问题有效。它科学依据充分、适定、客观且完整。将构建一个解决方案。\n\n该任务要求对一个常微分方程系统执行一次一个参数的局部灵敏度分析。整体计算流程如下：\n1.  对于提供的四个基线参数集中的每一个，将执行一系列数值模拟。\n2.  该程序的核心是一个函数，对于给定的参数向量 $\\mathbf{p} = [p_0, \\dots, p_6]$，该函数会求解常微分方程组并计算两个输出指标：胞体钙浓度 $c_s(t)$ 的峰值振幅（$A$）和衰减时间（$\\tau_{\\text{decay}}$）。\n3.  常微分方程组由以下公式给出：\n    $$\n    \\frac{d}{dt}\\begin{pmatrix} c_s \\\\ c_d \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1+p_4} \\left[ p_0 g(t) - p_2(c_s - c_0) + p_6(c_d - c_s) \\right] \\\\ \\frac{1}{1+p_5} \\left[ p_1 g(t) - p_3(c_d - c_0) + p_6(c_s - c_d) \\right] \\end{pmatrix}\n    $$\n    初始条件为 $c_s(0) = c_d(0) = c_0$。该系统将使用一个标准的ODE求解器，特别是`scipy.integrate.solve_ivp`，在时间区间 $[0, T_{\\max}]$ 上进行数值求解，该求解器适用于此类非刚性系统。\n4.  根据得到的胞体轨迹 $c_s(t)$，计算指标如下：\n    -   峰值时间 $t_{\\text{peak}}$ 通过 $\\operatorname{argmax}_t c_s(t)$ 找到。\n    -   峰值振幅为 $A = c_s(t_{\\text{peak}}) - c_0$。\n    -   衰减阈值为 $c_{\\text{thr}} = c_0 + A/e$。\n    -   穿越时间 $t_{\\text{cross}}$ 是第一个满足 $c_s(t) \\le c_{\\text{thr}}$ 的时间 $t \\ge t_{\\text{peak}}$。\n    -   衰减时间为 $\\tau_{\\text{decay}} = t_{\\text{cross}} - t_{\\text{peak}}$。如果在 $T_{\\max}$ 之前未穿越阈值，则该指标视为不可测量。\n5.  使用基线参数向量 $\\mathbf{p}_{\\text{base}}$，计算基线指标 $A_{\\text{base}}$ 和 $\\tau_{\\text{decay},\\text{base}}$。\n6.  灵敏度分析通过遍历每个参数 $p_i$（其中 $i \\in \\{0, 1, \\dots, 6\\}$）来进行。对于每个 $p_i$，创建两个扰动后的参数向量：\n    -   $\\mathbf{p}^+$，其中 $p_i$ 被替换为 $p_i(1+\\delta)$。\n    -   $\\mathbf{p}^-$，其中 $p_i$ 被替换为 $p_i(1-\\delta)$。\n7.  为每个扰动向量计算指标，得到 $(A^+, \\tau_{\\text{decay}}^+) $ 和 $(A^-, \\tau_{\\text{decay}}^-)$。\n8.  然后，使用中心有限差分公式近似计算 $A$ 和 $\\tau_{\\text{decay}}$ 相对于参数 $p_i$ 的无量纲局部灵敏度系数：\n    $$\n    S_A(p_i) \\approx \\frac{A^+ - A^-}{2\\,\\delta\\,A_{\\text{base}}}\n    $$\n    $$\n    S_{\\tau}(p_i) \\approx \\frac{\\tau_{\\text{decay}}^+ - \\tau_{\\text{decay}}^-}{2\\,\\delta\\,\\tau_{\\text{decay},\\text{base}}}\n    $$\n9.  在为每个指标计算出七个灵敏度（$S_A(p_0), \\dots, S_A(p_6)$ 和 $S_{\\tau}(p_0), \\dots, S_{\\tau}(p_6)$）后，取其绝对值。\n10. 对于 $A$ 和 $\\tau_{\\text{decay}}$，找出产生最大绝对灵敏度的参数索引。对于一个指标 $M$，即 $\\operatorname{argmax}_i |S_M(p_i)|$。\n11. 对所有四个测试用例重复此过程。将得到的八个索引收集并格式化为所需的输出字符串。\n实现将被封装在一个单独的Python脚本中，并遵循指定的执行环境和库。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Performs a one-at-a-time sensitivity analysis on a two-compartment neuronal\n    calcium model for four different parameter sets.\n    \"\"\"\n\n    # --- Define constants and test cases ---\n    c0 = 0.1  # Resting [Ca2+], uM\n    tau_in = 0.02  # Influx time constant, s\n    t_max = 4.0  # Simulation time horizon, s\n    delta = 0.05  # Relative perturbation for sensitivity analysis\n\n    test_cases = [\n        [6.0, 3.0, 3.0, 3.0, 20.0, 20.0, 1.0],   # Case 1\n        [6.0, 6.0, 3.5, 3.5, 60.0, 60.0, 10.0],  # Case 2\n        [6.0, 3.0, 3.0, 3.0, 300.0, 50.0, 1.0],  # Case 3\n        [6.0, 3.0, 3.0, 0.5, 80.0, 50.0, 2.0],   # Case 4\n    ]\n\n    # --- Helper function for influx time course ---\n    def influx_g(t):\n        if t  0:\n            return 0.0\n        # The alpha-function is implemented such that its peak is 1.\n        # This requires the factor exp(1-t/tau_in)\n        return (t / tau_in) * np.exp(1 - t / tau_in)\n\n    # --- ODE system definition ---\n    def model(t, y, params):\n        cs, cd = y\n        v_in_s, v_in_d, k_out_s, k_out_d, kappa_s, kappa_d, d_sd = params\n        \n        g_t = influx_g(t)\n        \n        # dcs/dt\n        dcs_dt = (1 / (1 + kappa_s)) * (\n            v_in_s * g_t - k_out_s * (cs - c0) + d_sd * (cd - cs)\n        )\n        # dcd/dt\n        dcd_dt = (1 / (1 + kappa_d)) * (\n            v_in_d * g_t - k_out_d * (cd - c0) + d_sd * (cs - cd)\n        )\n        \n        return [dcs_dt, dcd_dt]\n\n    # --- Function to run simulation and compute metrics ---\n    def get_metrics(current_params):\n        sol = solve_ivp(\n            model,\n            [0, t_max],\n            [c0, c0],\n            args=(current_params,),\n            dense_output=True,\n            method='RK45',\n            t_eval=np.linspace(0, t_max, 2000) # Ensure sufficient time resolution\n        )\n        t = sol.t\n        cs = sol.y[0]\n\n        # Metric 1: Peak amplitude A\n        if len(cs) == 0:\n            return np.nan, np.nan\n        \n        peak_idx = np.argmax(cs)\n        t_peak = t[peak_idx]\n        c_peak = cs[peak_idx]\n        amplitude = c_peak - c0\n\n        # Metric 2: Decay time tau_decay\n        if amplitude = 0:\n            return amplitude, np.nan\n            \n        threshold = c0 + amplitude / np.e\n        \n        # Find first time t >= t_peak where cs(t) = threshold\n        decay_indices = np.where((t >= t_peak)  (cs = threshold))[0]\n        \n        if len(decay_indices) == 0:\n            # Threshold not reached\n            tau_decay = np.nan\n        else:\n            t_cross_idx = decay_indices[0]\n            \n            # Linear interpolation for better accuracy\n            if t_cross_idx > 0:\n                t1, c1 = t[t_cross_idx - 1], cs[t_cross_idx - 1]\n                t2, c2 = t[t_cross_idx], cs[t_cross_idx]\n                if c1 - c2 > 1e-9: # Avoid division by zero\n                    t_cross = t1 + (t2 - t1) * (threshold - c1) / (c2 - c1)\n                else:\n                    t_cross = t2\n            else:\n                 t_cross = t[t_cross_idx]\n            \n            tau_decay = t_cross - t_peak\n\n        return amplitude, tau_decay\n\n    # --- Main analysis loop ---\n    final_results = []\n    \n    for base_params in test_cases:\n        # Calculate baseline metrics\n        A_base, tau_base = get_metrics(base_params)\n\n        sens_A = []\n        sens_tau = []\n\n        for i in range(len(base_params)):\n            # Perturb parameter p_i\n            p_val = base_params[i]\n            \n            # Positive perturbation\n            params_plus = list(base_params)\n            params_plus[i] = p_val * (1 + delta)\n            A_plus, tau_plus = get_metrics(params_plus)\n\n            # Negative perturbation\n            params_minus = list(base_params)\n            params_minus[i] = p_val * (1 - delta)\n            A_minus, tau_minus = get_metrics(params_minus)\n            \n            # Calculate sensitivity for Amplitude\n            if A_base > 1e-9 and not np.isnan(A_plus) and not np.isnan(A_minus):\n                s_A = (A_plus - A_minus) / (2 * delta * A_base)\n            else:\n                s_A = 0.0\n            sens_A.append(s_A)\n\n            # Calculate sensitivity for Decay Time\n            if tau_base > 1e-9 and not np.isnan(tau_plus) and not np.isnan(tau_minus):\n                s_tau = (tau_plus - tau_minus) / (2 * delta * tau_base)\n            else:\n                s_tau = 0.0 # If baseline or perturbed is invalid, sensitivity is zero\n            sens_tau.append(s_tau)\n\n        # Find index of parameter with max absolute sensitivity\n        idx_max_sens_A = np.argmax(np.abs(sens_A))\n        idx_max_sens_tau = np.argmax(np.abs(sens_tau))\n        \n        final_results.extend([idx_max_sens_A, idx_max_sens_tau])\n\n    # --- Format and print final output ---\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\nsolve()\n```", "id": "2746415"}]}