{"hands_on_practices": [{"introduction": "突触可塑性的“钙假说”是神经科学的核心原则之一，它指出胞内钙离子（$\\mathrm{Ca}^{2+}$）信号的动力学特征决定了突觸是发生长时程增强（LTP）还是长时程抑制（LTD）。这项练习 [@problem_id:2722045] 要求你构建一个计算模型，以比较来自N-甲基-D-天冬氨酸受体（NMDARs）和电压门控钙通道（VGCCs）的$\\mathrm{Ca}^{2+}$瞬变。通过这个实践，你将能够量化为何通过NMDARs产生的缓慢而适度的$\\mathrm{Ca}^{2+}$升高被认为是触发LTD的经典信号。", "problem": "设计并实现一个程序，该程序模拟由一串突触脉冲诱发的胞质钙离子（$\\mathrm{Ca}^{2+}$）瞬变，并比较两种$\\mathrm{Ca}^{2+}$内流来源：N-甲基-D-天冬氨酸受体（NMDARs）和电压门控钙离子通道（VGCCs）。目标是对于每一组指定的参数，确定哪种来源产生的$\\mathrm{Ca}^{2+}$信号同时具有衰减缓慢和峰值幅度低的特点，这些特征与长时程抑制（LTD）的诱导相关。在给定随机种子的情况下，程序必须是完全确定性的。\n\n基本建模假设：\n- 使用线性时不变叠加来模拟由单个脉冲引起的$\\mathrm{Ca}^{2+}$浓度瞬变。对于一个来源 $s \\in \\{\\mathrm{N}, \\mathrm{V}\\}$（NMDAR 或 VGCC），在时间 $t_i$ 由单个脉冲诱发的瞬变由双指数核函数建模\n$$\nh_s(t; \\tau_{r,s}, \\tau_{d,s}) = \\begin{cases}\n\\exp(-t/\\tau_{d,s}) - \\exp(-t/\\tau_{r,s}),  t \\ge 0,\\\\\n0,  t  0,\n\\end{cases}\n$$\n其中 $\\tau_{r,s} > 0$ 且 $\\tau_{d,s} > \\tau_{r,s}$。\n- 将每个核函数归一化至单位峰值，使得幅度参数直接缩放单个独立脉冲的峰值贡献。令\n$$\nt_{\\mathrm{peak},s} = \\frac{\\tau_{d,s}\\,\\tau_{r,s}}{\\tau_{d,s}-\\tau_{r,s}} \\ln\\!\\left(\\frac{\\tau_{d,s}}{\\tau_{r,s}}\\right), \\quad\nH_{\\max,s} = h_s(t_{\\mathrm{peak},s}; \\tau_{r,s}, \\tau_{d,s}),\n$$\n并定义归一化核函数\n$$\n\\tilde{h}_s(t) = \\frac{h_s(t; \\tau_{r,s}, \\tau_{d,s})}{H_{\\max,s}}。\n$$\n- 将一串包含5个脉冲的爆发建模，其名义发放时间为 $t_n^{(0)} = n \\cdot 50\\,\\mathrm{ms}$（对于 $n \\in \\{0,1,2,3,4\\}$，即 $20\\,\\mathrm{Hz}$）。通过添加独立的毫秒级高斯抖动 $\\epsilon_n \\sim \\mathcal{N}(0,\\sigma_{\\mathrm{jit}}^2)$ 来引入时间随机性，然后对扰动后的时间进行排序以保持因果关系：\n$$\nt_n = \\mathrm{sort}\\left(t_n^{(0)} + \\epsilon_n\\right)。\n$$\n- 将每个脉冲的幅度变异性建模为独立的对数正态乘数 $w_{n,s}$，其均值为1，变异系数为 $CV_s$。如果 $\\ln w_{n,s} \\sim \\mathcal{N}(\\mu_s,\\sigma_s^2)$，且 $\\mathbb{E}[w_{n,s}] = 1$ 和 $\\mathrm{CV}[w_{n,s}] = CV_s$，那么 $\\sigma_s^2 = \\ln(1+CV_s^2)$ 且 $\\mu_s = -\\sigma_s^2/2$。\n- 来源 $s$ 的总$\\mathrm{Ca}^{2+}$浓度轨迹为\n$$\nC_s(t) = \\sum_{n=0}^{4} A_s \\, w_{n,s} \\, \\tilde{h}_s(t - t_n),\n$$\n在均匀时间网格 $t = 0, \\Delta t, 2\\Delta t, \\ldots, T_{\\max}$ 上进行评估，其中 $\\Delta t$ 和 $T_{\\max}$ 是给定的。\n\n类LTD特征的判定规则：\n- 对于每个来源 $s$，计算峰值浓度和峰后半衰期：\n  - 峰值幅度：$C_{\\mathrm{peak},s} = \\max_t C_s(t)$，对应的峰值时间为 $t_{\\mathrm{peak},s}^{\\mathrm{obs}} = \\arg\\max_t C_s(t)$。\n  - 半衰期：$t_{\\frac{1}{2},s}$ 是满足 $C_s(t_{\\mathrm{peak},s}^{\\mathrm{obs}} + \\Delta t') \\le \\tfrac{1}{2} C_{\\mathrm{peak},s}$ 的最小 $\\Delta t' \\ge 0$；如果在 $[0,T_{\\max}]$ 内不存在这样的时间，则取 $t_{\\frac{1}{2},s} = T_{\\max} - t_{\\mathrm{peak},s}^{\\mathrm{obs}}$。\n- 如果一个来源的峰值严格小于另一个来源，且半衰期严格长于另一个来源，则认为它更具类LTD特征。如果只有一个来源满足这两个不等式，则选择该来源。否则，计算LTD得分\n$$\nS_s = \\frac{t_{\\frac{1}{2},s}}{C_{\\mathrm{peak},s}},\n$$\n并选择 $S_s$ 较大的来源。如果 $|S_{\\mathrm{N}} - S_{\\mathrm{V}}| \\le \\varepsilon$，其中 $\\varepsilon = 10^{-9}$，则按惯例选择NMDAR。\n\n程序要求：\n- 完全按照所述内容实现上述模型和判定规则。\n- 使用提供的随机种子初始化伪随机数生成器，以确保每个测试用例的抖动和对数正态乘数是可复现的。\n- 时间单位必须是毫秒。所有模拟必须使用为每个用例指定的 $\\Delta t$ 和 $T_{\\max}$。\n- 最终程序输出必须是一行，包含一个整数列表，每个整数对应一个测试用例，其中 $1$ 表示预测NMDAR产生LTD特征的缓慢、低幅度的$\\mathrm{Ca}^{2+}$升高，而 $0$ 表示VGCC。\n\n测试套件（每个元组是一个测试用例）：\n- 用例A（典型动力学；中等噪声和抖动）：\n  - 种子：$12345$\n  - $\\sigma_{\\mathrm{jit}} = 2\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.2$, $CV_{\\mathrm{V}} = 0.2$\n  - NMDAR: $A_{\\mathrm{N}} = 0.4$, $\\tau_{r,\\mathrm{N}} = 10\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 150\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 1.0$, $\\tau_{r,\\mathrm{V}} = 1\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 25\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1000\\,\\mathrm{ms}$\n- 用例B（幅度处于边界值；动力学与用例A相同）：\n  - 种子：$24680$\n  - $\\sigma_{\\mathrm{jit}} = 2\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.2$, $CV_{\\mathrm{V}} = 0.2$\n  - NMDAR: $A_{\\mathrm{N}} = 0.8$, $\\tau_{r,\\mathrm{N}} = 10\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 150\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 0.9$, $\\tau_{r,\\mathrm{V}} = 1\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 25\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1000\\,\\mathrm{ms}$\n- 用例C（VGCC具有延长的衰减和更低的幅度；测试VGCC作为潜在的类LTD来源）：\n  - 种子：$13579$\n  - $\\sigma_{\\mathrm{jit}} = 3\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.25$, $CV_{\\mathrm{V}} = 0.25$\n  - NMDAR: $A_{\\mathrm{N}} = 0.6$, $\\tau_{r,\\mathrm{N}} = 8\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 120\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 0.25$, $\\tau_{r,\\mathrm{V}} = 1\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 200\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1200\\,\\mathrm{ms}$\n- 用例D（边缘情况：相同的动力学和幅度，确定性的时间和幅度）：\n  - 种子：$777$\n  - $\\sigma_{\\mathrm{jit}} = 0\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.0$, $CV_{\\mathrm{V}} = 0.0$\n  - NMDAR: $A_{\\mathrm{N}} = 0.5$, $\\tau_{r,\\mathrm{N}} = 5\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 150\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 0.5$, $\\tau_{r,\\mathrm{V}} = 5\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 150\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1000\\,\\mathrm{ms}$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[1,0,1,1]$），其中第 $k$ 个条目对应于顺序为A、B、C、D的第 $k$ 个测试用例，如果选择NMDAR，则条目为 $1$，如果选择VGCC，则为 $0$。", "solution": "所提出的问题是计算神经科学领域一个有效且适定的练习。它要求基于已建立的生物物理模型，实现一个确定性模拟，以研究N-甲基-D-天冬氨酸受体（NMDARs）和电压门控钙离子通道（VGCCs）在塑造胞质钙离子（$\\mathrm{Ca}^{2+}$）信号中的不同作用，这些信号对于长时程抑制（LTD）等突触可塑性现象至关重要。该问题具有科学依据，数学上定义明确无歧义，并包含了得出唯一解所需的所有必要参数和条件。因此，我的分析将直接进入解决方案的构建。\n\n该解决方案是通过严格实现指定的模型来构建的。模型的核心是线性时不变（LTI）叠加原理，这是对个体输入产生的效应呈线性叠加的系统的一种标准近似。\n\n首先，我们为每个钙离子来源 $s \\in \\{\\mathrm{N}, \\mathrm{V}\\}$ 定义基本响应，即核函数。问题指定了一个双指数函数：\n$$\nh_s(t; \\tau_{r,s}, \\tau_{d,s}) = \\begin{cases}\n\\exp(-t/\\tau_{d,s}) - \\exp(-t/\\tau_{r,s}),  t \\ge 0\\\\\n0,  t  0\n\\end{cases}\n$$\n其中 $\\tau_{r,s}$ 是上升时间常数，$\\tau_{d,s}$ 是衰减时间常数。条件 $\\tau_{d,s} > \\tau_{r,s}$ 确保了与物理现实一致的正脉冲形状。\n\n为了在同等基础上比较不同动力学的信号，核函数被归一化，使其峰值幅度为1。达到峰值的时间 $t_{\\mathrm{peak},s}$ 通过求解 $dh_s/dt = 0$ 得到：\n$$\nt_{\\mathrm{peak},s} = \\frac{\\tau_{d,s}\\,\\tau_{r,s}}{\\tau_{d,s}-\\tau_{r,s}} \\ln\\!\\left(\\frac{\\tau_{d,s}}{\\tau_{r,s}}\\right)\n$$\n未归一化核函数的峰值为 $H_{\\max,s} = h_s(t_{\\mathrm{peak},s}; \\tau_{r,s}, \\tau_{d,s})$。归一化的核函数 $\\tilde{h}_s(t)$ 则为：\n$$\n\\tilde{h}_s(t) = \\frac{h_s(t; \\tau_{r,s}, \\tau_{d,s})}{H_{\\max,s}}\n$$\n这种归一化确保了幅度参数 $A_s$ 直接缩放单个孤立突触事件的峰值贡献。为提高计算效率，这个归一化核函数 $\\tilde{h}_s(t)$ 将在模拟时间网格上预先计算。\n\n接下来，我们对突触输入进行建模，它是一串包含5个脉冲的爆发。名义脉冲时间为 $t_n^{(0)} = n \\cdot 50\\,\\mathrm{ms}$（对于 $n \\in \\{0, 1, 2, 3, 4\\}$），对应于 $20\\,\\mathrm{Hz}$ 的发放频率。通过两个随机过程引入了生物学真实性，每个测试用例指定的随机种子保证了其可复现性。\n1.  **时间抖动**：通过添加独立的高斯噪声 $\\epsilon_n \\sim \\mathcal{N}(0, \\sigma_{\\mathrm{jit}}^2)$ 来扰动脉冲时间。对结果时间进行排序以维持因果顺序：$t_n = \\mathrm{sort}(t_n^{(0)} + \\epsilon_n)$。\n2.  **幅度变异**：每个脉冲贡献的有效幅度由一个独立的随机权重 $w_{n,s}$ 进行缩放。这些权重从对数正态分布中抽取，使得其均值为 $\\mathbb{E}[w_{n,s}] = 1$，变异系数为 $\\mathrm{CV}[w_{n,s}] = CV_s$。其对应的正态分布 $\\ln w_{n,s} \\sim \\mathcal{N}(\\mu_s, \\sigma_s^2)$ 的参数由关系式 $\\sigma_s^2 = \\ln(1+CV_s^2)$ 和 $\\mu_s = -\\sigma_s^2/2$ 确定。\n\n一个来源 $s$ 的总$\\mathrm{Ca}^{2+}$浓度 $C_s(t)$ 是脉冲序列中每个脉冲响应的线性叠加：\n$$\nC_s(t) = \\sum_{n=0}^{4} A_s \\, w_{n,s} \\, \\tilde{h}_s(t - t_n)\n$$\n该求和在从 $t=0$ 到 $t=T_{\\max}$、步长为 $\\Delta t$ 的离散时间网格上进行评估。实现将采用计算高效的“移位-相加”方法，这是卷积的一种离散近似，其中，预先计算的核函数 $\\tilde{h}_s(t)$ 根据每个脉冲时间 $t_n$ 进行移位、缩放和累加。\n\n最后，必须为每组参数做出决策。这需要从每个模拟轨迹 $C_s(t)$ 中提取两个关键指标：\n1.  **峰值幅度**：$C_{\\mathrm{peak},s} = \\max_t C_s(t)$。\n2.  **半衰期**：$t_{\\frac{1}{2},s}$，即信号从其峰值下降到其峰值一半所需的时间。我们找到峰值时间 $t_{\\mathrm{peak},s}^{\\mathrm{obs}} = \\arg\\max_t C_s(t)$，然后搜索满足 $C_s(t_{\\mathrm{peak},s}^{\\mathrm{obs}} + \\Delta t') \\le \\frac{1}{2} C_{\\mathrm{peak},s}$ 的最小时间 $\\Delta t' \\ge 0$。这个 $\\Delta t'$ 就是 $t_{\\frac{1}{2},s}$。如果浓度在 $T_{\\max}$ 之前没有衰减到这个水平，我们取 $t_{\\frac{1}{2},s} = T_{\\max} - t_{\\mathrm{peak},s}^{\\mathrm{obs}}$。\n\n将低幅度、慢衰减信号与LTD关联的决策规则如下：\n- 当且仅当一个来源同时表现出比另一个来源严格更小的峰值（$C_{\\mathrm{peak}}$）和严格更长的半衰期（$t_{\\frac{1}{2}}$）时，才选择该来源。\n- 否则，选择具有更高LTD分数 $S_s = t_{\\frac{1}{2},s} / C_{\\mathrm{peak},s}$ 的来源。\n- 如果分数出现平局，即 $|S_{\\mathrm{N}} - S_{\\mathrm{V}}| \\le \\varepsilon$（其中容差 $\\varepsilon=10^{-9}$），则按惯例选择NMDAR来源。\n\n将实现一个程序来为四个指定的测试用例中的每一个执行此完整过程，并报告每个用例的最终确定性结果（NMDAR为 $1$，VGCC为 $0$）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'seed': 12345, 'sigma_jit': 2.0, 'CV_N': 0.2, 'CV_V': 0.2, \n         'A_N': 0.4, 'tau_r_N': 10.0, 'tau_d_N': 150.0,\n         'A_V': 1.0, 'tau_r_V': 1.0, 'tau_d_V': 25.0,\n         'dt': 0.1, 'T_max': 1000.0},\n        # Case B\n        {'seed': 24680, 'sigma_jit': 2.0, 'CV_N': 0.2, 'CV_V': 0.2,\n         'A_N': 0.8, 'tau_r_N': 10.0, 'tau_d_N': 150.0,\n         'A_V': 0.9, 'tau_r_V': 1.0, 'tau_d_V': 25.0,\n         'dt': 0.1, 'T_max': 1000.0},\n        # Case C\n        {'seed': 13579, 'sigma_jit': 3.0, 'CV_N': 0.25, 'CV_V': 0.25,\n         'A_N': 0.6, 'tau_r_N': 8.0, 'tau_d_N': 120.0,\n         'A_V': 0.25, 'tau_r_V': 1.0, 'tau_d_V': 200.0,\n         'dt': 0.1, 'T_max': 1200.0},\n        # Case D\n        {'seed': 777, 'sigma_jit': 0.0, 'CV_N': 0.0, 'CV_V': 0.0,\n         'A_N': 0.5, 'tau_r_N': 5.0, 'tau_d_N': 150.0,\n         'A_V': 0.5, 'tau_r_V': 5.0, 'tau_d_V': 150.0,\n         'dt': 0.1, 'T_max': 1000.0}\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = _solve_single_case(case_params)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _solve_single_case(params):\n    \"\"\"\n    Solves for a single test case configuration.\n    \"\"\"\n    # Initialize RNG and simulation parameters\n    rng = np.random.default_rng(params['seed'])\n    time_vec = np.arange(0, params['T_max'] + params['dt'], params['dt'])\n    num_spikes = 5\n    \n    # Generate spike times with jitter, then sort\n    nominal_times = np.arange(num_spikes) * 50.0\n    jitter = rng.normal(loc=0.0, scale=params['sigma_jit'], size=num_spikes)\n    spike_times = np.sort(nominal_times + jitter)\n    \n    source_metrics = {}\n    \n    source_configs = {\n        'N': {'A': params['A_N'], 'CV': params['CV_N'], 'tau_r': params['tau_r_N'], 'tau_d': params['tau_d_N']},\n        'V': {'A': params['A_V'], 'CV': params['CV_V'], 'tau_r': params['tau_r_V'], 'tau_d': params['tau_d_V']}\n    }\n\n    for s_name, s_config in source_configs.items():\n        A = s_config['A']\n        CV = s_config['CV']\n        tau_r = s_config['tau_r']\n        tau_d = s_config['tau_d']\n\n        # Generate lognormal amplitude weights\n        if CV > 0:\n            sigma_sq = np.log(1 + CV**2)\n            mu = -sigma_sq / 2.0\n            weights = rng.lognormal(mean=mu, sigma=np.sqrt(sigma_sq), size=num_spikes)\n        else:\n            weights = np.ones(num_spikes)\n\n        # Define and normalize the bi-exponential kernel\n        # An unnormalized kernel h(t) = exp(-t/tau_d) - exp(-t/tau_r) is used.\n        # Its peak time and max value are calculated for normalization.\n        t_peak_kernel = (tau_d * tau_r) / (tau_d - tau_r) * np.log(tau_d / tau_r)\n        H_max = np.exp(-t_peak_kernel/tau_d) - np.exp(-t_peak_kernel/tau_r)\n        \n        # H_max should be > 0 given tau_d > tau_r > 0\n        norm_factor = 1.0 / H_max if H_max > 0 else 0.0\n\n        def h_tilde_func(t):\n            # The normalized kernel function for a vector of time points t.\n            # It is zero for t  0.\n            res = np.zeros_like(t, dtype=float)\n            positive_t_mask = t >= 0\n            t_pos = t[positive_t_mask]\n            res[positive_t_mask] = (np.exp(-t_pos / tau_d) - np.exp(-t_pos / tau_r)) * norm_factor\n            return res\n        \n        # Pre-calculate the normalized kernel on the time grid for efficiency\n        norm_kernel_on_grid = h_tilde_func(time_vec)\n\n        # Superposition: Sum the contributions of all spikes.\n        # We implement this via a computationally efficient shift-and-add of the \n        # pre-calculated kernel, a standard discrete approximation of convolution.\n        total_ca_trace = np.zeros_like(time_vec)\n        for i in range(num_spikes):\n            t_spike = spike_times[i]\n            # Approximate spike time to the nearest grid point\n            start_idx = int(np.round(t_spike / params['dt']))\n            \n            if start_idx  0: start_idx = 0\n            if start_idx >= len(time_vec): continue\n            \n            len_to_add = len(time_vec) - start_idx\n            total_ca_trace[start_idx:] += A * weights[i] * norm_kernel_on_grid[:len_to_add]\n\n        # Calculate metrics: peak and half-decay time\n        C_peak = np.max(total_ca_trace)\n        peak_idx = np.argmax(total_ca_trace)\n        half_peak_val = 0.5 * C_peak\n\n        post_peak_trace = total_ca_trace[peak_idx:]\n        indices_below_half = np.where(post_peak_trace = half_peak_val)[0]\n        \n        if len(indices_below_half) > 0:\n            first_idx_below = indices_below_half[0]\n            t_half_decay = first_idx_below * params['dt']\n        else:\n            t_peak_obs = peak_idx * params['dt']\n            t_half_decay = params['T_max'] - t_peak_obs\n        \n        source_metrics[s_name] = {'peak': C_peak, 'half_decay': t_half_decay}\n\n    # Apply the decision rule\n    C_peak_N = source_metrics['N']['peak']\n    t_half_N = source_metrics['N']['half_decay']\n    C_peak_V = source_metrics['V']['peak']\n    t_half_V = source_metrics['V']['half_decay']\n    \n    is_N_ltd_candidate = (C_peak_N  C_peak_V) and (t_half_N > t_half_V)\n    is_V_ltd_candidate = (C_peak_V  C_peak_N) and (t_half_V > t_half_N)\n\n    if is_N_ltd_candidate:\n        return 1\n    elif is_V_ltd_candidate:\n        return 0\n    else:\n        # Use LTD score as fallback\n        S_N = t_half_N / C_peak_N if C_peak_N > 1e-12 else 0.0\n        S_V = t_half_V / C_peak_V if C_peak_V > 1e-12 else 0.0\n        \n        if np.abs(S_N - S_V) = 1e-9:\n            return 1  # Tie-break to NMDAR\n        elif S_N > S_V:\n            return 1\n        else:\n            return 0\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2722045"}, {"introduction": "在模拟了初始的$\\mathrm{Ca}^{2+}$信号之后，我们接着探讨下游分子机器如何“解读”这一信号。这个思想实验 [@problem_id:2722030] 要求你预测快速$\\mathrm{Ca}^{2+}$螯合剂（BAPTA）对两种不同LTD通路——NMDAR依赖性LTD和mGluR依赖性LTD——的影响。这项练习旨在磨练你对$\\mathrm{Ca}^{2+}$微域以及不同信号级联通路对$\\mathrm{Ca}^{2+}$敏感性差异的推理能力。", "problem": "从一个海马区CA1锥体神经元获得全细胞膜片钳记录。内液含有10 mM的1,2-bis(o-aminophenoxy)ethane-N,N,N',N'-tetraacetic acid (BAPTA)，这是一种快速、高亲和力的$\\mathrm{Ca^{2+}}$螯合剂。在同一细胞中通过独立的实验施加两种标准的长时程抑制(LTD)诱导方案：(i) 低频突触刺激，通常产生N-甲基-D-天冬氨酸受体(NMDAR)依赖性LTD (NMDAR-LTD)，以及 (ii) 短暂浴施I型激动剂以激活I型代谢型谷氨酸受体(mGluR1/5)，通常产生mGluR依赖性LTD (mGluR-LTD)。请您预测10 mM BAPTA对每种LTD形式的定性效应，并基于门控诱导的初始酶对$\\mathrm{Ca^{2+}}$的空间和时间需求，从第一性原理出发论证您的答案。\n\n使用以下基本原理：(a) 反应-扩散和结合：胞质$\\mathrm{Ca^{2+}}$遵循方程$d[\\mathrm{Ca^{2+}}]/dt = J_{\\mathrm{in}} - k_{\\mathrm{on}}[\\mathrm{B}]_{\\mathrm{free}}[\\mathrm{Ca^{2+}}] + k_{\\mathrm{off}}[\\mathrm{CaB}] - J_{\\mathrm{removal}}$，其中$[\\mathrm{B}]$是缓冲剂（此处为BAPTA），$k_{\\mathrm{on}}$是结合速率常数，$k_{\\mathrm{off}}$是解离速率常数；快速、高$k_{\\mathrm{on}}$的缓冲剂会降低游离$\\mathrm{Ca^{2+}}$的幅度和扩散范围。(b) CA1区NMDAR-LTD的诱导需要突触后激活钙调蛋白(calmodulin, CaM)和蛋白磷酸酶2B (PP2B, calcineurin)，进而导致蛋白磷酸酶1 (PP1)的招募。(c) I型mGluRs是Gq蛋白偶联的，能激活磷脂酶Cβ (PLC$\\beta$)，增加1,4,5-三磷酸肌醇 (IP$_3$)和二酰甘油(DAG)，并能在不需要大幅度突触后$\\mathrm{Ca^{2+}}$升高的情况下，驱动一种突触后、蛋白质合成依赖性的LTD。\n\n哪个选项最能预测结果，并提供了基于空间微区需求的、与机制一致的论证？\n\nA. 10 mM BAPTA消除NMDAR-LTD但保留mGluR-LTD；快速缓冲作用破坏了激活NMDAR-LTD所需的CaM/PP2B所必需的弥散、遍布棘头的$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD的起始主要通过G蛋白–PLC信号通路和局部翻译进行，对胞质$\\mathrm{Ca^{2+}}$升高的依赖性极小。\n\nB. 10 mM BAPTA阻断mGluR-LTD而非NMDAR-LTD；NMDAR-LTD依赖于与NMDAR孔道紧密耦合且对缓冲作用有抵抗力的纳米域$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD需要BAPTA所抑制的弥散性$\\mathrm{Ca^{2+}}$升高。\n\nC. 10 mM BAPTA通过降低$\\mathrm{Ca^{2+}}$以利于磷酸酶而非激酶的激活来增强NMDAR-LTD，并且对mGluR-LTD没有影响；降低的$\\mathrm{Ca^{2+}}$水平选择性地使信号通路偏向抑制。\n\nD. NMDAR-LTD和mGluR-LTD均被10 mM BAPTA消除；CA1区所有的LTD诱导机制都需要胞质$\\mathrm{Ca^{2+}}$的大幅增加，而这种增加被快速缓冲作用所阻止。\n\nE. NMDAR-LTD不受影响，而mGluR-LTD被10 mM BAPTA增强；螯合作用解除了$\\mathrm{Ca^{2+}}$对IP$_3$受体的自抑制，从而促进mGluR-LTD，同时保持NMDAR驱动的LTD完整。", "solution": "问题陈述经过验证。\n\n**步骤1：提取已知条件**\n- **实验：** 对海马区CA1锥体神经元进行全细胞膜片钳记录。\n- **内液：** 含有10 mM的1,2-bis(o-aminophenoxy)ethane-N,N,N',N'-tetraacetic acid (BAPTA)，一种快速、高亲和力的$\\mathrm{Ca^{2+}}$螯合剂。\n- **方案(i)：** 低频突触刺激以诱导N-甲基-D-天冬氨酸受体(NMDAR)依赖性长时程抑制(NMDAR-LTD)。\n- **方案(ii)：** 短暂浴施I型激动剂以激活I型代谢型谷氨酸受体(mGluR1/5)，诱导mGluR依赖性LTD (mGluR-LTD)。\n- **问题：** 根据初始诱导酶对$\\mathrm{Ca^{2+}}$的空间和时间需求，预测10 mM BAPTA对每种LTD形式的影响。\n- **基本原理(a)：** 胞质$\\mathrm{Ca^{2+}}$动力学由反应-扩散方程描述：$d[\\mathrm{Ca^{2+}}]/dt = J_{\\mathrm{in}} - k_{\\mathrm{on}}[\\mathrm{B}]_{\\mathrm{free}}[\\mathrm{Ca^{2+}}] + k_{\\mathrm{off}}[\\mathrm{CaB}] - J_{\\mathrm{removal}}$。像BAPTA这样快速、高$k_{\\mathrm{on}}$的缓冲剂会降低游离$\\mathrm{Ca^{2+}}$的幅度和空间扩散。\n- **基本原理(b)：** CA1区NMDAR-LTD的诱导需要突触后激活钙调蛋白(CaM)和蛋白磷酸酶2B (PP2B, calcineurin)，后者随后招募蛋白磷酸酶1 (PP1)。\n- **基本原理(c)：** I型mGluRs是Gq蛋白偶联的，能激活磷脂酶Cβ (PLC$\\beta$)，并增加1,4,5-三磷酸肌醇 (IP$_3$)和二酰甘油(DAG)。这可以在不需要大幅度突触后$\\mathrm{Ca^{2+}}$升高的情况下，驱动一种蛋白质合成依赖性的LTD。\n\n**步骤2：使用提取的已知条件进行验证**\n对问题进行有效性评估。\n- **科学依据：** 该问题牢固地植根于细胞和分子神经科学的既定原则。所描述的实验设置、方案、分子通路（NMDAR-LTD和mGluR-LTD）以及BAPTA的作用都是该主题的标准且事实正确的表述。\n- **适定性：** 该问题提供了一个清晰的实验场景和一套基本原理。它要求基于这些原理进行具体预测，从而得出一个唯一的、合理的解决方案。\n- **客观性：** 语言技术性强、精确，没有主观或含糊的术语。\n- **结论：** 问题陈述在科学上是合理的、适定的、客观的、自洽的且非平凡的。它没有违反任何无效标准。\n\n**步骤3：裁决与行动**\n问题是**有效的**。可以推导出严谨的解决方案。\n\n**求解过程**\n\n目标是预测高浓度(10 mM)的快速$\\mathrm{Ca^{2+}}$螯合剂BAPTA对两种不同形式的LTD（NMDAR-LTD和mGluR-LTD）的影响。分析必须基于所提供的第一性原理，特别是对$\\mathrm{Ca^{2+}}$信号的不同需求。\n\n**1. NMDAR-LTD分析**\n\nNMDAR-LTD由低频刺激诱导，这会引起$\\mathrm{Ca^{2+}}$通过NMDAR通道适度但持久地流入突触后棘。根据原理(b)，NMDAR-LTD的诱导由$\\mathrm{Ca^{2+}}$依赖性酶钙调蛋白(CaM)和蛋白磷酸酶2B (PP2B, 或称calcineurin)的激活所门控。这些酶，特别是PP2B，需要胞质$\\mathrm{Ca^{2+}}$持续升高到几百纳摩尔至低微摩尔的水平。这个$\\mathrm{Ca^{2+}}$信号必须在空间上分布于棘细胞质的很大一部分，才能有效启动磷酸酶级联反应。它不是一个高度局域化的“纳米域”信号，而是一个更弥散的“微域”信号。\n\n已知内液含有10 mM BAPTA，这是一个非常高的浓度。原理(a)规定了这种缓冲剂如何影响$\\mathrm{Ca^{2+}}$动力学。作为一种高浓度存在的快速（$k_{\\mathrm{on}}$大）、高亲和力（$K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}}$小）螯合剂，BAPTA会迅速结合任何进入棘的游离$\\mathrm{Ca^{2+}}$离子。高浓度的缓冲剂确保了一个巨大的$\\mathrm{Ca^{2+}}$汇，有效防止游离胞质$\\mathrm{Ca^{2+}}$浓度显著高于静息水平，并使其空间扩散崩溃。因此，激活CaM和PP2B所需的弥散、遍布棘头的$\\mathrm{Ca^{2+}}$信号将无法建立。没有这个磷酸酶级联反应的激活，导致LTD的下游事件就不会发生。\n\n因此，预测10 mM BAPTA会消除NMDAR-LTD。\n\n**2. mGluR-LTD分析**\n\nmGluR-LTD由Gq偶联的I型mGluRs的激活诱导。根据原理(c)，这种激活通过PLC$\\beta$启动一个信号级联，导致第二信使$\\mathrm{IP_3}$和DAG的产生。该原理明确指出，这条通路驱动一种蛋白质合成依赖性的LTD，并且*不*需要*大幅度*的突触后$\\mathrm{Ca^{2+}}$升高。\n\n主要的信号机制是化学性的，而非离子性的。关键的效应器位于PLC$\\beta$的下游。例如，DAG激活蛋白激酶C (PKC)，整个通路触发快速的局部蛋白质合成，这是这种LTD形式的一个标志。虽然$\\mathrm{IP_3}$可以作用于内质网上的$\\mathrm{IP_3}$受体以释放$\\mathrm{Ca^{2+}}$，但原理(c)强调，胞质$\\mathrm{Ca^{2+}}$的大幅增加不是诱导mGluR-LTD的先决条件。核心机制可以通过G蛋白/PLC$\\beta$/DAG/PKC/蛋白质合成轴进行。\n\n在10 mM BAPTA存在下，任何从内部储存释放的$\\mathrm{Ca^{2+}}$都会被迅速螯合。然而，由于诱导机制并非严重依赖于这种$\\mathrm{Ca^{2+}}$升高，BAPTA对其的缓冲作用不应阻止LTD的发生。主要的G蛋白信号通路保持完整。\n\n因此，预测10 mM BAPTA会保留（即不阻断）mGluR-LTD。\n\n**综合分析：**\n分析表明，NMDAR-LTD将被消除，因为它严格依赖于一个弥散的胞质$\\mathrm{Ca^{2+}}$信号，而该信号被BAPTA抑制。相比之下，mGluR-LTD将被保留，因为其主要诱导机制是一个G蛋白偶联通路，不需要胞质$\\mathrm{Ca^{2+}}$的大幅升高。\n\n**选项评估**\n\n**A. 10 mM BAPTA消除NMDAR-LTD但保留mGluR-LTD；快速缓冲作用破坏了激活NMDAR-LTD所需的CaM/PP2B所必需的弥散、遍布棘头的$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD的起始主要通过G蛋白–PLC信号通路和局部翻译进行，对胞质$\\mathrm{Ca^{2+}}$升高的依赖性极小。**\n该陈述与推导出的结论完全一致。它正确预测了两种LTD形式的不同结果，并基于所提供的原理给出了正确的生物物理和生物化学推理。对NMDAR-LTD的弥散$\\mathrm{Ca^{2+}}$信号敏感性与mGluR-LTD以G蛋白为中心的机制之间的区别被准确地捕捉到。**正确**。\n\n**B. 10 mM BAPTA阻断mGluR-LTD而非NMDAR-LTD；NMDAR-LTD依赖于与NMDAR孔道紧密耦合且对缓冲作用有抵抗力的纳米域$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD需要BAPTA所抑制的弥散性$\\mathrm{Ca^{2+}}$升高。**\n这个陈述是不正确的。它颠倒了两种通路的$\\mathrm{Ca^{2+}}$依赖性。NMDAR-LTD所需的持久而适度的$\\mathrm{Ca^{2+}}$信号容易受到高浓度快速缓冲剂的影响。断言该信号是一个对缓冲有抵抗力的“纳米域”信号，通常与非常靠近通道孔的传感器相关，例如用于LTP的传感器，而不是用于LTD的磷酸酶激活。它还错误地假设mGluR-LTD需要强烈的$\\mathrm{Ca^{2+}}$信号，这与原理(c)相悖。**不正确**。\n\n**C. 10 mM BAPTA通过降低$\\mathrm{Ca^{2+}}$以利于磷酸酶而非激酶的激活来增强NMDAR-LTD，并且对mGluR-LTD没有影响；降低的$\\mathrm{Ca^{2+}}$水平选择性地使信号通路偏向抑制。**\n这个陈述是不正确的。虽然较低的$\\mathrm{Ca^{2+}}$水平确实比激酶更有利于磷酸酶（Bienenstock-Cooper-Munro或“BCM”理论），但10 mM BAPTA的浓度不会简单地将信号“降低”到LTD的最佳范围。它会将$\\mathrm{Ca^{2+}}$浓度钳制在静息水平附近，从而完全消除磷酸酶激活所需的信号。在这种情况下，缓冲不是增强，而是消除。**不正确**。\n\n**D. NMDAR-LTD和mGluR-LTD均被10 mM BAPTA消除；CA1区所有的LTD诱导机制都需要胞质$\\mathrm{Ca^{2+}}$的大幅增加，而这种增加被快速缓冲作用所阻止。**\n这个陈述是不正确的。断言*所有*LTD机制都需要$\\mathrm{Ca^{2+}}$的大幅增加是一个错误的概括。它直接与原理(c)相矛盾，该原理指出mGluR-LTD可以在没有大幅度突触后$\\mathrm{Ca^{2+}}$升高的情况下进行。因此，虽然它正确预测了NMDAR-LTD的阻断，但它对mGluR-LTD的判断是错误的。**不正确**。\n\n**E. NMDAR-LTD不受影响，而mGluR-LTD被10 mM BAPTA增强；螯合作用解除了$\\mathrm{Ca^{2+}}$对IP$_3$受体的自抑制，从而促进mGluR-LTD，同时保持NMDAR驱动的LTD完整。**\n这个陈述是不正确的。它错误地声称NMDAR-LTD不受影响；根据推导，它对BAPTA高度敏感。提出的增强mGluR-LTD的机制（解除$\\mathrm{IP_3}$R的自抑制）是一个真实但次要的效应；它不代表主要结果，更重要的是，关于NMDAR-LTD的前提是根本错误的。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2722030"}, {"introduction": "本章的最后一个练习将聚焦于LTD的最终表达机制：AMPA受体的移除。这项练习 [@problem_id:2722066] 使用一个简洁而强大的双室模型，将生物化学信号（表现为内吞速率的增加）与突触强度的可量化变化（表面受体的数量）联系起来。通过计算新的稳态，你将对LTD如何在突触水平上被物理实现有一个具体的理解。", "problem": "兴奋性突触中长时程抑制 (LTD) 的一个典型机制是，在表达的时间窗口内，从突触后膜上 α-氨基-3-羟基-5-甲基-4-异恶唑丙酸 (AMPA) 受体的网格蛋白介导的内吞作用持续增加，而胞吐作用相对不变。考虑一个 AMPA 型谷氨酸受体的双室运输模型，该模型包含一个表面受体池 $R_{s}(t)$ 和一个内部池 $R_{i}(t)$，并假设在相关的时间尺度上受体总数 $R_{T}$ 是守恒的。表面池的动力学由质量作用平衡给出\n$$\n\\frac{dR_{s}}{dt} \\;=\\; k_{\\mathrm{exo}}\\,R_{i} \\;-\\; k_{\\mathrm{endo}}\\,R_{s},\n$$\n其中 $k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$ 分别是胞吐作用和内吞作用的速率常数。在 LTD 诱导后，内吞速率从 $k_{\\mathrm{endo}}=0.01\\,\\mathrm{s^{-1}}$ 翻倍至 $k_{\\mathrm{endo}}=0.02\\,\\mathrm{s^{-1}}$，而胞吐速率保持为 $k_{\\mathrm{exo}}=0.005\\,\\mathrm{s^{-1}}$。受体总数为 $R_{T}=1000$。\n\n仅使用受体总数守恒和 $R_{s}$ 的稳态通量平衡条件，推导出稳态表面受体数 $R_{s}^{*}$ 关于 $R_{T}$、$k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$ 的表达式，然后计算 LTD 后的新稳态值。将最终答案以单个数字的形式报告（无单位）。无需进行四舍五入。", "solution": "在尝试求解之前，将首先对问题进行严格的验证。\n\n给定条件逐字摘录自问题陈述：\n- 系统是一个双室模型，包含一个表面受体池 $R_{s}(t)$ 和一个内部池 $R_{i}(t)$。\n- 受体总数 $R_{T}$ 是守恒的：$R_{T} = R_{s}(t) + R_{i}(t)$。\n- 表面池的动力学由微分方程控制：$\\frac{dR_{s}}{dt} = k_{\\mathrm{exo}}\\,R_{i} - k_{\\mathrm{endo}}\\,R_{s}$。\n- 胞吐速率常数为 $k_{\\mathrm{exo}}=0.005\\,\\mathrm{s^{-1}}$。\n- LTD 诱导后，内吞速率常数为 $k_{\\mathrm{endo}}=0.02\\,\\mathrm{s^{-1}}$。\n- 受体总数为 $R_{T}=1000$。\n\n该问题被评估为有效。它具有科学依据，采用了一个基于质量作用动力学的 AMPA 受体运输的标准且广为接受的简化模型。该问题是适定的，因为其控制方程是一个具有唯一稳定稳态解的常系数线性常微分方程。该问题是客观的，并为求得唯一解提供了所有必要数据，不包含任何矛盾、事实错误或歧义。\n\n目标是首先推导出稳态时表面受体数量 $R_{s}^{*}$ 关于 $R_{T}$、$k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$ 的通用代数表达式。然后，将使用此表达式计算长时程抑制 (LTD) 诱导后 $R_{s}^{*}$ 的具体值。\n\n在稳态下，表面受体的数量是恒定的，这意味着其时间导数为零：\n$$\n\\frac{dR_{s}}{dt} = 0\n$$\n将此条件应用于控制微分方程，得到通量平衡方程，该方程表明胞吐速率等于内吞速率：\n$$\nk_{\\mathrm{exo}}\\,R_{i}^{*} = k_{\\mathrm{endo}}\\,R_{s}^{*}\n$$\n此处，$R_{s}^{*}$ 和 $R_{i}^{*}$ 分别代表稳态时表面池和内部池中的受体数量。\n\n第二个控制原理是受体总数守恒，即 $R_{T}$：\n$$\nR_{T} = R_{s}^{*} + R_{i}^{*}\n$$\n我们可以用总受体数和表面受体数来表示内部受体数 $R_{i}^{*}$：\n$$\nR_{i}^{*} = R_{T} - R_{s}^{*}\n$$\n现在，将 $R_{i}^{*}$ 的这个表达式代入通量平衡方程。这使我们能够构建一个仅包含 $R_{s}^{*}$ 和系统参数的方程。\n$$\nk_{\\mathrm{exo}}(R_{T} - R_{s}^{*}) = k_{\\mathrm{endo}}\\,R_{s}^{*}\n$$\n我们接下来求解这个关于 $R_{s}^{*}$ 的线性代数方程。首先，展开 $k_{\\mathrm{exo}}$ 项：\n$$\nk_{\\mathrm{exo}}R_{T} - k_{\\mathrm{exo}}R_{s}^{*} = k_{\\mathrm{endo}}\\,R_{s}^{*}\n$$\n接下来，将所有包含 $R_{s}^{*}$ 的项移到方程的一边：\n$$\nk_{\\mathrm{exo}}R_{T} = k_{\\mathrm{endo}}R_{s}^{*} + k_{\\mathrm{exo}}R_{s}^{*}\n$$\n提取公因式 $R_{s}^{*}$：\n$$\nk_{\\mathrm{exo}}R_{T} = (k_{\\mathrm{exo}} + k_{\\mathrm{endo}})R_{s}^{*}\n$$\n最后，通过分离 $R_{s}^{*}$，我们得到了稳态表面受体数的通用表达式：\n$$\nR_{s}^{*} = \\frac{k_{\\mathrm{exo}}R_{T}}{k_{\\mathrm{exo}} + k_{\\mathrm{endo}}}\n$$\n问题的推导部分至此完成。\n\n现在，我们必须使用提供的数值计算 LTD 诱导后 $R_{s}^{*}$ 的新稳态值：\n- $R_{T} = 1000$\n- $k_{\\mathrm{exo}} = 0.005\\,\\mathrm{s^{-1}}$\n- $k_{\\mathrm{endo}} = 0.02\\,\\mathrm{s^{-1}}$\n\n将这些值代入我们推导出的表达式中：\n$$\nR_{s}^{*} = \\frac{(0.005)(1000)}{0.005 + 0.02}\n$$\n进行算术运算：\n$$\nR_{s}^{*} = \\frac{5}{0.025}\n$$\n为化简分数，我们可以将分子和分母同乘以 $1000$：\n$$\nR_{s}^{*} = \\frac{5000}{25}\n$$\n化简后得到：\n$$\nR_{s}^{*} = 200\n$$\n因此，在内吞速率翻倍后，系统达到一个新的稳态，此时突触后表面有 $200$ 个受体。", "answer": "$$\n\\boxed{200}\n$$", "id": "2722066"}]}