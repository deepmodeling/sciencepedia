{"hands_on_practices": [{"introduction": "在神经科学研究中，根据基因表达数据对神经元进行分类是一项核心任务。本练习 ([@problem_id:2705534]) 将引导您应用贝叶斯决策理论这一统计分类的基石，来解决一个典型的神经元分类问题。通过从第一性原理出发，推导高斯数据模型下的最优线性分类器，您将深入理解统计模型如何将生物学测量数据转化为分类规则，并学会量化分类器所能达到的最佳性能。", "problem": "一个实验室正在使用四个基因（Slc17a7、Gad1、Gad2 和 Slc32a1）的单细胞信使核糖核酸（mRNA）表达，构建一个分类器来区分谷氨酸能神经元和γ-氨基丁酸（GABA）能神经元。每个基因报告的测量值是其标准化表达水平的自然对数。基于质量控制的单细胞数据，一个神经元的对数表达向量 $x \\in \\mathbb{R}^{4}$ 被建模为条件多元正态分布，具有类条件均值和共享的对角协方差矩阵，如下所示：\n- 如果神经元是谷氨酸能的，则 $x \\sim \\mathcal{N}(\\mu_{\\mathrm{Glu}}, \\Sigma)$，其中 $\\mu_{\\mathrm{Glu}} = (\\,2.5,\\ 0.5,\\ 0.6,\\ 0.4\\,)$ 且 $\\Sigma = \\mathrm{diag}(\\,0.81,\\ 0.81,\\ 0.81,\\ 0.81\\,)$。\n- 如果神经元是GABA能的，则 $x \\sim \\mathcal{N}(\\mu_{\\mathrm{GABA}}, \\Sigma)$，其中 $\\mu_{\\mathrm{GABA}} = (\\,0.1,\\ 1.8,\\ 1.7,\\ 1.6\\,)$ 且 $\\Sigma$ 与上述相同。\n\n独立的批量核糖核酸测序（RNA-seq）表明，在采样的神经元群体中，谷氨酸能神经元占比例 $\\pi_{\\mathrm{Glu}} = 0.7$，而GABA能神经元占比例 $\\pi_{\\mathrm{GABA}} = 0.3$。假设：\n- 在给定类别的情况下，四个基因的对数表达服从具有上述参数的联合高斯分布。\n- 目标是最小化期望的 $0$–$1$ 错分损失，即在给定的类先验下，最小化总错分概率。\n\n任务：\n1) 从贝叶斯决策规则（选择后验概率最大的类别）的定义和多元正态密度的形式出发，推导出最小化期望错分的显式最优线性决策函数。将其写成 $g(x) = w^{\\top} x + b$ 的形式，并用 $\\mu_{\\mathrm{Glu}}$、$\\mu_{\\mathrm{GABA}}$、$\\Sigma$ 以及 $\\pi_{\\mathrm{Glu}}$、$\\pi_{\\mathrm{GABA}}$ 来指定 $w$ 和 $b$。\n2) 使用相同的概率模型和您推导出的规则，计算最小化期望总错分率（$0$–$1$ 损失下的贝叶斯风险），结果为一个实数。\n\n将最小错分率的最终答案表示为不带百分号的小数，并四舍五入到四位有效数字。", "solution": "该问题具有科学依据，提法得当，并包含获得唯一解所需的所有信息。这是贝叶斯决策理论在具有高斯类条件密度的二元分类问题上的一个标准应用。\n\n设两个类别为谷氨酸能（$C_{\\mathrm{Glu}}$）和GABA能（$C_{\\mathrm{GABA}}$）。问题给出了类先验概率 $\\pi_{\\mathrm{Glu}} = 0.7$ 和 $\\pi_{\\mathrm{GABA}} = 0.3$。对于一个对数表达向量 $x \\in \\mathbb{R}^{4}$，其类条件概率密度由多元正态分布给出：\n$p(x|C_{\\mathrm{Glu}}) = \\mathcal{N}(x; \\mu_{\\mathrm{Glu}}, \\Sigma)$\n$p(x|C_{\\mathrm{GABA}}) = \\mathcal{N}(x; \\mu_{\\mathrm{GABA}}, \\Sigma)$\n且具有共享的协方差矩阵 $\\Sigma$。\n\n目标是最小化期望的 $0$–$1$ 错分损失。最优决策规则，即贝叶斯分类器，将向量 $x$ 划分到具有最大后验概率的类别。也就是说，如果 $P(C_{\\mathrm{Glu}}|x) > P(C_{\\mathrm{GABA}}|x)$，我们选择 $C_{\\mathrm{Glu}}$，否则选择 $C_{\\mathrm{GABA}}$。\n根据贝叶斯定理，后验概率为 $P(C_k|x) = \\frac{p(x|C_k)\\pi_k}{p(x)}$。由于分母 $p(x)$ 对两个类别是相同的，这等价于比较 $p(x|C_k)\\pi_k$ 的大小。使用对数更为方便，因此我们为每个类别 $k$ 定义对数判别函数：\n$$ \\delta_k(x) = \\ln[p(x|C_k)\\pi_k] = \\ln p(x|C_k) + \\ln \\pi_k $$\n决策规则是：如果 $\\delta_{\\mathrm{Glu}}(x) > \\delta_{\\mathrm{GABA}}(x)$，则将 $x$ 分类为 $C_{\\mathrm{Glu}}$。\n\n$d$ 维多元正态分布 $\\mathcal{N}(\\mu, \\Sigma)$ 的概率密度函数为：\n$$ p(x; \\mu, \\Sigma) = \\frac{1}{(2\\pi)^{d/2} |\\Sigma|^{1/2}} \\exp\\left(-\\frac{1}{2}(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu)\\right) $$\n该密度的自然对数为：\n$$ \\ln p(x; \\mu, \\Sigma) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\Sigma| - \\frac{1}{2}(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu) $$\n由于维度 $d=4$ 和协方差矩阵 $\\Sigma$ 对两个类别是相同的，因此在比较中可以忽略对两个类别都为常数的项 $-\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\Sigma|$。\n展开二次项：$(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu) = x^{\\top}\\Sigma^{-1}x - 2\\mu^{\\top}\\Sigma^{-1}x + \\mu^{\\top}\\Sigma^{-1}\\mu$。\n对数判别函数简化为：\n$$ \\delta_k(x) \\propto -\\frac{1}{2}(x^{\\top}\\Sigma^{-1}x - 2\\mu_k^{\\top}\\Sigma^{-1}x + \\mu_k^{\\top}\\Sigma^{-1}\\mu_k) + \\ln \\pi_k $$\n项 $-\\frac{1}{2}x^{\\top}\\Sigma^{-1}x$ 对两个类别也是公共的，将会抵消。因此，有效的判别函数是：\n$$ \\delta_k(x) = \\mu_k^{\\top}\\Sigma^{-1}x - \\frac{1}{2}\\mu_k^{\\top}\\Sigma^{-1}\\mu_k + \\ln \\pi_k $$\n\n任务1：推导线性决策函数 $g(x) = w^{\\top}x + b$。\n我们定义决策函数 $g(x) = \\delta_{\\mathrm{Glu}}(x) - \\delta_{\\mathrm{GABA}}(x)$。分类规则是：如果 $g(x) > 0$，选择 $C_{\\mathrm{Glu}}$；如果 $g(x)  0$，选择 $C_{\\mathrm{GABA}}$。\n$$ g(x) = \\left(\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}x - \\frac{1}{2}\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} + \\ln \\pi_{\\mathrm{Glu}}\\right) - \\left(\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}x - \\frac{1}{2}\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}} + \\ln \\pi_{\\mathrm{GABA}}\\right) $$\n$$ g(x) = (\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1} - \\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1})x - \\frac{1}{2}(\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}}) + (\\ln \\pi_{\\mathrm{Glu}} - \\ln \\pi_{\\mathrm{GABA}}) $$\n$$ g(x) = (\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})^{\\top}\\Sigma^{-1}x + \\left( -\\frac{1}{2}\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} + \\frac{1}{2}\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}} + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) \\right) $$\n这符合 $g(x) = w^{\\top}x + b$ 的形式，其中：\n$$ w = \\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}) $$\n$$ b = -\\frac{1}{2}\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} + \\frac{1}{2}\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}} + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) $$\n\n任务2：计算最小化错分率。\n总错误概率，即贝叶斯风险 $R^*$，由下式给出：\n$$ R^* = P(\\text{分类为GABA} | C_{\\mathrm{Glu}})\\pi_{\\mathrm{Glu}} + P(\\text{分类为Glu} | C_{\\mathrm{GABA}})\\pi_{\\mathrm{GABA}} $$\n$$ R^* = P(g(x)  0 | C_{\\mathrm{Glu}})\\pi_{\\mathrm{Glu}} + P(g(x) > 0 | C_{\\mathrm{GABA}})\\pi_{\\mathrm{GABA}} $$\n决策函数 $g(x)$ 是高斯随机向量 $x$ 的线性变换。因此，在给定类别的情况下，$g(x)$ 是一个服从正态分布的标量随机变量。我们必须求出其均值和方差。\n对于类别 $k$，其中 $x \\sim \\mathcal{N}(\\mu_k, \\Sigma)$，$g(x) = w^{\\top}x + b$ 的分布是 $\\mathcal{N}(E[g(x)|C_k], \\mathrm{Var}(g(x)|C_k))$。\n方差对两个类别是相同的：\n$$ \\mathrm{Var}(g(x)|C_k) = w^{\\top}\\Sigma w = (\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}))^{\\top}\\Sigma(\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})) = (\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})^{\\top}\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}) $$\n这是两个均值之间马氏距离的平方，记为 $\\Delta^2$。\n条件均值为：\n$$ E[g(x)|C_{\\mathrm{Glu}}] = w^{\\top}\\mu_{\\mathrm{Glu}} + b = \\frac{1}{2}\\Delta^2 + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) $$\n$$ E[g(x)|C_{\\mathrm{GABA}}] = w^{\\top}\\mu_{\\mathrm{GABA}} + b = -\\frac{1}{2}\\Delta^2 + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) $$\n设 $\\Phi(\\cdot)$ 为标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数（CDF）。错误概率为：\n$$ P(g(x)  0 | C_{\\mathrm{Glu}}) = \\Phi\\left(\\frac{0 - E[g(x)|C_{\\mathrm{Glu}}]}{\\sqrt{\\Delta^2}}\\right) = \\Phi\\left(-\\frac{\\Delta}{2} - \\frac{1}{\\Delta}\\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right)\\right) $$\n$$ P(g(x) > 0 | C_{\\mathrm{GABA}}) = 1 - \\Phi\\left(\\frac{0 - E[g(x)|C_{\\mathrm{GABA}}]}{\\sqrt{\\Delta^2}}\\right) = \\Phi\\left(\\frac{E[g(x)|C_{\\mathrm{GABA}}]}{\\Delta}\\right) = \\Phi\\left(-\\frac{\\Delta}{2} + \\frac{1}{\\Delta}\\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right)\\right) $$\n使用性质 $1-\\Phi(z) = \\Phi(-z)$，第二项也为 $P(g(x) > 0 | C_{\\mathrm{GABA}}) = \\Phi\\left(-\\frac{\\Delta}{2} + \\frac{1}{\\Delta}\\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right)\\right)$。\n\n现在，我们代入给定的数值：\n$\\mu_{\\mathrm{Glu}} = (2.5, 0.5, 0.6, 0.4)^{\\top}$\n$\\mu_{\\mathrm{GABA}} = (0.1, 1.8, 1.7, 1.6)^{\\top}$\n$\\Sigma = \\mathrm{diag}(0.81, 0.81, 0.81, 0.81) = 0.81 \\cdot I_4$，其中 $I_4$ 是 $4 \\times 4$ 的单位矩阵。\n因此，$\\Sigma^{-1} = \\frac{1}{0.81} I_4$。\n$\\pi_{\\mathrm{Glu}} = 0.7$，$\\pi_{\\mathrm{GABA}} = 0.3$。\n\n首先，计算均值之差：\n$$ \\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}} = (2.4, -1.3, -1.1, -1.2)^{\\top} $$\n接下来，计算马氏距离的平方 $\\Delta^2$：\n$$ \\Delta^2 = (\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})^{\\top}\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}) = \\frac{1}{0.81} ||\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}||_2^2 $$\n$$ ||\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}||_2^2 = (2.4)^2 + (-1.3)^2 + (-1.1)^2 + (-1.2)^2 = 5.76 + 1.69 + 1.21 + 1.44 = 10.1 $$\n$$ \\Delta^2 = \\frac{10.1}{0.81} \\approx 12.4691358 $$\n马氏距离为 $\\Delta = \\sqrt{\\frac{10.1}{0.81}} = \\frac{\\sqrt{10.1}}{0.9} \\approx 3.5311663$。\n\n接下来，计算对数先验比：\n$$ \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) = \\ln\\left(\\frac{0.7}{0.3}\\right) = \\ln\\left(\\frac{7}{3}\\right) \\approx 0.84729786 $$\n累积分布函数 $\\Phi$ 的自变量为：\n对于谷氨酸能神经元的错误项：\n$$ A_{\\mathrm{Glu}} = -\\frac{\\Delta}{2} - \\frac{1}{\\Delta}\\ln\\left(\\frac{7}{3}\\right) \\approx -\\frac{3.5311663}{2} - \\frac{0.84729786}{3.5311663} \\approx -1.7655831 - 0.2399479 \\approx -2.005531 $$\n对于GABA能神经元的错误项：\n$$ A_{\\mathrm{GABA}} = -\\frac{\\Delta}{2} + \\frac{1}{\\Delta}\\ln\\left(\\frac{7}{3}\\right) \\approx -1.7655831 + 0.2399479 \\approx -1.5256352 $$\n总错误率为：\n$$ R^* = \\pi_{\\mathrm{Glu}} \\Phi(A_{\\mathrm{Glu}}) + \\pi_{\\mathrm{GABA}} \\Phi(A_{\\mathrm{GABA}}) $$\n$$ R^* \\approx (0.7) \\Phi(-2.005531) + (0.3) \\Phi(-1.5256352) $$\n使用标准正态CDF值：\n$\\Phi(-2.005531) \\approx 0.0224503$\n$\\Phi(-1.5256352) \\approx 0.0635418$\n$$ R^* \\approx (0.7)(0.0224503) + (0.3)(0.0635418) $$\n$$ R^* \\approx 0.01571521 + 0.01906254 = 0.03477775 $$\n四舍五入到四位有效数字，最小化错分率为 $0.03478$。", "answer": "$$\\boxed{0.03478}$$", "id": "2705534"}, {"introduction": "在掌握了分类器的理论基础后，本练习 ([@problem_id:2705477]) 将带您进入计算实践。您将亲手实现一个朴素贝叶斯分类器，该分类器能够整合先验知识（例如特定脑区中细胞类型的频率）和来自多个标记基因的证据。通过编写代码，您不仅能将抽象的贝叶斯公式转化为一个实用的工具，还将深刻体会到序贯更新的力量，以及先验知识在塑造我们对新数据解读中的关键作用。", "problem": "要求您形式化并实现一个用于神经递质身份的贝叶斯分类器，该分类器对标记信使核糖核酸（mRNA）读数使用区域特异性先验和基因特异性检测概率。该分类器必须对观测到的标记读数计数进行操作，并返回神经递质类别的后验概率。设定如下。\n\n考虑一个有限的神经递质类别集合 $\\mathcal{C} = \\{\\text{GLU}, \\text{GABA}, \\text{ACh}\\}$，分别代表谷氨酸能、γ-氨基丁酸（GABA）能和乙酰胆碱（ACh）能神经元。考虑一个有限的标记基因集合 $\\mathcal{G} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$。对于单个神经元，其解剖区域 $R \\in \\{\\text{Cortex}, \\text{Striatum}, \\text{BasalForebrain}\\}$ 是已知的。假设以下基础成立。\n\n- 贝叶斯法则：对于任意类别 $c \\in \\mathcal{C}$ 和观测向量 $o = (o_g)_{g \\in \\mathcal{G}}$，其中 $o_g \\in \\{0,1\\}$，以及一个区域 $r$，后验概率为\n$$\nP(C=c \\mid O=o, R=r) \\;=\\; \\frac{P(C=c \\mid R=r)\\,P(O=o \\mid C=c)}{\\sum_{c' \\in \\mathcal{C}} P(C=c' \\mid R=r)\\,P(O=o \\mid C=c')}.\n$$\n- 标记检测在给定类别下的条件独立性：对于 $o = (o_g)_{g \\in \\mathcal{G}}$，\n$$\nP(O=o \\mid C=c) \\;=\\; \\prod_{g \\in \\mathcal{G}_{\\text{measured}}} P(O_g = o_g \\mid C=c),\n$$\n其中 $\\mathcal{G}_{\\text{measured}} \\subseteq \\mathcal{G}$ 是实验中实际测量的标记子集。如果 $\\mathcal{G}_{\\text{measured}} = \\emptyset$，则对于所有 $c \\in \\mathcal{C}$，$P(O=o \\mid C=c) = 1$。\n- 每个测量标记 $g$ 的伯努利测量模型：对于类别 $c$，\n$$\nP(O_g = 1 \\mid C=c) = \\pi_{g,c}, \\qquad P(O_g = 0 \\mid C=c) = 1 - \\pi_{g,c},\n$$\n具有已知的检测概率 $\\pi_{g,c} \\in (0,1)$，该概率包含了真实表达、假阳性和脱落。\n\n区域特异性先验 $P(C=c \\mid R=r)$ 由矩阵 $\\rho_{c,r}$ 给出（每列按区域求和为 $1$）：\n- 对于 $\\text{Cortex}$：$\\rho_{\\text{GLU},\\text{Cortex}} = 0.7$, $\\rho_{\\text{GABA},\\text{Cortex}} = 0.29$, $\\rho_{\\text{ACh},\\text{Cortex}} = 0.01$。\n- 对于 $\\text{Striatum}$：$\\rho_{\\text{GLU},\\text{Striatum}} = 0.1$, $\\rho_{\\text{GABA},\\text{Striatum}} = 0.89$, $\\rho_{\\text{ACh},\\text{Striatum}} = 0.01$。\n- 对于 $\\text{BasalForebrain}$：$\\rho_{\\text{GLU},\\text{BasalForebrain}} = 0.15$, $\\rho_{\\text{GABA},\\text{BasalForebrain}} = 0.2$, $\\rho_{\\text{ACh},\\text{BasalForebrain}} = 0.65$。\n\n检测概率 $\\pi_{g,c}$ 是基因和类别特异性的，并且对所有区域都是固定的：\n- 对于 $\\text{SLC17A7}$：$\\pi_{\\text{SLC17A7},\\text{GLU}} = 0.85$, $\\pi_{\\text{SLC17A7},\\text{GABA}} = 0.05$, $\\pi_{\\text{SLC17A7},\\text{ACh}} = 0.05$。\n- 对于 $\\text{GAD1}$：$\\pi_{\\text{GAD1},\\text{GLU}} = 0.05$, $\\pi_{\\text{GAD1},\\text{GABA}} = 0.9$, $\\pi_{\\text{GAD1},\\text{ACh}} = 0.05$。\n- 对于 $\\text{CHAT}$：$\\pi_{\\text{CHAT},\\text{GLU}} = 0.05$, $\\pi_{\\text{CHAT},\\text{GABA}} = 0.05$, $\\pi_{\\text{CHAT},\\text{ACh}} = 0.8$。\n\n观测数据是每个测量基因 $g \\in \\mathcal{G}_{\\text{measured}}$ 的原始读数计数 $x_g \\in \\mathbb{N}_0$。通过固定阈值将计数转换为二元检测：\n$$\no_g = \\mathbf{1}[x_g \\ge 1],\n$$\n对于每个测量的基因 $g \\in \\mathcal{G}_{\\text{measured}}$。未测量的基因被排除在似然计算之外（即，不被视为 $0$）。\n\n您的任务是实现一个程序，该程序：\n1. 对每个测试用例，使用上述模型和参数计算后验向量 $\\big(P(C=\\text{GLU}\\mid O=o,R=r), P(C=\\text{GABA}\\mid O=o,R=r), P(C=\\text{ACh}\\mid O=o,R=r)\\big)$。\n2. 演示贝叶斯法则的序贯更新：给定在不相交的测量标记子集 $\\mathcal{G}^{(1)}$ 和 $\\mathcal{G}^{(2)}$ 上的分裂观测 $o^{(1)}$ 和 $o^{(2)}$，从先验开始，用 $o^{(1)}$ 更新以获得一个后验，然后再次用 $o^{(2)}$ 更新，并验证这在数值容差范围内等于直接从联合观测 $o = (o^{(1)}, o^{(2)})$ 计算出的后验。\n\n测试套件：\n- 情况 $1$（理想情况）：区域 $R = \\text{Cortex}$，测量标记 $\\mathcal{G}_{\\text{measured}} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{SLC17A7}} = 3$，$x_{\\text{GAD1}} = 0$，$x_{\\text{CHAT}} = 0$。\n- 情况 $2$（冲突的标记）：区域 $R = \\text{Striatum}$，$\\mathcal{G}_{\\text{measured}} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{SLC17A7}} = 1$，$x_{\\text{GAD1}} = 2$，$x_{\\text{CHAT}} = 0$。\n- 情况 $3$（稀有类别被强烈指示）：区域 $R = \\text{Cortex}$，$\\mathcal{G}_{\\text{measured}} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{SLC17A7}} = 0$，$x_{\\text{GAD1}} = 0$，$x_{\\text{CHAT}} = 4$。\n- 情况 $4$（无测量边界情况）：区域 $R = \\text{Striatum}$，$\\mathcal{G}_{\\text{measured}} = \\emptyset$（没有测量标记），未提供计数。这必须返回区域先验作为后验。\n- 情况 $5$（序贯更新等价性）：区域 $R = \\text{BasalForebrain}$。第一批 $\\mathcal{G}^{(1)} = \\{\\text{SLC17A7}\\}$，计数为 $x_{\\text{SLC17A7}} = 2$。第二批 $\\mathcal{G}^{(2)} = \\{\\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{GAD1}} = 0$，$x_{\\text{CHAT}} = 1$。通过返回一个布尔值，验证序贯更新的后验与在容差 $\\epsilon = 10^{-12}$ 内从联合观测 $\\mathcal{G}^{(1)} \\cup \\mathcal{G}^{(2)}$ 得到的后验相等。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于情况 $1$–$4$，返回一个包含三个浮点数的列表，对应于 $\\big(P(\\text{GLU}), P(\\text{GABA}), P(\\text{ACh})\\big)$，每个浮点数四舍五入到六位小数。对于情况 $5$，返回一个布尔值，指示序贯更新和联合更新是否在 $\\epsilon$ 范围内一致。\n- 因此，最终打印的输出应为单行，格式如下\n$[\\,[p_{1,\\text{GLU}},p_{1,\\text{GABA}},p_{1,\\text{ACh}}],\\,[p_{2,\\text{GLU}},p_{2,\\text{GABA}},p_{2,\\text{ACh}}],\\,[p_{3,\\text{GLU}},p_{3,\\text{GABA}},p_{3,\\text{ACh}}],\\,[p_{4,\\text{GLU}},p_{4,\\text{GABA}},p_{4,\\text{ACh}}],\\,\\text{True/False}\\,]$，其中所有浮点数都四舍五入到六位小数。", "solution": "问题陈述经过验证。\n\n**步骤1：提取给定信息**\n- **类别：** 一个神经递质类型集合 $\\mathcal{C} = \\{\\text{GLU}, \\text{GABA}, \\text{ACh}\\}$。\n- **基因：** 一个标记基因集合 $\\mathcal{G} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$。\n- **区域：** 一个解剖区域集合 $R \\in \\{\\text{Cortex}, \\text{Striatum}, \\text{BasalForebrain}\\}$。\n- **模型：** 一个贝叶斯分类器，其后验由贝叶斯法则给出：$P(C=c \\mid O=o, R=r) = \\frac{P(C=c \\mid R=r) P(O=o \\mid C=c)}{\\sum_{c' \\in \\mathcal{C}} P(C=c' \\mid R=r) P(O=o \\mid C=c')}$。\n- **似然：** 假设给定类别下，标记检测是条件独立的，$P(O=o \\mid C=c) = \\prod_{g \\in \\mathcal{G}_{\\text{measured}}} P(O_g = o_g \\mid C=c')$。对于 $\\mathcal{G}_{\\text{measured}} = \\emptyset$，似然定义为 $1$。\n- **观测模型：** 每个标记 $g$ 的伯努利模型：$P(O_g = 1 \\mid C=c) = \\pi_{g,c}$ 和 $P(O_g = 0 \\mid C=c) = 1 - \\pi_{g,c}$。二元观测 $o_g$ 通过阈值从原始读数计数 $x_g$ 导出：$o_g = \\mathbf{1}[x_g \\ge 1]$。\n- **先验：** 为类别 $c$ 和区域 $r$ 的所有组合提供了区域特异性先验 $P(C=c \\mid R=r) = \\rho_{c,r}$。每个区域的给定值正确地求和为 $1$。\n- **检测概率：** 为基因 $g$ 和类别 $c$ 的所有组合提供了类别和基因特异性检测概率 $\\pi_{g,c}$。所有值都在有效范围 $(0,1)$ 内。\n- **测试用例：** 提供了五个特定的测试用例，包含所有必要的输入（区域、测量的基因和计数），以及一个用例所需的验证。\n\n**步骤2：使用提取的给定信息进行验证**\n根据验证标准对问题进行评估。\n- **科学依据充分：** 该问题牢固地植根于统计推断（贝叶斯分类）和细胞神经科学的既定原则。使用标记基因（例如，$SLC17A7$ 用于谷氨酸能神经元，$GAD1$ 用于 GABA 能神经元）对神经元类型进行分类是一种标准且有效的方法。所用的模型，即朴素贝叶斯分类器，是此类任务的常见且合适的选择。参数虽然理想化，但具有生物学合理性。\n- **问题定义良好：** 该问题提供了一套完整的先验、一个完全指定的似然函数以及每个案例的数据。贝叶斯法则的结构确保可以计算出唯一且有意义的后验概率分布。分母（证据）保证非零，因为所有先验和条件概率都严格为正。\n- **客观性：** 语言正式、精确且完全客观。任务是基于给定模型和参数的数学计算。\n\n该问题没有验证清单中列出的任何缺陷。它不是不健全、不完整、矛盾、不切实际、定义不善或微不足道的。\n\n**步骤3：结论与行动**\n问题是**有效的**。将提供一个解决方案。\n\n**基于原理的解决方案**\n\n目标是计算单个神经元的神经递质类别集合 $\\mathcal{C}$ 上的后验概率分布，给定其解剖区域 $R=r$ 和一个从标记基因表达水平导出的观测向量 $O=o$。这是贝叶斯推斷中的一个经典问题。\n\n类别 $c \\in \\mathcal{C}$ 的后验概率由贝叶斯定理给出：\n$$\nP(C=c \\mid O=o, R=r) = \\frac{P(O=o \\mid C=c) \\, P(C=c \\mid R=r)}{P(O=o \\mid R=r)}\n$$\n项 $P(C=c \\mid R=r)$ 是在区域 $r$ 中观察到类别为 $c$ 的神经元的先验概率。这些值，表示为 $\\rho_{c,r}$，是已知的。\n\n项 $P(O=o \\mid C=c)$ 是在神经元属于类别 $c$ 的条件下，观测向量 $o$ 的似然。问题陈述，给定细胞类别，单个标记的检测是条件独立的。这将似然简化为对已测量基因 $g \\in \\mathcal{G}_{\\text{measured}}$ 的乘积：\n$$\nP(O=o \\mid C=c) = \\prod_{g \\in \\mathcal{G}_{\\text{measured}}} P(O_g = o_g \\mid C=c)\n$$\n观测值 $o_g$ 是二元的（$0$ 或 $1$），由原始计数 $x_g$ 通过规则 $o_g = \\mathbf{1}[x_g \\ge 1]$ 导出。单个二元观测 $o_g$ 的概率由伯努利模型给出：\n$$\nP(O_g=o_g \\mid C=c) = (\\pi_{g,c})^{o_g} (1 - \\pi_{g,c})^{1-o_g}\n$$\n其中 $\\pi_{g,c}$ 是在类别为 $c$ 的细胞中检测到基因 $g$（即 $o_g=1$）的概率。如果一个基因未被测量，它将从乘积中排除，这等效于其似然项为 $1$。如果没有测量基因（$\\mathcal{G}_{\\text{measured}} = \\emptyset$），则对于所有类别，总似然 $P(O=o \\mid C=c)$ 定义为 $1$，后验分布等于先验分布。\n\n分母 $P(O=o \\mid R=r)$ 是边际似然或证据。它通过对所有可能的类别求分子之和来计算，确保后验概率之和为 $1$：\n$$\nP(O=o \\mid R=r) = \\sum_{c' \\in \\mathcal{C}} P(O=o \\mid C=c') \\, P(C=c' \\mid R=r)\n$$\n在计算上，对于每个测试用例，步骤如下：\n$1$. 识别区域 $r$ 并检索相应的先验概率向量 $[P(C=\\text{GLU}|R=r), P(C=\\text{GABA}|R=r), P(C=\\text{ACh}|R=r)]$。\n$2$. 对于每个测量的基因 $g$，将计数 $x_g$ 转换为二元观测 $o_g$。\n$3$. 对于每个类别 $c \\in \\mathcal{C}$，通过将所有测量基因的单个条件概率 $P(O_g=o_g \\mid C=c)$ 相乘，计算总似然 $L_c = P(O=o \\mid C=c)$。这将得到一个似然向量 $[L_{\\text{GLU}}, L_{\\text{GABA}}, L_{\\text{ACh}}]$。\n$4$. 通过先验向量和似然向量的元素级乘法计算未归一化的后验。\n$5$. 通过将每个元素除以所有元素的总和来归一化该向量。结果是最终的后验概率向量。\n\n对于序贯更新验证（情况5），我们必须展示贝叶斯推断的一个基本属性。给定两个不相交的观测集 $o^{(1)}$ 和 $o^{(2)}$，后验可以序贯计算：\n$$\nP(C \\mid o^{(1)}, o^{(2)}, r) \\propto P(o^{(2)} \\mid C) \\, P(C \\mid o^{(1)}, r)\n$$\n这里，第一次更新的后验 $P(C \\mid o^{(1)}, r)$ 作为第二次更新的先验。由于观测的条件独立性，这等效于联合更新：\n$$\nP(C \\mid o^{(1)}, o^{(2)}, r) \\propto P(o^{(1)}, o^{(2)} \\mid C) \\, P(C \\mid r) = P(o^{(1)} \\mid C) \\, P(o^{(2)} \\mid C) \\, P(C \\mid r)\n$$\n实现将使用联合方法（一次性处理所有观测）和序贯方法（两次连续更新）来计算后验。将比较得到的后验向量是否近似相等，绝对容差为 $\\epsilon = 10^{-12}$，以确认它们的数学等价性。这证实了证据整合的顺序不影响最终的信念状态，这是相干推断的一个标志。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian neuron classification problem for the given test suite.\n    \"\"\"\n    \n    # --- Define model parameters ---\n    CLASSES = {'GLU': 0, 'GABA': 1, 'ACh': 2}\n    CLASS_NAMES = ['GLU', 'GABA', 'ACh']\n    GENES = {'SLC17A7': 0, 'GAD1': 1, 'CHAT': 2}\n    REGIONS = {'Cortex': 0, 'Striatum': 1, 'BasalForebrain': 2}\n\n    # Region-specific priors P(C=c | R=r), shape (n_classes, n_regions)\n    priors = np.array([\n        # Cortex, Striatum, BasalForebrain\n        [0.70,   0.10,     0.15],  # GLU\n        [0.29,   0.89,     0.20],  # GABA\n        [0.01,   0.01,     0.65],  # ACh\n    ])\n\n    # Detection probabilities P(O_g=1 | C=c), shape (n_genes, n_classes)\n    pis = np.array([\n        # GLU,  GABA, ACh\n        [0.85, 0.05, 0.05],  # SLC17A7\n        [0.05, 0.90, 0.05],  # GAD1\n        [0.05, 0.05, 0.80],  # CHAT\n    ])\n\n    def calculate_posterior(region_name, observations, initial_prior=None):\n        \"\"\"\n        Calculates the posterior probability vector.\n\n        Args:\n            region_name (str): The name of the anatomical region.\n            observations (dict): A dict of {gene_name: count}.\n            initial_prior (np.ndarray, optional): An initial prior vector. \n                If None, uses the region-specific prior.\n\n        Returns:\n            np.ndarray: The posterior probability vector over classes.\n        \"\"\"\n        if initial_prior is None:\n            region_idx = REGIONS[region_name]\n            posterior = priors[:, region_idx].copy()\n        else:\n            posterior = initial_prior.copy()\n\n        # If no observations, the posterior is the prior\n        if not observations:\n            return posterior\n\n        # Calculate likelihood vector L = [P(O|C=c1), P(O|C=c2), ...]\n        likelihood_vec = np.ones(len(CLASSES))\n        for gene_name, count in observations.items():\n            gene_idx = GENES[gene_name]\n            # Convert count to binary observation\n            obs_binary = 1 if count = 1 else 0\n            \n            # P(O_g=o_g | C=c) for all c\n            if obs_binary == 1:\n                gene_likelihood = pis[gene_idx, :]\n            else: # obs_binary == 0\n                gene_likelihood = 1 - pis[gene_idx, :]\n            \n            # Multiply into total likelihood using conditional independence\n            likelihood_vec *= gene_likelihood\n\n        # Update posterior: P(C|O) ~ P(O|C) * P(C)\n        posterior *= likelihood_vec\n        \n        # Normalize to get final posterior\n        norm_constant = np.sum(posterior)\n        if norm_constant  0:\n            posterior /= norm_constant\n            \n        return posterior\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case 1: Happy path\n        {'type': 'direct', 'region': 'Cortex', 'obs': {'SLC17A7': 3, 'GAD1': 0, 'CHAT': 0}},\n        # Case 2: Conflicting markers\n        {'type': 'direct', 'region': 'Striatum', 'obs': {'SLC17A7': 1, 'GAD1': 2, 'CHAT': 0}},\n        # Case 3: Rare class strongly indicated\n        {'type': 'direct', 'region': 'Cortex', 'obs': {'SLC17A7': 0, 'GAD1': 0, 'CHAT': 4}},\n        # Case 4: No measurements boundary\n        {'type': 'direct', 'region': 'Striatum', 'obs': {}},\n        # Case 5: Sequential update\n        {'type': 'sequential', 'region': 'BasalForebrain', 'obs1': {'SLC17A7': 2}, 'obs2': {'GAD1': 0, 'CHAT': 1}},\n    ]\n\n    string_results = []\n    \n    for case in test_cases:\n        if case['type'] == 'direct':\n            result = calculate_posterior(case['region'], case['obs'])\n            # Format to 6 decimal places, no spaces\n            formatted_res = f\"[{','.join([f'{p:.6f}' for p in result])}]\"\n            string_results.append(formatted_res)\n        \n        elif case['type'] == 'sequential':\n            region = case['region']\n            obs1 = case['obs1']\n            obs2 = case['obs2']\n            \n            # --- Joint update ---\n            joint_obs = {**obs1, **obs2}\n            joint_posterior = calculate_posterior(region, joint_obs)\n            \n            # --- Sequential update ---\n            # Step 1: Update with first batch\n            region_idx = REGIONS[region]\n            prior = priors[:, region_idx]\n            posterior_step1 = calculate_posterior(region, obs1, initial_prior=prior)\n            \n            # Step 2: Update with second batch, using posterior_step1 as prior\n            sequential_posterior = calculate_posterior(region, obs2, initial_prior=posterior_step1)\n\n            # --- Verification ---\n            # Compare joint vs sequential posteriors within tolerance\n            tolerance = 1e-12\n            are_equal = np.allclose(joint_posterior, sequential_posterior, atol=tolerance, rtol=0)\n            string_results.append(str(are_equal))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(string_results)}]\")\n\n\nsolve()\n```", "id": "2705477"}, {"introduction": "现实世界的数据往往是复杂且充满矛盾的。本练习 ([@problem_id:2705573]) 将带您直面这一挑战，通过一个真实的科研场景：一个单细胞在不同测量维度（如转录组与电生理）上呈现出不一致的特征。您需要像一名真正的科学家那样，运用分子生物学、生物物理学和实验设计等多学科原理，进行严谨的科学推理。这项练习旨在培养您的批判性思维和假说检验能力，通过评估不同的实验策略，您将学会如何设计实验来区分技术误差、罕见细胞状态或真正的生物学新发现。", "problem": "一个研究小组将多模态单细胞工作流程应用于小鼠初级体感皮层的抑制性中间神经元。一个通过膜片钳单细胞测序（Patch-seq）捕获的细胞，其转录组和电生理模态之间存在差异：其信使核糖核酸（mRNA）图谱包含典型的生长抑素（Sst）标记转录本，但其电生理学表现为快速发放，具有窄动作电位和低发放频率适应性，这是小白蛋白（Pvalb）篮状细胞的特征。\n\n该小组希望确定这个细胞的最佳解释是：由于技术或分析错误导致的错误分类细胞，是一个稳定地共表达 Sst 和 Pvalb 程序的罕见混合类型，还是一个 Pvalb 神经元暂时表现出 Sst 样转录的瞬时状态。\n\n仅使用细胞和分子神经科学的基本原理以及基础统计推断来推断适当的决策标准和验证实验：\n\n- 分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）以及从离子通道蛋白丰度到通过 Hodgkin–Huxley 型电导的电生理表型的因果联系。\n- 相对于 mRNA 的波动，表观遗传程序在数小时到数天的时间尺度上的稳定性。\n- 使用贝叶斯定理，将来自不同模态的独立证据作为似然因子进行整合，以在不同假说之间做出裁决。\n\n假设以下基于经验、数量级的参数，这些参数描述了模态的可靠性和生物时间尺度，源自先前的基准研究：\n\n- 在低环境核糖核酸条件下，一个在单细胞核糖核酸测序（scRNA-seq）数据上训练的监督分类器区分 Sst 与 Pvalb 转录组类别的准确率约为 $0.95$；在高环境核糖核酸的液滴中，Sst 标记读数污染非 Sst 细胞的概率约为 $0.05$。\n- 基于电生理学区分快速发放与非快速发放的分类器对成熟中间神经元的准确率约为 $0.98$。\n- 单细胞转座酶可及性染色质测序（scATAC-seq）对谱系水平的中间神经元亚类进行分类的准确率约为 $0.97$。\n- 在优化的抗原修复条件下，Sst 肽的免疫染色灵敏度约为 $0.90$，特异性约为 $0.99$。\n- 中间神经元 mRNA 的典型半衰期约为 $t_{1/2,\\text{mRNA}} \\sim 5$ 小时，而塑造快速发放的主要电压门控离子通道蛋白（例如，钾电压门控通道亚家族 C 成员 $1$ (Kv3.1b)）的半衰期约为 $t_{1/2,\\text{protein}} \\sim 50$ 小时。\n\n在目标细胞中，观察到以下现象：\n\n- scRNA-seq 报告了高 Sst mRNA 和低 Pvalb mRNA。\n- 电生理学显示出典型的 Pvalb 神经元的快速发放特性。\n- 对膜片钳记录细胞的细胞质抽吸物进行的 Sst 肽免疫染色结果为阴性。\n- 来自同一细胞核的 scATAC-seq 显示，Pvalb 特异性增强子的染色质开放且具有高可及性，而 Sst 增强子部分可及。\n- 实验室可以在器官型脑片中，使用核糖核酸原位杂交技术（RNAscope）检测 Sst 和 Pvalb，并进行重复的膜片钳记录，在相隔约 $48$ 小时的两个时间点进行纵向测量。\n- 实验室还可以使用 Sst-Cre 和 Pvalb-Flp 品系与报告基因杂交进行双重组酶谱系追踪，以及使用基于成簇规律间隔短回文重复序列（CRISPR）的条形码技术进行谱系追踪。\n\n哪个选项描述了最严谨、最有原则的一套标准和验证实验，用以区分该细胞的三种假说——错误分类、罕见混合类型和瞬时状态？请选择唯一最佳选项。\n\nA. 通过模态间的简单多数投票来决定：因为电生理学和 scATAC-seq 支持 Pvalb，只有 scRNA-seq 支持 Sst，所以将细胞标记为 Pvalb 并得出错误分类的结论；仅通过在不进行环境核糖核酸校正的情况下重新聚类 scRNA-seq 数据来进行验证。\n\nB. 使用明确的贝叶斯模型和时间尺度推理整合各模态，为每个假说建立决策阈值，并使用正交、纵向和谱系感知的分析方法进行验证：定义三个假说 $H_{M}$（错误分类或样本交换）、$H_{H}$（罕见混合类型）和 $H_{T}$（瞬时状态）。对于 $H_{M}$，预测时间稳定的模态（与离子通道蛋白相关的电生理学、scATAC-seq、谱系报告基因）对 Pvalb 的一致性，以及技术污染的证据（环境核糖核酸估计、条形码完整性检查）；对于 $H_{H}$，预测 Sst 和 Pvalb 调控元件的稳定共可及性，Sst 和 Pvalb 转录本及蛋白在时间上和来自同一谱系的多个细胞中的稳定共表达，以及双重组酶交叉标记；对于 $H_{T}$，预测与 Pvalb 一致的 scATAC-seq 和谱系，维持快速发放的电生理学特性，但 Sst mRNA 脉冲是瞬时的，并在 $t_{1/2,\\text{mRNA}}$ 的时间尺度上衰减，而没有相应的 Sst 肽增加，也没有电生理学的持续重塑。使用从给定准确率得出的各模态似然设定贝叶斯因子阈值（例如，贝叶斯因子大于 $10$），并通过在 $0$ 和 $48$ 小时用 RNAscope 进行纵向测量和重复膜片钳记录、对 Sst 和 Kv3.1b 进行免疫染色、环境核糖核酸定量，以及对多个假定混合细胞进行双重组酶谱系追踪加 CRISPR 谱系一致性分析来验证。\n\nC. 使用组合特征的无监督流形嵌入，如果细胞位于 Sst 和 Pvalb 簇之间，则称其为混合型；仅通过轴突和树突的形态重建进行验证，因为形态反映了稳定的亚型身份，足以排除瞬时状态。\n\nD. 仅通过 scRNA-seq 图谱中即刻早期基因（如 Fos 和 Arc）的表达升高来识别瞬时状态；如果这些基因表达水平高，则断定 Pvalb 细胞中发生了瞬时 Sst 诱导，无需进一步的表观遗传学分析、纵向测量或技术污染控制。\n\n答案选项：\n- A\n- B\n- C\n- D", "solution": "在尝试任何解决方案之前，将首先对问题陈述进行严格验证。\n\n### 第 1 步：提取已知信息\n\n提供的信息如下：\n- **系统**：小鼠初级体感皮层的抑制性中间神经元。\n- **技术**：多模态单细胞工作流程，特别是膜片钳单细胞测序（Patch-seq）。\n- **目标细胞观察结果**：\n    - **mRNA 图谱 (scRNA-seq)**：包含典型的生长抑素 ($Sst$) 标记转录本；高 $Sst$ mRNA 和低小白蛋白 ($Pvalb$) mRNA。\n    - **电生理学 (Ephys)**：快速发放，具有窄动作电位和低发放频率适应性，这是 $Pvalb$ 篮状细胞的特征。\n    - **免疫染色**：细胞质抽吸物中 $Sst$ 肽为阴性。\n    - **表观基因组 (scATAC-seq)**：在 $Pvalb$ 特异性增强子处染色质开放且具有高可及性；$Sst$ 增强子部分可及。\n- **需要区分的假说**：\n    1.  $H_{M}$：由于技术或分析错误导致的错误分类细胞。\n    2.  $H_{H}$：一个罕见的、稳定的混合细胞类型，具有 Sst 和 Pvalb 程序的共表达。\n    3.  $H_{T}$：一个 Pvalb 神经元暂时表现出 Sst 样转录的瞬时状态。\n- **必需的推理原则**：\n    1.  分子生物学的中心法则（DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质）以及从离子通道蛋白到电生理学的联系。\n    2.  表观遗传程序相对于 mRNA 波动的稳定性。\n    3.  使用贝叶斯定理整合证据。\n- **经验参数**：\n    - scRNA-seq 分类器准确率（Sst vs. Pvalb，低环境 RNA）：$\\approx 0.95$。\n    - $Sst$ 标记污染非 $Sst$ 细胞的概率（高环境 RNA）：$\\approx 0.05$。\n    - Ephys 分类器准确率（快速发放 vs. 非快速发放）：$\\approx 0.98$。\n    - scATAC-seq 分类器准确率（谱系水平）：$\\approx 0.97$。\n    - $Sst$ 肽免疫染色灵敏度：$\\approx 0.90$。\n    - $Sst$ 肽免疫染色特异性：$\\approx 0.99$。\n    - mRNA 半衰期：$t_{1/2,\\text{mRNA}} \\sim 5$ 小时。\n    - 蛋白质半衰期（例如，Kv3.1b）：$t_{1/2,\\text{protein}} \\sim 50$ 小时。\n- **可用的验证实验**：\n    - 在 $t=0$ 和 $t=48$ 小时进行的纵向测量（RNAscope，重复膜片钳记录）。\n    - 双重组酶谱系追踪（$Sst$-Cre 和 $Pvalb$-Flp）。\n    - 基于 CRISPR 的谱系追踪。\n\n### 第 2 步：问题陈述的验证\n\n根据提取的已知信息评估问题的有效性。\n- **科学依据**：该问题牢固地植根于当代细胞和分子神经科学。细胞具有不一致的多模态数据这一情景是单细胞基因组学中一个真实而重大的挑战。所提到的所有概念——Patch-seq、scRNA-seq、scATAC-seq、中心法则、表观遗传稳定性、神经元电生理学、贝叶斯推断以及 Cre/Flp 等遗传工具——都是标准的且表述准确。给定的参数对于生物系统和实验分析来说是合理的数量级估计。\n- **定义明确**：该问题定义明确。它提出了一个由冲突数据引起的明确歧义，并要求从一组选项中选择最严谨的方法来解决它。它提供了足够的信息（原则、参数、可用技术）以做出合理的决策。\n- **客观性**：语言客观、技术性强，没有主观主张或偏见。\n\n问题陈述没有违反任何指定的无效标准。它在科学上是合理的，可形式化的，自洽的，并提出了一个需要整合不同生物尺度和时间域概念的非平凡挑战。\n\n### 第 3 步：结论与行动\n\n问题陈述是**有效的**。将通过分析选项来推导解决方案。\n\n### 推导与选项分析\n\n问题的核心是为一个具有冲突身份标记的细胞（mRNA 水平上是 $Sst$，电生理水平上是 $Pvalb$）区分三种假说（$H_{M}$, $H_{H}$, $H_{T}$）。一个严谨的解决方案必须利用所提供的原则和数据。\n\n基本原则指导我们的推理：\n1.  **中心法则和时间尺度**：电生理学由离子通道蛋白的组成决定。蛋白质的半衰期很长（$t_{1/2,\\text{protein}} \\sim 50$ 小时）。因此，快速发放表型反映了几天内蛋白质表达的稳定、综合历史。相比之下，mRNA 的半衰期很短（$t_{1/2,\\text{mRNA}} \\sim 5$ 小时），反映了更为近期的转录状态。观察到高 Sst mRNA 但电生理学表现为 Pvalb 样，这与最近的转录变化尚未（且可能永远不会）转化为蛋白质组成和功能的变化相一致。Sst 肽染色为阴性进一步支持了这一点，因为没有显著的蛋白质积累。\n2.  **表观遗传稳定性**：表观基因组（染色质可及性）相对稳定，反映了细胞的谱系和长期转录潜能。scATAC-seq 数据显示 $Pvalb$ 增强子高度可及，而 $Sst$ 增强子仅部分可及，这表明其主要身份或谱系承诺是 $Pvalb$，带有一些潜在或次要的 $Sst$ 表达潜能。这一证据不利于稳定的、完全共指定的混合类型，因为在这种类型中，两组增强子都应是高度且稳定可及的。\n3.  **贝叶斯整合**：一个正式的方法不会将每个模态视为平等的“一票”。相反，人们会使用贝叶斯定理，根据每个模态的证据来更新每个假说的概率。一个观察结果（例如，快速发放的电生理）在给定一个假说（例如，细胞确实是 $Sst$ 类型）下的似然，将使用给定的分类器准确率（例如，电生理分类器的错误率，$1 - 0.98 = 0.02$）来计算。跨独立模态的这些似然的乘积，再由假说的先验概率加权，决定了后验概率。\n\n基于这些原则，我们为每个假说制定预测：\n- **$H_{M}$（错误分类/错误）**：核心身份是 $Pvalb$。$Sst$ mRNA 是一个假象。我们预测稳定的特征（电生理、表观基因组、谱系）都将指向 $Pvalb$。应该有技术错误的证据，例如已知会导致伪转录本检测的高环境 RNA 水平，或遗传条形码的差异。\n- **$H_{H}$（稳定混合型）**：细胞具有稳定的双重身份。我们预测所有生物学层面的特征都将显示共表达。表观基因组应该对 $Sst$ 和 $Pvalb$ 都有稳定开放的增强子。mRNA 和蛋白质都应该持续共表达。关键是，这种状态应该随时间稳定，所以纵向测量（$48$ 小时）应显示持续的共表达。谱系追踪应该能识别出这样一群细胞，并且双重组酶报告基因应该能标记它们。\n- **$H_{T}$（瞬时状态）**：细胞的核心身份是 $Pvalb$，但暂时表达 $Sst$ mRNA。我们预测稳定的特征（电生理、表观基因组、谱系）将是 Pvalb 样的。$Sst$ mRNA 的表达将是瞬时的，并以其约 $5$ 小时的特征半衰期衰减。在 $48$ 小时（近 $10$ 个半衰期）的测量应该显示 $Sst$ mRNA 信号已经消失，而 Pvalb 样的电生理特性得以维持。不会产生显著的 $Sst$ 肽。\n\n现在我们对照这个严谨的框架来评估所提供的选项。\n\n**A. 通过模态间的简单多数投票来决定：因为电生理学和 scATAC-seq 支持 Pvalb，只有 scRNA-seq 支持 Sst，所以将细胞标记为 Pvalb 并得出错误分类的结论；仅通过在不进行环境核糖核酸校正的情况下重新聚类 scRNA-seq 数据来进行验证。**\n这种方法存在根本性缺陷。“多数投票”是一种没有原则的启发式方法，它忽略了不同数据类型的生物学意义、时间尺度和可靠性。它错误地将来自稳定表观基因组的证据等同于来自动态转录组的证据。此外，通过*不*进行环境 RNA 校正的重新聚类来进行“验证”在科学上是疏忽的；环境 RNA 是该选项声称要识别的技术错误的主要候选者。这种方法过于简单且不充分。\n**结论：不正确。**\n\n**B. 使用明确的贝叶斯模型和时间尺度推理整合各模态，为每个假说建立决策阈值，并使用正交、纵向和谱系感知的分析方法进行验证：定义三个假说 $H_{M}$（错误分类或样本交换）、$H_{H}$（罕见混合类型）和 $H_{T}$（瞬时状态）。对于 $H_{M}$，预测时间稳定的模态... 对于 $H_{H}$，预测稳定的共可及性... 对于 $H_{T}$，预测与 Pvalb 一致的 scATAC-seq 和谱系，维持快速发放的电生理学特性，但 Sst mRNA 脉冲是瞬时的... 设定贝叶斯因子阈值... 并通过在 $0$ 和 $48$ 小时用 RNAscope 进行纵向测量和重复膜片钳记录、对 Sst 和 Kv3.1b 进行免疫染色、环境核糖核酸定量，以及对多个假定混合细胞进行双重组酶谱系追踪加 CRISPR 谱系一致性分析来验证。**\n这个选项提出了一个全面且方法论上合理的策略。它明确调用了所需的推理原则：贝叶斯整合（使用从给定准确率得出的似然）、时间尺度推理（使用半衰期区分稳定身份和瞬时 mRNA 脉冲）以及表观遗传稳定性。它对每个假说（$H_{M}$, $H_{H}$, $H_{T}$）的预测是精确的，并直接源于这些原则。提议的验证实验是详尽的，并且完美地设计用于测试这些预测：纵向分析测试稳定性（$H_{H}$）与瞬时性（$H_{T}$）；环境 RNA 定量和条形码检查测试技术错误（$H_{M}$）；谱系追踪测试稳定细胞类型（$H_{H}$）的存在。这代表了最严谨和最有原则的方法。\n**结论：正确。**\n\n**C. 使用组合特征的无监督流形嵌入，如果细胞位于 Sst 和 Pvalb 簇之间，则称其为混合型；仅通过轴突和树突的形态重建进行验证，因为形态反映了稳定的亚型身份，足以排除瞬时状态。**\n这种方法是不充分的。在低维嵌入（如 UMAP 或 t-SNE）中的中间位置是一个观察结果，而不是一个解释。技术假象（$H_{M}$）、瞬时状态（$H_{T}$）和真正的混合型（$H_{H}$）都可能导致这样的嵌入。仅依赖形态学进行验证是一个严重的局限。虽然形态是一个稳定的特征，但它只是细胞类型的一个方面，本身无法解决转录组与其他模态之间的差异，也无法排除技术错误。该选项未能处理问题的时间动态和多层次性质。\n**结论：不正确。**\n\n**D. 仅通过 scRNA-seq 图谱中即刻早期基因（如 Fos 和 Arc）的表达升高来识别瞬时状态；如果这些基因表达水平高，则断定 Pvalb 细胞中发生了瞬时 Sst 诱导，无需进一步的表观遗传学分析、纵向测量或技术污染控制。**\n这是一个草率和鲁莽的结论。虽然即刻早期基因（IEGs）的表达是近期活动的标志，但它并不能唯一地证明 $H_{T}$。高活动性可能是瞬时状态的触发器，但也可能参与维持混合状态（$H_{H}$）。最重要的是，该选项明确主张忽略其他关键的探究方向。在“无需进一步”进行技术控制、表观遗传数据或纵向验证的情况下得出任何结论，都与科学方法背道而驰。人们必须始终排除技术错误（$H_{M}$），并收集足够的证据来区分相互竞争的生物学假说。\n**结论：不正确。**\n\n总之，选项 B 是唯一描述了一种科学严谨、多方面、有原则的方法的选项，该方法正确地使用了所有可用信息和概念工具来解决问题的复杂性。它通过定量建模和有针对性的验证实验相结合，为区分这三个假说提出了一条清晰的路径。", "answer": "$$\\boxed{B}$$", "id": "2705573"}]}