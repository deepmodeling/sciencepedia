{"hands_on_practices": [{"introduction": "宏观的膜属性，例如总漏电导，是成千上万个微观离子通道集体行为的结果。本练习提供了一种具体的方法来理解这种关系，它要求你根据单个K2P漏钾通道的密度和特性来计算神经元膜的总电导。这项实践将单分子水平的生物物理参数与细胞膜的涌现特性联系起来[@problem_id:2720540]。", "problem": "一个神经元的胞体近似为一个半径为 $10\\,\\mu\\mathrm{m}$ 的球体。细胞膜上均匀表达着双孔结构域钾离子 (K2P) 漏通道，据报道其单通道电导为 $10\\,\\mathrm{pS}$，表面密度为 $5\\,\\mu\\mathrm{m}^{-2}$。在所关注的静息条件下，每个通道的开放概率为 $0.8$。假设通道的作用是独立且相同的，宏观膜漏电导是同时开放通道的电导之和，并且通道的期望数量等于表面密度乘以膜面积。仅将胞体膜视为相关表面。仅使用这些基本原理和可加性第一性原理，计算这些通道在胞体上贡献的宏观钾漏电导 $g_{K}$。请用纳西门子 (nanosiemens) 表示最终答案，并将结果四舍五入至四位有效数字。", "solution": "任务是根据许多均匀分布在球形膜上的相同且独立的通道来计算宏观电导，这些通道的特征是单通道电导和开放概率。\n\n从胞体的几何形状开始。对于一个半径为 $r$ 的球体，其表面积为\n$$\nA \\;=\\; 4\\pi r^{2}.\n$$\n当 $r = 10\\,\\mu\\mathrm{m}$ 时，可得\n$$\nA \\;=\\; 4\\pi \\left(10\\,\\mu\\mathrm{m}\\right)^{2} \\;=\\; 400\\pi\\,\\mu\\mathrm{m}^{2}.\n$$\n\n设通道表面密度为 $\\rho = 5\\,\\mu\\mathrm{m}^{-2}$。胞体上的通道总数期望值为\n$$\nN \\;=\\; \\rho\\,A \\;=\\; \\left(5\\,\\mu\\mathrm{m}^{-2}\\right)\\left(400\\pi\\,\\mu\\mathrm{m}^{2}\\right) \\;=\\; 2000\\pi.\n$$\n\n如果每个通道以 $p_{\\mathrm{o}} = 0.8$ 的概率开放，那么开放通道的期望数量为\n$$\nN_{\\mathrm{open}} \\;=\\; p_{\\mathrm{o}}\\,N \\;=\\; 0.8 \\times 2000\\pi \\;=\\; 1600\\pi.\n$$\n\n设单通道电导为 $\\gamma = 10\\,\\mathrm{pS}$。在独立性和可加性的假设下，宏观电导是所有开放通道的电导之和，等于单通道电导乘以开放通道的期望数量：\n$$\ng_{K} \\;=\\; \\gamma \\, N_{\\mathrm{open}} \\;=\\; \\left(10\\,\\mathrm{pS}\\right)\\left(1600\\pi\\right) \\;=\\; 16000\\pi\\,\\mathrm{pS}.\n$$\n\n使用 $1\\,\\mathrm{nS} = 1000\\,\\mathrm{pS}$ 将单位转换为纳西门子 (nanosiemens)：\n$$\ng_{K} \\;=\\; \\frac{16000\\pi\\,\\mathrm{pS}}{1000} \\;=\\; 16\\pi\\,\\mathrm{nS}.\n$$\n\n现在以要求的精度进行数值计算。使用 $\\pi \\approx 3.141592654$，\n$$\ng_{K} \\;\\approx\\; 16 \\times 3.141592654 \\,\\mathrm{nS} \\;=\\; 50.26548246\\,\\mathrm{nS}.\n$$\n\n四舍五入至四位有效数字，结果为\n$$\ng_{K} \\;\\approx\\; 50.27\\,\\mathrm{nS}.\n$$", "answer": "$$\\boxed{50.27}$$", "id": "2720540"}, {"introduction": "静息电位不是由单一离子决定的，而是所有可渗透离子的平衡电位的加权平均值，其中电导充当权重。本练习将引导你推导这个基本原理——弦电導方程，然后计算调节特定的漏氯离子电导如何改变静息电位。这展示了不同离子电流在设定神经元基线电压时的动态相互作用[@problem_id:2720489]。", "problem": "一个处于恒定温度下的小的等电位神经元膜片仅表达钾、钠和氯离子的泄漏通道。假设泄漏电流是欧姆性和线性的。对于每种离子 $i \\in \\{K, \\mathrm{Na}, \\mathrm{Cl}\\}$，泄漏电流由 $I_{i} = g_{i}\\,(V - E_{i})$ 给出，其中 $g_{i}$ 是泄漏电导，$V$ 是膜电位，$E_{i}$ 是离子 $i$ 的反转电位。在静息稳态下，电容电流为零，泄漏电流的代数和为零。\n\n1. 仅使用稳态电流平衡和上述泄漏电流的定义，从第一性原理推导当 $g_{K}$、$g_{\\mathrm{Na}}$、$E_{K}$、$E_{\\mathrm{Na}}$ 和 $E_{\\mathrm{Cl}}$ 保持不变时，静息电位 $V_{\\text{rest}}$ 对 $g_{\\mathrm{Cl}}$ 的依赖关系。证明增加 $g_{\\mathrm{Cl}}$ 会使 $V_{\\text{rest}}$ 移向 $E_{\\mathrm{Cl}}$。\n\n2. 对于一个特定的膜片，参数为 $E_{K} = -90\\,\\text{mV}$、$E_{\\mathrm{Na}} = +60\\,\\text{mV}$、$E_{\\mathrm{Cl}} = -65\\,\\text{mV}$、$g_{K} = 10\\,\\text{nS}$、$g_{\\mathrm{Na}} = 0.5\\,\\text{nS}$ 以及初始 $g_{\\mathrm{Cl}} = 1.0\\,\\text{nS}$。在保持 $g_{K}$ 和 $g_{\\mathrm{Na}}$ 不变的情况下，计算将 $g_{\\mathrm{Cl}}$ 加倍至 $2.0\\,\\text{nS}$ 所产生的静息电位 $V_{\\text{rest}}$ 的带符号变化量（以毫伏为单位）。\n\n将您的最终数值答案表示为以毫伏为单位的带符号变化量，四舍五入到四位有效数字，并在所有中间计算中使用毫伏作为单位。", "solution": "首先对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n以下信息是逐字提供或通过直接定义给出的：\n- 系统是一个处于恒定温度下的小的等电位神经元膜片。\n- 它仅表达钾（$K$）、钠（$\\mathrm{Na}$）和氯（$\\mathrm{Cl}$）离子的泄漏通道。\n- 离子种类由 $i \\in \\{K, \\mathrm{Na}, \\mathrm{Cl}\\}$ 索引。\n- 每种离子的泄漏电流为 $I_{i} = g_{i}\\,(V - E_{i})$，其中 $g_{i}$ 是泄漏电导，$V$ 是膜电位，$E_{i}$ 是反转电位。\n- 在静息稳态下，电容电流为零。\n- 泄漏电流的代数和为零：$\\sum I_i = 0$。\n- 第1部分约束条件：$g_{K}$、$g_{\\mathrm{Na}}$、$E_{K}$、$E_{\\mathrm{Na}}$ 和 $E_{\\mathrm{Cl}}$ 保持不变。\n- 第2部分参数：\n  - $E_{K} = -90\\,\\text{mV}$\n  - $E_{\\mathrm{Na}} = +60\\,\\text{mV}$\n  - $E_{\\mathrm{Cl}} = -65\\,\\text{mV}$\n  - $g_{K} = 10\\,\\text{nS}$\n  - $g_{\\mathrm{Na}} = 0.5\\,\\text{nS}$\n  - 初始氯离子电导：$g_{\\mathrm{Cl},1} = 1.0\\,\\text{nS}$\n  - 最终氯离子电导：$g_{\\mathrm{Cl},2} = 2.0\\,\\text{nS}$\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题描述了一个简化但标准的神经元静息膜电位模型，该模型基于稳态下净电流为零的原理和离子电流的欧姆模型。这是电生理学中的一个基本概念，称为弦电导方程，是基尔霍夫电流定律应用于膜等效电路的直接结果。该模型在科学上是合理的。\n- **适定性**：该问题是适定的。第1部分要求进行推导和定性分析，这可以从给定的方程中完成。第2部分提供了计算唯一量化答案所需的所有数值。\n- **客观性**：问题以客观、技术性的语言陈述，没有歧义或主观性断言。所提供的参数是哺乳动物神经元的典型值。\n\n该问题不存在任何指定的缺陷。它不是科学上不合理、不可形式化、不完整、不切实际、不适定或微不足道的。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**第1部分：推导与分析**\n\n稳态下的基本原理是跨膜没有净电荷流动。鉴于电容电流为零，所有离子电流的总和必须为零。\n$$I_K + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} = 0$$\n代入每个电流的给定线性欧姆表达式 $I_i = g_i(V - E_i)$。在静息状态下，膜电位是静息电位，$V = V_{\\text{rest}}$。\n$$g_K(V_{\\text{rest}} - E_K) + g_{\\mathrm{Na}}(V_{\\text{rest}} - E_{\\mathrm{Na}}) + g_{\\mathrm{Cl}}(V_{\\text{rest}} - E_{\\mathrm{Cl}}) = 0$$\n为了推导 $V_{\\text{rest}}$ 对电导和反转电位的依赖关系，我们必须解这个关于 $V_{\\text{rest}}$ 的线性方程。我们展开各项：\n$$g_K V_{\\text{rest}} - g_K E_K + g_{\\mathrm{Na}} V_{\\text{rest}} - g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} V_{\\text{rest}} - g_{\\mathrm{Cl}} E_{\\mathrm{Cl}} = 0$$\n合并包含 $V_{\\text{rest}}$ 的项：\n$$V_{\\text{rest}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) = g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}$$\n分离 $V_{\\text{rest}}$ 得到静息电位的表达式，它是反转电位的加权平均值，其中电导作为权重：\n$$V_{\\text{rest}} = \\frac{g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}}$$\n该方程显示了 $V_{\\text{rest}}$ 对 $g_{\\mathrm{Cl}}$ 的显式依赖关系。\n\n为了证明增加 $g_{\\mathrm{Cl}}$ 会使 $V_{\\text{rest}}$ 移向 $E_{\\mathrm{Cl}}$，我们分析 $V_{\\text{rest}}$ 相对于 $g_{\\mathrm{Cl}}$ 的变化率。我们计算偏导数 $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}}$，将所有其他参数（$g_K$、$g_{\\mathrm{Na}}$、$E_K$、$E_{\\mathrm{Na}}$、$E_{\\mathrm{Cl}}$）视为常数。使用商法则求导，$(\\frac{f}{h})' = \\frac{f'h-fh'}{h^2}$，其中 $f = g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}$ 且 $h = g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}$。\n\n分子和分母相对于 $g_{\\mathrm{Cl}}$ 的导数是：\n$$\\frac{\\partial f}{\\partial g_{\\mathrm{Cl}}} = E_{\\mathrm{Cl}}$$\n$$\\frac{\\partial h}{\\partial g_{\\mathrm{Cl}}} = 1$$\n应用商法则：\n$$\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = \\frac{(E_{\\mathrm{Cl}})(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) - (g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}})(1)}{(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})^2}$$\n我们可以将 $V_{\\text{rest}}$ 的表达式代回分子中：\n$$(g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}) = V_{\\text{rest}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})$$\n这简化了导数：\n$$\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = \\frac{E_{\\mathrm{Cl}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) - V_{\\text{rest}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})}{(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})^2} = \\frac{(E_{\\mathrm{Cl}} - V_{\\text{rest}})(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})}{(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})^2}$$\n$$\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = \\frac{E_{\\mathrm{Cl}} - V_{\\text{rest}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}}$$\n由于电导是非负的物理量，分母（$g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}$）总是正的。因此，导数的符号由项 $(E_{\\mathrm{Cl}} - V_{\\text{rest}})$ 的符号决定。\n- 如果 $V_{\\text{rest}}  E_{\\mathrm{Cl}}$，则 $(E_{\\mathrm{Cl}} - V_{\\text{rest}}) > 0$，所以 $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} > 0$。$g_{\\mathrm{Cl}}$ 的增加导致 $V_{\\text{rest}}$ 增加，使其移向 $E_{\\mathrm{Cl}}$。\n- 如果 $V_{\\text{rest}} > E_{\\mathrm{Cl}}$，则 $(E_{\\mathrm{Cl}} - V_{\\text{rest}})  0$，所以 $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}}  0$。$g_{\\mathrm{Cl}}$ 的增加导致 $V_{\\text{rest}}$ 减少，也使其移向 $E_{\\mathrm{Cl}}$。\n- 如果 $V_{\\text{rest}} = E_{\\mathrm{Cl}}$，则 $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = 0$，系统相对于氯离子处于平衡状态。\n\n这一分析严谨地证明了，增加氯离子泄漏电导 $g_{\\mathrm{Cl}}$ 总是会使静息电位 $V_{\\text{rest}}$ 更接近氯离子反转电位 $E_{\\mathrm{Cl}}$。\n\n**第2部分：数值计算**\n\n我们被要求计算当 $g_{\\mathrm{Cl}}$ 加倍时静息电位的变化量 $\\Delta V_{\\text{rest}}$。我们使用推导出的 $V_{\\text{rest}}$ 表达式和给定的参数。所有电位单位为毫伏（$\\text{mV}$），电导单位为纳西门子（$\\text{nS}$）。\n\n参数为：$E_{K} = -90$，$E_{\\mathrm{Na}} = 60$，$E_{\\mathrm{Cl}} = -65$，$g_{K} = 10$，$g_{\\mathrm{Na}} = 0.5$。\n\n首先，用 $g_{\\mathrm{Cl},1} = 1.0\\,\\text{nS}$ 计算初始静息电位 $V_{\\text{rest},1}$。\n$$V_{\\text{rest},1} = \\frac{g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl},1} E_{\\mathrm{Cl}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl},1}}$$\n$$V_{\\text{rest},1} = \\frac{(10)(-90) + (0.5)(60) + (1.0)(-65)}{10 + 0.5 + 1.0} = \\frac{-900 + 30 - 65}{11.5} = \\frac{-935}{11.5}\\,\\text{mV}$$\n\n接下来，用 $g_{\\mathrm{Cl},2} = 2.0\\,\\text{nS}$ 计算最终静息电位 $V_{\\text{rest},2}$。\n$$V_{\\text{rest},2} = \\frac{g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl},2} E_{\\mathrm{Cl}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl},2}}$$\n$$V_{\\text{rest},2} = \\frac{(10)(-90) + (0.5)(60) + (2.0)(-65)}{10 + 0.5 + 2.0} = \\frac{-900 + 30 - 130}{12.5} = \\frac{-1000}{12.5} = -80\\,\\text{mV}$$\n\n静息电位的带符号变化量是 $\\Delta V_{\\text{rest}} = V_{\\text{rest},2} - V_{\\text{rest},1}$。\n$$\\Delta V_{\\text{rest}} = -80 - \\left(\\frac{-935}{11.5}\\right) = -80 + \\frac{935}{11.5}$$\n数值上，$\\frac{935}{11.5} \\approx 81.3043478...$\n$$\\Delta V_{\\text{rest}} \\approx -80 + 81.3043478... = 1.3043478...\\,\\text{mV}$$\n问题要求答案四舍五入到四位有效数字。\n$$\\Delta V_{\\text{rest}} \\approx 1.304\\,\\text{mV}$$\n正号表示去极化，静息电位从大约 $-81.3\\,\\text{mV}$ 移动到 $-80\\,\\text{mV}$，这与我们的理论分析一致，因为电位向 $E_{\\mathrm{Cl}} = -65\\,\\text{mV}$ 移动。", "answer": "$$\\boxed{1.304}$$", "id": "2720489"}, {"introduction": "在实验神经生理学中，我们经常测量宏观属性，如静息电位 ($V_{rest}$) 和输入电阻 ($R_{in}$)，并需要推断潜在的离子电导。这个高级练习通过建立一个基于改变离子前后所做测量值的线性方程组来模拟这一过程。求解这个方程组可以让你推断出 $K^+$、$Na^+$ 和 $Cl^-$ 漏电通路的具体贡献，这是细胞生物物理学中一种强大的技术[@problem_id:2720511]。", "problem": "给定一个被动单室神经元模型，其膜电容为 $C_m = 100\\,\\mathrm{pF}$。细胞膜包含三个分别针对钾、钠和氯离子的欧姆泄漏通路，其电导分别为 $g_K$、$g_{Na}$ 和 $g_{Cl}$，相应的反转电位为 $E_K$、$E_{Na}$ 和 $E_{Cl}$（所有电压单位为 $\\mathrm{mV}$，电导单位为 $\\mathrm{nS}$）。假设以下基本依据和定义：\n\n- 离子 $i$ 的欧姆通道电流：$I_i = g_i\\,(V - E_i)$。\n- 在等电位房室中应用 Kirchhoff 电流定律：跨膜电流的代数和等于外部注入电流 $I_{\\text{inj}}$。\n- 在无外部电流注入时的稳态（静息电位）条件：总跨膜电流等于 $0$。\n- 输入电阻 $R_{\\text{in}}$ 定义为 $R_{\\text{in}} = \\left.\\dfrac{dV}{dI_{\\text{inj}}}\\right|_{V=V_{\\text{rest}}}$，对于被动欧姆泄漏，总斜率电导为 $G_{\\text{tot}} = 1/R_{\\text{in}} = g_K + g_{Na} + g_{Cl}$。\n\n您的任务是计算泄漏电导 $g_K$、$g_{Na}$ 和 $g_{Cl}$。这些电导值需要在两种不同的细胞外离子条件下，与测得的静息电位和输入电阻保持一致。这两种条件会改变一个或多个反转电位，但不会改变电导。您可以假设 $C_m$ 保持不变，并且两种条件下电导值不发生变化。\n\n使用提供的测量值作为约束条件，将问题纯粹表述为由上述基本依据推导出的代数等式。所有电压以 $\\mathrm{mV}$ 为单位，电阻以 $\\mathrm{M}\\Omega$ 为单位，电导以 $\\mathrm{nS}$ 为单位。使用精确换算公式 $G_{\\text{tot}}\\,(\\mathrm{nS}) = \\dfrac{1000}{R_{\\text{in}}\\,(\\mathrm{M}\\Omega)}$。\n\n程序的输入是隐式的，由下面的测试套件固定；不要读取任何外部输入。对于每个测试用例，您将获得：\n- 操作前测得的静息电位 $V_1$。\n- 操作前测得的反转电位 $E_{K,1}$、$E_{Na}$、$E_{Cl,1}$。\n- 测得的输入电阻 $R_{\\text{in}}$。\n- 操作后测得的静息电位 $V_2$。\n- 操作后测得的反转电位 $E_{K,2}$、$E_{Na}$、$E_{Cl,2}$。\n\n您必须为每种情况求解 $g_K$、$g_{Na}$、$g_{Cl}$（单位为 $\\mathrm{nS}$）。所有解必须满足物理约束条件 $g_K \\ge 0$、$g_{Na} \\ge 0$ 和 $g_{Cl} \\ge 0$。\n\n测试套件（每个项目符号为一个测试用例；所有电压单位为 $\\mathrm{mV}$，电阻单位为 $\\mathrm{M}\\Omega$）：\n- 情况 A（正常路径；钾离子反转电位被改变）：\n  - $V_1 = -68.0$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 100.0$。\n  - 提高细胞外钾离子浓度后：$V_2 = -59.75$, $E_{K,2} = -75.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -70.0$。\n- 情况 B（边界特征；基线 $V_1$ 等于氯离子反转电位；氯离子反转电位被改变）：\n  - $V_1 = -70.0$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 100.0$。\n  - 改变细胞外氯离子浓度后：$V_2 = -67.5$, $E_{K,2} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -60.0$。\n- 情况 C（高输入电阻；钾离子反转电位被改变）：\n  - $V_1 = -69.0$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 333.3333333333333$。\n  - 提高细胞外钾离子浓度后：$V_2 = -63.0$, $E_{K,2} = -80.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -70.0$。\n- 情况 D（总电导不同；钾离子反转电位被大幅改变）：\n  - $V_1 = -67.5$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 125.0$。\n  - 提高细胞外钾离子浓度后：$V_2 = -57.0$, $E_{K,2} = -70.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -70.0$。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表给出 $[g_K,g_{Na},g_{Cl}]$（单位为 $\\mathrm{nS}$），四舍五入到四位小数，并用方括号括起来。例如，输出格式为 $[[g_{K,1},g_{Na,1},g_{Cl,1}],[g_{K,2},g_{Na,2},g_{Cl,2}],\\dots]$，除了逗号和括号外，没有额外的空白字符要求。", "solution": "该问题要求为一个被动神经元膜模型确定三个未知的离子泄漏电导：$g_K$、$g_{Na}$ 和 $g_{Cl}$。解决方案是通过基于所提供的电生理测量数据和基本原理，建立一个包含三个独立线性方程的方程组来获得的。变量是电导 $g_K$、$g_{Na}$ 和 $g_{Cl}$，均以纳西门子（$\\mathrm{nS}$）为单位表示。\n\n方程组的推导分三步进行，分别对应于每个测试用例提供的三条独立信息。\n\n1.  **总膜电导：** 问题定义了静息时的输入电阻 $R_{\\text{in}}$，并指出对于具有欧姆泄漏的被动模型，总膜电导 $G_{\\text{tot}}$ 是输入电阻的倒数，即 $G_{\\text{tot}} = 1/R_{\\text{in}}$。题目还给出，总电导是各个泄漏电导之和。这提供了第一个线性方程：\n    $$g_K + g_{Na} + g_{Cl} = G_{\\text{tot}}$$\n    单位必须一致。当 $R_{\\text{in}}$ 以兆欧（$\\mathrm{M}\\Omega$）为单位，而所求电导以纳西门子（$\\mathrm{nS}$）为单位时，换算关系如下：\n    $$G_{\\text{tot}} (\\mathrm{nS}) = \\frac{1}{R_{\\text{in}} (\\mathrm{M}\\Omega)} \\times \\frac{1}{10^6\\,\\Omega/\\mathrm{M}\\Omega} \\times \\frac{10^9\\,\\mathrm{nS}}{\\mathrm{S}} = \\frac{1000}{R_{\\text{in}} (\\mathrm{M}\\Omega)}$$\n    这个公式在问题陈述中已经给出，它确立了我们对电导的第一个约束条件。\n\n2.  **稳态条件（条件 1）：** 在稳态下，当没有外部注入电流（$I_{\\text{inj}}=0$）时，Kirchhoff 电流定律规定所有跨膜离子电流的总和必须为零。\n    $$I_K + I_{Na} + I_{Cl} = 0$$\n    每种离子 $i$ 的电流由欧姆定律描述，$I_i = g_i(V - E_i)$，其中 $V$ 是膜电位，$E_i$ 是该离子的反转电位。在第一个实验条件下，膜电位是测得的静息电位 $V_1$。将欧姆电流表达式代入 Kirchhoff 定律，得到第二个线性方程：\n    $$g_K(V_1 - E_{K,1}) + g_{Na}(V_1 - E_{Na,1}) + g_{Cl}(V_1 - E_{Cl,1}) = 0$$\n    这里，$V_1$、$E_{K,1}$、$E_{Na,1}$ 和 $E_{Cl,1}$ 是第一个条件下给定的测量值。\n\n3.  **稳态条件（条件 2）：** 进行第二个实验，改变细胞外离子浓度，从而得到一组新的反转电位（$E_{K,2}$、$E_{Na,2}$、$E_{Cl,2}$）和一个新的静息电位（$V_2$）。问题陈述指出，通道电导 $g_K$、$g_{Na}$ 和 $g_{Cl}$ 是细胞膜的内在属性，在两种条件之间不会改变。对第二种条件应用与上述相同的稳态原理，得到第三个线性方程：\n    $$g_K(V_2 - E_{K,2}) + g_{Na}(V_2 - E_{Na,2}) + g_{Cl}(V_2 - E_{Cl,2}) = 0$$\n\n这三个方程构成了一个关于未知电导向量 $\\mathbf{g} = [g_K, g_{Na}, g_{Cl}]^T$ 的线性系统 $A\\mathbf{g} = \\mathbf{b}$。我们定义离子 $i \\in \\{K, Na, Cl\\}$ 在条件 $j \\in \\{1, 2\\}$ 下的驱动力为 $\\Delta V_{i,j} = V_j - E_{i,j}$。于是该系统为：\n$$\n\\begin{pmatrix}\n1  1  1 \\\\\n\\Delta V_{K,1}  \\Delta V_{Na,1}  \\Delta V_{Cl,1} \\\\\n\\Delta V_{K,2}  \\Delta V_{Na,2}  \\Delta V_{Cl,2}\n\\end{pmatrix}\n\\begin{pmatrix}\ng_K \\\\\ng_{Na} \\\\\ng_{Cl}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nG_{\\text{tot}} \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n系数矩阵 $A$ 由驱动力构成，向量 $\\mathbf{b}$ 包含总电导。只要矩阵 $A$ 是可逆的（即其行列式不为零），电导就存在唯一解。实验设计涉及改变至少一个反转电位，这确保了矩阵的第二行和第三行不是线性相关的，从而通常能保证唯一解的存在。该系统可以使用标准的线性代数方法（例如 `numpy.linalg.solve`）来求解，以找到 $g_K, g_{Na}, g_{Cl}$ 的值。最终解还必须满足所有电导均为非负（$g_i \\ge 0$）的物理约束。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for leak conductances g_K, g_Na, and g_Cl for a passive\n    single-compartment neuronal model based on electrophysiological measurements\n    under two different ionic conditions.\n    \"\"\"\n    \n    # Each test case is a tuple containing:\n    # (V1, EK1, ENa1, ECl1, Rin, V2, EK2, ENa2, ECl2)\n    # Voltages are in mV, resistance in MOhms.\n    test_cases = [\n        # Case A\n        (-68.0, -90.0, 60.0, -70.0, 100.0, -59.75, -75.0, 60.0, -70.0),\n        # Case B\n        (-70.0, -90.0, 60.0, -70.0, 100.0, -67.5, -90.0, 60.0, -60.0),\n        # Case C\n        (-69.0, -90.0, 60.0, -70.0, 333.3333333333333, -63.0, -80.0, 60.0, -70.0),\n        # Case D\n        (-67.5, -90.0, 60.0, -70.0, 125.0, -57.0, -70.0, 60.0, -70.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        v1, ek1, ena1, ecl1, rin, v2, ek2, ena2, ecl2 = case\n\n        # Calculate total conductance in nS from input resistance in MOhms.\n        g_tot = 1000.0 / rin\n\n        # Set up the system of linear equations Ag = b, where g = [g_K, g_Na, g_Cl]^T.\n\n        # Matrix A is constructed from coefficients of g_K, g_Na, g_Cl\n        # in the three equations:\n        # 1. g_K + g_Na + g_Cl = G_tot\n        # 2. g_K(V1-EK1) + g_Na(V1-ENa1) + g_Cl(V1-ECl1) = 0\n        # 3. g_K(V2-EK2) + g_Na(V2-ENa2) + g_Cl(V2-ECl2) = 0\n        \n        A = np.array([\n            [1.0, 1.0, 1.0],\n            [v1 - ek1, v1 - ena1, v1 - ecl1],\n            [v2 - ek2, v2 - ena2, v2 - ecl2]\n        ], dtype=np.float64)\n\n        # Vector b contains the constants from the right-hand side of the equations.\n        b = np.array([g_tot, 0.0, 0.0], dtype=np.float64)\n\n        # Solve the linear system for g.\n        conductances = np.linalg.solve(A, b)\n        results.append(conductances)\n\n    # Format the output string as a list of lists, with each value\n    # rounded to four decimal places, and no extra whitespace.\n    # Example: [[gK1,gNa1,gCl1],[gK2,gNa2,gCl2]]\n    results_str_list = []\n    for res in results:\n        # Round each conductance value to 4 decimal places\n        rounded_res = [f\"{val:.4f}\" for val in res]\n        # Format the list of strings as \"[val1,val2,val3]\"\n        results_str_list.append(f\"[{','.join(rounded_res)}]\")\n    \n    # Join the formatted strings for each case and enclose in brackets\n    final_output = f\"[{','.join(results_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2720511"}]}