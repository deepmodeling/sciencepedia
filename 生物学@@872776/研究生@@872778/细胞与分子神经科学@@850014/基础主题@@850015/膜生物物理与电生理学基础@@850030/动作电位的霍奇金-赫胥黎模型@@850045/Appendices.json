{"hands_on_practices": [{"introduction": "要真正掌握霍奇金-赫胥黎模型，我们必须从其核心方程入手，该方程描述了离子电流如何动态地改变膜电位。第一个实践练习 [@problem_id:2763740] 提供了一个基础性的计算，要求你在给定神经元特定状态的情况下，确定电压的瞬时变化率 $\\frac{dV}{dt}$。通过亲手计算各个离子电流并加总其效应，你将具体地理解钠、钾和泄漏电流之间的相互作用如何驱动膜电位朝向或远离兴奋阈值。", "problem": "乌贼巨型轴突膜的单室膜片遵循 Hodgkin–Huxley (HH) 模型 (Hodgkin–Huxley (HH) 形式)。假设采用标准的外向正电流约定和一个等电位室。在瞬时 $t_0$，瞬时状态由膜电位 $V$ 和门控变量 $m$、$h$ 和 $n$ 指定。膜参数为比电容 $C_m=1\\ \\mu\\mathrm{F/cm}^2$，最大电导 $\\bar{g}_{\\mathrm{Na}}=120\\ \\mathrm{mS/cm}^2$、$\\bar{g}_{\\mathrm{K}}=36\\ \\mathrm{mS/cm}^2$、$\\bar{g}_{L}=0.3\\ \\mathrm{mS/cm}^2$，以及反转电位 $E_{\\mathrm{Na}}=50\\ \\mathrm{mV}$、$E_{\\mathrm{K}}=-77\\ \\mathrm{mV}$、$E_{L}=-54.4\\ \\mathrm{mV}$。在 $t_0$ 时，瞬时值为 $V=-60\\ \\mathrm{mV}$，$m=0.10$，$h=0.90$，$n=0.20$。没有施加外部电流，因此 $I_{\\mathrm{app}}=0$。\n\n仅从膜电容上的电荷守恒以及每个离子电流都是欧姆性的，其电导由最大值乘以相应的 Hodgkin–Huxley 门控变量组合（钠激活的三次方乘以失活；钾激活的四次方）给出的假设出发，计算在 $t_0$ 时的瞬时时间导数 $\\frac{dV}{dt}$。用 $\\mathrm{mV/ms}$ 表示您的最终数值，并将答案四舍五入到四位有效数字。此外，根据 $\\frac{dV}{dt}$ 的符号，用文字说明膜电位是瞬时增加（去极化）还是减少（超极化）。只有数值应该出现在你最终的方框答案中。", "solution": "问题陈述已经过验证，并被认为是有效的。这是一个基于经典的 Hodgkin-Huxley 模型的、在计算神经科学领域中适定且有科学依据的问题。所有必要的参数和初始条件都已提供，且不存在矛盾或歧义。\n\n在等电位膜片中，主导膜电位 $V$ 的基本原理是电荷守恒。存储在作为电容器的膜上的电荷变化率，等于流过它的总电流。这由以下方程表示：\n$$\nC_m \\frac{dV}{dt} = I_{\\text{total}}\n$$\n其中 $C_m$ 是比膜电容。总电流 $I_{\\text{total}}$ 是外部施加电流 $I_{\\text{app}}$ 和流经膜上通道的离子电流 $I_{\\text{ion}}$ 的总和。遵循标准的外向正电流约定，该方程写为：\n$$\nC_m \\frac{dV}{dt} = I_{\\text{app}} - I_{\\text{ion}}\n$$\n问题陈述指出，没有施加外部电流，因此 $I_{\\text{app}} = 0$。总离子电流 $I_{\\text{ion}}$ 是钠电流 ($I_{\\text{Na}}$)、钾电流 ($I_{\\text{K}}$) 和非特异性漏电流 ($I_L$) 的总和：\n$$\nI_{\\text{ion}} = I_{\\text{Na}} + I_{\\text{K}} + I_L\n$$\n因此，膜电位变化率的方程简化为：\n$$\n\\frac{dV}{dt} = -\\frac{1}{C_m} I_{\\text{ion}} = -\\frac{1}{C_m} (I_{\\text{Na}} + I_{\\text{K}} + I_L)\n$$\n根据 Hodgkin-Huxley 形式，每个离子电流都遵循欧姆关系 $I_x = g_x (V - E_x)$，其中 $g_x$ 是离子种类 $x$ 的瞬时电导，$E_x$ 是其能斯特反转电位。钠和钾的电导是电压和时间依赖的，由它们各自的门控变量决定。问题给出了这些电导的具体形式：\n钠电流为 $I_{\\text{Na}} = g_{\\text{Na}} (V - E_{\\text{Na}})$，其中 $g_{\\text{Na}} = \\bar{g}_{\\text{Na}} m^3 h$。\n钾电流为 $I_{\\text{K}} = g_{\\text{K}} (V - E_{\\text{K}})$，其中 $g_{\\text{K}} = \\bar{g}_{\\text{K}} n^4$。\n漏电流为 $I_L = g_L (V - E_L)$，其电导为常数 $g_L = \\bar{g}_L$。\n\n结合这些表达式，$\\frac{dV}{dt}$ 的完整方程是：\n$$\n\\frac{dV}{dt} = -\\frac{1}{C_m} \\left[ \\bar{g}_{\\text{Na}} m^3 h (V - E_{\\text{Na}}) + \\bar{g}_{\\text{K}} n^4 (V - E_{\\text{K}}) + \\bar{g}_L (V - E_L) \\right]\n$$\n我们现在代入在时间 $t_0$ 给定的瞬时值：\n电容：$C_m = 1\\ \\mu\\mathrm{F/cm}^2$。\n膜电位：$V = -60\\ \\mathrm{mV}$。\n门控变量：$m = 0.10$，$h = 0.90$，$n = 0.20$。\n最大电导：$\\bar{g}_{\\text{Na}} = 120\\ \\mathrm{mS/cm}^2$，$\\bar{g}_{\\text{K}} = 36\\ \\mathrm{mS/cm}^2$，$\\bar{g}_{L} = 0.3\\ \\mathrm{mS/cm}^2$。\n反转电位：$E_{\\text{Na}} = 50\\ \\mathrm{mV}$，$E_{\\text{K}} = -77\\ \\mathrm{mV}$，$E_{L} = -54.4\\ \\mathrm{mV}$。\n\n首先，我们计算每个单独的离子电流密度。电流密度的单位将是 $(\\mathrm{mS/cm}^2) \\times (\\mathrm{mV}) = \\mu\\mathrm{A/cm}^2$。\n\n钠电流密度，$I_{\\text{Na}}$：\n钠的驱动力是 $V - E_{\\text{Na}} = -60\\ \\mathrm{mV} - 50\\ \\mathrm{mV} = -110\\ \\mathrm{mV}$。\n瞬时钠电导是 $g_{\\text{Na}} = \\bar{g}_{\\text{Na}} m^3 h = (120\\ \\mathrm{mS/cm}^2) \\times (0.10)^3 \\times (0.90) = (120) \\times (0.001) \\times (0.90)\\ \\mathrm{mS/cm}^2 = 0.108\\ \\mathrm{mS/cm}^2$。\n所以，$I_{\\text{Na}} = (0.108\\ \\mathrm{mS/cm}^2) \\times (-110\\ \\mathrm{mV}) = -11.88\\ \\mu\\mathrm{A/cm}^2$。\n\n钾电流密度，$I_{\\text{K}}$：\n钾的驱动力是 $V - E_{\\text{K}} = -60\\ \\mathrm{mV} - (-77\\ \\mathrm{mV}) = 17\\ \\mathrm{mV}$。\n瞬时钾电导是 $g_{\\text{K}} = \\bar{g}_{\\text{K}} n^4 = (36\\ \\mathrm{mS/cm}^2) \\times (0.20)^4 = (36) \\times (0.0016)\\ \\mathrm{mS/cm}^2 = 0.0576\\ \\mathrm{mS/cm}^2$。\n所以，$I_{\\text{K}} = (0.0576\\ \\mathrm{mS/cm}^2) \\times (17\\ \\mathrm{mV}) = 0.9792\\ \\mu\\mathrm{A/cm}^2$。\n\n漏电流密度，$I_L$：\n漏电流的驱动力是 $V - E_L = -60\\ \\mathrm{mV} - (-54.4\\ \\mathrm{mV}) = -5.6\\ \\mathrm{mV}$。\n漏电导是恒定的：$g_L = \\bar{g}_L = 0.3\\ \\mathrm{mS/cm}^2$。\n所以，$I_L = (0.3\\ \\mathrm{mS/cm}^2) \\times (-5.6\\ \\mathrm{mV}) = -1.68\\ \\mu\\mathrm{A/cm}^2$。\n\n接下来，我们将这些电流密度相加，得到总离子电流密度 $I_{\\text{ion}}$：\n$$\nI_{\\text{ion}} = I_{\\text{Na}} + I_{\\text{K}} + I_L = (-11.88 + 0.9792 - 1.68)\\ \\mu\\mathrm{A/cm}^2 = -12.5808\\ \\mu\\mathrm{A/cm}^2\n$$\n最后，我们计算 $\\frac{dV}{dt}$：\n$$\n\\frac{dV}{dt} = -\\frac{I_{\\text{ion}}}{C_m} = -\\frac{-12.5808\\ \\mu\\mathrm{A/cm}^2}{1\\ \\mu\\mathrm{F/cm}^2} = 12.5808\\ \\frac{\\mu\\mathrm{A}}{\\mu\\mathrm{F}}\n$$\n单位是 $\\frac{\\mu\\mathrm{A}}{\\mu\\mathrm{F}} = \\frac{\\mathrm{A}}{\\mathrm{F}} = \\frac{\\mathrm{Coulomb/second}}{\\mathrm{Coulomb/Volt}} = \\mathrm{Volt/second}$。为了转换为 $\\mathrm{mV/ms}$，我们注意到 $1\\ \\mathrm{V/s} = 1\\ \\mathrm{mV/ms}$。因此：\n$$\n\\frac{dV}{dt} = 12.5808\\ \\mathrm{mV/ms}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\frac{dV}{dt} \\approx 12.58\\ \\mathrm{mV/ms}\n$$\n由于 $\\frac{dV}{dt}$ 的符号为正，膜电位正在瞬时增加。这个过程被称为去极化。巨大的内向钠电流主导了较小的外向钾电流和内向漏电流，导致膜电位变得不那么负。", "answer": "$$\n\\boxed{12.58}\n$$", "id": "2763740"}, {"introduction": "动作电位的全或无特性及其不应期，在很大程度上依赖于钠通道的时间和电压依赖性失活。这个练习 [@problem_id:2763691] 从静态计算转向动态模拟，让你能够模拟一个经典的双脉冲电压钳实验。通过追踪失活门控变量 $h$，你将探索一个预脉冲去极化如何减少钠通道对后续刺激的可用性，从而为理解神经元的不应期提供计算基础。", "problem": "要求您编写一个完整的、可运行的程序，使用钠通道失活门控动力学的霍奇金-赫胥黎（Hodgkin-Huxley, HH）模型，演示一个短暂的去极化前脉冲如何使钠通道失活，从而改变随后测试脉冲所引发的峰值钠电流。建模应在电压钳条件下进行，并应重点关注失活变量 $h$；可以假设激活变量 $m$ 在测试脉冲电压下迅速达到平衡。\n\n从以下公认的基础和定义开始，所有单位均如下文指定。\n\n- 霍奇金-赫胥黎（HH）门控动力学由电压钳条件下的一级双态动力学表示。钠失活门控变量 $h$ 服从以下常微分方程（ODE）：\n$$\\frac{dh}{dt} = \\alpha_h(V)\\,\\big(1 - h\\big) - \\beta_h(V)\\,h,$$ \n其中 $V$ 是电压钳条件下的膜电位。\n- 钠激活门控变量 $m$ 由类似的速率函数 $\\alpha_m(V)$ 和 $\\beta_m(V)$ 定义。为了计算测试脉冲开始时的瞬时峰值钠电流，您可以假设在测试脉冲电压 $V$ 下，$m$ 处于其稳态值 $m_{\\infty}(V)$。\n- 电压钳条件下的宏观钠电流为：\n$$I_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3\\, h\\, \\big(V - E_{\\mathrm{Na}}\\big).$$\n\n使用乌贼巨轴突的经典霍奇金-赫胥黎速率函数（温度约 $6.3\\,^{\\circ}\\mathrm{C}$），其中 $V$ 单位为毫伏（millivolts），$t$ 单位为毫秒（milliseconds），速率常数单位为 $\\mathrm{ms}^{-1}$：\n- \n$$\\alpha_m(V) = 0.1\\,\\frac{V + 40}{1 - e^{-(V+40)/10}},\\quad \\beta_m(V) = 4\\,e^{-(V+65)/18}.$$\n- \n$$\\alpha_h(V) = 0.07\\, e^{-(V+65)/20},\\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}}.$$\n\n在所有测试用例中，令以下常数固定：\n- 维持电位 $V_{\\mathrm{hold}} = -65\\,\\mathrm{mV}$。\n- 钠反转电位 $E_{\\mathrm{Na}} = 50\\,\\mathrm{mV}$。\n- 最大钠电导 $\\bar{g}_{\\mathrm{Na}} = 120\\,\\mathrm{mS/cm^2}$。\n\n要建模的方案：\n1. 在维持电位 $V_{\\mathrm{hold}}$ 下初始化足够长的时间，以使 $h$ 达到其稳态 $h_{\\infty}(V_{\\mathrm{hold}})$。\n2. 施加一个电压为 $V_{\\mathrm{pre}}$ 的前脉冲，持续时间为 $t_{\\mathrm{pre}}$（单位：毫秒）。\n3. 返回到 $V_{\\mathrm{hold}}$，持续一个脉冲间间隔 $t_{\\mathrm{int}}$（单位：毫秒）。\n4. 施加一个电压为 $V_{\\mathrm{test}}$ 的测试脉冲；通过取 $m = m_{\\infty}(V_{\\mathrm{test}})$ 以及从步骤2-3带入测试脉冲的 $h$ 值，计算测试脉冲开始时的瞬时峰值钠电流。您应假设在测试脉冲期间，$h$ 发生显著变化之前出现峰值。\n\n您的程序必须：\n- 使用上述ODE，通过分段恒定电压方案数值上推进失活门 $h$。您可以使用任何正确的数值技术来求解恒定 $V$ 区间上的一阶线性ODE。\n- 为每个测试用例计算测试脉冲开始时的瞬时峰值钠电流，结果为浮点数，单位为微安/平方厘米（$\\mu\\mathrm{A/cm^2}$）。请注意，当 $\\bar{g}_{\\mathrm{Na}}$ 的单位是 $\\mathrm{mS/cm^2}$，电位单位是 $\\mathrm{mV}$ 时，电流的单位将是 $\\mu\\mathrm{A/cm^2}$，因为 $\\mathrm{mS}\\cdot\\mathrm{mV} = \\mu\\mathrm{A}$。\n- 将每个结果四舍五入到恰好 $3$ 位小数。\n\n测试套件：\n为以下五个参数集 $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}})$ 中的每一个计算峰值钠电流，所有电压单位为 $\\mathrm{mV}$，时间单位为 $\\mathrm{ms}$：\n- 用例 1：$(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-65, 5.0, 5.0, -10\\big)$。\n- 用例 2：$(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-10, 5.0, 0.0, -10\\big)$。\n- 用例 3：$(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-10, 5.0, 50.0, -10\\big)$。\n- 用例 4：$(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(20, 2.0, 2.0, -10\\big)$。\n- 用例 5：$(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-30, 0.1, 1.0, -10\\big)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序与上述用例相同。每个数字必须四舍五入到恰好 $3$ 位小数。例如，输出格式必须与下面完全一样\n$$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$$\n没有空格，数值单位为 $\\mu\\mathrm{A/cm^2}$。", "solution": "该问题是有效的。它提出了一个计算神经科学中基于经典霍奇金-赫胥黎模型的标准、适定问题。所有必要的方程、参数和条件都已提供，并且它们在科学上是合理且一致的。任务是模拟去极化前脉冲对钠通道可用性的影响以及由此产生的峰值钠电流，这是电生理学中的一个基本概念。\n\n解决方法是首先推导失活门控变量 $h$ 的解析解，然后通过指定的电压钳方案顺序应用它。\n\n钠通道失活门 $h$ 的动力学由以下一阶线性常微分方程描述：\n$$\n\\frac{dh}{dt} = \\alpha_h(V)(1 - h) - \\beta_h(V)h\n$$\n其中 $\\alpha_h(V)$ 和 $\\beta_h(V)$ 是电压依赖性速率常数。对于恒定的膜电位 $V$（正如电压钳方案的每个步骤中的情况），该方程可以重新排列成标准形式：\n$$\n\\frac{dh}{dt} + (\\alpha_h(V) + \\beta_h(V))h = \\alpha_h(V)\n$$\n为简化起见，我们定义电压依赖性稳态值 $h_{\\infty}(V)$ 和时间常数 $\\tau_h(V)$：\n$$\nh_{\\infty}(V) = \\frac{\\alpha_h(V)}{\\alpha_h(V) + \\beta_h(V)}\n$$\n$$\n\\tau_h(V) = \\frac{1}{\\alpha_h(V) + \\beta_h(V)}\n$$\n微分方程于是变为：\n$$\n\\frac{dh}{dt} = \\frac{h_{\\infty}(V) - h}{\\tau_h(V)}\n$$\n给定在电压阶跃至 $V$ 开始时的初始值 $h(t_0) = h_0$，该ODE对于任何时间 $t \\ge t_0$ 都有精确的解析解：\n$$\nh(t) = h_{\\infty}(V) + (h_0 - h_{\\infty}(V)) \\exp\\left(-\\frac{t - t_0}{\\tau_h(V)}\\right)\n$$\n该方程使我们能够精确计算任何恒定电压区间结束时的 $h$ 值，而无需借助如欧拉法（Euler）或龙格-库塔法（Runge-Kutta）等数值积分方案，从而避免了数值积分误差。\n\n宏观钠电流 $I_{\\mathrm{Na}}$ 由以下公式给出：\n$$\nI_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3\\, h\\, (V - E_{\\mathrm{Na}})\n$$\n其中 $\\bar{g}_{\\mathrm{Na}}$ 是最大钠电导，$E_{\\mathrm{Na}}$ 是钠反转电位，$m$ 是激活门控变量。问题指出，为了计算测试脉冲开始时的*瞬时峰值电流*，我们假设激活门 $m$ 瞬时平衡至其稳态值 $m_{\\infty}(V_{\\mathrm{test}})$。 $h$ 的值是从之前的方案步骤中延续过来的，因为失活是一个较慢的过程。\n\n每个测试用例 $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}})$ 的计算过程如下：\n\n1.  **初始化**：系统首先在维持电位 $V_{\\mathrm{hold}} = -65\\,\\mathrm{mV}$ 下保持足够长的时间，使 $h$ 达到其稳态。因此，$h$ 的初始值为 $h_0 = h_{\\infty}(V_{\\mathrm{hold}})$。\n\n2.  **前脉冲阶段**：施加一个电压为 $V_{\\mathrm{pre}}$ 的脉冲，持续时间为 $t_{\\mathrm{pre}}$。此阶段结束时的 $h$ 值 $h_1$ 使用初始值为 $h_0$ 的解析解计算：\n    $$\n    h_1 = h_{\\infty}(V_{\\mathrm{pre}}) + (h_0 - h_{\\infty}(V_{\\mathrm{pre}})) \\exp\\left(-\\frac{t_{\\mathrm{pre}}}{\\tau_h(V_{\\mathrm{pre}})}\\right)\n    $$\n\n3.  **脉冲间间隔**：电压返回到 $V_{\\mathrm{hold}}$，持续时间为 $t_{\\mathrm{int}}$。这个间隔允许在前脉冲期间发生的任何失活部分或完全恢复。此间隔结束时的 $h$ 值 $h_2$ 从 $h_1$ 开始：\n    $$\n    h_2 = h_{\\infty}(V_{\\mathrm{hold}}) + (h_1 - h_{\\infty}(V_{\\mathrm{hold}})) \\exp\\left(-\\frac{t_{\\mathrm{int}}}{\\tau_h(V_{\\mathrm{hold}})}\\right)\n    $$\n    如果 $t_{\\mathrm{int}} = 0$，则显然 $h_2 = h_1$。\n\n4.  **测试脉冲和电流计算**：施加一个电压为 $V_{\\mathrm{test}}$ 的测试脉冲。瞬时峰值钠电流在此脉冲的起始时刻计算。此刻：\n    -   失活门的值为 $h_{peak} = h_2$。\n    -   激活门被假定为其稳态值 $m_{peak} = m_{\\infty}(V_{\\mathrm{test}})$。\n    -   驱动力为 $(V_{\\mathrm{test}} - E_{\\mathrm{Na}})$。\n\n    峰值电流则为：\n    $$\n    I_{\\mathrm{Na,peak}} = \\bar{g}_{\\mathrm{Na}} \\cdot (m_{\\infty}(V_{\\mathrm{test}}))^3 \\cdot h_2 \\cdot (V_{\\mathrm{test}} - E_{\\mathrm{Na}})\n    $$\n    单位是一致的：当 $\\bar{g}_{\\mathrm{Na}}$ 的单位是 $\\mathrm{mS/cm^2}$，电位单位是 $\\mathrm{mV}$ 时，电流 $I_{\\mathrm{Na,peak}}$ 的单位是 $\\mu\\mathrm{A/cm^2}$。\n\n所有计算均使用所提供的霍奇金-赫胥黎速率函数。对于 $\\alpha_m(V)$ 在 $V = -40\\,\\mathrm{mV}$ 处的特殊情况，会产生一个 $0/0$ 的不定式，必须通过使用洛必达法则（L'Hôpital's rule）求极限来处理，得到 $\\alpha_m(-40) = 1.0\\,\\mathrm{ms}^{-1}$。对每个测试用例遵循此程序，即可得到所需的峰值钠电流集合。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the peak sodium current in a Hodgkin-Huxley model under a\n    prepulse voltage-clamp protocol.\n    \"\"\"\n\n    #\n    # --- Model Constants and Parameters ---\n    #\n    G_NA_BAR = 120.0  # Maximum sodium conductance (mS/cm^2)\n    E_NA = 50.0       # Sodium reversal potential (mV)\n    V_HOLD = -65.0    # Holding potential (mV)\n\n    #\n    # --- Hodgkin-Huxley Rate Functions ---\n    #\n    def alpha_m(v):\n        \"\"\"Rate constant alpha_m for sodium activation.\"\"\"\n        # Handle the singularity at v = -40 mV using L'Hopital's rule.\n        if np.isclose(v, -40.0):\n            return 1.0\n        return 0.1 * (v + 40.0) / (1.0 - np.exp(-(v + 40.0) / 10.0))\n\n    def beta_m(v):\n        \"\"\"Rate constant beta_m for sodium activation.\"\"\"\n        return 4.0 * np.exp(-(v + 65.0) / 18.0)\n\n    def alpha_h(v):\n        \"\"\"Rate constant alpha_h for sodium inactivation.\"\"\"\n        return 0.07 * np.exp(-(v + 65.0) / 20.0)\n\n    def beta_h(v):\n        \"\"\"Rate constant beta_h for sodium inactivation.\"\"\"\n        return 1.0 / (1.0 + np.exp(-(v + 35.0) / 10.0))\n\n    #\n    # --- Steady-State and Time Constant Functions ---\n    #\n    def m_inf(v):\n        \"\"\"Steady-state activation m_infinity.\"\"\"\n        return alpha_m(v) / (alpha_m(v) + beta_m(v))\n\n    def h_inf(v):\n        \"\"\"Steady-state inactivation h_infinity.\"\"\"\n        return alpha_h(v) / (alpha_h(v) + beta_h(v))\n\n    def tau_h(v):\n        \"\"\"Inactivation time constant tau_h.\"\"\"\n        return 1.0 / (alpha_h(v) + beta_h(v))\n\n    #\n    # --- Analytical Solver for a Single Voltage Step ---\n    #\n    def solve_h_step(h_initial, v, t):\n        \"\"\"\n        Analytically solves for h after a time interval t at constant voltage v.\n        \"\"\"\n        if t == 0.0:\n            return h_initial\n        \n        h_infinity = h_inf(v)\n        tau = tau_h(v)\n        \n        return h_infinity + (h_initial - h_infinity) * np.exp(-t / tau)\n\n    #\n    # --- Main Simulation Function ---\n    #\n    def calculate_peak_current(v_pre, t_pre, t_int, v_test):\n        \"\"\"\n        Simulates the voltage-clamp protocol and calculates the peak sodium current.\n        \"\"\"\n        # Step 1: Initial condition at holding potential\n        h0 = h_inf(V_HOLD)\n        \n        # Step 2: Propagate h through the prepulse\n        h1 = solve_h_step(h0, v_pre, t_pre)\n        \n        # Step 3: Propagate h through the interpulse interval\n        h2 = solve_h_step(h1, V_HOLD, t_int)\n        \n        # Step 4: Calculate instantaneous peak current at the onset of the test pulse\n        m_peak = m_inf(v_test)\n        h_peak = h2\n        \n        i_na_peak = G_NA_BAR * (m_peak**3) * h_peak * (v_test - E_NA)\n        \n        return i_na_peak\n\n    #\n    # --- Test Cases ---\n    #\n    test_cases = [\n        # (V_pre, t_pre, t_int, V_test)\n        (-65.0, 5.0, 5.0, -10.0),  # Case 1: Control (prepulse at holding potential)\n        (-10.0, 5.0, 0.0, -10.0),  # Case 2: Inactivating prepulse, no recovery\n        (-10.0, 5.0, 50.0, -10.0), # Case 3: Inactivating prepulse, long recovery\n        (20.0, 2.0, 2.0, -10.0),   # Case 4: Strong inactivating prepulse, short recovery\n        (-30.0, 0.1, 1.0, -10.0),  # Case 5: Weak, brief prepulse, short recovery\n    ]\n\n    results = []\n    for case in test_cases:\n        v_pre, t_pre, t_int, v_test = case\n        peak_current = calculate_peak_current(v_pre, t_pre, t_int, v_test)\n        # Round to 3 decimal places as specified\n        results.append(f\"{round(peak_current, 3):.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2763691"}, {"introduction": "在探索了模型的核心方程和单个门控过程的动力学之后，我们现在将所有组件整合起来，以模拟动作电位这一涌现现象。这项高级实践 [@problem_id:2763689] 要求你数值求解完整的霍奇金-赫胥黎耦合方程组，以生成对注入电流的响应尖峰。此外，它还挑战你通过量化其准确性来批判性地评估一个常见的简化方法——钠激活的准稳态近似 ($m \\approx m_{\\infty}(V)$)，这是开发和应用简化神经元模型的一项关键技能。", "problem": "考虑经典的 Hodgkin–Huxley (HH) 模型，该模型描述了在 $6.3\\,\\mathrm{^{\\circ}C}$ 温度下乌贼巨轴突的电生理活动，其受电容电流平衡和电压依赖性离子电流的控制。膜电压 $V$（单位为 $\\mathrm{mV}$）根据以下方程演化：\n$$\nC_{\\mathrm{m}}\\,\\frac{dV}{dt} \\;=\\; I_{\\mathrm{ext}}(t)\\;-\\; I_{\\mathrm{Na}}(t)\\;-\\; I_{\\mathrm{K}}(t)\\;-\\; I_{\\mathrm{L}}(t),\n$$\n其中 $C_{\\mathrm{m}}$ 是单位面积的膜电容，单位为 $\\mathrm{\\mu F}/\\mathrm{cm}^2$；$I_{\\mathrm{ext}}$ 是外部注入的电流密度，单位为 $\\mathrm{\\mu A}/\\mathrm{cm}^2$；$I_{\\mathrm{Na}}, I_{\\mathrm{K}}, I_{\\mathrm{L}}$ 分别是钠、钾和漏电流密度，单位为 $\\mathrm{\\mu A}/\\mathrm{cm}^2$。离子电流为：\n$$\nI_{\\mathrm{Na}} \\;=\\; \\bar{g}_{\\mathrm{Na}}\\,m^3 h\\,(V - E_{\\mathrm{Na}}),\\quad\nI_{\\mathrm{K}} \\;=\\; \\bar{g}_{\\mathrm{K}}\\,n^4\\,(V - E_{\\mathrm{K}}),\\quad\nI_{\\mathrm{L}} \\;=\\; \\bar{g}_{\\mathrm{L}}\\,(V - E_{\\mathrm{L}}),\n$$\n其中 $\\bar{g}_{\\mathrm{Na}},\\bar{g}_{\\mathrm{K}},\\bar{g}_{\\mathrm{L}}$ 为最大电导，单位为 $\\mathrm{mS}/\\mathrm{cm}^2$；$E_{\\mathrm{Na}},E_{\\mathrm{K}},E_{\\mathrm{L}}$ 为反转电位，单位为 $\\mathrm{mV}$。门控变量 $m, h, n$ 满足一级动力学方程：\n$$\n\\frac{dm}{dt} \\;=\\; \\alpha_m(V)\\,(1-m) - \\beta_m(V)\\,m,\\quad\n\\frac{dh}{dt} \\;=\\; \\alpha_h(V)\\,(1-h) - \\beta_h(V)\\,h,\\quad\n\\frac{dn}{dt} \\;=\\; \\alpha_n(V)\\,(1-n) - \\beta_n(V)\\,n,\n$$\n其速率函数为标准的 HH 速率函数（所有速率单位均为 $\\mathrm{ms}^{-1}$）：\n$$\n\\alpha_m(V) \\;=\\; \\frac{0.1\\,(V+40)}{1 - e^{-(V+40)/10}},\\qquad \\beta_m(V) \\;=\\; 4\\,e^{-(V+65)/18},\\\\\n\\alpha_h(V) \\;=\\; 0.07\\,e^{-(V+65)/20},\\qquad\\;\\; \\beta_h(V) \\;=\\; \\frac{1}{1 + e^{-(V+35)/10}},\\\\\n\\alpha_n(V) \\;=\\; \\frac{0.01\\,(V+55)}{1 - e^{-(V+55)/10}},\\qquad \\beta_n(V) \\;=\\; 0.125\\,e^{-(V+65)/80}.\n$$\n定义 $m$ 的稳态（无穷时间）激活函数为：\n$$\nm_{\\infty}(V) \\;=\\; \\frac{\\alpha_m(V)}{\\alpha_m(V) + \\beta_m(V)}.\n$$\n你将通过比较真实钠电流与一个 QSS 近似的钠电流，来分析在动作电位上升支期间，准稳态 (QSS) 近似 $m \\approx m_{\\infty}(V)$ 的准确性。在 QSS 近似的钠电流中，$m(t)$ 被替换为 $m_{\\infty}(V(t))$，而 $h(t)$ 保持不变：\n$$\nI_{\\mathrm{Na}}^{\\mathrm{true}}(t) \\;=\\; \\bar{g}_{\\mathrm{Na}}\\,m(t)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}}),\\qquad\nI_{\\mathrm{Na}}^{\\mathrm{qss}}(t) \\;=\\; \\bar{g}_{\\mathrm{Na}}\\,\\big(m_{\\infty}(V(t))\\big)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}}).\n$$\n为了探究时间尺度效应，引入一个动力学缩放因子 $s_m$，仅应用于 $m$ 门控速率，即将 $\\alpha_m(V)$ 和 $\\beta_m(V)$ 分别替换为 $s_m\\,\\alpha_m(V)$ 和 $s_m\\,\\beta_m(V)$。这样做可以保持 $m_{\\infty}(V)$ 不变，并将时间常数 $\\tau_m(V)$ 缩放 $1/s_m$ 倍。\n\n使用以下生物物理参数：\n- $C_{\\mathrm{m}} = 1\\,\\mathrm{\\mu F}/\\mathrm{cm}^2$,\n- $\\bar{g}_{\\mathrm{Na}} = 120\\,\\mathrm{mS}/\\mathrm{cm}^2$,\n- $\\bar{g}_{\\mathrm{K}} = 36\\,\\mathrm{mS}/\\mathrm{cm}^2$,\n- $\\bar{g}_{\\mathrm{L}} = 0.3\\,\\mathrm{mS}/\\mathrm{cm}^2$,\n- $E_{\\mathrm{Na}} = 50\\,\\mathrm{mV}$, $E_{\\mathrm{K}} = -77\\,\\mathrm{mV}$, $E_{\\mathrm{L}} = -54.4\\,\\mathrm{mV}$。\n使用初始电压 $V(0) = -65\\,\\mathrm{mV}$，并将 $m(0), h(0), n(0)$ 初始化为它们在 $V(0)$ 时的稳态值，即 $x(0) = x_{\\infty}(V(0))$，其中 $x \\in \\{m,h,n\\}$ 且 $x_{\\infty}(V) = \\alpha_x(V)/(\\alpha_x(V)+\\beta_x(V))$。\n\n使用稳定的显式方法（例如，经典的四阶龙格－库塔法），对 HH 系统进行数值积分，总时长为 $T_{\\mathrm{end}} = 5\\,\\mathrm{ms}$，固定时间步长不大于 $\\Delta t = 0.005\\,\\mathrm{ms}$。使用方波外部电流\n$$\nI_{\\mathrm{ext}}(t) \\;=\\; \n\\begin{cases}\nI_0,  0 \\le t \\le T_{\\mathrm{inj}},\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n其中 $(I_0, T_{\\mathrm{inj}})$ 的单位分别为 $\\mathrm{\\mu A}/\\mathrm{cm}^2$ 和 $\\mathrm{ms}$，并在下文的每个测试案例中给出具体值。\n\n定义上升支分析窗口 $\\mathcal{W}$ 为膜电压满足 $-55\\,\\mathrm{mV} < V(t) < 0\\,\\mathrm{mV}$ 的时间索引集合。在此窗口内，使用以下两个无量纲指标来量化钠电流的 QSS 误差：\n- 最大归一化误差\n$$\n\\varepsilon_{\\max} \\;=\\; \\frac{\\max_{t \\in \\mathcal{W}} \\big| I_{\\mathrm{Na}}^{\\mathrm{true}}(t) - I_{\\mathrm{Na}}^{\\mathrm{qss}}(t) \\big|}{\\max_{t \\in \\mathcal{W}} \\big| I_{\\mathrm{Na}}^{\\mathrm{true}}(t) \\big|}.\n$$\n- 均方根 (RMS) 归一化误差\n$$\n\\varepsilon_{\\mathrm{rms}} \\;=\\; \\frac{\\sqrt{\\frac{1}{|\\mathcal{W}|} \\sum_{t \\in \\mathcal{W}} \\big( I_{\\mathrm{Na}}^{\\mathrm{true}}(t) - I_{\\mathrm{Na}}^{\\mathrm{qss}}(t) \\big)^2}}{\\max_{t \\in \\mathcal{W}} \\big| I_{\\mathrm{Na}}^{\\mathrm{true}}(t) \\big|}.\n$$\n如果 $\\mathcal{W}$ 为空或 $\\max_{t \\in \\mathcal{W}} |I_{\\mathrm{Na}}^{\\mathrm{true}}(t)| = 0$，则将两个误差均定义为 $0$。\n\n测试套件。对以下四个参数集运行模拟，每个参数集由 $(I_0, T_{\\mathrm{inj}}, s_m)$ 描述：\n- 案例 $1$：$(10,\\, 2.5,\\, 1.0)$，\n- 案例 $2$：$(10,\\, 2.5,\\, 0.5)$，\n- 案例 $3$：$(10,\\, 2.5,\\, 2.0)$，\n- 案例 $4$：$(15,\\, 2.0,\\, 1.0)$。\n\n程序要求：\n- 完全按照说明实现模型和计算，使用指定的单位。\n- 使用不大于 $\\Delta t = 0.005\\,\\mathrm{ms}$ 的固定步长和 $T_{\\mathrm{end}} = 5\\,\\mathrm{ms}$ 的总时长。\n- 对于每个案例，计算在 $\\mathcal{W}$ 上的 $(\\varepsilon_{\\max}, \\varepsilon_{\\mathrm{rms}})$。\n- 将最终答案表示为四舍五入到 $6$ 位小数的十进制浮点数（输出中不含单位符号）。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个逗号分隔的列表，内含对应于案例 $1$ 到 $4$ 的 $8$ 个浮点数，顺序为 $[\\varepsilon_{\\max}^{(1)}, \\varepsilon_{\\mathrm{rms}}^{(1)}, \\varepsilon_{\\max}^{(2)}, \\varepsilon_{\\mathrm{rms}}^{(2)}, \\varepsilon_{\\max}^{(3)}, \\varepsilon_{\\mathrm{rms}}^{(3)}, \\varepsilon_{\\max}^{(4)}, \\varepsilon_{\\mathrm{rms}}^{(4)}]$，并用方括号括起来（例如，$[0.012345,0.006789,\\dots]$）。", "solution": "所提出的问题是计算神经科学中的一个标准练习，经过严格审查后被认为是有效的。它科学地基于经典的 Hodgkin-Huxley 模型，问题设定良好（well-posed），提供了所有必要的参数和条件，并以客观、明确的语言表述。我们将着手进行解答。\n\n任务是量化由钠通道激活门控变量 $m$ 的准稳态 (QSS) 近似所引入的误差。该近似 $m(t) \\approx m_{\\infty}(V(t))$ 假设激活门对膜电压 $V$ 的变化做出瞬时响应。我们将通过模拟完整的 Hodgkin-Huxley 模型，并将真实的钠电流 $I_{\\mathrm{Na}}^{\\mathrm{true}}$ 与近似电流 $I_{\\mathrm{Na}}^{\\mathrm{qss}}$（其中 $m(t)$ 被 $m_{\\infty}(V(t))$ 替代）进行比较，来评估这一近似的准确性。\n\n问题的核心是求解一个由四个耦合一阶常微分方程 (ODE) 组成的方程组的数值解，该方程组描述了膜电压 $V$ 和三个门控变量 $m$、$h$ 和 $n$ 的时间演化：\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(t, \\mathbf{y}), \\quad \\text{where} \\quad \\mathbf{y}(t) = [V(t), m(t), h(t), n(t)]^T.\n$$\n向量函数 $\\mathbf{F}$ 的分量由以下公式给出：\n$$\n\\frac{dV}{dt} = \\frac{1}{C_{\\mathrm{m}}} \\left( I_{\\mathrm{ext}}(t) - \\bar{g}_{\\mathrm{Na}}\\,m^3 h\\,(V - E_{\\mathrm{Na}}) - \\bar{g}_{\\mathrm{K}}\\,n^4\\,(V - E_{\\mathrm{K}}) - \\bar{g}_{\\mathrm{L}}\\,(V - E_{\\mathrm{L}}) \\right)\n$$\n$$\n\\frac{dm}{dt} = s_m \\left( \\alpha_m(V)\\,(1-m) - \\beta_m(V)\\,m \\right)\n$$\n$$\n\\frac{dh}{dt} = \\alpha_h(V)\\,(1-h) - \\beta_h(V)\\,h\n$$\n$$\n\\frac{dn}{dt} = \\alpha_n(V)\\,(1-n) - \\beta_n(V)\\,n\n$$\n速率函数 $\\alpha_x(V)$ 和 $\\beta_x(V)$ 在问题描述中已给出。注意，在 $m$ 门动力学中包含了动力学缩放因子 $s_m$。外部电流 $I_{\\mathrm{ext}}(t)$ 是一个简单的阶跃函数。\n\n该系统在对应于 $V(0) = -65\\,\\mathrm{mV}$ 的静息状态下进行初始化。门控变量的初始值是它们在该电压下的稳态值：$m(0) = m_{\\infty}(-65)$，$h(0) = h_{\\infty}(-65)$ 和 $n(0) = n_{\\infty}(-65)$，其中对于任何门控变量 $x \\in \\{m, h, n\\}$，其稳态函数为 $x_{\\infty}(V) = \\frac{\\alpha_x(V)}{\\alpha_x(V) + \\beta_x(V)}$。\n\n我们将采用经典的四阶龙格－库塔 (RK4) 方法进行数值积分。对于给定的时间步长 $\\Delta t$，在时间 $t_{i+1} = t_i + \\Delta t$ 的状态向量 $\\mathbf{y}_{i+1}$ 是根据 $\\mathbf{y}_i$ 按如下方式计算的：\n$$\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{F}(t_i, \\mathbf{y}_i)\n$$\n$$\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{F}(t_i + \\frac{\\Delta t}{2}, \\mathbf{y}_i + \\frac{\\mathbf{k}_1}{2})\n$$\n$$\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{F}(t_i + \\frac{\\Delta t}{2}, \\mathbf{y}_i + \\frac{\\mathbf{k}_2}{2})\n$$\n$$\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{F}(t_i + \\Delta t, \\mathbf{y}_i + \\mathbf{k}_3)\n$$\n$$\n\\mathbf{y}_{i+1} = \\mathbf{y}_i + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n在总时长 $T_{\\mathrm{end}} = 5\\,\\mathrm{ms}$ 内重复此过程，时间步长为 $\\Delta t=0.005\\,\\mathrm{ms}$。\n\n一个特定的计算细节是处理速率函数 $\\alpha_m(V)$ 和 $\\alpha_n(V)$ 中的可去奇点。例如，$\\alpha_m(V)$ 在 $V = -40\\,\\mathrm{mV}$ 处有一个 $0/0$ 的不定式。应用洛必达法则可得其极限：\n$$\n\\lim_{V \\to -40} \\alpha_m(V) = \\lim_{V \\to -40} \\frac{0.1\\,(V+40)}{1 - e^{-(V+40)/10}} = 1.0\\,\\mathrm{ms}^{-1}.\n$$\n类似地，对于在 $V = -55\\,\\mathrm{mV}$ 处的 $\\alpha_n(V)$：\n$$\n\\lim_{V \\to -55} \\alpha_n(V) = \\lim_{V \\to -55} \\frac{0.01\\,(V+55)}{1 - e^{-(V+55)/10}} = 0.1\\,\\mathrm{ms}^{-1}.\n$$\n在实现中必须对这些情况进行显式处理，以确保数值稳定性。\n\n在模拟生成 $V(t)$、$m(t)$ 和 $h(t)$ 的时间序列后，我们计算两种钠电流：\n$$\nI_{\\mathrm{Na}}^{\\mathrm{true}}(t) = \\bar{g}_{\\mathrm{Na}}\\,m(t)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}})\n$$\n$$\nI_{\\mathrm{Na}}^{\\mathrm{qss}}(t) = \\bar{g}_{\\mathrm{Na}}\\,\\big(m_{\\infty}(V(t))\\big)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}})\n$$\n其中 $m_{\\infty}(V(t)) = \\frac{\\alpha_m(V(t))}{\\alpha_m(V(t)) + \\beta_m(V(t))}$。\n\n分析仅限于动作电位上升支，即电压在 $-55\\,\\mathrm{mV}$ 和 $0\\,\\mathrm{mV}$ 之间的时间窗口 $\\mathcal{W}$。在此窗口内，我们计算电流之间的绝对差，找出该差值的最大值，并计算差值的均方根。两个结果都通过真实钠电流的最大绝对值 $\\max_{t \\in \\mathcal{W}} |I_{\\mathrm{Na}}^{\\mathrm{true}}(t)|$ 进行归一化，以获得无量纲误差指标 $\\varepsilon_{\\max}$ 和 $\\varepsilon_{\\mathrm{rms}}$。如果动作电位上升支的条件未满足（即 $\\mathcal{W}$ 为空），则误差定义为 $0$。\n\n对四个指定的测试案例均执行此完整过程，并将得到的八个误差值按要求格式化。缩放因子 $s_m$ 直接调节 $m$ 门控的时间常数 $\\tau_m$。当 $s_m < 1$ 时，动力学较慢，我们预期 QSS 近似的准确性会降低。当 $s_m > 1$ 时，动力学较快，QSS 近似的准确性应会提高。跨案例的比较将定量地展示这种依赖关系。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hodgkin-Huxley model problem and calculates QSS errors.\n    \"\"\"\n\n    # Biophysical parameters\n    C_m = 1.0  # uF/cm^2\n    g_Na_bar = 120.0  # mS/cm^2\n    g_K_bar = 36.0  # mS/cm^2\n    g_L = 0.3  # mS/cm^2\n    E_Na = 50.0  # mV\n    E_K = -77.0  # mV\n    E_L = -54.4  # mV\n\n    # Simulation parameters\n    T_end = 5.0  # ms\n    dt = 0.005  # ms\n\n    # Rate functions\n    def alpha_m(V):\n        if np.isclose(V, -40.0):\n            return 1.0\n        return 0.1 * (V + 40.0) / (1.0 - np.exp(-(V + 40.0) / 10.0))\n\n    def beta_m(V):\n        return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\n    def alpha_h(V):\n        return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\n    def beta_h(V):\n        return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n\n    def alpha_n(V):\n        if np.isclose(V, -55.0):\n            return 0.1\n        return 0.01 * (V + 55.0) / (1.0 - np.exp(-(V + 55.0) / 10.0))\n\n    def beta_n(V):\n        return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\n    # Steady-state functions\n    def x_inf(V, alpha_func, beta_func):\n        return alpha_func(V) / (alpha_func(V) + beta_func(V))\n\n    def m_inf(V):\n        return x_inf(V, alpha_m, beta_m)\n\n    def h_inf(V):\n        return x_inf(V, alpha_h, beta_h)\n\n    def n_inf(V):\n        return x_inf(V, alpha_n, beta_n)\n\n    # ODE system definition\n    def F(t, y, I_0, T_inj, s_m):\n        V, m, h, n = y\n        \n        # External current\n        I_ext = I_0 if 0 <= t <= T_inj else 0.0\n        \n        # Ionic currents\n        I_Na = g_Na_bar * (m**3) * h * (V - E_Na)\n        I_K = g_K_bar * (n**4) * (V - E_K)\n        I_L = g_L * (V - E_L)\n        \n        # Derivatives\n        dV_dt = (I_ext - I_Na - I_K - I_L) / C_m\n        dm_dt = s_m * (alpha_m(V) * (1.0 - m) - beta_m(V) * m)\n        dh_dt = alpha_h(V) * (1.0 - h) - beta_h(V) * h\n        dn_dt = alpha_n(V) * (1.0 - n) - beta_n(V) * n\n        \n        return np.array([dV_dt, dm_dt, dh_dt, dn_dt])\n\n    def run_simulation(I_0, T_inj, s_m):\n        # Time steps\n        t_steps = np.arange(0, T_end + dt, dt)\n        num_steps = len(t_steps)\n        \n        # Initial conditions\n        V0 = -65.0\n        y = np.zeros((num_steps, 4))\n        y[0] = [V0, m_inf(V0), h_inf(V0), n_inf(V0)]\n        \n        # RK4 Integration\n        for i in range(num_steps - 1):\n            t = t_steps[i]\n            \n            k1 = dt * F(t, y[i], I_0, T_inj, s_m)\n            k2 = dt * F(t + 0.5 * dt, y[i] + 0.5 * k1, I_0, T_inj, s_m)\n            k3 = dt * F(t + 0.5 * dt, y[i] + 0.5 * k2, I_0, T_inj, s_m)\n            k4 = dt * F(t + dt, y[i] + k3, I_0, T_inj, s_m)\n            \n            y[i+1] = y[i] + (k1 + 2*k2 + 2*k3 + k4) / 6.0\n            \n        V_t, m_t, h_t, n_t = y[:,0], y[:,1], y[:,2], y[:,3]\n        \n        # Post-processing and error calculation\n        \n        # Find analysis window\n        upstroke_indices = np.where((V_t > -55.0) & (V_t < 0.0))[0]\n        \n        if len(upstroke_indices) == 0:\n            return 0.0, 0.0\n\n        # Calculate currents\n        V_w = V_t[upstroke_indices]\n        m_w = m_t[upstroke_indices]\n        h_w = h_t[upstroke_indices]\n\n        # m_inf for QSS calculation, vectorize calculation\n        m_inf_vec = np.vectorize(m_inf)\n        m_inf_w = m_inf_vec(V_w)\n        \n        I_Na_true = g_Na_bar * (m_w**3) * h_w * (V_w - E_Na)\n        I_Na_qss = g_Na_bar * (m_inf_w**3) * h_w * (V_w - E_Na)\n        \n        # Normalization factor\n        norm_factor = np.max(np.abs(I_Na_true))\n        \n        if np.isclose(norm_factor, 0.0):\n            return 0.0, 0.0\n        \n        # Error metrics\n        error_diff = I_Na_true - I_Na_qss\n        \n        e_max = np.max(np.abs(error_diff)) / norm_factor\n        \n        rms_error_val = np.sqrt(np.mean(error_diff**2))\n        e_rms = rms_error_val / norm_factor\n        \n        return e_max, e_rms\n\n    # Test cases\n    test_cases = [\n        (10.0, 2.5, 1.0),  # Case 1\n        (10.0, 2.5, 0.5),  # Case 2\n        (10.0, 2.5, 2.0),  # Case 3\n        (15.0, 2.0, 1.0),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        I_0, T_inj, s_m = case\n        e_max, e_rms = run_simulation(I_0, T_inj, s_m)\n        results.append(f\"{e_max:.6f}\")\n        results.append(f\"{e_rms:.6f}\")\n\n    # Final print statement\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2763689"}]}