{"hands_on_practices": [{"introduction": "虽然标准的ABO血型遗传交叉对许多人来说已经很熟悉了，但真实的生物系统往往更为复杂。本练习通过引入H基因座的上位效应（即孟买表型）来深化理解，它演示了一个基因如何掩盖另一个完全不同基因座的表型表达。通过将经典的孟德尔遗传与群体遗传学原理相结合，您将练习如何在一个更真实的遗传框架下，根据等位基因频率计算后代表型的概率。[@problem_id:2772052]", "problem": "在人类ABO血型系统中，ABO基因座有三个等位基因，表示为$I^{A}$、$I^{B}$和$i$。等位基因$I^{A}$和$I^{B}$彼此之间为共显性，且二者对$i$均为显性。要在红细胞上表达ABO抗原，需要一个由$H$基因座编码的、功能正常的岩藻糖基转移酶；$H$基因座基因型为$hh$的个体无法合成所需的底物（孟买血型），因此无论其ABO基因型如何，其红细胞上均不表现出ABO抗原，从而表现为O型血。假设$ABO$和$H$基因座位于不同染色体上，且独立分配。\n\n两位基因型已知的亲本交配：在ABO基因座上，一方为$I^{A}i$，另一方为$I^{B}i$。亲本的$H$基因座基因型未知，但群体中无效等位基因$h$的频率为$f \\in (0,1)$，且$H$基因座处于哈迪-温伯格平衡状态，其中$H$的等位基因频率为$1-f$，$h$的等位基因频率为$f$。\n\n使用庞氏表、孟德尔分离定律和自由组合定律，从第一性原理出发，推导$I^{A}i \\times I^{B}i$杂交后代的ABO基因型分布，然后结合上位性的$H$基因座，得出后代$AB$、$A$、$B$和$O$表现型的概率（用$f$表示）。通过明确推理$hh$的作用，解释为何这次杂交可以产生所有四种表现型。\n\n表现型为$AB$的后代所占的期望比例是多少（作为$f$的函数）？请将您的最终答案表示为关于$f$的单个简化代数表达式。", "solution": "基本原理如下：\n\n- 在$ABO$基因座上，等位基因$I^{A}$和$I^{B}$彼此共显性，且各自对$i$为显性。根据孟德尔分离定律，每个亲本从其一对等位基因中随机遗传一个。\n\n- 在$H$基因座上，基因型$hh$对$ABO$基因座具有上位性，导致红细胞上不产生ABO抗原；因此，任何$ABO$基因型与$hh$配对都会产生$O$型表现型。一个孩子要表现为非$O$型，其必须携带至少一个$H$等位基因。$ABO$和$H$基因座独立分配。\n\n- 在$H$基因座处于哈迪-温伯格平衡状态，且$H$的等位基因频率为$1-f$，$h$的等位基因频率为$f$的情况下，随机交配意味着后代的$H$基因座基因型频率为：$HH$为$(1-f)^{2}$，$Hh$为$2f(1-f)$，$hh$为$f^{2}$。\n\n步骤 1：推导$I^{A}i \\times I^{B}i$杂交的$ABO$基因型分布。\n\n构建$ABO$基因座的庞氏表。第一个亲本（$I^{A}i$）产生$I^{A}$和$i$两种配子的概率均为$1/2$；第二个亲本（$I^{B}i$）产生$I^{B}$和$i$两种配子的概率均为$1/2$。组合这些配子：\n\n- 来自第一个亲本的$I^{A}$和来自第二个亲本的$I^{B}$结合，产生$I^{A}I^{B}$的概率为$1/2 \\times 1/2 = 1/4$。\n\n- 来自第一个亲本的$I^{A}$和来自第二个亲本的$i$结合，产生$I^{A}i$的概率为$1/4$。\n\n- 来自第一个亲本的$i$和来自第二个亲本的$I^{B}$结合，产生$I^{B}i$的概率为$1/4$。\n\n- 来自第一个亲本的$i$和来自第二个亲本的$i$结合，产生$ii$的概率为$1/4$。\n\n因此，后代中的$ABO$基因型分布为：\n$$\nP(I^{A}I^{B})=\\frac{1}{4},\\quad P(I^{A}i)=\\frac{1}{4},\\quad P(I^{B}i)=\\frac{1}{4},\\quad P(ii)=\\frac{1}{4}.\n$$\n\n步骤 2：将$ABO$基因型映射到以$H$基因座为条件的表现型，并考虑上位性效应。\n\n- 如果孩子在$H$基因座上的基因型是$hh$，则无论$ABO$基因型如何，其表现型均为$O$。\n\n- 如果孩子的基因型是$H\\_$（即$HH$或$Hh$），则：\n  - $I^{A}I^{B}$表现为$AB$型。\n  - $I^{A}i$表现为$A$型。\n  - $I^{B}i$表现为$B$型。\n  - $ii$表现为$O$型。\n\n因此，对于除$O$型以外的任何表现型，孩子必须是$H\\_$。\n\n步骤 3：确定孩子基因型为$H\\_$的概率。\n\n在$H$基因座上，根据哈迪-温伯格平衡和随机交配，且$h$的等位基因频率为$f$，后代在$H$基因座上的基因型频率为：\n$$\nP(HH)=(1-f)^{2},\\quad P(Hh)=2f(1-f),\\quad P(hh)=f^{2}.\n$$\n因此，\n$$\nP(H\\_)=P(HH)+P(Hh) = 1 - P(hh) = 1 - f^{2}.\n$$\n\n由于$ABO$和$H$基因座之间是独立分配的，一个孩子同时具有$ABO$基因型$I^{A}I^{B}$且基因型为$H\\_$的联合概率是边际概率的乘积：\n$$\nP\\big(I^{A}I^{B}\\ \\text{且}\\ H\\_\\big) = P(I^{A}I^{B}) \\times P(H\\_) = \\frac{1}{4}\\,(1 - f^{2}).\n$$\n\n步骤 4：确定所求的数量。\n\n$AB$表现型需要$ABO$基因型为$I^{A}I^{B}$且$H$基因座为$H\\_$。因此，表现型为$AB$的后代所占的期望比例是：\n$$\n\\frac{1}{4}\\,(1 - f^{2}).\n$$\n\n为完整起见（以解释所有四种表现型出现的原因），请注意，通过类似的推理：\n- $P(\\text{表现型 }A) = \\frac{1}{4}\\,(1 - f^{2})$。\n- $P(\\text{表现型 }B) = \\frac{1}{4}\\,(1 - f^{2})$。\n- $P(\\text{表现型 }O) = P(hh) + P(ii \\ \\text{且}\\ H\\_) = f^{2} + \\frac{1}{4}\\,(1 - f^{2}) = \\frac{1}{4} + \\frac{3}{4}f^{2}$。\n\n这些概率之和为$1$：\n$$\n\\frac{1}{4}(1 - f^{2}) + \\frac{1}{4}(1 - f^{2}) + \\frac{1}{4}(1 - f^{2}) + \\left(\\frac{1}{4} + \\frac{3}{4}f^{2}\\right) = 1,\n$$\n并展示了$hh$的上位性效应如何在$ii$基因型之外创造额外的$O$型表现型，而$H\\_$则允许了$I^{A}i \\times I^{B}i$杂交中$AB$、$A$和$B$型表现型的表达。\n\n所求的最终量是$AB$表现型所占的比例：\n$$\n\\frac{1}{4}\\,(1 - f^{2}).\n$$", "answer": "$$\\boxed{\\frac{1 - f^{2}}{4}}$$", "id": "2772052"}, {"introduction": "ABO血型系统的标准三等位基因模型（$I^A$、$I^B$ 和 $i$）是一个有效的简化，但等位基因的多样性远不止于此。本练习介绍了一种罕见的$\\mathrm{cis}\\!-\\!AB$等位基因，它编码一种具有双重催化活性的糖基转移酶，从根本上挑战了传统的遗传模型。您将通过此例探索不完全外显率这一重要概念，即单一基因型如何因表达变异而产生多种表型，并学习使用概率方法来预测遗传结果。[@problem_id:2772066]", "problem": "ABO血型系统的一个单基因座模型假设，ABO基因含有编码糖基转移酶活性的等位基因，这些活性决定了红细胞的抗原表型：等位基因 $A$ 编码 $\\alpha$-$N$-乙酰半乳糖胺转移酶（A活性），等位基因 $B$ 编码 $\\alpha$-半乳糖基转移酶（B活性），而等位基因 $i$（历史上称为 $O$）是一个无酶活性的无效等位基因。一个罕见的重组等位基因，记作 $\\mathrm{cis}\\!-\\!AB$，编码一种对 $A$ 和 $B$ 决定簇具有双重特异性的单一糖基转移酶，并已知其在标准血清学检测中表现出可变表现度和不完全外显。假设减数分裂遵循Mendel分离定律，并且不存在分离畸变。\n\n考虑一个 $\\mathrm{cis}\\!-\\!AB/i$ 亲本与一个 $i/i$ 亲本之间的交配。在一个经过验证的固定表型分型方案下，基因型 $\\mathrm{cis}\\!-\\!AB/i$ 被分类为以下几种血清学表型，其外显率概率如下：\n- $P(\\text{表型 }A \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.22$，\n- $P(\\text{表型 }B \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.15$，\n- $P(\\text{表型 }AB \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.62$，\n- $P(\\text{表型 }O \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.01$，\n它们的总和为 $1.00$。\n\n对于基因型 $i/i$，假设 $P(\\text{表型 }O \\mid i/i) = 1.00$ 且 $P(\\text{任何其他表型} \\mid i/i) = 0$。\n\n仅使用上述定义、Mendel分离定律和全概率定律，推导这种交配如何能在子代中产生所有四种ABO表型，并计算后代中表型 $A$、$B$、$AB$ 和 $O$ 的预期频率。按 $A, B, AB, O$ 的顺序，以总和为 $1$ 的小数形式报告这四种频率，并将最终报告的数字四舍五入到四位有效数字。不要在答案中使用百分号。", "solution": "所述问题是有效的。它在科学上基于Mendel遗传学原理和概率论。其提法恰当，为获得唯一解提供了所有必要的数据和定义，没有内部矛盾或歧义。该情景涉及罕见的 $\\mathrm{cis}\\!-\\!AB$ 等位基因及其已知的不完全外显特性，是人类遗传学中一个有效但并非简单的难题。\n\n求解过程需要两个主要步骤：首先，使用Mendel分离定律确定可能的子代基因型的概率；其次，应用全概率定律，使用给定的外显率概率来计算每种表型的预期频率。\n\n设等位基因记为 $\\mathcal{A}_{\\mathrm{cisAB}}$, $\\mathcal{A}_A$, $\\mathcal{A}_B$ 和 $\\mathcal{A}_i$。问题中使用了 $\\mathrm{cis}\\!-\\!AB$, $A$, $B$ 和 $i$ 的记法。我们将遵循问题的记法。\n\n交配发生在一个基因型为 $\\mathrm{cis}\\!-\\!AB/i$ 的亲本与一个基因型为 $i/i$ 的亲本之间。\n根据Mendel分离定律，每个亲本以相等的概率将其两个等位基因中的一个传递给子代。不存在分离畸变，因此对于来自杂合子亲本的每个等位基因，其传递概率正好是 $\\frac{1}{2}$。\n\n亲本1（基因型为 $\\mathrm{cis}\\!-\\!AB/i$）产生两种类型的配子：\n\\begin{itemize}\n    \\item 带有等位基因 $\\mathrm{cis}\\!-\\!AB$ 的配子，概率为 $P(\\text{配子} = \\mathrm{cis}\\!-\\!AB) = 0.5$。\n    \\item 带有等位基因 $i$ 的配子，概率为 $P(\\text{配子} = i) = 0.5$。\n\\end{itemize}\n\n亲本2（基因型为 $i/i$）只产生一种类型的配子：\n\\begin{itemize}\n    \\item 带有等位基因 $i$ 的配子，概率为 $P(\\text{配子} = i) = 1.0$。\n\\end{itemize}\n\n子代的基因型及其概率由每个亲本的配子组合决定。\n\\begin{enumerate}\n    \\item 子代基因型 $\\mathrm{cis}\\!-\\!AB/i$：这是由来自亲本1的 $\\mathrm{cis}\\!-\\!AB$ 配子和来自亲本2的 $i$ 配子融合而成的。\n    概率为 $P(G=\\mathrm{cis}\\!-\\!AB/i) = 0.5 \\times 1.0 = 0.5$。\n    \\item 子代基因型 $i/i$：这是由来自亲本1的 $i$ 配子和来自亲本2的 $i$ 配子融合而成的。\n    概率为 $P(G=i/i) = 0.5 \\times 1.0 = 0.5$。\n\\end{enumerate}\n子代基因型概率之和为 $0.5 + 0.5 = 1.0$，正如预期。\n\n问题要求子代中表型 $A$、$B$、$AB$ 和 $O$ 的预期频率。我们使用全概率定律。对于任何表型 $\\Phi$，其概率是在给定每种可能基因型下该表型的条件概率之和，并按每种基因型的概率加权：\n$$P(\\Phi=\\phi) = \\sum_{G_j} P(\\Phi=\\phi \\mid G=G_j) \\times P(G=G_j)$$\n其中求和遍历所有可能的子代基因型 $G_j$。在本例中，基因型为 $G_1 = \\mathrm{cis}\\!-\\!AB/i$ 和 $G_2 = i/i$。\n\n给定的条件概率（外显率值）是：\n\\begin{itemize}\n    \\item $P(\\text{表型 } A \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.22$\n    \\item $P(\\text{表型 } B \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.15$\n    \\item $P(\\text{表型 } AB \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.62$\n    \\item $P(\\text{表型 } O \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.01$\n\\end{itemize}\n而对于 $i/i$ 基因型：\n\\begin{itemize}\n    \\item $P(\\text{表型 } O \\mid i/i) = 1.00$\n    \\item $P(\\text{任何其他表型} \\mid i/i) = 0$\n\\end{itemize}\n\n使用这些信息，我们计算每种表型的概率：\n\n1.  **表型A频率：**\n    $$P(A) = P(A \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(A \\mid i/i)P(i/i)$$\n    $$P(A) = (0.22)(0.5) + (0)(0.5) = 0.11$$\n\n2.  **表型B频率：**\n    $$P(B) = P(B \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(B \\mid i/i)P(i/i)$$\n    $$P(B) = (0.15)(0.5) + (0)(0.5) = 0.075$$\n\n3.  **表型AB频率：**\n    $$P(AB) = P(AB \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(AB \\mid i/i)P(i/i)$$\n    $$P(AB) = (0.62)(0.5) + (0)(0.5) = 0.31$$\n\n4.  **表型O频率：**\n    $$P(O) = P(O \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(O \\mid i/i)P(i/i)$$\n    $$P(O) = (0.01)(0.5) + (1.00)(0.5) = 0.005 + 0.5 = 0.505$$\n\n这个推导解释了这次交配如何能产生所有四种表型。子代群体是两种基因型的混合体。$i/i$ 个体将总是表现为O型表型。$\\mathrm{cis}\\!-\\!AB/i$ 个体由于不完全外显，可以表现出四种表型中的任何一种，尽管概率不同。这些结果的加权和导致整个子代群体中的所有四种表型都具有非零概率。\n\n为了验证，表型频率的总和是：\n$P(A) + P(B) + P(AB) + P(O) = 0.11 + 0.075 + 0.31 + 0.505 = 1.0$。\n\n问题要求以小数形式报告频率，并四舍五入到四位有效数字。\n\\begin{itemize}\n    \\item $P(A) = 0.11 \\to 0.1100$\n    \\item $P(B) = 0.075 \\to 0.07500$\n    \\item $P(AB) = 0.31 \\to 0.3100$\n    \\item $P(O) = 0.505 \\to 0.5050$\n\\end{itemize}\n对于表型 $A, B, AB, O$ 的最终频率分别为 $0.1100$, $0.07500$, $0.3100$ 和 $0.5050$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1100 & 0.07500 & 0.3100 & 0.5050\n\\end{pmatrix}\n}\n$$", "id": "2772066"}, {"introduction": "遗传学研究的范畴从个体延伸至整个群体。在群体遗传学中，我们常常需要从可观察的表型数据反推群体的遗传构成。本练习提供了一个应用统计学方法解决实际遗传学问题的机会，您将学习如何使用最大似然估计法来推断ABO血型系统的等位基因频率，并利用卡方检验来验证该群体是否符合哈迪-温伯格平衡模型。[@problem_id:2772123]", "problem": "在ABO血型系统中，等位基因 $I^{A}$ 和 $I^{B}$ 是共显性的，而等位基因 $i$ 是隐性的。在随机交配且没有进化力量作用的情况下，基因型频率由 Hardy–Weinberg 平衡（HWE）预测，而表型则通过从基因型到表型的确定性映射产生：表型 $A$ 对应于基因型 $I^{A}I^{A}$ 和 $I^{A}i$，表型 $B$ 对应于 $I^{B}I^{B}$ 和 $I^{B}i$，表型 $AB$ 对应于 $I^{A}I^{B}$，表型 $O$ 对应于 $ii$。设群体等位基因频率为 $p=\\Pr(I^{A})$、$q=\\Pr(I^{B})$ 和 $r=\\Pr(i)$，且满足 $p+q+r=1$。\n\n从一个 $n=900$ 个个体的随机样本中，得到以下表型计数：$x_{A}=315$、$x_{B}=315$、$x_{AB}=180$ 和 $x_{O}=90$。\n\n假设一个多项式抽样模型，并满足 HWE 和 ABO 表型-基因型映射，请从第一性原理出发完成以下任务：\n1. 将观测计数的似然写成关于 $p$、$q$ 和 $r$ 的函数。\n2. 在 $p+q+r=1$ 的约束下，确定最大似然估计值 $\\hat{p}$、$\\hat{q}$ 和 $\\hat{r}$。\n3. 使用这些估计值，计算 Pearson 卡方拟合优度统计量，以比较 HWE ABO 模型下的观测表型计数和期望表型计数。\n\n将卡方统计量的数值作为最终答案报告，四舍五入到四位有效数字。不要报告 $p$ 值。最终答案以纯数字形式表示，不带任何单位或符号。", "solution": "该问题具有科学依据，提法严谨且客观。这是群体遗传学和统计推断中的一个标准问题，其表述清晰，数据充分，可得出唯一解。该问题是有效的。\n\n解题过程按题目要求分为三个步骤。\n\n步骤 1：似然函数\n\n题目假设群体处于 Hardy–Weinberg 平衡（HWE）状态。设等位基因 $I^{A}$、$I^{B}$ 和 $i$ 的频率分别为 $p$、$q$ 和 $r$，且满足约束 $p+q+r=1$。在 HWE 下，基因型频率由 $(p+q+r)^2$ 的展开项给出：\n- $\\Pr(I^{A}I^{A}) = p^2$\n- $\\Pr(I^{B}I^{B}) = q^2$\n- $\\Pr(ii) = r^2$\n- $\\Pr(I^{A}I^{B}) = 2pq$\n- $\\Pr(I^{A}i) = 2pr$\n- $\\Pr(I^{B}i) = 2qr$\n\n表型概率（$\\pi_A, \\pi_B, \\pi_{AB}, \\pi_O$）通过对相应基因型的频率求和得出：\n- $\\pi_A = \\Pr(\\text{表型 A}) = \\Pr(I^{A}I^{A}) + \\Pr(I^{A}i) = p^2 + 2pr$\n- $\\pi_B = \\Pr(\\text{表型 B}) = \\Pr(I^{B}I^{B}) + \\Pr(I^{B}i) = q^2 + 2qr$\n- $\\pi_{AB} = \\Pr(\\text{表型 AB}) = \\Pr(I^{A}I^{B}) = 2pq$\n- $\\pi_O = \\Pr(\\text{表型 O}) = \\Pr(ii) = r^2$\n\n这些概率的总和为 $(p^2+2pr) + (q^2+2qr) + 2pq + r^2 = p^2+q^2+r^2+2pq+2pr+2qr = (p+q+r)^2 = 1^2 = 1$，符合要求。\n\n假设在一个大小为 $n$ 的样本中，观测到的表型计数（$x_{A}$、$x_{B}$、$x_{AB}$、$x_{O}$）服从多项式分布。似然函数 $L(p, q, r)$ 与观测到这些计数的概率成正比：\n$$L(p, q, r) \\propto \\pi_A^{x_A} \\pi_B^{x_B} \\pi_{AB}^{x_{AB}} \\pi_O^{x_O}$$\n代入表型概率的表达式，作为等位基因频率 $p$、$q$ 和 $r$ 的函数，似然函数为：\n$$L(p, q, r) \\propto (p^2+2pr)^{x_A} (q^2+2qr)^{x_B} (2pq)^{x_{AB}} (r^2)^{x_O}$$\n\n步骤 2：$p, q, r$ 的最大似然估计\n\n给定的观测计数为：$x_{A}=315$、$x_{B}=315$、$x_{AB}=180$ 和 $x_{O}=90$。总样本量为 $n = 315+315+180+90 = 900$。\n为求得最大似然估计（MLEs）$\\hat{p}$、$\\hat{q}$ 和 $\\hat{r}$，我们必须在约束条件 $p+q+r=1$ 下最大化对数似然函数 $\\ell(p,q,r) = \\ln L(p,q,r)$。\n$$\\ell(p,q,r) = x_A \\ln(p^2+2pr) + x_B \\ln(q^2+2qr) + x_{AB} \\ln(2pq) + x_O \\ln(r^2) + C$$\n其中 $C$ 是一个常数。\n\n观测数据显示出一种对称性：$x_A = x_B = 315$。在 $x_A=x_B$ 的条件下，似然函数关于 $p$ 和 $q$ 的互换是对称的。如果存在唯一的最大值，它必定出现在 $p=q$ 的地方。因此，我们可以通过施加条件 $\\hat{p}=\\hat{q}$ 来找到最大似然估计。\n\n当 $p=q$ 时，约束条件 $p+q+r=1$ 简化为 $2p+r=1$，即 $r=1-2p$。我们需要 $p \\ge 0$ 和 $r \\ge 0$，这意味着 $1-2p \\ge 0$，即 $p \\le \\frac{1}{2}$。因此，解必须位于区间 $0 \\le p \\le \\frac{1}{2}$ 内。\n\n我们将对数似然重写为仅关于 $p$ 的函数：\n$$\\ell(p) = (x_A+x_B) \\ln(p^2+2pr) + x_{AB} \\ln(2p^2) + x_O \\ln(r^2) + C'$$\n代入 $r=1-2p$：\n$$\\ell(p) = (x_A+x_B) \\ln(p^2+2p(1-2p)) + x_{AB} \\ln(2p^2) + x_O \\ln((1-2p)^2) + C'$$\n$$\\ell(p) = (x_A+x_B) \\ln(2p-3p^2) + x_{AB}(2\\ln p + \\ln 2) + 2x_O \\ln(1-2p) + C'$$\n为求最大值，我们对 $p$ 求导并令其为零：\n$$\\frac{d\\ell}{dp} = (x_A+x_B)\\frac{2-6p}{2p-3p^2} + \\frac{2x_{AB}}{p} + 2x_O\\frac{-2}{1-2p} = 0$$\n$$\\frac{d\\ell}{dp} = (x_A+x_B)\\frac{2(1-3p)}{p(2-3p)} + \\frac{2x_{AB}}{p} - \\frac{4x_O}{1-2p} = 0$$\n代入观测计数 $x_A=315, x_B=315, x_{AB}=180, x_O=90$：\n$$630\\frac{2(1-3p)}{p(2-3p)} + \\frac{2(180)}{p} - \\frac{4(90)}{1-2p} = 0$$\n$$630\\frac{2(1-3p)}{p(2-3p)} + \\frac{360}{p} - \\frac{360}{1-2p} = 0$$\n乘以 $p(2-3p)(1-2p)$ 以消去分母（假设 $p \\neq 0, \\frac{2}{3}, \\frac{1}{2}$）：\n$$1260(1-3p)(1-2p) + 360(2-3p)(1-2p) - 360p(2-3p) = 0$$\n除以 360：\n$$\\frac{7}{2}(1-5p+6p^2) + (2-7p+6p^2) - p(2-3p) = 0$$\n乘以 2：\n$$7(1-5p+6p^2) + 2(2-7p+6p^2) - 2p(2-3p) = 0$$\n$$7 - 35p + 42p^2 + 4 - 14p + 12p^2 - 4p + 6p^2 = 0$$\n$$(42+12+6)p^2 + (-35-14-4)p + (7+4) = 0$$\n$$60p^2 - 53p + 11 = 0$$\n这是一个关于 $p$ 的二次方程。我们使用二次公式求解：\n$$p = \\frac{-(-53) \\pm \\sqrt{(-53)^2 - 4(60)(11)}}{2(60)} = \\frac{53 \\pm \\sqrt{2809 - 2640}}{120} = \\frac{53 \\pm \\sqrt{169}}{120} = \\frac{53 \\pm 13}{120}$$\n这得到两个可能的解：\n$$p_1 = \\frac{53+13}{120} = \\frac{66}{120} = \\frac{11}{20} = 0.55$$\n$$p_2 = \\frac{53-13}{120} = \\frac{40}{120} = \\frac{1}{3}$$\n我们必须强制执行约束 $p \\le \\frac{1}{2}$。解 $p_1 = 0.55$ 是无效的。唯一有效的解是 $p_2 = \\frac{1}{3}$。\n\n最大似然估计值为：\n$\\hat{p} = \\frac{1}{3}$\n因为 $\\hat{p}=\\hat{q}$，我们有 $\\hat{q} = \\frac{1}{3}$。\n根据约束条件 $\\hat{p}+\\hat{q}+\\hat{r}=1$，我们得到 $\\hat{r} = 1 - \\frac{1}{3} - \\frac{1}{3} = \\frac{1}{3}$。\n因此，$\\hat{p} = \\hat{q} = \\hat{r} = \\frac{1}{3}$。\n\n步骤 3：Pearson 卡方拟合优度统计量\n\n使用最大似然估计，我们计算 HWE 模型下的期望表型概率：\n- $E(\\pi_A) = \\hat{p}^2+2\\hat{p}\\hat{r} = (\\frac{1}{3})^2 + 2(\\frac{1}{3})(\\frac{1}{3}) = \\frac{1}{9} + \\frac{2}{9} = \\frac{3}{9} = \\frac{1}{3}$\n- $E(\\pi_B) = \\hat{q}^2+2\\hat{q}\\hat{r} = (\\frac{1}{3})^2 + 2(\\frac{1}{3})(\\frac{1}{3}) = \\frac{1}{9} + \\frac{2}{9} = \\frac{3}{9} = \\frac{1}{3}$\n- $E(\\pi_{AB}) = 2\\hat{p}\\hat{q} = 2(\\frac{1}{3})(\\frac{1}{3}) = \\frac{2}{9}$\n- $E(\\pi_O) = \\hat{r}^2 = (\\frac{1}{3})^2 = \\frac{1}{9}$\n\n接下来，我们计算在 $n=900$ 的样本中每种表型的期望计数（$E_i$）：\n- $E_A = n \\times E(\\pi_A) = 900 \\times \\frac{1}{3} = 300$\n- $E_B = n \\times E(\\pi_B) = 900 \\times \\frac{1}{3} = 300$\n- $E_{AB} = n \\times E(\\pi_{AB}) = 900 \\times \\frac{2}{9} = 200$\n- $E_O = n \\times E(\\pi_O) = 900 \\times \\frac{1}{9} = 100$\n\n观测计数（$O_i$）为 $O_A=315$，$O_B=315$，$O_{AB}=180$，$O_O=90$。\nPearson 卡方统计量 $\\chi^2$ 的计算如下：\n$$\\chi^2 = \\sum_{i \\in \\{A,B,AB,O\\}} \\frac{(O_i - E_i)^2}{E_i}$$\n$$\\chi^2 = \\frac{(315 - 300)^2}{300} + \\frac{(315 - 300)^2}{300} + \\frac{(180 - 200)^2}{200} + \\frac{(90 - 100)^2}{100}$$\n$$\\chi^2 = \\frac{15^2}{300} + \\frac{15^2}{300} + \\frac{(-20)^2}{200} + \\frac{(-10)^2}{100}$$\n$$\\chi^2 = \\frac{225}{300} + \\frac{225}{300} + \\frac{400}{200} + \\frac{100}{100}$$\n$$\\chi^2 = 0.75 + 0.75 + 2 + 1 = 4.5$$\n\n题目要求数值结果四舍五入到四位有效数字。\n计算值为 $4.5$。表示为四位有效数字即为 $4.500$。", "answer": "$$\\boxed{4.500}$$", "id": "2772123"}]}