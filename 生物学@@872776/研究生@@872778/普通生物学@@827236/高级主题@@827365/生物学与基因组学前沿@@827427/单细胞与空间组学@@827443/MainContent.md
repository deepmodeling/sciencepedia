## 引言
单细胞与[空间组学](@entry_id:156223)技术的出现，是近年来生命科学领域最具变革性的突破之一。通过在单个细胞的分辨率上对基因组、转录组、[表观基因组](@entry_id:272005)等进行[高通量测量](@entry_id:200163)，我们得以揭示前所未见的[细胞异质性](@entry_id:262569)，从而根本性地改变了我们对复杂生物系统的理解。然而，这些强大技术的背后是复杂的技术原理和数据分析流程，它们带来了独特的挑战，从实验设计中的固有权衡到数据分析中的统计陷阱。为了充分利用这些技术，研究者不仅需要知道如何运行分析软件，更需要从第一性原理出发，深刻理解数据从产生到解释的全过程。

本系列文章旨在填补这一知识鸿沟，为读者提供一个关于单细胞与[空间组学](@entry_id:156223)的系统性框架。我们将分为三个章节，引导您逐步深入这个激动人心的领域。在第一章**“原则与机制”**中，我们将解构技术的核心，探讨分子条形码如何工作，数据中的技术伴生效应如何产生，以及用于处理这些数据的[统计模型](@entry_id:165873)。接着，在第二章**“应用与交叉学科联系”**中，我们将展示这些基本原理如何应用于绘制[细胞图谱](@entry_id:270083)、重建发育轨迹和理解疾病机制等前沿研究中。最后，在第三章**“动手实践”**中，您将通过具体的计算练习，亲手解决一些关键的分析挑战，从而巩固所学知识。

让我们从旅程的起点开始，深入探究单细胞和[空间组学](@entry_id:156223)研究的基石——其背后的科学原则与技术机制。

## 原则与机制

本章旨在深入探讨单细胞和[空间组学](@entry_id:156223)研究的核心科学原则与技术机制。我们将从解构该领域的基础测量单元——即如何为单个细胞内的单个分子进行唯一标记——开始，逐步过渡到这些技术在现实世界中面临的固有挑战，如细胞捕获过程中的随机性、污染以及批次效应。随后，我们将阐述用于识别和过滤低质量数据的质量控制方法论，并建立描述单细胞数据特有统计属性的数学模型。最后，本章将介绍几种利用这些数据解决关键生物学问题的高级分析框架，包括[降维](@entry_id:142982)可视化、多模态整合以及细胞动态推断。通过本章的学习，读者将能够从第一性原理出发，理解[单细胞组学](@entry_id:151015)数据从产生到最终解释的全过程。

### 基础：从单分子到数字化计数

[单细胞组学](@entry_id:151015)革命的核心在于其以前所未有的分辨率，将生物组织的[异质性](@entry_id:275678)分解为离散的细胞单元，并将每个细胞的分子景观转化为[数字信号](@entry_id:188520)。这一过程的基石是两类精巧的分子条形码技术：**[细胞条形码](@entry_id:171163) (Cell Barcodes, CBs)** 和 **[唯一分子标识符](@entry_id:192673) (Unique Molecular Identifiers, UMIs)**。

**[细胞条形码](@entry_id:171163)** 的功能是回答“这个分子来自哪个细胞？”的问题。在当前主流的基于液滴的单细胞技术中，成千上万个细胞与带有条形码的微珠被悬浮在油相中，通过微流控装置，它们被随机包裹进微小的水相液滴中 [@problem_id:2837390]。理想情况下，每个液滴只含有一个细胞和一颗微珠。同一微珠上的所有寡[核苷酸](@entry_id:275639)探针都带有一段相同的序列，即[细胞条形码](@entry_id:171163)。因此，这个条形码成为了该液滴（及其中的细胞）的唯一标识。另一种策略是**组合索引 (combinatorial indexing)**，细胞或细胞核经过多轮处理，每一轮都会被随机加上一个条形码片段，最终形成一个独特的组合条形码，同样能够区分单个细胞 [@problem_id:2837386]。

然而，仅仅识别细胞来源是不够的。在后续的文库制备过程中，逆转录和[聚合酶链式反应](@entry_id:142924)（PCR）会大量扩增原始的[信使RNA](@entry_id:262893)（mRNA）分子。由于不同分子的扩增效率存在巨大差异，直接对测序读数（reads）进行计数会引入严重的定量偏差。**[唯一分子标识符](@entry_id:192673)** 正是为了解决这一难题而设计的 [@problem_id:2837390]。UMI是一段随机的寡[核苷酸](@entry_id:275639)序列，它在逆转录反应中被连接到每个原始mRNA分子上。关键在于，这一标记过程发生在PCR扩增*之前*。因此，源自同一个mRNA分子的所有扩增产物（即测序读数）都将共享相同的UMI。

最终，通过高通量测序，我们得到的每一条有效读数都包含三个关键信息：[细胞条形码](@entry_id:171163)、[唯一分子标识符](@entry_id:192673)以及一段可比对到参考转录组的cDNA序列。数据分析流程的第一步便是利用这些信息重建定量的基因表达谱。具体而言，所有读数首先根据其[细胞条形码](@entry_id:171163)被分配到各自的来源细胞。在一个细胞内，对于某个特定基因，所有具有相同UMI的读数都被认为是源自同一个原始mRNA分子的扩增副本。通过对每个（[细胞条形码](@entry_id:171163)，基因）组合中不同的UMI进行计数，而非对总读数进行计数，我们就能获得一个几乎消除了PCR扩增偏差的、对原始分子数的精确估计。这个过程最终生成一个**基因-细胞表达矩阵**，其中每个元素代表在特定细胞中检测到的特定基因的UMI计数。这个矩阵是几乎所有下游分析的起点。

### 技术现实及其伴生效应

任何测量技术都非完美无瑕，[单细胞组学](@entry_id:151015)亦然。理解并量化这些技术固有的局限性与伴生效应（artifacts），是进行严谨可靠分析的前提。

#### 细胞捕获、通量与碰撞

在基于液滴的技术中，细胞与微珠的共封装是一个[随机过程](@entry_id:159502)。为了最大限度地提高捕获到的单细胞数量，研究者通常会提高细胞悬液的浓度。然而，这不可避免地增加了单个液滴中捕获到多个细胞的概率，这种事件被称为**细胞碰撞 (collision)** 或**多细胞体 (multiplet)**。

这一过程通常可以用**泊松分布 (Poisson distribution)** 来精确建模 [@problem_id:2837446]。假设细胞在液滴中的[分布](@entry_id:182848)是独立的，且平均每个液滴捕获的细胞数为 $\lambda$（即[泊松分布](@entry_id:147769)的均值或“上样率”），那么一个液滴中恰好含有 $k$ 个细胞的概率为 $P(K=k) = \frac{\lambda^k \exp(-\lambda)}{k!}$。基于此模型，我们可以从第一性原理推导出不同类型液滴的预期比例：

*   **空液滴 (Empty droplets, $K=0$)**: 其比例为 $f_0 = \exp(-\lambda)$。
*   **单细胞液滴 (Singlets, $K=1$)**: 其比例为 $f_1 = \lambda \exp(-\lambda)$。
*   **多细胞体液滴 (Multiplets, $K \ge 2$)**: 其比例为 $f_{\ge 2} = 1 - f_0 - f_1 = 1 - (1+\lambda)\exp(-\lambda)$。

例如，当上样率 $\lambda=0.05$ 时，单细胞液滴的比例约为 $0.0476$，而多细胞体的比例仅为 $0.0012$。但若将 $\lambda$ 提高到 $0.1$，单细胞液滴比例增至约 $0.0905$ 的同时，多细胞体比例也会急剧上升至约 $0.0047$ [@problem_id:2837446]。这揭示了一个核心权衡：追求更高的细胞捕获通量总是以牺牲数据纯度（即更高的多细胞体率）为代价。

多细胞体进一步可分为**同型多细胞体 (homotypic doublets)**（包含两个相同类型的细胞）和**异型多细胞体 (heterotypic doublets)**（包含两个不同类型的细胞）。假设一个组织中存在 $M$ 种细胞类型，其真实比例为 $\{p_k\}_{k=1}^M$。在一个含有两个细胞的液滴中，其成为同型多细胞体的概率是 $\sum_{k=1}^M p_k^2$，而成为异型多细胞体的概率则是 $1 - \sum_{k=1}^M p_k^2$ [@problem_id:2837363]。异型多细胞体的转录组谱是两种真实细胞类型的混合，这会人为地创造出看似处于“中间状态”的细胞，严重干扰细胞类型鉴定和[轨迹推断](@entry_id:176370)。更糟糕的是，如果下游的过滤算法对同型和异型多细胞体的去除效率不同，或者分类器倾向于将异型多细胞体误判为其中一种类型，那么最终观察到的细胞类型频率将偏离其真实比例，从而导致错误的生物学结论 [@problem_id:2837363]。

与此相对，**组合索引**技术通过多轮标记，理论上可以生成的条形码数量极其巨大，从而在很大程度上摆脱了泊松上样的[通量限制](@entry_id:749486)。然而，它面临另一种形式的碰撞问题，即两个不同的细胞在所有轮次中被偶然分配了完全相同的条形码组合。这种碰撞的概率可以用经典的“[生日问题](@entry_id:268167)”来建模，对于一个包含 $C$ 个细胞的实验和 $B$ 个可能的组合条形码，其碰撞率约等于 $C/B$ [@problem_id:2837386]。

#### 污染与噪声

**环境RNA (Ambient RNA)** 污染是基于液滴的方法中另一个普遍存在的问题。在制备单细胞悬液的过程中，部分细胞会破裂，其释放的mRNA分子会混入悬浮液中，形成一个“分子汤”。这些环境RNA分子会与完整的细胞一起被随机包裹进液滴中，导致每个细胞的UMI计数都混杂了来自背景的污染信号 [@problem_id:2837414]。

我们可以将一个细胞 $i$ 中基因 $g$ 的观测UMI计数 $X_{gi}$ 建模为其[期望值](@entry_id:153208) $\lambda_{gi}$ 的泊松实现，而 $\lambda_{gi}$ 是真实内源性信号 $\lambda_{gi}^{\text{endo}}$ 和[环境污染](@entry_id:197929)信号 $\lambda_{gi}^{\text{amb}}$ 的和。环境信号的贡献可以表示为 $\lambda_{gi}^{\text{amb}} = s_i \alpha_i a_g$，其中 $s_i$ 是细胞 $i$ 的总期望UMI数，$\alpha_i$ 是该细胞中源于[环境污染](@entry_id:197929)的分子比例，而 $a_g$ 是基因 $g$ 在环境RNA池中的相对丰度。$a_g$ 的值可以通过分析那些只包含环境RNA的“空液滴”来估计。

为了估计每个细胞的污染比例 $\alpha_i$，我们可以利用一组已知在该细胞类型中几乎不表达的“背景”基因。对于这些基因，其观测到的UMI几乎完全来[自环](@entry_id:274670)境RNA。通过比较这些基因的观测计数和它们在环境RNA中的丰度，我们可以为每个[细胞计算](@entry_id:267237)出其特异的污染系数 $\hat{\alpha}_i$。一旦获得 $\hat{\alpha}_i$，我们就可以通过从原始观测计数 $x_{gi}$ 中减去估计的环境贡献 $N_i \hat{\alpha}_i a_g$（其中 $N_i$ 是细胞 $i$ 的总观测UMI数）来校正表达矩阵，从而得到去污染的内源性表达谱 [@problem_id:2837414]。

**索引跳跃 (Index-hopping)** 是测序过程中发生的另一种技术噪音。在高通量测序仪（尤其是采用ExAmp技术的平台）上进行簇生成时，一个文库分子的部分序列（包括[细胞条形码](@entry_id:171163)）有很小的概率被错误地拼接到另一个簇的分子上。这导致本应属于细胞A的读数被错误地归属到细胞B，造成了细胞间的信号泄露。这种错误发生的概率通常是一个与平台相关的常数，大致独立于文库的细胞数量。在组合索引实验中，除了测序平台的索引跳跃，文库制备过程中的化学残留或错误连接也可能导致轮次间的条形码交换，其累积错误率约与索引轮次成正比 [@problem_id:2837386]。

### 质量控制：区分信号与噪声

在进行任何生物学分析之前，一个至关重要的步骤是对原始数据进行严格的**质量控制 (Quality Control, QC)**，以滤除低质量的条形码，这些条形码可能对应于空液滴、细胞碎片、或濒临死亡的细胞，而非我们感兴趣的、高质量的活细胞。

三个核心的QC指标被广泛使用 [@problem_id:2837441]：
1.  **总UMI数 (nUMI)**：每个[细胞条形码](@entry_id:171163)下检测到的UMI分子总数。通常，高质量的细胞比空液滴或细胞碎片含有更多的RNA分子，因此具有更高的nUMI值。
2.  **基因数 (nGene)**：每个[细胞条形码](@entry_id:171163)下检测到的基因数量（即UMI计数大于0的基因个数）。它反映了转录组的复杂性，高质量细胞通常能检测到更多的基因。
3.  **线粒体基因比例 (Mitochondrial fraction)**：映射到线粒体基因组的UMI占总UMI的比例。细胞在经历压力或凋亡时，细胞质中的mRNA会降解，而线粒体由于其自身膜的保护，其RN[A相](@entry_id:195484)对稳定。因此，线粒体基因比例异常升高通常是细胞健康状况不佳的标志。

传统的QC方法依赖于为这些指标设定固定的、经验性的阈值（例如，nUMI > 500, nGene > 250, mito fraction < 0.1）。然而，这种“一刀切”的方法忽略了不同细胞类型天然存在的生物学差异（例如，某些细胞类型本身RNA含量就较低），并且对实验批次间的技术变异很敏感。

一种更严谨、更具原则性的方法是采用基于概率模型的策略 [@problem_id:2837441]。我们不应将所有[细胞条形码](@entry_id:171163)视为单一群体，而应假设它们源自几个潜在的类别（例如，“高质量细胞”和“低质量/环境背景”）。我们可以对QC指标的[分布](@entry_id:182848)进行建模。例如，总UMI数（$L$）在不同条形码间的[分布](@entry_id:182848)，可以通过一个**伽马-泊松 (Gamma-Poisson)**，即**负二项 (Negative Binomial)** [分布](@entry_id:182848)的混合模型来描述。其中，泊松部分捕捉了分子捕获的随机性，而伽马先验则解释了不同条形码（细胞）间RNA含量和捕获效率的[异质性](@entry_id:275678)。类似地，线粒体UMI数与总UMI数的关系可以用**贝塔-二项 (Beta-Binomial)** 混合模型来刻画，以捕捉健康与濒死细胞群体在线粒体比例上的差异。

通过将这些[混合模型](@entry_id:266571)拟合到数据上，我们可以为每个[细胞条形码](@entry_id:171163)计算其属于“高质量细胞”这一类别的**[后验概率](@entry_id:153467)**。决策（即保留还是丢弃一个条形码）便可以基于这个概率来进行，例如，设定一个阈值 $c$（如0.5），保留所有[后验概率](@entry_id:153467)大于 $c$ 的条形码。这种基于**贝叶斯决策理论 (Bayes decision rule)** 的方法，能够根据数据自身的[分布](@entry_id:182848)特性自适应地设定阈值，远比固定的经验法则更为稳健和精确 [@problem_id:2837441]。

### 单细胞数据的[统计建模](@entry_id:272466)

经过质量控制后，我们得到的基因-细胞表达矩阵是下游分析的核心。理解这个矩阵中数据的统计特性，对于选择合适的分析方法至关重要。

单细胞UMI计数数据最显著的特征之一是**过离散 (overdispersion)**，即数据的[方差](@entry_id:200758)远大于其均值。一个简单的[泊松分布](@entry_id:147769)模型，其[方差](@entry_id:200758)等于均值，通常无法充分描述这种变异性。因此，我们需要更复杂的模型来捕捉这一现象。过离散主要源于两类机制：生物学变异和技术变异 [@problem_id:2837392]。

*   **技术源头的过离散**：即使在一个完全同质的细胞群体中，技术因素也会引入过离散。细胞间的RNA捕获效率、逆转录效率以及[测序深度](@entry_id:178191)的差异，都会导致最终观测到的UMI计数在不同细胞间产生额外的变异。我们可以将这一[过程建模](@entry_id:183557)为一个**[复合泊松过程](@entry_id:140283) (compound Poisson process)**。假设每个细胞的真实表达水平固定，但其被观测到的效率（一个综合了捕获、[逆转录](@entry_id:141572)、测序等步骤的概率）在细胞间是变化的，例如服从一个伽马[分布](@entry_id:182848)。这种**伽马-泊松[混合模型](@entry_id:266571)**在数学上等价于一个负二项分布。该模型的[方差](@entry_id:200758)结构为 $\mathrm{Var}(Y) = \mu + \phi\mu^2$，其中 $\mu$ 是均值，$\phi$ 是离散系数。[方差](@entry_id:200758)超过均值的部分与均值的平方成正比，这很好地描述了单细胞数据中高表达基因具有更高变异性的特点 [@problem_id:2837392] [@problem_id:2837441]。

*   **生物学源头的过离散**：基因表达本身并非一个稳定的过程。许多基因的转录以“爆发”的形式进行，即基因在“开启”和“关闭”两种状态间[随机切换](@entry_id:197998)。这种**[转录爆发](@entry_id:156205) (transcriptional bursting)** 动力学产生的[稳态](@entry_id:182458)mRNA分子数[分布](@entry_id:182848)，天然地服从[负二项分布](@entry_id:262151)。即使后续的技术流程（如分子捕获和测序）是完全均一的，这种源于生物学过程的内在随机性也足以导致观测到的UMI计数呈现过离散 [@problem_id:2837392]。

值得强调的是，一些常见的误解需要被澄清。首先，PCR扩增偏差虽然会极大地增加读数（reads）层面的[方差](@entry_id:200758)，但UMI技术的目的正是为了消除这种偏差，因此它不是UMI计数过离散的原因。其次，UMI条形码碰撞或饱和效应，会导致在高表达基因中对分子数的低估，这种效应会压缩数据的动态范围，从而*降低*[方差](@entry_id:200758)相对于均值的比例，导致**[欠离散](@entry_id:183174) (underdispersion)**，而非过离散 [@problem_id:2837392]。

### 核心分析任务与高级方法一瞥

拥有了经过质控和适当建模的数据后，我们便可以着手回答一系列复杂的生物学问题。

#### 实验设计与批次效应

在实际研究中，数据通常来自不同的实验批次（例如，不同的测序运行、不同的试剂批次或不同的处理时间）。**[批次效应](@entry_id:265859) (Batch effects)** 是指由这些非生物学因素引起的、在不同批次间存在的系统性技术差异。如果实验设计不当，[批次效应](@entry_id:265859)会与我们感兴趣的生物学信号（如不同细胞类型或不同处理条件间的差异）相混淆，导致错误的结论。

我们可以使用一个线性模型来形式化地描述这个问题 [@problem_id:2837436]。假设一个细胞 $i$ 的基因表达观测值 $y_i$ 可以表示为：$y_{i} = \mu + \alpha_{c(i)} + \beta_{b(i)} + \varepsilon_{i}$，其中 $\mu$ 是基线表达，$\alpha_{c(i)}$ 是细胞类型 $c$ 的生物学效应，$\beta_{b(i)}$ 是批次 $b$ 的技术效应，$\varepsilon_i$ 是随机噪声。

在一个**混杂设计 (confounded design)** 中，生物学分组与批次分组高度相关。一个极端的例子是，所有A类型的细胞都在批次1中处理，而所有B类型的细胞都在批次2中处理。在这种情况下，我们观测到的两组均值差异为 $(\alpha_B - \alpha_A) + (\beta_2 - \beta_1)$。生物学效应和[批次效应](@entry_id:265859)完全纠缠在一起，无法被分离开来 [@problem_id:2837436]。

相反，在一个**平衡设计 (balanced design)** 中，每种细胞类型都按比例[分布](@entry_id:182848)在所有批次中。在这种设计下，代表生物学效应的向量与代表[批次效应](@entry_id:265859)的向量在[设计矩阵](@entry_id:165826)中是**正交的 (orthogonal)**。这意味着我们可以独立地、无偏地估计生物学效应和批次效应。例如，通过首先在每个批次内计算细胞类型间的差异，然后再对这些差异进行平均，或者先对每个细胞类型跨批次进行平均，然后再计算类型间的差异，我们都能够有效地消除批次效应，准确地恢复真实的生物学信号 [@problem_id:2837436]。

#### [降维](@entry_id:142982)与可视化

单细胞表达矩阵通常包含数万个基因（维度），而细胞数量可达数万至数百万。直接在高维空间中理解这些数据是极其困难的。因此，**降维 (dimensionality reduction)**，尤其是用于可视化的[非线性降维](@entry_id:636435)，是[单细胞分析](@entry_id:274805)流程中的一个核心步骤。

**[t-分布随机邻域嵌入](@entry_id:276549) ([t-SNE](@entry_id:276549))** 和 **统一[流形](@entry_id:153038)逼近与投影 (UMAP)** 是两种最流行的方法 [@problem_id:2837362]。它们的目标都是将高维空间中细胞间的相似性关系，尽可能忠实地呈现在一个二维或三维的散点图中，但它们的实现哲学和数学形式有所不同。

*   **[t-SNE](@entry_id:276549)** 通过构建两个[概率分布](@entry_id:146404)来工作。在高维空间中，它使用高斯核来定义点与点之间的条件相似性概率 $P_{j|i}$。用户通过设定**[困惑度](@entry_id:270049) (perplexity)** 参数来调节高斯核的带宽 $\sigma_i$，从而控制每个点“关注”的邻居数量。较低的[困惑度](@entry_id:270049)聚焦于非常局部的结构，而较高的[困惑度](@entry_id:270049)则会考虑更广泛的邻域，试图保留更全局的结构。在低维空间中，[t-SNE](@entry_id:276549)使用一个具有重尾的**t-[分布](@entry_id:182848) (t-distribution)**（自由度为1）来定义相似性 $q_{ij}$。其优化的目标是最小化这两个[分布](@entry_id:182848)之间的**[KL散度](@entry_id:140001) (Kullback-Leibler divergence)**, $\mathrm{KL}(P\|Q)$。

*   **UMAP** 则基于[流形学习](@entry_id:156668)和[拓扑数据分析](@entry_id:154661)的理论。它首先在-高维空间中构建一个加权的[k-近邻图](@entry_id:751051)，以近似数据所在的潜在[流形](@entry_id:153038)。用户设定的**邻居数 ($k$)** 是控制其局部/全局视角平衡的关键参数：较小的 $k$ 专注于精细的局部结构，而较大的 $k$ 则有助于捕捉更宏观的全局拓扑。然后，UMAP试图在低维空间中找到一个布局，使其对应的“模糊”图结构与高维图结构尽可能相似。其优化的目标是最小化两者之间的**[交叉熵](@entry_id:269529) (cross-entropy)**。

尽管目标相似，UMAP通常被认为在保留数据全局结构方面优于[t-SNE](@entry_id:276549)，并且计算速度更快，这使其在处理大规模数据集时更具优势。

#### 多[模态分析](@entry_id:163921)：以[CITE-seq](@entry_id:150689)为例

单细胞技术的魅力不止于[转录组](@entry_id:274025)。**[CITE-seq](@entry_id:150689) (Cellular Indexing of Transcriptomes and Epitopes by sequencing)** 等多模态技术允许我们同时测量同一个细胞的RNA和表面蛋白水平 [@problem_id:2837413]。这通过使用与寡[核苷酸](@entry_id:275639)标签（称为**[抗体](@entry_id:146805)衍生标签, Antibody-Derived Tags, ADTs**）缀合的[抗体](@entry_id:146805)来实现。这些ADT标签可以像内源性mRNA一样被捕获和测序，从而为每个细胞提供一个并行的[蛋白质表达](@entry_id:142703)谱。

然而，对ADT数据的分析需要特别注意，因为其[噪声模型](@entry_id:752540)与RNA数据有本质区别。如前述，RNA UMI计数的变异主要受细胞特异性捕获效率和[测序深度](@entry_id:178191)的影响，这是一种**乘性效应 (multiplicative effect)**，通常通过对每个细胞的总UMI进行归一化来校正。

相比之下，ADT计数除了受这些乘性效应影响外，还受到一个显著的**加性背景噪声 (additive background)** 的干扰。这种背景噪声主要来自两个方面：一是[抗体](@entry_id:146805)的**[非特异性结合](@entry_id:190831)**（例如，通过[Fc受体](@entry_id:200880)），其强度与[抗体](@entry_id:146805)的同种型（isotype）相关；二是在液滴形成时被随机包裹进去的、溶液中未结合的**环境[抗体](@entry_id:146805)**。

因此，对ADT数据的正确[归一化流](@entry_id:272573)程必须首先处理这种加性背景。这通常通过使用**同种型对照[抗体](@entry_id:146805) (isotype controls)** 来估计[非特异性结合](@entry_id:190831)，并利用**空液滴**中的ADT计数来估计环境[抗体](@entry_id:146805)背景。只有在从原始ADT计数中*减去*了这个估计的背景之后，才能进行后续的归一化步骤（例如，中心对数比变换, CLR），以校正细胞间的技术差异 [@problem_id:2837413]。

#### 推断细胞动态：RNA速度

静态的单细胞快照能否揭示细胞状态随时间变化的动态过程？**RNA速度 ([RNA velocity](@entry_id:152699))** 概念为此提供了可能。它巧妙地利用了在标准scRNA-seq数据中通常可以区分的两种分子：新转录的**未[剪接](@entry_id:181943) (unspliced)** pre-mRNA和经过加工的**成熟已[剪接](@entry_id:181943) (spliced)** mRNA。

其核心思想基于一个简单的动力学模型 [@problem_id:2837369]。对于一个基因，我们可以用[常微分方程组](@entry_id:266774)（ODEs）来描述其未[剪接](@entry_id:181943)分子数 $u(t)$ 和已[剪接](@entry_id:181943)分子数 $s(t)$ 的变化：
$$ \frac{du(t)}{dt} = \alpha - \beta u(t) $$
$$ \frac{ds(t)}{dt} = \beta u(t) - \gamma s(t) $$
其中，$\alpha$ 是转录速率，$\beta$ 是[剪接](@entry_id:181943)速率，$\gamma$ 是已[剪接](@entry_id:181943)mRNA的降解速率。

当一个细胞群体或一个基因处于**[稳态](@entry_id:182458) (steady state)** 时，其分子数不再随时间变化，即 $\frac{du}{dt}=0$ 和 $\frac{ds}{dt}=0$。此时，我们得到一个简单的[线性关系](@entry_id:267880)：$s_{ss} = \frac{\beta}{\gamma} u_{ss}$。这意味着在[稳态](@entry_id:182458)下，已[剪接](@entry_id:181943)和未[剪接](@entry_id:181943)的mRNA丰度之间存在一个由[速率比](@entry_id:164491) $\beta/\gamma$ 决定的平衡。这个比例可以通过对大量细胞的 $s$ 和 $u$ 计数进行[线性回归](@entry_id:142318)来估计。结合独立的实验（如[代谢标记](@entry_id:177447)）测得的[mRNA半衰期](@entry_id:187753)（可用于计算 $\gamma$），我们便可以估算出模型的所有三个速[率参数](@entry_id:265473) $\alpha, \beta, \gamma$ [@problem_id:2837369]。

RNA速度的精髓在于，当一个细胞的基因表达状态发生改变时（例如，[细胞分化](@entry_id:273644)或对刺激做出响应），其 $u(t)$ 和 $s(t)$ 的关系会偏离这条[稳态](@entry_id:182458)线。如果一个细胞的[未剪接RNA](@entry_id:172427)相对其[已剪接RNA](@entry_id:166242)的比例高于[稳态](@entry_id:182458)水平，这预示着该基因的表达正在上调，反之则预示着下调。通过将每个细胞在 $(u, s)$ [相平面](@entry_id:168387)上的当前位置与其预期的未来位置（由OD[E模](@entry_id:160271)型预测）相连，我们就可以为每个[细胞计算](@entry_id:267237)出一个“速度”向量。在低维嵌入图上将这些向量可视化，便能揭示出[细胞分化](@entry_id:273644)、周期进程等动态轨迹的方向和速率。