{"hands_on_practices": [{"introduction": "量化遗传亲缘关系是任何亲缘选择分析的基石。本练习旨在通过路径计数法，让你亲手计算二倍体系统中常见亲属（如全同胞、半同胞和表亲）之间的亲缘关系系数 $r$。掌握这一基本功，是理解和预测社会行为演化的前提。", "problem": "在一个二倍体、常染色体、有性生殖的系统中，同源共祖（IBD）是相对于一群不相关、非近交的奠基者来定义的。两个个体之间的亲缘系数，记为 $r(A,B)$，是在个体 $A$ 中随机选择的常染色体位点上的一个随机等位基因与个体 $B$ 中同一位点上的一个随机等位基因是同源共祖的概率。假设遵循以下基本原则：(i) 孟德尔分离定律，即每次减数分裂以 $\\frac{1}{2}$ 的概率传递每个常染色体等位基因；(ii) 奠基者是远交且相互无关的，因此任何奠基祖先的近交系数 $F=0$；(iii) 不同位点间的独立分配，且常染色体不存在性别特异性的传递偏倚。\n\n仅使用这些原则，并根据两个非近交个体之间的任何同源共祖共享都必须通过连接他们的共同祖先的路径来追溯的逻辑，通过枚举和求和焦点对之间所有不同的最小系谱路径的贡献来计算 $r$，其中路径上的每一次减数分裂贡献一个 $\\frac{1}{2}$ 的乘法因子。\n\n在所述假设下，计算以下三种关系的 $r$：\n- 全同胞（同父同母），\n- 半同胞（仅同母；父亲们彼此不相关，也与母亲不相关），\n- 表/堂兄妹（他们的父母是全同胞；没有其他共同血缘，即不是双方表/堂兄妹）。\n\n将您的最终答案表示为精确的有理数，按 [全同胞, 半同胞, 表/堂兄妹] 的顺序，以单行矩阵的形式给出。不需要四舍五入，也不应包含单位。", "solution": "经审查，问题陈述是有效的。它在科学上基于孟德尔遗传学原理，问题设定良好，目标明确且数学上易于处理，并提供了所有必要的假设，如二倍体、常染色体遗传以及一个远交、不相关的奠基群体。其方法论已明确规定。我们将着手进行推导。\n\n该问题要求计算两个个体之间的亲缘系数 $r$。计算必须遵循路径分析法。对于两个非近交个体 $X$ 和 $Y$，其共同祖先也非近交，亲缘系数 $r(X,Y)$ 是连接它们的所有可能系谱路径的概率之和。每条路径必须从一个个体（比如 $X$）向上追溯到一个共同祖先 $A$，然后再向下追溯到另一个个体 $Y$。每条此类路径的贡献由 $(\\frac{1}{2})^n$ 给出，其中 $n$ 是路径中减数分裂步骤的总数。总亲缘系数是 $X$ 和 $Y$ 之间所有不同最小路径的这些贡献之和。\n\n$r(X,Y) = \\sum_{\\text{paths}} \\left(\\frac{1}{2}\\right)^n$\n\n我们将此过程应用于三种指定的关系。\n\n1.  **全同胞：**\n    设两个全同胞为 $S_1$ 和 $S_2$。他们共享两个共同祖先：他们的母亲 ($M$) 和父亲 ($F$)。我们假设 $M$ 和 $F$ 是不相关且非近交的，这与问题的假设一致。\n    \n    *   **路径1：**通过母亲 $M$。路径为 $S_1 \\leftarrow M \\rightarrow S_2$。从 $M$ 到 $S_1$ 的减数分裂是一步。从 $M$ 到 $S_2$ 的减数分裂是第二步。总步数为 $n = 1 + 1 = 2$。此路径的贡献为 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n    *   **路径2：**通过父亲 $F$。路径为 $S_1 \\leftarrow F \\rightarrow S_2$。同样，步数为 $n = 1 + 1 = 2$。此路径的贡献为 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n    \n    总亲缘系数是这两条不同路径贡献的总和：\n    $$r_{\\text{full-sibs}} = \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$$\n\n2.  **半同胞：**\n    设两个半同胞为 $H_1$ 和 $H_2$。他们共享一个共同祖先，即他们的母亲 ($M$)。他们的父亲 $F_1$ 和 $F_2$ 彼此不相关，也与 $M$ 不相关。\n    \n    *   **路径1：**通过母亲 $M$。路径为 $H_1 \\leftarrow M \\rightarrow H_2$。减数分裂的步数为 $n = 1 + 1 = 2$。此路径的贡献为 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n    \n    由于只有一个共同祖先，这是唯一的路径。总亲缘系数为：\n    $$r_{\\text{half-sibs}} = \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}$$\n\n3.  **表/堂兄妹：**\n    设两个表/堂兄妹为 $C_1$ 和 $C_2$。他们的父母是全同胞。设 $C_1$ 的父母为 $P_1$，$C_2$ 的父母为 $P_2$，其中 $P_1$ 和 $P_2$ 是同胞。$C_1$ 和 $C_2$ 的共同祖先是 $P_1$ 和 $P_2$ 的父母，我们称之为祖父母，$GM$（祖母）和 $GF$（祖父）。根据问题，没有其他共同血缘。\n    \n    *   **路径1：**通过祖母 $GM$。路径为 $C_1 \\leftarrow P_1 \\leftarrow GM \\rightarrow P_2 \\rightarrow C_2$。减数分裂的步数是从 $C_1$ 到 $GM$ 的代数（$2$ 步：$C_1 \\leftarrow P_1 \\leftarrow GM$）加上从 $GM$ 到 $C_2$ 的代数（$2$ 步：$GM \\rightarrow P_2 \\rightarrow C_2$）的总和。总步数为 $n = 2 + 2 = 4$。此路径的贡献为 $(\\frac{1}{2})^4 = \\frac{1}{16}$。\n    *   **路径2：**通过祖父 $GF$。路径为 $C_1 \\leftarrow P_1 \\leftarrow GF \\rightarrow P_2 \\rightarrow C_2$。步数也为 $n = 2 + 2 = 4$。此路径的贡献为 $(\\frac{1}{2})^4 = \\frac{1}{16}$。\n    \n    总亲缘系数是这两条路径贡献的总和：\n    $$r_{\\text{first-cousins}} = \\left(\\frac{1}{2}\\right)^4 + \\left(\\frac{1}{2}\\right)^4 = \\frac{1}{16} + \\frac{1}{16} = \\frac{2}{16} = \\frac{1}{8}$$\n\n计算出的亲缘系数分别为：全同胞 $\\frac{1}{2}$，半同胞 $\\frac{1}{4}$，表/堂兄妹 $\\frac{1}{8}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{4}  \\frac{1}{8} \\end{pmatrix}}$$", "id": "2813967"}, {"introduction": "在计算出亲缘关系系数 $r$ 之后，我们便可以应用它来预测行为的演化。本练习将运用亲缘选择理论的核心——汉密尔顿法则（Hamilton's rule），在一个简化的线性模型中评估利他行为的演化前景。通过计算选择梯度，你将学会如何将抽象的理论（$rb > c$）转化为可操作的量化预测，这是社会演化研究中的一项关键技能。", "problem": "一个种群由二倍体个体组成，其中一个连续的、可加和的社会性状 $z$ 控制着针对单一主要受益者的有代价帮助行为的概率和强度。考虑在一个原住种群（$z=0$）中，一个罕见突变体使 $z$ 产生一个微小的变化量 $\\delta z$，因此一阶（线性）近似是适用的。根据亲缘选择中广义适合度的定义，由于微小变化 $\\delta z$ 导致的行为者广义适合度的边际变化，等于以下两项之和：(i) 行为者的行为对其自身预期繁殖成功率的边际效应，以及 (ii) 行为者的行为对受益者预期繁殖成功率的边际效应，后者需乘以行为者与受益者之间的亲缘关系系数 $r$。假设对行为者的边际直接效应是每单位 $z$ 减少 $c$，而对受益者的边际效应是每单位 $z$ 增加 $b$。您可以假设选择是弱的，且处于罕见突变极限下，因此 $z$ 上的选择梯度的符号与边际广义适合度效应的符号相匹配。\n\n已知 $r=0.5$，$b=2$，$c=1.2$：\n1. 仅使用上述定义和在 $z=0$ 附近的线性近似，判断利他主义（即正的 $\\delta z$）是否受选择青睐。\n2. 在此线性近似下，计算选择梯度的大小。\n\n最终数值答案仅报告选择梯度的大小。无需四舍五入，也无需单位。", "solution": "问题陈述需要经过验证。\n\n步骤1：提取已知条件。\n- 种群由二倍体个体组成。\n- 一个连续的、可加和的社会性状用 $z$ 表示。\n- 问题考虑在一个原住种群中（性状值为 $z=0$），一个罕见突变体使该性状产生微小变化 $\\delta z$。\n- 陈述说明一阶（线性）近似是适用的。\n- 由于 $\\delta z$ 导致的行为者广义适合度的边际变化是两种效应之和：\n    - (i) 对行为者自身预期繁殖成功率的边际效应。\n    - (ii) 对受益者预期繁殖成功率的边际效应，并乘以亲缘关系系数 $r$。\n- 对行为者的边际直接效应是每单位 $z$ 减少 $c$。\n- 对受益者的边际效应是每单位 $z$ 增加 $b$。\n- 假设：弱选择和罕见突变极限。\n- 在这些假设下，$z$ 上的选择梯度的符号与边际广义适合度效应的符号相匹配。\n- 给定参数值为：亲缘关系系数 $r=0.5$，对受益者的收益 $b=2$，对行为者的成本 $c=1.2$。\n- 任务是 (1) 判断利他主义（正的 $\\delta z$）是否受青睐，以及 (2) 计算选择梯度的大小。最终答案应仅为选择梯度的大小。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。它提出了基于广义适合度概念和汉密尔顿法则的亲缘选择理论的标准表述，这些是演化生物学中的基本原理。\n- 该问题是适定的。它提供了计算唯一、有意义的选择梯度值所需的所有必要定义、参数和假设。\n- 该问题是客观的，使用了精确的、定量的语言，避免了任何主观或模糊的术语。\n- 该问题不违反任何无效性标准。它是社会演化理论的教科书式应用。\n\n步骤3：结论与行动。\n- 问题被视为有效。将提供解答。\n\n该问题要求计算社会性状 $z$ 的选择梯度。根据问题定义，我们必须为一个表现出性状变化 $\\delta z$ 的行为者构建广义适合度边际变化的表达式，我们将其表示为 $\\delta W_{\\text{incl}}$。\n\n问题陈述指出，$\\delta W_{\\text{incl}}$ 是对行为者适合度的直接效应与对受益者适合度的间接效应之和，后者需乘以他们的亲缘关系系数 $r$。\n\n对行为者的边际直接效应是每单位性状 $z$ 减少 $c$。对于一个微小的变化 $\\delta z$，这对行为者适合度的效应由表达式 $-c \\delta z$ 给出。\n\n对受益者的边际效应是每单位性状 $z$ 增加 $b$。对于行为者性状的微小变化 $\\delta z$，对受益者适合度的效应是 $b \\delta z$。在计算广义适合度效应时，此效应需乘以亲缘关系系数 $r$。因此，广义适合度变化的间接部分是 $r (b \\delta z)$。\n\n将这两个部分相加，得到广义适合度的总边际变化：\n$$\n\\delta W_{\\text{incl}} = -c \\delta z + r b \\delta z\n$$\n我们可以提出因子 $\\delta z$：\n$$\n\\delta W_{\\text{incl}} = (rb - c) \\delta z\n$$\n问题陈述指出，一阶（线性）近似是适用的，并且 $z$ 上的选择梯度的符号与此边际广义适合度效应的符号相匹配。选择梯度（我们可表示为 $S$）定义为适合度相对于性状的偏导数，在原住性状值处求值。在这种线性近似中，选择梯度是乘以性状变化 $\\delta z$ 的系数：\n$$\nS = \\frac{\\partial W_{\\text{incl}}}{\\partial z} \\bigg|_{z=0} = rb - c\n$$\n这个表达式是汉密尔顿法则的核心。利他主义被定义为一种有代价的行为，使他人受益（即，在 $c>0$ 和 $b>0$ 的情况下，$\\delta z$ 为正），如果选择梯度 $S$ 为正，则利他主义会受到自然选择的青睐。一个正的 $S$ 意味着性状 $z$ 的增加会导致广义适合度的增加。\n\n首先，我们判断利他主义是否受青睐。我们将给定值 $r=0.5$，$b=2$ 和 $c=1.2$ 代入选择梯度 $S$ 的表达式中：\n$$\nS = (0.5)(2) - 1.2 = 1 - 1.2 = -0.2\n$$\n由于选择梯度 $S = -0.2$ 是负的，选择将作用于降低性状 $z$ 的值。因此，在这些条件下，正的变化 $\\delta z > 0$（利他主义）不受青睐；它会受到不利选择。\n\n其次，我们计算选择梯度的大小。选择梯度为 $S = -0.2$。其大小是 $S$ 的绝对值：\n$$\n|S| = |-0.2| = 0.2\n$$\n这就是问题所要求的最终数值。", "answer": "$$\n\\boxed{0.2}\n$$", "id": "2813994"}, {"introduction": "亲代投资策略的演化不仅受亲缘关系的影响，还与交配系统和性选择紧密相关，尤其是在父权不确定的情况下。本练习构建了一个优化模型，用于分析雄性在提供亲代抚育和寻求未来交配机会之间的权衡。通过推导雄性停止抚育的父权阈值 $p^{\\ast}$ [@problem_id:2813928]，你将能定量地理解父权如何调节雄性投资策略的演化。", "problem": "一种双亲物种表现出雄性亲代抚育，这与未来的交配成功率存在权衡关系。设总亲代投资为雌性贡献与雄性贡献之和，$I=I_{f}+I_{m}$。$B$个后代中每一个存活至独立的概率是总投资的一个饱和函数，由$S(I)=1-\\exp(-k I)$给出，其中$k>0$是一个捕捉投资边际收益递减的常数。假设雌性投资一个固定量$I_{f}$，该量不受雄性决策的影响，而雄性选择$I_{m}\\ge 0$以最大化其在当前季节的广义适合度。雄性在当前季节属于其自身的存活后代的期望数量为$p \\, B \\, S(I_{f}+I_{m})$，其中$p\\in[0,1]$是他在该窝后代中的父权份额。雄性抚育的机会成本通过一个成本函数$C_{m}(I_{m})$减少了雄性未来后代的期望数量，其中$C_{m}(0)=0$且对于$I_{m}\\ge 0$有$C_{m}'(I_{m})>0$。假设为二倍体遗传，与自身后代的亲缘系数为$r=\\tfrac{1}{2}$，并设在没有抚育的情况下，雄性的基线未来繁殖量为一个常数$R_{0}$（与$I_{m}$无关）。假设雄性在保持所有其他因素不变的情况下，最大化其当前这窝存活后代的期望数量与未来后代期望数量的亲缘系数加权和。\n\n对于一个特定种群，假设以下参数值和函数成立：$B=6$，$I_{f}=3$，$k=0.4$，以及$C_{m}(I_{m})=c\\, I_{m}$（其中$c=0.25$）。将$R_{0}$视为一个不依赖于$I_{m}$的任意正常数。在这些假设下，存在一个父权阈值 $p^{\\ast}$，使得当 $p  p^{\\ast}$ 时，雄性将完全不提供抚育（$I_{m}=0$）。计算此父权阈值 $p^{\\ast}$。", "solution": "雄性的广义适合度是其当前这窝后代中携带其基因的存活后代期望数量与未来携带其基因的后代期望数量的亲缘系数加权和。在二倍体遗传下，与自身后代的亲缘系数为$r=\\tfrac{1}{2}$，其广义适合度作为其投资$I_{m}$的函数可以写为\n$$\nW(I_{m}) \\;=\\; r \\Big( p \\, B \\, S(I_{f}+I_{m}) \\;+\\; R_{0} \\;-\\; C_{m}(I_{m}) \\Big).\n$$\n这里，$R_{0}$与$I_{m}$无关，而$r$同时乘上了当前项和未来项。因为$r$是一个正常数因子，最大化$W(I_{m})$等价于最大化括号中的项：\n$$\n\\Phi(I_{m}) \\;=\\; p \\, B \\, S(I_{f}+I_{m}) \\;-\\; C_{m}(I_{m}) \\;+\\; R_{0}.\n$$\n由于$R_{0}$相对于$I_{m}$是一个常数，它不影响$I_{m}$的选择，因此在优化中可以忽略。因此，雄性选择$I_{m}$来最大化\n$$\n\\Psi(I_{m}) \\;=\\; p \\, B \\, S(I_{f}+I_{m}) \\;-\\; C_{m}(I_{m}).\n$$\n\n刻画任何内部最优解$I_{m}^{\\ast}>0$的一阶条件是通过将$\\Psi(I_{m})$对$I_{m}$求导并令其为零得到：\n$$\n\\frac{d\\Psi}{d I_{m}} \\;=\\; p \\, B \\, S'(I_{f}+I_{m}) \\;-\\; C_{m}'(I_{m}) \\;=\\; 0.\n$$\n因为$S(I)$是递增且凹的（收益递减），而$C_{m}(I_{m})$是递增的，所以等式左侧随$I_{m}$的增加而减小，这确保了如果存在解，则解是唯一的。父权阈值$p^{\\ast}$界定了角点解$I_{m}=0$何时成为最优解。具体来说，当$I_{m}=0$处的边际收益小于或等于边际成本时，$I_{m}=0$是最优的；只有当$I_{m}=0$处的边际收益超过边际成本时，才存在一个内部正解。因此，阈值$p^{\\ast}$由$I_{m}=0$处的无差异条件定义：\n$$\np^{\\ast} \\, B \\, S'(I_{f}) \\;=\\; C_{m}'(0).\n$$\n解出$p^{\\ast}$得到通用表达式\n$$\np^{\\ast} \\;=\\; \\frac{C_{m}'(0)}{B \\, S'(I_{f})}.\n$$\n\n现在对给定的函数和参数进行求值。我们有$S(I)=1-\\exp(-k I)$，其中$k=0.4$，所以\n$$\nS'(I) \\;=\\; k \\, \\exp(-k I).\n$$\n因此，\n$$\nS'(I_{f}) \\;=\\; k \\, \\exp(-k I_{f}) \\;=\\; 0.4 \\, \\exp\\!\\big(-0.4 \\times 3\\big) \\;=\\; 0.4 \\, \\exp(-1.2).\n$$\n成本函数是线性的，$C_{m}(I_{m})=c \\, I_{m}$，其中$c=0.25$，因此\n$$\nC_{m}'(0) \\;=\\; c \\;=\\; 0.25.\n$$\n窝卵数为$B=6$，代入阈值表达式：\n$$\np^{\\ast} \\;=\\; \\frac{0.25}{6 \\times \\big(0.4 \\, \\exp(-1.2)\\big)} \\;=\\; \\frac{0.25}{2.4 \\, \\exp(-1.2)} \\;=\\; \\frac{0.25}{2.4} \\, \\exp(1.2).\n$$\n计算数值：\n$$\n\\frac{0.25}{2.4} \\;=\\; 0.104166\\overline{6}, \\quad \\exp(1.2) \\approx 3.320116923,\n$$\n所以\n$$\np^{\\ast} \\;\\approx\\; 0.104166\\overline{6} \\times 3.320116923 \\;\\approx\\; 0.345843\\ldots\n$$\n四舍五入到四位有效数字，\n$$\np^{\\ast} \\;\\approx\\; 0.3458.\n$$\n该值位于单位区间内，这与其作为父权份额阈值的解释是一致的，低于该阈值，雄性抚育将降至零。", "answer": "$$\\boxed{0.3458}$$", "id": "2813928"}]}