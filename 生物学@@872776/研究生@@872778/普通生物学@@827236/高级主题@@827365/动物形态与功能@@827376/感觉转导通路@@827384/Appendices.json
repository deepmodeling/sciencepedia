{"hands_on_practices": [{"introduction": "本练习将带您回到感觉转导的核心电生理学原理。通过从第一性原理出发，您将推导当一个感觉刺激选择性地改变某一离子通道的电导时，细胞膜电位的稳态变化。这个实践旨在巩固您对感受器电位如何由跨膜离子流平衡决定的理解，并阐明通道的逆转电位与细胞静息电位之间的关系如何决定了信号是兴奋性的（去极化）还是抑制性的（超极化）[@problem_id:2836286]。", "problem": "一个初级感觉感受器细胞可以被建模为一个离子电流呈欧姆性的单等电位隔室。在所关注的时间尺度上，若不考虑电容瞬变和主动泵，稳态膜电位由净离子电流平衡决定。基本的电流平衡关系是净离子电流满足 $I_{\\text{net}} = \\sum_{i=1}^{n} g_i \\big(V - E_i\\big)$，其中 $g_i$ 是离子通道类别 $i$ 的电导，$E_i$ 是其反转电位。在稳态下，感受器电位 $V$ 满足 $I_{\\text{net}}=0$。\n\n考虑一组基线电导 $\\{g_i\\}_{i=1}^{n}$ 及其相关的反转电位 $\\{E_i\\}_{i=1}^{n}$，并假设一个外部刺激选择性地将单个电导 $g_s$（对于某个索引 $s \\in \\{1,\\dots,n\\}$）增加了 $\\Delta g$（其中 $\\Delta g > 0$），而不改变任何其他的 $g_i$ 或任何 $E_i$。假设对所有 $i$ 都有 $g_i \\ge 0$，并且 $\\sum_{i=1}^{n} g_i > 0$。从上述电流平衡关系出发，并应用稳态条件，推导刺激后新的稳态感受器电位 $V$ 的闭式解析表达式，该表达式应以 $\\{g_i\\}$、$\\{E_i\\}$、$\\Delta g$ 和 $E_s$ 表示。在您的推理中，仅使用所述的电流平衡关系和基础代数。\n\n此外，在您的解题过程（而非最终方框内的答案）中，确定 $V$ 相对于其刺激前的值发生去极化（$V$ 增加）与超极化（$V$ 减小）的条件。说明您对 $V$ 的符号约定所做的任何假设。\n\n您的最终答案必须是单个闭式解析表达式。请勿代入数值，最终答案框中不应包含单位，也不应报告不等式或文字条件。如果对该表达式进行数值计算，$V$ 的单位将是伏特。", "solution": "首先将根据所需标准对问题进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n该问题提出了一个初级感觉感受器细胞的模型，包含以下已知条件：\n- 模型：具有欧姆性离子电流的单等电位隔室。\n- 时间尺度：不考虑电容瞬变或主动泵。\n- 基本关系：净离子电流为 $I_{\\text{net}} = \\sum_{i=1}^{n} g_i \\big(V - E_i\\big)$，其中 $g_i$ 是电导，$E_i$ 是反转电位，$V$ 是膜电位。\n- 稳态条件：$I_{\\text{net}}=0$。\n- 基线状态：一组 $n$ 个电导 $\\{g_i\\}_{i=1}^{n}$ 和反转电位 $\\{E_i\\}_{i=1}^{n}$。\n- 刺激：单个电导 $g_s$ 增加了 $\\Delta g > 0$。\n- 不变性：所有其他电导 $g_i$（当 $i \\neq s$ 时）和所有反转电位 $E_i$ 保持不变。\n- 约束条件：对所有 $i$，$g_i \\ge 0$，且初始总电导 $\\sum_{i=1}^{n} g_i > 0$。\n\n**第二步：使用提取的已知条件进行验证**\n对问题进行验证。\n- **科学依据**：该问题有效。电流平衡方程是欧姆定律在并联电导模型上的直接应用，这是细胞神经生理学中用于近似稳态膜电位的标准和基本概念。\n- **良态问题**：该问题有效。它提供了一个清晰的代数方程和明确定义的参数变化，要求求解新的稳态解。所提供的约束条件（$g_i \\ge 0$ 和 $\\sum_{i=1}^{n} g_i > 0$）确保解中的分母不为零，从而保证了唯一且有意义的解。\n- **客观性**：该问题有效。它以精确的数学和生物物理学语言陈述，没有主观或模糊的术语。\n清单中未发现任何缺陷。该问题是生物物理建模中的一个标准练习，没有违反任何科学或逻辑完整性原则。\n\n**第三步：结论与行动**\n该问题被认定为有效。下面是完整且有理有据的解答。\n\n### 解题推导\n\n任务是推导在刺激使单个电导 $g_s$ 增加后，新的稳态感受器电位的表达式。设基线电位为 $V_0$，刺激后的新电位为 $V_1$。问题陈述中使用变量 $V$ 表示这个新电位，我们将在最终答案中采纳此用法。\n\n稳态条件是跨膜净电流为零，$I_{\\text{net}} = 0$。净电流的一般表达式为 $I_{\\text{net}} = \\sum_{i=1}^{n} g_i \\big(V - E_i\\big)$。\n\n刺激后，特定通道类别 $s$ 的电导变为 $g_s + \\Delta g$。所有其他电导 $g_i$（其中 $i \\neq s$）和所有反转电位 $E_i$ 保持不变。新的稳态电位 $V_1$ 必须满足使用新电导组的电流平衡方程。\n\n新的稳态方程为：\n$$ \\sum_{i \\neq s} g_i (V_1 - E_i) + (g_s + \\Delta g)(V_1 - E_s) = 0 $$\n我们的目标是解出该方程中的 $V_1$。我们展开各项：\n$$ \\sum_{i \\neq s} g_i V_1 - \\sum_{i \\neq s} g_i E_i + g_s V_1 + \\Delta g V_1 - g_s E_s - \\Delta g E_s = 0 $$\n我们可以合并求和项。$\\sum_{i \\neq s} g_i V_1 + g_s V_1$ 等价于 $\\left(\\sum_{i=1}^{n} g_i\\right) V_1$。类似地，$\\sum_{i \\neq s} g_i E_i + g_s E_s$ 等价于 $\\sum_{i=1}^{n} g_i E_i$。将这些代回方程中得到：\n$$ \\left(\\sum_{i=1}^{n} g_i\\right) V_1 + \\Delta g V_1 - \\left(\\sum_{i=1}^{n} g_i E_i\\right) - \\Delta g E_s = 0 $$\n现在，我们将所有包含 $V_1$ 的项移到方程的一边，所有其他项移到另一边：\n$$ V_1 \\left( \\sum_{i=1}^{n} g_i + \\Delta g \\right) = \\sum_{i=1}^{n} g_i E_i + \\Delta g E_s $$\n最后，我们通过除以括号中的项来分离出 $V_1$。这是允许的，因为已知 $\\sum_{i=1}^{n} g_i > 0$ 和 $\\Delta g > 0$，所以分母严格为正且不为零。\n$$ V_1 = \\frac{\\sum_{i=1}^{n} g_i E_i + \\Delta g E_s}{\\sum_{i=1}^{n} g_i + \\Delta g} $$\n这就是新的稳态感受器电位的闭式表达式。\n\n接下来，我们必须确定这种变化构成去极化还是超极化的条件。我们采用标准的神经生理学约定，即去极化是膜电位的增加（$V_1 > V_0$），而超极化是膜电位的减少（$V_1  V_0$）。我们必须求出电位变化量 $\\Delta V = V_1 - V_0$。\n\n首先，我们通过对初始电导组 $\\{g_i\\}_{i=1}^{n}$ 应用稳态条件来求出基线电位 $V_0$：\n$$ \\sum_{i=1}^{n} g_i (V_0 - E_i) = 0 $$\n$$ V_0 \\sum_{i=1}^{n} g_i - \\sum_{i=1}^{n} g_i E_i = 0 $$\n$$ V_0 = \\frac{\\sum_{i=1}^{n} g_i E_i}{\\sum_{i=1}^{n} g_i} $$\n现在我们计算 $\\Delta V = V_1 - V_0$：\n$$ \\Delta V = \\frac{\\sum_{i=1}^{n} g_i E_i + \\Delta g E_s}{\\sum_{i=1}^{n} g_i + \\Delta g} - \\frac{\\sum_{i=1}^{n} g_i E_i}{\\sum_{i=1}^{n} g_i} $$\n设 $S = \\sum_{i=1}^{n} g_i E_i$ 且 $G = \\sum_{i=1}^{n} g_i$。表达式变为：\n$$ \\Delta V = \\frac{S + \\Delta g E_s}{G + \\Delta g} - \\frac{S}{G} $$\n为了减去这两个分数，我们找到一个公分母，即 $G(G + \\Delta g)$：\n$$ \\Delta V = \\frac{G(S + \\Delta g E_s) - S(G + \\Delta g)}{G(G + \\Delta g)} $$\n$$ \\Delta V = \\frac{GS + G \\Delta g E_s - SG - S \\Delta g}{G(G + \\Delta g)} $$\n$$ \\Delta V = \\frac{G \\Delta g E_s - S \\Delta g}{G(G + \\Delta g)} = \\frac{\\Delta g (G E_s - S)}{G(G + \\Delta g)} $$\n$\\Delta V$ 的符号决定了电位变化的性质。我们分析分子和分母的符号。\n- 分母：已知 $G = \\sum_{i=1}^{n} g_i  0$ 和 $\\Delta g  0$。因此，$G(G + \\Delta g)  0$。\n- 分子：已知 $\\Delta g  0$。因此分子的符号由项 $(G E_s - S)$ 的符号决定。\n将 $G$ 和 $S$ 的定义代回得到：\n$$ G E_s - S = E_s \\left(\\sum_{i=1}^{n} g_i\\right) - \\left(\\sum_{i=1}^{n} g_i E_i\\right) $$\n将此项除以 $G = \\sum_{i=1}^{n} g_i$（其为正值，不改变符号）可以简化分析：\n$$ \\frac{G E_s - S}{G} = E_s - \\frac{S}{G} = E_s - V_0 $$\n因此，$\\Delta V$ 的符号与 $(E_s - V_0)$ 的符号相同。\n\n条件如下：\n- **去极化**（$\\Delta V  0$）：当 $E_s - V_0  0$ 时发生，这等价于 $E_s  V_0$。如果被激活通道的反转电位比初始膜电位更正，细胞将发生去极化。\n- **超极化**（$\\Delta V  0$）：当 $E_s - V_0  0$ 时发生，这等价于 $E_s  V_0$。如果被激活通道的反转电位比初始膜电位更负，细胞将发生超极化。\n- **无变化**（$\\Delta V = 0$）：当 $E_s - V_0 = 0$ 时发生，这等价于 $E_s = V_0$。如果被激活通道的反转电位恰好等于膜电位，则该离子没有净驱动力，打开通道不会引起电位变化。根据定义，这正是反转电位。", "answer": "$$\n\\boxed{\\frac{\\sum_{i=1}^{n} g_i E_i + \\Delta g E_s}{\\sum_{i=1}^{n} g_i + \\Delta g}}\n$$", "id": "2836286"}, {"introduction": "在理解了电导变化如何产生电信号后，我们来探究物理刺激本身是如何控制通道门控的。本练习以听觉和平衡觉系统中的毛细胞为模型，应用基于统计力学的玻尔兹曼函数来描述机械力如何调控离子通道的开放概率[@problem_id:2836288]。通过将宏观测量的电流-位移关系曲线与这个微观模型相联系，您将学会如何从实验数据中提取出关键的生物物理参数，例如驱动通道开放的“门控力”。", "problem": "一个力敏感毛束控制着力电转导（MET）通道的开放以响应位移。考虑一个双态模型，其中MET通道的开放概率作为毛束位移 $x$ 的函数由玻尔兹曼函数给出：\n$$\nP_{o}(x) = \\frac{1}{1 + \\exp\\!\\left[-\\frac{z\\,(x - x_{1/2})}{k_{B} T}\\right]},\n$$\n其中 $z$ 是有效门控力，$x_{1/2}$ 是半激活时的位移，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。假设在相关工作范围内，每个开放通道通过一个与位移无关的单通道电流，并且宏观电流与任意 $x$ 处的开放通道数量成正比。\n\n从热平衡下双态系统的开放概率定义以及开放通道数量与宏观电流之间的比例关系出发，推导MET电流 $I(x)$ 作为位移 $x$ 的函数，并用 $P_{o}(x)$ 和饱和电流 $I_{\\max}$ 表示。然后，利用半激活时的电流-位移关系的斜率，确定 $z$ 的值。\n\n一个在温度 $T = 300\\,\\mathrm{K}$ 下的实验测得饱和MET电流量值为 $I_{\\max} = 600\\,\\mathrm{pA}$，在 $x = x_{1/2}$ 处电流-位移关系的局部斜率为 $s_{I} = 30.0\\,\\mathrm{pA\\,nm^{-1}}$。使用 $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。将 $z$ 的最终值以皮牛顿（pN）为单位表示。将答案四舍五入到 $3$ 位有效数字。", "solution": "我们发现该问题陈述具有科学依据、提法恰当且内部一致。它提出了一个生物物理学的标准模型，并为获得唯一解提供了所有必要参数。因此，我们将继续进行推导和计算。\n\n该问题需要分两部分求解：首先，推导力电转导（MET）电流 $I(x)$ 的表达式；其次，计算有效门控力 $z$。\n\n第1部分：MET电流 $I(x)$ 的推导。\nMET通道的总数是一个常数，我们称之为 $N_{\\text{total}}$。在给定的毛束位移 $x$ 处，开放通道的数量 $N_{o}(x)$ 由通道总数与任一单个通道开放的概率 $P_{o}(x)$ 的乘积给出。\n$$\nN_{o}(x) = N_{\\text{total}} \\cdot P_{o}(x)\n$$\n问题陈述指出宏观电流 $I(x)$ 与开放通道的数量成正比。设比例常数为 $i_{s}$，代表单通道电流，假定其与位移无关。\n$$\nI(x) = i_{s} N_{o}(x) = i_{s} N_{\\text{total}} P_{o}(x)\n$$\n饱和电流 $I_{\\max}$ 定义为所有通道都开放时的电流。这对应于开放概率 $P_{o}(x) \\to 1$ 的极限情况。在此极限下，$N_{o}(x) \\to N_{\\text{total}}$。因此，最大电流为：\n$$\nI_{\\max} = i_{s} N_{\\text{total}}\n$$\n将 $I_{\\max}$ 的表达式代回到 $I(x)$ 的方程中，我们得到在位移 $x$ 处的电流、最大电流和开放概率之间的明确关系：\n$$\nI(x) = I_{\\max} P_{o}(x)\n$$\n代入给定的 $P_{o}(x)$ 的玻尔兹曼函数：\n$$\nI(x) = I_{\\max} \\frac{1}{1 + \\exp\\!\\left[-\\frac{z\\,(x - x_{1/2})}{k_{B} T}\\right]}\n$$\n这就完成了问题的第一部分。\n\n第2部分：门控力 $z$ 的确定。\n问题给出了半激活时，$x = x_{1/2}$ 处的电流-位移关系的斜率。这个斜率 $s_{I}$ 是 $I(x)$ 对 $x$ 的导数在 $x=x_{1/2}$ 处的值。\n$$\ns_{I} = \\left. \\frac{dI}{dx} \\right|_{x=x_{1/2}}\n$$\n我们必须首先计算 $I(x)$ 的导数。为简单起见，设指数的参数为 $\\alpha(x) = -\\frac{z(x-x_{1/2})}{k_B T}$。\n$$\nI(x) = I_{\\max} (1 + \\exp(\\alpha(x)))^{-1}\n$$\n使用链式法则求导：\n$$\n\\frac{dI}{dx} = I_{\\max} \\cdot (-1) (1 + \\exp(\\alpha(x)))^{-2} \\cdot \\frac{d}{dx}(1 + \\exp(\\alpha(x)))\n$$\n$$\n\\frac{dI}{dx} = -I_{\\max} (1 + \\exp(\\alpha(x)))^{-2} \\cdot \\exp(\\alpha(x)) \\cdot \\frac{d\\alpha}{dx}\n$$\n$\\alpha(x)$ 对 $x$ 的导数为：\n$$\n\\frac{d\\alpha}{dx} = \\frac{d}{dx} \\left(-\\frac{z(x-x_{1/2})}{k_B T}\\right) = -\\frac{z}{k_B T}\n$$\n将此代回到 $\\frac{dI}{dx}$ 的表达式中：\n$$\n\\frac{dI}{dx} = -I_{\\max} \\frac{\\exp(\\alpha(x))}{(1 + \\exp(\\alpha(x)))^{2}} \\left(-\\frac{z}{k_{B} T}\\right) = I_{\\max} \\frac{z}{k_{B} T} \\frac{\\exp\\left[-\\frac{z(x - x_{1/2})}{k_{B} T}\\right]}{\\left(1 + \\exp\\left[-\\frac{z(x - x_{1/2})}{k_{B} T}\\right]\\right)^{2}}\n$$\n现在，我们在 $x = x_{1/2}$ 处计算这个导数的值。此时，由于 $x-x_{1/2}=0$，指数的参数变为 $0$。\n$$\n\\left. \\frac{dI}{dx} \\right|_{x=x_{1/2}} = I_{\\max} \\frac{z}{k_{B} T} \\frac{\\exp(0)}{(1 + \\exp(0))^{2}}\n$$\n由于 $\\exp(0) = 1$，表达式简化为：\n$$\ns_{I} = I_{\\max} \\frac{z}{k_{B} T} \\frac{1}{(1 + 1)^{2}} = I_{\\max} \\frac{z}{k_{B} T} \\frac{1}{4}\n$$\n我们现在可以重新整理这个方程来求解门控力 $z$：\n$$\nz = \\frac{4 s_{I} k_{B} T}{I_{\\max}}\n$$\n最后一步是代入给定的数值。所提供的数据是：\n$s_{I} = 30.0\\,\\mathrm{pA\\,nm^{-1}}$\n$I_{\\max} = 600\\,\\mathrm{pA}$\n$T = 300\\,\\mathrm{K}$\n$k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n\n首先，我们计算热能 $k_{B}T$：\n$$\nk_{B}T = (1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\cdot (300\\,\\mathrm{K}) = 4.141\\,947 \\times 10^{-21}\\,\\mathrm{J}\n$$\n接下来，我们将这些值代入 $z$ 的表达式中：\n$$\nz = \\frac{4 \\cdot (30.0\\,\\mathrm{pA\\,nm^{-1}}) \\cdot (4.141\\,947 \\times 10^{-21}\\,\\mathrm{J})}{600\\,\\mathrm{pA}}\n$$\n皮安培（$\\mathrm{pA}$）的单位相互抵消，剩下焦耳每纳米（$\\mathrm{J\\,nm^{-1}}$）的单位。\n$$\nz = \\frac{120.0}{600} \\cdot (4.141\\,947 \\times 10^{-21})\\,\\mathrm{J\\,nm^{-1}} = 0.2 \\cdot (4.141\\,947 \\times 10^{-21})\\,\\mathrm{J\\,nm^{-1}}\n$$\n$$\nz = 0.828\\,389\\,4 \\times 10^{-21}\\,\\mathrm{J\\,nm^{-1}}\n$$\n问题要求答案以皮牛顿（$\\mathrm{pN}$）为单位。我们必须进行单位转换。\n$1\\,\\mathrm{J} = 1\\,\\mathrm{N} \\cdot \\mathrm{m}$\n$1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m}$\n$1\\,\\mathrm{pN} = 10^{-12}\\,\\mathrm{N}$\n因此，\n$$\n1\\,\\mathrm{J\\,nm^{-1}} = \\frac{1\\,\\mathrm{N} \\cdot \\mathrm{m}}{10^{-9}\\,\\mathrm{m}} = 10^{9}\\,\\mathrm{N} = 10^{9} \\cdot (10^{12}\\,\\mathrm{pN}) = 10^{21}\\,\\mathrm{pN}\n$$\n使用这个转换因子：\n$$\nz = (0.828\\,389\\,4 \\times 10^{-21}) \\cdot (10^{21}\\,\\mathrm{pN}) = 0.828\\,389\\,4\\,\\mathrm{pN}\n$$\n按照要求将结果四舍五入到 $3$ 位有效数字，得到 $0.828\\,\\mathrm{pN}$。", "answer": "$$\n\\boxed{0.828}\n$$", "id": "2836288"}, {"introduction": "最后，我们将视角从单个通道的机制提升到整个感觉通路的系统层面。本练习介绍了一个广泛用于描述感觉系统饱和响应特性的现象学模型——希尔（Hill）方程，并要求您通过编写代码来将其拟合到模拟的实验数据上[@problem_id:2836374]。这项计算实践将让您亲身体验如何量化感觉神经元的关键功能特性，如半最大响应刺激强度（$I_{50}$）和响应的陡峭程度（$n$），并探索在不同背景刺激下，这些参数如何变化以实现感觉适应。", "problem": "您正在为一个感觉转导通路建模，其中对刺激强度的响应是饱和的，并受到反馈的调节。假设存在一个受体-配体转导步骤，其中效应器的分数激活与处于激活状态的受体分数成正比。从质量作用定律下的平衡结合出发，并假设有 $n$ 个相同且独立的结合事件，它们具有相同的解离常数，且宏观响应与分数占据率成正比。以此为基础，推导出一个饱和的输入-输出关系。该关系在对数刺激轴上是单调的、S型的，并具有两个可解释的参数：半激活刺激 $I_{50}$ 和控制陡峭度的希尔系数 $n$。解释在这些假设下，为什么 $I_{50}$ 等于引起半最大响应的刺激，以及为什么 $n$ 反映了协同性或有效非线性。\n\n然后，您将使用这个推导出的函数来拟合模拟背景依赖性反馈的合成数据集。背景刺激被建模为通过作用于转导步骤上游或下游的反馈来改变表观的半激活刺激和斜率。对于每个数据集，您将通过非线性最小二乘法拟合参数，计算相对于基线背景的背景依赖性变化，并报告定量总结。\n\n请遵循以下要求。\n\n- 假设与模型基础：\n  - 使用质量作用定律下平衡时激活受体的分数作为基础。假设存在 $n$ 个相同且独立的结合事件，其有效解离常数定义了刺激尺度，并且宏观响应与此分数激活成正比。\n  - 使用标准的生物物理学推理和定义，论证连接微观结合与宏观响应的所有步骤。\n\n- 数据生成（由您的程序确定性地执行）：\n  - 对于每个测试用例和每个背景条件 $b \\in \\{0,1,2\\}$，使用从您的模型推导出的饱和转导曲线生成一个包含刺激强度和带噪声响应的合成数据集，该曲线的参数已通过背景依赖性反馈进行修改。\n  - 对于每个测试用例 $t$，如下文的测试套件中所述定义基本参数和反馈。真实的基本参数是 $R_{\\max}$（响应尺度）、$I_{50,\\mathrm{base}}$（半激活刺激）和 $n_{\\mathrm{base}}$（希尔系数）。背景 $b$ 将真实参数修改为 $I_{50}^{(b)} = \\phi^{(b)} \\cdot I_{50,\\mathrm{base}}$ 和 $n^{(b)} = n_{\\mathrm{base}} + \\Delta n^{(b)}$。在本任务的数据生成中，响应尺度 $R_{\\max}$ 在所有背景下保持不变。\n  - 每个背景使用 $N_I = 30$ 个刺激强度，从 $I_{\\min} = 10^{-2} \\cdot I_{50,\\mathrm{base}}$ 到 $I_{\\max} = 10^{2} \\cdot I_{50,\\mathrm{base}}$ 在对数尺度上均匀分布。\n  - 通过向每个响应样本添加标准差为 $\\sigma = 0.02 \\cdot R_{\\max}$ 的独立零均值高斯噪声来生成噪声。\n  - 使用一个确定性随机数生成器，种子为 $s_t = 12345 + 100 \\cdot t$，其中 $t$ 是测试用例在套件中的从零开始的索引。\n\n- 参数估计：\n  - 在每个测试用例的每个背景中，通过最小化模型响应与上述生成的带噪声数据之间的未加权残差平方和，来拟合三个自由参数 $R_{\\max}$、$I_{50}$ 和 $n$。\n  - 在拟合过程中将参数约束在生物学上合理的范围内：$R_{\\max}  0$，$I_{50}  0$ 和 $0.1 \\le n \\le 5$。\n  - 使用合理的初始猜测，不假设对真实参数有先验知识。例如，您可以将 $R_{\\max}$ 初始化为该背景下观察到的最大响应，将 $I_{50}$ 初始化为强度网格的几何平均值，并将 $n$ 初始化为 $1$。\n\n- 需要报告的量：\n  - 对于每个测试用例，令背景 $b=0$ 为基线。对于每个非基线背景 $b \\in \\{1,2\\}$，从拟合参数中计算两个量：\n    - 比率 $r^{(b)} = I_{50,\\mathrm{fit}}^{(b)} \\big/ I_{50,\\mathrm{fit}}^{(0)}$。\n    - 差值 $\\delta^{(b)} = n_{\\mathrm{fit}}^{(b)} - n_{\\mathrm{fit}}^{(0)}$。\n  - 将所有的 $r^{(b)}$ 和 $\\delta^{(b)}$ 报告为四舍五入到三位小数的浮点数。\n\n- 测试套件：\n  - 程序必须实现以下三个测试用例，每个用例指定 $(R_{\\max}, I_{50,\\mathrm{base}}, n_{\\mathrm{base}}, \\{\\phi^{(b)}\\}_{b=0}^2, \\{\\Delta n^{(b)}\\}_{b=0}^2)$:\n    1. 测试用例 $t=0$: $(R_{\\max} = 1.0, I_{50,\\mathrm{base}} = 50.0, n_{\\mathrm{base}} = 1.2, \\{\\phi^{(0)},\\phi^{(1)},\\phi^{(2)}\\} = \\{1.0, 3.0, 10.0\\}, \\{\\Delta n^{(0)},\\Delta n^{(1)},\\Delta n^{(2)}\\} = \\{0.0, -0.2, -0.4\\})$.\n    2. 测试用例 $t=1$: $(R_{\\max} = 0.8, I_{50,\\mathrm{base}} = 5.0, n_{\\mathrm{base}} = 2.0, \\{\\phi^{(0)},\\phi^{(1)},\\phi^{(2)}\\} = \\{1.0, 2.0, 4.0\\}, \\{\\Delta n^{(0)},\\Delta n^{(1)},\\Delta n^{(2)}\\} = \\{0.0, 0.2, 0.4\\})$.\n    3. 测试用例 $t=2$: $(R_{\\max} = 1.5, I_{50,\\mathrm{base}} = 100.0, n_{\\mathrm{base}} = 1.0, \\{\\phi^{(0)},\\phi^{(1)},\\phi^{(2)}\\} = \\{1.0, 1.5, 2.5\\}, \\{\\Delta n^{(0)},\\Delta n^{(1)},\\Delta n^{(2)}\\} = \\{0.0, 0.0, -0.1\\})$.\n\n- 最终输出格式：\n  - 您的程序应生成单行输出，其中包含所有测试用例的汇总结果，形式为方括号内以逗号分隔的列表。对于每个测试用例（按 $t=0,1,2$ 的顺序），按顺序包含该测试用例的四个浮点数 $[r^{(1)}, \\delta^{(1)}, r^{(2)}, \\delta^{(2)}]$，每个浮点数四舍五入到三位小数。因此，最后一行应类似于 $[\\dots]$，包含恰好 $12$ 个浮点数且没有空格。", "solution": "目标是从受体-配体结合的原理性微观基础出发，推导出一个宏观转导函数，然后为模拟跨背景的反馈依赖性适应的合成数据集实现一个拟合与分析程序。其基础是由质量作用定律支配的平衡结合，这是许多感觉转导通路中受体激活的一个经过充分检验的模型。我们考虑一个受体或转导模块，它需要 $n$ 个配体相互作用才能被激活；这可以代表具有协同激活的 $n$ 个相同结合位点，或一个捕捉下游非线性的有效指数。我们假设刺激强度 $I$ 与配体浓度成正比，并且在稳态下，激活受体的分数等于希尔函数的分数占据率。\n\n从第一性原理推导饱和函数的过程如下。\n\n- 令 $I$ 表示刺激强度，与配体浓度成正比，单位任意但一致。考虑 $n$ 个相同且独立的结合事件，每个事件的解离常数为 $K$。在质量作用定律下，假设 $I \\ll$ 饱和容量且混合均匀，单个位点在平衡时被占据的概率为 $p = \\dfrac{I}{K + I}$。\n- 如果受体激活需要所有 $n$ 个位点都被占据（协同模型），则激活受体的分数为 $p^n = \\left(\\dfrac{I}{K + I}\\right)^n = \\dfrac{I^n}{(K + I)^n}$。在更一般的希尔近似下，可以将激活效应器的分数写为希尔函数 $\\theta(I) = \\dfrac{I^n}{K^n + I^n}$，该函数能捕捉协同饱和现象，并具有正确的极限行为 $\\theta(0)=0$ 和 $\\lim_{I \\to \\infty} \\theta(I) = 1$。这种形式与 $n$ 个相同步骤的推导是一致的，其假设是有效激活阈值与 $K$ 成比例，并且详细的微观状态可以粗粒化为希尔形式。\n- 如果宏观响应 $R(I)$ 与激活效应器的分数成正比，且最大响应为 $R_{\\max}$，那么可得 $R(I) = R_{\\max} \\cdot \\theta(I) = R_{\\max} \\cdot \\dfrac{I^n}{K^n + I^n}$。\n- 半激活刺激 $I_{50}$ 由条件 $R(I_{50}) = \\dfrac{1}{2} R_{\\max}$ 定义。求解 $\\dfrac{I_{50}^n}{K^n + I_{50}^n} = \\dfrac{1}{2}$ 可得 $I_{50}^n = K^n$，因此 $I_{50} = K$。所以，在这些假设下，$I_{50}$ 等于发生半占据时的刺激强度的解离常数尺度。\n- 希尔系数 $n$ 控制陡峭度，因为对于希尔函数，半激活点处的对数斜率满足 $\\left.\\dfrac{d \\log \\theta}{d \\log I}\\right|_{I=I_{50}} = \\dfrac{n}{4}$，这反映了协同性：较大的 $n$ 会产生从低响应到高响应的更陡峭的过渡，而较小的 $n$ 则产生更平缓的斜率。\n\n反馈和背景依赖性适应可以通过修改有效参数值来进行唯象表示。背景 $b$ 通过一个乘法因子 $\\phi^{(b)}$ 修改表观半激活刺激，并通过一个加性变化 $\\Delta n^{(b)}$ 修改斜率，因此在背景 $b$ 中用于生成数据的真实参数是 $I_{50}^{(b)} = \\phi^{(b)} \\cdot I_{50,\\mathrm{base}}$ 和 $n^{(b)} = n_{\\mathrm{base}} + \\Delta n^{(b)}$。为清晰起见，在合成数据生成过程中，宏观的 $R_{\\max}$ 在不同背景下保持不变。\n\n用于拟合和评估的算法设计：\n\n- 对于每个测试用例 $t \\in \\{0,1,2\\}$，定义基本参数 $(R_{\\max}, I_{50,\\mathrm{base}}, n_{\\mathrm{base}})$ 和背景修饰因子 $\\{\\phi^{(b)}\\}_{b=0}^2$ 及 $\\{\\Delta n^{(b)}\\}_{b=0}^2$，如测试套件中所指定。构建一个包含 $N_I = 30$ 个点的对数间隔强度网格，从 $I_{\\min} = 10^{-2} \\cdot I_{50,\\mathrm{base}}$ 到 $I_{\\max} = 10^{2} \\cdot I_{50,\\mathrm{base}}$，以覆盖半激活刺激周围的几个数量级，确保可辨识性。\n- 对于每个背景 $b$，使用推导的函数 $R(I) = R_{\\max} \\cdot \\dfrac{I^{n^{(b)}}}{\\left((I_{50}^{(b)})^{n^{(b)}} + I^{n^{(b)}}\\right)}$ 计算无噪声响应。向每个响应样本添加标准差为 $\\sigma = 0.02 \\cdot R_{\\max}$ 的独立高斯噪声。使用种子为 $s_t = 12345 + 100 \\cdot t$ 的确定性随机数生成器，以确保数据可复现。\n- 通过最小化模型与带噪声响应之间的残差平方和，为每个背景分别拟合三个参数 $(R_{\\max}, I_{50}, n)$。使用约束条件 $R_{\\max}  0$、$I_{50}  0$ 和 $0.1 \\le n \\le 5$ 来强制施加生物学合理性和数值稳定性。将参数初始化为：$R_{\\max}$ 等于该背景下观察到的最大响应，$I_{50}$ 等于强度网格的几何平均值（即对数空间的中点），$n=1$（表示对协同性是中性的）。\n- 拟合后，提取每个背景 $b$ 的拟合参数 $I_{50,\\mathrm{fit}}^{(b)}$ 和 $n_{\\mathrm{fit}}^{(b)}$。对于 $b \\in \\{1,2\\}$，计算比率 $r^{(b)} = I_{50,\\mathrm{fit}}^{(b)} \\big/ I_{50,\\mathrm{fit}}^{(0)}$ 和差值 $\\delta^{(b)} = n_{\\mathrm{fit}}^{(b)} - n_{\\mathrm{fit}}^{(0)}$。这些量报告了背景依赖性反馈如何改变操作点和斜率（相对于基线），而无需绝对校准。\n- 按要求的顺序汇总三个测试用例的结果。将每个浮点数四舍五入到三位小数，并打印成单行，形式为方括号内以逗号分隔的列表，且无空格。\n\n在反馈背景下对参数的科学解释：\n\n- 如果背景提高了有效半激活刺激（例如，通过上游负反馈降低增益从而导致脱敏），那么 $\\phi^{(b)}  1$，预期 $r^{(b)}  1$，表示曲线向右移动。相反，如果背景降低了有效阈值从而导致增敏，则会得到 $r^{(b)}  1$。\n- 如果背景压缩了响应曲线（例如，通过除法归一化降低动态陡峭度），那么 $\\Delta n^{(b)}  0$，预期 $\\delta^{(b)}  0$。如果反馈使过渡更加尖锐（例如，正反馈或协同性通道门控），那么 $\\Delta n^{(b)}  0$，预期 $\\delta^{(b)}  0$。\n- 因为拟合是从带噪声的样本中恢复参数，所以报告的 $r^{(b)}$ 和 $\\delta^{(b)}$ 应该近似于相对于基线的真实修饰因子 $(\\phi^{(b)}, \\Delta n^{(b)})$，存在的微小偏差是由于噪声和有限采样造成的。\n\n最终程序实现了所有步骤，根据指定的种子确定性地生成合成数据集，为每个背景和测试用例执行约束非线性回归，计算所需的比率和差值，四舍五入到三位小数，并以指定的单行格式打印它们。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef naka_rushton(I, Rmax, I50, n):\n    # Naka-Rushton / Hill function\n    I = np.asarray(I, dtype=float)\n    # Avoid numerical issues for extremely small negative n due to bounds; enforce positivity in caller\n    return Rmax * (I ** n) / (I50 ** n + I ** n)\n\ndef generate_synthetic_data(Rmax, I50_base, n_base, phi_list, delta_n_list, N_I, rng):\n    # Generate log-spaced intensities around I50_base\n    I_min = 1e-2 * I50_base\n    I_max = 1e2 * I50_base\n    intensities = np.logspace(np.log10(I_min), np.log10(I_max), N_I)\n    sigma = 0.02 * Rmax\n    data = []\n    for b, (phi, dn) in enumerate(zip(phi_list, delta_n_list)):\n        true_I50 = phi * I50_base\n        true_n = n_base + dn\n        true_resp = naka_rushton(intensities, Rmax, true_I50, true_n)\n        noisy_resp = true_resp + rng.normal(0.0, sigma, size=true_resp.shape)\n        data.append((intensities.copy(), noisy_resp))\n    return data\n\ndef fit_background(intensities, responses):\n    # Initial guesses: Rmax from max response (ensure positive), I50 from geometric mean of intensities, n=1.0\n    R_guess = max(1e-6, float(np.max(responses)))\n    I50_guess = float(np.exp(np.mean(np.log(intensities))))\n    n_guess = 1.0\n    p0 = [R_guess, I50_guess, n_guess]\n    # Bounds: Rmax0, I500, n in [0.1, 5]\n    bounds = ([1e-9, 1e-9, 0.1], [np.inf, np.inf, 5.0])\n    try:\n        popt, _ = curve_fit(\n            naka_rushton,\n            intensities,\n            responses,\n            p0=p0,\n            bounds=bounds,\n            maxfev=20000,\n        )\n    except Exception:\n        # Fallback: perturb initial guesses slightly and retry\n        p0_alt = [R_guess * 0.9 + 1e-3, I50_guess * 1.1 + 1e-3, min(4.9, max(0.2, n_guess * 1.2))]\n        popt, _ = curve_fit(\n            naka_rushton,\n            intensities,\n            responses,\n            p0=p0_alt,\n            bounds=bounds,\n            maxfev=20000,\n        )\n    R_fit, I50_fit, n_fit = popt\n    return R_fit, I50_fit, n_fit\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Rmax, I50_base, n_base, phi_list for b=0..2, delta_n_list for b=0..2)\n    test_cases = [\n        (1.0, 50.0, 1.2, [1.0, 3.0, 10.0], [0.0, -0.2, -0.4]),\n        (0.8, 5.0, 2.0, [1.0, 2.0, 4.0], [0.0, 0.2, 0.4]),\n        (1.5, 100.0, 1.0, [1.0, 1.5, 2.5], [0.0, 0.0, -0.1]),\n    ]\n\n    N_I = 30  # number of intensity points per background\n\n    results = []\n    for t, (Rmax, I50_base, n_base, phi_list, delta_n_list) in enumerate(test_cases):\n        rng = np.random.default_rng(12345 + 100 * t)\n        # Generate synthetic data for three backgrounds\n        background_data = generate_synthetic_data(Rmax, I50_base, n_base, phi_list, delta_n_list, N_I, rng)\n        # Fit each background independently\n        fitted_params = []\n        for intensities, responses in background_data:\n            R_fit, I50_fit, n_fit = fit_background(intensities, responses)\n            fitted_params.append((R_fit, I50_fit, n_fit))\n        # Baseline parameters (background 0)\n        _, I50_fit_0, n_fit_0 = fitted_params[0]\n        # For backgrounds 1 and 2, compute ratios and differences\n        for b in [1, 2]:\n            _, I50_fit_b, n_fit_b = fitted_params[b]\n            r_b = I50_fit_b / I50_fit_0\n            d_b = n_fit_b - n_fit_0\n            # Round to three decimals as required in output\n            results.append(r_b)\n            results.append(d_b)\n\n    # Format with three decimals, no spaces\n    formatted = \",\".join(f\"{x:.3f}\" for x in results)\n    print(f\"[{formatted}]\")\n\nsolve()\n```", "id": "2836374"}]}