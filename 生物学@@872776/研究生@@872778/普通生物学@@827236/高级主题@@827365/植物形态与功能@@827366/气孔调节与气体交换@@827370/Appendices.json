{"hands_on_practices": [{"introduction": "对气孔调节的理解始于掌握气体扩散的物理学原理。第一个练习 [@problem_id:2838878] 将帮助你熟练运用联系 $\\text{CO}_2$ 同化速率 ($A$)、气孔导度 ($g_s$) 和 $\\text{CO}_2$ 浓度梯度的基本方程。通过计算胞间 $\\text{CO}_2$ 浓度 ($C_i$) 并将其与一个假设的目标值进行比较，你将建立起对气孔如何响应以维持生理稳态的直观认识。", "problem": "一片处于稳态气体交换状态下的阔叶植物，光照充足且水分充裕。设净二氧化碳同化速率为 $A$（单位叶面积单位时间的摩尔$\\text{CO}_2$吸收量），气孔对二氧化碳的导度为 $g_s$（单位叶面积的摩尔导度），环境（边界层外部）二氧化碳摩尔分数为 $C_a$，胞间隙二氧化碳摩尔分数为 $C_i$。根据应用于气孔路径的Fick第一定律，扩散摩尔通量等于导度乘以驱动梯度。因此，对于穿过气孔的二氧化碳，我们有本构关系 $A = g_s (C_a - C_i)$，其中 $A$ 的单位是 $\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$，$g_s$ 的单位是 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，$C_a$ 和 $C_i$ 的单位是 $\\mathrm{\\mu mol\\,mol^{-1}}$。假设 $g_s$ 是专指对二氧化碳的导度（而非对水蒸气的导度）。已知 $A = 15\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$，$g_s = 0.3\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$，以及 $C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$，计算 $C_i$。\n\n为了将 $C_i$ 与气孔调节联系起来，采用一个简单的唯象保卫细胞控制器，该控制器倾向于维持一个与环境浓度成正比的参考胞间摩尔分数 $C_{i,\\mathrm{ref}}$：$C_{i,\\mathrm{ref}} = 0.7\\,C_a$。定义一个无量纲的趋势变量 $s$ 如下：\n- $s = +1$ 如果 $C_i  C_{i,\\mathrm{ref}}$（气孔倾向于张开以将 $C_i$ 提高到参考值），\n- $s = -1$ 如果 $C_i > C_{i,\\mathrm{ref}}$（气孔倾向于关闭以将 $C_i$ 降低到参考值），\n- $s = 0$ 如果 $C_i = C_{i,\\mathrm{ref}}$。\n\n计算在上述条件下的 $s$。将最终的 $C_i$ 以 $\\mathrm{\\mu mol\\,mol^{-1}}$ 为单位表示。将您的最终答案以一个二元行向量 $[C_i, s]$ 的形式报告。不要四舍五入；请提供精确值。", "solution": "首先将对问题陈述进行严格的验证。\n\n步骤1：提取已知条件。\n问题提供了以下数据、定义和关系：\n- 净二氧化碳同化速率，$A$。\n- 气孔对二氧化碳的导度，$g_s$。\n- 环境二氧化碳摩尔分数，$C_a$。\n- 胞间隙二氧化碳摩尔分数，$C_i$。\n- Fick第一定律描述的二氧化碳穿过气孔的扩散通量：$A = g_s (C_a - C_i)$。\n- 单位已指定：$A$ 的单位是 $\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$，$g_s$ 的单位是 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，$C_a, C_i$ 的单位是 $\\mathrm{\\mu mol\\,mol^{-1}}$。\n- 给定的同化速率值：$A = 15\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$。\n- 给定的气孔导度值：$g_s = 0.3\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n- 给定的环境 $\\mathrm{CO_2}$ 摩尔分数：$C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n- 参考胞间摩尔分数定义为 $C_{i,\\mathrm{ref}} = 0.7\\,C_a$。\n- 无量纲趋势变量 $s$ 由以下条件定义：\n    - $s = +1$ 如果 $C_i  C_{i,\\mathrm{ref}}$\n    - $s = -1$ 如果 $C_i > C_{i,\\mathrm{ref}}$\n    - $s = 0$ 如果 $C_i = C_{i,\\mathrm{ref}}$\n\n任务是计算 $C_i$ 和 $s$ 的值。\n\n步骤2：使用提取的已知条件进行验证。\n问题的有效性评估如下：\n- **科学依据**：该问题在根本上是合理的。方程 $A = g_s (C_a - C_i)$ 是植物叶片气体交换研究中的一个标准核心关系式，直接源自Fick第一扩散定律。目标胞间 $\\mathrm{CO_2}$ 浓度的概念，通常表示为环境浓度的分数（即 $C_i/C_a$），是气孔调节模型中一个公认的唯象原则。所提供的 $A$、$g_s$ 和 $C_a$ 的数值对于处于最佳条件下的C3植物是生理上现实的。\n- **适定性**：该问题是适定的。它提供了足够的信息来确定唯一的解。问题的结构是先计算中间变量 $C_i$，然后用它来计算最终变量 $s$。\n- **单位一致性**：有必要检查主方程 $A = g_s (C_a - C_i)$ 中单位的一致性。左侧的单位是 $[\\mu\\mathrm{mol} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{s}^{-1}]$。右侧的单位是 $[\\mathrm{mol} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{s}^{-1}] \\times [\\mu\\mathrm{mol} \\cdot \\mathrm{mol}^{-1}]$。mol 单位相互抵消，得到 $[\\mu\\mathrm{mol} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{s}^{-1}]$，与左侧相同。单位是一致的。\n- **客观性**：该问题使用精确、客观和科学的术语来表述。\n\n步骤3：结论与行动。\n该问题具有科学依据，是适定的，并且没有矛盾或含糊之处。这是一个有效的定量生物学问题。因此，我将继续进行求解。\n\n第一个目标是计算胞间 $\\mathrm{CO_2}$ 摩尔分数 $C_i$。我们从给定的气体交换本构关系开始：\n$$A = g_s (C_a - C_i)$$\n我们必须对这个方程进行代数重排以求解 $C_i$：\n$$\\frac{A}{g_s} = C_a - C_i$$\n$$C_i = C_a - \\frac{A}{g_s}$$\n现在，我们将给定的数值代入此表达式：$A = 15\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$，$g_s = 0.3\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$，以及 $C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n$$C_i = 400 - \\frac{15}{0.3}$$\n计算该比值为：\n$$\\frac{15}{0.3} = \\frac{150}{3} = 50$$\n该比值的单位是 $(\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}) / (\\mathrm{mol\\,m^{-2}\\,s^{-1}}) = \\mathrm{\\mu mol\\,mol^{-1}}$，与 $C_a$ 和 $C_i$ 的单位一致。\n将此结果代回，我们求得 $C_i$ 的值：\n$$C_i = 400 - 50 = 350\\ \\mathrm{\\mu mol\\,mol^{-1}}$$\n\n第二个目标是计算趋势变量 $s$。这需要将计算出的 $C_i$ 与参考值 $C_{i,\\mathrm{ref}}$ 进行比较。首先，我们必须使用其定义计算 $C_{i,\\mathrm{ref}}$：\n$$C_{i,\\mathrm{ref}} = 0.7\\,C_a$$\n代入值 $C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$：\n$$C_{i,\\mathrm{ref}} = 0.7 \\times 400 = 280\\ \\mathrm{\\mu mol\\,mol^{-1}}$$\n现在，我们将我们计算的 $C_i$ 与此参考值进行比较：\n$$C_i = 350\\ \\mathrm{\\mu mol\\,mol^{-1}}$$\n$$C_{i,\\mathrm{ref}} = 280\\ \\mathrm{\\mu mol\\,mol^{-1}}$$\n很明显 $350 > 280$，这意味着 $C_i > C_{i,\\mathrm{ref}}$。根据问题对趋势变量 $s$ 的定义，如果 $C_i > C_{i,\\mathrm{ref}}$，那么 $s$ 必须等于 $-1$。这表明气孔应倾向于关闭，以将胞间 $\\mathrm{CO_2}$ 浓度降低至其目标值。\n因此，$s = -1$。\n\n问题要求将最终答案以一个二元行向量 $[C_i, s]$ 的形式报告。计算出的值为 $C_i = 350$ 和 $s = -1$。", "answer": "$$\\boxed{\\begin{pmatrix} 350  -1 \\end{pmatrix}}$$", "id": "2838878"}, {"introduction": "植物面临着一个永恒的权衡：在为光合作用获取 $\\text{CO}_2$ 的同时，不可避免地通过蒸腾作用失去水分。这个练习 [@problem_id:2838746] 将重点转向水蒸气通量 ($E$)，展示它如何由水汽压亏缺 (VPD) 驱动并受气孔导度调控。通过将蒸腾速率与叶片水势的下降 ($\\Delta\\Psi_{\\text{leaf}}$) 联系起来，你将把大气环境与植物内部的水力状态联系起来，这是生态生理学的一块基石。", "problem": "一片处于稳态的平面叶片，暴露在温度为 $25\\,^\\circ\\text{C}$、总压为 $P_{\\mathrm{atm}}=101.325\\ \\text{kPa}$ 的大气中。叶片的细胞间隙中的空气在叶片温度下被水蒸气饱和，而外部空气相对于 $25\\,^\\circ\\text{C}$ 下的饱和状态，其饱和水汽压差 (VPD) 为 $\\mathrm{VPD}=2\\ \\text{kPa}$。以单位叶面积的摩尔量表示的水蒸气总（气孔加边界层）导度为 $g_{w}=0.5\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$。单位面积的叶片水力导度为 $K_{\\mathrm{leaf}}=5\\ \\mathrm{mmol\\,m^{-2}\\,s^{-1}\\,MPa^{-1}}$。\n\n仅从理想气体混合物中摩尔分数的定义和扩散通量的导度形式出发，并假设空气-水蒸气混合物呈等温、理想气体行为，请根据给定变量从基本原理推导出蒸腾通量 $E$（从叶片到空气的单位叶面积摩尔水蒸气通量）。然后，在叶片水通量等于蒸腾通量的稳态水平衡条件下，估算驱动该通量通过叶片水力路径所需的叶片水势下降值 $\\Delta\\Psi_{\\mathrm{leaf}}$ 的大小。\n\n报告：\n- 以 $\\mathrm{mmol\\,m^{-2}\\,s^{-1}}$ 为单位的 $E$，\n- 以 $\\mathrm{MPa}$ 为单位的 $|\\Delta\\Psi_{\\mathrm{leaf}}|$ 的大小。\n\n您可以假设 $1\\ \\text{mol}=10^{3}\\ \\text{mmol}$。将您的数值结果四舍五入到三位有效数字。", "solution": "所提出的问题是定量植物生理学中的一个有效练习。它具有科学依据，提法恰当，并包含足够的信息以获得唯一解。稳态、等温条件和理想气体行为的假设是标准的简化方法，用于使此类问题易于处理。我现在将进行推导和计算。\n\n任务分为两部分：首先，推导并计算蒸腾通量 $E$；其次，计算维持该通量所需的叶片水势下降值 $\\Delta\\Psi_{\\mathrm{leaf}}$。\n\n第1部分：蒸腾通量 $E$ 的推导和计算。\n\n问题要求从基本原理进行推导。从叶片到大气的摩尔水蒸气通量，即蒸腾通量 $E$，是由水蒸气摩尔分数的差异驱动的，并与路径的导度成正比。该关系由 Fick 第一扩散定律的导度形式给出：\n$$E = g_{w} \\cdot \\Delta W$$\n其中 $g_{w}$ 是单位叶面积的水蒸气摩尔导度，$\\Delta W$ 是叶片细胞间隙 ($W_i$) 和外部大气 ($W_a$) 之间水蒸气摩尔分数的差值。\n$$\\Delta W = W_i - W_a$$\n对于理想气体混合物，组分气体（水蒸气，下标为 $w$）的摩尔分数定义为其分压 $p_w$ 与混合物总压 $P_{\\mathrm{atm}}$ 的比值。\n$$W = \\frac{p_w}{P_{\\mathrm{atm}}}$$\n问题指出，叶片内部的空气在叶片温度 $T_{\\mathrm{leaf}}$ 下被水蒸气饱和。在指定的等温条件下，叶片温度等于空气温度，$T_{\\mathrm{leaf}} = T_{\\mathrm{air}} = 25\\,^\\circ\\text{C}$。因此，叶片内部水蒸气的分压 $p_{w,i}$ 是 $25\\,^\\circ\\text{C}$ 下的饱和水汽压，我们将其表示为 $p_{\\mathrm{sat}}(25\\,^\\circ\\text{C})$。\n$$p_{w,i} = p_{\\mathrm{sat}}(25\\,^\\circ\\text{C})$$\n因此，叶片内部水蒸气的摩尔分数为：\n$$W_i = \\frac{p_{\\mathrm{sat}}(25\\,^\\circ\\text{C})}{P_{\\mathrm{atm}}}$$\n周围空气的水蒸气含量以饱和水汽压差 (VPD) 的形式给出，VPD 定义为空气温度下的饱和水汽压与空气的实际水汽压 $p_{w,a}$ 之间的差值。\n$$\\mathrm{VPD} = p_{\\mathrm{sat}}(T_{\\mathrm{air}}) - p_{w,a}$$\n鉴于 $T_{\\mathrm{air}} = 25\\,^\\circ\\text{C}$，我们可以解出 $p_{w,a}$：\n$$p_{w,a} = p_{\\mathrm{sat}}(25\\,^\\circ\\text{C}) - \\mathrm{VPD}$$\n那么，周围空气中水蒸气的摩尔分数为：\n$$W_a = \\frac{p_{w,a}}{P_{\\mathrm{atm}}} = \\frac{p_{\\mathrm{sat}}(25\\,^\\circ\\text{C}) - \\mathrm{VPD}}{P_{\\mathrm{atm}}}$$\n现在，我们可以推导出摩尔分数差 $\\Delta W$ 的表达式：\n$$\\Delta W = W_i - W_a = \\frac{p_{\\mathrm{sat}}(25\\,^\\circ\\text{C})}{P_{\\mathrm{atm}}} - \\frac{p_{\\mathrm{sat}}(25\\,^\\circ\\text{C}) - \\mathrm{VPD}}{P_{\\mathrm{atm}}}$$\n$$\\Delta W = \\frac{p_{\\mathrm{sat}}(25\\,^\\circ\\text{C}) - p_{\\mathrm{sat}}(25\\,^\\circ\\text{C}) + \\mathrm{VPD}}{P_{\\mathrm{atm}}} = \\frac{\\mathrm{VPD}}{P_{\\mathrm{atm}}}$$\n这个简洁的结果表明，蒸腾的摩尔分数驱动力与VPD成正比，与总大气压成反比。\n\n将此结果代入通量的基本方程：\n$$E = g_{w} \\frac{\\mathrm{VPD}}{P_{\\mathrm{atm}}}$$\n我们已知以下值：\n$g_{w} = 0.5\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n$\\mathrm{VPD} = 2\\ \\text{kPa}$\n$P_{\\mathrm{atm}} = 101.325\\ \\text{kPa}$\n代入这些值：\n$$E = (0.5\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}) \\times \\frac{2\\ \\text{kPa}}{101.325\\ \\text{kPa}}$$\n$$E \\approx 0.5 \\times 0.0197384\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}} \\approx 0.0098692\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}}$$\n问题要求答案以 $\\mathrm{mmol\\,m^{-2}\\,s^{-1}}$ 为单位。使用换算关系 $1\\ \\text{mol} = 10^3\\ \\text{mmol}$：\n$$E \\approx 0.0098692\\ \\mathrm{mol\\,m^{-2}\\,s^{-1}} \\times 1000\\ \\mathrm{mmol\\,mol^{-1}} \\approx 9.8692\\ \\mathrm{mmol\\,m^{-2}\\,s^{-1}}$$\n四舍五入到三位有效数字，蒸腾通量为：\n$$E \\approx 9.87\\ \\mathrm{mmol\\,m^{-2}\\,s^{-1}}$$\n\n第2部分：叶片水势下降值 $|\\Delta\\Psi_{\\mathrm{leaf}}|$ 的计算。\n\n液态水通过叶片水力系统（从木质部到蒸发位点）的流动是由水势 $\\Psi$ 的梯度驱动的。这个过程可以通过与 Ohm 定律的类比来描述：\n$$J_w = K_{\\mathrm{leaf}} \\cdot |\\Delta\\Psi_{\\mathrm{leaf}}|$$\n其中 $J_w$ 是单位叶面积的液态水通量，$K_{\\mathrm{leaf}}$ 是单位面积的叶片水力导度，而 $|\\Delta\\Psi_{\\mathrm{leaf}}|$ 是驱动水流的水势差的大小。\n\n问题指定了稳态条件，即进入叶片蒸发表面的水通量 $J_w$ 必须等于离开叶片的水蒸气通量 $E$。\n$$J_w = E$$\n因此，我们可以写出：\n$$E = K_{\\mathrm{leaf}} \\cdot |\\Delta\\Psi_{\\mathrm{leaf}}|$$\n我们可以解出水势下降的大小：\n$$|\\Delta\\Psi_{\\mathrm{leaf}}| = \\frac{E}{K_{\\mathrm{leaf}}}$$\n我们已经计算出 $E$，而已知 $K_{\\mathrm{leaf}} = 5\\ \\mathrm{mmol\\,m^{-2}\\,s^{-1}\\,MPa^{-1}}$。我们必须使用具有相同摩尔通量单位的 $E$ 值，即 $\\mathrm{mmol\\,m^{-2}\\,s^{-1}}$。\n$$|\\Delta\\Psi_{\\mathrm{leaf}}| = \\frac{9.8692\\ \\mathrm{mmol\\,m^{-2}\\,s^{-1}}}{5\\ \\mathrm{mmol\\,m^{-2}\\,s^{-1}\\,MPa^{-1}}}$$\n$$|\\Delta\\Psi_{\\mathrm{leaf}}| \\approx 1.97384\\ \\mathrm{MPa}$$\n四舍五入到三位有效数字，叶片水势下降的大小为：\n$$|\\Delta\\Psi_{\\mathrm{leaf}}| \\approx 1.97\\ \\mathrm{MPa}$$\n这表示在给定条件下，为了以足以匹配向大气的蒸发损失的速率从木质部吸取水分，叶片内部所需的水势下降值。", "answer": "$$\n\\boxed{\\begin{pmatrix} 9.87  1.97 \\end{pmatrix}}\n$$", "id": "2838746"}, {"introduction": "研究气体交换的最终目的通常是为了理解光合作用的限制因素。这最后一个练习 [@problem_id:2838893] 将向你介绍功能强大的 Farquhar-von Caemmerer-Berry (FvCB) 模型，这是模拟 $\\text{C}_3$ 植物光合作用的黄金标准。通过将该模型与实验数据进行拟合，你不仅将估算出关键的生化参数，还将学会如何量化地剖析碳固定过程中的限制因素，特别是计算气孔限制 ($L_s$)——这是生态生理学研究中的一项核心任务。", "problem": "给定稳态净光合作用同化速率与胞间二氧化碳摩尔分数的数据，通常称为 $A$–$C_i$ 曲线，该曲线在叶温 $25\\,^\\circ\\text{C}$、饱和光辐照度下为一片 $\\text{C}_3$ 叶片测得。假设该叶片的生化响应遵循 Farquhar–von Caemmerer–Berry (FvCB) 模型，并且饱和光下的电子传递速率是恒定的，等于 $J_\\max$。您将首先根据测量的 $A$–$C_i$ 数据估计生化参数，然后根据观测到的胞间二氧化碳摩尔分数，计算在环境二氧化碳浓度下的光合作用气孔限制。\n\n基本假设和模型假设：\n- 净同化速率 $A$ 被建模为 Rubisco 限制速率 $A_c$ 和 1,5-二磷酸核酮糖再生限制速率 $A_j$ 中的较小值，减去日间呼吸速率 $R_d$：\n$$A(C_i; V_{c\\max}, J, R_d) \\;=\\; \\min\\{A_c(C_i; V_{c\\max}),\\, A_j(C_i; J)\\} \\;-\\; R_d$$\n- Rubisco 限制速率为：\n$$A_c(C_i; V_{c\\max}) \\;=\\; V_{c\\max}\\,\\frac{C_i - \\Gamma^\\ast}{C_i + K_c\\left(1 + \\dfrac{O_i}{K_o}\\right)}$$\n- 饱和光辐照度下的电子传递限制速率（因此 $J \\approx J_\\max$ 被视为一个常数参数）为：\n$$A_j(C_i; J) \\;=\\; J\\,\\frac{C_i - \\Gamma^\\ast}{4\\,C_i + 8\\,\\Gamma^\\ast}$$\n- 在所有计算中使用的 $25\\,^\\circ\\text{C}$ 下的常数：\n    - 二氧化碳的米氏常数 $K_c = 404\\ \\mathrm{\\mu mol\\,mol^{-1}}$，\n    - 氧气的米氏常数 $K_o = 278000\\ \\mathrm{\\mu mol\\,mol^{-1}}$，\n    - 无日间呼吸情况下的叶绿体二氧化碳补偿点 $\\Gamma^\\ast = 42\\ \\mathrm{\\mu mol\\,mol^{-1}}$，\n    - 胞间氧气摩尔分数 $O_i = 210000\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n\n待计算的气孔限制定义：\n- 对于给定的环境二氧化碳摩尔分数 $C_a$ 和观测到的胞间二氧化碳摩尔分数 $C_i^{\\mathrm{obs}}$，将气孔限制 $L_s$ 定义为，在生化参数保持固定的情况下，由 $C_a$ 和 $C_i^{\\mathrm{obs}}$ 之间的差异引起的净同化相对减少量：\n$$L_s \\;=\\; \\frac{A(C_a; \\widehat{V}_{c\\max}, \\widehat{J}, \\widehat{R}_d) \\;-\\; A(C_i^{\\mathrm{obs}}; \\widehat{V}_{c\\max}, \\widehat{J}, \\widehat{R}_d)}{A(C_a; \\widehat{V}_{c\\max}, \\widehat{J}, \\widehat{R}_d)}$$\n此处，$\\widehat{V}_{c\\max}$、$\\widehat{J}$ 和 $\\widehat{R}_d$ 是通过在给定的 $C_i$ 值上最小化测量值 $A$ 与模型 $A(C_i; V_{c\\max}, J, R_d)$ 之间的残差平方和，从 $A$–$C_i$ 测量数据中估计出的参数。\n\n所有的 $C_i$ 和 $C_a$ 值都必须视为以 $\\mathrm{\\mu mol\\,mol^{-1}}$ 为单位的摩尔分数。所有的 $A$ 值都必须视为以 $\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$ 为单位的净同化速率。不涉及角度。\n\n您的程序必须：\n1. 对于每个测试用例，使用提供的 $A$–$C_i$ 数据和上述模型，通过非线性最小二乘法估计 $\\widehat{V}_{c\\max}$、$\\widehat{J}$ 和 $\\widehat{R}_d$。\n2. 使用拟合的参数，计算 $A(C_a)$ 和 $A(C_i^{\\mathrm{obs}})$，然后根据上述定义计算 $L_s$。\n3. 对每个测试用例，报告 $L_s$ 作为一个四位小数的十进制数。\n\n测试套件：\n- 对每个测试用例使用上面给出的常数 $K_c$、$K_o$、$\\Gamma^\\ast$ 和 $O_i$。对于所有测试用例，除非另有说明，否则使用 $C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$；在本问题中，$C_a$ 始终固定为 $400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n\n测试用例 1（理想情况，在 $C_i$ 范围内为混合限制）：\n- 测量的胞间二氧化碳摩尔分数 $C_i$（单位 $\\mathrm{\\mu mol\\,mol^{-1}}$）：$[50, 100, 150, 200, 250, 300, 400, 600, 800]$。\n- 测量的净同化速率 $A$（单位 $\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$）：$[-0.55, 4.96, 9.82, 14.14, 18.02, 21.51, 27.55, 31.13, 32.80]$。\n- 观测到的 $C_i^{\\mathrm{obs}} = 260\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n- 使用 $C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n\n测试用例 2（评估点无气孔限制的边界条件）：\n- 测量的胞间二氧化碳摩尔分数 $C_i$（单位 $\\mathrm{\\mu mol\\,mol^{-1}}$）：$[50, 100, 150, 200, 250, 300, 400, 600, 800]$。\n- 测量的净同化速率 $A$（单位 $\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$）：$[-0.74, 6.61, 13.09, 18.85, 24.02, 28.68, 36.73, 42.37, 45.91]$。\n- 观测到的 $C_i^{\\mathrm{obs}} = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n- 使用 $C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n\n测试用例 3（气孔限制更强、暗呼吸更高的边缘情况）：\n- 测量的胞间二氧化碳摩尔分数 $C_i$（单位 $\\mathrm{\\mu mol\\,mol^{-1}}$）：$[50, 100, 150, 200, 250, 300, 400, 600, 800]$。\n- 测量的净同化速率 $A$（单位 $\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$）：$[-1.87, 1.80, 5.05, 7.93, 10.51, 12.84, 16.87, 21.97, 23.22]$。\n- 观测到的 $C_i^{\\mathrm{obs}} = 200\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n- 使用 $C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含对应于这些测试用例的三个 $L_s$ 结果，格式为方括号括起来的逗号分隔列表，例如 `[x_1,x_2,x_3]`，其中每个 $x_i$ 是一个四位小数的十进制数（无单位）。输出必须只有一行，并且只包含此列表。", "solution": "该问题陈述具有科学依据，提法明确且自成体系。它描述了植物生态生理学中的一个标准流程：将 Farquhar–von Caemmerer–Berry (FvCB) 模型拟合到 $A$–$C_i$ 曲线上以估计生化参数，然后利用这些参数量化气孔对光合作用的限制程度。提供的所有方程、常数和数据都是标准且符合实际的。因此，该问题被认定为有效，并将提供解决方案。\n\n任务首先是根据经验数据估计模型参数——最大羧化速率 ($V_{c\\max}$)、光饱和电子传递速率 ($J$) 和日间呼吸速率 ($R_d$)。然后，使用这些估计出的参数来计算气孔限制 ($L_s$)。\n\n净同化速率 $A$ 由 FvCB 模型给出：\n$$A(C_i; V_{c\\max}, J, R_d) \\;=\\; \\min\\{A_c(C_i; V_{c\\max}),\\, A_j(C_i; J)\\} \\;-\\; R_d$$\n其中 $C_i$ 是胞间 $\\text{CO}_2$ 摩尔分数。两个贡献速率分别是 Rubisco 限制速率 $A_c$ 和 RuBP 再生限制速率 $A_j$。\n\nRubisco 限制速率为：\n$$A_c(C_i; V_{c\\max}) \\;=\\; V_{c\\max}\\,\\frac{C_i - \\Gamma^\\ast}{C_i + K_c\\left(1 + \\dfrac{O_i}{K_o}\\right)}$$\nRuBP 再生限制速率为：\n$$A_j(C_i; J) \\;=\\; J\\,\\frac{C_i - \\Gamma^\\ast}{4\\,C_i + 8\\,\\Gamma^\\ast}$$\n分析使用了以下在叶温 $25\\,^\\circ\\text{C}$ 时有效的常数：\n- $\\text{CO}_2$ 的米氏常数, $K_c = 404\\ \\mathrm{\\mu mol\\,mol^{-1}}$\n- $\\text{O}_2$ 的米氏常数, $K_o = 278000\\ \\mathrm{\\mu mol\\,mol^{-1}}$\n- $\\text{CO}_2$ 补偿点, $\\Gamma^\\ast = 42\\ \\mathrm{\\mu mol\\,mol^{-1}}$\n- 胞间 $\\text{O}_2$ 摩尔分数, $O_i = 210000\\ \\mathrm{\\mu mol\\,mol^{-1}}$\n\n$K_c\\left(1 + \\frac{O_i}{K_o}\\right)$ 项代表在 $\\text{O}_2$ 作为竞争性抑制剂存在下，$\\text{CO}_2$ 的有效米氏常数。我们可以预先计算这个值，记为 $K_m$：\n$$K_m = 404\\,\\left(1 + \\frac{210000}{278000}\\right) \\approx 709.18\\ \\mathrm{\\mu mol\\,mol^{-1}}$$\n\n该过程包括两个主要步骤：\n1.  **参数估计**：对于每个测试用例，通过将模型 $A(C_i; V_{c\\max}, J, R_d)$ 拟合到所提供的 $(C_i, A)$ 数据对来确定参数 $\\widehat{V}_{c\\max}$、$\\widehat{J}$ 和 $\\widehat{R}_d$。这是通过非线性最小二乘回归实现的，该方法最小化了测量同化速率与模型同化速率之间的残差平方和。这些参数被约束为非负，因为它们代表物理量。\n\n2.  **气孔限制 ($L_s$) 的计算**：利用估计出的参数 $(\\widehat{V}_{c\\max}, \\widehat{J}, \\widehat{R}_d)$，根据其定义计算气孔限制：\n$$L_s \\;=\\; \\frac{A(C_a; \\widehat{V}_{c\\max}, \\widehat{J}, \\widehat{R}_d) \\;-\\; A(C_i^{\\mathrm{obs}}; \\widehat{V}_{c\\max}, \\widehat{J}, \\widehat{R}_d)}{A(C_a; \\widehat{V}_{c\\max}, \\widehat{J}, \\widehat{R}_d)}$$\n此处，$A(C_a; \\dots)$ 是假设气孔对 $\\text{CO}_2$ 扩散没有阻力（即 $C_i = C_a$）时的假想同化速率，而 $A(C_i^{\\mathrm{obs}}; \\dots)$ 是在观测到的胞间 $\\text{CO}_2$ 浓度下的同化速率。对于所有情况，$C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。\n\n我们现在将此过程应用于每个测试用例。\n\n**测试用例 1**\n- 输入数据：\n  - $C_i$ ($\\mathrm{\\mu mol\\,mol^{-1}}$): $[50, 100, 150, 200, 250, 300, 400, 600, 800]$\n  - $A$ ($\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$): $[-0.55, 4.96, 9.82, 14.14, 18.02, 21.51, 27.55, 31.13, 32.80]$\n  - $C_i^{\\mathrm{obs}} = 260\\ \\mathrm{\\mu mol\\,mol^{-1}}$\n- 参数估计得出：\n  - $\\widehat{V}_{c\\max} \\approx 80.08\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $\\widehat{J} \\approx 137.99\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $\\widehat{R}_d \\approx 1.26\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n- 计算同化速率：\n  - $A(C_a) = A(400; \\widehat{\\vec{p}}) \\approx 25.568\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $A(C_i^{\\mathrm{obs}}) = A(260; \\widehat{\\vec{p}}) \\approx 18.572\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n- 气孔限制：\n  - $L_s = \\frac{25.568 - 18.572}{25.568} \\approx 0.2736$\n\n**测试用例 2**\n- 输入数据：\n  - $C_i$ ($\\mathrm{\\mu mol\\,mol^{-1}}$): $[50, 100, 150, 200, 250, 300, 400, 600, 800]$\n  - $A$ ($\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$): $[-0.74, 6.61, 13.09, 18.85, 24.02, 28.68, 36.73, 42.37, 45.91]$\n  - $C_i^{\\mathrm{obs}} = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$\n- 参数估计得出：\n  - $\\widehat{V}_{c\\max} \\approx 106.77\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $\\widehat{J} \\approx 186.09\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $\\widehat{R}_d \\approx 1.49\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n- 在此情况下，$C_i^{\\mathrm{obs}} = C_a = 400\\ \\mathrm{\\mu mol\\,mol^{-1}}$。根据定义，$L_s$ 表达式中的分子为零。\n  - $A(C_a) - A(C_i^{\\mathrm{obs}}) = A(400; \\widehat{\\vec{p}}) - A(400; \\widehat{\\vec{p}}) = 0$\n- 气孔限制：\n  - $L_s = 0.0000$\n\n**测试用例 3**\n- 输入数据：\n  - $C_i$ ($\\mathrm{\\mu mol\\,mol^{-1}}$): $[50, 100, 150, 200, 250, 300, 400, 600, 800]$\n  - $A$ ($\\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$): $[-1.87, 1.80, 5.05, 7.93, 10.51, 12.84, 16.87, 21.97, 23.22]$\n  - $C_i^{\\mathrm{obs}} = 200\\ \\mathrm{\\mu mol\\,mol^{-1}}$\n- 参数估计得出：\n  - $\\widehat{V}_{c\\max} \\approx 50.16\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $\\widehat{J} \\approx 80.57\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $\\widehat{R}_d \\approx 2.31\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n- 计算同化速率：\n  - $A(C_a) = A(400; \\widehat{\\vec{p}}) \\approx 16.143\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n  - $A(C_i^{\\mathrm{obs}}) = A(200; \\widehat{\\vec{p}}) \\approx 8.272\\ \\mathrm{\\mu mol\\,m^{-2}\\,s^{-1}}$\n- 气孔限制：\n  - $L_s = \\frac{16.143 - 8.272}{16.143} \\approx 0.4876$\n\n对于测试用例 1、2 和 3，最终的 $L_s$ 结果四舍五入到四位小数分别为 $0.2736$、$0.0000$ 和 $0.4876$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the stomatal limitation problem for three test cases.\n    1. Fits the FvCB model to A-Ci data to find Vcmax, J, and Rd.\n    2. Calculates stomatal limitation (Ls) based on the fitted parameters.\n    \"\"\"\n    \n    # Define constants for the FvCB model at 25 degrees C\n    KC = 404.0  # Michaelis-Menten constant for CO2 (umol/mol)\n    KO = 278000.0  # Michaelis-Menten constant for O2 (umol/mol)\n    GAMMA_STAR = 42.0  # CO2 compensation point (umol/mol)\n    OI = 210000.0  # Intercellular O2 mole fraction (umol/mol)\n    \n    # Pre-calculate the effective Michaelis-Menten constant for CO2\n    KM = KC * (1.0 + OI / KO)\n\n    def fvcbm_model(Ci, Vcmax, J, Rd):\n        \"\"\"\n        Farquhar-von Caemmerer-Berry model for C3 photosynthesis.\n        \n        Args:\n            Ci (float or np.ndarray): Intercellular CO2 concentration (umol/mol).\n            Vcmax (float): Maximum rate of Rubisco carboxylation (umol/m^2/s).\n            J (float): Rate of electron transport (umol/m^2/s).\n            Rd (float): Day respiration rate (umol/m^2/s).\n\n        Returns:\n            float or np.ndarray: Net photosynthetic assimilation rate (A).\n        \"\"\"\n        Ci = np.asarray(Ci)\n        \n        # Rubisco-limited rate of carboxylation\n        Ac = Vcmax * (Ci - GAMMA_STAR) / (Ci + KM)\n        \n        # RuBP regeneration-limited rate (electron transport-limited)\n        Aj = J * (Ci - GAMMA_STAR) / (4.0 * Ci + 8.0 * GAMMA_STAR)\n        \n        # Net assimilation is the minimum of the two limited rates, minus day respiration.\n        # np.minimum provides element-wise minimum for arrays.\n        A = np.minimum(Ac, Aj) - Rd\n        return A\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: Happy path\n        {\n            \"ci_data\": np.array([50, 100, 150, 200, 250, 300, 400, 600, 800]),\n            \"a_data\": np.array([-0.55, 4.96, 9.82, 14.14, 18.02, 21.51, 27.55, 31.13, 32.80]),\n            \"ci_obs\": 260.0,\n            \"ca\": 400.0\n        },\n        # Case 2: Boundary condition with no stomatal limitation\n        {\n            \"ci_data\": np.array([50, 100, 150, 200, 250, 300, 400, 600, 800]),\n            \"a_data\": np.array([-0.74, 6.61, 13.09, 18.85, 24.02, 28.68, 36.73, 42.37, 45.91]),\n            \"ci_obs\": 400.0,\n            \"ca\": 400.0\n        },\n        # Case 3: Edge case with stronger stomatal limitation\n        {\n            \"ci_data\": np.array([50, 100, 150, 200, 250, 300, 400, 600, 800]),\n            \"a_data\": np.array([-1.87, 1.80, 5.05, 7.93, 10.51, 12.84, 16.87, 21.97, 23.22]),\n            \"ci_obs\": 200.0,\n            \"ca\": 400.0\n        }\n    ]\n\n    results = []\n    \n    # Initial guess for the parameters [Vcmax, J, Rd]\n    p0 = [100.0, 180.0, 1.0]\n    # Bounds for the parameters (must be non-negative)\n    bounds = (0, np.inf)\n\n    for case in test_cases:\n        ci_data = case[\"ci_data\"]\n        a_data = case[\"a_data\"]\n        ci_obs = case[\"ci_obs\"]\n        ca = case[\"ca\"]\n\n        # 1. Estimate parameters using nonlinear least squares\n        params, _ = curve_fit(fvcbm_model, ci_data, a_data, p0=p0, bounds=bounds)\n        vcmax_hat, j_hat, rd_hat = params\n\n        # 2. Compute A(Ca) and A(Ci_obs) using the fitted parameters\n        A_ca = fvcbm_model(ca, vcmax_hat, j_hat, rd_hat)\n        A_ci_obs = fvcbm_model(ci_obs, vcmax_hat, j_hat, rd_hat)\n\n        # 3. Compute stomatal limitation Ls\n        # If A_ca is > 0, Ls is ill-defined, but this is biochemically not expected at Ca=400.\n        if A_ca  0:\n            ls = (A_ca - A_ci_obs) / A_ca\n        else:\n            # This case should not be reached with the given data.\n            # If C_i_obs == C_a, Ls is exactly 0.\n            ls = 0.0 if ci_obs == ca else np.nan\n\n        # Append result formatted to four decimal places\n        results.append(f\"{ls:.4f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\n# Execute the main function\nsolve()\n```", "id": "2838893"}]}