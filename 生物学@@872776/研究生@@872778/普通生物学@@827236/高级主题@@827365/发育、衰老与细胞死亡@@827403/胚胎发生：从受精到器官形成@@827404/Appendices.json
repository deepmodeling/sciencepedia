{"hands_on_practices": [{"introduction": "胚胎发生不仅是一个遗传程序，也是一个物理过程，其中囊胚腔等关键结构的形成依赖于机械力的精妙平衡。本练习将引导你运用力学第一性原理，推导控制薄壁上皮组织形态的杨-拉普拉斯方程，从而定量理解静水压力、皮层张力和组织曲率如何共同作用，塑造出胚胎的早期三维结构。[@problem_id:2795119]", "problem": "哺乳动物囊胚可以理想化为一个薄的、封闭的上皮壳，包裹着一个充满液体的囊胚腔。假设该上皮层是一个力学上均匀、各向同性的薄壳，具有每单位长度恒定的皮层张力 $T$（面内积分张力；弯曲刚度可忽略不计），其内部的静水压力比外部介质高出 $\\Delta P = P_{\\mathrm{in}} - P_{\\mathrm{out}}$。该壳体处于静态力学平衡状态。仅使用局部力平衡和几何学原理，推导囊胚腔扩张过程中 $\\Delta P$、 $T$ 和组织曲率之间的关系。\n\n具体要求：\n- 考虑壳体上的一个由正交主曲率方向界定的小面元，其中心点的主曲率半径为 $R_{1}$ 和 $R_{2}$，并在薄壳近似下对该面元进行垂直于表面的力平衡分析。\n- 首先用 $R_{1}$ 和 $R_{2}$ 表示你的结果，然后用平均曲率 $H$ 表示，其中 $H$ 定义为 $H = \\frac{1}{2}\\left(\\frac{1}{R_{1}} + \\frac{1}{R_{2}}\\right)$。\n- 最后，将你的表达式应用于半径为 $R$ 的球体情况，并验证其一致性。\n\n最终答案请提供一个仅用 $T$ 和 $H$ 表示的关于 $\\Delta P$ 的闭式解析表达式。不需要进行数值计算，也不需要四舍五入。最终表达式中不应包含单位。", "solution": "该问题陈述已经过严格验证，并被认定是有效的。它在科学上基于连续介质力学原理，特别是薄壳理论，并且是生物物理学中一个适定问题。给定的条件是充分且一致的，术语是精确的。因此，我们可以进行推导。\n\n目标是推导封闭上皮壳内部的超压 $\\Delta P$ 与壳体几何形状及力学张力 $T$ 之间的关系。根据题目要求，我们需要对壳体上的一个无穷小面元进行力平衡分析。\n\n让我们考虑壳体表面的一个微小的矩形面元。我们将局部坐标系与主曲率方向对齐。该面元沿这两个正交方向的边长分别为 $ds_{1}$ 和 $ds_{2}$。相应的主曲率半径为 $R_{1}$ 和 $R_{2}$。这个面元的面积是 $dA = ds_{1} ds_{2}$。\n\n有两种力作用于此面元：由压力差 $\\Delta P$ 产生的作用于表面法向的力，以及由皮层张力 $T$ 产生的作用于面元边缘切向的力。为了使壳体处于静态平衡，所有作用于面元法向的力分量之和必须为零。\n\n1.  由压力产生的力：\n    压力差 $\\Delta P = P_{\\mathrm{in}} - P_{\\mathrm{out}}$ 对面元施加一个垂直于表面的力 $d\\vec{F}_{P}$。该力的大小等于压力差乘以面元面积。此力沿向外的法线方向作用。\n    $$dF_{P} = \\Delta P \\, dA = \\Delta P \\, ds_{1} ds_{2}$$\n\n2.  由皮层张力产生的力：\n    皮层张力 $T$ 是单位长度上的力，沿面元的边界并与表面相切。\n    考虑长度为 $ds_{2}$ 的两条边，它们被弧长 $ds_{1}$ 分隔开。作用在这些边上的张力大小为 $T ds_{2}$。由于表面在此方向上以半径 $R_{1}$ 弯曲，这两个力矢量不是平行的。它们之间有一个小角度 $d\\theta_{1} = \\frac{ds_{1}}{R_{1}}$。通过考虑几何关系，可以找到这些力在面元法向上的分量。每个力矢量与面元中心的切平面形成 $\\frac{d\\theta_{1}}{2}$ 的角度。指向内部（朝向曲率中心）的法向合力分量由下式给出：\n    $$dF_{T,1} = 2 \\left( T \\, ds_{2} \\right) \\sin\\left(\\frac{d\\theta_{1}}{2}\\right)$$\n    对于无穷小面元，角度 $d\\theta_{1}$ 非常小，所以我们可以使用小角度近似 $\\sin(x) \\approx x$。\n    $$dF_{T,1} \\approx 2 \\left( T \\, ds_{2} \\right) \\left(\\frac{d\\theta_{1}}{2}\\right) = T \\, ds_{2} \\, d\\theta_{1}$$\n    代入 $d\\theta_{1} = \\frac{ds_{1}}{R_{1}}$，我们得到：\n    $$dF_{T,1} = T \\, ds_{2} \\frac{ds_{1}}{R_{1}} = T \\frac{dA}{R_{1}}$$\n    对另一对长度为 $ds_{1}$ 的边进行相同的分析，它们沿着曲率半径为 $R_{2}$ 的曲线被弧长 $ds_{2}$ 分隔，得到的向内法向合力为：\n    $$dF_{T,2} = T \\, ds_{1} \\frac{ds_{2}}{R_{2}} = T \\frac{dA}{R_{2}}$$\n    由张力产生的总向内力是这两个分量的和：\n    $$dF_{T} = dF_{T,1} + dF_{T,2} = T \\, dA \\left(\\frac{1}{R_{1}} + \\frac{1}{R_{2}}\\right)$$\n\n3.  力平衡：\n    为使面元处于静态平衡，向外的压力必须与总的向内张力相平衡：\n    $$dF_{P} = dF_{T}$$\n    $$\\Delta P \\, dA = T \\, dA \\left(\\frac{1}{R_{1}} + \\frac{1}{R_{2}}\\right)$$\n    两边同除以非零的面积元 $dA$，我们得到用主曲率半径表示的关系式：\n    $$\\Delta P = T \\left(\\frac{1}{R_{1}} + \\frac{1}{R_{2}}\\right)$$\n    这就是薄弹性膜的杨-拉普拉斯方程。\n\n4.  用平均曲率表示：\n    问题将平均曲率 $H$ 定义为：\n    $$H = \\frac{1}{2}\\left(\\frac{1}{R_{1}} + \\frac{1}{R_{2}}\\right)$$\n    从这个定义可以得出，主曲率之和为 $2H$：\n    $$\\frac{1}{R_{1}} + \\frac{1}{R_{2}} = 2H$$\n    将此代入我们推导出的 $\\Delta P$ 方程：\n    $$\\Delta P = T(2H) = 2TH$$\n    这就是题目所要求的用 $T$ 和 $H$ 表示 $\\Delta P$ 的表达式。\n\n5.  球体验证：\n    最后，我们将此结果应用于半径为 $R$ 的球体。对于球体上的任意一点，表面是各向同性的，两个主曲率半径都等于球体的半径：$R_{1} = R_{2} = R$。\n    使用我们结果的第一种形式：\n    $$\\Delta P = T \\left(\\frac{1}{R} + \\frac{1}{R}\\right) = T \\left(\\frac{2}{R}\\right) = \\frac{2T}{R}$$\n    现在，我们来计算球体的平均曲率：\n    $$H = \\frac{1}{2}\\left(\\frac{1}{R} + \\frac{1}{R}\\right) = \\frac{1}{2}\\left(\\frac{2}{R}\\right) = \\frac{1}{R}$$\n    使用我们结果的第二种形式以及这个 $H$ 值：\n    $$\\Delta P = 2TH = 2T\\left(\\frac{1}{R}\\right) = \\frac{2T}{R}$$\n    两种表达式都得出了对于球壳的相同、正确且众所周知的结果，这证实了我们一般性推导的一致性和正确性。题目要求的最终答案是用 $T$ 和 $H$ 表示 $\\Delta P$ 的表达式。", "answer": "$$\n\\boxed{2TH}\n$$", "id": "2795119"}, {"introduction": "当胚胎结构形成后，其内部细胞必须根据自身位置获得不同命运，这一过程通常由充当化学坐标系的形态发生素梯度所调控。本练习深入探讨了发育生物学的基石之一——反应-扩散模型，解释了稳定的化学梯度是如何建立的。通过求解稳态浓度并推导特征长度尺度 $\\lambda = \\sqrt{D/k}$，你将洞悉扩散和降解速率等分子特性如何决定发育信号的作用范围和形态。[@problem_id:2795045]", "problem": "在发育中的脊椎动物胚胎中，一个分泌的形态发生素在早期器官形成过程中，在一个平面的上皮组织薄片上建立了一个位置信息梯度。考虑一个一维组织区域 $x \\in [0, L]$，其中形态发生素的浓度为 $c(x,t)$。假设以下基本生物物理原理成立：菲克定律（Fick’s law）描述的扩散通量 $J(x,t)$，即 $J = -D\\,\\partial c/\\partial x$（其中扩散系数 $D$ 为常数），在存在空间均匀的生产源 $S$ 和速率常数为 $k$ 的一级降解过程的情况下，$c(x,t)$ 满足质量守恒，且组织是均匀和各向同性的。\n\n(a) 从质量守恒和菲克定律出发，写出 $c(x,t)$ 的控制性偏微分方程（PDE）。\n\n(b) 在长时间后，系统达到稳态。在稳态条件下，求解在 $[0,L]$ 上的 $c(x)$，其满足近端 $x=0$ 处的无通量边界条件（即 $\\partial c/\\partial x \\big|_{x=0} = 0$）和远端 $x=L$ 处的完美汇边界条件（即 $c(L)=0$）。用 $D$、$k$、$S$、$L$ 和 $x$ 表示你的解。\n\n(c) 利用稳态解的结构和控制性常微分方程的齐次部分，确定控制 $c(x)$ 衰减空间范围的内在梯度长度尺度，并仅用 $D$ 和 $k$ 的符号表达式报告结果。\n\n仅报告 (c) 部分要求的表达式作为你的最终答案。不包括单位。无需进行数值计算。", "solution": "该问题是一个数学 生物学中的标准练习，具体涉及模拟形态发生素梯度的反应扩散系统。它具有科学依据，是适定问题，并包含了进行严谨求解所需的所有信息。因此，我们将按要求分三部分验证问题并推导解答。\n\n首先，验证问题陈述。\n已知条件如下：\n1. 一个一维区域 $x \\in [0, L]$。\n2. 形态发生素浓度 $c(x,t)$。\n3. 菲克扩散定律：$J = -D\\,\\frac{\\partial c}{\\partial x}$，其中 $D$ 为常数。\n4. $c(x,t)$ 的质量守恒。\n5. 一个空间均匀的生产源 $S$。\n6. 一个速率常数为 $k$ 的一级降解过程。\n7. $x=0$ 处的无通量边界条件：$\\frac{\\partial c}{\\partial x} \\big|_{x=0} = 0$。\n8. $x=L$ 处的完美汇边界条件：$c(L) = 0$。\n9. 系统处于稳态（$\\frac{\\partial c}{\\partial t} = 0$）。\n\n该问题是有效的。它是基于基本原理（质量守恒，菲克扩散）的物理过程的典型表示，因此在科学上是合理的。它是一个适定问题，提供了一个二阶微分方程和两个边界条件，确保了唯一解的存在。所有术语都有定义，并且没有矛盾之处。\n\n(a) 控制性偏微分方程（PDE）的推导。\n\n我们从质量守恒原理开始。考虑一个从位置 $x$ 到 $x + \\Delta x$ 的无限小组织控制体积。该体积中形态发生素的总量为 $\\int_{x}^{x+\\Delta x} c(\\xi, t) \\,d\\xi$。该总量随时间的变化率是流入该体积的净通量以及局部生产和降解的净效应之和。\n\n形态发生素总量的变化率为：\n$$ \\frac{\\partial}{\\partial t} \\int_{x}^{x+\\Delta x} c(\\xi, t) \\,d\\xi $$\n这个变化由在 $x$ 处流入的通量、在 $x+\\Delta x$ 处流出的通量、体积内的生产以及体积内的降解所平衡：\n$$ \\frac{\\partial}{\\partial t} \\int_{x}^{x+\\Delta x} c(\\xi, t) \\,d\\xi = J(x,t) - J(x+\\Delta x, t) + \\int_{x}^{x+\\Delta x} (S - k c(\\xi,t)) \\,d\\xi $$\n对于一个无限小的体积 $\\Delta x$，我们可以近似积分：$\\int_{x}^{x+\\Delta x} c(\\xi, t) \\,d\\xi \\approx c(x,t)\\Delta x$。应用此近似并将整个方程除以 $\\Delta x$，我们得到：\n$$ \\frac{\\partial c(x,t)}{\\partial t} \\approx -\\frac{J(x+\\Delta x, t) - J(x,t)}{\\Delta x} + S - k c(x,t) $$\n取 $\\Delta x \\to 0$ 的极限，右边的第一项变为通量对位置的负偏导数：\n$$ \\frac{\\partial c}{\\partial t} = -\\frac{\\partial J}{\\partial x} + S - k c $$\n这是该系统的通用连续性方程。现在，我们将菲克定律 $J = -D \\frac{\\partial c}{\\partial x}$ 代入此方程：\n$$ \\frac{\\partial c}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left(-D \\frac{\\partial c}{\\partial x}\\right) + S - k c $$\n鉴于扩散系数 $D$ 是常数，可以将其移到空间导数之外。这样就得到了最终的控制性PDE，这是一个反应扩散方程：\n$$ \\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2} - k c + S $$\n\n(b) 稳态浓度分布 $c(x)$ 的求解。\n\n在稳态下，浓度分布不再随时间变化，这意味着 $\\frac{\\partial c}{\\partial t} = 0$。(a) 部分的PDE简化为一个二阶常微分方程（ODE）：\n$$ D \\frac{d^2 c}{d x^2} - k c + S = 0 $$\n我们可以将其重新排列为线性非齐次ODE的标准形式：\n$$ \\frac{d^2 c}{d x^2} - \\frac{k}{D} c = -\\frac{S}{D} $$\n通解 $c(x)$ 是齐次解 $c_h(x)$ 和一个特解 $c_p(x)$ 的和。\n\n通过观察可以找到特解 $c_p(x)$。由于右侧是一个常数，我们假设一个常数特解 $c_p(x) = A$。代入ODE得到 $0 - \\frac{k}{D} A = -\\frac{S}{D}$，这意味着 $A = \\frac{S}{k}$。因此，$c_p(x) = \\frac{S}{k}$。\n\n齐次方程为 $\\frac{d^2 c_h}{d x^2} - \\frac{k}{D} c_h = 0$。其特征方程是 $r^2 - \\frac{k}{D} = 0$，根为 $r = \\pm \\sqrt{\\frac{k}{D}}$。为方便起见，我们定义一个特征长度尺度 $\\lambda = \\sqrt{\\frac{D}{k}}$。这样根就是 $r = \\pm \\frac{1}{\\lambda}$。齐次方程的通解可以写为 $c_h(x) = C_1 e^{x/\\lambda} + C_2 e^{-x/\\lambda}$，或者，为了更方便地应用给定的边界条件，可以用双曲函数表示：\n$$ c_h(x) = B_1 \\cosh\\left(\\frac{x}{\\lambda}\\right) + B_2 \\sinh\\left(\\frac{x}{\\lambda}\\right) $$\n因此，完整的通解是：\n$$ c(x) = B_1 \\cosh\\left(\\frac{x}{\\lambda}\\right) + B_2 \\sinh\\left(\\frac{x}{\\lambda}\\right) + \\frac{S}{k} $$\n我们现在应用边界条件来确定常数 $B_1$ 和 $B_2$。首先，我们需要 $c(x)$ 的导数：\n$$ \\frac{dc}{dx} = \\frac{B_1}{\\lambda} \\sinh\\left(\\frac{x}{\\lambda}\\right) + \\frac{B_2}{\\lambda} \\cosh\\left(\\frac{x}{\\lambda}\\right) $$\n$x=0$ 处的无通量条件表明 $\\frac{dc}{dx}\\big|_{x=0} = 0$：\n$$ \\frac{B_1}{\\lambda} \\sinh(0) + \\frac{B_2}{\\lambda} \\cosh(0) = \\frac{B_1}{\\lambda}(0) + \\frac{B_2}{\\lambda}(1) = \\frac{B_2}{\\lambda} = 0 $$\n这意味着 $B_2 = 0$。解简化为：\n$$ c(x) = B_1 \\cosh\\left(\\frac{x}{\\lambda}\\right) + \\frac{S}{k} $$\n接下来，我们应用 $x=L$ 处的完美汇条件，即 $c(L) = 0$：\n$$ B_1 \\cosh\\left(\\frac{L}{\\lambda}\\right) + \\frac{S}{k} = 0 $$\n求解 $B_1$ 得到：\n$$ B_1 = -\\frac{S/k}{\\cosh(L/\\lambda)} $$\n将 $B_1$ 代回到 $c(x)$ 的表达式中，我们得到最终的稳态解：\n$$ c(x) = \\frac{S}{k} - \\frac{S/k}{\\cosh(L/\\lambda)} \\cosh\\left(\\frac{x}{\\lambda}\\right) = \\frac{S}{k} \\left(1 - \\frac{\\cosh(x/\\lambda)}{\\cosh(L/\\lambda)}\\right) $$\n代入 $\\lambda = \\sqrt{D/k}$ 得到完整的表达式：\n$$ c(x) = \\frac{S}{k} \\left( 1 - \\frac{\\cosh\\left(x\\sqrt{k/D}\\right)}{\\cosh\\left(L\\sqrt{k/D}\\right)} \\right) $$\n\n(c) 内在梯度长度尺度的确定。\n\n问题要求的是控制梯度空间范围的内在长度尺度。这个尺度是生物物理过程本身所固有的，与边界条件或区域大小无关，尽管这些因素会影响最终的浓度分布。通过分析控制性ODE的齐次部分可以揭示这个尺度：\n$$ \\frac{d^2 c_h}{d x^2} - \\frac{k}{D} c_h = 0 $$\n为了使这个方程在量纲上一致，项 $\\frac{k}{D}$ 的单位必须是长度的平方的倒数。我们定义一个参数 $\\lambda$，使得 $\\frac{1}{\\lambda^2} = \\frac{k}{D}$。这样，方程可以写成：\n$$ \\lambda^2 \\frac{d^2 c_h}{d x^2} - c_h = 0 $$\n在这里，$\\lambda$ 的单位必须是长度。它的值为 $\\lambda = \\sqrt{\\frac{D}{k}}$。这个齐次方程的解是形如 $\\exp(\\pm x/\\lambda)$ 的指数函数。因此，参数 $\\lambda$ 是浓度分布发生显著衰减或变化的特征长度。它代表了一个典型的形态发生素分子在被一级降解过程移除之前所扩散的距离。这就是所要求的内在梯度长度尺度。", "answer": "$$ \\boxed{\\sqrt{\\frac{D}{k}}} $$", "id": "2795045"}, {"introduction": "发育是一个高度动态的过程，但许多现代技术（如单细胞RNA测序）仅能提供静态快照。RNA速度是一种强大的计算方法，可以从这些快照中推断出细胞的未来状态。本练习将指导你实现RNA速度的核心计算，让你了解如何利用转录动力学模型，从剪接与未剪接的mRNA比例中预测细胞的分化轨迹。[@problem_id:2795038]", "problem": "您将获得一个用于研究从受精到器官发生过程中胚胎发育转录动力学的原理性框架，该框架使用核糖核酸（RNA）速率 (velocity)。其目标是将基本的基因表达动力学与一个算法联系起来，该算法能从每个细胞每个基因观测到的未剪接与已剪接计数的比率中，推断出已剪接信使RNA（mRNA）丰度的瞬时变化方向，然后利用此速率来评估沿分化轴的谱系流。\n\n基本原理。假设一个单一基因，其未剪接转录本计数表示为 $U(t)$，已剪接转录本计数表示为 $S(t)$。在短时间范围内，遵循具有恒定速率的一阶质量作用动力学，转录以速率 $\\alpha$ 产生未剪接RNA，剪接以速率 $\\beta$ 将未剪接RNA转化为已剪接RNA，而已剪接RNA以速率 $\\gamma$ 降解。那么，经过充分检验的模型是\n$$\n\\frac{dU}{dt} = \\alpha - \\beta U,\\qquad \\frac{dS}{dt} = \\beta U - \\gamma S.\n$$\n在稳态时，$\\frac{dS}{dt} = 0$ 意味着 $\\beta U = \\gamma S$，这定义了 $(U,S)$ 相图中的稳态线。偏离这条线的程度决定了 $\\frac{dS}{dt}$ 的符号和大小：如果 $\\beta U - \\gamma S > 0$，则已剪接丰度增加（上调）；如果 $\\beta U - \\gamma S < 0$，则其减少（下调）。对于一个给定细胞中 $G$ 个独立的基因，其基因特异性速率为 $(\\beta_g,\\gamma_g)$，测量到的计数为 $(U_g,S_g)$，则在已剪接计数空间中的瞬时速率是分量为 $\\frac{dS_g}{dt} = \\beta_g U_g - \\gamma_g S_g$ 的向量。\n\n任务。实现一个程序，为下面描述的每个测试用例计算：\n1. 对每个细胞 $i$，计算基因层面的RNA速率向量 $\\mathbf{v}_i \\in \\mathbb{R}^G$，其分量为 $v_{i,g} = \\beta_g U_{i,g} - \\gamma_g S_{i,g}$。\n2. 一个谱系轴向量 $\\mathbf{a} \\in \\mathbb{R}^G$，定义为一组指定终末细胞的平均已剪接表达量与一组指定祖细胞的平均已剪接表达量之差：\n$$\n\\mathbf{a} = \\frac{1}{N_{\\text{term}}} \\sum_{i \\in \\mathcal{T}} \\mathbf{S}_i - \\frac{1}{N_{\\text{prog}}} \\sum_{i \\in \\mathcal{P}} \\mathbf{S}_i,\n$$\n其中 $\\mathcal{T}$ 和 $\\mathcal{P}$ 分别是终末细胞和祖细胞的索引集。如果 $\\|\\mathbf{a}\\|_2 = 0$，则取单位轴 $\\hat{\\mathbf{a}} = \\mathbf{0}$；否则，设 $\\hat{\\mathbf{a}} = \\mathbf{a} / \\|\\mathbf{a}\\|_2$。\n3. 每个细胞速率向量在谱系轴上的标量投影 $p_i$，即 $p_i = \\mathbf{v}_i \\cdot \\hat{\\mathbf{a}}$。\n4. 测试用例中所有细胞的平均投影 $\\bar{p} = \\frac{1}{N}\\sum_{i=1}^{N} p_i$。\n\n您的程序应为每个测试用例计算 $\\bar{p}$，并生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\bar{p}_1,\\bar{p}_2,\\bar{p}_3]$）。将每个 $\\bar{p}$ 四舍五入到三位小数。不需要物理单位。不要使用角度。\n\n测试套件。每个测试用例提供：\n- 基因数量 $G$。\n- 基因特异性剪接和降解速率 $\\{\\beta_g\\}_{g=1}^G$ 和 $\\{\\gamma_g\\}_{g=1}^G$。\n- 细胞数量 $N$。\n- 未剪接和已剪接计数矩阵 $U \\in \\mathbb{R}^{N \\times G}$ 和 $S \\in \\mathbb{R}^{N \\times G}$。\n- 祖细胞索引集 $\\mathcal{P}$ 和终末细胞索引集 $\\mathcal{T}$，使用基于 0 的索引指定。\n\n按测试用例的精确顺序提供输出。\n\n测试用例 1 (沿分化方向的递增流):\n- $G = 2$。\n- $\\beta = [\\,0.8,\\,0.6\\,]$, $\\gamma = [\\,0.3,\\,0.4\\,]$。\n- $N = 4$。\n- $S = \\begin{bmatrix} 2.0  1.0 \\\\ 2.5  1.2 \\\\ 6.0  3.0 \\\\ 7.0  3.5 \\end{bmatrix}$, $U = \\begin{bmatrix} 1.5  1.5 \\\\ 1.8  1.0 \\\\ 2.0  2.5 \\\\ 2.1  2.4 \\end{bmatrix}$。\n- $\\mathcal{P} = \\{\\,0,\\,1\\,\\}$, $\\mathcal{T} = \\{\\,2,\\,3\\,\\}$。\n\n测试用例 2 (接近稳态；边界行为):\n- $G = 2$。\n- $\\beta = [\\,0.8,\\,0.6\\,]$, $\\gamma = [\\,0.3,\\,0.4\\,]$。\n- $N = 4$。\n- $S = \\begin{bmatrix} 4.0  3.0 \\\\ 5.0  2.0 \\\\ 3.0  3.0 \\\\ 6.0  3.0 \\end{bmatrix}$, $U = \\begin{bmatrix} 1.5  2.0 \\\\ 1.875  4/3 \\\\ 1.125  2.0 \\\\ 2.25  2.0 \\end{bmatrix}$。\n- $\\mathcal{P} = \\{\\,0,\\,1\\,\\}$, $\\mathcal{T} = \\{\\,2,\\,3\\,\\}$。\n\n测试用例 3 (与分化方向相反的递减流):\n- $G = 2$。\n- $\\beta = [\\,0.8,\\,0.6\\,]$, $\\gamma = [\\,0.3,\\,0.4\\,]$。\n- $N = 4$。\n- $S = \\begin{bmatrix} 2.0  2.0 \\\\ 2.2  2.5 \\\\ 5.0  5.5 \\\\ 6.0  6.0 \\end{bmatrix}$, $U = \\begin{bmatrix} 0.5  0.8 \\\\ 0.6  0.9 \\\\ 1.2  1.0 \\\\ 1.5  1.2 \\end{bmatrix}$。\n- $\\mathcal{P} = \\{\\,0,\\,1\\,\\}$, $\\mathcal{T} = \\{\\,2,\\,3\\,\\}$。\n\n实现要求：\n- 使用上述模型和定义，不要引入任何额外假设。\n- 为每个测试用例计算平均投影 $\\bar{p}$，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的三个四舍五入后的结果，并以逗号分隔。", "solution": "问题陈述已经过严格评估，并被确定为 **有效**。它在科学上基于单细胞转录组学的标准RNA速率模型，该模型建立在一阶质量作用动力学之上。所有定义、方程和数据均已提供，使得该问题自成体系、定义明确，且无矛盾或歧义。其目标是实现一个指定的计算算法，这是一项数学上合理的任务。\n\n目标是为三个不同的测试用例计算细胞RNA速率向量在定义的谱系轴上的平均投影 $\\bar{p}$。每个测试用例的步骤如下。\n\n首先，给定基因数量 $G$、细胞数量 $N$、基因特异性剪接速率 $\\boldsymbol{\\beta} \\in \\mathbb{R}^G$ 和降解速率 $\\boldsymbol{\\gamma} \\in \\mathbb{R}^G$。我们还获得了未剪接计数矩阵 $U \\in \\mathbb{R}^{N \\times G}$ 和已剪接计数矩阵 $S \\in \\mathbb{R}^{N \\times G}$。这些矩阵的行对应于细胞，列对应于基因。\n\n计算步骤列举如下：\n\n1.  **计算RNA速率矩阵**：对每个细胞 $i$，计算其RNA速率向量 $\\mathbf{v}_i \\in \\mathbb{R}^G$。其分量由已剪接mRNA的变化率公式给出：$v_{i,g} = \\frac{dS_{i,g}}{dt} = \\beta_g U_{i,g} - \\gamma_g S_{i,g}$。此计算针对所有 $N$ 个细胞和 $G$ 个基因进行，从而得到一个速率矩阵 $V \\in \\mathbb{R}^{N \\times G}$。使用基于数组的计算，这可以表示为一个广播的逐元素操作：\n    $$\n    V = U \\circ \\boldsymbol{\\beta}^T - S \\circ \\boldsymbol{\\gamma}^T\n    $$\n    其中 $\\circ$ 表示哈达玛积，$\\boldsymbol{\\beta}^T$ 和 $\\boldsymbol{\\gamma}^T$ 会被有效地广播到 $U$ 和 $S$ 的各行。\n\n2.  **计算谱系轴向量**：谱系轴 $\\mathbf{a} \\in \\mathbb{R}^G$ 量化了从祖细胞状态到终末状态的已剪接基因表达变化的主要方向。它被定义为终末细胞和祖细胞的平均已剪接表达量之差。给定祖细胞索引集 $\\mathcal{P}$ 和终末细胞索引集 $\\mathcal{T}$，其基数分别为 $N_{\\text{prog}}$ 和 $N_{\\text{term}}$，我们计算：\n    $$\n    \\bar{\\mathbf{S}}_{\\mathcal{P}} = \\frac{1}{N_{\\text{prog}}} \\sum_{i \\in \\mathcal{P}} \\mathbf{S}_i\n    \\qquad \\text{和} \\qquad\n    \\bar{\\mathbf{S}}_{\\mathcal{T}} = \\frac{1}{N_{\\text{term}}} \\sum_{i \\in \\mathcal{T}} \\mathbf{S}_i\n    $$\n    其中 $\\mathbf{S}_i$ 是矩阵 $S$ 的第 $i$ 行。那么轴向量为：\n    $$\n    \\mathbf{a} = \\bar{\\mathbf{S}}_{\\mathcal{T}} - \\bar{\\mathbf{S}}_{\\mathcal{P}}\n    $$\n\n3.  **归一化谱系轴**：将轴向量 $\\mathbf{a}$ 归一化为单位向量 $\\hat{\\mathbf{a}}$ 以仅表示方向。这通过除以其欧几里得范数 $\\|\\mathbf{a}\\|_2$ 来实现：\n    $$\n    \\hat{\\mathbf{a}} = \\frac{\\mathbf{a}}{\\|\\mathbf{a}\\|_2}\n    $$\n    如果 $\\|\\mathbf{a}\\|_2 = 0$（这发生在平均祖细胞和终末细胞图谱相同时），则归一化轴定义为零向量 $\\hat{\\mathbf{a}} = \\mathbf{0}$。\n\n4.  **将速率投影到轴上**：使用点积计算每个细胞的速率向量 $\\mathbf{v}_i$ 在归一化谱系轴 $\\hat{\\mathbf{a}}$ 上的标量投影 $p_i$：\n    $$\n    p_i = \\mathbf{v}_i \\cdot \\hat{\\mathbf{a}}\n    $$\n    这个值表示与分化方向一致的速率分量的大小。正的 $p_i$ 意味着细胞的转录状态沿谱系“前进”，而负的 $p_i$ 则意味着“后退”或去分化。这些投影可以通过速率矩阵 $V$ 和向量 $\\hat{\\mathbf{a}}$ 的矩阵-向量乘法来为所有细胞同时计算。\n\n5.  **计算平均投影**：最后，计算所有 $N$ 个细胞的平均投影 $\\bar{p}$，以获得细胞群体整体谱系流的摘要统计量：\n    $$\n    \\bar{p} = \\frac{1}{N} \\sum_{i=1}^{N} p_i\n    $$\n\n该算法被应用于所提供的三个测试用例中的每一个。每个用例得到的 $\\bar{p}$ 值均四舍五入到三位小数。\n\n- **测试用例 1**：数据描述了细胞沿分化轴移动，从而产生正的平均投影。\n- **测试用例 2**：数据的构建使得所有细胞都处于或接近稳态（$\\frac{dS}{dt} \\approx 0$）。因此，所有速率向量均为零，导致投影为零，平均投影为 $0.000$。\n- **测试用例 3**：数据描述了细胞的转录动力学与分化方向相反，从而产生负的平均投影。\n\n最终输出将是这三个计算值的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mean projected RNA velocity for three test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"G\": 2,\n            \"beta\": np.array([0.8, 0.6]),\n            \"gamma\": np.array([0.3, 0.4]),\n            \"N\": 4,\n            \"S\": np.array([[2.0, 1.0], [2.5, 1.2], [6.0, 3.0], [7.0, 3.5]]),\n            \"U\": np.array([[1.5, 1.5], [1.8, 1.0], [2.0, 2.5], [2.1, 2.4]]),\n            \"P_indices\": [0, 1],\n            \"T_indices\": [2, 3],\n        },\n        {\n            \"G\": 2,\n            \"beta\": np.array([0.8, 0.6]),\n            \"gamma\": np.array([0.3, 0.4]),\n            \"N\": 4,\n            \"S\": np.array([[4.0, 3.0], [5.0, 2.0], [3.0, 3.0], [6.0, 3.0]]),\n            \"U\": np.array([[1.5, 2.0], [1.875, 4/3], [1.125, 2.0], [2.25, 2.0]]),\n            \"P_indices\": [0, 1],\n            \"T_indices\": [2, 3],\n        },\n        {\n            \"G\": 2,\n            \"beta\": np.array([0.8, 0.6]),\n            \"gamma\": np.array([0.3, 0.4]),\n            \"N\": 4,\n            \"S\": np.array([[2.0, 2.0], [2.2, 2.5], [5.0, 5.5], [6.0, 6.0]]),\n            \"U\": np.array([[0.5, 0.8], [0.6, 0.9], [1.2, 1.0], [1.5, 1.2]]),\n            \"P_indices\": [0, 1],\n            \"T_indices\": [2, 3],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack data for the current test case\n        U = case[\"U\"]\n        S = case[\"S\"]\n        beta = case[\"beta\"]\n        gamma = case[\"gamma\"]\n        N = case[\"N\"]\n        P_indices = case[\"P_indices\"]\n        T_indices = case[\"T_indices\"]\n\n        # 1. Compute the gene-wise RNA velocity vector v_i for each cell i\n        # V is an N x G matrix where each row is a velocity vector v_i\n        V = U * beta - S * gamma\n\n        # 2. Compute the lineage axis vector a\n        S_prog = S[P_indices, :]\n        S_term = S[T_indices, :]\n        \n        # Calculate mean expression for progenitor and terminal cells\n        mean_S_prog = np.mean(S_prog, axis=0)\n        mean_S_term = np.mean(S_term, axis=0)\n        \n        a = mean_S_term - mean_S_prog\n\n        # Normalize the lineage axis vector a\n        norm_a = np.linalg.norm(a)\n        if norm_a == 0:\n            a_hat = np.zeros_like(a)\n        else:\n            a_hat = a / norm_a\n\n        # 3. Compute the scalar projection p_i of each cell's velocity onto the lineage axis\n        # p is a vector of N projections\n        projections = V @ a_hat\n\n        # 4. Compute the mean projection p_bar\n        p_bar = np.mean(projections)\n        \n        results.append(p_bar)\n\n    # Format results to three decimal places for the final output\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2795038"}]}