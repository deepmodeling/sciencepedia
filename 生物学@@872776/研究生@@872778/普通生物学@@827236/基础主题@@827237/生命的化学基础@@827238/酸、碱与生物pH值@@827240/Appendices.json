{"hands_on_practices": [{"introduction": "要掌握酸碱化学的核心，就必须理解质子转移的自发方向。本练习将通过一个经典的质子转移反应，让你利用参与反应的酸的 $\\mathrm{p}K_a$ 值来推导和计算平衡常数。这个过程将加深你对“反应偏向于形成更弱的酸和更弱的碱”这一基本原则的定量理解，这是分析生物化学反应和酶催化机制的基础。[@problem_id:2772450]", "problem": "一个细胞溶胶微环境被建模为 $25\\,^{\\circ}\\mathrm{C}$ 下的理想水溶液，其中共轭酸碱对之间的质子转移决定了缓冲方向性。考虑质子转移反应\n$\\ce{NH4^+ + CH3COO^- \\rightleftharpoons NH3 + CH3COOH}$，\n该反应使共轭酸碱对 $\\ce{NH4^+}/\\ce{NH3}$ 和 $\\ce{CH3COOH}/\\ce{CH3COO^-}$ 相互转化。给定酸解离常数（以其以10为底的负对数值，即 $\\mathrm{p}K_\\mathrm{a}$ 值给出）：$\\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+}) = 9.25$ 和 $\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH}) = 4.76$，两者均在 $25\\,^{\\circ}\\mathrm{C}$ 下测得。假设离子强度足够低，使得活度系数约等于 $1$，因此活度等于浓度。\n\n请仅从水溶液中酸的酸解离常数 $K_\\mathrm{a}$ 和化学反应平衡常数 $K$ 的基本定义出发，推导反应 $\\ce{NH4^+ + CH3COO^- \\rightleftharpoons NH3 + CH3COOH}$ 的平衡常数 $K$ 的表达式，并用参与反应的酸的酸解离常数来表示。然后，使用给定的 $\\mathrm{p}K_\\mathrm{a}$ 值计算 $K$ 的数值。\n\n将您的最终数值答案表示为一个无量纲数，并四舍五入到 $3$ 位有效数字。", "solution": "该问题陈述具有科学依据、问题明确且客观。它提出了一个标准的化学平衡问题，并提供了充分且一致的数据。该问题不违反化学或热力学的任何基本原理，且没有歧义。因此，该问题是有效的，将提供解答。\n\n任务是为质子转移反应：\n$$ \\ce{NH4^+ + CH3COO^- \\rightleftharpoons NH3 + CH3COOH} $$\n推导平衡常数 $K$ 的表达式，并随后计算其在 $25\\,^{\\circ}\\mathrm{C}$ 下的数值。\n\n根据理想水溶液中反应的平衡常数的基本定义，其中活度近似等于摩尔浓度，$K$ 表示为：\n$$ K = \\frac{[\\ce{NH3}][\\ce{CH3COOH}]}{[\\ce{NH4^+}][\\ce{CH3COO^-}]} $$\n该表达式可以分解为两个浓度比的乘积：\n$$ K = \\left( \\frac{[\\ce{NH3}]}{[\\ce{NH4^+}]} \\right) \\left( \\frac{[\\ce{CH3COOH}]}{[\\ce{CH3COO^-}]} \\right) $$\n\n为继续推导，我们必须引入所涉及的两个共轭酸碱对的酸解离常数 $K_\\mathrm{a}$ 的定义。\n\n首先，考虑铵离子 $\\ce{NH4^+}$ 的酸解离，它是 $\\ce{NH4^+}/\\ce{NH3}$ 对中的酸：\n$$ \\ce{NH4^+ (aq) + H2O (l) \\rightleftharpoons NH3 (aq) + H3O^+ (aq)} $$\n相应的酸解离常数，我们记为 $K_{\\mathrm{a},1}$，由下式给出：\n$$ K_{\\mathrm{a},1} = K_\\mathrm{a}(\\ce{NH4^+}) = \\frac{[\\ce{NH3}][\\ce{H3O^+}]}{[\\ce{NH4^+}]} $$\n从这个方程中，我们可以表达出我们 $K$ 表达式中所需的第一个比值：\n$$ \\frac{[\\ce{NH3}]}{[\\ce{NH4^+}]} = \\frac{K_\\mathrm{a}(\\ce{NH4^+})}{[\\ce{H3O^+}]} $$\n\n其次，考虑乙酸 $\\ce{CH3COOH}$ 的酸解离，它是 $\\ce{CH3COOH}/\\ce{CH3COO^-}$ 对中的酸：\n$$ \\ce{CH3COOH (aq) + H2O (l) \\rightleftharpoons CH3COO^- (aq) + H3O^+ (aq)} $$\n相应的酸解离常数，我们记为 $K_{\\mathrm{a},2}$，由下式给出：\n$$ K_{\\mathrm{a},2} = K_\\mathrm{a}(\\ce{CH3COOH}) = \\frac{[\\ce{CH3COO^-}][\\ce{H3O^+}]}{[\\ce{CH3COOH}]} $$\n从这个方程中，我们可以表达出我们 $K$ 表达式中所需的第二个比值的倒数：\n$$ \\frac{[\\ce{CH3COO^-}]}{[\\ce{CH3COOH}]} = \\frac{K_\\mathrm{a}(\\ce{CH3COOH})}{[\\ce{H3O^+}]} $$\n通过对该表达式取倒数，我们得到第二个比值：\n$$ \\frac{[\\ce{CH3COOH}]}{[\\ce{CH3COO^-}]} = \\frac{[\\ce{H3O^+}]}{K_\\mathrm{a}(\\ce{CH3COOH})} $$\n\n现在，将这两个比值的表达式代回到总平衡常数 $K$ 的方程中：\n$$ K = \\left( \\frac{K_\\mathrm{a}(\\ce{NH4^+})}{[\\ce{H3O^+}]} \\right) \\left( \\frac{[\\ce{H3O^+}]}{K_\\mathrm{a}(\\ce{CH3COOH})} \\right) $$\n水合氢离子的浓度 $[\\ce{H3O^+}]$ 同时出现在分子和分母中，因此可以消去。这就得到了最终推导出的用各个酸解离常数表示的 $K$ 的表达式：\n$$ K = \\frac{K_\\mathrm{a}(\\ce{NH4^+})}{K_\\mathrm{a}(\\ce{CH3COOH})} $$\n这个结果与化学平衡的组合规则一致：总反应等效于 $\\ce{NH4^+}$ 的解离反应和 $\\ce{CH3COOH}$ 解离的逆反应的叠加。因此，平衡常数是 $K_\\mathrma(\\ce{NH4^+})$ 与 $1/K_\\mathrma(\\ce{CH3COOH})$ 的乘积。\n\n为了计算 $K$ 的数值，我们使用给定的 $\\mathrm{p}K_\\mathrm{a}$ 值：$\\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+}) = 9.25$ 和 $\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH}) = 4.76$。$\\mathrm{p}K_\\mathrm{a}$ 的定义是 $\\mathrm{p}K_\\mathrm{a} = -\\log_{10}(K_\\mathrm{a})$，这意味着 $K_\\mathrm{a} = 10^{-\\mathrm{p}K_\\mathrm{a}}$。\n\n我们可以用 $\\mathrm{p}K_\\mathrm{a}$ 值来表示 $K$：\n$$ K = \\frac{10^{-\\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+})}}{10^{-\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH})}} = 10^{\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH}) - \\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+})} $$\n代入给定的数值：\n$$ K = 10^{4.76 - 9.25} = 10^{-4.49} $$\n计算得出：\n$$ K \\approx 3.2359365 \\times 10^{-5} $$\n题目要求最终答案四舍五入到 $3$ 位有效数字。\n$$ K \\approx 3.24 \\times 10^{-5} $$\n$K$ 的值远小于 $1$，这表明在平衡时，反应物（$\\ce{NH4^+}$ 和 $\\ce{CH3COO^-}$）远比产物（$\\ce{NH3}$ 和 $\\ce{CH3COOH}$）占优势。这是预料之中的，因为该反应涉及质子从一个较弱的酸（$\\ce{NH4^+}$，具有较高的 $\\mathrm{p}K_\\mathrm{a}$ 值）转移到一个较强酸（$\\ce{CH3COOH}$，具有较低的 $\\mathrm{p}K_\\mathrm{a}$ 值）的共轭碱上，这是一个热力学上不利的过程。", "answer": "$$\n\\boxed{3.24 \\times 10^{-5}}\n$$", "id": "2772450"}, {"introduction": "亨德森-哈塞尔巴尔赫方程是生物化学中计算缓冲溶液pH值的基石，但它通常基于稀溶液的理想假设。本练习将挑战这一理想化视图，让你在一个类似于细胞质的高离子强度环境中，量化使用浓度而非活度（activity）来计算缓冲液pH所引入的误差。通过这个实践，你将深刻理解在真实生理条件下考虑离子间相互作用的重要性，这对于精确研究细胞功能至关重要。[@problem_id:2772446]", "problem": "一种模拟细胞溶质的缓冲液由等摩尔的磷酸二氢钠和磷酸氢二钠组成，因此共轭酸碱对为 $\\mathrm{H_{2}PO_{4}^{-}}$ 和 $\\mathrm{HPO_{4}^{2-}}$，其分析浓度为 $c_{\\mathrm{H_{2}PO_{4}^{-}}} = c_{\\mathrm{HPO_{4}^{2-}}}$。该缓冲液处于一种介质中，其离子强度通过惰性支持电解质被固定在 $I = 0.200\\ \\mathrm{M}$。温度为 $25^{\\circ}\\mathrm{C}$。假设使用热力学酸解离常数（以活度定义），并忽略 $\\mathrm{H^{+}}$ 和 $\\mathrm{OH^{-}}$ 对 $I$ 的贡献。\n\n仅从活度 $a_{i} = \\gamma_{i} c_{i}$ 的定义、单质子酸的热力学酸解离常数 $K_{a}$ 以及 $\\mathrm{pH}$ 的定义出发，量化在此磷酸盐缓冲液的给定离子强度下，Henderson–Hasselbalch 关系式中用浓度替代活度所引入的带符号误差 $\\Delta \\mathrm{pH}$，其中\n- $\\Delta \\mathrm{pH} \\equiv \\mathrm{pH}_{\\text{conc}} - \\mathrm{pH}_{\\text{act}}$，\n- $z_{\\mathrm{H_{2}PO_{4}^{-}}} = -1$ 且 $z_{\\mathrm{HPO_{4}^{2-}}} = -2$，\n- 在离子强度 $I$ 下的单离子活度系数由 Davies 方程描述\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right),\n$$\n在 $25^{\\circ}\\mathrm{C}$ 时 $A = 0.509$。\n\n将 $\\Delta \\mathrm{pH}$ 的最终答案表示为一个带符号的十进制数，单位为 pH 单位（无量纲），并四舍五入到四位有效数字。", "solution": "目标是计算在固定离子强度下，对于共轭对 $\\mathrm{H_{2}PO_{4}^{-}}/\\mathrm{HPO_{4}^{2-}}$，仅用浓度替代预测的 $\\mathrm{pH}$ 与基于活度的正确表达式预测的 $\\mathrm{pH}$ 之间的差异。\n\n从单质子酸解离 $\\mathrm{HA} \\rightleftharpoons \\mathrm{H^{+}} + \\mathrm{A^{-}}$ 的热力学定义开始，\n$$\nK_{a} \\equiv \\frac{a_{\\mathrm{H^{+}}}\\, a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}, \\quad \\text{其中} \\quad a_{i} = \\gamma_{i} c_{i}.\n$$\n根据定义，\n$$\n\\mathrm{pH} \\equiv -\\log_{10} a_{\\mathrm{H^{+}}}, \\quad \\mathrm{p}K_{a} \\equiv -\\log_{10} K_{a}.\n$$\n对 $K_{a}$ 表达式取 $\\log_{10}$ 并重新整理得到\n$$\n-\\log_{10} a_{\\mathrm{H^{+}}} = -\\log_{10} K_{a} + \\log_{10}\\!\\left(\\frac{a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}\\right),\n$$\n这得到了基于活度的 Henderson–Hasselbalch 形式\n$$\n\\mathrm{pH}_{\\text{act}} = \\mathrm{p}K_{a} + \\log_{10}\\!\\left(\\frac{a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}\\right).\n$$\n如果用浓度替代活度，预测的 $\\mathrm{pH}$ 将是\n$$\n\\mathrm{pH}_{\\text{conc}} = \\mathrm{p}K_{a} + \\log_{10}\\!\\left(\\frac{c_{\\mathrm{A^{-}}}}{c_{\\mathrm{HA}}}\\right).\n$$\n因此，带符号误差为\n$$\n\\Delta \\mathrm{pH} \\equiv \\mathrm{pH}_{\\text{conc}} - \\mathrm{pH}_{\\text{act}} \n= \\log_{10}\\!\\left(\\frac{c_{\\mathrm{A^{-}}}}{c_{\\mathrm{HA}}}\\right) - \\log_{10}\\!\\left(\\frac{a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}\\right)\n= -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{A^{-}}}}{\\gamma_{\\mathrm{HA}}}\\right).\n$$\n对于磷酸盐缓冲液，我们定义 $\\mathrm{A^{-}} \\equiv \\mathrm{HPO_{4}^{2-}}$ 和 $\\mathrm{HA} \\equiv \\mathrm{H_{2}PO_{4}^{-}}$。在给定条件 $c_{\\mathrm{HPO_{4}^{2-}}} = c_{\\mathrm{H_{2}PO_{4}^{-}}}$ 下，浓度比相互抵消，因此误差仅取决于单离子活度系数之比：\n$$\n\\Delta \\mathrm{pH} = -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right).\n$$\n\n接下来，使用 Davies 方程计算 $I = 0.200$ 时的活度系数，\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right), \\quad A = 0.509.\n$$\n首先以符号形式，然后以数值形式计算依赖于离子强度的括号项：\n$$\nB(I) \\equiv \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I, \\quad \\text{因此} \\quad \\log_{10}\\gamma_{i} = -A z_{i}^{2} B(I).\n$$\n当 $I = 0.200$ 时，\n$$\n\\sqrt{I} = \\sqrt{0.200}, \\quad 0.3\\, I = 0.3 \\times 0.200 = 0.060.\n$$\n数值上，\n$$\n\\frac{\\sqrt{I}}{1+\\sqrt{I}} \\approx 0.3090169944, \\quad B(0.200) \\approx 0.3090169944 - 0.060 = 0.2490169944.\n$$\n因此，\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} B(0.200) \\approx -0.509 \\times z_{i}^{2} \\times 0.2490169944.\n$$\n对于 $z = -1$ 的 $\\mathrm{H_{2}PO_{4}^{-}}$，\n$$\n\\log_{10}\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}} \\approx -0.509 \\times 1 \\times 0.2490169944 = -0.1267496501.\n$$\n对于 $z = -2$ 的 $\\mathrm{HPO_{4}^{2-}}$，\n$$\n\\log_{10}\\gamma_{\\mathrm{HPO_{4}^{2-}}} \\approx -0.509 \\times 4 \\times 0.2490169944 = -0.5069986004.\n$$\n它们比值的对数为\n$$\n\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right) = \\log_{10}\\gamma_{\\mathrm{HPO_{4}^{2-}}} - \\log_{10}\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}} \\approx -0.5069986004 - (-0.1267496501) = -0.3802489503.\n$$\n因此，带符号误差为\n$$\n\\Delta \\mathrm{pH} = -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right) \\approx -(-0.3802489503) = 0.3802489503.\n$$\n解释该符号的意义，$\\Delta \\mathrm{pH}  0$ 表明，在 $I = 0.200$ 时，使用浓度而非活度会高估该缓冲液的 $\\mathrm{pH}$。四舍五入到四位有效数字，得到\n$$\n\\Delta \\mathrm{pH} \\approx 0.3802.\n$$", "answer": "$$\\boxed{0.3802}$$", "id": "2772446"}, {"introduction": "细胞pH的稳定并非一个简单的静态平衡，而是一个由多种转运蛋白、酶和代谢过程共同维持的动态稳态。在这个综合性练习中，你将构建一个计算模型来模拟这种复杂的生理调控。通过整合离子交换体、质子泵和碳酸氢盐缓冲系统的动力学，你将能预测在不同外界条件下细胞如何维持其内部pH稳定，从而将知识从孤立的原理提升到系统生物学层面。[@problem_id:2772402]", "problem": "你必须编写一个完整且可运行的程序，通过在转运蛋白介导的质子等效通量下强制实现质量和电荷平衡，来计算稳态胞质酸度（以 pH 表示）。转运过程包括钠/质子交换体、氯/碳酸氢根交换体以及液泡型三磷酸腺苷酶（ATP）质子泵。你的程序必须实现以下科学基础和建模假设，然后对一小组测试用例进行数值求解稳态问题。\n\n使用的基础原理（从这些原理推导，不要假设任何额外的简化公式）：\n- 二氧化碳/碳酸氢盐系统的酸碱平衡：假设二氧化碳在膜两侧快速平衡，并遵循固定二氧化碳分压下的 Henderson–Hasselbalch 关系式。使用二氧化碳溶解度系数 $\\alpha_{\\mathrm{CO_2}}$ 和分压 $P_{\\mathrm{CO_2}}$，细胞外和细胞内的碳酸氢盐浓度满足\n  $$\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left(\\frac{[\\mathrm{HCO_3^-}]}{\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}}\\right)。$$\n  因此，给定 $\\mathrm{pH}$，$[\\mathrm{HCO_3^-}]$ 由 $[\\mathrm{HCO_3^-}] = \\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}} \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}$ 确定。本问题中所有浓度均以 $\\mathrm{mM}$ 为单位，$\\mathrm{pH}$ 是无量纲的。\n\n- 电中性 $1:1$ 交换体的可逆质量作用动力学：对于一个通用交换体 $A_{\\mathrm{out}} + B_{\\mathrm{in}} \\rightleftharpoons A_{\\mathrm{in}} + B_{\\mathrm{out}}$，净摩尔通量密度与两侧驱动反应物浓度乘积之差成正比：\n  $$J = g\\left([A]_{\\mathrm{out}}[B]_{\\mathrm{in}} - [A]_{\\mathrm{in}}[B]_{\\mathrm{out}}\\right)，$$\n  其中 $g$ 是一个具有适当单位的唯象的类电导系数。将此定律应用于钠/质子交换体（$\\mathrm{Na^+/H^+}$，交换一个细胞外的 $\\mathrm{Na^+}$ 和一个细胞内的 $\\mathrm{H^+}$）和氯/碳酸氢根交换体（$\\mathrm{Cl^-/HCO_3^-}$，交换一个细胞外的 $\\mathrm{Cl^-}$ 和一个细胞内的 $\\mathrm{HCO_3^-}$）。假设两种交换体都是电中性的，且不受膜电位的直接影响。\n\n- 液泡型三磷酸腺苷酶质子泵的饱和主动转运：将质子外排泵送建模为一个依赖于细胞内自由质子浓度的类 Michaelis–Menten 过程，\n  $$J_{\\mathrm{V}} = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}}{K + [\\mathrm{H^+}]_{\\mathrm{in}}}。$$\n\n- 稳态下的质子等效质量平衡：定义符号约定，贡献值为正表示增加细胞内自由质子浓度。设 $J_{\\mathrm{met}}$ 为恒定的细胞内质子产生速率（代谢性酸负荷）。设 $J_{\\mathrm{NHE}}$ 表示由质量作用模型（其中 $A=\\mathrm{Na^+}$ 和 $B=\\mathrm{H^+}$）定义的净 $\\mathrm{Na^+/H^+}$ 交换摩尔通量密度，设 $J_{\\mathrm{AE}}$ 表示由质量作用模型（其中 $A=\\mathrm{Cl^-}$ 和 $B=\\mathrm{HCO_3^-}$）定义的净 $\\mathrm{Cl^-/HCO_3^-}$ 交换摩尔通量密度。因为 $\\mathrm{Na^+/H^+}$ 正向运行时会输出 $\\mathrm{H^+}$，液泡型三磷酸腺苷酶也会输出 $\\mathrm{H^+}$，而 $\\mathrm{Cl^-/HCO_3^-}$ 输入的碱会中和每个进入的碳酸氢根所对应的一个质子，所以稳态条件是\n  $$0 = J_{\\mathrm{met}} - J_{\\mathrm{NHE}} - J_{\\mathrm{V}} - J_{\\mathrm{AE}}，$$\n  其中 $J_{\\mathrm{AE}}$ 被理解为由氯/碳酸氢根交换体质量作用项定义的碳酸氢根流入量（因此当其为正时，会降低细胞内质子浓度）。\n\n- 胞质电中性：包含一个单一的、不反应的、不可渗透的细胞内阴离子 $[\\mathrm{A^-}]_{\\mathrm{in}}$ 来表示固定负电荷（蛋白质和代谢物）。你必须强制执行代数电荷平衡\n  $$[\\mathrm{Na^+}]_{\\mathrm{in}} + [\\mathrm{K^+}]_{\\mathrm{in}} + [\\mathrm{H^+}]_{\\mathrm{in}} = [\\mathrm{Cl^-}]_{\\mathrm{in}} + [\\mathrm{HCO_3^-}]_{\\mathrm{in}} + [\\mathrm{A^-}]_{\\mathrm{in}}，$$\n  并且在确定稳态 $\\mathrm{pH}_{\\mathrm{in}}$ 后，你必须根据此关系式计算 $[\\mathrm{A^-}]_{\\mathrm{in}}$。不需要求解渗透平衡；将所有给定的浓度视为参数或从上述关系式代数推导出的变量。不要对膜电位进行建模或输出。\n\n需要实现的数值细节：\n- 使用上述 Henderson–Hasselbalch 关系式，其中 $\\mathrm{p}K_a = 6.1$（无量纲），$\\alpha_{\\mathrm{CO_2}} = 0.03$（单位 $\\mathrm{mM/mmHg}$），以及 $P_{\\mathrm{CO_2}} = 40$（单位 $\\mathrm{mmHg}$），除非另有说明。使用 $\\mathrm{pH}$ 通过 $[\\mathrm{H^+}] = 10^{-\\mathrm{pH}} \\times 1000$ 来计算 $[\\mathrm{H^+}]$，以 $\\mathrm{mM}$ 为单位表示。\n\n- 对于每个测试用例，在物理上合理的区间内求解 $\\mathrm{pH}_{\\mathrm{in}}$ 的稳态方程，以计算细胞内 $\\mathrm{pH}$。你必须尽可能在区间 $\\mathrm{pH}_{\\mathrm{in}} \\in [5.5, 8.8]$ 内找到一个实根；如果端点值不能包围一个根，则通过采样在该区间内搜索一个包围根的区间，然后应用稳健的区间求根算法。找到 $\\mathrm{pH}_{\\mathrm{in}}$ 后，使用电中性方程计算 $[\\mathrm{A^-}]_{\\mathrm{in}}$。你不需要打印 $[\\mathrm{A^-}]_{\\mathrm{in}}$，但你的实现必须在内部计算它以验证电荷平衡。\n\n测试套件（所有浓度单位为 $\\mathrm{mM}$，除非明确说明；$\\mathrm{pH}$ 无量纲）：\n- 所有测试用例的通用常量：\n  - $[\\mathrm{Na^+}]_{\\mathrm{out}} = 140$, $[\\mathrm{Na^+}]_{\\mathrm{in}} = 12$, $[\\mathrm{Cl^-}]_{\\mathrm{out}} = 110$, $[\\mathrm{Cl^-}]_{\\mathrm{in}} = 15$, $[\\mathrm{K^+}]_{\\mathrm{in}} = 140$, $\\alpha_{\\mathrm{CO_2}} = 0.03$ (单位 $\\mathrm{mM/mmHg}$), $P_{\\mathrm{CO_2}} = 40$ (单位 $\\mathrm{mmHg}$), $\\mathrm{p}K_a = 6.1$ (无量纲)。\n- 案例 $1$ (理想情况)：细胞外 $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n- 案例 $2$ (酸性细胞外边界)：细胞外 $\\mathrm{pH}_{\\mathrm{out}} = 6.80$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n- 案例 $3$ (液泡型三磷酸腺苷酶被抑制)：细胞外 $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 0$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n- 案例 $4$ (碱性外部环境下碳酸氢根交换增强)：细胞外 $\\mathrm{pH}_{\\mathrm{out}} = 7.60$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 2\\times 10^{-5}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n\n要求的最终输出格式：\n- 你的程序必须生成单行输出，其中包含一个 Python 风格的列表字面量，内含四个测试用例的细胞内 $\\mathrm{pH}$ 值，按顺序排列，每个值都精确到四位小数（无量纲），例如，格式为 \"[7.2105,7.0031,7.1120,7.3562]\"。不应打印任何其他文本。\n\n注：\n- 所有计算中，浓度单位必须为 $\\mathrm{mM}$，$P_{\\mathrm{CO_2}}$ 单位为 $\\mathrm{mmHg}$，$\\mathrm{pH}$ 是无量纲的。\n- 除了所述原理外，不要使用任何生物学上的“捷径”。按照给定的形式实现质量作用和 Michaelis–Menten 动力学，并强制执行守恒定律和电中性。", "solution": "问题需进行验证。\n\n步骤 1：提取给定条件\n\n问题提供了以下数学模型和参数。除非另有说明，所有浓度单位均为 $\\mathrm{mM}$。\n\n**平衡与动力学定律：**\n1.  **碳酸氢盐系统：** $\\mathrm{pH}$ 与碳酸氢盐浓度 $[\\mathrm{HCO_3^-}]$ 之间的关系由 Henderson-Hasselbalch 方程给出：\n    $\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left(\\frac{[\\mathrm{HCO_3^-}]}{\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}}\\right)$。\n    这意味着 $[\\mathrm{HCO_3^-}] = \\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}} \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}$。\n2.  **质量作用交换：** 对于一个通用的 $1:1$ 交换体 $A_{\\mathrm{out}} + B_{\\mathrm{in}} \\rightleftharpoons A_{\\mathrm{in}} + B_{\\mathrm{out}}$，通量为 $J = g\\left([A]_{\\mathrm{out}}[B]_{\\mathrm{in}} - [A]_{\\mathrm{in}}[B]_{\\mathrm{out}}\\right)$。这适用于：\n    -   $\\mathrm{Na^+/H^+}$ 交换体 ($\\mathrm{NHE}$)：$A=\\mathrm{Na^+}$，$B=\\mathrm{H^+}$。\n    -   $\\mathrm{Cl^-/HCO_3^-}$ 交换体 ($\\mathrm{AE}$)：$A=\\mathrm{Cl^-}$，$B=\\mathrm{HCO_3^-}$。\n3.  **主动转运：** V 型 ATP 酶质子泵 ($\\mathrm{V}$) 的通量由 Michaelis-Menten 动力学给出：\n    $J_{\\mathrm{V}} = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}}{K + [\\mathrm{H^+}]_{\\mathrm{in}}}$。\n\n**守恒与平衡定律：**\n1.  **稳态质子平衡：** 细胞内质子浓度的净变化率为零。按照正通量增加细胞内质子浓度的约定：\n    $0 = J_{\\mathrm{met}} - J_{\\mathrm{NHE}} - J_{\\mathrm{V}} - J_{\\mathrm{AE}}$。\n    这里，$J_{\\mathrm{met}}$ 是恒定的代谢性酸产生速率。$J_{\\mathrm{NHE}}$ 是净 $\\mathrm{H^+}$ 输出通量。$J_{\\mathrm{V}}$ 是净 $\\mathrm{H^+}$ 输出通量。$J_{\\mathrm{AE}}$ 定义为净 $\\mathrm{HCO_3^-}$ 输入通量，这是一个质子等效输出通量。\n2.  **胞质电中性：** 电荷总和必须为零。在计算出稳态 $\\mathrm{pH}_{\\mathrm{in}}$ 后，由该平衡确定不可渗透阴离子浓度 $[\\mathrm{A^-}]_{\\mathrm{in}}$：\n    $[\\mathrm{Na^+}]_{\\mathrm{in}} + [\\mathrm{K^+}]_{\\mathrm{in}} + [\\mathrm{H^+}]_{\\mathrm{in}} = [\\mathrm{Cl^-}]_{\\mathrm{in}} + [\\mathrm{HCO_3^-}]_{\\mathrm{in}} + [\\mathrm{A^-}]_{\\mathrm{in}}$。\n\n**数值参数：**\n-   $\\mathrm{p}K_a = 6.1$\n-   $\\alpha_{\\mathrm{CO_2}} = 0.03 \\, \\mathrm{mM/mmHg}$\n-   $P_{\\mathrm{CO_2}} = 40 \\, \\mathrm{mmHg}$\n-   质子浓度转换：$[\\mathrm{H^+}]_{\\mathrm{mM}} = 10^{-\\mathrm{pH}} \\times 1000$。\n-   $\\mathrm{pH}_{\\mathrm{in}}$ 的搜索区间：$[5.5, 8.8]$。\n\n**测试套件数据：**\n-   **通用常量：** $[\\mathrm{Na^+}]_{\\mathrm{out}} = 140$, $[\\mathrm{Na^+}]_{\\mathrm{in}} = 12$, $[\\mathrm{Cl^-}]_{\\mathrm{out}} = 110$, $[\\mathrm{Cl^-}]_{\\mathrm{in}} = 15$, $[\\mathrm{K^+}]_{\\mathrm{in}} = 140$。\n-   **案例 1：** $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 5 \\times 10^{-6}$, $V_{\\max} = 1 \\times 10^{-4}$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n-   **案例 2：** $\\mathrm{pH}_{\\mathrm{out}} = 6.80$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 5 \\times 10^{-6}$, $V_{\\max} = 1 \\times 10^{-4}$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n-   **案例 3：** $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 5 \\times 10^{-6}$, $V_{\\max} = 0$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n-   **案例 4：** $\\mathrm{pH}_{\\mathrm{out}} = 7.60$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 2 \\times 10^{-5}$, $V_{\\max} = 1 \\times 10^{-4}$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n\n步骤 2：使用提取的给定条件进行验证\n\n根据验证标准对问题进行评估。\n-   **科学基础：** 该问题基于细胞生理学和生物物理学的基本原理。Henderson-Hasselbalch 关系式、质量作用动力学和 Michaelis–Menten 动力学都是标准模型。质量守恒（质子平衡）和电荷中性是基本定律。所提供的参数在公认的生理学范围内。该问题在科学上是合理的。\n-   **适定性：** 该问题可归结为求解一个关于未知细胞内 $\\mathrm{pH}$（即 $\\mathrm{pH}_{\\mathrm{in}}$）的非线性代数方程的根。核心任务是求解 $F(\\mathrm{pH}_{\\mathrm{in}}) = 0$。必须仔细分析此函数的结构。通量项被定义为质子等效输出通量。\n    -   $J_{\\mathrm{NHE}} = g_{\\mathrm{NHE}}\\left([\\mathrm{Na^+}]_{\\mathrm{out}}[\\mathrm{H^+}]_{\\mathrm{in}} - [\\mathrm{Na^+}]_{\\mathrm{in}}[\\mathrm{H^+}]_{\\mathrm{out}}\\right)$。这是 $\\mathrm{H^+}$ 运出细胞的通量。\n    -   $J_{\\mathrm{V}} = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}}{K + [\\mathrm{H^+}]_{\\mathrm{in}}}$。这是 $\\mathrm{H^+}$ 运出细胞的通量。\n    -   一个关键点是 $J_{\\mathrm{AE}}$ 的定义。问题陈述 $J_{\\mathrm{AE}}$ 是“由氯/碳酸氢根交换体质量作用项定义的碳酸氢根流入量”。通用的质量作用公式是针对反应 $\\mathrm{Cl^-_{out}} + \\mathrm{HCO_3^-_{in}} \\rightleftharpoons \\mathrm{Cl^-_{in}} + \\mathrm{HCO_3^-_{out}}$ 的，这对应于碳酸氢根的*流出*。为了表示流入，必须将各项反转。因此，$J_{\\mathrm{AE}} = g_{AE}\\left([\\mathrm{Cl^-}]_{\\mathrm{in}}[\\mathrm{HCO_3^-}]_{\\mathrm{out}} - [\\mathrm{Cl^-}]_{\\mathrm{out}}[\\mathrm{HCO_3^-}]_{\\mathrm{in}}\\right)$。每摩尔 $\\mathrm{HCO_3^-}$ 流入消耗一摩尔 $\\mathrm{H^+}$，因此这是一个质子等效输出通量。\n    -   通过这种对 $J_{\\mathrm{AE}}$ 的正确表述，所有三个转运蛋白通量 $J_{\\mathrm{NHE}}$、$J_{\\mathrm{V}}$ 和 $J_{\\mathrm{AE}}$ 都是 $\\mathrm{pH}_{\\mathrm{in}}$ 的单调递减函数。因此，总质子输出通量 $J_{ext} = J_{\\mathrm{NHE}} + J_{\\mathrm{V}} + J_{\\mathrm{AE}}$ 也是 $\\mathrm{pH}_{\\mathrm{in}}$ 的严格单调递减函数。\n    -   稳态方程为 $J_{ext}(\\mathrm{pH}_{\\mathrm{in}}) = J_{\\mathrm{met}}$。我们正在寻找单调递减函数 $J_{ext}$ 与常数 $J_{\\mathrm{met}}$ 的交点。这保证了最多只有一个解。因此，用于求根的函数 $F(\\mathrm{pH}_{\\mathrm{in}}) = J_{\\mathrm{met}} - J_{ext}(\\mathrm{pH}_{\\mathrm{in}})$ 是单调递增的。这确保了如果在指定区间内存在根，该根是唯一的，并且标准的区间求根算法是稳健的。该问题是适定的。\n-   **客观性：** 该问题以精确、定量和客观的数学术语陈述。没有主观因素。\n\n该问题没有表现出任何其他缺陷，如不完整、矛盾或不切实际。在找到 $\\mathrm{pH}_{\\mathrm{in}}$ *之后* 根据电中性计算 $[\\mathrm{A^-}]_{\\mathrm{in}}$ 的规范是一个有效的建模简化，它将电荷平衡与质子平衡解耦，使问题易于处理。\n\n步骤 3：结论与行动\n\n问题是**有效的**。将提供解决方案。\n\n**解题推导**\n问题的核心是求解非线性方程 $F(\\mathrm{pH}_{\\mathrm{in}}) = 0$ 以得到 $\\mathrm{pH}_{\\mathrm{in}}$，其中：\n$$F(\\mathrm{pH}_{\\mathrm{in}}) = J_{\\mathrm{met}} - J_{\\mathrm{NHE}}(\\mathrm{pH}_{\\mathrm{in}}) - J_{\\mathrm{V}}(\\mathrm{pH}_{\\mathrm{in}}) - J_{\\mathrm{AE}}(\\mathrm{pH}_{\\mathrm{in}})$$\n设 $x = \\mathrm{pH}_{\\mathrm{in}}$。方程的各组成部分被定义为 $x$ 的函数。\n\n首先，我们确定依赖于 $x$ 的浓度：\n-   细胞内质子浓度： $[\\mathrm{H^+}]_{\\mathrm{in}}(x) = 1000 \\cdot 10^{-x}$\n-   细胞内碳酸氢盐浓度： $[\\mathrm{HCO_3^-}]_{\\mathrm{in}}(x) = (\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}) \\cdot 10^{x - \\mathrm{p}K_a}$\n\n我们还需要细胞外浓度，对于给定的测试用例，这些浓度是恒定的，由 $\\mathrm{pH}_{\\mathrm{out}}$ 推导得出：\n-   细胞外质子浓度： $[\\mathrm{H^+}]_{\\mathrm{out}} = 1000 \\cdot 10^{-\\mathrm{pH}_{\\mathrm{out}}}$\n-   细胞外碳酸氢盐浓度： $[\\mathrm{HCO_3^-}]_{\\mathrm{out}} = (\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}) \\cdot 10^{\\mathrm{pH}_{\\mathrm{out}} - \\mathrm{p}K_a}$\n\n接下来，我们将三个转运蛋白通量定义为 $x$ 的函数：\n1.  **NHE 通量：**\n    $$J_{\\mathrm{NHE}}(x) = g_{\\mathrm{NHE}} \\left( [\\mathrm{Na^+}]_{\\mathrm{out}}[\\mathrm{H^+}]_{\\mathrm{in}}(x) - [\\mathrm{Na^+}]_{\\mathrm{in}}[\\mathrm{H^+}]_{\\mathrm{out}} \\right)$$\n2.  **V-ATP 酶通量：**\n    $$J_{\\mathrm{V}}(x) = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}(x)}{K + [\\mathrm{H^+}]_{\\mathrm{in}}(x)}$$\n3.  **AE 通量（碳酸氢根流入）：**\n    $$J_{\\mathrm{AE}}(x) = g_{\\mathrm{AE}} \\left( [\\mathrm{Cl^-}]_{\\mathrm{in}}[\\mathrm{HCO_3^-}]_{\\mathrm{out}} - [\\mathrm{Cl^-}]_{\\mathrm{out}}[\\mathrm{HCO_3^-}]_{\\mathrm{in}}(x) \\right)$$\n\n对于每个测试用例，将参数 ($g_{\\mathrm{NHE}}$、$g_{\\mathrm{AE}}$、$V_{\\max}$、$K$、$J_{\\mathrm{met}}$、$\\mathrm{pH}_{\\mathrm{out}}$ 等) 代入这些表达式中。然后我们得到一个完整的函数 $F(x)$，可以进行数值求解。我们将在指定区间 $x \\in [5.5, 8.8]$ 内采用稳健的区间求根方法，例如 Brent-Dekker 方法。\n\n找到根 $\\mathrm{pH}_{\\mathrm{in}}$ 后，我们必须计算不可渗透阴离子 $[\\mathrm{A^-}]_{\\mathrm{in}}$ 的浓度，以确认电荷平衡。这是一个后处理步骤，不要求在最终输出中体现。使用求解出的 $\\mathrm{pH}_{\\mathrm{in}}$，我们计算最终的 $[\\mathrm{H^+}]_{\\mathrm{in}}$ 和 $[\\mathrm{HCO_3^-}]_{\\mathrm{in}}$：\n$$[\\mathrm{A^-}]_{\\mathrm{in}} = [\\mathrm{Na^+}]_{\\mathrm{in}} + [\\mathrm{K^+}]_{\\mathrm{in}} + [\\mathrm{H^+}]_{\\mathrm{in}} - \\left( [\\mathrm{Cl^-}]_{\\mathrm{in}} + [\\mathrm{HCO_3^-}]_{\\mathrm{in}} \\right)$$\n此过程将对四个测试用例中的每一个实施。最终程序将系统地应用这些计算，并按要求格式化所得的 $\\mathrm{pH}_{\\mathrm{in}}$ 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the steady-state intracellular pH for a cell model with three\n    primary ion transporters, solving a nonlinear equation for proton balance.\n    \"\"\"\n\n    # Common parameters for all test cases as specified in the problem.\n    # All concentrations are in mM.\n    common_params = {\n        'na_out': 140.0,\n        'na_in': 12.0,\n        'cl_out': 110.0,\n        'cl_in': 15.0,\n        'k_in': 140.0,\n        'alpha_co2': 0.03,  # mM/mmHg\n        'p_co2': 40.0,      # mmHg\n        'pka': 6.1,\n    }\n\n    # Test cases with their specific parameters.\n    test_cases = [\n        # Case 1: Happy path\n        {'ph_out': 7.40, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 2: Acidic extracellular boundary\n        {'ph_out': 6.80, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 3: V-ATPase inhibited\n        {'ph_out': 7.40, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 0.0, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 4: Enhanced bicarbonate exchange with alkaline outside\n        {'ph_out': 7.60, 'g_nhe': 5e-3, 'g_ae': 2e-5, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n    ]\n\n    results = []\n    \n    # pH range for root finding\n    ph_search_bracket = [5.5, 8.8]\n\n    for case_params in test_cases:\n        params = {**common_params, **case_params}\n\n        # Pre-calculate constants that depend on extracellular pH\n        h_out = 1000.0 * (10**(-params['ph_out']))\n        co2_product = params['alpha_co2'] * params['p_co2']\n        bicarb_out = co2_product * (10**(params['ph_out'] - params['pka']))\n\n        def balance_function(ph_in):\n            \"\"\"\n            This function represents the steady-state proton balance equation F(pH_in) = 0.\n            We solve for the root of this function.\n            F(pH_in) = J_met - J_NHE - J_V - J_AE = 0\n            \"\"\"\n            # Calculate intracellular concentrations based on ph_in\n            h_in = 1000.0 * (10**(-ph_in))\n            bicarb_in = co2_product * (10**(ph_in - params['pka']))\n\n            # Calculate flux for Na+/H+ exchanger (J_NHE)\n            j_nhe = params['g_nhe'] * (params['na_out'] * h_in - params['na_in'] * h_out)\n\n            # Calculate flux for V-ATPase proton pump (J_V)\n            j_v = params['v_max'] * h_in / (params['k_pump'] + h_in)\n\n            # Calculate flux for Cl-/HCO3- exchanger (J_AE), defined as bicarbonate influx\n            j_ae = params['g_ae'] * (params['cl_in'] * bicarb_out - params['cl_out'] * bicarb_in)\n            \n            return params['j_met'] - j_nhe - j_v - j_ae\n\n        # Solve for ph_in using a robust bracketed root-finder.\n        # The balance_function is monotonic, so brentq is highly reliable.\n        sol = root_scalar(balance_function, bracket=ph_search_bracket, method='brentq')\n        ph_in_steady_state = sol.root\n        results.append(ph_in_steady_state)\n\n        # Internal validation: Compute the required fixed anion concentration [A-]_in\n        # to ensure charge balance, as per the problem description. This is not for output.\n        h_in_final = 1000.0 * (10**(-ph_in_steady_state))\n        bicarb_in_final = co2_product * (10**(ph_in_steady_state - params['pka']))\n        a_in_final = (params['na_in'] + params['k_in'] + h_in_final) - \\\n                     (params['cl_in'] + bicarb_in_final)\n        # For a physically valid model, a_in_final should be positive.\n\n    # Format the output as a single line string according to the specification.\n    output_str = \"[\" + \",\".join(f\"{res:.4f}\" for res in results) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2772402"}]}