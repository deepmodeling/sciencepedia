{"hands_on_practices": [{"introduction": "代谢工程的核心是精确调控生化反应网络，而这一切始于对单个酶行为的深刻理解。本练习将带您回到酶动力学的第一性原理，推导经典的米氏方程[@problem_id:2762814]。通过这个实践，您不仅能巩固对酶促反应速率如何受底物浓度影响的认识，还能掌握将理论模型应用于预测和设定目标代谢流速的关键技能。", "problem": "在一个微生物底盘中，一个合成途径中的单个异源步骤被设计为通量控制步骤。该步骤遵循经典的单底物酶机制 $E + S \\rightleftharpoons ES \\rightarrow E + P$，其中 $E$ 是游离酶，$S$ 是底物，$ES$ 是酶-底物复合物，$P$ 是产物。假设反应器充分混合，产物抑制可忽略不计，温度和pH恒定，并且底物相对于总酶浓度过量，因此准稳态近似 (QSSA) 成立。总酶浓度是守恒的，系统在初始速率范围内运行，在此时间尺度内底物消耗可以忽略不计。在这些条件下，经生物质干重归一化的体积通量 $v$（单位为 $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$，其中克干重 (gDW) 表示细胞干重克数）可以用总酶浓度、微观速率常数和以 $\\mathrm{mM}$ 为单位的底物浓度 $[S]$ 来表示。\n\n从质量作用动力学和总酶守恒出发，推导适用于该机制的单底物QSSA速率定律，然后使用经典动力学参数 $V_{\\max}$ 和 $K_{m}$，确定达到目标稳态通量 $v = 80\\,\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$ 所需的底物浓度 $[S]$（单位为 $\\mathrm{mM}$）。该酶的特征参数为 $V_{\\max} = 100\\,\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$ 和 $K_{m} = 0.2\\,\\mathrm{mM}$。以 $\\mathrm{mM}$ 为单位表示您最终的 $[S]$ 结果，并四舍五入到三位有效数字。", "solution": "所述问题是酶动力学中的一个标准练习，科学上合理、提法明确且完整。所有提供的数据都一致且物理上可行。因此，我们开始解题。\n\n目标有两方面：首先，在准稳态近似（QSSA）下推导单底物酶反应的速率定律；其次，计算达到指定通量 $v$ 所需的底物浓度 $[S]$。\n\n首先，我们进行推导。反应机理如下：\n$$\nE + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\xrightarrow{k_{cat}} E + P\n$$\n其中，$k_1$ 是形成酶-底物复合物 $ES$ 的速率常数，$k_{-1}$ 是其分解回游离酶 $E$ 和底物 $S$ 的速率常数，$k_{cat}$ 是形成产物 $P$ 和再生游离酶 $E$ 的催化速率常数。\n\n根据质量作用动力学，产物的生成速率，即反应通量 $v$，与酶-底物复合物的浓度 $[ES]$ 成正比：\n$$\nv = \\frac{d[P]}{dt} = k_{cat}[ES]\n$$\n中间复合物 $[ES]$ 浓度的变化率由下式给出：\n$$\n\\frac{d[ES]}{dt} = (\\text{rate of formation of ES}) - (\\text{rate of consumption of ES})\n$$\n$$\n\\frac{d[ES]}{dt} = k_{1}[E][S] - (k_{-1}[ES] + k_{cat}[ES]) = k_{1}[E][S] - (k_{-1} + k_{cat})[ES]\n$$\n问题指明使用QSSA，该近似假设中间复合物 $[ES]$ 的浓度在短暂的初始瞬态后保持近似恒定，即 $\\frac{d[ES]}{dt} \\approx 0$。应用此近似可得：\n$$\nk_{1}[E][S] - (k_{-1} + k_{cat})[ES] = 0\n$$\n$$\nk_{1}[E][S] = (k_{-1} + k_{cat})[ES]\n$$\n总酶浓度 $[E]_T$ 是守恒的。它是游离酶浓度 $[E]$ 和酶-底物复合物浓度 $[ES]$ 的总和：\n$$\n[E]_T = [E] + [ES]\n$$\n根据这个守恒定律，我们将游离酶浓度表示为 $[E] = [E]_T - [ES]$。将此表达式代入QSSA方程可得：\n$$\nk_{1}([E]_T - [ES])[S] = (k_{-1} + k_{cat})[ES]\n$$\n我们现在求解 $[ES]$：\n$$\nk_{1}[E]_T[S] - k_{1}[ES][S] = (k_{-1} + k_{cat})[ES]\n$$\n$$\nk_{1}[E]_T[S] = (k_{-1} + k_{cat})[ES] + k_{1}[ES][S]\n$$\n$$\nk_{1}[E]_T[S] = [ES](k_{-1} + k_{cat} + k_{1}[S])\n$$\n$$\n[ES] = \\frac{k_{1}[E]_T[S]}{k_{-1} + k_{cat} + k_{1}[S]}\n$$\n为了得到速率定律的经典形式，我们将分子和分母同除以 $k_{1}$：\n$$\n[ES] = \\frac{[E]_T[S]}{\\frac{k_{-1} + k_{cat}}{k_{1}} + [S]}\n$$\n我们将米氏常数 $K_{m}$ 定义为速率常数的集合 $K_{m} = \\frac{k_{-1} + k_{cat}}{k_{1}}$。代入此定义，我们得到：\n$$\n[ES] = \\frac{[E]_T[S]}{K_{m} + [S]}\n$$\n现在，将这个关于 $[ES]$ 的表达式代回通量 $v$ 的速率方程：\n$$\nv = k_{cat}[ES] = k_{cat}\\frac{[E]_T[S]}{K_{m} + [S]} = \\frac{k_{cat}[E]_T[S]}{K_{m} + [S]}\n$$\n最大通量 $V_{\\max}$ 在酶被底物完全饱和时达到，这意味着 $[ES] \\approx [E]_T$。在这种情况下，$v = V_{\\max} = k_{cat}[E]_T$。通过将 $V_{\\max}$ 代入速率方程，我们得到米氏-门顿方程的最终形式，这就是所要求的QSSA速率定律：\n$$\nv = \\frac{V_{\\max}[S]}{K_{m} + [S]}\n$$\n推导到此完成。\n\n接下来，我们使用这个方程来确定达到目标通量所需的底物浓度 $[S]$。给定的参数是：\n目标通量，$v = 80\\,\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$\n最大通量，$V_{\\max} = 100\\,\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$\n米氏常数，$K_{m} = 0.2\\,\\mathrm{mM}$\n\n我们将这些值代入米氏-门顿方程：\n$$\n80 = \\frac{100 \\cdot [S]}{0.2 + [S]}\n$$\n我们继续求解这个关于 $[S]$ 的代数方程。单位是一致的，可以在计算过程中省略。\n$$\n80(0.2 + [S]) = 100[S]\n$$\n$$\n16 + 80[S] = 100[S]\n$$\n$$\n16 = 100[S] - 80[S]\n$$\n$$\n16 = 20[S]\n$$\n$$\n[S] = \\frac{16}{20} = \\frac{4}{5} = 0.8\n$$\n计算得到的底物浓度为 $[S] = 0.8\\,\\mathrm{mM}$。问题要求结果四舍五入到三位有效数字。因此，该值为 $0.800$。", "answer": "$$\\boxed{0.800}$$", "id": "2762814"}, {"introduction": "当单个反应汇集成复杂的代谢网络时，我们需要一种系统性的方法来分析其整体行为。流平衡分析（FBA）正是一种强大的、基于化学计量约束的建模框架，它使我们能够在缺乏完整动力学参数的情况下预测细胞的代谢能力[@problem_id:2762811]。本练习将通过一个简洁的线性途径模型，引导您从头构建并求解一个FBA问题，从而掌握其核心思想：如何利用质量平衡和优化原理来确定网络中的最佳通量分布。", "problem": "考虑一个稳态代谢网络，其化学计量矩阵为 $S \\in \\mathbb{R}^{2 \\times 3}$，表示为\n$$\nS=\\begin{bmatrix}\n1  -1  0 \\\\\n0  1  -1\n\\end{bmatrix},\n$$\n以及一个满足稳态质量平衡 $S\\mathbf{v}=\\mathbf{0}$ 的通量向量 $\\mathbf{v}\\in\\mathbb{R}^{3}$。在流通量平衡分析 (FBA; Flux Balance Analysis) 中，研究者在稳态和边界约束下，寻求最大化一个线性细胞目标 $z=\\mathbf{c}^{\\top}\\mathbf{v}$。设目标系数向量为\n$$\n\\mathbf{c}=\\begin{bmatrix}0 \\\\ 0 \\\\ 1\\end{bmatrix},\n$$\n并施加非负下界和无有限上界，\n$$\n\\mathbf{l}=\\mathbf{0},\\quad \\mathbf{u}=\\boldsymbol{\\infty},\n$$\n因此可行集由以下条件定义\n$$\nS\\mathbf{v}=\\mathbf{0},\\quad \\mathbf{v}\\ge \\mathbf{0}.\n$$\n从稳态质量平衡和线性规划可行性的定义出发，不使用任何预先推导的捷径，并从第一性原理进行推理。\n\n任务：\n- 判断 FBA 问题 $\\max_{\\mathbf{v}}\\{\\mathbf{c}^{\\top}\\mathbf{v}\\mid S\\mathbf{v}=\\mathbf{0},\\ \\mathbf{v}\\ge \\mathbf{0}\\}$ 是否有界。使用 $S$ 的线性代数性质和可行集的几何性质来证明你的结论。\n- 如果问题是无界的，确定可行锥中使目标函数增加的最优极射线，然后施加归一化条件 $v_{1}=1$（一个用于报告最优射线唯一代表的缩放条件）。在此归一化条件下，计算相应的通量向量 $\\mathbf{v}$。\n\n将你的最终答案表示为一个使用 $\\mathrm{pmatrix}$ 的单行矩阵，不带单位。无需四舍五入。", "solution": "所述问题是流通量平衡分析 (FBA) 背景下的一个线性规划问题。在进行求解之前，需要对问题陈述进行验证。\n\n已知条件如下：\n- 一个化学计量矩阵 $S \\in \\mathbb{R}^{2 \\times 3}$，由 $S=\\begin{bmatrix} 1  -1  0 \\\\ 0  1  -1 \\end{bmatrix}$ 给出。\n- 一个通量向量 $\\mathbf{v} \\in \\mathbb{R}^{3}$。\n- 稳态质量平衡条件 $S\\mathbf{v}=\\mathbf{0}$。\n- 一个待最大化的目标函数 $z=\\mathbf{c}^{\\top}\\mathbf{v}$。\n- 目标系数向量 $\\mathbf{c}=\\begin{bmatrix}0 \\\\ 0 \\\\ 1\\end{bmatrix}$。\n- 由 $\\mathbf{v} \\ge \\mathbf{0}$ 定义的通量边界，这意味着下界 $\\mathbf{l}=\\mathbf{0}$ 且无有限上界 $\\mathbf{u}=\\boldsymbol{\\infty}$。\n- FBA 问题被表述为 $\\max_{\\mathbf{v}}\\{\\mathbf{c}^{\\top}\\mathbf{v}\\mid S\\mathbf{v}=\\mathbf{0},\\ \\mathbf{v}\\ge \\mathbf{0}\\}$。\n- 如果问题是无界的，则应用归一化条件：$v_{1}=1$。\n\n该问题具有科学依据、是良定的且客观的。它代表了 FBA（代谢工程中的一个核心方法）的一个标准、基本的应用。所有组成部分都有明确的数学定义，且约束条件是一致的。没有违反科学原理之处，没有歧义，也没有缺失信息。因此，该问题被认为是有效的，可以构建解答。\n\n任务是判断目标函数在可行集上是否有界，如果无界，则找到沿最优射线的代表性通量向量。可行集是由约束条件 $S\\mathbf{v}=\\mathbf{0}$ 和 $\\mathbf{v} \\ge \\mathbf{0}$ 定义的 $\\mathbb{R}^{3}$ 中的区域。这个集合是一个多面锥，因为其约束由齐次线性等式和非负边界组成。\n\n首先，我们必须刻画矩阵 $S$ 的零空间，即满足 $S\\mathbf{v}=\\mathbf{0}$ 的所有向量 $\\mathbf{v}$ 的集合。矩阵方程为：\n$$\n\\begin{bmatrix}\n1  -1  0 \\\\\n0  1  -1\n\\end{bmatrix}\n\\begin{pmatrix}\nv_{1} \\\\\nv_{2} \\\\\nv_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n这展开为一个包含两个线性方程的方程组：\n$$(1) \\quad 1 \\cdot v_{1} - 1 \\cdot v_{2} + 0 \\cdot v_{3} = 0$$\n$$(2) \\quad 0 \\cdot v_{1} + 1 \\cdot v_{2} - 1 \\cdot v_{3} = 0$$\n从方程 (1)，我们得到 $v_{1} = v_{2}$。从方程 (2)，我们得到 $v_{2} = v_{3}$。因此，零空间中的任何向量都必须满足 $v_{1} = v_{2} = v_{3}$。我们可以将任何此类向量表示为一个基向量的标量倍。设 $v_{3} = k$，其中 $k \\in \\mathbb{R}$ 是某个标量。则 $v_{1} = v_{2} = v_{3} = k$。$S$ 的零空间，记为 $\\text{ker}(S)$，是由向量 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 张成的一维子空间。$\\text{ker}(S)$ 中的任何向量 $\\mathbf{v}$ 都可以写为：\n$$\n\\mathbf{v} = k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n\n接下来，我们应用非负约束 $\\mathbf{v} \\ge \\mathbf{0}$。这要求 $\\mathbf{v}$ 的每个分量都为非负：\n$$\nv_{1} = k \\ge 0\n$$\n$$\nv_{2} = k \\ge 0\n$$\n$$\nv_{3} = k \\ge 0\n$$\n所有三个条件都满足当且仅当 $k \\ge 0$。因此，可行集是从原点出发，沿向量 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 方向的射线。任何可行通量向量 $\\mathbf{v}$ 的形式为 $\\mathbf{v} = k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$，其中 $k \\ge 0$。\n\n现在，我们对可行集中的任何向量计算目标函数 $z = \\mathbf{c}^{\\top}\\mathbf{v}$：\n$$\nz = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\left( k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = k \\left( \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = k(0 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 1) = k\n$$\n目标函数的值为 $z=k$。由于 $k$ 可以是任意非负实数 ($k \\ge 0$)，通过增加 $k$， $z$ 的值可以变得任意大。因此，该最大化问题没有有限的最大值，FBA 问题是无界的。\n\n问题是无界的，因为可行锥拥有一条方向向量为 $\\mathbf{d} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 的极射线，目标函数沿该射线增加。这可以通过检验 $\\mathbf{c}^{\\top}\\mathbf{d} = 1 > 0$ 来证实。由于这是可行锥中（除原点外）唯一的射线，因此它是最优极射线。\n\n最后的任务是找到位于这条最优射线上并满足归一化条件 $v_{1}=1$ 的特定通量向量 $\\mathbf{v}$。射线上的一个通用点由 $\\mathbf{v} = \\begin{pmatrix} k \\\\ k \\\\ k \\end{pmatrix}$ 给出。应用条件 $v_{1}=1$ 得到 $k=1$。将这个 $k$ 值代回 $\\mathbf{v}$ 的一般形式，我们得到归一化后的通量向量：\n$$\n\\mathbf{v} = 1 \\cdot \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n该向量代表了最优射线上满足指定缩放条件的唯一点。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1   1   1\n\\end{pmatrix}\n}\n$$", "id": "2762811"}, {"introduction": "实际的生物制造过程本质上是动态的，细胞与环境的相互作用随时间不断演变。动态流平衡分析（dFBA）是将稳态的细胞代谢模型与动态的生物反应器环境相结合的关键技术，能够模拟整个发酵过程[@problem_id:2762813]。在这个综合性实践中，您将有机会亲手构建一个dFBA模拟器，它融合了流平衡分析、动力学约束和常微分方程，让您体验如何预测细胞生长、底物消耗和产物生成的完整时程曲线。", "problem": "实现一个动态通量平衡分析 (FBA) 模拟器，该模拟器将胞外质量平衡与胞内准稳态 FBA 和一个简单的调控规则在离散时间步上耦合起来。模拟必须基于以下基本依据：质量守恒、胞内准稳态通量平衡以及底物摄取的饱和转运（摄取）动力学。\n\n您需要模拟一个分批培养过程，其中包含一种限制性胞外底物和一种分泌副产物。胞内网络由一个最小集总化学计量模型表示，该模型含有一种用于平衡碳当量的单一前体代谢物。假设在每个时间步，胞内代谢都处于准稳态。\n\n定义和假设：\n- 令 $S(t)$ 为胞外底物浓度（单位 $\\mathrm{mmol}/\\mathrm{L}$），$X(t)$ 为生物量浓度（单位 $\\mathrm{gDW}/\\mathrm{L}$），$P(t)$ 为胞外产物浓度（单位 $\\mathrm{mmol}/\\mathrm{L}$）。时间 $t$ 的单位为 $\\mathrm{h}$。\n- 胞内通量向量为 $v = [v_1, v_2, v_3, v_4]^\\top$，$v_1$、$v_3$、$v_4$ 的单位为 $\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$，$v_2$ 的单位为 $\\mathrm{h}^{-1}$。反应：\n  - $v_1$：底物摄取，生成一个集总的胞内前体碳池。\n  - $v_2$：生物量合成（生长速率）。\n  - $v_3$：对前体池的非生长相关维持消耗。\n  - $v_4$：消耗前体池的副产物分泌。\n- 胞内准稳态（前体碳池的质量平衡）施加了线性约束\n  $$\n  v_1 - a\\,v_2 - b\\,v_4 - v_3 = 0,\n  $$\n  其中 $a$ 和 $b$ 是正的无量纲化学计量系数，分别指定了生物量和产物形成所需的前体碳。\n- 底物摄取对胞外底物浓度是饱和的，使用 Michaelis–Menten 型上限：\n  $$\n  0 \\le v_1 \\le V_{\\max,\\mathrm{g}} \\,\\frac{S}{K_{\\mathrm{g}} + S}.\n  $$\n- 维持消耗有一个下限，该下限受到调控，以避免在严重饥饿条件下出现不可行解：\n  $$\n  v_3 \\ge m_{\\mathrm{eff}}(S) \\equiv \\min\\!\\left(m,\\,V_{\\max,\\mathrm{g}} \\,\\frac{S}{K_{\\mathrm{g}} + S}\\right).\n  $$\n- 副产物分泌既受与摄取的最小溢流耦合调控，也受依赖于胞外产物的转录抑制规则调控：\n  $$\n  v_4 - r_{\\mathrm{of}}\\,v_1 \\ge 0,\\quad 0 \\le v_4 \\le V_{\\max,\\mathrm{p}}\\,R(P),\n  $$\n  其中 $r_{\\mathrm{of}}$ 是必需的溢流分数，$R(P)$ 是一个调控因子，定义为\n  $$\n  R(P) = \\begin{cases}\n  1  \\text{当 } P \\le P_{\\mathrm{thr}},\\\\\n  \\alpha  \\text{当 } P  P_{\\mathrm{thr}},\n  \\end{cases}\n  $$\n  且 $0  \\alpha \\le 1$。\n- 在每个时间点 $t$，胞内通量 $v$ 通过求解一个线性规划问题来计算，该问题在上述约束条件下最大化生长速率：\n  $$\n  \\max_{v} \\; v_2 \\quad \\text{约束条件为上述定义的线型等式和不等式。}\n  $$\n- 胞外质量平衡（分批，恒定体积）由以下公式给出\n  $$\n  \\frac{dS}{dt} = -\\,v_1\\,X,\\qquad \\frac{dX}{dt} = v_2\\,X,\\qquad \\frac{dP}{dt} = v_4\\,X.\n  $$\n- 使用前向欧拉法在大小为 $\\Delta t$ 的均匀时间步上将系统离散化：\n  $$\n  S_{k+1} = \\max\\!\\left(0,\\,S_k - \\Delta t\\,v_{1,k}\\,X_k\\right),\\quad\n  X_{k+1} = \\max\\!\\left(0,\\,X_k + \\Delta t\\,v_{2,k}\\,X_k\\right),\\quad\n  P_{k+1} = \\max\\!\\left(0,\\,P_k + \\Delta t\\,v_{4,k}\\,X_k\\right).\n  $$\n  因子 $\\max(0,\\cdot)$ 强制非负性。\n\n适用于所有测试用例的全局参数：\n- 生物量前体系数 $a = 20$。\n- 产物前体系数 $b = 1$。\n- 底物摄取饱和度：$V_{\\max,\\mathrm{g}} = 10\\,\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$，$K_{\\mathrm{g}} = 0.5\\,\\mathrm{mmol}/\\mathrm{L}$。\n- 维持下限 $m = 1\\,\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$。\n- 溢流分数 $r_{\\mathrm{of}} = 0.1$。\n- 产物分泌上限参数：$V_{\\max,\\mathrm{p}} = 5\\,\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$，抑制因子 $\\alpha = 0.5$，抑制阈值 $P_{\\mathrm{thr}} = 50\\,\\mathrm{mmol}/\\mathrm{L}$。\n\n每个时间步 $k \\mapsto k+1$ 需要实现的算法：\n- 计算 $v_{1,\\max} = V_{\\max,\\mathrm{g}}\\,S_k/(K_{\\mathrm{g}} + S_k)$ 和 $m_{\\mathrm{eff}} = \\min(m, v_{1,\\max})$。\n- 如果 $P_k \\le P_{\\mathrm{thr}}$，计算 $R_k = 1$，否则 $R_k = \\alpha$；设置 $v_{4,\\max} = V_{\\max,\\mathrm{p}}\\,R_k$。\n- 求解线性规划\n  $$\n  \\max v_2 \\;\\;\\text{s.t.}\\;\\;\n  v_1 - a v_2 - b v_4 - v_3 = 0,\\;\n  0 \\le v_1 \\le v_{1,\\max},\\;\n  v_3 \\ge m_{\\mathrm{eff}},\\;\n  v_4 - r_{\\mathrm{of}} v_1 \\ge 0,\\;\n  0 \\le v_4 \\le v_{4,\\max},\\;\n  v_2 \\ge 0.\n  $$\n  如果某一步的线性规划不可行，则该步的 $v_1 = 0$, $v_2 = 0$, $v_3 = 0$, $v_4 = 0$。\n- 使用上述前向欧拉法更新 $(S,X,P)$ 并强制非负性。\n\n测试套件：\n提供三次独立的模拟（每次都从 $t=0$ 开始），使用以下初始条件和数值设置。所有浓度单位：$S$ 和 $P$ 为 $\\mathrm{mmol}/\\mathrm{L}$，$X$ 为 $\\mathrm{gDW}/\\mathrm{L}$。时间单位为 $\\mathrm{h}$。\n- 案例 1（中等接种量的一般生长）：$S(0) = 100$，$X(0) = 0.05$，$P(0) = 0$，最终时间 $T = 10$，步长 $\\Delta t = 0.01$。\n- 案例 2（底物限制边界）：$S(0) = 2$，$X(0) = 0.1$，$P(0) = 0$，最终时间 $T = 5$，步长 $\\Delta t = 0.01$。\n- 案例 3（初始产物高于抑制阈值）：$S(0) = 50$，$X(0) = 0.01$，$P(0) = 60$，最终时间 $T = 10$，步长 $\\Delta t = 0.01$。\n\n要求的输出：\n- 对于每个案例，返回保留 $6$ 位小数的三元组 $\\big[S(T), X(T), P(T)\\big]$，$S(T)$ 和 $P(T)$ 的单位为 $\\mathrm{mmol}/\\mathrm{L}$，$X(T)$ 的单位为 $\\mathrm{gDW}/\\mathrm{L}$。\n- 你的程序应生成单行输出，其中包含一个以逗号分隔的列表，该列表被方括号括起，每个案例的结果作为子列表按上述顺序排列。例如：$\\big[\\,[s_1,x_1,p_1],[s_2,x_2,p_2],[s_3,x_3,p_3]\\,\\big]$。", "solution": "该问题被判定为有效。它提出了一个关于动态通量平衡分析（dFBA）的适定且有科学依据的练习，dFBA 是代谢工程和计算系统生物学中的一种标准方法。所提供的模型是自洽的，所有参数、初始条件、控制方程和数值程序都得到了明确且一致的定义。该模型将准稳态的胞内代谢与动态的胞外质量平衡相结合，这是一种正确且被广泛使用的表述方式。包括 Michaelis-Menten 摄取动力学、维持能量和简单基因调控在内的约束条件，都是该领域的标准表示方法。该问题要求实现一个数值模拟，这是一项不简单的任务，能够正确地测试优化和微分方程求解的集成能力。\n\n动态模拟的核心是在每个离散时间步重复求解一个优化问题，以找到最大化生物学目标（此处假设为生物量生长速率）的胞内通量分布。然后，根据计算出的通量对胞外状态变量进行积分。\n\n完整的系统由以下几个部分描述：\n\n1.  **状态变量**：分批培养在任何时间 $t$ 的状态由向量 $[S(t), X(t), P(t)]^\\top$ 定义，分别代表底物浓度、生物量浓度和产物浓度。\n\n2.  **胞内通量**：胞内代谢状态由通量向量 $v = [v_1, v_2, v_3, v_4]^\\top$ 描述。相对于胞外环境的变化，这些通量被假定为瞬时达到准稳态。\n\n3.  **优化问题**：在每个时间步 $k$，对于状态 $(S_k, X_k, P_k)$，我们必须求解一个线性规划（LP）问题，以找到最优通量分布 $v_k = [v_{1,k}, v_{2,k}, v_{3,k}, v_{4,k}]^\\top$。目标是最大化比生长速率 $v_2$。\n    $$\n    \\max_{v} v_2\n    $$\n    此最大化受制于几个基于化学计量、热力学和动力学的约束：\n    - **化学计量平衡**：集总的胞内前体池处于稳态。\n      $$v_1 - a v_2 - b v_4 - v_3 = 0$$\n    - **物理和动力学边界**：\n      \\begin{align*}\n       0 \\le v_1 \\le v_{1,\\max,k} \\quad \\text{其中} \\quad v_{1,\\max,k} = V_{\\max,\\mathrm{g}} \\frac{S_k}{K_{\\mathrm{g}} + S_k} \\\\\n       v_2 \\ge 0 \\\\\n       v_3 \\ge m_{\\mathrm{eff},k} \\quad \\text{其中} \\quad m_{\\mathrm{eff},k} = \\min(m, v_{1,\\max,k}) \\\\\n       r_{\\mathrm{of}} v_1 \\le v_4 \\le v_{4,\\max,k} \\quad \\text{其中} \\quad v_{4,\\max,k} = V_{\\max,\\mathrm{p}} R(P_k) \\\\\n       0 \\le v_4\n      \\end{align*}\n    调控函数 $R(P_k)$ 是一个阶跃函数：如果 $P_k \\le P_{\\mathrm{thr}}$ 则为 $1$，如果 $P_k > P_{\\mathrm{thr}}$ 则为 $\\alpha$。\n\n4.  **线性规划的解析解**：\n    虽然该问题可以在每一步使用通用的 LP 求解器来解决，但其结构足够简单，可以采用更高效的解析解。目标是最大化 $v_2$。根据等式约束，我们可以将 $v_2$ 写为：\n    $$\n    v_2 = \\frac{1}{a} (v_1 - v_3 - b v_4)\n    $$\n    为了最大化 $v_2$（给定 $a > 0$），我们必须最大化项 $(v_1 - v_3 - b v_4)$。这可以通过最大化 $v_1$ 同时最小化 $v_3$ 和 $v_4$ 来实现。\n    - $v_3$ 的最小值为其下限 $m_{\\mathrm{eff},k}$。\n    - 目标中乘以 $v_1$ 的因子可以通过观察耦合关系 $v_4 \\ge r_{\\mathrm{of}} v_1$ 来看出。为了最大化表达式，我们应选择尽可能小的 $v_4$，即 $v_4 = r_{\\mathrm{of}} v_1$。将此代入目标函数得到：$v_1 - v_3 - b (r_{\\mathrm{of}} v_1) = v_1(1 - b r_{\\mathrm{of}}) - v_3$。由于全局参数为 $b=1$ 和 $r_{\\mathrm{of}}=0.1$，项 $(1 - b r_{\\mathrm{of}}) = 0.9$ 是正的。因此，为了最大化目标，我们必须最大化 $v_1$。\n\n    对 $v_1$ 的约束是：\n    i) 直接摄取限制：$v_1 \\le v_{1,\\max,k}$\n    ii) 来自产物分泌的间接限制：$v_4 = r_{\\mathrm{of}} v_1$ 必须满足 $v_4 \\le v_{4,\\max,k}$。这意味着 $r_{\\mathrm{of}} v_1 \\le v_{4,\\max,k}$，或 $v_1 \\le v_{4,\\max,k} / r_{\\mathrm{of}}$。\n    综合这些，$v_1$ 的有效上限是 $\\hat{v}_{1,k} = \\min(v_{1,\\max,k}, v_{4,\\max,k} / r_{\\mathrm{of}})$。策略是设置 $v_{1,k} = \\hat{v}_{1,k}$。\n\n    然而，必须存在一个可行解。只有当细胞能够摄取足够的底物来满足其强制性需求时，解才是可行的。对于任何非负生长（$v_2 \\ge 0$），我们必须有 $v_1 - v_3 - b v_4 \\ge 0$。使用 $v_3$ 和 $v_4$ 作为 $v_1$ 函数的最小值，我们得到：\n    $$\n    v_1 - m_{\\mathrm{eff},k} - b (r_{\\mathrm{of}} v_1) \\ge 0 \\implies v_1(1 - b r_{\\mathrm{of}}) \\ge m_{\\mathrm{eff},k}\n    $$\n    这为生存能力建立了最小所需摄取速率：$v_1 \\ge \\frac{m_{\\mathrm{eff},k}}{1 - b r_{\\mathrm{of}}}$。让我们将此阈值表示为 $v_{1,k}^0$。\n    为了存在可行解，最大可能摄取 $\\hat{v}_{1,k}$ 必须至少与最小所需摄取 $v_{1,k}^0$ 一样大。即 $\\hat{v}_{1,k} \\ge v_{1,k}^0$。\n    - 如果 $\\hat{v}_{1,k}  v_{1,k}^0$，LP 是不可行的。根据问题陈述，所有通量都设置为零：$v_k = [0, 0, 0, 0]^\\top$。\n    - 如果 $\\hat{v}_{1,k} \\ge v_{1,k}^0$，LP 是可行的，最优通量分布通过最大化摄取找到：\n      \\begin{align*}\n      v_{1,k} = \\hat{v}_{1,k} \\\\\n      v_{3,k} = m_{\\mathrm{eff},k} \\\\\n      v_{4,k} = r_{\\mathrm{of}} v_{1,k} \\\\\n      v_{2,k} = \\frac{1}{a} (v_{1,k}(1 - b r_{\\mathrm{of}}) - m_{\\mathrm{eff},k})\n      \\end{align*}\n\n5.  **数值积分**：使用步长为 $\\Delta t$ 的前向欧拉法，将胞外浓度从时间步 $k$ 更新到 $k+1$。\n    \\begin{align*}\n    S_{k+1} = \\max(0, S_k - \\Delta t \\cdot v_{1,k} \\cdot X_k) \\\\\n    X_{k+1} = \\max(0, X_k + \\Delta t \\cdot v_{2,k} \\cdot X_k) \\\\\n    P_{k+1} = \\max(0, P_k + \\Delta t \\cdot v_{4,k} \\cdot X_k)\n    \\end{align*}\n    操作 $\\max(0, \\cdot)$ 确保浓度保持非负，这是一个必要的物理约束。\n\n模拟通过对指定数量的时间步迭代应用解析 LP 解和欧拉更新来进行。", "answer": "[[41.002829, 2.766324, 5.716185], [0.000000, 0.170624, 0.182938], [1.139943, 1.936020, 64.288295]]", "id": "2762813"}]}