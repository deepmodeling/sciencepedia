{"hands_on_practices": [{"introduction": "在多色流式细胞术中，任何精确的定量分析都始于严谨的实验设计，其核心在于正确选择和使用对照。没有适当的对照，荧光补偿和圈门设定的准确性便无从谈起，最终导致数据解读的偏差。这项练习将考验你对不同类型对照（如同型对照、FMO对照和单染对照）背后原理的理解，并要求你从第一性原理出发，论证在多色实验中，为了实现精确补偿和可靠圈门，哪些对照是必不可少且充分的。", "problem": "一个合成生物学团队正在使用一个$m$色流式细胞术组合，来量化一个$m$基因报告回路在哺乳动物细胞中的性能，其中每个基因的输出都用一种独特的荧光染料标记。该仪器有$d$个检测器，每个检测器都具有固定的检测器增益$g_i$和带通滤波器。该团队需要估计表达分布和设定条件门，以校准基因表达的随机模型，并作出细胞分选的决策。他们必须决定，为了进行精确的补偿和有效的设门，哪些对照是必要且充分的。正在考虑的对照包括：同型对照、荧光减一 (FMO) 对照、单色对照和未染色对照。\n\n根据流式细胞术检测和线性解混的第一性原理，选择一个选项，该选项既能正确定义同型对照、FMO对照和单色对照，又能正确地指出，在固定仪器设置下，并假设存在实际水平的自发荧光和溢出效应时，要在此多色实验中进行精确补偿和设门，所需的最小必要且充分的对照组是什么。\n\nA. 同型对照：一种与测试抗体具有相同同种型和荧光染料的非结合性抗体，用于量化光谱溢出以进行补偿；FMO对照：用所有抗体染色的样本；单色对照：如果使用同型对照则非必需。必要且充分的对照：仅需每种荧光染料的同型对照。\n\nB. 同型对照：一种与测试抗体的同种型和荧光染料相匹配的非结合性抗体，用于估计非特异性结合背景；FMO对照：一个用组合中除目标标记物外的所有试剂染色的样本，用于在存在溢出和扩散误差的情况下，量化真实阴性群体的分布；单色对照：一个仅用一种荧光染料染色的样本（细胞或微球），用于在当前增益下估计该荧光染料到所有检测器中的溢出。必要且充分的对照：对于补偿，需要每种荧光染料的单色对照（在匹配的细胞或合适的微球上）加上一个未染色对照来确定基线；对于设门，需要为每个感兴趣的门设置FMO对照；同型对照是可选的诊断工具，对于补偿或设门都不是必需的。\n\nC. 同型对照：一种用于测量自发荧光的非结合性抗体；FMO对照：用于计算补偿矩阵，因为它包含了除一种荧光染料外的所有染料；单色对照：仅用于对阳性群体设门。必要且充分的对照：用于计算补偿的每种荧光染料的FMO对照，和用于设门的同型对照；不需要未染色对照。\n\nD. 同型对照：一种非结合性抗体，用于在补偿计算中校正非特异性结合；FMO对照：当使用补偿微球时则非必需；单色对照：每种荧光染料使用基于微球的单染来计算补偿。必要且充分的对照：仅单色微球对照即可，无需未染色或FMO对照，因为补偿消除了溢出，因此可以在补偿后的数据上设门，无需额外对照。\n\n选择唯一的最佳选项。", "solution": "**基于原理的推导**\n多色流式细胞术中的核心测量挑战是光谱溢出。任何给定荧光染料的发射光谱都很宽，导致其荧光信号在多个检测器中被检测到，而不仅仅是在其指定的主检测器中。这必须通过一个称为补偿的过程来校正。\n\n设$\\vec{M}$为$d$个检测器中测得的强度向量。设$\\vec{F}$为$m$种荧光染料各自的真实、纯粹的荧光强度向量。设$\\vec{A}$为细胞本身的背景自发荧光向量，在每个检测器中测得。它们之间的关系由一个线性模型描述：\n$$ \\vec{M} = \\mathbf{S} \\vec{F} + \\vec{A} $$\n其中$\\mathbf{S}$是$d \\times m$的溢出矩阵。该矩阵的元素$S_{ij}$表示来自荧光染料$j$的光在检测器$i$中被检测到的比例。补偿是求解$\\vec{F}$的数学过程，需要对该系统进行求逆：\n$$ \\vec{F} = \\mathbf{S}^{-1} (\\vec{M} - \\vec{A}) $$\n在分析中，我们通常使用一个从$\\mathbf{S}$导出的$m \\times m$方形补偿矩阵，然后将其应用于数据。\n\n为了对任何给定的细胞求解此方程，必须通过对照样本实验性地确定两个分量：$\\vec{A}$和$\\mathbf{S}$。\n\n1.  **确定自发荧光 ($\\vec{A}$)**：$\\vec{A}$是细胞在没有任何特异性荧光标记的情况下的基线信号。这是使用**未染色对照**来测量的：即取一份与实验所用细胞相同的样本，但不添加任何荧光染料。这个对照对于在每个检测器中建立电子噪声基底和生物自发荧光水平是必需的，为所有后续的荧光测量和补偿计算提供了锚点。\n\n2.  **确定溢出矩阵 ($\\mathbf{S}$)**：为了确定$\\mathbf{S}$的列，必须分离出每种荧光染料的独立信号。这通过使用**单色对照**来实现。对于组合中的$m$种荧光染料，每一种都准备一个只包含该荧光染料的独立对照样本。通过在所有$d$个检测器中测量这个单色对照的信号，并减去自发荧光背景（由未染色对照确定），就可以计算出该荧光染料信号在其主检测器和每个非目标检测器中的相对强度。对所有$m$种荧光染料重复此过程，以填充整个溢出矩阵。因此，一套包含$m$个单色对照和一个未染色对照的组合，是计算补偿矩阵所必需且充分的。\n\n3.  **精确设门**：补偿后，数据已经校正了溢出效应。然而，补偿中涉及的数学减法也会将亮通道的统计噪声（方差）传播到暗通道中。这种现象被称为**溢出扩散**，它会导致给定通道中“阴性”群体的分布因其他颜色的溢出而变宽。这种变宽会模糊真实阴性细胞和弱阳性细胞之间的区别，使得基于未染色群体来设置精确的门变得不可能。**荧光减一 (FMO) 对照**就是为解决这个问题而设计的。针对特定参数（例如参数$k$）的FMO对照包含了组合中*除了*对应于参数$k$的那种荧光染料之外的所有荧光染料。当在通道$k$中分析此样本时，所得分布显示了由于所有其他颜色的累积溢出和扩散而导致的通道$k$“阴性”群体的确切位置和扩展范围。这为设置门以识别真正对标记物$k$呈阳性的细胞提供了正确的边界。因此，在多色实验中进行有效设门，对于每个需要可靠设门的通道，尤其对于具有连续或低水平表达的群体，FMO对照是必需的。\n\n4.  **同型对照**：**同型对照**是一种抗体，它与特异性抗体具有相同的类别（同种型，例如IgG1, IgG2a）并偶联相同的荧光染料，但其可变区对所研究细胞上的任何抗原都没有已知的特异性。其预期目的是估计抗体结构本身的非特异性结合（例如，通过Fc受体）。然而，它的使用被广泛认为是有问题的，因为无法保证同型对照抗体的非特异性结合特性与特异性抗体的完全相同。对于设门而言，FMO对照是对阴性群体远为优越和更准确的表示。同型对照不用于补偿。因此，它不是补偿或设门所需的*最小必要且充分*对照组的一部分；它充其量是用于特定故障排除场景的可选诊断工具。\n\n总结如下：\n- **补偿所必需且充分的对照**：未染色对照和每种荧光染料的一个单色对照。\n- **有效设门所必需且充分的对照**：每个感兴趣的门的FMO对照。\n- **同型对照**：对于这两项任务都不是必要或充分的。\n\n**逐项分析**\n\n**A. 同型对照：一种与测试抗体具有相同同种型和荧光染料的非结合性抗体，用于量化光谱溢出以进行补偿；FMO对照：用所有抗体染色的样本；单色对照：如果使用同型对照则非必需。必要且充分的对照：仅需每种荧光染料的同型对照。**\n- 同型对照用途的定义是错误的；它不量化光谱溢出。那是单色对照的功能。\n- FMO对照的定义是错误的。它是用*除了一个之外*的所有荧光染料染色的样本。\n- 单色对照非必需的说法是根本错误的。没有它们，补偿是不可能的。\n- 仅同型对照是必要且充分的说法完全错误。\n**结论：不正确。**\n\n**B. 同型对照：一种与测试抗体的同种型和荧光染料相匹配的非结合性抗体，用于估计非特异性结合背景；FMO对照：一个用组合中除目标标记物外的所有试剂染色的样本，用于在存在溢出和扩散误差的情况下，量化真实阴性群体的分布；单色对照：一个仅用一种荧光染料染色的样本（细胞或微球），用于在当前增益下估计该荧光染料到所有检测器中的溢出。必要且充分的对照：对于补偿，需要每种荧光染料的单色对照（在匹配的细胞或合适的微球上）加上一个未染色对照来确定基线；对于设门，需要为每个感兴趣的门设置FMO对照；同型对照是可选的诊断工具，对于补偿或设门都不是必需的。**\n- 同型对照的定义是正确的。\n- FMO对照的定义是正确且精确的，正确地指出了其目的是为了精确设门而解释溢出和扩散误差。\n- 单色对照的定义是正确的。\n- 对补偿（单色+未染色）和设门（FMOs）所需必要且充分对照的识别，与基于第一性原理的推导完全一致。\n- 将同型对照归类为可选诊断工具也是正确的。\n**结论：正确。**\n\n**C. 同型对照：一种用于测量自发荧光的非结合性抗体；FMO对照：用于计算补偿矩阵，因为它包含了除一种荧光染料外的所有染料；单色对照：仅用于对阳性群体设门。必要且充分的对照：用于计算补偿的每种荧光染料的FMO对照，和用于设门的同型对照；不需要未染色对照。**\n- 同型对照用途的定义是错误的；它不测量自发荧光。那是未染色对照的功能。\n- FMO对照用途的定义是错误的；它用于设门，而不是用于计算补偿矩阵。\n- 单色对照用途的定义是错误的；其主要、不可或缺的作用是用于补偿。\n- “必要且充分”的陈述将错误的对照分配给了错误的任务。\n- 不需要未染色对照的说法是错误的；它是正确设置自发荧光基线所必需的。\n**结论：不正确。**\n\n**D. 同型对照：一种非结合性抗体，用于在补偿计算中校正非特异性结合；FMO对照：当使用补偿微球时则非必需；单色对照：每种荧光染料使用基于微球的单染来计算补偿。必要且充分的对照：仅单色微球对照即可，无需未染色或FMO对照，因为补偿消除了溢出，因此可以在补偿后的数据上设门，无需额外对照。**\n- 在现代补偿计算中不使用同型对照。\n- 当使用补偿微球时FMO对照非必需的说法是一个逻辑谬误。微球是用于补偿的单色对照的基质；FMO是用于对实际实验细胞进行设门。它们的作用完全不同。\n- 仅单色对照就足够了的说法是错误的；补偿还需要一个未染色对照。\n- 因为补偿消除了溢出效应就可以在没有FMO的情况下设门的说法是一个关键错误。补偿校正了平均/中位荧光强度，但没有消除由溢出引入的*扩散*（方差），这正是为什么精确设门需要FMO对照的原因。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "2762254"}, {"introduction": "获得可靠的对照数据后 ([@problem_id:2762254])，下一步便是进行核心的数据校正——荧光补偿。这项练习将引导你亲手执行补偿计算，将仪器测得的混合荧光信号“解混”为各个荧光分子的真实强度估算值。更重要的是，通过这个过程，你将量化一个不可避免的后果：补偿在校正平均信号的同时，也会放大测量噪声，产生所谓的“扩散误差”（spreading error），这对于解读低表达信号至关重要。", "problem": "一个经过基因工程改造的大肠杆菌菌株携带两个组成型表达的荧光报告基因，一个由蓝色光源激发，另一个由绿色光源激发。在一台具有两个检测通道的台式流式细胞仪中，由于光谱溢出效应，测得的强度是真实荧光团发射的线性混合。假设在平均强度水平上存在以下线性混合模型：如果真实的报告基因强度为向量 $\\mathbf{f} = \\begin{pmatrix} f_{1} \\\\ f_{2} \\end{pmatrix}$，而测得的（已减去背景的）强度为 $\\mathbf{m} = \\begin{pmatrix} m_{1} \\\\ m_{2} \\end{pmatrix}$，则有 $\\mathbf{m} = S \\mathbf{f} + \\boldsymbol{\\eta}$，其中 $S$ 是溢出矩阵，$\\boldsymbol{\\eta}$ 是零均值测量噪声。对于所使用的仪器配置，测得的溢出系数（来自单色对照）为\n$$\nS \\;=\\; \\begin{pmatrix}\n1  0.18 \\\\\n0.07  1\n\\end{pmatrix}.\n$$\n一个混合培养物样本产生已减去背景的平均测量强度为\n$$\n\\mathbf{m} \\;=\\; \\begin{pmatrix} 52000 \\\\ 31000 \\end{pmatrix} \\text{ 计数}。\n$$\n假设一个噪声模型，其中每个检测通道都表现出独立的泊松散粒噪声加上独立的加性电子噪声。具体来说，在给定通道 $i$ 的平均测量强度的情况下，该通道的方差为 $v_{i} = m_{i} + \\sigma_{e,i}^{2}$，其中电子噪声方差为\n$$\n\\sigma_{e,1}^{2} \\;=\\; 900 \\text{ 计数}^{2}, \\quad \\sigma_{e,2}^{2} \\;=\\; 400 \\text{ 计数}^{2}。\n$$\n任务：\n1. 从线性混合的定义出发，并根据补偿是反转 $S$ 的线性解混合这一原理，计算混合样本的真实荧光团强度的补偿估计值 $\\widehat{\\mathbf{f}}$。\n2. 使用一阶不确定性传播通过线性变换的方法，从测量空间中的对角测量噪声协方差构建补偿估计值的协方差矩阵 $\\Sigma_{\\widehat{\\mathbf{f}}}$。\n3. 将通道 $j$ 中的残余展宽误差定义为 $r_{j} = \\operatorname{Var}(\\widehat{f}_{j}) - ( \\widehat{f}_{j} + \\sigma_{e,j}^{2} )$，即补偿估计值相对于在相同平均光子计数且无溢出情况下应有的内在方差的超额方差。计算 $r_{1}$ 和 $r_{2}$。\n4. 报告总残余展宽误差 $R = r_{1} + r_{2}$。\n\n将您最终报告的标量 $R$ 四舍五入到四位有效数字。以 计数$^{2}$ 为单位表示残余展宽误差。最终答案必须是这一个经过四舍五入的标量。", "solution": "真实荧光团强度 $\\mathbf{f}$ 与测量强度 $\\mathbf{m}$ 之间的关系由线性模型 $\\mathbf{m} = S \\mathbf{f}$ 给出，此处忽略了平均量的噪声项。\n溢出矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n1  0.18 \\\\\n0.07  1\n\\end{pmatrix}\n$$\n测得的平均强度为\n$$\n\\mathbf{m} \\;=\\; \\begin{pmatrix} 52000 \\\\ 31000 \\end{pmatrix}\n$$\n\n**任务1：计算补偿估计值 $\\widehat{\\mathbf{f}}$**\n补偿是通过求溢出矩阵 $S$ 的逆来估计真实强度的过程。补偿矩阵是 $S^{-1}$。\n首先，我们计算 $S$ 的行列式：\n$$\n\\det(S) = (1)(1) - (0.18)(0.07) = 1 - 0.0126 = 0.9874\n$$\n由于 $\\det(S) \\neq 0$，该矩阵是可逆的。其逆矩阵为：\n$$\nS^{-1} = \\frac{1}{\\det(S)} \\begin{pmatrix} 1  -0.18 \\\\ -0.07  1 \\end{pmatrix} = \\frac{1}{0.9874} \\begin{pmatrix} 1  -0.18 \\\\ -0.07  1 \\end{pmatrix}\n$$\n真实荧光团强度的补偿估计值 $\\widehat{\\mathbf{f}}$，是通过将 $S^{-1}$ 应用于测量强度 $\\mathbf{m}$ 得到的：\n$$\n\\widehat{\\mathbf{f}} = S^{-1} \\mathbf{m} = \\frac{1}{0.9874} \\begin{pmatrix} 1  -0.18 \\\\ -0.07  1 \\end{pmatrix} \\begin{pmatrix} 52000 \\\\ 31000 \\end{pmatrix}\n$$\n执行矩阵-向量乘法：\n$$\n\\widehat{\\mathbf{f}} = \\frac{1}{0.9874} \\begin{pmatrix} (1)(52000) - (0.18)(31000) \\\\ (-0.07)(52000) + (1)(31000) \\end{pmatrix} = \\frac{1}{0.9874} \\begin{pmatrix} 52000 - 5580 \\\\ -3640 + 31000 \\end{pmatrix} = \\frac{1}{0.9874} \\begin{pmatrix} 46420 \\\\ 27360 \\end{pmatrix}\n$$\n这给出了估计的真实强度的数值：\n$$\n\\widehat{\\mathbf{f}} = \\begin{pmatrix} \\widehat{f}_1 \\\\ \\widehat{f}_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{46420}{0.9874} \\\\ \\frac{27360}{0.9874} \\end{pmatrix} \\approx \\begin{pmatrix} 47012.356 \\\\ 27710.148 \\end{pmatrix}\n$$\n\n**任务2：构建补偿估计值的协方差矩阵 $\\Sigma_{\\widehat{\\mathbf{f}}}$**\n不确定性通过线性变换 $\\widehat{\\mathbf{f}} = S^{-1} \\mathbf{m}$ 传播，其公式为 $\\Sigma_{\\widehat{\\mathbf{f}}} = S^{-1} \\Sigma_{\\mathbf{m}} (S^{-1})^T$。\n首先，我们必须确定测量的协方差矩阵 $\\Sigma_{\\mathbf{m}}$。问题指出每个通道中的噪声是独立的，因此 $\\Sigma_{\\mathbf{m}}$ 是一个对角矩阵。对角元素是方差 $v_i = m_i + \\sigma_{e,i}^2$。\n$$\nv_1 = \\operatorname{Var}(m_1) = m_1 + \\sigma_{e,1}^2 = 52000 + 900 = 52900 \\text{ 计数}^2\n$$\n$$\nv_2 = \\operatorname{Var}(m_2) = m_2 + \\sigma_{e,2}^2 = 31000 + 400 = 31400 \\text{ 计数}^2\n$$\n因此，测量协方差矩阵为：\n$$\n\\Sigma_{\\mathbf{m}} = \\begin{pmatrix} 52900  0 \\\\ 0  31400 \\end{pmatrix}\n$$\n现在我们计算 $\\Sigma_{\\widehat{\\mathbf{f}}}$。设 $W = S^{-1}$。$\\Sigma_{\\widehat{\\mathbf{f}}} = W \\Sigma_{\\mathbf{m}} W^T$ 的对角元素是补偿估计值的方差：\n$$\n\\operatorname{Var}(\\widehat{f}_1) = (\\Sigma_{\\widehat{\\mathbf{f}}})_{11} = w_{11}^2 v_1 + w_{12}^2 v_2\n$$\n$$\n\\operatorname{Var}(\\widehat{f}_2) = (\\Sigma_{\\widehat{\\mathbf{f}}})_{22} = w_{21}^2 v_1 + w_{22}^2 v_2\n$$\n代入 $W = S^{-1}$ 的元素：\n$$\nw_{11} = \\frac{1}{0.9874}, \\quad w_{12} = \\frac{-0.18}{0.9874}, \\quad w_{21} = \\frac{-0.07}{0.9874}, \\quad w_{22} = \\frac{1}{0.9874}\n$$\n方差为：\n$$\n\\operatorname{Var}(\\widehat{f}_1) = \\frac{1}{(0.9874)^2} \\left[ (1)^2(52900) + (-0.18)^2(31400) \\right] = \\frac{1}{0.97495876} \\left[ 52900 + (0.0324)(31400) \\right] = \\frac{52900 + 1017.36}{0.97495876} = \\frac{53917.36}{0.97495876} \\approx 55299.704\n$$\n$$\n\\operatorname{Var}(\\widehat{f}_2) = \\frac{1}{(0.9874)^2} \\left[ (-0.07)^2(52900) + (1)^2(31400) \\right] = \\frac{1}{0.97495876} \\left[ (0.0049)(52900) + 31400 \\right] = \\frac{259.21 + 31400}{0.97495876} = \\frac{31659.21}{0.97495876} \\approx 32472.338\n$$\n\n**任务3：计算残余展宽误差 $r_1$ 和 $r_2$**\n残余展宽误差定义为 $r_{j} = \\operatorname{Var}(\\widehat{f}_{j}) - ( \\widehat{f}_{j} + \\sigma_{e,j}^{2} )$。项 $(\\widehat{f}_{j} + \\sigma_{e,j}^{2})$ 表示在没有溢出的情况下，对于平均强度为 $\\widehat{f}_{j}$ 的信号所能观察到的内在方差（散粒噪声加电子噪声）。\n$$\nr_1 = \\operatorname{Var}(\\widehat{f}_1) - (\\widehat{f}_1 + \\sigma_{e,1}^2) \\approx 55299.704 - (47012.356 + 900) = 55299.704 - 47912.356 = 7387.348\n$$\n$$\nr_2 = \\operatorname{Var}(\\widehat{f}_2) - (\\widehat{f}_2 + \\sigma_{e,2}^2) \\approx 32472.338 - (27710.148 + 400) = 32472.338 - 28110.148 = 4362.190\n$$\n\n**任务4：计算总残余展宽误差 $R$**\n总残余展宽误差是各个误差的总和：\n$$\nR = r_1 + r_2 \\approx 7387.348 + 4362.190 = 11749.538\n$$\n问题要求将此结果四舍五入到四位有效数字。\n$$\nR \\approx 11750 \\text{ 计数}^2\n$$\n该值表示由于测量噪声通过解混合算法传播而引入到补偿数据中的总超额方差。", "answer": "$$\n\\boxed{11750}\n$$", "id": "2762335"}, {"introduction": "理解了补偿及其误差传播的机制后 ([@problem_id:2762335])，我们可以从被动的数据分析转向主动的实验设计优化。这项高级练习模拟了一个合成生物学中的常见挑战：如何将不同的报告基因与荧光标签进行最佳匹配，以最小化数据质量的损失。通过预先计算不同通道的预测扩散误差，你将学习如何做出战略性决策，将最“安静”的检测通道分配给最关键的生物学读数，从而在实验开始前就最大化信噪比。", "problem": "一个合成生物学的工程团队正在设计一个多报告基因电路，该电路由流式细胞术进行读出。他们计划编码三个靶标：一个N-酰基高丝氨酸内酯传感器 $T_{A}$、一个通用应激报告基因 $T_{B}$ 和一个组成型参比 $T_{C}$。每个靶标将用三种荧光团 $F_{1}$、$F_{2}$ 或 $F_{3}$ 中的一种进行标记，其主检测通道分别为 $D_{1}$、$D_{2}$ 和 $D_{3}$。仪器从真实荧光团强度 $\\mathbf{y}$ 到测量探测器信号 $\\mathbf{x}$ 的光谱混合（溢出）是线性的，即 $\\mathbf{x} = S\\,\\mathbf{y}$，其中溢出矩阵 $S$（其元素为分数溢出）为\n$$\nS \\;=\\; \\begin{pmatrix}\n1  0.05  0 \\\\\n0.07  1  0.06 \\\\\n0.01  0.02  1\n\\end{pmatrix}.\n$$\n补偿通过标准线性反演 $\\mathbf{y} = C\\,\\mathbf{x}$ 进行，其中 $C = S^{-1}$。采集未染色（阴性）细胞群以估计探测器噪声；假设探测器噪声是独立的，其协方差为 $\\Sigma_{x,\\text{neg}} = \\mathrm{diag}\\!\\big(\\sigma_{1}^{2}, \\sigma_{2}^{2}, \\sigma_{3}^{2}\\big)$，其中\n$$\n\\sigma_{1}^{2} = 400,\\quad \\sigma_{2}^{2} = 900,\\quad \\sigma_{3}^{2} = 1600\n$$\n单位为任意平方荧光单位。假设如下：(i) 光学和电子器件在相关范围内是线性的，(ii) 对于阴性细胞群，各探测器的噪声是加性的、零均值的、独立的，以及 (iii) 补偿变换 $C$ 应用于含噪测量值，无额外滤波。\n\n使用线性变换下协方差的线性误差传播基本原理，以及补偿后通道 $k$ 中预测的扩展误差的定义（即，补偿后由非对角线贡献产生的增量方差相对于其自身探测器噪声的基线贡献），计算每个补偿通道 $D_{1}$、$D_{2}$ 和 $D_{3}$ 的预测扩展误差。\n\n该团队的实验方案设计目标是最小化扩展误差对两个关键读数 $T_{A}$ 和 $T_{B}$ 的影响。设将 $T_{A}$ 映射到补偿通道 $i$ 并将 $T_{B}$ 映射到补偿通道 $j$ 的分配所产生的影响（惩罚）为\n$$\n\\Phi \\;=\\; w_{A}\\,SE_{i} \\;+\\; w_{B}\\,SE_{j},\n$$\n其中 $SE_{k}$ 是为补偿通道 $k$ 计算的预测扩展误差，$w_{A} = 2$，$w_{B} = 1$。第三个靶标 $T_{C}$ 接受剩余的荧光团，并且不计入惩罚。评估将 $\\{T_{A},T_{B},T_{C}\\}$ 一一对应分配给 $\\{F_{1},F_{2},F_{3}\\}$（等效地，通过主通道分配给 $\\{D_{1},D_{2},D_{3}\\}$）的所有 $6$ 种方案，按 $\\Phi$ 的升序对分配进行排序，并确定可实现的最小惩罚值。\n\n仅报告最小惩罚值。将最终数字四舍五入至四位有效数字。以任意平方荧光单位 (a.u.$^{2}$) 表示最终惩罚。", "solution": "解答过程分为两个主要部分。首先，我们计算每个补偿通道的扩展误差。其次，我们使用这些值来确定将报告基因分配给通道的最优方案，以最小化指定的惩罚函数。\n\n**第一部分：扩展误差（$SE_k$）的计算**\n\n对于未染色（阴性）细胞群，真实荧光 $\\mathbf{y}$ 与测量的含噪信号 $\\mathbf{x}$ 之间的关系是 $\\mathbf{y} = C\\,\\mathbf{x}$，其中 $\\mathbf{x}$ 仅代表探测器噪声。该探测器噪声的协方差矩阵由 $\\Sigma_{x,\\text{neg}} = \\mathrm{diag}(\\sigma_{1}^{2}, \\sigma_{2}^{2}, \\sigma_{3}^{2})$ 给出。\n\n根据线性误差传播原理，补偿信号的协方差矩阵 $\\Sigma_{y,\\text{neg}}$ 由以下变换给出：\n$$\n\\Sigma_{y,\\text{neg}} = C\\,\\Sigma_{x,\\text{neg}}\\,C^{T}\n$$\n其中 $C = S^{-1}$ 是补偿矩阵。设 $C$ 的元素为 $c_{ij}$。由于 $\\Sigma_{x,\\text{neg}}$ 是一个对角元素为 $\\sigma_{j}^{2}$ 的对角矩阵，$\\Sigma_{y,\\text{neg}}$ 的元素为：\n$$\n(\\Sigma_{y,\\text{neg}})_{ik} = \\sum_{j=1}^{3} c_{ij} c_{kj} \\sigma_{j}^{2}\n$$\n该矩阵的对角元素 $(\\Sigma_{y,\\text{neg}})_{kk}$ 表示阴性细胞群在第k个补偿通道中的总方差。\n$$\n\\mathrm{Var}(y_k) = (\\Sigma_{y,\\text{neg}})_{kk} = \\sum_{j=1}^{3} c_{kj}^{2} \\sigma_{j}^{2} = c_{k1}^{2}\\sigma_{1}^{2} + c_{k2}^{2}\\sigma_{2}^{2} + c_{k3}^{2}\\sigma_{3}^{2}\n$$\n问题将扩展误差（$SE_k$）定义为“由非对角线贡献产生的增量方差”。这对应于补偿通道k的总方差中，由所有其他探测器 $j \\neq k$ 的噪声贡献的部分。因此，我们从总方差中减去源自探测器k的项。探测器k的噪声对补偿通道k方差的贡献是 $c_{kk}^{2}\\sigma_{k}^{2}$。因此，通道k的扩展误差为：\n$$\nSE_{k} = \\mathrm{Var}(y_k) - c_{kk}^{2}\\sigma_{k}^{2} = \\sum_{j \\neq k} c_{kj}^{2}\\sigma_{j}^{2}\n$$\n\n为了计算这个值，我们首先需要补偿矩阵 $C = S^{-1}$。$S$的行列式是：\n$$\n\\det(S) = 1(1 \\cdot 1 - 0.06 \\cdot 0.02) - 0.05(0.07 \\cdot 1 - 0.06 \\cdot 0.01) = 1 - 0.0012 - 0.05(0.07 - 0.0006) = 0.9988 - 0.00347 = 0.99533\n$$\n逆矩阵 $C = S^{-1}$ 是 $\\frac{1}{\\det(S)}\\mathrm{adj}(S)$。\n$$\nC = \\frac{1}{0.99533} \\begin{pmatrix} 1-0.0012  -(0.05)  0.05 \\cdot 0.06 \\\\ -(0.07-0.0006)  1  -(0.06) \\\\ 0.07 \\cdot 0.02 - 1 \\cdot 0.01  -(1 \\cdot 0.02 - 0.05 \\cdot 0.01)  1 - 0.05 \\cdot 0.07 \\end{pmatrix}^T\n= \\frac{1}{0.99533} \\begin{pmatrix} 0.9988  -0.05  0.003 \\\\ -0.0694  1  -0.06 \\\\ -0.0086  -0.0195  0.9965 \\end{pmatrix}\n$$\n使用值 $\\sigma_{1}^{2}=400$, $\\sigma_{2}^{2}=900$ 和 $\\sigma_{3}^{2}=1600$，我们计算扩展误差：\n\n$SE_1 = c_{12}^{2}\\sigma_{2}^{2} + c_{13}^{2}\\sigma_{3}^{2}$\n$$\nSE_1 = \\left(\\frac{-0.05}{0.99533}\\right)^{2}(900) + \\left(\\frac{0.003}{0.99533}\\right)^{2}(1600) \\approx (0.0025235)(900) + (9.0847 \\times 10^{-6})(1600) \\approx 2.27116 + 0.01454 \\approx 2.28570\n$$\n\n$SE_2 = c_{21}^{2}\\sigma_{1}^{2} + c_{23}^{2}\\sigma_{3}^{2}$\n$$\nSE_2 = \\left(\\frac{-0.0694}{0.99533}\\right)^{2}(400) + \\left(\\frac{-0.06}{0.99533}\\right)^{2}(1600) \\approx (0.0048612)(400) + (0.0036339)(1600) \\approx 1.94446 + 5.81417 \\approx 7.75863\n$$\n\n$SE_3 = c_{31}^{2}\\sigma_{1}^{2} + c_{32}^{2}\\sigma_{2}^{2}$\n$$\nSE_3 = \\left(\\frac{-0.0086}{0.99533}\\right)^{2}(400) + \\left(\\frac{-0.0195}{0.99533}\\right)^{2}(900) \\approx (7.4655 \\times 10^{-5})(400) + (0.00038383)(900) \\approx 0.02986 + 0.34544 \\approx 0.37530\n$$\n\n所以，三个通道的扩展误差大约为：$SE_1 \\approx 2.28570$，$SE_2 \\approx 7.75863$ 和 $SE_3 \\approx 0.37530$。\n\n**第二部分：惩罚函数的最小化**\n\n需要最小化的惩罚函数是 $\\Phi = w_{A}SE_{i} + w_{B}SE_{j}$，其中靶标 $T_A$ 分配给通道 $i$，$T_B$ 分配给通道 $j$，且 $i \\neq j$。权重为 $w_A = 2$ 和 $w_B = 1$，所以 $\\Phi = 2\\,SE_{i} + 1\\,SE_{j}$。\n\n为了最小化这个加权和，逻辑推导表明，应将扩展误差最小的通道分配给权重最大的项。扩展误差排序如下：\n$$\nSE_3 \\approx 0.37530  SE_1 \\approx 2.28570  SE_2 \\approx 7.75863\n$$\n为了达到最小的 $\\Phi$，我们必须将 $T_A$ 分配给具有最小 $SE$ 的通道，即通道3。因此，我们设 $i=3$。对于 $T_B$，我们必须从剩下的通道1和2中选择。为了继续最小化总和，我们将 $T_B$ 分配给具有较小剩余 $SE$ 的通道，即通道1。因此，我们设 $j=1$。\n\n最优分配为 $T_A \\to D_3$ 和 $T_B \\to D_1$。最小惩罚值为：\n$$\n\\Phi_{\\min} = 2\\,SE_3 + 1\\,SE_1 \\approx 2(0.37530) + 1(2.28570) = 0.75060 + 2.28570 = 3.03630\n$$\n虽然可以评估 $(T_A, T_B)$ 的所有6种排列组合，但这种演绎方法直接确定了最小值。为完整起见，分配 $(i,j)=(3,1)$ 产生的 $\\Phi \\approx 3.0363$。任何其他分配都会产生更大的值。例如，第二优的分配 $(i,j)=(1,3)$ 将产生 $\\Phi = 2\\,SE_1 + SE_3 \\approx 2(2.28570) + 0.37530 = 4.5714 + 0.37530 = 4.9467$。\n\n问题要求将最小惩罚值四舍五入至四位有效数字。\n最小值为 $3.03630$。四舍五入到四位有效数字，即为 $3.036$。", "answer": "$$\\boxed{3.036}$$", "id": "2762379"}]}