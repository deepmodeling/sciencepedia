{"hands_on_practices": [{"introduction": "合成生物学的一个核心思想是将基因调控网络视为生物计算机。要设计和分析这些网络，我们必须能够用数学语言来描述其基本构件——逻辑门的行为。这个练习 [@problem_id:2554056] 将带你从最基本的生物物理事件，即转录因子与DNA的结合，出发，运用概率论的基本原理来建立转录逻辑的定量模型。通过推导AND、OR和XOR逻辑门的期望输出，你将掌握将分子相互作用转化为计算功能的核心技能，这是理解和设计更复杂基因线路的第一步。", "problem": "在动植物发育顺式调控系统的比较分析中，转录增强子将转录因子的占据情况整合为基因表达输出。考虑一个合成增强子，其上含有两个转录因子结合基序，记为A和B。这两个基序存在于在动物和植物系统中进行比较的直系同源增强子上。假设在任何时刻，基序A被结合的概率为 $p_A$，基序B被结合的概率为 $p_B$。A和B处的结合事件是独立的，且不存在协同性或竞争性。该增强子驱动一个报告基因的转录，其瞬时输出被建模为结合状态的布尔函数：当指定的逻辑条件满足时，输出为 $1$，否则为 $0$。长时间的平均表达量是该瞬时输出的时间平均值，在平稳状态下，它等于该逻辑条件为真的概率。最大输出被归一化为 $1$，最小输出被归一化为 $0$。\n\n仅使用概率论中的独立性定义和逻辑门的语义，推导在以下每种逻辑门（作用于A和B的占据状态）下，预期的平均归一化表达量（即转录开启的时间分数）作为 $p_A$ 和 $p_B$ 的函数：与门（AND）、或门（OR）和异或门（XOR）。将您的最终结果表示为关于 $p_A$ 和 $p_B$ 的封闭形式解析表达式，按与门（AND）、或门（OR）、异或门（XOR）的顺序，并以单行矩阵的形式呈现。不需要数值近似，也不应报告任何单位。", "solution": "所呈现的问题陈述是一个应用概率论中的形式化练习，其背景是一个简化的基因调控模型。在继续之前，需要进行严格的验证。\n\n首先，我将逐字提取给定的信息。\n1.  一个合成增强子有两个转录因子结合基序，A和B。\n2.  基序A被结合的概率为 $p_A$。\n3.  基序B被结合的概率为 $p_B$。\n4.  A和B处的结合事件是独立的。\n5.  不存在协同性或竞争性。\n6.  增强子输出被建模为结合状态的布尔函数。\n7.  如果指定的逻辑条件满足，则输出为 $1$，否则为 $0$。\n8.  长时间的平均表达量等于逻辑条件为真的概率。\n9.  最大输出被归一化为 $1$，最小输出被归一化为 $0$。\n10. 任务是推导与门（AND）、或门（OR）和异或门（XOR）逻辑门下的预期平均归一化表达量。\n11. 最终结果必须是关于 $p_A$ 和 $p_B$ 的封闭形式解析表达式。\n\n接下来，我将基于这些给定信息验证问题。\n该问题是**有科学依据的**。它使用了一个来自系统生物学的标准（尽管简化了的）理论模型来描述基因表达。转录因子结合概率、增强子以及输入信号的逻辑整合等概念是现代分子生物学和定量生物学的基石。独立性假设是构建此类模型的常见出发点。\n该问题是**适定的**。所有必要的参数（$p_A$, $p_B$）和条件（独立性）都已明确说明。所使用的术语，例如“平均表达量”等于“逻辑条件为真的概率”，在问题上下文中得到了明确的定义。目标很清晰：推导三个特定的数学表达式。对于每个逻辑门，都存在一个唯一的、稳定的解。\n该问题是**客观的**。其语言精确，没有任何主观或非科学的主张。\n该问题不违反任何指定的无效标准。它在其领域内是一个可形式化且相关的问题，包含完整且一致的设置，理论上可行，并且其结构保证了存在一个唯一的、有意义的解。\n\n结论是该问题是**有效的**。我将继续进行解答。\n\n设 $S_A$ 为基序A被结合的事件， $S_B$ 为基序B被结合的事件。问题陈述了这些事件的概率为 $P(S_A) = p_A$ 和 $P(S_B) = p_B$。因此，其互补事件——即基序未被结合——的概率为 $P(S_A^c) = 1 - p_A$ 和 $P(S_B^c) = 1 - p_B$。一个关键的已知条件是事件 $S_A$ 和 $S_B$ 是独立的。这意味着对于这些事件及其补集的任意组合，其联合概率是个体概率的乘积。\n\n平均归一化表达量，我们记为 $E$，是转录输出为 $1$ 的概率。我们必须为三种不同的逻辑条件计算这个值。\n\n1.  **与门（AND）逻辑**\n    对于与门（AND gate），当且仅当基序A和基序B都被结合时，输出为 $1$。这对应于事件 $S_A$ 和 $S_B$ 的交集。平均表达量是这个联合事件的概率。\n    $$E_{AND} = P(S_A \\cap S_B)$$\n    因为事件是独立的，它们交集的概率是它们各自概率的乘积。\n    $$E_{AND} = P(S_A) P(S_B)$$\n    代入给定的概率，我们得到：\n    $$E_{AND} = p_A p_B$$\n\n2.  **或门（OR）逻辑**\n    对于或门（OR gate），如果基序A被结合，或基序B被结合，或两者都被结合，则输出为 $1$。这对应于事件 $S_A$ 和 $S_B$ 的并集。平均表达量是这个并集的概率。\n    $$E_{OR} = P(S_A \\cup S_B)$$\n    使用概率的容斥原理，我们有：\n    $$E_{OR} = P(S_A) + P(S_B) - P(S_A \\cap S_B)$$\n    同样，由于独立性，$P(S_A \\cap S_B) = P(S_A)P(S_B) = p_A p_B$。代入此式和给定的个体概率：\n    $$E_{OR} = p_A + p_B - p_A p_B$$\n    或者，可以考虑互补事件：当且仅当A和B都未被结合时，输出为 $0$。这是事件 $S_A^c \\cap S_B^c$。输出为 $0$ 的概率是 $P(S_A^c \\cap S_B^c)$。由于 $S_A$ 和 $S_B$ 的独立性，它们的补集 $S_A^c$ 和 $S_B^c$ 也是独立的。\n    $$P(\\text{output}=0) = P(S_A^c)P(S_B^c) = (1 - p_A)(1 - p_B)$$\n    平均表达量 $E_{OR}$ 是输出为 $1$ 的概率，即 $1$ 减去输出为 $0$ 的概率。\n    $$E_{OR} = 1 - (1 - p_A)(1 - p_B) = 1 - (1 - p_A - p_B + p_A p_B) = p_A + p_B - p_A p_B$$\n    这证实了结果。\n\n3.  **异或门（XOR）逻辑**\n    对于异或门（XOR gate），当且仅当恰好有一个基序被结合时，输出为 $1$。这意味着（A被结合且B未被结合）或（A未被结合且B被结合）。这两种情况是互斥的。\n    平均表达量是这两个不相交事件的概率之和：\n    $$E_{XOR} = P((S_A \\cap S_B^c) \\cup (S_A^c \\cap S_B)) = P(S_A \\cap S_B^c) + P(S_A^c \\cap S_B)$$\n    由于独立性，我们可以分离联合概率：\n    $$P(S_A \\cap S_B^c) = P(S_A) P(S_B^c) = p_A(1 - p_B)$$\n    $$P(S_A^c \\cap S_B) = P(S_A^c) P(S_B) = (1 - p_A)p_B$$\n    将这些代入 $E_{XOR}$ 的表达式中：\n    $$E_{XOR} = p_A(1 - p_B) + (1 - p_A)p_B$$\n    展开各项：\n    $$E_{XOR} = p_A - p_A p_B + p_B - p_A p_B = p_A + p_B - 2 p_A p_B$$\n\n在与门、或门和异或门逻辑下，推导出的平均归一化表达量的表达式分别为 $p_A p_B$、$p_A + p_B - p_A p_B$ 和 $p_A + p_B - 2 p_A p_B$。这些结果将以单行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_A p_B & p_A + p_B - p_A p_B & p_A + p_B - 2 p_A p_B\n\\end{pmatrix}\n}\n$$", "id": "2554056"}, {"introduction": "一旦我们理解了逻辑门的数学模型，接下来的挑战就是如何在分子层面实际构建它们。蛋白质作为生命体中功能多样的主力分子，是实现生物计算的理想基石。本练习 [@problem_id:2059439] 将引导你进入蛋白质工程的世界，你需要像工程师一样，通过合理排布不同的功能结构域（如DNA结合域、激活域和传感器域），设计一个能够执行XOR逻辑的单一多肽链。这项实践旨在锻炼你的分子设计思维，让你深刻理解蛋白质的空间构象和变构调控如何共同实现复杂的逻辑运算。", "problem": "在合成生物学领域，工程师致力于设计具有特定逻辑功能的新型蛋白质。您的任务是提出一种合成转录激活子的设计方案，该激活子能作为异或（XOR）逻辑门运行。该激活子必须是单个多肽链，根据两种不同的小分子配体 $L_A$ 和 $L_B$ 的存在与否来控制基因表达。\n\n该蛋白质将由一组特性明确的结构域通过柔性接头连接而成。可用的结构域及其相互作用规则如下：\n\n-   **DNA结合域 (DBD):** 一个能与DNA上特定启动子序列结合的结构域，可将整个多肽链锚定在靶基因上。它是组成性激活的。\n-   **激活域 (AD):** 一个能招募细胞转录机器（如RNA聚合酶）以启动基因表达的结构域。除非受到物理阻碍，否则它是组成性激活的。\n-   **传感器-抑制剂域A ($I_A$):** 一个包含配体 $L_A$ 结合口袋的结构域。\n-   **传感器-抑制剂域B ($I_B$):** 一个包含配体 $L_B$ 结合口袋的结构域。\n\n这些结构域之间的相互作用受以下变构规则调控：\n1.  在没有任何配体的情况下，结构域 $I_A$ 和 $I_B$ 形成一个稳定的异源二聚体 ($I_A:I_B$)。该异源二聚体能够与 $AD$ 结构域结合并完全抑制其功能。\n2.  当结合其配体 $L_A$ 后，结构域 $I_A$ 发生构象变化，成为 $I_A^*$。$I_A^*$ 构象无法与未结合配体的 $I_B$ 结构域形成稳定的异源二聚体。\n3.  当结合其配体 $L_B$ 后，结构域 $I_B$ 发生构象变化，成为 $I_B^*$。$I_B^*$ 构象无法与未结合配体的 $I_A$ 结构域形成稳定的异源二聚体。\n4.  无论是单独的 $I_A$ 或 $I_B$（或其结合配体的对应物 $I_A^*$ 和 $I_B^*$），都不能抑制 $AD$ 结构域。抑制作用需要传感器-抑制剂域形成稳定的异源二聚体。\n5.  对XOR逻辑至关重要的是，两种配体结合后的构象 $I_A^*$ 和 $I_B^*$ 能够形成一个新的、稳定的异源二聚体 ($I_A^*:I_B^*$)。这个新的异源二聚体也能够与 $AD$ 结构域结合并完全抑制其功能。\n\n总体的转录输出应仅在两种配体（$L_A$ 或 $L_B$）中有且仅有一种存在时为“开启”（ON）状态。根据这些规则，对于单个多肽链，以下哪种线性结构域排列方式（从N端到C端）最有可能成功地作为一个XOR门发挥功能？\n\nA. N端 - DBD - $I_A$ - AD - $I_B$ - C端\n\nB. N端 - $I_A$ - DBD - $I_B$ - AD - C端\n\nC. N端 - DBD - AD - $I_A$ - $I_B$ - C端\n\nD. N端 - AD - $I_A$ - $I_B$ - DBD - C端", "solution": "我们需要一个单多肽链，其转录输出为ON当且仅当两种配体中恰好有一种存在。令 $s_A, s_B \\in \\{0, 1\\}$ 分别表示 $L_A$ 和 $L_B$ 的存在（1）与否（0）。根据规则：\n- 如果 $s_A=0$ 且 $s_B=0$，$I_A$ 和 $I_B$ 形成一个稳定的异源二聚体 $I_A:I_B$，该二聚体抑制 AD。\n- 如果 $s_A=1$ 且 $s_B=0$，$I_A \\to I_A^*$ 且不能与 $I_B$ 形成异源二聚体；不存在异源二聚体，根据规则4，AD 不会被抑制。\n- 如果 $s_A=0$ 且 $s_B=1$，$I_B \\to I_B^*$ 且不能与 $I_A$ 形成异源二聚体；不存在异源二聚体，所以 AD 不被抑制。\n- 如果 $s_A=1$ 且 $s_B=1$，$I_A^*$ 和 $I_B^*$ 形成一个稳定的异源二聚体 $I_A^*:I_B^*$，该二聚体抑制 AD。\n\n引入异源二聚体存在与否的指示变量：\n$$\nD = (1-s_A)(1-s_B) + s_A s_B\n$$\n根据规则，当且仅当 $D=1$ 时，AD 被抑制，前提是形成的异源二聚体能够在同一多肽链上物理接触到 AD。因此，转录输出 $Y$（$Y=1$ 意为ON）为\n$$\nY = 1 - D = 1 - \\left[(1-s_A)(1-s_B) + s_A s_B\\right] = s_A + s_B - 2 s_A s_B,\n$$\n其值仅在有且仅有一种配体存在时等于1。因此，当且仅当蛋白质的结构能够使任何形成的异源二聚体（无论是 $I_A:I_B$ 还是 $I_A^*:I_B^*$）结合并封闭 AD 结构域时，这些生化规则就已经实现了所需的异或逻辑。\n\n因此，最可靠的线性排列方式是将 AD 直接置于 $I_A$ 和 $I_B$ 之间，这样，在 $D=1$ 的状态下（无配体或两种配体都存在），分子内的异源二聚体可以“夹住” AD 并抑制它；而在 $D=0$ 的状态下（恰好一种配体存在），没有异源二聚体形成，根据规则4，AD 保持活性。此外，将 DBD 放置在邻近调控模块的末端，可以保持与DNA的高效锚定，而不会对 $I$ 结构域的“钳夹”造成空间位阻。\n\n评估各个选项：\n- A: N端 - DBD - $I_A$ - AD - $I_B$ - C端。在这里，AD 被 $I_A$ 和 $I_B$ 分置两侧，确保只要存在异源二聚体（$D=1$），它就可以结合并抑制 AD。当 $D=0$ 时，根据规则4，单个 $I$ 结构域都不能抑制 AD，因此 AD 是有活性的。这得到了所要求的 $Y = s_A+s_B-2s_A s_B$。\n- B: N端 - $I_A$ - DBD - $I_B$ - AD - C端。DBD 分隔了 $I_A$ 和 $I_B$，使得分子内异源二聚体的组装以及同时结合 AD 在几何上变得不利；“钳夹”无法可靠地在 AD 周围形成。这不太可能实现 $D=1 \\Rightarrow \\text{抑制}$。\n- C: N端 - DBD - AD - $I_A$ - $I_B$ - C端。两个 $I$ 结构域都位于 AD 的一侧，因此异源二聚体必须通过回环来结合 AD。虽然可能，但这种几何构型不如两侧排布可靠，因此不太可能产生稳健的 $D=1 \\Rightarrow \\text{抑制}$。\n- D: N端 - AD - $I_A$ - $I_B$ - DBD - C端。与C选项类似， $I$ 异源二聚体位于 AD 的一侧，并且 DBD 位于远端。这进一步降低了在 $D=1$ 时实现有效抑制的可能性。\n\n因此，最能直接且可靠地实现由规则1-5所强制的XOR逻辑的结构是选项A，它将 AD 置于 $I_A$ 和 $I_B$ 之间，并把 DBD 定位在能将该构建体锚定到DNA的位置。", "answer": "$$\\boxed{A}$$", "id": "2059439"}, {"introduction": "理论模型为我们设计基因逻辑门提供了蓝图，但在真实的细胞环境中，随机性和噪声无处不在。因此，将模型与充满噪声的实验数据相结合，并量化我们对模型参数和预测的不确定性，是合成生物学研究中的一项关键高级技能。本练习 [@problem_id:2781918] 将指导你使用贝叶斯推断这一强大的统计框架，为一个转录AND门建立模型，并根据给定的模拟实验数据来推断其关键生物物理参数。通过这项实践，你将学会如何从数据中“学习”模型，并对电路在未知条件下的行为做出有量化信心的预测，这完美体现了“设计-构建-测试-学习”的闭环工程思想。", "problem": "给定一个稳态生物物理模型，该模型用于一个双输入合成转录逻辑门，该逻辑门通过乘法性启动子占有率计算两个转录因子输入的模拟与（AND）运算。测得的报告基因水平被建模为对一个确定性转移函数的带噪声观测，该转移函数源于转录因子结合热力学（Hill函数）和分子生物学中心法则（脱氧核糖核酸到核糖核酸到蛋白质）。具体来说，对于输入 $I_1$ 和 $I_2$（非负浓度），该模型假设每个输入都通过一个Hill激活函数 $f(I;K,n) = \\dfrac{I^n}{K^n + I^n}$ 进行激活，并且启动子计算这两个占有率的乘积。对于一个参数向量 $\\theta = (b,a,K,n)$，稳态报告基因水平为\n$$\n\\mu(I_1,I_2 \\mid \\theta) \\;=\\; b \\;+\\; a \\cdot f(I_1;K,n)\\cdot f(I_2;K,n) \\,,\n$$\n其中 $b$ 是基础水平，$a$ 是动态范围，$K$ 是一个解离样标度，$n$ 是 Hill 系数。观测到的报告基因水平被建模为具有已知观测噪声标准差 $\\sigma$ 的高斯分布，因此对于观测数据 $\\{(I_{1,i},I_{2,i},y_i)\\}_{i=1}^N$，\n$$\ny_i \\;\\sim\\; \\mathcal{N}\\!\\left(\\mu(I_{1,i},I_{2,i}\\mid \\theta), \\, \\sigma^2 \\right) \\quad \\text{对于 } i=1,\\dots,N \\text{ 独立} \\,。\n$$\n我们通过在以下参数集上使用均匀先验，在一个离散网格上近似贝叶斯后验分布 $p(\\theta \\mid \\text{data})$：\n- $b \\in \\{0, 10, 20, 30, 40, 50\\}$,\n- $a \\in \\{50, 100, 150, 200, 250, 300\\}$,\n- $K \\in \\{1, 3, 10, 30, 100, 300\\}$,\n- $n \\in \\{1, 2, 3, 4\\}$.\n使用贝叶斯法则，在此网格上采用均匀先验和高斯似然来计算网格上归一化的离散后验权重。然后计算：\n- 后验均值 $\\mathbb{E}[b \\mid \\text{data}]$、$\\mathbb{E}[a \\mid \\text{data}]$、$\\mathbb{E}[K \\mid \\text{data}]$ 和 $\\mathbb{E}[n \\mid \\text{data}]$。\n- 对于每个指定的未测试输入对 $(I_1^\\star,I_2^\\star)$，使用全期望定律和全方差定律，针对高斯观测模型计算后验预测均值和标准差，\n$$\n\\mathbb{E}[y^\\star \\mid \\text{data}] \\;=\\; \\mathbb{E}_\\theta[\\mu(I_1^\\star,I_2^\\star\\mid \\theta)] \\,,\n$$\n$$\n\\operatorname{Var}[y^\\star \\mid \\text{data}] \\;=\\; \\operatorname{Var}_\\theta\\!\\big(\\mu(I_1^\\star,I_2^\\star\\mid \\theta)\\big) \\;+\\; \\sigma^2 \\,,\n$$\n并报告预测标准差 $\\sqrt{\\operatorname{Var}[y^\\star \\mid \\text{data}]}$。\n\n你的程序必须为以下三个测试用例实现此后验计算和预测不确定性分析。所有输入 $I_1$、$I_2$ 和观测值 $y$ 都是无量纲的。不需要进行单位转换。\n\n测试用例A（信息丰富、采样良好的类与门行为）：\n- 观测输入和输出 $(I_{1,i},I_{2,i},y_i)$:\n  - $(0, 0) \\to y = 20.0$,\n  - $(100, 0) \\to y = 20.0$,\n  - $(0, 100) \\to y = 20.0$,\n  - $(10, 10) \\to y = 70.0$,\n  - $(10, 100) \\to y = 119.00990099009901$,\n  - $(100, 100) \\to y = 216.05920988138416$.\n- 已知观测噪声标准差: $\\sigma = 5$.\n- 用于预测的未测试输入: $(I_1^\\star,I_2^\\star) \\in \\{(5, 5), (50, 50)\\}$.\n\n测试用例B（在观测范围内激活较弱，仅在更高输入时饱和）：\n- 观测输入和输出 $(I_{1,i},I_{2,i},y_i)$:\n  - $(0, 0) \\to y = 30.0$,\n  - $(100, 0) \\to y = 30.0$,\n  - $(0, 100) \\to y = 30.0$,\n  - $(100, 100) \\to y = 31.5$,\n  - $(50, 50) \\to y = 30.1095$.\n- 已知观测噪声标准差: $\\sigma = 2$.\n- 用于预测的未测试输入: $(I_1^\\star,I_2^\\star) \\in \\{(300, 300), (600, 600)\\}$.\n\n测试用例C（稀疏数据，最小约束）：\n- 观测输入和输出 $(I_{1,i},I_{2,i},y_i)$:\n  - $(0, 0) \\to y = 10.0$,\n  - $(100, 100) \\to y = 92.64462809917356$.\n- 已知观测噪声标准差: $\\sigma = 5$.\n- 用于预测的未测试输入: $(I_1^\\star,I_2^\\star) \\in \\{(10, 10), (100, 0)\\}$.\n\n实现细节和要求：\n- 使用定义 $f(I;K,n) = \\dfrac{I^n}{K^n + I^n}$，其中 $I \\ge 0$，$K > 0$，$n \\ge 1$。\n- 在上述离散网格上使用均匀先验。将网格上的未归一化对数后验计算为所有数据点的高斯对数似然项之和，为保证数值稳定性，通过减去最大对数后验来进行归一化，然后取指数，并重新归一化以获得在网格上总和为 $1$ 的后验权重。\n- 对于每个测试用例，计算：\n  - $\\mathbb{E}[b \\mid \\text{data}]$, $\\mathbb{E}[a \\mid \\text{data}]$, $\\mathbb{E}[K \\mid \\text{data}]$, $\\mathbb{E}[n \\mid \\text{data}]$,\n  - 对于每个指定的未测试输入 $(I_1^\\star,I_2^\\star)$，计算 $\\mathbb{E}[y^\\star \\mid \\text{data}]$ 和 $\\sqrt{\\operatorname{Var}[y^\\star \\mid \\text{data}]}$。\n- 四舍五入：将报告的每个浮点数精确到小数点后 $3$ 位。\n- 最终输出格式：你的程序应生成单行输出，其中包含一个类似JSON的嵌套列表，按 A、B、C 的顺序为每个测试用例提供一个子列表。每个子列表必须按此顺序包含 $8$ 个值：\n  - $\\mathbb{E}[b \\mid \\text{data}]$, $\\mathbb{E}[a \\mid \\text{data}]$, $\\mathbb{E}[K \\mid \\text{data}]$, $\\mathbb{E}[n \\mid \\text{data}]$, 第一个未测试输入的 $\\mathbb{E}[y^\\star \\mid \\text{data}]$，第一个未测试输入的 $\\sqrt{\\operatorname{Var}[y^\\star \\mid \\text{data}]}$，第二个未测试输入的 $\\mathbb{E}[y^\\star \\mid \\text{data}]$，第二个未测试输入的 $\\sqrt{\\operatorname{Var}[y^\\star \\mid \\text{data}]}$。\n例如，你的程序必须打印一行，如：\n[[bA,aA,KA,nA,meanA1,stdA1,meanA2,stdA2],[bB,aB,KB,nB,meanB1,stdB1,meanB2,stdB2],[bC,aC,KC,nC,meanC1,stdC1,meanC2,stdC2]]\n其中每个符号对应于相应案例的指定四舍五入后的量。", "solution": "该问题要求实现一个贝叶斯推断过程，以估计一个合成转录逻辑门的参数，并预测其对新输入的输出。该推断是在一个参数离散网格上使用均匀先验进行的。\n\n其方法论如下：\n\n首先，我们为贝叶斯分析建立数学框架。稳态报告基因水平的模型由转移函数给出：\n$$\n\\mu(I_1,I_2 \\mid \\theta) = b + a \\cdot f(I_1;K,n) \\cdot f(I_2;K,n)\n$$\n其中 $\\theta = (b, a, K, n)$ 是参数向量，而 $f(I;K,n)$ 是 Hill 函数：\n$$\nf(I;K,n) = \\frac{I^n}{K^n + I^n}\n$$\n假设观测数据 $y_i$ 从一个高斯分布中抽取，其均值为 $\\mu(I_{1,i},I_{2,i}\\mid \\theta)$，已知方差为 $\\sigma^2$：\n$$\ny_i \\sim \\mathcal{N}(\\mu(I_{1,i},I_{2,i}\\mid \\theta), \\sigma^2)\n$$\n\n分析在参数的离散网格上进行。设此网格上所有可能的参数向量集合为 $\\Theta = \\{\\theta_j\\}_{j=1}^M$。该网格由每个参数的指定值的笛卡尔积形成：\n- $b \\in \\{0, 10, 20, 30, 40, 50\\}$\n- $a \\in \\{50, 100, 150, 200, 250, 300\\}$\n- $K \\in \\{1, 3, 10, 30, 100, 300\\}$\n- $n \\in \\{1, 2, 3, 4\\}$\n网格中参数集的总数为 $M = 6 \\times 6 \\times 6 \\times 4 = 864$。\n\n根据贝叶斯法则，在给定观测数据 $D = \\{(I_{1,i}, I_{2,i}, y_i)\\}_{i=1}^N$ 的情况下，参数向量 $\\theta_j$ 的后验概率为：\n$$\np(\\theta_j \\mid D) = \\frac{p(D \\mid \\theta_j) p(\\theta_j)}{\\sum_{k=1}^M p(D \\mid \\theta_k) p(\\theta_k)}\n$$\n问题指定了均匀先验，因此对于所有 $j$，$p(\\theta_j)$ 是一个常数，具体为 $1/M$。公式简化为：\n$$\np(\\theta_j \\mid D) = \\frac{p(D \\mid \\theta_j)}{\\sum_{k=1}^M p(D \\mid \\theta_k)}\n$$\n项 $p(D \\mid \\theta_j)$ 是给定参数下数据的似然，记为 $L(\\theta_j)$。由于观测是独立的，似然是各个概率的乘积：\n$$\nL(\\theta_j) = \\prod_{i=1}^N \\mathcal{N}(y_i \\mid \\mu(I_{1,i},I_{2,i}\\mid \\theta_j), \\sigma^2) = \\prod_{i=1}^N \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - \\mu(I_{1,i},I_{2,i}\\mid \\theta_j))^2}{2\\sigma^2}\\right)\n$$\n为了数值稳定性，我们使用对数似然。$\\theta_j$ 的未归一化对数后验与对数似然成正比：\n$$\n\\log p(\\theta_j \\mid D) \\propto \\log L(\\theta_j) = \\sum_{i=1}^N \\left( -\\frac{1}{2}\\log(2\\pi\\sigma^2) - \\frac{(y_i - \\mu(I_{1,i},I_{2,i}\\mid \\theta_j))^2}{2\\sigma^2} \\right)\n$$\n由于我们关心的是相对后验概率，我们可以舍去常数项 $-\\frac{N}{2}\\log(2\\pi\\sigma^2)$，并将每个 $\\theta_j$ 的未归一化对数后验分数 $S_j$ 定义为：\n$$\nS_j = -\\sum_{i=1}^N \\frac{(y_i - \\mu(I_{1,i},I_{2,i}\\mid \\theta_j))^2}{2\\sigma^2}\n$$\n为了获得归一化的后验权重 $w_j = p(\\theta_j \\mid D)$，我们使用一种数值稳定的方法。首先，找到最大分数 $S_{\\max} = \\max_j S_j$。然后，按如下方式计算后验权重：\n$$\nw_j = \\frac{\\exp(S_j - S_{\\max})}{\\sum_{k=1}^M \\exp(S_k - S_{\\max})}\n$$\n一旦计算出后验权重 $\\{w_j\\}_{j=1}^M$，我们就可以计算所需的量。\n\n任何参数 $\\phi \\in \\{b, a, K, n\\}$ 的后验均值是其在后验分布上的期望：\n$$\n\\mathbb{E}[\\phi \\mid D] = \\sum_{j=1}^M \\phi_j \\cdot w_j\n$$\n其中 $\\phi_j$ 是向量 $\\theta_j$ 中参数 $\\phi$ 的值。\n\n对于一个新的、未测试的输入对 $(I_1^\\star, I_2^\\star)$，计算新观测值 $y^\\star$ 的后验预测分布。后验预测均值由全期望定律给出：\n$$\n\\mathbb{E}[y^\\star \\mid D] = \\mathbb{E}_\\theta[\\mathbb{E}[y^\\star \\mid \\theta, D]] = \\mathbb{E}_\\theta[\\mu(I_1^\\star, I_2^\\star \\mid \\theta)] = \\sum_{j=1}^M \\mu(I_1^\\star, I_2^\\star \\mid \\theta_j) \\cdot w_j\n$$\n后验预测方差由全方差定律给出：\n$$\n\\operatorname{Var}[y^\\star \\mid D] = \\mathbb{E}_\\theta[\\operatorname{Var}(y^\\star \\mid \\theta, D)] + \\operatorname{Var}_\\theta[\\mathbb{E}(y^\\star \\mid \\theta, D)]\n$$\n此处，$\\operatorname{Var}(y^\\star \\mid \\theta, D) = \\sigma^2$（观测噪声），且 $\\mathbb{E}(y^\\star \\mid \\theta, D) = \\mu(I_1^\\star, I_2^\\star \\mid \\theta)$。这可以简化为：\n$$\n\\operatorname{Var}[y^\\star \\mid D] = \\sigma^2 + \\operatorname{Var}_\\theta[\\mu(I_1^\\star, I_2^\\star \\mid \\theta)]\n$$\n方差项 $\\operatorname{Var}_\\theta[\\mu^\\star]$ 是模型预测在参数后验分布上的方差：\n$$\n\\operatorname{Var}_\\theta[\\mu^\\star] = \\mathbb{E}_\\theta[(\\mu^\\star)^2] - (\\mathbb{E}_\\theta[\\mu^\\star])^2 = \\left(\\sum_{j=1}^M \\mu(I_1^\\star,I_2^\\star \\mid \\theta_j)^2 \\cdot w_j\\right) - (\\mathbb{E}[y^\\star \\mid D])^2\n$$\n后验预测标准差是此方差的平方根，即 $\\sqrt{\\operatorname{Var}[y^\\star \\mid D]}$。\n\n将这整个过程实现并应用于提供的三个测试用例。计算在完整的参数网格上进行，结果按要求四舍五入到小数点后 $3$ 位。", "answer": "[[20.000,200.000,30.000,2.000,39.385,6.602,153.846,5.000],[30.000,165.753,248.910,2.502,106.634,70.970,147.241,85.297],[10.000,97.234,92.518,3.220,11.393,6.381,10.000,5.000]]", "id": "2781918"}]}