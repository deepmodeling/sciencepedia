{"hands_on_practices": [{"introduction": "本练习为基因转换开关奠定了数学基础。我们将从完整模型出发，利用无量纲化（一种简化复杂系统的强大技术）来揭示控制其行为的核心参数。然后，通过线性稳定性分析，我们将精确地确定双稳态（该开关的标志性特性）出现的条件。[@problem_id:2783261]", "problem": "一个典型的相互抑制基因拨动开关由两个基因组成，其蛋白质产物相互抑制对方的转录。在转录调控的标准准稳态假设和一阶蛋白质降解假设下，蛋白质浓度 $U(t)$ 和 $V(t)$ 的一个最小模型由以下常微分方程 (ODEs) 给出\n$$\n\\frac{dU}{dt}=\\frac{\\alpha_{1}}{1+\\left(\\frac{V}{K_{2}}\\right)^{n_{2}}}-\\delta_{1}\\,U,\\qquad\n\\frac{dV}{dt}=\\frac{\\alpha_{2}}{1+\\left(\\frac{U}{K_{1}}\\right)^{n_{1}}}-\\delta_{2}\\,V,\n$$\n其中 $t$ 是时间，$\\alpha_{i}$ 是最大合成速率，$\\delta_{i}$ 是蛋白质降解（或稀释）速率，$K_{i}$ 是抑制阈值，$n_{i}$ 是描述协同抑制的希尔系数。\n\n从这个有量纲模型出发，并仅使用以下基本原理：\n- 稳态下的转录抑制由形式为 $1/\\left(1+(X/K)^{n}\\right)$ 的希尔函数表示。\n- 蛋白质的清除主要由速率常数为 $\\delta_{i}$ 的一阶过程主导。\n- 无量纲化通过定义吸收物理单位的标度化变量来减少参数数量。\n\n完成以下任务：\n1. 通过用抑制阈值对浓度进行标度化，以及用降解时间尺度对时间进行标度化，来引入无量纲变量，并推导出无量纲常微分方程，明确写出最小的独立无量纲参数组。\n2. 将问题特殊化到对称情况，即 $\\alpha_{1}=\\alpha_{2}=\\alpha$, $\\delta_{1}=\\delta_{2}=\\delta$, $K_{1}=K_{2}=K$, 且 $n_{1}=n_{2}=n\\geq 1$。在两种浓度相等的不变子空间上，分析对称不动点的线性稳定性。确定无量纲生产参数的临界值，在该值下，对称不动点首次通过一个零特征值失去稳定性，这标志着双稳态的开始。\n\n你的最终答案必须是关于临界无量纲生产参数的一个只包含希尔系数 $n$ 的闭式解析表达式。最终答案不需要单位。不要在最终答案中提供中间步骤或额外的文字。", "solution": "所述问题具有科学依据，提法明确且客观。它提出了一个来自合成生物学的典型模型，并要求进行标准的、尽管并非不重要的数学分析。所有必要的信息都已提供，且前提条件是一致的。因此，我们可以着手进行解答。\n\n该问题要求对基因拨动开关模型进行两部分分析。首先，我们必须对控制常微分方程 (ODEs) 进行无量纲化。其次，我们必须在特殊的对称情况下分析对称不动点的稳定性，以找到双稳态出现的临界参数值。\n\n有量纲模型由以下耦合常微分方程给出：\n$$\n\\frac{dU}{dt}=\\frac{\\alpha_{1}}{1+\\left(\\frac{V}{K_{2}}\\right)^{n_{2}}}-\\delta_{1}\\,U\n$$\n$$\n\\frac{dV}{dt}=\\frac{\\alpha_{2}}{1+\\left(\\frac{U}{K_{1}}\\right)^{n_{1}}}-\\delta_{2}\\,V\n$$\n这里，$U(t)$ 和 $V(t)$ 是蛋白质浓度，$t$ 是时间，$\\alpha_{i}$ 是最大合成速率，$\\delta_{i}$ 是一阶降解速率，$K_{i}$ 是抑制阈值（半最大抑制时的浓度），$n_{i}$ 是表示抑制协同性的希尔系数。\n\n**第1部分：无量纲化**\n我们按照指示引入无量纲变量。我们用各自的抑制阈值对浓度进行标度化：\n$$\nu = \\frac{U}{K_{1}}, \\qquad v = \\frac{V}{K_{2}}\n$$\n我们用其中一个降解时间尺度对时间进行标度化。我们选择 $\\frac{1}{\\delta_1}$，定义无量纲时间 $\\tau$：\n$$\n\\tau = \\delta_{1}t\n$$\n根据这些定义，我们有 $U = u K_{1}$，$V = v K_{2}$，以及 $t = \\frac{\\tau}{\\delta_1}$。时间导数变换为 $\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = \\delta_{1}\\frac{d}{d\\tau}$。\n\n将这些代入第一个常微分方程：\n$$\n\\delta_{1}\\frac{d(u K_{1})}{d\\tau} = \\frac{\\alpha_{1}}{1+v^{n_{2}}} - \\delta_{1} u K_{1}\n$$\n$$\nK_{1}\\delta_{1}\\frac{du}{d\\tau} = \\frac{\\alpha_{1}}{1+v^{n_{2}}} - \\delta_{1} u K_{1}\n$$\n除以 $K_{1}\\delta_{1}$：\n$$\n\\frac{du}{d\\tau} = \\frac{\\alpha_{1}}{K_{1}\\delta_{1}}\\frac{1}{1+v^{n_{2}}} - u\n$$\n现在，代入第二个常微分方程：\n$$\n\\delta_{1}\\frac{d(v K_{2})}{d\\tau} = \\frac{\\alpha_{2}}{1+u^{n_{1}}} - \\delta_{2} v K_{2}\n$$\n$$\nK_{2}\\delta_{1}\\frac{dv}{d\\tau} = \\frac{\\alpha_{2}}{1+u^{n_{1}}} - \\delta_{2} v K_{2}\n$$\n除以 $K_{2}\\delta_{1}$：\n$$\n\\frac{dv}{d\\tau} = \\frac{\\alpha_{2}}{K_{2}\\delta_{1}}\\frac{1}{1+u^{n_{1}}} - \\frac{\\delta_{2}}{\\delta_{1}} v\n$$\n现在，系统用无量纲变量 $\\{u, v, \\tau\\}$ 表示。我们确定独立的无量纲参数组：\n- 无量纲合成速率：$\\tilde{\\alpha}_{1} = \\frac{\\alpha_{1}}{K_{1}\\delta_{1}}$ 和 $\\tilde{\\alpha}_{2} = \\frac{\\alpha_{2}}{K_{2}\\delta_{1}}$。\n- 降解速率之比：$\\gamma = \\frac{\\delta_{2}}{\\delta_{1}}$。\n希尔系数 $n_{1}$ 和 $n_{2}$ 本身就是无量纲的。\n\n无量纲系统为：\n$$\n\\frac{du}{d\\tau} = \\frac{\\tilde{\\alpha}_{1}}{1+v^{n_{2}}} - u\n$$\n$$\n\\frac{dv}{d\\tau} = \\frac{\\tilde{\\alpha}_{2}}{1+u^{n_{1}}} - \\gamma v\n$$\n\n**第2部分：对称情况的稳定性分析**\n我们现在特殊化到对称情况，其中 $\\alpha_{1}=\\alpha_{2}=\\alpha$，$\\delta_{1}=\\delta_{2}=\\delta$，$K_{1}=K_{2}=K$，且 $n_{1}=n_{2}=n$。\n无量纲参数变为：\n- $\\tilde{\\alpha}_{1} = \\frac{\\alpha}{K\\delta}$ 和 $\\tilde{\\alpha}_{2} = \\frac{\\alpha}{K\\delta}$。我们把这个共同的无量纲生产参数记为 $\\beta = \\frac{\\alpha}{K\\delta}$。\n- $\\gamma = \\frac{\\delta}{\\delta} = 1$。\n\n对称的无量纲系统是：\n$$\n\\frac{du}{d\\tau} = \\frac{\\beta}{1+v^{n}} - u \\equiv f(u,v)\n$$\n$$\n\\frac{dv}{d\\tau} = \\frac{\\beta}{1+u^{n}} - v \\equiv g(u,v)\n$$\n我们寻找对称不动点，其中 $u=v$。设不动点坐标为 $(u^{*}, v^{*})$。对于对称不动点，$u^{*} = v^{*} = x^{*}$。令时间导数为零，不动点条件变为一个单一方程：\n$$\nx^{*} = \\frac{\\beta}{1+(x^{*})^{n}}\n$$\n为了分析此不动点的线性稳定性，我们计算系统的雅可比矩阵 $J$：\n$$\nJ(u,v) = \\begin{pmatrix} \\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{\\beta n v^{n-1}}{(1+v^{n})^{2}} \\\\ -\\frac{\\beta n u^{n-1}}{(1+u^{n})^{2}}  -1 \\end{pmatrix}\n$$\n在对称不动点 $(x^{*}, x^{*})$ 处计算雅可比矩阵：\n$$\nJ(x^{*},x^{*}) = \\begin{pmatrix} -1  -\\frac{\\beta n (x^{*})^{n-1}}{(1+(x^{*})^{n})^{2}} \\\\ -\\frac{\\beta n (x^{*})^{n-1}}{(1+(x^{*})^{n})^{2}}  -1 \\end{pmatrix}\n$$\n根据不动点方程，我们可以代入 $\\beta = x^{*}(1+(x^{*})^{n})$。非对角线项变为：\n$$\n-\\frac{x^{*}(1+(x^{*})^{n}) n (x^{*})^{n-1}}{(1+(x^{*})^{n})^{2}} = -\\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}\n$$\n将此项记为 $C$。不动点处的雅可比矩阵为 $J = \\begin{pmatrix} -1  C \\\\ C  -1 \\end{pmatrix}$。特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} -1-\\lambda  C \\\\ C  -1-\\lambda \\end{pmatrix} = (-1-\\lambda)^{2} - C^{2} = 0\n$$\n$$\n(\\lambda+1)^{2} = C^{2} \\implies \\lambda+1 = \\pm C \\implies \\lambda = -1 \\pm C\n$$\n两个特征值是：\n$$\n\\lambda_{1} = -1 + C = -1 - \\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}\n$$\n$$\n\\lambda_{2} = -1 - C = -1 + \\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}\n$$\n为使不动点稳定，两个特征值都必须具有负实部。\n由于 $n \\ge 1$ 且 $x^{*} > 0$，项 $\\frac{n (x^{*})^{n}}{1+(x^{*})^{n}}$ 总是正的。因此，$\\lambda_{1}$ 总是负的。稳定性由 $\\lambda_{2}$ 的符号决定。\n当 $\\lambda_{2}$ 从负值变为正值并穿过零时，对称不动点失去稳定性。这个分岔标志着新的非对称不动点的出现，对应于双稳态的开始。临界条件是 $\\lambda_{2}=0$。设 $x^{*}_{c}$ 是分岔时的不动点值。\n$$\n-1 + \\frac{n (x^{*}_{c})^{n}}{1+(x^{*}_{c})^{n}} = 0\n$$\n$$\nn (x^{*}_{c})^{n} = 1+(x^{*}_{c})^{n}\n$$\n$$\n(n-1)(x^{*}_{c})^{n} = 1\n$$\n这个方程仅在 $n > 1$ 时才有对 $x^{*}_{c} > 0$ 有意义的解。如果 $n=1$，方程变为 $0=1$，这是不可能的。对于 $n=1$，$\\lambda_{2} = -1 + \\frac{x^{*}}{1+x^{*}} = -\\frac{1}{1+x^{*}}  0$，所以系统总是单稳态的。此开关中的双稳态现象要求协同抑制，即 $n>1$。\n\n对于 $n>1$，我们求解临界不动点浓度 $x^{*}_{c}$：\n$$\n(x^{*}_{c})^{n} = \\frac{1}{n-1} \\implies x^{*}_{c} = \\left(\\frac{1}{n-1}\\right)^{\\frac{1}{n}}\n$$\n问题要求的是无量纲生产参数的临界值 $\\beta_{c}$。我们通过将 $x^{*}_{c}$ 代回不动点方程来找到这个值：\n$$\n\\beta_{c} = x^{*}_{c}(1+(x^{*}_{c})^{n})\n$$\n$$\n\\beta_{c} = \\left(\\frac{1}{n-1}\\right)^{\\frac{1}{n}} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n简化第二项：\n$$\n1 + \\frac{1}{n-1} = \\frac{n-1+1}{n-1} = \\frac{n}{n-1}\n$$\n因此，临界值 $\\beta_{c}$ 是：\n$$\n\\beta_{c} = \\frac{n}{n-1} \\left(\\frac{1}{n-1}\\right)^{\\frac{1}{n}} = \\frac{n}{(n-1)^{1} (n-1)^{\\frac{1}{n}}} = \\frac{n}{(n-1)^{1+\\frac{1}{n}}}\n$$\n该表达式最终可以写为：\n$$\n\\beta_{c} = \\frac{n}{(n-1)^{\\frac{n+1}{n}}}\n$$\n这是无量纲生产参数的临界值，在该值下，对称稳态失去稳定性，从而产生双稳态。这种分岔是一种超临界叉式分岔。", "answer": "$$\n\\boxed{\\frac{n}{(n-1)^{\\frac{n+1}{n}}}}\n$$", "id": "2783261"}, {"introduction": "虽然解析方法揭示了双稳态的条件，但找到实际的稳态浓度通常需要借助计算机。本练习将指导您开发一个数值算法，以定位基因转换开关的所有不动点。掌握这种计算方法使您能够探索开关在各种生物学参数下的行为，超越理想化的案例。[@problem_id:2783277]", "problem": "您将设计并实现一个数值计算程序，以计算一个经典的双基因遗传拨动开关（Genetic Toggle Switch）模型在Hill型调控下的所有不同不动点，该模型涉及转录抑制。您还需要报告几组不同参数集对应的解的数量。该拨动开关在蛋白质水平上由以下无量纲常微分方程组建模，这些方程源自于分子生物学中心法则（DNA转录为RNA，翻译为蛋白质）和经过充分检验的用于转录控制的Hill抑制函数：\n- 对于蛋白质浓度 $x(t)$ 和 $y(t)$，\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^{n}} \\;-\\; x,\n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^{m}} \\;-\\; y.\n$$\n这里，$\\alpha_x,\\alpha_y$ 是无量纲最大合成参数，$K_x,K_y$ 是无量纲抑制阈值，而 $n,m$ 是Hill系数（协同性）。不动点是任何同时满足稳态条件 $\\frac{dx}{dt}=0$ 和 $\\frac{dy}{dt}=0$ 的点对 $(x^\\ast,y^\\ast)$。\n\n您的程序必须对下面的测试套件中的每一组参数，计算所有满足 $x^\\ast \\ge 0$ 和 $y^\\ast \\ge 0$ 的不同不动点 $(x^\\ast,y^\\ast)$，然后仅输出所找到的不同解的数量。不同性必须通过以下标准来确定：如果两个解 $(x_1,y_1)$ 和 $(x_2,y_2)$ 同时满足 $|x_1-x_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|x_1|,|x_2|\\}$ 和 $|y_1-y_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|y_1|,|y_2|\\}$，则它们代表同一个不动点，其中 $\\varepsilon_{\\text{abs}} = 10^{-8}$ 且 $\\varepsilon_{\\text{rel}} = 10^{-6}$。\n\n科学假设和约束：\n- 所有参数 $\\alpha_x,\\alpha_y,K_x,K_y,n,m$ 均为严格正实数。\n- 物理上允许的不动点需满足 $x^\\ast \\ge 0$ 和 $y^\\ast \\ge 0$。任何违反这些不等式的候选解都必须被舍弃。\n- 单位通过构造已无量纲化；报告解的数量时仅需报告无量纲的计数值。\n- 您对 $x^\\ast$ 和 $y^\\ast$ 的搜索域可以使用模型隐含的最大值进行限定；任何不动点都必须满足 $0 \\le x^\\ast \\le \\alpha_x$ 和 $0 \\le y^\\ast \\le \\alpha_y$ 是严格成立的。\n\n您的数值程序必须在整个测试套件中具有通用性和鲁棒性，并且不得依赖于不动点的解析闭式解。您可以使用浮点计算。角度单位不适用。结果必须是确定性的。\n\n测试套件（每一项都是一个元组 $(\\alpha_x,\\alpha_y,K_x,K_y,n,m)$）：\n- 情况 A: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (50,50,1,1,4,4)$\n- 情况 B: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (10,10,1,1,1,1)$\n- 情况 C: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (40,8,1,1,4,4)$\n- 情况 D: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (10,10,5,5,3,3)$\n- 情况 E: $(\\alpha_x,\\alpha_y,K_x,K_y,n,m) = (6,6,1,1,1.5,1.5)$\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个整数列表，每个整数对应于上述测试用例的一个结果（按顺序排列），给出为每种情况找到的不同不动点的数量。\n- 输出必须是单行，格式严格为\n“[rA,rB,rC,rD,rE]”\n其中 $rA$ 是情况A的整数结果，以此类推。", "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于已建立的遗传调控网络理论，在数学上是适定的，并给出了客观、明确的规范。这是计算系统生物学中一个标准的、非平凡的问题。因此，我们可以着手解决。\n\n任务是为一个代表遗传拨动开关的耦合常微分方程组找到不同非负不动点 $(x^\\ast, y^\\ast)$ 的数量。不动点是时间导数为零的稳态解。该系统由以下方程给出：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^{m}} - y\n$$\n将导数设为零，可得到不动点 $(x^\\ast, y^\\ast)$ 满足的条件：\n$$\nx^\\ast = \\frac{\\alpha_x}{1 + \\left(\\frac{y^\\ast}{K_y}\\right)^{n}} \\quad \\equiv f(y^\\ast)\n$$\n$$\ny^\\ast = \\frac{\\alpha_y}{1 + \\left(\\frac{x^\\ast}{K_x}\\right)^{m}} \\quad \\equiv g(x^\\ast)\n$$\n这两个方程定义了系统的零斜线。不动点是这两条零斜线在 $(x, y)$ 平面非负象限中的交点。\n\n为了在不依赖解析形式的情况下数值求解该系统，我们可以将其简化为单变量的求根问题。通过将 $y^\\ast$ 的表达式代入 $x^\\ast$ 的方程，我们得到一个关于 $x^\\ast$ 的单一方程：\n$$\nx^\\ast = f(g(x^\\ast)) = \\frac{\\alpha_x}{1 + \\left( \\frac{1}{K_y} \\left( \\frac{\\alpha_y}{1 + \\left(\\frac{x^\\ast}{K_x}\\right)^{m}} \\right) \\right)^{n}}\n$$\n不动点的 $x$ 坐标 $x^\\ast$ 必须是函数 $H(x)$ 的一个根：\n$$\nH(x) = x - f(g(x)) = 0\n$$\n问题陈述正确地指出，任何物理上有意义的解都必须满足 $0 \\le x^\\ast \\le \\alpha_x$ 和 $0 \\le y^\\ast \\le \\alpha_y$。这是因为Hill型抑制项是有界的。因此，我们可以将 $H(x)=0$ 的求根搜索限制在闭区间 $[0, \\alpha_x]$ 内。\n\n找到所有这些根的数值程序如下：\n1.  **离散化定义域**：将 $x$ 的搜索区间 $[0, \\alpha_x]$ 用一个精细的网格划分为大量的小子区间。设网格点为 $x_i$，其中 $i=0, 1, \\dots, N$。\n2.  **界定潜在根**：在每个网格点 $x_i$ 上计算函数 $H(x)$ 的值。如果 $H(x_i)$ 和 $H(x_{i+1})$ 的符号相反，即 $H(x_i) \\cdot H(x_{i+1})  0$，则根据介值定理，在子区间 $[x_i, x_{i+1}]$ 内保证存在一个根，因为函数 $H(x)$ 是连续的。我们还需显式检查根是否正好落在网格点上，即 $H(x_i) = 0$ 的情况。\n3.  **精炼根**：对于每个界定了根的子区间 $[x_i, x_{i+1}]$，采用一个鲁棒的数值求根算法来高精度地确定根 $x^\\ast$。Brent-Dekker方法（`scipy.optimize`中的`brentq`）是完成此任务的绝佳选择，因为它结合了保证收敛和高效率的优点。\n4.  **构建完整解**：对于找到的每个不同的根 $x^\\ast_j$，使用零斜线方程 $y^\\ast_j = g(x^\\ast_j)$ 计算出相应的 $y$ 坐标。这样就得到了一个候选不动点 $(x^\\ast_j, y^\\ast_j)$。\n5.  **筛选不同解**：由于网格搜索的性质，该程序可能会找到同一数学根的多个数值近似值。因此，必须对候选解列表进行筛选，以仅保留不同的不动点。这通过遍历解列表，并使用问题中指定的精确容差标准将每个新解与已接受的不同解进行比较来完成：如果 $|x_1 - x_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|x_1|, |x_2|\\}$ 且 $|y_1 - y_2| \\le \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\max\\{|y_1|, |y_2|\\}$，则两个点 $(x_1, y_1)$ 和 $(x_2, y_2)$ 被认为是相同的，其中 $\\varepsilon_{\\text{abs}} = 10^{-8}$ 且 $\\varepsilon_{\\text{rel}} = 10^{-6}$。\n\n这种系统化的方法确保了在指定域内的所有不动点都能被准确找到和计数，并遵守问题的所有约束。最终的Python实现将对测试套件中提供的每个参数集执行此逻辑。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the genetic toggle switch problem for all test cases.\n    It computes the number of distinct fixed points for each parameter set and\n    prints the results in the specified format. The correct output is [3,1,3,3,3].\n    \"\"\"\n    test_cases = [\n        # (alpha_x, alpha_y, K_x, K_y, n, m)\n        (50.0, 50.0, 1.0, 1.0, 4.0, 4.0),  # Case A -> Bistable, 3 solutions\n        (10.0, 10.0, 1.0, 1.0, 1.0, 1.0),  # Case B -> Monostable (n=1), 1 solution\n        (40.0, 8.0, 1.0, 1.0, 4.0, 4.0),   # Case C -> Asymmetric bistable, 3 solutions\n        (10.0, 10.0, 5.0, 5.0, 3.0, 3.0),  # Case D -> Bistable, 3 solutions\n        (6.0, 6.0, 1.0, 1.0, 1.5, 1.5),    # Case E -> Bistable, 3 solutions\n    ]\n\n    results = []\n    for params in test_cases:\n        num_solutions = count_fixed_points(params)\n        results.append(num_solutions)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef count_fixed_points(params):\n    \"\"\"\n    Calculates the number of distinct fixed points for a given set of parameters.\n    \"\"\"\n    alpha_x, alpha_y, K_x, K_y, n, m = params\n    \n    eps_abs = 1e-8\n    eps_rel = 1e-6\n\n    def is_close(p1, p2):\n        \"\"\"\n        Custom comparison function to determine if two points are the same\n        based on the problem's specific tolerance definition.\n        \"\"\"\n        x1, y1 = p1\n        x2, y2 = p2\n        \n        x_tol = eps_abs + eps_rel * max(abs(x1), abs(x2))\n        y_tol = eps_abs + eps_rel * max(abs(y1), abs(y2))\n        \n        return abs(x1 - x2) = x_tol and abs(y1 - y2) = y_tol\n\n    def g(x_val):\n        \"\"\"Defines the nullcline function y = g(x).\"\"\"\n        x_safe = np.maximum(x_val, 0)\n        return alpha_y / (1.0 + (x_safe / K_x)**m)\n\n    def f(y_val):\n        \"\"\"Defines the nullcline function x = f(y).\"\"\"\n        y_safe = np.maximum(y_val, 0)\n        return alpha_x / (1.0 + (y_safe / K_y)**n)\n\n    def H(x_val):\n        \"\"\"Root-finding function H(x) = x - f(g(x)).\"\"\"\n        return x_val - f(g(x_val))\n\n    search_min = 0.0\n    search_max = alpha_x\n    \n    N_grid = 20000\n    x_grid = np.linspace(search_min, search_max, N_grid)\n    \n    solutions = []\n\n    try:\n        h_vals = np.array([H(xi) for xi in x_grid])\n    except (OverflowError, ValueError):\n        # Fallback for numerical instability, though not expected here\n        print(\"Warning: Numerical instability encountered.\")\n        return 0\n\n    # Grid scan to bracket and find roots\n    for i in range(N_grid - 1):\n        h1, h2 = h_vals[i], h_vals[i+1]\n        x1, x2 = x_grid[i], x_grid[i+1]\n\n        root_to_add = None\n        if h1 * h2  0:\n            try:\n                # A root is bracketed, refine it with brentq\n                root_to_add = brentq(H, x1, x2)\n            except ValueError:\n                # This should not be reached if h1*h2  0, but is a safeguard\n                pass\n        elif h1 == 0:\n            # A root lies exactly on a grid point\n            root_to_add = x1\n            \n        if root_to_add is not None:\n            solutions.append((root_to_add, g(root_to_add)))\n    \n    # Check the very last grid point\n    if h_vals[-1] == 0:\n        root_to_add = x_grid[-1]\n        solutions.append((root_to_add, g(root_to_add)))\n\n    # Filter for distinct solutions using the specified tolerance\n    distinct_solutions = []\n    if not solutions:\n        return 0\n    \n    for sol in solutions:\n        is_distinct = True\n        for d_sol in distinct_solutions:\n            if is_close(sol, d_sol):\n                is_distinct = False\n                break\n        if is_distinct:\n            # Check physical admissibility (x>=0, y>=0)\n            if sol[0] >= 0 and sol[1] >= 0:\n                distinct_solutions.append(sol)\n            \n    return len(distinct_solutions)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2783277"}, {"introduction": "合成生物学的一个关键目标是实现电路行为的可预测性改造。本练习将挑战您像电路设计师一样思考，分析一种常见的改造——给阻遏蛋白附加降解标签——如何影响基因转换开关的稳定性和转换阈值。通过运用零斜线分析，您将建立起对分子水平变化如何转化为系统水平功能的定性直觉。[@problem_id:2783198]", "problem": "一个工程化的遗传拨动开关由两个基因组成，这两个基因编码蛋白质阻遏物 $X$ 和 $Y$，它们相互抑制对方的启动子。作为一个基本基础，我们假设分子生物学中心法则（转录产生信使核糖核酸 (mRNA)，后者被翻译成蛋白质）和标准的动力学描述：生产由转录抑制控制，这可以通过 Hill 型函数来描述；损失由一级稀释和蛋白质水解驱动。一个广泛使用的关于蛋白质浓度 $x(t)$ 和 $y(t)$ 的确定性模型是\n$$\n\\frac{dx}{dt} \\;=\\; \\beta_x\\,\\frac{1}{1+\\left(\\sigma_y y/K_y\\right)^{n_y}} \\;+\\; \\beta_{0x} \\;-\\; \\delta_x\\,x, \\qquad\n\\frac{dy}{dt} \\;=\\; \\beta_y\\,\\frac{1}{1+\\left(\\sigma_x x/K_x\\right)^{n_x}} \\;+\\; \\beta_{0y} \\;-\\; \\delta_y\\,y,\n$$\n其中 $K_x,K_y$ 是抑制阈值，$n_x,n_y$ 是 Hill 系数（$n_x,n_y>1$）以描述协同抑制，$\\beta_x,\\beta_y$ 是最大生产速率，$\\beta_{0x},\\beta_{0y}$ 是基础（泄露）生产速率，$\\delta_x,\\delta_y$ 是由稀释和降解引起的有效一级损失速率。使阻遏物 $X$ 和 $Y$ 失活的小分子诱导剂通过 $\\sigma_x,\\sigma_y\\in(0,1]$ 进入模型，这些参数量化了可用于结合 DNA 的活性阻遏物部分；例如，增加靶向 $X$ 的诱导剂会降低 $\\sigma_x$。\n\n附加到阻遏物上的“降解标签”会增加其蛋白质水解速率，而不改变其 DNA 结合特性。我们将 $X$ 上的标签理想化为 $\\delta_x \\mapsto \\tau_x\\,\\delta_x$（其中 $\\tau_x>1$），将 $Y$ 上的标签理想化为 $\\delta_y \\mapsto \\tau_y\\,\\delta_y$（其中 $\\tau_y>1$），同时保持 $\\beta$、$\\beta_0$、$K$、$n$ 以及 $\\sigma$-诱导剂剂量-反应关系不变。\n\n考虑一个初始对称的拨动开关，其参数为 $\\beta_x=\\beta_y=\\beta$、$\\beta_{0x}=\\beta_{0y}=\\beta_0$、$K_x=K_y=K$、$n_x=n_y=n$ 和 $\\delta_x=\\delta_y=\\delta$，它在零诱导剂（即 $\\sigma_x=\\sigma_y=1$）时是双稳态的。假设 $\\beta_0/\\beta$ 很小但不为零，且 $n$ 足够大以允许双稳态。你在两种情况下引入降解标签：(i) 对称标记，$\\tau_x=\\tau_y=\\tau>1$；(ii) 非对称标记，$\\tau_x=\\tau>1$ 且 $\\tau_y=1$。\n\n仅使用上述模型结构和基于第一性原理的零斜线和不动点论证，评估这些标签对稳定状态下蛋白质浓度以及诱导剂空间中切换阈值（即鞍点-节点分岔消除一个稳定状态时的临界 $\\sigma$ 值）的影响，并假设在指定情况下，标记后双稳态仍然存在。\n\n下列哪个陈述是正确的？\n\nA. 在对称标记（$\\tau>1$）下，与未标记的拨动开关相比，两个稳定状态的蛋白质水平均降低，迟滞窗口变宽，诱导剂阈值向外移动（即双向切换都需要更多诱导剂）。\n\nB. 在对称标记（$\\tau>1$）下，与未标记的拨动开关相比，两个稳定状态的蛋白质水平均降低，迟滞窗口变窄，诱导剂阈值向内移动（即双向切换都需要更少诱导剂）。\n\nC. 在对称标记（$\\tau>1$）下，两个稳定状态的蛋白质水平均增加，因为更快的周转加速了生产周期，迟滞窗口变窄，阈值向内移动。\n\nD. 在非对称标记（$\\tau_x>1$ 和 $\\tau_y=1$）下，拨动开关变得有偏向性：$X$ 高表达状态的稳定性降低，需要更少靶向 $X$ 的诱导剂来切换到 $Y$ 高表达状态，而从 $Y$ 高表达状态到 $X$ 高表达状态的反向切换则需要更多靶向 $Y$ 的诱导剂；非对称程度随 $\\tau_x$ 的增加而增加。", "solution": "问题陈述经过验证，是有效的。这是一个基于非线性动力学和合成生物学既定原则的适定问题，使用了遗传拨动开关的经典模型。语言精确，设定自洽且科学合理。\n\n系统行为的分析基于其零斜线，零斜线描述了每种蛋白质浓度变化率为零的条件。系统的稳态，或称不动点，是这些零斜线的交点。通过设置 $\\frac{dx}{dt}=0$ 和 $\\frac{dy}{dt}=0$ 可以得到零斜线的方程：\n$$ \\delta_x\\,x \\;=\\; \\beta_x\\,\\frac{1}{1+\\left(\\sigma_y y/K_y\\right)^{n_y}} \\;+\\; \\beta_{0x} \\quad (\\text{x-零斜线}) $$\n$$ \\delta_y\\,y \\;=\\; \\beta_y\\,\\frac{1}{1+\\left(\\sigma_x x/K_x\\right)^{n_x}} \\;+\\; \\beta_{0y} \\quad (\\text{y-零斜线}) $$\n这些可以写成函数 $x(y)$ 和 $y(x)$，代表在 $(x, y)$ 相平面中的曲线。当这两条 S 形的递减曲线相交于三点时，出现双稳态：两个稳定不动点，对应于（$X$ 高表达，$Y$ 低表达）和（$Y$ 高表达，$X$ 低表达）状态，以及它们之间的一个不稳定鞍点。这些点的位置和稳定性，以及导致它们出现或消失的分岔，都由系统参数决定。\n\n初始的对称、未标记的拨动开关具有参数 $\\beta_x=\\beta_y=\\beta$、$\\beta_{0x}=\\beta_{0y}=\\beta_0$、$K_x=K_y=K$、$n_x=n_y=n$ 和 $\\delta_x=\\delta_y=\\delta$。近似的稳态水平为 $(\\bar{x}_{\\text{high}}, \\bar{y}_{\\text{low}}) \\approx \\left( (\\beta + \\beta_0)/\\delta, \\beta_0/\\delta \\right)$ 和 $(\\bar{x}_{\\text{low}}, \\bar{y}_{\\text{high}}) \\approx \\left( \\beta_0/\\delta, (\\beta + \\beta_0)/\\delta \\right)$。\n\n我们现在分析这两种情况。\n\n**情况 (i): 对称标记 ($\\tau_x = \\tau_y = \\tau  1$)**\n\n在这种情况下，降解率变为 $\\delta_x' = \\tau\\delta$ 和 $\\delta_y' = \\tau\\delta$。新的零斜线方程为：\n$$ x(y) = \\frac{1}{\\tau\\delta} \\left( \\beta\\,\\frac{1}{1+\\left(\\sigma_y y/K\\right)^{n}} \\;+\\; \\beta_{0} \\right) $$\n$$ y(x) = \\frac{1}{\\tau\\delta} \\left( \\beta\\,\\frac{1}{1+\\left(\\sigma_x x/K\\right)^{n}} \\;+\\; \\beta_{0} \\right) $$\n\n1.  **对稳态浓度的影响**：与未标记系统相比，两个零斜线方程都被缩放了一个因子 $1/\\tau  1$。这意味着对于任何给定的阻遏物浓度，所表达蛋白质的稳态浓度都更低。因此，稳定不动点处的浓度将更低。新的近似水平为 $\\bar{x}_{\\text{high}}' \\approx (\\beta + \\beta_0)/(\\tau\\delta)$ 和 $\\bar{y}_{\\text{high}}' \\approx (\\beta + \\beta_0)/(\\tau\\delta)$。高表达和低表达的蛋白质水平均降低了 $\\tau$ 倍。\n\n2.  **对迟滞和切换阈值的影响**：产生双稳态开关的相互抑制的有效性，可以通过一个无量纲的环路增益参数来量化。在保持生产速率 $\\beta$ 和抑制阈值 $K$ 不变的情况下增加降解率 $\\delta$，会降低稳态蛋白质水平。较低的蛋白质水平导致较弱的抑制，从而降低了反馈环路的有效增益。具有较低环路增益的系统具有较小的双稳态区域。较小的双稳态区域意味着迟滞窗口变窄。这意味着定义了切换阈值的鞍点-节点分岔发生在较小的诱导剂浓度范围内。具体来说，要从 $Y$ 高表达状态切换到 $X$ 高表达状态，需要施加使 $Y$ 失活的诱导剂，从而降低 $\\sigma_y$。更窄的窗口意味着切换发生在更大的 $\\sigma_y$ 值（更接近 1）处，这对应于更低的诱导剂浓度。同样的逻辑对称地适用于另一个切换。因此，诱导剂阈值向内移动。\n\n基于此分析：\n-   **选项 A**：指出稳定状态蛋白质水平降低，但声称迟滞窗口变宽且阈值向外移动。后两个说法不正确。\n-   **选项 B**：指出稳定状态蛋白质水平降低，迟滞窗口变窄，诱导剂阈值向内移动。这与我们的分析完全一致。\n-   **选项 C**：指出稳定状态蛋白质水平增加。这从根本上是错误的。增加降解必然导致稳态浓度降低，因为生产函数与降解率无关。“更快的周转加速了生产周期”的推理是虚假的。\n\n因此，陈述 B 是正确的，而 A 和 C 是不正确的。\n\n**情况 (ii): 非对称标记 ($\\tau_x = \\tau  1, \\tau_y = 1$)**\n\n此处，降解率为 $\\delta_x' = \\tau\\delta$ 和 $\\delta_y' = \\delta$。这打破了系统的对称性。零斜线变为：\n$$ x(y) = \\frac{1}{\\tau\\delta} \\left( \\beta\\,\\frac{1}{1+\\left(\\sigma_y y/K\\right)^{n}} \\;+\\; \\beta_{0} \\right) \\quad (\\text{x-零斜线})$$\n$$ y(x) = \\frac{1}{\\delta} \\left( \\beta\\,\\frac{1}{1+\\left(\\sigma_x x/K\\right)^{n}} \\;+\\; \\beta_{0} \\right) \\quad (\\text{y-零斜线})$$\ny-零斜线与未标记的对称情况相同，但 x-零斜线被缩减了 $1/\\tau$ 的因子。在相平面中，这意味着 x-零斜线向 y 轴移动（即向更低的 x 值移动）。\n\n1.  **偏向性和稳定性**：x-零斜线的移动打破了相图的对称性。对应于 $X$ 高表达、$Y$ 低表达状态的交点移动到了一个更低的 x 值。这种较低浓度的 $X$ 阻遏物在抑制 $Y$ 基因表达方面的效果较差。该状态的吸引盆收缩，且状态向中心鞍点靠近，使其稳定性降低。相反，$Y$ 高表达状态变得更加稳健。系统现在偏向于 $Y$ 高表达、$X$ 低表达的状态。这证实了“拨动开关变得有偏向性：$X$ 高表达状态的稳定性降低”。\n\n2.  **切换阈值**：\n    -   **从 $X$ 高表达切换到 $Y$ 高表达**：此切换通过降低 $\\sigma_x$（添加 $X$ 的诱导剂）来诱导。这导致 y-零斜线向上移动。由于 $X$ 高表达状态已经稳定性较差且更接近分岔点，因此只需要 y-零斜线较小的向上移动即可触发消除此状态的鞍点-节点分岔。较小的移动对应于 $\\sigma_x$ 从 1 开始的较小下降。因此，临界值 $\\sigma_{x,crit}$ 更大（更接近 1），意味着需要更少的诱导剂。这证实了“...需要更少靶向 $X$ 的诱导剂来切换...”。\n    -   **从 $Y$ 高表达切换到 $X$ 高表达**：此切换通过降低 $\\sigma_y$（添加 $Y$ 的诱导剂）来诱导。这将 x-零斜线向右移动。由于降解标签的原因，x-零斜线最初因因子 $1/\\tau$ 而向左移动，因此需要更大的补偿性向右移动才能达到与 y-零斜线的切点。这需要 $\\sigma_y$ 更大的下降。因此，临界值 $\\sigma_{y,crit}$ 更小，意味着需要更多的诱导剂。这证实了“...反向切换...需要更多靶向 $Y$ 的诱导剂”。\n\n3.  **对 $\\tau_x$ 的依赖性**：所有非对称效应都源于增加的降解率 $\\delta_x' = \\tau_x\\delta$。随着 $\\tau_x$ 的增加，x-零斜线进一步向左移动，放大了所有的后果：对 $X$ 高表达状态的偏向性变得更强，切换所需的诱导剂浓度的差异也随之增大。这证实了“...非对称程度随 $\\tau_x$ 的增加而增加”。\n\n基于此分析：\n-   **选项 D**：此陈述的所有部分都与我们的零斜线分析一致。拨动开关变得有偏向性，$X$ 高表达状态的稳定性降低，从该状态切换更容易（诱导剂更少），切换到该状态更难（诱导剂更多），并且这种非对称性随着 $\\tau_x$ 的增加而放大。\n\n因此，陈述 D 是正确的。\n\n**结论**\n\n我们的分析基于应用于所提供模型的零斜线几何和分岔理论的第一性原理，表明陈述 B 和陈述 D 都是对指定修改下系统行为的正确描述。\n\n*   **选项 A**：**不正确**。对称标记使迟滞窗口变窄，而不是变宽。\n*   **选项 B**：**正确**。对称标记降低了蛋白质水平并使迟滞窗口变窄，使阈值向内移动。\n*   **选项 C**：**不正确**。蛋白质水平降低，而不是增加。\n*   **选项 D**：**正确**。对 $X$ 的非对称标记使开关偏向于不利于 $X$ 高表达状态，使其稳定性降低，并如所述改变了诱导剂阈值。", "answer": "$$\\boxed{BD}$$", "id": "2783198"}]}