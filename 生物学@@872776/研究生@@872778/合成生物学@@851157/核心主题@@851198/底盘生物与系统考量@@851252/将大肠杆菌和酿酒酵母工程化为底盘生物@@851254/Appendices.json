{"hands_on_practices": [{"introduction": "在新的宿主生物中成功表达一个基因是合成生物学的基石。一个关键步骤是密码子优化，这涉及调整DNA序列以匹配宿主的翻译机制。本练习将指导你建立一个基于宿主特异性密码子丰度的定量模型，来预测翻译效率，从而让你能够比较大肠杆菌和酿酒酵母，并在序列水平上识别潜在的生产瓶颈 [@problem_id:2732911]。", "problem": "您将获得一个用于翻译延伸的形式化动力学模型，以比较单个编码DNA序列在两种宿主生物体中的预期翻译效率：大肠杆菌（E. coli）和酿酒酵母（S. cerevisiae）。该模型遵循分子生物学的中心法则，并假定宿主中每个密码子的平均解码时间与相应转移核糖核酸（tRNA）的可用性成反比，此处该可用性由宿主特异性密码子可用性权重代理。形式上，对于宿主 $h$、密码子 $c$ 以及任意依赖于宿主的比例常数 $k_h>0$，解码时间为 $t_{c,h} = 1/(k_h f_{c,h})$，其中 $f_{c,h}>0$ 是给定宿主 $h$ 中密码子 $c$ 的相对可用性权重。对于一个由密码子 $\\{c_1,\\dots,c_L\\}$ 组成的编码序列，总延伸时间为 $T_h = \\sum_{i=1}^{L} t_{c_i,h}$。为了消除未知的宿主依赖性尺度因子和序列长度的影响，您必须计算宿主 $h$ 中的归一化相对翻译效率，定义为\n$$\nE_h \\equiv \\frac{T_{h,\\mathrm{opt}}}{T_h} = \\frac{\\sum_{i=1}^{L} \\frac{1}{f_{a_i,h}^{\\max}}}{\\sum_{i=1}^{L} \\frac{1}{f_{c_i,h}}},\n$$\n其中 $a_i$ 是在位置 $i$ 指定的氨基酸，而 $f_{a_i,h}^{\\max}$ 是宿主 $h$ 中氨基酸 $a_i$ 的同义密码子中最大的 $f_{c,h}$。这种归一化对应于最佳时间（在每个位置使用宿主 $h$ 中最佳的同义密码子）与给定序列的实际时间之比。此外，将宿主 $h$ 中的翻译瓶颈定义为序列中达到最大单密码子时间 $t_{c_i,h}$ 的密码子位置集合；即，使得 $\\frac{1}{f_{c_i,h}}$ 最大化的位置 $i$。\n\n此任务的输入数据在下面已完全指定，并且必须直接嵌入到您的程序中。序列字母表是脱氧核糖核酸（DNA），使用标准大写碱基，阅读框从第一个核苷酸开始。所有频率 $f_{c,h}$ 均为严格正实数。\n\n您必须实现上述模型，并为每个测试用例计算：序对 $(E_{\\mathrm{Ec}}, E_{\\mathrm{Sc}})$、跨宿主比率 $R = E_{\\mathrm{Ec}}/E_{\\mathrm{Sc}}$，以及两种宿主的瓶颈位置列表（作为基于1的索引）。所有浮点输出必须四舍五入到6位小数。序列中出现且进行归一化所需的氨基酸仅有赖氨酸 (K)、甘氨酸 (G)、脯氨酸 (P) 和天冬氨酸 (D)，其同义密码子如下：\n- 赖氨酸 (K): {AAA, AAG}。\n- 甘氨酸 (G): {GGT, GGC, GGA, GGG}。\n- 脯氨酸 (P): {CCT, CCC, CCA, CCG}。\n- 天冬氨酸 (D): {GAT, GAC}。\n\n宿主特异性密码子可用性权重 $f_{c,h}$ 如下：\n- 大肠杆菌 (E. coli): AAA: $0.7$, AAG: $0.3$; GGT: $0.35$, GGC: $0.4$, GGA: $0.1$, GGG: $0.15$; CCT: $0.3$, CCC: $0.18$, CCA: $0.22$, CCG: $0.3$; GAT: $0.65$, GAC: $0.35$。\n- 酿酒酵母 (S. cerevisiae): AAA: $0.3$, AAG: $0.7$; GGT: $0.4$, GGC: $0.2$, GGA: $0.25$, GGG: $0.15$; CCT: $0.2$, CCC: $0.15$, CCA: $0.5$, CCG: $0.15$; GAT: $0.45$, GAC: $0.55$。\n\n需要实现和评估的测试套件：\n- 测试用例1（混合密码子）：编码序列，密码子顺序为 AAA, GGA, GGT, GGC, GGG, CCG, CCA, CCC, CCT, GAT, GAC, AAG；即连接的DNA字符串 \"AAAGGAGGTGGCCCGCCACCCCCTGATGACAAG\"。\n- 测试用例2（单密码子重复）：使用 AAA 连续重复 $10$ 次的赖氨酸编码序列；即，由 \"AAA\" 不带分隔符重复 $10$ 次组成的长度为 $30$ 个碱基的连接DNA字符串。\n- 测试用例3（每种氨基酸的大肠杆菌优化密码子）：编码序列，密码子顺序为 AAA, GGC, CCG, GAT, AAA, GGC, CCG, GAT；即连接的DNA字符串 \"AAAGGCCCGGATAAAGGCCCGGAT\"。\n\n对于每个测试用例，您的程序必须：\n- 将DNA序列解析为密码子 $\\{c_1,\\dots,c_L\\}$。\n- 对于每个宿主 $h \\in \\{\\mathrm{Ec}, \\mathrm{Sc}\\}$，计算上面定义的 $E_h$，并识别出序列中 $\\frac{1}{f_{c_i,h}}$ 达到最大值的瓶颈位置（作为基于1的索引）。\n- 计算跨宿主比率 $R = E_{\\mathrm{Ec}}/E_{\\mathrm{Sc}}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每个测试用例的结果本身是一个形式为 $[E_{\\mathrm{Ec}}, E_{\\mathrm{Sc}}, R, \\mathrm{bneck}_{\\mathrm{Ec}}, \\mathrm{bneck}_{\\mathrm{Sc}}]$ 的列表，所有 $E$ 和 $R$ 值都四舍五入到6位小数，并且每个瓶颈列表 $\\mathrm{bneck}_{\\mathrm{Ec}}$ 和 $\\mathrm{bneck}_{\\mathrm{Sc}}$ 都是一个按升序排列的整数列表。例如，一个有效的输出结构看起来像 \"[[...], [...], [...]]\"。", "solution": "问题陈述提出了一个形式化的动力学模型，用于评估给定编码DNA序列在两种不同宿主生物体——*大肠杆菌*和*酿酒酵母*中的翻译效率。在尝试任何解决方案之前，需要对问题进行验证。\n\n**步骤1：提取给定信息**\n- **单密码子解码时间模型：** 对于宿主 $h$ 和密码子 $c$，解码时间为 $t_{c,h} = 1/(k_h f_{c,h})$，其中 $k_h > 0$ 是宿主特异性比例常数，$f_{c,h} > 0$ 是该密码子在该宿主中的相对可用性权重。\n- **总延伸时间：** 对于一个包含 $L$ 个密码子 $\\{c_1, \\dots, c_L\\}$ 的序列，总时间为 $T_h = \\sum_{i=1}^{L} t_{c_i,h}$。\n- **归一化相对翻译效率：**\n$$E_h = \\frac{T_{h,\\mathrm{opt}}}{T_h} = \\frac{\\sum_{i=1}^{L} \\frac{1}{f_{a_i,h}^{\\max}}}{\\sum_{i=1}^{L} \\frac{1}{f_{c_i,h}}}$$\n此处，$a_i$ 是位置 $i$ 的氨基酸，$f_{a_i,h}^{\\max}$ 是宿主 $h$ 中氨基酸 $a_i$ 所有同义密码子中的最大可用性权重。\n- **翻译瓶颈：** 对宿主 $h$ 而言，序列中解码时间 $t_{c_i,h}$（或等效地，值 $1/f_{c_i,h}$）达到最大的那组基于1的密码子位置 $i$。\n- **跨宿主比率：** $R = E_{\\mathrm{Ec}}/E_{\\mathrm{Sc}}$。\n- **氨基酸到密码子映射：**\n  - 赖氨酸 (K): {AAA, AAG}\n  - 甘氨酸 (G): {GGT, GGC, GGA, GGG}\n  - 脯氨酸 (P): {CCT, CCC, CCA, CCG}\n  - 天冬氨酸 (D): {GAT, GAC}\n- **宿主特异性密码子可用性权重 ($f_{c,h}$):**\n  - **大肠杆菌 (Ec):** AAA: $0.7$, AAG: $0.3$; GGT: $0.35$, GGC: $0.4$, GGA: $0.1$, GGG: $0.15$; CCT: $0.3$, CCC: $0.18$, CCA: $0.22$, CCG: $0.3$; GAT: $0.65$, GAC: $0.35$。\n  - **酿酒酵母 (Sc):** AAA: $0.3$, AAG: $0.7$; GGT: $0.4$, GGC: $0.2$, GGA: $0.25$, GGG: $0.15$; CCT: $0.2$, CCC: $0.15$, CCA: $0.5$, CCG: $0.15$; GAT: $0.45$, GAC: $0.55$。\n- **测试用例（DNA序列）：**\n  1. \"AAAGGAGGTGGCCCGCCACCCCCTGATGACAAG\"\n  2. \"AAA\" 重复 $10$ 次。\n  3. \"AAAGGCCCGGATAAAGGCCCGGAT\"\n- **输出规格：** 对每个测试用例，计算元组 $(E_{\\mathrm{Ec}}, E_{\\mathrm{Sc}})$、比率 $R$ 以及每个宿主的瓶颈位置列表。浮点数值必须四舍五入到6位小数。\n\n**步骤2：使用提取的给定信息进行验证**\n对问题进行验证。\n- **科学依据：** 该模型是一个简化但标准且科学上公认的翻译动力学表示，其中翻译速度与tRNA丰度相关，此处由密码子可用性权重代理。该模型基于分子生物学原理。\n- **良构性：** 问题是良构的。所有必要的数据（序列、权重、映射）和定义（$E_h$ 和瓶颈的公式）都已明确提供。目标清晰，可以通过算法确定唯一解。\n- **客观性：** 问题陈述使用精确、客观的语言编写，没有主观性论断。\n- **完整性与一致性：** 提供的数据充分且自洽。测试序列中的密码子集合是提供了权重的密码子集合的子集。\n- **真实性与可行性：** 给定的权重是合理的数值。该模型虽然是抽象的，但就其相对比较的目的而言，在物理上并非不可能，在科学上亦非不合理。\n- **结构完整性：** 定义明确无歧义。逻辑非循环。\n\n**步骤3：结论与行动**\n问题被判定为 **有效**。它具有科学依据、良构性，并提供了求解所需的所有要素。将据此制定一个完整、合理的解决方案。\n\n**基于原则的解决方案设计**\n\n任务是实现所提供的量化模型。问题的核心在于正确应用归一化相对翻译效率 $E_h$ 的公式，并识别翻译瓶颈。\n\n首先，必须将必要的生物学信息编码到适当的数据结构中。这包括：\n1. 从每个密码子到其对应氨基酸的映射。\n2. 每个宿主 $h \\in \\{\\mathrm{Ec}, \\mathrm{Sc}\\}$ 中每个密码子 $c$ 的宿主特异性可用性权重 $f_{c,h}$。\n\n效率 $E_h$ 的公式是两个和的比率。分母 $\\sum_{i=1}^{L} \\frac{1}{f_{c_i,h}}$ 代表序列中实际存在的密码子 $c_i$ 的可用性权重倒数之和。该项与总延伸时间 $T_h$ 成正比。分子 $\\sum_{i=1}^{L} \\frac{1}{f_{a_i,h}^{\\max}}$ 代表一个理想化最优序列的可用性权重倒数之和，其中对于翻译出的蛋白质中的每个氨基酸 $a_i$，都使用了宿主 $h$ 中最丰富（解码最快）的同义密码子。该项与可能的最小延伸时间 $T_{h,\\mathrm{opt}}$ 成正比。\n\n对于给定的DNA序列，计算过程如下：\n\n1.  **序列解析：** 通过连续提取不重叠的三个核苷酸三联体，将输入的DNA字符串解析成一个包含 $L$ 个密码子的列表 $\\{c_1, c_2, \\dots, c_L\\}$。\n\n2.  **预计算最优权重：** 对于每个宿主 $h$ 和每个相关氨基酸 $a$，我们必须预先计算最大可用性权重 $f_{a,h}^{\\max}$。这通过遍历 $a$ 的所有同义密码子并找到它们在宿主 $h$ 中的 $f_{c,h}$ 值的最大值来完成。\n\n3.  **分宿主计算：** 对每个宿主 $h=\\mathrm{Ec}$ 和 $h=\\mathrm{Sc}$ 执行以下步骤。\n    a.  **为 $E_h$ 求和**：\n        - 初始化两个累加器：`sum_inv_f_actual` 用于分母，`sum_inv_f_optimal` 用于分子。\n        - 初始化一个列表来存储每个密码子的时间度量，即 $\\{1/f_{c_1,h}, 1/f_{c_2,h}, \\dots, 1/f_{c_L,h}\\}$。\n        - 从 $i=1$ 迭代到 $L$：\n            i.   识别密码子 $c_i$ 及其对应的氨基酸 $a_i$。\n            ii.  检索实际权重 $f_{c_i,h}$ 和预计算的最优权重 $f_{a_i,h}^{\\max}$。\n            iii. 将 $1/f_{c_i,h}$ 加到 `sum_inv_f_actual` 中，并存储它以供瓶颈分析使用。\n            iv.  将 $1/f_{a_i,h}^{\\max}$ 加到 `sum_inv_f_optimal` 中。\n    b.  **效率计算**：计算 $E_h = \\text{sum\\_inv\\_f\\_optimal} / \\text{sum\\_inv\\_f\\_actual}$。\n    c.  **瓶颈识别**：在存储的单密码子时间度量列表 $\\{1/f_{c_i,h}\\}$ 中找到最大值。识别出所有出现此最大值的基于1的索引 $i$。这些索引构成了宿主 $h$ 的瓶颈列表。\n\n4.  **跨宿主比率**：计算出 $E_{\\mathrm{Ec}}$ 和 $E_{\\mathrm{Sc}}$ 后，计算比率 $R = E_{\\mathrm{Ec}} / E_{\\mathrm{Sc}}$。\n\n5.  **格式化**：将每个测试用例的结果——$E_{\\mathrm{Ec}}$、$E_{\\mathrm{Sc}}$、$R$ 和两个瓶颈列表——收集起来，并根据输出规范进行格式化，浮点数四舍五入到6位小数。对所有提供的测试用例重复此过程。最终输出是表示这些结果列表的单个字符串。\n\n这个结构化的、分步的过程确保了问题的所有组成部分都得到准确和系统地处理，将生物学模型转化为一个确定性算法。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes translation efficiency and bottlenecks for DNA sequences in E. coli and S. cerevisiae.\n    \"\"\"\n\n    # --- Data Definition ---\n    # Codon to Amino Acid mapping\n    codon_to_aa = {\n        'AAA': 'K', 'AAG': 'K',  # Lysine\n        'GGT': 'G', 'GGC': 'G', 'GGA': 'G', 'GGG': 'G',  # Glycine\n        'CCT': 'P', 'CCC': 'P', 'CCA': 'P', 'CCG': 'P',  # Proline\n        'GAT': 'D', 'GAC': 'D',  # Aspartic Acid\n    }\n\n    # Amino Acid to Synonymous Codons mapping\n    aa_to_codons = {\n        'K': ['AAA', 'AAG'],\n        'G': ['GGT', 'GGC', 'GGA', 'GGG'],\n        'P': ['CCT', 'CCC', 'CCA', 'CCG'],\n        'D': ['GAT', 'GAC'],\n    }\n\n    # Host-specific codon availability weights (f_c,h)\n    f_weights = {\n        'Ec': {\n            'AAA': 0.7, 'AAG': 0.3,\n            'GGT': 0.35, 'GGC': 0.4, 'GGA': 0.1, 'GGG': 0.15,\n            'CCT': 0.3, 'CCC': 0.18, 'CCA': 0.22, 'CCG': 0.3,\n            'GAT': 0.65, 'GAC': 0.35,\n        },\n        'Sc': {\n            'AAA': 0.3, 'AAG': 0.7,\n            'GGT': 0.4, 'GGC': 0.2, 'GGA': 0.25, 'GGG': 0.15,\n            'CCT': 0.2, 'CCC': 0.15, 'CCA': 0.5, 'CCG': 0.15,\n            'GAT': 0.45, 'GAC': 0.55,\n        }\n    }\n\n    # Test cases\n    test_cases = [\n        \"AAAGGAGGTGGCCCGCCACCCCCTGATGACAAG\",\n        \"AAA\" * 10,\n        \"AAAGGCCCGGATAAAGGCCCGGAT\",\n    ]\n\n    # --- Pre-computation ---\n    # Pre-compute maximum availability weights (f_a,h^max) for each amino acid in each host\n    f_max_weights = {'Ec': {}, 'Sc': {}}\n    for host in ['Ec', 'Sc']:\n        for aa, codons in aa_to_codons.items():\n            max_f = max(f_weights[host][c] for c in codons)\n            f_max_weights[host][aa] = max_f\n\n    # --- Main Logic ---\n    all_results = []\n    for dna_sequence in test_cases:\n        # 1. Parse DNA sequence into codons\n        codons = [dna_sequence[i:i+3] for i in range(0, len(dna_sequence), 3)]\n        \n        e_values = {}\n        bottleneck_values = {}\n\n        for host in ['Ec', 'Sc']:\n            sum_inv_f_actual = 0.0\n            sum_inv_f_optimal = 0.0\n            inv_f_values_per_pos = []\n\n            # 2. Calculate sums and collect inverse frequencies\n            for codon in codons:\n                aa = codon_to_aa[codon]\n                \n                f_actual = f_weights[host][codon]\n                f_optimal = f_max_weights[host][aa]\n\n                inv_f_actual = 1.0 / f_actual\n                inv_f_optimal = 1.0 / f_optimal\n\n                sum_inv_f_actual += inv_f_actual\n                sum_inv_f_optimal += inv_f_optimal\n                inv_f_values_per_pos.append(inv_f_actual)\n\n            # 3. Compute efficiency E_h\n            if sum_inv_f_actual == 0:\n                 # This case should not happen with valid positive frequencies\n                 e_h = 0.0\n            else:\n                 e_h = sum_inv_f_optimal / sum_inv_f_actual\n            e_values[host] = e_h\n            \n            # 4. Identify bottleneck positions\n            if not inv_f_values_per_pos:\n                bottlenecks = []\n            else:\n                max_inv_f = max(inv_f_values_per_pos)\n                # Use a tolerance for float comparison to be robust\n                bottlenecks = [\n                    i + 1 for i, val in enumerate(inv_f_values_per_pos)\n                    if np.isclose(val, max_inv_f)\n                ]\n            bottleneck_values[host] = bottlenecks\n\n        # 5. Compute cross-host ratio R\n        e_ec = e_values['Ec']\n        e_sc = e_values['Sc']\n        \n        if e_sc == 0:\n            # Handle division by zero case\n            ratio_r = 0.0\n        else:\n            ratio_r = e_ec / e_sc\n\n        # 6. Format results for the current test case\n        case_result = [\n            round(e_ec, 6),\n            round(e_sc, 6),\n            round(ratio_r, 6),\n            bottleneck_values['Ec'],\n            bottleneck_values['Sc']\n        ]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list in Python produces the required format `[...]`.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2732911"}, {"introduction": "除了蛋白质的产出量，其表达的稳定性对于构建稳健的生物回路也至关重要。本练习探讨了基因表达噪声的概念，这是使用多拷贝质粒与稳定的单拷贝基因组整合策略之间的关键区别。通过应用基本的概率论法则，你将量化质粒拷贝数变异如何导致总表达噪声，这是在选择大肠杆菌或酵母中的表达策略时必须考虑的重要因素 [@problem_id:2732815]。", "problem": "在一项比较不同底盘生物中基因表达噪音的研究中，一个工程报告基因在 大肠杆菌 (E. coli) 中通过中拷贝质粒表达，或在 酿酒酵母 (S. cerevisiae) 中通过单拷贝基因组整合表达。提供了以下经过实验测量和标准化的量：\n\n1. 报告基因的单拷贝表达统计数据，在不同宿主中于相同的启动子、非翻译区和密码子优化背景下测得：在一个固定的细胞年龄匹配的采样窗口内，每个基因拷贝的蛋白质产量是一个随机变量，其均值为 $\\alpha = 50$ 分子/拷贝，方差为 $\\sigma^{2} = 2500$ 分子$^{2}$/拷贝。假设在给定细胞状态下，这些单拷贝的贡献在不同拷贝间是独立同分布的，并且与拷贝数无关。\n\n2. 拷贝数统计数据：\n   - 对于 E. coli 质粒构建体，每个细胞的质粒拷贝数是一个随机变量，其均值为 $\\mathbb{E}[N_{\\mathrm{pl}}] = 20$，方差为 $\\mathrm{Var}(N_{\\mathrm{pl}}) = 60$，这反映了细胞间在质粒分离和复制上的差异。\n   - 对于 S. cerevisiae 整合构建体，每个细胞的拷贝数是确定性的单拷贝，$N_{\\mathrm{int}} \\equiv 1$，因此 $\\mathbb{E}[N_{\\mathrm{int}}] = 1$ 且 $\\mathrm{Var}(N_{\\mathrm{int}}) = 0$。\n\n定义细胞总蛋白产量为 $X = \\sum_{i=1}^{N} Y_{i}$，其中 $N$ 是相应系统中的拷贝数，$Y_{i}$ 是独立的单拷贝产量，其均值为 $\\alpha$，方差为 $\\sigma^{2}$。仅使用基本概率法则（期望的线性性质和全方差公式）以及预期产量与拷贝数成线性比例的基因剂量原理，计算每个系统中总表达量 $X$ 的期望均值和方差。\n\n最后，定义 Fano 因子为 $\\mathrm{Fano}(X) = \\mathrm{Var}(X) / \\mathbb{E}[X]$。计算质粒构建体的 Fano 因子与整合构建体的 Fano 因子之比。仅报告此比值，作为一个无量纲的数字。无需四舍五入。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 单拷贝平均表达量：$\\alpha = 50$。\n- 单拷贝表达量方差：$\\sigma^{2} = 2500$。\n- 单拷贝产量 $Y_{i}$ 是独立同分布 (i.i.d.) 的随机变量。\n- 细胞总蛋白产量：$X = \\sum_{i=1}^{N} Y_{i}$。\n- *E. coli* 质粒系统：\n    - 拷贝数是随机变量 $N_{\\mathrm{pl}}$。\n    - 平均拷贝数：$\\mathbb{E}[N_{\\mathrm{pl}}] = 20$。\n    - 拷贝数方差：$\\mathrm{Var}(N_{\\mathrm{pl}}) = 60$。\n- *S. cerevisiae* 整合系统：\n    - 拷贝数是确定性常数 $N_{\\mathrm{int}} = 1$。\n    - 平均拷贝数：$\\mathbb{E}[N_{\\mathrm{int}}] = 1$。\n    - 拷贝数方差：$\\mathrm{Var}(N_{\\mathrm{int}}) = 0$。\n- Fano 因子的定义：$\\mathrm{Fano}(X) = \\mathrm{Var}(X) / \\mathbb{E}[X]$。\n- 要求计算：质粒构建体的 Fano 因子与整合构建体的 Fano 因子之比。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了定量生物学中成熟的基因表达噪音模型。将总表达量建模为独立同分布随机变量之和，而和的项数本身也是一个随机变量，这是一种标准的复合随机变量表述。该问题提法明确，为获得唯一解提供了所有必要的参数和定义。其陈述客观且正式。它没有违反任何无效标准。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n总蛋白产量 $X$ 是一个复合随机变量，定义为 $X = \\sum_{i=1}^{N} Y_{i}$，其中 $N$ 是随机的基因拷贝数，$Y_{i}$ 是代表第 $i$ 个基因拷贝的蛋白质表达量的独立同分布随机变量，其均值为 $\\mathbb{E}[Y_{i}] = \\alpha$，方差为 $\\mathrm{Var}(Y_{i}) = \\sigma^{2}$。我们将首先推导 $X$ 的均值和方差的一般表达式。\n\n为了求 $X$ 的期望值，我们应用全期望公式（或称塔形性质）：\n$$ \\mathbb{E}[X] = \\mathbb{E}[\\mathbb{E}[X|N]] $$\n首先，我们计算内部的条件期望 $\\mathbb{E}[X|N]$。给定一个固定的拷贝数 $N=n$，条件期望为：\n$$ \\mathbb{E}[X|N=n] = \\mathbb{E}\\left[\\sum_{i=1}^{n} Y_{i}\\right] = \\sum_{i=1}^{n} \\mathbb{E}[Y_{i}] = n\\alpha $$\n因此，作为随机变量 $N$ 的函数，条件期望为 $\\mathbb{E}[X|N] = N\\alpha$。\n将此代回全期望公式：\n$$ \\mathbb{E}[X] = \\mathbb{E}[N\\alpha] = \\alpha \\mathbb{E}[N] $$\n\n为了求 $X$ 的方差，我们应用全方差公式：\n$$ \\mathrm{Var}(X) = \\mathbb{E}[\\mathrm{Var}(X|N)] + \\mathrm{Var}(\\mathbb{E}[X|N]) $$\n我们必须计算右侧的两项。\n对于第一项，我们需要条件方差 $\\mathrm{Var}(X|N)$。给定一个固定的拷贝数 $N=n$，并且由于 $Y_i$ 是独立的：\n$$ \\mathrm{Var}(X|N=n) = \\mathrm{Var}\\left(\\sum_{i=1}^{n} Y_{i}\\right) = \\sum_{i=1}^{n} \\mathrm{Var}(Y_{i}) = n\\sigma^{2} $$\n作为随机变量 $N$ 的函数，此为 $\\mathrm{Var}(X|N) = N\\sigma^{2}$。该量的期望为：\n$$ \\mathbb{E}[\\mathrm{Var}(X|N)] = \\mathbb{E}[N\\sigma^{2}] = \\sigma^{2} \\mathbb{E}[N] $$\n对于第二项，我们使用前面推导出的条件期望表达式 $\\mathbb{E}[X|N] = N\\alpha$：\n$$ \\mathrm{Var}(\\mathbb{E}[X|N]) = \\mathrm{Var}(N\\alpha) = \\alpha^{2} \\mathrm{Var}(N) $$\n结合这两项， $X$ 的总方差为：\n$$ \\mathrm{Var}(X) = \\sigma^{2} \\mathbb{E}[N] + \\alpha^{2} \\mathrm{Var}(N) $$\n\n现在，我们将这些通用公式应用于两个指定的生物系统。\n\n**系统1：*E. coli* 质粒构建体 ($X_{\\mathrm{pl}}$)**\n给定参数为 $\\mathbb{E}[N_{\\mathrm{pl}}] = 20$，$\\mathrm{Var}(N_{\\mathrm{pl}}) = 60$，$\\alpha = 50$ 和 $\\sigma^{2} = 2500$。\n总表达量的均值为：\n$$ \\mathbb{E}[X_{\\mathrm{pl}}] = \\alpha \\mathbb{E}[N_{\\mathrm{pl}}] = (50)(20) = 1000 $$\n总表达量的方差为：\n$$ \\mathrm{Var}(X_{\\mathrm{pl}}) = \\sigma^{2} \\mathbb{E}[N_{\\mathrm{pl}}] + \\alpha^{2} \\mathrm{Var}(N_{\\mathrm{pl}}) = (2500)(20) + (50)^{2}(60) $$\n$$ \\mathrm{Var}(X_{\\mathrm{pl}}) = 50000 + (2500)(60) = 50000 + 150000 = 200000 $$\n质粒系统的 Fano 因子为：\n$$ \\mathrm{Fano}(X_{\\mathrm{pl}}) = \\frac{\\mathrm{Var}(X_{\\mathrm{pl}})}{\\mathbb{E}[X_{\\mathrm{pl}}]} = \\frac{200000}{1000} = 200 $$\n\n**系统2：*S. cerevisiae* 整合构建体 ($X_{\\mathrm{int}}$)**\n给定参数为 $\\mathbb{E}[N_{\\mathrm{int}}] = 1$，$\\mathrm{Var}(N_{\\mathrm{int}}) = 0$，$\\alpha = 50$ 和 $\\sigma^{2} = 2500$。\n总表达量的均值为：\n$$ \\mathbb{E}[X_{\\mathrm{int}}] = \\alpha \\mathbb{E}[N_{\\mathrm{int}}] = (50)(1) = 50 $$\n总表达量的方差为：\n$$ \\mathrm{Var}(X_{\\mathrm{int}}) = \\sigma^{2} \\mathbb{E}[N_{\\mathrm{int}}] + \\alpha^{2} \\mathrm{Var}(N_{\\mathrm{int}}) = (2500)(1) + (50)^{2}(0) $$\n$$ \\mathrm{Var}(X_{\\mathrm{int}}) = 2500 + 0 = 2500 $$\n整合系统的 Fano 因子为：\n$$ \\mathrm{Fano}(X_{\\mathrm{int}}) = \\frac{\\mathrm{Var}(X_{\\mathrm{int}})}{\\mathbb{E}[X_{\\mathrm{int}}]} = \\frac{2500}{50} = 50 $$\n\n最后，我们计算所要求的 Fano 因子之比。\n$$ \\text{Ratio} = \\frac{\\mathrm{Fano}(X_{\\mathrm{pl}})}{\\mathrm{Fano}(X_{\\mathrm{int}})} = \\frac{200}{50} = 4 $$\n与稳定、单拷贝的基因组整合相比，该比率量化了因使用具有拷贝数波动的多拷贝质粒而引起的相对表达噪音（以 Fano 因子衡量）的增加程度。", "answer": "$$\\boxed{4}$$", "id": "2732815"}, {"introduction": "改造微生物以生产有价值的化学品通常涉及引入整个代谢途径。为了优化产量，理解哪一步限制了整体产出至关重要。本练习应用米氏动力学来模拟一个多酶途径，使你能够基于酶动力学参数和在不同宿主（大肠杆菌与酿酒酵母）中的表达水平，计算最大理论通量并识别限速步骤 [@problem_id:2732893]。", "problem": "一条异源、线性、不可逆的$3$步反应途径 $S \\xrightarrow{E_{1}} I_{1} \\xrightarrow{E_{2}} I_{2} \\xrightarrow{E_{3}} P$ 被植入到 Escherichia coli 和 Saccharomyces cerevisiae 这两种底盘生物中。每个步骤由一种不同的单体酶 $E_{i}$ 催化，其转换数 $k_{\\text{cat},i}$ 和米氏常数 $K_{m,i}$ 是酶的内在属性，在两种底盘生物中均相同。宿主特异性的表达水平不同，以酶拷贝数（每个细胞的分子数）给出。假设：\n- 在所研究的时间尺度上，所有步骤均可视为有效不可逆，且不存在分支或旁路反应。\n- 除非另有说明，蛋白质表达产生的是有活性的、正确折叠的酶。\n- 在两种底盘生物中，通过上游设计，每个步骤的细胞内底物浓度均维持在 $[S_{i}] = 10\\,K_{m,i}$。\n- 细胞间的差异可忽略不计；考虑一个代表性细胞。\n\n酶动力学参数（在两种底盘生物中相同）：\n- 步骤 $1$：$k_{\\text{cat},1} = 50\\,\\text{s}^{-1}$，$K_{m,1} = 50\\,\\mu\\text{M}$。\n- 步骤 $2$：$k_{\\text{cat},2} = 25\\,\\text{s}^{-1}$，$K_{m,2} = 20\\,\\mu\\text{M}$。\n- 步骤 $3$：$k_{\\text{cat},3} = 100\\,\\text{s}^{-1}$，$K_{m,3} = 10\\,\\mu\\text{M}$。\n\n宿主特异性的活性酶拷贝数（每个细胞的分子数）：\n- Escherichia coli：$n_{1}^{(\\text{Ec})} = 5.0 \\times 10^{3}$，$n_{2}^{(\\text{Ec})} = 8.0 \\times 10^{3}$，$n_{3}^{(\\text{Ec})} = 2.0 \\times 10^{3}$。\n- Saccharomyces cerevisiae：$n_{1}^{(\\text{Sc})} = 1.5 \\times 10^{4}$，$n_{2}^{(\\text{Sc})} = 3.0 \\times 10^{3}$，$n_{3}^{(\\text{Sc})} = 5.0 \\times 10^{3}$。由于在 Saccharomyces cerevisiae 中存在部分错误折叠，只有一部分比例 $f_{2}^{(\\text{Sc})} = 0.80$ 的 $E_{2}$ 酶具有活性；所有其他酶均完全有活性。\n\n从基础的 Michaelis–Menten 催化作用描述和基本的分子计数（阿伏伽德罗常数）出发，且不使用任何未经证实的简化方法，根据第一性原理计算在给定条件下每种底盘生物的稳态下单细胞途径通量，并确定每种底盘生物中的限速步骤。然后，将 Escherichia coli 中预测的稳态单细胞通量与 Saccharomyces cerevisiae 中的通量之比作为最终答案报告，表示为单个无单位的精确分数。不要四舍五入；提供精确值。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n**步骤 1：提取的已知条件**\n- 途径：一条异源、线性、不可逆的$3$步反应途径 $S \\xrightarrow{E_{1}} I_{1} \\xrightarrow{E_{2}} I_{2} \\xrightarrow{E_{3}} P$。\n- 底盘生物：*Escherichia coli* 和 *Saccharomyces cerevisiae*。\n- 酶的性质：$E_{i}$ 是不同的单体酶。$k_{\\text{cat},i}$ 和 $K_{m,i}$ 是内在属性，在不同底盘生物中相同。\n- 底物条件：对于每个步骤 $i$，底物浓度维持在 $[S_{i}] = 10\\,K_{m,i}$。\n- 假设：无副反应，除非特别说明，否则蛋白质表达和折叠完美，细胞间差异可忽略不计。\n- 动力学参数（在两种底盘生物中相同）：\n    - 步骤 $1$：$k_{\\text{cat},1} = 50\\,\\text{s}^{-1}$，$K_{m,1} = 50\\,\\mu\\text{M}$。\n    - 步骤 $2$：$k_{\\text{cat},2} = 25\\,\\text{s}^{-1}$，$K_{m,2} = 20\\,\\mu\\text{M}$。\n    - 步骤 $3$：$k_{\\text{cat},3} = 100\\,\\text{s}^{-1}$，$K_{m,3} = 10\\,\\mu\\text{M}$。\n- 宿主特异性酶拷贝数（每个细胞的分子数）：\n    - *E. coli*：$n_{1}^{(\\text{Ec})} = 5.0 \\times 10^{3}$，$n_{2}^{(\\text{Ec})} = 8.0 \\times 10^{3}$，$n_{3}^{(\\text{Ec})} = 2.0 \\times 10^{3}$。\n    - *S. cerevisiae*：$n_{1}^{(\\text{Sc})} = 1.5 \\times 10^{4}$，$n_{2}^{(\\text{Sc})} = 3.0 \\times 10^{3}$，$n_{3}^{(\\text{Sc})} = 5.0 \\times 10^{3}$。\n- 酶活性分数：在 *S. cerevisiae* 中，只有一部分比例 $f_{2}^{(\\text{Sc})} = 0.80$ 的酶 $E_{2}$ 具有活性。所有其他酶均完全有活性（$f=1$）。\n\n**步骤 2：验证**\n该问题具有科学依据，基于标准的 Michaelis-Menten 动力学和合成生物学的概念。该问题提法恰当，为获得唯一解提供了所有必要参数。语言客观且精确。每个步骤 $[S_i] = 10\\,K_{m,i}$ 的条件是一个强理想化。在一个简单的非调控线性途径中，中间产物的浓度会自行调整以使各步骤的通量相等。然而，问题明确指出这是一个通过“上游设计”实现的维持条件。在合成生物学的背景下，这种调控是可以想象的，这是一个有效的简化约束，它通过将分析重点放在计算和比较每个步骤的最大潜在通量上，使问题变得易于处理。因此，该问题被认为是有效的。\n\n**步骤 3：解答**\n解答将按要求从第一性原理推导得出。\n\n酶促反应 $i$ 的速率，记为体积通量 $v_i$（单位为摩尔浓度每时间），由 Michaelis-Menten 方程描述：\n$$v_i = \\frac{k_{\\text{cat},i} [E_T]_i [S_i]}{K_{m,i} + [S_i]}$$\n其中 $[E_T]_i$ 是活性酶 $i$ 的总浓度，$[S_i]$ 是其底物的浓度。\n\n问题指明，对于每个步骤，$[S_i] = 10\\,K_{m,i}$。将此条件代入方程，得到在这些饱和条件下的特定体积通量：\n$$v_i = \\frac{k_{\\text{cat},i} [E_T]_i (10\\,K_{m,i})}{K_{m,i} + 10\\,K_{m,i}} = \\frac{10\\,k_{\\text{cat},i} [E_T]_i K_{m,i}}{11\\,K_{m,i}} = \\frac{10}{11} k_{\\text{cat},i} [E_T]_i$$\n该体积通量的单位是摩尔每升每秒。问题要求的是单细胞通量 $J_i$，单位是分子数每细胞每秒。为了进行转换，我们必须将体积通量乘以细胞体积 $V_{\\text{cell}}$ 和阿伏伽德罗常数 $N_A$：\n$$J_i = v_i \\cdot V_{\\text{cell}} \\cdot N_A$$\n酶浓度 $[E_T]_i$ 与每个细胞的活性酶分子数 $n_{i, \\text{active}}$ 之间的关系为：\n$$[E_T]_i = \\frac{n_{i, \\text{active}}}{N_A \\cdot V_{\\text{cell}}}$$\n将 $v_i$ 和 $[E_T]_i$ 的表达式代入 $J_i$ 的方程中：\n$$J_i = \\left(\\frac{10}{11} k_{\\text{cat},i} \\frac{n_{i, \\text{active}}}{N_A \\cdot V_{\\text{cell}}}\\right) \\cdot V_{\\text{cell}} \\cdot N_A$$\n细胞体积 $V_{\\text{cell}}$ 和阿伏伽德罗常数 $N_A$ 的项相消，从而得出步骤 $i$ 的单细胞通量的直接关系式：\n$$J_i = \\frac{10}{11} k_{\\text{cat},i} n_{i, \\text{active}}$$\n这表示在给定的底物饱和条件下每个步骤的催化能力。对于一个线性不可逆途径，总稳态通量 $J_{\\text{pathway}}$ 由催化能力最低的步骤决定，该步骤被称为限速步骤或瓶颈。\n$$J_{\\text{pathway}} = \\min(J_1, J_2, J_3)$$\n\n我们现在计算每种底盘生物中各步骤的催化能力。\n\n**对 *Escherichia coli* 的分析**\n在这种底盘生物中，所有酶都完全有活性，因此 $n_{i, \\text{active}}^{(\\text{Ec})} = n_i^{(\\text{Ec})}$。\n各步骤的催化能力为：\n$J_{1}^{(\\text{Ec})} = \\frac{10}{11} k_{\\text{cat},1} n_{1}^{(\\text{Ec})} = \\frac{10}{11} (50) (5.0 \\times 10^{3}) = \\frac{10}{11} (250 \\times 10^{3}) = \\frac{2500 \\times 10^{3}}{11}$ 分子 细胞$^{-1}$ s$^{-1}$。\n$J_{2}^{(\\text{Ec})} = \\frac{10}{11} k_{\\text{cat},2} n_{2}^{(\\text{Ec})} = \\frac{10}{11} (25) (8.0 \\times 10^{3}) = \\frac{10}{11} (200 \\times 10^{3}) = \\frac{2000 \\times 10^{3}}{11}$ 分子 细胞$^{-1}$ s$^{-1}$。\n$J_{3}^{(\\text{Ec})} = \\frac{10}{11} k_{\\text{cat},3} n_{3}^{(\\text{Ec})} = \\frac{10}{11} (100) (2.0 \\times 10^{3}) = \\frac{10}{11} (200 \\times 10^{3}) = \\frac{2000 \\times 10^{3}}{11}$ 分子 细胞$^{-1}$ s$^{-1}$。\n\n比较这些值，最小能力是 $\\frac{2000 \\times 10^{3}}{11}$。\n因此，在 *E. coli* 中的稳态途径通量为：\n$$J^{(\\text{Ec})} = \\min(J_{1}^{(\\text{Ec})}, J_{2}^{(\\text{Ec})}, J_{3}^{(\\text{Ec})}) = \\frac{2000 \\times 10^{3}}{11} \\text{ 分子 细胞}^{-1} \\text{ s}^{-1}$$\n限速步骤是步骤 2 和步骤 3，它们具有相同且最小的能力，因此是共同限制步骤。\n\n**对 *Saccharomyces cerevisiae* 的分析**\n在这种底盘生物中，酶 $E_2$ 只有部分活性。活性 $E_2$ 分子数为：\n$n_{2, \\text{active}}^{(\\text{Sc})} = n_{2}^{(\\text{Sc})} \\cdot f_{2}^{(\\text{Sc})} = (3.0 \\times 10^{3}) \\cdot (0.80) = 2.4 \\times 10^{3}$。\n酶 $E_1$ 和 $E_3$ 完全有活性：$n_{1, \\text{active}}^{(\\text{Sc})} = n_{1}^{(\\text{Sc})} = 1.5 \\times 10^{4}$ 且 $n_{3, \\text{active}}^{(\\text{Sc})} = n_{3}^{(\\text{Sc})} = 5.0 \\times 10^{3}$。\n\n各步骤的催化能力为：\n$J_{1}^{(\\text{Sc})} = \\frac{10}{11} k_{\\text{cat},1} n_{1, \\text{active}}^{(\\text{Sc})} = \\frac{10}{11} (50) (1.5 \\times 10^{4}) = \\frac{10}{11} (75 \\times 10^{4}) = \\frac{7500 \\times 10^{3}}{11}$ 分子 细胞$^{-1}$ s$^{-1}$。\n$J_{2}^{(\\text{Sc})} = \\frac{10}{11} k_{\\text{cat},2} n_{2, \\text{active}}^{(\\text{Sc})} = \\frac{10}{11} (25) (2.4 \\times 10^{3}) = \\frac{10}{11} (60 \\times 10^{3}) = \\frac{600 \\times 10^{3}}{11}$ 分子 细胞$^{-1}$ s$^{-1}$。\n$J_{3}^{(\\text{Sc})} = \\frac{10}{11} k_{\\text{cat},3} n_{3, \\text{active}}^{(\\text{Sc})} = \\frac{10}{11} (100) (5.0 \\times 10^{3}) = \\frac{10}{11} (500 \\times 10^{3}) = \\frac{5000 \\times 10^{3}}{11}$ 分子 细胞$^{-1}$ s$^{-1}$。\n\n比较这些值，最小能力是 $\\frac{600 \\times 10^{3}}{11}$。\n因此，在 *S. cerevisiae* 中的稳态途径通量为：\n$$J^{(\\text{Sc})} = \\min(J_{1}^{(\\text{Sc})}, J_{2}^{(\\text{Sc})}, J_{3}^{(\\text{Sc})}) = \\frac{600 \\times 10^{3}}{11} \\text{ 分子 细胞}^{-1} \\text{ s}^{-1}$$\n限速步骤是步骤 2。\n\n**最终计算**\n问题要求计算 *E. coli* 中与 *S. cerevisiae* 中的稳态单细胞通量之比。\n$$ \\text{比率} = \\frac{J^{(\\text{Ec})}}{J^{(\\text{Sc})}} = \\frac{\\frac{2000 \\times 10^{3}}{11}}{\\frac{600 \\times 10^{3}}{11}} $$\n公共因子 $\\frac{10^3}{11}$ 相消：\n$$ \\text{比率} = \\frac{2000}{600} = \\frac{20}{6} = \\frac{10}{3} $$\n这就是以精确分数表示的最终答案。", "answer": "$$\\boxed{\\frac{10}{3}}$$", "id": "2732893"}]}