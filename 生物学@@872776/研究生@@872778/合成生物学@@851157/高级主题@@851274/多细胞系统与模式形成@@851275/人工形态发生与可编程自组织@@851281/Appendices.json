{"hands_on_practices": [{"introduction": "本章将通过一系列动手实践，加深您对人工形态发生和可编程自组织核心原理的理解。这些练习将引导您从模拟单个遗传元件的响应，到分析合成组织中的集体图案形成和动态记忆效应。我们的第一个练习将空间图案的抽象概念根植于分子相互作用的具体物理学中。通过对转录因子响应形态发生素梯度并与DNA结合的过程进行建模，我们将能够定量地预测组织中基因开启的空间位置。这项实践 [@problem_id:2714675] 对于理解如何通过调节遗传线路的动力学参数来编程清晰的发育边界至关重要。", "problem": "一种形态发生素在为可编程自组织而设计的合成组织中控制一个基因，该基因的启动子具有 $n$ 个相同的结合位点，用于结合由形态发生素激活的转录因子。该组织被近似为一个一维空间，坐标为 $x \\ge 0$，形态发生素浓度形成一个固定的梯度 $c(x) = c_0 \\exp(-x/\\lambda)$，其中 $c_0  0$ 和 $\\lambda  0$ 是常数。只有当所有 $n$ 个位点都被结合时，启动子才被认为是活跃的。结合平衡遵循质量作用定律，每个位点具有一个共同的解离常数 $K_d$。\n\n任务：\n\n- 使用质量作用定律和解离常数 $K_d$ 的定义，推导启动子的活性分数 $f(c)$ 作为浓度 $c$ 的函数。该推导基于一个机制性结合模型，其中所有 $n$ 个相同的位点独立结合，并且激活需要所有 $n$ 个位点都被占据。\n\n- 在形态发生素响应曲线的背景下定义希尔动力学，并清楚地区分机制性结合模型与唯象的希尔拟合。然后，通过在半最大响应点处对数优势比相对于输入对数的斜率来定义有效希尔系数 $n_{\\mathrm{H,eff}}$：$n_{\\mathrm{H,eff}} \\equiv \\left.\\dfrac{\\mathrm{d}}{\\mathrm{d}\\ln c} \\ln\\!\\big(\\dfrac{f}{1-f}\\big)\\right|_{f=1/2}$，并对你推导的机制性模型进行求值。\n\n- 计算机制性模型在半最大输入时的绝对灵敏度 $S_{1/2} \\equiv \\left.\\dfrac{\\mathrm{d}f}{\\mathrm{d}c}\\right|_{f=1/2}$。\n\n- 在固定的形态发生素梯度 $c(x) = c_0 \\exp(-x/\\lambda)$下，确定机制性模型达到半最大激活时的空间位置 $x_{1/2}$，并以米为单位表示 $x_{1/2}$。假设 $c_0$ 和 $\\lambda$ 的值使得组织内存在一个半最大激活位置。\n\n- 最后，给出一个关于 $x_{1/2}$ 作为 $n$、$K_d$、$c_0$ 和 $\\lambda$ 函数的单一、精确、闭合形式的解析表达式。这将是唯一评分的答案。不要进行四舍五入。\n\n最终的空间位置以米为单位表示。最终答案必须是单一的解析表达式。", "solution": "所提出的问题是定量生物学中一个定义明确的练习，它要求应用统计力学和化学动力学的基本原理来模拟基因调控。该问题在科学上是合理的，内部是一致的，并且需要一个严谨的、逐步的推导。因此，我将开始进行解答。\n\n首先，我们推导启动子的活性分数 $f(c)$ 作为形态发生素浓度 $c$ 的函数。启动子有 $n$ 个相同且独立的转录因子结合位点，我们假设转录因子的浓度与形态发生素浓度成正比，从而有效地让 $c$ 代表活性转录因子的浓度。转录因子与单个位点的结合是一个可逆反应，遵循质量作用定律，解离常数为 $K_d$。对于单个位点，其平衡为 $S + T \\rightleftharpoons ST$，其中 $S$ 是游离结合位点，$T$ 是转录因子。\n\n解离常数定义为 $K_d = \\frac{[S][T]}{[ST]}$。令转录因子浓度 $[T]$ 用 $c$ 表示。那么，$K_d = \\frac{[S]c}{[ST]}$。单个位点被占据的概率，我们称之为 $p_{\\text{bound}}$，是被占据位点的浓度与总位点浓度的比值：\n$$ p_{\\text{bound}} = \\frac{[ST]}{[S] + [ST]} $$\n通过重新整理 $K_d$ 的表达式，我们得到 $[S] = \\frac{K_d [ST]}{c}$。将此代入 $p_{\\text{bound}}$ 的表达式中：\n$$ p_{\\text{bound}} = \\frac{[ST]}{\\frac{K_d [ST]}{c} + [ST]} = \\frac{1}{\\frac{K_d}{c} + 1} = \\frac{c}{K_d + c} $$\n由于 $n$ 个位点是相同且独立结合的，所有 $n$ 个位点同时被占据的概率是它们各自概率的乘积。根据定义，启动子仅在此状态下是活跃的。因此，活性启动子的分数 $f(c)$ 为：\n$$ f(c) = (p_{\\text{bound}})^n = \\left(\\frac{c}{c + K_d}\\right)^n $$\n这就是启动子活性分数的机制性模型。\n\n接下来，我们将其与唯象的希尔拟合进行区分。希尔方程是一个协同结合函数，通常写作 $f_{\\text{Hill}}(c) = \\frac{c^{n_H}}{K^n_H + c^{n_H}}$。其中，$n_H$ 是希尔系数，一个量化响应陡峭度或“超敏性”的参数，而 $K$ 是达到半最大激活时的浓度。一个关键的区别是，希尔方程是一个唯象模型，这意味着它的构建是为了拟合实验数据，其参数（$n_H$，$K$）不一定对应于特定的物理机制。参数 $n_H$ 通常不是整数，也不一定等于结合位点的数量。相比之下，我们推导出的函数 $f(c)$ 是一个机制性模型，其中参数 $n$ 是一个物理量：结合位点的精确整数数量。\n\n我们被要求计算我们机制性模型的有效希尔系数 $n_{\\mathrm{H,eff}}$，它在半最大响应点（$f=1/2$）处定义为 $n_{\\mathrm{H,eff}} \\equiv \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\ln c} \\ln\\left(\\frac{f}{1-f}\\right)\\right|_{f=1/2}$。我们使用恒等式 $\\frac{d}{d\\ln c} = c \\frac{d}{dc}$。运算对象是激活的对数优势比。\n让我们首先计算对数优势比的导数：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}\\ln c} \\ln\\left(\\frac{f}{1-f}\\right) = \\frac{\\mathrm{d}}{\\mathrm{d}\\ln c} (\\ln f - \\ln(1-f)) = \\frac{1}{f}\\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c} - \\frac{1}{1-f}\\left(-\\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c}\\right) = \\frac{1}{f(1-f)}\\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c} $$\n现在我们求 $\\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c}$：\n$$ \\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c} = c \\frac{\\mathrm{d}f}{\\mathrm{d}c} = c \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}c}\\left[\\left(\\frac{c}{c+K_d}\\right)^n\\right] = c \\cdot n\\left(\\frac{c}{c+K_d}\\right)^{n-1} \\left[ \\frac{(1)(c+K_d) - c(1)}{(c+K_d)^2} \\right] $$\n$$ \\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c} = c \\cdot n \\frac{c^{n-1}}{(c+K_d)^{n-1}} \\frac{K_d}{(c+K_d)^2} = \\frac{n c^n K_d}{(c+K_d)^{n+1}} = n \\left(\\frac{c}{c+K_d}\\right)^n \\left(\\frac{K_d}{c+K_d}\\right) = n f \\left(\\frac{K_d}{c+K_d}\\right) $$\n将此代回 $n_{\\mathrm{H,eff}}$ 的表达式中：\n$$ n_{\\mathrm{H,eff}} = \\frac{1}{f(1-f)} \\left[ n f \\left(\\frac{K_d}{c+K_d}\\right) \\right] = \\frac{n}{1-f} \\left(\\frac{K_d}{c+K_d}\\right) $$\n我们在 $f(c) = 1/2$ 处对此进行求值。此时，$\\left(\\frac{c}{c+K_d}\\right)^n = 1/2$，这意味着 $\\frac{c}{c+K_d} = (\\frac{1}{2})^{1/n} = 2^{-1/n}$。然后，$\\frac{K_d}{c+K_d} = 1 - \\frac{c}{c+K_d} = 1 - 2^{-1/n}$。代入这些条件可得：\n$$ n_{\\mathrm{H,eff}} = \\frac{n}{1-1/2} (1 - 2^{-1/n}) = 2n(1-2^{-1/n}) $$\n\n在半最大输入时的绝对灵敏度 $S_{1/2}$ 定义为 $S_{1/2} \\equiv \\left.\\frac{\\mathrm{d}f}{\\mathrm{d}c}\\right|_{f=1/2}$。\n根据前面的计算，$\\frac{\\mathrm{d}f}{\\mathrm{d}c} = \\frac{1}{c} \\frac{\\mathrm{d}f}{\\mathrm{d}\\ln c} = \\frac{n f}{c} (\\frac{K_d}{c+K_d})$。在 $f=1/2$ 时，我们有 $c=c_{1/2}$，所以 $S_{1/2} = \\frac{n(1/2)}{c_{1/2}} (\\frac{K_d}{c_{1/2}+K_d})$。\n从 $f(c_{1/2})=1/2$，我们求出浓度 $c_{1/2}$：\n$$ \\left(\\frac{c_{1/2}}{c_{1/2}+K_d}\\right)^n = \\frac{1}{2} \\implies \\frac{c_{1/2}}{c_{1/2}+K_d} = 2^{-1/n} \\implies c_{1/2} = (c_{1/2}+K_d)2^{-1/n} $$\n$$ c_{1/2}(1-2^{-1/n}) = K_d 2^{-1/n} \\implies c_{1/2} = K_d \\frac{2^{-1/n}}{1-2^{-1/n}} = \\frac{K_d}{2^{1/n}-1} $$\n将此浓度和关系式 $\\frac{K_d}{c_{1/2}+K_d} = 1-2^{-1/n}$ 代入 $S_{1/2}$ 的表达式中：\n$$ S_{1/2} = \\frac{n/2}{K_d/(2^{1/n}-1)} (1-2^{-1/n}) = \\frac{n(2^{1/n}-1)}{2K_d} (1-2^{-1/n}) $$\n\n最后，我们确定激活达到半最大时的空间位置 $x_{1/2}$。形态发生素浓度由空间梯度 $c(x) = c_0 \\exp(-x/\\lambda)$ 给出。我们必须找到位置 $x_{1/2}$，使得 $c(x_{1/2}) = c_{1/2}$。\n代入我们推导出的 $c_{1/2}$ 的表达式：\n$$ c_0 \\exp(-x_{1/2}/\\lambda) = \\frac{K_d}{2^{1/n}-1} $$\n现在我们求解 $x_{1/2}$。取两边的自然对数：\n$$ \\ln(c_0) - \\frac{x_{1/2}}{\\lambda} = \\ln\\left(\\frac{K_d}{2^{1/n}-1}\\right) $$\n$$ \\frac{x_{1/2}}{\\lambda} = \\ln(c_0) - \\ln\\left(\\frac{K_d}{2^{1/n}-1}\\right) = \\ln\\left(\\frac{c_0(2^{1/n}-1)}{K_d}\\right) $$\n乘以 $\\lambda$ 得到半最大激活位置的最终表达式：\n$$ x_{1/2} = \\lambda \\ln\\left(\\frac{c_0(2^{1/n}-1)}{K_d}\\right) $$\n这样一个位置 $x_{1/2} \\geq 0$ 的存在要求对数的参数大于或等于 $1$，即 $c_0(2^{1/n}-1) \\ge K_d$。题干中假设了这样一个位置的存在，从而保证了此条件。该表达式在量纲上是正确的，因为对数的参数是无量纲的（假设 $c_0$ 和 $K_d$ 具有相同的浓度单位），而 $\\lambda$ 具有长度单位。", "answer": "$$\\boxed{\\lambda \\ln\\left(\\frac{c_0(2^{1/n}-1)}{K_d}\\right)}$$", "id": "2714675"}, {"introduction": "真实的生物组织是由离散的细胞构成，而非一个连续的介质。这项实践 [@problem_id:2714744] 旨在弥合经典的连续反应扩散模型与生物组织细胞现实之间的鸿沟。通过分析离散细胞晶格上的图案形成系统，我们将揭示细胞大小等基本物理约束如何限制我们能合成设计的图案的分辨率与类型，这对于设计能稳定产生特定结构的合成组织至关重要。", "problem": "考虑一个一维组织，建模为一个由 $N$ 个相同细胞组成的环，细胞中心间距 $a$ 等于一个细胞直径。每个细胞都含有一个激活剂 $u$ 和一个抑制剂 $v$，它们进行局部反应和最近邻的扩散交换。其底层的连续介质描述是双物种反应扩散偏微分方程（PDE）系统\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix}u\\\\ v\\end{pmatrix}\n=\n\\begin{pmatrix}f(u,v)\\\\ g(u,v)\\end{pmatrix}\n+\n\\begin{pmatrix}D_u  0\\\\ 0  D_v\\end{pmatrix}\n\\frac{\\partial^2}{\\partial x^2}\\begin{pmatrix}u\\\\ v\\end{pmatrix},\n$$\n其中 $f$ 和 $g$ 是平滑的动力学函数，$D_u$ 和 $D_v$ 是扩散系数，且组织具有周期性边界条件。假设存在一个空间均匀的稳态 $(u^{\\ast},v^{\\ast})$，并且在没有扩散的情况下，该稳态对均匀扰动是线性稳定的。在 $(u^{\\ast},v^{\\ast})$ 处，反应动力学的雅可比矩阵为\n$$\nJ \\equiv \\begin{pmatrix}f_u  f_v\\\\ g_u  g_v\\end{pmatrix} = \\begin{pmatrix}1  2\\\\ -3  -4\\end{pmatrix},\n$$\n其中 $D_u = 1$，$D_v = 16$。这些是无量纲单位，其中时间由特征反应速率的倒数进行缩放，长度由细胞间距 $a$ 进行缩放。\n\n任务：\n- 从最近邻之间扩散交换的菲克定律出发，并围绕 $(u^{\\ast},v^{\\ast})$ 进行线性化，推导细胞索引 $j \\in \\{0,1,\\ldots,N-1\\}$ 处小扰动 $\\delta u_j(t)$ 和 $\\delta v_j(t)$ 的晶格（基于细胞的）线性化动力学，并证明空间傅里叶模式 $\\exp(i q j a)$ 可以通过离散拉普拉斯算子特征值 $-\\hat{k}^2(q)$ 将动力学对角化，其中\n$$\n\\hat{k}^2(q) = \\frac{4}{a^2}\\sin^2\\!\\left(\\frac{q a}{2}\\right).\n$$\n- 将离散色散关系（增长率作为 $q$ 的函数）与通过将 $q$ 替换为连续波数 $k$ 并将拉普拉斯算子特征值替换为 $-k^2$ 得到的连续色散关系进行比较。对于给定的 $J$、$D_u$ 和 $D_v$，确定不稳定的连续波数带（即那些产生正实部增长率的波数）。\n- 一个程序化设计目标是在离散环上实现 $\\lambda_{\\mathrm{target}} = 12$ 个细胞直径的条纹间距（连续最大值之间的距离）。利用环上允许的离散波数为 $q_m = \\frac{2\\pi m}{N a}$（其中 $m$ 为整数），且对应的条纹间距为 $\\lambda_m = \\frac{2\\pi}{q_m} = \\frac{N a}{m}$ 这一事实，计算以细胞直径为单位的最小区域尺寸（即，当 $a$ 等于一个细胞直径时，最小的整数 $N$），使得：\n  1. 一个允许的离散模式的条纹间距恰好为 $\\lambda_{\\mathrm{target}}$。\n  2. 该模式位于通过使用 $\\hat{k}^2(q_m)$ 评估离散色散关系所得到的离散不稳定带内。\n将您的最终结果表示为一个等于细胞直径数量的整数（不需要物理单位）。", "solution": "该问题经检验具有科学依据、提法明确且自成体系。所提供的数据一致且足以得出一个完整的解。我们开始进行分析。\n\n该问题分为三个部分。我们将按顺序逐一解决。\n\n首先，我们推导基于晶格的线性化动力学。我们从一个由 $N$ 个细胞组成的环开始，细胞索引为 $j \\in \\{0, 1, \\ldots, N-1\\}$。细胞 $j$ 中物种 $u$ 和 $v$ 的浓度表示为 $u_j(t)$ 和 $v_j(t)$。每个细胞的动力学包括局部反应以及与其两个最近邻 $j-1$ 和 $j+1$（索引对 $N$ 取模）的扩散交换。\n\n相邻细胞间物种的扩散通量由菲克第一定律决定，该定律指出通量与浓度梯度成正比。对于一个细胞间距为 $a$ 的离散系统，物种 $u$ 进入细胞 $j$ 的净扩散流入量是来自其邻居的通量之和：\n$$\nJ_{u, \\text{net}} = \\kappa_u (u_{j+1} - u_j) + \\kappa_u (u_{j-1} - u_j) = \\kappa_u (u_{j+1} - 2u_j + u_{j-1})\n$$\n其中 $\\kappa_u$ 是一个耦合常数。这个表达式是作用于 $u_j$ 的离散拉普拉斯算子。为了将 $\\kappa_u$ 与连续扩散系数 $D_u$ 联系起来，我们考虑 $a \\to 0$ 的极限。$u(x \\pm a)$ 在 $x$ 附近的泰勒级数展开为：\n$$\nu(x+a) - 2u(x) + u(x-a) \\approx a^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n为了使离散模型收敛到给定的偏微分方程，我们需要 $\\kappa_u a^2 (\\partial^2 u / \\partial x^2) = D_u (\\partial^2 u / \\partial x^2)$，这意味着 $\\kappa_u = D_u/a^2$。\n\n因此，晶格上的完整非线性动力学方程为：\n$$\n\\frac{d u_j}{d t} = f(u_j, v_j) + \\frac{D_u}{a^2} (u_{j+1} - 2u_j + u_{j-1})\n$$\n$$\n\\frac{d v_j}{d t} = g(u_j, v_j) + \\frac{D_v}{a^2} (v_{j+1} - 2v_j + v_{j-1})\n$$\n我们在空间均匀稳态 $(u^{\\ast}, v^{\\ast})$ 附近将这些方程线性化。设 $u_j(t) = u^{\\ast} + \\delta u_j(t)$ 和 $v_j(t) = v^{\\ast} + \\delta v_j(t)$，其中 $\\delta u_j$ 和 $\\delta v_j$ 是小扰动。由于 $f(u^{\\ast}, v^{\\ast}) = 0$ 且 $g(u^{\\ast}, v^{\\ast}) = 0$，扰动的线性化系统为：\n$$\n\\frac{d}{dt}\\begin{pmatrix}\\delta u_j\\\\ \\delta v_j\\end{pmatrix} = \\begin{pmatrix}f_u  f_v\\\\ g_u  g_v\\end{pmatrix} \\begin{pmatrix}\\delta u_j\\\\ \\delta v_j\\end{pmatrix} + \\begin{pmatrix}D_u/a^2  0\\\\ 0  D_v/a^2\\end{pmatrix} \\left( \\begin{pmatrix}\\delta u_{j+1}\\\\ \\delta v_{j+1}\\end{pmatrix} - 2\\begin{pmatrix}\\delta u_j\\\\ \\delta v_j\\end{pmatrix} + \\begin{pmatrix}\\delta u_{j-1}\\\\ \\delta v_{j-1}\\end{pmatrix} \\right)\n$$\n空间域的离散性表明可以寻找空间傅里叶模式形式的解。我们假设解的形式为 $\\boldsymbol{\\delta}_j(t) = \\begin{pmatrix}\\delta u_j(t) \\\\ \\delta v_j(t)\\end{pmatrix} = \\tilde{\\boldsymbol{\\delta}}_q \\exp(i q j a) \\exp(\\sigma t)$，其中 $\\tilde{\\boldsymbol{\\delta}}_q$ 是模式振幅，$\\sigma$ 是增长率。将此假设代入线性化系统，时间导数项变为 $\\sigma \\boldsymbol{\\delta}_j$。反应项为 $J \\boldsymbol{\\delta}_j$。作用于空间模式 $\\exp(i q j a)$ 的离散扩散算子得到：\n$$\n\\exp(i q (j+1) a) - 2\\exp(i q j a) + \\exp(i q (j-1) a) = \\exp(i q j a) (\\exp(i q a) - 2 + \\exp(-i q a))\n$$\n$$\n= \\exp(i q j a) (2\\cos(qa) - 2) = -2(1-\\cos(qa))\\exp(i q j a)\n$$\n使用三角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，上式变为：\n$$\n-4\\sin^2\\left(\\frac{qa}{2}\\right)\\exp(i q j a)\n$$\n关于模式振幅的方程组变为：\n$$\n\\sigma \\tilde{\\boldsymbol{\\delta}}_q = J \\tilde{\\boldsymbol{\\delta}}_q - \\frac{4}{a^2}\\sin^2\\left(\\frac{qa}{2}\\right) \\begin{pmatrix}D_u  0\\\\ 0  D_v\\end{pmatrix} \\tilde{\\boldsymbol{\\delta}}_q\n$$\n这是一个关于增长率 $\\sigma$ 的特征值问题。该表达式乘以扩散矩阵，这证实了空间傅里叶模式将动力学对角化。离散拉普拉斯算子的特征值为 $-\\frac{4}{a^2}\\sin^2(\\frac{qa}{2})$。按照要求，我们将其等同于 $-\\hat{k}^2(q)$，从而证明 $\\hat{k}^2(q) = \\frac{4}{a^2}\\sin^2(\\frac{qa}{2})$。\n\n其次，我们确定不稳定的连续波数带。在连续极限下（$a \\to 0$, $qa \\ll 1$），我们有 $\\sin(\\frac{qa}{2}) \\approx \\frac{qa}{2}$，所以 $\\hat{k}^2(q) \\approx \\frac{4}{a^2} (\\frac{qa}{2})^2 = q^2$。问题指示我们在进行连续分析时，用 $k^2$ 替换 $\\hat{k}^2(q)$，用 $k$ 替换 $q$。增长率 $\\sigma(k)$ 是矩阵的特征值：\n$$\nM_c(k) = J - k^2 D = \\begin{pmatrix}f_u - k^2 D_u  f_v\\\\ g_u  g_v - k^2 D_v\\end{pmatrix}\n$$\n图灵不稳定性要求均匀稳态在没有扩散（$k=0$）时是稳定的，但对于某个 $k > 0$ 的范围是不稳定的。$k=0$ 时的稳定性要求 $\\mathrm{Tr}(J)  0$ 和 $\\mathrm{Det}(J) > 0$。使用给定的雅可比矩阵 $J = \\begin{pmatrix}1  2\\\\ -3  -4\\end{pmatrix}$，我们发现 $\\mathrm{Tr}(J) = 1-4 = -3  0$ 且 $\\mathrm{Det}(J) = (1)(-4)-(2)(-3) = -4+6=2>0$。无扩散时的稳定性条件得到满足。\n对于 $k>0$，如果 $M_c(k)$ 的任一特征值具有正实部，则会出现不稳定性。特征值满足 $\\lambda^2 - \\mathrm{Tr}(M_c(k))\\lambda + \\mathrm{Det}(M_c(k)) = 0$。\n迹为 $\\mathrm{Tr}(M_c(k)) = \\mathrm{Tr}(J) - k^2(D_u+D_v) = -3 - k^2(1+16) = -3 - 17k^2$。由于 $k^2 \\ge 0$，$\\mathrm{Tr}(M_c(k))$ 总是负的。如果迹（特征值之和）为负，则至少有一个特征值必须有负实部。为了使一个特征值具有正实部，两个特征值必须是实数且符号相反。这当且仅当它们的乘积，即行列式，为负时发生。因此，不稳定的条件是 $\\mathrm{Det}(M_c(k))  0$。\n行列式为：\n$$\n\\mathrm{Det}(M_c(k)) = (f_u - k^2 D_u)(g_v - k^2 D_v) - f_v g_u = D_u D_v (k^2)^2 - (f_u D_v + g_v D_u) k^2 + \\mathrm{Det}(J)\n$$\n代入给定值 $f_u=1, g_v=-4, \\mathrm{Det}(J)=2, D_u=1, D_v=16$：\n$$\nf_u D_v + g_v D_u = (1)(16) + (-4)(1) = 12\n$$\n$$\nD_u D_v = (1)(16) = 16\n$$\n行列式变为一个关于 $k^2$ 的二次函数：\n$$\n\\mathrm{Det}(M_c(k)) = 16(k^2)^2 - 12k^2 + 2\n$$\n我们寻找 $k^2$ 的范围，使得 $16(k^2)^2 - 12k^2 + 2  0$。首先，我们求 $8(k^2)^2 - 6k^2 + 1 = 0$ 的根。对 $y=k^2$ 使用二次公式：\n$$\ny = \\frac{6 \\pm \\sqrt{(-6)^2 - 4(8)(1)}}{2(8)} = \\frac{6 \\pm \\sqrt{36 - 32}}{16} = \\frac{6 \\pm 2}{16}\n$$\n根为 $k^2 = \\frac{4}{16} = \\frac{1}{4}$ 和 $k^2 = \\frac{8}{16} = \\frac{1}{2}$。由于这个关于 $k^2$ 的二次函数是一个开口向上的抛物线，所以在两根之间表达式为负。不稳定的条件是：\n$$\n\\frac{1}{4}  k^2  \\frac{1}{2}\n$$\n因此，不稳定的连续波数带为 $\\frac{1}{2}  k  \\frac{1}{\\sqrt{2}}$。\n\n第三，我们求以细胞直径为单位的最小区域尺寸 $N$。给定 $a=1$。区域尺寸为 $L = Na = N$。\n条件1：一个允许的离散模式必须具有 $\\lambda_{\\mathrm{target}} = 12$ 的条纹间距（波长）。环上允许的波数为 $q_m = \\frac{2\\pi m}{Na}$，相应的波长为 $\\lambda_m = \\frac{2\\pi}{q_m} = \\frac{Na}{m}$。当 $a=1$ 且 $\\lambda_m=12$ 时，得到 $12 = \\frac{N}{m}$，即 $N = 12m$，其中 $m$ 是某个正整数。我们寻求最小的整数 $N$，所以我们必须找到最小的有效 $m \\geq 1$。\n\n条件2：对应于 $\\lambda=12$ 的模式在离散系统中必须是不稳定的。离散系统的不稳定条件与连续情况类似，只需将 $k^2$ 替换为 $\\hat{k}^2(q)$：\n$$\n\\frac{1}{4}  \\hat{k}^2(q_m)  \\frac{1}{2}\n$$\n波长为 $\\lambda_m = 12$ 的模式其波数为 $q_m = \\frac{2\\pi}{\\lambda_m} = \\frac{2\\pi}{12} = \\frac{\\pi}{6}$。注意这个波数与 $N$ 或 $m$ 无关，因为它仅由目标波长确定。我们必须在这个特定的波数下计算 $\\hat{k}^2(q)$。当 $a=1$ 时：\n$$\n\\hat{k}^2(\\pi/6) = 4\\sin^2\\left(\\frac{(\\pi/6) \\cdot 1}{2}\\right) = 4\\sin^2\\left(\\frac{\\pi}{12}\\right)\n$$\n我们使用半角恒等式 $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$：\n$$\n\\hat{k}^2(\\pi/6) = 4 \\left( \\frac{1 - \\cos(\\pi/6)}{2} \\right) = 2(1 - \\frac{\\sqrt{3}}{2}) = 2 - \\sqrt{3}\n$$\n现在我们必须检查这个值是否在不稳定区间 $(\\frac{1}{4}, \\frac{1}{2})$ 内：\n$$\n\\frac{1}{4}  2 - \\sqrt{3}  \\frac{1}{2}\n$$\n我们验证每个不等式：\n$2 - \\sqrt{3} > \\frac{1}{4}$ 是否成立？这等价于 $1.75 > \\sqrt{3}$，或 $(\\frac{7}{4})^2 > 3$，即 $\\frac{49}{16} > 3$，或 $49 > 48$。这是成立的。\n$2 - \\sqrt{3}  \\frac{1}{2}$ 是否成立？这等价于 $1.5  \\sqrt{3}$，或 $(\\frac{3}{2})^2  3$，即 $\\frac{9}{4}  3$，或 $9  12$。这也是成立的。\n由于 $2 - \\sqrt{3}$ 在不稳定范围内，任何尺寸为 $N = 12m$ 的离散系统都将支持一个目标波长为 $12$ 的不稳定模式。问题要求最小的整数 $N$。这对应于 $m$ 可能的最小正整数值，即 $m=1$。\n对于 $m=1$，最小区域尺寸为 $N = 12 \\times 1 = 12$ 个细胞直径。", "answer": "$$\\boxed{12}$$", "id": "2714744"}, {"introduction": "形态发生是一个动态过程，其中信号的历史记录可能与其当前水平同等重要。最后的这项计算练习通过滞后现象来探索空间记忆的概念 [@problem_id:2714700]。通过模拟一个暴露在移动的形态发生素梯度下的双稳态基因开关，您将发现组织如何能够“记录”其发育历史，从而形成稳定且不可逆的复杂图案。", "problem": "您正在为一个一维组织建模，其中每个细胞都实现了一个单基因正反馈回路，该回路可以在空间变化的形态发生素分布上表现出双稳态。形态发生素浓度表示为一个输入场，该场在空间上近似线性，并以恒定速度平移。目标是在此背景下形式化定义空间滞后现象，并通过在固定位置模拟基因表达动力学的潜在常微分方程，同时输入信号进行正向扫描然后反向扫描，来计算不同参数集下其滞后环路的空间范围。本问题中的所有变量均为无量纲。\n\n将基因表达水平定义为标量变量 $y(t)$，其遵循以下常微分方程\n$$\n\\frac{dy}{dt} \\;=\\; \\alpha \\, H\\big(s(t);K_s,n\\big) \\;+\\; \\beta \\, H\\big(y(t);K_y,m\\big) \\;-\\; \\delta \\, y(t),\n$$\n其中 $H(u;K,h)$ 表示希尔函数，其形式为\n$$\nH(u;K,h) \\;=\\; \\frac{u^{h}}{K^{h} + u^{h}}.\n$$\n输入 $s(t)$ 是一个固定细胞在平移的线性分布经过时所经历的形态发生素水平。空间分布为\n$$\ns(x,t) \\;=\\; s_{\\min} \\;+\\; g \\,\\big(x - v t\\big),\n$$\n其中空间斜率为 $g$，平移速度为 $v$。在任何固定位置 $x$，输入随时间线性变化，变化率为\n$$\n\\frac{ds}{dt} \\;=\\; -\\,g\\,v.\n$$\n\n任务A. 定义空间系统中的滞后现象，并将其与历史依赖的命运边界联系起来。您的定义必须涉及在输入信号的正向与反向扫描过程中，$y$ 的阈值被跨越时的空间位置差异。\n\n任务B. 从以下基本原理出发：基因调控源于分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质），协同结合产生 $h>1$ 的S型希尔响应，以及稳态的稳定性取决于常微分方程右侧雅可比矩阵的符号。请推导在该系统由移动梯度驱动时出现空间滞后现象的必要条件。您的推导必须从稳态条件开始\n$$\n0 \\;=\\; \\alpha \\, H\\big(s;K_s,n\\big) \\;+\\; \\beta \\, H\\big(y;K_y,m\\big) \\;-\\; \\delta \\, y,\n$$\n并应用线性稳定性论证于 $\\partial f/\\partial y$，以确定在何种情况下，对于一定范围的 $s$ 值，存在由一个不稳定稳态分隔的两个稳定稳态。然后，通过比较基因表达弛豫时间 $\\tau = 1/\\delta$ 和输入扫描时间 $\\tau_{\\text{sweep}} = \\Delta s / |ds/dt|$（其中 $\\Delta s$ 是静态双穩态窗口）这两个时间尺度，来论证有限扫描速率效应。提供空间滞后现象出现并随扫描速率增加而增大的条件。\n\n任务C. 实现一个程序来计算滞后环路的空间范围，定义为\n$$\n\\Delta x \\;=\\; \\frac{s_{\\text{up,eff}} \\;-\\; s_{\\text{down,eff}}}{|g|},\n$$\n其中 $s_{\\text{up,eff}}$ 是在 $s(t)$ 向上扫描期间 $y(t)$ 从下方穿越预设命运阈值 $y_{\\text{th}}$ 时的输入值，$s_{\\text{down,eff}}$ 是在向下扫描期間 $y(t)$ 从上方穿越 $y_{\\text{th}}$ 时的输入值。所有情况下均使用 $y_{\\text{th}} = K_y$。为评估 $s_{\\text{up,eff}}$ 和 $s_{\\text{down,eff}}$，需在随时间线性变化的输入 $s(t)$ 下模拟单个固定位置细胞的常微分方程，其中向上扫描（$r>0$）的速率为 $\\frac{ds}{dt} = r$，向下扫描的速率为 $\\frac{ds}{dt} = -r$，且 $r = |g\\,v|$。向上扫描从 $s_{\\min}$ 开始，到 $s_{\\max}$ 结束；然后从 $s_{\\max}$ 反向扫描回 $s_{\\min}$。如果在任一方向的扫描边界内没有发生穿越，则定义 $\\Delta x = 0$。\n\n您的程序必须：\n- 使用数值稳定方法，在与指定扫描相对应的时间间隔内对常微分方程进行积分。\n- 通过子时间步插值检测阈值穿越，以估算 $s_{\\text{up,eff}}$ 和 $s_{\\text{down,eff}}$。\n- 计算并为每个提供的测试用例返回 $\\Delta x$。\n- 将每个报告的 $\\Delta x$ 四舍五入到6位小数。\n\n使用以下测试套件，它涵盖了一般情况、准静态扫描、快速扫描和单稳态对照。每个测试用例是一个元组 $(\\alpha,\\beta,\\delta,K_s,n,K_y,m,s_{\\min},s_{\\max},g,v)$：\n- 情况1（双稳态，中等速率扫描）：$(0.2,\\,2.5,\\,1.0,\\,0.5,\\,2,\\,0.5,\\,4,\\,0,\\,3,\\,1.0,\\,0.02)$。\n- 情况2（双稳态，准静态扫描）：$(0.2,\\,2.5,\\,1.0,\\,0.5,\\,2,\\,0.5,\\,4,\\,0,\\,3,\\,1.0,\\,0.001)$。\n- 情况3（双稳态，快速扫描）：$(0.2,\\,2.5,\\,1.0,\\,0.5,\\,2,\\,0.5,\\,4,\\,0,\\,3,\\,1.0,\\,0.5)$。\n- 情况4（单稳态对照）：$(0.2,\\,0.5,\\,1.0,\\,0.5,\\,2,\\,0.5,\\,4,\\,0,\\,3,\\,1.0,\\,0.02)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_i$ 是为情况 $i$ 计算出的 $\\Delta x$，并四舍五入到6位小数。\n- 所有量都是无量纲的；不需要物理单位。", "solution": "该问题要求在一个由移动的形态发生素梯度驱动的一维双稳态遗传回路模型中分析空间滞后现象。这涉及一个三部分任务：概念性定义、必要条件的理论推导，以及对几个参数集的滞后环宽度的数值计算。该问题在科学上是合理的、良定的，并包含其求解所需的所有必要信息。\n\n**任务A：空间滞后现象的定义**\n\n从广义上讲，滞后现象指的是系统的输出状态不仅取决于当前输入，还取决于输入历史的一种行为。在这个空间系统的背景下，一维细胞组织暴露于一个在空间中平移的形态发生素浓度分布 $s(x,t)$。对于一个固定位置 $x$ 处的细胞，其输入的形态发生素浓度 $s$ 会随时间变化。\n\n当系统表现出双稳态时，就会出现空间滞后现象。这意味着对于一定范围的输入浓度 $s$，基因表达水平 $y$ 可以存在于两个不同的稳定状态：“低”状态和“高”状态。这些状态之间的转换不会在相同的输入值下发生。\n\n具体来说，随着形态发生素前沿的推进（例如，对于固定细胞，$s$ 增加），一个最初处于低状态的细胞只有在 $s$ 越过一个高阈值 $s_{\\text{up}}$ 时才会切换到高状态。相反，随着形态发生素前沿的后退（$s$ 减少），一个已经处于高状态的细胞只有在 $s$ 越过一个较低的阈值 $s_{\\text{down}}$ 时才会切换回低状态。\n\n这种历史依赖的切换定义了两个不同的空间命运边界。让我们考虑平移分布 $s(x,t) = s_{\\min} + g(x - vt)$。位于位置 $x_{\\text{up}}$ 的细胞将在某个时间 $t$ 看到输入越过向上阈值 $s_{\\text{up}}$。位于不同位置 $x_{\\text{down}}$ 的细胞将看到输入越过向下阈值 $s_{\\text{down}}$。$x_{\\text{down}}$ 和 $x_{\\text{up}}$ 之间的空间区域是滞后区域。在这个区域中，细胞可以处于高状态或低状态，这取决于形态发生素前沿是否先前已经以增加的方向越过它，达到了高于 $s_{\\text{up}}$ 的水平。这种滞后现象的空间范围是距离 $\\Delta x = |x_{\\text{up}} - x_{\\text{down}}|$。由于细胞所见的输入是其位置的函数，我们可以将输入阈值直接与空间位置相关联：$s_{\\text{up}}$ 对应于位置 $x_{\\text{up}}$，$s_{\\text{down}}$ 对应于 $x_{\\text{down}}$。滞后环路的空间范围则由有效切换浓度的差异除以梯度陡峭度给出，即 $\\Delta x = |s_{\\text{up}} - s_{\\text{down}}| / |g|$。\n\n**任务B：空间滞后现象的必要条件**\n\n基因表达水平 $y$ 的动力学由以下常微分方程（ODE）控制：\n$$\n\\frac{dy}{dt} = f(y,s) = \\alpha \\, H\\big(s;K_s,n\\big) \\;+\\; \\beta \\, H\\big(y;K_y,m\\big) \\;-\\; \\delta \\, y(t)\n$$\n空间滞后现象要求系统在输入信号 $s$ 的一定范围内是双稳态的。双稳态意味着对于单个 $s$ 值存在两个稳定稳态。稳态 $y^*$ 是通过将时间导数设为零来找到的：\n$$\nf(y^*, s) = 0 \\quad \\implies \\quad \\delta y^* = \\alpha \\, H\\big(s;K_s,n\\big) \\;+\\; \\beta \\, H\\big(y^*;K_y,m\\big)\n$$\n这个方程可以图形化地解释为寻找线性降解项 $D(y) = \\delta y$ 和非线性产生项 $P(y,s) = \\alpha H(s;K_s,n) + \\beta H(y;K_y,m)$ 的交点。对于固定的 $s$，$\\alpha H(s;K_s,n)$ 项是一个常数。产生函数 $P(y,s)$ 相对于 $y$ 的形状由正反馈项 $\\beta H(y;K_y,m)$ 决定。由于协同结合，这是一个S型函数，这在数学上由希尔系数 $m > 1$ 体现。\n\n要发生双稳态，产生曲线 $P(y,s)$ 必须与降解线 $D(y)$ 在三点相交。这要求产生曲线具有足够的“S”形，即其斜率在某一点必须比降解线的斜率更陡。稳态 $y^*$ 的稳定性由雅可比矩阵的符号决定，在这个一维情况下，即为在 $y^*$ 处求得的导数 $\\frac{\\partial f}{\\partial y}$：\n$$\n\\frac{\\partial f}{\\partial y} \\bigg|_{y=y^*} = \\beta \\frac{d H(y;K_y,m)}{dy}\\bigg|_{y=y^*} - \\delta\n$$\n如果 $\\frac{\\partial f}{\\partial y}  0$，则稳态是稳定的；如果 $\\frac{\\partial f}{\\partial y} > 0$，则是不稳定的。要存在两个稳定稳态，它们必须被一个不稳定的稳态分开。这意味着对于某个 $y$ 的范围，必须满足条件 $\\frac{\\partial f}{\\partial y} > 0$。这导致了双稳态的必要条件：\n$$\n\\max_{y \\ge 0} \\left( \\beta \\frac{d H(y;K_y,m)}{dy} \\right) > \\delta\n$$\n该条件表明，由反馈驱动的产生项的最大斜率必须超过降解速率常数。这需要两件事：\n1.  协同正反馈（$m > 1$）：对于 $m \\le 1$，希尔函数是凹的，其导数单调递减，在 $y=0$ 处达到最大值。双稳态的条件无法满足。\n2.  足够强的反馈：反馈强度 $\\beta$ 必须足够大以克服降解率 $\\delta$。\n\n当这些条件满足时，存在一个输入值范围 $s \\in [s_L, s_R]$，称为静态双稳态窗口，在该窗口内系统有两个稳定的不动点。\n\n*空间*滞后现象的出现取决于该系统在变化的输入 $s(t)$ 下的动力学。我们比较两个时间尺度：\n1.  基因表达水平的弛豫时间，$\\tau_{\\text{relax}} \\approx 1/\\delta$。这是 $y(t)$ 接近新稳态所需的特征时间。\n2.  输入扫过双稳态窗口的扫描时间，$\\tau_{\\text{sweep}} = \\Delta s_{static} / |ds/dt|$，其中 $\\Delta s_{static} = s_R - s_L$ 且 $|ds/dt| = |g v| = r$。\n\n如果 $\\tau_{\\text{sweep}} \\gg \\tau_{\\text{relax}}$，则扫描是准静态的。系统状态 $y(t)$ 会紧密跟随稳定稳态分支随 $s(t)$ 变化。切换发生在非常接近静态分岔点 $s_L$ 和 $s_R$ 的地方。空间滞后 $\\Delta x$ 接近静态极限 $\\Delta s_{static} / |g|$。\n如果 $\\tau_{\\text{sweep}}$ 不远大于 $\\tau_{\\text{relax}}$，即扫描速率 $r = |gv|$ 足够大，系统状态无法瞬时适应。这种延迟会导致动态过冲。在向上扫描期间，$y(t)$ 即使在 $s(t)$ 超过 $s_R$ 后仍停留在低分支。向高状态的跳变发生在一个有效阈值 $s_{\\text{up,eff}} > s_R$ 处。类似地，在向下扫描期间，向低状态的跳变被延迟到一个有效阈值 $s_{\\text{down,eff}}  s_L$ 处。\n这种动态效应增加了滞后环的宽度，使得 $s_{\\text{up,eff}} - s_{\\text{down,eff}} > s_R - s_L$。因此，当系统是双稳态时，空间滞后现象 $\\Delta x = (s_{\\text{up,eff}} - s_{\\text{down,eff}})/|g|$ 就会出现，并且只要系统不处于准静态状态，其幅度就会随着扫描速率 $|g v|$ 的增加而增加。\n\n**任务C：数值实现**\n\n$\\Delta x$ 的计算需要模拟输入 $s(t)$ 的向上和向下扫描时的ODE，并检测基因表达水平 $y(t)$ 何时穿过阈值 $y_{\\text{th}} = K_y$。\n\n每个测试用例的模拟程序如下：\n1.  **参数**：解包模型参数 $(\\alpha,\\beta,\\delta,K_s,n,K_y,m)$ 和扫描参数 $(s_{\\min},s_{\\max},g,v)$。扫描速率为 $r = |g v|$。\n2.  **初始条件**：\n    *   对于向上扫描，系统从 $s = s_{\\min}$ 开始。初始条件 $y_0^{\\text{up}}$ 是对应于 $s_{\\min}$ 的低分支稳态。对于给定的 $s_{\\min}=0$ 的测试用例，此状态即为 $y=0$。\n    *   对于向下扫描，系统从 $s = s_{\\max}$ 开始。初始条件 $y_0^{\\text{down}}$ 是对应于 $s_{\\max}$ 的高分支稳态。这可以通过数值求解稳态方程 $f(y, s_{\\max}) = 0$ 的最大稳定根来找到，例如，使用像 `scipy.optimize.brentq` 这样的求根算法，在预期包含高状态的区间上求解，如 $[K_y, (\\alpha+\\beta)/\\delta + 1]$。\n3.  **ODE积分与事件检测**：\n    *   **向上扫描**：ODE $\\frac{dy}{dt} = f(y, s(t))$ 在时间区间 $[0, T_{\\text{sweep}}]$ 上进行积分，其中 $s(t) = s_{\\min} + r t$ 且 $T_{\\text{sweep}} = (s_{\\max}-s_{\\min})/r$。我们使用 `scipy.integrate.solve_ivp`，并带有一个事件函数来检测 $y(t) - y_{\\text{th}}$ 何时以正方向穿过零。如果在时间 $t_{\\text{up}}$ 找到穿越点，我们计算 $s_{\\text{up,eff}} = s_{\\min} + r t_{\\text{up}}$。\n    *   **向下扫描**：ODE在 $[0, T_{\\text{sweep}}]$ 上积分，此时 $s(t) = s_{\\max} - r t$。事件函数检测 $y(t) - y_{\\text{th}}$ 何时以负方向穿过零。如果在 $t_{\\text{down}}$ 发生穿越，我们计算 $s_{\\text{down,eff}} = s_{\\max} - r t_{\\text{down}}$。\n4.  **滞后计算**：\n    *   如果成功找到了 $s_{\\text{up,eff}}$ 和 $s_{\\text{down,eff}}$，则空间滞后计算为 $\\Delta x = (s_{\\text{up,eff}} - s_{\\text{down,eff}}) / |g|$。\n    *   如果在扫描范围 $[s_{\\min}, s_{\\max}]$ 内任一穿越未发生，则 $\\Delta x$ 定义为 $0$。最终结果四舍五入到6位小数。\n\n此过程应用于提供的四个测试用例中的每一个。不同扫描速度的结果（情况1、2、3）将说明滞后环宽度对动态条件的依赖性，而单稳态对照（情况4）预计将显示最小或零滯后，因为在扫描的参数范围内，潜在的双稳态很弱或不存在。", "answer": "$$\\boxed{[0.613322, 0.590132, 1.157835, 0.000000]}$$", "id": "2714700"}]}