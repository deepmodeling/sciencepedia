{"hands_on_practices": [{"introduction": "形态发生素梯度的形成是发育生物学的基石。理解这些梯度如何响应其源头浓度的变化，对于分析自然系统和工程化合成系统都至关重要。本练习将探讨经典的反应-扩散模型，该模型描述了物质如何通过扩散和降解形成稳定的指数梯度。通过推导基因表达边界的位移，您将对“倍数变化检测”这一概念获得更深刻的直觉，并理解发育模式如何实现对生产速率绝对值变化的鲁棒性。[@problem_id:2779091]", "problem": "一个一维上皮占据半无限域 $x \\geq 0$。一种形态发生素在边界 $x=0$ 处产生，以扩散系数 $D$ 扩散到组织中，并以速率常数 $k$ 进行一阶降解。在稳态下，形态发生素浓度 $c(x)$ 满足反应扩散偏微分方程 (PDE)\n$$\n0 = D \\frac{d^{2} c}{dx^{2}} - k\\, c,\n$$\n对于 $x0$，并满足远场条件 $c(x) \\to 0$ 当 $x \\to \\infty$。边界处的产生被建模为具有恒定通量 $J$ 的流入，给出边界条件 $-D \\left.\\frac{dc}{dx}\\right|_{x=0} = J$。\n\n一个靶基因线性解码该形态发生素：基因的调控输入为 $g(x) = \\alpha\\, c(x) - \\beta$，其中 $\\alpha0$ 和 $\\beta0$ 是常数。当 $g(x) \\geq 0$ 时基因表达，当 $g(x)  0$ 时基因不表达。基因表达边界 (GEB) 位置 $x^{\\ast}$ 由 $g(x^{\\ast}) = 0$ 隐式定义。\n\n假设形态发生素的产生速率（即流入通量 $J$）增加一个无量纲因子 $r0$，而所有其他参数保持不变。令 $x^{\\ast}_{0}$ 表示变化前的 GEB，$x^{\\ast}_{r}$ 表示变化后的 GEB。在这些假设下，计算边界位移 $\\Delta x = x^{\\ast}_{r} - x^{\\ast}_{0}$。请将您的最终答案表示为仅包含 $r$、$D$ 和 $k$ 的闭式解析表达式。最终答案中不要包含任何单位，也不要使用数值近似。", "solution": "所述问题具有科学依据，是适定且客观的。它提出了一个来自发育生物学领域的形态发生素梯度形成和解释的标准模型，该模型在数学上是可形式化的并且内部一致。所有必要的参数和条件都已给出，可以推导出唯一的解。因此，该问题是有效的，并将推导出一个解。\n\n该问题描述了在一维半无限域 $x \\ge 0$ 中，形态发生素的稳态浓度 $c(x)$。其控制方程是一个反应扩散方程，在稳态下变为一个常微分方程 (ODE)：\n$$\nD \\frac{d^{2} c}{dx^{2}} - k c = 0\n$$\n这可以改写为：\n$$\n\\frac{d^{2} c}{dx^{2}} - \\frac{k}{D} c = 0\n$$\n这是一个二阶线性齐次常系数常微分方程。其特征方程为 $\\lambda^{2} - \\frac{k}{D} = 0$，根为 $\\lambda = \\pm\\sqrt{\\frac{k}{D}}$。\n因此，通解为：\n$$\nc(x) = A \\exp\\left(x\\sqrt{\\frac{k}{D}}\\right) + B \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\n其中 $A$ 和 $B$ 是由边界条件确定的常数。\n\n第一个边界条件是远场条件，$c(x) \\to 0$ 当 $x \\to \\infty$ 时。$A \\exp\\left(x\\sqrt{\\frac{k}{D}}\\right)$ 项在 $x \\to \\infty$ 时无界增长（因为 $k0$ 且 $D0$）。为满足该条件，我们必须将其系数设为 $A = 0$。因此，解简化为：\n$$\nc(x) = B \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\n为简化记法，我们定义特征长度尺度 $\\lambda_L = \\sqrt{D/k}$。解变为 $c(x) = B \\exp(-x/\\lambda_L)$。\n\n第二个边界条件是在 $x=0$ 处的恒定流入量 $J$，由 $-D \\left.\\frac{dc}{dx}\\right|_{x=0} = J$ 给出。\n首先，我们计算 $c(x)$ 的导数：\n$$\n\\frac{dc}{dx} = \\frac{d}{dx} \\left[ B \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right) \\right] = -B \\sqrt{\\frac{k}{D}} \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\n在 $x=0$ 处计算此导数：\n$$\n\\left.\\frac{dc}{dx}\\right|_{x=0} = -B \\sqrt{\\frac{k}{D}}\n$$\n将此代入边界条件方程：\n$$\n-D \\left(-B \\sqrt{\\frac{k}{D}}\\right) = J\n$$\n$$\nD B \\frac{\\sqrt{k}}{\\sqrt{D}} = J \\implies B \\sqrt{Dk} = J\n$$\n求解常数 $B$：\n$$\nB = \\frac{J}{\\sqrt{Dk}}\n$$\n因此，形态发生素的浓度分布由下式给出：\n$$\nc(x) = \\frac{J}{\\sqrt{Dk}} \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\n基因表达边界 (GEB) 的位置 $x^{\\ast}$ 由条件 $g(x^{\\ast}) = 0$ 定义。调控输入为 $g(x) = \\alpha c(x) - \\beta$。\n设 $g(x^{\\ast}) = 0$ 得到 $\\alpha c(x^{\\ast}) - \\beta = 0$，这意味着边界处的浓度是一个固定的阈值：\n$$\nc(x^{\\ast}) = \\frac{\\beta}{\\alpha}\n$$\n现在，通过令该位置浓度的两个表达式相等，我们可以找到 $x^{\\ast}$ 的表达式：\n$$\n\\frac{J}{\\sqrt{Dk}} \\exp\\left(-x^{\\ast}\\sqrt{\\frac{k}{D}}\\right) = \\frac{\\beta}{\\alpha}\n$$\n为了解出 $x^{\\ast}$，我们首先分离指数项：\n$$\n\\exp\\left(-x^{\\ast}\\sqrt{\\frac{k}{D}}\\right) = \\frac{\\beta \\sqrt{Dk}}{\\alpha J}\n$$\n取两边的自然对数：\n$$\n-x^{\\ast}\\sqrt{\\frac{k}{D}} = \\ln\\left(\\frac{\\beta \\sqrt{Dk}}{\\alpha J}\\right)\n$$\n求解 $x^{\\ast}$：\n$$\nx^{\\ast} = -\\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\beta \\sqrt{Dk}}{\\alpha J}\\right) = \\sqrt{\\frac{D}{k}} \\ln\\left(\\left[\\frac{\\beta \\sqrt{Dk}}{\\alpha J}\\right]^{-1}\\right) = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right)\n$$\n这个通用表达式将 GEB 位置与系统参数联系起来。\n\n现在我们考虑两种具体情况。\n首先，是流入量为 $J$ 的初始状态。其 GEB 为 $x^{\\ast}_{0}$：\n$$\nx^{\\ast}_{0} = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right)\n$$\n其次，是流入量增加因子 $r$ 变为 $rJ$ 后的修改状态。新的 GEB 为 $x^{\\ast}_{r}$：\n$$\nx^{\\ast}_{r} = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha (rJ)}{\\beta \\sqrt{Dk}}\\right)\n$$\n问题要求计算边界位移 $\\Delta x = x^{\\ast}_{r} - x^{\\ast}_{0}$。\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha r J}{\\beta \\sqrt{Dk}}\\right) - \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right)\n$$\n提取公因式 $\\sqrt{D/k}$：\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\left[ \\ln\\left(\\frac{\\alpha r J}{\\beta \\sqrt{Dk}}\\right) - \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right) \\right]\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\ln\\left( \\frac{\\frac{\\alpha r J}{\\beta \\sqrt{Dk}}}{\\frac{\\alpha J}{\\beta \\sqrt{Dk}}} \\right)\n$$\n对数内的项简化为：\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\ln(r)\n$$\n这就是边界位移的最终表达式，按要求仅用 $r$、$D$ 和 $k$ 表示。描述源强度（$J$）和基因读出机制（$\\alpha$, $\\beta$）的参数没有出现在最终结果中，这展示了该系统的一个关键标度性质。", "answer": "$$\\boxed{\\sqrt{\\frac{D}{k}} \\ln(r)}$$", "id": "2779091"}, {"introduction": "形态发生素梯度提供了位置信息，但是细胞能够多精确地基于一个充满噪声的生物化学信号来确定其位置？这个问题是发育模式建成可靠性的核心。本练习将误差传播原理应用于生物学背景，将梯度的局部陡峭程度与位置解读的精度联系起来。通过推导位置不确定性，您将定量地理解梯度形状与位置精度之间的权衡关系，这是自然和合成系统中一个基本的设计约束。[@problem_id:2779048]", "problem": "一个一维工程组织沿空间坐标 $x \\in [0,L]$ 建立了一个合成形态发生素梯度，其平均浓度分布 $c(x)$ 是严格单调且可微的。单个细胞通过受体介导的传感来读取局部形态发生素浓度，从而产生一个带噪声的测量值 $c_{\\mathrm{meas}} = c(x) + \\eta$，其中 $\\eta$ 是一个零均值高斯随机变量，其标准差为 $\\sigma_{c}$，在感兴趣的邻域内独立于 $x$。细胞通过反转平均分布 $\\hat{x} = c^{-1}(c_{\\mathrm{meas}})$ 来解码其位置，该反函数因单调性而良定义。命运决定规则在感知浓度上是单调的，因此条件响应 $p(f \\mid c)$ 与所考虑区域内 $c$ 和 $x$ 之间的单值反向映射是一致的。\n\n从 $c(\\hat{x})$ 关于真实位置 $x$ 的一阶泰勒线性化以及高斯噪声标准差的定义出发，推导位置不确定性 $\\sigma_{x}(x)$ 的解析表达式，该不确定性定义为 $\\hat{x}$ 围绕 $x$ 的标准差，并用 $\\sigma_{c}$ 和局部斜率 $\\partial c / \\partial x$ 表示。然后，将您的表达式特化为常见的指数梯度 $c(x) = c_{0} \\exp(-x/\\lambda)$，其中 $c_{0}  0$ 是 $x=0$ 处的浓度，$\\lambda  0$ 是衰减长度。\n\n提供您关于 $\\sigma_{x}(x)$ 的最终答案，该答案应为一个用 $c_{0}$、$\\lambda$、$\\sigma_{c}$ 和 $x$ 表示的单一闭式表达式。假设 $x$ 和 $\\lambda$ 的单位为微米，$c_{0}$ 和 $\\sigma_{c}$ 的单位为相同的浓度单位，以使您的表达式具有微米单位。此外，简要解释当 $|\\partial c/\\partial x| \\to 0$ 时 $\\sigma_{x}(x)$ 会发生什么，并基于您推导的表达式从数学上证明您的解释。无需数值近似。", "solution": "首先，将对提出的问题进行严格验证，以确保其科学和逻辑的完整性。\n\n**问题验证**\n\n**第一步：提取已知条件**\n- 系统是一个沿空间坐标 $x \\in [0,L]$ 的一维工程组织。\n- 平均形态发生素浓度分布为 $c(x)$，该函数严格单调且可微。\n- 细胞的浓度测量是一个带噪声的变量：$c_{\\mathrm{meas}} = c(x) + \\eta$。\n- 噪声项 $\\eta$ 是一个零均值高斯随机变量，标准差为 $\\sigma_{c}$。\n- 在感兴趣的区域内，$\\sigma_{c}$ 被陈述为与 $x$ 无关。\n- 细胞对其位置的估计为 $\\hat{x} = c^{-1}(c_{\\mathrm{meas}})$。反函数 $c^{-1}$ 是良定义的。\n- 位置不确定性 $\\sigma_{x}(x)$ 定义为 $\\hat{x}$ 围绕真实位置 $x$ 的标准差。\n- 推导必须从 $c(\\hat{x})$ 关于真实位置 $x$ 的一阶泰勒线性化开始。\n- 需要分析的特定梯度分布是 $c(x) = c_{0} \\exp(-x/\\lambda)$，其中常数 $c_{0}  0$ 和 $\\lambda  0$。\n- $\\sigma_{x}(x)$ 的最终表达式必须用 $c_{0}$、$\\lambda$、$\\sigma_{c}$ 和 $x$ 表示。\n- 需要简要解释当 $|\\partial c/\\partial x| \\to 0$ 时 $\\sigma_{x}(x)$ 的行为。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是发育生物学中“位置信息”原理的经典表述，应用于合成生物学背景下。形态发生素梯度、带噪声的传感、通过函数反演进行解码以及指数分布（扩散-降解方程的一个解）的使用都是定量生物学和生物物理学中标准且成熟的概念。该模型在科学上是合理的。\n- **良定义：** 该问题是良定义的。它提供了所有必要的信息和清晰、结构化的推导路径（泰勒线性化）。输入（$c(x)$、$\\sigma_c$）已定义，输出（$\\sigma_x(x)$）也已明确指定。\n- **客观性：** 问题陈述是客观的，使用了精确的数学和科学语言，不含主观或模糊的术语。\n\n所有其他验证标准均已满足。该问题不包含矛盾、不完整、琐碎或不科学的前提。\n\n**第三步：结论与行动**\n问题有效。我现在将进行解答。\n\n**位置不确定性的推导**\n\n位置估计 $\\hat{x}$ 是测量浓度 $c_{\\mathrm{meas}}$ 的函数，具体为 $\\hat{x} = c^{-1}(c_{\\mathrm{meas}})$。在真实位置 $x$ 处的测量浓度为 $c_{\\mathrm{meas}} = c(\\hat{x})$。问题要求从 $c(\\hat{x})$ 在真实位置 $x$ 附近的一阶泰勒级数展开开始：\n$$c(\\hat{x}) \\approx c(x) + (\\hat{x} - x) \\frac{\\partial c}{\\partial x}$$\n在这里，$\\hat{x} - x$ 表示位置估计的误差。\n我们已知测量浓度为 $c_{\\mathrm{meas}} = c(x) + \\eta$，其中 $\\eta$是测量噪声。令这两个测量浓度的表达式相等，我们得到：\n$$c(x) + \\eta \\approx c(x) + (\\hat{x} - x) \\frac{\\partial c}{\\partial x}$$\n从两边减去 $c(x)$ 得到浓度噪声 $\\eta$ 和位置误差 $\\hat{x} - x$ 之间的近似关系：\n$$\\eta \\approx (\\hat{x} - x) \\frac{\\partial c}{\\partial x}$$\n重新整理该方程以求解位置误差，可得：\n$$\\hat{x} - x \\approx \\frac{\\eta}{\\frac{\\partial c}{\\partial x}}$$\n位置不确定性 $\\sigma_{x}(x)$ 是位置估计 $\\hat{x}$ 的标准差。由于 $x$ 是一个固定的、非随机的量，估计值 $\\hat{x}$ 的方差等于误差 $\\hat{x} - x$ 的方差。\n$$\\sigma_{x}^{2}(x) = \\mathrm{Var}(\\hat{x}) = \\mathrm{Var}(\\hat{x} - x)$$\n使用推导出的误差近似值，我们求得方差：\n$$\\sigma_{x}^{2}(x) \\approx \\mathrm{Var}\\left(\\frac{\\eta}{\\frac{\\partial c}{\\partial x}}\\right)$$\n导数 $\\frac{\\partial c}{\\partial x}$ 是在真实位置 $x$ 处计算的，因此是一个确定性量，而非随机变量。在方差计算中，我们可以将其视为一个常数因子。利用对于随机变量 $Y$ 和常数 $a$ 的性质 $\\mathrm{Var}(aY) = a^{2}\\mathrm{Var}(Y)$，我们有：\n$$\\sigma_{x}^{2}(x) \\approx \\left(\\frac{1}{\\frac{\\partial c}{\\partial x}}\\right)^{2} \\mathrm{Var}(\\eta)$$\n已知噪声 $\\eta$ 的标准差为 $\\sigma_{c}$，所以其方差为 $\\mathrm{Var}(\\eta) = \\sigma_{c}^{2}$。将此代入表达式中得到：\n$$\\sigma_{x}^{2}(x) \\approx \\frac{\\sigma_{c}^{2}}{\\left(\\frac{\\partial c}{\\partial x}\\right)^{2}}$$\n对两边取平方根得到位置不确定性的通用表达式。由于标准差必须为非负数，我们在分母中使用导数的绝对值：\n$$\\sigma_{x}(x) = \\frac{\\sigma_{c}}{\\left|\\frac{\\partial c}{\\partial x}\\right|}$$\n\n**对指数梯度的特化**\n\n现在问题要求我们将此结果特化为指数浓度分布 $c(x) = c_{0} \\exp(-x/\\lambda)$。\n首先，我们计算 $c(x)$ 关于 $x$ 的导数：\n$$\\frac{\\partial c}{\\partial x} = \\frac{d}{dx}\\left[c_{0} \\exp\\left(-\\frac{x}{\\lambda}\\right)\\right] = c_{0} \\exp\\left(-\\frac{x}{\\lambda}\\right) \\cdot \\left(-\\frac{1}{\\lambda}\\right) = -\\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n接下来，我们取该导数的绝对值。由于 $c_{0}  0$、$\\lambda  0$ 且指数函数始终为正，绝对值为：\n$$\\left|\\frac{\\partial c}{\\partial x}\\right| = \\left|-\\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)\\right| = \\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n最后，我们将此表达式代入 $\\sigma_{x}(x)$ 的通用公式中：\n$$\\sigma_{x}(x) = \\frac{\\sigma_{c}}{\\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)}$$\n化简此分数可得最终的闭式表达式：\n$$\\sigma_{x}(x) = \\frac{\\sigma_{c} \\lambda}{c_{0}} \\exp\\left(\\frac{x}{\\lambda}\\right)$$\n\n**对极限 $|\\partial c/\\partial x| \\to 0$ 的分析**\n\n基于推导出的通用表达式 $\\sigma_{x}(x) = \\sigma_{c} / |\\partial c/\\partial x|$，我们可以分析当梯度斜率的绝对值趋于零时的行为。当 $|\\partial c/\\partial x| \\to 0$ 时，对于非零的测量噪声 $\\sigma_{c}  0$，分数的分母趋于零，而分子保持为一个正常数。\n在数学上，这意味着位置不确定性 $\\sigma_{x}(x)$ 发散到无穷大：\n$$\\lim_{|\\partial c/\\partial x| \\to 0} \\sigma_{x}(x) = \\infty$$\n其物理解释是，一个平缓或平坦的形态发生素梯度提供的位置信息非常差。当浓度随位置变化很小时，浓度测量中一个微小且不可避免的噪声（$\\eta$）使得区分相距很远的位置变得不可能。细胞的解码机制将一个被噪声模糊的小浓度范围映射到一个非常大的可能位置范围，从而导致巨大的位置不确定性。在梯度完全平坦（$|\\partial c/\\partial x| = 0$）的极限情况下，局部浓度不携带任何关于位置的信息，不确定性变为无穷大。", "answer": "$$\n\\boxed{\\frac{\\sigma_{c} \\lambda}{c_{0}} \\exp\\left(\\frac{x}{\\lambda}\\right)}\n$$", "id": "2779048"}, {"introduction": "现代合成生物学的目标不仅是分析，更是主动地设计和控制生物模式。光遗传学为在工程化组织上施加空间输入提供了一个强大的工具。这个计算练习引入了反问题的概念：您将不再是根据给定的输入预测一个模式，而是去计算生成一个期望模式所需的输入。通过实现一个算法来解决这个正则化反问题，您将接触到一种前沿的工程方法，将理论模型与多细胞工程中的实际控制策略联系起来。[@problem_id:2779025]", "problem": "您将设计并实现一个算法，用于计算最优的一维光照模式，以在由光遗传学源驱动的线性扩散-降解系统中，产生一个目标稳态形态发生素浓度分布。正向生物物理模型源自 Fick 定律和一阶降解。在一维空间域，长度为 $L$，空间坐标为 $x \\in [0,L]$，形态发生素浓度 $c(x)$ 满足稳态方程\n$$\nD \\,\\frac{d^2 c}{dx^2} - k\\,c + s\\,u(x) = 0,\n$$\n其中 $D$ 是扩散系数，$k$ 是降解速率常数，$s$ 是单位光照的源强度，$u(x)$ 是非负的光照强度。两端均满足零通量（Neumann）边界条件：\n$$\n\\frac{dc}{dx}(0) = 0, \\quad \\frac{dc}{dx}(L) = 0.\n$$\n定义一个包含 $N$ 个点的均匀网格，点间距为 $h = L/(N-1)$。使用标准的二阶中心有限差分格式离散化二阶导数，通过经典的幽灵点消除法在端点处强制执行零通量边界条件，从而得到一个三对角二阶导数矩阵 $L_N \\in \\mathbb{R}^{N \\times N}$，其内部行使用三点模板，边界行一致地施加零空间导数。稳态离散化正向模型可以写为\n$$\n\\left(k I - D L_N\\right)\\, \\mathbf{c} = s\\, \\mathbf{u},\n$$\n其中 $\\mathbf{c}, \\mathbf{u} \\in \\mathbb{R}^N$ 是离散化的浓度和光照，$I$ 是 $N \\times N$ 单位矩阵。光照按分量受约束 $0 \\le u_i \\le u_{\\max}$。\n\n给定一个目标浓度分布 $\\mathbf{c}^{\\star} \\in \\mathbb{R}^N$，将逆问题描述为求解 $\\mathbf{u}$ 以最小化凸二次目标函数\n$$\nJ(\\mathbf{u}) = \\left\\| G \\mathbf{u} - \\mathbf{c}^{\\star} \\right\\|_2^2 \\;+\\; \\alpha \\left\\| D_1 \\mathbf{u} \\right\\|_2^2\n$$\n并满足对所有 $i$ 的箱式约束 $0 \\le u_i \\le u_{\\max}$，其中 $G = \\left(k I - D L_N\\right)^{-1} s I$ 是将光照映射到浓度的离散正向算子，$D_1 \\in \\mathbb{R}^{(N-1)\\times N}$ 是由 $(D_1 \\mathbf{u})_i = u_{i+1} - u_i$（对于 $i=1,\\dots,N-1$）定义的一阶差分矩阵，$\\alpha \\ge 0$ 是一个平滑参数。对于下方的每个测试用例，计算最优的 $\\mathbf{u}^{\\star}$，然后评估生成的浓度 $\\widehat{\\mathbf{c}} = G \\mathbf{u}^{\\star}$，并报告均方根误差\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^N \\left(\\widehat{c}_i - c_i^{\\star}\\right)^2 }.\n$$\n以浓度任意单位（a.u.）报告 $\\mathrm{RMSE}$。\n\n实现要求：\n- 使用标准的三点模板构建内部的 $L_N$，并为边界行设置一致的零通量条件。\n- 通过数值求逆 $k I - D L_N$ 或求解以该矩阵为系数的线性方程组来构建 $G$。\n- 使用一阶差分 $D_1$ 进行平滑，并使用保持凸性的标准技术来引入平滑项。\n- 强制执行 $0 \\le u_i \\le u_{\\max}$。\n\n测试套件。每个案例使用指定的 $N$ 和 $L$，并通过在均匀网格 $x_j = j h$（$j=0,\\dots,N-1$）上对指定的连续函数进行采样来定义目标 $\\mathbf{c}^{\\star}$：\n\n- 案例 A（中等扩散下的平滑目标）：$L = 500\\,\\mu\\mathrm{m}$，$N = 64$，$D = 10\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.01\\,\\mathrm{s}^{-1}$，$s = 1.0\\,\\mathrm{(a.u.)/(\\mathrm{W}\\,\\mathrm{m}^{-2})}$，$\\alpha = 10^{-2}$，$u_{\\max} = 5.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$，目标 $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}\\cdot \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\cdot (60\\,\\mu\\mathrm{m})^2}\\right)$。\n\n- 案例 B（用于探究边界处理的均匀目标）：$L = 400\\,\\mu\\mathrm{m}$，$N = 50$，$D = 5\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.05\\,\\mathrm{s}^{-1}$，$s = 1.0$，$\\alpha = 10^{-3}$，$u_{\\max} = 5.0$，目标 $c^{\\star}(x) = 0.2\\,\\mathrm{a.u.}$ 对所有 $x$。\n\n- 案例 C（具有更强平滑的阶跃目标）：$L = 600\\,\\mu\\mathrm{m}$，$N = 80$，$D = 8\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.02\\,\\mathrm{s}^{-1}$，$s = 1.0$，$\\alpha = 5\\times 10^{-2}$，$u_{\\max} = 10.0$，目标 $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}$ 对 $x \\le L/3$ 且 $c^{\\star}(x) = 0.1\\,\\mathrm{a.u.}$ 对 $x  L/3$。\n\n- 案例 D（高扩散和弱降解，窄特征）：$L = 500\\,\\mu\\mathrm{m}$，$N = 64$，$D = 50\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.005\\,\\mathrm{s}^{-1}$，$s = 1.0$，$\\alpha = 10^{-2}$，$u_{\\max} = 10.0$，目标 $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}\\cdot \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\cdot (20\\,\\mu\\mathrm{m})^2}\\right)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含案例 A、B、C 和 D 的 $\\mathrm{RMSE}$ 值，按此顺序排列，形式为一个由方括号括起来的逗号分隔的浮点数列表（例如，“[$r_A$,$r_B$,$r_C$,$r_D$]”）。每个 $\\mathrm{RMSE}$ 必须以浓度任意单位（a.u.）表示。\n- 程序必须是完全自包含的，不接受任何输入，并在内部执行所有计算。", "solution": "所提出的问题是合成发育生物学领域中一个适定的逆问题，具体涉及通过光遗传学控制多细胞模式。其目标是确定一个最优的光照模式 $\\mathbf{u}$，以生成一个期望的稳态形态发生素浓度分布 $\\mathbf{c}^{\\star}$。这需要对一个基于反应-扩散动力学的生物物理模型进行求逆。该问题被构建为一个带箱式约束的凸优化问题，这在计算上是易于处理的。\n\n正向模型描述了在一维域（长度为 $L$）上形态发生素的稳态浓度 $c(x)$，由以下微分方程给出：\n$$\nD \\,\\frac{d^2 c}{dx^2} - k\\,c + s\\,u(x) = 0\n$$\n此处，$D$ 是扩散系数，$k$ 是一阶降解速率，$s$ 是源产生速率，$u(x)$ 是空间变化的光照输入。该系统是封闭的，这通过零通量（Neumann）边界条件来强制执行：\n$$\n\\frac{dc}{dx}(0) = 0, \\quad \\frac{dc}{dx}(L) = 0\n$$\n为了数值求解此问题，我们首先将空间域 $x \\in [0, L]$ 离散化为一个包含 $N$ 个点的均匀网格 $\\{x_i\\}_{i=0}^{N-1}$，点间距为 $h = L/(N-1)$。浓度和光照分布由向量 $\\mathbf{c}, \\mathbf{u} \\in \\mathbb{R}^N$ 表示。\n\n二阶导数算子 $\\frac{d^2}{dx^2}$ 使用二阶中心有限差分格式进行近似。对于内部网格点 $x_i$，其形式为：\n$$\n\\frac{d^2 c}{dx^2}\\bigg|_{x_i} \\approx \\frac{c_{i-1} - 2c_i + c_{i+1}}{h^2}\n$$\n为了在边界上保持二阶精度，我们引入幽灵点 $c_{-1}$ 和 $c_{N}$，并应用零通量边界条件的中心差分近似：\n- 在 $x_0 = 0$ 处：$\\frac{dc}{dx}(0) \\approx \\frac{c_1 - c_{-1}}{2h} = 0 \\implies c_{-1} = c_1$。\n- 在 $x_{N-1} = L$ 处：$\\frac{dc}{dx}(L) \\approx \\frac{c_{N} - c_{N-2}}{2h} = 0 \\implies c_{N} = c_{N-2}$。\n将这些代入边界节点处的二阶导数近似中，可得：\n- 在 $x_0$ 处：$\\frac{d^2 c}{dx^2}\\bigg|_{x_0} \\approx \\frac{c_{-1} - 2c_0 + c_1}{h^2} = \\frac{2c_1 - 2c_0}{h^2}$。\n- 在 $x_{N-1}$ 处：$\\frac{d^2 c}{dx^2}\\bigg|_{x_{N-1}} \\approx \\frac{c_{N-2} - 2c_{N-1} + c_{N}}{h^2} = \\frac{2c_{N-2} - 2c_{N-1}}{h^2}$。\n这引出了离散拉普拉斯矩阵 $L_N \\in \\mathbb{R}^{N \\times N}$ 的构建：\n$$\nL_N = \\frac{1}{h^2} \\begin{pmatrix}\n-2  2  0  \\dots  0 \\\\\n1  -2  1  \\dots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  \\vdots \\\\\n0  \\dots  1  -2  1 \\\\\n0  \\dots  0  2  -2\n\\end{pmatrix}\n$$\n控制方程的离散形式是一个线性系统：\n$$\n\\left( D L_N - k I \\right) \\mathbf{c} + s \\mathbf{u} = \\mathbf{0}\n$$\n其中 $I$ 是 $N \\times N$ 单位矩阵。整理后，我们得到离散化的正向模型：\n$$\n\\left( k I - D L_N \\right) \\mathbf{c} = s \\mathbf{u}\n$$\n当 $D, k  0$ 时，矩阵 $A = (k I - D L_N)$ 是正定的，因此是可逆的。因此，我们可以定义一个线性正向算子 $G$，它将光照向量 $\\mathbf{u}$ 映射到浓度向量 $\\mathbf{c}$：\n$$\n\\mathbf{c} = \\left(k I - D L_N\\right)^{-1} s I \\, \\mathbf{u} = G \\mathbf{u}\n$$\n逆问题是找到一个光照模式 $\\mathbf{u}$，使其产生的浓度分布尽可能接近目标分布 $\\mathbf{c}^{\\star}$。这被表述为一个正则化优化问题，以确保解的稳定性和物理意义。我们最小化以下凸二次目标函数：\n$$\nJ(\\mathbf{u}) = \\underbrace{\\left\\| G \\mathbf{u} - \\mathbf{c}^{\\star} \\right\\|_2^2}_{\\text{保真项}} + \\underbrace{\\alpha \\left\\| D_1 \\mathbf{u} \\right\\|_2^2}_{\\text{平滑项}}\n$$\n第一项衡量了产生的浓度 $G\\mathbf{u}$ 与目标 $\\mathbf{c}^{\\star}$ 之间的平方欧几里得距离。第二项是一个 Tikhonov 正则化项，它惩罚光照模式中相邻点之间的巨大变化，由平滑参数 $\\alpha \\ge 0$ 控制。此处，$D_1 \\in \\mathbb{R}^{(N-1)\\times N}$ 是一阶差分矩阵。此外，光照必须满足物理约束 $0 \\le u_i \\le u_{\\max}$ 对所有网格点 $i$。\n\n此问题结构等价于一个带边界约束的线性最小二乘问题。我们可以通过堆叠矩阵和向量来重写目标函数：\n$$\nJ(\\mathbf{u}) = \\left\\| \\begin{pmatrix} G \\\\ \\sqrt{\\alpha} D_1 \\end{pmatrix} \\mathbf{u} - \\begin{pmatrix} \\mathbf{c}^{\\star} \\\\ \\mathbf{0} \\end{pmatrix} \\right\\|_2^2\n$$\n其形式为 $\\min_{\\mathbf{u}} \\| M\\mathbf{u} - \\mathbf{d} \\|_2^2$，约束条件为 $0 \\le \\mathbf{u} \\le u_{\\max}$，其中 $M = \\begin{pmatrix} G \\\\ \\sqrt{\\alpha} D_1 \\end{pmatrix}$ 且 $\\mathbf{d} = \\begin{pmatrix} \\mathbf{c}^{\\star} \\\\ \\mathbf{0} \\end{pmatrix}$。这种形式可以使用标准的数值优化程序（例如 `scipy.optimize.lsq_linear`）高效求解。\n\n对每个测试用例，求解算法按以下步骤进行：\n1.  设置物理参数 $L, N, D, k, s, \\alpha, u_{\\max}$。\n2.  构建空间网格 $\\mathbf{x}$ 和目标浓度向量 $\\mathbf{c}^{\\star}$。\n3.  构建离散拉普拉斯矩阵 $L_N$ 和正向算子矩阵 $G$。\n4.  构建一阶差分矩阵 $D_1$。\n5.  为最小二乘问题构建增广矩阵 $M$ 和向量 $\\mathbf{d}$。\n6.  求解带边界约束的最小二乘问题，找到最优光照向量 $\\mathbf{u}^{\\star}$。\n7.  计算得到的浓度分布 $\\widehat{\\mathbf{c}} = G \\mathbf{u}^{\\star}$。\n8.  计算 $\\widehat{\\mathbf{c}}$ 和 $\\mathbf{c}^{\\star}$ 之间的均方根误差 (RMSE)，即 $\\sqrt{\\frac{1}{N} \\sum_{i=1}^N (\\widehat{c}_i - c_i^{\\star})^2}$。\n对所有指定的测试用例重复此过程，以评估控制策略在不同物理条件下的性能。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Computes the optimal illumination pattern for target morphogen profiles\n    and reports the root mean squared error for several test cases.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'name': 'A', 'L': 500.0, 'N': 64, 'D': 10.0, 'k': 0.01, 's': 1.0, 'alpha': 1e-2, 'u_max': 5.0,\n         'c_star_func': lambda x, L: 1.0 * np.exp(-(x - L/2)**2 / (2 * 60**2))},\n        # Case B\n        {'name': 'B', 'L': 400.0, 'N': 50, 'D': 5.0, 'k': 0.05, 's': 1.0, 'alpha': 1e-3, 'u_max': 5.0,\n         'c_star_func': lambda x, L: 0.2 * np.ones_like(x)},\n        # Case C\n        {'name': 'C', 'L': 600.0, 'N': 80, 'D': 8.0, 'k': 0.02, 's': 1.0, 'alpha': 5e-2, 'u_max': 10.0,\n         'c_star_func': lambda x, L: np.where(x = L/3, 1.0, 0.1)},\n        # Case D\n        {'name': 'D', 'L': 500.0, 'N': 64, 'D': 50.0, 'k': 0.005, 's': 1.0, 'alpha': 1e-2, 'u_max': 10.0,\n         'c_star_func': lambda x, L: 1.0 * np.exp(-(x - L/2)**2 / (2 * 20**2))}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # 1. Unpack parameters and set up the domain\n        L, N, D, k, s, alpha, u_max = case['L'], case['N'], case['D'], case['k'], case['s'], case['alpha'], case['u_max']\n        \n        x_grid = np.linspace(0, L, N)\n        h = L / (N - 1)\n        h2_inv = 1.0 / (h**2)\n        \n        # 2. Construct the second-derivative matrix L_N with Neumann BCs\n        diag_main = -2.0 * np.ones(N)\n        diag_off = np.ones(N - 1)\n        \n        L_N = h2_inv * (np.diag(diag_main) + np.diag(diag_off, k=1) + np.diag(diag_off, k=-1))\n        \n        # Apply zero-flux (Neumann) boundary conditions\n        L_N[0, 0] = -2.0 * h2_inv\n        L_N[0, 1] = 2.0 * h2_inv\n        L_N[N-1, N-2] = 2.0 * h2_inv\n        L_N[N-1, N-1] = -2.0 * h2_inv\n        \n        # 3. Construct matrices for the inverse problem\n        # Forward operator matrix G\n        A_op = k * np.eye(N) - D * L_N\n        G = s * np.linalg.inv(A_op)\n        \n        # First-difference matrix D1 for regularization\n        D1 = np.eye(N, k=1) - np.eye(N)\n        D1 = D1[:-1, :]\n\n        # Target concentration profile\n        c_star = case['c_star_func'](x_grid, L)\n\n        # 4. Set up and solve the bound-constrained least-squares problem\n        # The objective is to minimize ||M*u - d||^2_2\n        # where M = vstack([G, sqrt(alpha)*D1]) and d = concatenate([c_star, 0s])\n        M = np.vstack((G, np.sqrt(alpha) * D1))\n        d = np.concatenate((c_star, np.zeros(N - 1)))\n        \n        bounds = (0, u_max)\n        \n        # Solve for the optimal illumination u_star\n        opt_result = lsq_linear(M, d, bounds=bounds)\n        u_star = opt_result.x\n        \n        # 5. Compute the resulting concentration and RMSE\n        c_hat = G @ u_star\n        rmse = np.sqrt(np.mean((c_hat - c_star)**2))\n        results.append(rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2779025"}]}