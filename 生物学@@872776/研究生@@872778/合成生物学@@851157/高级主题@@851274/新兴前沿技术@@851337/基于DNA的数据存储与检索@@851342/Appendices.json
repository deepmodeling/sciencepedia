{"hands_on_practices": [{"introduction": "在设计DNA数据存储系统时，一个关键的初始步骤是构建编码方案，以确保写入的DNA序列与现有的合成和测序技术兼容。许多测序技术在处理均聚物（即长串相同的核苷酸，如$AAAA$）时会遇到困难，导致错误率增加。此练习将指导您构建一个有限状态模型，以在编码过程中强制执行避免此类序列的约束，并进一步计算在该约束下系统所能达到的理论最大信息存储密度，即信道容量。[@problem_id:2730426]", "problem": "需要一种合成DNA（脱氧核糖核酸）存储设备，将二进制输入符号映射到DNA输出符号，同时禁止子串 $AAAA$ 和 $CCCC$ 在输出中的任何位置出现，以减轻与均聚物相关的测序错误。\n\n任务：\n1) 构建一个最小确定性有限状态转换器（FST），该转换器从字母表 $\\{A,C,G,T\\}$ 中发射符号，并保证任何发射的字符串都永远不包含 $AAAA$ 或 $CCCC$。您的构建必须在确定性有限状态实现的意义上是最小的：状态集必须精确地编码为执行该约束所需的关于最近输出历史的最小必要内存，且无冗余。明确指定状态以及由输出符号标记的允许转移。\n\n2) 从受限系统的第一性原理出发，推导长度为 $n$ 的可接受输出字符串数量的渐近增长率，并由此确定将独立的公平二进制输入映射到由您的FST生成的、不违反约束的输出字符串的最大可实现信息速率（以比特/核苷酸为单位）。您的推导应基于有限状态受限编码理论的标准定义和经过充分检验的结果（例如，通过状态转移图计数可接受序列以及通过谱半径计算渐近增长率），而不是基于为这个特定约束临时引入的任何捷径公式。\n\n3) 以单个实数形式报告最大可实现编码速率（以比特/核苷酸为单位），四舍五入到4位有效数字。按照指示以比特/核苷酸为单位表示最终答案（在最终的方框答案中不要包含单位）。", "solution": "该问题是应用信息论中一个适定问题，具体来说是在数据存储系统的受限编码领域。它具有科学依据，因为均聚物游程是DNA测序中已知的错误来源。问题在于设计一种避免此类游程的编码，并计算这种编码的理论最大效率。解决方案需要应用有限自动机理论和符号动力学中的标准方法。\n\n问题包括三个部分。第一，构建一个最小状态机来执行该约束。第二，推导此受限系统的最大信息速率（即容量）。第三，计算该容量的数值。\n\n**第1部分：最小有限状态实现的构建**\n\n约束条件是，由字母表 $\\{A, C, G, T\\}$ 中的符号组成的输出序列不得包含子串 $AAAA$ 或 $CCCC$。为执行此约束，系统必须保持对最近输出序列的记忆。具体来说，它必须追踪任何末尾的 A 游程或 C 游程的长度。\n\n可以构建一个识别所有有效序列集合的最小确定性有限自动机（DFA）。该DFA的状态将代表必要的记忆。这些状态对应于序列中同时也是某个禁止字符串前缀的最长后缀。\n\n设状态集为 $Q = \\{S_0, S_A, S_{AA}, S_{AAA}, S_C, S_{CC}, S_{CCC}\\}$。每个状态的含义如下：\n- $S_0$: 初始状态。输出序列为空，或其后缀不是 $AAAA$ 或 $CCCC$ 的前缀。如果最后一个输出符号是 $G$ 或 $T$，则属于这种情况。\n- $S_A$: 最后一个输出是 $A$。\n- $S_{AA}$: 最后两个输出是 $AA$。\n- $S_{AAA}$: 最后三个输出是 $AAA$。\n- $S_C$: 最后一个输出是 $C$。\n- $S_{CC}$: 最后两个输出是 $CC$。\n- $S_{CCC}$: 最后三个输出是 $CCC$。\n\n这个包含7个状态的集合是最小的。要证明这一点，必须表明在 Myhill-Nerode 意义上每个状态都是可区分的。例如，一个结束于状态 $S_{AA}$ 的序列必须与一个结束于 $S_{AAA}$ 的序列区分开来，因为对于前者，追加一个 $A$ 是允许的（导致进入 $S_{AAA}$），而对于后者则是禁止的。类似的论证适用于所有状态对。\n\n自动机的转移由当前状态和下一个输出符号定义。所有状态都是接受状态，因为任何有效序列的前缀本身都是有效的。转移规则如下：\n\n- 从状态 $S_0$：\n  - 输出 $A$ 时，转移到 $S_A$。\n  - 输出 $C$ 时，转移到 $S_C$。\n  - 输出 $G$ 或 $T$ 时，转移到 $S_0$。\n\n- 从状态 $S_A$：\n  - 输出 $A$ 时，转移到 $S_{AA}$。\n  - 输出 $C$ 时，转移到 $S_C$。\n  - 输出 $G$ 或 $T$ 时，转移到 $S_0$。\n\n- 从状态 $S_{AA}$：\n  - 输出 $A$ 时，转移到 $S_{AAA}$。\n  - 输出 $C$ 时，转移到 $S_C$。\n  - 输出 $G$ 或 $T$ 时，转移到 $S_0$。\n\n- 从状态 $S_{AAA}$：\n  - 输出 $A$ 时，此转移被禁止。\n  - 输出 $C$ 时，转移到 $S_C$。\n  - 输出 $G$ 或 $T$ 时，转移到 $S_0$。\n\n- 从状态 $S_C$：\n  - 输出 $C$ 时，转移到 $S_{CC}$。\n  - 输出 $A$ 时，转移到 $S_A$。\n  - 输出 $G$ 或 $T$ 时，转移到 $S_0$。\n\n- 从状态 $S_{CC}$：\n  - 输出 $C$ 时，转移到 $S_{CCC}$。\n  - 输出 $A$ 时，转移到 $S_A$。\n  - 输出 $G$ 或 $T$ 时，转移到 $S_0$。\n\n- 从状态 $S_{CCC}$：\n  - 输出 $C$ 时，此转移被禁止。\n  - 输出 $A$ 时，转移到 $S_A$。\n  - 输出 $G$ 或 $T$ 时，转移到 $S_0$。\n\n该自动机描述了所有有效输出序列的结构。一个有限状态转换器（FST）将通过将输入符号（例如，来自二进制字母表 $\\{0,1\\}$）分配给允许的转移来构建在该自动机之上。最大信息速率是底层约束图的一个属性，与任何特定的输入分配无关。\n\n**第2部分：最大信息速率的推导**\n\n长度为 $n$ 的可接受输出字符串的数量，记作 $N(n)$，是状态转移图中从 $S_0$ 开始的长度为 $n$ 的路径总数。对于大的 $n$，$N(n)$ 渐近增长为 $N(n) \\sim k \\cdot \\lambda^n$，其中 $\\lambda$ 是图的邻接矩阵的谱半径（最大模特征值）。最大可实现信息速率，或信道容量 $C$，由适用于离散无噪声信道的 Shannon-Hartley 定理给出，即系统的拓扑熵：\n$$C = \\lim_{n\\to\\infty} \\frac{\\log_2 N(n)}{n} = \\log_2(\\lambda)$$\n\n状态转移图的邻接矩阵 $M$ 表示状态之间的单符号转移数量。设状态排序为 $(S_0, S_A, S_{AA}, S_{AAA}, S_C, S_{CC}, S_{CCC})$。矩阵 $M$ 为：\n$$ M = \\begin{pmatrix}\n2   1   0   0   1   0   0 \\\\\n2   0   1   0   1   0   0 \\\\\n2   0   0   1   1   0   0 \\\\\n2   0   0   0   1   0   0 \\\\\n2   1   0   0   0   1   0 \\\\\n2   1   0   0   0   0   1 \\\\\n2   1   0   0   0   0   0\n\\end{pmatrix} $$\n为求特征值 $\\lambda$，我们解特征方程 $\\det(M - \\lambda I) = 0$。一个更直接的方法是为结束于每个状态的路径数量建立一个递推关系系统。设 $N_i(n)$ 为长度为 $n$ 且结束于状态 $i$ 的有效序列数量。对于大的 $n$，我们假设一个指数增长形式 $N_i(n) \\approx c_i \\lambda^n$，其中 $c_i$ 为某些常数。系数 $c_i$ 的递推关系构成一个线性系统：\n让我们对系数使用简化表示法：$c_0, c_A, c_{AA}, c_{AAA}, c_C, c_{CC}, c_{CCC}$。\n从进入每个状态的转移导出的方程组是：\n$\\lambda c_0 = 2(c_0 + c_A + c_{AA} + c_{AAA} + c_C + c_{CC} + c_{CCC})$\n$\\lambda c_A = c_0 + c_C + c_{CC} + c_{CCC}$\n$\\lambda c_{AA} = c_A$\n$\\lambda c_{AAA} = c_{AA}$\n$\\lambda c_C = c_0 + c_A + c_{AA} + c_{AAA}$\n$\\lambda c_{CC} = c_C$\n$\\lambda c_{CCC} = c_{CC}$\n\n由此，我们可以用第一个系数来表示更长游程的系数：\n$c_{AA} = c_A/\\lambda$， $c_{AAA} = c_{AA}/\\lambda = c_A/\\lambda^2$。\n$c_{CC} = c_C/\\lambda$， $c_{CCC} = c_{CC}/\\lambda = c_C/\\lambda^2$。\n\n设 $g(\\lambda) = 1 + \\lambda^{-1} + \\lambda^{-2}$。关于 $c_A$ 和 $c_C$ 的方程组变为：\n$\\lambda c_A = c_0 + c_C(1 + \\lambda^{-1} + \\lambda^{-2}) = c_0 + c_C g(\\lambda)$\n$\\lambda c_C = c_0 + c_A(1 + \\lambda^{-1} + \\lambda^{-2}) = c_0 + c_A g(\\lambda)$\n\n将这两个方程相减得到 $(\\lambda + g(\\lambda))(c_A - c_C) = 0$。因为 $\\lambda  0$ 且 $g(\\lambda)  0$，我们必有 $c_A = c_C$。\n代入 $c_A = c_C$ 得到 $c_A(\\lambda - g(\\lambda)) = c_0$。\n\n关于 $c_0$ 的第一个方程涉及所有系数的总和 $\\sum_i c_i$。\n$\\sum_i c_i = c_0 + c_A(1+\\lambda^{-1}+\\lambda^{-2}) + c_C(1+\\lambda^{-1}+\\lambda^{-2}) = c_0 + 2c_A g(\\lambda)$。\n所以，$\\lambda c_0 = 2(c_0 + 2c_A g(\\lambda))$，这意味着 $(\\lambda - 2)c_0 = 4c_A g(\\lambda)$。\n\n我们现在得到一个关于 $c_0$ 和 $c_A$ 的二元方程组：\n1) $c_A(\\lambda - g(\\lambda)) = c_0$\n2) $(\\lambda - 2)c_0 = 4c_A g(\\lambda)$\n\n为得到非平凡解（$c_A \\ne 0, c_0 \\ne 0$），将 (1) 代入 (2)：\n$(\\lambda - 2)c_A(\\lambda - g(\\lambda)) = 4c_A g(\\lambda)$\n$(\\lambda - 2)(\\lambda - g(\\lambda)) = 4g(\\lambda)$\n$\\lambda(\\lambda - 2) - (\\lambda - 2)g(\\lambda) = 4g(\\lambda)$\n$\\lambda(\\lambda - 2) = (4 + \\lambda - 2)g(\\lambda) = (\\lambda + 2)g(\\lambda)$\n\n代入 $g(\\lambda) = 1 + \\lambda^{-1} + \\lambda^{-2} = \\frac{\\lambda^2+\\lambda+1}{\\lambda^2}$：\n$\\lambda(\\lambda - 2) = (\\lambda + 2)\\frac{\\lambda^2+\\lambda+1}{\\lambda^2}$\n两边乘以 $\\lambda^2$：\n$\\lambda^3(\\lambda - 2) = (\\lambda + 2)(\\lambda^2 + \\lambda + 1)$\n$\\lambda^4 - 2\\lambda^3 = \\lambda^3 + \\lambda^2 + \\lambda + 2\\lambda^2 + 2\\lambda + 2$\n$\\lambda^4 - 2\\lambda^3 = \\lambda^3 + 3\\lambda^2 + 3\\lambda + 2$\n这简化为关于 $\\lambda$ 的特征多项式：\n$$ \\lambda^4 - 3\\lambda^3 - 3\\lambda^2 - 3\\lambda - 2 = 0 $$\n根据 Perron-Frobenius 定理，这个不可约且非周期的系统有一个唯一的正实数特征值 $\\lambda$，它决定了增长率。\n\n**第3部分：信息速率的数值计算**\n\n多项式 $\\lambda^4 - 3\\lambda^3 - 3\\lambda^2 - 3\\lambda - 2 = 0$ 没有简单的解析根，必须进行数值求解。从任何状态出发的最大选择数为4，所以 $\\lambda \\le 4$。\n设 $P(\\lambda) = \\lambda^4 - 3\\lambda^3 - 3\\lambda^2 - 3\\lambda - 2$。\n$P(3) = 81 - 81 - 27 - 9 - 2 = -38$。\n$P(4) = 256 - 192 - 48 - 12 - 2 = 2$。\n根 $\\lambda$ 位于 3 和 4 之间。数值方法（如 Newton 法或二分法）得到解：\n$$\\lambda \\approx 3.97436$$\n然后，最大可实现编码速率 $C$ 以比特/核苷酸为单位计算：\n$$C = \\log_2(\\lambda) = \\log_2(3.97436)$$\n$$ C \\approx 1.99105 $$\n四舍五入到4位有效数字，容量为 1.991 比特/核苷酸。这代表了在给定约束下，每个DNA碱基可编码的信息量的理论上限。", "answer": "$$\\boxed{1.991}$$", "id": "2730426"}, {"introduction": "从DNA中检索数据几乎总是需要通过聚合酶链式反应（PCR）来扩增寡核苷酸，以获得足够测序的材料。然而，PCR过程中使用的DNA聚合酶并非完美无瑕，它们会在复制过程中引入错误，主要是替换错误。本练习提供了一个机会，通过构建一个马尔可夫链模型，来定量地模拟这些替换错误在多个扩增周期中如何累积。通过计算扩增后分子中预期的错误数量，我们可以更好地预测检索数据的保真度，并为设计更可靠的纠错策略提供依据。[@problem_id:2730491]", "problem": "在一个基于脱氧核糖核酸（DNA）的数据存储系统中，数据读取通常需要通过聚合酶链式反应（PCR）扩增短寡核苷酸，以获得足够的材料进行测序。考虑一个长度为 $L = 200$ 个核苷酸的单链目标序列，该序列初始时没有错误。设 $p_{\\text{pol}}$ 表示在DNA聚合酶延伸过程中，每个碱基每次复制发生替换错误的概率，并假设此概率在所有循环和位置上均为常数。假设以下条件，这些条件基于DNA聚合酶的标准保真度模型：\n- 在每次复制事件中，对于任意给定的核苷酸位置，以概率 $p_{\\text{pol}}$ 发生一次相对于模板的替换，以概率 $1 - p_{\\text{pol}}$ 该核苷酸被与模板完全相同地复制。\n- 在某个位置发生替换的条件下，错配掺入的核苷酸是与模板碱基不同的3种核苷酸中的任意一种的概率相等。\n- 不发生插入和删除，且不同核苷酸位置的行为是相互独立的。\n- 从单个初始模板开始，经过 $c$ 个PCR循环后，你从群体中均匀随机地抽取一个扩增子，因此从原始模板到所抽样扩增子的谱系中，每个位置都恰好经历了 $c$ 次复制事件。\n\n仅使用基本概率法则和关于单个核苷酸相对于原始模板的正确性状态的马尔可夫推理，从第一性原理推导出一个闭式表达式，用于计算经过 $c$ 个循环后，在抽样的长度为 $L = 200$ 的核苷酸扩增子中核苷酸替换的期望数量，该表达式应为 $p_{\\text{pol}}$ 和 $c$ 的函数。将你的最终答案表示为关于 $p_{\\text{pol}}$ 和 $c$ 的单一简化解析表达式。不要进行四舍五入。", "solution": "所给出的问题陈述具有科学依据、表述清晰且客观。它提供了一个简化但标准的模型，用于描述聚合酶链式反应（PCR）过程中的错误累积，这是合成生物学和生物信息学中的一个常见问题。诸如核苷酸位置的独立性以及不存在插入和删除等假设，是构建一个易于处理的数学模型的可接受的理想化。所有求解唯一解所需的必要参数均已提供。因此，该问题是有效的，可以进行严谨的推导。\n\n目标是求出经过 $c$ 轮扩增后，在长度为 $L=200$ 个核苷酸的DNA扩增子中，核苷酸替换的期望数量，记为 $E[N]$。\n\n问题陈述中指出，不同的核苷酸位置是相互独立的。这个假设至关重要。它允许我们先分析单个核苷酸位置，然后将结果推广到整条DNA链的长度。设 $X_i$ 为第 $i$ 个核苷酸位置的指示随机变量，如果该位置的核苷酸是替换（即与原始模板不同），则 $X_i=1$，如果正确，则 $X_i=0$。总的替换数量为 $N = \\sum_{i=1}^{L} X_i$。\n\n根据期望的线性性，总替换数量的期望值是各个指示变量期望值之和：\n$$E[N] = E\\left[\\sum_{i=1}^{L} X_i\\right] = \\sum_{i=1}^{L} E[X_i]$$\n指示变量的期望值是其所指示事件的概率。因此，$E[X_i] = P(X_i=1)$。由于所有位置的错误过程都相同，这个概率对于所有的 $i$ 都是一样的。我们将其记为 $P_{\\text{err}}(c)$，即单个核苷酸位点在 $c$ 个循环后处于错误状态的概率。因此，替换数量期望值的表达式简化为：\n$$E[N] = L \\cdot P_{\\text{err}}(c)$$\n\n现在我们使用指定的马尔可夫推理来确定 $P_{\\text{err}}(c)$。考虑单个核苷酸位置。在任何一个循环中，相对于原始模板，该位置可以处于以下两种状态之一：\n- 状态 $S_0$：核苷酸是正确的（与原始模板相同）。\n- 状态 $S_1$：核苷酸是不正确的（已被替换）。\n\n设 $P_0(c)$ 是核苷酸在 $c$ 个循环后处于状态 $S_0$ 的概率， $P_1(c)$ 是其在 $c$ 个循环后处于状态 $S_1$ 的概率。根据定义，$P_1(c) = P_{\\text{err}}(c)$ 且 $P_0(c) + P_1(c) = 1$。初始模板是无错误的，因此在循环 $c=0$ 时，我们有 $P_0(0)=1$ 和 $P_1(0)=0$。\n\n所抽样扩增子的谱系恰好包含 $c$ 次复制事件。我们可以将从循环 $c$ 到 $c+1$ 的状态演化建模为一个离散时间马尔可夫过程。我们需要求出一步转移概率。\n1.  从 $S_0$ 转移：如果一个位点在循环 $c$ 时是正确的（处于状态 $S_0$），那么如果在复制时没有发生错误，它在循环 $c+1$ 时将保持正确。这种情况发生的概率是 $1 - p_{\\text{pol}}$。如果发生替换，它将变为不正确（转移到 $S_1$），其概率为 $p_{\\text{pol}}$。\n2.  从 $S_1$ 转移：如果一个位点在循环 $c$ 时是不正确的（处于状态 $S_1$），其在循环 $c+1$ 时的状态取决于下一次复制事件。\n    - 如果它被正确复制（概率为 $1-p_{\\text{pol}}$），或者发生替换，变成了另外2种不正确的碱基之一，那么它将保持不正确。从一个不正确的碱基替换为另一个特定的不正确碱基的概率是 $p_{\\text{pol}} \\times \\frac{1}{3}$。所以，替换为另外2种不正确的碱基中任意一种的概率是 $p_{\\text{pol}} \\times \\frac{2}{3}$。\n    - 只有当发生替换 *并且* 新碱基恰好是原始的正确碱基时，它才会变回正确（转移到 $S_0$）。在发生替换的条件下，有3种等概率的结果。这种特定的“回复突变”的概率是 $p_{\\text{pol}} \\times \\frac{1}{3}$。\n\n因此，转移概率为：\n- $P(S_{c+1}=S_0 | S_c=S_0) = 1 - p_{\\text{pol}}$\n- $P(S_{c+1}=S_1 | S_c=S_0) = p_{\\text{pol}}$\n- $P(S_{c+1}=S_0 | S_c=S_1) = \\frac{1}{3}p_{\\text{pol}}$\n- $P(S_{c+1}=S_1 | S_c=S_1) = (1 - p_{\\text{pol}}) + p_{\\text{pol}}\\frac{2}{3} = 1 - \\frac{1}{3}p_{\\text{pol}}$\n\n我们可以为 $P_0(c)$，即保持正确的概率，写出递推关系：\n$$P_0(c+1) = P_0(c) \\cdot P(S_{c+1}=S_0 | S_c=S_0) + P_1(c) \\cdot P(S_{c+1}=S_0 | S_c=S_1)$$\n代入转移概率并使用 $P_1(c) = 1 - P_0(c)$：\n$$P_0(c+1) = P_0(c) (1 - p_{\\text{pol}}) + (1 - P_0(c)) \\left(\\frac{1}{3}p_{\\text{pol}}\\right)$$\n$$P_0(c+1) = P_0(c) - p_{\\text{pol}}P_0(c) + \\frac{1}{3}p_{\\text{pol}} - \\frac{1}{3}p_{\\text{pol}}P_0(c)$$\n$$P_0(c+1) = P_0(c) \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right) + \\frac{1}{3}p_{\\text{pol}}$$\n这是一个线性一阶递推关系。让我们通过设 $P_0(c+1) = P_0(c) = P_{0, \\text{eq}}$ 来求其不动点 $P_{0, \\text{eq}}$：\n$$P_{0, \\text{eq}} = P_{0, \\text{eq}} \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right) + \\frac{1}{3}p_{\\text{pol}}$$\n$$P_{0, \\text{eq}} \\left(1 - \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)\\right) = \\frac{1}{3}p_{\\text{pol}}$$\n$$P_{0, \\text{eq}} \\left(\\frac{4}{3}p_{\\text{pol}}\\right) = \\frac{1}{3}p_{\\text{pol}}$$\n对于 $p_{\\text{pol}} \\neq 0$，保持正确的平衡概率是 $P_{0, \\text{eq}} = \\frac{1}{4}$。这是符合预期的，因为在经过无限次循环后，任何一个位置上出现4种核苷酸中任意一种的概率都应该是相等的。\n\n递推式 $P_0(c+1) = a P_0(c) + b$ 的通解是 $P_0(c) = A \\cdot a^c + P_{0, \\text{eq}}$，其中 $a = 1 - \\frac{4}{3}p_{\\text{pol}}$。我们使用初始条件 $P_0(0)=1$ 来求出常数 $A$：\n$$1 = A \\cdot \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^0 + \\frac{1}{4}$$\n$$1 = A + \\frac{1}{4} \\implies A = \\frac{3}{4}$$\n一个位点在 $c$ 个循环后保持正确的概率是：\n$$P_0(c) = \\frac{3}{4} \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^c + \\frac{1}{4}$$\n因此，发生错误的概率 $P_{\\text{err}}(c) = P_1(c)$ 是：\n$$P_{\\text{err}}(c) = 1 - P_0(c) = 1 - \\left[\\frac{3}{4} \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^c + \\frac{1}{4}\\right]$$\n$$P_{\\text{err}}(c) = \\frac{3}{4} - \\frac{3}{4} \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^c = \\frac{3}{4} \\left[1 - \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^c\\right]$$\n最后，我们计算长度为 $L=200$ 的扩增子中替换的期望数量：\n$$E[N] = L \\cdot P_{\\text{err}}(c) = 200 \\cdot \\frac{3}{4} \\left[1 - \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^c\\right]$$\n$$E[N] = 150 \\left[1 - \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^c\\right]$$\n这就是关于聚合酶错误率 $p_{\\text{pol}}$ 和循环次数 $c$ 的函数，表示期望替换数量的闭式表达式。", "answer": "$$\n\\boxed{150 \\left(1 - \\left(1 - \\frac{4}{3}p_{\\text{pol}}\\right)^{c}\\right)}\n$$", "id": "2730491"}, {"introduction": "即使DNA的合成和扩增过程完美无缺，数据仍可能在最终的测序环节丢失。高通量测序本质上是一个随机采样过程，池中的某些DNA分子可能根本未被测序仪捕获到，这种现象被称为“信息丢失”或“脱靶”（dropout）。本练习探讨了这一采样过程的概率基础，让您能够从第一性原理出发，推导出特定寡核苷酸完全丢失的概率。这个概率是测序深度的函数，而测序深度是确保数据完全恢复的关键参数。[@problem_id:2730425]", "problem": "一个基于DNA的存档系统将数字信息编码到一个充分混合的池中，该池包含 $M$ 种独特的寡核苷酸，每种寡核苷酸的摩尔丰度相等。一次测序运行执行 $R$ 次独立的读取事件。对于每次读取事件，都会捕获并测序一个分子。假设无偏采样、无扩增偏差或读取间的依赖性，在任何给定事件中捕获到特定目标寡核苷酸的概率为 $1/M$。定义每个寡核苷酸的平均覆盖度为 $\\lambda = R/M$。在 $M \\to \\infty$ 和 $R \\to \\infty$ 而 $\\lambda$ 保持不变的大型文库和深度测序的渐近情况下，根据大规模并行测序的标准独立采样假设，映射到任何给定寡核苷酸的读取数被建模为平均值为 $\\lambda$ 的泊松计数。\n\n从独立的伯努利采样模型出发，并且不借助任何预先给定的目标公式，请从第一性原理推导，在测序输出中完全缺失某个特定寡核苷酸（即，获得 $0$ 次读取）的极限概率，该概率是 $\\lambda$ 的函数。请以 $\\lambda$ 的单个闭式解析表达式形式提供您的最终结果。不需要数值近似或四舍五入，并且由于这是一个概率，因此不需要单位。", "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且客观的。它提出了一个与基因组学和合成生物学相关的概率建模中的标准且非平凡的问题。我们将按要求从第一性原理开始推导。\n\n从一个大池中对分子进行测序的过程可以建模为一系列独立的试验。我们考虑从包含 $M$ 种独特类型的池中取出一个特定的寡核苷酸。对于 $R$ 次独立读取事件中的每一次，我们将“成功”定义为我们特定的寡核苷酸被捕获并测序的事件。\n\n鉴于池是充分混合的，并且所有 $M$ 种寡核苷酸的摩尔丰度相等，任何单次试验中成功的概率是 $p = \\frac{1}{M}$。因此，“失败”（测序到其他 $M-1$ 种寡核苷酸中的任意一种）的概率是 $q = 1 - p = 1 - \\frac{1}{M}$。\n\n总读取数 $R$ 构成了独立 Bernoulli 试验的次数。因此，映射到我们特定寡核苷酸的读取数（我们用随机变量 $k$ 表示）服从参数为 $n=R$ 和 $p=\\frac{1}{M}$ 的二项分布。观察到恰好 $k$ 次读取的概率质量函数由下式给出：\n$$P(k) = \\binom{R}{k} p^k (1-p)^{R-k} = \\binom{R}{k} \\left(\\frac{1}{M}\\right)^k \\left(1 - \\frac{1}{M}\\right)^{R-k}$$\n问题要求的是寡核苷酸“完全缺失”的概率，这对应于它获得 $k=0$ 次读取的情况。我们将 $k=0$ 代入二项概率质量函数：\n$$P(k=0) = \\binom{R}{0} \\left(\\frac{1}{M}\\right)^0 \\left(1 - \\frac{1}{M}\\right)^{R-0}$$\n根据定义，$\\binom{R}{0} = 1$ 并且对于任何非零底数，$x^0 = 1$。这可将表达式简化为：\n$$P(k=0) = \\left(1 - \\frac{1}{M}\\right)^R$$\n这个公式给出了在有限的 $M$ 和 $R$ 下的精确概率。然而，问题指定了一个渐近情况，其中 $M \\to \\infty$ 且 $R \\to \\infty$，而每个寡核苷酸的平均覆盖度 $\\lambda = \\frac{R}{M}$ 保持为一个固定常数。\n\n为了求极限概率，我们首先用 $M$ 和常数 $\\lambda$ 来表示 $R$：$R = \\lambda M$。我们将其代入 $P(k=0)$ 的表达式中：\n$$P(k=0) = \\left(1 - \\frac{1}{M}\\right)^{\\lambda M}$$\n我们现在必须评估当 $M \\to \\infty$ 时此表达式的极限。设极限概率为 $P_0$。\n$$P_0 = \\lim_{M \\to \\infty} \\left(1 - \\frac{1}{M}\\right)^{\\lambda M}$$\n利用指数性质 $(a^b)^c = a^{bc}$，我们可以将表达式重写为：\n$$P_0 = \\lim_{M \\to \\infty} \\left[ \\left(1 - \\frac{1}{M}\\right)^M \\right]^{\\lambda}$$\n这种形式包含一个著名的极限，该极限是指数函数的一个基本定义：\n$$\\lim_{n \\to \\infty} \\left(1 + \\frac{x}{n}\\right)^n = \\exp(x)$$\n在我们的情况下，我们设置变量 $n=M$ 和常数 $x=-1$。因此，我们表达式内部部分的极限是：\n$$\\lim_{M \\to \\infty} \\left(1 - \\frac{1}{M}\\right)^M = \\lim_{M \\to \\infty} \\left(1 + \\frac{-1}{M}\\right)^M = \\exp(-1)$$\n由于对于固定的 $\\lambda$ 函数 $f(y) = y^{\\lambda}$ 是连续的，因此函数的极限等于极限的函数。因此，我们可以将内部极限的结果代回到我们关于 $P_0$ 的表达式中：\n$$P_0 = \\left[ \\lim_{M \\to \\infty} \\left(1 - \\frac{1}{M}\\right)^M \\right]^{\\lambda} = \\left(\\exp(-1)\\right)^{\\lambda}$$\n再次应用指数规则，我们得到最终的表达式：\n$$P_0 = \\exp(-\\lambda)$$\n这个结果表示特定寡核苷酸获得零次读取的极限概率，它是平均覆盖度 $\\lambda$ 的函数。这个从基本 Bernoulli 试验模型开始的推导，严格地确立了所要求的概率，而没有预先假定泊松分布，尽管结果确实是平均值为 $\\lambda$ 的泊松随机变量取零值的概率。", "answer": "$$\\boxed{\\exp(-\\lambda)}$$", "id": "2730425"}]}