{"hands_on_practices": [{"introduction": "精确地对基因线路进行数学建模，是进行形式验证的第一步。这个练习将指导你为一个混合系统（包含离散和连续状态）构建数学基础，这种系统被称为分段确定性马尔可夫过程（PDMP），它能够真实地模拟基因调控的动态。通过推导该系统的无穷小生成元（infinitesimal generator），你将掌握分析这类混合系统行为的核心工具 [@problem_id:2739322]。", "problem": "一个单基因自抑制回路被建模为一个随机混合系统，即分段确定性马尔可夫过程 (PDMP)。离散的启动子状态为 $s \\in \\{0,1\\}$，其中 $s=0$ 表示非活性，$s=1$ 表示活性。连续状态是蛋白质浓度 $x \\in [0,\\infty)$。在启动子切换之间，$x$ 根据 $\\dot{x}(t)=f_{s}(x(t))$ 进行确定性演化，其中 $f_{s}(x)=k_{s}-\\gamma x$，且 $k_{0}=0$，$k_{1}=k_{p}$，$k_{p},\\gamma>0$。启动子从 $0 \\to 1$ 和 $1 \\to 0$ 的切换分别由依赖于状态的速率 $q_{0\\to 1}(x)$ 和 $q_{1\\to 0}(x)$ 控制，其表达式为\n$$\nq_{0\\to 1}(x)=\\frac{k_{\\mathrm{on}}}{1+(x/K)^{n}}, \\quad q_{1\\to 0}(x)=k_{\\mathrm{off}},\n$$\n其中 $k_{\\mathrm{on}},k_{\\mathrm{off}},K>0$ 且 $n \\in \\mathbb{N}$。在此模型中，启动子切换不会瞬时改变 $x$。设 $\\varphi$ 是一个有界的、连续可微的检验函数 $\\varphi:\\{0,1\\}\\times[0,\\infty)\\to\\mathbb{R}$，且在 $x$ 上是 $C^{1}$ 的。\n\n根据马尔可夫过程无穷小生成元的定义和 PDMP 的语义（由依赖于状态的马尔可夫跳跃中断的确定性流），选择一个选项，该选项正确地指定了作用于 $\\varphi$ 的无穷小生成元 $\\mathcal{L}$，并同时通过强度和跳跃后马尔可夫核或等效的跳跃速率测度正确地刻画了跳跃机制。使用约定，若 $s'=s$，则 $q_{s\\to s'}(x)=0$，并用 $\\mathbb{1}_{A}$ 表示事件 $A$ 的指示函数。\n\nA. \n$$\n\\big(\\mathcal{L}\\varphi\\big)(s,x)=\\partial_{x}\\varphi(s,x)\\,\\big(k_{s}-\\gamma x\\big)+\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s',x)-\\varphi(s,x)\\big],\n$$\n其跳跃强度为\n$$\n\\lambda(s,x)=\\sum_{s'\\neq s}q_{s\\to s'}(x),\n$$\n跳跃后马尔可夫核 $Q$ 在 $\\{0,1\\}\\times[0,\\infty)$ 上由下式给出\n$$\nQ\\big((s,x),\\{s'\\}\\times B\\big)=\\frac{q_{s\\to s'}(x)}{\\lambda(s,x)}\\,\\mathbb{1}_{\\{x\\in B\\}},\n$$\n对于任何 Borel 集 $B\\subseteq[0,\\infty)$，因此连续坐标在跳跃时保持不变。等价地，未归一化的跳跃速率测度为\n$$\nJ\\big((s,x),\\mathrm{d}s'\\,\\mathrm{d}y\\big)=\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\delta_{s'}(\\mathrm{d}s')\\,\\delta_{x}(\\mathrm{d}y).\n$$\n\nB.\n$$\n\\big(\\mathcal{L}\\varphi\\big)(s,x)=\\partial_{x}\\varphi(s,x)\\,\\big(k_{s}-\\gamma x\\big)+\\tfrac{1}{2}\\sigma^{2}\\,\\partial_{x}^{2}\\varphi(s,x)+\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s',x)-\\varphi(s,x)\\big],\n$$\n其中 $\\sigma>0$，跳跃强度 $\\lambda(s,x)=\\sum_{s'\\neq s}q_{s\\to s'}(x)$，跳跃后核 $Q$ 如选项 A 所示。\n\nC.\n$$\n\\big(\\mathcal{L}\\varphi\\big)(s,x)=\\partial_{x}\\varphi(s,x)\\,\\big(k_{s}+\\gamma x\\big)+\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s,x)-\\varphi(s',x)\\big],\n$$\n其跳跃强度为 $\\lambda(s,x)=\\max_{s'\\neq s}q_{s\\to s'}(x)$，跳跃后核为 $Q\\big((s,x),\\{s'\\}\\times B\\big)=\\mathbb{1}_{\\{x\\in B\\}}\\,\\mathbb{1}_{\\{s'\\neq s\\}}/2$。\n\nD.\n$$\n\\big(\\mathcal{L}\\varphi\\big)(s,x)=\\partial_{x}\\varphi(s,x)\\,\\big(k_{s}-\\gamma x\\big)+\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s',0)-\\varphi(s,x)\\big],\n$$\n其跳跃强度为 $\\lambda(s,x)=\\sum_{s'\\neq s}q_{s\\to s'}(x)$，跳跃后核为 $Q\\big((s,x),\\{s'\\}\\times B\\big)=\\frac{q_{s\\to s'}(x)}{\\lambda(s,x)}\\,\\mathbb{1}_{\\{0\\in B\\}}$。\n\n选择正确的选项。", "solution": "该问题要求找出为单基因自抑制回路建模的分段确定性马尔可夫过程 (PDMP) 的无穷小生成元 $\\mathcal{L}$。我将首先验证问题陈述，然后推导生成元的正确表达式并评估给定的选项。\n\n问题陈述描述了一个具有离散状态 $s \\in \\{0,1\\}$ 和连续状态 $x \\in [0,\\infty)$ 的随机混合系统。其动力学由确定性流和随机跳跃组成。\n给定的条件是：\n- 离散状态空间：$\\{0,1\\}$。\n- 连续状态空间：$[0,\\infty)$。\n- 连续变量 $x$ 的确定性流：$\\dot{x}(t) = f_s(x(t))$，其中 $f_s(x) = k_s - \\gamma x$。\n- 流的参数：$k_0=0$，$k_1=k_p$，其中 $k_p > 0$ 且 $\\gamma > 0$。\n- 依赖于状态的离散变量 $s$ 的跳跃速率：$q_{0\\to 1}(x) = \\frac{k_{\\mathrm{on}}}{1+(x/K)^n}$ 和 $q_{1\\to 0}(x) = k_{\\mathrm{off}}$。\n- 速率的参数：$k_{\\mathrm{on}} > 0$，$k_{\\mathrm{off}} > 0$，$K > 0$，$n \\in \\mathbb{N}$。\n- 跳跃条件：在离散状态 $s$ 发生跳跃的瞬间，连续状态 $x$ 不变。\n- 提供了一个检验函数 $\\varphi(s,x)$，它在 $x$ 上是 $C^1$ 的。\n\n该问题具有坚实的科学基础，代表了一个标准的带有自抑制的基因表达“双态”模型。它在数学上是适定的，因为 PDMP 的所有组成部分（流、跳跃速率和跳跃后测度）都已明确指定，从而可以唯一地确定其无穷小生成元。语言精确客观。该问题是有效的。\n\n作用于一个合适的检验函数 $\\varphi$ 的马尔可夫过程的无穷小生成元 $\\mathcal{L}$ 定义为\n$$\n(\\mathcal{L}\\varphi)(z) = \\lim_{t\\to 0^+} \\frac{\\mathbb{E}[\\varphi(Z_t) | Z_0=z] - \\varphi(z)}{t},\n$$\n其中 $z=(s,x)$ 是过程的状态。对于 PDMP，生成元由两部分组成：一部分对应于确定性流，另一部分对应于随机跳跃。\n\n设系统的状态为 $(s,x)$。\n1.  **确定性流部分**：在跳跃之间，系统根据常微分方程 (ODE) $\\dot{x} = f_s(x)$ 演化。由该流引起的 $\\varphi$ 的变化由 $\\varphi$ 沿着流的向量场 $(0, f_s(x))$（在状态空间 $\\{0,1\\}\\times[0,\\infty)$ 中）的方向导数给出。这得到了以下项：\n    $$\n    (\\mathcal{L}_{\\text{flow}}\\varphi)(s,x) = \\nabla\\varphi(s,x) \\cdot (0, f_s(x)) = \\partial_x \\varphi(s,x) f_s(x) = \\partial_x \\varphi(s,x) (k_s - \\gamma x).\n    $$\n\n2.  **随机跳跃部分**：离散状态从 $s$ 到 $s'$ 的跳跃以速率 $q_{s \\to s'}(x)$ 发生。离开状态 $(s,x)$ 的总速率是跳跃强度 $\\lambda(s,x) = \\sum_{s' \\neq s} q_{s \\to s'}(x)$。问题陈述指出，在从 $s$ 到 $s'$ 的跳跃发生时，连续变量 $x$ 保持不变。因此，状态从 $(s,x)$ 转换到 $(s',x)$。生成元的跳跃部分捕捉了由于这些跳跃而导致的 $\\varphi$ 的期望变化。对于从 $s$ 到 $s'$ 的一次跳跃，函数值的变化是 $\\varphi(s',x) - \\varphi(s,x)$。这次跳跃的速率是 $q_{s\\to s'}(x)$。对所有可能的目标状态 $s' \\neq s$ 求和，我们得到跳跃部分：\n    $$\n    (\\mathcal{L}_{\\text{jump}}\\varphi)(s,x) = \\sum_{s' \\neq s} q_{s \\to s'}(x) [\\varphi(s',x) - \\varphi(s,x)].\n    $$\n\n结合这两个部分，完整的无穷小生成元是：\n$$\n(\\mathcal{L}\\varphi)(s,x) = (\\mathcal{L}_{\\text{flow}}\\varphi)(s,x) + (\\mathcal{L}_{\\text{jump}}\\varphi)(s,x) = \\partial_x \\varphi(s,x) (k_s - \\gamma x) + \\sum_{s' \\neq s} q_{s \\to s'}(x) [\\varphi(s',x) - \\varphi(s,x)].\n$$\n\n跳跃机制可以进一步由跳跃强度 $\\lambda(s,x)$ 和跳跃后转移核 $Q$ 来刻画。\n- **跳跃强度** 是从状态 $(s,x)$ 跳出的总速率：\n  $$\n  \\lambda(s,x) = \\sum_{s' \\neq s} q_{s \\to s'}(x).\n  $$\n- **跳跃后转移核** $Q((s,x), A)$ 给出了在从 $(s,x)$ 发生跳跃的条件下，新状态属于集合 $A \\subseteq \\{0,1\\}\\times[0,\\infty)$ 的概率。跳跃到特定状态 $s'$ 的概率是 $\\frac{q_{s\\to s'}(x)}{\\lambda(s,x)}$。由于 $x$ 不变，跳跃后的连续变量是 $x$ 的概率为 1。这由狄拉克测度 $\\delta_x$ 表示。因此，对于目标集 $\\{s'\\} \\times B$，其中 $B$ 是 $[0,\\infty)$ 的一个 Borel 子集：\n  $$\n  Q((s,x), \\{s'\\} \\times B) = \\frac{q_{s\\to s'}(x)}{\\lambda(s,x)} \\mathbb{1}_{\\{x \\in B\\}}.\n  $$\n一个等价的刻画是**未归一化的跳跃速率测度** $J((s,x), \\mathrm{d}s' \\mathrm{d}y)$，它结合了速率和跳跃后的位置：\n$$\nJ((s,x), \\mathrm{d}s' \\mathrm{d}y) = \\lambda(s,x) Q((s,x), \\mathrm{d}s' \\mathrm{d}y) = \\sum_{s'\\neq s} q_{s\\to s'}(x) \\delta_{s'}(\\mathrm{d}s') \\delta_x(\\mathrm{d}y).\n$$\n该测度表明，如果 $y=x$ 且 $s' \\neq s$，则从 $(s,x)$ 到 $(s',y)$ 的跳跃以速率 $q_{s \\to s'}(x)$ 发生，否则速率为 0。\n\n现在，我评估每个选项。\n\n**A.** 提出的生成元是：\n$$\n\\big(\\mathcal{L}\\varphi\\big)(s,x)=\\partial_{x}\\varphi(s,x)\\,\\big(k_{s}-\\gamma x\\big)+\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s',x)-\\varphi(s,x)\\big].\n$$\n这与推导出的生成元完全匹配。跳跃强度 $\\lambda(s,x)$、跳跃后核 $Q$ 以及跳跃速率测度 $J$ 的表述也与上面推导的完全一样。根据 PDMP 的理论和问题规范，该选项的所有组成部分都是正确的。\n结论：**正确**。\n\n**B.** 提出的生成元包含一个二阶导数项 $\\tfrac{1}{2}\\sigma^{2}\\,\\partial_{x}^{2}\\varphi(s,x)$。该项是扩散过程（例如布朗运动）的生成元。然而，问题明确指出，在跳跃之间 $x$ 的演化是*确定性的*，由一个常微分方程 $\\dot{x}(t)=f_{s}(x(t))$ 控制。确定性过程没有扩散分量。因此，二阶空间导数的存在与分段**确定性**马尔可夫过程的问题定义从根本上不一致。\n结论：**不正确**。\n\n**C.** 提出的生成元有两个错误。首先，流项被给出为 $\\partial_{x}\\varphi(s,x)\\,\\big(k_{s}+\\gamma x\\big)$，这意味着流是 $\\dot{x} = k_s + \\gamma x$。这是不正确的；降解项 $-\\gamma x$ 的符号错误。其次，跳跃项是 $\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s,x)-\\varphi(s',x)\\big]$，它是正确项的负值。此外，将跳跃强度描述为 $\\max_{s'\\neq s}q_{s\\to s'}(x)$ 在定义上是不正确的（尽管对于双态系统它会产生相同的结果），并且跳跃后核 $Q\\big((s,x),\\{s'\\}\\times B\\big)=\\mathbb{1}_{\\{x\\in B\\}}\\,\\mathbb{1}_{\\{s'\\neq s\\}}/2$ 是任意且不正确的；它没有像应有的那样依赖于具体的速率 $q_{s \\to s'}(x)$。\n结论：**不正确**。\n\n**D.** 提出的生成元是：\n$$\n\\big(\\mathcal{L}\\varphi\\big)(s,x)=\\partial_{x}\\varphi(s,x)\\,\\big(k_{s}-\\gamma x\\big)+\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s',0)-\\varphi(s,x)\\big].\n$$\n跳跃项 $\\sum_{s'\\neq s}q_{s\\to s'}(x)\\,\\big[\\varphi(s',0)-\\varphi(s,x)\\big]$ 意味着在跳跃时，连续状态 $x$ 被重置为 $0$。这也反映在所提出的跳跃后核 $Q\\big((s,x),\\{s'\\}\\times B\\big)=\\frac{q_{s\\to s'}(x)}{\\lambda(s,x)}\\,\\mathbb{1}_{\\{0\\in B\\}}$ 中，它将跳跃后连续变量的概率质量置于 $y=0$。这与问题陈述中“在此模型中，启动子切换不会瞬时改变 $x$”的明确说明相矛盾。该说明要求跳跃后的状态为 $(s',x)$，而不是 $(s',0)$。\n结论：**不正确**。\n\n只有选项 A 为指定 PDMP 模型的无穷小生成元和跳跃机制提供了完全正确的描述。", "answer": "$$\\boxed{A}$$", "id": "2739322"}, {"introduction": "对于参数化的模型，符号分析（symbolic analysis）是一种极其强大的验证技术，它能让我们以参数函数的形式推导出系统属性。这个练习将带你通过一个具体的启动子调控模型，运用状态消除法来精确计算一个关键的“可达性概率” [@problem_id:2739288]。这种方法使我们能够深入理解系统设计的内在原理，而无需为每个参数组合都进行数值模拟。", "problem": "一个合成启动子受一个竞争性激活子和一个阻遏子的调控，其随机的结合、解离和定型事件被建模为连续时间马尔可夫链 (CTMC)。该启动子可以处于五种状态之一：未结合的基态 $S_{0}$、激活子结合态 $S_{A}$、阻遏子结合态 $S_{R}$、一个吸收性的转录定型态 $G$（目标）和一个吸收性的阻遏定型态 $F$（失败）。该 CTMC 的转移参数如下，所有参数均为严格正数：\n- 从 $S_{0}$：以速率 $k_{a}$ 发生激活子结合，转移到 $S_{A}$；以速率 $k_{r}$ 发生阻遏子结合，转移到 $S_{R}$。\n- 从 $S_{A}$：以速率 $u_{a}$ 发生激活子解离，转移到 $S_{0}$；以速率 $c_{a}$ 发生转录定型，转移到 $G$。\n- 从 $S_{R}$：以速率 $u_{r}$ 发生阻遏子解离，转移到 $S_{0}$；以速率 $c_{r}$ 发生阻遏定型，转移到 $F$。\n- 状态 $G$ 和 $F$ 是吸收态。\n\n假设系统从 $S_{0}$ 开始。在 CTMC 中，最终到达 $G$ 而非 $F$ 的概率仅取决于通过对每个非吸收态的出射速率进行归一化而导出的嵌入式离散时间马尔可夫链 (DTMC)。以此事实为基础出发点，结合马尔可夫链的定义和用于可达性的标准状态消除构造，完成以下操作：\n1. 为瞬时态 $\\{S_{0}, S_{A}, S_{R}\\}$ 和吸收态 $\\{G, F\\}$ 构建嵌入式 DTMC，将每个转移概率表示为 CTMC 速率 $k_{a}, k_{r}, u_{a}, u_{r}, c_{a}, c_{r}$ 的有理函数。\n2. 在嵌入式 DTMC 上使用状态消除法，先消除 $S_{A}$ 再消除 $S_{R}$，以获得一个在 $\\{S_{0}, G, F\\}$ 上的等价 DTMC，其转移是参数的有理函数。然后，从得到的单瞬时态 DTMC 中，推导出可达性概率 $\\Pr(\\lozenge G \\text{ before } F \\mid S_{0})$ 的一个闭式解析表达式，形式为关于 $k_{a}, k_{r}, u_{a}, u_{r}, c_{a}, c_{r}$ 的单一简化有理函数。\n\n以单一闭式表达式的形式提供最终答案。无需进行数值计算。不要包含单位。您的最终答案必须是单一表达式。", "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n-   系统：一个合成启动子的连续时间马尔可夫链 (CTMC) 模型。\n-   状态：$S_{0}$（未结合）、$S_{A}$（激活子结合）、$S_{R}$（阻遏子结合）、$G$（目标，吸收态）、$F$（失败，吸收态）。\n-   初始状态：系统从状态 $S_{0}$ 开始。\n-   CTMC 转移速率（所有参数均为严格正数）：\n    -   从 $S_{0}$：到 $S_{A}$ 的速率为 $k_{a}$；到 $S_{R}$ 的速率为 $k_{r}$。\n    -   从 $S_{A}$：到 $S_{0}$ 的速率为 $u_{a}$；到 $G$ 的速率为 $c_{a}$。\n    -   从 $S_{R}$：到 $S_{0}$ 的速率为 $u_{r}$；到 $F$ 的速率为 $c_{r}$。\n-   目标：推导可达性概率 $\\Pr(\\lozenge G \\text{ before } F \\mid S_{0})$ 的闭式解析表达式。\n-   方法论：\n    1.  为瞬时态 $\\{S_{0}, S_{A}, S_{R}\\}$ 构建嵌入式离散时间马尔可夫链 (DTMC)。\n    2.  在 DTMC 上使用状态消除法，先消除 $S_{A}$，再消除 $S_{R}$，以求得概率。\n\n**第 2 步：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n-   **科学依据**：该问题描述了一个用于合成生物学和系统生物学的标准随机模型。CTMC 是分析生化反应网络的基本工具。该模型是对启动子调控的一个有效（尽管简化）的表示。\n-   **适定性**：该问题在数学上是精确的。状态、转移、速率和初始条件都有明确定义。目标是计算一个可达性概率，这是马尔可夫链理论中的一个标准问题。唯一解的存在性得到保证。\n-   **客观性**：语言正式且无歧义。参数均有数学定义。\n-   **完整性**：问题是自洽的，提供了推导解所需的所有必要信息。没有矛盾之处。\n\n**第 3 步：结论与行动**\n问题有效。现在开始求解过程。\n\n该问题要求从嵌入式离散时间马尔可夫链 (DTMC) 出发，计算一个 CTMC 中的可达性概率。对于一个 CTMC 及其嵌入式 DTMC 而言，到达一个目标状态集而不先到达另一个不相交状态集的概率是相同的。\n\n**第 1 部分：构建嵌入式 DTMC**\n嵌入式 DTMC 的转移概率通过对每个非吸收态的出射速率进行归一化得到。\n瞬时态为 $\\{S_{0}, S_{A}, S_{R}\\}$，吸收态为 $\\{G, F\\}$。\n\n从状态 $S_{0}$，总出射速率为 $\\lambda_{0} = k_{a} + k_{r}$。转移概率为：\n-   $P(S_{A} | S_{0}) = \\frac{k_{a}}{k_{a} + k_{r}}$\n-   $P(S_{R} | S_{0}) = \\frac{k_{r}}{k_{a} + k_{r}}$\n\n从状态 $S_{A}$，总出射速率为 $\\lambda_{A} = u_{a} + c_{a}$。转移概率为：\n-   $P(S_{0} | S_{A}) = \\frac{u_{a}}{u_{a} + c_{a}}$\n-   $P(G | S_{A}) = \\frac{c_{a}}{u_{a} + c_{a}}$\n\n从状态 $S_{R}$，总出射速率为 $\\lambda_{R} = u_{r} + c_{r}$。转移概率为：\n-   $P(S_{0} | S_{R}) = \\frac{u_{r}}{u_{r} + c_{r}}$\n-   $P(F | S_{R}) = \\frac{c_{r}}{u_{r} + c_{r}}$\n\n**第 2 部分：状态消除与概率计算**\n令 $\\pi_{i}$ 为从状态 $i$ 开始最终到达状态 $G$ 的概率。根据定义，对于吸收态，我们有 $\\pi_{G} = 1$ 和 $\\pi_{F} = 0$。对于瞬时态，我们可以通过对第一次转移进行条件化来建立一个线性方程组：\n$$\n\\pi_{i} = \\sum_{j} P(j|i) \\pi_{j}\n$$\n这得到以下方程组：\n1.  $\\pi_{S_{0}} = P(S_{A} | S_{0}) \\pi_{S_{A}} + P(S_{R} | S_{0}) \\pi_{S_{R}} = \\left(\\frac{k_{a}}{k_{a} + k_{r}}\\right) \\pi_{S_{A}} + \\left(\\frac{k_{r}}{k_{a} + k_{r}}\\right) \\pi_{S_{R}}$\n2.  $\\pi_{S_{A}} = P(S_{0} | S_{A}) \\pi_{S_{0}} + P(G | S_{A}) \\pi_{G} = \\left(\\frac{u_{a}}{u_{a} + c_{a}}\\right) \\pi_{S_{0}} + \\left(\\frac{c_{a}}{u_{a} + c_{a}}\\right)(1)$\n3.  $\\pi_{S_{R}} = P(S_{0} | S_{R}) \\pi_{S_{0}} + P(F | S_{R}) \\pi_{F} = \\left(\\frac{u_{r}}{u_{r} + c_{r}}\\right) \\pi_{S_{0}} + \\left(\\frac{c_{r}}{u_{r} + c_{r}}\\right)(0) = \\left(\\frac{u_{r}}{u_{r} + c_{r}}\\right) \\pi_{S_{0}}$\n\n该问题要求使用状态消除程序。这等同于通过代入法求解该方程组。\n\n首先，我们将方程 (2) 代入方程 (1) 来消除 $\\pi_{S_{A}}$：\n$$\n\\pi_{S_{0}} = \\left(\\frac{k_{a}}{k_{a} + k_{r}}\\right) \\left[ \\left(\\frac{u_{a}}{u_{a} + c_{a}}\\right) \\pi_{S_{0}} + \\frac{c_{a}}{u_{a} + c_{a}} \\right] + \\left(\\frac{k_{r}}{k_{a} + k_{r}}\\right) \\pi_{S_{R}}\n$$\n$$\n\\pi_{S_{0}} = \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} \\pi_{S_{0}} + \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} + \\frac{k_{r}}{k_{a} + k_{r}} \\pi_{S_{R}}\n$$\n接下来，我们将方程 (3) 代入上述表达式来消除 $\\pi_{S_{R}}$：\n$$\n\\pi_{S_{0}} = \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} \\pi_{S_{0}} + \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} + \\frac{k_{r}}{k_{a} + k_{r}} \\left[ \\left(\\frac{u_{r}}{u_{r} + c_{r}}\\right) \\pi_{S_{0}} \\right]\n$$\n这得到了一个关于 $\\pi_{S_{0}}$ 的单一方程，它代表了所要求的在 $\\{S_{0}, G, F\\}$ 上的等价 DTMC。\n$$\n\\pi_{S_{0}} = \\left( \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} + \\frac{k_{r} u_{r}}{(k_{a} + k_{r})(u_{r} + c_{r})} \\right) \\pi_{S_{0}} + \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})}\n$$\n现在，我们求解 $\\pi_{S_{0}}$：\n$$\n\\pi_{S_{0}} \\left[ 1 - \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} - \\frac{k_{r} u_{r}}{(k_{a} + k_{r})(u_{r} + c_{r})} \\right] = \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})}\n$$\n我们来简化方括号中的项：\n$$\n1 - \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} - \\frac{k_{r} u_{r}}{(k_{a} + k_{r})(u_{r} + c_{r})} = \\frac{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r}) - k_{a} u_{a}(u_{r} + c_{r}) - k_{r} u_{r}(u_{a} + c_{a})}{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r})}\n$$\n展开分子：\n$$\n(k_{a} + k_{r})(u_{a} + c_{a}) = k_{a}u_{a} + k_{a}c_{a} + k_{r}u_{a} + k_{r}c_{a}\n$$\n$$\n(k_{a}u_{a} + k_{a}c_{a} + k_{r}u_{a} + k_{r}c_{a})(u_{r} + c_{r}) = k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r} + k_{a}c_{a}u_{r} + k_{a}c_{a}c_{r} + k_{r}u_{a}u_{r} + k_{r}u_{a}c_{r} + k_{r}c_{a}u_{r} + k_{r}c_{a}c_{r}\n$$\n减去其他项 $k_{a} u_{a}(u_{r} + c_{r}) = k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r}$ 和 $k_{r} u_{r}(u_{a} + c_{a}) = k_{r}u_{a}u_{r} + k_{r}c_{a}u_{r}$：\n$$\n\\text{Numerator} = (k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r} + k_{a}c_{a}u_{r} + k_{a}c_{a}c_{r} + k_{r}u_{a}u_{r} + k_{r}u_{a}c_{r} + k_{r}c_{a}u_{r} + k_{r}c_{a}c_{r}) - (k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r}) - (k_{r}u_{a}u_{r} + k_{r}c_{a}u_{r})\n$$\n$k_{a}u_{a}u_{r}$、$k_{a}u_{a}c_{r}$、$k_{r}u_{a}u_{r}$ 和 $k_{r}c_{a}u_{r}$ 项消去。简化后的分子是：\n$$\nk_{a}c_{a}u_{r} + k_{a}c_{a}c_{r} + k_{r}u_{a}c_{r} + k_{r}c_{a}c_{r}\n$$\n这可以因式分解为：\n$$\nk_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})\n$$\n将此代回关于 $\\pi_{S_{0}}$ 的方程中：\n$$\n\\pi_{S_{0}} \\left[ \\frac{k_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})}{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r})} \\right] = \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})}\n$$\n求解 $\\pi_{S_{0}}$：\n$$\n\\pi_{S_{0}} = \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} \\cdot \\frac{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r})}{k_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})}\n$$\n$(k_{a} + k_{r})(u_{a} + c_{a})$ 项从分子和分母中消去：\n$$\n\\pi_{S_{0}} = \\frac{k_{a} c_{a} (u_{r} + c_{r})}{k_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})}\n$$\n这就是可达性概率 $\\Pr(\\lozenge G \\text{ before } F \\mid S_{0})$ 的最终闭式表达式。根据要求，它是给定 CTMC 速率参数的一个简单有理函数。", "answer": "$$\n\\boxed{\\frac{k_{a} c_{a} (u_{r} + c_{r})}{k_{a} c_{a} (u_{r} + c_{r}) + k_{r} c_{r} (u_{a} + c_{a})}}\n$$", "id": "2739288"}, {"introduction": "当生物系统过于复杂，难以进行精确的符号分析时，统计模型检验（statistical model checking）提供了一种可行的替代方案。该方法通过有限次数的模拟和严格的统计假设检验，来验证系统属性是否满足给定的置信度。本练习将指导你如何应用序贯概率比检验（SPRT）来设计一个高效的验证流程，这对于处理大规模和随机性强的基因线路至关重要 [@problem_id:2739310]。", "problem": "考虑一个由两种阻遏蛋白控制的双稳态基因拨动开关的随机化学主方程模型。在概率模型检验中，我们希望验证时序性质 $\\phi$：“在时间 $T$ 之前，报告基因处于开启状态”，这意味着报告蛋白的拷贝数在时间 $T$ 或之前超过一个预设的阈值。一个统计上可靠的验证框架会模拟独立的轨迹，并记录指示变量 $X_i \\in \\{0,1\\}$，表示性质 $\\phi$ 是否在轨迹 $i$ 上成立。在各次运行之间满足平稳性和独立抽样的条件下，$X_i$ 是独立同分布的伯努利随机变量，其成功概率为 $\\theta = \\Pr(\\phi)$。\n\n我们的目标是，对于给定的 $p \\in (0,1)$ 和 $\\delta \\in (0,p)$，使用序列概率比检验（SPRT）在假设 $H_0: \\theta \\ge p$ 和 $H_1: \\theta \\le p - \\delta$ 之间做出决策。其中，定义该检验的两个“简单”假设被固定在边界值上：$H_0$ 的边界值为 $p_0 = p$，$H_1$ 的边界值为 $p_1 = p - \\delta$。该检验必须满足I型错误界限 $\\alpha$ 和II型错误界限 $\\beta$，这意味着在 $H_0$ 成立的情况下错误地拒绝 $H_0$ 的概率至多为 $\\alpha$，而在 $H_1$ 成立的情况下错误地接受 $H_0$ 的概率至多为 $\\beta$。\n\n从第一性原理（伯努利似然、独立性以及似然比的定义）出发，推导用于此验证任务的SPRT决策统计量和停止法则。然后，以闭式形式推导保证错误界限的似然比阈值，该表达式应完全由 $\\alpha$ 和 $\\beta$ 表示。\n\n最后，根据具体的设计参数 $\\alpha = 0.01$ 和 $\\beta = 0.05$，计算自然对数阈值。将您的数值结果四舍五入至四位有效数字，并以行矩阵的形式报告数对 $\\big(\\ln A, \\ln B\\big)$。", "solution": "该问题是良定的，且具有科学依据。它涉及将统计决策理论中的标准方法——序列概率比检验（SPRT）——应用于合成生物学中随机模型的验证。所有必需的信息均已提供。我们将进行推导。\n\n该问题要求我们分析一个关于伯努利试验成功概率 $\\theta$ 的假设检验。随机遗传回路单次轨迹的模拟被视为一次试验。其结果由一个随机变量 $X_i$ 表示，如果性质 $\\phi$ 成立（一次“成功”），则 $X_i=1$；否则（一次“失败”）$X_i=0$。各次试验是独立同分布的，因此 $X_i \\sim \\text{Bernoulli}(\\theta)$，其中 $\\theta = \\Pr(X_i=1)$。\n\n待检验的假设是复合假设：\n$H_0: \\theta \\ge p$\n$H_1: \\theta \\le p - \\delta$\n\nSPRT 框架通过考虑边界情况将这些复合假设简化为两个简单假设：原假设 $H'_0: \\theta = p_0$ 对备择假设 $H'_1: \\theta = p_1$。题目将它们指定为 $p_0 = p$ 和 $p_1 = p - \\delta$。\n\n设 $n$ 次独立模拟的结果序列为 $x_1, x_2, \\ldots, x_n$。在真实参数为 $\\theta^*$ 的假设下，观测到这一特定序列的似然由下式给出：\n$$ L(\\theta^*) = \\prod_{i=1}^{n} P(X_i=x_i | \\theta=\\theta^*) = \\prod_{i=1}^{n} (\\theta^*)^{x_i} (1-\\theta^*)^{1-x_i} $$\n令 $S_n = \\sum_{i=1}^{n} x_i$ 为 $n$ 次试验后的成功次数。似然函数可以更紧凑地写为：\n$$ L(\\theta^*) = (\\theta^*)^{S_n} (1-\\theta^*)^{n-S_n} $$\n\nSPRT 的核心是似然比 $\\Lambda_n$，其定义为备择假设（$H'_1$）下的似然与原假设（$H'_0$）下的似然之比：\n$$ \\Lambda_n = \\frac{L(p_1)}{L(p_0)} = \\frac{p_1^{S_n} (1-p_1)^{n-S_n}}{p_0^{S_n} (1-p_0)^{n-S_n}} $$\n这可以整理为：\n$$ \\Lambda_n = \\left(\\frac{p_1}{p_0}\\right)^{S_n} \\left(\\frac{1-p_1}{1-p_0}\\right)^{n-S_n} $$\n该表达式即为 SPRT 的决策统计量。\n\n停止法则由两个阈值 $A$ 和 $B$ 定义，这两个阈值由期望的错误概率确定。标准约定为 $0  B  1  A$。每次观测到 $X_n$ 后，计算似然比 $\\Lambda_n$ 并与阈值进行比较：\n1. 如果 $\\Lambda_n \\ge A$，则检验停止，拒绝 $H'_0$ 而采纳 $H'_1$。在原始复合假设的背景下，我们接受 $H_1$。\n2. 如果 $\\Lambda_n \\le B$，则检验停止，接受 $H'_0$。在原始复合假设的背景下，我们接受 $H_0$。\n3. 如果 $B  \\Lambda_n  A$，则证据不足以做出决策，需进行下一次观测 $X_{n+1}$。\n\n使用似然比的自然对数在计算上通常更方便，因为它将乘积转换为求和。对数似然比 $Z_n = \\ln(\\Lambda_n)$ 为：\n$$ Z_n = S_n \\ln\\left(\\frac{p_1}{p_0}\\right) + (n-S_n) \\ln\\left(\\frac{1-p_1}{1-p_0}\\right) $$\n用 $Z_n$ 表示的停止法则变为：\n1. 如果 $Z_n \\ge \\ln A$，停止并接受 $H_1$。\n2. 如果 $Z_n \\le \\ln B$，停止并接受 $H_0$。\n3. 如果 $\\ln B  Z_n  \\ln A$，继续抽样。\n\n接下来，我们根据给定的I型错误界限 $\\alpha$ 和II型错误界限 $\\beta$ 推导阈值 $A$ 和 $B$ 的表达式。\n- I型错误指在 $H_0$ 成立时拒绝 $H_0$。此事件的概率至多为 $\\alpha$。在 SPRT 的背景下，即 $\\Pr(\\text{reject } H'_0 | \\theta=p_0) = \\Pr(\\Lambda_N \\ge A | \\theta=p_0)$，其中 $N$ 是检验的随机停止时间。\n- II型错误指在 $H_1$ 成立时接受 $H_0$。此事件的概率至多为 $\\beta$。在 SPRT 的背景下，即 $\\Pr(\\text{accept } H'_0 | \\theta=p_1) = \\Pr(\\Lambda_N \\le B | \\theta=p_1)$。\n\n阈值的推导由 Abraham Wald 开创，它使用了一个近似方法，忽略了统计量 $\\Lambda_N$ 对边界的“过冲”效应。也就是说，在做出决策的时刻，我们近似认为拒绝时 $\\Lambda_N \\approx A$，接受时 $\\Lambda_N \\approx B$。\n\n设 $\\mathcal{R}$ 为所有导致检验停止并拒绝 $H_0$（即 $\\Lambda_N \\ge A$）的样本路径集合。那么I型错误的概率为 $\\alpha \\approx \\sum_{\\text{paths} \\in \\mathcal{R}} P(\\text{path}|p_0)$。在 $H_1$ 成立时正确拒绝 $H_0$ 的概率为 $1-\\beta \\approx \\sum_{\\text{paths} \\in \\mathcal{R}} P(\\text{path}|p_1)$。\n对于 $\\mathcal{R}$ 中的任何路径，我们有 $\\Lambda_N = \\frac{P(\\text{path}|p_1)}{P(\\text{path}|p_0)} \\approx A$。因此，$P(\\text{path}|p_1) \\approx A \\cdot P(\\text{path}|p_0)$。\n对 $\\mathcal{R}$ 中所有路径求和：\n$$ \\sum_{\\text{paths} \\in \\mathcal{R}} P(\\text{path}|p_1) \\approx A \\sum_{\\text{paths} \\in \\mathcal{R}} P(\\text{path}|p_0) $$\n$$ 1-\\beta \\approx A \\cdot \\alpha $$\n这给出了上阈值的近似值：$A \\approx \\frac{1-\\beta}{\\alpha}$。\n\n类似地，设 $\\mathcal{A}$ 为所有导致检验停止并接受 $H_0$（即 $\\Lambda_N \\le B$）的样本路径集合。II型错误的概率为 $\\beta \\approx \\sum_{\\text{paths} \\in \\mathcal{A}} P(\\text{path}|p_1)$。正确接受 $H_0$ 的概率为 $1-\\alpha \\approx \\sum_{\\text{paths} \\in \\mathcal{A}} P(\\text{path}|p_0)$。\n对于 $\\mathcal{A}$ 中的任何路径，我们有 $\\Lambda_N = \\frac{P(\\text{path}|p_1)}{P(\\text{path}|p_0)} \\approx B$。因此，$P(\\text{path}|p_1) \\approx B \\cdot P(\\text{path}|p_0)$。\n对 $\\mathcal{A}$ 中所有路径求和：\n$$ \\sum_{\\text{paths} \\in \\mathcal{A}} P(\\text{path}|p_1) \\approx B \\sum_{\\text{paths} \\in \\mathcal{A}} P(\\text{path}|p_0) $$\n$$ \\beta \\approx B \\cdot (1-\\alpha) $$\n这给出了下阈值的近似值：$B \\approx \\frac{\\beta}{1-\\alpha}$。\n\n为了保证实际的错误概率 $\\alpha'$ 和 $\\beta'$ 满足 $\\alpha' \\le \\alpha$ 和 $\\beta' \\le \\beta$，这些近似被视为等式，并用于设定阈值。因此，阈值的闭式表达式为：\n$$ A = \\frac{1-\\beta}{\\alpha} \\quad \\text{和} \\quad B = \\frac{\\beta}{1-\\alpha} $$\n\n最后，我们根据具体的设计参数 $\\alpha = 0.01$ 和 $\\beta = 0.05$ 计算自然对数阈值。\n对数上阈值为：\n$$ \\ln A = \\ln\\left(\\frac{1-\\beta}{\\alpha}\\right) = \\ln\\left(\\frac{1 - 0.05}{0.01}\\right) = \\ln\\left(\\frac{0.95}{0.01}\\right) = \\ln(95) $$\n$$ \\ln(95) \\approx 4.55387689 $$\n四舍五入到四位有效数字，我们得到 $\\ln A \\approx 4.554$。\n\n对数下阈值为：\n$$ \\ln B = \\ln\\left(\\frac{\\beta}{1-\\alpha}\\right) = \\ln\\left(\\frac{0.05}{1 - 0.01}\\right) = \\ln\\left(\\frac{0.05}{0.99}\\right) $$\n$$ \\ln\\left(\\frac{0.05}{0.99}\\right) \\approx \\ln(0.050505...) \\approx -2.98567735 $$\n四舍五入到四位有效数字，我们得到 $\\ln B \\approx -2.986$。\n\n这对自然对数阈值为 $(\\ln A, \\ln B) = (4.554, -2.986)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 4.554  -2.986 \\end{pmatrix}}\n$$", "id": "2739310"}]}