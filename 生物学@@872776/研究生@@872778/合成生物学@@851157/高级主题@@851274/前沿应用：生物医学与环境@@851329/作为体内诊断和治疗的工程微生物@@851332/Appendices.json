{"hands_on_practices": [{"introduction": "工程微生物作为体内诊断和治疗工具，其核心在于能够感知并响应环境信号。为了设计有效的系统，我们必须理解其动态响应特性。本练习将一个简单的诱导型表达模块抽象为一个一阶线性系统，旨在通过推导其频率响应和 $-3$ dB 带宽，来量化该模块响应输入信号的速度，这是评估任何动态传感电路性能的基础。[@problem_id:2732195]", "problem": "一种用作体内疗法的工程益生菌，能感应宿主来源的代谢物，其浓度输入为 $u(t)$，并产生一种报告蛋白，其胞内浓度为 $x(t)$，该浓度可被无创读出。在非饱和、低负荷的工作状态下，产率与输入成正比，而损失主要由一级稀释/降解主导。在这些条件下，报告蛋白的标准质量平衡方程为\n$$\n\\frac{dx(t)}{dt} = \\alpha\\,u(t) - \\beta\\,x(t),\n$$\n其中 $\\alpha>0$ 的单位是 浓度/单位时间/单位输入，$\\beta>0$ 的单位是时间的倒数，反映了一级损失。\n\n考虑围绕一个恒定工作点 $u(t)=u_{0}+\\delta u(t)$ 和 $x(t)=x_{0}+\\delta x(t)$ 的小扰动，其中 $u_{0}$ 是常数，$\\delta u(t)$ 是一个小的、零均值的有界信号。为了进行频域分析，假设初始扰动为零。\n\n使用反应平衡和线性系统分析的第一性原理（拉普拉斯变换和频率响应的定义），推导将输入扰动 $\\delta u(t)$ 映射到输出扰动 $\\delta x(t)$ 的小信号频率响应 $G(\\mathrm{i}\\omega)$。然后，利用幅频响应的分贝(dB)半功率点定义，计算频率响应的幅值相对于其零频值下降 $-3$ dB 时的角频率，即满足以下条件的唯一 $\\omega>0$：\n$$\n\\big|G(\\mathrm{i}\\omega)\\big|=\\frac{\\big|G(0)\\big|}{\\sqrt{2}}.\n$$\n将 $-3$ dB 带宽表示为以 $\\alpha$ 和 $\\beta$ 为参数的解析表达式，单位为弧度/秒。不要对任何量进行四舍五入。仅报告 $-3$ dB 带宽作为最终答案。", "solution": "该问题要求推导一个由线性一阶常微分方程建模的简单基因电路的 $-3$ dB 带宽。分析过程将通过线性化、应用拉普拉斯变换求系统的传递函数，最后计算系统增益衰减到指定水平时的特定频率。\n\n报告蛋白浓度 $x(t)$ 响应输入代谢物浓度 $u(t)$ 的控制动态由以下线性常微分方程给出：\n$$\n\\frac{dx(t)}{dt} = \\alpha\\,u(t) - \\beta\\,x(t)\n$$\n其中 $\\alpha > 0$ 和 $\\beta > 0$ 是常数参数。\n\n我们分析系统对恒定工作点周围小扰动的响应。设输入和输出表示为稳态分量和小扰动之和：\n$$\nu(t) = u_{0} + \\delta u(t)\n$$\n$$\nx(t) = x_{0} + \\delta x(t)\n$$\n这里，$u_{0}$ 是一个恒定输入，它产生一个恒定的稳态输出 $x_{0}$。在此稳态下，时间导数为零，即 $\\frac{dx}{dt} = 0$。将稳态值代入控制方程，得到 $x_{0}$ 和 $u_{0}$ 之间的关系：\n$$\n0 = \\alpha u_{0} - \\beta x_{0} \\implies x_{0} = \\frac{\\alpha}{\\beta} u_{0}\n$$\n现在，将 $u(t)$ 和 $x(t)$ 的完整扰动形式代入原始微分方程：\n$$\n\\frac{d}{dt}(x_{0} + \\delta x(t)) = \\alpha(u_{0} + \\delta u(t)) - \\beta(x_{0} + \\delta x(t))\n$$\n由于 $x_{0}$ 是一个常数，其导数为零。展开右侧的各项得到：\n$$\n\\frac{d\\delta x(t)}{dt} = \\alpha u_{0} + \\alpha \\delta u(t) - \\beta x_{0} - \\beta \\delta x(t)\n$$\n我们可以将稳态项和扰动项分组：\n$$\n\\frac{d\\delta x(t)}{dt} = (\\alpha u_{0} - \\beta x_{0}) + \\alpha \\delta u(t) - \\beta \\delta x(t)\n$$\n根据我们的稳态分析，我们知道 $\\alpha u_{0} - \\beta x_{0} = 0$。因此，控制小信号扰动的方程是：\n$$\n\\frac{d\\delta x(t)}{dt} = \\alpha \\delta u(t) - \\beta \\delta x(t)\n$$\n为了求得频率响应，我们首先确定这个线性时不变系统的传递函数。我们对扰动方程应用拉普拉斯变换。令 $\\Delta X(s) = \\mathcal{L}\\{\\delta x(t)\\}$ 和 $\\Delta U(s) = \\mathcal{L}\\{\\delta u(t)\\}$。假设扰动的初始条件为零，即 $\\delta x(0) = 0$，则导数的拉普拉斯变换为 $\\mathcal{L}\\{\\frac{d\\delta x(t)}{dt}\\} = s \\Delta X(s)$。变换后的方程变为：\n$$\ns \\Delta X(s) = \\alpha \\Delta U(s) - \\beta \\Delta X(s)\n$$\n传递函数 $G(s)$ 定义为输出变换与输入变换之比，即 $G(s) = \\frac{\\Delta X(s)}{\\Delta U(s)}$。重新整理方程以求解该比率，得到：\n$$\ns \\Delta X(s) + \\beta \\Delta X(s) = \\alpha \\Delta U(s)\n$$\n$$\n(s + \\beta) \\Delta X(s) = \\alpha \\Delta U(s)\n$$\n$$\nG(s) = \\frac{\\Delta X(s)}{\\Delta U(s)} = \\frac{\\alpha}{s + \\beta}\n$$\n频率响应 $G(\\mathrm{i}\\omega)$ 是通过将 $s = \\mathrm{i}\\omega$ 代入传递函数得到的，其中 $\\omega$ 是角频率，$\\mathrm{i}$ 是虚数单位。\n$$\nG(\\mathrm{i}\\omega) = \\frac{\\alpha}{\\mathrm{i}\\omega + \\beta}\n$$\n频率响应的幅值 $|G(\\mathrm{i}\\omega)|$ 是：\n$$\n|G(\\mathrm{i}\\omega)| = \\left|\\frac{\\alpha}{\\beta + \\mathrm{i}\\omega}\\right| = \\frac{|\\alpha|}{|\\beta + \\mathrm{i}\\omega|}\n$$\n由于 $\\alpha$ 是一个正实数，所以 $|\\alpha| = \\alpha$。复数分母的模为 $\\sqrt{\\beta^2 + \\omega^2}$。因此：\n$$\n|G(\\mathrm{i}\\omega)| = \\frac{\\alpha}{\\sqrt{\\beta^2 + \\omega^2}}\n$$\n问题要求的是 $-3$ dB 带宽，即频率响应的幅值下降到其零频值的 $\\frac{1}{\\sqrt{2}}$ 时的频率 $\\omega > 0$。首先，我们通过设置 $\\omega=0$ 来计算零频增益 $|G(0)|$：\n$$\n|G(0)| = \\frac{\\alpha}{\\sqrt{\\beta^2 + 0^2}} = \\frac{\\alpha}{\\beta}\n$$\n$-3$ dB 点的条件为：\n$$\n|G(\\mathrm{i}\\omega)| = \\frac{|G(0)|}{\\sqrt{2}}\n$$\n代入我们关于 $|G(\\mathrm{i}\\omega)|$ 和 $|G(0)|$ 的表达式：\n$$\n\\frac{\\alpha}{\\sqrt{\\beta^2 + \\omega^2}} = \\frac{\\frac{\\alpha}{\\beta}}{\\sqrt{2}} = \\frac{\\alpha}{\\beta\\sqrt{2}}\n$$\n由于 $\\alpha > 0$，我们可以将两边同时除以 $\\alpha$：\n$$\n\\frac{1}{\\sqrt{\\beta^2 + \\omega^2}} = \\frac{1}{\\beta\\sqrt{2}}\n$$\n取两边的倒数得到：\n$$\n\\sqrt{\\beta^2 + \\omega^2} = \\beta\\sqrt{2}\n$$\n两边平方以消去平方根：\n$$\n\\beta^2 + \\omega^2 = (\\beta\\sqrt{2})^2 = 2\\beta^2\n$$\n解出 $\\omega^2$：\n$$\n\\omega^2 = 2\\beta^2 - \\beta^2 = \\beta^2\n$$\n取平方根，并考虑到频率 $\\omega$ 必须为正，且已知 $\\beta > 0$，我们得到：\n$$\n\\omega = \\beta\n$$\n这就是幅度响应衰减了 $-3$ dB 时的角频率，单位是弧度/秒。", "answer": "$$\n\\boxed{\\beta}\n$$", "id": "2732195"}, {"introduction": "在细胞内表达合成模块并非没有代价；它会消耗宿主的蛋白合成资源，从而对细胞生长产生“负担”。理解和量化这种负担对于设计稳定且高效的微生物系统至关重要。本练习应用了经典的 Scott-Hwa 细菌生长定律，要求您推导在表达外源蛋白的情况下，细胞生长速率与合成通量之间的定量关系，并预测系统崩溃的蛋白负担阈值。[@problem_id:2732169]", "problem": "一种工程共生菌被部署在哺乳动物肠道中，作为一种体内诊断和治疗系统。该底盘表达一个合成模块，该模块包括一个传感回路、一个治疗效应子和一个编码报告基因，它们共同施加了一个额外的蛋白质组负荷，用无量纲分数 $\\phi$ 表示，定义为专用于异源诊断治疗功能的总蛋白质组的比例。假设在稳态下以生长速率 $\\lambda$ 进行平衡指数生长。\n\n采用以下基础框架，该框架已在细菌生长和蛋白质组分配方面得到反复验证：(i) 蛋白质组被划分为比例为 $\\phi_{R}$ 的核糖体组分、比例为 $\\phi_{P}$ 的代谢组分、比例为 $\\phi_{U}$ 的恒定管家组分（独立于 $\\lambda$ 和 $\\phi$）以及合成负荷 $\\phi$；(ii) 蛋白质组各组分的比例之和为1；(iii) Scott–Hwa 细菌生长定律成立，即稳态核糖体组分比例和代谢组分比例通过翻译能力 $\\kappa_{t}$ 和营养能力 $\\kappa_{n}$ 与 $\\lambda$ 呈线性变化，并具有分别对应于非活性核糖体和基础代谢的非零截距。具体而言，存在常数 $\\phi_{R}^{0}$ 和 $\\phi_{P}^{0}$，使得支持生长所需的活性分配通过 $\\kappa_{t}$ 和 $\\kappa_{n}$ 与 $\\lambda$ 满足线性关系；(iv) 对于一个在生长时间尺度上降解可以忽略不计的稳定异源产物，其稳态单位生物量合成通量等于生长带来的稀释通量。\n\n仅使用这些基础和标准的质量平衡推理，推导出以下各项的闭式表达式：\n- 稳态生长速率 $\\lambda$ 作为附加蛋白质组负荷 $\\phi$ 和生理参数 $\\kappa_{t}$、$\\kappa_{n}$、$\\phi_{R}^{0}$、$\\phi_{P}^{0}$ 及 $\\phi_{U}$ 的函数；\n- 在活性降解可忽略不计的假设下，治疗性蛋白的稳态单位生物量合成通量 $J(\\phi)$ 作为 $\\phi$ 和相同生理参数的函数；\n- 崩溃阈值 $\\phi_{c}$，定义为在该模型下可能实现非负生长的 $\\phi$ 的最大值。\n\n假设参数范围在生理上是一致的，即 $1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} > 0$。请将你的最终答案表示为三个闭式解析表达式，顺序为 $\\lambda(\\phi)$、$J(\\phi)$ 和 $\\phi_{c}$。除以上定义的符号外，不要引入任何其他符号。不需要进行数值计算，最终表达式中不应包含单位。", "solution": "首先对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n所提供的数据和模型组成部分如下：\n- 一个无量纲的蛋白质组负荷 $\\phi$，代表用于异源功能的总蛋白质组的比例。\n- 系统处于平衡指数生长状态，稳态生长速率为 $\\lambda$。\n- 蛋白质组被划分为四个组分：核糖体（$\\phi_{R}$）、代谢（$\\phi_{P}$）、管家（$\\phi_{U}$）和合成（$\\phi$）。\n- 蛋白质组各组分比例之和为1：$\\phi_{R} + \\phi_{P} + \\phi_{U} + \\phi = 1$。\n- 管家组分 $\\phi_{U}$ 是常数，与 $\\lambda$ 和 $\\phi$ 无关。\n- Scott–Hwa 生长定律定义了核糖体和代谢组分的比例：\n  - $\\phi_{R} = \\phi_{R}^{0} + \\frac{\\lambda}{\\kappa_{t}}$，其中 $\\phi_{R}^{0}$ 是非活性核糖体组分的比例，$\\kappa_{t}$ 是翻译能力。\n  - $\\phi_{P} = \\phi_{P}^{0} + \\frac{\\lambda}{\\kappa_{n}}$，其中 $\\phi_{P}^{0}$ 是基础代谢组分的比例，$\\kappa_{n}$ 是营养能力。\n- 对于稳定产物，稳态单位生物量合成通量 $J$ 等于生长带来的稀释通量。\n- 给定了一个生理一致性约束：$1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} > 0$。\n- 目标是推导生长速率 $\\lambda(\\phi)$、合成通量 $J(\\phi)$ 和崩溃阈值 $\\phi_{c}$ 的表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学基础**：该问题基于细菌蛋白质组分配的 Scott-Hwa 模型，这是定量系统生物学和合成生物学中一个成熟且经过经验验证的框架。其概念是标准的且科学合理的。\n- **适定性**：该问题建立了一个具有确定参数的代数方程组。独立方程的数量与待定未知数的数量相匹配，确保可以推导出唯一解。一致性约束 $1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} > 0$ 确保了模型基础状态的物理可行性。\n- **客观性**：该问题使用来自相关科学领域的精确、明确的术语进行陈述。它不含主观或推测性的主张。\n\n对特定缺陷的检查显示没有问题：该问题在科学上是合理的，可以形式化，是完整的，没有矛盾，是现实的，并且是适定的。它提出了一个其主题核心的标准、非平凡的推导任务。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将基于所提供的框架推导解决方案。\n\n**稳态生长速率 $\\lambda(\\phi)$ 的推导**\n推导从基本的蛋白质组守恒方程开始：\n$$\n\\phi_{R} + \\phi_{P} + \\phi_{U} + \\phi = 1\n$$\n将与生长相关的组分 $\\phi_{R}$ 和 $\\phi_{P}$ 的表达式代入此方程：\n$$\n\\left(\\phi_{R}^{0} + \\frac{\\lambda}{\\kappa_{t}}\\right) + \\left(\\phi_{P}^{0} + \\frac{\\lambda}{\\kappa_{n}}\\right) + \\phi_{U} + \\phi = 1\n$$\n重新整理此方程以求解生长速率 $\\lambda$。将含有 $\\lambda$ 的项归到一边：\n$$\n\\lambda \\left(\\frac{1}{\\kappa_{t}} + \\frac{1}{\\kappa_{n}}\\right) = 1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} - \\phi\n$$\n通过通分来简化括号中的项：\n$$\n\\frac{1}{\\kappa_{t}} + \\frac{1}{\\kappa_{n}} = \\frac{\\kappa_{n} + \\kappa_{t}}{\\kappa_{t} \\kappa_{n}}\n$$\n将其代回并分离出 $\\lambda$，得到生长速率作为合成负荷 $\\phi$ 的函数的表达式：\n$$\n\\lambda(\\phi) = \\frac{\\kappa_{t} \\kappa_{n}}{\\kappa_{t} + \\kappa_{n}} \\left(1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} - \\phi\\right)\n$$\n这是第一个所需的表达式。\n\n**单位生物量合成通量 $J(\\phi)$ 的推导**\n问题陈述，对于一个稳定的产物，稳态单位生物量合成通量 $J$ 等于稀释通量。浓度为 $C$ 的组分的稀释通量由 $\\lambda C$ 给出。因此，$J = \\lambda C$。浓度 $C$ 指的是单位总生物量的治疗性蛋白的量。\n在此模型框架内，蛋白质组一个组分的浓度由其比例分配来表示。异源蛋白占总蛋白质组的比例是 $\\phi$。假设总蛋白质组占细胞总生物量的比例是恒定的，那么单位生物量的异源蛋白浓度与 $\\phi$ 成正比。问题没有提供这个比例常数。最简约的解释，与此类模型的标准表述一致，是将通量平衡方程中的“浓度”定义为蛋白质组比例 $\\phi$ 本身。这意味着合成通量 $J(\\phi)$ 被定义为异源蛋白质量的合成速率除以总蛋白质组质量。因此，我们设 $C = \\phi$。\n根据这种解释，合成通量为：\n$$\nJ(\\phi) = \\lambda(\\phi) \\cdot \\phi\n$$\n代入先前推导的 $\\lambda(\\phi)$ 表达式：\n$$\nJ(\\phi) = \\phi \\frac{\\kappa_{t} \\kappa_{n}}{\\kappa_{t} + \\kappa_{n}} \\left(1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} - \\phi\\right)\n$$\n这是第二个所需的表达式。\n\n**崩溃阈值 $\\phi_{c}$ 的推导**\n崩溃阈值 $\\phi_{c}$ 被定义为可能实现非负生长（即 $\\lambda(\\phi) \\geq 0$）的合成负荷 $\\phi$ 的最大值。该阈值对应于生长停止的点，因此我们必须求解使 $\\lambda(\\phi) = 0$ 的 $\\phi$ 值。\n$$\n\\lambda(\\phi_{c}) = \\frac{\\kappa_{t} \\kappa_{n}}{\\kappa_{t} + \\kappa_{n}} \\left(1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} - \\phi_{c}\\right) = 0\n$$\n由于生理参数 $\\kappa_{t}$ 和 $\\kappa_{n}$ 严格为正，因此项 $\\frac{\\kappa_{t} \\kappa_{n}}{\\kappa_{t} + \\kappa_{n}}$ 也严格为正。因此，要使整个表达式为零，第二个因子必须为零：\n$$\n1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} - \\phi_{c} = 0\n$$\n求解 $\\phi_{c}$ 可得：\n$$\n\\phi_{c} = 1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0}\n$$\n这是第三个也是最后一个所需的表达式。给定的约束条件 $1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} > 0$ 确保了 $\\phi_{c} > 0$，这在物理上是有意义的。对于任何 $\\phi > \\phi_{c}$，模型预测 $\\lambda$ 为负，这是不符合物理实际的，从而证实 $\\phi_{c}$ 是最大可持续负荷。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\kappa_{t} \\kappa_{n}}{\\kappa_{t} + \\kappa_{n}} (1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} - \\phi) \\\\ \\phi \\frac{\\kappa_{t} \\kappa_{n}}{\\kappa_{t} + \\kappa_{n}} (1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} - \\phi) \\\\ 1 - \\phi_{U} - \\phi_{R}^{0} - \\phi_{P}^{0} \\end{pmatrix}}\n$$", "id": "2732169"}, {"introduction": "一个工程微生物诊断系统的最终价值体现在其临床应用的可靠性上。除了电路本身的生物物理特性，我们还必须使用概率论的工具来评估其作为诊断测试的整体性能。本练习将引导您分解一个复杂的体内诊断系统，计算其灵敏度（sensitivity）和特异性（specificity），并进一步推导阳性预测值（PPV）和阴性预测值（NPV）如何依赖于疾病的流行率，从而确定其临床应用的有效范围。[@problem_id:2732160]", "problem": "一种工程共生菌被设计用作肠道炎症的体内诊断工具。在感知到宿主炎症信号后，该细菌会表达一种分泌标记物，该标记物可通过尿液检测进行测量。考虑以下机制组成部分，每个部分在不同宿主之间以及在标准化的观察窗口内都被视为独立的伯努利事件，其参数为常数：\n- 工程微生物的宿主定植概率为 $c = 0.85$。\n- 在存在疾病且微生物已定植的情况下，该生物线路在观察窗口内产生高于检测限的标记物的概率为 $r = 0.90$。\n- 在不存在疾病但微生物已定植的情况下，该生物线路存在基础泄漏，在观察窗口内产生标记物的概率为 $f_{b} = 0.02$。\n- 当尿液中存在标记物时，尿液检测法以分析真阳性概率 $a_{\\mathrm{tp}} = 0.97$ 检测到标记物；当标记物不存在时，产生假阳性的概率为 $a_{\\mathrm{fp}} = 0.01$。\n\n如果尿液检测读数为阳性，则定义二元诊断测试结果为阳性，否则为阴性。设疾病患病率为 $p \\in [0,1]$。仅从基本概率定义、全概率公式和贝叶斯定理出发，完成以下任务：\n1. 用 $c$、$r$、$f_{b}$、$a_{\\mathrm{tp}}$ 和 $a_{\\mathrm{fp}}$ 推导出总体诊断灵敏度 $\\mathrm{Se} = \\mathbb{P}(\\text{test} + \\mid \\text{disease})$ 和特异度 $\\mathrm{Sp} = \\mathbb{P}(\\text{test} - \\mid \\text{no disease})$。\n2. 将阳性预测值 (PPV) $\\mathrm{PPV}(p) = \\mathbb{P}(\\text{disease} \\mid \\text{test} +)$ 和阴性预测值 (NPV) $\\mathrm{NPV}(p) = \\mathbb{P}(\\text{no disease} \\mid \\text{test} -)$ 表示为 $p$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 的函数。\n3. 在此临床项目中，如果一个诊断方法同时满足 $\\mathrm{PPV}(p) \\geq 0.80$ 和 $\\mathrm{NPV}(p) \\geq 0.95$，则认为其具有临床应用价值。在给定参数值的情况下，确定患病率阈值 $p_{\\min}$ 和 $p_{\\max}$，其中 $p_{\\min}$ 是使 $\\mathrm{PPV}(p) \\geq 0.80$ 成立的最小 $p$ 值，$p_{\\max}$ 是使 $\\mathrm{NPV}(p) \\geq 0.95$ 成立的最大 $p$ 值。报告你最终的 $p_{\\min}$ 和 $p_{\\max}$ 数值，四舍五入到四位有效数字。将患病率表示为 $[0,1]$ 内的无量纲分数。\n\n你的最终答案必须是以行矩阵形式表示的有序对 $\\big(p_{\\min},\\,p_{\\max}\\big)$。", "solution": "该问题陈述具有科学依据，提法恰当，并包含足够的信息以获得唯一解。这是概率论在评估诊断测试中的一个标准应用。因此，该问题是有效的，我们开始求解。\n\n首先，我们根据问题描述定义相关事件：\n- $D$: 患者患有该疾病。\n- $D^c$: 患者未患有该疾病。\n- $C$: 工程微生物在宿主肠道中定植。\n- $M$: 产生的标记物浓度高于检测方法的检测限。\n- $T+$: 诊断测试得出阳性结果。\n- $T-$: 诊断测试得出阴性结果。\n\n给定的概率为：\n- 疾病患病率: $\\mathbb{P}(D) = p$\n- 定植概率: $\\mathbb{P}(C) = c = 0.85$\n- 在存在疾病且已定植的情况下产生标记物的概率: $\\mathbb{P}(M \\mid D, C) = r = 0.90$\n- 在不存在疾病但已定植的情况下产生标记物的概率: $\\mathbb{P}(M \\mid D^c, C) = f_b = 0.02$\n- 检测真阳性概率: $\\mathbb{P}(T+ \\mid M) = a_{\\mathrm{tp}} = 0.97$\n- 检测假阳性概率: $\\mathbb{P}(T+ \\mid M^c) = a_{\\mathrm{fp}} = 0.01$\n\n题目说明定植与疾病状态无关，因此 $\\mathbb{P}(C \\mid D) = \\mathbb{P}(C \\mid D^c) = \\mathbb{P}(C) = c$。如果微生物未定植，则不会产生标记物，因此 $\\mathbb{P}(M \\mid D, C^c) = 0$ 且 $\\mathbb{P}(M \\mid D^c, C^c) = 0$。\n\n**1. 灵敏度 ($\\mathrm{Se}$) 和特异度 ($\\mathrm{Sp}$) 的推导**\n\n灵敏度定义为 $\\mathrm{Se} = \\mathbb{P}(T+ \\mid D)$。我们使用全概率公式，以标记物 $M$ 的存在为条件。\n$$ \\mathrm{Se} = \\mathbb{P}(T+ \\mid D) = \\mathbb{P}(T+ \\mid M, D)\\mathbb{P}(M \\mid D) + \\mathbb{P}(T+ \\mid M^c, D)\\mathbb{P}(M^c \\mid D) $$\n在给定标记物存在的情况下，检测方法的性能与疾病状态条件独立。因此，$\\mathbb{P}(T+ \\mid M, D) = \\mathbb{P}(T+ \\mid M) = a_{\\mathrm{tp}}$ 且 $\\mathbb{P}(T+ \\mid M^c, D) = \\mathbb{P}(T+ \\mid M^c) = a_{\\mathrm{fp}}$。\n我们必须求出 $\\mathbb{P}(M \\mid D)$。我们再次使用全概率公式，以定植 $C$ 为条件。\n$$ \\mathbb{P}(M \\mid D) = \\mathbb{P}(M \\mid D, C)\\mathbb{P}(C \\mid D) + \\mathbb{P}(M \\mid D, C^c)\\mathbb{P}(C^c \\mid D) = r \\cdot c + 0 \\cdot (1-c) = rc $$\n所以，$\\mathbb{P}(M^c \\mid D) = 1 - \\mathbb{P}(M \\mid D) = 1 - rc$。\n将这些代入 $\\mathrm{Se}$ 的表达式中：\n$$ \\mathrm{Se} = a_{\\mathrm{tp}}(rc) + a_{\\mathrm{fp}}(1 - rc) $$\n特异度定义为 $\\mathrm{Sp} = \\mathbb{P}(T- \\mid D^c) = 1 - \\mathbb{P}(T+ \\mid D^c)$。我们首先求出 $\\mathbb{P}(T+ \\mid D^c)$。\n$$ \\mathbb{P}(T+ \\mid D^c) = \\mathbb{P}(T+ \\mid M, D^c)\\mathbb{P}(M \\mid D^c) + \\mathbb{P}(T+ \\mid M^c, D^c)\\mathbb{P}(M^c \\mid D^c) $$\n类似地，$\\mathbb{P}(T+ \\mid M, D^c) = a_{\\mathrm{tp}}$ 且 $\\mathbb{P}(T+ \\mid M^c, D^c) = a_{\\mathrm{fp}}$。\n我们通过以定植为条件来求 $\\mathbb{P}(M \\mid D^c)$：\n$$ \\mathbb{P}(M \\mid D^c) = \\mathbb{P}(M \\mid D^c, C)\\mathbb{P}(C \\mid D^c) + \\mathbb{P}(M \\mid D^c, C^c)\\mathbb{P}(C^c \\mid D^c) = f_b \\cdot c + 0 \\cdot (1-c) = f_b c $$\n所以，$\\mathbb{P}(M^c \\mid D^c) = 1 - f_b c$。\n代入这些值得到：\n$$ \\mathbb{P}(T+ \\mid D^c) = a_{\\mathrm{tp}}(f_b c) + a_{\\mathrm{fp}}(1 - f_b c) $$\n因此，特异度为：\n$$ \\mathrm{Sp} = 1 - [a_{\\mathrm{tp}}(f_b c) + a_{\\mathrm{fp}}(1 - f_b c)] $$\n\n**2. 阳性预测值 (PPV) 和阴性预测值 (NPV) 的推导**\n\nPPV 定义为 $\\mathrm{PPV}(p) = \\mathbb{P}(D \\mid T+)$。使用贝叶斯定理：\n$$ \\mathrm{PPV}(p) = \\frac{\\mathbb{P}(T+ \\mid D)\\mathbb{P}(D)}{\\mathbb{P}(T+)} $$\n对分母使用全概率公式：\n$$ \\mathbb{P}(T+) = \\mathbb{P}(T+ \\mid D)\\mathbb{P}(D) + \\mathbb{P}(T+ \\mid D^c)\\mathbb{P}(D^c) $$\n代入定义 $\\mathbb{P}(D)=p$、$\\mathbb{P}(D^c)=1-p$、$\\mathbb{P}(T+\\mid D)=\\mathrm{Se}$ 和 $\\mathbb{P}(T+\\mid D^c)=1-\\mathrm{Sp}$：\n$$ \\mathrm{PPV}(p) = \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)} $$\nNPV 定义为 $\\mathrm{NPV}(p) = \\mathbb{P}(D^c \\mid T-)$。使用贝叶斯定理：\n$$ \\mathrm{NPV}(p) = \\frac{\\mathbb{P}(T- \\mid D^c)\\mathbb{P}(D^c)}{\\mathbb{P}(T-)} $$\n对分母使用全概率公式：\n$$ \\mathbb{P}(T-) = \\mathbb{P}(T- \\mid D^c)\\mathbb{P}(D^c) + \\mathbb{P}(T- \\mid D)\\mathbb{P}(D) $$\n代入 $\\mathbb{P}(T-\\mid D^c)=\\mathrm{Sp}$ 和 $\\mathbb{P}(T-\\mid D)=1-\\mathrm{Se}$：\n$$ \\mathrm{NPV}(p) = \\frac{\\mathrm{Sp} \\cdot (1-p)}{\\mathrm{Sp} \\cdot (1-p) + (1-\\mathrm{Se})p} $$\n\n**3. 患病率阈值 $p_{\\min}$ 和 $p_{\\max}$ 的计算**\n\n首先，我们使用给定参数计算 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 的数值：$c = 0.85$，$r = 0.90$，$f_b = 0.02$，$a_{\\mathrm{tp}} = 0.97$，$a_{\\mathrm{fp}} = 0.01$。\n$rc = 0.90 \\times 0.85 = 0.765$。\n$\\mathrm{Se} = 0.97(0.765) + 0.01(1 - 0.765) = 0.74205 + 0.01(0.235) = 0.74205 + 0.00235 = 0.7444$。\n$f_b c = 0.02 \\times 0.85 = 0.017$。\n$\\mathrm{Sp} = 1 - [0.97(0.017) + 0.01(1 - 0.017)] = 1 - [0.01649 + 0.01(0.983)] = 1 - [0.01649 + 0.00983] = 1 - 0.02632 = 0.97368$。\n\n为了找到 $p_{\\min}$，我们求解 $\\mathrm{PPV}(p) \\geq 0.80$。由于 $\\mathrm{PPV}(p)$ 是 $p$ 的单调递增函数，$p_{\\min}$ 可以通过解等式得到：\n$$ \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)} = 0.80 $$\n$$ p \\cdot \\mathrm{Se} = 0.80 \\cdot (\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)) $$\n$$ p \\cdot \\mathrm{Se} (1 - 0.80) = 0.80 \\cdot (1 - \\mathrm{Sp})(1 - p) $$\n$$ p \\cdot 0.20 \\cdot \\mathrm{Se} = 0.80 \\cdot (1 - \\mathrm{Sp}) - 0.80 \\cdot p \\cdot (1 - \\mathrm{Sp}) $$\n$$ p(0.20 \\cdot \\mathrm{Se} + 0.80 \\cdot(1 - \\mathrm{Sp})) = 0.80 \\cdot (1 - \\mathrm{Sp}) $$\n$$ p_{\\min} = \\frac{0.80(1 - \\mathrm{Sp})}{0.20 \\cdot \\mathrm{Se} + 0.80(1 - \\mathrm{Sp})} $$\n代入数值：$1 - \\mathrm{Sp} = 0.02632$ 和 $\\mathrm{Se} = 0.7444$。\n$$ p_{\\min} = \\frac{0.80(0.02632)}{0.20(0.7444) + 0.80(0.02632)} = \\frac{0.021056}{0.14888 + 0.021056} = \\frac{0.021056}{0.169936} \\approx 0.123905 $$\n四舍五入到四位有效数字，$p_{\\min} = 0.1239$。\n\n为了找到 $p_{\\max}$，我们求解 $\\mathrm{NPV}(p) \\geq 0.95$。由于 $\\mathrm{NPV}(p)$ 是 $p$ 的单调递减函数，$p_{\\max}$ 可以通过解等式得到：\n$$ \\frac{\\mathrm{Sp} \\cdot (1-p)}{\\mathrm{Sp} \\cdot (1-p) + (1-\\mathrm{Se})p} = 0.95 $$\n$$ \\mathrm{Sp}(1 - p) = 0.95 (\\mathrm{Sp}(1 - p) + (1 - \\mathrm{Se})p) $$\n$$ (1-p) \\mathrm{Sp} (1 - 0.95) = 0.95 \\cdot (1 - \\mathrm{Se})p $$\n$$ 0.05 \\cdot \\mathrm{Sp} (1-p) = 0.95 \\cdot (1 - \\mathrm{Se})p $$\n$$ 0.05 \\cdot \\mathrm{Sp} = p(0.05 \\cdot \\mathrm{Sp} + 0.95(1 - \\mathrm{Se})) $$\n$$ p_{\\max} = \\frac{0.05 \\cdot \\mathrm{Sp}}{0.05 \\cdot \\mathrm{Sp} + 0.95(1 - \\mathrm{Se})} $$\n代入数值：$1 - \\mathrm{Se} = 1 - 0.7444 = 0.2556$ 和 $\\mathrm{Sp} = 0.97368$。\n$$ p_{\\max} = \\frac{0.05(0.97368)}{0.05(0.97368) + 0.95(0.2556)} = \\frac{0.048684}{0.048684 + 0.24282} = \\frac{0.048684}{0.291504} \\approx 0.166992 $$\n四舍五入到四位有效数字，$p_{\\max} = 0.1670$。\n\n因此，患病率阈值为 $p_{\\min} = 0.1239$ 和 $p_{\\max} = 0.1670$。", "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0.1239 & 0.1670\n\\end{pmatrix}\n} $$", "id": "2732160"}]}