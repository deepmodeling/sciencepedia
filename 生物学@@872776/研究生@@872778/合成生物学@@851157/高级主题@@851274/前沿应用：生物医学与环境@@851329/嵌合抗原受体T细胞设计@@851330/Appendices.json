{"hands_on_practices": [{"introduction": "CAR-T细胞的功能始于其细胞表面CAR分子的表达，但这种表达并非恒定不变。基因表达的内在随机性导致每个细胞上的受体数量存在波动。本练习 [@problem_id:2720770] 将引导你使用一个基本的生灭过程模型，从化学主方程的第一性原理出发，推导CAR分子数量在稳态时的平均值和方差。这有助于我们理解细胞异质性的来源，并为后续的信号传导和功能建模奠定基础。", "problem": "一个经过工程改造、在组成型启动子下表达嵌合抗原受体（CAR）的T淋巴细胞，其受体-蛋白水平的模型如下。质膜上的CAR分子数量，记为 $N(t)$，由于两种相反的过程，作为一个在非负整数上进行演化的连续时间马尔可夫过程：(i) 以恒定速率 $\\alpha$（单位时间内的分子数）进行的有效零级生成，该过程将转录、翻译和运输至细胞膜的过程作为一个单一的粗粒度步骤；(ii) 以速率 $\\delta N(t)$（单位时间内）进行的一级损失，该过程代表内吞和降解，其中 $\\delta$ 是一个常数。假设细胞内环境充分混合、环境条件恒定，并且该过程满足化学主方程（CME）的基本假设，即事件以给定的倾向性作为无记忆的泊松过程发生。\n\n从CME所编码的基本随机动力学以及零级出生和一级死亡的生灭过程的定义出发，推导 $N$ 的稳态概率分布，然后计算CAR数量的稳态均值和方差。请从第一性原理出发提供您的推理过程，不要先验地假设稳态分布的任何特定形式。\n\n将您的最终答案表示为行矩阵 $\\begin{pmatrix}\\mu_{\\mathrm{ss}}  \\sigma_{\\mathrm{ss}}^{2}\\end{pmatrix}$，用 $\\alpha$ 和 $\\delta$ 表示。不需要数值近似，最终答案中不应包含单位。如果得到闭式表达式，请保留其精确形式，不要四舍五入。", "solution": "问题陈述已经过分析，并被确定为有效。它具有科学依据，问题设定良好，客观且内部一致，是随机系统生物学中的一个典型问题。我们可以开始求解。\n\n该系统将细胞膜上的CAR分子数量 $N$ 描述为一个连续时间的生灭过程。系统的状态是整数 $n$，代表分子数量。两个随机过程是：\n1. 生成（出生）：一个物种，我们可以表示为 $\\emptyset$，被转化为一个CAR分子 $N$。反应为 $\\emptyset \\xrightarrow{\\alpha} N$。这是一个零级过程，意味着其倾向性（速率）是恒定的，与现有分子的数量无关。对于具有 $n$ 个分子的状态，其出生率为 $b_n = \\alpha$。\n2. 降解（死亡）：一个CAR分子 $N$ 从系统中移除。反应为 $N \\xrightarrow{\\delta} \\emptyset$。这是一个一级过程，意味着其倾向性与存在的分子数量成正比。对于具有 $n$ 个分子的状态，其死亡率为 $d_n = \\delta n$。\n\n令 $P(n, t)$ 为在时间 $t$ 有 $n$ 个分子的概率。该概率分布的时间演化由化学主方程（CME）控制。状态 $n$ 的概率变化 $\\frac{dP(n, t)}{dt}$ 是流入状态 $n$ 的概率通量之和减去流出状态 $n$ 的通量之和。\n\n流入状态 $n$ 的通量：\n- 从状态 $n-1$ 通过生成而来：倾向性为 $\\alpha$，因此通量为 $\\alpha P(n-1, t)$。\n- 从状态 $n+1$ 通过降解而来：倾向性为 $\\delta(n+1)$，因此通量为 $\\delta(n+1) P(n+1, t)$。\n\n流出状态 $n$ 的通量：\n- 到状态 $n+1$ 通过生成而去：倾向性为 $\\alpha$，因此通量为 $\\alpha P(n, t)$。\n- 到状态 $n-1$ 通过降解而去：倾向性为 $\\delta n$，因此通量为 $\\delta n P(n, t)$。\n\n因此，CME为：\n$$ \\frac{dP(n, t)}{dt} = \\alpha P(n-1, t) + \\delta(n+1)P(n+1, t) - (\\alpha + \\delta n)P(n, t) \\quad \\text{for } n \\ge 1 $$\n必须为 $n=0$ 考虑一个特殊情况，因为不可能有从状态 $n=-1$ 的跃迁，也没有从状态 $n=0$ 的降解：\n$$ \\frac{dP(0, t)}{dt} = \\delta P(1, t) - \\alpha P(0, t) $$\n\n我们寻求稳态或定态概率分布 $P_{\\mathrm{ss}}(n)$，其中对于所有 $n$ 都有 $\\frac{dP_{\\mathrm{ss}}(n)}{dt} = 0$。为简化起见，我们将此分布表示为 $P(n)$。稳态方程为：\n$$ 0 = \\alpha P(n-1) + \\delta(n+1)P(n+1) - (\\alpha + \\delta n)P(n) \\quad \\text{for } n \\ge 1 $$\n$$ 0 = \\delta P(1) - \\alpha P(0) \\quad \\text{for } n = 0 $$\n对于处于稳态的一维生灭过程，任何两个相邻状态之间的净概率通量必须为零。这个原理被称为细致平衡。从状态 $n$ 到 $n+1$ 的通量是由于生成，等于 $\\alpha P(n)$。从 $n+1$ 到 $n$ 的通量是由于降解，等于 $\\delta(n+1)P(n+1)$。将这两者相等得到细致平衡条件：\n$$ \\alpha P(n) = \\delta(n+1) P(n+1) \\quad \\text{for } n \\ge 0 $$\n这个单一的递推关系等价于整套稳态主方程。我们可以迭代求解，以 $P(0)$ 表示 $P(n)$：\n$$ P(n+1) = \\frac{\\alpha}{\\delta(n+1)} P(n) $$\n当 $n=0$ 时：$P(1) = \\frac{\\alpha}{\\delta(1)}P(0) = \\frac{\\alpha}{\\delta}P(0)$\n当 $n=1$ 时：$P(2) = \\frac{\\alpha}{\\delta(2)}P(1) = \\frac{\\alpha}{2\\delta} \\left(\\frac{\\alpha}{\\delta}P(0)\\right) = \\frac{1}{2}\\left(\\frac{\\alpha}{\\delta}\\right)^2 P(0)$\n继续这个过程，我们可以看到一个模式出现：\n$P(n) = \\frac{\\alpha}{n\\delta} P(n-1) = \\frac{\\alpha}{n\\delta} \\frac{\\alpha}{(n-1)\\delta} \\cdots \\frac{\\alpha}{1\\delta} P(0) = \\frac{1}{n!} \\left(\\frac{\\alpha}{\\delta}\\right)^n P(0)$。\n\n为了确定 $P(0)$，我们使用归一化条件，即所有概率之和必须等于1：\n$$ \\sum_{n=0}^{\\infty} P(n) = 1 $$\n$$ \\sum_{n=0}^{\\infty} \\frac{1}{n!} \\left(\\frac{\\alpha}{\\delta}\\right)^n P(0) = 1 $$\n$$ P(0) \\sum_{n=0}^{\\infty} \\frac{1}{n!} \\left(\\frac{\\alpha}{\\delta}\\right)^n = 1 $$\n这个求和是指数函数的泰勒级数展开式，$\\sum_{k=0}^{\\infty} \\frac{x^k}{k!} = \\exp(x)$。令 $x = \\alpha/\\delta$，我们有：\n$$ P(0) \\exp\\left(\\frac{\\alpha}{\\delta}\\right) = 1 \\implies P(0) = \\exp\\left(-\\frac{\\alpha}{\\delta}\\right) $$\n将此代回我们关于 $P(n)$ 的表达式，我们得到稳态分布：\n$$ P(n) = \\frac{(\\alpha/\\delta)^n}{n!} \\exp\\left(-\\frac{\\alpha}{\\delta}\\right) $$\n这是一个参数为 $\\lambda = \\frac{\\alpha}{\\delta}$ 的泊松分布。\n\n现在，我们计算稳态均值 $\\mu_{\\mathrm{ss}}$ 和方差 $\\sigma_{\\mathrm{ss}}^2$。\n均值是 $N$ 的期望值：\n$$ \\mu_{\\mathrm{ss}} = \\langle N \\rangle = \\sum_{n=0}^{\\infty} n P(n) $$\n对于参数为 $\\lambda$ 的泊松分布，其均值为 $\\lambda$。我们从第一性原理证明这一点：\n$$ \\mu_{\\mathrm{ss}} = \\sum_{n=0}^{\\infty} n \\frac{\\lambda^n}{n!} \\exp(-\\lambda) = \\exp(-\\lambda) \\sum_{n=1}^{\\infty} n \\frac{\\lambda^n}{n!} $$\n因为当 $n \\ge 1$ 时，$n/n! = 1/(n-1)!$：\n$$ \\mu_{\\mathrm{ss}} = \\exp(-\\lambda) \\sum_{n=1}^{\\infty} \\frac{\\lambda^n}{(n-1)!} $$\n令 $k=n-1$。求和变为：\n$$ \\mu_{\\mathrm{ss}} = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^{k+1}}{k!} = \\lambda \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^k}{k!} = \\lambda \\exp(-\\lambda) \\exp(\\lambda) = \\lambda $$\n因此，稳态均值为 $\\mu_{\\mathrm{ss}} = \\frac{\\alpha}{\\delta}$。\n\n接下来，我们计算方差 $\\sigma_{\\mathrm{ss}}^2 = \\langle N^2 \\rangle - \\mu_{\\mathrm{ss}}^2$。\n对于泊松分布，其方差也等于其参数 $\\lambda$。我们通过先计算二阶阶乘矩 $\\langle N(N-1) \\rangle$ 来推导这一点：\n$$ \\langle N(N-1) \\rangle = \\sum_{n=0}^{\\infty} n(n-1) P(n) = \\exp(-\\lambda) \\sum_{n=2}^{\\infty} n(n-1) \\frac{\\lambda^n}{n!} $$\n求和从 $n=2$ 开始，因为当 $n=0,1$ 时因子 $n(n-1)$ 为零。\n$$ \\langle N(N-1) \\rangle = \\exp(-\\lambda) \\sum_{n=2}^{\\infty} \\frac{\\lambda^n}{(n-2)!} $$\n令 $k=n-2$。求和变为：\n$$ \\langle N(N-1) \\rangle = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^{k+2}}{k!} = \\lambda^2 \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{\\lambda^k}{k!} = \\lambda^2 \\exp(-\\lambda) \\exp(\\lambda) = \\lambda^2 $$\n二阶矩 $\\langle N^2 \\rangle$ 与阶乘矩的关系为 $\\langle N^2 \\rangle = \\langle N(N-1) \\rangle + \\langle N \\rangle$。\n$$ \\langle N^2 \\rangle = \\lambda^2 + \\lambda $$\n那么方差为：\n$$ \\sigma_{\\mathrm{ss}}^2 = \\langle N^2 \\rangle - \\mu_{\\mathrm{ss}}^2 = (\\lambda^2 + \\lambda) - (\\lambda)^2 = \\lambda $$\n因此，稳态方差为 $\\sigma_{\\mathrm{ss}}^2 = \\frac{\\alpha}{\\delta}$。\n\n总而言之，对于给定的生灭过程，CAR分子的稳态数量服从参数为 $\\lambda = \\alpha/\\delta$ 的泊松分布。均值和方差都等于此参数。\n$\\mu_{\\mathrm{ss}} = \\frac{\\alpha}{\\delta}$\n$\\sigma_{\\mathrm{ss}}^2 = \\frac{\\alpha}{\\delta}$\n所要求的结果是行矩阵 $\\begin{pmatrix}\\mu_{\\mathrm{ss}}  \\sigma_{\\mathrm{ss}}^{2}\\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha}{\\delta}  \\frac{\\alpha}{\\delta}\n\\end{pmatrix}\n}\n$$", "id": "2720770"}, {"introduction": "CAR-T疗法的核心挑战之一是在有效清除肿瘤细胞（敏感性）和避免攻击健康组织（特异性）之间取得平衡。本练习 [@problem_id:2720703] 将一个关键的CAR-T设计问题——设定最佳激活阈值——构建为一个贝叶斯决策理论问题。你将通过对数正态分布对肿瘤和健康细胞上的抗原密度进行建模，从而计算出能最小化总分类错误的理论最优阈值，深刻理解敏感性与特异性之间的权衡。", "problem": "一种嵌合抗原受体T细胞 (CAR-T细胞) 经过改造，当其遇到表面抗原密度超过一个可调信号阈值（记为每个细胞 $\\theta$ 个分子）的靶细胞时会被激活。考虑一种抗原，其在肿瘤细胞上的每个细胞拷贝数由对数正态随机变量 $A_{T} \\sim \\mathrm{LogNormal}(\\mu_{T}, \\sigma^{2})$ 建模，在健康的旁观细胞上由 $A_{H} \\sim \\mathrm{LogNormal}(\\mu_{H}, \\sigma^{2})$ 建模，其中 $\\ln(A_{T}) \\sim \\mathcal{N}(\\mu_{T}, \\sigma^{2})$ 且 $\\ln(A_{H}) \\sim \\mathcal{N}(\\mu_{H}, \\sigma^{2})$。假设肿瘤细胞的中位数为每个细胞 $10^{5}$ 个分子，健康细胞的中位数为每个细胞 $10^{3}$ 个分子，因此 $\\mu_{T} = \\ln(10^{5})$ 且 $\\mu_{H} = \\ln(10^{3})$，共享的对数空间标准差为 $\\sigma = 0.7$。假设在与安全性和有效性相关的细胞相遇事件中，随机遇到的细胞是肿瘤细胞的概率为 $p_{T} = 0.4$，是健康细胞的概率为 $p_{H} = 0.6$，并且对健康细胞的错误激活和对肿瘤细胞的漏激活所产生的分类成本相等。\n\n使用贝叶斯决策理论的基本原理和对数正态概率密度的定义，从这些前提出发，推导出使期望总分类误差（在给定相遇概率下的假阳性概率和假阴性概率之和）最小化的阈值 $\\theta$ 的解析表达式，然后使用上述参数对其进行数值计算。将最终阈值 $\\theta$ 以每个细胞的分子数表示，并将您的数值答案四舍五入至三位有效数字。\n\n最后，从灵敏度和特异性的角度，定性地解释将 $\\theta$ 从误差最小化值增加或减少，如何在肿瘤激活和脱靶安全性之间进行权衡。在此讨论中不要计算任何额外的数值。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n逐字提取给定的条件如下：\n- CAR-T细胞的激活阈值为 $\\theta$。\n- 肿瘤细胞上的抗原拷贝数 $A_{T}$ 服从对数正态分布：$A_{T} \\sim \\mathrm{LogNormal}(\\mu_{T}, \\sigma^{2})$。\n- 健康细胞上的抗原拷贝数 $A_{H}$ 服从对数正态分布：$A_{H} \\sim \\mathrm{LogNormal}(\\mu_{H}, \\sigma^{2})$。\n- 与正态分布的关系是 $\\ln(A_{T}) \\sim \\mathcal{N}(\\mu_{T}, \\sigma^{2})$ 且 $\\ln(A_{H}) \\sim \\mathcal{N}(\\mu_{H}, \\sigma^{2})$。\n- 肿瘤细胞的抗原计数中位数为 $10^{5}$，意味着 $\\mu_{T} = \\ln(10^{5})$。\n- 健康细胞的抗原计数中位数为 $10^{3}$，意味着 $\\mu_{H} = \\ln(10^{3})$。\n- 共享的对数空间标准差为 $\\sigma = 0.7$。\n- 遇到肿瘤细胞的概率为 $p_{T} = 0.4$。\n- 遇到健康细胞的概率为 $p_{H} = 0.6$。\n- 对健康细胞的错误激活（假阳性）和对肿瘤细胞的漏激活（假阴性）的分类成本相等。\n\n该问题具有科学依据，使用了生物学量的标准统计模型并应用了贝叶斯决策理论。该问题提法恰当，提供了所有必需的参数（$\\mu_T, \\mu_H, \\sigma, p_T, p_H$）和一个明确的要最小化的目标函数。其前提在数学上是一致的，没有违反任何物理或逻辑原理。因此，该问题被认为是有效的，可以推导出解决方案。\n\n目标是找到使期望总分类误差最小化的阈值 $\\theta$。分类误差有两种类型：\n$1$. 假阴性（漏掉的肿瘤），其发生概率为 $P(A_{T} \\le \\theta)$。\n$2$. 假阳性（攻击健康细胞），其发生概率为 $P(A_{H} > \\theta)$。\n\n鉴于与这些误差相关的成本相等，最小化期望成本等同于最小化总误差概率 $E(\\theta)$，即每种误差类型概率的加权和。权重是遇到每种细胞类型的先验概率 $p_T$ 和 $p_H$。\n$$E(\\theta) = p_{T} P(A_{T} \\le \\theta) + p_{H} P(A_{H} > \\theta)$$\n令 $f_{T}(a)$ 和 $f_{H}(a)$ 分别为随机变量 $A_{T}$ 和 $A_{H}$ 的概率密度函数 (PDF)。误差函数可以写成积分形式：\n$$E(\\theta) = p_{T} \\int_{0}^{\\theta} f_{T}(a) da + p_{H} \\int_{\\theta}^{\\infty} f_{H}(a) da$$\n为了找到使 $E(\\theta)$ 最小化的 $\\theta$ 值，我们计算 $E(\\theta)$ 关于 $\\theta$ 的导数，并将其设为零。使用微积分基本定理（具体来说是莱布尼茨积分法则）：\n$$\\frac{d}{d\\theta} \\left( \\int_{0}^{\\theta} f_{T}(a) da \\right) = f_{T}(\\theta)$$\n$$\\frac{d}{d\\theta} \\left( \\int_{\\theta}^{\\infty} f_{H}(a) da \\right) = -f_{H}(\\theta)$$\n因此，误差函数的导数为：\n$$\\frac{dE(\\theta)}{d\\theta} = p_{T} f_{T}(\\theta) - p_{H} f_{H}(\\theta)$$\n将导数设为零，得到最优阈值的条件，我们将其记为 $\\theta_{\\text{opt}}$：\n$$p_{T} f_{T}(\\theta_{\\text{opt}}) = p_{H} f_{H}(\\theta_{\\text{opt}})$$\n这是贝叶斯决策理论的一个标准结果：最优决策边界位于两类后验概率相等之处，在成本相等的情况下，这简化为由先验加权的似然相等。\n\n参数为 $\\mu$ 和 $\\sigma^2$ 的对数正态分布的概率密度函数 (PDF) 由下式给出：\n$$f(a) = \\frac{1}{a\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(a)-\\mu)^2}{2\\sigma^2}\\right)$$\n将 $A_T$ 和 $A_H$ 的 PDF 代入最优性条件：\n$$p_{T} \\frac{1}{\\theta_{\\text{opt}}\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{T})^2}{2\\sigma^2}\\right) = p_{H} \\frac{1}{\\theta_{\\text{opt}}\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{H})^2}{2\\sigma^2}\\right)$$\n公共因子 $\\frac{1}{\\theta_{\\text{opt}}\\sigma\\sqrt{2\\pi}}$ 从两边消去，前提是 $\\theta_{\\text{opt}} > 0$，这一点是有保证的。\n$$p_{T} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{T})^2}{2\\sigma^2}\\right) = p_{H} \\exp\\left(-\\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{H})^2}{2\\sigma^2}\\right)$$\n对两边取自然对数：\n$$\\ln(p_{T}) - \\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{T})^2}{2\\sigma^2} = \\ln(p_{H}) - \\frac{(\\ln(\\theta_{\\text{opt}})-\\mu_{H})^2}{2\\sigma^2}$$\n为了求解 $\\theta_{\\text{opt}}$，我们首先求解 $x = \\ln(\\theta_{\\text{opt}})$。重新整理方程：\n$$(\\ln(x)-\\mu_{H})^2 - (\\ln(x)-\\mu_{T})^2 = 2\\sigma^2 (\\ln(p_{H}) - \\ln(p_{T}))$$\n展开平方项：\n$$(\\ln^2(x) - 2\\ln(x)\\mu_{H} + \\mu_{H}^2) - (\\ln^2(x) - 2\\ln(x)\\mu_{T} + \\mu_{T}^2) = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n$$-2\\ln(x)\\mu_{H} + \\mu_{H}^2 + 2\\ln(x)\\mu_{T} - \\mu_{T}^2 = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n$$2\\ln(x)(\\mu_{T} - \\mu_{H}) - (\\mu_{T}^2 - \\mu_{H}^2) = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n因式分解 $\\mu_{T}^2 - \\mu_{H}^2 = (\\mu_{T} - \\mu_{H})(\\mu_{T} + \\mu_{H})$：\n$$2\\ln(x)(\\mu_{T} - \\mu_{H}) - (\\mu_{T} - \\mu_{H})(\\mu_{T} + \\mu_{H}) = 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n$$2\\ln(x)(\\mu_{T} - \\mu_{H}) = (\\mu_{T} - \\mu_{H})(\\mu_{T} + \\mu_{H}) + 2\\sigma^2 \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n两边同除以 $2(\\mu_{T} - \\mu_{H})$（因为 $\\mu_T \\neq \\mu_H$，所以该项不为零）：\n$$\\ln(x) = \\frac{\\mu_{T} + \\mu_{H}}{2} + \\frac{\\sigma^2}{\\mu_{T} - \\mu_{H}} \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n将 $x = \\theta_{\\text{opt}}$ 代回，我们得到其自然对数的解析表达式：\n$$\\ln(\\theta_{\\text{opt}}) = \\frac{\\mu_{T} + \\mu_{H}}{2} + \\frac{\\sigma^2}{\\mu_{T} - \\mu_{H}} \\ln\\left(\\frac{p_{H}}{p_{T}}\\right)$$\n对两边取指数，得到最优阈值 $\\theta$ 的最终解析表达式：\n$$\\theta_{\\text{opt}} = \\exp\\left( \\frac{\\mu_{T} + \\mu_{H}}{2} + \\frac{\\sigma^2}{\\mu_{T} - \\mu_{H}} \\ln\\left(\\frac{p_{H}}{p_{T}}\\right) \\right)$$\n现在，我们用给定的参数对这个表达式进行数值计算：\n$\\mu_T = \\ln(10^5)$\n$\\mu_H = \\ln(10^3)$\n$\\sigma = 0.7 \\implies \\sigma^2 = 0.49$\n$p_T = 0.4$\n$p_H = 0.6$\n首先，计算指数中的各项：\n$\\frac{\\mu_{T} + \\mu_{H}}{2} = \\frac{\\ln(10^5) + \\ln(10^3)}{2} = \\frac{\\ln(10^5 \\cdot 10^3)}{2} = \\frac{\\ln(10^8)}{2} = 4\\ln(10) = \\ln(10^4)$.\n$\\mu_{T} - \\mu_{H} = \\ln(10^5) - \\ln(10^3) = \\ln\\left(\\frac{10^5}{10^3}\\right) = \\ln(100) = 2\\ln(10)$.\n$\\frac{p_{H}}{p_{T}} = \\frac{0.6}{0.4} = 1.5$.\n将这些代入 $\\ln(\\theta_{\\text{opt}})$ 的表达式中：\n$$\\ln(\\theta_{\\text{opt}}) = \\ln(10^4) + \\frac{0.49}{2\\ln(10)} \\ln(1.5)$$\n$$\\theta_{\\text{opt}} = \\exp\\left( \\ln(10^4) + \\frac{0.49 \\ln(1.5)}{2\\ln(10)} \\right) = \\exp(\\ln(10^4)) \\cdot \\exp\\left(\\frac{0.49 \\ln(1.5)}{2\\ln(10)}\\right)$$\n$$\\theta_{\\text{opt}} = 10^4 \\cdot \\exp\\left(\\frac{0.49 \\times 0.405465...}{2 \\times 2.302585...}\\right) = 10^4 \\cdot \\exp\\left(\\frac{0.198677...}{4.605170...}\\right)$$\n$$\\theta_{\\text{opt}} = 10^4 \\cdot \\exp(0.043141...) = 10^4 \\cdot (1.04408...) \\approx 10440.8$$\n四舍五入至三位有效数字，最优阈值为每个细胞 $10400$ 个分子，或 $1.04 \\times 10^4$。\n\n最后，是对这种权衡的定性解释。CAR-T细胞作为分类器的性能由其灵敏度和特异性来描述。\n- **灵敏度**，或称真阳性率，是在给定肿瘤细胞的情况下激活的概率：$P(A_T > \\theta)$。这对应于肿瘤靶向疗效。\n- **特异性**，或称真阴性率，是在给定健康细胞的情况下不激活的概率：$P(A_H \\le \\theta)$。这对应于脱靶安全性。\n最优阈值 $\\theta_{\\text{opt}}$ 是使特定加权误差和最小化的值。偏离这个值会改变灵敏度和特异性之间的平衡。\n\n- **增加 $\\theta$**：将 $\\theta$ 从 $\\theta_{\\text{opt}}$ 增加会使激活变得更加困难。这增加了 CAR-T 细胞的严格性。因此，在健康细胞上激活的概率降低，导致特异性增加（$P(A_H \\le \\theta)$ 增加）。这改善了脱靶安全性。然而，在肿瘤细胞上激活的概率也降低，导致灵敏度降低（$P(A_T > \\theta)$ 降低）。这减少了肿瘤靶向疗效。因此，增加 $\\theta$ 是以灵敏度换取特异性。\n\n- **减少 $\\theta$**：将 $\\theta$ 从 $\\theta_{\\text{opt}}$ 减少会使激活变得更容易。这降低了 CAR-T 细胞的严格性。因此，在肿瘤细胞上激活的概率增加，导致灵敏度增加（$P(A_T > \\theta)$ 增加）。这增强了肿瘤靶向疗效。然而，在健康细胞上激活的概率也增加，意味着在健康细胞上不激活的概率降低。这是特异性的降低（$P(A_H \\le \\theta)$ 降低），损害了脱靶安全性。因此，减少 $\\theta$ 是以特异性换取灵敏度。\n计算出的 $\\theta_{\\text{opt}}$ 代表了在给定的先验概率和相等的误差成本下，合理推导出的平衡点。", "answer": "$$\n\\boxed{1.04 \\times 10^{4}}\n$$", "id": "2720703"}, {"introduction": "肿瘤细胞可能通过下调或丢失靶向抗原来逃避CAR-T细胞的识别，这是导致治疗失败的一个主要原因。通过设计具有逻辑门（如AND或OR门）功能的CAR-T细胞来同时识别多种抗原，是克服这一挑战的先进策略。本练习 [@problem_id:2720727] 要求你运用概率论的基本原理，量化比较单靶点、AND门和OR门三种设计在面对独立抗原丢失事件时的“肿瘤逃逸概率”，从而评估不同逻辑设计的鲁棒性。", "problem": "嵌合抗原受体T细胞（CAR-T细胞）可以通过工程化改造，实现逻辑门控识别，以减少因抗原丢失而导致的肿瘤逃逸。考虑一个肿瘤细胞群体，其中每个细胞在与CAR-T细胞相遇时独立表达抗原 $A$ 和抗原 $B$。设 $p_A$ 表示随机抽样的一个肿瘤细胞丢失了抗原 $A$ 的概率（即抗原 $A$ 缺失），设 $p_B$ 表示随机抽样的一个肿瘤细胞丢失了抗原 $B$ 的概率。假设抗原 $A$ 和 $B$ 的丢失事件是相互独立的。CAR-T细胞识别一个肿瘤细胞，当且仅当该细胞当前的抗原存在状态满足指定的逻辑条件。\n\n将逃逸概率定义为：随机抽样的一个肿瘤细胞未能满足CAR-T识别逻辑的概率（即未被识别，从而逃避了杀伤）。请根据概率论和布尔逻辑的基本原理，推导以下三种设计的逃逸概率：\n(i) 仅识别抗原 $A$ 的单靶点CAR-T，\n(ii) 具有逻辑与（AND）识别功能的双靶点CAR-T，要求抗原 $A$ 和 $B$ 同时存在，\n(iii) 具有逻辑或（OR）识别功能的双靶点CAR-T，要求抗原 $A$ 或 $B$ 中至少有一个存在。\n\n请用 $p_A$ 和 $p_B$ 表示你的最终结果，并将其简化为解析表达式。请将这三个逃逸概率按 $(\\text{仅A}, \\text{与}, \\text{或})$ 的顺序写成一个行矩阵。无需进行数值计算，也无需报告单位。答案必须是单一的封闭形式解析表达式。", "solution": "对所述问题进行有效性验证。\n\n第1步：提取已知条件。\n- 系统涉及一个肿瘤细胞群体和一个工程化的CAR-T细胞。\n- 所关注的抗原表示为 $A$ 和 $B$。\n- 一个肿瘤细胞丢失抗原 $A$ 的概率为 $p_A$。\n- 一个肿瘤细胞丢失抗原 $B$ 的概率为 $p_B$。\n- 抗原 $A$ 的丢失和抗原 $B$ 的丢失是独立事件。\n- CAR-T细胞的识别由关于抗原存在性的指定逻辑条件决定。\n- 逃逸概率定义为一个肿瘤细胞未被CAR-T细胞识别的概率。\n- 任务是推导三种逻辑门的逃逸概率：(i) 对 $A$ 的单靶点识别，(ii) 双靶点与门控识别（$A$ 和 $B$），以及 (iii) 双靶点或门控识别（$A$ 或 $B$）。\n- 最终结果必须是一个行矩阵，按 $(\\text{仅A}, \\text{与}, \\text{或})$ 的顺序包含这三个概率。\n\n第2步：使用提取的已知条件进行验证。\n该问题是初等概率论在合成免疫学一个标准（尽管简化了）模型中的一个定义明确的练习。\n- **科学依据**：在CAR-T设计中使用逻辑门来对抗抗原逃逸的前提是一个真实且活跃的研究领域。所使用的概率模型是一种有效且常见的简化方法。\n- **适定性**：所有必要的参数（$p_A$，$p_B$）和假设（独立性）都已给出。目标陈述清晰，且存在唯一解。\n- **客观性**：问题以精确、正式的语言陈述，没有主观或模棱-两可的元素。\n\n第3步：结论与行动。\n该问题被认为是有效的。它自成体系、科学合理且逻辑一致。对解进行严格推导是可能且必要的。\n\n我们现在将从基本原理出发进行推导。\n\n让我们定义基本事件。设 $A_p$ 为随机抽样的一个肿瘤细胞上存在抗原 $A$ 的事件，而 $A_a$ 为抗原 $A$ 缺失的事件。类似地，设 $B_p$ 和 $B_a$ 分别为抗原 $B$ 存在和缺失的事件。\n\n根据问题陈述，我们已知抗原缺失的概率：\n$$P(A_a) = p_A$$\n$$P(B_a) = p_B$$\n\n抗原存在的事件是抗原缺失的补集事件。因此，它们的概率是：\n$$P(A_p) = 1 - P(A_a) = 1 - p_A$$\n$$P(B_p) = 1 - P(B_a) = 1 - p_B$$\n\n问题陈述中提到抗原丢失事件是独立的。这意味着抗原 $A$ 的存在或缺失与抗原 $B$ 的存在或缺失在统计上是独立的。对于任意一对事件 $X \\in \\{A_p, A_a\\}$ 和 $Y \\in \\{B_p, B_a\\}$，它们联合发生的概率是它们各自概率的乘积：$P(X \\cap Y) = P(X)P(Y)$。\n\n逃逸概率（记为 $P_{esc}$）是一个肿瘤细胞未被识别的概率。我们将为3种指定的CAR-T设计分别推导这个概率。\n\n(i) 仅识别抗原 $A$ 的单靶点CAR-T。\nCAR-T细胞识别肿瘤细胞当且仅当抗原 $A$ 存在。因此，识别事件为 $A_p$。逃逸事件是识别事件的补集，即 $\\neg A_p$。这等价于抗原 $A$ 缺失的事件 $A_a$。\n逃逸概率为：\n$$P_{esc, A} = P(A_a) = p_A$$\n\n(ii) 具有逻辑与（AND）识别功能的双靶点CAR-T。\nCAR-T细胞识别肿瘤细胞当且仅当抗原 $A$ 和抗原 $B$ 同时存在。识别事件是逻辑合取 $A_p \\land B_p$，对应于事件的交集 $A_p \\cap B_p$。\n逃逸事件是识别事件的逻辑否定：$\\neg (A_p \\land B_p)$。根据德摩根定律，这等价于 $(\\neg A_p) \\lor (\\neg B_p)$，对应于事件的并集 $A_a \\cup B_a$。如果抗原 $A$ 缺失或抗原 $B$ 缺失（或两者都缺失），细胞就会逃逸。\n逃逸概率使用两个事件并集的容斥原理计算：\n$$P_{esc, AND} = P(A_a \\cup B_a) = P(A_a) + P(B_a) - P(A_a \\cap B_a)$$\n由于抗原丢失事件的独立性，$P(A_a \\cap B_a) = P(A_a)P(B_a) = p_A p_B$。\n代入已知概率，我们得到：\n$$P_{esc, AND} = p_A + p_B - p_A p_B$$\n\n(iii) 具有逻辑或（OR）识别功能的双靶点CAR-T。\nCAR-T细胞识别肿瘤细胞当且仅当抗原 $A$ 或抗原 $B$ 中至少有一个存在。识别事件是逻辑析取 $A_p \\lor B_p$，对应于事件的并集 $A_p \\cup B_p$。\n逃逸事件是识别事件的逻辑否定：$\\neg (A_p \\lor B_p)$。根据德摩根定律，这等价于 $(\\neg A_p) \\land (\\neg B_p)$，对应于事件的交集 $A_a \\cap B_a$。细胞只有在抗原 $A$ 缺失并且抗原 $B$ 也缺失的情况下才会逃逸。\n因此，逃逸概率是联合事件 $A_a \\cap B_a$ 的概率：\n$$P_{esc, OR} = P(A_a \\cap B_a)$$\n根据独立性，这是各自概率的乘积：\n$$P_{esc, OR} = P(A_a)P(B_a) = p_A p_B$$\n\n推导出的三个逃逸概率是：\n1.  对于仅A识别：$p_A$\n2.  对于与门控识别：$p_A + p_B - p_A p_B$\n3.  对于或门控识别：$p_A p_B$\n\n这些结果需按指定顺序呈现在一个行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_A  p_A + p_B - p_A p_B  p_A p_B\n\\end{pmatrix}\n}\n$$", "id": "2720727"}]}