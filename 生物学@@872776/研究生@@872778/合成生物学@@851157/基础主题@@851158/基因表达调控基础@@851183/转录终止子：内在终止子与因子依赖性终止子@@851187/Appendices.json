{"hands_on_practices": [{"introduction": "在合成生物学中，精确量化遗传部件的性能至关重要。对于转录终止子，一个核心挑战是如何将其转录终止效率与下游的翻译效率或蛋白质稳定性等混杂因素分离开来。下面的练习将指导你设计一个严谨的双报告基因检测系统，通过巧妙的标准化和对照组设计，来准确地测量终止子的真实强度 [@problem_id:2785294]。", "problem": "你的任务是设计并分析一个双报告基因检测系统，用以量化一个置于单一转录本上两个开放阅读框之间的细菌序列的转录终止子强度。设上游报告基因表示为 $U$，下游报告基因表示为 $D$。在转录水平上，终止子强度定义为 $S = 1 - R$，其中 $R$ 是延伸中的RNA聚合酶通读候选终止子的概率。你将测量两个报告基因的稳态荧光，并使用估计量 $S = 1 - \\text{(下游报告基因)}/\\text{(上游报告基因)}$ 来计算终止子强度。你的目标是选择一种检测设计和控制策略，使得该估计量对于转录终止是无偏的，不受翻译效应或报告蛋白特性的干扰，并且能够区分内在终止和因子依赖性终止（例如，Rho依赖性终止）。\n\n仅使用以下基本原理：分子生物学的中心法则（DNA到RNA到蛋白质），恒定生长条件下稳态蛋白质水平与蛋白质生产速率除以有效蛋白质损失速率（稀释加降解）成正比，稳态信使RNA水平与转录速率除以有效信使RNA损失速率成正比，以及内在终止子（一个稳定的RNA发夹结构后跟一个多聚尿苷酸序列）和因子依赖性终止子（依赖于如Rho和Nus因子等蛋白质）的典型特征。假设在背景扣除和适当的光谱分离后，荧光与成熟蛋白质的丰度成正比，并且测量是在相同生长条件下的稳态下进行的。\n\n哪个选项描述了一种设计和对照组，可以从稳态荧光中得出对 $S$ 的无偏估计，并允许你区分内在终止和因子依赖性终止？\n\nA. 将候选终止子置于单一转录本上的 $U$ 和 $D$ 之间，其结构为：启动子–转录绝缘子（例如，自剪切核酶）–标准化的核糖体结合位点–$U$–终止密码子–间隔区–待测终止子或其发夹结构被破坏的对照–间隔区–嵌入双顺反子设计元件中的标准化核糖体结合位点–$D$。使用两种光谱可分离的、密码子使用频率匹配的荧光蛋白，并通过绝缘子保持相同的上游非翻译区。量化稳态背景扣除后的荧光 $F_U$ 和 $F_D$，并计算归一化估计量\n$$\n\\hat S \\;=\\; 1 \\;-\\; \\frac{\\left(F_D/F_U\\right)_{\\mathrm{T}}}{\\left(F_D/F_U\\right)_{\\mathrm{NT}}} ,\n$$\n其中下标 $\\mathrm{T}$ 表示带有活性终止子的构建体，而 $\\mathrm{NT}$ 是通过破坏发夹结构的点突变创建的无终止子对照，这些突变保留了长度和碱基组成。包括跨信使RNA连接处的逆转录定量聚合酶链式反应以验证通读，一个无启动子的阴性对照来测量自发荧光和泄露，一个反向终止子对照来检测非终止性结构对下游核糖体结合位点的干扰，以及因子依赖性对照：添加bicyclomycin或敲低Rho以测试Rho依赖性，并通过改变NusA水平来调节内在终止。将分析限制在稳态以避免成熟动力学的干扰。\n\nB. 将终止子置于 $U$ 和 $D$ 之间，并计算 $S$ 为 $1 - F_D/F_U$。仅通过计算设计来使核糖体结合位点均等化。为了解耦翻译，在测量过程中添加chloramphenicol以停止翻译，从而消除翻译伪影。通过比较添加rifampicin以阻断转录延伸前后 $S$ 的值来定义因子依赖性。\n\nC. 测量信使RNA丰度而非蛋白质：将终止子置于 $U$ 和 $D$ 之间，通过突变起始密码子完全省略翻译，并计算 $S$ 为 $1 - M_D/M_U$，其中 $M_D$ 和 $M_U$ 是通过逆转录定量聚合酶链式反应测得的稳态连接处特异性信使RNA水平。通过添加bicyclomycin来区分Rho依赖性，并将那些 $S$ 值降低的终止子归类为因子依赖性。\n\nD. 使用相同的荧光蛋白作为 $U$ 和 $D$ 以匹配成熟过程，并将 $F_D$ 归一化到另一个质粒上看家基因的荧光报告基因，同时将 $F_U$ 归一化到光密度。计算 $S$ 为 $1 - \\left(F_D/\\text{看家基因}\\right)/\\left(F_U/\\text{光密度}\\right)$。通过过表达Rho并观察 $S$ 是否增加来识别因子依赖性。\n\n选择唯一的最佳选项。", "solution": "任务是为双报告基因检测系统确定最佳的实验设计和控制策略，以测量转录终止子强度 $S$，其定义为 $S = 1 - R$，其中 $R$ 是通读概率。$S$ 的估计量必须对于转录终止是无偏的，不受翻译或蛋白质特性的干扰，并且必须能够区分内在终止和因子依赖性终止。\n\n首先，我们必须根据所提供的原理建立系统的数学模型。设转录起始速率为 $k_{txn}$。终止子被放置在单个转录单元中上游报告基因（$U$）和下游报告基因（$D$）之间。\n一部分转录本（比例为 $(1-R)$）将在 $U$ 顺反子后终止，而另一部分（比例为 $R$）将通读终止子，产生包含 $U$ 和 $D$ 的全长转录本。\n\n设 $M_U$ 和 $M_D$ 分别为对应 $U$ 和 $D$ 编码序列的稳态mRNA水平。\n包含 $U$ 编码序列的mRNA分子既包括短的、已终止的转录本，也包括长的、全长的转录本。设这些物种的降解速率分别为 $\\delta_{mRNA,short}$ 和 $\\delta_{mRNA,full}$。可用于翻译蛋白质 $U$ 的mRNA总量为：\n$$ M_{U,total} \\propto \\frac{k_{txn}(1-R)}{\\delta_{mRNA,short}} + \\frac{k_{txn}R}{\\delta_{mRNA,full}} $$\n可用于翻译蛋白质 $D$ 的mRNA仅来自于全长转录本：\n$$ M_{D,total} \\propto \\frac{k_{txn}R}{\\delta_{mRNA,full}} $$\n\n蛋白质 $U$ 和 $D$ 的生产速率与其各自的mRNA水平和翻译起始速率 $k_{tln,U}$ 和 $k_{tln,D}$ 成正比。\n$$ \\text{Prod}_U = k_{tln,U} M_{U,total} $$\n$$ \\text{Prod}_D = k_{tln,D} M_{D,total} $$\n在稳态下，蛋白质浓度 $P$ 与生产速率除以有效损失速率 $\\delta_{prot}$（稀释加降解）成正比。荧光 $F$ 与成熟蛋白质浓度成正比，比例常数 $c$ 解释了光谱特性。\n$$ F_U = c_U P_U \\propto c_U \\frac{\\text{Prod}_U}{\\delta_{prot,U}} = c_U \\frac{k_{tln,U} M_{U,total}}{\\delta_{prot,U}} $$\n$$ F_D = c_D P_D \\propto c_D \\frac{\\text{Prod}_D}{\\delta_{prot,D}} = c_D \\frac{k_{tln,D} M_{D,total}}{\\delta_{prot,D}} $$\n\n下游与上游荧光的简单比值为：\n$$ \\frac{F_D}{F_U} = \\left( \\frac{c_D}{c_U} \\cdot \\frac{k_{tln,D}}{k_{tln,U}} \\cdot \\frac{\\delta_{prot,U}}{\\delta_{prot,D}} \\right) \\cdot \\frac{M_{D,total}}{M_{U,total}} $$\n$$ \\frac{F_D}{F_U} = \\left( \\frac{c_D k_{tln,D} \\delta_{prot,U}}{c_U k_{tln,U} \\delta_{prot,D}} \\right) \\cdot \\frac{\\frac{k_{txn}R}{\\delta_{mRNA,full}}}{\\frac{k_{txn}(1-R)}{\\delta_{mRNA,short}} + \\frac{k_{txn}R}{\\delta_{mRNA,full}}} $$\n设括号中的项为偏置因子 $B$。\n$$ \\frac{F_D}{F_U} = B \\cdot \\frac{R/\\delta_{mRNA,full}}{(1-R)/\\delta_{mRNA,short} + R/\\delta_{mRNA,full}} $$\n所提出的估计量 $S = 1 - F_D/F_U$ 显然是有偏的。一个对 $S$ 的无偏估计量要求 $F_D/F_U = R$。这将要求偏置因子 $B=1$（即，相同的报告基因、翻译速率和蛋白质稳定性），并且mRNA降解速率相等，$\\delta_{mRNA,short} = \\delta_{mRNA,full}$。这些是强假设，通常不成立。\n\n一个稳健的实验设计必须通过归一化消除这些偏置。一种标准方法是使用一个没有活性终止子的对照构建体（$S=0$，$R=1$）。我们称之为无终止子（NT）构建体，而带有终止子的构建体称为（T）构建体。对于NT构建体，理想情况下只产生一种mRNA。\n$$ \\left(\\frac{F_D}{F_U}\\right)_{NT} = B \\cdot \\frac{M_{D,total,NT}}{M_{U,total,NT}} = B $$\n这假设对于NT构建体，在考虑了任何序列特异性降解效应后，用于 $U$ 和 $D$ 的mRNA量实际上是相同的，这是一个合理的设计目标。\n通过计算比率的比率，我们得到：\n$$ \\frac{(F_D/F_U)_T}{(F_D/F_U)_{NT}} = \\frac{R/\\delta_{mRNA,full}}{(1-R)/\\delta_{mRNA,short} + R/\\delta_{mRNA,full}} $$\n这种归一化消除了偏置因子 $B$，该因子包含了所有翻译水平和蛋白质特异性的干扰因素。估计量 $\\hat{S} = 1 - \\frac{(F_D/F_U)_T}{(F_D/F_U)_{NT}}$ 现在没有这些偏置。然而，它仍然受到差异性mRNA稳定性（$\\delta_{mRNA,short}$ vs. $\\delta_{mRNA,full}$）的干扰。如果我们能设计NT对照，使其转录本的稳定性（$\\delta_{mRNA,NT}$）与$\\delta_{mRNA,full}$和$\\delta_{mRNA,short}$非常相似，或者如果我们能假设$\\delta_{mRNA,short} \\approx \\delta_{mRNA,full}$，那么估计量就简化为$\\hat{S} \\approx 1-R = S$。一个设计良好的发夹结构破坏突变体作为NT对照有助于满足这个条件。\n\n为了区分终止子类型：\n-   **Rho依赖性**：抑制Rho因子（例如，使用bicyclomycin或通过基因敲低）应降低终止强度 $S$。\n-   **内在性**：该机制依赖于特定的RNA二级结构（发夹）。终止强度通常受NusA等因子调节。一个破坏了发夹结构的对照应该能消除终止作用。\n\n在这个框架下，我们现在评估每个选项。\n\n**选项A**：\n此选项提出了一个复杂的构建体架构：`启动子–转录绝缘子–标准化的RBS–U–终止密码子–间隔区–待测终止子或其发夹结构被破坏的对照–间隔区–嵌入双顺反子设计元件中的标准化RBS–D`。这个设计非常出色。\n-   `转录绝缘子`（例如，核酶）使mRNA的5'端标准化，最大限度地减少了来自启动子的变异性。\n-   用于 $U$ 的`标准化RBS`和用于 $D$ 的`双顺反子设计元件`解决了高效和可预测翻译的挑战。\n-   使用两种光谱上可分离且密码子使用匹配的荧光报告蛋白，适合同时测量。\n-   估计量 $\\hat{S} = 1 - \\frac{\\left(F_D/F_U\\right)_{\\mathrm{T}}}{\\left(F_D/F_U\\right)_{\\mathrm{NT}}}$ 正是消除翻译水平和蛋白质水平偏置所需的比率归一化方法。\n-   `发夹结构被破坏的对照`是NT构建体的正确选择，因为它保留了序列长度和组成，从而最大限度地减少了与mRNA稳定性差异相关的伪影。\n-   额外的对照是全面而严谨的：用于直接验证的`跨连接处RT-qPCR`，用于测量背景的`无启动子对照`，用于排除非终止子RNA结构干扰翻译的`反向对照`，以及用于探究因子依赖性的正确方法（用`bicyclomycin`/`Rho敲低`研究Rho，用调节`NusA`研究内在终止子）。\n此选项满足了无偏和特异性检测的所有要求。\n**结论：正确**\n\n**选项B**：\n此选项建议将 $S$ 计算为 $1 - F_D/F_U$，而没有归一化对照。如上所述，这个估计量是幼稚的，并且充满了偏置。\n-   `计算设计`的RBS是不够的；需要实验性的归一化。\n-   使用`chloramphenicol`是毫无意义的。它会停止所有翻译；你无法通过停止生产来测量稳态生产速率。这将测量蛋白质的衰减，而不是终止效率。\n-   使用`rifampicin`来探究因子依赖性是错误的。Rifampicin抑制所有基因的转录起始，它对任何终止机制都没有特异性。Bicyclomycin才是Rho的特异性抑制剂。\n这个选项显示了对实验原理的根本性误解。\n**结论：错误**\n\n**选项C**：\n此选项建议通过RT-qPCR直接测量mRNA水平，这正确地避免了翻译水平和蛋白质水平的干扰。然而，其实施是有缺陷的。\n-   它计算 $S$ 为 $1 - M_D/M_U$。如推导所示，$M_U$ 的量度包括了终止和通读转录本的mRNA，而 $M_D$ 只测量了通读的mRNA。因此，比率 $M_D/M_U$ 并不是通读率 $R$ 的直接度量，并且会受到与基于蛋白质的比率相同的、由mRNA稳定性差异引起的偏置。\n-   至关重要的是，该选项省略了归一化对照（如选项A中的发夹结构破坏的NT构建体）。没有这样的对照，任何序列特异性的伪影或qPCR引物效率的差异都无法被校正。\n-   虽然使用bicyclomycin来测试Rho依赖性是正确的，但核心测量方法存在缺陷。\n**结论：错误**\n\n**选项D**：\n这个选项包含多个严重的设计缺陷。\n-   使用`相同的荧光蛋白`作为 $U$ 和 $D$ 会使得在同一样品中无法通过光谱区分它们的信号，从而使双报告基因概念在标准荧光测定法下的同时测量变得不可行。\n-   归一化方案，$1 - \\left(F_D/\\text{看家基因}\\right)/\\left(F_U/\\text{光密度}\\right)$，在数学上是不连贯的。分母不同，而且这种特定比率组合没有逻辑基础。在计算内部比率之前，必须将两个报告基因归一化到相同的外部量（如光密度）。\n-   在一个单独的质粒上使用看家基因会引入另一个变异源（例如，质粒拷贝数差异），这会使解释复杂化，而不是简化。\n-   虽然使用Rho过表达来识别因子依赖性是一种有效的方法，但主要的测量策略在根本上是错误的。\n**结论：错误**\n\n总之，选项A描述了一个完整且科学严谨的实验计划，正确地解决了这类测量中固有的多种潜在偏置和干扰因素。它采用了适当的归一化、最先进的构建体设计和一套全面的对照，以确保结果的有效性和特异性。其他选项则包含足以使其失效的概念或方法学错误。", "answer": "$$\\boxed{A}$$", "id": "2785294"}, {"introduction": "除了实验测量，合成生物学的最终目标之一是实现理性设计，即通过计算模型预测序列变化对功能的影响。本练习将引导你应用一个基于物理化学原理的简化模型，定量分析内在终止子关键区域——U-tract的突变——如何通过改变RNA-DNA杂合双链的稳定性来影响终止效率 [@problem_id:2785306]。", "problem": "在细菌的内源性转录终止过程中，在靠近RNA聚合酶（RNAP；核糖核酸聚合酶）活性位点的新生转录本中形成一个核糖核酸（RNA）发夹结构，其后紧跟着一段富含尿苷的序列（U序列）。U序列会削弱RNA-脱氧核糖核酸（DNA）杂合体，因为rU:dA碱基对相对较弱，这会促进RNAP的去稳定化和转录本的释放。考虑一个工程化的内源性终止子，其中发夹的茎和环保持不变，但长度为 $n = 7$ 个核苷酸的 $3^{\\prime}$ 端U序列被系统性地改变，即RNA中的一部分尿苷（U）被腺苷（A）或胞苷（C）取代，同时DNA模板链也相应改变，使得这些位置上的杂合碱基对变为rA:dT或rC:dG。假设在标准单价盐条件下，RNA-DNA杂合体中每个碱基对的平均自由能贡献（基于物理原理）如下：rU:dA为 $\\epsilon_U = 1.0\\,\\text{kcal/mol}$，rA:dT为 $\\epsilon_A = 1.5\\,\\text{kcal/mol}$，rC:dG为 $\\epsilon_C = 2.5\\,\\text{kcal/mol}$。发夹的稳定自由能为 $\\Delta G_{\\mathrm{hp}} = -9.0\\,\\text{kcal/mol}$，并且存在一个与序列无关的额外释放结构惩罚 $\\Delta G_0 = +4.0\\,\\text{kcal/mol}$（反映了如钳夹区开放等构象变化）。温度为 $T = 310\\,\\mathrm{K}$，因此 $k_B T \\approx 0.616\\,\\text{kcal/mol}$，其中 $k_B$ 是玻尔兹曼常数。\n\n将终止子处的暂停复合物建模为一个无记忆的双路径系统：终止（转录本释放），其速率常数遵循与有效自由能垒相关的阿伦尼乌斯标度关系，指前因子为 $k_0 = 10^{4}\\,\\mathrm{s^{-1}}$；以及前向逃逸（恢复延伸），其速率与序列无关，为 $k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$。转录本释放的有效能垒是破坏RNA-DNA杂合体所需的能量减去发夹的稳定化能再加上 $\\Delta G_0$。考虑三种构建体：\n- WT：U序列为 $\\mathrm{U}_7$。\n- MutA：序列中的两个内部U被A取代，得到 $\\mathrm{U}_5\\mathrm{A}_2$。\n- MutC：序列中的两个内部U被C取代，得到 $\\mathrm{U}_5\\mathrm{C}_2$。\n\n仅使用分子生物学的中心法则（碱基互补）、已公认的相对碱基对稳定性以及热激活速率理论，分析这些取代如何影响RNA-DNA杂合体的弱化和RNAP的去稳定化。以下哪个/哪些陈述与所描述的模型和物理原理一致？\n\nA. 从数量上看，终止效率大约为 $\\mathrm{WT} \\approx 0.91$，$\\mathrm{MutA} \\approx 0.66$，$\\mathrm{MutC} \\approx 0.07$，这表明用A或C取代U会通过稳定RNA-DNA杂合体和减弱RNAP的去稳定化来逐渐降低终止效率。\n\nB. 因为腺嘌呤（A）只形成两个氢键，所以在U序列内用A取代U会比rU:dA进一步削弱RNA-DNA杂合体，因此相对于$\\mathrm{U}_7$会提高终止效率。\n\nC. 用C取代U的主要效应是通过rC:dG对中更强的堆积作用和三个氢键来增强RNA-DNA杂合体，这会降低转录本释放速率并增加平均暂停寿命；根据给定参数，$\\mathrm{U}_5\\mathrm{C}_2$的平均寿命约为$0.023\\,\\mathrm{s}$，比$\\mathrm{U}_7$更长。\n\nD. 如果前向逃逸速率保持不变，终止效率之比 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT})$ 约等于 $\\exp(-\\Delta\\Delta G/(k_B T))$，其中 $\\Delta\\Delta G$ 是由取代引起的杂合体稳定化能；使用所提供的能量，可得出 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT}) \\approx \\exp(-1.0/0.616) \\approx 0.20$。", "solution": "必须首先验证问题陈述的科学性和逻辑一致性。\n\n### 步骤1：提取已知条件\n\n-   **系统**：细菌内源性转录终止。\n-   **组分**：RNA发夹结构，富含尿苷的序列（U序列），RNA-DNA杂合体。\n-   **U序列长度**：$n = 7$ 个核苷酸。\n-   **碱基配对自由能贡献（破坏每个碱基对的能量）**：\n    -   rU:dA: $\\epsilon_U = 1.0\\,\\text{kcal/mol}$\n    -   rA:dT: $\\epsilon_A = 1.5\\,\\text{kcal/mol}$\n    -   rC:dG: $\\epsilon_C = 2.5\\,\\text{kcal/mol}$\n-   **发夹稳定自由能**：$\\Delta G_{\\mathrm{hp}} = -9.0\\,\\text{kcal/mol}$。\n-   **与序列无关的释放结构惩罚**：$\\Delta G_0 = +4.0\\,\\text{kcal/mol}$。\n-   **温度**：$T = 310\\,\\mathrm{K}$。\n-   **热能**：$k_B T \\approx 0.616\\,\\text{kcal/mol}$。\n-   **终止速率模型**：阿伦尼乌斯标度关系，$k_{\\mathrm{term}} = k_0 \\exp(-\\Delta G_{\\mathrm{eff}} / (k_B T))$。\n    -   指前因子：$k_0 = 10^{4}\\,\\mathrm{s^{-1}}$。\n    -   有效能垒：$\\Delta G_{\\mathrm{eff}} = (\\text{破坏RNA–DNA杂合体的能量}) - (\\text{发夹稳定化能}) + \\Delta G_0$。\n-   **前向逃逸速率**：$k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$（与序列无关）。\n-   **构建体**：\n    -   WT：U序列为 $\\mathrm{U}_7$。RNA-DNA杂合体包含7个rU:dA对。\n    -   MutA：U序列为 $\\mathrm{U}_5\\mathrm{A}_2$。杂合体有5个rU:dA对和2个rA:dT对。\n    -   MutC：U序列为 $\\mathrm{U}_5\\mathrm{C}_2$。杂合体有5个rU:dA对和2个rC:dG对。\n\n### 步骤2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估。\n\n1.  **科学依据**：该问题描述了一个简化的、但在物理和生物学上都合理的内源性转录终止模型。终止和延伸之间的动力学竞争、发夹结构和U序列的作用，以及使用阿伦尼乌斯模型计算速率常数，都是生物物理学和分子生物学中的标准概念。相对稳定性 $\\epsilon_C > \\epsilon_A > \\epsilon_U$ 与RNA-DNA杂合体的实验数据一致（rC:dG最强，rU:dA最弱）。该模型是自洽的，并基于已确立的原理。\n2.  **适定性**：该问题提供了所有必要的参数和一套清晰的规则来计算目标量（终止速率和效率）。可以从给定信息中推导出唯一解。\n3.  **客观性**：语言精确且定量。没有主观或基于观点的陈述。\n4.  **缺陷**：问题陈述在有效能垒的定义上存在一个微小的模糊之处：“减去发夹的稳定化能”。鉴于发夹结构*促进*终止（即降低动力学能垒），且提供的“稳定自由能”$\\Delta G_{\\mathrm{hp}}$为负值（$-9.0\\,\\text{kcal/mol}$），该短语必须解释为减去稳定化能的绝对值，即 $|\\Delta G_{\\mathrm{hp}}| = 9.0\\,\\text{kcal/mol}$。另一种解释，即减去负值（即在能垒上增加 $9.0\\,\\text{kcal/mol}$），在生物学上是讲不通的。通过这个合理的消歧，该问题是完全可以形式化的。\n\n### 步骤3：结论与行动\n\n该问题是**有效的**。微小的语言模糊性已通过上下文和所建模过程的基本原理得到解决。我将继续进行求解。\n\n### 解题推导\n\n终止效率 $\\mathrm{TE}$ 是从暂停状态发生终止的概率，由终止速率与离开暂停状态的总速率之比给出：\n$$\n\\mathrm{TE} = \\frac{k_{\\mathrm{term}}}{k_{\\mathrm{term}} + k_{\\mathrm{esc}}}\n$$\n终止速率由 $k_{\\mathrm{term}} = k_0 \\exp(-\\Delta G_{\\mathrm{eff}} / (k_B T))$ 给出，其中 $k_0 = 10^4\\,\\mathrm{s^{-1}}$ 且 $k_B T = 0.616\\,\\text{kcal/mol}$。前向逃逸速率是恒定的，$k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$。\n\n关键任务是计算每个构建体的有效活化能垒 $\\Delta G_{\\mathrm{eff}}$。问题陈述为：\n$\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{hybrid}} - (\\text{发夹稳定化能}) + \\Delta G_0$。\n如上所述，这被解释为：\n$\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{hybrid}} - |\\Delta G_{\\mathrm{hp}}| + \\Delta G_0$。\n已知 $\\Delta G_{\\mathrm{hp}} = -9.0\\,\\text{kcal/mol}$ 和 $\\Delta G_0 = 4.0\\,\\text{kcal/mol}$，则公式变为：\n$\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{hybrid}} - 9.0\\,\\text{kcal/mol} + 4.0\\,\\text{kcal/mol} = \\Delta G_{\\mathrm{hybrid}} - 5.0\\,\\text{kcal/mol}$。\n\n接下来，我们通过对每个碱基对的贡献求和，来计算破坏每个构建体的7个碱基对RNA-DNA杂合体所需的能量 $\\Delta G_{\\mathrm{hybrid}}$。\n\n**1. WT 构建体 ($\\mathrm{U}_7$)**\n杂合体由7个rU:dA对组成。\n$\\Delta G_{\\mathrm{hybrid, WT}} = 7 \\times \\epsilon_U = 7 \\times 1.0\\,\\text{kcal/mol} = 7.0\\,\\text{kcal/mol}$。\n有效能垒为：\n$\\Delta G_{\\mathrm{eff, WT}} = 7.0 - 5.0 = 2.0\\,\\text{kcal/mol}$。\n终止速率为：\n$k_{\\mathrm{term, WT}} = 10^4 \\exp\\left(-\\frac{2.0}{0.616}\\right) \\approx 10^4 \\exp(-3.2468) \\approx 10^4 \\times 0.0389 = 389\\,\\mathrm{s^{-1}}$。\n终止效率为：\n$\\mathrm{TE}_{\\mathrm{WT}} = \\frac{389}{389 + 40} = \\frac{389}{429} \\approx 0.9067$。\n\n**2. MutA 构建体 ($\\mathrm{U}_5\\mathrm{A}_2$)**\n杂合体由5个rU:dA对和2个rA:dT对组成。\n$\\Delta G_{\\mathrm{hybrid, MutA}} = 5 \\times \\epsilon_U + 2 \\times \\epsilon_A = 5 \\times 1.0 + 2 \\times 1.5 = 5.0 + 3.0 = 8.0\\,\\text{kcal/mol}$。\n有效能垒为：\n$\\Delta G_{\\mathrm{eff, MutA}} = 8.0 - 5.0 = 3.0\\,\\text{kcal/mol}$。\n终止速率为：\n$k_{\\mathrm{term, MutA}} = 10^4 \\exp\\left(-\\frac{3.0}{0.616}\\right) \\approx 10^4 \\exp(-4.8701) \\approx 10^4 \\times 0.00767 = 76.7\\,\\mathrm{s^{-1}}$。\n终止效率为：\n$\\mathrm{TE}_{\\mathrm{MutA}} = \\frac{76.7}{76.7 + 40} = \\frac{76.7}{116.7} \\approx 0.6572$。\n\n**3. MutC 构建体 ($\\mathrm{U}_5\\mathrm{C}_2$)**\n杂合体由5个rU:dA对和2个rC:dG对组成。\n$\\Delta G_{\\mathrm{hybrid, MutC}} = 5 \\times \\epsilon_U + 2 \\times \\epsilon_C = 5 \\times 1.0 + 2 \\times 2.5 = 5.0 + 5.0 = 10.0\\,\\text{kcal/mol}$。\n有效能垒为：\n$\\Delta G_{\\mathrm{eff, MutC}} = 10.0 - 5.0 = 5.0\\,\\text{kcal/mol}$。\n终止速率为：\n$k_{\\mathrm{term, MutC}} = 10^4 \\exp\\left(-\\frac{5.0}{0.616}\\right) \\approx 10^4 \\exp(-8.1169) \\approx 10^4 \\times 0.00030 = 3.0\\,\\mathrm{s^{-1}}$。\n终止效率为：\n$\\mathrm{TE}_{\\mathrm{MutC}} = \\frac{3.0}{3.0 + 40} = \\frac{3.0}{43.0} \\approx 0.0698$。\n\n### 逐项分析\n\n**A. 从数量上看，终止效率大约为 $\\mathrm{WT} \\approx 0.91$，$\\mathrm{MutA} \\approx 0.66$，$\\mathrm{MutC} \\approx 0.07$，这表明用A或C取代U会通过稳定RNA-DNA杂合体和减弱RNAP的去稳定化来逐渐降低终止效率。**\n我们的计算得出 $\\mathrm{TE}_{\\mathrm{WT}} \\approx 0.907 \\approx 0.91$，$\\mathrm{TE}_{\\mathrm{MutA}} \\approx 0.657 \\approx 0.66$，以及 $\\mathrm{TE}_{\\mathrm{MutC}} \\approx 0.070 \\approx 0.07$。这些值与陈述相符。定性推理也是正确的。U $\\rightarrow$ A 和 U $\\rightarrow$ C 的取代增加了杂合体的稳定性（$\\Delta G_{\\mathrm{hybrid}}$ 从 $7.0$ 增加到 $8.0$ 再到 $10.0\\,\\text{kcal/mol}$），这会提高终止能垒，降低终止速率，从而降低终止效率。“减弱RNAP的去稳定化”是降低终止概率的正确描述。\n**结论：正确。**\n\n**B. 因为腺嘌呤（A）只形成两个氢键，所以在U序列内用A取代U会比rU:dA进一步削弱RNA-DNA杂合体，因此相对于$\\mathrm{U}_7$会提高终止效率。**\n根据问题中提供的数据，此陈述包含一个事实不正确的前提。问题给出的rA:dT的破坏能为 $\\epsilon_A = 1.5\\,\\text{kcal/mol}$，而rU:dA的破坏能为 $\\epsilon_U = 1.0\\,\\text{kcal/mol}$。由于 $\\epsilon_A > \\epsilon_U$，一个rA:dT对比一个rU:dA对*更强*，而不是更弱。这种增加的稳定性增强了杂合体，从而*降低了*终止效率，正如对MutA的计算所示。该陈述的主张和结论都与模型和数据相悖。\n**结论：不正确。**\n\n**C. 用C取代U的主要效应是通过rC:dG对中更强的堆积作用和三个氢键来增强RNA-DNA杂合体，这会降低转录本释放速率并增加平均暂停寿命；根据给定参数，$\\mathrm{U}_5\\mathrm{C}_2$的平均寿命约为$0.023\\,\\mathrm{s}$，比$\\mathrm{U}_7$更长。**\n定性推理是合理的：rC:dG对（$\\epsilon_C = 2.5\\,\\text{kcal/mol}$）远强于rU:dA对（$\\epsilon_U = 1.0\\,\\text{kcal/mol}$），增强了杂合体并降低了终止速率。平均暂停寿命 $\\tau$ 是离开暂停状态总速率的倒数，$\\tau = 1/(k_{\\mathrm{term}} + k_{\\mathrm{esc}})$。\n对于MutC构建体（$\\mathrm{U}_5\\mathrm{C}_2$）：$k_{\\mathrm{total, MutC}} = k_{\\mathrm{term, MutC}} + k_{\\mathrm{esc}} \\approx 3.0 + 40 = 43.0\\,\\mathrm{s^{-1}}$。平均寿命为 $\\tau_{\\mathrm{MutC}} = 1/43.0 \\approx 0.02326\\,\\mathrm{s}$，约等于 $0.023\\,\\mathrm{s}$。\n对于WT构建体（$\\mathrm{U}_7$）：$k_{\\mathrm{total, WT}} = k_{\\mathrm{term, WT}} + k_{\\mathrm{esc}} \\approx 389 + 40 = 429\\,\\mathrm{s^{-1}}$。平均寿命为 $\\tau_{\\mathrm{WT}} = 1/429 \\approx 0.00233\\,\\mathrm{s}$。\nMutC的寿命（$0.023\\,\\mathrm{s}$）确实比WT的寿命（$0.0023\\,\\mathrm{s}$）长。陈述的所有部分都与我们的推导一致。\n**结论：正确。**\n\n**D. 如果前向逃逸速率保持不变，终止效率之比 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT})$ 约等于 $\\exp(-\\Delta\\Delta G/(k_B T))$，其中 $\\Delta\\Delta G$ 是由取代引起的杂合体稳定化能；使用所提供的能量，可得出 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT}) \\approx \\exp(-1.0/0.616) \\approx 0.20$。**\n此选项中提供的公式是终止*速率*之比，而非效率之比。\n$\\frac{k_{\\mathrm{term, MutA}}}{k_{\\mathrm{term, WT}}} = \\frac{k_0 \\exp(-\\Delta G_{\\mathrm{eff, MutA}} / k_B T)}{k_0 \\exp(-\\Delta G_{\\mathrm{eff, WT}} / k_B T)} = \\exp(-(\\Delta G_{\\mathrm{eff, MutA}} - \\Delta G_{\\mathrm{eff, WT}})/k_B T)$。\n有效能垒的变化是 $\\Delta\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{eff, MutA}} - \\Delta G_{\\mathrm{eff, WT}} = \\Delta G_{\\mathrm{hybrid, MutA}} - \\Delta G_{\\mathrm{hybrid, WT}} = 8.0 - 7.0 = 1.0\\,\\text{kcal/mol}$。\n所以速率之比为 $\\exp(-1.0/0.616) \\approx 0.197 \\approx 0.20$。选项中的计算对于速率之比是正确的。\n然而，效率之比为 $\\frac{\\mathrm{TE}(\\mathrm{MutA})}{\\mathrm{TE}(\\mathrm{WT})} = \\frac{k_{\\mathrm{term, MutA}}/(k_{\\mathrm{term, MutA}} + k_{\\mathrm{esc}})}{k_{\\mathrm{term, WT}}/(k_{\\mathrm{term, WT}} + k_{\\mathrm{esc}})}$。仅当两种构建体的 $k_{\\mathrm{term}} \\ll k_{\\mathrm{esc}}$ 时，该比值才约等于速率之比，但这个条件被严重违反了，特别是对于WT，其 $k_{\\mathrm{term, WT}} \\approx 389\\,\\mathrm{s^{-1}}$ 而 $k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$。\n实际的效率之比是 $\\frac{0.6572}{0.9067} \\approx 0.725$。这与选项中声称的 $0.20$ 的值有很大差异。因此，在此参数范围内，认为效率之比可以用这种方式近似的断言是根本上错误的。\n**结论：不正确。**", "answer": "$$\\boxed{AC}$$", "id": "2785306"}, {"introduction": "实验设计和物理建模最终要与真实数据相结合。由于实验测量本身存在变异和噪声，我们需要一个严谨的统计框架来从数据中提取可靠的参数估计值。本练习将介绍贝叶斯推断这一强大工具，指导你为双报告基因实验的计数数据建立一个概率模型，从而估算终止子强度并量化其不确定性 [@problem_id:2785265]。", "problem": "您正在设计一个计算估计量，用于根据在转录终止子上游和下游收集的重复报告基因测量数据，来估计转录终止子的强度。其生物学基础是分子生物学中心法则，即转录产生RNA，而转录终止子会减少通读到下游区域的RNA聚合酶的比例。将通读概率定义为 $p \\in [0,1]$，终止子强度定义为 $TS = 1 - p$。您将基于计数实验的启发，在两种似然族下实现贝叶斯估计量。\n\n基本和建模假设：\n- 对于二项约束计数，在重复实验 $i$ 中，您观察到一个上游计数 $U_i$（代表总试验次数）和一个下游计数 $D_i$（代表通读成功次数），其中 $D_i \\le U_i$。给定所有重复实验共享的通读概率 $p$，其似然为 $D_i \\sim \\text{Binomial}(U_i, p)$，且各重复实验之间相互独立。对 $p$ 设置一个Beta先验：$p \\sim \\text{Beta}(a_0,b_0)$，其中 $a_0 > 0$ 且 $b_0 > 0$。\n- 对于过度离散的独立计数，在重复实验 $i$ 中，您观察到从具有匹配暴露量的检测中测得的上游计数 $U_i$ 和下游计数 $D_i$。将这些计数建模为条件独立的泊松随机变量 $U_i \\mid \\lambda_i \\sim \\text{Poisson}(\\lambda_i \\mu_u)$ 和 $D_i \\mid \\lambda_i \\sim \\text{Poisson}(\\lambda_i \\mu_d)$，其中 $\\lambda_i$ 捕获了特定于重复实验的暴露量，而 $\\mu_u, \\mu_d > 0$ 是全局均值。重复实验间的过度离散性通过对 $\\lambda_i$ 设置一个具有有限均值和方差的Gamma先验来捕获，这意味着 $U_i$ 和 $D_i$ 的边际分布为负二项分布。定义通读比率 $r = \\mu_d / \\mu_u$，它通过 $q = \\mu_d / (\\mu_u + \\mu_d) = r/(1+r)$ 与以总数为条件的通读概率相关联。设置一个Beta先验 $q \\sim \\text{Beta}(a_0,b_0)$，其中 $a_0 > 0$ 且 $b_0 > 0$。终止子强度为 $TS = 1 - r$。\n\n需要实现的任务，从贝叶斯定理和上述定义出发：\n1) 对于二项模型，通过充分统计量 $S_U = \\sum_{i=1}^n U_i$ 和 $S_D = \\sum_{i=1}^n D_i$ 合并 $n$ 个重复实验。推导 $p$ 的后验分布，并计算 $TS = 1 - p$ 的后验均值以及 $TS$ 的中心 $100 \\times 0.95$ 可信区间。先验必须为 $p \\sim \\text{Beta}(a_0,b_0)$，其中 $a_0 = 1$ 且 $b_0 = 1$。通过 $p$ 的后验分布的精确分位数和变换 $TS = 1 - p$ 来表示下界和上界。\n2) 对于具有匹配暴露量的过度离散独立计数模型，使用条件二项性质 $D_i \\mid T_i \\sim \\text{Binomial}(T_i, q)$，其中 $T_i = U_i + D_i$，该性质源于每个重复实验具有共享暴露参数的泊松模型。通过 $S_U = \\sum_{i=1}^n U_i$ 和 $S_D = \\sum_{i=1}^n D_i$ 合并 $n$ 个重复实验，得到后验分布 $q \\mid \\{(U_i,D_i)\\} \\sim \\text{Beta}(a_0 + S_D, b_0 + S_U)$，其中 $a_0 = 1$ 且 $b_0 = 1$。通过 $r = q/(1 - q)$ 变换为终止子强度 $TS = 1 - r$。计算：\n- 当存在精确表达式时，使用该表达式计算 $TS$ 的后验均值。\n- 使用 $q$ 的Beta后验的单调分位数变换计算中心 $100 \\times 0.95$ 可信区间。\n\n数值和输出要求：\n- 对所有测试用例使用 $a_0 = 1$ 和 $b_0 = 1$，可信水平为 $0.95$。\n- 对于二项模型，假设对所有重复实验 $i$ 都有 $D_i \\le U_i$。\n- 对于过度离散模型，根据泊松-伽马构造，假设每个重复实验内部具有匹配的暴露量；不要求 $D_i \\le U_i$ 约束，但为了科学真实性，测试套件中的数据被选择为满足 $D_i \\le U_i$。\n- 您的程序必须生成单行输出，包含一个结果列表，每个测试用例一个结果。\n- 每个结果是一个包含三个浮点数的列表：$TS$ 的后验均值、中心 $0.95$ 可信区间的下界和上界。\n- 将每个值四舍五入到 $6$ 位小数。\n- 最终输出必须是形如 [[m1,l1,u1],[m2,l2,u2],...] 的单行。\n\n测试套件：\n- 用例1（二项模型，理想情况）：重复实验 $[(100,20),(120,30),(80,12)]$。\n- 用例2（二项模型，边界：完美终止）：重复实验 $[(50,0),(75,0),(60,0)]$。\n- 用例3（二项模型，边界：完全通读）：重复实验 $[(30,30),(40,40),(25,25)]$。\n- 用例4（过度离散的独立计数，理想情况）：重复实验 $[(1000,210),(850,180),(1200,250)]$。\n- 用例5（过度离散的独立计数，稀疏且含零）：重复实验 $[(5,0),(0,0),(3,1),(2,0)]$。\n\n所有计算必须从建模假设和贝叶斯定理推导得出。不允许外部输入。唯一可接受的输出是上述单行列表。", "solution": "该问题要求在两种不同的重复计数数据生成模型下，推导并实现转录终止子强度（$TS$）的贝叶斯估计量。分析从第一性原理出发，将贝叶斯定理应用于指定的似然和先验。所需的量是 $TS$ 的后验均值和 $TS$ 的中心 $100 \\times (1-\\alpha)\\%$ 可信区间，其中 $\\alpha = 0.05$。\n\n首先，我们建立共享的贝叶斯框架。后验分布与似然和先验的乘积成正比：$P(\\theta|\\text{data}) \\propto P(\\text{data}|\\theta) P(\\theta)$，其中 $\\theta$ 代表模型参数。\n\n**模型1：约束计数的二项模型**\n\n该模型适用于上游测量值 $U_i$ 代表转录本总群体，而下游测量值 $D_i$ 代表“通读”了终止子的亚群体的实验。\n\n**1. 通读概率 $p$ 的后验分布**\n\n模型假设：\n- 关于通读概率 $p$ 的先验信念：$p \\sim \\text{Beta}(a_0, b_0)$。\n- 对于单个重复实验 $i$，在给定上游计数 $U_i$ 的情况下，观察到下游计数 $D_i$ 的似然为：$D_i | U_i, p \\sim \\text{Binomial}(U_i, p)$。似然函数是 $L(p; D_i, U_i) = \\binom{U_i}{D_i} p^{D_i} (1-p)^{U_i-D_i}$。\n\n对于一组 $n$ 个独立重复实验 $\\{(U_i, D_i)\\}_{i=1}^n$，总似然是各个似然的乘积：\n$$L(p; \\{\\text{data}\\}) = \\prod_{i=1}^n \\binom{U_i}{D_i} p^{D_i} (1-p)^{U_i-D_i} \\propto p^{\\sum D_i} (1-p)^{\\sum(U_i-D_i)}$$\n令 $S_D = \\sum_{i=1}^n D_i$ 和 $S_U = \\sum_{i=1}^n U_i$ 为充分统计量。似然简化为 $L(p; S_D, S_U) \\propto p^{S_D} (1-p)^{S_U-S_D}$。\n\n然后通过将似然与先验相乘得到 $p$ 的后验分布：\n$$P(p|S_D, S_U) \\propto p^{S_D} (1-p)^{S_U-S_D} \\times p^{a_0-1}(1-p)^{b_0-1}$$\n$$P(p|S_D, S_U) \\propto p^{a_0+S_D-1} (1-p)^{b_0+S_U-S_D-1}$$\n这是Beta分布的核。因此，$p$ 的后验分布为：\n$$p | S_D, S_U \\sim \\text{Beta}(a_n, b_n)$$\n其中后验参数为 $a_n = a_0 + S_D$ 和 $b_n = b_0 + S_U - S_D$。\n\n**2. 终止子强度 $TS$ 的后验估计量**\n\n终止子强度定义为 $TS = 1 - p$。\n\n$TS$ 的后验均值由期望的线性性质推导得出：\n$$E[TS|\\text{data}] = E[1 - p|\\text{data}] = 1 - E[p|\\text{data}]$$\n$\\text{Beta}(a_n, b_n)$ 分布的均值为 $E[p|\\text{data}] = \\frac{a_n}{a_n+b_n}$。因此，\n$$E[TS|\\text{data}] = 1 - \\frac{a_n}{a_n+b_n} = \\frac{b_n}{a_n+b_n} = \\frac{b_0+S_U-S_D}{a_0+b_0+S_U}$$\n\n$TS$ 的中心 $100 \\times (1-\\alpha)\\%$ 可信区间通过变换 $p$ 的区间得到。令 $F_p^{-1}(\\cdot; a_n, b_n)$ 为 $\\text{Beta}(a_n, b_n)$ 后验分布的分位数函数。$p$ 的可信区间为 $[L_p, U_p]$，其中 $L_p = F_p^{-1}(\\alpha/2; a_n, b_n)$ 且 $U_p = F_p^{-1}(1-\\alpha/2; a_n, b_n)$。\n由于 $TS = 1 - p$ 是 $p$ 的严格单调递减函数，因此 $TS$ 对应的可信区间为 $[1-U_p, 1-L_p]$。\n下界为 $L_{TS} = 1 - F_p^{-1}(1-\\alpha/2; a_n, b_n)$，上界为 $U_{TS} = 1 - F_p^{-1}(\\alpha/2; a_n, b_n)$。在本问题中，$a_0 = 1$，$b_0 = 1$，且 $\\alpha = 0.05$。\n\n**模型2：过度离散的独立计数模型**\n\n该模型将上游和下游计数视为独立的泊松变量，适用于那些并行测量这些计数但它们之间没有严格的“部分-整体”关系的检测。\n\n**1. 通读参数 $q$ 的后验分布**\n\n问题提供了源于伽马-泊松混合模型的关键结果：参数 $q = \\mu_d/(\\mu_u+\\mu_d)$ 的后验分布由下式给出\n$$q | \\{(U_i, D_i)\\} \\sim \\text{Beta}(a_n', b_n')$$\n其中后验参数为 $a_n' = a_0 + S_D$ 和 $b_n' = b_0 + S_U$，且 $S_D = \\sum D_i$ 和 $S_U = \\sum U_i$。这个结果是通过以总计数 $T_i = U_i+D_i$ 为条件得到的，这会产生一个关于 $D_i$ 的二项似然，即 $D_i|T_i,q \\sim \\text{Binomial}(T_i, q)$。跨重复实验进行汇总，即可得到所述的Beta后验。\n\n**2. 终止子强度 $TS$ 的后验估计量**\n\n对于该模型，终止子强度是根据通读比率 $r = \\mu_d/\\mu_u$ 定义的。$q$ 和 $r$ 之间的关系是 $r = q/(1-q)$。终止子强度为 $TS = 1-r = 1 - q/(1-q)$。\n\n$TS$ 的后验均值为 $E[TS|\\text{data}] = 1 - E[r|\\text{data}] = 1 - E[q/(1-q)|\\text{data}]$。我们必须计算变换后的随机变量 $q$ 的期望：\n$$E\\left[\\frac{q}{1-q}\\right] = \\int_0^1 \\frac{q}{1-q} \\frac{q^{a_n'-1}(1-q)^{b_n'-1}}{B(a_n', b_n')} dq = \\frac{1}{B(a_n', b_n')} \\int_0^1 q^{a_n'}(1-q)^{b_n'-2} dq$$\n该积分为 $B(a_n'+1, b_n'-1)$，并且只有当 $b_n'-1 > 0$ 或 $b_n' > 1$ 时才收敛。期望为：\n$$E\\left[\\frac{q}{1-q}\\right] = \\frac{B(a_n'+1, b_n'-1)}{B(a_n', b_n')} = \\frac{\\Gamma(a_n'+1)\\Gamma(b_n'-1)}{\\Gamma(a_n'+b_n')} \\frac{\\Gamma(a_n'+b_n')}{\\Gamma(a_n')\\Gamma(b_n')} = \\frac{a_n'}{b_n'-1}$$\n因此，只要满足 $b_n' = b_0 + S_U > 1$，$TS$ 的后验均值为：\n$$E[TS|\\text{data}] = 1 - \\frac{a_n'}{b_n'-1} = 1 - \\frac{a_0+S_D}{b_0+S_U-1}$$\n\n$TS$ 的中心 $100 \\times (1-\\alpha)\\%$ 可信区间通过变换 $q$ 的区间得到。函数 $g(q) = 1 - q/(1-q)$ 对于 $q \\in [0, 1)$ 是严格单调递减的，因为其导数为 $g'(q) = -1/(1-q)^2  0$。\n令 $q$ 的可信区间为 $[L_q, U_q]$，其中 $L_q = F_q^{-1}(\\alpha/2; a_n', b_n')$ 且 $U_q = F_q^{-1}(1-\\alpha/2; a_n', b_n')$。\n$TS$ 的可信区间为 $[g(U_q), g(L_q)]$。边界为：\n$L_{TS} = g(U_q) = 1 - \\frac{U_q}{1-U_q}$\n$U_{TS} = g(L_q) = 1 - \\frac{L_q}{1-L_q}$\n在本问题中，$a_0=1$，$b_0=1$，且 $\\alpha=0.05$。存在性条件 $b_n' > 1$ 变为 $1+S_U > 1$ 或 $S_U > 0$，这对指定的测试用例是成立的。\n\n这些推导出的公式被实现用于计算每个测试用例所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import beta\n\ndef solve():\n    \"\"\"\n    Computes Bayesian estimates for terminator strength (TS) for a suite of test cases.\n    Two models are implemented: a binomial model and an overdispersed independent-counts model.\n    For each case, it calculates the posterior mean of TS and the 95% credible interval.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'binomial', 'replicates': [(100, 20), (120, 30), (80, 12)]},\n        {'type': 'binomial', 'replicates': [(50, 0), (75, 0), (60, 0)]},\n        {'type': 'binomial', 'replicates': [(30, 30), (40, 40), (25, 25)]},\n        {'type': 'overdispersed', 'replicates': [(1000, 210), (850, 180), (1200, 250)]},\n        {'type': 'overdispersed', 'replicates': [(5, 0), (0, 0), (3, 1), (2, 0)]}\n    ]\n\n    # Prior hyperparameters and credible level, as per problem specification.\n    a0 = 1.0\n    b0 = 1.0\n    credibility_level = 0.95\n    alpha = 1.0 - credibility_level\n    \n    final_results = []\n\n    for case in test_cases:\n        replicates = np.array(case['replicates'], dtype=float)\n        # Sufficient statistics: sum of upstream (U) and downstream (D) counts.\n        S_U = np.sum(replicates[:, 0])\n        S_D = np.sum(replicates[:, 1])\n\n        if case['type'] == 'binomial':\n            # Posterior parameters for p ~ Beta(a_n, b_n)\n            a_n = a0 + S_D\n            b_n = b0 + S_U - S_D\n\n            # Posterior mean of TS = 1 - p\n            # E[TS] = E[1-p] = 1 - E[p] = 1 - a_n/(a_n+b_n) = b_n/(a_n+b_n)\n            mean_ts = b_n / (a_n + b_n)\n\n            # 95% credible interval for TS\n            # TS = 1 - p is a decreasing function of p.\n            # CI for TS is [1 - U_p, 1 - L_p], where [L_p, U_p] is the CI for p.\n            l_p = beta.ppf(alpha / 2.0, a_n, b_n)\n            u_p = beta.ppf(1.0 - alpha / 2.0, a_n, b_n)\n            \n            lower_ts = 1.0 - u_p\n            upper_ts = 1.0 - l_p\n            \n        elif case['type'] == 'overdispersed':\n            # Posterior parameters for q ~ Beta(a_n', b_n')\n            a_n_prime = a0 + S_D\n            b_n_prime = b0 + S_U\n            \n            # Posterior mean of TS = 1 - r = 1 - q/(1-q)\n            # E[TS] = 1 - E[q/(1-q)]\n            # E[q/(1-q)] = a_n' / (b_n' - 1) is valid if b_n'  1.\n            if b_n_prime = 1.0:\n                # This should not happen with the given test cases and b0=1.\n                raise ValueError(\"Posterior mean of r is not defined for b_n' = 1.\")\n\n            mean_ts = 1.0 - (a_n_prime / (b_n_prime - 1.0))\n            \n            # 95% Credible interval for TS\n            # g(q) = 1 - q/(1-q) is a decreasing function of q.\n            # CI for TS is [g(U_q), g(L_q)], where [L_q, U_q] is the CI for q.\n            l_q = beta.ppf(alpha / 2.0, a_n_prime, b_n_prime)\n            u_q = beta.ppf(1.0 - alpha / 2.0, a_n_prime, b_n_prime)\n\n            # Transformation g(q). Handle u_q - 1 limit.\n            # If u_q == 1.0, r - infinity, TS - -infinity.\n            if u_q >= 1.0 - 1e-12: # Safety for floating point\n                 lower_ts = -np.inf\n            else:\n                 lower_ts = 1.0 - u_q / (1.0 - u_q)\n            \n            upper_ts = 1.0 - l_q / (1.0 - l_q)\n        \n        # Round results to 6 decimal places as required.\n        mean_ts_r = round(mean_ts, 6)\n        lower_ts_r = round(lower_ts, 6)\n        upper_ts_r = round(upper_ts, 6)\n        \n        final_results.append([mean_ts_r, lower_ts_r, upper_ts_r])\n\n    # Final print statement in the exact required format.\n    print(final_results)\n\nsolve()\n```", "id": "2785265"}]}