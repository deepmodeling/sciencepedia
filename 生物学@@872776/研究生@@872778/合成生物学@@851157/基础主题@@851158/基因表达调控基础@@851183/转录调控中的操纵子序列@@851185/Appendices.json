{"hands_on_practices": [{"introduction": "在合成生物学中，蛋白质的结构是基本的设计杠杆。通过将一个抑制子从单体改造为二聚体，我们可以利用协同效应显著增强其结合亲和力和抑制强度。这项练习 [@problem_id:2755180] 将指导您使用统计力学从第一性原理出发，推导这种增强效应的量化表达，从而建立分子结构与宏观基因调控之间的定量联系。", "problem": "您正在一个细菌合成基因回路中设计一种转录阻遏蛋白。该操纵子由两个相邻的回文半位点组成，它们共同与核心启动子重叠，因此阻遏蛋白的任何占据都会排斥RNA聚合酶（RNAP）并阻止转录起始。最初，该阻遏蛋白是单体的，可以独立地结合每个半位点，每个半位点的结合自由能相同，记为 $\\epsilon_{h}$，单位为 $k_{B} T$（其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度）。细胞中阻遏蛋白的有效可用性通过标准热力学模型来描述，该模型包含一个大小为 $N_{ns}$ 的非特异性脱氧核糖核酸（DNA）库和总数为 $R$ 的阻遏蛋白分子，因此无量纲浓度参数为 $\\rho \\equiv R/N_{ns}$。假设 $R \\ll N_{ns}$，因此 $\\rho$ 很小但为有限值。在单体状态下，操纵子可以处于三种排斥RNAP的阻遏蛋白结合构型：左半位点被占据、右半位点被占据，或两个半位点都被占据。\n\n然后，您通过融合一个二聚化结构域将该阻遏蛋白转化为二聚体，其二聚化自由能为 $\\Delta \\epsilon_{dim}$（单位为 $k_{B} T$）。在工程化的二聚体设计中，阻遏作用主要由一个跨越并同时结合两个半位点的二聚体产生；在此工程设计中，单个单体与一个半位点的结合可以忽略不计。在转录调控的平衡统计力学框架内，假设二聚体与两个半位点的结合状态等效于双单体双占据状态在两个亚基都存在于操纵子时获得一个额外的相互作用自由能 $\\Delta \\epsilon_{dim}$，因此二聚体结合状态的总结合自由能为 $2 \\epsilon_{h} + \\Delta \\epsilon_{dim}$。\n\n将阻遏因子 $\\mathcal{R}$ 定义为相对于无阻遏蛋白参照系的表达量倍数变化的倒数，即 $\\mathcal{R} \\equiv 1/\\text{fold-change}$。对于一个简单的阻遏结构，它等于1加上所有排斥RNAP的阻遏蛋白结合态的统计权重之和。使用此定义和上述假设，推导一个关于 $\\rho$、$\\epsilon_{h}$ 和 $\\Delta \\epsilon_{dim}$ 的封闭形式解析表达式，用于表示转换为二聚体设计后阻遏作用的变化，该变化量化为比率 $\\mathcal{R}_{dimer}/\\mathcal{R}_{mono}$。请将您的最终答案表示为单个简化的解析表达式。无需进行数值计算。", "solution": "我们从一个简单阻遏结构的转录调控平衡热力学模型开始。启动子具有转录活性的概率与操纵子未被阻遏蛋白占据的概率成正比。在RNAP弱结合极限下，表达量的倍数变化由操纵子未被阻遏蛋白结合的概率给出，其值等于未结合态的统计权重除以所有与阻遏蛋白排斥RNAP相容的状态的总统计权重。将未结合态的权重归一化为1，则阻遏因子（定义为 $\\mathcal{R} \\equiv 1/\\text{fold-change}$）变为\n$$\n\\mathcal{R} = 1 + \\sum_{\\text{repressor-bound states}} \\text{(statistical weight)}.\n$$\n\n我们采用标准的非特异性DNA库模型，其中将一个阻遏蛋白单体放置在特定半位点上的统计权重为 $\\rho \\exp(-\\epsilon_{h})$，其中 $\\rho \\equiv R/N_{ns}$，所有能量均以 $k_{B} T$ 为单位表示，因此玻尔兹曼因子为 $\\exp(-\\text{能量})$。\n\n单体阻遏蛋白（基线）：\n- 有两个半位点，每个都可以被单个占据，从而产生两个不同的单占据状态。每个单占据状态的权重为 $\\rho \\exp(-\\epsilon_{h})$，因此单占据状态的总权重为\n$$\n2 \\, \\rho \\exp(-\\epsilon_{h}).\n$$\n- 两个半位点可以同时被两个单体占据。假设在单体基线情况下为独立结合，没有额外的相互作用能，则双占据状态的权重是两个位点权重的乘积，\n$$\n\\left[\\rho \\exp(-\\epsilon_{h})\\right]^{2} = \\rho^{2} \\exp(-2 \\epsilon_{h}).\n$$\n所有这些阻遏蛋白结合状态都排斥RNA聚合酶（RNAP），因此单体情况下的阻遏因子为\n$$\n\\mathcal{R}_{mono} = 1 + 2 \\rho \\exp(-\\epsilon_{h}) + \\rho^{2} \\exp(-2 \\epsilon_{h}).\n$$\n\n工程化的二聚体阻遏蛋白：\n- 在工程化的二聚体设计中，阻遏作用主要通过一个跨越两个相邻半位点的二聚体发生。该状态可以看作是双占据构型被赋予了一个额外的相互作用（二聚化）自由能 $\\Delta \\epsilon_{dim}$。因此，二聚体结合的操纵子的统计权重是双占据权重乘以该相互作用的玻尔兹曼因子：\n$$\n\\rho^{2} \\exp\\!\\left[-2 \\epsilon_{h} - \\Delta \\epsilon_{dim}\\right].\n$$\n- 根据工程设计，与二聚体结合相比，单个单体与一个半位点的结合可以忽略不计。\n\n因此，二聚体情况下的阻遏因子为\n$$\n\\mathcal{R}_{dimer} = 1 + \\rho^{2} \\exp\\!\\left(-2 \\epsilon_{h} - \\Delta \\epsilon_{dim}\\right).\n$$\n\n所要求的阻遏作用变化是以下比率\n$$\n\\frac{\\mathcal{R}_{dimer}}{\\mathcal{R}_{mono}} \\;=\\; \\frac{1 + \\rho^{2} \\exp\\!\\left(-2 \\epsilon_{h} - \\Delta \\epsilon_{dim}\\right)}{1 + 2 \\rho \\exp(-\\epsilon_{h}) + \\rho^{2} \\exp(-2 \\epsilon_{h})}.\n$$\n\n该表达式完全由 $\\rho$、$\\epsilon_{h}$ 和 $\\Delta \\epsilon_{dim}$ 定义，其中所有能量均以 $k_{B} T$ 为单位。它描述了有利的二聚化（即 $\\Delta \\epsilon_{dim}  0$）如何相对于单体基线增加二聚体结合态的统计权重，从而改变阻遏因子。", "answer": "$$\\boxed{\\frac{1+\\rho^{2}\\,\\exp\\!\\left(-2\\epsilon_{h}-\\Delta\\epsilon_{dim}\\right)}{1+2\\rho\\,\\exp\\!\\left(-\\epsilon_{h}\\right)+\\rho^{2}\\,\\exp\\!\\left(-2\\epsilon_{h}\\right)}}$$", "id": "2755180"}, {"introduction": "构建可控的基因开关是合成生物学的核心目标之一。这通常通过别构转录因子来实现，这些因子可以被小分子激活或失活。这项实践 [@problem_id:2755183] 要求您对抑制子内部的配体结合协同性如何影响剂量反应曲线进行建模，从而使您能够预测和设计基因开关的灵敏度。", "problem": "一种合成的阻遏转录因子 (TF) 是一个同源二聚体，具有两个相同的诱导物结合位点，用于结合浓度为 $[L]$ 的小分子配体。根据质量作用定律，每个位点以微观结合常数 $K_{\\ell}$ 结合配体。这两个配体结合事件通过一个无量纲协同性参数 $\\omega$ 耦合，使得双配体结合状态的统计权重相对于独立位点情况乘以 $\\omega$。该 TF 仅在未结合配体时才与脱氧核糖核酸 (DNA) 上的操纵子结合；任何结合了配体的 TF 都被认为不具有 DNA 结合活性。在具有单个操纵子和低 DNA 拷贝数的热力学平衡体系中，相对于非阻遏水平的基因表达倍数变化由模型 $y = 1/(1 + \\Lambda f_{\\mathrm{A}})$ 描述，其中 $f_{\\mathrm{A}}$ 是处于具有 DNA 结合能力的 TF 分子比例，而 $\\Lambda = R_{\\mathrm{T}}/K_{\\mathrm{O}}$，$R_{\\mathrm{T}}$ 是 TF 总丰度，$K_{\\mathrm{O}}$ 是操纵子解离常数。假设 $K_{\\ell}$、$\\omega$ 和 $\\Lambda$ 相对于 $[L]$ 是常数，并且与转录起始相比，所有平衡都进行得很快，这与转录调控的准平衡控制相符。\n\n仅使用基本原理（质量作用定律、通过结合多项式描述的结合统计热力学，以及阻遏的平衡占据模型），推导由操纵子介导的剂量-响应关系 $y([L])$ 的表观希尔系数 $n_{\\mathrm{H}}$，其定义为半最大活化点处希尔变换的斜率：\n$$\nn_{\\mathrm{H}} \\equiv \\left.\\frac{d \\ln\\!\\left(\\frac{y}{1-y}\\right)}{d \\ln [L]}\\right|_{y=1/2}.\n$$\n考虑一个具有协同性配体结合（$\\omega = 10$）的野生型 TF 和一个破坏了协同性使得配体结合位点独立的突变体（$\\omega = 1$）。对于这两种情况，均取 $\\Lambda = 10$。计算在半最大活化点处表观希尔系数的比值，\n$$\n\\frac{n_{\\mathrm{H}}(\\omega=10)}{n_{\\mathrm{H}}(\\omega=1)},\n$$\n并将其以纯数字形式报告。将您的答案四舍五入到三位有效数字。", "solution": "该问题要求为一个简单的转录阻遏模型推导表观希尔系数，并计算该系数在配体结合协同性参数 $\\omega$ 取两个不同值时的比值。整个推导过程必须按规定从基本原理出发。\n\n首先，我们必须确定转录因子 (TF) 二聚体的状态及其统计权重。该 TF 是一个同源二聚体，具有两个相同的配体结合位点。设 $P$ 代表 TF 二聚体，$L$ 代表配体。该系统涉及以下处于平衡状态的物质：未结合配体的 TF ($P$)、单配体结合的 TF ($PL$) 和双配体结合的 TF ($PL_2$) 。根据统计热力学原理，我们定义一个结合多项式 $\\mathcal{Z}$，它是所有可能状态的统计权重之和。未结合配体状态 $P$ 的权重被作为参考，其值为 $1$。\n\n单配体结合状态 $PL$ 可以通过 $\\binom{2}{1} = 2$ 种方式形成。每个结合事件都与项 $K_{\\ell}[L]$ 相关联，其中 $K_{\\ell}$ 是微观结合常数，$[L]$ 是配体浓度。因此，$PL$ 状态的统计权重是 $2 K_{\\ell} [L]$。\n\n双配体结合状态 $PL_2$ 是通过结合两个配体形成的。在位点独立的情况下，其权重应为 $(K_{\\ell}[L])^2$。问题指出，一个协同性参数 $\\omega$ 会乘以这个权重。因此，$PL_2$ 状态的统计权重是 $\\omega (K_{\\ell}[L])^2$。\n\n作为配体结合过程的配分函数的结合多项式，是这些权重之和：\n$$\n\\mathcal{Z}([L]) = 1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2\n$$\n\n问题指出，只有未结合配体的 TF 才具有 DNA 结合能力。这种形式是“活性”阻遏物，我们将其表示为状态 $A$。处于此活性状态的 TF 比例 $f_{\\mathrm{A}}$ 是活性状态的权重与所有权重之和的比值：\n$$\nf_{\\mathrm{A}}([L]) = \\frac{1}{\\mathcal{Z}([L])} = \\frac{1}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2}\n$$\n\n基因表达的倍数变化 $y$ 由阻遏的热力学模型给出：\n$$\ny([L]) = \\frac{1}{1 + \\Lambda f_{\\mathrm{A}}([L])}\n$$\n其中 $\\Lambda = R_{\\mathrm{T}}/K_{\\mathrm{O}}$ 是一个代表阻遏物效力的常数。\n\n表观希尔系数 $n_{\\mathrm{H}}$ 在半最大活化点 $y=1/2$ 处定义为：\n$$\nn_{\\mathrm{H}} \\equiv \\left.\\frac{d \\ln\\!\\left(\\frac{y}{1-y}\\right)}{d \\ln [L]}\\right|_{y=1/2}\n$$\n为了计算这个值，我们首先求出希尔变换 $\\ln\\left(\\frac{y}{1-y}\\right)$ 的表达式。从 $y$ 的表达式，我们有：\n$$\n1-y = 1 - \\frac{1}{1 + \\Lambda f_{\\mathrm{A}}} = \\frac{1 + \\Lambda f_{\\mathrm{A}} - 1}{1 + \\Lambda f_{\\mathrm{A}}} = \\frac{\\Lambda f_{\\mathrm{A}}}{1 + \\Lambda f_{\\mathrm{A}}}\n$$\n那么，该比值为：\n$$\n\\frac{y}{1-y} = \\frac{1/(1 + \\Lambda f_{\\mathrm{A}})}{\\Lambda f_{\\mathrm{A}}/(1 + \\Lambda f_{\\mathrm{A}})} = \\frac{1}{\\Lambda f_{\\mathrm{A}}}\n$$\n取自然对数得到希尔变换：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = \\ln\\left(\\frac{1}{\\Lambda f_{\\mathrm{A}}}\\right) = -\\ln(\\Lambda) - \\ln(f_{\\mathrm{A}})\n$$\n代入 $f_{\\mathrm{A}}$ 的表达式：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = -\\ln(\\Lambda) - \\ln\\left((1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)^{-1}\\right) = -\\ln(\\Lambda) + \\ln(1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)\n$$\n现在，我们对 $\\ln[L]$ 求导以求得 $n_{\\mathrm{H}}$。使用链式法则，$\\frac{d}{d\\ln[L]} = [L]\\frac{d}{d[L]}$：\n$$\nn_{\\mathrm{H}} = \\frac{d}{d \\ln [L]} \\left[-\\ln(\\Lambda) + \\ln(1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)\\right]\n$$\n常数项 $-\\ln(\\Lambda)$ 的导数为零。\n$$\nn_{\\mathrm{H}} = [L] \\frac{d}{d[L]} \\ln(1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)\n$$\n$$\nn_{\\mathrm{H}} = [L] \\frac{2 K_{\\ell} + 2 \\omega K_{\\ell}^2 [L]}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2} = \\frac{2 K_{\\ell} [L] + 2 \\omega (K_{\\ell} [L])^2}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2}\n$$\n我们定义一个无量纲浓度 $u = K_{\\ell}[L]$。$n_{\\mathrm{H}}$ 的表达式简化为：\n$$\nn_{\\mathrm{H}}(u) = \\frac{2u + 2\\omega u^2}{1 + 2u + \\omega u^2}\n$$\n该表达式必须在 $y = 1/2$ 的点进行计算。条件 $y=1/2$ 意味着 $\\frac{y}{1-y}=1$，即 $\\frac{1}{\\Lambda f_{\\mathrm{A}}} = 1$，或 $\\Lambda f_{\\mathrm{A}} = 1$。代入 $f_{\\mathrm{A}}$：\n$$\n\\frac{\\Lambda}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2} = 1\n$$\n用 $u$ 表示，这个条件是 $1 + 2u + \\omega u^2 = \\Lambda$。设 $u_{1/2}$ 是满足此条件的 $u$ 值。这是一个关于 $u_{1/2}$ 的二次方程：\n$$\n\\omega u_{1/2}^2 + 2u_{1/2} + (1 - \\Lambda) = 0\n$$\n使用二次公式求解 $u_{1/2}$，并取具有物理意义的正根（因为 $u=K_{\\ell}[L]  0$）：\n$$\nu_{1/2} = \\frac{-2 + \\sqrt{4 - 4\\omega(1-\\Lambda)}}{2\\omega} = \\frac{-1 + \\sqrt{1 + \\omega(\\Lambda-1)}}{\\omega}\n$$\n在这个特定点，$n_{\\mathrm{H}}$ 表达式的分母就是 $\\Lambda$。对于分子，我们可以使用二次方程：$\\omega u_{1/2}^2 = \\Lambda - 1 - 2u_{1/2}$。\n$$\nn_{\\mathrm{H}}|_{y=1/2} = \\frac{2u_{1/2} + 2\\omega u_{1/2}^2}{\\Lambda} = \\frac{2u_{1/2} + 2(\\Lambda - 1 - 2u_{1/2})}{\\Lambda} = \\frac{2\\Lambda - 2 - 2u_{1/2}}{\\Lambda} = 2 - \\frac{2(1+u_{1/2})}{\\Lambda}\n$$\n代入 $u_{1/2}$ 的表达式：\n$$\nn_{\\mathrm{H}} = 2 - \\frac{2}{\\Lambda}\\left(1 + \\frac{\\sqrt{1 + \\omega(\\Lambda-1)} - 1}{\\omega}\\right) = 2 - \\frac{2}{\\omega\\Lambda}\\left(\\omega + \\sqrt{1 + \\omega(\\Lambda-1)} - 1\\right)\n$$\n一个等价的，也许更直接的表示是：\n$$\nn_{\\mathrm{H}} = \\frac{2(\\Lambda - 1 - u_{1/2})}{\\Lambda} = \\frac{2}{\\Lambda} \\left( \\Lambda-1 - \\frac{\\sqrt{1+\\omega(\\Lambda-1)}-1}{\\omega} \\right) = \\frac{2}{\\omega\\Lambda} \\left( \\omega(\\Lambda-1) - \\sqrt{1+\\omega(\\Lambda-1)} + 1 \\right)\n$$\n我们现在用这个最终公式来计算给定两种情况下的 $n_{\\mathrm{H}}$，其中 $\\Lambda=10$。该公式变为：\n$$\nn_{\\mathrm{H}}(\\omega) = \\frac{2}{10\\omega} (9\\omega - \\sqrt{1+9\\omega} + 1) = \\frac{1}{5\\omega} (9\\omega + 1 - \\sqrt{1+9\\omega})\n$$\n情况1：具有独立位点的突变体，$\\omega=1$。\n$$\nn_{\\mathrm{H}}(\\omega=1) = \\frac{1}{5(1)} (9(1) + 1 - \\sqrt{1+9(1)}) = \\frac{1}{5} (10 - \\sqrt{10})\n$$\n情况2：具有协同性结合的野生型，$\\omega=10$。\n$$\nn_{\\mathrm{H}}(\\omega=10) = \\frac{1}{5(10)} (9(10) + 1 - \\sqrt{1+9(10)}) = \\frac{1}{50} (91 - \\sqrt{91})\n$$\n问题要求计算这两个值的比值：\n$$\n\\frac{n_{\\mathrm{H}}(\\omega=10)}{n_{\\mathrm{H}}(\\omega=1)} = \\frac{\\frac{1}{50} (91 - \\sqrt{91})}{\\frac{1}{5} (10 - \\sqrt{10})} = \\frac{5}{50} \\frac{91 - \\sqrt{91}}{10 - \\sqrt{10}} = \\frac{1}{10} \\frac{91 - \\sqrt{91}}{10 - \\sqrt{10}}\n$$\n现在，我们计算数值。\n$$\n\\sqrt{10} \\approx 3.16227766\n$$\n$$\n\\sqrt{91} \\approx 9.53939201\n$$\n$$\n\\frac{n_{\\mathrm{H}}(\\omega=10)}{n_{\\mathrm{H}}(\\omega=1)} = \\frac{1}{10} \\frac{91 - 9.53939201}{10 - 3.16227766} = \\frac{1}{10} \\frac{81.46060799}{6.83772234} \\approx \\frac{1}{10} (11.91341) \\approx 1.191341\n$$\n四舍五入到三位有效数字，结果是 $1.19$。", "answer": "$$\\boxed{1.19}$$", "id": "2755183"}, {"introduction": "一个工程化的基因线路必须在宿主细胞庞大而复杂的基因组环境中可靠地运行。一个关键挑战是确保合成的抑制子特异性地结合其目标操纵子，避免非预期的“脱靶”效应。在这项最后的练习中 [@problem_id:2755167]，您将开发一个计算模型来估算脱靶结合的概率，将热力学原理与实现基因组特异性这一实际工程目标联系起来。", "problem": "给定一个转录因子与脱氧核糖核酸 (DNA) 结合的热力学模型，其中每个基因组位点最多可以结合一个蛋白质分子，且结合位点是独立的。该模型的基础是采用巨正则系综的统计热力学，这意味着在化学势为 $\\mu$ 时，一个结合能为 $E$ 的位点的平均占有率为 $1/(1+\\exp(E-\\mu))$。假设所有能量都以 $k_\\mathrm{B}T$ 为单位表示（无量纲）。我们关注的一个特定工程改造的操纵子序列具有基序得分 $s_O$，而基因组其余部分的基序得分 $s$ 的分布，我们将其建模为均值为 $m_s$、标准差为 $\\sigma_s$ 的正态分布。从基序得分 $s$ 到结合能的映射是线性的：$E(s)=E_{\\mathrm{ref}} - \\lambda s$，其中 $\\lambda0$ 是每个基序得分单位的能量敏感度，$E_{\\mathrm{ref}}$ 是一个参考能量。\n\n您的任务是为每个指定的测试用例计算一个随机选择的已结合转录因子分子发生脱靶结合（即结合到工程改造的操纵子以外的任何基因组位点）的概率。在巨正则稀疏位点模型中，这个脱靶结合概率是以下分数\n$$\nP_{\\mathrm{off}} \\equiv \\frac{B}{n_O + B},\n$$\n其中 $n_O$ 是工程改造的操纵子的平均占有率，$B$ 是在整个基因组背景上积分得到的总平均占有率。对于给定的模型，\n- 工程改造操纵子的占有率为 $n_O = \\dfrac{1}{1+\\exp(E(s_O)-\\mu)}$。\n- 基因组背景总占有率近似为\n$$\nB \\approx N \\int_{-\\infty}^{+\\infty} \\phi(s\\,;\\, m_s,\\sigma_s)\\, \\frac{1}{1+\\exp(E(s)-\\mu)}\\, ds,\n$$\n其中 $N$ 是独立基因组位点的数量（不包括工程改造的操纵子），$\\phi(s\\,;\\, m_s,\\sigma_s)$ 是均值为 $m_s$、标准差为 $\\sigma_s$ 的正态概率密度函数。\n\n此外，我们将“次优基因组位点”定义为 $N$ 个背景位点中的期望最大基序得分所对应的位点。使用分位数近似法来估算 $N$ 个独立同分布正态变量的期望最大值，可得到期望最佳背景得分为\n$$\ns_{\\mathrm{best}} \\approx m_s + \\sigma_s\\,\\Phi^{-1}\\!\\left(1-\\frac{1}{N}\\right),\n$$\n其中 $\\Phi^{-1}$ 是标准正态分布的反累积分布函数。那么，与这个次优基因组位点的能量差为\n$$\n\\Delta E \\equiv E(s_{\\mathrm{best}}) - E(s_O).\n$$\n您将通过评估不同 $s_O$ 和 $N$ 的测试用例中的 $P_{\\mathrm{off}}$，来考察增加 $\\Delta E$ 如何降低 $P_{\\mathrm{off}}$。\n\n所有能量均以 $k_\\mathrm{B}T$ 为单位（无量纲），不涉及角度。将每个 $P_{\\mathrm{off}}$ 以浮点数形式报告，并四舍五入到六位小数。\n\n测试套件（所有用例使用相同的 $E_{\\mathrm{ref}}$、$\\lambda$、$m_s$、$\\sigma_s$ 和 $\\mu$，除非某个用例明确覆盖了某个符号）：\n- 所有用例的共享参数：$E_{\\mathrm{ref}}=0$, $\\lambda=1.5$, $m_s=0.0$, $\\sigma_s=1.0$, $\\mu=-5.0$。\n- 用例1（理想情况）：$N=10{,}000{,}000$, $s_O=5.0$。\n- 用例2（基因组大小压力测试）：$N=100{,}000{,}000$, $s_O=5.0$。\n- 用例3（接近零的能量差）：$N=10{,}000{,}000$, $s_O = m_s + \\sigma_s\\,\\Phi^{-1}\\!\\left(1-\\frac{1}{N}\\right)$。\n- 用例4（负能量差）：$N=10{,}000{,}000$, $s_O = \\left[m_s + \\sigma_s\\,\\Phi^{-1}\\!\\left(1-\\frac{1}{N}\\right)\\right] - 1.0$。\n- 用例5（大正能量差）：$N=10{,}000{,}000$, $s_O=7.0$。\n\n您的程序必须：\n- 实现上述定义。\n- 以足够的精度数值计算 $B$ 的积分，以获得稳定的六位小数答案。\n- 为每个用例计算 $P_{\\mathrm{off}}$。\n- 生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，结果顺序与上述用例列表一致。例如：“[x1,x2,x3,x4,x5]”。每个 $x_i$ 必须四舍五入到六位小数（十进制表示法）。\n\n最终输出为浮点数；由于所有能量均以 $k_\\mathrm{B}T$ 为单位（无量纲），因此不需要其他单位。", "solution": "问题陈述已经过严格审查，并被认为是有效的。它在科学上基于统计热力学原理在分子生物学中的应用，问题提法适定，提供了所有必要信息，并以客观、定量的术语表述。不存在逻辑矛盾、事实不准确或不符合物理规律的假设。因此，我们可以着手解决问题。\n\n任务是计算转录因子的脱靶结合概率 $P_{\\mathrm{off}}$。该概率定义为所有已结合的蛋白质分子中，位于非特异性（背景）基因组位点而非单个工程改造的操纵子位点上的分子所占的比例。该模型基于巨正则系综，其中各位点是独立的，每个位点可以为空，也可以被一个分子占据。\n\n该概率由以下表达式给出：\n$$\nP_{\\mathrm{off}} = \\frac{B}{n_O + B}\n$$\n此处，$n_O$ 表示结合到工程改造的操纵子位点上的分子的平均数量，$B$ 是结合在所有背景基因组位点上的分子的总平均数量。\n\n计算分三个阶段进行：\n1.  计算工程改造操纵子的平均占有率 $n_O$。\n2.  计算背景基因组的总平均占有率 $B$。\n3.  结合这些量来确定 $P_{\\mathrm{off}}$。\n\n所有测试用例的共享参数如下：\n- 参考能量, $E_{\\mathrm{ref}} = 0.0$\n- 能量敏感度, $\\lambda = 1.5$\n- 背景基序得分均值, $m_s = 0.0$\n- 背景基序得分标准差, $\\sigma_s = 1.0$\n- 化学势, $\\mu = -5.0$\n\n结合能 $E$ 是基序得分 $s$ 的线性函数：\n$$\nE(s) = E_{\\mathrm{ref}} - \\lambda s = 0.0 - 1.5s = -1.5s\n$$\n所有能量都是无量纲的，以 $k_{\\mathrm{B}}T$ 为单位表示。\n\n首先，我们确定工程改造操纵子的平均占有率 $n_O$。对于基序得分为 $s_O$ 的单个位点，其结合能为 $E(s_O)$。占有率可由单个位点的巨正则配分函数得出：\n$$\nn_O = \\frac{1}{1 + \\exp(E(s_O) - \\mu)}\n$$\n对于测试用例中的每个特定 $s_O$，都必须计算该值。\n\n其次，我们确定基因组背景的总平均占有率 $B$。背景由 $N$ 个独立位点组成，其基序得分 $s$ 由正态概率密度函数 $\\phi(s\\,;\\, m_s, \\sigma_s)$ 描述。背景总占有率是位点占有率在该分布上的积分，再乘以位点数 $N$：\n$$\nB = N \\int_{-\\infty}^{+\\infty} \\phi(s\\,;\\, m_s, \\sigma_s) \\left( \\frac{1}{1 + \\exp(E(s) - \\mu)} \\right) ds\n$$\n代入背景的给定函数和参数：\n$$\nB = N \\int_{-\\infty}^{+\\infty} \\frac{1}{\\sqrt{2\\pi}\\sigma_s} \\exp\\left(-\\frac{(s-m_s)^2}{2\\sigma_s^2}\\right) \\cdot \\frac{1}{1 + \\exp(-1.5s - (-5.0))} ds\n$$\n当 $m_s=0.0$ 和 $\\sigma_s=1.0$ 时，积分为：\n$$\nI = \\int_{-\\infty}^{+\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{s^2}{2}\\right) \\cdot \\frac{1}{1 + \\exp(5.0 - 1.5s)} ds\n$$\n因此 $B = N \\times I$。该定积分没有简单的闭合形式解析解，必须进行数值计算。由于定义背景分布的参数（$m_s$, $\\sigma_s$）和系统条件（$\\lambda$, $\\mu$）在所有测试用例中都是恒定的，因此该积分 $I$ 只需要计算一次。我们采用高精度数值求积方法来完成此任务。\n\n计算出 $n_O$ 和 $B$ 的值后，我们为每个用例计算 $P_{\\mathrm{off}}$。\n\n逐个用例分析：\n\n**用例1：** $N=10,000,000$, $s_O=5.0$。\n我们使用 $s_O=5.0$ 直接计算 $n_O$，并使用 $N=10^7$ 和预先计算的积分 $I$ 来计算 $B$。\n\n**用例2：** $N=100,000,000$, $s_O=5.0$。\n此用例与用例1相同，但基因组大小 $N$ 增加了十倍。$n_O$ 保持不变，而 $B$ 随 $N$ 成比例增加。\n\n**用例3：** $N=10,000,000$, $s_O = m_s + \\sigma_s\\,\\Phi^{-1}\\!\\left(1-\\frac{1}{N}\\right)$。\n对于此用例，操纵子得分 $s_O$ 被设置为在 $N$ 个背景位点中找到的期望最大得分 $s_{\\mathrm{best}}$。函数 $\\Phi^{-1}$ 是标准正态累积分布函数（CDF）的反函数，也称为概率单位函数。我们首先计算 $s_O = 0.0 + 1.0 \\times \\Phi^{-1}(1 - 10^{-7})$，然后按标准用例的步骤进行计算。\n\n**用例4：** $N=10,000,000$, $s_O = \\left[m_s + \\sigma_s\\,\\Phi^{-1}\\!\\left(1-\\frac{1}{N}\\right)\\right] - 1.0$。\n在这里，操纵子得分 $s_O$ 比期望的最佳背景位点得分低 $1.0$ 个得分单位。计算过程遵循用例3的步骤，只是最终的 $s_O$ 值减去 $1.0$。\n\n**用例5：** $N=10,000,000$, $s_O=7.0$。\n此用例考察了一个非常强的操纵子位点的效果，其中 $s_O$ 增加到 $7.0$。计算过程与用例1相同，只是使用了新的 $s_O$ 值。\n\n根据要求，最终结果四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves the transcription factor binding problem for five test cases.\n    \"\"\"\n    # Shared parameters for all cases\n    E_ref = 0.0\n    lambda_ = 1.5\n    m_s = 0.0\n    sigma_s = 1.0\n    mu = -5.0\n\n    # Define the energy function E(s)\n    def energy(s, E_ref_val, lambda_val):\n        return E_ref_val - lambda_val * s\n\n    # Define the integrand for the total background occupancy B.\n    # The integrand is the product of the Normal PDF of motif scores and the\n    # occupancy probability for a given score.\n    def integrand_for_B(s, E_ref_val, lambda_val, mu_val, m_s_val, sigma_s_val):\n        E_s = energy(s, E_ref_val, lambda_val)\n        occupancy = 1.0 / (1.0 + np.exp(E_s - mu_val))\n        pdf = norm.pdf(s, loc=m_s_val, scale=sigma_s_val)\n        return pdf * occupancy\n\n    # The integral part of B is constant across all cases since the background\n    # distribution and thermodynamic parameters do not change.\n    # We calculate it once with high precision.\n    integral_val, _ = quad(\n        integrand_for_B,\n        -np.inf,\n        np.inf,\n        args=(E_ref, lambda_, mu, m_s, sigma_s),\n        epsabs=1e-12, # Use high precision for stable results\n        epsrel=1e-12\n    )\n\n    # Define the test cases. Each tuple contains (N, s_O_value or function to compute it).\n    # Using lambda functions for cases where s_O depends on N.\n    test_cases = [\n        {'N': 10_000_000, 's_O': 5.0},\n        {'N': 100_000_000, 's_O': 5.0},\n        {'N': 10_000_000, 's_O': lambda N: m_s + sigma_s * norm.ppf(1.0 - 1.0 / N)},\n        {'N': 10_000_000, 's_O': lambda N: (m_s + sigma_s * norm.ppf(1.0 - 1.0/N)) - 1.0},\n        {'N': 10_000_000, 's_O': 7.0}\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case['N']\n        s_O_spec = case['s_O']\n        \n        # Resolve s_O if it's a function\n        if callable(s_O_spec):\n            s_O = s_O_spec(N)\n        else:\n            s_O = s_O_spec\n        \n        # Calculate n_O: mean occupancy of the engineered operator\n        E_O = energy(s_O, E_ref, lambda_)\n        n_O = 1.0 / (1.0 + np.exp(E_O - mu))\n        \n        # Calculate B: total mean occupancy of the genomic background\n        B = N * integral_val\n        \n        # Calculate P_off: probability of off-target binding\n        P_off = B / (n_O + B)\n        \n        results.append(P_off)\n\n    # Format the final output as a comma-separated list of floats rounded to six decimal places,\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2755167"}]}