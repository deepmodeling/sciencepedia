{"hands_on_practices": [{"introduction": "抗生素发挥作用的第一步是穿过细菌的细胞包膜并进入细胞质。我们可以利用基本的流入和流出动力学原理来量化这一过程。通过这项练习[@problem_id:2505021]，您将学习如何推导稳态下的细胞内药物浓度，这是决定抗生素效力的关键因素，也是药代动力学建模的一项基本技能。", "problem": "将一个细菌暴露于恒定细胞外浓度的、靶向核糖体的抗生素中，该抗生素通过与细菌的$30\\mathrm{S}$核糖体亚基结合来抑制翻译。假设以下基于质量守恒和跨细胞包膜转运的基本动力学描述的机理特征：(i) 细胞质混合均匀，细胞体积恒定，(ii) 穿过包膜的抗生素流入相对于细胞外浓度是一级反应，速率常数为$k_{\\mathrm{in}}$（单位为$\\mathrm{time}^{-1}$），(iii) 抗生素流出相对于细胞内游离浓度是一级反应，速率常数为$k_{\\mathrm{out}}$（单位为$\\mathrm{time}^{-1}$），(iv) 细胞外浓度$C_{\\mathrm{out}}$是恒定的，以及 (v) 在转运的时间尺度上，与靶标的细胞内结合相对于游离抗生素库可忽略不计，因此细胞内浓度$C_{\\mathrm{in}}$指的是游离浓度。\n\n仅使用细胞内抗生素量的质量守恒和所述的一级转运假设，推导稳态细胞内浓度$C_{\\mathrm{in}}$关于$k_{\\mathrm{in}}$、$k_{\\mathrm{out}}$和$C_{\\mathrm{out}}$的表达式。然后，计算当$k_{\\mathrm{in}} = 0.120\\,\\mathrm{min}^{-1}$，$k_{\\mathrm{out}} = 0.0300\\,\\mathrm{min}^{-1}$和$C_{\\mathrm{out}} = 7.50\\,\\mu\\mathrm{M}$时$C_{\\mathrm{in}}$的值。\n\n将最终浓度以$\\mu\\mathrm{M}$为单位表示，并将答案四舍五入到三位有效数字。", "solution": "首先对问题陈述进行严格验证。\n\n逐字提取已知条件：\n- 系统：一个暴露于靶向核糖体的抗生素中的细菌。\n- 假设 (i)：细胞质混合均匀，细胞体积恒定。\n- 假设 (ii)：穿过包膜的抗生素流入相对于细胞外浓度是一级反应，速率常数为$k_{\\mathrm{in}}$（单位为$\\mathrm{time}^{-1}$）。\n- 假设 (iii)：抗生素流出相对于细胞内游离浓度是一级反应，速率常数为$k_{\\mathrm{out}}$（单位为$\\mathrm{time}^{-1}$）。\n- 假设 (iv)：细胞外浓度$C_{\\mathrm{out}}$是恒定的。\n- 假设 (v)：与靶标的细胞内结合相对于游离抗生素库可忽略不计，且$C_{\\mathrm{in}}$指的是游离浓度。\n- 任务1：推导稳态细胞内浓度$C_{\\mathrm{in}}$关于$k_{\\mathrm{in}}$、$k_{\\mathrm{out}}$和$C_{\\mathrm{out}}$的表达式。\n- 任务2：计算当$k_{\\mathrm{in}} = 0.120\\,\\mathrm{min}^{-1}$，$k_{\\mathrm{out}} = 0.0300\\,\\mathrm{min}^{-1}$和$C_{\\mathrm{out}} = 7.50\\,\\mu\\mathrm{M}$时$C_{\\mathrm{in}}$的值。\n- 任务3：将最终浓度以$\\mu\\mathrm{M}$为单位表示，并四舍五入到三位有效数字。\n\n验证表明该问题具有科学依据、提法明确且客观。这些假设构成了一个标准的、简化的物质跨细胞膜转运的动力学模型，通常用常微分方程表示。“流入……相对于细胞外浓度是一级反应，速率常数为$k_{\\mathrm{in}}$（单位为$\\mathrm{time}^{-1}$）”这一表述意味着，由流入引起的*浓度*变化率由乘积$k_{\\mathrm{in}} C_{\\mathrm{out}}$给出。这种解释创建了一个量纲一致的模型，其中浓度的变化率（$\\mathrm{concentration} \\cdot \\mathrm{time}^{-1}$）与具有相同单位的项（$k_{\\mathrm{in}} C_{\\mathrm{out}}$的单位是$\\mathrm{time}^{-1} \\cdot \\mathrm{concentration}$）相等。提供了所有必要信息，且没有矛盾之处。问题是有效的，可以解决。\n\n解题过程从应用于细胞内抗生素浓度（记为$C_{\\mathrm{in}}(t)$）的质量守恒原理开始。该浓度的变化率$\\frac{dC_{\\mathrm{in}}}{dt}$是流入和流出速率的净结果。\n\n根据假设 (ii)，增加$C_{\\mathrm{in}}$的流入速率相对于恒定的细胞外浓度$C_{\\mathrm{out}}$是一级反应。因此，对变化率的贡献是$+k_{\\mathrm{in}} C_{\\mathrm{out}}$。\n\n根据假设 (iii)，减少$C_{\\mathrm{in}}$的流出速率相对于细胞内浓度$C_{\\mathrm{in}}$是一级反应。因此，对变化率的贡献是$-k_{\\mathrm{out}} C_{\\mathrm{in}}$。\n\n结合这些项，得到控制细胞内抗生素浓度的常微分方程：\n$$\n\\frac{dC_{\\mathrm{in}}}{dt} = k_{\\mathrm{in}} C_{\\mathrm{out}} - k_{\\mathrm{out}} C_{\\mathrm{in}}\n$$\n\n问题要求的是稳态浓度。在稳态时，系统变量不再随时间变化。因此，浓度的时间导数必须为零。设$C_{\\mathrm{in,ss}}$表示稳态细胞内浓度。将导数设为零，得到稳态的条件：\n$$\n\\frac{dC_{\\mathrm{in}}}{dt} = 0\n$$\n将此代入微分方程，得到：\n$$\n0 = k_{\\mathrm{in}} C_{\\mathrm{out}} - k_{\\mathrm{out}} C_{\\mathrm{in,ss}}\n$$\n这是一个关于$C_{\\mathrm{in,ss}}$的代数方程。为了找到所要求的表达式，我们求解$C_{\\mathrm{in,ss}}$：\n$$\nk_{\\mathrm{out}} C_{\\mathrm{in,ss}} = k_{\\mathrm{in}} C_{\\mathrm{out}}\n$$\n$$\nC_{\\mathrm{in,ss}} = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} C_{\\mathrm{out}}\n$$\n这是稳态细胞内抗生素浓度的解析表达式。它表明稳态积累由流入与流出速率常数之比决定，并按外部浓度进行缩放。\n\n接下来，我们使用给定的数值来计算这个表达式：\n$k_{\\mathrm{in}} = 0.120\\,\\mathrm{min}^{-1}$\n$k_{\\mathrm{out}} = 0.0300\\,\\mathrm{min}^{-1}$\n$C_{\\mathrm{out}} = 7.50\\,\\mu\\mathrm{M}$\n\n将这些值代入推导出的表达式：\n$$\nC_{\\mathrm{in,ss}} = \\frac{0.120\\,\\mathrm{min}^{-1}}{0.0300\\,\\mathrm{min}^{-1}} \\times 7.50\\,\\mu\\mathrm{M}\n$$\n速率常数之比是一个无量纲量：\n$$\n\\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} = \\frac{0.120}{0.0300} = 4.00\n$$\n计算过程保持三位有效数字，因为两个输入值都有三位。\n现在，我们计算最终浓度：\n$$\nC_{\\mathrm{in,ss}} = 4.00 \\times 7.50\\,\\mu\\mathrm{M} = 30.0\\,\\mu\\mathrm{M}\n$$\n两个具有三位有效数字的数（$4.00$和$7.50$）的乘积，其结果也应报告为三位有效数字。计算值为$30.0$。\n最终的数值答案，以$\\mu\\mathrm{M}$为单位表示并四舍五入到三位有效数字，是$30.0$。", "answer": "$$\n\\boxed{30.0}\n$$", "id": "2505021"}, {"introduction": "药物进入细胞后，必须有效地与其分子靶点结合。对于像β-内酰胺类这样的共价抑制剂，我们可以使用质量作用动力学来精确模拟这种相互作用。这项练习[@problem_id:2504971]将让您能够量化“靶点占有率”，即在特定药物浓度下被抑制的靶酶比例，从而在药代动力学和药效学之间建立直接联系。", "problem": "$\\beta$-内酰胺类抗生素的一个临床相关作用机制是青霉素结合蛋白（PBP）活性位点的丝氨酸发生共价酰化，从而抑制肽聚糖的交联。考虑一个简化的两态动力学模型，其中单个PBP物种的活性位点在游离形式$E$和酰化（抑制）形式$E^{\\ast}$之间切换。抗生素$A$大量过量，因此在所关注的时间进程中，其浓度可认为保持恒定。动力学步骤为：酰化 $E + A \\xrightarrow{k_{2}} E^{\\ast}$（二级反应）和脱酰 $E^{\\ast} \\xrightarrow{k_{3}} E$（一级反应）。令$E_{\\text{tot}}$表示PBP活性位点的守恒总浓度，$E_{\\text{tot}} = [E] + [E^{\\ast}]$。\n\n从质量作用动力学和$[E^{\\ast}]$的稳态条件出发，推导酰化活性位点的稳态分数 $f = [E^{\\ast}]/E_{\\text{tot}}$ 关于$k_{2}$、$k_{3}$和$[A]$的表达式。然后，使用你的表达式，在$k_{2}/k_{3} = 5.0 \\times 10^{7}\\ \\text{M}^{-1}$和抗生素浓度$[A] = 0.20\\ \\mu\\text{M}$的条件下计算$f$。\n\n将最终数值答案四舍五入至四位有效数字。将最终分数表示为无单位小数。", "solution": "我们从指定模型的质量作用定律开始。酰化态$E^{\\ast}$的生成速率为$k_{2}[A][E]$，消耗速率为$k_{3}[E^{\\ast}]$。因此，$[E^{\\ast}]$随时间的变化为\n$$\n\\frac{d[E^{\\ast}]}{dt} = k_{2}[A][E] - k_{3}[E^{\\ast}].\n$$\n由于PBP总浓度是守恒的，我们有$E_{\\text{tot}} = [E] + [E^{\\ast}]$，所以$[E] = E_{\\text{tot}} - [E^{\\ast}]$。\n\n在稳态下，酰化形式的浓度不随时间变化，所以$\\frac{d[E^{\\ast}]}{dt} = 0$，由此得出\n$$\n0 = k_{2}[A](E_{\\text{tot}} - [E^{\\ast}]) - k_{3}[E^{\\ast}].\n$$\n整理各项，\n$$\nk_{2}[A]E_{\\text{tot}} = (k_{2}[A] + k_{3})[E^{\\ast}],\n$$\n因此\n$$\n[E^{\\ast}] = \\frac{k_{2}[A]}{k_{2}[A] + k_{3}}\\,E_{\\text{tot}}.\n$$\n那么，酰化位点的稳态分数是\n$$\nf \\equiv \\frac{[E^{\\ast}]}{E_{\\text{tot}}} = \\frac{k_{2}[A]}{k_{2}[A] + k_{3}}.\n$$\n用比值$k_{2}/k_{3}$来表示此式会很方便。定义无量纲参数\n$$\n\\phi \\equiv \\left(\\frac{k_{2}}{k_{3}}\\right)[A],\n$$\n于是\n$$\nf = \\frac{\\phi}{1 + \\phi}.\n$$\n\n现在代入给定值。首先，将抗生素浓度转换为摩尔单位。给定浓度为$[A] = 0.20\\ \\mu\\text{M} = 0.20 \\times 10^{-6}\\ \\text{M} = 2.0 \\times 10^{-7}\\ \\text{M}$。当$k_{2}/k_{3} = 5.0 \\times 10^{7}\\ \\text{M}^{-1}$时，\n$$\n\\phi = \\left(5.0 \\times 10^{7}\\ \\text{M}^{-1}\\right)\\left(2.0 \\times 10^{-7}\\ \\text{M}\\right) = 10.\n$$\n因此，\n$$\nf = \\frac{10}{1 + 10} = \\frac{10}{11} \\approx 0.909090\\ldots\n$$\n四舍五入到四位有效数字，得到无单位小数$0.9091$。", "answer": "$$\\boxed{0.9091}$$", "id": "2504971"}, {"introduction": "对于革兰氏阴性菌，简单的药物转运模型有其局限性，因为抗生素不仅需要扩散穿过复杂的外膜，还会与脂多糖（LPS）等组分发生相互作用。我们可以使用反应-扩散模型来捕捉这种复杂性。这项高级练习[@problem_id:2504924]将向您介绍计算建模这一强大工具，通过实施数值求解，您将更深入地理解膜内相互作用如何显著延迟药物到达其最终靶点的时间。", "problem": "要求您构建并模拟一个最小一维反应扩散模型，用于描述多粘菌素在与脂多糖（LPS；lipopolysaccharide）可逆结合的情况下穿过革兰氏阴性菌外膜的过程。从以下基本原理出发：Fick 扩散第一和第二定律，以及可逆结合的质量作用定律。目标是量化 LPS 结合位点的密度如何调节多粘菌素在外膜内边界处达到指定进入通量所需的时间。\n\n模型假设与定义：\n- 将外膜建模为厚度为 $L$ 的平面薄层，空间坐标为 $x\\in[0,L]$，其中 $x=0$ 是细胞外侧，$x=L$ 是面向周质的外膜内边界。\n- 令 $C(x,t)$ 表示可移动的多粘菌素浓度（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$），$B(x,t)$ 表示不可移动、可逆结合的多粘菌素浓度（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$）。LPS 结合位点的总密度为 $S_{\\mathrm{tot}}$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$），因此游离位点的浓度为 $S_{\\mathrm{free}}(x,t)=S_{\\mathrm{tot}}-B(x,t)$。\n- Fick 第二定律给出 $\\partial C/\\partial t = D\\,\\partial^2 C/\\partial x^2 + R(C,B)$，其中扩散系数为 $D$（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）。反应动力学遵循质量作用定律，结合速率为 $k_{\\mathrm{on}}$（单位为 $\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$），解离速率为 $k_{\\mathrm{off}}$（单位为 $\\mathrm{s}^{-1}$），因此 $R(C,B)=-k_{\\mathrm{on}}\\,C\\,(S_{\\mathrm{tot}}-B)+k_{\\mathrm{off}}\\,B$。结合的物质不扩散：$\\partial B/\\partial t = k_{\\mathrm{on}}\\,C\\,(S_{\\mathrm{tot}}-B)-k_{\\mathrm{off}}\\,B$。\n- 边界条件和初始条件：将 $C(0,t)=C_0$ 固定为一个恒定的浸浴浓度，并设置一个吸收内边界 $C(L,t)=0$，以表示物质被快速移除到周质和内膜中。初始时，对于所有 $x\\in(0,L)$，$C(x,0)=0$ 且 $B(x,0)=0$。\n- 内边界处的瞬时扩散通量由 Fick 第一定律给出：$J(L,t)=-D\\,\\partial C/\\partial x\\,\\big|_{x=L}$，当方向指向细胞包膜内部时为正值。在无结合的极限情况下（$S_{\\mathrm{tot}}=0$），穿过薄层的稳态通量为 $J_{\\mathrm{ss,0}}=D\\,C_0/L$。\n\n定义内膜接触时间 $T_{\\mathrm{access}}$ 为满足 $J(L,t)\\ge f\\,J_{\\mathrm{ss,0}}$ 的最早时间 $t$，其中 $f$ 是一个给定的分数。使用 $f=\\tfrac{1}{2}$。\n\n使用的参数值：\n- 厚度 $L=8\\times 10^{-9}\\ \\mathrm{m}$。\n- 扩散系数 $D=1\\times 10^{-12}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n- 浸浴浓度 $C_0=1.0\\times 10^{-2}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 结合速率 $k_{\\mathrm{on}}=1.0\\times 10^{3}\\ \\mathrm{m}^{3}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$。\n- 解离速率 $k_{\\mathrm{off}}=1.0\\ \\mathrm{s}^{-1}$。\n\n测试集：\n- 针对以下总 LPS 位点密度（单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$）评估 $T_{\\mathrm{access}}$：$S_{\\mathrm{tot}}\\in\\{0,\\ 1,\\ 5,\\ 20\\}$。\n\n任务：\n- 将空间域 $[0,L]$ 离散化为均匀网格，并实现一个直线法求解器来求解耦合的反应扩散系统，同时遵循边界条件 $C(0,t)=C_0$ 和 $C(L,t)=0$。对于每个 $S_{\\mathrm{tot}}$ 值，检测首次满足通量准则 $J(L,t)\\ge f\\,J_{\\mathrm{ss,0}}$ 的时间。\n- 将每个 $T_{\\mathrm{access}}$ 以秒为单位表示，并四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，结果的顺序与上面给出的 $S_{\\mathrm{tot}}$ 测试集值的顺序一致，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$，其中每个 $\\text{result}_i$ 是一个以秒为单位、四舍五入到六位小数的浮点数。", "solution": "问题陈述经验证，确认为生物物理运输现象领域内的一个适定问题，其基础是已确立的物理定律。该问题是自洽的、科学上合理的且客观的。因此，有必要采用数值解法。求解过程通过对耦合偏微分方程组（PDEs）应用直线法来进行。\n\n在厚度为 $L$ 的外膜内，可移动的多粘菌素浓度 $C(x,t)$ 和不可移动的结合浓度 $B(x,t)$ 的控制方程如下：\n$$ \\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2} - k_{\\mathrm{on}} C (S_{\\mathrm{tot}} - B) + k_{\\mathrm{off}} B $$\n$$ \\frac{\\partial B}{\\partial t} = k_{\\mathrm{on}} C (S_{\\mathrm{tot}} - B) - k_{\\mathrm{off}} B $$\n其中 $D$ 是扩散系数，$k_{\\mathrm{on}}$ 和 $k_{\\mathrm{off}}$ 是结合的动力学速率常数，$S_{\\mathrm{tot}}$ 是脂多糖（LPS）结合位点的总密度。\n\n边界条件为 $C(0,t) = C_0$ 和 $C(L,t) = 0$。初始条件为，当 $x  0$ 时 $C(x,0) = 0$，对所有 $x \\in [0,L]$，$B(x,0) = 0$。\n\n为对该系统进行数值求解，采用直线法。将空间域 $x \\in [0, L]$ 离散化为包含 $N+1$ 个点的均匀网格，$x_i = i \\Delta x$，其中 $i = 0, \\ldots, N$ 且 $\\Delta x = L/N$。连续函数 $C(x,t)$ 和 $B(x,t)$ 由随时间变化的向量 $\\mathbf{C}(t) = [C_0(t), C_1(t), \\ldots, C_N(t)]^T$ 和 $\\mathbf{B}(t) = [B_0(t), B_1(t), \\ldots, B_N(t)]^T$ 来近似，其中 $C_i(t) \\approx C(x_i,t)$ 且 $B_i(t) \\approx B(x_i,t)$。\n\n对于内部网格点 $i=1, \\ldots, N-1$，$C$ 的偏微分方程中的空间二阶导数使用二阶中心差分公式进行近似：\n$$ \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{x_i} \\approx \\frac{C_{i-1}(t) - 2C_i(t) + C_{i+1}(t)}{(\\Delta x)^2} $$\n\n这种离散化将偏微分方程组转化为一个大型的耦合常微分方程组（ODEs）。系统在任意时刻 $t$ 的状态由一个状态向量 $\\mathbf{y}(t)$ 描述，该向量包含内部点上的 $C_i(t)$ 值（因为 $C_0$ 和 $C_N$ 由边界条件固定）以及所有点上的 $B_i(t)$ 值。我们将状态向量定义为：\n$$ \\mathbf{y}(t) = [C_1(t), \\ldots, C_{N-1}(t), B_0(t), \\ldots, B_N(t)]^T $$\n该向量的大小为 $(N-1) + (N+1) = 2N$。\n\n常微分方程组 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$ 由以下各式给出：\n对于内部点 $i = 1, \\ldots, N-1$ 上的可移动浓度 $C_i(t)$：\n$$ \\frac{dC_i}{dt} = D \\frac{C_{i-1}(t) - 2C_i(t) + C_{i+1}(t)}{(\\Delta x)^2} - k_{\\mathrm{on}} C_i(t) (S_{\\mathrm{tot}} - B_i(t)) + k_{\\mathrm{off}} B_i(t) $$\n此处，$C_0(t)$ 被常数边界值 $C_0$ 替代，$C_N(t)$ 被 $0$ 替代。\n\n对于所有点 $i = 0, \\ldots, N$ 上的结合浓度 $B_i(t)$：\n$$ \\frac{dB_i}{dt} = k_{\\mathrm{on}} C_i(t) (S_{\\mathrm{tot}} - B_i(t)) - k_{\\mathrm{off}} B_i(t) $$\n注意，对于 $B_0(t)$，使用值 $C_0(t) = C_0$；对于 $B_N(t)$，使用值 $C_N(t) = 0$。\n\n初始条件向量 $\\mathbf{y}(0)$ 是一个大小为 $2N$ 的零向量，对应于相应索引的 $C_i(0)=0$ 和 $B_i(0)=0$。这个常微分方程初值问题使用适合刚性系统的数值积分器（如 Radau 方法）求解。\n\n目标是找到接触时间 $T_{\\mathrm{access}}$，定义为内边界通量 $J(L,t)$ 达到无结合情况下理论稳态通量 $J_{\\mathrm{ss,0}} = D C_0 / L$ 的 $f=1/2$ 分数的最早时间 $t$。\n通量由 Fick 第一定律给出：$J(L,t) = -D \\frac{\\partial C}{\\partial x}\\big|_{x=L}$。为了获得更高精度，边界 $x_N=L$ 处的空间导数使用二阶后向差分公式进行近似：\n$$ \\frac{\\partial C}{\\partial x}\\bigg|_{x=L} \\approx \\frac{3C_N(t) - 4C_{N-1}(t) + C_{N-2}(t)}{2 \\Delta x} $$\n由于边界条件规定 $C_N(t)=0$，上式可简化为：\n$$ J(L,t) \\approx -D \\frac{-4C_{N-1}(t) + C_{N-2}(t)}{2 \\Delta x} = D \\frac{4C_{N-1}(t) - C_{N-2}(t)}{2 \\Delta x} $$\n因此，目标条件是 $J(L,t) \\ge \\frac{1}{2}\\frac{D C_0}{L}$。这个条件在 ODE 求解器中作为事件函数实现，当该条件首次满足时，它会停止积分并报告时间 $T_{\\mathrm{access}}$。\n\n对测试集中指定的每个 $S_{\\mathrm{tot}}$ 值（$\\{0, 1, 5, 20\\}\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$）重复此过程。多粘菌素与 LPS 的结合起到了汇的作用，捕获分子并阻碍其扩散。因此，预计 $T_{\\mathrm{access}}$ 会随着 $S_{\\mathrm{tot}}$ 的增加而增加。$S_{\\mathrm{tot}}=0$ 的情况对应于纯扩散，并作为基线。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves a reaction-diffusion model for polymyxin penetration across the\n    Gram-negative outer membrane.\n    \"\"\"\n    # Define physical and model parameters in SI units.\n    L = 8.0e-9    # Thickness of the outer membrane (m)\n    D = 1.0e-12   # Diffusion coefficient of polymyxin (m^2/s)\n    C0 = 1.0e-2   # Bathing concentration of polymyxin (mol/m^3)\n    k_on = 1.0e3  # Binding on-rate constant (m^3/mol/s)\n    k_off = 1.0   # Binding off-rate constant (1/s)\n    f = 0.5       # Target flux fraction\n\n    # Define the test suite for total LPS site density (mol/m^3).\n    test_cases = [0.0, 1.0, 5.0, 20.0]\n\n    # Discretization parameters.\n    N = 100       # Number of spatial grid segments.\n    dx = L / N    # Spatial step size (m).\n\n    # Calculate the target flux.\n    J_ss0 = D * C0 / L\n    J_target = f * J_ss0\n\n    results = []\n\n    # Iterate through each test case for S_tot.\n    for S_tot in test_cases:\n        # Define the system of ODEs for the method of lines.\n        # The state vector y is [C_1, ..., C_{N-1}, B_0, ..., B_N].\n        def odefunc(t, y):\n            # Unpack the state vector y.\n            C_interior = y[:N - 1]\n            B_all = y[N - 1:]\n\n            # Reconstruct the full concentration vector C with boundary conditions.\n            C_all = np.zeros(N + 1)\n            C_all[0] = C0\n            C_all[1:N] = C_interior\n            # C_all[N] is 0 by default.\n\n            # Initialize the derivative vector dy/dt.\n            dydt = np.zeros_like(y)\n            dC_interior = dydt[:N - 1]\n            dB_all = dydt[N - 1:]\n\n            # Calculate the derivatives for the bound concentration B.\n            # dB/dt = k_on * C * (S_tot - B) - k_off * B\n            dB_all[:] = k_on * C_all * (S_tot - B_all) - k_off * B_all\n\n            # Calculate the derivatives for the mobile concentration C at interior points.\n            # dC/dt = D * d^2C/dx^2 + R(C,B)\n            # where R = -dB/dt.\n            \n            # Laplacian term using central differences.\n            laplacian_C = (C_all[0:N - 1] - 2 * C_all[1:N] + C_all[2:N + 1]) / dx**2\n            diffusion_term = D * laplacian_C\n\n            # Reaction term for interior points (i=1 to N-1).\n            reaction_term_C = -dB_all[1:N]\n\n            dC_interior[:] = diffusion_term + reaction_term_C\n\n            return dydt\n\n        # Define the event function to detect when the flux reaches the target.\n        def flux_event(t, y):\n            # J(L,t) - J_target = 0\n            # Use a second-order backward difference for the flux calculation.\n            # J = -D * (3*C_N - 4*C_{N-1} + C_{N-2}) / (2*dx)\n            # C_N = 0, so J = D * (4*C_{N-1} - C_{N-2}) / (2*dx)\n            # State vector y contains C_1, ..., C_{N-1}.\n            # C_{N-1} is y[N-2], C_{N-2} is y[N-3].\n            C_N_minus_1 = y[N - 2]\n            C_N_minus_2 = y[N - 3]\n            \n            J_L = D * (4 * C_N_minus_1 - C_N_minus_2) / (2 * dx)\n            \n            return J_L - J_target\n\n        flux_event.terminal = True  # Stop integration when the event occurs.\n        flux_event.direction = 1    # Trigger on zero-crossing from negative to positive.\n\n        # Set initial conditions (all concentrations are initially zero).\n        # Size is (N-1) for C_interior + (N+1) for B_all = 2N.\n        y0 = np.zeros(2 * N)\n\n        # Set a sufficiently long integration time span.\n        # Based on characteristic times, times can extend to seconds for high S_tot.\n        t_span = (0, 10.0)\n\n        # Solve the initial value problem. Use a stiff solver like 'Radau'.\n        sol = solve_ivp(\n            odefunc,\n            t_span,\n            y0,\n            method='Radau',\n            events=flux_event,\n            dense_output=True\n        )\n\n        # Extract the access time from the solver results.\n        if sol.status == 1 and len(sol.t_events[0]) > 0:\n            T_access = sol.t_events[0][0]\n            results.append(T_access)\n        else:\n            # Append NaN if the event was not found in the time span.\n            results.append(np.nan)\n\n    # Format results to six decimal places and print in the specified format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2504924"}]}