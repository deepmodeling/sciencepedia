{"hands_on_practices": [{"introduction": "本练习旨在建立消毒动力学的基石。它将理论上的一阶衰减模型（奇克定律）与经验性确定“十进制减少时间”（即 $D$ 值）联系起来，$D$ 值是比较消毒剂效力及设计处理流程的关键参数。通过对假设的实验数据进行线性回归[@problem_id:2482744]，您将练习微生物数据分析中的一项基本技能。", "problem": "在固定的温度和pH条件下，使用恒定浓度的化学消毒剂对一批细菌种群进行灭活。设$N(t)$表示在时间$t$（单位为分钟）时活菌的数量，以菌落形成单位（CFU）/毫升（mL）计量。假设在消毒剂浓度$C$恒定的情况下，灭活动力学遵循Chick–Watson定律，即存在一个级数$n$和速率常数$k$，使得在固定的$C$下，$-\\frac{dN}{dt}$与$N$成正比，并且环境保持良好混合，以致传质限制可以忽略不计。请从这些假设和基本定义出发，精确定义在这些固定条件下化学灭活的十进制缩减时间$D$，并推导由该模型得出的$\\log_{10} N(t)$对$t$的函数形式。利用此结果，将$D$表示为$\\log_{10} N$对$t$的线性回归斜率的函数。\n\n然后，使用以下在不同时间$t$（单位为分钟）测得的活菌计数的以10为底的对数$\\log_{10} N$（单位为$\\log_{10}(\\text{CFU}/\\text{mL})$）的数据集，对$\\log_{10} N$与$t$进行普通最小二乘法线性回归，并根据回归结果估算$D$：\n\n- $(t, \\log_{10} N)$数据对：\n  - $(0, 7.30)$\n  - $(1, 6.88)$\n  - $(2, 6.46)$\n  - $(3, 6.04)$\n  - $(4, 5.62)$\n  - $(5, 5.20)$\n\n报告$D$的最终数值，单位为分钟。将答案四舍五入至四位有效数字。最终时间以分钟表示。", "solution": "该问题是有效的，因为它科学地基于微生物灭活动力学的既定原理，问题阐述清晰，提供了足够的信息以获得唯一解，并以客观、正式的语言表述。我们可以开始求解。\n\n问题陈述，在消毒剂浓度、温度和pH恒定的条件下，灭活速率$-\\frac{dN}{dt}$与活菌数量$N$成正比。这是一阶灭活动力学的定义，通常称为Chick定律。在数学上，这表示为一个微分方程：\n$$ -\\frac{dN}{dt} = k' N $$\n其中$k'$是一阶灭活速率常数。常数$k'$包含了消毒剂浓度的影响，在本实验中该浓度是固定的。该方程可以通过分离变量法求解：\n$$ \\frac{dN}{N} = -k' dt $$\n我们将此方程从初始时间$t=0$（此时种群数量为$N(0) = N_0$）积分到一般时间$t$（此时种群数量为$N(t)$）。\n$$ \\int_{N_0}^{N(t)} \\frac{1}{N} dN = \\int_{0}^{t} -k' d\\tau $$\n积分得出：\n$$ \\ln(N(t)) - \\ln(N_0) = -k't $$\n$$ \\ln\\left(\\frac{N(t)}{N_0}\\right) = -k't $$\n对两边取指数，得到活菌数量的指数衰减模型：\n$$ N(t) = N_0 \\exp(-k't) $$\n为了推导$\\log_{10} N(t)$对$t$的函数形式，我们对上式两边取以10为底的对数：\n$$ \\log_{10}(N(t)) = \\log_{10}(N_0 \\exp(-k't)) $$\n利用对数性质 $\\log(ab) = \\log(a) + \\log(b)$，我们得到：\n$$ \\log_{10}(N(t)) = \\log_{10}(N_0) + \\log_{10}(\\exp(-k't)) $$\n利用对数的换底公式 $\\log_{b}(x^y) = y \\log_{b}(x)$ 以及 $\\log_{10}(e) = \\frac{\\ln(e)}{\\ln(10)} = \\frac{1}{\\ln(10)}$，我们可以写出：\n$$ \\log_{10}(\\exp(-k't)) = -k't \\log_{10}(e) = -k't \\frac{1}{\\ln(10)} = -\\frac{k'}{\\ln(10)} t $$\n将此代回$\\log_{10}(N(t))$的方程，得到所需的函数形式：\n$$ \\log_{10}(N(t)) = \\log_{10}(N_0) - \\left(\\frac{k'}{\\ln(10)}\\right) t $$\n该方程是线性形式$y = c + mx$，其中$y = \\log_{10}(N(t))$，自变量是$x = t$，y轴截距是$c = \\log_{10}(N_0)$，斜率是$m = -\\frac{k'}{\\ln(10)}$。因此，活菌浓度的以10为底的对数对时间的图像预计是一条斜率为负的直线。\n\n十进制缩减时间$D$定义为使活菌种群数量减少10倍，或在以10为底的对数标度上减少一个对数单位所需的时间。这意味着在$t=D$时，种群数量为$N(D) = \\frac{N_0}{10}$。我们可以用这个定义来表示$D$与模型参数的关系。将$t=D$代入$\\log_{10}(N(t))$的线性方程中：\n$$ \\log_{10}(N(D)) = \\log_{10}(N_0) - \\left(\\frac{k'}{\\ln(10)}\\right) D $$\n根据定义，$\\log_{10}(N(D)) = \\log_{10}(\\frac{N_0}{10}) = \\log_{10}(N_0) - \\log_{10}(10) = \\log_{10}(N_0) - 1$。\n$$ \\log_{10}(N_0) - 1 = \\log_{10}(N_0) - \\left(\\frac{k'}{\\ln(10)}\\right) D $$\n$$ -1 = -\\left(\\frac{k'}{\\ln(10)}\\right) D $$\n求解$D$得到：\n$$ D = \\frac{\\ln(10)}{k'} $$\n现在我们将$D$用$\\log_{10} N$对$t$的线性回归斜率$m$来表示。我们有两个关系式：$m = -\\frac{k'}{\\ln(10)}$ 和 $D = \\frac{\\ln(10)}{k'}$。从斜率的表达式中，我们可以写出$k' = -m \\ln(10)$。将此代入$D$的表达式中：\n$$ D = \\frac{\\ln(10)}{-m \\ln(10)} = -\\frac{1}{m} $$\n因此，十进制缩减时间是通过绘制$\\log_{10} N$对$t$的图像所得到的直线的斜率的负倒数。\n\n我们现在对所提供的数据集进行普通最小二乘法线性回归，以估计斜率$m$。设数据点为$(t_i, y_i)$，其中$y_i = \\log_{10} N(t_i)$。数据点数量为$n_p = 6$。斜率$m$由以下公式给出：\n$$ m = \\frac{n_p \\sum(t_i y_i) - (\\sum t_i)(\\sum y_i)}{n_p \\sum(t_i^2) - (\\sum t_i)^2} $$\n数据如下：$(0, 7.30)$, $(1, 6.88)$, $(2, 6.46)$, $(3, 6.04)$, $(4, 5.62)$, $(5, 5.20)$。\n我们计算所需的总和：\n$$ \\sum_{i=1}^{6} t_i = 0 + 1 + 2 + 3 + 4 + 5 = 15 $$\n$$ \\sum_{i=1}^{6} y_i = 7.30 + 6.88 + 6.46 + 6.04 + 5.62 + 5.20 = 37.50 $$\n$$ \\sum_{i=1}^{6} t_i^2 = 0^2 + 1^2 + 2^2 + 3^2 + 4^2 + 5^2 = 0 + 1 + 4 + 9 + 16 + 25 = 55 $$\n$$ \\sum_{i=1}^{6} t_i y_i = (0)(7.30) + (1)(6.88) + (2)(6.46) + (3)(6.04) + (4)(5.62) + (5)(5.20) $$\n$$ \\sum_{i=1}^{6} t_i y_i = 0 + 6.88 + 12.92 + 18.12 + 22.48 + 26.00 = 86.40 $$\n将这些值代入斜率$m$的公式中：\n$$ m = \\frac{6 \\times 86.40 - 15 \\times 37.50}{6 \\times 55 - (15)^2} = \\frac{518.4 - 562.5}{330 - 225} = \\frac{-44.1}{105} = -0.42 $$\n回归线的斜率为$m = -0.42$。由于$\\log_{10} N$是无量纲的，斜率的单位是$\\text{min}^{-1}$。\n最后，我们利用$D$与斜率的关系计算十进制缩减时间$D$：\n$$ D = -\\frac{1}{m} = -\\frac{1}{-0.42} = \\frac{1}{0.42} \\approx 2.38095238... $$\n问题要求答案四舍五入至四位有效数字。\n$$ D \\approx 2.381 $$\n时间单位是分钟，与问题中变量$t$的规定一致。", "answer": "$$ \\boxed{2.381} $$", "id": "2482744"}, {"introduction": "在理想情况的基础上，本练习引入了一个关键的现实世界复杂性：消毒剂本身在接触时间内的衰减。您将通过对浓度曲线进行积分来推导“有效”浓度-时间（$CT$）乘积的概念，并阐明为何简化的模型可能产生危险的误导。此练习将引导您从简单的代数模型过渡到设计现实系统所需更强大、更精确的微积分方法[@problem_id:2482709]。", "problem": "一个市政饮用水设施使用游离氯在接触池中灭活微生物。观察到，由于氯需求和池壁反应，剩余消毒剂浓度会发生衰减，并且该过程可以通过一级衰减定律 $C(t)=C_{0}\\exp(-\\lambda t)$ 很好地描述，其中 $C_{0}$ 是进入池时的初始浓度，$\\lambda>0$ 是衰减速率常数。历史上，该设施通过将单次测量的剩余浓度与接触时间相乘来应用浓度-时间 (CT) 法则，即将浓度在该时间段内视为恒定。\n\n假设相对于微生物和消毒剂浓度均为一级灭活（动力学）（Chick-Watson 形式），并考虑上述随时间变化的浓度 $C(t)$。从微生物灭活的基本速率定律出发，不使用任何经验性简化公式：\n\n- 推导经过时间 $t$ 后实现的以 10 为底的对数灭活的表达式，用 $C(t)$ 的时间积分表示。\n- 从第一性原理出发，利用此表达式解释为什么当 $\\lambda>0$ 时，用常数替代值 $C_{0}t$ 来代替时间积分会低估所需的接触时间。\n- 定义一个有效浓度-时间 $CT_{\\mathrm{eff}}(t)$，该值能精确地体现随时间变化的浓度在灭活动力学中的作用，并推导当 $C(t)=C_{0}\\exp(-\\lambda t)$ 时的 $CT_{\\mathrm{eff}}(t)$。\n\n仅报告 $CT_{\\mathrm{eff}}(t)$ 作为 $C_{0}$、$\\lambda$ 和 $t$ 的函数的最终封闭形式解析表达式。以毫克-分钟/升为单位表示有效浓度-时间。不要代入数值。最终的方框答案中不要包含单位。", "solution": "解析问题陈述以进行验证。\n\n首先，逐字提取所有给定信息。\n- 消毒剂浓度衰减定律：$C(t)=C_{0}\\exp(-\\lambda t)$。\n- $C_{0}$：进入池时的初始浓度。\n- $\\lambda > 0$：一级衰减速率常数。\n- 历史做法：使用恒定的替代浓度乘以接触时间。\n- 灭活动力学：相对于微生物和消毒剂浓度均为一级（Chick-Watson 形式）。\n- 任务：从第一性原理出发，推导以 10 为底的对数灭活表达式，解释为什么使用恒定浓度替代值 $C_{0}$ 会导致对所需接触时间的低估，并推导有效浓度-时间 $CT_{\\mathrm{eff}}(t)$。\n- 最终输出要求：$CT_{\\mathrm{eff}}(t)$ 的封闭形式解析表达式。\n\n接下来，根据形式化标准验证问题。\n- **科学依据**：该问题基于化学动力学和环境工程的基本原理。用于消毒的 Chick-Watson 模型和用于消毒剂余量的一级衰减模型是水处理过程中标准且成熟的模型。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了推导所要求表达式所必需的速率定律和函数形式。任务定义明确，且存在唯一的数学解。\n- **客观性**：该问题以精确、客观和定量的术语陈述。没有主观或含糊的陈述。\n- **完整性**：该问题是自洽的，提供了从第一性原理进行推导所需的所有必要信息和函数关系。\n\n结论是该问题是**有效的**。这是一个反应工程中的标准练习，需要从基本速率定律进行严格推导。我们现在开始解题。\n\n根据 Chick-Watson 模型，微生物灭活的基本速率定律是关于微生物数量 $N$ 和消毒剂浓度 $C(t)$ 的一级反应，由以下微分方程给出：\n$$\n\\frac{dN(t)}{dt} = -k' C(t) N(t)\n$$\n其中 $k'$ 是比灭活速率常数。负号表示活微生物种群的减少。\n\n为了求出从 $t=0$ 到最终时间 $t$ 的时间间隔内的灭活效果，我们必须解这个微分方程。我们可以分离变量：\n$$\n\\frac{dN(t)}{N(t)} = -k' C(t) dt\n$$\n我们对等式两边进行积分。微生物数量从 $t=0$ 时的初始值 $N_{0}$ 变化到时间 $t$ 时的 $N(t)$。积分的时间变量用 $\\tau$ 表示，以区别于积分上限 $t$。\n$$\n\\int_{N_{0}}^{N(t)} \\frac{1}{N} dN = -k' \\int_{0}^{t} C(\\tau) d\\tau\n$$\n计算左侧的积分得到自然对数：\n$$\n[\\ln(N)]_{N_{0}}^{N(t)} = \\ln(N(t)) - \\ln(N_{0}) = \\ln\\left(\\frac{N(t)}{N_{0}}\\right)\n$$\n因此，关系式为：\n$$\n\\ln\\left(\\frac{N(t)}{N_{0}}\\right) = -k' \\int_{0}^{t} C(\\tau) d\\tau\n$$\n问题要求一个**以 10 为底的对数灭活**的表达式。对数灭活定义为表示减少程度的正值，即 $\\log_{10}\\left(\\frac{N_{0}}{N(t)}\\right)$。我们可以将其写为 $-\\log_{10}\\left(\\frac{N(t)}{N_{0}}\\right)$。使用对数的换底公式 $\\log_{10}(x) = \\frac{\\ln(x)}{\\ln(10)}$，我们得到：\n$$\n\\log_{10}\\left(\\frac{N(t)}{N_{0}}\\right) = \\frac{\\ln\\left(\\frac{N(t)}{N_{0}}\\right)}{\\ln(10)} = -\\frac{k'}{\\ln(10)} \\int_{0}^{t} C(\\tau) d\\tau\n$$\n定义一个新的速率常数 $k = \\frac{k'}{\\ln(10)}$，这是用于以 10 为底的对数灭活的 Chick-Watson 常数，并为正的对数减少量进行整理，我们得到第一个要求的表达式：\n$$\n\\log_{10}\\left(\\frac{N_{0}}{N(t)}\\right) = k \\int_{0}^{t} C(\\tau) d\\tau\n$$\n这个方程表明，实现的对数灭活与消毒剂浓度的时间积分成正比。\n\n现在，我们来解决第二个任务：解释为什么使用恒定替代值 $C_{0}$ 作为浓度会低估所需的接触时间。简化方法用乘积 $C_{0}t$ 来近似积分项 $\\int_{0}^{t} C(\\tau) d\\tau$。给定的浓度曲线是 $C(\\tau) = C_{0}\\exp(-\\lambda \\tau)$，且 $\\lambda > 0$。对于任何时间 $\\tau > 0$，指数项 $\\exp(-\\lambda \\tau)$ 严格小于 1。因此，对于所有 $\\tau > 0$，$C(\\tau) < C_{0}$。\n\n让我们比较真实的积分浓度与其简化近似值：\n$$\n\\text{真实积分} = \\int_{0}^{t} C_{0}\\exp(-\\lambda \\tau) d\\tau\n$$\n$$\n\\text{近似值} = \\int_{0}^{t} C_{0} d\\tau = C_{0}t\n$$\n因为对于所有 $\\tau \\in (0, t]$，$C_{0}\\exp(-\\lambda \\tau) < C_{0}$，所以衰减函数的积分值必须严格小于常数函数的积分值：\n$$\n\\int_{0}^{t} C_{0}\\exp(-\\lambda \\tau) d\\tau < C_{0}t\n$$\n设目标对数灭活为 $L_{\\text{req}}$。正确的接触时间 $t_{\\text{actual}}$ 必须满足：\n$$\nL_{\\text{req}} = k \\int_{0}^{t_{\\text{actual}}} C_{0}\\exp(-\\lambda \\tau) d\\tau\n$$\n简化模型会基于恒定浓度 $C_0$ 的假设计算出一个接触时间 $t_{\\text{simple}}$：\n$$\nL_{\\text{req}} = k (C_{0}t_{\\text{simple}})\n$$\n将这两个 $L_{\\text{req}}$ 的表达式相等，得到：\n$$\nk \\int_{0}^{t_{\\text{actual}}} C_{0}\\exp(-\\lambda \\tau) d\\tau = k (C_{0}t_{\\text{simple}})\n$$\n$$\n\\int_{0}^{t_{\\text{actual}}} \\exp(-\\lambda \\tau) d\\tau = t_{\\text{simple}}\n$$\n如前所述，对于任何正时间，衰减指数的积分值小于时间本身。为了达到所需的等式，较小函数的积分上限必须更大。也就是说，$t_{\\text{actual}}$ 必须大于 $t_{\\text{simple}}$。因此，简化计算低估了达到目标灭活 $L_{\\text{req}}$ 所需的接触时间。使用 $t_{\\text{simple}}$ 会导致消毒不充分。\n\n最后，我们解决第三个任务：定义并推导有效浓度-时间 $CT_{\\mathrm{eff}}(t)$。从基本灭活方程可知，决定反应程度的项是浓度的时间积分。我们将此积分定义为有效浓度-时间乘积：\n$$\nCT_{\\mathrm{eff}}(t) \\equiv \\int_{0}^{t} C(\\tau) d\\tau\n$$\n这个量乘以灭活速率常数 $k$ 即可得到真实的对数灭活值。我们现在为给定的浓度曲线 $C(t) = C_{0}\\exp(-\\lambda t)$ 计算这个积分。\n$$\nCT_{\\mathrm{eff}}(t) = \\int_{0}^{t} C_{0}\\exp(-\\lambda \\tau) d\\tau\n$$\n常数 $C_{0}$ 可以从积分中提出：\n$$\nCT_{\\mathrm{eff}}(t) = C_{0} \\int_{0}^{t} \\exp(-\\lambda \\tau) d\\tau\n$$\n指数函数的积分是直接的：\n$$\n\\int \\exp(-\\lambda \\tau) d\\tau = -\\frac{1}{\\lambda} \\exp(-\\lambda \\tau)\n$$\n计算从 $0$ 到 $t$ 的定积分：\n$$\nCT_{\\mathrm{eff}}(t) = C_{0} \\left[ -\\frac{1}{\\lambda} \\exp(-\\lambda \\tau) \\right]_{0}^{t}\n$$\n$$\nCT_{\\mathrm{eff}}(t) = C_{0} \\left( \\left(-\\frac{1}{\\lambda} \\exp(-\\lambda t)\\right) - \\left(-\\frac{1}{\\lambda} \\exp(-\\lambda \\cdot 0)\\right) \\right)\n$$\n因为 $\\exp(0) = 1$：\n$$\nCT_{\\mathrm{eff}}(t) = C_{0} \\left( -\\frac{1}{\\lambda} \\exp(-\\lambda t) + \\frac{1}{\\lambda} \\right)\n$$\n提出因子 $\\frac{1}{\\lambda}$，得到有效浓度-时间的最终封闭形式表达式：\n$$\nCT_{\\mathrm{eff}}(t) = \\frac{C_{0}}{\\lambda} \\left(1 - \\exp(-\\lambda t)\\right)\n$$\n这就是所要求的解析结果。", "answer": "$$\n\\boxed{\\frac{C_{0}}{\\lambda} \\left(1 - \\exp(-\\lambda t)\\right)}\n$$", "id": "2482709"}, {"introduction": "最后的这个练习将动力学原理与现代定量风险评估相结合。您将设计一个计算模型，在考虑初始微生物载量不确定性的情况下，选择最优的消毒策略。通过为生物负载引入对数正态分布并设定基于置信度的性能目标[@problem_id:2482746]，本练习展示了如何为保障公共健康与安全构建稳健、基于风险的决策工具。", "problem": "设计并实现一个程序，该程序通过整合基于原则的风险约束与一级消毒动力学，在初始污染不确定的情况下选择化学微生物控制策略。初始生物负载以菌落形成单位（CFU）计量，被建模为自然对数尺度上的对数正态随机变量 $N_0 \\sim \\mathrm{LogNormal}(\\mu,\\sigma^2)$，即 $\\ln N_0 \\sim \\mathcal{N}(\\mu,\\sigma^2)$。每种候选化学策略 $j$ 由浓度 $C_j$（单位 $\\mathrm{mg/L}$）、暴露时间 $t_j$（单位 $\\mathrm{min}$）、灭活速率常数 $k_j$（单位与动力学级数一致）和浓度级数 $n_j \\ge 0$ 表征。假设消毒过程遵循具有浓度依赖性的 Chick–Watson 一级消毒动力学，由微分方程 $\\frac{dN}{dt} = -k C^n N$ 给出，其积分为 $N(t) = N_0 \\exp\\!\\left(-k C^n t\\right)$。策略 $j$ 实现的以10为底的对数减少值为 $L_j = \\log_{10}\\!\\left(\\frac{N_0}{N(t_j)}\\right)$，其值通过动力学关系取决于 $C_j$、$t_j$、$k_j$ 和 $n_j$。定义成本替代指标 $CT_j = C_j \\, t_j$（单位为 $\\mathrm{mg \\cdot min / L}$）。选择目标是挑选出具有最小 $CT_j$ 的可行策略，若成本相同，则选择索引最小的策略。\n\n风险要求：通过限制 $N_0$ 的 $0.95$-分位数（记为 $Q_{0.95}(N_0)$）来对未知的初始生物负载施加 $0.95$ 的置信水平。要求以下两项同时成立：\n- 最低对数减少目标 $L_j \\ge 6$，以及\n- 基于分位数的存活菌限值 $Q_{0.95}(N_0) \\, 10^{-L_j} \\le 1$ CFU，\n这样即使在初始生物负载分布的 $0.95$ 分位数水平下，预期的存活菌数量也不超过 $1$ CFU。等效地，一个策略是可行的，当且仅当 $L_j \\ge \\max\\!\\left(6,\\log_{10} Q_{0.95}(N_0)\\right)$。其中，$Q_{0.95}(N_0) = \\exp\\!\\left(\\mu + \\sigma \\, z_{0.95}\\right)$，$z_{0.95}$ 是标准正态分布的 $0.95$ 分位数。\n\n你的程序必须实现以下测试套件。每个测试用例提供 $(\\mu,\\sigma)$ 和一个候选策略列表，每个策略以元组 $\\left(C_j,t_j,k_j,n_j\\right)$ 的形式给出。对于每个测试用例，输出满足可行性条件中 $CT_j$ 最小的策略的索引（从零开始）；如果没有策略是可行的，则输出 $-1$。\n\n测试套件：\n- 测试用例 $1$：\n  - $\\mu = 11.512925464970229$, $\\sigma = 1.0$。\n  - 策略：\n    - $j=0$: $(C,t,k,n) = (50.0, 20.0, 0.015, 1.0)$\n    - $j=1$: $(C,t,k,n) = (100.0, 10.0, 0.012, 1.0)$\n    - $j=2$: $(C,t,k,n) = (80.0, 15.0, 0.014, 1.0)$\n- 测试用例 $2$：\n  - $\\mu = 13.815510557964274$, $\\sigma = 1.0$。\n  - 策略：\n    - $j=0$: $(C,t,k,n) = (50.0, 20.0, 0.015, 1.0)$\n    - $j=1$: $(C,t,k,n) = (100.0, 10.0, 0.012, 1.0)$\n    - $j=2$: $(C,t,k,n) = (80.0, 15.0, 0.014, 1.0)$\n- 测试用例 $3$：\n  - $\\mu = 16.11809565095832$, $\\sigma = 1.5$。\n  - 策略：\n    - $j=0$: $(C,t,k,n) = (50.0, 20.0, 0.015, 1.0)$\n    - $j=1$: $(C,t,k,n) = (100.0, 10.0, 0.012, 1.0)$\n    - $j=2$: $(C,t,k,n) = (80.0, 15.0, 0.014, 1.0)$\n- 测试用例 $4$：\n  - $\\mu = 6.907755278982137$, $\\sigma = 0.2$。\n  - 策略：\n    - $j=0$: $(C,t,k,n) = (100.0, 10.0, 0.0005, 2.0)$\n    - $j=1$: $(C,t,k,n) = (20.0, 30.0, 0.0005, 2.0)$\n    - $j=2$: $(C,t,k,n) = (40.0, 30.0, 0.0005, 2.0)$\n\n实现要求：\n- 使用 $z_{0.95} = \\Phi^{-1}(0.95)$（其中 $\\Phi^{-1}$ 是标准正态分布的逆累积分布函数）来计算 $Q_{0.95}(N_0)$，即 $Q_{0.95}(N_0) = \\exp\\!\\left(\\mu + \\sigma z_{0.95}\\right)$。请一致地对 $\\exp(\\cdot)$ 使用自然对数，对 $\\log_{10}(\\cdot)$ 使用以10为底的对数。\n- 根据积分后的动力学模型，计算策略 $j$ 实现的对数减少值 $L_j = \\dfrac{k_j \\, C_j^{n_j} \\, t_j}{\\ln(10)}$。\n- 选择具有最小 $CT_j = C_j t_j$ 的可行策略；如果没有可行策略，则对该测试用例返回 $-1$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$\\left[\\text{结果}_1,\\text{结果}_2,\\text{结果}_3,\\text{结果}_4\\right]$）。每个测试用例的输出必须是整数：所选策略的索引，如果无可行策略则为 $-1$。不应打印任何额外文本。", "solution": "所提出的问题经过了严格的验证，被认为是科学合理的、定义明确且客观的。所有参数、模型和约束都得到了清晰的定义，并与微生物学和定量风险评估中已建立的原则相一致。因此，该问题被认定为有效，下面提供其形式化解决方案。\n\n目标是从一组给定的候选策略中选择一个最优的化学消毒策略。最优性准则是最小化成本替代指标 $CT_j = C_j t_j$，同时需满足一个稳健的可行性约束。该约束旨在确保尽管初始微生物污染水平 $N_0$ 存在不确定性，消毒成功的概率仍然很高。\n\n初始生物负载 $N_0$ 被建模为对数正态随机变量，其自然对数 $\\ln N_0$ 服从正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$。为了管理与此不确定性相关的风险，我们不针对 $N_0$ 的平均值进行设计，而是针对一个更高、更保守的值：$0.95$-分位数 $Q_{0.95}(N_0)$。此分位数代表 $N_0$ 不太可能超过的一个值（置信度为 $95\\%$）。其计算公式为：\n$$Q_{0.95}(N_0) = \\exp\\!\\left(\\mu + \\sigma \\, z_{0.95}\\right)$$\n其中 $z_{0.95}$ 是标准正态分布的 $0.95$-分位数，即满足 $\\Phi(z_{0.95}) = 0.95$ 的值，这里 $\\Phi$ 是 $\\mathcal{N}(0,1)$ 的累积分布函数（CDF）。数值上，$z_{0.95} \\approx 1.64485$。\n\n每种策略 $j$ 的消毒效果通过以10为底的对数减少值 $L_j$ 来量化。所提供的动力学模型是 Chick-Watson 定律的广义形式，$\\frac{dN}{dt} = -k C^n N$。对于在暴露时间 $t_j$ 内浓度恒为 $C_j$ 的情况，该微分方程积分为 $N(t_j) = N_0 \\exp(-k_j C_j^{n_j} t_j)$。因此，对数减少值为：\n$$L_j = \\log_{10}\\!\\left(\\frac{N_0}{N(t_j)}\\right) = \\log_{10}\\!\\left(\\frac{N_0}{N_0 \\exp(-k_j C_j^{n_j} t_j)}\\right) = \\log_{10}(\\exp(k_j C_j^{n_j} t_j))$$\n使用对数换底法则 $\\log_b(a) = \\frac{\\ln(a)}{\\ln(b)}$，我们得到计算已实现对数减少值的公式：\n$$L_j = \\frac{k_j C_j^{n_j} t_j}{\\ln(10)}$$\n\n一个策略 $j$ 被认为是可行的，如果它同时满足以下两个条件：\n$1.$ 最低标准对数减少值：$L_j \\ge 6$。\n$2.$ 基于风险的存活菌限值：即使从高初始生物负载 $Q_{0.95}(N_0)$ 开始，存活微生物的数量也必须小于或等于 $1$ CFU。这表示为 $Q_{0.95}(N_0) \\cdot 10^{-L_j} \\le 1$。\n\n第二个条件可以通过代数方法重新整理：\n$$10^{-L_j} \\le \\frac{1}{Q_{0.95}(N_0)} \\implies 10^{L_j} \\ge Q_{0.95}(N_0)$$\n对两边取以10为底的对数，得到：\n$$L_j \\ge \\log_{10}(Q_{0.95}(N_0))$$\n为使一个策略可行，它必须同时满足两个对数减少要求。因此，实现的对数减少值 $L_j$ 必须大于或等于两个阈值中的最大值。我们定义所需的最小对数减少值 $L_{min}$ 为：\n$$L_{min} = \\max\\!\\left(6, \\log_{10}(Q_{0.95}(N_0))\\right)$$\n一个策略 $j$ 是可行的，当且仅当 $L_j \\ge L_{min}$。\n\n每个测试用例的完整算法流程如下：\n$1.$ 给定初始生物负载分布的参数 $(\\mu, \\sigma)$，首先计算所需的最小对数减少值 $L_{min}$。\n    a. 确定 $z_{0.95}$ 的值。\n    b. 计算 $Q_{0.95}(N_0) = \\exp(\\mu + \\sigma z_{0.95})$。\n    c. 计算 $L_{min} = \\max(6, \\log_{10}(Q_{0.95}(N_0)))$。\n$2.$ 初始化一个空集合，用于存储可行策略及其相关成本。\n$3.$ 对于每个具有参数 $(C_j, t_j, k_j, n_j)$ 的候选策略 $j$：\n    a. 计算实现的对数减少值 $L_j = \\frac{k_j C_j^{n_j} t_j}{\\ln(10)}$。\n    b. 将 $L_j$ 与 $L_{min}$ 进行比较。如果 $L_j \\ge L_{min}$，则该策略是可行的。\n    c. 如果可行，计算成本替代指标 $CT_j = C_j t_j$ 并存储序对 $(CT_j, j)$。\n$4.$ 在评估完所有候选策略后，分析可行策略的集合。\n    a. 如果该集合为空，则没有策略满足要求。结果为 $-1$。\n    b. 如果该集合非空，选择对应于最小 $CT_j$ 的策略。如果多个策略具有相同的最小成本，则通过选择索引 $j$ 最小的策略来解决平局。\n$5.$ 该测试用例的最终输出是所选最优策略的索引 $j$。\n此程序系统地识别出遵循严格的、基于风险的消毒标准的最具成本效益的策略。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Selects a chemical microbial control strategy by minimizing a cost surrogate\n    subject to a risk-based feasibility constraint derived from first-order\n    disinfection kinetics.\n    \"\"\"\n\n    # z-score for 95% confidence level\n    # z_0.95 = Phi^-1(0.95)\n    z_095 = norm.ppf(0.95)\n\n    # Test cases: each is a tuple of (mu, sigma, list_of_strategies)\n    # Each strategy is a tuple of (C, t, k, n)\n    test_cases = [\n        (\n            11.512925464970229, 1.0,\n            [\n                (50.0, 20.0, 0.015, 1.0),\n                (100.0, 10.0, 0.012, 1.0),\n                (80.0, 15.0, 0.014, 1.0)\n            ]\n        ),\n        (\n            13.815510557964274, 1.0,\n            [\n                (50.0, 20.0, 0.015, 1.0),\n                (100.0, 10.0, 0.012, 1.0),\n                (80.0, 15.0, 0.014, 1.0)\n            ]\n        ),\n        (\n            16.11809565095832, 1.5,\n            [\n                (50.0, 20.0, 0.015, 1.0),\n                (100.0, 10.0, 0.012, 1.0),\n                (80.0, 15.0, 0.014, 1.0)\n            ]\n        ),\n        (\n            6.907755278982137, 0.2,\n            [\n                (100.0, 10.0, 0.0005, 2.0),\n                (20.0, 30.0, 0.0005, 2.0),\n                (40.0, 30.0, 0.0005, 2.0)\n            ]\n        )\n    ]\n\n    results = []\n    \n    ln_10 = np.log(10)\n\n    for case in test_cases:\n        mu, sigma, strategies = case\n\n        # Step 1: Calculate the minimum required log reduction (L_min)\n        # Q_0.95(N0) = exp(mu + sigma * z_0.95)\n        q_095_n0 = np.exp(mu + sigma * z_095)\n        \n        # L_min = max(6, log10(Q_0.95(N0)))\n        l_min = max(6.0, np.log10(q_095_n0))\n        \n        feasible_strategies = []\n        \n        # Step 2  3: Evaluate each strategy for feasibility\n        for j, strategy_params in enumerate(strategies):\n            C_j, t_j, k_j, n_j = strategy_params\n            \n            # Calculate achieved log reduction: L_j = (k * C^n * t) / ln(10)\n            l_j = (k_j * np.power(C_j, n_j) * t_j) / ln_10\n            \n            # Check for feasibility\n            if l_j = l_min:\n                # Calculate cost surrogate: CT_j = C_j * t_j\n                ct_j = C_j * t_j\n                # Store the cost and index of the feasible strategy\n                feasible_strategies.append({'cost': ct_j, 'index': j})\n        \n        # Step 4: Select the optimal strategy\n        if not feasible_strategies:\n            # No feasible strategy found\n            results.append(-1)\n        else:\n            # Find the feasible strategy with the minimum cost.\n            # The primary sorting key is cost, and the secondary key is index (for tie-breaking).\n            optimal_strategy = min(feasible_strategies, key=lambda s: (s['cost'], s['index']))\n            results.append(optimal_strategy['index'])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2482746"}]}