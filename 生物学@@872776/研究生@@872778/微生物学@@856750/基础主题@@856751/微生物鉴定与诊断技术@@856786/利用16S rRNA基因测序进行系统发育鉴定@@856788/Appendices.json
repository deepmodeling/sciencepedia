{"hands_on_practices": [{"introduction": "任何成功的16S rRNA基因测序研究都始于高效且无偏的聚合酶链式反应（PCR）扩增。本练习旨在阐明引物设计中的一个核心原则：熔解温度（$T_m$）的匹配。通过使用一个简化的公式估算并比较不同引物的$T_m$，您将亲身体会到为何精确的$T_m$匹配对于确保在多样化的微生物群落中均匀地扩增目标基因至关重要，这是保证后续分析准确性的第一步。[@problem_id:2521927]", "problem": "在 16S 核糖体 RNA (rRNA) 基因的聚合酶链式反应 (PCR) 扩增中，为最小化对系统发育上多样的模板的扩增偏倚，优选使用解链温度紧密匹配的引物对。考虑两个针对细菌 V4 区侧翼保守区域设计的候选正向引物，以及一个固定的反向引物。序列（均以 $5^{\\prime} \\rightarrow 3^{\\prime}$ 方向书写）如下：\n- 候选正向引物 F1: AGCTGACCGTATCGATTCGA\n- 候选正向引物 F2: ATGATCAGATACTGATCAGT\n- 反向引物 R: AGCAGTCGCAGTCGATCATG\n\n假设在标准 PCR 的单一、均匀缓冲液条件下，并忽略二级结构、简并性、最邻近校正和长度调整。使用一种基于组成的寡核苷酸解链温度近似方法来估算每个引物的解链温度，该方法反映了鸟嘌呤-胞嘧啶相对于腺嘌呤-胸腺嘧啶更强的碱基配对贡献，并将其作为其核苷酸计数的函数。\n\n然后，在 F1 和 F2 之间选择与反向引物 R 产生较小绝对解链温度失配的正向引物，因为这对于在具有异质性 16S rRNA 基因序列的模板上进行均匀扩增是更可取的。作为最终答案，报告所选正向引物与反向引物之间解链温度的绝对差值。最终值以摄氏度表示。无需四舍五入，最终答案必须是单个实数。", "solution": "该问题要求评估两个候选正向引物 F1 和 F2，以便在聚合酶链式反应 (PCR) 实验中与一个固定的反向引物 R 配合使用。选择的标准是最小化正向引物和反向引物之间解链温度 ($T_m$) 的绝对差值。问题陈述指示使用简化的、基于组成的模型来计算 $T_m$，这是引物初步设计的常用方法。\n\n首先，我们必须规范解链温度的计算。问题指定了一种“基于组成的近似方法…反映了鸟嘌呤-胞嘧啶相对于腺嘌呤-胸腺嘧啶更强的碱基配对贡献”。在典型的 PCR 盐浓度下，一个适用于短寡核苷酸（小于 $25$ 个碱基对）且满足此条件的标准且合适的公式是 Wallace 法则的变体：\n$$ T_m = 2(N_A + N_T) + 4(N_G + N_C) $$\n其中 $N_A$、 $N_T$、 $N_G$ 和 $N_C$ 分别代表引物序列中腺嘌呤、胸腺嘧啶、鸟嘌呤和胞嘧啶碱基的数量。得到的 $T_m$ 以摄氏度为单位。所有提供的引物长度均为 $20$ 个碱基对，因此该公式适用。\n\n我们通过确定每个引物的核苷酸组成来进行计算。\n\n对于第一个候选正向引物 F1，序列为 $5^{\\prime}$-AGCTGACCGTATCGATTCGA-$3^{\\prime}$：\n长度为 $20$ 个核苷酸。\n各种碱基的计数如下：\n-   腺嘌呤 ($N_A$) 数量：$5$\n-   胸腺嘧啶 ($N_T$) 数量：$5$\n-   鸟嘌呤 ($N_G$) 数量：$5$\n-   胞嘧啶 ($N_C$) 数量：$5$\nA 和 T 碱基的总数是 $N_A + N_T = 5 + 5 = 10$。\nG 和 C 碱基的总数是 $N_G + N_C = 5 + 5 = 10$。\nF1 的解链温度，记为 $T_{m,F1}$，计算如下：\n$$ T_{m,F1} = 2(10) + 4(10) = 20 + 40 = 60^{\\circ}\\text{C} $$\n\n对于第二个候选正向引物 F2，序列为 $5^{\\prime}$-ATGATCAGATACTGATCAGT-$3^{\\prime}$：\n长度为 $20$ 个核苷酸。\n各种碱基的计数如下：\n-   腺嘌呤 ($N_A$) 数量：$7$\n-   胸腺嘧啶 ($N_T$) 数量：$6$\n-   鸟嘌呤 ($N_G$) 数量：$4$\n-   胞嘧啶 ($N_C$) 数量：$3$\nA 和 T 碱基的总数是 $N_A + N_T = 7 + 6 = 13$。\nG 和 C 碱基的总数是 $N_G + N_C = 4 + 3 = 7$。\nF2 的解链温度，记为 $T_{m,F2}$，计算如下：\n$$ T_{m,F2} = 2(13) + 4(7) = 26 + 28 = 54^{\\circ}\\text{C} $$\n\n对于固定的反向引物 R，序列为 $5^{\\prime}$-AGCAGTCGCAGTCGATCATG-$3^{\\prime}$：\n长度为 $20$ 个核苷酸。\n各种碱基的计数如下：\n-   腺嘌呤 ($N_A$) 数量：$5$\n-   胸腺嘧啶 ($N_T$) 数量：$4$\n-   鸟嘌呤 ($N_G$) 数量：$6$\n-   胞嘧啶 ($N_C$) 数量：$5$\nA 和 T 碱基的总数是 $N_A + N_T = 5 + 4 = 9$。\nG 和 C 碱基的总数是 $N_G + N_C = 6 + 5 = 11$。\nR 的解链温度，记为 $T_{m,R}$，计算如下：\n$$ T_{m,R} = 2(9) + 4(11) = 18 + 44 = 62^{\\circ}\\text{C} $$\n\n现在，我们必须通过计算它们各自解链温度的绝对差值来比较正向引物和反向引物。\n\n对于引物对 (F1, R)，绝对差值为：\n$$ \\Delta T_{m1} = |T_{m,F1} - T_{m,R}| = |60 - 62| = |-2| = 2 $$\n\n对于引物对 (F2, R)，绝对差值为：\n$$ \\Delta T_{m2} = |T_{m,F2} - T_{m,R}| = |54 - 62| = |-8| = 8 $$\n\n为了最小化扩增偏倚，我们必须选择产生较小解链温度失配的正向引物。比较这两个差值，我们发现 $\\Delta T_{m1} = 2$ 小于 $\\Delta T_{m2} = 8$。因此，在这些简化假设下，正向引物 F1 是与反向引物 R 配对的更优选择。\n\n问题要求的是所选正向引物与反向引物之间解链温度的绝对差值。所选的引物是 F1，其与 R 相应的解链温度差是 $\\Delta T_{m1}$。\n\n最终答案是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2521927"}, {"introduction": "在获得测序原始数据后，关键的生物信息学步骤之一是将双端测序读长（paired-end reads）拼接成完整的扩增子序列。然而，在复杂的微生物样品中，错误地将不相关的读长拼接在一起（即“虚假拼接”）是一个重大挑战。本练习将引导您计算确保可靠拼接所需的最小重叠碱基数，并应用统计学原理来设定一个严格的质量控制阈值，从而深入理解如何在保证数据完整性与控制分析错误之间取得平衡。[@problem_id:2521972]", "problem": "一个微生物学实验室使用16S核糖体RNA基因的双末端测序技术，通过靶向一个长度为$A$的扩增子高变区来鉴定混合群落中的细菌。每个读长末端的长度为$L$个碱基对（bp）。根据定义，如果两个读长朝向内侧并覆盖相同的扩增子，则存在一个重叠区域，其长度等于两个读长贡献的总测序长度减去扩增子长度，前提是该差值为正；否则，不存在重叠。该实验室的合并软件要求，观察到的重叠区域必须包含两个读长之间至少一个长度为$k$的连续完全匹配，才能可靠地合并一对读长；该条件旨在控制复杂群落中不相关读长对之间的虚假合并。假设不相关的序列遵循均匀且独立的核苷酸模型，因此两个不相关序列在$k$个连续位置上完全匹配的概率为$(1/4)^{k}$。同时假设，在长度为$O$的给定重叠区域内，这种长度为$k$的匹配最多有$O$个独立的起始位置。为了将$N$次尝试合并中任何虚假合并的全实验概率限制在$\\alpha$以内，实验室采用了一个保守的联合界限准则，要求尝试次数$N$、每次尝试的窗口数（以$O$为界）以及每个窗口的错误匹配概率$(1/4)^{k}$的乘积不超过$\\alpha$。当$O$已知时，实验室将设置一个最小窗口长度$k_{\\min}$，即满足此准则的最小整数。对于一个计划中的实验，每个读长的长度$L=250$ bp，扩增子长度$A=460$ bp，尝试合并的总次数$N=2.0\\times 10^{6}$，以及家族性虚假合并风险目标$\\alpha=1.0\\times 10^{-2}$，请使用以上定义来：(i) 确定重叠长度$O$，(ii) 确定确保风险目标的最小完全匹配长度$k_{\\min}$，以及 (iii) 计算可行性余量$M$，定义为$M=O-k_{\\min}$。仅报告$M$的最终值，以单个整数碱基对数表示。如果需要四舍五入，请使用标准有效数字规则四舍五入到最近的整数碱基对。", "solution": "目标是计算可行性余量$M$，其定义为读长对重叠长度$O$与所需的最小完全匹配长度$k_{\\min}$之间的差值。计算过程分为三个步骤：(i) 确定$O$，(ii) 确定$k_{\\min}$，以及 (iii) 计算$M$。\n\n(i) 确定重叠长度$O$。\n问题陈述了使用双末端测序，每个读长的长度为$L$。因此，一对读长的总测序长度为$2L$。扩增子的长度为$A$。重叠长度$O$被定义为总测序长度减去扩增子长度，前提是该差值为正。\n\n已知：\n读长长度，$L = 250$ bp。\n扩增子长度，$A = 460$ bp。\n\n总测序长度为：\n$$2L = 2 \\times 250 \\text{ bp} = 500 \\text{ bp}$$\n重叠长度$O$的计算如下：\n$$O = 2L - A = 500 - 460 = 40 \\text{ bp}$$\n由于$O = 40 > 0$，存在重叠，其长度为40个碱基对。\n\n(ii) 确定最小完全匹配长度$k_{\\min}$。\n问题指定了一个保守的联合界限准则来控制全实验范围内的虚假合并概率。该准则由以下不等式给出：\n$$N \\cdot O \\cdot \\left(\\frac{1}{4}\\right)^k \\le \\alpha$$\n其中：\n尝试合并次数，$N = 2.0 \\times 10^6$。\n重叠长度，$O = 40$ bp（如上计算）。\n家族性虚假合并风险目标，$\\alpha = 1.0 \\times 10^{-2}$。\n所需的连续完全匹配的长度为$k$。\n\n我们必须找到满足此不等式的最小整数$k$，记为$k_{\\min}$。首先，我们重新整理不等式以求解$k$：\n$$N \\cdot O \\cdot 4^{-k} \\le \\alpha$$\n$$4^{-k} \\le \\frac{\\alpha}{N \\cdot O}$$\n$$4^k \\ge \\frac{N \\cdot O}{\\alpha}$$\n\n现在，我们代入给定的数值：\n$$N \\cdot O = (2.0 \\times 10^6) \\times 40 = 80 \\times 10^6 = 8.0 \\times 10^7$$\n$$\\frac{N \\cdot O}{\\alpha} = \\frac{8.0 \\times 10^7}{1.0 \\times 10^{-2}} = 8.0 \\times 10^9$$\n\n不等式变为：\n$$4^k \\ge 8.0 \\times 10^9$$\n为了求解$k$，我们对两边取自然对数($\\ln$)：\n$$\\ln(4^k) \\ge \\ln(8.0 \\times 10^9)$$\n$$k \\cdot \\ln(4) \\ge \\ln(8.0 \\times 10^9)$$\n$$k \\ge \\frac{\\ln(8.0 \\times 10^9)}{\\ln(4)}$$\n\n我们可以简化对数项：\n$$\\ln(4) = \\ln(2^2) = 2\\ln(2)$$\n$$\\ln(8.0 \\times 10^9) = \\ln(8 \\times 10^9) = \\ln(8) + \\ln(10^9) = \\ln(2^3) + 9\\ln(10) = 3\\ln(2) + 9\\ln(10)$$\n\n将这些代入关于$k$的不等式中：\n$$k \\ge \\frac{3\\ln(2) + 9\\ln(10)}{2\\ln(2)} = \\frac{3}{2} + \\frac{9}{2} \\cdot \\frac{\\ln(10)}{\\ln(2)}$$\n使用标准值$\\ln(2) \\approx 0.6931$和$\\ln(10) \\approx 2.3026$：\n$$k \\ge 1.5 + 4.5 \\cdot \\frac{2.3026}{0.6931} \\approx 1.5 + 4.5 \\cdot (3.3219) \\approx 1.5 + 14.9486$$\n$$k \\ge 16.4486$$\n由于$k$必须是整数（表示碱基对的数量），满足此条件的最小整数值$k_{\\min}$是大于或等于16.4486的最小整数。这可以通过对该值取上整得到。\n$$k_{\\min} = \\lceil 16.4486 \\rceil = 17$$\n\n(iii) 计算可行性余量$M$。\n可行性余量$M$定义为重叠长度$O$与最小完全匹配长度$k_{\\min}$之差：\n$$M = O - k_{\\min}$$\n代入计算出的值：\n$$O = 40$$\n$$k_{\\min} = 17$$\n$$M = 40 - 17 = 23$$\n可行性余量是23个碱基对。这个值是整数，因此不需要四舍五入。", "answer": "$$\\boxed{23}$$", "id": "2521972"}, {"introduction": "构建准确的系统发育树是利用16S rRNA基因序列进行物种鉴定的最终目标，而这一过程的基石是选择一个能够恰当描述序列演化过程的核苷酸替换模型。过于简单的模型可能无法捕捉真实的演化动态，而过于复杂的模型则可能导致过拟合。本练习将指导您使用赤池信息准则（Akaike Information Criterion, AIC），一种在模型拟合优度和复杂性之间进行权衡的强大工具，来客观地比较两个常用的系统发育模型，从而为您的系统发育分析选择最合适的统计基础。[@problem_id:2522005]", "problem": "一个实验室使用小亚基核糖体RNA（rRNA）基因，特别是$16\\mathrm{S}$ rRNA基因，通过比对来自$24$个分类单元（未知分离株加上参考序列）的长度为$1,500$个核苷酸的序列，对细菌分离株进行系统发育鉴定。为评估在固定拓扑结构上进行最大似然（ML）系统发育推断的替换过程假设，该团队比较了两个嵌套的核苷酸替换模型：模型1是带伽马分布速率变异的Hasegawa–Kishino–Yano模型（HKY+$\\Gamma$），模型2是带伽马分布速率变异和不变位点比例的广义时间可逆模型（GTR+$\\Gamma$+I）。对于每个模型，所有自由参数，包括固定拓扑上的所有分支长度、核苷酸频率参数、相对速率参数、伽马形状参数以及（若适用）不变位点比例，都通过最大似然法进行估计。\n\n最大化的对数似然值和估计参数的总数（包括分支长度）如下：\n- 模型1：$\\ln L_{1} = -7,320.481$，其中 $k_{1} = 50$。\n- 模型2：$\\ln L_{2} = -7,288.912$，其中 $k_{2} = 55$。\n\n使用赤池信息准则（AIC）的定义，即对于一个具有$k$个自由参数和最大化似然值$\\hat{L}$的模型，该准则为 $AIC = 2k - 2 \\ln \\hat{L}$，并将两个模型之间的AIC差异定义为 $\\Delta AIC = AIC_{2} - AIC_{1}$。从这些定义和标准的基于似然的模型选择原则出发，计算 $\\Delta AIC$ 的值，结果为一个实数。将最终值四舍五入到四位有效数字。以无量纲量的形式表达您的答案。", "solution": "目标是计算两个嵌套的核苷酸替换模型——模型1（HKY+$\\Gamma$）和模型2（GTR+$\\Gamma$+I）——之间的赤池信息准则（$\\mathrm{AIC}$）差异。该差异定义为 $\\Delta \\mathrm{AIC} = \\mathrm{AIC}_{2} - \\mathrm{AIC}_{1}$。\n\n对于一个具有$k$个估计自由参数和最大化对数似然值$\\ln \\hat{L}$的模型，赤池信息准则的定义由以下公式给出：\n$$\n\\mathrm{AIC} = 2k - 2 \\ln \\hat{L}\n$$\n\n两个模型提供的数据如下：\n对于模型1（HKY+$\\Gamma$）：\n- 最大化对数似然值：$\\ln L_{1} = -7,320.481$\n- 自由参数数量：$k_{1} = 50$\n\n对于模型2（GTR+$\\Gamma$+I）：\n- 最大化对数似然值：$\\ln L_{2} = -7,288.912$\n- 自由参数数量：$k_{2} = 55$\n\n使用$\\mathrm{AIC}$的定义，我们可以写出$\\mathrm{AIC}_{1}$和$\\mathrm{AIC}_{2}$的表达式：\n$$\n\\mathrm{AIC}_{1} = 2k_{1} - 2 \\ln L_{1}\n$$\n$$\n\\mathrm{AIC}_{2} = 2k_{2} - 2 \\ln L_{2}\n$$\n\n所需的量是差异值 $\\Delta \\mathrm{AIC}$：\n$$\n\\Delta \\mathrm{AIC} = \\mathrm{AIC}_{2} - \\mathrm{AIC}_{1} = (2k_{2} - 2 \\ln L_{2}) - (2k_{1} - 2 \\ln L_{1})\n$$\n\n这个表达式可以通过将涉及参数数量的项和涉及对数似然值的项分组来重新排列：\n$$\n\\Delta \\mathrm{AIC} = 2(k_{2} - k_{1}) - 2(\\ln L_{2} - \\ln L_{1})\n$$\n\n现在，我们将给定的数值代入此表达式。\n参数数量的差异是：\n$$\nk_{2} - k_{1} = 55 - 50 = 5\n$$\n最大化对数似然值的差异是：\n$$\n\\ln L_{2} - \\ln L_{1} = -7,288.912 - (-7,320.481) = -7,288.912 + 7,320.481 = 31.569\n$$\n\n将这些差异值代回$\\Delta \\mathrm{AIC}$的表达式中：\n$$\n\\Delta \\mathrm{AIC} = 2(5) - 2(31.569)\n$$\n$$\n\\Delta \\mathrm{AIC} = 10 - 63.138\n$$\n$$\n\\Delta \\mathrm{AIC} = -53.138\n$$\n\n题目要求将最终答案四舍五入到四位有效数字。计算出的值为$-53.138$。前四位有效数字是$5$、$3$、$1$和$3$。第五位有效数字是$8$，大于或等于$5$，因此我们将第四位有效数字向上取整。\n$$\n\\Delta \\mathrm{AIC} \\approx -53.14\n$$\n\n$\\Delta \\mathrm{AIC}$的负值表示$\\mathrm{AIC}_{2}$小于$\\mathrm{AIC}_{1}$。在使用$\\mathrm{AIC}$进行模型选择时，$\\mathrm{AIC}$值较低的模型更优。因此，对于该数据集，GTR+$\\Gamma$+I模型远优于HKY+$\\Gamma$模型，因为差异的绝对值很大（通常，大于$10$的差异被认为是决定性的）。这意味着模型2中用于解释更复杂的替换速率矩阵和不变位点比例的额外参数，为数据提供了显著更优的拟合，从而证明了增加模型复杂性的合理性。", "answer": "$$\\boxed{-53.14}$$", "id": "2522005"}]}