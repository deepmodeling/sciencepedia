{"hands_on_practices": [{"introduction": "当一种新的诊断检测方法被开发出来后，必须通过与“金标准”参考方法进行比较，来严格评估其性能。本练习着重于最基本的一步：如何从一个$2\\times 2$的混淆矩阵中计算灵敏度、特异性等关键性能指标，并且，更重要的是，如何使用置信区间来量化这些估计值的不确定性。这是循证诊断的基石。[@problem_id:2524028]", "problem": "一个临床微生物学实验室正在评估一种新的实时聚合酶链式反应（PCR）检测方法，该方法用于快速检测血流病原体，并以需氧血培养作为参考标准。在指定的评估期内，该检测方法与参考标准被并行应用于同一组患者样本。得到的 $2\\times 2$ 混淆矩阵产生以下计数：真阳性 (TP) $= 94$，假阳性 (FP) $= 6$，假阴性 (FN) $= 10$，以及真阴性 (TN) $= 890$。根据微生物诊断学中诊断性能的基本定义，其中灵敏度是感染者中检测结果为阳性的概率，特异度是未感染者中检测结果为阴性的概率，阳性预测值 (PPV) 是检测结果为阳性时确实感染的概率，阴性预测值 (NPV) 是检测结果为阴性时确实未感染的概率，而总体准确率是检测结果与参考标准一致的概率，请计算灵敏度、特异度、PPV、NPV 和准确率的点估计值。\n\n然后，对这五个比例中的每一个，基于计数的二项分布模型，构建 $95\\%$ 置信度的Wilson得分区间，不进行连续性校正。将所有报告值（点估计值和每个置信界限）四舍五入到四位有效数字。将最终值表示为无单位小数（不要使用百分比表示法）。你的最终答案必须按此确切顺序列出这 $15$ 个数字：灵敏度、其置信下限和上限，特异度、其置信下限和上限，PPV、其置信下限和上限，NPV、其置信下限和上限，准确率、其置信下限和上限。", "solution": "在尝试任何解答之前，该问题陈述已经过严格验证。\n\n已知条件是诊断测试评估中 $2 \\times 2$ 混淆矩阵的计数：\n- 真阳性 ($TP$) $= 94$\n- 假阳性 ($FP$) $= 6$\n- 假阴性 ($FN$) $= 10$\n- 真阴性 ($TN$) $= 890$\n\n任务是计算五个标准性能指标的点估计值和 $95\\%$ Wilson得分置信区间：灵敏度、特异度、阳性预测值 (PPV)、阴性预测值 (NPV) 和准确率。\n\n这个问题有科学依据，提法明确且客观。它提供了一个完整且一致的数据集，是临床微生物学研究的典型。所提供的定义是标准的，规定的统计方法是适当且明确的。不存在科学、逻辑或结构上的缺陷。因此，该问题被裁定为有效，我们继续进行解答的正式推导。\n\n首先，我们根据给定的计数建立必要的总数。总体根据参考标准（真实情况）和新测试的结果进行分层。\n- 有病症（感染）的总数：$P = TP + FN = 94 + 10 = 104$。\n- 无病症（未感染）的总数：$N = TN + FP = 890 + 6 = 896$。\n- 阳性测试结果总数：$T_{P} = TP + FP = 94 + 6 = 100$。\n- 阴性测试结果总数：$T_{N} = TN + FN = 890 + 10 = 900$。\n- 总样本量：$S = TP + FP + FN + TN = 94 + 6 + 10 + 890 = 1000$。\n\n对于每个指标，我们将计算点估计值 $\\hat{p}$ 及其 $95\\%$ Wilson得分置信区间 $(L, U)$。比例 $\\hat{p} = k/n$（其中 $k$ 是 $n$ 次试验中的成功次数）的Wilson区间由以下公式给出：\n$$ (L, U) = \\frac{1}{1 + \\frac{z^2}{n}} \\left( \\hat{p} + \\frac{z^2}{2n} \\pm z \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n} + \\frac{z^2}{4n^2}} \\right) $$\n对于 $95\\%$ 的置信水平，$\\alpha = 0.05$，标准正态变量为 $z = z_{1-\\alpha/2} = z_{0.975} \\approx 1.959964$。所有最终值必须四舍五入到四位有效数字。\n\n1. 灵敏度 (Sens)\n灵敏度是在所有患病个体中被正确识别为阳性的比例。\n- 点估计值：$Sens = \\frac{TP}{TP+FN} = \\frac{94}{104} \\approx 0.903846 \\ldots$\n四舍五入到四位有效数字，$Sens = 0.9038$。\n- Wilson区间：此处，$k = 94$，$n = 104$。\n得到的区间是 $[0.831988\\ldots, 0.946928\\ldots]$。\n下限，$L_{Sens} = 0.8320$。\n上限，$U_{Sens} = 0.9469$。\n\n2. 特异度 (Spec)\n特异度是在所有未患病个体中被正确识别为阴性的比例。\n- 点估计值：$Spec = \\frac{TN}{TN+FP} = \\frac{890}{896} \\approx 0.993303 \\ldots$\n四舍五入到四位有效数字，$Spec = 0.9933$。\n- Wilson区间：此处，$k = 890$，$n = 896$。\n得到的区间是 $[0.985472\\ldots, 0.996928\\ldots]$。\n下限，$L_{Spec} = 0.9855$。\n上限，$U_{Spec} = 0.9969$。\n\n3. 阳性预测值 (PPV)\nPPV是在所有测试结果为阳性的个体中真阳性的比例。\n- 点估计值：$PPV = \\frac{TP}{TP+FP} = \\frac{94}{100} = 0.94$。\n作为具有四位有效数字的小数，$PPV = 0.9400$。\n- Wilson区间：此处，$k = 94$，$n = 100$。\n得到的区间是 $[0.875231\\ldots, 0.972210\\ldots]$。\n下限，$L_{PPV} = 0.8752$。\n上限，$U_{PPV} = 0.9722$。\n\n4. 阴性预测值 (NPV)\nNPV是在所有测试结果为阴性的个体中真阴性的比例。\n- 点估计值：$NPV = \\frac{TN}{TN+FN} = \\frac{890}{900} \\approx 0.988888 \\ldots$\n四舍五入到四位有效数字，$NPV = 0.9889$。\n- Wilson区间：此处，$k = 890$，$n = 900$。\n得到的区间是 $[0.979671\\ldots, 0.993949\\ldots]$。\n下限，$L_{NPV} = 0.9797$。\n上限，$U_{NPV} = 0.9939$。\n\n5. 准确率 (Acc)\n准确率是在总人群中正确结果（包括真阳性和真阴性）的比例。\n- 点估计值：$Acc = \\frac{TP+TN}{TP+FP+FN+TN} = \\frac{94+890}{1000} = \\frac{984}{1000} = 0.984$。\n作为具有四位有效数字的小数，$Acc = 0.9840$。\n- Wilson区间：此处，$k = 984$，$n = 1000$。\n得到的区间是 $[0.974168\\ldots, 0.990126\\ldots]$。\n下限，$L_{Acc} = 0.9742$。\n上限，$U_{Acc} = 0.9901$。\n\n现将所要求的 $15$ 个值（已四舍五入到四位有效数字）汇编如下。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9038  0.8320  0.9469  0.9933  0.9855  0.9969  0.9400  0.8752  0.9722  0.9889  0.9797  0.9939  0.9840  0.9742  0.9901\n\\end{pmatrix}\n}\n$$", "id": "2524028"}, {"introduction": "许多现代诊断检测（如定量PCR或某些蛋白质标志物检测）产生的是连续的数值分数，而非简单的“阳性/阴性”结果。因此，一个关键任务是确定一个最佳的切点（阈值），用以区分患病与非患病状态。本练习将引导你使用尤登指数（Youden's Index）——一种平衡灵敏度和特异性的常用方法——从基本原理出发，推导出在标准统计模型下的最优诊断阈值。[@problem_id:2523986]", "problem": "一种用于微生物诊断的连续分子检测为每个样本产生一个标量分数 $X$。$X$ 值越高，生物学上与目标病原体的存在相关联。假设在真正患病的样本中，$X$ 的分布是具有共同标准差的正态分布，$X \\mid \\text{患病} \\sim \\mathcal{N}(\\mu_{D}, \\sigma^{2})$，而在真正未患病的样本中，其分布为 $X \\mid \\text{未患病} \\sim \\mathcal{N}(\\mu_{N}, \\sigma^{2})$，其中 $\\mu_{D} > \\mu_{N}$ 且 $\\sigma > 0$。考虑一个决策规则，对于某个阈值 $\\tau \\in \\mathbb{R}$，如果 $X \\ge \\tau$，则将样本分类为检测阳性，否则分类为检测阴性。\n\n仅使用灵敏度、特异度、约登指数的核心定义，以及正态分布及其标准化的成熟性质（特别是标准正态累积分布函数及其导数），从第一性原理推导出使约登指数 $J(\\tau)$ 最大化的阈值 $\\tau^{\\star}$，其中 $J(\\tau) \\equiv \\text{灵敏度}(\\tau) + \\text{特异度}(\\tau) - 1$。然后，以闭合形式表示在 $\\tau^{\\star}$ 处达到的灵敏度和特异度。\n\n将最终结果以单行矩阵的形式给出，按顺序包含 $\\tau^{\\star}$、$\\text{灵敏度}(\\tau^{\\star})$ 和 $\\text{特异度}(\\tau^{\\star})$，每一项都用 $\\mu_{D}$、$\\mu_{N}$、$\\sigma$ 和标准正态累积分布函数 $\\Phi(\\cdot)$ 表示。不需要进行数值计算，也无需四舍五入。不要包含单位。", "solution": "该问题涉及在等方差正态模型下，基于连续诊断分数 $X$ 进行分类。我们从核心定义开始：\n\n- 在阈值 $\\tau$ 下的灵敏度是真阳性概率，\n$$\n\\text{Se}(\\tau) \\equiv \\mathbb{P}(X \\ge \\tau \\mid \\text{患病})。\n$$\n\n- 在阈值 $\\tau$ 下的特异度是真阴性概率，\n$$\n\\text{Sp}(\\tau) \\equiv \\mathbb{P}(X  \\tau \\mid \\text{未患病})。\n$$\n\n- 在阈值 $\\tau$ 下的约登指数是\n$$\nJ(\\tau) \\equiv \\text{Se}(\\tau) + \\text{Sp}(\\tau) - 1.\n$$\n\n在假设 $X \\mid \\text{患病} \\sim \\mathcal{N}(\\mu_{D}, \\sigma^{2})$ 和 $X \\mid \\text{未患病} \\sim \\mathcal{N}(\\mu_{N}, \\sigma^{2})$ 且 $\\mu_{D}  \\mu_{N}$ 的条件下，使用标准正态累积分布函数 $\\Phi(\\cdot)$ 及其密度函数 $\\phi(\\cdot)$，我们可以通过正态标准化来表示灵敏度和特异度。\n\n对于灵敏度，\n$$\n\\text{Se}(\\tau) = \\mathbb{P}(X \\ge \\tau \\mid \\text{患病})\n= \\mathbb{P}\\!\\left(\\frac{X - \\mu_{D}}{\\sigma} \\ge \\frac{\\tau - \\mu_{D}}{\\sigma} \\,\\middle|\\, \\text{患病}\\right)\n= 1 - \\Phi\\!\\left(\\frac{\\tau - \\mu_{D}}{\\sigma}\\right)\n= \\Phi\\!\\left(\\frac{\\mu_{D} - \\tau}{\\sigma}\\right),\n$$\n其中我们使用了对称性质 $\\Phi(-z) = 1 - \\Phi(z)$。\n\n对于特异度，\n$$\n\\text{Sp}(\\tau) = \\mathbb{P}(X  \\tau \\mid \\text{未患病})\n= \\mathbb{P}\\!\\left(\\frac{X - \\mu_{N}}{\\sigma}  \\frac{\\tau - \\mu_{N}}{\\sigma} \\,\\middle|\\, \\text{未患病}\\right)\n= \\Phi\\!\\left(\\frac{\\tau - \\mu_{N}}{\\sigma}\\right).\n$$\n\n因此，\n$$\nJ(\\tau) = \\Phi\\!\\left(\\frac{\\mu_{D} - \\tau}{\\sigma}\\right) + \\Phi\\!\\left(\\frac{\\tau - \\mu_{N}}{\\sigma}\\right) - 1.\n$$\n\n为了在 $\\tau \\in \\mathbb{R}$ 上最大化 $J(\\tau)$，我们对 $\\tau$ 求导并令其为零。使用链式法则以及 $\\frac{d}{dz}\\Phi(z) = \\phi(z)$ 这一事实，我们得到\n$$\n\\frac{d}{d\\tau} J(\\tau)\n= -\\frac{1}{\\sigma}\\,\\phi\\!\\left(\\frac{\\mu_{D} - \\tau}{\\sigma}\\right)\n+ \\frac{1}{\\sigma}\\,\\phi\\!\\left(\\frac{\\tau - \\mu_{N}}{\\sigma}\\right).\n$$\n令 $\\frac{d}{d\\tau}J(\\tau) = 0$ 得\n$$\n\\phi\\!\\left(\\frac{\\tau - \\mu_{N}}{\\sigma}\\right)\n= \\phi\\!\\left(\\frac{\\mu_{D} - \\tau}{\\sigma}\\right).\n$$\n\n由于 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{z^{2}}{2}\\right)$ 在 $|z|$ 上是严格递减的且恒为正，等式成立当且仅当自变量的平方值相等，即\n$$\n\\left(\\frac{\\tau - \\mu_{N}}{\\sigma}\\right)^{2} = \\left(\\frac{\\mu_{D} - \\tau}{\\sigma}\\right)^{2}\n\\quad \\Longleftrightarrow \\quad\n(\\tau - \\mu_{N})^{2} = (\\mu_{D} - \\tau)^{2}.\n$$\n两边开平方根得到两种代数可能性：\n$$\n\\tau - \\mu_{N} = \\mu_{D} - \\tau\n\\quad \\text{或} \\quad\n\\tau - \\mu_{N} = -(\\mu_{D} - \\tau).\n$$\n第二个条件简化为 $\\mu_{N} = \\mu_{D}$，这与假设 $\\mu_{D}  \\mu_{N}$ 相矛盾。因此，唯一可接受的解是\n$$\n\\tau^{\\star} = \\frac{\\mu_{D} + \\mu_{N}}{2}.\n$$\n\n为确保 $\\tau^{\\star}$ 使 $J(\\tau)$ 最大化，观察到 $\\lim_{\\tau \\to -\\infty} J(\\tau) = 0$ 且 $\\lim_{\\tau \\to +\\infty} J(\\tau) = 0$，而 $J(\\tau)$ 是连续可微的，并有唯一的内部临界点；因此该临界点是全局最大值点。\n\n接下来，计算在 $\\tau^{\\star}$ 处的灵敏度和特异度。定义均值差 $\\Delta \\equiv \\mu_{D} - \\mu_{N}  0$。那么\n$$\n\\text{Se}(\\tau^{\\star})\n= \\Phi\\!\\left(\\frac{\\mu_{D} - \\tau^{\\star}}{\\sigma}\\right)\n= \\Phi\\!\\left(\\frac{\\mu_{D} - \\frac{\\mu_{D} + \\mu_{N}}{2}}{\\sigma}\\right)\n= \\Phi\\!\\left(\\frac{\\mu_{D} - \\mu_{N}}{2\\sigma}\\right)\n= \\Phi\\!\\left(\\frac{\\Delta}{2\\sigma}\\right),\n$$\n且\n$$\n\\text{Sp}(\\tau^{\\star})\n= \\Phi\\!\\left(\\frac{\\tau^{\\star} - \\mu_{N}}{\\sigma}\\right)\n= \\Phi\\!\\left(\\frac{\\frac{\\mu_{D} + \\mu_{N}}{2} - \\mu_{N}}{\\sigma}\\right)\n= \\Phi\\!\\left(\\frac{\\mu_{D} - \\mu_{N}}{2\\sigma}\\right)\n= \\Phi\\!\\left(\\frac{\\Delta}{2\\sigma}\\right).\n$$\n\n因此，在使约登指数最大化的阈值处，灵敏度和特异度相等，且两者均由标准正态累积分布函数在类均值的标准化半间距处的值给出。\n\n按指定顺序整理所需量，我们得到\n$$\n\\tau^{\\star} = \\frac{\\mu_{D} + \\mu_{N}}{2}, \\quad\n\\text{Se}(\\tau^{\\star}) = \\Phi\\!\\left(\\frac{\\mu_{D} - \\mu_{N}}{2\\sigma}\\right), \\quad\n\\text{Sp}(\\tau^{\\star}) = \\Phi\\!\\left(\\frac{\\mu_{D} - \\mu_{N}}{2\\sigma}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\mu_{D}+\\mu_{N}}{2}  \\Phi\\!\\left(\\frac{\\mu_{D}-\\mu_{N}}{2\\sigma}\\right)  \\Phi\\!\\left(\\frac{\\mu_{D}-\\mu_{N}}{2\\sigma}\\right)\\end{pmatrix}}$$", "id": "2523986"}, {"introduction": "在下一代测序（NGS）等现代高灵敏度诊断技术中，一个核心挑战是如何处理无处不在的背景污染。尤其是在低生物量样本中，区分真实生物信号和试剂或环境污染变得异常困难。本项高级练习将演示如何构建一个贝叶斯统计模型，利用阴性对照来估计污染的分布，并据此对病原体的存在与否做出概率性判断，这代表了诊断数据分析的前沿方法。[@problem_id:2524024]", "problem": "一项基于下一代测序（NGS）的临床宏基因组学检测，用于筛查低生物量样本中的目标细菌分类单元。为了控制环境和试剂污染，实验室运行了 $m$ 个独立的阴性对照，每个都并行处理。令 $C_i$ 表示在第 $i$ 个测序深度为 $E_i$（单位：百万读数）的阴性对照中，观测到的目标分类单元的读数计数，其中 $i \\in \\{1,\\dots,m\\}$。在一个测序深度为 $E_{\\mathrm{s}}$（单位：百万读数）的患者样本中，令 $K$ 为映射到目标分类单元的观测读数。\n\n假设以下原则和模型，这些原则和模型基于微生物诊断学中计数数据的标准概率建模：\n- 污染读数来自一个齐次泊松过程，其单位暴露率为 $\\theta$（读数/百万），因此 $C_i \\mid \\theta \\sim \\mathrm{Poisson}(E_i \\,\\theta)$。\n- 在患者样本中，根据零假设 $H_0$（仅有污染），$K \\mid \\theta \\sim \\mathrm{Poisson}(E_{\\mathrm{s}} \\,\\theta)$。根据备择假设 $H_1$（污染加真实信号），$K \\mid \\theta,\\phi \\sim \\mathrm{Poisson}(E_{\\mathrm{s}}\\,(\\theta+\\phi))$，其中 $\\phi$ 是真实生物信号的单位暴露率。\n- 使用具有共同率参数的共轭先验，以反映单位暴露缩放并保持解析易处理性：$\\theta \\sim \\mathrm{Gamma}(a_0,b_0)$ 和 $\\phi \\sim \\mathrm{Gamma}(a_{\\mathrm{s}}, b_{\\bullet})$，其中 $\\mathrm{Gamma}(a,b)$ 表示形状参数为 $a$、率参数为 $b$ 的伽马分布。观测阴性对照后，将污染的先验更新为 $\\theta \\mid \\{C_i,E_i\\}_{i=1}^m \\sim \\mathrm{Gamma}(a_c,b_c)$，其中 $a_c = a_0 + \\sum_{i=1}^m C_i$ 和 $b_c = b_0 + \\sum_{i=1}^m E_i$，并设置 $b_{\\bullet} = b_c$ 以使 $\\theta$ 和 $\\phi$ 共享相同的率参数。\n- 令 $\\pi_1$ 表示目标分类单元在患者样本中真实存在的先验概率（因此 $\\mathbb{P}(H_1)=\\pi_1$ 且 $\\mathbb{P}(H_0)=1-\\pi_1$）。\n\n基于这些基础，且不使用任何没有依据的捷径，推导一个贝叶斯决策规则，该规则在后验概率 $\\mathbb{P}(H_1 \\mid K)$ 至少为目标值 $\\tau$ 时，将该分类单元判定为“存在”。您的推导必须从泊松似然、伽马先验和贝叶斯定理出发，显式地对滋扰污染率 $\\theta$（以及在 $H_1$ 下对 $\\phi$）进行积分，并得到一个用 $K$、$a_c$、$b_c$、$a_{\\mathrm{s}}$ 和 $E_{\\mathrm{s}}$ 表示的闭式贝叶斯因子。\n\n然后，将您推导出的规则应用于以下科学上真实的数据集和超参数：\n- 阴性对照：$m=4$，深度 $(E_1,E_2,E_3,E_4)=(1,1,1,1)$，观测计数 $(C_1,C_2,C_3,C_4)=(0,1,0,2)$。\n- 先验：$a_0=1$，$b_0=1$，$a_{\\mathrm{s}}=2$，以及 $\\pi_1=0.2$。\n- 患者样本：深度 $E_{\\mathrm{s}}=2$。\n- 决策目标：$\\tau=0.95$。\n\n计算最小整数阈值 $k^{\\star}$，使得在您的决策规则下，当 $K \\ge k^{\\star}$ 时宣布为“存在”能够达到 $\\mathbb{P}(H_1 \\mid K) \\ge \\tau$。最终答案只提供 $k^{\\star}$ 的值。不需要单位，也不需要舍入说明，因为根据构造 $k^{\\star}$ 是一个整数。", "solution": "我们从基于按暴露缩放的泊松过程和用于共轭性的伽马先验的似然模型开始。形状参数为 $a$、率参数为 $b$ 的伽马密度为\n$$\nf(x \\mid a,b) = \\frac{b^{a}}{\\Gamma(a)} x^{a-1} \\exp(-b x), \\quad x0.\n$$\n对于阴性对照，污染率 $\\theta$ 的先验为 $\\theta \\sim \\mathrm{Gamma}(a_0,b_0)$。对于独立观测值 $C_i \\mid \\theta \\sim \\mathrm{Poisson}(E_i \\theta)$，联合似然为\n$$\nL(\\theta) \\propto \\prod_{i=1}^m \\exp(-E_i \\theta) (E_i \\theta)^{C_i} \\propto \\exp\\!\\Big(-\\theta \\sum_{i=1}^m E_i\\Big)\\, \\theta^{\\sum_{i=1}^m C_i}.\n$$\n与先验结合，$\\theta$ 的后验分布为\n$$\n\\theta \\mid \\{C_i,E_i\\}_{i=1}^m \\sim \\mathrm{Gamma}\\!\\Big(a_c,b_c\\Big), \\quad a_c = a_0 + \\sum_{i=1}^m C_i,\\ \\ b_c = b_0 + \\sum_{i=1}^m E_i.\n$$\n\n在患者样本中，根据 $H_0$，我们有 $K \\mid \\theta \\sim \\mathrm{Poisson}(E_{\\mathrm{s}} \\theta)$。伽马-泊松混合产生一个负二项（泊松-伽马）边际分布：\n$$\np_0(K=k) \\equiv \\mathbb{P}(K=k \\mid H_0) = \\int_{0}^{\\infty} \\mathbb{P}(K=k \\mid \\theta)\\, f(\\theta \\mid a_c,b_c)\\, d\\theta.\n$$\n进行积分，\n$$\n\\mathbb{P}(K=k \\mid \\theta) = \\frac{(E_{\\mathrm{s}} \\theta)^k \\exp(-E_{\\mathrm{s}} \\theta)}{k!}, \\quad\nf(\\theta \\mid a_c,b_c) = \\frac{b_c^{a_c}}{\\Gamma(a_c)} \\theta^{a_c-1} \\exp(-b_c \\theta).\n$$\n因此\n$$\np_0(K=k) = \\frac{b_c^{a_c} E_{\\mathrm{s}}^{k}}{k!\\,\\Gamma(a_c)} \\int_{0}^{\\infty} \\theta^{k+a_c-1} \\exp\\!\\big(-(b_c+E_{\\mathrm{s}})\\theta\\big)\\, d\\theta\n= \\frac{b_c^{a_c} E_{\\mathrm{s}}^{k}}{k!\\,\\Gamma(a_c)} \\cdot \\frac{\\Gamma(k+a_c)}{(b_c+E_{\\mathrm{s}})^{k+a_c}}.\n$$\n用 $p \\equiv \\frac{b_c}{b_c+E_{\\mathrm{s}}}$ 重写，\n$$\np_0(K=k) = \\frac{\\Gamma(k+a_c)}{k!\\,\\Gamma(a_c)} (1-p)^{k} p^{a_c},\n$$\n这是形状参数为 $a_c$、成功概率为 $p$ 的负二项概率质量函数。\n\n在 $H_1$ 下，我们有 $K \\mid \\theta,\\phi \\sim \\mathrm{Poisson}(E_{\\mathrm{s}}(\\theta+\\phi))$，其中 $\\theta \\sim \\mathrm{Gamma}(a_c,b_c)$ 如上所述，$\\phi \\sim \\mathrm{Gamma}(a_{\\mathrm{s}}, b_{\\bullet})$ 且独立于 $\\theta$。为了保持共轭性并能够进行解析边际化，我们设置 $b_{\\bullet}=b_c$。共享相同率参数的独立伽马变量之和也是伽马分布，其形状参数为各形状参数之和，率参数不变，因此 $\\theta+\\phi \\sim \\mathrm{Gamma}(a_c + a_{\\mathrm{s}}, b_c)$。对 $(\\theta+\\phi)$ 进行边际化得到\n$$\np_1(K=k) \\equiv \\mathbb{P}(K=k \\mid H_1) = \\frac{\\Gamma(k+a_c+a_{\\mathrm{s}})}{k!\\,\\Gamma(a_c+a_{\\mathrm{s}})} (1-p)^{k} p^{a_c+a_{\\mathrm{s}}},\n$$\n其中 $p = \\frac{b_c}{b_c+E_{\\mathrm{s}}}$ 相同。\n\n对于观测到 $K=k$，支持 $H_1$ 相对于 $H_0$ 的贝叶斯因子是\n$$\n\\mathrm{BF}(k) \\equiv \\frac{p_1(K=k)}{p_0(K=k)} = \\frac{\\Gamma(k+a_c+a_{\\mathrm{s}})}{\\Gamma(a_c+a_{\\mathrm{s}})} \\cdot \\frac{\\Gamma(a_c)}{\\Gamma(k+a_c)} \\cdot p^{a_{\\mathrm{s}}}.\n$$\n根据贝叶斯定理，后验优势比为\n$$\n\\mathrm{Odds}(H_1 \\mid K=k) = \\mathrm{BF}(k) \\times \\frac{\\pi_1}{1-\\pi_1},\n$$\n而后验概率为\n$$\n\\mathbb{P}(H_1 \\mid K=k) = \\frac{\\mathrm{Odds}(H_1 \\mid K=k)}{1 + \\mathrm{Odds}(H_1 \\mid K=k)}.\n$$\n一个 $(1-\\alpha)$ 可信决策阈值 $\\tau$ 对应于要求后验优势比至少为 $\\frac{\\tau}{1-\\tau}$。因此，贝叶斯决策规则“判定为存在”是\n$$\n\\text{Call present if } \\mathrm{BF}(k) \\times \\frac{\\pi_1}{1-\\pi_1} \\ge \\frac{\\tau}{1-\\tau}.\n$$\n\n我们现在用给定的数据进行实例化。首先，根据阴性对照更新污染的后验分布。对照组有 $m=4$，深度为 $(E_1,E_2,E_3,E_4)=(1,1,1,1)$，计数为 $(C_1,C_2,C_3,C_4)=(0,1,0,2)$。在 $a_0=1$ 和 $b_0=1$ 的情况下，\n$$\n\\sum_{i=1}^m C_i = 0+1+0+2 = 3, \\quad \\sum_{i=1}^m E_i = 1+1+1+1 = 4,\n$$\n所以\n$$\na_c = a_0 + \\sum C_i = 1+3=4, \\quad b_c = b_0 + \\sum E_i = 1+4=5.\n$$\n按规定设置 $a_{\\mathrm{s}}=2$ 和 $b_{\\bullet}=b_c=5$。对于患者样本深度 $E_{\\mathrm{s}}=2$，\n$$\np = \\frac{b_c}{b_c+E_{\\mathrm{s}}} = \\frac{5}{5+2} = \\frac{5}{7}.\n$$\n因此，\n$$\n\\mathrm{BF}(k) = \\frac{\\Gamma(k+4+2)}{\\Gamma(4+2)} \\cdot \\frac{\\Gamma(4)}{\\Gamma(k+4)} \\cdot \\left(\\frac{5}{7}\\right)^{2}.\n$$\n使用 $\\Gamma(4)=3!=6$ 和 $\\Gamma(6)=5!=120$ 以及恒等式 $\\frac{\\Gamma(k+6)}{\\Gamma(k+4)}=(k+5)(k+4)$，我们得到\n$$\n\\mathrm{BF}(k) = \\frac{(k+5)(k+4)}{20} \\cdot \\left(\\frac{5}{7}\\right)^{2} = \\frac{(k+5)(k+4)}{20} \\cdot \\frac{25}{49} = \\frac{25\\,(k+5)(k+4)}{980}.\n$$\n真实存在的先验概率为 $\\pi_1=0.2$，所以先验优势比为\n$$\n\\frac{\\pi_1}{1-\\pi_1} = \\frac{0.2}{0.8} = \\frac{1}{4}.\n$$\n目标后验概率为 $\\tau=0.95$，对应的后验优势比阈值为\n$$\n\\frac{\\tau}{1-\\tau} = \\frac{0.95}{0.05} = 19.\n$$\n决策规则“判定为存在”变为\n$$\n\\mathrm{BF}(k) \\times \\frac{1}{4} \\ge 19 \\quad \\Longleftrightarrow \\quad \\mathrm{BF}(k) \\ge 76.\n$$\n代入闭式贝叶斯因子：\n$$\n\\frac{25\\,(k+5)(k+4)}{980} \\ge 76 \\quad \\Longleftrightarrow \\quad (k+5)(k+4) \\ge 76 \\cdot \\frac{980}{25}.\n$$\n精确计算右侧：\n$$\n\\frac{980}{25} = \\frac{196}{5}, \\quad 76 \\cdot \\frac{196}{5} = \\frac{76 \\cdot 196}{5} = \\frac{14896}{5} = 2979.2.\n$$\n因此，我们需要\n$$\n(k+5)(k+4) \\ge 2979.2.\n$$\n由于 $(k+5)(k+4)$ 是一个整数，满足此条件的最小整数是使 $(k+5)(k+4) \\ge 2980$ 成立的最小 $k$。在二次方程根附近求值：\n$$\nk=50 \\Rightarrow (55)(54)=2970 \\quad (\\text{不足}), \\quad k=51 \\Rightarrow (56)(55)=3080 \\quad (\\text{充足}).\n$$\n因此，最小阈值为\n$$\nk^{\\star} = 51.\n$$\n在所述的贝叶斯污染模型和先验下，当 $K \\ge 51$ 时宣布为“存在”可确保 $\\mathbb{P}(H_1 \\mid K) \\ge 0.95$。", "answer": "$$\\boxed{51}$$", "id": "2524024"}]}