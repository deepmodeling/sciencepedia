{"hands_on_practices": [{"introduction": "趋化性信号通路的核心是响应调节蛋白 CheY 的磷酸化循环。这个实践练习将引导你为该核心生化回路建立一个数学模型。通过应用米氏方程 (Michaelis-Menten kinetics) 来描述 CheZ 磷酸酶的活性，并平衡 CheA 激酶的磷酸化通量，你将推导出关键信号分子 CheY-P 的稳态浓度表达式 [@problem_id:2493997]。这项练习旨在训练你对生物信号网络进行稳态分析的基本能力。", "problem": "大肠杆菌的趋化性通过响应调节蛋白CheY的磷酸化状态来调节鞭毛马达的偏向性。在一个均匀的环境中，假设在一个混合均匀的单细胞体积内，总CheY浓度固定为 $Y_T$。定义 $Y_P$ 为磷酸化CheY（CheY-P）的稳态浓度，而 $Y = Y_T - Y_P$ 为未磷酸化CheY的浓度。\n\nCheA是一种组氨酸激酶，其激酶活性受受体输入信号的调节。将CheY的磷酸化建模为一个一级过程，其有效磷酸化速率常数为 $k_{\\mathrm{ph}} a$，其中 $k_{\\mathrm{ph}}$ 是一个基础速率常数，而 $a \\in [0,1]$ 是无量纲的CheA活性。因此，磷酸化通量为 $J_{\\mathrm{ph}} = k_{\\mathrm{ph}} a (Y_T - Y_P)$。\n\nCheZ是CheY-P的特异性磷酸酶，并作为一种酶发挥作用。设总CheZ浓度为 $Z_T$，并设由CheZ催化的CheY-P去磷酸化过程遵循标准的酶促反应方案，其结合和解离速率常数分别为 $k_1$ 和 $k_{-1}$，催化转换数为 $k_{\\mathrm{cat}}$，从而产生米氏常数 $K_M = (k_{-1} + k_{\\mathrm{cat}})/k_1$。从基本酶促步骤的质量作用动力学出发，并对酶-底物复合物使用准稳态近似，推导出由CheZ催化的CheY-P去磷酸化通量 $J_{\\mathrm{dephos}}$ 的米氏（MM）形式，用 $k_{\\mathrm{cat}}$、$K_M$、$Z_T$ 和 $Y_P$ 表示。\n\n然后，通过施加CheY-P净生成为零的稳态条件，推导出稳态 $Y_P$ 关于参数 $a$、$Y_T$、$Z_T$、$k_{\\mathrm{ph}}$、$k_{\\mathrm{cat}}$ 和 $K_M$ 的封闭形式解析表达式。将您的最终答案表示为仅包含这些参数的单个简化表达式。最终表达式中不要包含单位。如果您引入了任何中间变量，请在最终表达式中将它们消去，以便只出现 $a$、$Y_T$、$Z_T$、$k_{\\mathrm{ph}}$、$k_{\\mathrm{cat}}$ 和 $K_M$。给出解的生物学上允许的主分支（非负且不超过 $Y_T$）。", "solution": "问题陈述具有科学依据，提法得当且客观。它提出了一个细菌趋化性核心生化回路的标准模型，并要求严格推导稳态浓度。其前提条件一致且足以得出一个唯一的、具有物理意义的解。我们将开始推导过程。\n\n该问题需要两个相继的推导。首先，我们必须推导出去磷酸化通量 $J_{\\mathrm{dephos}}$ 的米氏（MM）形式。其次，利用这个结果，我们必须推导出磷酸化CheY的稳态浓度 $Y_P$。\n\n第一部分：去磷酸化通量 $J_{\\mathrm{dephos}}$ 的推导。\n\nCheY-P（底物，$S$）的去磷酸化由磷酸酶CheZ（酶，$E$）催化。该过程形成一个酶-底物复合物（$ES$），并释放出未磷酸化的CheY（$P$）和无机磷酸盐。基本步骤由质量作用动力学方案给出：\n$$ E + S \\xrightarrow{k_1} ES $$\n$$ ES \\xrightarrow{k_{-1}} E + S $$\n$$ ES \\xrightarrow{k_{\\mathrm{cat}}} E + P $$\n各物质浓度为 $[S] = Y_P$，$[E] = [\\text{CheZ}]$，$[E]_T = Z_T$。酶-底物复合物的浓度为 $[ES]$。\n\n酶-底物复合物浓度的变化速率由下式给出：\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_{\\mathrm{cat}}[ES] $$\n总酶浓度 $Z_T$ 的守恒定律要求 $[E] = Z_T - [ES]$。将此代入速率方程可得：\n$$ \\frac{d[ES]}{dt} = k_1 (Z_T - [ES])Y_P - (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n问题指定使用准稳态近似（QSSA），该近似假设中间复合物 $[ES]$ 的浓度变化远慢于底物和产物的浓度变化，因此 $\\frac{d[ES]}{dt} \\approx 0$。应用此近似：\n$$ k_1 (Z_T - [ES])Y_P = (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n我们现在求解复合物的稳态浓度 $[ES]$：\n$$ k_1 Z_T Y_P - k_1 [ES] Y_P = (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ k_1 Z_T Y_P = (k_1 Y_P + k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ [ES] = \\frac{k_1 Z_T Y_P}{k_1 Y_P + k_{-1} + k_{\\mathrm{cat}}} $$\n为了得到熟悉的米氏形式，我们将分子和分母同除以 $k_1$：\n$$ [ES] = \\frac{Z_T Y_P}{Y_P + \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}} $$\n问题将米氏常数定义为 $K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}$。代入此定义可得：\n$$ [ES] = \\frac{Z_T Y_P}{Y_P + K_M} $$\n去磷酸化通量 $J_{\\mathrm{dephos}}$ 是产物的生成速率，即 $J_{\\mathrm{dephos}} = k_{\\mathrm{cat}}[ES]$。因此：\n$$ J_{\\mathrm{dephos}} = \\frac{k_{\\mathrm{cat}} Z_T Y_P}{K_M + Y_P} $$\n这就是所要求的去磷酸化通量的米氏形式。\n\n第二部分：稳态浓度 $Y_P$ 的推导。\n\n在稳态下，CheY-P的生成速率必须等于其消耗速率。磷酸化通量由 $J_{\\mathrm{ph}} = k_{\\mathrm{ph}} a (Y_T - Y_P)$ 给出。令 $J_{\\mathrm{ph}} = J_{\\mathrm{dephos}}$：\n$$ k_{\\mathrm{ph}} a (Y_T - Y_P) = \\frac{k_{\\mathrm{cat}} Z_T Y_P}{K_M + Y_P} $$\n为了求解 $Y_P$，我们将此方程重排成多项式形式。\n$$ k_{\\mathrm{ph}} a (Y_T - Y_P)(K_M + Y_P) = k_{\\mathrm{cat}} Z_T Y_P $$\n展开左侧：\n$$ k_{\\mathrm{ph}} a (Y_T K_M + Y_T Y_P - K_M Y_P - Y_P^2) = k_{\\mathrm{cat}} Z_T Y_P $$\n按 $Y_P$ 的幂次对各项进行分组：\n$$ -k_{\\mathrm{ph}} a Y_P^2 + (k_{\\mathrm{ph}} a Y_T - k_{\\mathrm{ph}} a K_M - k_{\\mathrm{cat}} Z_T) Y_P + k_{\\mathrm{ph}} a Y_T K_M = 0 $$\n为了得到首项系数为正的标准二次型 $AY_P^2 + BY_P + C = 0$，我们将整个方程乘以 $-1$：\n$$ k_{\\mathrm{ph}} a Y_P^2 + (k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T) Y_P - k_{\\mathrm{ph}} a Y_T K_M = 0 $$\n该二次方程的系数为：\n$$ A = k_{\\mathrm{ph}} a $$\n$$ B = k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T $$\n$$ C = -k_{\\mathrm{ph}} a Y_T K_M $$\n$Y_P$ 的解由二次公式给出：\n$$ Y_P = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A} $$\n我们必须选择物理上允许的根。所有参数（$k_{\\mathrm{ph}}, a, Y_T, K_M, k_{\\mathrm{cat}}, Z_T$）都是非负的。因此，$A \\ge 0$ 且 $C \\le 0$。两个根的乘积为 $Y_{P,1}Y_{P,2} = C/A = -Y_T K_M \\le 0$。这意味着一个根是非负的，另一个根是非正的。由于 $Y_P$ 代表浓度，它必须是非负的。因此，我们必须选择非负的根。\n\n判别式为 $\\Delta = B^2 - 4AC = B^2 - 4(k_{\\mathrm{ph}}a)(-k_{\\mathrm{ph}} a Y_T K_M) = B^2 + 4(k_{\\mathrm{ph}} a)^2 Y_T K_M$。由于 $4AC \\le 0$，我们有 $\\Delta \\ge B^2$，这意味着 $\\sqrt{\\Delta} \\ge |B|$。\n带 `+` 号的根是 $\\frac{-B + \\sqrt{\\Delta}}{2A}$。其分子大于或等于 $-B + |B|$，而这个值总是非负的。\n带 `-` 号的根是 $\\frac{-B - \\sqrt{\\Delta}}{2A}$。其分子小于或等于 $-B - |B|$，而这个值总是非正的。\n因此，唯一的非负、生物学上允许的解是带 `+` 号的那个。\n代入 $A$、$B$ 和 $C$ 的表达式：\n$$ Y_P = \\frac{-(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T) + \\sqrt{(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T)^2 - 4(k_{\\mathrm{ph}} a)(-k_{\\mathrm{ph}} a Y_T K_M)}}{2 k_{\\mathrm{ph}} a} $$\n化简平方根下的表达式：\n$$ Y_P = \\frac{-(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T)) + \\sqrt{(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T))^2 + 4(k_{\\mathrm{ph}} a)^2 Y_T K_M}}{2 k_{\\mathrm{ph}} a} $$\n此表达式表示了用指定参数表示的稳态浓度 $Y_P$。对速率平衡方程的图形分析证实，该解位于区间 $[0, Y_T]$ 内，满足物理约束。", "answer": "$$\n\\boxed{\\frac{-(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T)) + \\sqrt{(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T))^2 + 4(k_{\\mathrm{ph}} a)^2 Y_T K_M}}{2 k_{\\mathrm{ph}} a}}\n$$", "id": "2493997"}, {"introduction": "细菌趋化性的一个显著特征是其近乎完美的适应性，这使得细胞能够响应化学梯度的变化而非绝对浓度。这种适应性是通过一个由受体甲基化和去甲基化构成的负反馈回路实现的。在这个练习中，你将通过对描述受体活性和甲基化水平的耦合动力学系统进行线性化分析，来推导系统在受到刺激后恢复到其稳态活性的特征时间，即适应时间 [@problem_id:2494032]。这个过程将让你掌握使用线性化方法来分析生物系统动态特性的重要技巧。", "problem": "在细菌趋化性中，一个受体-激酶系统通过共价修饰进行适应：甲基转移酶 CheR 甲基化非活性受体，而磷酸化的 CheB (CheB-P) 则使活性受体去甲基化。考虑一个最小的、生物物理上一致的模型，该模型将一个两态 Monod–Wyman–Changeux 受体活性模块与一阶有效甲基化动力学耦合起来：\n\n- 受体活性是无量纲自由能差 $F$（以玻尔兹曼常数乘以温度 $k_B T$ 为单位）的两态函数：$a(F) = \\frac{1}{1 + \\exp(F)}$。\n- 自由能为 $F(t) = F_0 + \\Delta F \\, H(t) - \\alpha \\, m(t)$，其中 $H(t)$ 是赫维赛德阶跃函数，$m(t)$ 是每个受体的平均甲基化水平（视为连续变量），$\\alpha > 0$ 是每次甲基化的能量耦合。\n- 甲基化动力学由以下有效速率决定\n$$\n\\frac{dm}{dt} = v_R \\bigl(1 - a(t)\\bigr) - v_B \\, a(t),\n$$\n其中 $v_R$ 和 $v_B$ 分别是有效的一阶甲基化和去甲基化速率常数（由催化常数和酶丰度整合而来）。\n\n在 $t = 0^{-}$ 时，系统处于稳态。在 $t = 0^{+}$ 时，一个吸引剂阶跃使自由能的配体依赖部分瞬时改变了 $\\Delta F = 1.0$（以 $k_B T$ 为单位）。使用参数值 $v_R = 0.10\\,\\mathrm{s}^{-1}$，$v_B = 0.15\\,\\mathrm{s}^{-1}$，以及 $\\alpha = 1.7$（以每个单位 $m$ 的 $k_B T$ 为单位）。\n\n从上述基本定义出发，在阶跃后适应的稳态活性附近线性化耦合动力学，并推导出 $t > 0$ 时的时间进程 $a(t)$。根据此时间进程，确定 e-折适应时间 $\\tau$。报告 $\\tau$ 的数值，单位为秒，并四舍五入到四位有效数字。", "solution": "所提出的问题是理论生物物理学中的一个标准、适定的问题，特别是在细菌趋化性研究领域。它具有科学依据，并包含了得到唯一解所需的所有信息。我们将开始进行推导。\n\n该系统由两个耦合变量描述：每个受体的平均甲基化水平 $m(t)$ 和受体活性 $a(t)$。其控制方程为：\n$$\n\\frac{dm}{dt} = v_R \\bigl(1 - a(t)\\bigr) - v_B \\, a(t) \\quad (1)\n$$\n$$\na(t) = a(F(t)) = \\frac{1}{1 + \\exp(F(t))} \\quad (2)\n$$\n$$\nF(t) = F_0 + \\Delta F \\, H(t) - \\alpha \\, m(t) \\quad (3)\n$$\n其中 $H(t)$ 是赫维赛德阶跃函数。任务是通过线性化这些动力学来求出适应时间 $\\tau$。\n\n首先，我们确定系统的稳态性质。该模型的一个关键特征是完美适应，这意味着稳态活性（我们记为 $a^*$）与外部刺激无关。在任何稳态下，都有 $\\frac{dm}{dt} = 0$。根据方程 $(1)$：\n$$v_R (1 - a^*) - v_B a^* = 0$$\n解出 $a^*$，我们得到：\n$$a^* = \\frac{v_R}{v_R + v_B}$$\n这是系统在刺激前（$t  0$）和响应刺激很久之后（$t \\to \\infty$）所适应到的恒定活性水平。\n使用给定参数 $v_R = 0.10\\,\\mathrm{s}^{-1}$ 和 $v_B = 0.15\\,\\mathrm{s}^{-1}$：\n$$a^* = \\frac{0.10}{0.10 + 0.15} = \\frac{0.10}{0.25} = 0.4$$\n稳态自由能 $F^*$ 必须对应于此活性水平。根据方程 $(2)$：\n$$a^* = \\frac{1}{1 + \\exp(F^*)} \\implies F^* = \\ln\\left(\\frac{1}{a^*} - 1\\right) = \\ln\\left(\\frac{1}{0.4} - 1\\right) = \\ln(1.5)$$\n甲基化水平会进行调整以维持这个 $F^*$ 值。设 $m_1^*$ 为阶跃前的稳态甲基化水平（$t  0$），$m_2^*$ 为适应后的新稳态甲基化水平（$t \\to \\infty$）。\n对于 $t  0$，$H(t)=0$，所以 $F^* = F_0 - \\alpha m_1^*$。\n对于 $t \\to \\infty$，$H(t)=1$，所以 $F^* = F_0 + \\Delta F - \\alpha m_2^*$。\n\n问题要求我们在阶跃后适应的稳态（其特征为 $(m_2^*, a^*)$）附近对 $t0$ 时的动力学进行线性化。我们定义相对于此稳态的微小偏离：\n$$\\delta m(t) = m(t) - m_2^*$$\n$$\\delta a(t) = a(t) - a^*$$\n我们将这些偏离代入甲基化动力学方程，即方程 $(1)$：\n$$\\frac{d}{dt}(m_2^* + \\delta m) = v_R(1 - (a^* + \\delta a)) - v_B(a^* + \\delta a)$$\n$$\\frac{d}{dt}(\\delta m) = \\bigl(v_R(1 - a^*) - v_B a^*\\bigr) - (v_R + v_B)\\delta a$$\n根据稳态的定义，右侧第一项为零。因此，线性化的甲基化动力学方程为：\n$$\\frac{d(\\delta m)}{dt} = -(v_R + v_B)\\delta a \\quad (4)$$\n接下来，我们必须将 $\\delta a$ 与 $\\delta m$ 联系起来。对于 $t0$，自由能为 $F(t) = F_0 + \\Delta F - \\alpha m(t)$。我们可以用偏离 $\\delta m(t)$ 来表示它：\n$$F(t) = (F_0 + \\Delta F - \\alpha m_2^*) - \\alpha(m(t) - m_2^*) = F^* - \\alpha \\delta m(t)$$\n现在，我们在稳态自由能 $F^*$ 附近对活性 $a(F)$ 进行一阶泰勒展开：\n$$\\delta a(t) = a(F(t)) - a^* \\approx \\frac{da}{dF}\\bigg|_{F=F^*} (F(t) - F^*)$$\n活性函数的导数为：\n$$\\frac{da}{dF} = \\frac{d}{dF}\\left(\\frac{1}{1 + \\exp(F)}\\right) = -\\frac{\\exp(F)}{(1+\\exp(F))^2} = -a(1-a)$$\n在稳态 $F^*$ 处求值：\n$$\\frac{da}{dF}\\bigg|_{F=F^*} = -a^*(1-a^*)$$\n偏离之间的关系变为：\n$$\\delta a(t) \\approx -a^*(1-a^*) (F(t) - F^*) = -a^*(1-a^*) (-\\alpha \\delta m(t))$$\n$$\\delta a(t) = \\alpha a^*(1 - a^*) \\delta m(t) \\quad (5)$$\n我们现在有了一个由两个线性方程 $(4)$ 和 $(5)$ 组成的方程组。我们可以组合它们，得到一个关于 $\\delta a(t)$ 的单一微分方程。对方程 $(5)$ 关于时间求导：\n$$\\frac{d(\\delta a)}{dt} = \\alpha a^*(1-a^*) \\frac{d(\\delta m)}{dt}$$\n将方程 $(4)$ 代入此表达式：\n$$\\frac{d(\\delta a)}{dt} = \\alpha a^*(1-a^*) \\bigl(-(v_R + v_B)\\delta a\\bigr)$$\n$$\\frac{d(\\delta a)}{dt} = -\\bigl[ \\alpha(v_R + v_B)a^*(1-a^*) \\bigr] \\delta a$$\n这是一个形式为 $\\frac{dy}{dt} = -ky$ 的一阶线性常微分方程，其解为 $y(t) = y(0)\\exp(-kt)$。活性偏离的时间进程为：\n$$\\delta a(t) = \\delta a(0) \\exp(-t/\\tau)$$\n其中适应时间常数 $\\tau$ 是速率常数 $k$ 的倒数：\n$$\\tau = \\frac{1}{\\alpha(v_R + v_B)a^*(1-a^*)}$$\n在此线性近似下，$t0$ 时 $a(t)$ 的完整时间进程为 $a(t) = a^* + \\delta a(t)$。问题要求的是 e-折适应时间 $\\tau$，这正是我们推导出的时间常数。\n\n为了得到 $\\tau$ 的一个更简洁的符号表达式，我们代入 $a^* = \\frac{v_R}{v_R + v_B}$ 和 $1-a^* = \\frac{v_B}{v_R + v_B}$：\n$$\\tau = \\frac{1}{\\alpha(v_R + v_B)\\left(\\frac{v_R}{v_R + v_B}\\right)\\left(\\frac{v_B}{v_R + v_B}\\right)} = \\frac{v_R + v_B}{\\alpha v_R v_B}$$\n这可以改写为：\n$$\\tau = \\frac{1}{\\alpha} \\left(\\frac{1}{v_R} + \\frac{1}{v_B}\\right)$$\n现在我们代入给定的数值：$\\alpha = 1.7$，$v_R = 0.10\\,\\mathrm{s}^{-1}$ 和 $v_B = 0.15\\,\\mathrm{s}^{-1}$。\n$$\\tau = \\frac{1}{1.7} \\left(\\frac{1}{0.10} + \\frac{1}{0.15}\\right) \\,\\mathrm{s}$$\n$$\\tau = \\frac{1}{1.7} \\left(10 + \\frac{1}{15/100}\\right) \\,\\mathrm{s} = \\frac{1}{1.7} \\left(10 + \\frac{100}{15}\\right) \\,\\mathrm{s} = \\frac{1}{1.7} \\left(10 + \\frac{20}{3}\\right) \\,\\mathrm{s}$$\n$$\\tau = \\frac{1}{1.7} \\left(\\frac{30}{3} + \\frac{20}{3}\\right) \\,\\mathrm{s} = \\frac{1}{1.7} \\left(\\frac{50}{3}\\right) \\,\\mathrm{s} = \\frac{50}{5.1} \\,\\mathrm{s}$$\n计算数值：\n$$\\tau \\approx 9.80392156... \\,\\mathrm{s}$$\n按要求四舍五入到四位有效数字，我们得到适应时间。", "answer": "$$\\boxed{9.804}$$", "id": "2494032"}, {"introduction": "理论模型的最终检验标准在于其解释实验数据的能力。趋化性信号通路的最终输出是鞭毛马达在顺时针（CW）和逆时针（CCW）旋转状态之间的切换。本练习旨在连接理论与实验，你将学习如何基于一个双态马尔可夫过程为马达的随机切换行为建立统计模型。通过为单马达记录的实验数据构建似然函数，你将能够运用最大似然估计法来推断出例如协同性系数和自由能等关键的生物物理参数 [@problem_id:2494022]，从而完成从理论建模到数据分析的完整实践。", "problem": "给定一个基于细菌鞭毛马达切换的物理和统计建模任务。单个鞭毛马達在顺时针（CW）和逆时针（CCW）旋转之间交替。将此切换过程建模为一个连续时间、两态马尔可夫过程，其转移速率依赖于浓度。设从 CCW 切换到 CW 的速率为 $k_{\\mathrm{CW}}([Y])$，从 CW 切换到 CCW 的速率为 $k_{\\mathrm{CCW}}([Y])$，其中 $[Y]$ 是磷酸化 CheY (CheY-P) 的浓度。假定以下基本原理和定义适用：该过程是时间齐次的连续时间马尔可夫链（CTMC），在某一状态的停留时间呈指数分布，其参数等于从该状态传出的速率，并且在稳态时，CW 与 CCW 概率之比与能量差 $\\Delta G([Y])$ 满足细致平衡。假定能量差的热力学拟设形式为 $\\Delta G([Y]) = \\Delta G_b + n \\ln([Y]/[Y]_0)$，其中 $[Y]_0 = 1\\,\\mu\\mathrm{M}$ 是参考浓度，$n$ 是无量纲的协同性参数，$\\Delta G_b$ 是以玻尔兹曼常数乘以绝对温度（$k_B T$）为单位的无量纲基线能量偏移。最后，假定转移速率之和与浓度无关，即 $k_{\\mathrm{CW}}([Y]) + k_{\\mathrm{CCW}}([Y]) = k_{\\mathrm{sum}}$，其中 $k_{\\mathrm{sum}}$ 是一个单位为 $(\\mathrm{s}^{-1})$ 的常数。\n\n您的程序必须通过最大似然法推断参数 $n$、$\\Delta G_b$ 和 $k_{\\mathrm{sum}}$，仅使用在固定 $[Y]$ 条件下单马达时间序列的充分统计量：对于每个浓度为 $[Y]_i$ 的条件 $i$，您将获得在 CW 状态下花费的总时间 $T_{\\mathrm{CW},i}$（单位为 $\\mathrm{s}$），在 CCW 状态下花费的总时间 $T_{\\mathrm{CCW},i}$（单位为 $\\mathrm{s}$），观察到的从 CW 到 CCW 的转移次数 $N_{\\mathrm{CW}\\to\\mathrm{CCW},i}$，以及观察到的从 CCW 到 CW 的转移次数 $N_{\\mathrm{CCW}\\to\\mathrm{CW},i}$。您应从指数停留时间模型和 CTMC 结构出发，根据第一性原理推导出似然函数，并结合上述约束条件，然后针对参数 $(n,\\Delta G_b,k_{\\mathrm{sum}})$ 对其进行最大化。\n\n所有 $\\ln(\\cdot)$ 表达式均使用自然对数。浓度 $[Y]$ 的单位为微摩尔（$\\mu\\mathrm{M}$）。时间单位为秒（$\\mathrm{s}$）。报告的 $k_{\\mathrm{sum}}$ 单位为 $(\\mathrm{s}^{-1})$。报告的 $n$ 和 $\\Delta G_b$ 为无量纲量。您的程序必须输出四舍五入到三位小数的最大似然估计值。\n\n测试套件。为以下三个数据集分别拟合模型。每个数据集包含几个浓度条件；对于每个条件，元组给出 $([Y], N_{\\mathrm{CW}\\to\\mathrm{CCW}}, T_{\\mathrm{CW}}, N_{\\mathrm{CCW}\\to\\mathrm{CW}}, T_{\\mathrm{CCW}})$，其中 $[Y]$ 的单位为 $\\mu\\mathrm{M}$，时间单位为 $\\mathrm{s}$。\n\n- 数据集 A:\n  - $([1.5], 61, 362.4, 61, 37.6)$\n  - $([3.0], 169, 151.0, 169, 249.0)$\n  - $([6.0], 25, 14.6, 25, 385.4)$\n\n- 数据集 B:\n  - $([1.0], 82, 277.95, 82, 22.05)$\n  - $([2.0], 257, 206.91, 257, 93.09)$\n  - $([4.0], 244, 84.9, 244, 215.1)$\n\n- 数据集 C:\n  - $([0.5], 5, 492.3, 5, 7.7)$\n  - $([1.0], 75, 250.0, 75, 250.0)$\n  - $([2.0], 5, 7.7, 5, 492.3)$\n\n您的程序应分别对数据集 A、数据集 B 和数据集 C 独立地拟合 $(n,\\Delta G_b,k_{\\mathrm{sum}})$。最终所需的输出格式为单行，包含一个扁平列表，其中按以下顺序排列九个数字：$n_{\\mathrm{A}}, \\Delta G_{b,\\mathrm{A}}, k_{\\mathrm{sum},\\mathrm{A}}, n_{\\mathrm{B}}, \\Delta G_{b,\\mathrm{B}}, k_{\\mathrm{sum},\\mathrm{B}}, n_{\\mathrm{C}}, \\Delta G_{b,\\mathrm{C}}, k_{\\mathrm{sum},\\mathrm{C}}$，每个数字都四舍五入到三位小数。例如，一个可接受的格式是 `[1.234,-0.567,3.890,2.468,-1.357,4.680,5.000,0.000,0.600]`。确保您的程序只输出一行结果，格式为方括号括起来的逗号分隔列表，不含多余空格。\n\n$k_{\\mathrm{sum}}$ 以 $(\\mathrm{s}^{-1})$ 为单位表示，四舍五入到三位小数。$n$ 和 $\\Delta G_b$ 以无量纲数表示，四舍五入到三位小数。", "solution": "该问题要求我们求解一个细菌鞭毛马达切换生物物理模型的参数的最大似然估计。该模型是一个描述逆时针（CCW）和顺时针（CW）状态之间转换的两态连续时间马尔可夫链。\n\n首先，必须验证问题陈述。\n**第1步：提取给定信息**\n- **模型**：两态（CCW, CW）连续时间马尔可夫链（CTMC）。\n- **转移速率**：\n    - CCW 到 CW: $k_{\\mathrm{CW}}([Y])$\n    - CW 到 CCW: $k_{\\mathrm{CCW}}([Y])$\n    - $[Y]$ 是 CheY-P 的浓度，单位为 $\\mu\\mathrm{M}$。\n- **假设与约束**：\n    1. 停留时间呈指数分布。在 CCW 中的停留时间服从 $\\sim\\mathrm{Exp}(k_{\\mathrm{CW}}([Y]))$。在 CW 中的停留时间服从 $\\sim\\mathrm{Exp}(k_{\\mathrm{CCW}}([Y]))$。\n    2. 速率之和为常数：$k_{\\mathrm{CW}}([Y]) + k_{\\mathrm{CCW}}([Y]) = k_{\\mathrm{sum}}$。\n    3. 自由能差（单位为 $k_B T$）的热力学拟设：$\\Delta G([Y]) = \\Delta G_b + n \\ln([Y]/[Y]_0)$，其中 $[Y]_0 = 1\\,\\mu\\mathrm{M}$。\n    4. 稳态时的细致平衡将速率与自由能联系起来：$k_{\\mathrm{CW}}/k_{\\mathrm{CCW}} = P_{\\mathrm{CW}}/P_{\\mathrm{CCW}} = e^{-\\Delta G([Y])}$。\n- **数据（充分统计量）**：对于每个浓度 $[Y]_i$，提供以下信息：\n    - $T_{\\mathrm{CW},i}$：在 CW 状态的总时间（s）。\n    - $T_{\\mathrm{CCW},i}$：在 CCW 状态的总时间（s）。\n    - $N_{\\mathrm{CW}\\to\\mathrm{CCW},i}$：从 CW 到 CCW 的转移次数。\n    - $N_{\\mathrm{CCW}\\to\\mathrm{CW},i}$：从 CCW 到 CW 的转移次数。\n- **任务**：为三个独立的数据集（A, B, C），通过最大似然估计推断参数 $(n, \\Delta G_b, k_{\\mathrm{sum}})$。\n- **输出**：报告九个估计参数（每个数据集的 $n$, $\\Delta G_b$, $k_{\\mathrm{sum}}$），四舍五入到三位小数，并以特定的扁平列表格式输出。\n\n**第2步：使用提取的给定信息进行验证**\n该问题在科学上是合理的。它描述了一个用于建模随机两态系统的标准且成熟的框架，广泛应用于生物物理学，特别是在细菌趋化性研究中。所提供的数据（CTMC 的充分统计量）正是构建似然函数所需要的。该问题是适定的、客观的，并且不包含内部矛盾或歧义。这是一个需要数值优化的非平凡统计推断任务。\n\n**第3步：结论与行动**\n该问题有效。将提供一个完整的解决方案。\n\n**似然函数的推导**\n对于一个两态 CTMC，在总时间 $T_{\\mathrm{CCW}}$ 内观察到 $N_{\\mathrm{CCW}\\to\\mathrm{CW}}$ 次从 CCW 状态的转移，以及在总时间 $T_{\\mathrm{CW}}$ 内观察到 $N_{\\mathrm{CW}\\to\\mathrm{CCW}}$ 次从 CW 状态的转移的似然，是两个独立泊松过程似然的乘积。对于浓度为 $[Y]_i$ 的单个实验条件 $i$，其似然为：\n$$L_i(k_{\\mathrm{CW},i}, k_{\\mathrm{CCW},i}) = \\left( k_{\\mathrm{CW},i}^{N_{\\mathrm{CCW}\\to\\mathrm{CW},i}} e^{-k_{\\mathrm{CW},i} T_{\\mathrm{CCW},i}} \\right) \\left( k_{\\mathrm{CCW},i}^{N_{\\mathrm{CW}\\to\\mathrm{CCW},i}} e^{-k_{\\mathrm{CCW},i} T_{\\mathrm{CW},i}} \\right)$$\n问题给出的数据中 $N_{\\mathrm{CCW}\\to\\mathrm{CW},i} = N_{\\mathrm{CW}\\to\\mathrm{CCW},i}$。我们用 $N_i$ 表示这个计数。条件 $i$ 的对数似然为：\n$$\\ell_i(k_{\\mathrm{CW},i}, k_{\\mathrm{CCW},i}) = N_i \\ln(k_{\\mathrm{CW},i}) - k_{\\mathrm{CW},i} T_{\\mathrm{CCW},i} + N_i \\ln(k_{\\mathrm{CCW},i}) - k_{\\mathrm{CCW},i} T_{\\mathrm{CW},i}$$\n一个数据集的总对数似然为 $\\ell = \\sum_i \\ell_i$。\n\n**速率的参数化**\n我们必须用基本参数 $(n, \\Delta G_b, k_{\\mathrm{sum}})$ 来表示速率 $k_{\\mathrm{CW},i}$ 和 $k_{\\mathrm{CCW},i}$。\n根据给定的约束条件：\n1. $k_{\\mathrm{CW},i} + k_{\\mathrm{CCW},i} = k_{\\mathrm{sum}}$\n2. $k_{\\mathrm{CW},i} / k_{\\mathrm{CCW},i} = e^{-\\Delta G_i}$\n其中 $\\Delta G_i = \\Delta G_b + n \\ln([Y]_i)$ 因为 $[Y]_0=1$。\n\n求解该方程组可得速率为：\n$$k_{\\mathrm{CW}}([Y]_i) = \\frac{k_{\\mathrm{sum}}}{1 + e^{\\Delta G_i}} = \\frac{k_{\\mathrm{sum}}}{1 + e^{\\Delta G_b + n \\ln[Y]_i}}$$\n$$k_{\\mathrm{CCW}}([Y]_i) = \\frac{k_{\\mathrm{sum}} e^{\\Delta G_i}}{1 + e^{\\Delta G_i}} = \\frac{k_{\\mathrm{sum}} e^{\\Delta G_b + n \\ln[Y]_i}}{1 + e^{\\Delta G_b + n \\ln[Y]_i}}$$\n这些也可以写成 $k_{\\mathrm{CCW},i} = k_{\\mathrm{sum}} - k_{\\mathrm{CW},i}$。\n\n**最大似然估计**\n目标是找到使总对数似然 $\\ell(\\theta) = \\sum_i \\ell_i(\\theta)$ 最大化的参数 $\\theta = (n, \\Delta G_b, k_{\\mathrm{sum}})$。这是一个数值优化问题。我们将实现一个负对数似然函数，并使用 `scipy.optimize` 库中的数值最小化器来寻找最优参数。\n\n需要最小化的负对数似然函数是：\n$$\\mathcal{L}(\\theta) = -\\ell(\\theta) = -\\sum_{i} \\left[ N_i \\ln(k_{\\mathrm{CW},i}) - k_{\\mathrm{CW},i} T_{\\mathrm{CCW},i} + N_i \\ln(k_{\\mathrm{CCW},i}) - k_{\\mathrm{CCW},i} T_{\\mathrm{CW},i} \\right]$$\n其中 $k_{\\mathrm{CW},i}$ 和 $k_{\\mathrm{CCW},i}$ 是如上定义的 $\\theta$ 和 $[Y_i]$ 的函数。\n\n**优化策略**\n对于每个数据集，我们将：\n1.  定义一个负对数似然函数，它接受一个参数向量 `(n, delta_gb, k_sum)` 和数据集作为输入。\n2.  为优化器提供一个良好的参数初始猜测值。可以通过简化的线性回归方法获得初始猜测值。模型意味着 $\\ln(T_{\\mathrm{CW},i}/T_{\\mathrm{CCW},i}) \\approx -\\Delta G_b - n \\ln([Y]_i)$。通过对 $\\ln(T_{\\mathrm{CW},i}/T_{\\mathrm{CCW},i})$ 与 $\\ln([Y]_i)$ 进行线性拟合，可以得出 $n$ 和 $\\Delta G_b$ 的初始估计。$k_{\\mathrm{sum}}$ 的初始猜测值可以是经验速率之和的平均值，即 $\\frac{1}{M}\\sum_i (N_i/T_{\\mathrm{CW},i} + N_i/T_{\\mathrm{CCW},i})$。\n3.  使用 `scipy.optimize.minimize` 和一个合适的算法（例如，L-BFGS-B，它允许设置如 $k_{\\mathrm{sum}} > 0$ 的边界）来找到使负对数似然最小化的参数值。\n4.  结果将被收集并按要求格式化。\n\n此过程将对三个数据集中的每一个独立执行。", "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for the maximum likelihood estimates of a bacterial flagellar motor\n    switching model for three separate datasets.\n    \"\"\"\n    \n    # Define the three datasets\n    # Format: ([Y], N_cw_ccw, T_cw, N_ccw_cw, T_ccw)\n    # Note: N_cw_ccw and N_ccw_cw are identical in the problem, denoted as N.\n    dataset_a = [\n        (1.5, 61, 362.4, 61, 37.6),\n        (3.0, 169, 151.0, 169, 249.0),\n        (6.0, 25, 14.6, 25, 385.4)\n    ]\n\n    dataset_b = [\n        (1.0, 82, 277.95, 82, 22.05),\n        (2.0, 257, 206.91, 257, 93.09),\n        (4.0, 244, 84.9, 244, 215.1)\n    ]\n\n    dataset_c = [\n        (0.5, 5, 492.3, 5, 7.7),\n        (1.0, 75, 250.0, 75, 250.0),\n        (2.0, 5, 7.7, 5, 492.3)\n    ]\n\n    datasets = [dataset_a, dataset_b, dataset_c]\n    all_results = []\n\n    for data in datasets:\n        \n        # Prepare data for fitting\n        # Unpack the list of tuples for easier access\n        Y, _, T_cw, N, T_ccw = zip(*data)\n        fit_data = {\n            'Y': np.array(Y),\n            'N': np.array(N),\n            'T_cw': np.array(T_cw),\n            'T_ccw': np.array(T_ccw)\n        }\n\n        # Define the negative log-likelihood function\n        def neg_log_likelihood(params, data_dict):\n            n, delta_gb, k_sum = params\n            \n            # Unpack data\n            Y_vals = data_dict['Y']\n            N_vals = data_dict['N']\n            T_cw_vals = data_dict['T_cw']\n            T_ccw_vals = data_dict['T_ccw']\n\n            # Calculate model-predicted rates for each condition\n            delta_g = delta_gb + n * np.log(Y_vals)\n            \n            # To avoid overflow in exp(delta_g), we use a stable formulation\n            # k_cw = k_sum / (1 + exp(delta_g))\n            # k_ccw = k_sum / (1 + exp(-delta_g))\n            k_cw = k_sum / (1.0 + np.exp(delta_g))\n            k_ccw = k_sum - k_cw\n            \n            # Check for invalid values which can occur during optimization\n            if np.any(k_cw = 0) or np.any(k_ccw = 0):\n                return np.inf\n\n            # Calculate the log-likelihood for each data point\n            log_L_i = (\n                N_vals * np.log(k_cw) - k_cw * T_ccw_vals +\n                N_vals * np.log(k_ccw) - k_ccw * T_cw_vals\n            )\n\n            # Total negative log-likelihood\n            return -np.sum(log_L_i)\n\n        # Generate a good initial guess (p0) for the optimizer\n        log_Y = np.log(fit_data['Y'])\n        # Handle cases where T_ccw is very small to avoid division by zero\n        # Add a small epsilon if needed, though not required for these datasets\n        log_ratio_T = np.log(fit_data['T_cw'] / fit_data['T_ccw'])\n        \n        # Linear fit: log_ratio_T = -n*log_Y - delta_gb\n        # slope = -n, intercept = -delta_gb\n        m, c = np.polyfit(log_Y, log_ratio_T, 1)\n        n0 = -m\n        delta_gb0 = -c\n\n        # Initial guess for k_sum from empirical rates\n        k_sum_empirical = (fit_data['N'] / fit_data['T_ccw']) + (fit_data['N'] / fit_data['T_cw'])\n        k_sum0 = np.mean(k_sum_empirical)\n        \n        p0 = [n0, delta_gb0, k_sum0]\n\n        # Define bounds for the parameters (k_sum must be positive)\n        bounds = [(-np.inf, np.inf), (-np.inf, np.inf), (1e-9, np.inf)]\n        \n        # Perform the minimization\n        result = optimize.minimize(neg_log_likelihood, p0, args=(fit_data,), \n                                   method='L-BFGS-B', bounds=bounds)\n        \n        n_fit, delta_gb_fit, k_sum_fit = result.x\n        \n        # Append results rounded to three decimal places\n        all_results.extend([\n            round(n_fit, 3),\n            round(delta_gb_fit, 3),\n            round(k_sum_fit, 3)\n        ])\n\n    # Format the final output string\n    output_str = f\"[{','.join([f'{x:.3f}' for x in all_results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2494022"}]}