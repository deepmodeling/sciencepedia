{"hands_on_practices": [{"introduction": "在微生物生态学中，一项基本任务是量化测序数据所揭示的群落多样性。这项练习将指导您计算关键的多样性指标——香农指数和有效物种数，更重要的是，它将这些抽象的数字与一个具体的生物学概念——功能冗余——联系起来。通过这个实践，您将学会如何从原始的相对丰度数据中解读群落的结构和潜在的生态稳定性。[@problem_id:2538719]", "problem": "通过16S核糖体核糖核酸（rRNA）扩增子测序对一份健康成年人的粪便样本进行分析，估计了八个代谢上不同的肠道细菌功能群的相对丰度，其向量为$\\big(0.35,\\,0.08,\\,0.12,\\,0.10,\\,0.07,\\,0.06,\\,0.04,\\,0.18\\big)$，按顺序代表以下类群：拟杆菌类碳水化合物广食菌、普雷沃氏菌类糖分解菌、粪杆菌类丁酸产生菌、瘤胃球菌类纤维降解菌、罗斯氏菌类丁酸产生菌、布劳特氏菌类丁酸产生菌、阿克曼氏菌类黏蛋白降解菌，以及一个混合稀有功能群。假设这八个类别完全划分了该群落，并且熵的计算使用自然对数。\n\n仅使用信息论和多样性理论的基本定义，计算该群落的香农多样性指数和相应的有效物种数（1阶希尔数）。然后，简要解释这两个值如何共同为我们理解这一正常人体肠道微生物群中短链脂肪酸产生与黏蛋白降解的功能冗余性提供预期。\n\n将所求的两个量均表示为无量纲数。将您的数值答案四舍五入到四位有效数字。您最终报告的答案应为按上述顺序排列的两个数字的有序对。", "solution": "首先将对所提供的问题进行严格验证。\n\n第1步：提取已知信息。\n问题提供了以下信息：\n- $S=8$个不同肠道细菌功能群的相对丰度向量：$\\vec{p} = \\big(0.35,\\,0.08,\\,0.12,\\,0.10,\\,0.07,\\,0.06,\\,0.04,\\,0.18\\big)$。\n- 这些功能群被确定为：1. 拟杆菌类碳水化合物广食菌，2. 普雷沃氏菌类糖分解菌，3. 粪杆菌类丁酸产生菌，4. 瘤胃球菌类纤维降解菌，5. 罗斯氏菌类丁酸产生菌，6. 布劳特氏菌类丁酸产生菌，7. 阿克曼氏菌类黏蛋白降解菌，以及8. 一个混合稀有功能群。\n- 假设这8个类别完全划分了该群落。\n- 指定熵的计算使用自然对数，$\\ln$。\n- 任务是计算两个量：香农多样性指数（$H$）和相应的有效物种数（1阶希尔数，记作$^1D$）。\n- 最后一个任务是解释这些值如何与短链脂肪酸（SCFA）产生与黏蛋白降解的功能冗余相关。\n- 最终数值答案需四舍五入到四位有效数字，并以有序对的形式呈现。\n\n第2步：使用提取的已知信息进行验证。\n评估问题的有效性。\n- 问题在科学上是合理的。它使用了微生物生态学（16S rRNA分析、细菌功能群、功能冗余）和信息论（香农多样性、希尔数）的标准概念。数据和生物学背景是现实的。\n- 问题是适定的。输入数据是相对丰度向量，而期望的输出是该向量的明确定义的数学函数。\n- 问题是自洽且一致的。一个关键的检查是相对丰度之和是否为1，以确认“完全划分”的说法。总和为$0.35 + 0.08 + 0.12 + 0.10 + 0.07 + 0.06 + 0.04 + 0.18 = 1.00$。此条件得到满足。问题没有矛盾。\n- 问题使用精确、客观的语言，计算主要量时无需主观解释。\n\n第3步：结论与行动。\n该问题有效。将提供解答。\n\n要计算的第一个量是香农多样性指数，$H$。该指数衡量在预测从群落中随机选择一个个体的身份时的不确定性（熵）。根据指定，使用自然对数的定义为：\n$$H = - \\sum_{i=1}^{S} p_i \\ln(p_i)$$\n其中$S$是功能群的数量（丰富度），$p_i$是第$i$个功能群的相对丰度。这里，$S=8$，且$p_i$的值由向量$\\vec{p}$给出。\n\n代入给定的丰度：\n$$H = - \\big[ 0.35 \\ln(0.35) + 0.08 \\ln(0.08) + 0.12 \\ln(0.12) + 0.10 \\ln(0.10) + 0.07 \\ln(0.07) + 0.06 \\ln(0.06) + 0.04 \\ln(0.04) + 0.18 \\ln(0.18) \\big]$$\n各项计算如下：\n$0.35 \\ln(0.35) \\approx -0.367437$\n$0.08 \\ln(0.08) \\approx -0.202058$\n$0.12 \\ln(0.12) \\approx -0.254431$\n$0.10 \\ln(0.10) \\approx -0.230259$\n$0.07 \\ln(0.07) \\approx -0.186148$\n$0.06 \\ln(0.06) \\approx -0.168805$\n$0.04 \\ln(0.04) \\approx -0.128755$\n$0.18 \\ln(0.18) \\approx -0.308664$\n\n这些项的总和约为$-1.846557$。因此，香农指数是：\n$$H = -(-1.846557) \\approx 1.846557$$\n四舍五入到四位有效数字，$H \\approx 1.847$。\n\n第二个量是有效物种数，它对应于$q=1$阶的希尔数，记作$^1D$。希尔数的一般公式是$^qD = \\left( \\sum_{i=1}^{S} p_i^q \\right)^{\\frac{1}{1-q}}$。对于$q=1$的特殊情况，希尔数定义为$q \\to 1$时的极限，即香农指数的指数：\n$$^1D = \\exp(H)$$\n这个量也被称为“真实多样性”，它将香农指数转换回一个直观的单位，即“等价的等丰度物种数”。为了精确，使用未四舍五入的$H$值：\n$$^1D = \\exp(1.846557) \\approx 6.33758$$\n四舍五入到四位有效数字，$^1D \\approx 6.338$。\n\n最后，需要对这些值在功能冗余背景下进行解释。香农指数$H \\approx 1.847$和相应的有效物种数$^1D \\approx 6.338$表明多样性相对较高。该群落由$S=8$个功能群组成，但其多样性相当于一个拥有约$6.34$个等丰度功能群的群落。这意味着中等的均匀度。\n\n为了评估功能冗余，我们将关键功能映射到功能群：\n1.  **SCFA产生**：此功能分布在多个功能群中。具体来说，作为一种关键SCFA的丁酸，由*Faecalibacterium*类（$p_3=0.12$）、*Roseburia*类（$p_5=0.07$）和*Blautia*类（$p_6=0.06$）功能群产生。用于此功能的总相对丰度相当可观，为$0.12 + 0.07 + 0.06 = 0.25$。这一单一功能分布在三个不同的功能群中，意味着高度的功能冗余。其中一个功能群的丧失可以由其他功能群补偿，从而保持整体功能能力。\n2.  **黏蛋白降解**：此功能明确分配给单个功能群，即*Akkermansia*类黏蛋白降解菌，其相对丰度较低，为$p_7=0.04$。这一关键功能集中在单个低丰度的功能群中，意味着低功能冗余。该特定种群的减少可能会直接导致黏蛋白降解功能的显著损害，因为没有其他功能群被列为该角色的主要执行者。\n\n总之，尽管整体群落多样性很高（$^1D/S = 6.338/8 \\approx 0.79$），但功能组织并非均匀。该系统在SCFA产生方面表现出高冗余性，但在黏蛋白降解方面则很脆弱。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.847  6.338\n\\end{pmatrix}\n}\n$$", "id": "2538719"}, {"introduction": "除了群落结构，理解其代谢功能也至关重要，而化学计量学为此提供了严谨的分析框架。本练习深入探讨了肠道核心过程——发酵的化学计量学，您将学习如何应用质量和电子守恒的基本原理来预测不同微生物功能群的代谢产物。这项实践阐明了底物利用如何塑造群落的功能特征，并将微生物相互作用与可测量的化学转化联系起来。[@problem_id:2538797]", "problem": "结肠中正常人类微生物群的一个核心生态特征是在严格缺氧条件下，可发酵碳水化合物在产生短链脂肪酸（SCFAs）的功能性群会之间进行分配。考虑肠道微生物群通常遇到的两种底物：抗性淀粉和菊粉。将两者都视为己糖当量的聚合物，因此以每己糖为基准，底物的实验式为 $\\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6}$。假设存在一个充分混合的缺氧环境，其中种间氢转移效率很高，因此发酵菌释放的任何氢分子 $\\mathrm{H}_{2}$ 都会通过以下反应立即被氢营养型产甲烷菌消耗：\n$$\n4\\,\\mathrm{H}_{2} + \\mathrm{CO}_{2} \\rightarrow \\mathrm{CH}_{4} + 2\\,\\mathrm{H}_{2}\\mathrm{O},\n$$\n从而在群落尺度上闭合电子平衡。忽略细胞生物量的形成以及乙酸、丙酸、丁酸、二氧化碳、氢气、水和甲烷以外的任何产物。\n\n三个代表性的功能性群会由其特征性的SCFA谱定义：\n- 一种产乙酸发酵菌，只产生乙酸作为SCFA。\n- 一种产丙酸发酵菌（琥珀酸-丙酸途径），产生乙酸和丙酸的混合物，且不产生 $\\mathrm{H}_{2}$。\n- 一种产丁酸发酵菌，只产生丁酸作为SCFA。\n\n仅从元素守恒（碳、氢、氧）、还原度平衡（对于无氮物种，使用 $\\gamma = 4C + H - 2O - 3N$），以及对每个群会给定的定性约束（化学计量中允许哪些物种以及是否产生 $\\mathrm{H}_{2}$）出发，推导出一个己糖当量发酵生成每个群会特征产物的电子平衡的净化学计量方程。对每个群会，使用满足其约束条件的最小非负整数化学计量系数集。\n\n然后，通过如下方式将己糖当量在群会间分配，来模拟这两种底物的群落水平发酵：\n- 抗性淀粉分配：$f_{A}^{\\mathrm{RS}} = \\frac{1}{5}$ 分配给产乙酸群会，$f_{P}^{\\mathrm{RS}} = \\frac{1}{5}$ 分配给产丙酸群会，$f_{B}^{\\mathrm{RS}} = \\frac{3}{5}$ 分配给产丁酸群会。\n- 菊粉分配：$f_{A}^{\\mathrm{IN}} = \\frac{2}{5}$ 分配给产乙酸群会，$f_{P}^{\\mathrm{IN}} = \\frac{1}{2}$ 分配给产丙酸群会，$f_{B}^{\\mathrm{IN}} = \\frac{1}{10}$ 分配给产丁酸群会。\n\n通过将各群会的特定贡献按这些分配比例进行加权求和，计算每种底物下，每摩尔发酵的己糖所产生的乙酸、丙酸和丁酸的总摩尔产率。将最终答案表示为单行矩阵，其中的条目顺序如下：\n$$\n\\left(\\text{acetate}_{\\mathrm{RS}},\\ \\text{propionate}_{\\mathrm{RS}},\\ \\text{butyrate}_{\\mathrm{RS}},\\ \\text{acetate}_{\\mathrm{IN}},\\ \\text{propionate}_{\\mathrm{IN}},\\ \\text{butyrate}_{\\mathrm{IN}}\\right),\n$$\n其中每个条目的单位是 $\\mathrm{mol\\ product\\ per\\ mol\\ hexose}$。如果您得到精确的有理数值，请以精确分数形式报告；无需四舍五入。", "solution": "该问题要求推导肠道微生物三个功能性群会的化学计量方程，并随后计算两种不同底物在群落水平上的短链脂肪酸（SCFA）产率。推导过程必须遵守元素守恒和氧化还原平衡。\n\n首先，我们定义所有相关物种的化学式和还原度 $\\gamma$，其中对于化学式为 $\\mathrm{C}_C\\mathrm{H}_H\\mathrm{O}_O$ 的物种，$\\gamma = 4C + H - 2O$。\n- 己糖（$\\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6}$）：$\\gamma = 4(6) + 12 - 2(6) = 24$。\n- 乙酸（$\\mathrm{C}_{2}\\mathrm{H}_{4}\\mathrm{O}_{2}$）：$\\gamma = 4(2) + 4 - 2(2) = 8$。\n- 丙酸（$\\mathrm{C}_{3}\\mathrm{H}_{6}\\mathrm{O}_{2}$）：$\\gamma = 4(3) + 6 - 2(2) = 14$。\n- 丁酸（$\\mathrm{C}_{4}\\mathrm{H}_{8}\\mathrm{O}_{2}$）：$\\gamma = 4(4) + 8 - 2(2) = 20$。\n- 二氧化碳（$\\mathrm{CO}_{2}$）：$\\gamma = 4(1) + 0 - 2(2) = 0$。\n- 氢分子（$\\mathrm{H}_{2}$）：$\\gamma = 4(0) + 2 - 2(0) = 2$。\n- 水（$\\mathrm{H}_{2}\\mathrm{O}$）：$\\gamma = 4(0) + 2 - 2(1) = 0$。\n- 甲烷（$\\mathrm{CH}_{4}$）：$\\gamma = 4(1) + 4 - 2(0) = 8$。\n\n问题指出，任何产生的 $\\mathrm{H}_{2}$ 都会通过反应 $4\\,\\mathrm{H}_{2} + \\mathrm{CO}_{2} \\rightarrow \\mathrm{CH}_{4} + 2\\,\\mathrm{H}_{2}\\mathrm{O}$ 被产甲烷菌消耗。对于任何产生氢气的群会，都必须包含这个耦合反应。\n\n**1. 产乙酸群会的化学计量**\n该群会只产生乙酸作为SCFA，但也可以产生 $\\mathrm{CO}_{2}$ 和 $\\mathrm{H}_{2}$。从一摩尔己糖出发的一种常见产乙酸发酵途径是：\n$$ \\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} + 2\\,\\mathrm{H}_{2}\\mathrm{O} \\rightarrow 2\\,\\mathrm{C}_{2}\\mathrm{H}_{4}\\mathrm{O}_{2} + 2\\,\\mathrm{CO}_{2} + 4\\,\\mathrm{H}_{2} $$\n该方程对于C、H、O和电子都是平衡的（$\\gamma: 24+0 = 2(8) + 2(0) + 4(2) = 16+8=24$）。\n产生的 $4$ 摩尔 $\\mathrm{H}_{2}$ 被产甲烷菌消耗，同时利用 $1$ 摩尔的 $\\mathrm{CO}_{2}$：\n$$ 4\\,\\mathrm{H}_{2} + \\mathrm{CO}_{2} \\rightarrow \\mathrm{CH}_{4} + 2\\,\\mathrm{H}_{2}\\mathrm{O} $$\n该群会的群落净反应是这两个反应之和，在消去相同项后得到：\n$$ \\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow 2\\,\\mathrm{C}_{2}\\mathrm{H}_{4}\\mathrm{O}_{2} + \\mathrm{CO}_{2} + \\mathrm{CH}_{4} $$\n该方程代表了从一个己糖出发的最小整数系数。由此，群会 A 每摩尔己糖的摩尔产率为：乙酸 $Y_{A,A} = 2$，丙酸 $Y_{P,A} = 0$，丁酸 $Y_{B,A} = 0$。\n\n**2. 产丙酸群会的化学计量**\n该群会产生乙酸和丙酸的混合物，且不产生 $\\mathrm{H}_{2}$。反应形式为：\n$$ \\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow a\\,\\mathrm{C}_{2}\\mathrm{H}_{4}\\mathrm{O}_{2} + b\\,\\mathrm{C}_{3}\\mathrm{H}_{6}\\mathrm{O}_{2} + c\\,\\mathrm{CO}_{2} + d\\,\\mathrm{H}_{2}\\mathrm{O} $$\n我们施加电子平衡约束：$\\gamma(\\text{己糖}) = a \\cdot \\gamma(\\text{乙酸}) + b \\cdot \\gamma(\\text{丙酸})$。\n$$ 24 = 8a + 14b $$\n以及碳平衡：\n$$ 6 = 2a + 3b + c $$\n琥珀酸-丙酸途径通常遵循一种化学计量，其中 $3$ 摩尔己糖产生 $2$ 摩尔乙酸和 $4$ 摩尔丙酸。让我们来验证这一点。设定比例 $a/b = 2/4 = 1/2$，因此 $b=2a$。\n代入氧化还原平衡式：$24 = 8a + 14(2a) = 8a + 28a = 36a$。这得出 $a = 24/36 = 2/3$。那么 $b = 2(2/3) = 4/3$。\n将 $a$ 和 $b$ 代入碳平衡式来求 $c$：\n$6 = 2(2/3) + 3(4/3) + c = 4/3 + 4 + c$。这得出 $c = 2 - 4/3 = 2/3$。\n每摩尔己糖的反应为：\n$$ \\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow \\frac{2}{3}\\,\\mathrm{C}_{2}\\mathrm{H}_{4}\\mathrm{O}_{2} + \\frac{4}{3}\\,\\mathrm{C}_{3}\\mathrm{H}_{6}\\mathrm{O}_{2} + \\frac{2}{3}\\,\\mathrm{CO}_{2} + d\\,\\mathrm{H}_{2}\\mathrm{O} $$\n平衡氢原子得到 $12 = \\frac{2}{3}(4) + \\frac{4}{3}(6) + 2d = \\frac{8}{3} + 8 + 2d$，所以 $4 - \\frac{8}{3} = \\frac{4}{3} = 2d$，因此 $d=2/3$。\n方程为 $\\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow \\frac{2}{3}\\,\\mathrm{C}_{2}\\mathrm{H}_{4}\\mathrm{O}_{2} + \\frac{4}{3}\\,\\mathrm{C}_{3}\\mathrm{H}_{6}\\mathrm{O}_{2} + \\frac{2}{3}\\,\\mathrm{CO}_{2} + \\frac{2}{3}\\,\\mathrm{H}_{2}\\mathrm{O}$。为了得到最小整数系数，我们乘以 $3$：$3\\,\\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow 2\\,\\mathrm{C}_{2}\\mathrm{H}_{4}\\mathrm{O}_{2} + 4\\,\\mathrm{C}_{3}\\mathrm{H}_{6}\\mathrm{O}_{2} + 2\\,\\mathrm{CO}_{2} + 2\\,\\mathrm{H}_{2}\\mathrm{O}$。\n群会 P 每摩尔己糖的摩尔产率为：乙酸 $Y_{A,P} = 2/3$，丙酸 $Y_{P,P} = 4/3$，丁酸 $Y_{B,P} = 0$。\n\n**3. 产丁酸群会的化学计量**\n该群会只产生丁酸作为SCFA，并可以产生 $\\mathrm{H}_{2}$。一种典型的平衡发酵反应是：\n$$ \\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow \\mathrm{C}_{4}\\mathrm{H}_{8}\\mathrm{O}_{2} + 2\\,\\mathrm{CO}_{2} + 2\\,\\mathrm{H}_{2} $$\n该反应对于元素和电子都是平衡的（$\\gamma: 24 = 20 + 2(0) + 2(2) = 24$）。\n产生的 $2$ 摩尔 $\\mathrm{H}_{2}$ 被产甲烷菌消耗。我们将产甲烷反应按 $1/2$ 比例缩放：\n$$ 2\\,\\mathrm{H}_{2} + \\frac{1}{2}\\,\\mathrm{CO}_{2} \\rightarrow \\frac{1}{2}\\,\\mathrm{CH}_{4} + \\mathrm{H}_{2}\\mathrm{O} $$\n群落净反应是两者之和：\n$$ \\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow \\mathrm{C}_{4}\\mathrm{H}_{8}\\mathrm{O}_{2} + \\left(2 - \\frac{1}{2}\\right)\\,\\mathrm{CO}_{2} + \\frac{1}{2}\\,\\mathrm{CH}_{4} + \\mathrm{H}_{2}\\mathrm{O} $$\n$$ \\mathrm{C}_{6}\\mathrm{H}_{12}\\mathrm{O}_{6} \\rightarrow \\mathrm{C}_{4}\\mathrm{H}_{8}\\mathrm{O}_{2} + \\frac{3}{2}\\,\\mathrm{CO}_{2} + \\frac{1}{2}\\,\\mathrm{CH}_{4} + \\mathrm{H}_{2}\\mathrm{O} $$\n群会 B 每摩尔己糖的摩尔产率为：乙酸 $Y_{A,B} = 0$，丙酸 $Y_{P,B} = 0$，丁酸 $Y_{B,B} = 1$。\n\n**4. 总SCFA产率的计算**\n每种SCFA的总产率是来自每个群会的产率的加权和，其中权重是底物分配分数。\n\n**对于抗性淀粉 (RS):**\n$f_{A}^{\\mathrm{RS}} = \\frac{1}{5}$，$f_{P}^{\\mathrm{RS}} = \\frac{1}{5}$，$f_{B}^{\\mathrm{RS}} = \\frac{3}{5}$。\n- 乙酸产率 ($\\text{acetate}_{\\mathrm{RS}}$):\n$Y_{A}^{\\mathrm{RS}} = f_{A}^{\\mathrm{RS}}Y_{A,A} + f_{P}^{\\mathrm{RS}}Y_{A,P} + f_{B}^{\\mathrm{RS}}Y_{A,B} = \\left(\\frac{1}{5}\\right)(2) + \\left(\\frac{1}{5}\\right)\\left(\\frac{2}{3}\\right) + \\left(\\frac{3}{5}\\right)(0) = \\frac{2}{5} + \\frac{2}{15} = \\frac{6+2}{15} = \\frac{8}{15}$。\n- 丙酸产率 ($\\text{propionate}_{\\mathrm{RS}}$):\n$Y_{P}^{\\mathrm{RS}} = f_{A}^{\\mathrm{RS}}Y_{P,A} + f_{P}^{\\mathrm{RS}}Y_{P,P} + f_{B}^{\\mathrm{RS}}Y_{P,B} = \\left(\\frac{1}{5}\\right)(0) + \\left(\\frac{1}{5}\\right)\\left(\\frac{4}{3}\\right) + \\left(\\frac{3}{5}\\right)(0) = \\frac{4}{15}$。\n- 丁酸产率 ($\\text{butyrate}_{\\mathrm{RS}}$):\n$Y_{B}^{\\mathrm{RS}} = f_{A}^{\\mathrm{RS}}Y_{B,A} + f_{P}^{\\mathrm{RS}}Y_{B,P} + f_{B}^{\\mathrm{RS}}Y_{B,B} = \\left(\\frac{1}{5}\\right)(0) + \\left(\\frac{1}{5}\\right)(0) + \\left(\\frac{3}{5}\\right)(1) = \\frac{3}{5}$。\n\n**对于菊粉 (IN):**\n$f_{A}^{\\mathrm{IN}} = \\frac{2}{5}$，$f_{P}^{\\mathrm{IN}} = \\frac{1}{2}$，$f_{B}^{\\mathrm{IN}} = \\frac{1}{10}$。\n- 乙酸产率 ($\\text{acetate}_{\\mathrm{IN}}$):\n$Y_{A}^{\\mathrm{IN}} = f_{A}^{\\mathrm{IN}}Y_{A,A} + f_{P}^{\\mathrm{IN}}Y_{A,P} + f_{B}^{\\mathrm{IN}}Y_{A,B} = \\left(\\frac{2}{5}\\right)(2) + \\left(\\frac{1}{2}\\right)\\left(\\frac{2}{3}\\right) + \\left(\\frac{1}{10}\\right)(0) = \\frac{4}{5} + \\frac{1}{3} = \\frac{12+5}{15} = \\frac{17}{15}$。\n- 丙酸产率 ($\\text{propionate}_{\\mathrm{IN}}$):\n$Y_{P}^{\\mathrm{IN}} = f_{A}^{\\mathrm{IN}}Y_{P,A} + f_{P}^{\\mathrm{IN}}Y_{P,P} + f_{B}^{\\mathrm{IN}}Y_{P,B} = \\left(\\frac{2}{5}\\right)(0) + \\left(\\frac{1}{2}\\right)\\left(\\frac{4}{3}\\right) + \\left(\\frac{1}{10}\\right)(0) = \\frac{4}{6} = \\frac{2}{3}$。\n- 丁酸产率 ($\\text{butyrate}_{\\mathrm{IN}}$):\n$Y_{B}^{\\mathrm{IN}} = f_{A}^{\\mathrm{IN}}Y_{B,A} + f_{P}^{\\mathrm{IN}}Y_{B,P} + f_{B}^{\\mathrm{IN}}Y_{B,B} = \\left(\\frac{2}{5}\\right)(0) + \\left(\\frac{1}{2}\\right)(0) + \\left(\\frac{1}{10}\\right)(1) = \\frac{1}{10}$。\n\n最终结果以每摩尔己糖产生多少摩尔产物的单位，按要求汇总到一个单行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{8}{15}  \\frac{4}{15}  \\frac{3}{5}  \\frac{17}{15}  \\frac{2}{3}  \\frac{1}{10}\n\\end{pmatrix}\n}\n$$", "id": "2538797"}, {"introduction": "微生物群落是动态系统，其中种群随时间相互作用，而静态分析往往无法捕捉这些动态。作为本章的总结性练习，您将从静态分析转向动态建模，构建一个常见的肠道生态基序——交叉哺育的计算模型。通过模拟这个系统，您将分析其稳定性，这是理解微生物生态系统如何响应扰动并维持其功能的关键一步。[@problem_id:2538739]", "problem": "考虑一个最小化的、质量平衡的交叉哺养模型，该模型描述了正常人体微生物群中的两种厌氧肠道共生菌：将可利用的碳水化合物转化为乳酸的 Bifidobacterium 菌群（生产者），以及将乳酸转化为丁酸的 Eubacterium hallii（也分类为 Anaerobutyricum hallii；消费者）。假设在一个混合均匀、体积恒定的肠腔段内，空间梯度可忽略不计。目标是通过模拟常微分方程组，在不同参数体系下数学分析乳酸累积的稳定性，并判断乳酸浓度是否保持在指定阈值以下。所有浓度必须以毫摩尔 (mM) 表示，所有生物量密度以克/升 (g/L) 表示，时间以小时 (h) 表示。每个测试用例的最终决策必须报告为一个布尔值，表示最终模拟时间的乳酸浓度是否低于指定的 mM 阈值。最终输出必须是包含这些布尔值的单行 Python 列表字面量，无附加文本。\n\n基本原理。使用以下经过充分检验的生物学和物理学原理：\n- 每个状态变量在隔室尺度上的质量守恒。\n- 限制性底物的可饱和生长动力学（Monod 定律）、承载量的逻辑斯谛约束以及一阶死亡。\n- 小分子代谢物的一阶清除（冲洗/吸收）。\n\n模型状态和单位：\n- $X_B$ (g/L)：Bifidobacterium 生物量密度。\n- $X_H$ (g/L)：Eubacterium hallii 生物量密度。\n- $L$ (mM)：乳酸浓度。\n- $B_u$ (mM)：丁酸浓度。\n\n参数和单位：\n- $\\mu_B$ ($\\mathrm{h}^{-1}$)：碳水化合物过量时 Bifidobacterium 的最大比生长速率。\n- $\\mu_H$ ($\\mathrm{h}^{-1}$)：Eubacterium hallii 在乳酸上的最大比生长速率。\n- $K_B$ (g/L)：Bifidobacterium 的承载量。\n- $K_H$ (g/L)：Eubacterium hallii 的承载量。\n- $K_L$ (mM)：Eubacterium hallii 吸收/利用乳酸生长的 Monod 半饱和常数。\n- $d_B$ ($\\mathrm{h}^{-1}$)，$d_H$ ($\\mathrm{h}^{-1}$)：分别为 Bifidobacterium 和 Eubacterium hallii 的一阶死亡率。\n- $k_{\\mathrm{out}}$ ($\\mathrm{h}^{-1}$)：溶解代谢物（乳酸和丁酸）的一阶清除率。\n- $y_{L|B}$ (mM/g)：每形成一克 Bifidobacterium 生物量所产生的乳酸。\n- $Y_{X|L}$ (g/mM)：每消耗一毫摩尔乳酸所形成的 Eubacterium hallii 生物量。\n- $y_{B_u|L}$ (mM/mM)：每消耗一毫摩尔乳酸所产生的丁酸。\n- $T_{\\max}$ (h)：模拟时程。\n- $L_{\\mathrm{thr}}$ (mM)：用于定义稳定性的乳酸阈值。\n\n动力学。令 $g_B$ (g/(L·h)) 表示 Bifidobacterium 的瞬时生物量形成速率，令 $g_H$ (g/(L·h)) 表示 Eubacterium hallii 的瞬时生物量形成速率。对生物量增长使用逻辑斯谛约束，对 Eubacterium hallii 使用对乳酸的 Monod 依赖性：\n- $g_B = \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B$,\n- $g_H = \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H$.\n\n设 Bifidobacterium 产生的乳酸与其生物量形成成正比 ($y_{L|B} g_B$)，而 Eubacterium hallii 消耗的乳酸与其生物量形成成正比，产率为 $Y_{X|L}$，因此乳酸消耗速率为 $\\dfrac{1}{Y_{X|L}} g_H$。丁酸的产生与乳酸的消耗成正比，产率为 $y_{B_u|L}$。包括两种群的一阶死亡和两种代谢物的一阶清除。得到的方程组为：\n$$\n\\begin{aligned}\n\\dfrac{dX_B}{dt} = g_B - d_B X_B, \\\\\n\\dfrac{dX_H}{dt} = g_H - d_H X_H, \\\\\n\\dfrac{dL}{dt} = y_{L|B} g_B - \\dfrac{1}{Y_{X|L}} g_H - k_{\\mathrm{out}} L, \\\\\n\\dfrac{dB_u}{dt} = y_{B_u|L} \\left(\\dfrac{1}{Y_{X|L}} g_H\\right) - k_{\\mathrm{out}} B_u.\n\\end{aligned}\n$$\n\n$t = 0$ 时的初始条件：\n- $X_B(0) = X_{B,0}$ (g/L),\n- $X_H(0) = X_{H,0}$ (g/L),\n- $L(0) = L_0$ (mM),\n- $B_u(0) = B_{u,0}$ (mM).\n\n乳酸累积的稳定性判据。当且仅当最终时刻的乳酸浓度低于阈值时，一个测试用例被认为是稳定的：\n$$\n\\text{稳定} \\iff L(T_{\\max}) \\le L_{\\mathrm{thr}}.\n$$\n为每个测试用例报告一个布尔值决策。所有速率单位为每小时，所有浓度单位为毫摩尔，所有生物量单位为克/升。\n\n实现要求：\n- 使用任何合适的、具有自适应步长的显式方法（例如，4 阶或 5 阶 Runge–Kutta 方法）将系统从 $t = 0$ 数值积分到 $t = T_{\\max}$。通过对速率定律中使用的状态变量使用 `max` 与 `0` 的操作，确保速率评估中的非负性。\n- 使用下面给出的参数集，不作修改。\n- 将最终决策表示为单行的 Python 列表字面量字符串，例如 $[\\text{True},\\text{False},\\dots]$。\n\n除非另有说明，所有测试用例共用的固定参数：\n- $K_B = 2.0$ g/L,\n- $K_H = 1.5$ g/L,\n- $d_B = 0.05$ $\\mathrm{h}^{-1}$,\n- $d_H = 0.05$ $\\mathrm{h}^{-1}$,\n- $k_{\\mathrm{out}} = 0.05$ $\\mathrm{h}^{-1}$,\n- $Y_{X|L} = 0.05$ g/mM,\n- $y_{B_u|L} = 0.5$ mM/mM,\n- $T_{\\max} = 200.0$ h,\n- $L_{\\mathrm{thr}} = 10.0$ mM.\n\n测试套件。模拟以下四个参数集，每个参数集提供一个自洽且生物学上合理的体系。对每个参数集，使用上述稳定性判据产生一个布尔决策。\n\n- 案例 1（基线理想路径；预期稳定）：$X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.05$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.50$ $\\mathrm{h}^{-1}$, $K_L = 1.0$ mM, $y_{L|B} = 20.0$ mM/g。\n- 案例 2（无消费者；累积的边界情况）：$X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.0$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.50$ $\\mathrm{h}^{-1}$, $K_L = 1.0$ mM, $y_{L|B} = 20.0$ mM/g。\n- 案例 3（高消费者能力；强清除作用）：$X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.10$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.80$ $\\mathrm{h}^{-1}$, $K_H = 3.0$ g/L, $K_L = 1.0$ mM, $y_{L|B} = 25.0$ mM/g。\n- 案例 4（乳酸亲和力低；消费者在低乳酸浓度下难以生长）：$X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.05$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.50$ $\\mathrm{h}^{-1}$, $K_L = 50.0$ mM, $y_{L|B} = 20.0$ mM/g。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[\\text{True},\\text{False},\\text{True},\\text{False}]$），按顺序对应案例 1 到 4。", "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n\n状态变量：\n- $X_B$ (g/L)：Bifidobacterium 生物量密度。\n- $X_H$ (g/L)：Eubacterium hallii 生物量密度。\n- $L$ (mM)：乳酸浓度。\n- $B_u$ (mM)：丁酸浓度。\n\n参数：\n- $\\mu_B$ ($\\mathrm{h}^{-1}$)：Bifidobacterium 的最大比生长速率。\n- $\\mu_H$ ($\\mathrm{h}^{-1}$)：Eubacterium hallii 的最大比生长速率。\n- $K_B$ (g/L)：Bifidobacterium 的承载量。\n- $K_H$ (g/L)：Eubacterium hallii 的承载量。\n- $K_L$ (mM)：乳酸吸收的 Monod 常数。\n- $d_B$ ($\\mathrm{h}^{-1}$)，$d_H$ ($\\mathrm{h}^{-1}$)：死亡率。\n- $k_{\\mathrm{out}}$ ($\\mathrm{h}^{-1}$)：代谢物清除率。\n- $y_{L|B}$ (mM/g)：Bifidobacterium 生物量的乳酸产率。\n- $Y_{X|L}$ (g/mM)：Eubacterium hallii 在乳酸上的生物量产率。\n- $y_{B_u|L}$ (mM/mM)：乳酸的丁酸产率。\n- $T_{\\max}$ (h)：模拟时程。\n- $L_{\\mathrm{thr}}$ (mM)：乳酸阈值。\n\n动力学：\n瞬时生长速率：\n- $g_B = \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B$\n- $g_H = \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H$\n\n常微分方程组 (ODEs)：\n$$\n\\begin{aligned}\n\\dfrac{dX_B}{dt} = g_B - d_B X_B \\\\\n\\dfrac{dX_H}{dt} = g_H - d_H X_H \\\\\n\\dfrac{dL}{dt} = y_{L|B} g_B - \\dfrac{1}{Y_{X|L}} g_H - k_{\\mathrm{out}} L \\\\\n\\dfrac{dB_u}{dt} = y_{B_u|L} \\left(\\dfrac{1}{Y_{X|L}} g_H\\right) - k_{\\mathrm{out}} B_u\n\\end{aligned}\n$$\n\n初始条件：\n$X_B(0) = X_{B,0}$, $X_H(0) = X_{H,0}$, $L(0) = L_0$, $B_u(0) = B_{u,0}$。\n\n稳定性判据：\n$\\text{稳定} \\iff L(T_{\\max}) \\le L_{\\mathrm{thr}}$。\n\n固定参数：\n$K_B = 2.0$ g/L, $K_H = 1.5$ g/L, $d_B = 0.05$ $\\mathrm{h}^{-1}$, $d_H = 0.05$ $\\mathrm{h}^{-1}$, $k_{\\mathrm{out}} = 0.05$ $\\mathrm{h}^{-1}$, $Y_{X|L} = 0.05$ g/mM, $y_{B_u|L} = 0.5$ mM/mM, $T_{\\max} = 200.0$ h, $L_{\\mathrm{thr}} = 10.0$ mM。\n\n测试案例：\n- 案例 1：$X_{B,0} = 0.1$, $X_{H,0} = 0.05$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.50$, $K_L = 1.0$, $y_{L|B} = 20.0$。\n- 案例 2：$X_{B,0} = 0.1$, $X_{H,0} = 0.0$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.50$, $K_L = 1.0$, $y_{L|B} = 20.0$。\n- 案例 3：$X_{B,0} = 0.1$, $X_{H,0} = 0.10$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.80$, $K_H = 3.0$, $K_L = 1.0$, $y_{L|B} = 25.0$。\n- 案例 4：$X_{B,0} = 0.1$, $X_{H,0} = 0.05$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.50$, $K_L = 50.0$, $y_{L|B} = 20.0$。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n对问题进行有效性分析：\n1.  **科学依据**：该模型基于微生物种群动力学的既定原则：资源有限种群的逻辑斯谛增长和底物限制生长的 Monod 动力学。这些是数学生态学和系统生物学中的标准方法。该模型描述了肠道微生物群中一种合理的交叉哺养相互作用。它在科学上是合理的。\n2.  **良构性**：该问题是一个常微分方程组的初值问题 (IVP)。速率函数是连续且局部 Lipschitz 的，这保证了对于给定的一组初始条件和参数，解的存在性和唯一性。任务是找到在特定时间 $T_{\\max}$ 的状态，并应用一个明确的决策判据。该问题是良构的。\n3.  **客观性**：问题以精确的数学和定量术语陈述。所有参数、变量和判据都得到了客观定义。没有主观性语言。\n4.  **完整性与一致性**：为每个测试案例提供了所有必要的参数和初始条件。单位是一致的。没有矛盾之处。\n5.  **可行性**：参数值在微生物代谢和生长的生物学合理范围内。该模拟在计算上是可行的。\n\n**第 3 步：结论与行动**\n\n该问题是**有效的**。它是一个定义明确、有科学依据且可解的计算系统生物学问题。将提供解决方案。\n\n**求解方法**\n\n该问题要求对一个包含四个耦合非线性常微分方程的系统进行数值积分。这构成一个初值问题 (IVP)，可以表示为向量形式 $\\dfrac{d\\mathbf{y}}{dt} = f(t, \\mathbf{y}, \\mathbf{p})$，其中 $\\mathbf{y}(t)$ 是状态向量，$\\mathbf{p}$ 是参数向量。\n\n状态向量定义为：\n$$\n\\mathbf{y}(t) = \\begin{bmatrix} X_B(t) \\\\ X_H(t) \\\\ L(t) \\\\ B_u(t) \\end{bmatrix}\n$$\n\n常微分方程组由以下公式给出：\n$$\n\\begin{aligned}\n\\dfrac{dX_B}{dt} = \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B - d_B X_B \\\\\n\\dfrac{dX_H}{dt} = \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H - d_H X_H \\\\\n\\dfrac{dL}{dt} = y_{L|B} \\left[ \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B \\right] - \\dfrac{1}{Y_{X|L}} \\left[ \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H \\right] - k_{\\mathrm{out}} L \\\\\n\\dfrac{dB_u}{dt} = \\dfrac{y_{B_u|L}}{Y_{X|L}} \\left[ \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H \\right] - k_{\\mathrm{out}} B_u\n\\end{aligned}\n$$\n\n为求解此系统，需要一个数值 ODE 求解器。SciPy 库中的 `scipy.integrate.solve_ivp` 函数适用于此任务。它提供了多种积分方法，包括一个 5(4) 阶的显式 Runge-Kutta 方法 (Dormand-Prince, `RK45`)，该方法使用自适应步长来控制局部误差。对于如此处呈现的非刚性问题，此方法是稳健且高效的。\n\n实现将按以下步骤进行：\n$1$. 定义一个 Python 函数来表示 ODE 系统的右侧 $f(t, \\mathbf{y}, \\mathbf{p})$。此函数将接收当前时间 $t$、状态向量 $\\mathbf{y}$ 和参数集合 $\\mathbf{p}$ 作为输入，并返回导数向量 $\\dfrac{d\\mathbf{y}}{dt}$。根据问题的要求，在该函数内部，状态变量在用于速率计算之前，将使用 $\\max(0, \\cdot)$ 强制其非负性，以防止数值伪影。\n\n$2$. 对于四个测试案例中的每一个，将组装相应的初始条件 $\\mathbf{y}(0) = [X_{B,0}, X_{H,0}, L_0, B_{u,0}]^T$ 和参数集。\n\n$3$. 使用 ODE 函数、时间区间 $[0, T_{\\max}]$、初始条件向量 $\\mathbf{y}(0)$、指定的方法 (`RK45`) 和参数集来调用 `scipy.integrate.solve_ivp`。\n\n$4$. 积分完成后，将检索最终状态向量 $\\mathbf{y}(T_{\\max})$。乳酸浓度 $L(T_{\\max})$ 对应于此向量的第三个元素。\n\n$5$. 评估稳定性判据 $L(T_{\\max}) \\le L_{\\mathrm{thr}}$。其结果是一个布尔值（稳定为 `True`，不稳定为 `False`），将为每个案例存储。\n\n$6$. 最后，将所有四个案例的布尔结果列表格式化为指定的字符串格式：一个用方括号括起来的 Python 列表字面量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the cross-feeding microbial dynamics problem for the given test cases.\n    \"\"\"\n\n    # Fixed parameters common to all test cases\n    fixed_params = {\n        'K_B': 2.0,      # g/L\n        'K_H': 1.5,      # g/L (default, case 3 overrides)\n        'd_B': 0.05,     # h^-1\n        'd_H': 0.05,     # h^-1\n        'k_out': 0.05,   # h^-1\n        'Y_X|L': 0.05,   # g/mM\n        'y_Bu|L': 0.5,   # mM/mM\n        'T_max': 200.0,  # h\n        'L_thr': 10.0,   # mM\n    }\n\n    # Test suite: four parameter sets\n    test_cases = [\n        # Case 1: baseline ideal path\n        {\n            'X_B0': 0.1, 'X_H0': 0.05, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.50, 'K_L': 1.0, 'y_L|B': 20.0\n        },\n        # Case 2: no consumer\n        {\n            'X_B0': 0.1, 'X_H0': 0.0, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.50, 'K_L': 1.0, 'y_L|B': 20.0\n        },\n        # Case 3: high consumer capacity\n        {\n            'X_B0': 0.1, 'X_H0': 0.10, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.80, 'K_H': 3.0, 'K_L': 1.0, 'y_L|B': 25.0\n        },\n        # Case 4: low lactate affinity\n        {\n            'X_B0': 0.1, 'X_H0': 0.05, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.50, 'K_L': 50.0, 'y_L|B': 20.0\n        },\n    ]\n\n    def ode_system(t, y, p):\n        \"\"\"\n        Defines the system of ordinary differential equations for the microbial model.\n        Args:\n            t (float): Time.\n            y (array-like): State vector [X_B, X_H, L, B_u].\n            p (dict): Dictionary of parameters.\n\n        Returns:\n            list: The vector of derivatives [dX_B/dt, dX_H/dt, dL/dt, dB_u/dt].\n        \"\"\"\n        X_B, X_H, L, B_u = y\n\n        # Enforce non-negativity for rate calculations as per problem specification\n        X_B_nn = max(0, X_B)\n        X_H_nn = max(0, X_H)\n        L_nn = max(0, L)\n\n        # Instantaneous biomass formation rates\n        g_B = p['mu_B'] * (1 - X_B_nn / p['K_B']) * X_B_nn\n        g_H = p['mu_H'] * (L_nn / (p['K_L'] + L_nn)) * (1 - X_H_nn / p['K_H']) * X_H_nn\n        \n        # Ensure growth rates are non-negative\n        g_B = max(0, g_B)\n        g_H = max(0, g_H)\n\n        # Differential equations\n        dX_B_dt = g_B - p['d_B'] * X_B\n        dX_H_dt = g_H - p['d_H'] * X_H\n        dL_dt = p['y_L|B'] * g_B - (1 / p['Y_X|L']) * g_H - p['k_out'] * L\n        dB_u_dt = p['y_Bu|L'] * (1 / p['Y_X|L']) * g_H - p['k_out'] * B_u\n        \n        return [dX_B_dt, dX_H_dt, dL_dt, dB_u_dt]\n\n    results = []\n    \n    for case_config in test_cases:\n        # Combine fixed and case-specific parameters\n        params = fixed_params.copy()\n        params.update(case_config)\n\n        # Initial conditions\n        y0 = [params['X_B0'], params['X_H0'], params['L0'], params['Bu0']]\n        \n        # Time span for integration\n        t_span = [0, params['T_max']]\n\n        # Numerically integrate the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=t_span,\n            y0=y0,\n            method='RK45',\n            args=(params,),\n            dense_output=True\n        )\n        \n        # Get the final lactate concentration\n        final_lactate_concentration = sol.y[2, -1]\n        \n        # Apply the stability criterion\n        is_stable = final_lactate_concentration = params['L_thr']\n        results.append(is_stable)\n\n    # Format the final output as a Python list literal string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2538739"}]}