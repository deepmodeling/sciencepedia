{"hands_on_practices": [{"introduction": "微生物组分析通常依赖于测序得出的相对丰度数据，但这可能导致解读上的陷阱。本练习将通过动手实践，展示“组成偏差”（compositional bias），即总微生物载量的变化可以导致单个分类单元丰度出现虚假的表观变化。通过计算相对丰度对数倍数变化 $L_{\\mathrm{rel}}$ 和绝对丰度对数倍数变化 $L_{\\mathrm{abs}}$ 之间的差异 [@problem_id:2538319]，您将对为何绝对丰度测量或专门的成分数据分析技术对于得出稳健结论至关重要，获得关键且定量的理解。", "problem": "一项关于肠道微生物组的病例对照研究，采用流式细胞术结合16S核糖体核糖核酸扩增子测序技术，测量了每克粪便中的微生物绝对丰度。考虑一个简化的群落，其中包含$3$个优势分类单元，记为$T_1$、$T_2$和$T_3$。在对照组中，测得的绝对丰度（细胞数/克）为 $x_1^{(0)} = 10^{6}$，$x_2^{(0)} = 10^{9}$ 和 $x_3^{(0)} = 10^{9}$。在疾病组中，其绝对丰度为 $x_1^{(1)} = 10^{6}$，$x_2^{(1)} = 5 \\times 10^{8}$ 和 $x_3^{(1)} = 5 \\times 10^{8}$。假设测序产生的相对丰度等于绝对比例（即，无分类单元特异性扩增偏倚），因此在条件k下，分类单元i的相对丰度为 $\\tilde{x}_i^{(k)} = x_i^{(k)} / \\sum_{j=1}^{3} x_j^{(k)}$。\n\n定义在相对丰度分析下，分类单元$T_1$的观测log$_2$倍数变化为 $L_{\\mathrm{rel}} = \\log_{2}\\!\\left(\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}\\right)$，并定义基于绝对丰度的真实log$_2$倍数变化为 $L_{\\mathrm{abs}} = \\log_{2}\\!\\left(x_1^{(1)} / x_1^{(0)}\\right)$。定义$T_1$的组分偏倚为 $B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$。\n\n仅使用组分数据的第一性原理（即相对丰度总和受限于1，且等于绝对丰度除以总载量）和所提供的计数，计算$T_1$的$B$值。然后，简要论证一种在$T_1$与疾病状态的关联分析中能够消除或恰当重新解释这种偏倚的方法，该方法可使用绝对丰度或组分平衡。\n\n将$B$的最终值以单个无量纲数的形式报告，并将您的答案四舍五入至4位有效数字。", "solution": "对所提供的问题进行验证。\n\n逐字提取已知条件：\n- 一个群落有$3$个分类单元：$T_1$、$T_2$、$T_3$。\n- 对照组绝对丰度（细胞数/克）：$x_1^{(0)} = 10^{6}$，$x_2^{(0)} = 10^{9}$ 和 $x_3^{(0)} = 10^{9}$。\n- 疾病组绝对丰度（细胞数/克）：$x_1^{(1)} = 10^{6}$，$x_2^{(1)} = 5 \\times 10^{8}$ 和 $x_3^{(1)} = 5 \\times 10^{8}$。\n- 相对丰度定义：对于条件 $k \\in \\{0, 1\\}$，$\\tilde{x}_i^{(k)} = x_i^{(k)} / \\sum_{j=1}^{3} x_j^{(k)}$。\n- $T_1$的观测相对log$_2$倍数变化：$L_{\\mathrm{rel}} = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)}}{\\tilde{x}_1^{(0)}}\\right)$。\n- $T_1$的真实绝对log$_2$倍数变化：$L_{\\mathrm{abs}} = \\log_{2}\\!\\left(\\frac{x_1^{(1)}}{x_1^{(0)}}\\right)$。\n- $T_1$的组分偏倚：$B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$。\n- 任务是计算$T_1$的$B$值，报告至4位有效数字，并论证一种减轻此偏倚的分析方法。\n\n验证开始。\n该问题具有科学依据。它探讨了微生物组数据分析中组分性的基本问题，这是一个公认的概念。相对丰度数据可能产生伪相关这一前提是该领域的一个主要课题。所提供的数据值是合理的。该问题是良定的，为$B$的唯一解提供了所有必要的定义和数据。语言客观且技术性强。该问题未违反任何无效标准。\n\n结论：该问题有效。将制定解决方案。\n\n组分偏倚$B$定义为由相对丰度计算的对数倍数变化与由绝对丰度计算的对数倍数变化之差。\n$$B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$$\n代入$L_{\\mathrm{rel}}$和$L_{\\mathrm{abs}}$的定义：\n$$B = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)}}{\\tilde{x}_1^{(0)}}\\right) - \\log_{2}\\!\\left(\\frac{x_1^{(1)}}{x_1^{(0)}}\\right)$$\n使用对数性质 $\\log(a) - \\log(b) = \\log(a/b)$，我们合并这些项：\n$$B = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}}{x_1^{(1)} / x_1^{(0)}}\\right) = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)}}{\\tilde{x}_1^{(0)}} \\cdot \\frac{x_1^{(0)}}{x_1^{(1)}}\\right)$$\n相对丰度$\\tilde{x}_i^{(k)}$定义为绝对丰度$x_i^{(k)}$除以总微生物载量$S^{(k)} = \\sum_{j=1}^{3} x_j^{(k)}$。我们将此定义代入$\\tilde{x}_1^{(1)}$和$\\tilde{x}_1^{(0)}$：\n$$B = \\log_{2}\\!\\left(\\frac{x_1^{(1)}/S^{(1)}}{x_1^{(0)}/S^{(0)}} \\cdot \\frac{x_1^{(0)}}{x_1^{(1)}}\\right)$$\n绝对丰度项$x_1^{(1)}$和$x_1^{(0)}$相互抵消，揭示出偏倚仅取决于两种条件之间总微生物载量的变化：\n$$B = \\log_{2}\\!\\left(\\frac{S^{(0)}}{S^{(1)}}\\right)$$\n对于任何绝对丰度不变的分类单元，这个结果都是普遍适用的。其在相对丰度上的表观变化完全是由总和的变化驱动的人为结果。\n\n首先，我们计算对照组（$k=0$）的总绝对丰度：\n$$S^{(0)} = x_1^{(0)} + x_2^{(0)} + x_3^{(0)} = 10^{6} + 10^{9} + 10^{9} = 1 \\times 10^{6} + 2 \\times 10^{9} = 2001 \\times 10^{6} = 2.001 \\times 10^{9}$$\n接下来，我们计算疾病组（$k=1$）的总绝对丰度：\n$$S^{(1)} = x_1^{(1)} + x_2^{(1)} + x_3^{(1)} = 10^{6} + 5 \\times 10^{8} + 5 \\times 10^{8} = 10^{6} + 10 \\times 10^{8} = 10^{6} + 10^{9} = 1001 \\times 10^{6} = 1.001 \\times 10^{9}$$\n现在我们计算偏倚$B$：\n$$B = \\log_{2}\\!\\left(\\frac{2.001 \\times 10^{9}}{1.001 \\times 10^{9}}\\right) = \\log_{2}\\!\\left(\\frac{2.001}{1.001}\\right)$$\n使用对数的换底公式 $\\log_a(x) = \\frac{\\ln(x)}{\\ln(a)}$：\n$$B = \\frac{\\ln(1.999000999...)}{\\ln(2)} \\approx \\frac{0.69264746}{0.69314718} \\approx 0.99927909$$\n四舍五入到4位有效数字，我们得到$B = 0.9993$。\n$T_1$的真实对数倍数变化是 $L_{\\mathrm{abs}} = \\log_{2}(10^6 / 10^6) = \\log_{2}(1) = 0$。表观对数倍数变化是 $L_{\\mathrm{rel}} = B+L_{\\mathrm{abs}} \\approx 0.9993$。这表明，相对丰度分析会错误地暗示分类单元$T_1$的丰度大约增加了一倍（$\\log_{2}(2) = 1$），而实际上其绝对丰度保持不变。\n\n为解决此偏倚，存在两种主要方法：\n\n1.  **绝对丰度分析**：最直接且科学上合理的方法是放弃相对丰度分析，直接对绝对丰度数据（$x_i^{(k)}$）进行统计检验。题目说明这些数据已被获取。通过分析这些值（通常在进行对数转换，例如$\\ln(x_i^{(k)} + 1)$以稳定方差后），可以直接检验关于真正关注的量——细胞绝对数量的假设。这种方法完全消除了组分偏倚，因为分母$S^{(k)}$从未被引入计算中。在本问题中，这样的分析将正确地得出$L_{\\mathrm{abs}}=0$，从而得出$T_1$的绝对计数与疾病状态无关的正确结论。\n\n2.  **对数比分析（组分数据分析）**：如果绝对丰度数据不可用，只能使用相对丰度（$\\tilde{x}_i^{(k)}$），则必须采用为组分数据设计的方法。Aitchison几何学为此提供了一个框架。分析的不是单个组分，而是组分的对数比。例如，可以定义一个等距对数比（ilr）平衡，如 $z = \\ln\\left(\\frac{\\tilde{x}_1}{\\sqrt{\\tilde{x}_2 \\tilde{x}_3}}\\right)$。然后检验该平衡在组间的变化。这样的比率对数据的缩放是不变的（即，对于绝对丰度和相对丰度，其值相同：$\\ln\\left(\\frac{x_1/S}{\\sqrt{(x_2/S)(x_3/S)}}\\right) = \\ln\\left(\\frac{x_1}{\\sqrt{x_2 x_3}}\\right)$）。这种方法不能恢复$T_1$的绝对变化。相反，它将分析性问题从“$T_1$的变化是什么？”重新解释为“$T_1$与$T_2$和$T_3$的几何平均值之比的变化是什么？”。这是一个有效且良定的问题，但其解释根本不同。它正确地识别出微生物生态系统的结构相对于$T_1$发生了变化，但将此变化恰当地归因于组分间的比率，而不是单个组分的错误变化。\n\n总之，使用绝对丰度数据是更优越的，因为它直接处理具有生物学意义的量。如果仅限于相对数据，对数比分析提供了一个数学上严谨的框架，但需要对科学假设进行谨慎的重新解释。", "answer": "$$\n\\boxed{0.9993}\n$$", "id": "2538319"}, {"introduction": "除了表征群落结构，一个关键目标是模拟微生物组的功能输出。本练习将微生物生态学中的经典工具——恒化器模型（chemostat model）——应用于人体结肠，以理解短链脂肪酸丁酸盐的动态。通过基于生产速率 $p$、稀释率 $D$ 和宿主吸收速率 $k_{a}$ 推导其稳态浓度 $C^{\\\\ast}$ [@problem_id:2538322]，您将学会构建简单而强大的模型，将微生物代谢与宿主体内生理相关的代谢物水平联系起来。", "problem": "人体结肠腔内一个充分混合的区段可以被模拟为一个恒化器，其中丁酸盐的浓度（记为 $C(t)$）由于微生物的产生、腔内流动的对流冲刷以及宿主上皮细胞的一级吸收而发生变化。假设如下：\n\n- 系统是充分混合的，并且体积有效恒定，因此可以忽略空间梯度，使用单一浓度 $C(t)$ 即可。\n- 小肠流入物中的丁酸盐含量可忽略不计，因此流入浓度 $C_{\\mathrm{in}}$ 可取为 $0$。\n- 在微生物群和底物供应稳定的情况下，控制体积内的微生物丁酸盐净产量近似为一个恒定的体积速率 $p$（单位为 $\\mathrm{mM}\\,\\mathrm{h}^{-1}$）。\n- 腔内流动产生一个稀释率 $D$（单位为 $\\mathrm{h}^{-1}$）。\n- 宿主上皮细胞的吸收遵循一级动力学，速率常数为 $k_{a}$（单位为 $\\mathrm{h}^{-1}$）。\n\n从一个开放、充分混合的控制体积的质量守恒出发，推导出 $C(t)$ 的常微分方程，并以 $p$、$D$ 和 $k_{a}$ 的闭合形式确定唯一的全局稳定稳态浓度 $C^{\\ast}$。然后，使用 $p = 16\\,\\mathrm{mM}\\,\\mathrm{h}^{-1}$，$D = 0.3\\,\\mathrm{h}^{-1}$ 和 $k_{a} = 0.9\\,\\mathrm{h}^{-1}$ 对 $C^{\\ast}$ 进行数值计算。将最终数值答案四舍五入至四位有效数字。最终浓度以 $\\mathrm{mM}$ 表示。", "solution": "所述问题具有科学依据、提法恰当且客观。它展示了一个标准的恒化器模型——这是生物化学工程和微生物生态学中的一个基本工具——并将其应用于相关的生理学背景。参数和假设定义清晰且一致，可以得出一个唯一且稳定的解。因此，该问题是有效的，我们将着手进行其形式化求解。\n\n基本原理是在一个确定的控制体积 $V$ 内丁酸盐的质量守恒，我们将其模拟为一个充分混合的恒化器。一般的质量平衡方程指出，体积内物质的累积速率等于流入速率减去流出速率，再加上体积内的净生成速率。\n设 $C(t)$ 为时间 $t$ 时丁酸盐的浓度，单位为 $\\mathrm{mM}$。控制体积 $V$ 中丁酸盐的总量为 $V C(t)$。因此，累积速率为 $\\frac{d}{dt}[V C(t)]$。由于假设体积 $V$ 是恒定的，该项可简化为 $V \\frac{dC(t)}{dt}$。\n\n我们现在构建质量平衡的每一项：\n$1$. 流入速率：进入系统的体积流量为 $F$。稀释率由 $D = \\frac{F}{V}$ 给出。丁酸盐的流入速率为 $F C_{\\mathrm{in}}$。问题指出流入浓度 $C_{\\mathrm{in}}$ 可忽略不计，因此我们取 $C_{\\mathrm{in}} = 0$。于是，流入项为 $0$。\n$2$. 流出速率：流出通过对流发生，体积流量与流入相同，为 $F$。由于充分混合的假设，流出物中丁酸盐的浓度为 $C(t)$。丁酸盐的流出速率为 $F C(t)$。代入 $F = D V$，该项变为 $D V C(t)$。\n$3$. 生成速率：微生物净产生丁酸盐的速率为一个恒定的体积速率 $p$。因此，在体积 $V$ 内的总生成速率为 $p V$。\n$4$. 消耗速率：宿主上皮细胞的吸收被模拟为速率常数为 $k_a$ 的一级过程。这意味着吸收速率与浓度 $C(t)$ 成正比。作为一个体积过程，在体积 $V$ 内的总消耗速率为 $k_a V C(t)$。\n\n将这些项组合到质量平衡方程中：\n$$V \\frac{dC(t)}{dt} = (\\text{流入}) - (\\text{流出}) + (\\text{生成}) - (\\text{消耗})$$\n$$V \\frac{dC(t)}{dt} = 0 - D V C(t) + p V - k_a V C(t)$$\n体积 $V$ 是所有项的公因子，可以消去（假设 $V > 0$）：\n$$\\frac{dC(t)}{dt} = p - D C(t) - k_a C(t)$$\n这可以整理成 $C(t)$ 的常微分方程的最终形式：\n$$\\frac{dC(t)}{dt} = p - (D + k_a) C(t)$$\n这是一个线性、一阶、非齐次、常系数常微分方程。\n\n为了求得稳态浓度，记为 $C^{\\ast}$，我们将浓度变化率设为零，即 $\\frac{dC}{dt} = 0$。\n$$0 = p - (D + k_a) C^{\\ast}$$\n解出 $C^{\\ast}$，得到稳态浓度的符号表达式：\n$$C^{\\ast} = \\frac{p}{D + k_a}$$\n这个稳态是全局稳定的。为了证明这一点，考虑一个偏离稳态的微小扰动 $\\epsilon(t)$，使得 $C(t) = C^{\\ast} + \\epsilon(t)$。将其代入常微分方程中：\n$$\\frac{d}{dt}(C^{\\ast} + \\epsilon(t)) = p - (D + k_a)(C^{\\ast} + \\epsilon(t))$$\n$$\\frac{d\\epsilon(t)}{dt} = p - (D + k_a)C^{\\ast} - (D + k_a)\\epsilon(t)$$\n由于 $p = (D + k_a)C^{\\ast}$，扰动方程简化为：\n$$\\frac{d\\epsilon(t)}{dt} = -(D + k_a)\\epsilon(t)$$\n其解为 $\\epsilon(t) = \\epsilon(0) \\exp(-(D+k_a)t)$。由于参数 $D$ 和 $k_a$ 代表物理速率，它们必须是非负的。从给定的数值可知，$D = 0.3\\,\\mathrm{h}^{-1} > 0$ 且 $k_a = 0.9\\,\\mathrm{h}^{-1} > 0$。因此，项 $(D + k_a)$ 是严格为正的，指数项会随着 $t \\to \\infty$ 而衰减至零。任何对稳态的偏离都会衰减，这证实了 $C^{\\ast}$ 是一个唯一的、全局稳定的平衡点。\n\n现在，我们使用给定的数值对 $C^{\\ast}$ 进行计算：\n$p = 16\\,\\mathrm{mM}\\,\\mathrm{h}^{-1}$\n$D = 0.3\\,\\mathrm{h}^{-1}$\n$k_a = 0.9\\,\\mathrm{h}^{-1}$\n\n将这些值代入 $C^{\\ast}$ 的表达式中：\n$$C^{\\ast} = \\frac{16}{0.3 + 0.9} = \\frac{16}{1.2}$$\n进行计算：\n$$C^{\\ast} = \\frac{16}{\\frac{12}{10}} = \\frac{160}{12} = \\frac{40}{3}$$\n作为小数，这是 $13.333... \\, \\mathrm{mM}$。问题要求将答案四舍五入到四位有效数字。\n$$C^{\\ast} \\approx 13.33 \\, \\mathrm{mM}$$", "answer": "$$\\boxed{13.33}$$", "id": "2538322"}, {"introduction": "这项高级练习将微生物代谢和宿主-微生物相互作用的概念整合到一个多尺度机理模型中。您将从第一性原理出发，构建一个模型，将丁酸盐浓度 $B$ 与其对宿主T细胞的下游效应——抑制组蛋白去乙酰化酶 (HDAC) 及随后产生的抗炎细胞因子IL-10——联系起来。这项练习 [@problem_id:2538359] 将挑战您将分子结合事件（由 $K_i$ 和 $h$ 描述）与最终的细胞分泌通量 $J$ 联系起来的能力，为剖析复杂的宿主-微生物组信号通路所使用的定量系统生物学方法提供必要的实践。", "problem": "您的任务是构建并评估一个第一性原理机理模型，该模型将结肠中的微生物丁酸盐浓度与结肠T细胞中的组蛋白去乙酰化酶（HDAC）抑制以及由此产生的每个细胞的白细胞介素-10（IL-10）稳态分泌通量联系起来。您的程序必须计算下文指定的一小组测试场景的稳态IL-10分泌通量，并将结果打印为用方括号括起来的单个逗号分隔列表。\n\n该模型必须基于以下基本原理和假设进行推导，这些原理和假设应被视为出发点：\n\n- 使用源于质量作用定律的平衡配体结合来模拟丁酸盐对HDAC的占据。假设丁酸盐以表观解离常数 $K_i$ 和由希尔系数 $h$ 描述的协同性与HDAC结合，条件是游离丁酸盐浓度等于所提供的细胞外浓度 $B$（单位为毫摩尔，mM）。以此为基础，推导出丁酸盐对HDAC的分数占据率，从而得出未受抑制（活性）的HDAC的分数。\n\n- 使用一级平衡模型来模拟IL-10基因座上乙酰化组蛋白的分数 $A(t)$，该平衡涉及组蛋白乙酰转移酶（HAT）以速率常数 $k_{\\text{hat}}$ 进行的乙酰化作用，以及HDAC以依赖于活性HDAC分数的有效速率常数 $k_{\\text{d,eff}}(B)$ 进行的去乙酰化作用。使用双态乙酰化模型 $A \\in [0,1]$，其中 $dA/dt$ 由基于这些速率的线性流入-流出平衡控制，并确定稳态分数 $A^\\ast$。\n\n- 假设每个细胞的IL-10 mRNA合成速率 $s_m$ 随 $A^\\ast$ 线性增加，即 $s_m = r_0 + \\alpha A^\\ast$，其中 $r_0$ 是基础合成速率，$\\alpha$ 是乙酰化依赖性增量。信使RNA（mRNA）以一级速率常数 $\\delta_m$ 降解，得到稳态mRNA拷贝数 $M^\\ast$。\n\n- 蛋白质以翻译速率常数 $k_{\\text{tl}}$ （蛋白质/mRNA·小时）产生，细胞内IL-10蛋白池 $P^\\ast$ 受一级损失控制，速率常数为 $\\delta_p$ （主要由分泌和更新主导）。在稳态下，每个细胞的分泌通量为 $J = k_{\\text{sec}} P^\\ast$。将 $J$ 以每细胞每小时分子数为单位，表示为十进制数。\n\n参数值固定如下，且必须严格按照给定值使用：\n\n- 解离常数 $K_i = 0.5$ mM。\n- 希尔系数 $h = 2$。\n- 基线HDAC去乙酰化速率常数 $k_{\\text{d0}} = 1.0$ $\\text{h}^{-1}$。\n- HAT速率常数 $k_{\\text{hat}}$ 在每个测试用例中有所不同（单位为 $\\text{h}^{-1}$）。\n- 基础IL-10 mRNA合成速率 $r_0 = 2.0$ 分子数 $\\text{cell}^{-1}\\,\\text{h}^{-1}$。\n- 乙酰化依赖性增量 $\\alpha = 20.0$ 分子数 $\\text{cell}^{-1}\\,\\text{h}^{-1}$。\n- mRNA降解速率 $\\delta_m = \\ln 2$ $\\text{h}^{-1}$。\n- 翻译速率 $k_{\\text{tl}} = 100.0$ 蛋白质 $\\text{mRNA}^{-1}\\,\\text{h}^{-1}$。\n- 蛋白质损失速率 $\\delta_p = 1.0$ $\\text{h}^{-1}$。\n- 分泌比例常数 $k_{\\text{sec}} = 0.5$ $\\text{h}^{-1}$。\n\n测试套件。对于每对 $(B, k_{\\text{hat}})$，您必须计算稳态IL-10分泌通量 $J(B, k_{\\text{hat}})$：\n\n- 用例1：$B = 1.0$ mM, $k_{\\text{hat}} = 0.5$ $\\text{h}^{-1}$。\n- 用例2：$B = 0.0$ mM, $k_{\\text{hat}} = 0.5$ $\\text{h}^{-1}$。\n- 用例3：$B = 10.0$ mM, $k_{\\text{hat}} = 0.5$ $\\text{h}^{-1}$。\n- 用例4：$B = 1.0$ mM, $k_{\\text{hat}} = 0.05$ $\\text{h}^{-1}$。\n- 用例5：$B = 0.5$ mM, $k_{\\text{hat}} = 2.0$ $\\text{h}^{-1}$。\n\n您的任务：\n\n- 基于上述原理，推导出稳态分泌通量 $J(B, k_{\\text{hat}})$ 关于 $B$ 和 $k_{\\text{hat}}$ 的闭式表达式。\n- 实现一个程序，计算上述五个测试用例的 $J$，并打印一行包含五个结果的列表，按顺序排列，格式为用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3,x_4,x_5]$）。每个值必须四舍五入到恰好 $6$ 位小数。所有输出必须以每细胞每小时分子数为单位，表示为十进制数。\n\n物理单位和格式：\n\n- 浓度 $B$ 必须解释为 $\\text{mM}$。\n- 速率单位如指定为 $\\text{h}^{-1}$。\n- 最终结果必须以每细胞每小时分子数打印。\n- 必须使用带方括号和逗号分隔符的单行输出格式。", "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且客观的。它概述了定量系统生物学中的一个标准问题，没有矛盾或含糊之处。我现在将开始推导解决方案。\n\n目标是推导出白细胞介素-10（IL-10）稳态分泌通量（$J$）的闭式解析表达式，该表达式是细胞外丁酸盐浓度（$B$）和组蛋白乙酰转移酶（HAT）速率常数（$k_{\\text{hat}}$）的函数。推导过程通过一系列步骤进行，对从受体抑制到蛋白质分泌的生化级联反应进行建模。\n\n**步骤1：丁酸盐对HDAC的抑制**\n\n第一步是量化丁酸盐对组蛋白去乙酰化酶（HDAC）的抑制作用。丁酸盐（$B$）作为抑制剂。丁酸盐与HDAC的结合由希尔方程描述，该方程模拟了协同配体结合。丁酸盐对HDAC的分数占据率，记为 $\\theta(B)$，由下式给出：\n$$\n\\theta(B) = \\frac{B^h}{K_i^h + B^h}\n$$\n这里，$B$ 是丁酸盐浓度，$K_i$ 是表观解离常数，$h$ 是希尔系数。\n\n*未受抑制*或*活性*的HDAC分数，记为 $f_{\\text{active}}(B)$，即为 $1 - \\theta(B)$：\n$$\nf_{\\text{active}}(B) = 1 - \\frac{B^h}{K_i^h + B^h} = \\frac{(K_i^h + B^h) - B^h}{K_i^h + B^h} = \\frac{K_i^h}{K_i^h + B^h}\n$$\n该表达式量化了在给定丁酸盐浓度 $B$ 下，总HDAC池中保持催化活性的部分。\n\n**步骤2：稳态组蛋白乙酰化**\n\nIL-10基因座上组蛋白的乙酰化状态被建模为HATs的乙酰化作用与HDACs的去乙酰化作用之间的动态平衡。设 $A(t)$ 为乙酰化组蛋白的分数，其中 $A \\in [0, 1]$。相应地，未乙酰化组蛋白的分数为 $(1 - A)$。\n\n乙酰化速率与未乙酰化分数成正比，速率常数为 $k_{\\text{hat}}$。去乙酰化速率与乙酰化分数成正比，其有效速率常数 $k_{\\text{d,eff}}(B)$ 依赖于丁酸盐浓度。此有效速率是基线去乙酰化速率 $k_{\\text{d0}}$ 乘以活性HDAC的分数：\n$$\nk_{\\text{d,eff}}(B) = k_{\\text{d0}} \\cdot f_{\\text{active}}(B) = k_{\\text{d0}} \\frac{K_i^h}{K_i^h + B^h}\n$$\n控制乙酰化组蛋白分数的微分方程为：\n$$\n\\frac{dA}{dt} = k_{\\text{hat}}(1 - A) - k_{\\text{d,eff}}(B) A\n$$\n在稳态下，$\\frac{dA}{dt} = 0$。设 $A^\\ast$ 为稳态乙酰化组蛋白分数。\n$$\nk_{\\text{hat}}(1 - A^\\ast) = k_{\\text{d,eff}}(B) A^\\ast\n$$\n求解 $A^\\ast$ 得：\n$$\nk_{\\text{hat}} = (k_{\\text{hat}} + k_{\\text{d,eff}}(B)) A^\\ast \\implies A^\\ast(B, k_{\\text{hat}}) = \\frac{k_{\\text{hat}}}{k_{\\text{hat}} + k_{\\text{d,eff}}(B)}\n$$\n\n**步骤3：稳态mRNA表达**\n\nIL-10 mRNA的合成速率 $s_m$ 被假定为稳态组蛋白乙酰化分数 $A^\\ast$ 的线性函数。这代表了染色质结构的开放，从而使转录得以进行。\n$$\ns_m = r_0 + \\alpha A^\\ast\n$$\n其中 $r_0$ 是基础转录速率，$\\alpha$ 是乙酰化依赖性增强。mRNA分子通过一级过程降解，速率常数为 $\\delta_m$。每个细胞的mRNA拷贝数 $M(t)$ 的动态由下式给出：\n$$\n\\frac{dM}{dt} = s_m - \\delta_m M\n$$\n在稳态下，$\\frac{dM}{dt} = 0$。稳态mRNA拷贝数 $M^\\ast$ 为：\n$$\nM^\\ast = \\frac{s_m}{\\delta_m} = \\frac{r_0 + \\alpha A^\\ast}{\\delta_m}\n$$\n\n**步骤4：稳态蛋白表达与分泌通量**\n\n细胞内IL-10蛋白池 $P(t)$ 通过mRNA的翻译而增加，并通过分泌和降解的组合而减少。翻译以速率 $k_{\\text{tl}} M$ 发生，蛋白质损失是一个一级过程，速率常数为 $\\delta_p$。\n$$\n\\frac{dP}{dt} = k_{\\text{tl}} M - \\delta_p P\n$$\n在稳态下，当 $M = M^\\ast$ 时，蛋白质水平 $P^\\ast$ 为：\n$$\nP^\\ast = \\frac{k_{\\text{tl}} M^\\ast}{\\delta_p}\n$$\n问题将分泌通量 $J$ 定义为与细胞内蛋白质浓度成正比，比例常数为 $k_{\\text{sec}}$：\n$$\nJ = k_{\\text{sec}} P^\\ast = k_{\\text{sec}} \\frac{k_{\\text{tl}} M^\\ast}{\\delta_p}\n$$\n\n**步骤5：分泌通量的最终表达式**\n\n通过代入中间稳态量的表达式，我们可以推导出分泌通量 $J$ 作为自变量 $B$ 和 $k_{\\text{hat}}$ 以及固定系统参数的函数的最终闭式表达式。\n将 $M^\\ast$ 代入 $J$ 的方程：\n$$\nJ = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p} \\left(\\frac{r_0 + \\alpha A^\\ast}{\\delta_m}\\right) = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p \\delta_m} (r_0 + \\alpha A^\\ast)\n$$\n接着，代入 $A^\\ast$ 的表达式：\n$$\nJ = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p \\delta_m} \\left( r_0 + \\alpha \\left( \\frac{k_{\\text{hat}}}{k_{\\text{hat}} + k_{\\text{d,eff}}(B)} \\right) \\right)\n$$\n最后，代入 $k_{\\text{d,eff}}(B)$ 的表达式：\n$$\nJ(B, k_{\\text{hat}}) = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p \\delta_m} \\left( r_0 + \\alpha \\frac{k_{\\text{hat}}}{k_{\\text{hat}} + k_{\\text{d0}} \\frac{K_i^h}{K_i^h + B^h}} \\right)\n$$\n这是用于计算的最终解析表达式。该方程基于指定的第一性原理，机理上将外部丁酸盐浓度与细胞的IL-10输出联系起来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the steady-state IL-10 secretion flux based on a mechanistic model\n    of HDAC inhibition by butyrate.\n    \"\"\"\n\n    # Define the fixed parameter values for the model.\n    # All rates are in units consistent with hours (h).\n    Ki = 0.5  # Apparent dissociation constant (mM)\n    h = 2.0  # Hill coefficient (dimensionless)\n    kd0 = 1.0  # Baseline HDAC deacetylation rate constant (h^-1)\n    khat = None # HAT rate constant (h^-1), varies per case\n    r0 = 2.0  # Basal IL-10 mRNA synthesis rate (molecules cell^-1 h^-1)\n    alpha = 20.0  # Acetylation-dependent increment (molecules cell^-1 h^-1)\n    delta_m = np.log(2)  # mRNA decay rate constant (h^-1)\n    ktl = 100.0  # Translation rate (proteins mRNA^-1 h^-1)\n    delta_p = 1.0  # Protein loss rate constant (h^-1)\n    ksec = 0.5  # Secretion proportionality constant (h^-1)\n\n    # Define the test suite of scenarios (B, khat).\n    # B is butyrate concentration in mM.\n    # khat is HAT rate constant in h^-1.\n    test_cases = [\n        (1.0, 0.5),  # Case 1\n        (0.0, 0.5),  # Case 2\n        (10.0, 0.5), # Case 3\n        (1.0, 0.05), # Case 4\n        (0.5, 2.0),  # Case 5\n    ]\n\n    results = []\n\n    for B, khat in test_cases:\n        # This implementation uses the derived closed-form expression for J.\n        # J(B, khat) = (ksec * ktl) / (delta_p * delta_m) * \n        #              (r0 + alpha * khat / (khat + kd0 * Ki^h / (Ki^h + B^h)))\n\n        # Step 1: Calculate the effective deacetylation rate constant kd_eff\n        kd_eff = kd0 * (Ki**h) / (Ki**h + B**h)\n        \n        # Step 2: Calculate the steady-state fraction of acetylated histones A_star\n        A_star = khat / (khat + kd_eff)\n        \n        # Step 3: Calculate the steady-state mRNA synthesis rate sm\n        sm = r0 + alpha * A_star\n        \n        # Step 4: Calculate the steady-state mRNA copy number M_star\n        M_star = sm / delta_m\n        \n        # Step 5: Calculate the steady-state protein copy number P_star\n        P_star = (ktl * M_star) / delta_p\n        \n        # Step 6: Calculate the secretion flux J\n        J = ksec * P_star\n        \n        results.append(J)\n\n    # Format the final output string as a comma-separated list of values\n    # rounded to 6 decimal places, enclosed in square brackets.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    \n    # Print the final result in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2538359"}]}