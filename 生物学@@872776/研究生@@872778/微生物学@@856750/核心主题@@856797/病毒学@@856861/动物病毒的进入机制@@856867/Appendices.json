{"hands_on_practices": [{"introduction": "病毒进入宿主细胞的第一步通常是与细胞表面受体结合。我们可以运用质量作用定律来为这一关键相互作用建模，从而理解结合亲和力（$K_D$）和组分浓度如何决定受体被占据的程度。这项练习 ([@problem_id:2489082]) 旨在从基本原理出发，推导出描述这种结合平衡的精确数学关系，为理解细胞表面的双分子相互作用提供定量基础。", "problem": "动物病毒包膜上的一种病毒刺突蛋白 $S$ 在入侵过程中与宿主细胞受体 $R$ 以一对一的化学计量比结合，形成复合物 $RS$。假设在膜附近的一个混合均匀的反应体积中，该结合反应达到热力学平衡并遵循质量作用定律。已知总浓度 $[R]_T$ 和 $[S]_T$，以及该相互作用的解离常数 (KD) $K_D$。仅从 $R$ 和 $S$ 的质量守恒以及质量作用定律下 $K_D$ 的定义出发，推导出平衡状态下被受体占据的刺突蛋白的确切分数 $f$ 的封闭形式解，该解仅用 $[R]_T$、$[S]_T$ 和 $K_D$ 表示。将你的最终答案表示为仅含 $[R]_T$、$[S]_T$ 和 $K_D$ 的单个封闭形式符号表达式。\n\n然后，简要解释（无需计算）受体在二维细胞膜上的空间限制如何导致与此三维预测的偏差，以及在何种极限条件下可以近似地恢复三维模型。\n\n无需进行数值评估。你的最终答案应该是一个无单位的单一解析表达式。", "solution": "问题是推导在与宿主细胞受体的一对一结合相互作用中，达到热力学平衡时被占据的病毒刺突蛋白的分数 $f$。推导必须从基本原理出发：质量作用定律和质量守恒。\n\n可逆结合反应如下：\n$$S + R \\rightleftharpoons RS$$\n其中 $S$ 是刺突蛋白，$R$ 是受体，$RS$ 是结合的复合物。\n\n在平衡状态下，系统由解离常数 $K_D$ 描述，根据质量作用定律其定义为：\n$$K_D = \\frac{[S][R]}{[RS]}$$\n此处，$[S]$、$[R]$ 和 $[RS]$ 分别表示平衡时游离刺突蛋白、游离受体和复合物的摩尔浓度。\n\n刺突蛋白的总浓度 $[S]_T$ 和受体的总浓度 $[R]_T$ 是守恒的。质量平衡方程为：\n$$[S]_T = [S] + [RS]$$\n$$[R]_T = [R] + [RS]$$\n\n我们的目标是求出被占据的刺突蛋白的分数 $f$，其定义为：\n$$f = \\frac{[RS]}{[S]_T}$$\n为了求出 $f$，我们必须首先用给定的总浓度 $[S]_T$、$[R]_T$ 和常数 $K_D$ 来求解复合物的平衡浓度 $[RS]$。\n\n根据质量平衡方程，我们可以用 $[RS]$ 表示游离浓度 $[S]$ 和 $[R]$：\n$$[S] = [S]_T - [RS]$$\n$$[R] = [R]_T - [RS]$$\n只要 $[RS] \\le [S]_T$ 且 $[RS] \\le [R]_T$，这些表达式就有效，这也是物理现实所要求的。\n\n将 $[S]$ 和 $[R]$ 的这些表达式代入 $K_D$ 的平衡方程，得到：\n$$K_D = \\frac{([S]_T - [RS])([R]_T - [RS])}{[RS]}$$\n\n必须求解这个关于 $[RS]$ 的方程。我们将方程重新整理成标准二次方程形式 $ax^2 + bx + c = 0$，其中变量为 $x = [RS]$。\n$$K_D [RS] = ([S]_T - [RS])([R]_T - [RS])$$\n$$K_D [RS] = [S]_T [R]_T - [S]_T [RS] - [R]_T [RS] + [RS]^2$$\n$$[RS]^2 - ([S]_T + [R]_T + K_D)[RS] + [S]_T [R]_T = 0$$\n\n这是一个关于 $[RS]$ 的二次方程。我们应用二次公式 $[RS] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中系数为 $a=1$，$b = -([S]_T + [R]_T + K_D)$ 和 $c = [S]_T [R]_T$。\n$$[RS] = \\frac{([S]_T + [R]_T + K_D) \\pm \\sqrt{(-([S]_T + [R]_T + K_D))^2 - 4(1)([S]_T [R]_T)}}{2}$$\n$$[RS] = \\frac{1}{2} \\left( [S]_T + [R]_T + K_D \\pm \\sqrt{([S]_T + [R]_T + K_D)^2 - 4[S]_T [R]_T} \\right)$$\n\n得到了两个数学解，但只有一个具有物理意义。复合物的浓度 $[RS]$ 不能超过任何一种反应物的总浓度。也就是说，$[RS] \\le [S]_T$ 且 $[RS] \\le [R]_T$。我们必须评估由 $\\pm$ 号提供的两个根。\n\n让我们分析根号下的和。它可以代数重排为：\n$$([S]_T + [R]_T + K_D)^2 - 4[S]_T [R]_T = ([S]_T + [R]_T)^2 + 2K_D([S]_T + [R]_T) + K_D^2 - 4[S]_T [R]_T$$\n$$= ([S]_T - [R]_T)^2 + 2K_D([S]_T + [R]_T) + K_D^2$$\n该项始终为非负数，因此保证了 $[RS]$ 的实数解。\n\n考虑带加号的解。项 $\\sqrt{([S]_T + [R]_T + K_D)^2 - 4[S]_T [R]_T}$ 严格小于 $([S]_T + [R]_T + K_D)$，因为 $4[S]_T [R]_T > 0$（假设浓度不为零）。\n然而，如果我们取加号，得到的 $[RS]$ 会过大。例如，在 $K_D \\to 0$（无限紧密结合）的极限情况下，反应会进行到底。限量反应物被耗尽。如果 $[S]_T < [R]_T$，则 $[RS] \\to [S]_T$。当 $K_D=0$ 时，公式变为：\n$$[RS] = \\frac{1}{2} \\left([S]_T + [R]_T \\pm \\sqrt{([S]_T - [R]_T)^2} \\right) = \\frac{1}{2} \\left([S]_T + [R]_T \\pm |[S]_T - [R]_T| \\right)$$\n假设 $[S]_T < [R]_T$，那么 $|[S]_T - [R]_T| = [R]_T - [S]_T$。\n加号给出：$[RS] = \\frac{1}{2} ([S]_T + [R]_T + [R]_T - [S]_T) = [R]_T$。这在物理上是不正确的，因为 $[RS]$ 不能超过 $[S]_T$。\n减号给出：$[RS] = \\frac{1}{2} ([S]_T + [R]_T - ([R]_T - [S]_T)) = \\frac{1}{2}(2[S]_T) = [S]_T$。这是正确的物理极限。\n因此，减号提供了唯一物理上有效的解。\n\n复合物平衡浓度的正确表达式是：\n$$[RS] = \\frac{1}{2} \\left( [S]_T + [R]_T + K_D - \\sqrt{([S]_T + [R]_T + K_D)^2 - 4[S]_T [R]_T} \\right)$$\n\n最后，我们通过将 $[RS]$ 除以 $[S]_T$ 来计算被占据的刺突蛋白的分数 $f$：\n$$f = \\frac{[RS]}{[S]_T} = \\frac{1}{2[S]_T} \\left( [S]_T + [R]_T + K_D - \\sqrt{([S]_T + [R]_T + K_D)^2 - 4[S]_T [R]_T} \\right)$$\n这就是所要求的封闭形式表达式。\n\n关于问题的第二部分：\n所提供的模型假设在一个混合均匀的三维反应体积中，浓度是均一的。受体在二维细胞膜上的空间限制导致了与此理想化模型的显著偏差。\n\n主要偏差源于“有效浓度”的概念。被限制在二维表面上的受体具有比它们分布在三维体积中时高得多的局部密度。靠近细胞表面的刺突蛋白会经历更高的有效受体浓度，这增加了结合的概率。这种效应，被称为“维度降低”，通常导致在给定分子数量的情况下，结合分数高于三维模型的预测值。此外，结合动力学也发生了改变，因为该过程变成了一个三维扩散粒子在二维表面上寻找目标的过程，这比纯粹的三维搜索更有效。质量作用定律假设一个混合均匀的状态，如果扩散速率相对于反应速率较慢，则可能无法达到这种状态。\n\n在特定的极限条件下，可以近似恢复三维模型。最重要的是“反应限制机制”。如果内在的化学结合速率 ($k_{on}$) 和解离速率 ($k_{off}$) 远慢于刺突蛋白在体相中的扩散速率以及受体在膜表面的扩散速率，那么系统就有足够的时间在空间上达到平衡。在这种情况下，粒子在大量结合事件发生之前实际上是“混合均匀”的。此时，平衡状态纯粹由热力学（即比率 $k_{off}/k_{on} = K_D$）决定，而不是由扩散相遇的速率决定。在这种条件下，三维质量作用模型提供了一个很好的近似，前提是针对膜附近的相关相互作用体积正确定义了浓度 $[S]_T$ 和 $[R]_T$。如果受体的横向迁移率非常高，装饰有受体的表面开始表现得像一个均相，这也有助于恢复简单模型的假设。", "answer": "$$\\boxed{\\frac{1}{2[S]_T} \\left( [R]_T + [S]_T + K_D - \\sqrt{([R]_T + [S]_T + K_D)^2 - 4[R]_T [S]_T} \\right)}$$", "id": "2489082"}, {"introduction": "膜融合是一个高能耗的过程，需要克服巨大的活化能垒。这项练习 ([@problem_id:2489080]) 探讨了多个病毒融合蛋白的协同作用如何显著降低这一能垒，从而在生物学相关的时间尺度内实现融合。通过应用过渡态理论和一个简化的线性模型，我们可以量化这种协同效应，并预测成功进入所需的最小蛋白数量。", "problem": "一种有包膜的动物病毒通过由多个三聚体融合糖蛋白拷贝介导的膜融合进入细胞。考虑一个最小动力学模型，其中膜融合是一个单一的活化步骤，其活化自由能为 $\\Delta G^{\\ddagger}(n)$，该能量取决于同时参与的融合蛋白数量 $n$。采用以下基本依据：(i) 过渡态理论 (TST) 指出，融合速率常数为 $k(n) = k_{0} \\exp\\!\\left(-\\Delta G^{\\ddagger}(n) / (k_{B} T)\\right)$，其中 $k_{0}$ 是尝试频率，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度；(ii) 对于一个速率恒为 $k(n)$ 的无记忆过程，在时间 $t$ 之前至少发生一次融合事件的概率为 $P_{\\text{fuse}}(t) = 1 - \\exp\\!\\left(-k(n)\\, t\\right)$；并且 (iii) 每个参与的融合蛋白使活化自由能降低一个量 $\\Delta E_{\\text{prot}}$，并且这些贡献是线性相加的。\n\n假设在生理温度下的参数值如下：$T = 310 \\,\\mathrm{K}$，$k_{0} = 10^{6} \\,\\mathrm{s}^{-1}$，无协同作用时的基线活化能垒 $E_{\\text{barrier}} = 35\\, k_{B} T$，以及每个蛋白质降低的能垒 $\\Delta E_{\\text{prot}} = 4\\, k_{B} T$。在内体运输过程中，病毒颗粒有一个有效的时间窗口 $t_{\\text{avail}} = 60 \\,\\mathrm{s}$，必须在此窗口内发生融合以避免降解。如果融合概率在此时间窗口结束时满足 $P_{\\text{fuse}}(t_{\\text{avail}}) \\ge p^{\\star}$（其中 $p^{\\star} = 0.95$），则定义该融合结果为生理相关的。\n\n仅从上述基本依据和给定的参数值出发，推导确定确保生理相关结果的最小整数 $n$ 的不等式，并计算该最小 $n$ 值。将最小整数 $n$ 作为你的最终答案。无需单位。如果任何中间数值计算需要四舍五入，请保留足够的精度，以确保最终的最小整数 $n$ 是明确的；对 $n$ 无需特定的有效数字取舍。", "solution": "必须首先验证问题陈述的科学合理性、一致性和完整性。\n\n步骤 1：提取已知条件\n提供的明确数据和定义如下：\n- 模型：由 $n$ 个三聚体融合糖蛋白介导的单步膜融合。\n- 过渡态理论 (TST) 速率常数：$k(n) = k_{0} \\exp\\!\\left(-\\Delta G^{\\ddagger}(n) / (k_{B} T)\\right)$。\n- 到时间 $t$ 时的融合概率：$P_{\\text{fuse}}(t) = 1 - \\exp\\!\\left(-k(n)\\, t\\right)$。\n- 活化能模型：$\\Delta G^{\\ddagger}(n)$ 是 $n$ 的线性函数。每个蛋白质使能垒降低 $\\Delta E_{\\text{prot}}$。\n- 参数值：\n  - 绝对温度：$T = 310 \\,\\mathrm{K}$。\n  - 尝试频率：$k_{0} = 10^{6} \\,\\mathrm{s}^{-1}$。\n  - 基线活化能垒：$E_{\\text{barrier}} = 35\\, k_{B} T$。\n  - 每个蛋白质的能量贡献：$\\Delta E_{\\text{prot}} = 4\\, k_{B} T$。\n  - 可用于融合的时间：$t_{\\text{avail}} = 60 \\,\\mathrm{s}$。\n- 生理相关结果的定义：$P_{\\text{fuse}}(t_{\\text{avail}}) \\ge p^{\\star}$。\n- 概率阈值：$p^{\\star} = 0.95$。\n- 目标：求满足生理相关结果条件的最小整数 $n$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了一个基于过渡态理论和协同结合的生物物理学标准简化动力学模型，这是病毒学中一个成熟的概念。该问题是适定的，提供了所有必要的参数和明确定义的目标。语言精确、客观。没有矛盾、信息缺失或伪科学成分。所提供的值对于此类生物过程是物理上合理的。\n\n步骤 3：结论与行动\n问题有效。将推导完整的解。\n\n求解过程首先构建融合速率常数 $k(n)$ 的显式形式，然后利用融合概率的条件来推导关于蛋白质数量 $n$ 的不等式。\n\n首先，我们构建活化自由能 $\\Delta G^{\\ddagger}(n)$ 的公式。基线能垒 $E_{\\text{barrier}}$ 对应于没有协同蛋白质的情况，即 $\\Delta G^{\\ddagger}(0) = E_{\\text{barrier}}$。根据依据 (iii)，$n$ 个蛋白质中的每一个都将此能垒线性地降低一个量 $\\Delta E_{\\text{prot}}$。因此，作为 $n$ 的函数的活化能为：\n$$\n\\Delta G^{\\ddagger}(n) = \\Delta G^{\\ddagger}(0) - n \\cdot \\Delta E_{\\text{prot}} = E_{\\text{barrier}} - n \\cdot \\Delta E_{\\text{prot}}\n$$\n代入给定的参数值，这些值很方便地以 $k_{B} T$ 为单位表示：\n$$\n\\Delta G^{\\ddagger}(n) = 35\\, k_{B} T - n (4\\, k_{B} T) = (35 - 4n) k_{B} T\n$$\n接下来，我们将 $\\Delta G^{\\ddagger}(n)$ 的这个表达式代入 TST 方程中的速率常数 $k(n)$：\n$$\nk(n) = k_{0} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(n)}{k_{B} T}\\right) = k_{0} \\exp\\left(-\\frac{(35 - 4n) k_{B} T}{k_{B} T}\\right)\n$$\n指数中的 $k_{B} T$ 项相互抵消，这极大地简化了表达式：\n$$\nk(n) = k_{0} \\exp(- (35 - 4n)) = k_{0} \\exp(4n - 35)\n$$\n问题将“生理相关结果”定义为在时间 $t_{\\text{avail}}$ 前融合概率至少为 $p^{\\star}$ 的事件。这给出了不等式：\n$$\nP_{\\text{fuse}}(t_{\\text{avail}}) \\ge p^{\\star}\n$$\n使用提供的融合概率公式，我们得到：\n$$\n1 - \\exp(-k(n)\\, t_{\\text{avail}}) \\ge p^{\\star}\n$$\n现在我们求解这个关于 $n$ 的不等式。重新整理各项以分离出指数项：\n$$\n1 - p^{\\star} \\ge \\exp(-k(n)\\, t_{\\text{avail}})\n$$\n为了解出指数的参数，我们对两边取自然对数。由于 $\\ln(x)$ 是一个单调递增函数，不等号的方向保持不变。\n$$\n\\ln(1 - p^{\\star}) \\ge -k(n)\\, t_{\\text{avail}}\n$$\n两边乘以 $-1$ 会使不等号反向：\n$$\n-\\ln(1 - p^{\\star}) \\le k(n)\\, t_{\\text{avail}}\n$$\n这可以更优雅地写成：\n$$\n\\ln\\left(\\frac{1}{1 - p^{\\star}}\\right) \\le k(n)\\, t_{\\text{avail}}\n$$\n现在，代入 $k(n)$ 的表达式：\n$$\n\\ln\\left(\\frac{1}{1 - p^{\\star}}\\right) \\le \\left(k_{0} \\exp(4n - 35)\\right) t_{\\text{avail}}\n$$\n为了分离出 $n$，我们再次重新整理并应用自然对数。首先，分离出指数项：\n$$\n\\frac{1}{k_{0} t_{\\text{avail}}} \\ln\\left(\\frac{1}{1 - p^{\\star}}\\right) \\le \\exp(4n - 35)\n$$\n对两边取自然对数：\n$$\n\\ln\\left[ \\frac{1}{k_{0} t_{\\text{avail}}} \\ln\\left(\\frac{1}{1 - p^{\\star}}\\right) \\right] \\le 4n - 35\n$$\n最后，我们求解 $n$：\n$$\n35 + \\ln\\left[ \\frac{1}{k_{0} t_{\\text{avail}}} \\ln\\left(\\frac{1}{1 - p^{\\star}}\\right) \\right] \\le 4n\n$$\n$$\nn \\ge \\frac{1}{4} \\left( 35 + \\ln\\left[ \\frac{\\ln\\left(\\frac{1}{1 - p^{\\star}}\\right)}{k_{0} t_{\\text{avail}}} \\right] \\right)\n$$\n这就是所要求的不等式。现在我们代入数值：$p^{\\star} = 0.95$，$k_{0} = 10^{6} \\,\\mathrm{s}^{-1}$，以及 $t_{\\text{avail}} = 60 \\,\\mathrm{s}$。\n首先，计算对数内的项：\n$$\n\\frac{1}{1 - p^{\\star}} = \\frac{1}{1 - 0.95} = \\frac{1}{0.05} = 20\n$$\n$$\n\\ln\\left(\\frac{1}{1 - p^{\\star}}\\right) = \\ln(20) \\approx 2.99573\n$$\n接下来，计算分母项：\n$$\nk_{0} t_{\\text{avail}} = (10^{6} \\,\\mathrm{s}^{-1}) \\cdot (60 \\,\\mathrm{s}) = 6 \\times 10^{7}\n$$\n现在，将这些值代入关于 $n$ 的不等式中：\n$$\nn \\ge \\frac{1}{4} \\left( 35 + \\ln\\left[ \\frac{\\ln(20)}{6 \\times 10^{7}} \\right] \\right)\n$$\n$$\nn \\ge \\frac{1}{4} \\left( 35 + \\ln\\left[ \\frac{2.99573}{6 \\times 10^{7}} \\right] \\right)\n$$\n$$\nn \\ge \\frac{1}{4} \\left( 35 + \\ln(4.99288 \\times 10^{-8}) \\right)\n$$\n$$\nn \\ge \\frac{1}{4} (35 - 16.8126)\n$$\n$$\nn \\ge \\frac{1}{4} (18.1874)\n$$\n$$\nn \\ge 4.54685\n$$\n由于参与的融合蛋白数量 $n$ 必须是整数，满足此条件的最小整数 $n$ 值通过向上取整到下一个整数得到。\n因此，实现生理相关融合结果所需的同时参与的融合蛋白的最小数量是 $5$。", "answer": "$$\\boxed{5}$$", "id": "2489080"}, {"introduction": "病毒的整个进入途径是一系列分子事件的序列。这项计算练习 ([@problem_id:2489172]) 介绍了一种强大的数据分析方法，即从观测到的进入时间数据反向推断进入途径的潜在结构。通过将进入过程建模为一系列连续步骤（一个爱尔朗过程），我们可以估计限速步骤的数量及其特征速率，从而从动力学数据中获得机理性的见解。", "problem": "您面临一个建模任务，该任务基于一种机械论观点，即动物病毒成功进入宿主细胞的总时间可以近似为有限个独立的、无记忆的等待时间之和，每个等待时间对应于进入途径中的一个限速分子步骤。核心出发点是以下基本定义和广为接受的事实：(i) 单个无记忆等待时间由一个速率参数为 $\\lambda$（单位为 $\\text{min}^{-1}$）的指数随机变量建模，(ii) $k$ 个独立的、具有相同速率 $\\lambda$ 的指数随机变量之和遵循形状参数为 $k$、速率参数为 $\\lambda$ 的伽马（爱尔朗）分布，以及 (iii) 形状为 $k$、速率为 $\\lambda$ 的伽马分布的概率密度函数为 $f(t \\mid k,\\lambda) = \\dfrac{\\lambda^k t^{k-1} e^{-\\lambda t}}{\\Gamma(k)}$，其中 $t \\gt 0$，$\\Gamma(k)$ 是伽马函数。\n\n给定观测到的进入时间 $t_1,\\dots,t_n$（单位为分钟），假设所有限速步骤共享相同的平均速率，并且总进入时间是 $k$ 个此类步骤的总和。您的任务是仅使用上述基本假设和定义，通过最大似然法从数据中推断出有效限速步骤数 $k$（假定为正整数）和共同的步骤速率 $\\lambda$（单位为 $\\text{min}^{-1}$）。\n\n制定一种算法，对于固定的 $k$，通过最大化伽马密度下的似然来估计 $\\lambda$，然后对于给定的 $K_{\\max}$，在离散集合 $\\{1,2,\\dots,K_{\\max}\\}$ 上选择使得到的最大化似然最大的 $k$。然后计算相应的每步平均持续时间 $\\tau = 1/\\lambda$（单位为分钟）。所有浮点输出必须四舍五入到恰好4位小数。您的程序必须实现此过程，并为下面的测试套件生成结果。\n\n测试套件：\n- 案例A（理想情况，具有多个有效步骤的中等大小样本）：$[6.2, 8.5, 9.1, 11.0, 12.3, 14.7, 15.4, 16.8, 18.2, 19.5, 21.0, 24.3]$ 分钟。\n- 案例B（边界条件，近似单步指数行为）：$[0.4, 0.7, 1.2, 1.8, 2.1, 2.6, 3.3, 3.9, 4.8, 5.7]$ 分钟。\n- 案例C（具有较高有效步骤数的边缘情况）：$[6.8, 8.9, 9.7, 10.5, 11.2, 11.8, 12.3, 12.9, 13.4, 13.9, 14.4, 15.1, 15.7, 16.4, 17.2]$ 分钟。\n- 案例D（小样本稳定性检查）：$[0.2, 0.3, 1.1, 0.6]$ 分钟。\n\n需满足的实现细节：\n- 将 $k$ 视为整数，并在 $k \\in \\{1,2,\\dots,K_{\\max}\\}$ 上进行搜索，其中 $K_{\\max} = 10$。\n- 对于每个案例，返回一个三元组，包括推断出的整数步骤数 $k$、推断出的共同步骤速率 $\\lambda$（单位为 $\\text{min}^{-1}$）以及推断出的每步平均持续时间 $\\tau$（单位为分钟）。后两者需四舍五入到恰好4位小数。\n- 不涉及角度单位。所有时间单位为分钟，所有速率单位为 $\\text{min}^{-1}$。\n- 您的程序应生成单行输出，其中包含案例A–D的结果，格式为逗号分隔的列表之列表，按A、B、C、D的顺序排列，并用方括号括起来。例如，输出格式必须严格为 $[[k_A,\\lambda_A,\\tau_A],[k_B,\\lambda_B,\\tau_B],[k_C,\\lambda_C,\\tau_C],[k_D,\\lambda_D,\\tau_D]]$ 的形式，其中每个 $\\lambda$ 和 $\\tau$ 都显示恰好4位小数。\n\n您的程序必须是自包含的，且不应需要任何输入。它必须按照规定为提供的测试套件计算结果，并以确切要求的格式打印单行输出。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于随机过程和统计推断的原理，特别是应用伽马分布的等待时间来模拟生物现象。该问题是适定的（well-posed），提供了明确的目标、所有必要的数据以及最大似然估计的确定方法。它没有歧义、矛盾和主观内容。因此，我们可以着手推导解决方案。\n\n任务是从一组 $n$ 个观测到的总进入时间 $\\mathbf{t} = \\{t_1, t_2, \\dots, t_n\\}$ 中推断出限速步骤的数量 $k$ 和这些步骤的共同速率 $\\lambda$。该模型假设总时间 $t$ 服从形状参数为 $k$（一个整数）和速率参数为 $\\lambda$ 的伽马分布。其概率密度函数（PDF）如下：\n$$ f(t \\mid k, \\lambda) = \\frac{\\lambda^k t^{k-1} e^{-\\lambda t}}{\\Gamma(k)} $$\n其中 $\\Gamma(k)$ 是伽马函数。对于整数 $k$，$\\Gamma(k) = (k-1)!$。\n\n我们的目标是找到使观测到给定数据的可能性最大的参数 $(k, \\lambda)$。假设观测值 $t_i$ 是独立同分布的（i.i.d.），似然函数 $L$ 是各个概率密度的乘积：\n$$ L(\\lambda, k \\mid \\mathbf{t}) = \\prod_{i=1}^{n} f(t_i \\mid k, \\lambda) = \\prod_{i=1}^{n} \\frac{\\lambda^k t_i^{k-1} e^{-\\lambda t_i}}{\\Gamma(k)} $$\n\n为便于分析，我们使用对数似然函数 $\\ell = \\ln L$：\n$$ \\ell(\\lambda, k \\mid \\mathbf{t}) = \\ln \\left( \\prod_{i=1}^{n} \\frac{\\lambda^k t_i^{k-1} e^{-\\lambda t_i}}{\\Gamma(k)} \\right) = \\sum_{i=1}^{n} \\ln \\left( \\frac{\\lambda^k t_i^{k-1} e^{-\\lambda t_i}}{\\Gamma(k)} \\right) $$\n展开对数，我们得到：\n$$ \\ell(\\lambda, k \\mid \\mathbf{t}) = \\sum_{i=1}^{n} \\left( k \\ln\\lambda + (k-1)\\ln t_i - \\lambda t_i - \\ln\\Gamma(k) \\right) $$\n$$ \\ell(\\lambda, k \\mid \\mathbf{t}) = n k \\ln\\lambda + (k-1)\\sum_{i=1}^{n}\\ln t_i - \\lambda\\sum_{i=1}^{n} t_i - n\\ln\\Gamma(k) $$\n\n问题指定了一个两步过程。首先，对于一个固定的整数值 $k$，我们找到 $\\lambda$ 的最大似然估计（MLE），记为 $\\hat{\\lambda}(k)$。这可以通过求 $\\ell$ 对 $\\lambda$ 的偏导数并令其为零来找到：\n$$ \\frac{\\partial\\ell}{\\partial\\lambda} = \\frac{\\partial}{\\partial\\lambda} \\left( n k \\ln\\lambda + (k-1)\\sum_{i=1}^{n}\\ln t_i - \\lambda\\sum_{i=1}^{n} t_i - n\\ln\\Gamma(k) \\right) = \\frac{nk}{\\lambda} - \\sum_{i=1}^{n} t_i $$\n将导数设为零：\n$$ \\frac{nk}{\\hat{\\lambda}} - \\sum_{i=1}^{n} t_i = 0 \\implies \\hat{\\lambda}(k) = \\frac{nk}{\\sum_{i=1}^{n} t_i} $$\n这可以用样本平均时间 $\\bar{t} = \\frac{1}{n} \\sum_{i=1}^{n} t_i$ 来表示：\n$$ \\hat{\\lambda}(k) = \\frac{k}{\\bar{t}} $$\n二阶偏导数 $\\frac{\\partial^2\\ell}{\\partial\\lambda^2} = -\\frac{nk}{\\lambda^2}$，对于正的 $n$、$k$ 和 $\\lambda$ 总是为负，证实这确实是一个最大值。\n\n其次，我们必须在指定范围 $\\{1, 2, \\dots, K_{\\max}\\}$（其中 $K_{\\max}=10$）中找到最优的整数 $k$。我们通过将最大似然估计 $\\hat{\\lambda}(k)$ 代入对数似然函数，得到关于 $k$ 的剖面对数似然，记为 $\\ell(k)$：\n$$ \\ell(k) = \\ell(\\hat{\\lambda}(k), k \\mid \\mathbf{t}) = n k \\ln(\\hat{\\lambda}(k)) + (k-1)\\sum_{i=1}^{n}\\ln t_i - \\hat{\\lambda}(k)\\sum_{i=1}^{n} t_i - n\\ln\\Gamma(k) $$\n代入 $\\hat{\\lambda}(k) = k/\\bar{t}$ 和 $\\sum t_i = n\\bar{t}$：\n$$ \\ell(k) = n k \\ln\\left(\\frac{k}{\\bar{t}}\\right) + (k-1)\\sum_{i=1}^{n}\\ln t_i - \\left(\\frac{k}{\\bar{t}}\\right) n\\bar{t} - n\\ln\\Gamma(k) $$\n$$ \\ell(k) = n k (\\ln k - \\ln\\bar{t}) + (k-1)\\sum_{i=1}^{n}\\ln t_i - nk - n\\ln\\Gamma(k) $$\n最优步骤数 $k^*$ 是使该函数 $\\ell(k)$ 在 $k$ 从 1 到 10 的整数值中最大化的那个值。\n\n因此，算法如下：\n1. 对于给定的数据集 $\\{t_1, \\dots, t_n\\}$，计算汇总统计量：样本大小 $n$、样本均值 $\\bar{t}$ 和对数和 $\\sum_{i=1}^{n} \\ln t_i$。\n2. 对于从 1 到 10 的每个整数 $k$，计算剖面对数似然 $\\ell(k)$ 的值。$\\ln\\Gamma(k)$ 项通过数值计算得出。\n3. 找出产生最大 $\\ell(k)$ 值的整数 $k^*$。\n4. 最终估计的参数为：\n   - 步骤数：$k = k^*$\n   - 步骤速率：$\\lambda = \\hat{\\lambda}(k^*) = k^*/\\bar{t}$\n   - 平均步骤持续时间：$\\tau = 1/\\lambda = \\bar{t}/k^*$\n\n此过程将被实施以解决所提供的每个测试案例的参数问题。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Solves the virus entry modeling problem for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = {\n        'A': [6.2, 8.5, 9.1, 11.0, 12.3, 14.7, 15.4, 16.8, 18.2, 19.5, 21.0, 24.3],\n        'B': [0.4, 0.7, 1.2, 1.8, 2.1, 2.6, 3.3, 3.9, 4.8, 5.7],\n        'C': [6.8, 8.9, 9.7, 10.5, 11.2, 11.8, 12.3, 12.9, 13.4, 13.9, 14.4, 15.1, 15.7, 16.4, 17.2],\n        'D': [0.2, 0.3, 1.1, 0.6]\n    }\n    \n    # Process cases in the required order A, B, C, D\n    case_order = ['A', 'B', 'C', 'D']\n    \n    K_max = 10\n    formatted_results = []\n\n    for case_key in case_order:\n        data = np.array(test_cases[case_key])\n        n = len(data)\n        \n        if n == 0:\n            # Handle empty data case, though not present in tests\n            continue \n            \n        t_mean = np.mean(data)\n        # To avoid log(0) for potential t_i <= 0, as per gamma distribution definition\n        if np.any(data <= 0):\n            # This model is for t > 0, invalid data\n            continue\n        sum_log_t = np.sum(np.log(data))\n\n        best_k = -1\n        max_log_likelihood = -np.inf\n\n        # Iterate through possible numbers of steps k\n        for k in range(1, K_max + 1):\n            # Profile log-likelihood for a given k\n            # Formula: l(k) = nk*ln(k) - nk*ln(t_mean) + (k-1)*sum(ln(t_i)) - nk - n*ln(Gamma(k))\n            \n            # The term ln(Gamma(k)) is computed using scipy.special.gammaln\n            log_likelihood = (n * k * np.log(k) - \n                              n * k * np.log(t_mean) + \n                              (k - 1) * sum_log_t - \n                              n * k - \n                              n * gammaln(k))\n\n            if log_likelihood > max_log_likelihood:\n                max_log_likelihood = log_likelihood\n                best_k = k\n\n        # Calculate lambda and tau for the optimal k\n        lambda_hat = best_k / t_mean\n        tau_hat = 1.0 / lambda_hat\n        \n        # Format the result list as a string [k,lambda,tau]\n        # lambda and tau must be displayed with exactly 4 decimal places.\n        formatted_case_result = f\"[{best_k},{lambda_hat:.4f},{tau_hat:.4f}]\"\n        formatted_results.append(formatted_case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2489172"}]}