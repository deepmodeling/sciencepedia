{"hands_on_practices": [{"introduction": "这项练习是基础性的，它演示了如何将可观察到的流行病数据——病例数的初始指数增长——与传播力的核心参数，即基本再生数（$R_0$）联系起来。通过使用更新方程和给定的代际间隔分布，您将练习一项关键技能：从监测数据中推断潜在的传播动力学 [@problem_id:2489931]。", "problem": "一种呼吸道病原体在一个庞大的、完全易感的大都市人群中出现。在最初几周，由于缺乏控制措施，监测系统以可忽略的报告延迟和相对于泊松过程可忽略的过度离散度，捕获了每日症状发作的发病率。通过将最早的计数汇总到等长的非重叠时间窗口中，流行病学家获得了以下早期疫情发病率轨迹，假定其处于初始指数增长阶段：\n\n- 在时间 $t=0$ 天时：$I(0)=25$ 例新发病例。\n- 在时间 $t=5$ 天时：$I(5)=50$ 例新发病例。\n- 在时间 $t=10$ 天时：$I(10)=100$ 例新发病例。\n- 在时间 $t=15$ 天时：$I(15)=200$ 例新发病例。\n- 在时间 $t=20$ 天时：$I(20)=400$ 例新发病例。\n\n假设早期发病率遵循指数增长定律 $I(t)=I(0)\\exp(rt)$，其中 $r$ 是恒定的人均增长率（单位为 $\\text{day}^{-1}$）。代际间隔概率密度 $w(a)$（从原代感染到其续发感染的时间 $a$ 的分布）被建模为形状参数 $k=4$、尺度参数 $\\theta=1.25$ 天的伽马分布，即\n$$\nw(a)=\\frac{a^{k-1}\\exp\\!\\left(-a/\\theta\\right)}{\\Gamma(k)\\,\\theta^{k}}, \\quad a0.\n$$\n使用针对恒定基本再生数（$R_0$）：在完全易感人群中，单个原代感染所引起的续发感染的平均数）的初始阶段传播的经典更新公式，根据上述数据和假设计算 $R_0$。使用早期疫情发病率数据，从第一性原理确定 $r$，然后在更新框架下根据 $r$ 和 $w(a)$ 推断 $R_0$。仅报告最终的 $R_0$ 值，该值应为一个纯数字（无单位），并四舍五入到四位有效数字。", "solution": "所提出的问题是数理流行病学中的一个标准练习，在尝试求解之前需要进行验证。\n\n首先，我将逐字提取给定的信息。\n- 在时间 $t=0$ 时的初始发病率为 $I(0)=25$。\n- 在时间 $t=5$ 时的发病率为 $I(5)=50$。\n- 在时间 $t=10$ 时的发病率为 $I(10)=100$。\n- 在时间 $t=15$ 时的发病率为 $I(15)=200$。\n- 在时间 $t=20$ 时的发病率为 $I(20)=400$。\n- 发病率轨迹由指数增长定律 $I(t)=I(0)\\exp(rt)$ 建模，其中 $r$ 是恒定的疫情增长率。\n- 代际间隔分布 $w(a)$ 是一个形状参数 $k=4$、尺度参数 $\\theta=1.25$ 天的伽马分布。其概率密度函数由 $w(a)=\\frac{a^{k-1}\\exp(-a/\\theta)}{\\Gamma(k)\\,\\theta^{k}}$ 给出，其中 $a0$。\n- 任务是计算基本再生数 $R_0$。\n\n现在，我将验证问题陈述。\n该问题具有科学依据，利用了疫情早期的典型指数增长模型和更新方程（这是传染病动力学中的一个基本概念）。伽马分布是模拟代际间隔的标准且合适的选择。该问题是适定的，提供了确定唯一解所需的所有参数和数据。数据内部一致，术语精确客观。该问题不违反任何无效标准。它是在指定领域内一个可形式化、可解决的问题。\n\n结论是该问题有效。我现在将继续进行求解。\n\n解决方案需要两个主要步骤：首先，根据给定的发病率数据确定指数增长率 $r$；其次，通过代际间隔分布 $w(a)$ 将该增长率 $r$ 与基本再生数 $R_0$ 联系起来。\n\n步骤 1：确定增长率 $r$。\n假定发病率 $I(t)$ 遵循定律 $I(t) = I(0)\\exp(rt)$。我们可以通过取两个不同时间点的发病率之比来确定 $r$。我们使用 $t_1=0$ 和 $t_2=5$ 天。\n$$\n\\frac{I(t_2)}{I(t_1)} = \\frac{I(0)\\exp(rt_2)}{I(0)\\exp(rt_1)} = \\exp(r(t_2-t_1))\n$$\n代入给定值，$I(5)=50$ 和 $I(0)=25$：\n$$\n\\frac{50}{25} = \\exp(r(5-0))\n$$\n$$\n2 = \\exp(5r)\n$$\n为了求解 $r$，我们对等式两边取自然对数：\n$$\n\\ln(2) = 5r\n$$\n$$\nr = \\frac{\\ln(2)}{5}\n$$\n该值的单位是 $\\text{day}^{-1}$。可以使用任何其他时间区间来验证所提供数据的一致性。例如，在 $t=15$ 和 $t=20$ 之间：\n$$\n\\frac{I(20)}{I(15)} = \\frac{400}{200} = 2 = \\exp(r(20-15)) = \\exp(5r)\n$$\n这再次得到 $r = \\frac{\\ln(2)}{5}$。数据与这个恒定的增长率完全一致。\n\n步骤 2：将 $r$ 与 $R_0$ 相关联。\n更新方程将时间 $t$ 的发病率描述为过去发病率和代际过程的函数：\n$$\nI(t) = \\int_{0}^{\\infty} R_0 I(t-a) w(a) da\n$$\n这里，$R_0 w(a)$ 表示一个原代病例在时间间隔 $a$ 后产生的续发感染的期望数。\n在疫情的初始阶段，指数增长是一个有效的近似，我们将 $I(t) = C \\exp(rt)$ 代入更新方程，其中 $C$ 是一个常数。\n$$\nC \\exp(rt) = \\int_{0}^{\\infty} R_0 [C \\exp(r(t-a))] w(a) da\n$$\n我们可以从积分中提出常数项：\n$$\nC \\exp(rt) = R_0 C \\exp(rt) \\int_{0}^{\\infty} \\exp(-ra) w(a) da\n$$\n将等式两边同时除以非零的 $C \\exp(rt)$，我们得到欧拉-洛特卡方程：\n$$\n1 = R_0 \\int_{0}^{\\infty} \\exp(-ra) w(a) da\n$$\n此表达式中的积分是代际间隔分布 $w(a)$ 的矩生成函数 (MGF) 在点 $-r$ 处的定义。设 $M_a(s) = \\mathbb{E}[\\exp(sa)]$ 是随机变量 $a$ 的矩生成函数。方程变为：\n$$\n1 = R_0 M_a(-r)\n$$\n因此，$R_0$ 可以计算为：\n$$\nR_0 = \\frac{1}{M_a(-r)}\n$$\n给定代际间隔 $a$ 遵循形状参数 $k=4$、尺度参数 $\\theta=1.25$ 的伽马分布。伽马($k, \\theta$) 分布的矩生成函数由标准公式给出：\n$$\nM_a(s) = (1 - \\theta s)^{-k}\n$$\n此公式在 $s  1/\\theta$ 时有效。我们在 $s = -r$ 处计算此矩生成函数的值：\n$$\nM_a(-r) = (1 - \\theta(-r))^{-k} = (1 + r\\theta)^{-k}\n$$\n将此代回 $R_0$ 的表达式中：\n$$\nR_0 = \\frac{1}{(1 + r\\theta)^{-k}} = (1 + r\\theta)^{k}\n$$\n现在我们代入参数的数值：\n$k = 4$\n$\\theta = 1.25 = \\frac{5}{4}$ 天\n$r = \\frac{\\ln(2)}{5}$ day$^{-1}$\n\n乘积 $r\\theta$ 是：\n$r\\theta = \\left(\\frac{\\ln(2)}{5}\\right) \\left(\\frac{5}{4}\\right) = \\frac{\\ln(2)}{4}$\n现在我们计算 $R_0$：\n$R_0 = \\left(1 + \\frac{\\ln(2)}{4}\\right)^{4}$\n为了获得数值，我们使用 $\\ln(2) \\approx 0.69314718$。\n$$\nR_0 = \\left(1 + \\frac{0.69314718}{4}\\right)^{4} = (1 + 0.173286795)^{4} = (1.173286795)^{4}\n$$\n$$\nR_0 \\approx 1.8950453\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nR_0 \\approx 1.895\n$$\n这是基于所提供的数据和模型计算出的基本再生数的最终值。", "answer": "$$\n\\boxed{1.895}\n$$", "id": "2489931"}, {"introduction": "经典模型常常假设群体是同质的，但现实要复杂得多。这个问题将挑战您去探索宿主易感性的异质性如何影响群体免疫阈值。利用下一代算子（next-generation operator）的框架，您将推导出一个更精妙的公式，它揭示了为什么简单的 $1 - 1/R_0$ 阈值可能具有误导性，以及人口多样性如何在流行病结局中扮演关键角色 [@problem_id:2489976]。", "problem": "考虑一个封闭、均匀混合的易感-感染-移除 (SIR) 模型，其中存在宿主间生物易感性的变异，并且这是异质性的唯一来源。设个体层面的易感性为一个正随机变量 $X$，其概率密度函数为 $g(x)$，其均值为 $\\mathbb{E}[X]=1$，有限方差为 $\\operatorname{Var}(X)=\\sigma^{2}$。假设感染期呈指数分布，速率为 $\\gamma$，传播方式为质量作用传播，接触率为 $\\beta$，且不依赖于性状 $x$。基本再生数 ($R_0$) 定义为无病平衡点处下一代算子 (NGO) 的谱半径，群体免疫阈值定义为使 NGO 的主特征值等于 $1$ 的最小免疫比例。\n\n从这些定义和 NGO 的第一性原理出发，推导当 $X$ 服从形状参数为 $k$、尺度参数为 $1/k$ 的 Gamma 分布时（因此 $\\mathbb{E}[X]=1$ 且变异系数的平方为 $\\mathrm{CV}^{2}=\\sigma^{2}=1/k$），由疾病诱导的群体免疫阈值 $h^{\\ast}$ 的解析表达式。你的推导过程必须包括：\n- 用 NGO 和当前易感性状的密度表示部分免疫状态下的有效再生数。\n- 求解主 NGO 特征值等于 $1$ 的群体免疫条件，并将 $h^{\\ast}$ 表示为 $R_0$ 和 $\\mathrm{CV}^{2}$ 的函数。\n\n最后，对你推导的表达式，代入 $R_0=3$ 和 $\\mathrm{CV}^{2}=2$ 进行求值，并以小数形式报告 $h^{\\ast}$ 的数值。将你的答案四舍五入到四位有效数字。不要报告百分比；以小数形式报告分数。", "solution": "所述问题具有科学依据，提法恰当且客观。它基于数学流行病学的既定原理，特别是包含种群异质性的易感-感染-移除 (SIR) 模型和下一代算子 (NGO) 框架。所有必要的定义和参数都已提供，不存在矛盾或模糊之处。因此，该问题是有效的，可以推导出严谨的解。\n\n问题的核心是确定在个体对感染的易感性 $X$ 是一个随机变量的种群中，群体免疫阈值 $h^{\\ast}$ 的值。我们按照要求，从第一性原理出发，使用下一代算子形式体系。\n\n设 $S(x,t)$ 和 $I(x,t)$ 分别表示在时间 $t$ 时，具有易感性状 $x$ 的易感者和感染者的密度。总人口规模归一化为 $1$。在无病平衡点 (DFE)，种群完全易感，因此易感者的密度由性状的概率密度函数 (PDF) 给出，$S(x,0) = g(x)$。\n\n下一代算子 $K$ 描述了在一个完全易感的种群中，由一个初始的感染者分布所产生的不同宿主类型中的预期新感染数。该算子的核 $K(x,x')$ 表示由单个 $x'$ 型感染者引起的 $x$ 型新感染的预期数量。对于质量作用传播，接触率为 $\\beta$，在一个易感密度为 $g(x)$ 的种群中，一个感染者以 $\\beta$ 的速率进行传染性接触。被接触个体的类型为 $x$ 的概率密度为 $g(x)$，传播的概率与易感性 $x$ 成正比。感染期呈指数分布，速率为 $\\gamma$，因此平均持续时间为 $1/\\gamma$。因此，核与感染者类型 $x'$ 无关，由下式给出：\n$$ K(x, x') = \\frac{\\beta}{\\gamma} x g(x) $$\n该算子作用于一个代表初始感染分布的函数 $\\phi(x')$：\n$$ (K\\phi)(x) = \\int_0^\\infty K(x, x') \\phi(x') dx' = \\frac{\\beta}{\\gamma} x g(x) \\int_0^\\infty \\phi(x') dx' $$\n基本再生数 $R_0$ 是 $K$ 的谱半径。我们通过求解 $(K\\phi)(x) = \\lambda\\phi(x)$ 来找到特征值 $\\lambda$。设 $C = \\int_0^\\infty \\phi(x')dx'$。特征值方程为 $\\lambda\\phi(x) = \\frac{\\beta}{\\gamma} x g(x) C$。对两边关于 $x$ 积分得到 $\\lambda C = \\frac{\\beta}{\\gamma} C \\int_0^\\infty x g(x) dx$。对于一个非平凡解（$C \\neq 0$），唯一的非零特征值为：\n$$ \\lambda = \\frac{\\beta}{\\gamma} \\int_0^\\infty x g(x) dx = \\frac{\\beta}{\\gamma} \\mathbb{E}[X] $$\n鉴于 $\\mathbb{E}[X]=1$，基本再生数为 $R_0 = \\frac{\\beta}{\\gamma}$。\n\n现在，考虑一个部分免疫的种群。此时易感者的密度为 $s(x)$。在此状态下的算子 $K_s$ 的核为 $K_s(x, x') = \\frac{\\beta}{\\gamma} x s(x)$。该算子的主特征值是有效再生数 $R_{eff}$。遵循相同的推导：\n$$ R_{eff} = \\frac{\\beta}{\\gamma} \\int_0^\\infty x s(x) dx = R_0 \\int_0^\\infty x s(x) dx $$\n当 $R_{eff}=1$ 时达到群体免疫阈值。这种情况发生在种群获得了足够的免疫力，以至于流行病不再能增长。我们假设这种免疫力是通过感染获得的。逃脱感染的个体是那些仍然易感的人。对于一个易感性为 $x$ 的个体，在总累积感染力为 $\\Phi^{\\ast}$ 的流行病期间逃脱感染的概率是 $\\exp(-x\\Phi^{\\ast})$。因此，在群体免疫阈值处的易感者密度为 $s(x) = g(x)\\exp(-x\\Phi^{\\ast})$。\n\n$R_{eff}=1$ 的条件变为：\n$$ R_0 \\int_0^\\infty x g(x) \\exp(-x\\Phi^{\\ast}) dx = 1 $$\n仍然易感的人口比例是 $S^{\\ast} = \\int_0^\\infty s(x) dx = \\int_0^\\infty g(x) \\exp(-x\\Phi^{\\ast}) dx$。群体免疫阈值 $h^{\\ast}$ 是免疫人口的比例，所以 $h^{\\ast} = 1 - S^{\\ast}$。\n\n为了求解这些积分，我们引入易感性分布 $X$ 的矩生成函数 (MGF)，定义为 $M_X(t) = \\mathbb{E}[\\exp(tX)] = \\int_0^\\infty \\exp(tx)g(x)dx$。\n使用 MGF，我们可以写出：\n$$ S^{\\ast} = M_X(-\\Phi^{\\ast}) $$\n$$ \\int_0^\\infty x g(x) \\exp(-x\\Phi^{\\ast}) dx = \\frac{d}{dt} M_X(t) \\bigg|_{t=-\\Phi^{\\ast}} = M_X'(-\\Phi^{\\ast}) $$\n群体免疫的条件是 $R_0 M_X'(-\\Phi^{\\ast}) = 1$，阈值是 $h^{\\ast} = 1 - M_X(-\\Phi^{\\ast})$。\n\n我们已知 $X$ 服从形状参数为 $k$、尺度参数为 $1/k$ 的 Gamma 分布。形状为 $\\alpha$、尺度为 $\\theta$ 的 Gamma 分布的 MGF 是 $(1-\\theta t)^{-\\alpha}$。对于我们的参数，这变为：\n$$ M_X(t) = \\left(1 - \\frac{t}{k}\\right)^{-k} $$\n其一阶导数为：\n$$ M_X'(t) = -k \\left(1 - \\frac{t}{k}\\right)^{-k-1} \\left(-\\frac{1}{k}\\right) = \\left(1 - \\frac{t}{k}\\right)^{-k-1} $$\n我们确认 $\\mathbb{E}[X] = M_X'(0) = 1$，且 $\\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = M_X''(0) - 1 = \\frac{k+1}{k} - 1 = \\frac{1}{k}$。由于 $\\mathrm{CV}^2 = \\sigma^2 / (\\mathbb{E}[X])^2 = \\sigma^2 = \\operatorname{Var}(X)$，我们有 $\\mathrm{CV}^2 = 1/k$。\n\n现在我们求解群体免疫条件 $R_0 M_X'(-\\Phi^{\\ast}) = 1$：\n$$ R_0 \\left(1 - \\frac{-\\Phi^{\\ast}}{k}\\right)^{-k-1} = 1 \\implies R_0 \\left(1 + \\frac{\\Phi^{\\ast}}{k}\\right)^{-k-1} = 1 $$\n求解包含 $\\Phi^{\\ast}$ 的项：\n$$ \\left(1 + \\frac{\\Phi^{\\ast}}{k}\\right)^{k+1} = R_0 \\implies 1 + \\frac{\\Phi^{\\ast}}{k} = R_0^{\\frac{1}{k+1}} $$\n现在我们求群体免疫阈值 $h^{\\ast}$：\n$$ h^{\\ast} = 1 - S^{\\ast} = 1 - M_X(-\\Phi^{\\ast}) = 1 - \\left(1 - \\frac{-\\Phi^{\\ast}}{k}\\right)^{-k} = 1 - \\left(1 + \\frac{\\Phi^{\\ast}}{k}\\right)^{-k} $$\n代入 $(1 + \\Phi^{\\ast}/k)$ 的表达式：\n$$ h^{\\ast} = 1 - \\left(R_0^{\\frac{1}{k+1}}\\right)^{-k} = 1 - R_0^{-\\frac{k}{k+1}} $$\n问题要求用 $R_0$ 和 $\\mathrm{CV}^2$ 表示该表达式。我们使用关系式 $\\mathrm{CV}^2 = 1/k$，这意味着 $k = 1/\\mathrm{CV}^2$。指数变为：\n$$ \\frac{k}{k+1} = \\frac{1/\\mathrm{CV}^2}{1/\\mathrm{CV}^2 + 1} = \\frac{1/\\mathrm{CV}^2}{(1+\\mathrm{CV}^2)/\\mathrm{CV}^2} = \\frac{1}{1+\\mathrm{CV}^2} $$\n因此，由疾病诱导的群体免疫阈值的最终解析表达式是：\n$$ h^{\\ast} = 1 - R_0^{-\\frac{1}{1+\\mathrm{CV}^2}} $$\n这个结果表明，对于给定的 $R_0  1$，增加异质性（即增加 $\\mathrm{CV}^2$）会降低群体免疫阈值。在 $\\mathrm{CV}^2 \\to 0$ 的同质极限情况下，我们恢复了经典结果 $h^{\\ast} = 1 - 1/R_0$。\n\n最后，我们用给定的值 $R_0 = 3$ 和 $\\mathrm{CV}^2 = 2$ 来计算这个表达式的值。\n$$ h^{\\ast} = 1 - 3^{-\\frac{1}{1+2}} = 1 - 3^{-\\frac{1}{3}} = 1 - \\frac{1}{\\sqrt[3]{3}} $$\n我们计算其数值：\n$$ \\sqrt[3]{3} \\approx 1.44224957 $$\n$$ 3^{-1/3} \\approx 0.69336127 $$\n$$ h^{\\ast} \\approx 1 - 0.69336127 \\approx 0.30663873 $$\n四舍五入到四位有效数字，我们得到 $h^{\\ast} \\approx 0.3066$。", "answer": "$$\\boxed{0.3066}$$", "id": "2489976"}, {"introduction": "在资源有限的情况下，我们应如何部署干预措施以实现最大效果？这项实践将流行病学理论应用于一个关键的公共卫生问题：疫苗的分配策略。您将使用下一代矩阵（next-generation matrix）来为一个具有不同接触率的群体建模，并运用优化技术来确定能够最有效地降低整体再生数的疫苗接种策略 [@problem_id:2490026]。", "problem": "一种直接传播的呼吸道病原体出现在一个宿主种群中，该种群被划分为两个接触率不同的亚种群。假设混合是频率依赖、成比例的。设两个亚种群由 $i \\in \\{1,2\\}$ 索引，其种群规模分别为 $N_{1}$ 和 $N_{2}$，每人每天的平均接触次数分别为 $c_{1}$ 和 $c_{2}$。每次接触的传播概率为 $q$，平均传染期为 $D$。现有可将易感性降低因子 $1 - \\epsilon$（其中 $0  \\epsilon  1$）的疫苗，并且第 $i$ 组中有比例为 $v_{i}$ 的个体可以接种疫苗。假设疫苗接种不影响传染性或接触率。设可用疫苗总剂量为 $M$，因此分配必须满足剂量约束 $N_{1} v_{1} + N_{2} v_{2} = M$，其中 $0 \\leq v_{i} \\leq 1$。\n\n从下一代矩阵（NGM）的基本定义出发，其中条目 $K_{ij}$ 是在一个完全易感的种群中，由第 $j$ 组中的一个典型原发病例在第 $i$ 组中引起的预期继发感染数，推导成比例混合下的 NGM，并说明疫苗接种如何对其进行修正。然后，使用 Lagrangian 优化，构建并求解约束优化问题，以选择 $v_{1}$ 和 $v_{2}$ 来最小化有效再生数 $R_{e}$，该值等于接种疫苗后的 NGM 的谱半径。\n\n使用以下参数值：$N_{1} = 1.0 \\times 10^{5}$，$N_{2} = 2.0 \\times 10^{5}$，$c_{1} = 20$，$c_{2} = 5$，$q = 0.02$，$D = 4$，$\\epsilon = 0.8$，$M = 1.3 \\times 10^{5}$。将最优分配报告为行向量 $\\bigl(v_{1}^{\\ast}, v_{2}^{\\ast}\\bigr)$，其中每个分量是其各自组别接种疫苗的比例。将最终分配的每个分量四舍五入到四位有效数字。最终答案中不包含单位。", "solution": "问题陈述经评估，被认为是科学上合理、定义明确且客观的。它为数学流行病学中的一个标准问题提供了一套完整且一致的数据和条件。因此，我将进行完整的解答。\n\n该问题要求推导下一代矩阵（NGM）、其在疫苗接种下的修正，并求解一个优化问题，以找到最小化有效再生数 $R_e$ 的疫苗分配方案 $(v_1, v_2)$。\n\n首先，我们推导完全易感种群的下一代矩阵（NGM），用矩阵 $K$ 表示。元素 $K_{ij}$ 表示由亚种群 $j$ 中的单个感染者在亚种群 $i$ 中引起的预期新感染数。传播是频率依赖的，且混合是成比例的。\n\n来自第 $j$ 组的感染者每天的接触率为 $c_j$。在成比例混合下，任何一次接触是与第 $i$ 组个体的概率，与第 $i$ 组的规模相对于总人口的比例成正比，即 $\\frac{N_i}{N}$，其中 $N = N_1 + N_2$。\n来自第 $j$ 组的单个感染者与第 $i$ 组个体接触的速率为 $c_j \\frac{N_i}{N}$。\n每次接触的传播概率是 $q$。由于假设种群是完全易感的，由第 $j$ 组的单个感染者在第 $i$ 组中产生新感染的速率为 $c_j \\frac{N_i}{N} q$。\n平均传染期为 $D$。\n因此，由第 $j$ 组的单个原发病例在第 $i$ 组中引起的总预期继发感染数为：\n$$ K_{ij} = \\left(c_j \\frac{N_i}{N}\\right) q D $$\n这定义了 $2 \\times 2$ 下一代矩阵 $K$ 的条目：\n$$ K = \\begin{pmatrix} c_1 \\frac{N_1}{N} q D  c_2 \\frac{N_1}{N} q D \\\\ c_1 \\frac{N_2}{N} q D  c_2 \\frac{N_2}{N} q D \\end{pmatrix} $$\n该矩阵可以表示为两个向量的外积：\n$$ K = \\frac{qD}{N} \\begin{pmatrix} N_1 \\\\ N_2 \\end{pmatrix} \\begin{pmatrix} c_1  c_2 \\end{pmatrix} $$\n\n接下来，我们考虑疫苗接种的影响。疫苗将易感性降低了因子 $1 - \\epsilon$。在亚种群 $i$ 中，有比例为 $v_i$ 的个体接种了疫苗。亚种群 $i$ 中个体的平均易感性是未接种者和已接种者易感性的加权平均值：$(1-v_i) \\cdot 1 + v_i \\cdot (1-\\epsilon) = 1 - v_i + v_i - v_i\\epsilon = 1 - v_i\\epsilon$。\n疫苗接种仅影响接受方种群的易感性。因此，第 $i$ 组中的新感染数会减少这个因子。接种疫苗后 NGM（记为 $K_v$）的条目 $K_{v,ij}$ 由 $K_{ij}$ 乘以第 $i$ 组的平均易感性给出。\n$$ K_{v,ij} = K_{ij} (1 - v_i\\epsilon) $$\n因此，接种疫苗后的 NGM 为：\n$$ K_v = \\begin{pmatrix} K_{11}(1-v_1\\epsilon)  K_{12}(1-v_1\\epsilon) \\\\ K_{21}(1-v_2\\epsilon)  K_{22}(1-v_2\\epsilon) \\end{pmatrix} = \\begin{pmatrix} c_1 \\frac{N_1}{N} q D (1-v_1\\epsilon)  c_2 \\frac{N_1}{N} q D (1-v_1\\epsilon) \\\\ c_1 \\frac{N_2}{N} q D (1-v_2\\epsilon)  c_2 \\frac{N_2}{N} q D (1-v_2\\epsilon) \\end{pmatrix} $$\n与 $K$ 类似，$K_v$ 是一个秩为1的矩阵，可以写成外积形式：\n$$ K_v = \\frac{qD}{N} \\begin{pmatrix} N_1(1-v_1\\epsilon) \\\\ N_2(1-v_2\\epsilon) \\end{pmatrix} \\begin{pmatrix} c_1  c_2 \\end{pmatrix} $$\n有效再生数 $R_e$ 是 $K_v$ 的谱半径（主特征值）。对于形式为 $\\mathbf{u}\\mathbf{w}^T$ 的秩为1的矩阵，其谱半径为 $\\mathbf{w}^T\\mathbf{u}$。\n$$ R_e(v_1, v_2) = \\rho(K_v) = \\frac{qD}{N} \\left[ c_1 N_1(1-v_1\\epsilon) + c_2 N_2(1-v_2\\epsilon) \\right] $$\n我们的目标是在给定约束条件下最小化 $R_e(v_1, v_2)$。\n$$ R_e(v_1, v_2) = \\frac{qD}{N} [ (c_1 N_1 + c_2 N_2) - \\epsilon(c_1 N_1 v_1 + c_2 N_2 v_2) ] $$\n由于 $\\frac{qD}{N}$ 和 $\\epsilon$ 是正常数，最小化 $R_e$ 等价于最大化函数 $f(v_1, v_2) = c_1 N_1 v_1 + c_2 N_2 v_2$。\n\n优化问题是：\n最大化 $f(v_1, v_2) = c_1 N_1 v_1 + c_2 N_2 v_2$\n约束条件为：\n1. 剂量约束：$g(v_1, v_2) = N_1 v_1 + N_2 v_2 - M = 0$\n2. 可行性约束：$0 \\leq v_1 \\leq 1$ 且 $0 \\leq v_2 \\leq 1$\n\n我们使用 Lagrangian 优化。在等式约束下最大化 $f$ 的 Lagrangian 函数是：\n$$ \\mathcal{L}(v_1, v_2, \\lambda) = c_1 N_1 v_1 + c_2 N_2 v_2 - \\lambda(N_1 v_1 + N_2 v_2 - M) $$\n对 $v_1$ 和 $v_2$ 求偏导数并设为零，以找到内部极值点（其中 $0  v_i  1$）：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial v_1} = c_1 N_1 - \\lambda N_1 = N_1(c_1 - \\lambda) = 0 \\implies \\lambda = c_1 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial v_2} = c_2 N_2 - \\lambda N_2 = N_2(c_2 - \\lambda) = 0 \\implies \\lambda = c_2 $$\n内部解要求 $c_1 = c_2$。然而，给定参数为 $c_1 = 20$ 和 $c_2 = 5$，所以 $c_1 \\neq c_2$。这意味着极值点不出现在可行域的内部，而必须位于其边界上。这是预料之中的，因为我们是在一个凸区域（由约束定义的线段）上最大化一个线性函数。最大值必须出现在该可行区域的某个顶点上。\n\n项 $c_i$ 可以看作是为第 $i$ 组的个体接种疫苗的“价值”或“回报”，因为它是目标函数中区分两个组的关键参数。由于 $c_1  c_2$，为第 1 组的个体接种疫苗比为第 2 组的个体接种疫苗，每剂疫苗能带来更大的 $R_e$ 降幅。因此，最优策略是优先为高接触率的第 1 组接种疫苗。\n\n我们将尽可能多的剂量分配给第 1 组，直到第 1 组全部接种完毕（$v_1=1$）或剂量用完。\n完全接种第 1 组所需的剂量数为 $N_1 = 1.0 \\times 10^5$。\n可用总剂量为 $M = 1.3 \\times 10^5$。\n由于 $M  N_1$，我们有足够的剂量完全接种第 1 组。因此，第 1 组的最优接种比例为 $v_1^* = 1$。\n\n用于第 1 组的剂量数为 $N_1 v_1^* = (1.0 \\times 10^5) \\times 1 = 1.0 \\times 10^5$。\n剩余剂量数为 $M - N_1 v_1^* = 1.3 \\times 10^5 - 1.0 \\times 10^5 = 0.3 \\times 10^5$。\n这些剩余剂量被分配给第 2 组。\n第 2 组接种疫苗的个体数量为 $N_2 v_2^* = 0.3 \\times 10^5$。\n第 2 组的人口为 $N_2 = 2.0 \\times 10^5$。\n第 2 组需要接种的比例为：\n$$ v_2^* = \\frac{0.3 \\times 10^5}{N_2} = \\frac{0.3 \\times 10^5}{2.0 \\times 10^5} = \\frac{0.3}{2.0} = 0.15 $$\n最终分配方案 $(v_1^*, v_2^*) = (1, 0.15)$ 满足所有约束条件：$v_1^*=1 \\in [0, 1]$，$v_2^*=0.15 \\in [0, 1]$，并且 $N_1 v_1^* + N_2 v_2^* = (1.0 \\times 10^5)(1) + (2.0 \\times 10^5)(0.15) = 1.0 \\times 10^5 + 0.3 \\times 10^5 = 1.3 \\times 10^5 = M$。\n\n最优分配为 $v_1^* = 1$ 和 $v_2^* = 0.15$。问题要求将每个分量四舍五入到四位有效数字。\n$v_1^* = 1.000$\n$v_2^* = 0.1500$\n\n最终的最优分配是行向量 $(1.000, 0.1500)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.000  0.1500\n\\end{pmatrix}\n}\n$$", "id": "2490026"}]}