{"hands_on_practices": [{"introduction": "T细胞的激活始于T细胞受体（TCR）与抗原呈递细胞表面肽-主要组织相容性复合物（pMHC）的结合。这个初始识别事件的物理化学特性，尤其是结合与解离的动力学，是决定下游信号能否有效触发的关键。本练习将引导您运用二维结合动力学和动力学校对（kinetic proofreading）模型的基本原理，通过计算来定量评估这一关键的初始步骤[@problem_id:2536740]。您将推导出特定条件下TCR的稳态占有率，并判断TCR-pMHC复合物的平均停留时间是否满足激活信号的理论阈值，从而深化对T细胞信号触发机制的定量理解。", "problem": "一个T细胞受体（TCR）与肽-主要组织相容性复合物（pMHC）配体结合，该结合发生在细胞间的接触界面上，其中TCR和pMHC都被限制在二维的细胞膜上。设微观二维结合速率常数为 $k_{\\text{on}}$，单位为 $\\mu\\text{m}^{2}/(\\text{分子}\\cdot \\text{s})$，解离速率为 $k_{\\text{off}}$，单位为 $\\text{s}^{-1}$。假设在一个充分混合的接触微域中，pMHC的表面密度 $\\rho_{L}$（分子/$\\mu\\text{m}^{2}$）是均匀的，并考虑在TCR密度非限制性的伪一级反应条件下，单个受体的占据情况。将受体-配体结合建模为可逆反应 $R + L \\rightleftharpoons C$，并令 $x(t)$ 表示在时间 $t$ 时，一个给定的TCR与配体结合的概率。\n\n从质量作用定律出发，并忽略扩散限制，推导稳态占据率 $x^{\\ast}$ 关于 $k_{\\text{on}}$、$k_{\\text{off}}$ 和 $\\rho_{L}$ 的表达式。另外，假设有效的信号传导需要完成一个包含 $L$ 个步骤的动力学校对序列，每步速率为 $k_{p}$，因此最小信号传导时间为 $\\tau_{\\ast} = L/k_{p}$。使用标准的单步解离模型，其中TCR-pMHC复合物的平均停留时间为 $\\tau_{\\text{dwell}} = 1/k_{\\text{off}}$，判断激活条件 $\\tau_{\\text{dwell}}  \\tau_{\\ast}$ 是否满足。\n\n使用以下参数值：\n- $k_{\\text{on}} = 4.0 \\times 10^{-3}\\ \\mu\\text{m}^{2}/(\\text{分子}\\cdot \\text{s})$\n- $k_{\\text{off}} = 0.80\\ \\text{s}^{-1}$\n- $\\rho_{L} = 50\\ \\text{分子}/\\mu\\text{m}^{2}$\n- $L = 3$\n- $k_{p} = 2.0\\ \\text{s}^{-1}$\n\n将最终结果表示为一个双元素行向量 $\\big[x^{\\ast}, I\\big]$，其中如果 $\\tau_{\\text{dwell}}  \\tau_{\\ast}$ 则 $I = 1$，否则 $I = 0$。将 $x^{\\ast}$ 四舍五入到四位有效数字。最终答案中不包含单位。所有中间推理必须基于所述的第一性原理。", "solution": "问题陈述已经过验证，被认为是科学上合理的、提法得当的且客观的。它基于免疫学中已确立的受体-配体结合动力学和动力学校对模型的原理。所有必要的参数都已提供，问题没有矛盾或含糊不清之处。因此，可以推导出严谨的解。\n\n该问题要求计算两个量：T细胞受体（TCR）的稳态占据率，记为 $x^{\\ast}$，以及一个二元指示符 $I$，它反映了T细胞激活的条件是否得到满足。\n\n首先，我们将推导稳态占据率 $x^{\\ast}$ 的表达式。结合过程被建模为可逆反应 $R + L \\rightleftharpoons C$，其中 $R$ 是游离受体，$L$ 是配体，$C$ 是受体-配体复合物。变量 $x(t)$ 表示在时间 $t$ 单个受体处于结合状态 $C$ 的概率。因此，受体处于游离状态 $R$ 的概率是 $1 - x(t)$。\n\n结合概率的变化率 $\\frac{dx}{dt}$ 由质量作用定律决定。从未结合状态到结合状态的转变是正向反应。在伪一级反应条件下，假设配体密度 $\\rho_{L}$ 是恒定的。对于单个受体，此转变的速率是未结合概率 $1-x$ 与有效一级结合速率 $k_{\\text{on}} \\rho_{L}$ 的乘积。因此，$x$ 的增加速率为 $(1-x) k_{\\text{on}} \\rho_{L}$。\n\n从结合状态到未结合状态的转变是解离，即逆向反应。这是一个速率常数为 $k_{\\text{off}}$ 的一级过程。此转变的速率是结合概率 $x$ 与速率常数 $k_{\\text{off}}$ 的乘积。因此，$x$ 的减少速率为 $x k_{\\text{off}}$。\n\n结合这两个过程，我们得到描述占据率 $x(t)$ 的常微分方程：\n$$ \\frac{dx}{dt} = (1-x) k_{\\text{on}} \\rho_{L} - x k_{\\text{off}} $$\n在稳态下，系统处于平衡状态，意味着净变化率为零，即 $\\frac{dx}{dt} = 0$。设 $x^{\\ast}$ 为稳态时的占据率。方程变为：\n$$ 0 = (1 - x^{\\ast}) k_{\\text{on}} \\rho_{L} - x^{\\ast} k_{\\text{off}} $$\n我们继续求解这个代数方程以得到 $x^{\\ast}$：\n$$ x^{\\ast} k_{\\text{off}} = k_{\\text{on}} \\rho_{L} - x^{\\ast} k_{\\text{on}} \\rho_{L} $$\n$$ x^{\\ast} (k_{\\text{off}} + k_{\\text{on}} \\rho_{L}) = k_{\\text{on}} \\rho_{L} $$\n$$ x^{\\ast} = \\frac{k_{\\text{on}} \\rho_{L}}{k_{\\text{on}} \\rho_{L} + k_{\\text{off}}} $$\n现在，我们代入给定的数值：$k_{\\text{on}} = 4.0 \\times 10^{-3}\\ \\mu\\text{m}^{2}/(\\text{分子}\\cdot \\text{s})$，$\\rho_{L} = 50\\ \\text{分子}/\\mu\\text{m}^{2}$，以及 $k_{\\text{off}} = 0.80\\ \\text{s}^{-1}$。\n\n首先，我们计算有效结合速率 $k_{\\text{on}} \\rho_{L}$：\n$$ k_{\\text{on}} \\rho_{L} = (4.0 \\times 10^{-3}) \\cdot 50 = 0.20\\ \\text{s}^{-1} $$\n接下来，我们将此值代入 $x^{\\ast}$ 的表达式中：\n$$ x^{\\ast} = \\frac{0.20\\ \\text{s}^{-1}}{0.20\\ \\text{s}^{-1} + 0.80\\ \\text{s}^{-1}} = \\frac{0.20}{1.00} = 0.20 $$\n问题要求将此结果报告为四位有效数字。因此，$x^{\\ast} = 0.2000$。\n\n其次，我们必须评估激活条件 $\\tau_{\\text{dwell}}  \\tau_{\\ast}$，以确定指示符 $I$ 的值。我们已知平均停留时间 $\\tau_{\\text{dwell}}$ 和最小信号传导时间 $\\tau_{\\ast}$ 的定义：\n$$ \\tau_{\\text{dwell}} = \\frac{1}{k_{\\text{off}}} $$\n$$ \\tau_{\\ast} = \\frac{L}{k_{p}} $$\n用于此计算的参数为 $k_{\\text{off}} = 0.80\\ \\text{s}^{-1}$，$L = 3$，以及 $k_{p} = 2.0\\ \\text{s}^{-1}$。\n\n我们计算 $\\tau_{\\text{dwell}}$：\n$$ \\tau_{\\text{dwell}} = \\frac{1}{0.80\\ \\text{s}^{-1}} = 1.25\\ \\text{s} $$\n我们计算 $\\tau_{\\ast}$：\n$$ \\tau_{\\ast} = \\frac{3}{2.0\\ \\text{s}^{-1}} = 1.5\\ \\text{s} $$\n现在，我们通过比较这两个值来检验激活条件：\n$$ 1.25\\ \\text{s}  1.5\\ \\text{s} $$\n这个不等式显然是错误的。因此，激活条件未得到满足。根据问题定义，如果条件未满足，指示变量 $I$ 必须设为 $0$。\n\n最终结果是一个双元素行向量 $[x^{\\ast}, I]$，由我们确定的值组成。", "answer": "$$\\boxed{\\begin{pmatrix} 0.2000  0 \\end{pmatrix}}$$", "id": "2536740"}, {"introduction": "在TCR成功识别pMHC后，信号通过一系列胞内激酶和衔接蛋白组成的复杂网络向细胞核传递，其中ZAP-70激酶扮演着核心角色。理解ZAP-70作为激酶的催化功能和作为募集其他分子的支架功能之间的区别，对于剖析T细胞信号通路的完整逻辑至关重要。这个思想实验[@problem_id:2536717]要求您基于TCR近端信号通路的基础知识，预测一种激酶功能缺失的ZAP-70突变体将如何影响整个信号级联反应。通过这一练习，您将学会如何进行严密的机理推理，通过分析一个关键节点的扰动来洞察整个信号网络的结构与功能。", "problem": "您构建了一个Zeta链相关蛋白激酶70 (ZAP-70)缺陷的人类T细胞系，使其以匹配的稳态丰度表达两种拯救构筑体之一：野生型ZAP-70和激酶失活的ZAP-70 K369R突变体。细胞通过支持性脂质双层上的肽-主要组织相容性复合体(pMHC)进行T细胞受体(TCR)刺激，该双层带有细胞间粘附分子1 (ICAM-1)，但没有共刺激。您使用标准的生化和成像读数来探究TCR复合物的早期磷酸化事件以及T细胞活化接头蛋白(LAT)信号复合体的组装和功能：TCR CD3ζ免疫受体酪氨酸活化基序(ITAM)的磷酸化、ZAP-70 Y319的磷酸化、LAT Y132/Y191的磷酸化、磷脂酶C-γ1 (PLCγ1) Y783的磷酸化、胞质游离钙(Ca²⁺)流、细胞外信号调节激酶(ERK1/2)活化、TCR微簇的形成和寿命，以及由内而外的整合素活化和肌动蛋白重塑。假设淋巴细胞特异性蛋白酪氨酸激酶(Lck)的活性和膜组成正常，并且两种构筑体中由Src同源2 (SH2)结构域介导的招募相互作用都是完整的。\n\n根据TCR信号起始和支架组装的基本原理，与野生型相比，在激酶失活的ZAP-70 K369R拯救实验中，您特异性观察到的近端信号传导功能与支架功能的模式，以下哪项预测最为准确？\n\nA. CD3ζ ITAM磷酸化、ZAP-70的招募及其Y319位点的磷酸化均正常进行，TCR微簇也形成，但LAT酪氨酸的磷酸化程度很低，从而阻止了稳定的LAT信号复合体的组装；PLCγ1的活化和下游的Ca²⁺内流被阻断，ERK1/2的活化显著减弱，细胞发生初始铺展，但整合素的亲和力成熟和持续的肌动蛋白重塑减少。\n\nB. 因为ZAP-70的激酶活性是招募Lck所必需的，所以CD3ζ ITAM未能被磷酸化；因此ZAP-70不与TCR结合，LAT不被磷酸化，微簇不形成，所有下游通路完全缺失。\n\nC. 尽管缺乏ZAP-70的催化功能，但Lck的冗余活性维持了LAT的磷酸化；因此PLCγ1和Ca²⁺响应接近正常，但Ras-ERK通路由于其对ZAP-70激酶活性的独特依赖性而被选择性地损害。\n\nD. ZAP-70催化活性的丧失解除了对LAT的负反馈，导致LAT磷酸化增强、PLCγ1过度活化和过度的Ca²⁺流，尽管存在激酶失活突变。\n\nE. LAT的磷酸化得到支持，但SLP-76的招募失败，因为SLP-76结合的是ZAP-70而非LAT；因此PLCγ1的活化和Ca²⁺流正常进行，但细胞骨架重塑被选择性地损害。", "solution": "题干经过验证。\n\n**步骤1：提取已知条件**\n- **系统**：Zeta链相关蛋白激酶70 (ZAP-70)缺陷的人类T细胞系。\n- **实验条件**：细胞被构建为以匹配的稳态丰度表达两种构筑体之一：\n    1. 野生型ZAP-70。\n    2. 激酶失活的ZAP-70 K369R突变体。\n- **刺激**：通过支持性脂质双层上的肽-主要组织相容性复合体(pMHC)进行T细胞受体(TCR)衔接。\n- **辅助因子**：该双层带有细胞间粘附分子1 (ICAM-1)。未提供共刺激（例如，来自CD28配体的刺激）。\n- **检测读数**：\n    - TCR CD3ζ免疫受体酪氨酸活化基序(ITAM)的磷酸化。\n    - ZAP-70 Y319的磷酸化。\n    - T细胞活化接头蛋白(LAT) Y132/Y191的磷酸化。\n    - 磷脂酶C-γ1 (PLCγ1) Y783的磷酸化。\n    - 胞质游离钙(Ca²⁺)流。\n    - 细胞外信号调节激酶(ERK1/2)活化。\n    - TCR微簇的形成和寿命。\n    - 由内而外的整合素活化和肌动蛋白重塑。\n- **假设**：\n    - 淋巴细胞特异性蛋白酪氨酸激酶(Lck)的活性正常。\n    - 膜组成正常。\n    - 两种ZAP-70构筑体中由Src同源2 (SH2)结构域介导的招募相互作用都是完整的。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据、问题明确且客观。\n- **科学依据**：该问题描述了T细胞免疫学中的一个经典实验。ZAP-70 K369R突变体是用于剖析ZAP-70支架功能与催化功能的标准工具。信号级联（Lck $\\rightarrow$ ZAP-70 $\\rightarrow$ LAT）和下游读数都是该领域基本且公认的概念。\n- **问题明确性**：实验设置定义清晰，具有控制变量（匹配的蛋白表达）和特定边界条件（正常的Lck，完整的SH2结构域）。问题要求基于这些条件进行预测，这允许从基本原理推导出唯一的、合乎逻辑的解决方案。\n- **客观性**：问题使用了精确的技术语言，没有主观或模糊的术语。\n\n题干没有可识别的缺陷。它在科学上不是不健全、不完整、矛盾或在其他方面无效的。\n\n**步骤3：结论和行动**\n问题有效。将推导解决方案。\n\n**从基本原理推导**\n\nTCR衔接后T细胞信号的起始遵循一个明确定义的事件序列。我们将逐步分析该通路，以预测在存在激酶失活的ZAP-70 K369R突变体的情况下的结果。\n\n1.  **TCR连接和Lck活化**：pMHC与TCR的结合导致TCR微簇的形成。这种空间重组促进了与T细胞共受体（CD4或CD8）相关的Src家族激酶Lck的活化。根据题干陈述，Lck活性是正常的。\n2.  **ITAM磷酸化**：活化的Lck磷酸化与TCR相关的CD3ζ链的ITAM内的酪氨酸残基。这为下游信号蛋白创造了停泊位点。\n3.  **ZAP-70招募**：ZAP-70的串联SH2结构域以高亲和力结合到双磷酸化的ITAM上。问题明确指出，对于野生型和K369R突变体，由SH2结构域介导的招募都是完整的。因此，激酶失活的ZAP-70将成功地被招募到TCR复合物。\n4.  **Lck对ZAP-70的磷酸化**：一旦被招募到TCR，ZAP-70自身就成为Lck的底物。Lck在多个位点磷酸化ZAP-70，包括关键的域间酪氨酸Y319。这一磷酸化事件由Lck执行，并且独立于ZAP-70自身的催化活性。因此，我们预测ZAP-70 K369R将在Y319位点被磷酸化。\n5.  **ZAP-70的催化活性和底物磷酸化**：这是激酶失活突变体产生分歧的关键步骤。K369R突变位于催化结构域，消除了ZAP-70作为激酶的功能。一个完全活性的野生型ZAP-70会继续磷酸化其主要底物，即支架蛋白LAT和SLP-76。激酶失活的ZAP-70 K369R无法执行此功能。\n6.  **LAT信号复合体的组装**：ZAP-70对LAT上多个酪氨酸（如Y132和Y191）的磷酸化是“LAT信号复合体”组装的核心事件。由于激酶失活的ZAP-70未能磷酸化LAT，这些停泊位点将不会被创建。结果，像Grb2、Gads等接头蛋白和PLCγ1酶将不会被招募到LAT上。整个信号复合体的组装将被阻断。\n7.  **下游信号通路**：\n    - **PLCγ1通路**：PLCγ1的招募和随后的活化依赖于LAT支架。没有磷酸化的LAT，PLCγ1将不会定位到细胞膜并被活化。因此，PLCγ1在Y783位点的磷酸化将不会发生。这阻止了PIP₂裂解为IP₃和DAG，直接后果是，IP₃介导的胞质游离Ca²⁺流将被废除。\n    - **Ras-ERK通路**：激活Ras需要Grb2-Sos复合物招募到磷酸化的LAT上。没有LAT磷酸化，该通路在其起始阶段就被阻断，导致下游ERK1/2活化的显著减弱或完全阻断。\n    - **肌动蛋白和整合素的调节**：LAT-Gads-SLP-76复合物对于激活肌动蛋白细胞骨架的下游调节因子（例如Vav, Nck）以及介导对LFA-1等整合素的由内而外的信号传导至关重要。由LFA-1与双层膜上的ICAM-1结合介导的初始粘附将允许细胞初始铺展。然而，未能组装LAT信号复合体阻止了整合素亲和力成熟所需的由内而外的信号传导，并阻断了持续、有组织的肌动蛋白重塑的信号。其结果是无法形成稳定的免疫突触。\n\n总而言之，ZAP-70 K369R突变体充当显性负性蛋白。它被招募到TCR，但无法传递信号，从而有效地阻断了所有源自LAT支架的主要下游通路。上游事件（ITAM磷酸化、ZAP-70招募以及Lck对ZAP-70的磷酸化）保持完整。\n\n**逐项分析**\n\n**A. CD3ζ ITAM磷酸化、ZAP-70的招募及其Y319位点的磷酸化均正常进行，TCR微簇也形成，但LAT酪氨酸的磷酸化程度很低，从而阻止了稳定的LAT信号复合体的组装；PLCγ1的活化和下游的Ca²⁺内流被阻断，ERK1/2的活化显著减弱，细胞发生初始铺展，但整合素的亲和力成熟和持续的肌动蛋白重塑减少。**\n该陈述与从基本原理进行的逐步推导完全匹配。它正确地指出ZAP-70催化上游的事件（ITAM磷酸化、ZAP-70招募、Lck对ZAP-70的磷酸化）是完整的。它正确地指出了主要缺陷：未能磷酸化LAT。然后它准确地描述了下游后果：信号复合体组装失败，PLCγ1/Ca²⁺信号传导被阻断，ERK活化减弱，以及整合素/肌动蛋白响应有缺陷。\n**结论：正确。**\n\n**B. 因为ZAP-70的激酶活性是招募Lck所必需的，所以CD3ζ ITAM未能被磷酸化；因此ZAP-70不与TCR结合，LAT不被磷酸化，微簇不形成，所有下游通路完全缺失。**\n该陈述的前提存在根本性错误。因果关系颠倒了。Lck在ZAP-70活性*之前*并*独立于*ZAP-70活性而活化；事实上，需要Lck活性来为ZAP-70创建停泊位点。Lck不是由ZAP-70招募的。因此，ITAM将被磷酸化，ZAP-70将与TCR结合。\n**结论：错误。**\n\n**C. 尽管缺乏ZAP-70的催化功能，但Lck的冗余活性维持了LAT的磷酸化；因此PLCγ1和Ca²⁺响应接近正常，但Ras-ERK通路由于其对ZAP-70激酶活性的独特依赖性而被选择性地损害。**\n该陈述错误地夸大了Lck在LAT磷酸化中的作用。虽然Lck可能具有一些轻微的磷酸化LAT的能力，但ZAP-70是此步骤的主要且必需的激酶。LAT磷酸化将受到严重损害，而不是被维持。因此，LAT下游的所有通路，包括PLCγ1/Ca²⁺和Ras-ERK通路，都将受到严重影响。不存在选择性损害；两个分支都依赖于LAT支架。\n**结论：错误。**\n\n**D. ZAP-70催化活性的丧失解除了对LAT的负反馈，导致LAT磷酸化增强、PLCγ1过度活化和过度的Ca²⁺流，尽管存在激酶失活突变。**\n该陈述提出的机制与ZAP-70已确立的功能相反。ZAP-70激酶活性是LAT磷酸化的主要正向作用信号。其丧失导致信号的丧失，而不是通过解除某种假设的负反馈而增强。过度活化的预测结果与已确立的实验结果相反。\n**结论：错误。**\n\n**E. LAT的磷酸化得到支持，但SLP-76的招募失败，因为SLP-76结合的是ZAP-70而非LAT；因此PLCγ1的活化和Ca²⁺流正常进行，但细胞骨架重塑被选择性地损害。**\n该陈述包含多个错误。首先，LAT磷酸化*不*被支持，因为它需要ZAP-70的激酶活性。其次，SLP-76的招募机制被错误地描述了。经典通路涉及SLP-76与接头蛋白Gads结合，后者再与磷酸化的LAT结合。LAT-Gads-SLP-76三分子复合物的组装是信号复合体的基石。由于LAT磷酸化失败，整个复合物无法形成，从而影响其所有下游功能，而不仅仅是细胞骨架重塑。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2536717"}, {"introduction": "T细胞激活后的最终命运——分化为具有不同功能的亚群——受到微环境中多种细胞因子信号的精确调控。例如，转化生长因子-β (TGF-β) 和白细胞介素-6 (IL-6) 的相对水平共同决定了CD4⁺ T细胞是分化为调节性T细胞（Treg）还是Th17细胞。在这个实践中[@problem_id:2536752]，您将扮演一名计算免疫学家的角色，构建一个基于常微分方程（ODE）的动力学模型，以模拟这一细胞命运决策过程。您将学习如何将定性的生物学知识转化为定量的数学模型，并利用数值模拟来探索复杂调控网络中的动态行为和分化结果。", "problem": "一名开发人员被要求实现一个最小化的、基于机理的动力学模型，该模型通过一个耦合的信号转导与转录激活因子3 (STAT3) 和SMAD蛋白 (mothers against decapentaplegic同源物) 信号网络，捕捉转化生长因子-β (TGF-β) 和白细胞介素-6 (IL-6) 如何共同决定激活的CD4⁺ T细胞中叉头框蛋白P3 (Foxp3) 诱导与辅助性T细胞17 (Th17) 程序定向之间的平衡。该模型必须从以下广泛接受的基本依据出发：配体-受体信号传导随配体浓度饱和，转录因子活性以一级动力学方式生成和降解，以及基因调控相互作用可由Hill型激活和抑制函数近似。程序必须对指定的常微分方程 (ODEs) 系统进行数值积分，直至达到稳态，并返回稳态的Foxp3和Th17程序水平。\n\n需使用的基本依据：\n- 配体占据的受体分数是配体浓度的饱和函数，可通过形式为 $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$ 的Hill激活函数建模。\n- 相应的Hill抑制函数为 $H_{\\mathrm{rep}}(x;K,n) = \\dfrac{K^n}{K^n + x^n} = 1 - H_{\\mathrm{act}}(x;K,n)$。\n- 转录因子活性变量在生成和一级降解下演化：$\\dfrac{dX}{dt} = \\text{production} - k_{\\mathrm{deg}} X$，其中 $X$ 可在不失一般性的情况下缩放到 $[0,1]$。\n\n模型变量 (均为无量纲，缩放到 $[0,1]$)：\n- $S_3(t)$: 活性STAT3水平。\n- $S_M(t)$: 活性SMAD水平。\n- $F(t)$: Foxp3水平。\n- $R(t)$: Th17程序代理 (例如，RORγt驱动的输出)。\n\n外部输入 (带物理单位)：\n- TGF-β浓度，单位为 ng/mL。\n- IL-6浓度，单位为 ng/mL。\n\n需实现的动力学：\n- STAT3的激活由IL-6驱动并衰减：\n$$\n\\dfrac{d S_3}{dt} \\;=\\; k_{s3}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{IL}6; K_{\\mathrm{IL}6}, n_{\\mathrm{IL}6}\\big)\\,\\big(1 - S_3\\big)\\;-\\; d_{s3}\\, S_3.\n$$\n- SMAD的激活由TGF-β驱动并衰减：\n$$\n\\dfrac{d S_M}{dt} \\;=\\; k_{sm}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{TGF}\\beta; K_{\\mathrm{TGF}\\beta}, n_{\\mathrm{TGF}\\beta}\\big)\\,\\big(1 - S_M\\big)\\;-\\; d_{sm}\\, S_M.\n$$\n- Foxp3由SMAD促进，由STAT3抑制：\n$$\n\\dfrac{d F}{dt} \\;=\\; k_{f}\\, H_{\\mathrm{act}}\\!\\big(S_M; K_{sm\\to f}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_3; K_{s3\\to f}, n\\big)\\,\\big(1 - F\\big)\\;-\\; d_{f}\\, F.\n$$\n- Th17程序由STAT3促进，由SMAD和Foxp3抑制：\n$$\n\\dfrac{d R}{dt} \\;=\\; k_{r}\\, H_{\\mathrm{act}}\\!\\big(S_3; K_{s3\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_M; K_{sm\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(F; K_{f\\to r}, n\\big)\\,\\big(1 - R\\big)\\;-\\; d_{r}\\, R.\n$$\n\n需使用的所有参数值 (科学上合理，量纲一致)：\n- Hill指数: $n_{\\mathrm{IL}6} = 2$, $n_{\\mathrm{TGF}\\beta} = 2$, $n = 2$。\n- 配体灵敏度: $K_{\\mathrm{IL}6} = 1.0\\ \\mathrm{ng}/\\mathrm{mL}$, $K_{\\mathrm{TGF}\\beta} = 0.5\\ \\mathrm{ng}/\\mathrm{mL}$。\n- 交叉调控灵敏度 (无量纲，因为调控因子已缩放): $K_{sm\\to f} = 0.3$, $K_{s3\\to f} = 0.3$, $K_{s3\\to r} = 0.3$, $K_{sm\\to r} = 0.3$, $K_{f\\to r} = 0.3$。\n- 生成和降解速率 (每个任意时间单位): $k_{s3} = 1.0$, $d_{s3} = 0.5$, $k_{sm} = 1.0$, $d_{sm} = 0.5$, $k_{f} = 1.0$, $d_{f} = 0.2$, $k_{r} = 1.0$, $d_{r} = 0.2$。\n\n数值积分要求：\n- 使用时间步长 $\\Delta t = 0.01$ 的固定步长经典四阶龙格－库塔 (RK4) 方法。\n- $t=0$时的初始条件：$S_3(0)=0$, $S_M(0)=0$, $F(0)=0$, $R(0)=0$。\n- 积分直到稳态或达到最大时间。稳态定义为在至少 $100$ 步后 $\\max\\{|X_{t+\\Delta t} - X_t|\\}  \\varepsilon$ 且 $\\varepsilon = 10^{-8}$，以避免过早停止。使用最大模拟时间 $T_{\\max} = 200.0$ (任意时间单位)。将最终状态裁剪到 $[0,1]$。\n- 报告稳态的 $F$ 和 $R$，四舍五入到 $3$ 位小数 (无单位分数)。\n\n测试套件 (输入单位为 ng/mL):\n- 案例 1: TGF-β = 5.0, IL-6 = 0.1。\n- 案例 2: TGF-β = 0.1, IL-6 = 10.0。\n- 案例 3: TGF-β = 0.0, IL-6 = 0.0。\n- 案例 4: TGF-β = 5.0, IL-6 = 5.0。\n- 案例 5: TGF-β = 10.0, IL-6 = 1.0。\n\n要求的最终输出格式：\n- 您的程序必须生成单行输出，其中包含测试套件的结果列表，每个结果是该案例的配对 $[F^\\ast, R^\\ast]$。总输出必须是这些配对的单个列表，不含空格，例如：$[[f_1,r_1],[f_2,r_2],\\dots]$，其中每个 $f_i$ 和 $r_i$ 是四舍五入到 $3$ 位小数的浮点数。最终输出是无单位的 (在 $[0,1]$ 范围内的分数)。", "solution": "我们将免疫学规范转化为一个基于可饱和信号传导和一级周转的动力学系统。其核心原理是：配体-受体信号传导会饱和，我们用Hill函数对此建模；转录因子或程序变量的生成速率与激活信号成正比，并以一级动力学方式降解；相互调控通过Hill激活和抑制函数的乘积组合来实现。这体现了转化生长因子-β (TGF-β) 诱导SMAD蛋白 (mothers against decapentaplegic同源物) 信号传导以促进叉头框蛋白P3 (Foxp3)，而白细胞介素-6 (IL-6) 诱导信号转导与转录激活因子3 (STAT3) 信号传导以促进辅助性T细胞17 (Th17) 程序，同时Foxp3和Th17轴之间存在交叉抑制的逻辑。\n\n数学构建模块：\n- Hill激活函数 $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$ 近似了随着 $x$ 增加而趋于饱和至 $1$ 的受体占有率和下游激活。\n- Hill抑制函数 $H_{\\mathrm{rep}}(x;K,n) = \\dfrac{K^n}{K^n + x^n} = 1 - H_{\\mathrm{act}}(x;K,n)$ 随着抑制剂的增加而减小。\n- 一级周转由 $\\dfrac{dX}{dt} = \\text{production} - k_{\\mathrm{deg}} X$ 表示。\n\n我们定义四个无量纲状态变量：$S_3$ (活性STAT3)、 $S_M$ (活性SMAD)、 $F$ (Foxp3) 和 $R$ (Th17程序)。外部输入分别是TGF-β和IL-6的浓度，单位为 ng/mL。常微分方程(ODE)系统如下：\n$$\n\\dfrac{d S_3}{dt} \\;=\\; k_{s3}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{IL}6; K_{\\mathrm{IL}6}, n_{\\mathrm{IL}6}\\big)\\,\\big(1 - S_3\\big)\\;-\\; d_{s3}\\, S_3,\n$$\n$$\n\\dfrac{d S_M}{dt} \\;=\\; k_{sm}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{TGF}\\beta; K_{\\mathrm{TGF}\\beta}, n_{\\mathrm{TGF}\\beta}\\big)\\,\\big(1 - S_M\\big)\\;-\\; d_{sm}\\, S_M,\n$$\n$$\n\\dfrac{d F}{dt} \\;=\\; k_{f}\\, H_{\\mathrm{act}}\\!\\big(S_M; K_{sm\\to f}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_3; K_{s3\\to f}, n\\big)\\,\\big(1 - F\\big)\\;-\\; d_{f}\\, F,\n$$\n$$\n\\dfrac{d R}{dt} \\;=\\; k_{r}\\, H_{\\mathrm{act}}\\!\\big(S_3; K_{s3\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_M; K_{sm\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(F; K_{f\\to r}, n\\big)\\,\\big(1 - R\\big)\\;-\\; d_{r}\\, R.\n$$\n\n选择参数值以反映典型的定性灵敏度和时间尺度：Hill指数 $n_{\\mathrm{IL}6} = 2$, $n_{\\mathrm{TGF}\\beta} = 2$, $n = 2$；配体半有效浓度 $K_{\\mathrm{IL}6} = 1.0\\ \\mathrm{ng}/\\mathrm{mL}$ 和 $K_{\\mathrm{TGF}\\beta} = 0.5\\ \\mathrm{ng}/\\mathrm{mL}$，以反映TGF-β通常在比IL-6更低的浓度下有效发信号；交叉调控半水平 $K_{sm\\to f} = 0.3$, $K_{s3\\to f} = 0.3$, $K_{s3\\to r} = 0.3$, $K_{sm\\to r} = 0.3$, $K_{f\\to r} = 0.3$；生成和降解速率 $k_{s3} = 1.0$, $d_{s3} = 0.5$, $k_{sm} = 1.0$, $d_{sm} = 0.5$, $k_{f} = 1.0$, $d_{f} = 0.2$, $k_{r} = 1.0$, $d_{r} = 0.2$。这些参数确保 $S_3$ 和 $S_M$ 能够迅速达到依赖于配体的平台期，而 $F$ 和 $R$ 则整合上游信号和交叉抑制，并更缓慢地达到稳定。\n\n算法方法：\n- 使用时间步长 $\\Delta t = 0.01$ 的经典四阶龙格－库塔 (RK4) 方法从初始条件 $S_3(0)=0$, $S_M(0)=0$, $F(0)=0$, $R(0)=0$ 开始积分。\n- 在至少 $100$ 步之后，检查每一步的最大绝对变化 $\\max\\{|X_{t+\\Delta t} - X_t|\\}$；如果该值低于 $\\varepsilon = 10^{-8}$，则宣告达到稳态。\n- 如果模拟时间超过 $T_{\\max} = 200.0$，则停止，通过小的 $\\Delta t$ 和有界非线性确保数值稳定性。\n- 将最终值裁剪到 $[0,1]$ 以遵循缩放规则，并将 $F$ 和 $R$ 四舍五入到 $3$ 位小数以供报告。\n\n基于基本原理的解释性预期：\n- 高TGF-β与低IL-6会产生高 $S_M$ 和低 $S_3$，因此 $F$ 被强烈生成，而 $R$ 被 $S_M$ 和 $F$ 双重抑制，从而有利于Foxp3诱导而非Th17分化。\n- 低TGF-β与高IL-6会产生高 $S_3$ 和低 $S_M$，因此 $R$ 被生成而 $F$ 被抑制，从而有利于Th17。\n- 两种细胞因子均缺失时，两条轴都保持关闭状态。\n- 当两种输入都很高时，交叉抑制和双重促进会产生竞争；在所选参数下，强大的SMAD和Foxp3抑制作用会偏向于抑制Th17，使得Foxp3处于中到高水平，而Th17处于低到中水平。\n- 高TGF-β与中等IL-6仍然倾向于有利于Foxp3，因为SMAD驱动的促进作用和Foxp3介导的对Th17的抑制作用超过了STAT3驱动的激活作用。\n\n程序必须评估指定的测试套件 (输入单位为 ng/mL)，并在单行上输出稳态配对 $[F^\\ast,R^\\ast]$ 作为单个列表，不含空格，每个值都四舍五入到 $3$ 位小数且无单位 (在 $[0,1]$ 范围内的分数)。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef hill_act(x, K, n):\n    # Hill activation: x^n / (K^n + x^n); handle x=0 quickly\n    x = max(0.0, float(x))\n    if x == 0.0:\n        return 0.0\n    xn = x ** n\n    Kn = K ** n\n    return xn / (Kn + xn)\n\ndef hill_rep(x, K, n):\n    # Hill repression: K^n / (K^n + x^n)\n    x = max(0.0, float(x))\n    Kn = K ** n\n    if x == 0.0:\n        return 1.0\n    xn = x ** n\n    return Kn / (Kn + xn)\n\ndef ode_rhs(state, il6, tgfb, params):\n    # Unpack state\n    S3, SM, F, R = state\n\n    # Unpack parameters\n    ks3 = params['ks3']; ds3 = params['ds3']\n    ksm = params['ksm']; dsm = params['dsm']\n    kf = params['kf']; df = params['df']\n    kr = params['kr']; dr = params['dr']\n\n    K_il6 = params['K_il6']; n_il6 = params['n_il6']\n    K_tgfb = params['K_tgfb']; n_tgfb = params['n_tgfb']\n    K_sm_f = params['K_sm_f']; K_s3_f = params['K_s3_f']\n    K_s3_r = params['K_s3_r']; K_sm_r = params['K_sm_r']; K_f_r = params['K_f_r']\n    n_cross = params['n_cross']\n\n    # Upstream activations\n    A_il6 = hill_act(il6, K_il6, n_il6)\n    A_tgfb = hill_act(tgfb, K_tgfb, n_tgfb)\n\n    # ODEs\n    dS3 = ks3 * A_il6 * (1.0 - S3) - ds3 * S3\n    dSM = ksm * A_tgfb * (1.0 - SM) - dsm * SM\n\n    A_SM_on_F = hill_act(SM, K_sm_f, n_cross)\n    R_S3_on_F = hill_rep(S3, K_s3_f, n_cross)\n    dF = kf * A_SM_on_F * R_S3_on_F * (1.0 - F) - df * F\n\n    A_S3_on_R = hill_act(S3, K_s3_r, n_cross)\n    R_SM_on_R = hill_rep(SM, K_sm_r, n_cross)\n    R_F_on_R  = hill_rep(F,  K_f_r,  n_cross)\n    dR = kr * A_S3_on_R * R_SM_on_R * R_F_on_R * (1.0 - R) - dr * R\n\n    return np.array([dS3, dSM, dF, dR], dtype=float)\n\ndef rk4_step(state, dt, il6, tgfb, params):\n    k1 = ode_rhs(state, il6, tgfb, params)\n    k2 = ode_rhs(state + 0.5 * dt * k1, il6, tgfb, params)\n    k3 = ode_rhs(state + 0.5 * dt * k2, il6, tgfb, params)\n    k4 = ode_rhs(state + dt * k3, il6, tgfb, params)\n    return state + (dt / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\ndef simulate(il6, tgfb, params, dt=0.01, tmax=200.0, tol=1e-8, min_steps=100):\n    # Initial conditions\n    state = np.array([0.0, 0.0, 0.0, 0.0], dtype=float)\n    t = 0.0\n    steps = 0\n    max_steps = int(tmax / dt)\n    prev_state = state.copy()\n    for i in range(max_steps):\n        state = rk4_step(state, dt, il6, tgfb, params)\n        # keep within [0,1]\n        state = np.clip(state, 0.0, 1.0)\n        steps += 1\n        t += dt\n        if steps = min_steps:\n            delta = np.max(np.abs(state - prev_state))\n            if delta  tol:\n                break\n        prev_state = state.copy()\n    # Return F and R\n    F = float(np.clip(state[2], 0.0, 1.0))\n    R = float(np.clip(state[3], 0.0, 1.0))\n    return F, R\n\ndef solve():\n    # Define parameters\n    params = {\n        'ks3': 1.0, 'ds3': 0.5,\n        'ksm': 1.0, 'dsm': 0.5,\n        'kf': 1.0,  'df': 0.2,\n        'kr': 1.0,  'dr': 0.2,\n        'K_il6': 1.0, 'n_il6': 2.0,\n        'K_tgfb': 0.5, 'n_tgfb': 2.0,\n        'K_sm_f': 0.3, 'K_s3_f': 0.3,\n        'K_s3_r': 0.3, 'K_sm_r': 0.3, 'K_f_r': 0.3,\n        'n_cross': 2.0\n    }\n\n    # Define the test cases from the problem statement: (TGFb, IL6) in ng/mL\n    test_cases = [\n        (5.0, 0.1),   # Case 1: high TGFb, low IL6\n        (0.1, 10.0),  # Case 2: low TGFb, high IL6\n        (0.0, 0.0),   # Case 3: both zero\n        (5.0, 5.0),   # Case 4: both moderate/high\n        (10.0, 1.0),  # Case 5: high TGFb, moderate IL6\n    ]\n\n    results = []\n    for tgfb, il6 in test_cases:\n        F, R = simulate(il6=il6, tgfb=tgfb, params=params, dt=0.01, tmax=200.0, tol=1e-8, min_steps=100)\n        # Round to 3 decimals as required\n        F_rounded = round(F + 1e-12, 3)\n        R_rounded = round(R + 1e-12, 3)\n        results.append([F_rounded, R_rounded])\n\n    # Format without spaces: [[f1,r1],[f2,r2],...]\n    inner = [f\"[{format(pair[0], '.3f')},{format(pair[1], '.3f')}]\" for pair in results]\n    print(f\"[[{','.join(inner)}]]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2536752"}]}