{"hands_on_practices": [{"introduction": "一个有益突变的旅程始于一个巨大的障碍：在群体统计随机性中存活下来。第一个练习将使用 Galton-Watson 分支过程的框架，来探讨一个新突变谱系最初、最脆弱的阶段。通过推导其灭绝概率，您将对“为何大多数有益突变在出现后不久就因偶然性而丢失”有一个定量的理解，这个结果关键地取决于选择优势 $s$，而在早期阶段与总群体大小 $N$ 无关 [@problem_id:2491978]。", "problem": "在一个实验性的微生物进化装置中，一个普查规模恒定为 $N=10^7$ 的单倍体无性繁殖种群以离散、非重叠的世代进行繁殖。一个单一的有益突变在一个细胞中出现，赋予了乘性的相对适应度优势，使得突变个体的每代预期繁殖产出相对于野生型的基线 $1$ 为 $1+s$，其中 $s=0.02$。在初始建立阶段，当突变谱系稀少时，总种群大小和环境可以被视为有效恒定，并且突变谱系之间的相互作用可以忽略不计。\n\n假设在此初始阶段，每个突变个体在下一代产生的突变后代数量可以很好地由一个均值为 $1+s$ 的独立泊松随机变量来近似，并且谱系大小的演化遵循一个Galton-Watson分支过程，直到灭绝或建立并超越遗传漂变主导的阶段。从分支过程的第一性原理出发，包括概率生成函数的定义及其在刻画灭绝中的作用，推导这个单一有益突变在初始建立阶段因遗传漂变而丢失的概率的主阶（关于 $s$）解析近似。然后对 $s=0.02$ 的情况对此近似进行数值计算。\n\n将最终概率表示为一个纯小数。除了报告主阶近似所隐含的值外，没有其他舍入要求。在您的推导中简要说明为什么在这个遗传漂变主导的建立阶段，结果依赖于 $s$ 而不依赖于 $N$。", "solution": "该问题要求推导在一个大的单倍体无性繁殖种群中，单个有益突变的丢失概率。在初始建立阶段，当突变克隆稀少时，该情景可被正确地建模为一个Galton-Watson分支过程。\n\n设 $Z_n$ 为第 $n$ 代携带该有益突变的个体数量。该过程始于单个突变个体，因此初始条件为 $Z_0=1$。问题陈述，每个突变个体在下一代产生的后代数量是一个独立的随机变量，遵循均值为 $\\lambda = 1+s$ 的泊松分布，其中 $s$ 是选择优势。\n\n分析Galton-Watson过程的基础是后代分布的概率生成函数（PGF）。设 $X$ 为单个个体后代数量的随机变量。PGF $G(x)$ 定义为：\n$$G(x) = E[x^X] = \\sum_{k=0}^{\\infty} P(X=k) x^k$$\n对于均值为 $\\lambda$ 的泊松分布，其概率质量函数为 $P(X=k) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$。因此，PGF为：\n$$G(x) = \\sum_{k=0}^{\\infty} \\frac{\\lambda^k e^{-\\lambda}}{k!} x^k = e^{-\\lambda} \\sum_{k=0}^{\\infty} \\frac{(\\lambda x)^k}{k!}$$\n该和是 $e^{\\lambda x}$ 的泰勒级数。因此，PGF为：\n$$G(x) = e^{-\\lambda} e^{\\lambda x} = \\exp(\\lambda(x-1))$$\n在此问题中，平均后代数为 $\\lambda = 1+s$，所以特定的PGF是：\n$$G(x) = \\exp((1+s)(x-1))$$\n分支过程的一个基本定理指出，从单个个体开始的谱系最终灭绝的概率，记为 $q$，是方程 $G(x) = x$ 的最小非负根。我们必须解方程中的 $q$：\n$$\\exp((1+s)(q-1)) = q$$\n平均后代数为 $E[X] = \\lambda = 1+s$。由于 $s=0.02  0$，均值大于 $1$。对于超临界分支过程（$\\lambda  1$），$G(x)$ 恰好有两个非负不动点：一个在 $x=1$ 处，另一个是灭绝概率 $q$，位于区间 $[0, 1)$ 内。\n\n方程 $\\exp((1+s)(q-1)) = q$ 没有简单的闭式解来求解 $q$。然而，问题要求一个关于 $s$ 的主阶近似。对于一个小的正数 $s$，平均后代数 $1+s$ 仅略高于 $1$，灭绝概率 $q$ 将接近 $1$。\n我们定义存活概率为 $p_{surv} = 1 - q$。由于 $q$ 接近 $1$，$p_{surv}$ 是一个小的正数。我们可以将 $q = 1 - p_{surv}$ 代入不动点方程：\n$$\\exp((1+s)((1 - p_{surv}) - 1)) = 1 - p_{surv}$$\n$$\\exp(-(1+s)p_{surv}) = 1 - p_{surv}$$\n我们现在对左侧的指数函数围绕点 $0$ 进行泰勒级数展开，因为其自变量 $-(1+s)p_{surv}$ 很小。展开式为 $\\exp(z) \\approx 1 + z + \\frac{z^2}{2!} + O(z^3)$。\n$$1 - (1+s)p_{surv} + \\frac{((1+s)p_{surv})^2}{2} - \\dots \\approx 1 - p_{surv}$$\n两边减去 $1$ 并重新整理，我们得到：\n$$p_{surv} - (1+s)p_{surv} + \\frac{(1+s)^2 p_{surv}^2}{2} \\approx 0$$\n$$(1 - (1+s))p_{surv} + \\frac{(1+s)^2 p_{surv}^2}{2} \\approx 0$$\n$$-s \\cdot p_{surv} + \\frac{(1+s)^2 p_{surv}^2}{2} \\approx 0$$\n我们正在寻找非零的存活概率，所以我们可以除以 $p_{surv}$：\n$$-s + \\frac{(1+s)^2 p_{surv}}{2} \\approx 0$$\n解出 $p_{surv}$：\n$$p_{surv} \\approx \\frac{2s}{(1+s)^2}$$\n问题要求关于 $s$ 的主阶近似。这意味着我们考虑 $s \\to 0$ 的极限。在此极限下，分母 $(1+s)^2 \\to 1$。因此，存活概率的主阶近似为：\n$$p_{surv} \\approx 2s$$\n丢失概率 $q$ 随之近似为：\n$$q = 1 - p_{surv} \\approx 1 - 2s$$\n这是所要求的丢失概率的主阶解析近似。\n\n关于结果不依赖于 $N$ 的理由说明：该推导依赖于Galton-Watson分支过程模型。该模型适用于突变种群相对于总种群规模稀少（$Z_n \\ll N$）的条件。在此阶段，突变个体之间不为资源竞争，也不会显著改变整体环境。突变谱系的增长完全由个体水平上出生和死亡的人口随机性决定，这被均值为 $1+s$ 的后代分布所捕捉。总种群大小 $N$ 没有出现在PGF或最终的灭绝概率方程中，因为野生型个体的背景被视为一个无限的、恒定的储备库。突变的命运（灭绝或建立）是在其绝对数量很小的这个早期阶段决定的。因此，丢失概率依赖于选择优势 $s$，而不依赖于种群数量 $N$。\n\n最后，我们对 $s=0.02$ 的情况对该近似进行数值计算：\n$$q \\approx 1 - 2(0.02) = 1 - 0.04 = 0.96$$\n突变丢失概率的主阶近似值为 $0.96$。", "answer": "$$\\boxed{0.96}$$", "id": "2491978"}, {"introduction": "如果一个突变成功地避免了初始的灭绝，它的长期命运将由有限种群中选择与遗传漂变之间的竞争所决定。本练习使用 Moran 模型（一个基本的出生-死亡过程）从第一性原理出发推导固定概率。这将阐明选择优势 $s$ 和种群大小 $N$ 之间的相互作用如何决定一个突变的最终成败，并最终得到固定的经典近似概率 [@problem_id:2491936]。", "problem": "在一个恒定总种群大小为 $N$ 的连续培养实验进化装置（例如，恒化器）中，假设种群动态可以很好地用Moran生死过程来描述：在每个事件中，一个个体以与其适应度成正比的概率进行繁殖，另一个个体（从整个种群中均匀随机选择）死亡，从而保持种群大小恒定为 $N$。在一个原本全为野生型的种群中出现了一个有益突变体。假设选择是弱的，通过对称地为突变体分配适应度 $1+s$ 和为野生型分配适应度 $1-s$ 来建模，其中 $0  s \\ll 1$，以确保所有适应度都为正。\n\n从关于突变体数量 $i \\in \\{0,1,2,\\dots,N\\}$ 的生死马尔可夫链的基本定义出发，其在 $i=0$（绝灭）和 $i=N$（固定）处有吸收边界，完成以下任务：\n\n1. 通过写出吸收概率的后向方程，并仅使用Moran过程定义所隐含的转移概率来求解，推导出单个突变体（初始时 $i=1$）的精确固定概率 $P_{\\mathrm{fix}}(1)$。你可以只假设标准的生死过程递推关系和边界条件；不要调用任何现成的固定公式。\n\n2. 使用弱选择极限 $s \\ll 1$，得到你的精确表达式的一个主阶近似，其形式为包含 $N$ 和 $s$ 的指数函数的封闭表达式，并用它来解释为什么当 $N$ 足够大以至于 $2Ns \\gg 1$ 时，固定概率简化为 $P_{\\mathrm{fix}} \\approx 2s$。\n\n3. 对于一个具体的实验参数化，取 $N = 10^{5}$ 和 $s = 5.0 \\times 10^{-6}$。使用你在第2部分得到的弱选择近似，计算单个突变体的固定概率的数值。将你的最终数值答案表示为一个纯数（无单位），并四舍五入到四位有效数字。", "solution": "问题陈述是有效的。这是一个基于标准模型和原理的、在数理种群遗传学中适定的问题。它自成体系、有科学依据且客观。我们将进行推导。\n\n该过程是状态空间 $i \\in \\{0, 1, \\dots, N\\}$ 上的一个生死马尔可夫链，其中 $i$ 是突变个体的数量。状态 $i=0$ 和 $i=N$ 是吸收边界，分别代表绝灭和固定。\n\n首先，我们必须推导在Moran过程的单步中，突变体数量增加一（$\\lambda_i$）或减少一（$\\mu_i$）的转移概率。在状态 $i$，有 $i$ 个适应度为 $w_m = 1+s$ 的突变体和 $N-i$ 个适应度为 $w_w = 1-s$ 的野生型个体。种群的总适应度是所有个体适应度的总和：\n$$\nW_i = i w_m + (N-i) w_w = i(1+s) + (N-i)(1-s) = N - Ns + 2is\n$$\n一个Moran事件包括一次出生和一次死亡。一个个体以与其适应度成正比的概率被选择进行繁殖。一个个体从大小为 $N$ 的种群中被均匀随机地选择死亡。\n\n如果一个突变体繁殖并且一个野生型个体死亡，突变体的数量 $i$ 会增加到 $i+1$。一个突变体被选择繁殖的概率是 $\\frac{i w_m}{W_i}$。一个野生型被选择死亡的概率是 $\\frac{N-i}{N}$。这个组合事件的概率，即从 $i$ 到 $i+1$ 的转移率，是：\n$$\n\\lambda_i = P(i \\to i+1) = \\left(\\frac{i w_m}{W_i}\\right) \\left(\\frac{N-i}{N}\\right) = \\frac{i(1+s)(N-i)}{N(N - Ns + 2is)}\n$$\n如果一个野生型繁殖并且一个突变体死亡，突变体的数量 $i$ 会减少到 $i-1$。一个野生型被选择繁殖的概率是 $\\frac{(N-i)w_w}{W_i}$。一个突变体被选择死亡的概率是 $\\frac{i}{N}$。这个组合事件的概率，即从 $i$ 到 $i-1$ 的转移率，是：\n$$\n\\mu_i = P(i \\to i-1) = \\left(\\frac{(N-i)w_w}{W_i}\\right) \\left(\\frac{i}{N}\\right) = \\frac{(N-i)(1-s)i}{N(N - Ns + 2is)}\n$$\n\n设 $P_i$ 表示从状态 $i$ 开始的固定概率（在状态 $N$ 被吸收）。通过第一步分析，$P_i$ 必须满足后向递推关系：\n$$\nP_i = \\frac{\\lambda_i}{\\lambda_i + \\mu_i} P_{i+1} + \\frac{\\mu_i}{\\lambda_i + \\mu_i} P_{i-1}\n$$\n这可以重新整理为：\n$$\n\\lambda_i (P_{i+1} - P_i) = \\mu_i (P_i - P_{i-1})\n$$\n因此，概率的差值遵循关系式 $P_{i+1} - P_i = \\gamma_i (P_i - P_{i-1})$，其中 $\\gamma_i = \\frac{\\mu_i}{\\lambda_i}$。我们来计算这个比率：\n$$\n\\gamma_i = \\frac{\\mu_i}{\\lambda_i} = \\frac{\\frac{(N-i)(1-s)i}{N(N - Ns + 2is)}}{\\frac{i(1+s)(N-i)}{N(N - Ns + 2is)}} = \\frac{(N-i)(1-s)i}{i(1+s)(N-i)} = \\frac{1-s}{1+s}\n$$\n对于所有 $i \\in \\{1, \\dots, N-1\\}$，比率 $\\gamma_i$ 是一个常数。令 $\\gamma = \\frac{1-s}{1+s}$。差分的递推关系变为 $P_{i+1} - P_i = \\gamma(P_i - P_{i-1})$。这表明差分序列是一个等比数列。令 $\\Delta_i = P_{i+1} - P_i$。那么 $\\Delta_i = \\gamma^i \\Delta_0$。\n\n边界条件是 $P_0 = 0$（从 $i=0$ 开始，绝灭是必然的）和 $P_N=1$（从 $i=N$ 开始，固定是必然的）。\n使用 $P_0=0$，我们得到 $\\Delta_0 = P_1 - P_0 = P_1$。\n固定概率 $P_i$ 可以表示为差分的和：\n$$\nP_i = P_0 + \\sum_{j=0}^{i-1} (P_{j+1} - P_j) = 0 + \\sum_{j=0}^{i-1} \\Delta_j = \\sum_{j=0}^{i-1} \\gamma^j \\Delta_0 = P_1 \\sum_{j=0}^{i-1} \\gamma^j\n$$\n使用等比数列求和公式，我们得到：\n$$\nP_i = P_1 \\frac{1-\\gamma^i}{1-\\gamma}\n$$\n现在我们应用第二个边界条件，$P_N=1$：\n$$\n1 = P_N = P_1 \\frac{1-\\gamma^N}{1-\\gamma}\n$$\n解出 $P_1$，即单个突变体的固定概率，得到：\n$$\nP_{\\mathrm{fix}}(1) = P_1 = \\frac{1-\\gamma}{1-\\gamma^N}\n$$\n代入 $\\gamma = \\frac{1-s}{1+s}$，精确的固定概率是：\n$$\nP_{\\mathrm{fix}}(1) = \\frac{1 - \\frac{1-s}{1+s}}{1 - \\left(\\frac{1-s}{1+s}\\right)^N}\n$$\n\n这就完成了问题的第一部分。\n\n对于第二部分，我们求弱选择 $s \\ll 1$ 下的近似。首先，我们近似 $\\gamma$：\n$$\n\\gamma = \\frac{1-s}{1+s} = (1-s)(1+s)^{-1} \\approx (1-s)(1-s) = 1-2s+s^2 \\approx 1-2s\n$$\n$P_{\\mathrm{fix}}(1)$ 的分子变为 $1-\\gamma \\approx 1-(1-2s) = 2s$。\n对于分母中的项 $\\gamma^N$，使用指数近似更精确：\n$$\n\\gamma = \\frac{1-s}{1+s} = \\exp\\left(\\ln\\left(\\frac{1-s}{1+s}\\right)\\right) = \\exp(\\ln(1-s) - \\ln(1+s))\n$$\n对于小的 $x$，$\\ln(1+x) \\approx x - \\frac{x^2}{2} + \\dots$。因此：\n$$\n\\ln(1-s) - \\ln(1+s) \\approx (-s - \\frac{s^2}{2}) - (s - \\frac{s^2}{2}) = -2s\n$$\n所以，$\\gamma \\approx \\exp(-2s)$。这导致 $\\gamma^N \\approx (\\exp(-2s))^N = \\exp(-2Ns)$。\n将这些近似代入 $P_{\\mathrm{fix}}(1)$ 的精确公式，我们得到弱选择近似：\n$$\nP_{\\mathrm{fix}}(1) \\approx \\frac{2s}{1-\\exp(-2Ns)}\n$$\n这就是所要求的封闭表达式。现在，我们研究当 $N$ 足够大以至于 $2Ns \\gg 1$ 的情况。在这个极限下，项 $-2Ns$ 是一个大的负数，所以 $\\exp(-2Ns)$ 趋近于 $0$。分母 $1 - \\exp(-2Ns)$ 趋近于 $1$。因此，固定概率简化为：\n$$\nP_{\\mathrm{fix}}(1) \\approx \\frac{2s}{1-0} = 2s\n$$\n这个结果 $P_{\\mathrm{fix}} \\approx 2s$ 表明，在选择能有效对抗遗传漂变的大种群中（即 $2Ns \\gg 1$），固定概率与选择优势成正比，其比例因子为 $2$，这是Moran模型子代数量方差的特征。\n\n对于第三部分，我们必须使用上面推导的弱选择近似，以及参数 $N=10^5$ 和 $s=5.0 \\times 10^{-6}$，来计算固定概率的数值。\n首先，我们验证弱选择条件：$s=5.0 \\times 10^{-6} \\ll 1$，这显然是满足的。\n接下来，我们计算乘积 $2Ns$：\n$$\n2Ns = 2 \\times (10^5) \\times (5.0 \\times 10^{-6}) = 2 \\times 5.0 \\times 10^{5-6} = 10 \\times 10^{-1} = 1\n$$\n由于 $2Ns=1$，条件 $2Ns \\gg 1$ 不满足，所以我们不能使用更简单的 $2s$ 近似。我们必须使用更通用的弱选择公式：\n$$\nP_{\\mathrm{fix}}(1) \\approx \\frac{2s}{1-\\exp(-2Ns)} = \\frac{2 \\times (5.0 \\times 10^{-6})}{1-\\exp(-1)}\n$$\n分子是 $2s = 1.0 \\times 10^{-5}$。分母是 $1 - \\exp(-1)$。\n现在，我们计算数值：\n$$\nP_{\\mathrm{fix}}(1) \\approx \\frac{1.0 \\times 10^{-5}}{1 - 0.36787944\\dots} = \\frac{1.0 \\times 10^{-5}}{0.63212055\\dots} \\approx 1.5819767 \\times 10^{-5}\n$$\n按要求将此结果四舍五入到四位有效数字，我们得到 $1.582 \\times 10^{-5}$。", "answer": "$$\\boxed{1.582 \\times 10^{-5}}$$", "id": "2491936"}, {"introduction": "前面的练习依赖于选择系数 $s$ 作为一个关键参数。但是，这个至关重要的值是如何通过实验确定的呢？这最后一个练习将理论带入实验室，重点分析一对一竞争实验。您将学习如何处理来自典型分批培养实验的频率数据，以获得选择系数的稳健估计，并区分每个周期和每一代的不同适应度效应 [@problem_id:2492038]。", "problem": "一个无性繁殖的微生物种群在周期性的分批培养中繁殖，每个周期内呈确定性的指数增长，并在转移时进行固定比例的稀释。两个竞争的基因型，一个焦点突变体 $A$ 和一个参考基因型 $B$，在周期内具有恒定的人均马尔萨斯增长率，分别表示为 $r_{A}$ 和 $r_{B}$，并且在生长阶段没有频率依赖性。每个周期结束时的稀释按比例减少两种基因型的绝对丰度，没有偏差，因此相对频率仅受周期内生长的影响。假设种群规模足够大，以至于在所考虑的时间尺度上可以忽略随机漂变。\n\n设 $p_{0}$ 为周期 1 开始时基因型 $A$ 的频率，设 $p_{C}$ 为 $C$ 个完整周期后其频率。设 $g$ 为在一个代表性周期内（从接种到生长结束）凭经验测量的总种群规模的倍数扩张。微生物的“代”定义为一次倍增，因此每个周期的平均代数是 $G=\\ln g/\\ln 2$。\n\n将每周期选择系数 $s_{\\mathrm{cyc}}$ 定义为基因型 $A$ 的对数优势比（log-odds）的恒定逐周期增量，并将每代选择系数 $s_{\\mathrm{gen}}$ 定义为基因型 $A$ 的对数优势比的恒定逐代增量。\n\n仅使用上述定义和指数增长模型，完成以下任务：\n\n1. 从每个基因型的指数增长定义以及频率 $p$ 及其优势比 $p/(1-p)$ 的表达式出发，构建一个用 $p_{0}$、$p_{C}$ 和 $C$ 表示的 $s_{\\mathrm{cyc}}$ 的估计量。\n\n2. 使用“代”的定义和每周期平均代数 $G=\\ln g/\\ln 2$，用你对 $s_{\\mathrm{cyc}}$ 的估计量和 $G$ 来表示 $s_{\\mathrm{gen}}$。\n\n3. 对于数据集 $p_{0}=0.001$，$p_{C}=0.5$，$C=12$ 和 $g=64$，计算 $s_{\\mathrm{gen}}$ 的数值。所有对数均使用自然对数。将你的最终数值答案四舍五入到四位有效数字。以纯数字形式报告最终结果，不带单位。", "solution": "首先必须验证问题陈述的科学合理性、一致性和完整性。\n\n**步骤 1：提取给定条件**\n- 竞争基因型：一个无性繁殖的焦点突变体 $A$ 和一个参考基因型 $B$。\n- 增长率：恒定的人均马尔萨斯增长率 $r_{A}$ 和 $r_{B}$。\n- 增长模型：每个周期内确定性的指数增长。无频率依赖性。\n- 稀释：按比例且无偏差，在每个周期结束时进行。\n- 种群规模：足够大以忽略随机漂变。\n- 初始频率：$p_{0}$ 是周期 1 开始时基因型 $A$ 的频率。\n- 最终频率：$p_{C}$ 是 $C$ 个完整周期后基因型 $A$ 的频率。\n- 种群扩张：$g$ 是一个周期内总种群规模的倍数扩张。\n- 每周期代数：$G = \\frac{\\ln g}{\\ln 2}$。\n- 每周期选择系数：$s_{\\mathrm{cyc}}$ 是基因型 $A$ 的对数优势比的恒定逐周期增量。\n- 每代选择系数：$s_{\\mathrm{gen}}$ 是基因型 $A$ 的对数优势比的恒定逐代增量。\n- 用于计算的数据集：$p_{0}=0.001$，$p_{C}=0.5$，$C=12$，$g=64$。\n\n**步骤 2：使用提取的给定条件进行验证**\n- **科学依据**：该问题在微生物种群遗传学和实验进化的原理上有坚实的基础。它采用了一个标准的、尽管简化的分批培养竞争模型，这是该领域的基石。所有概念，如马尔萨斯增长、选择系数和频率变化的对数优势比表示，都是标准的。\n- **适定性**：该问题结构为一个推导后跟一个计算。所提供的定义精确且足以推导出所要求的估计量并计算出最终值。存在一个唯一的、稳定的、有意义的解。\n- **客观性**：该问题以客观、定量的术语陈述，没有歧义或主观主张。\n\n**步骤 3：结论与行动**\n该问题是有效的。它在科学上是合理的，自洽的，且是适定的。可以构建一个严谨的解。\n\n**解题推导**\n\n按要求，问题分三部分解决。\n\n**第 1 部分：每周期选择系数 $s_{\\mathrm{cyc}}$ 的估计量**\n\n设 $N_A(t)$ 和 $N_B(t)$ 分别为在单个生长周期内时间 $t$ 时基因型 $A$ 和 $B$ 的绝对丰度。一个周期的生长阶段持续时间为 $T$。根据指数增长模型：\n$$N_A(T) = N_A(0) \\exp(r_A T)$$\n$$N_B(T) = N_B(0) \\exp(r_B T)$$\n其中 $N_A(0)$ 和 $N_B(0)$ 是周期开始时的丰度。\n\n基因型 $A$ 的频率是 $p = \\frac{N_A}{N_A + N_B}$。基因型 $A$ 的优势比定义为 $O = \\frac{p}{1-p} = \\frac{N_A}{N_B}$。\n设 $p_{n-1}$ 为周期 $n$ 开始时基因型 $A$ 的频率，$p_n$ 为周期 $n$ 结束时（稀释前）的频率。相应的优势比为 $O_{n-1}$ 和 $O_n$。\n周期结束时丰度的比率为：\n$$\\frac{N_A(T)}{N_B(T)} = \\frac{N_A(0) \\exp(r_A T)}{N_B(0) \\exp(r_B T)} = \\frac{N_A(0)}{N_B(0)} \\exp((r_A - r_B)T)$$\n用优势比表示，这是：\n$$O_n = O_{n-1} \\exp((r_A - r_B)T)$$\n两边取自然对数，得到一个周期内对数优势比的变化：\n$$\\ln(O_n) = \\ln(O_{n-1}) + (r_A - r_B)T$$\n$$\\ln(O_n) - \\ln(O_{n-1}) = (r_A - r_B)T$$\n问题将每周期选择系数 $s_{\\mathrm{cyc}}$ 定义为对数优势比的恒定逐周期增量。因此：\n$$s_{\\mathrm{cyc}} = \\ln(O_n) - \\ln(O_{n-1})$$\n由于稀释是无偏差的，它不改变相对频率，因此一个周期结束时的频率与下一个周期开始时的频率相同。这种关系对所有周期都成立。\n\n这构成了 $C$ 个周期内对数优势比的算术级数。设 $O_0$ 为周期 1 开始时的优势比（对应于频率 $p_0$），$O_C$ 为周期 $C$ 结束时的优势比（对应于频率 $p_C$）。在 $C$ 个周期后，对数优势比的总变化是：\n$$\\ln(O_C) - \\ln(O_0) = \\sum_{n=1}^{C} (\\ln(O_n) - \\ln(O_{n-1})) = C \\cdot s_{\\mathrm{cyc}}$$\n解出 $s_{\\mathrm{cyc}}$：\n$$s_{\\mathrm{cyc}} = \\frac{1}{C} (\\ln(O_C) - \\ln(O_0))$$\n代入优势比的定义，$O = \\frac{p}{1-p}$：\n$$s_{\\mathrm{cyc}} = \\frac{1}{C} \\left( \\ln\\left(\\frac{p_C}{1-p_C}\\right) - \\ln\\left(\\frac{p_0}{1-p_0}\\right) \\right)$$\n这可以写成单个对数形式：\n$$s_{\\mathrm{cyc}} = \\frac{1}{C} \\ln\\left(\\frac{p_C(1-p_0)}{p_0(1-p_C)}\\right)$$\n这就是所要求的 $s_{\\mathrm{cyc}}$ 的估计量。\n\n**第 2 部分：每代选择系数 $s_{\\mathrm{gen}}$ 的表达式**\n\n每周期选择系数 $s_{\\mathrm{cyc}}$ 表示一个完整周期内对数优势比的总变化。一个周期内发生的代数由 $G$ 给出。每代选择系数 $s_{\\mathrm{gen}}$ 被定义为每代对数优势比的恒定增量。\n假设在一个周期内，对数优势比的增量在各代之间是均匀的（这与随时间恒定的差异增长率 $r_A - r_B$ 一致），那么整个周期的总变化是每代变化乘以代数。\n$$s_{\\mathrm{cyc}} = G \\cdot s_{\\mathrm{gen}}$$\n由此，我们可以用 $s_{\\mathrm{cyc}}$ 和 $G$ 来表示 $s_{\\mathrm{gen}}$：\n$$s_{\\mathrm{gen}} = \\frac{s_{\\mathrm{cyc}}}{G}$$\n\n**第 3 部分：数值计算**\n\n我们给定的数据集是：$p_{0}=0.001$，$p_{C}=0.5$，$C=12$ 和 $g=64$。\n\n首先，我们计算每周期的代数 $G$：\n$$G = \\frac{\\ln(g)}{\\ln(2)} = \\frac{\\ln(64)}{\\ln(2)} = \\frac{\\ln(2^6)}{\\ln(2)} = \\frac{6 \\ln(2)}{\\ln(2)} = 6$$\n\n接下来，我们计算每周期选择系数 $s_{\\mathrm{cyc}}$：\n$$s_{\\mathrm{cyc}} = \\frac{1}{C} \\ln\\left(\\frac{p_C(1-p_0)}{p_0(1-p_C)}\\right)$$\n代入给定值：\n$$p_0 = 0.001 \\implies 1-p_0 = 0.999$$\n$$p_C = 0.5 \\implies 1-p_C = 0.5$$\n$$C=12$$\n$$s_{\\mathrm{cyc}} = \\frac{1}{12} \\ln\\left(\\frac{0.5 \\cdot 0.999}{0.001 \\cdot 0.5}\\right) = \\frac{1}{12} \\ln\\left(\\frac{0.999}{0.001}\\right) = \\frac{\\ln(999)}{12}$$\n\n最后，我们计算每代选择系数 $s_{\\mathrm{gen}}$：\n$$s_{\\mathrm{gen}} = \\frac{s_{\\mathrm{cyc}}}{G} = \\frac{\\ln(999)/12}{6} = \\frac{\\ln(999)}{72}$$\n现在我们计算数值并四舍五入到四位有效数字：\n$$\\ln(999) \\approx 6.90675513$$\n$$s_{\\mathrm{gen}} \\approx \\frac{6.90675513}{72} \\approx 0.09592715458$$\n四舍五入到四位有效数字得到：\n$$s_{\\mathrm{gen}} \\approx 0.09593$$", "answer": "$$\\boxed{0.09593}$$", "id": "2492038"}]}