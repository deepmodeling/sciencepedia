{"hands_on_practices": [{"introduction": "在对微生物暗物质进行任何宏基因组研究之前，一个至关重要的初始步骤是确保实验设计能够捕获到我们感兴趣的稀有微生物。这项练习从基本概率论出发，为确定发现稀有物种所需的最低测序深度提供了定量的计算方法。掌握这种分析能力是规划有效研究和避免资源浪费的一项基本技能 [@problem_id:2509016]。", "problem": "在为微生物暗物质设计靶向分离策略时，通常需要确保在宏基因组文库中，一个相对丰度为 $p \\in (0,1)$ 的稀有目标分类单元至少被检测到一次，从而为下游的培养尝试提供依据。假设高通量测序（HTS）的读数可以建模为独立的伯努利试验，其中每次读数有 $p$ 的概率来源于目标分类单元，有 $1-p$ 的概率来源于任何其他分类单元。将测序深度 $n$ 定义为收集到的总读数数量。\n\n从第一性原理出发，推导出一个关于 $p$ 的闭式函数，该函数表示保证检测到目标分类单元（即观察到至少一个来自该分类单元的读数）的概率至少为 $0.95$ 所需的最小测序深度。您的答案必须是满足此约束的精确最小整数深度，表示为仅含 $p$ 的单一解析表达式。请勿引入近似；根据所述假设推导出与 $p$ 的精确依赖关系。请提供最小 $n$ 关于 $p$ 的单一闭式表达式作为最终结果（无需单位）。", "solution": "问题陈述描述了概率论在宏基因组测序中的一个经典应用，这是生物信息学和微生物生态学中经常遇到的场景。该问题具有科学依据，提法明确，并包含了进行严格数学推导所需的所有信息。因此，该问题被认为是有效的。\n\n目标是找到最小的整数测序深度，记为 $n$，以确保检测到相对丰度为 $p$ 的目标分类单元的概率至少为 $0.95$。检测被定义为观察到至少一个源自该分类单元的序列读数。\n\n设 $X$ 为随机变量，表示在总共 $n$ 个读数中来自目标分类单元的读数数量。问题陈述指出，测序过程可以建模为一系列 $n$ 次独立的伯努利试验。每次试验对应一个读数。“成功”定义为读数源自目标分类单元，其发生概率为 $p$。“失败”定义为读数来自任何其他分类单元，其发生概率为 $1-p$。\n\n在这些假设下，随机变量 $X$ 服从参数为 $n$（试验次数）和 $p$（成功概率）的二项分布。我们记为 $X \\sim B(n, p)$。该分布的概率质量函数给出了在 $n$ 次试验中观察到恰好 $k$ 次成功的概率：\n$$P(X=k) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n对于 $k \\in \\{0, 1, 2, \\dots, n\\}$。\n\n检测的条件是观察到至少一个来自目标分类单元的读数。这对应于事件 $X \\ge 1$。问题要求该事件的概率至少为 $0.95$：\n$$P(X \\ge 1) \\ge 0.95$$\n\n直接计算 $P(X \\ge 1)$ 需要对 $k=1, 2, \\dots, n$ 的概率求和。考虑其互补事件会更直接，即观察到零个来自目标分类单元的读数，也就是 $X=0$。事件与其互补事件之间的关系是：\n$$P(X \\ge 1) = 1 - P(X=0)$$\n\n使用二项分布的概率质量函数计算 $k=0$ 的情况：\n$$P(X=0) = \\binom{n}{0} p^0 (1-p)^{n-0} = (1)(1)(1-p)^n = (1-p)^n$$\n\n现在，我们可以将此表达式代回不等式中：\n$$1 - (1-p)^n \\ge 0.95$$\n\n任务是解此不等式，求出最小的整数 $n$。整理各项，我们得到：\n$$- (1-p)^n \\ge 0.95 - 1$$\n$$- (1-p)^n \\ge -0.05$$\n两边同乘以 $-1$ 会反转不等号：\n$$(1-p)^n \\le 0.05$$\n\n为了分离出 $n$，我们对不等式两边取自然对数。由于问题指定 $p \\in (0,1)$，因此有 $0  1-p  1$。此区间内任何数的自然对数都是负数，即 $\\ln(1-p)  0$。因此，当我们将不等式两边同时除以 $\\ln(1-p)$ 时，必须再次反转不等号。\n$$\\ln((1-p)^n) \\le \\ln(0.05)$$\n$$n \\ln(1-p) \\le \\ln(0.05)$$\n$$n \\ge \\frac{\\ln(0.05)}{\\ln(1-p)}$$\n注意 $\\ln(0.05)$ 也是负数，所以右侧的比率是一个正实数，这与测序深度这样的量是相符的。\n\n问题要求满足此条件的最小*整数*值 $n$。大于或等于给定实数的最小整数由上取整函数定义，记为 $\\lceil \\cdot \\rceil$。因此，最小测序深度 $n_{\\text{min}}$ 为：\n$$n_{\\text{min}} = \\left\\lceil \\frac{\\ln(0.05)}{\\ln(1-p)} \\right\\rceil$$\n\n该表达式是根据要求从第一性原理推导出的、仅作为相对丰度 $p$ 函数的最小整数测序深度的精确闭式解。", "answer": "$$\\boxed{\\left\\lceil \\frac{\\ln(0.05)}{\\ln(1-p)} \\right\\rceil}$$", "id": "2509016"}, {"introduction": "在获得足够的测序数据后，下一个核心挑战是从复杂的序列混合物中重建单个基因组，即宏基因组组装基因组（MAGs）。这项实践深入探讨了“宏基因组分箱”（contig binning）的核心逻辑，这是一个根据序列覆盖度和寡核苷酸频率等特征将DNA片段分组为推定基因组的过程。通过将分箱问题构建为一个优化问题，你将从第一性原理层面理解生物信息学工具如何将生物学假设转化为严谨的数学算法 [@problem_id:2508959]。", "problem": "在应用于微生物暗物质的基因组解析宏基因组学中，恢复宏基因组组装基因组（metagenome-assembled genomes）的一种常用策略是将假定源自同一基因组的重叠群（contigs）进行分箱（binning）。其基本原理是，来自同一基因组的重叠群在不同的宏基因组样本中具有相似的覆盖度，并且具有相似的寡核苷酸组成，例如四核苷酸频率谱。依据这一原理，且不假定任何特定的下游分箱算法，请从第一性原理出发，构建一个硬分配（hard-assignment）优化问题，该问题通过在适当的约束下最小化覆盖度和四核苷酸空间中的箱内离散度（within-bin dispersion），将重叠群聚类到固定数量的基因组箱中。然后，将您的公式应用于一个具体的玩具数据集，以计算最小目标值。\n\n假设以下数据是为 $3$ 个宏基因组样本和一个简化的双特征四核苷酸频率谱（已归一化，使得每个重叠群的频率之和为 $1$）测量的。共有 $4$ 个重叠群，分别表示为 $A$、$B$、$C$ 和 $D$。\n\n- 重叠群 $A$：覆盖度向量 $c_{A} = (10, 5, 0)$；四核苷酸频率向量 $t_{A} = (0.60, 0.40)$。\n- 重叠群 $B$：覆盖度向量 $c_{B} = (12, 6, 0)$；四核苷酸频率向量 $t_{B} = (0.58, 0.42)$。\n- 重叠群 $C$：覆盖度向量 $c_{C} = (0, 8, 4)$；四核苷酸频率向量 $t_{C} = (0.30, 0.70)$。\n- 重叠群 $D$：覆盖度向量 $c_{D} = (0, 9, 5)$；四核苷酸频率向量 $t_{D} = (0.32, 0.68)$。\n\n从来自同一基因组的重叠群应在上述两个特征空间中最小化箱内离散度的原则出发，请完成以下任务：\n\n1. 制定一个硬聚类优化问题，其中分箱数固定为 $K = 2$，决策变量为二元分配变量以及覆盖度和四核苷酸空间中的箱代表（bin representatives）。使用覆盖度和四核苷酸空间中平方偏差的加权和（权重 $\\alpha = 1$ 和 $\\beta = 1$）来量化箱内离散度。陈述目标函数和所有约束条件，包括确保每个重叠群只被分配到一个箱中且每个箱非空的约束。\n2. 使用您的公式，确定将重叠群分配到 $K=2$ 个箱中的最优硬分配方案，并计算相应的最小目标函数值。将最终目标值表示为精确小数。无需四舍五入，且目标值没有物理单位。\n\n您的答案必须是在最优点上达到的单一最小目标值。", "solution": "我们从一个基本观察出发：源自同一基因组的重叠群在不同的宏基因组样本中应表现出相似的覆盖度以及相似的寡核苷酸组成谱（此处概括为四核苷酸频率）。一种编码相似性的自然方法是最小化簇内离散度。平方欧几里得偏差是衡量离散度的一种经典且经过充分检验的方法，它对应于方差最小化，并能为最优簇代表（即算术平均值）导出封闭形式的表达式。\n\n设重叠群集合由索引 $i \\in \\{1,2,3,4\\}$ 标记，分别对应标签 $A,B,C,D$。令 $c_{i} \\in \\mathbb{R}^{3}$ 表示跨越 $3$ 个样本的覆盖度向量，令 $t_{i} \\in \\mathbb{R}^{2}$ 表示四核苷酸频率向量（其分量之和为 $1$）。我们寻求 $K=2$ 个箱。引入二元分配变量 $z_{ik} \\in \\{0,1\\}$（其中 $k \\in \\{1,2\\}$），当重叠群 $i$ 被分配到箱 $k$ 时 $z_{ik}=1$，否则 $z_{ik}=0$。令 $\\mu_{k} \\in \\mathbb{R}^{3}$ 表示箱 $k$ 在覆盖度空间中的代表（质心），令 $\\nu_{k} \\in \\mathbb{R}^{2}$ 表示箱 $k$ 在四核苷酸空间中的代表。\n\n使用权重 $\\alpha = 1$ 和 $\\beta = 1$，编码两个空间中箱内紧凑性原则的目标函数是\n$$\n\\min_{z,\\mu,\\nu} \\; \\sum_{k=1}^{2} \\sum_{i=1}^{4} z_{ik} \\left( \\alpha \\, \\| c_{i} - \\mu_{k} \\|_{2}^{2} + \\beta \\, \\| t_{i} - \\nu_{k} \\|_{2}^{2} \\right),\n$$\n遵循硬分配和非空约束\n$$\n\\sum_{k=1}^{2} z_{ik} = 1 \\quad \\text{for all } i \\in \\{1,2,3,4\\}, \\qquad \\sum_{i=1}^{4} z_{ik} \\ge 1 \\quad \\text{for all } k \\in \\{1,2\\},\n$$\n以及分配的二元性质\n$$\nz_{ik} \\in \\{0,1\\} \\quad \\text{for all } i \\in \\{1,2,3,4\\}, \\; k \\in \\{1,2\\}.\n$$\n对于固定的分配 $z_{ik}$，目标函数对于每个 $\\mu_{k}$ 和 $\\nu_{k}$ 都是可分的和严格凸的，一阶最优性条件得出，代表是所分配点的算术平均值：\n$$\n\\mu_{k} = \\frac{\\sum_{i=1}^{4} z_{ik} \\, c_{i}}{\\sum_{i=1}^{4} z_{ik}}, \\qquad \\nu_{k} = \\frac{\\sum_{i=1}^{4} z_{ik} \\, t_{i}}{\\sum_{i=1}^{4} z_{ik}}.\n$$\n因此，问题简化为选择分配方案，其目标函数等于两个特征空间中，围绕各自箱均值的箱内平方和之总和。\n\n我们现在计算候选划分的目标值。通过观察数据：\n\n- 覆盖度向量 $c_{A}=(10,5,0)$ 和 $c_{B}=(12,6,0)$ 彼此接近，且远离 $c_{C}=(0,8,4)$ 和 $c_{D}=(0,9,5)$。\n- 四核苷酸向量 $t_{A}=(0.60,0.40)$ 和 $t_{B}=(0.58,0.42)$ 彼此接近，且远离 $t_{C}=(0.30,0.70)$ 和 $t_{D}=(0.32,0.68)$。\n\n这表明将 $\\{A,B\\}$ 和 $\\{C,D\\}$ 分为一组将是最佳方案，但我们将精确计算其目标值，并与至少一种交叉配对方案进行比较以证明其最优性。\n\n计算箱 $\\{A,B\\}$ 和 $\\{C,D\\}$ 的目标值。\n\n- 对于箱 $\\{A,B\\}$ 在覆盖度空间中，其质心为\n$$\n\\mu_{1} = \\frac{c_{A}+c_{B}}{2} = \\left( \\frac{10+12}{2}, \\frac{5+6}{2}, \\frac{0+0}{2} \\right) = (11, 5.5, 0).\n$$\n平方偏差为\n$$\n\\|c_{A}-\\mu_{1}\\|_{2}^{2} = (10-11)^{2} + (5-5.5)^{2} + (0-0)^{2} = 1 + 0.25 + 0 = 1.25,\n$$\n$$\n\\|c_{B}-\\mu_{1}\\|_{2}^{2} = (12-11)^{2} + (6-5.5)^{2} + (0-0)^{2} = 1 + 0.25 + 0 = 1.25.\n$$\n此箱的覆盖度贡献为：$1.25 + 1.25 = 2.5$。\n\n- 对于箱 $\\{A,B\\}$ 在四核苷酸空间中，其质心为\n$$\n\\nu_{1} = \\frac{t_{A}+t_{B}}{2} = \\left( \\frac{0.60+0.58}{2}, \\frac{0.40+0.42}{2} \\right) = (0.59, 0.41).\n$$\n平方偏差为\n$$\n\\|t_{A}-\\nu_{1}\\|_{2}^{2} = (0.60-0.59)^{2} + (0.40-0.41)^{2} = 0.01^{2} + (-0.01)^{2} = 0.0002,\n$$\n$$\n\\|t_{B}-\\nu_{1}\\|_{2}^{2} = (0.58-0.59)^{2} + (0.42-0.41)^{2} = (-0.01)^{2} + 0.01^{2} = 0.0002.\n$$\n此箱的四核苷酸贡献为：$0.0002 + 0.0002 = 0.0004$。\n\n- 对于箱 $\\{C,D\\}$ 在覆盖度空间中，其质心为\n$$\n\\mu_{2} = \\frac{c_{C}+c_{D}}{2} = \\left( \\frac{0+0}{2}, \\frac{8+9}{2}, \\frac{4+5}{2} \\right) = (0, 8.5, 4.5).\n$$\n平方偏差为\n$$\n\\|c_{C}-\\mu_{2}\\|_{2}^{2} = (0-0)^{2} + (8-8.5)^{2} + (4-4.5)^{2} = 0 + 0.25 + 0.25 = 0.5,\n$$\n$$\n\\|c_{D}-\\mu_{2}\\|_{2}^{2} = (0-0)^{2} + (9-8.5)^{2} + (5-4.5)^{2} = 0 + 0.25 + 0.25 = 0.5.\n$$\n此箱的覆盖度贡献为：$0.5 + 0.5 = 1.0$。\n\n- 对于箱 $\\{C,D\\}$ 在四核苷酸空间中，其质心为\n$$\n\\nu_{2} = \\frac{t_{C}+t_{D}}{2} = \\left( \\frac{0.30+0.32}{2}, \\frac{0.70+0.68}{2} \\right) = (0.31, 0.69).\n$$\n平方偏差为\n$$\n\\|t_{C}-\\nu_{2}\\|_{2}^{2} = (0.30-0.31)^{2} + (0.70-0.69)^{2} = (-0.01)^{2} + 0.01^{2} = 0.0002,\n$$\n$$\n\\|t_{D}-\\nu_{2}\\|_{2}^{2} = (0.32-0.31)^{2} + (0.68-0.69)^{2} = 0.01^{2} + (-0.01)^{2} = 0.0002.\n$$\n此箱的四核苷酸贡献为：$0.0002 + 0.0002 = 0.0004$。\n\n将所有贡献值（权重 $\\alpha = 1$ 和 $\\beta = 1$）相加，划分 $\\{A,B\\}$ 和 $\\{C,D\\}$ 的总目标值为\n$$\n2.5 + 0.0004 + 1.0 + 0.0004 = 3.5008.\n$$\n\n为验证最优性，考虑一种交叉配对划分，例如 $\\{A,C\\}$ 和 $\\{B,D\\}$。\n\n- 对于 $\\{A,C\\}$ 在覆盖度空间中，质心为\n$$\n\\tilde{\\mu}_{1} = \\left( \\frac{10+0}{2}, \\frac{5+8}{2}, \\frac{0+4}{2} \\right) = (5, 6.5, 2).\n$$\n平方偏差\n$$\n\\|c_{A}-\\tilde{\\mu}_{1}\\|_{2}^{2} = (10-5)^{2} + (5-6.5)^{2} + (0-2)^{2} = 25 + 2.25 + 4 = 31.25,\n$$\n$$\n\\|c_{C}-\\tilde{\\mu}_{1}\\|_{2}^{2} = (0-5)^{2} + (8-6.5)^{2} + (4-2)^{2} = 25 + 2.25 + 4 = 31.25,\n$$\n覆盖度贡献 $= 62.5$。\n\n- 对于 $\\{B,D\\}$ 在覆盖度空间中，质心为\n$$\n\\tilde{\\mu}_{2} = \\left( \\frac{12+0}{2}, \\frac{6+9}{2}, \\frac{0+5}{2} \\right) = (6, 7.5, 2.5),\n$$\n偏差\n$$\n\\|c_{B}-\\tilde{\\mu}_{2}\\|_{2}^{2} = (12-6)^{2} + (6-7.5)^{2} + (0-2.5)^{2} = 36 + 2.25 + 6.25 = 44.5,\n$$\n$$\n\\|c_{D}-\\tilde{\\mu}_{2}\\|_{2}^{2} = (0-6)^{2} + (9-7.5)^{2} + (5-2.5)^{2} = 36 + 2.25 + 6.25 = 44.5,\n$$\n覆盖度贡献 $= 89.0$。\n\n- 对于 $\\{A,C\\}$ 在四核苷酸空间中，质心为\n$$\n\\tilde{\\nu}_{1} = \\left( \\frac{0.60+0.30}{2}, \\frac{0.40+0.70}{2} \\right) = (0.45, 0.55),\n$$\n偏差\n$$\n\\|t_{A}-\\tilde{\\nu}_{1}\\|_{2}^{2} = (0.60-0.45)^{2} + (0.40-0.55)^{2} = 0.0225 + 0.0225 = 0.045,\n$$\n$$\n\\|t_{C}-\\tilde{\\nu}_{1}\\|_{2}^{2} = (0.30-0.45)^{2} + (0.70-0.55)^{2} = 0.0225 + 0.0225 = 0.045,\n$$\n四核苷酸贡献 $= 0.09$。\n\n- 对于 $\\{B,D\\}$ 在四核苷酸空间中，质心为\n$$\n\\tilde{\\nu}_{2} = \\left( \\frac{0.58+0.32}{2}, \\frac{0.42+0.68}{2} \\right) = (0.45, 0.55),\n$$\n偏差\n$$\n\\|t_{B}-\\tilde{\\nu}_{2}\\|_{2}^{2} = (0.58-0.45)^{2} + (0.42-0.55)^{2} = 0.0169 + 0.0169 = 0.0338,\n$$\n$$\n\\|t_{D}-\\tilde{\\nu}_{2}\\|_{2}^{2} = (0.32-0.45)^{2} + (0.68-0.55)^{2} = 0.0169 + 0.0169 = 0.0338,\n$$\n四核苷酸贡献 $= 0.0676$。\n\n这种交叉配对的总目标值为\n$$\n62.5 + 89.0 + 0.09 + 0.0676 = 151.6576,\n$$\n该值远大于 $3.5008$。由于数据量值的对称性，另一种交叉配对 $\\{A,D\\}$ 和 $\\{B,C\\}$ 会得出类似的大目标值。类型为 $\\{A\\}$ 与 $\\{B,C,D\\}$ 或 $\\{B\\}$ 与 $\\{A,C,D\\}$ 等的划分将产生更大的箱内平方和，因为在每个特征空间中，三点箱的质心与其中至少一个点的距离，比与自然分组一致的二-二划分中的距离更远。\n\n因此，最优分配为 $\\{A,B\\}$ 和 $\\{C,D\\}$，其最小目标值等于\n$$\n3.5008.\n$$\n该值无量纲，无需四舍五入。", "answer": "$$\\boxed{3.5008}$$", "id": "2508959"}, {"introduction": "从计算重建转向实验室培养，需要我们深入理解微生物的生态位，这是连接基因组信息与成功培养策略的桥梁。这个问题模拟了一个关键的生物物理原理：即使在富氧的宏观环境中，微生物聚集体内部也能形成缺氧微区，从而让专性厌氧的“暗物质”微生物得以生存。通过推导缺氧核心的形成条件，你将看到物理化学原理如何直接指导我们设计出能够成功分离和培养这些难以捉摸的生物的策略 [@problem_id:2508944]。", "problem": "即使在宏观水环境中存在氧气，细胞-矿物聚集体内的许多微生物仍可能处于缺氧状态，这使得厌氧菌能够在名义上有氧的样品中存活。考虑一个半径为 $R$ 的球形微生物聚集体，浸没在充分混合的宏观流体中，聚集体表面的溶解氧浓度固定为 $C_0$。在聚集体内，氧气以扩散系数 $D$ 进行扩散，并被微生物群落根据一级动力学消耗，其体积速率为 $k\\,C(r)$，其中 $k$ 是一个正常数，$C(r)$ 是聚集体内径向位置 $r$ 处的局部氧浓度。假设系统处于稳态、具有球对称性且无内部对流。\n\n请仅从 Fick 定律、稳态质量守恒以及所述的动力学假设出发，完成以下任务：\n\n1) 在边界条件 $C(R)=C_0$ 和 $C(0)$ 为有限值的约束下，推导 $0 \\le r \\le R$ 范围内的径向氧浓度分布 $C(r)$。\n\n2) 确定控制氧气向聚集体内部衰减的内禀长度尺度，并将氧气穿透深度 $\\delta$ 定义为在 $R \\gg \\delta$ 极限下的此特征长度。请用 $D$ 和 $k$ 表示 $\\delta$。\n\n3) 使用您得到的 $C(r)$ 解，对于一个选定的小数 $0  \\varepsilon \\ll 1$，获得缺氧核心（即 $C(0) \\le \\varepsilon\\,C_0$）存在的判据，并推导出满足此不等式所需的最小聚集体半径 $R_{\\varepsilon}$ 的显式闭式表达式，该表达式以 $D$、$k$ 和 $\\varepsilon$ 表示。您的推导可以调用任何反演超越关系所需的标准特殊函数。\n\n4) 使用您推导出的表达式，简要解释为何在有氧样品中会产生内部缺氧微环境，以及这如何为从有氧环境中培养未培养厌氧菌的策略提供了理论基础（例如，通过利用扩散受限的微环境或局部增加 $k$ 值的共培养体系）。\n\n重要提示：请将您最终报告的答案设定为第2部分所要求的穿透深度 $\\delta$ 的解析表达式。无需进行数值计算。如果您在计算过程中选择对 $R_{\\varepsilon}$ 进行数值评估，请将任何此类中间数值计算结果四舍五入至4位有效数字，并以米为单位表示任何长度，但您最终报告的答案必须是无单位的解析表达式。", "solution": "该问题在物理上和数学上都是适定的，描述了一个经典的反应-扩散系统。所有必要的参数和边界条件均已提供，且目标基于已建立的科学原理。我们可以开始推导。\n\n为了确定氧浓度分布 $C(r)$，我们对聚集体内一个从半径 $r$ 到 $r+dr$、微分体积为 $dV = 4\\pi r^2 dr$ 的薄球壳进行质量平衡分析。在稳态下，氧气净扩散入壳层的速率必须与壳层体积内的氧气消耗速率相平衡。\n\n半径 $r$ 处的向内氧气通量为 $J(r)$，半径 $r+dr$ 处的向外通量为 $J(r+dr)$。半径 $r$ 处的表面积为 $A(r) = 4\\pi r^2$。因此，稳态质量平衡为：\n$$[A(r)J(r)] - [A(r+dr)J(r+dr)] - (\\text{消耗速率}) = 0$$\n体积消耗速率由一级动力学给出，为 $kC(r)$。在微分壳层体积 $dV$ 内，总消耗速率为 $kC(r) (4\\pi r^2 dr)$。质量平衡方程变为：\n$$(4\\pi r^2 J(r)) - (4\\pi(r+dr)^2 J(r+dr)) - k C(r) (4\\pi r^2 dr) = 0$$\n两边同除以 $4\\pi dr$ 并取 $dr \\to 0$ 的极限，我们得到微分形式：\n$$-\\frac{d}{dr}(r^2 J(r)) - k r^2 C(r) = 0$$\n根据 Fick 扩散第一定律，通量 $J(r)$ 与浓度梯度相关，即 $J(r) = -D \\frac{dC}{dr}$，其中 $D$ 是扩散系数。将此式代入质量平衡方程得到：\n$$-\\frac{d}{dr}\\left(r^2 \\left(-D \\frac{dC}{dr}\\right)\\right) - k r^2 C(r) = 0$$\n$$D \\frac{d}{dr}\\left(r^2 \\frac{dC}{dr}\\right) - k r^2 C(r) = 0$$\n对于 $r  0$，我们可以除以 $r^2$ 和 $D$，得到控制氧浓度分布 $C(r)$ 的二阶常微分方程(ODE)：\n$$\\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dC}{dr}\\right) - \\frac{k}{D} C(r) = 0$$\n展开导数项得到：\n$$\\frac{d^2C}{dr^2} + \\frac{2}{r} \\frac{dC}{dr} - \\frac{k}{D} C(r) = 0$$\n该方程是修正的球贝塞尔方程的一种形式。为求解该方程，我们做代换 $C(r) = \\frac{u(r)}{r}$。其导数为 $\\frac{dC}{dr} = \\frac{u'}{r} - \\frac{u}{r^2}$ 和 $\\frac{d^2C}{dr^2} = \\frac{u''}{r} - \\frac{2u'}{r^2} + \\frac{2u}{r^3}$。将这些代入 ODE，可将其简化为：\n$$\\frac{d^2u}{dr^2} - \\left(\\frac{k}{D}\\right) u(r) = 0$$\n我们定义一个特征长度 $\\delta = \\sqrt{D/k}$。方程变为 $u''(r) - \\frac{1}{\\delta^2} u(r) = 0$。这是一个标准的线性齐次常微分方程，其通解为：\n$$u(r) = A_1 \\exp(r/\\delta) + A_2 \\exp(-r/\\delta)$$\n因此，$C(r)$ 的通解为：\n$$C(r) = \\frac{A_1 \\exp(r/\\delta) + A_2 \\exp(-r/\\delta)}{r}$$\n这也可以用双曲函数表示，$C(r) = B_1 \\frac{\\sinh(r/\\delta)}{r} + B_2 \\frac{\\cosh(r/\\delta)}{r}$，这种形式更便于应用边界条件。\n\n边界条件是：\n1) 中心浓度必须是有限的：$C(0)$ 为有限值。\n2) 表面浓度是固定的：$C(R) = C_0$。\n\n对于第一个边界条件，当 $r \\to 0$ 时，我们有 $\\sinh(r/\\delta) \\approx r/\\delta$ 和 $\\cosh(r/\\delta) \\to 1$。因此，$C(r) \\to \\frac{B_1}{\\delta} + \\frac{B_2}{r}$。为使 $C(0)$ 有限，含有 $1/r$ 的项必须为零，这要求 $B_2 = 0$。因此，解的形式为 $C(r) = B_1 \\frac{\\sinh(r/\\delta)}{r}$。\n\n在 $r=R$ 处应用第二个边界条件：\n$$C(R) = B_1 \\frac{\\sinh(R/\\delta)}{R} = C_0$$\n解出常数 $B_1$ 得到 $B_1 = \\frac{C_0 R}{\\sinh(R/\\delta)}$。\n将 $B_1$ 代回 $C(r)$ 的解中，我们得到径向氧浓度分布的最终表达式：\n$$C(r) = C_0 \\frac{R}{r} \\frac{\\sinh(r/\\delta)}{\\sinh(R/\\delta)} = C_0 \\frac{R}{r} \\frac{\\sinh(r\\sqrt{k/D})}{\\sinh(R\\sqrt{k/D})}$$\n这完成了问题的第一部分。\n\n对于第二部分，我们必须确定氧气穿透深度 $\\delta$。这是浓度在其上衰减的内禀长度尺度。从我们的推导中，这个长度尺度自然地出现为 $\\delta = \\sqrt{D/k}$。在聚集体非常大（$R \\gg \\delta$）的极限下，表面附近（$r \\approx R$）的浓度分布可以近似。设 $x = R-r$ 为距表面的深度。当 $R/\\delta \\to \\infty$ 和 $r/\\delta \\to \\infty$ 时，我们可以使用近似 $\\sinh(z) \\approx \\exp(z)/2$。\n$$C(r) \\approx C_0 \\frac{R}{r} \\frac{\\exp(r/\\delta)}{\\exp(R/\\delta)} = C_0 \\frac{R}{r} \\exp\\left(-\\frac{R-r}{\\delta}\\right)$$\n由于 $r \\approx R$，因子 $R/r \\approx 1$。浓度分布从表面开始以特征长度 $\\delta = \\sqrt{D/k}$ 指数衰减。这就是氧气穿透深度。\n\n对于第三部分，我们需要一个缺氧核心的判据，$C(0) \\le \\varepsilon C_0$。我们首先通过对 $C(r)$ 的解取 $r \\to 0$ 的极限来计算 $C(0)$：\n$$C(0) = \\lim_{r \\to 0} C(r) = \\lim_{r \\to 0} \\left(C_0 \\frac{R}{r} \\frac{\\sinh(r/\\delta)}{\\sinh(R/\\delta)}\\right)$$\n在 $r \\to 0$ 时，使用近似 $\\sinh(r/\\delta) \\approx r/\\delta$：\n$$C(0) = C_0 \\frac{R}{\\sinh(R/\\delta)} \\lim_{r \\to 0} \\frac{r/\\delta}{r} = C_0 \\frac{R/\\delta}{\\sinh(R/\\delta)}$$\n因此，缺氧核心的判据为：\n$$C_0 \\frac{R/\\delta}{\\sinh(R/\\delta)} \\le \\varepsilon C_0 \\quad \\implies \\quad \\frac{R/\\delta}{\\sinh(R/\\delta)} \\le \\varepsilon$$\n为了找到最小半径 $R_{\\varepsilon}$，我们对无量纲群 $\\Phi_{\\varepsilon} = R_{\\varepsilon}/\\delta$ 解此等式：\n$$\\frac{\\Phi_{\\varepsilon}}{\\sinh(\\Phi_{\\varepsilon})} = \\varepsilon$$\n对于 $\\varepsilon \\ll 1$，这要求 $\\Phi_{\\varepsilon}$ 很大。在此范围内，$\\sinh(\\Phi_{\\varepsilon}) \\approx \\frac{1}{2}\\exp(\\Phi_{\\varepsilon})$。方程变为：\n$$\\frac{\\Phi_{\\varepsilon}}{\\frac{1}{2}\\exp(\\Phi_{\\varepsilon})} \\approx \\varepsilon \\quad \\implies \\quad \\Phi_{\\varepsilon} \\exp(-\\Phi_{\\varepsilon}) \\approx \\frac{\\varepsilon}{2}$$\n这是一个超越方程，其解由朗伯W函数（Lambert W function）给出。将其改写为 $(-\\Phi_{\\varepsilon})\\exp(-\\Phi_{\\varepsilon}) \\approx -\\frac{\\varepsilon}{2}$，我们发现 $-\\Phi_{\\varepsilon} \\approx W(-\\varepsilon/2)$。对于一个大的 $\\Phi_{\\varepsilon}  0$，我们必须使用下支，即 $W_{-1}$。\n$$\\Phi_{\\varepsilon} = \\frac{R_{\\varepsilon}}{\\delta} \\approx -W_{-1}(-\\varepsilon/2)$$\n解出 $R_{\\varepsilon}$ 并代入 $\\delta=\\sqrt{D/k}$：\n$$R_{\\varepsilon} \\approx -\\sqrt{\\frac{D}{k}} W_{-1}\\left(-\\frac{\\varepsilon}{2}\\right)$$\n这为形成缺氧核心所需的最小半径提供了闭式表达式。\n\n最后，对于第四部分，推导出的表达式为理解微生物生态位分化提供了定量基础。\n该模型表明，即使周围的宏观流体是完全有氧的（$C(R)=C_0$），在微生物聚集体内也可能出现缺氧微环境（$C(r) \\approx 0$）。关键条件是聚集体内的氧气消耗速率相对于氧气扩散入内的速率要大。这个条件由 Thiele 模数 $\\Phi=R\\sqrt{k/D}$ 来描述。如果聚集体半径 $R$ 大，扩散系数 $D$ 低（例如，在致密的生物膜基质中），或代谢消耗速率常数 $k$ 高，那么 $\\Phi$ 将会很大，导致朝向中心的氧浓度显著下降，并形成缺氧核心。这解释了在从名义上有氧的生境中采集的样品中观察到专性厌氧菌存在的原因。\n\n这一原理直接为培养“未培养”的厌氧菌的策略提供了指导。人们可以设计实验室系统来复制这些扩散受限的条件。例如，在致密的颗粒、凝胶或限制氧气传输的专门微流控设备中培养细胞，可以创造出必要的低氧微环境。此外，该模型解释了共培养技术的成功。通过将目标厌氧菌与兼性或好氧的伴侣生物一起生长，伴侣生物消耗环境中的氧气，有效地增加了局部体积消耗速率 $k$。正如我们的模型所示，增加 $k$ 会增加 $\\Phi$，从而促进了缺氧核心的形成，厌氧微生物可以在其中茁壮成长。好氧伴侣充当了氧汇，保护了其厌氧伙伴。", "answer": "$$\\boxed{\\sqrt{\\frac{D}{k}}}$$", "id": "2508944"}]}