{"hands_on_practices": [{"introduction": "比较基因组学分析的准确性始于对原始测序数据质量的深刻理解。本练习将探讨鸟枪法测序中无处不在的Phred质量分数，并将其与变异发现中的假阳性率直接联系起来。通过构建一个概率模型，您将能够量化过滤阈值对分析结果的统计影响，从而将主观决策转化为严谨的定量评估。[@problem_id:2483725]", "problem": "一项比较微生物系统发育基因组学研究旨在使用第二代测序 (NGS) 读段，在 $N$ 个克隆细菌分离株中鉴定单核苷酸变异 (SNV)，这些分离株共享一个长度为 $L$ 个碱基对的核心基因组比对。每个分离株中的每个位点都由恰好 $D$ 条独立的读段覆盖，这些读段的碱基检出通过一个最小 Phred 质量分阈值 $Q_{\\mathrm{th}}$ 进行筛选。假设完美比对，没有真正的生物学变异（分离株是完全相同的），并且在保留的碱基上的测序错误在读段和分离株之间是独立的，每个碱基的错误概率 $p_{\\mathrm{err}}$ 由 Phred 转换 $Q=-10\\log_{10}(p_{\\mathrm{err}})$ 决定。一个简单的位点水平变异发现程序将一个位点标记为可变，如果至少一个分离株中的至少一个读段报告了一个与该位点（真实）参考碱基不同的碱基。\n\n从 Phred 质量分的定义和基本概率法则出发，推导假阳性变异位点的期望数 $E_{\\mathrm{FP}}(Q_{\\mathrm{th}})$ 作为 $L$、$N$、$D$ 和 $p_{\\mathrm{err}}(Q_{\\mathrm{th}})$ 的函数，然后在适用于严格筛选的小错误极限下（其中 $N D\\,p_{\\mathrm{err}}(Q_{\\mathrm{th}})\\ll 1$）简化它。使用此结果，计算在相同的 $L$、$N$ 和 $D$ 下的比率\n$$\nR \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}\n$$\n将 $R$ 的最终答案以单个数字（无量纲）的形式给出。不要四舍五入。", "solution": "首先对问题陈述进行系统性验证。\n\n逐字提取已知条件：\n- $N$: 克隆细菌分离株的数量。\n- $L$: 核心基因组比对的长度，以碱基对为单位。\n- $D$: 每个分离株中覆盖每个位点的独立读段数。\n- $Q_{\\mathrm{th}}$: 最小 Phred 质量分阈值。\n- 假设：完美比对。\n- 假设：没有真正的生物学变异（分离株完全相同）。\n- 假设：保留碱基上的测序错误在读段和分离株之间是独立的。\n- $p_{\\mathrm{err}}$: 每个碱基的错误概率。\n- 定义：Phred 分数 $Q = -10\\log_{10}(p_{\\mathrm{err}})$。\n- 变异发现规则：如果至少一个分离株中的至少一个读段报告的碱基与真实参考碱基不同，则该位点被标记为可变。\n- 任务1：推导假阳性变异位点的期望数 $E_{\\mathrm{FP}}(Q_{\\mathrm{th}})$，作为 $L$、$N$、$D$ 和 $p_{\\mathrm{err}}(Q_{\\mathrm{th}})$ 的函数。\n- 任务2：在小错误极限 $N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}) \\ll 1$ 下简化此表达式。\n- 任务3：使用简化后的结果计算比率 $R \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}$。\n\n验证结论：\n该问题是有效的。它在科学上基于基因组学和生物信息学的原理，特别是测序错误的统计建模。Phred 分数、单核苷酸变异和假阳性率等概念是该领域的标准。该问题定义明确，所有必要的参数和假设都清晰地定义，以构建一个概率模型。其语言客观而精确。诸如恒定读段深度和无真实变异等假设是建立基线错误模型的常见理想化情况。该问题是概率论的一个非平凡应用，需要逻辑推导，而不仅仅是背诵事实。\n\n解题推导：\n我们首先将每个碱基的错误概率 $p_{\\mathrm{err}}$ 形式化为 Phred 质量分阈值 $Q_{\\mathrm{th}}$ 的函数。问题定义了 $Q = -10\\log_{10}(p_{\\mathrm{err}})$。求解 $p_{\\mathrm{err}}$ 可得：\n$$\n\\log_{10}(p_{\\mathrm{err}}) = -\\frac{Q}{10}\n$$\n$$\np_{\\mathrm{err}}(Q) = 10^{-Q/10}\n$$\n对于给定的阈值 $Q_{\\mathrm{th}}$，我们将错误概率记为 $p_{\\mathrm{err}} \\equiv p_{\\mathrm{err}}(Q_{\\mathrm{th}})$。根据问题陈述，所有保留的碱基都假定具有此错误概率。\n\n单个碱基检出正确（即没有错误）的概率是 $1 - p_{\\mathrm{err}}$。\n考虑单个基因组位点。该位点在 $N$ 个分离株中均被 $D$ 条读段覆盖，总共有 $N \\times D$ 条读段。问题陈述说明测序错误在读段和分离株之间是独立的。\n\n如果覆盖某个位点的 $N \\times D$ 条读段中至少有一条报告了错误的碱基，则该位点被标记为假阳性变异。计算其互补事件的概率会更简单：即该位点*未*被标记为变异。这种情况发生当且仅当覆盖该位点的所有 $N \\times D$ 条读段都是正确的。\n\n由于独立性，所有 $N \\times D$ 条读段都正确的概率是它们各自正确概率的乘积：\n$$\nP(\\text{no error at site}) = (1 - p_{\\mathrm{err}})^{N D}\n$$\n因此，一个位点被标记为假阳性的概率 $P_{\\mathrm{FP}}$ 是：\n$$\nP_{\\mathrm{FP}} = 1 - P(\\text{no error at site}) = 1 - (1 - p_{\\mathrm{err}})^{N D}\n$$\n假阳性位点的总数是一个随机变量，是比对中 $L$ 个位点上的伯努利试验之和。假设各位点之间的错误是独立的，那么假阳性位点的期望数 $E_{\\mathrm{FP}}$ 是总位点数 $L$ 乘以单个位点成为假阳性的概率：\n$$\nE_{\\mathrm{FP}}(Q_{\\mathrm{th}}) = L \\cdot P_{\\mathrm{FP}} = L \\left(1 - (1 - p_{\\mathrm{err}}(Q_{\\mathrm{th}}))^{N D}\\right)\n$$\n这就是假阳性期望数的完整表达式。\n\n接下来，我们在小错误极限 $N D p_{\\mathrm{err}} \\ll 1$ 下简化此表达式。此条件允许我们使用一阶二项式近似，对于 $|kx| \\ll 1$ 有 $(1-x)^k \\approx 1 - kx$。在这里，我们认定 $x = p_{\\mathrm{err}}$ 且 $k = N D$。给定条件 $ND p_{\\mathrm{err}} \\ll 1$ 确保了此近似的有效性。\n将此应用于我们的 $P_{\\mathrm{FP}}$ 表达式：\n$$\n(1 - p_{\\mathrm{err}})^{N D} \\approx 1 - N D p_{\\mathrm{err}}\n$$\n将此代回 $E_{\\mathrm{FP}}$ 的公式：\n$$\nE_{\\mathrm{FP}}(Q_{\\mathrm{th}}) \\approx L (1 - (1 - N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}))) = L (1 - 1 + N D p_{\\mathrm{err}}(Q_{\\mathrm{th}})) = L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}})\n$$\n这个简化的结果表明，假阳性的期望数约等于测序的总碱基数（$L \\times N \\times D$）乘以每个碱基的错误率。\n\n问题要求我们使用这个简化的结果来计算比率 $R \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}$。\n使用近似，我们得到：\n$$\nR = \\frac{L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}=20)}{L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}=30)}\n$$\n$L$、$N$ 和 $D$ 项相互抵消，剩下：\n$$\nR = \\frac{p_{\\mathrm{err}}(20)}{p_{\\mathrm{err}}(30)}\n$$\n我们现在计算 $Q=20$ 和 $Q=30$ 时的具体错误概率：\n对于 $Q_{\\mathrm{th}} = 20$：\n$$\np_{\\mathrm{err}}(20) = 10^{-20/10} = 10^{-2} = 0.01\n$$\n对于 $Q_{\\mathrm{th}} = 30$：\n$$\np_{\\mathrm{err}}(30) = 10^{-30/10} = 10^{-3} = 0.001\n$$\n将这些值代入 $R$ 的表达式：\n$$\nR = \\frac{10^{-2}}{10^{-3}} = 10^{-2 - (-3)} = 10^1 = 10\n$$\n使用简化模型的指令至关重要，因为它使得该比率与参数 $L$、$N$ 和 $D$ 无关，从而得出一个单一的数值答案。该比率表明，在此模型的假设下，质量阈值为 $Q=20$ 预计会比阈值为 $Q=30$ 产生多10倍的假阳性变异位点。", "answer": "$$\n\\boxed{10}\n$$", "id": "2483725"}, {"introduction": "从单个碱基的质量扩展到整个基因组的完整性，宏基因组组装基因组（MAGs）的质量评估对于泛基因组学研究至关重要。本练习模拟了一个常见场景：由于MAGs的不完整性，真实的“核心基因”在分析中被错误地排除。您将建立一个模型来预测这种“核心基因组侵蚀”的程度，从而揭示在分析数以百计的MAGs时，严格的核心基因定义可能带来的偏差。[@problem_id:2483716]", "problem": "您正在对两个细菌的宏基因组组装基因组（MAG）进行泛基因组分析。每个 MAG 的估计完整度为 $0.90$，污染度为 $0.05$。假设采用以下基础模型，该模型反映了宏基因组分箱和基因存在-缺失分析中广泛使用的操作性定义：\n\n- 一个 MAG 的完整度 $c$ 近似表示，对于该基因组中真实存在的任何一个单拷贝基因，该基因被恢复并正确分箱的概率，因此每个基因的假阴性（丢失）概率为 $1-c$。\n- 污染由不属于真实目标基因组的基因组成；它可以产生假阳性的基因存在判断，但在严格的直系同源感知评分下，它不会“挽救”分箱中缺失的真实基因。因此，污染不会降低真实单拷贝基因的假阴性概率。\n- 在不同 MAG 之间，基因恢复事件是独立的，并且所有核心基因在每个基因组中都真实存在一次。\n- 在泛基因组中，严格核心集定义为在所有被考察的基因组中都被评分为存在的基因集合。\n\n根据此模型：\n\n1) 根据 $c$ 和基因组数量 $n$，推导出因不完全恢复而被错误地从严格核心集中排除的真实单拷贝核心基因的期望分数。然后对 $n=2$ 和 $c=0.90$ 计算该表达式的值。\n\n2) 提出数学上明确的筛选标准来控制核心基因的错误排除，该标准用 $c$、$n$ 和用户指定的在严格核心定义下丢失的真实核心基因的期望分数容差 $\\epsilon$ 表示。提供一个关于确保期望严格核心损失最多为 $\\epsilon$ 所需的最小完整度 $c_{\\min}$ 的封闭形式条件，并陈述一个通过允许丢失的基因组数量 $m$ 的二项式尾部表示的互补“软核心”放宽条件。\n\n作为最终答案，仅报告第 (1) 部分中期望的错误排除率的数值，以小数形式表示并四舍五入到三位有效数字。最终答案中不要包含任何单位或百分号。", "solution": "问题陈述经验证。\n\n**第1步：提取已知条件**\n- 宏基因组组装基因组（MAG）的数量：$n$。对于第 (1) 部分，具体为 $n=2$。\n- 每个 MAG 的估计完整度：$c = 0.90$。\n- 每个 MAG 的估计污染度：$0.05$。\n- 完整度 $c$ 的模型定义：基因组中真实存在的单拷贝基因被恢复的概率。\n- 一个真实基因的假阴性（丢失）概率：$1-c$。\n- 污染不会降低真实基因的假阴性概率。\n- 不同 MAG 间的基因恢复事件是独立的。\n- 所有核心基因在每个基因组中真实存在一次。\n- 严格核心集的定义：在所有被考察的 $n$ 个基因组中都被评分为存在的基因集合。\n- 任务1：根据 $c$ 和 $n$ 推导出因不完全恢复而被错误地从严格核心集中排除的真实单拷贝核心基因的期望分数。对 $n=2$ 和 $c=0.90$ 进行求值。\n- 任务2：提出筛选标准以控制核心基因的错误排除。这包括在给定容差 $\\epsilon$ 的情况下，推导最小完整度 $c_{\\min}$，并提出基于二项式尾部概率的“软核心”放宽条件。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，表述清晰且客观。它将计算生物学中的一个常见挑战形式化——数据不完整性对核心基因组估计等比较基因组学推断的影响。该模型虽然是一个简化，但基于宏基因组学中使用的标准操作性定义（例如，CheckM 的输出）。独立性假设和完整性的定义对于一阶近似是标准的。问题在数学上是精确的，可以使用概率论的基本原理解答。问题不含科学谬误、矛盾或模糊之处。关于污染度的值对于所提出的关于真实核心基因的具体问题是无关的，但它的存在并不会使问题无效；它仅要求解答者正确识别相关信息。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n**第1部分：错误排除率的推导与计算**\n\n让我们考虑一个真实的单一核心基因。根据问题陈述，根据定义，该基因存在于 $n$ 个 MAG 中每一个的真实基因组中。\n\n该基因在单个 MAG 中被成功恢复的概率由完整度 $c$ 给出。\n该基因在单个 MAG 中*未被*恢复（假阴性）的概率为 $1-c$。\n\n一个基因仅当在*所有* $n$ 个 MAG 中都成功恢复时，才被包含在“严格核心集”中。由于规定恢复事件在不同 MAG 间是独立的，一个真实核心基因被正确识别为严格核心集一部分的概率 $P_{\\text{core}}$ 是各个恢复概率的乘积：\n$$P_{\\text{core}} = \\prod_{i=1}^{n} c_i$$\n假设，如问题所暗示的，所有 MAG 具有统一的完整度 $c$，则上式简化为：\n$$P_{\\text{core}} = c^n$$\n\n问题要求的是被错误排除的真实核心基因的期望分数。这等同于单个真实核心基因*不*被包含在观察到的严格核心集中的概率。如果该基因在至少一个 MAG 中丢失，此事件就会发生。此事件的概率 $P_{\\text{exclude}}$ 是被包含在核心集中的补集：\n$$P_{\\text{exclude}} = 1 - P_{\\text{core}}$$\n代入 $P_{\\text{core}}$ 的表达式，我们得到被错误排除的真实核心基因的期望分数的通用公式：\n$$P_{\\text{exclude}}(n, c) = 1 - c^n$$\n\n这是根据 $c$ 和 $n$ 的通用推导。\n现在，我们必须用给定值 $n=2$ 和 $c=0.90$ 来计算此表达式。\n$$P_{\\text{exclude}}(2, 0.90) = 1 - (0.90)^2$$\n$$P_{\\text{exclude}}(2, 0.90) = 1 - 0.81$$\n$$P_{\\text{exclude}}(2, 0.90) = 0.19$$\n因此，对于两个完整度为 $90\\%$ 的 MAG，仅由于随机的未恢复，预期会错误地丢失 $19\\%$ 的真实核心基因组。四舍五入到三位有效数字得到 $0.190$。\n\n**第2部分：筛选标准**\n\n首先，我们讨论最小完整度 $c_{\\min}$ 的条件。给定一个用户指定的容差 $\\epsilon$，表示可接受的丢失的真实核心基因的最大分数。条件是：\n$$P_{\\text{exclude}} \\le \\epsilon$$\n代入我们推导的表达式：\n$$1 - c^n \\le \\epsilon$$\n为了找到满足给定 $n$ 和 $\\epsilon$ 条件的最小完整度 $c_{\\min}$，我们对 $c$ 解此不等式：\n$$1 - \\epsilon \\le c^n$$\n$$c \\ge (1 - \\epsilon)^{1/n}$$\n因此，关于最小完整度的封闭形式条件是：\n$$c_{\\min} = (1 - \\epsilon)^{1/n}$$\n任何包含 $n$ 个基因组的集合，在严格核心定义下，必须具有至少为此值的平均完整度，才能满足容差 $\\epsilon$。\n\n其次，我们提出一个“软核心”放宽条件。我们可以将软核心定义为存在于至少 $n-m$ 个 MAG 中的基因集合，而不是要求一个基因存在于所有 $n$ 个 MAG 中，其中 $m$ 是允许的最大丢失数量。\n\n设 $X$ 为一个随机变量，表示一个真实核心基因在 $n$ 个 MAG 中被成功恢复的数量。根据问题的假设（独立试验，成功概率恒定），$X$ 服从参数为 $n$（试验次数）和 $c$（成功概率）的二项分布：\n$$X \\sim B(n, c)$$\n其概率质量函数由 $P(X=k) = \\binom{n}{k} c^k (1-c)^{n-k}$ 给出。\n\n如果一个真实核心基因在少于 $n-m$ 个 MAG 中被恢复，它就被错误地从这个“软核心”中排除。此事件的概率 $P_{\\text{soft\\_exclude}}$ 是在 $0, 1, \\dots, n-m-1$ 个 MAG 中找到该基因的概率之和。这是二项分布的左尾：\n$$P_{\\text{soft\\_exclude}} = P(X  n-m) = \\sum_{k=0}^{n-m-1} P(X=k)$$\n$$P_{\\text{soft\\_exclude}} = \\sum_{k=0}^{n-m-1} \\binom{n}{k} c^k (1-c)^{n-k}$$\n筛选标准是选择一个放宽参数 $m$，使得期望损失在容差 $\\epsilon$ 之内：\n$$\\sum_{k=0}^{n-m-1} \\binom{n}{k} c^k (1-c)^{n-k} \\le \\epsilon$$\n这提供了一种数学上明确的方法来放宽严格核心的定义，通过允许特定数量的丢失 $m$ 来控制错误排除率，该数量基于基因组数量 $n$、它们的完整度 $c$ 以及期望的误差容差 $\\epsilon$。", "answer": "$$\\boxed{0.190}$$", "id": "2483716"}, {"introduction": "微生物的进化历史可以通过不同的基因组特征来描绘，例如基于核心基因组单核苷酸多态性（SNP）的系统发育树或基于附属基因含量的树，而这些树的拓扑结构可能并不一致。为了客观地评估它们之间的一致性或冲突，我们需要一个定量的度量标准。本练习将介绍经典的 Robinson-Foulds (RF) 距离，通过手动计算，您将掌握一种量化和比较不同系统发育假设之间拓扑差异的基本方法。[@problem_id:2483696]", "problem": "您正在比较一组微生物基因组的系统基因组学重构，以评估核心基因组树与附件基因内容树之间的拓扑不一致性。设固定的分类单元集为 $X=\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$，代表 $8$ 个已标记的细菌基因组。$X$ 上的每个无根、完全二分的系统发育树都可以由其非平凡二分（分裂）的集合来表示，其中每个内部边都恰好将 $X$ 划分为两个不相交、非空且大小至少为 $2$ 的部分。\n\n树 $\\;T_{1}\\;$（核心基因组）产生以下非平凡分裂集合：\n$$\n\\Sigma(T_{1})=\\Big\\{\n\\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}, \n$$\n$$\n\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\}\n\\Big\\}.\n$$\n\n树 $\\;T_{2}\\;$（附件基因内容）产生以下非平凡分裂集合：\n$$\n\\Sigma(T_{2})=\\Big\\{\n\\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\},\\;\n\\{\\text{C},\\text{D}\\}\\mid\\{\\text{A},\\text{B},\\text{E},\\text{F},\\text{G},\\text{H}\\},\n$$\n$$\n\\{\\text{E},\\text{F}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{G},\\text{H}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F}\\}\n\\Big\\}.\n$$\n\n从固定分类单元集上的无根系统发育树的每个内部边都产生一个非平凡分裂，以及两棵树之间的拓扑差异可以通过它们分裂集合的差异来量化这一定義出发，请正式定义在同一分类单元集上的无根树的未加权 Robinson–Foulds (RF) 距离。然后计算上面给出的两棵树的 RF 距离 $d_{\\mathrm{RF}}(T_{1},T_{2})$。不要使用任何归一化变体；以单个整数报告未加权的 RF 距离。无需四舍五入。", "solution": "首先验证问题。\n\n**步骤1：提取已知条件**\n- 分类单元集：$X=\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$，代表 $8$ 个已标记的基因组。\n- 树是无根且完全二分的。\n- 每个内部边都将 $X$ 产生一个非平凡二分（分裂），划分为两个不相交、非空且大小至少为 $2$ 的部分。\n- 树 $T_{1}$ 的分裂集合：$\\Sigma(T_{1})=\\Big\\{ \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}, \\; \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\} \\Big\\}$。\n- 树 $T_{2}$ 的分裂集合：$\\Sigma(T_{2})=\\Big\\{ \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\},\\; \\{\\text{C},\\text{D}\\}\\mid\\{\\text{A},\\text{B},\\text{E},\\text{F},\\text{G},\\text{H}\\}, \\; \\{\\text{E},\\text{F}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{G},\\text{H}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F}\\} \\Big\\}$。\n- 任务：正式定义未加权的 Robinson–Foulds 距离 $d_{\\mathrm{RF}}$，并计算 $d_{\\mathrm{RF}}(T_{1},T_{2})$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在系统发育学和组合数学领域有科学依据。使用分裂来表示树拓扑和 Robinson–Foulds 度量是比较基因组学中的标准概念。对于一个有 $n$ 个分类单元的无根、完全二分树，其内部边的数量，也就是非平凡分裂的数量，是 $n-3$。这里，$n=8$，所以必须有 $8-3=5$ 个非平凡分裂。已知条件给出 $|\\Sigma(T_1)| = 5$ 和 $|\\Sigma(T_2)| = 5$，这是一致的。问题是适定的、客观的，并包含得出唯一解所需的所有信息。未检测到缺陷。\n\n**步骤3：结论与行动**\n问题有效。将继续进行解答。\n\n任务要求正式定义未加权的 Robinson–Foulds (RF) 距离，并为给定的树 $T_1$ 和 $T_2$ 计算该距离。\n\n设 $T_1$ 和 $T_2$ 是共享同一分类单元集 $X$ 的两棵无根系统发育树。设 $\\Sigma(T_1)$ 和 $\\Sigma(T_2)$ 分别表示由 $T_1$ 和 $T_2$ 的内部边产生的非平凡二分（分裂）集合。$X$ 的一个二分是一个不相交、非空的集合对 $\\{A, B\\}$，使得 $A \\cup B = X$。RF 距离 $d_{\\mathrm{RF}}(T_1, T_2)$ 定义为两个分裂集合的对称差的基数：\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1) \\Delta \\Sigma(T_2)|$$\n两个集合 $S_1$ 和 $S_2$ 的对称差是指那些只存在于其中一个集合中，但不在它们交集中的元素所组成的集合，定义为 $S_1 \\Delta S_2 = (S_1 \\setminus S_2) \\cup (S_2 \\setminus S_1)$。对称差的基数可以计算为：\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1) \\setminus \\Sigma(T_2)| + |\\Sigma(T_2) \\setminus \\Sigma(T_1)|$$\n这等同于总分裂数减去共同分裂数的两倍：\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1)| + |\\Sigma(T_2)| - 2|\\Sigma(T_1) \\cap \\Sigma(T_2)|$$\n问题提供了分类单元集 $X$（其中 $|X|=8$）以及分裂集合 $\\Sigma(T_1)$ 和 $\\Sigma(T_2)$，两者都正确地包含 $n-3 = 8-3=5$ 个分裂。我们必须找到它们的交集 $\\Sigma(T_1) \\cap \\Sigma(T_2)$。\n\n关键是要认识到，一个二分 $\\{A\\} \\mid \\{B\\}$ 是一个无序集合对，因此与二分 $\\{B\\} \\mid \\{A\\}$ 是相同的，其中 $B = X \\setminus A$。\n\n$T_1$ 的分裂集合是：\n$\\Sigma(T_1) = \\Big\\{ s_{1,1}, s_{1,2}, s_{1,3}, s_{1,4}, s_{1,5} \\Big\\}$，其中：\n$s_{1,1} = \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,2} = \\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,3} = \\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,4} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,5} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\}$\n\n$T_2$ 的分裂集合是：\n$\\Sigma(T_2) = \\Big\\{ s_{2,1}, s_{2,2}, s_{2,3}, s_{2,4}, s_{2,5} \\Big\\}$，其中：\n$s_{2,1} = \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{2,2} = \\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}$\n$s_{2,3} = \\{\\text{C},\\text{D}\\}\\mid\\{\\text{A},\\text{B},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{2,4} = \\{\\text{E},\\text{F}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{G},\\text{H}\\}$\n$s_{2,5} = \\{\\text{A},\\text{B},\\text{G},\\text{H}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F}\\}$\n\n我们现在来确定共同的分裂，即 $\\Sigma(T_1) \\cap \\Sigma(T_2)$：\n1.  将 $s_{1,1}$ 与 $\\Sigma(T_2)$ 中的分裂进行比较：分裂 $s_{1,1} = \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$ 与 $s_{2,1}$ 相同。这是一个共同分裂。\n2.  将 $s_{1,2}$ 与 $\\Sigma(T_2)$ 中的分裂进行比较：分裂 $s_{1,2} = \\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$ 与 $\\Sigma(T_2)$ 中的任何分裂都不匹配。\n3.  将 $s_{1,3}$ 与 $\\Sigma(T_2)$ 中的分裂进行比较：分裂 $s_{1,3} = \\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}$ 与 $\\Sigma(T_2)$ 中的任何分裂都不匹配。\n4.  将 $s_{1,4}$ 与 $\\Sigma(T_2)$ 中的分裂进行比较：分裂 $s_{1,4} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\}$ 与 $\\Sigma(T_2)$ 中的任何分裂都不匹配。\n5.  将 $s_{1,5}$ 与 $\\Sigma(T_2)$ 中的分裂进行比较：分裂 $s_{1,5} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\}$ 与 $s_{2,2} = \\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}$ 相同，因为二分是一个无序集合对。这是第二个共同分裂。\n\n共同分裂的集合是 $\\Sigma(T_1) \\cap \\Sigma(T_2) = \\{s_{1,1}, s_{1,5}\\} = \\{s_{2,1}, s_{2,2}\\}$。交集的基数是 $|\\Sigma(T_1) \\cap \\Sigma(T_2)|=2$。\n\n$T_1$ 独有的分裂数量是 $|\\Sigma(T_1) \\setminus \\Sigma(T_2)| = |\\Sigma(T_1)| - |\\Sigma(T_1) \\cap \\Sigma(T_2)| = 5 - 2 = 3$。这些分裂是 $\\{s_{1,2}, s_{1,3}, s_{1,4}\\}$。\n$T_2$ 独有的分裂数量是 $|\\Sigma(T_2) \\setminus \\Sigma(T_1)| = |\\Sigma(T_2)| - |\\Sigma(T_1) \\cap \\Sigma(T_2)| = 5 - 2 = 3$。这些分裂是 $\\{s_{2,3}, s_{2,4}, s_{2,5}\\}$。\n\nRobinson–Foulds 距離是这些数量的总和：\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1) \\setminus \\Sigma(T_2)| + |\\Sigma(T_2) \\setminus \\Sigma(T_1)| = 3 + 3 = 6$$\n或者，使用另一个公式：\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1)| + |\\Sigma(T_2)| - 2|\\Sigma(T_1) \\cap \\Sigma(T_2)| = 5 + 5 - 2(2) = 10 - 4 = 6$$\n$T_1$ 和 $T_2$ 之间的未加权 Robinson–Foulds 距离是 $6$。", "answer": "$$\n\\boxed{6}\n$$", "id": "2483696"}]}