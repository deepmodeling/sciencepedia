{"hands_on_practices": [{"introduction": "在解释任何组学数据之前，我们必须首先确保其定量结果的准确性。本练习将引导你完成一个基础但至关重要的过程：使用质谱法（蛋白质组学和代谢组学中的核心技术）为绝对定量建立校准曲线。通过这项实践[@problem_id:2494820]，你将不仅学习如何拟合线性模型，还将学会如何评估和建模测量误差（异方差性），这对于进行精确的统计分析至关重要。", "problem": "一个微生物学实验室正在开发一种使用液相色谱–串联质谱（LC–MS/MS）和稳定同位素标记内标（SIL-IS）对厌氧培养上清液中短链脂肪酸丁酸盐进行绝对定量分析的方法。仪器响应记录为分析物与内标的峰面积比（无量纲）。在合成基质中制备了外标校准标准品，其浓度范围覆盖了从低到高的微摩尔浓度。对于每种标准品，在恒定离子源条件下进行三次重复进样，以评估校准线性以及响应的均值-方差关系。\n\n现给出以下校准水平（丁酸盐浓度，单位为 $\\mu\\text{M}$）和三次重复响应（面积比，无量纲）。每行列出浓度 $c$ 及其三次重复响应 $y_{1},y_{2},y_{3}$：\n\n- $c = 1$: $0.0147$, $0.0150$, $0.0153$\n- $c = 2$: $0.0294$, $0.0300$, $0.0306$\n- $c = 4$: $0.0588$, $0.0600$, $0.0612$\n- $c = 8$: $0.1176$, $0.1200$, $0.1224$\n- $c = 16$: $0.2352$, $0.2400$, $0.2448$\n- $c = 32$: $0.4704$, $0.4800$, $0.4896$\n- $c = 64$: $0.9408$, $0.9600$, $0.9792$\n- $c = 128$: $1.666$, $1.700$, $1.734$\n\n假设以下在功能代谢组学定量中为标准的基本假设：\n- 在线性动态范围内，平均仪器响应与分析物浓度成正比：$y = \\beta c + \\varepsilon$，其中 $E[\\varepsilon \\mid c] = 0$。\n- 在异方差性下，当权重与条件方差的倒数成正比时，适用加权最小二乘法：$w(\\mu) \\propto 1/\\operatorname{Var}(Y \\mid \\mu)$，其中 $\\mu = E[Y \\mid c]$。\n- 每个水平上的无偏样本方差为 $s^{2} = \\frac{1}{n-1}\\sum_{j=1}^{n}(y_{j}-\\bar{y})^{2}$，其中 $n = 3$。\n- 对于使用内标法的基于离子流的检测器，方差-均值幂模型是合理的：$\\operatorname{Var}(Y \\mid \\mu) = a \\mu^{p}$，其中 $a > 0$, $p > 0$。\n\n您必须执行以下任务：\n1) 对前七个标准品（$c \\leq 64\\ \\mu\\text{M}$）的各水平平均值 $\\bar{y}$ 使用普通最小二乘法 (OLS) 拟合过原点的比例模型 $y = \\beta c$，从而构建校准曲线。使用此模型定义预测响应 $\\hat{y} = \\hat{\\beta} c$。\n2) 将线性动态范围定义为所提供校准品上的最大区间 $\\left[c_{\\min}, c_{\\max}\\right]$，使得在该区间内的每个校准品，其绝对相对残差都满足 $\\left|\\bar{y} - \\hat{y}\\right|/\\hat{y}  \\delta$，其中 $\\delta = 0.05$。根据此标准确定 $c_{\\max}$。\n3) 使用所有水平的数据，通过对各水平的 $\\ln(s^{2})$ 关于 $\\ln(\\bar{y})$ 进行普通最小二乘回归，来估计方差-均值幂模型中的指数 $p$。使用自然对数和根据每个水平的三次重复计算出的无偏样本方差。\n4) 根据拟合的方差模型，指明用于加权最小二乘法的权重函数 $w(\\bar{y}) \\propto 1/\\widehat{\\operatorname{Var}}(Y \\mid \\bar{y})$。\n\n答案规格：\n- 仅报告任务3中估计出的指数 $p$。\n- 将 $p$ 表示为一个无量纲实数。\n- 将您的答案四舍五入到四位有效数字。", "solution": "此问题已经过验证。\n\n**步骤1：提取已知信息**\n- **数据**：八个校准水平，包括浓度 $c$（单位为 $\\mu\\text{M}$）和三次重复响应 $(y_1, y_2, y_3)$（无量纲面积比）：\n    - $c = 1$: $\\{0.0147, 0.0150, 0.0153\\}$\n    - $c = 2$: $\\{0.0294, 0.0300, 0.0306\\}$\n    - $c = 4$: $\\{0.0588, 0.0600, 0.0612\\}$\n    - $c = 8$: $\\{0.1176, 0.1200, 0.1224\\}$\n    - $c = 16$: $\\{0.2352, 0.2400, 0.2448\\}$\n    - $c = 32$: $\\{0.4704, 0.4800, 0.4896\\}$\n    - $c = 64$: $\\{0.9408, 0.9600, 0.9792\\}$\n    - $c = 128$: $\\{1.666, 1.700, 1.734\\}$\n- **模型与定义**：\n    - 平均响应模型：$y = \\beta c + \\varepsilon$，其中 $E[\\varepsilon \\mid c] = 0$。\n    - 加权最小二乘法的权重：$w(\\mu) \\propto 1/\\operatorname{Var}(Y \\mid \\mu)$，其中 $\\mu = E[Y \\mid c]$。\n    - 无偏样本方差公式：$s^{2} = \\frac{1}{n-1}\\sum_{j=1}^{n}(y_{j}-\\bar{y})^{2}$，其中 $n=3$。\n    - 方差-均值幂模型：$\\operatorname{Var}(Y \\mid \\mu) = a \\mu^{p}$，其中 $a > 0$, $p > 0$。\n- **任务**：\n    1. 对 $c \\leq 64\\ \\mu\\text{M}$ 的均值进行 $y = \\beta c$ 的OLS拟合。\n    2. 使用绝对相对残差标准 $|\\bar{y} - \\hat{y}|/\\hat{y}  0.05$ 确定线性动态范围 $c_{\\max}$。\n    3. 使用所有数据，通过对 $\\ln(s^{2})$ 关于 $\\ln(\\bar{y})$ 进行OLS回归来估计指数 $p$。\n    4. 指明权重函数 $w(\\bar{y})$。\n- **要求输出**：报告任务3中得到的 $p$ 值，四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题具有科学依据，描述了定量质谱分析中的标准校准和方差建模程序。问题提法得当，提供了所有必要的数据，并指明了执行任务所需的分析方法。语言客观，没有歧义。问题是自洽、一致且可通过计算验证的。不存在违反科学原理、逻辑不一致或事实错误的情况。数据虽然经过理想化，但在物理上是合理的。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n目标是确定方差-均值幂模型 $\\operatorname{Var}(Y \\mid \\mu) = a \\mu^{p}$ 的指数 $p$。该模型描述了仪器响应的异方差性。我们将使用样本统计量，即平均响应 $\\bar{y}$ 和样本方差 $s^2$，分别作为总体参数 $\\mu$ 和 $\\operatorname{Var}(Y \\mid \\mu)$ 的估计值。因此，该模型可近似为 $s^2 \\approx a \\bar{y}^p$。\n\n为了估计 $p$，我们通过对等式两边取自然对数来线性化这个幂律关系：\n$$ \\ln(s^2) = \\ln(a) + p \\ln(\\bar{y}) $$\n该方程的形式为 $Y' = \\beta_0 + \\beta_1 X'$，其中 $Y' = \\ln(s^2)$，$X' = \\ln(\\bar{y})$，截距为 $\\beta_0 = \\ln(a)$，斜率为 $\\beta_1 = p$。因此，可以通过对所有八个浓度水平的 $\\ln(s^2)$ 关于 $\\ln(\\bar{y})$ 进行普通最小二乘 (OLS) 回归来估计参数 $p$。\n\n首先，我们计算每个浓度水平 $c_i$（其中 $i = 1, \\dots, 8$）的样本均值 $\\bar{y}_i$ 和无偏样本方差 $s_i^2$。重复次数为 $n=3$。\n\n计算出的值如下：\n- 对于 $c_1=1$: $\\bar{y}_1 = (0.0147+0.0150+0.0153)/3 = 0.0150$。\n$s_1^2 = \\frac{1}{2}\\left((0.0147-0.0150)^2 + (0.0150-0.0150)^2 + (0.0153-0.0150)^2\\right) = 9 \\times 10^{-8}$。\n\n- 对于 $c_2=2$: $\\bar{y}_2 = (0.0294+0.0300+0.0306)/3 = 0.0300$。\n$s_2^2 = \\frac{1}{2}\\left((0.0294-0.0300)^2 + (0.0300-0.0300)^2 + (0.0306-0.0300)^2\\right) = 3.6 \\times 10^{-7}$。\n\n- 对于 $c_3=4$: $\\bar{y}_3 = (0.0588+0.0600+0.0612)/3 = 0.0600$。\n$s_3^2 = 1.44 \\times 10^{-6}$。\n\n- 对于 $c_4=8$: $\\bar{y}_4 = (0.1176+0.1200+0.1224)/3 = 0.1200$。\n$s_4^2 = 5.76 \\times 10^{-6}$。\n\n- 对于 $c_5=16$: $\\bar{y}_5 = (0.2352+0.2400+0.2448)/3 = 0.2400$。\n$s_5^2 = 2.304 \\times 10^{-5}$。\n\n- 对于 $c_6=32$: $\\bar{y}_6 = (0.4704+0.4800+0.4896)/3 = 0.4800$。\n$s_6^2 = 9.216 \\times 10^{-5}$。\n\n- 对于 $c_7=64$: $\\bar{y}_7 = (0.9408+0.9600+0.9792)/3 = 0.9600$。\n$s_7^2 = 3.6864 \\times 10^{-4}$。\n\n- 对于 $c_8=128$: $\\bar{y}_8 = (1.666+1.700+1.734)/3 = 1.700$。\n$s_8^2 = \\frac{1}{2}\\left((1.666-1.700)^2 + (1.700-1.700)^2 + (1.734-1.700)^2\\right) = 1.156 \\times 10^{-3}$。\n\n所提供的数据是人为完美的。我们可以证明关系式 $s_i^2 = k \\cdot \\bar{y}_i^2$ 对所有数据点和一个常数 $k$ 都成立，这意味着 $p=2$。让我们通过计算所有数据点的比率 $k = s_i^2 / \\bar{y}_i^2$ 来检验这个假设。\n\n对于第一个点 ($i=1$)：\n$$ k = \\frac{s_1^2}{\\bar{y}_1^2} = \\frac{9 \\times 10^{-8}}{(0.0150)^2} = \\frac{9 \\times 10^{-8}}{2.25 \\times 10^{-4}} = 4 \\times 10^{-4} $$\n对于第二个点 ($i=2$)：\n$$ k = \\frac{s_2^2}{\\bar{y}_2^2} = \\frac{3.6 \\times 10^{-7}}{(0.0300)^2} = \\frac{3.6 \\times 10^{-7}}{9 \\times 10^{-4}} = 4 \\times 10^{-4} $$\n这个模式对所有点都完美成立。让我们验证最后一个点（$i=8$），这个点看起来偏离了其他校准品的简单倍增序列：\n$$ k = \\frac{s_8^2}{\\bar{y}_8^2} = \\frac{1.156 \\times 10^{-3}}{(1.700)^2} = \\frac{1.156 \\times 10^{-3}}{2.89} = 4 \\times 10^{-4} $$\n由于对所有 $i=1, \\dots, 8$，比率 $s_i^2 / \\bar{y}_i^2$ 是一个常数，等于 $4 \\times 10^{-4}$，我们可以说样本数据完美拟合以下模型：\n$$ s^2 = (4 \\times 10^{-4}) \\bar{y}^2 $$\n将此与通用模型 $s^2 = a \\bar{y}^p$ 相比较，我们可以通过观察直接确定参数：$a = 4 \\times 10^{-4}$ 且 $p=2$。\n\n如果要正式地对 $\\ln(s^2)$ 关于 $\\ln(\\bar{y})$ 进行OLS回归，数据点将位于一条由 $\\ln(s^2) = \\ln(4 \\times 10^{-4}) + 2 \\ln(\\bar{y})$ 描述的完美直线上。对此类数据进行线性回归将得到一个恰好为 $2$ 的斜率，且决定系数 $R^2=1$。\n\n因此，估计的指数为 $p=2$。题目要求以四位有效数字报告此值。", "answer": "$$\\boxed{2.000}$$", "id": "2494820"}, {"introduction": "转录组学的目标是量化基因表达水平，但可变剪接的存在使这一过程变得复杂。本模拟练习[@problem_id:2494870]揭示了一个名为“长度偏见”的关键陷阱，即如果不进行适当处理，异构体使用的变化可能会在基因层面造成人为的表达差异。这项练习凸显了在进行精确的差异表达分析时，采用能够识别异构体的方法是何等重要。", "problem": "您的任务是使用一个基于原则的采样模型，对RNA测序（RNA-seq）下的基因水平表达定量进行确定性模拟实现，并比较两种估计量：一种是异构体感知（isoform-aware）估计量，另一种是朴素的基因水平长度校正估计量。目标是形式化并量化异构体比例的变化如何在聚合到基因水平时引入长度偏倚，并计算朴素方法所引入的乘性偏倚和相对误差。\n\n基础和假设：\n- 中心法则和表达测量：RNA测序（RNA-seq）测量源自转录本的片段；在均匀片段化和无偏采样的情况下，映射到一个异构体的片段期望数与其摩尔浓度和有效长度成正比。\n- 确定性期望模型：对于一个具有由 $j \\in \\{1,\\dots,I\\}$ 索引的异构体的基因，在样本 $s$ 中，设 $\\theta_{j,s}$ 表示异构体的摩尔浓度，$L_j$ 表示有效长度（单位为核苷酸，nt），$k_s$ 表示一个测序深度缩放常数。异构体 $j$ 的期望片段计数为\n$$\\mathbb{E}[C_{j,s}] = k_s \\, \\theta_{j,s} \\, L_j.$$\n- 设基因水平的摩尔丰度为 $G_s = \\sum_{j=1}^{I} \\theta_{j,s}$。定义异构体分数 $p_{j,s} = \\theta_{j,s}/G_s$，使得 $\\sum_{j} p_{j,s} = 1$ 且 $p_{j,s} \\ge 0$，因此 $\\theta_{j,s} = G_s \\, p_{j,s}$。\n\n待比较的估计量：\n- 异构体感知估计量（理想化）：给定期望计数和有效长度，定义\n$$\\widehat{G}_{\\mathrm{aware},s} = \\sum_{j=1}^{I} \\frac{\\mathbb{E}[C_{j,s}]}{k_s \\, L_j}。$$\n- 朴素的基因水平长度校正：首先将期望计数聚合到基因水平 $\\mathbb{E}[C_{\\mathrm{gene},s}] = \\sum_{j=1}^{I} \\mathbb{E}[C_{j,s}]$。然后除以一个从参考样本 $r$ 计算出的固定基因水平长度，\n$$L_{\\mathrm{ref}} = \\sum_{j=1}^{I} p_{j,r} \\, L_j,$$\n以获得\n$$\\widehat{G}_{\\mathrm{naive},s} = \\frac{\\mathbb{E}[C_{\\mathrm{gene},s}]}{k_s \\, L_{\\mathrm{ref}}}。$$\n\n每个测试用例需要计算的输出量：\n- 乘性偏倚因子\n$$B_s = \\frac{\\widehat{G}_{\\mathrm{naive},s}}{\\widehat{G}_{\\mathrm{aware},s}}。$$\n- 相对误差（以小数表示，而非百分比）\n$$\\delta_s = B_s - 1.$$\n\n实现说明：\n- 将上述过程视为使用期望计数的确定性模拟；不要引入随机性。\n- 使用提供的参数集测试套件。对于每个测试用例，您将获得：\n  - 异构体有效长度（单位：核苷酸）：一个列表 $[L_1,\\dots,L_I]$ (单位: nt)。\n  - 参考异构体分数 $[p_{1,r},\\dots,p_{I,r}]$，满足 $\\sum_j p_{j,r} = 1$。\n  - 样本异构体分数 $[p_{1,s},\\dots,p_{I,s}]$，满足 $\\sum_j p_{j,s} = 1$。\n  - 一个测序深度缩放常数 $k_s$ 和一个基因水平摩尔丰度 $G_s$ 用于构建期望计数。在此模拟中，每个测试用例均设置 $k_s = 1$ 和 $G_s = 1$，以使单位隐式化并分离长度-混合效应。\n- 对每个异构体 $j$ 计算 $\\mathbb{E}[C_{j,s}] = k_s \\, G_s \\, p_{j,s} \\, L_j$，然后如上所述计算 $\\widehat{G}_{\\mathrm{aware},s}$ 和 $\\widehat{G}_{\\mathrm{naive},s}$，最后计算 $B_s$ 和 $\\delta_s$。\n\n测试套件：\n- 案例1（两个异构体，样本中向较短异构体偏移）：\n  - $[L_1,L_2] = [1000,2000]$ nt\n  - $[p_{1,r},p_{2,r}] = [0.5,0.5]$\n  - $[p_{1,s},p_{2,s}] = [0.8,0.2]$\n  - $k_s = 1$, $G_s = 1$\n- 案例2（两个异构体，样本中向较长异构体偏移）：\n  - $[L_1,L_2] = [1000,2000]$ nt\n  - $[p_{1,r},p_{2,r}] = [0.5,0.5]$\n  - $[p_{1,s},p_{2,s}] = [0.2,0.8]$\n  - $k_s = 1$, $G_s = 1$\n- 案例3（三个异构体，从中等长度异构体显著转换为短异构体）：\n  - $[L_1,L_2,L_3] = [500,1500,3000]$ nt\n  - $[p_{1,r},p_{2,r},p_{3,r}] = [0.2,0.7,0.1]$\n  - $[p_{1,s},p_{2,s},p_{3,s}] = [0.7,0.2,0.1]$\n  - $k_s = 1$, $G_s = 1$\n- 案例4（三个异构体，长度相等，任何比例变化都不应产生偏倚）：\n  - $[L_1,L_2,L_3] = [1000,1000,1000]$ nt\n  - $[p_{1,r},p_{2,r},p_{3,r}] = [0.1,0.8,0.1]$\n  - $[p_{1,s},p_{2,s},p_{3,s}] = [0.7,0.2,0.1]$\n  - $k_s = 1$, $G_s = 1$\n- 案例5（三个异构体，参考和样本中比例相同，预期无偏倚）：\n  - $[L_1,L_2,L_3] = [750,1800,2400]$ nt\n  - $[p_{1,r},p_{2,r},p_{3,r}] = [0.3,0.4,0.3]$\n  - $[p_{1,s},p_{2,s},p_{3,s}] = [0.3,0.4,0.3]$\n  - $k_s = 1$, $G_s = 1$\n- 案例6（两个异构体，向极长异构体发生极端转换）：\n  - $[L_1,L_2] = [500,5000]$ nt\n  - $[p_{1,r},p_{2,r}] = [0.9,0.1]$\n  - $[p_{1,s},p_{2,s}] = [0.1,0.9]$\n  - $k_s = 1$, $G_s = 1$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含从案例1到案例6的测试结果，格式为JSON风格的对列表。每一对对应一个测试用例，必须为 $[B_s,\\delta_s]$ 形式，两个条目都四舍五入到六位小数。整个输出应打印为一行，没有多余的空格，例如：\n- 示例格式：$[[0.800000,-0.200000],[1.200000,0.200000],\\dots]$。\n\n不涉及角度。所有输出都是无单位的小数。不要使用百分号；所有误差都以小数表示。您的程序必须是自包含的，不需要输入，并且只使用指定的库。", "solution": "该问题已经过审阅，并被确定是有效的。这是一个定义明确、有科学依据的练习，旨在模拟转录组学中的一种已知系统误差来源。它基于一个简化但概念上合理的RNA测序确定性模型，为计算提供了清晰的基础。所有必要的参数和定义都已提供，并且没有内部矛盾或歧义。\n\n任务是量化一个朴素的基因水平表达估计量相对于一个理想化的异构体感知估计量的偏倚。我们首先将所提供的模型形式化，以推导出该偏倚的通用表达式。\n\n样本 $s$ 中异构体 $j$ 的期望片段计数由以下公式给出：\n$$ \\mathbb{E}[C_{j,s}] = k_s \\, \\theta_{j,s} \\, L_j $$\n其中 $k_s$ 是特定于样本的测序深度常数，$\\theta_{j,s}$ 是异构体的摩尔浓度，$L_j$ 是其有效长度。基因水平的摩尔丰度为 $G_s = \\sum_{j=1}^{I} \\theta_{j,s}$，异构体分数为 $p_{j,s} = \\theta_{j,s} / G_s$。通过代换，我们得到 $\\theta_{j,s} = G_s \\, p_{j,s}$，这使我们可以将期望计数重新表达为：\n$$ \\mathbb{E}[C_{j,s}] = k_s \\, G_s \\, p_{j,s} \\, L_j $$\n对于此模拟，我们被指示使用 $k_s=1$ 和 $G_s=1$，但为了保持严谨性，我们将继续进行通用推导。\n\n首先，考虑理想化的异构体感知估计量 $\\widehat{G}_{\\mathrm{aware},s}$。该估计量在聚合之前于异构体水平上操作。\n$$ \\widehat{G}_{\\mathrm{aware},s} = \\sum_{j=1}^{I} \\frac{\\mathbb{E}[C_{j,s}]}{k_s \\, L_j} $$\n代入 $\\mathbb{E}[C_{j,s}]$ 的表达式：\n$$ \\widehat{G}_{\\mathrm{aware},s} = \\sum_{j=1}^{I} \\frac{k_s \\, G_s \\, p_{j,s} \\, L_j}{k_s \\, L_j} = \\sum_{j=1}^{I} G_s \\, p_{j,s} = G_s \\sum_{j=1}^{I} p_{j,s} $$\n根据定义，异构体分数之和为一：$\\sum_{j=1}^{I} p_{j,s} = 1$。因此：\n$$ \\widehat{G}_{\\mathrm{aware},s} = G_s $$\n正如预期的那样，在这个确定性模型中，异构体感知估计量是无偏的，并完美地恢复了真实的基因水平丰度 $G_s$。这将作为我们进行比较的基准真相。\n\n接下来，我们分析朴素估计量 $\\widehat{G}_{\\mathrm{naive},s}$。该方法首先在基因水平聚合计数，然后应用一个从参考样本 $r$ 派生出的单一长度校正因子。\n该基因的聚合期望计数为：\n$$ \\mathbb{E}[C_{\\mathrm{gene},s}] = \\sum_{j=1}^{I} \\mathbb{E}[C_{j,s}] = \\sum_{j=1}^{I} k_s \\, G_s \\, p_{j,s} \\, L_j = k_s \\, G_s \\left(\\sum_{j=1}^{I} p_{j,s} \\, L_j\\right) $$\n我们定义给定样本 $s$ 的丰度加权平均异构体长度为 $L_s^{\\mathrm{avg}} = \\sum_{j=1}^{I} p_{j,s} \\, L_j$。则聚合计数为 $\\mathbb{E}[C_{\\mathrm{gene},s}] = k_s \\, G_s \\, L_s^{\\mathrm{avg}}$。\n\n朴素估计量使用一个固定的参考长度 $L_{\\mathrm{ref}}$ 来归一化此计数，该长度是使用来自参考样本 $r$ 的异构体分数计算的平均异构体长度：\n$$ L_{\\mathrm{ref}} = \\sum_{j=1}^{I} p_{j,r} \\, L_j $$\n则估计值为：\n$$ \\widehat{G}_{\\mathrm{naive},s} = \\frac{\\mathbb{E}[C_{\\mathrm{gene},s}]}{k_s \\, L_{\\mathrm{ref}}} = \\frac{k_s \\, G_s \\, L_s^{\\mathrm{avg}}}{k_s \\, L_{\\mathrm{ref}}} = G_s \\frac{L_s^{\\mathrm{avg}}}{L_{\\mathrm{ref}}} $$\n\n乘性偏倚因子 $B_s$ 是朴素估计值与真实丰度（由感知估计量给出）之比：\n$$ B_s = \\frac{\\widehat{G}_{\\mathrm{naive},s}}{\\widehat{G}_{\\mathrm{aware},s}} = \\frac{G_s \\frac{L_s^{\\mathrm{avg}}}{L_{\\mathrm{ref}}}}{G_s} = \\frac{L_s^{\\mathrm{avg}}}{L_{\\mathrm{ref}}} $$\n代入平均长度的完整定义，我们得到了偏倚的最终解析表达式：\n$$ B_s = \\frac{\\sum_{j=1}^{I} p_{j,s} \\, L_j}{\\sum_{j=1}^{I} p_{j,r} \\, L_j} $$\n这个结果巧妙地证明了，乘性偏倚恰好是目标样本中丰度加权平均异构体长度与参考样本中该值之比。当且仅当这两个平均长度不同时，才会引入偏倚。对于一个其异构体具有不同长度的基因，当异构体的相对比例（$p_{j,s}$ 与 $p_{j,r}$）在样本间发生变化时，就会出现这种情况。\n\n相对误差 $\\delta_s$ 定义为 $B_s - 1$：\n$$ \\delta_s = \\frac{\\sum_{j=1}^{I} p_{j,s} \\, L_j}{\\sum_{j=1}^{I} p_{j,r} \\, L_j} - 1 $$\n\n现在，问题简化为对这6个给定的测试用例机械地应用这些推导出的公式。实现将为每个参数集计算这些量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the RNA-seq bias simulation problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (isoform_lengths, reference_fractions, sample_fractions).\n    # k_s and G_s are 1 for all cases as per the problem and cancel out.\n    test_cases = [\n        # Case 1: shift toward shorter isoform\n        {\n            \"L\": np.array([1000.0, 2000.0]),\n            \"p_r\": np.array([0.5, 0.5]),\n            \"p_s\": np.array([0.8, 0.2]),\n        },\n        # Case 2: shift toward longer isoform\n        {\n            \"L\": np.array([1000.0, 2000.0]),\n            \"p_r\": np.array([0.5, 0.5]),\n            \"p_s\": np.array([0.2, 0.8]),\n        },\n        # Case 3: three isoforms, pronounced swap from medium to short\n        {\n            \"L\": np.array([500.0, 1500.0, 3000.0]),\n            \"p_r\": np.array([0.2, 0.7, 0.1]),\n            \"p_s\": np.array([0.7, 0.2, 0.1]),\n        },\n        # Case 4: equal lengths, ratio change should not induce bias\n        {\n            \"L\": np.array([1000.0, 1000.0, 1000.0]),\n            \"p_r\": np.array([0.1, 0.8, 0.1]),\n            \"p_s\": np.array([0.7, 0.2, 0.1]),\n        },\n        # Case 5: identical ratios, no bias expected\n        {\n            \"L\": np.array([750.0, 1800.0, 2400.0]),\n            \"p_r\": np.array([0.3, 0.4, 0.3]),\n            \"p_s\": np.array([0.3, 0.4, 0.3]),\n        },\n        # Case 6: extreme swap toward much longer isoform\n        {\n            \"L\": np.array([500.0, 5000.0]),\n            \"p_r\": np.array([0.9, 0.1]),\n            \"p_s\": np.array([0.1, 0.9]),\n        }\n    ]\n\n    results_as_strings = []\n    for case in test_cases:\n        L = case[\"L\"]\n        p_r = case[\"p_r\"]\n        p_s = case[\"p_s\"]\n\n        # Calculate abundance-weighted average isoform length for reference (L_ref)\n        # and sample (L_s). Using dot product for weighted sum: sum(p_i * L_i)\n        L_ref = np.dot(p_r, L)\n        L_s = np.dot(p_s, L)\n\n        # The multiplicative bias factor B_s is the ratio of average lengths.\n        # This is derived in the solution text.\n        # Handle the case where L_ref is zero to avoid division by zero,\n        # although this is not expected with the given test cases.\n        if L_ref == 0:\n            # If L_ref is 0, this implies all isoforms have 0 length or 0 expression.\n            # If L_s is also 0, bias is undefined but can be treated as 1 (no change).\n            # If L_s is not 0, bias is infinite. This scenario is ill-defined.\n            # For this problem, we assume L_ref  0.\n            B_s = 1.0 if L_s == 0 else np.inf\n        else:\n            B_s = L_s / L_ref\n\n        # The relative error delta_s is B_s - 1.\n        delta_s = B_s - 1.0\n\n        # Format the result pair [B_s, delta_s] as a string with each number\n        # rounded to six decimal places, per the output specification.\n        results_as_strings.append(f\"[{B_s:.6f},{delta_s:.6f}]\")\n\n    # Join the formatted string pairs with commas and enclose in brackets\n    # to create the final JSON-like output string.\n    final_output = f\"[{','.join(results_as_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2494870"}, {"introduction": "现代生物学研究常常需要整合多个组学数据集，以获得对一个生物系统的全面理解。然而，实验中的技术性变异，即“批次效应”，往往会掩盖真实的生物学信号。本练习[@problem_id:2494840]提出了一个真实的多组学实验设计，并要求你推导并应用一种统计方法来消除混杂的批次效应，这对于任何处理大规模生物数据的研究人员来说都是一项必备技能。", "problem": "一个微生物学实验室分析了一个菌株在两种表示为 $A$ 和 $B$ 的条件下的全局转录和蛋白质组响应，通过核糖核酸测序 (RNA-seq) 生成了匹配的转录组学数据，通过液相色谱-串联质谱 (LC-MS/MS) 生成了匹配的蛋白质组学数据。这项研究是多组学的，在不同组学间有一个共享的生物协变量（条件指示变量），但是每种组学的数据采集都是在独立的双批次设计中进行的，其中对于每个组学平台，条件和批次都是完全混淆的。具体来说，转录组学的条件 $A$ 在批次 $2$ 中进行实验，条件 $B$ 在批次 $1$ 中进行；蛋白质组学的条件 $A$ 在批次 $1$ 中进行，条件 $B$ 在批次 $2$ 中进行。为了能够有原则地去除批次效应，同时保留跨组学的生物信号，该实验包含了阴性对照特征（看家实体），这些特征先验已知在两种组学中真实的条件效应都为零。\n\n从一个与分子生物学中心法则（脱氧核糖核酸到核糖核酸到蛋白质）一致的第一性原理统计测量模型，以及一个针对非期望变异的线性高斯公式出发，考虑以下针对组学 $m \\in \\{\\mathrm{T}, \\mathrm{P}\\}$（转录组学或蛋白质组学）和条件 $c \\in \\{A,B\\}$ 中每个特征 $g$ 的生成模型：\n$$\ny_{gmc} \\;=\\; \\mu_{gm} \\;+\\; \\beta_{gm}\\, x_c \\;+\\; \\gamma_{m\\,b(c)} \\;+\\; \\varepsilon_{gmc},\n$$\n其中 $y_{gmc}$ 是观测到的对数丰度，$\\mu_{gm}$ 是组学 $m$ 中特征 $g$ 的基线（条件 $A$）均值，$\\beta_{gm}$ 是组学 $m$ 中特征 $g$ 在条件 $B$ 相对于 $A$ 的真实生物学效应，$x_c$ 是条件指示变量，其中 $x_A = 0$ 且 $x_B = 1$，$\\gamma_{m\\,b(c)}$ 是组学 $m$ 和用于条件 $c$ 的批次的加性批次偏移量，$\\varepsilon_{gmc}$ 是零均值噪声。假设批次效应是加性的（无尺度效应），并且对于每个组学 $m$，批次 $1$ 是参考批次，即 $\\gamma_{m1} = 0$。\n\n阴性对照特征定义为，对于两种组学 $m$ 中的所有对照 $g$，都有 $\\beta_{gm} = 0$。\n\n任务 1 (推导). 从上述模型和对照特征约束出发，当条件和批次如所述完全混淆时，为每个组学平台推导一个用于未知批次偏移量 $\\gamma_{m2}$ 的“去除无用变异”(RUV) 风格的估计量。你的推导必须从模型方程开始，仅使用对照满足 $\\beta_{gm} = 0$ 这一条件，并假设在一个组学平台内，$\\varepsilon_{gmc}$ 是具有相同方差的独立同分布高斯噪声。结果应为一个用可观测量表示的显式估计量 $\\widehat{\\gamma}_{m2}$。\n\n任务 2 (应用与评估). 该研究测量了跨组学共享的 $6$ 个特征：$4$ 个非对照特征 $g \\in \\{\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4}\\}$，其 $\\beta_{gm}$ 未知；以及 $2$ 个对照特征 $g \\in \\{\\mathrm{C1}, \\mathrm{C2}\\}$，其 $\\beta_{gm} = 0$。对于每个特征 $g$，基线均值 $\\mu_{g\\mathrm{T}}$ 和 $\\mu_{g\\mathrm{P}}$ 以及真实生物学效应 $\\beta_{g\\mathrm{T}}$ 和 $\\beta_{g\\mathrm{P}}$ 与以下真实值一致（分析师未知，但在此用于生成观测数据）：对于转录组学，$(\\mu_{g\\mathrm{T}})_{g \\in \\{\\mathrm{G1},\\mathrm{G2},\\mathrm{G3},\\mathrm{G4},\\mathrm{C1},\\mathrm{C2}\\}} = (10, 11, 9, 12, 10, 10)$ 和 $(\\beta_{g\\mathrm{T}})_{g \\in \\{\\mathrm{G1},\\mathrm{G2},\\mathrm{G3},\\mathrm{G4},\\mathrm{C1},\\mathrm{C2}\\}} = (1.0, 0.5, -0.5, 0.2, 0, 0)$；对于蛋白质组学，$(\\mu_{g\\mathrm{P}})_{g \\in \\{\\mathrm{G1},\\mathrm{G2},\\mathrm{G3},\\mathrm{G4},\\mathrm{C1},\\mathrm{C2}\\}} = (8, 9, 7, 10, 8, 8)$ 和 $(\\beta_{g\\mathrm{P}})_{g \\in \\{\\mathrm{G1},\\mathrm{G2},\\mathrm{G3},\\mathrm{G4},\\mathrm{C1},\\mathrm{C2}\\}} = (0.8, 0.3, -0.4, 0.0, 0, 0)$。批次偏移量对于转录组学为 $\\gamma_{\\mathrm{T}1} = 0, \\gamma_{\\mathrm{T}2} = 1$，对于蛋白质组学为 $\\gamma_{\\mathrm{P}1} = 0, \\gamma_{\\mathrm{P}2} = -0.5$。为简单起见，采集过程无噪声，即 $\\varepsilon_{gmc} = 0$。\n\n在上述混淆设计下，观测到的数据向量因此是：\n- 转录组学条件 $A$ (批次 $2$)：$(y_{g\\mathrm{T}A})_{g} = (11, 12, 10, 13, 11, 11)$,\n- 转录组学条件 $B$ (批次 $1$)：$(y_{g\\mathrm{T}B})_{g} = (11, 11.5, 8.5, 12.2, 10, 10)$,\n- 蛋白质组学条件 $A$ (批次 $1$)：$(y_{g\\mathrm{P}A})_{g} = (8, 9, 7, 10, 8, 8)$,\n- 蛋白质组学条件 $B$ (批次 $2$)：$(y_{g\\mathrm{P}B})_{g} = (8.3, 8.8, 6.1, 9.5, 7.5, 7.5)$.\n\n使用你在任务 1 中得到的估计量，从观测到的对照特征 $(\\mathrm{C1}, \\mathrm{C2})$ 估计 $\\widehat{\\gamma}_{\\mathrm{T}2}$ 和 $\\widehat{\\gamma}_{\\mathrm{P}2}$，通过从相应的批次 $2$ 样本中减去估计的批次偏移量，对每个组学的两个样本进行批次校正，然后将校正后的差异 $\\widehat{\\beta}_{gm} = \\tilde{y}_{gmB} - \\tilde{y}_{gmA}$ 作为每个特征的条件效应进行估计。\n\n为了量化校正后跨组学中生物信号的保留程度，请计算跨组学重复相关性，此处定义为对 $4$ 个非对照特征的向量 $(\\widehat{\\beta}_{g\\mathrm{T}})_{g \\in \\{\\mathrm{G1},\\mathrm{G2},\\mathrm{G3},\\mathrm{G4}\\}}$ 和 $(\\widehat{\\beta}_{g\\mathrm{P}})_{g \\in \\{\\mathrm{G1},\\mathrm{G2},\\mathrm{G3},\\mathrm{G4}\\}}$ 之间的皮尔逊相关性。将此相关性报告为单个实数。将你的答案四舍五入到四位有效数字。以小数形式表示答案，不带单位。", "solution": "该问题陈述具有科学依据、提法恰当且内部一致。它呈现了微生物学领域（特别是功能基因组学）中的一个真实场景，在该场景中，批次效应与感兴趣的生物学变量相混淆。使用阴性对照特征来解卷积这些效应是一种有效且成熟的统计策略。所提供的数学模型是一个标准的线性模型，所有数据和约束都被精确指定。因此，该问题是有效的，我们将继续进行求解。\n\n问题分为两部分。任务 1 要求推导批次效应的估计量。任务 2 要求将此估计量应用于所提供的数据，并随后计算一个组学间的相关性度量。\n\n**任务 1：批次效应估计量的推导**\n\n我们从组学平台 $m \\in \\{\\mathrm{T}, \\mathrm{P}\\}$ 中，在条件 $c \\in \\{A, B\\}$ 下，特征 $g$ 的观测对数丰度 $y_{gmc}$ 的生成模型开始：\n$$\ny_{gmc} \\;=\\; \\mu_{gm} \\;+\\; \\beta_{gm}\\, x_c \\;+\\; \\gamma_{m\\,b(c)} \\;+\\; \\varepsilon_{gmc}\n$$\n这里，$\\mu_{gm}$ 是基线均值，$\\beta_{gm}$ 是条件效应，$x_c$ 是一个条件指示变量 ($x_A=0, x_B=1$)，$\\gamma_{m\\,b(c)}$ 是批次效应，$\\varepsilon_{gmc}$ 是一个零均值误差项。参考批次是批次 $1$，所以对所有 $m$ 都有 $\\gamma_{m1} = 0$。\n\n我们必须为每个组学平台推导未知批次偏移量 $\\gamma_{m2}$ 的估计量。该推导必须基于阴性对照特征，对于这些特征，我们先验地知道真实的生物学效应为零，即对于所有对照特征 $g \\in \\mathcal{C}$，都有 $\\beta_{gm} = 0$。\n\n让我们根据实验设计，分别分析每个组学平台。\n\n**转录组学 ($m=\\mathrm{T}$)**\n设计指定条件 $A$ 在批次 $2$ 中进行，条件 $B$ 在批次 $1$ 中进行。\n对于条件 $A$ ($c=A$)，我们有 $x_A=0$，批次为 $b(A)=2$。模型为：\n$$\ny_{g\\mathrm{T}A} = \\mu_{g\\mathrm{T}} + \\beta_{g\\mathrm{T}}(0) + \\gamma_{\\mathrm{T}2} + \\varepsilon_{g\\mathrm{T}A} = \\mu_{g\\mathrm{T}} + \\gamma_{\\mathrm{T}2} + \\varepsilon_{g\\mathrm{T}A}\n$$\n对于条件 $B$ ($c=B$)，我们有 $x_B=1$，批次为 $b(B)=1$。模型为：\n$$\ny_{g\\mathrm{T}B} = \\mu_{g\\mathrm{T}} + \\beta_{g\\mathrm{T}}(1) + \\gamma_{\\mathrm{T}1} + \\varepsilon_{g\\mathrm{T}B} = \\mu_{g\\mathrm{T}} + \\beta_{g\\mathrm{T}} + \\varepsilon_{g\\mathrm{T}B}\n$$\n这里我们使用了 $\\gamma_{\\mathrm{T}1}=0$ 的事实。\n\n现在，我们将注意力限制在阴性对照特征集 $\\mathcal{C}$ 上。对于任何 $g \\in \\mathcal{C}$，我们有 $\\beta_{g\\mathrm{T}}=0$。方程简化为：\n$$\ny_{g\\mathrm{T}A} = \\mu_{g\\mathrm{T}} + \\gamma_{\\mathrm{T}2} + \\varepsilon_{g\\mathrm{T}A} \\quad (g \\in \\mathcal{C})\n$$\n$$\ny_{g\\mathrm{T}B} = \\mu_{g\\mathrm{T}} + \\varepsilon_{g\\mathrm{T}B} \\quad (g \\in \\mathcal{C})\n$$\n对于每个对照特征，我们有一个包含两个未知数 $\\mu_{g\\mathrm{T}}$ 和 $\\gamma_{\\mathrm{T}2}$ 的方程组（将误差项视为随机量）。我们可以消去滋扰参数 $\\mu_{g\\mathrm{T}}$。从第二个方程，我们将 $\\mu_{g\\mathrm{T}}$ 表示为 $\\mu_{g\\mathrm{T}} = y_{g\\mathrm{T}B} - \\varepsilon_{g\\mathrm{T}B}$。将此代入第一个方程得到：\n$$\ny_{g\\mathrm{T}A} = (y_{g\\mathrm{T}B} - \\varepsilon_{g\\mathrm{T}B}) + \\gamma_{\\mathrm{T}2} + \\varepsilon_{g\\mathrm{T}A}\n$$\n对 $\\gamma_{\\mathrm{T}2}$ 进行整理，为每个对照特征提供一个估计：\n$$\ny_{g\\mathrm{T}A} - y_{g\\mathrm{T}B} = \\gamma_{\\mathrm{T}2} + (\\varepsilon_{g\\mathrm{T}A} - \\varepsilon_{g\\mathrm{T}B})\n$$\n设 $N_c = |\\mathcal{C}|$ 为对照特征的数量。我们有 $N_c$ 个这样的关系。假设误差 $\\varepsilon_{gmc}$ 是独立同分布 (i.i.d.) 的高斯随机变量，那么单个参数 $\\gamma_{\\mathrm{T}2}$ 的最优（最大似然，最佳线性无偏）估计量是所有对照特征的平均值：\n$$\n\\widehat{\\gamma}_{\\mathrm{T}2} = \\frac{1}{N_c} \\sum_{g \\in \\mathcal{C}} (y_{g\\mathrm{T}A} - y_{g\\mathrm{T}B})\n$$\n\n**蛋白质组学 ($m=\\mathrm{P}$)**\n蛋白质组学的设计是相反的：条件 $A$ 在批次 $1$ 中进行，条件 $B$ 在批次 $2$ 中进行。\n对于条件 $A$ ($c=A$)，$x_A=0$，批次为 $b(A)=1$：\n$$\ny_{g\\mathrm{P}A} = \\mu_{g\\mathrm{P}} + \\beta_{g\\mathrm{P}}(0) + \\gamma_{\\mathrm{P}1} + \\varepsilon_{g\\mathrm{P}A} = \\mu_{g\\mathrm{P}} + \\varepsilon_{g\\mathrm{P}A}\n$$\n对于条件 $B$ ($c=B$)，$x_B=1$，批次为 $b(B)=2$：\n$$\ny_{g\\mathrm{P}B} = \\mu_{g\\mathrm{P}} + \\beta_{g\\mathrm{P}}(1) + \\gamma_{\\mathrm{P}2} + \\varepsilon_{g\\mathrm{P}B} = \\mu_{g\\mathrm{P}} + \\beta_{g\\mathrm{P}} + \\gamma_{\\mathrm{P}2} + \\varepsilon_{g\\mathrm{P}B}\n$$\n对于对照特征 $g \\in \\mathcal{C}$，我们有 $\\beta_{g\\mathrm{P}}=0$：\n$$\ny_{g\\mathrm{P}A} = \\mu_{g\\mathrm{P}} + \\varepsilon_{g\\mathrm{P}A} \\quad (g \\in \\mathcal{C})\n$$\n$$\ny_{g\\mathrm{P}B} = \\mu_{g\\mathrm{P}} + \\gamma_{\\mathrm{P}2} + \\varepsilon_{g\\mathrm{P}B} \\quad (g \\in \\mathcal{C})\n$$\n同样，我们通过将第一个方程中的 $\\mu_{g\\mathrm{P}} = y_{g\\mathrm{P}A} - \\varepsilon_{g\\mathrm{P}A}$ 代入第二个方程来消去 $\\mu_{g\\mathrm{P}}$：\n$$\ny_{g\\mathrm{P}B} = (y_{g\\mathrm{P}A} - \\varepsilon_{g\\mathrm{P}A}) + \\gamma_{\\mathrm{P}2} + \\varepsilon_{g\\mathrm{P}B}\n$$\n整理后得到：\n$$\ny_{g\\mathrm{P}B} - y_{g\\mathrm{P}A} = \\gamma_{\\mathrm{P}2} + (\\varepsilon_{g\\mathrm{P}B} - \\varepsilon_{g\\mathrm{P}A})\n$$\n对所有 $N_c$ 个对照特征求平均值，得到 $\\gamma_{\\mathrm{P}2}$ 的估计量：\n$$\n\\widehat{\\gamma}_{\\mathrm{P}2} = \\frac{1}{N_c} \\sum_{g \\in \\mathcal{C}} (y_{g\\mathrm{P}B} - y_{g\\mathrm{P}A})\n$$\n这些推导出的估计量完成了任务 1。\n\n**任务 2：应用与评估**\n\n我们现在应用这些结果。对照特征是 $\\mathcal{C} = \\{\\mathrm{C1}, \\mathrm{C2}\\}$，所以 $N_c=2$。问题陈述 $\\varepsilon_{gmc}=0$。\n\n**1. 估计批次偏移量**\n对于转录组学，对照特征的观测数据是 $y_{\\mathrm{C1,T,A}} = 11$, $y_{\\mathrm{C2,T,A}} = 11$ 和 $y_{\\mathrm{C1,T,B}} = 10$, $y_{\\mathrm{C2,T,B}} = 10$。\n$$\n\\widehat{\\gamma}_{\\mathrm{T}2} = \\frac{1}{2} \\left[ (y_{\\mathrm{C1,T,A}} - y_{\\mathrm{C1,T,B}}) + (y_{\\mathrm{C2,T,A}} - y_{\\mathrm{C2,T,B}}) \\right] = \\frac{1}{2} \\left[ (11 - 10) + (11 - 10) \\right] = \\frac{1}{2}(1+1) = 1\n$$\n对于蛋白质组学，对照数据是 $y_{\\mathrm{C1,P,A}} = 8$, $y_{\\mathrm{C2,P,A}} = 8$ 和 $y_{\\mathrm{C1,P,B}} = 7.5$, $y_{\\mathrm{C2,P,B}} = 7.5$。\n$$\n\\widehat{\\gamma}_{\\mathrm{P}2} = \\frac{1}{2} \\left[ (y_{\\mathrm{C1,P,B}} - y_{\\mathrm{C1,P,A}}) + (y_{\\mathrm{C2,P,B}} - y_{\\mathrm{C2,P,A}}) \\right] = \\frac{1}{2} \\left[ (7.5 - 8) + (7.5 - 8) \\right] = \\frac{1}{2}(-0.5 - 0.5) = -0.5\n$$\n这些估计值与问题描述中提供的真实值完全匹配，这是预料之中的，因为数据是无噪声的。\n\n**2. 执行批次校正**\n我们通过从在批次 $2$ 中运行的样本中减去估计的批次偏移量来校正数据。让 $\\tilde{y}$ 表示校正后的值。\n对于转录组学，条件 $A$ 在批次 $2$ 中。\n$\\tilde{y}_{g\\mathrm{T}A} = y_{g\\mathrm{T}A} - \\widehat{\\gamma}_{\\mathrm{T}2}$。条件 $B$ 在批次 $1$ (参考批次)，所以 $\\tilde{y}_{g\\mathrm{T}B} = y_{g\\mathrm{T}B}$。\n原始数据向量：$\\mathbf{y}_{\\mathrm{T}A} = (11, 12, 10, 13, 11, 11)$ 和 $\\mathbf{y}_{\\mathrm{T}B} = (11, 11.5, 8.5, 12.2, 10, 10)$。\n校正后的向量：\n$\\tilde{\\mathbf{y}}_{\\mathrm{T}A} = (11-1, 12-1, 10-1, 13-1, 11-1, 11-1) = (10, 11, 9, 12, 10, 10)$。\n$\\tilde{\\mathbf{y}}_{\\mathrm{T}B} = \\mathbf{y}_{\\mathrm{T}B} = (11, 11.5, 8.5, 12.2, 10, 10)$。\n\n对于蛋白质组学，条件 $B$ 在批次 $2$ 中。\n$\\tilde{y}_{g\\mathrm{P}B} = y_{g\\mathrm{P}B} - \\widehat{\\gamma}_{\\mathrm{P}2}$。条件 $A$ 在批次 $1$ 中，所以 $\\tilde{y}_{g\\mathrm{P}A} = y_{g\\mathrm{P}A}$。\n原始数据向量：$\\mathbf{y}_{\\mathrm{P}A} = (8, 9, 7, 10, 8, 8)$ 和 $\\mathbf{y}_{\\mathrm{P}B} = (8.3, 8.8, 6.1, 9.5, 7.5, 7.5)$。\n校正后的向量：\n$\\tilde{\\mathbf{y}}_{\\mathrm{P}A} = \\mathbf{y}_{\\mathrm{P}A} = (8, 9, 7, 10, 8, 8)$。\n$\\tilde{\\mathbf{y}}_{\\mathrm{P}B} = (8.3 - (-0.5), 8.8 - (-0.5), 6.1 - (-0.5), 9.5 - (-0.5), 7.5 - (-0.5), 7.5 - (-0.5)) = (8.8, 9.3, 6.6, 10, 8, 8)$。\n\n**3. 估计条件效应**\n条件效应估计为 $\\widehat{\\beta}_{gm} = \\tilde{y}_{gmB} - \\tilde{y}_{gmA}$。\n$\\widehat{\\boldsymbol{\\beta}}_{\\mathrm{T}} = \\tilde{\\mathbf{y}}_{\\mathrm{T}B} - \\tilde{\\mathbf{y}}_{\\mathrm{T}A} = (11-10, 11.5-11, 8.5-9, 12.2-12, 10-10, 10-10) = (1, 0.5, -0.5, 0.2, 0, 0)$。\n$\\widehat{\\boldsymbol{\\beta}}_{\\mathrm{P}} = \\tilde{\\mathbf{y}}_{\\mathrm{P}B} - \\tilde{\\mathbf{y}}_{\\mathrm{P}A} = (8.8-8, 9.3-9, 6.6-7, 10-10, 8-8, 8-8) = (0.8, 0.3, -0.4, 0, 0, 0)$。\n\n**4. 计算跨组学相关性**\n我们计算 $4$ 个非对照特征 $\\{\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4}\\}$ 的估计效应的皮尔逊相关性。设这些效应的向量为 $B_T$ 和 $B_P$。\n$B_\\mathrm{T} = (1, 0.5, -0.5, 0.2)$\n$B_\\mathrm{P} = (0.8, 0.3, -0.4, 0.0)$\n对于长度为 $n$ 的两个向量 $X$ 和 $Y$，皮尔逊相关系数 $r$ 由 $r = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^n (x_i - \\bar{x})^2} \\sqrt{\\sum_{i=1}^n (y_i - \\bar{y})^2}}$ 给出。\n这里 $n=4$。首先，我们计算均值：\n$\\bar{B}_\\mathrm{T} = \\frac{1 + 0.5 - 0.5 + 0.2}{4} = \\frac{1.2}{4} = 0.3$。\n$\\bar{B}_\\mathrm{P} = \\frac{0.8 + 0.3 - 0.4 + 0.0}{4} = \\frac{0.7}{4} = 0.175$。\n\n接下来，我们计算分子 (协方差项)：\n$\\sum(B_{g\\mathrm{T}} - \\bar{B}_\\mathrm{T})(B_{g\\mathrm{P}} - \\bar{B}_\\mathrm{P}) = (1-0.3)(0.8-0.175) + (0.5-0.3)(0.3-0.175) + (-0.5-0.3)(-0.4-0.175) + (0.2-0.3)(0.0-0.175)$\n$= (0.7)(0.625) + (0.2)(0.125) + (-0.8)(-0.575) + (-0.1)(-0.175)$\n$= 0.4375 + 0.025 + 0.46 + 0.0175 = 0.94$。\n\n然后，我们计算分母项 (与标准差相关)：\n$\\sum(B_{g\\mathrm{T}} - \\bar{B}_\\mathrm{T})^2 = (0.7)^2 + (0.2)^2 + (-0.8)^2 + (-0.1)^2 = 0.49 + 0.04 + 0.64 + 0.01 = 1.18$。\n$\\sum(B_{g\\mathrm{P}} - \\bar{B}_\\mathrm{P})^2 = (0.625)^2 + (0.125)^2 + (-0.575)^2 + (-0.175)^2 = 0.390625 + 0.015625 + 0.330625 + 0.030625 = 0.7675$。\n\n最后，我们计算相关系数：\n$r = \\frac{0.94}{\\sqrt{1.18} \\sqrt{0.7675}} = \\frac{0.94}{\\sqrt{1.18 \\times 0.7675}} = \\frac{0.94}{\\sqrt{0.90565}} \\approx \\frac{0.94}{0.9516564} \\approx 0.987751$。\n四舍五入到四位有效数字，结果是 $0.9878$。", "answer": "$$\n\\boxed{0.9878}\n$$", "id": "2494840"}]}