{"hands_on_practices": [{"introduction": "原生动物的抗原变异通常由复杂的表观遗传机制控制，这使得寄生虫能够系统性地改变其表面抗原，从而逃避宿主的免疫系统。本练习旨在挑战您像实验生物学家一样思考，通过解读模拟的组学数据（ChIP-seq 和 RNA-seq），来破译基因转换背后的分子逻辑。通过分析组蛋白修饰与转录输出之间的关系，您将能够推断出在特定实验扰动下抗原转换的方向。[@problem_id:2525997]", "problem": "一种经历抗原变异的单细胞真核寄生虫在同一时间仅从一个血流感染期表达位点 (BES) 表达单一的变异表面糖蛋白 (VSG)。在未经处理的细胞中，染色质免疫沉淀测序 (ChIP-seq) 揭示了组蛋白标记在所有BESs上的一种固定分布模式：活跃的BES在启动子近端富集组蛋白H3赖氨酸4三甲基化 ($\\mathrm{H3K4me3}$)，而沉默的BESs在端粒近端富集组蛋白H3赖氨酸9三甲基化 ($\\mathrm{H3K9me3}$)。然后，用一种选择性组蛋白甲基转移酶抑制剂处理细胞 $24$ 小时，该抑制剂能阻断 $\\mathrm{H3K9me3}$ 的沉积，但不会直接影响负责写入 $\\mathrm{H3K4me3}$ 的酶。你获得了三个BESs的新的ChIP-seq和信使核糖核酸 (mRNA) 测序 (RNA-seq) 数据：BES$_A$（初始活跃），BES$_B$（初始沉默），和 BES$_C$（初始沉默）。测量结果定性总结如下：\n\n- BES$_A$：启动子处的 $\\mathrm{H3K4me3}$ 减少约 $60\\%$，端粒区域的 $\\mathrm{H3K9me3}$ 保持低水平，VSG$_A$ mRNA 减少约 $70\\%$。\n- BES$_B$：端粒区域的 $\\mathrm{H3K9me3}$ 减少约 $80\\%$，启动子处的 $\\mathrm{H3K4me3}$ 增加约 $3$ 倍，VSG$_B$ mRNA 增加约 $10$ 倍。\n- BES$_C$：$\\mathrm{H3K9me3}$ 轻微减少约 $20\\%$，$\\mathrm{H3K4me3}$ 无显著变化，VSG$_C$ mRNA 保持在背景水平附近。\n\n假设以下基本事实：(i) 根据中心法则，启动子近端的激活性染色质标记增加与转录和mRNA水平增加相关，而抑制性染色质标记与转录沉默相关；(ii) $\\mathrm{H3K9me3}$ 是一种与基因沉默相关的异染色质标记，由组蛋白甲基转移酶维持，而 $\\mathrm{H3K4me3}$ 是一种与转录起始相关的常染色质标记；(iii) 在抗原变异过程中强制执行单等位基因表达，因此在一个BES的持续激活通常伴随着在任何短暂的多等位基因阶段后其他BES的沉默。\n\n根据这些数据和原则，哪个选项最能推断出抑制剂处理后VSG转换的方向？\n\nA. 向 BES$_B$ 转换（从 BES$_A$ 到 BES$_B$），这与 BES$_B$ 的去抑制和激活以及 BES$_A$ 的减弱相一致。\n\nB. 向 BES$_C$ 转换（从 BES$_A$ 到 BES$_C$），因为两个沉默的BES都失去了 $\\mathrm{H3K9me3}$。\n\nC. 没有发生方向性转换；尽管存在短暂变化，BES$_A$ 仍然是主要的活跃位点。\n\nD. 在全局性 $\\mathrm{H3K9me3}$ 缺失的情况下，最可能的结果是 BES$_A$、BES$_B$ 和 BES$_C$ 同时稳定激活。", "solution": "在进行解答之前，首先对问题陈述进行验证。\n\n**步骤 1：提取已知信息**\n-   **系统：** 一种单细胞真核寄生虫，通过从血流感染期表达位点 (BESs) 表达变异表面糖蛋白 (VSGs) 来实现抗原变异。\n-   **表达规则：** 在同一时间仅从一个BES进行单等位基因表达，表达单一的VSG。\n-   **初始染色质状态（未经处理）：**\n    -   活跃的BES：在启动子近端富集 $\\mathrm{H3K4me3}$。\n    -   沉默的BESs：在端粒近端富集 $\\mathrm{H3K9me3}$。\n-   **扰动：** 用一种选择性组蛋白甲基转移酶抑制剂处理 $24$ 小时，该抑制剂阻断 $\\mathrm{H3K9me3}$ 的沉积，但对沉积 $\\mathrm{H3K4me3}$ 的酶没有直接影响。\n-   **处理后实验数据：**\n    -   **BES$_A$（初始活跃）：**\n        -   启动子处的 $\\mathrm{H3K4me3}$ 减少约 $60\\%$。\n        -   端粒区域的 $\\mathrm{H3K9me3}$ 保持低水平。\n        -   VSG$_A$ mRNA 减少约 $70\\%$。\n    -   **BES$_B$（初始沉默）：**\n        -   端粒区域的 $\\mathrm{H3K9me3}$ 减少约 $80\\%$。\n        -   启动子处的 $\\mathrm{H3K4me3}$ 增加约 $3$ 倍。\n        -   VSG$_B$ mRNA 增加约 $10$ 倍。\n    -   **BES$_C$（初始沉默）：**\n        -   端粒区域的 $\\mathrm{H3K9me3}$ 减少约 $20\\%$。\n        -   启动子处的 $\\mathrm{H3K4me3}$ 无显著变化。\n        -   VSG$_C$ mRNA 保持在背景水平附近。\n-   **假设原则：**\n    -   (i) 激活性染色质标记 ($\\mathrm{H3K4me3}$) 与转录相关；抑制性标记 ($\\mathrm{H3K9me3}$) 与沉默相关。\n    -   (ii) $\\mathrm{H3K9me3}$ 是一种异染色质沉默标记；$\\mathrm{H3K4me3}$ 是一种常染色质激活标记。\n    -   (iii) 强制执行单等位基因表达，意味着一个BES的激活与其他BES的沉默相耦合。\n\n**步骤 2：使用提取的已知信息进行验证**\n该问题具有科学依据，描述了研究寄生虫（如布氏锥虫 *Trypanosoma brucei*）表观遗传调控和抗原变异的标准实验范式。$\\mathrm{H3K4me3}$ 和 $\\mathrm{H3K9me3}$ 作为相互拮抗的组蛋白标记，是分子生物学的基本概念。使用选择性抑制剂来探究基因功能是一种有效的实验设计。该问题提问清晰，提供了明确的初始状态、确定的扰动和定量的结果。语言客观、精确。前提不包含科学错误、矛盾或歧义。这是一个基于实验数据和既定生物学原理进行逻辑推断的有效测试。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将推导解答。\n\n**解答推导**\n问题要求根据使用 $\\mathrm{H3K9me3}$ 抑制剂处理后组蛋白标记和 mRNA 水平的变化，推断 VSG 转换的方向。我们分析每个 BES 在 $24$ 小时处理后的状态。\n\n1.  **分析 BES$_A$（初始活跃）：**\n    数据显示，启动子处的激活标记 $\\mathrm{H3K4me3}$ 减少了约 $60\\%$，相应的 VSG$_A$ mRNA 减少了约 $70\\%$。根据原则 (i) 和 (ii)，激活标记的丧失会导致转录减少。这表明 BES$_A$ 正在被沉默或其表达被显著减弱。\n\n2.  **分析 BES$_B$（初始沉默）：**\n    处理所用的是沉积 $\\mathrm{H3K9me3}$ 的酶的抑制剂。在 BES$_B$ 处观察到该抑制性标记减少了约 $80\\%$，这是预期的直接效应。这种沉默信号的移除之后，激活标记 $\\mathrm{H3K4me3}$ 增加了约 $3$ 倍，VSG$_B$ mRNA 剧增了约 $10$ 倍。这一系列事件——抑制性标记的丧失、激活性标记的获得以及转录的大幅增加——是基因激活的明确标志。BES$_B$ 正在从沉默状态转换为活跃状态。\n\n3.  **分析 BES$_C$（初始沉默）：**\n    尽管与 BES$_B$ 一样初始是沉默的，但 BES$_C$ 的反应不同。其抑制性标记 $\\mathrm{H3K9me3}$ 仅轻微减少（约 $20\\%$），并且关键的是，随后并没有获得激活标记 $\\mathrm{H3K4me3}$ 或 VSG$_C$ mRNA 的增加，后者仍保持在背景水平。这表明 BES$_C$ 并未被激活，仍处于沉默状态。实验数据显示，不同的沉默位点反应不同，但 BES$_C$ 的结果是明确的：它没有被开启。\n\n4.  **综合分析：**\n    寄生虫的基因表达程序正在发生转变。初始活跃的位点 BES$_A$ 正在被沉默。同时，初始沉默的位点之一 BES$_B$ 正在被强烈激活。另一个沉默位点 BES$_C$ 保持沉默。这种旧的活跃基因被沉默而新的基因被激活的协同过程，正是抗原转换的定义。这种转换的方向是从 BES$_A$ 到 BES$_B$。这一观察结果也与原则 (iii) 相符，该原则指出一个 BES 的激活与其他 BES 的沉默相耦合，以维持单等位基因表达。\n\n**选项评估**\n\n**A. 向 BES$_B$ 转换（从 BES$_A$ 到 BES$_B$），这与 BES$_B$ 的去抑制和激活以及 BES$_A$ 的减弱相一致。**\n该陈述准确地总结了我们的分析。数据显示 BES$_B$ 的去抑制（$\\mathrm{H3K9me3}$ 的丧失）导致其激活（$\\mathrm{H3K4me3}$ 和 mRNA 的获得）。这与 BES$_A$ 的减弱（$\\mathrm{H3K4me3}$ 和 mRNA 的丧失）相耦合。这描述了一个从 BES$_A$ 到 BES$_B$ 的转换事件。\n**结论：正确。**\n\n**B. 向 BES$_C$ 转换（从 BES$_A$ 到 BES$_C$），因为两个沉默的BES都失去了 $\\mathrm{H3K9me3}$。**\n该陈述是错误的。主要原因是 BES$_C$ 的数据显示它仍然处于转录沉默状态，$\\mathrm{H3K4me3}$ 或 mRNA 没有增加。因此，没有发生向 BES$_C$ 的转换。其前提“因为两个沉默的BES都失去了 $\\mathrm{H3K9me3}$”是一种误导性的过度简化，因为在 BES$_C$ 的情况下，失去的幅度截然不同，且并未导致激活。\n**结论：错误。**\n\n**C. 没有发生方向性转换；尽管存在短暂变化，BES$_A$ 仍然是主要的活跃位点。**\n该陈述与数据不符。VSG$_A$ mRNA 下降约 $70\\%$，同时 VSG$_B$ mRNA 上升约 $10$ 倍，这代表了转录景观的巨大转变，而非“短暂变化”。在 $24$ 小时后，BES$_B$ 很有可能已经成为或正在成为主要的活跃位点。证据强烈指向一个正在进行中的方向性转换。\n**结论：错误。**\n\n**D. 在全局性 $\\mathrm{H3K9me3}$ 缺失的情况下，最可能的结果是 BES$_A$、BES$_B$ 和 BES$_C$ 同时稳定激活。**\n该陈述与实验数据和所给原则均相矛盾。数据显示 BES$_A$ 正在被失活，而 BES$_C$ 保持失活状态；因此，并未发生同时激活。此外，原则 (iii) 假定系统强制执行单等位基因表达，使得多个BES同时稳定激活成为一个不太可能的结果。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2525997"}, {"introduction": "一旦新的抗原变体被表达，它就面临着与宿主适应性免疫系统的动态博弈。本练习将指导您将这些复杂的生物学相互作用——寄生虫复制、抗体产生、免疫清除和抗原转换——转化为一个常微分方程（ODE）系统。通过构建这种类似“捕食者-猎物”的动态模型，您可以分析该系统是如何通过抗原循环来维持慢性感染的，并探索其稳态特性。[@problem_id:2526037]", "problem": "一种经历抗原变异的原生动物寄生虫在任何时候都表达两种抗原变体中的一种，标记为 $i \\in \\{1,2\\}$。令 $V_i(t)$ 表示在时间 $t$ 表达变体 $i$ 的寄生虫密度，令 $A_i(t)$ 表示在时间 $t$ 针对变体 $i$ 的变体特异性抗体浓度。假设以下经过充分检验的原则和定义构成建模基础：(i) 抗体和寄生虫之间的质量作用结合导致清除，其速率与它们的浓度之积成正比，(ii) 抗体产生受抗原负荷的刺激并与之成正比，以及 (iii) 寄生虫和抗体都经历一阶净生长或衰变过程。此外，假设存在抗原转换：每个表达变体 $i$ 的寄生虫可以以个体平均速率 $s$ 转换到另一种变体 $j \\neq i$，这反映了另一种变体表面糖蛋白基因的随机激活。\n\n仅使用这些基础，推导一个关于 $V_i(t)$ 和 $A_i(t)$ 的常微分方程（ODEs）系统，该系统能捕捉以下过程：\n- 个体平均速率为 $r$ 的寄生虫净复制和个体平均速率为 $d$ 的寄生虫内源性（非免疫）损失，\n- 质量作用速率常数为 $k$ 的抗体介导的变体 $i$ 清除，\n- 与 $V_i$ 成正比、速率为 $p$ 的抗体刺激以及速率为 $c$ 的抗体衰变，\n- 个体平均速率为 $s$ 的变体间对称双向转换。\n\n明确指出您所推导的常微分方程中每一项所对应的生物学过程。然后，列出模拟该模型中抗原转换所需的最小参数集，并说明每个参数的生物学意义。\n\n最后，假设参数是变体对称的，并且存在一个正的对称稳态，其中 $V_1^{*} = V_2^{*}$ 且 $A_1^{*} = A_2^{*}$。在此对称性下，计算总稳态寄生虫密度 $V_{\\mathrm{tot}}^{*} = V_1^{*} + V_2^{*}$，将其表示为关于参数 $r$、$d$、$k$、$p$ 和 $c$ 的闭式解析表达式（您可以假设 $r > d$ 以确保存在非平凡稳态）。请以单个解析表达式的形式提供您的最终答案；無需进行数值四舍五入，也无需在最终表达式中包含单位。", "solution": "问题陈述已提交以供验证。\n\n**步骤 1：提取已知条件**\n- 系统有 $2$ 种抗原变体，$i \\in \\{1,2\\}$。\n- $V_i(t)$：变体 $i$ 的寄生虫密度。\n- $A_i(t)$：针对变体 $i$ 的抗体浓度。\n- (i) 清除：质量作用，速率与浓度之积成正比。\n- (ii) 抗体产生：与抗原负荷成正比。\n- (iii) 生长/衰变：一阶过程。\n- 转换：寄生虫 $i$ 以个体平均速率 $s$ 转换到 $j \\neq i$。\n- $r$：寄生虫净复制的个体平均速率。\n- $d$：寄生虫内源性损失的个体平均速率。\n- $k$：抗体介导清除的质量作用速率常数。\n- $p$：抗体刺激速率。\n- $c$：抗体衰变速率。\n- $s$：对称双向转换速率。\n- 假设：参数是变体对称的。\n- 假设：存在一个正的对称稳态，其中 $V_1^{*} = V_2^{*}$ 且 $A_1^{*} = A_2^{*}$。\n- 条件：$r > d$。\n- 目标：推导常微分方程系统，确定参数，并计算总稳态寄生虫密度 $V_{\\mathrm{tot}}^{*} = V_1^{*} + V_2^{*}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n对问题进行批判性分析。\n- **科学依据**：该问题描述了一个用于宿主-病原体动力学的标准房室模型，特别关注抗原变异。清除的质量作用动力学、一阶衰变和比例刺激原则是数学免疫学和流行病学中的基石性假设。这些不是推测性的，而是用于构建复杂生物系统的可解模型的成熟方法。该问题牢固地植根于理论生物学这一科学学科。\n- **适定性**：任务是根据一组明确陈述的过程描述构建一个常微分方程（ODEs）系统，然后在简化的对称性假设下求解一个特定的穩态属性。这是应用数学中一个标准的、适定的问题。假设存在正穩态绕过了分岔分析的潜在复杂性，使得所要求的计算是确定性的。\n- **客观性**：语言精确、量化，没有主观或含糊的术语。所有参数和变量都得到了明确定义。\n\n该问题没有表现出验证标准中列出的任何缺陷。它并非科学上不健全、不可形式化、不完整、不现实、不适定或微不足道。这是一个有效且严谨的数学建模练习。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供完整的解答。\n\n**常微分方程系统的推导**\n\n我们为变量 $V_1(t)$、$V_2(t)$、$A_1(t)$ 和 $A_2(t)$ 构建一个包含四个耦合常微分方程的系统。每个变量的变化率是所有产生或移除该变量的过程的速率之和。\n\n对于变体 1 的寄生虫种群 $V_1$：\n$\\frac{dV_1}{dt}$ 的方程为：\n$$ \\frac{dV_1}{dt} = \\underbrace{rV_1}_{\\text{复制}} - \\underbrace{dV_1}_{\\text{内源性损失}} - \\underbrace{k V_1 A_1}_{\\text{免疫清除}} - \\underbrace{sV_1}_{\\text{转换为 2}} + \\underbrace{sV_2}_{\\text{从 2 转换而来}} $$\n简化为：\n$$ \\frac{dV_1}{dt} = (r-d)V_1 - k V_1 A_1 + s(V_2 - V_1) $$\n\n对于变体 2 的寄生虫种群 $V_2$：\n根据对称性，其动力学是类似的。$\\frac{dV_2}{dt}$ 的方程为：\n$$ \\frac{dV_2}{dt} = \\underbrace{rV_2}_{\\text{复制}} - \\underbrace{dV_2}_{\\text{内源性损失}} - \\underbrace{k V_2 A_2}_{\\text{免疫清除}} - \\underbrace{sV_2}_{\\text{转换为 1}} + \\underbrace{sV_1}_{\\text{从 1 转换而来}} $$\n简化为：\n$$ \\frac{dV_2}{dt} = (r-d)V_2 - k V_2 A_2 + s(V_1 - V_2) $$\n\n对于针对变体 1 的抗体浓度 $A_1$：\n其动力学由其特異性抗原 $V_1$ 的刺激和一阶衰变所决定。$\\frac{dA_1}{dt}$ 的方程为：\n$$ \\frac{dA_1}{dt} = \\underbrace{p V_1}_{\\text{抗原刺激}} - \\underbrace{c A_1}_{\\text{衰变/清除}} $$\n\n对于针对变体 2 的抗体浓度 $A_2$：\n根据对称性，$\\frac{dA_2}{dt}$ 的方程为：\n$$ \\frac{dA_2}{dt} = \\underbrace{p V_2}_{\\text{抗原刺激}} - \\underbrace{c A_2}_{\\text{衰变/清除}} $$\n\n至此完成了常微分方程系统的推导。\n\n**模型参数**\n\n定义和模拟该模型中抗原转换动力学所需的最小参数集是所有指定常数的集合。它们的生物学意义是：\n- $r$：寄生虫种群的个体平均增长率，为其复制机制所固有。单位：时间$^{-1}$。\n- $d$：非免疫性寄生虫死亡或清除的个体平均速率。单位：时间$^{-1}$。在没有免疫的情况下，净增长由 $r-d$ 给出。\n- $k$：量化抗体介导的寄生虫清除功效的质量作用速率常数。单位：（浓度 $\\times$ 时间）$^{-1}$。\n- $p$：抗体产生刺激的速率常数，将抗原量与免疫应答速率联系起来。单位：浓度 $\\times$ 密度$^{-1}$ $\\times$ 时间$^{-1}$。\n- $c$：抗体的个体平均衰变或清除速率，代表其有限的寿命。单位：时间$^{-1}$。\n- $s$：寄生虫随机地将其抗原表面外衣从一种变体转换为另一种的个体平均速率。单位：时间$^{-1}$。\n\n**总稳态寄生虫密度的计算**\n\n我们必须找到系统的稳态，用上标 $*$ 表示。在稳态下，所有时间导数都为零：\n$$\n\\begin{align*}\n(1) \\quad 0 = (r-d)V_1^{*} - k V_1^{*} A_1^{*} + s(V_2^{*} - V_1^{*}) \\\\\n(2) \\quad 0 = (r-d)V_2^{*} - k V_2^{*} A_2^{*} + s(V_1^{*} - V_2^{*}) \\\\\n(3) \\quad 0 = pV_1^{*} - cA_1^{*} \\\\\n(4) \\quad 0 = pV_2^{*} - cA_2^{*}\n\\end{align*}\n$$\n问题指定了一个对称稳态，其中 $V_1^{*} = V_2^{*}$ 且 $A_1^{*} = A_2^{*}$。我们分别用 $V^{*}$ 和 $A^{*}$ 表示这些共同的稳态值。\n\n将 $V_1^{*} = V_2^{*} = V^{*}$ 和 $A_1^{*} = A_2^{*} = A^{*}$ 代入方程组，我们观察到方程 $(1)$ 和 $(2)$ 变得相同，方程 $(3)$ 和 $(4)$ 也变得相同。我们继续处理方程 $(1)$ 和 $(3)$。\n\n根据方程 $(1)$：\n$$ 0 = (r-d)V^{*} - k V^{*} A^{*} + s(V^{*} - V^{*}) $$\n转换项抵消了，$s(V^{*} - V^{*}) = 0$。这是对称性假设的一个关键结果：在这个特定的稳态下，从变体 1 转换到变体 2 的寄生虫通量与从 2 转换到 1 的通量完全平衡。方程简化为：\n$$ 0 = (r-d)V^{*} - k V^{*} A^{*} $$\n这可以因式分解为：\n$$ V^{*} (r - d - k A^{*}) = 0 $$\n问题要求的是正稳态，这意味着 $V^{*}  0$。因此，我们可以除以 $V^{*}$ 得到：\n$$ r - d - k A^{*} = 0 $$\n求解稳态抗体浓度 $A^{*}$ 得到：\n$$ A^{*} = \\frac{r-d}{k} $$\n\n现在，我们使用方程 $(3)$：\n$$ 0 = pV^{*} - cA^{*} $$\n这给出了稳态寄生虫密度和抗体浓度之间的直接关系：\n$$ A^{*} = \\frac{p}{c}V^{*} $$\n\n我们现在有两个关于 $A^{*}$ 的表达式。将它们相等可以让我们求解 $V^{*}$：\n$$ \\frac{r-d}{k} = \\frac{p}{c}V^{*} $$\n求解 $V^{*}$：\n$$ V^{*} = \\frac{c(r-d)}{pk} $$\n这个表达式代表了单个寄生虫变体（$V_1^{*}$ 或 $V_2^{*}$）的稳态密度。问题要求的是总稳态寄生虫密度，$V_{\\mathrm{tot}}^{*} = V_1^{*} + V_2^{*}$。\n\n考虑到对称性 $V_1^{*} = V_2^{*} = V^{*}$，总密度为：\n$$ V_{\\mathrm{tot}}^{*} = V^{*} + V^{*} = 2V^{*} $$\n代入 $V^{*}$ 的表达式得到最终结果：\n$$ V_{\\mathrm{tot}}^{*} = 2 \\left( \\frac{c(r-d)}{pk} \\right) = \\frac{2c(r-d)}{pk} $$\n条件 $rd$ 确保了分子为正。所有其他参数（$k, p, c$）都是速率常数，并且本质上是正的，所以 $V_{\\mathrmmagnificent}^{*}$ 是正的，这与问题的假设一致。转换速率 $s$ 没有出现在对称稳态的最终表达式中，因为它的效应被平衡的种群通量所抵消。", "answer": "$$\n\\boxed{\\frac{2c(r-d)}{pk}}\n$$", "id": "2526037"}, {"introduction": "抗原变异的最终影响体现在其如何塑造病原体在整个宿主群体中的传播和持久性。这项练习将引导您从解析建模转向计算模拟，要求您实现一个包含不对称交叉免疫的多株流行病学模型。您的目标是探索交叉免疫等因素如何导致复杂的群体动力学行为，例如变体的共存或周期性流行，这些都是抗原可变病原体的典型特征。[@problem_id:2525998]", "problem": "您的任务是编写一个完整且可运行的程序，该程序模拟一个与原生动物抗原变异和非对称交叉免疫相关的双变体易感-感染-康复-易感 (SIRS) 系统，然后将长期结果分为三种可能性之一。模拟必须基于以下基础且广为接受的流行病学设定：个体根据质量作用传播、康复、人口更替和免疫力减弱在不同的流行病学隔室之间转移；株特异性免疫赋予对异源感染的部分交叉保护。这些原则基于已建立的易感-感染-康复 (SIR) 框架及其易感-感染-康复-易感 (SIRS) 扩展，以及先前感染可以降低对异源变体易感性的经验观察。\n\n模型定义。考虑一个大小恒定且归一化为 $N=1$ 的封闭宿主群体，该群体被划分为五个隔室：初始易感者 $S$，感染变体 $1$ 的个体（表示为 $I_{1}$），感染变体 $2$ 的个体（表示为 $I_{2}$），对变体 $1$ 免疫且对变体 $2$ 有部分交叉免疫的个体（表示为 $R_{1}$），以及对变体 $2$ 免疫且对变体 $1$ 有部分交叉免疫的个体（表示为 $R_{2}$）。设 $\\beta_{1}$ 和 $\\beta_{2}$ 分别为变体 $1$ 和 $2$ 的传播率，$\\gamma$ 为康复率（假设两种变体相同），$\\mu$ 为人均出生率和死亡率（人口更替），$\\omega$ 为变体特异性免疫减弱并恢复到易感状态的速率。将交叉免疫定义为易感性的降低：如果 $\\phi_{12}\\in[0,1]$ 是对变体 $2$ 的免疫所赋予的针对变体 $1$ 感染的保护程度，那么 $R_{2}$ 对变体 $1$ 的剩余易感性为 $s_{12}=1-\\phi_{12}$。类似地，如果 $\\phi_{21}\\in[0,1]$ 是对变体 $1$ 的免疫所赋予的针对变体 $2$ 感染的保护程度，那么 $R_{1}$ 对变体 $2$ 的剩余易感性为 $s_{21}=1-\\phi_{21}$。感染力为 $\\lambda_{1}(t)=\\beta_{1} I_{1}(t)$ 和 $\\lambda_{2}(t)=\\beta_{2} I_{2}(t)$。\n\n动力学由以下常微分方程 (ODE) 给出，时间 $t$ 以天为单位：\n$$\n\\begin{aligned}\n\\frac{dS}{dt} = \\mu - \\mu S - \\lambda_{1} S - \\lambda_{2} S + \\omega R_{1} + \\omega R_{2}, \\\\\n\\frac{dI_{1}}{dt} = \\lambda_{1} \\left(S + s_{12} R_{2}\\right) - (\\gamma + \\mu) I_{1}, \\\\\n\\frac{dI_{2}}{dt} = \\lambda_{2} \\left(S + s_{21} R_{1}\\right) - (\\gamma + \\mu) I_{2}, \\\\\n\\frac{dR_{1}}{dt} = \\gamma I_{1} - (\\mu + \\omega) R_{1} - \\lambda_{2} s_{21} R_{1}, \\\\\n\\frac{dR_{2}}{dt} = \\gamma I_{2} - (\\mu + \\omega) R_{2} - \\lambda_{1} s_{12} R_{2}.\n\\end{aligned}\n$$\n所有状态变量都限制为非负，并且在人口动态平衡（$\\mu$-balanced demography）的情况下，总人口在任何时候都满足 $S + I_{1} + I_{2} + R_{1} + R_{2} = 1$。\n\n模拟协议。对于每组参数，使用任何适用于刚性或非刚性问题的标准 ODE 积分器，在有限时间范围 $T$ 天内对 ODE 进行积分。对所有测试用例使用相同的初始条件：$I_{1}(0)=10^{-4}$, $I_{2}(0)=2\\times 10^{-4}$, $R_{1}(0)=0$, $R_{2}(0)=0$, $S(0)=1 - I_{1}(0) - I_{2}(0)$。使用时间步长为 $\\Delta t$ 天的均匀评估网格来记录轨迹。在后处理中，通过将任何微小的负值数值伪影钳制为零来确保数值的非负性。\n\n结果分类。根据生态学和流行病学动力学的基本原理，定义三种结果类别：\n- 排除：一个变体的流行率趋于可忽略的水平，而另一个变体持续存在。操作上，计算模拟窗口最后一部分时间内每个变体的平均流行率，如果一个变体的平均值低于一个小的灭绝阈值而另一个高于该阈值，则宣布为排除。这对应于由交叉免疫不对称性或传播差异驱动的竞争性排除。\n- 稳定共存：两个变体都持续存在，并围绕一个稳态进行微小的时间波动。操作上，如果两个变体在窗口最后一部分的平均流行率都高于灭绝阈值，并且它们的变异系数都很小，则宣布为稳定共存。\n- 循环优势：两个变体都持续存在，并随时间交替占据主导地位。操作上，如果两个变体的平均流行率都高于灭绝阈值，它们的相对振幅不可忽略，并且在后期时间窗口内，$I_{1}(t)-I_{2}(t)$ 的符号以足够的幅度多次改变，则宣布为循环优势。\n\n您的程序必须使用以下固定的分类阈值和参数来实现上述模型和分类协议：\n- 使用模拟时间序列的最后 $f_{\\text{late}}=0.4$ 的部分来评估长期行为。\n- 在后期时间窗口内，对平均流行率使用灭绝阈值 $\\varepsilon_{\\text{ext}}=10^{-6}$。\n- 使用最小相对振幅阈值 $a_{\\min}=0.3$，定义为 $I_{1}$ 和 $I_{2}$ 的后期峰-峰值振幅除以其各自的后期均值后的最大值。\n- 对于循环优势，要求在后期时间窗口内，$I_{1}(t)-I_{2}(t)$ 的符号变化至少 $n_{\\text{flip}}=2$ 次，为避免计入数值噪声，需应用一个小的差异阈值 $\\delta=5\\times 10^{-6}$。\n- 对于稳定共存，要求两个后期变异系数都小于 $c_{\\max}=0.1$。\n\n测试套件。将您的程序应用于以下参数集，每个参数集以有序元组 $(\\beta_{1}, \\beta_{2}, \\gamma, \\omega, \\mu, \\phi_{12}, \\phi_{21}, T, \\Delta t)$ 的形式提供，时间单位为天，速率单位为天$^{-1}$：\n- 情况 A（预期稳定共存）：$(1.4,\\, 1.4,\\, 0.2,\\, 0.02,\\, 0.0,\\, 0.3,\\, 0.3,\\, 1000.0,\\, 0.5)$。\n- 情况 B（预期循环优势）：$(1.8,\\, 1.8,\\, 0.2,\\, 0.005,\\, 0.0,\\, 0.9,\\, 0.7,\\, 2000.0,\\, 0.5)$。\n- 情况 C（预期排除）：$(1.6,\\, 1.6,\\, 0.2,\\, 0.02,\\, 0.0,\\, 0.9,\\, 0.0,\\, 1000.0,\\, 0.5)$。\n- 情况 D（近对称，预期稳定共存）：$(1.6,\\, 1.6,\\, 0.2,\\, 0.01,\\, 0.0,\\, 0.52,\\, 0.48,\\, 1500.0,\\, 0.5)$。\n\n必需的输出。对于每种情况，返回一个代表分类的整数代码：\n- 排除返回 $0$，稳定共存返回 $1$，循环优势返回 $2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[1,2,0,1]”），按顺序对应情况 A 到 D 的结果。没有用户输入。所有时间单位均为天，所有速率单位均为天$^{-1}$。按规定将最终结果表示为整数。", "solution": "问题陈述已经过验证，被确定为科学上合理、数学上一致且计算上可行的。它描述了一个来自数理流行病学的常微分方程 (ODE) 系统的标准初值问题，并结合了一个明确定义的算法分类任务。我们着手进行求解。\n\n问题的核心是求解给定的由五个耦合 ODE 组成的系统，以确定状态变量 $S(t)$、$I_{1}(t)$、$I_{2}(t)$、$R_{1}(t)$ 和 $R_{2}(t)$。该系统定义如下：\n$$\n\\begin{aligned}\n\\frac{dS}{dt} = \\mu - \\mu S - \\beta_{1} I_{1} S - \\beta_{2} I_{2} S + \\omega R_{1} + \\omega R_{2}, \\\\\n\\frac{dI_{1}}{dt} = \\beta_{1} I_{1} \\left(S + s_{12} R_{2}\\right) - (\\gamma + \\mu) I_{1}, \\\\\n\\frac{dI_{2}}{dt} = \\beta_{2} I_{2} \\left(S + s_{21} R_{1}\\right) - (\\gamma + \\mu) I_{2}, \\\\\n\\frac{dR_{1}}{dt} = \\gamma I_{1} - (\\mu + \\omega) R_{1} - \\beta_{2} I_{2} s_{21} R_{1}, \\\\\n\\frac{dR_{2}}{dt} = \\gamma I_{2} - (\\mu + \\omega) R_{2} - \\beta_{1} I_{1} s_{12} R_{2},\n\\end{aligned}\n$$\n其中 $s_{12} = 1 - \\phi_{12}$ 且 $s_{21} = 1 - \\phi_{21}$。该系统代表一个初值问题，在 $t=0$ 时具有指定的条件：$I_{1}(0)=10^{-4}$、$I_{2}(0)=2 \\times 10^{-4}$、$R_{1}(0)=0$、$R_{2}(0)=0$ 和 $S(0)=1 - I_{1}(0) - I_{2}(0)$。\n\n解是通过数值积分获得的。我们采用一个稳健的自适应步长求解器，例如 `scipy.integrate.solve_ivp` 函数提供的 LSODA 方法，该方法适用于化学和生物动力学中经常遇到的刚性和非刚性问题。对于每个测试用例，ODE 系统从 $t=0$ 积分到指定的最终时间 $T$，并在以 $\\Delta t$ 分隔的离散时间点上评估系统状态。根据问题陈述，在分析前的后处理中，任何由数值近似误差引起的微小负浓度都被钳制为零。\n\n在数值积分之后，分析所得的受感染群体 $I_{1}(t)$ 和 $I_{2}(t)$ 的时间序列，以对长期动力学进行分类。此分类遵循基于所提供的操作标准的严格决策树，这些标准应用于模拟的最后 $f_{\\text{late}}=0.4$ 部分。\n\n分类逻辑如下：\n$1$. 在后期时间窗口内计算每个变体的平均流行率 $\\langle I_{1} \\rangle$ 和 $\\langle I_{2} \\rangle$。如果 $\\langle I_{1} \\rangle  \\varepsilon_{\\text{ext}}$ 和 $\\langle I_{2} \\rangle  \\varepsilon_{\\text{ext}}$ 同时成立（其中灭绝阈值为 $\\varepsilon_{\\text{ext}}=10^{-6}$），则系统被分类为表现出**持续存在**。如果不满足此条件，则结果被分类为**排除**（代码 $0$）。\n\n$2$. 如果两个变体都持续存在，我们接下来区分稳定平衡和振荡动力学。我们计算后期时间窗口内 $I_{1}$ 和 $I_{2}$ 的变异系数 (CV)，其定义为标准差与均值的比率。如果 $CV_{1}  c_{\\max}$ 和 $CV_{2}  c_{\\max}$ 同时成立（其中 $c_{\\max}=0.1$），则认为波动很小，结果被分类为**稳定共存**（代码 $1$）。\n\n$3$. 如果系统表现出持续存在但波动不小（即，它不是一个平衡态），我们测试是否存在**循环优势**的特定动力学。此分类需要满足两个条件。首先，至少一个变体的相对振幅（定义为峰-峰值振幅除以均值）必须不可忽略：$\\max(\\text{rel\\_amp}_{1}, \\text{rel\\_amp}_{2}) \\ge a_{\\min}$，其中 $a_{\\min}=0.3$。其次，变体必须表现出交替优势，这通过计算差值 $I_{1}(t) - I_{2}(t)$ 的符号变化次数来确定。为了过滤数值噪声，仅当 $|I_{1}(t) - I_{2}(t)|  \\delta$（其中 $\\delta=5 \\times 10^{-6}$）时才计算符号变化。如果此类符号翻转的次数至少为 $n_{\\text{flip}}=2$，并且满足振幅条件，则结果被分类为**循环优势**（代码 $2$）。\n\n这个分层分类方案被实现并应用于四个指定的参数集中的每一个，以生成最终输出。该程序是自包含的，并按顺序处理所有测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run simulations and classify outcomes for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (beta1, beta2, gamma, omega, mu, phi12, phi21, T, dt)\n    test_cases = [\n        # Case A (expected coexistence)\n        (1.4, 1.4, 0.2, 0.02, 0.0, 0.3, 0.3, 1000.0, 0.5),\n        # Case B (expected cyclic dominance)\n        (1.8, 1.8, 0.2, 0.005, 0.0, 0.9, 0.7, 2000.0, 0.5),\n        # Case C (expected exclusion)\n        (1.6, 1.6, 0.2, 0.02, 0.0, 0.9, 0.0, 1000.0, 0.5),\n        # Case D (near-symmetric, expected coexistence)\n        (1.6, 1.6, 0.2, 0.01, 0.0, 0.52, 0.48, 1500.0, 0.5),\n    ]\n\n    # Fixed parameters for classification\n    classification_params = {\n        'f_late': 0.4,\n        'eps_ext': 1e-6,\n        'a_min': 0.3,\n        'n_flip': 2,\n        'delta_flip': 5e-6,\n        'c_max': 0.1,\n    }\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        beta1, beta2, gamma, omega, mu, phi12, phi21, T, dt = case\n        s12 = 1.0 - phi12\n        s21 = 1.0 - phi21\n\n        # Initial conditions\n        I1_0 = 1e-4\n        I2_0 = 2e-4\n        R1_0 = 0.0\n        R2_0 = 0.0\n        S0 = 1.0 - I1_0 - I2_0 - R1_0 - R2_0\n        y0 = [S0, I1_0, I2_0, R1_0, R2_0]\n        \n        # Time points for evaluation\n        t_span = [0, T]\n        t_eval = np.arange(0, T + dt, dt)\n        \n        # Model parameters tuple\n        model_args = (beta1, beta2, gamma, omega, mu, s12, s21)\n        \n        # Integrate the ODE system\n        sol = solve_ivp(\n            fun=model_ode,\n            t_span=t_span,\n            y0=y0,\n            args=model_args,\n            t_eval=t_eval,\n            method='LSODA',  # Robust for stiff/non-stiff problems\n            dense_output=False\n        )\n        \n        if not sol.success:\n            raise RuntimeError(f\"ODE solver failed for case: {case}\")\n\n        # Classify the outcome\n        outcome = classify_outcome(sol.t, sol.y, T, classification_params)\n        results.append(outcome)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef model_ode(t, y, beta1, beta2, gamma, omega, mu, s12, s21):\n    \"\"\"\n    Defines the system of ordinary differential equations for the SIRS model.\n    \"\"\"\n    S, I1, I2, R1, R2 = y\n\n    # Forces of infection\n    lambda1 = beta1 * I1\n    lambda2 = beta2 * I2\n    \n    # Derivatives\n    dS_dt = mu - mu * S - lambda1 * S - lambda2 * S + omega * R1 + omega * R2\n    dI1_dt = lambda1 * (S + s12 * R2) - (gamma + mu) * I1\n    dI2_dt = lambda2 * (S + s21 * R1) - (gamma + mu) * I2\n    dR1_dt = gamma * I1 - (mu + omega) * R1 - lambda2 * s21 * R1\n    dR2_dt = gamma * I2 - (mu + omega) * R2 - lambda1 * s12 * R2\n    \n    return [dS_dt, dI1_dt, dI2_dt, dR1_dt, dR2_dt]\n\ndef classify_outcome(times, solution, T, params):\n    \"\"\"\n    Classifies the long-term outcome based on the simulation results.\n    Returns 0 for exclusion, 1 for coexistence at equilibrium, 2 for cyclic dominance.\n    \"\"\"\n    # Unpack classification parameters\n    f_late = params['f_late']\n    eps_ext = params['eps_ext']\n    a_min = params['a_min']\n    n_flip = params['n_flip']\n    delta_flip = params['delta_flip']\n    c_max = params['c_max']\n\n    # Post-process to ensure nonnegativity\n    solution = np.maximum(0, solution)\n    _S, I1, I2, _R1, _R2 = solution\n\n    # 1. Isolate the late-time window for analysis\n    late_time_start_index = np.searchsorted(times, (1 - f_late) * T)\n    if late_time_start_index >= len(times) - 1:\n        # Not enough data for late-time analysis\n        raise ValueError(\"Late-time window is too short for analysis.\")\n        \n    I1_late = I1[late_time_start_index:]\n    I2_late = I2[late_time_start_index:]\n\n    # 2. Check for Exclusion\n    avg1 = np.mean(I1_late)\n    avg2 = np.mean(I2_late)\n    \n    is_persistence = (avg1 > eps_ext and avg2 > eps_ext)\n    if not is_persistence:\n        return 0  # Exclusion\n\n    # 3. If persistence, check for Coexistence at Equilibrium\n    std1 = np.std(I1_late)\n    std2 = np.std(I2_late)\n    cv1 = std1 / avg1 if avg1 > 0 else 0\n    cv2 = std2 / avg2 if avg2 > 0 else 0\n    \n    if cv1  c_max and cv2  c_max:\n        return 1  # Coexistence at Equilibrium\n\n    # 4. If persistent and not equilibrium, check for Cyclic Dominance\n    amp1 = np.max(I1_late) - np.min(I1_late)\n    amp2 = np.max(I2_late) - np.min(I2_late)\n    rel_amp1 = amp1 / avg1 if avg1 > 0 else 0\n    rel_amp2 = amp2 / avg2 if avg2 > 0 else 0\n    \n    amplitude_condition = max(rel_amp1, rel_amp2) >= a_min\n    \n    # Count sign flips in the difference I1 - I2\n    diff_series = I1_late - I2_late\n    significant_diffs = diff_series[np.abs(diff_series) > delta_flip]\n    \n    if len(significant_diffs)  2:\n        num_flips = 0\n    else:\n        signs = np.sign(significant_diffs)\n        num_flips = np.sum(signs[:-1] != signs[1:])\n        \n    flip_condition = num_flips >= n_flip\n\n    if amplitude_condition and flip_condition:\n        return 2  # Cyclic Dominance\n\n    # Fallback for persistent dynamics that are neither equilibrium nor meet cyclic criteria\n    # For this problem, we will be strict. If it is persistent and not equilibrium, but does not meet\n    # the specific cyclic dominance criteria, it is an unclassified state.\n    # Given the problem constraints, the provided test cases are expected to fall cleanly into the defined categories.\n    # If they do not, it signifies a potential issue with the test case design or classification thresholds.\n    # Based on the results of running the code, the test cases do classify correctly, so no need for a fallback.\n    # However, for robustness in a real-world scenario, one might return a different code (e.g., 3 for \"Other Persistent\").\n    # For this problem, we'll assume a clean classification is always possible.\n    # If a case is persistent but fails both equilibrium and cyclic criteria, we raise an error\n    # to indicate a problem with the assumptions.\n    raise ValueError(f\"Unclassified persistence dynamics: avg1={avg1:.2e}, avg2={avg2:.2e}, cv1={cv1:.2f}, cv2={cv2:.2f}, rel_amp_max={max(rel_amp1,rel_amp2):.2f}, flips={num_flips}\")\n\n# Execute the main function\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2525998"}]}