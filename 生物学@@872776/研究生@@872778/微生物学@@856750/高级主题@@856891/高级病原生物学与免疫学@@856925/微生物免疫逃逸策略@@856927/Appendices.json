{"hands_on_practices": [{"introduction": "许多病原体通过分泌抑制性蛋白来直接阻断宿主的免疫通路，这是免疫逃逸的一种常见分子机制。本练习为这种拮抗作用提供了一个基础模型，让你能够从基本原理出发，推导在病原体抑制剂存在的情况下，宿主蛋白酶的活性比例。通过这个计算，你将能够定量地理解抑制剂浓度和结合亲和力（以解离常数 $K_i$ 表示）如何共同决定这种逃逸策略的有效性 [@problem_id:2510394]。", "problem": "一种细菌病原体通过分泌一种高亲和力的蛋白质抑制剂来逃避宿主的先天性免疫应答，该抑制剂能与一种参与中性粒细胞介导的杀伤作用的宿主丝氨酸蛋白酶结合。在一个简化的微环境中，假设蛋白酶和微生物抑制剂之间存在一个单一的可逆结合反应，\n$$\nE + I \\rightleftharpoons EI,\n$$\n其中 $E$ 是游离蛋白酶，$I$ 是游离抑制剂，$EI$ 是无活性的酶-抑制剂复合物。抑制剂与蛋白酶的相互作用由平衡解离常数（对于抑制剂通常记为 $K_{i}$）来表征，\n$$\nK_{i} = \\frac{[E][I]}{[EI]},\n$$\n其中 $[\\,\\cdot\\,]$ 表示平衡浓度。设总蛋白酶浓度为 $E_{\\mathrm{T}}$，总抑制剂浓度为 $I_{\\mathrm{T}}$，且满足守恒关系 $E_{\\mathrm{T}} = [E] + [EI]$ 和 $I_{\\mathrm{T}} = [I] + [EI]$。假设为 $1{:}1$ 结合且无协同效应，$EI$ 复合物无催化活性，并忽略底物结合及任何其他相互作用。\n\n仅从质量作用定律和 $K_{i}$ 作为平衡解离常数的定义出发，推导平衡时活性蛋白酶分数\n$$\nf_{\\mathrm{active}} = \\frac{[E]}{E_{\\mathrm{T}}},\n$$\n的表达式，该表达式应以 $E_{\\mathrm{T}}$、$I_{\\mathrm{T}}$ 和 $K_{i}$ 表示。然后，当 $E_{\\mathrm{T}} = $ $20\\,\\text{nM}$、$I_{\\mathrm{T}} = $ $30\\,\\text{nM}$ 和 $K_{i} = $ $10\\,\\text{nM}$ 时，计算 $f_{\\mathrm{active}}$ 的值。将最终的数值答案四舍五入到四位有效数字，并以无单位小数表示。", "solution": "该问题要求推导平衡时活性蛋白酶分数的表达式，然后进行数值计算。问题陈述在科学上是合理的，提法恰当，并为得到唯一解提供了所有必要的信息。这是生物化学动力学中一个关于紧密结合抑制剂的标准问题。我们将着手进行推导。\n\n该系统由以下三个基本关系式描述：\n1. 平衡解离常数 $K_{i}$ 的定义：\n$$K_{i} = \\frac{[E][I]}{[EI]}$$\n2. 总蛋白酶 $E_{\\mathrm{T}}$ 的守恒：\n$$E_{\\mathrm{T}} = [E] + [EI]$$\n3. 总抑制剂 $I_{\\mathrm{T}}$ 的守恒：\n$$I_{\\mathrm{T}} = [I] + [EI]$$\n此处，$[E]$、$[I]$ 和 $[EI]$ 分别代表游离蛋白酶、游离抑制剂和酶-抑制剂复合物的平衡浓度。\n\n我们的目标是找到活性蛋白酶分数 $f_{\\mathrm{active}} = \\frac{[E]}{E_{\\mathrm{T}}}$ 的表达式，该表达式仅用总浓度 $E_{\\mathrm{T}}$、$I_{\\mathrm{T}}$ 和常数 $K_{i}$ 来表示。为此，我们必须求解平衡浓度 $[E]$。\n\n根据酶的守恒方程（方程2），我们将复合物的浓度 $[EI]$ 用 $[E]$ 和 $E_{\\mathrm{T}}$ 表示：\n$$[EI] = E_{\\mathrm{T}} - [E]$$\n根据抑制剂的守恒方程（方程3），我们将游离抑制剂的浓度 $[I]$ 表示为：\n$$[I] = I_{\\mathrm{T}} - [EI]$$\n将上一步中 $[EI]$ 的表达式代入，得到：\n$$[I] = I_{\\mathrm{T}} - (E_{\\mathrm{T}} - [E]) = I_{\\mathrm{T}} - E_{\\mathrm{T}} + [E]$$\n现在，我们将 $[I]$ 和 $[EI]$ 的表达式代入 $K_{i}$ 的定义（方程1）中：\n$$K_{i} = \\frac{[E](I_{\\mathrm{T}} - E_{\\mathrm{T}} + [E])}{E_{\\mathrm{T}} - [E]}$$\n为了求解 $[E]$，我们将此方程重新整理为标准的二次方程形式 $ax^2 + bx + c = 0$。\n$$K_{i}(E_{\\mathrm{T}} - [E]) = [E](I_{\\mathrm{T}} - E_{\\mathrm{T}} + [E])$$\n$$K_{i}E_{\\mathrm{T}} - K_{i}[E] = I_{\\mathrm{T}}[E] - E_{\\mathrm{T}}[E] + [E]^2$$\n将所有项移到一边，得到关于 $[E]$ 的二次方程：\n$$[E]^2 + (I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i})[E] - K_{i}E_{\\mathrm{T}} = 0$$\n我们使用二次公式 $[E] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解此方程，其中 $a = 1$，$b = (I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i})$，$c = -K_{i}E_{\\mathrm{T}}$。\n$$[E] = \\frac{-(I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i}) \\pm \\sqrt{(I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i})^2 - 4(1)(-K_{i}E_{\\mathrm{T}})}}{2(1)}$$\n$$[E] = \\frac{(E_{\\mathrm{T}} - I_{\\mathrm{T}} - K_{i}) \\pm \\sqrt{(I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i})^2 + 4K_{i}E_{\\mathrm{T}}}}{2}$$\n浓度 $[E]$ 必须是一个物理上真实且非负的量。判别式 $\\Delta = (I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i})^2 + 4K_{i}E_{\\mathrm{T}}$ 恒为正，因为它是一个平方项与一个非负常数乘积之和。因此，存在两个实数根。$\\sqrt{\\Delta}$ 项严格大于 $|I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i}|$。因此，带有负号的根 $-(I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i}) - \\sqrt{\\Delta}$ 将恒为负值。因为浓度不能为负，所以这个解在物理上是无效的。我们必须选择正根：\n$$[E] = \\frac{-(I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i}) + \\sqrt{(I_{\\mathrm{T}} - E_{\\mathrm{T}} + K_{i})^2 + 4K_{i}E_{\\mathrm{T}}}}{2}$$\n我们可以将这个关于 $[E]$ 的表达式改写为：\n$$[E] = \\frac{(E_{\\mathrm{T}} - I_{\\mathrm{T}} - K_{i}) + \\sqrt{(E_{\\mathrm{T}} - I_{\\mathrm{T}} - K_{i})^2 + 4K_{i}E_{\\mathrm{T}}}}{2}$$\n活性蛋白酶的分数是 $f_{\\mathrm{active}} = \\frac{[E]}{E_{\\mathrm{T}}}$。将 $[E]$ 的表达式除以 $E_{\\mathrm{T}}$，得到最终的解析解：\n$$f_{\\mathrm{active}} = \\frac{(E_{\\mathrm{T}} - I_{\\mathrm{T}} - K_{i}) + \\sqrt{(E_{\\mathrm{T}} - I_{\\mathrm{T}} - K_{i})^2 + 4K_{i}E_{\\mathrm{T}}}}{2E_{\\mathrm{T}}}$$\n现在，我们使用给定的数值来计算该表达式：$E_{\\mathrm{T}} = 20\\,\\text{nM}$，$I_{\\mathrm{T}} = 30\\,\\text{nM}$，以及 $K_{i} = 10\\,\\text{nM}$。由于所有浓度都使用相同的单位（nM），单位将会抵消，我们可以直接使用数值 $20$、$30$ 和 $10$ 进行计算。\n$$f_{\\mathrm{active}} = \\frac{(20 - 30 - 10) + \\sqrt{(20 - 30 - 10)^2 + 4(10)(20)}}{2(20)}$$\n$$f_{\\mathrm{active}} = \\frac{-20 + \\sqrt{(-20)^2 + 800}}{40}$$\n$$f_{\\mathrm{active}} = \\frac{-20 + \\sqrt{400 + 800}}{40}$$\n$$f_{\\mathrm{active}} = \\frac{-20 + \\sqrt{1200}}{40}$$\n$\\sqrt{1200}$ 项可以简化为 $\\sqrt{400 \\times 3} = 20\\sqrt{3}$。\n$$f_{\\mathrm{active}} = \\frac{-20 + 20\\sqrt{3}}{40}$$\n从分子中提出公因式 $20$：\n$$f_{\\mathrm{active}} = \\frac{20(-1 + \\sqrt{3})}{40}$$\n$$f_{\\mathrm{active}} = \\frac{\\sqrt{3} - 1}{2}$$\n为了得到最终的数值答案，我们计算该表达式的值：\n$$f_{\\mathrm{active}} \\approx \\frac{1.7320508... - 1}{2} = \\frac{0.7320508...}{2} = 0.3660254...$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$f_{\\mathrm{active}} \\approx 0.3660$$", "answer": "$$\\boxed{0.3660}$$", "id": "2510394"}, {"introduction": "在宿主-病原体相互作用中，吞噬体内的氧化爆发是宿主清除入侵微生物的关键武器。本练习将我们的分析从简单的化学平衡推向一个更复杂的动态系统，让你模拟吞噬体内的稳态环境。你需要推导有毒分子过氧化氢（$\\mathrm{H_2O_2}$）的稳态浓度，该浓度由宿主的持续生产、微生物分泌的过氧化氢酶的降解以及其他清除途径共同决定。这个练习清晰地展示了不同过程的动力学参数如何塑造局部微环境，并最终决定微生物的生死存亡 [@problem_id:2510336]。", "problem": "一种兼性细胞内细菌通过表达可降解过氧化氢 ($\\mathrm{H_2O_2}$) 的过氧化氢酶，在中性粒细胞吞噬体内存活，从而降低活性氧（ROS）的效力。将吞噬体建模为一个充分混合的室，在该室中，$\\mathrm{H_2O_2}$ 以恒定速率 $q$（单位：$\\mathrm{M \\, s^{-1}}$）均匀产生。细菌向吞噬体腔内分泌过氧化氢酶，使得有效的过氧化氢酶浓度为 $E$（单位：$\\mathrm{M}$）。该过氧化氢酶遵循 Michaelis–Menten 动力学，其催化转换数为 $k_{\\mathrm{cat}}$（单位：$\\mathrm{s^{-1}}$），Michaelis 常数为 $K_m$（单位：$\\mathrm{M}$）。除了过氧化氢酶的酶促降解外，$\\mathrm{H_2O_2}$ 还通过宿主过程（例如，髓过氧化物酶介导的消耗和扩散出室）被清除，这些过程可以一并被视为一级损失，其速率常数为 $k_d$（单位：$\\mathrm{s^{-1}}$）。\n\n假设 $\\mathrm{H_2O_2}$ 浓度 $s(t)$ 的演变遵循产生过程和两种清除过程之间的质量平衡，并且当 $t \\to \\infty$ 时，存在稳态 $s(t) \\to s^{\\ast}$。仅使用 (i) 充分混合室质量平衡的定义，(ii) 单底物酶的 Michaelis–Menten 速率定律 $v(s) = \\dfrac{k_{\\mathrm{cat}} E \\, s}{K_m + s}$，以及 (iii) 一级损失的形式 $k_d s$，推导稳态浓度 $s^{\\ast}$ 关于 $q$、$k_{\\mathrm{cat}}$、$E$、$K_m$ 和 $k_d$ 的解析表达式。将您的最终答案表示为 $s^{\\ast}$ 的单个封闭形式表达式。如果您选择代入任何数值，请以摩尔浓度单位表示稳态浓度，但首选精确的符号表达式。不要提供不等式或方程；仅提供 $s^{\\ast}$ 的表达式。[@problem_id:150]", "solution": "该问题要求推导吞噬体内过氧化氢的稳态浓度 $s^{\\ast}$。该系统被建模为一个充分混合的室，其中 $\\mathrm{H_2O_2}$ 的浓度（表示为 $s(t)$）由一个质量平衡方程控制。\n\n浓度变化率 $\\dfrac{ds}{dt}$ 是产生速率和清除速率的总和。\n给定的项是：\n1. 恒定的产生速率 $q$。\n2. 遵循 Michaelis–Menten 动力学的酶促清除速率 $v(s) = \\dfrac{k_{\\mathrm{cat}} E s}{K_m + s}$，其中 $s$ 是底物（$\\mathrm{H_2O_2}$）浓度，$E$ 是酶（过氧化氢酶）浓度，$k_{\\mathrm{cat}}$ 是催化转换数，$K_m$ 是 Michaelis 常数。\n3. 一级清除速率 $k_d s$，代表其他宿主介导的过程。\n\n因此，浓度 $s(t)$ 的质量平衡常微分方程由这些速率的总和给出。产生过程增加浓度，而清除过程降低浓度。\n$$\n\\frac{ds}{dt} = q - \\frac{k_{\\mathrm{cat}} E s}{K_m + s} - k_d s\n$$\n问题指出，当 $t \\to \\infty$ 时达到稳态，此时浓度接近一个恒定值 $s^{\\ast}$。在稳态时，浓度不再随时间变化，这意味着导数 $\\dfrac{ds}{dt}$ 等于零。将 $s = s^{\\ast}$ 代入并将导数设为零，得到以下关于 $s^{\\ast}$ 的代数方程：\n$$\n0 = q - \\frac{k_{\\mathrm{cat}} E s^{\\ast}}{K_m + s^{\\ast}} - k_d s^{\\ast}\n$$\n为了求解 $s^{\\ast}$，我们必须将此方程重新排列成更易于处理的形式。第一步是通过将所有项乘以 $(K_m + s^{\\ast})$ 来消去分母，这是允许的，因为浓度 $s^{\\ast}$ 和 Michaelis 常数 $K_m$ 都是非负的，确保了 $K_m + s^{\\ast} > 0$。\n$$\n0 = q(K_m + s^{\\ast}) - k_{\\mathrm{cat}} E s^{\\ast} - k_d s^{\\ast}(K_m + s^{\\ast})\n$$\n接下来，我们展开各项：\n$$\n0 = q K_m + q s^{\\ast} - k_{\\mathrm{cat}} E s^{\\ast} - k_d K_m s^{\\ast} - k_d (s^{\\ast})^2\n$$\n该方程是关于变量 $s^{\\ast}$ 的二次多项式。我们将其重新排列为标准形式 $ax^2 + bx + c = 0$。\n$$\nk_d (s^{\\ast})^2 + (k_d K_m + k_{\\mathrm{cat}} E - q) s^{\\ast} - q K_m = 0\n$$\n这个关于 $s^{\\ast}$ 的二次方程的系数是：\n- $a = k_d$\n- $b = k_d K_m + k_{\\mathrm{cat}} E - q$\n- $c = -q K_m$\n\n我们应用二次公式 $s^{\\ast} = \\dfrac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来求解 $s^{\\ast}$。\n$$\ns^{\\ast} = \\frac{-(k_d K_m + k_{\\mathrm{cat}} E - q) \\pm \\sqrt{(k_d K_m + k_{\\mathrm{cat}} E - q)^2 - 4(k_d)(-q K_m)}}{2 k_d}\n$$\n简化公式中的表达式：\n$$\ns^{\\ast} = \\frac{q - k_d K_m - k_{\\mathrm{cat}} E \\pm \\sqrt{(k_d K_m + k_{\\mathrm{cat}} E - q)^2 + 4 k_d q K_m}}{2 k_d}\n$$\n该方程给出了 $s^{\\ast}$ 的两个可能的数学解。然而，浓度必须是一个有物理意义的量，这意味着它必须是非负的，即 $s^{\\ast} \\ge 0$。我们必须评估两个根中哪一个满足这个条件。\n\n表达式中的所有参数（$q, k_d, K_m, k_{\\mathrm{cat}}, E$）都是正的物理常数。设判别式为 $\\Delta = (k_d K_m + k_{\\mathrm{cat}} E - q)^2 + 4 k_d q K_m$。由于 $(k_d K_m + k_{\\mathrm{cat}} E - q)^2 \\ge 0$ 且 $4 k_d q K_m > 0$，判别式 $\\Delta$ 总是正的，这保证了有两个不同的实根。\n\n让我们分析平方根项的大小。我们可以观察到：\n$$\n\\sqrt{\\Delta} = \\sqrt{(k_d K_m + k_{\\mathrm{cat}} E - q)^2 + 4 k_d q K_m} > \\sqrt{(k_d K_m + k_{\\mathrm{cat}} E - q)^2} = |k_d K_m + k_{\\mathrm{cat}} E - q| = |q - (k_d K_m + k_{\\mathrm{cat}} E)|\n$$\n考虑带有负号的解：\n$$\ns^{\\ast}_{-} = \\frac{q - k_d K_m - k_{\\mathrm{cat}} E - \\sqrt{\\Delta}}{2 k_d}\n$$\n如果 $q - k_d K_m - k_{\\mathrm{cat}} E \\ge 0$，则 $\\sqrt{\\Delta} > q - k_d K_m - k_{\\mathrm{cat}} E$，所以分子为负。\n如果 $q - k_d K_m - k_{\\mathrm{cat}} E  0$，则分子是一个负项与另一个负项（因为 $-\\sqrt{\\Delta}  0$）的和，所以分子为负。\n在所有情况下，分子都是负的。由于分母 $2k_d$ 是正的，所以 $s^{\\ast}_{-}$ 总是负的。负浓度在物理上是不可能的。因此，必须舍弃这个解。\n\n唯一具有物理有效性的解是带有正号的那个：\n$$\ns^{\\ast}_{+} = \\frac{q - k_d K_m - k_{\\mathrm{cat}} E + \\sqrt{(k_d K_m + k_{\\mathrm{cat}} E - q)^2 + 4 k_d q K_m}}{2 k_d}\n$$\n这个根可以被证明总是正的。二次函数 $f(s) = k_d s^2 + (k_d K_m + k_{\\mathrm{cat}} E - q) s - q K_m$ 在 $s=0$ 处的值为 $f(0) = -q K_m  0$。由于抛物线开口向上（$a = k_d > 0$），它必须且仅与正 s 轴相交一次。这个正根是唯一具有物理意义的稳态浓度 $s^{\\ast}$。\n\n因此，$s^{\\ast}$ 的最终封闭形式表达式是该二次方程的正根。注意，$(k_d K_m + k_{\\mathrm{cat}} E - q)^2$ 等价于 $(q - k_d K_m - k_{\\mathrm{cat}} E)^2$，所以表达式的形式可以写得略有不同，但数学上是等价的。", "answer": "$$\n\\boxed{\\frac{q - k_d K_m - k_{\\mathrm{cat}} E + \\sqrt{(k_d K_m + k_{\\mathrm{cat}} E - q)^2 + 4 k_d q K_m}}{2 k_d}}\n$$", "id": "2510336"}, {"introduction": "理论模型的力量在于其解释和预测现实世界现象的能力，但这必须通过实验数据来验证和参数化。本练习旨在连接理论与实践，聚焦于一种核心的实验方法——剂量-效应曲线分析。你将首先从质量作用定律出发，推导出描述协同抑制效应的数学模型（希尔方程），然后应用非线性拟合等计算工具，将该模型与模拟的实验数据进行拟合，从而提取出半数抑制浓度（$c_{50}$）和协同性系数（$n$）等关键参数。这项综合性练习将锻炼你在定量生物学分析和数据解读方面的核心技能 [@problem_id:2510298]。", "problem": "在一个哺乳动物细胞系中，测量了一条抗病毒信号通路，其中干扰素 (IFN) 的诱导被监测为一种病毒免疫拮抗蛋白（流感病毒非结构蛋白 $1$，influenza Nonstructural Protein $1$, 缩写为 NS$1$）浓度的函数。已知流感病毒非结构蛋白 $1$ 会抑制导致干扰素转录的模式识别受体通路。假设以下基本前提：在准稳态条件下，抑制剂与其靶标之间的分子结合事件遵循质量作用定律；当抑制作用需要形成一个具有 $n$ 个等效且独立结合事件的复合物时，处于抑制状态的靶分子比例随抑制剂浓度单调增加，并由一条结合等温线所控制，其中斜率指数反映了协同性的程度。假设宏观的 IFN 诱导读数是活性（未被抑制）靶标比例的仿射变换。\n\n你的任务是：\n- 根据质量作用描述和协同性的定义，推导出一个饱和剂量-反应形式，将 IFN 诱导 $y$ 表示为抑制剂浓度 $c$ 的函数，该函数包含四个参数：一个下渐近线、一个上渐近线、一个使反应处于渐近线之间中点的特征浓度，以及一个编码抑制协同性的无量纲斜率指数。不要使用任何预先记忆的快捷公式；函数形式必须从上述基本假设推导得出。\n- 实现一个非线性最小二乘估计器，将推导出的函数拟合到下方的每个数据集，并推断斜率指数（协同性参数）和半最大抑制浓度。特征浓度使用纳摩尔 (nM) 作为单位。假设测量误差为独立同分布且方差恒定的高斯误差。在物理上需要时，可以施加正值约束。\n- 对于每个数据集，根据估计的斜率指数 $\\hat{n}$ 使用以下规则对协同性进行分类：如果 $\\hat{n} > 1.2$ 则为协同，如果 $0.8 \\le \\hat{n} \\le 1.2$ 则为非协同，如果 $\\hat{n}  0.8$ 则为表观负协同。将这三种情况分别编码为整数 $1$、$0$ 和 $-1$。\n- 对于每个数据集，报告估计的斜率指数 $\\hat{n}$（无量纲）和估计的半最大抑制浓度 $\\widehat{c_{50}}$（单位为 nM），每个值都四舍五入到两位小数，然后是整数协同性代码。本问题不涉及角度。浓度单位必须按规定以纳摩尔 (nM) 报告；斜率指数是无量纲的。\n\n测试套件（每个数据集包含一个共享的浓度向量和一个以任意单位 (a.u.) 表示的 IFN 诱导向量）：\n- 共享抑制剂浓度 (nM)：$[0, 1, 3, 10, 30, 100, 300, 1000]$。\n\n- 数据集 A（正常路径，中等协同性）：\n  IFN 诱导 (a.u.): $[100.0, 99.1089108910891, 92.5688073394495, 55.0, 19.0, 10.8910891089109, 10.0998890110988, 10.0089991000899]$。\n\n- 数据集 B（边界情况，近似非协同）：\n  IFN 诱导 (a.u.): $[120.0, 118.0392156862745, 114.3396226415094, 103.3333333333333, 82.5, 53.3333333333333, 34.2857142857143, 24.7619047619048]$。\n\n- 数据集 C（高协同性）：\n  IFN 诱导 (a.u.): $[80.0, 79.9999074074074, 79.992500749925, 79.0853658536585, 42.5, 5.6026, 5.007499250075, 5.00006075]$。\n\n- 数据集 D（弱动态范围，部分抑制，中等斜率）：\n  IFN 诱导 (a.u.): $[50.0, 49.98001998, 49.8966, 49.3867, 47.174, 40.0, 33.228, 30.613]$。\n\n你的程序应该为每个数据集估计参数，并生成一个单行输出，其中包含一个扁平的、逗号分隔的列表，顺序如下：\n$[\\hat{n}_{\\mathrm{A}}, \\widehat{c_{50,\\mathrm{A}}}, \\mathrm{code}_{\\mathrm{A}}, \\hat{n}_{\\mathrm{B}}, \\widehat{c_{50,\\mathrm{B}}}, \\mathrm{code}_{\\mathrm{B}}, \\hat{n}_{\\mathrm{C}}, \\widehat{c_{50,\\mathrm{C}}}, \\mathrm{code}_{\\mathrm{C}}, \\hat{n}_{\\mathrm{D}}, \\widehat{c_{50,\\mathrm{D}}}, \\mathrm{code}_{\\mathrm{D}}]$,\n其中每个 $\\hat{n}$ 和 $\\widehat{c_{50}}$ 都四舍五入到两位小数，每个 code 是 $-1$、$0$ 或 $1$ 之一。将所有 $\\widehat{c_{50}}$ 值以 nM 为单位表示并四舍五入到两位小数，所有 $\\hat{n}$ 表示为无量纲数值并四舍五入到两位小数。输出必须是指定方括号列表格式的单行。", "solution": "所陈述的问题需要经过验证。\n\n**步骤 1：提取已知条件**\n-   **系统**：一个以干扰素 (IFN) 诱导为输出的抗病毒信号通路。\n-   **抑制剂**：流感病毒非结构蛋白 $1$ (NS$1$)，其浓度用 $c$ 表示。\n-   **核心假设**：\n    1.  结合事件处于准稳态，并遵循质量作用定律。\n    2.  抑制作用涉及由 $n$ 个等效且独立的结合事件形成的复合物，其中 $n$ 代表一个编码协同性的斜率指数。\n    3.  IFN 诱导读数 $y$ 是活性（未被抑制）靶分子比例的仿射变换。\n-   **任务 1**：根据这些假设推导一个四参数剂量-反应函数 $y(c)$。这些参数是一个下渐近线、一个上渐近线、一个特征浓度和一个斜率指数。\n-   **任务 2**：实现一个非线性最小二乘估计器，将此函数拟合到所提供的数据集，并假设误差为独立同分布的高斯误差。\n-   **任务 3**：根据估计的斜率指数 $\\hat{n}$ 对协同性进行分类：$\\hat{n} > 1.2$ 为协同（代码 $1$），$0.8 \\le \\hat{n} \\le 1.2$ 为非协同（代码 $0$），$\\hat{n}  0.8$ 为表观负协同（代码 $-1$）。\n-   **任务 4**：为每个数据集报告估计的斜率指数 $\\hat{n}$ 和半最大抑制浓度 $\\widehat{c_{50}}$（单位 nM），四舍五入到两位小数，并附上协同性代码。\n-   **数据**：提供了四个数据集，每个数据集都有一个共享的抑制剂浓度 $c$ 向量（单位 nM）和相应的 IFN 诱导 $y$ 向量（单位 a.u.）。浓度为 $[0, 1, 3, 10, 30, 100, 300, 1000]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于化学动力学（质量作用定律）和生物物理建模（Hill-Langmuir 等温线）的基本原理。流感病毒 NS$1$ 蛋白作为 IFN 信号抑制剂的背景是符合事实的。该问题提法明确，提供了足够的数据和一组清晰的任务，可通过标准数值方法得到唯一解。语言客观、精确。所有必要组成部分——理论基础、数据和要求的输出格式——都已提供，使问题自洽且无矛盾。这些假设是此类建模的标准。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将提供一个合理的解决方案。\n\n**剂量-反应模型的推导**\n令 $T$ 代表信号通路的靶分子，$I$ 代表抑制剂蛋白 NS$1$。问题陈述抑制作用通过形成一个涉及 $n$ 个抑制剂分子的复合物来进行。这个协同结合过程可以建模为单步化学平衡：\n$$ T_{active} + n I \\rightleftharpoons T_{inactive} $$\n其中 $T_{active}$ 是未被抑制的靶标，而 $T_{inactive}$ 是靶标-抑制剂复合物。\n\n根据准稳态下的质量作用定律，此反应的解离常数 $K_d$ 由下式给出：\n$$ K_d = \\frac{[T_{active}] [I]^n}{[T_{inactive}]} $$\n其中 $[ \\cdot ]$ 表示浓度。令 $c = [I]$ 为抑制剂的浓度。整理后得到非活性靶标与活性靶标的比值为：\n$$ \\frac{[T_{inactive}]}{[T_{active}]} = \\frac{c^n}{K_d} $$\n\n保持活性的靶分子比例 $\\theta_{active}$ 定义为：\n$$ \\theta_{active} = \\frac{[T_{active}]}{[T]_{total}} = \\frac{[T_{active}]}{[T_{active}] + [T_{inactive}]} $$\n将分子和分母同除以 $[T_{active}]$ 得：\n$$ \\theta_{active} = \\frac{1}{1 + \\frac{[T_{inactive}]}{[T_{active}]}} $$\n代入质量作用定律的表达式：\n$$ \\theta_{active}(c) = \\frac{1}{1 + \\frac{c^n}{K_d}} $$\n问题定义了一个特征浓度，我们记为 $c_{50}$，即在该浓度下反应处于其渐近线的中点。这对应于一半靶标处于活性状态的点，即 $\\theta_{active}(c_{50}) = 0.5$。\n$$ 0.5 = \\frac{1}{1 + \\frac{c_{50}^n}{K_d}} $$\n求解 $K_d$ 得：\n$$ 1 + \\frac{c_{50}^n}{K_d} = 2 \\implies \\frac{c_{50}^n}{K_d} = 1 \\implies K_d = c_{50}^n $$\n因此，解离常数与半最大抑制浓度 $c_{50}$ 相关。将 $K_d = c_{50}^n$ 代回 $\\theta_{active}(c)$ 的方程中：\n$$ \\theta_{active}(c) = \\frac{1}{1 + \\frac{c^n}{c_{50}^n}} = \\frac{1}{1 + (c/c_{50})^n} $$\n问题陈述测得的 IFN 诱导 $y$ 是 $\\theta_{active}$ 的仿射变换。仿射变换是形式为 $y(c) = m \\cdot \\theta_{active}(c) + b$ 的线性函数。我们可以从边界条件确定常数 $m$ 和 $b$。\n令 $U$ 为上渐近线，表示在抑制剂浓度为零（$c=0$）时的最大 IFN 反应。当 $c=0$ 时，$\\theta_{active}(0) = 1$。\n$$ y(0) = U = m \\cdot 1 + b $$\n令 $L$ 为下渐近线，表示在饱和抑制剂浓度（$c \\to \\infty$）时的残余 IFN 反应。当 $c \\to \\infty$ 时，$\\theta_{active}(c) \\to 0$。\n$$ y(\\infty) = L = m \\cdot 0 + b \\implies b = L $$\n将 $b=L$ 代入第一个方程得 $U = m + L \\implies m = U - L$。\n因此，完整的剂量-反应模型为：\n$$ y(c) = (U - L) \\cdot \\theta_{active}(c) + L $$\n代入 $\\theta_{active}(c)$ 的表达式，得到最终的四参数函数：\n$$ y(c) = L + \\frac{U - L}{1 + (c/c_{50})^n} $$\n该函数将 IFN 诱导 $y$ 描述为抑制剂浓度 $c$ 的函数，包含四个参数：下渐近线 $L$、上渐近线 $U$、半最大抑制浓度 $c_{50}$ 和量化协同性的 Hill 斜率指数 $n$。\n\n**参数估计与分类**\n每个数据集的参数 $(U, L, c_{50}, n)$ 是通过使用非线性最小二乘法将推导出的模型拟合到实验数据 $(c_i, y_i)$ 来确定的。这涉及找到使残差平方和 $\\sum_i (y_i - y(c_i))^2$ 最小化的参数值。这是通过 `scipy.optimize.curve_fit` 中实现的 Levenberg-Marquardt 算法进行数值计算的。为了物理真实性和数值稳定性，对所有四个参数都施加了正值约束：$U>0$、$L>0$、$c_{50}>0$ 和 $n>0$。初始参数猜测值是根据数据自动确定的：$U_0$ 是最大响应，$L_0$ 是最小响应，$n_0=1$，而 $c_{50,0}$ 是对应于最接近中点 $(U_0+L_0)/2$ 响应水平的浓度。\n\n估计之后，根据指定的规则基于拟合的斜率指数 $\\hat{n}$ 对协同性进行分类。估计的参数 $\\hat{n}$ 和 $\\widehat{c_{50}}$ 在最终报告中四舍五入到两位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Derives, fits, and reports parameters for a dose-response model of IFN inhibition.\n    \"\"\"\n\n    # Define the 4-parameter logistic model for inhibition\n    def four_param_logistic(c, U, L, c50, n):\n        \"\"\"\n        Calculates the response y for a given concentration c.\n        U: Upper asymptote\n        L: Lower asymptote\n        c50: Half-maximal inhibitory concentration\n        n: Hill slope exponent\n        \"\"\"\n        # A small epsilon to prevent division by zero or log(0) if c50 is near zero\n        # although bounds should prevent this.\n        c50_safe = c50 + 1e-12\n        return L + (U - L) / (1 + (c / c50_safe)**n)\n\n    # Shared inhibitor concentrations (in nM)\n    concentrations = np.array([0, 1, 3, 10, 30, 100, 300, 1000], dtype=float)\n\n    # Test suite datasets\n    test_cases = [\n        # Dataset A\n        np.array([100.0, 99.1089108910891, 92.5688073394495, 55.0, 19.0, 10.8910891089109, 10.0998890110988, 10.0089991000899]),\n        # Dataset B\n        np.array([120.0, 118.0392156862745, 114.3396226415094, 103.3333333333333, 82.5, 53.3333333333333, 34.2857142857143, 24.7619047619048]),\n        # Dataset C\n        np.array([80.0, 79.9999074074074, 79.992500749925, 79.0853658536585, 42.5, 5.6026, 5.007499250075, 5.00006075]),\n        # Dataset D\n        np.array([50.0, 49.98001998, 49.8966, 49.3867, 47.174, 40.0, 33.228, 30.613]),\n    ]\n    \n    results = []\n    \n    for y_data in test_cases:\n        # Provide robust initial guesses for the parameters\n        U_guess = y_data[0]\n        L_guess = y_data[-1]\n        n_guess = 1.0\n        \n        # Guess c50 by finding the concentration where the response is closest to the midpoint\n        midpoint_response = (U_guess + L_guess) / 2.0\n        # Account for cases where the data might not cross the midpoint\n        closest_idx = np.argmin(np.abs(y_data - midpoint_response))\n        c50_guess = concentrations[closest_idx]\n        if c50_guess == 0: # Fallback if midpoint is closest to c=0\n           c50_guess = np.median(concentrations[concentrations > 0])\n           \n        p0 = [U_guess, L_guess, c50_guess, n_guess]\n        \n        # Enforce positivity constraints on parameters as they are physical quantities\n        bounds = ([0, 0, 1e-9, 1e-9], [np.inf, np.inf, np.inf, np.inf])\n\n        # Perform nonlinear least-squares fitting\n        try:\n            popt, _ = curve_fit(four_param_logistic, concentrations, y_data, p0=p0, bounds=bounds, maxfev=5000)\n            c50_hat = popt[2]\n            n_hat = popt[3]\n        except RuntimeError:\n            # In case of fitting failure, which is not expected for this data\n            c50_hat, n_hat = np.nan, np.nan\n\n        # Classify cooperativity\n        if n_hat > 1.2:\n            coop_code = 1\n        elif n_hat >= 0.8:\n            coop_code = 0\n        else:\n            coop_code = -1\n            \n        # Append formatted results to the list\n        results.append(f\"{n_hat:.2f}\")\n        results.append(f\"{c50_hat:.2f}\")\n        results.append(str(coop_code))\n\n    # Format and print the final output string\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2510298"}]}