{"hands_on_practices": [{"introduction": "在规划任何单细胞转录组学实验时，一个至关重要的首要步骤是确定所需的测序深度，以确保能够可靠地检测到感兴趣的稀有细胞群体。这项练习 [@problem_id:2851229] 将指导你应用基本的概率论原理，推导出计算所需细胞数量的通用公式，这是实验设计中的一项核心技能。", "problem": "一位研究人员正在设计一项单细胞RNA测序（scRNA-seq）实验，以检测异质组织中的一种稀有细胞类型。假设组织足够大，以至于无放回抽样可以近似为有放回的独立抽样，并且每个捕获的细胞是稀有类型的概率为 $f$，其中 $0<f<1$。\n\n导出需要测序的最小细胞数 $n$ 的通用公式，以确保以至少 $0.95$ 的概率检测到至少一个稀有细胞。", "solution": "必须首先对问题陈述进行严格验证。\n\n**第一步：提取已知条件**\n- 捕获单个细胞的过程近似为一个独立的伯努利试验。\n- 捕获的细胞属于稀有类型的概率记为 $f$，其中 $0  f  1$。\n- 将要测序的细胞总数为 $n$。\n- 成功的实验定义为捕获到至少一个稀有细胞。\n- 条件是成功概率必须至少为 $0.95$。\n- 目标是推导满足此条件的最小整数 $n$。\n\n**第二步：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题使用二项分布对细胞抽样进行建模，这在统计基因组学和群体遗传学中是解决此类问题的标准且根本正确的方法。对于大群体（组织样本的典型情况），有放回抽样的假设是有效的近似。\n- **良态问题**：问题陈述清晰。它提供了所有必要的参数（$f$ 和概率阈值 $0.95$），以确定 $n$ 的唯一最小整数解。\n- **客观性**：该问题使用精确、客观的数学语言进行表述。诸如“概率”、“至少一个”和“最小整数”等术语是明确无误的。\n\n该问题没有任何缺陷。它在科学上不是不合理的、不完整的、矛盾的或非良态的。这是一个标准的、可形式化的问题，属于应用概率论，并与其所述领域相关。\n\n**第三步：结论与行动**\n问题是有效的。我们现在开始进行推导。\n\n任务是找到需要测序的最小细胞整数数量 $n$，以确保检测到至少一个稀有细胞的概率不低于 $0.95$。稀有细胞的比例是 $f$。\n\n设 $X$ 为在 $n$ 个细胞样本中检测到的稀有细胞数量的随机变量。每次细胞捕获都是一次独立的伯努利试验，成功（检测到稀有细胞）的概率等于 $f$。因此，随机变量 $X$ 服从二项分布，记为 $X \\sim \\text{Binomial}(n, f)$。\n\n二项分布的概率质量函数由下式给出：\n$$P(X=k) = \\binom{n}{k} f^{k} (1-f)^{n-k}$$\n其中 $k$ 是成功的次数，可以是 $0$ 到 $n$ 之间的任意整数。\n\n问题中陈述的条件是，检测到至少一个稀有细胞的概率至少为 $0.95$。在数学上，这表示为：\n$$P(X \\ge 1) \\ge 0.95$$\n\n使用互补事件（即检测到零个稀有细胞的事件，$P(X=0)$）来计算此概率更为直接。其关系为：\n$$P(X \\ge 1) = 1 - P(X=0)$$\n\n将此代入我们的不等式得到：\n$$1 - P(X=0) \\ge 0.95$$\n\n现在，我们使用二项概率质量函数，令 $k=0$，来计算 $P(X=0)$：\n$$P(X=0) = \\binom{n}{0} f^{0} (1-f)^{n-0} = 1 \\cdot 1 \\cdot (1-f)^{n} = (1-f)^{n}$$\n\n将此结果代回不等式，得到：\n$$1 - (1-f)^{n} \\ge 0.95$$\n\n我们现在必须解这个关于 $n$ 的不等式。\n首先，重新排列各项以分离出包含 $n$ 的表达式：\n$$-(1-f)^{n} \\ge 0.95 - 1$$\n$$-(1-f)^{n} \\ge -0.05$$\n两边同乘以 $-1$ 会反转不等号：\n$$(1-f)^{n} \\le 0.05$$\n\n为了解出指数 $n$，我们对两边取自然对数。由于 $0  f  1$，指数的底数 $(1-f)$ 严格介于 $0$ 和 $1$ 之间。不等式两边的 $(1-f)^{n}$ 和 $0.05$ 均为正数，因此对数是良定义的。\n$$\\ln\\left((1-f)^{n}\\right) \\le \\ln(0.05)$$\n使用对数性质 $\\ln(a^b) = b\\ln(a)$，我们得到：\n$$n \\ln(1-f) \\le \\ln(0.05)$$\n\n为了分离出 $n$，我们必须除以 $\\ln(1-f)$。如前所述，因为 $0  (1-f)  1$，其自然对数 $\\ln(1-f)$ 是一个负数。不等式两边同时除以一个负数需要反转不等号的方向：\n$$n \\ge \\frac{\\ln(0.05)}{\\ln(1-f)}$$\n\n问题要求满足此条件的最小*整数* $n$。$n$ 的解集是从 $\\frac{\\ln(0.05)}{\\ln(1-f)}$ 开始的连续区间。属于该集合的最小整数是此下界的上取整。上取整函数，记作 $\\lceil x \\rceil$，给出大于或等于 $x$ 的最小整数。\n\n因此，最小整数 $n$ 是：\n$$n_{\\min} = \\left\\lceil \\frac{\\ln(0.05)}{\\ln(1-f)} \\right\\rceil$$\n\n这是关于稀有细胞比例 $f$ 的最小细胞数 $n$ 的最终闭合形式表达式。", "answer": "$$\n\\boxed{\n\\left\\lceil \\frac{\\ln(0.05)}{\\ln(1-f)} \\right\\rceil\n}\n$$", "id": "2851229"}, {"introduction": "获得原始测序数据后，首要任务是进行质量控制，区分高质量的活细胞与因细胞死亡或实验操作压力产生的低质量数据。本练习 [@problem_id:2851235] 演示了如何综合利用关键的质量控制指标，并通过拟合高斯混合模型来建立一个有统计学依据的阈值，从而有效地滤除低质量的细胞。", "problem": "一次单细胞RNA测序 (scRNA-seq) 实验产生一个计数矩阵，其条目 $c_{ij}$ 表示细胞 $i$ 中基因 $j$ 的唯一分子标识符 (UMI) 分子的数量。对于每个细胞 $i$，根据单细胞转录组学的核心定义，定义三个质量控制指标：\n\n- 线粒体读段分数 $f_{\\mathrm{mt},i}$ 是比对到已注释线粒体基因集的UMI计数与细胞 $i$ 中总UMI计数的比率，即 $f_{\\mathrm{mt},i} = \\frac{c_{i,\\mathrm{mt}}}{c_{i,\\mathrm{tot}}}$，其中 $c_{i,\\mathrm{tot}} = \\sum_{j} c_{ij}$ 且 $c_{i,\\mathrm{mt}}$ 是对线粒体基因的求和。\n- 检测到的基因数量 $g_i$ 是细胞 $i$ 中至少有一个UMI的基因计数，即 $g_i = \\sum_{j} \\mathbf{1}\\{c_{ij} > 0\\}$。\n- 总UMI计数 $u_i$ 是 $u_i = \\sum_{j} c_{ij}$。\n\n一种常用的区分低质量和高质量细胞的方法是，首先将这些指标汇总成一个标量分数，然后拟合一个双组分混合模型。考虑标量汇总分数\n$$\ns_i = \\ln(1+u_i) + \\ln(1+g_i) - 4\\, f_{\\mathrm{mt},i}.\n$$\n假设在给定的数据集中，$\\{s_i\\}$ 的经验分布可以很好地由一个双组分高斯混合模型近似，该模型反映了两个潜在类别：低质量细胞 ($\\mathrm{L}$) 和高质量细胞 ($\\mathrm{H}$)。具体来说，假设 $s \\mid \\mathrm{L} \\sim \\mathcal{N}(\\mu_{\\mathrm{L}}, \\sigma^2)$ 和 $s \\mid \\mathrm{H} \\sim \\mathcal{N}(\\mu_{\\mathrm{H}}, \\sigma^2)$，两者方差相等，且先验类别概率为 $\\pi_{\\mathrm{L}}$ 和 $\\pi_{\\mathrm{H}} = 1 - \\pi_{\\mathrm{L}}$。对于一个特定的实验，设\n$$\n\\mu_{\\mathrm{L}} = 6.0,\\quad \\mu_{\\mathrm{H}} = 10.5,\\quad \\sigma = 0.8,\\quad \\pi_{\\mathrm{L}} = 0.35,\\quad \\pi_{\\mathrm{H}} = 0.65.\n$$\n\n仅从以上定义、高斯概率密度函数的形式以及在0-1损失和相等错分成本下的贝叶斯法则出发，推导贝叶斯最优决策阈值 $t$。该阈值用于根据规则“如果 $s \\ge t$ 则分类为高质量，否则分类为低质量”来区分低质量和高质量细胞。\n\n将 $t$ 的数值报告为一个纯数字（无单位）。将你的答案四舍五入到4位有效数字。", "solution": "该问题要求推导贝叶斯最优决策阈值 $t$，用于根据标量分数 $s$ 将细胞分为低质量 ($\\mathrm{L}$) 或高质量 ($\\mathrm{H}$) 类别。决策规则是：如果一个细胞的分数 $s$ 大于或等于阈值 $t$，则将其分类为高质量，否则分类为低质量。该分析基于 $s$ 分布的双组分高斯混合模型。\n\n首先，我们必须对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 质量控制指标定义：\n  - 线粒体读段分数：$f_{\\mathrm{mt},i} = \\frac{c_{i,\\mathrm{mt}}}{c_{i,\\mathrm{tot}}}$，其中 $c_{i,\\mathrm{tot}} = \\sum_{j} c_{ij}$。\n  - 检测到的基因数量：$g_i = \\sum_{j} \\mathbf{1}\\{c_{ij} > 0\\}$。\n  - 总UMI计数：$u_i = \\sum_{j} c_{ij}$。\n- 标量汇总分数：$s_i = \\ln(1+u_i) + \\ln(1+g_i) - 4\\, f_{\\mathrm{mt},i}$。\n- 分数 $s$ 的潜在类条件分布：\n  - 低质量细胞：$s \\mid \\mathrm{L} \\sim \\mathcal{N}(\\mu_{\\mathrm{L}}, \\sigma^2)$。\n  - 高质量细胞：$s \\mid \\mathrm{H} \\sim \\mathcal{N}(\\mu_{\\mathrm{H}}, \\sigma^2)$。\n- 先验类别概率：$\\pi_{\\mathrm{L}}$ 和 $\\pi_{\\mathrm{H}} = 1 - \\pi_{\\mathrm{L}}$。\n- 具体参数值：\n  - $\\mu_{\\mathrm{L}} = 6.0$\n  - $\\mu_{\\mathrm{H}} = 10.5$\n  - $\\sigma = 0.8$\n  - $\\pi_{\\mathrm{L}} = 0.35$\n  - $\\pi_{\\mathrm{H}} = 0.65$\n- 决策标准：在0-1损失函数和相等错分成本下的贝叶斯最优决策规则。\n- 决策规则结构：如果 $s \\ge t$ 则分类为 $\\mathrm{H}$，如果 $s  t$ 则分类为 $\\mathrm{L}$。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它使用了单细胞转录组学领域的标准质量控制指标和建模方法（高斯混合模型）。该问题是适定的，提供了所有必要的参数和一个植根于统计决策理论的明确目标。语言客观、精确。问题是自洽的且数学上一致。因此，该问题被认为是有效的。\n\n步骤3：结论与行动\n问题有效。我们继续进行求解。\n\n目标是找到最小化错分概率的决策阈值 $t$。对于具有相等错分成本的0-1损失函数，贝叶斯最优决策规则是将观测值 $s$ 分配给具有最高后验概率的类别。决策规则是：如果 $P(\\mathrm{H}|s) > P(\\mathrm{L}|s)$ 则分类为 $\\mathrm{H}$，如果 $P(\\mathrm{L}|s) > P(\\mathrm{H}|s)$ 则分类为 $\\mathrm{L}$。决策阈值 $t$ 是后验概率相等的 $s$ 值：\n$$\nP(\\mathrm{H}|s=t) = P(\\mathrm{L}|s=t)\n$$\n根据贝叶斯法则，类别 $C \\in \\{\\mathrm{L}, \\mathrm{H}\\}$ 的后验概率由 $P(C|s) = \\frac{p(s|C)P(C)}{p(s)}$ 给出，其中 $p(s|C)$ 是类条件概率密度（似然），$P(C)$ 是该类的先验概率，而 $p(s)$ 是 $s$ 的边缘密度。在我们的符号系统中，$P(C)$ 对应于 $\\pi_C$。\n\n在 $s=t$ 处后验概率相等意味着：\n$$\n\\frac{p(t|\\mathrm{H})\\pi_{\\mathrm{H}}}{p(t)} = \\frac{p(t|\\mathrm{L})\\pi_{\\mathrm{L}}}{p(t)}\n$$\n边缘密度 $p(t)$ 不为零并可以消去，从而得到由先验加权的似然之间的等式：\n$$\np(t|\\mathrm{H})\\pi_{\\mathrm{H}} = p(t|\\mathrm{L})\\pi_{\\mathrm{L}}\n$$\n问题陈述，类条件分布是具有相等方差的高斯分布：$s \\mid \\mathrm{H} \\sim \\mathcal{N}(\\mu_{\\mathrm{H}}, \\sigma^2)$ 和 $s \\mid \\mathrm{L} \\sim \\mathcal{N}(\\mu_{\\mathrm{L}}, \\sigma^2)$。高斯分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数 (PDF) 是 $p(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$。将PDF代入我们的方程得到：\n$$\n\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(t-\\mu_{\\mathrm{H}})^2}{2\\sigma^2}\\right)\\right) \\pi_{\\mathrm{H}} = \\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(t-\\mu_{\\mathrm{L}})^2}{2\\sigma^2}\\right)\\right) \\pi_{\\mathrm{L}}\n$$\n归一化常数 $\\frac{1}{\\sqrt{2\\pi\\sigma^2}}$ 在两边是相同的，可以消去。我们剩下：\n$$\n\\exp\\left(-\\frac{(t-\\mu_{\\mathrm{H}})^2}{2\\sigma^2}\\right) \\pi_{\\mathrm{H}} = \\exp\\left(-\\frac{(t-\\mu_{\\mathrm{L}})^2}{2\\sigma^2}\\right) \\pi_{\\mathrm{L}}\n$$\n为了求解 $t$，我们对两边取自然对数：\n$$\n\\ln\\left(\\exp\\left(-\\frac{(t-\\mu_{\\mathrm{H}})^2}{2\\sigma^2}\\right) \\pi_{\\mathrm{H}}\\right) = \\ln\\left(\\exp\\left(-\\frac{(t-\\mu_{\\mathrm{L}})^2}{2\\sigma^2}\\right) \\pi_{\\mathrm{L}}\\right)\n$$\n$$\n-\\frac{(t-\\mu_{\\mathrm{H}})^2}{2\\sigma^2} + \\ln(\\pi_{\\mathrm{H}}) = -\\frac{(t-\\mu_{\\mathrm{L}})^2}{2\\sigma^2} + \\ln(\\pi_{\\mathrm{L}})\n$$\n重新整理各项以分离出 $t$：\n$$\n\\frac{(t-\\mu_{\\mathrm{L}})^2 - (t-\\mu_{\\mathrm{H}})^2}{2\\sigma^2} = \\ln(\\pi_{\\mathrm{L}}) - \\ln(\\pi_{\\mathrm{H}})\n$$\n$$\n(t-\\mu_{\\mathrm{L}})^2 - (t-\\mu_{\\mathrm{H}})^2 = 2\\sigma^2 \\ln\\left(\\frac{\\pi_{\\mathrm{L}}}{\\pi_{\\mathrm{H}}}\\right)\n$$\n展开二次项：\n$$\n(t^2 - 2t\\mu_{\\mathrm{L}} + \\mu_{\\mathrm{L}}^2) - (t^2 - 2t\\mu_{\\mathrm{H}} + \\mu_{\\mathrm{H}}^2) = 2\\sigma^2 \\ln\\left(\\frac{\\pi_{\\mathrm{L}}}{\\pi_{\\mathrm{H}}}\\right)\n$$\n$$\n2t\\mu_{\\mathrm{H}} - 2t\\mu_{\\mathrm{L}} + \\mu_{\\mathrm{L}}^2 - \\mu_{\\mathrm{H}}^2 = 2\\sigma^2 \\ln\\left(\\frac{\\pi_{\\mathrm{L}}}{\\pi_{\\mathrm{H}}}\\right)\n$$\n$$\n2t(\\mu_{\\mathrm{H}} - \\mu_{\\mathrm{L}}) = \\mu_{\\mathrm{H}}^2 - \\mu_{\\mathrm{L}}^2 + 2\\sigma^2 \\ln\\left(\\frac{\\pi_{\\mathrm{L}}}{\\pi_{\\mathrm{H}}}\\right)\n$$\n对平方差 $\\mu_{\\mathrm{H}}^2 - \\mu_{\\mathrm{L}}^2 = (\\mu_{\\mathrm{H}} - \\mu_{\\mathrm{L}})(\\mu_{\\mathrm{H}} + \\mu_{\\mathrm{L}})$ 进行因式分解，并除以 $2(\\mu_{\\mathrm{H}} - \\mu_{\\mathrm{L}})$（因为 $\\mu_{\\mathrm{H}} \\neq \\mu_{\\mathrm{L}}$）：\n$$\nt = \\frac{(\\mu_{\\mathrm{H}} - \\mu_{\\mathrm{L}})(\\mu_{\\mathrm{H}} + \\mu_{\\mathrm{L}})}{2(\\mu_{\\mathrm{H}} - \\mu_{\\mathrm{L}})} + \\frac{2\\sigma^2}{2(\\mu_{\\mathrm{H}} - \\mu_{\\mathrm{L}})} \\ln\\left(\\frac{\\pi_{\\mathrm{L}}}{\\pi_{\\mathrm{H}}}\\right)\n$$\n这简化为阈值的通用表达式：\n$$\nt = \\frac{\\mu_{\\mathrm{H}} + \\mu_{\\mathrm{L}}}{2} + \\frac{\\sigma^2}{\\mu_{\\mathrm{H}} - \\mu_{\\mathrm{L}}} \\ln\\left(\\frac{\\pi_{\\mathrm{L}}}{\\pi_{\\mathrm{H}}}\\right)\n$$\n现在，我们代入给定的数值：$\\mu_{\\mathrm{L}} = 6.0$，$\\mu_{\\mathrm{H}} = 10.5$，$\\sigma = 0.8$，$\\pi_{\\mathrm{L}} = 0.35$ 和 $\\pi_{\\mathrm{H}} = 0.65$。\n$$\nt = \\frac{10.5 + 6.0}{2} + \\frac{(0.8)^2}{10.5 - 6.0} \\ln\\left(\\frac{0.35}{0.65}\\right)\n$$\n$$\nt = \\frac{16.5}{2} + \\frac{0.64}{4.5} \\ln\\left(\\frac{7}{13}\\right)\n$$\n$$\nt = 8.25 + \\frac{0.64}{4.5} \\ln\\left(\\frac{7}{13}\\right)\n$$\n我们现在计算数值：\n$$\n\\ln\\left(\\frac{7}{13}\\right) \\approx -0.6190392\n$$\n$$\n\\frac{0.64}{4.5} \\approx 0.1422222\n$$\n$$\nt \\approx 8.25 + (0.1422222) \\times (-0.6190392)\n$$\n$$\nt \\approx 8.25 - 0.0880354\n$$\n$$\nt \\approx 8.1619646\n$$\n问题要求答案四舍五入到4位有效数字。\n$$\nt \\approx 8.162\n$$\n所得阈值 $t$ 是分数 $s$ 的边界值。根据贝叶斯最优决策规则，任何 $s \\ge 8.162$ 的细胞将被分类为高质量，任何 $s  8.162$ 的细胞将被分类为低质量。", "answer": "$$\n\\boxed{8.162}\n$$", "id": "2851235"}, {"introduction": "单细胞测序中一个常见的技术性假象是“双细胞”（doublet），即单个微液滴中捕获了两个细胞，这会干扰下游分析。本练习 [@problem_id:2851174] 探讨了如何基于泊松分布模型来构建双细胞的预期表达谱，并设计一个线性判别分类器来区分它们与真实的单细胞，这是确保后续分析准确性的关键一步。", "problem": "一项使用唯一分子标识符 (UMI) 计数的单细胞核糖核酸测序 (single-cell RNA-seq) 实验，其产生的每个基因的整数计数，在给定细胞的转录本分数谱和文库大小的条件下，可以建模为独立的泊松随机变量。考虑两种细胞类型，记为 A 型和 B 型，它们在 $G=3$ 个基因上具有已知的转录本分数谱：\n- A 型：$p_{A}=\\big(0.5,\\,0.3,\\,0.2\\big)$，\n- B 型：$p_{B}=\\big(0.2,\\,0.5,\\,0.3\\big)$，\n其中 $\\sum_{g=1}^{3}p_{A,g}=1$ 且 $\\sum_{g=1}^{3}p_{B,g}=1$。一个文库大小为 $L$、类型为 $k\\in\\{A,B\\}$ 的纯细胞，其基因计数为 $X_{g}\\sim\\text{Poisson}(L\\,p_{k,g})$，且各基因 $g$ 之间相互独立。\n\n假设一个双细胞是两个独立捕获的细胞的总和。考虑两种文库大小固定的双细胞场景：一个由两个 A 型细胞（$L_{1}=4000$ 和 $L_{2}=6000$）组成的同型双细胞，以及一个由一个 A 型细胞（$L_{1}=4000$）和一个 B 型细胞（$L_{2}=6000$）组成的异型双细胞。对于每个双细胞，其观测到的计数向量是其组成的两个细胞的计数向量之和。\n\n任务：\n1. 仅使用泊松模型的基本性质和独立计数的可加性，计算同型双细胞和异型双细胞的期望基因表达向量（每个基因的平均计数）。\n2. 使用基于大计数的合理性的泊松模型高斯近似，并假设两种双细胞类别具有共同的对角协方差（其值等于跨类别的合并均值），设计一个线性判别器来区分同型和异型双细胞。假设类别先验概率相等且错分成本相等。从第一性原理推导出通过将观测值 $x\\in\\mathbb{R}^{3}$ 投影到一个权重向量上并对结果进行阈值化而得到的标量决策规则。\n3. 在所述假设下，计算该投影上的贝叶斯最优标量阈值 $t^{\\ast}$，以最小化分类误差。\n\n将最终答案表示为 $t^{\\ast}$ 的精确值（以 UMI 计数为单位），在最终的方框答案中不要包含单位。", "solution": "该问题要求推导一个线性判别器，用于对来自单细胞 RNA 测序数据的两种细胞双细胞进行分类，并计算最优决策阈值。解法将按规定从第一性原理构建。\n\n该问题是有效的。它在科学上基于 UMI 计数的标准泊松模型，数据充分且问题适定，并且表述客观。\n\n设两个类别为同型 ($H_O$) 和异型 ($H_E$)。设 $x \\in \\mathbb{R}^{3}$ 为观测到的基因计数向量。\n\n**任务 1：期望基因表达向量**\n\n对于一个文库大小为 $L$ 的 $k \\in \\{A, B\\}$ 型细胞，单个基因 $g$ 的期望计数是 $E[X_g] = L \\cdot p_{k,g}$，因为 $X_g \\sim \\text{Poisson}(L \\cdot p_{k,g})$。一个双细胞的计数向量是其两个组成细胞（假设独立）的计数向量之和。根据期望的线性性质，双细胞的期望计数向量是两个独立细胞的期望计数向量之和。\n\n对于同型双细胞 ($H_O$)，我们有两个 A 型细胞，文库大小分别为 $L_1=4000$ 和 $L_2=6000$。其期望计数向量 $\\mu_{H_O}$ 为：\n$$ \\mu_{H_O} = L_1 p_A + L_2 p_A = (L_1 + L_2) p_A $$\n代入给定值：\n$$ \\mu_{H_O} = (4000 + 6000) \\begin{pmatrix} 0.5 \\\\ 0.3 \\\\ 0.2 \\end{pmatrix} = 10000 \\begin{pmatrix} 0.5 \\\\ 0.3 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} 5000 \\\\ 3000 \\\\ 2000 \\end{pmatrix} $$\n\n对于异型双细胞 ($H_E$)，我们有一个 A 型细胞（文库大小 $L_1=4000$）和一个 B 型细胞（文库大小 $L_2=6000$）。其期望计数向量 $\\mu_{H_E}$ 为：\n$$ \\mu_{H_E} = L_1 p_A + L_2 p_B $$\n代入给定值：\n$$ \\mu_{H_E} = 4000 \\begin{pmatrix} 0.5 \\\\ 0.3 \\\\ 0.2 \\end{pmatrix} + 6000 \\begin{pmatrix} 0.2 \\\\ 0.5 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 2000 \\\\ 1200 \\\\ 800 \\end{pmatrix} + \\begin{pmatrix} 1200 \\\\ 3000 \\\\ 1800 \\end{pmatrix} = \\begin{pmatrix} 3200 \\\\ 4200 \\\\ 2600 \\end{pmatrix} $$\n\n**任务 2：线性判别器设计**\n\n问题指定使用高斯近似来处理计数分布，其合理性在于期望计数（均值参数 $\\lambda$）很大。因此，观测值 $x$ 的类条件分布可建模为多元正态分布：\n$$ x | H_O \\sim \\mathcal{N}(\\mu_{H_O}, \\Sigma) $$\n$$ x | H_E \\sim \\mathcal{N}(\\mu_{H_E}, \\Sigma) $$\n假设存在一个公共的协方差矩阵 $\\Sigma$。问题将 $\\Sigma$ 定义为一个对角矩阵，其对角线元素等于跨类别的合并均值。合并均值向量为 $\\mu_{pool} = \\frac{1}{2}(\\mu_{H_O} + \\mu_{H_E})$。\n$$ \\mu_{pool} = \\frac{1}{2} \\left( \\begin{pmatrix} 5000 \\\\ 3000 \\\\ 2000 \\end{pmatrix} + \\begin{pmatrix} 3200 \\\\ 4200 \\\\ 2600 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 8200 \\\\ 7200 \\\\ 4600 \\end{pmatrix} = \\begin{pmatrix} 4100 \\\\ 3600 \\\\ 2300 \\end{pmatrix} $$\n因此，协方差矩阵为：\n$$ \\Sigma = \\text{diag}(\\mu_{pool}) = \\begin{pmatrix} 4100  0  0 \\\\ 0  3600  0 \\\\ 0  0  2300 \\end{pmatrix} $$\n逆协方差矩阵为：\n$$ \\Sigma^{-1} = \\begin{pmatrix} 1/4100  0  0 \\\\ 0  1/3600  0 \\\\ 0  0  1/2300 \\end{pmatrix} $$\n对于具有相等类别先验概率（$P(H_O)=P(H_E)$）和相等错分成本的线性判别分析 (LDA)，贝叶斯最优决策规则是将观测值 $x$ 分类到具有更高后验概率的类别，这简化为具有更高似然的类别。如果 $p(x|H_O) > p(x|H_E)$，我们就将 $x$ 分类到 $H_O$。取对数后，这等价于 $\\ln p(x|H_O) > \\ln p(x|H_E)$。\n类别 $k$ 的对数似然为：\n$$ \\ln p(x|k) = -\\frac{G}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\det(\\Sigma)| - \\frac{1}{2}(x - \\mu_k)^T \\Sigma^{-1} (x - \\mu_k) $$\n比较 $\\ln p(x|H_O)$ 和 $\\ln p(x|H_E)$，与类别均值 $\\mu_k$ 无关的项会相互抵消。决策规则简化为选择使 $(x - \\mu_k)^T \\Sigma^{-1} (x - \\mu_k)$ 最小化的类别。如果满足以下条件，我们选择 $H_O$：\n$$ (x - \\mu_{H_E})^T \\Sigma^{-1} (x - \\mu_{H_E}) > (x - \\mu_{H_O})^T \\Sigma^{-1} (x - \\mu_{H_O}) $$\n展开两侧：\n$$ x^T \\Sigma^{-1} x - 2x^T \\Sigma^{-1} \\mu_{H_E} + \\mu_{H_E}^T \\Sigma^{-1} \\mu_{H_E} > x^T \\Sigma^{-1} x - 2x^T \\Sigma^{-1} \\mu_{H_O} + \\mu_{H_O}^T \\Sigma^{-1} \\mu_{H_O} $$\n经过简化和重排，我们得到一个线性决策规则：\n$$ 2x^T \\Sigma^{-1} (\\mu_{H_O} - \\mu_{H_E}) > \\mu_{H_O}^T \\Sigma^{-1} \\mu_{H_O} - \\mu_{H_E}^T \\Sigma^{-1} \\mu_{H_E} $$\n其形式为 $w^T x > t^*$，即将观测值 $x$ 投影到权重向量 $w$ 上，并与阈值 $t^*$ 进行比较。\n权重向量为 $w = \\Sigma^{-1}(\\mu_{H_O} - \\mu_{H_E})$。标量决策规则是计算投影 $w^T x$，如果它超过阈值 $t^*$，则分类为 $H_O$。\n\n**任务 3：贝叶斯最优阈值计算**\n\n根据前面的推导，贝叶斯最优阈值 $t^*$ 为：\n$$ t^* = \\frac{1}{2} (\\mu_{H_O}^T \\Sigma^{-1} \\mu_{H_O} - \\mu_{H_E}^T \\Sigma^{-1} \\mu_{H_E}) $$\n这也可以写成 $t^* = w^T \\left( \\frac{\\mu_{H_O}+\\mu_{H_E}}{2} \\right) = w^T \\mu_{pool}$。\n考虑到问题对 $\\Sigma = \\text{diag}(\\mu_{pool})$ 的特定定义，$t^*$ 的计算大大简化了。\n$$ t^* = w^T \\mu_{pool} = (\\Sigma^{-1}(\\mu_{H_O} - \\mu_{H_E}))^T \\mu_{pool} = (\\mu_{H_O} - \\mu_{H_E})^T (\\Sigma^{-1})^T \\mu_{pool} $$\n由于 $\\Sigma^{-1}$ 是对角矩阵，所以它是对称的，因此 $(\\Sigma^{-1})^T = \\Sigma^{-1}$。\n$$ t^* = (\\mu_{H_O} - \\mu_{H_E})^T \\Sigma^{-1} \\mu_{pool} $$\n这个点积的分量是 $(\\mu_{H_O,g} - \\mu_{H_E,g}) \\cdot \\frac{1}{\\mu_{pool,g}} \\cdot \\mu_{pool,g}$。\n因此，阈值简化为均值向量各分量之差的总和：\n$$ t^* = \\sum_{g=1}^{3} (\\mu_{H_O,g} - \\mu_{H_E,g}) $$\n这个和代表了两种双细胞类型的总期望文库大小之间的差异。\n$H_O$ 的总期望计数：\n$$ \\sum_{g=1}^{3} \\mu_{H_O,g} = \\sum_{g=1}^{3} (L_1+L_2)p_{A,g} = (L_1+L_2)\\sum_{g=1}^{3} p_{A,g} = (4000+6000)(1) = 10000 $$\n$H_E$ 的总期望计数：\n$$ \\sum_{g=1}^{3} \\mu_{H_E,g} = \\sum_{g=1}^{3} (L_1 p_{A,g} + L_2 p_{B,g}) = L_1\\sum_{g=1}^{3} p_{A,g} + L_2\\sum_{g=1}^{3} p_{B,g} = 4000(1) + 6000(1) = 10000 $$\n总期望计数是相同的。因此，阈值必须为零：\n$$ t^* = 10000 - 10000 = 0 $$\n为了验证这个结果，我们可以使用 $t^*$ 的初始公式进行完整的数值计算：\n我们来计算均值差向量 $\\Delta\\mu = \\mu_{H_O} - \\mu_{H_E}$：\n$$ \\Delta\\mu = \\begin{pmatrix} 5000 \\\\ 3000 \\\\ 2000 \\end{pmatrix} - \\begin{pmatrix} 3200 \\\\ 4200 \\\\ 2600 \\end{pmatrix} = \\begin{pmatrix} 1800 \\\\ -1200 \\\\ -600 \\end{pmatrix} $$\n权重向量为 $w = \\Sigma^{-1}\\Delta\\mu$：\n$$ w = \\begin{pmatrix} 1/4100  0  0 \\\\ 0  1/3600  0 \\\\ 0  0  1/2300 \\end{pmatrix} \\begin{pmatrix} 1800 \\\\ -1200 \\\\ -600 \\end{pmatrix} = \\begin{pmatrix} 1800/4100 \\\\ -1200/3600 \\\\ -600/2300 \\end{pmatrix} = \\begin{pmatrix} 18/41 \\\\ -1/3 \\\\ -6/23 \\end{pmatrix} $$\n阈值为 $t^* = w^T \\mu_{pool}$：\n$$ t^* = \\begin{pmatrix} 18/41  -1/3  -6/23 \\end{pmatrix} \\begin{pmatrix} 4100 \\\\ 3600 \\\\ 2300 \\end{pmatrix} $$\n$$ t^* = (\\frac{18}{41})(4100) - (\\frac{1}{3})(3600) - (\\frac{6}{23})(2300) $$\n$$ t^* = 18 \\times 100 - 1 \\times 1200 - 6 \\times 100 = 1800 - 1200 - 600 = 0 $$\n计算结果一致。最优阈值为零。", "answer": "$$\\boxed{0}$$", "id": "2851174"}]}