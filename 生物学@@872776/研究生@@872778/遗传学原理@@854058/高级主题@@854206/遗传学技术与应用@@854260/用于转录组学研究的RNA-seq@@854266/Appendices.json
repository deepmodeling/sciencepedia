{"hands_on_practices": [{"introduction": "任何转录组学分析的基石都是高质量的测序数据。本练习将介绍用于量化碱基识别准确性的行业标准——Phred质量分数。通过这个实践，您将学习如何将这些抽象的分数转化为一个具体的衡量标准：一个测序读段中的预期错误数，从而将数据质量的概念变得更加具象化和可计算。[@problem_id:2848935]", "problem": "一个实验室对真核转录组进行核糖核酸测序（RNA-seq），生成长度为 $L=150$ 个核苷酸的单端读长。测序仪报告了该数据集的以下逐周期碱基检出质量摘要：对于周期 $1$ 至 $60$，Phred质量中位数为 $Q=36$；对于周期 $61$ 至 $120$，Phred质量中位数为 $Q=32$；对于周期 $121$ 至 $150$，Phred质量中位数为 $Q=25$。假设为了本次计算，给定周期范围内的每个位置都具有所述的Phred质量分数。\n\n仅使用将Phred质量分数与碱基检出错误概率及期望值联系起来的标准定义和原理，从第一性原理推导：\n- 这条读长中每个碱基的预期碱基检出错误率，在所有 $L=150$ 个位置上取平均值；以及\n- 每条读长的预期碱基检出错误数。\n\n将您的最终答案报告为一个等于每条读长的预期碱基检出错误数的实数，以小数形式表示（而非百分比），并四舍五入到四位有效数字。无需单位。", "solution": "经评估，问题陈述有效。它在科学上基于生物信息学的标准原理，特别是用于DNA/RNA测序的Phred质量分数。问题提法得当、客观，并包含推导唯一解所需的所有信息。不存在矛盾、歧义或逻辑缺陷。我们可以开始推导。\n\n将Phred质量分数 $Q$ 与碱基检出错误的概率 $P$ 联系起来的基本原理由以下定义给出：\n$$ Q = -10 \\log_{10}(P) $$\n根据这个定义，我们必须首先推导出错误概率 $P$ 作为 $Q$ 的函数的表达式。整理该方程，我们得到：\n$$ P = 10^{-Q/10} $$\n这个概率 $P$ 代表了质量分数为 $Q$ 的单一碱基检出的预期错误率。\n\n问题指定了一条总长度为 $L=150$ 个核苷酸的读长，它被划分为三个片段，每个片段都有一个恒定的Phred质量分数中位数。让我们将第 $i$ 个片段的长度记为 $n_i$，其质量分数记为 $Q_i$。\n对于第一个片段（周期 $1-60$）：\n碱基数量为 $n_1 = 60 - 1 + 1 = 60$。\nPhred质量分数为 $Q_1 = 36$。\n此片段中每个碱基的错误概率为 $P_1 = 10^{-Q_1/10} = 10^{-36/10} = 10^{-3.6}$。\n\n对于第二个片段（周期 $61-120$）：\n碱基数量为 $n_2 = 120 - 61 + 1 = 60$。\nPhred质量分数为 $Q_2 = 32$。\n此片段中每个碱基的错误概率为 $P_2 = 10^{-Q_2/10} = 10^{-32/10} = 10^{-3.2}$。\n\n对于第三个片段（周期 $121-150$）：\n碱基数量为 $n_3 = 150 - 121 + 1 = 30$。\nPhred质量分数为 $Q_3 = 25$。\n此片段中每个碱基的错误概率为 $P_3 = 10^{-Q_3/10} = 10^{-25/10} = 10^{-2.5}$。\n读长的总长度确实是 $L = n_1 + n_2 + n_3 = 60 + 60 + 30 = 150$，这与所提供的信息一致。\n\n在一个碱基检出序列中的预期错误数遵循期望的线性性原理。如果我们为读长中的每个位置 $i$ 定义一个指示随机变量 $X_i$，使得当发生错误时 $X_i=1$，否则 $X_i=0$，那么 $X_i$ 的期望值为 $E[X_i] = (1 \\cdot P(X_i=1)) + (0 \\cdot P(X_i=0)) = p_i$，其中 $p_i$ 是位置 $i$ 的错误概率。整条读长的总预期错误数 $E_{\\text{read}}$ 是各个期望值的总和：\n$$ E_{\\text{read}} = \\sum_{i=1}^{L} E[X_i] = \\sum_{i=1}^{L} p_i $$\n将此应用于我们的分段模型，我们将恒定的错误概率在其各自的片段上求和：\n$$ E_{\\text{read}} = \\sum_{i=1}^{60} P_1 + \\sum_{i=61}^{120} P_2 + \\sum_{i=121}^{150} P_3 $$\n这可以简化为每个片段的碱基数与其错误概率的乘积之和：\n$$ E_{\\text{read}} = n_1 P_1 + n_2 P_2 + n_3 P_3 $$\n这是每条读长的预期碱基检出错误数的表达式。\n\n第一个要求解的量，即这条读长每个碱基的预期碱基检出错误率，在所有位置上平均，即 $\\bar{P}$，是总预期错误数除以读长的总长度：\n$$ \\bar{P} = \\frac{E_{\\text{read}}}{L} = \\frac{n_1 P_1 + n_2 P_2 + n_3 P_3}{L} $$\n第二个要求解的量是 $E_{read}$ 本身。题目要求计算 $E_{read}$ 的数值。\n\n我们现在将具体数值代入推导出的 $E_{read}$ 表达式中：\n$$ E_{\\text{read}} = 60 \\cdot 10^{-3.6} + 60 \\cdot 10^{-3.2} + 30 \\cdot 10^{-2.5} $$\n为了获得最终的数值答案，我们计算各项：\n$10^{-3.6} \\approx 0.0002511886$\n$10^{-3.2} \\approx 0.0006309573$\n$10^{-2.5} \\approx 0.0031622777$\n代入这些值：\n$$ E_{\\text{read}} \\approx 60 \\cdot (0.0002511886) + 60 \\cdot (0.0006309573) + 30 \\cdot (0.0031622777) $$\n$$ E_{\\text{read}} \\approx 0.015071316 + 0.037857438 + 0.094868331 $$\n$$ E_{\\text{read}} \\approx 0.147797085 $$\n题目要求将此值四舍五入到四位有效数字。第一位有效数字是十分位上的 $1$。四位有效数字是 $1, 4, 7, 7$。第五位有效数字是 $9$，因此需要将第四位数字向上取整。\n因此，每条读长的预期碱基检出错误数约为 $0.1478$。", "answer": "$$\n\\boxed{0.1478}\n$$", "id": "2848935"}, {"introduction": "在评估了单个碱基的质量后，下一步是评估整个RNA样本的完整性。测序前的因素，如RNA降解，可能会在数据中引入系统性偏差，影响分析结果的可靠性。这个练习 [@problem_id:2848873] 引导您像侦探一样思考，利用数据中的模式（如3'端偏好性）来诊断原始RNA的健康状况，并介绍了评估RNA完整性的关键指标——RNA完整性数值（RIN）。", "problem": "您正在设计一项实验，以比较在文库构建前经历了不同程度降解的两种人体组织样本之间的信使RNA (mRNA) 表达。两个文库均使用poly(A)尾选择和oligo-dT引物制备，然后测序到可比的深度。为了进行质量控制，您计算了全转录组范围的基因体覆盖度谱，该谱定义为沿着从注释的$5'$端到注释的$3'$端的标准化转录本坐标的平均读段覆盖度。其中一个名为文库$H$的文库显示，其基因体覆盖度近似均匀，而另一个名为文库$L$的文库则显示，其覆盖度从$3'$端向$5'$端单调下降，且中位插入片段大小更短。\n\n仅使用中心法则 (DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质) 的基础原理、真核mRNA的生化特征（包括$5'$帽子和$3'$ poly(A)化）、RNA降解过程中外切核酸酶和内切核酸酶的作用，以及poly(A)选择RNA测序(RNA-seq)文库制备的基本步骤（捕获poly(A)化的RNA、oligo(dT)引物、反转录、片段化、接头连接），回答以下问题。\n\n以下哪些陈述与这些原理和观察到的数据最为一致，并因此正确定义了RNA完整性数值(RIN)并解释了在poly(A)选择的RNA-seq数据中，降解如何在基因体覆盖度和$3'$偏好性中体现出来？请选择所有适用选项。\n\nA. RNA完整性数值(RIN)是一种算法总结性指标，通过整合毛细管电泳图谱（例如，安捷伦生物分析仪电泳图）中的特征（如核糖体RNA峰结构和基线降解信号）计算得出；它以一个量表报告，其中$1$表示高度降解的RNA，$10$表示高度完整的RNA。\n\nB. 在由降解RNA制备的poly(A)选择文库中，丢失了其$3'$ poly(A)尾的片段被优先捕获和引导，导致$5'$端覆盖度富集和转录本$3'$端附近的覆盖度耗尽。\n\nC. 在文库$L$中观察到的相对于其$3'$端的$5'$覆盖度缺失是预料之中的，因为许多RNA分子在其$5'$端的上游被截断但保留了其$3'$ poly(A)尾；因此，poly(A)选择和oligo(dT)引物富集了源自$3'$末端的互补DNA(cDNA)，从而产生明显的$3'$覆盖度偏好。\n\nD. 如果将相同的降解输入RNA改用核糖体RNA去除和随机六聚体引物处理，基因体覆盖度偏好将与poly(A)选择的情况基本相同，因为引物策略不会实质性地影响沿转录本的覆盖度。\n\nE. 对于降解RNA的poly(A)选择RNA-seq，质量控制通常显示，映射到转录本末端$3'$十分位数（例如，最后$10\\%$）的读段比例增加，以及中位cDNA片段长度减少；这两个趋势都源于降解和选择的基本原理。\n\nF. 将文库$L$的测序深度增加$2$倍，将通过均匀地抽样更多缺失的$5'$端来消除观察到的$3'$覆盖度偏好。\n\n仅依赖上述基本原理；不要假设任何未记录的、样本特有的怪异情况。选择所有正确选项。", "solution": "问题陈述在科学上是合理的、自洽的且表述清晰。它描述了RNA测序(RNA-seq)数据分析中一个经典且现实的场景，其中RNA降解会导致在使用poly(A)尾选择法制备的文库中出现特定的、可预测的人为现象。为文库$H$（高质量）和文库$L$（低质量）提供的观察结果是这种现象的典型例子。我们将根据分子生物学和基因组学的基本原理来评估每个陈述。\n\n需要分析的核心机制是RNA降解与poly(A)选择RNA-seq文库制备特定步骤之间的相互作用。\n1.  **真核mRNA结构：** 一个成熟的信使RNA (mRNA) 拥有一个$5'$帽子和一个$3'$ poly(A)尾。\n2.  **RNA降解：** 这个过程发生在文库制备之前，涉及内切核酸酶（在RNA内部分解）和外切核酸酶（从末端消化RNA）。其结果是一群被截短的RNA分子。\n3.  **poly(A)选择和oligo(dT)引物：** 所描述的文库制备方法使用oligo-dT探针特异性捕获保留其$3'$ poly(A)尾的RNA分子。然后，反转录由与该poly(A)尾杂交的oligo(dT)引物启动。\n4.  **后果：** 当一个mRNA分子被降解切割时，它会断裂成一个$5'$片段（缺少poly(A)尾）和一个$3'$片段（保留poly(A)尾）。在poly(A)选择过程中，$5'$片段被洗掉，而$3'$片段被捕获。由于反转录从这个被捕获的片段的$3'$端开始，得到的互补DNA(cDNA)文库系统性地富集了更靠近转录本原始$3'$末端的序列。这造成了一种覆盖度偏好，即读段计数在$3'$端最高，并向$5'$端递减，正如在文库$L$中观察到的那样。被捕获的片段本身也更短，这解释了中位插入片段大小的减小。相比之下，文库$H$中完整的RNA允许生成代表转录本整个长度的片段，从而导致均匀的覆盖度。\n\n现在，我们评估每个选项：\n\n**A. RNA完整性数值(RIN)是一种算法总结性指标，通过整合毛细管电泳图谱（例如，安捷伦生物分析仪电泳图）中的特征（如核糖体RNA峰结构和基线降解信号）计算得出；它以一个量表报告，其中$1$表示高度降解的RNA，$10$表示高度完整的RNA。**\n该陈述是RNA完整性数值(RIN)的精确和标准定义，RIN是在测序前评估RNA样本质量的关键指标。所描述的方法——在电泳图上分析核糖体RNA峰（如$18S$和$28S$ rRNA）的比率和形状相对于来自较小降解片段的信号——是正确的。数值量表，其中$10$代表完整的RNA，$1$代表完全降解的RNA，也是正确的。题干明确要求陈述定义RIN，而此陈述准确地做到了这一点。\n**结论：正确**\n\n**B. 在由降解RNA制备的poly(A)选择文库中，丢失了其$3'$ poly(A)尾的片段被优先捕获和引导，导致$5'$端覆盖度富集和转录本$3'$端附近的覆盖度耗尽。**\n该陈述根本上是错误的。poly(A)选择的原理是捕获*拥有*poly(A)尾的分子，而不是那些丢失了它的分子。oligo(dT)探针和引物特异性地靶向poly(A)尾。因此，丢失了其$3'$ poly(A)尾的片段会被丢弃，而不是被“优先捕获”。因此，产生的偏好是$3'$末端序列的富集，而不是所声称的$5'$端富集。该陈述与生化方法和文库$L$的观察数据都相矛盾。\n**结论：错误**\n\n**C. 在文库$L$中观察到的相对于其$3'$端的$5'$覆盖度缺失是预料之中的，因为许多RNA分子在其$5'$端的上游被截断但保留了其$3'$ poly(A)尾；因此，poly(A)选择和oligo(dT)引物富集了源自$3'$末端的互补DNA(cDNA)，从而产生明显的$3'$覆盖度偏好。**\n该陈述为观察到的现象提供了清晰而准确的解释。降解导致分子被截短，但只有那些保留了poly(A)尾的分子才被选中。这个选择过程内在地富集了原始转录本的$3'$端。oligo(dT)引物步骤通过从$3'$端启动合成来强化了这一点。由此产生的“明显的$3'$覆盖度偏好”与问题中描述的“覆盖度从$3'$端向$5'$端单调下降”和“$5'$覆盖度缺失”是相同的。其推理是合理的，并与基本原理完美契合。\n**结论：正确**\n\n**D. 如果将相同的降解输入RNA改用核糖体RNA去除和随机六聚体引物处理，基因体覆盖度偏好将与poly(A)选择的情况基本相同，因为引物策略不会实质性地影响沿转录本的覆盖度。**\n这个陈述是错误的。文库制备策略至关重要。核糖体RNA去除会移除rRNA，但不会选择poly(A)化的转录本。关键是，随机六聚体引物在任何可用的RNA片段上的随机位置启动cDNA合成。这意味着由降解产生的$5'$和$3'$片段都可以被反转录。这种方法专门用于*减少*与降解RNA和poly(A)选择相关的$3'$偏好。因此，覆盖度偏好将会有显著不同，并且更加均匀，而不是“基本相同”。声称引物策略不重要的说法是错误的。\n**结论：错误**\n\n**E. 对于降解RNA的poly(A)选择RNA-seq，质量控制通常显示，映射到转录本末端$3'$十分位数（例如，最后$10\\%$）的读段比例增加，以及中位cDNA片段长度减少；这两个趋势都源于降解和选择的基本原理。**\n该陈述正确地指出了选项C中所述机制的两个定量结果。$3'$偏好意味着不成比例的大量读段将映射到基因的$3'$端（例如，末端$10\\%$）。中位cDNA片段长度（或问题中所述的插入片段大小）的减少也是从预先片段化、截短且在poly(A)选择中存活下来的RNA分子开始的直接结果。这两者都是使用此方法从降解RNA制备的文库的标准质量控制观察结果，并且是基本原理的直接后果。\n**结论：正确**\n\n**F. 将文库$L$的测序深度增加$2$倍，将通过均匀地抽样更多缺失的$5'$端来消除观察到的$3'$覆盖度偏好。**\n该陈述揭示了对系统性偏差与统计抽样误差的误解。文库$L$中的$3'$覆盖度偏好是文库组成的一个系统性人为产物；对应于$5'$端的RNA片段在文库制备过程中物理上丢失了，并且不存在于最终的文库池中。增加测序深度仅仅意味着对*现有的有偏好的池子*中的更多分子进行测序。它会增加所有位置上读段的绝对数量，但不会改变沿转录本的读段相对分布。偏好将会持续存在。它无法恢复不存在的信息。\n**结论：错误**", "answer": "$$\\boxed{ACE}$$", "id": "2848873"}, {"introduction": "在确保数据质量之后，我们便可以进入转录组学分析的核心任务：识别差异表达基因。本练习将带您深入了解主流分析软件的“引擎盖之下”，不再是简单地点击按钮，而是要求您从第一性原理出发，构建其核心统计模型——负二项式广义线性模型（NB-GLM）。这种实践 [@problem_id:2848955] 能让您深刻理解我们如何对生物学变异和实验设计进行建模，从而获得稳健的科学结论。", "problem": "给定独立的基因水平RNA测序（RNA-seq）读数计数和一个带有协变量的线性设计。假设分子生物学中心法则和RNA测序计数数据的标准模型成立：在给定协变量和文库大小的条件下，一个基因在样本间的观测读数计数是负二项（NB）广义线性模型（GLM）的实现，该模型使用对数连接函数，其中均值通过一个偏移量依赖于样本特有的文库大小因子。您的任务是使用迭代重加权最小二乘算法和Wald统计量，从第一性原理出发实现估计和推断。\n\n使用以下基础：\n- 分子生物学中心法则意味着，信使核糖核酸（mRNA）丰度是基因表达的代理指标，而RNA测序读数计数在校正文库大小后与丰度成正比。\n- 在使用NB2方差参数化的负二项GLM中，给定协变量，方差为 $V(Y_i) = \\mu_i + \\alpha \\mu_i^2$，其中离散度 $\\alpha  0$。\n- 使用对数连接函数和偏移量，均值满足 $\\log \\mu_i = o_i + \\boldsymbol{x}_i^\\top \\boldsymbol{\\beta}$，其中 $o_i = \\log s_i$ 是来自文库大小因子 $s_i  0$ 的已知偏移量，$\\boldsymbol{x}_i$ 是样本 $i$ 的协变量向量，$\\boldsymbol{\\beta}$ 是回归系数。\n- 对于一个指定的对比向量 $\\boldsymbol{c}$，Wald统计量根据估计的系数向量 $\\hat{\\boldsymbol{\\beta}}$ 及其协方差 $\\widehat{\\mathrm{Var}}(\\hat{\\boldsymbol{\\beta}})$ 计算得出，公式为 $Z = \\dfrac{\\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}}}{\\sqrt{\\boldsymbol{c}^\\top \\widehat{\\mathrm{Var}}(\\hat{\\boldsymbol{\\beta}})\\, \\boldsymbol{c}}}$，其双侧p值从标准正态分布中获得。\n\n实现以下算法设计：\n- 对带有对数连接函数和偏移量的负二项GLM使用迭代重加权最小二乘法：\n  - 在第 $t$ 次迭代中，给定 $\\boldsymbol{\\beta}^{(t)}$，计算 $\\eta_i^{(t)} = o_i + \\boldsymbol{x}_i^\\top \\boldsymbol{\\beta}^{(t)}$，$\\mu_i^{(t)} = \\exp(\\eta_i^{(t)})$。\n  - 定义权重 $w_i^{(t)} = \\dfrac{\\mu_i^{(t)}}{1 + \\alpha \\mu_i^{(t)}}$ 和伪响应 $z_i^{(t)} = \\eta_i^{(t)} + \\dfrac{y_i - \\mu_i^{(t)}}{\\mu_i^{(t)}}$。\n  - 通过求解加权最小二乘法正规方程 $\\left(\\boldsymbol{X}^\\top \\boldsymbol{W}^{(t)} \\boldsymbol{X}\\right) \\boldsymbol{\\beta}^{(t+1)} = \\boldsymbol{X}^\\top \\boldsymbol{W}^{(t)} \\boldsymbol{z}^{(t)}$ 来更新 $\\boldsymbol{\\beta}^{(t+1)}$，其中 $\\boldsymbol{W}^{(t)}$ 是对角线上为 $w_i^{(t)}$ 的对角矩阵。\n  - 迭代直至 $\\boldsymbol{\\beta}$ 的收敛达到指定的容差。\n- 收敛后，使用基于模型的协方差估计 $\\widehat{\\mathrm{Var}}(\\hat{\\boldsymbol{\\beta}}) = \\left(\\boldsymbol{X}^\\top \\hat{\\boldsymbol{W}} \\boldsymbol{X}\\right)^{-1}$，其中 $\\hat{\\boldsymbol{W}}$ 在收敛的均值处计算。\n\n对于下方的每个测试用例，拟合模型，计算处理对比的Wald统计量，并解释估计对比值的符号。为每个测试用例按顺序报告以下内容：\n- 估计的对比值 $\\hat{\\theta} = \\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}}$（一个浮点数），\n- 其标准误 $\\widehat{\\mathrm{se}} = \\sqrt{\\boldsymbol{c}^\\top \\widehat{\\mathrm{Var}}(\\hat{\\boldsymbol{\\beta}})\\, \\boldsymbol{c}}$（一个浮点数），\n- Wald统计量 $Z$（一个浮点数），\n- 在标准正态分布下的双侧p值（一个浮点数），\n- 一个布尔型解释性指标 $\\mathrm{up}$，当且仅当 $\\hat{\\theta}  0$ 时为真。\n\n所有数值答案必须根据上述定义计算。本问题不涉及物理单位。不出现角度。不需要百分比。最终输出必须为单行：一个列表，其元素是每个测试用例的结果列表，以逗号分隔并用方括号括起来。\n\n测试套件。对于每个测试用例，设计矩阵有三列：一个截距项、一个处理指示符和一个批次指示符。对比始终是处理效应，即 $\\boldsymbol{c} = [\\,0,\\,1,\\,0\\,]^\\top$。对于每个用例，您将获得计数向量 $\\boldsymbol{y}$、处理向量 $\\boldsymbol{T}$、批次向量 $\\boldsymbol{B}$、正的文库大小因子 $\\boldsymbol{s}$ 和离散度 $\\alpha$。\n\n- 用例A（一般情况，中等计数，正处理效应）：\n  - $\\boldsymbol{y} = [16, 17, 23, 30, 45, 31]$\n  - $\\boldsymbol{T} = [0, 0, 0, 1, 1, 1]$\n  - $\\boldsymbol{B} = [0, 1, 0, 1, 0, 1]$\n  - $\\boldsymbol{s} = [0.8, 1.0, 1.2, 0.9, 1.1, 0.95]$\n  - $\\alpha = 0.15$\n- 用例B（接近零的处理效应，中等计数）：\n  - $\\boldsymbol{y} = [12, 12, 13, 14, 12, 16]$\n  - $\\boldsymbol{T} = [0, 0, 0, 1, 1, 1]$\n  - $\\boldsymbol{B} = [0, 1, 0, 1, 0, 1]$\n  - $\\boldsymbol{s} = [1.0, 0.9, 1.1, 1.05, 0.95, 1.2]$\n  - $\\alpha = 0.20$\n- 用例C（样本量较大，负处理效应，批次效应较强）：\n  - $\\boldsymbol{y} = [19, 45, 27, 38, 13, 25, 15, 22]$\n  - $\\boldsymbol{T} = [0, 0, 0, 0, 1, 1, 1, 1]$\n  - $\\boldsymbol{B} = [0, 1, 0, 1, 0, 1, 0, 1]$\n  - $\\boldsymbol{s} = [0.7, 1.3, 1.0, 1.1, 0.8, 1.2, 0.9, 1.05]$\n  - $\\alpha = 0.10$\n- 用例D（计数较小，离散度较高）：\n  - $\\boldsymbol{y} = [3, 4, 2, 3]$\n  - $\\boldsymbol{T} = [0, 1, 0, 1]$\n  - $\\boldsymbol{B} = [0, 0, 1, 1]$\n  - $\\boldsymbol{s} = [1.0, 0.8, 1.2, 1.1]$\n  - $\\alpha = 1.00$\n\n设计矩阵的构建：对于每个用例，将 $\\boldsymbol{X}$ 定义为一个 $n \\times 3$ 的矩阵，其列分别为 $\\boldsymbol{1}_n$、$\\boldsymbol{T}$ 和 $\\boldsymbol{B}$。对每个样本 $i$ 使用偏移量 $o_i = \\log s_i$。\n\n要求的最终输出格式：\n- 对于A、B、C、D的每个用例，按顺序输出列表 $[\\,\\hat{\\theta},\\,\\widehat{\\mathrm{se}},\\,Z,\\,p,\\,\\mathrm{up}\\,]$，其中 $\\hat{\\theta}$、$\\widehat{\\mathrm{se}}$、$Z$ 和 $p$ 是四舍五入到六位小数的浮点数，$\\mathrm{up}$ 是一个布尔值。\n- 您的程序应生成单行输出，其中包含一个以逗号分隔并用方括号括起来的结果列表，每个元素是对应一个测试用例的结果列表（例如，\"[[...],[...],[...],[...]]\"）。", "solution": "该问题要求实现一个用于分析RNA测序（RNA-seq）计数数据的统计流程。问题陈述的有效性得到了确认，因为它在科学上基于转录组学和生物统计学的既定原则，问题表述清晰，提供了所有必要信息，并且是客观制定的。所描述的模型和算法是差异基因表达分析领域的标准方法。\n\n问题的核心是为基因表达计数拟合一个负二项（NB）广义线性模型（GLM）。其生物学前提植根于中心法则，即通过RNA-seq读数计数测量的mRNA丰度反映了基因表达水平。每个样本 $i$ 的计数数据 $Y_i$ 被建模为一个遵循负二项分布的随机变量。\n\n模型设定如下：\n均值 $\\mu_i = E[Y_i]$ 通过一个对数连接函数与一组协变量 $\\boldsymbol{x}_i$ 相关联，并带有一个偏移项 $o_i$ 以解释样本间文库大小（测序深度）的差异。线性预测变量 $\\eta_i$ 和均值 $\\mu_i$ 由以下公式给出：\n$$ \\eta_i = \\boldsymbol{x}_i^\\top \\boldsymbol{\\beta} + o_i $$\n$$ \\mu_i = \\exp(\\eta_i) $$\n在这里，$\\boldsymbol{\\beta}$ 是待估计的回归系数向量，偏移量 $o_i$ 定义为文库大小因子 $s_i$ 的对数，即 $o_i = \\log s_i$。\n\n在NB2参数化下，负二项分布的方差与均值的关系为：\n$$ V(Y_i) = \\mu_i + \\alpha \\mu_i^2 $$\n其中 $\\alpha  0$ 是离散度参数，它捕捉了超出泊松模型（其中方差等于均值）预期的生物和技术变异。每个测试用例都提供了一个固定的 $\\alpha$ 值。\n\n为了估计系数向量 $\\boldsymbol{\\beta}$，我们采用迭代重加权最小二乘（IRLS）算法。IRLS是一种数值方法，通过迭代求解一系列加权最小二乘（WLS）问题来找到 $\\boldsymbol{\\beta}$ 的最大似然估计（MLE）。该算法的步骤如下：\n\n1.  **初始化**：算法从一个系数的初始猜测值 $\\boldsymbol{\\beta}^{(0)}$ 开始。一个标准而简单的选择是 $\\boldsymbol{\\beta}^{(0)} = \\boldsymbol{0}$。\n\n2.  **迭代**：在每次迭代 $t$ 中，给定当前估计 $\\boldsymbol{\\beta}^{(t-1)}$，我们为每个样本 $i=1, \\dots, n$ 计算以下量：\n    -   线性预测变量：$\\eta_i^{(t-1)} = \\boldsymbol{x}_i^\\top \\boldsymbol{\\beta}^{(t-1)} + o_i$。\n    -   拟合的均值：$\\mu_i^{(t-1)} = \\exp(\\eta_i^{(t-1)})$。\n    -   伪响应或“工作因变量”：$z_i^{(t-1)} = \\eta_i^{(t-1)} + \\dfrac{y_i - \\mu_i^{(t-1)}}{\\mu_i^{(t-1)}}$。这在当前估计值周围对模型进行线性化。\n    -   IRLS权重：$w_i^{(t-1)} = \\left( \\left(\\frac{\\partial \\mu_i}{\\partial \\eta_i}\\right)^2 V(Y_i)^{-1} \\right)_{\\boldsymbol{\\beta}^{(t-1)}} = \\dfrac{(\\mu_i^{(t-1)})^2}{\\mu_i^{(t-1)} + \\alpha (\\mu_i^{(t-1)})^2} = \\dfrac{\\mu_i^{(t-1)}}{1 + \\alpha \\mu_i^{(t-1)}}$。这些权重是伪响应方差的倒数。\n\n3.  **更新**：通过求解WLS正规方程获得新的估计值 $\\boldsymbol{\\beta}^{(t)}$。令 $\\boldsymbol{X}$ 为 $n \\times p$ 的设计矩阵，$\\boldsymbol{z}^{(t-1)}$ 为伪响应向量，$\\boldsymbol{W}^{(t-1)}$ 为权重对角矩阵。更新公式为：\n    $$ \\boldsymbol{\\beta}^{(t)} = \\left(\\boldsymbol{X}^\\top \\boldsymbol{W}^{(t-1)} \\boldsymbol{X}\\right)^{-1} \\boldsymbol{X}^\\top \\boldsymbol{W}^{(t-1)} \\boldsymbol{z}^{(t-1)} $$\n\n4.  **收敛**：重复步骤2和3，直到连续迭代中 $\\boldsymbol{\\beta}$ 的变化小于指定的容差，即 $||\\boldsymbol{\\beta}^{(t)} - \\boldsymbol{\\beta}^{(t-1)}||_2  \\epsilon$。收敛后的向量即为MLE，$\\hat{\\boldsymbol{\\beta}}$。\n\n一旦获得MLE $\\hat{\\boldsymbol{\\beta}}$，我们就对由对比向量 $\\boldsymbol{c}$ 定义的系数的特定线性组合进行统计推断。在本问题中，对比是 $\\boldsymbol{c} = [\\,0,\\,1,\\,0\\,]^\\top$，它分离出处理效应的系数。估计的效应大小是 $\\hat{\\theta} = \\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}}$。\n\n为了检验原假设 $H_0: \\boldsymbol{c}^\\top \\boldsymbol{\\beta} = 0$，我们使用Wald检验。Wald统计量需要 $\\hat{\\theta}$ 的标准误，该标准误源自 $\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵。估计的协方差矩阵是Fisher信息矩阵在MLE处的逆矩阵：\n$$ \\widehat{\\mathrm{Var}}(\\hat{\\boldsymbol{\\beta}}) = \\left(\\boldsymbol{X}^\\top \\hat{\\boldsymbol{W}} \\boldsymbol{X}\\right)^{-1} $$\n其中 $\\hat{\\boldsymbol{W}}$ 是使用最终收敛的均值 $\\hat{\\boldsymbol{\\mu}}$ 计算的权重矩阵。\n\n对比的标准误则为：\n$$ \\widehat{\\mathrm{se}}(\\hat{\\theta}) = \\sqrt{\\boldsymbol{c}^\\top \\widehat{\\mathrm{Var}}(\\hat{\\boldsymbol{\\beta}})\\, \\boldsymbol{c}} $$\n\nWald统计量 $Z$ 计算为估计值与其标准误的比值：\n$$ Z = \\frac{\\hat{\\theta}}{\\widehat{\\mathrm{se}}(\\hat{\\theta})} $$\n\n在原假设下，$Z$ 服从标准正态分布 $\\mathcal{N}(0, 1)$。双侧p值计算为 $p = 2 \\cdot P(N  |Z|)$，其中 $N \\sim \\mathcal{N}(0, 1)$。\n\n最后，生成一个指示效应方向的指标：如果 $\\hat{\\theta}  0$，则 $\\mathrm{up}$ 为真，表示上调，否则为假。将此整个过程应用于提供的每个测试用例。", "answer": "[[0.443903, 0.316270, 1.403560, 0.160450, true], [0.039603, 0.407481, 0.097190, 0.922570, true], [-0.347596, 0.252650, -1.375800, 0.168875, false], [0.514755, 1.229040, 0.418826, 0.675344, true]]", "id": "2848955"}]}