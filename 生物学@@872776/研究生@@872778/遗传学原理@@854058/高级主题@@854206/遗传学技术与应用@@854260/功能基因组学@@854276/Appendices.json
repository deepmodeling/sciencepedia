{"hands_on_practices": [{"introduction": "理解数据分析中的陷阱与掌握分析技术本身同样重要。第一个练习将展示RNA测序分析中的一个根本性挑战：数据的组合性（compositionality）。通过一个简化的设想情景 [@problem_id:2811878]，您将从第一性原理出发，推导简单的归一化方法如何产生差异表达的假象，从而强调更稳健策略的必要性。", "problem": "一个RNA测序 (RNA-seq) 实验比较了两种条件，标记为条件 $\\mathrm{A}$ 和条件 $\\mathrm{B}$。假设存在以下基本事实和定义：\n\n1. 测序产生的计数与输入RNA池中转录本的相对丰度成正比；当从每个样本中获得固定数量的读数时，观察到的计数是组合性的，即它们估计的是总和为 $1$ 的潜在相对丰度。\n2. 在总计数归一化（也称为每百万读数缩放 (CPM)）下，每个样本按其总读数计数进行缩放；如果总读数计数相等，这种归一化不改变计数，比较就简化为比较相对丰度。\n3. 一个基因在不同条件间的倍数变化定义为其在条件 $\\mathrm{B}$ 中的归一化丰度与在条件 $\\mathrm{A}$ 中的归一化丰度的比率。\n\n考虑一个转录组，它有两个不相交的基因组：一个高表达基因子集 $\\mathrm{H}$ 及其补集 $\\mathrm{L}$。在条件 $\\mathrm{A}$ 中，$\\mathrm{H}$ 所携带的总相对丰度为 $f \\in (0,1)$，而 $\\mathrm{L}$ 所携带的总相对丰度为 $1 - f$。在条件 $\\mathrm{B}$ 中，$\\mathrm{H}$ 中的每个基因都真实上调了一个乘法因子 $r > 0$，而 $\\mathrm{L}$ 中的每个基因都真实未变。用于 $\\mathrm{A}$ 和 $\\mathrm{B}$ 的文库以相同的总读数进行测序，因此总计数归一化可直接应用。\n\n任务1（推导）：仅从相对丰度总和为 $1$ 的组合性约束和倍数变化的定义出发，推导出一个关于 $f$ 和 $r$ 的表达式，用于表示在朴素总计数归一化下，任何一个真实未变的基因 $g \\in \\mathrm{L}$ 的表观倍数变化。\n\n任务2（玩具示例演示）：使用以下具体的玩具实例验证您的表达式。在条件 $\\mathrm{A}$ 中，有五个基因：三个高表达基因在 $\\mathrm{H}$ 中，其总相对丰度为 $f = 0.6$；两个基因在 $\\mathrm{L}$ 中，平均分配剩余的 $0.4$。在条件 $\\mathrm{B}$ 中，$\\mathrm{H}$ 中的每个基因乘以 $r = 3$，而 $\\mathrm{L}$ 中的基因不变。假设两个文库都产生 $10^{6}$ 个读数。计算其中一个未变的 $\\mathrm{L}$ 基因的朴素总计数归一化倍数变化，并验证其与您推导的表达式相匹配。\n\n请提供您的最终答案，形式为一个关于 $f$ 和 $r$ 的单一闭式解析表达式，表示在朴素总计数归一化下，$\\mathrm{L}$ 中一个非差异表达基因的表观倍数变化。不要包含单位。", "solution": "首先将对问题的科学性和逻辑一致性进行验证。\n\n**步骤 1：提取已知条件**\n\n- **定义 1**：RNA-seq 计数是组合性的，估计的是总和为 $1$ 的潜在相对丰度。\n- **定义 2**：对于总读数计数相等的文库，总计数归一化等同于直接比较相对丰度。\n- **定义 3**：倍数变化是在条件 $\\mathrm{B}$ 中的归一化丰度与在条件 $\\mathrm{A}$ 中的归一化丰度的比率。\n- **条件 A**：一个转录组有两个不相交的基因集 $\\mathrm{H}$ 和 $\\mathrm{L}$。$\\mathrm{H}$ 的总相对丰度为 $f$，其中 $f \\in (0,1)$。$\\mathrm{L}$ 的总相对丰度为 $1 - f$。\n- **条件 B**：$\\mathrm{H}$ 中的每个基因都真实上调了一个因子 $r > 0$。$\\mathrm{L}$ 中的每个基因都真实未变。\n- **任务 1**：推导任何基因 $g \\in \\mathrm{L}$ 的表观倍数变化，用 $f$ 和 $r$ 表示。\n- **任务 2 (验证数据)**：\n    - 条件 A：总共 $5$ 个基因。$3$ 个基因在 $\\mathrm{H}$ 中，总相对丰度为 $f = 0.6$。$2$ 个基因在 $\\mathrm{L}$ 中，平均分配剩余的 $0.4$ 丰度。\n    - 条件 B：$\\mathrm{H}$ 中基因的上调因子为 $r = 3$。\n    - 测序深度：两个文库均为 $10^{6}$ 个读数。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据验证标准评估问题陈述。\n\n- **科学基础**：该问题牢固地植根于功能基因组学的原理，特别是RNA-seq数据的分析。组合数据的概念以及由总计数归一化引入的偏差是转录组学中基本且公认的问题。\n- **良置性**：该问题是良置的。它提供了足够的定义和约束来为目标量推导出唯一的解析解。\n- **客观性**：语言精确、量化，没有主观或模糊的术语。\n\n该问题没有表现出任何无效标志。它在科学上是合理的，可形式化的，完整的，并提出了一个关于组合约束下数据归一化的数学后果的非平凡问题。\n\n**结论**\n\n问题是有效的。将提供解答。\n\n**解题推导**\n\n目标是找到属于集合 $\\mathrm{L}$ 的基因的表观倍数变化，该集合包含在条件 $\\mathrm{A}$ 和 $\\mathrm{B}$ 之间真实分子丰度不变的基因。这种表观变化源于数据的组合性质，即所有相对丰度之和必须为 $1$。\n\n令 $\\alpha_{g,A}$ 和 $\\alpha_{g,B}$ 分别为基因 $g$ 在条件 $\\mathrm{A}$ 和条件 $\\mathrm{B}$ 中的相对丰度。令所有基因的集合为 $\\mathcal{G} = \\mathrm{H} \\cup \\mathrm{L}$。组合性约束表明：\n$$ \\sum_{g \\in \\mathcal{G}} \\alpha_{g,A} = 1 \\quad \\text{and} \\quad \\sum_{g \\in \\mathcal{G}} \\alpha_{g,B} = 1 $$\n\n根据问题陈述，在条件 $\\mathrm{A}$ 中：\n$$ \\sum_{h \\in \\mathrm{H}} \\alpha_{h,A} = f $$\n$$ \\sum_{l \\in \\mathrm{L}} \\alpha_{l,A} = 1 - f $$\n\n为了模拟“真实”变化，我们考虑潜在的、未归一化的分子丰度。让我们将条件 $\\mathrm{A}$ 样本中的总分子丰度表示为 $C_{T,A}$。任何基因 $g$ 的丰度为 $C_{g,A} = \\alpha_{g,A} C_{T,A}$。\n\n在条件 $\\mathrm{B}$ 中，每个基因 $h \\in \\mathrm{H}$ 的真实丰度乘以 $r$，而每个基因 $l \\in \\mathrm{L}$ 的真实丰度不变。在条件 $\\mathrm{B}$ 中，基因 $g$ 的新的未归一化丰度，表示为 $C'_{g,B}$，是：\n$$ C'_{h,B} = r \\cdot C_{h,A} \\quad \\text{for } h \\in \\mathrm{H} $$\n$$ C'_{l,B} = C_{l,A} \\quad \\text{for } l \\in \\mathrm{L} $$\n\n在条件 $\\mathrm{B}$ 中的新总分子丰度 $C'_{T,B}$ 是所有基因的总和：\n$$ C'_{T,B} = \\sum_{h \\in \\mathrm{H}} C'_{h,B} + \\sum_{l \\in \\mathrm{L}} C'_{l,B} = \\sum_{h \\in \\mathrm{H}} (r \\cdot C_{h,A}) + \\sum_{l \\in \\mathrm{L}} C_{l,A} $$\n提取公因子 $r$ 并用条件 $\\mathrm{A}$ 中的相对丰度表示总和：\n$$ C'_{T,B} = r \\left( \\sum_{h \\in \\mathrm{H}} C_{h,A} \\right) + \\sum_{l \\in \\mathrm{L}} C_{l,A} $$\n我们知道 $\\sum_{h \\in \\mathrm{H}} C_{h,A} = C_{T,A} \\sum_{h \\in \\mathrm{H}} \\alpha_{h,A} = C_{T,A} \\cdot f$。\n并且 $\\sum_{l \\in \\mathrm{L}} C_{l,A} = C_{T,A} \\sum_{l \\in \\mathrm{L}} \\alpha_{l,A} = C_{T,A} \\cdot (1-f)$。\n将这些代入 $C'_{T,B}$ 的表达式中：\n$$ C'_{T,B} = r(C_{T,A} \\cdot f) + C_{T,A} \\cdot (1-f) = C_{T,A} (rf + 1 - f) $$\n\n在条件 $\\mathrm{B}$ 中，任何基因 $g$ 的观测相对丰度 $\\alpha_{g,B}$ 是其真实的新丰度除以新的总丰度，以满足组合性约束：\n$$ \\alpha_{g,B} = \\frac{C'_{g,B}}{C'_{T,B}} $$\n\n我们关心的是一个基因 $g \\in \\mathrm{L}$。对于这样的基因，$C'_{g,B} = C_{g,A}$。我们还知道 $C_{g,A} = \\alpha_{g,A} \\cdot C_{T,A}$。代入这些关系：\n$$ \\alpha_{g,B} = \\frac{C_{g,A}}{C'_{T,B}} = \\frac{\\alpha_{g,A} \\cdot C_{T,A}}{C_{T,A} (rf + 1 - f)} $$\n$C_{T,A}$ 项被消去，剩下：\n$$ \\alpha_{g,B} = \\frac{\\alpha_{g,A}}{rf + 1 - f} $$\n\n问题将倍数变化定义为归一化丰度的比率。由于总文库大小相等，这对应于相对丰度的比率。对于任何基因 $g \\in \\mathrm{L}$（假设 $\\alpha_{g,A} \\neq 0$），其表观倍数变化 $FC_g$ 为：\n$$ FC_g = \\frac{\\alpha_{g,B}}{\\alpha_{g,A}} = \\frac{\\frac{\\alpha_{g,A}}{rf + 1 - f}}{\\alpha_{g,A}} $$\n$$ FC_g = \\frac{1}{rf + 1 - f} $$\n此表达式仅依赖于 $f$ 和 $r$，符合要求。\n\n**使用玩具示例进行验证**\n\n现在，我们使用提供的玩具示例来验证这个通用表达式。\n- 已知：$f=0.6$, $r=3$。\n- 根据推导出的公式，$\\mathrm{L}$ 中基因的预期表观倍数变化是：\n$$ FC_g = \\frac{1}{(3)(0.6) + 1 - 0.6} = \\frac{1}{1.8 + 0.4} = \\frac{1}{2.2} = \\frac{10}{22} = \\frac{5}{11} $$\n\n接下来，我们使用玩具数据从第一性原理计算这个值。\n- 在条件 $\\mathrm{A}$ 中，总读数计数为 $N = 10^6$。\n- $\\mathrm{L}$ 中 $2$ 个基因的总相对丰度是 $1-f = 0.4$。由于它们平均分配，单个基因 $g \\in \\mathrm{L}$ 的相对丰度是 $\\alpha_{g,A} = \\frac{0.4}{2} = 0.2$。\n- 在条件 $\\mathrm{A}$ 中，该基因的读数计数是 $C_{g,A} = \\alpha_{g,A} \\cdot N = 0.2 \\cdot 10^6 = 200,000$。\n- 在条件 $\\mathrm{A}$ 中，集合 $\\mathrm{H}$ 的总读数计数是 $f \\cdot N = 0.6 \\cdot 10^6 = 600,000$。\n\n- 在条件 $\\mathrm{B}$ 中，$\\mathrm{H}$ 中基因的真实丰度乘以 $r=3$，而 $\\mathrm{L}$ 中的基因不变。新的未归一化总计数是：\n$$ C'_{T,B} = (\\text{counts for H}) \\times r + (\\text{counts for L}) \\times 1 = (600,000 \\times 3) + (400,000 \\times 1) = 1,800,000 + 400,000 = 2,200,000 $$\n- 我们的基因 $g \\in \\mathrm{L}$ 的未归一化计数仍为 $200,000$。\n- 在条件 $\\mathrm{B}$ 中，基因 $g$ 的新相对丰度是：\n$$ \\alpha_{g,B} = \\frac{\\text{un-normalized count of g}}{\\text{new total un-normalized count}} = \\frac{200,000}{2,200,000} = \\frac{2}{22} = \\frac{1}{11} $$\n\n- 表观倍数变化是相对丰度的比率：\n$$ FC_g = \\frac{\\alpha_{g,B}}{\\alpha_{g,A}} = \\frac{1/11}{0.2} = \\frac{1/11}{1/5} = \\frac{5}{11} $$\n此结果与推导出的公式预测的结果相匹配。验证成功。表达式是正确的。", "answer": "$$\n\\boxed{\\frac{1}{rf + 1 - f}}\n$$", "id": "2811878"}, {"introduction": "在了解了简单归一化方法所导致的问题之后，我们现在转向一个更稳健的解决方案。本练习将聚焦于比率中位数法（median-of-ratios method），这是广泛使用的DESeq2软件包的核心，用于计算样本特异性的“大小因子”（size factors）[@problem_id:2811863]。通过手动计算这些因子并证明它们对于数据缩放的不变性，您将对现代分析工具如何校正测序文库深度的差异获得深刻而实际的理解。", "problem": "在为差异表达分析而对核糖核酸测序（RNA-seq）计数数据进行归一化的过程中，一个核心任务是估计能够捕捉文库深度和其他全局缩放效应的样本特异性大小因子。Differential Expression Sequencing 2 (DESeq2) 方法通过“中位数比值法”来定义大小因子：对于每个基因，计算其跨样本的几何平均数；然后对于每个样本，计算所有计数值为正的基因的观测计数值与这些几何平均数的比值；最后取这些比值的中位数作为该样本的大小因子。仅使用此定义以及几何平均数和中位数的标准定义，回答以下问题。\n\n给定一个在三个样本 $\\{S_{\\mathrm{A}},S_{\\mathrm{B}},S_{\\mathrm{C}}\\}$ 中测量的四个基因 $\\{G_1,G_2,G_3,G_4\\}$ 的严格为正的计数矩阵：\n$$\nN \\;=\\;\n\\begin{pmatrix}\n100  150  50 \\\\\n200  300  100 \\\\\n400  600  200 \\\\\n800  1200  400\n\\end{pmatrix},\n$$\n其中列对应样本 $(S_{\\mathrm{A}},S_{\\mathrm{B}},S_{\\mathrm{C}})$，行对应基因 $(G_1,G_2,G_3,G_4)$。所有条目均为原始计数值。\n\n1) 使用中位数比值定义，计算每个样本的 DESeq2 大小因子。\n\n2) 现在考虑将所有计数值通过一个公共常数因子 $k = 10$ 进行统一重缩放，得到缩放后的矩阵 $N' = k N$。除几何平均数和中位数的定义外，不使用任何其他结论，从第一性原理出发，证明从 $N'$ 计算出的大小因子是否与从 $N$ 计算出的不同，并解释原因。\n\n将 $(S_{\\mathrm{A}},S_{\\mathrm{B}},S_{\\mathrm{C}})$ 的公共大小因子向量以单行矩阵的形式报告，结果四舍五入至四位有效数字，且最终数值答案不含单位。", "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于转录组数据归一化的既定原则，特别是 DESeq2 使用的中位数比值法。该问题是良定的，以清晰、客观且无矛盾的方式提供了所有必要的定义和数据。它提出了一个可形式化和可验证的计算任务。我将继续进行解答。\n\n问题分为两部分。第一部分是计算给定计数矩阵 $N$ 的大小因子。第二部分是关于统一缩放对这些大小因子影响的第一性原理证明。\n\n设计数矩阵为 $N$，其中 $N_{ij}$ 是基因 $i \\in \\{1, 2, 3, 4\\}$ 和样本 $j \\in \\{A, B, C\\}$ 的计数值。该矩阵如下所示：\n$$\nN =\n\\begin{pmatrix}\nN_{1A}  N_{1B}  N_{1C} \\\\\nN_{2A}  N_{2B}  N_{2C} \\\\\nN_{3A}  N_{3B}  N_{3C} \\\\\nN_{4A}  N_{4B}  N_{4C}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n100  150  50 \\\\\n200  300  100 \\\\\n400  600  200 \\\\\n800  1200  400\n\\end{pmatrix}\n$$\n\n**第一部分：计算矩阵 $N$ 的大小因子**\n\n根据所提供的定义，计算过程分三步进行。\n\n**步骤 1.1：计算每个基因的基因几何平均数。**\n基因 $i$ 在 $3$ 个样本中的几何平均数（记为 $g_i$）由公式 $g_i = (N_{iA} \\cdot N_{iB} \\cdot N_{iC})^{1/3}$ 给出。\n\n对于基因 $G_1$：\n$$ g_1 = (100 \\times 150 \\times 50)^{1/3} = (750000)^{1/3} $$\n对于基因 $G_2$：\n$$ g_2 = (200 \\times 300 \\times 100)^{1/3} = (6000000)^{1/3} $$\n对于基因 $G_3$：\n$$ g_3 = (400 \\times 600 \\times 200)^{1/3} = (48000000)^{1/3} $$\n对于基因 $G_4$：\n$$ g_4 = (800 \\times 1200 \\times 400)^{1/3} = (384000000)^{1/3} $$\n\n可以观察到矩阵 $N$ 的结构。对于任何基因 $i$ 和样本 $j$，有 $N_{ij} = 2^{i-1} N_{1j}$。这一结构特性简化了各几何平均数之间的关系：\n$$ g_i = (\\prod_{j \\in \\{A,B,C\\}} N_{ij})^{1/3} = (\\prod_{j} 2^{i-1} N_{1j})^{1/3} = ((2^{i-1})^3 \\prod_{j} N_{1j})^{1/3} = 2^{i-1} (\\prod_{j} N_{1j})^{1/3} = 2^{i-1} g_1 $$\n因此，$g_2 = 2g_1$，$g_3 = 4g_1$，$g_4 = 8g_1$。\n\n**步骤 1.2：对每个样本，计算观测计数值与几何平均数的比值。**\n对于每个样本 $j$，我们为所有 $i \\in \\{1, 2, 3, 4\\}$ 创建一组比值 $\\{r_{ij} = N_{ij} / g_i\\}$。因为问题陈述所有计数值均为正，所以我们考虑所有基因。\n\n由于观察到的矩阵结构，这些比值可以简化为：\n$$ r_{ij} = \\frac{N_{ij}}{g_i} = \\frac{2^{i-1} N_{1j}}{2^{i-1} g_1} = \\frac{N_{1j}}{g_1} $$\n这意味着对于一个给定的样本 $j$，比值 $r_{ij}$ 对所有基因 $i$ 都是恒定的。\n\n对于样本 $S_A$：比值均等于 $N_{1A} / g_1 = 100 / g_1$。\n$$ \\frac{100}{(750000)^{1/3}} $$\n对于样本 $S_B$：比值均等于 $N_{1B} / g_1 = 150 / g_1$。\n$$ \\frac{150}{(750000)^{1/3}} $$\n对于样本 $S_C$：比值均等于 $N_{1C} / g_1 = 50 / g_1$。\n$$ \\frac{50}{(750000)^{1/3}} $$\n\n**步骤 1.3：每个样本的大小因子是其比值的中位数。**\n一组相同数字的中位数就是这个数字本身。设 $s_j$ 为样本 $j$ 的大小因子。\n\n对于样本 $S_A$：\n$$ s_A = \\text{median}\\left(\\left\\{\\frac{100}{g_1}, \\frac{100}{g_1}, \\frac{100}{g_1}, \\frac{100}{g_1}\\right\\}\\right) = \\frac{100}{g_1} = \\frac{100}{(750000)^{1/3}} \\approx 1.100639 $$\n对于样本 $S_B$：\n$$ s_B = \\text{median}\\left(\\left\\{\\frac{150}{g_1}, \\frac{150}{g_1}, \\frac{150}{g_1}, \\frac{150}{g_1}\\right\\}\\right) = \\frac{150}{g_1} = \\frac{150}{(750000)^{1/3}} \\approx 1.650959 $$\n对于样本 $S_C$：\n$$ s_C = \\text{median}\\left(\\left\\{\\frac{50}{g_1}, \\frac{50}{g_1}, \\frac{50}{g_1}, \\frac{50}{g_1}\\right\\}\\right) = \\frac{50}{g_1} = \\frac{50}{(750000)^{1/3}} \\approx 0.550320 $$\n\n**第二部分：对统一缩放的不变性**\n\n我们现在必须从第一性原理出发，证明当计数矩阵 $N$ 被一个常数因子 $k > 0$ 缩放时，大小因子是否会改变。设新矩阵为 $N' = k N$，其条目为 $N'_{ij} = k N_{ij}$。设基因数量为 $L$，样本数量为 $M$。\n\n**步骤 2.1：计算新的基因几何平均数 $g'_i$。**\n使用缩放后矩阵 $N'$ 计算的基因 $i$ 的几何平均数为：\n$$ g'_i = \\left( \\prod_{j=1}^{M} N'_{ij} \\right)^{1/M} $$\n代入 $N'_{ij} = k N_{ij}$：\n$$ g'_i = \\left( \\prod_{j=1}^{M} (k N_{ij}) \\right)^{1/M} = \\left( k^M \\prod_{j=1}^{M} N_{ij} \\right)^{1/M} $$\n$$ g'_i = (k^M)^{1/M} \\left( \\prod_{j=1}^{M} N_{ij} \\right)^{1/M} = k \\cdot g_i $$\n每个基因的新几何平均数就是原始几何平均数乘以相同的因子 $k$。\n\n**步骤 2.2：计算新的比值 $r'_{ij}$。**\n使用缩放后数据计算的基因 $i$ 和样本 $j$ 的比值为：\n$$ r'_{ij} = \\frac{N'_{ij}}{g'_i} $$\n代入上一步中 $N'_{ij}$ 和 $g'_i$ 的表达式：\n$$ r'_{ij} = \\frac{k N_{ij}}{k g_i} = \\frac{N_{ij}}{g_i} = r_{ij} $$\n缩放因子 $k$ 完全抵消了。因此，对于每个样本，缩放后矩阵 $N'$ 的比值集合与原始矩阵 $N$ 的比值集合是相同的。\n\n**步骤 2.3：计算新的大小因子 $s'_j$。**\n大小因子 $s'_j$ 是给定样本 $j$ 的新比值集合 $\\{r'_{ij}\\}$ 的中位数：\n$$ s'_j = \\text{median}(\\{r'_{i j}\\}_{i=1}^L) $$\n由于对所有基因 $i$ 都有 $r'_{ij} = r_{ij}$，所以比值集合没有改变。因此，其中位数也必定没有改变。\n$$ s'_j = \\text{median}(\\{r_{i j}\\}_{i=1}^L) = s_j $$\n这证明了从缩放后矩阵 $N'$ 计算出的大小因子与从原始矩阵 $N$ 计算出的大小因子是相同的。对所有计数值进行统一重缩放对 DESeq2 的大小因子没有影响。这个性质是该方法的基础，因为它确保了归一化校正的是文库大小的差异，而不是测量单位的全局变化。\n\n因此，$(S_A, S_B, S_C)$ 的大小因子向量对于矩阵 $N$ 和 $N'$ 是共同的。将计算值四舍五入到四位有效数字，得到：\n$s_A \\approx 1.101$\n$s_B \\approx 1.651$\n$s_C \\approx 0.5503$\n该向量为 $(1.101, 1.651, 0.5503)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.101 & 1.651 & 0.5503\n\\end{pmatrix}\n}\n$$", "id": "2811863"}, {"introduction": "功能基因组学的范畴超越了转录组学，延伸至大规模遗传筛选，系统性地将基因与功能联系起来。最后一个练习模拟了对全基因组CRISPR敲除筛选数据的分析，这是一种用于药物发现的强大技术 [@problem_id:1489253]。您将应用一种通路级别的评分方法来识别“合成致死”相互作用和药物抗性机制，将筛选的原始数据转化为具有生物学可解释性的假说。", "problem": "在一项癌症药物发现计划中，对人类结直肠癌细胞系进行了全基因组 CRISPR-Cas9 敲除筛选，以研究一种新型治疗化合物“Drug-G”的作用机制。我们生成了一个混合细胞库，其中每个细胞都含有一个单基因敲除，靶向约 20,000 个基因中的一个。然后将这个主细胞池分成两个大的群体。一个群体用载体（对照组）处理，另一个用细胞毒性浓度的 Drug-G 处理 14 天。处理期结束后，从两个存活的细胞群体中分离基因组 DNA。通过聚合酶链式反应（PCR）扩增向导 RNA（gRNA）序列，并进行高通量测序以确定每种 gRNA 的相对丰度。\n\n每种 gRNA 丰度的变化被量化为 log2 倍数变化（LFC），计算公式为 `LFC = log2(gRNA count in Drug-G sample / gRNA count in control sample)`。负 LFC 表示相应的基因敲除使细胞对药物敏感（合成致死），而正 LFC 表明敲除赋予了耐药性。\n\n为了超越单基因效应并识别受药物扰动的整个通路，我们为每个已知的生物学通路计算了一个“通路扰动分数”（PPS）。给定通路 `P` 的 PPS 是一个归一化分数，它同时考虑了变化的大小和通路中的基因数量，定义如下：\n\n$$PPS_P = \\frac{\\mu_{\\text{LFC}, P} \\sqrt{n_P}}{\\sigma_{\\text{genome}}}$$\n\n其中：\n- $\\mu_{\\text{LFC}, P}$ 是通路 `P` 内所有基因的平均 LFC。\n- $n_P$ 是通路 `P` 中的基因数量。\n- $\\sigma_{\\text{genome}}$ 是整个基因组中所有基因 LFC 值的标准差，用作衡量背景噪音和脱靶效应的指标。\n\n从筛选中发现，全局标准差为 $\\sigma_{\\text{genome}} = 2.0$。分析集中在三个关键通路上，其汇总统计数据如下：\n\n1.  **通路 A (细胞凋亡调控通路)**: 包含 $n_A = 36$ 个基因，平均 LFC 为 $\\mu_{\\text{LFC}, A} = -0.50$。\n2.  **通路 B (Wnt 信号通路)**: 包含 $n_B = 100$ 个基因，平均 LFC 为 $\\mu_{\\text{LFC}, B} = +0.35$。\n3.  **通路 C (ABC 转运蛋白通路)**: 包含 $n_C = 16$ 个基因，平均 LFC 为 $\\mu_{\\text{LFC}, C} = +0.80$。\n\n其敲除最能使细胞对药物敏感的通路被认为是合成致死伴侣通路，并将具有最负的 PPS。其敲除最能赋予耐药性的通路可能包含药物的直接靶点或是主要的耐药机制，并将具有最正的 PPS。\n\n找出合成致死通路和赋予耐药性的通路。以双字母字符串的形式提供您的答案，其中第一个字母对应合成致死通路（A、B 或 C），第二个字母对应耐药通路（A、B 或 C）。", "solution": "目标是通过计算三个给定通路中每个通路的通路扰动分数（PPS）来识别合成致死通路和赋予耐药性的通路。合成致死通路将具有最负的 PPS，而耐药通路将具有最正的 PPS。\n\n通路扰动分数（PPS）的公式如下：\n$$PPS_P = \\frac{\\mu_{\\text{LFC}, P} \\sqrt{n_P}}{\\sigma_{\\text{genome}}}$$\n\n给定全基因组 LFC 的全局标准差为 $\\sigma_{\\text{genome}} = 2.0$。我们现在将使用所提供的数据计算每个通路的 PPS。\n\n**步骤 1：计算通路 A (细胞凋亡调控通路) 的 PPS**\n通路 A 的参数为：\n- 基因数量，$n_A = 36$\n- 平均 LFC，$\\mu_{\\text{LFC}, A} = -0.50$\n\n将这些值代入 PPS 公式：\n$$PPS_A = \\frac{-0.50 \\times \\sqrt{36}}{2.0}$$\n$$PPS_A = \\frac{-0.50 \\times 6}{2.0}$$\n$$PPS_A = \\frac{-3.0}{2.0}$$\n$$PPS_A = -1.5$$\n\n**步骤 2：计算通路 B (Wnt 信号通路) 的 PPS**\n通路 B 的参数为：\n- 基因数量，$n_B = 100$\n- 平均 LFC，$\\mu_{\\text{LFC}, B} = +0.35$\n\n将这些值代入 PPS 公式：\n$$PPS_B = \\frac{+0.35 \\times \\sqrt{100}}{2.0}$$\n$$PPS_B = \\frac{+0.35 \\times 10}{2.0}$$\n$$PPS_B = \\frac{3.5}{2.0}$$\n$$PPS_B = 1.75$$\n\n**步骤 3：计算通路 C (ABC 转运蛋白通路) 的 PPS**\n通路 C 的参数为：\n- 基因数量，$n_C = 16$\n- 平均 LFC，$\\mu_{\\text{LFC}, C} = +0.80$\n\n将这些值代入 PPS 公式：\n$$PPS_C = \\frac{+0.80 \\times \\sqrt{16}}{2.0}$$\n$$PPS_C = \\frac{+0.80 \\times 4}{2.0}$$\n$$PPS_C = \\frac{3.2}{2.0}$$\n$$PPS_C = 1.6$$\n\n**步骤 4：比较 PPS 值并识别通路**\n三个通路计算出的 PPS 值为：\n- $PPS_A = -1.5$\n- $PPS_B = 1.75$\n- $PPS_C = 1.6$\n\n根据问题描述：\n- 合成致死通路是具有最负 PPS 的通路。比较分数，$PPS_A = -1.5$ 是唯一的负分，因此是最负的。因此，通路 A 是合成致死伴侣通路。\n- 赋予耐药性的通路是具有最正 PPS 的通路。比较正分，$1.75 > 1.6$。因此，$PPS_B$ 是最正的分数。因此，通路 B 是赋予耐药性的通路。\n\n值得注意的是，尽管通路 C 的平均 LFC（$\\mu_{\\text{LFC}, C} = 0.80$）大于通路 B（$\\mu_{\\text{LFC}, B} = 0.35$），但通路 B 的效应分布在更大的一组基因上（$n_B = 100$），这使得其整体扰动在 PPS 的捕捉下更具统计学意义。\n\n**步骤 5：形成最终答案**\n合成致死通路是 A。\n耐药通路是 B。\n最终答案是一个双字母字符串，第一个是合成致死通路，第二个是耐药通路。因此，代码是 AB。", "answer": "$$\\boxed{AB}$$", "id": "1489253"}]}