{"hands_on_practices": [{"introduction": "本章的实践练习旨在将基因转换和减数分裂后分离的分子机制与可量化的遗传结果联系起来。我们的第一个练习将建立一个基础模型，用以理解减数分裂后分离（Post-Meiotic Segregation, PMS）的频率如何直接源于两个关键的分子事件：异源双链DNA中错配的形成及其逃脱修复的概率。通过这个练习，你将运用基本的概率论原理，推导出连接这些微观过程与宏观观察（即PMS子囊频率）的核心方程[@problem_id:2813178]。", "problem": "在对一个丝状真菌的单个双等位基因座进行有序四分体分析时，减数分裂重组过程中可能会形成异源双链DNA。当异源双链跨越亲本等位基因之间的单一位点多态性时，异源双链中可能存在碱基对错配。为此基因座上的单次减数分裂定义以下随机模型。\n\n- 令 $m$ 表示在减数分裂期间该基因座上形成异源双链错配的概率（此概率被理解为已经整合了所有能产生跨越该位点的异源双链的重组构型）。\n- 在存在错配的条件下，令 $q$ 表示该错配在减数分裂和孢子形成过程中未被修复的概率。\n- 假设如果该基因座上的一个错配在孢子形成之前持续未被修复，它将确定性地产生一个减数分裂后分离 (PMS) 子囊，即子囊中至少有一个孢子对于该基因座的两种等位基因状态是嵌合的。假设在该基因座上没有错配的情况下，不会出现可归因于此基因座的PMS。\n- 假设在多次减数分裂中，错配的形成和随后的修复结果是独立的，即在形成错配的条件下未修复的概率为 $q$，而在没有形成错配的情况下未修复的概率为零。\n\n仅使用概率公理（例如，条件概率的定义、事件的乘法法则和全概率定律）以及上述关于异源双链、错配修复和减数分裂后分离 (PMS) 的遗传学定义，推导在所有减数分裂中可归因于此基因座的PMS子囊的期望频率（即概率），并用 $m$ 和 $q$ 表示为一个闭式解析表达式。您的最终答案必须是单一表达式，无需单位。", "solution": "首先必须严格验证问题陈述的科学性和逻辑完整性。\n\n步骤如下：\n\n首先，逐字提取已知条件。\n1.  令 `$m$` 表示在减数分裂期间该基因座上形成异源双链错配的概率。\n2.  在存在错配的条件下，令 `$q$` 表示该错配未被修复的概率。\n3.  如果一个错配持续未被修复，它将确定性地产生一个减数分裂后分离 (PMS) 子囊。\n4.  在没有错配的情况下，不会出现可归因于此基因座的PMS。\n5.  根据定义，错配的形成和修复结果是独立的。\n\n其次，验证这些已知条件。\n该问题描述了一个简化的减数分裂基因转换随机模型，这是遗传学中的一个基本概念。参数 `$m$` 和 `$q$` 被定义为概率，异源双链形成、错配修复和减数分裂后分离之间的关系与遗传学中教授的既定生物学模型一致。该问题具有科学依据，表述清晰，客观且自成体系。它不包含任何逻辑矛盾、未指明的参数或事实错误。因此，该问题被认定为有效。\n\n我们继续进行推导。\n\n令 `$E_{PMS}$` 表示观察到减数分裂后分离 (PMS) 子囊的事件。\n令 `$E_{MM}$` 表示在该基因座上形成异源双链错配的事件。\n问题要求计算 `$E_{PMS}$` 的概率，记为 `$P(E_{PMS})$`。\n\n根据已知条件，我们可以直接将以下概率形式化：\n形成错配的概率给定为 `$m$`：\n$$ P(E_{MM}) = m $$\n没有形成错配的概率是其互补事件 `$E_{MM}^c$`，因此：\n$$ P(E_{MM}^c) = 1 - P(E_{MM}) = 1 - m $$\n在形成错配的条件下，错配未被修复的概率给定为 `$q$`：\n$$ P(\\text{unrepaired} | E_{MM}) = q $$\n\n问题陈述指出，当且仅当一个错配形成并持续未被修复时，才会确定性地产生一个PMS子囊。这意味着，在形成错配的条件下观察到PMS的概率，等于该错配未被修复的概率。\n$$ P(E_{PMS} | E_{MM}) = P(\\text{unrepaired} | E_{MM}) = q $$\n\n此外，问题陈述指出在没有错配的情况下，不会出现PMS。这给出了在没有形成错配的条件下发生PMS的条件概率：\n$$ P(E_{PMS} | E_{MM}^c) = 0 $$\n\n为了求出观察到PMS子囊的总概率 `$P(E_{PMS})$`，我们应用全概率定律。所有减数分裂的样本空间可以被划分为两个互斥事件：形成错配（`$E_{MM}$`）或不形成错配（`$E_{MM}^c$`）。全概率定律表述为：\n$$ P(E_{PMS}) = P(E_{PMS} | E_{MM})P(E_{MM}) + P(E_{PMS} | E_{MM}^c)P(E_{MM}^c) $$\n\n现在，我们将从问题陈述中推导出的值和表达式代入此公式：\n$$ P(E_{PMS}) = (q)(m) + (0)(1 - m) $$\n\n简化表达式得到结果：\n$$ P(E_{PMS}) = mq + 0 $$\n$$ P(E_{PMS}) = mq $$\n\n此表达式代表了可归因于该基因座的PMS子囊的期望频率，它严格地从给定的公理和定义中推导得出。这是两个事件的联合概率：形成一个错配以及其随后未能被修复。", "answer": "$$ \\boxed{mq} $$", "id": "2813178"}, {"introduction": "在建立了理论模型之后，下一步是将其应用于实验数据。这个练习将带你从理论走向实践，学习如何根据在四分体分析中观察到的基因转换事件（表现为 3:1 的分离模式）来估计基因转换的频率。你将使用最大似然估计法来计算最可能的基因转换概率，并利用Clopper-Pearson方法构建一个精确的置信区间，从而对你的估计值的不确定性进行量化[@problem_id:2813218]。", "problem": "在对酿酒酵母（Saccharomyces cerevisiae）的单个标记基因座进行的有序四分体分析中，当该基因座发生基因转换事件时，一次减数分裂可在四个孢子中产生3:1的分离模式，而预期的孟德尔模式为2:2。假设单个基因座的基因转换事件在不同减数分裂中独立发生，并且对于一个固定的基因座，在任何给定的减数分裂中观察到3:1四分体的概率是一个常数$p$（每次减数分裂的基因转换概率）。考虑一个数据集，其中解剖了$n$个独立的酵母囊，并且其中$k$个在该基因座上显示出3:1的分离。在独立同分布试验的标准二项抽样模型下，$n$个酵母囊中3:1四分体的计数$K$服从二项分布$\\text{Binomial}(n,p)$。\n\n仅使用二项分布似然性的基本原理和通过累积分布函数反演的精确置信集构建方法（即源自二项分布的等尾Clopper–Pearson方法），对特定数据$n=150$和$k=0$执行以下操作：\n\n1. 推导$p$的最大似然估计$\\hat{p}$。\n2. 通过反演二项分布$\\text{Binomial}(n,p)$的累积分布函数以获得等尾界限，构建$p$的精确双侧$95\\%$置信区间。使用适当的初等函数以闭式形式表示最终的界限。不要进行数值计算，也不要提供小数近似值；报告一个精确的闭式表达式。\n\n将您的最终答案报告为一个单行向量，其中包含三个条目，顺序为$\\hat{p}$、置信下限和置信上限。无需四舍五入，不涉及单位。", "solution": "该问题陈述具有科学依据，提法恰当，并包含推导所要求数量的所有必要信息。它描述了一个应用于遗传学的标准统计推断问题。我们将着手进行推导。\n\n观测到的$3:1$四分体数量，由随机变量$K$表示，假定服从参数为$n$和$p$的二项分布。其概率质量函数由下式给出：\n$$P(K=k | n,p) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n其中$n=150$是独立试验（酵母囊）的次数，而$p$是导致$3:1$分离模式的基因转换事件的未知概率。观测到的结果是$k=0$。\n\n首先，我们推导$p$的最大似然估计 (MLE)，记为$\\hat{p}$。似然函数$L(p;k)$与概率质量函数成正比：\n$$L(p;k) \\propto p^k (1-p)^{n-k}$$\n处理对数似然函数$\\ell(p;k) = \\ln(L(p;k))$更为方便：\n$$\\ell(p;k) = k \\ln(p) + (n-k) \\ln(1-p) + C$$\n其中$C$是与$p$无关的常数。MLE是通过关于$p$最大化$\\ell(p;k)$来找到的。对数似然的导数是：\n$$\\frac{d\\ell}{dp} = \\frac{k}{p} - \\frac{n-k}{1-p}$$\n对于给定的数据$n=150$和$k=0$，对数似然函数简化为：\n$$\\ell(p;0) = 150 \\ln(1-p) + C$$\n其导数为：\n$$\\frac{d\\ell}{dp} = -\\frac{150}{1-p}$$\n对于$p \\in [0,1)$，该导数恒为负。这表明似然函数是$p$的严格递减函数。因此，该函数在$p$的定义域中的最低可能值处取得最大值，即$p=0$。\n因此，最大似然估计为：\n$$\\hat{p} = 0$$\n\n其次，我们使用Clopper-Pearson方法构建$p$的精确$95\\%$双侧置信区间。该方法基于反演二项分布的累积分布函数 (CDF)。置信水平为$1-\\alpha = 0.95$，这意味着$\\alpha = 0.05$和$\\alpha/2 = 0.025$。置信区间$[p_L, p_U]$由所有$p_0$值的集合定义，使得原假设$H_0: p=p_0$在与观测数据$k=0$进行检验时不会被拒绝。\n\n置信下限$p_L$是解以下方程的$p$值：\n$$P(K \\ge k | p=p_L) = \\frac{\\alpha}{2}$$\n对于观测值$k=0$，该方程变为$P(K \\ge 0 | p=p_L) = \\alpha/2$。由于对于任何$p>0$都有$P(K \\ge 0) = 1$，方程$1 = 0.025$无解。根据Clopper-Pearson区间对边界情况$k=0$的定义，下限被设置为参数空间的绝对边界。\n$$p_L = 0$$\n\n置信上限$p_U$是解以下方程的$p$值：\n$$P(K \\le k | p=p_U) = \\frac{\\alpha}{2}$$\n这等价于找到使二项CDF在$k$处的值等于$\\alpha/2$的$p_U$值。对于观测值$k=0$，方程为：\n$$P(K \\le 0 | p=p_U) = \\frac{\\alpha}{2}$$\n事件$K \\le 0$仅包含一个结果，$K=0$。因此：\n$$P(K=0 | p=p_U) = \\binom{n}{0} p_U^0 (1-p_U)^{n-0} = (1-p_U)^n$$\n我们令其等于$\\alpha/2$并解出$p_U$：\n$$(1-p_U)^n = \\frac{\\alpha}{2}$$\n代入$n=150$和$\\alpha=0.05$：\n$$(1-p_U)^{150} = \\frac{0.05}{2} = 0.025$$\n两边取$150$次方根：\n$$1-p_U = (0.025)^{\\frac{1}{150}}$$\n解出$p_U$：\n$$p_U = 1 - (0.025)^{\\frac{1}{150}}$$\n这就是所要求的上限的闭式表达式。\n\n总之，对于数据$n=150$和$k=0$：\n1. 最大似然估计为$\\hat{p} = 0$。\n2. 精确$95\\%$置信区间为$[p_L, p_U] = [0, 1 - (0.025)^{\\frac{1}{150}}]$。\n\n所要求的三个值为$\\hat{p}$、$p_L$和$p_U$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  & 0 & 1 - (0.025)^{\\frac{1}{150}}\n\\end{pmatrix}\n}\n$$", "id": "2813218"}, {"introduction": "最后的练习将挑战一个更高级、在生物学上意义重大的问题：量化具有GC偏向性的基因转换（GC-biased gene conversion, gBGC），这是一个重要的进化驱动力。与之前的练习不同，本次练习引入了真实世界实验中常见的复杂情况——数据记录错误。你将需要推导出一个能够修正系统性测量误差的统计估计量，从而更准确地揭示潜在的生物学偏向性[@problem_id:2813164]。", "problem": "一个二倍体酵母在许多腺嘌呤/胸腺嘧啶对鸟嘌呤/胞嘧啶（A/T对G/C）类的单核苷酸位点上是杂合的。在减数分裂重组过程中，这些位点上可以形成异源双链DNA，随后的错配修复可能导致非孟德尔式分离。定义每个事件的鸟嘌呤/胞嘧啶偏向参数 $b$ 为，在某个此类位点上产生完全修复的非孟德尔式结果的条件下，错配被修复为鸟嘌呤/胞嘧啶等位基因而非腺嘌呤/胸腺嘧啶等位基因的概率。在四分体分析中，一个完全修复的非孟德尔式结果表现为该位点上的 $3:1$ 分离，而未修复则可能产生 $5:3$ 或 $3:5$ 的减数分裂后分离（Post-Meiotic Segregation, PMS）。假设异源双链相对于亲本等位基因的朝向是对称的，并且我们以在信息性A/T对G/C位点上产生 $3:1$ 结果的事件为条件，因此 $b$ 可以通过偏向鸟嘌呤/胞嘧啶的 $3:1$ 事件的比例来确定。\n\n在实践中，将一个 $3:1$ 事件分类为“偏向鸟嘌呤/胞嘧啶”（三个孢子携带鸟嘌呤/胞嘧啶等位基因，一个携带腺嘌呤/胸腺嘧啶等位基因）或“偏向腺嘌呤/胸腺嘧啶”时，会存在一个小的、对称的记录错误：一个真实的偏向鸟嘌呤/胞嘧啶的事件有概率 $\\epsilon$ 被记录为偏向腺嘌呤/胸腺嘧啶，同样地，一个真实的偏向腺嘌呤/胸腺嘧啶的事件也有概率 $\\epsilon$ 被记录为偏向鸟嘌呤/胞嘧啶。假设事件之间是独立的。\n\n从 $n$ 个独立的四分体中，每个四分体都包含一个显示 $3:1$ 分离的信息性A/T对G/C位点，你观察到 $k$ 个事件被记录为偏向鸟嘌呤/胞嘧啶。在一个数据集中，有 $n = 1{,}500$ 个这样的 $3:1$ 事件和一个经过验证的对称错分类率 $\\epsilon = 0.02$，你观察到 $k = 915$ 个偏向鸟嘌呤/胞嘧啶的记录。\n\n从基本概率定义和带有对称错分类的二项抽样模型出发，推导鸟嘌呤/胞嘧啶偏向参数 $b$ 的最大似然估计量 $\\hat{b}$，并根据给定数据计算其值。将最终数值答案四舍五入到四位有效数字。最终答案以纯数字形式表示，不带任何单位或百分号。", "solution": "该问题要求在一个考虑了测量误差的统计模型中，推导生物学参数 $b$ 的最大似然估计量。对问题陈述进行严格验证是首要且最关键的一步。\n\n步骤1：提取给定信息。\n- 一个二倍体酵母在A/T对G/C位点上是杂合的。\n- $b$：每个事件的鸟嘌呤/胞嘧啶偏向参数，定义为一个完全修复的非孟德尔式结果（$3:1$ 分离）被修复为鸟嘌呤/胞嘧啶（G/C）等位基因的概率。\n- 我们以产生 $3:1$ 结果的事件为条件。\n- $\\epsilon$：一个对称的记录错误概率。$P(\\text{recorded A/T} | \\text{true G/C}) = \\epsilon$ 且 $P(\\text{recorded G/C} | \\text{true A/T}) = \\epsilon$。\n- $n$：具有 $3:1$ 分离的独立四分体数量，给定为 $n = 1{,}500$。\n- $k$：*被记录*为偏向G/C的事件数量，给定为 $k = 915$。\n- 经过验证的对称错分类率为 $\\epsilon = 0.02$。\n- 任务是推导 $b$ 的最大似然估计量 $\\hat{b}$，并计算其值，结果四舍五入到四位有效数字。\n\n步骤2：使用提取的给定信息进行验证。\n该问题具有科学依据，借鉴了遗传学中的既定概念，如基因转换、错配修复和四分体中的非孟德尔式分离。其统计框架——一个带有错分类层的二项抽样模型——是数理统计学中一个标准且适定的问题。所使用的语言客观而精确。所有必要的参数（$n$、$k$、$\\epsilon$）都已提供，且没有内部矛盾。数值对于生物学实验来说是合理的。该问题要求推导最大似然估计量，这是一个明确定义的数学目标，在这些条件下有唯一解。这个问题并非微不足道，因为它需要对已知的误差源进行校正，这是实验科学中的一项常见任务。\n\n步骤3：结论与行动。\n问题被认定为有效。将提供一个完整的、有理有据的解决方案。\n\n目标是找到参数 $b$ 的最大似然估计量（MLE）。让我们首先定义观察到偏向G/C记录的概率。\n设 $T_G$ 为一个真实的 $3:1$ 分离是偏向G/C的事件。问题陈述该事件的概率为 $b$。\n$$P(T_G) = b$$\n因此，一个真实的 $3:1$ 分离是偏向腺嘌呤/胸腺嘧啶（A/T）的事件 $T_A$ 的概率为：\n$$P(T_A) = 1 - b$$\n设 $R_G$ 为一个分离被*记录*为偏向G/C的事件。我们已知对称的错分类概率：\n$P(\\text{recorded as A/T} | T_G) = \\epsilon$\n$P(\\text{recorded as G/C} | T_A) = \\epsilon$\n\n由此，我们可以陈述正确分类的概率：\n$P(R_G | T_G) = 1 - P(\\text{recorded as A/T} | T_G) = 1 - \\epsilon$\n$P(\\text{recorded as A/T} | T_A) = 1 - P(R_G | T_A) = 1 - \\epsilon$\n\n设 $p$ 为一个事件被记录为偏向G/C的总概率。我们可以使用全概率公式计算 $p$：\n$$p = P(R_G) = P(R_G|T_G)P(T_G) + P(R_G|T_A)P(T_A)$$\n代入已知值和参数：\n$$p = (1 - \\epsilon)b + \\epsilon(1 - b)$$\n$$p = b - b\\epsilon + \\epsilon - b\\epsilon$$\n$$p = b(1 - 2\\epsilon) + \\epsilon$$\n这个表达式将真实的潜在偏向 $b$ 与观察到的偏向G/C记录的概率 $p$ 联系起来。\n\n数据包含 $n$ 次独立试验，其中 $k$ 次被记录为偏向G/C。这遵循二项分布。在 $n$ 次试验中观察到恰好 $k$ 次此类记录的概率由下式给出：\n$$P(k | n, p) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n似然函数 $L(b; k, n, \\epsilon)$ 是将此概率视为参数 $b$ 的函数。我们可以忽略常数二项式系数 $\\binom{n}{k}$，因为它不影响最大值的位置。\n$$L(b) \\propto p^k (1-p)^{n-k}$$\n将 $p$ 关于 $b$ 和 $\\epsilon$ 的表达式代入：\n$$L(b) \\propto [b(1 - 2\\epsilon) + \\epsilon]^k [1 - (b(1 - 2\\epsilon) + \\epsilon)]^{n-k}$$\n$$L(b) \\propto [b(1 - 2\\epsilon) + \\epsilon]^k [1 - \\epsilon - b(1 - 2\\epsilon)]^{n-k}$$\n为了找到使该函数最大化的 $b$ 值，计算上更简单的方法是最大化对数似然函数 $\\ell(b) = \\ln L(b)$。\n$$\\ell(b) = k \\ln[b(1 - 2\\epsilon) + \\epsilon] + (n-k) \\ln[1 - \\epsilon - b(1 - 2\\epsilon)] + C$$\n其中 $C$ 是一个常数项。我们通过对 $\\ell(b)$ 关于 $b$ 求导并令其为零来找到最大值。\n$$\\frac{d\\ell}{db} = \\frac{k \\cdot (1 - 2\\epsilon)}{b(1 - 2\\epsilon) + \\epsilon} + \\frac{(n-k) \\cdot (-(1 - 2\\epsilon))}{1 - \\epsilon - b(1 - 2\\epsilon)}$$\n设 $\\frac{d\\ell}{db} = 0$ 来找到最大似然估计量，我们记为 $\\hat{b}$。假设 $1 - 2\\epsilon \\neq 0$（对于 $\\epsilon=0.02$ 这是成立的），我们可以将整个方程除以 $(1 - 2\\epsilon)$：\n$$\\frac{k}{\\hat{b}(1 - 2\\epsilon) + \\epsilon} - \\frac{n-k}{1 - \\epsilon - \\hat{b}(1 - 2\\epsilon)} = 0$$\n$$\\frac{k}{\\hat{b}(1 - 2\\epsilon) + \\epsilon} = \\frac{n-k}{1 - \\epsilon - \\hat{b}(1 - 2\\epsilon)}$$\n现在，我们求解 $\\hat{b}$：\n$$k(1 - \\epsilon - \\hat{b}(1 - 2\\epsilon)) = (n-k)(\\hat{b}(1 - 2\\epsilon) + \\epsilon)$$\n$$k - k\\epsilon - k\\hat{b}(1 - 2\\epsilon) = (n-k)\\hat{b}(1 - 2\\epsilon) + (n-k)\\epsilon$$\n重新整理以分离含 $\\hat{b}$ 的项：\n$$k - k\\epsilon - (n-k)\\epsilon = \\hat{b}(1 - 2\\epsilon) (k + (n-k))$$\n$$k - k\\epsilon - n\\epsilon + k\\epsilon = \\hat{b}(1 - 2\\epsilon)n$$\n$$k - n\\epsilon = n\\hat{b}(1 - 2\\epsilon)$$\n这就得出了最大似然估计量 $\\hat{b}$ 的表达式：\n$$\\hat{b} = \\frac{k - n\\epsilon}{n(1 - 2\\epsilon)}$$\n这也可以用观察比例 $\\hat{p} = k/n$ 来表示：\n$$\\hat{b} = \\frac{\\frac{k}{n} - \\epsilon}{1 - 2\\epsilon}$$\n这个估计量实质上是对朴素的观察比例 $\\hat{p}$ 进行了错分类效应的“校正”。\n\n现在，我们代入给定的数值：$n = 1{,}500$，$k = 915$，以及 $\\epsilon = 0.02$。\n首先，计算表达式所需的项：\n$$n\\epsilon = 1{,}500 \\times 0.02 = 30$$\n$$1 - 2\\epsilon = 1 - 2 \\times 0.02 = 1 - 0.04 = 0.96$$\n将这些值代入 $\\hat{b}$ 的公式中：\n$$\\hat{b} = \\frac{915 - 30}{1{,}500(0.96)}$$\n$$\\hat{b} = \\frac{885}{1{,}440}$$\n现在，我们进行除法运算以获得数值：\n$$\\hat{b} = \\frac{885}{1{,}440} = 0.61458333...$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\\hat{b} \\approx 0.6146$$\n该值是一个概率，并且正确地位于 $[0, 1]$ 区间内。\n推导完成，数值已按要求计算。", "answer": "$$\\boxed{0.6146}$$", "id": "2813164"}]}