{"hands_on_practices": [{"introduction": "理解RNA结构稳定性的核心在于其热力学。最近邻模型是预测RNA二级结构热力学的基石，它将复杂结构的整体稳定性分解为碱基对堆积等局部相互作用的能量贡献之和。这项练习[@problem_id:2848597]将引导你应用该模型，亲手计算一种普遍存在的结构基元——发夹环——的折叠自由能，从而将抽象的能量概念转化为具体的计算实践。", "problem": "在温度$37^{\\circ}\\mathrm{C}$下，一个较长核糖核酸（RNA）分子中的一段信使核糖核酸（mRNA）片段内部形成了一个分子内发夹结构。折叠的局部序列为\n5'-G C G C A A A U U C G C G-3'，\n它形成一个发夹，包含一个$5$个核苷酸的环（序列为 A A A U U）和一个$4$个碱基对的Watson–Crick茎，其中$5'$臂为 G C G C，$3'$臂为其反向互补序列 C G C G。假设没有非经典碱基对，没有悬挂末端，也没有三级相互作用。\n\n使用$37^{\\circ}\\mathrm{C}$下RNA二级结构的热力学最近邻相加模型，其中折叠自由能变化$\\Delta G_{37}$是以下各项的总和：\n- 茎区每对相邻碱基对的碱基对堆积贡献，使用以下Watson–Crick最近邻自由能（单位：kcal/mol）：\n  - GC/CG: $\\Delta G_{37} = -3.40$\n  - CG/GC: $\\Delta G_{37} = -2.40$\n- 仅取决于环长度的发夹环起始罚分（单位：kcal/mol）：\n  - 环长度$5$：$\\Delta G_{37} = +5.60$\n- 外部螺旋末端每个末端AU或GU碱基对的末端罚分（单位：kcal/mol）：\n  - 螺旋末端的AU或GU：每个此类末端对$\\Delta G_{37} = +0.45$\n  - 螺旋末端的GC：$\\Delta G_{37} = 0.00$\n\n没有其他额外的奖励或罚分。\n\n计算此发夾的总折叠自由能变化$\\Delta G_{37}$（单位：kcal/mol）。将您的答案四舍五入至三位有效数字。以 kcal/mol 为单位表示最终能量。", "solution": "问题陈述已经过验证，被认为是科学上合理的、问题明确的且内部一致的。它提出了一个基于已建立的核糖核酸（RNA）二级结构最近邻模型的标准生物物理计算。所有必需的参数都已提供。\n\n目标是计算指定分子内发夹结构形成的总折叠自由能变化$\\Delta G_{37}$。根据所提供的热力学最近邻相加模型，总自由能变化是碱基对堆积、环起始和末端罚分贡献的总和。\n控制方程为：\n$$\n\\Delta G_{37, \\text{total}} = \\Delta G_{\\text{stacking}} + \\Delta G_{\\text{loop}} + \\Delta G_{\\text{terminal}}\n$$\n\n首先，我们必须仔细分析由序列 $5'$-G C G C A A A U U C G C G-$3'$ 形成的发夹结构。问题说明它形成一个具有$4$个碱基对的茎和$5$个核苷酸的环。茎的$5'$臂是序列 $5'$-G C G C-$3'$，而$3'$臂是其反向互补序列 $5'$-C G C G-$3'$。在完整序列 $5'$-G$_1$C$_2$G$_3$C$_4$A$_5$A$_6$A$_7$U$_8$U$_9$C$_{10}$G$_{11}$C$_{12}$G$_{13}$-$3'$ 中，这对应于$5'$段 G$_1$C$_2$G$_3$C$_4$ 与 $3'$段 C$_{10}$G$_{11}$C$_{12}$G$_{13}$ 的配对。具体来说，Watson-Crick碱基对是 G$_1$-C$_{13}$、C$_2$-G$_{12}$、G$_3$-C$_{11}$ 和 C$_4$-G$_{10}$。配对片段之间的核苷酸 A$_5$A$_6$A$_7$U$_8$U$_9$ 形成$5$个核苷酸的环。\n\n结构确定后，我们计算每个能量贡献。\n\n$1$. $\\Delta G_{\\text{stacking}}$：堆积自由能是茎中相邻碱基对贡献的总和。存在 $n-1 = 4-1 = 3$ 个这样的堆积相互作用。我们从螺旋的外部末端朝向环来识别它们：\n- 第一个堆积发生在 G$_1$-C$_{13}$ 对和 C$_2$-G$_{12}$ 对之间。这对应于一条链上的 $5'$-GC-$3'$ 二核苷酸堆积在另一条链上的 $3'$-CG-$5'$ 二核苷酸之上。这是一个 GC/CG 堆积。提供的自由能为 $\\Delta G_{37}(\\text{GC/CG}) = -3.40~\\mathrm{kcal/mol}$。\n- 第二个堆积发生在 C$_2$-G$_{12}$ 对和 G$_3$-C$_{11}$ 对之间。这对应于一条链上的 $5'$-CG-$3'$ 二核苷酸堆积在另一条链上的 $3'$-GC-$5'$ 二核苷酸之上。这是一个 CG/GC 堆积。提供的自由能为 $\\Delta G_{37}(\\text{CG/GC}) = -2.40~\\mathrm{kcal/mol}$。\n- 第三个堆积发生在 G$_3$-C$_{11}$ 对和 C$_4$-G$_{10}$ 对之间。这对应于一条链上的 $5'$-GC-$3'$ 二核苷酸堆积在另一条链上的 $3'$-CG-$5'$ 二核苷酸之上。这是另一个 GC/CG 堆积。提供的自由能为 $\\Delta G_{37}(\\text{GC/CG}) = -3.40~\\mathrm{kcal/mol}$。\n\n总堆积自由能是这些贡献的总和：\n$$\n\\Delta G_{\\text{stacking}} = (-3.40) + (-2.40) + (-3.40) = -9.20~\\mathrm{kcal/mol}\n$$\n\n$2$. $\\Delta G_{\\text{loop}}$：发夹环起始罚分取决于环的长度。该环由$5$个核苷酸组成 (A$_5$A$_6$A$_7$U$_8$U$_9$)。问题明确了长度为$5$的环的罚分：\n$$\n\\Delta G_{\\text{loop}} = +5.60~\\mathrm{kcal/mol}\n$$\n\n$3$. $\\Delta G_{\\text{terminal}}$：对于外部螺旋末端的末端AU或GU对，会施加一个罚分。此发夹茎的外部末端是 G$_1$-C$_{13}$ 碱基对。由于这是一个 GC 对，因此指定的罚分为零。\n$$\n\\Delta G_{\\text{terminal}} = 0.00~\\mathrm{kcal/mol}\n$$\n\n最后，我们将这些分量相加以求出发夹形成的总自由能变化：\n$$\n\\Delta G_{37, \\text{total}} = \\Delta G_{\\text{stacking}} + \\Delta G_{\\text{loop}} + \\Delta G_{\\text{terminal}}\n$$\n$$\n\\Delta G_{37, \\text{total}} = (-9.20) + (5.60) + (0.00) = -3.60~\\mathrm{kcal/mol}\n$$\n结果 $-3.60$ 已按要求用三位有效数字表示。$\\Delta G_{37}$ 的负值表明，在指定条件下，此发夹结构的形成是自发的。", "answer": "$$ \\boxed{-3.60} $$", "id": "2848597"}, {"introduction": "除了静态结构，RNA序列和结构中的特定模式还充当着重要的调控信号。本练习[@problem_id:2848576]将探讨mRNA中的Kozak序列如何影响翻译起始的效率，并要求你使用一个简明的定量模型来预测“泄露扫描”这一功能性结果的概率。通过这个实践，你将学会如何将序列信息与具体的生物学行为联系起来，这是从序列到功能建模的关键一步。", "problem": "一个真核信使RNA (mRNA) 由一个包含核糖体小亚基（其核心是核糖体RNA (rRNA)）和甲硫氨酰-起始转移RNA (tRNA) 的43S前起始复合物进行翻译，该复合物从加帽的$5^{\\prime}$端开始扫描以定位起始密码子。在扫描模型中，第一个腺嘌呤–尿嘧啶–鸟嘌呤 (AUG) 密码子是否被识别，取决于被称为Kozak上下文的局部序列上下文。根据经验，第一个AUG处的识别源于起始密码子识别和继续扫描（渗漏扫描）之间的竞争。\n\n考虑一个特定mRNA的第一个AUG。相对于位于$+1$位置的AUG中的腺嘌呤，从位置$-6$到$+4$的局部序列上下文为：\n\n$$\n-6\\ -5\\ -4\\ -3\\ -2\\ -1\\ +1\\ +2\\ +3\\ +4: \\quad \\mathrm{G}\\ \\ \\mathrm{C}\\ \\ \\mathrm{C}\\ \\ \\mathrm{A}\\ \\ \\mathrm{C}\\ \\ \\mathrm{C}\\ \\ \\mathrm{A}\\ \\ \\mathrm{U}\\ \\ \\mathrm{G}\\ \\ \\mathrm{U}.\n$$\n\n使用一个简约的、经验校准的、位置特异性线性模型来定义一个Kozak上下文强度得分$S$，该模型捕捉了$-3$和$+4$位置的主要信息：\n\n$$\nS \\equiv \\beta_{0} + \\beta_{-3}^{R}\\, I_{-3}^{R} + \\beta_{+4}^{G}\\, I_{+4}^{G},\n$$\n\n其中，如果$-3$位置的核苷酸是嘌呤（$\\mathrm{A}\\ \\text{or}\\ \\mathrm{G}$），则$I_{-3}^{R}=1$，否则为$0$；如果$+4$位置的核苷酸是$\\mathrm{G}$，则$I_{+4}^{G}=1$，否则为$0$。使用经验确定的参数\n\n$$\n\\beta_{0} = -1.5,\\quad \\beta_{-3}^{R} = 1.2,\\quad \\beta_{+4}^{G} = 1.1.\n$$\n\n\n假设在第一个AUG处，起始和扫描通过之间存在双路径竞争，每次相遇的起始概率由下式给出\n\n$$\nP_{\\text{init}}=\\frac{k_{\\text{init}}}{k_{\\text{init}}+k_{\\text{pass}}},\n$$\n\n并且起始速率对$S$的依赖关系呈经验验证的玻尔兹曼式形式，\n\n$$\nk_{\\text{init}} = k^{\\ast} \\exp(S),\n$$\n\n其中$k_{\\text{pass}}$是与上下文无关的通过速率，$k^{\\ast}$是常数。通过将$\\ln\\!\\left(\\frac{k^{\\ast}}{k_{\\text{pass}}}\\right)$并入$\\beta_{0}$，第一个AUG处的起始概率成为$S$的逻辑斯蒂函数。使用所提供的上下文和参数，计算Kozak上下文强度得分$S$，然后计算越过第一个AUG的渗漏扫描的预测概率，\n\n$$\nP_{\\text{leak}} \\equiv 1 - P_{\\text{init}}.\n$$\n\n将$P_{\\text{leak}}$报告为一个纯数字，四舍五入到四位有效数字。", "solution": "该问题陈述已经过验证，并被认定为有效。它在科学上基于分子生物学的既定原理，特别是真核生物翻译起始的机制，包括扫描模型、Kozak共有序列和渗漏扫描。该问题定义明确，提供了一个清晰的定量模型、所有必需的参数以及一个需要回答的具体问题。定义和数据是自洽且一致的，语言客观而精确。因此，将提供一个解答。\n\n该问题要求计算给定信使RNA (mRNA) 序列上下文的渗漏扫描概率$P_{\\text{leak}}$。这将通过三个步骤完成：首先，根据提供的序列确定指示变量的值；其次，计算Kozak上下文强度得分$S$；第三，使用$S$计算渗漏扫描的概率$P_{\\text{leak}}$。\n\n步骤1：确定指示变量$I_{-3}^{R}$和$I_{+4}^{G}$。\n给定的从位置$-6$到$+4$的序列上下文是：\n$$\n\\mathrm{G}\\ \\ \\mathrm{C}\\ \\ \\mathrm{C}\\ \\ \\mathrm{A}\\ \\ \\mathrm{C}\\ \\ \\mathrm{C}\\ \\ \\mathrm{A}\\ \\ \\mathrm{U}\\ \\ \\mathrm{G}\\ \\ \\mathrm{U}\n$$\n位置是相对于位于$+1$位置的起始密码子AUG中的腺嘌呤（A）进行索引的。位于$-3$位置的核苷酸是A。$I_{-3}^{R}$的定义是，如果$-3$位置的核苷酸是嘌呤（A或G），则其值为$1$，否则为$0$。由于A是嘌呤，我们有：\n$$\nI_{-3}^{R} = 1\n$$\n位于$+4$位置的核苷酸是U。$I_{+4}^{G}$的定义是，如果$+4$位置的核苷酸是G，则其值为$1$，否则为$0$。由于U不是G，我们有：\n$$\nI_{+4}^{G} = 0\n$$\n\n步骤2：计算Kozak上下文强度得分$S$。\n得分$S$由线性模型定义：\n$$\nS \\equiv \\beta_{0} + \\beta_{-3}^{R}\\, I_{-3}^{R} + \\beta_{+4}^{G}\\, I_{+4}^{G}\n$$\n问题提供了经验确定的参数：\n$$\n\\beta_{0} = -1.5,\\quad \\beta_{-3}^{R} = 1.2,\\quad \\beta_{+4}^{G} = 1.1\n$$\n将这些值和步骤1中确定的指示变量代入$S$的方程中：\n$$\nS = -1.5 + (1.2)(1) + (1.1)(0) = -1.5 + 1.2 + 0 = -0.3\n$$\n因此，Kozak上下文强度得分为$S = -0.3$。\n\n步骤3：计算渗漏扫描的概率$P_{\\text{leak}}$。\n起始概率$P_{\\text{init}}$由起始速率$k_{\\text{init}}$和通过速率$k_{\\text{pass}}$之间的竞争给出：\n$$\nP_{\\text{init}}=\\frac{k_{\\text{init}}}{k_{\\text{init}}+k_{\\text{pass}}}\n$$\n根据玻尔兹曼式的依赖关系$k_{\\text{init}} = k^{\\ast} \\exp(S)$，这变为：\n$$\nP_{\\text{init}} = \\frac{k^{\\ast} \\exp(S)}{k^{\\ast} \\exp(S) + k_{\\text{pass}}}\n$$\n将分子和分母同除以$k^{\\ast} \\exp(S)$得到：\n$$\nP_{\\text{init}} = \\frac{1}{1 + \\frac{k_{\\text{pass}}}{k^{\\ast}}\\exp(-S)} = \\frac{1}{1 + \\exp\\left(-S + \\ln\\left(\\frac{k_{\\text{pass}}}{k^{\\ast}}\\right)\\right)} = \\frac{1}{1 + \\exp\\left(-\\left(S - \\ln\\left(\\frac{k_{\\text{pass}}}{k^{\\ast}}\\right)\\right)\\right)}\n$$\n问题陈述指出，项$\\ln(k^{\\ast}/k_{\\text{pass}}) = -\\ln(k_{\\text{pass}}/k^{\\ast})$被并入截距参数$\\beta_0$中。这意味着我们使用给定的$\\beta_0$计算出的得分$S$是逻辑斯蒂函数参数中的有效得分。因此，起始概率简化为$S$的标准逻辑斯蒂S型函数：\n$$\nP_{\\text{init}} = \\frac{1}{1 + \\exp(-S)}\n$$\n渗漏扫描的概率定义为$P_{\\text{leak}} \\equiv 1 - P_{\\text{init}}$。代入$P_{\\text{init}}$的表达式：\n$$\nP_{\\text{leak}} = 1 - \\frac{1}{1 + \\exp(-S)} = \\frac{1 + \\exp(-S) - 1}{1 + \\exp(-S)} = \\frac{\\exp(-S)}{1 + \\exp(-S)}\n$$\n这个表达式也可以写成：\n$$\nP_{\\text{leak}} = \\frac{1}{\\exp(S) + 1}\n$$\n现在，我们将计算出的值$S = -0.3$代入这个方程：\n$$\nP_{\\text{leak}} = \\frac{1}{1 + \\exp(-0.3)}\n$$\n我们计算其数值：\n$$\n\\exp(-0.3) \\approx 0.74081822068\n$$\n$$\nP_{\\text{leak}} \\approx \\frac{1}{1 + 0.74081822068} = \\frac{1}{1.74081822068} \\approx 0.5744425168\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nP_{\\text{leak}} \\approx 0.5744\n$$\n这就是给定mRNA序列上下文的渗漏扫描的最终预测概率。", "answer": "$$\\boxed{0.5744}$$", "id": "2848576"}, {"introduction": "从一级序列预测完整的RNA二级结构是生物信息学中的一个经典难题，通常使用动态规划算法来解决。这项综合性练习[@problem_id:2848657]不仅要求你实现这一核心算法，还将指导你如何整合真实的实验数据（SHAPE反应性）来提高预测的准确性。这个项目将理论、计算与实验生物学融为一体，是理解现代RNA结构生物学研究方法的绝佳实践。", "problem": "您需要实现一个程序，该程序将选择性2'-羟基酰化引物延伸分析 (SHAPE) 的反应性数据整合到一个简化的RNA二级结构预测热力学模型中，并在无假结约束下计算最小自由能 (MFE) 结构。您的实现必须仅依赖于以下核心定义和广泛接受的规则：\n\n- 分子生物学的中心法则和核糖核酸 (RNA) 结构原理表明，单链RNA通过分子内碱基配对折叠成二级结构，这些结构受到互补相互作用和空间可行性的约束。\n- 典型的沃森-克里克碱基对遵循 $\\mathrm{A}\\text{-}\\mathrm{U}$ 和 $\\mathrm{G}\\text{-}\\mathrm{C}$ 互补原则；允许 $\\mathrm{G}\\text{-}\\mathrm{U}$ 摆动碱基对。这些碱基对得到了完善的热力学观测支持。\n- SHAPE反应性与核苷酸的柔性在经验上相关。一种常见的方法是将反应性整合到一个伪自由能项中，该项对在高反应性位置的配对进行惩罚。对于位置 $i$ 上的每个核苷酸，定义其配对时的伪自由能为\n$$\n\\Delta G_{\\mathrm{SHAPE}}(i) = m \\cdot r_i + b,\n$$\n其中 $r_i$ 是SHAPE反应性，$m$ 是斜率，$b$ 是截距。能量单位为 $\\mathrm{kcal/mol}$。\n\n您必须使用以下简化的、明确的热力学模型：\n\n- 允许的碱基对及其碱基对能量 $E_{\\mathrm{bp}}$ (单位：$\\mathrm{kcal/mol}$)：\n  - $\\mathrm{A}\\text{-}\\mathrm{U}$ 和 $\\mathrm{U}\\text{-}\\mathrm{A}$：-2.0，\n  - $\\mathrm{G}\\text{-}\\mathrm{C}$ 和 $\\mathrm{C}\\text{-}\\mathrm{G}$：-3.0，\n  - $\\mathrm{G}\\text{-}\\mathrm{U}$ 和 $\\mathrm{U}\\text{-}\\mathrm{G}$：-1.0。\n- 发夹环长度约束：一对碱基 $(i,j)$ 仅当 $j - i - 1 \\ge L$ (其中 $L = 3$) 时才能形成。\n- 不允许出现假结。\n- 能量可加性：一个有效的二级结构的总自由能是所有形成的碱基对能量之和\n$$\nE_{\\text{pair}}(i,j) = E_{\\mathrm{bp}}(\\text{pair}(i,j)) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j),\n$$\n未配对的核苷酸贡献的能量为 $0$。能量以 $\\mathrm{kcal/mol}$ 表示。\n- 目标：在上述约束下最小化总自由能。\n\n需要实现的动态规划规范：\n\n- 设序列长度为 $n$。对于包含端点的索引子序列，定义 $E[i,j]$ ($0 \\le i \\le j \\le n-1$) 为区间 $[i,j]$ 上可实现的最小能量。\n- 边界条件：当 $i \\ge j$ 时，$E[i,j] = 0$。\n- $i  j$ 时的递推关系：\n  - 未配对选项：\n    - 使 $i$ 不配对：$E[i,j] \\leftarrow \\min\\left(E[i,j], E[i+1,j]\\right)$，\n    - 使 $j$ 不配对：$E[i,j] \\leftarrow \\min\\left(E[i,j], E[i,j-1]\\right)$。\n  - 配对选项（如果允许）：如果位置 $(i,j)$ 上的核苷酸可以形成允许的碱基对且 $j - i - 1 \\ge L$，则\n    $$\n    E[i,j] \\leftarrow \\min\\left(E[i,j], E[i+1,j-1] + E_{\\mathrm{bp}}(i,j) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j)\\right).\n    $$\n  - 遍历 $k$ 进行分叉（连接），其中 $i \\le k  j$：\n    $$\n    E[i,j] \\leftarrow \\min\\left(E[i,j], E[i,k] + E[k+1,j]\\right).\n    $$\n\n回溯过程必须重建一个与最小能量一致的最优结构。结构表示为一个长度为 $n$ 的列表，其中索引 $p$ 处的元素是与位置 $p+1$ 配对的核苷酸的1-based索引。如果位置 $p+1$ 未配对，则在索引 $p$ 处存储 $0$。例如，对于 $n=4$ 且配对为 $(1,4)$、未配对为 $(2,3)$ 的结构，表示为 $[4,0,0,1]$。\n\n角度单位不适用。能量必须按规定以 $\\mathrm{kcal/mol}$ 为单位进行解释。然而，输出是整数形式的配对伙伴索引表示，因此无单位。\n\n在程序内部实现的测试套件（无用户输入）。对于每种情况，使用给定的RNA序列、SHAPE反应性 $r_i$ 和参数 $(m,b)$：\n\n- 情况1（通用正常路径）：\n  - 序列：\"GCGAAUUGCGCU\"。\n  - 反应性：$[0.10, 0.20, 0.15, 1.20, 1.00, 0.90, 0.85, 1.10, 0.25, 0.15, 0.20, 0.10]$。\n  - 参数：$m = 1.8$，$b = -0.6$。\n- 情况2（边界情况：所有反应性均为零，负截距强烈有利于配对）：\n  - 序列：\"AUGCUAGC\"。\n  - 反应性：$[0,0,0,0,0,0,0,0]$。\n  - 参数：$m = 1.8$，$b = -0.6$。\n- 情况3（边缘情况：由于A的均聚物，没有允许的配对）：\n  - 序列：\"AAAAAA\"。\n  - 反应性：$[0.5, 0.7, 0.9, 0.1, 0.2, 0.3]$。\n  - 参数：$m = 1.0$，$b = 0.0$。\n- 情况4（边缘情况：序列太短，无法满足 $L=3$ 的发夹环约束）：\n  - 序列：\"GCUG\"。\n  - 反应性：$[0.9, 0.2, 1.1, 0.3]$。\n  - 参数：$m = 1.8$，$b = -0.6$。\n\n最终输出格式：\n\n- 对于每个测试用例，计算MFE配对伙伴索引整数列表（长度为 $n$），其中伙伴使用1-based索引，未配对位置使用 $0$。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个结果本身也是一个由方括号括起来的整数列表。例如： \"[[4,0,0,1],[...],[...],[...]]\"。", "solution": "问题陈述经评估有效。它描述了一个简化的、但有科学依据的生物信息学计算问题：预测RNA二级结构，以最小化一个伪自由能函数。该模型整合了经验性的SHAPE数据（一种标准技术），并依赖于一个明确定义的动态规划方法，在无假结约束下寻找最小自由能（MFE）结构。该问题定义明确、目标清晰，并包含了计算唯一解所需的所有必要信息。\n\n解决方案的核心是基于 Nussinov-Jacobson 或 Zuker 算法原理的动态规划算法。设RNA序列的长度为 $n$。我们定义 $E[i,j]$ 为从索引 $i$ 到 $j$（包括两端）的子序列的最小自由能，其中 $0 \\le i \\le j  n$。目标是计算 $E[0, n-1]$。\n\n提供的递推关系是：\n$$\nE[i,j] = \\min \\begin{cases}\nE[i+1, j] \\\\\nE[i, j-1] \\\\\nE[i+1, j-1] + E_{\\text{pair}}(i,j) \\\\\n\\min_{i \\le k  j} (E[i,k] + E[k+1,j])\n\\end{cases}\n$$\n一项关键分析表明，代表两端未配对核苷酸的前两项是冗余的。分叉项 $\\min_{i \\le k  j} (E[i,k] + E[k+1,j])$ 内在地包含了这些情况。具体来说，当 $k=i$ 时，该项变为 $E[i,i] + E[i+1,j]$。由于 $E[i,i]=0$（根据定义，子序列长度为1的能量为0，更准确地说，长度小于1的区间能量为0），这简化为 $E[i+1,j]$，即核苷酸 $i$ 未配对的情况。同样，当 $k=j-1$ 时，该项变为 $E[i,j-1] + E[j,j] = E[i,j-1]$，覆盖了 $j$ 未配对的情况。\n\n因此，为了实现更高效和简洁的实现，递推关系被合并为区间 $[i,j]$ 上结构的两种基本情况：\n1.  核苷酸 $i$ 和 $j$ 形成一个碱基对。这仅在它们互補（$\\mathrm{A}\\text{-}\\mathrm{U}$、$\\mathrm{G}\\text{-}\\mathrm{C}$ 或 $\\mathrm{G}\\text{-}\\mathrm{U}$）并滿足最小环长度约束 $j - i - 1 \\ge L$（其中 $L=3$）时才可能。其能量是内在碱基对能量、两个核苷酸的SHAPE衍生伪能量以及所包含子序列 $[i+1,j-1]$ 的MFE之和。\n    $$ E_{1} = E[i+1, j-1] + E_{\\mathrm{bp}}(i,j) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j) $$\n2.  区间 $[i,j]$ 上的结构是区间 $[i,k]$ 和 $[k+1,j]$ 上两个独立子结构的连接，其中 $k$ 是某个分裂点，$i \\le k  j$。总能量是这两个子结构能量的总和。算法必须找到使这个总和最小化的分裂点 $k$。\n    $$ E_{2} = \\min_{i \\le k  j} (E[i,k] + E[k+1,j]) $$\n\n最终能量 $E[i,j]$是这些可能性的最小值：$E[i,j] = \\min(E_1, E_2)$，其中 $E_1$ 仅在允许配对时考虑。\n\n算法按以下步骤进行：\n首先，对于序列中的每个核苷酸 $p$，预先计算其SHAPE伪自由能贡献 $\\Delta G_{\\mathrm{SHAPE}}(p) = m \\cdot r_p + b$。\n\n初始化一个大小为 $n \\times n$ 的二维矩阵 $E$。基本情况是对于所有 $i \\ge j$，$E[i,j] = 0$。该矩阵按子序列长度 $d=j-i$ 从 $d=1$ 到 $d=n-1$ 递增填充。这确保了在计算 $E[i,j]$ 时，其所依赖的所有更小子序列的能量都已计算完毕。\n\n为了重建最优结构，使用另一个相同维度的矩阵 `trace`。`trace`$[i,j]$ 存储了导致 $E[i,j]$ 达到最小值的选择。一个特殊值（例如-1）表示最小值是通过 $(i,j)$ 配对实现的。否则，`trace`$[i,j]$ 存储分叉情况下的最优分裂点 $k$。\n\n在 $E$ 和 `trace` 矩阵完全填充后，从 `backtrack(0, n-1)` 开始启动一个递归回溯函数。该函数遍历 `trace` 矩阵以重建构成MFE结构之一的碱基对集合。如果 `trace`$[i,j]$ 指示一个配对，则记录配对 $(i,j)$，并在闭合区间 `backtrack(i+1, j-1)` 上递归调用该函数。如果它指示在 $k$ 处分叉，则在两个独立的子区间 `backtrack(i, k)` 和 `backtrack(k+1, j)` 上递归调用。\n\n最终结果存储在一个长度为 $n$ 的数组中，其中每个位置保存其配对伙伴的1-based索引，如果未配对则为 $0$。此过程系统地应用于提供的每个测试用例。", "answer": "[[11,10,9,0,0,0,0,0,3,2,1,0],[0,0,8,0,0,0,0,3],[0,0,0,0,0,0],[0,0,0,0]]", "id": "2848657"}]}