{"hands_on_practices": [{"introduction": "第一个练习 [@problem_id:2841795] 将我们带回到孟德尔遗传的核心原则。通过分析一个经典的常染色体隐性遗传病场景，您将运用统计独立性的定义来验证一次生育的结果不会影响下一次。这项基础实践最终将引导您使用卡方拟合优度检验，将观察到的家系数据与孟德尔预期进行比较，这是遗传分析中的一项基本技能。", "problem": "某个群体中正在分离一种具有完全外显率的常染色体隐性遗传病。通过独立的分子基因分型，已知双亲均为杂合子携带者，因此他们的基因型为 $Aa \\times Aa$。假设遵循孟德尔分离定律，无分离畸变，配子随机结合，无改变外显率的上位效应，并且不同后代的减数分裂和受精过程在各次妊娠之间是相互独立的。考虑这对父母先后生育的同胞。\n\n仅从条件概率和独立性的基本定义以及孟德尔分离定律出发，推导在已知前两个孩子未患病的情况下，第三个孩子患病的条件概率。运用这些原理，解释在所述模型下，为何该概率不受先前子女结局的影响。\n\n一项队列研究确定了 $N = 320$ 个此类家庭，其中前两个孩子均被确认为未患病。在这些家庭中，观察到第三个孩子患病的有 $O_{A} = 68$ 例，未患病的有 $O_{U} = 252$ 例。使用您推导出的概率作为该条件队列中第三个孩子患病状态的孟德尔期望，计算比较 $N$ 个家庭中第三个孩子两个类别（患病与未患病）的观测计数与期望计数的皮尔逊卡方拟合优度统计量。将您报告的卡方统计量四舍五入至四位有效数字。最终答案必须是一个实数。", "solution": "该问题提出了一个传递遗传学中的标准情景，并要求进行两部分分析：首先，基于基本原理推导条件概率；其次，使用经验数据进行拟合优度检验。我将遵循严格的逻辑和数学形式，依次处理每个部分。\n\n首先，我们建立概率框架。双亲均为杂合子携带者，因此亲本杂交组合为 $Aa \\times Aa$。根据孟德尔分离定律，每个亲本以相等的概率 $p = \\frac{1}{2}$ 产生两种类型的配子，$A$ 和 $a$。假设配子随机结合，后代基因型的概率由二项式 $(\\frac{1}{2}A + \\frac{1}{2}a)^2$ 的展开式给出：\n$$P(AA) = \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$$\n$$P(Aa) = \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{2}$$\n$$P(aa) = \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$$\n该遗传病是常染色体隐性遗传，具有完全外显率，这意味着当且仅当个体基因型为 $aa$ 时才会患病。设 $C_i$ 为第 $i$ 个孩子患病的事件， $U_i$ 为第 $i$ 个孩子未患病的事件。对于任何一个孩子，其概率为：\n$$P(C_i) = P(aa) = \\frac{1}{4}$$\n$$P(U_i) = P(AA) + P(Aa) = \\frac{1}{4} + \\frac{1}{2} = \\frac{3}{4}$$\n注意，$P(C_i) + P(U_i) = 1$，这是必然的。\n\n问题要求计算在前两个孩子未患病的条件下，第三个孩子患病的条件概率。这表示为 $P(C_3 | U_1 \\cap U_2)$。根据条件概率的基本定义，我们有：\n$$P(C_3 | U_1 \\cap U_2) = \\frac{P(C_3 \\cap U_1 \\cap U_2)}{P(U_1 \\cap U_2)}$$\n问题的一个关键前提是“不同后代的减数分裂和受精过程在各次妊娠之间是相互独立的”。这意味着每个孩子的健康状况是一个统计上的独立事件。对于一组独立事件，它们联合发生的概率是它们各自概率的乘积。因此：\n$$P(C_3 \\cap U_1 \\cap U_2) = P(C_3) \\times P(U_1) \\times P(U_2)$$\n对于条件事件：\n$$P(U_1 \\cap U_2) = P(U_1) \\times P(U_2)$$\n将这些代入条件概率公式，得到：\n$$P(C_3 | U_1 \\cap U_2) = \\frac{P(C_3) \\times P(U_1) \\times P(U_2)}{P(U_1) \\times P(U_2)}$$\n由于 $P(U_1) = \\frac{3}{4} > 0$ 且 $P(U_2) = \\frac{3}{4} > 0$，分母中的项不为零，我们可以消去它们，从而得到：\n$$P(C_3 | U_1 \\cap U_2) = P(C_3) = \\frac{1}{4}$$\n这个条件概率与边际概率相同的原因是历次生育独立性的直接且必然的结果。两个事件 $A$ 和 $B$ 之间独立性的数学定义是 $P(A \\cap B) = P(A)P(B)$，这意味着 $P(A|B) = P(A)$。在这种遗传学背景下，每次妊娠的生物过程都是一个随机事件，其结果概率（$P(C_i) = \\frac{1}{4}$）仅由父母固定的基因型决定，而不受先前妊娠结果的影响。因此，知道前两个孩子未患病并不能提供任何新信息来更新第三个孩子的概率。每次生育都是一次独立的试验。\n\n接下来，我们进行拟合优度检验。原假设（$H_0$）是，在指定的家庭中，第三个孩子患病的概率遵循孟德尔模型，即 $p_{A} = \\frac{1}{4}$。因此，未患病的概率是 $p_{U} = 1 - \\frac{1}{4} = \\frac{3}{4}$。\n该研究包含一个由 $N = 320$ 个满足条件（前两个孩子未患病）的家庭组成的队列。对于第三个孩子的两种可能结局，其期望计数为：\n期望患病数：$E_{A} = N \\times p_{A} = 320 \\times \\frac{1}{4} = 80$\n期望未患病数：$E_{U} = N \\times p_{U} = 320 \\times \\frac{3}{4} = 240$\n观测计数如下：\n观测患病数：$O_{A} = 68$\n观测未患病数：$O_{U} = 252$\n皮尔逊卡方统计量（$\\chi^2$）使用以下公式计算：\n$$\\chi^2 = \\sum_{i} \\frac{(O_i - E_i)^2}{E_i}$$\n对于这两个类别，公式变为：\n$$\\chi^2 = \\frac{(O_{A} - E_{A})^2}{E_{A}} + \\frac{(O_{U} - E_{U})^2}{E_{U}}$$\n代入数值：\n$$\\chi^2 = \\frac{(68 - 80)^2}{80} + \\frac{(252 - 240)^2}{240}$$\n$$\\chi^2 = \\frac{(-12)^2}{80} + \\frac{(12)^2}{240}$$\n$$\\chi^2 = \\frac{144}{80} + \\frac{144}{240}$$\n进行算术计算：\n$$\\chi^2 = 1.8 + 0.6 = 2.4$$\n问题要求将结果四舍五入至四位有效数字。精确值为 $2.4$。为了用四位有效数字表示，我们写作 $2.400$。", "answer": "$$\\boxed{2.400}$$", "id": "2841795"}, {"introduction": "在基础之上，这个问题 [@problem_id:2841841] 引入了不完全外显这一复杂情况，即特定基因型并非总能导致预期的表型。您将从群体数据中推导外显率参数的最大似然估计，这是数量遗传学中的一项常见任务。此外，本练习要求您运用贝叶斯定理，在表型正常的条件下推断携带者的概率，从而强调了基因型与表型之间的关键区别。", "problem": "一种罕见的单基因遗传病以常染色体隐性方式遗传，具有不完全外显性，且仅限于隐性纯合基因型。令 $p$ 表示隐性纯合基因型的外显率，即 $p = \\mathbb{P}(\\text{患病表型} \\mid aa)$。基因型为 $AA$ 或 $Aa$ 的个体从不表现出患病表型，即 $\\mathbb{P}(\\text{患病表型} \\mid AA) = 0$ 且 $\\mathbb{P}(\\text{患病表型} \\mid Aa) = 0$。不存在新生突变、基因分型错误或表型模拟。\n\n收集了一个由 $n = 800$ 名后代组成的队列，这些后代来自已确认的 $Aa \\times Aa$ 交配，并记录了他们的表型：$k = 120$ 名患病，$n - k = 680$ 名未患病。假设在给定亲本基因型的情况下，后代的结局是相互独立的。\n\n任务：\n1. 仅使用孟德尔分离定律、外显率和独立试验的二项分布模型的基本定义，根据观测计数 $\\{k, n-k\\}$ 推导出外显率 $p$ 的最大似然估计量 $\\hat{p}$。\n2. 使用全概率定律和贝叶斯定理，推导 $\\mathbb{P}(Aa \\mid U)$，其中 $U$ 表示“后代表型未患病”事件，适用于 $Aa \\times Aa$ 亲本的后代，结果用 $p$ 表示。然后在任务1得到的 $p = \\hat{p}$ 处计算该概率的值。\n3. 为了评估一个特定的历史假设 $H_{0}: p = 0.5$ 的充分性，计算 Pearson 卡方统计量，将观测计数 $\\{k, n-k\\}$ 与在 $H_{0}$ 假设下 $Aa \\times Aa$ 交配的期望计数进行比较。根据卡方参考分布，在显著性水平 $\\alpha = 0.05$ 下，判断是否应拒绝 $H_{0}$。你可以假设此处使用自由度为 $1$ 的大样本卡方近似是合适的。\n\n仅报告在 $\\hat{p}$ 处计算的条件概率 $\\mathbb{P}(Aa \\mid U)$ 的值作为你的最终数值答案，四舍五入到四位有效数字。不要以百分比形式报告，请以小数形式表示。", "solution": "所提出的问题陈述是有效的。它在科学上基于孟德尔遗传学、外显率和统计推断的原理。问题提法恰当，提供了所有必要的数据（$n=800$, $k=120$, 亲本基因型为 $Aa \\times Aa$）和定义（$p = \\mathbb{P}(\\text{患病} \\mid aa)$ 等），以便为三个指定任务推导出唯一且有意义的解。该问题是客观的，没有歧义，是遗传分析中的一个标准练习。我们将开始解题。\n\n该问题要求进行一系列与具有不完全外显率 $p$ 的常染色体隐性遗传病相关的推导和计算。我们已知来自已确认的 $Aa \\times Aa$ 交配的数据，队列中有 $n=800$ 名后代，其中 $k=120$ 名患病，$n-k=680$ 名未患病。\n\n首先，我们确定后代患病的概率，我们用事件 $A$ 表示。根据 $Aa \\times Aa$ 交配的孟德尔定律，后代基因型出现的概率如下：$\\mathbb{P}(AA) = \\frac{1}{4}$，$\\mathbb{P}(Aa) = \\frac{1}{2}$，以及 $\\mathbb{P}(aa) = \\frac{1}{4}$。\n\n患病表型的概率可以使用全概率定律，以基因型为条件来计算：\n$$\n\\mathbb{P}(A) = \\mathbb{P}(A \\mid AA)\\mathbb{P}(AA) + \\mathbb{P}(A \\mid Aa)\\mathbb{P}(Aa) + \\mathbb{P}(A \\mid aa)\\mathbb{P}(aa)\n$$\n根据问题陈述，我们有 $\\mathbb{P}(A \\mid AA) = 0$，$\\mathbb{P}(A \\mid Aa) = 0$，以及 $\\mathbb{P}(A \\mid aa) = p$。代入这些值和基因型概率，可得：\n$$\n\\mathbb{P}(A) = (0)\\left(\\frac{1}{4}\\right) + (0)\\left(\\frac{1}{2}\\right) + (p)\\left(\\frac{1}{4}\\right) = \\frac{p}{4}\n$$\n这是单个后代患病的概率。\n\n任务 1：推导外显率 $p$ 的最大似然估计量 (MLE) $\\hat{p}$。\n在此种交配产生的 $n$ 个样本中，患病后代的数量 $k$ 可以用二项分布来建模，因为每个后代都是一次独立的试验，“成功”的概率为 $\\mathbb{P}(A) = \\frac{p}{4}$。因此，随机变量 $K$ 服从 $K \\sim \\text{Binomial}(n, \\frac{p}{4})$。\n\n似然函数 $L(p; k, n)$ 是在总共 $n$ 个个体中观察到 $k$ 个患病个体的概率：\n$$\nL(p; k, n) = \\binom{n}{k} \\left(\\frac{p}{4}\\right)^k \\left(1 - \\frac{p}{4}\\right)^{n-k}\n$$\n为了找到使该函数最大化的 $p$ 值，更方便的做法是最大化对数似然函数 $l(p) = \\ln(L(p))$：\n$$\nl(p) = \\ln\\binom{n}{k} + k \\ln\\left(\\frac{p}{4}\\right) + (n-k) \\ln\\left(1 - \\frac{p}{4}\\right)\n$$\n我们通过对 $l(p)$ 关于 $p$ 求导并令其等于零来找到最大值：\n$$\n\\frac{dl}{dp} = \\frac{d}{dp} \\left[ \\ln\\binom{n}{k} + k(\\ln p - \\ln 4) + (n-k)\\ln(4-p) - (n-k)\\ln 4 \\right]\n$$\n$$\n\\frac{dl}{dp} = \\frac{k}{p} + (n-k)\\left(\\frac{-1}{4-p}\\right) = 0\n$$\n求解 $p$：\n$$\n\\frac{k}{p} = \\frac{n-k}{4-p} \\implies k(4-p) = p(n-k) \\implies 4k - kp = np - kp \\implies 4k = np\n$$\n这就给出了最大似然估计量 $\\hat{p}$：\n$$\n\\hat{p} = \\frac{4k}{n}\n$$\n使用观测数据 $k=120$ 和 $n=800$：\n$$\n\\hat{p} = \\frac{4 \\times 120}{800} = \\frac{480}{800} = \\frac{6}{10} = 0.6\n$$\n\n任务 2：推导 $\\mathbb{P}(Aa \\mid U)$ 并计算其值。\n令 $U$ 为后代表型未患病的事件。这是事件 $A$ 的补集。未患病的概率是：\n$$\n\\mathbb{P}(U) = 1 - \\mathbb{P}(A) = 1 - \\frac{p}{4}\n$$\n我们需要使用贝叶斯定理来求条件概率 $\\mathbb{P}(Aa \\mid U)$：\n$$\n\\mathbb{P}(Aa \\mid U) = \\frac{\\mathbb{P}(U \\mid Aa)\\mathbb{P}(Aa)}{\\mathbb{P}(U)}\n$$\n我们确定分子中的每一项。对于 $Aa \\times Aa$ 交配，$\\mathbb{P}(Aa) = \\frac{1}{2}$。在基因型为 $Aa$ 的条件下未患病的概率是 $\\mathbb{P}(U \\mid Aa) = 1 - \\mathbb{P}(A \\mid Aa) = 1 - 0 = 1$。\n将这些代入贝叶斯定理：\n$$\n\\mathbb{P}(Aa \\mid U) = \\frac{(1)\\left(\\frac{1}{2}\\right)}{1 - \\frac{p}{4}} = \\frac{\\frac{1}{2}}{\\frac{4-p}{4}} = \\frac{1}{2} \\cdot \\frac{4}{4-p} = \\frac{2}{4-p}\n$$\n问题要求在 $p = \\hat{p} = 0.6$ 处计算该概率的值：\n$$\n\\mathbb{P}(Aa \\mid U) \\big|_{p=\\hat{p}} = \\frac{2}{4 - 0.6} = \\frac{2}{3.4} = \\frac{20}{34} = \\frac{10}{17}\n$$\n作为小数并四舍五入到四位有效数字，该值约为 $0.588235... \\approx 0.5882$。\n\n任务 3：对假设 $H_{0}: p = 0.5$ 进行卡方检验。\n在原假设 $H_{0}: p=0.5$ 下，后代患病的期望概率为 $\\mathbb{P}(A) = \\frac{p}{4} = \\frac{0.5}{4} = \\frac{1}{8}$。后代未患病的期望概率为 $\\mathbb{P}(U) = 1 - \\frac{1}{8} = \\frac{7}{8}$。\n对于总样本量 $n=800$，期望计数为：\n期望患病数：$E_{A} = n \\times \\mathbb{P}(A) = 800 \\times \\frac{1}{8} = 100$。\n期望未患病数：$E_{U} = n \\times \\mathbb{P}(U) = 800 \\times \\frac{7}{8} = 700$。\n观测计数为 $O_{A} = k = 120$ 和 $O_{U} = n-k = 680$。\n\nPearson 卡方统计量计算如下：\n$$\n\\chi^2 = \\sum \\frac{(\\text{观测值} - \\text{期望值})^2}{\\text{期望值}} = \\frac{(O_{A} - E_{A})^2}{E_{A}} + \\frac{(O_{U} - E_{U})^2}{E_{U}}\n$$\n$$\n\\chi^2 = \\frac{(120 - 100)^2}{100} + \\frac{(680 - 700)^2}{700} = \\frac{20^2}{100} + \\frac{(-20)^2}{700} = \\frac{400}{100} + \\frac{400}{700}\n$$\n$$\n\\chi^2 = 4 + \\frac{4}{7} = \\frac{28+4}{7} = \\frac{32}{7} \\approx 4.571\n$$\n该检验的自由度为 $df = (\\text{类别数}) - 1 = 2-1 = 1$。在显著性水平 $\\alpha = 0.05$ 下，自由度为 $1$ 的卡方分布的临界值为 $\\chi^2_{\\text{crit}, 0.05} = 3.841$。\n由于我们计算出的检验统计量 $\\chi^2 \\approx 4.571$ 大于临界值 $3.841$，我们拒绝原假设 $H_{0}: p = 0.5$。在 $p=0.5$ 的假设下，观测计数与期望计数的偏差在统计上是显著的。\n\n要求的最终答案是在 $\\hat{p}$ 处计算的 $\\mathbb{P}(Aa \\mid U)$ 的值，四舍五入到四位有效数字，该值已在任务2中计算得出。\n$$\n\\mathbb{P}(Aa \\mid U) = \\frac{10}{17} \\approx 0.5882\n$$", "answer": "$$\n\\boxed{0.5882}\n$$", "id": "2841841"}, {"introduction": "我们的最后一个练习 [@problem_id:2841815] 将重点转向群体遗传学，特别是连锁不平衡 (LD) 的评估以及稀疏数据带来的实际挑战。这个问题促使我们对标准卡方检验进行批判性评估，因为稀有等位基因的存在常常使其假设失效。通过分析各种修正策略的有效性，您将学会识别渐近近似在何时会失效，并学习如何运用精确检验或数据合并等稳健方法，以确保分析结果的科学严谨性。", "problem": "一个包含 $N = 1000$ 个定相单倍型（等同于 $500$ 个二倍体个体）的群体样本在两个基因座上进行了基因分型，以评估连锁不平衡（Linkage Disequilibrium, LD）。连锁不平衡定义为等位基因在不同基因座间的概率独立性的偏离。基因座 $A$ 是双等位基因的，等位基因为 $A/a$；基因座 $B$ 是三等位基因的，等位基因为 $B_1/B_2/b_3$。观测到的单倍型计数如下：\n- $(A,B_1): 930$\n- $(A,B_2): 8$\n- $(A,b_3): 2$\n- $(a,B_1): 59$\n- $(a,B_2): 1$\n- $(a,b_3): 0$\n\n在独立性的零假设下，单倍型概率可以分解为 $P(A_i \\cap B_j) = P(A_i)\\,P(B_j)$，每个单元格的期望计数等于相应边际总和的乘积除以 $N$。一种常见的方法是独立性卡方检验，其大样本有效性依赖于对多项式单元格计数的中心极限定理近似。\n\n使用上述数据，考虑稀有等位基因的存在如何影响卡方连锁不平衡检验的稳定性和有效性，并确定能保持有效的第一类错误控制的策略。\n\n在存在此类稀疏数据的情况下，以下哪些策略适合用于保持有效性？选择所有适用的选项。\n\nA. 直接对 $2 \\times 3$ 列联表应用带连续性校正的标准皮尔逊卡方检验；由于 $N$ 很大，即使有几个期望计数接近 $0$ 或小于 $1$，渐近性仍然有效。\n\nB. 将 $B_2$ 和 $b_3$ 合并为一个“稀有-$B$”类别以形成一个 $2 \\times 2$ 列联表，然后仅在合并后所有期望计数都满足常规阈值（例如，至少 $80\\%$ 的单元格不小于 $5$，且没有单元格小于 $1$）时才使用皮尔逊卡方检验；否则，切换到精确检验。\n\nC. 为 $2 \\times 3$ 列联表拟合一个多项式模型，其中单元格概率使用浓度参数为 $\\alpha > 0$ 的对称狄利克雷先验来获得稳定的期望计数（等同于为每个单元格添加 $\\alpha$ 个伪计数），构建一个检验统计量（例如，皮尔逊或似然比统计量），并通过以观测边际为条件的置换检验来获得其 $p$ 值。\n\nD. 为每个观测单元格加上 $0.5$（Haldane–Anscombe 校正）以消除零值，然后根据具有原始自由度的常规卡方零分布来解释得到的皮尔逊卡方值；即使存在许多零或非常小的期望单元格，这也能恢复名义上的第一类错误率。\n\nE. 丢弃所有携带 $B_2$ 或 $b_3$ 的单倍型以避免稀疏单元格，并仅使用 $(A,a) \\times B_1$ 子集通过标准卡方检验来检验连锁不平衡。\n\nF. 对原始的 $2 \\times 3$ 列联表使用费希尔精确检验（或蒙特卡洛精确程序）以获得不依赖大样本近似的有效 $p$ 值。\n\n您的分析必须遵循第一性原理：从独立性的定义出发，从观测到的边际推导出期望计数，并论证卡方近似在何种条件下有效。然后，选择所有正确的选项。", "solution": "问题要求我们确定在具有稀疏数据的 $2 \\times 3$ 列联表中检验连锁不平衡（LD）的适当统计策略。零假设 $H_0$ 是不存在连锁不平衡（基因座之间独立），这意味着单倍型的概率是边际等位基因频率的乘积。\n\n首先，确定问题陈述的有效性。该问题在群体遗传学方面有科学依据，问题提出得很好，数据完整且一致，并且陈述客观。它提出了生物统计学中一个常见且不容忽视的挑战：在存在稀有事件时，统计检验的渐近近似会失效。因此，该问题适合进行分析。\n\n让我们首先构建观测到的单倍型计数 $O_{ij}$ 的列联表，并计算边际总和。\n基因座 A 的等位基因为 $\\{A, a\\}$，基因座 B 的等位基因为 $\\{B_1, B_2, b_3\\}$。单倍型总数为 $N = 1000$。\n\n观测计数表如下：\n$$\n\\begin{array}{c|ccc|c}\n & B_1 & B_2 & b_3 & \\text{行总计} \\\\\n\\hline\nA & 930 & 8 & 2 & n_{A.} = 940 \\\\\na & 59 & 1 & 0 & n_{a.} = 60 \\\\\n\\hline\n\\text{列总计} & n_{.B_1} = 989 & n_{.B_2} = 9 & n_{.b_3} = 2 & N = 1000\n\\end{array}\n$$\n\n在独立性的零假设下，每个单元格的期望计数 $E_{ij}$ 计算为 $E_{ij} = \\frac{(n_{i.})(n_{.j})}{N}$。\n$$\nE(A, B_1) = \\frac{940 \\times 989}{1000} = 929.66 \\\\\nE(A, B_2) = \\frac{940 \\times 9}{1000} = 8.46 \\\\\nE(A, b_3) = \\frac{940 \\times 2}{1000} = 1.88 \\\\\nE(a, B_1) = \\frac{60 \\times 989}{1000} = 59.34 \\\\\nE(a, B_2) = \\frac{60 \\times 9}{1000} = 0.54 \\\\\nE(a, b_3) = \\frac{60 \\times 2}{1000} = 0.12\n$$\n皮尔逊卡方检验统计量 $\\chi^2 = \\sum_{i,j} \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}$ 与自由度为 $(r-1)(c-1) = (2-1)(3-1) = 2$ 的 $\\chi^2$ 分布进行比较。这个过程依赖于渐近近似，而该近似仅在期望单元格计数足够大时才有效。一个常见的准则（Cochran 准则）要求至少 $80\\%$ 的单元格的期望计数大于或等于 $5$，并且所有单元格的期望计数都必须大于或等于 $1$。\n\n在我们的 $2 \\times 3$ 列联表中，有六个单元格。期望计数为 $\\{929.66, 8.46, 1.88, 59.34, 0.54, 0.12\\}$。其中三个单元格（$50\\%$）的期望计数小于 $5$，其中两个（$E(a, B_2)$ 和 $E(a, b_3)$）小于 $1$。由于稀有等位基因 $a$、$B_2$ 和 $b_3$ 导致的数据稀疏性，标准卡方检验的有效性条件被严重违反。\n\n现在，我们评估每个提出的策略：\n\nA. 直接对 $2 \\times 3$ 列联表应用带连续性校正的标准皮尔逊卡方检验；由于 $N$ 很大，即使有几个期望计数接近 $0$ 或小于 $1$，渐近性仍然有效。\n这个说法有根本性错误。卡方近似的有效性取决于单元格中的期望计数，而不仅仅是总样本量 $N$。如果边际概率极端，导致期望计数很小，那么大的 $N$ 也无法挽救这种近似。如计算所示，多个期望计数远低于常规阈值。连续性校正（如 Yates 校正）是为 $2 \\times 2$ 列联表定义的，不能充分解决渐近理论在更大、更稀疏的列联表中的失效问题。声称检验因 $N$ 很大而有效是一种严重的过度简化，是错误的。\n**结论：错误。**\n\nB. 将 $B_2$ 和 $b_3$ 合并为一个“稀有-$B$”类别以形成一个 $2 \\times 2$ 列联表，然后仅在合并后所有期望计数都满足常规阈值（例如，至少 $80\\%$ 的单元格不小于 $5$，且没有单元格小于 $1$）时才使用皮尔逊卡方检验；否则，切换到精确检验。\n这是一个统计上合理且务实的策略。合并类别是处理稀疏性的常用方法，前提是这种合并在生物学上有意义（例如，合并稀有等位基因）。让我们构建这个 $2 \\times 2$ 列联表：\n$$\n\\begin{array}{c|cc|c}\n & B_1 & B_{rare} (B_2+b_3) & \\text{行总计} \\\\\n\\hline\nA & 930 & 10 & 940 \\\\\na & 59 & 1 & 60 \\\\\n\\hline\n\\text{列总计} & 989 & 11 & 1000\n\\end{array}\n$$\n新的期望计数是：\n$E(A, B_1) = 929.66$, $E(A, B_{rare}) = \\frac{940 \\times 11}{1000} = 10.34$, $E(a, B_1) = 59.34$, $E(a, B_{rare}) = \\frac{60 \\times 11}{1000} = 0.66$。\n期望计数 $E(a, B_{rare}) = 0.66$ 仍然小于 $1$。因此，即使在合并之后，卡方检验的条件也未满足。该策略正确地指示在这种情况下“切换到精确检验”（例如，对 $2 \\times 2$ 列联表使用费希尔精确检验）。这种条件性方法确保了使用有效的检验，从而使整个策略适合于保持第一类错误控制。\n**结论：正确。**\n\nC. 为 $2 \\times 3$ 列联表拟合一个多项式模型，其中单元格概率使用浓度参数为 $\\alpha > 0$ 的对称狄利克雷先验来获得稳定的期望计数（等同于为每个单元格添加 $\\alpha$ 个伪计数），构建一个检验统计量（例如，皮尔逊或似然比统计量），并通过以观测边际为条件的置换检验来获得其 $p$ 值。\n这描述了一种先进但有效且强大的方法。添加从先验导出的伪计数是一种贝叶斯技术，用于正则化估计，使其远离零。该策略的关键部分是使用置换检验来获得 $p$ 值。置换检验通过在保持边际总和固定的情况下，重复地对数据标签（一个基因座相对于另一个基因座的等位基因）进行重排，从而经验性地生成检验统计量的零分布。这个过程不依赖于任何渐近分布假设（如 $\\chi^2$ 分布），并且无论数据多么稀疏，都能提供一个有效的独立性检验。这种复合策略在统计上是严谨的。\n**结论：正确。**\n\nD. 为每个观测单元格加上 $0.5$（Haldane–Anscombe 校正）以消除零值，然后根据具有原始自由度的常规卡方零分布来解释得到的皮尔逊卡方值；即使存在许多零或非常小的期望单元格，这也能恢复名义上的第一类错误率。\n这个策略是错误的。虽然向单元格中添加 $0.5$（或其他小常数）是在某些情况下用于稳定方差或估计对数优势比的技术，但它不是“修复”皮尔逊卡方检验的有效方法。将观测计数 $O_{ij}$ 修改为 $O'_{ij} = O_{ij} + 0.5$ 并应用标准检验 $\\sum (O'_{ij} - E'_{ij})^2 / E'_{ij}$，所得的统计量在零假设下并不遵循标准的 $\\chi^2$ 分布，尤其是在存在原始稀疏数据问题时。声称这种简单的调整“恢复了名义上的第一类错误率”是错误的；它没有纠正渐近近似的根本无效性。\n**结论：错误。**\n\nE. 丢弃所有携带 $B_2$ 或 $b_3$ 的单倍型以避免稀疏单元格，并仅使用 $(A,a) \\times B_1$ 子集通过标准卡方检验来检验连锁不平衡。\n这个策略在科学上是不恰当的，在方法上是无效的。它涉及选择性地丢弃数据，这会引入严重的偏倚。通过移除所有带有 $B_2$ 或 $b_3$ 的单倍型，分析被限制在一个亚群体中，其中基因座 B 是单态的（只存在等位基因 $B_1$）。对一个不变化的变量检验关联是不可能的。分析不再是关于基因座 A 和基因座 B 之间的连锁不平衡。这种方法改变了科学问题，并导致无意义的结果。这违反了合理的科学实践。\n**结论：错误。**\n\nF. 对原始的 $2 \\times 3$ 列联表使用费希尔精确检验（或蒙特卡洛精确程序）以获得不依赖大样本近似的有效 $p$ 值。\n这是解决此问题的经典且最直接的正确方法。费希尔精确检验专为列联表设计，特别是当期望单元格频率很小时。它在独立性零假设下，以边际总和为条件，计算观测到给定列联表或更极端情况的精确概率。给定边际后，单元格计数的潜在分布是多变量超几何分布。对于大于 $2 \\times 2$ 的列联表，直接计算可能非常耗时，因此通常使用蒙特卡洛模拟（随机生成具有相同边际的列联表）来估计精确的 $p$ 值。该方法提供了一个不依赖于渐近理论的有效 $p$ 值，是稀疏列联表的标准解决方案。\n**结论：正确。**\n\n总之，适当的策略是那些不依赖于皮尔逊卡方检验已被违反的渐近假设的策略。这些包括使用精确检验、采用置换检验，或者谨慎地合并类别并以降级使用精确检验作为备用方案。", "answer": "$$\\boxed{BCF}$$", "id": "2841815"}]}