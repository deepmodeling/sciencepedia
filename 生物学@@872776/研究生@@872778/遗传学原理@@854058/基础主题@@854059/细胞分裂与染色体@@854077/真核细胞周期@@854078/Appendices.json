{"hands_on_practices": [{"introduction": "细胞周期的进程由周期蛋白依赖性激酶（CDK）的活性精确调控。这个实践练习提供了一个定量的视角，通过一个竞争性结合模型来审视G1/S转换的关键调控节点。通过计算在激活剂（cyclin E）和抑制剂（p27）共存的情况下，CDK2的活性水平，你将能够运用化学平衡的基本原理来理解细胞信号通路中分子竞争如何决定细胞的命运 [@problem_id:2857502]。", "problem": "真核细胞周期的一个核心控制点是细胞周期蛋白依赖性激酶2（CDK2）的激活状态，CDK2与cyclin E结合时被激活，并被细胞周期蛋白依赖性激酶抑制剂p27（p27）抑制。考虑一个单一位点竞争性结合模型，在该模型中，cyclin E和p27与CDK2的结合是相互排斥的。假设相对于合成和降解过程，结合反应能快速达到平衡，遵循质量作用定律，并且只有CDK2:cyclin E复合物具有催化活性。设总浓度已知且固定：CDK2总浓度为 $C_{\\mathrm{T}}$，cyclin E总浓度为 $E_{\\mathrm{T}}$，p27总浓度为 $P_{\\mathrm{T}}$。设平衡解离常数分别为：CDK2–cyclin E的 $K_{d}^{\\mathrm{CE}}$ 和CDK2–p27的 $K_{d}^{\\mathrm{CP}}$。平衡解离常数的定义遵循标准形式 $K_{d} = [\\mathrm{free\\;receptor}][\\mathrm{free\\;ligand}]/[\\mathrm{complex}]$。\n\n在一个哺乳动物G1/S期的背景下，假设：\n- $C_{\\mathrm{T}} = 50\\,\\mathrm{nM}$，\n- $E_{\\mathrm{T}} = 80\\,\\mathrm{nM}$，\n- $P_{\\mathrm{T}} = 40\\,\\mathrm{nM}$，\n- $K_{d}^{\\mathrm{CE}} = 15\\,\\mathrm{nM}$，\n- $K_{d}^{\\mathrm{CP}} = 5\\,\\mathrm{nM}$，\n\n所有浓度和解离常数均以相同单位表示。\n\n根据上述假设，计算活性CDK2的平衡分数，其定义为 $f_{\\mathrm{active}} = [\\mathrm{CDK2:cyclin\\;E}]/C_{\\mathrm{T}}$。将您的答案四舍五入至四位有效数字。最终结果以纯数（无量纲）表示。", "solution": "所述问题经验证。\n\n第一步：提取已知条件。\n提供的信息如下：\n- CDK2的总浓度：$C_{\\mathrm{T}} = 50\\,\\mathrm{nM}$\n- cyclin E的总浓度：$E_{\\mathrm{T}} = 80\\,\\mathrm{nM}$\n- p27的总浓度：$P_{\\mathrm{T}} = 40\\,\\mathrm{nM}$\n- CDK2–cyclin E的平衡解离常数：$K_{d}^{\\mathrm{CE}} = 15\\,\\mathrm{nM}$\n- CDK2–p27的平衡解离常数：$K_{d}^{\\mathrm{CP}} = 5\\,\\mathrm{nM}$\n- 模型假设：单一位点竞争性结合，快速平衡，质量作用动力学。\n- 活性CDK2的定义：复合物 $[\\mathrm{CDK2:cyclin\\;E}]$。\n- 活性分数的定义：$f_{\\mathrm{active}} = [\\mathrm{CDK2:cyclin\\;E}]/C_{\\mathrm{T}}$。\n- 平衡解离常数的定义：$K_{d} = [\\mathrm{free\\;receptor}][\\mathrm{free\\;ligand}]/[\\mathrm{complex}]$。\n\n第二步：使用提取的已知条件进行验证。\n该问题具有科学依据，描述了生物化学中一个标准的竞争性结合模型。该问题提法恰当，有足够的信息和一致的定义，可以求得唯一解。语言客观且定量。给定值在细胞环境下是物理上合理的。该问题未违反任何指定的无效标准。\n\n第三步：结论与行动。\n该问题有效。将提供严谨的解答。\n\n该系统遵循质量守恒和化学平衡原理。我们定义平衡时各物种的浓度如下：\n- $C = [\\mathrm{CDK2}]$：游离CDK2的浓度。\n- $E = [\\mathrm{cyclin\\;E}]$：游离cyclin E的浓度。\n- $P = [\\mathrm{p27}]$：游离p27的浓度。\n- $CE = [\\mathrm{CDK2:cyclin\\;E}]$：CDK2–cyclin E复合物的浓度。\n- $CP = [\\mathrm{CDK2:p27}]$：CDK2–p27复合物的浓度。\n\n控制方程是各组分的质量守恒方程和结合平衡的质量作用定律。\n\n质量守恒方程为：\n1.  CDK2总浓度：$C_{\\mathrm{T}} = C + CE + CP$\n2.  cyclin E总浓度：$E_{\\mathrm{T}} = E + CE$\n3.  p27总浓度：$P_{\\mathrm{T}} = P + CP$\n\n平衡解离常数的定义为：\n4.  CDK2–cyclin E：$K_{d}^{\\mathrm{CE}} = \\frac{C \\cdot E}{CE}$\n5.  CDK2–p27：$K_{d}^{\\mathrm{CP}} = \\frac{C \\cdot P}{CP}$\n\n我们的目标是求出 $f_{\\mathrm{active}} = CE/C_{\\mathrm{T}}$。为此，我们必须首先确定 $CE$ 的值。最直接的方法是将这个包含五个方程和五个未知数的方程组简化为一个单变量方程。一个合适的变量选择是游离的共同反应物浓度 $C$。\n\n根据方程（2）和（4），我们将 $CE$ 用 $C$ 表示：\n$E = E_{\\mathrm{T}} - CE$。代入方程（4）：\n$K_{d}^{\\mathrm{CE}} = \\frac{C (E_{\\mathrm{T}} - CE)}{CE}$\n$K_{d}^{\\mathrm{CE}} \\cdot CE = C \\cdot E_{\\mathrm{T}} - C \\cdot CE$\n$CE (K_{d}^{\\mathrm{CE}} + C) = C \\cdot E_{\\mathrm{T}}$\n因此，$CE = \\frac{C \\cdot E_{\\mathrm{T}}}{K_{d}^{\\mathrm{CE}} + C}$。\n\n类似地，根据方程（3）和（5），我们将 $CP$ 用 $C$ 表示：\n$P = P_{\\mathrm{T}} - CP$。代入方程（5）：\n$K_{d}^{\\mathrm{CP}} = \\frac{C (P_{\\mathrm{T}} - CP)}{CP}$\n$K_{d}^{\\mathrm{CP}} \\cdot CP = C \\cdot P_{\\mathrm{T}} - C \\cdot CP$\n$CP (K_{d}^{\\mathrm{CP}} + C) = C \\cdot P_{\\mathrm{T}}$\n因此，$CP = \\frac{C \\cdot P_{\\mathrm{T}}}{K_{d}^{\\mathrm{CP}} + C}$。\n\n现在，我们将 $CE$ 和 $CP$ 的这些表达式代入CDK2的质量守恒定律，即方程（1）：\n$C_{\\mathrm{T}} = C + \\frac{C \\cdot E_{\\mathrm{T}}}{K_{d}^{\\mathrm{CE}} + C} + \\frac{C \\cdot P_{\\mathrm{T}}}{K_{d}^{\\mathrm{CP}} + C}$\n\n这就是关于游离CDK2浓度 $C$ 的控制方程。我们代入给定的数值（所有单位均为nM，因此计算时可以省略单位）：\n$C_{\\mathrm{T}} = 50$, $E_{\\mathrm{T}} = 80$, $P_{\\mathrm{T}} = 40$, $K_{d}^{\\mathrm{CE}} = 15$, $K_{d}^{\\mathrm{CP}} = 5$。\n\n$50 = C + \\frac{80 C}{15 + C} + \\frac{40 C}{5 + C}$\n\n为了解出 $C$，我们将此方程重排为多项式形式。\n$50 - C = C \\left( \\frac{80}{15 + C} + \\frac{40}{5 + C} \\right)$\n$50 - C = C \\left( \\frac{80(5 + C) + 40(15 + C)}{(15 + C)(5 + C)} \\right)$\n$(50 - C)(15 + C)(5 + C) = C (400 + 80C + 600 + 40C)$\n$(50 - C)(75 + 20C + C^2) = C (1000 + 120C)$\n$3750 + 1000C + 50C^2 - 75C - 20C^2 - C^3 = 1000C + 120C^2$\n$3750 + 925C + 30C^2 - C^3 = 1000C + 120C^2$\n将所有项移到一边，得到：\n$C^3 + (120 - 30)C^2 + (1000 - 925)C - 3750 = 0$\n$C^3 + 90C^2 + 75C - 3750 = 0$\n\n必须解这个三次方程以求得 $C$。由于 $C$ 代表物理浓度，我们寻找唯一的正实根。需要使用数值方法求解。设 $g(C) = C^3 + 90C^2 + 75C - 3750$。\n$g(5) = 125 + 90(25) + 75(5) - 3750 = 125 + 2250 + 375 - 3750 = -1000$。\n$g(6) = 216 + 90(36) + 75(6) - 3750 = 216 + 3240 + 450 - 3750 = 156$。\n根位于 $C=5$ 和 $C=6$ 之间。该多项式的数值解给出了一个更精确的值：\n$C \\approx 5.87521\\,\\mathrm{nM}$。\n\n利用 $C$ 的这个值，我们现在可以计算活性复合物 $CE$ 的浓度：\n$CE = \\frac{C \\cdot E_{\\mathrm{T}}}{K_{d}^{\\mathrm{CE}} + C} = \\frac{5.87521 \\cdot 80}{15 + 5.87521} = \\frac{470.0168}{20.87521} \\approx 22.5155\\,\\mathrm{nM}$。\n\n最后一步是计算活性CDK2的分数 $f_{\\mathrm{active}}$：\n$f_{\\mathrm{active}} = \\frac{CE}{C_{\\mathrm{T}}} = \\frac{22.5155}{50} = 0.45031$。\n\n按要求将结果四舍五入到四位有效数字，得到 $0.4503$。\n最终结果是一个无量纲的分数。", "answer": "$$\\boxed{0.4503}$$", "id": "2857502"}, {"introduction": "细胞周期的调控网络充满了反馈回路，这些回路能够产生复杂的动态行为，例如不可逆的转换开关。这个思想实验将引导你分析一个经典的细胞周期调控模块——CDK1-Wee1-Cdc25回路，它通过正反馈机制实现了进入有丝分裂的“全或无”式开关。通过预测磷酸酶活性的变化如何影响这个双稳态开关的阈值，你将深入理解细胞周期事件的单向性和稳健性是如何通过系统层面的设计实现的 [@problem_id:2857458]。", "problem": "一个用于有丝分裂进入和退出的经典调控模块由细胞周期蛋白依赖性激酶$1$（CDK$1$）、抑制性激酶Wee$1$和激活性磷酸酶细胞分裂周期磷酸酶$25$（Cdc$25$）组成。与细胞周期蛋白伴侣（$C$，活性细胞周期蛋白的有效浓度）结合的CDK$1$受到Wee$1$的抑制和Cdc$25$的激活。活性的CDK$1$通过磷酸化Wee$1$来抑制它，并通过磷酸化Cdc$25$来激活它，从而建立起耦合的正反馈回路。拮抗性蛋白磷酸酶（例如，蛋白磷酸酶$2$A（PP$2$A））去除Cdc$25$上的这些激活性磷酸化和Wee$1$上的抑制性磷酸化，并且也使CDK$1$底物去磷酸化。随着$C$在间期缓慢增加，系统在CDK$1$活性方面表现出一个双稳态的、滞后的开关：存在一个进入阈值$C_{\\mathrm{on}}$，当$C$增加时，系统在该阈值处从低活性状态翻转到高活性状态；还有一个退出阈值$C_{\\mathrm{off}}$，当$C$减少时，系统在该阈值处翻转回来。\n\n假设以下基本事实和定义，不引用任何详细的或系统特定的拟合公式：\n- 磷酸化-去磷酸化循环遵循质量作用平衡：在稳态下，底物上的净磷酸化通量等于净去磷酸化通量。对于一个代表性的由CDK$1$调控的位点，磷酸化通量与CDK$1$活性（$A$）单调相关，而去磷酸化通量与一个有效的磷酸酶活性参数（$P$）单调相关。\n- 通过Cdc$25$/Wee$1$的正反馈可以在$A$和$C$之间产生一个S形的稳态关系，当反馈相对于磷酸酶的拮抗作用足够强时，就会出现双稳态性。\n- 开关阈值$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$对应于鞍结点，在这些点上，当$C$被准静态地增加或减少时，低活性和高活性的稳态分别失去稳定性。\n\n请你从第一性原理出发，预测一致地增加有效磷酸酶活性$P$（例如，通过上调PP$2$A或下调Greatwall激酶通路）会如何改变进入和退出有丝分裂所需的$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$值。在保持所有其他参数固定，并假设该回路保持双稳态的情况下，选择当$P$增加时这些位移方向的最佳描述。\n\nA. $C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$都向更高的$C$值移动（进入有丝分裂需要更高的细胞周期蛋白水平；在更高的细胞周期蛋白水平上发生退出），并且滞后窗口趋于缩小。\n\nB. $C_{\\mathrm{on}}$增加（向更高的$C$值移动），而$C_{\\mathrm{off}}$减少（向更低的$C$值移动），从而扩大了滞后窗口。\n\nC. $C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$都向更低的$C$值移动（较低的细胞周期蛋白水平足以进入有丝分裂；在较低的细胞周期蛋白水平上发生退出）。\n\nD. $C_{\\mathrm{on}}$减少（向更低的$C$值移动），而$C_{\\mathrm{off}}$增加（向更高的$C$值移动），从而反转了滞后方向。", "solution": "问题陈述已提交验证。\n\n### 步骤1：提取已知条件\n- **系统组件**：细胞周期蛋白依赖性激酶$1$ (CDK$1$)、抑制性激酶Wee$1$、激活性磷酸酶细胞分裂周期磷酸酶$25$ (Cdc$25$)、细胞周期蛋白 ($C$)，以及具有有效活性$P$的拮抗性蛋白磷酸酶 (例如，PP$2$A)。\n- **相互作用**：\n    1. 与细胞周期蛋白$C$结合的CDK$1$受到Wee$1$的抑制。\n    2. 与细胞周期蛋白$C$结合的CDK$1$受到Cdc$25$的激活。\n    3. 活性的CDK$1$抑制Wee$1$。\n    4. 活性的CDK$1$激活Cdc$25$。（这两点构成了耦合的正反馈回路）。\n    5. 拮抗性磷酸酶（活性$P$）逆转Cdc$25$上的磷酸化（使其失活）和Wee$1$上的磷酸化（使其激活）。\n- **系统动力学与定义**：\n    1. 活性细胞周期蛋白的有效浓度$C$是在间期缓慢增加的输入。\n    2. 系统在CDK$1$活性$A$方面具有一个双稳态的、滞后的开关。\n    3. 当$C$越过进入阈值$C_{\\mathrm{on}}$时，发生有丝分裂进入，导致$A$从低活性切换到高活性。\n    4. 当$C$越过退出阈值$C_{\\mathrm{off}}$时，发生有丝分裂退出，导致$A$从高活性切换到低活性。\n- **基本事实**：\n    1. 磷酸化-去磷酸化循环遵循质量作用平衡。\n    2. 对于一个由CDK$1$调控的位点，磷酸化通量与CDK$1$活性（$A$）单调相关，而去磷酸化通量与磷酸酶活性（$P$）单调相关。\n    3. 正反馈回路可以在$A$和$C$之间产生一个S形的稳态关系。\n    4. $C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$是低活性和高活性稳态失去稳定性时的鞍结点。\n- **问题**：预测当有效磷酸酶活性$P$一致增加时，$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$如何移动，假设系统保持双稳态。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了细胞周期调控的一个基石性概念模型，通常归功于Novak和Tyson。\n- **科学基础扎实**：对CDK1-Wee1-Cdc25回路的描述是分子细胞生物学中一个标准的、被广泛接受的模型。其组件、相互作用以及由此产生的滞后行为在根本上是正确的，并且有充分的文献记载。质量作用平衡和用于开关的鞍结分岔原理在化学动力学和动力系统理论中是标准内容。\n- **问题定义明确**：该问题要求两个分岔点（$C_{\\mathrm{on}}$、$C_{\\mathrm{off}}$）相对于一个参数变化（$P$）的定性变化方向。这是分岔分析中一个定义明确的问题。所提供的原理足以推导出一个唯一的定性答案。\n- **客观性**：语言是技术性的且无歧义。诸如“单调”、“双稳态”、“鞍结”和“反馈”等术语具有精确的数学和科学含义。\n- **其他缺陷**：该问题内容完整，内部一致，并且要求从第一性原理进行推理而不是回忆特定公式，使其成为一个有效的概念性挑战。\n\n### 步骤3：结论与行动\n问题陈述被宣布为有效。将推导解答。\n\n### 推导与分析\n\n系统的核心是对CDK$1$活性的调控，我们用$A$表示。稳态活性$A_{ss}$由激活和失活过程之间的平衡决定，而这些过程又反过来是$A$本身（由于反馈）和输入参数——细胞周期蛋白浓度$C$的函数。\n\n让我们分析控制$A$稳态水平的各种力量。CDK$1$的活性由磷酸化事件建立。其自身的活性由磷酸酶Cdc$25$开启，由激酶Wee$1$关闭。\n\n关键特征是双重正反馈：活性的CDK$1$通过激活Cdc$25$和抑制Wee$1$来促进其自身的激活。CDK$1$活性的这种自我放大性质是实现强烈、开关般响应的原因。\n\n具有有效活性$P$的拮抗性磷酸酶对抗这些反馈回路。其作用是：\n1. 使Cdc$25$失活（通过去磷酸化），从而抵消CDK$1$激活其自身激活剂的企图。\n2. 激活Wee$1$（通过去磷酸化），从而抵消CDK$1$抑制其自身抑制剂的企图。\n\n本质上，参数$P$代表了对CDK$1$自我激活的“反对”力量的强度。CDK$1$激活的初始驱动力由其细胞周期蛋白伴侣的浓度$C$提供。\n\n考虑稳态，此时CDK$1$的激活速率与其失活速率相平衡。对于任何给定的细胞周期蛋白水平$C$，磷酸酶活性$P$的增加将产生两种协同效应，两者都抑制CDK$1$活性：通过Cdc$25$的激活通路被削弱，而通过Wee$1$的失活通路被加强。\n\n因此，要达到任何特定的稳态CDK$1$活性水平$A_{ss}$，都需要一个更强的初始刺激来克服来自$P$的增强的拮抗作用。初始刺激是细胞周期蛋白浓度$C$。因此，对于一个固定的$A_{ss}$，更高的$P$必然要求更高的$C$。\n\n从几何上看，这意味着代表稳态CDK$1$活性$A_{ss}$作为$C$的函数的S形曲线，随着$P$的增加而向右（朝向更高的$C$值）移动。\n\n阈值$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$是鞍结分岔点的$C$坐标，这些点对应于S形曲线的“膝部”。\n- $C_{\\mathrm{on}}$是较低的、低活性状态消失的点，迫使系统跃升至高活性状态。这是下分支的最右点。\n- $C_{\\mathrm{off}}$是较高的、高活性状态消失的点，迫使系统跃降至低活性状态。这是上分支的最左点。\n\n由于整个S形曲线沿$C$轴向右移动，这两个特征点$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$也必须向更高的$C$值移动。\n\n现在，我们来考虑滞后窗口的宽度，它由差值$C_{\\mathrm{on}} - C_{\\mathrm{off}}$给出。滞后和双稳态是强正反馈的直接结果。磷酸酶活性$P$直接拮抗这种反馈。通过增加$P$，我们削弱了正反馈回路的有效强度。随着反馈减弱，曲线的S形变得不那么显著——双稳态区域缩小。在$P$大到足以完全压倒反馈的极限情况下，响应变为单调的，双稳态性消失。因此，随着$P$的增加，两个分岔点$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$必须相互靠近，导致滞后窗口缩小。\n\n总之，增加磷酸酶活性$P$具有以下效应：\n1. 有丝分裂进入阈值$C_{\\mathrm{on}}$增加。\n2. 有丝分裂退出阈值$C_{\\mathrm{off}}$也增加。\n3. 滞后窗口大小，$C_{\\mathrm{on}} - C_{\\mathrm{off}}$，减小。\n\n### 逐项分析\n\nA. **$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$都向更高的$C$值移动（进入有丝分裂需要更高的细胞周期蛋白水平；在更高的细胞周期蛋白水平上发生退出），并且滞后窗口趋于缩小。**\n这个陈述与我们的推导完全一致。增加拮抗性磷酸酶的活性使得，相对于反馈回路的状态，开启CDK$1$变得更难，而关闭它变得更容易。这需要更多的细胞周期蛋白C来达到进入并维持活性状态，因此两个阈值都向更高的$C$值移动。正反馈的减弱缩小了双稳态区域。\n**结论：正确。**\n\nB. **$C_{\\mathrm{on}}$增加（向更高的$C$值移动），而$C_{\\mathrm{off}}$减少（向更低的$C$值移动），从而扩大了滞后窗口。**\n这是不正确的。$C_{\\mathrm{off}}$的减少意味着活性状态在低细胞周期蛋白水平下*更*稳定，这与磷酸酶$P$促进CDK$1$失活的作用相矛盾。这种情况描述了滞后窗口的扩大，这将对应于正反馈的加强，而不是减弱。\n**结论：不正确。**\n\nC. **$C_{\\mathrm{on}}$和$C_{\\mathrm{off}}$都向更低的$C$值移动（较低的细胞周期蛋白水平足以进入有丝分裂；在较低的细胞周期蛋白水平上发生退出）。**\n这是不正确的。这描述了*减少*磷酸酶活性$P$的效果，或者等效地，加强正反馈机制的效果。\n**结论：不正确。**\n\nD. **$C_{\\mathrm{on}}$减少（向更低的$C$值移动），而$C_{\\mathrm{off}}$增加（向更高的$C$值移动），从而反转了滞后方向。**\n这在逻辑上和物理上都是荒谬的。为了存在滞后，必须有$C_{\\mathrm{on}} > C_{\\mathrm{off}}$。如果$C_{\\mathrm{on}}$减少而$C_{\\mathrm{off}}$增加，双稳态区域将缩小并最终消失。如果它们交叉，使得$C_{\\mathrm{on}}  C_{\\mathrm{off}}$，系统将不再是一个滞后开关。“反转滞后方向”在此上下文中没有意义。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2857458"}, {"introduction": "将理论模型与实验数据相结合是现代细胞生物学的核心。这个练习模拟了对真实世界实验数据——荧光泛素化细胞周期指示剂（FUCCI）系统——的分析过程，该系统被广泛用于实时观察活细胞的周期进程。通过遵循一个明确的算法来处理时间序列数据，你将学习如何提取关键的生物学参数，如细胞周期各阶段的时长，并量化它们的细胞间差异，这是定量细胞生物学的一项基本技能 [@problem_id:2857561]。", "problem": "您会获得来自荧光泛素化细胞周期指示剂 (FUCCI) 的延时测量数据，这是一个双报告系统，其中基于Cdt1的红色报告基因在G1期高表达，而基于Geminin的绿色报告基因在S/G2/M期高表达。在真核细胞中，细胞周期按G1、S、G2和M的顺序进行。在单细胞分辨率下，绿色报告基因强度首次持续超过红色报告基因强度的时刻标志着操作性的G1期到S期的转换；此后，细胞处于S/G2/M期，直到下一次有丝分裂。您的任务是为每个提供的单细胞轨迹计算G1期持续时间和S/G2/M期持续时间，然后使用变异系数来量化细胞间的变异性。\n\n需要使用的基本和操作性定义：\n- 真核细胞周期包括G1、S、G2和M期。在FUCCI系统中，红色Cdt1报告基因的强度在G1期较高，而绿色Geminin报告基因的强度在S/G2/M期较高。\n- 对于每个细胞，您会得到两个时间序列：在离散帧 $i = 0, 1, \\dots, E-1$ 处以恒定时间间隔 $\\Delta t$（单位：小时）采样的红色强度 $R[i]$ 和绿色强度 $G[i]$。\n- 为减少测量噪声，对 $R[i]$ 和 $G[i]$ 应用一个奇数窗口大小为 $w$（单位：帧）的中心移动中值滤波器。使用边缘填充（复制边界值），以使滤波后的序列与输入序列具有相同的长度。\n- 定义一个决策变量 $\\delta[i] = G_{\\text{med}}[i] - R_{\\text{med}}[i]$，其中 $G_{\\text{med}}$ 和 $R_{\\text{med}}$ 是经过中值滤波的序列。\n- 使用严格阈值 $\\theta = 0$：当 $\\delta[i] \\le \\theta$ 时，判定为G1期；当 $\\delta[i] > \\theta$ 时，判定为S/G2/M期。\n- 为确保鲁棒性，将G1期到S期的转换索引 $i^\\ast$ 定义为满足 $\\delta[i] > \\theta$ 条件持续 $h$ 个连续帧的最小索引，即 $\\delta[i] > 0, \\delta[i+1] > 0, \\dots, \\delta[i+h-1] > 0$，且 $i+h-1 \\le E-1$。\n- G1期持续时间为 $T_{\\mathrm{G1}} = i^\\ast \\cdot \\Delta t$（单位：小时）。\n- S/G2/M期持续时间为 $T_{\\mathrm{S/G2/M}} = (E - i^\\ast) \\cdot \\Delta t$（单位：小时），即从第一个S期帧到有丝分裂前的最后一帧。\n- 如果不存在持续的转换（即没有索引满足 $h$ 帧正值条件），则该细胞的两个持续时间均为未定义；将每个未定义值表示为浮点数NaN（非数字）。\n- 对于所有具有已定义持续时间的细胞，使用变异系数 (CV) 量化变异性，对于集合 $\\{x_1,\\dots,x_n\\}$，其平均值为 $\\mu = \\frac{1}{n}\\sum_{k=1}^{n} x_k$，总体标准差为 $\\sigma = \\sqrt{\\frac{1}{n}\\sum_{k=1}^{n}(x_k - \\mu)^2}$，变异系数定义为 $\\mathrm{CV} = \\sigma / \\mu$。从 $\\{T_{\\mathrm{G1}}\\}$ 计算 $\\mathrm{CV}_{\\mathrm{G1}}$，从 $\\{T_{\\mathrm{S/G2/M}}\\}$ 计算 $\\mathrm{CV}_{\\mathrm{S/G2/M}}$，计算中排除 NaN 值。\n\n将所有持续时间和变异系数以小时为单位表示为四舍五入到三位小数的十进制浮点数。\n\n实现上述逻辑，并将其应用于以下测试套件。每个测试用例提供 $(\\Delta t, w, h, E, R[0..E-1], G[0..E-1])$。索引从零开始，$E$ 等于每个轨迹的长度。\n\n测试套件：\n- 情况 A：\n  - $\\Delta t = 0.5$, $w = 3$, $h = 2$, $E = 16$\n  - $R = [\\,80,\\,78,\\,75,\\,70,\\,65,\\,60,\\,55,\\,50,\\,45,\\,40,\\,35,\\,30,\\,27,\\,25,\\,24,\\,23\\,]$\n  - $G = [\\,10,\\,12,\\,14,\\,18,\\,22,\\,28,\\,35,\\,43,\\,52,\\,60,\\,68,\\,74,\\,78,\\,80,\\,82,\\,83\\,]$\n- 情况 B：\n  - $\\Delta t = 0.5$, $w = 3$, $h = 2$, $E = 16$\n  - $R = [\\,90,\\,88,\\,86,\\,84,\\,80,\\,76,\\,70,\\,65,\\,60,\\,55,\\,50,\\,45,\\,40,\\,38,\\,36,\\,34\\,]$\n  - $G = [\\,8,\\,9,\\,10,\\,11,\\,13,\\,15,\\,17,\\,20,\\,55,\\,50,\\,52,\\,54,\\,60,\\,70,\\,80,\\,85\\,]$\n- 情况 C：\n  - $\\Delta t = 0.5$, $w = 3$, $h = 2$, $E = 10$\n  - $R = [\\,50,\\,48,\\,46,\\,44,\\,40,\\,38,\\,35,\\,34,\\,33,\\,32\\,]$\n  - $G = [\\,55,\\,58,\\,60,\\,62,\\,65,\\,68,\\,70,\\,72,\\,74,\\,75\\,]$\n- 情况 D：\n  - $\\Delta t = 0.5$, $w = 3$, $h = 2$, $E = 14$\n  - $R = [\\,120,\\,118,\\,116,\\,114,\\,112,\\,110,\\,108,\\,106,\\,100,\\,90,\\,80,\\,60,\\,40,\\,30\\,]$\n  - $G = [\\,5,\\,5,\\,6,\\,6,\\,7,\\,8,\\,9,\\,10,\\,20,\\,30,\\,40,\\,55,\\,70,\\,90\\,]$\n\n您的程序应为每个情况计算 $(T_{\\mathrm{G1}}, T_{\\mathrm{S/G2/M}})$ 对（单位：小时），然后使用已定义的持续时间计算所有情况的 $\\mathrm{CV}_{\\mathrm{G1}}$ 和 $\\mathrm{CV}_{\\mathrm{S/G2/M}}$。将所有输出四舍五入到三位小数。\n\n最终输出格式：\n- 生成单行输出，包含一个用方括号括起来的逗号分隔列表，列表内无空格。\n- 该列表必须按以下顺序包含四个元素：\n  1. 包含情况A–D的四个 $T_{\\mathrm{G1}}$ 值的列表（单位：小时，浮点数，保留三位小数，若未定义则使用NaN）。\n  2. 包含情况A–D的四个 $T_{\\mathrm{S/G2/M}}$ 值的列表（单位：小时，浮点数，保留三位小数，若未定义则使用NaN）。\n  3. 标量 $\\mathrm{CV}_{\\mathrm{G1}}$（浮点数，保留三位小数）。\n  4. 标量 $\\mathrm{CV}_{\\mathrm{S/G2/M}}$（浮点数，保留三位小数）。\n例如：\"[[x_A,x_B,x_C,x_D],[y_A,y_B,y_C,y_D],cv_g1,cv_sg2m]\"。", "solution": "所提出的问题是细胞生物学中一个定义明确的计算练习，要求分析来自荧光泛素化细胞周期指示剂 (FUCCI) 系统的时间序列数据。该问题具有科学依据、内部一致且完整。因此，它被认为是有效的，并且可以通过严格遵循指定的算法来推导出解决方案。\n\n核心任务是从荧光强度轨迹中确定真核细胞周期的 $G1$ 期和 $S/G2/M$ 期的持续时间，并量化它们的细胞间变异性。对于每个单细胞轨迹，求解方法论按一系列离散、正式的步骤进行。\n\n首先，我们得到红色报告基因 ($R[i]$) 和绿色报告基因 ($G[i]$) 在离散时间点 $i$ (从 $0$ 到 $E-1$)、以时间间隔 $\\Delta t$ 采样的时序数据。$R$ 信号在 $G1$ 期高表达，而 $G$ 信号在 $S/G2/M$ 期高表达。\n\n为了减轻测量噪声（荧光显微镜检查中的常见误差来源），问题要求对两个时间序列应用窗口大小为 $w=3$ 的中心移动中值滤波器。对于给定的序列 $X[i]$，滤波后的值 $X_{\\text{med}}[i]$ 是 $\\{X[i-1], X[i], X[i+1]\\}$ 的中位数。为了处理序列的边界（$i=0$ 和 $i=E-1$），指定了边缘填充，即复制边界值。这确保了滤波后的序列 $R_{\\text{med}}$ 和 $G_{\\text{med}}$ 与原始数据具有相同的长度 $E$。此滤波步骤可平滑伪峰，同时保留急剧的转变，这对于检测细胞周期阶段转换非常有利。\n\n接下来，定义一个决策变量 $\\delta[i]$ 为过滤后的绿色和红色强度之差：\n$$\n\\delta[i] = G_{\\text{med}}[i] - R_{\\text{med}}[i]\n$$\n该变量量化了两个报告基因的相对优势。$\\delta[i]$ 的正值表示绿色报告基因（$S/G2/M$ 标记）强于红色报告基因（$G1$ 标记），反之亦然。阶段转换由严格阈值 $\\theta = 0$ 确定。当 $\\delta[i] \\le \\theta$ 时，细胞处于 $G1$ 期；当 $\\delta[i] > \\theta$ 时，细胞处于 $S/G2/M$ 期。\n\n为确保检测到的转换不是瞬时波动，施加了一个鲁棒性准则。G1期到S期的转换由第一个时间索引 $i^\\ast$ 标记，在该索引处 $\\delta[i]$ 连续 $h$ 帧保持正值。形式上，$i^\\ast$ 是在 $[0, E-h]$ 区间内使得对于所有 $k \\in [i, i+h-1]$ 都有 $\\delta[k] > 0$ 的最小索引 $i$。如果数据中不存在这样的索引，则认为该细胞的转换是未定义的。\n\n一旦确定了 $i^\\ast$，就可以计算阶段持续时间。$G1$ 期包含转换前的所有时间帧，因此其持续时间为：\n$$\nT_{\\mathrm{G1}} = i^\\ast \\cdot \\Delta t\n$$\n$S/G2/M$ 期包含观测的剩余帧。其持续时间为：\n$$\nT_{\\mathrm{S/G2/M}} = (E - i^\\ast) \\cdot \\Delta t\n$$\n如果找不到 $i^\\ast$，则将 $T_{\\mathrm{G1}}$ 和 $T_{\\mathrm{S/G2/M}}$ 都设置为“非数字”(NaN)，以表示未定义状态。\n\n最后，为了量化细胞间的变异性，计算了 $G1$ 期持续时间集合和 $S/G2/M$ 期持续时间集合的变异系数 (CV)。CV 是一种标准化的离散程度度量，定义为总体标准差 $\\sigma$ 与平均值 $\\mu$ 的比值：\n$$\n\\mathrm{CV} = \\frac{\\sigma}{\\mu} = \\frac{\\sqrt{\\frac{1}{n}\\sum_{k=1}^{n}(x_k - \\mu)^2}}{\\frac{1}{n}\\sum_{k=1}^{n} x_k}\n$$\n此计算仅对持续时间已定义（即非 NaN）的细胞执行。\n\n将此程序应用于所提供的测试用例：\n\n**情况 A**：$\\Delta t=0.5, w=3, h=2, E=16$\n$R_{\\text{med}} = [78, 78, 75, 70, 65, 60, 55, 50, 45, 40, 35, 30, 27, 25, 24, 23]$\n$G_{\\text{med}} = [10, 12, 14, 18, 22, 28, 35, 43, 52, 60, 68, 74, 78, 80, 82, 83]$\n$\\delta = [-68, -66, -61, -52, -43, -32, -20, -7, 7, 20, 33, 44, 51, 55, 58, 60]$\n第一个满足 $\\delta[i]>0$ 和 $\\delta[i+1]>0$ 的索引 $i$ 是 $i^\\ast = 8$。\n$T_{\\mathrm{G1}} = 8 \\cdot 0.5 = 4.0$ 小时。\n$T_{\\mathrm{S/G2/M}} = (16 - 8) \\cdot 0.5 = 4.0$ 小时。\n\n**情况 B**：$\\Delta t=0.5, w=3, h=2, E=16$\n$R_{\\text{med}} = [88, 88, 86, 84, 80, 76, 70, 65, 60, 55, 50, 45, 40, 38, 36, 34]$\n$G_{\\text{med}} = [8, 9, 10, 11, 13, 15, 17, 20, 50, 52, 52, 54, 60, 70, 80, 85]$\n$\\delta = [-80, -79, -76, -73, -67, -61, -53, -45, -10, -3, 2, 9, 20, 32, 44, 51]$\n第一个满足 $\\delta[i]>0$ 和 $\\delta[i+1]>0$ 的索引 $i$ 是 $i^\\ast = 10$。\n$T_{\\mathrm{G1}} = 10 \\cdot 0.5 = 5.0$ 小时。\n$T_{\\mathrm{S/G2/M}} = (16 - 10) \\cdot 0.5 = 3.0$ 小时。\n\n**情况 C**：$\\Delta t=0.5, w=3, h=2, E=10$\n$R_{\\text{med}} = [48, 48, 46, 44, 40, 38, 35, 34, 33, 32]$\n$G_{\\text{med}} = [55, 58, 60, 62, 65, 68, 70, 72, 74, 75]$\n$\\delta = [7, 10, 14, 18, 25, 30, 35, 38, 41, 43]$\n第一个满足 $\\delta[i]>0$ 和 $\\delta[i+1]>0$ 的索引 $i$ 是 $i^\\ast = 0$。\n$T_{\\mathrm{G1}} = 0 \\cdot 0.5 = 0.0$ 小时。\n$T_{\\mathrm{S/G2/M}} = (10 - 0) \\cdot 0.5 = 5.0$ 小时。\n\n**情况 D**：$\\Delta t=0.5, w=3, h=2, E=14$\n$R_{\\text{med}} = [118, 118, 116, 114, 112, 110, 108, 106, 100, 90, 80, 60, 40, 30]$\n$G_{\\text{med}} = [5, 5, 6, 6, 7, 8, 9, 10, 20, 30, 40, 55, 70, 90]$\n$\\delta = [-113, -113, -110, -108, -105, -102, -99, -96, -80, -60, -40, -5, 30, 60]$\n第一个满足 $\\delta[i]>0$ 和 $\\delta[i+1]>0$ 的索引 $i$ 是 $i^\\ast = 12$。\n$T_{\\mathrm{G1}} = 12 \\cdot 0.5 = 6.0$ 小时。\n$T_{\\mathrm{S/G2/M}} = (14 - 12) \\cdot 0.5 = 1.0$ 小时。\n\n**变异系数计算**：\n对于 $T_{\\mathrm{G1}}$ 值 $\\{4.0, 5.0, 0.0, 6.0\\}$：\n$\\mu_{\\mathrm{G1}} = (4.0 + 5.0 + 0.0 + 6.0)/4 = 3.75$\n$\\sigma_{\\mathrm{G1}} = \\sqrt{((4-3.75)^2 + (5-3.75)^2 + (0-3.75)^2 + (6-3.75)^2)/4} = \\sqrt{5.1875} \\approx 2.2776$\n$\\mathrm{CV}_{\\mathrm{G1}} = 2.2776 / 3.75 \\approx 0.607$\n\n对于 $T_{\\mathrm{S/G2/M}}$ 值 $\\{4.0, 3.0, 5.0, 1.0\\}$：\n$\\mu_{\\mathrm{S/G2/M}} = (4.0 + 3.0 + 5.0 + 1.0)/4 = 3.25$\n$\\sigma_{\\mathrm{S/G2/M}} = \\sqrt{((4-3.25)^2 + (3-3.25)^2 + (5-3.25)^2 + (1-3.25)^2)/4} = \\sqrt{2.1875} \\approx 1.4790$\n$\\mathrm{CV}_{\\mathrm{S/G2/M}} = 1.4790 / 3.25 \\approx 0.455$\n\n所有结果将在最终输出时四舍五入到三位小数。", "answer": "```python\nimport numpy as np\nfrom scipy import ndimage\n\ndef solve():\n    \"\"\"\n    Processes single-cell FUCCI data to determine cell cycle phase durations\n    and their coefficient of variation.\n    \"\"\"\n    test_cases = [\n        # Case A\n        (0.5, 3, 2, 16, \n         [80, 78, 75, 70, 65, 60, 55, 50, 45, 40, 35, 30, 27, 25, 24, 23], \n         [10, 12, 14, 18, 22, 28, 35, 43, 52, 60, 68, 74, 78, 80, 82, 83]),\n        # Case B\n        (0.5, 3, 2, 16, \n         [90, 88, 86, 84, 80, 76, 70, 65, 60, 55, 50, 45, 40, 38, 36, 34],\n         [8, 9, 10, 11, 13, 15, 17, 20, 55, 50, 52, 54, 60, 70, 80, 85]),\n        # Case C\n        (0.5, 3, 2, 10,\n         [50, 48, 46, 44, 40, 38, 35, 34, 33, 32],\n         [55, 58, 60, 62, 65, 68, 70, 72, 74, 75]),\n        # Case D\n        (0.5, 3, 2, 14,\n         [120, 118, 116, 114, 112, 110, 108, 106, 100, 90, 80, 60, 40, 30],\n         [5, 5, 6, 6, 7, 8, 9, 10, 20, 30, 40, 55, 70, 90])\n    ]\n\n    all_t_g1 = []\n    all_t_sg2m = []\n\n    for case in test_cases:\n        delta_t, w, h, E, R, G = case\n        \n        # Convert lists to NumPy arrays for vectorized operations\n        R_arr = np.array(R, dtype=float)\n        G_arr = np.array(G, dtype=float)\n\n        # 1. Apply centered moving median filter with edge padding\n        # mode='nearest' corresponds to replicating boundary values.\n        R_med = ndimage.median_filter(R_arr, size=w, mode='nearest')\n        G_med = ndimage.median_filter(G_arr, size=w, mode='nearest')\n\n        # 2. Compute decision variable\n        delta = G_med - R_med\n\n        # 3. Find the G1-to-S transition index i*\n        # i* is the smallest index i such that delta > 0 for h consecutive frames.\n        i_star = -1  # Sentinel value for \"not found\"\n        for i in range(E - h + 1):\n            if np.all(delta[i : i + h] > 0):\n                i_star = i\n                break\n        \n        # 4. Calculate G1 and S/G2/M durations\n        if i_star != -1:\n            t_g1 = i_star * delta_t\n            t_sg2m = (E - i_star) * delta_t\n        else:\n            t_g1 = np.nan\n            t_sg2m = np.nan\n        \n        all_t_g1.append(t_g1)\n        all_t_sg2m.append(t_sg2m)\n\n    # 5. Quantify variability using the coefficient of variation (CV)\n    # Exclude NaN values from calculation\n    valid_t_g1 = [t for t in all_t_g1 if not np.isnan(t)]\n    valid_t_sg2m = [t for t in all_t_sg2m if not np.isnan(t)]\n    \n    # The population standard deviation is computed by np.std by default.\n    cv_g1 = np.std(valid_t_g1) / np.mean(valid_t_g1) if valid_t_g1 else 0.0\n    cv_sg2m = np.std(valid_t_sg2m) / np.mean(valid_t_sg2m) if valid_t_sg2m else 0.0\n\n    # 6. Format the output according to the problem specification\n    # Helper to format floats to 3 decimal places and handle NaN\n    def format_val(v):\n        if np.isnan(v):\n            return \"NaN\"\n        return f\"{v:.3f}\"\n\n    t_g1_str = f\"[{','.join(map(format_val, all_t_g1))}]\"\n    t_sg2m_str = f\"[{','.join(map(format_val, all_t_sg2m))}]\"\n    cv_g1_str = format_val(cv_g1)\n    cv_sg2m_str = format_val(cv_sg2m)\n\n    final_output = f\"[[{format_val(all_t_g1[0])},{format_val(all_t_g1[1])},{format_val(all_t_g1[2])},{format_val(all_t_g1[3])}],[{format_val(all_t_sg2m[0])},{format_val(all_t_sg2m[1])},{format_val(all_t_sg2m[2])},{format_val(all_t_sg2m[3])}],{cv_g1_str},{cv_sg2m_str}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2857561"}]}