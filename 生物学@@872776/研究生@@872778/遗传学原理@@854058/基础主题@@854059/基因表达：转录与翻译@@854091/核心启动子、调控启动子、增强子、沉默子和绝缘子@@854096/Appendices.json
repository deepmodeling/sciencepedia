{"hands_on_practices": [{"introduction": "转录的起始本质上是一个概率性过程，遵循热力学原理。本练习将演示我们如何通过将转录因子的结合模拟为热力学平衡，来定量预测不同核心启动子的相对强度。通过将玻尔兹曼分布应用于TATA盒和起始子（Inr）等基序的结合自由能，您将计算出启动子结构如何直接影响预起始复合物（PIC）组装的可能性，从而为理解基因表达水平提供一个物理基础。[@problem_id:2802123]", "problem": "RNA聚合酶II的转录起始严重依赖于起始前复合物（PIC）的组装，该复合物由转录因子II D（TFIID）在核心启动子上成核。典型的核心启动子基序，如TATA盒（TATA）、起始子（Inr）和下游启动子元件（DPE），可调节TFIID的亲和力。考虑一个热力学平衡模型，在该模型中，启动子组装起始前复合物（PIC）的概率与TFIID结合到可用基序构型上的玻尔兹曼权重成正比。假设遵循以下建模原则：\n- 当基序共存时，各个基序对TFIID结合的结合自由能贡献是可加的，因此总结合自由能是各基序特定自由能的总和。\n- 不同启动子类别之间PIC组装的相对概率由其玻尔兹曼权重的比值决定，这与平衡统计力学一致。\n- 对于结合自由能为 $\\Delta G$ 的状态，使用玻尔兹曼因子 $\\exp\\!\\left(-\\Delta G/(R T)\\right)$，其中 $R$ 是气体常数，$T$ 是绝对温度。\n\n比较两类启动子：\n- A类：包含TATA和Inr（记为TATA+Inr）。\n- B类：包含Inr和DPE（记为Inr+DPE）。\n\n给定在温度 $T=300\\,\\text{K}$ 时基序特异性的结合自由能：\n- $\\Delta G_{\\text{TATA}}=-7\\,\\text{kcal}\\,\\text{mol}^{-1}$，\n- $\\Delta G_{\\text{Inr}}=-3\\,\\text{kcal}\\,\\text{mol}^{-1}$，\n- $\\Delta G_{\\text{DPE}}=-2\\,\\text{kcal}\\,\\text{mol}^{-1}$。\n\n使用气体常数 $R=1.987\\times 10^{-3}\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。在上述假设下，计算PIC组装的相对概率，定义为比值 $P_{\\text{PIC}}(\\text{TATA}+\\text{Inr})/P_{\\text{PIC}}(\\text{Inr}+\\text{DPE})$。将最终结果四舍五入至三位有效数字。以单个无量纲数（小数或科学记数法，不带百分号）报告您的答案。", "solution": "必须首先验证问题陈述的科学连贯性和逻辑一致性。\n\n**步骤1：提取给定信息**\n- 建模原则1：单个基序的结合自由能贡献是可加的。$\\Delta G_{\\text{total}} = \\sum \\Delta G_{\\text{motif}}$。\n- 建模原则2：起始前复合物（PIC）组装的相对概率由相应状态的玻尔兹曼权重的比值给出。\n- 玻尔兹曼因子的定义：$\\exp(-\\Delta G / (RT))$，其中 $\\Delta G$ 是结合自由能，$R$ 是气体常数，$T$ 是绝对温度。\n- 启动子A类：组成为TATA+Inr。\n- 启动子B类：组成为Inr+DPE。\n- 给定自由能：\n  - $\\Delta G_{\\text{TATA}} = -7\\,\\text{kcal}\\,\\text{mol}^{-1}$\n  - $\\Delta G_{\\text{Inr}} = -3\\,\\text{kcal}\\,\\text{mol}^{-1}$\n  - $\\Delta G_{\\text{DPE}} = -2\\,\\text{kcal}\\,\\text{mol}^{-1}$\n- 给定常数：\n  - 温度 $T = 300\\,\\text{K}$\n  - 气体常数 $R = 1.987 \\times 10^{-3}\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n- 要求计算：比值 $\\frac{P_{\\text{PIC}}(\\text{TATA}+\\text{Inr})}{P_{\\text{PIC}}(\\text{Inr}+\\text{DPE})}$。\n- 最终指令：将结果四舍五入至三位有效数字。\n\n**步骤2：验证问题陈述**\n该问题具有科学依据。它提出了一个简化但标准的热力学平衡模型来描述蛋白质-DNA相互作用，这是分子生物物理学和遗传学中的一个基本概念。使用玻尔兹曼分布将自由能差异与状态概率联系起来是统计力学的基石。自由能的可加性是此类模型中一个常见且有用的近似。该问题提法明确，提供了所有必要的数据和定义，没有内部矛盾或模糊之处。所给数值在物理上是合理的。\n\n**结论：** 该问题被认为是有效的，将提供解答。\n\n任务是计算两类启动子（我们表示为A (TATA+Inr) 和 B (Inr+DPE)）的PIC组装相对概率。这个相对概率是它们各自概率 $P_A$ 和 $P_B$ 的比值。根据问题陈述，给定状态的概率与其玻尔兹曼因子成正比。因此，概率之比就是它们玻尔兹曼因子之比：\n$$ \\frac{P_A}{P_B} = \\frac{P_{\\text{PIC}}(\\text{TATA}+\\text{Inr})}{P_{\\text{PIC}}(\\text{Inr}+\\text{DPE})} = \\frac{k \\cdot \\exp\\left(-\\frac{\\Delta G_A}{RT}\\right)}{k \\cdot \\exp\\left(-\\frac{\\Delta G_B}{RT}\\right)} $$\n比例常数 $k$ 被消掉，我们可以合并指数项：\n$$ \\frac{P_A}{P_B} = \\exp\\left(-\\frac{\\Delta G_A}{RT} + \\frac{\\Delta G_B}{RT}\\right) = \\exp\\left(-\\frac{\\Delta G_A - \\Delta G_B}{RT}\\right) $$\n这里，$\\Delta G_A$ 和 $\\Delta G_B$ 分别是启动子A类和B类的总结合自由能。\n\n自由能的可加性原则指出，具有多个基序的启动子的总结合自由能是单个基序能量的总和。\n对于启动子A类 (TATA+Inr)，总结合自由能为：\n$$ \\Delta G_A = \\Delta G_{\\text{TATA}} + \\Delta G_{\\text{Inr}} $$\n代入给定值：\n$$ \\Delta G_A = (-7\\,\\text{kcal}\\,\\text{mol}^{-1}) + (-3\\,\\text{kcal}\\,\\text{mol}^{-1}) = -10\\,\\text{kcal}\\,\\text{mol}^{-1} $$\n对于启动子B类 (Inr+DPE)，总结合自由能为：\n$$ \\Delta G_B = \\Delta G_{\\text{Inr}} + \\Delta G_{\\text{DPE}} $$\n代入给定值：\n$$ \\Delta G_B = (-3\\,\\text{kcal}\\,\\text{mol}^{-1}) + (-2\\,\\text{kcal}\\,\\text{mol}^{-1}) = -5\\,\\text{kcal}\\,\\text{mol}^{-1} $$\n现在，我们计算总结合自由能的差值 $\\Delta G_A - \\Delta G_B$：\n$$ \\Delta G_A - \\Delta G_B = (-10\\,\\text{kcal}\\,\\text{mol}^{-1}) - (-5\\,\\text{kcal}\\,\\text{mol}^{-1}) = -5\\,\\text{kcal}\\,\\text{mol}^{-1} $$\n接下来，我们计算热能项 $RT$：\n$$ R = 1.987 \\times 10^{-3}\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{K}^{-1} $$\n$$ T = 300\\,\\text{K} $$\n$$ RT = (1.987 \\times 10^{-3}\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}) \\times (300\\,\\text{K}) = 0.5961\\,\\text{kcal}\\,\\text{mol}^{-1} $$\n现在我们可以计算比值表达式中的指数：\n$$ -\\frac{\\Delta G_A - \\Delta G_B}{RT} = -\\frac{-5\\,\\text{kcal}\\,\\text{mol}^{-1}}{0.5961\\,\\text{kcal}\\,\\text{mol}^{-1}} = \\frac{5}{0.5961} \\approx 8.387854 $$\n单位按要求抵消，得到一个无量纲的指数。最后，我们通过取该值的指数来计算相对概率比：\n$$ \\frac{P_A}{P_B} = \\exp\\left(\\frac{5}{0.5961}\\right) \\approx \\exp(8.387854) \\approx 4393.35 $$\n问题要求答案四舍五入到三位有效数字。\n$$ 4393.35 \\approx 4390 $$\n这可以用科学记数法表示为 $4.39 \\times 10^3$。这一结果表明，在该热力学模型的假设下，具有TATA和Inr基序的启动子组装PIC的可能性大约是具有Inr和DPE基序的启动子的 $4390$ 倍。", "answer": "$$\\boxed{4.39 \\times 10^{3}}$$", "id": "2802123"}, {"introduction": "线性的DNA序列被组织成复杂的三维结构，其中绝缘子在界定调控区域方面起着至关重要的作用。本练习应用成熟的环挤压模型，探讨CCCTC结合因子（CTCF）位点如何形成染色质环，从而使基因的启动子与远端增强子隔离。您将利用CTCF介导成环的“汇聚方向规则”来预测可能的基因组结构并量化绝缘强度，从而亲身体验基因组架构的力学机制。[@problem_id:2802128]", "problem": "一个线性基因组片段包含三个CCCTC结合因子（CTCF）的结合位点，这些位点在环挤压模型中充当环锚定绝缘子。这些CTCF位点沿染色体的位置和方向（基序链极性）是已知的：位点 $S_1$ 位于位置 $x_1 = 100 \\ \\mathrm{kb}$，方向为 $>$；位点 $S_2$ 位于位置 $x_2 = 260 \\ \\mathrm{kb}$，方向为 $<$；位点 $S_3$ 位于位置 $x_3 = 480 \\ \\mathrm{kb}$，方向为 $<$。一个核心启动子 $P$ 位于位置 $x_P = 180 \\ \\mathrm{kb}$，一个远端增强子 $E$ 位于位置 $x_E = 430 \\ \\mathrm{kb}$。\n\n使用以下基本且经过充分检验的事实来建模接触概率和环约束：\n- 在环挤压框架中，稳定的CTCF锚定环优先在汇聚取向的基序之间形成；也就是说，对于一个在位置 $x_i$ 的左锚点和位置 $x_j$ 的右锚点之间形成的环（其中 $x_i < x_j$），左锚点必须具有 $>$ 方向，右锚点必须具有 $<$ 方向。\n- 在没有任何环的情况下，增强子-启动子接触概率随基因组距离 $d$ 近似指数衰减，模型为 $p_0(d) = A \\exp(-d/\\lambda)$，其中 $A$ 和 $\\lambda$ 是反映聚合物相遇统计和染色质压实的正常数。\n- 在存在单个CTCF锚定环的情况下，对于每个严格位于 $x_P$ 和 $x_E$ 之间的环边界，增强子-启动子接触概率都会被一个边界惩罚因子 $r \\in (0,1)$ 乘法衰减。因此，如果有 $n_b$ 个环边界严格落在 $x_P$ 和 $x_E$ 之间，概率为 $p(d;n_b) = A \\exp(-d/\\lambda)\\, r^{n_b}$。取 $r = 0.2$。忽略环内部的任何压实效应；仅应用边界衰减。\n\n假设一次最多只形成一个主导环，且环不能共享锚点。在这些假设下：\n1. 列举所有符合汇聚取向规则的可能环构型。\n2. 对于每种构型，确定严格位于 $x_P$ 和 $x_E$ 之间的环边界数量 $n_b$，并由此确定相对于无环情况的增强子-启动子接触概率。\n3. 确定能最佳地将启动子与增强子绝缘的构型（即，使接触概率最小化的构型）。\n4. 将绝缘强度定义为 $I = \\dfrac{p_0(|x_E - x_P|)}{\\min p(|x_E - x_P|;n_b)}$。将 $I$ 计算为一个纯数。将最终答案四舍五入到四位有效数字。将最终答案表示为无单位的纯数。", "solution": "在尝试求解之前，将首先对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知条件**\n提供的数据和条件如下：\n- CTCF 位点 $S_1$：位置 $x_1 = 100 \\ \\mathrm{kb}$，方向 $>$。\n- CTCF 位点 $S_2$：位置 $x_2 = 260 \\ \\mathrm{kb}$，方向 $<$。\n- CTCF 位点 $S_3$：位置 $x_3 = 480 \\ \\mathrm{kb}$，方向 $<$。\n- 启动子 $P$：位置 $x_P = 180 \\ \\mathrm{kb}$。\n- 增强子 $E$：位置 $x_E = 430 \\ \\mathrm{kb}$。\n- 环形成规则：位于位置 $x_i$ 的左锚点和位置 $x_j$ 的右锚点（其中 $x_i < x_j$）之间的稳定环，要求位点 $i$ 的方向为 $>$，位点 $j$ 的方向为 $<$。\n- 无环接触概率模型：$p_0(d) = A \\exp(-d/\\lambda)$，其中 $d$ 是基因组距离。\n- 有环接触概率模型：$p(d;n_b) = A \\exp(-d/\\lambda)\\, r^{n_b} = p_0(d) r^{n_b}$，其中 $n_b$ 是严格位于启动子和增强子之间的环边界数量。\n- 边界惩罚因子：$r = 0.2$。\n- 假设：一次最多形成一个主导环；环不能共享锚点。\n- 目标：计算绝缘强度 $I = \\dfrac{p_0(|x_E - x_P|)}{\\min p(|x_E - x_P|;n_b)}$。\n\n**步骤2：问题陈述验证**\n该问题在科学上基于染色质结构的环挤压模型，这是现代遗传学和生物物理学中的一个核心概念。CTCF作为绝缘子的作用、环形成的汇聚取向规则以及接触概率的距离依赖性衰减都是已确立的原则。所提供的数学模型是该领域使用的简化但有效的表示。该问题是适定的，提供了所有必要的数据和清晰、明确的规则。它是客观的，不含非科学性主张。因此，该问题被认为是有效的。\n\n**步骤3：求解推导**\n求解过程通过执行问题陈述中定义的任务来进行。\n\n**任务1：列举所有可能的环构型。**\n我们考虑所有满足 $x_i < x_j$ 的CTCF位点对 $(S_i, S_j)$，并根据汇聚取向规则（左锚点 $>$，右锚点 $<$）进行检验。\n这些位点是：$S_1(100, >)$、$S_2(260, <)$ 和 $S_3(480, <)$。\n\n- **对 $(S_1, S_2)$：** 左锚点是位于 $x_1=100 \\ \\mathrm{kb}$ 的 $S_1$，方向为 $>$。右锚点是位于 $x_2=260 \\ \\mathrm{kb}$ 的 $S_2$，方向为 $<$。该构型是汇聚的。环 $L_{12}$ 是可能的。\n- **对 $(S_1, S_3)$：** 左锚点是位于 $x_1=100 \\ \\mathrm{kb}$ 的 $S_1$，方向为 $>$。右锚点是位于 $x_3=480 \\ \\mathrm{kb}$ 的 $S_3$，方向为 $<$。该构型是汇聚的。环 $L_{13}$ 是可能的。\n- **对 $(S_2, S_3)$：** 左锚点是位于 $x_2=260 \\ \\mathrm{kb}$ 的 $S_2$，方向为 $<$。这违反了左锚点方向必须为 $>$ 的要求。该环是不可能的。\n\n包括基态（无环），共有三种可能的构型：\n1.  $C_0$：无环。\n2.  $C_{12}$：在 $S_1$ 和 $S_2$ 之间形成一个单环。\n3.  $C_{13}$：在 $S_1$ 和 $S_3$ 之间形成一个单环。\n\n**任务2：确定 $n_b$ 和相对接触概率。**\n位于 $x_P = 180 \\ \\mathrm{kb}$ 的启动子 $P$ 和位于 $x_E = 430 \\ \\mathrm{kb}$ 的增强子 $E$ 之间的接触概率，受严格位于区间 $(x_P, x_E) = (180, 430)$ 内的环边界数量 $n_b$ 的调节。它们之间的基因组距离为 $d = |x_E - x_P| = |430 - 180| = 250 \\ \\mathrm{kb}$。接触概率为 $p(d; n_b) = p_0(d) r^{n_b}$。相对接触概率为 $p/p_0 = r^{n_b}$。\n\n- **构型 $C_0$（无环）：**\n  没有环边界。因此，$n_b = 0$。\n  相对接触概率为 $r^0 = 1$。\n\n- **构型 $C_{12}$（环 $L_{12}$）：**\n  环边界位于 $x_1 = 100 \\ \\mathrm{kb}$ 和 $x_2 = 260 \\ \\mathrm{kb}$。\n  我们检查这些位置中有哪些落在区间 $(180, 430)$ 内。\n  - $x_1 = 100$：$100 \\notin (180, 430)$。\n  - $x_2 = 260$：$260 \\in (180, 430)$。\n  一个边界位于启动子和增强子之间。因此，$n_b = 1$。\n  相对接触概率为 $r^1 = 0.2$。\n\n- **构型 $C_{13}$（环 $L_{13}$）：**\n  环边界位于 $x_1 = 100 \\ \\mathrm{kb}$ 和 $x_3 = 480 \\ \\mathrm{kb}$。\n  我们检查这些位置中有哪些落在区间 $(180, 430)$ 内。\n  - $x_1 = 100$：$100 \\notin (180, 430)$。\n  - $x_3 = 480$：$480 \\notin (180, 430)$。\n  没有边界位于启动子和增强子之间。因此，$n_b = 0$。\n  相对接触概率为 $r^0 = 1$。\n\n**任务3：确定最佳绝缘构型。**\n当增强子-启动子接触概率最小时，绝缘效果最大。我们比较三种构型的概率：\n- $p(C_0) = p_0(d) \\cdot 1$\n- $p(C_{12}) = p_0(d) \\cdot 0.2$\n- $p(C_{13}) = p_0(d) \\cdot 1$\n最小概率是 $p(C_{12})$。因此，能最佳地将启动子与增强子绝缘的构型是在位点 $S_1$ 和 $S_2$ 之间形成的环 $C_{12}$。最小接触概率为 $\\min p(d;n_b) = p_0(d) \\cdot r^1$。\n\n**任务4：计算绝缘强度 $I$。**\n绝缘强度定义为基线接触概率（无环）与最小可能接触概率（最具绝缘性的环构型）之比。\n$$I = \\frac{p_0(|x_E - x_P|)}{\\min p(|x_E - x_P|; n_b)}$$\n使用前面步骤的结果：\n$$p_0(|x_E - x_P|) = p_0(d)$$\n$$\\min p(|x_E - x_P|; n_b) = p(C_{12}) = p_0(d) \\cdot r^1$$\n将这些代入 $I$ 的表达式中：\n$$I = \\frac{p_0(d)}{p_0(d) \\cdot r^1} = \\frac{1}{r}$$\n给定 $r = 0.2$，绝缘强度为：\n$$I = \\frac{1}{0.2} = 5$$\n问题要求答案四舍五入到四位有效数字。因此，$I = 5.000$。", "answer": "$$\\boxed{5.000}$$", "id": "2802128"}, {"introduction": "基因组学的一个核心挑战是破译嵌入在增强子中的“调控密码”。本练习将让您扮演计算生物学家的角色，分析来自大规模并行报告基因检测（MPRA）的合成增强子数据。您将使用统计模型比较，特别是似然比检验，来形式化地检验一个假说：增强子活性是由转录因子基序的数量驱动，还是由它们的特定排列方式驱动。本练习为如何从大规模功能数据中解析基因调控逻辑的定量方法提供了一个具体的入门。[@problem_id:2802129]", "problem": "您将执行一项概念建模任务，该任务基于顺式调控元件在转录调控中的作用。增强子是顺式调控序列，通常通过转录因子与序列基序的结合来增强核心启动子的转录。分子生物学的中心法则指出，DNA转录为RNA，RNA翻译为蛋白质。广泛的观察支持转录因子的结合偏好可以用序列基序来表示。对于一组通过大规模并行报告基因检测（MPRA）分析的合成增强子构建体，待检验的假设是：增强子活性主要由基序内容（基序类型的计数）决定，而非基序排布（基序的顺序、间距或邻近关系）。您的任务是形式化并实现一个嵌套线性高斯模型比较，以在一小组预定义的测试数据集上对该假设进行评判。这些数据集将生物学问题抽象为特征矩阵。\n\n为每个数据集构建以下模型：\n\n- 简化模型：活性仅是基序内容的线性函数。设响应向量为 $y \\in \\mathbb{R}^{n}$，内容特征矩阵为 $C \\in \\mathbb{R}^{n \\times p_c}$。简化设计矩阵为 $X_r = [\\mathbf{1}, C] \\in \\mathbb{R}^{n \\times (p_c+1)}$，其中 $\\mathbf{1}$ 是代表截距的全1列向量。假设 $y \\mid X_r$ 服从正态分布，其均值为 $X_r \\beta_r$，方差为 $\\sigma_r^2 I$，其中 $I$ 是单位矩阵。\n\n- 完整模型：活性是基序内容和排布的线性函数。设排布特征矩阵为 $R \\in \\mathbb{R}^{n \\times p_a}$。完整设计矩阵为 $X_f = [\\mathbf{1}, C, R] \\in \\mathbb{R}^{n \\times (p_c+p_a+1)}$。假设 $y \\mid X_f$ 服从正态分布，其均值为 $X_f \\beta_f$，方差为 $\\sigma_f^2 I$。\n\n对于每个数据集，计算两种模型下的最大似然估计、最大化对数似然 $\\ell_r$ 和 $\\ell_f$，并执行似然比检验，比较这两个模型，其统计量为\n$$\n\\Lambda = 2 \\left( \\ell_f - \\ell_r \\right),\n$$\n该统计量在排布无影响的原假设下，近似服从卡方分布，其自由度等于均值参数数量之差，即 $d = \\left(X_f \\text{的列数}\\right) - \\left(X_r \\text{的列数}\\right) = p_a$。使用显著性水平 $\\alpha = 0.05$（以小数表示）。对于每个数据集，如果数据未提供显著证据表明排布能提高预测能力（即 $p$ 值大于或等于 $0.05$），则返回布尔值 $\\text{True}$，否则返回 $\\text{False}$。\n\n除了似然比检验，还需计算两种模型的赤池信息准则（AIC）：\n$$\n\\mathrm{AIC} = 2k - 2 \\ell,\n$$\n其中 $k$ 是均值中的估计参数数量加上方差参数，即 $k = X \\text{的列数} + 1$。虽然您必须计算此量，但布尔值的输出决策完全基于在 $\\alpha = 0.05$ 水平下的似然比检验。\n\n使用以下四个数据集作为测试套件。每个数据集提供内容矩阵 $C$、排布矩阵 $R$ 以及活性值 $y$ 的规范，其中 $y$ 被构建为特征的线性组合加上一个小的加性偏差向量 $\\varepsilon$ 以避免精确拟合。所有数字都是精确的，应按给定值使用。\n\n数据集1、2、3的通用内容特征矩阵：\n- $n = 8$，$p_c = 2$，$C$ 的各行如下：\n  - 第1行：$(0, 0)$\n  - 第2行：$(1, 0)$\n  - 第3行：$(0, 1)$\n  - 第4行：$(1, 1)$\n  - 第5行：$(2, 0)$\n  - 第6行：$(0, 2)$\n  - 第7行：$(2, 1)$\n  - 第8行：$(1, 2)$\n\n数据集1、2、3的通用排布特征矩阵：\n- $p_a = 2$，$R$ 的各行如下：\n  - 第1行：$(0, 0)$\n  - 第2行：$(1, 0)$\n  - 第3行：$(0, 1)$\n  - 第4行：$(1, 1)$\n  - 第5行：$(0, 1)$\n  - 第6行：$(1, 0)$\n  - 第7行：$(1, 1)$\n  - 第8行：$(0, 0)$\n\n数据集1（内容驱动，排布效应可忽略）：\n- 参数：$\\beta_0 = 1.0$，内容权重 $b = (0.7, 0.4)$，偏差向量 $\\varepsilon = (0.02, -0.01, 0.00, 0.03, -0.02, 0.01, -0.01, 0.00)$。\n- 活性：对于内容特征为 $(c_{i1}, c_{i2})$ 的第 $i$ 行，设 $y_i = \\beta_0 + 0.7 \\cdot c_{i1} + 0.4 \\cdot c_{i2} + \\varepsilon_i$。\n\n数据集2（存在排布驱动的信号）：\n- 参数：$\\beta_0 = 0.5$，内容权重 $b = (0.6, 0.5)$，排布权重 $g = (0.9, -0.7)$，偏差向量 $\\varepsilon = (0.01, -0.02, 0.01, -0.01, 0.00, 0.00, -0.02, 0.01)$。\n- 活性：对于内容为 $(c_{i1}, c_{i2})$ 且排布为 $(r_{i1}, r_{i2})$ 的第 $i$ 行，设 $y_i = \\beta_0 + 0.6 \\cdot c_{i1} + 0.5 \\cdot c_{i2} + 0.9 \\cdot r_{i1} - 0.7 \\cdot r_{i2} + \\varepsilon_i$。\n\n数据集3（相对于偏差，排布效应较弱）：\n- 参数：$\\beta_0 = 0.7$，内容权重 $b = (0.5, 0.6)$，排布权重 $g = (0.1, -0.1)$，偏差向量 $\\varepsilon = (0.10, -0.05, 0.08, -0.12, 0.04, -0.02, 0.06, -0.09)$。\n- 活性：$y_i = \\beta_0 + 0.5 \\cdot c_{i1} + 0.6 \\cdot c_{i2} + 0.1 \\cdot r_{i1} - 0.1 \\cdot r_{i2} + \\varepsilon_i$。\n\n数据集4（无排布变异）：\n- $n = 8$，$p_c = 2$，$p_a = 2$。\n- 内容矩阵 $C$ 的行与数据集1-3相同。\n- 排布矩阵 $R$ 的所有条目均为 $0$，即其8行均为 $(0, 0)$。\n- 参数：$\\beta_0 = 1.2$，内容权重 $b = (0.4, 0.3)$，偏差向量 $\\varepsilon = (0.00, 0.01, -0.01, 0.02, -0.02, 0.01, 0.00, -0.01)$。\n- 活性：$y_i = \\beta_0 + 0.4 \\cdot c_{i1} + 0.3 \\cdot c_{i2} + \\varepsilon_i$。\n\n算法要求：\n\n- 对于每个数据集，构建 $X_r = [\\mathbf{1}, C]$ 和 $X_f = [\\mathbf{1}, C, R]$。\n- 通过 Moore–Penrose 伪逆或等效的数值稳定方法，使用普通最小二乘法估计系数。\n- 计算残差平方和 $\\mathrm{RSS} = \\| y - X \\hat{\\beta} \\|_2^2$ 以及在高斯模型下的最大化对数似然，其中最大似然方差为 $\\hat{\\sigma}^2 = \\mathrm{RSS}/n$：\n  $$\n  \\ell = -\\frac{n}{2} \\left( \\ln(2 \\pi \\hat{\\sigma}^2) + 1 \\right).\n  $$\n- 计算似然比统计量 $\\Lambda = 2 (\\ell_f - \\ell_r)$、自由度 $d = p_a$ 以及根据自由度为 $d$ 的卡方分布计算出的 $p$ 值。\n- 计算 $\\mathrm{AIC}_r$ 和 $\\mathrm{AIC}_f$，其中 $k_r = p_c + 2$ 且 $k_f = p_c + p_a + 2$。\n- 如果 $p$ 值大于或等于 $\\alpha = 0.05$，则判定对“增强子活性主要由基序内容决定”这一假设的支持为布尔值 $\\text{True}$，否则为 $\\text{False}$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含按顺序排列的与数据集1-4对应的四个布尔结果，格式为方括号内以逗号分隔的列表，例如 $[\\text{True},\\text{False},\\text{True},\\text{True}]$。", "solution": "问题陈述已经过评估，被认为是有效的。以下是分步验证过程。\n\n**第1步：提取给定信息**\n- **模型**：\n    - 简化模型（仅内容）：$y \\mid X_r \\sim \\mathcal{N}(X_r \\beta_r, \\sigma_r^2 I)$，其中 $X_r = [\\mathbf{1}, C]$。\n    - 完整模型（内容与排布）：$y \\mid X_f \\sim \\mathcal{N}(X_f \\beta_f, \\sigma_f^2 I)$，其中 $X_f = [\\mathbf{1}, C, R]$。\n- **统计检验**：\n    - 似然比检验（LRT）：统计量 $\\Lambda = 2 (\\ell_f - \\ell_r)$，其中 $\\ell$ 是最大化对数似然。在原假设下，$\\Lambda \\sim \\chi^2_d$，自由度为 $d = p_a$。显著性水平 $\\alpha = 0.05$。\n    - 赤池信息准则（AIC）：$\\mathrm{AIC} = 2k - 2\\ell$，其中 $k = (X \\text{的列数}) + 1$。\n- **估计**：\n    - 系数 $\\hat{\\beta}$ 通过普通最小二乘法（OLS）使用 Moore-Penrose 伪逆进行估计。\n    - 最大化对数似然：$\\ell = -\\frac{n}{2} (\\ln(2 \\pi \\hat{\\sigma}^2) + 1)$，其中 $\\hat{\\sigma}^2 = \\mathrm{RSS}/n$ 且 $\\mathrm{RSS} = \\| y - X \\hat{\\beta} \\|_2^2$。\n- **决策规则**：如果来自 LRT 的 $p$ 值 $\\ge 0.05$，则支持基序内容主要决定活性的假设。这对应于布尔值 `True`。否则，结果为 `False`。\n- **数据集**：提供了四个数据集，每个数据集由一个内容矩阵 $C \\in \\mathbb{R}^{n \\times p_c}$、一个排布矩阵 $R \\in \\mathbb{R}^{n \\times p_a}$ 和一个响应向量 $y \\in \\mathbb{R}^n$ 定义，该响应向量由指定参数和一个偏差向量 $\\varepsilon$ 生成。\n    - 数据集1、2、3的通用信息：$n=8, p_c=2$。$C$ 和 $R$ 矩阵已明确定义。\n    - 数据集1：$y$ 仅是内容特征加噪声的函数。\n    - 数据集2：$y$ 是内容和排布特征加噪声的函数。\n    - 数据集3：$y$ 是内容和弱排布特征加噪声的函数。\n    - 数据集4：$n=8, p_c=2, p_a=2$。$C$ 与其他数据集相同，但 $R$ 是全零矩阵。$y$ 仅是内容特征加噪声的函数。\n\n**第2步：使用提取的给定信息进行验证**\n- **科学依据**：该问题是统计模型比较（嵌套线性模型）的标准练习，是定量生物学和生物信息学中的一个基本工具。其生物学前提——检验基序内容与排布对增强子活性的影响——是一个合理且常见的研究问题。所规定的方法（OLS、MLE、LRT、AIC）都是标准方法。\n- **问题定义明确**：该问题在数学上是明确定义的。它为每个测试用例提供了计算唯一解所需的所有数据和公式。使用 Moore-Penrose 伪逆的规范正确处理了数据集4中的秩亏设计矩阵，确保了参数的唯一最小范数解和唯一的预测向量，从而使后续计算明确定义。\n- **客观性**：问题以精确、定量的术语陈述，没有主观或模糊的语言。决策标准是将计算出的 $p$ 值与固定的显著性水平 $\\alpha$ 进行客观比较。\n- **完整性和一致性**：所有必需的矩阵、参数和公式都已指定。没有矛盾之处。\n- **无其他缺陷**：问题并非无足轻重，因为它需要正确实现多个统计概念。它不超出科学可验证性的范围。\n\n**结论与行动**\n问题有效。我们继续进行求解。\n\n**方法论**\n\n任务是为每个数据集确定，与更复杂的“完整”模型（$M_f$）相比，一个更简单的“简化”模型（$M_r$）在统计上是否足以解释数据。简化模型假定增强子活性 $y$ 仅依赖于基序内容 $C$，而完整模型允许其额外依赖于基序排布 $R$。\n\n这些模型是嵌套的，因为 $M_r$ 是 $M_f$ 的一个特例，其中与排布特征 $R$ 相关的系数均为零。这允许使用似然比检验（LRT）进行正式比较。\n\n对于每个数据集，我们执行以下步骤：\n\n1.  **构建设计矩阵**：对于给定的内容矩阵 $C \\in \\mathbb{R}^{n \\times p_c}$ 和排布矩阵 $R \\in \\mathbb{R}^{n \\times p_a}$，我们为简化模型和完整模型构建设计矩阵。两个模型都包含一个截距项。\n    $$\n    X_r = [\\mathbf{1}, C] \\in \\mathbb{R}^{n \\times (p_c+1)}\n    $$\n    $$\n    X_f = [\\mathbf{1}, C, R] \\in \\mathbb{R}^{n \\times (p_c+p_a+1)}\n    $$\n\n2.  **通过 OLS 估计模型参数**：对于给定的响应向量 $y \\in \\mathbb{R}^n$，通过最小化残差平方和（RSS），$\\|y - X_k \\beta_k\\|_2^2$，来估计每个模型（$M_k$，其中 $k \\in \\{r, f\\}$）的系数向量 $\\beta$。解由以下公式给出：\n    $$\n    \\hat{\\beta}_k = X_k^\\dagger y\n    $$\n    其中 $X_k^\\dagger$ 是 $X_k$ 的 Moore-Penrose 伪逆。这种通用形式能正确处理满秩和秩亏矩阵。预测值则为 $\\hat{y}_k = X_k \\hat{\\beta}_k$。\n\n3.  **计算最大化对数似然**：在假设误差为高斯分布的情况下，方差的最大似然估计为 $\\hat{\\sigma}_k^2 = \\mathrm{RSS}_k / n$，其中 $\\mathrm{RSS}_k = \\|y - \\hat{y}_k\\|_2^2$。对数似然函数的最大化值为：\n    $$\n    \\ell_k = -\\frac{n}{2} \\left( \\ln(2 \\pi \\hat{\\sigma}_k^2) + 1 \\right)\n    $$\n    由于完整模型包含简化模型，它的拟合效果总是至少一样好，这意味着 $\\mathrm{RSS}_f \\le \\mathrm{RSS}_r$，因此 $\\ell_f \\ge \\ell_r$。\n\n4.  **执行似然比检验**：LRT 用于检验原假设 $H_0$：“与排布特征 $R$ 相关的系数全为零”。检验统计量为：\n    $$\n    \\Lambda = 2 (\\ell_f - \\ell_r)\n    $$\n    在 $H_0$ 下，该统计量服从卡方分布，其自由度 $d$ 等于完整模型中额外参数的数量。根据规定，$d = p_a$。\n\n5.  **决策**：我们计算 $p$ 值，即在原假设下观察到等于或比 $\\Lambda$ 更极端的检验统计量的概率：\n    $$\n    p = P(\\chi_d^2 \\ge \\Lambda)\n    $$\n    如果 $p \\ge \\alpha = 0.05$，我们不拒绝原假设。这意味着没有显著的统计证据支持包含排布特征。问题规定此结果对应于布尔值 `True`。如果 $p < 0.05$，我们拒绝 $H_0$ 并采纳完整模型，表明排布特征有显著贡献，这对应于布尔值 `False`。\n\n对于数据集4，排布矩阵 $R$ 完全由零组成。这使得 $X_f$ 中的附加列变得无关紧要（零向量），导致 $X_f$ 秩亏。$X_f$ 的列空间与 $X_r$ 的列空间相同。因此，两种模型的 OLS 投影相同，导致 $\\hat{y}_f = \\hat{y}_r$、$\\mathrm{RSS}_f = \\mathrm{RSS}_r$ 和 $\\ell_f = \\ell_r$。LRT 统计量 $\\Lambda$ 精确为0，得出的 $p$ 值为1，因此结果为 `True`。这个案例正确地表明，如果排布特征没有变异，它们就不可能增加任何解释能力。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Main function to define datasets, perform model comparison,\n    and print the results in the specified format.\n    \"\"\"\n\n    def analyze_dataset(C: np.ndarray, R: np.ndarray, y: np.ndarray, alpha: float = 0.05) -> bool:\n        \"\"\"\n        Performs a likelihood ratio test between a reduced model (using C)\n        and a full model (using C and R).\n\n        Args:\n            C: Content feature matrix.\n            R: Arrangement feature matrix.\n            y: Response vector (activity).\n            alpha: Significance level.\n\n        Returns:\n            True if the p-value is >= alpha, False otherwise.\n        \"\"\"\n        n, p_c = C.shape\n        p_a = R.shape[1]\n\n        # --- Reduced Model (Content only) ---\n        X_r = np.hstack([np.ones((n, 1)), C])\n        \n        # Estimate coefficients using Moore-Penrose pseudoinverse\n        beta_r_hat = np.linalg.pinv(X_r) @ y\n        y_r_hat = X_r @ beta_r_hat\n        \n        # Calculate Residual Sum of Squares (RSS)\n        RSS_r = np.sum((y - y_r_hat)**2)\n        \n        # Calculate MLE of variance and maximized log-likelihood\n        # Add a small epsilon to denominator to avoid division by zero if fit is perfect\n        sigma2_r_hat = RSS_r / n\n        if sigma2_r_hat < np.finfo(float).eps:\n            # For a perfect fit, log-likelihood is theoretically infinite.\n            # Using a very large negative number to avoid math errors.\n            log_lik_r = -np.inf\n        else:\n             log_lik_r = -n/2 * (np.log(2 * np.pi * sigma2_r_hat) + 1)\n\n        # --- Full Model (Content + Arrangement) ---\n        X_f = np.hstack([np.ones((n, 1)), C, R])\n        \n        beta_f_hat = np.linalg.pinv(X_f) @ y\n        y_f_hat = X_f @ beta_f_hat\n        \n        RSS_f = np.sum((y - y_f_hat)**2)\n        \n        sigma2_f_hat = RSS_f / n\n        if sigma2_f_hat < np.finfo(float).eps:\n            log_lik_f = -np.inf\n        else:\n            log_lik_f = -n/2 * (np.log(2 * np.pi * sigma2_f_hat) + 1)\n        \n        # As a property of nested models, RSS_f <= RSS_r, so log_lik_f >= log_lik_r.\n        # Handle potential floating point inaccuracies.\n        if log_lik_f < log_lik_r:\n            log_lik_f = log_lik_r\n\n        # --- Likelihood Ratio Test ---\n        Lambda = 2 * (log_lik_f - log_lik_r)\n        d = p_a  # Degrees of freedom from problem statement\n\n        # p-value is P(Chi-squared(d) >= Lambda)\n        p_value = chi2.sf(Lambda, d)\n\n        # --- Decision ---\n        # The hypothesis is \"enhancer activity is determined primarily by motif content\".\n        # This is the null hypothesis. We return True if we fail to reject it.\n        return p_value >= alpha\n\n    # --- Define Datasets ---\n\n    C_common = np.array([\n        [0, 0], [1, 0], [0, 1], [1, 1],\n        [2, 0], [0, 2], [2, 1], [1, 2]\n    ])\n\n    R_common = np.array([\n        [0, 0], [1, 0], [0, 1], [1, 1],\n        [0, 1], [1, 0], [1, 1], [0, 0]\n    ])\n\n    test_cases = []\n\n    # Dataset 1: Content-driven with negligible arrangement effect\n    eps1 = np.array([0.02, -0.01, 0.00, 0.03, -0.02, 0.01, -0.01, 0.00])\n    y1 = 1.0 + 0.7 * C_common[:, 0] + 0.4 * C_common[:, 1] + eps1\n    test_cases.append((C_common, R_common, y1))\n\n    # Dataset 2: Arrangement-driven signal present\n    eps2 = np.array([0.01, -0.02, 0.01, -0.01, 0.00, 0.00, -0.02, 0.01])\n    y2 = 0.5 + 0.6 * C_common[:, 0] + 0.5 * C_common[:, 1] + 0.9 * R_common[:, 0] - 0.7 * R_common[:, 1] + eps2\n    test_cases.append((C_common, R_common, y2))\n\n    # Dataset 3: Weak arrangement effects relative to deviations\n    eps3 = np.array([0.10, -0.05, 0.08, -0.12, 0.04, -0.02, 0.06, -0.09])\n    y3 = 0.7 + 0.5 * C_common[:, 0] + 0.6 * C_common[:, 1] + 0.1 * R_common[:, 0] - 0.1 * R_common[:, 1] + eps3\n    test_cases.append((C_common, R_common, y3))\n\n    # Dataset 4: No arrangement variation\n    R4 = np.zeros_like(C_common)\n    eps4 = np.array([0.00, 0.01, -0.01, 0.02, -0.02, 0.01, 0.00, -0.01])\n    y4 = 1.2 + 0.4 * C_common[:, 0] + 0.3 * C_common[:, 1] + eps4\n    test_cases.append((C_common, R4, y4))\n    \n    # --- Run analysis and collect results ---\n    results = [analyze_dataset(C, R, y) for C, R, y in test_cases]\n    \n    return f\"[{','.join(map(lambda x: str(x), results))}]\"\n\n# The final answer is the output of the function, not the code itself.\n# Based on execution, the output is [True,False,True,True]\n```", "answer": "[True,False,True,True]", "id": "2802129"}]}