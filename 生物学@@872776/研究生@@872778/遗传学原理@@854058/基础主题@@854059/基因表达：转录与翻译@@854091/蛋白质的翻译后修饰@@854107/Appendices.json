{"hands_on_practices": [{"introduction": "细胞信号转导的核心在于蛋白质翻译后修饰的动态平衡，其中磷酸化是最普遍的形式之一。本练习旨在通过构建一个简化的数学模型，探索由激酶和磷酸酶共同调控的单一磷酸化位点的动力学行为。通过运用米氏动力学和稳态假设，你将推导出磷酸化水平与酶活性参数之间的定量关系，从而掌握将生物过程转化为可预测模型的基本技能。[@problem_id:2839222]", "problem": "在活细胞中，一个具有单一磷酸化位点的转录因子库由一种激酶和一种磷酸酶调节。将未磷酸化的形式表示为 $S$，磷酸化的形式表示为 $S_{\\mathrm{p}}$。总浓度 $S_{\\mathrm{T}}$ 在所关注的时间尺度上是守恒的，因此 $S_{\\mathrm{T}} = [S] + [S_{\\mathrm{p}}]$。激酶将 $S$ 转化为 $S_{\\mathrm{p}}$，并遵循米氏动力学，其底物为 $S$，最大速度为 $V_{1}$，米氏常数为 $K_{1}$。磷酸酶将 $S_{\\mathrm{p}}$ 转化为 $S$，并遵循米氏动力学，其底物为 $S_{\\mathrm{p}}$，最大速度为 $V_{2}$，米氏常数为 $K_{2}$。假设在一个体系中，两种酶都远未被其各自的底物饱和，具体来说是 $[S] \\ll K_{1}$ 和 $[S_{\\mathrm{p}}] \\ll K_{2}$，并且在此时间尺度上转录因子的合成和降解可以忽略不计。\n\n仅从标准的米氏速率定律和质量守恒出发，计算稳态磷酸化分数 $f^{*} \\equiv \\dfrac{[S_{\\mathrm{p}}]}{S_{\\mathrm{T}}}$，以 $V_{1}$、$K_{1}$、$V_{2}$ 和 $K_{2}$ 表示的闭合形式表达式。将您的最终答案表示为简化的符号表达式。请勿对答案进行四舍五入。", "solution": "问题陈述经核实具有科学依据、问题明确且完整。它描述了细胞生物学中共价修饰循环的一个标准模型，具体来说是在一级动力学条件下运行的磷酸化-去磷酸化循环。其假设陈述清晰，在某些生物学体系中是物理上可信的。我们可以进行推导。\n\n该系统涉及一个存在于两种状态的转录因子：未磷酸化的 $S$ 和磷酸化的 $S_{\\mathrm{p}}$。总浓度 $S_{\\mathrm{T}}$ 是恒定的：\n$$S_{\\mathrm{T}} = [S] + [S_{\\mathrm{p}}]$$\n磷酸化形式浓度 $[S_{\\mathrm{p}}]$ 的变化率由激酶的形成速率与磷酸酶的去除速率之差决定。速率方程为：\n$$\\frac{d[S_{\\mathrm{p}}]}{dt} = v_{1} - v_{2}$$\n其中 $v_{1}$ 是激酶反应的速度，$v_{2}$ 是磷酸酶反应的速度。\n\n激酶反应 $S \\rightarrow S_{\\mathrm{p}}$ 遵循以 $S$ 为底物的米氏动力学：\n$$v_{1} = \\frac{V_{1} [S]}{K_{1} + [S]}$$\n磷酸酶反应 $S_{\\mathrm{p}} \\rightarrow S$ 遵循以 $S_{\\mathrm{p}}$ 为底物的米氏动力学：\n$$v_{2} = \\frac{V_{2} [S_{\\mathrm{p}}]}{K_{2} + [S_{\\mathrm{p}}]}$$\n问题陈述指出，两种酶都远未被其各自的底物饱和。这由严格不等式 $[S] \\ll K_{1}$ 和 $[S_{\\mathrm{p}}] \\ll K_{2}$ 表示。在这些条件下，米氏速率定律简化为关于底物浓度的一级动力学。\n\n对于激酶，由于 $[S] \\ll K_{1}$，分母 $K_{1} + [S]$ 可近似为 $K_{1}$。速率定律变为：\n$$v_{1} \\approx \\frac{V_{1} [S]}{K_{1}}$$\n对于磷酸酶，由于 $[S_{\\mathrm{p}}] \\ll K_{2}$，分母 $K_{2} + [S_{\\mathrm{p}}]$ 可近似为 $K_{2}$。速率定律变为：\n$$v_{2} \\approx \\frac{V_{2} [S_{\\mathrm{p}}]}{K_{2}}$$\n这些表达式描述了线性或一级动力学。比率 $\\frac{V_{1}}{K_{1}}$ 和 $\\frac{V_{2}}{K_{2}}$ 分别代表磷酸化和去磷酸化反应的表观一级速率常数。\n\n在稳态时，所有物种的浓度都是恒定的，这意味着 $[S_{\\mathrm{p}}]$ 的净变化率为零。让稳态浓度表示为 $[S]^{*}$ 和 $[S_{\\mathrm{p}}]^{*}$。稳态条件是：\n$$\\frac{d[S_{\\mathrm{p}}]}{dt} = 0 \\implies v_{1} = v_{2}$$\n将简化的速率定律代入稳态方程，得到：\n$$\\frac{V_{1} [S]^{*}}{K_{1}} = \\frac{V_{2} [S_{\\mathrm{p}}]^{*}}{K_{2}}$$\n我们有一个包含两个未知稳态浓度 $[S]^{*}$ 和 $[S_{\\mathrm{p}}]^{*}$ 的方程组：\n$1.$ $\\frac{V_{1} [S]^{*}}{K_{1}} = \\frac{V_{2} [S_{\\mathrm{p}}]^{*}}{K_{2}}$\n$2.$ $S_{\\mathrm{T}} = [S]^{*} + [S_{\\mathrm{p}}]^{*}$\n\n从守恒方程（2）中，我们将 $[S]^{*}$ 用 $[S_{\\mathrm{p}}]^{*}$ 和 $S_{\\mathrm{T}}$ 表示：\n$$[S]^{*} = S_{\\mathrm{T}} - [S_{\\mathrm{p}}]^{*}$$\n将这个 $[S]^{*}$ 的表达式代入稳态速率等式（1）中：\n$$\\frac{V_{1}}{K_{1}} (S_{\\mathrm{T}} - [S_{\\mathrm{p}}]^{*}) = \\frac{V_{2}}{K_{2}} [S_{\\mathrm{p}}]^{*}$$\n我们的目标是求解稳态磷酸化分数 $f^{*} \\equiv \\frac{[S_{\\mathrm{p}}]^{*}}{S_{\\mathrm{T}}}$。首先，我们求解关于 $[S_{\\mathrm{p}}]^{*}$ 的代数方程：\n$$\\frac{V_{1}}{K_{1}} S_{\\mathrm{T}} - \\frac{V_{1}}{K_{1}} [S_{\\mathrm{p}}]^{*} = \\frac{V_{2}}{K_{2}} [S_{\\mathrm{p}}]^{*}$$\n将含有 $[S_{\\mathrm{p}}]^{*}$ 的项归类：\n$$\\frac{V_{1}}{K_{1}} S_{\\mathrm{T}} = \\left(\\frac{V_{1}}{K_{1}} + \\frac{V_{2}}{K_{2}}\\right) [S_{\\mathrm{p}}]^{*}$$\n分离出 $[S_{\\mathrm{p}}]^{*}$：\n$$[S_{\\mathrm{p}}]^{*} = \\frac{\\frac{V_{1}}{K_{1}} S_{\\mathrm{T}}}{\\frac{V_{1}}{K_{1}} + \\frac{V_{2}}{K_{2}}}$$\n现在，我们通过将两边都除以 $S_{\\mathrm{T}}$ 来计算所需的分数 $f^{*}$：\n$$f^{*} = \\frac{[S_{\\mathrm{p}}]^{*}}{S_{\\mathrm{T}}} = \\frac{\\frac{V_{1}}{K_{1}}}{\\frac{V_{1}}{K_{1}} + \\frac{V_{2}}{K_{2}}}$$\n为了得到简化的最终形式，我们将分子和分母同乘以 $K_{1} K_{2}$：\n$$f^{*} = \\frac{\\frac{V_{1}}{K_{1}} (K_{1} K_{2})}{\\left(\\frac{V_{1}}{K_{1}} + \\frac{V_{2}}{K_{2}}\\right) (K_{1} K_{2})} = \\frac{V_{1} K_{2}}{V_{1} K_{2} + V_{2} K_{1}}$$\n这是以给定的动力学参数表示的稳态磷酸化分数的闭合形式表达式。", "answer": "$$\\boxed{\\frac{V_{1} K_{2}}{V_{1} K_{2} + V_{2} K_{1}}}$$", "id": "2839222"}, {"introduction": "理论模型需要通过实验数据来验证和完善，而定量质谱技术是精确测量蛋白质翻译后修饰水平的核心工具。本练习将带你设计一个基于SILAC（细胞培养中氨基酸稳定同位素标记）的定量蛋白质组学实验，以测量特定位点磷酸化水平的变化。你将从基本原理出发，推导如何从质谱数据中测得的同位素肽段比率，精确计算出磷酸化修饰的占有率，从而深刻理解现代蛋白质组学实验设计与数据分析的严谨逻辑。[@problem_id:2839183]", "problem": "计划进行一项激酶信号传导实验，使用细胞培养中氨基酸稳定同位素标记 (SILAC) 和质谱 (MS) 技术，来定量分析刺激前后的位点特异性磷酸化占据率。您将设计一种内参引入式SILAC策略，然后从第一性原理出发，推导如何根据测得的轻/重肽段比率，计算受刺激样本中的磷酸化占据率。\n\n设计一个有科学依据的SILAC-MS工作流程，该流程能够估算在基线条件下制备的重标参考样本中，受刺激样本内单个含胰蛋白酶切位点肽段的磷酸化占据率。您的设计必须确保磷酸化肽段与其未修饰对应物之间的电离效率差异不会对占据率估算产生偏差。您可以假设以下经过充分检验的事实：(i) 蛋白酶解会产生一个含位点的磷酸化肽段及相应的未修饰对应物，两者除了磷酸基团外，化学性质完全相同；(ii) 对于给定化学形式的肽段，其质谱信号与其摩尔量乘以一个恒定的响应因子成正比，该响应因子对于其轻、重同位素异构体是相同的；(iii) 在进行质谱分析前，立即将固定已知量的重标参考蛋白质组混入每个轻标实验样本中。\n\n从核心定义和守恒原理出发，不使用任何未经证明的简化公式，完成以下任务：\n\n- 定义样本中的磷酸化占据率为 $p = \\frac{P}{P + U}$，其中 $P$ 和 $U$ 分别是含该位点的磷酸化肽段和未修饰肽段的摩尔量。设重标参考（基线）样本的占据率为 $p_{r}$，含该位点的肽段总量为 $T_{r}$；轻标受刺激样本的占据率为 $p_{s}$，总量为 $T_{s}$。\n- 利用质谱信号的比例关系和SILAC内参引入法，将实验观测到的磷酸化肽段的轻/重比率 $R_{P}$ 和未修饰肽段的轻/重比率 $R_{U}$ 与潜在的摩尔量 $P_{s}, P_{r}, U_{s}, U_{r}$ 关联起来。\n- 通过消除无关的比例常数和任何未知的混合因子，从第一性原理推导出一个仅包含 $R_{P}$、$R_{U}$ 和 $p_{r}$ 的 $p_{s}$ 的闭式表达式。\n- 然后，根据给定的测量值 $R_{P} = 3.2$，$R_{U} = 0.80$ 和已知的基线占据率 $p_{r} = 0.25$，计算 $p_{s}$。将 $p_{s}$ 表示为单个精确分数或小数。如果选择小数，则无需四舍五入，因为存在精确的分数形式。", "solution": "本题是定量蛋白质组学领域中一个有效且表述清晰的问题。它具有科学依据和客观性，并为进行严谨的推导和求解提供了充足的信息。解答如下。\n\n**实验设计：**\n1.  培养两个细胞群体。代表基线状态的参考群体在含有重同位素标记的氨基酸（例如 $^{13}\\text{C}_6, ^{15}\\text{N}_2$-赖氨酸和 $^{13}\\text{C}_6, ^{15}\\text{N}_4$-精氨酸）的培养基中生长。这会产生一个蛋白质组，其中基本上所有蛋白质都是“重型”的。实验群体则在标准的“轻型”培养基中生长。\n2.  对“轻型”培养物施加刺激，而“重型”培养物不施加刺激。\n3.  刺激后，收集并裂解两种培养物中的细胞。将固定量的重标参考蛋白质组（“内参”）与轻标实验样本蛋白质组混合。\n4.  将合并的蛋白质混合物进行酶解（例如，用胰蛋白酶）以生成肽段。\n5.  所得的肽段混合物通过液相色谱-质谱联用 (LC-MS) 进行分析。质谱仪测量磷酸化肽段及其未磷酸化对应物的轻、重同位素形式的信号强度。\n\n**从第一性原理推导：**\n\n设刺激后（轻标）样本中磷酸化肽段的摩尔量为 $P_s$，参考（重标）样本中为 $P_r$。\n设刺激后（轻标）样本中未磷酸化（未修饰）肽段的摩尔量为 $U_s$，参考（重标）样本中为 $U_r$。\n\n磷酸化占据率 $p$ 定义为总肽段池中被磷酸化的部分：\n$$p = \\frac{P}{P + U}$$\n因此，对于受刺激样本和参考样本，我们有：\n$$p_s = \\frac{P_s}{P_s + U_s}$$\n$$p_r = \\frac{P_r}{P_r + U_r}$$\n\n每个样本中含该位点的肽段（磷酸化加未磷酸化）的总量用 $T$ 表示：\n$$T_s = P_s + U_s$$\n$$T_r = P_r + U_r$$\n\n根据这些定义，我们可以用总量和占据率来表示各个量：\n$P_s = p_s T_s$ 且 $U_s = (1 - p_s) T_s$\n$P_r = p_r T_r$ 且 $U_r = (1 - p_r) T_r$\n\n根据题目的假设 (ii)，给定肽段的质谱信号 $S$ 与其摩尔量乘以一个响应因子 $C$ 成正比。此响应因子取决于肽段的化学形式（即磷酸化与未磷酸化），但对于相同化学形式的轻、重同位素异构体是相同的。设 $C_P$ 为磷酸化肽段的响应因子，$C_U$ 为未磷酸化肽段的响应因子。一般而言，由于电离效率的差异，$C_P \\neq C_U$。\n\n四种肽段的测量信号为：\n-   轻标磷酸化肽段的信号：$S_{P,s} = C_P \\cdot P_s$\n-   重标磷酸化肽段的信号：$S_{P,r} = C_P \\cdot P_r$\n-   轻标未磷酸化肽段的信号：$S_{U,s} = C_U \\cdot U_s$\n-   重标未磷酸化肽段的信号：$S_{U,r} = C_U \\cdot U_r$\n\n实验测量磷酸化和未磷酸化肽段的轻/重信号比率，分别表示为 $R_P$ 和 $R_U$。\n磷酸化肽段的比率为：\n$$R_P = \\frac{S_{P,s}}{S_{P,r}} = \\frac{C_P \\cdot P_s}{C_P \\cdot P_r} = \\frac{P_s}{P_r}$$\n未磷酸化肽段的比率为：\n$$R_U = \\frac{S_{U,s}}{S_{U,r}} = \\frac{C_U \\cdot U_s}{C_U \\cdot U_r} = \\frac{U_s}{U_r}$$\n关键在于，响应因子 $C_P$ 和 $C_U$ 在这些比率中被消除了。这是SILAC方法的关键特性，它允许进行精确的定量，而不受肽段特异性电离效率的影响，从而满足了题目的核心要求。\n\n现在，我们将 $P_s, P_r, U_s, U_r$ 的表达式代入比率方程：\n$$R_P = \\frac{p_s T_s}{p_r T_r}$$\n$$R_U = \\frac{(1 - p_s) T_s}{(1 - p_r) T_r}$$\n\n这两个方程包含未知的肽段总量比率 $\\frac{T_s}{T_r}$。该项既包含了蛋白质表达水平的生物学变化，也包含了轻、重蛋白质组的实验混合比率。为了求得 $p_s$，我们必须消除这个无关项。我们可以重新整理这两个方程来求解 $\\frac{T_s}{T_r}$：\n从 $R_P$ 方程得到：\n$$\\frac{T_s}{T_r} = R_P \\frac{p_r}{p_s}$$\n从 $R_U$ 方程得到：\n$$\\frac{T_s}{T_r} = R_U \\frac{1 - p_r}{1 - p_s}$$\n\n通过令这两个关于 $\\frac{T_s}{T_r}$ 的表达式相等，我们消除了未知的总量：\n$$R_P \\frac{p_r}{p_s} = R_U \\frac{1 - p_r}{1 - p_s}$$\n现在，我们必须解这个方程求 $p_s$。\n$$R_P \\cdot p_r \\cdot (1 - p_s) = R_U \\cdot (1 - p_r) \\cdot p_s$$\n$$R_P p_r - R_P p_r p_s = R_U (1 - p_r) p_s$$\n$$R_P p_r = R_U (1 - p_r) p_s + R_P p_r p_s$$\n$$R_P p_r = p_s [R_U (1 - p_r) + R_P p_r]$$\n\n这得到了 $p_s$ 的最终闭式表达式：\n$$p_s = \\frac{R_P p_r}{R_U (1 - p_r) + R_P p_r}$$\n这个受刺激样本中磷酸化占据率 $p_s$ 的表达式仅取决于实验测量的比率 $R_P$ 和 $R_U$，以及已知的参考样本占据率 $p_r$。\n\n**计算：**\n题目提供了以下测量值和已知值：\n$R_P = 3.2$\n$R_U = 0.80$\n$p_r = 0.25$\n\n首先，计算 $1 - p_r$：\n$1 - p_r = 1 - 0.25 = 0.75$\n\n将这些值代入推导出的表达式：\n$$p_s = \\frac{(3.2) \\cdot (0.25)}{(0.80) \\cdot (0.75) + (3.2) \\cdot (0.25)}$$\n计算分子和分母中的各项：\n分子：$3.2 \\times 0.25 = 0.8$\n分母第一项：$0.80 \\times 0.75 = 0.6$\n分母第二项：$3.2 \\times 0.25 = 0.8$\n分母各项之和：$0.6 + 0.8 = 1.4$\n\n所以，表达式变为：\n$$p_s = \\frac{0.8}{1.4}$$\n将其表示为精确分数：\n$$p_s = \\frac{0.8}{1.4} = \\frac{8}{14} = \\frac{4}{7}$$\n受刺激样本中的磷酸化占据率精确地为 $\\frac{4}{7}$。", "answer": "$$\\boxed{\\frac{4}{7}}$$", "id": "2839183"}, {"introduction": "在真实的细胞环境中，不同的翻译后修饰并非孤立存在，它们之间常常相互作用，形成复杂的调控网络。本练习将引导你构建一个描述磷酸化和O-GlcNAc糖基化这两种修饰之间相互抑制（即“串扰”）的动力学模型。通过编写代码来求解常微分方程组并进行稳定性分析，你将亲身体验简单的分子间相互作用如何涌现出复杂的系统级行为，例如能够实现细胞记忆和“全或无”决策的双稳态开关。[@problem_id:2839216]", "problem": "您需要对蛋白质单个可修饰残基上O-连接的N-乙酰葡糖胺修饰（O-GlcNAcylation）与磷酸化之间的串扰建立一个非线性常微分方程（ODE）模型并进行分析。目标是从第一性原理出发，确定在指定参数下，模型的稳态行为是表现出互斥性（存在两个稳定稳态，其中一个稳态中一种修饰占主导，另一个稳态中另一种修饰占主导），还是共存性（存在一个单一稳定稳态，两种修饰均以可观水平存在）。\n\n从化学动力学和守恒的基本定律和核心定义开始：\n- 在准一级反应假设下，使用质量作用定律来描述酶催化的状态间相互转化，认识到由于交叉抑制，酶的作用可以被捕捉为有效速率，该速率可能取决于另一种修饰的占据率。\n- 在蛋白质互斥的位点占据状态（未修饰、磷酸化和O-GlcNAcylation修饰）中，保持总蛋白质守恒。令$u(t)$、$p(t)$和$g(t)$分别表示在时间$t$时，未修饰、磷酸化和O-GlcNAcylation修饰的蛋白质占总蛋白质的分数，且对于所有$t$，满足$u(t) + p(t) + g(t) = 1$。\n- 不允许单个残基上存在双重占据，因此不存在该残基上同时既有磷酸化又有O-GlcNAcylation修饰的状态。\n\n模型假设，将转化为方程：\n1. 由于O-GlcNAc对激酶作用的交叉抑制，O-GlcNAc的占据会降低从未修饰状态开始的有效磷酸化。这表示为对有效磷酸化速率的Hill型抑制。\n2. 由于磷酸化对O-GlcNAc转移酶作用的交叉抑制，磷酸化的占据会降低从未修饰状态开始的有效O-GlcNAcylation。这表示为对有效O-GlcNAcylation速率的Hill型抑制。\n3. 磷酸化的失去和O-GlcNAcylation的失去（去磷酸化和去糖基化）被建模为一级过程。\n4. 所有速率常数均为非负实数。\n\n设有效速率为\n- $k_{p,\\mathrm{eff}}(g) = \\dfrac{k_{p0}}{1 + a\\, g^n}$，\n- $k_{g,\\mathrm{eff}}(p) = \\dfrac{k_{g0}}{1 + b\\, p^m}$，\n其中基础参数$k_{p0} > 0$，$k_{g0} > 0$，去修饰速率$d_p > 0$，$d_g > 0$，抑制强度$a \\ge 0$，$b \\ge 0$，以及Hill指数$n \\ge 1$，$m \\ge 1$。则ODE为\n- $\\dfrac{dp}{dt} = k_{p,\\mathrm{eff}}(g)\\, u - d_p\\, p$，\n- $\\dfrac{dg}{dt} = k_{g,\\mathrm{eff}}(p)\\, u - d_g\\, g$，\n其中$u = 1 - p - g$。\n\n稳态是满足$\\dfrac{dp}{dt} = 0$和$\\dfrac{dg}{dt} = 0$的配对$(p^{\\ast}, g^{\\ast})$，同时满足$u^{\\ast} = 1 - p^{\\ast} - g^{\\ast} \\ge 0$，$p^{\\ast} \\ge 0$和$g^{\\ast} \\ge 0$。如果一个稳态处矢量场的雅可比矩阵的所有特征值的实部都严格为负，则该稳态是（线性）稳定的。\n\n分类目标：\n- 将“互斥性”定义为存在至少两个不同的线性稳定稳态，其中一个以$p^{\\ast} > g^{\\ast}$（存在不可忽略的边际）为主，另一个以$g^{\\ast} > p^{\\ast}$（存在不可忽略的边际）为主，这表明存在两个替代的吸引子，其中一种修饰在各自的吸引子中占主导地位。\n- 将“共存性”定义为不存在这种双稳态（例如，一个唯一的线性稳定稳态，其中$p^{\\ast}$和$g^{\\ast}$都为可观正值且相当，或者只有一个主导状态）。\n\n您的程序必须：\n1. 实现ODE稳态方程，并通过从多个初始猜测求解代数系统$\\dfrac{dp}{dt} = 0$，$\\dfrac{dg}{dt} = 0$来计算闭合单纯形$\\{(p,g): p \\ge 0, g \\ge 0, p + g \\le 1\\}$中的所有容许稳态，对数值容差内的解进行聚类，并舍弃单纯形之外的解。\n2. 对于每个稳态，计算雅可比矩阵并根据其特征值确定线性稳定性。\n3. 应用上述分类，为每个参数集返回一个整数结果：如果模型容许至少两个具有互补显性（一个p-显性状态，满足$p^{\\ast} - g^{\\ast} \\ge \\delta$；一个g-显性状态，满足$g^{\\ast} - p^{\\ast} \\ge \\delta$，其中$\\delta$为一个固定的小边际）的线性稳定稳态，则返回$1$，否则返回$0$。\n\n测试套件（每个案例为$(k_{p0}, k_{g0}, d_p, d_g, a, b, n, m)$）：\n- 案例A（基础共存，无交叉抑制）：(2.0, 2.0, 1.0, 1.0, 0.0, 0.0, 2, 2)。\n- 案例B（中度对称交叉抑制）：(6.0, 6.0, 1.0, 1.0, 3.0, 3.0, 2, 2)。\n- 案例C（具有更高协同性的强对称交叉抑制）：(20.0, 20.0, 1.0, 1.0, 100.0, 100.0, 3, 3)。\n\n不涉及角度单位。状态变量没有物理单位，因为它们是分数；所有速率参数都使用一致的任意逆时间单位，但无需报告。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个包含在方括号中的逗号分隔列表形式的结果。具体来说，输出`[r_A,r_B,r_C]`，其中如果相应案例的系统根据上述标准检测到“互斥性”，则每个$r_{\\cdot}$为整数$1$，否则为$0$。例如：`[0,0,1]`。", "solution": "问题陈述提出了一个关于蛋白质单个位点上两种翻译后修饰——O-GlcNAcylation和磷酸化——之间生化串扰的形式化模型。任务是分析该系统在不同参数范围下的稳态行为，以确定其是表现出互斥性（双稳态）还是共存性（单稳态）。\n\n### 步骤1：问题验证\n\n**提取的已知条件：**\n- **状态变量：** 蛋白质处于未修饰（$u$）、磷酸化（$p$）和O-GlcNAcylation修饰（$g$）状态的分数。\n- **守恒定律：** $u(t) + p(t) + g(t) = 1$。\n- **ODE系统：**\n  - $\\dfrac{dp}{dt} = k_{p,\\mathrm{eff}}(g)\\, u - d_p\\, p$，其中 $k_{p,\\mathrm{eff}}(g) = \\dfrac{k_{p0}}{1 + a\\, g^n}$。\n  - $\\dfrac{dg}{dt} = k_{g,\\mathrm{eff}}(p)\\, u - d_g\\, g$，其中 $k_{g,\\mathrm{eff}}(p) = \\dfrac{k_{g0}}{1 + b\\, p^m}$。\n- **参数：** $k_{p0}>0, k_{g0}>0, d_p>0, d_g>0, a \\ge 0, b \\ge 0, n \\ge 1, m \\ge 1$。\n- **稳态：** $\\dfrac{dp}{dt} = 0$ 且 $\\dfrac{dg}{dt} = 0$，其解 $(p^\\ast, g^\\ast)$ 被限制在单纯形 $\\{(p,g) | p \\ge 0, g \\ge 0, p+g \\le 1\\}$ 内。\n- **稳定性：** 如果一个稳态的雅可比矩阵的所有特征值的实部都严格为负，则该稳态是线性稳定的。\n- **分类：** 互斥性（返回$1$）定义为存在至少两个稳定稳态，一个p-显性（$p^\\ast - g^\\ast \\ge \\delta$），一个g-显性（$g^\\ast - p^\\ast \\ge \\delta$）。否则为共存性（返回$0$）。边际$\\delta$是一个未指定的小正常数。\n- **测试案例：**\n  - A: $(k_{p0}, k_{g0}, d_p, d_g, a, b, n, m) = (2.0, 2.0, 1.0, 1.0, 0.0, 0.0, 2, 2)$。\n  - B: $(k_{p0}, k_{g0}, d_p, d_g, a, b, n, m) = (6.0, 6.0, 1.0, 1.0, 3.0, 3.0, 2, 2)$。\n  - C: $(k_{p0}, k_{g0}, d_p, d_g, a, b, n, m) = (20.0, 20.0, 1.0, 1.0, 100.0, 100.0, 3, 3)$。\n\n**验证结论：**\n该问题具有科学依据、问题明确且客观。它使用了化学动力学和动力系统理论的标准原理，如质量作用定律、用于表示协同抑制的Hill函数以及线性稳定性分析。该模型是双稳态开关的常规表示，这是计算系统生物学中的常见模体。唯一的小歧义是显性边际$\\delta$的值，这需要在实现时做出合理假设。但这并不影响问题的有效性。我们将继续分析，假设一个固定的边际$\\delta = 0.1$，这对于归一化到$[0, 1]$范围内的状态变量来说是一个合理的选择。\n\n### 步骤2：形式化求解\n\n问题的核心是寻找并分类一个二维动力系统的稳定稳态。\n\n**1. 稳态方程**\n该系统由以下关于磷酸化（$p$）和O-GlcNAcylation修饰（$g$）蛋白质分数的常微分方程定义：\n$$ \\frac{dp}{dt} = \\frac{k_{p0}}{1 + a g^n}(1 - p - g) - d_p p = F(p, g) $$\n$$ \\frac{dg}{dt} = \\frac{k_{g0}}{1 + b p^m}(1 - p - g) - d_g g = G(p, g) $$\n稳态$(p^\\ast, g^\\ast)$是非线性代数方程组$F(p, g) = 0$和$G(p, g) = 0$的解。这些物理上有意义的解必须位于由$p^\\ast \\ge 0$，$g^\\ast \\ge 0$和$p^\\ast + g^\\ast \\le 1$定义的单纯形内。由于Hill型抑制项引入的非线性，该系统可能有多个解。\n\n为了找到所有解，需要采用数值方法。我们将使用一个鲁棒的数值求根算法（如`scipy.optimize.root`），并用覆盖状态空间的网格状起始点进行初始化。这降低了在存在多个解时仅找到一个解的风险。然后对找到的数值解进行筛选，只保留那些在物理单纯形内的解，并进行聚类以消除重复解。\n\n**2. 线性稳定性分析**\n每个稳态$(p^\\ast, g^\\ast)$的稳定性由系统在该点计算的雅可比矩阵$J$的特征值决定。雅可比矩阵由下式给出：\n$$ J(p, g) = \\begin{pmatrix} \\frac{\\partial F}{\\partial p} & \\frac{\\partial F}{\\partial g} \\\\ \\frac{\\partial G}{\\partial p} & \\frac{\\partial G}{\\partial g} \\end{pmatrix} $$\n偏导数计算如下：\n- $\\frac{\\partial F}{\\partial p} = -\\frac{k_{p0}}{1 + a g^n} - d_p$\n- $\\frac{\\partial F}{\\partial g} = -\\frac{k_{p0}}{1 + a g^n} - \\frac{k_{p0}(1-p-g) a n g^{n-1}}{(1 + a g^n)^2}$\n- $\\frac{\\partial G}{\\partial p} = -\\frac{k_{g0}}{1 + b p^m} - \\frac{k_{g0}(1-p-g) b m p^{m-1}}{(1 + b p^m)^2}$\n- $\\frac{\\partial G}{\\partial g} = -\\frac{k_{g0}}{1 + b p^m} - d_g$\n\n当且仅当矩阵$J(p^\\ast, g^\\ast)$的所有特征值$\\lambda$都满足$\\text{Re}(\\lambda) < 0$时，稳态$(p^\\ast, g^\\ast)$是线性稳定的。我们将为每个有效的稳态计算特征值，以确定稳定吸引子的集合。\n\n**3. 系统行为分类**\n最后一步是根据其稳定稳态对系统的行为进行分类。\n- 令$\\mathcal{S}$为唯一的、物理上有效且线性稳定的稳态的集合。\n- 对于每个稳定状态$(p^\\ast, g^\\ast) \\in \\mathcal{S}$，我们检查其显性。基于我们假设的边际$\\delta = 0.1$：\n  - 如果$p^\\ast - g^\\ast \\ge 0.1$，则该状态是p-显性的。\n  - 如果$g^\\ast - p^\\ast \\ge 0.1$，则该状态是g-显性的。\n- 如果$\\mathcal{S}$包含至少一个p-显性状态和至少一个g-显性状态，则系统表现出**互斥性**（输出$1$）。\n- 否则，系统表现出**共存性**或单稳态（输出$0$）。这种情况发生在只有一个稳定状态时，或者存在多个稳定状态但它们不满足互补显性准则时（例如，所有状态都是$p^\\ast \\approx g^\\ast$的共存状态，或者多个状态都是p-显性的）。\n\n这个完整的程序将对问题陈述中指定的三个测试案例中的每一个进行实现。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Analyzes a model of post-translational modification cross-talk for bistability.\n\n    The function iterates through a set of test cases, each defining the parameters\n    of a system of ODEs for phosphorylation (p) and O-GlcNAcylation (g). For each case,\n    it finds all steady states, determines their stability, and classifies the system's\n    behavior as 'coexistence' (0) or 'mutual exclusivity' (1).\n    \"\"\"\n\n    test_cases = [\n        # Case A: No cross-inhibition\n        (2.0, 2.0, 1.0, 1.0, 0.0, 0.0, 2, 2),\n        # Case B: Moderate symmetric cross-inhibition\n        (6.0, 6.0, 1.0, 1.0, 3.0, 3.0, 2, 2),\n        # Case C: Strong symmetric cross-inhibition\n        (20.0, 20.0, 1.0, 1.0, 100.0, 100.0, 3, 3),\n    ]\n\n    results = []\n    \n    # Margin for dominance classification\n    delta = 0.1\n    # Numerical tolerances\n    simplex_tol = 1e-6\n    cluster_tol_digits = 6\n\n    for params in test_cases:\n        k_p0, k_g0, d_p, d_g, a, b, n, m = params\n\n        def system_equations(x, params_tuple):\n            p, g = x\n            k_p0_loc, k_g0_loc, d_p_loc, d_g_loc, a_loc, b_loc, n_loc, m_loc = params_tuple\n            \n            # Check for invalid inputs to avoid warnings/errors\n            if p  0 or g  0 or p + g > 1:\n                return [1e6, 1e6] # Return large residual for points outside simplex\n\n            u = 1.0 - p - g\n            \n            dp_dt = (k_p0_loc / (1.0 + a_loc * g**n_loc)) * u - d_p_loc * p\n            dg_dt = (k_g0_loc / (1.0 + b_loc * p**m_loc)) * u - d_g_loc * g\n            \n            return [dp_dt, dg_dt]\n\n        def compute_jacobian(x, params_tuple):\n            p, g = x\n            k_p0_loc, k_g0_loc, d_p_loc, d_g_loc, a_loc, b_loc, n_loc, m_loc = params_tuple\n            u = 1.0 - p - g\n\n            # Partial derivatives\n            J11 = -k_p0_loc / (1.0 + a_loc * g**n_loc) - d_p_loc\n            \n            # Avoid division by zero if g=0 and n=1, g**(n-1) is well defined for n>=1\n            if n_loc == 1 and g == 0:\n                g_term_J12 = 1.0\n            else:\n                g_term_J12 = g**(n_loc - 1)\n            J12 = -k_p0_loc / (1.0 + a_loc * g**n_loc) - \\\n                  (k_p0_loc * u * a_loc * n_loc * g_term_J12) / (1.0 + a_loc * g**n_loc)**2\n            \n            if m_loc == 1 and p == 0:\n                p_term_J21 = 1.0\n            else:\n                p_term_J21 = p**(m_loc - 1)\n            J21 = -k_g0_loc / (1.0 + b_loc * p**m_loc) - \\\n                  (k_g0_loc * u * b_loc * m_loc * p_term_J21) / (1.0 + b_loc * p**m_loc)**2\n            \n            J22 = -k_g0_loc / (1.0 + b_loc * p**m_loc) - d_g_loc\n\n            return np.array([[J11, J12], [J21, J22]])\n\n        # Find steady states using a grid of initial guesses\n        found_roots = []\n        grid_points = np.linspace(0.0, 1.0, 11)\n        for p0 in grid_points:\n            for g0 in grid_points:\n                if p0 + g0 = 1.0:\n                    sol = root(system_equations, [p0, g0], args=(params,), method='hybr')\n                    if sol.success:\n                        found_roots.append(sol.x)\n        \n        # Filter and cluster the roots\n        valid_roots = []\n        for r in found_roots:\n            p, g = r\n            if p >= -simplex_tol and g >= -simplex_tol and (p + g) = 1.0 + simplex_tol:\n                # Clamp small negative values to 0\n                p_clamped = max(0, p)\n                g_clamped = max(0, g)\n                valid_roots.append([p_clamped, g_clamped])\n        \n        if not valid_roots:\n            stable_states = []\n        else:\n            # Cluster roots by rounding\n            rounded_roots = np.round(np.array(valid_roots), decimals=cluster_tol_digits)\n            unique_roots = np.unique(rounded_roots, axis=0)\n\n            stable_states = []\n            for r in unique_roots:\n                # Stability analysis\n                J = compute_jacobian(r, params)\n                eigenvalues = np.linalg.eigvals(J)\n                if np.all(np.real(eigenvalues)  0):\n                    stable_states.append(r)\n\n        # Classify the system\n        has_p_dominant = False\n        has_g_dominant = False\n        \n        if len(stable_states) >= 2:\n            for state in stable_states:\n                p_star, g_star = state\n                if p_star - g_star >= delta:\n                    has_p_dominant = True\n                if g_star - p_star >= delta:\n                    has_g_dominant = True\n        \n        if has_p_dominant and has_g_dominant:\n            results.append(1)\n        else:\n            results.append(0)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2839216"}]}