{"hands_on_practices": [{"introduction": "为了理解等位基因频率如何演化，我们首先需要将单个演化力独立出来进行研究。这个练习将模拟在一个理想化种群中可逆突变的效果 [@problem_id:2814732]。通过推导平衡频率，你将掌握突变如何作为一种确定性压力，将等位基因频率推向一个不依赖于其初始状态的稳定平衡点。", "problem": "考虑一个无限大的、随机交配的二倍体种群，其在单个双等位基因座上有等位基因 $A$ 和 $a$。该种群中没有自然选择、没有遗传漂变，也没有迁移。突变是可逆的，每一代都以每个等位基因每代的速率发生：$A \\to a$ 的速率为 $\\mu$，$a \\to A$ 的速率为 $\\nu$，其中 $\\mu \\ge 0$ 且 $\\nu \\ge 0$。令 $p_t$ 表示第 $t$ 代中等位基因 $A$ 的频率，其中 $p_t \\in [0,1]$。假设世代是离散且不重叠的。\n\n仅使用正向和反向突变的定义以及全概率定律，完成以下任务：\n\n1. 推导在仅有突变作用下，从 $p_t$ 得到 $p_{t+1}$ 的确定性映射。\n2. 求解该映射的所有平衡等位基因频率 $\\hat{p} \\in [0,1]$，将其表示为 $\\mu$ 和 $\\nu$ 的函数。\n3. 通过在平衡点附近对映射进行线性化，对每个平衡点的局部稳定性进行分类，并陈述关于 $(\\mu,\\nu)$ 的稳定性的明确条件。\n\n在你的最终答案中，仅报告内部平衡等位基因频率（如果存在）的闭式表达式。无需四舍五入。最终答案中不要包含任何单位。", "solution": "首先将对问题进行严格的验证过程。\n\n**第1步：提取已知条件**\n- 种群：无限大、随机交配、二倍体。\n- 基因座：单个双等位基因座，有等位基因 $A$ 和 $a$。\n- 进化力：无自然选择、无遗传漂变、无迁移。\n- 突变：可逆，离散不重叠的世代。\n- 从 $A$ 到 $a$ 的突变率：$\\mu$ 每个等位基因每代，其中 $\\mu \\ge 0$。\n- 从 $a$ 到 $A$ 的突变率：$\\nu$ 每个等位基因每代，其中 $\\nu \\ge 0$。\n- 等位基因频率：$p_t$ 是第 $t$ 代中等位基因 $A$ 的频率，$p_t \\in [0,1]$。\n- 任务1：推导确定性映射 $p_{t+1} = f(p_t)$。\n- 任务2：求解所有平衡等位基因频率 $\\hat{p} \\in [0,1]$。\n- 任务3：对每个平衡点的局部稳定性进行分类。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据。它提出了一个群体遗传学中的经典模型，用于研究理想化种群中突变对等位基因频率的影响。诸如无限大种群之类的假设，旨在将突变的确定性压力与遗传漂变的随机效应分离开来，这是引入该概念时标准且必要的简化。该问题是适定的，所有变量（$\\mu, \\nu, p_t$）和条件都明确定义，从而导出一个可解的系统。语言客观且正式。该问题不违反数学或遗传学的任何基本原理。它是一个基本概念的完整且一致的陈述。\n\n**结论：** 问题有效。将提供解答。\n\n解答按要求分为三个部分进行。\n\n**1. $p_t$ 的递推关系推导**\n\n令 $p_t$ 为第 $t$ 代中等位基因 $A$ 的频率。因此，第 $t$ 代中等位基因 $a$ 的频率为 $q_t = 1 - p_t$。我们希望求出下一代，即第 $t+1$ 代中等位基因 $A$ 的频率 $p_{t+1}$。该计算基于追踪第 $t+1$ 代等位基因从第 $t$ 代基因库中的来源。\n\n第 $t+1$ 代中的一个等位基因 $A$ 可能源于第 $t$ 代中的两个互斥事件：\ni) 第 $t$ 代中一个等位基因是 $A$，并且没有突变为 $a$。一个 $A$ 等位基因不发生突变的概率是 $(1 - \\mu)$。\nii) 第 $t$ 代中一个等位基因是 $a$，并且突变为 $A$。一个 $a$ 等位基因发生突变的概率是 $\\nu$。\n\n不发生突变的 $A$ 型等位基因的频率是其初始频率与不突变概率的乘积：$p_t (1 - \\mu)$。\n突变为 $A$ 的 $a$ 型等位基因的频率是其初始频率与突变概率的乘积：$(1 - p_t) \\nu$。\n\n根据全概率定律，第 $t+1$ 代中等位基因 $A$ 的总频率是来自这两个途径的频率之和：\n$$p_{t+1} = p_t (1 - \\mu) + (1 - p_t) \\nu$$\n这就是给出 $p_{t+1}$ 作为 $p_t$ 函数的确定性映射。可以将其重排为线性映射形式：\n$$p_{t+1} = p_t - \\mu p_t + \\nu - \\nu p_t$$\n$$p_{t+1} = p_t (1 - \\mu - \\nu) + \\nu$$\n\n**2. 平衡等位基因频率的计算**\n\n平衡是一种等位基因频率不随时间变化的状态。在平衡时，我们有 $p_{t+1} = p_t = \\hat{p}$。将 $\\hat{p}$ 代入递推关系中：\n$$\\hat{p} = \\hat{p}(1 - \\mu - \\nu) + \\nu$$\n我们求解这个关于 $\\hat{p}$ 的方程：\n$$\\hat{p} - \\hat{p}(1 - \\mu - \\nu) = \\nu$$\n$$\\hat{p} (1 - (1 - \\mu - \\nu)) = \\nu$$\n$$\\hat{p} (\\mu + \\nu) = \\nu$$\n\n我们现在必须考虑关于和 $\\mu + \\nu$ 的两种情况：\n情况 A：$\\mu + \\nu > 0$。\n在这种情况下，我们可以除以 $(\\mu + \\nu)$ 来找到一个唯一的平衡频率：\n$$\\hat{p} = \\frac{\\nu}{\\mu + \\nu}$$\n由于 $\\mu \\ge 0$ 且 $\\nu \\ge 0$，这个平衡频率 $\\hat{p}$ 保证在区间 $[0,1]$ 内。具体来说，如果 $\\mu > 0$ 且 $\\nu > 0$，那么 $0  \\hat{p}  1$，这是一个内部平衡或多态平衡。如果 $\\mu  0$ 且 $\\nu = 0$，那么 $\\hat{p} = 0$。如果 $\\mu = 0$ 且 $\\nu  0$，那么 $\\hat{p} = 1$。\n\n情况 B：$\\mu + \\nu = 0$。\n由于 $\\mu \\ge 0$ 且 $\\nu \\ge 0$，这意味着 $\\mu = 0$ 且 $\\nu = 0$。在这种情况下，没有突变发生。递推关系变为 $p_{t+1} = p_t(1 - 0 - 0) + 0$，简化为 $p_{t+1} = p_t$。\n平衡方程变为 $\\hat{p}(\\mu+\\nu) = \\nu \\implies \\hat{p}(0) = 0$，这对任何 $\\hat{p}$ 的值都成立。因此，当没有突变时，任何等位基因频率 $p \\in [0,1]$ 都是一个平衡点。\n\n总之，对于 $\\mu+\\nu0$，存在一个单一平衡点 $\\hat{p} = \\frac{\\nu}{\\mu+\\nu}$。对于 $\\mu=\\nu=0$，所有 $p \\in [0,1]$ 都是平衡点。\n\n**3. 平衡点的稳定性分析**\n\n对于一维离散映射 $p_{t+1} = f(p_t)$，其不动点 $\\hat{p}$ 的局部稳定性由映射函数 $f'(p)$ 在该不动点处的导数的绝对值决定。如果 $|f'(\\hat{p})|  1$，则平衡点是局部稳定的；如果 $|f'(\\hat{p})| = 1$，则是中性稳定的；如果 $|f'(\\hat{p})| > 1$，则是不稳定的。\n\n该映射为 $f(p_t) = p_t(1 - \\mu - \\nu) + \\nu$。这是一个关于 $p_t$ 的线性函数。其导数对所有 $p_t$ 都是常数：\n$$f'(p_t) = \\frac{d}{dp_t} \\left[ p_t(1 - \\mu - \\nu) + \\nu \\right] = 1 - \\mu - \\nu$$\n因此，稳定性条件与平衡点 $\\hat{p}$ 无关，仅为：\n$$|1 - \\mu - \\nu|  1$$\n这个不等式等价于 $-1  1 - \\mu - \\nu  1$。\n\n我们分析不等式的两个部分：\n1) $1 - \\mu - \\nu  1 \\implies -(\\mu + \\nu)  0 \\implies \\mu + \\nu > 0$。\n2) $-1  1 - \\mu - \\nu \\implies \\mu + \\nu  2$。\n\n因此，当且仅当 $0  \\mu + \\nu  2$ 时，平衡点是局部稳定的。\n\n参数 $\\mu$ 和 $\\nu$ 代表突变概率，因此它们必须位于区间 $[0,1]$ 内。这意味着和 $\\mu + \\nu$ 总是位于区间 $[0,2]$ 内。\n\n让我们根据 $\\mu$ 和 $\\nu$ 的值来对稳定性进行分类：\n- 如果 $0  \\mu + \\nu  2$：条件 $|1 - \\mu - \\nu|  1$ 成立。唯一的平衡点 $\\hat{p} = \\frac{\\nu}{\\mu + \\nu}$ 是局部稳定的。因为该映射是线性的，所以这种稳定性是全局的；任何初始频率 $p_0 \\in [0,1]$ 都将收敛到这个平衡点。这涵盖了单个正突变率（例如 $\\mu0, \\nu=0$）和两个正突变率（例如 $\\mu0, \\nu0$）的情况。\n- 如果 $\\mu + \\nu = 0$：这意味着 $\\mu = 0$ 且 $\\nu = 0$。导数为 $1 - 0 = 1$。由于 $|f'(\\hat{p})| = 1$，集合 $[0,1]$ 中的所有平衡点都是中性稳定的。这是符合预期的，因为没有任何力量来改变等位基因频率。\n- 如果 $\\mu + \\nu = 2$：这仅在 $\\mu=1$ 且 $\\nu=1$ 时发生。导数为 $1 - 2 = -1$。由于 $|f'(\\hat{p})| = 1$，平衡点 $\\hat{p} = \\frac{1}{1+1} = \\frac{1}{2}$ 是中性稳定的。映射变为 $p_{t+1} = 1 - p_t$。任何不等于 $\\frac{1}{2}$ 的初始状态 $p_0$ 都会导致在 $p_0$ 和 $1-p_0$ 之间持续振荡（一个2-周期），而不会收敛到平衡点。\n\n问题要求报告内部平衡等位基因频率。内部平衡是指 $\\hat{p} \\in (0,1)$ 的平衡点。根据我们的分析，当 $\\mu  0$ 且 $\\nu  0$ 时会发生这种情况。在这些条件下，平衡点是 $\\hat{p} = \\frac{\\nu}{\\mu+\\nu}$，并且只要 $\\mu+\\nu  2$，它就是稳定的。", "answer": "$$\n\\boxed{\\frac{\\nu}{\\mu + \\nu}}\n$$", "id": "2814732"}, {"introduction": "与无限种群中突变的确定性压力不同，真实种群是有限的，这引入了一种被称为遗传漂变的随机因素。本练习使用连续时间 Moran 模型，这是研究遗传学中随机过程的一个基本工具 [@problem_id:2814741]。你将推导出等位基因频率变化的方差率，从而量化遗传漂变的强度，并理解其作为演化改变的关键随机引擎的角色。", "problem": "在一个大小恒为 $N$ 的随机交配的单倍体种群中，存在两个等位基因 $A$ 和 $a$，考虑连续时间下的中性Moran模型。在时间 $t$ 的种群状态由等位基因 $A$ 的数量 $i(t)\\in\\{0,1,\\dots,N\\}$ 描述，等位基因频率为 $p(t)=i(t)/N$。单出生-单死亡机制的运作方式如下：在每次事件中，恰好有一个个体繁殖，一个个体死亡，从而使得总种群大小始终保持为 $N$。在中性条件下，所有个体都是可交换的，并且在作为亲代或被替换个体时，以相等的概率被选中。假设事件时间构成一个独立于种群构成的泊松过程，并设定时间尺度，使得在长度为1的时间区间内，出生-死亡事件的期望数量为 $N/2$。\n\n从上述定义性质出发，且不使用任何现成的扩散极限公式，完成以下任务：\n\n- 在中性条件下，描述无穷小时间区间 $(t,t+\\Delta t]$ 内等位基因数量 $i(t)$ 的转移结构，并求出当 $\\Delta t\\to 0$ 时，转移 $i\\to i+1$、$i\\to i-1$ 和 $i\\to i$ 的主阶概率。\n- 利用这些转移，并使用 $p(t)=i(t)/N$，推导单位时间内等位基因频率变化的无穷小方差，其定义为\n$$\n\\lim_{\\Delta t\\to 0}\\frac{\\operatorname{Var}\\!\\big(p(t+\\Delta t)-p(t)\\mid p(t)=p\\big)}{\\Delta t}.\n$$\n\n最终答案需用 $p$ 和 $N$ 以闭合形式表示。不要进行近似或四舍五入；提供一个不带单位的精确表达式。", "solution": "问题要求推导连续时间中性Moran模型中等位基因频率变化的无穷小方差。问题陈述具有科学依据、提法恰当且自洽。它描述了种群遗传学中的一个标准模型，并使用了特定的时间尺度。我将开始进行推导。\n\n设时间 $t$ 的种群状态由携带等位基因 $A$ 的个体数量 $i(t)$ 描述。总种群大小恒为 $N$。等位基因 $A$ 的频率为 $p(t) = i(t)/N$。我们已知系统根据单出生-单死亡机制演化，其中事件时间遵循泊松过程，其速率 $\\lambda$ 使得单位时间内的期望事件数为 $N/2$。因此，泊松过程的速率为 $\\lambda = N/2$。在长度为 $\\Delta t$ 的无穷小时间区间内，发生单个出生-死亡事件的概率为 $\\lambda \\Delta t + o(\\Delta t) = \\frac{N}{2} \\Delta t + o(\\Delta t)$，而发生多于一个事件的概率为 $o(\\Delta t)$。\n\n首先，我们确定等位基因数量 $i$ 的转移概率。状态 $i$ 可以变为 $i+1$、$i-1$ 或保持不变。$i$ 的变化仅在发生出生-死亡事件时才会发生。在中性条件下，任何一个个体都可能以概率 $1/N$ 被选作繁殖，任何一个个体也可能以概率 $1/N$ 被选择替换（死亡）。这些选择是相互独立的。\n\n携带等位基因 $A$ 的个体数量为 $i$，携带等位基因 $a$ 的个体数量为 $N-i$。\n\n1.  **转移 $i \\to i+1$**：这要求一个携带等位基因 $A$ 的个体繁殖，一个携带等位基因 $a$ 的个体被替换。\n    选择一个 $A$ 亲代的概率是 $i/N$。\n    选择一个 $a$ 个体被替换的概率是 $(N-i)/N$。\n    在发生出生-死亡事件的条件下，此特定结果的条件概率是 $\\frac{i}{N} \\times \\frac{N-i}{N} = \\frac{i(N-i)}{N^2}$。\n    从 $i$ 到 $i+1$ 的转移速率，记作 $T_{i,i+1}$，是事件速率与此条件概率的乘积：\n    $$T_{i,i+1} = \\lambda \\times \\frac{i(N-i)}{N^2} = \\frac{N}{2} \\times \\frac{i(N-i)}{N^2} = \\frac{i(N-i)}{2N}$$\n    在 $(t, t+\\Delta t]$ 内发生此转移的概率为 $P(i(t+\\Delta t)=i+1 | i(t)=i) = T_{i,i+1} \\Delta t + o(\\Delta t)$。\n    $$P(i \\to i+1) = \\frac{i(N-i)}{2N}\\Delta t + o(\\Delta t)$$\n\n2.  **转移 $i \\to i-1$**：这要求一个携带等位基因 $a$ 的个体繁殖，一个携带等位基因 $A$ 的个体被替换。\n    选择一个 $a$ 亲代的概率是 $(N-i)/N$。\n    选择一个 $A$ 个体被替换的概率是 $i/N$。\n    在发生事件的条件下，此结果的条件概率是 $\\frac{N-i}{N} \\times \\frac{i}{N} = \\frac{i(N-i)}{N^2}$。\n    从 $i$ 到 $i-1$ 的转移速率 $T_{i,i-1}$ 为：\n    $$T_{i,i-1} = \\lambda \\times \\frac{i(N-i)}{N^2} = \\frac{N}{2} \\times \\frac{i(N-i)}{N^2} = \\frac{i(N-i)}{2N}$$\n    在 $(t, t+\\Delta t]$ 内发生此转移的概率为：\n    $$P(i \\to i-1) = \\frac{i(N-i)}{2N}\\Delta t + o(\\Delta t)$$\n\n3.  **转移 $i \\to i$**：如果没有事件发生，或者发生的事件没有改变 $A$ 等位基因的数量，则计数 $i$ 不会改变。\n    在 $\\Delta t$ 内没有事件发生的概率是 $1 - \\lambda \\Delta t + o(\\Delta t) = 1 - \\frac{N}{2}\\Delta t + o(\\Delta t)$。\n    当繁殖个体和被替换个体具有相同等位基因类型时（A繁殖，A被替换 或 a繁殖，a被替换），发生的事件不会改变 $i$。离开状态 $i$ 的总速率是 $T_{i,i+1} + T_{i,i-1} = \\frac{i(N-i)}{2N} + \\frac{i(N-i)}{2N} = \\frac{i(N-i)}{N}$。\n    因此，保持在状态 $i$ 的概率是：\n    $$P(i \\to i) = 1 - (T_{i,i+1} + T_{i,i-1})\\Delta t + o(\\Delta t) = 1 - \\frac{i(N-i)}{N}\\Delta t + o(\\Delta t)$$\n\n现在，我们推导等位基因频率变化的无穷小方差。设 $p(t) = p$，这意味着 $i(t) = i = Np$。在 $(t, t+\\Delta t]$ 内等位基因频率的变化是 $\\Delta p = p(t+\\Delta t) - p(t)$。相应的等位基因数量变化是 $\\Delta i = i(t+\\Delta t) - i(t)$，所以 $\\Delta p = \\Delta i / N$。\n\n根据我们的转移概率，$\\Delta i$ 的可能值为 $+1$、$-1$ 和 $0$。因此，$\\Delta p$ 的可能值为 $+1/N$、$-1/N$ 和 $0$。\n我们需要计算的量是：\n$$ \\lim_{\\Delta t\\to 0}\\frac{\\operatorname{Var}\\!\\big(\\Delta p \\mid p(t)=p\\big)}{\\Delta t} $$\n方差定义为 $\\operatorname{Var}(\\Delta p) = E[(\\Delta p)^2] - (E[\\Delta p])^2$。\n\n首先，我们计算等位基因频率的期望变化 $E[\\Delta p]$。\n$$ E[\\Delta p \\mid i] = \\left(\\frac{1}{N}\\right) P(\\Delta i = +1) + \\left(-\\frac{1}{N}\\right) P(\\Delta i = -1) + (0) P(\\Delta i = 0) $$\n$$ E[\\Delta p \\mid i] = \\frac{1}{N} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) - \\frac{1}{N} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) + o(\\Delta t) = 0 \\cdot \\Delta t + o(\\Delta t) = o(\\Delta t) $$\n这个结果，即期望变化为零，是中性演化的一个标志。\n由此，$(E[\\Delta p])^2 = (o(\\Delta t))^2 = o(\\Delta t^2)$。\n\n接下来，我们计算期望的平方变化 $E[(\\Delta p)^2]$。\n$$ E[(\\Delta p)^2 \\mid i] = \\left(\\frac{1}{N}\\right)^2 P(\\Delta i = +1) + \\left(-\\frac{1}{N}\\right)^2 P(\\Delta i = -1) + (0)^2 P(\\Delta i = 0) $$\n$$ E[(\\Delta p)^2 \\mid i] = \\frac{1}{N^2} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) + \\frac{1}{N^2} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) + o(\\Delta t) $$\n$$ E[(\\Delta p)^2 \\mid i] = \\frac{2}{N^2} \\frac{i(N-i)}{2N}\\Delta t + o(\\Delta t) = \\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t) $$\n\n现在我们可以求出 $\\Delta p$ 的方差：\n$$ \\operatorname{Var}(\\Delta p \\mid i) = E[(\\Delta p)^2 \\mid i] - (E[\\Delta p \\mid i])^2 = \\left(\\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t)\\right) - o(\\Delta t^2) = \\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t) $$\n\n最后，我们通过除以 $\\Delta t$ 并取 $\\Delta t \\to 0$ 的极限来计算单位时间的无穷小方差：\n$$ \\lim_{\\Delta t\\to 0}\\frac{\\operatorname{Var}(\\Delta p \\mid i)}{\\Delta t} = \\lim_{\\Delta t\\to 0}\\frac{\\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t)}{\\Delta t} = \\lim_{\\Delta t\\to 0}\\left(\\frac{i(N-i)}{N^3} + \\frac{o(\\Delta t)}{\\Delta t}\\right) = \\frac{i(N-i)}{N^3} $$\n表达式必须用 $p$ 和 $N$ 表示。我们代入 $i=Np$：\n$$ \\frac{Np(N-Np)}{N^3} = \\frac{N^2p(1-p)}{N^3} = \\frac{p(1-p)}{N} $$\n该表达式表示在指定的Moran模型下，由遗传漂变引起的等位基因频率方差的瞬时增长率。", "answer": "$$\n\\boxed{\\frac{p(1-p)}{N}}\n$$", "id": "2814741"}, {"introduction": "在自然界中，各种演化力很少孤立地起作用，理解这些力量如何相互作用是群体遗传学的核心主题。这个问题探讨了引入新遗传变异的突变与消除变异的遗传漂变之间的经典平衡 [@problem_id:2814725]。通过推导 Wright–Fisher 种群中的平衡杂合度，你将建立一个基础模型，用于预测在种群中维持的中性遗传变异量。", "problem": "一个中性位点在一个二倍体、随机交配、世代不重叠且普查规模恒定为 $N$ 的 Wright–Fisher 种群中演化。令 $\\mu$ 表示每个基因拷贝每代的突变率，假设该突变率与亲本无关，且在所有等位基因状态中均相同。将第 $t$ 代的期望杂合度定义为 $H_t$，即从第 $t$ 代中随机（有放回地）抽取的两个（2个）基因拷贝携带不同等位基因状态的概率。\n\n您将考虑两种突变模型：\n\n- 无限等位基因模型，其中每次突变都会产生一个种群中从未出现过的等位基因状态。\n- 对称有限-$K$ 等位基因模型，其中恰好有 $K$ 种等位基因状态，每次突变都以相等的概率 $1/(K-1)$ 将一个等位基因变为其他 $K-1$ 种状态之一。\n\n任务：\n\n(a) 根据突变如何作用于等位基因状态，精确地形式化上述两种模型。仔细说明突变是否能从最初不同的等位基因中产生同态（identity-by-state）的后果。\n\n(b) 仅使用 Wright–Fisher 模型的抽样结构、全概率定律和 $H_t$ 的定义，在每种模型下推导 $H_{t+1}$ 关于 $H_t$ 的一阶递推关系。计算到小量的一阶，并明确舍去所有 $\\mu^2$、$(1/N)^2$ 和 $\\mu/N$（扩散极限标度）阶的项，同时保留 $\\mu$ 和 $1/N$ 阶的项。\n\n(c) 在无限等位基因模型下，求解您得到的递推关系的唯一内部不动点 $H^{\\ast}$（即平衡期望杂合度）。以 $N$ 和 $\\mu$ 的封闭形式解析表达式给出您的最终答案。不需要数值近似或四舍五入。您的最终答案必须是单个表达式。", "solution": "该问题将按规定分为三部分作答。分析依赖于 Wright-Fisher 模型的基本原理，包括遗传漂变和突变。\n\n(a) 突变模型的形式化\n\n突变的作用描述了具有给定等位基因状态的基因拷贝转变为另一种状态的概率。我们用一个索引来表示基因的等位基因状态。\n\n在无限等位基因模型（IAM）中，可能的等位基因状态集是可数无限的。每个突变事件都被假定产生一个种群中从未存在过的新等位基因。如果我们考虑两个具有不同等位基因状态（比如状态 $i$ 和状态 $j$，其中 $i \\neq j$）的基因谱系，第一个谱系中的突变会将其状态从 $i$ 变为 $k$，其中 $k$ 是一个不等于 $i$ 或 $j$（或种群中存在的任何其他状态）的新状态。同样，第二个谱系中从状态 $j$ 发生的突变将产生一个新状态 $l \\neq j \\land l \\neq i$。因此，突变不可能使两个最初不同的等位基因变为同态。在 IAM 中，突变是一种纯粹的多样化力量，它只能破坏同态性，而不能创造同态性。\n\n在对称有限-$K$ 等位基因模型中，存在一个固定的、包含 $K$ 个可能等位基因状态的有限集合。处于特定状态（比如 $A_i$）的基因拷贝每代以总速率 $\\mu$ 发生突变。发生突变时，它会以相等的概率转换到其他 $K-1$ 种状态中的任意一种。因此，从状态 $A_i$ 到状态 $A_j$（其中 $j \\neq i$）的特定转变概率为 $\\frac{\\mu}{K-1}$。在这个模型中，如果我们考虑两个具有不同等位基因状态 $A_i$ 和 $A_j$ 的基因谱系，第一个谱系有可能从 $A_i$ 突变为 $A_j$，或者第二个谱系从 $A_j$ 突变为 $A_i$。因此，与 IAM 不同，在对称有限-$K$ 等位基因模型中，突变可以从非同态的等位基因中创造出同态性。\n\n(b) 期望杂合度递推关系的推导\n\n令 $H_t$ 为第 $t$ 代的期望杂合度，定义为从第 $t$ 代中有放回地随机抽取的两个基因拷贝具有不同等位基因状态的概率。我们希望找到一个关于 $H_t$ 的 $H_{t+1}$ 递推关系。\n\n我们考虑从第 $t+1$ 代随机抽取的两个基因拷贝。根据 Wright-Fisher 模型的抽样结构，这两个拷贝可以追溯到第 $t$ 代的祖先基因拷贝。它们的祖先来源有两种可能性：\n1. 它们源自第 $t$ 代的同一个祖先基因拷贝。这种情况发生的概率为 $\\frac{1}{2N}$。\n2. 它们源自第 $t$ 代的两个不同祖先基因拷贝。这种情况发生的概率为 $1 - \\frac{1}{2N}$。\n\n我们使用全概率定律来写出 $H_{t+1}$：\n$$H_{t+1} = P(\\text{different at } t+1 \\mid \\text{1 ancestor}) \\cdot \\frac{1}{2N} + P(\\text{different at } t+1 \\mid \\text{2 ancestors}) \\cdot \\left(1 - \\frac{1}{2N}\\right)$$\n\n我们来分析这些条件概率。\n\n首先，考虑单个共同祖先的情况。在 $t+1$ 代的两个后代拷贝只有在它们中至少有一个发生突变并且它们最终状态不相同时才会不同。它们相同的概率是两者都不发生突变的概率，即 $(1-\\mu)^2$，加上两者都突变到相同状态的概率（为 $\\mu^2$ 阶）。到 $\\mu$ 的一阶，相同的概率是 $(1-\\mu)^2 \\approx 1 - 2\\mu$。因此，不同的概率是：\n$$P(\\text{different at } t+1 \\mid \\text{1 ancestor}) \\approx 1 - (1 - 2\\mu) = 2\\mu$$\n\n其次，考虑两个不同祖先的情况。来自第 $t$ 代的这两个祖先拷贝本身不同的概率为 $H_t$，相同的概率为 $1-H_t$。我们可以再次使用全概率定律：\n$$P(\\text{different at } t+1 \\mid \\text{2 ancestors}) = P(\\text{diff at } t+1 \\mid \\text{ancestors diff})H_t + P(\\text{diff at } t+1 \\mid \\text{ancestors same})(1-H_t)$$\n如果两个祖先具有相同的等位基因状态，情况就等同于拥有单个共同祖先。所以，$P(\\text{diff at } t+1 \\mid \\text{ancestors same}) \\approx 2\\mu$。\n\n如果两个祖先具有不同的等位基因状态，它们的后代将会不同，除非发生突变事件使它们变得相同。它们保持不同的概率是 $1$ 减去它们变得相同的概率。到 $\\mu$ 的一阶，它们变得相同只有在其中一个突变成另一个的状态，而另一个不突变时才可能。这个事件的概率是 $\\mu$ 阶的。我们针对每个模型进行分析：\n-   **无限等位基因模型 (IAM):** 正如在 (a) 中所确立的，突变不能从非同态中创造同态性。因此，如果祖先是不同的，它们的未突变或突变的后代将永远是不同的。\n    $$P(\\text{different at } t+1 \\mid \\text{ancestors diff}) = 1$$\n-   **对称有限-$K$ 等位基因模型:** 如果祖先处于状态 $A_i$ 和 $A_j$（$i \\neq j$），如果第一个拷贝从 $A_i$ 突变为 $A_j$（概率为 $\\frac{\\mu}{K-1}$）而第二个不突变（概率为 $1-\\mu$），或者第二个从 $A_j$ 突变为 $A_i$（概率为 $\\frac{\\mu}{K-1}$）而第一个不突变（概率为 $1-\\mu$），那么它们的后代可能变得相同。忽略 $\\mu^2$ 阶的项，变得相同的概率是 $\\frac{\\mu}{K-1} + \\frac{\\mu}{K-1} = \\frac{2\\mu}{K-1}$。\n    $$P(\\text{different at } t+1 \\mid \\text{ancestors diff}) \\approx 1 - \\frac{2\\mu}{K-1}$$\n\n现在我们可以为每个模型写出 $P(\\text{different at } t+1 \\mid \\text{2 ancestors})$ 的表达式：\n-   **IAM:** $P(\\text{diff} \\mid \\text{2 ancestors}) \\approx (1) \\cdot H_t + (2\\mu) \\cdot (1-H_t) = H_t + 2\\mu(1-H_t)$。\n-   **K-等位基因模型:** $P(\\text{diff} \\mid \\text{2 ancestors}) \\approx \\left(1 - \\frac{2\\mu}{K-1}\\right) H_t + (2\\mu)(1-H_t) = H_t - \\frac{2\\mu H_t}{K-1} + 2\\mu - 2\\mu H_t = H_t\\left(1 - \\frac{2\\mu K}{K-1}\\right) + 2\\mu$。\n\n最后，我们将这些代入 $H_{t+1}$ 的完整递推公式中。\n$$H_{t+1} \\approx (2\\mu)\\frac{1}{2N} + \\left(1-\\frac{1}{2N}\\right) P(\\text{diff} \\mid \\text{2 ancestors}) = \\frac{\\mu}{N} + P(\\text{diff} \\mid \\text{2 ancestors}) - \\frac{1}{2N} P(\\text{diff} \\mid \\text{2 ancestors})$$\n根据指令，我们舍去 $\\mu/N$ 阶的项。项 $\\frac{\\mu}{N}$ 被舍去。在最后一项中，$P(\\text{diff} \\mid \\text{2 ancestors})$ 的形式为 $H_t + O(\\mu)$，所以 $\\frac{1}{2N}P(\\text{diff} \\mid \\text{2 ancestors}) = \\frac{H_t}{2N} + O(\\frac{\\mu}{N})$。我们舍去 $O(\\frac{\\mu}{N})$ 部分。\n递推关系简化为：\n$$H_{t+1} \\approx P(\\text{diff} \\mid \\text{2 ancestors}) - \\frac{H_t}{2N}$$\n\n代入特定模型的表达式：\n-   **无限等位基因模型递推关系：**\n    $$H_{t+1} \\approx [H_t + 2\\mu(1-H_t)] - \\frac{H_t}{2N} = H_t + 2\\mu - 2\\mu H_t - \\frac{H_t}{2N}$$\n    $$H_{t+1} = H_t\\left(1 - \\frac{1}{2N} - 2\\mu\\right) + 2\\mu$$\n-   **对称有限-$K$ 等位基因模型递推关系：**\n    $$H_{t+1} \\approx \\left[H_t\\left(1 - \\frac{2\\mu K}{K-1}\\right) + 2\\mu\\right] - \\frac{H_t}{2N}$$\n    $$H_{t+1} = H_t\\left(1 - \\frac{1}{2N} - \\frac{2\\mu K}{K-1}\\right) + 2\\mu$$\n\n(c) 无限等位基因模型下的平衡杂合度\n\n为了找到平衡期望杂合度，记为 $H^*$，我们在为无限等位基因模型推导的递推关系中令 $H_{t+1} = H_t = H^*$。\n$$H^* = H^*\\left(1 - \\frac{1}{2N} - 2\\mu\\right) + 2\\mu$$\n我们求解 $H^*$：\n$$H^* - H^*\\left(1 - \\frac{1}{2N} - 2\\mu\\right) = 2\\mu$$\n$$H^*\\left(1 - \\left(1 - \\frac{1}{2N} - 2\\mu\\right)\\right) = 2\\mu$$\n$$H^*\\left(\\frac{1}{2N} + 2\\mu\\right) = 2\\mu$$\n$$H^* = \\frac{2\\mu}{\\frac{1}{2N} + 2\\mu}$$\n为了得到更标准的形式，我们将分子和分母同乘以 $2N$：\n$$H^* = \\frac{2\\mu \\cdot 2N}{\\left(\\frac{1}{2N} + 2\\mu\\right) \\cdot 2N} = \\frac{4N\\mu}{1 + 4N\\mu}$$\n这是无限等位基因模型下平衡期望杂合度的封闭形式解析表达式，通常用种群尺度突变率 $\\theta = 4N\\mu$ 表示为 $H^* = \\frac{\\theta}{1+\\theta}$。", "answer": "$$\\boxed{\\frac{4N\\mu}{1 + 4N\\mu}}$$", "id": "2814725"}]}