## 引言

在[群体遗传学](@entry_id:146344)中，等位基因在群体中的传递并非总是遵循孟德尔的[独立分配定律](@entry_id:272450)。位于同一[染色体](@entry_id:276543)上的[基因座](@entry_id:177958)，其等位基因往往会以非随机的方式一同遗传，这种现象被称为[连锁不平衡](@entry_id:146203)（Linkage Disequilibrium, LD）。连锁不平衡是塑造基因组变异结构的核心力量，理解其模式和程度对于揭示疾病的遗传基础、追溯人类群体的演化历史以及识别自然选择的印记至关重要。然而，如何精确量化这种非随机关联，并区分不同演化力量对其产生的影响，是遗传学研究中的一个核心问题。

本文旨在为读者提供一个关于连锁不平衡的全面而深入的框架。通过三个章节的递进式学习，您将系统地掌握这一关键概念。
- 在“**原理与机制**”一章中，我们将从连锁不平衡的基本定义出发，详细介绍其核心度量指标 $D$、$D'$ 和 $r^2$，并剖析重组、突变、遗传漂变和选择等演化力量如何共同塑造基因组中的LD模式。
- 接着，在“**应用与跨学科连接**”一章中，我们将展示这些理论知识如何转化为强大的分析工具，应用于全基因组关联研究（GWAS）、群体历史推断、[适应性进化](@entry_id:176122)分析等多个前沿领域。
- 最后，“**实践练习**”部分将提供一系列精心设计的问题，帮助您巩固对关键概念的理解，并培养在实际研究中应用这些知识的能力。

通过本文的学习，您将能够不仅理解[连锁不平衡](@entry_id:146203)是什么，更能洞悉其为何重要以及如何利用它来解决复杂的生物学问题。现在，让我们从连锁不平衡最基本的原理和机制开始探索。

## 原理与机制

本章深入探讨[连锁不平衡](@entry_id:146203)的定量度量及其背后的[演化机制](@entry_id:196221)。我们将从基本定义出发，系统地建立[连锁不平衡](@entry_id:146203)的理论框架，阐明其不同的测量方法，并剖析在[群体遗传学](@entry_id:146344)背景下，产生、维持和削弱等位基因间非随机关联的各种演化力量。

### 定义连锁不平衡：系数 $D$

在[群体遗传学](@entry_id:146344)中，为了量化两个[基因座](@entry_id:177958)上等位基因之间的关联，我们首先需要考察**单倍型 (haplotype)**，即在同一条[染色体](@entry_id:276543)上共同遗传的一组等位基因。考虑两个双等位[基因座](@entry_id:177958)，位点1的等位基因为 $A/a$，位点2的等位基因为 $B/b$。在群体中，存在四种可能的单倍型：$AB$、$Ab$、$aB$ 和 $ab$。我们可以将它们的频率分别记为 $x_{AB}$、$x_{Ab}$、$x_{aB}$ 和 $x_{ab}$，且它们的总和为1。

从单倍型频率出发，我们可以计算出每个[基因座](@entry_id:177958)上等位基因的边际频率。例如，等位基因 $A$ 的频率 $p_A$ 是所有包含 $A$ 的单倍型频率之和，即 $p_A = x_{AB} + x_{Ab}$。类似地，$p_B = x_{AB} + x_{aB}$。[@problem_id:2732241]

如果两个[基因座](@entry_id:177958)上的等位基因是统计独立的，即它们之间的关联是随机的，我们就称之为**连锁平衡 (linkage equilibrium)**。在这种理想状态下，一个单倍型的频率应该等于其组成[等位基因频率](@entry_id:146872)的乘积。例如， $AB$ 单倍型的期望频率应为 $x_{AB} = p_A p_B$。

然而，在真实群体中，由于多种演化因素的影响，等位基因之间的关联往往不是随机的。**连锁不平衡 (Linkage Disequilibrium, LD)** 正是用来量化这种偏离随机关联程度的指标。最基本的度量是**连锁不平衡系数 $D$**，它被定义为观测到的 $AB$ 单倍型频率与连锁平衡时期望频率之间的差值：

$D = x_{AB} - p_A p_B$

当 $D > 0$ 时，意味着 $AB$ 单倍型（以及互补的 $ab$ 单倍型）的频率超出了期望，这种情况常被称为“耦合相”（coupling phase）关联。相反，当 $D  0$ 时，意味着 $Ab$ 和 $aB$ 单倍型（“排斥相”，repulsion phase）的频率超出期望。当 $D = 0$ 时，群体处于连锁平衡状态。[@problem_id:2732243]

$D$ 还有一个等价的、更对称的定义形式，即“交叉乘积之差”：

$D = x_{AB}x_{ab} - x_{Ab}x_{aB}$

这个形式揭示了 $D$ 的一个重要特性：它的符号取决于我们如何标记等位基因。例如，如果我们仅仅交换一个[基因座](@entry_id:177958)的等位基因标签（如将 $A$ 换成 $a$， $a$ 换成 $A$），那么新的连锁不平衡系数 $D'$ 将会是原始值的相反数，即 $D' = -D$。然而，如果我们同时交换两个[基因座](@entry_id:177958)的标签， $D$ 的符号将保持不变。这个特性提醒我们，$D$ 的符号本身是相对的，其大小（[绝对值](@entry_id:147688)）才反映了不平衡的强度。[@problem_id:2732243]

举例来说，在一个包含100条[染色体](@entry_id:276543)的样本中，我们观测到单倍型计数为：$AB$ 46条，$Ab$ 14条，$aB$ 14条，$ab$ 26条。首先，我们计算单倍型频率：$x_{AB}=0.46$, $x_{Ab}=0.14$, $x_{aB}=0.14$, $x_{ab}=0.26$。接着，计算等位基因频率：$p_A = 0.46 + 0.14 = 0.60$，$p_B = 0.46 + 0.14 = 0.60$。最后，我们可以计算 $D$ 值：

$D = x_{AB} - p_A p_B = 0.46 - (0.60)(0.60) = 0.46 - 0.36 = 0.10$

这个正值表明，在该样本中，$A$ 和 $B$ 等位基因的关联比随机预期的更紧密。[@problem_id:2732241]

### $D$ 的约束与标准化的必要性

尽管 $D$ 的定义直观，但它有一个重要的局限性：其取值范围严重依赖于相关等位基因的频率。这使得在不同群体或不同[基因座](@entry_id:177958)之间直接比较 $D$ 值变得十分困难。

这个约束源于一个基本事实：任何单倍型的频率都不能为负。我们可以将四个单倍型的频率用[等位基因频率](@entry_id:146872)和 $D$ 来表示：[@problem_id:2825921] [@problem_id:2728701]

$x_{AB} = p_A p_B + D \ge 0$
$x_{Ab} = p_A(1-p_B) - D = p_A q_B - D \ge 0$
$x_{aB} = (1-p_A)p_B - D = q_A p_B - D \ge 0$
$x_{ab} = (1-p_A)(1-p_B) + D = q_A q_B + D \ge 0$

（这里 $q_A = 1-p_A$，$q_B = 1-p_B$）

这些不等式共同决定了 $D$ 的理论取值范围。$D$ 的最大值 $D_{max}$ 和最小值 $D_{min}$ 分别为：

$D_{max} = \min(p_A q_B, q_A p_B)$
$D_{min} = -\min(p_A p_B, q_A q_B)$

让我们通过一个例子来理解这一点。假设在一个群体中，[等位基因频率](@entry_id:146872)为 $p_A=0.1$ 和 $p_B=0.9$。那么 $q_A=0.9$，$q_B=0.1$。根据上述公式， $D$ 的取值范围是：

$D_{max} = \min((0.1)(0.1), (0.9)(0.9)) = \min(0.01, 0.81) = 0.01$
$D_{min} = -\min((0.1)(0.9), (0.9)(0.1)) = -\min(0.09, 0.09) = -0.09$

因此，在这种[等位基因频率](@entry_id:146872)下，$D$ 的理论范围是 $[-0.09, 0.01]$。这个范围相对于0是高度不对称的。其生物学解释是：当一个稀有等位基因（如 $A$）和一个常见等位基因（如 $B$）相遇时，形成正相关（$D0$）的潜力受到极大限制。这是因为要增加 $AB$ 单倍型，就必须减少 $Ab$ 或 $aB$ 单倍型。而 $Ab$ 单倍型的期望频率仅为 $p_A q_B = (0.1)(0.1) = 0.01$，所以 $D$ 最多只能增加0.01。相反，形成负相关（$D0$）的潜力则大得多，因为 $AB$ 的期望频率 $p_A p_B = 0.09$，理论上可以完全被消除，使得 $D$ 达到-0.09。[@problem_id:2825921]

这个例子清楚地表明，如果不进行[标准化](@entry_id:637219)，一个小的 $D$ 值可能已经代表了在该[等位基因频率](@entry_id:146872)下所能达到的最强连锁不平衡。

### [连锁不平衡](@entry_id:146203)的标准化度量

为了克服 $D$ 值的频率依赖性，并能够在不同研究之间进行有意义的比较，遗传学家们发展出了多种标准化的LD度量。其中最常用的两个是 $D'$ 和 $r^2$。

#### Lewontin的 $D'$

**$D'$ (D prime)** 是由 Richard Lewontin 提出的，它将观测到的 $D$ 值与其在给定[等位基因频率](@entry_id:146872)下的理论最大可[能值](@entry_id:187992)（或最小可能值的[绝对值](@entry_id:147688)）进行比较。其定义如下：

若 $D  0$, 则 $D' = \frac{D}{D_{max}} = \frac{D}{\min(p_A q_B, q_A p_B)}$
若 $D  0$, 则 $D' = \frac{D}{|D_{min}|} = \frac{D}{\min(p_A p_B, q_A q_B)}$

$D'$ 的取值范围是 $[-1, 1]$。$D'$ 的一个关键优势在于其直观的解释：$|D'|=1$ 意味着达到了**完全[连锁不平衡](@entry_id:146203)**。在这种情况下，四种可能的单倍型中至少有一种在群体中完全缺失。这通常表明，自从这两个位点产生关联（例如，通过一次突变）以来，它们之间几乎没有发生过重组。因此，$D'$ 对群体的重组历史非常敏感，常被用来识别**单倍型模块 (haplotype blocks)** —— 即在[染色体](@entry_id:276543)上几乎没有重组证据的区域。[@problem_id:2728701]

#### 平方[相关系数](@entry_id:147037) $r^2$

另一个重要的标准化度量是**$r^2$**，即两个[基因座](@entry_id:177958)等位基因状态之间的**平方[相关系数](@entry_id:147037)**。我们可以将每个位点的等位基因状态（例如，在位点1上是 $A$ 还是 $a$）看作一个伯努利[随机变量](@entry_id:195330)。$r^2$ 就是这两个[随机变量](@entry_id:195330)之间[皮尔逊相关系数](@entry_id:270276)的平方。其计算公式为：

$r^2 = \frac{D^2}{p_A q_A p_B q_B}$

$r^2$ 的取值范围是 $[0, 1]$。$r^2=1$ 同样表示完全连锁不平衡，但其条件比 $|D'|=1$ 更为苛刻，它不仅要求两种单倍型缺失，还要求[等位基因频率](@entry_id:146872)配对相等（$p_A=p_B$）。$r^2$ 的核心价值在于其对**可预测性**的度量。一个高的 $r^2$ 值（例如，$r^2  0.8$）意味着，如果我们知道一个个体在一个位点上的等位基因，我们就能以很高的准确率预测其在另一个位点上的等位基因。这一特性使得 $r^2$ 成为**[全基因组](@entry_id:195052)关联研究 (GWAS)** 中挑选**标签SNP (tag SNP)** 的核心指标，从而能够用较少的SNP位点来代表整个基因组的大部分变异信息。[@problem_id:2801540]

#### 对比 $D'$ 与 $r^2$

$D'$ 和 $r^2$ 提供了关于连锁不平衡的不同视角，理解它们的差异至关重要。$D'$ 主要反映了重组历史，而 $r^2$ 主要反映了位点间的[统计可预测性](@entry_id:262135)。

一个经典的例子可以阐明这一点：想象一个群体中，由于等位基因 $A$ 非常稀有（例如 $p_A=0.01$），而等位基因 $B$ 非常普遍（例如 $p_B=0.99$），并且 $Ab$ 单倍型完全不存在。在这种情况下，$D'$ 将等于1，表明了极强的历史关联（$A$ 和 $b$ 从未在同一条[染色体](@entry_id:276543)上出现过）。然而，由于等位基因频率的巨大差异，$r^2$ 的值会非常低。这是因为即使我们知道一个位点是 $A$，它对另一个位点是否是 $B$ 的预测能力也很弱（因为 $B$ 本来就极其普遍）。因此，在这种情况下，尽管存在历史上的完全连锁，但这两个位点在统计上几乎是独立的。[@problem_id:1944765]

反之，两个具有相同 $r^2$ 值的位点对，可能具有截然不同的 $D'$ 值。一个具有高 $D'$ 和低 $r^2$ 的场景（通常发生在等位基因频率差异悬殊时）对于推断单倍型结构和演化历史更有价值。而一个具有高 $r^2$ 的场景（这必然要求等位基因频率较为匹配）则对于关联研究中的标签SNP选择至关重要。[@problem_id:2825939]

### 连锁不平衡的动态性质：产生与衰减

[连锁不平衡](@entry_id:146203)并非一成不变，它是一个动态的量，在群体中不断被各种演化力量塑造。

#### 重组导致的衰减

**遗传重组 (Genetic Recombination)** 是削弱[连锁不平衡](@entry_id:146203)最主要的力量。在[减数分裂](@entry_id:140926)过程中，同源[染色体](@entry_id:276543)之间发生交换，从而将原有的等位基因组合打乱，产生新的单倍型。

连锁不平衡的衰减速度与两个[基因座](@entry_id:177958)之间的**[重组率](@entry_id:203271) (recombination fraction)** $c$ 直接相关。在一个随机交配的群体中，如果没有其他演化力量的干扰，下一代的[连锁不平衡](@entry_id:146203)系数 $D_{t+1}$ 与当前代 $D_t$ 的关系可以用一个简单的[递推公式](@entry_id:149465)表示：

$D_{t+1} = (1-c)D_t$

这意味着连锁不平衡会以几何级数的形式逐代衰减，其[半衰期](@entry_id:144843)与 $c$ 成反比。经过 $t$ 代后，LD的残余量为：

$D_t = D_0 (1-c)^t$

其中 $D_0$ 是初始的L[D值](@entry_id:168396)。这个公式表明，物理距离较远（$c$ 值大）的[基因座](@entry_id:177958)之间的连锁不平衡会迅速瓦解，而紧密连锁（$c$ 值小）的[基因座](@entry_id:177958)之间的LD则可以持续很多代。对于非连锁的[基因座](@entry_id:177958)（位于不同[染色体](@entry_id:276543)或同一[染色体](@entry_id:276543)上距离很远，$c=0.5$），LD每代都会减半。[@problem_id:2801540]

#### 产生连锁不平衡的演化力量

既然重组不断地削弱LD，那么群体中观测到的LD是从何而来的呢？以下是几个主要的产生机制：

*   **突变 (Mutation)**：一个新的突变总是出现在某一条特定的[染色体](@entry_id:276543)上，即一个特定的单倍型背景中。因此，在突变发生的瞬间，该新等位基因与其所在[染色体](@entry_id:276543)上的所有其他等位基因都处于完全的连锁不平衡中（$|D'|=1$）。随着时间的推移，重组会逐渐打破这种初始的关联。

*   **[遗传漂变](@entry_id:145594) (Genetic Drift)**：在有限大小的群体中，由于[随机抽样](@entry_id:175193)效应，单倍型频率会发生随机波动。这种波动本身就可以偶然地产生连锁不平衡。**[群体瓶颈](@entry_id:154577) (population bottleneck)**，即群体规模的急剧缩小，是遗传漂变效应最强的形式。在瓶颈期间，某些单倍型可能因为偶然因素而频率大增或完全丢失，从而在[全基因组](@entry_id:195052)范围内产生大量的[连锁不平衡](@entry_id:146203)。当群体规模恢复后，重组开始慢慢侵蚀这些由漂变产生的LD。不同距离的位点对衰减速度不同，这会在基因组中留下一个独特的LD模式：近距离位点保持高LD，远距离位点LD较低，而在一个特定的中间距离上，LD呈现一个“肩部”形态。这个“肩部”的位置可以用来推断瓶颈事件发生的时间（以代为单位），即 $T \approx 1/c$。因此，LD[衰减曲线](@entry_id:189857)是研究群体历史的有力工具。[@problem_id:2825934]

*   **群体结构 (Population Structure) 与混合 (Admixture)**：当两个或多个具有不同[等位基因频率](@entry_id:146872)的亚群体混合在一起时，即使每个亚群体内部都处于连锁平衡（$D=0$），在混合后的总群体中也会凭空产生连锁不平衡。这是一个典型的**[辛普森悖论](@entry_id:136589) (Simpson's Paradox)** 的例子。具体来说，混合群体的 $D$ 值等于各亚群体 $D$ 值的加权平均，再加上各亚群体[等位基因频率](@entry_id:146872)之间的协[方差](@entry_id:200758)。

    $D_{pooled} = \sum_{i} w_i D_i + \text{Cov}(p_{A,i}, p_{B,i})$

    当每个亚群体 $D_i=0$ 时，只要[等位基因频率](@entry_id:146872)在亚群体间存在协同变化（例如，亚群体1中 $A$ 和 $B$ 的频率都高，而亚群体2中两者频率都低），混合就会产生正的 $D$ 值。这种由[群体结构](@entry_id:148599)产生的LD可能会干扰GWAS等研究，导致虚假的关联信号，因此在进行此类分析时必须对群体结构进行校正。[@problem_id:2825918]

*   **自然选择 (Natural Selection)**：当特定的单倍型（即等位基因组合）比其他组合具有更高的适合度时，自然选择会倾向于保留这种单倍型，从而产生或维持[连锁不平衡](@entry_id:146203)。这种选择被称为**上位效应 (epistasis)** 选择。

综上所述，[连锁不平衡](@entry_id:146203)是群体遗传学中的一个核心概念。其各种度量（$D$, $D'$, $r^2$）从不同侧面量化了等位基因间的非随机关联。深入理解这些度量的含义，以及重组、漂变、群体结构和选择等演化力量如何共同塑造基因组中的LD模式，对于解释我们从基因组数据中看到的变异结构、推断演化历史以及设计和解释疾病关联研究都至关重要。