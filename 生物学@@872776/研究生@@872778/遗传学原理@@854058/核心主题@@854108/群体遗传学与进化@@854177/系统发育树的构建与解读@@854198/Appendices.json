{"hands_on_practices": [{"introduction": "最大简约法是系统发育推断的基石之一，其核心思想是寻找需要最少字符状态变化的演化树。这项练习 [@problem_id:2837245] 旨在挑战您在最基础的层面上应用这一原则，即从一个DNA比对中识别出哪些位点真正含有能够区分不同树拓扑结构的信息。掌握这一技能有助于您理解，在字符数据中，什么是系统发育的“信号”，什么又是“噪音”。", "problem": "给定 $4$ 个分类单元（标记为 A、B、C 和 D）在 $20$ 个位点上的脱氧核糖核酸（DNA）字符比对。在最大简约法（MP）的系统发育推断中，如果一个位点的字符状态分布可以通过暗示不同的最小状态改变次数来区分不同的无根树拓扑结构，则该位点被称为简约信息位点。对于具有四种可能核苷酸的DNA字符，根据第一性原理，我们做出如下解释：一个位点是简约信息位点，当且仅当存在至少 $2$ 种不同的核苷酸，并且这至少 $2$ 种核苷酸中的每一种都至少在 $2$ 个分类单元中出现。由 N 表示的模糊字符和由 - 表示的缺失（gap）被视作缺失数据，不计入统计；一个位点仅在其明确的观测值本身满足所述标准时，才被计为简约信息位点。\n\n请根据上述原则，用你自己的话定义什么是简约信息位点，然后计算以下比对中简约信息位点的总数。每个位点以 A/B/C/D 的模式列出：\n\n- 位点 $1$: A A A A\n- 位点 $2$: A A A G\n- 位点 $3$: A A G G\n- 位点 $4$: A G A G\n- 位点 $5$: A G G A\n- 位点 $6$: A C G T\n- 位点 $7$: C C C C\n- 位点 $8$: T T C C\n- 位点 $9$: G G G T\n- 位点 $10$: G T G T\n- 位点 $11$: T G G G\n- 位点 $12$: C C G G\n- 位点 $13$: C G C G\n- 位点 $14$: C G G C\n- 位点 $15$: A A C C\n- 位点 $16$: A C C C\n- 位点 $17$: A N G G\n- 位点 $18$: N N A A\n- 位点 $19$: - A - A\n- 位点 $20$: T C T C\n\n最终答案仅报告简约信息位点的数量。无需四舍五入；以无单位的整数形式提供结果。", "solution": "在尝试任何解决方案之前，对问题陈述进行验证。\n\n**步骤1：提取的已知信息**\n- 分类单元数量：$4$ 个（A、B、C、D）。\n- 位点数量：$20$ 个。\n- 字符类型：脱氧核糖核酸（DNA）核苷酸（A、C、G、T）。\n- 特定字符的处理：'N'（模糊）和 '-'（缺失）被视为缺失数据，并从字符计数中排除。\n- 简约信息位点的定义：一个位点是简约信息位点，当且仅当基于明确的字符同时满足两个条件：\n    1. 存在至少 $2$ 种不同的核苷酸。\n    2. 这些不同的核苷酸中至少有 $2$ 种，每一种都至少在 $2$ 个分类单元中出现。\n- 数据：提供了一个 $4 \\times 20$ 的DNA比对。\n\n**步骤2：验证结论**\n该问题具有科学依据，因为它涉及系统发育分析中简约信息位点的基本概念，这是计算生物学和遗传学的核心课题。所提供的定义是对一个位点在 $4$ 个分类单元分析中成为简约信息位点的充分必要条件的正确且正式的陈述。问题陈述清晰，包含了所有必要的数据和明确无误的评估标准，确保了唯一解的存在。它是客观的，没有任何科学或逻辑上的缺陷。因此，该问题是**有效的**。\n\n接下来进行求解。\n\n根据所提供的原则，简约信息位点是序列比对中的一列，它提供证据以支持某一个无根系统发育树拓扑结构，而非其他结构。对于 $4$ 个分类单元，存在 $3$ 种可能的无根树。一个位点只有在支持特定的分类单元分组时，才能在这些树之间进行区分。这要求一种字符分布，其中至少有两个分类单元共享一种字符状态，另外至少两个分类单元共享另一种不同的字符状态。因此，该模式的形式为 `x-x-y-y`。任何其他模式，如 `x-x-x-x`（恒定不变的）、`x-x-x-y`（单一变异的）或 `w-x-y-z`（全部独特的），在所有 $3$ 种可能的树拓扑上都将需要相同的最小改变次数，因此对于选择最简约的树是无信息的。给定的规则是这一原则的形式化表述：一个位点要想提供信息，它必须包含至少两种不同的字符状态，并且其中至少两种状态必须至少出现两次。\n\n我们根据这一标准分析所有 $20$ 个位点，忽略任何 `N` 或 `-` 字符。\n\n设 $S_i$ 为位点 $i$ 处的字符集合。设 $C(S_i)$ 为 $S_i$ 中的唯一字符集合。设 $N(c, S_i)$ 为字符 $c$ 在位点 $S_i$ 中的计数。一个位点是简约信息位点，如果：\n1. $|C(S_i)| \\ge 2$\n2. 满足 $N(c, S_i) \\ge 2$ 的字符 $c \\in C(S_i)$ 的数量本身至少为 $2$。\n\n- **恒定位点：** 模式 `x-x-x-x`。\n  - 位点 $1$ (A,A,A,A): $|C(S_1)| = 1$。不满足条件1。非信息位点。\n  - 位点 $7$ (C,C,C,C): $|C(S_7)| = 1$。不满足条件1。非信息位点。\n\n- **单一变异位点：** 模式 `x-x-x-y`。\n  - 位点 $2$ (A,A,A,G): $C(S_2) = \\{\\text{A, G}\\}$，所以 $|C(S_2)| = 2$。$N(\\text{A}, S_2)=3$, $N(\\text{G}, S_2)=1$。只有一个字符（'A'）的计数 $\\ge 2$。不满足条件2。非信息位点。\n  - 位点 $9$ (G,G,G,T): $C(S_9) = \\{\\text{G, T}\\}$，$N(\\text{G}, S_9)=3$, $N(\\text{T}, S_9)=1$。不满足条件2。非信息位点。\n  - 位点 $11$ (T,G,G,G): $C(S_{11}) = \\{\\text{T, G}\\}$，$N(\\text{T}, S_{11})=1$, $N(\\text{G}, S_{11})=3$。不满足条件2。非信息位点。\n  - 位点 $16$ (A,C,C,C): $C(S_{16}) = \\{\\text{A, C}\\}$，$N(\\text{A}, S_{16})=1$, $N(\\text{C}, S_{16})=3$。不满足条件2。非信息位点。\n\n- **多状态独特位点：** 模式 `w-x-y-z`。\n  - 位点 $6$ (A,C,G,T): $C(S_6) = \\{\\text{A, C, G, T}\\}$，所以 $|C(S_6)| = 4$。$N(\\text{A})=1, N(\\text{C})=1, N(\\text{G})=1, N(\\text{T})=1$。没有字符的计数 $\\ge 2$。不满足条件2。非信息位点。\n\n- **含缺失数据的位点：**\n  - 位点 $17$ (A,N,G,G): 明确的字符是 (A,G,G)。$C(S_{17}) = \\{\\text{A, G}\\}$。$N(\\text{A})=1, N(\\text{G})=2$。只有一个字符（'G'）的计数 $\\ge 2$。不满足条件2。非信息位点。\n  - 位点 $18$ (N,N,A,A): 明确的字符是 (A,A)。$C(S_{18}) = \\{\\text{A}\\}$，所以 $|C(S_{18})| = 1$。不满足条件1。非信息位点。\n  - 位点 $19$ (-,A,-,A): 明确的字符是 (A,A)。$C(S_{19}) = \\{\\text{A}\\}$，所以 $|C(S_{19})| = 1$。不满足条件1。非信息位点。\n\n- **简约信息位点：** 模式 `x-x-y-y`。\n  - 这些是唯一满足两个条件的位点。$|C(S_i)|=2$，并且对于 $C(S_i)$ 中的两个字符 $c_1, c_2$，都有 $N(c_1, S_i) = 2$ 和 $N(c_2, S_i) = 2$。\n  - 位点 $3$ (A,A,G,G): $N(\\text{A})=2, N(\\text{G})=2$。**信息位点**。\n  - 位点 $4$ (A,G,A,G): $N(\\text{A})=2, N(\\text{G})=2$。**信息位点**。\n  - 位点 $5$ (A,G,G,A): $N(\\text{A})=2, N(\\text{G})=2$。**信息位点**。\n  - 位点 $8$ (T,T,C,C): $N(\\text{T})=2, N(\\text{C})=2$。**信息位点**。\n  - 位点 $10$ (G,T,G,T): $N(\\text{G})=2, N(\\text{T})=2$。**信息位点**。\n  - 位点 $12$ (C,C,G,G): $N(\\text{C})=2, N(\\text{G})=2$。**信息位点**。\n  - 位点 $13$ (C,G,C,G): $N(\\text{C})=2, N(\\text{G})=2$。**信息位点**。\n  - 位点 $14$ (C,G,G,C): $N(\\text{C})=2, N(\\text{G})=2$。**信息位点**。\n  - 位点 $15$ (A,A,C,C): $N(\\text{A})=2, N(\\text{C})=2$。**信息位点**。\n  - 位点 $20$ (T,C,T,C): $N(\\text{T})=2, N(\\text{C})=2$。**信息位点**。\n\n简约信息位点的总数是最后一类位点的计数。共有 $10$ 个这样的位点。", "answer": "$$\\boxed{10}$$", "id": "2837245"}, {"introduction": "与简约法等直接分析比对矩阵中字符列的方法不同，距离法首先将序列比对转换为一个成对距离矩阵，然后基于此矩阵构建系统发育树。邻接法 (Neighbor-Joining, NJ) 是一个强大且广泛应用的算法，它通过迭代地将分类单元进行聚类来构建树。这项动手实践 [@problem_id:2837181] 将引导您完整地走一遍邻接法的计算过程，从而让您对如何从一个简单的距离矩阵中恢复拓扑结构和枝长有具体而深入的理解。", "problem": "给定五个分类单元 $A$、$B$、$C$、$D$ 和 $E$ 之间的一个加性、对称的距离矩阵。两两之间的距离 $d_{ij}$ (其中 $d_{ii}=0$) 如下：\n- $d_{AB} = 2$, $d_{AC} = 6.2$, $d_{AD} = 6.4$, $d_{AE} = 6.4$,\n- $d_{BC} = 6.2$, $d_{BD} = 6.4$, $d_{BE} = 6.4$,\n- $d_{CD} = 2.6$, $d_{CE} = 2.6$, $d_{DE} = 0.8$.\n\n请仅使用加性树度量的基本定义和邻接法 (neighbor-joining, NJ) 的标准算法步骤，重建无根系统发育树。在每次迭代中，计算用于选择要连接的配对的标准，确定被连接的配对，计算它们到新连接节点的枝长，并精确更新简化后的距离矩阵。持续此过程，直到最后的三分类单元步骤，并计算连接到最终内部节点的末端枝长。\n\n如果邻接选择标准出现平局，则选择原始距离 $d_{ij}$ 较小的一对来打破平局；如果仍然平局，则按标签选择字典序靠前的一对。\n\n重建的无根树的总树长（定义为所有分支长度之和）的精确值是多少？请以单个实数表示。不要对答案进行四舍五入；提供没有单位的精确值。", "solution": "问题陈述已经过验证。给定条件是一组五个分类单元 $\\{A, B, C, D, E\\}$ 和一个对称的加性距离矩阵。该问题具有科学依据、提法明确、客观且自洽，需要直接应用邻接法 (NJ) 算法。该过程是确定性的，有明确的平局打破规则。因此，可以构建一个有效的解。\n\n邻接算法通过迭代进行，每一步将分类单元的数量减少一个，直到只剩下三个。最终得到的无根树的总长度是其所有分支长度的总和。\n\n对于 $N=5$ 个分类单元的初始距离矩阵 $D$ 如下：\n$$\nD_0 = \n\\begin{pmatrix}\n  A  B  C  D  E \\\\\nA  0  2  6.2  6.4  6.4 \\\\\nB  2  0  6.2  6.4  6.4 \\\\\nC  6.2  6.2  0  2.6  2.6 \\\\\nD  6.4  6.4  2.6  0  0.8 \\\\\nE  6.4  6.4  2.6  0.8  0 \n\\end{pmatrix}\n$$\n\n**步骤 1：对 $N=5$ 个分类单元进行迭代。**\n\n首先，我们计算每个分类单元 $i$ 的净分歧度 $r_i$，其定义为它到所有其他分类单元的距离之和：\n$r_i = \\sum_{j \\in \\{A,B,C,D,E\\}} d_{ij}$。\n$$\nr_A = 2 + 6.2 + 6.4 + 6.4 = 21.0 \\\\\nr_B = 2 + 6.2 + 6.4 + 6.4 = 21.0 \\\\\nr_C = 6.2 + 6.2 + 2.6 + 2.6 = 17.6 \\\\\nr_D = 6.4 + 6.4 + 2.6 + 0.8 = 16.2 \\\\\nr_E = 6.4 + 6.4 + 2.6 + 0.8 = 16.2\n$$\n\n接下来，我们计算邻接标准矩阵 $Q$，其中 $Q_{ij} = (N-2)d_{ij} - r_i - r_j$。对于 $N=5$，公式为 $Q_{ij} = 3 d_{ij} - r_i - r_j$。\n$$\nQ_{AB} = 3(2) - 21.0 - 21.0 = 6.0 - 42.0 = -36.0 \\\\\nQ_{AC} = 3(6.2) - 21.0 - 17.6 = 18.6 - 38.6 = -20.0 \\\\\nQ_{AD} = 3(6.4) - 21.0 - 16.2 = 19.2 - 37.2 = -18.0 \\\\\nQ_{AE} = 3(6.4) - 21.0 - 16.2 = 19.2 - 37.2 = -18.0 \\\\\nQ_{BC} = 3(6.2) - 21.0 - 17.6 = 18.6 - 38.6 = -20.0 \\\\\nQ_{BD} = 3(6.4) - 21.0 - 16.2 = 19.2 - 37.2 = -18.0 \\\\\nQ_{BE} = 3(6.4) - 21.0 - 16.2 = 19.2 - 37.2 = -18.0 \\\\\nQ_{CD} = 3(2.6) - 17.6 - 16.2 = 7.8 - 33.8 = -26.0 \\\\\nQ_{CE} = 3(2.6) - 17.6 - 16.2 = 7.8 - 33.8 = -26.0 \\\\\nQ_{DE} = 3(0.8) - 16.2 - 16.2 = 2.4 - 32.4 = -30.0\n$$\n$Q$ 矩阵中的最小值为 $Q_{AB} = -36.0$。因此，分类单元 $A$ 和 $B$ 是邻居，将被连接到一个新节点上，我们将其命名为 $U$。\n\n从 $A$ 和 $B$ 到新节点 $U$ 的枝长计算如下：\n$d_{iU} = \\frac{1}{2}d_{ij} + \\frac{1}{2(N-2)}(r_i-r_j)$。\n$$\nd_{AU} = \\frac{1}{2}d_{AB} + \\frac{1}{2(5-2)}(r_A - r_B) = \\frac{1}{2}(2) + \\frac{1}{6}(21.0 - 21.0) = 1.0 \\\\\nd_{BU} = d_{AB} - d_{AU} = 2 - 1.0 = 1.0\n$$\n\n现在我们定义一个新的距离矩阵 $D_1$，包含分类单元 $\\{U, C, D, E\\}$。从 $U$ 到任何其他分类单元 $k$ 的距离计算公式为 $d_{Uk} = \\frac{1}{2}(d_{Ak} + d_{Bk} - d_{AB})$。\n$$\nd_{UC} = \\frac{1}{2}(d_{AC} + d_{BC} - d_{AB}) = \\frac{1}{2}(6.2 + 6.2 - 2) = \\frac{10.4}{2} = 5.2 \\\\\nd_{UD} = \\frac{1}{2}(d_{AD} + d_{BD} - d_{AB}) = \\frac{1}{2}(6.4 + 6.4 - 2) = \\frac{10.8}{2} = 5.4 \\\\\nd_{UE} = \\frac{1}{2}(d_{AE} + d_{BE} - d_{AB}) = \\frac{1}{2}(6.4 + 6.4 - 2) = \\frac{10.8}{2} = 5.4\n$$\n对于 $N=4$ 个分类单元的简化距离矩阵如下：\n$$\nD_1 = \n\\begin{pmatrix}\n  U  C  D  E \\\\\nU  0  5.2  5.4  5.4 \\\\\nC  5.2  0  2.6  2.6 \\\\\nD  5.4  2.6  0  0.8 \\\\\nE  5.4  2.6  0.8  0 \n\\end{pmatrix}\n$$\n\n**步骤 2：对 $N=4$ 个分类单元进行迭代。**\n\n我们对分类单元 $\\{U, C, D, E\\}$ 重复此过程。首先，计算净分歧度 $r'_i$：\n$$\nr'_U = 5.2 + 5.4 + 5.4 = 16.0 \\\\\nr'_C = 5.2 + 2.6 + 2.6 = 10.4 \\\\\nr'_D = 5.4 + 2.6 + 0.8 = 8.8 \\\\\nr'_E = 5.4 + 2.6 + 0.8 = 8.8\n$$\n接下来，计算 $Q'$ 矩阵，其中 $Q'_{ij} = (N-2)d_{ij} - r'_i - r'_j$。对于 $N=4$，公式为 $Q'_{ij} = 2 d_{ij} - r'_i - r'_j$。\n$$\nQ'_{UC} = 2(5.2) - 16.0 - 10.4 = 10.4 - 26.4 = -16.0 \\\\\nQ'_{UD} = 2(5.4) - 16.0 - 8.8 = 10.8 - 24.8 = -14.0 \\\\\nQ'_{UE} = 2(5.4) - 16.0 - 8.8 = 10.8 - 24.8 = -14.0 \\\\\nQ'_{CD} = 2(2.6) - 10.4 - 8.8 = 5.2 - 19.2 = -14.0 \\\\\nQ'_{CE} = 2(2.6) - 10.4 - 8.8 = 5.2 - 19.2 = -14.0 \\\\\nQ'_{DE} = 2(0.8) - 8.8 - 8.8 = 1.6 - 17.6 = -16.0\n$$\n最小值为 $-16.0$，在配对 $(U,C)$ 和 $(D,E)$ 之间出现平局。题目规定，通过选择原始距离 $d_{ij}$ 较小的一对来打破平局。\n我们比较 $d_{UC} = 5.2$ 和 $d_{DE} = 0.8$。由于 $0.8  5.2$，我们选择配对 $(D,E)$ 连接到一个新节点，命名为 $V$。\n\n从 $D$ 和 $E$ 到节点 $V$ 的枝长为：\n$$\nd_{DV} = \\frac{1}{2}d_{DE} + \\frac{1}{2(4-2)}(r'_D - r'_E) = \\frac{1}{2}(0.8) + \\frac{1}{4}(8.8 - 8.8) = 0.4 \\\\\nd_{EV} = d_{DE} - d_{DV} = 0.8 - 0.4 = 0.4\n$$\n我们定义一个新的距离矩阵 $D_2$，包含分类单元 $\\{U, C, V\\}$。涉及 $V$ 的距离如下：\n$$\nd_{VU} = \\frac{1}{2}(d_{DU} + d_{EU} - d_{DE}) = \\frac{1}{2}(5.4 + 5.4 - 0.8) = \\frac{10.0}{2} = 5.0 \\\\\nd_{VC} = \\frac{1}{2}(d_{DC} + d_{EC} - d_{DE}) = \\frac{1}{2}(2.6 + 2.6 - 0.8) = \\frac{4.4}{2} = 2.2\n$$\n\n**步骤 3：对 $N=3$ 个分类单元的最后一步。**\n\n算法在剩下三个分类单元 $\\{U, C, V\\}$ 时终止。它们之间的两两距离定义了围绕一个中心内部节点（命名为 $W$）的最终无根结构。\n$$\nD_2 =\n\\begin{pmatrix}\n  U  C  V \\\\\nU  0  5.2  5.0 \\\\\nC  5.2  0  2.2 \\\\\nV  5.0  2.2  0 \n\\end{pmatrix}\n$$\n连接到节点 $W$ 的三个末端分支的长度由公式 $d_{iW} = \\frac{1}{2}(d_{ij} + d_{ik} - d_{jk})$ 给出。\n$$\nd_{UW} = \\frac{1}{2}(d_{UC} + d_{UV} - d_{CV}) = \\frac{1}{2}(5.2 + 5.0 - 2.2) = \\frac{8.0}{2} = 4.0 \\\\\nd_{CW} = \\frac{1}{2}(d_{CU} + d_{CV} - d_{UV}) = \\frac{1}{2}(5.2 + 2.2 - 5.0) = \\frac{2.4}{2} = 1.2 \\\\\nd_{VW} = \\frac{1}{2}(d_{VU} + d_{VC} - d_{UC}) = \\frac{1}{2}(5.0 + 2.2 - 5.2) = \\frac{2.0}{2} = 1.0\n$$\n\n**步骤 4：总树长计算。**\n\n该无根树由末端分支和内部分支组成。全部分支的长度集合如下：\n\\begin{itemize}\n    \\item 连接到叶节点的末端分支：$d_{AU}=1.0$, $d_{BU}=1.0$, $d_{CW}=1.2$, $d_{DV}=0.4$, $d_{EV}=0.4$。\n    \\item 内部分支：$d_{UW}=4.0$, $d_{VW}=1.0$。\n\\end{itemize}\n总树长 $L$ 是所有分支长度的总和：\n$$\nL = d_{AU} + d_{BU} + d_{CW} + d_{DV} + d_{EV} + d_{UW} + d_{VW}\n$$\n$$\nL = 1.0 + 1.0 + 1.2 + 0.4 + 0.4 + 4.0 + 1.0\n$$\n$$\nL = 9.0\n$$\n重建的无根树的总长度恰好为 $9.0$。", "answer": "$$\\boxed{9}$$", "id": "2837181"}, {"introduction": "基于模型的系统发育学方法，如最大似然法，通过对序列演化过程进行显式建模，已成为现代系统发育分析的标准。其核心是似然值的计算，即在给定特定演化树和演化模型的情况下，观测到现有数据的概率。这项练习 [@problem_id:2837195] 将引导您从第一性原理出发，在一个基础的DNA演化模型——Jukes-Cantor模型下，推导不同位点模式的概率，从而揭开似然值计算的神秘面纱。这将帮助您建立关于统计系统发育学如何量化对演化假说的支持度的直观理解。", "problem": "在 Jukes–Cantor $1969$ (JC$69$) 核苷酸替换模型下，给定一个无根三（$3$）分类单元树。假设一个连续时间马尔可夫链 (CTMC)，其瞬时速率矩阵 $Q$ 满足非对角线速率相等且平稳碱基频率相等，因此对于 $i \\neq j$，有 $Q_{ij} = \\alpha$，$Q_{ii} = -3\\alpha$，并且平稳分布是均匀的，即 $\\pi_{A} = \\pi_{C} = \\pi_{G} = \\pi_{T} = \\frac{1}{4}$。使用常规的 JC$69$ 标度，其中每个位点单位时间内的期望替换数为 $1$，即 $3\\alpha = 1$。考虑一个无根三分类单元星状树，它有一个内部节点，且从该内部节点到每个分类单元的悬挂分支长度 $t$ 均相等。设分支长度为 $t = \\frac{3}{4}\\ln 2$，因此 $t$ 是以每个位点的期望替换数来衡量的。\n\n一个包含三个分类单元的 $N = 1600$ 个独立位点的比对序列，已根据每个位点上观察到的三个分类单元中不同核苷酸的数量，被压缩为以下计数：\n- $n_{1} = 400$ 个位点，其中所有三个核苷酸都相同（$k = 1$ 种不同的核苷酸），\n- $n_{2} = 900$ 个位点，其中恰好有两个核苷酸相同，一个不同（$k = 2$ 种不同的核苷酸），\n- $n_{3} = 300$ 个位点，其中所有三个核苷酸都不同（$k = 3$ 种不同的核苷酸）。\n\n仅使用核心 CTMC 定义 $P(t) = \\exp(Qt)$、上述 JC$69$ 假设以及在单个内部节点上通过对祖先状态求和的剪枝原则，完成以下任务：\n1. 推导每个类别 $k \\in \\{1,2,3\\}$ 的位点模式似然，作为观察到该类别中任意位点的概率，明确地对所有核苷酸身份及其在该类别中对分类单元的分配进行求和（因为数据仅通过不同核苷酸的数量进行总结）。\n2. 使用这些类别概率和位点的独立性，计算压缩数据集的总对数似然（自然对数），\n$$\n\\ln \\mathcal{L} = n_{1}\\ln p_{1} + n_{2}\\ln p_{2} + n_{3}\\ln p_{3}.\n$$\n\n将最终的总对数似然表示为单一的闭合形式解析表达式。不要进行数值近似，最终答案中不要包含任何单位。", "solution": "所述问题具有科学依据、适定、客观且自洽。它呈现了分子系统发育学中一个标准的、尽管简化的场景，该场景基于 Jukes-Cantor 模型，这是该领域的一个基石。所有必需的参数、数据和条件都已提供，并且没有内部矛盾或违反数学或生物学原理。因此，该问题是可解的。\n\n解题过程分三个阶段：首先，在指定的 Jukes-Cantor $1969$ (JC$69$) 模型和分支长度下确定核苷酸转移概率；其次，推导每类位点模式（$k \\in \\{1,2,3\\}$）的概率；第三，使用给定的位点计数计算总对数似然。\n\nJC$69$ 模型的瞬时速率矩阵 $Q$ 由 $Q_{ij} = \\alpha$（对于不同状态 $i \\neq j$）和 $Q_{ii} = -3\\alpha$ 给出。平稳分布是均匀的，对于每个碱基 $b \\in \\{A, C, G, T\\}$，$\\pi_b = 1/4$。该模型经过标度，使得每个位点单位时间内的期望替换数 $-\\sum_b \\pi_b Q_{bb} = -\\sum_b (\\frac{1}{4})(-3\\alpha) = 3\\alpha$ 等于 $1$。这给出了条件 $3\\alpha = 1$，或 $\\alpha = 1/3$。\n\n转移概率矩阵 $P(t) = \\exp(Qt)$ 的元素由以下众所周知的公式给出：\n$$\nP_{ii}(t) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha t) \\quad (\\text{保持在相同状态的概率})\n$$\n$$\nP_{ij}(t) = \\frac{1}{4} - \\frac{1}{4}\\exp(-4\\alpha t) \\quad (\\text{变为某个特定不同状态 } j \\text{ 的概率})\n$$\n问题指定分支长度为 $t = \\frac{3}{4}\\ln 2$。我们计算指数项：\n$$\n-4\\alpha t = -4\\left(\\frac{1}{3}\\right)\\left(\\frac{3}{4}\\ln 2\\right) = -\\ln 2\n$$\n因此，$\\exp(-4\\alpha t) = \\exp(-\\ln 2) = 1/2$。将此值代入转移概率公式，得到：\n$$\np_{same} \\equiv P_{ii}(t) = \\frac{1}{4} + \\frac{3}{4}\\left(\\frac{1}{2}\\right) = \\frac{1}{4} + \\frac{3}{8} = \\frac{5}{8}\n$$\n$$\np_{diff} \\equiv P_{ij}(t) = \\frac{1}{4} - \\frac{1}{4}\\left(\\frac{1}{2}\\right) = \\frac{1}{4} - \\frac{1}{8} = \\frac{1}{8}\n$$\n对于无根三分类单元星状树，我们通过将树的根定在中心内部节点上（状态为 $x_0$），并对所有可能的祖先状态求和，来计算在三个分类单元上观察到状态 $(x_1, x_2, x_3)$ 的似然。JC$69$ 模型的时间可逆性证明了这种做法是合理的。祖先状态的概率是其平稳频率，即 $\\pi_{x_0} = 1/4$。\n$$\nL(x_1, x_2, x_3) = \\sum_{x_0 \\in \\{A,C,G,T\\}} \\pi_{x_0} P_{x_0, x_1}(t) P_{x_0, x_2}(t) P_{x_0, x_3}(t) = \\frac{1}{4} \\sum_{x_0} P_{x_0, x_1}(t) P_{x_0, x_2}(t) P_{x_0, x_3}(t)\n$$\n现在我们通过对属于每个类别（$k=1, 2, 3$）的所有位点模式的似然求和，来推导该类别的概率。\n\n对于 $k=1$，所有三个核苷酸都相同（例如，$A,A,A$）。共有 $4$ 种这样的模式。根据对称性，它们的概率相等。让我们计算 $(A,A,A)$ 的情况：\n$$\nL(A,A,A) = \\frac{1}{4} \\left( P_{A,A}^3 + P_{C,A}^3 + P_{G,A}^3 + P_{T,A}^3 \\right) = \\frac{1}{4} \\left( p_{same}^3 + 3p_{diff}^3 \\right)\n$$\n类别 $k=1$ 的总概率是 $p_1$：\n$$\np_1 = 4 \\times L(A,A,A) = p_{same}^3 + 3p_{diff}^3 = \\left(\\frac{5}{8}\\right)^3 + 3\\left(\\frac{1}{8}\\right)^3 = \\frac{125}{512} + \\frac{3}{512} = \\frac{128}{512} = \\frac{1}{4}\n$$\n\n对于 $k=2$，两个核苷酸相同，一个不同（例如，$A,A,C$）。这种模式的数量可以通过选择多数核苷酸（$4$ 种方式）、少数核苷酸（$3$ 种方式）以及少数核苷酸的位置（$3$ 种方式）来计算，总共有 $4 \\times 3 \\times 3 = 36$ 种模式。根据对称性，所有这些模式的概率都相等。对于 $(A,A,C)$：\n$$\nL(A,A,C) = \\frac{1}{4} \\left( P_{A,A}^2 P_{A,C} + P_{C,A}^2 P_{C,C} + P_{G,A}^2 P_{G,C} + P_{T,A}^2 P_{T,C} \\right)\n= \\frac{1}{4} \\left( p_{same}^2 p_{diff} + p_{same} p_{diff}^2 + 2p_{diff}^3 \\right)\n$$\n类别 $k=2$ 的总概率是 $p_2$：\n$$\np_2 = 36 \\times L(A,A,C) = 9 \\left( p_{same}^2 p_{diff} + p_{same} p_{diff}^2 + 2p_{diff}^3 \\right)\n= 9 \\left( \\left(\\frac{5}{8}\\right)^2 \\frac{1}{8} + \\frac{5}{8} \\left(\\frac{1}{8}\\right)^2 + 2\\left(\\frac{1}{8}\\right)^3 \\right) = \\frac{9}{512}(25 + 5 + 2) = \\frac{9 \\times 32}{512} = \\frac{288}{512} = \\frac{9}{16}\n$$\n\n对于 $k=3$，所有三个核苷酸都不同（例如，$A,C,G$）。这种模式的数量可以通过从 4 个核苷酸中选择 3 个（$\\binom{4}{3}=4$ 种方式）并对它们进行排列（$3! = 6$ 种方式）来计算，总共有 $4 \\times 6 = 24$ 种模式。对于 $(A,C,G)$：\n$$\nL(A,C,G) = \\frac{1}{4} \\left( P_{A,A}P_{A,C}P_{A,G} + P_{C,A}P_{C,C}P_{C,G} + P_{G,A}P_{G,C}P_{G,G} + P_{T,A}P_{T,C}P_{T,G} \\right)\n= \\frac{1}{4} \\left( 3 p_{same} p_{diff}^2 + p_{diff}^3 \\right)\n$$\n类别 $k=3$ 的总概率是 $p_3$：\n$$\np_3 = 24 \\times L(A,C,G) = 6 \\left( 3 p_{same} p_{diff}^2 + p_{diff}^3 \\right)\n= 6 \\left( 3 \\frac{5}{8} \\left(\\frac{1}{8}\\right)^2 + \\left(\\frac{1}{8}\\right)^3 \\right) = \\frac{6}{512}(15+1) = \\frac{6 \\times 16}{512} = \\frac{96}{512} = \\frac{3}{16}\n$$\n按要求，概率和为 1：$p_1+p_2+p_3 = \\frac{1}{4} + \\frac{9}{16} + \\frac{3}{16} = \\frac{4}{16} + \\frac{9}{16} + \\frac{3}{16} = \\frac{16}{16} = 1$。\n\n最后，我们使用给定的计数 $n_1=400$，$n_2=900$，$n_3=300$ 来计算总对数似然 $\\ln \\mathcal{L}$。\n$$\n\\ln \\mathcal{L} = n_{1}\\ln p_{1} + n_{2}\\ln p_{2} + n_{3}\\ln p_{3}\n= 400 \\ln\\left(\\frac{1}{4}\\right) + 900 \\ln\\left(\\frac{9}{16}\\right) + 300 \\ln\\left(\\frac{3}{16}\\right)\n$$\n使用对数性质 $\\ln(a/b) = \\ln a - \\ln b$ 和 $\\ln(x^y) = y \\ln x$：\n$$\n\\ln(\\frac{1}{4}) = -\\ln(4) = -2\\ln 2\n$$\n$$\n\\ln(\\frac{9}{16}) = \\ln(9) - \\ln(16) = \\ln(3^2) - \\ln(2^4) = 2\\ln 3 - 4\\ln 2\n$$\n$$\n\\ln(\\frac{3}{16}) = \\ln(3) - \\ln(16) = \\ln 3 - 4\\ln 2\n$$\n将这些表达式代入对数似然方程：\n$$\n\\ln \\mathcal{L} = 400(-2\\ln 2) + 900(2\\ln 3 - 4\\ln 2) + 300(\\ln 3 - 4\\ln 2)\n$$\n$$\n\\ln \\mathcal{L} = -800\\ln 2 + 1800\\ln 3 - 3600\\ln 2 + 300\\ln 3 - 1200\\ln 2\n$$\n合并关于 $\\ln 2$ 和 $\\ln 3$ 的项：\n$$\n\\ln \\mathcal{L} = (1800 + 300)\\ln 3 + (-800 - 3600 - 1200)\\ln 2\n$$\n$$\n\\ln \\mathcal{L} = 2100\\ln 3 - 5600\\ln 2\n$$\n这个表达式可以进一步简化：\n$$\n\\ln \\mathcal{L} = 700(3\\ln 3 - 8\\ln 2) = 700(\\ln(3^3) - \\ln(2^8)) = 700(\\ln(27) - \\ln(256)) = 700\\ln\\left(\\frac{27}{256}\\right)\n$$", "answer": "$$\n\\boxed{700\\ln\\left(\\frac{27}{256}\\right)}\n$$", "id": "2837195"}]}