{"hands_on_practices": [{"introduction": "在检验群体是否偏离哈代-温伯格平衡之前，我们首先必须掌握如何根据观测数据计算平衡状态下的期望基因型频率。本练习将通过一个基础的双等位基因案例，指导您完成这一核心步骤。您将学习如何使用最大似然估计法从样本数据中估算等位基因频率（$\\hat{p}$），并依此计算出在哈代-温伯格平衡（HWE）模型下的期望基因型数量，为后续的拟合优度检验奠定基础([@problem_id:2858615])。", "problem": "一个二倍体基因座有两个等位基因，记为 $A$ 和 $a$。从一个世代不重叠、无迁移、无突变、无选择的大型随机交配群体中，随机抽取了 $N=100$ 个无亲缘关系的个体，观察到的基因型计数为 $n_{AA}=30$，$n_{Aa}=50$ 和 $n_{aa}=20$。假设个体抽样是独立的，且该群体满足哈代-温伯格定律的假设，因此基因型概率可以通过等位基因 $A$ 的频率 $p$（以及 $q=1-p$）这一个参数来表示。\n\n仅从二倍体样本中等位基因频率的核心定义以及哈代-温伯格定律假设（无近亲繁殖、无选择性交配、配子随机结合）下的基因型计数多项式抽样模型出发，完成以下任务：\n\n1. 在哈代-温伯格模型下，写出观察到的基因型计数关于等位基因频率 $p$ 的似然函数，并通过最大化该似然函数来推导出最大似然估计量 $\\hat{p}$（用 $n_{AA}$，$n_{Aa}$，$n_{aa}$ 和 $N$ 表示）。然后根据上述数据计算其数值。\n2. 使用您的估计量 $\\hat{p}$，计算在 $N=100$ 的情况下，哈代-温伯格定律预期的基因型计数 $\\mathbb{E}_{H}[\\text{AA}]$、$\\mathbb{E}_{H}[\\text{Aa}]$ 和 $\\mathbb{E}_{H}[\\text{aa}]$。\n3. 对每种基因型，计算残差 $O-E$，其中 $O$ 是观察到的计数，$E$ 是第2部分中相应的哈代-温伯格定律预期计数。\n\n按顺序 $\\left(\\hat{p}, \\mathbb{E}_{H}[\\text{AA}], \\mathbb{E}_{H}[\\text{Aa}], \\mathbb{E}_{H}[\\text{aa}], (O-E)_{\\text{AA}}, (O-E)_{\\text{Aa}}, (O-E)_{\\text{aa}}\\right)$ 提供您的最终数值结果。不要四舍五入；在适当的情况下，以有限小数或分数的形式报告精确值。", "solution": "该问题陈述已经过严格验证。它内容完整，科学上基于群体遗传学原理，并且在数学上是适定的。所提供的数据 $n_{AA}=30$，$n_{Aa}=50$ 和 $n_{aa}=20$ 是一致的，因为它们的总和为 $N=100$。因此，该问题被认为是有效的，并将提供解答。\n\n该问题需要一个分三部分的解答：等位基因频率最大似然估计的推导和计算，哈代-温伯格平衡（HWE）下预期基因型计数的计算，以及残差的计算。\n\n第1部分：等位基因频率 $p$ 的最大似然估计量 (MLE)。\n在哈代-温伯格定律的假设下，对于一个有两个等位基因 $A$ 和 $a$（其频率分别为 $p$ 和 $q=1-p$）的基因座，预期的基因型频率为：\n$$\nP(AA) = p^2 \\\\\nP(Aa) = 2pq = 2p(1-p) \\\\\nP(aa) = q^2 = (1-p)^2\n$$\n在大小为 $N$ 的样本中，观察到的基因型计数 $(n_{AA}, n_{Aa}, n_{aa})$ 假定遵循一个多项式分布，其参数为 $N$ 和上述基因型概率。似然函数 $L(p)$ 与该分布的概率质量函数成正比：\n$$\nL(p | n_{AA}, n_{Aa}, n_{aa}) \\propto [P(AA)]^{n_{AA}} [P(Aa)]^{n_{Aa}} [P(aa)]^{n_{aa}}\n$$\n代入HWE概率，我们得到：\n$$\nL(p) \\propto (p^2)^{n_{AA}} (2p(1-p))^{n_{Aa}} ((1-p)^2)^{n_{aa}}\n$$\n为了找到使该函数最大化的 $p$ 值，使用对数似然函数 $\\ell(p) = \\ln(L(p))$ 会更方便：\n$$\n\\ell(p) = \\text{constant} + n_{AA} \\ln(p^2) + n_{Aa} \\ln(2p(1-p)) + n_{aa} \\ln((1-p)^2)\n$$\n利用对数的性质，这可以简化为：\n$$\n\\ell(p) = \\text{constant} + 2n_{AA} \\ln(p) + n_{Aa}(\\ln(p) + \\ln(1-p)) + 2n_{aa} \\ln(1-p)\n$$\n收集与 $\\ln(p)$ 和 $\\ln(1-p)$ 相关的项：\n$$\n\\ell(p) = \\text{constant} + (2n_{AA} + n_{Aa}) \\ln(p) + (n_{Aa} + 2n_{aa}) \\ln(1-p)\n$$\n为了求最大值，我们将 $\\ell(p)$ 对 $p$ 求导，并令其等于零：\n$$\n\\frac{d\\ell}{dp} = \\frac{2n_{AA} + n_{Aa}}{p} - \\frac{n_{Aa} + 2n_{aa}}{1-p} = 0\n$$\n求解 $p$：\n$$\n\\frac{2n_{AA} + n_{Aa}}{p} = \\frac{n_{Aa} + 2n_{aa}}{1-p}\n$$\n$$\n(1-p)(2n_{AA} + n_{Aa}) = p(n_{Aa} + 2n_{aa})\n$$\n$$\n2n_{AA} + n_{Aa} - p(2n_{AA} + n_{Aa}) = p(n_{Aa} + 2n_{aa})\n$$\n$$\n2n_{AA} + n_{Aa} = p(2n_{AA} + n_{Aa} + n_{Aa} + 2n_{aa})\n$$\n$$\n2n_{AA} + n_{Aa} = p(2n_{AA} + 2n_{Aa} + 2n_{aa})\n$$\n括号中的项是 $2(n_{AA} + n_{Aa} + n_{aa}) = 2N$。因此：\n$$\n2n_{AA} + n_{Aa} = p(2N)\n$$\n$p$ 的最大似然估计量，记为 $\\hat{p}$，是：\n$$\n\\hat{p} = \\frac{2n_{AA} + n_{Aa}}{2N}\n$$\n这就是“基因计数”法：分子是样本中 $A$ 等位基因的总数，分母是所有等位基因的总数。\n使用所提供的数据，$N=100$，$n_{AA}=30$，$n_{Aa}=50$：\n$$\n\\hat{p} = \\frac{2(30) + 50}{2(100)} = \\frac{60 + 50}{200} = \\frac{110}{200} = 0.55\n$$\n\n第2部分：预期的HWE基因型计数。\n使用MLE $\\hat{p} = 0.55$，等位基因 $a$ 的估计频率为 $\\hat{q} = 1 - \\hat{p} = 1 - 0.55 = 0.45$。\n预期基因型计数（$E$）通过将样本量 $N$ 乘以估计的HWE基因型频率来计算：\n$$\n\\mathbb{E}_{H}[\\text{AA}] = N \\times \\hat{p}^2 = 100 \\times (0.55)^2 = 100 \\times 0.3025 = 30.25\n$$\n$$\n\\mathbb{E}_{H}[\\text{Aa}] = N \\times 2\\hat{p}\\hat{q} = 100 \\times 2 \\times 0.55 \\times 0.45 = 100 \\times 0.495 = 49.5\n$$\n$$\n\\mathbb{E}_{H}[\\text{aa}] = N \\times \\hat{q}^2 = 100 \\times (0.45)^2 = 100 \\times 0.2025 = 20.25\n$$\n预期计数的总和为 $30.25 + 49.5 + 20.25 = 100$，这与 $N$ 相等，符合要求。\n\n第3部分：残差（$O-E$）的计算。\n残差是观察到的计数（$O$）与预期计数（$E$）之间的差值。\n观察到的计数为 $n_{AA} = 30$，$n_{Aa} = 50$ 和 $n_{aa} = 20$。\n$$\n(O-E)_{\\text{AA}} = 30 - 30.25 = -0.25\n$$\n$$\n(O-E)_{\\text{Aa}} = 50 - 49.5 = 0.5\n$$\n$$\n(O-E)_{\\text{aa}} = 20 - 20.25 = -0.25\n$$\n残差的总和为 $-0.25 + 0.5 - 0.25 = 0$，这是必然的结果。\n\n最终的数值结果按要求的顺序呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.55  30.25  49.5  20.25  -0.25  0.5  -0.25\n\\end{pmatrix}\n}\n$$", "id": "2858615"}, {"introduction": "哈代-温伯格定律的原理不仅限于简单的双等位基因系统，同样适用于更普遍的多等位基因座。本练习将您的技能从双等位基因系统扩展到更为复杂的三等位基因座情景([@problem_id:2858606])。您将发现，无论是等位基因频率的估算还是期望基因型频率的计算，其核心逻辑与双等位基因系统并无二致，最终通过计算皮尔逊卡方（$\\chi^2$）统计量来量化观测数据与HWE期望之间的偏差。", "problem": "在一个二倍体种群中，对一个具有等位基因 $A$、$B$ 和 $C$ 的三等位基因常染色体基因座进行抽样。观察到的基因型计数为 $n_{AA}=30$、$n_{AB}=12$、$n_{AC}=8$、$n_{BB}=25$、$n_{BC}=15$ 和 $n_{CC}=10$，总共有 $N$ 个个体。假设这是一个封闭、无限大、随机交配、世代不重叠的种群，没有选择、突变和迁移；在这些假设下，哈迪-温伯格定律意味着种群中的基因型频率完全由等位基因频率决定。\n\n从适用于群体遗传学和多项式抽样中基于似然推断的基本原理出发，完成以下任务：\n- 根据观察到的基因型计数，推导出等位基因频率的最大似然估计量 $\\hat{p}_A$、$\\hat{p}_B$ 和 $\\hat{p}_C$。\n- 使用这些估计值和哈迪-温伯格定律，获得所有六种基因型在平衡状态下的相应预期基因型计数。\n- 构建皮尔逊卡方拟合优度统计量，用于比较哈迪-温伯格平衡（HWE）下观察到的计数与预期计数，不应用任何连续性校正。\n\n最终数值答案仅报告卡方统计量。将最终答案四舍五入至四位有效数字。", "solution": "该问题要求推导和计算皮尔逊卡方统计量，以检验一个具有单个常染色体基因座上三个等位基因的二倍体种群是否处于哈迪-温伯格平衡（HWE）。我们必须首先验证问题陈述。\n\n问题给出了以下已知条件：\n- 一个二倍体种群。\n- 一个具有等位基因 $A$、$B$ 和 $C$ 的三等位基因常染色体基因座。\n- 观察到的基因型计数：$n_{AA}=30$、$n_{AB}=12$、$n_{AC}=8$、$n_{BB}=25$、$n_{BC}=15$ 和 $n_{CC}=10$。\n- 假设的种群模型：封闭、无限大、随机交配、世代不重叠，且无选择、突变或迁移。\n\n该问题具有科学依据、提法明确、客观且自洽。它描述了群体遗传学中的一个标准情景，并要求进行一项标准的统计检验。数据对于该任务是完整和一致的。这些假设虽然是理想化的，但正是定义哈迪-温伯格原理的条件，构成了待检验的原假设的基础。因此，该问题被认为是有效的。\n\n我们按照要求分三部分进行解答。\n\n首先，我们推导等位基因频率 $p_A$、$p_B$ 和 $p_C$ 的最大似然估计量（MLE）。样本中的个体总数是 $N = n_{AA} + n_{AB} + n_{AC} + n_{BB} + n_{BC} + n_{CC}$。使用给定的计数，$N = 30 + 12 + 8 + 25 + 15 + 10 = 100$。样本中的等位基因总数是 $2N = 200$。\n\n在 HWE 下，观察到每种基因型的概率是等位基因频率的函数：\n$P(AA) = p_A^2$\n$P(AB) = 2p_A p_B$\n$P(AC) = 2p_A p_C$\n$P(BB) = p_B^2$\n$P(BC) = 2p_B p_C$\n$P(CC) = p_C^2$\n\n观察到给定基因型计数的可能性由多项式概率分布描述。似然函数 $L$ 与这些概率的乘积成正比，每个概率都取其相应观察计数的幂次方：\n$$L(p_A, p_B, p_C | \\text{data}) \\propto (p_A^2)^{n_{AA}} (2p_A p_B)^{n_{AB}} (2p_A p_C)^{n_{AC}} (p_B^2)^{n_{BB}} (2p_B p_C)^{n_{BC}} (p_C^2)^{n_{CC}}$$\n为了便于最大化，我们使用对数似然函数 $\\ln L$，忽略常数项：\n$$\\ln L = n_{AA}\\ln(p_A^2) + n_{AB}\\ln(2p_A p_B) + n_{AC}\\ln(2p_A p_C) + n_{BB}\\ln(p_B^2) + n_{BC}\\ln(2p_B p_C) + n_{CC}\\ln(p_C^2)$$\n$$\\ln L = 2n_{AA}\\ln(p_A) + n_{AB}(\\ln(p_A) + \\ln(p_B)) + n_{AC}(\\ln(p_A) + \\ln(p_C)) + 2n_{BB}\\ln(p_B) + n_{BC}(\\ln(p_B) + \\ln(p_C)) + 2n_{CC}\\ln(p_C) + \\text{constant}$$\n按等位基因频率对各项进行分组：\n$$\\ln L = (2n_{AA} + n_{AB} + n_{AC})\\ln(p_A) + (n_{AB} + 2n_{BB} + n_{BC})\\ln(p_B) + (n_{AC} + n_{BC} + 2n_{CC})\\ln(p_C) + \\text{constant}$$\n系数是样本中每种等位基因的总计数。设 $c_A$、$c_B$ 和 $c_C$ 分别表示等位基因 $A$、$B$ 和 $C$ 的计数。\n$c_A = 2n_{AA} + n_{AB} + n_{AC}$\n$c_B = 2n_{BB} + n_{AB} + n_{BC}$\n$c_C = 2n_{CC} + n_{AC} + n_{BC}$\n等位基因总数是 $c_A + c_B + c_C = 2N$。对数似然函数简化为：\n$$\\ln L = c_A \\ln(p_A) + c_B \\ln(p_B) + c_C \\ln(p_C) + \\text{constant}$$\n我们必须在约束条件 $p_A + p_B + p_C = 1$ 下最大化此函数。这是一个标准的优化问题，其解为 MLE 是样本中每个等位基因的相对频率。这被称为等位基因计数法。\n$$\\hat{p}_A = \\frac{c_A}{2N}, \\quad \\hat{p}_B = \\frac{c_B}{2N}, \\quad \\hat{p}_C = \\frac{c_C}{2N}$$\n使用给定的基因型计数：\n$c_A = 2(30) + 12 + 8 = 60 + 12 + 8 = 80$\n$c_B = 2(25) + 12 + 15 = 50 + 12 + 15 = 77$\n$c_C = 2(10) + 8 + 15 = 20 + 8 + 15 = 43$\n我们检查 $c_A + c_B + c_C = 80 + 77 + 43 = 200 = 2N$。\n等位基因频率的 MLE 为：\n$\\hat{p}_A = \\frac{80}{200} = 0.4$\n$\\hat{p}_B = \\frac{77}{200} = 0.385$\n$\\hat{p}_C = \\frac{43}{200} = 0.215$\n我们检查 $\\hat{p}_A + \\hat{p}_B + \\hat{p}_C = 0.4 + 0.385 + 0.215 = 1.0$。\n\n第二，我们使用这些估计的等位基因频率计算 HWE 下的预期基因型计数。某种基因型的预期计数是总个体数 $N$ 乘以 HWE 下的预期基因型频率。\n$E_{AA} = N \\hat{p}_A^2 = 100 \\times (0.4)^2 = 100 \\times 0.16 = 16$\n$E_{AB} = N (2\\hat{p}_A \\hat{p}_B) = 100 \\times 2 \\times 0.4 \\times 0.385 = 100 \\times 0.308 = 30.8$\n$E_{AC} = N (2\\hat{p}_A \\hat{p}_C) = 100 \\times 2 \\times 0.4 \\times 0.215 = 100 \\times 0.172 = 17.2$\n$E_{BB} = N \\hat{p}_B^2 = 100 \\times (0.385)^2 = 100 \\times 0.148225 = 14.8225$\n$E_{BC} = N (2\\hat{p}_B \\hat{p}_C) = 100 \\times 2 \\times 0.385 \\times 0.215 = 100 \\times 0.16555 = 16.555$\n$E_{CC} = N \\hat{p}_C^2 = 100 \\times (0.215)^2 = 100 \\times 0.046225 = 4.6225$\n\n第三，我们构建皮尔逊卡方统计量 $\\chi^2$。该统计量衡量所有基因型类别中观察计数（$O_i$）和预期计数（$E_i$）之间的差异。\n$$\\chi^2 = \\sum_{i \\in \\{\\text{genotypes}\\}} \\frac{(O_i - E_i)^2}{E_i}$$\n观察计数（$O_i$）为 $n_{AA}=30, n_{AB}=12, n_{AC}=8, n_{BB}=25, n_{BC}=15, n_{CC}=10$。\n我们计算每种基因型的贡献：\n$AA$ 项：$\\frac{(30 - 16)^2}{16} = \\frac{14^2}{16} = \\frac{196}{16} = 12.25$\n$AB$ 项：$\\frac{(12 - 30.8)^2}{30.8} = \\frac{(-18.8)^2}{30.8} = \\frac{353.44}{30.8} \\approx 11.47532$\n$AC$ 项：$\\frac{(8 - 17.2)^2}{17.2} = \\frac{(-9.2)^2}{17.2} = \\frac{84.64}{17.2} \\approx 4.92093$\n$BB$ 项：$\\frac{(25 - 14.8225)^2}{14.8225} = \\frac{(10.1775)^2}{14.8225} \\approx \\frac{103.5815}{14.8225} \\approx 6.98813$\n$BC$ 项：$\\frac{(15 - 16.555)^2}{16.555} = \\frac{(-1.555)^2}{16.555} = \\frac{2.418025}{16.555} \\approx 0.14606$\n$CC$ 项：$\\frac{(10 - 4.6225)^2}{4.6225} = \\frac{(5.3775)^2}{4.6225} \\approx \\frac{28.9175}{4.6225} \\approx 6.25595$\n将这些贡献相加得到最终的 $\\chi^2$ 值：\n$$\\chi^2 \\approx 12.25 + 11.47532 + 4.92093 + 6.98813 + 0.14606 + 6.25595$$\n$$\\chi^2 \\approx 42.03639$$\n四舍五入到四位有效数字，皮尔逊卡方统计量为 $42.04$。该检验的自由度是基因型类别数 $k=6$，减去 $1$，再减去从数据中估计的独立等位基因频率数，即 $2$（因为 $p_A$、$p_B$ 决定了 $p_C$）。因此，$df = k - 1 - 2 = 6 - 1 - 2 = 3$。计算出的 $\\chi^2$ 值 $42.04$ 对于 $3$ 个自由度来说非常大，表明与哈迪-温伯格平衡存在显著偏差。然而，问题只要求报告统计量本身。", "answer": "$$\\boxed{42.04}$$", "id": "2858606"}, {"introduction": "虽然卡方检验在群体遗传学中应用广泛，但其有效性依赖于大样本近似。当样本量较小或涉及稀有等位基因时，卡方检验的近似结果可能不再可靠。本高级练习将深入探讨HWE精确检验的原理与计算过程，这是一种无需大样本假设的统计方法([@problem_id:2858627])。通过从第一性原理出发，枚举所有可能的基因型组合并计算其条件概率，您将对遗传学中的假设检验获得更深刻的理解，并掌握处理小样本数据的关键技能。", "problem": "考虑一个二倍体种群中具有两个等位基因 $A$ 和 $a$ 的基因座。令 $N$ 表示进行基因分型的二倍体个体数，令 $M$ 表示在 $2N$ 条染色体上观察到的 $A$ 等位基因的总数。假设该种群遵循哈迪-温伯格平衡 (HWE) 模型，这意味着在基因库中等位基因随机结合形成基因型，且基因型概率仅由等位基因频率决定。你将利用此配子随机结合原理，在给定 $M$ 和 $N$ 的条件下，推导基因型计数的条件分布，然后通过以 $M$ 为条件对HWE进行精确检验。\n\n在一个包含 $N=10$ 个二倍体个体的样本中，假设在 $2N=20$ 个基因拷贝中观察到正好 $M=10$ 个 $A$ 等位基因拷贝。仅使用配子随机结合原理和标准组合学，完成以下任务：\n\n1. 列举所有与 $N=10$ 和 $M=10$ 一致的可能基因型计数三元组 $(n_{AA}, n_{Aa}, n_{aa})$。\n2. 在以 $M=10$ 和 $N=10$ 为条件下，从第一性原理出发，推导在HWE下每个容许三元组的条件抽样概率。\n3. 假设观测样本为 $(n_{AA}, n_{Aa}, n_{aa}) = (4, 2, 4)$。使用经典的基于概率的精确检验（该检验以 $M$ 为条件，并对所有条件概率小于或等于观测构型条件概率的构型，将其条件概率求和），计算精确检验的 $p$ 值。\n\n以小数形式提供最终答案，即单个 $p$ 值。将你的答案四舍五入到四位有效数字。", "solution": "该问题提出了一个在种群遗传学中有效且良定的问题，具体涉及哈迪-温伯格平衡 (HWE) 的精确检验。我们将按照指定的三个步骤进行。\n\n首先，我们列举所有与给定总个体数 $N=10$ 和 $A$ 等位基因总数 $M=10$ 一致的可能基因型计数构型 $(n_{AA}, n_{Aa}, n_{aa})$。这些计数必须满足两个线性丢番图方程：\n$$n_{AA} + n_{Aa} + n_{aa} = N = 10$$\n$$2n_{AA} + n_{Aa} = M = 10$$\n变量 $n_{AA}, n_{Aa}, n_{aa}$ 必须是非负整数。从第二个方程，我们可以将杂合子数 $n_{Aa}$ 表示为 $A$ 等位基因纯合子数 $n_{AA}$ 的函数：\n$$n_{Aa} = 10 - 2n_{AA}$$\n由于 $n_{Aa}$ 必须为非负数，所以 $10 - 2n_{AA} \\geq 0$，这意味着 $2n_{AA} \\leq 10$，即 $n_{AA} \\leq 5$。因此，$n_{AA}$ 可以取从 $0$ 到 $5$ 的整数值。对于 $n_{AA}$ 的每个值，我们可以使用第一个方程 $n_{aa} = 10 - n_{AA} - n_{Aa}$ 来确定 $n_{Aa}$ 和 $n_{aa}$ 的唯一对应值。这得到了 $6$ 种可能的基因型计数构型的完整集合：\n1. 如果 $n_{AA}=0$，则 $n_{Aa}=10 - 2(0) = 10$，且 $n_{aa}=10 - 0 - 10 = 0$。构型：$(0, 10, 0)$。\n2. 如果 $n_{AA}=1$，则 $n_{Aa}=10 - 2(1) = 8$，且 $n_{aa}=10 - 1 - 8 = 1$。构型：$(1, 8, 1)$。\n3. 如果 $n_{AA}=2$，则 $n_{Aa}=10 - 2(2) = 6$，且 $n_{aa}=10 - 2 - 6 = 2$。构型：$(2, 6, 2)$。\n4. 如果 $n_{AA}=3$，则 $n_{Aa}=10 - 2(3) = 4$，且 $n_{aa}=10 - 3 - 4 = 3$。构型：$(3, 4, 3)$。\n5. 如果 $n_{AA}=4$，则 $n_{Aa}=10 - 2(4) = 2$，且 $n_{aa}=10 - 4 - 2 = 4$。构型：$(4, 2, 4)$。\n6. 如果 $n_{AA}=5$，则 $n_{Aa}=10 - 2(5) = 0$，且 $n_{aa}=10 - 5 - 0 = 5$。构型：$(5, 0, 5)$。\n\n第二，我们推导在HWE下，对于任何给定的构型 $(n_{AA}, n_{Aa}, n_{aa})$，以观测到的总等位基因数 $M$ 为条件的条件抽样概率。在一个大小为 $N$ 的样本中，给定 $A$ 等位基因的频率为 $p$，观测到一组特定基因型计数的概率遵循多项分布：\n$$P(n_{AA}, n_{Aa}, n_{aa} | N, p) = \\frac{N!}{n_{AA}! n_{Aa}! n_{aa}!} (p^2)^{n_{AA}} (2p(1-p))^{n_{Aa}} ((1-p)^2)^{n_{aa}}$$\n这可以通过对包含 $p$ 和 $(1-p)$ 的项进行分组来重写：\n$$P(n_{AA}, n_{Aa}, n_{aa} | N, p) = \\frac{N! 2^{n_{Aa}}}{n_{AA}! n_{Aa}! n_{aa}!} p^{2n_{AA} + n_{Aa}} (1-p)^{n_{Aa} + 2n_{aa}}$$\n指数对应于 $A$ 和 $a$ 等位基因的总数。令 $M = 2n_{AA} + n_{Aa}$ 为 $A$ 等位基因的计数，令 $2N-M = n_{Aa} + 2n_{aa}$ 为 $a$ 等位基因的计数。在一个包含 $2N$ 个基因拷贝的样本中，观测到 $M$ 个 $A$ 等位基因拷贝的概率由二项分布给出：\n$$P(M | N, p) = \\binom{2N}{M} p^M (1-p)^{2N-M}$$\n在给定 $N$ 和 $M$ 的情况下，基因型计数的条件概率是比率 $P(\\text{计数} | N, p) / P(M | N, p)$。包含未知频率 $p$ 的项会消去，从而得到精确概率：\n$$P(n_{AA}, n_{Aa}, n_{aa} | N, M) = \\frac{\\frac{N! 2^{n_{Aa}}}{n_{AA}! n_{Aa}! n_{aa}!} p^M (1-p)^{2N-M}}{\\binom{2N}{M} p^M (1-p)^{2N-M}} = \\frac{N! 2^{n_{Aa}}}{n_{AA}! n_{Aa}! n_{aa}!} \\frac{1}{\\binom{2N}{M}}$$\n对于本问题，$N=10$, $M=10$，因此 $2N=20$。分母中的组合常数是 $\\binom{20}{10} = \\frac{20!}{10!10!} = 184756$。\n我们计算这 $6$ 种构型中每一种的概率：\n1.  $P_1 = P(0, 10, 0) = \\frac{10! \\cdot 2^{10}}{0! \\cdot 10! \\cdot 0!} \\cdot \\frac{1}{184756} = \\frac{1024}{184756}$。\n2.  $P_2 = P(1, 8, 1) = \\frac{10! \\cdot 2^8}{1! \\cdot 8! \\cdot 1!} \\cdot \\frac{1}{184756} = \\frac{90 \\cdot 256}{184756} = \\frac{23040}{184756}$。\n3.  $P_3 = P(2, 6, 2) = \\frac{10! \\cdot 2^6}{2! \\cdot 6! \\cdot 2!} \\cdot \\frac{1}{184756} = \\frac{1260 \\cdot 64}{184756} = \\frac{80640}{184756}$。\n4.  $P_4 = P(3, 4, 3) = \\frac{10! \\cdot 2^4}{3! \\cdot 4! \\cdot 3!} \\cdot \\frac{1}{184756} = \\frac{4200 \\cdot 16}{184756} = \\frac{67200}{184756}$。\n5.  $P_5 = P(4, 2, 4) = \\frac{10! \\cdot 2^2}{4! \\cdot 2! \\cdot 4!} \\cdot \\frac{1}{184756} = \\frac{3150 \\cdot 4}{184756} = \\frac{12600}{184756}$。\n6.  $P_6 = P(5, 0, 5) = \\frac{10! \\cdot 2^0}{5! \\cdot 0! \\cdot 5!} \\cdot \\frac{1}{184756} = \\frac{252 \\cdot 1}{184756} = \\frac{252}{184756}$。\n\n第三，我们计算精确检验的 $p$ 值。观测样本为 $(n_{AA}, n_{Aa}, n_{aa}) = (4, 2, 4)$，其概率为 $P_{obs} = P_5 = \\frac{12600}{184756}$。$p$ 值是所有概率小于或等于 $P_{obs}$ 的构型的概率之和。我们将各个概率的分子与 $P_5$ 的分子 $12600$ 进行比较：\n- $P_1$: $1024 \\leq 12600$\n- $P_2$: $23040 > 12600$\n- $P_3$: $80640 > 12600$\n- $P_4$: $67200 > 12600$\n- $P_5$: $12600 \\leq 12600$\n- $P_6$: $252 \\leq 12600$\n满足条件 $P_i \\leq P_5$ 的构型是 $(0, 10, 0)$、$(4, 2, 4)$ 和 $(5, 0, 5)$。$p$ 值是它们概率的总和：\n$$p\\text{-value} = P_1 + P_5 + P_6 = \\frac{1024}{184756} + \\frac{12600}{184756} + \\frac{252}{184756}$$\n$$p\\text{-value} = \\frac{1024 + 12600 + 252}{184756} = \\frac{13876}{184756} \\approx 0.075103998$$\n将此值四舍五入到四位有效数字，得到 $0.07510$。", "answer": "$$\\boxed{0.07510}$$", "id": "2858627"}]}