{"hands_on_practices": [{"introduction": "多效性，特别是一个基因同时具有有利和有害效应的拮抗性多效性，是衰老进化理论的核心。这个练习将指导你通过构建一个简单的年龄结构群体遗传学模型，来从第一性原理推导出拮抗性多效性等位基因在群体中维持多态性的条件[@problem_id:2837933]。通过这个实践，你将掌握如何将生命史的权衡（trade-off）转化为适应度参数，并分析其在自然选择下的动态演化。", "problem": "一个具有两个等位基因 $A$ 和 $a$ 的单常染色体基因座，在一个大型、随机交配、世代重叠的二倍体种群中进行分离。该种群包含两个生殖年龄：一个早期生殖年龄和一个晚期生殖年龄。设野生型纯合子 $aa$ 的基准预期终生繁殖成功率等于\n$$\nR_{0,aa} \\;=\\; C_{E} \\;+\\; C_{L},\n$$\n其中 $C_{E} \\gt 0$ 和 $C_{L} \\gt 0$ 分别是早期和晚期生殖年龄对终生繁殖成功率的基准贡献。为方便起见，假设基准已归一化，使得 $C_{E} + C_{L} = 1$。\n\n等位基因 $A$ 具有拮抗性多效性：它增加早期生命的繁殖，但减少晚期生命的繁殖。具体来说，相对于 $aa$，纯合子 $AA$ 的早期年龄贡献乘以 $(1 + s)$，晚期年龄贡献乘以 $(1 - t)$，其中 $s \\gt 0$ 且 $t \\gt 0$。杂合子 $Aa$ 具有不完全显性，其特征是在早期年龄为 $h_{E}$，晚期年龄为 $h_{L}$，其中 $0 \\leq h_{E} \\leq 1$ 且 $0 \\leq h_{L} \\leq 1$，因此其早期年龄贡献乘以 $(1 + h_{E}s)$，晚期年龄贡献乘以 $(1 - h_{L}t)$。\n\n假设随机交配，每代选择前的哈迪-温伯格基因型比例，并且密度调节维持恒定的种群大小，因此 $R_{0}$ 的差异在标准的二倍体选择递推中充当相对适应度。\n\n仅使用核心定义和经过检验的事实，包括 (i) 终生繁殖成功率 $R_{0} = \\sum_{x} \\ell_{x} m_{x}$ 作为各年龄段特定年龄存活率乘以繁殖力贡献的总和，以及 (ii) 在随机交配和恒定种群大小下的标准二倍体选择递推，完成以下任务：\n\n1. 从基本原理出发，用 $C_{E}$、$C_{L}$、$s$、$t$、$h_{E}$ 和 $h_{L}$ 表示特定基因型的终生繁殖成功率 $R_{0,AA}$、$R_{0,Aa}$ 和 $R_{0,aa}$，并将它们分别解释为 $AA$、$Aa$ 和 $aa$ 的相对适应度 $w_{11}$、$w_{12}$ 和 $w_{22}$。\n\n2. 推导等位基因 $A$ 的频率 $p$ 的单基因座等位基因频率递推式，并在存在内部平衡时，求出满足 $0 \\lt p^{\\ast} \\lt 1$ 的内部平衡等位基因频率 $p^{\\ast}$。\n\n3. 根据你的推导，说明在何种关于 $C_{E}$、$C_{L}$、$s$、$t$、$h_{E}$ 和 $h_{L}$ 的条件下，可以维持受保护的多态性（即，存在一个内部稳定平衡，使得两种等位基因在稀有时都能够入侵）。\n\n提供 $p^{\\ast}$ 关于 $C_{E}$、$C_{L}$、$s$、$t$、$h_{E}$ 和 $h_{L}$ 的闭式解析表达式作为最终答案。无需进行数值计算。最终答案不带单位。", "solution": "我们从终生繁殖成功率的定义（即特定年龄贡献的总和，$R_{0} = \\sum_{x} \\ell_{x} m_{x}$）以及拮抗性多效等位基因 $A$ 以乘法方式重新调整早期和晚期年龄贡献的假设开始。由于基准野生型 $aa$ 的 $R_{0,aa} = C_{E} + C_{L} = 1$，通过将特定基因型的缩放因子应用于特定年龄的贡献并对所有年龄求和，可以获得特定基因型的终生繁殖成功率（在恒定种群大小下用作相对适应度）。\n\n1. 特定基因型的终生繁殖成功率和相对适应度。\n\n- 对于 $aa$，没有修改：\n$$\nR_{0,aa} \\;=\\; C_{E} + C_{L} \\;=\\; 1 \\quad\\Rightarrow\\quad w_{22} \\;=\\; 1.\n$$\n\n- 对于 $AA$，早期年龄贡献乘以 $(1+s)$，晚期年龄贡献乘以 $(1-t)$：\n$$\nR_{0,AA} \\;=\\; C_{E} (1+s) \\;+\\; C_{L} (1-t) \\;=\\; 1 \\;+\\; C_{E} s \\;-\\; C_{L} t \\quad\\Rightarrow\\quad w_{11} \\;=\\; 1 \\;+\\; C_{E} s \\;-\\; C_{L} t.\n$$\n\n- 对于 $Aa$，早期年龄贡献乘以 $(1+h_{E}s)$，晚期年龄贡献乘以 $(1-h_{L}t)$：\n$$\nR_{0,Aa} \\;=\\; C_{E} (1+h_{E}s) \\;+\\; C_{L} (1-h_{L}t) \\;=\\; 1 \\;+\\; C_{E} h_{E} s \\;-\\; C_{L} h_{L} t \\quad\\Rightarrow\\quad w_{12} \\;=\\; 1 \\;+\\; C_{E} h_{E} s \\;-\\; C_{L} h_{L} t.\n$$\n\n因此，进入二倍体选择模型的三个相对适应度是\n$$\nw_{11} \\;=\\; 1 + C_{E} s - C_{L} t, \\qquad\nw_{12} \\;=\\; 1 + C_{E} h_{E} s - C_{L} h_{L} t, \\qquad\nw_{22} \\;=\\; 1.\n$$\n\n2. 等位基因频率递推和内部平衡。\n\n在随机交配和选择前哈迪-温伯格基因型比例的条件下，种群平均适应度为\n$$\n\\bar{w} \\;=\\; p^{2} w_{11} \\;+\\; 2 p(1-p) w_{12} \\;+\\; (1-p)^{2} w_{22}.\n$$\n等位基因 $A$ 的边际适应度为\n$$\nw_{A} \\;=\\; p w_{11} \\;+\\; (1-p) w_{12},\n$$\n等位基因频率的递推式为\n$$\np' \\;=\\; \\frac{p \\, w_{A}}{\\bar{w}}.\n$$\n一个内部平衡 $p^{\\ast}$ 满足 $p^{\\ast} = p' = \\frac{p^{\\ast} w_{A}(p^{\\ast})}{\\bar{w}(p^{\\ast})}$ 且 $0 \\lt p^{\\ast} \\lt 1$。对于具有恒定基因型相对适应度 $w_{11}$、$w_{12}$、$w_{22}$ 的单基因座双等位基因选择模型，内部平衡（如果存在）由标准表达式给出\n$$\np^{\\ast} \\;=\\; \\frac{w_{22} - w_{12}}{w_{11} - 2 w_{12} + w_{22}}.\n$$\n代入上面推导的年龄结构适应度表达式，\n$$\nw_{22} - w_{12} \\;=\\; 1 - \\left(1 + C_{E} h_{E} s - C_{L} h_{L} t\\right) \\;=\\; - C_{E} h_{E} s + C_{L} h_{L} t,\n$$\n和\n\\begin{align*}\nw_{11} - 2 w_{12} + w_{22}\n= \\left(1 + C_{E} s - C_{L} t\\right) - 2\\left(1 + C_{E} h_{E} s - C_{L} h_{L} t\\right) + 1 \\\\\n= \\left(1 - 2 + 1\\right) + C_{E} s - C_{L} t - 2 C_{E} h_{E} s + 2 C_{L} h_{L} t \\\\\n= C_{E} s \\left(1 - 2 h_{E}\\right) + C_{L} t \\left(2 h_{L} - 1\\right).\n\\end{align*}\n因此，\n$$\np^{\\ast} \\;=\\; \\frac{C_{L} h_{L} t - C_{E} h_{E} s}{C_{E} s \\left(1 - 2 h_{E}\\right) + C_{L} t \\left(2 h_{L} - 1\\right)}.\n$$\n\n3. 受保护多态性的条件。\n\n在具有恒定基因型适应度的单基因座二倍体模型中，受保护的多态性（一个内部、稳定的平衡，且 $0 \\lt p^{\\ast} \\lt 1$）需要超显性，即，\n$$\nw_{12} \\;>\\; w_{11} \\quad\\text{和}\\quad w_{12} \\;>\\; w_{22}.\n$$\n使用年龄结构的适应度，这些不等式变为\n\\begin{align*}\nw_{12} \\;>\\; w_{22} \\;\\Longleftrightarrow\\; 1 + C_{E} h_{E} s - C_{L} h_{L} t \\;>\\; 1 \\;\\Longleftrightarrow\\; C_{E} h_{E} s \\;>\\; C_{L} h_{L} t, \\\\\nw_{12} \\;>\\; w_{11} \\;\\Longleftrightarrow\\; 1 + C_{E} h_{E} s - C_{L} h_{L} t \\;>\\; 1 + C_{E} s - C_{L} t \\\\\n\\Longleftrightarrow\\; C_{L} t (1 - h_{L}) \\;>\\; C_{E} s (1 - h_{E}).\n\\end{align*}\n当两个条件都成立时，分母 $w_{11} - 2 w_{12} + w_{22}$ 为正，而分子 $w_{22} - w_{12}$ 为负，这确保了 $0 \\lt p^{\\ast} \\lt 1$ 以及内部平衡的稳定性。\n\n换言之，当杂合子的早期生命繁殖收益（按早期年龄贡献加权）相对于其晚期生命繁殖成本（按晚期年龄贡献加权）足够大以超越野生型时，并且同时，杂合子的晚期生命成本相对于早期生命收益足够小以胜过 $AA$ 纯合子时，拮抗性多效性会维持一个多态性。在这些条件下，两种等位基因在稀有时都能够入侵，从而产生一个受保护的多态性，其内部平衡等位基因频率如上所示。", "answer": "$$\\boxed{\\dfrac{C_{L} h_{L} t - C_{E} h_{E} s}{C_{E} s \\left(1 - 2 h_{E}\\right) + C_{L} t \\left(2 h_{L} - 1\\right)}}$$", "id": "2837933"}, {"introduction": "一个基因如何影响多个看似无关的性状？这个练习提供了一个具体的发育生物学模型来解释这一现象。你将探索一个共同的、数量有限的祖细胞池在发育过程中随机分配到两个不同器官的情景，并量化这种资源竞争如何导致两个器官的发育缺陷之间产生负相关[@problem_id:1509840]。这个练习能够加深你对发育过程中随机性作用的理解，并展示如何用概率模型来解释宏观的表型模式。", "problem": "在发育生物学中，基因多效性（pleiotropy）现象描述了单个基因如何影响多个看似不相关的表型性状。考虑一个关于某种昆虫中此现象的假设模型。两种独立的装饰性结构——背脊（器官 A）和侧翼支柱（器官 B）——的发育，依赖于一个共同的祖细胞池。一个单一基因突变导致这些祖细胞总数减少，形成一个大小固定为 $N$ 的细胞池。\n\n在发育过程中，这 $N$ 个祖细胞中的每一个都随机且独立地走向三种可能的命运之一：\n1.  以概率 $p_A$ 分化成为器官 A 的一部分。\n2.  以概率 $p_B$ 分化成为器官 B 的一部分。\n3.  经历细胞凋亡（程序性细胞死亡）并消失，概率为 $p_L = 1 - p_A - p_B$。\n\n这些器官完全和正常形成通常所需的细胞数量为 $C_A$ 和 $C_B$，它们是常数值。由于祖细胞池有限，形成每个器官的实际细胞数（由随机变量 $n_A$ 和 $n_B$ 表示）可能少于所需数量。器官发育缺陷的严重程度定义为其细胞缺失量，即所需细胞数减去实际细胞数。设这些缺失量为 $D_A = C_A - n_A$ 和 $D_B = C_B - n_B$。\n\n对携带该突变的种群的观察揭示了两种器官缺陷严重程度之间存在负相关：背脊严重发育不全的个体往往具有更发达的侧翼支柱，反之亦然。你的任务是量化这种关系。\n\n计算器官 A 和器官 B 的细胞缺失量之间的皮尔逊相关系数 $\\rho(D_A, D_B)$。将你的答案表示为关于概率 $p_A$ 和 $p_B$ 的闭式解析表达式。", "solution": "令每个祖细胞 $i \\in \\{1,\\dots,N\\}$ 产生指示变量 $X_{iA}$ 和 $X_{iB}$，分别表示其定型为器官 A 或 B，其中 $X_{iA}, X_{iB} \\in \\{0,1\\}$，并且对于同一个细胞，$X_{iA}X_{iB}=0$ 几乎必然成立。不同细胞的定型过程相互独立，有 $\\mathbb{P}(X_{iA}=1)=p_{A}$ 和 $\\mathbb{P}(X_{iB}=1)=p_{B}$。那么\n$$\nn_{A}=\\sum_{i=1}^{N} X_{iA}, \\qquad n_{B}=\\sum_{i=1}^{N} X_{iB}.\n$$\n对于单个细胞，\n$$\n\\mathbb{E}[X_{iA}]=p_{A}, \\quad \\mathbb{E}[X_{iB}]=p_{B}, \\quad \\mathrm{Var}(X_{iA})=p_{A}(1-p_{A}), \\quad \\mathrm{Var}(X_{iB})=p_{B}(1-p_{B}),\n$$\n并且由于 $X_{iA}X_{iB}=0$ 几乎必然成立，\n$$\n\\mathrm{Cov}(X_{iA},X_{iB})=\\mathbb{E}[X_{iA}X_{iB}]-\\mathbb{E}[X_{iA}]\\mathbb{E}[X_{iB}]=0-p_{A}p_{B}=-p_{A}p_{B}.\n$$\n不同细胞间的独立性意味着当 $i \\neq j$ 时，$\\mathrm{Cov}(X_{iA},X_{jB})=0$。因此，\n$$\n\\mathbb{E}[n_{A}]=N p_{A}, \\quad \\mathbb{E}[n_{B}]=N p_{B}, \\quad \\mathrm{Var}(n_{A})=N p_{A}(1-p_{A}), \\quad \\mathrm{Var}(n_{B})=N p_{B}(1-p_{B}),\n$$\n且\n$$\n\\mathrm{Cov}(n_{A},n_{B})=\\sum_{i=1}^{N} \\mathrm{Cov}(X_{iA},X_{iB})=-N p_{A} p_{B}.\n$$\n\n缺失量为 $D_{A}=C_{A}-n_{A}$ 和 $D_{B}=C_{B}-n_{B}$。使用 $\\mathrm{Cov}(aX+b,cY+d)=ac\\,\\mathrm{Cov}(X,Y)$ 和 $\\mathrm{Var}(aX+b)=a^{2}\\mathrm{Var}(X)$，我们得到\n$$\n\\mathrm{Cov}(D_{A},D_{B})=\\mathrm{Cov}(n_{A},n_{B}), \\quad \\mathrm{Var}(D_{A})=\\mathrm{Var}(n_{A}), \\quad \\mathrm{Var}(D_{B})=\\mathrm{Var}(n_{B}).\n$$\n因此，皮尔逊相关系数满足\n$$\n\\rho(D_{A},D_{B})=\\frac{\\mathrm{Cov}(D_{A},D_{B})}{\\sqrt{\\mathrm{Var}(D_{A})\\mathrm{Var}(D_{B})}}=\\frac{\\mathrm{Cov}(n_{A},n_{B})}{\\sqrt{\\mathrm{Var}(n_{A})\\mathrm{Var}(n_{B})}}.\n$$\n代入上述表达式，\n$$\n\\rho(D_{A},D_{B})=\\frac{-N p_{A} p_{B}}{\\sqrt{N p_{A}(1-p_{A})\\cdot N p_{B}(1-p_{B})}}=-\\frac{p_{A} p_{B}}{\\sqrt{p_{A} p_{B} (1-p_{A})(1-p_{B})}}=-\\sqrt{\\frac{p_{A} p_{B}}{(1-p_{A})(1-p_{B})}}.\n$$\n此式在 $0", "answer": "$$\\boxed{-\\sqrt{\\frac{p_{A}p_{B}}{(1-p_{A})(1-p_{B})}}}$$", "id": "1509840"}, {"introduction": "在现代遗传学研究中，区分一个遗传位点上的真实多效性与仅仅由连锁不平衡（Linkage Disequilibrium, LD）引起的性状关联是一个关键挑战。这个练习将让你扮演一个统计遗传学家的角色，使用来自全基因组关联研究（GWAS）的摘要数据[@problem_id:2837889]。你将运用贝叶斯模型比较的强大工具，计算贝叶斯因子（Bayes Factor），以判断一个共享遗传效应的模型（多效性）是否比两个独立的性状特异性效应模型更能解释观测到的数据。", "problem": "我们使用来自两个独立的全基因组关联研究（GWAS；Genome-Wide Association Study）的汇总统计量，分析一个双等位基因双变异位点，以寻找其在两个复杂性状间存在基因多效性的证据。基因型和表型已经过标准化，因此在线性模型和大样本近似下，性状 $t \\in \\{1,2\\}$ 的单变异边缘关联统计量向量满足以下经过充分检验的近似：如果性状 $t$ 上真实的每个变异的效应向量为 $\\boldsymbol{\\beta}_{t} \\in \\mathbb{R}^{2}$，且位点内的连锁不平衡（LD；Linkage Disequilibrium）相关矩阵为 $\\mathbf{R} \\in \\mathbb{R}^{2 \\times 2}$，那么\n$$\n\\mathbf{z}_{t} \\,\\big|\\, \\boldsymbol{\\beta}_{t} \\sim \\mathcal{N}\\!\\left(\\mathbf{R}\\sqrt{N_{t}}\\,\\boldsymbol{\\beta}_{t},\\, \\mathbf{R}\\right),\n$$\n其中 $N_{t}$ 是性状 $t$ 的样本量。\n\n给定：\n- LD 矩阵 $\\mathbf{R} = \\begin{pmatrix} 1  0.5 \\\\ 0.5  1 \\end{pmatrix}$，\n- 样本量 $N_{1} = 10000$ 和 $N_{2} = 10000$，\n- 观测到的 $z$-分数向量 $\\mathbf{z}_{1} = \\begin{pmatrix} 3.0 \\\\ 2.0 \\end{pmatrix}$ 和 $\\mathbf{z}_{2} = \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix}$，\n- 效应上的高斯先验，其方差为 $\\sigma_{\\beta}^{2}$：对于任意效应向量 $\\boldsymbol{\\beta}$，$\\boldsymbol{\\beta} \\sim \\mathcal{N}\\!\\left(\\mathbf{0},\\, \\sigma_{\\beta}^{2}\\mathbf{I}_{2}\\right)$，其中 $\\sigma_{\\beta}^{2} = 1.0 \\times 10^{-4}$。\n\n考虑两个模型：\n- 多效性模型 $\\mathcal{M}_{\\mathrm{shared}}$：同一个效应向量作用于两个性状，$\\boldsymbol{\\beta}_{1} = \\boldsymbol{\\beta}_{2} = \\boldsymbol{\\beta}$，其先验如上所述。\n- 性状特异性模型 $\\mathcal{M}_{\\mathrm{indep}}$：效应是性状特异性的且先验独立，$\\boldsymbol{\\beta}_{1} \\perp \\boldsymbol{\\beta}_{2}$，每个效应向量都具有与上述相同的先验。\n\n假设两个 GWAS 没有样本重叠，因此在模型 $\\mathcal{M}_{\\mathrm{indep}}$ 下，给定 $\\boldsymbol{\\beta}_{1}, \\boldsymbol{\\beta}_{2}$，$\\mathbf{z}_{1}$ 和 $\\mathbf{z}_{2}$ 条件独立。计算贝叶斯因子，\n$$\n\\mathrm{BF} \\;=\\; \\frac{p\\!\\left(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{shared}}\\right)}{p\\!\\left(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}}\\right)},\n$$\n在每个模型中对规定的先验进行积分。将最终数值答案四舍五入至三位有效数字。无需单位。", "solution": "该问题要求计算贝叶斯因子 $\\mathrm{BF}$，以比较关于两个性状遗传效应的两种模型：一个多效性模型 $\\mathcal{M}_{\\mathrm{shared}}$，其中单个效应向量 $\\boldsymbol{\\beta}$ 影响两个性状；以及一个独立效应模型 $\\mathcal{M}_{\\mathrm{indep}}$，其中每个性状有其自身的效应向量 $\\boldsymbol{\\beta}_{1}$ 和 $\\boldsymbol{\\beta}_{2}$。贝叶斯因子是观测数据在这两个模型下的边缘似然之比。\n$$\n\\mathrm{BF} = \\frac{p(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{shared}})}{p(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}})}\n$$\n模型 $\\mathcal{M}$ 的边缘似然是通过将数据的似然在参数的先验分布上积分得到的：$p(\\text{data} \\mid \\mathcal{M}) = \\int p(\\text{data} \\mid \\text{parameters}) p(\\text{parameters} \\mid \\mathcal{M}) d(\\text{parameters})$。\n\n首先，我们为每个模型建立分布。问题陈述样本量相等，$N_{1} = N_{2} = 10000$。我们用 $N=10000$ 表示这个共同的样本量。效应大小的先验方差为 $\\sigma_{\\beta}^{2} = 1.0 \\times 10^{-4}$。这两个值的乘积带来了一个关键的简化：$N\\sigma_{\\beta}^{2} = 10000 \\times 1.0 \\times 10^{-4} = 1$。\n\n我们来分析分母 $p(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}})$。在 $\\mathcal{M}_{\\mathrm{indep}}$ 模型下，效应 $\\boldsymbol{\\beta}_{1}$ 和 $\\boldsymbol{\\beta}_{2}$ 是独立的，且 GWAS 样本不重叠，因此 $\\mathbf{z}_{1}$ 和 $\\mathbf{z}_{2}$ 也是独立的。边缘似然是每个性状的边缘似然的乘积：$p(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}}) = p(\\mathbf{z}_{1} \\mid \\mathcal{M}_{\\mathrm{indep}}) p(\\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}})$。\n对于每个性状 $t \\in \\{1, 2\\}$，我们有一个高斯-高斯模型：\n似然：$\\mathbf{z}_{t} \\mid \\boldsymbol{\\beta}_{t} \\sim \\mathcal{N}(\\sqrt{N}\\mathbf{R}\\boldsymbol{\\beta}_{t}, \\mathbf{R})$。\n先验：$\\boldsymbol{\\beta}_{t} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_{\\beta}^{2}\\mathbf{I}_{2})$。\n$\\mathbf{z}_{t}$ 的边缘分布是均值为 $\\mathbf{0}$、协方差矩阵为 $\\mathbf{\\Sigma}_{\\mathrm{indep}}$ 的高斯分布：\n$\\mathbf{\\Sigma}_{\\mathrm{indep}} = (\\sqrt{N}\\mathbf{R})(\\sigma_{\\beta}^{2}\\mathbf{I}_{2})(\\sqrt{N}\\mathbf{R})^{T} + \\mathbf{R} = N\\sigma_{\\beta}^{2}\\mathbf{R}^{2} + \\mathbf{R}$。\n鉴于 $N\\sigma_{\\beta}^{2} = 1$，我们有 $\\mathbf{\\Sigma}_{\\mathrm{indep}} = \\mathbf{R}^{2} + \\mathbf{R}$。我们定义这个矩阵为 $\\mathbf{V} = \\mathbf{R} + \\mathbf{R}^{2}$。\n因此，在 $\\mathcal{M}_{\\mathrm{indep}}$ 模型下，$\\mathbf{z}_{1} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{V})$ 和 $\\mathbf{z}_{2} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{V})$ 相互独立。\n\n现在，我们来分析分子 $p(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{shared}})$。在 $\\mathcal{M}_{\\mathrm{shared}}$ 模型下，$\\boldsymbol{\\beta}_{1} = \\boldsymbol{\\beta}_{2} = \\boldsymbol{\\beta}$。令 $\\mathbf{z} = \\begin{pmatrix} \\mathbf{z}_{1} \\\\ \\mathbf{z}_{2} \\end{pmatrix}$。\n似然：$\\mathbf{z} \\mid \\boldsymbol{\\beta} \\sim \\mathcal{N}\\left(\\begin{pmatrix} \\sqrt{N}\\mathbf{R}\\boldsymbol{\\beta} \\\\ \\sqrt{N}\\mathbf{R}\\boldsymbol{\\beta} \\end{pmatrix}, \\begin{pmatrix} \\mathbf{R}  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{R} \\end{pmatrix}\\right)$。\n先验：$\\boldsymbol{\\beta} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_{\\beta}^{2}\\mathbf{I}_{2})$。\n$\\mathbf{z}$ 的边缘分布是均值为 $\\mathbf{0}$、协方差矩阵为 $\\mathbf{\\Sigma}_{\\mathrm{shared}}$ 的高斯分布：\n$\\mathbf{\\Sigma}_{\\mathrm{shared}} = \\begin{pmatrix} \\sqrt{N}\\mathbf{R} \\\\ \\sqrt{N}\\mathbf{R} \\end{pmatrix} (\\sigma_{\\beta}^{2}\\mathbf{I}_{2}) \\begin{pmatrix} \\sqrt{N}\\mathbf{R}^{T}  \\sqrt{N}\\mathbf{R}^{T} \\end{pmatrix} + \\begin{pmatrix} \\mathbf{R}  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{R} \\end{pmatrix}$。\n使用 $\\mathbf{R}^{T}=\\mathbf{R}$ 和 $N\\sigma_{\\beta}^{2}=1$，可简化为：\n$\\mathbf{\\Sigma}_{\\mathrm{shared}} = \\begin{pmatrix} \\mathbf{R}^{2}  \\mathbf{R}^{2} \\\\ \\mathbf{R}^{2}  \\mathbf{R}^{2} \\end{pmatrix} + \\begin{pmatrix} \\mathbf{R}  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{R} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{R}+\\mathbf{R}^{2}  \\mathbf{R}^{2} \\\\ \\mathbf{R}^{2}  \\mathbf{R}+\\mathbf{R}^{2} \\end{pmatrix}$。\n我们定义 $\\mathbf{C} = \\mathbf{R}^{2}$。我们有 $\\mathbf{V} = \\mathbf{R}+\\mathbf{R}^{2}$。因此，$\\mathbf{\\Sigma}_{\\mathrm{shared}} = \\begin{pmatrix} \\mathbf{V}  \\mathbf{C} \\\\ \\mathbf{C}  \\mathbf{V} \\end{pmatrix}$。\n\n为简化贝叶斯因子的计算，我们对数据进行线性变换：\n$\\mathbf{y}_{1} = \\mathbf{z}_{1} + \\mathbf{z}_{2}$\n$\\mathbf{y}_{2} = \\mathbf{z}_{1} - \\mathbf{z}_{2}$\n由于这是线性变换，概率密度的比值是不变的：\n$\\mathrm{BF} = \\frac{p(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{shared}})}{p(\\mathbf{z}_{1}, \\mathbf{z}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}})} = \\frac{p(\\mathbf{y}_{1}, \\mathbf{y}_{2} \\mid \\mathcal{M}_{\\mathrm{shared}})}{p(\\mathbf{y}_{1}, \\mathbf{y}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}})}$。\n\n在 $\\mathcal{M}_{\\mathrm{indep}}$ 模型下，由于 $\\mathbf{z}_{1}, \\mathbf{z}_{2} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{V})$ 相互独立：\n$\\mathrm{E}[\\mathbf{y}_{1}] = \\mathrm{E}[\\mathbf{z}_{1}] + \\mathrm{E}[\\mathbf{z}_{2}] = \\mathbf{0}$。 $\\mathrm{Var}(\\mathbf{y}_{1}) = \\mathrm{Var}(\\mathbf{z}_{1}) + \\mathrm{Var}(\\mathbf{z}_{2}) = 2\\mathbf{V}$。\n$\\mathrm{E}[\\mathbf{y}_{2}] = \\mathrm{E}[\\mathbf{z}_{1}] - \\mathrm{E}[\\mathbf{z}_{2}] = \\mathbf{0}$。 $\\mathrm{Var}(\\mathbf{y}_{2}) = \\mathrm{Var}(\\mathbf{z}_{1}) + \\mathrm{Var}(\\mathbf{z}_{2}) = 2\\mathbf{V}$。\n$\\mathrm{Cov}(\\mathbf{y}_{1}, \\mathbf{y}_{2}) = \\mathrm{Var}(\\mathbf{z}_{1}) - \\mathrm{Var}(\\mathbf{z}_{2}) = \\mathbf{V} - \\mathbf{V} = \\mathbf{0}$。\n因此，在 $\\mathcal{M}_{\\mathrm{indep}}$ 模型下，$\\mathbf{y}_{1}$ 和 $\\mathbf{y}_{2}$ 是独立的，且 $\\mathbf{y}_{1} \\sim \\mathcal{N}(\\mathbf{0}, 2\\mathbf{V})$ 和 $\\mathbf{y}_{2} \\sim \\mathcal{N}(\\mathbf{0}, 2\\mathbf{V})$。\n分母为 $p(\\mathbf{y}_{1}, \\mathbf{y}_{2} \\mid \\mathcal{M}_{\\mathrm{indep}}) = \\mathcal{N}(\\mathbf{y}_{1} \\mid \\mathbf{0}, 2\\mathbf{V})\\mathcal{N}(\\mathbf{y}_{2} \\mid \\mathbf{0}, 2\\mathbf{V})$。\n\n在 $\\mathcal{M}_{\\mathrm{shared}}$ 模型下，向量 $\\mathbf{y}=\\begin{pmatrix}\\mathbf{y}_1\\\\\\mathbf{y}_2\\end{pmatrix}$ 的协方差为 $\\begin{pmatrix} \\mathbf{I}  \\mathbf{I} \\\\ \\mathbf{I}  -\\mathbf{I} \\end{pmatrix} \\mathbf{\\Sigma}_{\\mathrm{shared}} \\begin{pmatrix} \\mathbf{I}  \\mathbf{I} \\\\ \\mathbf{I}  -\\mathbf{I} \\end{pmatrix}^{T} = \\begin{pmatrix} 2(\\mathbf{V}+\\mathbf{C})  \\mathbf{0} \\\\ \\mathbf{0}  2(\\mathbf{V}-\\mathbf{C}) \\end{pmatrix}$。\n因此，在 $\\mathcal{M}_{\\mathrm{shared}}$ 模型下，$\\mathbf{y}_{1}$ 和 $\\mathbf{y}_{2}$ 也是独立的，且 $\\mathbf{y}_{1} \\sim \\mathcal{N}(\\mathbf{0}, 2(\\mathbf{V}+\\mathbf{C}))$ 和 $\\mathbf{y}_{2} \\sim \\mathcal{N}(\\mathbf{0}, 2(\\mathbf{V}-\\mathbf{C}))$。\n分子为 $p(\\mathbf{y}_{1}, \\mathbf{y}_{2} \\mid \\mathcal{M}_{\\mathrm{shared}}) = \\mathcal{N}(\\mathbf{y}_{1} \\mid \\mathbf{0}, 2(\\mathbf{V}+\\mathbf{C}))\\mathcal{N}(\\mathbf{y}_{2} \\mid \\mathbf{0}, 2(\\mathbf{V}-\\mathbf{C}))$。\n\n贝叶斯因子是两个正态密度之比的乘积：\n$$\n\\mathrm{BF} = \\frac{\\mathcal{N}(\\mathbf{y}_{1} \\mid \\mathbf{0}, 2(\\mathbf{V}+\\mathbf{C}))}{\\mathcal{N}(\\mathbf{y}_{1} \\mid \\mathbf{0}, 2\\mathbf{V})} \\times \\frac{\\mathcal{N}(\\mathbf{y}_{2} \\mid \\mathbf{0}, 2(\\mathbf{V}-\\mathbf{C}))}{\\mathcal{N}(\\mathbf{y}_{2} \\mid \\mathbf{0}, 2\\mathbf{V})}\n$$\n对于比值 $\\frac{\\mathcal{N}(\\mathbf{x} | \\mathbf{0}, \\mathbf{\\Sigma}_A)}{\\mathcal{N}(\\mathbf{x} | \\mathbf{0}, \\mathbf{\\Sigma}_B)}$，其值为 $\\left(\\frac{|\\mathbf{\\Sigma}_B|}{|\\mathbf{\\Sigma}_A|}\\right)^{1/2} \\exp\\left(-\\frac{1}{2} \\mathbf{x}^{T} (\\mathbf{\\Sigma}_A^{-1} - \\mathbf{\\Sigma}_B^{-1}) \\mathbf{x}\\right)$。\n应用于我们的问题（协方差为 $2\\mathbf{M}$ 对 $2\\mathbf{L}$，其中 $\\mathbf{M},\\mathbf{L}$ 均为 $2 \\times 2$ 矩阵）：\n$\\mathrm{BF} = \\left(\\frac{|2\\mathbf{V}|}{|2(\\mathbf{V}+\\mathbf{C})|}\\right)^{1/2} \\exp\\left(-\\frac{1}{2} \\mathbf{y}_{1}^{T} ([2(\\mathbf{V}+\\mathbf{C})]^{-1} - [2\\mathbf{V}]^{-1}) \\mathbf{y}_{1}\\right) \\times \\left(\\frac{|2\\mathbf{V}|}{|2(\\mathbf{V}-\\mathbf{C})|}\\right)^{1/2} \\exp\\left(-\\frac{1}{2} \\mathbf{y}_{2}^{T} ([2(\\mathbf{V}-\\mathbf{C})]^{-1} - [2\\mathbf{V}]^{-1}) \\mathbf{y}_{2}\\right)$。\n使用 $|c\\mathbf{M}| = c^k|\\mathbf{M}|$（其中 $k=2$），行列式项得以简化，指数中逆矩阵前的 $\\frac{1}{2}$ 变为 $\\frac{1}{4}$。\n$\\mathrm{BF} = \\frac{|\\mathbf{V}|}{\\sqrt{|\\mathbf{V}+\\mathbf{C}||\\mathbf{V}-\\mathbf{C}|}} \\exp\\left(-\\frac{1}{4} \\left( \\mathbf{y}_{1}^{T}((\\mathbf{V}+\\mathbf{C})^{-1} - \\mathbf{V}^{-1})\\mathbf{y}_{1} + \\mathbf{y}_{2}^{T}((\\mathbf{V}-\\mathbf{C})^{-1} - \\mathbf{V}^{-1})\\mathbf{y}_{2} \\right) \\right)$。\n\n现在我们计算矩阵和数值。\n$\\mathbf{R} = \\begin{pmatrix} 1  0.5 \\\\ 0.5  1 \\end{pmatrix}$。$\\mathbf{R}^{2} = \\begin{pmatrix} 1.25  1 \\\\ 1  1.25 \\end{pmatrix}$。\n$\\mathbf{V} = \\mathbf{R} + \\mathbf{R}^{2} = \\begin{pmatrix} 2.25  1.5 \\\\ 1.5  2.25 \\end{pmatrix}$。\n$\\mathbf{C} = \\mathbf{R}^{2} = \\begin{pmatrix} 1.25  1 \\\\ 1  1.25 \\end{pmatrix}$。\n$\\mathbf{V}+\\mathbf{C} = \\mathbf{R}+2\\mathbf{R}^2 = \\begin{pmatrix} 3.5  2.5 \\\\ 2.5  3.5 \\end{pmatrix}$。\n$\\mathbf{V}-\\mathbf{C} = \\mathbf{R} = \\begin{pmatrix} 1  0.5 \\\\ 0.5  1 \\end{pmatrix}$。\n\n行列式：\n$|\\mathbf{V}| = 2.25^{2} - 1.5^{2} = 5.0625 - 2.25 = 2.8125$。\n$|\\mathbf{V}+\\mathbf{C}| = 3.5^{2} - 2.5^{2} = 12.25 - 6.25 = 6$。\n$|\\mathbf{V}-\\mathbf{C}| = |\\mathbf{R}| = 1^{2} - 0.5^{2} = 0.75$。\n行列式因子为 $\\frac{2.8125}{\\sqrt{6 \\times 0.75}} = \\frac{2.8125}{\\sqrt{4.5}} = \\frac{45/16}{3/\\sqrt{2}} = \\frac{15\\sqrt{2}}{16}$。\n\n逆矩阵：\n$\\mathbf{V}^{-1} = \\frac{1}{2.8125} \\begin{pmatrix} 2.25  -1.5 \\\\ -1.5  2.25 \\end{pmatrix} = \\frac{4}{15} \\begin{pmatrix} 3  -2 \\\\ -2  3 \\end{pmatrix}$。\n$(\\mathbf{V}+\\mathbf{C})^{-1} = \\frac{1}{6} \\begin{pmatrix} 3.5  -2.5 \\\\ -2.5  3.5 \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} 7  -5 \\\\ -5  7 \\end{pmatrix}$。\n$(\\mathbf{V}-\\mathbf{C})^{-1} = \\mathbf{R}^{-1} = \\frac{1}{0.75} \\begin{pmatrix} 1  -0.5 \\\\ -0.5  1 \\end{pmatrix} = \\frac{4}{3} \\begin{pmatrix} 1  -0.5 \\\\ -0.5  1 \\end{pmatrix}$。\n\n逆矩阵之差：\n$(\\mathbf{V}+\\mathbf{C})^{-1} - \\mathbf{V}^{-1} = \\frac{1}{12}\\begin{pmatrix} 7  -5 \\\\ -5  7 \\end{pmatrix} - \\frac{4}{15}\\begin{pmatrix} 3  -2 \\\\ -2  3 \\end{pmatrix} = \\frac{1}{60}\\begin{pmatrix} -13  7 \\\\ 7  -13 \\end{pmatrix}$。\n$(\\mathbf{V}-\\mathbf{C})^{-1} - \\mathbf{V}^{-1} = \\frac{4}{3}\\begin{pmatrix} 1  -0.5 \\\\ -0.5  1 \\end{pmatrix} - \\frac{4}{15}\\begin{pmatrix} 3  -2 \\\\ -2  3 \\end{pmatrix} = \\frac{1}{15}\\begin{pmatrix} 8  -2 \\\\ -2  8 \\end{pmatrix}$。\n\n数据向量：\n$\\mathbf{z}_{1} = \\begin{pmatrix} 3.0 \\\\ 2.0 \\end{pmatrix}, \\mathbf{z}_{2} = \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix}$。\n$\\mathbf{y}_{1} = \\mathbf{z}_{1}+\\mathbf{z}_{2} = \\begin{pmatrix} 5.5 \\\\ 3.5 \\end{pmatrix}$。\n$\\mathbf{y}_{2} = \\mathbf{z}_{1}-\\mathbf{z}_{2} = \\begin{pmatrix} 0.5 \\\\ 0.5 \\end{pmatrix}$。\n\n二次型：\n$\\mathbf{y}_{1}^{T}((\\mathbf{V}+\\mathbf{C})^{-1} - \\mathbf{V}^{-1})\\mathbf{y}_{1} = \\begin{pmatrix} 5.5  3.5 \\end{pmatrix} \\frac{1}{60}\\begin{pmatrix} -13  7 \\\\ 7  -13 \\end{pmatrix} \\begin{pmatrix} 5.5 \\\\ 3.5 \\end{pmatrix} = \\frac{1}{60}(-13 \\times 5.5^2 + 14 \\times 5.5 \\times 3.5 - 13 \\times 3.5^2) = \\frac{-283}{60}$。\n$\\mathbf{y}_{2}^{T}((\\mathbf{V}-\\mathbf{C})^{-1} - \\mathbf{V}^{-1})\\mathbf{y}_{2} = \\begin{pmatrix} 0.5  0.5 \\end{pmatrix} \\frac{1}{15}\\begin{pmatrix} 8  -2 \\\\ -2  8 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 0.5 \\end{pmatrix} = \\frac{1}{15}(8 \\times 0.5^2 - 4 \\times 0.5 \\times 0.5 + 8 \\times 0.5^2) = \\frac{1}{5}$。\n\n指数项的指数为：\n$-\\frac{1}{4} \\left( \\frac{-283}{60} + \\frac{1}{5} \\right) = -\\frac{1}{4} \\left( \\frac{-283+12}{60} \\right) = -\\frac{1}{4} \\left( \\frac{-271}{60} \\right) = \\frac{271}{240}$。\n\n最后，贝叶斯因子是：\n$\\mathrm{BF} = \\frac{15\\sqrt{2}}{16} \\exp\\left(\\frac{271}{240}\\right)$。\n其数值为：\n$\\mathrm{BF} \\approx \\frac{15 \\times 1.41421}{16} \\exp(1.12917) \\approx 1.3258 \\times 3.0931 \\approx 4.09999$。\n四舍五入到三位有效数字，结果是 $4.10$。", "answer": "$$\\boxed{4.10}$$", "id": "2837889"}]}