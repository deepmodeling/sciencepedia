{"hands_on_practices": [{"introduction": "在遗传学研究中，一个核心挑战是判断一个观察到的性状究竟是由遗传决定的，还是由环境诱导的。本练习 [@problem_id:2807824] 将引导你进行一个思想实验，通过设计和解读一系列对照杂交实验，来明确地区分一个可遗传的基因突变和一个非遗传的拟表型。这个练习旨在磨练你在遗传学中进行因果推断的基本逻辑能力。", "problem": "在一个模式生物中，可以观察到一个形态上显著不同的表型，记为 $P$。该生物有一个注释清晰的、对器官发育至关重要的基因座 $W$。考虑两种基于遗传学核心原理的因果模型：\n\n- 模型 G（遗传突变体）：在标准环境 $E_0$ 下，当生物体为纯合子 $ww$ 时，基因 $W$ 上的一个隐性功能丧失等位基因 $w$ 会导致表型 $P$，且具有完全外显性。根据 Mendel 分离定律，杂合子自交产生的 $F_2$ 代基因型比例为 $1:2:1$ ($WW:Ww:ww$)，在完全外显的情况下，受影响的表型比例为 $1/4$。\n- 模型 E（环境拟表型）：野生型基因型 $WW$ 仅在发育窗口期 $t^\\*$ 期间精确暴露于特定扰动 $E^\\*$ 时才会表现出表型 $P$；在没有 $E^\\*$ 的情况下，$WW$ 不会表现出 $P$。在这里，$P$ 模拟了 $ww$ 的效应，但不需要突变等位基因。根据定义，拟表型是由环境诱导的，不通过等位基因 $w$ 的分离而遗传。\n\n一只野外捕获的、表现出表型 $P$ 的雄性创始者。你进行以下受控思想实验，以在模型 G 和模型 E 之间做出判决：\n\n- 杂交 1：将受影响的雄性创始者与经证实基因型为 $WW$ 的实验室野生型雌性交配；在 $E_0$ 环境下（不暴露于 $E^\\*$）饲养所有 $F_1$ 代。\n- 杂交 2：进行 $F_1 \\times F_1$ 自交；在 $E_0$ 环境下饲养所有 $F_2$ 代。\n- 关联检验：同时，从实验室品系中组建病例队列和对照队列，并对 $W$ 附近的标记进行连锁/关联分析；检验 $P$ 是否在家系内与 $W$ 的等位基因共分离。\n- 诱导检验：在一个野生型品系（$WW$）中，将一个队列仅在 $t^\\*$ 期间暴露于 $E^\\*$，并将在 $E_0$ 下饲养的一个匹配队列作为对照。\n\n假设样本量足够大，因此抽样误差可以忽略不计，并且 $E^\\*$ 暴露是随机的，与基因型或合子性不相关。\n\n以下哪组观察结果与创始者的表型 $P$ 是一个拟表型（模型 E）而非由一个分离的突变等位基因（模型 G）引起的情况最一致？\n\nA. 在 $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$；在 $E_0$ 环境下的 $F_2$ 代：$0\\%$ 表现出 $P$；家系内连锁/关联分析未检测到 $P$与 $W$ 附近标记的共分离；在诱导检验中，一部分比例为 $q>0$ 的暴露于 $E^\\*$ 的 $WW$ 动物表现出 $P$，而在 $E_0$ 环境下该比例为 $0\\%$。\n\nB. 在 $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$；在 $E_0$ 环境下的 $F_2$ 代：大约 $25\\%$ 表现出 $P$；家系内分析揭示了 $P$ 与 $W$ 处一个单倍型存在共分离，重组率接近 $0$；在诱导检验中，$0\\%$ 的 $WW$ 动物在 $E^\\*$ 环境下表现出 $P$。\n\nC. 在一个群体队列中，一同抚养的双胞胎中，单卵双胞胎对于 $P$ 的同病率在 $E_0$ 环境下远超双卵双胞胎；在 $E_0$ 环境下的 $F_2$ 代中，大约 $25\\%$ 表现出 $P$；在 $W$ 处的家系内连锁分析呈阳性。\n\nD. 在 $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$；在 $E_0$ 环境下的 $F_2$ 代：大约 $25\\%$ 表现出 $P$；在 $W$ 处的家系内连锁呈阴性，但在 $W$ 附近观察到一个病例-对照关联，其 $p  10^{-9}$；在诱导检验中，一部分比例为 $q0$ 的暴露于 $E^\\*$ 的 $WW$ 动物表现出 $P$。\n\n选择唯一最佳答案。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 第1步：提取已知条件\n- **表型**：$P$，形态上显著不同。\n- **基因座**：$W$，器官发育所必需。\n- **模型 G（遗传突变体）**：\n    - 等位基因：$w$，位于基因座 $W$ 的隐性功能丧失型。\n    - 基因型-表型映射：纯合子 $ww$ 导致表型 $P$。\n    - 环境：标准环境 $E_0$。\n    - 外显率：完全。\n    - 遗传：Mendel 分离。杂合子自交（$Ww \\times Ww$）产生基因型比例为 $1:2:1$（$WW:Ww:ww$）的 $F_2$ 代，受影响（$P$）的表型比例为 $\\frac{1}{4}$。\n- **模型 E（环境拟表型）**：\n    - 基因型-表型映射：野生型基因型 $WW$ 仅在特定发育窗口期 $t^\\*$ 暴露于环境扰动 $E^\\*$ 时才会表现出表型 $P$。\n    - 遗传：表型 $P$ 不通过等位基因 $w$ 的分离而遗传。\n- **创始动物**：一只表现出表型 $P$ 的野外捕获雄性。\n- **实验设计**：\n    - **杂交 1**：创始雄性（$P$）$\\times$ 实验室雌性（$WW$，已验证）。$F_1$ 代在 $E_0$ 环境下饲养。\n    - **杂交 2**：$F_1 \\times F_1$ 自交。$F_2$ 代在 $E_0$ 环境下饲养。\n    - **关联检验**：对 $P$ 与基因座 $W$ 附近标记的共分离进行连锁/关联检验。\n    - **诱導检验**：一批野生型（$WW$）动物在 $t^\\*$ 期间暴露于 $E^\\*$；一批匹配的对照组在 $E_0$ 环境下饲养。\n- **假设**：\n    - 大样本量，抽样误差可忽略。\n    - 对 $E^\\*$ 的暴露是随机的，与基因型无关。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **基于科学**：该问题基于遗传学的基本原理，包括 Mendel 遗传、隐性等位基因、拟表型、连锁分析和受控杂交。这些概念是该学科的核心。\n2.  **设定良好**：该问题提出了两个互斥的假说（模型 G vs. 模型 E）和一套旨在区分它们的实验。问题要求确定哪组实验结果支持其中一个假说。这种结构允许一个唯一的、逻辑的解决方案。\n3.  **客观性**：语言精确且专业。所有术语（$P$、$W$、$w$、$E_0$、$E^\\*$、拟表型、完全外显率）都有定义或是遗传学中的标准术语。实验设置被客观地描述。\n4.  **完整性**：该问题提供了足够的信息来推断每个模型下的预期结果。没有遗漏关键数据。\n5.  **一致性**：已知条件内部一致。模型和实验设计不包含矛盾。\n\n### 第3步：结论与行动\n问题陈述有效。这是一个遗传学中表述清晰的问题，需要基于既定原则进行逻辑推导。我们可以继续进行解答。\n\n### 解答推导\n任务是确定哪组观察结果与创始者的表型是一个拟表型（模型 E）最一致。为此，我们必须首先预测两种模型各自的实验结果。\n\n**模型 G（遗传原因）下的预测**\n如果创始雄性的表型 $P$ 是由隐性基因型 $ww$ 引起的，那么：\n- **杂交 1**：创始雄性（$ww$）与野生型雌性（$WW$）交配。所有 $F_1$ 子代必然是 $Ww$ 基因型。因为等位基因 $w$ 是隐性的，且 $F_1$ 在 $E_0$ 环境下饲养，它们的表型将是野生型。因此，$0\\%$ 的 $F_1$ 将表现出表型 $P$。\n- **杂交 2**：$F_1$ 杂合子自交（$Ww \\times Ww$）将产生 $F_2$ 子代，其基因型呈孟德尔比例 $1:2:1$（$WW:Ww:ww$）。由于完全外显，所有 $ww$ 个体都将表现出表型 $P$。因此，大约 $\\frac{1}{4}$ 或 $25\\%$ 的 $F_2$ 代将表现出表型 $P$。\n- **关联检验**：由于表型 $P$ 是由基因座 $W$ 的基因型直接引起的，表型将与 $w$ 等位基因（或与其完全连锁的标记）在家系中完美共分离。连锁分析将产生高度显著的结果。\n- **诱導检验**：根据模型 G 的定义，表型 $P$ 是遗传的。将野生型（$WW$）动物暴露于环境扰动 $E^\\*$ 将没有效果。因此，$0\\%$ 的这些动物应该表现出 $P$。\n\n**模型 E（拟表型）下的预测**\n如果创始雄性是一个拟表型，他的基因型是野生型（$WW$），他的表型 $P$ 是由于在野外暴露于环境（$E^\\*$）所致。\n- **杂交 1**：创始雄性（$WW$）与野生型雌性（$WW$）交配。所有 $F_1$ 子代必然是 $WW$ 基因型。由于它们在标准环境 $E_0$（不暴露于 $E^\\*$）下饲养，没有一个个体将表现出该表型。因此，$0\\%$ 的 $F_1$ 将表现出表型 $P$。\n- **杂交 2**：$F_1$ 个体自交（$WW \\times WW$）将产生一个基因型完全为 $WW$ 的 $F_2$ 代。由于它们也在 $E_0$ 环境下饲养，它们不会暴露于诱导因子。因此，$0\\%$ 的 $F_2$ 代将表现出表型 $P$。\n- **关联检验**：创始者的表型 $P$ 不是遗传的。它出现在一个 $WW$ 个体中。因此，该表型将不会与 $W$ 基因座的任何等位基因在后代中分离。连锁分析将找不到关联。\n- **诱導检验**：模型指出 $E^\\*$ 会在 $WW$ 个体中诱导表型 $P$。因此，将一批 $WW$ 动物暴露于 $E^\\*$ 将导致其中一部分（比例 $q0$）表现出 $P$，而未暴露的对照组的发病率为 $0\\%$。\n\n我们现在根据模型 E 的预测来评估每个选项。\n\n**选项 A 分析**\n- “在 $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$”：这与两个模型都一致。\n- “在 $E_0$ 环境下的 $F_2$ 代：$0\\%$ 表现出 $P$”：这与模型 E 一致，但与模型 G（预测为 $25\\%$）矛盾。\n- “家系内连锁/关联分析未检测到 $P$与 $W$ 附近标记的共分离”：这与模型 E 一致，因为该性状不是遗传的。它与模型 G 矛盾。\n- “在诱导检验中，一部分比例为 $q0$ 的暴露于 $E^\\*$ 的 $WW$ 动物表现出 $P$，而在 $E_0$ 环境下该比例为 $0\\%$”：这是模型 E 定义的拟表型的决定性检验。它证实了环境而非基因型可以导致该表型。这一结果与模型 G 矛盾。\n**结论**：此选项中的所有观察结果都与模型 E 完全一致，而与模型 G 不一致。这是对拟表型的正确描述。\n\n**选项 B 分析**\n- “在 $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$”：与两个模型都一致。\n- “在 $E_0$ 环境下的 $F_2$ 代：大约 $25\\%$ 表现出 $P$”：这是隐性性状的经典孟德尔比例，强烈支持模型 G，并与模型 E 预测的 $0\\%$ 相矛盾。\n- “家系内分析揭示了 $P$ 与 $W$ 处一个单倍型存在共分离”：这表明存在与 W 基因座相关的遗传原因，支持模型 G，与模型 E 矛盾。\n- “在诱导检验中，$0\\%$ 的 $WW$ 动物在 $E^\\*$ 环境下表现出 $P$”：这暗示环境不诱导该表型，支持模型 G，与模型 E 矛盾。\n**结论**：这些观察结果是遗传原因（模型 G）的教科书式案例，而不是拟表型。此选项 **不正确**。\n\n**选项 C 分析**\n- “在一个群体队列中，一同抚養的双胞胎中，单卵双胞胎对于 $P$ 的同病率在 $E_0$ 环境下远超双卵双胞胎”：基因完全相同的双胞胎具有更高的同病率，是性状具有遗传基础的强有力证据。这支持模型 G。\n- “在 $E_0$ 环境下的 $F_2$ 代中，大约 $25\\%$ 表现出 $P$”：与选项 B 一样，这支持模型 G，与模型 E 矛盾。\n- “在 $W$ 处的家系内连锁分析呈阳性”：这再次指向 W 基因座的遗传原因，支持模型 G。\n**结论**：此选项描述了一个具有明确遗传病因的性状，与模型 G 一致，而非模型 E。此选项 **不正确**。\n\n**选项 D 分析**\n- “在 $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表現出 $P$”：与两个模型都一致。\n- “在 $E_0$ 环境下的 $F_2$ 代：大约 $25\\%$ 表现出 $P$”：这强烈支持模型 G，并直接与创始者是简单拟表型（模型 E）时应观察到的结果相矛盾。\n- “在 $W$ 处的家系内连锁呈阴性，但在 $W$ 附近观察到一个病例-对照关联，其 $p  10^{-9}$”：这是一个令人困惑且可能矛盾的陈述。如果 $W$ 处的一个隐性基因导致该表型，并在家系中分离产生 $25\\%$ 的比例，连锁分析*必须*为阳性。然而，强烈的关联信号仍然指向 $W$ 附近的遗传基础。$F_2$ 的结果是最直接的证据。\n- “在诱导检验中，一部分比例为 $q0$ 的暴露于 $E^\\*$ 的 $WW$ 动物表现出 $P$”：这支持模型 E。\n**结论**：此选项呈现了相互矛盾的结果。$F_2$ 代中 $25\\%$ 的表型证明了有一个隐性等位基因在分离，这要求创始者是 $ww$（或至少是 $Ww$，这未在题中给出）。这个结果与创始者是 $WW$ 拟表型的假设不相容。结果的组合可能暗示了更复杂的情景，如基因-环境相互作用，即两种因素都可导致该表型，但这并非与创始者特定案例是简单拟表型（由模型 E 定义）*最一致*的观察结果集。模型 E 明确预测 $F_2$ 代中有 $0\\%$ 受影响。选项 A 是一组清晰、内部一致的观察结果，与模型 E 的预测完美匹配。因此，选项 D **不正确**。\n\n基于系统性评估，选项 A 中的观察结果集为创始者表型是拟表型（模型 E）的假说提供了明确的支持，同时反驳了遗传假说（模型 G）。", "answer": "$$\\boxed{A}$$", "id": "2807824"}, {"introduction": "仅仅区分遗传和环境的贡献是不够的，我们常常需要量化它们之间的相互作用。本练习 [@problem_id:2807674] 提供了一个来自植物育种实验的具体数据集，并指导你完成双因素方差分析 (ANOVA) 的步骤。通过亲手计算互作效应的平方和并检验其显著性，你将掌握一种检测和衡量基因型-环境互作 (GxE) 的经典统计方法。", "problem": "一位植物育种家正在研究环境条件如何改变可观察性状并可能产生表型模拟，即环境影响模仿遗传效应的现象。为了量化基因型与环境的交互作用，该育种家在 $J=3$ 个受控环境中种植了 $I=3$ 个近交基因型，每个基因型-环境组合有 $r=2$ 个重复个体。测量的表型是幼苗高度。数据如下：\n\n- 基因型 $G_{1}$: \n  - 环境 $E_{1}$: $10$, $11$\n  - 环境 $E_{2}$: $12$, $12$\n  - 环境 $E_{3}$: $14$, $15$\n- 基因型 $G_{2}$:\n  - 环境 $E_{1}$: $12$, $11$\n  - 环境 $E_{2}$: $11$, $10$\n  - 环境 $E_{3}$: $10$, $9$\n- 基因型 $G_{3}$:\n  - 环境 $E_{1}$: $14$, $13$\n  - 环境 $E_{2}$: $13$, $14$\n  - 环境 $E_{3}$: $12$, $11$\n\n使用方差分析（ANOVA；Analysis of Variance）的框架，将基因型和环境作为具有重复的平衡双因素布局中的固定效应。从方差分解的基本原理出发，计算基因型-环境交互作用的平方和以及相应的均方误差，并构建 $F$-统计量来检验不存在基因型-环境交互作用的原假设。说明用于交互作用项和误差项的自由度。\n\n仅报告交互作用的 $F$-统计量作为最终答案。将您的答案四舍五入到 $4$ 位有效数字。$F$-统计量是无量纲的，不需要单位。", "solution": "问题陈述具有科学依据，提法恰当且客观。它提出了一个数量遗传学中的标准实验设计，需要使用双因素方差分析（ANOVA）进行分析。所有必要的数据都已提供，约束条件一致，且问题存在唯一解。因此，该问题是有效的，我们开始求解。\n\n该问题要求从基本原理出发，计算基因型-环境交互作用的 $F$-统计量。给定一个平衡双因素布局，其中有 $I=3$ 个基因型，$J=3$ 个环境，每个单元格有 $r=2$ 个重复。总观测数为 $N = I \\times J \\times r = 3 \\times 3 \\times 2 = 18$。对于观测值 $y_{ijk}$（基因型 $i$ 在环境 $j$ 中重复 $k$ 的表型），其统计模型为：\n$$y_{ijk} = \\mu + G_i + E_j + (GE)_{ij} + \\epsilon_{ijk}$$\n其中 $\\mu$ 是总平均值，$G_i$ 是第 $i$ 个基因型的固定效应，$E_j$ 是第 $j$ 个环境的固定效应，$(GE)_{ij}$ 是交互作用效应，$\\epsilon_{ijk}$ 是随机误差项。\n\n首先，我们整理数据并计算单元格总和 $T_{ij.} = \\sum_{k=1}^{r} y_{ijk}$，以及基因型的边际总和 $T_{i..} = \\sum_{j=1}^{J} T_{ij.}$ 和环境的边际总和 $T_{.j.} = \\sum_{i=1}^{I} T_{ij.}$。\n\n单元格总和 $T_{ij.}$ 如下：\n\\begin{itemize}\n    \\item $G_1, E_1: 10 + 11 = 21$\n    \\item $G_1, E_2: 12 + 12 = 24$\n    \\item $G_1, E_3: 14 + 15 = 29$\n    \\item $G_2, E_1: 12 + 11 = 23$\n    \\item $G_2, E_2: 11 + 10 = 21$\n    \\item $G_2, E_3: 10 + 9 = 19$\n    \\item $G_3, E_1: 14 + 13 = 27$\n    \\item $G_3, E_2: 13 + 14 = 27$\n    \\item $G_3, E_3: 12 + 11 = 23$\n\\end{itemize}\n\n边际总和如下：\n\\begin{itemize}\n    \\item 基因型总和 ($T_{i..}$):\n    \\begin{itemize}\n        \\item $T_{1..} = 21 + 24 + 29 = 74$\n        \\item $T_{2..} = 23 + 21 + 19 = 63$\n        \\item $T_{3..} = 27 + 27 + 23 = 77$\n    \\end{itemize}\n    \\item 环境总和 ($T_{.j.}$):\n    \\begin{itemize}\n        \\item $T_{.1.} = 21 + 23 + 27 = 71$\n        \\item $T_{.2.} = 24 + 21 + 27 = 72$\n        \\item $T_{.3.} = 29 + 19 + 23 = 71$\n    \\end{itemize}\n\\end{itemize}\n总和为 $T_{...} = 74 + 63 + 77 = 214$。作为核对，$T_{...} = 71 + 72 + 71 = 214$。\n\n方差分析的核心是将总平方和（$SS_{Total}$，即与总平均值的离差平方和）分解为可归因于不同变异来源的组分。\n$$SS_{Total} = SS_{G} + SS_{E} + SS_{GE} + SS_{Error}$$\n我们使用平方和的标准计算公式，从校正项 $CT = \\frac{T_{...}^2}{N}$ 开始。\n$$CT = \\frac{(214)^2}{18} = \\frac{45796}{18} = \\frac{22898}{9}$$\n\n计算过程如下：\n\n1.  **总平方和 ($SS_{Total}$):** $SS_{Total} = \\sum_{i,j,k} y_{ijk}^2 - CT$。\n    $$\\sum_{i,j,k} y_{ijk}^2 = 10^2+11^2+12^2+12^2+14^2+15^2+12^2+11^2+11^2+10^2+10^2+9^2+14^2+13^2+13^2+14^2+12^2+11^2 = 2592$$\n    $$SS_{Total} = 2592 - \\frac{22898}{9} = \\frac{23328 - 22898}{9} = \\frac{430}{9}$$\n\n2.  **误差平方和 ($SS_{Error}$):** 这代表了单元格内的变异。它是所有观测值的平方和与单元格均值间的平方和之差。\n    $$SS_{Error} = \\sum_{i,j,k} y_{ijk}^2 - \\sum_{i,j} \\frac{T_{ij.}^2}{r}$$\n    单元格总和的平方和为：\n    $$\\sum_{i,j} \\frac{T_{ij.}^2}{r} = \\frac{1}{2}(21^2 + 24^2 + 29^2 + 23^2 + 21^2 + 19^2 + 27^2 + 27^2 + 23^2) = \\frac{1}{2}(5176) = 2588$$\n    因此，\n    $$SS_{Error} = 2592 - 2588 = 4$$\n\n3.  **基因型平方和 ($SS_{G}$):**\n    $$SS_{G} = \\sum_{i} \\frac{T_{i..}^2}{Jr} - CT = \\frac{1}{3 \\times 2}(74^2 + 63^2 + 77^2) - \\frac{22898}{9} = \\frac{15374}{6} - \\frac{22898}{9} = \\frac{7687}{3} - \\frac{22898}{9} = \\frac{23061 - 22898}{9} = \\frac{163}{9}$$\n\n4.  **环境平方和 ($SS_{E}$):**\n    $$SS_{E} = \\sum_{j} \\frac{T_{.j.}^2}{Ir} - CT = \\frac{1}{3 \\times 2}(71^2 + 72^2 + 71^2) - \\frac{22898}{9} = \\frac{15266}{6} - \\frac{22898}{9} = \\frac{7633}{3} - \\frac{22898}{9} = \\frac{22899 - 22898}{9} = \\frac{1}{9}$$\n\n5.  **交互作用平方和 ($SS_{GE}$):** 这通过减法求得。小计的平方和（单元格间变异）为 $SS_{Subtotals} = \\sum_{i,j} (T_{ij.}^2/r) - CT = 2588 - 22898/9 = (23292 - 22898)/9 = 394/9$。\n    $$SS_{GE} = SS_{Subtotals} - SS_{G} - SS_{E} = \\frac{394}{9} - \\frac{163}{9} - \\frac{1}{9} = \\frac{394 - 163 - 1}{9} = \\frac{230}{9}$$\n\n接下来，我们确定相关项的自由度 ($df$):\n\\begin{itemize}\n    \\item $df_{GE} = (I-1)(J-1) = (3-1)(3-1) = 2 \\times 2 = 4$\n    \\item $df_{Error} = IJ(r-1) = 3 \\times 3 \\times (2-1) = 9 \\times 1 = 9$\n\\end{itemize}\n\n现在我们通过将平方和除以各自的自由度来计算均方 ($MS$):\n\\begin{itemize}\n    \\item 交互作用均方： $MS_{GE} = \\frac{SS_{GE}}{df_{GE}} = \\frac{230/9}{4} = \\frac{230}{36} = \\frac{115}{18}$\n    \\item 误差均方（即相应的均方误差）： $MS_{Error} = \\frac{SS_{Error}}{df_{Error}} = \\frac{4}{9}$\n\\end{itemize}\n\n最后，交互作用的 $F$-统计量是交互作用均方与误差均方的比值。这用于检验原假设 $H_0: (GE)_{ij} = 0$（对所有 $i,j$ 成立）。\n$$F_{GE} = \\frac{MS_{GE}}{MS_{Error}} = \\frac{115/18}{4/9} = \\frac{115}{18} \\times \\frac{9}{4} = \\frac{115}{2 \\times 4} = \\frac{115}{8} = 14.375$$\n\n问题要求将答案四舍五入到 $4$ 位有效数字。\n$$F_{GE} \\approx 14.38$$", "answer": "$$\\boxed{14.38}$$", "id": "2807674"}, {"introduction": "现实世界中的遗传数据结构往往比简单的方差分析设计更为复杂，需要更灵活的分析工具。本练习 [@problem_id:2807675] 要求你将一个复杂的生物学情景——涉及基因型特异的环境敏感性、拟表型效应以及变化的环境胁迫——转化为一个精确的线性混合模型 (LMM)。对于需要对反应规范和 GxE 进行建模的现代数量遗传学家而言，这项技能至关重要。", "problem": "一位实验者在一组 $I$ 个近交基因型中量化一个定量性状。这些基因型种植在 $J$ 个室外田间试验点，这些试验点在连续环境指数 $E_j$（例如，发育期间的日平均温度）上有所不同，每个基因型-环境单元有 $K$ 个重复个体。一部分试验点超过了一个已知会诱导一种模拟功能缺失突变体表型的阈值，这种表型与基因型无关（一种经典的拟表型）。对于这些试验点，定义一个指示变量 $H_j \\in \\{0,1\\}$，其中 $H_j=1$ 表示热休克条件。目标是使用一个线性混合模型（LMM）来模拟基因型特异性的环境响应（反应规范），该模型对 $E_j$ 使用随机斜率，同时也要考虑到在热应激下与拟表型相关的系统性偏移和增加的残差变异性。通过对 $E_j$ 进行中心化，应使截距在平均环境下具有可解释性。\n\n下列哪个模型设定正确地捕捉了这些要求？请选择唯一最佳选项。\n\nA. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $E_{cj} = E_j - \\bar{E}$，$\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  \\sigma_{b0b1} \\\\ \\sigma_{b0b1}  \\sigma^2_{b1} \\end{pmatrix} \\right)$，并且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0, \\sigma^2_{H(j)}\\right)$，其中如果 $H_j=1$，则 $\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{hot}}$，如果 $H_j=0$，则 $\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{cool}}$。\n\nB. $y_{ijk} = \\beta_0 + \\beta_H H_j + b_{0i} + b_{1i} H_j + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  0 \\\\ 0  \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$ 为同方差。\n\nC. $y_{ijk} = \\beta_0 + \\beta_E E_j + \\sum_{i'=1}^{I} \\gamma_{i'} \\mathbf{1}\\{i=i'\\} + \\sum_{i'=1}^{I} \\delta_{i'} \\mathbf{1}\\{i=i'\\} E_j + \\varepsilon_{ijk}$，其中 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。\n\nD. $y_{ijk} = \\beta_0 + \\beta_E E_{cj} + b_{0i} + \\varepsilon_{ijk}$，其中 $b_{0i} \\sim \\mathcal{N}(0,\\sigma^2_{b0})$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0,\\sigma^2_{H(j)}\\right)$ 如选项 A 中所述。\n\nE. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  0 \\\\ 0  \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。\n\n假设：不同基因型 $i$ 的所有随机项和残差项是相互独立的，环境指数 $E_j$ 的观测没有误差，并且实验设计包括至少 $J \\ge 3$ 个不同的 $E_j$ 值，其中既有 $H_j=0$ 的试验点，也有 $H_j=1$ 的试验点。", "solution": "问题陈述要求构建一个线性混合模型（LMM）来分析定量性状 $y_{ijk}$。该性状是在 $J$ 个田间试验点对 $I$ 个近交基因型进行测量的，每个单元有 $K$ 个重复。该模型必须满足几个特定标准。在评估所提供的选项之前，我将首先验证问题陈述，然后基于这些标准推导出正确的模型结构。\n\n### 问题验证\n\n**第一步：提取已知信息**\n- 响应变量：一个定量性状，记为 $y_{ijk}$，代表在试验点 $j$ 的基因型 $i$ 的第 $k$ 个个体。\n- 因子和协变量：\n    - $I$ 个近交基因型，以 $i$ 为索引。\n    - $J$ 个室外田间试验点，以 $j$ 为索引。\n    - 每个基因型-环境单元有 $K$ 个重复个体。\n    - 一个连续环境指数 $E_j$。\n    - 一个二元热休克指示变量 $H_j \\in \\{0,1\\}$，其中对于超过高温阈值的试验点，$H_j=1$。\n- 建模要求：\n    1.  使用线性混合模型（LMM）。\n    2.  使用关于 $E_j$ 的随机斜率来模拟基因型特异性的环境响应（反应规范）。\n    3.  考虑在热应激（$H_j=1$）下由拟表型引起的表型的系统性偏移。\n    4.  考虑在热应激下增加的残差变异性。\n    5.  模型截距必须在平均环境下具有可解释性，这要求对 $E_j$ 进行中心化。\n- 假设：\n    - 不同基因型 $i$ 的所有随机项和残差项是相互独立的。\n    - $E_j$ 的观测没有误差。\n    - 实验设计包括至少 $J \\ge 3$ 个不同的 $E_j$ 值，并同时包含 $H_j=0$ 和 $H_j=1$ 两种条件。\n\n**第二步：使用提取的已知信息进行验证**\n- **科学依据**：该问题在数量遗传学和统计建模方面有充分的理论基础。使用带随机斜率的LMM来模拟基因型与环境的相互作用是一种标准且科学上可靠的方法。拟表型、反应规范和异方差性等概念是现代遗传学的核心。\n- **适定性**：目标定义明确：确定一个能够包含一组特定生物学和统计学特征的模型的正确数学设定。问题的结构使得在给定选项中存在唯一的正确答案。\n- **客观性**：语言是技术性的、精确的，并且没有主观性。诸如“近交基因型”、“连续环境指数”和“随机斜率”等术语在该领域内有明确的定义。\n\n**第三步：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。它不包含任何逻辑矛盾、信息缺失或其他使其无效的缺陷。我将继续推导解决方案。\n\n### 正确模型的推导\n\n表型 $y_{ijk}$ 的模型必须通过将每个要求转换为一个数学项来构建。\n\n1.  **平均环境下的截距和群体平均环境响应**：要求5规定截距应在平均环境下具有可解释性。这通过对连续环境变量 $E_j$ 进行中心化来实现。设 $\\bar{E} = \\frac{1}{J}\\sum_{j=1}^{J} E_j$。中心化后的协变量为 $E_{cj} = E_j - \\bar{E}$。描述群体平均反应规范的模型的固定效应部分则为 $\\beta_0 + \\beta_E E_{cj}$，其中 $\\beta_0$ 是在平均环境（$E_{cj} = 0$）下的总体平均表型，$\\beta_E$ 是所有基因型反应规范的平均斜率。\n\n2.  **由拟表型引起的系统性偏移**：要求3指出模型必须考虑由热应激（由 $H_j=1$ 指示）引起的系统性偏移。这是一个适用于所有基因型的固定效应。通过添加项 $\\beta_H H_j$ 来正确建模，其中 $\\beta_H$ 表示在控制了 $E_{cj}$ 的效应后，热休克条件下的平均表型变化。\n\n3.  **基因型特异性反应规范（随机斜率）**：要求2要求使用随机斜率来模拟基因型特异性的反应规范。这意味着每个基因型 $i$ 都有其自己的截距和斜率。在线性混合模型中，这些被建模为与群体平均值的随机偏差。\n    - 基因型 $i$ 的截距是 $\\beta_0 + b_{0i}$，其中 $b_{0i}$ 是基因型 $i$ 的随机截距偏差。\n    - 基因型 $i$ 的斜率是 $\\beta_E + b_{1i}$，其中 $b_{1i}$ 是基因型 $i$ 的随机斜率偏差。\n    因此，特定基因型反应规范的组合项是 $(\\beta_0 + b_{0i}) + (\\beta_E + b_{1i}) E_{cj}$。分离出随机分量得到 $b_{0i} + b_{1i} E_{cj}$。随机效应 $(b_{0i}, b_{1i})$ 被假定来自一个群体分布，通常是多元正态分布。最普遍的形式允许截距和斜率之间存在协方差：\n    $$ \\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  \\sigma_{b0b1} \\\\ \\sigma_{b0b1}  \\sigma^2_{b1} \\end{pmatrix} \\right) $$\n    协方差项 $\\sigma_{b0b1}$ 至关重要，因为它模拟了基础性状值与环境敏感性之间的遗传相关性。\n\n4.  **增加的残差变异性**：要求4指明在热应激下残差变异性会增加。残差项 $\\varepsilon_{ijk}$ 解释了基因型-环境单元内重复间的变异。需要对不同条件下的不同方差进行建模（异方差性）。$\\varepsilon_{ijk}$ 的方差必须依赖于热休克指示变量 $H_j$。这被指定为 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0, \\sigma^2_{H(j)})$，其中方差 $\\sigma^2_{H(j)}$ 取两个不同的值：一个用于 $H_j=0$（例如 $\\sigma^2_{\\mathrm{cool}}$），另一个用于 $H_j=1$（例如 $\\sigma^2_{\\mathrm{hot}}$）。\n\n**完整模型设定**：\n结合所有分量，完整的模型方程为：\n$$ y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk} $$\n其分布假设为：\n$$ E_{cj} = E_j - \\bar{E} $$\n$$ \\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  \\sigma_{b0b1} \\\\ \\sigma_{b0b1}  \\sigma^2_{b1} \\end{pmatrix} \\right) $$\n$$ \\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0, \\sigma^2_{H(j)}\\right) $$\n\n### 选项评估\n\n**A. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $E_{cj} = E_j - \\bar{E}$，$\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  \\sigma_{b0b1} \\\\ \\sigma_{b0b1}  \\sigma^2_{b1} \\end{pmatrix} \\right)$，并且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0, \\sigma^2_{H(j)}\\right)$，其中如果 $H_j=1$，则 $\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{hot}}$，如果 $H_j=0$，则 $\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{cool}}$。**\n该设定与推导出的模型完全匹配。它正确地包括了：\n-   中心化的环境协变量（$E_{cj}$）。\n-   系统性热休克偏移的固定效应（$\\beta_H H_j$）。\n-   一个完整的随机截距和随机斜率模型（$b_{0i} + b_{1i} E_{cj}$），带有协方差项（$\\sigma_{b0b1}$）。\n-   依赖于热休克状态的异方差残差（$\\sigma^2_{H(j)}$）。\n**结论：正确**\n\n**B. $y_{ijk} = \\beta_0 + \\beta_H H_j + b_{0i} + b_{1i} H_j + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  0 \\\\ 0  \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$ 为同方差。**\n这个模型有根本性缺陷。它完全忽略了连续环境变量 $E_j$，而这对于模拟反应规范至关重要。它还错误地假设了同方差残差，违反了要求4。它完全没有对连续环境响应进行建模。\n**结论：不正确**\n\n**C. $y_{ijk} = \\beta_0 + \\beta_E E_j + \\sum_{i'=1}^{I} \\gamma_{i'} \\mathbf{1}\\{i=i'\\} + \\sum_{i'=1}^{I} \\delta_{i'} \\mathbf{1}\\{i=i'\\} E_j + \\varepsilon_{ijk}$，其中 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。**\n这是一个固定效应模型，而不是线性混合模型。它将基因型视为一个固定因子，这与要求1相矛盾。此外，它未能包含热休克固定效应（$\\beta_H H_j$），没有对异方差性进行建模，并使用了未中心化的协变量 $E_j$。\n**结论：不正确**\n\n**D. $y_{ijk} = \\beta_0 + \\beta_E E_{cj} + b_{0i} + \\varepsilon_{ijk}$，其中 $b_{0i} \\sim \\mathcal{N}(0,\\sigma^2_{b0})$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0,\\sigma^2_{H(j)}\\right)$ 如选项 A 中所述。**\n这个模型是一个仅有随机截距的模型。它缺少随机斜率项（$b_{1i} E_{cj}$），这是一个关键的失败，因为要求2明确要求使用随机斜率来模拟基因型特异性的环境响应。它也忽略了拟表型偏移的固定效应（$\\beta_H H_j$）。\n**结论：不正确**\n\n**E. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0}  0 \\\\ 0  \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。**\n这个模型更接近但仍然不正确。其主要缺陷是假设了同方差残差（$\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$），这与在热应激下模拟增加的残差变异性的要求相矛盾。一个次要的、不那么关键的缺陷是假设随机截距和斜率之间零协方差，这是一个没有被问题陈述所证实的简化。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2807675"}]}