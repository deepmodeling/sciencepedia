{"hands_on_practices": [{"introduction": "在遗传学分析中，准确区分外显率（penetrance）和表现度（expressivity）是解读基因型与表型关系的基础。本练习通过两个对比鲜明的假想家系，帮助你辨析这两个核心概念。掌握它们的差异，对于正确解释临床观察和实验数据至关重要[@problem_id:1508268]。", "problem": "一个遗传学家团队正在研究一种名为“时间敏感综合征”（Chrono-Sensitivity Syndrome, CSS）的人类显性遗传病，该病由单个常染色体显性等位基因 `C` 引起。携带至少一个 `C` 等位基因的个体预计会对昼夜节律的变化表现出高度敏感，从而导致严重的倒时差反应。研究人员调查了两个无亲缘关系的大型家系，即家系 A 和家系 B，已知 `C` 等位基因在这些家系中存在分离。\n\n*   **观察 1：** 在家系 A 中，基因检测显示有 50 名个体携带 `C` 等位基因。然而，经过广泛的访谈和临床生理测试，这 50 名个体中没有一人报告或表现出任何对昼夜节律变化敏感度增高的迹象。他们对倒时差的反应与 `cc` 基因型的家族成员无法区分。\n\n*   **观察 2：** 在家系 B 中，基因检测确定了 60 名携带 `C` 等位基因的个体。在临床检查中，当在实验室环境中人为改变他们的光暗周期时，他们每个人都表现出褪黑素分泌周期的统计学显著（尽管有时极其微小）的紊乱。这种紊乱是 CSS 的既定临床表型。然而，当被要求自我报告时，这些个体中只有 5 人认为他们在日常生活中遭受异常严重的倒时差反应。其他 55 人报告称，与他们认为的正常情况相比，没有发现显著差异。\n\n在遗传学原理的背景下，下列哪个陈述正确地解释了这些观察结果？\n\nA. 观察 1 描述了 100% 的外显率和低表现度，观察 2 描述了不完全外显。\n\nB. 观察 1 描述了 0% 的外显率，观察 2 描述了 100% 的外显率和可变表现度。\n\nC. 两个观察都是不完全外显的例子，其中观察 1 的外显率低于观察 2。\n\nD. 观察 1 描述了基因多效性，观察 2 描述了 0% 的外显率。\n\nE. 两个观察都是 100% 外显率的例子，但观察 1 显示低表现度，而观察 2 显示高表现度。", "solution": "将外显率定义为：具有特定基因型的个体中，表现出与该基因型相关的任何可检测表型的比例。将表现度定义为：在外显（即表现出表型）的个体中，表型表现出的程度或严重性。\n\n对于观察 1，有 50 名个体携带显性等位基因，但没有一人表现出任何临床或自我报告的表型。因为没有携带者表现出既定的临床表型，所以该家系的外显率为零。这不能被描述为低表现度，因为表现度仅与表现出表型的个体有关；在这里，没有表型受影响的个体。因此，观察 1 符合零外显率。\n\n对于观察 2，所有 60 名携带者都表现出可测量的临床表型（在光暗周期改变时褪黑素分泌紊乱），这正是 CSS 的定义。因此，根据临床定义，外显率等于 1。只有 5 人报告严重的倒时差反应，而 55 人报告没有异常症状，这一事实反映了表型在日常体验中表现程度的变异性。这是表现度的变异，而不是外显率的问题，因为所有携带者在临床上都受到了影响。因此，观察 2 显示了完全外显和可变表现度。\n\n综合以上两点，正确的解释是：观察 1 描述了零外显率，而观察 2 描述了完全（等于 1）外显率和可变表现度。", "answer": "$$\\boxed{B}$$", "id": "1508268"}, {"introduction": "不完全外显率给遗传预测带来了不确定性，尤其是在遗传咨询中。这个练习模拟了一个常见情景：当一个携带致病等位基因但表型正常的个体出现时，我们如何重新评估其基因型？通过本题，你将练习使用条件概率来量化这种不确定性，这是现代遗传分析的一项关键技能[@problem_id:1508286]。", "problem": "一种罕见的人类假想遗传病，被称为“Neuro-Luminance Deficiency”，是由单个常染色体显性等位基因（记作 $N$）引起的。其对应的隐性等位基因为 $n$。拥有至少一个 $N$ 等位基因的个体在遗传上易患此病。然而，由于不完全外显，广泛的群体遗传学研究已确定该等位基因的外显率为 75%。这意味着 75% 具有易感基因型（$NN$ 或 $Nn$）的个体将实际表现出该疾病的症状。\n\n一名此病的杂合子男性（$Nn$）和一名纯合隐性（$nn$）因此表型正常的女性计划生育一个孩子。孩子出生并度过典型发病年龄后，观察到该孩子没有表现出任何 Neuro-Luminance Deficiency 的症状。\n\n鉴于观察到该孩子表型正常，该孩子是该等位基因的杂合子携带者（$Nn$）的概率是多少？请用最简分数表示你的答案。", "solution": "设 $N$ 代表导致 Neuro-Luminance Deficiency 的显性等位基因，$n$ 代表隐性等位基因。亲代杂交为杂合子男性（$Nn$）与纯合隐性女性（$nn$）。\n\n首先，我们使用庞尼特方格确定后代的预期基因型概率。\n男性亲本（$Nn$）产生的配子为 $N$ 和 $n$，每种的概率为 $\\frac{1}{2}$。\n女性亲本（$nn$）只产生 $n$ 配子。\n子代的基因型结果为：\n- $Nn$（杂合子），概率为 $P(Nn) = \\frac{1}{2} \\times 1 = \\frac{1}{2}$。\n- $nn$（纯合隐性），概率为 $P(nn) = \\frac{1}{2} \\times 1 = \\frac{1}{2}$。\n\n问题指出 $N$ 等位基因的外显率为 75%，即 0.75。外显率定义为在特定基因型下表现出某种表型的概率。\n因此，基因型为 $Nn$ 的个体表现出症状的概率为 $P(\\text{有症状} | Nn) = 0.75$。\n\n我们关心的是孩子表型正常的事件，这意味着孩子没有表现出症状。杂合子个体（$Nn$）不表现出症状的概率是外显率的补集：\n$P(\\text{无症状} | Nn) = 1 - P(\\text{有症状} | Nn) = 1 - 0.75 = 0.25 = \\frac{1}{4}$。\n\n对于纯合隐性基因型（$nn$）的个体，他们不携带致病等位基因，因此不会表现出该疾病。所以，他们没有症状的概率是 1：\n$P(\\text{无症状} | nn) = 1$。\n\n问题要求的是一个条件概率：在孩子没有症状的*条件下*，其基因型为 $Nn$ 的概率。我们可以使用贝叶斯定理或条件概率的定义 $P(A | B) = \\frac{P(A \\cap B)}{P(B)}$ 来表示：\n$$P(Nn | \\text{无症状}) = \\frac{P(Nn \\cap \\text{无症状})}{P(\\text{无症状})}$$\n\n我们先计算分子。项 $P(Nn \\cap \\text{无症状})$ 是一个孩子既是杂合子又没有症状的联合概率。\n$P(Nn \\cap \\text{无症状}) = P(\\text{无症状} | Nn) \\times P(Nn)$\n$P(Nn \\cap \\text{无症状}) = \\frac{1}{4} \\times \\frac{1}{2} = \\frac{1}{8}$。\n\n接下来，我们计算分母 $P(\\text{无症状})$，这是一个孩子表型正常的总概率。一个孩子可以通过两种互斥的方式表现正常：\n1. 他们的基因型是 $Nn$ 并且没有表达该基因。\n2. 他们的基因型是 $nn$。\n\n使用全概率定律：\n$P(\\text{无症状}) = P(Nn \\cap \\text{无症状}) + P(nn \\cap \\text{无症状})$\n我们已经从之前的计算中得到了第一项：$P(Nn \\cap \\text{无症状}) = \\frac{1}{8}$。\n第二项是：\n$P(nn \\cap \\text{无症状}) = P(\\text{无症状} | nn) \\times P(nn)$\n$P(nn \\cap \\text{无症状}) = 1 \\times \\frac{1}{2} = \\frac{1}{2}$。\n\n现在，我们将这些概率相加，以求出没有症状的总概率：\n$P(\\text{无症状}) = \\frac{1}{8} + \\frac{1}{2} = \\frac{1}{8} + \\frac{4}{8} = \\frac{5}{8}$。\n\n最后，我们可以计算条件概率：\n$$P(Nn | \\text{无症状}) = \\frac{P(Nn \\cap \\text{无症状})}{P(\\text{无症状})} = \\frac{\\frac{1}{8}}{\\frac{5}{8}}$$\n$$P(Nn | \\text{无症状}) = \\frac{1}{8} \\times \\frac{8}{5} = \\frac{1}{5}$$\n\n因此，在孩子表型正常的条件下，他们是杂合子携带者的概率是 $\\frac{1}{5}$。", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "1508286"}, {"introduction": "为了在群体水平上进行严谨的定量分析，我们需要将外显率等遗传学概念用精确的数学语言来描述。本练习旨在将外显率的生物学直觉与统计推断联系起来，指导你从第一性原理出发，推导出外显率参数的最大似然估计量。这个过程不仅巩固了你对该概念的理解，也展示了它在现代遗传学研究中是如何被量化和建模的[@problem_id:2836207]。", "problem": "由于不完全外显，单基因性状在携带相同基因型的个体中表现出不同的存在情况，而通过将表型二分化，其严重程度（表现度）的变异被忽略。令 $Y \\in \\{0,1\\}$ 表示目标性状的存在（$Y=1$）或不存在（$Y=0$），令 $G$ 表示基因型。对于一个固定的基因型类别 $g$，将外显率函数定义为条件概率 $\\pi_g = \\Pr(Y=1 \\mid G=g)$。假设你对 $n_g$ 个已知基因型为 $g$ 的无亲缘关系个体进行抽样，在给定 $G=g$ 的条件下，这些个体的表型是条件独立的，并且你观察到 $y_g$ 个个体的 $Y=1$。\n\n仅使用外显率作为条件概率的核心定义、二元性状的伯努利模型以及同一基因型类别内个体的独立性，完成以下任务：\n\n- 证明使用由 $\\pi_g$ 参数化的特定于基因型的伯努利似然对基因型 $g$ 的数据进行建模是合理的。\n- 通过恰当地组合独立的伯努利试验，根据观测计数 $(y_g, n_g)$ 构建 $\\pi_g$ 的似然函数。\n- 从第一性原理出发，推导最大似然估计（MLE）$\\hat{\\pi}_g$，该估计使关于 $\\pi_g$ 的似然最大化，并注意考虑在边界 $\\pi_g \\in [0,1]$ 处的行为。\n\n以 $y_g$ 和 $n_g$ 表示的单个闭式解析表达式的形式提供你的最终答案 $\\hat{\\pi}_g$。不需要进行数值计算，也不适用任何单位。最终答案中不应包含任何其他量。", "solution": "该问题要求从第一性原理出发进行三部分推导。\n\n首先，我们必须证明使用特定于基因型的伯努利似然是合理的。\n对于任何一个已知基因型为 $g$ 的个体 $i$，其表型 $Y_i$ 是一个二元随机变量。它可以取两个值之一：$Y_i=1$（性状存在）或 $Y_i=0$（性状不存在）。根据定义，观察到该性状的概率是外显率，即 $\\Pr(Y_i=1 \\mid G=g) = \\pi_g$。因此，未观察到该性状的概率是 $\\Pr(Y_i=0 \\mid G=g) = 1 - \\Pr(Y_i=1 \\mid G=g) = 1 - \\pi_g$。根据定义，一个以概率 $p$ 取值 $1$、以概率 $1-p$ 取值 $0$ 的随机变量是伯努利随机变量。因此，基因型为 $g$ 的个体的表型 $Y_i$ 服从参数为 $\\pi_g$ 的伯努利分布，记为 $Y_i \\sim \\text{Bernoulli}(\\pi_g)$。单个观测值 $y_i \\in \\{0, 1\\}$ 的概率质量函数可以紧凑地写为 $f(y_i \\mid \\pi_g) = \\pi_g^{y_i} (1-\\pi_g)^{1-y_i}$。这就提供了单个观测的似然。\n\n其次，我们为整个样本构建似然函数。\n我们有一个包含 $n_g$ 个基因型为 $g$ 的个体的样本。他们观察到的表型是 $y_1, y_2, \\ldots, y_{n_g}$。问题陈述，在给定基因型的情况下，表型是条件独立的。观测数据的似然是观察到这个特定表型序列的联合概率，由于独立性，它是各个概率的乘积：\n$$\nL(\\pi_g \\mid y_1, \\ldots, y_{n_g}) = \\prod_{i=1}^{n_g} \\Pr(Y_i=y_i \\mid \\pi_g)\n$$\n代入每个个体的伯努利概率质量函数，我们得到：\n$$\nL(\\pi_g) = \\prod_{i=1}^{n_g} \\pi_g^{y_i} (1-\\pi_g)^{1-y_i}\n$$\n利用指数的性质，我们可以合并这些项：\n$$\nL(\\pi_g) = \\pi_g^{\\sum_{i=1}^{n_g} y_i} (1-\\pi_g)^{\\sum_{i=1}^{n_g} (1-y_i)}\n$$\n总和 $\\sum_{i=1}^{n_g} y_i$ 是具有该性状的个体总数，即给定的 $y_g$。第二个指数是 $\\sum_{i=1}^{n_g} 1 - \\sum_{i=1}^{n_g} y_i = n_g - y_g$，即不具有该性状的个体总数。\n因此，给定观测计数 $(y_g, n_g)$ 时 $\\pi_g$ 的似然函数是：\n$$\nL(\\pi_g) = \\pi_g^{y_g} (1-\\pi_g)^{n_g - y_g}\n$$\n该函数与总计数 $y_g$ 的二项分布 Binomial$(n_g, \\pi_g)$ 的概率质量函数成正比。\n\n第三，我们推导最大似然估计（MLE）$\\hat{\\pi}_g$。\nMLE是使似然函数 $L(\\pi_g)$ 最大化的 $\\pi_g$ 值。最大化似然的自然对数，即对数似然函数 $\\ell(\\pi_g) = \\ln(L(\\pi_g))$，是等价的，并且在算术上更简单。\n$$\n\\ell(\\pi_g) = \\ln\\left( \\pi_g^{y_g} (1-\\pi_g)^{n_g - y_g} \\right) = y_g \\ln(\\pi_g) + (n_g - y_g) \\ln(1-\\pi_g)\n$$\n为了找到最大值，我们计算 $\\ell(\\pi_g)$ 关于 $\\pi_g$ 的一阶导数并将其设为零。这在 $\\pi_g \\in (0,1)$ 时有效。\n$$\n\\frac{d\\ell}{d\\pi_g} = \\frac{d}{d\\pi_g} \\left[ y_g \\ln(\\pi_g) + (n_g - y_g) \\ln(1-\\pi_g) \\right] = \\frac{y_g}{\\pi_g} - \\frac{n_g - y_g}{1-\\pi_g}\n$$\n将导数设为零以找到临界点 $\\hat{\\pi}_g$：\n$$\n\\frac{y_g}{\\hat{\\pi}_g} - \\frac{n_g - y_g}{1-\\hat{\\pi}_g} = 0\n$$\n$$\n\\frac{y_g}{\\hat{\\pi}_g} = \\frac{n_g - y_g}{1-\\hat{\\pi}_g}\n$$\n$$\ny_g(1-\\hat{\\pi}_g) = \\hat{\\pi}_g(n_g - y_g)\n$$\n$$\ny_g - y_g\\hat{\\pi}_g = n_g\\hat{\\pi}_g - y_g\\hat{\\pi}_g\n$$\n$$\ny_g = n_g\\hat{\\pi}_g\n$$\n解出 $\\hat{\\pi}_g$ 得：\n$$\n\\hat{\\pi}_g = \\frac{y_g}{n_g}\n$$\n该解在定义域内部有效，其中 $0  y_g  n_g$。我们还必须按要求考虑边界情况。\n情况1：$y_g = 0$。对数似然函数变为 $\\ell(\\pi_g) = n_g \\ln(1-\\pi_g)$。对于 $\\pi_g \\in [0, 1)$，此函数是单调递减的。它在此定义域上的最大值出现在 $\\pi_g$ 的最小可能值处，即 $\\pi_g=0$。所以，$\\hat{\\pi}_g = 0$。公式 $\\frac{y_g}{n_g}$ 给出 $\\frac{0}{n_g}=0$。\n情况2：$y_g = n_g$。对数似然函数变为 $\\ell(\\pi_g) = n_g \\ln(\\pi_g)$。对于 $\\pi_g \\in (0, 1]$，此函数是单调递增的。它在此定义域上的最大值出现在 $\\pi_g$ 的最大可能值处，即 $\\pi_g=1$。所以，$\\hat{\\pi}_g = 1$。公式 $\\frac{y_g}{n_g}$ 给出 $\\frac{n_g}{n_g}=1$。\n因此，表达式 $\\hat{\\pi}_g = \\frac{y_g}{n_g}$ 对所有可能的 $y_g$ 值（从 $0$ 到 $n_g$）均有效。\n\n为确认此临界点是最大值点，我们检查二阶导数：\n$$\n\\frac{d^2\\ell}{d\\pi_g^2} = \\frac{d}{d\\pi_g} \\left[ \\frac{y_g}{\\pi_g} - \\frac{n_g - y_g}{1-\\pi_g} \\right] = -\\frac{y_g}{\\pi_g^2} - \\frac{n_g-y_g}{(1-\\pi_g)^2}\n$$\n对于 $0  \\pi_g  1$，并且给定 $y_g \\ge 0$ 和 $n_g - y_g \\ge 0$，二阶导数中的两项都是非正的。只要 $0  y_g  n_g$，两项都是严格为负的，因此 $\\frac{d^2\\ell}{d\\pi_g^2}  0$。这证实了对数似然函数是凹函数，并且该临界点是全局最大值点。推导出的估计量是受影响个体的样本比例，这与直觉相符。", "answer": "$$\\boxed{\\frac{y_g}{n_g}}$$", "id": "2836207"}]}