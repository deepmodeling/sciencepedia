{"hands_on_practices": [{"introduction": "在将基因定位理论付诸实践之前，一个至关重要的步骤是设计体细胞杂交组合本身。一个核心问题是确定必要的组合大小，以确保高成功率。本练习将引导你完成概率推理，计算所需的杂交克隆数量，以确保目标染色体至少被一个克隆所代表。这是实验设计的一个基本方面，它平衡了实验成本和统计功效。[@problem_id:2851993]", "problem": "在用于人类基因定位的体细胞杂交中，通过将人类细胞与啮齿动物细胞融合，生成一组独立衍生的体细胞杂交株，以获得保留了部分人类染色体的克隆。对于携带一个目的基因的特定人类染色体，假设每个独立衍生的杂交株以概率 $p$ 保留该染色体，并以概率 $1-p$ 不保留它。假设各个杂交株中的保留事件是独立同分布的伯努利试验，并且 $0  p  1$。为了确保有至少 $95\\%$ 的概率，该染色体至少被一个杂交株所代表，需要生成多少个独立的杂交株（$N$）？请推导出一个表达式，用于计算所需的最小杂交株数量 $N$。", "solution": "在尝试任何解答之前，该问题将首先经过严格的验证程序。\n\n### 步骤 1：提取已知条件\n问题陈述提供了以下信息：\n- 生成了一组体细胞杂交株。\n- 杂交株组规模由整数 $N$ 表示。\n- 对于一个特定的人类染色体，每个杂交株以概率 $p$ 保留它。\n- 每个杂交株以概率 $1-p$ 不保留它。\n- 各个杂交株的保留事件是独立同分布的伯努利试验。\n- 参数 $p$ 受限于 $0  p  1$。\n- 要求该染色体至少被一个杂交株代表的概率至少为 $L = 0.95$。\n\n### 步骤 2：建立概率模型\n- 单个杂交株不保留该染色体的概率是 $1-p$。\n- 由于保留事件是独立的，因此 $N$ 个杂交株都不保留该染色体的概率是 $(1-p)^{N}$。\n- 该染色体至少被一个杂交株代表的事件，是“没有一个杂交株保留该染色体”这一事件的补集。\n- 因此，该染色体至少被一个杂交株代表的概率是 $P(\\text{至少一个保留}) = 1 - (1-p)^{N}$。\n\n### 步骤 3：求解 $N$\n我们要求这个概率至少为 $L=0.95$：\n$$1 - (1-p)^{N} \\ge 0.95$$\n重新整理不等式来求解 $N$：\n$$(1-p)^{N} \\le 1 - 0.95$$\n$$(1-p)^{N} \\le 0.05$$\n对两边取自然对数。由于 $0  p  1$，所以 $0  1-p  1$，这意味着 $\\ln(1-p)$ 是负数。当用负数除不等式两边时，不等式的方向会反转：\n$$N \\ln(1-p) \\le \\ln(0.05)$$\n$$N \\ge \\frac{\\ln(0.05)}{\\ln(1-p)}$$\n由于 $N$ 必须是整数，所以我们必须取大于或等于右侧值的最小整数。这正是向上取整函数（ceiling function）的定义。\n\n### 步骤 4：最终表达式\n所需的最小杂交株数量 $N$ 的表达式是：\n$$ N = \\left\\lceil \\frac{\\ln(0.05)}{\\ln(1-p)} \\right\\rceil $$", "answer": "$$\n\\boxed{\nN = \\left\\lceil \\frac{\\ln(0.05)}{\\ln(1-p)} \\right\\rceil\n}\n$$", "id": "2851993"}, {"introduction": "从精心设计的组合中收集数据后，主要任务是从24种人类染色体中找出与目标基因表现出最强关联的染色体。本练习模拟了一个真实世界的数据分析场景，要求你构建一个完整的计算流程。你将学习使用严谨的统计检验来评估关联性，并且至关重要地，学习如何校正多重假设检验以控制假阳性发现率，这是现代基因组分析的基石。[@problem_id:2851942]", "problem": "给定来自一个体细胞杂交板的二元存在/缺失数据。对于每个人类染色体，有一个二元向量指示该染色体是否存在于每个杂交细胞系中。对于一个目标基因，有一个二元向量指示是否在每个杂交细胞系中检测到该人类基因的产物。基本出发点是这样一个观察：在体细胞杂交定位中，一个人类基因的可检测产物与其携带该基因的人类染色体的存在发生共分离。在没有定位关系的零假设下，染色体存在向量和基因检测向量在各个杂交细胞系之间是独立的。\n\n请为给定的基因向量和一组固定的染色体向量，制定一个数学上明确定义的过程。该过程需要选择最可能的染色体分配，同时将错误发现率（FDR；False Discovery Rate）控制在用户指定的水平。该过程必须满足以下所有约束条件：\n- 对于每个染色体 $i \\in \\{1,\\dots,m\\}$（其中 $m = 24$），根据以下计数构建 $2 \\times 2$ 列联表\n  - $a_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 1 \\land c_{i,j} = 1\\}$,\n  - $b_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 1 \\land c_{i,j} = 0\\}$,\n  - $c_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 0 \\land c_{i,j} = 1\\}$,\n  - $d_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 0 \\land c_{i,j} = 0\\}$,\n  其中 $g \\in \\{0,1\\}^n$ 是基因向量，$c_i \\in \\{0,1\\}^n$ 是染色体 $i$ 的向量，$n$ 是杂交细胞系的数量。\n- 对于每个染色体 $i$，使用具有固定边际的 $2 \\times 2$ 表，计算一个有效的单边精确 $p$ 值，用于检验独立性零假设，其备择假设为正相关（共存富集）。\n- 使用 Benjamini–Hochberg 升阶程序调整这组 $m$ 个 $p$ 值，以获得 FDR 调整后的 $q$ 值，从而将预期的错误发现比例控制在水平 $\\alpha$。\n- 选择具有最小调整后 $q$ 值的索引 $k \\in \\{1,\\dots,m\\}$ 作为该基因的染色体分配；如果该最小 $q$ 值超过 $\\alpha$，则返回 $k = 0$（无分配）。如果在等于或低于 $\\alpha$ 的最小 $q$ 值上出现平局，选择平局最小值中最小的染色体索引。如果基因向量没有变异（所有条目相等），则返回 $k = 0$ 和 $q = 1$。\n\n将此过程实现为一个确定性程序，该程序对以下固定的测试套件进行操作。现有 $n = 12$ 个杂交细胞系和 $m = 24$ 个人类染色体，其染色体-细胞系存在矩阵 $C \\in \\{0,1\\}^{24 \\times 12}$ 按行定义如下：\n- 染色体 $1$： $[\\,1,0,0,1,0,1,0,1,0,0,1,0\\,]$\n- 染色体 $２$： $[\\,0,1,1,0,1,0,1,0,1,0,0,1\\,]$\n- 染色体 $３$： $[\\,1,1,0,0,1,1,0,0,1,0,0,1\\,]$\n- 染色体 $４$： $[\\,0,0,1,1,0,0,1,1,0,1,0,0\\,]$\n- 染色体 $５$： $[\\,1,0,1,1,0,0,1,0,1,0,0,0\\,]$\n- 染色体 $６$： $[\\,0,1,0,0,1,1,0,1,0,1,0,0\\,]$\n- 染色体 $７$： $[\\,1,0,1,0,1,0,1,0,1,0,1,0\\,]$\n- 染色体 $８$： $[\\,0,1,0,1,0,1,0,1,0,1,0,1\\,]$\n- 染色体 $９$： $[\\,1,1,1,0,0,0,1,1,0,0,0,1\\,]$\n- 染色体 $10$： $[\\,0,0,0,1,1,1,0,0,1,1,1,0\\,]$\n- 染色体 $11$： $[\\,1,0,0,0,1,0,0,1,0,0,1,1\\,]$\n- 染色体 $12$： $[\\,1,1,1,0,1,0,1,0,1,0,1,0\\,]$\n- 染色体 $13$： $[\\,0,1,1,1,0,1,0,1,0,1,0,0\\,]$\n- 染色体 $14$： $[\\,1,0,1,0,0,1,1,0,0,1,0,1\\,]$\n- 染色体 $15$： $[\\,0,1,0,1,1,0,0,1,1,0,1,0\\,]$\n- 染色体 $16$： $[\\,1,1,0,1,0,1,0,0,0,1,0,1\\,]$\n- 染色体 $17$： $[\\,0,0,1,0,1,0,1,1,0,0,1,0\\,]$\n- 染色体 $18$： $[\\,1,0,0,1,0,1,0,0,1,0,1,0\\,]$\n- 染色体 $19$： $[\\,0,1,1,0,1,0,0,1,0,1,0,1\\,]$\n- 染色体 $20$： $[\\,1,1,0,1,0,0,1,0,1,0,1,0\\,]$\n- 染色体 $21$： $[\\,0,0,1,1,0,1,0,1,0,1,0,1\\,]$\n- 染色体 $22$： $[\\,1,0,0,0,1,1,1,0,0,1,0,0\\,]$\n- 染色体 $23$： $[\\,0,1,0,0,0,1,1,0,1,0,1,0\\,]$\n- 染色体 $24$： $[\\,1,0,1,0,0,0,1,0,0,0,1,1\\,]$\n\n使用 FDR 水平 $\\alpha = 0.05$，在以下四个基因向量（每个长度为 $n = 12$）上评估您的程序：\n- 基因案例 $1$： $[\\,1,0,1,0,1,0,1,0,1,0,1,0\\,]$\n- 基因案例 $2$： $[\\,1,1,1,0,1,0,1,0,1,0,1,0\\,]$\n- 基因案例 $3$： $[\\,0,1,0,1,0,1,0,1,0,1,0,1\\,]$\n- 基因案例 $4$： $[\\,0,0,0,0,0,0,0,0,0,0,0,0\\,]$\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个基因案例必须产生一个双元素列表 $[k, q]$，其中 $k$ 是所选的染色体索引（在 $\\{0,1,\\dots,24\\}$ 中），$q$ 是该基因的最小调整后 $q$ 值。使用标准四舍五入法，将 $q$ 报告为精确到 $4$ 位小数。因此，输出必须是形式为\n$[[k_1,q_1],[k_2,q_2],[k_3,q_3],[k_4,q_4]]$ 的单行。\n\n不提供外部输入；所有数据如上嵌入，并且没有物理单位。不涉及角度。所有概率必须作为小数处理，而不是百分比。", "solution": "该问题要求实现一个确定性程序，根据来自体细胞杂交板的共分离数据，将一个基因定位到一条人类染色体上。该程序必须基于统计学原理，特别是在多重假设检验的背景下，使用列联表分析、用于显著性检验的 Fisher 精确检验以及用于控制错误发现率（FDR）的 Benjamini-Hochberg 方法。该问题在科学上是有效的、定义明确的，并包含构建解决方案所需的所有必要信息。\n\n体细胞杂交定位的核心原理是，一个基因与其所在的染色体应在一组杂交细胞系中共同存在或共同缺失。由于实验现实，如染色体断裂或测量误差，这种一致性很少是完美的。因此，需要统计方法来识别最可能的染色体分配。\n\n该过程将针对给定的四个基因向量中的每一个逐步实施。设 $g \\in \\{0,1\\}^n$ 为跨越 $n=12$ 个细胞系的基因检测向量，设 $C$ 为 $m \\times n$ 矩阵，其中如果染色体 $i$ 存在于细胞系 $j$ 中，则 $C_{i,j}$ 为 $1$，否则为 $0$，对于 $m=24$ 个染色体。FDR 控制水平为 $\\alpha = 0.05$。\n\n首先，处理一个特殊情况：如果基因向量 $g$ 没有显示出变异（所有条目均为 $0$ 或均为 $1$），则无法进行有意义的关联分析。根据问题陈述，对于这样的基因，分配的染色体索引为 $k=0$，相关的 $q$ 值为 $q=1.0$。\n\n对于具有变异的基因向量，执行以下步骤：\n\n1.  **列联表构建**：对于 $m=24$ 个染色体中的每一个，我们检验与该基因关联的假设。对于每个染色体 $i$，我们构建一个 $2 \\times 2$ 列联表，总结其与基因向量 $g$ 在 $n=12$ 个细胞系中的共现计数：\n    $$\n    \\begin{array}{|c|cc|c|}\n    \\hline\n      \\text{染色体 } i \\text{ 存在}  \\text{染色体 } i \\text{ 缺失}  \\text{总计} \\\\\n    \\hline\n    \\text{基因存在}  a_i  b_i  a_i+b_i \\\\\n    \\text{基因缺失}  c_i  d_i  c_i+d_i \\\\\n    \\hline\n    \\text{总计}  a_i+c_i  b_i+d_i  n \\\\\n    \\hline\n    \\end{array}\n    $$\n    计数定义为：$a_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 1 \\land c_{i,j} = 1\\}$, $b_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 1 \\land c_{i,j} = 0\\}$, $c_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 0 \\land c_{i,j} = 1\\}$, 以及 $d_i = \\sum_{j=1}^{n} \\mathbf{1}\\{g_j = 0 \\land c_{i,j} = 0\\}$。\n\n2.  **P值计算**：零假设是基因的存在与染色体 $i$ 的存在是独立的。我们针对正相关的备择假设对此进行检验，即基因和染色体倾向于比随机预期的更频繁地共同出现。这对应于计数 $a_i$ 的富集。对于像 $n=12$ 这样的小样本量，Fisher 精确检验是合适的方法。它计算在给定行和列边际总和固定的情况下，观察到至少与观测表一样极端的表的概率。特定表配置 $(a,b,c,d)$ 的概率由超几何分布给出：\n    $$ P(a,b,c,d) = \\frac{(a+b)!(c+d)!(a+c)!(b+d)!}{n! a! b! c! d!} $$\n    用于正相关的单边 $p$ 值是所有具有相同边际且左上角单元格计数大于或等于观测到的 $a_i$ 的表的概率之和。这将为每个染色体计算，从而产生一组 $m=24$ 个 p 值，$\\{p_1, p_2, \\dots, p_{24}\\}$。\n\n3.  **错误发现率控制**：执行 $24$ 个统计检验需要进行多重比较校正。使用 Benjamini-Hochberg (BH) 程序来控制 FDR。该程序将原始 $p$ 值转换为 FDR 调整后的 $q$ 值。算法如下：\n    a.  将 $m$ 个 p 值按升序排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。让与这些排序后的 p 值对应的原始染色体索引为 $idx_{(1)}, idx_{(2)}, \\dots, idx_{(m)}$。\n    b.  为每个排序后的 p 值计算一个中间 q 值：$q_{(i)} = \\frac{p_{(i)} \\cdot m}{i}$。\n    c.  为确保 q 值随 p 值单调非递减，强制执行升阶调整。设 $q'_{(m)} = \\min(1, q_{(m)})$。对于 $i = m-1, m-2, \\dots, 1$，计算 $q'_{(i)} = \\min(1, q_{(i)}, q'_{(i+1)})$。这确保了如果 p 值为 $p_{(i)}$ 的检验被认为是显著的，那么所有具有更小 p 值的检验也都是显著的。\n    d.  每个原始染色体 $j$ 的最终调整后 q 值是 $q'_{(i)}$，其中 $idx_{(i)} = j$。\n\n4.  **染色体分配**：将最终的分配规则应用于调整后的 $q$ 值集合：\n    a.  找到最小的调整后 q 值，$q_{min} = \\min_{i} \\{q_i\\}$。\n    b.  如果 $q_{min} > \\alpha = 0.05$，则没有染色体与该基因显著相关。结果是染色体索引 $k=0$ 和值 $q_{min}$。\n    c.  如果 $q_{min} \\le \\alpha$，则发现显著关联。分配的染色体是对应于此最小 $q$ 值的那一个。如果出现平局（多个染色体共享相同的最小 $q$ 值），则选择染色体索引最小的那一个。结果是所选的染色体索引 $k \\in \\{1, \\dots, 24\\}$ 和值 $q_{min}$。\n    d.  最终报告的 $q$ 值四舍五入到四位小数。\n\n这整个过程被封装在一个程序中，该程序处理给定的染色体矩阵和四个基因向量，并生成指定的输出格式。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import fisher_exact\n\ndef solve():\n    \"\"\"\n    Solves the somatic cell hybrid mapping problem by implementing the specified statistical procedure.\n    \"\"\"\n    # Define the fixed test suite data.\n    # Chromosome-by-line presence-absence matrix C (24 chromosomes, 12 lines)\n    C_matrix = np.array([\n        [1,0,0,1,0,1,0,1,0,0,1,0], # Chr 1\n        [0,1,1,0,1,0,1,0,1,0,0,1], # Chr 2\n        [1,1,0,0,1,1,0,0,1,0,0,1], # Chr 3\n        [0,0,1,1,0,0,1,1,0,1,0,0], # Chr 4\n        [1,0,1,1,0,0,1,0,1,0,0,0], # Chr 5\n        [0,1,0,0,1,1,0,1,0,1,0,0], # Chr 6\n        [1,0,1,0,1,0,1,0,1,0,1,0], # Chr 7\n        [0,1,0,1,0,1,0,1,0,1,0,1], # Chr 8\n        [1,1,1,0,0,0,1,1,0,0,0,1], # Chr 9\n        [0,0,0,1,1,1,0,0,1,1,1,0], # Chr 10\n        [1,0,0,0,1,0,0,1,0,0,1,1], # Chr 11\n        [1,1,1,0,1,0,1,0,1,0,1,0], # Chr 12\n        [0,1,1,1,0,1,0,1,0,1,0,0], # Chr 13\n        [1,0,1,0,0,1,1,0,0,1,0,1], # Chr 14\n        [0,1,0,1,1,0,0,1,1,0,1,0], # Chr 15\n        [1,1,0,1,0,1,0,0,0,1,0,1], # Chr 16\n        [0,0,1,0,1,0,1,1,0,0,1,0], # Chr 17\n        [1,0,0,1,0,1,0,0,1,0,1,0], # Chr 18\n        [0,1,1,0,1,0,0,1,0,1,0,1], # Chr 19\n        [1,1,0,1,0,0,1,0,1,0,1,0], # Chr 20\n        [0,0,1,1,0,1,0,1,0,1,0,1], # Chr 21\n        [1,0,0,0,1,1,1,0,0,1,0,0], # Chr 22\n        [0,1,0,0,0,1,1,0,1,0,1,0], # Chr 23\n        [1,0,1,0,0,0,1,0,0,0,1,1], # Chr 24\n    ])\n\n    # Gene vectors for the four test cases\n    gene_vectors = np.array([\n        [1,0,1,0,1,0,1,0,1,0,1,0], # Gene case 1\n        [1,1,1,0,1,0,1,0,1,0,1,0], # Gene case 2\n        [0,1,0,1,0,1,0,1,0,1,0,1], # Gene case 3\n        [0,0,0,0,0,0,0,0,0,0,0,0], # Gene case 4\n    ])\n\n    # FDR level alpha\n    alpha = 0.05\n    # Number of chromosomes (hypotheses)\n    m = C_matrix.shape[0]\n    # Number of cell lines (observations)\n    n = C_matrix.shape[1]\n\n    results = []\n    \n    for g_vec in gene_vectors:\n        # Handle the special case where the gene vector has no variation\n        if len(np.unique(g_vec)) == 1:\n            results.append([0, 1.0])\n            continue\n\n        p_values = []\n        # For each chromosome, construct the contingency table and compute the p-value\n        for i in range(m):\n            c_vec = C_matrix[i, :]\n            \n            a = np.sum((g_vec == 1)  (c_vec == 1))\n            b = np.sum((g_vec == 1)  (c_vec == 0))\n            c = np.sum((g_vec == 0)  (c_vec == 1))\n            d = np.sum((g_vec == 0)  (c_vec == 0))\n            \n            table = np.array([[a, b], [c, d]])\n            \n            # One-sided Fisher's exact test for positive association ('greater')\n            _, p_val = fisher_exact(table, alternative='greater')\n            p_values.append(p_val)\n\n        # Apply Benjamini-Hochberg procedure to get FDR-adjusted q-values\n        p_values = np.array(p_values)\n        \n        # Sort p-values and keep track of original indices\n        sorted_indices = np.argsort(p_values)\n        sorted_p_values = p_values[sorted_indices]\n        \n        # Calculate initial q-values\n        ranks = np.arange(1, m + 1)\n        q_values_sorted = sorted_p_values * m / ranks\n        \n        # Enforce monotonicity (step-up procedure)\n        q_values_corrected = np.minimum.accumulate(q_values_sorted[::-1])[::-1]\n        q_values_corrected = np.minimum(q_values_corrected, 1.0)\n        \n        # Un-sort q-values to match original chromosome order\n        final_q_values = np.empty(m)\n        final_q_values[sorted_indices] = q_values_corrected\n        \n        # Selection rule\n        min_q = np.min(final_q_values)\n        \n        if min_q > alpha:\n            # No assignment\n            results.append([0, round(min_q, 4)])\n        else:\n            # Find all chromosomes with the minimum q-value\n            min_q_indices = np.where(final_q_values == min_q)[0]\n            # Choose the one with the smallest chromosome index (+1 for 1-based indexing)\n            best_chromo_idx = np.min(min_q_indices) + 1\n            results.append([best_chromo_idx, round(min_q, 4)])\n            \n    # Format the final output string as specified\n    formatted_results = []\n    for res in results:\n        k, q = res\n        q_str = f\"{q:.4f}\"\n        formatted_results.append(f\"[{k},{q_str}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2851942"}, {"introduction": "合理的实验设计是获得有效科学结论的先决条件。本练习揭示了体细胞杂交技术中一个常见但微妙的陷阱：使用选择性培养基培养杂交细胞时引入的确认偏误。通过运用条件概率来量化这种偏误的影响，你将理解为何基因定位与筛选步骤必须解耦，并体会到在初步定位阶段使用中性、非选择性检测方法的重要性。[@problem_id:2851982]", "problem": "一个实验室使用小鼠细胞和人成纤维细胞之间的体细胞杂交技术，来定位一个人类基因，该基因的产物赋予了在限定培养基上生长的能力。此背景下的基本事实与定义如下：在体细胞杂交体中，人类染色体在培养传代过程中会随机丢失；在没有任何与特定人类基因相关的选择压力的情况下，每条人类染色体以某个先验概率 $r$ 被保留，该概率取决于其大小以及与小鼠背景的相容性。根据分子生物学的中心法则，杂交体中保留的人类基因可以被转录为人类信使核糖核酸(mRNA)，并翻译成其人类蛋白质，从而可能赋予一种可选择的表型。在选择压力下，表达该人类基因产物的细胞比不表达的细胞以更高的速率存活，从而产生差异存活，并因此决定了在存活者中观察到的染色体保留情况。\n\n一组 $N$ 个独立的鼠-人杂交细胞系被生成并传代了 $T$ 次倍增。在一项初步的非选择性研究中，每条人类染色体的保留概率约为 $r = 0.20$。该研究团队试图定位一个人类基因 $G$，其产物是在限定培养基上生长所必需的。他们现在使用该培养基对新生成的杂交体直接进行选择。假设如果基因 $G$ 表达（即携带 $G$ 的人类染色体被保留且 $G$ 具有转录活性），单个克隆存活的概率为 $s$；如果 $G$ 不表达（反映了泄漏的背景存活），存活概率为 $\\epsilon$。假设 $G$ 位于单个人类染色体上，基因表达需要该染色体的保留，并且在选择之前，“保留携带 $G$ 的染色体”这一事件以概率 $r$ 发生，且与其他染色体无关。对于本实验，团队估计 $s \\approx 0.90$ 且 $\\epsilon \\approx 0.05$。\n\n他们计划仅对存活的克隆进行核型分析，并通过将人类染色体的存在与否与存活情况以及对这些存活细胞中人类基因产物的酶学检测结果进行关联，来推断 $G$ 的染色体位置。\n\n哪个选项最准确地解释了对 $G$ 表达的直接选择如何使观察到的染色体保留偏向于携带 $G$ 的那条染色体，在所述参数下定量地论证了该偏倚的方向和大致幅度，并提出了一种科学上合理的策略来将选择步骤与定位推断解耦，以使基于保留的定位不会产生循环偏倚？\n\nA. 以存活为条件会使携带 $G$ 的染色体的后验保留率从先验概率 $r$ 膨胀到存活者中一个高得多的值，因为当该染色体存在时，存活的可能性更大。在 $r = 0.20$，$s = 0.90$ 和 $\\epsilon = 0.05$ 的情况下，存活者中携带 $G$ 染色体的预期后验保留率约为 $0.82$，因此仅使用经过选择的克隆来将存活或酶活性与染色体保留相关联，会产生偏向真实染色体的循环偏倚。为了将选择和定位解耦，应首先在非选择性条件下构建并冷冻一个参考杂交细胞系板，通过不影响存活的中性筛选（例如，对细胞裂解物进行免疫测定或酶活性测定）来测量每个克隆的人类染色体组成和人类基因产物，并对该中性板进行定位；仅在定位后使用选择来验证因果关系。\n\nB. 因为人类染色体在选择前丢失，所以选择不会改变保留频率；存活者中携带 $G$ 染色体的后验保留率仍为 $r = 0.20$，因此在经过选择的细胞系板中将存活与染色体保留相关联是无偏的。不需要特殊的解耦。\n\nC. 选择带来的偏倚可以通过降低选择严格性直到 $s$ 和 $\\epsilon$ 接近来消除；在 $s = 0.90$ 和 $\\epsilon = 0.05$ 的情况下，存活者中携带 $G$ 染色体的预期后验保留率约为 $0.50$。对许多经过选择的克隆的染色体保留率进行平均将消除任何剩余的偏倚，而无需一个单独的非选择性细胞系板。\n\nD. 为避免偏倚，应共同选择一个人类可选择标记，例如供体基因组上的次黄嘌呤-鸟嘌呤磷酸核糖转移酶(HPRT)；由于 HPRT 位于与大多数目标基因不同的人类染色体上，因此对 HPRT 进行选择可以保证存活与未知的 $G$ 染色体无关，从而使得在经过选择的细胞系板中进行基于保留的定位是无偏的。", "solution": "所提出的问题是数量遗传学和实验设计中的一个有效练习。我们将通过首先使用条件概率原理将情景形式化，然后根据这种形式化分析评估每个提出的选项来解决它。\n\n设 $C_{G}$ 为杂交细胞保留携带基因 $G$ 的人类染色体的事件。设 $C_{G}'$ 为细胞不保留该染色体的互补事件。设 $S$ 为克隆在选择过程中存活的事件。问题提供了以下概率：\n\n-   选择前保留携带 $G$ 染色体的先验概率：$P(C_{G}) = r = 0.20$。\n-   不保留携带 $G$ 染色体的先验概率：$P(C_{G}') = 1 - r = 1 - 0.20 = 0.80$。\n-   在存在 $G$ 染色体（及其表达）的情况下存活的条件概率：$P(S | C_{G}) = s = 0.90$。\n-   在不存在 $G$ 染色体的情况下存活的条件概率：$P(S | C_{G}') = \\epsilon = 0.05$。\n\n核心任务是计算在*克隆存活下来*的条件下保留携带 $G$ 染色体的后验概率。这个量，$P(C_{G} | S)$，代表了研究人员打算进行核型分析的存活克隆中携带 $G$ 染色体的预期频率。我们使用贝叶斯定理进行此计算：\n$$P(C_{G} | S) = \\frac{P(S | C_{G}) P(C_{G})}{P(S)}$$\n为了使用这个公式，我们必须首先使用全概率定律计算总存活概率 $P(S)$，该定律对 $G$ 染色体的状态进行边缘化：\n$$P(S) = P(S | C_{G}) P(C_{G}) + P(S | C_{G}') P(C_{G}')$$\n代入给定的数值：\n$$P(S) = (s)(r) + (\\epsilon)(1 - r)$$\n$$P(S) = (0.90)(0.20) + (0.05)(0.80)$$\n$$P(S) = 0.18 + 0.04 = 0.22$$\n现在，我们可以计算后验概率 $P(C_{G} | S)$:\n$$P(C_{G} | S) = \\frac{(0.90)(0.20)}{0.22} = \\frac{0.18}{0.22} = \\frac{18}{22} = \\frac{9}{11} \\approx 0.8182$$\n这个结果表明存在显著的偏倚。选择过程将携带基因 $G$ 的染色体频率从初始群体中的先验概率 $r = 0.20$ 膨胀到存活群体中的后验概率约 $0.82$。如果研究人员接着只分析这些存活者以寻找染色体存在与存活表型之间的相关性，他们将不可避免地为正确的染色体找到非常强的相关性。这不是一个发现，而是一个自我实现的预言；该实验设计存在循环论证的缺陷，也称为确定性偏倚。\n\n一个科学上合理的方法论必须将定位步骤与选择步骤解耦。定位应在非选择性条件下生长的一组杂交克隆上进行，其中所有染色体的保留都受相同的随机过程支配。对于这个非选择性板中的每个克隆，必须进行两个独立的分析：首先，进行核型分析以确定人类染色体的组成；其次，进行中性检测（例如对细胞裂解物进行免疫测定或酶活性测量）以确定基因 $G$ 产物的存在与否。然后通过将中性检测的结果与整个板的核型数据相关联来定位该基因。选择性培养基随后可以用于已表征的克隆，以验证已识别的染色体与存活之间的功能联系。\n\n有了这个严谨的基础，我们来评估所提供的选项。\n\n**A. 以存活为条件会使携带 $G$ 的染色体的后验保留率从先验概率 $r$ 膨胀到存活者中一个高得多的值，因为当该染色体存在时，存活的可能性更大。在 $r = 0.20$，$s = 0.90$ 和 $\\epsilon = 0.05$ 的情况下，存活者中携带 $G$ 染色体的预期后验保留率约为 $0.82$，因此仅使用经过选择的克隆来将存活或酶活性与染色体保留相关联，会产生偏向真实染色体的循环偏倚。为了将选择和定位解耦，应首先在非选择性条件下构建并冷冻一个参考杂交细胞系板，通过不影响存活的中性筛选（例如，对细胞裂解物进行免疫测定或酶活性测定）来测量每个克隆的人类染色体组成和人类基因产物，并对该中性板进行定位；仅在定位后使用选择来验证因果关系。**\n该选项完全正确。它准确地描述了偏倚的来源，正确地量化了其幅度（$P(C_{G} | S) \\approx 0.82$，与我们计算的 $9/11$ 相符），并正确地指出了所提议实验的循环性。此外，所提出的使用非选择性板和中性检测的解决方案是将定位与选择解耦并避免这种偏倚的标准、科学有效的方法。\n结论：**正确**。\n\n**B. 因为人类染色体在选择前丢失，所以选择不会改变保留频率；存活者中携带 $G$ 染色体的后验保留率仍为 $r = 0.20$，因此在经过选择的细胞系板中将存活与染色体保留相关联是无偏的。不需要特殊的解耦。**\n这个陈述有根本性的错误。虽然染色体丢失发生在选择之前，但选择本身是一个作用于结果群体的过程，它差异性地移除个体。这是一个经典的例子，说明一个条件事件（存活）如何改变概率。我们的计算明确显示后验概率从 $0.20$ 变为约 $0.82$。其前提是错误的，因此其方法是无偏的这一结论也是错误的。\n结论：**不正确**。\n\n**C. 选择带来的偏倚可以通过降低选择严格性直到 $s$ 和 $\\epsilon$ 接近来消除；在 $s = 0.90$ 和 $\\epsilon = 0.05$ 的情况下，存活者中携带 $G$ 染色体的预期后验保留率约为 $0.50$。对许多经过选择的克隆的染色体保留率进行平均将消除任何剩余的偏倚，而无需一个单独的非选择性细胞系板。**\n这个选项包含多个错误。首先，其后验保留率约为 $0.50$ 的定量声明是不正确的；我们的计算显示它约为 $0.82$。其次，虽然降低选择严格性（使 $s$ 和 $\\epsilon$ 更接近）会减少偏倚，但它并不能“消除”偏倚，除非 $s = \\epsilon$，此时便没有选择。第三，声称平均可以消除偏倚是无稽之谈。对一个有偏倚的群体的大学习样本进行平均，可以得到对有偏倚参数的精确估计，但无法恢复无偏倚的参数。\n结论：**不正确**。\n\n**D. 为避免偏倚，应共同选择一个人类可选择标记，例如供体基因组上的次黄嘌呤-鸟嘌呤磷酸核糖转移酶(HPRT)；由于 HPRT 位于与大多数目标基因不同的人类染色体上，因此对 HPRT 进行选择可以保证存活与未知的 $G$ 染色体无关，从而使得在经过选择的细胞系板中进行基于保留的定位是无偏的。**\n这个选项描述了 HAT 选择系统，这是一种确保杂交细胞保留至少一条人类染色体（携带 HPRT 的那条）的方法。然而，它没有解决对基因 $G$ 的偏倚问题。$G$ 的定位是基于在限定培养基上的选择，该选择特别需要 $G$ 的产物。增加一个不相关的对 HPRT 的二次选择并不能使存活独立于 $G$ 染色体。如果细胞受到对 $G$ 的选择，偏倚依然存在。如果它们*不*受到对 $G$ 的选择，那么仍然必须使用中性检测来筛选 $G$ 的产物，这就回到了选项 A 中描述的策略。这个提议未能解决循环性的核心问题。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2851982"}]}