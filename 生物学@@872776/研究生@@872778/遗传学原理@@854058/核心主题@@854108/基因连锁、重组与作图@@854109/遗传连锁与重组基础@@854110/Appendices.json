{"hands_on_practices": [{"introduction": "在实践中，遗传作图的第一步通常是将可观察的重组频率转换为图距。这个练习将引导你完成这一基本换算，并比较两种不同的估算方法。通过这个过程，你将深刻理解重组频率（$r$）和图距（$d$）之间的根本区别，并学会使用Haldane作图函数来校正由未观察到的双交换事件引起的偏差。[@problem_id:2817249]", "problem": "在一个双杂合个体的测交中，观测到两个基因座之间的重组率为 $r=0.18$。请使用遗传作图的基本原理，完成以下任务：\n- 使用将图距（单位为摩尔根）等同于重组率 $r$ 的线性小距离近似法，估计图距。\n- 基于区间内交换形成的泊松模型，使用一个显式无干涉作图函数（假设为无交换干涉的 Haldane 模型）独立地估计图距。\n\n将两个答案都以厘摩尔根（centiMorgan (cM)）表示，并四舍五入到四位有效数字。根据其基本假设，简要说明哪个估计值更大及其原因。你最终报告的值必须仅为两个数值估计，不带单位，顺序为：线性近似值，然后是 Haldane 作图函数估计值。", "solution": "所述问题是有效的。它在科学上基于遗传连锁分析的原理，提法恰当，提供了所有必要信息，并以客观、明确的语言表述。我们现在开始解答。\n\n基本量是重组率 $r$ 和图距 $d$。重组率 $r$ 是一个可观测量，定义为一次杂交中产生的重组后代的比例。图距 $d$ 以摩尔根为单位，是一个理论构念，定义为每次减数分裂中，在一个染色体区间内发生交换事件的期望数。一摩尔根对应于每次减数分裂平均发生一次交换。一厘摩尔根（cM）是 $\\frac{1}{100}$ 摩尔根。\n\n题目给出的观测重组率为 $r = 0.18$。我们必须使用两种不同的模型来估计图距。\n\n首先，我们使用线性小距离近似法。该模型仅对非常小的 $r$ 值有效。它基于一个简化假设，即区间内发生一次以上交换事件的概率可以忽略不计。如果最多只能发生一次交换，那么每次交换事件都会产生重组配子。在这种情况下，重组配子的频率 ($r$) 等于交换事件的频率 ($d$)。\n因此，线性近似为：\n$$d_{linear} \\approx r$$\n给定 $r = 0.18$，以摩尔根为单位的图距为：\n$$d_{linear} = 0.18 \\text{ Morgans}$$\n为了以厘摩尔根表示，我们乘以 $100$：\n$$d_{linear, cM} = 0.18 \\times 100 = 18.00 \\text{ cM}$$\n四舍五入到四位有效数字得到 $18.00$ cM。\n\n其次，我们使用 Haldane 作图函数。该模型假设交换沿染色体呈泊松过程分布，均值为 $d$。这是一个无交换干涉的模型，意味着在一个点发生的交换不影响附近另一次交换的概率。在泊松模型下，区间内发生恰好 $k$ 次交换的概率由下式给出：\n$$P(X=k) = \\frac{\\exp(-d)d^k}{k!}$$\n只有当两个基因座之间发生奇数次交换（$k=1, 3, 5, ...$）时，才能观测到重组。偶数次交换（$k=0, 2, 4, ...$）会恢复亲本的连锁相，从而产生非重组配子。因此，重组率 $r$ 是所有奇数次交换概率的总和：\n$$r = \\sum_{k \\text{ odd}} P(X=k) = P(X=1) + P(X=3) + \\dots$$\n这个无穷级数有一个著名的闭式解：\n$$r = \\frac{1}{2}(1 - \\exp(-2d))$$\n这就是 Haldane 作图函数。给定 $r = 0.18$，我们必须求解 $d$。\n$$0.18 = \\frac{1}{2}(1 - \\exp(-2d))$$\n乘以 $2$：\n$$0.36 = 1 - \\exp(-2d)$$\n整理各项：\n$$\\exp(-2d) = 1 - 0.36 = 0.64$$\n为了求解 $d$，我们对两边取自然对数：\n$$-2d = \\ln(0.64)$$\n$$d = -\\frac{1}{2}\\ln(0.64)$$\n这就得到了以摩尔根为单位的距离 $d$。我们计算其数值：\n$$d \\approx -\\frac{1}{2}(-0.446287) \\approx 0.2231435 \\text{ Morgans}$$\n转换为厘摩尔根：\n$$d_{Haldane, cM} = 0.2231435 \\times 100 \\approx 22.31435 \\text{ cM}$$\n四舍五入到四位有效数字得到 $22.31$ cM。\n\n最后，我们必须说明为什么 Haldane 的估计值（$d_{Haldane, cM} \\approx 22.31$）比线性近似值（$d_{linear, cM} = 18.00$）大。这种差异的产生是因为重组率 $r$ 系统性地低估了真实图距 $d$。线性近似 $d \\approx r$ 忽略了多次交换的影响。Haldane 模型则明确地考虑了这些影响。具体来说，双交换事件（以及所有更高阶的偶数次交换事件）会产生亲本型的、非重组的单倍型。这些事件对图距 $d$ 有贡献（因为 $d$ 计算所有交换），但在重组率 $r$ 中却检测不到。随着基因间距离的增加，这种多次的、“掩盖性”的交换的概率变得显著。为了产生 $r=0.18$ 的观测重组率，真实的潜在交换频率 $d$ 必须高于 $0.18$，以补偿在重组分析中不可见的双交换所占的比例。Haldane 函数提供了正确的数学映射来解释这种低估。线性近似只是 Haldane 函数在 $d=0$ 附近泰勒级数展开的第一项，即 $r = d - d^2 + \\dots$。对于任何 $d  0$，图距 $d$ 将永远大于重组率 $r$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n18.00  22.31\n\\end{pmatrix}\n}\n$$", "id": "2817249"}, {"introduction": "掌握了从重组率到图距的换算之后，下一步是反向思考并探索不同的生物学模型如何影响这一关系。本练习要求你使用两种经典的作图函数——Haldane函数（无干涉）和Kosambi函数（正干涉）——从给定的图距预测重组频率。通过比较这两种模型的结果，你将具体地看到交叉干涉这一生物学现象是如何影响我们对连锁和重组的数学描述的。[@problem_id:2817255]", "problem": "在同一染色体上两个基因座之间的两点测交中，基因座之间的遗传图距测量为 $30$ 厘摩（cM），其中 $1$ 摩根等于 $100$ cM。令 $d$ 表示以摩根为单位的图距，$r$ 表示重组分数（重组配子的概率）。两个经典的作图函数在关于交换干涉的不同假设下，将 $d$ 和 $r$ 联系起来：\n- Haldane 作图函数假设不存在干涉，并将沿染色单体的交换建模为泊松过程。\n- Kosambi 作图函数假设存在正干涉，随着距离的增加，重组的几率也随之增加。\n\n从这些假设以及重组分数和遗传图距的标准定义出发，计算当 $d = 30$ cM 时，由 Haldane 作图函数和 Kosambi 作图函数预测的重组分数 $r$。然后计算这两个 $r$ 值之间的绝对差。将所有重组分数表示为十进制数（而非百分比）。将所要求的三个量均四舍五入至四位有效数字。你的最终答案应按此顺序呈现：Haldane 的 $r$ 值、Kosambi 的 $r$ 值以及它们之间的绝对差。", "solution": "所陈述的问题具有科学依据、提法明确且客观。它基于遗传连锁和重组的基本原理，使用已建立的数学模型（Haldane 和 Kosambi 作图函数）将遗传图距与重组频率联系起来。所有必要数据均已提供。该问题是有效的。\n\n任务是使用两种不同的作图函数，根据给定的遗传图距 $d$ 计算重组分数 $r$，然后求出两个所得 $r$ 值之间的绝对差。\n\n已知条件如下：\n- 遗传图距：$30$ 厘摩（cM）。\n- 以摩根为单位的图距符号：$d$。\n- 重组分数符号：$r$。\n- 使用的作图函数：Haldane 和 Kosambi。\n\n首先，我们必须将图距从厘摩（cM）转换为摩根。问题说明了 $1$ 摩根等于 $100$ cM。\n因此，以摩根为单位的图距 $d$ 是：\n$$d = \\frac{30 \\text{ cM}}{100 \\text{ cM/Morgan}} = 0.3 \\text{ Morgans}$$\n\n现在，我们应用每个作图函数。\n\n1.  **Haldane 作图函数**\n    该函数是在无交换干涉的假设下推导出来的，即一次交换事件的发生不影响附近发生另一次交换事件的概率。交换被建模为泊松过程。重组分数 $r_H$ 与图距 $d$（以摩根为单位）之间的关系由以下公式给出：\n    $$r_H = \\frac{1}{2}(1 - \\exp(-2d))$$\n    代入值 $d = 0.3$：\n    $$r_H = \\frac{1}{2}(1 - \\exp(-2 \\times 0.3)) = \\frac{1}{2}(1 - \\exp(-0.6))$$\n    我们计算其数值：\n    $$\\exp(-0.6) \\approx 0.548811636$$\n    $$r_H \\approx \\frac{1}{2}(1 - 0.548811636) = \\frac{1}{2}(0.451188364) = 0.225594182$$\n    四舍五入到四位有效数字，我们得到：\n    $$r_H \\approx 0.2256$$\n\n2.  **Kosambi 作图函数**\n    该函数考虑了正交换干涉，即一次交换事件会降低其附近发生另一次交换的概率。重组分数 $r_K$ 与图距 $d$（以摩根为单位）之间的关系由以下公式给出：\n    $$r_K = \\frac{1}{2}\\tanh(2d)$$\n    其中 $\\tanh$ 是双曲正切函数。代入值 $d = 0.3$：\n    $$r_K = \\frac{1}{2}\\tanh(2 \\times 0.3) = \\frac{1}{2}\\tanh(0.6)$$\n    我们回顾双曲正切的定义：$\\tanh(x) = \\frac{\\exp(2x) - 1}{\\exp(2x) + 1}$。因此：\n    $$r_K = \\frac{1}{2} \\left( \\frac{\\exp(1.2) - 1}{\\exp(1.2) + 1} \\right)$$\n    我们计算其数值：\n    $$\\exp(1.2) \\approx 3.32011692$$\n    $$r_K \\approx \\frac{1}{2} \\left( \\frac{3.32011692 - 1}{3.32011692 + 1} \\right) = \\frac{1}{2} \\left( \\frac{2.32011692}{4.32011692} \\right) \\approx \\frac{1}{2}(0.537049567) = 0.2685247835$$\n    四舍五入到四位有效数字，我们得到：\n    $$r_K \\approx 0.2685$$\n\n3.  **绝对差**\n    最后，我们计算两个重组分数之间的绝对差 $\\Delta r$。在进行最终四舍五入之前，使用未四舍五入的数值进行此计算至关重要，以保持精度。\n    $$\\Delta r = |r_H - r_K|$$\n    $$\\Delta r = |0.225594182 - 0.2685247835| = |-0.0429306015| = 0.0429306015$$\n    将此结果四舍五入到四位有效数字：\n    $$\\Delta r \\approx 0.04293$$\n\n所要求的三个量，均四舍五入到四位有效数字，分别是 Haldane 函数的重组分数（$r_H$）、Kosambi 函数的重组分数（$r_K$）以及它们的绝对差（$\\Delta r$）。", "answer": "$$\\boxed{\\begin{pmatrix} 0.2256  0.2685  0.04293 \\end{pmatrix}}$$", "id": "2817255"}, {"introduction": "遗传分析不仅限于估算参数，更重要的是理解其统计确定性。这个练习将连锁分析的原理应用于一种特殊且信息丰富的遗传数据——真菌的无序四分体。你将从原始的四分体计数数据中估算重组率，并使用delta方法为其构建置信区间。这个实践将强化你的一个核心定量遗传学技能：任何点估计值若没有其精度的度量，都是不完整的。[@problem_id:2817196]", "problem": "将一种形成无序四分体的异宗配合真菌在两个基因座上进行杂交。您根据孢子基因型，对总共 $N=800$ 个完整四分体进行评分和分类，将其分为三种经典类型：亲本双型（PD）、四分型（TT）和非亲本双型（NPD）。观察到的计数如下：\n- PD：$520$\n- TT：$250$\n- NPD：$30$\n\n假设如下：\n- 四分体是独立的，并且在给定潜在类别概率的条件下，计数向量服从多项分布。\n- 不存在染色单体干涉，且染色单体随机参与交换。\n- 根据无序四分体中四分体类型的定义，一个 PD 四分体包含 $0$ 个重组染色单体，一个 TT 四分体包含 $2$ 个重组染色单体，一个 NPD 四分体包含 $4$ 个重组染色单体。\n\n仅使用这些定义和多项抽样模型作为基本基础，完成以下操作：\n1. 推导两个基因座之间重组染色单体比例 $r$ 的估计量 $\\hat{r}$，并根据数据计算其数值。\n2. 使用 delta 方法，推导 $\\hat{r}$ 的大样本方差关于类别概率的表达式，然后通过代入经验类别比例，获得标准误的数值估计。使用标准正态分位数 $z_{0.975}=1.96$ 为 $r$ 构建一个形式为 $\\hat{r} \\pm z_{0.975}\\,\\mathrm{SE}(\\hat{r})$ 的 $95\\%$ 置信区间。\n\n将点估计值 $\\hat{r}$ 以及 $95\\%$ 置信区间的下限和上限的最终数值结果以小数形式报告（不带百分号），每个数值均四舍五入至四位有效数字。您的最终答案必须是一个单行矩阵，按顺序包含 $\\hat{r}$、下限和上限这三个值。", "solution": "所提出的问题具有科学依据、提法恰当且客观。它代表了四分体分析中一个标准的统计遗传学练习。所有必要的数据和定义均已提供，假设陈述清晰，并与该领域的通用模型一致。该问题是有效的，并存在唯一且有意义的解。\n\n目标是估计两个遗传基因座之间的重组染色单体比例 $r$，并为该估计构建一个置信区间。\n\n设观察到亲本双型（PD）、四分型（TT）或非亲本双型（NPD）四分体的真实未知概率分别为 $p_{PD}$、$p_{TT}$ 和 $p_{NPD}$，其中 $p_{PD} + p_{TT} + p_{NPD} = 1$。假定观察到的计数 $(n_{PD}, n_{TT}, n_{NPD})$ 服从总数为 $N$ 且概率为这些值的多项分布。\n提供的数据为：$N=800$，$n_{PD}=520$，$n_{TT}=250$，$n_{NPD}=30$。\n\n重组染色单体比例 $r$ 代表发生重组的染色单体的比例。根据问题对无序四分体的定义，一个 PD 四分体包含 $0$ 个重组染色单体，一个 TT 四分体包含 $2$ 个，一个 NPD 四分体包含 $4$ 个。单个四分体由 $4$ 条染色单体组成。因此，重组染色单体的期望比例由加权平均给出：\n$$r = \\frac{0 \\cdot p_{PD} + 2 \\cdot p_{TT} + 4 \\cdot p_{NPD}}{4} = \\frac{1}{2} p_{TT} + p_{NPD}$$\n\n1. 估计量 $\\hat{r}$ 的推导和计算。\n\n多项分布概率的最大似然估计量（MLEs）是观察到的样本比例：\n$$ \\hat{p}_{PD} = \\frac{n_{PD}}{N}, \\quad \\hat{p}_{TT} = \\frac{n_{TT}}{N}, \\quad \\hat{p}_{NPD} = \\frac{n_{NPD}}{N} $$\n根据最大似然估计量的不变性，将这些样本比例代入 $r$ 的表达式中，即可得到 $r$ 的最大似然估计量，记为 $\\hat{r}$：\n$$ \\hat{r} = g(\\hat{p}_{TT}, \\hat{p}_{NPD}) = \\frac{1}{2} \\hat{p}_{TT} + \\hat{p}_{NPD} = \\frac{1}{2} \\frac{n_{TT}}{N} + \\frac{n_{NPD}}{N} = \\frac{n_{TT} + 2n_{NPD}}{2N} $$\n该估计量对应于样本中观察到的重组染色单体比例，它是一个矩估计量，在本例中也是最大似然估计量。\n\n使用所提供的数据：\n$$ \\hat{r} = \\frac{250 + 2(30)}{2(800)} = \\frac{250 + 60}{1600} = \\frac{310}{1600} = \\frac{31}{160} = 0.19375 $$\n\n2. 大样本方差的推导与置信区间的构建。\n\n估计量 $\\hat{r}$ 是随机样本比例 $\\hat{p}_{TT}$ 和 $\\hat{p}_{NPD}$ 的线性函数。对于线性函数，delta 方法提供了方差的精确公式，而非近似值。$\\hat{r}$ 的大样本方差由多项分布比例的协方差矩阵推导得出。\n$$ Var(\\hat{r}) = Var \\left( \\frac{1}{2} \\hat{p}_{TT} + \\hat{p}_{NPD} \\right) = \\frac{1}{4} Var(\\hat{p}_{TT}) + Var(\\hat{p}_{NPD}) + Cov(\\hat{p}_{TT}, \\hat{p}_{NPD}) $$\n对于大小为 $N$ 的多项分布，样本比例的方差和协方差为：\n$$ Var(\\hat{p}_i) = \\frac{p_i(1-p_i)}{N}, \\quad Cov(\\hat{p}_i, \\hat{p}_j) = -\\frac{p_i p_j}{N} \\quad \\text{for } i \\neq j $$\n将这些代入 $\\hat{r}$ 的方差表达式中：\n$$ Var(\\hat{r}) = \\frac{1}{4} \\frac{p_{TT}(1-p_{TT})}{N} + \\frac{p_{NPD}(1-p_{NPD})}{N} - \\frac{p_{TT}p_{NPD}}{N} $$\n该表达式可以展开和简化：\n$$ Var(\\hat{r}) = \\frac{1}{4N} [p_{TT}(1-p_{TT}) + 4p_{NPD}(1-p_{NPD}) - 4p_{TT}p_{NPD}] $$\n$$ Var(\\hat{r}) = \\frac{1}{4N} [p_{TT} - p_{TT}^2 + 4p_{NPD} - 4p_{NPD}^2 - 4p_{TT}p_{NPD}] $$\n$$ Var(\\hat{r}) = \\frac{1}{4N} [ (p_{TT} + 4p_{NPD}) - (p_{TT}^2 + 4p_{TT}p_{NPD} + 4p_{NPD}^2) ] $$\n$$ Var(\\hat{r}) = \\frac{(p_{TT} + 4p_{NPD}) - (p_{TT} + 2p_{NPD})^2}{4N} $$\n这就是推导出的关于类别概率的 $\\hat{r}$ 的大样本方差表达式。\n\n为了获得该方差的数值估计，我们用样本比例代替真实概率：\n$$ \\widehat{Var}(\\hat{r}) = \\frac{(\\hat{p}_{TT} + 4\\hat{p}_{NPD}) - (\\hat{p}_{TT} + 2\\hat{p}_{NPD})^2}{4N} $$\n首先，我们计算比例：\n$$ \\hat{p}_{TT} = \\frac{250}{800} = 0.3125, \\quad \\hat{p}_{NPD} = \\frac{30}{800} = 0.0375 $$\n然后我们计算方差公式中的各项：\n$$ \\hat{p}_{TT} + 4\\hat{p}_{NPD} = 0.3125 + 4(0.0375) = 0.3125 + 0.15 = 0.4625 $$\n$$ \\hat{p}_{TT} + 2\\hat{p}_{NPD} = 0.3125 + 2(0.0375) = 0.3125 + 0.075 = 0.3875 $$\n注意，正如预期的那样，$\\hat{p}_{TT} + 2\\hat{p}_{NPD} = 2\\hat{r} = 2(0.19375) = 0.3875$。\n将这些代入方差估计公式中：\n$$ \\widehat{Var}(\\hat{r}) = \\frac{0.4625 - (0.3875)^2}{4(800)} = \\frac{0.4625 - 0.15015625}{3200} = \\frac{0.31234375}{3200} \\approx 9.76074 \\times 10^{-5} $$\n标准误（SE）是估计方差的平方根：\n$$ \\mathrm{SE}(\\hat{r}) = \\sqrt{\\widehat{Var}(\\hat{r})} \\approx \\sqrt{9.76074 \\times 10^{-5}} \\approx 0.009879646 $$\n使用正态近似构建 $r$ 的 $95\\%$ 置信区间：$\\hat{r} \\pm z_{0.975} \\, \\mathrm{SE}(\\hat{r})$。其中 $z_{0.975} = 1.96$：\n误差范围 $= 1.96 \\times 0.009879646 \\approx 0.0193641$\n置信区间为：\n$$ 0.19375 \\pm 0.0193641 $$\n下限：$0.19375 - 0.0193641 = 0.1743859$\n上限：$0.19375 + 0.0193641 = 0.2131141$\n\n最后，按要求将结果四舍五入至四位有效数字：\n点估计 $\\hat{r} = 0.1938$\n下限 $= 0.1744$\n上限 $= 0.2131$\n\n这些值以单行矩阵的形式报告。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1938  0.1744  0.2131 \\end{pmatrix} } $$", "id": "2817196"}]}