{"hands_on_practices": [{"introduction": "理解污染物在环境中的最终去向与浓度是环境风险评估的第一步。单箱模型是量化污染物在湖泊、河流等明确界定的水体中行为的基本工具。在此练习中，您将从质量守恒第一性原理出发，构建一个描述溶解铜在湖泊中浓度变化的微分方程，并求解其稳态浓度，从而将河流输入、大气沉降、生物化学降解和沉降等多个环境过程综合到一个统一的数学框架中[@problem_id:2498253]。", "problem": "一个浅的、混合均匀的温带湖泊被源自河流流入和直接大气沉降的溶解铜 (Cu) 污染。假设在所关心的时间尺度内，湖泊体积恒定，水文条件稳定。从单箱模型的质量守恒出发，推导溶解铜浓度的控制性质量平衡方程，并求解稳态浓度。以下是科学上合理的过程和参数：\n\n- 湖泊的表面积为 $A$，体积为 $V$，平均深度为 $H = V/A$。\n- 湖泊接纳体积流量为 $Q$ 的河流流入，其携带的溶解铜浓度为 $C_{\\mathrm{in}}$。\n- 湖泊通过单一出口流失水分，流量等于入流量 $Q$（长期水量平衡）。\n- 溶解铜的大气沉降在整个湖面上增加了一个均匀的面通量 $J_{\\mathrm{atm}}$。\n- 溶解铜经历额外的一级生物地球化学去除过程，速率常数为 $k_{\\mathrm{d}}$（单位为 $\\mathrm{d}^{-1}$）。\n- 溶解铜被下沉颗粒物清除并永久性地去除至沉积物；将此去除过程表示为沉降通量 $J_{\\mathrm{set}} = v_{\\mathrm{s}}\\,A\\,C$，其中 $v_{\\mathrm{s}}$ 是表观沉降速度，$C$ 是水体中的溶解浓度。\n\n使用以上信息：\n1) 写出湖中溶解铜质量 $M(t)$ 的质量平衡方程，然后写出浓度 $C(t)$ 的质量平衡方程，并根据质量守恒第一性原理确定每个过程的贡献。\n2) 解析求解稳态溶解浓度 $C^{\\ast}$。\n3) 使用以下数值计算 $C^{\\ast}$，并将最终结果以微克/升表示。答案保留三位有效数字。\n\n参数值（使用给定的基本单位）：\n- $A = 2.0 \\times 10^{8}\\ \\mathrm{m}^{2}$\n- $V = 1.0 \\times 10^{9}\\ \\mathrm{m}^{3}$\n- $Q = 2.0 \\times 10^{7}\\ \\mathrm{m}^{3}\\ \\mathrm{d}^{-1}$\n- $C_{\\mathrm{in}} = 1.50\\ \\mu\\mathrm{g}\\ \\mathrm{L}^{-1}$\n- $J_{\\mathrm{atm}} = 8.0\\ \\mu\\mathrm{g}\\ \\mathrm{m}^{-2}\\ \\mathrm{d}^{-1}$\n- $k_{\\mathrm{d}} = 2.0 \\times 10^{-2}\\ \\mathrm{d}^{-1}$\n- $v_{\\mathrm{s}} = 5.0 \\times 10^{-1}\\ \\mathrm{m}\\ \\mathrm{d}^{-1}$\n\n将最终浓度以 $\\mu\\mathrm{g}\\ \\mathrm{L}^{-1}$ 表示，并保留三位有效数字。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了一个湖泊系统中污染物的标准单箱模型，这是环境科学与工程中的一个基本练习。所有参数都已给出，其数值在物理上是合理的。该问题是有效的，并且有唯一解。\n\n我们从质量守恒原理开始。对于一个体积恒定为 $V$ 的混合均匀系统，某物质总质量 $M$ 的变化率等于所有质量输入速率之和减去所有质量去除速率之和。\n$$\n\\frac{dM(t)}{dt} = \\sum (\\text{Mass Input Rate}) - \\sum (\\text{Mass Removal Rate})\n$$\n湖中溶解铜的总质量由 $M(t) = C(t)V$ 给出，其中 $C(t)$ 是溶解铜的浓度，$V$ 是恒定的湖泊体积。因此，质量的变化率为 $V \\frac{dC(t)}{dt}$。\n\n我们确定进出湖泊的各个质量通量。\n\n1.  **质量输入：**\n    -   **河流流入：** 质量通过河流进入，其速率等于体积流量 $Q$ 与入流浓度 $C_{\\mathrm{in}}$ 的乘积。\n        $$ \\text{Input}_{\\mathrm{inflow}} = Q C_{\\mathrm{in}} $$\n    -   **大气沉降：** 质量在整个湖泊表面积 $A$ 上以面通量速率 $J_{\\mathrm{atm}}$ 加入。\n        $$ \\text{Input}_{\\mathrm{atm}} = J_{\\mathrm{atm}} A $$\n\n2.  **质量去除（汇）：**\n    -   **出流：** 由于湖水混合均匀，离开湖泊的水具有与湖水本身相同的浓度 $C(t)$。质量去除速率是出流量 $Q$ 与湖水浓度 $C(t)$ 的乘积。\n        $$ \\text{Removal}_{\\mathrm{outflow}} = Q C(t) $$\n    -   **生物地球化学去除：** 这是一个一级衰减过程，速率常数为 $k_{\\mathrm{d}}$。去除速率与湖中存在的总质量 $M(t)$ 成正比。\n        $$ \\text{Removal}_{\\mathrm{decay}} = k_{\\mathrm{d}} M(t) = k_{\\mathrm{d}} V C(t) $$\n    -   **沉积物清除：** 该过程由总去除速率（单位时间的质量）表示，给定为 $v_{\\mathrm{s}} A C(t)$，其中 $v_{\\mathrm{s}}$ 是表观沉降速度。\n        $$ \\text{Removal}_{\\mathrm{settling}} = v_{\\mathrm{s}} A C(t) $$\n\n将这些项组合到质量平衡方程中：\n$$\n\\frac{dM(t)}{dt} = V \\frac{dC(t)}{dt} = (Q C_{\\mathrm{in}} + J_{\\mathrm{atm}} A) - (Q C(t) + k_{\\mathrm{d}} V C(t) + v_{\\mathrm{s}} A C(t))\n$$\n这是总质量 $M(t)$ 的质量平衡方程。为了得到浓度 $C(t)$ 的方程，我们重新整理这些项。\n$$\nV \\frac{dC}{dt} = (Q C_{\\mathrm{in}} + J_{\\mathrm{atm}} A) - (Q + k_{\\mathrm{d}} V + v_{\\mathrm{s}} A) C\n$$\n两边同除以体积 $V$ 得到 $C(t)$ 的控制性常微分方程的最终形式：\n$$\n\\frac{dC}{dt} = \\frac{Q C_{\\mathrm{in}} + J_{\\mathrm{atm}} A}{V} - \\left(\\frac{Q}{V} + k_{\\mathrm{d}} + \\frac{v_{\\mathrm{s}} A}{V}\\right) C\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须找到稳态浓度，记为 $C^{\\ast}$。在稳态下，浓度不随时间变化，这意味着 $\\frac{dC}{dt} = 0$。将我们的质量平衡方程的左侧设为零：\n$$\n0 = (Q C_{\\mathrm{in}} + J_{\\mathrm{atm}} A) - (Q + k_{\\mathrm{d}} V + v_{\\mathrm{s}} A) C^{\\ast}\n$$\n解这个关于 $C^{\\ast}$ 的代数方程，得到解析解：\n$$\nC^{\\ast} = \\frac{Q C_{\\mathrm{in}} + J_{\\mathrm{atm}} A}{Q + k_{\\mathrm{d}} V + v_{\\mathrm{s}} A}\n$$\n解析解部分到此完成。\n\n对于第三部分，我们数值计算 $C^{\\ast}$。为确保量纲一致性，所有参数必须转换为一个通用的单位系统。我们将使用米 ($m$)、天 ($d$) 和微克 ($\\mu g$)。\n\n给定的参数是：\n- $A = 2.0 \\times 10^{8}\\ \\mathrm{m}^{2}$\n- $V = 1.0 \\times 10^{9}\\ \\mathrm{m}^{3}$\n- $Q = 2.0 \\times 10^{7}\\ \\mathrm{m}^{3}\\ \\mathrm{d}^{-1}$\n- $C_{\\mathrm{in}} = 1.50\\ \\mu\\mathrm{g}\\ \\mathrm{L}^{-1}$。因为 $1\\ \\mathrm{m}^{3} = 1000\\ \\mathrm{L}$，我们将其转换为 $C_{\\mathrm{in}} = 1.50\\ \\frac{\\mu g}{L} \\times \\frac{1000\\ L}{1\\ m^3} = 1.50 \\times 10^{3}\\ \\mu\\mathrm{g}\\ \\mathrm{m}^{-3}$。\n- $J_{\\mathrm{atm}} = 8.0\\ \\mu\\mathrm{g}\\ \\mathrm{m}^{-2}\\ \\mathrm{d}^{-1}$\n- $k_{\\mathrm{d}} = 2.0 \\times 10^{-2}\\ \\mathrm{d}^{-1}$\n- $v_{\\mathrm{s}} = 5.0 \\times 10^{-1}\\ \\mathrm{m}\\ \\mathrm{d}^{-1}$\n\n首先，我们计算分子，它代表以 $\\mu g\\ d^{-1}$ 为单位的总质量负荷速率：\n$$\n\\text{Numerator} = Q C_{\\mathrm{in}} + J_{\\mathrm{atm}} A\n$$\n$$\n\\text{Numerator} = (2.0 \\times 10^{7}\\ \\mathrm{m}^{3}\\ \\mathrm{d}^{-1})(1.50 \\times 10^{3}\\ \\mu\\mathrm{g}\\ \\mathrm{m}^{-3}) + (8.0\\ \\mu\\mathrm{g}\\ \\mathrm{m}^{-2}\\ \\mathrm{d}^{-1})(2.0 \\times 10^{8}\\ \\mathrm{m}^{2})\n$$\n$$\n\\text{Numerator} = (3.0 \\times 10^{10}\\ \\mu\\mathrm{g}\\ \\mathrm{d}^{-1}) + (1.6 \\times 10^{9}\\ \\mu\\mathrm{g}\\ \\mathrm{d}^{-1}) = 3.16 \\times 10^{10}\\ \\mu\\mathrm{g}\\ \\mathrm{d}^{-1}\n$$\n接下来，我们计算分母，它可以被解释为以 $\\mathrm{m}^{3}\\ \\mathrm{d}^{-1}$ 为单位的有效体积损失速率：\n$$\n\\text{Denominator} = Q + k_{\\mathrm{d}} V + v_{\\mathrm{s}} A\n$$\n$$\n\\text{Denominator} = (2.0 \\times 10^{7}\\ \\mathrm{m}^{3}\\ \\mathrm{d}^{-1}) + (2.0 \\times 10^{-2}\\ \\mathrm{d}^{-1})(1.0 \\times 10^{9}\\ \\mathrm{m}^{3}) + (5.0 \\times 10^{-1}\\ \\mathrm{m}\\ \\mathrm{d}^{-1})(2.0 \\times 10^{8}\\ \\mathrm{m}^{2})\n$$\n$$\n\\text{Denominator} = (2.0 \\times 10^{7}) + (2.0 \\times 10^{7}) + (1.0 \\times 10^{8}) \\ \\mathrm{m}^{3}\\ \\mathrm{d}^{-1}\n$$\n$$\n\\text{Denominator} = 4.0 \\times 10^{7} + 1.0 \\times 10^{8} = 0.4 \\times 10^{8} + 1.0 \\times 10^{8} = 1.4 \\times 10^{8}\\ \\mathrm{m}^{3}\\ \\mathrm{d}^{-1}\n$$\n现在我们计算 $C^{\\ast}$：\n$$\nC^{\\ast} = \\frac{3.16 \\times 10^{10}\\ \\mu\\mathrm{g}\\ \\mathrm{d}^{-1}}{1.4 \\times 10^{8}\\ \\mathrm{m}^{3}\\ \\mathrm{d}^{-1}} \\approx 225.714\\ \\mu\\mathrm{g}\\ \\mathrm{m}^{-3}\n$$\n问题要求结果以 $\\mu\\mathrm{g}\\ \\mathrm{L}^{-1}$ 为单位。我们进行最终的单位转换：\n$$\nC^{\\ast} = 225.714\\ \\frac{\\mu\\mathrm{g}}{\\mathrm{m}^{3}} \\times \\frac{1\\ \\mathrm{m}^{3}}{1000\\ \\mathrm{L}} \\approx 0.225714\\ \\mu\\mathrm{g}\\ \\mathrm{L}^{-1}\n$$\n保留三位有效数字，最终结果是 $0.226\\ \\mu\\mathrm{g}\\ \\mathrm{L}^{-1}$。", "answer": "$$\n\\boxed{0.226}\n$$", "id": "2498253"}, {"introduction": "一个重金属的总浓度并不能完全代表其生态毒性，因为其毒性主要取决于其化学形态。此实践将引导您深入探讨化学形态分析（speciation）与生物有效性之间的联系，介绍生态毒理学中的核心概念——自由离子活度模型（FIAM）。通过解读一个地球化学平衡模型（Visual MINTEQ）的输出数据，您将学习如何分析$\\text{pH}$等水化学条件如何影响锌的络合反应，并最终预测其对水生生物的潜在毒性[@problem_id:2498223]。", "problem": "一个淡水场点在温度为$25\\,^{\\circ}\\mathrm{C}$、离子强度为$0.01\\,\\mathrm{M}$（来自$\\mathrm{NaNO_3}$）、溶解性无机碳（DIC）为$2\\,\\mathrm{mM}$、硫酸盐为$0.5\\,\\mathrm{mM}$、溶解性有机碳（DOC）为$2\\,\\mathrm{mg\\,C\\,L^{-1}}$（表示为类富里酸溶解性有机质（DOM））以及总溶解锌为$1\\,\\mu\\mathrm{M}$的条件下，进行了锌污染评估。使用Visual MINTEQ计算了在$\\text{pH}$值为$6.0$、$7.0$、$8.0$和$9.0$时的水相锌形态。模型报告显示，在这四个$\\text{pH}$值下，体系相对于$\\mathrm{ZnCO_3(s)}$和$\\mathrm{Zn(OH)_2(s)}$均未达到饱和（饱和指数在$-0.5$到$-0.1$之间），因此预计不会发生沉淀。预测的溶解态锌物种分布（占总溶解锌的百分比，在每个$\\text{pH}$下总和为$100\\,\\%$）如下：\n\n- $\\text{pH}$ $6.0$：$\\mathrm{Zn^{2+}}$ $68\\,\\%$；$\\mathrm{ZnHCO_3^+}$ $12\\,\\%$；$\\mathrm{ZnSO_4(aq)}$ $5\\,\\%$；$\\mathrm{Zn\\!-\\!DOM}$ $10\\,\\%$；$\\mathrm{ZnCO_3(aq)}$ $3\\,\\%$；$\\mathrm{Zn(OH)^+}$ $2\\,\\%$。\n- $\\text{pH}$ $7.0$：$\\mathrm{Zn^{2+}}$ $35\\,\\%$；$\\mathrm{ZnHCO_3^+}$ $18\\,\\%$；$\\mathrm{ZnCO_3(aq)}$ $14\\,\\%$；$\\mathrm{Zn(OH)^+}$ $10\\,\\%$；$\\mathrm{ZnSO_4(aq)}$ $3\\,\\%$；$\\mathrm{Zn\\!-\\!DOM}$ $20\\,\\%$。\n- $\\text{pH}$ $8.0$：$\\mathrm{Zn^{2+}}$ $10\\,\\%$；$\\mathrm{ZnCO_3(aq)}$ $25\\,\\%$；$\\mathrm{ZnHCO_3^+}$ $8\\,\\%$；$\\mathrm{Zn(OH)^+}$ $15\\,\\%$；$\\mathrm{Zn(OH)_2(aq)}$ $10\\,\\%$；$\\mathrm{Zn\\!-\\!DOM}$ $30\\,\\%$；$\\mathrm{ZnSO_4(aq)}$ $2\\,\\%$。\n- $\\text{pH}$ $9.0$：$\\mathrm{Zn^{2+}}$ $3\\,\\%$；$\\mathrm{ZnCO_3(aq)}$ $30\\,\\%$；$\\mathrm{Zn(OH)^+}$ $15\\,\\%$；$\\mathrm{Zn(OH)_2(aq)}$ $12\\,\\%$；$\\mathrm{Zn(OH)_3^-}$ $5\\,\\%$；$\\mathrm{Zn\\!-\\!DOM}$ $35\\,\\%$。\n\n假设在此离子强度范围内，活度系数大致保持不变，因此自由锌活度的趋势由其摩尔分数决定。自由离子活度模型（FIAM）假定，金属的生物摄取和急性毒性由溶液中自由金属离子$\\mathrm{M^{n+}}$的活度决定。\n\n以络合物形成和酸碱形态的质量作用定律为基本依据，解释在$\\text{pH}$ $6$到$9$的范围内，主要的锌物种如何变化，并根据FIAM预测锌的生物有效性随$\\text{pH}$增加的趋势。哪个选项与Visual MINTEQ的输出和FIAM的预测最匹配？\n\nA. 从$\\text{pH}$ $6$到$7$，$\\mathrm{Zn^{2+}}$是主要的溶解物种；到$\\text{pH}$ $8$到$9$时，碳酸根络合物（$\\mathrm{ZnCO_3(aq)}$、$\\mathrm{ZnHCO_3^+}$）、羟基络合物（$\\mathrm{Zn(OH)^+}$、$\\mathrm{Zn(OH)_2(aq)}$）和与DOM结合的锌成为主导。自由离子活度随$\\text{pH}$单调下降，因此FIAM预测从$\\text{pH}$ $6$到$9$生物有效性逐渐降低。\n\nB. 在所有$\\text{pH}$范围内，$\\mathrm{Zn^{2+}}$始终是主要物种，并且由于生物表面的质子竞争随$\\text{pH}$增加而减弱，FIAM预测从$\\text{pH}$ $6$到$9$生物有效性逐渐增加。\n\nC. 在所有$\\text{pH}$值下，有机络合物占主导地位，使$\\mathrm{Zn^{2+}}$活度大致保持恒定；因此FIAM预测在$\\text{pH}$ $6$到$9$范围内，生物有效性没有强烈的$\\text{pH}$依赖性。\n\nD. 系统在接近$\\text{pH}$ $8$到$9$时变为由沉淀控制，导致$\\mathrm{Zn^{2+}}$活度实际上降至零；因此FIAM会预测仅在$\\text{pH}$ $8.5$以上生物有效性可忽略不计。\n\nE. 三羟基络合物$\\mathrm{Zn(OH)_3^-}$在$\\text{pH}$ $6$时占主导地位，而由于碳酸盐缓冲作用，$\\mathrm{Zn^{2+}}$在$\\text{pH}$ $8$时达到峰值；FIAM预测生物有效性趋势为非单调，在$\\text{pH}$ $8$时达到最大值。", "solution": "该问题要求分析来自地球化学模型的锌形态数据，并应用自由离子活度模型（FIAM）来预测随$p\\mathrm{H}$变化的生物有效性趋势。\n\n首先，我们必须验证问题陈述。\n\n**第一步：提取已知条件**\n- 温度：$T = 25\\,^{\\circ}\\mathrm{C}$\n- 离子强度：$I = 0.01\\,\\mathrm{M}$（来自$\\mathrm{NaNO_3}$）\n- 溶解性无机碳：$[\\mathrm{DIC}]_{\\text{total}} = 2\\,\\mathrm{mM}$\n- 硫酸盐：$[\\mathrm{SO_4^{2-}}]_{\\text{total}} = 0.5\\,\\mathrm{mM}$\n- 溶解性有机碳：$[\\mathrm{DOC}] = 2\\,\\mathrm{mg\\,C\\,L^{-1}}$\n- 总溶解锌：$[\\mathrm{Zn}]_{\\text{total}} = 1\\,\\mu\\mathrm{M}$\n- 四个$p\\mathrm{H}$值下锌形态的模型输出（占总溶解锌的百分比）：\n    - $p\\mathrm{H}$ $6.0$：$\\mathrm{Zn^{2+}}$ ($68\\,\\%$), $\\mathrm{ZnHCO_3^+}$ ($12\\,\\%$), $\\mathrm{ZnSO_4(aq)}$ ($5\\,\\%$), $\\mathrm{Zn\\!-\\!DOM}$ ($10\\,\\%$), $\\mathrm{ZnCO_3(aq)}$ ($3\\,\\%$), $\\mathrm{Zn(OH)^+}$ ($2\\,\\%$)\n    - $p\\mathrm{H}$ $7.0$：$\\mathrm{Zn^{2+}}$ ($35\\,\\%$), $\\mathrm{ZnHCO_3^+}$ ($18\\,\\%$), $\\mathrm{ZnCO_3(aq)}$ ($14\\,\\%$), $\\mathrm{Zn(OH)^+}$ ($10\\,\\%$), $\\mathrm{ZnSO_4(aq)}$ ($3\\,\\%$), $\\mathrm{Zn\\!-\\!DOM}$ ($20\\,\\%$)\n    - $p\\mathrm{H}$ $8.0$：$\\mathrm{Zn^{2+}}$ ($10\\,\\%$), $\\mathrm{ZnCO_3(aq)}$ ($25\\,\\%$), $\\mathrm{ZnHCO_3^+}$ ($8\\,\\%$), $\\mathrm{Zn(OH)^+}$ ($15\\,\\%$), $\\mathrm{Zn(OH)_2(aq)}$ ($10\\,\\%$), $\\mathrm{Zn\\!-\\!DOM}$ ($30\\,\\%$), $\\mathrm{ZnSO_4(aq)}$ ($2\\,\\%$)\n    - $p\\mathrm{H}$ $9.0$：$\\mathrm{Zn^{2+}}$ ($3\\,\\%$), $\\mathrm{ZnCO_3(aq)}$ ($30\\,\\%$), $\\mathrm{Zn(OH)^+}$ ($15\\,\\%$), $\\mathrm{Zn(OH)_2(aq)}$ ($12\\,\\%$), $\\mathrm{Zn(OH)_3^-}$ ($5\\,\\%$), $\\mathrm{Zn\\!-\\!DOM}$ ($35\\,\\%$)\n- 饱和状态：在所有$p\\mathrm{H}$值下，体系相对于固相$\\mathrm{ZnCO_3(s)}$和$\\mathrm{Zn(OH)_2(s)}$均未饱和。\n- 核心原理：自由离子活度模型（FIAM）指出，生物有效性由自由金属离子的活度$\\{\\mathrm{M^{n+}}\\}$决定。\n- 假设：活度系数近似恒定，因此活度的趋势遵循摩尔分数的趋势。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，提问得当且客观。它呈现了一个环境水生化学中的标准情景。输入参数（浓度，$p\\mathrm{H}$范围）对于淡水系统是现实的。使用像Visual MINTEQ这样的形态模型是标准做法。所提供的形态数据与基本化学原理一致：随着$p\\mathrm{H}$的增加，诸如$\\mathrm{OH^-}$、$\\mathrm{CO_3^{2-}}$和DOM上去质子化的位点等配体的浓度增加，导致$\\mathrm{Zn^{2+}}$阳离子的络合程度更高，其自由形态减少。问题陈述明确提供了FIAM作为解释的基础，这是生态毒理学中一个公认的概念。没有矛盾、缺失数据或不科学的前提。\n\n**第三步：结论与行动**\n问题陈述有效。我将继续进行解答。\n\n**求解过程**\n\n核心任务是分析自由锌离子$\\mathrm{Zn^{2+}}$的趋势，并使用FIAM将其与生物有效性联系起来。\n\n1.  **形态趋势分析**：\n    Visual MINTEQ提供的数据显示了在不同$p\\mathrm{H}$值下，作为自由离子$\\mathrm{Zn^{2+}}$存在的总溶解锌的百分比：\n    - 在$p\\mathrm{H}$ $6.0$时，$[\\mathrm{Zn^{2+}}]$为$68\\,\\%$。\n    - 在$p\\mathrm{H}$ $7.0$时，$[\\mathrm{Zn^{2+}}]$为$35\\,\\%$。\n    - 在$p\\mathrm{H}$ $8.0$时，$[\\mathrm{Zn^{2+}}]$为$10\\,\\%$。\n    - 在$p\\mathrm{H}$ $9.0$时，$[\\mathrm{Zn^{2+}}]$为$3\\,\\%$。\n\n    这表明，随着$p\\mathrm{H}$从$6$增加到$9$，自由$\\mathrm{Zn^{2+}}$离子的相对丰度呈现清晰的单调下降。\n\n    这一趋势由质量作用定律决定。随着$p\\mathrm{H}$的增加，质子浓度$[\\mathrm{H^+}]$下降。这使得各种配体体系的平衡向其去质子化的、更具反应活性的形式移动。\n    - **氢氧根络合物**：$\\mathrm{OH^-}$浓度增加，有利于形成羟基-锌络合物：$\\mathrm{Zn^{2+}} + n\\mathrm{OH^-} \\rightleftharpoons \\mathrm{Zn(OH)_n^{(2-n)+}}$。这从在较高$p\\mathrm{H}$下$\\mathrm{Zn(OH)^+}$、$\\mathrm{Zn(OH)_2(aq)}$和$\\mathrm{Zn(OH)_3^-}$百分比的增加中可以明显看出。\n    - **碳酸根络合物**：碳酸盐体系平衡$\\mathrm{H_2CO_3} \\rightleftharpoons \\mathrm{HCO_3^-} + \\mathrm{H^+} \\rightleftharpoons \\mathrm{CO_3^{2-}} + 2\\mathrm{H^+}$向右移动。$\\mathrm{HCO_3^-}$尤其是$\\mathrm{CO_3^{2-}}$（更强的配体）的可用性增加，驱动了碳酸根-锌络合物$\\mathrm{ZnHCO_3^+}$和$\\mathrm{ZnCO_3(aq)}$的形成。\n    - **有机络合物**：溶解性有机质（DOM）上的官能团，主要是羧基和酚基，随着$p\\mathrm{H}$的升高而去质子化。这增加了DOM分子上的负电荷密度，增强了它们与$\\mathrm{Zn^{2+}}$阳离子的结合能力。$\\mathrm{Zn\\!-\\!DOM}$的百分比从$p\\mathrm{H}$ $6.0$时的$10\\,\\%$上升到$p\\mathrm{H}$ $9.0$时的$35\\,\\%$。\n\n    所有这些络合反应都消耗自由的$\\mathrm{Zn^{2+}}$，导致其比例随$p\\mathrm{H}$升高而下降。\n\n2.  **自由离子活度模型（FIAM）的应用**：\n    FIAM假定生物摄取和毒性与自由金属离子的活度成正比，在此情况下为$\\{\\mathrm{Zn^{2+}}\\}$。活度定义为$\\{\\mathrm{Zn^{2+}}\\} = \\gamma_{\\mathrm{Zn^{2+}}} [\\mathrm{Zn^{2+}}]$，其中$\\gamma_{\\mathrm{Zn^{2+}}}$是活度系数。\n    问题陈述要求假设活度系数是恒定的。总溶解锌也恒定在$1\\,\\mu\\mathrm{M}$。因此，活度$\\{\\mathrm{Zn^{2+}}\\}$与$\\mathrm{Zn^{2+}}$的摩尔分数（或百分比）成正比。\n    由于$\\mathrm{Zn^{2+}}$的百分比从$p\\mathrm{H}$ $6.0$时的$68\\,\\%$单调下降到$p\\mathrm{H}$ $9.0$时的$3\\,\\%$，因此活度$\\{\\mathrm{Zn^{2+}}\\}$也必须在此$p\\mathrm{H}$范围内单调下降。\n    因此，FIAM预测锌的生物有效性将随着$p\\mathrm{H}$从$6$到$9$的增加而单调下降。\n\n**逐项分析**\n\n- **A. 从$\\text{pH}$ $6$到$7$，$\\mathrm{Zn^{2+}}$是主要的溶解物种；到$\\text{pH}$ $8$到$9$时，碳酸根络合物（$\\mathrm{ZnCO_3(aq)}$、$\\mathrm{ZnHCO_3^+}$）、羟基络合物（$\\mathrm{Zn(OH)^+}$、$\\mathrm{Zn(OH)_2(aq)}$）和与DOM结合的锌成为主导。自由离子活度随$\\text{pH}$单调下降，因此FIAM预测从$\\text{pH}$ $6$到$9$生物有效性逐渐降低。**\n    - 该陈述准确反映了形态数据。在$p\\mathrm{H}$ $6.0$和$7.0$时，$\\mathrm{Zn^{2+}}$是丰度最高的单一物种（分别为$68\\,\\%$和$35\\,\\%$）。在$p\\mathrm{H}$ $8.0$和$9.0$时，其他络合物（例如，$\\mathrm{Zn\\!-\\!DOM}$为$30\\,\\%$和$35\\,\\%$；$\\mathrm{ZnCO_3(aq)}$为$25\\,\\%$和$30\\,\\%$）比$\\mathrm{Zn^{2+}}$（$10\\,\\%$和$3\\,\\%$）更丰富。关于自由离子活度单调下降的说法是正确的，基于FIAM得出的生物有效性降低的预测也是正确的。\n    - **结论：正确。**\n\n- **B. 在所有$\\text{pH}$范围内，$\\mathrm{Zn^{2+}}$始终是主要物种，并且由于生物表面的质子竞争随$\\text{pH}$增加而减弱，FIAM预测从$\\text{pH}$ $6$到$9$生物有效性逐渐增加。**\n    - 第一句话是错误的。$\\mathrm{Zn^{2+}}$在$p\\mathrm{H}$ $8.0$和$p\\mathrm{H}$ $9.0$时不是主要物种。此外，根据问题中的定义，FIAM严格地将生物有效性与自由离子活度联系起来，而不是与质子竞争等次要效应联系起来。生物有效性增加的预测与基于数据的FIAM预测相矛盾。\n    - **结论：错误。**\n\n- **C. 在所有$\\text{pH}$值下，有机络合物占主导地位，使$\\mathrm{Zn^{2+}}$活度大致保持恒定；因此FIAM预测在$\\text{pH}$ $6$到$9$范围内，生物有效性没有强烈的$\\text{pH}$依赖性。**\n    - 第一句话是错误的。在$p\\mathrm{H}$ $6.0$时，有机络合物（$\\mathrm{Zn\\!-\\!DOM}$）仅占$10\\,\\%$，远未达到主导地位。第二句话也是错误的；数据显示自由$\\mathrm{Zn^{2+}}$急剧下降（从$68\\,\\%$到$3\\,\\%$），表明存在非常强的$p\\mathrm{H}$依赖性，而不是恒定的活度。\n    - **结论：错误。**\n\n- **D. 系统在接近$\\text{pH}$ $8$到$9$时变为由沉淀控制，导致$\\mathrm{Zn^{2+}}$活度实际上降至零；因此FIAM会预测仅在$\\text{pH}$ $8.5$以上生物有效性可忽略不计。**\n    - 该陈述直接与问题给出的信息相矛盾，即系统“在所有四个$\\text{pH}$值下，相对于$\\mathrm{ZnCO_3(s)}$和$\\mathrm{Zn(OH)_2(s)}$均未达到饱和……因此预计不会发生沉淀”。\n    - **结论：错误。**\n\n- **E. 三羟基络合物$\\mathrm{Zn(OH)_3^-}$在$\\text{pH}$ $6$时占主导地位，而由于碳酸盐缓冲作用，$\\mathrm{Zn^{2+}}$在$\\text{pH}$ $8$时达到峰值；FIAM预测生物有效性趋势为非单调，在$\\text{pH}$ $8$时达到最大值。**\n    - 这个陈述在事实上是荒谬的。在$p\\mathrm{H}$ $6.0$时，$\\mathrm{OH^-}$的浓度极低，三羟基络合物可以忽略不计，数据也证实了这一点（它甚至没有被列出，意味着1%）。主要物种是$\\mathrm{Zn^{2+}}$。声称$\\mathrm{Zn^{2+}}$“在$p\\mathrm{H}$ $8$时达到峰值”完全颠倒了数据中显示的实际趋势。因此，随后的预测是毫无根据的。\n    - **结论：错误。**\n\n基于对所提供数据的严谨分析和对FIAM原理的正确应用，只有选项A与事实相符。", "answer": "$$\\boxed{A}$$", "id": "2498223"}, {"introduction": "在真实水体中，多种离子共存并可能在生物摄取位点发生相互作用，从而改变重金属的毒性。此项高级实践建立在生物有效性概念之上，聚焦于拮抗作用——即环境中如钙离子等阳离子能够竞争性地抑制重金属的毒性效应。您将通过编写程序，基于受体占有理论构建一个响应面模型，并使用最大似然估计法来拟合剂量-效应数据，从而定量地估算钙对镉毒性的拮抗作用强度[@problem_id:2498209]。这项练习将您的技能从概念理解提升到定量化的统计建模与参数估计。", "problem": "给定某淡水生物在两种条件下（无钙存在，以及在固定背景浓度下有钙存在）的镉暴露急性致死数据。请您开发一个程序，使用基于受体占据和竞争性相互作用原理的响应面模型，来估计一个量化钙对镉毒性拮抗作用的单一相互作用参数。该程序必须使用最大似然估计来拟合模型，并生成一个整合了多个数据集结果的单行输出。\n\n基础依据和模型假设：\n- 作为外部镉浓度函数的急性致死概率，通过一个受受体占据理论启发的希尔函数进行建模。设在镉浓度为 $c_{\\mathrm{Cd}}$ 时的死亡概率为\n$$\np_{\\mathrm{Cd}}(c_{\\mathrm{Cd}}) = \\frac{c_{\\mathrm{Cd}}^{n}}{\\mathrm{EC}_{50}^{n} + c_{\\mathrm{Cd}}^{n}},\n$$\n其中 $\\mathrm{EC}_{50}$ 是半数致死浓度，$n$ 是希尔系数。\n- 在钙浓度为 $c_{\\mathrm{Ca}}$ 的情况下，由于在生物配体上的竞争性相互作用（拮抗作用），镉的效力会降低。将其建模为有效浓度缩放：\n$$\nc_{\\mathrm{Cd,eff}} = \\frac{c_{\\mathrm{Cd}}}{\\left(1 + \\beta \\, c_{\\mathrm{Ca}}\\right)^{\\theta}},\n$$\n其中 $\\beta$ 是一个固定的钙效力缩放参数，而 $\\theta \\ge 0$ 是量化拮抗作用的相互作用参数。在有钙存在时，致死概率为\n$$\np(c_{\\mathrm{Cd}}, c_{\\mathrm{Ca}}) = \\frac{c_{\\mathrm{Cd,eff}}^{n}}{\\mathrm{EC}_{50}^{n} + c_{\\mathrm{Cd,eff}}^{n}}.\n$$\n- 在条件 $j$ 下，从 $N_j$ 个生物中观察到的死亡数量 $x_j$ 被建模为成功概率为 $p_j$ 的独立二项式试验，即 $x_j \\sim \\mathrm{Binomial}(N_j, p_j)$。\n\n估计任务：\n- 对于每个数据集，通过最大化该数据集中所有仅含镉和镉加钙观测值的联合二项式似然，来联合估计 $\\mathrm{EC}_{50}$、$n$ 和 $\\theta$。将 $\\beta$ 视为已知固定值。\n- 关注的目标是拮抗参数 $\\theta$；对每个数据集，仅报告其估计值。\n- 将参数限制在具有物理意义的范围内：$\\mathrm{EC}_{50}  0$，$n  0$，以及 $\\theta \\ge 0$。\n\n单位：\n- 镉浓度 $c_{\\mathrm{Cd}}$ 以 $\\mathrm{mg}\\,\\mathrm{L}^{-1}$ 为单位提供。\n- 钙浓度 $c_{\\mathrm{Ca}}$ 以 $\\mathrm{mM}$ 为单位提供。\n- 参数 $\\beta$ 的单位是 $\\mathrm{mM}^{-1}$，因此 $\\left(1 + \\beta \\, c_{\\mathrm{Ca}}\\right)$ 是无量纲的。\n- 估计的 $\\theta$ 是无量纲的。\n\n固定模型常数：\n- 使用 $\\beta = 0.5\\,\\mathrm{mM}^{-1}$。\n\n数据描述和测试套件：\n对于每个数据集，您将获得以下信息：\n- 一组仅含镉的条件，包括 $c_{\\mathrm{Cd}}$ 值（单位为 $\\mathrm{mg}\\,\\mathrm{L}^{-1}$）、恒定的 $c_{\\mathrm{Ca}} = 0\\,\\mathrm{mM}$、每个条件下的死亡数量 $x$ 和暴露生物数量 $N$。\n- 一组混合物条件，包括相同的 $c_{\\mathrm{Cd}}$ 值、恒定的 $c_{\\mathrm{Ca}} = 2.0\\,\\mathrm{mM}$、每个条件下的死亡数量 $x$ 和暴露生物数量 $N$。\n\n以下所有数据集在每个条件下均使用 $N = 20$ 个生物。\n\n提供以下三个数据集作为测试套件：\n\n- 数据集 A（中等拮抗作用）：\n  - 仅含镉条件：\n    - $c_{\\mathrm{Cd}}$ 值：$[0.1, 0.3, 0.6, 1.0]$ $\\mathrm{mg}\\,\\mathrm{L}^{-1}$\n    - 死亡数量 $x$：$[1, 5, 12, 16]$\n  - 含钙条件 $c_{\\mathrm{Ca}} = 2.0\\,\\mathrm{mM}$：\n    - 相同的 $c_{\\mathrm{Cd}}$ 值：$[0.1, 0.3, 0.6, 1.0]$ $\\mathrm{mg}\\,\\mathrm{L}^{-1}$\n    - 死亡数量 $x$：$[0, 1, 4, 9]$\n\n- 数据集 B（无拮抗作用边界）：\n  - 仅含镉条件：\n    - $c_{\\mathrm{Cd}}$ 值：$[0.1, 0.3, 0.6, 1.0]$ $\\mathrm{mg}\\,\\mathrm{L}^{-1}$\n    - 死亡数量 $x$：$[1, 5, 12, 16]$\n  - 含钙条件 $c_{\\mathrm{Ca}} = 2.0\\,\\mathrm{mM}$：\n    - 相同的 $c_{\\mathrm{Cd}}$ 值：$[0.1, 0.3, 0.6, 1.0]$ $\\mathrm{mg}\\,\\mathrm{L}^{-1}$\n    - 死亡数量 $x$：$[1, 5, 12, 16]$\n\n- 数据集 C（强拮抗作用）：\n  - 仅含镉条件：\n    - $c_{\\mathrm{Cd}}$ 值：$[0.1, 0.3, 0.6, 1.0]$ $\\mathrm{mg}\\,\\mathrm{L}^{-1}$\n    - 死亡数量 $x$：$[1, 5, 12, 16]$\n  - 含钙条件 $c_{\\mathrm{Ca}} = 2.0\\,\\mathrm{mM}$：\n    - 相同的 $c_{\\mathrm{Cd}}$ 值：$[0.1, 0.3, 0.6, 1.0]$ $\\mathrm{mg}\\,\\mathrm{L}^{-1}$\n    - 死亡数量 $x$：$[0, 0, 1, 2]$\n\n算法要求：\n- 实现联合负对数似然函数\n$$\n\\mathcal{L}(\\mathrm{EC}_{50}, n, \\theta) = -\\sum_{j} \\left[ x_j \\log p_j + (N_j - x_j)\\log(1 - p_j)\\right],\n$$\n其中，当 $c_{\\mathrm{Ca},j} = 0$ 时，$p_j$ 等于 $p_{\\mathrm{Cd}}(c_{\\mathrm{Cd},j})$，否则等于 $p(c_{\\mathrm{Cd},j}, c_{\\mathrm{Ca},j})$。使用数值优化方法在约束条件 $\\mathrm{EC}_{50} \\in (0, +\\infty)$、$n \\in (0, +\\infty)$ 和 $\\theta \\in [0, +\\infty)$ 下最小化 $\\mathcal{L}$。\n- 通过在取对数前将概率 $p_j$ 裁剪到开区间 $(\\varepsilon, 1 - \\varepsilon)$（其中 $\\varepsilon = 10^{-12}$）来进行数值稳定的评估。\n- 为提高鲁棒性，使用多个确定性的初始猜测值，并选择具有最低目标值的解。\n\n输出内容：\n- 对于每个数据集，按 A、B、C 的顺序，计算 $\\theta$ 的最大似然估计值，并将每个值四舍五入到三位小数。\n- 您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，\"[0.000,1.234,2.500]\"）。\n\n关于单位和格式的说明：\n- 所有输入浓度均以上述指定单位提供；您的输出仅包含四舍五入到三位小数的 $\\theta$ 的无量纲值。", "solution": "该问题经过验证并被确定为有效。它在科学上基于生态毒理学和剂量-响应模型的原理，在数学上是适定的，并且包含获得唯一且有意义解所需的所有必要信息。任务是使用指定的响应面模型从多个数据集中估计拮抗参数 $\\theta$。\n\n该模型的基础是希尔函数，它将毒物浓度与量化效应（如致死率）的概率联系起来。该函数源自应用于受体结合的质量作用定律。对于仅含镉的暴露，在浓度为 $c_{\\mathrm{Cd}}$ 时的致死概率 $p_{\\mathrm{Cd}}$ 由以下公式给出：\n$$\np_{\\mathrm{Cd}}(c_{\\mathrm{Cd}}) = \\frac{c_{\\mathrm{Cd}}^{n}}{\\mathrm{EC}_{50}^{n} + c_{\\mathrm{Cd}}^{n}}\n$$\n在这里，$\\mathrm{EC}_{50}$ 是半数效应浓度，表示50%的生物受到影响时的浓度，而 $n$ 是希尔系数，它描述了剂量-响应曲线的陡峭程度。\n\n该问题将钙作为竞争性拮抗剂引入。这种拮抗作用的建模假设是，钙会降低镉在生物靶点（生物配体）的有效浓度。有效镉浓度 $c_{\\mathrm{Cd,eff}}$ 的公式为：\n$$\nc_{\\mathrm{Cd,eff}} = \\frac{c_{\\mathrm{Cd}}}{\\left(1 + \\beta \\, c_{\\mathrm{Ca}}\\right)^{\\theta}}\n$$\n参数 $\\beta$ 是钙效力的一个固定缩放因子，而 $\\theta$ 是我们必须估计的相互作用参数。$\\theta = 0$ 的值意味着没有相互作用，因为分母变为 $1$。正值的 $\\theta$ 量化了拮抗效应的强度。然后，通过将 $c_{\\mathrm{Cd,eff}}$ 代入希尔函数来建模同时存在两种毒物时的致死概率：\n$$\np(c_{\\mathrm{Cd}}, c_{\\mathrm{Ca}}) = \\frac{c_{\\mathrm{Cd,eff}}^{n}}{\\mathrm{EC}_{50}^{n} + c_{\\mathrm{Cd,eff}}^{n}}\n$$\n这种公式确保了单一组内在毒性参数 $\\mathrm{EC}_{50}$ 和 $n$ 描述了生物体对*有效*浓度的响应，而相互作用则完全包含在参数 $\\theta$ 中。\n\n三个参数 $(\\mathrm{EC}_{50}, n, \\theta)$ 的估计是使用最大似然法进行的。观测数据包括在一组实验条件 $j$ 下，总共 $N_j$ 个个体中的死亡数量 $x_j$。每个观测值都被建模为二项分布 $x_j \\sim \\mathrm{Binomial}(N_j, p_j)$ 的一次独立抽取，其中 $p_j$ 是根据我们的模型针对特定浓度 $(c_{\\mathrm{Cd},j}, c_{\\mathrm{Ca},j})$ 计算出的死亡概率。所有观测值的联合对数似然为：\n$$\n\\log L(\\mathrm{EC}_{50}, n, \\theta) = \\sum_{j} \\left[ x_j \\log p_j + (N_j - x_j)\\log(1 - p_j)\\right]\n$$\n为了找到最大似然估计，我们必须找到使该函数最大化的参数值。在计算上，这等同于最小化负对数似然 $\\mathcal{L} = -\\log L$，后者通常更稳定。\n$$\n\\mathcal{L}(\\mathrm{EC}_{50}, n, \\theta) = -\\sum_{j} \\left[ x_j \\log p_j + (N_j - x_j)\\log(1 - p_j)\\right]\n$$\n这些参数受到物理约束：$\\mathrm{EC}_{50}  0$，$n  0$ 和 $\\theta \\ge 0$。为了提高优化的数值稳定性和收敛性，我们可以使用对数对严格为正的参数进行重新参数化。设 $E = \\log(\\mathrm{EC}_{50})$ 和 $H = \\log(n)$。然后对参数 $(E, H, \\theta)$ 进行优化，其中 $E$ 和 $H$ 的边界为 $(-\\infty, \\infty)$，$\\theta$ 的边界为 $[0, \\infty)$。在目标函数内部，通过取指数来恢复原始参数：$\\mathrm{EC}_{50} = \\exp(E)$ 和 $n = \\exp(H)$。\n\n对于每个提供的数据集，实现将按以下步骤进行：\n1. 为所有实验条件（仅含镉和镉加钙）构建 $c_{\\mathrm{Cd}}$、$c_{\\mathrm{Ca}}$、$x$ 和 $N$ 的完整数据向量。\n2. 定义目标函数，即负对数似然 $\\mathcal{L}(E, H, \\theta)$。为保证数值鲁棒性，概率 $p_j$ 将计算为 $p_j = (1 + (\\mathrm{EC}_{50}/c_{\\mathrm{Cd,eff},j})^n)^{-1}$，并在取其对数之前，将其裁剪到一个小区间 $[\\varepsilon, 1-\\varepsilon]$，其中 $\\varepsilon=10^{-12}$。\n3. 将使用数值优化程序（`scipy.optimize.minimize`，采用 `L-BFGS-B` 方法）来找到最小化 $\\mathcal{L}$ 的参数值。\n4. 为了降低收敛到局部最小值的风险，优化将从多个确定性起始点执行。初始猜测值集合将是一个覆盖 $\\mathrm{EC}_{50}$（例如 $0.2$ 到 $0.8$）、$n$（例如 $2$ 到 $5$）和 $\\theta$（例如 $0$ 到 $1.5$）的合理值的网格。\n5. 选择所有起始点中与所达到的最低 $\\mathcal{L}$ 值相对应的参数集作为最终估计。\n6. 提取估计的 $\\theta$ 值，四舍五入到三位小数，并收集以备最终输出。\n\n对三个数据集（A、B 和 C）中的每一个重复此过程，并将得到的 $\\theta$ 估计值汇总为指定的输出格式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the model fitting for all datasets\n    and print the final results.\n    \"\"\"\n    \n    # Fixed model constant as specified in the problem\n    BETA = 0.5  # Units: mM^-1\n\n    # Test suite: Datasets A, B, and C\n    # Data is structured as:\n    # (c_cd_values, c_ca_value, deaths_x, total_N)\n    # The first tuple is for cadmium-only, the second for cadmium+calcium.\n    test_cases_data = [\n        # Dataset A (moderate antagonism)\n        {\n            \"cd_only\": ([0.1, 0.3, 0.6, 1.0], 0.0, [1, 5, 12, 16], 20),\n            \"cd_ca\": ([0.1, 0.3, 0.6, 1.0], 2.0, [0, 1, 4, 9], 20)\n        },\n        # Dataset B (no antagonism boundary)\n        {\n            \"cd_only\": ([0.1, 0.3, 0.6, 1.0], 0.0, [1, 5, 12, 16], 20),\n            \"cd_ca\": ([0.1, 0.3, 0.6, 1.0], 2.0, [1, 5, 12, 16], 20)\n        },\n        # Dataset C (strong antagonism)\n        {\n            \"cd_only\": ([0.1, 0.3, 0.6, 1.0], 0.0, [1, 5, 12, 16], 20),\n            \"cd_ca\": ([0.1, 0.3, 0.6, 1.0], 2.0, [0, 0, 1, 2], 20)\n        }\n    ]\n\n    # Prepare data arrays for fitting\n    datasets = []\n    for case_data in test_cases_data:\n        cd_only_data = case_data[\"cd_only\"]\n        cd_ca_data = case_data[\"cd_ca\"]\n\n        c_cd = np.array(cd_only_data[0] + cd_ca_data[0])\n        c_ca = np.array([cd_only_data[1]] * len(cd_only_data[0]) + [cd_ca_data[1]] * len(cd_ca_data[0]))\n        x = np.array(cd_only_data[2] + cd_ca_data[2])\n        N = np.array([cd_only_data[3]] * len(cd_only_data[0]) + [cd_ca_data[3]] * len(cd_ca_data[0]))\n        \n        datasets.append((c_cd, c_ca, x, N))\n\n    # Define multiple deterministic initial guesses for the optimizer.\n    # Parameters are optimized in a transformed space: [log(EC50), log(n), theta]\n    # to enforce positivity constraints on EC50 and n.\n    log_ec50_guesses = np.log([0.2, 0.5, 0.8])\n    log_n_guesses = np.log([2.0, 5.0])\n    theta_guesses = [0.0, 0.5, 1.0, 1.5]\n    initial_guesses = []\n    for log_ec50_0 in log_ec50_guesses:\n        for log_n_0 in log_n_guesses:\n            for theta_0 in theta_guesses:\n                initial_guesses.append((log_ec50_0, log_n_0, theta_0))\n\n    final_theta_estimates = []\n\n    for dataset in datasets:\n        c_cd, c_ca, x, N = dataset\n        \n        best_result = None\n        min_neg_log_likelihood = float('inf')\n\n        for guess in initial_guesses:\n            result = minimize(\n                neg_log_likelihood,\n                x0=guess,\n                args=(c_cd, c_ca, x, N, BETA),\n                method='L-BFGS-B',\n                bounds=[(None, None), (None, None), (0, None)]\n            )\n\n            if result.success and result.fun  min_neg_log_likelihood:\n                min_neg_log_likelihood = result.fun\n                best_result = result\n        \n        # The third parameter in the optimized vector is theta\n        theta_estimate = best_result.x[2] if best_result else 0.0\n        final_theta_estimates.append(theta_estimate)\n\n    # Format output as specified: comma-separated list in brackets, rounded to 3 decimal places.\n    formatted_results = [f\"{theta:.3f}\" for theta in final_theta_estimates]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef neg_log_likelihood(params, c_cd, c_ca, x, N, beta):\n    \"\"\"\n    Calculates the negative log-likelihood for the given parameters and data.\n    \n    Args:\n        params (list): A list of transformed parameters [log(EC50), log(n), theta].\n        c_cd (np.ndarray): Array of cadmium concentrations.\n        c_ca (np.ndarray): Array of calcium concentrations.\n        x (np.ndarray): Array of observed deaths.\n        N (np.ndarray): Array of total organisms exposed.\n        beta (float): The fixed calcium potency scaling parameter.\n        \n    Returns:\n        float: The negative log-likelihood value.\n    \"\"\"\n    log_ec50, log_n, theta = params\n    \n    # Recover original parameters from transformed space\n    ec50 = np.exp(log_ec50)\n    n = np.exp(log_n)\n\n    # Calculate effective cadmium concentration\n    c_ca_term = 1.0 + beta * c_ca\n    # c_cd_eff can become zero if c_cd is zero. Add small epsilon to avoid math errors.\n    c_cd_eff = c_cd / (c_ca_term ** theta) + 1e-20\n\n    # Calculate probability of death using a numerically stable form of the Hill function\n    ratio = ec50 / c_cd_eff\n    p = 1.0 / (1.0 + ratio**n)\n\n    # Clip probabilities to avoid log(0) or log(1) issues\n    epsilon = 1e-12\n    p = np.clip(p, epsilon, 1.0 - epsilon)\n\n    # Calculate the joint log-likelihood for binomial data\n    log_likelihood = np.sum(x * np.log(p) + (N - x) * np.log(1.0 - p))\n\n    # The optimizer minimizes, so we return the negative log-likelihood\n    return -log_likelihood\n\nsolve()\n```", "id": "2498209"}]}