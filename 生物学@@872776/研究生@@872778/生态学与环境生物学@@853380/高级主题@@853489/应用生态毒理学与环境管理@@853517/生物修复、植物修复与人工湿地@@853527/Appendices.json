{"hands_on_practices": [{"introduction": "在设计任何生物修复系统之前，我们必须首先从最基础的层面理解微生物转化的化学计量关系。本练习将引导您应用质量守恒定律来构建一个完整的生物降解反应方程式，该方程式不仅包括污染物的分解（异化作用），还涵盖了新微生物细胞的合成（同化作用）。通过掌握这一实践，您将能够计算出关键的设计参数，例如曝气所需的氧气量和微生物生长所需的营养物量，这对于工程化一个高效、稳定的生物修复过程至关重要 [@problem_id:2474145]。", "problem": "苯水溶液的经验式为 $C_{6}H_{6}$，它被异养微生物好氧生物降解，这些微生物将一部分底物碳同化为新的细胞生物质，同时将其余部分氧化为 $CO_{2}$ 和 $H_{2}O$。假设以下科学上标准的模型假设：\n- 生物质的经验式为 $C_{5}H_{7}O_{2}N$。\n- 氨 $NH_{3}$ 是合成代谢的唯一氮源。\n- 唯一的最终电子受体是氧气 $O_{2}$。\n- 维持能量和储存聚合物的形成可忽略不计，所有吸收的氮都整合到生物质中。\n- 化学计量关系通过 $C$、$H$、$O$ 和 $N$ 的元素守恒获得。\n\n设生物质产率为 $Y$ 克细胞/克苯。在本问题中，取 $Y = 0.50$。使用原子量 $C=12.0$，$H=1.0$，$O=16.0$，$N=14.0$，单位为克/摩尔。\n\n1. 从各元素的质量守恒定律出发，写出在 $O_{2}$ 和 $NH_{3}$ 存在下，1 摩尔苯生物降解为 $CO_{2}$、$H_{2}O$ 和 $C_{5}H_{7}O_{2}N$ 的总化学计量方程，其中所有化学计量系数均表示为所产生生物质摩尔数的函数。\n2. 利用产率的定义、生物质的经验式以及由给定原子量得到的摩尔质量，将每摩尔苯所形成的生物质摩尔数与指定的产率 $Y$ 关联起来。\n3. 根据配平的方程式，确定化学计量需氧量，此处定义为每消耗一摩尔苯所需的 $O_{2}$ 摩尔数。\n\n以 摩尔 $O_{2}$ / 摩尔苯 为单位表示最终需氧量，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求确定苯的好氧生物降解的化学计量需氧量。解题过程首先根据所涉及的每种元素的质量守恒定律建立反应的通用化学方程式，然后利用给定的生物质产率来量化化学计量系数。\n\n使用氨 ($NH_{3}$) 作为氮源，将苯 ($C_{6}H_{6}$) 好氧生物降解生成生物质 ($C_{5}H_{7}O_{2}N$)、二氧化碳 ($CO_{2}$) 和水 ($H_{2}O$) 的总未配平反应为：\n$$C_{6}H_{6} + a \\cdot NH_{3} + b \\cdot O_{2} \\rightarrow c \\cdot C_{5}H_{7}O_{2}N + d \\cdot H_{2}O + e \\cdot CO_{2}$$\n此处，化学计量系数 $a$、$b$、$d$ 和 $e$ 是相对于消耗 1 摩尔苯来确定的，并且是所产生的生物质摩尔数 $c$ 的函数。\n\n**1. 化学计量方程的推导**\n\n我们以消耗 1 摩尔苯为基准，应用元素守恒原理。\n\n**碳 (C) 平衡：** 反应物中碳原子的摩尔数必须等于生成物中碳原子的摩尔数。\n$$1 \\times 6 = c \\times 5 + e \\times 1$$\n$$6 = 5c + e$$\n解出 $CO_{2}$ 的化学计量系数 $e$，得到：\n$$e = 6 - 5c$$\n\n**氮 (N) 平衡：** 氮源是 $NH_{3}$，它完全整合到生物质 $C_{5}H_{7}O_{2}N$ 中。\n$$a \\times 1 = c \\times 1$$\n解出 $NH_{3}$ 的化学计量系数 $a$，得到：\n$$a = c$$\n\n**氢 (H) 平衡：**\n$$1 \\times 6 + a \\times 3 = c \\times 7 + d \\times 2$$\n将 $a=c$ 代入氢平衡式：\n$$6 + 3c = 7c + 2d$$\n$$6 - 4c = 2d$$\n解出 $H_{2}O$ 的化学计量系数 $d$，得到：\n$$d = 3 - 2c$$\n\n**氧 (O) 平衡：**\n$$b \\times 2 = c \\times 2 + d \\times 1 + e \\times 2$$\n代入 $d$ 和 $e$ 的表达式：\n$$2b = 2c + (3 - 2c) + 2(6 - 5c)$$\n$$2b = 2c + 3 - 2c + 12 - 10c$$\n$$2b = 15 - 10c$$\n解出 $O_{2}$ 的化学计量系数 $b$，得到：\n$$b = \\frac{15}{2} - 5c = 7.5 - 5c$$\n\n将这些系数代回反应式，得到以 $c$ 表示的配平化学计量方程：\n$$C_{6}H_{6} + c \\cdot NH_{3} + \\left(7.5 - 5c \\right) O_{2} \\rightarrow c \\cdot C_{5}H_{7}O_{2}N + \\left(3 - 2c \\right) H_{2}O + \\left(6 - 5c \\right) CO_{2}$$\n\n**2. 根据产率 ($Y$) 计算生物质摩尔数 ($c$)**\n\n生物质产率 $Y$ 定义为每消耗单位质量底物所产生的细胞质量。\n$$Y = \\frac{\\text{生物质质量}}{\\text{苯的质量}} = 0.50$$\n首先，我们使用给定的原子量计算摩尔质量 ($MW$)：$C=12.0$，$H=1.0$，$O=16.0$，$N=14.0$ 克/摩尔。\n$$MW_{C_{6}H_{6}} = 6 \\times 12.0 + 6 \\times 1.0 = 78.0 \\text{ g/mol}$$\n$$MW_{C_{5}H_{7}O_{2}N} = 5 \\times 12.0 + 7 \\times 1.0 + 2 \\times 16.0 + 1 \\times 14.0 = 60.0 + 7.0 + 32.0 + 14.0 = 113.0 \\text{ g/mol}$$\n根据 1 摩尔苯的化学计量关系，会产生 $c$ 摩尔的生物质。产率可以表示为：\n$$Y = \\frac{c \\times MW_{C_{5}H_{7}O_{2}N}}{1 \\times MW_{C_{6}H_{6}}}$$\n代入已知值：\n$$0.50 = \\frac{c \\times 113.0}{1 \\times 78.0}$$\n我们解出 $c$：\n$$c = \\frac{0.50 \\times 78.0}{113.0} = \\frac{39.0}{113.0}$$\n\n**3. 确定化学计量需氧量**\n\n化学计量需氧量是每摩尔苯所需的 $O_{2}$ 摩尔数，这对应于我们配平方程式中的系数 $b$。\n$$b = 7.5 - 5c$$\n代入 $c$ 的值：\n$$b = 7.5 - 5 \\left( \\frac{39.0}{113.0} \\right)$$\n$$b = \\frac{15}{2} - \\frac{195.0}{113.0}$$\n为了合并这些项，我们找到一个公分母：\n$$b = \\frac{15 \\times 113.0 - 195.0 \\times 2}{2 \\times 113.0} = \\frac{1695 - 390}{226} = \\frac{1305}{226}$$\n计算数值：\n$$b \\approx 5.774336$$\n题目要求答案四舍五入到四位有效数字。\n$$b \\approx 5.774$$\n因此，化学计量需氧量为每摩尔苯 $5.774$ 摩尔 $O_{2}$。", "answer": "$$\\boxed{5.774}$$", "id": "2474145"}, {"introduction": "知道了发生*什么*反应是第一步，而确定反应*多快*则是设计反应器尺寸和预测其处理性能的关键。本练习将带您深入探讨反应动力学的核心，利用生物化学中的基石模型——米氏方程（Michaelis-Menten model）来描述酶促反应的速率。这项实践超越了纯理论，要求您将模型参数与（模拟的）实验数据进行拟合，这是任何科学家或工程师必备的核心技能。此外，它还引入了一个至关重要的概念：通过比较内在反应速率与物理传质速率，来判断究竟是哪个环节真正限制了整个系统的效率 [@problem_id:2474102]。", "problem": "您正在研究在与生物修复相关的稀生物质条件下，由全细胞中表达的环羟基化双加氧酶在水中对苯酚的初始生物降解。假设为初始速率条件，产物积累可忽略不计，且无底物或产物抑制。从单底物酶促反应机理的准稳态近似和充分混合的本体水相出发，完成以下任务。\n\n任务 1（参数估计）：\n- 在单底物酶的准稳态近似下，推导出标准的初始速率形式，其中两个未知参数，即最大速率 $V_{\\max}$ 和半饱和常数 $K_M$，完全表征了初始速率对底物浓度 $S$ 的依赖关系。\n- 根据在充分混合反应器中测得的以下苯酚消耗初始速率数据，拟合 $V_{\\max}$ 和 $K_M$。每个数据点都是一个数对 $(S_i, v_i)$，其中 $S_i$ 是初始苯酚浓度，$v_i$ 是测得的初始体积消耗速率：\n  - $(S_1, v_1) = (0.5\\ \\mathrm{mg\\,L^{-1}}, 9.6\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n  - $(S_2, v_2) = (1.0\\ \\mathrm{mg\\,L^{-1}}, 16.0\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n  - $(S_3, v_3) = (2.0\\ \\mathrm{mg\\,L^{-1}}, 26.2\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n  - $(S_4, v_4) = (4.0\\ \\mathrm{mg\\,L^{-1}}, 35.8\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n  - $(S_5, v_5) = (8.0\\ \\mathrm{mg\\,L^{-1}}, 46.4\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n  - $(S_6, v_6) = (12.0\\ \\mathrm{mg\\,L^{-1}}, 49.7\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n  - $(S_7, v_7) = (20.0\\ \\mathrm{mg\\,L^{-1}}, 54.6\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n  - $(S_8, v_8) = (40.0\\ \\mathrm{mg\\,L^{-1}}, 57.5\\ \\mathrm{mg\\,L^{-1}\\,h^{-1}})$\n- 将 $V_{\\max}$ 和 $K_M$ 视为严格非负。使用非线性最小二乘法，最小化测量速率与模型预测值之间的残差平方和。报告 $V_{\\max}$（单位为 $\\mathrm{mg\\,L^{-1}\\,h^{-1}}$）和 $K_M$（单位为 $\\mathrm{mg\\,L^{-1}}$）。\n\n任务 2（全细胞系统中的外传质与催化限制）：\n- 在充分混合的全细胞悬浮液中，从本体液体到细胞表面的外膜传质可能会限制总吸收速率。在初始速率条件下，将来自本体的最大可能扩散供应量建模为 $J_{\\mathrm{ext,max}} = k_L a \\, S_{\\mathrm{bulk}}$，其中 $k_L a$ 是总外传质系数乘以单位体积的界面面积。\n- 对于给定的本体底物浓度 $S_{\\mathrm{bulk}}$ 和 $k_L a$，将 $J_{\\mathrm{ext,max}}$ 与在 $S = S_{\\mathrm{bulk}}$ 时由拟合参数预测的动力学吸收速率进行比较。定义外有效因子\n  $$\\eta_{\\mathrm{ext}} = \\min\\!\\left(1,\\ \\frac{J_{\\mathrm{ext,max}}}{v_{\\mathrm{kin}}(S_{\\mathrm{bulk}})}\\right),$$\n  其中 $v_{\\mathrm{kin}}(\\cdot)$ 是使用拟合的 $V_{\\max}$ 和 $K_M$ 进行的初始速率预测。\n- 计算下面测试套件中每个测试用例的 $\\eta_{\\mathrm{ext}}$。解释：$\\eta_{\\mathrm{ext}}$ 的值严格小于 $1$ 表示外传质限制占主导地位；值等于 $1$ 表示在给定的 $S_{\\mathrm{bulk}}$ 和 $k_L a$ 条件下，催化限制占主导地位。\n\n测试套件：\n- 案例 A: $S_{\\mathrm{bulk}} = 1.0\\ \\mathrm{mg\\,L^{-1}}$, $k_L a = 5.0\\ \\mathrm{h^{-1}}$\n- 案例 B: $S_{\\mathrm{bulk}} = 10.0\\ \\mathrm{mg\\,L^{-1}}$, $k_L a = 20.0\\ \\mathrm{h^{-1}}$\n- 案例 C: $S_{\\mathrm{bulk}} = 0.5\\ \\mathrm{mg\\,L^{-1}}$, $k_L a = 50.0\\ \\mathrm{h^{-1}}$\n- 案例 D: $S_{\\mathrm{bulk}} = 20.0\\ \\mathrm{mg\\,L^{-1}}$, $k_L a = 1.0\\ \\mathrm{h^{-1}}$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n- 列表必须按以下顺序排列：$[V_{\\max}, K_M, \\eta_{\\mathrm{ext},A}, \\eta_{\\mathrm{ext},B}, \\eta_{\\mathrm{ext},C}, \\eta_{\\mathrm{ext},D}]$。\n- 将 $V_{\\max}$ 以 $\\mathrm{mg\\,L^{-1}\\,h^{-1}}$ 为单位表示，$K_M$ 以 $\\mathrm{mg\\,L^{-1}}$ 为单位表示，每个 $\\eta_{\\mathrm{ext}}$ 表示为无量纲小数。将每个值精确四舍五入到 $4$ 位小数。", "solution": "该问题通过两个连续的任务进行分析。首先，进行 Michaelis-Menten 动力学模型的推导，然后将其参数 $V_{\\max}$ 和 $K_M$ 与实验数据进行拟合。其次，使用这些参数评估在不同条件下，生物修复过程是受内在动力学限制还是受外传质限制。\n\n任务 $1$：推导与参数估计\n\n单底物酶反应机理如下：\n$$ E + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\stackrel{k_2}{\\longrightarrow} E + P $$\n其中 $E$ 是酶，$S$ 是底物，$ES$ 是酶-底物复合物，$P$ 是产物，$k_1$、$k_{-1}$ 和 $k_2$ 是速率常数。$ES$ 复合物浓度的变化速率为：\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_2)[ES] $$\n总酶浓度 $[E]_T$ 是游离酶和复合物结合酶的总和：$[E]_T = [E] + [ES]$。准稳态近似（QSSA）假设 $\\frac{d[ES]}{dt} \\approx 0$。应用此近似并代入 $[E] = [E]_T - [ES]$，可得：\n$$ 0 \\approx k_1 ([E]_T - [ES])[S] - (k_{-1} + k_2)[ES] $$\n解出 $[ES]$ 得：\n$$ [ES] = \\frac{[E]_T [S]}{[S] + \\frac{k_{-1} + k_2}{k_1}} $$\n初始反应速率 $v$ 是产物生成速率，$v = k_2 [ES]$。代入 $[ES]$ 的表达式：\n$$ v = \\frac{k_2 [E]_T [S]}{[S] + \\frac{k_{-1} + k_2}{k_1}} $$\n通过定义两个参数来简化此方程：最大反应速率 $V_{\\max} = k_2 [E]_T$ 和 Michaelis 常数 $K_M = \\frac{k_{-1} + k_2}{k_1}$。这得到了标准的 Michaelis-Menten 形式：\n$$ v(S) = \\frac{V_{\\max} S}{K_M + S} $$\n该模型用于描述底物消耗的体积速率。参数 $V_{\\max}$（单位为 $\\mathrm{mg\\,L^{-1}\\,h^{-1}}$）和 $K_M$（单位为 $\\mathrm{mg\\,L^{-1}}$）通过将此模型与提供的 $N=8$ 个数据点 $(S_i, v_i)$ 进行拟合来确定。拟合是通过使用非线性最小二乘算法，在约束条件 $V_{\\max} \\ge 0$ 和 $K_M \\ge 0$ 下，最小化残差平方和（SSR）来实现的。\n$$ SSR(V_{\\max}, K_M) = \\sum_{i=1}^{8} \\left( v_i - \\frac{V_{\\max} S_i}{K_M + S_i} \\right)^2 $$\n实验数据为 $(0.5, 9.6)$、$(1.0, 16.0)$、$(2.0, 26.2)$、$(4.0, 35.8)$、$(8.0, 46.4)$、$(12.0, 49.7)$、$(20.0, 54.6)$ 和 $(40.0, 57.5)$，其中 $S$ 的单位为 $\\mathrm{mg\\,L^{-1}}$，$v$ 的单位为 $\\mathrm{mg\\,L^{-1}\\,h^{-1}}$。数值优化得出最佳拟合参数：\n$$ V_{\\max} \\approx 60.5557 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ K_M \\approx 2.7668 \\, \\mathrm{mg\\,L^{-1}} $$\n\n任务 $2$：外传质与催化限制\n\n此任务涉及计算外有效因子 $\\eta_{\\mathrm{ext}}$，它比较了底物吸收的潜在动力学速率与最大扩散供应速率。动力学吸收速率 $v_{\\mathrm{kin}}$ 由使用拟合参数的 Michaelis-Menten 模型预测。最大扩散供应量 $J_{\\mathrm{ext,max}}$ 由 $J_{\\mathrm{ext,max}} = (k_L a) S_{\\mathrm{bulk}}$ 给出。有效因子定义为：\n$$ \\eta_{\\mathrm{ext}} = \\min\\left(1, \\frac{J_{\\mathrm{ext,max}}}{v_{\\mathrm{kin}}(S_{\\mathrm{bulk}})}\\right) = \\min\\left(1, \\frac{(k_L a) S_{\\mathrm{bulk}}}{\\frac{V_{\\max} S_{\\mathrm{bulk}}}{K_M + S_{\\mathrm{bulk}}}}\\right) = \\min\\left(1, \\frac{(k_L a)(K_M + S_{\\mathrm{bulk}})}{V_{\\max}}\\right) $$\n$\\eta_{\\mathrm{ext}} = 1$ 的值表示该过程受酶的内在动力学限制，而 $\\eta_{\\mathrm{ext}}  1$ 表示受外传质限制。我们使用拟合值 $V_{\\max} = 60.555734...$ 和 $K_M = 2.76678...$ 计算 $4$ 个给定案例的 $\\eta_{\\mathrm{ext}}$。\n\n案例 A: $S_{\\mathrm{bulk}} = 1.0\\,\\mathrm{mg\\,L^{-1}}$, $k_L a = 5.0\\,\\mathrm{h^{-1}}$\n$$ v_{\\mathrm{kin}} = \\frac{60.5557 \\times 1.0}{2.7668 + 1.0} \\approx 16.0760 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ J_{\\mathrm{ext,max}} = 5.0 \\times 1.0 = 5.0 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ \\eta_{\\mathrm{ext},A} = \\min\\left(1, \\frac{5.0}{16.0760}\\right) \\approx 0.3110 $$\n\n案例 B: $S_{\\mathrm{bulk}} = 10.0\\,\\mathrm{mg\\,L^{-1}}$, $k_L a = 20.0\\,\\mathrm{h^{-1}}$\n$$ v_{\\mathrm{kin}} = \\frac{60.5557 \\times 10.0}{2.7668 + 10.0} \\approx 47.4328 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ J_{\\mathrm{ext,max}} = 20.0 \\times 10.0 = 200.0 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ \\eta_{\\mathrm{ext},B} = \\min\\left(1, \\frac{200.0}{47.4328}\\right) = 1.0000 $$\n\n案例 C: $S_{\\mathrm{bulk}} = 0.5\\,\\mathrm{mg\\,L^{-1}}$, $k_L a = 50.0\\,\\mathrm{h^{-1}}$\n$$ v_{\\mathrm{kin}} = \\frac{60.5557 \\times 0.5}{2.7668 + 0.5} \\approx 9.2684 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ J_{\\mathrm{ext,max}} = 50.0 \\times 0.5 = 25.0 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ \\eta_{\\mathrm{ext},C} = \\min\\left(1, \\frac{25.0}{9.2684}\\right) = 1.0000 $$\n\n案例 D: $S_{\\mathrm{bulk}} = 20.0\\,\\mathrm{mg\\,L^{-1}}$, $k_L a = 1.0\\,\\mathrm{h^{-1}}$\n$$ v_{\\mathrm{kin}} = \\frac{60.5557 \\times 20.0}{2.7668 + 20.0} \\approx 53.1974 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ J_{\\mathrm{ext,max}} = 1.0 \\times 20.0 = 20.0 \\, \\mathrm{mg\\,L^{-1}\\,h^{-1}} $$\n$$ \\eta_{\\mathrm{ext},D} = \\min\\left(1, \\frac{20.0}{53.1974}\\right) \\approx 0.3759 $$\n最终结果按要求进行汇总和格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves a two-part biochemical engineering problem:\n    1. Fits Michaelis-Menten parameters (Vmax, Km) to experimental data.\n    2. Calculates external effectiveness factors for different process conditions.\n    \"\"\"\n\n    # Task 1: Parameter Estimation\n    \n    # Define the Michaelis-Menten kinetic model function.\n    def michaelis_menten(S, Vmax, Km):\n        \"\"\"\n        Calculates the reaction rate based on the Michaelis-Menten equation.\n        S: Substrate concentration\n        Vmax: Maximum reaction rate\n        Km: Michaelis constant (half-saturation constant)\n        \"\"\"\n        return (Vmax * S) / (Km + S)\n\n    # Experimental data: (Substrate concentration, Initial rate)\n    # S_data is in mg/L, v_data is in mg/L/h.\n    S_data = np.array([0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 20.0, 40.0])\n    v_data = np.array([9.6, 16.0, 26.2, 35.8, 46.4, 49.7, 54.6, 57.5])\n\n    # Perform nonlinear least squares regression to find Vmax and Km.\n    # Bounds are set to [0, inf) for both parameters as they must be non-negative.\n    bounds = ([0.0, 0.0], [np.inf, np.inf])\n    popt, _ = curve_fit(michaelis_menten, S_data, v_data, bounds=bounds)\n    Vmax_fit, Km_fit = popt\n\n    # Task 2: External Effectiveness Factor Calculation\n\n    # Test suite for calculating the external effectiveness factor.\n    # Each case has a bulk substrate concentration (S_bulk, mg/L) and a mass transfer coefficient (kLa, 1/h).\n    test_cases = [\n        {'S_bulk': 1.0, 'kLa': 5.0},    # Case A\n        {'S_bulk': 10.0, 'kLa': 20.0},  # Case B\n        {'S_bulk': 0.5, 'kLa': 50.0},   # Case C\n        {'S_bulk': 20.0, 'kLa': 1.0}     # Case D\n    ]\n\n    eta_ext_results = []\n    for case in test_cases:\n        S_bulk = case['S_bulk']\n        kLa = case['kLa']\n\n        # Calculate the intrinsic kinetic rate using the fitted parameters.\n        v_kin = michaelis_menten(S_bulk, Vmax_fit, Km_fit)\n\n        # Calculate the maximum possible diffusive supply rate.\n        J_ext_max = kLa * S_bulk\n\n        # The external effectiveness factor is the minimum of 1 and the ratio of supply to demand.\n        # This formulation avoids division by zero if v_kin were zero, though not possible here\n        # with S_bulk  0.\n        if v_kin > 0:\n            ratio = J_ext_max / v_kin\n            eta_ext = min(1.0, ratio)\n        else:\n            # If kinetic rate is zero (e.g., S_bulk is zero), supply is also zero.\n            # No consumption occurs, so the system is not mass transfer limited; eta = 1.\n            eta_ext = 1.0\n        \n        eta_ext_results.append(eta_ext)\n\n    # Compile the final results in the specified order.\n    # All values are rounded to exactly 4 decimal places.\n    final_results = [\n        f\"{Vmax_fit:.4f}\",\n        f\"{Km_fit:.4f}\",\n        f\"{eta_ext_results[0]:.4f}\",\n        f\"{eta_ext_results[1]:.4f}\",\n        f\"{eta_ext_results[2]:.4f}\",\n        f\"{eta_ext_results[3]:.4f}\"\n    ]\n\n    # Print the final output in the exact required format.\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "2474102"}, {"introduction": "我们常常将反应器理想化为完美混合或平推流动的系统，但现实世界远比这复杂。本练习旨在探索水在人工湿地这一典型环境工程设施中的非理想流动行为。您将分析停留时间分布（Residence Time Distribution, RTD），这相当于一个“指纹”，揭示了流体在容器中的实际运动轨迹。通过这项实践，您将学会如何利用RTD数据来诊断诸如“短路”（即水流绕过了主要处理区）和“死区”（即水流停滞的无效区域）等实际问题，这对于准确评估和优化处理系统的真实效率至关重要 [@problem_id:2474134]。", "problem": "一个用于处理富含硝酸盐地下水的水平潜流人工湿地被建模为通过多孔砾石床的稳定、不可压缩的明渠流。该床体长 $60$ 米，宽 $12$ 米，饱和厚度为 $0.50$ 米。床体总体积被水占据，其结构孔隙度为 $\\phi_{s} = 0.40$。体积流量恒定为 $Q = 0.025$ m$^{3}$ s$^{-1}$。假设所用示踪剂是保守的（无反应、无吸附），流体不可压缩且密度恒定，并且除平流和混合外的边界效应可忽略不计。\n\n在时间 $t = 0$ 时，一个体积可忽略的保守示踪剂脉冲被注入到入口处。记录出口浓度时间序列 $C_{\\text{out}}(t)$，并通过归一化 $E(t) = C_{\\text{out}}(t)\\big/\\int_{0}^{\\infty} C_{\\text{out}}(t)\\,dt$ 来定义停留时间分布（RTD）$E(t)$。测得的 $E(t)$ 可以由一个包含早期短路分支和延迟混合分支的双路径模型很好地描述：\n$$\nE(t) \\;=\\; p\\,\\delta\\!\\big(t - t_{s}\\big) \\;+\\; \\big(1-p\\big)\\,\\frac{1}{t_{m}}\\,\\exp\\!\\Big(-\\frac{t - t_{0}}{t_{m}}\\Big)\\,H\\!\\big(t - t_{0}\\big),\n$$\n其中 $\\delta(\\cdot)$ 是狄拉克δ函数，$H(\\cdot)$ 是亥维赛单位阶跃函数，$p = 0.30$ 是测得的早期质量分数，$t_{s} = 300$ s 是早期到达时间，$t_{0} = 1600$ s 是混合分支的起始时间，$t_{m} = 2300$ s 是混合分支的特征时间。\n\n从稳定、不可压缩流通过多孔控制体的质量守恒以及仅从孔隙体积和 RTD 矩的定义出发（不使用任何未经证明的简化公式），推导以结构孔隙度和流量表示的名义水力停留时间，并说明孔隙度减少和水力无效区（“死区”）如何改变从 $E(t)$ 推断出的有效停留时间。使用这些推导和给定的 $E(t)$，计算表观短路分数\n$$\ns \\;=\\; 1 \\;-\\; \\frac{\\bar{t}}{\\tau_{\\text{nom}}},\n$$\n其中 $\\bar{t}$ 是 $E(t)$ 的均值，$\\tau_{\\text{nom}}$ 是基于结构孔隙体积的名义停留时间。将 $s$ 的最终答案表示为无量纲小数，并四舍五入到四位有效数字。", "solution": "主要任务是计算表观短路分数 $s = 1 - \\bar{t}/\\tau_{\\text{nom}}$。这需要从给定的停留时间分布 (RTD) $E(t)$ 中推导和计算两个量：名义停留时间 $\\tau_{\\text{nom}}$ 和平均停留时间 $\\bar{t}$。\n\n首先，我们按要求从第一性原理推导名义水力停留时间 $\\tau_{\\text{nom}}$。我们考虑一个由饱和多孔床的物理边界定义的控制体。该床体的总体积为 $V = LWH$，其中 $L$ 是长度，$W$ 是宽度，$H$ 是饱和厚度。多孔介质中的空隙体积，即水所占据的体积，是孔隙体积 $V_p$。它由结构孔隙度 $\\phi_s$ 定义，即总体积中空隙空间所占的比例：\n$$\nV_p = \\phi_s V = \\phi_s L W H\n$$\n对于稳定不可压缩流，通过控制体的体积流量 $Q$ 是恒定的。名义停留时间 $\\tau_{\\text{nom}}$ 被定义为与总孔隙体积相等的流体体积通过系统所需的时间。这代表了一种理想情况，即整个孔隙体积都是水力活跃的，并被均匀地用于流动。\n$$\n\\tau_{\\text{nom}} = \\frac{V_p}{Q} = \\frac{\\phi_s L W H}{Q}\n$$\n平均停留时间 $\\bar{t}$ 是示踪剂元素实际在系统内停留的平均时间，由示踪剂实验研究确定。它是停留时间分布 $E(t)$ 的一阶矩：\n$$\n\\bar{t} = \\int_{0}^{\\infty} t E(t) \\,dt\n$$\n在真实系统中，诸如优先流路径（短路）和水力无效区（死区）等因素导致有效载流体积小于总孔隙体积 $V_p$。这导致测得的平均停留时间 $\\bar{t}$ 小于理想的名义时间 $\\tau_{\\text{nom}}$。短路分数 $s$ 量化了这种差异，表示被水流有效绕过的系统体积分数。\n\n现在我们进行计算。名义停留时间 $\\tau_{\\text{nom}}$ 使用给定参数计算：$L = 60$ m, $W = 12$ m, $H = 0.50$ m, $\\phi_s = 0.40$, 以及 $Q = 0.025$ m$^3$ s$^{-1}$。\n孔隙体积为：\n$$\nV_p = (0.40) \\cdot (60\\,\\text{m}) \\cdot (12\\,\\text{m}) \\cdot (0.50\\,\\text{m}) = 144\\,\\text{m}^3\n$$\n因此，名义停留时间为：\n$$\n\\tau_{\\text{nom}} = \\frac{144\\,\\text{m}^3}{0.025\\,\\text{m}^3\\,\\text{s}^{-1}} = 5760\\,\\text{s}\n$$\n接下来，我们从给定的 RTD 模型计算平均停留时间 $\\bar{t}$：\n$$\nE(t) = p\\,\\delta(t - t_s) + (1-p)\\,\\frac{1}{t_m}\\,\\exp\\left(-\\frac{t - t_0}{t_m}\\right)\\,H(t - t_0)\n$$\n根据定义，$\\bar{t}$ 是 $E(t)$ 的一阶矩：\n$$\n\\bar{t} = \\int_{0}^{\\infty} t \\left[ p\\,\\delta(t - t_s) + (1-p)\\,\\frac{1}{t_m}\\,\\exp\\left(-\\frac{t - t_0}{t_m}\\right)\\,H(t - t_0) \\right] dt\n$$\n该积分为线性，可以拆分。均值是分布的两个组分均值的加权平均值：\n$$\n\\bar{t} = p \\int_{0}^{\\infty} t\\,\\delta(t - t_s) \\,dt + (1-p) \\int_{0}^{\\infty} \\frac{t}{t_m}\\,\\exp\\left(-\\frac{t - t_0}{t_m}\\right)\\,H(t - t_0) \\,dt\n$$\n第一个积分涉及狄拉克δ函数 $\\delta(\\cdot)$，根据其筛选性质，积分为 $t_s$。由于亥维賽阶跃函数 $H(\\cdot)$ 的存在，第二个积分的下限变为 $t_0$。设 $\\bar{t}_{\\text{mix}}$ 为混合分支的均值：\n$$\n\\bar{t}_{\\text{mix}} = \\int_{t_0}^{\\infty} \\frac{t}{t_m}\\,\\exp\\left(-\\frac{t-t_0}{t_m}\\right) \\,dt\n$$\n使用换元法 $u = t - t_0$，这意味着 $t = u + t_0$ 且 $dt = du$，积分变为：\n$$\n\\bar{t}_{\\text{mix}} = \\int_{0}^{\\infty} \\frac{u+t_0}{t_m}\\,\\exp\\left(-\\frac{u}{t_m}\\right) \\,du = \\frac{1}{t_m} \\left[ \\int_{0}^{\\infty} u\\,\\exp\\left(-\\frac{u}{t_m}\\right) \\,du + t_0 \\int_{0}^{\\infty} \\exp\\left(-\\frac{u}{t_m}\\right) \\,du \\right]\n$$\n这些是与伽玛函数相关的标准定积分。第一个积分的结果是 $t_m^2$，第二个积分的结果是 $t_m$。\n$$\n\\bar{t}_{\\text{mix}} = \\frac{1}{t_m} \\left[ t_m^2 + t_0 t_m \\right] = t_m + t_0\n$$\n因此，总平均停留时间为：\n$$\n\\bar{t} = p\\,t_s + (1-p)(t_m + t_0)\n$$\n代入给定值：$p = 0.30$, $t_s = 300$ s, $t_0 = 1600$ s, 以及 $t_m = 2300$ s：\n$$\n\\bar{t} = (0.30)(300\\,\\text{s}) + (1-0.30)(2300\\,\\text{s} + 1600\\,\\text{s})\n$$\n$$\n\\bar{t} = 90\\,\\text{s} + (0.70)(3900\\,\\text{s}) = 90\\,\\text{s} + 2730\\,\\text{s} = 2820\\,\\text{s}\n$$\n最后，我们计算表观短路分数 $s$：\n$$\ns = 1 - \\frac{\\bar{t}}{\\tau_{\\text{nom}}} = 1 - \\frac{2820\\,\\text{s}}{5760\\,\\text{s}} = 1 - \\frac{282}{576} = 1 - \\frac{47}{96}\n$$\n数值为：\n$$\ns \\approx 1 - 0.4895833... = 0.5104166...\n$$\n根据题目要求，四舍五入到四位有效数字，得出：\n$$\ns \\approx 0.5104\n$$", "answer": "$$\n\\boxed{0.5104}\n$$", "id": "2474134"}]}