{"hands_on_practices": [{"introduction": "人为压力，如营养物污染，可能将生态系统推过一个临界点，导致突然且通常不可逆的系统状态转变。这个练习将通过一个浅水湿地的模型来探讨此类临界转变背后的数学原理。通过从第一性原理出发，推导导致系统崩溃和恢复的临界营养物负荷，您将亲身体验和理解交替稳定态、滞后效应以及驱动生态系统突变的机制[@problem_id:2513241]。", "problem": "在一个人为景观中的一个浅水湿地接收了外部氮负荷率 $N$ (单位为克氮/平方米/年)。植被状态由沉水植物覆盖的底部比例 $x \\in [0,1]$ 来描述。假设植物动态由一个一维常微分方程 (ODE) 描述：\n$$\n\\frac{dx}{dt} \\;=\\; x \\,\\Big[\\, r \\,\\big(1 - \\frac{x}{K}\\big)\\,\\big(1 + \\eta x\\big) \\;-\\; m \\;-\\; \\sigma N \\,\\Big],\n$$\n其中 $r$ 是内禀增长率，$K$ 是基线环境承载力 (单位为覆盖比例)，$\\eta$ 是一个无量纲的正反馈系数，量化了植被如何改善水体清澈度从而提高其自身的单位种群增长率，$m$ 是与密度无关的损失率，而 $\\sigma$ 是由于浊度驱动的光照限制及其他胁迫因素导致的单位种群损失对外部氮负荷 $N$ 的线性敏感度。\n\n从一维常微分方程中平衡点和稳定性的核心定义出发，并且不使用任何现成的公式，请从第一性原理推导：当植被平衡点通过鞍结分岔 (正向转变为浑浊的藻类状态) 消失时的临界氮输入率，以及当 $N$ 减小时无植被状态失去稳定性 (允许植被自发地重新建立) 时的反向临界氮输入率。\n\n使用以下参数值：\n- $r = 1.0$ 每年，\n- $K = 1.0$，\n- $\\eta = 3.0$ (无量纲)，\n- $m = 0.25$ 每年，\n- $\\sigma = 0.05$ 每 (克氮/平方米/年)。\n\n将两个临界氮输入率以克氮/平方米/年为单位表示，并将您的答案四舍五入到四位有效数字。最终答案必须以单行排列的数对形式给出，第一个条目是正向临界负荷，第二个条目是反向临界负荷。", "solution": "在尝试解答之前，对所述问题进行验证。\n\n首先，逐字提取给定信息。\n系统动态由常微分方程 (ODE) 描述：\n$$\n\\frac{dx}{dt} \\;=\\; x \\,\\Big[\\, r \\,\\big(1 - \\frac{x}{K}\\big)\\,\\big(1 + \\eta x\\big) \\;-\\; m \\;-\\; \\sigma N \\,\\Big]\n$$\n状态变量为 $x \\in [0,1]$。\n参数如下：\n- 内禀增长率：$r = 1.0$ 每年\n- 基线环境承载力：$K = 1.0$\n- 正反馈系数：$\\eta = 3.0$ (无量纲)\n- 与密度无关的损失率：$m = 0.25$ 每年\n- 对氮负荷的敏感度：$\\sigma = 0.05$ 每 (克氮/平方米/年)\n\n目标是从第一性原理推导两个临界氮输入率 $N$：\n1. $N_{forward}$：植被平衡点通过鞍结分岔消失时的速率。\n2. $N_{reverse}$：无植被状态失去稳定性时的速率。\n\n该问题具有科学依据，是理论生态学中研究替代性稳定状态的标准表述。这是一个适定问题，提供了足够的信息来确定所求量的唯一答案。语言客观而精确。因此，该问题被认为是有效的，并将提供解答。\n\n将常微分方程的右侧记为 $f(x, N)$：\n$$\nf(x, N) = x \\left[ r \\left(1 - \\frac{x}{K}\\right) (1 + \\eta x) - m - \\sigma N \\right]\n$$\n平衡状态，记为 $x^*$，是方程 $\\frac{dx}{dt} = f(x^*, N) = 0$ 的解。\n该方程立即给出一个平衡点：\n$x_0^* = 0$，即无植被状态。该平衡点对所有参数值都存在。\n\n其他植被平衡点 ($x^* > 0$) 可通过将方括号中的项设为零来找到：\n$$\nr \\left(1 - \\frac{x^*}{K}\\right) (1 + \\eta x^*) - m - \\sigma N = 0\n$$\n让我们将方括号中的项记为 $G(x, N)$。植被平衡点是 $G(x, N) = 0$ 的根。\n\n任何平衡点 $x^*$ 的稳定性由 $f(x, N)$ 对 $x$ 的导数在 $x^*$ 处的值的符号决定：\n$$\n\\frac{df}{dx}\\bigg|_{x=x^*}\n$$\n如果导数为负，则平衡点是局部稳定的。如果为正，则是不稳定的。当导数为零时，发生分岔。\n\n首先，我们确定反向临界氮负荷 $N_{reverse}$。这被定义为无植被状态 $x_0^* = 0$ 失去稳定性的点。\n我们必须计算在 $x=0$ 处的 $\\frac{df}{dx}$。使用乘积法则，$f'(x) = G(x,N) + x G'(x,N)$。\n在 $x=0$ 处，这简化为：\n$$\n\\frac{df}{dx}\\bigg|_{x=0} = G(0, N) = r \\left(1 - \\frac{0}{K}\\right) (1 + \\eta \\cdot 0) - m - \\sigma N = r - m - \\sigma N\n$$\n如果 $r - m - \\sigma N  0$，无植被状态是稳定的；如果 $r - m - \\sigma N > 0$，则是不稳定的。稳定性的丧失发生在导数为零时：\n$$\nr - m - \\sigma N_{reverse} = 0\n$$\n求解 $N_{reverse}$：\n$$\nN_{reverse} = \\frac{r - m}{\\sigma}\n$$\n代入给定的参数值：$r=1.0$，$m=0.25$，$\\sigma=0.05$。\n$$\nN_{reverse} = \\frac{1.0 - 0.25}{0.05} = \\frac{0.75}{0.05} = 15\n$$\n\n接下来，我们确定正向临界氮负荷 $N_{forward}$。这对应于一个鞍结分岔，在该分岔点，两个不同的植被平衡点 ($x^*>0$) 合并成一个半稳定平衡点，然后随着 $N$ 的增加而消失。这样的分岔发生在一个状态 $(x_{crit}, N_{forward})$ 处，该状态同时满足两个条件：该状态是一个平衡点，并且速率函数的导数为零。\n对于植被状态 ($x_{crit} > 0$)，这些条件是：\n1. $f(x_{crit}, N_{forward}) = 0 \\implies G(x_{crit}, N_{forward}) = 0$\n2. $\\frac{df}{dx}\\bigg|_{x=x_{crit}} = 0 \\implies G(x_{crit}, N_{forward}) + x_{crit} G'(x_{crit}, N_{forward}) = 0$\n\n由于第一个条件表明 $G(x_{crit}, N_{forward}) = 0$，并且我们知道 $x_{crit} > 0$，因此第二个条件简化为 $G'(x_{crit}, N_{forward})=0$。\n我们必须求解方程组：\n$$\n\\begin{cases}\nG(x, N) = 0 \\\\\nG'(x, N) = 0\n\\end{cases}\n$$\n首先计算 $G'(x, N)$：\n$$\nG'(x, N) = \\frac{d}{dx} \\left[ r \\left(1 - \\frac{x}{K}\\right) (1 + \\eta x) - m - \\sigma N \\right] = r \\left[ \\left(-\\frac{1}{K}\\right)(1+\\eta x) + \\left(1-\\frac{x}{K}\\right)(\\eta) \\right]\n$$\n$$\nG'(x, N) = r \\left[ -\\frac{1}{K} - \\frac{\\eta x}{K} + \\eta - \\frac{\\eta x}{K} \\right] = r \\left[ \\eta - \\frac{1}{K} - \\frac{2\\eta}{K}x \\right]\n$$\n现在我们求解 $G'(x_{crit}, N_{forward}) = 0$ 以得到 $x_{crit}$。由于 $r \\neq 0$：\n$$\n\\eta - \\frac{1}{K} - \\frac{2\\eta}{K}x_{crit} = 0 \\implies x_{crit} = \\frac{\\eta - 1/K}{2\\eta/K} = \\frac{K\\eta - 1}{2\\eta}\n$$\n使用给定的参数 $K=1.0$ 和 $\\eta=3.0$：\n$$\nx_{crit} = \\frac{1.0 \\times 3.0 - 1}{2 \\times 3.0} = \\frac{2.0}{6.0} = \\frac{1}{3}\n$$\n$x_{crit}$ 的这个值在物理上是有意义的，因为它位于 $[0,1]$ 区间内。\n现在，我们将 $x_{crit}$ 代入第一个条件 $G(x_{crit}, N_{forward})=0$ 中，以求得 $N_{forward}$：\n$$\nr \\left(1 - \\frac{x_{crit}}{K}\\right) (1 + \\eta x_{crit}) - m - \\sigma N_{forward} = 0\n$$\n求解 $N_{forward}$：\n$$\nN_{forward} = \\frac{1}{\\sigma} \\left[ r \\left(1 - \\frac{x_{crit}}{K}\\right) (1 + \\eta x_{crit}) - m \\right]\n$$\n代入已知值和推导出的 $x_{crit} = 1/3$：\n$r=1.0$，$K=1.0$，$\\eta=3.0$，$m=0.25$，$\\sigma=0.05$。\n$$\nN_{forward} = \\frac{1}{0.05} \\left[ 1.0 \\left(1 - \\frac{1/3}{1.0}\\right) \\left(1 + 3.0 \\times \\frac{1}{3}\\right) - 0.25 \\right]\n$$\n$$\nN_{forward} = 20 \\left[ \\left(1 - \\frac{1}{3}\\right) (1 + 1) - 0.25 \\right]\n$$\n$$\nN_{forward} = 20 \\left[ \\left(\\frac{2}{3}\\right) (2) - 0.25 \\right]\n$$\n$$\nN_{forward} = 20 \\left[ \\frac{4}{3} - \\frac{1}{4} \\right]\n$$\n$$\nN_{forward} = 20 \\left[ \\frac{16 - 3}{12} \\right] = 20 \\left( \\frac{13}{12} \\right) = \\frac{5 \\times 13}{3} = \\frac{65}{3}\n$$\n数值上，$N_{forward} = 21.666...$。\n\n问题要求四舍五入到四位有效数字。\n正向临界负荷为 $N_{forward} \\approx 21.67$。\n反向临界负荷为 $N_{reverse} = 15.00$。\n两者的单位都是克氮/平方米/年。", "answer": "$$\n\\boxed{\\begin{pmatrix} 21.67  15.00 \\end{pmatrix}}\n$$", "id": "2513241"}, {"introduction": "城市环境及其他新型生态系统通常具有资源补贴 (例如，厨余垃圾) 的特征，这会极大地改变食物网的结构。本实践利用一个消费者—资源模型来研究这类补贴如何影响生态系统的稳定性。通过对模型平衡点进行线性稳定性分析，您将学习到理论生态学中的一项基本技术，并了解如何运用它来预测人类提供的资源是会稳定还是会破坏一个种群间的相互作用[@problem_id:2513261]。", "problem": "在城市等人为生物群系中，城市资源补贴可以增加基础资源 (例如，食物垃圾增加了碎屑输入)，从而改变消费者-资源动态，并可能稳定或破坏新型生态系统的稳定性。考虑以下消费者-资源系统，其中城市补贴增加了基础资源供应：\n令 $R(t)$ 表示资源密度，$C(t)$ 表示消费者密度。其动态过程为\n$$\n\\frac{dR}{dt} = r R \\left(1 - \\frac{R}{K}\\right) + S - a R C, \\quad \\frac{dC}{dt} = e\\,a R C - m C,\n$$\n其中 $r$ 是资源内禀增长率，$K$ 是资源环境承载力，$a$ 是消费者捕食率，$e$ 是转化效率，$m$ 是消费者死亡率，$S \\ge 0$ 是对资源的恒定城市补贴速率。假设所有参数均为正，且共存是可行的。\n\n从资源逻辑斯谛增长、质量作用消费以及通过雅可比线性化进行的线性稳定性分析等核心定义出发，完成以下任务：\n1. 用参数表示内部 (共存) 平衡点 $(R^{\\ast}, C^{\\ast})$。\n2. 通过计算雅可比矩阵，在平衡点 $(R^{\\ast}, C^{\\ast})$ 附近对系统进行线性化，并计算该点处的雅可比矩阵。\n3. 用雅可比矩阵的迹和行列式符号化地推导出在 $(R^{\\ast}, C^{\\ast})$ 点的特征多项式和特征值。\n4. 对于参数集 $r = 0.5$ (单位 $\\text{day}^{-1}$)，$K = 100$，$a = 0.02$ (单位 $\\text{day}^{-1}$ 每消费者密度单位)，$e = 0.1$ (无量纲)，$m = 0.1$ (单位 $\\text{day}^{-1}$) 和补贴 $S = 5$ (单位资源密度单位每天)，数值计算特征值，并报告具有最大实部的特征值的实部 (主导局部增长率)。将您的答案四舍五入至四位有效数字。以 $\\text{day}^{-1}$ 为单位表示最终结果。", "solution": "所提出的问题是关于双物种动力系统稳定性分析的一个标准练习，具体来说是一个带有恒定资源补贴的消费者-资源模型。该问题具有科学依据、良定且客观。它包含了所有必要信息，并且没有逻辑矛盾或事实错误。因此，该问题被认为是有效的，并将提供完整的解法。\n\n微分方程组为：\n$$\n\\frac{dR}{dt} = f(R, C) = r R \\left(1 - \\frac{R}{K}\\right) + S - a R C\n$$\n$$\n\\frac{dC}{dt} = g(R, C) = e\\,a R C - m C\n$$\n所有参数 $r, K, a, e, m$ 均为正，补贴 $S \\ge 0$。\n\n1. 确定内部平衡点 $(R^{\\ast}, C^{\\ast})$\n\n通过将两个时间导数都设为零来找到平衡点 $(R^{\\ast}, C^{\\ast})$：\n$$\n\\frac{dR}{dt} = 0 \\quad \\text{and} \\quad \\frac{dC}{dt} = 0\n$$\n根据消费者方程，对于共存或内部平衡点 (其中 $C^{\\ast}  0$)，我们必须有：\n$$\n(e\\,a R^{\\ast} - m) C^{\\ast} = 0 \\implies e\\,a R^{\\ast} - m = 0\n$$\n解出 $R^{\\ast}$，得到平衡资源密度：\n$$\nR^{\\ast} = \\frac{m}{ea}\n$$\n由于所有参数 $m, e, a$ 均为正，因此 $R^{\\ast}$ 保证为正。\n\n接下来，我们将 $R^{\\ast}$ 代入设为零的资源方程中，以求解 $C^{\\ast}$：\n$$\nr R^{\\ast} \\left(1 - \\frac{R^{\\ast}}{K}\\right) + S - a R^{\\ast} C^{\\ast} = 0\n$$\n求解 $C^{\\ast}$：\n$$\na R^{\\ast} C^{\\ast} = r R^{\\ast} \\left(1 - \\frac{R^{\\ast}}{K}\\right) + S\n$$\n$$\nC^{\\ast} = \\frac{1}{a R^{\\ast}} \\left[ r R^{\\ast} \\left(1 - \\frac{R^{\\ast}}{K}\\right) + S \\right] = \\frac{r}{a}\\left(1 - \\frac{R^{\\ast}}{K}\\right) + \\frac{S}{aR^{\\ast}}\n$$\n代入 $R^{\\ast}$ 的表达式：\n$$\nC^{\\ast} = \\frac{r}{a}\\left(1 - \\frac{m}{eaK}\\right) + \\frac{S}{a(\\frac{m}{ea})} = \\frac{r}{a}\\left(1 - \\frac{m}{eaK}\\right) + \\frac{Se}{m}\n$$\n问题陈述假设共存是可行的，这意味着 $C^{\\ast}  0$。\n\n2. 线性化与雅可比矩阵\n\n为了分析平衡点的局部稳定性，我们计算系统的雅可比矩阵 $J$，它由 $f(R, C)$ 和 $g(R, C)$ 的偏导数组成：\n$$\nJ(R, C) = \\begin{pmatrix} \\frac{\\partial f}{\\partial R}  \\frac{\\partial f}{\\partial C} \\\\ \\frac{\\partial g}{\\partial R}  \\frac{\\partial g}{\\partial C} \\end{pmatrix}\n$$\n偏导数分别为：\n$$\n\\frac{\\partial f}{\\partial R} = r - \\frac{2r}{K}R - aC\n$$\n$$\n\\frac{\\partial f}{\\partial C} = -aR\n$$\n$$\n\\frac{\\partial g}{\\partial R} = eaC\n$$\n$$\n\\frac{\\partial g}{\\partial C} = eaR - m\n$$\n因此，雅可比矩阵为：\n$$\nJ(R, C) = \\begin{pmatrix} r - \\frac{2r}{K}R - aC  -aR \\\\ eaC  eaR - m \\end{pmatrix}\n$$\n我们在内部平衡点 $(R^{\\ast}, C^{\\ast})$ 处计算该矩阵的值。令 $J^{\\ast} = J(R^{\\ast}, C^{\\ast})$。$J^{\\ast}$ 的元素为：\n- $J^{\\ast}_{12} = -aR^{\\ast}$\n- $J^{\\ast}_{21} = eaC^{\\ast}$\n- $J^{\\ast}_{22} = eaR^{\\ast} - m = ea(\\frac{m}{ea}) - m = 0$。\n- 对于 $J^{\\ast}_{11}$，我们使用平衡条件 $aC^{\\ast} = r(1 - \\frac{R^{\\ast}}{K}) + \\frac{S}{R^{\\ast}}$：\n$$\nJ^{\\ast}_{11} = r - \\frac{2r}{K}R^{\\ast} - aC^{\\ast} = r - \\frac{2r}{K}R^{\\ast} - \\left[ r\\left(1 - \\frac{R^{\\ast}}{K}\\right) + \\frac{S}{R^{\\ast}} \\right]\n$$\n$$\nJ^{\\ast}_{11} = r - \\frac{2r}{K}R^{\\ast} - r + \\frac{rR^{\\ast}}{K} - \\frac{S}{R^{\\ast}} = -\\frac{rR^{\\ast}}{K} - \\frac{S}{R^{\\ast}}\n$$\n所以，在平衡点处计算的雅可比矩阵为：\n$$\nJ^{\\ast} = \\begin{pmatrix} -\\frac{rR^{\\ast}}{K} - \\frac{S}{R^{\\ast}}  -aR^{\\ast} \\\\ eaC^{\\ast}  0 \\end{pmatrix}\n$$\n\n3. 特征多项式与特征值\n\n平衡点的稳定性由 $J^{\\ast}$ 的特征值 $\\lambda$ 决定，这些特征值是特征多项式 $\\text{det}(J^{\\ast} - \\lambda I) = 0$ 的根。对于一个 $2 \\times 2$ 矩阵，这由以下公式给出：\n$$\n\\lambda^2 - \\text{Tr}(J^{\\ast})\\lambda + \\text{Det}(J^{\\ast}) = 0\n$$\n$J^{\\ast}$ 的迹 ($\\text{Tr}$) 和行列式 ($\\text{Det}$) 分别为：\n$$\n\\text{Tr}(J^{\\ast}) = J^{\\ast}_{11} + J^{\\ast}_{22} = -\\frac{rR^{\\ast}}{K} - \\frac{S}{R^{\\ast}}\n$$\n$$\n\\text{Det}(J^{\\ast}) = J^{\\ast}_{11}J^{\\ast}_{22} - J^{\\ast}_{12}J^{\\ast}_{21} = \\left(-\\frac{rR^{\\ast}}{K} - \\frac{S}{R^{\\ast}}\\right)(0) - (-aR^{\\ast})(eaC^{\\ast}) = a^2eR^{\\ast}C^{\\ast}\n$$\n特征值由求根公式给出：\n$$\n\\lambda_{1,2} = \\frac{\\text{Tr}(J^{\\ast}) \\pm \\sqrt{\\text{Tr}(J^{\\ast})^2 - 4\\text{Det}(J^{\\ast})}}{2}\n$$\n\n4. 数值计算与最终结果\n\n给定参数集：$r = 0.5$，$K = 100$，$a = 0.02$，$e = 0.1$，$m = 0.1$，和 $S = 5$。\n\n首先，我们计算平衡点 $(R^{\\ast}, C^{\\ast})$ 的数值：\n$$\nR^{\\ast} = \\frac{m}{ea} = \\frac{0.1}{0.1 \\times 0.02} = \\frac{0.1}{0.002} = 50\n$$\n$$\nC^{\\ast} = \\frac{r}{a}\\left(1 - \\frac{R^{\\ast}}{K}\\right) + \\frac{S}{aR^{\\ast}} = \\frac{0.5}{0.02}\\left(1 - \\frac{50}{100}\\right) + \\frac{5}{0.02 \\times 50} = 25(0.5) + \\frac{5}{1} = 12.5 + 5 = 17.5\n$$\n平衡点为 $(R^{\\ast}, C^{\\ast}) = (50, 17.5)$。\n\n接下来，我们计算 $J^{\\ast}$ 的迹和行列式的数值：\n$$\n\\text{Tr}(J^{\\ast}) = -\\frac{rR^{\\ast}}{K} - \\frac{S}{R^{\\ast}} = -\\frac{0.5 \\times 50}{100} - \\frac{5}{50} = -\\frac{25}{100} - 0.1 = -0.25 - 0.1 = -0.35\n$$\n$$\n\\text{Det}(J^{\\ast}) = a^2eR^{\\ast}C^{\\ast} = (0.02)^2 \\times 0.1 \\times 50 \\times 17.5 = 0.0004 \\times 0.1 \\times 875 = 0.00004 \\times 875 = 0.035\n$$\n特征多项式为：\n$$\n\\lambda^2 - (-0.35)\\lambda + 0.035 = 0 \\implies \\lambda^2 + 0.35\\lambda + 0.035 = 0\n$$\n我们使用求根公式找到特征值：\n$$\n\\lambda_{1,2} = \\frac{-0.35 \\pm \\sqrt{(0.35)^2 - 4(1)(0.035)}}{2(1)} = \\frac{-0.35 \\pm \\sqrt{0.1225 - 0.14}}{2} = \\frac{-0.35 \\pm \\sqrt{-0.0175}}{2}\n$$\n特征值为一对共轭复数：\n$$\n\\lambda_{1,2} = \\frac{-0.35 \\pm i\\sqrt{0.0175}}{2} = -0.175 \\pm i\\frac{\\sqrt{0.0175}}{2}\n$$\n两个特征值的实部相同。因此，具有最大实部的特征值的实部为 $\\text{Re}(\\lambda) = -0.175$。表示为四位有效数字，该值为 $-0.1750$。负的实部表明该平衡点是局部稳定的，而非零的虚部意味着轨迹通过阻尼振荡的方式趋近于平衡点。主导局部增长率即为该实部。单位为 $\\text{day}^{-1}$。", "answer": "$$\\boxed{-0.1750}$$", "id": "2513261"}, {"introduction": "理解我们星球的未来，需要模拟人类活动将如何持续塑造地景。人为生物群系 (或称“人类世生物群系”，anthromes) 的概念为此提供了一个框架。这项计算练习要求您建立一个模型，将地景划分为不同的人为生物群系类别，并预测它们在不同社会经济情景下的变化。通过实现这个模型，您将直接接触人为生物群系测绘背后的数据和逻辑，并练习使用马尔可夫链模型和贝叶斯估计等工具来预测人类主导生态系统的大尺度动态[@problem_id:2513214]。", "problem": "您的任务是构建一个程序，通过整合历史土地利用地图与人口预测，重构人类活动生物群系 (anthrome) 类别随时间的转变，然后计算在指定的共享社会经济路径–代表性浓度路径 (SSP–RCP) 情景下的转移概率。您的设计必须从第一性原理出发：转移的条件概率、离散状态马尔可夫过程，以及使用对称狄利克雷先验进行稀疏计数平滑的贝叶斯估计。使用的基本原理包括以下几点：(i) 条件概率的定义 $P(Y \\mid X) = \\frac{P(X,Y)}{P(X)}$；(ii) 将离散状态转移系统解释为在有限状态集上的一阶马尔可夫过程；以及 (iii) 通过狄利克雷先验对多项单元格概率进行贝叶斯平滑，其中每个类别增加一个集中度参数 $\\alpha$ 作为伪计数。\n\n人类活动生物群系类别根据人口密度和耕地比例分配给每个网格单元，这反映了生态学中一种极简但广泛使用的概念，即将人口密度和土地利用强度与生物群系演变联系起来。考虑一个由四个 indexed 为 $A_0$ (荒地)、$A_1$ (牧场)、$A_2$ (耕作区) 和 $A_3$ (城市) 的人类活动生物群系类别组成的有限集合。令 $p$ 表示人口密度，单位为人/平方公里，令 $c$ 表示耕地比例。分类由以下按顺序应用的分级规则确定：\n- 如果 $p \\ge p_{\\text{urban}}$，则划分为类别 $A_3$。\n- 否则，如果 $c \\ge c_{\\text{cult}}$，则划分为类别 $A_2$。\n- 否则，如果 $c \\ge c_{\\text{range}}$ 或 $p \\ge p_{\\text{rural}}$，则划分为类别 $A_1$。\n- 否则，划分为类别 $A_0$。\n\n从时间 $t$ 到时间 $t+1$ 的转移概率矩阵，记为 $P_{t,t+1}$，是通过对每个源类别 $i \\in \\{0,1,2,3\\}$，计算转移到目标类别 $j \\in \\{0,1,2,3\\}$ 的网格单元数量，形成计数 $n_{ij}$ 来构建的。通过对称狄利克雷平滑，估计的转移概率为\n$$\n\\hat{p}_{ij} \\;=\\; \\frac{n_{ij} + \\alpha}{n_{i\\cdot} + K\\alpha},\n$$\n其中 $n_{i\\cdot} = \\sum_{j=0}^{K-1} n_{ij}$，$K=4$ 是类别数量，$\\alpha$ 是每个单元增加的伪计数。如果 $n_{i\\cdot} = 0$，则对所有 $j$ 都有 $\\hat{p}_{ij} = \\frac{1}{K}$。\n\n在SSP-RCP情景下的人口预测和土地利用变化按以下方式确定性地实现。给定 $t_1$ 时刻的基线 $p_{t_1}$ 和 $c_{t_1}$，一个由人口增长乘数 $g_p^{(s)}$ 和耕地增加量变化 $s_c^{(s)}$ 参数化的情景 $s$ 会产生如下预测\n$$\np_{t_2}^{(s)} \\;=\\; g_p^{(s)} \\, p_{t_1}, \\qquad\nc_{t_2}^{(s)} \\;=\\; \\min\\!\\left\\{1,\\;\\max\\!\\left\\{0,\\; c_{t_1} + s_c^{(s)} \\right\\}\\right\\}.\n$$\n$t_2$ 时刻的人类活动生物群系类别通过相同的规则逐个单元格地分配，转移矩阵 $P_{t_1,t_2}^{(s)}$ 也通过相同的狄利克雷平滑进行估计。\n\n请为以下完全指定的测试套件实现此流程。所有数组均为 $3\\times 3$ 的网格，条目按行主序排列。所有阈值、参数和值在科学上都是合理的且自洽的。\n\n- 阈值与平滑：\n  - $p_{\\text{urban}} = 300$ 人/平方公里。\n  - $p_{\\text{rural}} = 10$ 人/平方公里。\n  - $c_{\\text{cult}} = 0.20$ (无量纲分数)。\n  - $c_{\\text{range}} = 0.05$ (无量纲分数)。\n  - 平滑伪计数 $\\alpha = 0.5$。\n- $t_0$ 时刻的历史数据：\n  - 人口密度 $p_{t_0}$：\n    - 第 1 行: $[\\,2,\\;15,\\;300\\,]$\n    - 第 2 行: $[\\,0.5,\\;10,\\;50\\,]$\n    - 第 3 行: $[\\,12,\\;305,\\;5\\,]$\n  - 耕地比例 $c_{t_0}$：\n    - 第 1 行: $[\\,0.00,\\;0.10,\\;0.05\\,]$\n    - 第 2 行: $[\\,0.02,\\;0.30,\\;0.25\\,]$\n    - 第 3 行: $[\\,0.00,\\;0.15,\\;0.60\\,]$\n- $t_1$ 时刻的历史数据：\n  - 人口密度 $p_{t_1}$：\n    - 第 1 行: $[\\,3,\\;12,\\;340\\,]$\n    - 第 2 行: $[\\,0.3,\\;11,\\;60\\,]$\n    - 第 3 行: $[\\,9,\\;300,\\;290\\,]$\n  - 耕地比例 $c_{t_1}$：\n    - 第 1 行: $[\\,0.00,\\;0.15,\\;0.05\\,]$\n    - 第 2 行: $[\\,0.01,\\;0.35,\\;0.28\\,]$\n    - 第 3 行: $[\\,0.00,\\;0.20,\\;0.65\\,]$\n- 从 $t_1$到 $t_2$ 的情景：\n  - 情景 $S_1$ (SSP$1$–RCP$2.6$): $g_p^{(S_1)} = 1.02$, $s_c^{(S_1)} = -0.01$。\n  - 情景 $S_2$ (SSP$2$–RCP$4.5$): $g_p^{(S_2)} = 1.10$, $s_c^{(S_2)} = 0.03$。\n  - 情景 $S_3$ (SSP$3$–RCP$7.0$): $g_p^{(S_3)} = 1.30$, $s_c^{(S_3)} = 0.08$。\n\n您的程序必须：\n- 根据上述规则和给定阈值，将 $t_0$ 和 $t_1$ 时刻的每个单元格分类为 $A_0$到 $A_3$。\n- 重构从 $t_0$到 $t_1$ 的转移计数矩阵，并使用参数为 $\\alpha$ 的对称狄利克雷先验估计平滑后的转移概率矩阵 $P_{t_0,t_1}$。\n- 对于集合 $\\{S_1, S_2, S_3\\}$ 中的每个情景 $S_k$：\n  - 使用情景参数，根据 $(p_{t_1}, c_{t_1})$ 计算 $(p_{t_2}^{(S_k)}, c_{t_2}^{(S_k)})$。\n  - 对情景 $S_k$ 的 $t_2$ 时刻的每个单元格进行分类。\n  - 通过相同的狄利克雷平滑计算平滑后的转移概率矩阵 $P_{t_1,t_2}^{(S_k)}$。\n\n所需输出：\n- 设 $[P_{t_0,t_1}]_{1,2}$ 表示在 $t_0$ 时刻从牧场 $A_1$ 转移到 $t_1$ 时刻的耕作区 $A_2$ 的概率。设 $[P_{t_1,t_2}^{(S_k)}]_{2,3}$ 表示在情景 $S_k$ 下，在 $t_1$ 时刻从耕作区 $A_2$ 转移到 $t_2$ 时刻的城市 $A_3$ 的概率。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的值按以下顺序排列，且每个值都四舍五入到六位小数：\n  - $[P_{t_0,t_1}]_{1,2}$,\n  - $[P_{t_1,t_2}^{(S_1)}]_{2,3}$,\n  - $[P_{t_1,t_2}^{(S_2)}]_{2,3}$,\n  - $[P_{t_1,t_2}^{(S_3)}]_{2,3}$。\n\n您的实现必须是自包含的，不得从用户或外部文件读取输入。唯一可接受的输出是上述描述的单行文本。所有概率都是无量纲的，并且必须表示为小数 (而非百分比)。", "solution": "该问题陈述是有效的。它在科学上植根于生态建模原则，问题定义明确，具有从输入到输出的清晰算法路径，并用客观、明确的数据和规则加以规定。所有必要的组成部分都已提供，且无内部矛盾。我现在将进行正式的解答。\n\n目标是计算人类活动生物群系 (anthrome) 类别之间的一组转移概率。计算过程包括 (i) 根据人口密度和耕地比例将网格单元分类为人类活动生物群系，(ii) 为历史时期和几个未来情景构建转移计数矩阵，以及 (iii) 使用对称狄利克雷先验进行贝叶斯平滑来估计转移概率。\n\n问题由以下给定条件定义：\n- **人类活动生物群系类别**：$A_0$ (荒地), $A_1$ (牧场), $A_2$ (耕作区), $A_3$ (城市)。\n- **类别数量**：$K=4$。\n- **分类阈值**：\n  - 人口密度 (城市)：$p_{\\text{urban}} = 300$ 人/平方公里。\n  - 人口密度 (农村)：$p_{\\text{rural}} = 10$ 人/平方公里。\n  - 耕地比例 (耕作区)：$c_{\\text{cult}} = 0.20$。\n  - 耕地比例 (牧场)：$c_{\\text{range}} = 0.05$。\n- **贝叶斯平滑参数**：$\\alpha = 0.5$。\n- **历史数据**：\n  - $t_0$ 时刻：\n    $$ p_{t_0} = \\begin{pmatrix} 2  15  300 \\\\ 0.5  10  50 \\\\ 12  305  5 \\end{pmatrix}, \\quad c_{t_0} = \\begin{pmatrix} 0.00  0.10  0.05 \\\\ 0.02  0.30  0.25 \\\\ 0.00  0.15  0.60 \\end{pmatrix} $$\n  - $t_1$ 时刻：\n    $$ p_{t_1} = \\begin{pmatrix} 3  12  340 \\\\ 0.3  11  60 \\\\ 9  300  290 \\end{pmatrix}, \\quad c_{t_1} = \\begin{pmatrix} 0.00  0.15  0.05 \\\\ 0.01  0.35  0.28 \\\\ 0.00  0.20  0.65 \\end{pmatrix} $$\n- **情景参数** ($t_1 \\to t_2$):\n  - 情景 $S_1$：$g_p^{(S_1)} = 1.02, s_c^{(S_1)} = -0.01$。\n  - 情景 $S_2$：$g_p^{(S_2)} = 1.10, s_c^{(S_2)} = 0.03$。\n  - 情景 $S_3$：$g_p^{(S_3)} = 1.30, s_c^{(S_3)} = 0.08$。\n\n推导过程分为三个主要步骤。\n\n**1. 人类活动生物群系分类 ($t_0$ 和 $t_1$)**\n\n每个单元格根据分级规则进行分类。给定一个单元格的人口密度 $p$ 和耕地比例 $c$：\n1. 如果 $p \\ge 300$，则类别为 $A_3$。\n2. 否则，如果 $c \\ge 0.20$，则类别为 $A_2$。\n3. 否则，如果 $c \\ge 0.05$ 或 $p \\ge 10$，则类别为 $A_1$。\n4. 否则，类别为 $A_0$。\n\n将这些规则应用于 $t_0$ 时刻的数据，得到分类网格 $A_{t_0}$：\n$$ A_{t_0} = \\begin{pmatrix} 0  1  3 \\\\ 0  2  2 \\\\ 1  3  2 \\end{pmatrix} $$\n将这些规则应用于 $t_1$ 时刻的数据，得到分类网格 $A_{t_1}$：\n$$ A_{t_1} = \\begin{pmatrix} 0  1  3 \\\\ 0  2  2 \\\\ 0  3  2 \\end{pmatrix} $$\n\n**2. 历史转移概率 ($t_0 \\to t_1$)**\n\n我们比较 $A_{t_0}$ 和 $A_{t_1}$ 以获得转移计数 $n_{ij}$。例如，索引为 $(2,0)$ 的单元格在 $t_0$ 时刻从 $A_1$ 转移到 $t_1$ 时刻的 $A_0$，为 $n_{10}$ 贡献了一个计数。完整的转移计数矩阵 $N_{t_0,t_1}$ 为：\n$$ N_{t_0,t_1} = \\begin{pmatrix} 2  0  0  0 \\\\ 1  1  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  2 \\end{pmatrix} $$\n行和为 $n_{0\\cdot}=2$，$n_{1\\cdot}=2$，$n_{2\\cdot}=3$ 和 $n_{3\\cdot}=2$。\n第一个要求的输出是从牧场 ($A_1$) 转移到耕作区 ($A_2$) 的概率，即 $\\hat{p}_{12}$。我们使用公式 $\\hat{p}_{ij} = \\frac{n_{ij} + \\alpha}{n_{i\\cdot} + K\\alpha}$。对于此转移，$i=1$ 且 $j=2$。\n从矩阵中，我们得到 $n_{12}=0$ 和 $n_{1\\cdot}=2$。当 $\\alpha=0.5$ 和 $K=4$ 时：\n$$ [P_{t_0,t_1}]_{1,2} = \\hat{p}_{12} = \\frac{n_{12} + \\alpha}{n_{1\\cdot} + K\\alpha} = \\frac{0 + 0.5}{2 + 4(0.5)} = \\frac{0.5}{4} = 0.125 $$\n\n**3. 基于情景的转移概率 ($t_1 \\to t_2$)**\n\n对于每个情景，我们将 $p_{t_1}$ 和 $c_{t_1}$ 投射到 $t_2$ 时刻，对生成的网格进行分类，并计算所需的转移概率 $[P_{t_1,t_2}^{(S_k)}]_{2,3}$，即从耕作区 ($A_2$) 到城市 ($A_3$) 的转移。$t_1$ 时刻起始于类别 $A_2$ 的单元格数量为 $n_{2\\cdot}=3$。\n\n**情景 $S_1$**：$g_p^{(S_1)} = 1.02, s_c^{(S_1)} = -0.01$。\n预测的数据为：\n$$ p_{t_2}^{(S_1)} = \\begin{pmatrix} 3.06  12.24  346.8 \\\\ 0.306  11.22  61.2 \\\\ 9.18  306  295.8 \\end{pmatrix}, \\quad c_{t_2}^{(S_1)} = \\begin{pmatrix} 0.00  0.14  0.04 \\\\ 0.00  0.34  0.27 \\\\ 0.00  0.19  0.64 \\end{pmatrix} $$\n分类结果为 $A_{t_2}^{(S_1)} = \\begin{pmatrix} 0  1  3 \\\\ 0  2  2 \\\\ 0  3  2 \\end{pmatrix}$。\n$t_1$ 时刻属于类别 $A_2$ 的三个单元格 (索引为 $(1,1), (1,2), (2,2)$) 都保持为类别 $A_2$。因此，转移计数 $n_{23}=0$。\n$$ [P_{t_1,t_2}^{(S_1)}]_{2,3} = \\hat{p}_{23} = \\frac{n_{23} + \\alpha}{n_{2\\cdot} + K\\alpha} = \\frac{0 + 0.5}{3 + 4(0.5)} = \\frac{0.5}{5} = 0.1 $$\n\n**情景 $S_2$**：$g_p^{(S_2)} = 1.10, s_c^{(S_2)} = 0.03$。\n预测的数据为：\n$$ p_{t_2}^{(S_2)} = \\begin{pmatrix} 3.3  13.2  374 \\\\ 0.33  12.1  66 \\\\ 9.9  330  319 \\end{pmatrix}, \\quad c_{t_2}^{(S_2)} = \\begin{pmatrix} 0.03  0.18  0.08 \\\\ 0.04  0.38  0.31 \\\\ 0.03  0.23  0.68 \\end{pmatrix} $$\n分类结果为 $A_{t_2}^{(S_2)} = \\begin{pmatrix} 0  1  3 \\\\ 0  2  2 \\\\ 0  3  3 \\end{pmatrix}$。\n在最初属于类别 $A_2$ 的三个单元格中，单元格 $(2,2)$ 转移到 $A_3$ (因为其人口密度变为 $p=319 \\ge 300$)。另外两个保持为 $A_2$。因此，转移计数为 $n_{23}=1$。\n$$ [P_{t_1,t_2}^{(S_2)}]_{2,3} = \\hat{p}_{23} = \\frac{n_{23} + \\alpha}{n_{2\\cdot} + K\\alpha} = \\frac{1 + 0.5}{3 + 4(0.5)} = \\frac{1.5}{5} = 0.3 $$\n\n**情景 $S_3$**：$g_p^{(S_3)} = 1.30, s_c^{(S_3)} = 0.08$。\n预测的数据为：\n$$ p_{t_2}^{(S_3)} = \\begin{pmatrix} 3.9  15.6  442 \\\\ 0.39  14.3  78 \\\\ 11.7  390  377 \\end{pmatrix}, \\quad c_{t_2}^{(S_3)} = \\begin{pmatrix} 0.08  0.23  0.13 \\\\ 0.09  0.43  0.36 \\\\ 0.08  0.28  0.73 \\end{pmatrix} $$\n分类结果为 $A_{t_2}^{(S_3)} = \\begin{pmatrix} 1  2  3 \\\\ 1  2  2 \\\\ 1  3  3 \\end{pmatrix}$。\n与情景 $S_2$ 类似，在最初属于类别 $A_2$ 的三个单元格中，只有单元格 $(2,2)$ 转移到 $A_3$ (因为其人口密度变为 $p=377 \\ge 300$)。另外两个保持为 $A_2$。转移计数再次为 $n_{23}=1$。\n$$ [P_{t_1,t_2}^{(S_3)}]_{2,3} = \\hat{p}_{23} = \\frac{n_{23} + \\alpha}{n_{2\\cdot} + K\\alpha} = \\frac{1 + 0.5}{3 + 4(0.5)} = \\frac{1.5}{5} = 0.3 $$\n\n综上所述，计算出的四个概率为 $0.125$、$0.1$、$0.3$ 和 $0.3$。", "answer": "$$\n\\boxed{[0.125000, 0.100000, 0.300000, 0.300000]}\n$$", "id": "2513214"}]}