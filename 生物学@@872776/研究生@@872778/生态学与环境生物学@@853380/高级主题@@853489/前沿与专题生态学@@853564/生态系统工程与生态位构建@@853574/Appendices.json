{"hands_on_practices": [{"introduction": "生态系统工程的核心是生物体与其环境之间的相互反馈循环。本练习通过一个数学模型来探索这一基本动态。通过进行稳定性分析 [@problem_id:2484733]，学生将学会如何识别系统的平衡状态，并判断系统在受到扰动后是否会恢复到这些状态，从而揭示诸如“替代稳态”(alternative stable states)等关键概念。", "problem": "考虑一个工程师-环境动力系统，该系统代表了一个生态系统工程师种群以及它们所改变的一个标量非生物环境变量。状态变量是工程师丰度 $N$ 和环境质量 $E$。该模型为\n$$\n\\dot{N} \\;=\\; N\\big(r - m + k E - c N\\big), \\qquad\n\\dot{E} \\;=\\; a N - b E - d E^{2},\n$$\n其中 $r$ 是基准人均出生率，$m$ 是基准人均死亡率，$k$ 量化了环境对工程师适应性（生态位构建强度）的反馈，$c$ 是种内拥挤，$a$ 是工程强度，$b$ 和 $d$ 控制线性和二次环境耗散。\n\n从平衡点 $(N^{\\ast},E^{\\ast})$ （在该点 $\\dot{N}=\\dot{E}=0$）的定义和自治系统的线性化原理（平衡点附近的局部动力学由雅可比矩阵及其特征值决定）出发，对以下参数化\n$$\nr \\,=\\, 0.1, \\quad m \\,=\\, 0.3, \\quad k \\,=\\, 1.0, \\quad c \\,=\\, 0.2, \\quad a \\,=\\, 1.2, \\quad b \\,=\\, 0.5, \\quad d \\,=\\, 0.1.\n$$\n下的所有生物学上允许的平衡点（满足 $N^{\\ast}\\ge 0$ 和 $E^{\\ast}\\ge 0$）进行基于特征值的稳定性分类。然后，关注较小的正共存平衡点（满足 $N^{\\ast}0$ 和 $E^{\\ast}0$），计算该平衡点处雅可比矩阵特征值的最大实部。将您的答案四舍五入到四位有效数字。以时间分之一为单位表示最终值。", "solution": "所给问题是常微分方程二维自治系统稳定性分析的一个标准练习，这是理论生态学中一个常见的模型。该问题具有科学依据，提法明确，客观，并包含获得唯一解所需的所有信息。因此，它被认为是一个有效的问题。我们开始求解。\n\n系统动力学由以下方程给出：\n$$ \\dot{N} = N\\big(r - m + k E - c N\\big) $$\n$$ \\dot{E} = a N - b E - d E^{2} $$\n指定的参数值为 $r = 0.1$，$m = 0.3$，$k = 1.0$，$c = 0.2$，$a = 1.2$，$b = 0.5$，$d = 0.1$。\n代入这些值，系统变为：\n$$ \\dot{N} = N\\big(-0.2 + E - 0.2 N\\big) $$\n$$ \\dot{E} = 1.2 N - 0.5 E - 0.1 E^{2} $$\n\n为了找到平衡点 $(N^{\\ast}, E^{\\ast})$，我们将时间导数设为零：\n$$ N^{\\ast}\\big(-0.2 + E^{\\ast} - 0.2 N^{\\ast}\\big) = 0 \\quad (1) $$\n$$ 1.2 N^{\\ast} - 0.5 E^{\\ast} - 0.1 (E^{\\ast})^{2} = 0 \\quad (2) $$\n\n从方程 $(1)$ 可知，平衡点存在两种可能性。\n\n情况1：平凡平衡点，$N^{\\ast} = 0$。\n将 $N^{\\ast} = 0$ 代入方程 $(2)$ 得：\n$$ -0.5 E^{\\ast} - 0.1 (E^{\\ast})^{2} = -0.1 E^{\\ast}(5 + E^{\\ast}) = 0 $$\n解为 $E^{\\ast} = 0$ 或 $E^{\\ast} = -5$。由于我们要求生物学上允许的平衡点满足 $E^{\\ast} \\ge 0$，我们只考虑 $E^{\\ast} = 0$。这给出了平凡平衡点 $P_0 = (0, 0)$。\n\n情况2：共存平衡点，$N^{\\ast}  0$。\n对于 $N^{\\ast}  0$，方程 $(1)$ 要求括号中的项为零：\n$$ -0.2 + E^{\\ast} - 0.2 N^{\\ast} = 0 $$\n由此，我们将 $N^{\\ast}$ 表示为 $E^{\\ast}$ 的函数：\n$$ N^{\\ast} = \\frac{E^{\\ast} - 0.2}{0.2} = 5E^{\\ast} - 1 \\quad (3) $$\n为使 $N^{\\ast}$ 为正，必须有 $E^{\\ast}  0.2$。\n将方程 $(3)$ 代入方程 $(2)$：\n$$ 1.2(5E^{\\ast} - 1) - 0.5 E^{\\ast} - 0.1 (E^{\\ast})^{2} = 0 $$\n$$ 6E^{\\ast} - 1.2 - 0.5 E^{\\ast} - 0.1 (E^{\\ast})^{2} = 0 $$\n$$ -0.1 (E^{\\ast})^{2} + 5.5 E^{\\ast} - 1.2 = 0 $$\n乘以 $-10$ 得到一个关于 $E^{\\ast}$ 的标准二次方程：\n$$ (E^{\\ast})^{2} - 55 E^{\\ast} + 12 = 0 $$\n使用二次公式 $E^{\\ast} = \\frac{-(-55) \\pm \\sqrt{(-55)^2 - 4(1)(12)}}{2(1)}$，求得 $E^{\\ast}$ 的解为：\n$$ E^{\\ast} = \\frac{55 \\pm \\sqrt{3025 - 48}}{2} = \\frac{55 \\pm \\sqrt{2977}}{2} $$\n这给出了两个正的 $E^{\\ast}$ 值：\n$$ E_1^{\\ast} = \\frac{55 - \\sqrt{2977}}{2} \\approx 0.21905 $$\n$$ E_2^{\\ast} = \\frac{55 + \\sqrt{2977}}{2} \\approx 54.7809 $$\n两个解都满足 $E^{\\ast}  0.2$，因此它们对应于有效的正 $N^{\\ast}$ 值。\n由 $N^{\\ast} = 5E^{\\ast} - 1$ 得到的相应 $N^{\\ast}$ 值为：\n$$ N_1^{\\ast} = 5\\left(\\frac{55 - \\sqrt{2977}}{2}\\right) - 1 = \\frac{273 - 5\\sqrt{2977}}{2} \\approx 0.09527 $$\n$$ N_2^{\\ast} = 5\\left(\\frac{55 + \\sqrt{2977}}{2}\\right) - 1 = \\frac{273 + 5\\sqrt{2977}}{2} \\approx 272.9047 $$\n因此，我们有两个共存平衡点：\n$P_1 = (N_1^{\\ast}, E_1^{\\ast})$ 和 $P_2 = (N_2^{\\ast}, E_2^{\\ast})$。\n\n为了进行稳定性分析，我们计算雅可比矩阵 $J(N, E)$：\n设 $f(N, E) = N(-0.2 + E - 0.2N)$ 且 $g(N, E) = 1.2N - 0.5E - 0.1E^2$。\n$$ J(N, E) = \\begin{pmatrix} \\frac{\\partial f}{\\partial N}  \\frac{\\partial f}{\\partial E} \\\\ \\frac{\\partial g}{\\partial N}  \\frac{\\partial g}{\\partial E} \\end{pmatrix} = \\begin{pmatrix} -0.2 + E - 0.4N  N \\\\ 1.2  -0.5 - 0.2E \\end{pmatrix} $$\n\n$P_0 = (0, 0)$ 的稳定性：\n$$ J(0, 0) = \\begin{pmatrix} -0.2  0 \\\\ 1.2  -0.5 \\end{pmatrix} $$\n特征值是对角线元素 $\\lambda_1 = -0.2$ 和 $\\lambda_2 = -0.5$。由于两者都为实数且为负，因此 $P_0$ 是一个稳定节点。\n\n共存平衡点 $P_1$ 和 $P_2$ 的稳定性：\n在任意共存平衡点，$-0.2 + E^{\\ast} - 0.2N^{\\ast} = 0$。雅可比矩阵的左上角元素简化为 $\\frac{\\partial f}{\\partial N}|_{(N^{\\ast},E^{\\ast})} = (-0.2 + E^{\\ast} - 0.2N^{\\ast}) - 0.2N^{\\ast} = -0.2N^{\\ast}$。\n$$ J(N^{\\ast}, E^{\\ast}) = \\begin{pmatrix} -0.2N^{\\ast}  N^{\\ast} \\\\ 1.2  -0.5 - 0.2E^{\\ast} \\end{pmatrix} $$\n稳定性由迹 $\\text{tr}(J)$ 和行列式 $\\det(J)$ 决定。\n$\\text{tr}(J) = -0.2N^{\\ast} - 0.5 - 0.2E^{\\ast}$\n$\\det(J) = (-0.2N^{\\ast})(-0.5 - 0.2E^{\\ast}) - 1.2N^{\\ast} = N^{\\ast}(0.1 + 0.04E^{\\ast} - 1.2) = N^{\\ast}(0.04E^{\\ast} - 1.1)$\n\n问题要求关注较小的正共存平衡点，即 $P_1 = (N_1^{\\ast}, E_1^{\\ast}) \\approx (0.09527, 0.21905)$。\n我们计算该点的雅可比矩阵。\n$J_1 = J(N_1^{\\ast}, E_1^{\\ast})$。\n$\\text{tr}(J_1) = -0.2N_1^{\\ast} - 0.5 - 0.2E_1^{\\ast} \\approx -0.2(0.09527) - 0.5 - 0.2(0.21905) \\approx -0.01905 - 0.5 - 0.04381 = -0.56286$\n$\\det(J_1) = N_1^{\\ast}(0.04E_1^{\\ast} - 1.1) \\approx 0.09527(0.04(0.21905) - 1.1) \\approx 0.09527(0.008762 - 1.1) = 0.09527(-1.091238) \\approx -0.10396$\n由于 $\\det(J_1)  0$，平衡点 $P_1$ 是一个鞍点，因而是不稳定的。\n\n$J_1$ 的特征值 $\\lambda$ 是特征方程 $\\lambda^2 - \\text{tr}(J_1)\\lambda + \\det(J_1) = 0$ 的根。\n$$ \\lambda = \\frac{\\text{tr}(J_1) \\pm \\sqrt{\\text{tr}(J_1)^2 - 4\\det(J_1)}}{2} $$\n使用计算出的值：\n$$ \\lambda = \\frac{-0.56286 \\pm \\sqrt{(-0.56286)^2 - 4(-0.10396)}}{2} $$\n$$ \\lambda = \\frac{-0.56286 \\pm \\sqrt{0.31681 + 0.41584}}{2} $$\n$$ \\lambda = \\frac{-0.56286 \\pm \\sqrt{0.73265}}{2} $$\n$$ \\lambda = \\frac{-0.56286 \\pm 0.85595}{2} $$\n两个特征值是：\n$$ \\lambda_1 = \\frac{-1.41881}{2} \\approx -0.7094 $$\n$$ \\lambda_2 = \\frac{-0.56286 + 0.85595}{2} = \\frac{0.29309}{2} \\approx 0.14655 $$\n特征值为实数，一个为正，一个为负，证实了 $P_1$ 是一个鞍点。特征值的实部就是它们本身。\n\n这些特征值的最大实部是 $\\lambda_2 \\approx 0.14655$。问题要求将此值四舍五入到四位有效数字。\n$0.14655 \\rightarrow 0.1466$。\n该值的单位是时间的倒数，与问题的提法一致。\n\n为完整起见，对于较大的平衡点 $P_2 = (N_2^{\\ast}, E_2^{\\ast}) \\approx (272.9, 54.78)$：\n$\\text{tr}(J_2) = -0.2N_2^{\\ast} - 0.5 - 0.2E_2^{\\ast} \\approx -54.58 - 0.5 - 10.96 = -66.04  0$。\n$\\det(J_2) = N_2^{\\ast}(0.04E_2^{\\ast} - 1.1) \\approx 272.9(0.04(54.78) - 1.1) \\approx 272.9(2.19 - 1.1) = 272.9(1.09)  0$。\n由于 $\\text{tr}(J_2)  0$ 且 $\\det(J_2)  0$，因此 $P_2$ 是一个稳定平衡点（具体来说，是一个稳定节点）。\n\n最终答案是在较小的正平衡点 $P_1$ 处特征值的最大实部，四舍五入到四位有效数字。\n最大实部约为 $\\approx 0.14655$。\n四舍五入后的值为 $0.1466$。", "answer": "$$\n\\boxed{0.1466}\n$$", "id": "2484733"}, {"introduction": "在生态反馈的基础上，本练习深入探讨了该领域的演化维度，即“生态位构建”(niche construction)。它引入了“适应性动力学”(adaptive dynamics)框架，用于模拟生态工程性状本身如何随时间演化。通过计算选择梯度并寻找奇异策略 [@problem_id:2484716]，学生可以掌握一个强大的工具，用以预测一个主动塑造自身选择环境的种群的长期演化轨迹。", "problem": "在一个表现出生态系统工程和生态位构建的克隆种群中，一个标量遗传性状 $z$ 代表对环境改造的投入（例如，建造水坝的努力）。环境由一个单变量状态变量 $E$ （例如，稳态水位）来概括，它通过一个函数关系 $E(z)$ 对定居性状作出确定性响应。一个性状值为 $z$ 的稀有突变体在环境状态 $E$ 下的单位个体马尔萨斯适应度由下式给出：\n$$\nw(z,E) = a z - b z^{2} + c E,\n$$\n其中 $a$、$b$、$c$ 是实常数，且 $b0$，并且环境对定居性状的响应是线性的，\n$$\nE(z) = d z,\n$$\n其中 $d$ 是实常数。假设生态动态相对于演化变化是快速的，因此当选择作用于 $z$ 时，$E$ 处于由定居者决定的准平衡状态，并假设在自适应动力学（AD）中标准的时间尺度分离和稀有性条件，使得选择梯度等于入侵适应度对性状变化的敏感度，该敏感度是沿着由定居者引起的环境反馈进行评估的。\n\n从第一性原理和标准微积分出发，推导选择梯度 $S(z)$ 的显式表达式，作为 $w$ 对 $z$ 沿着函数 $E(z)$ 求值的全导数，然后求解所有满足 $S(z^{\\ast})=0$ 的奇异策略 $z^{\\ast}$。以最简闭合形式陈述您的最终表达式。如果最终答案需要多个对象，请使用单个 $1\\times 2$ 矩阵的表示法将它们表示为行向量。不需要数值近似，也不需要单位。将任何常数按给定方式以符号表示。不进行四舍五入；报告精确表达式。", "solution": "所述问题具有科学依据，内容完备，且提法恰当。它提出了一个来自自适应动力学领域的标准模型，应用于生态系统工程和生态位构建。所有术语都已定义，任务是直接应用微分学来寻找平衡条件。因此，我们开始推导。\n\n问题要求计算选择梯度 $S(z)$，它被定义为适应度函数 $w(z,E)$ 关于性状 $z$ 的全导数，条件是环境状态 $E$ 本身是定居性状 $z$ 的函数。我们已知一个性状为 $z$ 的突变体在环境 $E$ 中的适应度函数：\n$$\nw(z,E) = a z - b z^{2} + c E\n$$\n以及环境响应函数，它将环境与定居性状值（此处也用 $z$ 表示）联系起来：\n$$\nE(z) = d z\n$$\n常数 $a$、$b$、$c$ 和 $d$ 都是实数，且有约束 $b > 0$。自适应动力学中的时间尺度分离假设意味着，当一个稀有突变体出现时，环境处于由已建立的定居种群决定的准平衡状态。选择梯度衡量了对一个与定居性状有无穷小差异的突变性状的初始选择压力。\n\n问题指示我们将 $S(z)$ 计算为 $w$ 关于 $z$ 沿着函数 $E(z)$ 的全导数。这可以使用多元链式法则来计算。如果我们将 $w$ 视为两个变量的函数，即 $z$ （性状本身）和 $E$ （环境），而 $E$ 又是 $z$ 的函数，那么 $w$ 关于 $z$ 的全导数由下式给出：\n$$\nS(z) = \\frac{d w(z, E(z))}{dz} = \\frac{\\partial w}{\\partial z} + \\frac{\\partial w}{\\partial E} \\frac{dE}{dz}\n$$\n这个表达式正确地将总选择压力分为两个部分：\n1. 直接选择压力，$\\frac{\\partial w}{\\partial z}$，即在环境保持不变的情况下，性状变化导致的适应度变化。\n2. 间接的、由环境介导的选择压力，$\\frac{\\partial w}{\\partial E} \\frac{dE}{dz}$，它是适应度对环境的敏感度（$\\frac{\\partial w}{\\partial E}$）与环境对性状的敏感度（$\\frac{dE}{dz}$）的乘积。\n\n我们计算每个分量。适应度关于性状 $z$ 的偏导数为：\n$$\n\\frac{\\partial w}{\\partial z} = \\frac{\\partial}{\\partial z} (a z - b z^2 + c E) = a - 2bz\n$$\n适应度关于环境 $E$ 的偏导数为：\n$$\n\\frac{\\partial w}{\\partial E} = \\frac{\\partial}{\\partial E} (a z - b z^2 + c E) = c\n$$\n环境状态关于性状 $z$ 的导数为：\n$$\n\\frac{dE}{dz} = \\frac{d}{dz} (d z) = d\n$$\n将这些导数代入选择梯度 $S(z)$ 的公式中，得到：\n$$\nS(z) = (a - 2bz) + (c)(d) = a + cd - 2bz\n$$\n这就是选择梯度的显式表达式。\n\n任务的第二部分是找到所有奇异策略，记为 $z^{\\ast}$。奇异策略是选择梯度为零时的性状值，代表一个潜在的演化平衡点。我们通过求解方程 $S(z^{\\ast}) = 0$ 来找到 $z^{\\ast}$。\n$$\nS(z^{\\ast}) = a + cd - 2bz^{\\ast} = 0\n$$\n我们重排这个线性方程来解出 $z^{\\ast}$：\n$$\n2bz^{\\ast} = a + cd\n$$\n考虑到约束条件 $b > 0$，我们可以毫无问题地除以 $2b$：\n$$\nz^{\\ast} = \\frac{a + cd}{2b}\n$$\n由于关于 $z^{\\ast}$ 的方程 $S(z^{\\ast}) = 0$ 是线性的，所以这个解是唯一的。\n\n问题要求两个结果：选择梯度 $S(z)$ 的表达式和奇异策略 $z^{\\ast}$ 的表达式。这些结果以单个行向量的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} a + cd - 2bz  \\frac{a + cd}{2b} \\end{pmatrix}}\n$$", "id": "2484716"}, {"introduction": "最后的这项实践从理论转向应用，展示了生态系统工程原理如何为现实世界的保护和恢复决策提供信息。该练习将一个常见的管理挑战——分配有限资源——构建为一个约束优化问题 [@problem_id:2484739]。通过解决这个问题，学生将看到如何运用量化模型，在实际的预算和风险约束下最大化生态效益。", "problem": "生态恢复管理者必须在$3$个构建或改造栖息地的生态系统工程师种群中分配有限的恢复投入：河岸海狸（$i=1$）、造礁双壳类（$i=2$）和土壤穴居甲壳类（$i=3$）。设$x_i \\geq 0$表示分配给种群$i$的恢复投入，单位为标准化投入单位。生态系统功能指数$E$汇总了生态位构建和生态系统工程带来的效益，但由于高投入下工程效应的饱和，收益递减。假设$E$是可加分离且严格凹的，表示为\n$$\nE(x_1,x_2,x_3) \\;=\\; a_1 x_1 + a_2 x_2 + a_3 x_3 \\;-\\; \\frac{1}{2}\\, \\begin{pmatrix} x_1  x_2  x_3 \\end{pmatrix} Q \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix},\n$$\n其中$a_1 = 10$，$a_2 = 8$，$a_3 = 6$，$Q = 2 I_3$，$I_3$是$3 \\times 3$单位矩阵。该设定体现了每个工程师种群的投入边际收益递减，且种群间的收益没有交叉干扰。\n\n管理者面临两个线性约束：\n- 预算约束：单位成本为$c_1 = 2$，$c_2 = 1$，$c_3 = 1$，总可用预算为$B = 6$，因此$2 x_1 + x_2 + x_3 \\leq 6$。\n- 预防性风险上限：对干扰脆弱性的累积暴露有风险系数$r_1 = 1$，$r_2 = 2$，$r_3 = 1$和上限$R = 5$，因此$x_1 + 2 x_2 + x_3 \\leq 5$。\n\n构建在这些约束条件以及$x_i \\geq 0$（对于$i \\in \\{1,2,3\\}$）下最大化$E$的优化问题。然后，利用约束优化的基本原理和所述的生态-经济结构，确定唯一的最优分配向量$x^\\star = (x_1^\\star, x_2^\\star, x_3^\\star)$。\n\n以行向量形式$\\begin{pmatrix} x_1^\\star  x_2^\\star  x_3^\\star \\end{pmatrix}$报告您的最终答案。无需四舍五入。投入变量是无量纲的标准化单位；报告最终向量时无需单位。", "solution": "用户提供了一个定义明确的约束优化问题。所有给定条件都是明确且一致的，目标函数在数学上是合理的，约束条件构成了一个非空的凸可行集。该问题在资源分配的数学建模框架内具有科学依据，并且是适定的。因此，该问题是有效的，并将提供解答。\n\n问题是在一组约束条件下最大化生态系统功能指数$E$。设恢复投入向量为$x = \\begin{pmatrix} x_1  x_2  x_3 \\end{pmatrix}^T$。目标函数由下式给出\n$$\nE(x_1,x_2,x_3) = a_1 x_1 + a_2 x_2 + a_3 x_3 - \\frac{1}{2} x^T Q x\n$$\n参数为$a_1 = 10$，$a_2 = 8$，$a_3 = 6$，$Q = 2I_3$，其中$I_3$是$3 \\times 3$单位矩阵。展开矩阵形式，目标函数为：\n$$\nE(x_1, x_2, x_3) = 10x_1 + 8x_2 + 6x_3 - \\frac{1}{2} (2x_1^2 + 2x_2^2 + 2x_3^2) = 10x_1 + 8x_2 + 6x_3 - x_1^2 - x_2^2 - x_3^2\n$$\n函数$E(x)$是严格凹的，因为它的Hessian矩阵$\\nabla^2 E = -2I_3$是负定的。\n\n该优化问题可表述为：\n$$\n\\begin{aligned}\n\\underset{x_1, x_2, x_3}{\\text{最大化}}  \\quad 10x_1 + 8x_2 + 6x_3 - x_1^2 - x_2^2 - x_3^2 \\\\\n\\text{约束条件为}  \\quad 2x_1 + x_2 + x_3 \\leq 6 \\\\\n \\quad x_1 + 2x_2 + x_3 \\leq 5 \\\\\n \\quad x_1, x_2, x_3 \\geq 0\n\\end{aligned}\n$$\n这是一个凸优化问题，因为它涉及在一个由线性不等式定义的凸可行域上最大化一个严格凹函数。对于此类问题，Karush-Kuhn-Tucker (KKT)条件是获得唯一全局最优解的充分必要条件。\n\n标准做法是通过考虑目标函数的相反数$f(x) = -E(x)$，将最大化问题转化为最小化问题。\n$$\nf(x_1, x_2, x_3) = x_1^2 + x_2^2 + x_3^2 - 10x_1 - 8x_2 - 6x_3\n$$\n约束条件被重写为$g_j(x) \\leq 0$的形式：\n$$\n\\begin{aligned}\ng_1(x) = 2x_1 + x_2 + x_3 - 6 \\leq 0 \\\\\ng_2(x) = x_1 + 2x_2 + x_3 - 5 \\leq 0 \\\\\ng_3(x) = -x_1 \\leq 0 \\\\\ng_4(x) = -x_2 \\leq 0 \\\\\ng_5(x) = -x_3 \\leq 0\n\\end{aligned}\n$$\n这个最小化问题的拉格朗日函数是：\n$$\nL(x, \\lambda, \\mu) = f(x) + \\lambda_1 g_1(x) + \\lambda_2 g_2(x) + \\mu_1(-x_1) + \\mu_2(-x_2) + \\mu_3(-x_3)\n$$\n其中$\\lambda_1, \\lambda_2$是预算和风险约束的拉格朗日乘子，$\\mu_1, \\mu_2, \\mu_3$是非负约束的拉格朗日乘子。\n\nKKT条件如下：\n1. 平稳性（Stationarity）：拉格朗日函数关于$x$的梯度必须为零。\n$$\n\\begin{aligned}\n\\frac{\\partial L}{\\partial x_1} = 2x_1 - 10 + 2\\lambda_1 + \\lambda_2 - \\mu_1 = 0 \\\\\n\\frac{\\partial L}{\\partial x_2} = 2x_2 - 8 + \\lambda_1 + 2\\lambda_2 - \\mu_2 = 0 \\\\\n\\frac{\\partial L}{\\partial x_3} = 2x_3 - 6 + \\lambda_1 + \\lambda_2 - \\mu_3 = 0\n\\end{aligned}\n$$\n2. 原始可行性（Primal Feasibility）：必须满足所有约束条件。\n$$\n2x_1 + x_2 + x_3 \\leq 6, \\quad x_1 + 2x_2 + x_3 \\leq 5, \\quad x_1, x_2, x_3 \\geq 0\n$$\n3. 对偶可行性（Dual Feasibility）：拉格朗日乘子必须为非负。\n$$\n\\lambda_1, \\lambda_2, \\mu_1, \\mu_2, \\mu_3 \\geq 0\n$$\n4. 互补松弛性（Complementary Slackness）：\n$$\n\\lambda_1(2x_1 + x_2 + x_3 - 6) = 0, \\quad \\lambda_2(x_1 + 2x_2 + x_3 - 5) = 0, \\quad \\mu_1 x_1 = 0, \\quad \\mu_2 x_2 = 0, \\quad \\mu_3 x_3 = 0\n$$\n根据平稳性条件，我们可以用乘子表示$x_i$：\n$$\n\\begin{aligned}\nx_1 = \\frac{10 - 2\\lambda_1 - \\lambda_2 + \\mu_1}{2} = 5 - \\lambda_1 - \\frac{\\lambda_2}{2} + \\frac{\\mu_1}{2} \\\\\nx_2 = \\frac{8 - \\lambda_1 - 2\\lambda_2 + \\mu_2}{2} = 4 - \\frac{\\lambda_1}{2} - \\lambda_2 + \\frac{\\mu_2}{2} \\\\\nx_3 = \\frac{6 - \\lambda_1 - \\lambda_2 + \\mu_3}{2} = 3 - \\frac{\\lambda_1}{2} - \\frac{\\lambda_2}{2} + \\frac{\\mu_3}{2}\n\\end{aligned}\n$$\n我们根据哪些约束是激活的（紧的）来分情况分析。一个合理的初始假设是最优投入均为正，即$x_1, x_2, x_3  0$。根据互补松弛性，这意味着$\\mu_1 = \\mu_2 = \\mu_3 = 0$。$x_i$的表达式简化为：\n$$\n\\begin{aligned}\nx_1 = 5 - \\lambda_1 - \\frac{\\lambda_2}{2} \\\\\nx_2 = 4 - \\frac{\\lambda_1}{2} - \\lambda_2 \\\\\nx_3 = 3 - \\frac{\\lambda_1}{2} - \\frac{\\lambda_2}{2}\n\\end{aligned}\n$$\n无约束最优解（此时$\\lambda_1 = \\lambda_2 = 0$）是$(x_1, x_2, x_3) = (5, 4, 3)$。该解违反了两个主要约束条件：$2(5) + 4 + 3 = 17  6$和$5 + 2(4) + 3 = 16  5$。因此，这些约束中至少有一个是激活的。\n\n我们来测试两个主要约束都激活的情况，即$2x_1 + x_2 + x_3 = 6$和$x_1 + 2x_2 + x_3 = 5$。根据互补松弛性，这意味着我们可以有$\\lambda_1  0$和$\\lambda_2  0$。\n将$x_i$的表达式代入两个紧约束方程中：\n对于$2x_1 + x_2 + x_3 = 6$：\n$$\n2(5 - \\lambda_1 - \\frac{\\lambda_2}{2}) + (4 - \\frac{\\lambda_1}{2} - \\lambda_2) + (3 - \\frac{\\lambda_1}{2} - \\frac{\\lambda_2}{2}) = 6\n$$\n$$\n(10 - 2\\lambda_1 - \\lambda_2) + (4 - \\frac{\\lambda_1}{2} - \\lambda_2) + (3 - \\frac{\\lambda_1}{2} - \\frac{\\lambda_2}{2}) = 6\n$$\n$$\n17 - (2 + \\frac{1}{2} + \\frac{1}{2})\\lambda_1 - (1 + 1 + \\frac{1}{2})\\lambda_2 = 6\n$$\n$$\n17 - 3\\lambda_1 - \\frac{5}{2}\\lambda_2 = 6 \\implies 3\\lambda_1 + \\frac{5}{2}\\lambda_2 = 11 \\implies 6\\lambda_1 + 5\\lambda_2 = 22 \\quad (1)\n$$\n对于$x_1 + 2x_2 + x_3 = 5$：\n$$\n(5 - \\lambda_1 - \\frac{\\lambda_2}{2}) + 2(4 - \\frac{\\lambda_1}{2} - \\lambda_2) + (3 - \\frac{\\lambda_1}{2} - \\frac{\\lambda_2}{2}) = 5\n$$\n$$\n(5 - \\lambda_1 - \\frac{\\lambda_2}{2}) + (8 - \\lambda_1 - 2\\lambda_2) + (3 - \\frac{\\lambda_1}{2} - \\frac{\\lambda_2}{2}) = 5\n$$\n$$\n16 - (1 + 1 + \\frac{1}{2})\\lambda_1 - (\\frac{1}{2} + 2 + \\frac{1}{2})\\lambda_2 = 5\n$$\n$$\n16 - \\frac{5}{2}\\lambda_1 - 3\\lambda_2 = 5 \\implies \\frac{5}{2}\\lambda_1 + 3\\lambda_2 = 11 \\implies 5\\lambda_1 + 6\\lambda_2 = 22 \\quad (2)\n$$\n我们现在求解关于$\\lambda_1$和$\\lambda_2$的线性方程组：\n$$\n\\begin{aligned}\n6\\lambda_1 + 5\\lambda_2 = 22 \\\\\n5\\lambda_1 + 6\\lambda_2 = 22\n\\end{aligned}\n$$\n将第一个方程乘以$5$，第二个方程乘以$6$：\n$$\n\\begin{aligned}\n30\\lambda_1 + 25\\lambda_2 = 110 \\\\\n30\\lambda_1 + 36\\lambda_2 = 132\n\\end{aligned}\n$$\n用第二个新方程减去第一个，得到$11\\lambda_2 = 22$，解得$\\lambda_2 = 2$。\n将$\\lambda_2 = 2$代入第一个原方程：$6\\lambda_1 + 5(2) = 22 \\implies 6\\lambda_1 = 12 \\implies \\lambda_1 = 2$。\n两个乘子都为正（$\\lambda_1=2  0, \\lambda_2=2  0$），这与两个约束都是紧约束的假设一致。\n\n现在我们使用这些乘子的值来找到最优分配向量$x^\\star = (x_1^\\star, x_2^\\star, x_3^\\star)$：\n$$\n\\begin{aligned}\nx_1^\\star = 5 - \\lambda_1 - \\frac{\\lambda_2}{2} = 5 - 2 - \\frac{2}{2} = 2 \\\\\nx_2^\\star = 4 - \\frac{\\lambda_1}{2} - \\lambda_2 = 4 - \\frac{2}{2} - 2 = 1 \\\\\nx_3^\\star = 3 - \\frac{\\lambda_1}{2} - \\frac{\\lambda_2}{2} = 3 - \\frac{2}{2} - \\frac{2}{2} = 1\n\\end{aligned}\n$$\n候选解是$x^\\star = (2, 1, 1)$。我们验证该解是否满足所有KKT条件。\n1. 平稳性：根据构造已满足。\n2. 原始可行性：\n$x_1=2 \\geq 0$，$x_2=1 \\geq 0$，$x_3=1 \\geq 0$。非负性成立。\n$2x_1 + x_2 + x_3 = 2(2) + 1 + 1 = 6 \\leq 6$。成立。\n$x_1 + 2x_2 + x_3 = 2 + 2(1) + 1 = 5 \\leq 5$。成立。\n3. 对偶可行性：$\\lambda_1 = 2 \\geq 0$，$\\lambda_2 = 2 \\geq 0$。我们假设了$x_i  0$，所以$\\mu_1 = \\mu_2 = \\mu_3 = 0$，它们也是非负的。成立。\n4. 互补松弛性：\n$\\lambda_1(2x_1+x_2+x_3-6) = 2(6-6) = 0$。成立，因为$\\lambda_1  0$且该约束为紧约束。\n$\\lambda_2(x_1+2x_2+x_3-5) = 2(5-5) = 0$。成立，因为$\\lambda_2  0$且该约束为紧约束。\n$\\mu_i x_i = 0 \\cdot x_i = 0$。成立，因为$\\mu_i=0$。\n\n由于所有KKT条件都得到满足，且该问题是一个凸优化问题，因此解$x^\\star = (2, 1, 1)$是唯一的全局最大值点。最优分配为$x_1^\\star = 2$，$x_2^\\star = 1$和$x_3^\\star = 1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2  1  1 \\end{pmatrix}}\n$$", "id": "2484739"}]}