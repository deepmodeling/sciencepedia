{"hands_on_practices": [{"introduction": "遗传漂变是导致小种群遗传多样性丧失的关键进化力量。本练习将从第一性原理出发，推导并应用描述预期杂合度（$H_t$）如何随时间衰减的经典公式，从而将有效的种群大小（$N_e$）与遗传侵蚀的速率直接联系起来。通过这个计算，你将能够量化遗传漂变对种群长期生存能力构成的威胁。", "problem": "一个封闭、随机交配的二倍体种群遵循Wright–Fisher模型，其有效种群大小 $N_{e}$ 为常数。您正在研究一个没有突变、迁移或选择的单一中性位点。令 $H_{t}$ 表示预期杂合度（从第 $t$ 代随机抽取的两个等位基因处于不同等位基因状态的概率），令 $F_{t}$ 表示近交系数（从第 $t$ 代随机抽取的两个等位基因是同源相同的概率）。\n\n从 $H_{t}$ 和 $F_{t}$ 的基本定义以及大小为 $N_{e}$ 的二倍体种群中配子的随机结合出发，推导出一个关于 $H_{t+1}$（以 $H_{t}$ 和 $N_{e}$ 表示）的第一性原理递推关系，然后以闭合形式求解该递推关系，得到 $H_{t}$ 作为 $H_{0}$、$N_{e}$ 和 $t$ 的函数。\n\n将您的结果应用于一个初始杂合度 $H_{0} = 0.8$、有效种群大小 $N_{e} = 100$ 的种群，计算 $t = 50$ 代后的预期杂合度 $H_{50}$，以及50代后保留的初始遗传多样性分数 $H_{50}/H_{0}$。将所求的两个量都表示为纯数（无单位）。将您的数值答案四舍五入到四位有效数字。", "solution": "我们在Wright–Fisher模型的假设下进行研究：一个封闭、随机交配、世代不重叠的二倍体种群，其有效种群大小 $N_{e}$ 为常数，并且研究的是一个没有突变、迁移或选择的中性位点。令 $H_{t}$ 为第 $t$ 代的预期杂合度，令 $F_{t}$ 为近交系数，即从第 $t$ 代随机抽取的两个等位基因是同源相同的概率。\n\n基本定义和事实：\n- 根据定义，$F_{t}$ 是同源相同（identity by descent）的概率；在没有突变的情况下，状态相同（identity by state）与同源相同是一致的，因此预期杂合度通过补集与 $F_{t}$ 相关。更准确地说，两个抽样等位基因不同的概率，等于它们并非从初始状态传播而来的同源相同的概率。这得出了标准关系式\n$$\nH_{t} = H_{0}\\bigl(1 - F_{t}\\bigr),\n$$\n这是一个经过充分验证的结果，它将预期杂合度与近交系数联系起来。\n- 在一个有效大小为 $N_{e}$ 的二倍体种群中，配子随机结合的情况下，于第 $t+1$ 代抽取的两个等位基因在紧邻的上一代发生溯祖（即它们是同一个亲本基因拷贝的复制品）的概率是\n$$\n\\frac{1}{2N_{e}}.\n$$\n如果它们没有立即发生溯祖（概率为 $1 - \\frac{1}{2N_{e}}$），那么它们的同源相同概率就与上一代相同。这导出了近交系数的经典递推关系：\n$$\nF_{t+1} \\;=\\; \\frac{1}{2N_{e}} \\;+\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) F_{t}.\n$$\n\n根据 $H_{t}$ 和 $F_{t}$ 之间的关系，我们推导杂合度的递推关系。对 $F$ 的递推关系式两边取补：\n\n$$\n1 - F_{t+1} \\;=\\; 1 - \\frac{1}{2N_{e}} - \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) F_{t}\n\\;=\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr)\\bigl(1 - F_{t}\\bigr).\n$$\n\n两边同时乘以 $H_{0}$ 并使用 $H_{t} = H_{0}(1 - F_{t})$，可得\n\n$$\nH_{t+1} \\;=\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) H_{t}.\n$$\n\n这个一阶线性差分方程通过迭代求解得到\n\n$$\nH_{t} \\;=\\; H_{0}\\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr)^{t}.\n$$\n\n\n现在我们将此应用于 $H_{0} = 0.8$，$N_{e} = 100$ 和 $t = 50$ 的情况。计算每代保留因子：\n\n$$\n1 - \\frac{1}{2N_{e}} \\;=\\; 1 - \\frac{1}{200} \\;=\\; \\frac{199}{200} \\;=\\; 0.995.\n$$\n\n因此，\n\n$$\nH_{50} \\;=\\; 0.8 \\times 0.995^{50}.\n$$\n\n为了计算50代后保留的初始多样性分数，我们计算\n\n$$\n\\frac{H_{50}}{H_{0}} \\;=\\; 0.995^{50}.\n$$\n\n\n我们现在来计算 $0.995^{50}$。使用重复平方法或对数计算可得\n\n$$\n0.995^{50} \\approx 0.7783151801\\ldots\n$$\n\n于是，\n\n$$\nH_{50} \\;=\\; 0.8 \\times 0.7783151801\\ldots \\;\\approx\\; 0.6226521441\\ldots\n$$\n\n\n四舍五入到四位有效数字：\n- $H_{50} \\approx 0.6227$，\n- $H_{50}/H_{0} \\approx 0.7783$。\n\n根据要求，这两个量都是无量纲的。", "answer": "$$\n\\boxed{\\begin{pmatrix}0.6227  0.7783\\end{pmatrix}}\n$$", "id": "2494469"}, {"introduction": "有效种群大小（$N_e$）是衡量遗传漂变强度的核心指标，但它往往不等于我们直接观察到的个体总数（$N$）。本练习探讨了性别比例不均等这一常见情况如何显著降低$N_e$，你将通过追溯等位基因的合并概率来推导$N_e$的计算公式。这个实践将使你掌握评估种群真实遗传脆弱性的关键技能，而不仅仅是依赖于表面的种群普查数据。[@problem_id:2494485]", "problem": "一个孤立的、雌雄异体的二倍体物种，在某一繁殖季节，其普查规模为 $N_m = 50$ 只成年雄性和 $N_f = 200$ 只成年雌性。假设一个理想化的Wright–Fisher模型，具有离散世代、随机交配、世代不重叠，并且没有选择、迁移或突变。每个合子由一个从雄性配子库中抽取的单倍体配子和一个从雌性配子库中抽取的单倍体配子结合而成，同一性别内的所有成年个体平均贡献相等数量的配子，且后代数量遵循此模型固有的多项式抽样。\n\n使用近交有效种群大小的定义，即由于随机抽样导致的近交系数 $F$ 的每代增量 $\\Delta F$ 满足 $\\Delta F = 1/(2 N_e)$（其中 $N_e$ 是能产生与理想雌雄同体种群相同 $\\Delta F$ 的某个值），通过考虑在第 $t$ 代随机抽取的两个基因拷贝因其在第 $t-1$ 代发生溯祖而同源相同（Identity by Descent, IBD）的概率，来推导该两性种群的 $\\Delta F$。由此，在这些假设下，计算给定 $N_m$ 和 $N_f$ 时的有效种群大小 $N_e$。精确陈述您的数值答案。然后，用基于您所使用的抽样过程的机理术语，简要解释为什么偏斜的性别比会相对于普查规模减小 $N_e$。\n\n您的最终数值答案必须是一个实数。无需四舍五入。无需单位。", "solution": "我们从基于近交的有效种群大小的定义开始：在一个大小为 $N$ 的雌雄同体理想Wright–Fisher种群中，近交系数的每代变化满足 $\\Delta F = 1/(2N)$。根据近交有效种群大小 $N_e$ 的定义，任何近交每代增量为 $\\Delta F$ 的种群，其 $N_e$ 都被指定为满足 $\\Delta F = 1/(2 N_e)$ 的值。\n\n为了在一个有 $N_m$ 个雄性和 $N_f$ 个雌性的两性种群中找到 $\\Delta F$，我们计算从新生代 $t$ 中随机抽样的两个基因拷贝在亲代 $t-1$ 中溯祖（即它们是同一个亲本基因拷贝的复制品）的概率。这个概率，即溯祖概率 $P_c$，等于新产生的近交，即 $\\Delta F$。\n\n这两个基因拷贝都来自父源的概率是 $1/4$。在这种情况下，它们溯祖到同一个父本基因拷贝的概率为 $1/(2N_m)$。因此，通过父源路径发生溯祖的概率为 $\\frac{1}{4} \\cdot \\frac{1}{2N_m}$。\n同样，两个拷贝都来自母源的概率是 $1/4$，它们溯祖到同一个母本基因拷贝的概率为 $1/(2N_f)$。因此，通过母源路径发生溯祖的概率为 $\\frac{1}{4} \\cdot \\frac{1}{2N_f}$。\n（注意：若一个拷贝来自父源，一个来自母源，概率为 $1/2$，它们在亲代中不可能溯祖。）\n\n总的单代溯祖概率为这两个互斥事件的概率之和：\n$$\n\\Delta F = P_c = \\frac{1}{8N_m} + \\frac{1}{8N_f}\n$$\n根据 $N_e$ 的定义，$\\Delta F = 1/(2N_e)$。因此，\n$$\n\\frac{1}{2N_e} = \\frac{1}{8N_m} + \\frac{1}{8N_f}\n$$\n求解 $N_e$ 可得：\n$$\n\\frac{1}{N_e} = \\frac{1}{4N_m} + \\frac{1}{4N_f} = \\frac{N_f + N_m}{4N_m N_f}\n$$\n因此，公认的两性形式为：\n$$\nN_e = \\frac{4 N_m N_f}{N_m + N_f}\n$$\n代入 $N_m = 50$ 和 $N_f = 200$，\n$$\nN_e \\;=\\; \\frac{4 \\times 50 \\times 200}{50 + 200}\n\\;=\\; \\frac{4 \\times 10000}{250}\n\\;=\\; \\frac{40000}{250}\n\\;=\\; 160.\n$$\n因此，有效种群大小为 $160$。\n\n在性别比偏斜情况下 $N_e$ 减小的机理学解释：抽样过程表明，每代溯祖概率是父源贡献（与 $1/(4N_m)$ 成正比）和母源贡献（与 $1/(4N_f)$ 成正比）的和。这是一个类似于调和平均的组合，其大小主要由 $N_m$ 和 $N_f$ 中较小者决定。当性别比偏斜时，数量较少的性别为其谱系一侧的下一代贡献的独特亲本谱系更少，这使得从后代中抽样的两个基因拷贝更有可能共享来自该性别的同一个亲本。这提高了单代溯祖概率 $\\Delta F$，而通过 $\\Delta F = 1/(2N_e)$ 的关系，这会相对于普查规模 $N_m + N_f$ 降低 $N_e$。直观地说，遗传贡献受到数量较少的性别的瓶颈限制，因为每个后代都必须从一个雄性和一个雌性那里继承基因，所以独立谱系的数量不能超过起限制作用的性别数量，从而增加了遗传漂变和近交。", "answer": "$$\\boxed{160}$$", "id": "2494485"}, {"introduction": "小种群面临的最终风险是“灭绝漩涡”，这是一个由遗传和生态因素共同驱动的恶性循环。在这个高级实践中，你将构建一个耦合了种群动态和近交累积的数学模型，以模拟这一过程。通过编程和模拟，你将能够亲手探索种群崩溃的临界条件，深刻理解近交衰退和阿利效应（Allee effect）是如何将一个脆弱的种群推向灭绝的。[@problem_id:2494475]", "problem": "要求您建立并分析一个离散时间耦合的种群—遗传模型，该模型能够捕捉小种群中近交累积与种群增长之间的反馈。您的实现必须从基本且经过充分检验的关系出发，不得依赖任何未指明的启发式方法。\n\n定义一个种群大小序列 $\\{N_t\\}_{t \\ge 0}$ 和一个近交系数序列 $\\{F_t\\}_{t \\ge 0}$，它们具有以下性质。\n\n- 种群动态。使用 Ricker 型密度调节和乘性 Allee 效应。每代普查规模的更新公式为\n$$\nN_{t+1} \\;=\\; N_t \\;\\exp\\!\\big(r \\,(1 - N_t/K)\\big)\\; \\exp(-B\\,F_t)\\; \\frac{N_t}{N_t + A},\n$$\n其中 $r$ 是内禀增长参数，$K$ 是环境承载力，$A$ 是 Allee 效应尺度，而 $\\exp(-B F_t)$ 是由近交引起的平均适合度下降（其中近交负荷参数 $B$ 以二倍体致死当量为单位）。\n\n- 遗传学。在每一代中，近交系数根据标准的、无突变或迁移的 Wright–Fisher 随机交配递归关系进行更新：\n$$\nF_{t+1} \\;=\\; F_t \\;+\\; \\frac{1 - F_t}{2\\,N_{e,t}},\n$$\n其中有效种群大小（记为 $N_{e,t}$）与普查规模成比例，$N_{e,t} \\,=\\, \\alpha\\, N_t$，且 $\\alpha \\in (0,1]$ 捕捉了繁殖成功率的方差以及对理想条件的偏离。为了在极小种群中保持生物学合理性，对有效种群大小施加一个下界，使得 $N_{e,t} \\leftarrow \\max(\\alpha N_t, N_e^{\\min})$，其中 $N_e^{\\min} = 1$。\n\n- 灭绝边界。将 $N_t \\le N_{\\mathrm{ext}}$ 视为一个吸收性灭绝状态，其中 $N_{\\mathrm{ext}} = 10^{-3}$。一旦 $N_t \\le N_{\\mathrm{ext}}$，该种群即被视为灭绝，并为分类目的保持此状态。\n\n解释。这种耦合创建了一个反馈：小的 $N_t$ 会减小 $N_{e,t}$，从而加速 $F_t$ 的增长，这又会降低平均适合度 $\\exp(-B F_t)$，可能进一步压低 $N_{t+1}$，从而可能产生一个灭绝漩涡。相反，足够大的 $N_t$ 会增加 $N_{e,t}$，减缓 $F_t$ 的增长，并可能使种群得以存续。\n\n任务。对于下面测试套件中的每个参数集，从初始条件 $(N_0^{\\mathrm{low}}, F_0)$ 和 $(N_0^{\\mathrm{high}}, F_0)$（其中 $F_0 = 0$）开始，对耦合系统进行两次确定性模拟。将系统精确演化 $T$ 代。通过比较两次运行的结果，对该参数集的长期结果进行分类：\n\n- 如果两条轨迹都达到灭绝（即在 $\\le T$ 步内 $N_t \\le N_{\\mathrm{ext}}$），则返回整数 $0$。\n- 如果两条轨迹都存续（即在 $T$ 步内均未达到灭绝），则返回整数 $1$。\n- 如果在 $T$ 步内恰好一条轨迹达到灭绝而另一条存续，则返回整数 $2$（这表明存在双稳态和一个灭绝漩涡阈值）。\n\n推导的基本依据。您的构建必须基于：(i) Wright–Fisher 种群中近交系数更新的定义，(ii) 有效种群大小与普查规模之间通过一个比例常数建立的关系，(iii) 建模为 $\\exp(-B F)$ 的对平均适合度的乘性近交衰退，以及 (iv) 带有 Allee 效应因子的 Ricker 型种群动态更新。\n\n数值要求。本问题以无量纲形式提出，因此不需要物理单位。不涉及角度。任何分数或比例在代码中都应表示为小数。您算法中的所有数值决策（包括灭绝检测）都必须严格遵循上述定义，不得有任何偏离。\n\n测试套件。请精确使用以下参数集。每个元组为 $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$，所有数字均为实数，并在此处提供：\n\n- 情况 1: $(1.0, 1000.0, 0.0, 0.7, 0.5, 5.0, 500.0, 300)$\n- 情况 2: $(1.0, 1000.0, 100.0, 0.2, 0.9, 10.0, 600.0, 500)$\n- 情况 3: $(1.0, 1000.0, 0.0, 0.5, 1.4, 100.0, 600.0, 300)$\n- 情况 4: $(1.0, 1000.0, 0.0, 0.5, 0.98, 1.0, 400.0, 500)$\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3,x_4]$），$x_i$ 是上述顺序中情况 $i$ 的整数分类。不允许有其他输出。", "solution": "问题陈述已经过评估，被认为是有效的。它具有科学依据、提法得当、客观，并提供了构建形式化解法所需的所有信息。该模型基于种群生态学和遗传学的既定原则。我将继续进行解法的推导和实现。\n\n该问题要求模拟一个由两个离散时间确定性方程组成的耦合系统，这两个方程描述了种群大小 $N_t$ 和平均近交系数 $F_t$ 的演化。分析旨在根据种群对初始种群大小的敏感性对其长期行为进行分类，这揭示了灭绝漩涡的潜在可能性。\n\n该系统由以下递归关系组定义：\n\n1. **种群动态**：从第 $t$ 代到第 $t+1$ 代的普查种群规模的变化由一个包含内禀增长、密度依赖性调节、近交衰退和 Allee 效应的模型决定。方程为：\n$$\nN_{t+1} = N_t \\exp\\left(r \\left(1 - \\frac{N_t}{K}\\right)\\right) \\exp(-B F_t) \\frac{N_t}{N_t + A}\n$$\n此处，$r$ 是自然增长的内禀速率，$K$ 是环境承载力，$B$ 是近交负荷参数（衡量单位近交程度导致的适合度降低），$A$ 是定义临界种群大小阈值的 Allee 效应参数。项 $\\exp(r (1 - N_t/K))$ 是 Ricker 密度调节模型。项 $\\exp(-B F_t)$ 表示因近交导致的种群平均适合度下降。项 $N_t / (N_t + A)$ 模拟了组分 II Allee 效应，即在低种群密度下，人均增长率随密度增加而增加。\n\n2. **遗传动态**：近交系数 $F_t$，即某个基因座上的两个等位基因因共同祖先而相同的概率，根据有限大小的随机交配种群的标准 Wright-Fisher 模型进行演化：\n$$\nF_{t+1} = F_t + \\frac{1 - F_t}{2 N_{e,t}}\n$$\n该方程表明，每一代中近交的增长速率与有效种群大小 $N_{e,t}$ 成反比。随着 $F_t$ 接近其最大值 1，增长速率会减慢。\n\n3. **生态—演化耦合**：种群动态过程和遗传过程是耦合的。有效种群大小 $N_{e,t}$ 被假定为普查规模 $N_t$ 的一部分，并由一个下限值修正：\n$$\nN_{e,t} = \\max(\\alpha N_t, N_e^{\\min})\n$$\n其中 $\\alpha \\in (0, 1]$ 是一个比例因子，$N_e^{\\min} = 1$ 是一个最小有效规模，以确保即使在 $N_t \\to 0$ 时，遗传更新方程仍保持生物学上的合理性。反过来，近交系数 $F_t$ 会影响 $N_{t+1}$ 的种群动态更新，从而形成一个反馈循环。小的 $N_t$ 导致小的 $N_{e,t}$，加速了 $F_t$ 的上升，从而导致更严重的近交衰退，进一步减小 $N_{t+1}$。这种正反馈是灭绝漩涡的机制。\n\n**模拟算法与分类**\n\n对于每个给定的参数集 $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$，执行以下算法。\n\n首先，定义一个模拟函数。该函数以一个参数集和初始种群大小 $N_0$ 作为输入，初始近交系数固定为 $F_0 = 0$。它最多迭代 $T$ 代。\n\n单个轨迹的模拟过程如下：\n- 初始化状态变量 $N \\leftarrow N_0$ 和 $F \\leftarrow F_0$。\n- 对于从 $0$ 到 $T-1$ 的每个离散时间步 $t$：\n    - 检查灭绝：如果 $N \\leq N_{\\mathrm{ext}}$（其中 $N_{\\mathrm{ext}} = 10^{-3}$），则认为种群灭绝。此轨迹的模拟终止，结果记录为“灭绝”。\n    - 如果未灭绝，计算当前代的有效种群大小：$N_e \\leftarrow \\max(\\alpha N, 1.0)$。\n    - 使用当前状态 $(N, F)$ 和模型方程计算下一代的状态 $(N_{\\mathrm{next}}, F_{\\mathrm{next}})$：\n        $$\n        N_{\\mathrm{next}} \\leftarrow N \\exp\\left(r \\left(1 - \\frac{N}{K}\\right)\\right) \\exp(-B F) \\frac{N}{N + A}\n        $$\n        $$\n        F_{\\mathrm{next}} \\leftarrow F + \\frac{1 - F}{2 N_e}\n        $$\n    - 更新状态：$N \\leftarrow N_{\\mathrm{next}}$ 和 $F \\leftarrow F_{\\mathrm{next}}$。\n- 循环完成后（即在 $T$ 次更新后），如果种群尚未被宣布灭绝，则进行最终检查：如果 $N \\leq N_{\\mathrm{ext}}$，则认为种群在第 $T$ 代灭绝。否则，它已存续。\n\n对于每个参数集，该模拟函数被调用两次：一次使用低初始种群大小 $N_0^{\\mathrm{low}}$，另一次使用高初始种群大小 $N_0^{\\mathrm{high}}$。设其结果分别为 `extinct_low` 和 `extinct_high`（每个都是布尔值）。\n\n该参数集的最终分类由这两个结果根据指定规则确定：\n- 如果 `extinct_low` 为真且 `extinct_high` 为真，则分类为 $0$。\n- 如果 `extinct_low` 为假且 `extinct_high` 为假，则分类为 $1$。\n- 如果一个为真而另一个为假，则分类为 $2$。这表示双稳态，即种群的长期命运取决于其初始大小，这是灭绝漩涡的一个典型特征。\n\n实现将把此逻辑应用于所提供的四个测试用例中的每一个，并将结果格式化为整数列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(r, K, A, alpha, B, N0, T, Next_val, Ne_min, F0):\n    \"\"\"\n    Simulates the coupled demographic-genetic model for T generations.\n\n    This function evolves the population size N and inbreeding coefficient F\n    according to the provided discrete-time equations.\n\n    Args:\n        r (float): Intrinsic growth parameter.\n        K (float): Carrying capacity.\n        A (float): Allee-effect scale.\n        alpha (float): Scaling factor for effective population size.\n        B (float): Inbreeding load parameter.\n        N0 (float): Initial census population size.\n        T (int): Number of generations to simulate.\n        Next_val (float): Extinction threshold for population size.\n        Ne_min (float): Minimum effective population size.\n        F0 (float): Initial inbreeding coefficient.\n\n    Returns:\n        bool: True if the population goes extinct within T generations,\n              False otherwise.\n    \"\"\"\n    N = float(N0)\n    F = float(F0)\n\n    for _ in range(T):\n        # 1. Check for extinction at the beginning of the generation.\n        if N = Next_val:\n            return True\n\n        # 2. Calculate effective population size for the current generation.\n        Ne = max(alpha * N, Ne_min)\n\n        # 3. Calculate N and F for the next generation.\n        # The update for N_{t+1} depends on the state at time t (N_t, F_t).\n        N_next = N * np.exp(r * (1.0 - N / K)) * np.exp(-B * F) * (N / (N + A))\n        \n        # The update for F_{t+1} depends on F_t and N_{e,t} (which depends on N_t).\n        F_next = F + (1.0 - F) / (2.0 * Ne)\n\n        # 4. Update state variables.\n        N = N_next\n        F = F_next\n\n    # 5. Final check for extinction after T full generations.\n    if N = Next_val:\n        return True\n\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Test suite: (r, K, A, alpha, B, N0_low, N0_high, T)\n    test_cases = [\n        (1.0, 1000.0, 0.0, 0.7, 0.5, 5.0, 500.0, 300),\n        (1.0, 1000.0, 100.0, 0.2, 0.9, 10.0, 600.0, 500),\n        (1.0, 1000.0, 0.0, 0.5, 1.4, 100.0, 600.0, 300),\n        (1.0, 1000.0, 0.0, 0.5, 0.98, 1.0, 400.0, 500),\n    ]\n\n    # Model constants as defined in the problem\n    Next_val = 1e-3\n    Ne_min = 1.0\n    F0 = 0.0\n\n    results = []\n    for params in test_cases:\n        r, K, A, alpha, B, N0_low, N0_high, T = params\n        \n        # Run simulation for the low initial population size\n        extinct_low = run_simulation(r, K, A, alpha, B, N0_low, int(T), Next_val, Ne_min, F0)\n        \n        # Run simulation for the high initial population size\n        extinct_high = run_simulation(r, K, A, alpha, B, N0_high, int(T), Next_val, Ne_min, F0)\n        \n        # Classify the outcome based on the two trajectories\n        if extinct_low and extinct_high:\n            # Both trajectories go to extinction\n            classification = 0\n        elif not extinct_low and not extinct_high:\n            # Both trajectories persist\n            classification = 1\n        else:\n            # One persists, one goes extinct (bistability)\n            classification = 2\n            \n        results.append(classification)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver.\nsolve()\n```", "id": "2494475"}]}