{"hands_on_practices": [{"introduction": "生物入侵的成功与否，不仅仅取决于环境的适宜性，还取决于初始种群密度。此练习探讨了强阿利效应（strong Allee effect）下的种群动态，帮助学生理解为何低密度种群可能无法存活。通过分析一个包含阿利阈值的常微分方程模型 ([@problem_id:2473492])，本练习旨在训练识别关键平衡点及其稳定性的能力，并揭示入侵成功所需的最小初始种群密度。", "problem": "一个非本地生物被引入到一个新的栖息地，在那里，低密度下的寻找配偶和合作行为产生了强烈的阿利效应。设种群密度由以下常微分方程（ODE）建模：\n$$\n\\dot{N} \\equiv \\frac{dN}{dt} = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right),\n$$\n其中参数满足 $r0$，$KA0$，$r$ 是内禀增长率，$K$ 是环境承载力，$A$ 是阿利阈值密度。假设对所有 $t\\ge 0$ 都有 $N(t)\\ge 0$ 且 $N(0)=N_{0}$。\n\n仅使用常微分方程平衡点的基本定义（$\\dot{N}=0$）以及由右侧函数对 $N$ 在各平衡点的导数符号决定的局部稳定性，完成以下任务：\n\n- 找出所有平衡点，并通过在每个平衡点附近对常微分方程进行线性化来确定它们的局部稳定性。\n- 从第一性原理出发，推导出区分种群走向灭绝与成功建立并收敛至承载力的轨迹的入侵准则。\n- 以包含模型参数 $r$、$K$ 和 $A$ 的单个闭式表达式，报告保证种群建立而非灭绝的最小初始密度 $N_{\\mathrm{crit}}$。\n\n最终的 $N_{\\mathrm{crit}}$ 以个体/公顷为单位表示。不需要进行数值计算，最终报告的表达式中不应出现不等式。", "solution": "该问题要求分析一个具有强阿利效应的、描述种群密度 $N(t)$ 的常微分方程（ODE）。该模型由以下公式给出：\n$$\n\\frac{dN}{dt} = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)\n$$\n其中，对于所有 $t \\ge 0$，$N(t) \\ge 0$，参数满足 $r0$ 和 $KA0$。\n\n首先，我们必须验证问题陈述的有效性。\n**第一步：提取已知条件**\n-   控制方程为 $\\frac{dN}{dt} = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)$。\n-   参数为内禀增长率 $r0$、环境承载力 $K$ 和阿利阈值 $A$。它们受限于 $KA0$。\n-   初始条件为 $N(0)=N_0$，且种群密度为非负值，$N(t) \\ge 0$。\n-   任务是找出所有平衡点，通过线性化确定其局部稳定性，推导种群建立的准则，并找出实现该建立的最小初始密度 $N_{\\mathrm{crit}}$。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学依据：** 该模型是描述受强阿利效应影响的种群动态的标准且成熟的表示方法，它将逻辑斯谛增长与一个阈值项相结合。这是理论生态学中的一个基本模型。该问题在科学上是合理的。\n-   **适定性：** 该问题是一个适定的一阶自治常微分方程初值问题。方程右侧是一个多项式，保证了解的存在性和唯一性。问题表述明确，旨在寻求一个可以通过数学推导得出的结果。\n-   **客观性与完备性：** 问题以精确的数学术语陈述，没有主观性。所有必要的参数和约束（$r, K, A$ 以及 $KA0$）均已提供，足以进行所需的分析。提及“个体/公顷”仅仅是指定密度变量 $N$ 及其相关参数 $A$ 和 $K$ 的物理单位，这是前后一致的，并未引入任何缺陷。\n\n**第三步：结论与行动**\n该问题是有效的。这是一个关于一维动力系统稳定性分析的标准练习。我们继续进行求解。\n\n设常微分方程的右侧为 $f(N)$：\n$$\nf(N) = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)\n$$\n根据问题的指示，我们必须首先确定平衡点，然后确定它们的稳定性。\n\n**平衡点的确定**\n平衡点，记作 $N^*$，是使种群密度变化率为零的 $N$ 值。这由条件 $\\frac{dN}{dt} = f(N^*) = 0$ 定义：\n$$\nr\\,N^*\\left(1-\\frac{N^*}{K}\\right)\\left(\\frac{N^*}{A}-1\\right) = 0\n$$\n由于 $r  0$，解可以通过将每个包含 $N^*$ 的因子设为零来找到：\n$1$. $N^* = 0$\n$2$. $1 - \\frac{N^*}{K} = 0 \\implies N^* = K$\n$3$. $\\frac{N^*}{A} - 1 = 0 \\implies N^* = A$\n因此，该系统有三个平衡点：$N_1^* = 0$，$N_2^* = A$ 和 $N_3^* = K$。\n\n**通过线性化进行稳定性分析**\n为了确定每个平衡点的局部稳定性，我们必须计算 $f(N)$ 对 $N$ 的导数，这是一维系统的雅可比矩阵。\n$$\nf(N) = \\frac{r}{AK}N(K-N)(N-A) = \\frac{r}{AK}(-N^3 + (A+K)N^2 - AKN)\n$$\n导数 $f'(N) = \\frac{df}{dN}$ 为：\n$$\nf'(N) = \\frac{r}{AK}(-3N^2 + 2(A+K)N - AK)\n$$\n平衡点 $N^*$ 的稳定性由 $f'(N^*)$ 的符号决定：\n-   如果 $f'(N^*)  0$，该平衡点是局部稳定的。\n-   如果 $f'(N^*) > 0$，该平衡点是局部不稳定的。\n\n我们在三个平衡点处分别计算 $f'(N^*)$ 的值。\n\n$1$. **平衡点 $N_1^* = 0$：**\n$$\nf'(0) = \\frac{r}{AK}(-3(0)^2 + 2(A+K)(0) - AK) = \\frac{r}{AK}(-AK) = -r\n$$\n由于 $r > 0$，我们有 $f'(0)  0$。因此，平衡点 $N^* = 0$ 是**稳定的**。这代表种群灭绝。\n\n$2$. **平衡点 $N_2^* = A$：**\n$$\nf'(A) = \\frac{r}{AK}(-3A^2 + 2(A+K)A - AK) = \\frac{r}{AK}(-3A^2 + 2A^2 + 2AK - AK)\n$$\n$$\nf'(A) = \\frac{r}{AK}(-A^2 + AK) = \\frac{r}{AK}A(K-A) = \\frac{r}{K}(K-A)\n$$\n给定约束条件 $K > A > 0$ 和 $r>0$，项 $(K-A)$ 是正的。因此，$f'(A) > 0$。平衡点 $N^* = A$ 是**不稳定的**。这就是阿利阈值。\n\n$3$. **平衡点 $N_3^* = K$：**\n$$\nf'(K) = \\frac{r}{AK}(-3K^2 + 2(A+K)K - AK) = \\frac{r}{AK}(-3K^2 + 2K^2 + 2AK - AK)\n$$\n$$\nf'(K) = \\frac{r}{AK}(-K^2 + AK) = \\frac{r}{AK}K(A-K) = \\frac{r}{A}(A-K)\n$$\n给定 $K > A > 0$ 和 $r>0$，项 $(A-K)$ 是负的。因此，$f'(K)  0$。平衡点 $N^* = K$ 是**稳定的**。这代表种群在环境承载力处成功建立。\n\n**入侵准则与临界密度 $N_{\\mathrm{crit}}$**\n稳定性分析揭示了相线 $N \\ge 0$ 上的动力学行为。该系统有两个稳定平衡点，分别位于 $N=0$（灭绝）和 $N=K$（建立），它们被位于 $N=A$ 的一个不稳定平衡点分开。这个不稳定平衡点作为一个分界线，将状态空间划分为两个吸引盆。\n-   对于初始种群密度 $N_0$ 满足 $0 \\le N_0  A$ 的情况，种群轨迹将收敛到位于 $N=0$ 的稳定平衡点。这导致种群灭绝。\n-   对于初始种群密度 $N_0$ 满足 $N_0 > A$ 的情况，种群轨迹将收敛到位于 $N=K$ 的稳定平衡点。这构成了种群的成功建立。\n-   如果 $N_0 = A$，种群将保持在不稳定的平衡点上，但任何无穷小的扰动都会将其推向 $0$ 或 $K$。\n\n问题要求保证种群建立的最小初始密度 $N_{\\mathrm{crit}}$。“建立”被定义为收敛到环境承载力 $K$。这种情况当且仅当初始密度 $N_0$ 大于阿利阈值 $A$ 时发生。阈值本身是必须越过的边界。因此，临界密度就是不稳定平衡点的值。\n$$\nN_{\\mathrm{crit}} = A\n$$\n这是最小密度阈值；任何超过此值的初始种群密度都将导致成功建立。该表达式按要求以模型参数的形式给出。", "answer": "$$\n\\boxed{A}\n$$", "id": "2473492"}, {"introduction": "入侵物种成功立足后，其空间扩散速度成为生态管理和风险评估的核心问题。本练习基于经典的反应-扩散（reaction-diffusion）理论，将局部种群增长与个体的随机扩散过程相结合，以模拟入侵锋面的推进。通过求解该模型 ([@problem_id:2473520])，学习者可以掌握如何从物种的内在增长率 $r$ 和扩散系数 $D$ 出发，计算出入侵波的渐近传播速度，从而定量预测物种的扩散范围。", "problem": "一个入侵物种在一维、同质的景观中扩散，其中个体通过无偏随机运动进行移动，种群呈逻辑斯谛增长。假设扩散可以很好地用菲克扩散近似，且低密度下的种群增长是指数级的。考虑经典的入侵反应扩散框架，其中种群密度 $n(x,t)$ 因扩散系数为 $D$ 的扩散和低密度下的局部人均增长率 $r$ 而变化。忽略阿利效应和任何环境异质性。该物种从一个局部引入点开始，在未占据的空间中建立一个单一的前进锋。给定 $r = 0.3\\ \\mathrm{year}^{-1}$ 和 $D = 10\\ \\mathrm{km}^{2}\\ \\mathrm{year}^{-1}$，计算预期的渐进入侵波速以及入侵锋沿单一阵线前进 $500$ $\\mathrm{km}$ 所需的时间。将波速以 $\\mathrm{km}\\ \\mathrm{year}^{-1}$ 为单位表示，时间以 $\\mathrm{years}$ 为单位表示。将两个数值结果四舍五入至四位有效数字。", "solution": "经典的入侵框架是关于种群密度 $n(x,t)$ 的 Fisher–Kolmogorov–Petrovsky–Piskunov (Fisher–KPP) 反应扩散方程，\n$$\n\\frac{\\partial n}{\\partial t} = D\\,\\frac{\\partial^{2} n}{\\partial x^{2}} + f(n),\n$$\n其中 $D$ 是扩散系数，$f(n)$ 是局部增长项。对于逻辑斯谛增长，$f(n) = r n \\left(1 - \\frac{n}{K}\\right)$，其中环境承载力为 $K$。入侵波的渐进速度由前沿的动力学决定，此处 $n \\ll K$。在这个低密度区域，密度依赖性可以忽略不计，增长项线性化为\n$$\nf(n) \\approx r n.\n$$\n因此，前沿的线性化方程为\n$$\n\\frac{\\partial n}{\\partial t} = D\\,\\frac{\\partial^{2} n}{\\partial x^{2}} + r n.\n$$\n为了确定行波的存在性和速度，考虑能够捕捉前沿行为的标准指数拟设：\n$$\nn(x,t) \\sim \\exp\\!\\big(\\lambda (x - c t)\\big),\n$$\n其中波速为 $c$，空间衰减率为 $\\lambda$。代入线性化方程得到\n$$\n\\frac{\\partial n}{\\partial t} = -c \\lambda \\exp\\!\\big(\\lambda (x - c t)\\big), \\quad\n\\frac{\\partial^{2} n}{\\partial x^{2}} = \\lambda^{2} \\exp\\!\\big(\\lambda (x - c t)\\big).\n$$\n因此\n$$\n-c \\lambda \\exp\\!\\big(\\lambda (x - c t)\\big) = D \\lambda^{2} \\exp\\!\\big(\\lambda (x - c t)\\big) + r \\exp\\!\\big(\\lambda (x - c t)\\big),\n$$\n两边除以公共指数因子，得到色散关系\n$$\nD \\lambda^{2} + c \\lambda + r = 0.\n$$\n对于一个有物理意义的入侵锋，我们需要一个在锋前呈空间衰减的解，这对应于 $\\lambda  0$。这个关于 $\\lambda$ 的二次方程有实数根的充要条件是其判别式非负：\n$$\nc^{2} - 4 D r \\ge 0.\n$$\n这意味着允许的波速满足 $c \\ge 2 \\sqrt{D r}$，而由局部初始条件选择的渐进最小波速为\n$$\nc^{\\ast} = 2 \\sqrt{D r}.\n$$\n使用给定参数 $D = 10\\ \\mathrm{km}^{2}\\ \\mathrm{year}^{-1}$ 和 $r = 0.3\\ \\mathrm{year}^{-1}$，预期的波速为\n$$\nc^{\\ast} = 2 \\sqrt{(10\\ \\mathrm{km}^{2}\\ \\mathrm{year}^{-1})(0.3\\ \\mathrm{year}^{-1})}\n= 2 \\sqrt{3}\\ \\mathrm{km}\\ \\mathrm{year}^{-1}.\n$$\n数值上，\n$$\nc^{\\ast} = 2 \\sqrt{3} \\approx 3.464101615\\ \\mathrm{km}\\ \\mathrm{year}^{-1}.\n$$\n四舍五入到四位有效数字，波速为 $3.464\\ \\mathrm{km}\\ \\mathrm{year}^{-1}$。\n\n对于单一前进锋，到达距离 $L$ 处所需的时间 $T$ 可以用波前到达时间来近似：\n$$\nT = \\frac{L}{c^{\\ast}}.\n$$\n使用 $L = 500\\ \\mathrm{km}$ 和 $c^{\\ast} = 2 \\sqrt{3}\\ \\mathrm{km}\\ \\mathrm{year}^{-1}$，\n$$\nT = \\frac{500\\ \\mathrm{km}}{2 \\sqrt{3}\\ \\mathrm{km}\\ \\mathrm{year}^{-1}} = \\frac{500}{2 \\sqrt{3}}\\ \\mathrm{years}\n= \\frac{250}{\\sqrt{3}}\\ \\mathrm{years}.\n$$\n数值上，\n$$\nT \\approx \\frac{500}{3.464101615} \\approx 144.337567\\ \\mathrm{years}.\n$$\n四舍五入到四位有效数字，定殖时间为 $144.3\\ \\mathrm{years}$。\n\n因此，当四舍五入到四位有效数字时，预期的渐进波速和从单一锋面前进 $500\\ \\mathrm{km}$ 所需的时间分别为 $3.464\\ \\mathrm{km}\\ \\mathrm{year}^{-1}$ 和 $144.3\\ \\mathrm{years}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 3.464  144.3 \\end{pmatrix}}\n$$", "id": "2473520"}, {"introduction": "本练习将重点从入侵动态转向生态影响，这是入侵生物学的一个关键组成部分。入侵物种可以通过引入新的性状（例如，不同的凋落物质量）来彻底改变生态系统的功能，如分解和养分循环。这项实践提供了构建和分析定量生态系统模型的实践经验，将入侵者的性状与氮矿化和土壤碳储存的实际变化联系起来 ([@problem_id:2473478])，从而培养利用模型来预测和评估入侵后果的能力。", "problem": "植物入侵改变了碎屑的输入和质量。考虑成对的入侵和未入侵样地，您已测量了这些样地的凋落物碳氮比、分解速率和凋落物碳输入。假设适用以下基本原则：(i) 凋落物质量损失遵循一级动力学，意味着瞬时碳损失速率与当前的凋落物碳库成正比；(ii) 给定时间的净氮矿化量等于分解的凋落物碳释放的氮减去支持微生物生长所需的氮，其中微生物生长由恒定的碳利用效率（CUE）和恒定的微生物生物量碳氮比控制；(iii) 微生物生长碳的一个恒定比例成为稳定的土壤有机碳（SOC），并以一级动力学衰减。假设在预测时间范围内，空间条件均匀且参数保持平稳。\n\n您的程序将使用的定义和符号：\n- 凋落物碳输入速率 $I_C$，单位为 $\\mathrm{g\\ C\\ m^{-2}\\ yr^{-1}}$。\n- 凋落物碳库 $C_L(t)$，单位为 $\\mathrm{g\\ C\\ m^{-2}}$。\n- 土壤有机碳（SOC）库 $C_S(t)$，单位为 $\\mathrm{g\\ C\\ m^{-2}}$。\n- 凋落物分解速率常数 $k_L$，单位为 $\\mathrm{yr^{-1}}$。\n- 土壤有机碳衰减速率常数 $k_S$，单位为 $\\mathrm{yr^{-1}}$。\n- 凋落物碳氮比 $\\mathrm{CN_L}$，单位为 $\\mathrm{g\\ C\\ g^{-1}\\ N}$。\n- 微生物生物量碳氮比 $\\mathrm{CN_{mic}}$，单位为 $\\mathrm{g\\ C\\ g^{-1}\\ N}$。\n- 碳利用效率（CUE） $e$（无量纲），指被微生物生物量吸收的已分解碳的比例。\n- 稳定化比例 $s$（无量纲），指成为稳定土壤有机碳的微生物生长碳的比例。\n- 时间范围 $T$，单位为 $\\mathrm{yr}$。\n\n需实现的原理：\n- 具有恒定输入的一级凋落物碳动态：凋落物碳库在恒定的 $I_C$ 和 $k_L$ 下，从初始条件 $C_L(0)$ 开始演变。\n- 时间 $t$ 的净氮矿化通量等于从分解凋落物中释放的氮与微生物生长所需的氮之差，给定 $e$ 和 $\\mathrm{CN_{mic}}$。\n- 土壤有机碳由微生物生长碳的一个比例 $s$ 累积而来，并以速率 $k_S$ 衰减。\n- 初始条件代表 $t=0$ 时未入侵系统的入侵前稳态：设置 $C_L(0) = I_C^{\\mathrm{uninv}}/k_L^{\\mathrm{uninv}}$ 和 $C_S(0) = s\\, e\\, I_C^{\\mathrm{uninv}}/k_S$。\n\n对于每个测试用例，您的程序必须执行以下操作：\n1. 根据上述原理，计算入侵样地和未入侵样地在 $[0,T]$ 范围内的累积净氮矿化量，然后报告其差值 $\\Delta M_N = M_N^{\\mathrm{inv}} - M_N^{\\mathrm{uninv}}$，单位为 $\\mathrm{g\\ N\\ m^{-2}}$。\n2. 根据上述原理，计算入侵样地和未入侵样地的土壤有机碳库 $C_S(T)$，然后报告其差值 $\\Delta C_S(T) = C_S^{\\mathrm{inv}}(T) - C_S^{\\mathrm{uninv}}(T)$，单位为 $\\mathrm{g\\ C\\ m^{-2}}$。\n3. 将每个测试用例的输出表示为一个包含两个浮点数的列表 $[\\Delta M_N,\\ \\Delta C_S(T)]$。将所有测试用例的结果聚合到一个列表中。\n\n不涉及角度单位。如果需要，百分比必须表示为小数。\n\n测试套件。每个测试用-例为未入侵和入侵样地提供参数、微生物和稳定化参数以及时间范围 $T$。使用上述初始条件定义。参数值如下：\n- 测试用例 $1$（固氮入侵植物；更高的输入和更快的分解）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 400$, $k_L^{\\mathrm{uninv}} = 0.6$, $\\mathrm{CN_L}^{\\mathrm{uninv}} = 60$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 520$, $k_L^{\\mathrm{inv}} = 0.9$, $\\mathrm{CN_L}^{\\mathrm{inv}} = 25$。\n  - 共享：$e = 0.4$, $\\mathrm{CN_{mic}} = 8$, $s = 0.25$, $k_S = 0.03$, $T = 10$。\n- 测试用例 $2$（木本入侵植物；较慢的分解和更高的 $\\mathrm{CN_L}$）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 350$, $k_L^{\\mathrm{uninv}} = 0.5$, $\\mathrm{CN_L}^{\\mathrm{uninv}} = 50$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 360$, $k_L^{\\mathrm{inv}} = 0.4$, $\\mathrm{CN_L}^{\\mathrm{inv}} = 120$。\n  - 共享：$e = 0.45$, $\\mathrm{CN_{mic}} = 9$, $s = 0.2$, $k_S = 0.02$, $T = 20$。\n- 测试用例 $3$（边界条件，$k_L^{\\mathrm{inv}} = k_S$，用于测试退化的SOC强迫输入）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 300$, $k_L^{\\mathrm{uninv}} = 0.3$, $\\mathrm{CN_L}^{\\mathrm{uninv}} = 55$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 300$, $k_L^{\\mathrm{inv}} = 0.02$, $\\mathrm{CN_L}^{\\mathrm{inv}} = 40$。\n  - 共享：$e = 0.35$, $\\mathrm{CN_{mic}} = 7$, $s = 0.2$, $k_S = 0.02$, $T = 5$。\n- 测试用例 $4$（阈值 $\\mathrm{CN_L}^{\\mathrm{inv}}$，当 $e/\\mathrm{CN_{mic}} = 1/\\mathrm{CN_L}^{\\mathrm{inv}}$ 时，任何时间的净矿化量均为零）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 450$, $k_L^{\\mathrm{uninv}} = 0.7$, $\\mathrm{CN_L}^{\\mathrm{uninv}} = 30$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 450$, $k_L^{\\mathrm{inv}} = 0.7$, $\\mathrm{CN_L}^{\\mathrm{inv}} = 20$。\n  - 共享：$e = 0.4$, $\\mathrm{CN_{mic}} = 8$, $s = 0.3$, $k_S = 0.04$, $T = 15$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，包含一个由各测试用例结果组成的列表，其中每个测试用例的结果是一个包含两个元素的列表 $[\\Delta M_N,\\ \\Delta C_S(T)]$。数字必须是浮点数。整体结构必须是打印在单行上的单个列表，例如 $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$，不得有额外文本。$\\Delta M_N$ 和 $\\Delta C_S(T)$ 都必须使用其指定单位：$\\Delta M_N$ 在 $[0,T]$ 上的单位是 $\\mathrm{g\\ N\\ m^{-2}}$，$\\Delta C_S(T)$ 在时间 $T$ 的单位是 $\\mathrm{g\\ C\\ m^{-2}}$。", "solution": "该问题具有科学依据，提法明確，且所有必要的参数和初始条件均已提供。因此，该问题是有效的。解决方案通过对控制性常微分方程（ODEs）进行解析积分来推进。\n\n凋落物碳库 $C_L(t)$ 和土壤有机碳（SOC）库 $C_S(t)$ 的动态由一个一阶线性常微分方程组描述。\n\n凋落物碳库的常微分方程是：\n$$\n\\frac{dC_L(t)}{dt} = I_C - k_L C_L(t)\n$$\n其中 $I_C$是恒定的凋落物碳输入速率，$k_L$ 是一阶分解速率常数。对于未入侵和入侵情景，初始条件都是未入侵生态系统的稳态凋落物碳库，由 $\\frac{dC_L}{dt} = 0$ 给出：\n$$\nC_L(0) = \\frac{I_C^{\\mathrm{uninv}}}{k_L^{\\mathrm{uninv}}}\n$$\n此常微分方程的通解为：\n$$\nC_L(t) = \\left( C_L(0) - \\frac{I_C}{k_L} \\right) e^{-k_L t} + \\frac{I_C}{k_L}\n$$\n对于未入侵样地，参数是恒定的，系统保持在稳态，因此 $C_L^{\\mathrm{uninv}}(t) = C_L(0)$。对于入侵样地，参数在 $t=0$ 时切换为 $I_C^{\\mathrm{inv}}$ 和 $k_L^{\\mathrm{inv}}$，并且 $C_L^{\\mathrm{inv}}(t)$ 遵循上述使用这些新参数和指定初始条件的瞬态解。\n\n瞬时净氮矿化速率 $m_N(t)$ 是从分解凋落物中释放的氮与微生物同化的氮之差：\n$$\nm_N(t) = \\frac{k_L C_L(t)}{\\mathrm{CN_L}} - \\frac{e \\cdot k_L C_L(t)}{\\mathrm{CN_{mic}}} = k_L C_L(t) \\left( \\frac{1}{\\mathrm{CN_L}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right)\n$$\n在时间范围 $[0, T]$ 内的累积净矿化量为 $M_N = \\int_0^T m_N(t) dt$。对于未入侵样地，由于 $C_L^{\\mathrm{uninv}}(t)$ 是恒定的，这简化为：\n$$\nM_N^{\\mathrm{uninv}} = I_C^{\\mathrm{uninv}} \\left( \\frac{1}{\\mathrm{CN_L}^{\\mathrm{uninv}}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right) T\n$$\n对于入侵样地，我们必须对 $m_N^{\\mathrm{inv}}(t)$ 的完整表达式进行积分：\n$$\nM_N^{\\mathrm{inv}} = \\left( \\frac{1}{\\mathrm{CN_L}^{\\mathrm{inv}}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right) k_L^{\\mathrm{inv}} \\int_0^T C_L^{\\mathrm{inv}}(t) dt\n$$\n求解该积分得到：\n$$\nM_N^{\\mathrm{inv}} = \\left( \\frac{1}{\\mathrm{CN_L}^{\\mathrm{inv}}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right) \\left[ \\left( \\frac{I_C^{\\mathrm{uninv}}}{k_L^{\\mathrm{uninv}}} - \\frac{I_C^{\\mathrm{inv}}}{k_L^{\\mathrm{inv}}} \\right) (1 - e^{-k_L^{\\mathrm{inv}} T}) + I_C^{\\mathrm{inv}} T \\right]\n$$\n要求的输出是差值 $\\Delta M_N = M_N^{\\mathrm{inv}} - M_N^{\\mathrm{uninv}}$。\n\n土壤有机碳库的常微分方程是：\n$$\n\\frac{dC_S(t)}{dt} = s \\cdot e \\cdot k_L C_L(t) - k_S C_S(t)\n$$\n其中 $s$ 是稳定化比例，$e$ 是碳利用效率，$k_S$ 是土壤有机碳衰减速率常数。初始条件是未入侵系统的稳态土壤有机碳：\n$$\nC_S(0) = \\frac{s e I_C^{\\mathrm{uninv}}}{k_S}\n$$\n这是一个带有时变强迫项的线性一阶常微分方程。解可以使用积分因子 $e^{k_S t}$ 求得。\n对于未入侵样地，系统处于稳态，因此对所有 $t$ 都有 $C_S^{\\mathrm{uninv}}(t) = C_S(0)$。因此，$C_S^{\\mathrm{uninv}}(T) = C_S(0)$。\n对于入侵样地，我们必须求解瞬态方程。解取决于 $k_L^{\\mathrm{inv}}$ 是否等于 $k_S$。\n\n情况 1：$k_L^{\\mathrm{inv}} \\neq k_S$（非共振情况）。$C_S^{\\mathrm{inv}}(t)$ 的解是：\n$$\nC_S^{\\mathrm{inv}}(t) = \\frac{s e k_L^{\\mathrm{inv}}}{k_S - k_L^{\\mathrm{inv}}} \\left( C_L(0) - \\frac{I_C^{\\mathrm{inv}}}{k_L^{\\mathrm{inv}}} \\right) (e^{-k_L^{\\mathrm{inv}} t} - e^{-k_S t}) + \\frac{s e I_C^{\\mathrm{inv}}}{k_S} (1 - e^{-k_S t}) + C_S(0) e^{-k_S t}\n$$\n情况 2：$k_L^{\\mathrm{inv}} = k_S$（共振情况）。$C_S^{\\mathrm{inv}}(t)$ 的解是：\n$$\nC_S^{\\mathrm{inv}}(t) = s e k_L^{\\mathrm{inv}} \\left( C_L(0) - \\frac{I_C^{\\mathrm{inv}}}{k_L^{\\mathrm{inv}}} \\right) t e^{-k_L^{\\mathrm{inv}} t} + \\frac{s e I_C^{\\mathrm{inv}}}{k_S} (1 - e^{-k_S t}) + C_S(0) e^{-k_S t}\n$$\n在这两种情况下，我们在 $t=T$ 时评估 $C_S^{\\mathrm{inv}}(t)$ 并计算差值 $\\Delta C_S(T) = C_S^{\\mathrm{inv}}(T) - C_S^{\\mathrm{uninv}}(T)$。\n\n程序将实现这些推导出的解析解，为每个测试用例计算 $[\\Delta M_N, \\Delta C_S(T)]$。", "answer": "```python\nimport numpy as np\n\ndef calculate_dynamics_change(params_uninv, params_inv, params_shared):\n    \"\"\"\n    Calculates the change in cumulative N mineralization and final SOC pool\n    due to a plant invasion, based on an analytical model solution.\n\n    Args:\n        params_uninv (tuple): Parameters for the uninvaded plot (I_C, k_L, CN_L).\n        params_inv (tuple): Parameters for the invaded plot (I_C, k_L, CN_L).\n        params_shared (tuple): Shared parameters (e, CN_mic, s, k_S, T).\n\n    Returns:\n        list: A list containing two floats [delta_M_N, delta_C_S_T].\n    \"\"\"\n    I_C_uninv, k_L_uninv, CN_L_uninv = params_uninv\n    I_C_inv, k_L_inv, CN_L_inv = params_inv\n    e, CN_mic, s, k_S, T = params_shared\n\n    # --- Part 1: Calculate change in cumulative Net N Mineralization (Delta M_N) ---\n\n    # For the uninvaded plot, the system is at steady state.\n    # Instantaneous N mineralization rate is constant: m_N = I_C * (1/CN_L - e/CN_mic)\n    f_N_uninv = (1.0 / CN_L_uninv) - (e / CN_mic)\n    M_N_uninv = I_C_uninv * f_N_uninv * T\n\n    # For the invaded plot, the system is in a transient state.\n    # Initial litter C pool is from the uninvaded steady state.\n    C_L0 = I_C_uninv / k_L_uninv\n    f_N_inv = (1.0 / CN_L_inv) - (e / CN_mic)\n\n    # Cumulative N mineralization is F_N * integral(k_L * C_L(t) dt)\n    # The integral of k_L * C_L(t) is equivalent to total C input minus change in C pool\n    # The more direct formula derived in the solution is used here.\n    term_C_L_transient = (C_L0 - I_C_inv / k_L_inv) * (1.0 - np.exp(-k_L_inv * T))\n    M_N_inv = f_N_inv * (term_C_L_transient + I_C_inv * T)\n    \n    delta_M_N = M_N_inv - M_N_uninv\n\n    # --- Part 2: Calculate change in SOC pool at time T (Delta C_S(T)) ---\n\n    # Initial SOC pool is from the uninvaded steady state.\n    C_S0 = s * e * I_C_uninv / k_S\n    C_S_uninv_T = C_S0  # Uninvaded SOC pool remains at steady state.\n\n    # For the invaded plot, we solve the transient ODE for C_S(t)\n    # and evaluate at t = T.\n    if abs(k_L_inv - k_S)  1e-12:  # Resonant case: k_L_inv is equal to k_S\n        term1 = s * e * k_L_inv * (C_L0 - I_C_inv / k_L_inv) * T * np.exp(-k_L_inv * T)\n        term2 = (s * e * I_C_inv / k_S) * (1.0 - np.exp(-k_S * T))\n        term3 = C_S0 * np.exp(-k_S * T)\n        C_S_inv_T = term1 + term2 + term3\n    else:  # Non-resonant case\n        term1_coeff = (s * e * k_L_inv) / (k_S - k_L_inv)\n        term1_dC_L = C_L0 - (I_C_inv / k_L_inv)\n        term1_exp = np.exp(-k_L_inv * T) - np.exp(-k_S * T)\n        term1 = term1_coeff * term1_dC_L * term1_exp\n        \n        term2 = (s * e * I_C_inv / k_S) * (1.0 - np.exp(-k_S * T))\n        term3 = C_S0 * np.exp(-k_S * T)\n        C_S_inv_T = term1 + term2 + term3\n\n    delta_C_S_T = C_S_inv_T - C_S_uninv_T\n\n    return [delta_M_N, delta_C_S_T]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"uninv\": (400, 0.6, 60),\n            \"inv\": (520, 0.9, 25),\n            \"shared\": (0.4, 8, 0.25, 0.03, 10),\n        },\n        # Test case 2\n        {\n            \"uninv\": (350, 0.5, 50),\n            \"inv\": (360, 0.4, 120),\n            \"shared\": (0.45, 9, 0.2, 0.02, 20),\n        },\n        # Test case 3\n        {\n            \"uninv\": (300, 0.3, 55),\n            \"inv\": (300, 0.02, 40),\n            \"shared\": (0.35, 7, 0.2, 0.02, 5),\n        },\n        # Test case 4\n        {\n            \"uninv\": (450, 0.7, 30),\n            \"inv\": (450, 0.7, 20),\n            \"shared\": (0.4, 8, 0.3, 0.04, 15),\n        },\n    ]\n\n    all_results_str = []\n    for case in test_cases:\n        result = calculate_dynamics_change(case[\"uninv\"], case[\"inv\"], case[\"shared\"])\n        # Format each number as a float string for the list\n        all_results_str.append(f\"[{result[0]},{result[1]}]\")\n\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "2473478"}]}