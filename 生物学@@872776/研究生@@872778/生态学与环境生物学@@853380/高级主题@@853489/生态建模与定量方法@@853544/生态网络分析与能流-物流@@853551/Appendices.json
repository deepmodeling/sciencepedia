{"hands_on_practices": [{"introduction": "生态网络分析的起点往往是经验数据。本练习将指导你如何将基础的实地观测数据——例如捕食者的胃容物计数——转化为定量的网络结构。通过应用最大似然估计这一强大的统计方法，你将学习从原始数据中构建食性矩阵，并进一步计算出生态系统中一个关键的度量指标：物种的营养级 [@problem_id:2483612]。这个过程完美地展示了如何从具体证据出发，构建和量化复杂的生态关系。", "problem": "给定一个生态网络中一组物种的胃容物计数数据。对于每个物种（行），计数矩阵中的条目表示在其胃容物中发现的猎物项目的观测频率，按猎物物种（列）划分。假设每个物种的胃容物观测值是关于猎物物种的独立同分布的分类抽样。在此假设下，每个物种的食性被建模为一个分类分布，其未知的概率向量等于食性矩阵 $D$ 的相应行，其中每当该物种的总计数为正时，该行非负且总和为 $1$。总计数为零的行被视为没有已识别的猎物，因此在 $D$ 中保留为全零行。\n\n任务 A：使用最大似然估计（MLE），通过分别最大化每一行的多项式似然，从提供的计数矩阵中估计食性矩阵 $D$，并满足非负性和行随机性约束。\n\n任务 B：根据定义——消费者的营养级是其猎物营养级的食性加权平均值加一，而基础物种（没有猎物的物种）的营养级等于一——为营养级向量 $\\tau$ 推导一个线性系统，并使用你估计的 $D$ 为每种情况求解 $\\tau$。\n\n说明和输出要求：\n- 对于每种情况，通过将总计数为正的每一行进行归一化，使其条目总和为 $1$，来构建 MLE 食性矩阵 $D$；如果行和为 $0$，则该行保留为全零。\n- 从 $D$ 计算 $\\tau$，作为上述定义所隐含的线性系统的唯一解。\n- 将每种情况下营养级向量 $\\tau$ 作为精确到 $6$ 位小数的浮点数返回。\n- 你的程序不得读取任何输入；它必须计算以下情况的结果，并打印一行包含列表的列表，其中每个内部列表对应一种情况的营养级。\n- 单行输出必须是有效的类 Python 列表字面量，例如 $[ [\\dots], [\\dots], [\\dots] ]$，其中浮点数四舍五入到 $6$ 位小数。\n\n测试套件（三个独立案例）：\n- 案例 $1$（$3$ 个物种）。计数矩阵 $C^{(1)}$，行由捕食者物种索引，列由猎物物种索引：\n  - 物种 $1$：$[\\,0,\\,0,\\,0\\,]$\n  - 物种 $2$：$[\\,30,\\,0,\\,10\\,]$\n  - 物种 $3$：$[\\,5,\\,20,\\,0\\,]$\n- 案例 $2$（$4$ 个物种）。计数矩阵 $C^{(2)}$：\n  - 物种 $1$：$[\\,0,\\,0,\\,0,\\,0\\,]$\n  - 物种 $2$：$[\\,0,\\,0,\\,0,\\,0\\,]$\n  - 物种 $3$：$[\\,50,\\,50,\\,0,\\,0\\,]$\n  - 物种 $4$：$[\\,25,\\,0,\\,75,\\,0\\,]$\n- 案例 $3$（$5$ 个物种）。计数矩阵 $C^{(3)}$：\n  - 物种 $1$：$[\\,0,\\,0,\\,0,\\,0,\\,0\\,]$\n  - 物种 $2$：$[\\,40,\\,0,\\,0,\\,0,\\,0\\,]$\n  - 物种 $3$：$[\\,10,\\,20,\\,0,\\,0,\\,0\\,]$\n  - 物种 $4$：$[\\,0,\\,10,\\,30,\\,0,\\,0\\,]$\n  - 物种 $5$：$[\\,0,\\,0,\\,10,\\,20,\\,0\\,]$\n\n答案规范：\n- 每种情况的答案是向量 $\\tau$，以浮点数列表的形式按给定的物种顺序排列。\n- 你的程序应生成一行输出，其中包含三个结果，格式为用方括号括起来的逗号分隔列表，每个结果都是一个浮点数列表（四舍五入到 $6$ 位小数），按案例 $1$、$2$ 和 $3$ 的顺序排列。例如：$[[\\tau^{(1)}_1,\\dots,\\tau^{(1)}_n],[\\tau^{(2)}_1,\\dots,\\tau^{(2)}_m],[\\tau^{(3)}_1,\\dots,\\tau^{(3)}_k]]$。", "solution": "所提出的问题是量化生态学中的一个标准练习，具体涉及根据经验数据分析食物网结构。它具有科学依据，问题陈述清晰，并包含唯一解所需的所有必要信息。因此，我将进行完整的推导和求解。\n\n问题分为两部分：首先，从计数矩阵 $C$ 估计食性矩阵 $D$；其次，根据估计的食性矩阵计算营养级 $\\tau$。\n\n### A 部分：食性矩阵的最大似然估计\n\n问题指出，对于每个捕食者物种 $i$，其猎物的计数（在计数矩阵 $C$ 的第 $i$ 行中给出）是从一个分类分布中抽取的样本。该分布的参数是未知的食性比例，它们构成了食性矩阵 $D$ 的第 $i$ 行。设物种数量为 $n$。对于捕食者物种 $i$，其在计数矩阵中的对应行为 $C_i = (C_{i1}, C_{i2}, \\dots, C_{in})$，其中 $C_{ij}$ 是在捕食者 $i$ 的胃中发现猎物 $j$ 的次数。捕食者 $i$ 的观测猎物总数为 $S_i = \\sum_{j=1}^{n} C_{ij}$。\n\n食性矩阵的对应行为 $D_i = (D_{i1}, D_{i2}, \\dots, D_{in})$，其中 $D_{ij}$ 是猎物 $j$ 在捕食者 $i$ 的食性中所占的比例。这些比例必须满足对所有 $j$ 都有 $D_{ij} \\ge 0$ 以及 $\\sum_{j=1}^{n} D_{ij} = 1$（除非 $S_i=0$，在这种情况下该行为全零）。\n\n对于 $S_i > 0$ 的捕食者 $i$，观测到计数 $C_i$ 的似然由多项式概率质量函数给出：\n$$ L(D_i | C_i) = \\frac{S_i!}{\\prod_{j=1}^{n} C_{ij}!} \\prod_{j=1}^{n} D_{ij}^{C_{ij}} $$\n为了找到食性向量 $D_i$ 的最大似然估计（MLE），我们在约束条件 $\\sum_{j=1}^{n} D_{ij} = 1$ 下，对该函数关于 $D_{i1}, \\dots, D_{in}$ 进行最大化。最大化对数似然更为方便：\n$$ \\ln L(D_i | C_i) = \\ln(S_i!) - \\sum_{j=1}^{n} \\ln(C_{ij}!) + \\sum_{j=1}^{n} C_{ij} \\ln D_{ij} $$\n使用拉格朗日乘数法来引入约束条件，我们发现每个比例 $D_{ij}$ 的 MLE 由观测频率给出：\n$$ \\hat{D}_{ij, \\text{MLE}} = \\frac{C_{ij}}{S_i} = \\frac{C_{ij}}{\\sum_{k=1}^{n} C_{ik}} $$\n对计数矩阵 $C$ 中行和 $S_i$ 为正的每一行 $i$ 执行此过程。如果 $S_i = 0$，则该物种没有观测到的猎物；它是一个基础物种，根据问题陈述，其在 $D$ 中的对应行为零向量。\n\n### B 部分：营养级的计算\n\n物种 $i$ 的营养级 $\\tau_i$ 定义为 $1$ 加上其猎物营养级的食性加权平均值。不捕食任何猎物的基础物种，其营养级定义为 $1$。这个定义可以转化为一个线性方程组。对于每个物种 $i=1, \\dots, n$：\n$$ \\tau_i = 1 + \\sum_{j=1}^{n} D_{ij} \\tau_j $$\n这里，$D_{ij}$ 是猎物 $j$ 在消费者 $i$ 食性中的比例。总和 $\\sum_{j=1}^{n} D_{ij} \\tau_j$ 代表物种 $i$ 所消耗猎物的平均营养级。\n\n我们可以将这个包含 $n$ 个方程、求解 $n$ 个未知营养级 $\\tau_1, \\dots, \\tau_n$ 的系统表示为矩阵形式。设 $\\tau$ 为营养级的列向量，$\\mathbf{1}$ 为长度为 $n$ 的全一列向量。该系统为：\n$$ \\tau = \\mathbf{1} + D \\tau $$\n其中 $D$ 是 $n \\times n$ 的食性矩阵。为了求解 $\\tau$，我们重排方程：\n$$ \\tau - D \\tau = \\mathbf{1} $$\n$$ (I - D) \\tau = \\mathbf{1} $$\n其中 $I$ 是 $n \\times n$ 的单位矩阵。\n\n这是一个形式为 $Ax=b$ 的标准线性系统，其中 $A = (I - D)$，$x = \\tau$，以及 $b = \\mathbf{1}$。当且仅当矩阵 $(I - D)$ 是可逆的（非奇异的）时，$\\tau$ 存在唯一解。对于食物网的食性矩阵，其谱半径 $\\rho(D)$ 通常小于 $1$，这是 $(I - D)$ 可逆的一个充分条件。解可以通过以下方式找到：\n$$ \\tau = (I - D)^{-1} \\mathbf{1} $$\n在实践中，直接求解线性系统 $(I - D) \\tau = \\mathbf{1}$ 比计算 $(I - D)$ 的逆矩阵在数值上更稳定。\n\n每个测试案例的步骤如下：\n1.  给定计数矩阵 $C$，通过对每个具有正和的行进行归一化来计算食性矩阵 $D$。\n2.  构建矩阵 $A = I - D$ 和向量 $b = \\mathbf{1}$。\n3.  求解线性系统 $A\\tau = b$ 以得到营养级向量 $\\tau$。\n\n现在将此过程应用于给定的三个案例。\n\n**案例 1：**\n$C^{(1)} = \\begin{pmatrix} 0  0  0 \\\\ 30  0  10 \\\\ 5  20  0 \\end{pmatrix}$。行和分别为 $0, 40, 25$。\n$D^{(1)} = \\begin{pmatrix} 0  0  0 \\\\ 0.75  0  0.25 \\\\ 0.2  0.8  0 \\end{pmatrix}$。\n$(I - D^{(1)}) = \\begin{pmatrix} 1  0  0 \\\\ -0.75  1  -0.25 \\\\ -0.2  -0.8  1 \\end{pmatrix}$。\n求解 $(I - D^{(1)}) \\tau^{(1)} = \\mathbf{1}$ 得到 $\\tau^{(1)} = (1.0, 2.5625, 3.25)^T$。\n\n**案例 2：**\n$C^{(2)} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  0  0  0 \\\\ 50  50  0  0 \\\\ 25  0  75  0 \\end{pmatrix}$。行和分别为 $0, 0, 100, 100$。\n$D^{(2)} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0.5  0.5  0  0 \\\\ 0.25  0  0.75  0 \\end{pmatrix}$。\n$(I - D^{(2)}) = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ -0.5  -0.5  1  0 \\\\ -0.25  0  -0.75  1 \\end{pmatrix}$。\n求解 $(I - D^{(2)}) \\tau^{(2)} = \\mathbf{1}$ 得到 $\\tau^{(2)} = (1.0, 1.0, 2.0, 2.75)^T$。\n\n**案例 3：**\n$C^{(3)} = \\begin{pmatrix} 0  0  0  0  0 \\\\ 40  0  0  0  0 \\\\ 10  20  0  0  0 \\\\ 0  10  30  0  0 \\\\ 0  0  10  20  0 \\end{pmatrix}$。行和分别为 $0, 40, 30, 40, 30$。\n$D^{(3)} = \\begin{pmatrix} 0  0  0  0  0 \\\\ 1  0  0  0  0 \\\\ 1/3  2/3  0  0  0 \\\\ 0  1/4  3/4  0  0 \\\\ 0  0  1/3  2/3  0 \\end{pmatrix}$。\n求解 $(I - D^{(3)}) \\tau^{(3)} = \\mathbf{1}$ 得到 $\\tau^{(3)} = (1, 2, 8/3, 3.5, 38/9)^T$，其小数形式约为 $(1.0, 2.0, 2.666667, 3.5, 4.222222)^T$。\n\n最终的代码系统地为所有案例实现了这一逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for trophic positions for three ecological network cases.\n    The method involves:\n    1. Estimating the diet matrix D from stomach count data C using Maximum Likelihood Estimation.\n    2. Setting up and solving the linear system for trophic positions tau based on the definition:\n       tau = 1 + D @ tau, which is rearranged to (I - D) @ tau = 1.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (3 species)\n        np.array([\n            [0, 0, 0],\n            [30, 0, 10],\n            [5, 20, 0]\n        ]),\n        # Case 2 (4 species)\n        np.array([\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n            [50, 50, 0, 0],\n            [25, 0, 75, 0]\n        ]),\n        # Case 3 (5 species)\n        np.array([\n            [0, 0, 0, 0, 0],\n            [40, 0, 0, 0, 0],\n            [10, 20, 0, 0, 0],\n            [0, 10, 30, 0, 0],\n            [0, 0, 10, 20, 0]\n        ])\n    ]\n\n    results = []\n    for C in test_cases:\n        # Part A: Estimate diet matrix D using MLE\n        # The MLE for categorical proportions is the observed frequency.\n        # This is equivalent to normalizing each row of the count matrix.\n\n        n_species = C.shape[0]\n        D = np.zeros_like(C, dtype=float)\n        \n        # Calculate row sums (total prey count for each predator)\n        row_sums = C.sum(axis=1)\n\n        # Identify rows with non-zero counts to avoid division by zero\n        non_zero_rows = row_sums > 0\n        \n        # Normalize only the rows with positive sums\n        # Using np.newaxis to ensure correct broadcasting for division\n        D[non_zero_rows] = C[non_zero_rows] / row_sums[non_zero_rows, np.newaxis]\n\n        # Part B: Calculate trophic positions tau\n        # The system of equations is given by tau = 1 + D @ tau.\n        # Rearranging gives (I - D) @ tau = 1.\n        \n        # Construct the identity matrix I\n        I = np.identity(n_species)\n        \n        # Define the matrix A for the linear system A @ x = b\n        A = I - D\n        \n        # Define the vector b\n        b = np.ones(n_species)\n        \n        # Solve the linear system for tau\n        tau = np.linalg.solve(A, b)\n        \n        results.append(tau)\n\n    # Format the results for the final print statement\n    # Each trophic position value must be a float rounded to exactly 6 decimal places.\n    formatted_results = []\n    for tau_vector in results:\n        # Format each float in the vector to have 6 decimal places\n        formatted_tau_str = [f\"{x:.6f}\" for x in tau_vector]\n        # Create the string representation of the list\n        formatted_results.append(f\"[{','.join(formatted_tau_str)}]\")\n    \n    # Final print statement in the exact required format.\n    # The output is a single line: a list of lists of floats.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2483612"}, {"introduction": "将生态系统概念模型转化为数学语言是生态网络分析的核心技能。本练习将引导你为一个假设的食物网构建一个区室模型，其中物质的流动由“供给方控制”的规则决定。你将学习如何根据质量守恒定律为每个区室（如生产者、食草动物）建立动态微分方程，并求解系统在稳定状态下的生物量 [@problem_id:2483637]。这不仅是理论上的练习，更是理解生态系统动态和预测其对变化响应的基础。", "problem": "需要为一个由五个区室构成的小型碳基食物网构建一个供给方控制的区室模型：初级生产者 $P$、植食者 $H$、肉食者 $C$、颗粒碎屑 $D$ 和微生物分解者 $M$。状态变量 $P$、$H$、$C$、$D$ 和 $M$ 代表生物量，单位为 $\\mathrm{g\\ C\\ m^{-2}}$。假设所有的营养转移和所有内部生理损失都是供给方控制的，并且相对于施体生物量是一阶的：从区室 $i$ 到区室 $j$ 的流具有形式 $a_{ij}\\,X_i$，其中 $a_{ij}$ 的单位为 $\\mathrm{y^{-1}}$，$X_i$ 是施体生物量。\n\n存在以下流动：\n- 外部输入：$I_P$ 因光合作用生物量合成而进入 $P$，以及 $I_D$ 作为外源碎屑输入而进入 $D$（两者单位均为 $\\mathrm{g\\ C\\ m^{-2}\\ y^{-1}}$）。\n- 生产者流出：$P \\to H$，速率常数为 $a_{PH}$；$P \\to D$，速率常数为 $a_{PD}$；呼吸作用 $P \\to$ 环境，速率常数为 $r_P$。\n- 植食者流出：$H \\to C$，速率常数为 $a_{HC}$；$H \\to D$，速率常数为 $a_{HD}$；呼吸作用 $H \\to$ 环境，速率常数为 $r_H$。\n- 肉食者流出：$C \\to D$，速率常数为 $a_{CD}$；呼吸作用 $C \\to$ 环境，速率常数为 $r_C$。\n- 碎屑流出：$D \\to M$，速率常数为 $a_{DM}$；非生物性输出 $D \\to$ 环境，速率常数为 $e_D$。\n- 微生物分解者流出：$M \\to D$，速率常数为 $a_{MD}$；呼吸作用 $M \\to$ 环境，速率常数为 $r_M$。\n\n利用质量守恒定律，为每个区室明确写出质量平衡常微分方程（ODE），用供给方控制的流和上述给定的参数来表示。然后，在稳态条件下（即 $\\mathrm{d}P/\\mathrm{d}t=\\mathrm{d}H/\\mathrm{d}t=\\mathrm{d}C/\\mathrm{d}t=\\mathrm{d}D/\\mathrm{d}t=\\mathrm{d}M/\\mathrm{d}t=0$），用参数解析求解稳态肉食者生物量 $C^{\\ast}$。最后，代入以下参数值\n- $I_P = 60\\ \\mathrm{g\\ C\\ m^{-2}\\ y^{-1}}$，$I_D = 10\\ \\mathrm{g\\ C\\ m^{-2}\\ y^{-1}}$，\n- $a_{PH} = 0.8\\ \\mathrm{y^{-1}}$，$a_{PD} = 0.4\\ \\mathrm{y^{-1}}$，$r_P = 0.3\\ \\mathrm{y^{-1}}$，\n- $a_{HC} = 0.6\\ \\mathrm{y^{-1}}$，$a_{HD} = 0.5\\ \\mathrm{y^{-1}}$，$r_H = 0.2\\ \\mathrm{y^{-1}}$，\n- $a_{CD} = 0.3\\ \\mathrm{y^{-1}}$，$r_C = 0.2\\ \\mathrm{y^{-1}}$，\n- $a_{DM} = 1.1\\ \\mathrm{y^{-1}}$，$e_D = 0.2\\ \\mathrm{y^{-1}}$，\n- $a_{MD} = 0.7\\ \\mathrm{y^{-1}}$，$r_M = 0.5\\ \\mathrm{y^{-1}}$，\n计算 $C^{\\ast}$ 的数值。最终数值答案以 $\\mathrm{g\\ C\\ m^{-2}}$ 为单位，并四舍五入到四位有效数字。", "solution": "该问题陈述已经过严格审查，并被确定为有效。它在科学上基于生态区室模型的原理，是良定的，并使用客观、精确的术语进行陈述。不存在逻辑矛盾、信息缺失或违反物理或数学原理的情况。因此，将提供一个解决方案。\n\n该问题要求为一个五区室生态模型推导一个常微分方程组（ODE），求出稳态肉食者生物量（$C^{\\ast}$）的解析解，并进行数值计算。该模型基于供给方控制的一阶动力学。\n\n首先，我们对每个区室应用质量守恒原理，即生物量的变化率等于所有流入量之和减去所有流出量之和。状态变量是初级生产者（$P$）、植食者（$H$）、肉食者（$C$）、颗粒碎屑（$D$）和微生物分解者（$M$）的生物量，单位均为 $\\mathrm{g\\ C\\ m^{-2}}$。\n\n初级生产者区室 $P$ 的质量平衡方程包括一个外部输入 $I_P$ 和因植食作用（$a_{PH}P$）、衰亡为碎屑（$a_{PD}P$）及呼吸作用（$r_P P$）造成的流出。\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}t} = I_P - a_{PH}P - a_{PD}P - r_P P = I_P - (a_{PH} + a_{PD} + r_P)P\n$$\n\n植食者区室 $H$ 的方程包括一个来自消耗生产者（$a_{PH}P$）的流入，以及因肉食作用（$a_{HC}H$）、排泄/死亡为碎屑（$a_{HD}H$）和呼吸作用（$r_H H$）造成的流出。\n$$\n\\frac{\\mathrm{d}H}{\\mathrm{d}t} = a_{PH}P - a_{HC}H - a_{HD}H - r_H H = a_{PH}P - (a_{HC} + a_{HD} + r_H)H\n$$\n\n肉食者区室 $C$ 的方程包括一个来自消耗植食者（$a_{HC}H$）的流入，以及因死亡为碎屑（$a_{CD}C$）和呼吸作用（$r_C C$）造成的流出。\n$$\n\\frac{\\mathrm{d}C}{\\mathrm{d}t} = a_{HC}H - a_{CD}C - r_C C = a_{HC}H - (a_{CD} + r_C)C\n$$\n\n碎屑区室 $D$ 的方程包括一个外部外源输入 $I_D$，以及来自生产者（$a_{PD}P$）、植食者（$a_{HD}H$）、肉食者（$a_{CD}C$）和微生物（$a_{MD}M$）的死亡/废物的流入。流出是由于微生物的消耗（$a_{DM}D$）和非生物性输出（$e_D D$）。\n$$\n\\frac{\\mathrm{d}D}{\\mathrm{d}t} = I_D + a_{PD}P + a_{HD}H + a_{CD}C + a_{MD}M - a_{DM}D - e_D D = I_D + a_{PD}P + a_{HD}H + a_{CD}C + a_{MD}M - (a_{DM} + e_D)D\n$$\n\n微生物分解者区室 $M$ 的方程包括一个来自消耗碎屑（$a_{DM}D$）的流入，以及因死亡为碎屑（$a_{MD}M$）和呼吸作用（$r_M M$）造成的流出。\n$$\n\\frac{\\mathrm{d}M}{\\mathrm{d}t} = a_{DM}D - a_{MD}M - r_M M = a_{DM}D - (a_{MD} + r_M)M\n$$\n\n这样就完成了常微分方程组。接下来，我们求解稳态肉食者生物量 $C^{\\ast}$。在稳态下，所有时间导数都等于零。设稳态生物量为 $P^{\\ast}$、$H^{\\ast}$、$C^{\\ast}$、$D^{\\ast}$ 和 $M^{\\ast}$。\n\n从 $P$ 的方程：\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}t} = 0 \\implies I_P - (a_{PH} + a_{PD} + r_P)P^{\\ast} = 0\n$$\n解出 $P^{\\ast}$ 得：\n$$\nP^{\\ast} = \\frac{I_P}{a_{PH} + a_{PD} + r_P}\n$$\n\n从 $H$ 的方程：\n$$\n\\frac{\\mathrm{d}H}{\\mathrm{d}t} = 0 \\implies a_{PH}P^{\\ast} - (a_{HC} + a_{HD} + r_H)H^{\\ast} = 0\n$$\n解出 $H^{\\ast}$ 得：\n$$\nH^{\\ast} = \\frac{a_{PH}P^{\\ast}}{a_{HC} + a_{HD} + r_H}\n$$\n\n从 $C$ 的方程：\n$$\n\\frac{\\mathrm{d}C}{\\mathrm{d}t} = 0 \\implies a_{HC}H^{\\ast} - (a_{CD} + r_C)C^{\\ast} = 0\n$$\n解出 $C^{\\ast}$ 得：\n$$\nC^{\\ast} = \\frac{a_{HC}H^{\\ast}}{a_{CD} + r_C}\n$$\n\n活体食物链（$P \\to H \\to C$）的结构是一个简单的级联。我们可以通过代入 $H^{\\ast}$ 的表达式来找到 $C^{\\ast}$，而 $H^{\\ast}$ 又依赖于 $P^{\\ast}$。求解 $C^{\\ast}$ 不需要 $D$ 和 $M$ 的方程。\n\n将 $H^{\\ast}$ 的表达式代入 $C^{\\ast}$ 的方程：\n$$\nC^{\\ast} = \\frac{a_{HC}}{a_{CD} + r_C} \\left( \\frac{a_{PH}P^{\\ast}}{a_{HC} + a_{HD} + r_H} \\right)\n$$\n现在，代入 $P^{\\ast}$ 的表达式：\n$$\nC^{\\ast} = \\frac{a_{HC}}{a_{CD} + r_C} \\left( \\frac{a_{PH}}{a_{HC} + a_{HD} + r_H} \\right) \\left( \\frac{I_P}{a_{PH} + a_{PD} + r_P} \\right)\n$$\n这就是稳态肉食者生物量的解析解。\n\n最后，我们代入给定的数值来计算 $C^{\\ast}$。\n参数为：\n$I_P = 60$，$a_{PH} = 0.8$，$a_{PD} = 0.4$，$r_P = 0.3$。\n$a_{HC} = 0.6$，$a_{HD} = 0.5$，$r_H = 0.2$。\n$a_{CD} = 0.3$，$r_C = 0.2$。\n\n首先，我们计算分母项：\n$P$ 的总流出速率之和：$k_P = a_{PH} + a_{PD} + r_P = 0.8 + 0.4 + 0.3 = 1.5\\ \\mathrm{y^{-1}}$。\n$H$ 的总流出速率之和：$k_H = a_{HC} + a_{HD} + r_H = 0.6 + 0.5 + 0.2 = 1.3\\ \\mathrm{y^{-1}}$。\n$C$ 的总流出速率之和：$k_C = a_{CD} + r_C = 0.3 + 0.2 = 0.5\\ \\mathrm{y^{-1}}$。\n\n现在，我们可以依次计算稳态生物量：\n$$\nP^{\\ast} = \\frac{I_P}{k_P} = \\frac{60}{1.5} = 40\\ \\mathrm{g\\ C\\ m^{-2}}\n$$\n$$\nH^{\\ast} = \\frac{a_{PH}P^{\\ast}}{k_H} = \\frac{0.8 \\times 40}{1.3} = \\frac{32}{1.3}\\ \\mathrm{g\\ C\\ m^{-2}}\n$$\n$$\nC^{\\ast} = \\frac{a_{HC}H^{\\ast}}{k_C} = \\frac{0.6 \\times \\frac{32}{1.3}}{0.5} = \\frac{19.2}{1.3 \\times 0.5} = \\frac{19.2}{0.65}\n$$\n或者，将所有项合并到解析公式中：\n$$\nC^{\\ast} = \\frac{a_{HC} a_{PH} I_P}{k_C k_H k_P} = \\frac{0.6 \\times 0.8 \\times 60}{0.5 \\times 1.3 \\times 1.5} = \\frac{28.8}{0.975}\n$$\n进行除法计算：\n$$\nC^{\\ast} = \\frac{28.8}{0.975} \\approx 29.5384615... \\ \\mathrm{g\\ C\\ m^{-2}}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nC^{\\ast} \\approx 29.54\\ \\mathrm{g\\ C\\ m^{-2}}\n$$", "answer": "$$\n\\boxed{29.54}\n$$", "id": "2483637"}, {"introduction": "在理解了单个流动和房室动态之后，生态网络分析使我们能够评估整个系统的宏观属性。本练习引入了源于信息论的深刻概念，如系统发展能力（Capacity）和上升性（Ascendency），用于量化生态系统整体的组织性和效率。通过为一个给定的流动网络计算这些指标，你将学会如何超越单个组分，从整体视角评价网络的成熟度、稳定性和冗余度 [@problem_id:2483648]。", "problem": "一位生态学家正在分析一个稳态、封闭的三区室营养网络中的能量-物质流的组织结构。区室间的内部流动由流动矩阵 $F = [F_{ij}]$ 概括，其中 $F_{ij}$ 表示从区室 $i$ 到区室 $j$ 的流动（单位：mg C m$^{-2}$ d$^{-1}$）。该网络没有自环，没有边界输入或输出，并且处于稳态（每个区室的总流入等于其总流出）。观测到的内部流动矩阵为\n$$\nF \\;=\\;\n\\begin{pmatrix}\n0  3  2 \\\\\n1  0  4 \\\\\n4  2  0\n\\end{pmatrix}\n\\quad \\text{(mg C m}^{-2}\\text{ d}^{-1}\\text{)}.\n$$\n从生态网络分析的基本原理出发，通过总系统流贯量 $T = \\sum_{i,j} F_{ij}$ 进行归一化后，将实现的流 $\\{F_{ij}\\}$ 视为区室有序对上的一个离散联合分布，并使用信息论中关于离散分布的香农熵和流的起点与终点之间的平均互信息的标准定义，两者均使用自然对数（底为 $e$）进行计算。基于这些基础，根据总系统流贯量 $T$ 和这些信息度量来定义网络的发展能力 $C$ 和上升性 $A$，并将维持费 $O$ 定义为 $C$ 中未被 $A$ 解释的部分。\n\n使用以 $e$ 为底的对数，计算给定 $F$ 的 $A$、$C$ 和 $O$ 的数值。以 mg C m$^{-2}$ d$^{-1}\\cdot$nat 为单位表示你的最终结果，并将每个值四舍五入到四位有效数字。以单行矩阵 $\\big(A \\;\\; C \\;\\; O\\big)$ 的形式提供你的最终答案。", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 系统：稳态、封闭的三区室营养网络。\n- 流动矩阵 $F = [F_{ij}]$，其中 $F_{ij}$ 是从区室 $i$ 到区室 $j$ 的流动。\n- 流动单位：mg C m$^{-2}$ d$^{-1}$。\n- 流动矩阵值：\n$$\nF = \\begin{pmatrix}\n0  3  2 \\\\\n1  0  4 \\\\\n4  2  0\n\\end{pmatrix}\n$$\n- 约束条件：无自环（$F_{ii} = 0$），无边界输入或输出，稳态（每个区室的总流入等于总流出）。\n- 定义：\n    - 总系统流贯量：$T = \\sum_{i,j} F_{ij}$。\n    - 流的联合分布：$p(i, j) = F_{ij}/T$。\n    - 信息度量：香农熵和平均互信息使用自然对数（底为 $e$）计算。\n    - 发展能力 $C$ 和上升性 $A$ 是 $T$ 和这些信息度量的函数。\n    - 维持费 $O = C - A$。\n- 任务：\n    - 计算 $A$、$C$ 和 $O$ 的数值。\n    - 使用以 $e$ 为底的对数。\n    - 以 mg C m$^{-2}$ d$^{-1}\\cdot$nat 为单位表示结果。\n    - 将结果四舍五入到四位有效数字。\n    - 以行矩阵 $(A \\;\\; C \\;\\; O)$ 的形式呈现最终答案。\n\n步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题在生态网络分析的既定框架内，特别是在 Ulanowicz 的上升性理论中，得到了正确的表述。使用信息论量化的吞吐量、上升性、能力和维持费等概念在该领域是标准化的。该问题在科学上是合理的。\n2.  **一致性检查**：必须对给定的流动矩阵 $F$ 验证稳态条件。\n    - 从区室 1 的总流出：$T_{1,out} = F_{12} + F_{13} = 3 + 2 = 5$。\n    - 到区室 1 的总流入：$T_{1,in} = F_{21} + F_{31} = 1 + 4 = 5$。条件成立：$T_{1,in} = T_{1,out}$。\n    - 从区室 2 的总流出：$T_{2,out} = F_{21} + F_{23} = 1 + 4 = 5$。\n    - 到区室 2 的总流入：$T_{2,in} = F_{12} + F_{32} = 3 + 2 = 5$。条件成立：$T_{2,in} = T_{2,out}$。\n    - 从区室 3 的总流出：$T_{3,out} = F_{31} + F_{32} = 4 + 2 = 6$。\n    - 到区室 3 的总流入：$T_{3,in} = F_{13} + F_{23} = 2 + 4 = 6$。条件成立：$T_{3,in} = T_{3,out}$。\n    矩阵 $F$ 与稳态假设一致。\n3.  **适定性**：该问题为唯一解提供了所有必要的数据和定义。术语是标准的，可以引导出一组清晰的计算。\n\n步骤 3：结论\n该问题是有效的。它是一个在定量生态学中适定且有科学依据的问题。将根据要求从第一性原理推导求解。\n\n分析首先根据提供的流动矩阵 $F$ 定义核心量。\n\n总系统流贯量 $T$ 是网络中所有单个流的总和：\n$$ T = \\sum_{i=1}^{3} \\sum_{j=1}^{3} F_{ij} = (0+3+2) + (1+0+4) + (4+2+0) = 5 + 5 + 6 = 16 \\, \\text{mg C m}^{-2} \\text{ d}^{-1} $$\n通过每个区室 $k$ 的总流量，记为 $T_k$，是流出的总和，由于稳态条件，它等于流入的总和。\n$$ T_1 = \\sum_{j} F_{1j} = \\sum_{i} F_{i1} = 5 $$\n$$ T_2 = \\sum_{j} F_{2j} = \\sum_{i} F_{i2} = 5 $$\n$$ T_3 = \\sum_{j} F_{3j} = \\sum_{i} F_{i3} = 6 $$\n\n根据问题的指示，我们将归一化的流 $p(i, j) = F_{ij}/T$ 视为区室有序对 $(i, j)$ 上的一个联合概率分布，其中 $i$ 是起点，$j$ 是终点。\n\n发展能力 $C$ 代表有组织流的上限，定义为总系统流贯量与流的联合分布的香农熵 $H(I,J)$ 的乘积。\n$$ C = T \\cdot H(I,J) = T \\left( -\\sum_{i,j} p(i,j) \\ln p(i,j) \\right) = -\\sum_{i,j} F_{ij} \\ln\\left(\\frac{F_{ij}}{T}\\right) $$\n求和是对所有非零流 $F_{ij}$ 进行的。当 $p=0$ 时，$p \\ln p$ 项取为 $0$。使用 $T=16$：\n$$ C = -F_{12}\\ln\\left(\\frac{F_{12}}{T}\\right) - F_{13}\\ln\\left(\\frac{F_{13}}{T}\\right) - F_{21}\\ln\\left(\\frac{F_{21}}{T}\\right) - F_{23}\\ln\\left(\\frac{F_{23}}{T}\\right) - F_{31}\\ln\\left(\\frac{F_{31}}{T}\\right) - F_{32}\\ln\\left(\\frac{F_{32}}{T}\\right) $$\n$$ C = -3\\ln\\left(\\frac{3}{16}\\right) - 2\\ln\\left(\\frac{2}{16}\\right) - 1\\ln\\left(\\frac{1}{16}\\right) - 4\\ln\\left(\\frac{4}{16}\\right) - 4\\ln\\left(\\frac{4}{16}\\right) - 2\\ln\\left(\\frac{2}{16}\\right) $$\n$$ C = -3(\\ln 3 - \\ln 16) - 2(\\ln 2 - \\ln 16) - (\\ln 1 - \\ln 16) - 4(\\ln 4 - \\ln 16) - 4(\\ln 4 - \\ln 16) - 2(\\ln 2 - \\ln 16) $$\n由于 $\\ln 1 = 0$，$\\ln 16 = \\ln(2^4) = 4\\ln 2$ 且 $\\ln 4 = \\ln(2^2) = 2\\ln 2$：\n$$ C = -3\\ln 3 + 3(4\\ln 2) - 2\\ln 2 + 2(4\\ln 2) + 4\\ln 2 - 4(2\\ln 2) + 4(4\\ln 2) - 4(2\\ln 2) + 4(4\\ln 2) - 2\\ln 2 + 2(4\\ln 2) $$\n$$ C = -3\\ln 3 + (12 - 2 + 8 + 4 - 8 + 16 - 8 + 16 - 2 + 8)\\ln 2 = -3\\ln 3 + 44\\ln 2 $$\n其数值为：\n$$ C \\approx -3(1.09861) + 44(0.69315) \\approx -3.29583 + 30.4986 = 27.20277 \\, \\text{mg C m}^{-2} \\text{ d}^{-1}\\cdot\\text{nat} $$\n\n上升性 $A$ 量化了流动结构中的有组织部分。它定义为总系统流贯量与流的起点和终点之间的平均互信息 $AMI(I;J)$ 的乘积。\n$$ A = T \\cdot AMI(I;J) = T \\sum_{i,j} p(i,j) \\ln\\left(\\frac{p(i,j)}{p(i)p(j)}\\right) $$\n这里，$p(i) = T_i/T$ 和 $p(j) = T_j/T$ 是边缘概率。\n$$ A = \\sum_{i,j} F_{ij} \\ln\\left(\\frac{F_{ij}/T}{(T_i/T)(T_j/T)}\\right) = \\sum_{i,j} F_{ij} \\ln\\left(\\frac{F_{ij} T}{T_i T_j}\\right) $$\n代入数值 $T=16$，$T_1=5$，$T_2=5$，$T_3=6$：\n$$ A = 3\\ln\\left(\\frac{3 \\cdot 16}{5 \\cdot 5}\\right) + 2\\ln\\left(\\frac{2 \\cdot 16}{5 \\cdot 6}\\right) + 1\\ln\\left(\\frac{1 \\cdot 16}{5 \\cdot 5}\\right) + 4\\ln\\left(\\frac{4 \\cdot 16}{5 \\cdot 6}\\right) + 4\\ln\\left(\\frac{4 \\cdot 16}{6 \\cdot 5}\\right) + 2\\ln\\left(\\frac{2 \\cdot 16}{6 \\cdot 5}\\right) $$\n$$ A = 3\\ln\\left(\\frac{48}{25}\\right) + 2\\ln\\left(\\frac{32}{30}\\right) + \\ln\\left(\\frac{16}{25}\\right) + 4\\ln\\left(\\frac{64}{30}\\right) + 4\\ln\\left(\\frac{64}{30}\\right) + 2\\ln\\left(\\frac{32}{30}\\right) $$\n简化分数并合并项：\n$$ A = 3\\ln\\left(\\frac{48}{25}\\right) + \\ln\\left(\\frac{16}{25}\\right) + 4\\ln\\left(\\frac{16}{15}\\right) + 8\\ln\\left(\\frac{32}{15}\\right) $$\n这个表达式可以展开为素数对数（$\\ln 2$, $\\ln 3$, $\\ln 5$）的形式：\n$A = 3(\\ln(16 \\cdot 3) - \\ln(5^2)) + (\\ln 16 - \\ln(5^2)) + 4(\\ln 16 - \\ln(3 \\cdot 5)) + 8(\\ln 32 - \\ln(3 \\cdot 5))$\n$A = 3(4\\ln 2 + \\ln 3 - 2\\ln 5) + (4\\ln 2 - 2\\ln 5) + 4(4\\ln 2 - \\ln 3 - \\ln 5) + 8(5\\ln 2 - \\ln 3 - \\ln 5)$\n$A = (12+4+16+40)\\ln 2 + (3-4-8)\\ln 3 + (-6-2-4-8)\\ln 5$\n$$ A = 72\\ln 2 - 9\\ln 3 - 20\\ln 5 $$\n其数值为：\n$$ A \\approx 72(0.69315) - 9(1.09861) - 20(1.60944) \\approx 49.9068 - 9.8875 - 32.1888 = 7.8305 \\, \\text{mg C m}^{-2} \\text{ d}^{-1}\\cdot\\text{nat} $$\n\n維持費 $O$ 代表网络活动中无组织、低效或冗余的部分。它是发展能力与上升性之差。\n$$ O = C - A $$\n其数值为：\n$$ O \\approx 27.20277 - 7.8305 = 19.37227 \\, \\text{mg C m}^{-2} \\text{ d}^{-1}\\cdot\\text{nat} $$\n\n问题要求将最终结果四舍五入到四位有效数字。\n- $A \\approx 7.8305 \\rightarrow 7.830$\n- $C \\approx 27.20277 \\rightarrow 27.20$\n- $O \\approx 19.37227 \\rightarrow 19.37$\n\n最终答案以行矩阵 $(A \\;\\; C \\;\\; O)$ 的形式呈现。", "answer": "$$ \\boxed{ \\begin{pmatrix} 7.830  27.20  19.37 \\end{pmatrix} } $$", "id": "2483648"}]}