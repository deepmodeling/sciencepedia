{"hands_on_practices": [{"introduction": "在环境DNA（eDNA）研究中，一个核心挑战是确保我们的采样力度足以探测到目标物种（如果它确实存在）。仅仅因为一个样本呈阴性，并不一定意味着物种不存在——可能只是我们碰巧错过了稀有的DNA痕跡。本练习将引导您运用基本的概率论原理，量化重复采样（replication）如何提高检测的可靠性，并计算出为了达到预设的置信水平，您需要采集多少个独立的样本。[@problem_id:2488055]", "problem": "一个保育团队正在为某河段的一种珍稀两栖动物设计环境脱氧核糖核酸 (eDNA) 调查。每个水样重复样本都经过过滤、提取，并使用定量聚合酶链式反应 (qPCR) 进行检测。在该物种存在于此河段的条件下，来自给定样本的单个实验室重复产生一次检出的概率为 $p$，并且由于使用了独立的等分试样、提取过程和 qPCR 孔，不同的重复可以被视为独立的伯努利试验。该团队力求在 $n$ 个独立重复中至少检出一次该物种，并保证一个可靠性 $R$。\n\n1. 仅从独立伯努利试验和概率的补集法则的定义出发，推导在 $n$ 个独立重复中至少有一次检出的概率的通用表达式，该表达式用 $p$ 和 $n$ 表示。\n\n2. 使用你的表达式，确定当每个重复的检出概率为 $p = 0.28$ 时，确保可靠性至少为 $R = 0.95$ 的最小整数 $n$。将 $R$ 解释为在物种存在的条件下，在 $n$ 个重复中观察到至少一次检出的条件概率。将所需的 $n$ 报告为单个无单位的数字。不要四舍五入到指定的有效数字位数；而是提供满足要求的精确最小整数 $n$。", "solution": "在尝试任何解答之前，首先评估问题陈述的有效性。\n\n**问题验证**\n\n从陈述中逐字提取已知条件：\n1.  单个实验室重复产生一次检出的概率为 $p$。\n2.  不同的重复是独立的伯努利试验。\n3.  独立重复的次数为 $n$。\n4.  该团队力求保证至少检出一次该物种的可靠性为 $R$。\n5.  第1部分要求仅从独立伯努利试验和补集法则的定义出发，推导在 $n$ 个重复中至少有一次检出的概率的表达式（用 $p$ 和 $n$ 表示）。\n6.  第2部分要求在 $p = 0.28$ 时，找到使 $R \\geq 0.95$ 的最小整数 $n$。$R$ 被解释为在物种存在的条件下至少有一次检出的条件概率。\n\n该问题被认为是**有效的**。它在科学上基于概率论原理及其在生态调查设计（环境DNA）中的应用。问题提法得当，提供了所有必要信息且没有矛盾之处。语言是客观的，参数 ($p=0.28$, $R=0.95$) 对于所描述的情景是现实的。该问题需要对基本概念进行标准而严谨的应用，这是一项合理的科学任务。\n\n**求解推导**\n\n问题将按规定分为两部分解决。\n\n**第1部分：检出概率的通用表达式**\n\n设 $D_i$ 为第 $i$ 次重复中发生检出的事件，其中 $i \\in \\{1, 2, \\dots, n\\}$。\n根据题意，每次重复都是一次伯努利试验。单次试验成功（检出）的概率为 $p$。\n$$P(D_i) = p$$\n对立事件 $D_i^c$ 是第 $i$ 次重复中未发生检出的事件。根据对立事件的概率性质，该事件的概率为：\n$$P(D_i^c) = 1 - P(D_i) = 1 - p$$\n我们需要求的是在 $n$ 次重复中至少有一次检出的概率。设该事件为 $A$。事件 $A$ 是各单次检出事件的并集：\n$$A = D_1 \\cup D_2 \\cup \\dots \\cup D_n$$\n为求 $P(A)$，使用补集法则更为直接。事件 $A$ 的对立事件，记为 $A^c$，是在 $n$ 次重复中*均未*检出的事件。这等同于各单次未检出事件的交集：\n$$A^c = D_1^c \\cap D_2^c \\cap \\dots \\cap D_n^c$$\n问题陈述说明各次重复是独立的。根据多个事件独立性的定义，它们交集的概率是它们各自概率的乘积：\n$$P(A^c) = P(D_1^c) \\times P(D_2^c) \\times \\dots \\times P(D_n^c)$$\n由于对所有的 $i=1, \\dots, n$ 都有 $P(D_i^c) = 1 - p$，这个乘积变为：\n$$P(A^c) = \\prod_{i=1}^{n} P(D_i^c) = (1-p)^n$$\n事件 $A$ 的概率通过应用补集法则得到：\n$$P(A) = 1 - P(A^c)$$\n代入我们得到的 $P(A^c)$ 表达式，我们便得出在 $n$ 次独立重复中至少有一次检出的概率的通用表达式：\n$$P(\\text{at least one detection}) = 1 - (1-p)^n$$\n\n**第2部分：所需重复次数的计算**\n\n可靠性 $R$ 定义为至少有一次检出的概率。我们得到的任务要求是该可靠性必须至少为 $R = 0.95$，且每次重复的检出概率为 $p = 0.28$。我们必须找到满足此条件的最小整数 $n$。\n\n使用第1部分推导的表达式，该条件可表示为以下不等式：\n$$1 - (1-p)^n \\geq R$$\n代入给定值 $p=0.28$ 和 $R=0.95$：\n$$1 - (1-0.28)^n \\geq 0.95$$\n$$1 - (0.72)^n \\geq 0.95$$\n现在我们求解 $n$。首先，分离含有 $n$ 的项：\n$$-(0.72)^n \\geq 0.95 - 1$$\n$$-(0.72)^n \\geq -0.05$$\n两边同乘以 $-1$。此操作会反转不等号的方向：\n$$(0.72)^n \\leq 0.05$$\n为求解指数 $n$，我们对两边取自然对数 ($\\ln$)。由于自然对数是单调递增函数，不等号的方向保持不变。\n$$\\ln\\left((0.72)^n\\right) \\leq \\ln(0.05)$$\n使用对数性质 $\\ln(x^y) = y \\ln(x)$：\n$$n \\ln(0.72) \\leq \\ln(0.05)$$\n为分离出 $n$，我们必须除以 $\\ln(0.72)$。我们必须首先确定该项的符号。由于 $0  0.72  1$，其自然对数为负，即 $\\ln(0.72)  0$。不等式两边同除以一个负数会再次反转不等号的方向：\n$$n \\geq \\frac{\\ln(0.05)}{\\ln(0.72)}$$\n现在，我们计算右侧表达式的值：\n$$\\ln(0.05) \\approx -2.99573227355$$\n$$\\ln(0.72) \\approx -0.32850406697$$\n$$n \\geq \\frac{-2.99573227355}{-0.32850406697} \\approx 9.119313$$\n重复次数 $n$ 必须是整数。问题要求满足此条件的最小整数 $n$。由于 $n$ 必须大于或等于约 $9.119$，所以 $n$ 的最小整数值为 $10$。\n\n为了验证，我们可以检查 $n=9$ 和 $n=10$ 时的情况：\n对于 $n=9$：$1 - (0.72)^9 \\approx 1 - 0.05305 \\approx 0.94695$。这小于 $0.95$，所以 $n=9$ 是不够的。\n对于 $n=10$：$1 - (0.72)^{10} \\approx 1 - 0.03820 \\approx 0.96180$。这大于 $0.95$，所以 $n=10$ 是足够的。\n\n因此，所需的最小整数重复次数为 $10$。", "answer": "$$\\boxed{10}$$", "id": "2488055"}, {"introduction": "现实世界中的生态学研究总是在资源限制下进行的，eDNA调查也不例外。当面临固定的预算时，研究者必须做出关键的策略权衡：是应该采集大量的小体积水样，还是少量的大体积水样？这个决策会直接影响到探测到稀有物种的可能性。本练习构建了一个优化模型，旨在帮助您理解和解决这个在采样设计中至关重要的权衡问题，从而在有限的资源下最大化您的检测成功率。[@problem_id:2488009]", "problem": "您正在设计一项环境DNA（eDNA）调查，以在物种存在的情况下，最大化在某个地点检测到该单一目标物种的几率。假设存在以下基本事实和约束条件。\n\n1. 捕获过程：如果目标模板分子的环境浓度在取样的水中产生每升$\\lambda$的期望计数，那么在泊松到达模型下，一个体积为 $v$ 升的水样中含有至少一个目标分子的概率是 $1 - \\exp(-\\lambda v)$。\n2. 实验室成功率：每个重复样本都有一个独立的、与体积无关的概率 $s$，使得实验室工作流程（提取、扩增、测序）能成功地将捕获的目标分子转化为可检测的读数。只有当捕获和实验室流程都成功时，一个重复样本才能产生检测结果。\n3. 重复取样：您在该地点收集 $r$ 个经过相同处理的独立重复样本，每个样本的体积均为 $v$。在物种存在的条件下，各重复样本是独立的。\n4. 预算：总预算为 $B$ 个成本单位。每个重复样本产生一个固定的设置成本 $c_0$ 和一个与体积成正比的可变成本 $c_v v$。因此，预算约束为 $r(c_0 + c_v v) \\leq B$。假设在最优情况下，全部预算都被用尽，并且 $v>0$。\n\n任务：\na) 仅使用上述陈述和基本概率法则，推导出单个重复样本的检测概率（作为 $v$ 的函数）以及所有重复样本中至少有一次检测的概率（作为 $(r,v)$ 的函数）。然后，利用预算约束消去 $v$，以获得一个仅依赖于 $r$ 和参数的目标函数 $P(r)$。\nb) 使用参数 $\\lambda = 0.1 \\, \\text{L}^{-1}$，$s = 0.5$，$B = 600$ 成本单位，$c_0 = 40$ 成本单位，以及 $c_v = 5$ 成本单位每升，计算可行的正整数 $r$ 并确定使目标函数 $P(r)$ 最大化的整数 $r$。仅报告使函数最大化的整数 $r$，不包括单位。如果需要数值计算，您可以用任何合理的精度进行计算；因为答案是整数，所以不需要四舍五入规则。", "solution": "首先对用户的问题进行验证。\n\n从问题陈述中提取的已知条件：\n- 在体积为 $v$ 的样本中捕获到至少一个目标分子的概率为 $P_{\\text{capture}} = 1 - \\exp(-\\lambda v)$，其中 $\\lambda$ 是每升分子的期望计数。\n- 单个重复样本的实验室成功概率为 $s$，且独立于其他因素。\n- 一次检测需要捕获和实验室流程均成功。\n- 共有 $r$ 个独立的重复样本，每个样本的体积为 $v$。\n- 总预算为 $B$，约束条件为 $r(c_0 + c_v v) \\leq B$，其中 $c_0$ 是每个重复样本的固定成本，$c_v$ 是每升体积的成本。\n- 假设在最优情况下预算全部用尽，因此 $r(c_0 + c_v v) = B$。\n- 样本体积必须为正，即 $v > 0$。\n- 用于数值计算的参数：$\\lambda = 0.1$ $\\text{L}^{-1}$，$s = 0.5$，$B = 600$，$c_0 = 40$，$c_v = 5$。\n\n验证结论：\n该问题具有科学依据，使用了标准的泊松过程模型进行粒子检测，这适用于模拟eDNA的分布。这是一个定义明确的约束优化问题。其语言客观而精确。问题设定是自洽且无矛盾的。该问题是应用生物统计学和优化方面的一个有效练习。\n\n开始推导解法。\n\n任务(a)：推导目标函数 $P(r)$。\n\n单个重复样本的检测概率（我们记为 $P_{\\text{rep}}$）是两个独立事件的联合概率：捕获到至少一个分子和实验室流程成功。\n捕获概率由 $P_{\\text{capture}}(v) = 1 - \\exp(-\\lambda v)$ 给出。\n实验室成功概率为 $s$。\n因此，单个重复样本的检测概率为：\n$$\nP_{\\text{rep}}(v) = P_{\\text{capture}}(v) \\times s = s(1 - \\exp(-\\lambda v))\n$$\n\n接下来，我们考虑所有 $r$ 个重复样本的总体检测概率。问题要求的是至少有一次检测的概率。更直接的方法是首先计算其互补事件的概率：在所有 $r$ 个重复样本中均未检测到。\n在单个重复样本中未检测到的概率是 $1 - P_{\\text{rep}}(v)$。\n$$\n1 - P_{\\text{rep}}(v) = 1 - s(1 - \\exp(-\\lambda v))\n$$\n由于 $r$ 个重复样本是独立的，所有 $r$ 个样本均未检测到的概率是它们各自未检测到概率的乘积：\n$$\nP(\\text{在 } r \\text{ 个重复样本中均未检测到}) = (1 - P_{\\text{rep}}(v))^r = \\left(1 - s(1 - \\exp(-\\lambda v))\\right)^r\n$$\n因此，至少有一次检测的概率（我们记为 $P(r,v)$）是：\n$$\nP(r,v) = 1 - \\left(1 - s(1 - \\exp(-\\lambda v))\\right)^r\n$$\n\n(a)部分的最后一步是使用预算约束消去体积变量 $v$，从而得到一个仅依赖于重复样本数量 $r$ 和给定参数的目标函数 $P(r)$。在最优点上，预算约束被视为等式：\n$$\nr(c_0 + c_v v) = B\n$$\n我们在 $r > 0$ 的条件下解这个关于 $v$ 的方程。\n$$\nc_0 + c_v v = \\frac{B}{r}\n$$\n$$\nc_v v = \\frac{B}{r} - c_0\n$$\n$$\nv(r) = \\frac{1}{c_v}\\left(\\frac{B}{r} - c_0\\right)\n$$\n为了使 $v$ 具有物理意义，必须有 $v > 0$，这意味着 $\\frac{B}{r} - c_0 > 0$，从而得到约束条件 $r  \\frac{B}{c_0}$。\n\n现在，我们将 $v(r)$ 的表达式代入概率函数 $P(r,v)$。指数项变为：\n$$\n-\\lambda v(r) = -\\lambda \\left(\\frac{1}{c_v}\\left(\\frac{B}{r} - c_0\\right)\\right) = -\\frac{\\lambda}{c_v}\\left(\\frac{B}{r} - c_0\\right) = \\frac{\\lambda c_0}{c_v} - \\frac{\\lambda B}{c_v r}\n$$\n代入 $P(r,v)$ 的表达式得到最终的目标函数 $P(r)$：\n$$\nP(r) = 1 - \\left(1 - s\\left(1 - \\exp\\left(\\frac{\\lambda c_0}{c_v} - \\frac{\\lambda B}{c_v r}\\right)\\right)\\right)^r\n$$\n\n任务(b)：求解最优重复样本数 $r$ 的数值解。\n\n给定参数为：$\\lambda = 0.1$，$s = 0.5$，$B = 600$，$c_0 = 40$，以及 $c_v = 5$。\n\n首先，我们确定整数 $r$ 的可行范围。重复样本数必须是正整数，即 $r \\geq 1$。$v > 0$ 的约束要求 $r  \\frac{B}{c_0}$。\n$$\nr  \\frac{600}{40} = 15\n$$\n因此，$r$ 的可行整数集合为 $\\{1, 2, 3, \\dots, 14\\}$。\n\n接下来，我们将参数值代入 $P(r)$ 的表达式中。我们先计算指数中的常数：\n$$\n\\frac{\\lambda c_0}{c_v} = \\frac{0.1 \\times 40}{5} = \\frac{4}{5} = 0.8\n$$\n$$\n\\frac{\\lambda B}{c_v} = \\frac{0.1 \\times 600}{5} = \\frac{60}{5} = 12\n$$\n目标函数变为：\n$$\nP(r) = 1 - \\left(1 - 0.5\\left(1 - \\exp\\left(0.8 - \\frac{12}{r}\\right)\\right)\\right)^r\n$$\n这可以通过简化幂的底数来重写：\n$$\n1 - 0.5(1 - \\exp(\\dots)) = 1 - 0.5 + 0.5\\exp(\\dots) = 0.5 + 0.5\\exp(\\dots)\n$$\n所以，\n$$\nP(r) = 1 - \\left(0.5 + 0.5 \\exp\\left(0.8 - \\frac{12}{r}\\right)\\right)^r\n$$\n我们的任务是找到整数 $r \\in \\{1, 2, \\dots, 14\\}$，使其能最大化此函数。我们对每个可行的 $r$ 值计算 $P(r)$。\n\n- 当 $r=1$ 时: $P(1) = 1 - (0.5 + 0.5 \\exp(0.8 - 12))^{1} = 1 - (0.5 + 0.5 \\exp(-11.2)) \\approx 0.49999$\n- 当 $r=2$ 时: $P(2) = 1 - (0.5 + 0.5 \\exp(0.8 - 6))^{2} = 1 - (0.5 + 0.5 \\exp(-5.2))^{2} \\approx 0.74718$\n- 当 $r=3$ 时: $P(3) = 1 - (0.5 + 0.5 \\exp(0.8 - 4))^{3} = 1 - (0.5 + 0.5 \\exp(-3.2))^{3} \\approx 0.85906$\n- 当 $r=4$ 时: $P(4) = 1 - (0.5 + 0.5 \\exp(0.8 - 3))^{4} = 1 - (0.5 + 0.5 \\exp(-2.2))^{4} \\approx 0.90477$\n- 当 $r=5$ 时: $P(5) = 1 - (0.5 + 0.5 \\exp(0.8 - 2.4))^{5} = 1 - (0.5 + 0.5 \\exp(-1.6))^{5} \\approx 0.92183$\n- 当 $r=6$ 时: $P(6) = 1 - (0.5 + 0.5 \\exp(0.8 - 2))^{6} = 1 - (0.5 + 0.5 \\exp(-1.2))^{6} \\approx 0.92411$\n- 当 $r=7$ 时: $P(7) = 1 - (0.5 + 0.5 \\exp(0.8 - 12/7))^{7} \\approx 1 - (0.5 + 0.5 \\exp(-0.914))^{7} \\approx 0.91817$\n- 当 $r=8$ 时: $P(8) = 1 - (0.5 + 0.5 \\exp(0.8 - 1.5))^{8} \\approx 1 - (0.5 + 0.5 \\exp(-0.7))^{8} \\approx 0.90659$\n\n概率值在 $r=6$ 之前递增，之后开始递减。\n$P(5) \\approx 0.92183$\n$P(6) \\approx 0.92411$\n$P(7) \\approx 0.91817$\n检测概率 $P(r)$ 的最大值在 $r=6$ 时出现。增加重复样本数 $r$ 和减少每个重复样本的体积 $v$ 之间的权衡在此值上达到了最优化。当重复样本较少时（例如 $r=5$），体积 $v$ 较大，这会提高单个样本的成功率，但较少的重复次数使得总体检测可能性降低。当重复样本较多时（例如 $r=7$），体积 $v$ 变得过小，极大地降低了单个样本的成功率，以至于更多的重复次数也无法弥补。\n\n使目标函数 $P(r)$ 最大化的整数是 $6$。", "answer": "$$\n\\boxed{6}\n$$", "id": "2488009"}, {"introduction": "在eDNA分析中获得一个阳性信号是令人兴奋的，但这并不直接等同于100%确定物种的存在。检测方法本身可能存在假阳性（false positives）和假阴性（false negatives），因此，对结果的解读需要更加严谨的统计思维。本练习将向您介绍贝叶斯定理（Bayes' theorem）这一强大工具，学习如何结合物种的先验入住概率（prior probability）以及检测方法的灵敏度（sensitivity）和特异性（specificity），来计算一个更为可靠的指标——后验概率（posterior probability），从而科学地评估一个阳性结果真正意味着什么。[@problem_id:2488011]", "problem": "一项环境DNA采样活动针对某河段中的一种隐存鱼类。根据往年的分层占域分析，该物种在采样时真实占据该河段的先验概率为$0.35$。对一个水样进行单一位点定量聚合酶链式反应（qPCR）检测。当检测在该单一位点上返回高于阈值的扩增时，记录为阳性检测结果。当物种存在时，检测过程包括两个连续且必要的阶段：首先，在野外采集过程中，滤膜上捕获至少一个目标DNA分子；其次，在qPCR期间成功扩增目标位点。在物种真实存在的条件下，捕获至少一个分子的概率为$0.70$；在捕获的条件下，qPCR成功扩增目标的概率为$0.90$。假设在物种真实存在的条件下，这两个阶段是独立的。当物种真实不存在时，阳性结果只能通过假阳性机制（例如，样本交叉污染或非特异性扩增）发生，这些机制共同导致单个样本的单一位点检测的假阳性概率为$0.004$（等效于特异性为$0.996$）。假设假阳性机制与物种存在过程无关。该样本的检测结果为阳性。\n\n从条件概率和全概率公式的基本定义出发，计算在得到这个阳性结果的条件下，该物种真实存在的后验概率。将最终答案表示为不带单位的小数，并四舍五入到四位有效数字。", "solution": "本问题要求计算一个后验概率，这是贝叶斯定理的直接应用。在继续之前，必须验证问题陈述的科学和逻辑一致性。\n\n本问题是贝叶斯推断中的一个明确定义的练习，贝叶斯推断是包括生态学在内的科学学科中现代统计分析的基石。它在科学上基于环境DNA（eDNA）方法学、物种检测和概率建模的原理。所有必要的数据都已提供，并且没有矛盾之处。\n\n我们定义以下事件：\n- $A$：该隐存鱼类物种真实存在于该河段的事件。\n- $A^c$：该物种真实不存在于该河段的事件。这是事件$A$的补事件。\n- $B$：qPCR检测得出阳性结果的事件。\n\n问题提供了以下概率，即已知条件：\n- 物种存在的先验概率：$P(A) = 0.35$。\n- 假阳性概率，即在物种不存在的条件下得到阳性结果的概率：$P(B|A^c) = 0.004$。\n\n从物种存在的先验概率，我们可以推导出物种不存在的先验概率：\n$$\nP(A^c) = 1 - P(A) = 1 - 0.35 = 0.65\n$$\n\n检测过程，在真实存在（$A$）的条件下，由两个连续且条件独立的阶段组成。设$C$为捕获至少一个目标DNA分子的事件，设$D$为qPCR成功扩增的事件。在存在$A$的条件下，阳性结果$B$的发生需要$C$和$D$同时发生。问题提供了：\n- 在存在的条件下，捕获的概率：$P(C|A) = 0.70$。\n- 在捕获且存在的条件下，扩增的概率：$P(D|C, A) = 0.90$。\n\n因为在物种存在的条件下这些阶段是条件独立的，所以在物种真实存在的条件下得到阳性结果的概率，$P(B|A)$，是这两个连续阶段概率的乘积：\n$$\nP(B|A) = P(C|A) \\times P(D|C, A) = 0.70 \\times 0.90 = 0.63\n$$\n这个值，$P(B|A)$，是整个检测过程（野外采样和实验室分析相结合）的灵敏度。\n\n我们被要求计算在检测得出阳性结果的条件下，物种真实存在的后验概率。这即是条件概率$P(A|B)$。我们将使用贝叶斯定理，其定义如下：\n$$\nP(A|B) = \\frac{P(B|A) P(A)}{P(B)}\n$$\n分母$P(B)$是得到阳性结果的全概率。这可以使用全概率公式，通过根据物种的存在（$A$）或不存在（$A^c$）来划分事件空间进行计算：\n$$\nP(B) = P(B|A) P(A) + P(B|A^c) P(A^c)\n$$\n将已知值代入此表达式：\n$$\nP(B) = (0.63)(0.35) + (0.004)(0.65)\n$$\n首先，我们计算各个项：\n$$\nP(B|A) P(A) = 0.63 \\times 0.35 = 0.2205\n$$\n$$\nP(B|A^c) P(A^c) = 0.004 \\times 0.65 = 0.0026\n$$\n现在，我们将这些项相加，以求得阳性结果的全概率：\n$$\nP(B) = 0.2205 + 0.0026 = 0.2231\n$$\n计算出所有部分后，我们现在可以将它们代入贝叶斯定理，以求得后验概率$P(A|B)$：\n$$\nP(A|B) = \\frac{P(B|A) P(A)}{P(B)} = \\frac{0.2205}{0.2231}\n$$\n执行最后的除法：\n$$\nP(A|B) \\approx 0.988346033169...\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是$9$、$8$、$8$和$3$。第五位有效数字是$4$，小于$5$，所以我们舍去。\n$$\nP(A|B) \\approx 0.9883\n$$\n这就是在获得阳性eDNA结果的条件下，该物种真实存在的后验概率。", "answer": "$$\\boxed{0.9883}$$", "id": "2488011"}]}