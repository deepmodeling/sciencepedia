{"hands_on_practices": [{"introduction": "种群动态的随机性源于何处？一个根本来源是构成种群的个体在出生和死亡等事件上的偶然性。本练习从一个基本的生灭过程出发，推导由于个体事件的随机性而产生的种群动态方差，即人口随机性方差（demographic variance）[@problem_id:2535400]。通过这个练习，你将亲手将离散的个体层面事件与连续的种群层面模型联系起来，并理解为什么人口随机性的影响会随着种群数量 $N$ 的增大而减小。", "problem": "一个充分混合的种群经历出生和死亡，这是一个连续时间马尔可夫过程。在任何时候，给定丰度 $N0$，出生和死亡作为独立的泊松过程发生，其瞬时速率分别为 $bN$ 和 $dN$，其中 $b0$ 和 $d0$ 是人均速率。在一个短时间间隔 $\\Delta t$ 内，令 $\\Delta N$ 表示丰度的变化，并将人均增长率定义为丰度对数的瞬时变化率，即 $\\ln N$ 对时间的导数。丰度为 $N$ 时人均增长率的种群统计学方差定义为函数 $\\sigma_{d}^{2}(N)$，它满足以下条件性短时方差关系：\n$$\n\\operatorname{Var}\\!\\left[\\Delta \\ln N \\mid N\\right] \\;=\\; \\sigma_{d}^{2}(N)\\,\\Delta t \\;+\\; o(\\Delta t),\n$$\n其中 $\\Delta \\ln N \\equiv \\ln(N+\\Delta N)-\\ln N$。\n\n从这些假设和泊松过程的基本性质出发，推导出 $\\sigma_{d}^{2}(N)$ 作为 $b$、$d$ 和 $N$ 的封闭形式解析表达式。将您的最终结果以单一解析表达式的形式报告；不需要进行数值计算或四舍五入。", "solution": "该问题要求推导由连续时间生灭过程控制的种群的种群统计学方差 $\\sigma_{d}^{2}(N)$。种群丰度为 $N$，出生和死亡作为独立的泊松过程发生，其瞬时速率分别为 $bN$ 和 $dN$。\n\n设 $N_b(\\Delta t)$ 和 $N_d(\\Delta t)$ 分别为短时间间隔 $\\Delta t$ 内的出生和死亡数量。根据问题陈述，这些是服从泊松分布的独立随机变量：\n$$ N_b(\\Delta t) \\sim \\text{Poisson}(\\lambda_b = bN\\Delta t) $$\n$$ N_d(\\Delta t) \\sim \\text{Poisson}(\\lambda_d = dN\\Delta t) $$\n\n在此时间间隔内，种群大小的变化 $\\Delta N$ 为 $\\Delta N = N_b(\\Delta t) - N_d(\\Delta t)$。我们需要求 $\\Delta \\ln N = \\ln(N+\\Delta N) - \\ln N$ 的短时条件方差。种群统计学方差 $\\sigma_d^2(N)$ 由以下关系定义：\n$$ \\operatorname{Var}[\\Delta \\ln N \\mid N] = \\sigma_d^2(N) \\Delta t + o(\\Delta t) $$\n其中 $o(\\Delta t)$ 表示比 $\\Delta t$ 更快地趋于零的项。该公式表明，我们需要在离散生灭过程的扩散近似中找到过程 $y(t) = \\ln(N(t))$ 的扩散系数。\n\n推导此系数的一个标准方法是首先建立随机微分方程（SDE），或朗之万方程，来近似 $N(t)$ 的动力学，然后使用 Itō 引理来找到对应的 $\\ln(N(t))$ 的SDE。\n\n首先，我们确定增量 $\\Delta N$ 的前两阶矩，这将定义 $N(t)$ 的漂移系数和扩散系数。对于参数为 $\\lambda$ 的泊松分布，其均值和方差都等于 $\\lambda$。\n\n$\\Delta N$ 的条件期望是：\n$$ E[\\Delta N \\mid N] = E[N_b(\\Delta t)] - E[N_d(\\Delta t)] = \\lambda_b - \\lambda_d = (b-d)N\\Delta t $$\n\n由于出生和死亡过程的独立性，$\\Delta N$ 的条件方差是：\n$$ \\operatorname{Var}[\\Delta N \\mid N] = \\operatorname{Var}[N_b(\\Delta t)] + \\operatorname{Var}[N_d(\\Delta t)] = \\lambda_b + \\lambda_d = (b+d)N\\Delta t $$\n\n$\\Delta N$ 增量的均值和方差的这些表达式使我们能够写出 $N(t)$ 的朗之万方程：\n$$ dN = A(N) dt + \\sqrt{B(N)} dW_t $$\n其中 $A(N)$ 是漂移系数，$B(N)$ 是扩散系数。这些可以从增量的矩中求得：\n$$ A(N) = \\lim_{\\Delta t \\to 0} \\frac{E[\\Delta N \\mid N]}{\\Delta t} = (b-d)N $$\n$$ B(N) = \\lim_{\\Delta t \\to 0} \\frac{\\operatorname{Var}[\\Delta N \\mid N]}{\\Delta t} = (b+d)N $$\n因此，$N(t)$ 的SDE是：\n$$ dN = (b-d)N dt + \\sqrt{(b+d)N} dW_t $$\n其中 $dW_t$ 是标准维纳过程的增量。\n\n接下来，我们寻求变换后变量 $y(t) = \\ln(N(t))$ 的动力学。我们对函数 $f(N) = \\ln N$ 应用 Itō 引理：\n$$ df(N) = \\left( \\frac{\\partial f}{\\partial N}A(N) + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial N^2}B(N) \\right) dt + \\frac{\\partial f}{\\partial N}\\sqrt{B(N)}dW_t $$\n$f(N) = \\ln N$ 所需的导数是：\n$$ \\frac{\\partial f}{\\partial N} = \\frac{1}{N} $$\n$$ \\frac{\\partial^2 f}{\\partial N^2} = -\\frac{1}{N^2} $$\n将这些导数以及 $A(N)$ 和 $B(N)$ 的表达式代入 Itō 公式得到：\n$$ d(\\ln N) = \\left( \\left(\\frac{1}{N}\\right)(b-d)N + \\frac{1}{2}\\left(-\\frac{1}{N^2}\\right)(b+d)N \\right) dt + \\left(\\frac{1}{N}\\right)\\sqrt{(b+d)N}dW_t $$\n简化各项，我们得到：\n$$ d(\\ln N) = \\left( (b-d) - \\frac{b+d}{2N} \\right) dt + \\sqrt{\\frac{b+d}{N}}dW_t $$\n这是过程 $\\ln(N(t))$ 的朗之万方程。从这个形式，我们可以识别出 $\\ln N$ 的漂移系数和扩散系数。\n在一个时间步长 $\\Delta t$ 内的无穷小变化 $\\Delta \\ln N$ 可以写为：\n$$ \\Delta \\ln N = \\left( (b-d) - \\frac{b+d}{2N} \\right) \\Delta t + \\sqrt{\\frac{b+d}{N}} \\Delta W_t $$\n其中 $\\Delta W_t$ 是一个均值为 $0$、方差为 $\\Delta t$ 的正态分布随机变量。\n\n因此，$\\Delta \\ln N$ 的条件方差是：\n$$ \\operatorname{Var}[\\Delta \\ln N \\mid N] = \\operatorname{Var}\\left[ \\left( (b-d) - \\frac{b+d}{2N} \\right) \\Delta t + \\sqrt{\\frac{b+d}{N}} \\Delta W_t \\right] $$\n$$ \\operatorname{Var}[\\Delta \\ln N \\mid N] = \\operatorname{Var}\\left[ \\sqrt{\\frac{b+d}{N}} \\Delta W_t \\right] = \\left(\\frac{b+d}{N}\\right) \\operatorname{Var}[\\Delta W_t] = \\left(\\frac{b+d}{N}\\right) \\Delta t $$\n将此结果与给定定义 $\\operatorname{Var}[\\Delta \\ln N \\mid N] = \\sigma_d^2(N) \\Delta t + o(\\Delta t)$ 进行比较，我们可以直接确定种群统计学方差项 $\\sigma_d^2(N)$。\n\n$$ \\sigma_d^2(N) = \\frac{b+d}{N} $$\n这个表达式表示了由于单个出生和死亡事件的随机性导致的人均增长率的方差。", "answer": "$$ \\boxed{\\frac{b+d}{N}} $$", "id": "2535400"}, {"introduction": "除了个体层面的偶然性，环境波动是影响种群动态的另一个主要随机来源。本练习将环境随机性引入经典的逻辑斯谛增长模型，并使用随机微积分中的核心工具——伊藤引理（Itô's lemma）[@problem_id:2535419]。你将推导对数变换后种群动态的随机微分方程，并揭示一个关键的“伊藤修正项”，它解释了环境波动如何系统性地降低种群的有效增长率，这是随机动力学中一个深刻且反直觉的结果。", "problem": "在恒定环境中，单一物种种群通常由具有内禀增长率 $r$ 和环境承载力 $K$ 的确定性逻辑斯谛增长模型来描述。假设环境随机性以乘法方式作用于人均增长率，代表非生物条件的随机波动，并被建模为由维纳过程 $W_t$ 驱动、强度为 $\\sigma$ 的高斯环境噪声。在随机微积分的 Itô 解释下进行计算。\n\n从确定性逻辑斯谛形式出发，并根据环境变率乘以人均增长率的建模假设，写出在 Itô 解释下种群大小 $N(t)$ 的随机微分方程（SDE）。然后，通过对变换 $X(t)=\\ln N(t)$ 应用 Itô 引理，推导 $X(t)$ 的 SDE，并明确指出由 $\\ln$ 变换的曲率产生的漂移项中的 Itô 修正项。\n\n将最终答案表示为 $X(t)$ 的 SDE 的漂移函数的解析表达式，该表达式用 $X$、$r$、$K$ 和 $\\sigma$ 表示。不要写成方程形式；仅给出漂移函数的单一表达式。不需要进行数值评估，也不需要四舍五入。", "solution": "所述问题具有科学依据，数学上适定，客观且自洽。它代表了随机种群动态学（数学生态学的一个分支学科）领域中一个标准的、非平凡的练习。所有必要的参数和建模假设都已清晰给出。因此，该问题是有效的，我们开始进行推导。\n\n出发点是种群大小为 $N(t)$ 的确定性逻辑斯谛增长方程：\n$$\n\\frac{dN}{dt} = rN\\left(1 - \\frac{N}{K}\\right)\n$$\n此处，$r$ 是内禀增长率，$K$ 是环境承载力。人均增长率为 $\\frac{1}{N}\\frac{dN}{dt}$，由下式给出：\n$$\n\\frac{1}{N}\\frac{dN}{dt} = r\\left(1 - \\frac{N}{K}\\right)\n$$\n问题指明，环境随机性（建模为来自维纳过程 $W_t$、强度为 $\\sigma$ 的高斯噪声）以乘法方式作用于此人均增长率。在 Itô 解释下，随机人均增长率可写为 $r\\left(1 - \\frac{N_t}{K}\\right)dt + \\sigma dW_t$。种群的总变化量 $dN_t$ 是种群大小 $N_t$ 乘以这个随机人均增长率。这就得到了 $N(t)$ 的随机微分方程（SDE）：\n$$\ndN_t = N_t \\left[ r\\left(1 - \\frac{N_t}{K}\\right)dt + \\sigma dW_t \\right]\n$$\n这可以写成标准形式 $dN_t = a(N_t)dt + b(N_t)dW_t$，其中漂移函数为 $a(N_t) = rN_t\\left(1 - \\frac{N_t}{K}\\right)$，扩散函数为 $b(N_t) = \\sigma N_t$。\n\n下一步是求变换后变量 $X(t) = \\ln N(t)$ 的 SDE。我们对随机过程 $N_t$ 的函数 $f(N_t)$ 应用 Itô 引理。令 $f(N) = \\ln N$。$f$ 对 $N$ 的必要偏导数是：\n$$\n\\frac{\\partial f}{\\partial N} = \\frac{1}{N}\n$$\n$$\n\\frac{\\partial^2 f}{\\partial N^2} = -\\frac{1}{N^2}\n$$\nItô 引理指出 $X_t = f(N_t)$ 的微分是：\n$$\ndX_t = \\left[ \\frac{\\partial f}{\\partial N}a(N_t) + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial N^2}\\left(b(N_t)\\right)^2 \\right]dt + \\frac{\\partial f}{\\partial N}b(N_t)dW_t\n$$\n我们将 $a(N_t)$、$b(N_t)$ 和 $f(N)$ 的导数的表达式代入此公式。\n\n$dX_t$ 过程的漂移项是 $dt$ 的系数：\n$$\n\\text{Drift}(X_t) = \\frac{\\partial f}{\\partial N}a(N_t) + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial N^2}\\left(b(N_t)\\right)^2\n$$\n代入具体的函数：\n$$\n\\text{Drift}(X_t) = \\left(\\frac{1}{N_t}\\right) \\left[rN_t\\left(1 - \\frac{N_t}{K}\\right)\\right] + \\frac{1}{2}\\left(-\\frac{1}{N_t^2}\\right)\\left(\\sigma N_t\\right)^2\n$$\n简化此表达式：\n$$\n\\text{Drift}(X_t) = r\\left(1 - \\frac{N_t}{K}\\right) - \\frac{1}{2}\\frac{1}{N_t^2}\\sigma^2 N_t^2\n$$\n$$\n\\text{Drift}(X_t) = r\\left(1 - \\frac{N_t}{K}\\right) - \\frac{1}{2}\\sigma^2\n$$\n$-\\frac{1}{2}\\sigma^2$ 项是 Itô 修正项。它源于对数变换的非线性（即 $\\frac{\\partial^2 f}{\\partial N^2} \\neq 0$）。这个修正是 Itô 微积分的一个决定性特征，它解释了波动性对变换后过程漂移的影响。\n\n$dX_t$ 过程的扩散项是 $dW_t$ 的系数：\n$$\n\\text{Diffusion}(X_t) = \\frac{\\partial f}{\\partial N}b(N_t) = \\left(\\frac{1}{N_t}\\right)\\left(\\sigma N_t\\right) = \\sigma\n$$\n因此，$X(t)$ 的 SDE 是：\n$$\ndX_t = \\left[ r\\left(1 - \\frac{N_t}{K}\\right) - \\frac{1}{2}\\sigma^2 \\right]dt + \\sigma dW_t\n$$\n问题要求漂移函数的最终表达式用 $X$ 表示。由于 $X(t) = \\ln N(t)$，我们有 $N(t) = \\exp(X(t))$。我们将此代入漂移表达式：\n$$\n\\text{Drift}(X) = r\\left(1 - \\frac{\\exp(X)}{K}\\right) - \\frac{1}{2}\\sigma^2\n$$\n这就是所要求的对数变换后种群大小的漂移的解析表达式。", "answer": "$$\n\\boxed{r\\left(1 - \\frac{\\exp(X)}{K}\\right) - \\frac{1}{2}\\sigma^2}\n$$", "id": "2535419"}, {"introduction": "建立随机模型后，生态学家的一个核心任务是从实际观测数据中估计模型参数。本练习将理论与实践联系起来，指导你如何为一个随机指数增长模型推导其参数的最大似然估计（MLEs）[@problem_id:2535427]。通过构建似然函数并进行优化，你将掌握从时间序列数据中量化增长率 $r$ 和环境噪声强度 $\\sigma$ 的基本统计技能，这是将随机理论应用于真实世界数据的关键一步。", "problem": "一个单一物种的封闭种群在连续时间内经历随机指数增长。令 $N_t$ 表示在时间 $t$ 的真实丰度，对于所有 $t$，$N_t \\in (0,\\infty)$。假设丰度的对数 $X_t \\equiv \\ln N_t$ 服从随机微分方程（SDE；stochastic differential equation）\n$$\n\\mathrm{d}X_t \\;=\\; r\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $r \\in \\mathbb{R}$ 是内禀人均增长率，$\\sigma \\in (0,\\infty)$ 是环境随机性的大小，$W_t$ 是标准布朗运动。你在严格递增的时间点 $0 = t_0  t_1  \\cdots  t_m$ 对丰度进行了 $m+1$ 次精确、无噪声的观测，得到 $\\{N_{t_i}\\}_{i=0}^m$，其中 $N_{t_0}$ 已知。记 $\\Delta_i \\equiv t_i - t_{i-1}$，其中 $i \\in \\{1,\\dots,m\\}$。\n\n仅使用上述 SDE、布朗运动增量的基本性质以及基础概率论，完成以下任务：\n\n- 对每个 $i \\in \\{1,\\dots,m\\}$，推导条件转移密度 $p(N_{t_i}\\mid N_{t_{i-1}}; r,\\sigma)$，并从第一性原理证明其形式。\n- 利用 SDE 所蕴含的马尔可夫性质，在不重叠的布朗运动增量相互独立的假设下，构建完整似然函数 $L(r,\\sigma \\mid \\{N_{t_i}\\}_{i=0}^m)$。\n- 以观测序列 $\\{N_{t_i}\\}_{i=0}^m$ 和抽样间隔 $\\{\\Delta_i\\}_{i=1}^m$ 为基础，求出 $r$ 和 $\\sigma$ 的闭式最大似然估计量（MLEs；maximum likelihood estimators）。\n\n你的最终估计量必须只用观测到的对数增量 $Y_i \\equiv \\ln N_{t_i} - \\ln N_{t_{i-1}}$ 和 $\\Delta_i$ 来表示。你的最终答案必须是一个单一的解析表达式，包含按答案说明中指定的行矩阵排列的两个估计量。不需要进行数值计算或四舍五入。假设 $m \\ge 1$ 且所有 $N_{t_i} \\in (0,\\infty)$ 都是精确已知的。", "solution": "该问题陈述具有科学依据、问题设定良好、客观且自洽。它描述了随机过程统计推断中的一个标准且基本的任务，特别是从离散时间观测中对几何布朗运动进行参数估计。所有必要的组成部分都已提供，没有矛盾或歧义。该问题是有效的。我们开始解题。\n\n该问题要求推导随机指数增长模型参数的最大似然估计量。物种丰度 $N_t$ 所遵循的过程，其对数 $X_t = \\ln N_t$ 由算术布朗运动随机微分方程（SDE）控制：\n$$\n\\mathrm{d}X_t = r\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\n该模型意味着 $N_t = \\exp(X_t)$ 服从几何布朗运动。我们在时间点 $0=t_0  t_1  \\dots  t_m$ 获得了 $m+1$ 次丰度的离散观测值 $\\{N_{t_i}\\}_{i=0}^m$。\n\n首先，我们推导条件转移密度 $p(N_{t_i} \\mid N_{t_{i-1}}; r,\\sigma)$。为此，我们在单个观测区间 $[t_{i-1}, t_i]$ 上对 $X_t$ 的 SDE 进行积分。\n$$\n\\int_{t_{i-1}}^{t_i} \\mathrm{d}X_t = \\int_{t_{i-1}}^{t_i} r\\,\\mathrm{d}t + \\int_{t_{i-1}}^{t_i} \\sigma\\,\\mathrm{d}W_t\n$$\n$$\nX_{t_i} - X_{t_{i-1}} = r(t_i - t_{i-1}) + \\sigma(W_{t_i} - W_{t_{i-1}})\n$$\n令 $\\Delta_i = t_i - t_{i-1}$。标准布朗运动 $W_t$ 的一个基本性质是其在不重叠区间上的增量是独立且服从正态分布的。具体来说，增量 $W_{t_i} - W_{t_{i-1}}$ 是一个随机变量，其分布为 $\\mathcal{N}(0, t_i - t_{i-1})$，即 $W_{t_i} - W_{t_{i-1}} \\sim \\mathcal{N}(0, \\Delta_i)$。\n因此，项 $\\sigma(W_{t_i} - W_{t_{i-1}})$ 也服从正态分布：$\\sigma(W_{t_i} - W_{t_{i-1}}) \\sim \\mathcal{N}(0, \\sigma^2 \\Delta_i)$。\n对数增量，我们记为 $Y_i \\equiv X_{t_i} - X_{t_{i-1}} = \\ln N_{t_i} - \\ln N_{t_{i-1}}$，是确定性漂移项 $r\\Delta_i$ 和随机项的和。因此，其在给定 $X_{t_{i-1}}$ 下的条件分布是正态的：\n$$\nY_i \\mid X_{t_{i-1}} \\sim \\mathcal{N}(r\\Delta_i, \\sigma^2\\Delta_i)\n$$\n等价地，$X_{t_i}$ 在给定 $X_{t_{i-1}}$ 下的条件分布为：\n$$\nX_{t_i} \\mid X_{t_{i-1}} \\sim \\mathcal{N}(X_{t_{i-1}} + r\\Delta_i, \\sigma^2\\Delta_i)\n$$\n$X_{t_i}$ 的条件概率密度函数（PDF）为：\n$$\np(X_{t_i} \\mid X_{t_{i-1}}; r, \\sigma) = \\frac{1}{\\sqrt{2\\pi\\sigma^2\\Delta_i}} \\exp\\left(-\\frac{(X_{t_i} - (X_{t_{i-1}} + r\\Delta_i))^2}{2\\sigma^2\\Delta_i}\\right)\n$$\n为了求出所需的 $N_{t_i}$ 的转移密度，我们应用概率密度的变量转换公式。给定变换 $X_t = \\ln N_t$，变换的雅可比行列式为 $|\\frac{\\mathrm{d}X_{t_i}}{\\mathrm{d}N_{t_i}}| = |\\frac{1}{N_{t_i}}| = \\frac{1}{N_{t_i}}$，因为 $N_{t_i}  0$。\n$$\np(N_{t_i} \\mid N_{t_{i-1}}; r, \\sigma) = p(X_{t_i}=\\ln N_{t_i} \\mid X_{t_{i-1}}=\\ln N_{t_{i-1}}; r, \\sigma) \\cdot \\frac{1}{N_{t_i}}\n$$\n代入 $X_{t_i}$ 和 $X_{t_{i-1}}$ 的表达式，得到转移密度，这是一个对数正态 PDF：\n$$\np(N_{t_i} \\mid N_{t_{i-1}}; r, \\sigma) = \\frac{1}{N_{t_i}\\sqrt{2\\pi\\sigma^2\\Delta_i}} \\exp\\left(-\\frac{(\\ln N_{t_i} - \\ln N_{t_{i-1}} - r\\Delta_i)^2}{2\\sigma^2\\Delta_i}\\right)\n$$\n\n其次，我们构建似然函数。SDE 定义了一个马尔可夫过程，且布朗运动在不重叠时间区间上的增量的独立性意味着对数增量 $\\{Y_i\\}_{i=1}^m$ 是相互独立的随机变量。因此，在给定初始状态 $N_{t_0}$ 的情况下，观测序列 $\\{N_{t_i}\\}_{i=1}^m$ 的联合概率是各个条件转移概率的乘积：\n$$\nL(r, \\sigma) = p(N_{t_1}, \\dots, N_{t_m} \\mid N_{t_0}; r, \\sigma) = \\prod_{i=1}^m p(N_{t_i} \\mid N_{t_{i-1}}; r, \\sigma)\n$$\n代入推导出的密度并使用简写 $Y_i = \\ln N_{t_i} - \\ln N_{t_{i-1}}$：\n$$\nL(r, \\sigma) = \\prod_{i=1}^m \\frac{1}{N_{t_i}\\sqrt{2\\pi\\sigma^2\\Delta_i}} \\exp\\left(-\\frac{(Y_i - r\\Delta_i)^2}{2\\sigma^2\\Delta_i}\\right)\n$$\n处理对数似然函数 $\\ell(r,\\sigma) = \\ln L(r,\\sigma)$ 更为方便：\n$$\n\\ell(r, \\sigma) = \\sum_{i=1}^m \\left[ -\\ln(N_{t_i}) - \\frac{1}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\sigma^2\\Delta_i) - \\frac{(Y_i - r\\Delta_i)^2}{2\\sigma^2\\Delta_i} \\right]\n$$\n为了对 $r$ 和 $\\sigma$ 进行最大化，我们可以忽略不依赖于这些参数的项。对数似然函数的相关部分，我们记为 $\\ell^*$，是：\n$$\n\\ell^*(r, \\sigma) = \\sum_{i=1}^m \\left[ - \\ln(\\sigma) - \\frac{(Y_i - r\\Delta_i)^2}{2\\sigma^2\\Delta_i} \\right] = -m\\ln(\\sigma) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^m \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i}\n$$\n\n第三，我们通过求 $\\ell^*$ 对 $r$ 和 $\\sigma$ 的偏导数并将其设为零，来找到最大似然估计量（MLEs）$\\hat{r}$ 和 $\\hat{\\sigma}$。\n为了求出 $\\hat{r}$，我们对 $r$ 求导：\n$$\n\\frac{\\partial \\ell^*}{\\partial r} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^m \\frac{\\partial}{\\partial r} \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^m \\frac{2(Y_i - r\\Delta_i)(-\\Delta_i)}{\\Delta_i} = \\frac{1}{\\sigma^2} \\sum_{i=1}^m (Y_i - r\\Delta_i)\n$$\n将导数设为零，得到估计量 $\\hat{r}$ 的方程：\n$$\n\\frac{1}{\\sigma^2} \\sum_{i=1}^m (Y_i - \\hat{r}\\Delta_i) = 0 \\quad\\implies\\quad \\sum_{i=1}^m Y_i = \\hat{r}\\sum_{i=1}^m \\Delta_i\n$$\n解出 $\\hat{r}$ 得：\n$$\n\\hat{r} = \\frac{\\sum_{i=1}^m Y_i}{\\sum_{i=1}^m \\Delta_i}\n$$\n为了求出 $\\hat{\\sigma}$，我们对 $\\sigma$ 求 $\\ell^*$ 的导数：\n$$\n\\frac{\\partial \\ell^*}{\\partial \\sigma} = -\\frac{m}{\\sigma} - \\sum_{i=1}^m \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i} \\left(-\\frac{1}{\\sigma^3}\\right) = -\\frac{m}{\\sigma} + \\frac{1}{\\sigma^3}\\sum_{i=1}^m \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i}\n$$\n将导数设为零，并用 $\\hat{r}$ 代替 $r$，得到 $\\hat{\\sigma}$ 的方程：\n$$\n-\\frac{m}{\\hat{\\sigma}} + \\frac{1}{\\hat{\\sigma}^3}\\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i} = 0\n$$\n乘以 $\\hat{\\sigma}^3$（因为 $\\sigma \\in (0,\\infty)$，所以 $\\hat{\\sigma} \\ne 0$）：\n$$\n-m\\hat{\\sigma}^2 + \\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i} = 0\n$$\n解出 $\\hat{\\sigma}^2$，得到方差的 MLE：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{m} \\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i}\n$$\n根据 MLEs 的不变性，$\\sigma$ 的估计量是 $\\sigma^2$ 估计量的平方根：\n$$\n\\hat{\\sigma} = \\left(\\frac{1}{m} \\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i}\\right)^{\\frac{1}{2}}\n$$\n将 $\\hat{r}$ 的完整表达式代入 $\\hat{\\sigma}$ 的公式中，得到仅用数据 $\\{Y_i, \\Delta_i\\}$ 表示的最终显式估计量，正如题目所要求。\n$$\n\\hat{r} = \\frac{\\sum_{i=1}^m Y_i}{\\sum_{i=1}^m \\Delta_i}\n$$\n$$\n\\hat{\\sigma} = \\left(\\frac{1}{m} \\sum_{i=1}^m \\frac{\\left(Y_i - \\Delta_i \\frac{\\sum_{j=1}^m Y_j}{\\sum_{j=1}^m \\Delta_j}\\right)^2}{\\Delta_i}\\right)^{\\frac{1}{2}}\n$$\n这些就是参数 $r$ 和 $\\sigma$ 的闭式最大似然估计量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sum_{i=1}^m Y_i}{\\sum_{i=1}^m \\Delta_i}  \\left(\\frac{1}{m} \\sum_{i=1}^m \\frac{1}{\\Delta_i}\\left(Y_i - \\frac{\\Delta_i \\sum_{j=1}^m Y_j}{\\sum_{j=1}^m \\Delta_j}\\right)^2\\right)^{\\frac{1}{2}}\n\\end{pmatrix}\n}\n$$", "id": "2535427"}]}