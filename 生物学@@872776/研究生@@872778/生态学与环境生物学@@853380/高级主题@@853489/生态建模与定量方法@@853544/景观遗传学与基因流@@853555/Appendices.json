{"hands_on_practices": [{"introduction": "景观遗传学的一个核心任务是量化种群间的基因流。固定指数 $F_{ST}$ 为我们提供了衡量遗传结构的经验指标，但它如何与实际迁移的个体数量相关联？本练习将引导你运用经典的岛屿模型框架，推导并应用 $F_{ST}$ 与每代有效迁移个体数 $N_e m$ 之间的基本关系，从而将可观察到的遗传模式直接转化为关键的人口统计学参数。[@problem_id:2501749]", "problem": "一个植物集合种群占据着一个由许多斑块组成的景观，这些斑块通过花粉和种子扩散相连。对许多斑块的中性位点进行遗传取样，得出亚群间的标准化固定指数（F-统计量）估计值为 $F_{ST}=0.05$。假设亚群数量众多，有效种群大小（$N_{e}$）相等，每一代以对称的迁移率 $m$（每一代中一个亚群基因库中新迁入个体基因所占的比例）交换迁移个体，并且该系统在经典的不重叠世代和中性的无限岛屿模型下处于迁移-漂变平衡状态。一项独立的种群统计学研究估计每个亚群的 $N_{e}=500$。\n\n从中性等位基因在岛屿模型中的核心漂变-迁移平衡框架以及 $F_{ST}$ 作为亚群间等位基因频率的标准化方差的定义出发，推导仅用 $F_{ST}$ 表示的复合迁移参数 $N_{e}m$ 的表达式。然后，当 $F_{ST}=0.05$ 时，计算其值。最后，根据岛屿模型中漂变和基因流的基本原理，阐明该系统中的基因流是否足够强大以对抗局部的遗传漂变，并用一两句话说明你的理由。报告 $N_{e}m$ 的最终数值；无需单位，也无需四舍五入。", "solution": "该问题要求在无限岛屿模型处于迁移-漂变平衡的假设下，从固定指数 $F_{ST}$ 推导出复合参数 $N_{e}m$。然后，要求进行数值计算，并在基因流和遗传漂变之间平衡的背景下解释结果。\n\n其核心原理是作用于中性等位基因的两种相反进化力量之间的平衡。在有限有效种群大小（$N_{e}$）的亚群内部，遗传漂变导致等位基因频率发生分歧，从而增加了它们之间的遗传分化。由迁移率（$m$）代表的基因流，从一个共同的迁移库中引入等位基因，这会使等位基因频率均质化并抵消分化。标准化固定指数 $F_{ST}$ 是衡量这种分化的指标。在平衡状态下，由漂变产生分化的速率与由基因流消除分化的速率完全相等。\n\n我们可以通过考虑从同一亚群中抽取的两个等位基因同源相同的概率（$F_{ST}$）来形式化这种平衡。遗传漂变会增加这个概率。在一个有效大小为 $N_{e}$ 的二倍体种群中，如果没有其他力量作用，在一代随机交配中，同源相同的概率增加量由变化 $\\Delta F_{\\text{drift}}$ 给出。对于下一代抽取的两个等位基因，如果它们是同一个亲本等位基因的拷贝（概率为 $\\frac{1}{2N_{e}}$），或者它们是不同亲本等位基因的拷贝（概率为 $1 - \\frac{1}{2N_{e}}$）且这些亲本等位基因在上一代已经同源相同（概率为 $F_{ST}$），那么这两个等位基因就是同源相同的。新的概率是 $F' = \\frac{1}{2N_{e}} + (1 - \\frac{1}{2N_{e}})F_{ST}$。因此，由漂变引起的变化是 $\\Delta F_{\\text{drift}} = F' - F_{ST} = \\frac{1 - F_{ST}}{2N_{e}}$。\n\n基因流降低了同源相同的概率。在岛屿模型中，任何一个亚群中都有比例为 $m$ 的等位基因是来自整个集合种群的迁移者。我们假设迁移等位基因是从一个概念上无限大的基因库中抽取的，因此它们在到达时彼此之间或与本地等位基因之间绝不同源相同。要使从一个亚群中抽样的两个等位基因因在该亚群内的祖先关系而同源相同，两者都必须是非迁移者。这种情况的概率是 $(1-m)^{2}$。因此，每一代基因流都使局部同源相同的概率降低一个因子 $(1-m)^{2}$。当 $m$ 很小时，我们可以将这个因子近似为 $(1-m)^{2} \\approx 1-2m$。因此，由迁移引起的 $F_{ST}$ 变化近似为 $\\Delta F_{\\text{migration}} \\approx -2m F_{ST}$。\n\n在平衡状态下，净变化为零：$\\Delta F_{\\text{drift}} + \\Delta F_{\\text{migration}} = 0$。\n$$\n\\frac{1 - F_{ST}}{2N_{e}} - 2m F_{ST} \\approx 0\n$$\n$$\n\\frac{1 - F_{ST}}{2N_{e}} \\approx 2m F_{ST}\n$$\n重新整理这个方程以求解 $F_{ST}$，我们得到：\n$$\n1 - F_{ST} \\approx 4N_{e}m F_{ST}\n$$\n$$\n1 \\approx F_{ST} + 4N_{e}m F_{ST} = F_{ST}(1 + 4N_{e}m)\n$$\n这得出了经典的近似关系式：\n$$\nF_{ST} \\approx \\frac{1}{1 + 4N_{e}m}\n$$\n这个公式是群体遗传学的基础，它直接将遗传结构（$F_{ST}$）与漂变（与 $N_{e}$ 相关）和基因流（$m$）的种群过程联系起来。\n\n第一个任务是推导仅用 $F_{ST}$ 表示的复合参数 $N_{e}m$ 的表达式。我们重新整理上述表达式：\n$$\n1 + 4N_{e}m = \\frac{1}{F_{ST}}\n$$\n$$\n4N_{e}m = \\frac{1}{F_{ST}} - 1 = \\frac{1 - F_{ST}}{F_{ST}}\n$$\n$$\nN_{e}m = \\frac{1 - F_{ST}}{4F_{ST}}\n$$\n这就是所求的表达式。所提供的 $N_{e} = 500$ 是一致的种群统计学信息，但计算这一部分并不需要它，因为计算完全基于 $F_{ST}$ 中编码的遗传数据。\n\n第二个任务是计算当 $F_{ST} = 0.05$ 时该表达式的值。\n$$\nN_{e}m = \\frac{1 - 0.05}{4(0.05)} = \\frac{0.95}{0.20} = 4.75\n$$\n复合参数 $N_{e}m$ 代表每一代进入一个亚群的有效迁移个体数量。\n\n最后，我们必须评估基因流是否足够强大以对抗局部的遗传漂变。由 Sewall Wright 提出的一个广泛使用的经验法则是，如果 $N_e m > 1$，基因流就足够强大，可以防止亚群间出现显著分化；而如果 $N_e m  1$，则漂变占主导地位，导致显著的趋异。在这个系统中，$N_{e}m = 4.75$，显著大于 $1$。因此，基因流确实足够强大，足以克服局部遗传漂变的分化效应，从而维持一个相互连接的集合种群，而不是一堆孤立的、不断分化的亚群。", "answer": "$$\n\\boxed{4.75}\n$$", "id": "2501749"}, {"introduction": "基因流并非在真空中发生，而是受到景观本身的塑造。为了对此进行建模，我们常常将景观表示为“阻力面”，其中不同生境对生物体的移动构成不同程度的困难。本练习介绍了“最小成本路径”（Least-Cost Path, LCP）这一基本概念，即在此类表面上两点之间的最有效路径。通过一个简单的一维栅格示例，你将为景观特征如何引导或阻碍扩散建立直观理解，这是连通性建模的基石。[@problem_id:2501802]", "problem": "一个沿一维生境廊道扩散的生物体由一个栅格表示，该栅格由三个线性排列的连续单元格组成，从左到右的单元格阻力（无量纲的移动成本）为 $\\left(1, 10, 1\\right)$。端点分别固定在最左侧和最右侧单元格的中心。移动仅限于相邻单元格（在此一维设置中为四邻域连接），从单元格 $i$ 到相邻单元格 $j$ 一步的成本定义为两个单元格阻力的算术平均值乘以它们中心之间的欧几里得距离。每个方形单元格的边长为 $1$，因此每一步的长度也是 $1$。\n\n从最小成本路径距离的定义（即在所有允许路径中，沿某路径的步进成本之和的最小值）出发，计算两个端点之间的最小成本路径距离。将最终答案表示为一个精确的单一数值（无量纲）。无需四舍五入。\n\n在您的解答中，还请从第一性原理出发，论证为何在一般情况下，当二维嵌入中存在备选的平行路径时，基于电路的距离（根据电阻性景观上的电网络类比计算出的有效电阻）可能低于仅由中心高成本单元格所暗示的值，尽管在这个线性的三单元格廊道中只有一条路径。您的论证必须从电阻的串并联规则和有效电阻的最小能量特性出发，并定性地解释额外的平行通路如何通过分散电流来降低有效电阻。最终报告的答案应仅为如上所述的最小成本路径距离。", "solution": "我们从栅格景观中最小成本路径距离的定义开始。路径 $\\mathcal{P}$ 是连接源点与终点的一系列相邻单元格。从单元格 $i$ 移动到相邻单元格 $j$ 一步的成本由下式给出：\n$$\nc_{ij} \\;=\\; \\frac{r_{i}+r_{j}}{2}\\, d_{ij},\n$$\n其中 $r_{i}$ 和 $r_{j}$ 是单元格阻力，$d_{ij}$ 是单元格中心之间的欧几里得距离。一条路径 $\\mathcal{P}$ 的累积成本是沿着路径中所有步 $(i,j)\\in \\mathcal{P}$ 的 $c_{ij}$ 之和。最小成本路径距离是连接端点的所有允许路径中该总和的最小值。\n\n在这个具有三个单元格且端点位于最左侧和最右侧单元格中心的一维廊道中，只有一条允许的路径，它包括两步：从左侧单元格到中心单元格，以及从中心单元格到右侧单元格。设阻力分别为 $r_{L}=1$，$r_{C}=10$ 和 $r_{R}=1$。单元格边长为 $1$，因此每步的长度为 $d_{LC}=1$ 和 $d_{CR}=1$。\n\n计算每一步的成本：\n- 从左到中心的步：\n$$\nc_{LC} \\;=\\; \\frac{r_{L}+r_{C}}{2}\\, d_{LC} \\;=\\; \\frac{1+10}{2}\\cdot 1 \\;=\\; \\frac{11}{2}.\n$$\n- 从中心到右的步：\n$$\nc_{CR} \\;=\\; \\frac{r_{C}+r_{R}}{2}\\, d_{CR} \\;=\\; \\frac{10+1}{2}\\cdot 1 \\;=\\; \\frac{11}{2}.\n$$\n\n这条唯一路径的累积成本是\n$$\nC_{\\text{LCP}} \\;=\\; c_{LC} + c_{CR} \\;=\\; \\frac{11}{2} + \\frac{11}{2} \\;=\\; 11.\n$$\n由于在一维三单元格链中没有其他路径，这条唯一的路径自然就是最小成本路径，因此最小成本路径距离等于 $11$。\n\n现在，我们来论证为何在二维嵌入中存在备选平行路径时，基于电路的距离（有效电阻）可能低于中心高成本单元格所暗示的值，尽管在这个线性链中并不存在平行路径。电网络类比通过在单元格中心设置节点，并根据景观的阻力场为相邻节点之间分配电导，来模拟在电阻性景观中的移动。当只有一条串联链连接端点时，有效电阻是串联边电阻的总和，这与单一路径约束一致：\n$$\nR_{\\text{series}} \\;=\\; R_{1} + R_{2} + \\cdots,\n$$\n因此，在严格的一维链中，除了求和之外没有其他缩减。然而，在具有多种可能路径的二维景观中，额外的连接会产生并联或网状结构。对于并联的电阻，其组合电阻 $R_{\\parallel}$ 遵循\n$$\n\\frac{1}{R_{\\parallel}} \\;=\\; \\sum_{k} \\frac{1}{R_{k}},\n$$\n这意味着\n$$\nR_{\\parallel}  \\min_{k} R_{k}.\n$$\n因此，任何增加的平行通路都会相对于任何单一路径降低总有效电阻，因为总电导通过求和而增加。\n\n更一般地，两个边界节点之间的有效电阻可以用 Thomson 原理（也称为最小能量原理）来描述：在所有满足内部节点流量守恒的从源到汇的单位电流流 $\\mathbf{f}$ 中，有效电阻 $R_{\\text{eff}}$ 等于最小耗散功率，\n$$\nR_{\\text{eff}} \\;=\\; \\min_{\\mathbf{f}} \\sum_{e} r_{e}\\, f_{e}^{2},\n$$\n其中 $r_{e}$ 和 $f_{e}$ 分别是边 $e$ 上的电阻和电流。增加备选路径为单位电流的分布引入了额外的自由度，允许电流避开或部分绕过高电阻边，从而降低二次型的最小值。这是凸性和 Rayleigh 单调性定律的直接结果：增加任何边的电阻都不会使 $R_{\\text{eff}}$ 减小，而增加一条具有有限电导的备选边（或路径）也不会使 $R_{\\text{eff}}$ 增大。因此，在具有多条路径的二维景观中，基于电路的距离通常会产生比单一高成本瓶颈所暗示的更低的有效电阻，因为电流会在多条路径中分配以减少总能量耗散。在当前的一维三单元格廊道中，这种分配是不可能的，因此最小成本路径和基于电路的距离都受制于必须通过中心高阻力区域的移动，在一致的边电阻参数化下，其值等于串联总和。", "answer": "$$\\boxed{11}$$", "id": "2501802"}, {"introduction": "在量化了遗传分化并模拟了潜在的移动廊道之后，下一个合乎逻辑的步骤是检验连接这两者的假设。景观遗传学中的一个经典假设是“距离隔离”（Isolation by Distance, IBD），它假设遗传分化随地理距离的增加而增加。Mantel检验是评估两个距离矩阵（例如遗传距离和地理距离）之间相关性的标准统计工具。本动手练习将指导你从头开始实施Mantel检验，包括使用置换检验来评估统计显著性这一关键步骤，从而巩固你对该领域假设检验的理解。[@problem_id:2501780]", "problem": "给定成对的对称方阵，分别代表一组抽样种群的成对地理距离和成对遗传距离。您的任务是，对每一对矩阵，计算 Mantel 统计量 $r$（定义为两个距离矩阵的非对角线上三角元素之间的皮尔逊相关系数）及其双边显著性。显著性检验使用包含 $999$ 次置换的置换检验，其原假设为：在重新标记种群后，遗传距离和地理距离是独立的。地理距离的单位是公里，遗传距离是无量纲的，最终输出也是无量纲的。输出中无需包含单位。\n\n请使用以下通用假设和约束，它们是您进行推理和算法设计的唯一允许输入：\n- 对角线为零的对称距离矩阵表示 $n$ 个种群间的成对距离，对于所有给定的案例，$n = 5$。\n- 原假设下的独立性允许对种群标签进行置换；在无关联的原假设下，假定标签是可交换的。\n- Mantel 统计量 $r$ 是对两个矩阵的向量化上三角元素（不包括对角线）计算的皮尔逊相关系数。\n- 双边 $p$-值必须使用 Mantel 统计量的绝对值计算，并进行有限样本校正：$p = \\dfrac{b + 1}{N + 1}$，其中 $b$ 是满足 $|r_{\\text{perm}}| \\ge |r_{\\text{obs}}|$ 的置换次数，$N$ 是置换总次数（此处 $N = 999$）。\n- 为确保可复现性，在抽取置换之前，使用种子 $12345$ 初始化伪随机数生成器。\n\n请精确实现以下要求：\n- 对每个测试用例，计算 Mantel 统计量 $r$ 及使用 $N = 999$ 次置换计算的相关双边 $p$-值。\n- 对每个测试用例，使用完全相同的 $999$ 次独立抽取的置换。每次置换都是对 $n$ 个标签的均匀随机置换，并同时应用于遗传距离矩阵的行和列。\n- 输出时，将每个 $r$ 和 $p$ 值四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 $1$（正常路径；中等程度的距离隔离）：地理距离矩阵 $A_1$ 和遗传距离矩阵 $G_1$ 为\n  - $A_1 = \\begin{bmatrix}\n  0  1.000000  2.000000  1.000000  2.828427\\\\\n  1.000000  0  1.000000  1.414214  2.236068\\\\\n  2.000000  1.000000  0  2.236068  2.000000\\\\\n  1.000000  1.414214  2.236068  0  2.236068\\\\\n  2.828427  2.236068  2.000000  2.236068  0\n  \\end{bmatrix}$\n  - $G_1 = \\begin{bmatrix}\n  0  0.122000  0.239000  0.120000  0.343411\\\\\n  0.122000  0  0.121000  0.167706  0.271328\\\\\n  0.239000  0.121000  0  0.268328  0.237000\\\\\n  0.120000  0.167706  0.268328  0  0.270328\\\\\n  0.343411  0.271328  0.237000  0.270328  0\n  \\end{bmatrix}$\n- 案例 $2$（边界情况；完全线性关联）：地理距离矩阵 $A_2$ 和遗传距离矩阵 $G_2$ 为\n  - $A_2 = \\begin{bmatrix}\n  0  1  3  6  10\\\\\n  1  0  2  5  9\\\\\n  3  2  0  3  7\\\\\n  6  5  3  0  4\\\\\n  10  9  7  4  0\n  \\end{bmatrix}$\n  - $G_2 = \\begin{bmatrix}\n  0  2  6  12  20\\\\\n  2  0  4  10  18\\\\\n  6  4  0  6  14\\\\\n  12  10  6  0  8\\\\\n  20  18  14  8  0\n  \\end{bmatrix}$\n- 案例 $3$（边缘情况；弱关联或无关联）：地理距离矩阵 $A_3$ 和遗传距离矩阵 $G_3$ 为\n  - $A_3 = A_1$ (如上)\n  - $G_3 = \\begin{bmatrix}\n  0  0.210000  0.050000  0.180000  0.090000\\\\\n  0.210000  0  0.140000  0.070000  0.160000\\\\\n  0.050000  0.140000  0  0.110000  0.200000\\\\\n  0.180000  0.070000  0.110000  0  0.130000\\\\\n  0.090000  0.160000  0.200000  0.130000  0\n  \\end{bmatrix}$\n\n角度测量不适用。最终输出中不出现物理单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个结果列表，每个测试用例对应一个结果。每个结果是一个双元素列表 $[r, p]$，其中两个值都四舍五入到 $6$ 位小数。整体格式必须严格为 Python 风格的列表嵌套列表，例如：$[[r_1,p_1],[r_2,p_2],[r_3,p_3]]$。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知信息**\n\n- **任务**：为成对的对称平方距离矩阵计算 Mantel 统计量 $r$ 及其双边显著性 $p$-值。\n- **每个案例的数据**：一个地理距离矩阵 $A$ 和一个遗传距离矩阵 $G$。\n- **矩阵属性**：所有矩阵均为对称矩阵，对角线为零，大小为 $n \\times n$，其中 $n=5$。\n- **Mantel 统计量 $r$**：定义为两个矩阵的向量化上三角元素（不包括对角线）之间的皮尔逊相关系数。\n- **假设检验**：使用置换检验来评估在矩阵间独立的原假设下的显著性。\n- **置换**：置换次数 $N = 999$。通过重新标记种群来应用置换，这对应于同时置换一个矩阵的行和列。\n- **$p$-值计算**：双边 $p$-值使用公式 $p = \\dfrac{b + 1}{N + 1}$ 计算，其中 $b$ 是绝对置换统计量 $|r_{\\text{perm}}|$ 大于或等于绝对观测统计量 $|r_{\\text{obs}}|$ 的置换次数。\n- **可复现性**：伪随机数生成器必须用种子 $12345$ 初始化。每个测试用例必须使用同一组 $999$ 次置换。\n- **输出格式**：对每个案例，必须计算出数对 $[r, p]$，两个值均四舍五入到 $6$ 位小数。\n- **测试用例**：\n    - **案例 1**：矩阵 $A_1$ 和 $G_1$。\n      - $A_1 = \\begin{bmatrix}\n      0  1.000000  2.000000  1.000000  2.828427\\\\\n      1.000000  0  1.000000  1.414214  2.236068\\\\\n      2.000000  1.000000  0  2.236068  2.000000\\\\\n      1.000000  1.414214  2.236068  0  2.236068\\\\\n      2.828427  2.236068  2.000000  2.236068  0\n      \\end{bmatrix}$\n      - $G_1 = \\begin{bmatrix}\n      0  0.122000  0.239000  0.120000  0.343411\\\\\n      0.122000  0  0.121000  0.167706  0.271328\\\\\n      0.239000  0.121000  0  0.268328  0.237000\\\\\n      0.120000  0.167706  0.268328  0  0.270328\\\\\n      0.343411  0.271328  0.237000  0.270328  0\n      \\end{bmatrix}$\n    - **案例 2**：矩阵 $A_2$ 和 $G_2$。\n      - $A_2 = \\begin{bmatrix}\n      0  1  3  6  10\\\\\n      1  0  2  5  9\\\\\n      3  2  0  3  7\\\\\n      6  5  3  0  4\\\\\n      10  9  7  4  0\n      \\end{bmatrix}$\n      - $G_2 = \\begin{bmatrix}\n      0  2  6  12  20\\\\\n      2  0  4  10  18\\\\\n      6  4  0  6  14\\\\\n      12  10  6  0  8\\\\\n      20  18  14  8  0\n      \\end{bmatrix}$\n    - **案例 3**：矩阵 $A_3$ 和 $G_3$，其中 $A_3=A_1$。\n      - $G_3 = \\begin{bmatrix}\n      0  0.210000  0.050000  0.180000  0.090000\\\\\n      0.210000  0  0.140000  0.070000  0.160000\\\\\n      0.050000  0.140000  0  0.110000  0.200000\\\\\n      0.180000  0.070000  0.110000  0  0.130000\\\\\n      0.090000  0.160000  0.200000  0.130000  0\n      \\end{bmatrix}$\n\n**第二步：使用提取的已知信息进行验证**\n\n该问题具有科学依据。Mantel 检验是生态学和群体遗传学中评估两个距离矩阵之间相关性的标准统计方法，常用于检验“距离隔离”。统计量的公式和置换检验的程序都是标准的。该问题定义明确，提供了所有必要的数据、参数（$n=5, N=999$）、用于确保可复现性的特定伪随机数生成器种子、确切的 $p$-值计算公式以及清晰的指令。语言客观而精确。问题不含科学或事实上的不健全之处，是可形式化、完整且可行的。这是一个标准的、具有一定复杂度的统计计算。\n\n**第三步：结论与行动**\n\n问题是**有效的**。将提供一个解决方案。\n\n目标是为三对距离矩阵计算 Mantel 统计量 $r$ 及其相关的 $p$-值。这通过一个两步过程实现：计算观测统计量，以及通过置换检验评估其显著性。\n\n首先，我们定义 Mantel 统计量 $r$。对于两个对称的 $n \\times n$ 距离矩阵 $A$ 和 $G$，我们提取它们的上三角元素（不包括主对角线）。对于 $n=5$ 个种群，存在 $k = n(n-1)/2 = 5(4)/2 = 10$ 个唯一的成对距离。设这些向量化的距离为 $d_A$ 和 $d_G$。Mantel 统计量 $r$ 是这两个向量之间的皮尔逊积矩相关系数：\n$$\nr = \\frac{\\sum_{i=1}^{k} (d_{A,i} - \\bar{d}_A)(d_{G,i} - \\bar{d}_G)}{\\sqrt{\\sum_{i=1}^{k} (d_{A,i} - \\bar{d}_A)^2} \\sqrt{\\sum_{i=1}^{k} (d_{G,i} - \\bar{d}_G)^2}}\n$$\n其中 $\\bar{d}_A$ 和 $\\bar{d}_G$ 分别是向量 $d_A$ 和 $d_G$ 中元素的平均值。这个值 $r_{\\text{obs}}$ 是为原始的、未置换的矩阵计算的。\n\n其次，我们执行置换检验来评估 $r_{\\text{obs}}$ 的统计显著性。原假设 $H_0$ 指出，地理距离和遗传距离之间没有关系。在 $H_0$ 下，一个矩阵（例如 $G$）中种群的标记相对于另一个矩阵（$A$）是任意的。我们通过重复置换遗传距离矩阵 $G$ 的行和列并重新计算 Mantel 统计量来模拟这一点。\n\n程序如下：\n$1$。生成一组 $N=999$ 次的置换。每次置换都是种群索引 $\\{0, 1, 2, 3, 4\\}$ 的一种排列。为确保可复现性，使用固定值 $12345$ 作为伪随机数生成器的种子。按照规定，这同一组置换将用于所有三个测试用例。\n$2$。对于这 $N$ 次置换中的每一次置换 $\\pi$： a. 将该置换应用于遗传距离矩阵 $G$ 的行和列，以创建一个置换后的矩阵 $G'$。如果 $G_{ij}$ 是原始种群 $i$ 和 $j$ 之间的距离，那么置换后矩阵的元素 $G'_{ij}$ 将是种群 $\\pi(i)$ 和 $\\pi(j)$ 之间的距离，即 $G'_{ij} = G_{\\pi(i), \\pi(j)}$。在矩阵表示法中，这通过 $G' = G[\\pi, :][:, \\pi]$ 实现。 b. 计算固定矩阵 $A$ 和置换后矩阵 $G'$ 之间的 Mantel 统计量 $r_{\\text{perm}}$。 c. 存储这个值 $r_{\\text{perm}}$。\n$3$。完成所有 $N$ 次置换后，我们得到了一个在原假设下由 $N$ 个 $r_{\\text{perm}}$ 值组成的分布。\n$4$。通过将观测统计量 $r_{\\text{obs}}$ 与此零分布进行比较来确定双边 $p$-值。我们计算置换次数 $b$，其中置换统计量至少与观测统计量一样极端。比较是基于绝对值进行的：$|r_{\\text{perm}}| \\ge |r_{\\text{obs}}|$。\n$5$。然后使用提供的包含有限样本校正的公式计算 $p$-值：\n$$\np = \\frac{b + 1}{N + 1} = \\frac{b+1}{1000}\n$$\n此过程将应用于三个测试用例中的每一个。得到的 $r$ 和 $p$ 值四舍五入到 $6$ 位小数。\n\n该实现将使用 `numpy` 库进行高效的矩阵操作、上三角的向量化以及皮尔逊相关系数的计算。向量化是通过使用带有偏移量 $k=1$ 的 `numpy.triu_indices` 来找到上三角的索引（以排除对角线）来实现的。矩阵的置换是使用基于索引的切片来执行的。整个过程被封装在一个程序中，该程序遍历所有测试用例并按要求格式化输出。", "answer": "[[0.992688, 0.001000], [1.000000, 0.001000], [-0.160101, 0.655000]]", "id": "2501780"}]}