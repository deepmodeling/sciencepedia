{"hands_on_practices": [{"introduction": "在从树轮序列中重建古气候时，首要任务是构建一个可靠的年表。单个树木的生长会受到各种非气候因素的干扰，因此我们需要对多棵树的生长序列进行平均，以提取共同的气候信号。但是，我们需要多少棵树才足够呢？表达总体信号（Expressed Population Signal, EPS）是回答这个问题的关键指标，它量化了我们有限的树木样本在多大程度上代表了理论上的总体信号。这个练习 [@problem_id:2517256] 将引导你从基本原理出发，计算 EPS 值，从而掌握评估年表质量的核心方法。", "problem": "一个树轮气候学站点年表由$N=15$个去趋势、标准化的年轮宽度序列构建而成。假设采用标准的站点级信号加噪声模型，其中在给定时间$t$的每个序列可以写为$x_{i,t}=s_{t}+e_{i,t}$，其中$s_{t}$是全站共有的信号，$e_{i,t}$是独立的、零均值、同方差的个体噪声，且与$s_{t}$不相关。在一个参考区间内，不同树木间的平均序列间相关性估计为$\\bar{r}=0.35$。在这些假设下，从方差分解以及根据共同信号和个体噪声方差定义的序列间相关性出发，推导表达总体信号（EPS）关于$N$和$\\bar{r}$的表达式。然后计算给定$N$和$\\bar{r}$下的EPS值。在你的推理过程中，还需评估是否达到了常用的阈值$0.85$。最终答案只报告EPS值。将你的答案四舍五入到$4$位有效数字。不包括单位。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。这是树轮气候学（古生态学的一个分支学科）中的一个标准练习，因此是有效的。\n\n任务是推导表达总体信号（Expressed Population Signal, EPS）的表达式，并根据树轮气候学研究中的一组给定参数计算其值。此推导的基础是信号加噪声模型。\n\n设树木$i$在时间$t$的每个标准化年轮序列$x_{i,t}$由以下线性模型表示：\n$$x_{i,t} = s_t + e_{i,t}$$\n其中$s_t$是该站点所有树木共享的共同信号，$e_{i,t}$是树木$i$特有的随机噪声。这些序列是标准化的，这意味着对于任何序列$i$，其均值为$0$，方差为$1$。\n$$\\text{Var}(x_{i,t}) = 1$$\n\n问题陈述了关于各组成部分的几个关键假设：\n1. 噪声项$e_{i,t}$的均值为零：$\\mathbb{E}[e_{i,t}] = 0$。\n2. 噪声项与共同信号$s_t$不相关：对于所有$i$，$\\text{Cov}(s_t, e_{i,t}) = 0$。\n3. 不同树木间的噪声项是独立的：对于$i \\neq j$，$\\text{Cov}(e_{i,t}, e_{j,t}) = 0$。\n4. 噪声是同方差的，意味着其方差对于所有序列都是一个常数：$\\text{Var}(e_{i,t}) = \\sigma_e^2$。\n\n设共同信号的方差为$\\text{Var}(s_t) = \\sigma_s^2$。\n利用不相关变量之和的方差等于其方差之和的性质，我们可以分解单个序列$x_{i,t}$的方差：\n$$\\text{Var}(x_{i,t}) = \\text{Var}(s_t + e_{i,t}) = \\text{Var}(s_t) + \\text{Var}(e_{i,t})$$\n由于序列是标准化的，$\\text{Var}(x_{i,t}) = 1$。这给出了基本的方差分解：\n$$1 = \\sigma_s^2 + \\sigma_e^2$$\n\n接下来，我们将这些方差与平均序列间相关性$\\bar{r}$联系起来。两个不同序列$x_{i,t}$和$x_{j,t}$（其中$i \\neq j$）之间的相关性$r_{ij}$定义为：\n$$r_{ij} = \\frac{\\text{Cov}(x_{i,t}, x_{j,t})}{\\sqrt{\\text{Var}(x_{i,t})\\text{Var}(x_{j,t})}}$$\n由于$\\text{Var}(x_{i,t}) = \\text{Var}(x_{j,t}) = 1$，相关性就是协方差：\n$$r_{ij} = \\text{Cov}(x_{i,t}, x_{j,t})$$\n我们现在计算这个协方差：\n$$\\text{Cov}(x_{i,t}, x_{j,t}) = \\text{Cov}(s_t + e_{i,t}, s_t + e_{j,t})$$\n利用协方差算子的双线性性：\n$$\\text{Cov}(x_{i,t}, x_{j,t}) = \\text{Cov}(s_t, s_t) + \\text{Cov}(s_t, e_{j,t}) + \\text{Cov}(e_{i,t}, s_t) + \\text{Cov}(e_{i,t}, e_{j,t})$$\n根据我们的假设，对于$i \\neq j$，交叉项为零：$\\text{Cov}(s_t, e_{j,t}) = 0$，$\\text{Cov}(e_{i,t}, s_t) = 0$，以及$\\text{Cov}(e_{i,t}, e_{j,t}) = 0$。这样就剩下：\n$$r_{ij} = \\text{Cov}(s_t, s_t) = \\text{Var}(s_t) = \\sigma_s^2$$\n平均序列间相关性$\\bar{r}$是所有这些成对相关性的平均值。由于每个$r_{ij}$（对于$i \\neq j$）都等于$\\sigma_s^2$，所以它们的平均值也是$\\sigma_s^2$。\n$$\\bar{r} = \\sigma_s^2$$\n从方差分解$1 = \\sigma_s^2 + \\sigma_e^2$中，我们可以用$\\bar{r}$来表示噪声方差：\n$$\\sigma_e^2 = 1 - \\sigma_s^2 = 1 - \\bar{r}$$\n\n表达总体信号（EPS）是衡量站点年表（即$N$个可用序列的平均值）在多大程度上代表了真实的潜在信号$s_t$的指标。站点年表为：\n$$\\bar{x}_t = \\frac{1}{N} \\sum_{i=1}^N x_{i,t} = \\frac{1}{N} \\sum_{i=1}^N (s_t + e_{i,t}) = s_t + \\frac{1}{N} \\sum_{i=1}^N e_{i,t} = s_t + \\bar{e}_t$$\nEPS定义为站点年表$\\bar{x}_t$与真实信号$s_t$之间相关系数的平方：\n$$\\text{EPS} = (\\text{Corr}(\\bar{x}_t, s_t))^2 = \\frac{(\\text{Cov}(\\bar{x}_t, s_t))^2}{\\text{Var}(\\bar{x}_t)\\text{Var}(s_t)}$$\n我们计算这个表达式中的各项。首先是协方差：\n$$\\text{Cov}(\\bar{x}_t, s_t) = \\text{Cov}(s_t + \\bar{e}_t, s_t) = \\text{Cov}(s_t, s_t) + \\text{Cov}(\\bar{e}_t, s_t) = \\text{Var}(s_t) = \\sigma_s^2$$\n因为$\\text{Cov}(\\bar{e}_t, s_t) = 0$。\n接下来是站点年表的方差：\n$$\\text{Var}(\\bar{x}_t) = \\text{Var}(s_t + \\bar{e}_t) = \\text{Var}(s_t) + \\text{Var}(\\bar{e}_t) = \\sigma_s^2 + \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^N e_{i,t}\\right)$$\n因为各个噪声项$e_{i,t}$是独立的，所以它们之和的方差等于它们方差的和：\n$$\\text{Var}(\\bar{e}_t) = \\frac{1}{N^2} \\sum_{i=1}^N \\text{Var}(e_{i,t}) = \\frac{1}{N^2} \\sum_{i=1}^N \\sigma_e^2 = \\frac{N \\sigma_e^2}{N^2} = \\frac{\\sigma_e^2}{N}$$\n因此，年表的方差是：\n$$\\text{Var}(\\bar{x}_t) = \\sigma_s^2 + \\frac{\\sigma_e^2}{N}$$\n将这些代入EPS的公式中：\n$$\\text{EPS} = \\frac{(\\sigma_s^2)^2}{(\\sigma_s^2 + \\frac{\\sigma_e^2}{N})\\sigma_s^2} = \\frac{\\sigma_s^2}{\\sigma_s^2 + \\frac{\\sigma_e^2}{N}}$$\n现在，我们代入$\\sigma_s^2 = \\bar{r}$和$\\sigma_e^2 = 1 - \\bar{r}$，用给定的参数$N$和$\\bar{r}$来表示EPS：\n$$\\text{EPS} = \\frac{\\bar{r}}{\\bar{r} + \\frac{1-\\bar{r}}{N}}$$\n这是一个有效的表达式。通常为了方便，可以通过分子和分母同乘以$N$来消除分母中的分数：\n$$\\text{EPS} = \\frac{N\\bar{r}}{N\\bar{r} + (1 - \\bar{r})} = \\frac{N\\bar{r}}{1 + N\\bar{r} - \\bar{r}}$$\n$$\\text{EPS} = \\frac{N\\bar{r}}{1 + (N-1)\\bar{r}}$$\n这就是最终推导出的EPS表达式。\n\n现在，我们根据给定的数据计算其值：$N=15$和$\\bar{r}=0.35$。\n$$\\text{EPS} = \\frac{15 \\times 0.35}{1 + (15-1) \\times 0.35}$$\n$$\\text{EPS} = \\frac{5.25}{1 + 14 \\times 0.35}$$\n$$\\text{EPS} = \\frac{5.25}{1 + 4.9} = \\frac{5.25}{5.9}$$\n$$\\text{EPS} \\approx 0.8898305...$$\n问题要求答案四舍五入到$4$位有效数字，即$0.8898$。\n\n一个可靠年表的常用阈值是$\\text{EPS} \\ge 0.85$。在本例中，我们计算出的值$0.8898$大于$0.85$，因此该年表的质量可被认为足以用于气候重建。", "answer": "$$\\boxed{0.8898}$$", "id": "2517256"}, {"introduction": "不同的树轮指标，例如轮宽（ring width, RW）和晚材最大密度（maximum latewood density, MXD），对气候变化的响应方式和时间都存在差异。理解这些动态关系对于构建准确的气候重建模型至关重要。本练习 [@problem_id:2517268] 将使用交叉相关分析来确定哪种指标是感知盛夏温度的更优“传感器”，并识别其响应延迟，这是模型校准中的一个关键步骤。", "problem": "一个高海拔针叶林样点提供了晚材最大密度（MXD）和年轮宽度（RW）的标准化、预白化年表，以及仪器观测的生长季和盛夏温度异常，所有数据均为相对于一个共同基准线的年度异常值。由于标准化和预白化已移除了大部分低频生长趋势和一阶自相关，因此假设序列自相关可以忽略不计，并且皮尔逊积矩相关及其相关的学生$t$检验适用于统计推断。\n\n设年份由 $t = 1, \\dots, 10$ 索引。将MXD指数记为 $M_t$，年轮宽度指数记为 $R_t$，生长季温度异常记为 $G_t$，盛夏温度异常记为 $P_t$。观测到的序列如下：\n- $M_t$: $\\{-1.8,\\,-1.1,\\,0.0,\\,1.1,\\,1.8,\\,1.9,\\,1.0,\\,0.1,\\,-1.1,\\,-1.9\\}$\n- $R_t$: $\\{0.0,\\,-1.9,\\,-1.1,\\,0.0,\\,0.9,\\,2.1,\\,2.0,\\,1.1,\\,-0.1,\\,-1.0\\}$\n- $G_t$: $\\{-2.1,\\,-1.0,\\,0.1,\\,1.0,\\,2.0,\\,2.1,\\,1.0,\\,-0.1,\\,-1.0,\\,-2.0\\}$\n- $P_t$: $\\{-2,\\,-1,\\,0,\\,1,\\,2,\\,2,\\,1,\\,0,\\,-1,\\,-2\\}$\n\n任务：\n1) 使用皮尔逊相关系数的定义，计算MXD指数与生长季温度异常之间的同期相关性 $r_{MG}(0)$。\n\n2) 为评估与盛夏温度的超前-滞后关系，定义通用指数 $X_t \\in \\{M_t, R_t\\}$ 在滞后量为 $l$ 时的互相关为\n$$\nr_{XP}(l) \\equiv \\operatorname{corr}(X_{t+l},\\,P_t),\n$$\n其中，$l$ 为正值表示树轮指数滞后于温度 $l$ 年，$l$ 为负值表示树轮指数超前于温度 $|l|$ 年。计算 $l \\in \\{-1,\\,0,\\,+1\\}$ 时的 $r_{MP}(l)$ 和 $r_{RP}(l)$，对每个 $l$ 使用所有可用的配对年份数据。对于每个指数 $X_t$，在集合 $\\{-1,\\,0,\\,+1\\}$ 中找出使 $\\lvert r_{XP}(l)\\rvert$ 最大化的滞后量 $l_X^{\\ast}$。\n\n3) 对于在 $l_M^{\\ast}$ 和 $l_R^{\\ast}$ 处的相关性，使用二元正态性假设下相关性的标准t统计量，在显著性水平 $\\alpha = 0.05$ 下检验它们是否各自与零有显著差异：\n$$\nt = r \\sqrt{\\frac{n-2}{1-r^2}},\n$$\n该统计量服从自由度为 $n-2$ 的t分布，其中 $n$ 是在该滞后量下使用的配对年份数量。根据需要使用双侧临界值 $t_{0.975,\\,8} = 2.306$ 和 $t_{0.975,\\,7} = 2.365$。\n\n最后，定义MXD在捕捉盛夏温度变率方面超前于RW的超前量（以年为单位）为\n$$\n\\Delta l \\equiv l_{R}^{\\ast} - l_{M}^{\\ast}.\n$$\n以整数年份报告 $\\Delta l$。如果任一峰值相关性在 $\\alpha=0.05$ 水平上不显著，则设 $\\Delta l = 0$。最终答案必须是一个不带单位的数字。", "solution": "问题陈述已经过分析，并被认为是有效的。它在科学上基于标准的树轮气候学原理，问题提法得当，有充足的数据和明确的目标，并且没有矛盾或含糊不清之处。我们开始进行解答。\n\n对于两个长度为 $n$ 的序列 $X$ 和 $Y$，皮尔逊积矩相关系数 $r$ 由下式给出\n$$r_{XY} = \\frac{\\sum_{i=1}^{n} (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sqrt{\\sum_{i=1}^{n} (X_i - \\bar{X})^2} \\sqrt{\\sum_{i=1}^{n} (Y_i - \\bar{Y})^2}}$$\n其中 $\\bar{X}$ 和 $\\bar{Y}$ 是样本均值。如果均值为零，公式简化为\n$$r_{XY} = \\frac{\\sum_{i=1}^{n} X_i Y_i}{\\sqrt{\\sum_{i=1}^{n} X_i^2} \\sqrt{\\sum_{i=1}^{n} Y_i^2}}$$\n\n**任务1：MXD与生长季温度之间的相关性，$r_{MG}(0)$**\n\n给定的序列为：\n$M_t = \\{-1.8,\\,-1.1,\\,0.0,\\,1.1,\\,1.8,\\,1.9,\\,1.0,\\,0.1,\\,-1.1,\\,-1.9\\}$\n$G_t = \\{-2.1,\\,-1.0,\\,0.1,\\,1.0,\\,2.0,\\,2.1,\\,1.0,\\,-0.1,\\,-1.0,\\,-2.0\\}$\n观测数量为 $n=10$。首先，我们验证均值。\n$$\\sum_{t=1}^{10} M_t = -1.8 - 1.1 + 0.0 + 1.1 + 1.8 + 1.9 + 1.0 + 0.1 - 1.1 - 1.9 = 0$$\n$$\\sum_{t=1}^{10} G_t = -2.1 - 1.0 + 0.1 + 1.0 + 2.0 + 2.1 + 1.0 - 0.1 - 1.0 - 2.0 = 0$$\n由于 $\\bar{M} = 0$ 且 $\\bar{G} = 0$，简化的相关性公式适用。我们计算必要的平方和与交叉乘积和。\n$$\\sum_{t=1}^{10} M_t^2 = (-1.8)^2 + (-1.1)^2 + 0.0^2 + 1.1^2 + 1.8^2 + 1.9^2 + 1.0^2 + 0.1^2 + (-1.1)^2 + (-1.9)^2$$\n$$= 3.24 + 1.21 + 0.0 + 1.21 + 3.24 + 3.61 + 1.0 + 0.01 + 1.21 + 3.61 = 18.34$$\n$$\\sum_{t=1}^{10} G_t^2 = (-2.1)^2 + (-1.0)^2 + 0.1^2 + 1.0^2 + 2.0^2 + 2.1^2 + 1.0^2 + (-0.1)^2 + (-1.0)^2 + (-2.0)^2$$\n$$= 4.41 + 1.0 + 0.01 + 1.0 + 4.0 + 4.41 + 1.0 + 0.01 + 1.0 + 4.0 = 20.84$$\n$$\\sum_{t=1}^{10} M_t G_t = (-1.8)(-2.1) + (-1.1)(-1.0) + (0.0)(0.1) + \\dots + (-1.9)(-2.0)$$\n$$= 3.78 + 1.1 + 0.0 + 1.1 + 3.6 + 3.99 + 1.0 - 0.01 + 1.1 + 3.8 = 19.46$$\n因此，相关系数为：\n$$r_{MG}(0) = \\frac{19.46}{\\sqrt{18.34 \\times 20.84}} = \\frac{19.46}{\\sqrt{382.2056}} \\approx 0.99539$$\n\n**任务2：与盛夏温度的超前-滞后互相关**\n\n盛夏温度序列为 $P_t = \\{-2,\\,-1,\\,0,\\,1,\\,2,\\,2,\\,1,\\,0,\\,-1,\\,-2\\}$。其总和为 $\\sum P_t = 0$，因此 $\\bar{P}=0$。对于滞后相关，序列会被截断，并且它们的均值必须为每次计算重新评估。\n\n**MXD ($M_t$) vs. $P_t$ 的分析：**\n- **滞后 $l=0$: $r_{MP}(0) = \\operatorname{corr}(M_t, P_t)$。** 此处 $n=10$。由于 $\\bar{M}=0$ 且 $\\bar{P}=0$：\n$$\\sum M_t P_t = (-1.8)(-2) + (-1.1)(-1) + \\dots + (-1.9)(-2) = 3.6+1.1+0+1.1+3.6+3.8+1.0+0+1.1+3.8 = 19.1$$\n$$\\sum M_t^2 = 18.34 \\quad (\\text{来自任务1})$$\n$$\\sum P_t^2 = (-2)^2 + (-1)^2 + \\dots + (-2)^2 = 4+1+0+1+4+4+1+0+1+4 = 20$$\n$$r_{MP}(0) = \\frac{19.1}{\\sqrt{18.34 \\times 20}} = \\frac{19.1}{\\sqrt{366.8}} \\approx 0.99728$$\n\n- **滞后 $l=+1$: $r_{MP}(+1) = \\operatorname{corr}(M_{t+1}, P_t)$。** 配对数据为 $t=1,\\dots,9$，因此 $n=9$。\n序列为 $X = M_{t+1} = \\{-1.1, 0.0, 1.1, 1.8, 1.9, 1.0, 0.1, -1.1, -1.9\\}$ 和 $Y = P_t = \\{-2, -1, 0, 1, 2, 2, 1, 0, -1\\}$。\n$\\sum X = 0$，因此 $\\bar{X}=0$。$\\sum Y = 2$，因此 $\\bar{Y}=2/9$。我们使用通用公式。\n$\\sum X Y = 11.8$，$\\sum X^2 = 15.1$，$\\sum Y^2 = 16$。\n$$r_{MP}(+1) = \\frac{9(11.8) - (0)(2)}{\\sqrt{[9(15.1) - 0^2][9(16) - 2^2]}} = \\frac{106.2}{\\sqrt{135.9 \\times 140}} = \\frac{106.2}{\\sqrt{19026}} \\approx 0.76993$$\n\n- **滞后 $l=-1$: $r_{MP}(-1) = \\operatorname{corr}(M_{t-1}, P_t)$。** 配对数据为 $t=2,\\dots,10$，因此 $n=9$。\n序列为 $X = M_{t-1} = \\{-1.8, -1.1, 0.0, 1.1, 1.8, 1.9, 1.0, 0.1, -1.1\\}$ 和 $Y = P_t = \\{-1, 0, 1, 2, 2, 1, 0, -1, -2\\}$。\n$\\sum X = 0$，因此 $\\bar{X}=0$。$\\sum Y = 2$，因此 $\\bar{Y}=2/9$。\n$\\sum X Y = 11.6$，$\\sum X^2 = 14.73$，$\\sum Y^2 = 16$。\n$$r_{MP}(-1) = \\frac{9(11.6) - (0)(2)}{\\sqrt{[9(14.73) - 0^2][9(16) - 2^2]}} = \\frac{104.4}{\\sqrt{132.57 \\times 140}} = \\frac{104.4}{\\sqrt{18559.8}} \\approx 0.76634$$\n\n比较 $M_t$ 的绝对值：$|r_{MP}(0)| \\approx 0.997$，$|r_{MP}(+1)| \\approx 0.770$，$|r_{MP}(-1)| \\approx 0.766$。最大值出现在滞后为0处。因此，$l_M^{\\ast} = 0$。\n\n**年轮宽度 ($R_t$) vs. $P_t$ 的分析：**\n序列为 $R_t = \\{0.0,\\,-1.9,\\,-1.1,\\,0.0,\\,0.9,\\,2.1,\\,2.0,\\,1.1,\\,-0.1,\\,-1.0\\}$。\n$\\sum R_t = 2.0$，因此 $\\bar{R} = 0.2$。需要使用通用相关公式。\n\n- **滞后 $l=0$: $r_{RP}(0) = \\operatorname{corr}(R_t, P_t)$。** 此处 $n=10$。$\\bar{R}=0.2, \\bar{P}=0$。\n$\\sum R_t=2, \\sum P_t=0$。\n$\\sum R_t P_t = 0 + 1.9 + 0 + 0 + 1.8 + 4.2 + 2.0 + 0 + 0.1 + 2.0 = 12.0$。\n$\\sum R_t^2 = 0 + 3.61 + 1.21 + 0 + 0.81 + 4.41 + 4.0 + 1.21 + 0.01 + 1.0 = 16.26$。\n$\\sum P_t^2 = 20$。\n$$r_{RP}(0) = \\frac{10(12.0) - (2)(0)}{\\sqrt{[10(16.26) - 2^2][10(20) - 0^2]}} = \\frac{120}{\\sqrt{(162.6-4)(200)}} = \\frac{120}{\\sqrt{158.6 \\times 200}} \\approx 0.67377$$\n\n- **滞后 $l=+1$: $r_{RP}(+1) = \\operatorname{corr}(R_{t+1}, P_t)$。** 配对数据为 $t=1,\\dots,9$，因此 $n=9$。\n序列为 $X = R_{t+1} = \\{-1.9, -1.1, 0.0, 0.9, 2.1, 2.0, 1.1, -0.1, -1.0\\}$ 和 $Y = P_t = \\{-2, -1, 0, 1, 2, 2, 1, 0, -1\\}$。\n$\\sum X = 2.0$，因此 $\\bar{X}=2/9$。$\\sum Y = 2.0$，因此 $\\bar{Y}=2/9$。\n$\\sum X Y = 16.1$，$\\sum X^2 = 16.26$，$\\sum Y^2 = 16$。\n$$r_{RP}(+1) = \\frac{9(16.1) - (2)(2)}{\\sqrt{[9(16.26) - 2^2][9(16) - 2^2]}} = \\frac{144.9 - 4}{\\sqrt{(146.34-4)(144-4)}} = \\frac{140.9}{\\sqrt{142.34 \\times 140}} \\approx 0.99812$$\n\n- **滞后 $l=-1$: $r_{RP}(-1) = \\operatorname{corr}(R_{t-1}, P_t)$。** 配对数据为 $t=2,\\dots,10$，因此 $n=9$。\n序列为 $X = R_{t-1} = \\{0.0, -1.9, -1.1, 0.0, 0.9, 2.1, 2.0, 1.1, -0.1\\}$ 和 $Y = P_t = \\{-1, 0, 1, 2, 2, 1, 0, -1, -2\\}$。\n$\\sum X = 3.0$，因此 $\\bar{X}=1/3$。$\\sum Y = 2.0$，因此 $\\bar{Y}=2/9$。\n$\\sum X Y = 1.9$，$\\sum X^2 = 15.26$，$\\sum Y^2 = 16$。\n$$r_{RP}(-1) = \\frac{9(1.9) - (3)(2)}{\\sqrt{[9(15.26) - 3^2][9(16) - 2^2]}} = \\frac{17.1 - 6}{\\sqrt{(137.34-9)(144-4)}} = \\frac{11.1}{\\sqrt{128.34 \\times 140}} \\approx 0.08281$$\n\n比较 $R_t$ 的绝对值：$|r_{RP}(0)| \\approx 0.674$，$|r_{RP}(+1)| \\approx 0.998$，$|r_{RP}(-1)| \\approx 0.083$。最大值出现在滞后为+1处。因此，$l_R^{\\ast} = +1$。\n\n**任务3：显著性检验与最终计算**\n\n我们使用t统计量 $t = r \\sqrt{(n-2)/(1-r^2)}$ 检验在最优滞后量 $l_M^{\\ast}=0$ 和 $l_R^{\\ast}=+1$ 处的相关性的显著性。显著性水平为 $\\alpha=0.05$。\n\n- **检验 $r_{MP}(l_M^{\\ast}) = r_{MP}(0) \\approx 0.99728$**:\n此处 $n=10$，因此自由度为 $df = n-2=8$。双侧临界值为 $t_{0.975, 8} = 2.306$。\n$$t_M = 0.99728 \\sqrt{\\frac{10-2}{1 - (0.99728)^2}} \\approx 0.99728 \\sqrt{\\frac{8}{0.005433}} \\approx 0.99728 \\times 38.373 \\approx 38.27$$\n由于 $|t_M| \\approx 38.27 > 2.306$，该相关性在 $\\alpha = 0.05$ 水平上是统计显著的。\n\n- **检验 $r_{RP}(l_R^{\\ast}) = r_{RP}(+1) \\approx 0.99812$**:\n此处 $n=9$，因此自由度为 $df = n-2=7$。双侧临界值为 $t_{0.975, 7} = 2.365$。\n$$t_R = 0.99812 \\sqrt{\\frac{9-2}{1 - (0.99812)^2}} \\approx 0.99812 \\sqrt{\\frac{7}{0.003757}} \\approx 0.99812 \\times 43.165 \\approx 43.08$$\n由于 $|t_R| \\approx 43.08 > 2.365$，该相关性在 $\\alpha = 0.05$ 水平上同样是统计显著的。\n\n两个峰值相关性均显著。我们现在可以计算MXD相对于RW的超前量。\n$$\\Delta l = l_{R}^{\\ast} - l_{M}^{\\ast} = (+1) - (0) = 1$$\n这表明在对盛夏温度的响应中，晚材最大密度超前于年轮宽度1年。", "answer": "$$\\boxed{1}$$", "id": "2517268"}, {"introduction": "一个气候重建模型在校准期内可能表现优异，但其真正的考验在于它能否准确预测未用于校准的独立时期内的气候。误差折减量（Reduction of Error, RE）和有效系数（Coefficient of Efficiency, CE）是用于进行这种“样本外”验证的严格统计指标。本练习 [@problem_id:2517280] 将演示如何计算这些关键统计量，并解释它们的含义，特别是当它们揭示一个模型不具备预测技巧时，我们该如何解读。", "problem": "一项基于树轮的重建工作在一个为期 $10$ 年的验证期内进行评估，使用了观测到的仪器记录的夏季温度距平 $\\{y_t\\}$ 和重建的距平 $\\{\\hat{y}_t\\}$。验证期的观测序列为\n$\\{y_t\\} = \\{0.3,\\ 0.5,\\ -0.2,\\ 0.0,\\ 0.8,\\ 1.1,\\ 0.6,\\ -0.1,\\ 0.2,\\ 0.9\\}$，\n重建序列为\n$\\{\\hat{y}_t\\} = \\{0.7,\\ 0.7,\\ 0.7,\\ 0.7,\\ 0.7,\\ 0.7,\\ 0.7,\\ 0.7,\\ 0.7,\\ 0.7\\}$。\n假设这些距平是相对于一个固定的气候基线标准化的，因此技巧评分是无量纲的。\n\n从独立的校准期（未显示）可知，观测距平的均值为 $\\mu_{\\mathrm{cal}} = 0.6$。在树轮气候学中，预测技巧是通过将重建误差的平方和与由固定基线定义的参考平方和进行比较来评估的。误差缩减（RE）与校准期均值基线进行比较，而效率系数（CE）与验证期均值基线进行比较。\n\n从均值、偏差和误差平方和的核心定义出发，并使用上述关于误差缩减（RE）和效率系数（CE）作为相对于各自基线的技巧的定义，利用所提供的数据计算验证期的 RE 和 CE。然后，基于第一性原理，从相对预测技巧的角度解释在此情境下负 CE 值的含义。\n\n将你的 RE 和 CE 数值答案四舍五入到四位有效数字。仅报告最终数值。这些无量纲指标不需要单位。", "solution": "问题陈述已经过评估，并被确定为有效。它在气候学领域有科学依据，问题提出得当，并包含唯一解所需的所有数据和定义。我们将着手进行分析。\n\n目标是计算气候重建的两个标准技巧评分：误差缩减（$RE$）和效率系数（$CE$）。我们还必须提供关于负 $CE$ 值含义的第一性原理解释。\n\n基本量是重建模型的误差平方和，我们记为 $SSE_{model}$，以及参考预报的误差平方和，记为 $SSE_{ref}$。技巧评分 $S$ 通常定义为：\n$$S = 1 - \\frac{SSE_{model}}{SSE_{ref}}$$\n评分为 $S=1$ 表示完美预报（$SSE_{model}=0$），评分为 $S=0$ 表示模型与参考预报具有相同的技巧，负分表示模型比参考预报更差。\n\n给定的数据是：\n验证期的年数，$n = 10$。\n观测到的距平，$\\{y_t\\}_{t=1}^{10} = \\{0.3, 0.5, -0.2, 0.0, 0.8, 1.1, 0.6, -0.1, 0.2, 0.9\\}$。\n重建的距平，$\\{\\hat{y}_t\\}_{t=1}^{10} = \\{0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7\\}$。\n来自校准期的观测距平的均值，$\\mu_{\\mathrm{cal}} = 0.6$。\n\n重建模型的误差平方和由下式给出：\n$$SSE_{model} = \\sum_{t=1}^{n} (y_t - \\hat{y}_t)^2$$\n代入给定值：\n$$SSE_{model} = (0.3-0.7)^2 + (0.5-0.7)^2 + (-0.2-0.7)^2 + (0.0-0.7)^2 + (0.8-0.7)^2 + (1.1-0.7)^2 + (0.6-0.7)^2 + (-0.1-0.7)^2 + (0.2-0.7)^2 + (0.9-0.7)^2$$\n$$SSE_{model} = (-0.4)^2 + (-0.2)^2 + (-0.9)^2 + (-0.7)^2 + (0.1)^2 + (0.4)^2 + (-0.1)^2 + (-0.8)^2 + (-0.5)^2 + (0.2)^2$$\n$$SSE_{model} = 0.16 + 0.04 + 0.81 + 0.49 + 0.01 + 0.16 + 0.01 + 0.64 + 0.25 + 0.04 = 2.61$$\n\n对于误差缩减（$RE$），参考预报是来自校准期的观测数据的均值 $\\mu_{\\mathrm{cal}}$。该参考的误差平方和为：\n$$SSE_{ref,RE} = \\sum_{t=1}^{n} (y_t - \\mu_{\\mathrm{cal}})^2$$\n代入给定值，其中 $\\mu_{\\mathrm{cal}} = 0.6$：\n$$SSE_{ref,RE} = (0.3-0.6)^2 + (0.5-0.6)^2 + (-0.2-0.6)^2 + (0.0-0.6)^2 + (0.8-0.6)^2 + (1.1-0.6)^2 + (0.6-0.6)^2 + (-0.1-0.6)^2 + (0.2-0.6)^2 + (0.9-0.6)^2$$\n$$SSE_{ref,RE} = (-0.3)^2 + (-0.1)^2 + (-0.8)^2 + (-0.6)^2 + (0.2)^2 + (0.5)^2 + (0.0)^2 + (-0.7)^2 + (-0.4)^2 + (0.3)^2$$\n$$SSE_{ref,RE} = 0.09 + 0.01 + 0.64 + 0.36 + 0.04 + 0.25 + 0.00 + 0.49 + 0.16 + 0.09 = 2.13$$\n因此，误差缩减为：\n$$RE = 1 - \\frac{SSE_{model}}{SSE_{ref,RE}} = 1 - \\frac{2.61}{2.13} \\approx 1 - 1.225352... = -0.225352...$$\n四舍五入到四位有效数字，$RE = -0.2254$。\n\n对于效率系数（$CE$），参考预报是来自验证期本身的观测数据的均值，我们记为 $\\bar{y}_{ver}$。首先，我们必须计算这个均值：\n$$\\bar{y}_{ver} = \\frac{1}{n}\\sum_{t=1}^{n} y_t = \\frac{1}{10}(0.3 + 0.5 - 0.2 + 0.0 + 0.8 + 1.1 + 0.6 - 0.1 + 0.2 + 0.9) = \\frac{4.1}{10} = 0.41$$\n这个参考的误差平方和，也就是验证数据的总平方和，是：\n$$SSE_{ref,CE} = \\sum_{t=1}^{n} (y_t - \\bar{y}_{ver})^2$$\n代入数值：\n$$SSE_{ref,CE} = (0.3-0.41)^2 + (0.5-0.41)^2 + (-0.2-0.41)^2 + (0.0-0.41)^2 + (0.8-0.41)^2 + (1.1-0.41)^2 + (0.6-0.41)^2 + (-0.1-0.41)^2 + (0.2-0.41)^2 + (0.9-0.41)^2$$\n$$SSE_{ref,CE} = (-0.11)^2 + (0.09)^2 + (-0.61)^2 + (-0.41)^2 + (0.39)^2 + (0.69)^2 + (0.19)^2 + (-0.51)^2 + (-0.21)^2 + (0.49)^2$$\n$$SSE_{ref,CE} = 0.0121 + 0.0081 + 0.3721 + 0.1681 + 0.1521 + 0.4761 + 0.0361 + 0.2601 + 0.0441 + 0.2401 = 1.769$$\n因此，效率系数为：\n$$CE = 1 - \\frac{SSE_{model}}{SSE_{ref,CE}} = 1 - \\frac{2.61}{1.769} \\approx 1 - 1.475409... = -0.475409...$$\n四舍五入到四位有效数字，$CE = -0.4754$。\n\n现在，我们来解释负 $CE$ 的含义。\n定义是 $CE = 1 - \\frac{\\sum_{t=1}^{n} (y_t - \\hat{y}_t)^2}{\\sum_{t=1}^{n} (y_t - \\bar{y}_{ver})^2}$。\n负 $CE$ 意味着 $CE  0$。从代数上讲，这意味着：\n$$1 - \\frac{\\sum (y_t - \\hat{y}_t)^2}{\\sum (y_t - \\bar{y}_{ver})^2}  0$$\n$$\\sum (y_t - \\bar{y}_{ver})^2  \\sum (y_t - \\hat{y}_t)^2$$\n左边的项 $\\sum (y_t - \\bar{y}_{ver})^2$ 代表使用一个简单的“气候学”预报所产生的误差平方和，其中对验证期内每个点的预测都只是该时期的均值 $\\bar{y}_{ver}$。这是 $CE$ 的参考模型的误差。\n右边的项 $\\sum (y_t - \\hat{y}_t)^2$ 是实际重建模型 $\\hat{y}_t$ 的误差平方和。\n因此，负的 $CE$ 值表明重建模型的误差平方和大于一个总是预测验证期均值的简单模型所产生的误差平方和。\n在预测技巧方面，这表明该重建的准确性低于仅仅假设其试图预测的时期的平均状况。相对于这个特定的基线，该模型表现出“负技巧”。统计学的一个基本性质是，样本均值 $\\bar{y}_{ver}$ 是使样本 $\\{y_t\\}$ 的离差平方和最小化的常数值。任何其他的常数预测，如此处使用的 $\\hat{y}_t=0.7$，必然会产生更大的误差平方和，从而导致负的 $CE$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.2254  -0.4754\n\\end{pmatrix}\n}\n$$", "id": "2517280"}]}