## 引言
动物每天都面临着一个至关重要且永恒的挑战：如何有效地寻找和消耗食物以维持生存和繁衍？[最优觅食理论](@entry_id:185884) (Optimal Foraging Theory, OFT) 为我们提供了一个强大的理论框架，它将动物视为理性的决策者，在充满约束的自然环境中，试图通过其行为策略来最大化某种收益（如能量摄入）。该理论旨在解决一个根本性的知识空白：我们如何预测动物在面对多样化的食物选项和[分布](@entry_id:182848)不均的资源时，会做出怎样的觅食决策。本文将带领读者深入探索[最优觅食理论](@entry_id:185884)的世界，从其基本原理到前沿应用。

在接下来的内容中，您将系统地学习：
*   **原理与机制**：我们将首先剖析构成OFT基石的核心模型。从描述摄食速率的[霍林功能性反应](@entry_id:184035)出发，我们将推导出决定“吃什么”的经典[猎物选择模型](@entry_id:195242)和决定“何时离开”斑块的边际价值定理，并最终引入更复杂的动态[状态变量](@entry_id:138790)模型，以理解依赖于个体状态的决策过程。
*   **应用与跨学科联系**：本章将展示OFT的强大解释力如何超越个体行为，应用于理解种群[分布](@entry_id:182848)（[理想自由分布](@entry_id:195531)）、[群落结构](@entry_id:153673)（资源划分）、协同进化，甚至人类演化等宏观生态与进化现象。我们将探讨当“通货”不仅是能量，还包括营养和安全时，理论如何扩展。
*   **动手实践**：最后，通过一系列精心设计的问题，您将有机会亲手应用所学理论，通过计算和推导来解决具体的[觅食生态学](@entry_id:181329)问题，从而巩固对核心概念的理解。

让我们首先进入第一章，深入了解[最优觅食理论](@entry_id:185884)的基本原理与机制。

## 原理与机制

在对一种行为进行最优性分析时，我们必须明确三个核心要素：决策者做什么（决策集），决策者试图最大化什么（[目标函数](@entry_id:267263)或“通货”），以及限制决策者能力的因素（约束条件）。[最优觅食理论](@entry_id:185884) (Optimal Foraging Theory, OFT) 将这一优化框架应用于理解动物的[觅食行为](@entry_id:181461)。本章将深入探讨构成该理论核心的若干关键模型，阐述其基本原理与内在机制。我们将从捕食者与猎物互作的基础——功能反应——开始，逐步构建起关于吃什么、在何处[觅食](@entry_id:181461)、以及停留多久的经典理论，并最终引入更复杂的动态模型，以揭示状态依赖决策的奥秘。

### 构建模块：[功能性反应](@entry_id:201210)

任何觅食模型的基础都必须描述觅食者消耗资源的速率如何随资源密度变化而改变。这一关系被称为**[功能性反应](@entry_id:201210) (functional response)**。最基本也最广泛应用的[机制模型](@entry_id:202454)之一是霍林 (Holling) II 型[功能性反应](@entry_id:201210)，它源于对觅食过程时间分配的简单思考。

想象一个捕食者在[均匀分布](@entry_id:194597)的猎物种群中[觅食](@entry_id:181461)，猎物密度为 $N$。捕食者的总觅食时间 $T$ 可以被划分为两个[互斥](@entry_id:752349)的部分：搜寻时间 $T_s$ 和处理已捕获猎物的时间 $T_h$。因此，时间预算恒等式为 $T = T_s + T_h$。

在搜寻期间，捕食者以与其**攻击速率**（或称搜寻效率）$a$ 和猎物密度 $N$ 乘积成正比的速率遇到猎物。因此，在总搜寻时间 $T_s$ 内捕获的猎物总数 $C$ 为 $C = a N T_s$。每捕获一个猎物，捕食者都需要花费固定的**处理时间** $h$，在此期间无法进行搜寻。因此，总[处理时间](@entry_id:196496)为 $T_h = C h$。

我们的目标是推导单位时间内捕获的猎物数量，即摄入率 $I(N) = C/T$。通过联立上述方程，我们可以用模型参数 $a$、$h$ 和变量 $N$ 来表达 $I(N)$。首先，将 $T_s = C / (aN)$ 和 $T_h = C h$ 代入时间预算方程：

$T = \frac{C}{aN} + Ch = C \left( \frac{1}{aN} + h \right)$

整理后得到摄入率 $I(N)$ 的表达式 [@problem_id:2515934]：

$I(N) = \frac{C}{T} = \frac{1}{\frac{1}{aN} + h} = \frac{aN}{1 + aNh}$

这就是**[霍林II型](@entry_id:272332)[功能性反应](@entry_id:201210)**。该曲线呈现出饱和特性：当猎物密度 $N$ 较低时，摄入率近似[线性增长](@entry_id:157553) ($I(N) \approx aN$)，因为捕食者的大部[分时](@entry_id:274419)间都用于搜寻。而当猎物密度 $N$ 极高时，搜寻时间变得微不足道，摄入率趋于其生理极限，该极限仅由处理时间决定。这个**最大摄入率** $I_{\max}$ 为：

$I_{\max} = \lim_{N \to \infty} \frac{aN}{1 + aNh} = \frac{1}{h}$

直观地看，当猎物“取之不尽”时，捕食者永远在处理猎物，因此其速率就是处理一个猎物所需时间的倒数。另一个关键参数是**半饱和常数** $N_{1/2}$，即摄入率达到最大值一半时的猎物密度。通过求解 $I(N_{1/2}) = \frac{1}{2} I_{\max}$，我们得到 $N_{1/2} = \frac{1}{ah}$。

当环境中存在多种猎物时，这一模型可以自然地扩展。假设捕食者捕食两种猎物（$i=1, 2$），其密度分别为 $N_1$ 和 $N_2$，对应的攻击速率和[处理时间](@entry_id:196496)分别为 $a_i$ 和 $h_i$。如果捕食者对两种猎物都来者不拒，那么它在处理任何一种猎物时都无法搜寻其他猎物。这意味着所有猎物共享同一个[处理时间](@entry_id:196496)“瓶颈”。总处理时间变为 $T_h = C_1 h_1 + C_2 h_2$。通过与单猎物情况类似的推导，我们可以得到捕食猎物 $i$ 的摄入率 $I_i$ [@problem_id:2515946]：

$I_i = \frac{a_i N_i}{1 + a_1 h_1 N_1 + a_2 h_2 N_2}$

请注意，分母是共享的。这意味着对一种猎物（如猎物2）的捕食会通过增加总处理时间（分母中的 $a_2 h_2 N_2$ 项）而降低对另一种猎物（猎物1）的摄入率。这种通过共享捕食者时间而产生的间接负相互作用被称为**[表观竞争](@entry_id:152462) (apparent competition)**。这个多物种[功能性反应](@entry_id:201210)模型为我们分析更复杂的膳食选择问题奠定了基础。

### 经典[猎物选择模型](@entry_id:195242)：吃什么？

[功能性反应](@entry_id:201210)描述了在给定策略下（例如，接受所有遇到的猎物）的摄入率。但[觅食](@entry_id:181461)者通常会做出更精细的决策：当遇到一个潜在的猎物时，是应该捕捉它，还是应该放弃它并继续搜寻可能更好的选择？这就是经典[猎物选择模型](@entry_id:195242)（或称膳食模型）要解决的核心问题。

该模型假设觅食者的目标是最大化其长期平均能量摄入率。为了建立决策规则，我们首先需要一个衡量猎物价值的指标。最直观的指标是**收益率 (profitability)**，定义为猎物提供的净能量 $E_i$ 除以其处理时间 $h_i$：

$p_i = \frac{E_i}{h_i}$

收益率衡量的是捕食者在“处理”阶段单位时间内获得的能量。现在，考虑一个觅食者，它已经确定了一个包含某些高收益率猎物的最优膳食组合，并通过这种膳食实现了长期平均能量摄入率 $R^*$。此时，它遇到了一个新的、收益率较低的猎物 $j$。它是否应该将 $j$ 纳入其膳食？

决策的关键在于比较两种选择的后果：
1.  **接受猎物 $j$**：[觅食](@entry_id:181461)者将花费 $h_j$ 的时间来处理它，并获得 $E_j$ 的能量。
2.  **拒绝猎物 $j$**：觅食者将继续搜寻，并期望以其已知的长期[平均速率](@entry_id:147100) $R^*$ 获得能量。在它本可以用来处理猎物 $j$ 的 $h_j$ 时间内，它期望通过继续搜寻获得的能量为 $R^* h_j$。这正是接受猎物 $j$ 的**[机会成本](@entry_id:146217) (opportunity cost)**。

一个理性的[觅食](@entry_id:181461)者只有在接受猎物带来的收益不低于其[机会成本](@entry_id:146217)时，才会选择接受。因此，最优决策规则是：当且仅当 $E_j \ge R^* h_j$ 时，接受猎物 $j$。将该不等式两边同时除以 $h_j$，我们得到了经典[猎物选择模型](@entry_id:195242)的黄金法则 [@problem_id:2515954]：

$p_j \ge R^*$

即：**当且仅当一个猎物的收益率大于或等于当前膳食所能提供的长期平均能量摄入率时，才应将其纳入膳食。**

让我们通过一个具体的例子来理解这个法则。假设一个捕食者遇到两种猎物：
- 猎物1: $E_1 = 60$ J, $h_1 = 6$ s, $\lambda_1 = 0.05$ s$^{-1}$
- 猎物2: $E_2 = 15$ J, $h_2 = 2$ s, $\lambda_2 = 0.20$ s$^{-1}$

首先计算收益率：$p_1 = 60/6 = 10$ J/s，$p_2 = 15/2 = 7.5$ J/s。由于 $p_1 > p_2$，猎物1是更高质量的选择。最优膳食必须包含最高收益率的猎物，因此捕食者总是会接受猎物1。现在的问题是，是否应该接受猎物2？为了回答这个问题，我们需要计算只吃猎物1时的长期平均摄入率，这个速率就是决定是否接纳猎物2的基准 $R^*$。根据前一节推导的[功能性反应](@entry_id:201210)公式：

$R^* = R(\{1\}) = \frac{\lambda_1 E_1}{1 + \lambda_1 h_1} = \frac{0.05 \times 60}{1 + 0.05 \times 6} = \frac{3}{1.3} \approx 2.31 \text{ J/s}$

现在我们应用决策法则：$p_2$ 是否大于等于 $R^*$？我们发现 $p_2 = 7.5 \text{ J/s}$ 远大于 $R^* \approx 2.31 \text{ J/s}$。因此，最优策略是同时接受猎物1和猎物2。

这个模型导出了两个非常重要且时而违反直觉的推论：

1.  **零一法则 (Zero-One Rule)**：对于任何一种猎物，它要么应该总被接受，要么应该总被拒绝。它不会被部分接受。唯一的例外是当其收益率恰好等于背景摄入率（$p_j = R^*$）时，接受与否对长期摄入率没有影响，此时觅食者是无所谓的 [@problem_id:2515967]。

2.  **遭遇率的独立性**：一个猎物是否被纳入最优膳食，**完全取决于其自身的收益率 ($p_i$)，而与其自身的遭遇率 ($\lambda_i$) 无关**。决定是否纳入猎物 $i$ 的是更高收益率猎物的遭遇率，因为它们共同决定了[机会成本](@entry_id:146217) $R^*$。一个收益率很高的猎物，哪怕极其稀有（$\lambda_i \to 0$），一旦遇到也应该被捕食。反之，一个收益率低于 $R^*$ 的猎物，哪怕极其常见，也应该被忽略，因为处理它所花费的时间成本太高，得不偿失 [@problem_id:2515967]。

### 斑块利用：何时离开？

现在我们将视角从分立的猎物转向在空间上聚集的资源，即**斑块 (patches)**。当觅食者进入一个资源丰富的斑块后，随着[觅食](@entry_id:181461)的进行，资源会逐渐被消耗，导致其瞬时能量获取速率下降。同时，在不同斑块之间移动需要花费时间和能量。那么，觅食者应在一个斑块内停留多久才能实现长期收益最大化？这就是**边际价值定理 (Marginal Value Theorem, MVT)** 所要解决的问题。

考虑一个典型的场景：觅食者在一系列相同的斑块间[觅食](@entry_id:181461)，斑块间的固定穿行时间为 $T$。在斑块内停留的时间为 $t$，累积获得的能量为 $g(t)$。我们假设 $g(t)$ 是一个收益递减的函数，即 $g'(t) > 0$ 但 $g''(t)  0$。一个完整的觅食周期包括穿行和在斑块内[觅食](@entry_id:181461)，总时长为 $T+t$，总收益为 $g(t)$。[觅食](@entry_id:181461)者的目标是选择一个最佳的斑块[停留时间](@entry_id:263953) $t^*$，以最大化其长期[平均能量](@entry_id:145892)摄入率：

$R(t) = \frac{g(t)}{T+t}$

为了找到最大值，我们对 $R(t)$ 求关于 $t$ 的导数并令其为零。通过[商法则](@entry_id:143051)求导，我们得到最优条件 [@problem_id:2515938]：

$g'(t^*) = \frac{g(t^*)}{T+t^*}$

这个方程的右侧正是最大化的长期平均摄入率 $R^*$。因此，MVT的核心思想可以简洁地表述为：

$g'(t^*) = R^*$

这意味着，**[觅食](@entry_id:181461)者应该在当前斑块的瞬时能量获取速率（即边际收益）下降到与整个环境的[平均能量](@entry_id:145892)获取速率相等时离开该斑块**。从图形上看，这相当于在 $g(t)$ 曲线上找到一点，使得从 $(-T, 0)$ 点引出的[切线](@entry_id:268870)恰好切于该点。

MVT框架的强大之处在于其普适性。例如，我们可以通过定义更丰富的成本结构来扩展它，从而引出**[放弃密度](@entry_id:187602) (Giving-Up Density, GUD)** 的概念。GUD是指当觅食者选择离开斑块时，斑块中剩余的资源密度。这为在野外衡量觅食成本和决策提供了一个强有力的工具。

假设觅食的[边际成本](@entry_id:144599)不仅包括能量消耗，还包括其他因素。在觅食的单位时间内，总成本可以看作三部分之和：基础代谢成本 $c_m$，被捕食风险成本 $c_p$（例如，等于被捕食概率 $\mu$ 乘以失去未来所有收益的巨大损失 $V$），以及**错失[机会成本](@entry_id:146217)** $c_o$（即从事其他活动，如社交或在更安全的地点觅食，所能获得的净收益 $\rho$）。[觅食](@entry_id:181461)者应持续在斑块中[觅食](@entry_id:181461)，直到其瞬时总收益率 $g(x)$ 等于总的[边际成本](@entry_id:144599)。因此，定义GUD ($x^*$) 的条件是 [@problem_id:2515920]：

$g(x^*) = c_m + c_p + c_o = c_m + \mu V + \rho$

当环境中的捕食风险（$\mu$）增加，或有更好的替代[觅食](@entry_id:181461)地点（$\rho$ 增加）时，总的觅食成本就会上升。为了满足上述等式，觅食者必须在更高的瞬时收益率 $g(x^*)$ 时就离开斑块。由于收益率随资源密度 $x$ 单调递增，这意味着[觅食](@entry_id:181461)者会留下更高的GUD。因此，GUD成为了衡量觅食者所感知到的总成本（包括风险）的“探针”。

最后，深入理解MVT需要我们认识到**通货选择 (currency choice)** 的重要性。我们最大化的速率，其分母必须是真正的**限制性资源**。一个精妙的例子可以说明这一点 [@problem_id:2515935]：考虑一个在觅食周期中存在固定时间开销 $T_0$（如往返巢穴）的觅食者。

- **情景1：时间限制型觅食者**。如果觅食者的总可用时间（如白昼长度）是有限的，那么 $T_0$ 消耗了这一宝贵资源。此时，目标是最大化能量/总时间，即 $\max \frac{E(T)}{T+T_0}$。这正是标准的MVT形式。
- **情景2：风险限制型觅食者**。如果[觅食](@entry_id:181461)者试图最小化其暴露在捕食风险下的“活跃”[觅食](@entry_id:181461)时间 $T$，而固定开销 $T_0$ 发生在安全的庇护所内（如夜间消化食物），那么限制性资源就只是活跃[觅食](@entry_id:181461)时间 $T$。此时，目标是最大化能量/活跃时间，即 $\max \frac{E(T)}{T}$。对于一个收益递减的函数 $E(T)$，这个比率在 $T \to 0$ 时达到最大。

这两个情景的对比鲜明地指出，最优策略会随着生态背景和限制性资源的变化而改变。OFT并非一个单一的公式，而是一个要求研究者仔细审视其研究系统基本约束的分析框架。

### 主题变奏：中心地觅食与竞争

OFT的基本原理可以被应用于更多样的生态情景中，例如中心地[觅食](@entry_id:181461)和个体间的竞争。

#### 中心-地[觅食](@entry_id:181461) (Central-Place Foraging)

许多动物，如筑巢的鸟类或蜜蜂，需要将食物收集后带回一个中心地点（巢穴、蜂巢）。这种**中心-地[觅食](@entry_id:181461) (CPF)** 模式引入了新的权衡。觅食者在斑块中收集的食物量（载荷量 $w$）越大，单次带回的能量 $g(w)$ 就越多，但同时装载这些食物所需的时间 $t_{\text{load}}(w)$ 也越长。往返于中心地和[觅食](@entry_id:181461)地之间的穿行时间 $t_{\text{tr}}$ 是一个固定成本。

在这种情况下，最优[觅食](@entry_id:181461)者旨在最大化将能量带回中心地的长期**交付速率 (delivery rate)**。单次[觅食](@entry_id:181461)周期的总时间为 $t_{\text{tr}} + t_{\text{load}}(w)$，总收益为 $g(w)$。因此，需要最大化的目标函数是 [@problem_id:2515992]：

$R(w) = \frac{g(w)}{t_{\text{tr}} + t_{\text{load}}(w)}$

通过对 $w$ 求导并令其为零，可以得到最优载荷量 $w^*$ 所满足的条件。这个条件直观地表达了增加载荷量的边际收益（$g'(w^*)$）必须与由此带来的时间成本增加[相平衡](@entry_id:136822)。

#### [理想自由分布](@entry_id:195531) (Ideal Free Distribution)

当多个觅食者在同一环境中竞争资源时，它们的[空间分布](@entry_id:188271)本身也成为一个可以被优化的行为。**[理想自由分布](@entry_id:195531) (Ideal Free Distribution, IFD)** 模型是分析这一问题的基石。该模型假设所有个体都是“理想”的（它们完全了解环境中所有斑块的质量）和“自由”的（它们可以无成本地在斑块间移动）。

每个个体都试图通过选择斑块来最大化自身的能量摄入率。由于斑块内的摄入率会因竞争者数量的增加而下降（密度依赖效应），个体将不断从“拥挤”的斑块移动到“空闲”的斑块，直到没有任何个体能通过单方面改变位置来提高其摄入率。此时，系统[达到平衡](@entry_id:170346)。

IFD的平衡条件可以精确地表述为 [@problem_id:2515945]：
存在一个统一的均衡摄入率 $\lambda$，使得：
1.  对于所有被占据的斑块 $i$（即觅食者数量 $n_i^* > 0$），其每个个体的摄入率都等于 $\lambda$，即 $I_i(n_i^*) = \lambda$。
2.  对于所有未被占据的斑块 $j$（即 $n_j^* = 0$），其潜在的摄入率（即第一个进入者能获得的摄入率）不高于均衡摄入率 $\lambda$，即 $I_j(0) \le \lambda$。

这个“摄入率匹配”的结果意味着，竞争者们会自发地调整自己的[分布](@entry_id:182848)，使得所有被利用的资源点的“吸[引力](@entry_id:175476)”（即每个个体的收益）趋于一致。因此，内在质量更高（即能支持更多觅食者达到均衡摄入率 $\lambda$）的斑块，在平衡时会吸引更多的[觅食](@entry_id:181461)者。

### 超越静态优化：动态状态变量模型

上述所有模型，无论是猎物选择、斑块利用还是IFD，本质上都是**静态优化**模型。它们通常假设觅食者的内在状态（如饥饿程度）是恒定的，并寻求最大化一个长期[平均速率](@entry_id:147100)。然而，在现实世界中，动物的决策往往取决于其当前的生理状态以及时间限制。例如，一个濒临饿死的动物可能会采取高风险、高回报的策略，而一个能量储备充足的动物则可能选择更保守的策略。

为了捕捉这种状态依赖的决策过程，[行为生态学](@entry_id:153262)家发展了**动态[状态变量](@entry_id:138790)模型 (Dynamic State Variable Models, DSVM)**，这是一种基于动态规划的更强大、更灵活的分析工具。

让我们以一个典型的DSVM场景为例 [@problem_id:2515925]：一只小鸟需要在一天结束（时间 $T$）前积累足够的能量储备以度过寒冷的夜晚。它的决策过程可以在离散的时间步 $t$ 上建模。

DSVM的关键组成部分包括：
- **[状态变量](@entry_id:138790) ($x$)**: 描述个体当前状况并影响其未来适应度的变量，例如能量储备。
- **决策 ($a$)**: 个体在每个时间步可以采取的行动，例如低风险[觅食](@entry_id:181461)、高风险觅食或休息。
- **时间范围 ($T$)**: 决策过程的终点，通常是有限的，如一天、一个季节。
- **[适应度函数](@entry_id:171063) ($V_t(x)$)**: 在时间 $t$、状态为 $x$ 时，从当前时刻到最终时刻所能获得的最大期望未来适应度（例如，最终存活的概率）。
- **终末适应度 ($g(x)$)**: 在时间 $T$ 到达时，处于状态 $x$ 的个体的最终适应度。例如，如果能量储备 $x \ge R$（生存所需阈值），则 $g(x)=1$（存活），否则 $g(x)=0$（死亡）。

DSVM的求解通常采用**反向归纳法 (backward induction)**。我们从最终时刻 $T$ 开始，反向推导每一时间步的最优决策。

在终末时刻 $T$，价值函数由终末[适应度函数](@entry_id:171063)直接给出：

$V_T(x) = g(x)$

对于任何 $t  T$ 的时刻，**[贝尔曼方程](@entry_id:138644) (Bellman equation)** 给出了价值函数的[递推关系](@entry_id:189264)。它指出，在当前状态下的最优价值，等于采取一个能最大化下一状态期望价值的行动所能获得的价值。形式上：

$V_t(x) = \max_{a \in \mathcal{A}} E[V_{t+1}(X_{t+1}) | x_t=x, a_t=a]$

这里的[期望值](@entry_id:153208)是基于采取行动 $a$ 后，从当前状态 $x$ 转移到所有可能的新状态 $x'$ 的概率加权平均。在一个包含生存和能量随机性的模型中，这个期望可以写成：

$V_t(x) = \max_{a} \sum_{x'} P(x' | x, a) V_{t+1}(x')$

其中，$P(x' | x, a)$ 是在状态 $x$ 采取行动 $a$ 后，在下一时间步存活下来并且能量状态变为 $x'$ 的总概率。这个转移概率内核 $P$ 巧妙地整合了与行动相关的生存概率和能量变化的随机性。

通过从 $T-1$ 逐步反向计算到 $t=0$，我们可以得到在任何时间、任何状态下的最优决策规则 $a^*(t,x)$。DSVM的强大之处在于，它不预设一个单一的优化目标（如最大化速率），而是基于一个更根本的适应度目标（如最大化生存概率），并能预测出依赖于个体内部[状态和](@entry_id:193625)外部环境（时间）的复杂、灵活的行为策略。这代表了[最优觅食理论](@entry_id:185884)从经典静态模型向更具现实主义和预测能力的动态框架的演进。