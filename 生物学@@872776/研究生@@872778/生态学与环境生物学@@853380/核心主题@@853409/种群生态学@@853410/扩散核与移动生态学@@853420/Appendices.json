{"hands_on_practices": [{"introduction": "扩散核完整地描述了运动的统计规律，但我们常常使用概括性统计量来掌握其主要特征。分布的矩，如均值和方差，是理解这些特征的基础。本练习 [@problem_id:2480505] 要求您计算两种经典核函数——拉普拉斯核和柯西核——的矩，从而揭示它们的数学性质如何决定其长距离扩散的能力，并判断哪些统计量是有意义的。", "problem": "一位种群生态学家使用不同的散布核，对沿直线分布的河岸廊道内的一维种子散布距离进行建模。设 $X$ 表示随机抽样的一颗种子从母株到其着陆位置的有符号位移（单位：米）。考虑将两种广泛使用的散布核作为 $X$ 的概率密度函数（PDF）：\n\n- 拉普拉斯核，其速率参数为 $\\lambda0$，由 $K_{L}(x) = \\frac{\\lambda}{2}\\exp(-\\lambda|x|)$ 给出，适用于所有实数 $x$。\n- 柯西核，其尺度参数为 $\\gamma0$，由 $K_{C}(x) = \\frac{1}{\\pi\\gamma}\\frac{1}{1+(x/\\gamma)^{2}}$ 给出，适用于所有实数 $x$。\n\n对于一个固定的非负实数 $p$，定义核 $K$ 的 $p$ 阶绝对矩为\n$$\n\\mu_{p}(K) \\equiv \\int_{-\\infty}^{\\infty} |x|^{p}\\,K(x)\\,\\mathrm{d}x.\n$$\n\n任务：\n1. 推导 $\\mu_{p}(K_{L})$ 关于 $p$ 和 $\\lambda$ 的闭式表达式。您可以使用伽马函数 $\\Gamma(\\cdot)$ 来表示您的答案。\n2. 对于柯西核，确定数值 $p^{\\star} \\equiv \\sup\\{p \\ge 0 : \\mu_{p}(K_{C})  \\infty\\}$。\n\n请将您的最终答案以一个二元行向量 $\\big[\\mu_{p}(K_{L}),\\,p^{\\star}\\big]$ 的形式报告。不需要四舍五入，最终报告的表达式中不应包含单位。", "solution": "所给出的问题陈述是在生态建模背景下的一个定义明确的数学练习。它包括两个独立的任务：计算拉普拉斯分布的 $p$ 阶绝对矩，以及确定柯西分布的 $p$ 阶绝对矩的收敛域。该问题具有科学依据，使用标准的数学定义，并包含了唯一解所需的所有必要信息。因此，该问题被认为是有效的，下面给出了完整的推导过程。\n\n核 $K(x)$ 的 $p$ 阶绝对矩定义为\n$$ \\mu_{p}(K) \\equiv \\int_{-\\infty}^{\\infty} |x|^{p}\\,K(x)\\,\\mathrm{d}x $$\n对于给定的 $p \\ge 0$。\n\n任务1：计算拉普拉斯核的 $\\mu_{p}(K_{L})$。\n\n拉普拉斯核由 $K_{L}(x) = \\frac{\\lambda}{2}\\exp(-\\lambda|x|)$ 给出，其中 $\\lambda  0$。我们将其代入矩的定义中：\n$$ \\mu_{p}(K_{L}) = \\int_{-\\infty}^{\\infty} |x|^{p} \\frac{\\lambda}{2}\\exp(-\\lambda|x|) \\,\\mathrm{d}x $$\n被积函数 $f(x) = |x|^{p} \\frac{\\lambda}{2}\\exp(-\\lambda|x|)$ 是 $x$ 的偶函数，因为 $|-x|^{p} = |x|^{p}$ 且 $|-x| = |x|$。因此，在 $(-\\infty, \\infty)$ 上的积分是在 $(0, \\infty)$ 上的积分的两倍：\n$$ \\mu_{p}(K_{L}) = 2 \\int_{0}^{\\infty} x^{p} \\frac{\\lambda}{2}\\exp(-\\lambda x) \\,\\mathrm{d}x = \\lambda \\int_{0}^{\\infty} x^{p} \\exp(-\\lambda x) \\,\\mathrm{d}x $$\n为使该积分收敛，我们需要 $p  -1$。由于问题规定 $p \\ge 0$，这个条件总是满足的。\n我们通过换元将该积分与伽马函数的标准定义 $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} \\exp(-t) \\,\\mathrm{d}t$ 联系起来。\n设 $t = \\lambda x$。则 $x = t/\\lambda$ 且 $\\mathrm{d}x = (1/\\lambda)\\mathrm{d}t$。积分上下限仍为从 $0$ 到 $\\infty$。\n将这些代入 $\\mu_{p}(K_{L})$ 的表达式中，得到：\n$$ \\mu_{p}(K_{L}) = \\lambda \\int_{0}^{\\infty} \\left(\\frac{t}{\\lambda}\\right)^{p} \\exp(-t) \\left(\\frac{1}{\\lambda}\\right) \\,\\mathrm{d}t $$\n$$ \\mu_{p}(K_{L}) = \\lambda \\left(\\frac{1}{\\lambda^{p}}\\right) \\left(\\frac{1}{\\lambda}\\right) \\int_{0}^{\\infty} t^{p} \\exp(-t) \\,\\mathrm{d}t $$\n$$ \\mu_{p}(K_{L}) = \\frac{1}{\\lambda^{p}} \\int_{0}^{\\infty} t^{(p+1)-1} \\exp(-t) \\,\\mathrm{d}t $$\n右侧的积分是伽马函数 $\\Gamma(p+1)$ 的定义。\n因此，拉普拉斯核的 $p$ 阶绝对矩的闭式表达式为：\n$$ \\mu_{p}(K_{L}) = \\frac{\\Gamma(p+1)}{\\lambda^{p}} $$\n\n任务2：确定柯西核的 $p^{\\star}$。\n\n柯西核由 $K_{C}(x) = \\frac{1}{\\pi\\gamma}\\frac{1}{1+(x/\\gamma)^{2}}$ 给出，其中 $\\gamma  0$。我们的任务是求出 $p^{\\star} = \\sup\\{p \\ge 0 : \\mu_{p}(K_{C})  \\infty\\}$。\n首先，我们写出 $\\mu_{p}(K_{C})$ 的表达式：\n$$ \\mu_{p}(K_{C}) = \\int_{-\\infty}^{\\infty} |x|^{p} \\frac{1}{\\pi\\gamma}\\frac{1}{1+(x/\\gamma)^{2}} \\,\\mathrm{d}x $$\n被积函数同样是偶函数，因此我们可以简化积分：\n$$ \\mu_{p}(K_{C}) = \\frac{2}{\\pi\\gamma} \\int_{0}^{\\infty} \\frac{x^{p}}{1+(x/\\gamma)^{2}} \\,\\mathrm{d}x $$\n为了确定对于哪些 $p \\ge 0$ 的值该积分是有限的，我们必须分析被积函数在积分限 $x \\to 0^{+}$ 和 $x \\to \\infty$ 附近的行为。\n设被积函数为 $g(x) = \\frac{x^{p}}{1+(x/\\gamma)^{2}}$。\n\n在 $x=0$ 附近，分母 $1+(x/\\gamma)^{2}$ 趋近于 $1$。因此，被积函数的行为类似于 $x^{p}$：\n$$ g(x) \\sim x^{p} \\quad \\text{as } x \\to 0^{+} $$\n对于某个小的 $\\delta  0$，积分 $\\int_{0}^{\\delta} x^{p} \\,\\mathrm{d}x$ 收敛当且仅当 $p  -1$。由于题目给定 $p \\ge 0$，该积分在下限 $x=0$ 附近总是收敛的。\n\n在 $x=\\infty$ 附近，分母中的项 $1$ 与 $(x/\\gamma)^{2}$ 相比可以忽略不计。因此，被积函数的行为类似于：\n$$ g(x) = \\frac{x^{p}}{1+x^{2}/\\gamma^{2}} \\sim \\frac{x^{p}}{x^{2}/\\gamma^{2}} = \\gamma^{2}x^{p-2} \\quad \\text{as } x \\to \\infty $$\n根据反常积分的极限比较判别法，对于某个大的 $M  0$，积分 $\\int_{M}^{\\infty} g(x) \\,\\mathrm{d}x$ 收敛当且仅当积分 $\\int_{M}^{\\infty} x^{p-2} \\,\\mathrm{d}x$ 收敛。\n后一个积分收敛当且仅当指数严格小于 $-1$：\n$$ p - 2  -1 \\implies p  1 $$\n为了使积分 $\\mu_{p}(K_{C})$ 有限，在 $x=0$ 和 $x=\\infty$ 处的收敛条件都必须满足。结合 $p \\ge 0$（来自问题陈述）和 $p  1$（来自我们的收敛性分析），我们发现对于区间 $[0, 1)$ 中的所有 $p$，该积分是有限的。\n矩为有限值的 $p$ 的集合是 $\\{p \\in \\mathbb{R} \\mid 0 \\le p  1\\}$。\n问题要求的是 $p^{\\star}$，即该集合的上确界。\n$$ p^{\\star} = \\sup [0, 1) = 1 $$\n\n两个结果是 $\\mu_{p}(K_{L}) = \\frac{\\Gamma(p+1)}{\\lambda^{p}}$ 和 $p^{\\star} = 1$。这些结果应以一个二元行向量的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\Gamma(p+1)}{\\lambda^{p}}  1\n\\end{pmatrix}\n}\n$$", "id": "2480505"}, {"introduction": "理论模型虽然强大，但将其应用于真实数据时，必须仔细处理观测过程本身带来的挑战。在野外生态学研究中，我们几乎不可能观测到每一个体，而探测到动物的概率可能取决于它移动的距离。本练习 [@problem_id:2480606] 探讨了这种不完美的探测如何系统性地使我们对扩散的估计产生偏差，并指导您构建一个统计上严谨的似然函数来纠正这个普遍存在的关键问题。", "problem": "一项野外实验在一个单一的起点释放了一群标记个体，随后使用一个空间探测系统回收了其中的一个子集。设个体从释放点出发的真实扩散距离为一个随机变量，其在 $r \\in [0,\\infty)$ 上的径向概率密度函数 (pdf) 为 $k_{r}(r \\mid \\theta)$，其中 $\\theta$ 是描述扩散核的具有生物学意义的参数。假设在扩散了距离 $r$ 的条件下，个体被探测到的概率为 $g(r)$，其中 $g(r)$ 是一个已知的关于 $r$ 的非增探测函数。假设释放了 $N$ 个个体，其中 $n$ 个被探测到，探测到的个体的观测距离为 $r_{1},\\dots,r_{n}$。你将仅使用被探测到个体的距离来估计 $\\theta$，以探测事件为条件，并将 $g(r)$ 视为已知。\n\n从条件概率和独立同分布 (i.i.d.) 抽样的基本原理出发，解释为什么当 $g(r)$ 随 $r$ 减小时，将 $k_{r}(r \\mid \\theta)$ 直接拟合 $r_{1},\\dots,r_{n}$ 的经验分布而不考虑 $g(r)$，通常会使估计值偏向于较短的扩散距离。然后，选择一个提供了在给定 $r_{1},\\dots,r_{n}$ 的条件下关于 $\\theta$ 的、包含了 $g(r)$ 的、正确归一化的条件似然的选项。\n\n哪个选项是正确的？\n\nA. 忽略 $g(r)$ 会将 $r$ 的经验分布拟合到一个稀疏化样本上，在该样本中，长距离的代表性不足，因为当 $g(r)$ 减小时，它们被探测到的可能性较小，从而将概率质量移向较小的 $r$。正确的条件似然是\n$$\nL(\\theta \\mid r_{1:n},\\mathrm{detected}) \\;=\\; \\prod_{i=1}^{n} \\frac{k_{r}(r_{i}\\mid \\theta)\\, g(r_{i})}{\\int_{0}^{\\infty} k_{r}(u\\mid \\theta)\\, g(u)\\, \\mathrm{d}u}.\n$$\n\nB. 忽略 $g(r)$ 会使估计值偏向于更长的距离，因为当 $g(r)$ 减小时，未被探测到的短距离移动会被遗漏。正确的条件似然使用逆探测加权来增加长距离的权重，形式为\n$$\nL(\\theta \\mid r_{1:n},\\mathrm{detected}) \\;=\\; \\prod_{i=1}^{n} \\frac{k_{r}(r_{i}\\mid \\theta)/ g(r_{i})}{\\int_{0}^{\\infty} k_{r}(u\\mid \\theta)/ g(u)\\, \\mathrm{d}u}.\n$$\n\nC. 忽略 $g(r)$ 对估计没有系统性影响，因为探测与核参数 $\\theta$ 无关。正确的条件似然只是简单地将观测值处的探测概率相乘，形式为\n$$\nL(\\theta \\mid r_{1:n},\\mathrm{detected}) \\;=\\; \\prod_{i=1}^{n} k_{r}(r_{i}\\mid \\theta)\\, g(r_{i}).\n$$\n\nD. 忽略 $g(r)$ 会低估长距离扩散，但正确的条件似然必须考虑环带的周长，给出\n$$\nL(\\theta \\mid r_{1:n},\\mathrm{detected}) \\;=\\; \\prod_{i=1}^{n} \\frac{k_{r}(r_{i}\\mid \\theta)\\, g(r_{i})\\, 2\\pi r_{i}}{\\int_{0}^{\\infty} k_{r}(u\\mid \\theta)\\, g(u)\\, 2\\pi u\\, \\mathrm{d}u}.\n$$", "solution": "我们从基本原理开始：条件概率和全概率定律。对于一个真实扩散距离 $R$ 的径向 pdf 为 $k_{r}(r\\mid \\theta)$ 并且在 $R=r$ 条件下探测概率为 $g(r)$ 的个体，事件 $\\{R \\in [r,r+\\mathrm{d}r), \\mathrm{detected}\\}$ 的联合概率是\n$$\n\\Pr\\{R \\in [r,r+\\mathrm{d}r), \\mathrm{detected} \\mid \\theta\\} \\;=\\; k_{r}(r\\mid \\theta)\\, \\mathrm{d}r \\cdot g(r).\n$$\n在 $\\theta$ 条件下，被探测到的边缘概率通过对所有可能的距离进行积分得到，\n$$\n\\Pr\\{\\mathrm{detected} \\mid \\theta\\} \\;=\\; \\int_{0}^{\\infty} k_{r}(u\\mid \\theta)\\, g(u)\\, \\mathrm{d}u.\n$$\n因此，根据条件概率的定义，被探测到的个体中 $R$ 的条件 pdf 是\n$$\nf_{\\mathrm{obs}}(r \\mid \\mathrm{detected}, \\theta) \\;=\\; \\frac{\\Pr\\{R \\in [r,r+\\mathrm{d}r), \\mathrm{detected} \\mid \\theta\\}}{\\Pr\\{\\mathrm{detected} \\mid \\theta\\}\\, \\mathrm{d}r} \\;=\\; \\frac{k_{r}(r\\mid \\theta)\\, g(r)}{\\int_{0}^{\\infty} k_{r}(u\\mid \\theta)\\, g(u)\\, \\mathrm{d}u}.\n$$\n给定 $n$ 个被探测到的个体，其距离 $r_{1},\\dots,r_{n}$ 是从 $f_{\\mathrm{obs}}(r \\mid \\mathrm{detected}, \\theta)$ 中抽取的条件独立同分布 (i.i.d.) 样本，$\\theta$ 的条件似然是\n$$\nL(\\theta \\mid r_{1:n}, \\mathrm{detected}) \\;=\\; \\prod_{i=1}^{n} f_{\\mathrm{obs}}(r_{i} \\mid \\mathrm{detected}, \\theta) \\;=\\; \\prod_{i=1}^{n} \\frac{k_{r}(r_{i}\\mid \\theta)\\, g(r_{i})}{\\int_{0}^{\\infty} k_{r}(u\\mid \\theta)\\, g(u)\\, \\mathrm{d}u}.\n$$\n\n这个推导阐明了如果忽略 $g(r)$ 会产生偏差的来源。如果 $g(r)$ 是关于 $r$ 的非增函数（例如，随着与释放点或探测器阵列的距离增加，探测变得更加困难），那么观测到的距离样本的分布与 $k_{r}(r\\mid \\theta)\\, g(r)$ 成正比。因为 $g(r)$ 降低了较大 $r$ 的权重，所以与真实的 $k_{r}(r\\mid \\theta)$ 相比，观测到的分布被移向了较小的 $r$。因此，将 $k_{r}(r\\mid \\theta)$ 直接拟合到 $r_{1},\\dots,r_{n}$ 的经验分布而不考虑 $g(r)$，等同于拟合到一个系统性降权的真实分布版本，这通常会使估计值偏向于较短的扩散距离。\n\n我们现在评估每个选项：\n\nA. 这个选项给出了正确的定性解释：当 $g(r)$ 随 $r$ 减小时，长距离移动被探测到的可能性较小，因此观测到的距离偏向于较小的 $r$。所呈现的似然函数与上面推导的条件似然一致：每个观测值 $r_{i}$ 贡献一个因子 $k_{r}(r_{i}\\mid \\theta) g(r_{i})$，再除以归一化常数 $\\int_{0}^{\\infty} k_{r}(u\\mid \\theta) g(u)\\, \\mathrm{d}u$，确保条件密度函数的积分为 $1$。结论 — 正确。\n\nB. 这个选项错误地声称在 $g(r)$ 减小时偏差会偏向更长的距离，这与稀疏化逻辑相矛盾。所提出的似然函数也不适当地在针对条件探测数据的似然中使用逆探测加权 $1/g(r)$；被探测样本的密度与 $k_{r}(r\\mid \\theta)\\, g(r)$ 成正比，而不是 $k_{r}(r\\mid \\theta)/g(r)$。此外，如果 $g(r)$ 变得很小，逆加权可能导致归一化积分发散。结论 — 错误。\n\nC. 这个选项声称没有系统性影响，这是错误的：在以探测为条件下，观测分布与真实分布相差一个因子 $g(r)$。该似然函数省略了关键的归一化分母 $\\int_{0}^{\\infty} k_{r}(u\\mid \\theta)\\, g(u)\\, \\mathrm{d}u$，该分母依赖于 $\\theta$，因此在比较参数值时不能省略。结论 — 错误。\n\nD. 这个选项正确地指出了对长距离扩散的低估，但引入了一个因子 $2\\pi r$，鉴于 $k_{r}(r\\mid \\theta)$ 被定义为距离的径向 pdf，这个因子是不恰当的。因子 $2\\pi r$ 出现在从平面上的各向同性位移矢量密度 $K(\\mathbf{x}\\mid \\theta)$ 变换到边缘距离密度时，因为 $\\mathrm{d}\\mathbf{x}$ 是对周长为 $2\\pi r$ 的圆进行积分。然而，一旦 $k_{r}(r\\mid \\theta)$ 被定义为 $R$ 本身的 pdf，因子 $2\\pi r$ 就已经包含在 $k_{r}(r\\mid \\theta)$ 中，不能再次引入。结论 — 错误。\n\n因此，只有选项 A 是正确的。", "answer": "$$\\boxed{A}$$", "id": "2480606"}, {"introduction": "运动生态学中的一个核心问题是，扩散在所有方向上是否均匀（各向同性），还是存在方向上的偏好（各向异性），例如受到河流或山脉等景观特征的影响。本计算练习 [@problem_id:2480590] 让您扮演数据分析师的角色，将一个二维高斯核拟合到运动数据上。您将学习如何使用强大的似然比检验来正式检验各向异性，从而将原始数据转化为定量的生态学洞见。", "problem": "您正在研究运动生态学中的二维动物位移数据，其中单步位移由高斯散布核建模。假设每个观测到的位移向量都是来自一个具有未知均值和未知协方差的多元正态分布的独立抽样。您需要通过最大似然法拟合一个各向异性的高斯核，然后检验各向同性的假设。\n\n使用的基本原理和定义：\n- 在维度 $d$ 中，均值向量为 $\\boldsymbol{\\mu}$、协方差矩阵为 $\\boldsymbol{\\Sigma}$ 的多元正态密度是经过充分检验的散布步长模型。对于独立观测，其似然函数由密度乘积得出，其对数似然函数是可加的。\n- 对于来自多元正态分布的独立样本，均值和协方差的最大似然估计量存在，并且可以通过在正定性约束下优化对数似然函数获得。似然比检验 (LRT) 使用原假设和备择假设下最大化似然函数的比率，Wilks 定理提供了该检验统计量的渐近零分布。\n\n数学设定：\n- 您观测到 $n$ 个二维位移向量 $\\{\\mathbf{x}_i\\}_{i=1}^n$，其中 $\\mathbf{x}_i \\in \\mathbb{R}^2$，假设它们独立同分布于 $\\mathcal{N}_2(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$。\n- 备择假设允许一个无约束的对称正定协方差矩阵 $\\boldsymbol{\\Sigma}$，代表一个各向异性的高斯散布核。\n- 各向同性的原假设将协方差约束为单位矩阵的标量倍，即 $\\boldsymbol{\\Sigma} = \\sigma^2 \\mathbf{I}_2$。\n\n任务：\n1. 给定模拟数据集（如下详述），在备择假设下，通过最大似然法估计均值 $\\boldsymbol{\\mu}$ 和协方差矩阵 $\\boldsymbol{\\Sigma}$。另外，在原假设下，通过最大似然法估计 $\\boldsymbol{\\mu}$ 和 $\\sigma^2$。\n2. 计算似然比检验统计量 $T = 2\\big(\\ell_{\\text{alt}} - \\ell_{\\text{null}}\\big)$，其中 $\\ell_{\\text{alt}}$ 和 $\\ell_{\\text{null}}$ 分别表示在备择模型和原模型下最大化的对数似然。在原假设下，且对于大样本 $n$，$T$ 近似服从 $\\chi^2_k$ 分布，其中 $k$ 等于两个模型之间自由协方差参数数量的差。在二维情况下，$k = 2$。\n3. 对每个数据集，计算其 $p$ 值，即在观测到的 $T$ 值处评估的 $\\chi^2_k$ 分布的上尾概率。\n\n角度单位要求：\n- 下文引入的任何旋转角度均以弧度为单位。\n\n单位：\n- 无需报告物理单位。所有输出均为无单位的概率。\n\n测试套件（您的程序将使用的数据生成机制；为保证可复现性，每个数据集都由固定的随机种子生成）：\n所有数据均为二维（$d = 2$），真实均值为零 $\\boldsymbol{\\mu} = \\mathbf{0}$，样本大小和协方差结构如下。在每种情况下，使用指定的种子从 $\\mathcal{N}_2(\\mathbf{0}, \\boldsymbol{\\Sigma}_{\\text{true}})$ 中抽取 $n$ 个样本。\n\n- 情况 A（各向同性，大样本）：$n = 500$，种子 $= 17$，$\\boldsymbol{\\Sigma}_{\\text{true}} = 4 \\mathbf{I}_2$。\n- 情况 B（轴对齐各向异性，大样本）：$n = 500$，种子 $= 29$，$\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathrm{diag}(9, 1)$。\n- 情况 C（旋转各向异性，大样本）：$n = 500$，种子 $= 97$。令 $\\theta = \\pi/6$（弧度）。定义旋转矩阵 $\\mathbf{R}(\\theta) = \\begin{pmatrix}\\cos \\theta  -\\sin \\theta \\\\ \\sin \\theta  \\cos \\theta\\end{pmatrix}$ 和轴对齐协方差 $\\mathbf{D} = \\mathrm{diag}(4, 1)$。设置 $\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathbf{R}(\\theta)\\,\\mathbf{D}\\,\\mathbf{R}(\\theta)^\\top$。\n- 情况 D（轻度各向异性，中等样本）：$n = 200$，种子 $= 1234$，$\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathrm{diag}(1.2, 0.8)$。\n- 情况 E（各向同性，较小样本）：$n = 50$，种子 $= 2021$，$\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathbf{I}_2$。\n\n实现和输出要求：\n- 您的程序必须使用上述种子，严格按照规定在内部生成数据集。\n- 仅使用从多元正态模型推导出的、基于原理的最大似然估计量，不得使用特设的启发式方法。\n- 对于每种情况，应用到似然比检验统计量 $T$ 上的 $\\chi^2_2$ 参考分布，计算各向同性检验的 $p$ 值。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。结果必须是对应于情况 A 到 E 的五个 $p$ 值，按 A, B, C, D, E 的顺序排列，每个值四舍五入到小数点后恰好六位。例如，一个带有占位符值的输出将如下所示：\"[0.123456,0.000321,0.543210,0.010000,0.999999]\"。", "solution": "该问题要求对二维高斯散布核的各向同性进行统计检验。我们有 $n$ 个独立同分布的位移向量 $\\{\\mathbf{x}_i\\}_{i=1}^n$，其中每个 $\\mathbf{x}_i \\in \\mathbb{R}^2$ 都假定为来自多元正态分布 $\\mathcal{N}_2(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$ 的一个样本。分析过程将首先在两个竞争假设下推导模型参数的最大似然估计量 (MLEs)，然后构建一个似然比检验 (LRT)。\n\n两个假设如下：\n原假设 $H_0$ 假定一个各向同性的散布核。这将协方差矩阵约束为单位矩阵的标量倍：\n$$ H_0: \\boldsymbol{\\Sigma} = \\sigma^2 \\mathbf{I}_2 $$\n其中 $\\sigma^2 > 0$ 是一个单一的方差参数，$\\mathbf{I}_2$ 是 $2 \\times 2$ 的单位矩阵。\n\n备择假设 $H_A$ 允许各向异性。这意味着协方差矩阵 $\\boldsymbol{\\Sigma}$ 是一个无约束的对称正定矩阵：\n$$ H_A: \\boldsymbol{\\Sigma} = \\begin{pmatrix} \\sigma_{11}  \\sigma_{12} \\\\ \\sigma_{21}  \\sigma_{22} \\end{pmatrix}, \\text{ with } \\sigma_{12} = \\sigma_{21} \\text{ and } \\boldsymbol{\\Sigma} \\succ 0 $$\n\n对于来自 $\\mathcal{N}_d(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$（维度 $d=2$）的 $n$ 个观测样本，其对数似然函数为：\n$$ \\ell(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{n}{2}\\log|\\boldsymbol{\\Sigma}| - \\frac{1}{2}\\sum_{i=1}^n (\\mathbf{x}_i - \\boldsymbol{\\mu})^\\top \\boldsymbol{\\Sigma}^{-1} (\\mathbf{x}_i - \\boldsymbol{\\mu}) $$\n\n首先，我们求解备择假设 $H_A$ 下的最大似然估计量。需要估计的参数是 $\\boldsymbol{\\mu}$ 和 $\\boldsymbol{\\Sigma}$。多元统计学的标准结果表明，最大似然估计量是样本均值和样本协方差矩阵（除数为 $n$）：\n$$ \\hat{\\boldsymbol{\\mu}}_{\\text{alt}} = \\frac{1}{n} \\sum_{i=1}^n \\mathbf{x}_i $$\n$$ \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}} = \\frac{1}{n} \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})^\\top $$\n将这些估计量代入对数似然函数，由于迹算子的性质，求和项得以简化：\n$$ \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})^\\top \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}^{-1} (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}}) = \\mathrm{tr}\\left(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}^{-1} \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})^\\top\\right) = \\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}^{-1} n \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) = n \\, \\mathrm{tr}(\\mathbf{I}_d) = nd $$\n因此，在 $H_A$ 下最大化的对数似然为：\n$$ \\ell_{\\text{alt}} = \\ell(\\hat{\\boldsymbol{\\mu}}_{\\text{alt}}, \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{n}{2}\\log|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}| - \\frac{nd}{2} $$\n\n接着，我们求解原假设 $H_0$ 下的最大似然估计量。参数是 $\\boldsymbol{\\mu}$ 和 $\\sigma^2$。在此约束下的对数似然函数为：\n$$ \\ell(\\boldsymbol{\\mu}, \\sigma^2 | H_0) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{nd}{2}\\log(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\|\\mathbf{x}_i - \\boldsymbol{\\mu}\\|^2_2 $$\n均值的最大似然估计量同样是样本均值，$\\hat{\\boldsymbol{\\mu}}_{\\text{null}} = \\hat{\\boldsymbol{\\mu}}_{\\text{alt}}$。我们将其表示为 $\\hat{\\boldsymbol{\\mu}}$。为了求出 $\\sigma^2$ 的最大似然估计量，我们将对数似然函数对 $\\sigma^2$ 求导并令其为零，得到：\n$$ \\hat{\\sigma}^2_{\\text{null}} = \\frac{1}{nd} \\sum_{i=1}^n \\|\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}\\|^2_2 $$\n平方和可以与无约束样本协方差矩阵的迹联系起来：\n$$ \\sum_{i=1}^n \\|\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}\\|^2_2 = \\sum_{i=1}^n \\mathrm{tr}\\left((\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})^\\top\\right) = \\mathrm{tr}\\left( \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})^\\top \\right) = \\mathrm{tr}(n \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) $$\n因此，在 $H_0$ 下 $\\sigma^2$ 的最大似然估计量是跨维度的总方差的平均值：\n$$ \\hat{\\sigma}^2_{\\text{null}} = \\frac{1}{d} \\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) $$\n将这些估计量代入原假设的对数似然函数，求和项变为 $\\frac{1}{2\\hat{\\sigma}^2_{\\text{null}}} (nd \\hat{\\sigma}^2_{\\text{null}}) = \\frac{nd}{2}$。在 $H_0$ 下最大化的对数似然为：\n$$ \\ell_{\\text{null}} = \\ell(\\hat{\\boldsymbol{\\mu}}, \\hat{\\sigma}^2_{\\text{null}}) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{nd}{2}\\log(\\hat{\\sigma}^2_{\\text{null}}) - \\frac{nd}{2} $$\n\n似然比检验统计量 $T$ 定义为最大化对数似然差值的两倍：\n$$ T = 2(\\ell_{\\text{alt}} - \\ell_{\\text{null}}) = 2 \\left( \\left(-\\frac{n}{2}\\log|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}|\\right) - \\left(-\\frac{nd}{2}\\log(\\hat{\\sigma}^2_{\\text{null}})\\right) \\right) $$\n$$ T = n \\left( d\\log(\\hat{\\sigma}^2_{\\text{null}}) - \\log|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}| \\right) = n \\log\\left( \\frac{(\\hat{\\sigma}^2_{\\text{null}})^d}{|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}|} \\right) $$\n代入 $\\hat{\\sigma}^2_{\\text{null}} = \\frac{1}{d}\\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}})$ 并设 $d=2$：\n$$ T = n \\log\\left( \\frac{\\left(\\frac{1}{2}\\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}})\\right)^2}{|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}|} \\right) $$\n该统计量比较了 $\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}$ 特征值的算术平均数的平方与其几何平均数（行列式）。\n\n根据 Wilks 定理，对于大样本 $n$，在原假设下，$T$ 渐近服从卡方随机变量分布。自由度 $k$ 是备择模型和原模型之间协方差矩阵中自由参数数量的差。当 $d=2$ 时，$H_A$ 有 3 个自由协方差参数（$\\sigma_{11}, \\sigma_{22}, \\sigma_{12}$），而 $H_0$ 有 1 个（$\\sigma^2$）。因此，$k = 3 - 1 = 2$。\n所以，在 $H_0$ 下，$T \\sim \\chi^2_2$。\n\n每个测试用例的步骤如下：\n$1$. 从指定的真实分布 $\\mathcal{N}_2(\\mathbf{0}, \\boldsymbol{\\Sigma}_{\\text{true}})$ 生成 $n$ 个数据点。\n$2$. 计算样本均值 $\\hat{\\boldsymbol{\\mu}}$ 和协方差矩阵的 MLE $\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}$。\n$3$. 使用推导出的公式计算 LRT 统计量 $T$。\n$4$. 计算 $p$ 值，即 $\\chi^2_2$ 分布的上尾概率，即 $P(X \\ge T)$，其中 $X \\sim \\chi^2_2$。这可以使用卡方分布的生存函数来计算。\n一个小的 $p$ 值（例如  0.05）提供了拒绝各向同性原假设而支持各向异性备择假设的证据。", "answer": "[0.793796,0.000000,0.000000,0.474661,0.598273]", "id": "2480590"}]}