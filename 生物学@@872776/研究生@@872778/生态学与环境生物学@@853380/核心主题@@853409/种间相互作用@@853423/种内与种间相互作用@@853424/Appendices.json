{"hands_on_practices": [{"introduction": "Lotka-Volterra 竞争模型是理解物种间相互作用的基础框架。本练习将引导你对一个对称的两种群系统进行核心的稳定性分析。通过推导平衡点和稳定性条件，你将揭示系统从稳定共存转变为竞争排斥的关键阈值，从而阐明种内竞争与种间竞争的相对强度是决定群落结构的基本原则。[@problem_id:2499857]", "problem": "两个物种的种群进行对称的种间干涉竞争。每个物种都表现出逻辑斯谛(logistic)的种内调节，并因另一物种的存在而经历额外的拥挤效应。设 $N_{1}(t)$ 和 $N_{2}(t)$ 分别表示物种1和物种2在时间 $t$ 的丰度。每个物种的人均增长遵循逻辑斯谛形式，并根据人均增长随总有效密度线性下降的原理，通过种间干涉进行修正。假设物种间具有相同的内禀增长率和环境承载力，以及一个共同的、非负的种间干涉系数。其动力学方程为\n$$\n\\frac{dN_{1}}{dt} \\;=\\; r\\,N_{1}\\left(1 - \\frac{N_{1} + \\alpha N_{2}}{K}\\right), \n\\qquad\n\\frac{dN_{2}}{dt} \\;=\\; r\\,N_{2}\\left(1 - \\frac{N_{2} + \\alpha N_{1}}{K}\\right),\n$$\n其中 $r0$ 是内禀增长率，$K0$ 是每个物种单独存在时的环境承载力，而 $\\alpha \\ge 0$ 衡量了相对于种内拥挤效应的种间干涉的人均强度。\n\n从具有种内自我限制和成对种间干涉的逻辑斯谛增长的基本定义出发，并利用平衡点附近的群落动力学线性化，推导出内部共存平衡点改变稳定性以及系统从稳定共存过渡到两个单物种平衡点之间的替代稳定状态（双稳态）的精确临界值 $\\alpha_{c}$。您的最终答案必须是一个没有单位的精确值。不要提供不等式。不要四舍五入；请提供一个精确值。", "solution": "该问题要求推导种间干涉系数的临界值 $\\alpha_{c}$，在该值下，一个对称的双物种竞争系统从稳定共存过渡到双稳态。该系统由洛特卡-沃尔泰拉（Lotka-Volterra）竞争方程描述：\n$$\n\\frac{dN_{1}}{dt} = r N_{1}\\left(1 - \\frac{N_{1} + \\alpha N_{2}}{K}\\right)\n$$\n$$\n\\frac{dN_{2}}{dt} = r N_{2}\\left(1 - \\frac{N_{2} + \\alpha N_{1}}{K}\\right)\n$$\n其中 $r  0$，$K  0$ 且 $\\alpha \\ge 0$。稳定性的转变取决于系统平衡点行为的质变，这一现象通过线性化和特征值分析来研究。\n\n首先，我们必须通过将时间导数设为零来确定系统的平衡点：$\\frac{dN_{1}}{dt} = 0$ 和 $\\frac{dN_{2}}{dt} = 0$。这会产生四个可能的平衡点 $(N_{1}^{*}, N_{2}^{*})$。\n由 $\\frac{dN_{1}}{dt} = 0$ 可得 $N_{1}^{*} = 0$ 或 $K - N_{1}^{*} - \\alpha N_{2}^{*} = 0$。\n由 $\\frac{dN_{2}}{dt} = 0$ 可得 $N_{2}^{*} = 0$ 或 $K - N_{2}^{*} - \\alpha N_{1}^{*} = 0$。\n\n这四个平衡点是：\n1.  两个物种都灭绝的平凡平衡点：$(0, 0)$。\n2.  物种2灭绝的边界平衡点：$(K, 0)$。\n3.  物种1灭绝的边界平衡点：$(0, K)$。\n4.  内部或共存平衡点，其中 $N_{1}^{*}  0$ 且 $N_{2}^{*}  0$。这需要解以下线性方程组：\n    $$\n    N_{1}^{*} + \\alpha N_{2}^{*} = K\n    $$\n    $$\n    \\alpha N_{1}^{*} + N_{2}^{*} = K\n    $$\n    令两个表达式相等，得到 $N_{1}^{*} + \\alpha N_{2}^{*} = \\alpha N_{1}^{*} + N_{2}^{*}$，简化后为 $N_{1}^{*}(1 - \\alpha) = N_{2}^{*}(1 - \\alpha)$。假设 $\\alpha \\neq 1$，我们得到 $N_{1}^{*} = N_{2}^{*}$。将此代入第一个方程，得到 $N_{1}^{*} + \\alpha N_{1}^{*} = K$，即 $N_{1}^{*}(1 + \\alpha) = K$。因此，共存平衡点为：\n    $$\n    \\left(N_{1}^{*}, N_{2}^{*}\\right) = \\left(\\frac{K}{1 + \\alpha}, \\frac{K}{1 + \\alpha}\\right)\n    $$\n对于所有允许的参数值（$K  0$, $\\alpha \\ge 0$），此平衡点在生物学上是有意义的（种群为正）。\n\n该共存平衡点的稳定性由系统在该点求值的雅可比矩阵的特征值决定。设 $f_{1}(N_{1}, N_{2}) = rN_{1} - \\frac{r}{K}N_{1}^{2} - \\frac{r\\alpha}{K}N_{1}N_{2}$ 和 $f_{2}(N_{1}, N_{2}) = rN_{2} - \\frac{r}{K}N_{2}^{2} - \\frac{r\\alpha}{K}N_{1}N_{2}$。雅可比矩阵 $J$ 为：\n$$\nJ(N_{1}, N_{2}) = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial N_{1}}  \\frac{\\partial f_{1}}{\\partial N_{2}} \\\\ \\frac{\\partial f_{2}}{\\partial N_{1}}  \\frac{\\partial f_{2}}{\\partial N_{2}} \\end{pmatrix} = \\begin{pmatrix} r\\left(1 - \\frac{2N_{1} + \\alpha N_{2}}{K}\\right)  -\\frac{r\\alpha N_{1}}{K} \\\\ -\\frac{r\\alpha N_{2}}{K}  r\\left(1 - \\frac{2N_{2} + \\alpha N_{1}}{K}\\right) \\end{pmatrix}\n$$\n我们在共存平衡点 $(N_{1}^{*}, N_{2}^{*}) = (\\frac{K}{1+\\alpha}, \\frac{K}{1+\\alpha})$ 处计算该矩阵：\n$$\nJ^{*} = \\begin{pmatrix} r\\left(1 - \\frac{2\\frac{K}{1+\\alpha} + \\alpha\\frac{K}{1+\\alpha}}{K}\\right)  -\\frac{r\\alpha}{K}\\left(\\frac{K}{1+\\alpha}\\right) \\\\ -\\frac{r\\alpha}{K}\\left(\\frac{K}{1+\\alpha}\\right)  r\\left(1 - \\frac{2\\frac{K}{1+\\alpha} + \\alpha\\frac{K}{1+\\alpha}}{K}\\right) \\end{pmatrix}\n$$\n简化矩阵元素：\n对角线元素是相同的：\n$J_{11}^{*} = J_{22}^{*} = r\\left(1 - \\frac{K(\\frac{2+\\alpha}{1+\\alpha})}{K}\\right) = r\\left(1 - \\frac{2+\\alpha}{1+\\alpha}\\right) = r\\left(\\frac{1+\\alpha - 2 - \\alpha}{1+\\alpha}\\right) = -\\frac{r}{1+\\alpha}$。\n非对角线元素也是相同的：\n$J_{12}^{*} = J_{21}^{*} = -\\frac{r\\alpha}{1+\\alpha}$。\n因此，在共存平衡点处的雅可比矩阵为：\n$$\nJ^{*} = \\begin{pmatrix} -\\frac{r}{1+\\alpha}  -\\frac{r\\alpha}{1+\\alpha} \\\\ -\\frac{r\\alpha}{1+\\alpha}  -\\frac{r}{1+\\alpha} \\end{pmatrix} = \\frac{r}{1+\\alpha} \\begin{pmatrix} -1  -\\alpha \\\\ -\\alpha  -1 \\end{pmatrix}\n$$\n通过求解特征方程 $\\det(J^{*} - \\lambda I) = 0$ 来找到特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} -\\frac{r}{1+\\alpha} - \\lambda  -\\frac{r\\alpha}{1+\\alpha} \\\\ -\\frac{r\\alpha}{1+\\alpha}  -\\frac{r}{1+\\alpha} - \\lambda \\end{pmatrix} = 0\n$$\n$$\n\\left(-\\frac{r}{1+\\alpha} - \\lambda\\right)^{2} - \\left(-\\frac{r\\alpha}{1+\\alpha}\\right)^{2} = 0\n$$\n这得到 $\\left(\\lambda + \\frac{r}{1+\\alpha}\\right)^{2} = \\left(\\frac{r\\alpha}{1+\\alpha}\\right)^{2}$。对两边取平方根，我们得到 $\\lambda + \\frac{r}{1+\\alpha} = \\pm \\frac{r\\alpha}{1+\\alpha}$。\n两个特征值为：\n$$\n\\lambda_{1} = -\\frac{r}{1+\\alpha} + \\frac{r\\alpha}{1+\\alpha} = \\frac{r(\\alpha-1)}{1+\\alpha}\n$$\n$$\n\\lambda_{2} = -\\frac{r}{1+\\alpha} - \\frac{r\\alpha}{1+\\alpha} = -\\frac{r(1+\\alpha)}{1+\\alpha} = -r\n$$\n当且仅当两个特征值的实部都为负时，共存平衡点是稳定的。由于 $r  0$ 且 $\\alpha \\ge 0$，所以 $\\lambda_2 = -r$ 总是负的。因此，稳定性取决于 $\\lambda_1$ 的符号。\n项 $\\frac{r}{1+\\alpha}$ 总是正的。因此，$\\lambda_1$ 的符号由 $(\\alpha - 1)$ 的符号决定。\n- 若 $0 \\le \\alpha  1$：则 $\\alpha - 1  0$，这意味着 $\\lambda_1  0$。两个特征值都为负。共存平衡点是稳定的。这对应于稳定共存，此时种间竞争弱于种内竞争。\n- 若 $\\alpha  1$：则 $\\alpha - 1  0$，这意味着 $\\lambda_1  0$。一个特征值为正，使得共存平衡点成为一个不稳定的鞍点。这对应于双稳态，此时种间竞争强于种内竞争，系统将演化到两个稳定边界平衡点 $(K, 0)$ 或 $(0, K)$ 中的一个。\n- 若 $\\alpha = 1$：则 $\\lambda_1 = 0$。这是共存平衡点稳定性发生变化的临界阈值。存在零特征值表明发生了分岔。\n\n从稳定共存到替代稳定状态（双稳态）的转变恰好发生在 $\\alpha$ 的某个值，在该值下，共存平衡点雅可比矩阵的主特征值从负变到正。这发生在特征值为零时。\n令 $\\lambda_1 = 0$：\n$$\n\\frac{r(\\alpha-1)}{1+\\alpha} = 0\n$$\n由于 $r  0$，这意味着 $\\alpha - 1 = 0$。\n临界值为 $\\alpha_{c} = 1$。\n在这个值上，种内和种间竞争效应是相同的。对于 $\\alpha  1$，系统支持共存。对于 $\\alpha  1$，系统表现出竞争排斥，胜者由初始条件决定。问题要求给出发生此转变的单个精确值 $\\alpha_{c}$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2499857"}, {"introduction": "在成对相互作用的基础上，我们现在来探讨更庞大的群落结构如何影响共存。本练习引入了非传递性竞争的概念，即著名的“石头-剪刀-布”动态。你将分析这种循环式的相互作用网络如何能让三个物种共存，即使在简单的成对分析预测会发生排斥的条件下也是如此，这揭示了一种维持生物多样性的强大机制。[@problem_id:2500076]", "problem": "考虑一个由三个竞争物种组成的均匀混合群落，其连续时间种群动力学由无量纲化的 Lotka–Volterra 竞争模型给出\n$$\n\\frac{dx_i}{d\\tau} \\;=\\; x_i\\left(1 - \\sum_{j=1}^{3} a_{ij}\\,x_j\\right), \\quad i \\in \\{1,2,3\\},\n$$\n其中 $x_i$ 是物种 $i$ 按其环境承载力缩放后的密度（因此单物种平衡点为 $x_i = 1$），$\\tau$ 是按内禀增长率缩放的时间，$a_{ij}  0$ 是相互作用系数，表示物种 $j$ 对物种 $i$ 的人均竞争效应。种内竞争通过 $a_{ii}=1$（对所有 $i$）进行标准化。\n\n考虑两种备选的相互作用网络，由参数 $0  \\alpha  1  \\beta$ 描述：\n\n- 非传递的石头–剪刀–布 (RPS) 网络：物种 $1$ 克制物种 $2$，物种 $2$ 克制物种 $3$，而物种 $3$ 克制物种 $1$。这由循环竞争矩阵捕获\n$$\nA_{\\mathrm{RPS}} \\;=\\;\n\\begin{pmatrix}\n1  \\alpha  \\beta \\\\\n\\beta  1  \\alpha \\\\\n\\alpha  \\beta  1\n\\end{pmatrix}.\n$$\n\n- 传递的等级网络：物种 $1$ 在竞争中压制物种 $2$，物种 $2$ 压制物种 $3$，同时物种 $1$ 也压制物种 $3$。这由以下矩阵捕获\n$$\nA_{\\mathrm{Tr}} \\;=\\;\n\\begin{pmatrix}\n1  \\alpha  \\alpha \\\\\n\\beta  1  \\alpha \\\\\n\\beta  \\beta  1\n\\end{pmatrix}.\n$$\n\n仅从模型定义、入侵增长率的定义以及局部稳定性的线性化原理出发，完成以下任务：\n\n1. 对于非传递的 RPS 网络，推导内部共存平衡点 $x^{\\ast}$，并通过对称性证明它在所有物种间产生相等的密度。然后，通过分析在 $x^{\\ast}$ 处的雅可比矩阵，从第一性原理出发推导区分此共存平衡点局部稳定与局部不稳定的关于 $\\alpha$ 和 $\\beta$ 的精确条件。\n\n2. 对于传递的等级网络，使用基于稀有物种人均增长率定义的入侵分析，论证对于 $0\\alpha1\\beta$，是否存在一个局部稳定的内部共存平衡点。\n\n最后，在您于第 1 部分中推导出的非传递 RPS 平衡点的精确稳定边界上，物种 $1$ 的平衡密度 $x_1^{\\ast}$ 的精确值是多少？将您的最终答案表示为一个无单位的精确数值，不要四舍五入。", "solution": "我们从无量纲化的 Lotka–Volterra 竞争系统开始\n$$\n\\frac{dx_i}{d\\tau} \\;=\\; x_i\\left(1 - \\sum_{j=1}^{3} a_{ij}\\,x_j\\right), \\quad a_{ii}=1, \\quad a_{ij}0.\n$$\n在任何内部平衡点 $x^{\\ast} \\in \\mathbb{R}_{0}^{3}$（所有 $x_i^{\\ast}0$），平衡条件通过设置 $\\frac{dx_i}{d\\tau}=0$ 得到，对于 $x_i^{\\ast}0$，这简化为\n$$\n\\sum_{j=1}^{3} a_{ij}\\,x_j^{\\ast} \\;=\\; 1, \\quad \\text{对 } i=1,2,3.\n$$\n其向量形式为\n$$\nA\\,x^{\\ast} \\;=\\; \\mathbf{1},\n$$\n其中 $A=\\{a_{ij}\\}$ 且 $\\mathbf{1}=(1,1,1)^{\\top}$。\n\n第 1 部分：非传递的石头–剪刀–布 (RPS) 网络。\n\n对于 RPS 情况，\n$$\nA_{\\mathrm{RPS}} \\;=\\;\n\\begin{pmatrix}\n1  \\alpha  \\beta \\\\\n\\beta  1  \\alpha \\\\\n\\alpha  \\beta  1\n\\end{pmatrix}, \\quad 0\\alpha1\\beta.\n$$\n该矩阵是一个第一行为 $(1,\\alpha,\\beta)$ 的循环矩阵，并且系统 $A_{\\mathrm{RPS}} x^{\\ast}=\\mathbf{1}$ 在物种标签的循环置换下保持不变，因此根据对称性，我们预期 $x_1^{\\ast}=x_2^{\\ast}=x_3^{\\ast}$。令 $x_1^{\\ast}=x_2^{\\ast}=x_3^{\\ast}=s$。那么每个平衡方程可写作\n$$\n1\\cdot s + \\alpha \\cdot s + \\beta \\cdot s \\;=\\; 1 \\quad \\Rightarrow \\quad s(1+\\alpha+\\beta)=1,\n$$\n这就得出了等密度共存平衡点\n$$\nx^{\\ast} \\;=\\; \\frac{1}{1+\\alpha+\\beta}\\,\\mathbf{1}.\n$$\n\n为评估局部稳定性，我们在 $x^{\\ast}$ 处将系统线性化。定义 $f_i(x) = x_i \\left(1 - \\sum_{j} a_{ij} x_j\\right)$。雅可比矩阵 $J$ 的元素为\n$$\nJ_{ij} \\;=\\; \\frac{\\partial f_i}{\\partial x_j} \\;=\\; \\delta_{ij}\\left(1 - \\sum_{k} a_{ik} x_k\\right) \\;-\\; x_i a_{ij}.\n$$\n在内部平衡点，括号中的项满足 $1 - \\sum_{k} a_{ik} x_k^{\\ast}=0$，因此雅可比矩阵简化为\n$$\nJ \\;=\\; -\\,\\mathrm{diag}(x^{\\ast})\\,A.\n$$\n对于 RPS 平衡点，$\\mathrm{diag}(x^{\\ast}) = s I$ 且 $s=\\frac{1}{1+\\alpha+\\beta}$，因此\n$$\nJ \\;=\\; -\\,s\\,A_{\\mathrm{RPS}}.\n$$\n所以，$J$ 的特征值是 $A_{\\mathrm{RPS}}$ 的特征值乘以 $-s$。局部稳定性要求 $J$ 的所有特征值都具有负实部，这等价于要求 $A_{\\mathrm{RPS}}$ 的所有特征值都具有正实部。\n\n因为 $A_{\\mathrm{RPS}}$ 是第一行为 $(1,\\alpha,\\beta)$ 的循环矩阵，其特征向量是离散傅里叶模，其特征值为\n$$\n\\lambda_0 \\;=\\; 1+\\alpha+\\beta, \\quad\n\\lambda_1 \\;=\\; 1+\\alpha \\,\\omega + \\beta \\,\\omega^{2}, \\quad\n\\lambda_2 \\;=\\; 1+\\alpha \\,\\omega^{2} + \\beta \\,\\omega,\n$$\n其中 $\\omega=\\exp\\!\\left(\\frac{2\\pi i}{3}\\right)= -\\frac{1}{2} + i \\frac{\\sqrt{3}}{2}$ 且 $\\omega^{2}=\\exp\\!\\left(\\frac{4\\pi i}{3}\\right)= -\\frac{1}{2} - i \\frac{\\sqrt{3}}{2}$。其实部分别为\n$$\n\\mathrm{Re}(\\lambda_0) \\;=\\; 1+\\alpha+\\beta \\;\\; 0,\n$$\n和\n$$\n\\mathrm{Re}(\\lambda_1) \\;=\\; 1 + \\alpha\\,\\mathrm{Re}(\\omega) + \\beta\\,\\mathrm{Re}(\\omega^2)\n\\;=\\; 1 - \\frac{\\alpha}{2} - \\frac{\\beta}{2}\n\\;=\\; 1 - \\frac{\\alpha+\\beta}{2},\n$$\n$$\n\\mathrm{Re}(\\lambda_2) \\;=\\; 1 + \\alpha\\,\\mathrm{Re}(\\omega^2) + \\beta\\,\\mathrm{Re}(\\omega)\n\\;=\\; 1 - \\frac{\\alpha}{2} - \\frac{\\beta}{2}\n\\;=\\; 1 - \\frac{\\alpha+\\beta}{2}.\n$$\n因此，共存平衡点的精确局部稳定性条件是\n$$\n1 - \\frac{\\alpha+\\beta}{2} \\;\\; 0 \\quad \\Longleftrightarrow \\quad \\alpha+\\beta \\;\\; 2.\n$$\n在稳定性边界上，\n$$\n\\alpha+\\beta \\;=\\; 2,\n$$\n$\\lambda_1$ 和 $\\lambda_2$ 这对特征值是纯虚数（其实部为零），表明在简化的竞争系统中发生了类霍普夫 (Hopf-like) 的稳定性丧失。\n\n在此边界上计算平衡密度 $x_1^{\\ast}$，使用 $x_1^{\\ast}=s=\\frac{1}{1+\\alpha+\\beta}$，因此\n$$\nx_1^{\\ast}\\Big|_{\\alpha+\\beta=2} \\;=\\; \\frac{1}{1+2} \\;=\\; \\frac{1}{3}.\n$$\n\n第 2 部分：传递的等级网络。\n\n对于传递矩阵\n$$\nA_{\\mathrm{Tr}} \\;=\\;\n\\begin{pmatrix}\n1  \\alpha  \\alpha \\\\\n\\beta  1  \\alpha \\\\\n\\beta  \\beta  1\n\\end{pmatrix}, \\quad 0\\alpha1\\beta,\n$$\n我们使用稀有物种人均增长率的定义来考察对边界平衡点的入侵情况。当只有物种 $i$ 在其单物种平衡点 $x_i=1$ 处持续存在且 $x_{j\\neq i}=0$ 时，一个稀有物种 $k\\neq i$ 的人均增长率为\n$$\n\\left.\\frac{1}{x_k}\\frac{dx_k}{d\\tau}\\right|_{\\text{rare in }i} \\;=\\; 1 - a_{ki}\\cdot 1 \\;=\\; 1 - a_{ki}.\n$$\n评估对物种 $1$ 的单种群落的入侵：\n- 物种 $2$ 在物种 $1$ 中稀有时：增长率 $= 1 - a_{21} = 1 - \\beta  0$。\n- 物种 $3$ 在物种 $1$ 中稀有时：增长率 $= 1 - a_{31} = 1 - \\beta  0$。\n\n因此，物种 $1$ 将物种 $2$ 和物种 $3$ 都从其单种群落中排斥出去。类似地，在物种 $2$ 的单种群落中，物种 $1$ 的增长率为 $1 - a_{12} = 1 - \\alpha  0$ 并入侵，而物种 $3$ 的增长率为 $1 - a_{32} = 1 - \\beta  0$ 并被排斥。在物种 $3$ 的单种群落中，物种 $2$ 的增长率为 $1 - a_{23} = 1 - \\alpha  0$ 并入侵，而物种 $1$ 的增长率为 $1 - a_{13} = 1 - \\alpha  0$ 也入侵。这种严格的方向性排斥和缺乏相互可入侵性表明，没有边界群落能以循环方式排斥所有入侵者来支持稳健的共存。特别是，顶级竞争者（物种 1）能抵抗其他两种物种的入侵，并且不存在类似于 RPS 循环的机制能让每个物种在稀有时恢复。因此，对于 $0\\alpha1\\beta$，该系统缺乏一个局部稳定的内部共存平衡点；全局动力学由有利于顶级物种的竞争排斥主导。\n\n所求计算的结论。\n\n从第 1 部分可知，非传递 RPS 共存平衡点的稳定性边界是 $\\alpha+\\beta=2$。在此边界上，内部平衡点仍然是 $x^{\\ast}=\\frac{1}{1+\\alpha+\\beta}\\mathbf{1}$，因此\n$$\nx_1^{\\ast} \\;=\\; \\frac{1}{3}.\n$$\n在所使用的无量纲化下，这是一个精确的无单位值。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2500076"}, {"introduction": "理论模型只有在与经验数据相结合时才能发挥其全部威力。这项计算练习通过关注捕食者-猎物动态来弥合这一差距。你将使用摄食实验数据来拟合一个 Holling Type II functional response 模型，并利用估计出的参数在 Rosenzweig-MacArthur 模型中预测种群平衡点，这个过程模拟了现代预测生态学的核心工作流程。[@problem_id:2499832]", "problem": "给定三个独立的摄食实验数据集，这些数据集量化了消费者在不同资源密度下对单一资源的单位个体消耗率，以及相应的消费者-资源种群动态参数。您的任务是编写一个完整的、可运行的程序，为每个数据集估计霍林II型功能反应参数，然后预测在生产力变化下的平衡密度。\n\n基本原理：\n- 霍林II型功能反应：单位个体消耗率作为资源密度 $R$ 的函数由 $f(R) = \\dfrac{a R}{1 + a h R}$ 给出，其中 $a \\gt 0$ 是攻击率， $h \\gt 0$ 是处理时间。\n- 消费者-资源动态遵循从逻辑斯谛资源增长和饱和功能反应推导出的 Rosenzweig-MacArthur 形式：\n  - 资源：$\\dfrac{dR}{dt} = r R \\left(1 - \\dfrac{R}{K}\\right) - f(R) C$，\n  - 消费者：$\\dfrac{dC}{dt} = e f(R) C - m C$，\n  其中 $r \\gt 0$ 是资源的内禀增长率， $K \\gt 0$ 是环境承载力， $e \\in (0,1]$ 是同化效率， $m \\gt 0$ 是消费者的单位个体死亡率。\n- 所有时间量单位为小时，密度单位为个体/平方米，速率单位为/小时。功能反应 $f(R)$ 的单位是 猎物/（捕食者·小时）。参数 $a$ 和 $h$ 的单位分别是 平方米/（捕食者·小时）和 小时/猎物。平衡密度 $R^{\\star}$ 和 $C^{\\star}$ 必须以个体/平方米（对于 $R^{\\star}$）和捕食者/平方米（对于 $C^{\\star}$）报告，表示为四舍五入到六位小数的小数。\n\n估计任务：\n- 对于每个数据集，您必须通过最小化观测到的单位个体消耗率与模型预测 $f(R)$ 之间的残差平方和来估计 $a$ 和 $h$，并满足约束条件 $a \\gt 0$ 和 $h \\gt 0$。使用非线性最小二乘法。\n\n平衡预测任务：\n- 对于每个数据集，在估计出 $(\\hat a, \\hat h)$ 后，通过求解稳态条件 $\\dfrac{dR}{dt} = 0$ 和 $\\dfrac{dC}{dt} = 0$，确定消费者-资源系统在两种生产力情景下的平衡密度 $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}})$：基线环境承载力 $K$ 和改变后的环境承载力 $K_{\\mathrm{alt}}$（所有其他参数保持不变）。\n- 返回具有非负密度的生物学上可接受的平衡。如果没有消费者为正的平衡（例如，如果稳态条件的解没有产生 $R \\gt 0$ 且 $C \\gt 0$ 的情况，或者消费者能够持续生存的假定 $R^{\\star}$ 不小于 $K$），则该情景下实现的平衡是消费者灭绝，即 $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}}) = (K, 0)$。\n\n测试套件：\n每个测试用例包含一个摄食实验数据集、种群参数 $(r, K, e, m)$ 和一个改变后的环境承载力 $K_{\\mathrm{alt}}$。摄食实验数据以配对 $(R_i, y_i)$ 的形式给出，其中 $R_i$ 是资源密度（个体/平方米），$y_i$ 是观测到的单位个体消耗率（猎物/（捕食者·小时））。\n\n案例 1：\n- 摄食数据：$(R_i, y_i)$ for $i=1,\\dots,5$：\n  - $(2, 0.226415)$, $(5, 0.521739)$, $(10, 0.923077)$, $(20, 1.500000)$, $(40, 2.181818)$。\n- 参数：$r = 0.03$, $K = 60$, $e = 0.6$, $m = 0.02$。\n- 改变后的生产力：$K_{\\mathrm{alt}} = 30$。\n\n案例 2：\n- 摄食数据：$(R_i, y_i)$ for $i=1,\\dots,5$：\n  - $(1, 0.019802)$, $(5, 0.095238)$, $(10, 0.181818)$, $(30, 0.461538)$, $(80, 0.888889)$。\n- 参数：$r = 0.02$, $K = 8$, $e = 0.3$, $m = 0.05$。\n- 改变后的生产力：$K_{\\mathrm{alt}} = 20$。\n\n案例 3：\n- 摄食数据：$(R_i, y_i)$ for $i=1,\\dots,5$：\n  - $(2, 0.129032)$, $(10, 0.363636)$, $(25, 0.500000)$, $(50, 0.571429)$, $(100, 0.615385)$。\n- 参数：$r = 0.04$, $K = 120$, $e = 0.2$, $m = 0.3$。\n- 改变后的生产力：$K_{\\mathrm{alt}} = 240$。\n\n输出规范：\n- 对于每个案例，按顺序输出六元浮点数元组\n  $(\\hat a, \\hat h, R^{\\mathrm{eq}}_{\\text{base}}, C^{\\mathrm{eq}}_{\\text{base}}, R^{\\mathrm{eq}}_{\\text{alt}}, C^{\\mathrm{eq}}_{\\text{alt}})$，\n  其中 $(\\hat a, \\hat h)$ 是拟合参数，$(R^{\\mathrm{eq}}_{\\text{base}}, C^{\\mathrm{eq}}_{\\text{base}})$ 是基线 $K$ 下的平衡密度，$(R^{\\mathrm{eq}}_{\\text{alt}}, C^{\\mathrm{eq}}_{\\text{alt}})$ 是 $K_{\\mathrm{alt}}$ 下的平衡密度。所有六个数字都必须四舍五入到六位小数。\n- 将三个案例的结果按案例1、案例2、案例3的顺序汇总到一个列表中，得到一个包含18个浮点数的列表。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[x1,x2,...,x18]”）。\n\n科学真实性与约束：\n- 仅使用所提供的数据和上述基本原理。不要假设任何非从基本原理推导出的额外结构或捷径（例如，不要在未从稳态条件确立平衡的闭式解表达式的情况下对其进行硬编码）。在估计中强制执行 $a \\gt 0$，$h \\gt 0$，并且只报告具有非负密度的平衡。", "solution": "该问题陈述已经过严格验证，被认为是科学上合理、良定且客观的。它为理论生态学中的一个标准问题提供了一套完整且一致的信息。所指定的模型——霍林II型功能反应和Rosenzweig-MacArthur消费者-资源动态——是该领域的基本概念。数据和参数是合理的，任务定义清晰。因此，该问题是有效的，并将提供一个解决方案。\n\n对每个测试用例的求解过程分为两个阶段。首先，从提供的摄食实验数据中估计功能反应模型的参数。其次，使用这些估计出的参数来预测消费者-资源系统在两种不同生产力情景下的平衡密度。\n\n**第一部分：霍林II型功能反应的参数估计**\n\n霍林II型功能反应描述了单位个体消耗率 $f(R)$ 作为资源密度 $R$ 的函数。其数学表达式为：\n$$ f(R) = \\frac{a R}{1 + a h R} $$\n其中 $a$ 是消费者的攻击率， $h$ 是处理时间。两个参数都必须为正，即 $a  0$ 和 $h  0$。\n\n任务是从给定的资源密度和消耗率观测数据集 $(R_i, y_i)$ 中估计 $\\hat{a}$ 和 $\\hat{h}$ 的值。这通过寻找使观测速率 $y_i$ 与模型预测速率 $f(R_i)$ 之间的残差平方和 (SSR) 最小化的参数值来实现。需要最小化的目标函数是：\n$$ \\text{SSR}(a, h) = \\sum_{i} \\left( y_i - f(R_i; a, h) \\right)^2 $$\n这是一个非线性最小二乘回归问题。它将通过适当的数值算法（如Levenberg-Marquardt算法）来求解，该算法在 `scipy.optimize.curve_fit` 函数中有实现。在优化过程中将严格执行约束条件 $a  0$ 和 $h  0$。\n\n**第二部分：消费者-资源系统的平衡分析**\n\n消费者-资源相互作用的动态由Rosenzweig-MacArthur模型描述：\n$$ \\frac{dR}{dt} = r R \\left(1 - \\frac{R}{K}\\right) - f(R) C $$\n$$ \\frac{dC}{dt} = e f(R) C - m C $$\n这里，$R$ 和 $C$ 分别是资源和消费者种群的密度。参数 $r, K, e, m$ 分别代表资源的内禀增长率、资源的环境承载力、消费者的同化效率和消费者的死亡率。函数 $f(R)$ 是霍林II型功能反应，其参数 $\\hat{a}$ 和 $\\hat{h}$ 在第一部分中估计得出。\n\n平衡密度，表示为 $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}})$，通过将两个时间导数都设为零来找到：$\\frac{dR}{dt} = 0$ 和 $\\frac{dC}{dt} = 0$。\n\n从消费者方程 $\\frac{dC}{dt} = C(e f(R) - m) = 0$ 中，我们确定了平衡状态的两种可能解：\n\n1.  **消费者灭绝平衡：** 一个解是 $C^{\\mathrm{eq}} = 0$。如果消费者不存在，资源方程简化为标准的逻辑斯谛增长模型：$\\frac{dR}{dt} = r R (1 - \\frac{R}{K}) = 0$。其非平凡解是 $R = K$。因此，在 $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}}) = (K, 0)$ 处存在一个生物学上稳定的平衡。这代表消费者种群已经灭绝，而资源种群稳定在其环境承载力上的状态。\n\n2.  **共存平衡：** 对于具有正消费者密度 ($C  0$) 的解，必须满足条件 $e f(R) - m = 0$。代入功能反应的形式，我们得到：\n    $$ e \\frac{\\hat{a} R}{1 + \\hat{a} \\hat{h} R} = m $$\n    解出 $R$ 得到维持非零消费者种群所需的资源密度 $R^\\star$：\n    $$ R^\\star = \\frac{m}{\\hat{a}(e - m \\hat{h})} $$\n    为了使 $R^\\star$ 为正且具有物理意义，分母必须为正。由于 $\\hat{a}  0$，这要求条件 $e - m \\hat{h}  0$。如果 $e \\le m \\hat{h}$，无论资源多寡，消费者的增长都无法超过其死亡率。在这种情况下，共存平衡是不可能的，系统将退化为消费者灭绝平衡 $(K, 0)$。\n\n    如果 $e  m \\hat{h}$，我们得到一个有效的 $R^\\star  0$。然后我们将 $R = R^\\star$ 代入资源的稳态方程 $\\frac{dR}{dt} = 0$：\n    $$ r R^\\star \\left(1 - \\frac{R^\\star}{K}\\right) - f(R^\\star) C = 0 $$\n    利用在此平衡点 $f(R^\\star) = m/e$ 这一事实，我们可以解出消费者密度 $C^\\star$：\n    $$ C^\\star = \\frac{er}{m} R^\\star \\left(1 - \\frac{R^\\star}{K}\\right) $$\n    为了使 $C^\\star$ 为正，等式右侧的所有项都必须为正。这引出最终条件：$1 - \\frac{R^\\star}{K}  0$，即 $R^\\star  K$。此条件意味着资源的环境承载力必须大于支持消费者所需的资源水平。如果 $R^\\star \\ge K$，消费者的效率太低，无法建立种群，唯一的稳定状态同样是 $(K, 0)$。\n\n总而言之，对于给定的一组参数 $(\\hat{a}, \\hat{h}, r, K, e, m)$，生物学上可接受的平衡 $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}})$ 的确定方法如下：\n- 计算 $R^\\star = \\frac{m}{\\hat{a}(e - m \\hat{h})}$。\n- 如果 $e  m \\hat{h}$ 且 $R^\\star  K$，则共存平衡为 $(R^\\star, C^\\star = \\frac{er}{m} R^\\star (1 - \\frac{R^\\star}{K}))$。\n- 否则，平衡点为 $(K, 0)$。\n\n这整个分析过程将针对三个测试用例中的每一个进行实施，首先使用基线环境承载力 $K$，然后使用改变后的环境承载力 $K_{\\mathrm{alt}}$。最终的程序将执行这些步骤并按规定格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all given test cases.\n    It estimates functional response parameters and calculates equilibrium densities.\n    \"\"\"\n    \n    # Holling Type II functional response model\n    def holling_type_2(R, a, h):\n        \"\"\"\n        Calculates per-capita consumption rate using Holling Type II model.\n        R: resource density (scalar or array)\n        a: attack rate\n        h: handling time\n        \"\"\"\n        return (a * R) / (1.0 + a * h * R)\n\n    def calculate_equilibrium(a, h, r, K, e, m):\n        \"\"\"\n        Calculates the stable equilibrium densities (R_eq, C_eq) for the\n        Rosenzweig-MacArthur model.\n        \"\"\"\n        # Condition for consumer persistence: e > m*h.\n        # If not met, consumer cannot survive.\n        if e = m * h:\n            return float(K), 0.0\n\n        # Calculate the resource density required to support the consumer (R_star).\n        # This is the consumer isocline for C > 0.\n        R_star = m / (a * (e - m * h))\n        \n        # Condition for coexistence: R_star must be less than K.\n        # If R_star >= K, the resource cannot support the consumer, leading to extinction.\n        if R_star >= K:\n            return float(K), 0.0\n\n        # If conditions for coexistence are met, calculate the consumer density C_star.\n        # This is derived from the resource isocline at R = R_star.\n        C_star = (e * r / m) * R_star * (1.0 - R_star / K)\n\n        return R_star, C_star\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"data\": np.array([\n                [2.0, 0.226415], [5.0, 0.521739], [10.0, 0.923077], [20.0, 1.500000], [40.0, 2.181818]\n            ]),\n            \"params\": (0.03, 60.0, 0.6, 0.02),  # r, K, e, m\n            \"K_alt\": 30.0\n        },\n        {\n            \"data\": np.array([\n                [1.0, 0.019802], [5.0, 0.095238], [10.0, 0.181818], [30.0, 0.461538], [80.0, 0.888889]\n            ]),\n            \"params\": (0.02, 8.0, 0.3, 0.05),  # r, K, e, m\n            \"K_alt\": 20.0\n        },\n        {\n            \"data\": np.array([\n                [2.0, 0.129032], [10.0, 0.363636], [25.0, 0.500000], [50.0, 0.571429], [100.0, 0.615385]\n            ]),\n            \"params\": (0.04, 120.0, 0.2, 0.3),  # r, K, e, m\n            \"K_alt\": 240.0\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        R_data = case[\"data\"][:, 0]\n        y_data = case[\"data\"][:, 1]\n        r, K_base, e, m = case[\"params\"]\n        K_alt = case[\"K_alt\"]\n\n        # Step 1: Estimate parameters a and h using nonlinear least squares.\n        # The bounds [1e-9, 1e-9] enforce a > 0 and h > 0.\n        try:\n            popt, _ = curve_fit(holling_type_2, R_data, y_data, bounds=([1e-9, 1e-9], [np.inf, np.inf]))\n            a_hat, h_hat = popt\n        except RuntimeError:\n            # Handle cases where the fit fails, though not expected with this data.\n            a_hat, h_hat = np.nan, np.nan\n        \n        # Step 2: Calculate equilibrium for the baseline carrying capacity K_base.\n        R_eq_base, C_eq_base = calculate_equilibrium(a_hat, h_hat, r, K_base, e, m)\n\n        # Step 3: Calculate equilibrium for the altered carrying capacity K_alt.\n        R_eq_alt, C_eq_alt = calculate_equilibrium(a_hat, h_hat, r, K_alt, e, m)\n\n        # Step 4: Collect and round the results to six decimal places.\n        case_results = [\n            round(a_hat, 6),\n            round(h_hat, 6),\n            round(R_eq_base, 6),\n            round(C_eq_base, 6),\n            round(R_eq_alt, 6),\n            round(C_eq_alt, 6)\n        ]\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```", "id": "2499832"}]}