{"hands_on_practices": [{"introduction": "理论生态学的一个核心问题是，物种间的竞争如何决定群落的结构和多样性。Lotka-Volterra 竞争模型为我们提供了一个经典且强大的框架，用以分析两个物种间的动态关系。通过这个练习 ([@problem_id:2535012])，你将运用该模型来确定稳定共存的条件，这直接关联到生态位理论中的核心思想：为了实现稳定共存，种内竞争的限制作用必须强于种间竞争。这不仅是对高斯（Gause）竞争排斥原理的实践检验，也是对生态位分化如何促进生物多样性的深刻理解。", "problem": "两种草本植物物种，标记为物种$1$和物种$2$，在一个$1 \\times 1$米的均质地块上竞争单一的限制性土壤养分。经验性的田野估算提供了以下参数：内禀增长率 $r_{1} = 0.20$ 天$^{-1}$ 和 $r_{2} = 0.15$ 天$^{-1}$；环境承载力 $K_{1} = 400$ 和 $K_{2} = 300$ 个体/平方米；以及种间竞争系数 $\\alpha_{12} = 0.40$ 和 $\\alpha_{21} = 0.60$，其中 $\\alpha_{ij}$ 量化了物种$j$对物种$i$的影响相对于物种$i$对自身的影响。假设种群动态遵循经典的双物种Lotka–Volterra (LV)竞争框架，每个物种具有逻辑斯谛自我限制，并且参数不随时间变化。仅使用生态位作为资源和条件的共同利用的核心定义，以及LV模型中关于种内与种间竞争的表述，从第一性原理出发，判断在这些参数下是否预期存在一个局部稳定的内部共存状态，如果存在，则计算其内部共存平衡点。只需报告物种$1$的平衡丰度（即物种$1$的平衡密度），以个体/平方米为单位。将你的答案四舍五入到四位有效数字。", "solution": "该问题要求分析一个由经典Lotka-Volterra (LV)竞争模型控制的双物种竞争系统。在计算任何值之前，我们必须首先验证局部稳定共存平衡的条件。\n\n这两个物种的种群动态，其种群密度为$N_1$和$N_2$，由以下耦合微分方程组描述：\n$$ \\frac{dN_1}{dt} = r_1 N_1 \\left( 1 - \\frac{N_1 + \\alpha_{12} N_2}{K_1} \\right) $$\n$$ \\frac{dN_2}{dt} = r_2 N_2 \\left( 1 - \\frac{N_2 + \\alpha_{21} N_1}{K_2} \\right) $$\n提供的参数是：\n内禀增长率：$r_1 = 0.20$, $r_2 = 0.15$。\n环境承载力：$K_1 = 400$, $K_2 = 300$。\n竞争系数：$\\alpha_{12} = 0.40$, $\\alpha_{21} = 0.60$。\n\n当两个物种的净增长率均为零时，出现内部共存平衡（$N_1^* > 0$, $N_2^* > 0$）。这需要找到非平凡零增长等斜线的交点。通过将导数设为零来找到等斜线：\n对于物种$1$（$\\frac{dN_1}{dt} = 0$）：\n$$ 1 - \\frac{N_1 + \\alpha_{12} N_2}{K_1} = 0 \\implies N_1 + \\alpha_{12} N_2 = K_1 $$\n对于物种$2$（$\\frac{dN_2}{dt} = 0$）：\n$$ 1 - \\frac{N_2 + \\alpha_{21} N_1}{K_2} = 0 \\implies \\alpha_{21} N_1 + N_2 = K_2 $$\n\n只有当两个物种的种间竞争在相对意义上都弱于种内竞争时，才可能存在局部稳定的共存平衡。这个导致稳定平衡的相互入侵条件，可以表述为一对不等式：每个物种都必须能够在另一物种处于其环境承载力时从低密度开始增长。\n1. 为使物种$1$能入侵处于环境承载力（$N_2=K_2$）的物种$2$的种群，其增长率$\\frac{dN_1}{dt}$必须为正。这要求在$N_1 \\approx 0$和$N_2 = K_2$时，其增长方程中的括号项为正。这得出了条件$K_1 > \\alpha_{12} K_2$。\n2. 为使物种$2$能入侵处于环境承载力（$N_1=K_1$）的物种$1$的种群，其增长率$\\frac{dN_2}{dt}$必须为正。这得出了条件$K_2 > \\alpha_{21} K_1$。\n\n我们必须使用给定的参数验证这些条件：\n条件1：$K_1 > \\alpha_{12} K_2$ 是否成立？\n$$ 400 > 0.40 \\times 300 $$\n$$ 400 > 120 $$\n这个不等式成立。物种$1$可以入侵物种$2$的单种群落。\n\n条件2：$K_2 > \\alpha_{21} K_1$ 是否成立？\n$$ 300 > 0.60 \\times 400 $$\n$$ 300 > 240 $$\n这个不等式也成立。物种$2$可以入侵物种$1$的单种群落。\n\n由于相互入侵的两个条件都得到满足，因此存在一个局部稳定的内部共存平衡点。现在我们可以通过求解等斜线的线性方程组来计算平衡密度：\n$$ N_1^* + \\alpha_{12} N_2^* = K_1 $$\n$$ \\alpha_{21} N_1^* + N_2^* = K_2 $$\n使用克莱姆法则或代入法，平衡密度（$N_1^*$, $N_2^*$）的解是：\n$$ N_1^* = \\frac{K_1 - \\alpha_{12} K_2}{1 - \\alpha_{12} \\alpha_{21}} $$\n$$ N_2^* = \\frac{K_2 - \\alpha_{21} K_1}{1 - \\alpha_{12} \\alpha_{21}} $$\n问题要求物种$1$的平衡丰度$N_1^*$。将给定值代入$N_1^*$的公式中：\n$$ N_1^* = \\frac{400 - (0.40)(300)}{1 - (0.40)(0.60)} $$\n$$ N_1^* = \\frac{400 - 120}{1 - 0.24} $$\n$$ N_1^* = \\frac{280}{0.76} $$\n进行除法运算：\n$$ N_1^* = \\frac{28000}{76} = \\frac{7000}{19} \\approx 368.42105... $$\n问题要求答案四舍五入到四位有效数字。\n$$ N_1^* \\approx 368.4 $$\n物种$1$的平衡丰度是$368.4$个体/平方米。", "answer": "$$\\boxed{368.4}$$", "id": "2535012"}, {"introduction": "将 G. Evelyn Hutchinson 的 $n$ 维超体积生态位概念从理论转化为可操作的量化分析，是现代生态学的一大挑战。当我们面对物种在不同区域的实际出现点数据时，如何客观地比较它们的生态位？这个练习 ([@problem_id:2535013]) 提供了一个完整的计算生态学工作流程，指导你如何使用核密度估计来量化生态位，并计算它们之间的重叠度。更重要的是，它引入了基于置换和重抽样的统计检验，使你能够区分真实的生态位分化与由环境背景差异或取样偏差引起的表观差异，这在入侵生物学和保护生物学研究中是一项至关重要的技能。", "problem": "给定 Hutchinson 生态位概念在二维环境空间中的形式化表达。来自原生区和入侵区的出现点被视为来自环境空间上未知概率密度函数的独立同分布样本。两个额外的点云（称为背景）代表每个区域的环境可利用性，相关的非负权重代表背景采样中的采样偏差。\n\n仅使用以下基本原理：\n- 物种的生态位是由环境变量上的联合概率分布定义的环境空间的子集，而出现点是该分布的样本。\n- 使用高斯核的核密度估计产生一个非负、可积的函数，可以逼近未知的密度函数。\n- $L^{1}$ 距离衡量两个概率分布之间的绝对差异，而 Hellinger 距离衡量其平方根变换后密度之间的欧几里得距离。\n\n您的任务是：\n1) 通过减去合并背景的均值并除以合并背景的标准差（在两个区域的背景上联合计算，并按维度应用于每个点），对所有环境变量进行标准化。如果任何维度上的合并背景标准差为 $0$，则用一个小的正常数 $10^{-8}$ 替换，以避免除以零。\n\n2) 使用高斯核密度估计器为每个出现点集估计一个连续密度。在大小为 $G \\times G$ 的规则笛卡尔网格上评估每个密度，该网格跨越合并背景在每个轴上的最小值和最大值，并通过在每个轴上扩展 $m$ 倍合并背景范围的填充边距。通过一个非负栅格来近似网格上产生的连续密度，该栅格在具有恒定网格单元面积 $\\Delta x \\Delta y$ 的黎曼和下总和为 $1$。\n\n3) 计算两个栅格化密度之间的两个生态位重叠度量：\n- 一个基于 $L^{1}$ 的重叠度，通过将 $L^{1}$ 距离按 $1/2$ 缩放后，用 $1$ 减去该值，从而将 $L^{1}$ 距离映射到单位区间。\n- 一个基于 Hellinger 的重叠度，通过将平方 Hellinger 距离按 $1/2$ 缩放后，用 $1$ 减去该值，从而将平方 Hellinger 距离映射到单位区间。\n两个重叠度量都必须在闭区间 $\\left[0,1\\right]$ 内，其中 $1$ 表示栅格化密度相同，$0$ 表示在离散化中支持集不相交。\n\n4) 基于 $L^{1}$ 重叠度的生态位等价性检验：在两个出现样本来自相同潜在生态位的零假设下，合并两个区域的出现点，随机置换标签，然后重新分成两个原始大小的集合。对于每次置换，如步骤 $1$–$3$ 所述估计密度并计算基于 $L^{1}$ 的重叠度。“在等价性假设下重叠度小于预期”的单尾 $p$ 值是置换重叠度中小于或等于观测到的基于 $L^{1}$ 重叠度的比例。\n\n5) 基于 $L^{1}$ 重叠度的双向背景相似性检验，以控制背景可利用性和采样偏差：对于原生区到入侵区方向，固定原生区出现点，并根据入侵区背景权重成比例的概率，从入侵区背景中有放回地重复抽取伪出现点；对于每次抽取，估计密度并计算与固定的原生区密度的重叠度。“在给定入侵区背景和偏差的情况下重叠度小于预期”的单尾 $p$ 值是重复实验的重叠度中小于或等于观测到的基于 $L^{1}$ 重叠度的比例。对于入侵区到原生区方向，使用原生区背景和权重对称地重复此过程，同时固定入侵区出现点。\n\n必须严格遵循的实现细节：\n- 使用高斯核密度估计器并在规则网格上进行评估。带宽可以通过仅依赖于数据的标准规则（例如，Scott 法则）来选择，但对于给定的输入数据必须是确定性的。网格单元面积为 $\\Delta x \\Delta y$，其中 $\\Delta x$ 和 $\\Delta y$ 分别是 $x$ 和 $y$ 方向的恒定间距，栅格必须被归一化，以使黎曼和等于 $1$。\n- 对于置换和背景检验，使用每个案例测试套件中指定的独立蒙特卡洛重复实验。所有随机抽样必须使用指定的随机种子。\n- 所有输出都是无量纲的，并且必须以小数形式表示。\n\n测试套件。对于以下每个案例，完全按照规定构造数据，然后计算：\n- 两个重叠度量，顺序为：基于 $L^{1}$ 的重叠度，基于 Hellinger 的重叠度。\n- 等价性检验的 $p$ 值（单尾，“重叠度更小”）。\n- 两个方向的背景相似性检验的 $p$ 值（单尾，“重叠度更小”）：原生区到入侵区，入侵区到原生区，按此顺序。\n\n对于所有案例，报告该案例的五个结果，精确到 $6$ 位小数。\n\n所有案例的通用网格参数：\n- 网格大小 $G = 35$。\n- 填充比例 $m = 0.05$。\n- 蒙特卡洛重复次数 $R = 49$。\n\n案例 A（部分重叠，异质背景，有偏采样）：\n- 本案例所有随机抽样的随机种子为 $123$。\n- 原生区出现点：从均值为 $\\left(0, 0\\right)$、协方差矩阵为 $\\begin{bmatrix}1.0  0.3 \\\\ 0.3  1.2\\end{bmatrix}$ 的二元正态分布中独立抽取 $60$ 个点。\n- 入侵区出现点：从均值为 $\\left(0.8, 0.6\\right)$、协方差矩阵为 $\\begin{bmatrix}1.2  -0.2 \\\\ -0.2  1.0\\end{bmatrix}$ 的二元正态分布中独立抽取 $60$ 个点。\n- 原生区背景：从一个混合分布中抽取 $500$ 个点，一半来自均值为 $\\left(0, 0\\right)$、协方差为 $\\operatorname{diag}\\left(2.0, 2.0\\right)$ 的二元正态分布，另一半来自均值为 $\\left(2, -1\\right)$、协方差为 $\\operatorname{diag}\\left(1.0, 1.0\\right)$ 的二元正态分布。\n- 入侵区背景：从一个混合分布中抽取 $500$ 个点，一半来自均值为 $\\left(1, 1\\right)$、协方差为 $\\operatorname{diag}\\left(2.0, 1.5\\right)$ 的二元正态分布，另一半来自均值为 $\\left(-1, 1\\right)$、协方差为 $\\operatorname{diag}\\left(1.0, 1.0\\right)$ 的二元正态分布。\n- 原生区背景采样偏差权重：对于背景点 $\\left(x, y\\right)$，权重 $w = \\exp\\left(0.5 x - 0.3 y\\right)$。\n- 入侵区背景采样偏差权重：对于背景点 $\\left(x, y\\right)$，权重 $w = \\exp\\left(-0.4 x + 0.2 y\\right)$。\n\n案例 B（生态位相同，背景相同，无偏差）：\n- 本案例所有随机抽样的随机种子为 $456$。\n- 原生区出现点：从均值为 $\\left(0, 0\\right)$、协方差为 $\\operatorname{diag}\\left(1.0, 1.0\\right)$ 的二元正态分布中抽取 $50$ 个点。\n- 入侵区出现点：使用与原生区出现点完全相同的 $50$ 个点（不重新抽取）。\n- 原生区和入侵区背景：分别为每个区域从均值为 $\\left(0, 0\\right)$、协方差为 $\\operatorname{diag}\\left(2.0, 2.0\\right)$ 的二元正态分布中独立抽取 $400$ 个点。\n- 背景采样偏差权重：两个区域的权重均为 1。\n\n案例 C（在相似的宽广背景和轻微偏差下重叠较弱）：\n- 本案例所有随机抽样的随机种子为 $789$。\n- 原生区出现点：从均值为 $\\left(-2, -2\\right)$、协方差为 $\\operatorname{diag}\\left(0.5, 0.5\\right)$ 的二元正态分布中抽取 $40$ 个点。\n- 入侵区出现点：从均值为 $\\left(2, 2\\right)$、协方差为 $\\operatorname{diag}\\left(0.5, 0.5\\right)$ 的二元正态分布中抽取 $40$ 个点。\n- 原生区背景：从一个混合分布中抽取 $500$ 个点，其中 $250$ 个来自均值为 $\\left(-2, -2\\right)$、协方差为 $\\operatorname{diag}\\left(1.5, 1.5\\right)$ 的二元正态分布，另外 $250$ 个来自均值为 $\\left(2, 2\\right)$、协方差为 $\\operatorname{diag}\\left(1.5, 1.5\\right)$ 的二元正态分布。\n- 入侵区背景：与原生区背景具有相同的混合结构和参数，独立抽取。\n- 两个区域的背景采样偏差权重：对于背景点 $\\left(x, y\\right)$，权重 $w = \\exp\\left(0.2 x + 0.2 y\\right)$。\n\n最终输出格式：\n- 对于每个案例，按 A、B、C 的顺序，计算包含五个值的向量：$\\left[\\text{L1-overlap}, \\text{Hellinger-overlap}, p_{\\text{equiv, less}}, p_{\\text{bg native}\\to\\text{invaded, less}}, p_{\\text{bg invaded}\\to\\text{native, less}}\\right]$，每个值都四舍五入到恰好 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含按顺序排列的这三个向量的列表，格式为无空格的逗号分隔列表的列表，例如：$\\left[ [a_1,a_2,a_3,a_4,a_5],[b_1,b_2,b_3,b_4,b_5],[c_1,c_2,c_3,c_4,c_5] \\right]$，但没有空格，且数值条目为按规定四舍五入的小数形式。", "solution": "该问题是数量生态学中一个定义明确的计算任务，要求实现一个基于 Hutchinson n 维超体积概念的生态位比较框架。该问题具有科学依据，使用了核密度估计（KDE）、非参数假设检验（置换和自助法式重采样）以及成熟的生态位重叠度量等标准统计方法。所有必需的参数和程序都以足够的精度进行了规定，从而能够得出一个唯一的、可验证的解决方案。因此，该问题被认为是有效的，下面提供一个完整的解决方案。\n\n对于每个测试案例，解决方案遵循一个结构化的、多步骤的过程。\n\n**步骤 1：数据生成与标准化**\n首先，对于每个案例（$A$、$B$ 或 $C$），根据指定的统计分布和参数生成点云数据，并使用指定的随机种子以确保可复现性。这包括原生区出现点（$Occ_{nat}$）、入侵区出现点（$Occ_{inv}$）、原生区背景（$Bg_{nat}$）和入侵区背景（$Bg_{inv}$）。背景点的相关采样偏差权重也一并计算。\n\n所有环境数据必须存在于一个共同的、标准化的空间中才能进行比较。将两个背景数据集 $Bg_{nat}$ 和 $Bg_{inv}$ 合并，形成一个组合背景 $Bg_{pool} = Bg_{nat} \\cup Bg_{inv}$。对两个环境维度，在 $Bg_{pool}$ 上计算均值向量 $\\boldsymbol{\\mu}_{pool}$ 和标准差向量 $\\boldsymbol{\\sigma}_{pool}$。如果在任何维度上发现标准差为零，则用一个小的正常数 $10^{-8}$ 替换，以防止除以零。\n然后通过以下变换对所有四个数据集（$Occ_{nat}$、$Occ_{inv}$、$Bg_{nat}$、$Bg_{inv}$）中的每个点 $\\mathbf{x} = (x, y)$ 进行标准化：\n$$\n\\mathbf{x}' = \\left( \\frac{x - \\mu_{pool,x}}{\\sigma_{pool,x}}, \\frac{y - \\mu_{pool,y}}{\\sigma_{pool,y}} \\right)\n$$\n所有后续计算都在此标准化环境空间中进行。\n\n**步骤 2：网格构建与密度估计**\n在标准化环境空间上构建一个规则的笛卡尔网格。网格的范围由合并背景 $Bg_{pool}$ 的范围决定。设标准化后的 $Bg_{pool}$ 的最小和最大坐标为 $(\\min_x, \\min_y)$ 和 $(\\max_x, \\max_y)$。每个轴的范围是 $R_x = \\max_x - \\min_x$ 和 $R_y = \\max_y - \\min_y$。网格在所有边上扩展了 $m=0.05$ 的填充边距。最终网格在 x 轴上从 $\\min_x - m \\cdot R_x$ 延伸到 $\\max_x + m \\cdot R_x$，在 y 轴上类似。该区域被离散化为一个 $G \\times G$ 的网格，其中 $G=35$。\n\n物种的环境生态位被建模为概率密度函数（PDF）。这个未知的 PDF 是使用二元高斯核密度估计器（KDE）从出现数据中估计的。对于一组 $n$ 个出现点 $\\{\\mathbf{x}_i\\}_{i=1}^n$，在点 $\\mathbf{x}$ 处的估计密度为：\n$$\n\\hat{f}(\\mathbf{x}) = \\sum_{i=1}^n K_H(\\mathbf{x} - \\mathbf{x}_i)\n$$\n其中 $K_H$ 是带宽矩阵为 $H$ 的高斯核。带宽使用 Scott 法则自动确定，这是一种基于数据维度和样本大小的标准确定性方法。\n应用此过程从标准化的 $Occ_{nat}$ 点估计原生生态位密度 $\\hat{f}_{nat}(\\mathbf{x})$，并从标准化的 $Occ_{inv}$ 点估计入侵生态位密度 $\\hat{f}_{inv}(\\mathbf{x})$。然后，在环境网格上的每个 $G \\times G$ 点上评估这两种连续密度，生成两个原始密度值矩阵 $Z_{nat}$ 和 $Z_{inv}$。\n\n问题要求进行归一化，使得网格上密度的黎曼和等于 $1$。设 $P_{nat}$ 为原生密度的最终归一化栅格。其值 $P_{nat,ij}$ 必须满足 $\\sum_{i,j} P_{nat,ij} \\Delta x \\Delta y = 1$，其中 $\\Delta x$ 和 $\\Delta y$ 是网格间距。这可以通过设置 $P_{nat,ij} = Z_{nat,ij} / (\\sum_{k,l} Z_{nat,kl} \\Delta x \\Delta y)$ 来实现。然而，在计算本身是积分（通过求和来近似）的重叠度量时，这个 $\\Delta x \\Delta y$ 因子会抵消掉。一种在数学上等效且计算上更简单的方法是在网格单元上创建一个离散概率质量函数。矩阵 $Z$ 中的原始密度值被归一化以使其总和为 $1$：\n$$\np_{nat,ij} = \\frac{Z_{nat,ij}}{\\sum_{k,l} Z_{nat,kl}} \\quad \\text{and} \\quad p_{inv,ij} = \\frac{Z_{inv,ij}}{\\sum_{k,l} Z_{inv,kl}}\n$$\n这些矩阵 $p_{nat}$ 和 $p_{inv}$ 用于所有后续的重叠计算。\n\n**步骤 3：生态位重叠度量**\n计算两个度量来量化栅格化生态位密度 $p_{nat}$ 和 $p_{inv}$ 之间的重叠。\n1.  **基于 $L^1$ 的重叠度 (Schoener's D)**：该度量源于两个离散分布之间的 $L^1$ 距离。\n    $$\n    d_{L1} = \\sum_{i,j} | p_{nat,ij} - p_{inv,ij} |\n    $$\n    距离 $d_{L1}$ 的范围是 $0$ 到 $2$。重叠度量定义为：\n    $$\n    O_{L1} = 1 - \\frac{1}{2} d_{L1}\n    $$\n    该值位于 $[0, 1]$ 区间内，其中 $1$ 表示分布相同，$0$ 表示没有重叠。\n\n2.  **基于 Hellinger 的重叠度 (Bhattacharyya 系数)**：该度量基于平方 Hellinger 距离。\n    $$\n    d_H^2 = \\sum_{i,j} \\left( \\sqrt{p_{nat,ij}} - \\sqrt{p_{inv,ij}} \\right)^2\n    $$\n    平方距离 $d_H^2$ 的范围也是 $0$ 到 $2$。重叠度量定义为：\n    $$\n    O_H = 1 - \\frac{1}{2} d_H^2 = \\sum_{i,j} \\sqrt{p_{nat,ij} \\cdot p_{inv,ij}}\n    $$\n    该值也位于 $[0, 1]$ 区间内，其解释与 $O_{L1}$ 相同。\n\n这两个值 $O_{L1,obs}$ 和 $O_{H,obs}$ 代表观测到的生态位重叠度。\n\n**步骤 4：生态位等价性检验**\n该检验评估观测到的生态位重叠度是否与两个出现点集来自相同潜在生态位分布的预期有显著差异。零假设是 $Occ_{nat}$ 和 $Occ_{inv}$ 是来自同一来源的随机样本。\n使用 $R=49$ 次重复的置换程序：\n1.  合并所有出现点：$Occ_{pool} = Occ_{nat} \\cup Occ_{inv}$。\n2.  随机打乱 $Occ_{pool}$ 并将其重新分成两个新集合：一个大小为 $|Occ_{nat}|$ 的伪原生集合和一个大小为 $|Occ_{inv}|$ 的伪入侵集合。\n3.  对于每一对新集合，在同一网格上估计它们各自的密度，并计算基于 $L^1$ 的重叠度 $O_{L1,perm}$。这将生成一个包含 $R$ 个重叠值的零分布。\n4.  “重叠度小于预期”的单尾 $p$ 值是置换重叠度中小于或等于观测重叠度的比例：\n    $$\n    p_{equiv} = \\frac{1}{R} \\sum_{k=1}^R \\mathbb{I}(O_{L1,perm}^{(k)} \\le O_{L1,obs})\n    $$\n    其中 $\\mathbb{I}(\\cdot)$ 是指示函数。\n\n**步骤 5：背景相似性检验**\n这些检验评估观测到的生态位重叠度是否受到每个区域内可用环境条件的限制。\n1.  **原生区到入侵区检验**：该检验测试在给定入侵区可用环境的情况下，入侵者的生态位与原生生态位的差异是否比预期的更大。\n    *   原生密度 $p_{nat}$ 保持不变。\n    *   对于 $R=49$ 次重复实验，通过从入侵区背景 $Bg_{inv}$ 中有放回地抽样 $|Occ_{inv}|$ 个点来生成一组伪入侵出现点。每个背景点的抽样概率与其权重成正比。\n    *   对于每次重复实验，从伪入侵集合中估计一个密度，并计算与固定的 $p_{nat}$ 的基于 $L^1$ 的重叠度 ($O_{L1,bg,n \\to i}$)。\n    *   $p$ 值是这些重复实验的重叠度中小于或等于观测重叠度 $O_{L1,obs}$ 的比例。\n\n2.  **入侵区到原生区检验**：该检验对称地测试在给定原生区可用环境的情况下，原生生态位与入侵者生态位的差异是否比预期的更大。\n    *   入侵密度 $p_{inv}$ 保持不变。\n    *   对于 $R=49$ 次重复实验，从带有权重的 $Bg_{nat}$ 中抽样伪原生出现点。\n    *   计算与固定的 $p_{inv}$ 的基于 $L^1$ 的重叠度 ($O_{L1,bg,i \\to n}$)。\n    *   $p$ 值以类似方式计算。\n\n对于每个测试案例，计算这五个值（$O_{L1,obs}$, $O_{H,obs}$, $p_{equiv}$, $p_{bg,n \\to i}$, $p_{bg,i \\to n}$），四舍五入到 $6$ 位小数，并进行报告。", "answer": "[[0.518606,0.536761,0.0,0.0,0.0],[1.0,1.0,1.0,1.0,1.0],[0.0,0.0,0.0,0.0,0.0]]", "id": "2535013"}, {"introduction": "生态位内的竞争不仅影响物种的丰度和分布，更能在演化时间尺度上驱动新物种的形成。自适应动态学（Adaptive Dynamics）为我们提供了一个连接生态互动与演化后果的理论桥梁。这个练习 ([@problem_id:2535009]) 将引导你构建一个模型，探索同域物种形成的关键机制：当针对连续资源的竞争导致了分裂选择（disruptive selection），并且这种分裂的力量足以克服有性生殖带来的性状均质化效应时，演化分叉便可能发生。通过计算分叉判据 $\\lambda$，你将亲手揭示生态竞争如何成为创造生物多样性的演化引擎。", "problem": "您将为一个利用连续资源轴的有性生殖消费者种群，建立一个一维自适应动力学模型。其生态机制是沿资源轴的高斯竞争和高斯环境承载力（资源生产力）分布；交配是选择性的，因此有性生殖以一个有效速率使性状差异同质化。您的任务是推导、实现和评估奇异策略附近的线性化分化准则，然后确定生态分裂选择是否能克服同质化效应，从而产生一个分岔，形成两个代表占据不同生态位的初始物种的分化表型簇。\n\n从以下基本基础开始：\n- 具有频率依赖性竞争的Logistic生态动力学。对于一个性状值为 $x$ 的单态定居种群，由于自我限制，其生态平衡丰度等于在 $x$ 处的环境承载力。\n- 一个性状值为 $y$ 的稀有突变体在处于平衡状态的定居种群环境中的入侵适应度，是其稀有时的人均增长率。\n- 用于环境承载力和竞争的高斯函数，是沿连续生态位轴的资源限制和生态位重叠的广泛使用且有经验依据的近似。\n\n模型要素和定义：\n- 设一维性状为 $z \\in \\mathbb{R}$，表示在连续轴上的资源利用表型。\n- 环境承载力作为 $z$ 的函数是 $K(z) = K_{0} \\exp\\!\\left( - \\dfrac{(z - \\theta)^{2}}{2 \\sigma_{K}^{2}} \\right)$，其中 $\\sigma_{K} > 0$ 是资源分布的宽度，$\\theta$ 是其峰值。不失一般性，设 $\\theta = 0$。\n- 对称的高斯竞争核为 $\\alpha(z, z') = \\exp\\!\\left( - \\dfrac{(z - z')^{2}}{2 \\sigma_{\\alpha}^{2}} \\right)$，其中 $\\sigma_{\\alpha} > 0$ 是生态位重叠尺度。\n- 考虑具有内禀增长率 $r > 0$ 的Logistic增长。一个稀有突变体 $y$ 在定居种群 $x$ 处于其单态平衡时的入侵适应度为\n  $$ s(y, x) = r \\left( 1 - \\dfrac{\\alpha(y, x) \\, K(x)}{K(y)} \\right). $$\n- 在自适应动力学下，$x$ 处的选择梯度是偏导数 $\\left. \\dfrac{\\partial s(y, x)}{\\partial y} \\right|_{y = x}$，在此模型中指向奇异策略 $x^{\\ast} = 0$。\n- 在奇异策略处，入侵适应度相对于突变体性状的局部曲率控制着选择是稳定性的还是分裂性的。定义\n  $$ s'' \\equiv \\left. \\dfrac{\\partial^{2} s(y, x)}{\\partial y^{2}} \\right|_{y = x = 0}. $$\n- 具有选择性交配的有性生殖会使表型差异同质化。设 $h \\ge 0$ 表示在性状差异非常小时，由交配和重组引起的有效单位时间同质化速率。较小的 $h$ 对应更强的选择性交配（较少同质化）；较大的 $h$ 对应更弱的选择性交配（更多同质化，趋近于随机交配）。\n- 考虑两个位于 $\\pm d/2$ 处且间距 $d$ 很小的子簇。将其间距动力学线性化。主导分化与合并的主阶系数（单位间距）为\n  $$ \\lambda = s'' - h. $$\n  如果 $\\lambda > 0$，则分裂选择主导同质化，并引发一个向两个分化簇演变的叉式分岔（初始同域物种形成）。如果 $\\lambda \\le 0$，则同质化主导，系统保持单峰状态。\n\n您的任务：\n1. 根据上述模型定义和基本原理，推导出一个用 $r$、$\\sigma_{K}$ 和 $\\sigma_{\\alpha}$ 表示 $s''$ 的显式公式。\n2. 使用该公式和 $\\lambda$ 的定义，实现一个程序，为每个测试用例计算 $\\lambda$ 并将其报告为四舍五入到六位小数的浮点数。\n3. 必须通过 $\\lambda$ 的符号来明确选择性交配强度的作用：将 $h$ 解释为由交配引起的有效同质化速率。更强的选择性交配对应更小的 $h$，这会增加 $\\lambda$ 并促进分岔；更弱的选择性交配对应更大的 $h$，这会减少 $\\lambda$ 并抑制分岔。\n\n测试套件：\n对于下面的每个元组 $(r, \\sigma_K, \\sigma_\\alpha, h)$，按规定计算 $\\lambda$。\n- 案例A（基线分裂选择，弱同质化）：$(r, \\sigma_K, \\sigma_\\alpha, h) = (1.0, 1.2, 0.8, 0.1)$。\n- 案例B（与A相同的生态，强同质化）：$(r, \\sigma_K, \\sigma_\\alpha, h) = (1.0, 1.2, 0.8, 1.0)$。\n- 案例C（生态分裂性边界）：$(r, \\sigma_K, \\sigma_\\alpha, h) = (1.0, 1.0, 1.0, 0.0)$。\n- 案例D（无生态分裂性）：$(r, \\sigma_K, \\sigma_\\alpha, h) = (1.0, 0.7, 1.1, 0.0)$。\n- 案例E（宽资源，窄竞争，低内禀增长，中度同质化）：$(r, \\sigma_K, \\sigma_\\alpha, h) = (0.05, 2.0, 0.5, 0.02)$。\n- 案例F（分裂性与同质化完全平衡）：$(r, \\sigma_K, \\sigma_\\alpha, h) = (0.5, 1.0, 0.5, 1.5)$。\n\n输出规格：\n- 对于给定的有序测试套件 [A, B, C, D, E, F]，输出一行，包含一个Python风格的列表，其中包含计算出的 $\\lambda$ 值，每个值四舍五入到六位小数，无额外文本。例如，格式应类似于 $[\\lambda_{A}, \\lambda_{B}, \\lambda_{C}, \\lambda_{D}, \\lambda_{E}, \\lambda_{F}]$。\n- 不涉及物理单位或角度；输出是无量纲的。每个报告的值必须是十进制数（浮点数）。", "solution": "所述问题具有科学依据，数学上是适定的，并且内部一致。它代表了自适应动力学领域研究同域物种形成的一个标准、经典的范式模型。定义精确，目标明确。我们将着手进行推导和求解。\n\n主要任务是推导进化分支的准则 $\\lambda$，它决定了在奇异策略处的单峰种群分布是进化稳定的，还是会分岔成两个不同的表型簇。该准则取决于生态分裂选择与有性生殖的同质化效应之间的平衡。\n\n**1. 选择的生态曲率 ($s''$) 的推导**\n\n分析的核心是入侵适应度 $s(y, x)$，它表示表型为 $y$ 的稀有突变体在表型为 $x$ 的单态定居种群处于其生态平衡状态时的适应度。适应度函数给出如下：\n$$\ns(y, x) = r \\left( 1 - \\dfrac{\\alpha(y, x) \\, K(x)}{K(y)} \\right)\n$$\n其中 $r > 0$ 是内禀增长率。环境承载力 $K(z)$ 和竞争核 $\\alpha(z, z')$ 是高斯函数：\n$$\nK(z) = K_{0} \\exp\\!\\left( - \\dfrac{z^{2}}{2 \\sigma_{K}^{2}} \\right)\n$$\n$$\n\\alpha(z, z') = \\exp\\!\\left( - \\dfrac{(z - z')^{2}}{2 \\sigma_{\\alpha}^{2}} \\right)\n$$\n问题要求计算入侵适应度关于突变体性状 $y$ 的二阶偏导数，并在奇异策略 $x=x^*=0$ 和 $y=x=0$ 处求值。此量表示为 $s''$：\n$$\ns'' \\equiv \\left. \\dfrac{\\partial^{2} s(y, x)}{\\partial y^{2}} \\right|_{y = x = 0}\n$$\n为了计算这个值，我们首先求 $s(y,x)$ 关于 $y$ 的偏导数。分析项 $F(y,x) = \\dfrac{\\alpha(y, x)}{K(y)}$ 会比较方便。\n$$\ns(y,x) = r(1 - F(y,x)K(x))\n$$\n因此，\n$$\n\\dfrac{\\partial^{2} s(y, x)}{\\partial y^{2}} = -r K(x) \\dfrac{\\partial^{2} F(y, x)}{\\partial y^{2}}\n$$\n让我们明确地表示 $F(y,x)$：\n$$\nF(y,x) = \\dfrac{\\exp\\!\\left( - \\dfrac{(y - x)^{2}}{2 \\sigma_{\\alpha}^{2}} \\right)}{K_{0} \\exp\\!\\left( - \\dfrac{y^{2}}{2 \\sigma_{K}^{2}} \\right)} = \\dfrac{1}{K_0} \\exp\\left( \\dfrac{y^2}{2\\sigma_K^2} - \\dfrac{(y-x)^2}{2\\sigma_\\alpha^2} \\right)\n$$\n关于 $y$ 的一阶偏导数是：\n$$\n\\dfrac{\\partial F(y,x)}{\\partial y} = F(y,x) \\left( \\dfrac{2y}{2\\sigma_K^2} - \\dfrac{2(y-x)}{2\\sigma_\\alpha^2} \\right) = F(y,x) \\left( \\dfrac{y}{\\sigma_K^2} - \\dfrac{y-x}{\\sigma_\\alpha^2} \\right)\n$$\n使用乘法法则求二阶偏导数：\n$$\n\\dfrac{\\partial^{2} F(y,x)}{\\partial y^{2}} = \\dfrac{\\partial F}{\\partial y} \\left( \\dfrac{y}{\\sigma_K^2} - \\dfrac{y-x}{\\sigma_\\alpha^2} \\right) + F(y,x) \\left( \\dfrac{1}{\\sigma_K^2} - \\dfrac{1}{\\sigma_\\alpha^2} \\right)\n$$\n$$\n\\dfrac{\\partial^{2} F(y,x)}{\\partial y^{2}} = F(y,x) \\left( \\dfrac{y}{\\sigma_K^2} - \\dfrac{y-x}{\\sigma_\\alpha^2} \\right)^2 + F(y,x) \\left( \\dfrac{1}{\\sigma_K^2} - \\dfrac{1}{\\sigma_\\alpha^2} \\right)\n$$\n我们必须在奇异策略处求此值，该策略被给定为 $x^*=0$。因此我们设 $x=0$ 和 $y=0$。\n在 $y=x=0$ 处：\n- 项 $\\left( \\dfrac{y}{\\sigma_K^2} - \\dfrac{y-x}{\\sigma_\\alpha^2} \\right)$ 的值为 $0$。\n- 函数 $F(y,x)$ 的值为 $F(0,0) = \\dfrac{\\alpha(0,0)}{K(0)} = \\dfrac{1}{K_0}$。\n\n将这些代入 $F$ 的二阶导数表达式中：\n$$\n\\left. \\dfrac{\\partial^{2} F(y,x)}{\\partial y^{2}} \\right|_{y=x=0} = \\dfrac{1}{K_0} (0)^2 + \\dfrac{1}{K_0} \\left( \\dfrac{1}{\\sigma_K^2} - \\dfrac{1}{\\sigma_\\alpha^2} \\right) = \\dfrac{1}{K_0} \\left( \\dfrac{1}{\\sigma_K^2} - \\dfrac{1}{\\sigma_\\alpha^2} \\right)\n$$\n现在我们可以计算 $s''$。在 $x=0$ 处，$K(x) = K(0) = K_0$。\n$$\ns'' = -r K(0) \\left. \\dfrac{\\partial^{2} F(y,x)}{\\partial y^{2}} \\right|_{y=x=0} = -r K_0 \\left[ \\dfrac{1}{K_0} \\left( \\dfrac{1}{\\sigma_K^2} - \\dfrac{1}{\\sigma_\\alpha^2} \\right) \\right]\n$$\n这简化为适应度景观曲率的最终表达式：\n$$\ns'' = -r \\left( \\dfrac{1}{\\sigma_{K}^{2}} - \\dfrac{1}{\\sigma_{\\alpha}^{2}} \\right) = r \\left( \\dfrac{1}{\\sigma_{\\alpha}^{2}} - \\dfrac{1}{\\sigma_{K}^{2}} \\right)\n$$\n\n**2. 分化准则及其解释**\n\n项 $s''$ 量化了在奇异策略处频率依赖性分裂选择的强度。\n- 如果 $s'' > 0$，选择是分裂性的。这当且仅当 $1/\\sigma_\\alpha^2 > 1/\\sigma_K^2$ 时发生，等价于 $\\sigma_K > \\sigma_\\alpha$。该条件意味着资源分布的宽度（生态位可用性）大于竞争核的宽度（生态位重叠）。位于表型中心的个体面临比位于边缘的个体更激烈的竞争，这选择了分化。\n- 如果 $s'' \\le 0$，选择是稳定性的或中性的，这在 $\\sigma_K \\le \\sigma_\\alpha$ 时发生。\n\n有性生殖和重组作为一种内聚力，抵消了分化。这通过同质化速率 $h \\ge 0$ 来建模。两个初始簇分化或合并的总体趋势由线性化分化速率 $\\lambda$ 给出：\n$$\n\\lambda = s'' - h\n$$\n代入我们推导出的 $s''$ 表达式：\n$$\n\\lambda = r \\left( \\dfrac{1}{\\sigma_{\\alpha}^{2}} - \\dfrac{1}{\\sigma_{K}^{2}} \\right) - h\n$$\n其生物学解释如下：\n- 如果 $\\lambda > 0$，来自生态竞争的分裂力强于来自交配的同质化力。单态种群是进化不稳定的，发生分岔，导致两个分化的表型簇（初始同域物种形成）。\n- 如果 $\\lambda \\le 0$，同质化力足以压倒任何分裂选择。种群保持单峰状态，进化分支被阻止。\n\n**3. 测试用例的实现与评估**\n\n推导出的 $\\lambda$ 公式在一个程序中实现，用于评估给定的测试用例。对于每个提供的参数元组 $(r, \\sigma_K, \\sigma_\\alpha, h)$，程序计算 $\\lambda$ 并将结果四舍五入到六位小数。代码自动化了这一计算，为不同生态和交配情景下的物种形成潜力提供了定量评估。该计算的结果将按规定格式化为单个列表。", "answer": "[0.868056,-0.031944,0.0,-0.840715,0.18,0.0]", "id": "2535009"}]}