{"hands_on_practices": [{"introduction": "生物群系的量化分类是生态学研究的基础。霍尔德里奇生命地带（Holdridge life zone）系统是一个经典的例子，它仅使用年生物温度和年降水量这两个关键气候变量来预测植被类型。本练习 [@problem_id:2473806] 将让你亲手应用该模型的具体规则，处理原始气候数据，将局地气象站的数据转化为全球生物群系的分类，从而掌握一个重要的生物群系分类工具。", "problem": "一个位于中纬度地区的野外站记录了某一整个日历年的月平均气温和月总降水量。在霍尔德里奇（Holdridge）生命区框架中，年平均生物温度定义为12个月的月平均温度的算术平均值，其中任何低于 $0^{\\circ}\\mathrm{C}$ 或高于 $30^{\\circ}\\mathrm{C}$ 的月平均温度都被替换为 $0^{\\circ}\\mathrm{C}$。假设霍尔德里奇生命区图使用其标准的对数形式，并且将一个地点映射到一个“六边形”可以通过在以2为底的对数空间中，将该地点分配给沿每个轴最近的几何中心来近似。具体来说，设生物温度中心集合为 $\\{\\,1.5,\\,3,\\,6,\\,12,\\,24\\,\\}$（摄氏度），年降水量中心集合为 $\\{\\,62.5,\\,125,\\,250,\\,500,\\,1000,\\,2000,\\,4000\\,\\}$（毫米）。对于一个年平均生物温度为 $B$、年降水量为 $P$（毫米）的地点，将其指定的生物温度中心 $B_c$ 和降水量中心 $P_c$ 定义为各自集合中能够最小化坐标为 $(\\log_{2} B,\\,\\log_{2} P)$ 的平面上的平方欧几里得距离的值；如果出现距离相等的情况，则取较大的中心值。将生物温度中心按递增顺序用 $i_B \\in \\{1,2,3,4,5\\}$ 索引，将降水量中心按递增顺序用 $i_P \\in \\{1,2,3,4,5,6,7\\}$ 索引，并定义唯一的六边形索引为 $I = 100\\,i_B + i_P$。\n\n该站的月平均温度（单位：$^{\\circ}\\mathrm{C}$）为：\n$(-5,\\,-2,\\,3,\\,10,\\,16,\\,27,\\,32,\\,31,\\,24,\\,12,\\,5,\\,-1)$，\n月总降水量（单位：毫米）为：\n$(30,\\,28,\\,35,\\,45,\\,60,\\,75,\\,100,\\,90,\\,85,\\,80,\\,85,\\,87)$。\n\n仅使用上述定义（不要引入任何其他映射方法），计算年平均生物温度 $B$、年降水量 $P$，在以2为底的对数空间中进行最近中心分配，并报告最终的六边形索引 $I$。将您的最终答案表示为一个不带单位的纯数字。如果您在计算过程中进行了任何数值近似，请确保其精度足以明确无误地确定正确的最近中心。最终答案是整数，因此不需要四舍五入的说明。", "solution": "我们从霍尔德里奇（Holdridge）的核心定义开始：\n\n1. 年平均生物温度 $B$ 是12个月的月平均温度的算术平均值，其中任何低于 $0^{\\circ}\\mathrm{C}$ 或高于 $30^{\\circ}\\mathrm{C}$ 的月平均温度都被替换为 $0^{\\circ}\\mathrm{C}$。其形式化定义为：\n$$\nB = \\frac{1}{12} \\sum_{m=1}^{12} b(T_m),\n\\quad\nb(T) = \\begin{cases}\nT, & 0 \\le T \\le 30 \\\\\n0, & \\text{otherwise}\n\\end{cases}\n$$\n\n2. 年降水量 $P$ 是12个月的月总降水量之和：\n$$\nP \\;=\\; \\sum_{m=1}^{12} P_m.\n$$\n\n3. 霍尔德里奇图使用对数坐标轴；我们通过在以2为底的对数空间中选择最近的几何中心来近似六边形分配。因此，设 $x=\\log_{2} B$ 和 $y=\\log_{2} P$，我们选择 $B_c \\in \\{\\,1.5,\\,3,\\,6,\\,12,\\,24\\,\\}$ 和 $P_c \\in \\{\\,62.5,\\,125,\\,250,\\,500,\\,1000,\\,2000,\\,4000\\,\\}$ 以最小化\n$$\nd^{2} \\;=\\; \\bigl(\\log_{2} B - \\log_{2} B_c\\bigr)^{2} \\;+\\; \\bigl(\\log_{2} P - \\log_{2} P_c\\bigr)^{2}.\n$$\n由于距离在各个轴上是可分离的，最小化 $d^{2}$ 可以简化为在 $\\log_{2}$ 空间中独立地为 $B$ 选择最近的 $B_c$ 以及为 $P$ 选择最近的 $P_c$；距离相等时选择较大的中心值。\n\n计算 $B$：\n\n- 月平均温度为 $(-5,\\,-2,\\,3,\\,10,\\,16,\\,27,\\,32,\\,31,\\,24,\\,12,\\,5,\\,-1)$。应用 $b(T)$ 函数将任何 $T0$ 或 $T>30$ 的值设为 $0$：\n$$\nb(T_m) \\;=\\; (0,\\,0,\\,3,\\,10,\\,16,\\,27,\\,0,\\,0,\\,24,\\,12,\\,5,\\,0).\n$$\n- 调整后月度值的总和：\n$$\n\\sum_{m=1}^{12} b(T_m) \\;=\\; 3 + 10 + 16 + 27 + 24 + 12 + 5 \\;=\\; 97.\n$$\n- 因此，\n$$\nB \\;=\\; \\frac{97}{12}.\n$$\n\n计算 $P$：\n\n- 月总降水量为 $(30,\\,28,\\,35,\\,45,\\,60,\\,75,\\,100,\\,90,\\,85,\\,80,\\,85,\\,87)$ 毫米，所以\n$$\nP \\;=\\; 30 + 28 + 35 + 45 + 60 + 75 + 100 + 90 + 85 + 80 + 85 + 87 \\;=\\; 800.\n$$\n\n在以2为底的对数空间中分配最近的中心：\n\n- 计算 $\\log_{2} B$：\n$$\nB \\;=\\; \\frac{97}{12} \\;\\approx\\; 8.083\\overline{3},\n\\qquad\n\\log_{2} B \\;=\\; \\frac{\\ln B}{\\ln 2} \\;\\approx\\; \\log_{2}(8.083\\overline{3}) \\;\\approx\\; 3.015.\n$$\n- 候选生物温度中心及其以2为底的对数：\n$$\n\\log_{2}(1.5) \\approx 0.585,\\quad\n\\log_{2}(3) \\approx 1.585,\\quad\n\\log_{2}(6) \\approx 2.585,\\quad\n\\log_{2}(12) \\approx 3.585,\\quad\n\\log_{2}(24) \\approx 4.585.\n$$\n- 沿生物温度轴的差值：\n$$\n|\\log_{2} B - \\log_{2}(6)| \\approx |3.015 - 2.585| \\approx 0.430, \\\\\n|\\log_{2} B - \\log_{2}(12)| \\approx |3.015 - 3.585| \\approx 0.570.\n$$\n$1.5$、$3$ 和 $24$ 的值距离更远。因此，最近的生物温度中心是 $B_c = 6$，它对应于有序集合 $\\{1.5,\\,3,\\,6,\\,12,\\,24\\}$ 中的索引 $i_B = 3$。\n\n- 计算 $\\log_{2} P$：\n$$\nP \\;=\\; 800 \\;=\\; 2^{5} \\times 25 \\;\\Rightarrow\\; \\log_{2} P \\;=\\; 5 + \\log_{2}(25) \\;=\\; 5 + 2\\log_{2}(5) \\;\\approx\\; 9.643856.\n$$\n- 候选降水量中心及其以2为底的对数：\n$$\n\\log_{2}(62.5) \\approx 5.965784,\\quad\n\\log_{2}(125) \\approx 6.965784,\\quad\n\\log_{2}(250) \\approx 7.965784,\\\\\n\\log_{2}(500) \\approx 8.965784,\\quad\n\\log_{2}(1000) \\approx 9.965784,\\quad\n\\log_{2}(2000) \\approx 10.965784,\\quad\n\\log_{2}(4000) \\approx 11.965784.\n$$\n- 靠近 $P$ 的降水量轴上的差值：\n$$\n|\\log_{2} P - \\log_{2}(500)| \\approx |9.643856 - 8.965784| \\approx 0.678072, \\\\\n|\\log_{2} P - \\log_{2}(1000)| \\approx |9.643856 - 9.965784| \\approx 0.321928.\n$$\n最近的降水量中心是 $P_c = 1000$，它对应于有序集合 $\\{62.5,\\,125,\\,250,\\,500,\\,1000,\\,2000,\\,4000\\}$ 中的索引 $i_P = 5$。\n\n计算六边形索引：\n$$\nI \\;=\\; 100\\,i_B + i_P \\;=\\; 100 \\times 3 + 5 \\;=\\; 305.\n$$\n\n因此，根据该站的数据和指定的映射协议确定的唯一六边形索引是 $I = 305$。", "answer": "$$\\boxed{305}$$", "id": "2473806"}, {"introduction": "在对生物群系进行分类后，下一步是理解其功能，特别是其在全球碳循环中的作用。本练习 [@problem_id:2473798] 模拟了生态系统科学中的一项核心任务：利用涡度相关技术测量的净二氧化碳通量数据，将其分解为总初级生产力（GPP）和生态系统呼吸（R）。掌握这项技能对于评估一个生物群系是碳汇还是碳源至关重要。", "problem": "给定三个对比鲜明的生物群系的涡度相关法时间序列，每个生物群系在24小时周期内有八个等间隔的样本。这些时间序列是简短、合成的，但物理上是合理的。对于每个样本，都提供了垂直$\\mathrm{CO_2}$通量 $F_{\\mathrm{CO2}}$（向上进入大气为正）和冠层气温 $T$，以及一个指示样本是否发生在夜间的布尔标志。每个案例中的时间步长是统一的，等于 $10800$ 秒，因此八个样本正好覆盖一天。目标是通过仅使用夜间温度响应模型将 $F_{\\mathrm{CO2}}$ 分解为总初级生产力 (GPP) 和生态系统呼吸 (R) 来推导净生态系统生产力 (NEP)，然后在整个昼夜周期内重建 NEP。\n\n使用的基本定义和假设：\n- 涡度相关法符号约定（向上为正）下生态系统$\\mathrm{CO_2}$交换的质量平衡：$F_{\\mathrm{CO2}}(t) = R(t) - \\mathrm{GPP}(t)$。\n- 净生态系统生产力 (NEP) 的定义：$\\mathrm{NEP}(t) = \\mathrm{GPP}(t) - R(t)$。因此，正的 $\\mathrm{NEP}$ 表示生态系统的净碳吸收。\n- 在夜间，$\\mathrm{GPP}(t) = 0$，因此对于夜间样本，$F_{\\mathrm{CO2}}(t) = R(t)$。\n- 生态系统呼吸的温度响应：$R(T) = R_{0}\\, Q_{10}^{(T - 10)/10}$，其中 $R_{0}$ 是在 $T = 10^{\\circ}\\mathrm{C}$ 时的呼吸速率，而 $Q_{10}$ 是温度每增加 $10^{\\circ}\\mathrm{C}$ 的温度敏感性因子。\n\n您的任务，对每个测试用例分别执行：\n1. 仅使用夜间样本和模型 $R(T) = R_{0}\\, Q_{10}^{(T - 10)/10}$，通过对夜间通量的自然对数进行普通最小二乘法来估计 $R_{0}$ 和 $Q_{10}$。使用自然对数。排除任何 $F_{\\mathrm{CO2}}$ 为非正值的夜间样本（所提供的数据中没有这种情况）。\n2. 使用拟合的呼吸参数，根据完整的温度序列预测所有时间的呼吸作用 $\\widehat{R}(t)$。\n3. 通过计算 $\\widehat{\\mathrm{GPP}}(t) = \\max(\\widehat{R}(t) - F_{\\mathrm{CO2}}(t), 0)$ 来将日间通量分解为光合作用，并对夜间样本强制设定 $\\widehat{\\mathrm{GPP}}(t) = 0$。\n4. 计算所有时间的瞬时 $\\mathrm{NEP}(t) = \\widehat{\\mathrm{GPP}}(t) - \\widehat{R}(t)$。\n5. 报告两个摘要诊断值：\n   - 日间 $\\widehat{\\mathrm{GPP}}(t)$ 的算术平均值，单位为 $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，四舍五入到三位小数。\n   - $24$ 小时积分 $\\mathrm{NEP}$，单位为 $\\mathrm{g}\\,\\mathrm{C}\\,\\mathrm{m}^{-2}\\,\\mathrm{d}^{-1}$，通过对八个样本以时间步长 $\\Delta t = 10800$ 秒进行黎曼和计算，使用每 $\\mu\\mathrm{mol}$ 碳 $12 \\times 10^{-6}\\,\\mathrm{g\\,C}$ 的转换因子。四舍五入到三位小数。\n\n参数估计细节：\n- 通过取自然对数将呼吸模型线性化：令 $x = (T - 10)/10$ 和 $y = \\ln R$，模型变为 $y = \\ln R_{0} + (\\ln Q_{10})\\, x$。使用夜间数据对 $\\{(x_{i}, \\ln F_{\\mathrm{CO2},i})\\}$ 通过最小二乘法拟合截距和斜率。\n- 恢复 $R_{0} = \\exp(\\text{截距})$ 和 $Q_{10} = \\exp(\\text{斜率})$。\n\n单位：\n- $F_{\\mathrm{CO2}}$ 单位为 $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- $T$ 单位为 $^{\\circ}\\mathrm{C}$。\n- 时间步长 $\\Delta t$ 单位为 s。\n- 日间平均 $\\widehat{\\mathrm{GPP}}$ 单位为 $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- 每日积分 $\\mathrm{NEP}$ 单位为 $\\mathrm{g}\\,\\mathrm{C}\\,\\mathrm{m}^{-2}\\,\\mathrm{d}^{-1}$。\n\n测试套件（三个案例）。对于每个案例，数组长度为8，索引从0到7，每个样本之间相隔 $\\Delta t = 10800$ 秒：\n\n案例1（类似温带森林）：\n- $T$ [$^{\\circ}\\mathrm{C}$]: [$6$, $5$, $7$, $12$, $18$, $23$, $16$, $10$]\n- $F_{\\mathrm{CO2}}$ [$\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$]: [$2.274$, $2.121$, $2.437$, $-6.554$, $-10.777$, $-6.614$, $-4.453$, $3.000$]\n- is_night: [True, True, True, False, False, False, False, True]\n\n案例2（类似暖性稀树草原）：\n- $T$ [$^{\\circ}\\mathrm{C}$]: [$20$, $18$, $17$, $24$, $30$, $34$, $28$, $22$]\n- $F_{\\mathrm{CO2}}$ [$\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$]: [$6.250$, $5.205$, $4.748$, $-10.985$, $-14.375$, $-2.452$, $-4.999$, $7.508$]\n- is_night: [True, True, True, False, False, False, False, True]\n\n案例3（类似北方森林）：\n- $T$ [$^{\\circ}\\mathrm{C}$]: [$0$, $-2$, $1$, $5$, $12$, $15$, $9$, $3$]\n- $F_{\\mathrm{CO2}}$ [$\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$]: [$0.833$, $0.741$, $0.884$, $-2.882$, $-8.313$, $-5.988$, $-3.585$, $0.994$]\n- is_night: [True, True, True, False, False, False, False, True]\n\n要求的程序行为：\n- 为每个案例实现上述方法。\n- 对于每个案例，计算并四舍五入到三位小数：$\\widehat{R}_{0}$ [$\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$]，$\\widehat{Q}_{10}$ [无量纲]，日间平均 $\\widehat{\\mathrm{GPP}}$ [$\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$]，以及每日积分 $\\mathrm{NEP}$ [$\\mathrm{g}\\,\\mathrm{C}\\,\\mathrm{m}^{-2}\\,\\mathrm{d}^{-1}$]。\n- 最终输出格式：您的程序应生成单行输出，其中包含结果，格式为一个包含三个内部列表（每个案例一个）的逗号分隔列表，每个内部列表的顺序为 [$\\widehat{R}_{0}$,$\\widehat{Q}_{10}$,mean\\_daytime\\_GPP,NEP\\_24h]，所有数值四舍五入到三位小数，不含空格，例如：\"[[r01,q101,gpp1,nep1],[r02,q102,gpp2,nep2],[r03,q103,gpp3,nep3]]\"。\n- 不应读取任何输入；所有数据均如上所述。\n\n答案单位：\n- 报告日间平均 $\\widehat{\\mathrm{GPP}}$，单位为 $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，四舍五入到三位小数。\n- 报告 $24$ 小时积分 $\\mathrm{NEP}$，单位为 $\\mathrm{g}\\,\\mathrm{C}\\,\\mathrm{m}^{-2}\\,\\mathrm{d}^{-1}$，四舍五入到三位小数。", "solution": "问题陈述已经过严格审查，并被确定为有效。这是一个在生态学和环境生物学领域内，特别是在涡度相关数据分析方面，具有科学依据的适定问题。该问题提供了所有必要的数据、定义以及清晰的序贯求解方法。不存在矛盾、模糊之处或违反科学原理的地方。\n\n任务是将净生态系统$\\mathrm{CO}_2$交换（$F_{\\mathrm{CO2}}$）分解为其组成部分：生态系统呼吸（$R$）和总初级生产力（GPP）。这是生物气象学中的一项基础技术。分析将针对三个不同的类生物群系数据集逐个案例进行。\n\n控制方程如下：\n1.  $\\mathrm{CO}_2$通量的质量平衡：$F_{\\mathrm{CO2}}(t) = R(t) - \\mathrm{GPP}(t)$。符号约定为通量向上，即离开生态系统表面为正。\n2.  净生态系统生产力 (NEP): $\\mathrm{NEP}(t) = \\mathrm{GPP}(t) - R(t) = -F_{\\mathrm{CO2}}(t)$。\n3.  生态系统呼吸的温度依赖模型：$R(T) = R_{0}\\, Q_{10}^{(T - 10)/10}$。此处，$R_0$ 是在参考温度 $10^{\\circ}\\mathrm{C}$ 时的基础呼吸速率，$Q_{10}$ 是温度升高 $10^{\\circ}\\mathrm{C}$ 时呼吸速率增加的因子。\n\n该方法的核心在于使用夜间数据来参数化呼吸模型。在夜间，光合作用停止，因此 $\\mathrm{GPP}(t) = 0$。于是，测量的通量等于生态系统呼吸：对于夜间样本，$F_{\\mathrm{CO2}}(t) = R(t)$。这使得估计参数 $R_0$ 和 $Q_{10}$ 成为可能。\n\n**步骤1：呼吸模型的参数估计**\n指数呼吸模型 $R(T) = R_{0}\\, Q_{10}^{(T - 10)/10}$ 是非线性的。为便于进行线性最小二乘拟合，通过取自然对数对模型进行转换：\n$$ \\ln(R) = \\ln(R_{0}) + \\frac{T - 10}{10} \\ln(Q_{10}) $$\n该方程为线性形式 $y = c + m x$，其中：\n-   $y = \\ln(R)$\n-   $x = (T - 10)/10$\n-   截距 $c = \\ln(R_{0})$\n-   斜率 $m = \\ln(Q_{10})$\n\n对于每个案例，我们提取温度 $T$ 和通量 $F_{\\mathrm{CO2}}$ 的夜间样本。我们使用 $F_{\\mathrm{CO2}}$ 作为 $R$ 的测量值。然后我们计算对应的数对 $(x_i, y_i)$，其中 $x_i = (T_i - 10)/10$ 和 $y_i = \\ln(F_{\\mathrm{CO2},i})$。然后对这些数对应用普通最小二乘（OLS）回归，以找到最佳斜率 $m$ 和截距 $c$。呼吸模型参数随后通过逆变换恢复：\n$$ \\widehat{R}_{0} = \\exp(c) $$\n$$ \\widehat{Q}_{10} = \\exp(m) $$\n\n让我们以**案例1（类似温带森林）**为例进行演示。\n夜间数据点（索引为 $0, 1, 2, 7$）是：\n-   $T_{\\text{night}} = [6, 5, 7, 10]^{\\circ}\\mathrm{C}$\n-   $F_{\\mathrm{CO2, night}} = [2.274, 2.121, 2.437, 3.000]\\,\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n\n用于线性回归的变换后变量是：\n-   $x = [ (6-10)/10, (5-10)/10, (7-10)/10, (10-10)/10 ] = [-0.4, -0.5, -0.3, 0.0]$\n-   $y = [ \\ln(2.274), \\ln(2.121), \\ln(2.437), \\ln(3.000) ] \\approx [0.8215, 0.7519, 0.8908, 1.0986]$\n\n对这些 $(x, y)$ 对执行OLS，得出 $m \\approx 0.6931$ 和 $c \\approx 1.0986$。\n因此，估计的参数是：\n-   $\\widehat{Q}_{10} = \\exp(0.6931) \\approx 2.000$\n-   $\\widehat{R}_{0} = \\exp(1.0986) \\approx 3.000\\,\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n\n**步骤2：重建呼吸作用并分解GPP**\n利用拟合的参数 $\\widehat{R}_{0}$ 和 $\\widehat{Q}_{10}$，我们可以使用完整的温度序列 $T$ 来预测所有8个时间步的生态系统呼吸 $\\widehat{R}(t)$。\n$$ \\widehat{R}(t) = \\widehat{R}_{0} \\widehat{Q}_{10}^{(T(t) - 10)/10} $$\n对于案例1，使用 $\\widehat{R}_{0} = 3.0$ 和 $\\widehat{Q}_{10} = 2.0$ 计算完整的呼吸时间序列。\n\n然后分解总初级生产力（$\\widehat{\\mathrm{GPP}}$）。对于夜间样本，$\\widehat{\\mathrm{GPP}}(t)$ 定义为 $0$。对于日间样本，它根据通量平衡方程 $\\mathrm{GPP} = R - F_{\\mathrm{CO2}}$ 计算。为确保物理合理性（光合作用不能为负），我们使用：\n$$ \\widehat{\\mathrm{GPP}}(t) = \\max(\\widehat{R}(t) - F_{\\mathrm{CO2}}(t), 0) \\quad \\text{对于日间} $$\n\n**步骤3：计算NEP和摘要诊断值**\n使用分解出的组分计算所有时间步的瞬时净生态系统生产力：\n$$ \\mathrm{NEP}(t) = \\widehat{\\mathrm{GPP}}(t) - \\widehat{R}(t) $$\n请注意，对于日间样本，这简化为 $\\mathrm{NEP}(t) = (\\widehat{R}(t) - F_{\\mathrm{CO2}}(t)) - \\widehat{R}(t) = -F_{\\mathrm{CO2}}(t)$，假设 $\\widehat{R}(t) - F_{\\mathrm{CO2}}(t)  0$，此处情况即是如此。对于夜间样本，$\\mathrm{NEP}(t) = -\\widehat{R}(t)$。\n\n最后，为每个案例计算两个摘要诊断值：\n1.  **日间平均 $\\widehat{\\mathrm{GPP}}$**：为所有日间样本计算的 $\\widehat{\\mathrm{GPP}}(t)$ 值的算术平均值。\n2.  **24小时积分NEP**：通过对8个样本以统一时间步长 $\\Delta t = 10800$ 秒进行黎曼和计算。总碳交换量（单位 $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}$）使用碳的摩尔质量（$12.0\\,\\mathrm{g/mol}$，或 $12 \\times 10^{-6}\\,\\mathrm{g/\\mu mol}$）转换为 $\\mathrm{g}\\,\\mathrm{C}\\,\\mathrm{m}^{-2}$。\n    $$ \\mathrm{NEP}_{24\\mathrm{h}} = \\left( \\sum_{i=1}^{8} \\mathrm{NEP}(t_i) \\cdot \\Delta t \\right) \\cdot (12 \\times 10^{-6}\\,\\mathrm{g\\,C}/\\mu\\mathrm{mol}) $$\n\n这个完整的过程被独立地应用于三个测试用例中的每一个。最终的输出由附带的程序生成，该程序以计算方式实现了这些步骤。", "answer": "[[3.000,2.000,12.500,4.251],[4.000,1.500,17.250,-11.192],[1.000,1.500,6.000,3.693]]", "id": "2473798"}, {"introduction": "生物群系并非静止不变，其边界会随着环境条件的改变而移动。这项高级练习 [@problem_id:2473791] 将使用反应-扩散模型来探讨这种动态变化的理论基础。通过分析该模型，你将推导出一种生态系统状态（如森林）侵入另一种状态（如稀树草原）的条件，或边界何时能保持稳定，从而深入理解生物群系的恢复力和动态演变机制。", "problem": "考虑一个具有强局域正反馈（Allee效应）和菲克扩散的干旱生物群系中生物量的一维反应-扩散模型。令 $u(x,t)$ 表示生物量密度。其空间显式动力学由以下方程给出：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + f(u),\n$$\n其中 $D \\ge 0$ 是扩散系数，局域反应项 $f(u)$ 编码了一种具有两个可选稳定状态（双稳态）的Allee效应，\n$$\nf(u) = r\\, u \\left(1 - \\frac{u}{K}\\right)\\left(\\frac{u}{A} - 1\\right),\n$$\n参数 $r  0$（内禀增长标度）、$K  0$（植被覆盖状态的环境承载力）和 $A \\in (0,K)$（Allee阈值）。从生态学角度讲，当 $A\\in(0,K)$ 时，$u=0$（裸地状态）和 $u=K$（植被覆盖状态）都是局部稳定平衡点，它们被位于 $u=A$ 的一个不稳定阈值所分隔。\n\n定义一个连接这两个稳定平衡点的行进波前。如果其渐进行进速度恰好为零，则称该波前是钉扎的。从第一性原理出发，以菲克扩散定律和给定的局域增长函数 $f(u)$ 为基础，推导一个判据，用于对给定的参数 $(D,r,K,A)$，判断是植被覆盖状态入侵裸地状态，还是裸地状态入侵植被覆盖状态，亦或是波前被钉扎。你的判据必须用一个积分或等效的诊断量来表示，该诊断量由行波约化得出，且不依赖于任何特别假设。\n\n你的程序必须在数值上实现这个判据，并将每个参数集分类为以下三种整数编码的结果之一：\n- 如果植被覆盖状态入侵裸地状态，输出 $1$。\n- 如果裸地状态入侵植被覆盖状态，输出 $-1$。\n- 如果波前被钉扎（在下述数值公差范围内），输出 $0$。\n\n数值公差：如果你的诊断量的绝对值小于或等于 $\\varepsilon = 10^{-9}$，则认为波前被钉扎。\n\n不需要物理单位；为本次计算之目的，所有量均为无量纲。\n\n测试组：\n为以下参数集 $(D,r,K,A)$ 提供结果：\n- 案例 $1$：$(0.1,\\,1.0,\\,1.0,\\,0.5)$，\n- 案例 $2$：$(1.0,\\,1.0,\\,1.0,\\,0.4)$，\n- 案例 $3$：$(0.01,\\,2.0,\\,1.0,\\,0.6)$，\n- 案例 $4$：$(5.0,\\,0.3,\\,10.0,\\,5.0)$，\n- 案例 $5$：$(0.5,\\,1.5,\\,2.0,\\,1.001)$，\n- 案例 $6$：$(0.5,\\,1.5,\\,2.0,\\,0.999)$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,\\dots]$），结果的顺序与测试组中的案例顺序相同。", "solution": "所提出的问题是数学生物学和物理学领域一个有效且经典的问题，具体涉及反应-扩散系统中的模式形成。我们被要求推导一维双稳态系统中行进波前传播方向的判据。该问题是适定的，有科学依据，并为其解决提供了所有必要的信息。\n\n我们从生物量密度 $u(x,t)$ 的主导反应-扩散方程开始：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + f(u)\n$$\n其中 $D  0$ 是扩散系数。$D=0$ 的情况对应于一个解耦的常微分方程组，此时行进波前的概念是退化的；真正的入侵动力学需要通过扩散实现空间耦合。反应项 $f(u)$ 由一个编码了Allee效应的三次多项式给出：\n$$\nf(u) = r\\, u \\left(1 - \\frac{u}{K}\\right)\\left(\\frac{u}{A} - 1\\right)\n$$\n参数为 $r  0$、$K  0$ 和 $A \\in (0,K)$。$f(u)$ 的根定义了系统的空间均匀平衡点：$u=0$（裸地状态）、$u=A$（不稳定的Allee阈值）和 $u=K$（植被覆盖状态）。$u=0$ 和 $u=K$ 这两个状态是稳定的，这可以通过检查 $f'(u)$ 在这些点的符号来验证。\n\n我们寻求一个行波解，它代表一个以恒定速度 $c$ 移动且波形不变的波前。这种解的形式为 $u(x,t) = U(z)$，其中 $z = x - ct$ 是行波坐标。将此拟设代入偏微分方程，得到关于波形 $U(z)$ 的二阶常微分方程：\n$$\n-c \\frac{dU}{dz} = D \\frac{d^2U}{dz^2} + f(U)\n$$\n这可以被重排成一个类似于带摩擦的势场中粒子的牛顿第二定律的形式：\n$$\nD \\frac{d^2U}{dz^2} + c \\frac{dU}{dz} + f(U) = 0\n$$\n我们需要一个连接这两个稳定状态的波前解。我们采用这样的约定：当 $z \\to -\\infty$ 时，波形趋近于植被覆盖状态；当 $z \\to +\\infty$ 时，波形趋近于裸地状态。因此，边界条件为：\n$$\n\\lim_{z \\to -\\infty} U(z) = K \\quad \\text{and} \\quad \\lim_{z \\to +\\infty} U(z) = 0\n$$\n由于 $U$ 在无穷远处趋于常数值，其导数必须为零：\n$$\n\\lim_{z \\to \\pm\\infty} \\frac{dU}{dz} = 0\n$$\n在此约定下，正速度 $c0$ 意味着波 $U(x-ct)$ 向右移动，即植被覆盖状态（$u=K$）入侵裸地状态（$u=0$）。负速度 $c0$ 意味着裸地状态入侵。速度 $c=0$ 表示一个静止或“钉扎”的波前。\n\n为了确定 $c$ 的符号，我们采用势函数方法。我们将该常微分方程乘以 $\\frac{dU}{dz}$，并对 $z$ 从 $-\\infty$ 到 $+\\infty$ 进行积分：\n$$\n\\int_{-\\infty}^{+\\infty} \\left( D \\frac{d^2U}{dz^2} \\frac{dU}{dz} + c \\left(\\frac{dU}{dz}\\right)^2 + f(U)\\frac{dU}{dz} \\right) dz = 0\n$$\n这些项可以改写为：\n$$\n\\int_{-\\infty}^{+\\infty} \\left( \\frac{d}{dz}\\left[\\frac{D}{2}\\left(\\frac{dU}{dz}\\right)^2\\right] + c \\left(\\frac{dU}{dz}\\right)^2 + \\frac{d}{dz}[\\Phi(U)] \\right) dz = 0\n$$\n其中 $\\Phi(U) = \\int f(U) dU$ 是反应项的反导数，通常称为反应势。对精确导数项进行积分得到：\n$$\n\\left[ \\frac{D}{2}\\left(\\frac{dU}{dz}\\right)^2 + \\Phi(U) \\right]_{z=-\\infty}^{z=+\\infty} + c \\int_{-\\infty}^{+\\infty} \\left(\\frac{dU}{dz}\\right)^2 dz = 0\n$$\n应用边界条件，其中在 $z=+\\infty$ 处 $\\frac{dU}{dz} \\to 0$，$U \\to 0$，在 $z=-\\infty$ 处 $U \\to K$：\n$$\n(\\Phi(0) - \\Phi(K)) + c \\int_{-\\infty}^{+\\infty} \\left(\\frac{dU}{dz}\\right)^2 dz = 0\n$$\n整理以求解速度 $c$：\n$$\nc \\int_{-\\infty}^{+\\infty} \\left(\\frac{dU}{dz}\\right)^2 dz = \\Phi(K) - \\Phi(0)\n$$\n对于任何非平凡波前（即 $U$ 不是常数），积分 $\\int_{-\\infty}^{+\\infty} (\\frac{dU}{dz})^2 dz$ 都是严格为正的。因此，速度 $c$ 的符号完全由势差 $\\Phi(K) - \\Phi(0)$ 的符号决定。这个差值等同于反应项在两个稳定状态之间的定积分：\n$$\n\\Delta \\equiv \\Phi(K) - \\Phi(0) = \\int_0^K f(u) du\n$$\n这个积分 $\\Delta$ 就是我们必须评估的诊断判据。它的符号决定了入侵的方向。扩散系数 $D$ 影响 $c$ 的大小，但不影响其符号。\n\n现在我们对给定的 $f(u)$ 解析地计算这个积分：\n$$\nf(u) = r\\, u \\left(1 - \\frac{u}{K}\\right)\\left(\\frac{u}{A} - 1\\right) = \\frac{r}{AK} u(K-u)(u-A) = \\frac{r}{AK} (-u^3 + (A+K)u^2 - AKu)\n$$\n$$\n\\Delta = \\int_0^K \\frac{r}{AK} (-u^3 + (A+K)u^2 - AKu) du\n$$\n$$\n\\Delta = \\frac{r}{AK} \\left[ -\\frac{u^4}{4} + (A+K)\\frac{u^3}{3} - AK\\frac{u^2}{2} \\right]_0^K\n$$\n$$\n\\Delta = \\frac{r}{AK} \\left( -\\frac{K^4}{4} + (A+K)\\frac{K^3}{3} - AK\\frac{K^2}{2} \\right)\n$$\n提取公因式：\n$$\n\\Delta = \\frac{rK^3}{AK} \\left( -\\frac{K}{4} + \\frac{A+K}{3} - \\frac{A}{2} \\right) = \\frac{rK^2}{A} \\left( \\frac{-3K + 4(A+K) - 6A}{12} \\right)\n$$\n$$\n\\Delta = \\frac{rK^2}{A} \\left( \\frac{-3K + 4A + 4K - 6A}{12} \\right) = \\frac{rK^2}{A} \\left( \\frac{K - 2A}{12} \\right)\n$$\n$$\n\\Delta = \\frac{rK^3}{12A}(K - 2A)\n$$\n由于 $r$、$K$ 和 $A$ 均为正数，诊断积分 $\\Delta$ 的符号与项 $(K - 2A)$ 的符号相同。\n\n最终的入侵判据是：\n1.  如果 $\\Delta  0$，对应于 $K - 2A  0$ 或 $A  K/2$，则 $c  0$。植被覆盖状态（$u=K$）入侵裸地状态（$u=0$）。系统倾向于植被化。我们将此结果赋予整数 $1$。\n2.  如果 $\\Delta  0$，对应于 $K - 2A  0$ 或 $A  K/2$，则 $c  0$。裸地状态（$u=0$）入侵植被覆盖状态（$u=K$）。系统倾向于沙漠化。我们将此结果赋予整数 $-1$。\n3.  如果 $\\Delta = 0$，对应于 $K - 2A = 0$ 或 $A = K/2$，则 $c = 0$。波前被钉扎，两个状态处于平衡状态。我们将此结果赋予整数 $0$。\n\n对于数值实现，我们将为每一组给定的参数计算诊断量 $\\Delta = \\frac{rK^3}{12A}(K-2A)$ 的值。如果 $|\\Delta| \\le \\varepsilon$，其中指定的公差为 $\\varepsilon = 10^{-9}$，则认为波前是钉扎的。这正确地实现了所推导出的判据。", "answer": "[0,1,-1,0,-1,1]", "id": "2473791"}]}