{"hands_on_practices": [{"introduction": "染色体遗传理论认为基因在染色体上呈线性排列。三点测交不仅是确定基因顺序和距离的强大工具，也是探究交换机制本身的窗口。本练习将要求你分析来自经典果蝇杂交实验的数据，以量化交换干涉现象 [@problem_id:2842598]。通过计算符合系数，你将亲身体验如何衡量一个交换事件对邻近区域另一个交换事件发生概率的影响，从而揭示减数分裂重组的一个基本调控特征。", "problem": "在果蝇 *Drosophila melanogaster* 的一个涉及未知顺序的基因座 $A$、$B$ 和 $C$ 的三点测交中，一位研究者计数了 $n = 10{,}000$ 个子代，并根据从表型推断的交换结构将它们分为四个不相交的类别：在 $A$–$B$ 和 $B$–$C$ 两个区间均未发生重组的非重组体，仅在 $A$–$B$ 区间发生单交换，仅在 $B$–$C$ 区间发生单交换，以及在两个区间都发生双交换。观测到的计数如下：非重组体 $8{,}060$，在 $A$–$B$ 区间的单交换 $1{,}140$，在 $B$–$C$ 区间的单交换 $740$，双交换 $60$。仅使用遗传的染色体理论的基本原理——即等位基因位于物理染色体上，同源染色体在减数分裂中配对和分离，交换作为非姐妹染色单体之间的物理交换产生重组染色单体，以及测交将配子基因型无遮蔽地映射到子代表型——从第一性原理推导，在没有干涉即相邻区间交换形成是独立的假设下，如何计算双交换的期望数量。然后，根据观测到和期望的双交换数计算并发系数和干涉。最后，对所得数值的干涉方向和大小提供一个简要的生物学解释。将并发系数和干涉表示为无量纲小数，每个都四舍五入到四位有效数字。最终报告的答案必须按顺序依次列出并发系数和干涉。", "solution": "该问题要求在独立性假设下推导双交换的期望数量，然后根据提供的测交数据计算并发系数和干涉，并对结果进行生物学解释。该问题是有效的，因为它具有科学依据，提法得当，且内部一致。\n\n首先，让我们确立基本原理。三点测交涉及一个三个连锁基因座（$A$、$B$、$C$）均为杂合的亲本与一个所有三个基因座均为纯合隐性的亲本杂交。子代的表型直接反映了杂合亲本产生的配子基因型。两个基因座之间的重组频率定义为重组配子（也就是重组型子代）在总数中所占的比例。其计算方法是，由两个基因座之间的区间内发生交换事件产生的子代总数除以子代总数。\n\n提供的数据按两个相邻染色体区间（我们将其标记为区间1，位于基因座$A$和$B$之间；区间2，位于基因座$B$和$C$之间）的交换事件进行分类。给出的计数如下：\n子代总数，$n = 10{,}000$\n非重组体 (NCO) 计数，$N_{NCO} = 8{,}060$\n区间1单交换 (SCO I) 计数，$N_{SCO_1} = 1{,}140$\n区间2单交换 (SCO II) 计数，$N_{SCO_2} = 740$\n双交换 (DCO) 计数，$N_{DCO} = 60$\n总和为 $8{,}060 + 1{,}140 + 740 + 60 = 10{,}000$，与子代总数 $n$ 一致。\n\n区间1的重组频率 $RF_1$ 是由该区间发生交换产生的子代所占的比例。这些子代包括区间1的单交换和双交换。\n$$RF_1 = \\frac{N_{SCO_1} + N_{DCO}}{n} = \\frac{1{,}140 + 60}{10{,}000} = \\frac{1{,}200}{10{,}000} = 0.12$$\n\n类似地，区间2的重组频率 $RF_2$ 是由这第二个区间发生交换产生的子代所占的比例。这些子代包括区间2的单交换和双交换。\n$$RF_2 = \\frac{N_{SCO_2} + N_{DCO}}{n} = \\frac{740 + 60}{10{,}000} = \\frac{800}{10{,}000} = 0.08$$\n\n问题要求在相邻区间交换事件独立的假设下，推导双交换的期望数量。这个条件意味着没有干涉。根据概率法则，两个独立事件同时发生的概率是它们各自概率的乘积。\n设 $P(CO_1)$ 为区间1发生交换的概率，$P(CO_2)$ 为区间2发生交换的概率。根据重组频率的定义，$P(CO_1) = RF_1$ 且 $P(CO_2) = RF_2$。\n如果事件是独立的，那么双交换的概率 $P(DCO)$ 是：\n$$P(DCO)_{\\text{expected}} = P(CO_1) \\times P(CO_2) = RF_1 \\times RF_2$$\n这是双交换的期望频率。为了在一个大小为 $n$ 的群体中找到双交换子代的期望*数量* $N_{DCO, \\text{exp}}$，我们将此概率乘以 $n$：\n$$N_{DCO, \\text{exp}} = n \\times P(DCO)_{\\text{expected}} = n \\times RF_1 \\times RF_2$$\n至此，从第一性原理的推导完成。\n\n现在，我们代入计算出的 $RF_1$ 和 $RF_2$ 的值来求出双交换的期望数量：\n$$N_{DCO, \\text{exp}} = 10{,}000 \\times 0.12 \\times 0.08 = 10{,}000 \\times 0.0096 = 96$$\n假设没有干涉，双交换的期望计数是 $96$。观测到的计数是 $N_{DCO, \\text{obs}} = 60$。\n\n并发系数 $C$ 是观测到的双交换数量与期望的双交换数量之比。它衡量期望的双交换数量实现的程度。\n$$C = \\frac{N_{DCO, \\text{obs}}}{N_{DCO, \\text{exp}}} = \\frac{60}{96} = \\frac{5}{8} = 0.625$$\n四舍五入到四位有效数字，我们得到 $C = 0.6250$。\n\n干涉 $I$ 量化了一个交换事件影响相邻区域发生第二个交换事件概率的程度。其定义为：\n$$I = 1 - C$$\n代入 $C$ 的值：\n$$I = 1 - 0.625 = 0.375$$\n四舍五入到四位有效数字，我们得到 $I = 0.3750$。\n\n最后，需要对这些值进行简要的生物学解释。\n并发系数 $C = 0.6250$ 表明，观测到的双交换频率仅为假定两个区间的交换是独立事件时所期望频率的 $62.5\\%$。\n干涉值 $I = 0.3750$ 是正值。这表示正干涉，这是一种常见的生物学现象，即染色体上一个交换（交叉）的形成会通过机械或生物化学方式抑制邻近区域第二个交换的形成。在这个具体案例中，由于这种抑制效应，有 $37.5\\%$ 的期望双交换未能发生。一个区间内交换的存在，使相邻区间发生交换的可能性降低了 $37.5\\%$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6250  0.3750 \\end{pmatrix}}$$", "id": "2842598"}, {"introduction": "虽然标准测交可以绘制基因间的图距，但某些模式生物（如真菌）能够回收减数分裂的全部四个产物，为研究分离过程提供了独特的视角。在此实践中，你将利用有序四分体数据来计算基因与其着丝粒之间的距离，这是一个关键的染色体地标 [@problem_id:2965663]。本练习阐明了减数分裂分离模式（第一次分裂分离与第二次分裂分离）与重组频率之间的直接关系，让你对染色体力学有更深入的理解。", "problem": "在遗传的染色体理论框架下，使用一种丝状子囊菌进行有序四分体分析，以估计单个基因座与其染色体着丝粒之间的距离。请仅使用关于减数分裂和分离的基本原理来推导必要的关系式，然后将其应用于下面给出的数据。\n\n您可以使用的基本背景知识：在第一次减数分裂期间，同源着丝粒向相反的两极分离。在有序子囊中，八个孢子的线性排列反映了沿子囊轴发生的减数分裂的顺序。如果在第一次减数分裂之前，一个基因座与其着丝粒之间没有发生交换，其等位基因将在第一次分裂时分离，产生一个由四个某一等位基因的孢子组成的连续区块，后面跟着四个另一等位基因的孢子（第一次分裂分离，FDS）。如果在第一次减数分裂之前，基因座和着丝粒之间发生了交换，等位基因直到第二次减数分裂后才分离，从而沿子囊轴产生交错的区块（第二次分裂分离，SDS）。您可以假设：不存在染色单体干涉，染色单体随机参与交换，并且着丝粒与基因座之间交换次数的奇偶性决定了观察到的是FDS（偶数次）还是SDS（奇数次）。\n\n一项实验对单个杂合基因座的有序子囊进行了计数。数据集如下：\n- 第一次分裂分离 (FDS)：$542$ 个子囊\n- 第二次分裂分离 (SDS)：$238$ 个子囊\n- 减数后分离 (PMS；与未修复的异源双链一致的异常分离，例如 $5{:}3$ 或 $3{:}5$)：$12$ 个子囊\n- 无法计数或无序的子囊：$8$ 个子囊\n\n任务：\n1. 根据上述基本背景知识，推导出一个以可观察到的第二次分裂分离子囊频率表示的基因-着丝粒图距表达式，并明确说明您为将可观察到的四分体类别与基于重组的距离度量联系起来所做的任何假设。\n2. 将您的表达式应用于该数据集，仅使用那些可以明确分类为简单双等位基因基因座的第一次分裂分离或第二次分裂分离的子囊（排除减数后分离和无法计数的子囊），并计算基因-着丝粒距离。\n3. 简要说明在此背景下排除减数后分离子囊是否合适，并定性预测若将其计为第二次分裂分离会如何使估计产生偏差。\n\n以厘摩 (cM) 为单位表示最终的数值距离，并将您的答案四舍五入到四位有效数字。最终答案必须是一个实数。", "solution": "该问题要求从有序四分体数据中推导基因-着丝粒图距，将其应用于给定的数据集，并对数据处理方式进行批判性分析。\n\n首先，我们必须根据减数分裂的基本原理，推导出图距与第二次分裂分离子囊频率之间的关系。图距以厘摩 (cM) 为单位，定义为重组型减数分裂产物（配子，或在此案例中为孢子）的频率乘以 $100$。$1$ cM 的距离对应于 $1\\%$ 的重组率。\n\n设 $N_{FDS}$ 表示显示第一次分裂分离的子囊数量，$N_{SDS}$ 表示显示第二次分裂分离的子囊数量。用于分析的子囊总数为 $N_{total} = N_{FDS} + N_{SDS}$。每个子囊包含 $8$ 个孢子，它们是由一次减数分裂和一次有丝分裂产生的。\n\n当基因座和着丝粒之间没有发生有效交换（即偶数次交换，包括零次）时，会出现第一次分裂分离 (FDS) 模式。在FDS子囊中，所有 $8$ 个孢子就着丝粒连锁而言都是亲本型的。因此，FDS子囊包含零个重组型孢子。\n\n当基因座和着丝粒之间发生奇数次交换时，会观察到第二次分裂分离 (SDS) 模式。让我们考虑最简单的情况：一次单一交换。该事件涉及第一次减数分裂四线期的四条染色单体中的两条。参与交换的两条染色单体变为重组型，而另外两条保持非重组型（亲本型）。经过减数分裂和随后的有丝分裂，产生的子囊包含 $4$ 个重组型孢子和 $4$ 个亲本型孢子。因此，SDS子囊中恰好有一半的孢子是重组的产物。在没有染色单体干涉的标准假设下，重组型四分体内部的重组产物与亲本产物之间的这种 $1:1$ 的比例，对于多次交换也平均成立。\n\n总重组率 ($RF$) 是重组型孢子总数与孢子总数的比率。\n样本中的孢子总数为 $8 \\times N_{total} = 8 \\times (N_{FDS} + N_{SDS})$。\n重组型孢子只存在于SDS子囊中。每个 $N_{SDS}$ 子囊贡献 $4$ 个重组型孢子。因此，重组型孢子的总数为 $4 \\times N_{SDS}$。\n\n我们现在可以写出重组率的表达式：\n$$RF = \\frac{\\text{Total number of recombinant spores}}{\\text{Total number of spores}} = \\frac{4 \\times N_{SDS}}{8 \\times (N_{FDS} + N_{SDS})}$$\n该表达式可简化为：\n$$RF = \\frac{1}{2} \\times \\frac{N_{SDS}}{N_{FDS} + N_{SDS}}$$\n项 $\\frac{N_{SDS}}{N_{FDS} + N_{SDS}}$ 是可观察到的第二次分裂分离子囊的频率，可表示为 $f_{SDS}$。方程变为 $RF = \\frac{1}{2} f_{SDS}$。\n以厘摩为单位的图距是 $100 \\times RF$。代入我们关于 $RF$ 的表达式，我们得到所需的公式：\n$$ \\text{Distance (cM)} = 100 \\times \\left( \\frac{1}{2} f_{SDS} \\right) = 50 \\times f_{SDS} = 50 \\times \\frac{N_{SDS}}{N_{FDS} + N_{SDS}} $$\n\n其次，我们将此公式应用于给定的数据集。我们已知：\n- FDS 子囊, $N_{FDS} = 542$\n- SDS 子囊, $N_{SDS} = 238$\n问题指明要排除减数后分离 (PMS) 和无法计数的子囊。可分类的子囊总数为：\n$$N_{total} = N_{FDS} + N_{SDS} = 542 + 238 = 780$$\nSDS子囊的频率是：\n$$f_{SDS} = \\frac{N_{SDS}}{N_{total}} = \\frac{238}{780}$$\n现在，我们计算图距：\n$$ \\text{Distance (cM)} = 50 \\times \\frac{238}{780} = \\frac{11900}{780} \\approx 15.25641... $$\n按要求，四舍五入到四位有效数字，得到的距离为 $15.26$ cM。\n\n第三，我们讨论排除减数后分离 (PMS) 子囊的理由，以及如果包含它们会产生的偏差。\nPMS源于重组过程中形成的异源双链DNA，该DNA在减数后有丝分裂之前未被错配修复机制解决。这导致子囊出现非孟德尔分离比，例如 $5:3$ 或 $3:5$。异源双链的形成是重组过程的一个组成部分。因此，观察到PMS意味着在该基因座上发生了重组事件。如果此事件发生在基因和着丝粒之间的区间内，那么从机制上讲，该子囊属于SDS子囊类型。\n\n然而，排除它们是合理的，因为用于计算图距的模型基于FDS和SDS子囊之间的明确区分，这两种子囊都表现出 $4:4$ 的等位基因分离模式。PMS代表一种不同的分子结果（基因转换或其失败），这使得这种简单的分类变得复杂。通过排除这 $12$ 个PMS子囊，我们将交换现象与基因转换现象分离开来，从而提供一个更常规的、由交换频率定义的图距估计值。\n\n如果将PMS子囊归类为SDS子囊并将其包含在内，计算值将会改变。SDS类型的子囊数量将变为 $N'_{SDS} = N_{SDS} + N_{PMS} = 238 + 12 = 250$。子囊总数将变为 $N'_{total} = N_{FDS} + N'_{SDS} = 542 + 250 = 792$。新的图距将是：\n$$ \\text{Distance' (cM)} = 50 \\times \\frac{250}{792} \\approx 15.7828... $$\n该值高于之前计算的 $15.26$ cM。因此，与标准程序相比，将PMS子囊计为SDS子囊的定性效应是**高估**了基因-着丝粒图距。", "answer": "$$\n\\boxed{15.26}\n$$", "id": "2965663"}, {"introduction": "染色体理论的应用超出了遗传模式的范畴，延伸到解释生物体如何应对染色体数目的差异，例如性染色体。现代基因组学为我们在全局尺度上研究这些差异所带来的调控后果提供了有力工具。这项高级练习要求你基于模拟的RNA测序数据，推导并应用一个计算指标来量化剂量补偿效应 [@problem_id:2965681]。你将学习如何标准化基因表达数据，以便就染色体范围内的调控得出有意义的结论，从而将经典遗传学原理与当代生物信息学分析联系起来。", "problem": "给定来自雄性和雌性组织的配对核糖核酸测序 (RNA-seq) 数据，这些数据针对小型基因集，并附有识别X连锁基因和常染色体基因的染色体注释。您的任务是形式化、从第一性原理推导并计算一个无量纲指数，该指数用于量化两性间的剂量补偿效应，然后将其应用于一个固定的测试套件，并报告数值结果。\n\n背景与允许的基础：遗传的染色体理论断言，基因位于染色体上，并根据染色体的行为进行分离。在许多物种中，雄性和雌性的X染色体拷贝数不同。分子生物学的中心法则指出，脱氧核糖核酸 (DNA) 转录为核糖核酸 (RNA)，后者再翻译成蛋白质。RNA-seq测量提供了基因表达丰度的估计值。除非通过X染色体失活 (XCI) 或X连锁超转录等调控机制进行补偿，否则X染色体拷贝数的性别差异会导致X连锁基因表达的剂量差异。由于测序深度和全局转录活性可能因样本而异，常染色体表达提供了一个基线，用于校正并非由X染色体剂量引起的性别特异性差异。\n\n请根据以下原则设计并推导一个指数。设 $M_i$ 和 $F_i$ 分别表示基因 $i$ 在雄性和雌性样本中的表达量测量值，单位为每百万转录本 (TPM)，并设 $C_i \\in \\{\\text{\"X\"}, \\text{\"A\"}\\}$ 为染色体标签（\"X\" 代表X连锁，\"A\" 代表常染色体）。设 $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$、$A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$、$X_F = \\sum_{i : C_i = \\text{\"X\"}} F_i$ 和 $A_F = \\sum_{i : C_i = \\text{\"A\"}} F_i$ 分别表示每种性别中X连锁和常染色体的总表达量。您的指数必须满足：\n- 尺度归一化：它必须在每种性别内部比较X连锁表达与常染色体表达，以消除全局尺度的影响，也就是说，它必须仅通过性别内部的X连锁与常染色体比较来依赖于 $X_M$、$A_M$、$X_F$ 和 $A_F$。\n- 全局重缩放不变性：如果所有雄性表达值乘以一个正常数 $s_M$，所有雌性表达值乘以一个正常数 $s_F$，该指数必须保持不变。\n- 倍数变化的解释性：如果雄性性别内部的X连锁与常染色体比较值与雌性的相差一个乘法因子 $k>0$，则该指数必须加性地变化一个与 $\\log_2 k$ 成正比的量，使得 $k=2$ 对应于 $+1$ 的增量，$k=1/2$ 对应 $-1$，而 $k=1$ 对应 $0$。\n- 符号约定：该指数为 $0$ 当且仅当雄性和雌性性别内部的比较值相等；如果雄性性别内部的比较值超过雌性，则为正；反之则为负。\n- 数值稳定性：为了处理 $X_M$、$A_M$、$X_F$ 或 $A_F$ 中任何一个可能为 $0$ 的情况，在形成任何比率之前，应在所有分子和分母上加上一个小的正数稳定器 $\\epsilon = 10^{-6}$。\n\n实现一个程序，该程序：\n1. 根据这些原则，构造一个满足上述所有性质的关于 $X_M$、$A_M$、$X_F$ 和 $A_F$ 的具体、定义明确的函数。\n2. 将其应用于下面测试套件中的每个数据集。\n3. 将所有案例的结果输出为单行：一个用方括号括起来的逗号分隔列表，其中包含计算出的值，每个值四舍五入到3位小数。\n\n所有表达量输入单位为每百万转录本 (TPM)；该指数无单位报告。当您的推导需要对数时，请使用以2为底的对数。\n\n测试套件（每个案例提供一个元组：雄性TPM列表、雌性TPM列表、染色体标签列表）。每个列表按索引对齐，每个数字必须解释为TPM。标签 \"X\" 代表X连锁基因，\"A\" 代表常染色体基因。\n- 案例1（补偿基线；性别内部的X连锁与常染色体表达平衡在两性间相等）：\n  - 雄性 TPMs: [$50$, $30$, $100$, $120$, $80$, $150$]\n  - 雌性 TPMs: [$90$, $70$, $200$, $240$, $160$, $300$]\n  - 染色体: [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- 案例2（无剂量补偿；在相似的常染色体基线下，雌性的X连锁表达量约是雄性的两倍）：\n  - 雄性 TPMs: [$50$, $30$, $100$, $120$, $80$, $150$]\n  - 雌性 TPMs: [$100$, $60$, $100$, $120$, $80$, $150$]\n  - 染色体: [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- 案例3（雄性X连锁相对于雌性发生超转录）：\n  - 雄性 TPMs: [$80$, $60$, $60$, $200$, $300$]\n  - 雌性 TPMs: [$50$, $50$, $50$, $300$, $450$]\n  - 染色体: [\"X\", \"X\", \"X\", \"A\", \"A\"]\n- 案例4（两性间存在全局表达差异但补偿得以保持；归一化应能抵消此差异）：\n  - 雄性 TPMs: [$40$, $40$, $200$, $220$, $230$]\n  - 雌性 TPMs: [$120$, $120$, $600$, $660$, $690$]\n  - 染色体: [\"X\", \"X\", \"A\", \"A\", \"A\"]\n- 案例5（边缘案例，一个基因在雄性中的X连锁表达几乎为零）：\n  - 雄性 TPMs: [$0$, $5$, $100$, $100$, $100$]\n  - 雌性 TPMs: [$10$, $10$, $150$, $150$, $150$]\n  - 染色体: [\"X\", \"X\", \"A\", \"A\", \"A\"]\n- 案例6（部分逃逸X失活；雌性X连锁表达相对于常染色体有适度超量）：\n  - 雄性 TPMs: [$30$, $30$, $30$, $200$, $200$, $200$, $200$]\n  - 雌性 TPMs: [$40$, $40$, $40$, $200$, $200$, $200$, $200$]\n  - 染色体: [\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n\n最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，[$v_1$,$v_2$,$v_3$,$v_4$,$v_5$,$v_6$]），其中每个 $v_i$ 是您为案例 $i$ 计算的指数，以十进制表示并四舍五入到3位小数。", "solution": "我们从基于遗传的染色体理论和中心法则的第一性原理出发。雄性和雌性之间X染色体拷贝数的差异造成了X连锁基因剂量潜在的两倍不平衡。生物体通常进化出调控机制，如X染色体失活 (XCI) 或超转录，以使有效的X连锁基因表达在两性间均等化。核糖核酸测序 (RNA-seq) 提供了基因表达的定量估计，通常归一化为每百万转录本 (TPM)。然而，样本间的总测序深度和全局转录活性可能不同。因此，在每种性别内部比较X连锁表达与常染色体表达，可以控制与性别染色体剂量无关的全局尺度因子。\n\n我们被要求设计一个满足五个关键性质的指数：通过性别内部X连锁与常染色体比较实现尺度归一化，对全局重缩放具有不变性，通过乘性偏差下的加性来保证倍数变化的可解释性，具有在相等时为零点的符号约定，以及通过添加一个小的正数稳定器 $\\epsilon = 10^{-6}$ 来防止除以零，从而保证数值稳定性。\n\n设 $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$ 和 $A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$ 分别表示雄性X连锁和常染色体表达的总量，类似地，$X_F$ 和 $A_F$ 表示雌性的总量。定义性别内部的X连锁与常染色体归一化量\n$$\nR_M = \\frac{X_M + \\epsilon}{A_M + \\epsilon}, \\quad R_F = \\frac{X_F + \\epsilon}{A_F + \\epsilon},\n$$\n其中 $\\epsilon = 10^{-6}$ 被加到分子和分母上以保证稳定性。这种构造实现了尺度归一化并消除了全局尺度的影响：将所有雄性表达量乘以一个正常数 $s_M$ 会使 $X_M$ 和 $A_M$ 都乘以 $s_M$，而 $R_M$ 保持不变（$R_F$ 同理）。因此，该指数必须是比率 $R_M / R_F$ 的函数，以满足不变性要求和在相等时为0的符号约定。\n\n为了强制实现倍数变化的可解释性，使得乘性差异变为加性差异，并且2倍对应于+1，我们需要一个函数 $g$，使得 $g\\!\\left(k\\right)$ 在乘法下对 $k$ 是加性的，并以2为底的倍数变化单位来度量。将乘性差异映射为加性差异的标准且唯一（在相差一个乘法常数的情况下）的连续函数是对数。选择以2为底的对数设定了单位，使得因子2映射到+1，1/2映射到-1，相等（1）映射到0。因此，满足所有约束的唯一自然选择是\n$$\n\\mathrm{DCI} \\equiv \\log_2 \\left( \\frac{R_M}{R_F} \\right) \\;=\\; \\log_2 \\left( \\frac{X_M + \\epsilon}{A_M + \\epsilon} \\cdot \\frac{A_F + \\epsilon}{X_F + \\epsilon} \\right).\n$$\n这个剂量补偿指数 (DCI) 是无量纲的，当且仅当归一化后的X连锁与常染色体比率在两性间相等时等于0，当雄性归一化后的X水平超过雌性时为正，反之为负。稳定器 $\\epsilon = 10^{-6}$ 确保了在退化情况下的数值稳健性。\n\n我们现在为每个案例计算DCI，并四舍五入到3位小数。\n\n- 案例1：\n  - 雄性：$X_M = 50 + 30 = 80$，$A_M = 100 + 120 + 80 + 150 = 450$，所以 $R_M = \\frac{80 + 10^{-6}}{450 + 10^{-6}} \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$。\n  - 雌性：$X_F = 90 + 70 = 160$，$A_F = 200 + 240 + 160 + 300 = 900$，所以 $R_F = \\frac{160 + 10^{-6}}{900 + 10^{-6}} \\approx \\frac{160}{900} \\approx 0.177\\overline{7}$。\n  - 比率：$\\frac{R_M}{R_F} \\approx 1$，因此 $\\mathrm{DCI} \\approx \\log_2(1) = 0.000$。\n\n- 案例2：\n  - 雄性：$X_M = 80$，$A_M = 450$，$R_M \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$。\n  - 雌性：$X_F = 100 + 60 = 160$，$A_F = 100 + 120 + 80 + 150 = 450$，$R_F \\approx \\frac{160}{450} \\approx 0.355\\overline{5}$。\n  - 比率：$\\frac{R_M}{R_F} \\approx \\frac{80/450}{160/450} = \\frac{1}{2}$，所以 $\\mathrm{DCI} = \\log_2\\!\\left(\\frac{1}{2}\\right) = -1.000$。\n\n- 案例3：\n  - 雄性：$X_M = 80 + 60 + 60 = 200$，$A_M = 200 + 300 = 500$，$R_M = \\frac{200}{500} = 0.4$。\n  - 雌性：$X_F = 50 + 50 + 50 = 150$，$A_F = 300 + 450 = 750$，$R_F = \\frac{150}{750} = 0.2$。\n  - 比率：$\\frac{R_M}{R_F} = \\frac{0.4}{0.2} = 2$，因此 $\\mathrm{DCI} = \\log_2(2) = 1.000$。\n\n- 案例4：\n  - 雄性：$X_M = 40 + 40 = 80$，$A_M = 200 + 220 + 230 = 650$，$R_M \\approx \\frac{80}{650} \\approx 0.1230769$。\n  - 雌性：$X_F = 120 + 120 = 240$，$A_F = 600 + 660 + 690 = 1950$，$R_F \\approx \\frac{240}{1950} \\approx 0.1230769$。\n  - 比率：$\\frac{R_M}{R_F} \\approx 1$，所以 $\\mathrm{DCI} \\approx 0.000$。\n\n- 案例5：\n  - 雄性：$X_M = 0 + 5 = 5$，$A_M = 100 + 100 + 100 = 300$，$R_M \\approx \\frac{5 + 10^{-6}}{300 + 10^{-6}} \\approx \\frac{5}{300} \\approx 0.016\\overline{6}$。\n  - 雌性：$X_F = 10 + 10 = 20$，$A_F = 150 + 150 + 150 = 450$，$R_F \\approx \\frac{20}{450} \\approx 0.044\\overline{4}$。\n  - 比率：$\\frac{R_M}{R_F} \\approx \\frac{0.016\\overline{6}}{0.044\\overline{4}} = 0.375$，所以 $\\mathrm{DCI} = \\log_2(0.375) \\approx -1.4150375$，当直接计算时：$\\log_2\\!\\left(\\frac{3}{8}\\right) = \\log_2(3) - 3 \\approx 1.58496 - 3 = -1.41504$，四舍五入为 $-1.415$。\n\n- 案例6：\n  - 雄性：$X_M = 30 + 30 + 30 = 90$，$A_M = 200 \\times 4 = 800$，$R_M = \\frac{90}{800} = 0.1125$。\n  - 雌性：$X_F = 40 + 40 + 40 = 120$，$A_F = 200 \\times 4 = 800$，$R_F = \\frac{120}{800} = 0.15$。\n  - 比率：$\\frac{R_M}{R_F} = \\frac{0.1125}{0.15} = 0.75$，得到 $\\mathrm{DCI} = \\log_2(0.75) \\approx -0.415037$，四舍五入为 $-0.415$。\n\n因此，将每个结果四舍五入到3位小数后，预期的输出依次是：\n- 案例1：$0.000$\n- 案例2：$-1.000$\n- 案例3：$1.000$\n- 案例4：$0.000$\n- 案例5：$-1.415$\n- 案例6：$-0.415$\n\n该程序通过使用提供的染色体标签进行求和来计算 $X_M$、$A_M$、$X_F$ 和 $A_F$，用 $\\epsilon = 10^{-6}$ 构成 $R_M$ 和 $R_F$，计算 $\\mathrm{DCI} = \\log_2\\!\\left(R_M/R_F\\right)$，四舍五入到3位小数，并以所需格式打印列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6):\n    \"\"\"\n    Compute the Dosage Compensation Index (DCI) for one dataset.\n    DCI = log2( ( (X_M + eps)/(A_M + eps) ) / ( (X_F + eps)/(A_F + eps) ) )\n    where X_* and A_* are sums of TPMs over X-linked and autosomal genes.\n    \"\"\"\n    male_tpm = np.asarray(male_tpm, dtype=float)\n    female_tpm = np.asarray(female_tpm, dtype=float)\n    chrom_labels = np.asarray(chrom_labels)\n\n    x_mask = chrom_labels == \"X\"\n    a_mask = chrom_labels == \"A\"\n\n    XM = float(male_tpm[x_mask].sum())\n    AM = float(male_tpm[a_mask].sum())\n    XF = float(female_tpm[x_mask].sum())\n    AF = float(female_tpm[a_mask].sum())\n\n    RM = (XM + eps) / (AM + eps)\n    RF = (XF + eps) / (AF + eps)\n\n    dci = np.log2(RM / RF)\n    return dci\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            [50, 30, 100, 120, 80, 150],\n            [90, 70, 200, 240, 160, 300],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 2\n        (\n            [50, 30, 100, 120, 80, 150],\n            [100, 60, 100, 120, 80, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 3\n        (\n            [80, 60, 60, 200, 300],\n            [50, 50, 50, 300, 450],\n            [\"X\", \"X\", \"X\", \"A\", \"A\"],\n        ),\n        # Case 4\n        (\n            [40, 40, 200, 220, 230],\n            [120, 120, 600, 660, 690],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 5\n        (\n            [0, 5, 100, 100, 100],\n            [10, 10, 150, 150, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 6\n        (\n            [30, 30, 30, 200, 200, 200, 200],\n            [40, 40, 40, 200, 200, 200, 200],\n            [\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n    ]\n\n    results = []\n    for male_tpm, female_tpm, chrom_labels in test_cases:\n        dci = compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6)\n        results.append(dci)\n\n    # Final print statement in the exact required format, rounded to 3 decimals.\n    print(f\"[{','.join(f'{v:.3f}' for v in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2965681"}]}