{"hands_on_practices": [{"introduction": "掌握基因结构的基本原理，首先要能从数量上区分其核心组成部分。这个练习将巩固你对外显子和内含子的理解，通过计算一个典型真核基因的初始转录本（前体mRNA）和经过剪接后的成熟mRNA的长度，你将亲身体会到在RNA加工过程中发生的信息压缩。这个基础计算是理解更复杂的剪接调控机制的第一步。[@problem_id:2946374]", "problem": "一个真核基因有三个已注释的外显子，长度分别为 $[100, 150, 200]$ 核苷酸 (nt)，以及两个已注释的内含子，长度分别为 $[1000, 500]$ nt。假设 RNA 聚合酶 II (RNA polymerase II) 的转录过程产生一个信使核糖核酸前体 (pre-mRNA)，该前体包含所有外显子和内含子序列；信使核糖核酸 (mRNA) 的成熟过程通过精确的外显子-外显子连接去除内含子，且不改变外显子长度。忽略 $5^{\\prime}$ 端帽和 $3^{\\prime}$ 端多聚腺苷酸尾（即，在计算成熟 mRNA 长度时不包括非模板指导添加的序列）。\n\n仅从以下基本事实出发：\n- 在分子生物学的中心法则中，脱氧核糖核酸 (DNA) 被转录成 RNA；对于蛋白质编码基因，其初级转录本 (pre-mRNA) 同时包含外显子和内含子。\n- 外显子是在成熟 mRNA 中保留的转录片段；内含子是通过剪接被移除的转录片段。\n- 在没有选择性剪接、RNA 编辑或末端修剪的情况下，成熟 mRNA 主体长度（不包括 $5^{\\prime}$ 端帽和 $3^{\\prime}$ 端多聚腺苷酸尾）等于所有外显子长度的总和，而 pre-mRNA 的长度等于所有外显子和内含子长度的总和。\n\n根据给定的外显子和内含子长度，推导 pre-mRNA 长度和成熟 mRNA 长度的表达式，并计算它们的数值。以核苷酸为单位报告这两个长度。将最终答案表示为一个含两个元素的行向量 $\\big[L_{\\text{pre}},\\,L_{\\text{mature}}\\big]$。无需四舍五入。", "solution": "该问题经过严格验证。\n\n步骤 1：提取已知条件。\n- 一个真核基因拥有 $3$ 个外显子。\n- 外显子的长度以集合 $E = \\{100, 150, 200\\}$ 核苷酸 (nt) 的形式给出。\n- 该基因拥有 $2$ 个内含子。\n- 内含子的长度以集合 $I = \\{1000, 500\\}$ nt 的形式给出。\n- 初始转录本是信使核糖核酸前体 (pre-mRNA)，包含所有外显子和内含子序列。\n- 成熟信使核糖核酸 (mRNA) 是通过去除所有内含子并精确连接外显子形成的，外显子长度保持不变。\n- $5^{\\prime}$ 端帽和 $3^{\\prime}$ 端多聚腺苷酸尾不包括在所有长度计算中。\n- 基本原理 1：pre-mRNA 转录本同时包含外显子和内含子。\n- 基本原理 2：外显子在成熟 mRNA 中保留；内含子被移除。\n- 基本原理 3：成熟 mRNA 主体长度是外显子长度之和。pre-mRNA 长度是所有外显子和内含子长度之和。\n- 目标是推导 pre-mRNA 长度（表示为 $L_{\\text{pre}}$）和成熟 mRNA 长度（表示为 $L_{\\text{mature}}$）的表达式，并计算它们的数值。结果需表示为一个含两个元素的行向量。\n\n步骤 2：使用提取的已知条件进行验证。\n对问题陈述的有效性进行评估。\n- **科学依据：**该问题描述了真核基因转录和剪接的典型过程，这是分子和细胞生物学中的一个基本概念。所提供的外显子和内含子长度在生物学上是合理的。基本事实是对既定原则的正确表述。该问题在科学上是合理的。\n- **良态的：**所有必要的数据（外显子长度、内含子长度）和定义都已明确提供。忽略端帽和尾部以及假设没有选择性剪接等假设，创建了一个清晰且可解的模型。存在唯一解。该问题是良态的。\n- **客观性：**该问题使用精确、定量和无偏见的语言进行陈述。没有主观或模糊的术语。\n\n步骤 3：结论与行动。\n该问题具有科学依据，是良态的、客观的且内部一致的。因此被认为是**有效的**。将推导出一个解决方案。\n\n推导过程从提供的基本原理出发。设外显子长度集合为 $\\{E_i\\}_{i=1}^{N_e}$，其中 $N_e$ 是外显子的数量。设内含子长度集合为 $\\{I_j\\}_{j=1}^{N_i}$，其中 $N_i$ 是内含子的数量。\n\n根据问题陈述，信使核糖核酸前体 (precursor messenger RNA) 的长度 $L_{\\text{pre}}$ 定义为转录区域的总长度，该区域包括所有外显子和内含子。因此，其长度是所有单个外显子和内含子长度的总和。\n$$L_{\\text{pre}} = \\sum_{i=1}^{N_e} E_i + \\sum_{j=1}^{N_i} I_j$$\n\n成熟信使核糖核酸 (mature messenger RNA) 的长度 $L_{\\text{mature}}$ 定义为经过剪接过程（该过程移除了所有内含子序列）后的转录本长度。成熟 mRNA 仅由连接起来的外显子组成。\n$$L_{\\text{mature}} = \\sum_{i=1}^{N_e} E_i$$\n\n问题提供了外显子和内含子长度的具体值。\n对于外显子，$N_e = 3$，其长度分别为 $E_1 = 100$ nt，$E_2 = 150$ nt 和 $E_3 = 200$ nt。\n对于内含子，$N_i = 2$，其长度分别为 $I_1 = 1000$ nt 和 $I_2 = 500$ nt。\n\n首先，我们计算外显子的总长度，这对应于成熟 mRNA 的长度。\n$$L_{\\text{mature}} = \\sum_{i=1}^{3} E_i = E_1 + E_2 + E_3$$\n$$L_{\\text{mature}} = 100 + 150 + 200 = 450 \\text{ nt}$$\n\n接下来，我们计算内含子的总长度。设其为 $L_{\\text{introns}}$。\n$$L_{\\text{introns}} = \\sum_{j=1}^{2} I_j = I_1 + I_2$$\n$$L_{\\text{introns}} = 1000 + 500 = 1500 \\text{ nt}$$\n\n最后，我们通过将外显子的总长度和内含子的总长度相加来计算 pre-mRNA 的长度。\n$$L_{\\text{pre}} = L_{\\text{mature}} + L_{\\text{introns}}$$\n$$L_{\\text{pre}} = 450 + 1500 = 1950 \\text{ nt}$$\n\n计算出的值为 $L_{\\text{pre}} = 1950$ nt 和 $L_{\\text{mature}} = 450$ nt。问题要求将结果表示为一个含两个元素的行向量 $\\begin{pmatrix} L_{\\text{pre}}  L_{\\text{mature}} \\end{pmatrix}$。\n\n因此，最终的向量是 $\\begin{pmatrix} 1950  450 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 1950  450 \\end{pmatrix}}$$", "id": "2946374"}, {"introduction": "基因序列不仅定义了静态结构，更指导着动态的剪接过程。这个练习将带你从简单的长度计算，转向复杂的生物学推理，通过分析一个关键剪接位点上发生的真实突变，你将学会像分子侦探一样思考：评估剪接体在主位点失效时如何选择“隐蔽”的备用位点，并预测这对最终的mRNA和蛋白质会产生怎样的后果。此练习旨在锻炼你整合多个分子规则（如剪接位点识别、增强子和沉默子）来解决定性问题的能力。[@problem_id:2946319]", "problem": "您正在分析一个人类前信使RNA (pre-mRNA)，它包含一个典型的$\\text{GT-AG}$内含子（基因组DNA表示法）的$5'$供体，这在RNA中对应于一个在$+1$和$+2$位置以$\\text{GU}$开头的$5'$剪接位点。在一个野生型等位基因中，外显子$3$的外显子-内含子交界处周围的局部序列背景符合哺乳动物$5'$剪接位点的共有序列，其简化表示如下（相对于外显子-内含子边界的位置，负数表示外显子坐标，正数表示内含子坐标）：\n- 外显子$3$的$-3$到$-1$位置：$5'$-C A G-$3'$\n- 内含子$3$的$+1$到$+6$位置：$5'$-G U A A G U-$3'$\n因此，野生型连接点可示意性地表示为 C A G|G U A A G U，其中“|”标记外显子-内含子边界。\n\n一位患者携带一个点突变，将基因组DNA中不变的$+1$位置的鸟嘌呤变为腺嘌呤，即在$+1$位置发生$\\text{G}\\to\\text{A}$。在pre-mRNA中，这将外显子-内含子交界处$+1$和$+2$位置的初始$5'$剪接位点二核苷酸从$\\text{GU}$变为$\\text{AU}$。\n\n存在两个邻近的类$5'$剪接位点基序：\n- 一个外显子隐蔽供体，位于典型连接点上游$8$个核苷酸处（即中心在$-8$位置），序列为$5'$-C A G|G U G A G U-$3'$，其中“|”表示外显悉$3$内部一个潜在的隐蔽外显子-内含子边界。该位点两侧有多个外显子剪接增强子 (ESE) 基序（例如，$5'$-G A A G A A-$3'$重复序列），已知它们会招募serine/arginine-rich (SR) proteins。\n- 一个内含子隐蔽供体，位于下游$15$个核苷酸处（$+15$到$+20$位置），序列为$5'$-C A G|G U U A C U-$3'$，但与一个由heterogeneous nuclear ribonucleoprotein A1 (hnRNP A1) 结合的外显子/内含子剪接沉默子基序重叠。\n\n假设以下经过充分检验的事实：(i) 在后生动物中，$5'$剪接位点的识别始于U1 small nuclear ribonucleoprotein (U1 snRNP; 其RNA组分是 U1 small nuclear RNA (snRNA)) 的$5'$末端与pre-mRNA的$+1$到约$+6$位置之间的Watson–Crick碱基配对，对$+1$位置的$\\text{G}$和$+2$位置的$\\text{U}$有近乎不变的要求；(ii) 结合到ESE上的SR proteins能稳定U1 snRNP的招募，而结合到沉默子上的hnRNP A1则拮抗此过程；(iii) 哺乳动物细胞中的外显子定义过程将外显子两侧的两个剪接位点的识别耦合起来，但仍需要一个被充分识别的供体。\n\n哪个选项最能描述$+1$位置$\\text{G}\\to\\text{A}$突变对U1 snRNP结合和剪接结果的预期影响，包括隐蔽供体使用的可能性及其编码后果？\n\nA. $+1$位置的$\\text{G}\\to\\text{A}$替换废除了在典型供体处的有效U1 snRNP配对，使初始识别转移到$-8$位置的外显子隐蔽供体 (C A G|G U G A G U)，该位点在$+1,+2$位置的$\\text{GU}$及其两侧与ESE结合的SR proteins有利于其被选择。mRNA将缺少外显子$3$的最后$8$个核苷酸，从而引发移码，并可能导致无义介导的衰变。\n\nB. U1 snRNP可以通过在$+1$位置可容忍的摆动配对(A–U)来维持在典型供体处的结合，因此剪接过程基本正常进行，仅有轻微的效率损失；隐蔽供体不被激活，编码序列保持不变。\n\nC. 该突变因其靠近$5'$帽的缘故，增加了U1 snRNP对$+15$位置内含子隐蔽供体的亲和力，从而促进了该内含子隐蔽供体的选择，并导致mRNA中部分内含子的保留。\n\nD. 因为外显子定义需要一个完整的供体，所以剪接体完全绕过外显子$3$，导致外显子$3$跳跃成为主要结果，而不是激活任何附近的隐蔽供体，如果外显子$3$的长度能被$3$整除，则会导致框内外显子跳跃。\n\nE. U6 small nuclear RNA (snRNA) 在早期阶段补偿了受损的U1 snRNP识别，恢复了对典型供体的正常使用；剪接和编码序列保持不变。", "solution": "必须首先验证问题陈述的科学合理性和逻辑一致性。\n\n### 步骤1：提取已知信息\n问题提供了以下信息：\n1.  **系统**：一个含典型$\\text{GT-AG}$内含子$5'$供体的人类前信使RNA (pre-mRNA)。\n2.  **野生型(WT)剪接位点**：外显子$3$和内含子$3$之间的连接点被描述为 C A G|G U A A G U，其中'|'是外显子-内含子边界。外显子部分是$5'$-C A G-$3'$（位置$-3$到$-1$），内含子部分是$5'$-G U A A G U-$3'$（位置$+1$到$+6$）。典型的$\\text{GU}$二核苷酸位于$+1$和$+2$位置。\n3.  **突变**：基因组DNA中的一个点突变导致在$+1$内含子位置发生$\\text{G}\\to\\text{A}$变化。在pre-mRNA中，这将$5'$剪接位点的二核苷酸从$\\text{GU}$变为$\\text{AU}$。\n4.  **隐蔽剪接位点1（外显子的）**：位于$-8$位置。其序列为$5'$-C A G|G U G A G U-$3'$。它两侧有外显子剪接增强子 (ESE) 基序，这些基序会招募serine/arginine-rich (SR) proteins。\n5.  **隐蔽剪接位点2（内含子的）**：位于$+15$位置。其序列为$5'$-C A G|G U U A C U-$3'$。它与一个由heterogeneous nuclear ribonucleoprotein A1 (hnRNP A1) 结合的剪接沉默子基序重叠。\n6.  **既定事实**：\n    (i) 在后生动物中，$5'$剪接位点的识别需要U1 snRNA与pre-mRNA的$+1$到约$+6$位置之间的碱基配对，并且对$+1$位置的$\\text{G}$和$+2$位置的$\\text{U}$有“近乎不变的要求”。\n    (ii) 招募到ESE的SR proteins能稳定U1 snRNP的结合。招募到沉默子的hnRNP A1则拮抗此过程。\n    (iii) 外显子定义需要一个被识别的供体位点。\n\n### 步骤2：使用提取的已知信息进行验证\n根据所需标准对问题进行评估：\n-   **科学依据**：该问题描述了后生动物中pre-mRNA剪接的基本过程，包括共有剪接位点序列（$\\text{GU-AG}$规则）、U1 snRNP、隐蔽剪接位点以及顺式调控元件（ESE和剪接沉默子）及其反式作用因子（SR proteins和hnRNPs）的作用。所描述的突变（供体位点$+1$位置的$\\text{G}\\to\\text{A}$）是破坏剪接的突变的典型例子。所有提供的事实都与分子和细胞生物学的既定原则一致。\n-   **适定性**：该问题设置了一个清晰的“假设”情景：在一个明确定义的分子背景下的特定突变。它要求根据一套给定的规则推断出最可能的结果。这允许通过逻辑推导得出一个唯一的最佳答案。\n-   **客观性**：语言技术性强、精确且没有主观性。诸如“$+1$位置”、“U1 snRNP”和“ESE”之类的术语在该领域具有明确的含义。\n\n问题陈述没有违反任何无效标准。它在科学上是合理的，可形式化的，完整的，并且是适定的。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将推导解决方案。\n\n### 解决方案推导\n任务是预测内含子$3$的典型$5'$剪接供体位点发生$+1$ $\\text{G}\\to\\text{A}$突变的分子后果。\n\n1.  **对典型剪接位点的影响**：该突变将外显子-内含子连接点的序列从 C A G|**G** U A A G U 变为 C A G|**A** U A A G U。根据事实(i)，对$5'$剪接位点的识别是通过与U1 snRNA进行碱基配对来启动的，并且对$+1$位置的鸟嘌呤($\\text{G}$)有“近乎不变的要求”。执行此识别的U1 snRNA的$5'$末端具有共有序列$5'$-A U A C C U U...$3'$。在野生型情况下，它与剪接供体位点的配对如下：\n    $$\n    \\text{pre-mRNA} \\quad 5' \\quad \\dots \\text{A G} | \\mathbf{G U A A G U} \\quad \\dots \\quad 3' \\\\\n    \\qquad \\qquad \\qquad \\qquad \\quad || |.| || \\\\\n    \\text{U1 snRNA} \\quad 3' \\quad \\dots \\text{U C C A U A} \\quad \\dots \\quad 5'\n    $$\n    $+1$位置的关键$\\text{G}$与U1 snRNA中的胞嘧啶($\\text{C}$)形成一个典型的Watson-Crick碱基对。突变为腺嘌呤($\\text{A}$)将在$+1$位置造成一个A-C错配，这会严重破坏U1 snRNA:pre-mRNA双链的稳定性。这有效地废除了在典型供体位点处的有效U1 snRNP结合。\n\n2.  **评估备选（隐蔽）剪接位点**：随着典型位点被灭活，剪接机制将扫描局部序列以寻找可被U1 snRNP识别的备选位点。问题提出了两个这样的位点：\n    -   **$-8$位置的外显子隐蔽供体**：序列为$5'$-C A G|G U G A G U-$3'$。该位点在其潜在的$+1$和$+2$位置含有必需的$\\text{GU}$二核苷酸，使其可被U1 snRNP识别。关键是，它两侧有招募SR proteins的ESE。根据事实(ii)，SR proteins会*稳定*U1 snRNP的招募。因此，该位点不仅是一个潜在的底物，而且还受到主动促进。\n    -   **$+15$位置的内含子隐蔽供体**：序列为$5'$-C A G|G U U A C U-$3'$。该位点也含有必需的$\\text{GU}$二核苷酸。然而，它与一个由hnRNP A1结合的剪接沉默子基序重叠。根据事实(ii)，hnRNP A1会*拮抗*U1 snRNP的招募。因此，该位点受到主动抑制。\n\n3.  **最可能剪接位点的选择**：比较两个隐蔽位点，位于$-8$的外显子供体受到强烈青睐。它具有正确的核心序列，并且处于正向调控（增强子）的背景中。位于$+15$的内含子供体，尽管具有核心序列，但处于负向调控（沉默子）的背景中。因此，剪接机制最有可能选择位于$-8$的隐蔽供体。\n\n4.  **对mRNA和蛋白质的影响**：在$-8$隐蔽位点进行剪接意味着切割发生在原始外显子-内含子边界上游$8$个核苷酸处。这$8$个在野生型转录本中属于外显子$3$的核苷酸，现在被当作内含子的一部分而被移除。最终得到的成熟mRNA的外显子$3$在其$3'$末端将缩短$8$个核苷酸。\n    删除$8$个核苷酸不是$3$的倍数（$8 \\pmod 3 = 2$）。这将导致突变位点下游的mRNA翻译发生移码。移码几乎总是导致提前终止密码子 (PTC) 的产生。含有PTC的mRNA会被细胞的监视机制识别，并通过无义介导的衰变 (NMD) 途径被降解。\n\n### 选项评估\n\n**A. $+1$位置的$\\text{G}\\to\\text{A}$替换废除了在典型供体处的有效U1 snRNP配对，使初始识别转移到$-8$位置的外显子隐蔽供体 (C A G|G U G A G U)，该位点在$+1,+2$位置的$\\text{GU}$及其两侧与ESE结合的SR proteins有利于其被选择。mRNA将缺少外显子$3$的最后$8$个核苷酸，从而引发移码，并可能导致无义介导的衰变。**\n该陈述与我们的推导完全一致。它正确地指出了典型位点的失活，选择了被增强的外显子隐蔽位点而非被抑制的内含子位点，导致外显子$3$中$8$个核苷酸的缺失，以及移码和NMD的下游后果。\n**结论：正确。**\n\n**B. U1 snRNP可以通过在$+1$位置可容忍的摆动配对(A–U)来维持在典型供体处的结合，因此剪接过程基本正常进行，仅有轻微的效率损失；隐蔽供体不被激活，编码序列保持不变。**\n这是不正确的。在$+1$位置的配对是与U1 snRNA中的胞嘧啶，而不是尿嘧啶。所产生的A-C错配不是摆动配对，并且具有高度破坏性。问题明确指出“对$+1$位置的$\\text{G}$有近乎不变的要求”，这与A可以被容忍的观点相矛盾。剪接将受到严重损害，而不是正常进行。\n**结论：不正确。**\n\n**C. 该突变因其靠近$5'$帽的缘故，增加了U1 snRNP对$+15$位置内含子隐蔽供体的亲和力，从而促进了该内含子隐蔽供体的选择，并导致mRNA中部分内含子的保留。**\n这是不正确的。首先，在这种情况下，与$5'$帽的邻近性不是剪接位点选择的主要因素。其次，更重要的是，内含子隐蔽位点被抑制蛋白hnRNP A1结合，该蛋白会*拮抗*U1 snRNP的结合。因此，它被选择的可能性极小。\n**结论：不正确。**\n\n**D. 因为外显子定义需要一个完整的供体，所以剪接体完全绕过外显子$3$，导致外显子$3$跳跃成为主要结果，而不是激活任何附近的隐蔽供体，如果外显子$3$的长度能被$3$整除，则会导致框内外显子跳跃。**\n虽然外显子跳跃是剪接位点突变的一个可能结果，但当存在一个强大的、受正向调控的隐蔽剪接位点时（如此处的$-8$位点），它并不是*最可能*的结果。该问题的构建旨在突出隐蔽位点之间的竞争。一个两侧有ESE的隐蔽供体的存在使其被激活的可能性比完全的外显子跳跃更大。该选项声称隐蔽供体不被激活，这是一个与所提供信息相矛盾的强烈断言。\n**结论：不正确。**\n\n**E. U6 small nuclear RNA (snRNA) 在早期阶段补偿了受损的U1 snRNP识别，恢复了对典型供体的正常使用；剪接和编码序列保持不变。**\n这错误地描述了剪接体组装的时间顺序。U1 snRNP执行对$5'$剪接位点的初始识别。U6 snRNA是催化核心的一个组成部分，在U1结合并随后被置换之后，在过程的后期才起作用。U6无法“补偿”初始U1结合步骤的失败。如果U1不结合，该位点的剪接途径在U6参与之前就已经中止。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2946319"}, {"introduction": "在现代分子生物学研究中，对基因结构和剪接的理解常常需要分析海量的测序数据。最后的这个练习将理论与实践相结合，要求你设计一个计算流程，从模拟的RNA测序数据中量化可变剪接。你将实现一个算法，用于识别剪接点并计算“剪接包含百分比”（Percent Spliced In, $\\Psi$），这是转录组学中的一个核心指标。通过这个练习，你将获得宝贵的生物信息学实践经验，这对于前沿的基因组学研究至关重要。[@problem_id:2946390]", "problem": "您的任务是设计并实现一个有原则的、自成体系的计算流程。该流程接收来自RNA测序（RNA-seq）的抽象比对结果，利用跨读（split reads）检测外显子-外显子连接点，并针对单个可变盒式外显子事件，量化剪接百分比（用希腊字母 $\\Psi$ 表示）。您的设计必须基于基本的生物学定义和观察，并实现为一个完整的、可运行的程序。\n\n请从以下分子和细胞生物学的基础知识开始：\n\n- 由脱氧核糖核酸（DNA）产生的前体信使核糖核酸（pre-messenger RNA）包含外显子（在成熟信使RNA中保留）和内含子（通过剪接被移除）。\n- 盒式外显子是一种在成熟信使RNA中可能被包含或跳过的外显子。对于一个包含上游外显子 $\\mathrm{E1}$、可变盒式外显子 $\\mathrm{E2}$ 和下游外显子 $\\mathrm{E3}$ 的三外显子结构，包含事件会产生连接 $\\mathrm{E1}\\to\\mathrm{E2}$ 和 $\\mathrm{E2}\\to\\mathrm{E3}$，而排除事件（跳过 $\\mathrm{E2}$）则会产生连接 $\\mathrm{E1}\\to\\mathrm{E3}$。\n- 在RNA测序（RNA-seq）中，跨读（具有两个或多个不连续比对块的读段）可以识别外显子-外显子连接点，从而为特定的剪接选择提供证据。\n\n您的程序必须实现以下抽象表示和规则：\n\n- 坐标是基于零的、半开的基因组区间：一个外显子 $\\mathrm{E}$ 表示为 $[s, e)$，其中 $e > s$。一个读段比对是一个有序列表，包含一个或多个基因组块 $(s_i, e_i)$，每个块都满足 $e_i > s_i$，代表连续的外显子比对。一个跨读至少有两个块。\n- 一个由读段支持的连接点是由两个连续的外显子块 $(s_i, e_i)$ 和 $(s_{i+1}, e_{i+1})$ 形成的的有序对 $(e_i, s_{i+1})$。如果 $e_i$ 等于外显子 $\\mathrm{E}A$ 的末端，且 $s_{i+1}$ 等于外显子 $\\mathrm{E}B$ 的起始，并且两个块都完全位于相应的外显子区间内，那么这个连接点就匹配 $\\mathrm{E}A\\to\\mathrm{E}B$。\n- 为减少伪信号，需强制执行最小锚定长度 $k$：一个读段只有在连接点两侧的两个侧翼块的长度都至少为 $k$ 个核苷酸时，才支持该连接点。形式上，对于块 $(s_i, e_i)$ 和 $(s_{i+1}, e_{i+1})$，必须同时满足 $(e_i - s_i) \\ge k$ 和 $(e_{i+1} - s_{i+1}) \\ge k$。\n\n您的任务是：\n\n1. 在应用锚定长度过滤器 $k$ 后，检测并计数支持盒式外显子事件中三个目标连接点（$\\mathrm{E1}\\to\\mathrm{E2}$、$\\mathrm{E2}\\to\\mathrm{E3}$ 和 $\\mathrm{E1}\\to\\mathrm{E3}$）的跨读数量。\n2. 仅使用这些计数和连接读段计数与异构体丰度的第一性原理，推导出一个稳健的剪接百分比 $\\Psi \\in [0,1]$ 估计量。该估计量能够平衡两个支持包含事件的连接点，并将其与跳过事件的连接点进行适当对比。在没有任何连接点证据的情况下（即估计量的分母为 $0$），将 $\\Psi$ 定义为 $0$。\n3. 实现该算法，并将其应用于下面的测试套件。\n4. 将结果输出为单行，包含一个由方括号括起来的逗号分隔列表，其中每个数值都四舍五入到 $6$ 位小数。将 $\\Psi$ 表示为小数（而非百分比）。\n\n所有测试用例的定义：\n\n- 每个测试用例是一个三元组，包含外显子、读段和锚定长度 $k$。\n- 外显子以映射形式提供 $\\{\\mathrm{E1}:[s_1,e_1), \\mathrm{E2}:[s_2,e_2), \\mathrm{E3}:[s_3,e_3)\\}$。\n- 读段是一个比对列表，其中每个比对是块的列表 $[(s_1,e_1), (s_2,e_2), \\dots]$。\n\n要实现和评估的测试套件：\n\n- 测试用例1（正常路径，混合包含与跳过；锚定阈值 $k = 8$）：\n  - 外显子：$\\mathrm{E1}:[100,200)$, $\\mathrm{E2}:[300,360)$, $\\mathrm{E3}:[500,580)$.\n  - 读段：\n    - 包含事件 $\\mathrm{E1}\\to\\mathrm{E2}$ 候选读段：\n      - $[(180,200),(300,330)]$\n      - $[(150,200),(300,320)]$\n      - $[(190,200),(300,308)]$\n      - $[(170,200),(300,312)]$\n      - $[(193,200),(300,305)]$ （左侧锚定长度不足，不应计数）\n    - 包含事件 $\\mathrm{E2}\\to\\mathrm{E3}$ 候选读段：\n      - $[(340,360),(500,540)]$\n      - $[(300,360),(500,508)]$\n      - $[(350,360),(500,507)]$ （右侧锚定长度不足，不应计数）\n    - 排除（跳过）事件 $\\mathrm{E1}\\to\\mathrm{E3}$ 候选读段：\n      - $[(190,200),(500,530)]$\n      - $[(180,200),(500,510)]$\n    - 跨越两个包含连接点的长读段：\n      - $[(150,200),(300,360),(500,540)]$\n- 测试用例2（边界情况：仅有跳过证据；锚定阈值 $k = 8$）：\n  - 外显子：$\\mathrm{E1}:[100,200)$, $\\mathrm{E2}:[300,360)$, $\\mathrm{E3}:[500,580)$.\n  - 读段：\n    - 跳过事件：\n      - $[(190,200),(500,535)]$\n      - $[(150,200),(500,520)]$\n      - $[(199,200),(500,508)]$ （左侧锚定长度不足，不应计数）\n- 测试用例3（边界情况：仅有包含证据；锚定阈值 $k = 10$）：\n  - 外显子：$\\mathrm{E1}:[1000,1100)$, $\\mathrm{E2}:[1200,1280)$, $\\mathrm{E3}:[1400,1500)$.\n  - 读段：\n    - $\\mathrm{E1}\\to\\mathrm{E2}$：\n      - $[(1080,1100),(1200,1230)]$\n      - $[(1050,1100),(1200,1215)]$\n    - $\\mathrm{E2}\\to\\mathrm{E3}$：\n      - $[(1260,1280),(1400,1450)]$\n      - $[(1200,1280),(1400,1415)]$\n      - $[(1220,1280),(1400,1415)]$\n      - $[(1240,1280),(1400,1430)]$\n    - 跨越两者的长读段：\n      - $[(1040,1100),(1200,1280),(1400,1450)]$\n- 测试用例4（不平衡的包含连接点与竞争性跳过；锚定阈值 $k = 12$）：\n  - 外显子：$\\mathrm{E1}:[200,280)$, $\\mathrm{E2}:[400,460)$, $\\mathrm{E3}:[600,690)$.\n  - 读段：\n    - $\\mathrm{E1}\\to\\mathrm{E2}$：\n      - $[(260,280),(400,430)]$\n      - $[(240,280),(400,412)]$\n      - $[(268,280),(400,420)]$\n      - $[(230,280),(400,413)]$\n    - $\\mathrm{E2}\\to\\mathrm{E3}$：\n      - $[(448,460),(600,609)]$ （右侧锚定长度不足，不应计数）\n    - $\\mathrm{E1}\\to\\mathrm{E3}$：\n      - $[(260,280),(600,640)]$\n      - $[(268,280),(600,612)]$\n      - $[(250,280),(600,615)]$\n- 测试用例5（边缘情况：完全没有连接点证据；锚定阈值 $k = 8$）：\n  - 外显子：$\\mathrm{E1}:[100,150)$, $\\mathrm{E2}:[200,240)$, $\\mathrm{E3}:[300,350)$.\n  - 读段（均为单块，非跨读）：\n    - $[(120,140)]$\n    - $[(205,220)]$\n    - $[(320,340)]$\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个 Python 风格的 $\\Psi$ 值列表，按顺序排列，每个值四舍五入到6位小数，无空格，例如：$[0.123456,0.000000,1.000000]$。", "solution": "所述问题在科学上是合理的、定义明确的且客观的。它为计算转录组学中的一个典型问题——从RNA测序数据中量化可变剪接——提供了一个形式化但简化的模型。所有必要的定义、数据和约束都已提供，从而可以推导和实现一个唯一的、可验证的解决方案。因此，我们将着手解决。\n\n任务是计算盒式外显子事件的剪接百分比（Percent Spliced In），记为 $\\Psi$。这需要量化两种成熟mRNA异构体的相对丰度：一种包含盒式外显子（$\\mathrm{E2}$），另一种则跳过它。RNA测序以读段的形式提供数据，特别是跨读，为定义这些异构体的外显子-外显子连接点提供了直接证据。\n\n设三个外显子分别为上游外显子 $\\mathrm{E1} = [s_1, e_1)$、盒式外显子 $\\mathrm{E2} = [s_2, e_2)$ 和下游外显子 $\\mathrm{E3} = [s_3, e_3)$。\n我们关注三个外显子-外显子连接点：\n$1$. $\\mathrm{E1}$ 和 $\\mathrm{E2}$ 之间的包含连接点，由基因组坐标 $(e_1, s_2)$ 定义。\n$2$. $\\mathrm{E2}$ 和 $\\mathrm{E3}$ 之间的包含连接点，由基因组坐标 $(e_2, s_3)$ 定义。\n$3$. $\\mathrm{E1}$ 和 $\\mathrm{E3}$ 之间的排除（或跳过）连接点，由基因组坐标 $(e_1, s_3)$ 定义。\n\n设 $N_{12}$、$N_{23}$ 和 $N_{13}$ 分别是支持这三个连接点的经过筛选的跨读数量。一个读段支持一个连接点需满足两个标准：（$i$）其连接点两侧的块完全包含在相应的外显子内，以及（$ii$）这两个侧翼块中每个块的长度都至少为最小锚定长度 $k$。\n\n包含异构体的丰度由跨越 $\\mathrm{E1}\\to\\mathrm{E2}$ 连接点或 $\\mathrm{E2}\\to\\mathrm{E3}$ 连接点的读段来证明。为了考虑RNA片段化和测序覆盖度的潜在偏差，平衡来自两个包含连接点的证据是标准做法。一个简单有效的方法是使用这两个计数的算术平均值。因此，包含异构体的有效计数为：\n$$I = \\frac{N_{12} + N_{23}}{2}$$\n跳过异构体的计数，记为 $S$，直接由跳过连接点的计数给出：\n$$S = N_{13}$$\n剪接百分比 $\\Psi$ 是包含异构体的丰度与两种异构体总丰度之比。使用我们基于计数的代理指标：\n$$\\Psi = \\frac{I}{I + S} = \\frac{\\frac{N_{12} + N_{23}}{2}}{\\frac{N_{12} + N_{23}}{2} + N_{13}}$$\n简化后得到：\n$$\\Psi = \\frac{N_{12} + N_{23}}{N_{12} + N_{23} + 2 \\cdot N_{13}}$$\n在分母为零的特殊情况下（即 $N_{12} = 0$、$N_{23} = 0$ 和 $N_{13} = 0$），表示在该位点没有任何剪接证据。根据问题规范，在这种情况下 $\\Psi$ 定义为 $0$。我们的公式能正确处理这种情况，因为分母为 $0$ 意味着分子也为 $0$，我们明确地将这种不定形式的结果定义为 $0$。\n\n对于一个给定的测试用例（包括外显子定义、读段列表和锚定长度 $k$），计算 $\\Psi$ 的算法如下：\n步骤1：初始化三个计数器为零：$N_{12} = 0$，$N_{23} = 0$，$N_{13} = 0$。\n步骤2：提取三个外显子的基因组坐标：$s_1, e_1, s_2, e_2, s_3, e_3$。\n步骤3：定义三个目标连接点的坐标：$J_{12} = (e_1, s_2)$，$J_{23} = (e_2, s_3)$ 和 $J_{13} = (e_1, s_3)$。\n步骤4：对于输入列表中的每个读段：\n    a. 一个读段是一个包含一个或多个比对块的列表，$[(b_1^s, b_1^e), (b_2^s, b_2^e), \\dots]$。如果读段的块数少于两个，它就不是跨读，应被忽略。\n    b. 遍历读段中所有相邻的块对。对于每对块 $(b_i^s, b_i^e)$ 和 $(b_{i+1}^s, b_{i+1}^e)$，形成一个观察到的连接点 $J_{obs} = (b_i^e, b_{i+1}^s)$。\n    c. 应用锚定长度过滤器：检查是否 $(b_i^e - b_i^s) \\ge k$ 且 $(b_{i+1}^e - b_{i+1}^s) \\ge k$。如果不满足，则丢弃此连接点。\n    d. 如果通过锚定过滤器，检查 $J_{obs}$ 是否与目标连接点之一匹配，且对应的块是否包含在正确的外显子内：\n        i. 如果 $J_{obs} = J_{12}$，并且块 $i$ 在 $\\mathrm{E1}$ 内（即 $b_i^s \\ge s_1$ 且 $b_i^e \\le e_1$），且块 $i+1$ 在 $\\mathrm{E2}$ 内（即 $b_{i+1}^s \\ge s_2$ 且 $b_{i+1}^e \\le e_2$），则 $N_{12}$ 加一。\n        ii. 如果 $J_{obs} = J_{23}$，并且块 $i$ 在 $\\mathrm{E2}$ 内（即 $b_i^s \\ge s_2$ 且 $b_i^e \\le e_2$），且块 $i+1$ 在 $\\mathrm{E3}$ 内（即 $b_{i+1}^s \\ge s_3$ 且 $b_{i+1}^e \\le e_3$），则 $N_{23}$ 加一。\n        iii. 如果 $J_{obs} = J_{13}$，并且块 $i$ 在 $\\mathrm{E1}$ 内（即 $b_i^s \\ge s_1$ 且 $b_i^e \\le e_1$），且块 $i+1$ 在 $\\mathrm{E3}$ 内（即 $b_{i+1}^s \\ge s_3$ 且 $b_{i+1}^e \\le e_3$），则 $N_{13}$ 加一。\n步骤5：处理完所有读段后，计算总分母 $D = N_{12} + N_{23} + 2 \\cdot N_{13}$。\n步骤6：如果 $D = 0$，则设 $\\Psi = 0$。否则，计算 $\\Psi = (N_{12} + N_{23}) / D$。\n步骤7：得到的 $\\Psi$ 值即为该测试用例的解。\n\n此流程构成了针对指定任务的完整而稳健的流程。实现过程将系统地将此逻辑应用于所提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and calculate Psi values.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        ({\n            \"exons\": {\"E1\": [100, 200], \"E2\": [300, 360], \"E3\": [500, 580]},\n            \"reads\": [\n                [(180, 200), (300, 330)],\n                [(150, 200), (300, 320)],\n                [(190, 200), (300, 308)],\n                [(170, 200), (300, 312)],\n                [(193, 200), (300, 305)],\n                [(340, 360), (500, 540)],\n                [(300, 360), (500, 508)],\n                [(350, 360), (500, 507)],\n                [(190, 200), (500, 530)],\n                [(180, 200), (500, 510)],\n                [(150, 200), (300, 360), (500, 540)],\n            ],\n            \"k\": 8\n        }),\n        # Test case 2\n        ({\n            \"exons\": {\"E1\": [100, 200], \"E2\": [300, 360], \"E3\": [500, 580]},\n            \"reads\": [\n                [(190, 200), (500, 535)],\n                [(150, 200), (500, 520)],\n                [(199, 200), (500, 508)],\n            ],\n            \"k\": 8\n        }),\n        # Test case 3\n        ({\n            \"exons\": {\"E1\": [1000, 1100], \"E2\": [1200, 1280], \"E3\": [1400, 1500]},\n            \"reads\": [\n                [(1080, 1100), (1200, 1230)],\n                [(1050, 1100), (1200, 1215)],\n                [(1260, 1280), (1400, 1450)],\n                [(1200, 1280), (1400, 1415)],\n                [(1220, 1280), (1400, 1415)],\n                [(1240, 1280), (1400, 1430)],\n                [(1040, 1100), (1200, 1280), (1400, 1450)],\n            ],\n            \"k\": 10\n        }),\n        # Test case 4\n        ({\n            \"exons\": {\"E1\": [200, 280], \"E2\": [400, 460], \"E3\": [600, 690]},\n            \"reads\": [\n                [(260, 280), (400, 430)],\n                [(240, 280), (400, 412)],\n                [(268, 280), (400, 420)],\n                [(230, 280), (400, 413)],\n                [(448, 460), (600, 609)],\n                [(260, 280), (600, 640)],\n                [(268, 280), (600, 612)],\n                [(250, 280), (600, 615)],\n            ],\n            \"k\": 12\n        }),\n        # Test case 5\n        ({\n            \"exons\": {\"E1\": [100, 150], \"E2\": [200, 240], \"E3\": [300, 350]},\n            \"reads\": [\n                [(120, 140)],\n                [(205, 220)],\n                [(320, 340)],\n            ],\n            \"k\": 8\n        })\n    ]\n\n    results = []\n    \n    def calculate_psi_for_case(case):\n        exons = case[\"exons\"]\n        reads = case[\"reads\"]\n        k = case[\"k\"]\n\n        e1_s, e1_e = exons[\"E1\"]\n        e2_s, e2_e = exons[\"E2\"]\n        e3_s, e3_e = exons[\"E3\"]\n        \n        j12 = (e1_e, e2_s)\n        j23 = (e2_e, e3_s)\n        j13 = (e1_e, e3_s)\n\n        n12, n23, n13 = 0, 0, 0\n        \n        for read_blocks in reads:\n            if len(read_blocks)  2:\n                continue\n\n            for i in range(len(read_blocks) - 1):\n                block1_s, block1_e = read_blocks[i]\n                block2_s, block2_e = read_blocks[i+1]\n                \n                if (block1_e - block1_s)  k or (block2_e - block2_s)  k:\n                    continue\n                    \n                observed_junction = (block1_e, block2_s)\n                \n                if observed_junction == j12:\n                    if (block1_s >= e1_s and block1_e = e1_e) and \\\n                       (block2_s >= e2_s and block2_e = e2_e):\n                        n12 += 1\n                        \n                elif observed_junction == j23:\n                    if (block1_s >= e2_s and block1_e = e2_e) and \\\n                       (block2_s >= e3_s and block2_e = e3_e):\n                        n23 += 1\n                \n                elif observed_junction == j13:\n                    if (block1_s >= e1_s and block1_e = e1_e) and \\\n                       (block2_s >= e3_s and block2_e = e3_e):\n                        n13 += 1\n\n        numerator = n12 + n23\n        denominator = n12 + n23 + 2 * n13\n        \n        if denominator == 0:\n            psi = 0.0\n        else:\n            psi = numerator / denominator\n            \n        return psi\n\n    for case in test_cases:\n        psi_value = calculate_psi_for_case(case)\n        results.append(f\"{psi_value:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2946390"}]}