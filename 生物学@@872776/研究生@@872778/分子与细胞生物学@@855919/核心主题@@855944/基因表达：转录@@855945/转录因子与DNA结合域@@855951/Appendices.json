{"hands_on_practices": [{"introduction": "位置权重矩阵（PWM）是描述转录因子结合位点的核心工具。本练习 [@problem_id:2966795] 旨在通过统计热力学的基本原理，建立 PWM 对数几率分数 $S$ 与 DNA 结合自由能变化 $\\Delta E$ 之间的直接线性关系。完成这一推导将帮助你从第一性原理的层面深刻理解为何 PWM 分数能够作为结合亲和力的有效度量，从而超越简单将其视为一种计算工具的层面。", "problem": "一个转录因子通过一个加性结合能模型来识别DNA，其中一个长度为 $L$、序列为 $s = (s_{1},\\dots,s_{L})$ 的位点的结合能为 $E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$，其中 $\\varepsilon_{i}(b)$ 是位置 $i$ 处碱基 $b$ 的贡献，$E_{0}$ 是一个与序列无关的偏移量。在绝对温度为 $T$ 的热力学平衡状态下，在结合系综中观察到序列 $s$ 的概率，相对于其背景出现概率 $q(s)$，与其能量的玻尔兹曼因子成正比，这与经过充分检验的大分子结合统计热力学模型一致：$P(\\text{bound}\\,|\\,s) \\propto \\exp(-\\beta E(s))$，其中 $\\beta = 1/(k_{B} T)$，$k_{B}$ 是玻尔兹曼常数。假设一个背景模型，其中碱基在不同位置上是独立的，其边际概率为 $q(b)$，并且由于 $E(s)$ 的加性，结合系综在不同位置上也可以因子分解。\n\n定义序列 $s$ 的位置权重矩阵（PWM）对数优势分（以 $b$ 为底）为\n$$\nS(s) \\equiv \\sum_{i=1}^{L} \\log_{b}\\!\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right),\n$$\n其中 $p_{i}(x)$ 是结合系综中位置 $i$ 处碱基 $x$ 的边际频率，$q(x)$ 是背景碱基频率。仅使用上述统计热力学假设以及 $S(s)$ 和 $E(s)$ 的定义，推导结合能差 $\\Delta E(s) \\equiv E(s) - E_{\\star}$ 与 PWM 分数 $S(s)$ 之间的线性关系，并以 $k_{B}$、$T$ 和 PWM 对数的底 $b$ 来表示 $\\Delta E(s) = -\\alpha\\, S(s) + \\text{const}$ 形式中的系数 $\\alpha$。\n\n然后，简要概述一种有原则的实验或计算策略，用于从包含不同序列的平衡占有率 $P(\\text{bound}\\,|\\,s)$ 或独立测量的结合自由能 $\\Delta E(s)$ 的数据中拟合 $\\alpha$。\n\n请以 $k_{B}$、$T$ 和 $b$ 表示 $\\alpha$ 的单个闭式解析表达式作为最终答案。用焦耳表示 $\\alpha$ 的单位，但不要代入数值。", "solution": "该问题要求推导转录因子与 DNA 序列的结合能和该序列相应的位置权重矩阵（PWM）分数之间的线性关系。我们首先验证问题陈述的有效性。\n\n已知条件如下：\n1.  加性结合能模型：对于序列 $s = (s_{1},\\dots,s_{L})$，$E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$。\n2.  在结合系综中观察到序列 $s$ 的概率，相对于其背景出现概率 $q(s)$，与其玻尔兹曼因子成正比：$P(\\text{bound}\\,|\\,s) \\propto \\exp(-\\beta E(s))$，其中 $\\beta = 1/(k_{B} T)$。\n3.  序列的背景概率分布可以因子分解：$q(s) = \\prod_{i=1}^{L} q(s_{i})$，其中 $q(s_i)$ 是碱基 $s_i$ 的边际频率。问题文本中的“边际概率 $q(b)$”意味着 $q(s_i)$ 与位置 $i$ 无关，我们将其写作当 $s_i=b$ 时为 $q(s_i)=q(b)$。为了确保正确性，我们将保留更通用的表示法 $q(s_i)$，因为它不会改变推导过程。\n4.  结合系综中序列的概率分布也可以因子分解：$p(s) = \\prod_{i=1}^{L} p_{i}(s_{i})$。\n5.  PWM 对数优势分定义为 $S(s) \\equiv \\sum_{i=1}^{L} \\log_{b}\\!\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)$。\n6.  目标是求出推导出的关系式 $\\Delta E(s) = -\\alpha\\, S(s) + \\text{const}$ 中的系数 $\\alpha$，其中 $\\Delta E(s) \\equiv E(s) - E_{\\star}$。\n\n该问题在科学上基于应用于分子结合的统计力学原理，这是生物物理学中一个标准且经过充分验证的方法。问题是适定的，为获得唯一解提供了充分且一致的信息。语言客观而精确。因此，该问题被认为是有效的。\n\n我们开始推导。根据统计热力学原理，在结合系综中找到序列 $s$ 的概率 $p(s)$ 与其背景概率 $q(s)$ 和结合能 $E(s)$ 相关。结合群体中某个序列相对于背景的富集程度由其玻尔兹曼权重给出。这可以正式地表述为：\n$$\n\\frac{p(s)}{q(s)} = \\frac{\\exp(-\\beta E(s))}{Z}\n$$\n其中 $Z = \\sum_{s'} \\exp(-\\beta E(s')) q(s')$ 是对所有可能序列的配分函数，它作为一个归一化常数。对于一个给定的平衡系统，$Z$ 是一个常数。\n\n现在，我们根据问题陈述中提供的加性和因子分解假设，代入 $p(s)$、$q(s)$ 和 $E(s)$ 的表达式。\n$$\n\\frac{\\prod_{i=1}^{L} p_{i}(s_{i})}{\\prod_{i=1}^{L} q(s_{i})} = \\frac{1}{Z} \\exp\\left(-\\beta \\left(\\sum_{j=1}^{L} \\varepsilon_{j}(s_{j}) + E_{0}\\right)\\right)\n$$\n这可以通过分离乘积和求和来重写：\n$$\n\\prod_{i=1}^{L} \\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right) = \\frac{\\exp(-\\beta E_{0})}{Z} \\prod_{i=1}^{L} \\exp(-\\beta \\varepsilon_{i}(s_{i}))\n$$\n该方程对于任何序列 $s$ 都必须成立。方程的结构，即两边都是对位置 $i=1, \\dots, L$ 的乘积，意味着该关系必须在每个位置的基础上都成立。也就是说，对于每个位置 $i$ 和任何碱基 $b \\in \\{A, C, G, T\\}$，必须存在特定于位置的常数 $C_i$，使得：\n$$\n\\frac{p_{i}(b)}{q(b)} = C_{i} \\exp(-\\beta \\varepsilon_{i}(b))\n$$\n这些常数的乘积必须满足 $\\prod_{i=1}^{L} C_{i} = \\exp(-\\beta E_0)/Z$。对每个位置上的关系式取自然对数，得到：\n$$\n\\ln\\left(\\frac{p_{i}(b)}{q(b)}\\right) = \\ln(C_{i}) - \\beta \\varepsilon_{i}(b)\n$$\n现在，我们将其与 PWM 分数 $S(s)$ 联系起来。定义是以 $b$ 为底的通用对数给出的。我们使用换底公式 $\\log_{b}(x) = \\frac{\\ln(x)}{\\ln(b)}$，用自然对数来表示 $S(s)$：\n$$\nS(s) = \\sum_{i=1}^{L} \\frac{\\ln\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)}{\\ln(b)} = \\frac{1}{\\ln(b)} \\sum_{i=1}^{L} \\ln\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)\n$$\n代入我们推导出的对数比率表达式：\n$$\nS(s) = \\frac{1}{\\ln(b)} \\sum_{i=1}^{L} (\\ln(C_{i}) - \\beta \\varepsilon_{i}(s_{i}))\n$$\n$$\nS(s) = \\frac{1}{\\ln(b)} \\left( \\left(\\sum_{i=1}^{L} \\ln(C_{i})\\right) - \\beta \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) \\right)\n$$\n总结合能为 $E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$，这意味着 $\\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) = E(s) - E_{0}$。将此代入 $S(s)$ 的方程中：\n$$\nS(s) = \\frac{1}{\\ln(b)} \\left( \\left(\\sum_{i=1}^{L} \\ln(C_{i})\\right) - \\beta (E(s) - E_{0}) \\right)\n$$\n$$\nS(s) = -\\frac{\\beta}{\\ln(b)} E(s) + \\frac{1}{\\ln(b)} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n这是一个关联 $S(s)$ 和 $E(s)$ 的线性方程。我们被要求找出 $\\Delta E(s)$ 的关系式，形式为 $\\Delta E(s) = -\\alpha S(s) + \\text{const}$。首先，我们解出 $E(s)$：\n$$\n\\frac{\\beta}{\\ln(b)} E(s) = -S(s) + \\frac{1}{\\ln(b)} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n$$\nE(s) = -\\frac{\\ln(b)}{\\beta} S(s) + \\frac{1}{\\beta} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n代入 $\\beta = 1/(k_{B}T)$：\n$$\nE(s) = - (k_{B} T \\ln(b)) S(s) + \\left( E_{0} + k_{B} T \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n最后一个括号中的项是一个不依赖于序列 $s$ 的常数。我们称之为 $K$。\n$$\nE(s) = - (k_{B} T \\ln(b)) S(s) + K\n$$\n结合能差定义为 $\\Delta E(s) = E(s) - E_{\\star}$，其中 $E_{\\star}$ 是一个恒定的参考能量。\n$$\n\\Delta E(s) = \\left(- (k_{B} T \\ln(b)) S(s) + K\\right) - E_{\\star}\n$$\n$$\n\\Delta E(s) = - (k_{B} T \\ln(b)) S(s) + (K - E_{\\star})\n$$\n该式的形式为 $\\Delta E(s) = -\\alpha S(s) + \\text{const}$，其中常数是 $(K - E_{\\star})$。系数 $\\alpha$ 是：\n$$\n\\alpha = k_{B} T \\ln(b)\n$$\n这个系数的单位是焦耳，因为 $k_{B}$ 的单位是焦耳/开尔文，$T$ 的单位是开尔文，而 $\\ln(b)$ 是无量纲的。\n\n对于问题的第二部分，需要一种从数据中拟合 $\\alpha$ 的策略。推导出的关系式 $\\Delta E(s) = -\\alpha S(s) + \\text{const}$ 是一个线性方程。因此，$\\alpha$ 可以通过 $\\Delta E(s)$ 对 $S(s)$ 作图的斜率的负值来确定。一种有原则的策略如下：\n1.  **数据采集**：执行一种基于高通量测序的结合分析，例如 SELEX-seq 或 ChIP-seq。该实验为大量 DNA 序列 $\\{s_j\\}$ 产生两个基本数据集：(a) 被转录因子特异性结合的 DNA 片段的序列，以及 (b) 每个序列结合亲和力的定量测量值（例如，富集比，其可转换为相对结合能 $\\Delta E(s_j)$）。\n2.  **参数估计**：\n    a.  从结合序列集合中，通过对序列进行比对并统计每个位置 $i$ 处各个碱基的频率，构建位置频率矩阵 $p_{i}(b)$。背景频率 $q(b)$ 从初始序列库或相关的基因组背景中估计。\n    b.  对于每个有结合测量值的序列 $s_j$，使用估计出的矩阵计算其 PWM 分数：$S(s_j) = \\sum_{i=1}^{L} \\log_{b}(p_{i}(s_{j,i})/q(s_{j,i}))$。\n    c.  对于每个序列 $s_j$，将其测得的定量结合亲和力转换为相对结合自由能，作为 $\\Delta E(s_j)$。例如，如果使用平衡占有率，可以从根据朗缪尔等温线计算出的解离常数推导出相对能量。\n3.  **线性回归**：将计算出的 $\\Delta E(s_j)$ 值对其相应的 $S(s_j)$ 分数作图。对这些数据点进行线性回归。最佳拟合线的斜率将是 $-\\alpha$ 的实验估计值。因此，$\\alpha$ 的值通过取拟合斜率的负值来确定。\n\n该步骤为 $\\alpha$ 提供了一个经验值，可以将其与理论值 $k_B T \\ln(b)$ 进行比较，以验证其底层的热力学模型。", "answer": "$$\n\\boxed{k_{B} T \\ln(b)}\n$$", "id": "2966795"}, {"introduction": "基因调控的复杂性常常源于多个转录因子在邻近位点上的协同结合，这种现象无法用简单的独立结合模型来描述。本练习 [@problem_id:2966850] 将运用统计力学中的巨正则系综方法，来精确地模拟这种协同结合过程。通过构建和求解配分函数，你将学会如何定量描述蛋白质间的相互作用对 DNA 占据率的协同效应，为预测复杂顺式调控模块的行为奠定理论基础。", "problem": "一个真核基因组中的增强子包含 $2$ 个相同的 E-box 基序，这些基序可被一个转录因子 (TF; transcription factor) 通过其碱性螺旋-环-螺旋 DNA 结合域识别。每个 E-box 最多可以结合一个 TF 分子。单个 TF 与一个 E-box 的结合能为 $\\epsilon_{b}$（其中 $\\epsilon_{b}  0$ 表示有利的结合）。当两个 E-box 同时被占据时，结合的 TF 分子之间存在一个额外的成对相互作用能 $\\epsilon_{\\text{int}}$（其中 $\\epsilon_{\\text{int}}  0$ 表示正协同性）。系统在温度 $T$ 下处于热平衡状态，并且 TF 以摩尔浓度 $c$ 存在于溶液中。假设为理想稀溶液，因此化学势为 $\\mu = \\mu^{0} + k_{B} T \\ln\\!\\left(\\frac{c}{c_{0}}\\right)$，其中 $c_{0}$ 是标准参考浓度，$k_{B}$ 是玻尔兹曼常数，并定义 $\\beta \\equiv \\frac{1}{k_{B} T}$。\n\n使用巨正则系综中的配分函数方法，计算该增强子的分数占据率，其定义为至少一个 E-box 被占据的概率。将您的最终结果表示为包含 $c$、$c_{0}$、$\\beta$、$\\epsilon_{b}$ 和 $\\epsilon_{\\text{int}}$ 的封闭形式符号表达式。不要引入任何额外的参数。最终答案必须是无单位的单个解析表达式。", "solution": "在尝试解答之前，对问题进行验证。\n\n第 1 步：提取已知条件\n- 系统：一个真核基因组中的增强子。\n- 结合位点：$2$ 个相同的 E-box 基序。\n- 配体：一个转录因子 (TF)。\n- 结合域：碱性螺旋-环-螺旋。\n- 化学计量：每个 E-box 最多可以结合一个 TF 分子。\n- 结合能：单个 TF 结合的能量为 $\\epsilon_{b}$，其中 $\\epsilon_{b}  0$。\n- 相互作用能：两个同时结合的 TF 之间成对相互作用的能量为 $\\epsilon_{\\text{int}}$，其中 $\\epsilon_{\\text{int}}  0$。\n- 热力学条件：温度 $T$ 下的热平衡。\n- TF 浓度：摩尔浓度 $c$。\n- 溶液性质：假设为理想稀溶液。\n- TF 的化学势：$\\mu = \\mu^{0} + k_{B} T \\ln\\!\\left(\\frac{c}{c_{0}}\\right)$。\n- 常数和定义：$c_{0}$ 是标准参考浓度，$k_{B}$ 是玻尔兹曼常数，且 $\\beta \\equiv \\frac{1}{k_{B} T}$。\n- 目标：计算增强子的分数占据率，定义为至少一个 E-box 被占据的概率。\n- 方法：使用巨正则系综中的配分函数方法。\n- 输出格式：一个包含 $c$、$c_{0}$、$\\beta$、$\\epsilon_{b}$ 和 $\\epsilon_{\\text{int}}$ 的封闭形式符号表达式。\n\n第 2 步：使用提取的已知条件进行验证\n该问题描述了一个经典的协同配体与具有两个相同位点的大分子结合的模型，这是统计生物物理学中的一个标准问题。\n\n- **科学依据**：该模型在科学上是合理的，它基于统计力学（巨正则系综）的基本原理及其在分子结合事件中的应用。结合能、协同性、化学势和配分函数的概念是该领域的核心。\n- **适定性**：该问题是适定的。它提供了计算一个唯一、有意义的物理量（分数占据率）所需的所有必要信息和明确定义。目标是明确的。\n- **客观性**：问题以精确、客观的语言陈述。\n- **歧义分析**：“结合能” $\\epsilon_{b}$ 的定义存在潜在的歧义。在统计力学中，结合态的能量 $\\epsilon_{b}$ 必须相对于粒子池中粒子的化学势 $\\mu$ 来考虑。化学势表达式本身包含一个参考势 $\\mu^0$。严谨的解决方案需要澄清 $\\epsilon_b$ 的参考态。在此背景下，标准且唯一合理的解释是，$\\epsilon_{b}$ 代表标准条件下的结合自由能，即当一个 TF 从标准浓度 $c_0$（此时其化学势为 $\\mu^0$）的溶液中移动到 DNA 上的一个结合位点时的能量变化。因此，$\\epsilon_b \\equiv E_{\\text{bound}} - \\mu^0$。根据这个标准约定，问题是自洽且可解的，因为未指定的 $\\mu^0$ 项被吸收到 $\\epsilon_b$ 的定义中。\n\n第 3 步：结论与行动\n在对此背景下结合能的标准解释下，该问题被认为是**有效的**。现在将提供完整的解决方案。\n\n该系统是具有两个结合位点的增强子，它与一个在固定温度 $T$ 和化学势 $\\mu$ 下的 TF 分子库接触。我们使用巨正则系综来描述这个系统。系统的状态由结合到增强子上的 TF 分子数量定义。令 $\\sigma_i = 1$ 表示位点 $i$ 被占据，$\\sigma_i = 0$ 表示位点 $i$ 为空，其中 $i \\in \\{1, 2\\}$。\n\n该系统有四种可能的微观状态：\n1.  **状态 (0,0)**：两个位点都为空。结合的 TF 数量为 $N=0$。此状态的能量被视为参考能量，$E_{0,0} = 0$。\n2.  **状态 (1,0) 和 (0,1)**：一个位点被占据。结合的 TF 数量为 $N=1$。由于位点是相同的，这两个状态是简并的。结合单个 TF 的能量是 $\\epsilon_b$，因此这些状态的能量是 $E_{1,0} = E_{0,1} = \\epsilon_b$。\n3.  **状态 (1,1)**：两个位点都被占据。结合的 TF 数量为 $N=2$。总能量包括两个 TF 的结合能以及它们之间的相互作用能：$E_{1,1} = 2\\epsilon_b + \\epsilon_{\\text{int}}$。\n\n巨正则配分函数 $\\mathcal{Z}$ 是每个状态的玻尔兹曼因子 $\\exp[-\\beta(E - N\\mu)]$ 的总和，其中 $E$ 是状态的能量，$N$ 是该状态下的粒子数。\n$$\n\\mathcal{Z} = \\sum_{\\text{states}} \\exp[-\\beta(E_{\\text{state}} - N_{\\text{state}}\\mu)]\n$$\n\n我们来计算每个状态的项：\n- 对于状态 (0,0)：$N=0$，$E=0$。该项为 $\\exp[-\\beta(0 - 0 \\cdot \\mu)] = 1$。\n- 对于两个 $N=1$ 的状态：$E=\\epsilon_b$。这两个状态的贡献是 $2 \\times \\exp[-\\beta(\\epsilon_b - \\mu)]$。\n- 对于状态 (1,1)：$N=2$，$E=2\\epsilon_b + \\epsilon_{\\text{int}}$。该项为 $\\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}} - 2\\mu)]$。\n\n将这些项求和得到配分函数：\n$$\n\\mathcal{Z} = 1 + 2\\exp[-\\beta(\\epsilon_b - \\mu)] + \\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}} - 2\\mu)]\n$$\n我们可以重写指数项：\n$$\n\\mathcal{Z} = 1 + 2\\exp(\\beta\\mu)\\exp(-\\beta\\epsilon_b) + \\exp(2\\beta\\mu)\\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}})]\n$$\n化学势由 $\\mu = \\mu^0 + k_B T \\ln(c/c_0)$ 给出。使用 $\\beta = 1/(k_B T)$，我们得到 $\\beta\\mu = \\beta\\mu^0 + \\ln(c/c_0)$。\n因此，逸度项 $\\exp(\\beta\\mu)$ 为 $\\exp(\\beta\\mu^0 + \\ln(c/c_0)) = (c/c_0)\\exp(\\beta\\mu^0)$。\n\n如验证阶段所确立，结合能 $\\epsilon_b$ 被解释为相对于标准态的结合自由能，即它已经包含了 $-\\mu^0$。从溶液中结合一个粒子的相关能量变化是 $\\Delta G_{bind} = \\epsilon_b - k_B T \\ln(c/c_0)$。结合一个 TF 的玻尔兹曼因子是 $\\exp(-\\beta \\Delta G_{bind}) = \\exp[-\\beta(\\epsilon_b - k_B T \\ln(c/c_0))] = \\exp(-\\beta\\epsilon_b)\\exp[\\ln(c/c_0)] = \\frac{c}{c_0}\\exp(-\\beta\\epsilon_b)$。\n\n我们定义相对于空状态的单占据统计权重：\n$$\nw_1 = \\frac{c}{c_0}\\exp(-\\beta\\epsilon_b)\n$$\n双占据的统计权重可以类似地表示。结合两个粒子的能量变化是 $\\Delta G_{bind,2} = (2\\epsilon_b + \\epsilon_{\\text{int}}) - 2 k_B T \\ln(c/c_0)$。玻尔兹曼因子是：\n$$\nw_2 = \\exp[-\\beta(\\Delta G_{bind,2})] = \\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}})]\\exp[2\\ln(c/c_0)] = \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b) \\exp(-\\beta\\epsilon_{\\text{int}})\n$$\n这可以用 $w_1$ 表示为：\n$$\nw_2 = \\left(\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b)\\right)^2 \\exp(-\\beta\\epsilon_{\\text{int}}) = (w_1)^2 \\exp(-\\beta\\epsilon_{\\text{int}})\n$$\n配分函数，对宏观状态（由结合的 TF 数量定义）求和，是：\n$$\n\\mathcal{Z} = W_0 + W_1 + W_2\n$$\n其中 $W_0=1$（对于 $N=0$），$W_1=2 w_1$（对于 $N=1$，考虑到有两个位点），以及 $W_2=w_2$（对于 $N=2$）。\n$$\n\\mathcal{Z} = 1 + 2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})\n$$\n分数占据率 $P_{\\text{occ}}$ 是至少一个位点被占据的概率。这是有一个 TF 结合和两个 TF 结合的概率之和。\n$$\nP_{\\text{occ}} = P(N=1) + P(N=2) = \\frac{W_1}{\\mathcal{Z}} + \\frac{W_2}{\\mathcal{Z}} = \\frac{W_1+W_2}{\\mathcal{Z}}\n$$\n或者，$P_{\\text{occ}} = 1 - P(N=0) = 1 - \\frac{W_0}{\\mathcal{Z}} = 1 - \\frac{1}{\\mathcal{Z}} = \\frac{\\mathcal{Z}-1}{\\mathcal{Z}}$。两种表达式是等价的。\n将 $W_1$ 和 $W_2$ 的表达式代入分子，将 $\\mathcal{Z}$ 代入分母，我们得到分数占据率的最终表达式：\n$$\nP_{\\text{occ}} = \\frac{2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}{1 + 2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}\n$$\n这个表达式是用指定的参数 $c$、$c_{0}$、$\\beta$、$\\epsilon_{b}$ 和 $\\epsilon_{\\text{int}}$ 表示的。", "answer": "$$\n\\boxed{\\frac{2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}{1 + 2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}}\n$$", "id": "2966850"}, {"introduction": "合成生物学的一个核心目标是设计能结合特定 DNA 序列的转录因子。本练习 [@problem_id:2966823] 将理论与应用相结合，指导你完成一个从设计到全基因组评估的完整流程。你将通过设计一个定制的锌指蛋白并利用其 PWM 模型预测其脱靶率，从而亲身体验在基因组尺度上实现结合特异性所面临的关键挑战。", "problem": "您正在设计一个三指Cys2His2 (C2H2)锌指转录因子，以结合一个特定的双链脱氧核糖核酸（DNA）靶标，并希望使用位置权重矩阵（PWM）扫描来估算一个大型基因组中超出阈值的脱靶匹配的预期数量。\n\n靶标和设计假设：\n- 靶位点是正链上的9个碱基对（bp）序列$5'$-GCGTATGGC-$3'$，它将被三个串联的C2H2锌指识别，每个锌指沿$5' \\rightarrow 3'$方向接触一个3 bp的子位点：锌指1对应$5'$-GCG-$3'$，锌指2对应$5'$-TAT-$3'$，锌指3对应$5'$-GGC-$3'$。\n- 使用简化的C2H2锌指经典三接触识别码：对于每个3 bp子位点$5'$-$B_{1}B_{2}B_{3}$-$3'$，α-螺旋上位置$6$、$3$和$-1$的残基分别主要接触$B_{1}$、$B_{2}$和$B_{3}$。选择残基以偏好碱基，规则如下：A $\\rightarrow$ Asn (N), C $\\rightarrow$ Asp (D), G $\\rightarrow$ Arg (R), T $\\rightarrow$ Ser (S)。忽略上下文效应和锌指间的耦合作用。\n- 通过为每个位置$i \\in \\{1,\\dots,9\\}$分配概率，将设计转化为一个PWM：在该位置上，为设计的碱基$b^{*}$分配一个共有碱基概率$p_{i}(b^{*})=0.7$，并为每个非共有碱基$b \\neq b^{*}$分配概率$p_{i}(b)=0.1$。假设各位置之间相互独立。\n\n扫描和评分假设：\n- 背景碱基频率是均匀的：$q(\\mathrm{A})=q(\\mathrm{C})=q(\\mathrm{G})=q(\\mathrm{T})=\\frac{1}{4}$。\n- 一个9-mer $x_{1:9}$的PWM对数奇数比分为 $S(x_{1:9})=\\sum_{i=1}^{9} \\log_{2}\\!\\left(\\frac{p_{i}(x_{i})}{q(x_{i})}\\right)$ （单位为比特）。\n- 如果一个位点的得分$S(x_{1:9}) \\geq T$，则被称为一个命中，阈值为$T=8.0$比特。\n- 您使用长度为$L=9$、步长为1的滑动窗口扫描一个长度为$G=3.0 \\times 10^{9}$ bp的基因组的双链，因此评估的总窗口数为$N_{\\text{win}}=2\\,(G-L+1)$。\n\n任务：\n1. 指明根据上述识别码为偏好靶标$5'$-GCGTATGGC-$3'$而选择的每个锌指在位置$6$、$3$和$-1$处的关键螺旋残基。\n2. 仅使用上述PWM和评分假设，从第一性原理推导在扫描基因组时超出阈值的命中的预期数量，并将该期望值用$N_{\\text{win}}$和从背景中抽取的随机9-mer得分$S \\geq T$的概率来表示。\n3. 将最终的预期数量计算为一个实数，并四舍五入到三位有效数字。以无量纲计数（无单位）的形式提供最终答案，不包含百分号或任何角度单位。", "solution": "我们从序列特异性DNA识别和统计性基序扫描的核心定义开始。\n\n使用简化的识别码进行设计步骤：\n- 靶标是$5'$-G C G T A T G G C-$3'$。\n- 对于每个3 bp子位点$5'$-$B_{1}B_{2}B_{3}$-$3'$，使用映射关系 A $\\rightarrow$ Asn (N), C $\\rightarrow$ Asp (D), G $\\rightarrow$ Arg (R), T $\\rightarrow$ Ser (S) 来选择螺旋位置$6$、$3$和$-1$的残基，以分别偏好$B_{1}$、$B_{2}$和$B_{3}$。\n\n应用于每个锌指：\n- 锌指1对应$5'$-G C G-$3'$：位置$6 \\rightarrow$ R (对应G)，位置$3 \\rightarrow$ D (对应C)，位置$-1 \\rightarrow$ R (对应G)。\n- 锌指2对应$5'$-T A T-$3'$：位置$6 \\rightarrow$ S (对应T)，位置$3 \\rightarrow$ N (对应A)，位置$-1 \\rightarrow$ S (对应T)。\n- 锌指3对应$5'$-G G C-$3'$：位置$6 \\rightarrow$ R (对应G)，位置$3 \\rightarrow$ R (对应G)，位置$-1 \\rightarrow$ D (对应C)。\n\n因此，设计的螺旋接触残基是：\n- 锌指1：$(6,3,-1) = (\\mathrm{R}, \\mathrm{D}, \\mathrm{R})$。\n- 锌指2：$(6,3,-1) = (\\mathrm{S}, \\mathrm{N}, \\mathrm{S})$。\n- 锌指3：$(6,3,-1) = (\\mathrm{R}, \\mathrm{R}, \\mathrm{D})$。\n\nPWM和评分：\n根据构建规则，对于每个位置$i \\in \\{1,\\dots,9\\}$，\n- 共有碱基概率为$p_{i}(b^{*})=0.7$，\n- 非共有碱基概率为$p_{i}(b)=0.1$（对于$b \\neq b^{*}$），\n且背景概率对于所有碱基$b$均为$q(b)=\\frac{1}{4}$。\n\n因此，每个位置的对数奇数比分贡献（单位为比特）是常数：\n- 对于共有碱基：$s_{c}=\\log_{2}\\!\\left(\\frac{0.7}{0.25}\\right)=\\log_{2}(2.8)$，\n- 对于非共有碱基：$s_{m}=\\log_{2}\\!\\left(\\frac{0.1}{0.25}\\right)=\\log_{2}(0.4)$。\n\n设$m$为一个9-mer中相对于设计的共有序列的错配（非共有碱基）数量。由于在我们的PWM构建下，各位置是独立同分布的，总分作为$m$的函数是：\n$$\nS(m)=(9-m)\\,s_{c}+m\\,s_{m}\n=9\\,\\log_{2}(2.8)+m\\left[\\log_{2}(0.4)-\\log_{2}(2.8)\\right].\n$$\n定义 $\\Delta = s_{c}-s_{m}=\\log_{2}(2.8)-\\log_{2}(0.4)=\\log_{2}\\!\\left(\\frac{2.8}{0.4}\\right)=\\log_{2}(7)$，因此 $s_{m}-s_{c}=-\\Delta=-\\log_{2}(7)$。数值上，\n$$\ns_{c}=\\log_{2}(2.8)\\approx 1.485426827,\\quad\ns_{m}=\\log_{2}(0.4)\\approx -1.321928095,\\quad\n\\Delta=\\log_{2}(7)\\approx 2.807354922.\n$$\n因此，\n$$\nS(m)=9\\,s_{c}-m\\,\\Delta \\approx 13.36884144 - 2.807354922\\,m.\n$$\n\n阈值判断：\n我们要求$S(m)\\geq T$，其中$T=8.0$比特。求解满足以下条件的最大整数$m$：\n$$\n13.36884144 - 2.807354922\\,m \\geq 8.0\n\\;\\;\\Longleftrightarrow\\;\\;\nm \\leq \\frac{13.36884144-8.0}{2.807354922}\\approx 1.912\\ldots\n$$\n因此，允许的整数为$m=0$或$m=1$。所以，任何与共有序列相比最多有一个错配的9-mer，其得分将达到或超过阈值；任何$m\\geq 2$的序列得分都将低于阈值。\n\n随机9-mer得分超过阈值的概率：\n在均匀背景和独立性假设下，每个9-mer出现的概率相等，为$4^{-9}$。与共有序列的汉明距离为$m$的9-mer数量是$\\binom{9}{m}\\,3^{m}$（选择$m$个位置进行错配，并为每个这样的位置选择3个非共有碱基中的一个）。因此，\n$$\n\\Pr\\{S \\geq T\\}\n=\\frac{1}{4^{9}}\\sum_{m=0}^{1}\\binom{9}{m}3^{m}\n=\\frac{1}{4^{9}}\\left[\\binom{9}{0}3^{0}+\\binom{9}{1}3^{1}\\right]\n=\\frac{1+27}{4^{9}}\n=\\frac{28}{4^{9}}.\n$$\n由于$4^{9}=262{,}144=2^{18}$，我们可以将$\\frac{28}{262{,}144}$简化为$\\frac{7}{65{,}536}$。\n\n超出阈值的命中的预期数量：\n扫描的总窗口数是$N_{\\text{win}}=2\\,(G-L+1)=2\\,(3.0\\times 10^{9}-9+1)=2\\,(3.0\\times 10^{9}-8)$。预期计数是：\n$$\n\\mathbb{E}[\\text{hits}]=N_{\\text{win}} \\times \\Pr\\{S \\geq T\\}\n=2\\,(3.0\\times 10^{9}-8)\\times \\frac{7}{65{,}536}.\n$$\n为了进行数值评估，\n$$\n2\\,(3.0\\times 10^{9}-8)=6.0\\times 10^{9}-16,\n$$\n所以\n$$\n\\mathbb{E}[\\text{hits}]=\\frac{7\\,(6.0\\times 10^{9}-16)}{65{,}536}\n=\\frac{42\\times 10^{9}-112}{65{,}536}.\n$$\n计算该值：\n$$\n\\frac{42\\times 10^{9}}{65{,}536}\\approx 640{,}869.140625,\\quad\n\\frac{112}{65{,}536}\\approx 0.001708984375,\n$$\n因此\n$$\n\\mathbb{E}[\\text{hits}]\\approx 640{,}869.140625-0.001708984375\n=640{,}869.138916015625.\n$$\n\n四舍五入到三位有效数字得到 $6.41\\times 10^{5}$。\n\n总结：\n- 每个锌指设计的螺旋残基：锌指1 $(6,3,-1)=(\\mathrm{R},\\mathrm{D},\\mathrm{R})$，锌指2 $(\\mathrm{S},\\mathrm{N},\\mathrm{S})$，锌指3 $(\\mathrm{R},\\mathrm{R},\\mathrm{D})$。\n- 在一个$3.0\\times 10^{9}$ bp的基因组中，以$T=8.0$比特的阈值扫描双链时，超出阈值的命中的预期数量：约为$6.41\\times 10^{5}$（无量纲计数），符合要求。", "answer": "$$\\boxed{6.41 \\times 10^{5}}$$", "id": "2966823"}]}