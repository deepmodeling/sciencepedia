{"hands_on_practices": [{"introduction": "成功诱导多能干细胞的第一步是确保将重编程因子有效递送至目标细胞。当使用病毒载体时，感染过程本质上是随机的，这意味着我们需要一个数学模型来优化实验方案。本练习将引导您使用泊松分布来计算获得高重编程效率所需的多重感染复数（$MOI$），这是设计基因递送实验的一项基本定量技能 [@problem_id:2948582]。", "problem": "一个实验室旨在通过使用四种独立的、滴度匹配的病毒载体来递送四种重编程转录因子（例如 OCT4, SOX2, KLF4, 和 MYC），以生成诱导性多能干细胞 (iPSCs)。感染在低至中等病毒载量下进行，使得每个载体每个细胞的成功进入事件数可以很好地用泊松分布建模，并且来自不同载体的进入事件彼此独立。假设四种载体中的每一种都以相同的感染复数 (MOI)（记为 $m$）施加，MOI 定义为该载体每个细胞的平均成功进入事件数。当且仅当一个细胞从四种载体中的每一种都接收到至少一次成功的进入事件时，该细胞才被认为具备重编程能力；从任何单个载体接收多个拷贝不会带来额外的好处。\n\n仅使用泊松分布的定义和四种载体事件的独立性，确定所有四种载体的总感染复数（记为 $M_{\\text{total}}$），以使得一个随机选择的细胞有 $0.95$ 的概率从四种载体中的每一种接收到至少一次成功的进入事件。将您的最终答案表示为用初等函数表示的闭式解析表达式。不要进行数值计算。最终答案必须是无单位的单个表达式。", "solution": "问题指明，对于每种载体，每个细胞的成功进入事件数遵循均值为 $m$ 的泊松分布。对于均值为 $m$ 的泊松随机变量 $K$，观察到恰好 $k$ 个事件的概率是\n$$\n\\Pr(K = k) = \\frac{m^{k} \\exp(-m)}{k!}.\n$$\n特别地，来自某个给定载体的成功进入事件为零的概率是\n$$\n\\Pr(K = 0) = \\exp(-m).\n$$\n因此，一个细胞从某个给定载体接收到至少一次成功进入的概率是\n$$\n\\Pr(K \\ge 1) = 1 - \\Pr(K = 0) = 1 - \\exp(-m).\n$$\n问题陈述四种载体独立感染，且每种载体都以相同的 $m$ 值施加。因此，一个细胞从四种载体中的每一种都接收到至少一次成功进入的概率是各个概率的乘积：\n$$\n\\Pr(\\text{at least one of each of four}) = \\left(1 - \\exp(-m)\\right)^{4}.\n$$\n我们被要求确保这个概率等于 $0.95$。因此 $m$ 必须满足\n$$\n\\left(1 - \\exp(-m)\\right)^{4} = 0.95.\n$$\n取四次方根并求解 $m$，\n$$\n1 - \\exp(-m) = 0.95^{1/4}\n\\quad\\Longrightarrow\\quad\n\\exp(-m) = 1 - 0.95^{1/4}\n\\quad\\Longrightarrow\\quad\nm = -\\ln\\!\\left(1 - 0.95^{1/4}\\right).\n$$\n所有四种载体的总感染复数是每种载体施加的均值之和，在对称性下为\n$$\nM_{\\text{total}} = 4 m = -4 \\,\\ln\\!\\left(1 - 0.95^{1/4}\\right).\n$$\n这就是所要求的、用初等函数表示的闭式解析表达式。", "answer": "$$\\boxed{-4\\,\\ln\\!\\left(1-0.95^{1/4}\\right)}$$", "id": "2948582"}, {"introduction": "为了提高重编程的效率和质量，研究人员常常使用小分子抑制剂（如‘$2\\mathrm{i}$’方案）来调控关键信号通路。然而，简单地组合药物并不总能保证最佳效果，理解它们之间的相互作用至关重要。本练习将带您拟合剂量-反应曲线，并应用Bliss独立模型来量化两种抑制剂之间的协同作用，这是药物发现和方案优化中的一个核心概念 [@problem_id:2948578]。", "problem": "一项重编程实验定量分析了在有或没有信号通路小分子调节剂的情况下，由小鼠胚胎成纤维细胞经过 $14$ 天培养后产生的碱性磷酸酶阳性诱导性多能干细胞 (iPSC) 集落。这两种化合物是 CHIR99021，一种糖原合酶激酶 $3$ (GSK$3$) 抑制剂，和 PD0325901，一种丝裂原活化蛋白激酶/细胞外信号调节激酶 (MEK) 抑制剂。它们一起被称为两种抑制剂 ($2\\mathrm{i}$)。对于每种单一化合物，获得了以下剂量-反应数据（剂量单位为 $\\mu \\mathrm{M}$，集落数为每个培养皿的集落数）：\n\n- CHIR99021: $(d,\\ \\text{colonies}) = (\\,0,\\ 10),\\ (\\,0.5,\\ 23),\\ (\\,1.0,\\ 30),\\ (\\,3.0,\\ 40),\\ (\\,10.0,\\ 46)\\,$。\n- PD0325901: $(d,\\ \\text{colonies}) = (\\,0,\\ 10),\\ (\\,0.05,\\ 20),\\ (\\,0.10,\\ 25),\\ (\\,0.30,\\ 32.5),\\ (\\,1.00,\\ 37.3)\\,$。\n\n假设每种单一药物的剂量-反应关系遵循标准希尔方程，且希尔系数 $n=1$，其中 $E(d)$ 表示剂量为 $d$ 时的预期集落数，$E_{0}$ 是剂量 $d=0$ 时的基线集落数，$E_{\\max}$ 是在非常高剂量下的渐近最大集落数，$EC_{50}$ 是半数有效浓度。使用这些数据来拟合每条曲线，具体方法是：将 $d=0$ 时的值作为 $E_{0}$，根据高剂量数据所提示的渐近线来估计 $E_{\\max}$，并通过反应值位于 $E_{0}$ 和 $E_{\\max}$ 中间点时的剂量来确定 $EC_{50}$。\n\n在 CHIR99021 剂量 $d_{C}=3.0\\ \\mu \\mathrm{M}$ 和 PD0325901 剂量 $d_{P}=0.20\\ \\mu \\mathrm{M}$ 条件下进行的组合实验，得到的观测集落数为 $E_{12}^{\\mathrm{obs}}=52$。\n\n为了使用Bliss独立模型评估协同效应，将所有效应以一个共同的上限 $E_{\\mathrm{ceil}}=60$ 个集落和基线 $E_{0}=10$ 个集落进行归一化。将任何条件下的分数效应定义为\n$$\nf=\\frac{E-E_{0}}{E_{\\mathrm{ceil}}-E_{0}}\\,.\n$$\n在Bliss独立模型下，对于单一药物分数效应分别为 $f_{1}$ 和 $f_{2}$ 的两种药物，其预期的组合分数效应为\n$$\nf_{12}^{\\mathrm{exp}}=f_{1}+f_{2}-f_{1}f_{2}\\,.\n$$\n将Bliss超额（协同效应分数）定义为\n$$\n\\Delta=f_{12}^{\\mathrm{obs}}-f_{12}^{\\mathrm{exp}}\\,,\n$$\n其中 $f_{12}^{\\mathrm{obs}}$ 是根据 $E_{12}^{\\mathrm{obs}}$ 计算出的观测组合分数效应。使用你的希尔拟合结果，计算在 $d_{C}=3.0\\ \\mu \\mathrm{M}$ 和 $d_{P}=0.20\\ \\mu \\mathrm{M}$ 组合下的 $\\Delta$。将最终答案四舍五入至四位有效数字。将最终值表示为无单位的小数。", "solution": "问题陈述已经过验证，并被认为是科学上合理的、提法恰当的、客观的且自洽的。它提出了一个定量药理学和细胞生物学中的标准分析任务。我们将进行系统性的解答。\n\n目标是计算在诱导性多能干细胞重编程实验中，两种小分子 CHIR99021 和 PD0325901 组合的 Bliss 超额协同效应分数 $\\Delta$。这需要几个连续的步骤：将每种化合物的剂量-反应数据拟合到简化的希尔方程，使用这些模型预测在指定组合剂量下的单一药物效应，最后应用Bliss独立模型。\n\n首先，我们对每种化合物的剂量-反应进行建模。问题指定了希尔系数为 $n=1$ 的希尔方程，其形式为：\n$$\nE(d) = E_{0} + \\frac{(E_{\\max} - E_{0})d}{EC_{50} + d}\n$$\n其中 $E(d)$ 是剂量为 $d$ 时的效应（集落数），$E_{0}$ 是零剂量时的基线效应，$E_{\\max}$ 是最大可能效应，$EC_{50}$ 是引起半数最大反应的剂量。\n\n我们来分析 CHIR99021，将其记为药物 $C$。所提供的数据为 $(d, E) = (0, 10), (0.5, 23), (1.0, 30), (3.0, 40), (10.0, 46)$。\n遵循问题的指示：\n1.  基线效应是 $d=0$ 时的计数值，所以 $E_{0,C} = 10$。\n2.  我们必须根据高剂量数据所提示的渐近线来估计 $E_{\\max,C}$。在剂量为 $10.0\\ \\mu \\mathrm{M}$ 时，观察到的最高效应是 $46$ 个集落。反应曲线似乎正在饱和。一个合理的渐近线估计值是 $E_{\\max,C} = 50$。\n3.  $EC_{50}$ 的剂量需要在反应值位于 $E_{0}$ 和 $E_{\\max}$ 中间点时确定。半数最大效应为 $E_{mid} = E_{0,C} + \\frac{E_{\\max,C} - E_{0,C}}{2} = 10 + \\frac{50 - 10}{2} = 10 + 20 = 30$。数据显示在剂量 $d=1.0\\ \\mu \\mathrm{M}$ 时达到了 $30$ 个集落的效应。这种完美的对应关系验证了我们对 $E_{\\max,C}=50$ 的选择。因此，$EC_{50,C} = 1.0\\ \\mu \\mathrm{M}$。\nCHIR99021 的希尔方程结果为：\n$$\nE_C(d) = 10 + \\frac{(50-10)d}{1.0+d} = 10 + \\frac{40d}{1.0+d}\n$$\n\n接下来，我们分析 PD0325901，将其记为药物 $P$。数据为 $(d, E) = (0, 10), (0.05, 20), (0.10, 25), (0.30, 32.5), (1.00, 37.3)$。\n1.  基线效应是 $E_{0,P} = 10$。\n2.  在 $d=1.00\\ \\mu \\mathrm{M}$ 时观察到的最高效应是 $37.3$。我们估计渐近线为 $E_{\\max,P} = 40$。\n3.  半数最大效应是 $E_{mid} = E_{0,P} + \\frac{E_{\\max,P} - E_{0,P}}{2} = 10 + \\frac{40 - 10}{2} = 10 + 15 = 25$。数据显示在 $d=0.10\\ \\mu \\mathrm{M}$ 时达到了 $25$ 个集落的效应。这验证了我们对 $E_{\\max,P}=40$ 的估计。因此，$EC_{50,P} = 0.10\\ \\mu \\mathrm{M}$。\nPD0325901 的希尔方程结果为：\n$$\nE_P(d) = 10 + \\frac{(40-10)d}{0.10+d} = 10 + \\frac{30d}{0.10+d}\n$$\n\n组合实验在剂量 $d_C = 3.0\\ \\mu \\mathrm{M}$ 和 $d_P = 0.20\\ \\mu \\mathrm{M}$ 下进行。我们使用拟合的模型来找出在这些剂量下的预期单一药物效应 $E_1$ 和 $E_2$。\n对于 CHIR99021（药物 1）：\n$$\nE_1 = E_C(3.0) = 10 + \\frac{40(3.0)}{1.0+3.0} = 10 + \\frac{120}{4} = 10 + 30 = 40\n$$\n对于 PD0325901（药物 2）：\n$$\nE_2 = E_P(0.20) = 10 + \\frac{30(0.20)}{0.10+0.20} = 10 + \\frac{6.0}{0.30} = 10 + 20 = 30\n$$\n\n现在我们计算相对于共同上限 $E_{\\mathrm{ceil}}=60$ 和基线 $E_0=10$ 的分数效应 $f$。公式为：\n$$\nf = \\frac{E - E_0}{E_{\\mathrm{ceil}} - E_0} = \\frac{E-10}{50}\n$$\n药物 1 (CHIR99021) 的分数效应为：\n$$\nf_1 = \\frac{E_1 - E_0}{50} = \\frac{40 - 10}{50} = \\frac{30}{50} = 0.6\n$$\n药物 2 (PD0325901) 的分数效应为：\n$$\nf_2 = \\frac{E_2 - E_0}{50} = \\frac{30 - 10}{50} = \\frac{20}{50} = 0.4\n$$\n\n在Bliss独立模型下，预期的组合分数效应 $f_{12}^{\\mathrm{exp}}$ 由以下公式给出：\n$$\nf_{12}^{\\mathrm{exp}} = f_1 + f_2 - f_1 f_2\n$$\n代入我们计算出的值：\n$$\nf_{12}^{\\mathrm{exp}} = 0.6 + 0.4 - (0.6)(0.4) = 1.0 - 0.24 = 0.76\n$$\n\n给出的组合观测集落数为 $E_{12}^{\\mathrm{obs}} = 52$。观测到的分数效应 $f_{12}^{\\mathrm{obs}}$ 为：\n$$\nf_{12}^{\\mathrm{obs}} = \\frac{E_{12}^{\\mathrm{obs}} - E_0}{E_{\\mathrm{ceil}} - E_0} = \\frac{52 - 10}{50} = \\frac{42}{50} = 0.84\n$$\n\n最后，Bliss超额协同效应分数 $\\Delta$ 是观测组合效应与预期组合效应之间的差值：\n$$\n\\Delta = f_{12}^{\\mathrm{obs}} - f_{12}^{\\mathrm{exp}}\n$$\n$$\n\\Delta = 0.84 - 0.76 = 0.08\n$$\n\n问题要求将最终答案四舍五入至四位有效数字。计算出的值恰好是 $0.08$。为了用四位有效数字表示，我们加上末尾的零。因此，该值为 $0.08000$。", "answer": "$$\\boxed{0.08000}$$", "id": "2948578"}, {"introduction": "将iPSC衍生的细胞用于临床治疗前，必须严格评估其安全性，其中最大的风险来自残留的未分化细胞可能形成的畸胎瘤。由于无法对整批细胞进行完全检测，我们必须依赖统计学方法，通过对样本的检测结果来推断整批产品的风险。本练习将指导您从基本概率原理出发，为残留未分化细胞的比例计算一个统计置信上限，这是确保细胞治疗产品安全性的关键质量控制步骤 [@problem_id:2948646]。", "problem": "在对一批源自诱导性多能干细胞（iPSCs）的分化细胞进行安全性评估时，主要的致瘤风险来自于稀有的残留未分化 iPSCs。设 $p$ 表示该批次中随机抽取的一个细胞是残留的未分化 iPSC，并在移植后会形成畸胎瘤的未知单细胞概率。假设无论是残留未分化状态还是检测结果，细胞之间都是相互独立的。\n\n申办方计划移植一个包含 $T$ 个细胞的移植物。在质量控制中，他们使用一种对未分化细胞检测灵敏度为 $\\eta$ 且具有完美特异性的单细胞测试，对批次中的 $n$ 个细胞的简单随机样本进行检测。在 $n$ 个被抽样的细胞中，检测结果全部为阴性。申办方希望使用 $1-\\alpha$ 的单边频率派置信水平为 $p$ 设定一个上限。\n\n仅从独立伯努利试验的基本概率定律和补集法则出发，并且不使用任何预先制表的统计区间公式，完成以下任务：\n\n1. 推导致瘤风险 $r(p,T)$ 的表达式，该风险定义为大小为 $T$ 的移植物中存在至少一个残留未分化 iPSC 的概率。\n2. 推导一个精确的单边置信上限 $p_{\\max}(n,\\eta,\\alpha)$，使得在该模型下，当 $n$ 次独立检测中观察到零个阳性结果时，可以推断 $p \\leq p_{\\max}(n,\\eta,\\alpha)$，且置信度至少为 $1-\\alpha$。\n3. 使用您推导的表达式，计算当检测细胞数 $n = 3.0 \\times 10^{6}$，灵敏度 $\\eta = 0.95$，且 $\\alpha = 0.05$ 时的 $p_{\\max}$。将最终上限表示为小数，并将您的最终答案四舍五入至四位有效数字。\n\n最终答案只报告 $p_{\\max}$ 的数值。不要报告任何中间量。概率必须以小数或分数形式表示，不得使用百分比。", "solution": "所述问题具有科学依据、提法明确且客观。它代表了细胞治疗质量控制背景下的一个标准统计风险评估问题。诸如独立伯努利试验之类的假设，对于该领域典型的大批量生产是适当的简化。因此，该问题被认为是有效的，并将构建解决方案。\n\n解决方案按照问题陈述的要求分三部分推导。\n\n**第一部分：致瘤风险 $r(p, T)$ 的推导**\n\n致瘤风险 $r(p, T)$ 定义为在大小为 $T$ 的移植物中存在至少一个残留未分化的诱导性多能干细胞（iPSC）的概率。设 $p$ 为单个随机选取的细胞是未分化 iPSC 的概率。移植物中每个细胞的选择都被建模为一次独立的伯努利试验。\n\n移植物中包含“至少一个”未分化细胞的事件，是它包含“零个”未分化细胞事件的补集事件。根据概率的补集法则：\n$$r(p, T) = P(\\text{at least one undifferentiated cell in } T) = 1 - P(\\text{zero undifferentiated cells in } T)$$\n\n单个细胞*不是*未分化 iPSC 的概率是 $1-p$。由于假设细胞是独立的，所有 $T$ 个细胞都*不是*未分化细胞的概率是它们各自概率的乘积：\n$$P(\\text{zero undifferentiated cells in } T) = (1-p) \\times (1-p) \\times \\dots \\times (1-p) \\text{ (} T \\text{ times)} = (1-p)^T$$\n\n将此代入风险表达式中，得到所需的公式：\n$$r(p, T) = 1 - (1-p)^T$$\n\n**第二部分：置信上限 $p_{\\max}(n, \\eta, \\alpha)$ 的推导**\n\n我们的任务是为未知参数 $p$ 推导一个精确的单边置信上限 $p_{\\max}$。该上限基于在 $n$ 个细胞样本中未发现阳性结果的观察，该样本使用灵敏度为 $\\eta$ 且特异性完美的测试进行检测。置信水平为 $1-\\alpha$。\n\n首先，我们必须确定单个细胞检测结果为阴性的概率，并将其表示为 $p$ 的函数。设 $U$ 为细胞是未分化 iPSC 的事件（$P(U) = p$），$D$ 为细胞是分化细胞的事件（$P(D) = 1-p$）。测试的特性如下：\n- 灵敏度：$P(\\text{Test Positive} | U) = \\eta$。因此，一个未分化细胞出现假阴性的概率为 $P(\\text{Test Negative} | U) = 1 - \\eta$。\n- 完美特异性：$P(\\text{Test Negative} | D) = 1$。\n\n使用全概率公式，单个细胞检测结果为阴性的总概率为：\n$$P(\\text{Test Negative}) = P(\\text{Test Negative} | U) P(U) + P(\\text{Test Negative} | D) P(D)$$\n$$P(\\text{Test Negative}) = (1-\\eta)p + (1)(1-p) = 1 - \\eta p + p - p = 1 - \\eta p$$\n\n设 $E$ 为所有 $n$ 次独立检测均返回阴性结果的事件。在给定未知参数 $p$ 的条件下，此事件的概率为：\n$$P(E|p) = [P(\\text{Test Negative})]^n = (1 - \\eta p)^n$$\n\n为了构建一个 $1-\\alpha$ 的置信上限，我们遵循频率派原则。置信上限 $p_{\\max}$ 是这样一个 $p$ 值，在该值下，观察到我们当前结果（零个阳性）或更极端结果的概率等于显著性水平 $\\alpha$。设 $X$ 为观察到的阳性细胞数的随机变量。我们观察到 $X=0$。在检验上限时，阳性数更少的结果（如 $X=0$）被认为是在支持更小 $p$ 值方面更极端的结果。我们观察结果的 p 值为 $P(X \\le 0|p) = P(X=0|p)$。置信上限 $p_{\\max}$ 就是使这个 p 值等于 $\\alpha$ 的 $p$ 值。\n\n因此，我们将观察到的事件的概率设为等于 $\\alpha$：\n$$P(E | p_{\\max}) = \\alpha$$\n$$(1 - \\eta p_{\\max})^n = \\alpha$$\n\n现在，我们求解这个方程以得到 $p_{\\max}$：\n$$1 - \\eta p_{\\max} = \\alpha^{1/n}$$\n$$\\eta p_{\\max} = 1 - \\alpha^{1/n}$$\n$$p_{\\max}(n, \\eta, \\alpha) = \\frac{1 - \\alpha^{1/n}}{\\eta}$$\n这就是从第一性原理推导出的精确单边置信上限。\n\n**第三部分：$p_{\\max}$ 的数值计算**\n\n给定以下数值：\n- 检测细胞数，$n = 3.0 \\times 10^6$\n- 检测灵敏度，$\\eta = 0.95$\n- 显著性水平，$\\alpha = 0.05$\n\n将这些值代入我们推导出的 $p_{\\max}$ 公式中：\n$$p_{\\max} = \\frac{1 - (0.05)^{1/(3.0 \\times 10^6)}}{0.95}$$\n\n为了计算这个表达式，我们首先计算 $(0.05)^{1/(3.0 \\times 10^6)}$ 这一项。我们使用恒等式 $a^b = \\exp(b \\ln a)$：\n$$\\frac{1}{n} = \\frac{1}{3.0 \\times 10^6} \\approx 3.333 \\times 10^{-7}$$\n$$\\ln(\\alpha) = \\ln(0.05) \\approx -2.99573227$$\n$$\\frac{\\ln(\\alpha)}{n} = \\frac{-2.99573227}{3.0 \\times 10^6} \\approx -9.9857742 \\times 10^{-7}$$\n$$(0.05)^{1/n} = \\exp\\left(\\frac{\\ln(0.05)}{n}\\right) \\approx \\exp(-9.9857742 \\times 10^{-7}) \\approx 0.999999001422$$\n\n现在将此结果代回 $p_{\\max}$ 的表达式中：\n$$p_{\\max} \\approx \\frac{1 - 0.999999001422}{0.95} = \\frac{9.98578 \\times 10^{-7}}{0.95} \\approx 1.0511347 \\times 10^{-6}$$\n\n作为验算，对于非常大的 $n$， $p_{\\max}$ 的表达式可以使用泰勒展开式 $\\exp(x) \\approx 1+x$（对于小的 $x$）进行近似：\n$$\\alpha^{1/n} = \\exp\\left(\\frac{\\ln \\alpha}{n}\\right) \\approx 1 + \\frac{\\ln \\alpha}{n}$$\n$$p_{\\max} \\approx \\frac{1 - (1 + \\frac{\\ln \\alpha}{n})}{\\eta} = \\frac{-\\ln \\alpha}{n\\eta}$$\n$$p_{\\max} \\approx \\frac{-\\ln(0.05)}{(3.0 \\times 10^6)(0.95)} = \\frac{2.99573227}{2.85 \\times 10^6} \\approx 1.0511341 \\times 10^{-6}$$\n近似值与精确计算的结果极为接近，这证实了结果的正确性。\n\n将计算出的值 $1.0511347 \\times 10^{-6}$ 四舍五入至四位有效数字，得到 $1.051 \\times 10^{-6}$。", "answer": "$$ \\boxed{1.051 \\times 10^{-6}} $$", "id": "2948646"}]}