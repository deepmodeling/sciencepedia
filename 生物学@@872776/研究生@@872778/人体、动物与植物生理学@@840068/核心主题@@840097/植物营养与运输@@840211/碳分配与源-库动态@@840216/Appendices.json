{"hands_on_practices": [{"introduction": "源-库动态的核心在于单个叶片的碳收支。本练习通过一个假设场景，运用质量守恒定律来量化源叶的主要产出——可供输出的蔗糖。通过这个练习，您将掌握光合作用固定的碳如何在呼吸作用、淀粉储存和蔗糖输出等关键代谢途径中进行分配，这是分析全植物碳分配的第一步，也是至关重要的一步。[@problem_id:2554154]", "problem": "一片进行光合作用的叶片在饱和光照下处于稳态运行，因此在所考虑的时间窗口内，其非结构性碳库没有发生可测量的变化。总光合碳固定速率为 $A = 20$ $\\mu\\text{mol CO}_2 \\text{ m}^{-2} \\text{ s}^{-1}$，同时发生的光下线粒体叶片呼吸速率为 $R_l = 2$ $\\mu\\text{mol CO}_2 \\text{ m}^{-2} \\text{ s}^{-1}$，淀粉合成速率为 $S = 4$ $\\mu\\text{mol C m}^{-2} \\text{ s}^{-1}$。假设叶片内所有其他碳汇均可忽略不计，一个二氧化碳（$\\mathrm{CO_2}$）分子为同化产物贡献一摩尔当量的碳，且蔗糖的化学式为 $\\text{C}_{12}\\text{H}_{22}\\text{O}_{11}$。\n\n仅使用碳的质量守恒和分子化学计量，计算通过韧皮部输出的最大稳态蔗糖速率，单位为 $\\mu\\text{mol 蔗糖 m}^{-2} \\text{ s}^{-1}$。将您的答案四舍五入至四位有效数字。", "solution": "所述问题具有科学依据，内容完备，且提法恰当。它要求将质量守恒原理应用于处于稳态的生物系统，这是生理学中一种标准且有效的方法。我们将开始解题。\n\n控制该系统的基本原理是碳的质量守恒。问题指明叶片在稳态下运行，这意味着非结构性碳库的大小是恒定的。这意味着流入该碳库的总碳速率必须等于从该碳库流出的总碳速率。\n\n让我们以每单位叶面积每单位时间的碳摩尔数来定义通量，具体单位为 $\\mu\\text{mol C m}^{-2} \\text{s}^{-1}$。\n\n碳的主要来源是总光合作用，其速率用 $A$ 表示。问题给出该速率为 $A = 20$ $\\mu\\text{mol CO}_2 \\text{ m}^{-2} \\text{ s}^{-1}$。根据所提供的化学计量关系，一个 $\\mathrm{CO_2}$ 分子提供一个碳原子。因此，碳流入速率为：\n$$A_C = 20 \\, \\mu\\text{mol C m}^{-2} \\text{s}^{-1}$$\n\n固定的碳被分配到几个碳汇中。问题指出了三个：\n1. 光下线粒体呼吸，$R_l$。该过程释放 $\\mathrm{CO_2}$，代表固定碳的损失。给出的速率为 $R_l = 2$ $\\mu\\text{mol CO}_2 \\text{ m}^{-2} \\text{ s}^{-1}$。这对应于碳流出速率为：\n$$R_{l,C} = 2 \\, \\mu\\text{mol C m}^{-2} \\text{s}^{-1}$$\n2. 淀粉合成，$S$。这是叶片内的一个储存汇。该速率直接以碳单位给出：\n$$S = 4 \\, \\mu\\text{mol C m}^{-2} \\text{s}^{-1}$$\n3. 通过韧皮部输出蔗糖。让我们将以这种形式输出的碳速率表示为 $E_C$，单位为 $\\mu\\text{mol C m}^{-2} \\text{s}^{-1}$。这是我们必须首先确定的量。\n\n问题指出所有其他碳汇均可忽略不计。因此，碳的稳态质量平衡方程为：\n$$(\\text{碳流入速率}) = (\\text{碳流出速率})$$\n$$A_C = R_{l,C} + S + E_C$$\n\n现在我们可以求解碳输出速率 $E_C$：\n$$E_C = A_C - R_{l,C} - S$$\n代入给定的数值：\n$$E_C = 20 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}} - 2 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}} - 4 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}}$$\n$$E_C = 14 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}}$$\n这个结果表示碳原子从叶片中输出的速率。然而，问题要求的是蔗糖的输出速率，我们称之为 $E_{sucrose}$，单位为 $\\mu\\text{mol 蔗糖 m}^{-2} \\text{s}^{-1}$。\n\n为了进行这种转换，我们使用蔗糖分子的化学计量关系，其化学式为 $\\text{C}_{12}\\text{H}_{22}\\text{O}_{11}$。该化学式表明一摩尔蔗糖含有 $12$ 摩尔碳原子。蔗糖的摩尔通量与其所含碳的摩尔通量之间的关系是：\n$$E_C = 12 \\times E_{sucrose}$$\n我们必须重新整理这个方程来求解蔗糖的输出速率：\n$$E_{sucrose} = \\frac{E_C}{12}$$\n代入我们计算出的 $E_C$ 值：\n$$E_{sucrose} = \\frac{14 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}}}{12 \\, \\frac{\\mu\\text{mol C}}{\\mu\\text{mol sucrose}}}$$\n$$E_{sucrose} = \\frac{14}{12} \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}} = \\frac{7}{6} \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}}$$\n执行除法运算，我们得到：\n$$E_{sucrose} \\approx 1.1666... \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}}$$\n问题要求答案四舍五入至四位有效数字。将结果四舍五入得到：\n$$E_{sucrose} \\approx 1.167 \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}}$$\n这是在指定的稳态条件下可能的最大输出速率，因为所有其他通量都是固定的。", "answer": "$$\\boxed{1.167}$$", "id": "2554154"}, {"introduction": "在叶片碳收支的基础上，我们将视角提升至整株植物或冠层尺度。本练习引入了“库限制”这一关键概念，当环境变化（如二氧化碳浓度升高）不成比例地促进了光合作用（源）而生长能力（库）未能同步跟上时，这种情况十分常见。通过这个基于模型的计算，您将模拟源-库失衡的后果，量化多余的碳，并预测其在储存和呼吸之间的分配，从而加深对总初级生产力（$GPP$）、净初级生产力（$NPP$）和碳利用效率（$CUE$）等重要生态生理学概念的理解。[@problem_id:2554161]", "problem": "可以在冠层尺度上建立一个整株植物碳平衡的恒等式：总初级生产力（$GPP$，单位为 $\\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$）被分配为净初级生产力（$NPP$）和自养呼吸（$R_{a}$），其中碳利用效率（CUE）定义为 $CUE = \\frac{NPP}{GPP}$。在源-汇框架中，源强度由 $GPP$ 量化，而汇强度是吸收碳以用于生长（$NPP$）的能力。在汇限制下，实际的 $NPP$ 不能超过汇容量，任何相对于此容量的剩余碳可以暂时以非结构性碳水化合物的形式储存，或作为溢流呼吸而损失。\n\n考虑一个在环境二氧化碳条件下具有以下测得基线属性的作物冠层：\n- 基线总初级生产力 $GPP_{0} = $ $12$ $\\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$。\n- 基线碳利用效率 $CUE_{0} = $ $0.45$，因此 $NPP_{0} = CUE_{0}\\,GPP_{0}$。\n\n现在施加一个升高二氧化碳的处理，该处理使叶片水平的净同化量（与 $GPP$ 成比例）增加 $30\\%$，而生长汇容量（可实现的最大 $NPP$）仅相对于基线 $NPP_{0}$ 增加 $10\\%$。假设在没有汇限制的情况下，植物在升高的二氧化碳条件下将保持与基线相同的生长碳利用效率 $CUE_{0}$，因此在升高的二氧化碳条件下，无限制的潜在生长为 $CUE_{0}\\,GPP_{\\mathrm{elev}}$，其中 $GPP_{\\mathrm{elev}} = 1.30\\,GPP_{0}$。在汇限制下，将潜在过剩碳 $X$ 定义为这种无限制的潜在生长与升高的二氧化碳条件下受汇限制的最大 $NPP$ 之间的差值，并将负值截断为零。\n\n进一步假设，这些过剩碳 $X$ 的去向由储存碳利用效率 $CUE_{\\mathrm{store}} = 0.70$ 决定，此处定义为在同化当天作为非结构性碳水化合物储存而保留的过剩碳的比例；剩余的比例 $1 - CUE_{\\mathrm{store}}$ 在当天作为溢流呼吸而损失。\n\n仅使用这些定义，计算：\n- 升高的二氧化碳条件下的潜在过剩碳 $X$，\n- 保留在储存中的过剩碳量，以及\n- 因溢流呼吸而损失的过剩碳量。\n\n将你的最终答案表示为一个三分量行向量 $\\big(X,\\ \\text{stored},\\ \\text{respired}\\big)$，单位为 $\\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$，四舍五入到四位有效数字。不要在向量中包含单位。", "solution": "必须首先验证问题陈述的科学合理性、自洽性和形式严谨性。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n问题提供了以下定义和量：\n- 总初级生产力（$GPP$）被分配为净初级生产力（$NPP$）和自养呼吸（$R_{a}$）。\n- 碳利用效率定义为 $CUE = \\frac{NPP}{GPP}$。\n- 源强度由 $GPP$ 量化。\n- 汇强度是吸收碳以用于生长（$NPP$）的能力。\n- 基线总初级生产力：$GPP_{0} = 12$ $\\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$。\n- 基线碳利用效率：$CUE_{0} = 0.45$。\n- 基线净初级生产力：$NPP_{0} = CUE_{0}\\,GPP_{0}$。\n- 升高二氧化碳处理导致 $GPP_{\\mathrm{elev}} = 1.30\\,GPP_{0}$。\n- 升高二氧化碳条件下的汇容量：$NPP_{\\mathrm{max, elev}} = 1.10\\,NPP_{0}$。\n- 升高二氧化碳条件下无限制的潜在生长为 $CUE_{0}\\,GPP_{\\mathrm{elev}}$。\n- 潜在过剩碳：$X = \\max(0, (CUE_{0}\\,GPP_{\\mathrm{elev}}) - NPP_{\\mathrm{max, elev}})$。\n- 储存碳利用效率：$CUE_{\\mathrm{store}} = 0.70$。\n- 作为储存保留的过剩碳的比例是 $CUE_{\\mathrm{store}}$。\n- 作为溢流呼吸损失的过剩碳的比例是 $1 - CUE_{\\mathrm{store}}$。\n\n目标是计算 $X$ 的值、储存的碳量以及因溢流呼吸而损失的碳量。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估：\n- **科学依据**：该问题基于植物生态生理学中公认的概念，包括碳平衡（$GPP$、$NPP$、$R_a$）、碳利用效率（$CUE$）和源-汇动态。汇限制、非结构性碳水化合物积累和溢流呼吸的模型是分析植物对大气二氧化碳浓度升高响应的标准框架。所提供的数值对于一个高产的C3作物冠层来说是合理的。\n- **良定的**：该问题是良定的。所有变量和参数都有明确定义，并且通过定义提供了一条清晰、顺序的求解路径。它包含了所有必要信息，并且可以确定一个唯一解。\n- **客观性**：该问题以客观、定量的术语陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它科学合理、良定、客观且内部一致。这是一个应用简化但标准的生态生理模型的正式练习。将推导出完整解。\n\n**求解过程**\n\n该问题需要根据所提供的定义进行顺序计算。每一步都必须精确执行。\n\n首先，我们使用给定的基线总初级生产力 $GPP_{0}$ 和基线碳利用效率 $CUE_{0}$ 来计算基线净初级生产力 $NPP_{0}$。\n已知条件是：\n$GPP_{0} = 12$ $\\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$\n$CUE_{0} = 0.45$\n\n使用定义 $NPP_{0} = CUE_{0}\\,GPP_{0}$：\n$$NPP_{0} = 0.45 \\times 12 = 5.4\\ \\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$$\n\n接下来，我们计算升高二氧化碳情景下的参数。\n升高二氧化碳条件下的总初级生产力 $GPP_{\\mathrm{elev}}$ 比基线高 $30\\%$：\n$$GPP_{\\mathrm{elev}} = 1.30 \\times GPP_{0} = 1.30 \\times 12 = 15.6\\ \\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$$\n\n最大的生长汇容量 $NPP_{\\mathrm{max, elev}}$ 比基线净初级生产力高 $10\\%$：\n$$NPP_{\\mathrm{max, elev}} = 1.10 \\times NPP_{0} = 1.10 \\times 5.4 = 5.94\\ \\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$$\n\n现在，我们确定升高二氧化碳条件下的无限制潜在生长。问题陈述这需要假设基线碳利用效率 $CUE_{0}$ 保持不变来计算：\n$$\\text{Unconstrained Potential Growth} = CUE_{0} \\times GPP_{\\mathrm{elev}} = 0.45 \\times 15.6 = 7.02\\ \\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$$\n这个值代表了如果植物的汇强度不是限制因素时可以实现的 $NPP$。\n\n潜在过剩碳 $X$ 是这个无限制的潜在生长与实际受汇限制的最大生长 $NPP_{\\mathrm{max, elev}}$ 之间的差值。\n$$X = (\\text{Unconstrained Potential Growth}) - NPP_{\\mathrm{max, elev}}$$\n$$X = 7.02 - 5.94 = 1.08\\ \\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$$\n由于该值为正，根据定义 $X = \\max(0, \\dots)$，它等于 $X$。这个 $X$ 代表了由于汇限制而无法整合到新的结构生物量中的剩余碳。\n\n最后，我们根据储存碳利用效率 $CUE_{\\mathrm{store}} = 0.70$，将这些过剩碳 $X$ 分配到储存和溢流呼吸中。\n\n保留在储存中的碳量是：\n$$\\text{Stored} = X \\times CUE_{\\mathrm{store}} = 1.08 \\times 0.70 = 0.756\\ \\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$$\n\n因溢流呼吸而损失的碳量是剩余的部分：\n$$\\text{Respired} = X \\times (1 - CUE_{\\mathrm{store}}) = 1.08 \\times (1 - 0.70) = 1.08 \\times 0.30 = 0.324\\ \\mathrm{g\\ C\\ m^{-2}\\ day^{-1}}$$\n\n为了验证，分配后的各组分之和必须等于总过剩碳：\n$$0.756 + 0.324 = 1.08 = X$$\n计算是一致的。\n\n问题要求最终答案以三分量行向量 $(X,\\ \\text{stored},\\ \\text{respired})$ 的形式表示，并四舍五入到四位有效数字。\n$X = 1.08$ 变为 $1.080$。\n储存 = $0.756$ 变为 $0.7560$。\n呼吸 = $0.324$ 变为 $0.3240$。\n\n因此，最终的向量是 $(1.080, 0.7560, 0.3240)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1.080 & 0.7560 & 0.3240 \\end{pmatrix}}$$", "id": "2554161"}, {"introduction": "从静态计算到动态系统，这项高级实践将让您体验计算生物学家的工作。您不仅需要使用一个给定的模型，更要将其与时间序列数据进行拟合，从而估算出决定碳流向的关键参数——分配系数。本练习将带您亲历整个建模流程：实现动态模型、通过数值优化进行参数估计，并通过可识别性分析来严格评估参数的可靠性。这些都是现代定量植物科学研究中连接理论模型与实验数据的核心技能。[@problem_id:2554157]", "problem": "给定一个简化的、基于生理学的源-库碳分配模型，该模型描述了一株具有两个结构器官（叶和根）和一个充分混合的非结构性碳水化合物（NSC）库的植物。您的目标是通过将模型预测与提供的器官生物量和NSC浓度的时间序列数据进行拟合，来估计控制碳从NSC库流向每个结构器官的分配转移系数。您必须实现一个程序，解决一个约束加权最小二乘问题来估计这些参数，然后通过计算最优解处的灵敏度（雅可比）矩阵的秩和条件数来评估局部结构可辨识性。\n\n基于质量守恒的模型和假设：\n- 令 $L_t$ 和 $R_t$ 分别表示在第 $t$ 天的叶和根的结构生物量（单位：g）。\n- 令 $N_t$ 表示在第 $t$ 天的NSC质量（单位：g）。\n- 令 $A_t$ 表示在第 $t$ 天内输入的NSC净同化量（单位：$\\text{g/天}$）。\n- 从NSC库到结构生物量的分配被建模为一阶转移过程，在感兴趣的时间窗口内具有恒定的系数 $k_L$ 和 $k_R$（单位：$\\text{天}^{-1}$）。\n- 时间以一天为步长，通过前向欧拉质量平衡法推进，除了分配之外没有明确的维持或损失项：\n  $$\n  \\begin{aligned}\n  L_{t+1} = L_t + k_L N_t, \\\\\n  R_{t+1} = R_t + k_R N_t, \\\\\n  N_{t+1} = N_t + A_t - (k_L + k_R)N_t.\n  \\end{aligned}\n  $$\n- 观测到的整株植物NSC浓度 $C_t$（单位：$\\text{mg/g}$）与模型状态的关系如下：\n  $$\n  C_t = 1000 \\cdot \\frac{N_t}{L_t + R_t}.\n  $$\n- 在离散时间 $t = 0, 1, \\dots, T$ 提供观测数据，并已知同化序列 $\\{A_t\\}_{t=0}^{T-1}$ 和初始条件 $L_0$、$R_0$、$N_0$。\n\n参数估计问题：\n- 未知参数是 $k_L$ 和 $k_R$，约束在区间 $[0,1]$ $\\text{天}^{-1}$ 内。\n- 令 $\\widehat{L}_t(k_L,k_R)$、$\\widehat{R}_t(k_L,k_R)$ 和 $\\widehat{C}_t(k_L,k_R)$ 表示模型预测值。\n- 给定观测序列 $\\{L_t^{\\text{obs}}\\}$、$\\{R_t^{\\text{obs}}\\}$、$\\{C_t^{\\text{obs}}\\}$ 和正常数比例缩放常数 $s_L$（单位：g）、$s_R$（单位：g）、$s_C$（单位：$\\text{mg/g}$），通过按时间堆叠定义一个无量纲残差向量：\n  $$\n  \\mathbf{r}(k_L,k_R) = \\left[ \\frac{\\widehat{L}_t - L_t^{\\text{obs}}}{s_L}, \\frac{\\widehat{R}_t - R_t^{\\text{obs}}}{s_R}, \\frac{\\widehat{C}_t - C_t^{\\text{obs}}}{s_C} \\right]_{t=0}^{T}.\n  $$\n- 通过最小化加权平方和 $J(k_L,k_R) = \\|\\mathbf{r}(k_L,k_R)\\|_2^2$ 来估计 $(k_L,k_R)$，约束条件为 $0 \\le k_L \\le 1$ 和 $0 \\le k_R \\le 1$。\n\n可辨识性评估：\n- 令 $\\mathbf{J}$ 表示 $\\mathbf{r}$ 相对于 $(k_L,k_R)$ 的雅可比（灵敏度）矩阵，在估计的参数处进行评估。如果 $\\operatorname{rank}(\\mathbf{J}) = 2$ 并且条件数 $\\kappa(\\mathbf{J})$ 低于指定阈值，则表明具有局部结构可辨识性。使用奇异值分解来估计秩和条件数，并且当且仅当估计的秩等于 $2$ 且 $\\kappa(\\mathbf{J})  10^8$ 时，声明该参数对是局部可辨识的。\n\n数值单位和输出：\n- 转移系数 $k_L$ 和 $k_R$ 必须以 $\\text{天}^{-1}$ 为单位报告。\n- 均方根误差（RMSE）必须根据无量纲残差计算，并以无量纲浮点数的形式报告。\n- 可辨识性决策必须是一个布尔值。\n- 不使用角度。不使用百分比。\n\n您的程序必须解决三个测试案例。对于每个案例，计算并报告 $[k_L, k_R, \\text{RMSE}, \\text{Identifiable}]$，其中 $k_L$ 和 $k_R$ 的单位是 $\\text{天}^{-1}$，RMSE为无量纲，Identifiable为布尔值。在最终输出中，将每个浮点数四舍五入到六位小数。\n\n测试套件：\n- 案例1（信息丰富，条件良好）：\n  - 在第 $t=0,\\dots,6$ 天的同化序列（$\\text{g/天}$）：$A = [1.2, 1.5, 1.3, 1.1, 1.4, 1.0, 0.8]$。\n  - 初始条件：$L_0 = 5.0$ g, $R_0 = 5.0$ g, $N_0 = 1.0$ g。\n  - 观测数据：使用上述模型和真实参数 $k_L^{\\star} = 0.08$ $\\text{天}^{-1}$ 和 $k_R^{\\star} = 0.04$ $\\text{天}^{-1}$ 生成 $t=0,\\dots,7$ 的 $\\{L_t^{\\text{obs}}\\}$、$\\{R_t^{\\text{obs}}\\}$ 和 $\\{C_t^{\\text{obs}}\\}$；不添加额外噪声。\n  - 缩放常数：$s_L = 1.0$ g, $s_R = 1.0$ g, $s_C = 10.0$ $\\text{mg/g}$。\n  - 预期结果：接近恢复 $k_L^{\\star}$ 和 $k_R^{\\star}$，RMSE 很小，可辨识性为真。\n\n- 案例2（观测数据不足以区分流量）：\n  - 与案例1相同的 $A$、$L_0$、$R_0$、$N_0$ 和生成的观测数据。\n  - 缩放常数：$s_L = +\\infty$（实现为权重 $0$），$s_R = +\\infty$（实现为权重 $0$），$s_C = 10.0$ $\\text{mg/g}$。也就是说，只有 $\\{C_t^{\\text{obs}}\\}$ 对残差有贡献。\n  - 预期结果：目标函数仅依赖于 $k_L + k_R$，因此存在局部不可辨识性；算法将返回无限多个解中的一个（例如，接近 $0.06$ 和 $0.06$ 的对称值），并且可辨识性为假。\n\n- 案例3（无可用NSC，无同化作用）：\n  - 同化序列：$A = [0.0, 0.0, 0.0, 0.0]$（第 $t=0,\\dots,3$ 天）。\n  - 初始条件：$L_0 = 4.0$ g, $R_0 = 6.0$ g, $N_0 = 0.0$ g。\n  - 观测数据：当 $N_0=0$ g 且所有 $t$ 的 $A_t=0$ $\\text{g/天}$时，模型预测 $L_t$、$R_t$ 为常数，且 $C_t=0$ $\\text{mg/g}$；使用这些作为 $t=0,\\dots,4$ 的 $\\{L_t^{\\text{obs}}\\}$、$\\{R_t^{\\text{obs}}\\}$ 和 $\\{C_t^{\\text{obs}}\\}$。\n  - 缩放常数：$s_L = 1.0$ g, $s_R = 1.0$ g, $s_C = 1.0$ $\\text{mg/g}$。\n  - 预期结果：残差与 $(k_L,k_R)$ 无关，因此可辨识性为假；优化器可能会返回初始猜测值。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试案例的结果必须是 $[k_L, k_R, \\text{RMSE}, \\text{Identifiable}]$ 形式的列表，其中 $k_L$ 和 $k_R$ 的单位为 $\\text{天}^{-1}$，RMSE为无量纲，Identifiable为布尔值。示例格式（非实际数字）：[[0.080000,0.040000,0.000000,True],[0.060000,0.060000,0.001234,False],[0.050000,0.050000,0.000000,False]]。\n\n实现说明：\n- 使用约束非线性最小二乘求解器来最小化 $J(k_L,k_R)$，每个参数的界限为 $[0,1]$ $\\text{天}^{-1}$。\n- RMSE计算为在所有时间和由缩放常数包括的观测值上的无量纲残差平方的均值的平方根。\n- 在最优点处数值计算雅可比矩阵，并通过秩和条件数（阈值 $\\kappa(\\mathbf{J})  10^8$）评估局部可辨识性。", "solution": "该问题要求在一个简化的植物生理模型中估计碳分配参数 $k_L$ 和 $k_R$。此估计将通过使用约束加权非线性最小二乘法，将模型与合成数据进行拟合来完成。随后，必须使用雅可比矩阵对估计出的参数进行局部结构可辨识性分析。\n\n该模型描述了叶生物量 ($L_t$)、根生物量 ($R_t$) 和非结构性碳水化合物 (NSC) 质量 ($N_t$) 在离散时间步长内的动态变化。方程组由前向欧拉近似给出：\n$$\n\\begin{aligned}\nL_{t+1} = L_t + k_L N_t \\\\\nR_{t+1} = R_t + k_R N_t \\\\\nN_{t+1} = N_t + A_t - (k_L + k_R)N_t\n\\end{aligned}\n$$\n这里，$A_t$ 是每日净同化量。可观测的NSC浓度 $C_t$ 与状态变量的关系为：\n$$\nC_t = 1000 \\cdot \\frac{N_t}{L_t + R_t}\n$$\n\n对于每个测试案例，解决方案按以下几个逻辑步骤进行：\n1.  **数据生成**：对于每个测试案例，通过使用指定的“真实”参数（或在不明确情况下的代表性参数）和初始条件来模拟模型方程，从而生成一组“观测”时间序列数据 $\\{L_t^{\\text{obs}}\\}$、$\\{R_t^{\\text{obs}}\\}$ 和 $\\{C_t^{\\text{obs}}\\}$。这为测试估计算法提供了一个基准真相。\n\n2.  **参数估计**：问题的核心是找到参数 $(k_L, k_R)$，以最小化加权残差的平方和 $J(k_L, k_R)$。残差向量 $\\mathbf{r}$ 由模型预测值与生成观测值之间的归一化差异构成。\n    $$\n    J(k_L,k_R) = \\sum_{t=0}^{T} \\left[ \\left(\\frac{\\widehat{L}_t - L_t^{\\text{obs}}}{s_L}\\right)^2 + \\left(\\frac{\\widehat{R}_t - R_t^{\\text{obs}}}{s_R}\\right)^2 + \\left(\\frac{\\widehat{C}_t - C_t^{\\text{obs}}}{s_C}\\right)^2 \\right]\n    $$\n    这是一个非线性最小二乘问题，需要数值求解。`scipy.optimize.least_squares` 函数非常适合此任务，因为它可以高效地最小化向量值函数的平方和，并能处理边界约束 $0 \\le k_L, k_R \\le 1$。需要一个参数的初始猜测值，例如 $(k_L, k_R) = (0.05, 0.05)$，来启动迭代优化过程。请注意，无穷大的缩放常数 $s_L, s_R$ 通过从残差向量中排除相应项来处理，实际上是给它们在目标函数中分配了零权重。\n\n3.  **RMSE 计算**：找到最优参数 $(k_L^*, k_R^*)$ 后，计算均方根误差 (RMSE)。它被定义为无量纲残差平方均值的平方根。如果 $J^*$ 是最小化的平方和，$M$ 是残差项的总数（在所有时间点和包含的观测值上求和），则RMSE由下式给出：\n    $$\n    \\text{RMSE} = \\sqrt{\\frac{J^*}{M}}\n    $$\n\n4.  **局部结构可辨识性分析**：此分析评估参数是否可以从给定的数据和模型结构中唯一确定，至少在估计的最优值附近是如此。它依赖于灵敏度（雅可比）矩阵 $\\mathbf{J}$，该矩阵包含残差向量关于每个参数的偏导数，并在最优参数值处进行评估。\n    $$\n    \\mathbf{J}_{ij} = \\frac{\\partial r_i}{\\partial p_j} \\bigg|_{(k_L^*, k_R^*)}\n    $$\n    `scipy.optimize.least_squares` 函数方便地提供了此矩阵的数值近似。\n    - **秩**：$n$ 个参数局部可辨识的必要条件是雅可比矩阵具有满列秩（即 $\\operatorname{rank}(\\mathbf{J}) = n$）。在这个问题中，有两个参数 $(k_L, k_R)$，我们需要 $\\operatorname{rank}(\\mathbf{J}) = 2$。这意味着参数对模型输出具有线性无关的影响。秩是使用奇异值分解 (SVD) 稳健地计算的。\n    - **条件数**：如果满足秩条件，条件数 $\\kappa(\\mathbf{J})$ 提供了一个衡量解对数据微小变化的敏感性的指标。它是 $\\mathbf{J}$ 的最大奇异值与最小奇异值之比。一个非常大的条件数表明问题是病态的，意味着即使数据中存在少量噪声也可能导致估计参数发生巨大变化。问题指定了 $10^8$ 的阈值。\n\n    当且仅当 $\\operatorname{rank}(\\mathbf{J}) = 2$ 且 $\\kappa(\\mathbf{J})  10^8$ 时，参数对被声明为局部可辨识。\n\n实现将根据此方法处理三个指定的测试案例中的每一个，计算最优参数、RMSE和可辨识性状态，并按要求格式化结果。\n- **案例1**：当所有三个观测值都被加权时，模型参数对输出有不同的影响，从而导致一个条件良好的雅可比矩阵和成功的参数恢复。\n- **案例2**：仅观测NSC浓度 $C_t$，我们失去了区分 $k_L$ 和 $k_R$ 对生长的各自贡献的能力。NSC动态仅取决于它们的和 $k_L + k_R$。因此，雅可比矩阵的列变得线性相关，其秩降为1，参数不可辨识。\n- **案例3**：在初始NSC为零且无同化作用的情况下，不发生生长。模型输出变为常数，且与 $k_L$ 和 $k_R$ 无关。对于任何参数值，残差都恒为零，使得雅可比矩阵成为一个零矩阵。其秩为0，参数不可辨识。优化器将简单地返回其初始猜测值。", "answer": "[[0.080000,0.040000,0.000000,True],[0.060012,0.059988,0.000000,False],[0.050000,0.050000,0.000000,False]]", "id": "2554157"}]}