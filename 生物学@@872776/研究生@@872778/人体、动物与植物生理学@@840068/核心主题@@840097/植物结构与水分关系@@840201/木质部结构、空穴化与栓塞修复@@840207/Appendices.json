{"hands_on_practices": [{"introduction": "空穴化在木质部导管间的传播主要是通过“空气播种”机制发生的，即气体穿过相邻导管间纹孔膜的微小孔隙。纹孔膜上气水界面的稳定性是阻止栓塞扩散的关键，这一稳定性可由杨-拉普拉斯方程精确描述。本练习将引导您应用该基本物理原理，计算给定纹孔孔径下，栓塞扩散所需的临界木质部张力，从而将微观结构特征与植物的生理极限直接联系起来。[@problem_id:2624062]", "problem": "在一株木本被子植物中，一个栓塞的导管（充满气体）通过一个纹孔膜与一个相邻的充满水的导管水力连接，该纹孔膜上最大的有效圆形孔隙半径为 $r_{\\max} = 40 \\times 10^{-9}\\,\\text{m}$。木质部汁液含有两亲性脂质，这些脂质将孔隙处的空气-水界面张力降低至 $\\gamma = 0.032\\,\\text{N}\\,\\text{m}^{-1}$，并且汁液以 $\\theta = 18^{\\circ}$ 的静态接触角（从液体侧测量）浸润木质纤维素纹孔膜。假设栓塞导管中的气体处于大气压下（$P_{\\text{gas}} = 0\\,\\text{MPa}$ 表压），充满水的导管承受大小为 $T$ 的均匀木质部张力，因此其液体压力为 $P_{\\text{liq}} = -T$（相对于大气压），在孔隙尺度上重力可忽略不计，且纹孔处的弯月面是一个固定在孔隙边缘的球冠。\n\n从弯曲界面的毛细压力关系（拉普拉斯定律）以及适用于接触角为 $\\theta$、跨越圆形孔隙的球形弯月面的适当几何关系出发，推导空气进入（空气播种）穿过纹孔的条件，并用它来计算最大木质部张力大小 $T_{\\max}$，在该张力下栓塞体将仍被限制在栓塞的导管内（即，刚好在空气不会播种到相邻导管的临界点上）。将您的最终结果表示为一个以 $\\text{MPa}$ 为单位的数字，并四舍五入到三位有效数字。", "solution": "在尝试任何解答之前，将根据所需标准对问题进行验证。\n\n### 步骤1：提取已知条件\n以下是逐字提供的数据和条件：\n- 一个栓塞的导管（充满气体）与一个充满水的导管水力连接。\n- 连接通过一个纹孔膜。\n- 最大有效圆形孔隙的半径为 $r_{\\max} = 40 \\times 10^{-9}\\,\\text{m}$。\n- 空气-水界面张力为 $\\gamma = 0.032\\,\\text{N}\\,\\text{m}^{-1}$。\n- 静态接触角为 $\\theta = 18^{\\circ}$，从液体侧测量。\n- 气体压力为 $P_{\\text{gas}} = 0\\,\\text{MPa}$ 表压。\n- 液体压力为 $P_{\\text{liq}} = -T$，其中 $T$ 是木质部张力的大小。\n- 重力可忽略不计。\n- 弯月面是固定在孔隙边缘的球冠。\n- 目标是计算最大木质部张力大小 $T_{\\max}$。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行分析：\n- **科学依据**：该问题基于杨-拉普拉斯方程，这是流体力学中控制毛细现象的一个基本原理。其在植物木质部空气播种中的应用是植物生理学中一个标准且成熟的模型。所提供的孔隙半径、表面张力（由于表面活性剂的存在而低于纯水）和接触角的值对于此类生物系统在物理上是现实的。\n- **适定性**：该问题是适定的。它提供了所有必要的参数（$r_{\\max}$、$\\gamma$、$\\theta$）和一个清晰的物理模型（圆形孔隙中的球形弯月面），以确定最大可持续张力 $T_{\\max}$ 的唯一值。\n- **客观性**：该问题以精确、定量的术语陈述，没有任何主观性或模糊性。\n\n该问题不违反任何无效标准。这是一个应用于生物学背景的标准物理问题，内容自洽且一致。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**。将推导求解。\n\n控制跨越弯曲流体界面的压力差的基本原理是杨-拉普拉斯方程。对于具有单一曲率半径 $R$ 的球形界面，该方程为：\n$$ \\Delta P = P_c = \\frac{2\\gamma}{R} $$\n其中 $\\Delta P$ 是压力差，或毛细压力 $P_c$，$\\gamma$ 是流体界面的表面张力。弯月面凹侧的压力较高。在此系统中，空气-水界面朝向充满气体的导管一侧凹陷，因此气体压力 $P_{\\text{gas}}$ 高于液体压力 $P_{\\text{liq}}$。因此，我们可以写出：\n$$ P_{\\text{gas}} - P_{\\text{liq}} = \\frac{2\\gamma}{R} $$\n问题陈述，弯月面是一个固定在半径为 $r_{\\max}$ 的圆形孔隙边缘的球冠。一个几何关系连接了球冠的曲率半径 $R$、孔隙半径 $r_{\\max}$ 和接触角 $\\theta$（从液相测量）。根据孔隙横截面的三角学关系，这个关系式是：\n$$ r_{\\max} = R \\cos(\\theta) $$\n这使我们能够用已知的孔隙几何形状和接触角来表示曲率半径 $R$：\n$$ R = \\frac{r_{\\max}}{\\cos(\\theta)} $$\n将这个 $R$ 的表达式代入杨-拉普拉斯方程，得到纹孔处弯月面所能承受的压力差的具体条件：\n$$ P_{\\text{gas}} - P_{\\text{liq}} = \\frac{2\\gamma \\cos(\\theta)}{r_{\\max}} $$\n该方程描述了平衡状态。当跨界面的压力差超过孔隙所能承受的最大毛细压力时，就会发生空气播种，即界面的灾难性破坏。对于给定的静态接触角，方程右侧的表达式代表了这个最大可持续压力差。因此，当左侧等于右侧时，就达到了空气播种的阈值。\n\n我们已知相对于大气压的压力（表压）：\n- 栓塞导管中的气体压力：$P_{\\text{gas}} = 0\\,\\text{MPa}$。\n- 功能导管中的液体压力：$P_{\\text{liq}} = -T$，其中 $T$ 是木质部张力的大小。为使导管处于张力下，$T$ 必须为正值，从而使 $P_{\\text{liq}}$ 为负值。\n\n将这些压力定义代入阈值条件：\n$$ 0 - (-T) = \\frac{2\\gamma \\cos(\\theta)}{r_{\\max}} $$\n这可以简化为：\n$$ T = \\frac{2\\gamma \\cos(\\theta)}{r_{\\max}} $$\n这个 $T$ 值代表了在空气从栓塞导管播种到功能导管之前，木质部可以承受的最大张力大小 $T_{\\max}$。任何大于此值的张力都将导致弯月面破裂。\n$$ T_{\\max} = \\frac{2\\gamma \\cos(\\theta)}{r_{\\max}} $$\n现在，我们将所提供的数值代入这个表达式。单位必须一致；我们将首先以国际单位制（帕斯卡）进行计算。\n- $\\gamma = 0.032\\,\\text{N}\\,\\text{m}^{-1}$\n- $\\theta = 18^{\\circ}$\n- $r_{\\max} = 40 \\times 10^{-9}\\,\\text{m}$\n\n$$ T_{\\max} = \\frac{2 \\times (0.032\\,\\text{N}\\,\\text{m}^{-1}) \\times \\cos(18^{\\circ})}{40 \\times 10^{-9}\\,\\text{m}} $$\n单位 $\\text{N}\\,\\text{m}^{-1} / \\text{m}$ 得出 $\\text{N}\\,\\text{m}^{-2}$，即帕斯卡（$\\text{Pa}$）。\n$$ T_{\\max} = \\frac{0.064 \\times \\cos(18^{\\circ})}{40 \\times 10^{-9}}\\,\\text{Pa} $$\n使用值 $\\cos(18^{\\circ}) \\approx 0.9510565$：\n$$ T_{\\max} \\approx \\frac{0.064 \\times 0.9510565}{40 \\times 10^{-9}}\\,\\text{Pa} $$\n$$ T_{\\max} \\approx \\frac{0.0608676}{40 \\times 10^{-9}}\\,\\text{Pa} $$\n$$ T_{\\max} \\approx 1.52169 \\times 10^{6}\\,\\text{Pa} $$\n问题要求答案以兆帕斯卡（$\\text{MPa}$）为单位。因为 $1\\,\\text{MPa} = 10^6\\,\\text{Pa}$：\n$$ T_{\\max} \\approx 1.52169\\,\\text{MPa} $$\n按要求四舍五入到三位有效数字：\n$$ T_{\\max} \\approx 1.52\\,\\text{MPa} $$\n这是栓塞体仍被限制时木质部张力的最大值。", "answer": "$$\n\\boxed{1.52}\n$$", "id": "2624062"}, {"introduction": "单个导管的栓塞事件虽然发生在微观层面，但其累积效应会显著影响整个植物的水分运输系统。本练习将植物的水力系统类比为电路，运用类似于欧姆定律的液流阻力模型。您将通过计算来揭示茎干部分栓塞如何增加维持蒸腾所需的总水势梯度，从而阐明结构失效与生理功能之间的定量关系。[@problem_id:2624050]", "problem": "一株进行蒸腾作用的被子植物幼苗可以表示为一个由根、茎、叶三个部分串联组成的线性导水网络。在稳态下，当内部储水能力可忽略不计且汁液流粘度恒定时，水的质量通量与土壤-根系界面和叶片质外体之间的驱动水势差成正比。定义每个部分 $i \\in \\{\\text{根}, \\text{茎}, \\text{叶}\\}$ 的导水率为 $K_{i}$（单位：$\\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$），并设整株植物的导水率为 $K_{\\text{plant}}$。气穴化事件会产生气体栓塞，使一部分木质部导管失效。在茎中，导管可以理想化为并联的相同管道；当比例为 $f$ 的导管发生栓塞时，功能性并联网络的规模减小到原来的 $(1-f)$，有效的茎干导水率也按比例 $(1-f)$ 减小。假设栓塞不改变剩余功能性导管的几何形状。\n\n给定午间稳态下的以下数据：\n- 根部基准导水率 $K_{\\text{root},0} = 2.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$。\n- 茎部基准导水率 $K_{\\text{stem},0} = 3.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$。\n- 叶部基准导水率 $K_{\\text{leaf},0} = 1.2 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$。\n- 茎干导管栓塞比例 $f = 0.50$。\n- 稳定蒸腾质量通量 $E = 1.0 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$。\n\n请根据适用于植物导水学的基本原理（流量-势能线性比例关系；导水率和阻力的定义；导水阻力的串联组合；并联网络导水率随功能性导管数量变化的标度关系）来：\n1. 推导维持通量 $E$ 所需的叶-根水势差 $\\Delta \\Psi$（取为从土壤-根系界面到叶片质外体的势降大小）的表达式，该表达式应以 $E$, $K_{\\text{root},0}$, $K_{\\text{stem},0}$, $K_{\\text{leaf},0}$ 和 $f$ 表示。\n2. 使用给定的数值计算 $\\Delta \\Psi$。\n\n以兆帕（MPa）为单位表示 $\\Delta \\Psi$ 的最终答案，并将答案四舍五入到四位有效数字。将 $\\Delta \\Psi$ 报告为正值。", "solution": "该问题被认定为有效。它在科学上基于植物导水学原理，问题设置合理，数据充分且一致，并且表述客观。解答过程如下。\n\n稳态质量通量（$E$）、导水率（$K$）和驱动水流的水势差（$\\Delta \\Psi$）之间的关系类似于欧姆定律：\n$$E = K \\Delta \\Psi$$\n通常使用导水阻力 $R$ 会更方便，它被定义为导水率的倒数：\n$$R = \\frac{1}{K}$$\n于是，流量方程可以写成：\n$$\\Delta \\Psi = E \\times R$$\n问题陈述，幼苗的导水路径由根、茎、叶三个串联的部分组成。对于串联的组件，其总阻力是各个阻力之和。因此，整株植物的总阻力 $R_{\\text{plant}}$ 为：\n$$R_{\\text{plant}} = R_{\\text{root}} + R_{\\text{stem}} + R_{\\text{leaf}}$$\n从土壤-根系界面到叶片质外体的整株植物总水势差 $\\Delta \\Psi$ 由总通量 $E$ 和整株植物总阻力 $R_{\\text{plant}}$ 的乘积给出：\n$$\\Delta \\Psi = E \\times R_{\\text{plant}} = E (R_{\\text{root}} + R_{\\text{stem}} + R_{\\text{leaf}})$$\n接下来，我们必须确定每个部分的阻力。根和叶部分据称不受栓塞影响，因此它们的导水率分别等于其基准值 $K_{\\text{root},0}$ 和 $K_{\\text{leaf},0}$。它们的阻力是：\n$$R_{\\text{root}} = \\frac{1}{K_{\\text{root},0}}$$\n$$R_{\\text{leaf}} = \\frac{1}{K_{\\text{leaf},0}}$$\n对于茎段，比例为 $f$ 的木质部导管发生栓塞。问题指明，有效的茎干导水率 $K_{\\text{stem}}$ 与剩余的功能性导管比例 $(1-f)$ 成比例减小。因此，有效的茎干导水率为：\n$$K_{\\text{stem}} = K_{\\text{stem},0} (1-f)$$\n因此，栓塞茎段的阻力为：\n$$R_{\\text{stem}} = \\frac{1}{K_{\\text{stem}}} = \\frac{1}{K_{\\text{stem},0}(1-f)}$$\n将各部分阻力的表达式代入整株植物总阻力的方程中，得到：\n$$R_{\\text{plant}} = \\frac{1}{K_{\\text{root},0}} + \\frac{1}{K_{\\text{stem},0}(1-f)} + \\frac{1}{K_{\\text{leaf},0}}$$\n这就得出了第一个要求的结果，即总水势差 $\\Delta \\Psi$ 的解析表达式：\n$$\\Delta \\Psi = E \\left( \\frac{1}{K_{\\text{root},0}} + \\frac{1}{K_{\\text{stem},0}(1-f)} + \\frac{1}{K_{\\text{leaf},0}} \\right)$$\n这就完成了任务的第一部分。\n\n对于第二部分，我们必须使用给定的数值计算 $\\Delta \\Psi$：\n- $E = 1.0 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n- $K_{\\text{root},0} = 2.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$\n- $K_{\\text{stem},0} = 3.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$\n- $K_{\\text{leaf},0} = 1.2 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$\n- $f = 0.50$\n\n首先，我们计算各部分阻力，单位为 $\\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$：\n$$R_{\\text{root}} = \\frac{1}{K_{\\text{root},0}} = \\frac{1}{2.0 \\times 10^{-4}} = 5.0 \\times 10^{3}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\n$$R_{\\text{leaf}} = \\frac{1}{K_{\\text{leaf},0}} = \\frac{1}{1.2 \\times 10^{-4}} = \\frac{10}{12} \\times 10^{4} = \\frac{5}{6} \\times 10^{4} \\approx 8.333 \\times 10^{3}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\n茎的有效导水率为：\n$$K_{\\text{stem}} = K_{\\text{stem},0}(1-f) = (3.0 \\times 10^{-4})(1 - 0.50) = (3.0 \\times 10^{-4})(0.50) = 1.5 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$$\n茎的阻力为：\n$$R_{\\text{stem}} = \\frac{1}{K_{\\text{stem}}} = \\frac{1}{1.5 \\times 10^{-4}} = \\frac{10}{15} \\times 10^{4} = \\frac{2}{3} \\times 10^{4} \\approx 6.667 \\times 10^{3}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\n现在，我们将各部分阻力相加，求得整株植物的总阻力 $R_{\\text{plant}}$：\n$$R_{\\text{plant}} = R_{\\text{root}} + R_{\\text{stem}} + R_{\\text{leaf}} = \\left(\\frac{1}{2.0 \\times 10^{-4}} + \\frac{1}{1.5 \\times 10^{-4}} + \\frac{1}{1.2 \\times 10^{-4}}\\right)$$\n$$R_{\\text{plant}} = 10^{4} \\left( \\frac{1}{2.0} + \\frac{1}{1.5} + \\frac{1}{1.2} \\right) = 10^{4} \\left( \\frac{3}{6} + \\frac{4}{6} + \\frac{5}{6} \\right) = 10^{4} \\left( \\frac{3+4+5}{6} \\right) = 10^{4} \\left( \\frac{12}{6} \\right) = 2.0 \\times 10^{4}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\n最后，我们计算水势差 $\\Delta \\Psi$：\n$$\\Delta \\Psi = E \\times R_{\\text{plant}} = (1.0 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}) \\times (2.0 \\times 10^{4}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1})$$\n$$\\Delta \\Psi = 2.0 \\times 10^{-1}\\ \\mathrm{MPa} = 0.2\\ \\mathrm{MPa}$$\n问题要求答案保留四位有效数字。因此，$\\Delta \\Psi = 0.2000\\ \\mathrm{MPa}$。用标准科学记数法表示，即 $2.000 \\times 10^{-1}\\ \\mathrm{MPa}$。", "answer": "$$\\boxed{2.000 \\times 10^{-1}}$$", "id": "2624050"}, {"introduction": "量化植物对空穴化的脆弱性是植物生态生理学中的一项核心任务，其结果通常用“脆弱性曲线”及其关键参数 $P_{50}$（导水率下降50%时的水势）来表示。本练习是一个动手实践的数据分析任务。您将学习如何将标准的逻辑斯蒂模型拟合到实验数据中，以估算 $P_{50}$ 及其它相关参数，这是定量生物学研究中的一项关键技能。[@problem_id:2624104]", "problem": "您正在为植物木质部导水率对空穴化的脆弱性进行建模。导水率损失百分比（PLC）定义为水力传导率相对于最大值的降低分数，以百分比表示。木质部脆弱性的一个常见唯象表示是逻辑斯谛曲线，它将PLC与木质部压力（水势）联系起来，其理论依据是内聚力-张力框架，在该框架中，压力越负，空穴化的可能性就越大。假设在每个测量的压力下，PLC的测量误差是独立同分布的高斯误差。您需要根据提供的压力-PLC数据，通过最大似然法估计模型参数及其不确定性。\n\n基本原理：\n- 根据内聚力-张力概念，木质部汁液处于负压之下，空穴化会降低导水率。脆弱性曲线凭经验可以通过压力的S型函数很好地捕捉。我们采用双参数逻辑斯谛形式\n$$\n\\mathrm{PLC}(P;a,P_{50}) \\;=\\; \\frac{100}{1+\\exp\\!\\big(a\\,(P-P_{50})\\big)} \\, ,\n$$\n其中$P$是压力（水势），$a$是一个正斜率参数，$P_{50}$是$\\mathrm{PLC}=50$时的压力。压力$P$和$P_{50}$必须以兆帕（MPa）为单位表示，$a$必须以$\\mathrm{MPa}^{-1}$为单位表示，$\\mathrm{PLC}$是范围在$[0,100]$内的百分比。\n- 测量模型：对于观测数据$\\{(P_i,y_i)\\}_{i=1}^n$，假设$y_i = \\mathrm{PLC}(P_i;a,P_{50}) + \\varepsilon_i$，其中$\\varepsilon_i \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2)$，$\\sigma$是PLC百分点的未知标准差。\n\n估计任务：\n- 使用最大似然法估计$\\hat{a}$、$\\widehat{P}_{50}$和$\\hat{\\sigma}$。在高斯误差模型下，$a$和$P_{50}$的最大似然估计与残差平方和的非线性最小二乘最小化器重合，$\\sigma^2$的最大似然估计是$\\widehat{\\sigma}^2 = \\mathrm{SSR}/n$，其中$\\mathrm{SSR}=\\sum_{i=1}^n \\big(y_i-\\mathrm{PLC}(P_i;\\hat{a},\\widehat{P}_{50})\\big)^2$。\n- 使用高斯模型的观测Fisher信息估计参数不确定性（标准误），从而得出协方差矩阵\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) \\;=\\; \\widehat{\\sigma}^2 \\, \\big(J^\\top J\\big)^{-1} \\, ,\n$$\n其中$\\theta=(a,P_{50})^\\top$，$J$是$n\\times 2$的雅可比矩阵，其元素为$J_{i,1}=\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial a}$和$J_{i,2}=\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial P_{50}}$，在$(\\hat{a},\\widehat{P}_{50})$处求值。将标准误报告为$\\widehat{\\mathrm{Cov}}(\\hat{\\theta})$对角线元素的平方根。\n\n构建$J$所需的解析导数：\n- 令$E_i = \\exp\\!\\big(a\\,(P_i-P_{50})\\big)$和$D_i = \\big(1+E_i\\big)^2$。则\n$$\n\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial a} \\;=\\; -\\,100 \\,\\frac{(P_i-P_{50})\\,E_i}{D_i} \\, , \\qquad\n\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial P_{50}} \\;=\\; 100 \\,\\frac{a\\,E_i}{D_i} \\, .\n$$\n\n数据和单位：\n- 使用以下测试数据集。在所有情况下，$P$和$P_{50}$的单位是$\\mathrm{MPa}$，$a$的单位是$\\mathrm{MPa}^{-1}$。观测到的$\\mathrm{PLC}$值是百分点。每个数据集是一系列点对$\\big(P_i,y_i\\big)$。\n\n- 测试用例1（典型脆弱性）：\n  - $P = [-0.5,\\,-1.0,\\,-1.5,\\,-2.0,\\,-2.5,\\,-3.0,\\,-3.5]$\n  - $\\mathrm{PLC}_{\\text{obs}} = [8.5,\\,17.1,\\,30.2,\\,50.7,\\,69.4,\\,82.3,\\,91.2]$\n\n- 测试用例2（斜率较缓）：\n  - $P = [-0.2,\\,-1.0,\\,-2.0,\\,-3.0,\\,-4.0,\\,-5.0,\\,-6.0]$\n  - $\\mathrm{PLC}_{\\text{obs}} = [16.1,\\,22.6,\\,35.7,\\,49.2,\\,65.0,\\,77.6,\\,86.4]$\n\n- 测试用例3（$P_{50}$附近斜率陡峭）：\n  - $P = [-0.5,\\,-1.0,\\,-1.2,\\,-1.5,\\,-1.8,\\,-2.0,\\,-2.5]$\n  - $\\mathrm{PLC}_{\\text{obs}} = [2.2,\\,11.4,\\,24.6,\\,49.1,\\,77.3,\\,88.6,\\,97.8]$\n\n计算和输出要求：\n- 根据上述指定，对每个数据集在高斯误差模型下实施最大似然估计。使用一个数值稳定的非线性最小二乘例程，并设定合理的边界以强制$a>0$。\n- 对每个测试用例，计算并报告列表$[\\hat{a},\\,\\widehat{P}_{50},\\,\\mathrm{SE}(\\hat{a}),\\,\\mathrm{SE}(\\widehat{P}_{50}),\\,\\hat{\\sigma}]$，其中$\\mathrm{SE}(\\cdot)$是从$\\widehat{\\mathrm{Cov}}(\\hat{\\theta})$派生的标准误，$\\hat{\\sigma}$是PLC百分点的最大似然估计。\n- 将所有报告的浮点数四舍五入到$3$位小数。将$a$解释为$\\mathrm{MPa}^{-1}$单位，$P_{50}$解释为$\\mathrm{MPa}$单位，$\\hat{\\sigma}$解释为PLC百分点单位。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为逗号分隔的Python风格列表的列表，例如：$[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],[x_{31},x_{32},x_{33},x_{34},x_{35}]]$，其中每个$x_{ij}$是如上所述四舍五入到$3$位小数的浮点数。", "solution": "该问题陈述已经过评估，并被确定为有效。它具有科学依据，提法明确，客观，并为获得唯一解提供了所有必要的信息。该任务是统计建模和数据分析中的一个标准问题，具体来说是非线性回归，应用于植物生理学中一个成熟的唯象模型。\n\n目标是估计木质部对空穴化引起的水力失效的脆弱性逻辑斯谛模型的参数。导水率损失百分比$\\mathrm{PLC}$被建模为木质部压力$P$（单位为$\\mathrm{MPa}$）的函数，使用以下方程：\n$$\n\\mathrm{PLC}(P; a, P_{50}) = \\frac{100}{1 + \\exp\\big(a(P - P_{50})\\big)}\n$$\n这里，$a$是一个斜率参数（单位为$\\mathrm{MPa}^{-1}$），量化了对压力变化的脆弱性，$P_{50}$是损失50%导水率时的压力。我们获得了观测数据集$\\{(P_i, y_i)\\}_{i=1}^n$，其中$y_i$是测量的$\\mathrm{PLC}$值。\n\n统计模型假设观测值$y_i$是真实模型值加上独立同分布的高斯噪声：\n$$\ny_i = \\mathrm{PLC}(P_i; a, P_{50}) + \\varepsilon_i, \\quad \\text{其中} \\quad \\varepsilon_i \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0, \\sigma^2)\n$$\n在此假设下，参数$(a, P_{50})$的最大似然估计（MLE）等同于最小化残差平方和（SSR）：\n$$\n\\mathrm{SSR}(a, P_{50}) = \\sum_{i=1}^n \\big(y_i - \\mathrm{PLC}(P_i; a, P_{50})\\big)^2\n$$\n这是一个非线性最小二乘（NLLS）问题。误差方差$\\sigma^2$的MLE由$\\hat{\\sigma}^2 = \\mathrm{SSR}(\\hat{a}, \\widehat{P}_{50})/n$给出，其中$(\\hat{a}, \\widehat{P}_{50})$是NLLS估计值，$n$是数据点的数量。\n\n参数估计$(\\hat{a}, \\widehat{P}_{50})$的不确定性由其标准误来表征。这些标准误源自估计的协方差矩阵，根据最大似然理论，该矩阵是观测Fisher信息矩阵的逆。对于指定的高斯模型，这简化为：\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) = \\hat{\\sigma}^2 (J^\\top J)^{-1}\n$$\n其中$\\hat{\\theta} = (\\hat{a}, \\widehat{P}_{50})^\\top$，$J$是模型函数关于参数的$n \\times 2$雅可比矩阵，在MLE处求值。雅可比矩阵的元素由偏导数给出：\n$$\nJ_{i,1} = \\frac{\\partial \\mathrm{PLC}(P_i; a, P_{50})}{\\partial a} \\quad \\text{和} \\quad J_{i,2} = \\frac{\\partial \\mathrm{PLC}(P_i; a, P_{50})}{\\partial P_{50}}\n$$\n问题提供了这些导数的解析形式，这对于稳定而准确地计算雅可比矩阵至关重要：\n$$\n\\frac{\\partial \\mathrm{PLC}}{\\partial a} = -100 \\frac{(P_i-P_{50})E_i}{(1+E_i)^2}, \\quad \\frac{\\partial \\mathrm{PLC}}{\\partial P_{50}} = 100 \\frac{a E_i}{(1+E_i)^2}\n$$\n其中$E_i = \\exp(a(P_i - P_{50}))$。标准误$\\mathrm{SE}(\\hat{a})$和$\\mathrm{SE}(\\widehat{P}_{50})$是协方差矩阵$\\widehat{\\mathrm{Cov}}(\\hat{\\theta})$对角线元素的平方根。\n\n解决方案在Python中实现，使用了专为此类NLLS问题设计的`scipy.optimize.least_squares`函数。对每个数据集的实现过程如下：\n1.  **生成初始猜测值**：一个稳健的参数初始猜测值对于NLLS算法的收敛至关重要。我们通过在数据集中找到观测$\\mathrm{PLC}$值$y_i$最接近50的压力$P_i$来估计初始$P_{50}$。然后，初始斜率参数$a$根据该点周围数据的局部斜率估计得出，使用在$P=P_{50}$处求值的关系式$a \\approx -(\\Delta y / \\Delta P) / 25$。\n2.  **非线性最小二乘优化**：调用`least_squares`来找到最小化残差平方和的参数值$(\\hat{a}, \\widehat{P}_{50})$。为提高性能和准确性，向函数提供了解析雅可比矩阵。根据模型的物理释义，强制执行$a > 0$的下界。\n3.  **估计$\\sigma$**：获得最优参数后，计算残差平方和$\\mathrm{SSR}$。然后，$\\sigma$的MLE计算为$\\hat{\\sigma} = \\sqrt{\\mathrm{SSR}/n}$。\n4.  **不确定性量化**：`least_squares`例程提供了解处的雅可比矩阵$J$。协方差矩阵使用公式$\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) = \\hat{\\sigma}^2 (J^\\top J)^{-1}$计算。然后，标准误被提取为该矩阵对角线元素的平方根。\n5.  **结果汇总**：计算出的估计值$[\\hat{a}, \\widehat{P}_{50}, \\mathrm{SE}(\\hat{a}), \\mathrm{SE}(\\widehat{P}_{50}), \\hat{\\sigma}]$四舍五入到三位小数，并收集起来用于最终输出。\n\n此过程系统地应用于所有三个提供的测试用例，从而得出所需的参数估计及其不确定性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Performs Maximum Likelihood Estimation for xylem vulnerability curve parameters.\n    The problem is solved by non-linear least squares, as it is equivalent to MLE\n    for a model with additive Gaussian errors.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test case 1 (typical vulnerability)\",\n            \"P\": np.array([-0.5, -1.0, -1.5, -2.0, -2.5, -3.0, -3.5]),\n            \"PLC_obs\": np.array([8.5, 17.1, 30.2, 50.7, 69.4, 82.3, 91.2])\n        },\n        {\n            \"name\": \"Test case 2 (shallow slope)\",\n            \"P\": np.array([-0.2, -1.0, -2.0, -3.0, -4.0, -5.0, -6.0]),\n            \"PLC_obs\": np.array([16.1, 22.6, 35.7, 49.2, 65.0, 77.6, 86.4])\n        },\n        {\n            \"name\": \"Test case 3 (steep slope near P50)\",\n            \"P\": np.array([-0.5, -1.0, -1.2, -1.5, -1.8, -2.0, -2.5]),\n            \"PLC_obs\": np.array([2.2, 11.4, 24.6, 49.1, 77.3, 88.6, 97.8])\n        }\n    ]\n\n    all_results = []\n\n    # Model function for Percent Loss of Conductivity (PLC)\n    def plc_model(params, P):\n        a, P50 = params\n        return 100.0 / (1.0 + np.exp(a * (P - P50)))\n\n    # Function to compute the vector of residuals\n    def residuals(params, P, y):\n        return plc_model(params, P) - y\n\n    # Function to compute the Jacobian matrix of the model function\n    def jacobian(params, P, y):\n        a, P50 = params\n        E = np.exp(a * (P - P50))\n        D = (1.0 + E)**2\n        \n        # Partial derivative with respect to 'a'\n        jac_a = -100.0 * (P - P50) * E / D\n        # Partial derivative with respect to 'P50'\n        jac_p50 = 100.0 * a * E / D\n        \n        # The jacobian of the residuals is the same as for the model\n        return np.array([jac_a, jac_p50]).T\n\n    for case in test_cases:\n        P_obs = case[\"P\"]\n        y_obs = case[\"PLC_obs\"]\n        n = len(P_obs)\n\n        # ---- Generate robust initial guesses for parameters ----\n        # Initial guess for P50: pressure where observed PLC is closest to 50\n        p50_idx = np.abs(y_obs - 50.0).argmin()\n        p50_0 = P_obs[p50_idx]\n        \n        # Initial guess for 'a' from the slope around P50\n        # a is related to the derivative at P50: d(PLC)/dP = -25*a\n        a_0 = 2.0  # Default reasonable guess\n        if 0  p50_idx  n - 1:\n            # Use centered difference for slope\n            dy_dp = (y_obs[p50_idx + 1] - y_obs[p50_idx - 1]) / (P_obs[p50_idx + 1] - P_obs[p50_idx - 1])\n            # Ensure slope is negative, as expected\n            if dy_dp  0:\n                a_0 = -dy_dp / 25.0\n        \n        if a_0 = 0: # Fallback if calculation fails or gives non-positive result\n            a_0 = 2.0\n\n        initial_params = [a_0, p50_0]\n\n        # Define bounds for parameters: a > 0\n        bounds = ([1e-9, -np.inf], [np.inf, np.inf])\n\n        # ---- Perform non-linear least squares optimization ----\n        fit_result = least_squares(\n            residuals,\n            initial_params,\n            jac=jacobian,\n            bounds=bounds,\n            args=(P_obs, y_obs),\n            method='trf'\n        )\n        \n        a_hat, p50_hat = fit_result.x\n\n        # ---- Calculate parameter uncertainties ----\n        # Sum of Squared Residuals (SSR)\n        ssr = np.sum(fit_result.fun**2)\n        \n        # Maximum Likelihood Estimate for sigma\n        sigma_hat = np.sqrt(ssr / n)\n        \n        # Jacobian at the solution\n        J = fit_result.jac\n        \n        # Covariance matrix from observed Fisher Information\n        # Cov = sigma_hat^2 * (J^T J)^-1\n        try:\n            cov_matrix = (sigma_hat**2) * np.linalg.inv(J.T @ J)\n            se_a = np.sqrt(cov_matrix[0, 0])\n            se_p50 = np.sqrt(cov_matrix[1, 1])\n        except np.linalg.LinAlgError:\n            # Handle cases where Jacobian is singular\n            se_a, se_p50 = np.nan, np.nan\n        \n        # ---- Collect and format results ----\n        case_results = [a_hat, p50_hat, se_a, se_p50, sigma_hat]\n        rounded_results = [round(v, 3) for v in case_results]\n        all_results.append(rounded_results)\n\n    # Final print statement in the exact required format.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "2624104"}]}