{"hands_on_practices": [{"introduction": "嗅觉系统的第一步是将化学信号转化为电信号。这个练习将带你深入嗅觉受体神经元的纤毛，通过计算来模拟这一关键过程[@problem_id:2572684]。你将运用希尔方程（Hill equation）来描述环核苷酸门控（CNG）通道的协同开放，并将开放概率与通过细胞膜的离子电流联系起来，从而亲手量化嗅觉信号转导的基础机制。", "problem": "一个嗅觉感受器神经元在其纤毛膜上表达环核苷酸门控 (CNG) 阳离子通道。胞质环磷酸腺苷 (cAMP) 的结合以正协同性促进通道开放。假设在稳态下，处于开放状态的通道比例根据协同关系依赖于 cAMP，该关系由希尔系数 $n$ 和半激活浓度 $K$ 表征，这与配体门控通道中的经验性剂量-反应行为一致。膜电位为 $V_{m}$，CNG 通道反转电位为 $E_{\\mathrm{rev}}$。当所有通道都开放时，膜片的宏观电导为 $g_{\\max}$，稳态宏观电流遵循弦电导关系。\n\n仅使用 (i) 质量作用定律和协同结合的概念来证明稳态开放概率作为配体浓度函数的希尔型形式的合理性，以及 (ii) 用于通道离子电流的欧姆定律，推导出稳态宏观电流作为给定参数的函数表达式，并对以下数值进行数值计算：\n- 希尔系数 $n = 2$，\n- 半激活浓度 $K = 5 \\ \\mu\\mathrm{M}$，\n- 胞质 cAMP 浓度 $[\\mathrm{cAMP}] = 10 \\ \\mu\\mathrm{M}$，\n- 膜电位 $V_{m} = -65 \\ \\mathrm{mV}$，\n- 通道反转电位 $E_{\\mathrm{rev}} = 0 \\ \\mathrm{mV}$，\n- 最大宏观电导 $g_{\\max} = 2.0 \\ \\mathrm{nS}$。\n\n以皮安 (pA) 为单位报告稳态宏观电流（附带其电生理学符号，其中内向正电荷对应于负电流）。将最终数值答案四舍五入至三位有效数字。以 $\\mathrm{pA}$ 为单位表示最终电流。", "solution": "所述问题需要进行验证。\n\n步骤1：提取给定信息。\n- 系统是一个带有环核苷酸门控 (CNG) 阳离子通道的嗅觉感受器神经元。\n- 激活配体是胞质环磷酸腺苷 (cAMP)。\n- 开放概率 $P_o$ 遵循一个由希尔系数 $n$ 和半激活浓度 $K$ 描述的协同关系，该关系由希尔方程描述。该形式需通过质量作用定律和协同结合来证明其合理性。\n- 稳态宏观电流 $I$ 遵循弦电导关系（通道的欧姆定律）。\n- 膜电位为 $V_{m}$。\n- CNG 通道反转电位为 $E_{\\mathrm{rev}}$。\n- 最大宏观电导为 $g_{\\max}$。\n- 提供的数值为：\n  - $n = 2$\n  - $K = 5 \\ \\mu\\mathrm{M}$\n  - $[\\mathrm{cAMP}] = 10 \\ \\mu\\mathrm{M}$\n  - $V_{m} = -65 \\ \\mathrm{mV}$\n  - $E_{\\mathrm{rev}} = 0 \\ \\mathrm{mV}$\n  - $g_{\\max} = 2.0 \\ \\mathrm{nS}$\n- 任务是推导稳态宏观电流的表达式，并以皮安 (pA) 为单位计算其值，结果四舍五入至三位有效数字。\n\n步骤2：使用提取的给定信息进行验证。\n- **科学依据：** 该问题基于生物物理学和神经生理学的既定原理。希尔方程是描述配体与受体和通道协同结合的标准模型。弦电导模型是欧姆定律在电生理学中的一个基本应用。所有概念在该领域都是标准的。\n- **适定性：** 该问题是适定的。它提供了所有必要的参数和一个明确的目标。变量之间的关系被明确陈述或为该领域的标准定义。可以确定一个唯一的、稳定的解。\n- **客观性：** 问题陈述使用精确、客观和科学的语言表述，没有任何主观性或模糊性。\n\n步骤3：结论与行动。\n问题有效。它在科学上是合理的、适定的和客观的。将推导出解答。\n\n解答按要求分为两部分进行：函数形式的推导和数值计算。\n\n首先，我们证明作为配体浓度函数（为了一般性，我们将其表示为 $[L]$，这里 $[L] = [\\mathrm{cAMP}]$）的开放概率 $P_o$ 的希尔方程形式的合理性。对于协同结合，其中 $n$ 个配体分子与一个通道 ($C$) 结合以诱导其开放状态 ($C_{open}$)，我们可以在稳态下以简化的、协同的方式表示整个反应：\n$$ nL + C_{closed} \\rightleftharpoons C_{open} $$\n应用质量作用定律，此反应的平衡解离常数 $K_d$ 为：\n$$ K_d = \\frac{[L]^n [C_{closed}]}{[C_{open}]} $$\n处于开放状态的通道的比例 $P_o$ 是开放通道浓度与总通道浓度 $[C_{total}] = [C_{closed}] + [C_{open}]$ 的比值。\n$$ P_o = \\frac{[C_{open}]}{[C_{total}]} = \\frac{[C_{open}]}{[C_{closed}] + [C_{open}]} $$\n根据 $K_d$ 的表达式，我们可以用 $[C_{open}]$ 来表示 $[C_{closed}]$：\n$$ [C_{closed}] = \\frac{K_d [C_{open}]}{[L]^n} $$\n将此代入 $P_o$ 的表达式中：\n$$ P_o = \\frac{[C_{open}]}{\\frac{K_d [C_{open}]}{[L]^n} + [C_{open}]} = \\frac{1}{\\frac{K_d}{[L]^n} + 1} = \\frac{[L]^n}{K_d + [L]^n} $$\n这就是希尔方程。半激活浓度 $K$ 被定义为响应达到半最大值时的配体浓度，即 $P_o = 1/2$。将 $[L] = K$ 代入推导出的表达式，我们得到：\n$$ \\frac{1}{2} = \\frac{K^n}{K_d + K^n} \\implies K_d + K^n = 2K^n \\implies K_d = K^n $$\n因此，通道处于开放状态的概率可以写成希尔系数 $n$、半激活浓度 $K$ 和配体浓度（本例中为 $[\\mathrm{cAMP}]$）的函数：\n$$ P_o([\\mathrm{cAMP}]) = \\frac{[\\mathrm{cAMP}]^n}{K^n + [\\mathrm{cAMP}]^n} $$\n这就证明了使用指定函数形式的合理性。\n\n其次，我们推导宏观电流 $I$ 的表达式。问题指出，电流遵循弦电导关系，这是欧姆定律的一种形式。膜片的总宏观电导 $G$ 是最大可能电导 $g_{\\max}$（当所有通道都开放时，即 $P_o=1$）与实际开放通道的比例 $P_o$ 的乘积。\n$$ G = g_{\\max} \\cdot P_o $$\n流经这些通道的离子电流 $I$ 由电导 $G$ 和电化学驱动力的乘积给出。驱动力是膜电位 $V_m$ 与承载电流的离子的反转电位 $E_{\\mathrm{rev}}$ 之差。\n$$ I = G(V_m - E_{\\mathrm{rev}}) $$\n根据电生理学的惯例，正电荷外流为正电流，正电荷内流为负电流。将 $G$ 和 $P_o$ 的表达式代入电流方程，我们得到稳态宏观电流的完整表达式：\n$$ I = g_{\\max} \\left( \\frac{[\\mathrm{cAMP}]^n}{K^n + [\\mathrm{cAMP}]^n} \\right) (V_m - E_{\\mathrm{rev}}) $$\n\n现在，我们使用提供的参数进行数值计算。\n给定值为：\n- $n = 2$\n- $K = 5 \\ \\mu\\mathrm{M}$\n- $[\\mathrm{cAMP}] = 10 \\ \\mu\\mathrm{M}$\n- $V_m = -65 \\ \\mathrm{mV} = -65 \\times 10^{-3} \\ \\mathrm{V}$\n- $E_{\\mathrm{rev}} = 0 \\ \\mathrm{mV} = 0 \\ \\mathrm{V}$\n- $g_{\\max} = 2.0 \\ \\mathrm{nS} = 2.0 \\times 10^{-9} \\ \\mathrm{S}$\n\n首先，我们计算开放概率 $P_o$：\n$$ P_o = \\frac{(10 \\ \\mu\\mathrm{M})^2}{(5 \\ \\mu\\mathrm{M})^2 + (10 \\ \\mu\\mathrm{M})^2} = \\frac{100}{25 + 100} = \\frac{100}{125} = \\frac{4}{5} = 0.8 $$\n开放概率是一个无量纲的量，正如预期。\n\n接下来，我们计算电流 $I$。保持单位一致非常重要。我们将使用伏特 (V)、西门子 (S) 和安培 (A)。\n$$ I = (2.0 \\times 10^{-9} \\ \\mathrm{S}) \\cdot (0.8) \\cdot (-65 \\times 10^{-3} \\ \\mathrm{V} - 0 \\ \\mathrm{V}) $$\n$$ I = (1.6 \\times 10^{-9} \\ \\mathrm{S}) \\cdot (-65 \\times 10^{-3} \\ \\mathrm{V}) $$\n$$ I = -104 \\times 10^{-12} \\ \\mathrm{A} $$\n问题要求以皮安 (pA) 为单位给出答案，其中 $1 \\ \\mathrm{pA} = 10^{-12} \\ \\mathrm{A}$。\n$$ I = -104 \\ \\mathrm{pA} $$\n值 $-104$ 有三位有效数字，因此无需进一步四舍五入。负号正确地表示了阳离子的内向电流，这对于驱动阳离子进入细胞的膜电位（$V_m  E_{\\mathrm{rev}}$）是预期的。", "answer": "$$\\boxed{-104}$$", "id": "2572684"}, {"introduction": "在现实世界中，我们很少闻到单一的气味分子，而是复杂的混合物。这个练习将指导你从第一性原理出发，构建一个模型来预测不同气味分子在嗅觉感受器上的竞争性结合[@problem_id:2572670]。通过编写程序，你将能够量化协同作用和拮抗作用，并理解为什么混合物的气味感知往往不是其各组分气味的简单相加。", "problem": "您的任务是编写一个完整的程序，用于预测在嗅觉受体的单个正构位点上，气味剂混合物在竞争性结合下的受体激活情况。请您基于经典质量作用结合动力学和受体守恒的第一性原理构建解决方案，并定量预测受体水平上的非加和性。生物学假设如下：每个受体分子只有一个结合位点，配体竞争同一位点，且每种配体在结合时都具有一个按比例缩放激活程度的内在效能。假设这是一个没有协同性且处于热力学平衡状态的G蛋白偶联受体（GPCR）。仅从以下基本原理出发，不引入任何额外的简化公式：(i) 每种配体 $L_i$ 与受体 $R$ 的可逆结合反应，记为 $R + L_i \\rightleftharpoons RL_i$；(ii) 平衡状态下解离常数 $K_i$ 的定义为 $K_i = \\dfrac{[R][L_i]}{[RL_i]}$；以及 (iii) 受体守恒，$R_T = [R] + \\sum_i [RL_i]$，其中 $R_T$ 为常数。将分数响应定义为所有结合复合物的加和，并按各自的内在效能进行加权。您的程序必须为每个测试用例计算三个量：混合物响应、作为各个单配体响应之和计算的朴素加和期望，以及混合物响应与朴素加和期望之间的差值，所有结果均表示为无量纲小数。\n\n具体来说，对于包含两种配体 $L_A$ 和 $L_B$ 的混合物，其浓度分别为 $[L_A]$ 和 $[L_B]$（单位 $\\mu$M），解离常数分别为 $K_A$ 和 $K_B$（单位 $\\mu$M），内在效能分别为 $\\alpha_A$ 和 $\\alpha_B$（无量纲），请从上述基本原理推导出一个算法来计算：\n- 无量纲的稳态混合物响应 $E_{\\mathrm{mix}}$，\n- 无量纲的朴素加和期望 $E_{\\mathrm{add}}$，其通过将每种配体在给定浓度下单次施用时的响应相加得到，以及\n- 无量纲的差值 $\\Delta = E_{\\mathrm{mix}} - E_{\\mathrm{add}}$。\n\n注释和约束：\n- 将内在效能 $\\alpha_i$ 视为一个标量乘数，与配体 $i$ 的分数占据率相乘以产生响应贡献。\n- 所有浓度 $[L_i]$ 和解离常数 $K_i$ 均为正实数，单位为 $\\mu$M。内在效能 $\\alpha_i$ 满足 $0 \\le \\alpha_i \\le 1$。内在效能为 $0$ 表示一个没有内在激活作用的纯竞争性拮抗剂。\n- 输出 $E_{\\mathrm{mix}}$、$E_{\\mathrm{add}}$ 和 $\\Delta$ 是无单位的，并且必须表示为小数点后保留 $6$ 位的小数。\n\n测试套件：\n为以下每组参数计算上述三个输出，其中每个元组为 $\\big([L_A], [L_B], K_A, K_B, \\alpha_A, \\alpha_B\\big)$：\n1. $\\big(30, 20, 10, 25, 1.0, 0.6\\big)$\n2. $\\big(0, 50, 10, 20, 1.0, 0.7\\big)$\n3. $\\big(40, 100, 10, 5, 1.0, 0.0\\big)$\n4. $\\big(1000, 1000, 10, 10, 1.0, 0.5\\big)$\n5. $\\big(5, 200, 50, 400, 0.8, 0.3\\big)$\n\n测试套件中所有浓度和解离常数的单位均为 $\\mu$M。程序必须计算并报告每个测试用例的三个输出，形式为一个包含三个四舍五入后的小数的列表 $[E_{\\mathrm{mix}}, E_{\\mathrm{add}}, \\Delta]$。\n\n最终输出规范：\n您的程序应生成单行输出，其中包含所有五个测试用例的结果，形式为一个用方括号括起来的逗号分隔列表，其中每个元素是对应一个测试用例的三项列表。例如：$[[e_{11},e_{12},e_{13}],[e_{21},e_{22},e_{23}],\\dots]$。输出中的每个小数都必须四舍五入到小数点后 $6$ 位。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于质量作用动力学和受体理论的经典原理，问题陈述是良构的，提供了所有必要信息，并使用客观、明确的语言进行阐述。因此，我们可以继续进行推导和求解。\n\n任务是从第一性原理出发，为两种竞争性配体 $L_A$ 和 $L_B$ 的混合物所引起的嗅觉受体响应建立一个定量模型。\n\n提供的基本原理如下：\n1. 每种配体 $L_i$ 与受体 $R$ 的可逆结合平衡：$R + L_i \\rightleftharpoons RL_i$。\n2. 解离常数 $K_i$ 由平衡时的质量作用定律定义：$K_i = \\dfrac{[R][L_i]}{[RL_i]}$。\n3. 受体总浓度 $R_T$ 守恒：$R_T = [R] + \\sum_i [RL_i]$。\n\n对于一个包含两种配体 $L_A$ 和 $L_B$ 的系统，守恒方程为：\n$$R_T = [R] + [RL_A] + [RL_B]$$\n其中 $[R]$ 是游离受体的浓度，$[RL_A]$ 和 $[RL_B]$ 是受体-配体复合物的浓度。\n\n根据解离常数 $K_A$ 和 $K_B$ 的定义，我们可以用游离受体浓度 $[R]$ 和配体浓度 $[L_A]$、$L_B]$ 来表示结合复合物的浓度：\n$$[RL_A] = \\frac{[R][L_A]}{K_A}$$\n$$[RL_B] = \\frac{[R][L_B]}{K_B}$$\n\n将这些表达式代入受体守恒方程，可以解出 $[R]$：\n$$R_T = [R] + \\frac{[R][L_A]}{K_A} + \\frac{[R][L_B]}{K_B} = [R] \\left( 1 + \\frac{[L_A]}{K_A} + \\frac{[L_B]}{K_B} \\right)$$\n因此，游离受体的浓度为：\n$$[R] = \\frac{R_T}{1 + \\frac{[L_A]}{K_A} + \\frac{[L_B]}{K_B}}$$\n\n我们感兴趣的是每种配体对受体的分数占据率，定义为 $f_A = \\frac{[RL_A]}{R_T}$ 和 $f_B = \\frac{[RL_B]}{R_T}$。将 $[R]$ 的表达式代回到 $[RL_A]$ 和 $[RL_B]$ 的方程中，并除以 $R_T$，得到：\n$$f_A = \\frac{[RL_A]}{R_T} = \\frac{\\frac{[L_A]}{K_A}}{1 + \\frac{[L_A]}{K_A} + \\frac{[L_B]}{K_B}}$$\n$$f_B = \\frac{[RL_B]}{R_T} = \\frac{\\frac{[L_B]}{K_B}}{1 + \\frac{[L_A]}{K_A} + \\frac{[L_B]}{K_B}}$$\n\n混合物的总无量纲响应 $E_{\\mathrm{mix}}$ 定义为分数占据率的总和，每个占据率都由其各自的内在效能 $\\alpha_A$ 或 $\\alpha_B$ 加权。这表示总激活量占理论最大值（所有受体均被效能为1的完全激动剂结合）的比例。\n$$E_{\\mathrm{mix}} = \\alpha_A f_A + \\alpha_B f_B$$\n代入 $f_A$ 和 $f_B$ 的表达式：\n$$E_{\\mathrm{mix}} = \\frac{\\alpha_A \\frac{[L_A]}{K_A} + \\alpha_B \\frac{[L_B]}{K_B}}{1 + \\frac{[L_A]}{K_A} + \\frac{[L_B]}{K_B}}$$\n这个方程是Gaddum方程的一种形式，它正确地模拟了对两种竞争性配体的响应。\n\n接下来，我们必须计算朴素加和期望 $E_{\\mathrm{add}}$。它被定义为，如果每种配体都以其指定浓度单独施用时所观察到的响应之和。\n\n对于单独的配体 $L_A$（其中 $[L_B] = 0$），响应 $E_A$ 由单配体结合模型（Hill-Langmuir方程）乘以效能给出：\n$$E_A = \\frac{\\alpha_A \\frac{[L_A]}{K_A}}{1 + \\frac{[L_A]}{K_A}}$$\n\n同样，对于单独的配体 $L_B$（其中 $[L_A] = 0$），响应 $E_B$ 为：\n$$E_B = \\frac{\\alpha_B \\frac{[L_B]}{K_B}}{1 + \\frac{[L_B]}{K_B}}$$\n\n朴素加和期望是简单的求和：\n$$E_{\\mathrm{add}} = E_A + E_B = \\frac{\\alpha_A \\frac{[L_A]}{K_A}}{1 + \\frac{[L_A]}{K_A}} + \\frac{\\alpha_B \\frac{[L_B]}{K_B}}{1 + \\frac{[L_B]}{K_B}}$$\n这种期望在物理上是不正确的，因为它忽略了结合的竞争性，隐含地假设了两种配体作用于独立的受体群体。\n\n最后，差值 $\\Delta$ 量化了由同一结合位点的竞争所产生的非加和性：\n$$\\Delta = E_{\\mathrm{mix}} - E_{\\mathrm{add}}$$\n$\\Delta$ 的负值表示亚加和性或拮抗作用，这是竞争性结合的预期结果。\n\n为了简化实现，我们定义归一化浓度 $x_A = \\frac{[L_A]}{K_A}$ 和 $x_B = \\frac{[L_B]}{K_B}$。所需量由以下方程组给出：\n$$E_{\\mathrm{mix}} = \\frac{\\alpha_A x_A + \\alpha_B x_B}{1 + x_A + x_B}$$\n$$E_{\\mathrm{add}} = \\frac{\\alpha_A x_A}{1 + x_A} + \\frac{\\alpha_B x_B}{1 + x_B}$$\n$$\\Delta = E_{\\mathrm{mix}} - E_{\\mathrm{add}}$$\n\n这些公式用于在最终程序中构建算法，以计算所提供测试用例的所需值。每个数值结果都必须四舍五入到小数点后 $6$ 位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes olfactory receptor activation by an odorant mixture based on \n    the principles of competitive binding kinetics at a single receptor site.\n    \"\"\"\n    \n    # Each tuple contains: ([L_A], [L_B], K_A, K_B, alpha_A, alpha_B)\n    # Units are uM for concentrations and dissociation constants.\n    # Efficacies are dimensionless.\n    test_cases = [\n        (30.0, 20.0, 10.0, 25.0, 1.0, 0.6),\n        (0.0, 50.0, 10.0, 20.0, 1.0, 0.7),\n        (40.0, 100.0, 10.0, 5.0, 1.0, 0.0),\n        (1000.0, 1000.0, 10.0, 10.0, 1.0, 0.5),\n        (5.0, 200.0, 50.0, 400.0, 0.8, 0.3),\n    ]\n\n    def calculate_response(params):\n        \"\"\"\n        Calculates the mixture response (E_mix), the naive additive\n        expectation (E_add), and the difference (Delta) for a given set\n        of parameters based on the derived model.\n\n        Args:\n            params (tuple): A tuple containing L_A, L_B, K_A, K_B, alpha_A, alpha_B.\n\n        Returns:\n            list: A list containing the three computed values [E_mix, E_add, Delta].\n        \"\"\"\n        L_A, L_B, K_A, K_B, alpha_A, alpha_B = params\n        \n        # Calculate normalized concentrations (concentration / dissociation constant).\n        # Per problem constraints, K_A and K_B are positive real numbers, so no\n        # division by zero will occur.\n        x_A = L_A / K_A\n        x_B = L_B / K_B\n\n        # 1. Mixture Response (E_mix)\n        # This is derived from first principles of competitive binding kinetics.\n        numerator_mix = alpha_A * x_A + alpha_B * x_B\n        denominator_mix = 1.0 + x_A + x_B\n        E_mix = numerator_mix / denominator_mix\n\n        # 2. Naive Additive Expectation (E_add)\n        # Calculated as the sum of individual responses, which incorrectly\n        # ignores the competition for the binding site.\n        E_A_alone = (alpha_A * x_A) / (1.0 + x_A)\n        E_B_alone = (alpha_B * x_B) / (1.0 + x_B)\n        E_add = E_A_alone + E_B_alone\n\n        # 3. Difference (Delta)\n        # This value quantifies the non-additive effect of competition.\n        Delta = E_mix - E_add\n        \n        return [E_mix, E_add, Delta]\n\n    results = []\n    for case in test_cases:\n        result = calculate_response(case)\n        results.append(result)\n\n    # Format the final output string as a list of lists. Each numerical value\n    # must be expressed as a decimal rounded to 6 places after the decimal point.\n    # The f-string formatting \"{val:.6f}\" handles this rounding requirement correctly.\n    formatted_results = []\n    for res in results:\n        formatted_list = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        formatted_results.append(formatted_list)\n        \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2572670"}, {"introduction": "从感受器激活到最终的知觉体验，信号是如何被编码和解读的？这个练习将让你扮演心理物理学家的角色，运用史蒂文斯幂定律（Stevens' power law, $I = k S^n$）来拟合味觉感知的实验数据[@problem_id:2572673]。通过对幂指数 $n$ 的计算和分类，你将学会如何从宏观的感知数据中推断出底层生物转导过程的非线性特征，如压缩性或扩张性响应。", "problem": "要求您实现并应用一个有理论依据的估计器，用于估计 Stevens 幂律中的指数，并将其应用于味觉强度数据，同时用非线性转导的术语来形式化对该指数的解释。Stevens 幂律假设感知强度与刺激的关系为 $I = k S^n$，其中 $I$ 是感知强度（单位为任意单位，a.u.），$S$ 是刺激浓度（单位为任意单位，a.u.），$k \\gt 0$ 是一个增益因子，$n$ 是一个反映转导非线性的无量纲指数。仅使用以下基本事实和定义：(i) 对数定律，特别是对于 $a,b \\gt 0$，有 $\\ln(ab) = \\ln a + \\ln b$ 和 $\\ln(a^b) = b \\ln a$；(ii) 通过普通最小二乘法 (OLS) 拟合直线 $y = a + b x$ 会最小化残差平方和，并得到唯一能使残差平方和最小化的斜率 $b$ 和截距 $a$。\n\n您的程序必须：\n- 通过变换 $x = \\ln S$，$y = \\ln I$ 对 $I = k S^n$ 进行线性化，实现指数 $n$ 和增益 $k$ 的 OLS 估计器，从而使 $\\ln I = \\ln k + n \\ln S$ 变为 $y = a + n x$，其中 $a = \\ln k$。\n- 使用自然对数 $\\ln$。\n- 返回每个数据集的指数 $n$，四舍五入到三位小数。\n- 此外，使用容差 $\\tau = 0.05$ 的规则对感觉模式的非线性进行分类：如果 $|n - 1| \\le \\tau$，标记为“近线性”；如果 $n \\gt 1 + \\tau$，标记为“扩张性”；如果 $n \\lt 1 - \\tau$，标记为“压缩性”。将这些类别编码为整数：近线性 $\\to 0$，扩张性 $\\to 1$，压缩性 $\\to -1$。\n\n测试套件。使用以下四个数据集，它们代表了不同的味觉模式或参考行为。在所有情况下，强度均由 $I = k S^n$ 定义，不添加噪声以隔离映射关系。所有的 $S$ 和 $I$ 都以任意单位 (a.u.) 表示。\n\n1) 甜味（超线性典型）：$k = 0.9$，$n = 1.35$，刺激向量 $S = [0.02, 0.05, 0.1, 0.2, 0.5]$。\n2) 咸味（近线性典型）：$k = 1.1$，$n = 0.95$，刺激向量 $S = [0.03, 0.06, 0.12, 0.24, 0.48]$。\n3) 苦味（低浓度下的压缩性典型）：$k = 0.7$，$n = 0.6$，刺激向量 $S = [0.0001, 0.0003, 0.001, 0.003, 0.01]$。\n4) 参考线性转导器（边界情况）：$k = 1.0$，$n = 1.0$，刺激向量 $S = [0.2, 1.0, 5.0]$。\n\n对于每个数据集，使用 $I = k S^n$ 精确构造 $I$。\n\n估计器的数学规范。对于每个具有样本 $\\{(S_i, I_i)\\}_{i=1}^N$ 且 $S_i \\gt 0$ 和 $I_i \\gt 0$ 的数据集，定义 $x_i = \\ln S_i$ 和 $y_i = \\ln I_i$。令 $\\bar{x} = \\frac{1}{N}\\sum_{i=1}^N x_i$ 且 $\\bar{y} = \\frac{1}{N}\\sum_{i=1}^N y_i$。OLS 斜率为\n$$\nn = \\frac{\\sum_{i=1}^N (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^N (x_i - \\bar{x})^2},\n$$\n截距为\n$$\na = \\bar{y} - n \\bar{x},\n$$\n从而得到 $k = e^a$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含：\n- 数据集 1-4 的四个拟合指数 $n$，每个都四舍五入到三位小数并表示为浮点数。\n- 使用上述容差规则得到的数据集 1-4 的四个整类别码。\n\n因此，最终输出应如下所示：$[n_1,n_2,n_3,n_4,c_1,c_2,c_3,c_4]$，其中 $n_j$ 是具有三位小数的浮点数，且 $c_j \\in \\{-1,0,1\\}$。\n\n角度单位不适用。无需进行物理单位转换，因为所有量都以任意单位 (a.u.) 表示。答案是按规定格式的无量纲浮点数和整数。\n\n您的程序必须硬编码上述测试套件，且不得读取任何输入。\n\n科学解释（不作为打印输出的一部分）应将 $n$ 的符号和大小与底层的受体和通道转导非线性联系起来：压缩性 ($n \\lt 1$) 与饱和结合或下游适应/压缩相符；扩张性 ($n \\gt 1$) 可能源于协同过程或阈值募集；近线性 ($n \\approx 1$) 表示在测试范围内的成比例转导。", "solution": "从 Stevens 幂律 $I = k S^n$ 开始，其中 $I \\gt 0$，$S \\gt 0$，$k \\gt 0$ 且 $n \\in \\mathbb{R}$。应用自然对数。使用 $\\ln(a^b) = b \\ln a$ 和 $\\ln(ab) = \\ln a + \\ln b$，我们得到\n$$\n\\ln I = \\ln(k S^n) = \\ln k + \\ln(S^n) = \\ln k + n \\ln S.\n$$\n定义 $x = \\ln S$ 和 $y = \\ln I$。模型变为 $y = a + n x$，其中 $a = \\ln k$。因此，估计 $n$ 的问题简化为通过普通最小二乘法 (OLS) 对 $(x_i, y_i)$ 进行直线拟合。对于 $N$ 个配对样本 $(S_i, I_i)$，$x_i = \\ln S_i$，$y_i = \\ln I_i$，以及均值 $\\bar{x} = \\frac{1}{N}\\sum_{i=1}^N x_i$，$\\bar{y} = \\frac{1}{N}\\sum_{i=1}^N y_i$，OLS 斜率为\n$$\nn = \\frac{\\sum_{i=1}^N (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^N (x_i - \\bar{x})^2},\n$$\n截距为\n$$\na = \\bar{y} - n \\bar{x}.\n$$\n于是 $k = e^a$。\n\n估计器的算法设计：\n1. 对于每个数据集，按规定计算 $I_i = k S_i^n$（无噪声），然后计算 $x_i = \\ln S_i$ 和 $y_i = \\ln I_i$。\n2. 计算 $\\bar{x}$ 和 $\\bar{y}$，然后计算斜率公式的分子和分母。结果即为拟合指数 $\\hat{n}$，以及 $\\hat{a} = \\bar{y} - \\hat{n}\\bar{x}$，其中 $\\hat{k} = e^{\\hat{a}}$。\n3. 为便于报告，将 $\\hat{n}$ 四舍五入到三位小数。\n4. 使用容差 $\\tau = 0.05$ 进行分类：\n   - 如果 $|\\hat{n} - 1| \\le \\tau$，类别 $= 0$（近线性）。\n   - 如果 $\\hat{n} \\gt 1 + \\tau$，类别 $= 1$（扩张性）。\n   - 如果 $\\hat{n} \\lt 1 - \\tau$，类别 $= -1$（压缩性）。\n\n因为所提供的数据集是根据固定的 $k$ 和 $n$ 从 $I = k S^n$ 精确生成的，所以在 $\\ln$–$\\ln$ 坐标系上的 OLS 拟合可以恢复出达到数值精度的真实 $n$ 值，这与 $S$ 值的采样无关，只要至少有两个不同的 $S$ 值即可。\n\n应用于测试套件：\n\n1) 甜味：$k = 0.9$，$n = 1.35$，$S = [0.02, 0.05, 0.1, 0.2, 0.5]$。精确的对数线性关系得出 $\\hat{n} \\approx 1.35$。当 $\\tau = 0.05$ 时，$|\\hat{n} - 1| \\approx 0.35 \\gt 0.05$，且 $\\hat{n} \\gt 1 + \\tau$，因此类别 $= 1$（扩张性）。解释：扩张性非线性与多重受体-转导步骤中的协同激活或募集相符（例如，在工作范围内具有超线性增益的 G 蛋白偶联级联反应）。\n\n2) 咸味：$k = 1.1$，$n = 0.95$，$S = [0.03, 0.06, 0.12, 0.24, 0.48]$。精确拟合得出 $\\hat{n} \\approx 0.95$。当 $\\tau = 0.05$ 时，$|\\hat{n} - 1| = 0.05 \\le 0.05$，因此类别 $= 0$（近线性）。解释：近线性与离子通道介导的转导相符（例如，上皮钠通道），在测量范围内具有成比例的驱动。\n\n3) 苦味：$k = 0.7$，$n = 0.6$，$S = [0.0001, 0.0003, 0.001, 0.003, 0.01]$。精确拟合得出 $\\hat{n} \\approx 0.6$。由于 $\\hat{n} \\lt 1 - \\tau$，因此类别 $= -1$（压缩性）。解释：压缩性非线性可能源于饱和的受体结合、平行的抑制性反馈，或压缩动态范围的下游信号传导中的适应。\n\n4) 参考线性：$k = 1.0$，$n = 1.0$，$S = [0.2, 1.0, 5.0]$。精确拟合得出 $\\hat{n} \\approx 1.0$。当 $\\tau = 0.05$ 时，类别 $= 0$（近线性）。解释：比例转导器在测试范围内实现近似线性的映射。\n\n收集四舍五入后的指数和类别，预期输出为 $[1.350, 0.950, 0.600, 1.000, 1, 0, -1, 0]$。\n\n这种基于原则的程序将数学估计（通过对数线性化和 OLS）与生理学解释（将 $n$ 分类以反映采样范围内的压缩、线性或扩张转导）清晰地分离开来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fit_power_law_exponent(S, I):\n    \"\"\"\n    Fit Stevens' power law I = k * S^n by linearizing with natural logs.\n    Returns (n, k) where n is the exponent and k the gain.\n    \"\"\"\n    x = np.log(S)\n    y = np.log(I)\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n    # Compute OLS slope (n) and intercept (a)\n    numerator = np.sum((x - x_mean) * (y - y_mean))\n    denominator = np.sum((x - x_mean) ** 2)\n    # Handle potential degenerate case (should not occur with provided data)\n    if denominator == 0.0:\n        raise ValueError(\"Degenerate data: all S values identical in log-space.\")\n    n = numerator / denominator\n    a = y_mean - n * x_mean\n    k = np.exp(a)\n    return n, k\n\ndef classify_nonlinearity(n, tau=0.05):\n    \"\"\"\n    Classify exponent n using tolerance tau:\n    -1: compressive (n  1 - tau)\n     0: near-linear (|n - 1| = tau)\n     1: expansive (n > 1 + tau)\n    \"\"\"\n    if abs(n - 1.0) = tau:\n        return 0\n    elif n > 1.0 + tau:\n        return 1\n    else:\n        return -1\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (name, k, n_true, S_array)\n    test_cases = [\n        (\"sweet\", 0.9, 1.35, np.array([0.02, 0.05, 0.1, 0.2, 0.5], dtype=float)),\n        (\"salty\", 1.1, 0.95, np.array([0.03, 0.06, 0.12, 0.24, 0.48], dtype=float)),\n        (\"bitter\", 0.7, 0.6, np.array([1e-4, 3e-4, 1e-3, 3e-3, 1e-2], dtype=float)),\n        (\"reference_linear\", 1.0, 1.0, np.array([0.2, 1.0, 5.0], dtype=float)),\n    ]\n\n    # Construct I arrays exactly using I = k * S^n as specified (no noise).\n    results_exponents = []\n    results_classes = []\n    for _, k_true, n_true, S in test_cases:\n        I = k_true * (S ** n_true)\n        n_fit, k_fit = fit_power_law_exponent(S, I)\n        # Round exponent to three decimals for output\n        n_out = round(float(n_fit), 3)\n        results_exponents.append(f\"{n_out:.3f}\")\n        cls = classify_nonlinearity(n_fit, tau=0.05)\n        results_classes.append(str(int(cls)))\n\n    # Aggregate results: [n1,n2,n3,n4,c1,c2,c3,c4]\n    out_list = results_exponents + results_classes\n    print(f\"[{','.join(out_list)}]\")\n\nsolve()\n```", "id": "2572673"}]}