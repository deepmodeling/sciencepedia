{"hands_on_practices": [{"introduction": "理解机械力如何转化为离子通道的构象变化是体感机械转导的核心。热力学模型为此提供了强大的理论框架，它将膜张力（$\\gamma$）的变化与通道开放和关闭状态之间的自由能差（$\\Delta G$）联系起来。该练习 [@problem_id:2608950] 要求您应用玻尔兹曼分布，定量计算当膜张力增加时，机械敏感通道开放概率的变化，从而加深对这一基本生物物理原理的理解。", "problem": "某个体感神经元中的一个力敏离子通道，在温度 $T$ 下，其关闭和开放构象之间的两态平衡可以被很好地描述。开放态和关闭态之间的自由能差依赖于膜张力 $\\gamma$，其关系为 $\\Delta G(\\gamma)=\\Delta G_0-\\gamma\\,\\Delta A$，其中 $\\Delta A$ 是通道开放时平面内横截面积的增加量。在热平衡状态下，开放概率 $p_{\\mathrm{o}}$ 和关闭概率 $p_{\\mathrm{c}}$ 满足玻尔兹曼关系 $p_{\\mathrm{o}}/p_{\\mathrm{c}}=\\exp\\!\\left(-\\Delta G(\\gamma)/(k_B T)\\right)$，其中 $k_B$ 是玻尔兹曼常数。\n\n一项实验测量出，在基线膜张力 $\\gamma_1 = 1\\,\\text{mN/m}$ 时，开放概率为 $P_{\\mathrm{o}}(\\gamma_1)=0.12$。随后，膜张力被准静态地增加到 $\\gamma_2 = 4\\,\\text{mN/m}$。该通道的门控面积变化为 $\\Delta A = 12\\,\\text{nm}^2$，且样品处于 $T=300\\,\\text{K}$ 的温度下。使用 $k_B = 1.380\\,649\\times 10^{-23}\\,\\text{J/K}$。\n\n从两态玻尔兹曼平衡和膜张力对自由能的机械功贡献出发，计算开放概率的变化量 $\\Delta P_{\\mathrm{o}} = P_{\\mathrm{o}}(\\gamma_2) - P_{\\mathrm{o}}(\\gamma_1)$。将最终答案表示为一个无量纲的小数，并四舍五入到三位有效数字。不要使用百分号。", "solution": "该问题要求计算当膜张力增加时，一个力敏离子通道的开放概率的变化。该通道被描述为一个处于热平衡状态的两态（关闭和开放）系统。\n\n控制该系统的基本原理是：\n$1$. 通道处于开放态的概率 $P_{\\mathrm{o}}$ 和关闭态的概率 $P_{\\mathrm{c}}$ 之和必须为1，因为这是仅有的两种可用状态：\n$$P_{\\mathrm{o}} + P_{\\mathrm{c}} = 1$$\n$2$. 这些概率的比值由玻尔兹曼分布决定，该分布取决于开放态和关闭态之间的自由能差 $\\Delta G(\\gamma)$：\n$$\\frac{P_{\\mathrm{o}}}{P_{\\mathrm{c}}} = \\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)$$\n此处，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n根据第一条原理，我们可以写出 $P_{\\mathrm{c}} = 1 - P_{\\mathrm{o}}$。将其代入玻尔兹曼关系式，得到：\n$$\\frac{P_{\\mathrm{o}}}{1 - P_{\\mathrm{o}}} = \\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)$$\n对 $P_{\\mathrm{o}}(\\gamma)$ 求解，得到以下表达式，这是逻辑斯谛函数的一种形式：\n$$P_{\\mathrm{o}}(\\gamma) = \\frac{\\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)}{1 + \\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)} = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G(\\gamma)}{k_B T}\\right)}$$\n自由能差 $\\Delta G(\\gamma)$ 作为膜张力 $\\gamma$ 的函数给出：\n$$\\Delta G(\\gamma) = \\Delta G_0 - \\gamma \\Delta A$$\n其中 $\\Delta G_0$ 是零张力下的内在自由能差，而 $\\Delta A$ 是通道开放时其平面内面积的变化量。\n\n将 $\\Delta G(\\gamma)$ 的表达式代入 $P_{\\mathrm{o}}(\\gamma)$ 的方程中：\n$$P_{\\mathrm{o}}(\\gamma) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G_0 - \\gamma \\Delta A}{k_B T}\\right)}$$\n题目说明在基线张力 $\\gamma_1 = 1\\,\\text{mN/m}$ 时，开放概率为 $P_{\\mathrm{o}}(\\gamma_1) = 0.12$。这个信息可以用来确定未知量 $\\Delta G_0$，但更直接的方法是建立在两种不同张力 $\\gamma_1$ 和 $\\gamma_2$ 下概率之间的关系。\n\n从 $P_{\\mathrm{o}}(\\gamma)$ 的表达式中，我们可以分离出指数项：\n$$\\exp\\left(\\frac{\\Delta G(\\gamma)}{k_B T}\\right) = \\frac{1}{P_{\\mathrm{o}}(\\gamma)} - 1 = \\frac{1 - P_{\\mathrm{o}}(\\gamma)}{P_{\\mathrm{o}}(\\gamma)}$$\n让我们对两种张力 $\\gamma_1$ 和 $\\gamma_2$ 分别计算这个表达式：\n$$\\exp\\left(\\frac{\\Delta G_0 - \\gamma_1 \\Delta A}{k_B T}\\right) = \\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)}$$\n$$\\exp\\left(\\frac{\\Delta G_0 - \\gamma_2 \\Delta A}{k_B T}\\right) = \\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)}$$\n将第二个方程除以第一个方程可以消去未知数 $\\Delta G_0$：\n$$\\frac{\\exp\\left(\\frac{\\Delta G_0 - \\gamma_2 \\Delta A}{k_B T}\\right)}{\\exp\\left(\\frac{\\Delta G_0 - \\gamma_1 \\Delta A}{k_B T}\\right)} = \\frac{\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)}}{\\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)}}$$\n左侧化简为：\n$$\\exp\\left(\\frac{(\\Delta G_0 - \\gamma_2 \\Delta A) - (\\Delta G_0 - \\gamma_1 \\Delta A)}{k_B T}\\right) = \\exp\\left(-\\frac{(\\gamma_2 - \\gamma_1) \\Delta A}{k_B T}\\right)$$\n现在我们可以求解包含 $P_{\\mathrm{o}}(\\gamma_2)$ 的项：\n$$\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)} = \\left(\\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)}\\right) \\exp\\left(-\\frac{(\\gamma_2 - \\gamma_1) \\Delta A}{k_B T}\\right)$$\n我们已知以下数值：\n$P_{\\mathrm{o}}(\\gamma_1) = 0.12$\n$\\gamma_1 = 1\\,\\text{mN/m} = 1 \\times 10^{-3}\\,\\text{N/m}$\n$\\gamma_2 = 4\\,\\text{mN/m} = 4 \\times 10^{-3}\\,\\text{N/m}$\n$\\Delta A = 12\\,\\text{nm}^2 = 12 \\times (10^{-9}\\,\\text{m})^2 = 12 \\times 10^{-18}\\,\\text{m}^2$\n$T = 300\\,\\text{K}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\text{J/K}$\n\n首先，我们计算无量纲指数。分子是张力变化所做的机械功：\n$$(\\gamma_2 - \\gamma_1)\\Delta A = (4 \\times 10^{-3} - 1 \\times 10^{-3})\\,\\text{N/m} \\times (12 \\times 10^{-18}\\,\\text{m}^2) = (3 \\times 10^{-3}\\,\\text{N/m}) \\times (12 \\times 10^{-18}\\,\\text{m}^2) = 3.6 \\times 10^{-20}\\,\\text{J}$$\n分母是热能标度：\n$$k_B T = (1.380649 \\times 10^{-23}\\,\\text{J/K}) \\times (300\\,\\text{K}) = 4.141947 \\times 10^{-21}\\,\\text{J}$$\n该指数是这两个能量的比值：\n$$\\frac{(\\gamma_2 - \\gamma_1) \\Delta A}{k_B T} = \\frac{3.6 \\times 10^{-20}\\,\\text{J}}{4.141947 \\times 10^{-21}\\,\\text{J}} \\approx 8.69154$$\n现在，我们将这个值代入我们的方程。初始概率比为：\n$$\\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)} = \\frac{1 - 0.12}{0.12} = \\frac{0.88}{0.12} = \\frac{22}{3}$$\n因此，我们有：\n$$\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)} = \\frac{22}{3} \\times \\exp(-8.69154) \\approx 7.33333 \\times 0.00016800 \\approx 0.00122867$$\n设此结果值为 $R$。那么，$\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)} = R$。\n求解 $P_{\\mathrm{o}}(\\gamma_2)$：\n$$1 - P_{\\mathrm{o}}(\\gamma_2) = R \\cdot P_{\\mathrm{o}}(\\gamma_2) \\implies 1 = (R+1) P_{\\mathrm{o}}(\\gamma_2) \\implies P_{\\mathrm{o}}(\\gamma_2) = \\frac{1}{R+1}$$\n$$P_{\\mathrm{o}}(\\gamma_2) = \\frac{1}{0.00122867 + 1} = \\frac{1}{1.00122867} \\approx 0.9987729$$\n问题要求的是开放概率的变化量，$\\Delta P_{\\mathrm{o}} = P_{\\mathrm{o}}(\\gamma_2) - P_{\\mathrm{o}}(\\gamma_1)$。\n$$\\Delta P_{\\mathrm{o}} = 0.9987729 - 0.12 = 0.8787729$$\n将最终答案四舍五入到三位有效数字，得到 $0.879$。", "answer": "$$\\boxed{0.879}$$", "id": "2608950"}, {"introduction": "理论模型中的“膜张力”等变量在实验中是如何被精确施加和控制的？对于实验生物物理学家来说，掌握不同机械刺激方法的原理、控制变量和适用范围至关重要。本练习 [@problem_id:2608961] 旨在检验您对几种经典机械转导研究技术的理解，包括细胞贴附式压力钳、全细胞膜拉伸、原子力显微镜压痕和弹性柱阵列，帮助您厘清理论与实践之间的联系。", "problem": "一位生物物理学家希望在机械转导实验中比较四种标准的机械刺激范式：细胞贴附式压力钳、全细胞模式下记录时的膜拉伸、原子力显微镜 (AFM) 压痕以及弹性柱阵列。为了回答本问题，请采纳以下实验假设以确保对控制变量进行一致的比较：(i) 在细胞贴附模式下，压力钳施加阶跃变化的吸管压力；(ii) 在全细胞模式下，通过外部拉伸细胞所粘附的柔性基底来刺激细胞，从而全局性地拉伸细胞膜；(iii) AFM压痕在位移控制模式下进行（无力钳制反馈）；(iv) 弹性柱阵列以驱动配置使用，其中对一个或多个已知刚度的柱子施加已知的尖端位移。\n\n仅使用力、压力、应变和弹性的基本定义来判断哪个选项正确定义了每种方法，并指出了实验者直接控制的主要机械量（输入），以及由此在膜或细胞-基底界面上产生的直接机械量。相关基础知识包括：压力 $P$ 是单位面积上的力，$P = F/A$；膜张力 $T$ 的单位是力每长度；应变 $\\epsilon$ 是相对形变（对于长度，$\\epsilon = \\Delta L/L$；对于面积，$\\epsilon = \\Delta A/A$）；对于刚度为 $k$ 的线性弹簧，力与位移的关系为 $F = k x$。\n\n在这些假设下，哪个选项最准确地将每种方法与其定义以及相应的受控机械量配对？\n\nA. 细胞贴附式压力钳：一个紧密密封的膜片钳吸管包围一个膜片；实验者控制吸管压力 $P$，从而施加一个跨膜片压力差，主要提高局部膜片的膜张力 $T$。全细胞膜拉伸：实验者控制基底或细胞的应变 $\\epsilon$，增加全局膜张力 $T$，而不是局部的跨膜片压力。AFM压痕：实验者控制探针压痕深度 $\\delta$；接触力 $F$ 是通过校准的悬臂梁刚度 $k$ 由 $F = k \\,\\Delta z$ 推断得出。弹性柱阵列：实验者控制已知刚度 $k$ 的柱尖位移 $x$，从而在细胞-柱界面的粘附点上施加一个力 $F = k x$。\n\nB. 细胞贴附式压力钳：实验者控制膜片的压痕深度 $\\delta$；力 $F$ 是推断出来的，没有任何跨膜片压力控制。全细胞膜拉伸：实验者主要通过吸管控制细胞内静水压 $P$，而不是膜应变 $\\epsilon$。AFM压痕：实验者控制探针下方的跨膜压力 $P$，这直接控制膜张力 $T$。弹性柱阵列：通过在制造时选择柱子刚度 $k$，实验者直接在整个细胞上施加一个均匀的膜张力 $T$。\n\nC. 细胞贴附式压力钳：实验者直接在膜片上施加一个均匀的膜面积应变 $\\epsilon$，没有压力差。全细胞膜拉伸：实验者在全细胞配置下，对一个小膜区域设定一个跨膜片压力差 $P$。AFM压痕：实验者控制探针上的恒定力 $F$；探针位移 $\\delta$ 不受控制。弹性柱阵列：这些设备只能测量牵引力，不能用于对细胞施加已知的输入力或位移。\n\nD. 细胞贴附式压力钳：实验者控制细胞外流体剪切应力来激活通道，而不是压力 $P$ 或张力 $T$。全细胞膜拉伸：实验者只控制渗透压，这不会改变膜应变 $\\epsilon$。AFM压痕：实验者控制横向剪切位移来控制膜张力 $T$，而不是法向压痕深度 $\\delta$。弹性柱阵列：实验者控制柱内的静水压 $P$ 以对细胞施加力 $F$。\n\n选择唯一最佳答案。", "solution": "我们从基本定义出发。\n\n对于细胞贴附式压力钳，一根抛光的膜片钳吸管围绕一小块膜片形成GΩ级密封。压力钳施加一个指令吸管压力 $P$，在膜片上建立跨膜压力差。根据定义 $P = F/A$，该压力差在膜片上产生法向载荷，通过膜曲率和球冠的拉普拉斯关系（此处不作明确要求），这会提高膜片中的局部膜张力 $T$。因此，实验者直接的输入是 $P$，而在膜上产生的直接机械后果是局部 $T$ 的增加。\n\n对于全细胞膜拉伸，在所述假设下，细胞所粘附的基底被拉伸，将形变传递给细胞皮层和膜。直接的指令是预设的基底应变 $\\epsilon$（或等效地，一个预设的位移场），这会增加全局细胞膜张力 $T$；在这种配置中没有局部的跨膜片压力。因此，受控输入是 $\\epsilon$（或一个位移场），而机械效应是分布在细胞表面的 $T$ 的增加。\n\n对于位移控制模式下的原子力显微镜压痕，压电驱动器移动悬臂梁基座以施加一个指令压痕深度 $\\delta$（或等效地，一个指令基座位移），并测量悬臂梁的偏转 $\\Delta z$。通过校准的刚度 $k$，法向接触力为 $F = k \\,\\Delta z$。因此，主要输入是位移（压痕），而 $F$ 是推断出来的。\n\n对于驱动配置下的弹性柱阵列，每个柱子都是一个刚度为 $k$ 的近线性弹簧。如果实验者指令一个柱尖位移 $x$，根据胡克定律，施加在接触点上对细胞的力为 $F = k x$。因此，输入是柱位移 $x$（相对于已知的 $k$），并由此产生施加的力 $F$。\n\n现在评估各个选项：\n\n选项 A：\n- 细胞贴附式压力钳被描述为压力控制，提高局部 $T$：与 $P$ 的定义及其对膜张力的影响一致。\n- 全细胞拉伸被描述为应变控制，增加全局 $T$：与基底拉伸将应变 $\\epsilon$ 传递给膜的情况一致。\n- AFM压痕被描述为位移控制，且 $F = k \\,\\Delta z$：与假设的模式和胡克定律相符。\n- 弹性柱被描述为位移控制，且 $F = k x$：与柱子的线性弹性相符。\n此选项完全符合第一性原理。\n\n选项 B：\n- 声称细胞贴附式压力钳控制压痕深度 $\\delta$ 而不是压力 $P$：不正确；该设备控制吸管压力。\n- 全细胞拉伸被描述为主要通过吸管控制细胞内静水压：在所述假设下，刺激是外部基底拉伸，而不是静水压。\n- AFM被说成是控制跨膜压力 $P$：AFM施加法向压痕力/位移，而不是跨膜片压力差。\n- 柱子被说成通过选择 $k$ 来直接施加均匀的膜张力 $T$：选择柱子刚度并不能直接施加一个均匀的 $T$；它只是在离散的接触点上设定力-位移关系。\n因此，不正确。\n\n选项 C：\n- 细胞贴附式压力钳被说成施加均匀的膜面积应变 $\\epsilon$，没有压力差：不正确；受控变量是 $P$，而不是直接控制 $\\epsilon$。\n- 全细胞拉伸被说成在全细胞配置下设定跨膜片压力差：与所述的基底拉伸假设相矛盾。\n- AFM被描述为力钳制模式，位移不受控制：尽管AFM可以以力钳制模式运行，但问题明确假设为位移控制模式。\n- 柱阵列被声称只能测量，不能施加已知的输入：与所述的驱动配置相矛盾；此外，$F = k x$ 使得可以进行定义的输入。\n因此，不正确。\n\n选项 D：\n- 细胞贴附式压力钳被描述为剪切应力控制：情况并非如此；它控制跨膜片的 $P$。\n- 全细胞拉伸被描述为只控制渗透压，对 $\\epsilon$ 无影响：假设是机械基底拉伸，而不是渗透膨胀。\n- AFM被描述为横向剪切控制而不是法向压痕 $\\delta$：标准的AFM压痕是垂直于表面的。\n- 柱阵列被声称控制柱内的静水压：柱子是弹性梁；没有相关的静水压控制。\n因此，不正确。\n\n因此，只有选项A符合基本定义和规定的实验假设。", "answer": "$$\\boxed{A}$$", "id": "2608961"}, {"introduction": "将单个通道的微观行为与神经元的宏观放电活动联系起来，是理解感觉编码的关键一步。这个综合性练习 [@problem_id:2608981] 指导您构建一个计算模型，模拟一个由机械转导电流驱动的渗漏整合-发放（LIF）神经元。通过模拟，您将能探索从施加的力刺激到神经元尖峰发放计数之间的完整转化过程，亲身体验力-响应曲线在神经元层面的涌现。", "problem": "模拟一个由斜坡-保持力刺激激活的机械转导电导驱动的单室漏放电积分 (LIF) 神经元的发放响应。目标是计算指定力振幅下的尖峰数量，并将尖峰数量以单个列表的形式报告。\n\n起始点 (基本定律与核心定义)：\n- 膜室的电荷守恒给出了电流平衡方程\n$$C_m \\frac{dV}{dt} = I_{\\mathrm{tot}}(t),$$\n其中 $C_m$ 是膜电容，$V$ 是膜电位。\n- 漏电流为\n$$I_{\\mathrm{leak}}(t) = -g_L\\left(V(t) - E_L\\right),$$\n其中 $g_L$ 是漏电导，$E_L$ 是漏反转电位。\n- 机械转导电流被建模为一个具有一阶门控的电导：\n$$I_{\\mathrm{mech}}(t) = g_{\\max} \\, x(t)\\, \\left(E_{\\mathrm{rev}} - V(t)\\right),$$\n$$\\tau_x \\frac{dx}{dt} = x_{\\infty}\\!\\left(F(t)\\right) - x(t),$$\n其稳态激活由一个S型力依赖关系给出\n$$x_{\\infty}(F) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{F - F_{50}}{k_F}\\right)}.$$\n此处，$g_{\\max}$ 是最大机械转导电导，$x(t)$ 是激活变量，$E_{\\mathrm{rev}}$ 是机械转导反转电位，$\\tau_x$ 是激活时间常数，$F_{50}$ 是半激活力，$k_F$ 设定了陡峭度。\n\n力刺激 (斜坡-保持)：\n设施加的力为\n$$\nF(t) =\n\\begin{cases}\n\\displaystyle F_{\\mathrm{amp}} \\, \\frac{t}{T_{\\mathrm{ramp}}}, & 0 \\le t < T_{\\mathrm{ramp}},\\\\[6pt]\n\\displaystyle F_{\\mathrm{amp}}, & T_{\\mathrm{ramp}} \\le t < T_{\\mathrm{ramp}} + T_{\\mathrm{hold}},\\\\[6pt]\n\\displaystyle 0, & t \\ge T_{\\mathrm{ramp}} + T_{\\mathrm{hold}}.\n\\end{cases}\n$$\n\n膜方程：\n$$C_m \\frac{dV}{dt} = -g_L\\left(V - E_L\\right) + g_{\\max} \\, x(t)\\, \\left(E_{\\mathrm{rev}} - V\\right).$$\n\n尖峰生成与重置 (漏放电积分 (LIF) 规则)：\n- 如果 $V(t)$ 达到阈值 $V_{\\mathrm{th}}$，则称此时发生了一次尖峰，然后 $V$ 被瞬时重置为 $V_{\\mathrm{reset}}$ 并在此值上维持一个绝对不应期 $\\tau_{\\mathrm{ref}}$，在此期间 $V$ 的动力学被暂停 (但 $x(t)$ 继续根据其微分方程演化)。\n\n离散化要求：\n- 使用具有固定时间步长 $\\Delta t$ 的前向欧拉法：\n$$x_{n+1} = x_n + \\Delta t \\, \\frac{x_{\\infty}\\!\\left(F_n\\right) - x_n}{\\tau_x},$$\n$$V_{n+1} = V_n + \\frac{\\Delta t}{C_m}\\left[-g_L\\left(V_n - E_L\\right) + g_{\\max} \\, x_n \\, \\left(E_{\\mathrm{rev}} - V_n\\right)\\right],$$\n除非处于绝对不应期，此时设置 $V_{n+1} = V_{\\mathrm{reset}}$ 并且不应用电压更新，但仍更新 $x_n$。在不处于不应期时，使用离散尖峰条件 $V_{n+1} \\ge V_{\\mathrm{th}}$ 来记录一次尖峰，然后在接下来的 $\\lceil \\tau_{\\mathrm{ref}} / \\Delta t \\rceil$ 个步骤中强制执行重置和绝对不应期。\n\n初始条件：\n- $V(0) = E_L$。\n- $x(0) = x_{\\infty}\\!\\left(F(0)\\right)$。\n\n物理参数和单位：\n- 膜电容 $C_m = 100\\,\\mathrm{pF}$。\n- 漏电导 $g_L = 10\\,\\mathrm{nS}$。\n- 漏反转电位 $E_L = -70\\,\\mathrm{mV}$。\n- 尖峰阈值 $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$。\n- 重置电位 $V_{\\mathrm{reset}} = -65\\,\\mathrm{mV}$。\n- 绝对不应期 $\\tau_{\\mathrm{ref}} = 3\\,\\mathrm{ms}$。\n- 机械转导反转电位 $E_{\\mathrm{rev}} = 0\\,\\mathrm{mV}$。\n- 最大机械转导电导 $g_{\\max} = 30\\,\\mathrm{nS}$。\n- 激活时间常数 $\\tau_x = 5\\,\\mathrm{ms}$。\n- 半激活力 $F_{50} = 5\\,\\mathrm{mN}$。\n- 力陡峭度 $k_F = 1\\,\\mathrm{mN}$。\n- 斜坡持续时间 $T_{\\mathrm{ramp}} = 50\\,\\mathrm{ms}$。\n- 保持持续时间 $T_{\\mathrm{hold}} = 150\\,\\mathrm{ms}$。\n- 时间步长 $\\Delta t = 0.1\\,\\mathrm{ms}$。\n- 总模拟时间 $T_{\\mathrm{tot}} = T_{\\mathrm{ramp}} + T_{\\mathrm{hold}} + 100\\,\\mathrm{ms}$。\n\n计算时，所有电位必须内部以 $\\mathrm{V}$ 表示，电导以 $\\mathrm{S}$ 表示，电容以 $\\mathrm{F}$ 表示，力以 $\\mathrm{N}$ 表示，时间以 $\\mathrm{s}$ 表示。不使用角度。所请求的输出是尖峰数量 (无量纲)。\n\n测试组：\n针对以下力振幅，模拟并报告尖峰数量 (正常路径、近阈值边界和高振幅情况)：\n- $F_{\\mathrm{amp}} = 0.0\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0030\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0032\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0050\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0100\\,\\mathrm{N}$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果 (例如 $[r_1,r_2,r_3,r_4,r_5]$)，其中每个 $r_i$ 是对应于上述顺序的测试用例的尖峰数量 (一个整数)。", "solution": "该问题陈述在科学上是有效的，并且在计算上是定义明确的。它描述了一个带有状态依赖重置条件的耦合一阶常微分方程组的初值问题，这是计算神经科学中的一个标准范式。我们将着手按规定构建一个数值解。\n\n该系统封装了一个单室漏放电积分 (LIF) 神经元的行为。其状态由膜电位 $V(t)$ 和一个机械敏感离子电导的激活变量 $x(t)$ 描述。\n\n膜电位的动力学遵循电荷守恒原理，表示为：\n$$C_m \\frac{dV}{dt} = I_{\\mathrm{tot}}(t) = -g_L\\left(V(t) - E_L\\right) + g_{\\max} \\, x(t)\\, \\left(E_{\\mathrm{rev}} - V(t)\\right)$$\n此处，$C_m$ 是膜电容，$g_L$ 是漏电导，其反转电位为 $E_L$，第二项是机械转导电流，其最大电导为 $g_{\\max}$，反转电位为 $E_{\\mathrm{rev}}$。\n\n激活变量 $x(t)$ 遵循一阶动力学，由施加的力刺激 $F(t)$ 驱动：\n$$\\tau_x \\frac{dx}{dt} = x_{\\infty}\\!\\left(F(t)\\right) - x(t)$$\n稳态激活 $x_{\\infty}(F)$ 是力的S型函数：\n$$x_{\\infty}(F) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{F - F_{50}}{k_F}\\right)}$$\n刺激 $F(t)$ 是一个斜坡-保持曲线，在 $t<0$ 时为零，在 $T_{\\mathrm{ramp}}$ 的持续时间内线性斜升至峰值振幅 $F_{\\mathrm{amp}}$，在 $F_{\\mathrm{amp}}$ 处保持 $T_{\\mathrm{hold}}$ 的持续时间，最后返回到零。\n\n为求解该系统，我们采用指定的具有固定时间步长 $\\Delta t$ 的前向欧拉数值积分方案。在计算之前，所有提供的参数都将转换为国际单位制基本单位 (伏特、法拉、西门子、秒、牛顿)，以保持量纲齐次性。\n\n模拟算法以离散时间步长 $t_n = n \\Delta t$ 推进。在第 $n$ 步的系统状态由 $(V_n, x_n)$ 和一个不应期计数器 `ref_counter` 定义。在 $t_0=0$ 时的初始条件为 $V_0 = E_L$ 和 $x_0 = x_{\\infty}(F(0))$，注意到 $F(0)=0$。\n\n从第 $n$ 步到第 $n+1$ 步的逐步更新过程如下：\n\n$1$. 门控变量 $x$ 在每个时间步都进行更新，无论神经元的发放状态如何。计算力 $F_n = F(t_n)$，它决定了目标激活 $x_{\\infty}(F_n)$。更新公式为：\n$$x_{n+1} = x_n + \\frac{\\Delta t}{\\tau_x} \\left( x_{\\infty}(F_n) - x_n \\right)$$\n\n$2$. 膜电位 $V$ 的更新取决于神经元的不应期状态。\n- 如果 `ref_counter` $> 0$，神经元处于不应期。$V$ 的积分被暂停，电位被钳制在重置值：$V_{n+1} = V_{\\mathrm{reset}}$。然后 `ref_counter` 递减。\n- 如果 `ref_counter` $= 0$，神经元不处于不应期。使用第 $n$ 步的状态变量对电位进行积分：\n$$V'_{n+1} = V_n + \\frac{\\Delta t}{C_m} \\left[ -g_L(V_n - E_L) + g_{\\max} x_n (E_{\\mathrm{rev}} - V_n) \\right]$$\n符号 $V'_{n+1}$ 表示积分后、尖峰检查前的电位。\n\n$3$. 在非不应期情况下更新电位后，检查尖峰条件。如果 $V'_{n+1} \\ge V_{\\mathrm{th}}$：\n- 记录一次尖峰，总尖峰数递增。\n- 下一步的膜电位设置为重置值：$V_{n+1} = V_{\\mathrm{reset}}$。\n- 通过将 `ref_counter` 设置为不应期的总步数 (计算为 $\\lceil \\tau_{\\mathrm{ref}} / \\Delta t \\rceil$) 来启动不应期状态。\n- 如果没有发生尖峰 ($V'_{n+1} < V_{\\mathrm{th}}$)，下一步的电位就是积分后的值：$V_{n+1} = V'_{n+1}$。\n\n对于每个指定的力振幅 $F_{\\mathrm{amp}}$，此数值程序在总模拟时间 $T_{\\mathrm{tot}}$ 内执行。得到的尖峰数量被收集起来，并以指定的列表格式报告。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(F_amp, params):\n    \"\"\"\n    Simulates a single LIF neuron with a mechanotransduction current.\n\n    Args:\n        F_amp (float): The amplitude of the force stimulus in Newtons.\n        params (dict): A dictionary of model and simulation parameters in SI units.\n\n    Returns:\n        int: The total number of spikes generated during the simulation.\n    \"\"\"\n    # Unpack parameters from the dictionary\n    Cm = params[\"Cm\"]\n    gL = params[\"gL\"]\n    EL = params[\"EL\"]\n    Vth = params[\"Vth\"]\n    Vreset = params[\"Vreset\"]\n    tau_ref = params[\"tau_ref\"]\n    Erev = params[\"Erev\"]\n    gmax = params[\"gmax\"]\n    tau_x = params[\"tau_x\"]\n    F50 = params[\"F50\"]\n    kF = params[\"kF\"]\n    Tramp = params[\"Tramp\"]\n    Thold = params[\"Thold\"]\n    Ttot = params[\"Ttot\"]\n    dt = params[\"dt\"]\n\n    # Simulation setup\n    num_steps = int(Ttot / dt)\n    ref_steps = int(np.ceil(tau_ref / dt))\n    \n    # Initial conditions\n    v = EL\n    f_0 = 0.0\n    x_inf_0 = 1.0 / (1.0 + np.exp(-(f_0 - F50) / kF))\n    x = x_inf_0\n    \n    spike_count = 0\n    ref_counter = 0\n\n    # Main simulation loop\n    for i in range(num_steps):\n        t = i * dt\n        \n        # Calculate force F(t) based on the ramp-and-hold profile\n        if t < Tramp:\n            force = F_amp * t / Tramp\n        elif t < Tramp + Thold:\n            force = F_amp\n        else:\n            force = 0.0\n            \n        # Store x from the beginning of the step for the voltage update\n        x_now = x\n        \n        # Update gating variable x (this dynamic is always active)\n        x_inf = 1.0 / (1.0 + np.exp(-(force - F50) / kF))\n        x = x + (dt / tau_x) * (x_inf - x)\n        \n        # Update membrane potential v, conditional on refractory period\n        if ref_counter > 0:\n            # Neuron is in refractory period: clamp voltage and decrement counter\n            v = Vreset\n            ref_counter -= 1\n        else:\n            # Neuron is not refractory: integrate the membrane potential\n            i_leak = -gL * (v - EL)\n            i_mech = gmax * x_now * (Erev - v)\n            v = v + (dt / Cm) * (i_leak + i_mech)\n            \n            # Check for a spike\n            if v >= Vth:\n                spike_count += 1\n                v = Vreset          # Reset potential\n                ref_counter = ref_steps # Start refractory period\n                \n    return spike_count\n\ndef solve():\n    \"\"\"\n    Main function to define parameters, run simulations for all test cases,\n    and print the results in the specified format.\n    \"\"\"\n    # Parameters are defined in base SI units (F, S, V, N, s)\n    params = {\n        \"Cm\": 100e-12,       # Capacitance (F)\n        \"gL\": 10e-9,         # Leak conductance (S)\n        \"EL\": -70e-3,        # Leak reversal potential (V)\n        \"Vth\": -50e-3,       # Spike threshold (V)\n        \"Vreset\": -65e-3,    # Reset potential (V)\n        \"tau_ref\": 3e-3,     # Absolute refractory period (s)\n        \"Erev\": 0.0,         # Mechanotransduction reversal potential (V)\n        \"gmax\": 30e-9,       # Maximal mechanotransduction conductance (S)\n        \"tau_x\": 5e-3,       # Activation time constant (s)\n        \"F50\": 5e-3,         # Half-activation force (N)\n        \"kF\": 1e-3,          # Force steepness (N)\n        \"Tramp\": 50e-3,      # Ramp duration (s)\n        \"Thold\": 150e-3,     # Hold duration (s)\n        \"Ttot\": 300e-3,      # Total simulation time (s)\n        \"dt\": 0.1e-3,        # Time step (s)\n    }\n    \n    # Test cases for force amplitudes (F_amp) in Newtons\n    test_cases = [0.0, 0.0030, 0.0032, 0.0050, 0.0100]\n    \n    results = []\n    for f_amp in test_cases:\n        count = run_simulation(f_amp, params)\n        results.append(count)\n\n    # Print the final result in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2608981"}]}