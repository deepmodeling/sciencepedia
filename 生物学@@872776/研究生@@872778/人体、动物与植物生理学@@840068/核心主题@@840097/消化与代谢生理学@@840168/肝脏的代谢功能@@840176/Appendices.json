{"hands_on_practices": [{"introduction": "肝脏在整体新陈代谢中扮演着核心协调角色，Cori循环便是肝脏与肌肉协同作用的经典范例。这项练习 [@problem_id:2573745] 要求你运用化学计量和生物能量学的基础知识，精确计算Cori循环每轮转的净三磷酸腺苷（ATP）成本。这不仅能加深你对跨器官代谢整合的理解，还能让你体会到为何这些看似“无效”的循环在生理学上会产生净能量消耗。", "problem": "人体进行短暂的剧烈运动，在此过程中骨骼肌进行无氧代谢，将循环中的葡萄糖转化为乳酸。乳酸被运送至肝脏，肝脏处于糖异生状态，合成葡萄糖并将其送回肌肉。这构成了一个科里循环（Cori cycle）。请利用基于经过充分验证的代谢途径化学计量学的质量平衡、氧化还原平衡和能量衡算，推导在科里循环中，每摩尔葡萄糖从肝脏到肌肉再以乳酸形式返回时，在生物体层面的净三磷酸腺苷（ATP）消耗成本。\n\n假设：\n- 所有反应均在标准生化条件下发生，胞质溶胶pH为 $7.0$。\n- 组织间的运输成本可忽略不计。\n- 计一个三磷酸鸟苷（GTP）水解为一个ATP当量（一个高能磷酸键）。\n- 肝脏乳酸氧化产生的烟酰胺腺嘌呤二核苷酸（NADH）可用于支持糖异生的还原反应；不计入任何氧化磷酸化过程的贡献。\n- 使用以下公认的净化学计量式作为基本依据：\n  - 肌肉中的无氧糖酵解（葡萄糖至乳酸）：\n    $$\\mathrm{glucose} + 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} \\rightarrow 2\\,\\mathrm{lactate} + 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O}.$$\n  - 乳酸脱氢酶（可逆）：\n    $$\\mathrm{lactate} + \\mathrm{NAD^+} \\leftrightarrow \\mathrm{pyruvate} + \\mathrm{NADH} + \\mathrm{H^+}.$$\n  - 从丙酮酸到葡萄糖的肝糖异生，在丙酮酸羧化酶、磷酸烯醇式丙酮酸羧激酶和磷酸甘油酸激酶处消耗高能磷酸盐，并在3-磷酸甘油醛脱氢酶处需要还原当量；总计，从2个丙酮酸合成1个葡萄糖需要消耗4个ATP、2个GTP和2个NADH。\n\n任务：\n- 基于以上基础，并遵循碳、电荷和还原当量的守恒定律，将肌肉和肝脏中的反应相加，得出科里循环中每摩尔葡萄糖循环一次的生物体层面总平衡式。\n- 根据此总平衡式，计算每摩尔循环的葡萄糖所消耗的ATP当量净值。\n\n答案格式：\n- 以单个数字表示每摩尔循环的葡萄糖所消耗的ATP当量摩尔数。无需四舍五入。", "solution": "本题要求推导科里循环一轮在生物体层面的净三磷酸腺苷（ATP）成本。我们将通过分析肌肉和肝脏中过程的化学计量关系，然后将它们相加以得出总净反应及其相关能量成本来完成此任务。此分析将严格遵守所提供的化学计量关系和假设，包括质量平衡、氧化还原平衡以及能量衡算，其中1摩尔三磷酸鸟苷（GTP）被视为等同于1摩尔ATP。\n\n首先，我们分析骨骼肌中发生的代谢过程。在剧烈运动中，肌肉进行无氧代谢，将葡萄糖转化为乳酸。题目为此过程提供了净反应式：\n$$ \\mathrm{glucose} + 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} \\rightarrow 2\\,\\mathrm{lactate} + 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O} $$\n根据此化学计量式，我们观察到每消耗一摩尔$\\mathrm{glucose}$，肌肉组织净产生2摩尔$\\mathrm{ATP}$。产生的2摩尔乳酸随后被运送至肝脏。\n\n其次，我们分析处于糖异生状态的肝脏中发生的代谢过程。肝脏从循环中摄取2摩尔乳酸，并合成1摩尔$\\mathrm{glucose}$。此转换可视为两个连续阶段：\n1.  乳酸在乳酸脱氢酶催化下氧化为丙酮酸。对于2摩尔乳酸，该反应为：\n    $$ 2\\,\\mathrm{lactate} + 2\\,\\mathrm{NAD^+} \\rightarrow 2\\,\\mathrm{pyruvate} + 2\\,\\mathrm{NADH} + 2\\,\\mathrm{H^+} $$\n    该反应产生2摩尔的还原当量$\\mathrm{NADH}$。\n\n2.  从丙酮酸合成葡萄糖（糖异生）。题目指出，将2摩尔丙酮酸转化为1摩尔$\\mathrm{glucose}$需要消耗4摩尔$\\mathrm{ATP}$、2摩尔$\\mathrm{GTP}$和2摩尔$\\mathrm{NADH}$。\n\n将这两个阶段合并为肝脏中的总过程（从2个乳酸到1个葡萄糖），我们可以计算氧化还原平衡。第一阶段产生的2摩尔$\\mathrm{NADH}$在第二阶段被消耗。如题目所规定，这种内部平衡意味着肝脏在将乳酸完全转化为葡萄糖的过程中，没有$\\mathrm{NADH}$的净产生或消耗，并且不考虑与氧化磷酸化的相互作用。\n因此，肝脏的净能量成本是水解的高能磷酸键的总和。使用给定的$1\\,\\mathrm{GTP} = 1\\,\\mathrm{ATP}$等价关系，总成本计算如下：\n$$ \\text{Hepatic Cost} = 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} = 4\\,\\text{ATP equivalents} + 2\\,\\text{ATP equivalents} = 6\\,\\text{ATP equivalents} $$\n因此，肝脏消耗净6摩尔的ATP当量，以从肌肉提供的2摩尔乳酸中再生1摩尔$\\mathrm{glucose}$。肝脏的净反应式可写为：\n$$ 2\\,\\mathrm{lactate} + 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow \\mathrm{glucose} + 4\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 6\\,\\mathrm{P_i} $$\n（水和质子的平衡被省略，因为它不影响ATP的计算）。\n\n最后，为了确定整个生物体完成一次完整科里循环的净成本，我们将肌肉和肝脏的能量平衡相加。该循环包括在肌肉中$\\mathrm{glucose}$被转化为$\\mathrm{lactate}$，以及在肝脏中$\\mathrm{lactate}$被转化回$\\mathrm{glucose}$。\n-   肌肉中ATP的产生：$+2$摩尔$\\mathrm{ATP}$\n-   肝脏中ATP当量的消耗：$-6$摩尔$\\mathrm{ATP}$当量\n\n生物体层面ATP当量的净变化是这两个值的总和：\n$$ \\text{Net ATP equivalent change} = (+2\\,\\mathrm{ATP}) + (-6\\,\\text{ATP equivalents}) = -4\\,\\text{ATP equivalents} $$\n负号表示生物体净消耗了ATP当量。因此，运行一轮科里循环的净成本是每摩尔循环的葡萄糖消耗4摩尔ATP当量。\n\n为了将其形式化，我们将肌肉和肝脏的净反应相加：\n肌肉：$\\mathrm{glucose} + 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} \\rightarrow 2\\,\\mathrm{lactate} + 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O}$\n肝脏：$2\\,\\mathrm{lactate} + 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow \\mathrm{glucose} + 4\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 6\\,\\mathrm{P_i}$\n将这两个方程式相加，并消去两边都出现的项（$\\mathrm{glucose}$和$2\\,\\mathrm{lactate}$），我们得到循环的总净反应式：\n$$ 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} + 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O} + 4\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 6\\,\\mathrm{P_i} $$\n通过消去两边相同的项来简化此方程式，得到：\n$$ 2\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow 2\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 4\\,\\mathrm{P_i} + 2\\,\\mathrm{H_2O} $$\n这个最终的净反应式表明，科里循环的总过程是2摩尔$\\mathrm{ATP}$和2摩尔$\\mathrm{GTP}$的水解。ATP当量的总成本是这些消耗的高能磷酸键的总和：\n$$ \\text{Net Cost} = 2\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} = 2 + 2 = 4\\,\\text{ATP equivalents} $$\n生物体运行科里循环的净成本是每摩尔循环的葡萄糖消耗4个ATP当量。", "answer": "$$\\boxed{4}$$", "id": "2573745"}, {"introduction": "肝脏处理脂肪酸时面临一个关键的代谢分叉点：是将其送入线粒体进行$\\beta$-氧化以产生能量，还是将其重新酯化为甘油三酯用于储存或输出。本练习 [@problem_id:2573686] 提出了一个思想实验，通过抑制关键酶CPT1，让你运用代谢通量守恒的原理来推断代谢物的最终去向。这种定性推理能力对于理解代谢调控网络和评估药物靶点的效果至关重要。", "problem": "一名处于吸收后期至早期禁食状态的人体受试者，其肝脏接收到的非酯化长链脂肪酸增加。考虑肝脏长链脂肪酰辅酶A的以下稳态通量分配：设 $J_{\\text{in}}$ 为长链脂肪酸进入肝细胞的流入通量；$J_{\\text{mit}}$ 为长链脂肪酰辅酶A通过肉碱棕榈酰转移酶1（CPT1）进入线粒体进行β-氧化的通量；$J_{\\text{TG}}$ 为长链脂肪酰辅酶A重新酯化为甘油三酯并用于极低密度脂蛋白（VLDL）分泌的通量；而 $J_{\\text{other}}$ 总结了所有次要去路。假设在所考虑的时间范围内，过氧化物酶体氧化和 $J_{\\text{other}}$ 的值很小且保持不变，并且载脂蛋白B的可用性和微粒体甘油三酯转移蛋白的活性不是速率限制因素。在禁食状态下，由β-氧化产生的线粒体乙酰辅酶A是肝脏生酮作用的主要底物。\n\n现施用一种急性的、肝脏靶向的CPT1抑制剂，该抑制剂选择性地降低 $J_{\\text{mit}}$，而不改变脂肪组织的脂解作用或血浆长链脂肪酸的供应，也不直接影响载脂蛋白的合成。利用通量守恒原理以及β-氧化需要进入线粒体的要求，预测在急性效应窗口期内肝脏酮体输出和VLDL甘油三酯分泌最可能的变化方向，并根据 $J_{\\text{in}}$ 在各种去路中的分配进行论证。\n\n哪个选项最能描述预期的成对响应？\n\nA. 生酮作用减少；VLDL甘油三酯分泌增加。\n\nB. 生酮作用减少；VLDL甘油三酯分泌减少。\n\nC. 生酮作用增加；VLDL甘油三酯分泌减少。\n\nD. 生酮作用增加；VLDL甘油三酯分泌增加。", "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知条件\n- **状态**：人体受试者处于吸收后期至早期禁食状态。\n- **输入通量**：肝脏接收到的非酯化长链脂肪酸（LCFA）增加。\n- **通量定义**：\n    - $J_{\\text{in}}$：LCFA进入肝细胞的流入通量。\n    - $J_{\\text{mit}}$：长链脂肪酰辅酶A（LCFA-CoA）通过肉碱棕榈酰转移酶1（CPT1）进入线粒体进行β-氧化的通量。\n    - $J_{\\text{TG}}$：LCFA-CoA重新酯化为甘油三酯（TG）并用于极低密度脂蛋白（VLDL）分泌的通量。\n    - $J_{\\text{other}}$：进入所有其他次要去路的通量。\n- **假设与条件**：\n    1. 考虑的是稳态通量分配。\n    2. 过氧化物酶体氧化和 $J_{\\text{other}}$ 的值很小且不变。\n    3. 载脂蛋白B（apoB）的可用性和微粒体甘油三酯转移蛋白（MTP）的活性不是VLDL分泌的速率限制因素。\n    4. 在禁食状态下，由β-氧化产生的线粒体乙酰辅酶A是肝脏生酮作用的主要底物。\n- **干预措施**：施用一种急性的、肝脏靶向的CPT1抑制剂。\n- **干预措施的效果**：\n    1. 选择性地降低 $J_{\\text{mit}}$。\n    2. 不改变脂肪组织的脂解作用或血浆LCFA供应（意味着 $J_{\\text{in}}$ 是恒定的）。\n    3. 不直接影响载脂蛋白的合成。\n- **问题**：预测肝脏酮体输出和VLDL甘油三酯分泌的变化方向。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准评估问题陈述。\n- **科学依据**：该问题充分基于肝脏脂质代谢的既定原理。脂肪酰辅酶A在线粒体β-氧化（由CPT1控制）和酯化为甘油三酯之间的分配是肝脏生理学中一个核心、被充分理解的调控节点。脂肪酸氧化、乙酰辅酶A产生和生酮作用之间的联系是一个基本概念。这些假设是标准的，适用于创建一个可解的、集中的问题。\n- **问题的适定性**：该问题是适定的。在给定约束条件（恒定流入、恒定次要去路、对一条途径的特异性抑制）下，质量守恒定律决定了其余主要途径的唯一质性结果。\n- **客观性**：该问题以客观、技术性的语言陈述，没有歧义或主观因素。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的，逻辑上是一致的，并且是适定的。它提出了一个代谢生理学中的有效情景。因此，将推导出一个解决方案。\n\n### 推导过程\n此问题的核心在于代谢通量守恒原理。在稳态下，进入代谢池的底物总流入量必须等于离开该池的总流出量。在这里，底物是肝细胞内的长链脂肪酰辅酶A（LCFA-CoA）池。\n\n总流入量由 $J_{\\text{in}}$ 给出，即从血浆中摄取LCFA并随后将其活化为LCFA-CoA的速率。总流出量是进入所有可能的下游途径的通量之和。根据问题陈述，主要去路是线粒体氧化和甘油三酯合成。\n\n我们可以为LCFA-CoA池写出通量平衡方程：\n$$J_{\\text{in}} = J_{\\text{mit}} + J_{\\text{TG}} + J_{\\text{other}}$$\n\n该问题描述了从一个初始稳态（抑制剂使用前）到一个新稳态（抑制剂使用后）的急性变化。我们用下标$1$表示抑制剂使用前的状态，用下标$2$表示抑制剂使用后的状态。\n\n对于初始状态：\n$$J_{\\text{in},1} = J_{\\text{mit},1} + J_{\\text{TG},1} + J_{\\text{other},1}$$\n对于最终状态：\n$$J_{\\text{in},2} = J_{\\text{mit},2} + J_{\\text{TG},2} + J_{\\text{other},2}$$\n\n我们应用问题中给出的条件：\n1.  LCFA的供应不变，因此流入通量是恒定的：$J_{\\text{in},1} = J_{\\text{in},2} = J_{\\text{in}}$。\n2.  次要去路不变：$J_{\\text{other},1} = J_{\\text{other},2} = J_{\\text{other}}$。\n3.  CPT1抑制剂选择性地降低了进入线粒体的通量：$J_{\\text{mit},2}  J_{\\text{mit},1}$。\n\n代入常数项，我们的两个状态方程变为：\n$$J_{\\text{in}} = J_{\\text{mit},1} + J_{\\text{TG},1} + J_{\\text{other}}$$\n$$J_{\\text{in}} = J_{\\text{mit},2} + J_{\\text{TG},2} + J_{\\text{other}}$$\n\n通过将这两个 $J_{\\text{in}}$ 的表达式相等，我们得到：\n$$J_{\\text{mit},1} + J_{\\text{TG},1} + J_{\\text{other}} = J_{\\text{mit},2} + J_{\\text{TG},2} + J_{\\text{other}}$$\n从两边减去常数项 $J_{\\text{other}}$ 得到：\n$$J_{\\text{mit},1} + J_{\\text{TG},1} = J_{\\text{mit},2} + J_{\\text{TG},2}$$\n我们可以重新整理这个方程来求 $J_{\\text{TG}}$ 的变化：\n$$J_{\\text{TG},2} - J_{\\text{TG},1} = J_{\\text{mit},1} - J_{\\text{mit},2}$$\n\n由于抑制剂降低了线粒体通量，我们有 $J_{\\text{mit},1} > J_{\\text{mit},2}$，这意味着右边的项 $J_{\\text{mit},1} - J_{\\text{mit},2}$ 必须是一个正数。\n因此，可以得出：\n$$J_{\\text{TG},2} - J_{\\text{TG},1} > 0 \\implies J_{\\text{TG},2} > J_{\\text{TG},1}$$\n这表明，进入甘油三酯合成的LCFA-CoA通量 $J_{\\text{TG}}$ 必须增加，以补偿线粒体氧化通量的减少。问题陈述指出，apoB和MTP的活性不是速率限制因素，这意味着肝脏有足够的能力将这些新合成的甘油三酯包装并分泌为VLDL颗粒。因此，$J_{\\text{TG}}$ 的增加直接导致**VLDL甘油三酯分泌的增加**。\n\n接下来，我们评估对生酮作用的影响。问题陈述指出，由β-氧化产生的线粒体乙酰辅酶A是肝脏生酮作用的主要底物。\n1.  进入线粒体进行β-氧化的LCFA-CoA通量是 $J_{\\text{mit}}$。\n2.  CPT1抑制剂直接且选择性地减少 $J_{\\text{mit}}$。\n3.  $J_{\\text{mit}}$ 的减少意味着线粒体β-氧化速率的降低。\n4.  β-氧化的减少导致其终产物乙酰辅酶A的生成速率降低。\n5.  由于乙酰辅酶A是生酮作用的底物，乙酰辅酶A供应的减少必然导致酮体合成速率的降低。\n\n因此，肝脏**生酮作用减少**。\n\n结合这两个结果，预期的成对响应是生酮作用减少和VLDL甘油三酯分泌增加。\n\n### 逐项分析\n- **A. 生酮作用减少；VLDL甘油三酯分泌增加。**\n这个选项与我们推导的结论相符。CPT1的抑制减少了生酮作用的底物（乙酰辅酶A），从而使其减少。被阻断的脂肪酰辅酶A被重新导向酯化作用，增加了甘油三酯的合成和随后的VLDL分泌。**正确**。\n\n- **B. 生酮作用减少；VLDL甘油三酯分泌减少。**\n第一部分是正确的。第二部分是错误的。VLDL分泌的减少将意味着肝脏对脂肪酸的总利用量减少，这与脂肪酸流入恒定（$J_{\\text{in}}$）的条件和通量守恒原理相矛盾。通量必须被重定向，而不是简单地消失。**错误**。\n\n- **C. 生酮作用增加；VLDL甘油三酯分泌减少。**\n第一部分是错误的。当脂肪酸氧化的底物供应被药物阻断时，生酮作用不可能增加。第二部分也是错误的，原因如选项B的分析中所述。**错误**。\n\n- **D. 生酮作用增加；VLDL甘油三酯分泌增加。**\n第一部分是错误的。如前所述，生酮作用必须减少。第二部分是正确的，但由于整个成对响应是错误的，所以该选项无效。**错误**。", "answer": "$$\\boxed{A}$$", "id": "2573686"}, {"introduction": "为了从整体上定量理解复杂的代谢网络，我们需要超越对单一通路的直观分析。通量平衡分析（Flux Balance Analysis, FBA）是一种强大的系统生物学计算方法，它能够基于质量守恒和反应约束，预测细胞在特定生理条件下的稳态代谢行为。这项实践练习 [@problem_id:2573750] 将指导你构建并求解一个简化的肝脏代谢模型，从而在饱食、禁食和生酮等不同情境下，定量预测关键代谢产物的生成速率，让你亲身体验代谢系统建模的前沿技术。", "problem": "给定一个小型、质量平衡的网络，该网络捕获了在胞质和线粒体稳态下，人体肝脏代谢的核心碳流。请使用流平衡分析 (FBA) 来计算在三种不同情境下，饱食和禁食约束条件下的最优稳態通量。你的推理和实现应基于以下基本原则：(i) 稳态下的质量守恒，表示为 $S \\, v = 0$，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量；(ii) 反应的可逆性，由 $v$ 的下界和上界编码；以及 (iii) 对具有生物学动机的目标函数进行线性优化。确保所有通量均以毫摩尔/克干重/小时 (mmol gDW$^{-1}$ h$^{-1}$) 为单位表示，并报告四舍五入到三位小数的最终数值输出。\n\n代谢物（内部，状态向量行按顺序）：$\\mathrm{GLU}$ (胞质葡萄糖)，$\\mathrm{G6P}$ (6-磷酸葡萄糖)，$\\mathrm{PYR}$ (丙酮酸)，$\\mathrm{LAC}$ (乳酸)，$\\mathrm{OAA}$ (草酰乙酸)，$\\mathrm{ACCOA}$ (乙酰辅酶A)，$\\mathrm{AcAc}$ (乙酰乙酸)。\n\n反应（列，通量向量 $v$ 的索引 $r0$ 到 $r13$）：\n- $r0$: $\\varnothing \\rightarrow \\mathrm{GLU}$ (葡萄糖摄取交换；输入)。\n- $r1$: $\\mathrm{GLU} \\rightarrow \\varnothing$ (葡萄糖输出交换；输出)。\n- $r2$: $\\mathrm{GLU} \\leftrightarrow \\mathrm{G6P}$ (可逆异构化/磷酸化集总反应)。\n- $r3$: $\\mathrm{G6P} \\rightarrow 2\\,\\mathrm{PYR}$ (糖酵解集总反应)。\n- $r4$: $\\mathrm{PYR} \\leftrightarrow \\mathrm{LAC}$ (乳酸脱氢酶，可逆)。\n- $r5$: $\\varnothing \\rightarrow \\mathrm{LAC}$ (乳酸摄取交换；输入)。\n- $r6$: $\\mathrm{LAC} \\rightarrow \\varnothing$ (乳酸输出交换；输出)。\n- $r7$: $\\mathrm{PYR} \\rightarrow \\mathrm{OAA}$ (丙酮酸羧化酶)。\n- $r8$: $2\\,\\mathrm{PYR} \\rightarrow \\mathrm{GLU}$ (糖异生集总反应)。\n- $r9$: $\\mathrm{PYR} \\rightarrow \\mathrm{ACCOA}$ (丙酮酸脱氢酶)。\n- $r10$: $\\varnothing \\rightarrow \\mathrm{ACCOA}$ (源自脂肪酸β-氧化的乙酰辅酶A)。\n- $r11$: $2\\,\\mathrm{ACCOA} \\rightarrow \\mathrm{AcAc}$ (酮生成)。\n- $r12$: $\\mathrm{AcAc} \\rightarrow \\varnothing$ (乙酰乙酸输出交换)。\n- $r13$: $\\mathrm{ACCOA} \\rightarrow \\varnothing$ (乙酰辅酶A氧化汇，代表三羧酸循环 (TCA) 氧化)。\n\n化学计量矩阵 $S \\in \\mathbb{R}^{7 \\times 14}$，行按上述代谢物顺序排列，列按上述反应顺序排列：\n$$\nS =\n\\begin{bmatrix}\n+1  -1  -1  0  0  0  0  0  +1  0  0  0  0  0 \\\\\n0  0  +1  -1  0  0  0  0  0  0  0  0  0  0 \\\\\n0  0  0  +2  -1  0  0  -1  -2  -1  0  0  0  0 \\\\\n0  0  0  0  +1  +1  -1  0  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  +1  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  0  0  +1  +1  -2  0  -1 \\\\\n0  0  0  0  0  0  0  0  0  0  0  +1  -1  0\n\\end{bmatrix}.\n$$\n\n每个反应 $rj$ 的界限由下界 $\\ell_j$ 和上界 $u_j$ 给出。除非被特定情境的约束覆盖，否则适用以下通用界限：\n- $r2$ 和 $r4$ 是可逆的：$\\ell_{2} = -10^3$, $u_{2} = +10^3$；$\\ell_{4} = -10^3$, $u_{4} = +10^3$。\n- 所有其他内部代谢和交换反应都是不可逆的正向反应：对于 $j \\in \\{0,1,3,5,6,7,8,9,10,11,12,13\\}$，$\\ell_{j} = 0$, $u_{j} = +10^3$，除非下文的情境界限对其有进一步限制。\n\n你必须通过线性优化求解三种情境，约束条件为 $S \\, v = 0$ 和通量界限。在每种情境中，目标是最大化一个线性泛函 $c^\\top v$。\n\n情境定义和测试套件（所有通量容量单位均为 mmol gDW$^{-1}$ h$^{-1}$）：\n- 情境 A（饱食，糖酵解，理想路径）：$u_{0} = 10$, $u_{1} = 0$, $u_{5} = 0$, $u_{10} = 0$。最大化乳酸输出：最大化 $v_{6}$。\n- 情境 B（禁食，糖异生，可逆边界情况）：$u_{0} = 0$, $u_{1} = 10^3$, $u_{5} = 12$, $u_{10} = 0$。最大化葡萄糖输出：最大化 $v_{1}$。\n- 情境 C（禁食，生酮，化学计量边界）：$u_{0} = 0$, $u_{1} = 0$, $u_{5} = 0$, $u_{10} = 20$。最大化乙酰乙酸输出：最大化 $v_{12}$。\n\n实现要求：\n- 使用稳态约束 $S \\, v = 0$ 和通量界限为每种情境构建一个线性规划问题。\n- 计算每种情境的最优目标值。将每个计算出的最优值以 mmol gDW$^{-1}$ h$^{-1}$ 为单位表示，并四舍五入到三位小数。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_A,x_B,x_C]$），$x_A$、$x_B$ 和 $x_C$ 分别是情境 A、B 和 C 的最优目标值，按此顺序排列。\n\n注意：\n- 使用带有线性规划的流平衡分析 (FBA)，其目标是最大化 $c^\\top v$。\n- 将克干重 (gDW) 定义为基于约束的建模中的标准生物量归一化单位。\n- 通过遵守指定反应的不可逆性且不违反质量平衡来确保科学真实性。", "solution": "所提出的问题是流平衡分析（FBA）的一个标准应用，它被形式化为一个线性规划（LP）问题。其目标是确定给定代谢网络中的最优稳態通量分布 $v$，以最大化一个特定的生物学目标。系统的核心约束是稳態下的质量守恒定律以及对反应通量的热力学和容量约束。\n\n每种情境的线性规划（LP）公式为：\n最大化：$c^\\top v$\n约束条件：\n1. $S \\, v = 0$ (稳態质量平衡)\n2. $\\ell \\le v \\le u$ (通量界限)\n\n在此，$v \\in \\mathbb{R}^{14}$ 是反应 $r0$ 到 $r13$ 的通量向量，$S \\in \\mathbb{R}^{7 \\times 14}$ 是给定的化学计量矩阵，而 $\\ell, u \\in \\mathbb{R}^{14}$ 分别是通量下界和上界的向量。向量 $c \\in \\mathbb{R}^{14}$ 定义了线性目标函数。我们针对三种不同的情境来求解此问题。\n\n通用界限是为所有通量 $v_j$ 定义的，其中 $j \\in \\{0, 1, \\dots, 13\\}$。可逆反应 $r2$ 和 $r4$ 的界限为 $[\\ell_j, u_j] = [-10^3, 10^3]$。所有其他反应都是不可逆的，其通用界限为 $[\\ell_j, u_j] = [0, 10^3]$。这些通用界限会被特定情境的约束所修改。\n\n情境 A：饱食状态，糖酵解\n目标是最大化乳酸输出，这对应于最大化通量 $v_6$。因此，目标函数为 $c^\\top v = v_6$。\n此情境的具体约束是：\n- 葡萄糖摄取能力：$v_0 \\le 10$ mmol gDW$^{-1}$ h$^{-1}$。因此，$v_0$ 的界限是 $[0, 10]$。\n- 无葡萄糖输出：$v_1 = 0$。$v_1$ 的界限是 $[0, 0]$。\n- 无乳酸摄取：$v_5 = 0$。$v_5$ 的界限是 $[0, 0]$。\n- 无来自脂肪酸的乙酰辅酶A：$v_{10} = 0$。$v_{10}$ 的界限是 $[0, 0]$。\n\n从葡萄糖最大化乳酸输出的最优代谢途径是糖酵解。化学计量路径为 $\\mathrm{GLU} \\rightarrow \\mathrm{G6P} \\rightarrow 2\\,\\mathrm{PYR} \\rightarrow 2\\,\\mathrm{LAC}$。质量平衡分析表明，每消耗 $1$ 摩尔葡萄糖，可以产生 $2$ 摩尔乳酸。\n在最大葡萄糖摄取量 $v_0 = 10$ 的情况下，系统可以达到最大的乳酸产生通量。\n- GLU 的稳態：$v_0 - v_1 - v_2 + v_8 = 0$。给定 $v_0=10$，$v_1 = 0$，并假设没有糖异生（$v_8=0$），我们得到 $v_2 = 10$。\n- G6P 的稳态：$v_2 - v_3 = 0 \\implies v_3 = 10$。\n- PYR 的稳态：$2v_3 - v_4 - \\dots = 0$。这产生了 $2 \\times 10 = 20$ 单位的丙酮酸通量。\n- LAC 的稳态：$v_4 + v_5 - v_6 = 0$。$20$ 单位的丙酮酸通量被转化为乳酸（$v_4 = 20$），并且在没有乳酸摄取（$v_5=0$）的情况下，输出通量 $v_6$ 必须等于 $20$。\n因此，最优目标值为 $20.000$ mmol gDW$^{-1}$ h$^{-1}$。\n\n情境 B：禁食状态，糖异生\n目标是最大化葡萄糖输出，这对应于最大化通量 $v_1$。目标函数为 $c^\\top v = v_1$。\n具体约束是：\n- 无葡萄糖摄取：$v_0 = 0$。$v_0$ 的界限是 $[0, 0]$。\n- 乳酸摄取能力：$v_5 \\le 12$ mmol gDW$^{-1}$ h$^{-1}$。$v_5$ 的界限是 $[0, 12]$。\n- 无来自脂肪酸的乙酰辅酶A：$v_{10} = 0$。$v_{10}$ 的界限是 $[0, 0]$。\n\n为了最大化葡萄糖输出，肝脏利用糖异生作用，将乳酸等前体物质转化为葡萄糖。该途径本质上是糖酵解的逆过程：$2\\,\\mathrm{LAC} \\rightarrow 2\\,\\mathrm{PYR} \\rightarrow \\mathrm{GLU}$。\n在最大乳酸摄取量 $v_5 = 12$ 的情况下，系统可以支持相应的葡萄糖产生通量。\n- 为了利用输入的乳酸，可逆反应 $r4$ 必须反向进行（$\\mathrm{LAC} \\rightarrow \\mathrm{PYR}$），所以 $v_4$ 将为负值。LAC 的稳态：$v_4 + v_5 - v_6 = 0$。为了最大化葡萄糖输出，不應有乳酸被重新输出（$v_6=0$），所以 $v_4 = -v_5 = -12$。\n- 通量 $v_4 = -12$ 表明产生了 $12$ 个单位的丙酮酸通量。\n- 这些丙酮酸通过反应 $r8: 2\\,\\mathrm{PYR} \\rightarrow \\mathrm{GLU}$ 用于糖异生。该反应的速率受丙酮酸可用性的限制。$v_8 = 12 / 2 = 6$。\n- GLU 的稳態：$v_0 - v_1 - v_2 + v_8 = 0$。由于 $v_0=0$ 且 $v_2=0$（糖酵解不活跃），我们有 $-v_1 + v_8 = 0$，这意味着 $v_1 = v_8 = 6$。\n最优目标值为 $6.000$ mmol gDW$^{-1}$ h$^{-1}$。\n\n情境 C：禁食状态，生酮\n目标是最大化乙酰乙酸输出，即通量 $v_{12}$。目标函数为 $c^\\top v = v_{12}$。\n具体约束是：\n- 无葡萄糖交换：$v_0 = 0$, $v_1 = 0$。\n- 无乳酸摄取：$v_5 = 0$。\n- 来自脂肪酸氧化的乙酰辅酶A来源：$v_{10} \\le 20$ mmol gDW$^{-1}$ h$^{-1}$。$v_{10}$ 的界限是 $[0, 20]$。\n\n在此状态下，肝脏进行酮生成，将来自脂肪酸分解的乙酰辅酶A转化为像乙酰乙酸这样的酮体。该途径是 $2\\,\\mathrm{ACCOA} \\rightarrow \\mathrm{AcAc}$。\n- 来自脂肪酸氧化的最大可用乙酰辅酶A为 $v_{10} = 20$。\n- ACCOA 的稳态：$v_9 + v_{10} - 2v_{11} - v_{13} = 0$。由于没有碳水化合物输入，与丙酮酸相关的通量为零（$v_9=0$）。这得到 $20 - 2v_{11} - v_{13} = 0$。\n- AcAc 的稳态：$v_{11} - v_{12} = 0 \\implies v_{11} = v_{12}$。\n- 为了最大化 $v_{12}$，必须最大化 $v_{11}$。这可以通过最小化通量汇 $v_{13}$（TCA 循环氧化）来实现。$v_{13}$ 的最小值为 $0$。\n- 设 $v_{13} = 0$，乙酰辅酶A的平衡变为 $20 - 2v_{11} = 0$，得出 $v_{11} = 10$。\n- 因此，最大输出通量为 $v_{12} = v_{11} = 10$。\n最优目标值为 $10.000$ mmol gDW$^{-1}$ h$^{-1}$。\n\n总结来说，情境 A、B 和 C 中目标函数的最优值分别为 $20.000$、$6.000$ 和 $10.000$ mmol gDW$^{-1}$ h$^{-1}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a Flux Balance Analysis problem for a simplified hepatic metabolic network\n    under three different physiological scenarios.\n    \"\"\"\n    # Stoichiometric matrix S (7 metabolites x 14 reactions)\n    # Metabolites: GLU, G6P, PYR, LAC, OAA, ACCOA, AcAc\n    # Reactions: r0-r13\n    S = np.array([\n        # r0, r1, r2, r3, r4, r5, r6, r7, r8,   r9, r10, r11, r12, r13\n        [+1, -1, -1,  0,  0,  0,  0,  0, +1,   0,   0,   0,   0,   0],  # GLU\n        [ 0,  0, +1, -1,  0,  0,  0,  0,  0,   0,   0,   0,   0,   0],  # G6P\n        [ 0,  0,  0, +2, -1,  0,  0, -1, -2,  -1,   0,   0,   0,   0],  # PYR\n        [ 0,  0,  0,  0, +1, +1, -1,  0,  0,   0,   0,   0,   0,   0],  # LAC\n        [ 0,  0,  0,  0,  0,  0,  0, +1,  0,   0,   0,   0,   0,   0],  # OAA\n        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  +1,  +1,  -2,   0,  -1],  # ACCOA\n        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,   0,   0,  +1,  -1,   0],  # AcAc\n    ])\n\n    num_reactions = 14\n    inf = 1000  # A large number to represent infinity for flux bounds\n\n    # Define base bounds for the 14 reactions (r0 to r13).\n    # All are irreversible (0, inf) except for r2 and r4 which are reversible.\n    base_bounds = [(0, inf) for _ in range(num_reactions)]\n    base_bounds[2] = (-inf, inf)  # r2 is reversible\n    base_bounds[4] = (-inf, inf)  # r4 is reversible\n\n    # Define the three scenarios as test cases. Each case specifies:\n    # - a name for identification\n    # - the index of the flux to be maximized in the objective function\n    # - a dictionary of bounds to override the base_bounds\n    test_cases = [\n        {   # Scenario A: Fed, glycolytic\n            'name': 'A',\n            'obj_idx': 6,  # Maximize v6 (Lactate export)\n            'bounds_overrides': {\n                0: (0, 10), # r0: GLU uptake limit\n                1: (0, 0),  # r1: No GLU export\n                5: (0, 0),  # r5: No LAC uptake\n                10: (0, 0) # r10: No ACCOA from FA\n            }\n        },\n        {   # Scenario B: Fasting, gluconeogenic\n            'name': 'B',\n            'obj_idx': 1,  # Maximize v1 (Glucose export)\n            'bounds_overrides': {\n                0: (0, 0),   # r0: No GLU uptake\n                5: (0, 12),  # r5: LAC uptake limit\n                10: (0, 0)  # r10: No ACCOA from FA\n            }\n        },\n        {   # Scenario C: Fasting, ketogenic\n            'name': 'C',\n            'obj_idx': 12, # Maximize v12 (Acetoacetate export)\n            'bounds_overrides': {\n                0: (0, 0),   # r0: No GLU uptake\n                1: (0, 0),   # r1: No GLU export\n                5: (0, 0),   # r5: No LAC uptake\n                10: (0, 20)  # r10: ACCOA source limit\n            }\n        }\n    ]\n\n    results = []\n    # Right-hand side of the steady-state equation Sv = 0\n    b_eq = np.zeros(S.shape[0])\n\n    for case in test_cases:\n        # Objective function vector c. To maximize c'v, we minimize -c'v.\n        # The objective is to maximize a single flux, so c has -1 at that flux's index.\n        c = np.zeros(num_reactions)\n        c[case['obj_idx']] = -1\n\n        # Apply scenario-specific bounds\n        scenario_bounds = base_bounds.copy()\n        for idx, b in case['bounds_overrides'].items():\n            scenario_bounds[idx] = b\n\n        # Solve the linear programming problem\n        res = linprog(c=c,\n                      A_eq=S,\n                      b_eq=b_eq,\n                      bounds=scenario_bounds,\n                      method='highs')\n\n        if res.success:\n            # linprog minimizes, so the maximum value is the negative of the result\n            optimal_value = -res.fun\n            results.append(optimal_value)\n        else:\n            # Handle cases where solver fails, though not expected for this problem\n            results.append(np.nan)\n\n    # Format the final output string as specified: [val_A,val_B,val_C]\n    # with each value rounded to three decimal places.\n    print(f\"[{','.join(f'{val:.3f}' for val in results)}]\")\n\nsolve()\n```", "id": "2573750"}]}