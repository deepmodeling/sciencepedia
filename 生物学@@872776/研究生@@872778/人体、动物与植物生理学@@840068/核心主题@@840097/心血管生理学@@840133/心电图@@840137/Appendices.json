{"hands_on_practices": [{"introduction": "心脏在心室除极期间的整体电活动可以被概括为一个向量，即平均电轴（Mean Electrical Axis, MEA）。心电图（ECG）的导联就像是从不同角度观察这个向量的“摄像机”。本练习 ([@problem_id:2615350]) 提供了将原始ECG测量值转换为一个重要的临床参数的实践机会，即通过两个正交导联（如I导联和aVF导联）的净电压来重建平均向量的方向，这是ECG解读的基石。", "problem": "一份标准的12导联心电图（ECG）以纸速 $25\\,\\mathrm{mm\\,s^{-1}}$ 和校准电压 $10\\,\\mathrm{mm\\,mV^{-1}}$ 进行记录。在额状面上，您从肢体导联中提取QRS波群的净偏转（R波的代数振幅减去Q波和S波绝对振幅之和）如下：\n\n- 导联 I：相对于等电位基线的峰值振幅为：Q波在基线下方 $1.0\\,\\mathrm{mm}$，R波在基线上方 $11.0\\,\\mathrm{mm}$，S波在基线下方 $2.0\\,\\mathrm{mm}$。\n- 导联 aVF（加压单极左下肢导联）：相对于等电位基线的峰值振幅为：Q波为 $0.0\\,\\mathrm{mm}$，R波在基线上方 $3.0\\,\\mathrm{mm}$，S波在基线下方 $10.0\\,\\mathrm{mm}$。\n\n将额状面QRS平均电轴（MEA）视为在QRS间期内的一个固定向量，其在各导联轴上的投影产生了所测量的QRS净偏转。假设各导联具有相同的增益和线性响应，因此导联 I 和 aVF 之间的相对振幅得以保持。使用常规的六轴参照系统，其中导联 I 与 $0^\\circ$ 对齐，导联 aVF 与 $+90^\\circ$ 对齐，角度逆时针增加。\n\n任务：\n1. 通过导联 I 和导联 aVF 中测得的净偏转推断向量方向，计算额状面平均电轴（MEA）的角度（以度为单位）。根据所述约定，说明角度的符号（正或负）。\n2. 使用普遍接受的阈值，将电轴分类为：正常（在 $-30^\\circ$ 和 $+90^\\circ$ 之间）、电轴左偏（在 $-30^\\circ$ 和 $-90^\\circ$ 之间）或电轴右偏（在 $+90^\\circ$ 和 $+180^\\circ$ 之间）。如果角度超出这些范围，则记为极度电轴偏移。\n\n以度为单位表示MEA。将您的数值角度四舍五入至四位有效数字。为便于评分，仅报告MEA角度作为您的最终数值答案。", "solution": "该问题要求根据心电图（ECG）数据计算并分类额状面QRS平均电轴（MEA）。\n\n首先，我们必须验证问题陈述的有效性。\n给定条件如下：\n- 纸速：$25\\,\\mathrm{mm\\,s^{-1}}$\n- 校准电压：$10\\,\\mathrm{mm\\,mV^{-1}}$\n- 导联 I 偏转：$Q = 1.0\\,\\mathrm{mm}$，$R = 11.0\\,\\mathrm{mm}$，$S = 2.0\\,\\mathrm{mm}$\n- 导联 aVF 偏转：$Q = 0.0\\,\\mathrm{mm}$，$R = 3.0\\,\\mathrm{mm}$，$S = 10.0\\,\\mathrm{mm}$\n- QRS净偏转的定义：R波的代数振幅减去Q波和S波绝对振幅之和。\n- 坐标系：导联 I 轴位于 $0^\\circ$，导联 aVF 轴位于 $+90^\\circ$。\n- 任务：计算MEA的角度并对其进行分类。\n- 精度：将最终角度四舍五入至四位有效数字。\n\n该问题具有科学依据，因为它描述了确定心脏电轴的标准向量心电图方法。所提供的值在生理上是合理的。该问题提法明确，内容完整，并提供了计算唯一角度解所需的所有信息。关于纸速和校准电压的信息，虽然对于计算角度（仅取决于偏转的比率）不是必需的，但并未产生矛盾，并且是心电图记录的标准背景数据。因此，该问题被认为是有效的。\n\n我们开始解题。\n\n步骤 1：计算每个导联的QRS净偏转。净偏转，我们用 $V_{net}$ 表示，由基于 Q、R 和 S 波振幅的公式给出：\n$$V_{net} = R_{amp} - (Q_{amp} + S_{amp})$$\n振幅以毫米（mm）为单位给出。\n\n对于导联 I：\n振幅为 $R_I = 11.0\\,\\mathrm{mm}$，$Q_I = 1.0\\,\\mathrm{mm}$ 和 $S_I = 2.0\\,\\mathrm{mm}$。\n导联 I 的净偏转 $V_I$ 是：\n$$V_I = 11.0 - (1.0 + 2.0) = 11.0 - 3.0 = 8.0\\,\\mathrm{mm}$$\n\n对于导联 aVF：\n振幅为 $R_{aVF} = 3.0\\,\\mathrm{mm}$，$Q_{aVF} = 0.0\\,\\mathrm{mm}$ 和 $S_{aVF} = 10.0\\,\\mathrm{mm}$。\n导联 aVF 的净偏转 $V_{aVF}$ 是：\n$$V_{aVF} = 3.0 - (0.0 + 10.0) = 3.0 - 10.0 = -7.0\\,\\mathrm{mm}$$\n\n步骤 2：确定MEA向量的分量。\n问题陈述，MEA可以被视为一个向量，其在导联轴上的投影对应于净偏转。常规的六轴参照系统将导联 I 轴置于 $0^\\circ$，导联 aVF 轴置于 $+90^\\circ$。此配置建立了一个标准的二维笛卡尔坐标系，其中MEA向量的x分量是导联 I 的净偏转，y分量是导联 aVF 的净偏转。\n设MEA向量为 $\\vec{M}$，其分量为 $(M_x, M_y)$。\n$$M_x = V_I = 8.0$$\n$$M_y = V_{aVF} = -7.0$$\n在此背景下，这些分量是无单位的，因为我们只关心它们的比率来求角度。毫米单位相互抵消。\n\n步骤 3：计算MEA向量的角度。\n具有分量 $(M_x, M_y)$ 的向量的角度 $\\theta$ 是使用反正切函数求得的。角度从正x轴（导联 I 轴）开始逆时针测量。\n$$\\theta = \\arctan\\left(\\frac{M_y}{M_x}\\right)$$\n代入分量值：\n$$\\theta = \\arctan\\left(\\frac{-7.0}{8.0}\\right) = \\arctan(-0.875)$$\n计算必须以度为单位进行：\n$$\\theta \\approx -41.185925...^\\circ$$\n问题要求四舍五入到四位有效数字。\n$$\\theta \\approx -41.19^\\circ$$\n该向量具有正的x分量和负的y分量，位于第四象限，这与计算出的负角度一致。\n\n步骤 4：对计算出的电轴进行分类。\n临床上接受的电轴分类范围如下：\n- 正常电轴：$-30^\\circ \\le \\theta \\le +90^\\circ$\n- 电轴左偏 (LAD)：$-90^\\circ \\le \\theta  -30^\\circ$\n- 电轴右偏 (RAD)：$+90^\\circ  \\theta \\le +180^\\circ$\n- 极度电轴偏移：超出上述范围（即 $-180^\\circ \\le \\theta  -90^\\circ$）\n\n计算得出的MEA为 $\\theta \\approx -41.19^\\circ$。该值满足条件 $-90^\\circ \\le -41.19^\\circ  -30^\\circ$。\n因此，该电轴被分类为电轴左偏（LAD）。\n\n问题要求仅将以度为单位的数值角度作为最终答案。", "answer": "$$\\boxed{-41.19}$$", "id": "2615350"}, {"introduction": "虽然解读ECG向量至关重要，但解读的准确性完全依赖于原始记录的完整性。一个常见且危险的错误是肢体导联电极的错位。本练习通过推导当右臂和左腿电极互换时，标准和加压导联如何根据其基本定义（例如 $L_{I} = V_{L} - V_{R}$）发生代数变换，来探讨这种错误的后果。这项实践 ([@problem_id:2615374]) 超越了简单的计算，促使我们更深入地理解艾因托文三角（Einthoven's triangle）和导联理论，并揭示了一个技术性错误如何产生危险地模拟严重病理状况的ECG模式，从而教授了关于质量控制和故障排查的关键一课。", "problem": "一个三电极肢体系统记录额面心电图。设右臂、左臂和左腿电极处的瞬时电位分别表示为 $V_{R}(t)$、$V_{L}(t)$ 和 $V_{F}(t)$。标准肢体导联由电位差定义：$L_{I}(t) = V_{L}(t) - V_{R}(t)$、$L_{II}(t) = V_{F}(t) - V_{R}(t)$ 和 $L_{III}(t) = V_{F}(t) - V_{L}(t)$。加压肢体导联使用 Wilson 中心电端 $V_{W}(t) = \\left(V_{R}(t)+V_{L}(t)+V_{F}(t)\\right)/3$ 定义：$aVR(t) = V_{R}(t) - V_{W}(t)$、$aVL(t) = V_{L}(t) - V_{W}(t)$ 和 $aVF(t) = V_{F}(t) - V_{W}(t)$。假设额面内的平均 QRS 向量具有恒定大小 $A  0$ 和真实电轴 $\\theta$（单位为度），其中 $0^{\\circ}$ 沿 I 导联正方向测量，$+90^{\\circ}$ 指向下方。在额面的常规线性向量模型下，平均 QRS 向量在三个标准肢体导联轴上的投影为 $L_{I} = A \\cos(\\theta)$、$L_{II} = A \\cos(\\theta - 60^{\\circ})$ 和 $L_{III} = A \\cos(\\theta - 120^{\\circ})$，这与 Einthoven 定律一致。\n现在假设右臂和左腿的电极在皮肤上被意外互换（右臂电极放置在左腿位置，左腿电极放置在右臂位置），而左臂电极位置仍然正确。一位解读人员不知道这次互换，使用从这个错误连接记录中测得的 $L_{I}$ 和 $aVF$ 来推断平均额面 QRS 电轴。他采用常规的笛卡尔方法，将 $L_{I}$ 和 $aVF$ 的测量值分别视为与平均 QRS 向量的水平和垂直分量成正比，并将电轴确定为相应的极角。\n仅使用上述核心定义以及 Wilson 中心电端是三个肢体电位平均值的假设，首先推导出右臂-左腿互换对测得的肢体导联和加压肢体导联的代数效应，并用真实的 $L_{I}$ 和 $L_{II}$ 表示。然后，对于一个真实额面平均 QRS 电轴为 $\\theta = 30^{\\circ}$ 且任意 $A0$ 的心脏，计算解读人员会根据错误连接的 $L_{I}$ 和 $aVF$ 报告的表观平均额面 QRS 电轴的单个数值（单位为度）。使用区间 $[-180^{\\circ}, 180^{\\circ})$ 内的常规主值。用度数表示您的最终答案。\n在您的推导中，指明在解读错误连接的描记图中的心律和电轴时，这种特定的电极互换可能导致的主要诊断陷阱。最终答案必须仅为单个角度值。", "solution": "所述问题具有科学依据、适定、客观且内部一致。它描述了心电图学中电极错位的物理真实情景，并提供了推导唯一解所需的所有形式化定义。该问题是有效的。\n\n问题的核心是确定电极互换对测得的心电图（ECG）导联的定量影响，以及由此导致的心脏电轴误读。设右臂、左臂和左腿的真实生理电位分别为 $V_{R}$、$V_{L}$ 和 $V_{F}$。问题陈述指出右臂（RA）和左腿（LL）电极互换。这意味着心电图机在其 RA 输入端测得的电位实际上是 $V_{F}$，而在其 LL 输入端测得的电位实际上是 $V_{R}$。左臂（LA）电极位置正确。\n\n设机器输入端测得的电位用撇号表示：\n$V'_{R} = V_{F}$\n$V'_{L} = V_{L}$\n$V'_{F} = V_{R}$\n\n机器根据这些互换后的输入电位计算标准导联和加压导联。我们用真实导联来推导这些测得导联（用撇号表示）的表达式。\n\n真实的标准肢体导联定义如下：\n$L_{I} = V_{L} - V_{R}$\n$L_{II} = V_{F} - V_{R}$\n$L_{III} = V_{F} - V_{L}$\n根据这些定义，直接可以得出 Einthoven 定律：$L_{I} + L_{III} = L_{II}$。我们可以将 $L_{III}$ 表示为 $L_{III} = L_{II} - L_{I}$。\n\n测得的标准导联为：\n$L'_{I} = V'_{L} - V'_{R} = V_{L} - V_{F} = -(V_{F} - V_{L}) = -L_{III}$。\n使用 Einthoven 定律，这变为 $L'_{I} = -(L_{II} - L_{I}) = L_{I} - L_{II}$。\n$L'_{II} = V'_{F} - V'_{R} = V_{R} - V_{F} = -(V_{F} - V_{R}) = -L_{II}$。\n$L'_{III} = V'_{F} - V'_{L} = V_{R} - V_{L} = -(V_{L} - V_{R}) = -L_{I}$。\n\n接下来，我们推导测得的加压导联的表达式。首先，我们考察 Wilson 中心电端，其定义为 $V_{W} = \\frac{1}{3}(V_{R} + V_{L} + V_{F})$。机器计算出一个测得的中心电端 $V'_{W}$：\n$V'_{W} = \\frac{1}{3}(V'_{R} + V'_{L} + V'_{F}) = \\frac{1}{3}(V_{F} + V_{L} + V_{R}) = V_{W}$。\nWilson 中心电端在肢体电位的任何排列下都是不变的。\n\n真实的加压导联为：\n$aVR = V_{R} - V_{W}$\n$aVL = V_{L} - V_{W}$\n$aVF = V_{F} - V_{W}$\n\n测得的加压导联为：\n$aVR' = V'_{R} - V'_{W} = V_{F} - V_{W} = aVF$。\n$aVL' = V'_{L} - V'_{W} = V_{L} - V_{W} = aVL$。\n$aVF' = V'_{F} - V'_{W} = V_{R} - V_{W} = aVR$。\n这次 RA 和 LL 电极的互换导致测得的导联 $aVR'$ 和 $aVF'$ 是真实 $aVF$ 和 $aVR$ 的互换版本，而 $aVL$ 不受影响。\n\n问题陈述指出，一位不知道互换的解读人员使用测得的 $L'_{I}$ 和 $aVF'$ 来确定平均 QRS 电轴。解读人员将 $L'_{I}$ 视为心脏向量的水平分量（$x$ 轴），将 $aVF'$ 视为垂直分量（$y$ 轴）。为了计算表观电轴，我们必须用真实的基准导联 $L_{I}$ 和 $L_{II}$ 来表示 $L'_{I}$ 和 $aVF'$。\n\n我们已有 $L'_{I} = L_{I} - L_{II}$。对于 $aVF'$，我们有 $aVF' = aVR$。我们必须使用所提供的 $V_W$ 定义，用 $L_I$ 和 $L_{II}$ 来表示真实的 $aVR$。\n$aVR = V_{R} - V_{W} = V_{R} - \\frac{1}{3}(V_{R} + V_{L} + V_{F})$\n为了用 $L_{I}$、$L_{II}$ 和 $V_R$ 表示 $V_{L}$ 和 $V_{F}$，我们使用：\n$V_{L} = L_{I} + V_{R}$\n$V_{F} = L_{II} + V_{R}$\n将这些代入 $aVR$ 的表达式中：\n$aVR = V_{R} - \\frac{1}{3}(V_{R} + (L_{I} + V_{R}) + (L_{II} + V_{R}))$\n$aVR = V_{R} - \\frac{1}{3}(3V_{R} + L_{I} + L_{II}) = V_{R} - V_{R} - \\frac{1}{3}(L_{I} + L_{II})$\n$aVR = -\\frac{1}{2}(L_{I} + L_{II})$\n有一个小错误，$aVR$的表达式是 `-(LI + LII)/2`，不是 `/3`。 让我们重新推导 `aVR`。\n$aVR = V_R - \\frac{V_L+V_F}{2}$.\n$V_L = V_R + L_I$\n$V_F = V_R + L_{II}$\n$aVR = V_R - \\frac{(V_R + L_I) + (V_R + L_{II})}{2} = V_R - \\frac{2V_R + L_I + L_{II}}{2} = V_R - V_R - \\frac{L_I + L_{II}}{2} = -\\frac{1}{2}(L_I + L_{II})$。\n哦，对，这是Goldberger的增强导联定义，不是Wilson的原始单极导联。题目说的是`aVR(t) = V_R(t) - V_W(t)`，其中`V_W`是Wilson中心端，所以分母是3。所以我的第一次推导`aVR = -1/3(L_I + L_{II})`是正确的，但是原始文本的solution写的是$aVR = -\\frac{1}{3}(L_{I} + L_{II})$。这是对的。我刚才在自己的检查中犯了一个错误。那么原solution是正确的。\n\n所以，解读人员使用的向量分量与以下成正比：\n水平分量：$x \\propto L'_{I} = L_{I} - L_{II}$\n垂直分量：$y \\propto aVF' = aVR = -\\frac{1}{3}(L_{I} + L_{II})$\n\n现在，我们计算真实平均 QRS 电轴 $\\theta = 30^{\\circ}$ 时的这些值。在标准肢体导联轴上的投影由以下公式给出：\n$L_{I} = A \\cos(\\theta) = A \\cos(30^{\\circ}) = A \\frac{\\sqrt{3}}{2}$\n$L_{II} = A \\cos(\\theta - 60^{\\circ}) = A \\cos(30^{\\circ} - 60^{\\circ}) = A \\cos(-30^{\\circ}) = A \\frac{\\sqrt{3}}{2}$\n\n将这些值代入我们测得的分量表达式中：\n$x \\propto L'_{I} = A \\frac{\\sqrt{3}}{2} - A \\frac{\\sqrt{3}}{2} = 0$\n$y \\propto aVF' = -\\frac{1}{3}\\left(A \\frac{\\sqrt{3}}{2} + A \\frac{\\sqrt{3}}{2}\\right) = -\\frac{1}{3}(A\\sqrt{3}) = -A\\frac{\\sqrt{3}}{3}$\n\n解读人员将表观电轴 $\\theta_{app}$ 确定为与向量 $(x, y)$ 对应的极角。该向量的水平分量为 0，垂直分量为负（因为 $A0$）。在标准额面心电图电轴系统中，水平轴对应 I 导联（$0^{\\circ}$），垂直轴对应 aVF 导联（$+90^{\\circ}$ 指向下方）。aVF 轴上的正值对应于向下的方向。我们计算出的垂直分量 $y$ 是负值，这意味着向量分量指向上方。一个水平分量为零、垂直分量向上的向量直接指向负 aVF 轴。负 aVF 轴的方向是 $+90^{\\circ} - 180^{\\circ} = -90^{\\circ}$。\n\n因此，表观平均额面 QRS 电轴为 $-90^{\\circ}$。\n\n由此错误引起的诊断陷阱是严重的。一个真实的 $+30^{\\circ}$ 正常电轴被误读为 $-90^{\\circ}$ 的电轴极度偏移。更危险的是，这种特定的互换可以模拟完全性下壁心肌梗死。一个具有 $+30^{\\circ}$ 电轴的正常心脏在 II、III 和 aVF 导联中具有正向 QRS 波群。根据我们的推导，测得的导联是 $L'_{II} = -L_{II}$、$L'_{III} = -L_{I}$ 和 $aVF' = aVR$。对于正常电轴，真实的 $L_I$ 和 $L_{II}$ 是正的，而真实的 $aVR$ 是负的。因此，解读人员在标记为 'II'、'III' 和 'aVF' 的导联中看到负向 QRS 波群。这种模式是下壁梗死的经典特征。此外，真实的 $aVF$ 是正的，但它被记录在 'aVR' 通道中（$aVR' = aVF$）。在标记为 'aVR' 的导联中出现直立的 P 波和 QRS 波群是这种电极反接（或右位心）的一个高度特异性的线索，它的出现应立即触发对电极位置的检查。忽略这一线索会导致严重的诊断错误。", "answer": "$$\\boxed{-90}$$", "id": "2615374"}, {"introduction": "在临床急症中，区分危及生命的室性心动过速（VT）和危险性较低的伴有差异性传导的室上性心动过速（SVT）是一项至关重要的挑战。决策往往依赖于对多个（通常是细微的）ECG特征的综合分析。本练习 ([@problem_id:2615327]) 引入了一个强大的循证诊断框架：朴素贝叶斯分类器，它利用似然比（likelihood ratios）根据特定诊断标准的存在与否来量化更新VT的概率。这项实践将临床推理过程形式化为一个计算算法，展示了如何从定性的模式识别转向定量的、概率性的诊断方法，这是现代医疗决策的基石。", "problem": "您需要设计并实现一个有理论依据的二元分类器，该分类器利用一组具有诊断意义的标准的似然比（LRs），在体表心电图（ECG）上区分伴有差异传导的室上性心动过速（SVT）和室性心动过速（VT）。该分类器必须从第一性原理出发，使用贝叶斯定理的优势比形式以及在给定诊断的情况下各标准条件独立的假设来进行论证。程序必须计算VT的后验概率，然后应用一个概率阈值来提供决策规则。\n\n使用的基本原理：\n- 贝叶斯定理的优势比形式：如果$H$是室性心动过速（VT）的假设，$E$是观察到的证据，那么后验优势比满足\n$$\n\\text{odds}(H \\mid E) = \\text{odds}(H) \\times \\prod_{i=1}^{n} \\text{LR}_{i},\n$$\n其中$\\text{odds}(H) = \\dfrac{P(H)}{1 - P(H)}$，$\\text{LR}_{i}$是第$i$个标准的似然比。后验概率可以从优势比中恢复，公式如下\n$$\nP(H \\mid E) = \\dfrac{\\text{odds}(H \\mid E)}{1 + \\text{odds}(H \\mid E)}.\n$$\n- 似然比定义：对于一个二元标准，当特征存在时，$\\text{LR}_{+} = \\dfrac{\\text{灵敏度}}{1-\\text{特异度}}$；当特征不存在时，$\\text{LR}_{-} = \\dfrac{1-\\text{灵敏度}}{\\text{特异度}}$。在本任务中，您将使用提供的$\\text{LR}_{+}$和$\\text{LR}_{-}$值，这些值是合理的且与临床文献一致。\n\n假设与设计约束：\n- 对于给定的真实心律（SVT vs VT），使用朴素条件独立性假设。\n- 将以下标准视为具有量化似然比的二元特征。对于每个标准，若存在则使用$\\text{LR}_{+}$，若不存在则使用$\\text{LR}_{-}$：\n  - 房室分离存在：$\\text{LR}_{+} = 20.0$，$\\text{LR}_{-} = 0.7$。\n  - 夺获或融合波存在：$\\text{LR}_{+} = 15.0$，$\\text{LR}_{-} = 0.85$。\n  - 胸前导联QRS波群同向性存在：$\\text{LR}_{+} = 18.0$，$\\text{LR}_{-} = 0.9$。\n  - aVR导联起始R波存在：$\\text{LR}_{+} = 13.0$，$\\text{LR}_{-} = 0.8$。\n  - 额面心电轴极度偏移（在$-180$到$-90$度之间，含边界）存在：$\\text{LR}_{+} = 9.0$，$\\text{LR}_{-} = 0.6$。角度单位必须为度。\n  - QRS波群时限极宽（至少$160$毫秒）存在：$\\text{LR}_{+} = 4.0$，$\\text{LR}_{-} = 0.8$。时限单位必须为毫秒。\n  - 结构性心脏病史存在：$\\text{LR}_{+} = 2.5$，$\\text{LR}_{-} = 0.7$。\n- 每个病例会提供VT的先验概率$P(\\text{VT})$，为一个介于$0$和$1$之间（不含端点）的小数。\n- 分类规则：如果$P(\\text{VT} \\mid \\text{证据}) \\ge 0.5$，则分类为VT；否则分类为伴有差异传导的SVT。该阈值对应于后验优势比至少为$1$。\n\n需实现的特征提取规则：\n- 如果额面心电轴$\\theta$满足$\\theta \\in [-180,-90]$度，则存在额面心电轴极度偏移特征；否则该特征不存在。角度单位为度。\n- 如果QRS波群时限$d$满足$d \\ge 160$毫秒，则存在QRS波群极宽特征；否则该特征不存在。\n\n计算要求：\n- 使用提供的似然比，以乘法方式实现优势比更新。为了数值稳定性，可以接受在对数优势比域中进行计算，即对$\\log(\\text{LR}_{i})$求和，然后通过logistic变换$P = 1/(1 + e^{-\\log\\text{odds}})$映射回概率。\n- 对于每个测试用例，计算后验概率$P(\\text{VT} \\mid \\text{证据})$，并四舍五入保留三位小数以供报告。\n\n测试套件：\n每个测试用例是一个元组，包含以下有序字段：\n$(P(\\text{VT}), \\text{QRS时限（毫秒）}, \\text{心电轴（度）}, \\text{房室分离}, \\text{夺获/融合波}, \\text{胸前导联同向性}, \\text{aVR导联起始R波}, \\text{结构性心脏病史})$，其中最后五个条目是布尔值。\n\n按所列顺序为以下病例提供结果：\n- 病例 A: $(0.5, 180, -120, \\text{真}, \\text{假}, \\text{真}, \\text{真}, \\text{真})$。\n- 病例 B: $(0.5, 130, 30, \\text{假}, \\text{假}, \\text{假}, \\text{假}, \\text{假})$。\n- 病例 C: $(0.2, 170, -100, \\text{假}, \\text{假}, \\text{假}, \\text{真}, \\text{真})$。\n- 病例 D: $(0.8, 140, -60, \\text{假}, \\text{假}, \\text{假}, \\text{假}, \\text{真})$。\n- 病例 E: $(0.5, 160, -90, \\text{假}, \\text{假}, \\text{假}, \\text{假}, \\text{假})$。\n- 病例 F: $(0.01, 180, -150, \\text{真}, \\text{真}, \\text{假}, \\text{真}, \\text{假})$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素是对应病例的VT后验概率，按A到F的顺序排列，每个概率都四舍五入到三位小数。例如，输出应类似于$[0.500,0.750,0.250, \\dots]$，小数点后恰好有三位数字。", "solution": "问题陈述已经过严格验证，并被证实是有效的。它在科学上基于贝叶斯推断的原理及其在医学诊断——特别是心电图判读——中的应用。该问题是适定的，提供了所有必要的数据、参数、定义和明确的目标。其中没有矛盾、歧义或事实错误。任务是实现一个朴素贝叶斯分类器，根据一组预定义的心电图和临床标准，区分室性心动过速（VT）和伴有差异传导的室上性心动过速（SVT）。\n\n该分类器的理论基础是贝叶斯定理的优势比形式。设$H$为心律是VT的假设，设$E$代表收集到的证据，由$n$个发现或标准组成，即$E = \\{e_1, e_2, \\dots, e_n\\}$。给定证据时VT的后验优势比与先验优势比的关系如下，通过每条证据的似然比的乘积得出：\n$$\n\\text{odds}(H \\mid E) = \\text{odds}(H) \\times \\prod_{i=1}^{n} \\text{LR}(e_i)\n$$\n此公式依赖于一个关键假设，即在给定真实诊断$H$的情况下，各标准$e_i$是条件独立的。先验优势比由先验概率$P(H)$计算得出，该概率是相关患者人群中VT的估计患病率，计算公式为$\\text{odds}(H) = \\frac{P(H)}{1 - P(H)}$。\n\n每个标准$e_i$都是一个二元特征，存在或不存在。似然比$\\text{LR}(e_i)$取两个值之一：如果第$i$个特征存在，则为$\\text{LR}_{i,+}$；如果不存在，则为$\\text{LR}_{i,-}$。对于$n=7$个标准中的每一个，$\\text{LR}_{i,+}$和$\\text{LR}_{i,-}$的值都是给定且固定的：\n1.  房室（AV）分离：$\\text{LR}_{+} = 20.0$，$\\text{LR}_{-} = 0.7$。\n2.  夺获或融合波：$\\text{LR}_{+} = 15.0$，$\\text{LR}_{-} = 0.85$。\n3.  胸前导联QRS波群同向性：$\\text{LR}_{+} = 18.0$，$\\text{LR}_{-} = 0.9$。\n4.  aVR导联起始R波：$\\text{LR}_{+} = 13.0$，$\\text{LR}_{-} = 0.8$。\n5.  额面心电轴极度偏移：$\\text{LR}_{+} = 9.0$，$\\text{LR}_{-} = 0.6$。如果心电轴$\\theta$在$[-180, -90]$度范围内，则此特征存在。\n6.  QRS波群时限极宽：$\\text{LR}_{+} = 4.0$，$\\text{LR}_{-} = 0.8$。如果QRS时限$d \\ge 160$毫秒，则此特征存在。\n7.  结构性心脏病（SHD）史：$\\text{LR}_{+} = 2.5$，$\\text{LR}_{-} = 0.7$。\n\n一旦计算出后验优势比$\\text{odds}(H \\mid E)$，就使用logistic函数将其转换回后验概率：\n$$\nP(H \\mid E) = \\frac{\\text{odds}(H \\mid E)}{1 + \\text{odds}(H \\mid E)}\n$$\n为了在优势比非常大或非常小的情况下保持数值稳定性，可以在对数优势比域中进行计算，此时乘法变为加法：$\\log(\\text{odds}_{\\text{posterior}}) = \\log(\\text{odds}_{\\text{prior}}) + \\sum_{i} \\log(\\text{LR}_i)$。然后最终概率可恢复为$P(H \\mid E) = (1 + \\exp(-\\log(\\text{odds}_{\\text{posterior}})))^{-1}$。对于给定的参数，标准的浮点运算就足够了。\n\n为每个测试用例实现的算法如下：\n1.  接收输入元组，其中包括VT的先验概率$P(\\text{VT})$和七个诊断标准的值。\n2.  计算先验优势比：$\\text{odds}_{\\text{prior}} = P(\\text{VT}) / (1 - P(\\text{VT}))$。\n3.  初始化总似然比乘数$L$为$1.0$。\n4.  对于七个标准中的每一个，根据输入数据和指定规则（针对QRS时限和心电轴），确定特征是存在还是不存在。\n5.  将$L$乘以该标准对应的$\\text{LR}_{+}$或$\\text{LR}_{-}$。\n6.  计算后验优势比：$\\text{odds}_{\\text{posterior}} = \\text{odds}_{\\text{prior}} \\times L$。\n7.  计算最终后验概率：$P(\\text{VT} \\mid E) = \\text{odds}_{\\text{posterior}} / (1 + \\text{odds}_{\\text{posterior}})$。\n8.  每个病例的结果就是这个概率，报告时必须四舍五入到三位小数。\n\n作为一个说明性示例，我们计算病例 A 的结果：\n- 输入： $(P(\\text{VT})=0.5, \\text{QRS}=180, \\text{心电轴}=-120, \\text{房室分离}=\\text{真}, \\text{夺获/融合}=\\text{假}, \\text{同向性}=\\text{真}, \\text{aVR中R波}=\\text{真}, \\text{SHD}=\\text{真})$。\n- 先验优势比： $\\text{odds}_{\\text{prior}} = 0.5 / (1-0.5) = 1.0$。\n- 特征评估与LR选择：\n    - QRS时限 $180 \\ge 160$：存在，$\\text{LR} = 4.0$。\n    - 心电轴 $-120 \\in [-180, -90]$：存在，$\\text{LR} = 9.0$。\n    - 房室分离：存在，$\\text{LR} = 20.0$。\n    - 夺获/融合波：不存在，$\\text{LR} = 0.85$。\n    - 胸前导联同向性：存在，$\\text{LR} = 18.0$。\n    - aVR导联起始R波：存在，$\\text{LR} = 13.0$。\n    - 结构性心脏病史：存在，$\\text{LR} = 2.5$。\n- 总LR乘积： $L = 4.0 \\times 9.0 \\times 20.0 \\times 0.85 \\times 18.0 \\times 13.0 \\times 2.5 = 358020$。\n- 后验优势比： $\\text{odds}_{\\text{posterior}} = 1.0 \\times 358020 = 358020$。\n- 后验概率： $P(\\text{VT} \\mid E) = 358020 / (1 + 358020) \\approx 0.9999972...$。\n- 四舍五入到三位小数，结果为$1.000$。\n\n对所有指定的测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Naive Bayes classifier to compute the posterior probability of\n    Ventricular Tachycardia (VT) based on ECG and clinical criteria.\n    \"\"\"\n\n    # Define Likelihood Ratios (LR+, LR-) for each criterion pointing towards VT.\n    likelihood_ratios = {\n        'av_dissociation': (20.0, 0.7),\n        'capture_fusion': (15.0, 0.85),\n        'precordial_concordance': (18.0, 0.9),\n        'initial_r_in_avr': (13.0, 0.8),\n        'extreme_axis': (9.0, 0.6),\n        'wide_qrs': (4.0, 0.8),\n        'structural_heart_disease': (2.5, 0.7)\n    }\n\n    # Define the test cases from the problem statement.\n    # Format: (P(VT), QRS_ms, axis_deg, AV_diss, cap/fus, concord, r_avr, shd)\n    test_cases = [\n        # Case A\n        (0.5, 180, -120, True, False, True, True, True),\n        # Case B\n        (0.5, 130, 30, False, False, False, False, False),\n        # Case C\n        (0.2, 170, -100, False, False, False, True, True),\n        # Case D\n        (0.8, 140, -60, False, False, False, False, True),\n        # Case E\n        (0.5, 160, -90, False, False, False, False, False),\n        # Case F\n        (0.01, 180, -150, True, True, False, True, False)\n    ]\n\n    results = []\n    for case in test_cases:\n        p_vt_prior, qrs_duration, axis, av_diss, cap_fus, concordance, r_avr, shd = case\n\n        # Step 1: Calculate prior odds of VT\n        # We must handle the edge case of P(VT)=1, although problem says exclusive of 0 and 1.\n        if p_vt_prior == 1.0:\n            prior_odds = np.inf\n        else:\n            prior_odds = p_vt_prior / (1.0 - p_vt_prior)\n\n        # Step 2: Calculate the total likelihood ratio product\n        total_lr = 1.0\n\n        # Very wide QRS (>= 160 ms)\n        lr_plus, lr_minus = likelihood_ratios['wide_qrs']\n        total_lr *= lr_plus if qrs_duration >= 160 else lr_minus\n\n        # Extreme frontal plane axis ([-180, -90] degrees)\n        lr_plus, lr_minus = likelihood_ratios['extreme_axis']\n        total_lr *= lr_plus if -180 = axis = -90 else lr_minus\n        \n        # Atrioventricular dissociation\n        lr_plus, lr_minus = likelihood_ratios['av_dissociation']\n        total_lr *= lr_plus if av_diss else lr_minus\n\n        # Capture or fusion beats\n        lr_plus, lr_minus = likelihood_ratios['capture_fusion']\n        total_lr *= lr_plus if cap_fus else lr_minus\n\n        # Precordial QRS concordance\n        lr_plus, lr_minus = likelihood_ratios['precordial_concordance']\n        total_lr *= lr_plus if concordance else lr_minus\n\n        # Initial R wave in lead aVR\n        lr_plus, lr_minus = likelihood_ratios['initial_r_in_avr']\n        total_lr *= lr_plus if r_avr else lr_minus\n\n        # History of structural heart disease\n        lr_plus, lr_minus = likelihood_ratios['structural_heart_disease']\n        total_lr *= lr_plus if shd else lr_minus\n\n        # Step 3: Calculate posterior odds\n        posterior_odds = prior_odds * total_lr\n\n        # Step 4: Convert posterior odds to posterior probability\n        if np.isinf(posterior_odds):\n            posterior_prob = 1.0\n        else:\n            posterior_prob = posterior_odds / (1.0 + posterior_odds)\n            \n        results.append(posterior_prob)\n\n    # Final print statement in the exact required format.\n    # Each probability is formatted to exactly three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2615327"}]}