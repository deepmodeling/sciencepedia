{"hands_on_practices": [{"introduction": "节律性活动的产生是中枢模式发生器（CPG）功能的核心，而这种节律性可以源于单个神经元的内在特性。本练习将引导你探索一种经典的“快慢”动态系统模型，其中电压门控钙电流和钙激活钾电流之间的相互作用是产生内在节律性放电的关键机制 [@problem_id:2556980]。通过从第一性原理出发推导爆发时长，你将深刻理解离子通道动力学和细胞内信号转导如何量化地决定起搏神经元的基本时间特征。", "problem": "考虑一个用于运动的中央模式发生器中的单个起搏神经元，其爆发由电压依赖性钙电流 ($I_{\\mathrm{Ca}}$) 和钙激活钾电流 ($I_{\\mathrm{KCa}}$) 在标准快慢分解下的相互作用产生。假设使用以下广泛使用的粗粒度描述，将细胞内游离钙浓度 $[{\\mathrm{Ca}}]$（为简洁起见，记为 $c$）作为慢变量。在活动（放电）阶段，通过 $I_{\\mathrm{Ca}}$ 的平均钙内流将 $c$ 推向一个较高的准稳态水平 $c_{\\mathrm{hi}}$，而在静息（非放电）阶段，离子泵和交换体将 $c$ 推向一个较低的准稳态水平 $c_{\\mathrm{lo}}$。在一阶缓冲和清除作用下，慢动力学为\n$$\n\\frac{dc}{dt} =\n\\begin{cases}\n\\frac{c_{\\mathrm{hi}} - c}{\\tau_{\\mathrm{Ca}}}  \\text{ (活动阶段)} \\\\\n\\frac{c_{\\mathrm{lo}} - c}{\\tau_{\\mathrm{Ca}}}  \\text{ (静息阶段)}\n\\end{cases}\n$$\n其中 $\\tau_{\\mathrm{Ca}}$ 是有效钙时间常数。钙激活钾电流 $I_{\\mathrm{KCa}}$ 随 $c$ 单调增加，并在 $c$ 穿过上阈值 $c_{\\mathrm{off}}$ 时终止活动阶段，而当 $c$ 衰减到下阈值 $c_{\\mathrm{on}}$ 以下时，静息结束，放电恢复。假设阈值是常数，满足 $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$，并且每个爆发周期在 $c = c_{\\mathrm{on}}$ 时开始，在 $c = c_{\\mathrm{off}}$ 时结束活动阶段，然后在 $c$ 返回到 $c = c_{\\mathrm{on}}$ 时结束静息阶段。您可以假设时间尺度分离，因此快电压动力学在阈值处瞬时切换，而 $c$ 的慢演化可由上述一阶线性常微分方程很好地描述。\n\n任务：从第一性原理出发，用 $\\tau_{\\mathrm{Ca}}$、$c_{\\mathrm{hi}}$、$c_{\\mathrm{lo}}$、$c_{\\mathrm{on}}$ 和 $c_{\\mathrm{off}}$ 推导活动阶段持续时间 $T_{\\mathrm{on}}$ 和静息阶段持续时间 $T_{\\mathrm{off}}$ 的表达式。然后，使用这些表达式，编写一个程序，计算基线 $\\tau_{\\mathrm{Ca}}$ 条件下以及 $\\tau_{\\mathrm{Ca}}$ 减半的缓冲条件下的爆发周期 $T = T_{\\mathrm{on}} + T_{\\mathrm{off}}$（以毫秒表示）和占空比 $D = T_{\\mathrm{on}} / T$（无量纲小数）。以毫秒报告时间，以小数形式报告占空比。不涉及角度。\n\n对于下面的每个测试用例，计算并返回一个包含四个值的列表：$[T_{\\text{base}}, D_{\\text{base}}, T_{\\text{buf}}, D_{\\text{buf}}]$，其中 $T_{\\text{base}}$ 和 $D_{\\text{base}}$ 是基线 $\\tau_{\\mathrm{Ca}}$ 的周期和占空比，$T_{\\text{buf}}$ 和 $D_{\\text{buf}}$ 是缓冲作用使时间常数减半至 $\\tau_{\\mathrm{Ca}}/2$ 时的周期和占空比。所有时间量必须以毫秒表示并四舍五入到 $6$ 位小数；占空比值必须四舍五入到 $6$ 位小数。\n\n使用以下参数集测试套件，每个参数集定义为一个元组 $(\\tau_{\\mathrm{Ca}}, c_{\\mathrm{hi}}, c_{\\mathrm{lo}}, c_{\\mathrm{on}}, c_{\\mathrm{off}})$，其中浓度单位为微摩尔，$\\tau_{\\mathrm{Ca}}$ 单位为毫秒：\n- 测试 $1$：$(200.0, 1.0, 0.05, 0.2, 0.8)$\n- 测试 $2$：$(150.0, 0.9, 0.1, 0.2, 0.7)$\n- 测试 $3$：$(100.0, 1.2, 0.0, 0.55, 0.6)$\n- 测试 $4$：$(250.0, 1.0, 0.02, 0.03, 0.9)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是按 $[T_{\\text{base}}, D_{\\text{base}}, T_{\\text{buf}}, D_{\\text{buf}}]$ 顺序排列的四个数字的列表。例如，打印的输出应如下所示：\n$[[\\dots],[\\dots],[\\dots],[\\dots]]$\n\n在推导和实现中需要遵守的假设和约束：\n- 仅使用一阶线性常微分方程解的基本定义和 $I_{\\mathrm{KCa}}$ 对 $c$ 的单调性。\n- 除上述模型所隐含的之外，不要引入任何唯象的简化方法。\n- 在每个测试用例中，通过遵守 $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$ 来确保所有对数都有良好定义。", "solution": "问题陈述已经过严格验证。所有提供的信息，包括钙浓度 $c$ 的微分方程、$c_{\\mathrm{on}}$ 和 $c_{\\mathrm{off}}$ 阈值的定义、参数不等式 $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$ 以及测试参数，都是自洽的，科学上基于已建立的生物物理建模原理（快慢分解），并且在数学上是适定的。该问题没有矛盾、歧义和不可形式化的元素。因此，该问题被认为是有效的，并将推导出一个完整的解决方案。\n\n任务是从第一性原理出发，推导活动阶段持续时间 $T_{\\mathrm{on}}$ 和静息阶段持续时间 $T_{\\mathrm{off}}$ 的表达式。\n\n活动阶段持续时间 $T_{\\mathrm{on}}$ 的推导：\n在活动阶段，细胞内钙浓度 $c$ 的动力学由以下一阶线性常微分方程控制：\n$$\n\\frac{dc}{dt} = \\frac{c_{\\mathrm{hi}} - c}{\\tau_{\\mathrm{Ca}}}\n$$\n该方程是可分离的。我们重新排列各项进行积分：\n$$\n\\int \\frac{1}{c_{\\mathrm{hi}} - c} , dc = \\int \\frac{1}{\\tau_{\\mathrm{Ca}}} , dt\n$$\n积分得到：\n$$\n-\\ln|c_{\\mathrm{hi}} - c| = \\frac{t}{\\tau_{\\mathrm{Ca}}} + K\n$$\n其中 $K$ 是积分常数。考虑到在充电阶段的生物物理约束 $c  c_{\\mathrm{hi}}$，绝对值是不必要的，因此 $|c_{\\mathrm{hi}} - c| = c_{\\mathrm{hi}} - c$。整理以求解 $c(t)$，我们得到通解：\n$$\n\\ln(c_{\\mathrm{hi}} - c) = -\\frac{t}{\\tau_{\\mathrm{Ca}}} - K\n$$\n$$\nc_{\\mathrm{hi}} - c = e^{-K} e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n$$\nc(t) = c_{\\mathrm{hi}} - A e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n其中 $A = e^{-K}$ 是一个由初始条件确定的新常数。活动阶段在时间 $t=0$ 开始，此时钙浓度处于下阈值 $c(0) = c_{\\mathrm{on}}$。代入此条件：\n$$\nc_{\\mathrm{on}} = c_{\\mathrm{hi}} - A e^{0} \\implies A = c_{\\mathrm{hi}} - c_{\\mathrm{on}}\n$$\n因此，活动阶段的特解为：\n$$\nc(t) = c_{\\mathrm{hi}} - (c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n当浓度达到上阈值 $c(T_{\\mathrm{on}}) = c_{\\mathrm{off}}$ 时，活动阶段终止。我们求解持续时间 $T_{\\mathrm{on}}$：\n$$\nc_{\\mathrm{off}} = c_{\\mathrm{hi}} - (c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\n(c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}} = c_{\\mathrm{hi}} - c_{\\mathrm{off}}\n$$\n$$\ne^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}} = \\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\n$$\n对两边取自然对数：\n$$\n-\\frac{T_{\\mathrm{on}}}{\\tau_{\\mathrm{Ca}}} = \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\\right)\n$$\n活动阶段持续时间的最终表达式为：\n$$\nT_{\\mathrm{on}} = -\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\\right) = \\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)\n$$\n条件 $c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$ 确保了对数的参数大于 $1$，因此 $T_{\\mathrm{on}}$ 是正的。\n\n静息阶段持续时间 $T_{\\mathrm{off}}$ 的推导：\n在静息阶段，$c$ 的控制方程为：\n$$\n\\frac{dc}{dt} = \\frac{c_{\\mathrm{lo}} - c}{\\tau_{\\mathrm{Ca}}}\n$$\n该方程的结构与活动阶段的方程相同。因此，其通解为：\n$$\nc(t) = c_{\\mathrm{lo}} - B e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n其中 $B$ 是一个常数。静息阶段在时间 $t=0$ 开始（我们为此阶段重置时钟），此时钙浓度处于上阈值 $c(0) = c_{\\mathrm{off}}$。代入此初始条件：\n$$\nc_{\\mathrm{off}} = c_{\\mathrm{lo}} - B e^{0} \\implies B = c_{\\mathrm{lo}} - c_{\\mathrm{off}}\n$$\n静息阶段的特解为：\n$$\nc(t) = c_{\\mathrm{lo}} - (c_{\\mathrm{lo}} - c_{\\mathrm{off}}) e^{-t/\\tau_{\\mathrm{Ca}}} = c_{\\mathrm{lo}} + (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n当浓度衰减回下阈值 $c(T_{\\mathrm{off}}) = c_{\\mathrm{on}}$ 时，静息阶段终止。我们求解持续时间 $T_{\\mathrm{off}}$：\n$$\nc_{\\mathrm{on}} = c_{\\mathrm{lo}} + (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\nc_{\\mathrm{on}} - c_{\\mathrm{lo}} = (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\ne^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}} = \\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\n$$\n对两边取自然对数：\n$$\n-\\frac{T_{\\mathrm{off}}}{\\tau_{\\mathrm{Ca}}} = \\ln\\left(\\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\\right)\n$$\n静息阶段持续时间的最终表达式为：\n$$\nT_{\\mathrm{off}} = -\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\\right) = \\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right)\n$$\n条件 $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}$ 确保了对数的参数大于 $1$，因此 $T_{\\mathrm{off}}$ 是正的。\n\n爆发周期 ($T$) 和占空比 ($D$) 的计算：\n总爆发周期 $T$ 是活动阶段和静息阶段持续时间之和：\n$$\nT = T_{\\mathrm{on}} + T_{\\mathrm{off}} = \\tau_{\\mathrm{Ca}} \\left[ \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right) \\right]\n$$\n占空比 $D$ 是活动阶段所占周期的比例：\n$$\nD = \\frac{T_{\\mathrm{on}}}{T} = \\frac{\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)}{\\tau_{\\mathrm{Ca}} \\left[ \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right) \\right]}\n$$\n参数 $\\tau_{\\mathrm{Ca}}$ 被消去，表明占空比与钙时间常数无关，仅取决于浓度水平：\n$$\nD = \\frac{\\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)}{\\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right)}\n$$\n对于缓冲条件，时间常数变为 $\\tau'_{\\mathrm{Ca}} = \\tau_{\\mathrm{Ca}}/2$。新的周期 $T_{\\text{buf}}$ 将是基线周期 $T_{\\text{base}}$ 的一半，因为 $T_{\\mathrm{on}}$ 和 $T_{\\mathrm{off}}$ 都与 $\\tau_{\\mathrm{Ca}}$ 成正比。新的占空比 $D_{\\text{buf}}$ 将与基线占空比 $D_{\\text{base}}$ 相同，因为它与 $\\tau_{\\mathrm{Ca}}$ 无关。\n\n这些推导出的公式在以下程序中实现，用于计算给定测试用例所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pacemaker neuron problem for a given set of test cases.\n    Derives burst period and duty cycle from first principles.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (tau_Ca, c_hi, c_lo, c_on, c_off)\n    test_cases = [\n        (200.0, 1.0, 0.05, 0.2, 0.8),\n        (150.0, 0.9, 0.1, 0.2, 0.7),\n        (100.0, 1.2, 0.0, 0.55, 0.6),\n        (250.0, 1.0, 0.02, 0.03, 0.9),\n    ]\n\n    # This function calculates the results for a single parameter set.\n    def calculate_metrics(tau_ca, c_hi, c_lo, c_on, c_off):\n        \"\"\"\n        Calculates and returns the list [T_base, D_base, T_buf, D_buf].\n        \n        Args:\n            tau_ca (float): Baseline calcium time constant in ms.\n            c_hi (float): Upper quasi-steady state concentration level.\n            c_lo (float): Lower quasi-steady state concentration level.\n            c_on (float): Lower threshold for spiking initiation.\n            c_off (float): Upper threshold for spiking termination.\n\n        Returns:\n            list: A list of four floats [T_base, D_base, T_buf, D_buf]\n                  rounded to 6 decimal places.\n        \"\"\"\n        # --- Baseline Calculation ---\n        # Active-phase duration\n        numerator_on = c_hi - c_on\n        denominator_on = c_hi - c_off\n        T_on_base = tau_ca * np.log(numerator_on / denominator_on)\n        \n        # Silent-phase duration\n        numerator_off = c_off - c_lo\n        denominator_off = c_on - c_lo\n        T_off_base = tau_ca * np.log(numerator_off / denominator_off)\n        \n        # Total period\n        T_base = T_on_base + T_off_base\n        \n        # Duty cycle\n        D_base = T_on_base / T_base\n        \n        # --- Buffered Condition Calculation ---\n        # In the buffered condition, tau_ca is halved.\n        # Since T is directly proportional to tau_ca, T_buf is half of T_base.\n        T_buf = T_base / 2.0\n        \n        # The duty cycle D is independent of tau_ca, so it remains unchanged.\n        D_buf = D_base\n        \n        # Return the results rounded to 6 decimal places as required.\n        return [\n            round(T_base, 6),\n            round(D_base, 6),\n            round(T_buf, 6),\n            round(D_buf, 6)\n        ]\n\n    results = []\n    # Process each test case\n    for case in test_cases:\n        tau_ca, c_hi, c_lo, c_on, c_off = case\n        \n        # Validate that the concentration thresholds are ordered correctly to prevent\n        # math domain errors (e.g., log of a non-positive number).\n        if not (c_lo  c_on  c_off  c_hi):\n             raise ValueError(f\"Invalid threshold ordering in case: {case}\")\n             \n        result = calculate_metrics(tau_ca, c_hi, c_lo, c_on, c_off)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2556980"}, {"introduction": "除了单细胞的内在节律，神经元之间的网络交互是产生节律的另一种基本方式，其中“半中心振荡器”是最经典的结构。本练习将分析一个由两个相互抑制的神经元构成的半中心振荡器，并重点探讨分流性抑制与超极化抑制这两种不同生物物理特性的突触如何影响网络行为 [@problem_id:2556964]。通过对这个最小CPG回路的分析，你将理解突触特性（而非仅仅是连接模式）如何关键地塑造网络输出，从而决定运动节律的振幅和频率。", "problem": "一对相同的单室神经元形成一个相互抑制的半中心振荡器，这是运动中枢模式发生器 (CPG) 的一个最小模型。每个神经元都遵循带有欧姆性突触的被动膜方程：\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_L)-g_{\\mathrm{inh}}(t)\\,\\big(V-E_{\\mathrm{rev}}\\big)+I_{\\mathrm{app}},$$\n其中，$C$ 是膜电容，$g_L$ 是漏电导，其反转电位为 $E_L$，$g_{\\mathrm{inh}}(t)$ 是抑制性突触电导，在伙伴神经元活动期间为高值，否则为零，$E_{\\mathrm{rev}}$ 是抑制性突触反转电位，$I_{\\mathrm{app}}$ 是一个恒定的去极化驱动，代表来自脑干的持续性兴奋。当一个神经元不受抑制时，在仅有 $I_{\\mathrm{app}}$ 作用下，其有效去极化稳态电压为 $E_{\\mathrm{eff}}^{\\mathrm{exc}}$，一旦其电压超过一个固定的峰电位阈值 $V_{\\mathrm{th}}$，它就会发出一次簇放电。假设活动期持续时间在所有条件下都相同，并且簇放电间期主要由先前被抑制的神经元在抑制解除后从其谷值电压上升到 $V_{\\mathrm{th}}$ 所需的时间决定。\n\n考虑抑制性突触的两种情况：\n- 分流抑制：$E_{\\mathrm{rev}}^{\\mathrm{sh}}=E_L$（反转电位接近静息电位）。\n- 超极化抑制：$E_{\\mathrm{rev}}^{\\mathrm{hyp}}\\ll E_L$（反转电位远低于静息电位）。\n\n对两个神经元使用以下生理学上合理的参数：\n- $C=100$ pF, $g_L=10$ nS, $E_L=-65$ mV。\n- 抑制期间，$g_{\\mathrm{inh}}=50$ nS。\n- 去极化驱动的选择使得在仅有兴奋作用下，$E_{\\mathrm{eff}}^{\\mathrm{exc}}=-45$ mV，峰电位阈值为 $V_{\\mathrm{th}}=-50$ mV，活动期间的典型峰值为 $V_{\\mathrm{peak}}=-40$ mV。\n- 对于超极化抑制，取 $E_{\\mathrm{rev}}^{\\mathrm{hyp}}=-80$ mV；对于分流抑制，取 $E_{\\mathrm{rev}}^{\\mathrm{sh}}=E_L=-65$ mV。\n\n从膜方程和基本的电阻-电容动力学（不使用额外的“捷径”公式）出发，推断抑制期间达到的稳态电压以及从抑制中解除后电压的时间进程。然后，确定与超极化抑制相比，分流抑制如何影响振荡幅度（此处，对于给定神经元，将每个周期的幅度取为 $V_{\\mathrm{peak}}-V_{\\mathrm{trough}}$）和振荡频率。\n\n在这个 CPG 中，哪个选项最能描述分流抑制与超极化抑制相比的效果？\n\nA. 较小的振荡幅度和较高的振荡频率，因为分流主要增加总电导（从而降低输入电阻和有效时间常数），而不会产生大的超极化偏移，缩短了抑制解除后电压上升到阈值的时间。\n\nB. 较大的振荡幅度和较低的振荡频率，因为对于分流突触，抑制在静息电位附近最强，导致更大的电压偏移和更慢的抑制逃逸。\n\nC. 幅度和频率相似，因为两种形式在抑制期间都增加相同的 $g_{\\mathrm{inh}}$，所以动力学实际上没有改变。\n\nD. 较小的振荡幅度和较低的振荡频率，因为分流期间更高的电导减慢了膜的电压动力学，并延长了簇放电间期。\n\nE. 较大的振荡幅度和较高的振荡频率，因为分流抑制对兴奋性驱动起除法作用，放大了簇放电峰值，同时加快了节律。", "solution": "首先将对问题陈述进行严格的验证程序。\n\n### 第1步：提取已知条件\n问题陈述中明确给出的已知条件如下：\n- 单个神经元膜电位 $V$ 的控制微分方程：\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_L)-g_{\\mathrm{inh}}(t)\\,\\big(V-E_{\\mathrm{rev}}\\big)+I_{\\mathrm{app}}$$\n- 神经元的参数：\n  - 膜电容，$C = 100 \\text{ pF}$\n  - 漏电导，$g_L = 10 \\text{ nS}$\n  - 漏反转电位，$E_L = -65 \\text{ mV}$\n  - 抑制期间的抑制性突触电导，$g_{\\mathrm{inh}} = 50 \\text{ nS}$\n  - 恒定施加电流，$I_{\\mathrm{app}}$\n- 操作状态和阈值：\n  - 仅在兴奋作用下（$g_{\\mathrm{inh}}=0$）的有效稳态电压，$E_{\\mathrm{eff}}^{\\mathrm{exc}} = -45 \\text{ mV}$\n  - 峰电位阈值，$V_{\\mathrm{th}} = -50 \\text{ mV}$\n  - 活动期间的峰值电压，$V_{\\mathrm{peak}} = -40 \\text{ mV}$\n- 抑制性突触反转电位 $E_{\\mathrm{rev}}$ 的情况：\n  - 分流抑制：$E_{\\mathrm{rev}}^{\\mathrm{sh}} = E_L = -65 \\text{ mV}$\n  - 超极化抑制：$E_{\\mathrm{rev}}^{\\mathrm{hyp}} = -80 \\text{ mV}$\n- 分析的假设：\n  - 活动期持续时间在不同条件下相同。\n  - 簇放电间期主要由抑制解除后膜电位从其谷值 $V_{\\mathrm{trough}}$ 上升到阈值 $V_{\\mathrm{th}}$ 所需的时间决定。\n- 用于比较的定义：\n  - 振荡幅度定义为 $V_{\\mathrm{peak}} - V_{\\mathrm{trough}}$。\n  - 振荡频率 $f$ 与周期成反比，而周期主要由簇放电间期决定。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据**：该问题使用了带有突触电流的标准被动膜模型，这是计算神经科学和生物物理学中的一个基本工具。由相互抑制构建的半中心振荡器概念是中枢模式发生器的一个经典且有效的模型。所有参数都在生理学上合理的范围内。分流抑制和超极化抑制之间的区别是突触生理学的一个核心概念。\n- **适定性**：问题定义清晰。它提供了所有必要的参数和唯一的控制方程。问题要求基于可推导的量（幅度和频率），对两种明确定义的场景（分流抑制与超极化抑制）进行比较分析。可以从提供的信息中推导出唯一的解。\n- **客观性**：问题以精确、定量和客观的语言陈述。它没有歧义、主观看法或非科学的比喻。\n\n### 第3步：结论与行动\n问题是**有效的**。这是一个理论神经科学中的标准、适定的问题，其基础是已建立的生物物理学原理。可以推导出解析解。开始进行解题推导。\n\n### 解题推导\n\n分析分三个阶段进行：\n1.  确定恒定施加电流 $I_{\\mathrm{app}}$。\n2.  计算分流和超极化两种情况下，抑制阶段的谷值电压 $V_{\\mathrm{trough}}$。\n3.  计算两种情况下，抑制解除后电压从 $V_{\\mathrm{trough}}$ 上升到 $V_{\\mathrm{th}}$ 所需的时间。\n4.  比较最终的振荡幅度和频率。\n\n**1. 施加电流 $I_{\\mathrm{app}}$ 的计算**\n\n问题陈述，当神经元仅受兴奋作用时（$g_{\\mathrm{inh}} = 0$），其电位稳定在稳态值 $E_{\\mathrm{eff}}^{\\mathrm{exc}} = -45 \\text{ mV}$。在稳态下，$\\frac{dV}{dt} = 0$。膜方程变为：\n$$0 = -g_L (E_{\\mathrm{eff}}^{\\mathrm{exc}} - E_L) + I_{\\mathrm{app}}$$\n解出 $I_{\\mathrm{app}}$：\n$$I_{\\mathrm{app}} = g_L (E_{\\mathrm{eff}}^{\\mathrm{exc}} - E_L)$$\n代入给定值：\n$$I_{\\mathrm{app}} = (10 \\times 10^{-9} \\text{ S}) \\times (-45 \\times 10^{-3} \\text{ V} - (-65 \\times 10^{-3} \\text{ V}))$$\n$$I_{\\mathrm{app}} = (10 \\times 10^{-9} \\text{ S}) \\times (20 \\times 10^{-3} \\text{ V}) = 200 \\times 10^{-12} \\text{ A} = 200 \\text{ pA}$$\n这个恒定的去极化电流 $I_{\\mathrm{app}}=200 \\text{ pA}$ 在所有条件下都存在。\n\n**2. 谷值电压 $V_{\\mathrm{trough}}$ 的计算**\n\n在抑制阶段，神经元被保持在阈值以下。其电压稳定在一个稳态谷值 $V_{\\mathrm{trough}}$。此时，$g_{\\mathrm{inh}} = 50 \\text{ nS}$ 且 $\\frac{dV}{dt} = 0$。膜方程为：\n$$0 = -g_L(V_{\\mathrm{trough}}-E_L)-g_{\\mathrm{inh}}(V_{\\mathrm{trough}}-E_{\\mathrm{rev}})+I_{\\mathrm{app}}$$\n解出 $V_{\\mathrm{trough}}$：\n$$V_{\\mathrm{trough}}(g_L + g_{\\mathrm{inh}}) = g_L E_L + g_{\\mathrm{inh}} E_{\\mathrm{rev}} + I_{\\mathrm{app}}$$\n$$V_{\\mathrm{trough}} = \\frac{g_L E_L + g_{\\mathrm{inh}} E_{\\mathrm{rev}} + I_{\\mathrm{app}}}{g_L + g_{\\mathrm{inh}}}$$\n\n- **情况1：超极化抑制** ($E_{\\mathrm{rev}}^{\\mathrm{hyp}} = -80 \\text{ mV}$)\n$$V_{\\mathrm{trough}}^{\\mathrm{hyp}} = \\frac{(10 \\text{ nS})(-65 \\text{ mV}) + (50 \\text{ nS})(-80 \\text{ mV}) + 200 \\text{ pA}}{10 \\text{ nS} + 50 \\text{ nS}}$$\n$$V_{\\mathrm{trough}}^{\\mathrm{hyp}} = \\frac{-650 - 4000 + 200}{60} \\text{ mV} = \\frac{-4450}{60} \\text{ mV} \\approx -74.17 \\text{ mV}$$\n\n- **情况2：分流抑制** ($E_{\\mathrm{rev}}^{\\mathrm{sh}} = -65 \\text{ mV}$)\n$$V_{\\mathrm{trough}}^{\\mathrm{sh}} = \\frac{(10 \\text{ nS})(-65 \\text{ mV}) + (50 \\text{ nS})(-65 \\text{ mV}) + 200 \\text{ pA}}{10 \\text{ nS} + 50 \\text{ nS}}$$\n$$V_{\\mathrm{trough}}^{\\mathrm{sh}} = \\frac{(60 \\text{ nS})(-65 \\text{ mV}) + 200 \\text{ pA}}{60 \\text{ nS}} = -65 \\text{ mV} + \\frac{200 \\text{ pA}}{60 \\text{ nS}} = -65 + \\frac{20}{6} \\text{ mV}$$\n$$V_{\\mathrm{trough}}^{\\mathrm{sh}} = -65 + 3.33... \\text{ mV} \\approx -61.67 \\text{ mV}$$\n\n**振荡幅度的比较**\n\n幅度定义为 $A = V_{\\mathrm{peak}} - V_{\\mathrm{trough}}$。已知 $V_{\\mathrm{peak}} = -40 \\text{ mV}$：\n- 超极化抑制下的幅度：$A^{\\mathrm{hyp}} = -40 \\text{ mV} - (-74.17 \\text{ mV}) = 34.17 \\text{ mV}$\n- 分流抑制下的幅度：$A^{\\mathrm{sh}} = -40 \\text{ mV} - (-61.67 \\text{ mV}) = 21.67 \\text{ mV}$\n\n显然，$A^{\\mathrm{sh}}  A^{\\mathrm{hyp}}$。分流抑制产生**较小的振荡幅度**。\n\n**3. 簇放电间期（上升时间）的计算**\n\n抑制解除后，$g_{\\mathrm{inh}} = 0$。神经元的电压根据以下方程演化：\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_L) + I_{\\mathrm{app}} = -g_L (V - (E_L + I_{\\mathrm{app}}/g_L))$$\n我们认出括号中的项为 $E_{\\mathrm{eff}}^{\\mathrm{exc}} = -45 \\text{ mV}$。所以，\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_{\\mathrm{eff}}^{\\mathrm{exc}})$$\n这是一个一阶线性常微分方程，其时间常数为 $\\tau_m = C/g_L$。\n$$\\tau_m = \\frac{100 \\text{ pF}}{10 \\text{ nS}} = \\frac{100 \\times 10^{-12} \\text{ F}}{10 \\times 10^{-9} \\text{ S}} = 10 \\times 10^{-3} \\text{ s} = 10 \\text{ ms}$$\n解为 $V(t) = E_{\\mathrm{eff}}^{\\mathrm{exc}} + (V(0) - E_{\\mathrm{eff}}^{\\mathrm{exc}}) e^{-t/\\tau_m}$。\n我们需要找到从初始电压 $V(0) = V_{\\mathrm{trough}}$ 上升到最终电压 $V(t_{\\mathrm{rise}}) = V_{\\mathrm{th}}$ 所需的时间 $t_{\\mathrm{rise}}$。\n$$V_{\\mathrm{th}} = E_{\\mathrm{eff}}^{\\mathrm{exc}} + (V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}) e^{-t_{\\mathrm{rise}}/\\tau_m}$$\n$$\\frac{V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}{V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}} = e^{-t_{\\mathrm{rise}}/\\tau_m}$$\n$$t_{\\mathrm{rise}} = -\\tau_m \\ln{\\left(\\frac{V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}{V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}\\right)} = \\tau_m \\ln{\\left(\\frac{V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}{V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}\\right)}$$\n分母是恒定的：$V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}} = -50 \\text{ mV} - (-45 \\text{ mV}) = -5 \\text{ mV}$。\n\n- **情况1：超极化抑制**\n$$t_{\\mathrm{rise}}^{\\mathrm{hyp}} = (10 \\text{ ms}) \\ln{\\left(\\frac{-74.17 - (-45)}{-5}\\right)} = (10 \\text{ ms}) \\ln{\\left(\\frac{-29.17}{-5}\\right)} \\approx 10 \\ln(5.834) \\approx 17.6 \\text{ ms}$$\n\n- **情况2：分流抑制**\n$$t_{\\mathrm{rise}}^{\\mathrm{sh}} = (10 \\text{ ms}) \\ln{\\left(\\frac{-61.67 - (-45)}{-5}\\right)} = (10 \\text{ ms}) \\ln{\\left(\\frac{-16.67}{-5}\\right)} \\approx 10 \\ln(3.334) \\approx 12.0 \\text{ ms}$$\n\n**振荡频率的比较**\n\n振荡周期为 $T = t_{\\mathrm{active}} + t_{\\mathrm{rise}}$。问题陈述中指出 $t_{\\mathrm{active}}$ 是恒定的。我们的计算表明 $t_{\\mathrm{rise}}^{\\mathrm{sh}}  t_{\\mathrm{rise}}^{\\mathrm{hyp}}$。\n因此，分流抑制的总周期短于超极化抑制的总周期：$T^{\\mathrm{sh}}  T^{\\mathrm{hyp}}$。\n由于频率 $f = 1/T$，因此 $f^{\\mathrm{sh}} > f^{\\mathrm{hyp}}$。分流抑制产生**较高的振荡频率**。\n\n### 总结与选项评估\n\n与超极化抑制相比，分流抑制导致**较小的幅度**和**较高的频率**。\n\n现在，我们评估每个选项：\n\n**A. 较小的振荡幅度和较高的振荡频率，因为分流主要增加总电导（从而降低输入电阻和有效时间常数），而不会产生大的超极化偏移，缩短了抑制解除后电压上升到阈值的时间。**\n- `较小的振荡幅度`：正确。\n- `较高的振荡频率`：正确。\n- `理由`：理由完全正确。分流抑制增加了总电导 $g_L+g_{inh}$，这将电压钳制在 $E_{\\mathrm{rev}}^{\\mathrm{sh}}$ 附近，防止了深度超极化。因此，这个“谷值”电压更高（负得更少），更接近峰电位阈值 $V_{\\mathrm{th}}$。因此，从抑制中解除后达到阈值所需的时间更短，从而导致更快的节律。峰值和谷值之间较小的电压差导致了较小的幅度。\n- **结论：正确。**\n\n**B. 较大的振荡幅度和较低的振荡频率，因为对于分流突触，抑制在静息电位附近最强，导致更大的电压偏移和更慢的抑制逃逸。**\n- `较大的振荡幅度`：错误。幅度是较小的。\n- `较低的振荡频率`：错误。频率是较高的。\n- `理由`：理由有缺陷。将电压钳制在静息电位附近（如分流抑制所做）会*阻止*大的电压偏移，而不是驱动它们。\n- **结论：错误。**\n\n**C. 幅度和频率相似，因为两种形式在抑制期间都增加相同的 $g_{\\mathrm{inh}}$，所以动力学实际上没有改变。**\n- `幅度和频率相似`：错误。\n- `理由`：这是一个根本性错误。虽然 $g_{\\mathrm{inh}}$ 相同，但突触反转电位 $E_{\\mathrm{rev}}$ 不同，这深刻地改变了突触电流 $I_{\\mathrm{syn}} = g_{\\mathrm{inh}}(V - E_{\\mathrm{rev}})$，并因此改变了抑制期间的稳态电压。\n- **结论：错误。**\n\n**D. 较小的振荡幅度和较低的振荡频率，因为分流期间更高的电导减慢了膜的电压动力学，并延长了簇放电间期。**\n- `较小的振荡幅度`：正确。\n- `较低的振荡频率`：错误。频率是较高的。\n- `理由`：理由不正确。更高的电导 $g$ 导致更小的膜时间常数 $\\tau = C/g$，这意味着膜电压变化*更快*，而不是更慢。\n- **结论：错误。**\n\n**E. 较大的振荡幅度和较高的振荡频率，因为分流抑制对兴奋性驱动起除法作用，放大了簇放电峰值，同时加快了节律。**\n- `较大的振荡幅度`：错误。\n- `较高的振荡频率`：正确。\n- `理由`：关于“放大簇放电峰值”的理由是错误的。根据定义，抑制是抵消兴奋；它不会放大峰值。幅度是减小的。\n- **结论：错误。**\n\n只有选项 A 与推导出的结果完全一致，并提供了正确的物理解释。", "answer": "$$\\boxed{A}$$", "id": "2556964"}, {"introduction": "真实的生物神经网络远比静态模型复杂，其突触连接会随着神经活动而动态变化。本练习在前述半中心振荡器的基础上，引入了短时程突触抑制（short-term synaptic depression）这一重要的活动依赖性机制 [@problem_id:2557001]。通过构建并模拟一个包含此动态特性的模型，你将发现突触抑制是如何为爆发活动的终止提供一个强大而精巧的机制，从而在控制CPG的活动周期和整体节律定时中发挥着关键作用。", "problem": "您的任务是构建并分析一个对称半中心振荡器，该振荡器由两个通过具有短期突触抑制特性的突触连接的相互抑制的神经元单元组成。您的任务是从基于机理和守恒的突触资源动力学原理以及一阶低通神经元发放率动力学原理出发，推导出一个封闭的常微分方程组，对其进行数值模拟，并量化短期突触抑制如何控制簇放电的终止和簇放电间期。\n\n需要使用的基本原理：\n- 突触资源的守恒：一个有限的资源池，它会恢复到其最大值，并因突触前活动而耗竭。\n- 一阶低通神经元发放率动力学，其向净突触输入的静态输入-输出非线性函数弛豫。\n- 用于静态输入-输出函数的S型发放率非线性。\n\n建模要求：\n1. 考虑由 $i \\in \\{1,2\\}$ 索引的两个相同的神经元单元，其突触前伙伴为 $j \\neq i$。令 $r_i(t)$ 表示单元 $i$ 的发放率，单位为 $\\mathrm{s}^{-1}$，令 $x_i(t)$ 表示从单元 $i$ 到其伙伴的抑制性突触处可用突触资源的分数。令 $u \\in [0,1]$ 为单位突触前活动的恒定利用分数（无量纲）。总可用资源被归一化为 $1$。\n\n2. 从以下原理出发，推导突触资源动力学：\n   - 资源以时间常数 $\\tau_{\\mathrm{rec}}$（单位为秒）向 $1$ 恢复，贡献项为 $(1 - x_i)/\\tau_{\\mathrm{rec}}$。\n   - 资源根据瞬时突触前活动和当前可用资源成比例耗竭，贡献一个与 $u \\, x_i \\, r_i$ 成正比的项。\n   将这些原理组合成一个关于 $x_i(t)$ 的微分方程。\n\n3. 对于神经元输出动力学，使用一个以时间常数 $\\tau_r$（单位为秒）向静态非线性函数 $F(h_i)$ 进行一阶弛豫的模型：\n   $$\\tau_r \\, \\frac{d r_i}{dt} = - r_i + F\\!\\left(h_i\\right).$$\n   输入 $h_i$ 是一个恒定驱动 $I_0$（无量纲）与来自另一个单元的突触抑制之间的差值。来自单元 $j$ 的有效抑制输出必须与利用率、可用资源和突触前发放率的乘积成正比，从而得到一个有效抑制驱动 $y_j(t)$，该驱动应从第2项的原理中推导出来。相应地，将 $h_i$ 表示为 $h_i = I_0 - w \\, y_j$，其中 $w  0$ 是一个无量纲的抑制性耦合强度。\n\n4. 对于静态输入-输出非线性，使用一个在 $r_{\\max}$ 处饱和的S型发放率函数：\n   $$F(h) = \\frac{r_{\\max}}{1 + \\exp\\!\\left(-a \\, (h - \\theta)\\right)},$$\n   其中 $a  0$ 是斜率参数（无量纲），$\\theta$ 是阈值（无量纲）。\n\n5. 模拟与测量：\n   - 使用固定时间步长 $\\Delta t$ 和前向欧拉法对模型进行数值积分，总时长为 $T_{\\mathrm{sim}}$（两者单位均为秒）。使用最小程度打破对称性的初始条件（例如，初始发放率略有不同）。\n   - 定义活动差异 $\\Delta(t) = r_1(t) - r_2(t)$。当 $\\Delta(t)$ 从负值穿越到正值（上穿）时，单元1的簇放电开始；当它从正值穿越到负值（下穿）时，簇放电结束。根据对称性，当单元2的角色反转时，同样适用。\n   - 单元1的簇放电间期 (IBI) 定义为 $\\Delta(t)$ 连续两次上穿之间的时间。在舍弃初始瞬态后，报告最后几个周期的平均IBI。IBI必须以 $\\mathrm{s}$ 为单位，报告为一个四舍五入到三位小数的浮点数。\n   - 簇放电的终止是由活动突触的抑制驱动的。在 $\\Delta(t)$ 的每次穿越时，记录在符号变化前瞬间当前活动神经元 $k$ 的 $x_k(t^-)$ 值，其中 $t^-$ 表示穿越前的瞬间时间。将这些记录的值在用于计算IBI的相同周期内取平均，并报告终止时的平均 $x$ 值，四舍五入到三位小数（无量纲）。\n   - 如果系统没有表现出交替的簇放电（例如，在瞬态后 $\\Delta(t)$ 的上穿次数少于两次），则将IBI和终止时的平均 $x$ 值均报告为 $0.0$。\n\n6. 除非在测试用例中另有说明，否则使用以下固定参数：\n   - $r_{\\max} = 100 \\ \\mathrm{s}^{-1}$，$a = 4.0$，$\\theta = 1.0$，$I_0 = 1.3$，$w = 3.0$。\n   - $\\tau_r = 0.02 \\ \\mathrm{s}$，$\\Delta t = 0.001 \\ \\mathrm{s}$，$T_{\\mathrm{sim}} = 20.0 \\ \\mathrm{s}$。\n   - 初始条件：$r_1(0) = 2.0 \\ \\mathrm{s}^{-1}$，$r_2(0) = 1.0 \\ \\mathrm{s}^{-1}$，$x_1(0) = x_2(0) = 1.0$。\n\n7. 测试套件：\n   对于每个测试用例，按规定改变 $(\\tau_{\\mathrm{rec}}, u)$，并使用上述固定参数。对每种情况进行模拟，并产生一对输出：以 $\\mathrm{s}$ 为单位的平均簇放电间期和终止时的平均 $x$ 值（无量纲），两者都四舍五入到三位小数。测试用例如下：\n   - 案例A (理想情况)：$\\tau_{\\mathrm{rec}} = 0.5 \\ \\mathrm{s}$, $u = 0.5$。\n   - 案例B (慢恢复)：$\\tau_{\\mathrm{rec}} = 1.5 \\ \\mathrm{s}$, $u = 0.5$。\n   - 案例C (较弱、较快的动力学)：$\\tau_{\\mathrm{rec}} = 0.3 \\ \\mathrm{s}$, $u = 0.3$。\n   - 案例D (无抑制的边界情况)：$\\tau_{\\mathrm{rec}} = 0.5 \\ \\mathrm{s}$, $u = 0.0$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个含四个项目的列表，每个测试用例一项，其中每个项目本身是一个包含两个浮点数的列表，顺序为 [mean_IBI_in_seconds, mean_x_at_termination]。输出必须严格按照方括号括起来的逗号分隔列表的形式打印，例如：\n[[ibi_A,xterm_A],[ibi_B,xterm_B],[ibi_C,xterm_C],[ibi_D,xterm_D]]\n所有时间都必须以 $\\mathrm{s}$ 为单位，并按标准舍入规则四舍五入到三位小数。如果某个案例未检测到交替簇放电，则该案例打印 [0.0,0.0]。", "solution": "该问题陈述是计算神经科学领域一个有效的练习。它在科学上基于已建立的神经元和突触动力学原理，问题定义明确，所有必要的方程和参数都已定义，并且其表述是客观的。我们将首先推导完整的微分方程组，然后预先描述数值模拟和分析方法，最后针对指定的测试用例执行模拟。\n\n**1. 模型方程的推导**\n\n该系统由两个相同的、相互抑制的神经元单元组成，索引为 $i \\in \\{1, 2\\}$，单元 $i$ 的突触前伙伴表示为 $j \\neq i$。系统的状态由四个变量描述：发放率 $r_1(t)$ 和 $r_2(t)$，以及可用突触资源的分数 $x_1(t)$ 和 $x_2(t)$。\n\n**突触资源动力学：**\n神经元 $i$ 的可用突触资源分数 $x_i(t)$ 的动力学由两个竞争过程控制：恢复和耗竭。\n- 恢复：资源池会补充至其最大归一化值 $1$。这被建模为一个时间常数为 $\\tau_{\\mathrm{rec}}$ 的一阶过程，贡献项为 $\\frac{1 - x_i(t)}{\\tau_{\\mathrm{rec}}}$。\n- 耗竭：资源被突触前活动所消耗。消耗速率与突触前发放率 $r_i(t)$、可用资源量 $x_i(t)$ 以及利用因子 $u$ 成正比。这贡献了一个项 $-u \\, x_i(t) \\, r_i(t)$。\n\n将这些结合起来，得到突触资源分数的微分方程：\n$$\n\\frac{dx_i}{dt} = \\frac{1 - x_i}{\\tau_{\\mathrm{rec}}} - u \\, x_i \\, r_i\n$$\n该方程对 $i=1$ 和 $i=2$ 均成立。\n\n**神经元发放率动力学：**\n每个神经元的发放率 $r_i(t)$ 向由其净输入 $h_i(t)$ 决定的一个值弛豫。这被建模为一个时间常数为 $\\tau_r$ 的一阶低通滤波器：\n$$\n\\tau_r \\frac{dr_i}{dt} = -r_i + F(h_i)\n$$\n其中 $F(h_i)$ 是静态输入-输出函数。\n\n神经元 $i$ 的净输入 $h_i$ 是恒定外部驱动 $I_0$ 与来自神经元 $j$ 的突触抑制之和。问题指定来自神经元 $j$ 的有效抑制驱动，我们称之为 $I_{syn, j}$，与利用率 $u$、可用资源 $x_j$ 和突触前发放率 $r_j$ 的乘积成正比。因此，$I_{syn, j}(t) = u \\, x_j(t) \\, r_j(t)$。于是，到神经元 $i$ 的总输入为：\n$$\nh_i(t) = I_0 - w \\, I_{syn, j}(t) = I_0 - w \\, u \\, x_j(t) \\, r_j(t)\n$$\n其中 $w$ 是无量纲的突触耦合强度。\n\n静态输入-输出函数 $F(h)$ 以S型函数形式给出：\n$$\nF(h) = \\frac{r_{\\max}}{1 + \\exp(-a(h - \\theta))}\n$$\n其中 $r_{\\max}$ 是最大发放率，$a$ 是斜率，$\\theta$ 是阈值。\n\n**完整的常微分方程（ODE）系统：**\n完整的模型是一个由四个耦合的非线性ODE组成的系统，描述了 $(r_1, r_2, x_1, x_2)$ 的演化过程：\n$$\n\\frac{dr_1}{dt} = \\frac{1}{\\tau_r} \\left( -r_1 + \\frac{r_{\\max}}{1 + \\exp(-a(I_0 - w \\, u \\, x_2 \\, r_2 - \\theta))} \\right)\n$$\n$$\n\\frac{dr_2}{dt} = \\frac{1}{\\tau_r} \\left( -r_2 + \\frac{r_{\\max}}{1 + \\exp(-a(I_0 - w \\, u \\, x_1 \\, r_1 - \\theta))} \\right)\n$$\n$$\n\\frac{dx_1}{dt} = \\frac{1 - x_1}{\\tau_{\\mathrm{rec}}} - u \\, x_1 \\, r_1\n$$\n$$\n\\frac{dx_2}{dt} = \\frac{1 - x_2}{\\tau_{\\mathrm{rec}}} - u \\, x_2 \\, r_2\n$$\n\n**2. 数值模拟与分析**\n\n我们将使用前向欧拉法和固定的时间步长 $\\Delta t$ 对该系统进行积分。对于具有动力学 $\\frac{dy}{dt} = f(y, t)$ 的通用状态变量 $y(t)$，更新规则为：\n$$\ny(t + \\Delta t) = y(t) + \\Delta t \\cdot f(y(t), t)\n$$\n此规则在每个时间步长应用于所有四个状态变量。为确保满足物理约束，每次更新步骤后，发放率 $r_i$ 将被截断在0（即 $r_i = \\max(0, r_i)$），资源分数 $x_i$ 将被截断在区间 $[0, 1]$ 内。\n\n模拟运行总时长为 $T_{\\mathrm{sim}}$。设置初始条件以打破对称性并引发振荡：$r_1(0) = 2.0 \\ \\mathrm{s}^{-1}$，$r_2(0) = 1.0 \\ \\mathrm{s}^{-1}$，以及 $x_1(0) = x_2(0) = 1.0$。\n\n模拟后，我们分析所得的时间序列以计算所需指标。一个覆盖模拟前半段（$t \\in [0, T_{\\mathrm{sim}}/2]$）的初始瞬态周期被丢弃，以确保测量是在稳态振荡行为下进行的。\n\n- **活动差异：** 我们计算 $\\Delta(t) = r_1(t) - r_2(t)$。\n- **事件检测：** 我们识别出 $\\Delta(t)$ 穿过零的所有时间点。如果在时间步 $t_k = k \\Delta t$ 和 $t_{k+1}$ 之间 $\\Delta(t_k) \\cdot \\Delta(t_{k+1})  0$，则发生了一次穿越。\n    - 一次 **上穿** （单元1簇放电的开始）发生在 $\\Delta(t_k)  0$ 且 $\\Delta(t_{k+1}) \\geq 0$ 时。\n    - 一次 **下穿** （单元1簇放电的结束）发生在 $\\Delta(t_k) > 0$ 且 $\\Delta(t_{k+1}) \\leq 0$ 时。\n- **簇放电间期 (IBI)：** 我们找到瞬态期之后发生的所有上穿时间 $t_{up}$。IBI是连续两次上穿之间的时间差。计算这些IBI的平均值。如果在分析窗口中找到的上穿次数少于两次，则无法计算IBI，平均IBI报告为 $0.0$。\n- **终止时的突触资源 ($x_{\\mathrm{term}}$)：** 在瞬态后的每个零点穿越时刻 $t_k$，我们记录符号变化前刚刚处于活动状态的神经元的资源水平。使用 $t_k^- \\approx t_k$ 处的值。\n    - 如果 $\\Delta(t_k) > 0$（一次下穿），则单元1是活动的。我们记录 $x_1(t_k)$。\n    - 如果 $\\Delta(t_k)  0$（一次上穿），则单元2是活动的。我们记录 $x_2(t_k)$。\n    计算这些记录的资源值的平均值。如果分析窗口内没有发生穿越，则平均值报告为 $0.0$。\n\n$u=0$ 的特殊情况（案例D）对应于非耦合神经元。在这种情况下，抑制项 $w \\, u \\, x_j \\, r_j$ 为零，两个神经元将独立地收敛到一个由 $r^* = F(I_0)$ 给出的稳定稳态。不会发生振荡，因此 $\\Delta(t)$ 不会穿过零点。如果分析窗口中找到的上穿次数少于两次，这正确地得出了IBI和 $x_{\\mathrm{term}}$ 均为 $0.0$。\n\n对每个测试用例实施上述程序，以产生最终结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n\n    # Fixed parameters as specified in the problem statement.\n    r_max = 100.0  # s^-1\n    a = 4.0      # dimensionless\n    theta = 1.0  # dimensionless\n    I_0 = 1.3    # dimensionless\n    w = 3.0      # dimensionless\n    tau_r = 0.02   # s\n    dt = 0.001   # s\n    T_sim = 20.0   # s\n\n    # Initial conditions.\n    r1_0 = 2.0  # s^-1\n    r2_0 = 1.0  # s^-1\n    x1_0 = 1.0  # dimensionless\n    x2_0 = 1.0  # dimensionless\n\n    # Test cases: (tau_rec, u)\n    test_cases = [\n        (0.5, 0.5),  # Case A\n        (1.5, 0.5),  # Case B\n        (0.3, 0.3),  # Case C\n        (0.5, 0.0),  # Case D\n    ]\n\n    all_results = []\n\n    for tau_rec, u in test_cases:\n        # Number of time steps\n        num_steps = int(T_sim / dt)\n        \n        # State variable arrays\n        r1 = np.zeros(num_steps)\n        r2 = np.zeros(num_steps)\n        x1 = np.zeros(num_steps)\n        x2 = np.zeros(num_steps)\n        t = np.linspace(0, T_sim, num_steps)\n\n        # Set initial conditions\n        r1[0] = r1_0\n        r2[0] = r2_0\n        x1[0] = x1_0\n        x2[0] = x2_0\n\n        # Static sigmoidal nonlinearity F(h)\n        def F(h):\n            return r_max / (1.0 + np.exp(-a * (h - theta)))\n\n        # Forward Euler integration loop\n        for k in range(num_steps - 1):\n            # Calculate inputs to each neuron\n            h1 = I_0 - w * u * x2[k] * r2[k]\n            h2 = I_0 - w * u * x1[k] * r1[k]\n\n            # Calculate derivatives\n            dr1_dt = (-r1[k] + F(h1)) / tau_r\n            dr2_dt = (-r2[k] + F(h2)) / tau_r\n            dx1_dt = (1.0 - x1[k]) / tau_rec - u * x1[k] * r1[k]\n            dx2_dt = (1.0 - x2[k]) / tau_rec - u * x2[k] * r2[k]\n\n            # Update state variables\n            r1[k+1] = r1[k] + dt * dr1_dt\n            r2[k+1] = r2[k] + dt * dr2_dt\n            x1[k+1] = x1[k] + dt * dx1_dt\n            x2[k+1] = x2[k] + dt * dx2_dt\n\n            # Apply physical constraints (clipping)\n            r1[k+1] = max(0.0, r1[k+1])\n            r2[k+1] = max(0.0, r2[k+1])\n            x1[k+1] = np.clip(x1[k+1], 0.0, 1.0)\n            x2[k+1] = np.clip(x2[k+1], 0.0, 1.0)\n\n        # Analysis of results\n        delta = r1 - r2\n        \n        # Find all zero-crossings\n        # np.diff(np.sign(delta)) is non-zero at crossings\n        crossings_indices = np.where(np.diff(np.sign(delta)))[0]\n\n        # Define transient discard time\n        analysis_start_time = T_sim / 2.0\n        \n        # Find up-crossings (delta changes from - to +)\n        # This means delta[k]  0 and delta[k+1] > 0\n        up_crossing_indices = crossings_indices[delta[crossings_indices]  0]\n        up_crossing_times = t[up_crossing_indices]\n\n        # Filter events after transient period\n        valid_up_crossing_times = up_crossing_times[up_crossing_times > analysis_start_time]\n\n        # Calculate mean IBI\n        if len(valid_up_crossing_times) >= 2:\n            ibis = np.diff(valid_up_crossing_times)\n            mean_ibi = np.mean(ibis)\n        else:\n            mean_ibi = 0.0\n\n        # Calculate mean x at termination\n        term_x_values = []\n        valid_crossings_indices = crossings_indices[t[crossings_indices] > analysis_start_time]\n\n        for idx in valid_crossings_indices:\n            # If delta[idx] > 0, it means the crossing is from + to -, so neuron 1 was active\n            if delta[idx] > 0:\n                term_x_values.append(x1[idx])\n            # If delta[idx]  0, it means the crossing is from - to +, so neuron 2 was active\n            else:\n                term_x_values.append(x2[idx])\n\n        if term_x_values:\n            mean_x_term = np.mean(term_x_values)\n        else:\n            mean_x_term = 0.0\n\n        # A special check for the case of no oscillations at all\n        # If fewer than 2 total up-crossings, it is non-oscillatory.\n        if len(up_crossing_times)  2:\n            mean_ibi = 0.0\n            mean_x_term = 0.0\n\n        all_results.append([round(mean_ibi, 3), round(mean_x_term, 3)])\n\n    # Format final output as a list of lists\n    output_str = \"[\" + \",\".join([f\"[{ibi},{x}]\" for ibi, x in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2557001"}]}