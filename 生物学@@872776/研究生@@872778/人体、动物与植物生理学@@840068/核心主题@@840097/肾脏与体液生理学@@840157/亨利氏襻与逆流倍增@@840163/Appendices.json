{"hands_on_practices": [{"introduction": "肾脏维持皮质-髓质渗透压梯度的能力并非没有代价；它是一个耗费大量能量的过程。这个实践练习旨在将逆流倍增的宏观生理功能与其细胞层面的能量代谢基础联系起来。通过这个计算，您将学习如何利用基本的生理参数，如肾小球滤过率（$GFR$）和血浆钠浓度，来估算髓袢升支粗段（TAL）为主动重吸收盐分所必须消耗的$ATP$ [@problem_id:2617824]。这项练习能够加深您对维持渗透压梯度所需生物能量成本的理解，并将抽象的生理学概念转化为具体的定量分析。", "problem": "生理上正常的成年人肾脏在亨利袢中运行逆流倍增器，以维持从皮质到乳头尖约 $900\\,\\text{mOsm}$ 的皮质髓质渗透压差。在稳态下，假设亨利袢的粗升支（TAL）重吸收的氯化钠通量等于滤过钠负荷的 $0.25$。假设以下基本事实：\n- 滤过的钠负荷等于肾小球滤过率（GFR）与血浆钠浓度的乘积。\n- 在TAL中，氯离子在电化学和渗透压上跟随钠离子，但能量成本主要由通过钠钾三磷酸腺苷酶（$\\mathrm{Na}^{+}/\\mathrm{K}^{+}$-ATPase）的基底外侧钠离子外排所决定，该过程每水解一个三磷酸腺苷（ATP）分子可排出 $3$ 个钠离子。\n- 在这些条件下，TAL上皮细胞对水有效不通透，并且钾离子在顶端循环，因此化学计量的能量负荷可归因于钠离子的外排。\n\n给定肾小球滤过率为 $120\\,\\text{mL}\\,\\text{min}^{-1}$，血浆钠浓度为 $140\\,\\text{mmol}\\,\\text{L}^{-1}$，计算TAL为重吸收足以支持 $900\\,\\text{mOsm}$ 皮质髓质梯度的特定氯化钠通量所需的ATP消耗速率。请以 $\\text{mmol}\\,\\text{min}^{-1}$ 为单位表示最终答案，并四舍五入至三位有效数字。", "solution": "该问题要求计算亨利袢粗升支（TAL）的三磷酸腺苷（ATP）消耗速率。首先对问题陈述进行验证。\n\n**问题验证**\n\n步骤1：提取已知条件\n- 皮质髓质渗透压差：约 $900\\,\\text{mOsm}$。\n- TAL重吸收的滤过钠负荷分数，$f_{Na, \\text{TAL}}$: $0.25$。\n- 滤过钠负荷的定义：肾小球滤过率（GFR）$\\times$ 血浆钠浓度（$P_{Na}$）。\n- $\\mathrm{Na}^{+}/\\mathrm{K}^{+}$-ATPase的化学计量：每水解 $1$ 个 ATP 分子排出 $3$ 个钠离子（$Na^+$）。\n- TAL上皮对水不通透。\n- 肾小球滤过率, GFR: $120\\,\\text{mL}\\,\\text{min}^{-1}$。\n- 血浆钠浓度, $P_{Na}$: $140\\,\\text{mmol}\\,\\text{L}^{-1}$。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，所有给定的值（GFR、$P_{Na}$、渗透压梯度）均在健康人体的标准生理范围内。所引用的原理，如逆流倍增器的功能、TAL的作用以及$\\mathrm{Na}^{+}/\\mathrm{K}^{+}$-ATPase的化学计量，都是肾脏生理学和细胞生物学的基本事实。该问题提法明确；它提供了一个清晰的目标和所有必要的定量数据以获得唯一解。关于 $900\\,\\text{mOsm}$ 梯度的信息是作为生理背景，说明所指定的钠通量足以维持该梯度，但它不是计算的直接输入值。这并不使问题不完整或矛盾。语言精确客观。没有逻辑不一致、事实错误或含糊之处。\n\n步骤3：结论与行动\n该问题被判定为**有效**。将推导解答。\n\n**解答推导**\n\n目标是计算TAL中的ATP消耗速率，记为 $R_{\\text{ATP, TAL}}$。解答通过三个逻辑步骤推导得出。\n\n首先，我们计算滤过钠负荷 $L_{Na}$。它被定义为肾小球滤过率（GFR）与血浆钠浓度（$P_{Na}$）的乘积。\n$$L_{Na} = \\text{GFR} \\times P_{Na}$$\n单位必须保持一致。给定的GFR为 $120\\,\\text{mL}\\,\\text{min}^{-1}$，等同于 $0.120\\,\\text{L}\\,\\text{min}^{-1}$。血浆钠浓度为 $140\\,\\text{mmol}\\,\\text{L}^{-1}$。\n$$L_{Na} = (0.120\\,\\text{L}\\,\\text{min}^{-1}) \\times (140\\,\\text{mmol}\\,\\text{L}^{-1})$$\n$$L_{Na} = 16.8\\,\\text{mmol}\\,\\text{min}^{-1}$$\n\n其次，我们确定TAL中的钠重吸收速率 $R_{Na, \\text{TAL}}$。问题陈述此速率是滤过负荷的一个分数，即 $f_{Na, \\text{TAL}} = 0.25$。\n$$R_{Na, \\text{TAL}} = f_{Na, \\text{TAL}} \\times L_{Na}$$\n代入数值：\n$$R_{Na, \\text{TAL}} = 0.25 \\times 16.8\\,\\text{mmol}\\,\\text{min}^{-1}$$\n$$R_{Na, \\text{TAL}} = 4.2\\,\\text{mmol}\\,\\text{min}^{-1}$$\n\n第三，我们计算ATP消耗速率 $R_{\\text{ATP, TAL}}$。通过$\\mathrm{Na}^{+}/\\mathrm{K}^{+}$-ATPase将钠从TAL细胞中运出到基底外侧，是跨上皮NaCl重吸收的主要耗能步骤。给出的化学计量是每摩尔ATP水解运输 $3$ 摩尔Na$^+$。因此，ATP的消耗速率是钠重吸收速率的三分之一。\n$$R_{\\text{ATP, TAL}} = \\frac{R_{Na, \\text{TAL}}}{3}$$\n代入计算出的钠重吸收速率：\n$$R_{\\text{ATP, TAL}} = \\frac{4.2\\,\\text{mmol}\\,\\text{min}^{-1}}{3}$$\n$$R_{\\text{ATP, TAL}} = 1.4\\,\\text{mmol}\\,\\text{min}^{-1}$$\n\n问题要求最终答案四舍五入到三位有效数字。计算值为 $1.4$。为了用三位有效数字表示，我们写作 $1.40$。因此，最终答案是 $1.40\\,\\text{mmol}\\,\\text{min}^{-1}$。", "answer": "$$\\boxed{1.40}$$", "id": "2617824"}, {"introduction": "理解了逆流系统的基本运行原理后，我们可以进一步探讨如何通过药理学手段对其进行干预。本练习构建了一个简化的稳态模型，用于模拟袢利尿剂（如呋塞米）对最大尿渗透压的影响。您将通过该模型，探索抑制髓袢升支粗段上的$NKCC2$转运蛋白如何直接削弱“单一效应”，并最终降低肾脏的尿液浓缩能力 [@problem_id:2617889]。这个思想实验清晰地揭示了从分子靶点（$NKCC2$）到生理效应（尿液浓缩能力下降）的传导路径，是理解肾脏药理学和相关病理生理变化的关键一步。", "problem": "髓袢升支粗段通过2型钠-钾-2氯共转运体（NKCC2）主动重吸收氯化钠，并且有效不透水，从而建立了一个横向的皮质-髓质“单一效应”，该效应通过逆流在轴向上被倍增。考虑一个简化的逆流倍增稳态模型，该模型满足以下条件：\n\n- 皮质间质的渗透压浓度为 $300 \\, \\mathrm{mOsm/kg \\, H_2O}$。\n- 在没有药物的情况下，髓袢升支粗段在每个轴向水平上产生的横向单一效应大小为 $\\Delta C_{0} = 205 \\, \\mathrm{mOsm/kg \\, H_2O}$。\n- 系统的轴向范围和髓袢分布可以用一个有效的逆流倍增重复次数 $N = 3$ 来表示（这是一个代表长度和混合的非整数代理参数，它决定了单一效应沿皮质髓质轴施加的次数）。\n- 在所考虑的条件下，内髓质尿素再循环为乳头间质额外贡献了 $300 \\, \\mathrm{mOsm/kg \\, H_2O}$，并且不受髓袢利尿剂的影响。\n- 在抗利尿激素（ADH）存在的情况下，集合管在每个水平上与周围间质达到渗透压平衡，因此最大尿渗透压浓度等于乳头间质的渗透压浓度。\n\n一定剂量的呋塞米（furosemide）导致对 NKCC2 的部分阻断，阻断分数为 $f = 0.70$。假设在稳态下，单一效应大小 $\\Delta C$ 与剩余的 NKCC2 活性成正比，并且其他上皮细胞的通透性保持不变。\n\n仅使用这些前提和逆流倍增的基本原理，推导呋塞米如何改变单一效应，以及这种改变如何传递到乳头间质渗透压浓度。然后计算该给药方案所导致的最大尿渗透压浓度的下降值。\n\n将最终数值答案四舍五入到四位有效数字，并以 $\\mathrm{mOsm/kg \\, H_2O}$ 为单位表示。", "solution": "所述问题具有科学依据且定义明确，可以直接进行解析求解。我们根据所提供简化模型描述的逆流倍增基本原理进行推导。\n\n在抗利尿条件下，最大尿渗透压浓度 $U_{osm,max}$ 等于乳头间质的渗透压浓度 $C_{papilla}$。根据模型定义，该渗透压浓度是以下三个部分的总和：\n1. 皮质间质的渗透压浓度 $C_{cortex}$，即进入系统的液体的基线渗透压浓度。\n2. 由髓袢的逆流倍增器产生的总渗透压梯度，其值为单一效应大小 $\\Delta C$ 与有效倍增重复次数 $N$ 的乘积。\n3. 尿素再循环对乳头的额外渗透压贡献，我们将其表示为 $C_{urea}$。\n\n因此，最大尿渗透压浓度的控制方程为：\n$$U_{osm,max} = C_{papilla} = C_{cortex} + N \\cdot \\Delta C + C_{urea}$$\n\n我们已知以下参数：\n- 皮质间质渗透压浓度：$C_{cortex} = 300 \\, \\mathrm{mOsm/kg \\, H_2O}$\n- 基线单一效应大小：$\\Delta C_{0} = 205 \\, \\mathrm{mOsm/kg \\, H_2O}$\n- 有效重复次数：$N = 3$\n- 尿素对乳头渗透压浓度的贡献：$C_{urea} = 300 \\, \\mathrm{mOsm/kg \\, H_2O}$\n\n首先，我们计算没有任何药物时的基线最大尿渗透压浓度 $U_{osm,max,0}$。我们使用基线单一效应 $\\Delta C_{0}$。\n$$U_{osm,max,0} = C_{cortex} + N \\cdot \\Delta C_{0} + C_{urea}$$\n代入给定值：\n$$U_{osm,max,0} = 300 + (3 \\times 205) + 300$$\n$$U_{osm,max,0} = 300 + 615 + 300 = 1215 \\, \\mathrm{mOsm/kg \\, H_2O}$$\n\n接下来，我们评估呋塞米的作用。呋塞米导致 NKCC2 转运体的部分阻断，阻断分数为 $f = 0.70$。问题陈述指出，单一效应大小 $\\Delta C$ 与剩余的 NKCC2 活性成正比。剩余活性为 $(1-f)$。因此，在存在呋塞米的情况下，新的单一效应大小 $\\Delta C_{f}$ 为：\n$$\\Delta C_{f} = \\Delta C_{0} \\cdot (1 - f)$$\n代入 $\\Delta C_{0}$ 和 $f$ 的值：\n$$\\Delta C_{f} = 205 \\cdot (1 - 0.70) = 205 \\cdot 0.30 = 61.5 \\, \\mathrm{mOsm/kg \\, H_2O}$$\n\n现在，我们计算在呋塞米影响下的新的最大尿渗透压浓度 $U_{osm,max,f}$。问题陈述说明参数 $C_{cortex}$、$N$ 和 $C_{urea}$ 不受影响。我们使用修正后的单一效应 $\\Delta C_{f}$。\n$$U_{osm,max,f} = C_{cortex} + N \\cdot \\Delta C_{f} + C_{urea}$$\n代入相应的值：\n$$U_{osm,max,f} = 300 + (3 \\times 61.5) + 300$$\n$$U_{osm,max,f} = 300 + 184.5 + 300 = 784.5 \\, \\mathrm{mOsm/kg \\, H_2O}$$\n\n最后，问题要求计算最大尿渗透压浓度的下降值。这是基线渗透压浓度与使用呋塞米后的渗透压浓度之差。设此下降值为 $\\Delta U_{osm,max}$。\n$$\\Delta U_{osm,max} = U_{osm,max,0} - U_{osm,max,f}$$\n$$\\Delta U_{osm,max} = 1215 - 784.5 = 430.5 \\, \\mathrm{mOsm/kg \\, H_2O}$$\n\n结果必须四舍五入到四位有效数字。计算出的值 $430.5$ 已经有四位有效数字。因此，无需进一步四舍五入。", "answer": "$$\\boxed{430.5}$$", "id": "2617889"}, {"introduction": "前面的练习侧重于稳态分析，然而，生物系统是动态的，其对扰动的响应过程同样重要。这项高级计算实践要求您建立并求解一个动态模型，以模拟当主动盐转运（通过$NKCC2$）突然停止后，肾髓质间质渗透压的“冲刷”过程。您将通过求解耦合的常微分方程，追踪盐和尿素浓度的实时变化，揭示它们在维持和消除渗透压梯度过程中的复杂相互作用 [@problem_id:2617861]。这项练习不仅能提升您的计算生理学建模能力，还能让您深入洞察肾髓质环境中溶质动态平衡的内在机制。", "problem": "您需要实现并分析一个最小的、有科学依据的动力学模型，该模型描述了在钠-钾-2氯协同转运蛋白（NKCC2）介导的转运突然停止后，肾内髓部间质的冲刷过程。该模型在一个固定的间质体积内，追踪两种溶质——氯化钠和尿素——的间质浓度 $C_{\\mathrm{Na}}(t)$ 和 $C_{\\mathrm{U}}(t)$（单位为 $\\mathrm{mM}$）随时间 $t$（单位为分钟）的变化。程序必须计算在 NKCC2 停止工作后，氯化钠和尿素对观测到的总间质渗透压下降的相对贡献。\n\n使用以下基本原理：\n- 质量守恒：间质溶质浓度的变化率等于按单位体积缩放后的流入量减去流出量。\n- 与直管血管的 Fick 式/一级交换：一个与间质和血浆之间的浓度梯度成正比的线性汇。\n- 一个唯象的、依赖于渗透压的尿素再循环源，其强度随皮质-髓质渗透压差的增加而增加。\n\n对于 $t \\ge 0$ 的模型方程：\n1. 氯化钠动力学：\n$$\n\\frac{d C_{\\mathrm{Na}}}{d t} \\;=\\; J_{\\mathrm{NKCC2}}(t) \\;-\\; k_{\\mathrm{vr,Na}}\\left(C_{\\mathrm{Na}} - C_{\\mathrm{Na,pl}} \\right),\n$$\n其中 $J_{\\mathrm{NKCC2}}(t)$ 是 NKCC2 源项，单位为 $\\mathrm{mM}\\,\\mathrm{min}^{-1}$；$k_{\\mathrm{vr,Na}}$ 是氯化钠的直管血管交换速率常数，单位为 $\\mathrm{min}^{-1}$；$C_{\\mathrm{Na,pl}}$ 是血浆氯化钠浓度，单位为 $\\mathrm{mM}$。在 $t = 0$ 时，NKCC2 活性突然停止：\n$$\nJ_{\\mathrm{NKCC2}}(t) \\;=\\; 0 \\quad \\text{for all } t \\ge 0.\n$$\n\n2. 具有渗透压依赖性再循环的尿素动力学：\n$$\n\\frac{d C_{\\mathrm{U}}}{d t} \\;=\\; J_{\\mathrm{U}}\\!\\left(C_{\\mathrm{Na}} + C_{\\mathrm{U}}\\right) \\;-\\; k_{\\mathrm{vr,U}}\\left(C_{\\mathrm{U}} - C_{\\mathrm{U,pl}} \\right),\n$$\n其中 $k_{\\mathrm{vr,U}}$ 是尿素的直管血管交换速率常数，单位为 $\\mathrm{min}^{-1}$；$C_{\\mathrm{U,pl}}$ 是血浆尿素浓度，单位为 $\\mathrm{mM}$；尿素再循环源 $J_{\\mathrm{U}}$ 依赖于总间质渗透压相对于血浆渗透压的值：\n$$\nJ_{\\mathrm{U}}(C_{\\mathrm{tot}}) \\;=\\; \\alpha \\,\\max\\!\\Big(C_{\\mathrm{tot}} - C_{\\mathrm{tot,pl}},\\, 0\\Big),\n\\quad\nC_{\\mathrm{tot}} \\;=\\; C_{\\mathrm{Na}} + C_{\\mathrm{U}},\n\\quad\nC_{\\mathrm{tot,pl}} \\;=\\; C_{\\mathrm{Na,pl}} + C_{\\mathrm{U,pl}}.\n$$\n\n$t=0^+$ 时的初始条件是停止前的稳态浓度 $C_{\\mathrm{Na}}(0) = C_{\\mathrm{Na},0}$ 和 $C_{\\mathrm{U}}(0) = C_{\\mathrm{U},0}$，该稳态是在恒定的停止前源项作用下维持的。与停止前稳态的一致性意味着：\n- 对于 $t0$ 时的氯化钠：停止前的 NKCC2 源必须与直管血管的外流相平衡。因此，需要使用给定的停止前浓度和参数，根据稳态条件确定停止前的 NKCC2 源 $J_{\\mathrm{NKCC2,on}}$。\n- 对于 $t0$ 时的尿素：停止前的尿素再循环源必须与直管血管的外流相平衡。选择 $\\alpha$ 的值，使得对于给定的停止前浓度和参数，停止前的稳态得以维持。\n\n您的程序必须：\n1. 对于每个测试用例，根据指定的停止前稳态浓度和交换参数，计算在 $t=0^-$ 时强制使 $d C_{\\mathrm{Na}}/dt = 0$ 和 $d C_{\\mathrm{U}}/dt = 0$ 的停止前源参数。\n2. 在 $t=0$ 时，对于所有 $t \\ge 0$，设置 $J_{\\mathrm{NKCC2}}(t) = 0$，并将 $\\alpha$ 固定为其停止前的值。\n3. 将耦合常微分方程组向前积分至时间 $T_{\\mathrm{end}}$（单位为分钟）。\n4. 将 $[0, T_{\\mathrm{end}}]$ 时间段内的总渗透压下降定义为\n$$\n\\Delta C_{\\mathrm{tot}} \\;=\\; \\left(C_{\\mathrm{Na},0} - C_{\\mathrm{Na}}(T_{\\mathrm{end}})\\right) \\;+\\; \\left(C_{\\mathrm{U},0} - C_{\\mathrm{U}}(T_{\\mathrm{end}})\\right).\n$$\n5. 通过以下分数来量化相对贡献\n$$\nf_{\\mathrm{Na}} \\;=\\; \\frac{C_{\\mathrm{Na},0} - C_{\\mathrm{Na}}(T_{\\mathrm{end}})}{\\Delta C_{\\mathrm{tot}}}, \n\\qquad\nf_{\\mathrm{U}} \\;=\\; \\frac{C_{\\mathrm{U},0} - C_{\\mathrm{U}}(T_{\\mathrm{end}})}{\\Delta C_{\\mathrm{tot}}},\n$$\n并约定如果 $\\Delta C_{\\mathrm{tot}} = 0$，则 $f_{\\mathrm{Na}} = 0$ 且 $f_{\\mathrm{U}} = 0$。将 $f_{\\mathrm{Na}}$ 和 $f_{\\mathrm{U}}$ 作为无量纲小数报告，并四舍五入到四位小数。\n\n物理和数值单位：\n- 浓度 $C_{\\mathrm{Na}}$、$C_{\\mathrm{U}}$、$C_{\\mathrm{Na,pl}}$、$C_{\\mathrm{U,pl}}$ 的单位是 $\\mathrm{mM}$。\n- 速率常数 $k_{\\mathrm{vr,Na}}$、$k_{\\mathrm{vr,U}}$ 和 $\\alpha$ 的单位是 $\\mathrm{min}^{-1}$。\n- 时间 $t$ 和 $T_{\\mathrm{end}}$ 的单位是 $\\mathrm{min}$。\n- 输出的分数 $f_{\\mathrm{Na}}$ 和 $f_{\\mathrm{U}}$ 是无量纲小数。将每个值表示为四舍五入到四位的小数。\n\n测试套件：\n实现您的程序以运行以下四个测试用例。对于每个元组，参数为 $(C_{\\mathrm{Na,pl}},\\, C_{\\mathrm{U,pl}},\\, k_{\\mathrm{vr,Na}},\\, k_{\\mathrm{vr,U}},\\, C_{\\mathrm{Na},0},\\, C_{\\mathrm{U},0},\\, T_{\\mathrm{end}})$：\n- 用例 1（通用情况）：$(140,\\, 5,\\, 0.1,\\, 0.05,\\, 600,\\, 600,\\, 30)$\n- 用例 2（边界情况，无尿素冲刷汇）：$(140,\\, 5,\\, 0.1,\\, 0,\\, 600,\\, 600,\\, 30)$\n- 用例 3（快速冲刷）：$(140,\\, 5,\\, 0.5,\\, 0.5,\\, 600,\\, 600,\\, 10)$\n- 用例 4（尿素主导的初始状态）：$(140,\\, 5,\\, 0.1,\\, 0.05,\\, 400,\\, 800,\\, 30)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个类 JSON 格式的数组，该数组有四个项目，每个测试用例对应一个。每个项目是一个双元素数组 $[f_{\\mathrm{Na}}, f_{\\mathrm{U}}]$，其值四舍五入到四位小数。例如，打印的行应类似于\n$[[0.7000,0.3000],[1.0000,0.0000],[\\dots,\\dots],[\\dots,\\dots]]$\n但使用为指定测试套件计算出的实际值。", "solution": "问题陈述被认为是有效的。它提出了一个计算生理学领域中有科学依据且适定性的问题，不含主观论断或事实错误。\n\n该模型是肾髓质中溶质动力学的一个标准（尽管是简化的）表示，基于质量守恒和生物物理运输的基本原理。所有参数、初始条件和目标都已明确定义，从而可以得到唯一且有意义的解。\n\n该问题要求对一个耦合常微分方程组（ODEs）进行数值求解，该方程组模拟了在 NKCC2 协同转运蛋白介导的活性盐转运突然中止后，肾内髓部间质中氯化钠（$C_{\\mathrm{Na}}$）和尿素（$C_{\\mathrm{U}}$）浓度的时间演化。我们的目标是确定在指定时间段内，每种溶质对间质渗透压总冲刷的相对贡献。\n\n对于 $t \\ge 0$ 的控制方程为：\n$$\n\\frac{d C_{\\mathrm{Na}}}{d t} = - k_{\\mathrm{vr,Na}}\\left(C_{\\mathrm{Na}} - C_{\\mathrm{Na,pl}} \\right)\n$$\n$$\n\\frac{d C_{\\mathrm{U}}}{d t} = J_{\\mathrm{U}}(C_{\\mathrm{tot}}) - k_{\\mathrm{vr,U}}\\left(C_{\\mathrm{U}} - C_{\\mathrm{U,pl}} \\right)\n$$\n其中 $C_{\\mathrm{tot}} = C_{\\mathrm{Na}} + C_{\\mathrm{U}}$。尿素再循环源项 $J_{\\mathrm{U}}$ 依赖于间质总渗透压与血浆总渗透压（$C_{\\mathrm{tot,pl}} = C_{\\mathrm{Na,pl}} + C_{\\mathrm{U,pl}}$）之间的梯度：\n$$\nJ_{\\mathrm{U}}(C_{\\mathrm{tot}}) = \\alpha \\,\\max\\!\\Big(C_{\\mathrm{tot}} - C_{\\mathrm{tot,pl}},\\, 0\\Big)\n$$\n该系统从初始条件 $C_{\\mathrm{Na}}(0) = C_{\\mathrm{Na},0}$ 和 $C_{\\mathrm{U}}(0) = C_{\\mathrm{U},0}$ 开始积分。\n\n关键的第一步是通过指定的停止前（$t  0$）稳态条件（其中 $\\frac{dC}{dt}=0$）来确定参数 $\\alpha$，以确保模型的一致性。对于尿素，稳态意味着再循环源必须与直管血管的外流相平衡：\n$$\n\\alpha \\max(C_{\\mathrm{tot},0} - C_{\\mathrm{tot,pl}}, 0) = k_{\\mathrm{vr,U}}(C_{\\mathrm{U},0} - C_{\\mathrm{U,pl}})\n$$\n其中 $C_{\\mathrm{tot},0} = C_{\\mathrm{Na},0} + C_{\\mathrm{U},0}$。由于所提供的髓质浓度（$C_{\\mathrm{tot},0}$）显著高于血浆浓度（$C_{\\mathrm{tot,pl}}$），$\\max$ 函数的参数为正。因此，我们可以求解 $\\alpha$：\n$$\n\\alpha = \\frac{k_{\\mathrm{vr,U}}(C_{\\mathrm{U},0} - C_{\\mathrm{U,pl}})}{C_{\\mathrm{tot},0} - C_{\\mathrm{tot,pl}}}\n$$\n对每个测试用例计算此 $\\alpha$ 值，并在随后的动态模拟（$t \\ge 0$）中保持不变。\n\n关于 $C_{\\mathrm{Na}}$ 的常微分方程是线性的，可以解析求解。然而，关于 $C_{\\mathrm{U}}$ 的常微分方程与 $C_{\\mathrm{Na}}$ 耦合，并且在 $\\max$ 函数内部包含了对 $C_{\\mathrm{U}}$ 的非线性依赖，这使得完整系统的解析解难以求得。因此，需要采用数值方法。我们将采用一个稳健的数值 ODE 求解器，具体来说是 `scipy.integrate.solve_ivp`，来将这个由两个方程组成的系统从 $t=0$ 积分到指定的结束时间 $T_{\\mathrm{end}}$。\n\n每个测试用例的计算步骤如下：\n1.  使用停止前稳态公式计算参数 $\\alpha$。\n2.  定义一个函数，表示停止后阶段（$J_{\\mathrm{NKCC2}} = 0$）的常微分方程组。\n3.  使用 `scipy.integrate.solve_ivp` 在时间区间 $[0, T_{\\mathrm{end}}]$ 上，以给定的初始浓度 $(C_{\\mathrm{Na},0}, C_{\\mathrm{U},0})$ 求解该系统。\n4.  从解中提取最终浓度 $C_{\\mathrm{Na}}(T_{\\mathrm{end}})$ 和 $C_{\\mathrm{U}}(T_{\\mathrm{end}})$。\n5.  计算单个溶质的浓度下降量，即 $\\Delta C_{\\mathrm{Na}} = C_{\\mathrm{Na},0} - C_{\\mathrm{Na}}(T_{\\mathrm{end}})$ 和 $\\Delta C_{\\mathrm{U}} = C_{\\mathrm{U},0} - C_{\\mathrm{U}}(T_{\\mathrm{end}})$。\n6.  计算总下降量 $\\Delta C_{\\mathrm{tot}} = \\Delta C_{\\mathrm{Na}} + \\Delta C_{\\mathrm{U}}$。\n7.  确定相对分数贡献，$f_{\\mathrm{Na}} = \\Delta C_{\\mathrm{Na}} / \\Delta C_{\\mathrm{tot}}$ 和 $f_{\\mathrm{U}} = \\Delta C_{\\mathrm{U}} / \\Delta C_{\\mathrm{tot}}$。其中包括对 $\\Delta C_{\\mathrm{tot}} = 0$ 情况的检查，此时分数定义为 $0$。\n8.  最终结果 $f_{\\mathrm{Na}}$ 和 $f_{\\mathrm{U}}$ 按要求四舍五入到四位小数。对所有提供的测试用例重复此整个过程。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves a dynamical model of renal medullary washout for multiple test cases.\n    \"\"\"\n    # Test cases: (C_Na_pl, C_U_pl, k_vr_Na, k_vr_U, C_Na_0, C_U_0, T_end)\n    test_cases = [\n        # Case 1 (general)\n        (140.0, 5.0, 0.1, 0.05, 600.0, 600.0, 30.0),\n        # Case 2 (boundary, no urea washout sink)\n        (140.0, 5.0, 0.1, 0.0, 600.0, 600.0, 30.0),\n        # Case 3 (fast washout)\n        (140.0, 5.0, 0.5, 0.5, 600.0, 600.0, 10.0),\n        # Case 4 (urea-dominant initial state)\n        (140.0, 5.0, 0.1, 0.05, 400.0, 800.0, 30.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        C_Na_pl, C_U_pl, k_vr_Na, k_vr_U, C_Na_0, C_U_0, T_end = case\n        \n        # Step 1: Compute the pre-stop parameter alpha\n        C_tot_0 = C_Na_0 + C_U_0\n        C_tot_pl = C_Na_pl + C_U_pl\n        \n        # This term represents the interstitial-plasma osmolality gradient at steady state\n        denominator_alpha = C_tot_0 - C_tot_pl\n        \n        # The numerator represents the total urea sink at steady state\n        numerator_alpha = k_vr_U * (C_U_0 - C_U_pl)\n        \n        # In a valid pre-stop state with a medullary gradient, denominator_alpha > 0\n        if denominator_alpha  1e-9:\n            alpha = numerator_alpha / denominator_alpha\n        else:\n            # If no gradient exists, no urea recycling source is needed to maintain steady state\n            alpha = 0.0\n\n        # Step 2: Define the system of ODEs for t = 0\n        def model(t, y):\n            C_Na, C_U = y\n            \n            # Equation for Sodium Chloride\n            d_C_Na_dt = -k_vr_Na * (C_Na - C_Na_pl)\n            \n            # Equation for Urea\n            total_osmolality = C_Na + C_U\n            urea_recycling_source = alpha * max(total_osmolality - C_tot_pl, 0.0)\n            urea_vasa_recta_sink = k_vr_U * (C_U - C_U_pl)\n            d_C_U_dt = urea_recycling_source - urea_vasa_recta_sink\n            \n            return [d_C_Na_dt, d_C_U_dt]\n\n        # Step 3: Integrate the ODE system\n        y0 = [C_Na_0, C_U_0]\n        t_span = [0, T_end]\n        \n        # Use solve_ivp for robust integration. We only need the solution at T_end.\n        sol = solve_ivp(model, t_span, y0, t_eval=[T_end], method='RK45', rtol=1e-6, atol=1e-6)\n        \n        C_Na_T_end = sol.y[0, -1]\n        C_U_T_end = sol.y[1, -1]\n\n        # Step 4: Calculate final fractions\n        delta_C_Na = C_Na_0 - C_Na_T_end\n        delta_C_U = C_U_0 - C_U_T_end\n        delta_C_tot = delta_C_Na + delta_C_U\n\n        if abs(delta_C_tot)  1e-9: # Handle potential division by zero\n            f_Na = 0.0\n            f_U = 0.0\n        else:\n            f_Na = delta_C_Na / delta_C_tot\n            f_U = delta_C_U / delta_C_tot\n            \n        results.append([f_Na, f_U])\n\n    # Final Step: Format and print the output as specified\n    output_str_parts = []\n    for res in results:\n        # Format each value to four decimal places, ensuring trailing zeros\n        output_str_parts.append(f\"[{res[0]:.4f},{res[1]:.4f}]\")\n    \n    final_output = \"[\" + \",\".join(output_str_parts) + \"]\"\n    print(final_output)\n\nsolve()\n```", "id": "2617861"}]}