{"hands_on_practices": [{"introduction": "为了理解长途迁徙的生理学，我们首先必须能够量化其能量成本。本练习介绍菲克原理（Fick principle），这是生理学中测量全身耗氧量（$\\dot V\\!O_2$）的基石。通过将质量守恒定律应用于循环系统中的氧气运输，您将根据鸟类的心输出量（$Q$）以及动脉和静脉血中的氧含量差异，计算其在飞行中的代谢率[@problem_id:2595934]。这个练习提供了从直接生理测量数据计算代谢率的基础技能。", "problem": "一只小型候鸟在持续扑翼飞行中于高空处于稳态条件下被研究，其动脉血和混合静脉血的氧含量已被测量。假设在感兴趣的时间窗口内，身体储存的氧气没有净积累，混合静脉血样本代表从所有组织返回的流量加权平均值，并且氧含量测量已反映了血红蛋白结合氧和溶解氧。使用跨体循环的质量守恒原理，确定飞行期间单位质量的全身耗氧率。\n\n已知：\n- 心输出量（体循环血流量）：$Q = 350\\,\\mathrm{mL\\,min^{-1}}$。\n- 动脉血氧含量：$C_{a\\mathrm{O}_2} = 200\\,\\mathrm{mL\\,L^{-1}}$。\n- 混合静脉血氧含量：$C_{v\\mathrm{O}_2} = 140\\,\\mathrm{mL\\,L^{-1}}$。\n- 体重：$m = 0.6\\,\\mathrm{kg}$。\n\n计算单位质量耗氧率 $\\dot V\\!O_{2,\\mathrm{mass}}$，单位为 $\\mathrm{mL\\,kg^{-1}\\,min^{-1}}$。最终答案以 $\\mathrm{mL\\,kg^{-1}\\,min^{-1}}$ 表示。提供精确值，不要四舍五入。", "solution": "题目陈述经评估有效。这是一个生理学中定义明确的问题，基于质量守恒基本原理，并提供了一套独立且一致的已知条件。目标是计算一只飞行中鸟类的单位质量耗氧率。\n\n计算基于 Fick 原理，该原理将全身耗氧率（表示为 $\\dot V\\!O_2$）与体循环血流量（心输出量，$Q$）以及动脉血氧含量（$C_{a\\mathrm{O}_2}$）和混合静脉血氧含量（$C_{v\\mathrm{O}_2}$）之间的差异联系起来。该原理是质量守恒的直接应用，断言组织摄取氧气的速率等于动脉血中氧气输送的速率减去静脉血中氧气返回的速率。在所述的稳态条件下，该关系由以下方程表示：\n$$ \\dot V\\!O_2 = Q \\times (C_{a\\mathrm{O}_2} - C_{v\\mathrm{O}_2}) $$\n提供的数据如下：\n- 心输出量：$Q = 350\\,\\mathrm{mL\\,min^{-1}}$\n- 动脉血氧含量：$C_{a\\mathrm{O}_2} = 200\\,\\mathrm{mL\\,L^{-1}}$\n- 混合静脉血氧含量：$C_{v\\mathrm{O}_2} = 140\\,\\mathrm{mL\\,L^{-1}}$\n- 体重：$m = 0.6\\,\\mathrm{kg}$\n\n在进行计算之前，必须确保单位的一致性。心输出量 $Q$ 的单位是毫升/分钟（$\\mathrm{mL\\,min^{-1}}$），而氧含量 $C_{a\\mathrm{O}_2}$ 和 $C_{v\\mathrm{O}_2}$ 的单位是毫升 $\\mathrm{O}_2$/升血液（$\\mathrm{mL\\,L^{-1}}$）。血流量和含量测量中血液体积的单位不一致。我们必须转换其中一个以匹配另一个。我们将心输出量的单位从 $\\mathrm{mL\\,min^{-1}}$ 转换为 $\\mathrm{L\\,min^{-1}}$。\n由于 $1\\,\\mathrm{L} = 1000\\,\\mathrm{mL}$，心输出量为：\n$$ Q = 350\\,\\mathrm{mL\\,min^{-1}} = \\frac{350}{1000}\\,\\mathrm{L\\,min^{-1}} = 0.35\\,\\mathrm{L\\,min^{-1}} $$\n现在，我们可以计算动静脉血氧差：\n$$ C_{a\\mathrm{O}_2} - C_{v\\mathrm{O}_2} = (200 - 140)\\,\\mathrm{mL\\,L^{-1}} = 60\\,\\mathrm{mL\\,L^{-1}} $$\n这个值表示每升血液流经体循环时，组织会提取 $60\\,\\mathrm{mL}$ 的氧气。\n\n现在我们可以计算全身总耗氧率 $\\dot V\\!O_2$。\n$$ \\dot V\\!O_2 = (0.35\\,\\mathrm{L\\,min^{-1}}) \\times (60\\,\\mathrm{mL\\,L^{-1}}) $$\n单位 $\\mathrm{L}$ 将会抵消，得到的结果单位为 $\\mathrm{mL\\,min^{-1}}$。\n$$ \\dot V\\!O_2 = 0.35 \\times 60\\,\\mathrm{mL\\,min^{-1}} = 21\\,\\mathrm{mL\\,min^{-1}} $$\n这是整个生物体每分钟消耗的氧气总体积。\n\n问题要求的是单位质量耗氧率，此处表示为 $\\dot V\\!O_{2,\\mathrm{mass}}$。这是通过将全身耗氧率除以体重 $m$ 来得到的。\n$$ \\dot V\\!O_{2,\\mathrm{mass}} = \\frac{\\dot V\\!O_2}{m} $$\n代入计算出的 $\\dot V\\!O_2$ 值和给定的 $m$ 值：\n$$ \\dot V\\!O_{2,\\mathrm{mass}} = \\frac{21\\,\\mathrm{mL\\,min^{-1}}}{0.6\\,\\mathrm{kg}} $$\n计算很简单：\n$$ \\dot V\\!O_{2,\\mathrm{mass}} = \\frac{21}{0.6}\\,\\mathrm{mL\\,kg^{-1}\\,min^{-1}} = \\frac{210}{6}\\,\\mathrm{mL\\,kg^{-1}\\,min^{-1}} = 35\\,\\mathrm{mL\\,kg^{-1}\\,min^{-1}} $$\n结果是一个精确的整数，符合要求。这个值表示每公斤体重每分钟消耗的氧气体积（以毫升为单位）。", "answer": "$$\n\\boxed{35}\n$$", "id": "2595934"}, {"introduction": "迁徙动物必须策略性地管理其能量消耗，其中一个关键变量是飞行速度。本练习通过分析经典的U形功率曲线，深入探讨飞行的生物能量学，该曲线描述了代谢功率如何随空速变化。您将运用微积分来确定两个关键速度：最小功率速度（$v_{mp}$）和最小运输成本速度（$v_{mr}$），即每单位行进距离所消耗的能量[@problem_id:2595962]。理解这两者的区别对于预测动物是为了最大化空中停留时间而飞行，还是为了用有限的燃料飞越最远距离至关重要。", "problem": "一只自由飞行的候鸟，质量为 $m = 0.7\\,\\mathrm{kg}$，在空速为 $v$ 时抵抗空气动力，维持稳定的水平飞行。设飞行所需的净代谢功率由以下经验公式给出：\n$$\nP(v) \\;=\\; \\frac{0.6}{v} \\;+\\; 0.02\\,v^{3} \\;+\\; 1.2\\,v\n$$\n该公式使用国际单位制（SI单位），其中 $P$ 的单位是瓦特，$v$ 的单位是米每秒。请仅使用基本定义，确定：\n- 使功率需求最小化的速度，以及\n- 使运输成本最小化的速度。\n\n为解决此问题，请使用运输成本的定义，即每单位体重、每单位行进距离所消耗的代谢能量。假设飞行是稳定、水平、不加速的，并忽略动能和势能的变化。将每个最优速度以 $\\mathrm{m\\,s^{-1}}$ 为单位表示，并四舍五入到三位有效数字。只需给出所要求的两个速度；不要报告任何其他量。你可以用 $g$ 表示重力加速度，但不需要代入 $g$ 的数值，因为在所述假设下，它在最小化运输成本的计算中会被消掉。", "solution": "首先对问题进行验证。\n\n**步骤1：提取已知条件**\n- 鸟的质量：$m = 0.7\\,\\mathrm{kg}$\n- 飞行条件：以空速 $v$ 进行稳定、水平的飞行。\n- 代谢功率函数：$P(v) \\;=\\; \\frac{0.6}{v} \\;+\\; 0.02\\,v^{3} \\;+\\; 1.2\\,v$\n- 单位：$P$ 的单位是瓦特 (W)，$v$ 的单位是米每秒 ($\\mathrm{m\\,s^{-1}}$)。\n- 任务1：确定使功率需求最小化的速度。\n- 任务2：确定使运输成本最小化的速度。\n- 运输成本 (COT) 的定义：每单位体重、每单位行进距离所消耗的代谢能量。\n- 假设：稳定、水平、不加速的飞行；忽略动能和势能的变化。\n- 最终答案要求：以 $\\mathrm{m\\,s^{-1}}$ 为单位表示速度，并四舍五入到三位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 所提供的功率函数 $P(v) = Av^{-1} + Bv^3 + Cv$ 是一个用于研究动物飞行能量学的标准经验模型。这些项分别对应于诱导功率（与 $v^{-1}$ 成正比）、寄生功率（与 $v^3$ 成正比）和剖面功率（与 $v$ 成正比）或依赖于飞行肌肉的基础代谢的一个组成部分。这是一个科学上合理且成熟的模型。\n- **适定性：** 该问题要求找到两个定义良好、可微的速度 $v$ 的函数的最小值。这种最小值的存在性可以通过标准的微积分技术（寻找临界点并检查二阶导数）来确定。该问题是唯一可解的。\n- **客观性：** 问题陈述使用了精确、定量的语言，没有主观或模糊的术语。\n- **完整性与一致性：** 提供了所有必要的信息。给出了功率函数，并明确说明了运输成本的定义。所提供的数据中没有矛盾。\n\n**步骤3：结论与行动**\n该问题具有科学依据、适定、客观且完整。因此是 **有效的**。将推导出解答。\n\n解答按要求分为两部分进行。\n\n**第一部分：最小功率对应的速度 ($v_{mp}$)**\n\n代谢功率 $P$ 作为空速 $v$ 的函数由下式给出：\n$$P(v) = \\frac{0.6}{v} + 0.02\\,v^{3} + 1.2\\,v$$\n为了找到使该功率需求最小化的速度，我们必须求出 $P(v)$ 对 $v$ 的导数，并令其为零。这可以确定函数的临界点。\n$$ \\frac{dP}{dv} = \\frac{d}{dv} \\left( 0.6\\,v^{-1} + 0.02\\,v^{3} + 1.2\\,v \\right) $$\n$$ \\frac{dP}{dv} = -0.6\\,v^{-2} + 3(0.02)v^{2} + 1.2 $$\n$$ \\frac{dP}{dv} = -\\frac{0.6}{v^2} + 0.06\\,v^2 + 1.2 $$\n令导数为零以求极值：\n$$ -\\frac{0.6}{v^2} + 0.06\\,v^2 + 1.2 = 0 $$\n由于飞行速度 $v$ 必须为正，我们可以将整个方程乘以 $v^2$：\n$$ -0.6 + 0.06\\,v^4 + 1.2\\,v^2 = 0 $$\n重新排列得到一个关于 $v$ 的四次方程，这也是一个关于 $v^2$ 的二次方程：\n$$ 0.06\\,v^4 + 1.2\\,v^2 - 0.6 = 0 $$\n令 $x = v^2$。方程变为：\n$$ 0.06\\,x^2 + 1.2\\,x - 0.6 = 0 $$\n我们使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $x$，其中 $a = 0.06$，$b = 1.2$，$c = -0.6$：\n$$ x = \\frac{-1.2 \\pm \\sqrt{(1.2)^2 - 4(0.06)(-0.6)}}{2(0.06)} $$\n$$ x = \\frac{-1.2 \\pm \\sqrt{1.44 + 0.144}}{0.12} $$\n$$ x = \\frac{-1.2 \\pm \\sqrt{1.584}}{0.12} $$\n由于 $x = v^2$，它必须是一个正实数。因此，我们取正根：\n$$ v^2 = x = \\frac{-1.2 + \\sqrt{1.584}}{0.12} $$\n计算数值：\n$$ v^2 \\approx \\frac{-1.2 + 1.25857}{0.12} \\approx \\frac{0.05857}{0.12} \\approx 0.48808 $$\n$$ v = \\sqrt{0.48808} \\approx 0.6986\\,\\mathrm{m\\,s^{-1}} $$\n为了确认这是一个最小值，我们检查二阶导数 $\\frac{d^2P}{dv^2}$ 的符号：\n$$ \\frac{d^2P}{dv^2} = \\frac{d}{dv} \\left( -0.6\\,v^{-2} + 0.06\\,v^2 + 1.2 \\right) = 1.2\\,v^{-3} + 0.12\\,v = \\frac{1.2}{v^3} + 0.12\\,v $$\n对于任何正的 $v$，两项都为正，所以 $\\frac{d^2P}{dv^2} > 0$。该极值点是一个最小值点。\n四舍五入到三位有效数字，最小功率对应的速度为 $v_{mp} \\approx 0.699\\,\\mathrm{m\\,s^{-1}}$。\n\n**第二部分：最小运输成本对应的速度 ($v_{mr}$)**\n\n运输成本 (COT) 定义为每单位体重 $W$、每单位行进距离 $d$ 所消耗的代谢能量 $E$：\n$$ \\mathrm{COT} = \\frac{E}{W \\cdot d} $$\n对于在时间间隔 $t$ 内以速度 $v$ 进行的稳定飞行，消耗的能量为 $E = P(v) \\cdot t$，行进的距离为 $d = v \\cdot t$。体重为 $W = m \\cdot g$，其中 $m$ 是质量，$g$ 是重力加速度。\n将这些代入 COT 的定义中：\n$$ \\mathrm{COT}(v) = \\frac{P(v) \\cdot t}{(m \\cdot g) \\cdot (v \\cdot t)} = \\frac{P(v)}{mgv} $$\n为了找到使 COT 最小化的速度，我们需要找到函数 $\\mathrm{COT}(v)$ 的最小值。由于 $m$ 和 $g$ 是正常数，最小化 $\\mathrm{COT}(v)$ 等价于最小化函数 $C(v) = \\frac{P(v)}{v}$。\n$$ C(v) = \\frac{1}{v} \\left( \\frac{0.6}{v} + 0.02\\,v^{3} + 1.2\\,v \\right) $$\n$$ C(v) = \\frac{0.6}{v^2} + 0.02\\,v^2 + 1.2 = 0.6\\,v^{-2} + 0.02\\,v^2 + 1.2 $$\n为求最小值，我们将 $C(v)$ 对 $v$ 求导，并令结果为零：\n$$ \\frac{dC}{dv} = \\frac{d}{dv} \\left( 0.6\\,v^{-2} + 0.02\\,v^2 + 1.2 \\right) $$\n$$ \\frac{dC}{dv} = -2(0.6)v^{-3} + 2(0.02)v = -1.2\\,v^{-3} + 0.04\\,v $$\n令导数为零：\n$$ - \\frac{1.2}{v^3} + 0.04\\,v = 0 $$\n$$ 0.04\\,v = \\frac{1.2}{v^3} $$\n$$ 0.04\\,v^4 = 1.2 $$\n$$ v^4 = \\frac{1.2}{0.04} = 30 $$\n$$ v = (30)^{1/4} $$\n计算数值：\n$$ v \\approx 2.3403\\,\\mathrm{m\\,s^{-1}} $$\n为了确认是一个最小值，我们检查二阶导数 $\\frac{d^2C}{dv^2}$：\n$$ \\frac{d^2C}{dv^2} = \\frac{d}{dv} \\left( -1.2\\,v^{-3} + 0.04\\,v \\right) = 3.6\\,v^{-4} + 0.04 = \\frac{3.6}{v^4} + 0.04 $$\n对于任何正的 $v$，$\\frac{d^2C}{dv^2}$ 均为正，所以该极值点是一个最小值点。\n四舍五入到三位有效数字，最小运输成本对应的速度为 $v_{mr} \\approx 2.34\\,\\mathrm{m\\,s^{-1}}$。\n\n所要求的两个速度约为 $0.699\\,\\mathrm{m\\,s^{-1}}$ 和 $2.34\\,\\mathrm{m\\,s^{-1}}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.699  2.34\n\\end{pmatrix}\n}\n$$", "id": "2595962"}, {"introduction": "要估算整个迁徙过程的总能量成本，需要超越简单的计算，对长时间的数据进行整合。本计算练习介绍了心率法，这是一种在无法直接测量耗氧量时估算野外代谢率的强大技术。您将首先使用实验室校准数据建立心率与$\\dot V\\!O_2$之间的关系，然后将此模型应用于一个模拟的48小时野外心率记录，该记录包含了生物节律和数据缺失等情况[@problem_id:2595955]。这个练习提供了一个真实的生物能量学建模体验，涵盖了从数据校准和处理到最终估算一次迁徙活动总能量消耗的全过程。", "problem": "您将获得将心率 (HR) 与耗氧速率 ($\\dot V O_2$) 相关联的实验室校准数据，您必须将这些校准应用于持续时间为 $48\\,\\mathrm{h}$ 的连续迁徙过程中的合成野外心率时间序列。您的任务是通过对预测的耗氧量进行时间积分，并使用每升氧气的固定能量当量将氧气转化为能量，来估算总能量消耗。请仅使用基本原理：在次最大运动范围内，心率活动与耗氧量之间的线性关系（作为通过最小二乘法拟合得出的经验近似），氧气通量的质量守恒，以及对速率的时间积分。由于气体通量的非负性，请将 $\\dot V O_2$ 视为非负值。\n\n使用的基本原理：\n- 氧气质量平衡：瞬时代谢能量速率与耗氧速率成正比。\n- 测试范围内的经验线性近似：使用普通最小二乘法对提供的实验室数据对进行拟合，建立一个将心率映射到耗氧量的一阶模型。不要先验地假设任何截距或斜率；从数据中估算它们。\n- 时间积分：总耗氧量是 $\\dot V O_2(t)$ 的时间积分；总能量是总耗氧量乘以氧气能量当量。\n\n为每个测试案例实现的通用计算步骤：\n1. 使用普通最小二乘法对提供的实验室校准数据对进行拟合，建立一个将单位为 $\\mathrm{bpm}$ 的心率映射到单位为 $\\mathrm{L\\,min^{-1}}$ 的 $\\dot V O_2$ 的一阶模型。不要先验地假设任何截距或斜率；从数据中估算它们。\n2. 使用指定的确定性规则，以固定的采样间隔 $\\Delta t = 60\\,\\mathrm{s}$ 合成一个 $48\\,\\mathrm{h}$ 的心率时间序列：\n   - 令 $t$ 表示以分钟为单位的流逝时间，$t \\in \\{0,1,2,\\dots,2880-1\\}$。\n   - 基线加振荡模型为\n     $$\\mathrm{HR}(t) = H_{\\mathrm{base}} + A_{\\mathrm{circ}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{1440} + \\phi\\Big) + A_{\\mathrm{fast}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{P_{\\mathrm{fast}}}\\Big),$$\n     其中 $\\sin$ 的参数以弧度为单位，$H_{\\mathrm{base}}$ 的单位是 $\\mathrm{bpm}$，$A_{\\mathrm{circ}}$ 和 $A_{\\mathrm{fast}}$ 的单位是 $\\mathrm{bpm}$，$P_{\\mathrm{fast}}$ 的单位是分钟，$\\phi$ 的单位是弧度。\n   - 应用任何指定的覆盖区间：对于每个以分钟为单位的区间 $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$，将该区间内所有整数 $t$ 的 $\\mathrm{HR}(t)$ 设置为提供的恒定覆盖值（单位为 $\\mathrm{bpm}$）。\n   - 应用任何指定的缺失区间：对于每个以分钟为单位的区间 $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$，将 $\\mathrm{HR}(t)$ 设置为缺失。然后使用相邻的非缺失邻近值对缺失值进行随时间的线性插值。如果缺失值出现在序列的开头或结尾，则用最近的可用非缺失值填充它们。\n3. 使用拟合的一阶模型，从每分钟的 $\\mathrm{HR}(t)$ 预测 $\\dot V O_2(t)$（单位为 $\\mathrm{L\\,min^{-1}}$）。通过将负预测值截断为 $0$ 来强制执行物理约束 $\\dot V O_2(t) \\ge 0$。\n4. 通过离散时间积分计算 $48\\,\\mathrm{h}$ 内消耗的总氧气量，其中 $\\Delta t = 60\\,\\mathrm{s}$（即 $\\Delta t = 1\\,\\mathrm{min}$）：\n   $$V_{\\mathrm{O_2,tot}} = \\sum_{t=0}^{2880-1} \\dot V O_2(t)\\,\\Delta t_{\\mathrm{min}},$$\n   其中 $\\Delta t_{\\mathrm{min}} = 1\\,\\mathrm{min}$。\n5. 使用氧气能量当量 $E_{\\mathrm{O_2}}$（单位为 $\\mathrm{kJ\\,L^{-1}}$）将其转换为总能量消耗：\n   $$E_{\\mathrm{tot}} = V_{\\mathrm{O_2,tot}} \\times E_{\\mathrm{O_2}} \\quad \\text{in } \\mathrm{kJ}.$$\n6. 将每个测试案例的 $E_{\\mathrm{tot}}$ 报告为一个浮点数，单位为 $\\mathrm{kJ}$，四舍五入到小数点后三位。\n\n角度单位要求：所有三角函数参数均以弧度为单位。\n\n输出格式要求：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[x,y,z]”），结果按以下测试案例的顺序排列。\n\n测试套件（三个案例）：\n\n- 测试案例 1 (小型迁徙滨鸟):\n  - 实验室校准数据对 $(\\mathrm{HR}, \\dot V O_2)$，其中 $\\mathrm{HR}$ 单位为 $\\mathrm{bpm}$，$\\dot V O_2$ 单位为 $\\mathrm{L\\,min^{-1}}$：\n    $$\\{(360,0.20),(400,0.28),(440,0.37),(480,0.47),(520,0.58),(560,0.70)\\}.$$\n  - 氧气能量当量：$E_{\\mathrm{O_2}} = 20.1\\,\\mathrm{kJ\\,L^{-1}}$。\n  - 时间序列参数：$H_{\\mathrm{base}}=420\\,\\mathrm{bpm}$，$A_{\\mathrm{circ}}=40\\,\\mathrm{bpm}$，$A_{\\mathrm{fast}}=20\\,\\mathrm{bpm}$，$P_{\\mathrm{fast}}=30\\,\\mathrm{min}$，$\\phi=0\\,\\mathrm{rad}$。\n  - 覆盖：无。\n  - 缺失区间（分钟，包含起始值，不含结束值）：$[360,370)$ 和 $[2160,2170)$。\n\n- 测试案例 2 (有心动过缓性潜水的成年海豹):\n  - 实验室校准数据对 $(\\mathrm{HR}, \\dot V O_2)$，其中 $\\mathrm{HR}$ 单位为 $\\mathrm{bpm}$，$\\dot V O_2$ 单位为 $\\mathrm{L\\,min^{-1}}$：\n    $$\\{(40,0.30),(50,0.45),(60,0.62),(70,0.80),(80,1.00),(90,1.22)\\}.$$\n  - 氧气能量当量：$E_{\\mathrm{O_2}} = 19.6\\,\\mathrm{kJ\\,L^{-1}}$。\n  - 时间序列参数：$H_{\\mathrm{base}}=55\\,\\mathrm{bpm}$，$A_{\\mathrm{circ}}=10\\,\\mathrm{bpm}$，$A_{\\mathrm{fast}}=15\\,\\mathrm{bpm}$，$P_{\\mathrm{fast}}=45\\,\\mathrm{min}$，$\\phi=\\pi/6\\,\\mathrm{rad}$。\n  - 覆盖（分钟，包含起始值，不含结束值，恒定 $\\mathrm{HR}$ 单位为 $\\mathrm{bpm}$）：\n    - $[300,310)$，覆盖 $\\mathrm{HR}=15$，\n    - $[1140,1150)$，覆盖 $\\mathrm{HR}=15$，\n    - $[1500,1510)$，覆盖 $\\mathrm{HR}=15$，\n    - $[2220,2230)$，覆盖 $\\mathrm{HR}=15$。\n  - 缺失区间：$[720,780)$。\n\n- 测试案例 3 (迁徙中的鲑鱼):\n  - 实验室校准数据对 $(\\mathrm{HR}, \\dot V O_2)$，其中 $\\mathrm{HR}$ 单位为 $\\mathrm{bpm}$，$\\dot V O_2$ 单位为 $\\mathrm{L\\,min^{-1}}$：\n    $$\\{(30,0.08),(40,0.11),(50,0.15),(60,0.20),(70,0.26),(80,0.33)\\}.$$\n  - 氧气能量当量：$E_{\\mathrm{O_2}} = 20.9\\,\\mathrm{kJ\\,L^{-1}}$。\n  - 时间序列参数：$H_{\\mathrm{base}}=50\\,\\mathrm{bpm}$，$A_{\\mathrm{circ}}=8\\,\\mathrm{bpm}$，$A_{\\mathrm{fast}}=10\\,\\mathrm{bpm}$，$P_{\\mathrm{fast}}=20\\,\\mathrm{min}$，$\\phi=\\pi/4\\,\\mathrm{rad}$。\n  - 覆盖：\n    - $[1440,1460)$，覆盖 $\\mathrm{HR}=20$。\n  - 缺失区间：无。\n\n积分和单位：\n- 使用 $\\Delta t = 60\\,\\mathrm{s} = 1\\,\\mathrm{min}$。\n- 以 $\\mathrm{kJ}$ 为单位表示每个最终能量消耗，四舍五入到小数点后三位。\n\n您的程序应生成单行输出，其中包含三个按顺序排列的四舍五入后的能量消耗值，格式为逗号分隔的列表并用方括号括起，例如，“[e1,e2,e3]”。", "solution": "问题陈述已提交以供验证。\n\n步骤1：提取已知条件\n该问题为三个测试案例中的每一个提供了以下数据和程序：\n1.  一组心率（$\\mathrm{HR}$，单位为 $\\mathrm{bpm}$）和耗氧速率（$\\dot V O_2$，单位为 $\\mathrm{L\\,min^{-1}}$）的实验室校准数据对。\n2.  一个氧气能量当量，$E_{\\mathrm{O_2}}$，单位为 $\\mathrm{kJ\\,L^{-1}}$。\n3.  一个在 $48\\,\\mathrm{h}$ 持续时间内，时间步长为 $\\Delta t = 1\\,\\mathrm{min}$ 的确定性心率时间序列模型的参数。该模型为：\n    $$\\mathrm{HR}(t) = H_{\\mathrm{base}} + A_{\\mathrm{circ}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{1440} + \\phi\\Big) + A_{\\mathrm{fast}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{P_{\\mathrm{fast}}}\\Big)$$\n    其中 $t$ 是以分钟为单位的时间。\n4.  一组覆盖区间 $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$，在此期间 $\\mathrm{HR}(t)$ 被设置为指定的恒定值。\n5.  一组缺失数据区间 $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$，将通过线性插值进行填充。\n6.  明确的计算步骤：\n    a. 使用普通最小二乘法对校准数据拟合一个一阶模型 $\\dot V O_2 = m \\cdot \\mathrm{HR} + c$。\n    b. 为 $t \\in \\{0, 1, \\dots, 2879\\}$ 合成 $\\mathrm{HR}(t)$ 时间序列。\n    c. 应用覆盖，然后填充缺失数据区间。\n    d. 使用拟合模型从最终的 $\\mathrm{HR}(t)$ 序列预测 $\\dot V O_2(t)$。\n    e. 通过将预测的 $\\dot V O_2(t)$ 值截断为 $0$ 来强制执行非负性约束。\n    f. 通过离散时间积分计算总耗氧量 $V_{\\mathrm{O_2,tot}}$：$V_{\\mathrm{O_2,tot}} = \\sum_{t=0}^{2879} \\dot V O_2(t)\\,\\cdot (1\\,\\mathrm{min})$。\n    g. 计算总能量消耗 $E_{\\mathrm{tot}}$，即 $E_{\\mathrm{tot}} = V_{\\mathrm{O_2,tot}} \\times E_{\\mathrm{O_2}}$。\n    h. 以 $\\mathrm{kJ}$ 为单位报告 $E_{\\mathrm{tot}}$，四舍五入到小数点后三位。\n\n所有三个测试案例（滨鸟、海豹、鲑鱼）的具体参数都已详细提供。\n\n步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于生理生物能量学的核心原理。心率与耗氧量（代谢率的代表指标）之间的关系是生态生理学的基石，通常被称为“心率法”。使用线性模型是一种标准的经验近似方法。通过氧热当量将氧气体积转换为能量是化学计量学和热力学在生物学中的基本应用。为不同物种提供的参数在生理上是合理的。该问题在科学上是合理的。\n- **定义明确**：该问题定义得异常明确。它提供了所有必要的数据，指定了一个确定性的计算算法，并定义了所有术语和边界条件，包括对缺失数据的处理。这种结构确保了每个测试案例都存在唯一且稳定的解。\n- **客观性**：问题陈述完全是定量的和程序性的。它不含任何主观、模糊或基于意见的语言。\n- **完整性与一致性**：该问题是自包含且内部一致的。每个测试案例所需的所有参数都已指定，并且单位在整个过程中使用一致（$\\mathrm{bpm}$、$\\mathrm{L\\,min^{-1}}$、$\\mathrm{min}$、$\\mathrm{h}$、$\\mathrm{kJ\\,L^{-1}}$）。\n- **其他缺陷**：该问题并非微不足道，因为它需要正确实现和排序几个不同的计算任务（回归、时间序列合成、数据插补、积分）。它不是隐喻性的、不可行的或无法验证的。\n\n步骤3：结论与操作\n该问题是有效的。这是一个结构良好的计算生物能量学练习，遵循既定的科学原则。将提供一个解决方案。\n\n解决方案通过为每个测试案例精确地实现指定的计算程序来进行。\n\n**1. $\\dot V O_2$-HR 关系的估算**\n对于每只动物，我们都有一组 $n$ 个校准数据点 $(\\mathrm{HR}_i, \\dot V O_{2,i})$。我们用一阶多项式或线性模型来近似这些变量之间的关系：\n$$ \\dot V O_2(\\mathrm{HR}) = m \\cdot \\mathrm{HR} + c $$\n参数，即斜率 $m$ 和截距 $c$，使用普通最小二乘法（OLS）回归确定。OLS 最小化了观测到的耗氧速率与模型预测速率之间的残差平方和。$m$ 和 $c$ 的显式公式为：\n$$ m = \\frac{n(\\sum \\mathrm{HR}_i \\dot V O_{2,i}) - (\\sum \\mathrm{HR}_i)(\\sum \\dot V O_{2,i})}{n(\\sum \\mathrm{HR}_i^2) - (\\sum \\mathrm{HR}_i)^2} $$\n$$ c = \\bar{\\dot V O_2} - m \\cdot \\overline{\\mathrm{HR}} $$\n其中 $\\bar{\\dot V O_2}$ 和 $\\overline{\\mathrm{HR}}$ 是样本均值。在计算上，这可以由数值库高效处理。\n\n**2. 心率时间序列的合成**\n为 $48\\,\\mathrm{h}$ 的迁徙过程生成一个离散时间向量 $t$。总持续时间为 $48\\,\\mathrm{h} \\times 60\\,\\mathrm{min\\,h^{-1}} = 2880\\,\\mathrm{min}$。时间步长为 $\\Delta t=1\\,\\mathrm{min}$，因此时间向量为 $t = \\{0, 1, 2, \\dots, 2879\\}$。\n每个时间点的心率 $\\mathrm{HR}(t)$ 使用提供的确定性模型计算：\n$$ \\mathrm{HR}(t) = H_{\\mathrm{base}} + A_{\\mathrm{circ}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{T_{\\mathrm{day}}} + \\phi\\Big) + A_{\\mathrm{fast}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{P_{\\mathrm{fast}}}\\Big) $$\n其中昼夜节律的周期是 $T_{\\mathrm{day}} = 1440\\,\\mathrm{min}$（即 $24\\,\\mathrm{h}$）。所有参数（$H_{\\mathrm{base}}$、$A_{\\mathrm{circ}}$、$A_{\\mathrm{fast}}$、$P_{\\mathrm{fast}}$、$\\phi$）对每个案例都已指定。\n\n**3. 数据预处理：覆盖和缺失值**\n根据问题规范修改合成的 $\\mathrm{HR}(t)$ 序列。\n- **覆盖**：对于每个指定的区间 $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$，从 $t_{\\mathrm{start}}$ 到 $t_{\\mathrm{end}}-1$ 的 $\\mathrm{HR}(t)$ 值将被替换为给定的恒定覆盖值。此步骤必须在处理缺失数据之前进行。\n- **缺失值**：对于每个区间 $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$，$\\mathrm{HR}(t)$ 的值被标记为缺失（例如，使用 `NaN` 标志）。随后，这些缺失值通过基于相邻非缺失数据点的线性插值进行填充。对于时间序列开头或结尾的缺失段，使用等于最近有效数据点的恒定值进行外插，这是数值插值程序的标准行为。\n\n**4. 耗氧速率的预测**\n使用最终处理过的 $\\mathrm{HR}(t)$ 时间序列以及来自 OLS 拟合的参数 $m$ 和 $c$，为每个时间点预测瞬时耗氧速率 $\\dot V O_2(t)$：\n$$ \\dot V O_2^{\\text{pred}}(t) = m \\cdot \\mathrm{HR}(t) + c $$\n一个关键的物理约束是耗氧量不能为负。因此，任何预测的负值都被截断为零：\n$$ \\dot V O_2(t) = \\max(0, \\dot V O_2^{\\text{pred}}(t)) $$\n\n**5. 总耗氧量的积分**\n在整个 $48\\,\\mathrm{h}$ 期间消耗的总氧气体积 $V_{\\mathrm{O_2,tot}}$ 是速率 $\\dot V O_2(t)$ 对时间的定积分。对于具有恒定时间步长 $\\Delta t$ 的离散时间序列，该积分通过黎曼和来近似：\n$$ V_{\\mathrm{O_2,tot}} = \\int_{0}^{2880} \\dot V O_2(t) \\,dt \\approx \\sum_{t=0}^{2879} \\dot V O_2(t) \\cdot \\Delta t $$\n给定 $\\Delta t = 1\\,\\mathrm{min}$，以升为单位的总 体积就是所有 $\\dot V O_2(t)$ 值（单位为 $\\mathrm{L\\,min^{-1}}$）的总和。\n$$ V_{\\mathrm{O_2,tot}} [\\mathrm{L}] = \\sum_{t=0}^{2879} \\dot V O_2(t) [\\mathrm{L\\,min^{-1}}] \\cdot (1\\,\\mathrm{min}) $$\n\n**6. 总能量消耗的计算**\n最后一步是使用提供的物种特异性氧热当量 $E_{\\mathrm{O_2}}$（单位为 $\\mathrm{kJ\\,L^{-1}}$），将消耗的总氧气体积转换为总能量消耗 $E_{\\mathrm{tot}}$。这是能量守恒定律在代谢过程中的直接应用：\n$$ E_{\\mathrm{tot}} [\\mathrm{kJ}] = V_{\\mathrm{O_2,tot}} [\\mathrm{L}] \\times E_{\\mathrm{O_2}} [\\mathrm{kJ\\,L^{-1}}] $$\n每个案例的最终结果按照要求四舍五入到小数点后三位。\n这个完整的程序独立地应用于三个测试案例中的每一个。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for total energy expenditure for three test cases based on\n    laboratory calibration data and synthetic field heart rate time series.\n    \"\"\"\n    \n    test_cases = [\n        # Test case 1 (small migratory shorebird)\n        {\n            \"name\": \"shorebird\",\n            \"calibration_hr\": np.array([360, 400, 440, 480, 520, 560]),\n            \"calibration_vo2\": np.array([0.20, 0.28, 0.37, 0.47, 0.58, 0.70]),\n            \"e_o2\": 20.1,\n            \"ts_params\": {\"h_base\": 420, \"a_circ\": 40, \"a_fast\": 20, \"p_fast\": 30, \"phi\": 0},\n            \"overrides\": [],\n            \"missing\": [(360, 370), (2160, 2170)],\n        },\n        # Test case 2 (adult seal with bradycardic dives)\n        {\n            \"name\": \"seal\",\n            \"calibration_hr\": np.array([40, 50, 60, 70, 80, 90]),\n            \"calibration_vo2\": np.array([0.30, 0.45, 0.62, 0.80, 1.00, 1.22]),\n            \"e_o2\": 19.6,\n            \"ts_params\": {\"h_base\": 55, \"a_circ\": 10, \"a_fast\": 15, \"p_fast\": 45, \"phi\": np.pi / 6},\n            \"overrides\": [\n                (300, 310, 15),\n                (1140, 1150, 15),\n                (1500, 1510, 15),\n                (2220, 2230, 15),\n            ],\n            \"missing\": [(720, 780)],\n        },\n        # Test case 3 (migrating salmon)\n        {\n            \"name\": \"salmon\",\n            \"calibration_hr\": np.array([30, 40, 50, 60, 70, 80]),\n            \"calibration_vo2\": np.array([0.08, 0.11, 0.15, 0.20, 0.26, 0.33]),\n            \"e_o2\": 20.9,\n            \"ts_params\": {\"h_base\": 50, \"a_circ\": 8, \"a_fast\": 10, \"p_fast\": 20, \"phi\": np.pi / 4},\n            \"overrides\": [(1440, 1460, 20)],\n            \"missing\": [],\n        },\n    ]\n\n    results = []\n    \n    # Constants for time series generation\n    duration_min = 48 * 60\n    t = np.arange(duration_min, dtype=float) # time in minutes\n    t_day_period = 1440.0 # minutes in 24 hours\n\n    for case in test_cases:\n        # Step 1: Fit a first-order model using ordinary least squares\n        hr_calib = case[\"calibration_hr\"]\n        vo2_calib = case[\"calibration_vo2\"]\n        m, c = np.polyfit(hr_calib, vo2_calib, 1)\n\n        # Step 2: Synthesize the heart rate time series\n        params = case[\"ts_params\"]\n        h_base = params[\"h_base\"]\n        a_circ = params[\"a_circ\"]\n        a_fast = params[\"a_fast\"]\n        p_fast = params[\"p_fast\"]\n        phi = params[\"phi\"]\n        \n        hr_series = (h_base +\n                     a_circ * np.sin(2 * np.pi * t / t_day_period + phi) +\n                     a_fast * np.sin(2 * np.pi * t / p_fast))\n\n        # Step 3: Apply overrides and handle missing data\n        # Apply overrides first\n        for start, end, val in case[\"overrides\"]:\n            hr_series[start:end] = val\n            \n        # Mark missing intervals with NaN\n        if case[\"missing\"]:\n            for start, end in case[\"missing\"]:\n                hr_series[start:end] = np.nan\n            \n            # Perform linear interpolation to fill NaN values\n            is_nan = np.isnan(hr_series)\n            non_nan_indices = np.where(~is_nan)[0]\n            non_nan_values = hr_series[~is_nan]\n            nan_indices = np.where(is_nan)[0]\n            hr_series[is_nan] = np.interp(nan_indices, non_nan_indices, non_nan_values)\n\n        # Step 3: Predict VO2 from HR\n        vo2_predicted = m * hr_series + c\n        \n        # Enforce non-negativity constraint\n        vo2_final = np.maximum(0, vo2_predicted)\n\n        # Step 4: Compute total oxygen consumed by discrete-time integration\n        # Since delta_t is 1 min, the total volume is the sum of the rates\n        v_o2_total = np.sum(vo2_final)\n\n        # Step 5: Convert to total energy expenditure\n        e_total = v_o2_total * case[\"e_o2\"]\n\n        # Step 6: Round to three decimal places and store\n        results.append(round(e_total, 3))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2595955"}]}