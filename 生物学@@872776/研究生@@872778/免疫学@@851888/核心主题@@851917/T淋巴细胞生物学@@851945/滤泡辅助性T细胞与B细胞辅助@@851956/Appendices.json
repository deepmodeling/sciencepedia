{"hands_on_practices": [{"introduction": "量化特定的免疫细胞群是免疫学研究的基石。本练习将一个常见的实验工作流程——多色流式细胞术——转化为一个条件概率的实际问题。通过遵循序贯设门策略来鉴定滤泡辅助T细胞（Tfh），您将练习从层级数据中计算细胞群频率，这是解读现代免疫学实验的一项基本技能。[@problem_id:2849252]", "problem": "在一项关于人类次级淋巴组织生发中心生物学的研究中，你使用了一个包含CD4（分化簇4）、CXCR5（C-X-C趋化因子受体5型）、PD-1（程序性死亡蛋白1）、ICOS（诱导性T细胞共刺激分子）和CCR7（C-C趋化因子受体7型）这五种标记物的五色流式细胞术方案来计数T滤泡辅助（Tfh）细胞。为进行此分析，T滤泡辅助细胞被操作性地定义为逻辑门 CD4$^{+}$ CXCR5$^{+}$ PD-1$^{\\text{high}}$ ICOS$^{+}$ CCR7$^{\\text{low}}$。从同一数据集中，你获得了以下通过实验测定的频率：\n- 在CD4$^{+}$ T细胞中，CCR7$^{\\text{high}}$ 的比例为 $40\\%$。\n- 在CD4$^{+}$ T细胞中，CXCR5$^{+}$ 的比例为 $20\\%$。\n- 在CXCR5$^{+}$ CD4$^{+}$ T细胞中，PD-1$^{\\text{high}}$ 的比例为 $60\\%$。\n- 在PD-1$^{\\text{high}}$ CXCR5$^{+}$ CD4$^{+}$ T细胞中，ICOS$^{+}$ 的比例为 $75\\%$。\n- 在ICOS$^{+}$ PD-1$^{\\text{high}}$ CXCR5$^{+}$ CD4$^{+}$ T细胞中，CCR7$^{\\text{low}}$ 的比例为 $80\\%$。\n\n从T滤泡辅助细胞的免疫表型定义和条件概率的基本规则出发，并假设在没有额外依赖关系的情况下，所述的条件频率在指定的圈门序列中成立，计算T滤泡辅助细胞门在总CD4$^{+}$ T细胞中的预期频率。请用小数表示最终答案。不要使用百分号。", "solution": "该问题要求计算一个特定的T淋巴细胞亚群，即T滤泡辅助（$T_{\\text{fh}}$）细胞，在总$CD4^{+}$ T细胞群体中的频率。此分析基于流式细胞术数据的序贯圈门策略，这在数学上可转化为一条条件概率链。该问题提法明确，并基于正确的生物学和数学原理。\n\n首先，我们必须使用概率论的语言来将问题形式化。总体是$CD4^{+}$ T细胞的集合，因此所有概率都是以一个细胞是$CD4^{+}$为条件的。我们为从该群体中随机选择的一个细胞定义以下事件：\n- 令 $E_1$ 为细胞是 $CXCR5^{+}$ 的事件。\n- 令 $E_2$ 为细胞是 $PD-1^{\\text{high}}$ 的事件。\n- 令 $E_3$ 为细胞是 $ICOS^{+}$ 的事件。\n- 令 $E_4$ 为细胞是 $CCR7^{\\text{low}}$ 的事件。\n\n问题将$CD4^{+}$门内的一个$T_{\\text{fh}}$细胞操作性地定义为满足所有这些标准的细胞。目标是计算这些事件交集的概率，我们将其表示为$P(E_1 \\cap E_2 \\cap E_3 \\cap E_4)$。\n\n提供的实验数据是以一系列条件频率的形式给出的。我们将这些频率转化为条件概率，并注意到在设定中，$CD4^{+}$的条件是隐含的。\n1. $CD4^{+}$ T细胞中$CXCR5^{+}$细胞的比例为$20\\%$。这是我们序列中第一个事件的概率：\n$$P(E_1) = 0.20$$\n2. $CXCR5^{+} CD4^{+}$ T细胞中$PD-1^{\\text{high}}$细胞的比例为$60\\%$。这是一个条件概率，代表了圈门层级中的第二步：\n$$P(E_2 | E_1) = 0.60$$\n3. $PD-1^{\\text{high}} CXCR5^{+} CD4^{+}$ T细胞中$ICOS^{+}$细胞的比例为$75\\%$。这是序列中的下一个条件概率：\n$$P(E_3 | E_1 \\cap E_2) = 0.75$$\n4. $ICOS^{+} PD-1^{\\text{high}} CXCR5^{+} CD4^{+}$ T细胞中$CCR7^{\\text{low}}$细胞的比例为$80\\%$。这是最后的条件概率：\n$$P(E_4 | E_1 \\cap E_2 \\cap E_3) = 0.80$$\n\n问题假设“所述的条件频率在指定的圈门序列中成立”。这一结构要求使用概率的链式法则来求出这些事件交集的联合概率。链式法则表述如下：\n$$P(E_1 \\cap E_2 \\cap E_3 \\cap E_4) = P(E_1) \\times P(E_2 | E_1) \\times P(E_3 | E_1 \\cap E_2) \\times P(E_4 | E_1 \\cap E_2 \\cap E_3)$$\n\n必须注意给出的第一个数据点：“在$CD4^{+}$ T细胞中，CCR7$^{\\text{high}}$的比例为$40\\%$。”这意味着一个$CD4^{+}$细胞为$CCR7^{\\text{low}}$的边缘概率是$P(E_4) = 1 - 0.40 = 0.60$。这个信息对于序贯圈门逻辑所要求的计算是无关的。序贯模型明确提供了*条件*概率$P(E_4 | E_1 \\cap E_2 \\cap E_3) = 0.80$，这才是链式法则中应使用的正确值。该边缘概率与指定的分析路径无关，必须忽略。\n\n我们现在通过将给定的条件概率代入链式法则公式来进行计算：\n$$P(T_{\\text{fh}} \\text{ among } CD4^{+}) = 0.20 \\times 0.60 \\times 0.75 \\times 0.80$$\n\n为了系统地进行乘法运算：\n首先，我们计算前两项的乘积：\n$$0.20 \\times 0.60 = 0.12$$\n接下来，我们将此结果乘以第三项。使用分数形式表示$0.75$会很高效：\n$$0.12 \\times 0.75 = 0.12 \\times \\frac{3}{4} = 0.03 \\times 3 = 0.09$$\n最后，我们将这个中间结果乘以最后一项：\n$$0.09 \\times 0.80 = 0.072$$\n\n因此，由表型$CD4^{+} CXCR5^{+} PD-1^{\\text{high}} ICOS^{+} CCR7^{\\text{low}}$定义的T滤泡辅助细胞门，在总$CD4^{+}$ T细胞群体中的预期频率为$0.072$。", "answer": "$$\n\\boxed{0.072}\n$$", "id": "2849252"}, {"introduction": "生发中心反应是一个由资源限制所调控的动态过程，其中Tfh细胞的辅助是B细胞存活的关键“通货”。本问题挑战您建立一个简单的“信封背面”模型，来估算维持一个B细胞群体所需的Tfh细胞的最小数量。这种速率平衡计算是培养对生物系统规模和约束条件的定量直觉的有力工具。[@problem_id:2849274]", "problem": "生发中心（GC）B细胞经历周期性选择，其存活和增殖需要来自滤泡辅助性T细胞（Tfh）的定期同源辅助，这种辅助通过T细胞受体对肽-II类主要组织相容性复合物的识别、CD40-CD40配体结合以及包括白细胞介素-21在内的细胞因子等信号来介导。对于依赖外部输入的细胞群体的稳态维持，一个被广泛接受且可检验的原则是：系统范围内的总输入供给率必须满足或超过系统范围内的总输入需求率。考虑一个包含 $10{,}000$ 个B细胞的生发中心，其中每个B细胞平均每 $6$ 小时需要一次成功的Tfh辅助事件以避免细胞凋亡并继续参与选择。假设每个Tfh细胞平均每小时可以为不同的B细胞提供 $8$ 次成功的辅助事件，所有辅助事件的效果相同，且不存在其他限制步骤。仅使用系统范围需求和系统范围供给之间的稳态速率平衡，估算维持该生发中心所需的Tfh细胞的最小数量。由于细胞数量是离散的，请将您的最终答案报告为大于或等于连续速率平衡所隐含的值的最小整数。以整数计数（无单位）形式表示您的答案。因为答案必须是整数，所以无需四舍五入到有效数字。", "solution": "问题陈述已提交以供验证。\n\n步骤1：提取已知条件。\n- 生发中心（GC）B细胞总数，$N_B = 10{,}000$。\n- 每个B细胞的平均辅助需求：每 $6$ 小时需要 $1$ 次成功的滤泡辅助性T细胞（Tfh）辅助事件。\n- 每个Tfh细胞的平均辅助供给：每小时提供 $8$ 次成功的辅助事件。\n- 稳态维持原则：系统范围内的总输入供给率必须满足或超过系统范围内的总输入需求率。\n- 最终答案要求：大于或等于由连续速率平衡模型得出的值的最小整数。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，模拟了适应性免疫学中的一个基本概念——生发中心内资源受限的B细胞选择。该问题的前提是对B细胞存活需要T细胞辅助这一要求的一个简化但概念上有效的表述。这个问题提法恰当，提供了构建速率平衡方程所需的所有定量数据。其语言客观而精确。该问题是自洽、一致的，并且没有违反任何数学或生物学的基本原理。这是一个与其所述主题直接相关的可形式化问题。\n\n步骤3：结论与行动。\n问题被认定为有效。将构建一个解决方案。\n\n核心原则是稳态下的速率平衡。提供给系统的Tfh辅助总速率必须大于或等于系统所需的Tfh辅助总速率。\n设 $R_{supply}$ 为Tfh辅助事件的系统范围总供给率。\n设 $R_{demand}$ 为Tfh辅助事件的系统范围总需求率。\n维持GC的条件是：\n$$R_{supply} \\ge R_{demand}$$\n首先，我们计算总需求率 $R_{demand}$。\nB细胞的数量是 $N_B = 10{,}000$。\n每个B细胞每 $6$ 小时需要 $1$ 次辅助事件。因此，每个B细胞的需求率 $r_{d}$ 是：\n$$r_{d} = \\frac{1 \\text{ event}}{6 \\text{ hours}} = \\frac{1}{6} \\text{ events} \\cdot \\text{hour}^{-1}$$\n整个B细胞群体的总需求率是B细胞数量乘以每个B细胞的需求率：\n$$R_{demand} = N_B \\times r_{d} = 10{,}000 \\times \\frac{1}{6} \\text{ events} \\cdot \\text{hour}^{-1}$$\n接下来，我们计算总供给率 $R_{supply}$。\n设 $N_{Tfh}$ 为Tfh细胞的数量，这是待求的量。\n每个Tfh细胞每小时可以提供 $8$ 次辅助事件。每个Tfh细胞的供给率 $r_{s}$ 是：\n$$r_{s} = 8 \\text{ events} \\cdot \\text{hour}^{-1}$$\n所有Tfh细胞的总供给率是Tfh细胞的数量乘以每个Tfh细胞的供给率：\n$$R_{supply} = N_{Tfh} \\times r_{s} = N_{Tfh} \\times 8 \\text{ events} \\cdot \\text{hour}^{-1}$$\n现在，我们应用稳态条件 $R_{supply} \\ge R_{demand}$：\n$$N_{Tfh} \\times 8 \\ge \\frac{10{,}000}{6}$$\n为了找到所需的Tfh细胞的最小数量，我们在该不等式的极限处（即供给等于需求时）求解 $N_{Tfh}$：\n$$N_{Tfh} \\times 8 = \\frac{10{,}000}{6}$$\n$$N_{Tfh} = \\frac{10{,}000}{6 \\times 8} = \\frac{10{,}000}{48}$$\n我们简化这个分数：\n$$N_{Tfh} = \\frac{5000}{24} = \\frac{2500}{12} = \\frac{1250}{6} = \\frac{625}{3}$$\n将分数转换为小数得到：\n$$N_{Tfh} = 208.333...$$\n由于细胞数量必须是整数，并且Tfh细胞的数量必须足以满足或超过需求，我们必须找到大于或等于 $208.333...$ 的最小整数。这相当于对该值取向上取整。\n$$N_{Tfh, min} = \\lceil \\frac{625}{3} \\rceil = \\lceil 208.333... \\rceil = 209$$\n因此，在指定条件下，维持一个包含 $10{,}000$ 个B细胞的生发中心群体至少需要 $209$ 个Tfh细胞。", "answer": "$$\\boxed{209}$$", "id": "2849274"}, {"introduction": "为了理解亲和力成熟过程是如何展开的，我们可以从静态估算转向动态模拟。本实践要求您建立并探索一个生发中心内克隆选择的计算模型，将B细胞受体亲和力和Tfh细胞辅助等关键生物学原理与一个适应度函数联系起来。通过模拟多轮竞争，您将研究不同的选择压力如何塑造克隆优势，这是适应性免疫应答的一个核心结果。[@problem_id:2849283]", "problem": "您需要为一个简单的选择模型进行形式化，该模型描述了B细胞克隆接受滤泡辅助性T细胞（Follicular helper T cells, Tfh）辅助的过程。其目标是将核心免疫学事实与定量模型联系起来，并计算一个克隆优势度量。您可以假定的基础生物学依据包括以下广泛接受的事实：B细胞在生发中心竞争有限的Tfh辅助；亲和力更高的B细胞能捕获并呈递更多抗原；B细胞接收到的存活和扩增信号与其受体亲和力以及捕获的Tfh辅助量成正比。基于这些事实，我们形式化一个离散时间选择动态模型。\n\n模型定义与假设：\n- 存在 $K$ 个B细胞克隆，其索引为 $i \\in \\{1,\\dots,K\\}$，初始频率为 $p_i(0)$（使得 $\\sum_{i=1}^{K} p_i(0) = 1$），固定亲和力为 $a_i > 0$。我们取 $K = 4$ 且对所有 $i$ 都有 $p_i(0) = 1/4$。\n- Tfh辅助总量有限且归一化为 $1$。克隆 $i$ 在时间 $t$ 获得的辅助量（表示为 $h_i(t)$）通过与 $a_i^\\eta p_i(t)$ 成正比的竞争性分配来定义：\n$$\nh_i(t) = \\frac{a_i^\\eta p_i(t)}{\\sum_{j=1}^{K} a_j^\\eta p_j(t)} \\quad \\text{其中 } \\eta = 1.0.\n$$\n- 克隆 $i$ 的适应度建模为\n$$\nF_i(t) = a_i^\\gamma \\, h_i(t)^\\delta,\n$$\n其中 $\\gamma \\ge 0$ 和 $\\delta \\ge 0$ 量化了受体亲和力和Tfh辅助对有效选择的贡献强度。\n- 每轮通过一个标准选择步骤对种群进行重新归一化：\n$$\np_i(t+1) = \\frac{p_i(t) \\, F_i(t)}{\\sum_{j=1}^{K} p_j(t) \\, F_j(t)}.\n$$\n- 我们将此更新迭代 $T$ 轮，其中 $T = 5$。\n\n量化克隆优势：\n- 经过 $T$ 轮后，计算 Simpson 集中度（也称为赫芬达尔指数）：\n$$\nS = \\sum_{i=1}^{K} p_i(T)^2,\n$$\n其值位于 $[1/K,1]$ 区间内，越大的 $S$ 值表示越强的克隆优势。\n\n您的任务：\n- 实现上述动态模型，并为下面指定的测试套件中的每个测试用例计算 $S$。\n- 数值说明：\n  - 使用精确的极限定义处理任何等于零的指数，例如对于任意 $x>0$，有 $x^0 = 1$。因此，当 $\\delta = 0$ 时，$F_i(t) = a_i^\\gamma$；当 $\\gamma = 0$ 且 $\\delta > 0$ 时，$F_i(t) = h_i(t)^\\delta$；当 $\\gamma = 0$ 且 $\\delta = 0$ 时，对所有 $i$ 都有 $F_i(t) = 1$。\n  - 不涉及角度。\n  - 不涉及物理单位。\n- 输出要求：\n  - 将每个 $S$ 表示为小数（而非百分比），四舍五入到恰好 $6$ 位小数。\n  - 您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[s_1,s_2,\\dots,s_m]$。\n\n测试套件：\n- 使用两个亲和力向量：\n  - 异质亲和力 $\\mathbf{a}^{(1)} = \\left[1.0,\\,1.2,\\,1.5,\\,2.0\\right]$。\n  - 同质亲和力 $\\mathbf{a}^{(2)} = \\left[1.0,\\,1.0,\\,1.0,\\,1.0\\right]$。\n- 初始频率对所有 $i$ 均为 $p_i(0) = 1/4$。\n- 轮数 $T = 5$。\n- 辅助分配指数 $\\eta = 1.0$。\n- 为以下参数集 $(\\gamma,\\delta,\\mathbf{a})$ 计算 $S$：\n  - 情况 $1$：$(\\gamma,\\delta,\\mathbf{a}) = (1.0,\\,1.0,\\,\\mathbf{a}^{(1)})$。\n  - 情况 $2$：$(\\gamma,\\delta,\\mathbf{a}) = (2.0,\\,0.0,\\,\\mathbf{a}^{(1)})$。\n  - 情况 $3$：$(\\gamma,\\delta,\\mathbf{a}) = (0.5,\\,1.5,\\,\\mathbf{a}^{(1)})$。\n  - 情况 $4$：$(\\gamma,\\delta,\\mathbf{a}) = (0.0,\\,1.0,\\,\\mathbf{a}^{(1)})$。\n  - 情况 $5$：$(\\gamma,\\delta,\\mathbf{a}) = (0.0,\\,0.0,\\,\\mathbf{a}^{(1)})$。\n  - 情况 $6$：$(\\gamma,\\delta,\\mathbf{a}) = (1.0,\\,1.0,\\,\\mathbf{a}^{(2)})$。\n\n最终答案规格：\n- 程序必须按所列顺序为每种情况计算 Simpson 集中度 $S$，并打印单行结果 $[S_1,S_2,S_3,S_4,S_5,S_6]$，其中每个 $S_k$ 都四舍五入到恰好 $6$ 位小数。", "solution": "问题陈述已经过严格验证，并被认定为有效。这是一个适定的、有科学依据的问题，它将免疫学中的克隆选择原理形式化为一个确定性计算模型。陈述中没有逻辑矛盾、歧义或事实错误。任务是基于所提供的离散时间动力系统计算一个特定的度量。我们将开始进行求解。\n\n该模型描述了 $K$ 个竞争性B细胞克隆的频率 $p_i(t)$ 的演变过程。给定 $K=4$ 个克隆，所有 $i \\in \\{1, 2, 3, 4\\}$ 的初始频率均为 $p_i(0) = 1/4$。每个克隆 $i$ 具有固定的亲和力 $a_i > 0$。模拟运行 $T=5$ 个时间步。\n\n该动态过程由以下方程控制。首先，克隆 $i$ 在时间 $t$ 获得的Tfh辅助 $h_i(t)$ 是通过竞争性分配的：\n$$\nh_i(t) = \\frac{a_i^\\eta p_i(t)}{\\sum_{j=1}^{K} a_j^\\eta p_j(t)}\n$$\n其中参数 $\\eta=1.0$ 控制亲和力对辅助捕获的影响。由于 $\\sum_{i=1}^K p_i(t) = 1$，如果我们设置 $\\eta=0$，辅助量将与频率成正比。当 $\\eta=1.0$ 时，亲和力更高的克隆在捕获辅助方面具有不成比例的优势。\n\n其次，克隆 $i$ 的适应度 $F_i(t)$ 是其内在亲和力 $a_i$ 和捕获的辅助量 $h_i(t)$ 的函数：\n$$\nF_i(t) = a_i^\\gamma \\, h_i(t)^\\delta\n$$\n这里，$\\gamma \\ge 0$ 和 $\\delta \\ge 0$ 是决定内在亲和力和获得的辅助对选择过程的相对贡献的参数。$\\delta > 0$ 的值引入了频率依赖性选择，因为 $h_i(t)$ 依赖于 $p_i(t)$。\n\n第三，克隆频率在每一轮中根据标准复制子方程进行更新，该方程在选择后对种群进行归一化：\n$$\np_i(t+1) = \\frac{p_i(t) \\, F_i(t)}{\\sum_{j=1}^{K} p_j(t) \\, F_j(t)}\n$$\n\n为了计算实现，推导出一个简化的 $p_i(t+1)$ 单步递推关系是高效的。我们将 $h_i(t)$ 和 $F_i(t)$ 的表达式代入更新规则中：\n$$\np_i(t+1) = \\frac{p_i(t) \\left( a_i^\\gamma \\left( \\frac{a_i^\\eta p_i(t)}{\\sum_{k=1}^{K} a_k^\\eta p_k(t)} \\right)^\\delta \\right)}{\\sum_{j=1}^{K} p_j(t) \\left( a_j^\\gamma \\left( \\frac{a_j^\\eta p_j(t)}{\\sum_{k=1}^{K} a_k^\\eta p_k(t)} \\right)^\\delta \\right)}\n$$\n项 $(\\sum_{k=1}^{K} a_k^\\eta p_k(t))^{-\\delta}$ 是分子和分母中的一个公因子，因此可以消去。这导出了简化的递推式：\n$$\np_i(t+1) = \\frac{p_i(t) a_i^\\gamma a_i^{\\eta\\delta} p_i(t)^\\delta}{\\sum_{j=1}^{K} p_j(t) a_j^\\gamma a_j^{\\eta\\delta} p_j(t)^\\delta} = \\frac{a_i^{\\gamma + \\eta\\delta} p_i(t)^{1+\\delta}}{\\sum_{j=1}^{K} a_j^{\\gamma + \\eta\\delta} p_j(t)^{1+\\delta}}\n$$\n这种形式将时间 $t+1$ 的频率直接与时间 $t$ 的频率和固定参数联系起来，避免了在每个步骤中显式计算中间量 $h_i(t)$ 和 $F_i(t)$。这就是我们将要实现的关系式。\n\n为每个测试用例找到 Simpson 集中度 $S$ 的算法流程如下：\n1.  为特定情况初始化参数：亲和力向量 $\\mathbf{a}$，以及指数 $\\gamma$ 和 $\\delta$。值 $K=4$、$T=5$ 和 $\\eta=1.0$ 是固定的。\n2.  将频率向量 $p(0)$ 初始化为均匀分布：对于 $i \\in \\{1, 2, 3, 4\\}$，$p_i(0) = 1/4$。\n3.  对 $t$ 从 $0$ 到 $T-1=4$ 迭代简化的递推关系。在每次迭代中，使用向量 $p(t)$ 计算 $p(t+1)$。\n4.  经过 $T=5$ 轮后，获得最终的频率分布 $p(T)$。\n5.  计算 Simpson 集中度 $S = \\sum_{i=1}^{K} p_i(T)^2$。\n\n对特殊情况的分析可用于验证模型的逻辑性。\n- 情况5：$(\\gamma, \\delta, \\mathbf{a}) = (0.0, 0.0, \\mathbf{a}^{(1)})$。简化递推式中的指数变为 $\\gamma+\\eta\\delta=0$ 和 $1+\\delta=1$。更新规则为 $p_i(t+1) = \\frac{a_i^0 p_i(t)^1}{\\sum_j a_j^0 p_j(t)^1} = \\frac{p_i(t)}{\\sum_j p_j(t)} = p_i(t)$，因为 $\\sum_j p_j(t)=1$。频率从其初始状态开始就不会改变。因此，对所有 $i$ 都有 $p_i(T) = p_i(0) = 1/4$。Simpson 集中度为 $S = \\sum_{i=1}^4 (1/4)^2 = 4 \\times (1/16) = 1/4 = 0.25$。\n- 情况6：$(\\gamma, \\delta, \\mathbf{a}) = (1.0, 1.0, \\mathbf{a}^{(2)})$。此处，亲和力是同质的：对所有 $i$ 都有 $a_i = 1.0$。项 $a_i^{\\gamma+\\eta\\delta}$ 对所有克隆都等于 $1.0^{\\gamma+\\eta\\delta}=1.0$，可以从求和中提出并消去。更新规则简化为 $p_i(t+1) = \\frac{p_i(t)^{1+\\delta}}{\\sum_j p_j(t)^{1+\\delta}}$。因为所有克隆都以相同的频率 $p_i(0)=1/4$ 开始，它们的演变将完全相同。在整个模拟过程中，频率保持在 $1/4$ 的均匀分布。因此，这种情况下的 $S$ 也为 $0.25$。\n\n案例5和6的这些分析结果可作为基线，用于与异质亲和力下的选择结果进行比较。对于其余情况，将通过计算执行所述算法。实现将使用 `numpy` 进行高效的向量运算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Simpson concentration for B cell clone selection dynamics\n    based on a set of test cases.\n    \"\"\"\n\n    # --- Test Case Definitions ---\n    # Affinity vectors\n    a_heterogeneous = [1.0, 1.2, 1.5, 2.0]\n    a_homogeneous = [1.0, 1.0, 1.0, 1.0]\n\n    # Parameter sets (gamma, delta, a)\n    test_cases = [\n        (1.0, 1.0, a_heterogeneous),  # Case 1\n        (2.0, 0.0, a_heterogeneous),  # Case 2\n        (0.5, 1.5, a_heterogeneous),  # Case 3\n        (0.0, 1.0, a_heterogeneous),  # Case 4\n        (0.0, 0.0, a_heterogeneous),  # Case 5\n        (1.0, 1.0, a_homogeneous),    # Case 6\n    ]\n\n    # --- Simulation Function ---\n    def run_simulation(gamma, delta, a_values):\n        \"\"\"\n        Runs the simulation for a single test case.\n        \"\"\"\n        # Model parameters\n        K = 4\n        T = 5\n        eta = 1.0\n\n        # Initial conditions\n        p = np.full(K, 1.0 / K)\n        a = np.array(a_values)\n\n        # Simplified recurrence exponents\n        exponent_a = gamma + eta * delta\n        exponent_p = 1.0 + delta\n        \n        # Check for the trivial case of no selection\n        # Case 5: gamma=0, delta=0 -> p(t+1) = p(t)\n        # Case 6: homogeneous 'a' and uniform 'p' -> p(t+1) = p(t)\n        # This optimization is not strictly needed but reflects analytical insight.\n        if (gamma == 0.0 and delta == 0.0) or np.all(a == a[0]):\n             # Frequencies do not change from uniform initial state\n            final_p = p\n        else:\n            # Main simulation loop\n            for _ in range(T):\n                # Calculate numerators of the simplified recurrence relation\n                numerators = np.power(a, exponent_a) * np.power(p, exponent_p)\n                \n                # Calculate the denominator (normalization factor)\n                denominator = np.sum(numerators)\n                \n                # Update frequencies\n                if denominator == 0:\n                    # This case should not be reached with the given problem constraints.\n                    # If it were, it would imply all clones have gone extinct.\n                    p = np.full(K, 0.0)\n                else:\n                    p = numerators / denominator\n            \n            final_p = p\n            \n        # Compute Simpson concentration S\n        S = np.sum(np.power(final_p, 2))\n        return S\n\n    # --- Main Execution ---\n    results = []\n    for gamma, delta, a_values in test_cases:\n        S = run_simulation(gamma, delta, a_values)\n        results.append(S)\n\n    # Format output as a list of strings rounded to 6 decimal places\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2849283"}]}