{"hands_on_practices": [{"introduction": "理解T细胞共刺激的第一步，是量化其分子基础——受体与配体间的结合强度。本练习将指导您分析表面等离子共振（SPR）实验的模拟数据，这是一种测量此类相互作用动力学的黄金标准技术。您将从动力学速率常数（$k_{\\text{on}}$ 和 $k_{\\text{off}}$）推导出热力学平衡解离常数（$K_D$），并理解该计算背后关键的实验假设，这是分子免疫学研究中的一项核心技能[@problem_id:2841897]。", "problem": "您正在设计一个动力学表面等离激元共振（SPR）实验，以测量人分化簇$28$（CD$28$）与人B$7$-$2$（CD$86$）相互作用的结合速率常数 $k_{\\text{on}}$ 和解离速率常数 $k_{\\text{off}}$，两者均为胞外域。为确保测量探测的是单价结合位点间的内在结合动力学，而非亲合力或传质效应，您计划了以下符合实验现实的设置：\n- 使用蛋白A/G传感器表面捕获与免疫球蛋白Fc结构域融合的重组CD$86$，以实现定向捕获，从而呈现CD$28$的结合位点。目标固定水平约为$150$响应单位，以使反应保持在反应限制区。\n- 在$25$ $\\mathrm{^{\\circ}C}$下，将作为分析物的重组可溶性CD$28$（单体胞外域）以$50$ $\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$的高流速流过一种与生理离子强度兼容的运行缓冲液（例如，$10$ $\\mathrm{mM}$ HEPES、$150$ $\\mathrm{mM}$ $\\mathrm{NaCl}$、$3$ $\\mathrm{mM}$ EDTA、$0.005\\,\\%$ 表面活性剂）。使用一个参考通道并进行双重参比扣除。\n- 注射浓度为$0.50$、$1.0$、$2.0$、$4.0$、$8.0$和$16.0$ $\\mu\\mathrm{M}$的两倍稀释系列CD$28$，每个循环的结合相为$180$ $\\mathrm{s}$，解离相为$600$ $\\mathrm{s}$。使用不会使CD$86$变性的短脉冲进行再生。\n- 将结合和解离传感图全局拟合到单一位点可逆结合模型，以获得 $k_{\\text{on}}$ 和 $k_{\\text{off}}$。\n\n从适用于遵循质量作用定律的单一位点可逆相互作用的基本动力学原理出发，推导出用动力学参数 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 表示的平衡解离常数 $K_{D}$，并解释为何该推导在反应限制的SPR条件下有效。然后，使用您实验中得到的以下代表性拟合结果，\n- $k_{\\text{on}} = 1.25 \\times 10^{5}$ $\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n- $k_{\\text{off}} = 0.625$ $\\mathrm{s}^{-1}$\n计算 $K_{D}$ 的数值。\n\n以纳摩尔浓度表示最终的 $K_{D}$。将您的答案四舍五入至三位有效数字。", "solution": "必须首先严格验证问题陈述的科学性和逻辑完整性。\n\n步骤1：提取已知条件。\n问题提供了以下信息：\n-   研究的相互作用：人分化簇$28$（CD$28$）作为分析物，人B$7$-$2$（CD$86$）作为配体。\n-   实验技术：表面等离激元共振（SPR）。\n-   配体固定：在蛋白A/G表面捕获的重组CD$86$-Fc融合蛋白。\n-   目标固定水平：约$150$响应单位（RU）。\n-   分析物：重组可溶性CD$28$（单体胞外域）。\n-   流速：$50$ $\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$。\n-   缓冲液条件：$10$ $\\mathrm{mM}$ HEPES、$150$ $\\mathrm{mM}$ $\\mathrm{NaCl}$、$3$ $\\mathrm{mM}$ EDTA、$0.005\\,\\%$表面活性剂。\n-   温度：$25$ $\\mathrm{^{\\circ}C}$。\n-   用于注射的分析物浓度：一个浓度为$0.50$、$1.0$、$2.0$、$4.0$、$8.0$和$16.0$ $\\mu\\mathrm{M}$的两倍稀释系列。\n-   动力学阶段持续时间：结合相$180$ $\\mathrm{s}$，解离相$600$ $\\mathrm{s}$。\n-   分析模型：对单一位点可逆结合模型的全局拟合。\n-   实验测定的动力学速率常数：\n    -   $k_{\\text{on}} = 1.25 \\times 10^{5}$ $\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n    -   $k_{\\text{off}} = 0.625$ $\\mathrm{s}^{-1}$\n-   目标：用 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 表示平衡解离常数 $K_{D}$，解释在给定实验条件下该关系的有效性，并计算 $K_{D}$ 的数值（以纳摩尔浓度表示，四舍五入至三位有效数字）。\n\n步骤2：使用提取的已知条件进行验证。\n根据所需标准对问题进行评估。\n-   **科学性**：该问题描述了一个标准的生物物理实验，用于表征免疫学中一个众所周知的蛋白质-蛋白质相互作用。SPR的使用、特定的分子CD$28$和CD$86$、实验参数（固定水平、流速、浓度、缓冲液）以及动力学模型都是标准的且科学合理的。速率常数与平衡常数之间的关系是化学动力学的基本原理。该问题基于已确立的科学原理。\n-   **良态性**：该问题要求根据所提供的数据进行标准推导和直接计算。其定义清晰，并有唯一、稳定的解。\n-   **客观性**：语言是技术性的，没有主观或基于观点的陈述。\n-   **完整性**：计算所需的所有必要数据（$k_{\\text{on}}$、$k_{\\text{off}}$）和指令（最终单位、四舍五入）均已提供。推导的背景也足够充分。\n-   **一致性与现实性**：所提供的实验设计（低配体密度、高流速）与达到反应限制区的既定目标相一致，这对于测量内在动力学和避免传质效应至关重要。动力学常数在此类瞬时蛋白质-蛋白质相互作用的实际范围内。\n\n步骤3：结论与行动。\n该问题科学有效、良态、客观且自洽。因此，将提供一个解答。\n\n可溶性分析物 $A$（CD$28$）与表面固定的配体 $L$（CD$86$）相互作用形成复合物 $C$（CD$28$-CD$86$复合物）的过程，可以用单一位点可逆反应表示为：\n$$A + L \\rightleftharpoons C$$\n该反应遵循质量作用定律。复合物的形成速率（结合）与游离分析物浓度 $[A]$ 和游离配体浓度 $[L]$ 成正比。此过程的速率常数是结合速率常数 $k_{\\text{on}}$。\n$$ \\text{Rate}_{\\text{association}} = k_{\\text{on}} [A] [L] $$\n复合物的分解速率（解离）与复合物浓度 $[C]$ 成正比。此过程的速率常数是解离速率常数 $k_{\\text{off}}$。\n$$ \\text{Rate}_{\\text{dissociation}} = k_{\\text{off}} [C] $$\n在化学平衡状态下，复合物浓度的净变化率为零。这发生在结合速率等于解离速率时。\n$$ \\text{Rate}_{\\text{association}} = \\text{Rate}_{\\text{dissociation}} $$\n$$ k_{\\text{on}} [A]_{\\text{eq}} [L]_{\\text{eq}} = k_{\\text{off}} [C]_{\\text{eq}} $$\n其中下标‘eq’表示平衡时的浓度。\n\n平衡解离常数 $K_{D}$ 由平衡时各物质的浓度定义：\n$$ K_{D} \\equiv \\frac{[A]_{\\text{eq}} [L]_{\\text{eq}}}{[C]_{\\text{eq}}} $$\n通过重新排列平衡速率方程，我们可以用动力学速率常数来表示这个比率：\n$$ \\frac{[A]_{\\text{eq}} [L]_{\\text{eq}}}{[C]_{\\text{eq}}} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} $$\n因此，推导得出的结论是，平衡解离常数是解离速率常数与结合速率常数的比值：\n$$ K_{D} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} $$\n\n此推导对于指定的SPR实验是有效的，因为该实验被设计为处于**反应限制区**。在SPR中，响应信号 $R$ 与结合到表面的分析物质量成正比，这对应于复合物的浓度 $[C]$。响应的变化率由以下微分方程给出：\n$$ \\frac{dR}{dt} = k_{\\text{on}} [A] (R_{\\text{max}} - R) - k_{\\text{off}} R $$\n该模型假设传感器表面的分析物浓度等于流过芯片的主体分析物浓度 $[A]$。这个假设仅在分析物向表面的传质速率（扩散和对流）远大于其通过结合反应被消耗的速率时才成立。如果不满足此条件（即处于传质限制区），表面处的分析物浓度将会耗尽，观察到的动力学将与扩散速率混杂在一起，导致 $k_{\\text{on}}$ 的不准确和低估。实验设计通过使用低配体密度（约$150$ RU）来降低分析物消耗速率，并使用高流速（$50$ $\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$）来最大化表面分析物的补充速率，从而明确地减弱了这个问题。在这些反应限制条件下，质量作用定律可以正确地应用于主体浓度，所测得的 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 代表了内在的分子动力学参数。因此，推导出的关系式 $K_{D} = k_{\\text{off}} / k_{\\text{on}}$ 准确地反映了分子相互作用的热力学亲和力。\n\n现在，我们使用提供的实验结果计算 $K_{D}$ 的数值：\n-   $k_{\\text{on}} = 1.25 \\times 10^{5}$ $\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n-   $k_{\\text{off}} = 0.625$ $\\mathrm{s}^{-1}$\n\n将这些值代入推导出的公式中：\n$$ K_{D} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{0.625 \\; \\mathrm{s}^{-1}}{1.25 \\times 10^{5} \\; \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}} $$\n$$ K_{D} = \\frac{0.625}{1.25} \\times 10^{-5} \\; \\mathrm{M} $$\n$$ K_{D} = 0.500 \\times 10^{-5} \\; \\mathrm{M} = 5.00 \\times 10^{-6} \\; \\mathrm{M} $$\n问题要求最终答案以纳摩尔浓度（nM）表示。我们使用换算因子 $1$ $\\mathrm{M} = 10^{9}$ $\\mathrm{nM}$。\n$$ K_{D} = (5.00 \\times 10^{-6} \\; \\mathrm{M}) \\times \\left( \\frac{10^{9} \\; \\mathrm{nM}}{1 \\; \\mathrm{M}} \\right) $$\n$$ K_{D} = 5.00 \\times 10^{-6+9} \\; \\mathrm{nM} $$\n$$ K_{D} = 5.00 \\times 10^{3} \\; \\mathrm{nM} $$\n结果 $5000$ 已经以 $5.00 \\times 10^3$ 的形式表示为三位有效数字。", "answer": "$$\\boxed{5.00 \\times 10^{3}}$$", "id": "2841897"}, {"introduction": "在量化了分子亲和力之后，下一步是理解这些结合事件如何在细胞层面整合并转化为功能性输出。本练习将挑战您构建一个简洁的数学模型，以从第一性原理出发，预测移除CD28共刺激信号后，T细胞对抗原的剂量反应曲线将如何改变，包括其最大反应强度、半数有效浓度（$EC_{50}$）和协同性。通过这个过程，您将深刻理解控制T细胞激活的协同“与门”逻辑[@problem_id:2841941]。", "problem": "一个初始鼠源CD4$^+$ T细胞群体在体外于培养板上受到刺激，板上呈递着固定、饱和密度的B7配体以及滴定量的激动剂肽-主要组织相容性复合物 (pMHC)。在$16$小时测量白细胞介素-$2$ (IL-$2$) 的输出 $R(A)$，作为抗原浓度 $A$ 的函数。在一种条件下，野生型T细胞通过CD28接受完整的共刺激。在第二种条件下，CD28信号被移除（例如，通过基因敲除或饱和的抗CD28阻断），而所有其他参数，包括B7密度和pMHC呈递，均保持不变。\n\n假设以下被广泛接受的基础：\n- T细胞活化需要通过T细胞受体 (TCR) 的“信号$1$”和通过共刺激受体（如CD28）的“信号$2$”同时存在；早期基因表达（例如IL-$2$）由联合启动子逻辑控制，需要活化T细胞核因子 (NFAT) 与活化蛋白$1$ (AP-$1$) 及活化B细胞的核因子κ-轻链增强子 (NF-κB) 共同作用。\n- pMHC下游的TCR模块可以表示为一个单调、饱和的希尔型转导函数 $T(A)$，其希尔系数为 $h$，半饱和常数为 $K_T$，这反映了多步校对和受体协同性。\n- CD28模块提供一种类似于AP-$1$/NF-κB的活性，该活性主要依赖于CD28，但也可以通过丝裂原活化蛋白激酶 (MAPK) 从TCR单独获得微弱的贡献，从而在IL-$2$启动子上产生协同的、与门逻辑样的整合。\n\n基于这些基础，预测去除CD28信号会如何改变抗原剂量-反应曲线 $R(A)$，并通过构建一个与上述原则一致的、最小的、生物物理上合理的协同整合模型来证明你的预测。选择最佳描述：\n\nA. 剂量-反应曲线右移（更高的$EC_{50}$），最大反应降低，且由于联合启动子驱动中CD28依赖的准线性项的丧失，表观希尔斜率（协同性）变得更陡峭。\n\nB. 剂量-反应曲线左移（更低的$EC_{50}$），最大反应增加，因为在CD28缺失时，TCR信号会进行乘法性补偿。\n\nC. 仅发生垂直缩放：最大反应降低，但$EC_{50}$和斜率不变，因为共刺激是对固定TCR曲线的纯增益因子。\n\nD. 仅发生水平平移：$EC_{50}$增加，但最大反应和斜率不变，因为共刺激改变了敏感性而非效能。\n\nE. 剂量-反应曲线右移，最大反应降低，但表观希尔斜率变得更平缓，因为协同非线性随着CD28阻断而丧失。", "solution": "问题陈述需经过验证。\n\n**第1步：提取已知条件**\n- **系统：** 初始鼠源CD$4^+$ T细胞群体。\n- **刺激：** 在培养板上进行体外刺激，板上具有固定、饱和密度的B7配体和滴定浓度的激动剂肽-主要组织相容性复合物 (pMHC) $A$。\n- **测量：** 在$16$小时测量白细胞介素-$2$ (IL-$2$) 的输出，记为 $R(A)$。\n- **条件：**\n    1. 具有完整CD$28$共刺激的野生型 (WT) T细胞。\n    2. 移除CD$28$信号 (CD$28$-/-)，所有其他参数保持不变。\n- **基本原则：**\n    1. T细胞活化需要同时存在“信号$1$” (TCR) 和“信号$2$” (CD$28$)。\n    2. IL-$2$的表达遵循联合启动子逻辑，需要活化T细胞核因子 (NFAT)、活化蛋白$1$ (AP-$1$) 和活化B细胞的核因子κ-轻链增强子 (NF-κB)。\n    3. TCR信号转导 $T(A)$ 是一个单调、饱和的希尔型函数，系数为 $h$，半饱和常数为 $K_T$。\n    4. CD$28$模块提供AP-$1$/NF-κB活性，该活性也可以从TCR通路获得微弱贡献。\n    5. IL-$2$启动子上的信号整合是协同的、与门逻辑样的。\n\n**第2步：使用提取的已知条件进行验证**\n该问题是科学上合理的，借鉴了T细胞免疫学的既定原则，包括双信号活化、特定的转录因子和协同信号整合。问题定义良好，提供了清晰的问题和足够的概念约束，以构建数学模型并得出唯一的定性预测。语言客观而精确。实验设置是标准的且在生物物理上是现实的。该问题是可形式化的，并且需要非平凡的推理。\n\n**第3步：结论与行动**\n问题陈述被判定为**有效**。我将继续推导解决方案。\n\n**解决方案的推导**\n\n为了预测剂量-反应曲线 $R(A)$ 的变化，我们必须构建一个与所述原则一致的最小生物物理模型。\n\n1.  **信号通路建模：**\n    - TCR依赖性通路（“信号$1$”）激活NFAT。我们将其抗原依赖性活性 $S_1(A)$ 建模为一个标准化的希尔函数，这与问题描述一致：\n      $$S_1(A) = \\frac{A^h}{K_T^h + A^h}$$\n      其中 $h$ 是TCR信号模块的希尔系数，$K_T$ 是其半饱和常数。$S_1(A)$ 的值在$0$到$1$之间变化。\n\n    - AP-$1$/NF-κB活性，我们记为 $S_2(A)$，由两个来源提供：一个来自CD$28$的强的、主要的贡献，以及一个来自TCR本身的微弱贡献。\n        - CD$28$的贡献是恒定的，因为B$7$配体密度是“固定、饱和的”。我们用一个常数正项 $C$ 来表示。\n        - TCR对 $S_2$ 的微弱依赖性贡献可以建模为与主TCR信号 $S_1(A)$ 成正比，比例常数很小，即 $\\epsilon \\ll C$。\n        - 因此，总的AP-$1$/NF-κB活性为：\n          $$S_2(A) = C + \\epsilon S_1(A) = C + \\epsilon \\frac{A^h}{K_T^h + A^h}$$\n\n2.  **信号整合建模：**\n    - IL-$2$启动子逻辑被描述为“联合启动子逻辑”和“协同的、与门逻辑样的整合”。这种与门逻辑最简单的数学表示是一个乘法模型，其中最终反应 $R(A)$ 与必需转录因子组（由 $S_1$ 驱动的NFAT和由 $S_2$ 代表的AP-$1$/NF-κB）的活性乘积成正比。\n      $$R(A) = k \\cdot S_1(A) \\cdot S_2(A)$$\n      其中 $k$ 是一个比例常数。\n\n3.  **为两种情况构建反应函数：**\n    - **野生型 (WT)：** 具有完整的CD$28$信号，因此 $C  0$。反应为：\n      $$R_{\\text{WT}}(A) = k \\left( \\frac{A^h}{K_T^h + A^h} \\right) \\left( C + \\epsilon \\frac{A^h}{K_T^h + A^h} \\right)$$\n    - **CD$28$缺陷型 (-/-)：** 移除CD$28$信号，常数贡献 $C$ 变为零。反应为：\n      $$R_{\\text{-/-}}(A) = k \\left( \\frac{A^h}{K_T^h + A^h} \\right) \\left( 0 + \\epsilon \\frac{A^h}{K_T^h + A^h} \\right) = k \\epsilon \\left( \\frac{A^h}{K_T^h + A^h} \\right)^2$$\n\n4.  **比较剂量-反应曲线的特征：**\n    为简化起见，我们用 $x(A)$ 表示标准化的希尔函数 $S_1(A)$。\n    $R_{\\text{WT}}(A) = kC \\cdot x(A) + k\\epsilon \\cdot x(A)^2$\n    $R_{\\text{-/-}}(A) = k\\epsilon \\cdot x(A)^2$\n\n    -   **最大反应 ($R_{\\text{max}}$)：** 这是 $A \\to \\infty$ 时的极限，此时 $x(A) \\to 1$。\n        $R_{\\text{max, WT}} = kC \\cdot 1 + k\\epsilon \\cdot 1^2 = k(C+\\epsilon)$\n        $R_{\\text{max, -/-}} = k\\epsilon \\cdot 1^2 = k\\epsilon$\n        由于 $C  0$，可以明确 $R_{\\text{max, -/-}}  R_{\\text{max, WT}}$。最大反应降低。\n\n    -   **半数最大效应浓度 ($EC_{50}$)：** 这是反应为 $R_{max}/2$ 时的浓度 $A$。\n        对于-/-情况：$R_{\\text{-/-}}(A) = \\frac{1}{2} R_{\\text{max, -/-}} \\implies k\\epsilon \\cdot x(A)^2 = \\frac{1}{2} k\\epsilon \\implies x(A) = 1/\\sqrt{2}$。\n        对于WT情况：$R_{\\text{WT}}(A) = \\frac{1}{2} R_{\\text{max, WT}} \\implies kC \\cdot x(A) + k\\epsilon \\cdot x(A)^2 = \\frac{1}{2}k(C+\\epsilon)$。由于 $C \\gg \\epsilon$，在中点附近，$x(A)^2$ 项与 $C \\cdot x(A)$ 项相比很小。因此，$kC \\cdot x(A) \\approx \\frac{1}{2}kC$，这意味着 $x(A) \\approx 1/2$。\n        为了达到半数最大反应，在-/-情况下所需的TCR信号水平（$x(A) = 1/\\sqrt{2} \\approx 0.707$）高于WT情况（$x(A) \\approx 0.5$）。由于 $x(A)$ 是 $A$ 的单调递增函数，这意味着 $EC_{50, \\text{-/-}}  EC_{50, \\text{WT}}$。剂量-反应曲线向右平移。\n\n    -   **表观希尔斜率（协同性）：** 剂量-反应的斜率反映了其协同性。我们可以研究在低抗原浓度下的行为，其中 $A \\ll K_T$，因此 $x(A) \\approx (A/K_T)^h$。\n        $R_{\\text{WT}}(A) \\approx kC(A/K_T)^h + k\\epsilon(A/K_T)^{2h}$。由于 $C \\gg \\epsilon$，反应主要由第一项决定：$R_{\\text{WT}}(A) \\propto A^h$。表观协同性接近 $h$。\n        $R_{\\text{-/-}}(A) = k\\epsilon \\left( (A/K_T)^h \\right)^2 = k\\epsilon (A/K_T)^{2h}$。这里，$R_{\\text{-/-}}(A) \\propto A^{2h}$。表观协同性接近 $2h$。\n        由于 $2h  h$（对于 $h0$），CD$28$-/- 条件下的剂量-反应曲线更具协同性，意味着其表觀希尔斜率比WT曲线更陡峭。WT反应被大的、恒定的CD$28$依赖性信号 $C$ “线性化”了，它增加了一个关于 $x(A)$ 的准线性项，该项主导了反应的形状。失去这一项揭示了一个更高阶、更具协同性的反应。\n\n**预测总结：** 移除CD$28$信号导致：\n1.  最大反应降低。\n2.  $EC_{50}$增加（向右平移）。\n3.  表观希尔斜率增加（曲线更陡峭）。\n\n**逐项分析选项**\n\n*   **A. 剂量-反应曲线右移（更高的$EC_{50}$），最大反应降低，且由于联合启动子驱动中CD28依赖的准线性项的丧失，表观希尔斜率（协同性）变得更陡峭。**\n    - 该选项声称曲线右移、最大值降低、斜率更陡。这与我们模型的所有三个预测完全匹配。给出的原因，“CD28依赖的准线性项的丧失”，完美地描述了我们模型中的机制，其中 $kC \\cdot x(A)$ 项在CD$28$移除后丧失，使得反应更陡峭。\n    - **结论：正确。**\n\n*   **B. 剂量-反应曲线左移（更低的$EC_{50}$），最大反应增加，因为在CD28缺失时，TCR信号会进行乘法性补偿。**\n    - 这预测了曲线左移和最大值增加。两者都与我们的推导和已建立的免疫学发现相反。\n    - **结论：错误。**\n\n*   **C. 仅发生垂直缩放：最大反应降低，但$EC_{50}$和斜率不变，因为共刺激是对固定TCR曲线的纯增益因子。**\n    - 这描述了一个模型，其中 $R(A) = G \\cdot S_1(A)$。这预测 $EC_{50}$ 或斜率没有变化，这与我们反映协同与门逻辑的模型相矛盾。\n    - **结论：错误。**\n\n*   **D. 仅发生水平平移：$EC_{50}$增加，但最大反应和斜率不变，因为共刺激改变了敏感性而非效能。**\n    - 这描述了一个模型，其中 $R(A) \\propto S_1(A, K_{eff})$，而CD$28$改变了 $K_{eff}$。这预测最大反应没有变化，这是不正确的。\n    - **结论：错误。**\n\n*   **E. 剂量-反应曲线右移，最大反应降低，但表觀希尔斜率变得更平缓，因为协同非线性随着CD28阻断而丧失。**\n    - 该选项正确地指出了曲线右移和最大值降低。然而，它错误地声称斜率变得更平缓。如推导所示，斜率变得更陡峭。所提供的理由（“协同非线性丧失”）在乘法模型的背景下概念上有缺陷；WT情况下的协同作用使得反应相对于转导信号 $x(A)$ *不那么*陡峭（更接近线性），而不是纯二次方的-/-情况。\n    - **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2841941"}, {"introduction": "免疫应答的最终走向不仅取决于单个细胞的激活，还取决于不同细胞克隆之间为争夺有限资源（如B细胞表面的共刺激配体）而展开的竞争。这项高级计算练习[@problem_id:2841892]将引导您从基本的质量作用定律出发，为ICOS-ICOSL相互作用建立一个多克隆竞争模型。您将通过编程实现数值求解，并运用基尼系数（Gini coefficient）等量化指标，分析竞争如何塑造克隆优势，这一过程对于理解生发中心的选择和亲和力成熟至关重要。", "problem": "您需要对T滤泡辅助（Tfh）细胞克隆竞争B细胞上的诱导性T细胞共刺激分子配体（ICOSL，也称为B7-H2或CD275）进行建模。该模型需采用基于质量作用定律的配体受限、受体-配体平衡框架。诱导性T细胞共刺激分子（ICOS，也称为CD278）是CD28/B7共刺激家族的成员，Tfh细胞上的ICOS与B细胞上的ICOSL结合，为塑造克隆选择提供了关键的共刺激信号。您的任务是，为共享配体池的多克隆竞争建立并求解一个数学上严谨的模型，并通过非线性转换的信号输出来量化克隆优势，所有计算均使用无量纲单位。\n\n基本原理与假设：\n- 对于受体-配体结合平衡，使用质量作用定律和质量守恒定律。对于由$i \\in \\{1,\\dots,n\\}$索引的每个Tfh克隆，考虑游离配体与该克隆的受体之间形成一对一复合物的单次结合反应。\n- 令$r_i \\ge 0$为克隆$i$的无量纲总受体容量（每个有效接触），$k_i  0$为克隆$i$的受体-配体相互作用的无量纲解离常数，$L_{\\mathrm{tot}} \\ge 0$为无量纲可用总配体量，$L_{\\mathrm{free}} \\ge 0$为平衡时的无量纲游离配体量。\n- 令$c_i \\ge 0$为平衡时克隆$i$的配体-受体复合物的无量纲浓度（或计数）。配体守恒要求$L_{\\mathrm{free}} + \\sum_{i=1}^{n} c_i = L_{\\mathrm{tot}}$。\n- 克隆$i$的下游信号是$c_i$的一个饱和函数：$S_i = s_{\\max} \\cdot \\dfrac{c_i}{s_{1/2} + c_i}$，其中$s_{\\max}  0$和$s_{1/2}  0$是无量纲常数。用于选择的克隆适应度为$F_i = S_i^{\\gamma}$，其中$\\gamma \\ge 1$是一个无量纲非线性参数。\n\n基于这些原则，推导出一个计算方法，该方法能够：\n1) 对于给定的参数集，根据质量作用定律和配体守恒，计算出唯一的平衡$L_{\\mathrm{free}}$和$c_i$。\n2) 计算$S_i$、$F_i$以及归一化克隆扩增权重$p_i = \\dfrac{F_i}{\\sum_{j=1}^{n} F_j}$。\n3) 确定优势克隆索引$d$，定义为获得最大$F_i$的最小索引$i$（在输出规范中采用从零开始的索引）。\n4) 使用Gini系数计算分配$p = (p_1,\\dots,p_n)$的不平等性，Gini系数定义为\n$$\nG = \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{n} \\lvert p_i - p_j \\rvert}{2 n \\sum_{i=1}^{n} p_i}.\n$$\n\n您必须使用或建立的算法约束和保证：\n- 从质量作用定律和质量守恒出发，而不是从任何捷径或预先推导的分配公式出发。您的实现必须依赖于求解由您推导的平衡条件所蕴含的关于$L_{\\mathrm{free}}$的单调方程。\n- 证明$L_{\\mathrm{free}}$的平衡方程在有界区间内有唯一解，并选择与此证明一致的稳健求根方法。\n- 所有变量$r_i$、$k_i$、$L_{\\mathrm{tot}}$、$s_{\\max}$、$s_{1/2}$和$\\gamma$都是无量纲的，因此不需要物理单位。所有比率必须以小数形式输出（而不是百分比）。\n\n测试套件：\n所有测试用例均使用$s_{\\max} = 1.0$、$s_{1/2} = 0.3$和$\\gamma = 2.0$。对于每个用例，按如下方式指定$n$、$r$、$k$和$L_{\\mathrm{tot}}$：\n- 用例1：$n=2$，$r = [1.0,\\,1.0]$，$k = [0.5,\\,0.5]$，$L_{\\mathrm{tot}} = 0.5$。\n- 用例2：$n=3$，$r = [1.0,\\,1.0,\\,1.0]$，$k = [0.1,\\,1.0,\\,10.0]$，$L_{\\mathrm{tot}} = 0.3$。\n- 用例3：$n=2$，$r = [0.1,\\,5.0]$，$k = [0.5,\\,0.5]$，$L_{\\mathrm{tot}} = 2.0$。\n- 用例4：$n=4$，$r = [2.0,\\,1.0,\\,0.0,\\,3.0]$，$k = [1.0,\\,1.0,\\,1.0,\\,1.0]$，$L_{\\mathrm{tot}} = 10.0$。\n- 用例5：$n=3$，$r = [1.0,\\,0.2,\\,3.0]$，$k = [0.2,\\,2.0,\\,0.2]$，$L_{\\mathrm{tot}} = 1.0$。\n\n输出规范：\n- 对于每个用例，输出一个列表，其中包含：使用从零开始索引的优势克隆索引$d$，四舍五入到6位小数的Gini系数$G$，以及$n$个$p_i$值，每个值都四舍五入到6位小数。\n- 将所有用例的结果聚合成单行，作为一个由这些单个用例列表组成的列表，并以方括号括起来的逗号分隔列表的形式精确打印在单行上。\n- 最终行格式示例（使用占位数字）：\n$[ [d_1, G_1, p_{1,1}, \\dots, p_{1,n_1}], [d_2, G_2, p_{2,1}, \\dots, p_{2,n_2}], \\dots ]$。\n\n您的程序必须根据上述第一性原理计算这些值，并生成所需的单行输出。不提供外部输入；所有参数都嵌入在程序中。", "solution": "该问题陈述经过了严格验证，被认为是有效的。它在科学上基于物理化学和免疫学的既定原理，特别是受体-配体结合的质量作用定律。该问题是良构的，为确定性的可计算唯一解提供了所有必要的参数和约束。其语言客观且数学上精确。因此，我们将从第一性原理开始推导求解过程。\n\n问题的核心是确定一个系统的平衡状态，在该系统中，$n$个不同的Tfh细胞克隆竞争一个有限的单一配体（ICOSL）池。对于每个克隆$i \\in \\{1, \\dots, n\\}$，其相互作用由其总受体容量$r_i$和其受体-配体解离常数$k_i$决定。配体的总量固定为$L_{\\text{tot}}$。\n\n我们从克隆$i$的结合反应的质量作用定律开始。解离常数$k_i$由平衡时各物质浓度的比值给出：\n$$ k_i = \\frac{[R_i]_{\\text{free}} [L]_{\\text{free}}}{[C_i]} $$\n在问题的符号体系中，$[R_i]_{\\text{free}}$是克隆$i$上游离受体的浓度，即$r_i - c_i$，其中$c_i$是配体-受体复合物的浓度。$[L]_{\\text{free}}$是游离配体的浓度，表示为$L_{\\text{free}}$。$[C_i]$是$c_i$。代入这些量得到：\n$$ k_i = \\frac{(r_i - c_i) L_{\\text{free}}}{c_i} $$\n这个方程可以重新整理，以将平衡复合物浓度$c_i$表示为游离配体浓度$L_{\\text{free}}$的函数：\n$k_i c_i = (r_i - c_i) L_{\\text{free}} \\implies k_i c_i = r_i L_{\\text{free}} - c_i L_{\\text{free}} \\implies c_i(k_i + L_{\\text{free}}) = r_i L_{\\text{free}}$。\n这为每个克隆得出了结合等温线：\n$$ c_i(L_{\\text{free}}) = \\frac{r_i L_{\\text{free}}}{k_i + L_{\\text{free}}} $$\n此表达式表明，一个克隆结合的配体量取决于游离配体的浓度、其受体容量和其结合亲和力（与$k_i$成反比）。\n\n第二个基本原理是配体的质量守恒。总配体浓度$L_{\\text{tot}}$必须等于游离配体与所有被不同克隆结合的配体之和：\n$$ L_{\\text{tot}} = L_{\\text{free}} + \\sum_{i=1}^{n} c_i $$\n通过将$c_i(L_{\\text{free}})$的表达式代入这个守恒定律，我们得到一个只有一个未知数$L_{\\text{free}}$的单一方程：\n$$ L_{\\text{tot}} = L_{\\text{free}} + \\sum_{i=1}^{n} \\frac{r_i L_{\\text{free}}}{k_i + L_{\\text{free}}} $$\n为了找到平衡状态，我们必须求解$L_{\\text{free}}$。这是一个求解函数$f(x) = 0$根的问题，其中$x = L_{\\text{free}}$：\n$$ f(x) = x + \\sum_{i=1}^{n} \\frac{r_i x}{k_i + x} - L_{\\text{tot}} = 0 $$\n根据要求，我们必须证明$L_{\\text{free}}$存在一个唯一的、具有物理意义的解。$L_{\\text{free}}$的物理定义域是$[0, L_{\\text{tot}}]$。\n我们来分析$f(x)$在这个区间上的性质。\n首先，我们计算函数在区间边界处的值：\n当$x=0$时，我们有$f(0) = 0 + \\sum_{i=1}^{n} \\frac{r_i \\cdot 0}{k_i + 0} - L_{\\text{tot}} = -L_{\\text{tot}}$。鉴于$L_{\\text{tot}} \\ge 0$，我们有$f(0) \\le 0$。\n当$x=L_{\\text{tot}}$时，我们有$f(L_{\\text{tot}}) = L_{\\text{tot}} + \\sum_{i=1}^{n} \\frac{r_i L_{\\text{tot}}}{k_i + L_{\\text{tot}}} - L_{\\text{tot}} = \\sum_{i=1}^{n} \\frac{r_i L_{\\text{tot}}}{k_i + L_{\\text{tot}}}$。由于$r_i \\ge 0$，$k_i  0$且$L_{\\text{tot}} \\ge 0$，这个和是非负的，所以$f(L_{\\text{tot}}) \\ge 0$。\n由于$f(x)$在$[0, L_{\\text{tot}}]$上是连续的，根据介值定理，可以保证在该区间内至少存在一个根。\n\n为了证明唯一性，我们考察$f(x)$对$x$的导数：\n$$ f'(x) = \\frac{d}{dx} \\left( x + \\sum_{i=1}^{n} \\frac{r_i x}{k_i + x} - L_{\\text{tot}} \\right) = 1 + \\sum_{i=1}^{n} \\frac{d}{dx} \\left( \\frac{r_i x}{k_i + x} \\right) $$\n对求和项使用商法则，我们发现：\n$$ \\frac{d}{dx} \\left( \\frac{r_i x}{k_i + x} \\right) = \\frac{r_i(k_i+x) - r_i x(1)}{(k_i+x)^2} = \\frac{r_i k_i}{(k_i+x)^2} $$\n因此，完整的导数是：\n$$ f'(x) = 1 + \\sum_{i=1}^{n} \\frac{r_i k_i}{(k_i+x)^2} $$\n由于$r_i \\ge 0$和$k_i  0$，求和中的每一项都是非负的。因此，对于所有$x \\ge 0$，$f'(x) \\ge 1$。一个严格单调递增的函数最多只能有一个根。这证明了在区间$[0, L_{\\text{tot}}]$内存在唯一的$L_{\\text{free}}$的根。这一严谨的发现使我们能够采用像Brent方法这样的数值方法来稳健地找到这个唯一解。\n\n计算步骤如下：\n1.  对于每个测试用例，根据提供的参数$n$、$r$、$k$和$L_{\\text{tot}}$定义函数$f(L_{\\text{free}})$。\n2.  在区间$[0, L_{\\text{tot}}]$内数值求解$f(L_{\\text{free}}) = 0$，以得到$L_{\\text{free}}$。一个平凡的情况是$L_{\\text{tot}}=0$，这直接得出$L_{\\text{free}}=0$。\n3.  使用确定的$L_{\\text{free}}$计算所有克隆的复合物浓度向量$c_i$。\n4.  使用给定的常数$s_{\\max}=1.0$和$s_{1/2}=0.3$，计算信号输出$S_i = s_{\\max} \\cdot \\frac{c_i}{s_{1/2} + c_i}$。\n5.  使用非线性参数$\\gamma=2.0$，计算适应度值$F_i = S_i^{\\gamma}$。\n6.  优势克隆索引$d$被确定为对应于适应度向量$F$中最大值的最小从零开始的索引$i$。\n7.  归一化克隆扩增权重计算为$p_i = \\frac{F_i}{\\sum_{j=1}^{n} F_j}$。在$\\sum F_j = 0$的情况下（例如，如果所有$r_i = 0$），我们取所有克隆的$p_i = 1/n$，反映了选择压力的缺失。\n8.  计算Gini系数$G$来量化权重分布$p = (p_1, \\dots, p_n)$的不平等性：\n    $$ G = \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{n} |p_i - p_j|}{2n \\sum_{k=1}^{n} p_k} = \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{n} |p_i - p_j|}{2n} $$\n9.  收集每个用例的结果（$d$、$G$和所有$p_i$），并根据输出规范进行格式化。\n此过程提供了一个从问题中指定的基本原理推导出的完整解决方案。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes clonal competition dynamics based on a receptor-ligand equilibrium model.\n    \"\"\"\n    # Global parameters for all test cases as specified in the problem\n    s_max = 1.0\n    s_half = 0.3\n    gamma = 2.0\n\n    # Test suite defined in the problem statement\n    test_cases = [\n        {'n': 2, 'r': np.array([1.0, 1.0]), 'k': np.array([0.5, 0.5]), 'L_tot': 0.5},\n        {'n': 3, 'r': np.array([1.0, 1.0, 1.0]), 'k': np.array([0.1, 1.0, 10.0]), 'L_tot': 0.3},\n        {'n': 2, 'r': np.array([0.1, 5.0]), 'k': np.array([0.5, 0.5]), 'L_tot': 2.0},\n        {'n': 4, 'r': np.array([2.0, 1.0, 0.0, 3.0]), 'k': np.array([1.0, 1.0, 1.0, 1.0]), 'L_tot': 10.0},\n        {'n': 3, 'r': np.array([1.0, 0.2, 3.0]), 'k': np.array([0.2, 2.0, 0.2]), 'L_tot': 1.0},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n, r, k, L_tot = case['n'], case['r'], case['k'], case['L_tot']\n\n        # Define the root-finding function based on ligand conservation\n        def f_equilibrium(L_free, r_vals, k_vals, L_total):\n            # Sum of bound ligand across all clones\n            # A check for k_vals + L_free being zero is not required as k>0, L_free>=0\n            bound_ligand = np.sum(r_vals * L_free / (k_vals + L_free))\n            return L_free + bound_ligand - L_total\n\n        # Step 1: Solve for the unique equilibrium free ligand concentration, L_free\n        if L_tot == 0:\n            L_free = 0.0\n        else:\n            # The root is guaranteed to be in [0, L_tot]\n            L_free = brentq(f_equilibrium, 0.0, L_tot, args=(r, k, L_tot))\n\n        # Step 2: Calculate complex concentration c_i for each clone\n        # This calculation is safe as k_i > 0 and L_free >= 0, so denominator > 0\n        c = r * L_free / (k + L_free)\n        c = np.nan_to_num(c) # Robustness for any unexpected floating point issues\n\n        # Step 3: Calculate signaling output S_i for each clone\n        # The denominator s_half + c is > 0 since s_half > 0 and c >= 0\n        S = s_max * c / (s_half + c)\n        S = np.nan_to_num(S)\n\n        # Step 4: Calculate clonal fitness F_i\n        F = S ** gamma\n\n        # Step 5: Identify dominant clone index d (smallest index for max F)\n        d = int(np.argmax(F))\n\n        # Step 6: Calculate normalized expansion weights p_i\n        F_sum = np.sum(F)\n        if F_sum > 0:\n            p = F / F_sum\n        else:\n            # Undefined selection, assume uniform distribution\n            p = np.full(n, 1.0 / n)\n            \n        # Step 7: Calculate Gini coefficient G\n        # Using the formula G = sum(|p_i - p_j|) / (2 * n * sum(p_i))\n        p_col_vector = p.reshape(-1, 1)\n        abs_diff_matrix = np.abs(p_col_vector - p)\n        gini_numerator = np.sum(abs_diff_matrix)\n        \n        # sum(p) is 1.0 in theory, but using np.sum(p) is more robust to float errors\n        gini_denominator = 2 * n * np.sum(p)\n        \n        if gini_denominator > 0:\n            G = gini_numerator / gini_denominator\n        else:\n            G = 0.0 # No inequality if all weights are zero\n\n        # Step 8: Format results for the current case as specified\n        G_rounded = round(G, 6)\n        p_rounded = [round(val, 6) for val in p]\n        \n        case_result = [d, G_rounded] + p_rounded\n        all_results.append(case_result)\n\n    # Print the aggregated results in the specified single-line format.\n    # The template's print format is used, which renders without extra spaces.\n    print(f\"[[{all_results[0][0]}, {all_results[0][1]}, {all_results[0][2]}, {all_results[0][3]}], [{all_results[1][0]}, {all_results[1][1]}, {all_results[1][2]}, {all_results[1][3]}, {all_results[1][4]}], [{all_results[2][0]}, {all_results[2][1]}, {all_results[2][2]}, {all_results[2][3]}], [{all_results[3][0]}, {all_results[3][1]}, {all_results[3][2]}, {all_results[3][3]}, {all_results[3][4]}, {all_results[3][5]}], [{all_results[4][0]}, {all_results[4][1]}, {all_results[4][2]}, {all_results[4][3]}, {all_results[4][4]}]]\")\n\nsolve()\n```", "id": "2841892"}]}