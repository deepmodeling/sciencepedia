{"hands_on_practices": [{"introduction": "免疫识别始于配体与受体在分子水平上的结合。然而，细胞环境非常复杂，多种分子可能竞争同一个受体。本练习探讨了竞争性结合的定量原理，展示了竞争性配体（DAMP）的存在如何提高主要配体（PAMP）达到信号激活阈值所需的浓度。掌握这一概念对于理解免疫细胞如何解读组织中的复杂信号至关重要。", "problem": "巨噬细胞上的一个单价模式识别受体 (PRR) 在同一结合位点识别两种相互排斥的配体：一种是病原体相关分子模式 (PAMP) 配体，其浓度表示为 $[P]$；另一种是损伤相关分子模式 (DAMP) 配体，其浓度表示为 $[D]$。该系统处于热力学平衡状态，配体相对于受体而言摩尔量过量，因此游离配体的浓度等于其总浓度，并且结合事件是独立的，没有协同性。PAMP的平衡解离常数为 $K_{d,P} = 10\\,\\text{nM}$，DAMP的平衡解离常数为 $K_{d,D} = 200\\,\\text{nM}$。在一个炎症组织微环境中，DAMP以 $[D] = 100\\,\\text{nM}$ 的游离浓度存在。\n\n只有当PRR被PAMP（而不仅仅是任何配体）占据的分数占有率达到至少一个阈值 $\\tau = 0.60$ 时，下游的活化B细胞核因子κ-轻链增强子 (NF-\\kappa B) 信号模块才会被触发。请仅使用平衡解离常数和平衡状态下质量作用定律的基本定义，并从基本原理出发，确定在存在竞争性DAMP的情况下，为达到该占有率阈值所需的PAMP的最小游离浓度 $[P]_{\\min}$。\n\n将您的最终结果四舍五入至三位有效数字，并以 $\\text{nM}$ 为单位表示。在计算出最小浓度后，简要解释竞争性DAMP对信号阈值的影响，即 $[P]_{\\min}$ 如何随 $[D]$、$K_{d,D}$ 和阈值 $\\tau$ 变化。", "solution": "我们从质量作用定律和平衡解离常数的定义开始。令 $[R]$ 表示游离受体浓度，$[RP]$ 表示PAMP结合受体浓度，$[RD]$ 表示DAMP结合受体浓度。对于在单个位点上发生的单价、相互排斥的结合，解离常数定义为\n$$\nK_{d,P} = \\frac{[R][P]}{[RP]}, \\qquad K_{d,D} = \\frac{[R][D]}{[RD]}.\n$$\n重新整理得到结合与游离之比\n$$\n\\frac{[RP]}{[R]} = \\frac{[P]}{K_{d,P}}, \\qquad \\frac{[RD]}{[R]} = \\frac{[D]}{K_{d,D}}.\n$$\n总受体浓度是三种状态之和：\n$$\n[R]_{\\text{tot}} = [R] + [RP] + [RD] = [R]\\!\\left(1 + \\frac{[P]}{K_{d,P}} + \\frac{[D]}{K_{d,D}}\\right).\n$$\nPAMP的分数占有率是处于 $[RP]$ 状态的受体所占的比例：\n$$\nf_{P} \\equiv \\frac{[RP]}{[R]_{\\text{tot}}} = \\frac{\\dfrac{[P]}{K_{d,P}}}{1 + \\dfrac{[P]}{K_{d,P}} + \\dfrac{[D]}{K_{d,D}}}.\n$$\n令 $\\tau$ 为触发信号所需的阈值占有率。我们寻求最小的 $[P]$ 使得 $f_{P} \\ge \\tau$。由于 $f_P$ 对 $[P]$ 的单调性，我们可以通过求解等式 $f_{P} = \\tau$ 来找到最小浓度。设 $x \\equiv [P]$ 并定义 $\\beta \\equiv \\dfrac{[D]}{K_{d,D}}$。那么\n$$\n\\tau = \\frac{\\dfrac{x}{K_{d,P}}}{1 + \\dfrac{x}{K_{d,P}} + \\beta}.\n$$\n为求解 $x$ 整理方程：\n$$\n\\tau\\!\\left(1 + \\frac{x}{K_{d,P}} + \\beta\\right) = \\frac{x}{K_{d,P}} \\quad \\Longrightarrow \\quad \\tau + \\tau\\beta + \\tau\\frac{x}{K_{d,P}} = \\frac{x}{K_{d,P}}.\n$$\n重新整理含 $x$ 的项：\n$$\n\\left(1 - \\tau\\right)\\frac{x}{K_{d,P}} = \\tau\\left(1 + \\beta\\right),\n$$\n因此，达到阈值所需的最小浓度为\n$$\nx_{\\min} = [P]_{\\min} = \\frac{\\tau}{1 - \\tau}\\,K_{d,P}\\left(1 + \\beta\\right) = \\frac{\\tau}{1 - \\tau}\\,K_{d,P}\\left(1 + \\frac{[D]}{K_{d,D}}\\right).\n$$\n现在代入给定的参数值 $K_{d,P} = 10\\,\\text{nM}$，$K_{d,D} = 200\\,\\text{nM}$，$[D] = 100\\,\\text{nM}$ 和 $\\tau = 0.60$：\n$$\n\\beta = \\frac{[D]}{K_{d,D}} = \\frac{100\\,\\text{nM}}{200\\,\\text{nM}} = 0.5, \\qquad \\frac{\\tau}{1-\\tau} = \\frac{0.60}{0.40} = 1.5,\n$$\n$$\n[P]_{\\min} = \\left(1.5\\right)\\left(10\\,\\text{nM}\\right)\\left(1 + 0.5\\right) = 1.5 \\times 10\\,\\text{nM} \\times 1.5 = 22.5\\,\\text{nM}.\n$$\n四舍五入到三位有效数字并以 $\\text{nM}$ 为单位表示，最小PAMP浓度为 $22.5\\,\\text{nM}$。\n\n对下游信号阈值的影响：表达式\n$$\n[P]_{\\min} = \\frac{\\tau}{1 - \\tau}\\,K_{d,P}\\left(1 + \\frac{[D]}{K_{d,D}}\\right)\n$$\n表明竞争性DAMP的存在将所需的PAMP浓度提高了乘法因子 $\\left(1 + \\dfrac{[D]}{K_{d,D}}\\right)$。相对于无竞争情况下的 $[P]_{\\min}^{(0)} = \\dfrac{\\tau}{1-\\tau}K_{d,P}$，DAMP将阈值提高到 $[P]_{\\min} = [P]_{\\min}^{(0)}\\left(1 + \\dfrac{[D]}{K_{d,D}}\\right)$。因此，触发NF-\\kappa B所需的PAMP浓度会因 $[D]$ 的升高而增加，因DAMP亲和力减弱（即 $K_{d,D}$ 增大，导致 $\\dfrac{[D]}{K_{d,D}}$ 减小）而降低。同时，更高的 $\\tau$ 值会通过因子 $\\dfrac{\\tau}{1-\\tau}$ 导致该所需浓度呈超线性增长。", "answer": "$$\\boxed{22.5}$$", "id": "2879814"}, {"introduction": "理解信号通路的组成部分是第一步，而预测其动态行为则是更高层次的要求。本练习将指导您使用常微分方程（ODEs）来构建STING信号通路的动力学模型。通过将生物过程转化为数学语言，您将模拟系统如何响应刺激并达到稳态，从而对细胞因子的产量做出定量预测。", "problem": "您需要构建一个机理常微分方程 (ODE) 模型，该模型能够捕捉在胞质核酸作为病原体相关分子模式 (PAMPs) 或损伤相关分子模式 (DAMPs) 响应下，干扰素基因刺激因子 (STING) 下游的干扰素调节因子 3 (IRF3) 的磷酸化动力学。目标是预测干扰素 Beta (IFN-β) 蛋白的稳态浓度。该模型必须基于受体-配体结合动力学、酶催化和中心法则（DNA到RNA到蛋白质）的第一性原理推导，不使用任何简化公式。\n\n您的推导应基于以下经过充分检验的事实和核心定义：\n- 用于配体和受体之间可逆结合的质量作用定律。\n- 用于酶催化共价修饰的 Michaelis–Menten 动力学。\n- 用于分子降解过程的一级衰变。\n- 分子生物学的中心法则（转录和翻译）。\n\n需映射到数学模型中的生物学背景：\n- 胞质 DNA（一种 PAMP 或 DAMP）导致环 GMP-AMP 合成酶 (cGAS) 激活并生成环 GMP-AMP，从而激活 STING。为便于建模，将上游的胞质 DNA 信号视为一个恒定的有效配体浓度，用于 STING 激活，记作 $L$（单位 nM）。\n- 激活的 STING 招募并激活 Tank-binding kinase 1 (TBK1)，后者磷酸化 IRF3。磷酸化的 IRF3 驱动干扰素β基因 (IFNB1) 的转录。\n- 干扰素 Beta (IFN-β) 是通过翻译 IFNB1 信使 RNA (mRNA) 产生的，并随时间降解。\n\n定义以下状态变量，均为浓度（单位 nM），并且是时间 $t$（单位小时）的函数：\n- $x_1(t) = \\text{STING}^\\ast$，活性 STING 的浓度。\n- $x_2(t) = \\text{TBK1}^\\ast$，活性 TBK1 的浓度。\n- $x_3(t) = \\text{IRF3-P}$，磷酸化 IRF3 的浓度。\n- $x_4(t) = \\text{IFNB1 mRNA}$，IFNB1 mRNA 的浓度。\n- $x_5(t) = \\text{IFN-}\\beta$，IFN-β 蛋白的浓度。\n\n使用以下守恒总量：\n- $S_{\\text{tot}}$ (总 STING)，$T_{\\text{tot}}$ (总 TBK1)，和 $I_{\\text{tot}}$ (总 IRF3)，单位均为 nM，且 $S_{\\text{tot}}, T_{\\text{tot}}, I_{\\text{tot}}$ 不随时间变化。\n- 游离组分为 $S_{\\text{free}} = S_{\\text{tot}} - x_1$, $T_{\\text{free}} = T_{\\text{tot}} - x_2$, 和 $\\text{IRF3}_{\\text{u}} = I_{\\text{tot}} - x_3$。\n\n为推导您的 ODE，施加以下动力学假设：\n- STING 激活被建模为恒定配体 $L$ 与游离 STING 之间的可逆结合，遵循质量作用定律：$S_{\\text{free}} + L \\rightleftharpoons \\text{STING}^\\ast$，正向速率常数为 $k_{1,\\text{on}}$ (单位 nM$^{-1}$ h$^{-1}$)，逆向速率常数为 $k_{1,\\text{off}}$ (单位 h$^{-1}$)。\n- TBK1 激活被建模为活性 STING 的可逆结合或招募，遵循质量作用定律：$T_{\\text{free}} + \\text{STING}^\\ast \\rightleftharpoons \\text{TBK1}^\\ast$，正向速率常数为 $k_{2,\\text{on}}$ (单位 nM$^{-1}$ h$^{-1}$)，逆向速率常数为 $k_{2,\\text{off}}$ (单位 h$^{-1}$)。\n- IRF3 磷酸化由活性 TBK1 催化，遵循 Michaelis–Menten 动力学，作用于未磷酸化的 IRF3，周转率为 $k_{3,\\text{cat}}$ (单位 h$^{-1}$)，米氏常数为 $K_m$ (单位 nM)，而去磷酸化为一级反应，速率为 $k_{3,\\text{deph}}$ (单位 h$^{-1}$)。\n- IFNB1 mRNA 的产生有一个基础转录速率 $k_{\\text{tx,basal}}$ (单位 nM h$^{-1}$)，外加一个激活项，该激活项是 $x_3$ 的 Hill 函数，最大速率为 $k_{\\text{tx,act}}$ (单位 nM h$^{-1}$)，激活常数为 $K_{\\text{act}}$ (单位 nM)，Hill 系数为 $n$ (无量纲)。mRNA 以一级速率 $\\gamma_m$ (单位 h$^{-1}$) 降解。\n- IFN-β 蛋白由 mRNA 以速率 $k_{\\text{tl}}$ (单位 h$^{-1}$) 翻译而来，并以一级速率 $\\gamma_p$ (单位 h$^{-1}$) 降解。\n\n$t = 0$ 时的初始条件为：\n- $x_1(0) = 0$ nM, $x_2(0) = 0$ nM, $x_3(0) = 0$ nM, $x_4(0) = 0$ nM, $x_5(0) = 0$ nM.\n\n默认参数值（除非在特定测试用例中被覆盖），浓度单位为 nM，时间单位为小时：\n- $S_{\\text{tot}} = 100$, $T_{\\text{tot}} = 50$, $I_{\\text{tot}} = 100$。\n- $k_{1,\\text{on}} = 1.0$, $k_{1,\\text{off}} = 0.1$。\n- $k_{2,\\text{on}} = 1.0$, $k_{2,\\text{off}} = 0.2$。\n- $k_{3,\\text{cat}} = 5.0$, $K_m = 10$, $k_{3,\\text{deph}} = 0.5$。\n- $k_{\\text{tx,basal}} = 0.01$, $k_{\\text{tx,act}} = 1.0$, $K_{\\text{act}} = 20$, $n = 2$。\n- $\\gamma_m = 0.5$, $k_{\\text{tl}} = 2.0$, $\\gamma_p = 0.1$。\n\n数学要求：\n- 推导并实现由上述原理和定义所蕴含的 ODE 系统。\n- 将 Hill 激活函数定义为 $H(x_3) = \\dfrac{x_3^n}{K_{\\text{act}}^n + x_3^n}$。\n- 模拟该系统直至达到稳态，您必须将稳态操作性地定义为：在至少经过 $1$ 小时后，$\\max_i |\\mathrm{d}x_i/\\mathrm{d}t|  10^{-6}$ nM h$^{-1}$。如果未满足此标准，则积分至最长 $T_{\\max} = 200$ 小时，并使用最终值作为稳态的近似。\n\n单位与报告：\n- 所有浓度必须以 nM 为单位，时间以小时为单位，速率使用上述指定的单位。您的输出必须是每个测试用例的稳态 IFN-β 蛋白浓度 $x_5$（单位 nM），四舍五入到三位小数。\n\n测试套件：\n对于以下每个测试用例，运行模拟并报告稳态 $x_5$ 值。\n- 测试 1 (正常路径): $L = 50$。\n- 测试 2 (边界：无刺激): $L = 0$。\n- 测试 3 (饱和刺激): $L = 500$。\n- 测试 4 (强磷酸酶，信号减弱): $L = 100$，覆盖 $k_{3,\\text{deph}} = 5.0$。\n- 测试 5 (STING 缺陷): $L = 100$，覆盖 $S_{\\text{tot}} = 0$。\n\n最终输出格式：\n- 您的程序应产生单行输出，包含一个用方括号括起的逗号分隔列表（例如，\"[r1,r2,r3,r4,r5]\"），其中每个 $r_j$ 是测试 $j$ 的稳态 IFN-β 浓度（单位 nM），四舍五入到三位小数并表示为十进制数（打印的列表中不含单位）。", "solution": "问题陈述已经过严格验证，并被确定为科学上合理、内部一致且数学上适定。因此，我们可以着手进行模型推导。\n\n目标是构建一个常微分方程（ODE）系统，描述 STING 信号通路的动力学，最终导致 Interferon-Beta (IFN-β) 的产生。推导将基于质量作用动力学、酶动力学和中心法则的原理，如前所述。状态变量是活性 STING ($x_1$)、活性 TBK1 ($x_2$)、磷酸化 IRF3 ($x_3$)、IFNB1 mRNA ($x_4$) 和 IFN-β 蛋白 ($x_5$) 的浓度。\n\n我们通过将其所有生成反应的速率相加，再减去其所有消耗反应的速率，来推导每个状态变量的速率方程 $\\frac{dx_i}{dt}$。\n\n1.  **活性 STING, $x_1(t) = \\text{STING}^\\ast$ 的速率方程**:\n    STING 的激活被建模为游离 STING, $S_{\\text{free}}$, 和一个恒定配体刺激, $L$, 之间的可逆结合反应：\n    $$S_{\\text{free}} + L \\underset{k_{1,\\text{off}}}{\\stackrel{k_{1,\\text{on}}}{\\rightleftharpoons}} \\text{STING}^\\ast$$\n    应用质量作用定律， $x_1$ 的生成速率为 $k_{1,\\text{on}} [S_{\\text{free}}] [L]$。消耗（失活）速率为 $k_{1,\\text{off}} [STING^\\ast]$。使用守恒定律 $S_{\\text{free}} = S_{\\text{tot}} - x_1$, $x_1$ 的净变化率为：\n    $$\\frac{dx_1}{dt} = k_{1,\\text{on}}(S_{\\text{tot}} - x_1)L - k_{1,\\text{off}}x_1$$\n\n2.  **活性 TBK1, $x_2(t) = \\text{TBK1}^\\ast$ 的速率方程**:\n    TBK1 的激活被描述为遵循 $T_{\\text{free}} + \\text{STING}^\\ast \\rightleftharpoons \\text{TBK1}^\\ast$。考虑到守恒定律 $T_{\\text{free}} = T_{\\text{tot}} - x_2$ 以及 STING 是一个招募激酶的支架（起催化作用）这一事实，最一致的解释是活性 STING ($x_1$) 催化游离 TBK1 ($T_{\\text{free}}$) 转化为其活性形式 ($x_2$)。正向速率与底物 $T_{\\text{free}}$ 和催化剂 $x_1$ 的浓度均成正比。逆向反应是 $x_2$ 的失活。\n    $x_2$ 的生成速率为 $k_{2,\\text{on}} [T_{\\text{free}}] [STING^\\ast] = k_{2,\\text{on}}(T_{\\text{tot}} - x_2)x_1$。\n    $x_2$ 的消耗（失活）速率为 $k_{2,\\text{off}} [TBK1^\\ast] = k_{2,\\text{off}}x_2$。\n    $x_2$ 的净变化率为：\n    $$\\frac{dx_2}{dt} = k_{2,\\text{on}}(T_{\\text{tot}} - x_2)x_1 - k_{2,\\text{off}}x_2$$\n\n3.  **磷酸化 IRF3, $x_3(t) = \\text{IRF3-P}$ 的速率方程**:\n    活性 TBK1 ($x_2$) 作为一种酶，磷酸化未磷酸化的 IRF3, $\\text{IRF3}_{\\text{u}} = I_{\\text{tot}} - x_3$。这个催化过程由 Michaelis-Menten 动力学描述。最大速度 $V_{\\text{max}}$ 与酶浓度成正比，即 $V_{\\text{max}} = k_{3,\\text{cat}}[TBK1^\\ast] = k_{3,\\text{cat}}x_2$。\n    $x_3$ 的生成速率（磷酸化）为 $k_{3,\\text{cat}}x_2 \\frac{[\\text{IRF3}_{\\text{u}}]}{K_m + [\\text{IRF3}_{\\text{u}}]} = k_{3,\\text{cat}}x_2 \\frac{I_{\\text{tot}} - x_3}{K_m + (I_{\\text{tot}} - x_3)}$。\n    $x_3$ 的去磷酸化是一个一级过程，速率常数为 $k_{3,\\text{deph}}$。消耗速率为 $k_{3,\\text{deph}}x_3$。\n    $x_3$ 的净变化率为：\n    $$\\frac{dx_3}{dt} = k_{3,\\text{cat}}x_2 \\frac{I_{\\text{tot}} - x_3}{K_m + I_{\\text{tot}} - x_3} - k_{3,\\text{deph}}x_3$$\n\n4.  **IFNB1 mRNA, $x_4(t)$ 的速率方程**:\n    IFNB1 基因的转录有两个组成部分：一个基础速率和一个依赖于磷酸化 IRF3 ($x_3$) 的激活速率。激活部分由一个 Hill 函数描述。\n    $x_4$ 的生成速率为 $k_{\\text{tx,basal}} + k_{\\text{tx,act}} H(x_3)$，其中 $H(x_3) = \\frac{x_3^n}{K_{\\text{act}}^n + x_3^n}$。\n    mRNA 的降解是一个一级过程，速率常数为 $\\gamma_m$。消耗速率为 $\\gamma_m x_4$。\n    $x_4$ 的净变化率为：\n    $$\\frac{dx_4}{dt} = k_{\\text{tx,basal}} + k_{\\text{tx,act}}\\frac{x_3^n}{K_{\\text{act}}^n + x_3^n} - \\gamma_m x_4$$\n\n5.  **IFN-β 蛋白, $x_5(t)$ 的速率方程**:\n    IFN-β 蛋白是通过其 mRNA ($x_4$) 的翻译合成的，并会发生降解。\n    生成（翻译）速率与 mRNA 浓度成正比，速率常数为 $k_{\\text{tl}}$：$k_{\\text{tl}}x_4$。\n    蛋白质的降解是一个一级过程，速率常数为 $\\gamma_p$。消耗速率为 $\\gamma_p x_5$。\n    $x_5$ 的净变化率为：\n    $$\\frac{dx_5}{dt} = k_{\\text{tl}}x_4 - \\gamma_p x_5$$\n\n至此，五个耦合的非线性 ODE 的推导完成。该系统从初始条件 $x_i(0) = 0$（其中 $i \\in \\{1, 2, 3, 4, 5\\}$）开始进行数值求解。我们对系统进行积分，直到达到稳态（定义为当 $t > 1$ 小时，$\\max_i |\\frac{dx_i}{dt}|  10^{-6}$），或直到最大时间 $T_{\\max}=200$ 小时。报告 $x_5$ 的最终值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n\n    # --- Default Parameter Definition ---\n    default_params = {\n        # Total concentrations (nM)\n        \"S_tot\": 100.0, \"T_tot\": 50.0, \"I_tot\": 100.0,\n        # STING activation (k1_on: nM^-1 h^-1, k1_off: h^-1)\n        \"k1_on\": 1.0, \"k1_off\": 0.1,\n        # TBK1 activation (k2_on: nM^-1 h^-1, k2_off: h^-1)\n        \"k2_on\": 1.0, \"k2_off\": 0.2,\n        # IRF3 phosphorylation (k3_cat: h^-1, Km: nM, k3_deph: h^-1)\n        \"k3_cat\": 5.0, \"Km\": 10.0, \"k3_deph\": 0.5,\n        # mRNA transcription (k_tx_basal: nM h^-1, k_tx_act: nM h^-1, K_act: nM, n: dimensionless)\n        \"k_tx_basal\": 0.01, \"k_tx_act\": 1.0, \"K_act\": 20.0, \"n\": 2.0,\n        # mRNA and protein dynamics (gamma_m, k_tl, gamma_p: h^-1)\n        \"gamma_m\": 0.5, \"k_tl\": 2.0, \"gamma_p\": 0.1,\n    }\n\n    # --- Test Case Definitions ---\n    # Each dictionary contains the stimulus L and any parameter overrides.\n    test_cases = [\n        {\"L\": 50.0},                                    # Test 1: Happy path\n        {\"L\": 0.0},                                     # Test 2: No stimulus\n        {\"L\": 500.0},                                   # Test 3: Saturation stimulus\n        {\"L\": 100.0, \"k3_deph\": 5.0},                    # Test 4: Strong phosphatase\n        {\"L\": 100.0, \"S_tot\": 0.0},                     # Test 5: STING deficiency\n    ]\n\n    results = []\n    for case_params in test_cases:\n        params = default_params.copy()\n        params.update(case_params)\n        \n        # --- ODE System Definition ---\n        def ode_system(t, x, p):\n            x1, x2, x3, x4, x5 = x\n            \n            # STING activation\n            # dx1/dt = k1_on * (S_tot - x1) * L - k1_off * x1\n            dx1dt = p[\"k1_on\"] * (p[\"S_tot\"] - x1) * p[\"L\"] - p[\"k1_off\"] * x1\n\n            # TBK1 activation (catalyzed by STING*)\n            # dx2/dt = k2_on * (T_tot - x2) * x1 - k2_off * x2\n            dx2dt = p[\"k2_on\"] * (p[\"T_tot\"] - x2) * x1 - p[\"k2_off\"] * x2\n\n            # IRF3 phosphorylation (catalyzed by TBK1*)\n            # dx3/dt = k3_cat * x2 * (I_tot - x3) / (Km + I_tot - x3) - k3_deph * x3\n            irf3u = p[\"I_tot\"] - x3\n            # Prevent division by zero, though unlikely with given params\n            denom_mm = p[\"Km\"] + irf3u\n            phos_rate = p[\"k3_cat\"] * x2 * irf3u / denom_mm if denom_mm > 0 else 0\n            dx3dt = phos_rate - p[\"k3_deph\"] * x3\n            \n            # IFNB1 mRNA transcription (activated by IRF3-P)\n            # dx4/dt = k_tx_basal + k_tx_act * x3^n / (K_act^n + x3^n) - gamma_m * x4\n            hill_term = (x3**p[\"n\"]) / (p[\"K_act\"]**p[\"n\"] + x3**p[\"n\"])\n            dx4dt = p[\"k_tx_basal\"] + p[\"k_tx_act\"] * hill_term - p[\"gamma_m\"] * x4\n\n            # IFN-beta protein translation\n            # dx5/dt = k_tl * x4 - gamma_p * x5\n            dx5dt = p[\"k_tl\"] * x4 - p[\"gamma_p\"] * x5\n            \n            return [dx1dt, dx2dt, dx3dt, dx4dt, dx5dt]\n\n        # --- Steady-State Event Definition ---\n        def steady_state_event(t, y, p):\n            if t  1.0:\n                return 1.0  # Do not trigger before t=1 hour\n            dydt = np.array(ode_system(t, y, p))\n            max_rate = np.max(np.abs(dydt))\n            return max_rate - 1e-6\n        \n        steady_state_event.terminal = True\n        steady_state_event.direction = -1 # Event occurs when value goes from positive to negative\n\n        # --- Numerical Integration ---\n        x0 = [0.0, 0.0, 0.0, 0.0, 0.0]\n        t_max = 200.0\n        t_span = (0, t_max)\n        \n        sol = solve_ivp(\n            ode_system, \n            t_span, \n            x0, \n            method='Radau', \n            args=(params,),\n            events=steady_state_event,\n            dense_output=True\n        )\n\n        # --- Result Extraction ---\n        # If integration stopped by event, use the event time state.\n        # Otherwise, use the state at t_max.\n        if sol.status == 1 and sol.t_events[0].size > 0:\n            steady_state_x = sol.y_events[0][0]\n        else:\n            steady_state_x = sol.y[:, -1]\n        \n        # IFN-beta is the 5th variable (index 4)\n        result_x5 = steady_state_x[4]\n        results.append(result_x5)\n\n    # --- Final Output Formatting ---\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2879710"}, {"introduction": "免疫细胞必须根据来自多个传感器的信息做出关键决策，例如区分病毒感染和无菌性组织损伤。本练习介绍了一种强大的决策过程建模方法：贝叶斯推断。您将构建一个分类器，它整合来自三种不同模式识别受体的信号，以计算特定威胁（例如病毒感染）的后验概率，从而阐明免疫系统如何从充满噪声的重叠信号中实现可靠的威胁评估。", "problem": "您将设计并实现一个贝叶斯分类器，该分类器集成三个模式识别受体的输出，以估计观察到的细胞状态是由病毒感染而非无菌性损伤引起的后验概率。这三个受体是Toll样受体4 (TLR4)、维甲酸诱导基因I (RIG-I) 和环GMP-AMP合酶 (cGAS)。从免疫学角度来看，RIG-I 和 cGAS 倾向于对病毒感染期间产生的病原体相关分子模式 (PAMP) 产生强烈反应，而 TLR4 和 cGAS 则可被无菌性损伤期间释放的损伤相关分子模式 (DAMP) 激活。\n\n使用的基本原理：\n- 用于两个竞争性假设的贝叶斯定理，其中病毒感染表示为假设 $H_{\\mathrm{V}}$，无菌性损伤表示为假设 $H_{\\mathrm{S}}$。\n- 对数正态分布的定义：如果 $X \\sim \\mathrm{LogNormal}(\\mu,\\sigma^{2})$，那么对于 $x0$，有 $p(x \\mid \\mu,\\sigma) = \\dfrac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\dfrac{(\\ln x - \\mu)^{2}}{2\\sigma^{2}}\\right)$。\n- 在给定真实基础状态 $H \\in \\{H_{\\mathrm{V}}, H_{\\mathrm{S}}\\}$ 的条件下，各受体输出条件独立。\n\n基于免疫学和测量实践的建模假设：\n- 每个受体的输出是相对于静息基线的严格为正的无量纲倍数变化 $s_{i}  0$。\n- 给定一个假设 $H \\in \\{H_{\\mathrm{V}}, H_{\\mathrm{S}}\\}$，三个受体的输出条件独立，且均服从对数正态分布。假设特定受体的标准差在不同假设下是相同的，这反映了两种情况下相当的检测噪声。\n- 具体来说，对于受体 $i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}$，我们假设 $s_{i} \\mid H \\sim \\mathrm{LogNormal}(\\mu_{i,H}, \\sigma_{i}^{2})$，其参数为：\n  - TLR4: $(\\mu_{\\mathrm{TLR4},H_{\\mathrm{V}}}, \\mu_{\\mathrm{TLR4},H_{\\mathrm{S}}}, \\sigma_{\\mathrm{TLR4}}) = (\\ln(1.4), \\ln(3.0), 0.4)$。\n  - RIG-I: $(\\mu_{\\mathrm{RIGI},H_{\\mathrm{V}}}, \\mu_{\\mathrm{RIGI},H_{\\mathrm{S}}}, \\sigma_{\\mathrm{RIGI}}) = (\\ln(5.0), \\ln(1.2), 0.35)$。\n  - cGAS: $(\\mu_{\\mathrm{cGAS},H_{\\mathrm{V}}}, \\mu_{\\mathrm{cGAS},H_{\\mathrm{S}}}, \\sigma_{\\mathrm{cGAS}}) = (\\ln(3.0), \\ln(1.8), 0.5)$。\n- 病毒感染的先验概率：$\\Pr(H_{\\mathrm{V}}) = 0.35$ 且 $\\Pr(H_{\\mathrm{S}}) = 1 - 0.35 = 0.65$。\n\n任务：\n- 给定一组观察到的倍数变化三元组 $(s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$，使用贝叶斯定理和上述模型计算后验概率 $\\Pr(H_{\\mathrm{V}} \\mid s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$。将最终的后验概率表示为闭区间 $[0,1]$ 内的一个十进制数。\n\n实现的数值细节：\n- 使用条件独立性假设，将似然函数分解为各受体似然的乘积。\n- 使用指定的 $(\\mu,\\sigma)$ 参数的对数正态似然。\n- 为保证数值稳定性，如果需要，可通过对数优势比形式计算后验概率：后验对数优势比等于先验对数优势比加上各受体对数似然比之和。\n\n测试套件：\n- 使用以下五个测试用例，每个用例为一个严格为正的浮点数三元组 $(s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$：\n  - 用例 $1$：$(1.2, 6.0, 3.2)$。\n  - 用例 $2$：$(3.8, 1.1, 1.9)$。\n  - 用例 $3$：$(3.0, 4.5, 2.5)$。\n  - 用例 $4$：$(1.0, 1.0, 1.0)$。\n  - 用例 $5$：$(1.0, 10.0, 6.0)$。\n\n要求的程序输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的后验概率列表（每个测试用例一个），每个概率值都精确到小数点后六位，例如 $[0.123456,0.654321]$。", "solution": "该问题陈述是应用贝叶斯推断中的一个有效练习。它具有科学依据，问题定义明确、客观，并包含推导唯一解所需的所有信息。该模型虽然是对复杂免疫学的简化，但基于合理的假设和成熟的统计方法。我们将继续进行推导和计算。\n\n我们的目标是计算在给定一组三个受体测量值 $\\mathbf{s} = (s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$ 的情况下，发生病毒感染 $H_{\\mathrm{V}}$ 的后验概率。竞争性假设是无菌性损伤 $H_{\\mathrm{S}}$。后验概率表示为 $\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})$。\n\n根据贝叶斯定理，后验概率由以下公式给出：\n$$\n\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s}) = \\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}})}{\\Pr(\\mathbf{s})}\n$$\n分母 $\\Pr(\\mathbf{s})$ 是证据的边缘概率，通过全概率定律展开为：\n$$\n\\Pr(\\mathbf{s}) = \\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}}) + \\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}}) \\Pr(H_{\\mathrm{S}})\n$$\n将此代入主表达式，得到：\n$$\n\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s}) = \\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}})}{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}}) + \\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}}) \\Pr(H_{\\mathrm{S}})}\n$$\n直接用较小的概率值进行计算存在数值下溢的风险。一种更稳健的方法是利用对数优势比（log-odds）公式。支持 $H_{\\mathrm{V}}$ 相对于 $H_{\\mathrm{S}}$ 的后验优势比为：\n$$\n\\frac{\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})}{\\Pr(H_{\\mathrm{S}} \\mid \\mathbf{s})} = \\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}})}{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}})} \\times \\frac{\\Pr(H_{\\mathrm{V}})}{\\Pr(H_{\\mathrm{S}})}\n$$\n对该表达式取自然对数，得到后验对数优势比，我们将其表示为 $\\Lambda$：\n$$\n\\Lambda = \\ln\\left(\\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}})}{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}})}\\right) + \\ln\\left(\\frac{\\Pr(H_{\\mathrm{V}})}{\\Pr(H_{\\mathrm{S}})}\\right)\n$$\n第一项是对数似然比 (LLR)，第二项是先验对数优势比。\n\n问题陈述指出，在给定假设 $H \\in \\{H_{\\mathrm{V}}, H_{\\mathrm{S}}\\}$ 的条件下，三个受体的输出 $s_{i}$（其中 $i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}$）是条件独立的。这个关键性质使我们能够对联合似然进行分解：\n$$\n\\Pr(\\mathbf{s} \\mid H) = \\prod_{i} \\Pr(s_i \\mid H)\n$$\n因此，总对数似然比是每个受体各自的对数似然比之和：\n$$\n\\text{LLR}_{\\text{total}} = \\ln\\left(\\frac{\\prod_{i} \\Pr(s_i \\mid H_{\\mathrm{V}})}{\\prod_{i} \\Pr(s_i \\mid H_{\\mathrm{S}})}\\right) = \\sum_{i} \\ln\\left(\\frac{\\Pr(s_i \\mid H_{\\mathrm{V}})}{\\Pr(s_i \\mid H_{\\mathrm{S}})}\\right) = \\sum_{i} \\left[ \\ln(\\Pr(s_i \\mid H_{\\mathrm{V}})) - \\ln(\\Pr(s_i \\mid H_{\\mathrm{S}})) \\right]\n$$\n每个观测值 $s_i$ 由对数正态分布 $s_i \\mid H \\sim \\mathrm{LogNormal}(\\mu_{i,H}, \\sigma_i^2)$ 建模，其概率密度函数为：\n$$\n\\Pr(s_i \\mid H) = \\frac{1}{s_i \\sigma_i \\sqrt{2\\pi}} \\exp\\left( -\\frac{(\\ln s_i - \\mu_{i,H})^2}{2\\sigma_i^2} \\right)\n$$\n该似然函数的自然对数为：\n$$\n\\ln(\\Pr(s_i \\mid H)) = -\\ln(s_i) - \\ln(\\sigma_i) - \\frac{1}{2}\\ln(2\\pi) - \\frac{(\\ln s_i - \\mu_{i,H})^2}{2\\sigma_i^2}\n$$\n单个受体 $i$ 的对数似然比为：\n$$\n\\text{LLR}_i = \\ln(\\Pr(s_i \\mid H_{\\mathrm{V}})) - \\ln(\\Pr(s_i \\mid H_{\\mathrm{S}})) = \\frac{(\\ln s_i - \\mu_{i,H_{\\mathrm{S}}})^2}{2\\sigma_i^2} - \\frac{(\\ln s_i - \\mu_{i,H_{\\mathrm{V}}})^2}{2\\sigma_i^2}\n$$\n后验对数优势比 $\\Lambda$ 的计算方法是：将所有三个受体的这些项相加，再加上先验对数优势比：\n$$\n\\Lambda = \\ln\\left(\\frac{\\Pr(H_{\\mathrm{V}})}{\\Pr(H_{\\mathrm{S}})}\\right) + \\sum_{i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}} \\text{LLR}_i\n$$\n最后，使用 logistic (sigmoid) 函数从后验对数优势比中恢复后验概率 $\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})$：\n$$\n\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s}) = \\frac{1}{1 + \\exp(-\\Lambda)}\n$$\n计算步骤如下：\n$1$. 计算先验对数优势比：$\\ln(\\frac{0.35}{0.65})$。\n$2$. 对每个测试用例 $(s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$：\n    a. 初始化总对数似然比为 $0$。\n    b. 对于每个受体 $i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}$，使用相应的测量值 $s_i$ 和给定的参数 $(\\mu_{i,H_{\\mathrm{V}}}, \\mu_{i,H_{\\mathrm{S}}}, \\sigma_{i})$ 计算其对 LLR 的贡献。这通过计算观测值在每个假设 $H_{\\mathrm{V}}$ 和 $H_{\\mathrm{S}}$ 下的对数似然并求其差值来实现。\n    c. 对各个 LLR求和。\n    d. 加上先验对数优势比，得到后验对数优势比 $\\Lambda$。\n    e. 使用 logistic 函数计算后验概率 $\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})$。\n\n此过程将针对给定的测试用例进行实现。我们将使用提供的参数值：\n- 先验概率：$\\Pr(H_{\\mathrm{V}}) = 0.35$，$\\Pr(H_{\\mathrm{S}}) = 0.65$。\n- TLR4: $(\\mu_{\\mathrm{V}}, \\mu_{\\mathrm{S}}, \\sigma) = (\\ln(1.4), \\ln(3.0), 0.4)$。\n- RIG-I: $(\\mu_{\\mathrm{V}}, \\mu_{\\mathrm{S}}, \\sigma) = (\\ln(5.0), \\ln(1.2), 0.35)$。\n- cGAS: $(\\mu_{\\mathrm{V}}, \\mu_{\\mathrm{S}}, \\sigma) = (\\ln(3.0), \\ln(1.8), 0.5)$。\n\n该实现将利用数值计算库来确保对数和指数函数的精确计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import lognorm\n\ndef solve():\n    \"\"\"\n    Computes the posterior probability of viral infection for five test cases using a Bayesian classifier.\n    \"\"\"\n    \n    # Define the five test cases as triples of receptor fold-changes.\n    # Format: (s_TLR4, s_RIGI, s_cGAS)\n    test_cases = [\n        (1.2, 6.0, 3.2),\n        (3.8, 1.1, 1.9),\n        (3.0, 4.5, 2.5),\n        (1.0, 1.0, 1.0),\n        (1.0, 10.0, 6.0),\n    ]\n\n    # Define the parameters for the log-normal distributions for each receptor.\n    # H_V: Viral infection hypothesis\n    # H_S: Sterile injury hypothesis\n    params = {\n        'TLR4': {'mu_V': np.log(1.4), 'mu_S': np.log(3.0), 'sigma': 0.4},\n        'RIGI': {'mu_V': np.log(5.0), 'mu_S': np.log(1.2), 'sigma': 0.35},\n        'cGAS': {'mu_V': np.log(3.0), 'mu_S': np.log(1.8), 'sigma': 0.5},\n    }\n\n    # Define the prior probabilities for the hypotheses.\n    prior_V = 0.35\n    prior_S = 1.0 - prior_V\n\n    # Calculate the log-prior odds, ln(P(H_V) / P(H_S)).\n    log_prior_odds = np.log(prior_V / prior_S)\n    \n    results = []\n    \n    # Iterate through each test case to compute the posterior probability.\n    for case in test_cases:\n        s_tlr4, s_rigi, s_cgas = case\n        s_values = {'TLR4': s_tlr4, 'RIGI': s_rigi, 'cGAS': s_cgas}\n        \n        # Initialize the total log-likelihood ratio (LLR).\n        total_llr = 0.0\n        \n        # Calculate the LLR by summing the contributions from each receptor.\n        for receptor, p in params.items():\n            s_val = s_values[receptor]\n            \n            # The scale parameter for scipy's lognorm is exp(mu).\n            # The shape parameter 's' is our sigma.\n            \n            # Log-likelihood of the observation given viral infection (H_V).\n            log_lik_V = lognorm.logpdf(s_val, s=p['sigma'], scale=np.exp(p['mu_V']))\n            \n            # Log-likelihood of the observation given sterile injury (H_S).\n            log_lik_S = lognorm.logpdf(s_val, s=p['sigma'], scale=np.exp(p['mu_S']))\n            \n            # Add the individual LLR for this receptor to the total.\n            total_llr += log_lik_V - log_lik_S\n            \n        # The log-posterior odds is the sum of the log-prior odds and the total LLR.\n        log_posterior_odds = log_prior_odds + total_llr\n        \n        # Convert the log-posterior odds to a posterior probability using the logistic function.\n        # P(H_V | s) = 1 / (1 + exp(-log_posterior_odds))\n        posterior_V = 1.0 / (1.0 + np.exp(-log_posterior_odds))\n        \n        # Store the result formatted to six decimal places.\n        results.append(f\"{posterior_V:.6f}\")\n\n    # Print the final output in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2879739"}]}