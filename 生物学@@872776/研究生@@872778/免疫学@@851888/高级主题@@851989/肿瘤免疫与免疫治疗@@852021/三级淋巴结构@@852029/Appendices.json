{"hands_on_practices": [{"introduction": "三级淋巴结构中独特的 B 细胞和 T 细胞区域是由潜在的趋化因子梯度塑造的。本练习深入探讨控制这些梯度的生物物理学原理，要求您模拟 B 细胞化学引诱物 $CXCL13$ 的稳定浓度分布是如何形成的。通过推导该梯度的特征长度尺度，您将定量地理解扩散和降解率等分子特性如何决定 B 细胞滤泡的物理尺寸。[@problem_id:2895378]", "problem": "三级淋巴结构 (TLS) 通过在细胞外基质 (ECM) 中建立的 C-X-C 基序趋化因子配体 13 (CXCL13) 梯度来组织 B 细胞滤泡。考虑一个一维组织半空间 $x \\geq 0$，其中 CXCL13 由位于 $x=0$ 处的平面基质层产生，施加一个固定浓度 $C(0)=C_{0}$，并在 ECM 中通过速率常数为 $k$ 的一级过程降解。假设无平流、介质均匀，并且在 $x=0$ 之外没有 CXCL13 的体积源。仅使用菲克第一定律和包含一级汇的质量守恒，推导 $x>0$ 时的稳态浓度分布 $C(x)$，并确定控制空间衰减的特征长度尺度 $\\lambda$。然后，给定在 ECM 中测得的 CXCL13 扩散系数 $D=9.0 \\times 10^{-11}\\ \\mathrm{m^{2}\\ s^{-1}}$ 和一级衰减常数 $k=1.0 \\times 10^{-3}\\ \\mathrm{s^{-1}}$，以及观测到的 TLS B 细胞滤泡半径 $R_{\\mathrm{obs}}=2.25 \\times 10^{-4}\\ \\mathrm{m}$，计算无量纲比值 $R_{\\mathrm{obs}}/\\lambda$。将最终答案表示为一个纯数（无单位），并四舍五入到三位有效数字。", "solution": "所述问题在科学上是合理的、适定的，并包含足够的信息以获得唯一解。它描述了一个经典的一维稳态反应-扩散系统，是化学物理和生物学中的一个基本模型。我们现在开始进行推导和计算。\n\n在一维系统中，趋化因子 C-X-C 基序趋化因子配体 13 (CXCL13) 的质量守恒由以下偏微分方程描述：\n$$\n\\frac{\\partial C}{\\partial t} = -\\frac{\\partial J}{\\partial x} + S\n$$\n其中 $C(x,t)$ 是在位置 $x$ 和时间 $t$ 时的 CXCL13 浓度，$J(x,t)$ 是扩散通量，$S$ 是净生产速率（源减去汇）。\n\n问题陈述了无平流且介质均匀。扩散通量 $J$ 由菲克第一定律给出：\n$$\nJ = -D \\frac{\\partial C}{\\partial x}\n$$\n其中 $D$ 是恒定的扩散系数。\n\n问题指明了通过速率常数为 $k$ 的一级过程降解，并且对于 $x > 0$ 没有体积源。因此，汇项是 $-kC$，源项是 $0$。净生产速率为 $S = -kC$。\n\n将 $J$ 和 $S$ 的表达式代入守恒方程，得到反应-扩散方程：\n$$\n\\frac{\\partial C}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left(-D \\frac{\\partial C}{\\partial x}\\right) - kC = D \\frac{\\partial^2 C}{\\partial x^2} - kC\n$$\n\n问题要求的是稳态浓度分布，这意味着浓度不随时间变化，即 $\\frac{\\partial C}{\\partial t} = 0$。控制方程简化为一个二阶常微分方程 (ODE)：\n$$\nD \\frac{d^2 C}{d x^2} - k C = 0\n$$\n这可以改写为：\n$$\n\\frac{d^2 C}{d x^2} - \\frac{k}{D} C = 0\n$$\n这是一个线性、齐次、常系数的常微分方程。其特征方程为 $r^2 - \\frac{k}{D} = 0$，它有两个实根：$r = \\pm\\sqrt{\\frac{k}{D}}$。因此通解为：\n$$\nC(x) = A_{1} \\exp\\left(x\\sqrt{\\frac{k}{D}}\\right) + A_{2} \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\n其中 $A_{1}$ 和 $A_{2}$ 是由边界条件决定的常数。\n\n边界条件是：\n1. 在源平面 $x=0$ 处的固定浓度 $C_{0}$：$C(0) = C_{0}$。\n2. 在离源很远的地方，浓度必须保持物理上的合理性。在半空间 $x \\geq 0$ 中，当 $x \\to \\infty$ 时浓度不能无限增长。这意味着当 $x \\to \\infty$ 时，带有正指数的项（该项会发散）必须为零。因此，我们必须设置 $A_{1}=0$。\n\n应用第一个边界条件并设 $A_{1}=0$：\n$$\nC(0) = A_{2} \\exp(0) = A_{2} = C_{0}\n$$\n因此，稳态浓度分布是：\n$$\nC(x) = C_{0} \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\n这个解描述了趋化因子浓度从源平面开始呈指数衰减。特征长度尺度 $\\lambda$ 是浓度下降为原来的 $1/e$ 时所经过的距离。通过将我们的解与通用形式 $C(x) = C_0 \\exp(-x/\\lambda)$ 进行比较，我们确定 $\\lambda$ 为：\n$$\n\\lambda = \\sqrt{\\frac{D}{k}}\n$$\n现在，我们必须计算这个特征长度尺度 $\\lambda$ 的值，然后计算无量纲比值 $R_{\\mathrm{obs}}/\\lambda$。\n\n给定的参数是：\n扩散系数，$D = 9.0 \\times 10^{-11} \\ \\mathrm{m^2 \\ s^{-1}}$。\n一级衰减常数，$k = 1.0 \\times 10^{-3} \\ \\mathrm{s^{-1}}$。\n观测到的 B 细胞滤泡半径，$R_{\\mathrm{obs}} = 2.25 \\times 10^{-4} \\ \\mathrm{m}$。\n\n首先，我们计算 $\\lambda$：\n$$\n\\lambda = \\sqrt{\\frac{9.0 \\times 10^{-11} \\ \\mathrm{m^2 \\ s^{-1}}}{1.0 \\times 10^{-3} \\ \\mathrm{s^{-1}}}} = \\sqrt{9.0 \\times 10^{-8} \\ \\mathrm{m^2}} = 3.0 \\times 10^{-4} \\ \\mathrm{m}\n$$\n接下来，我们计算所需的无量纲比值：\n$$\n\\frac{R_{\\mathrm{obs}}}{\\lambda} = \\frac{2.25 \\times 10^{-4} \\ \\mathrm{m}}{3.0 \\times 10^{-4} \\ \\mathrm{m}} = \\frac{2.25}{3.0} = 0.75\n$$\n问题要求最终答案四舍五入到三位有效数字。\n$$\n0.75 \\rightarrow 0.750\n$$\n这个比值表明，观测到的 B 细胞滤泡的大小是趋化因子梯度特征长度的一个重要部分，确切地说是 $75\\%$。", "answer": "$$\\boxed{0.750}$$", "id": "2895378"}, {"introduction": "TLS 是一个活跃的免疫学场所，而非静态结构，其功能有赖于循环淋巴细胞的持续流入。本练习要求您为通过称为高内皮微静脉 (HEV) 的特化血管募集淋巴细胞的过程建立一个定量模型。通过结合流体动力学和概率论原理，您将计算预期的细胞进入速率，从而在分子水平的粘附事件与整个结构的细胞动力学之间建立具体的联系。[@problem_id:2895372]", "problem": "考虑在稳态下，一条高内皮微静脉 (HEV) 为一个成熟的三级淋巴结构 (TLS) 供血。携带循环淋巴细胞的血液以体积流率 $Q$（单位时间的体积）流过 HEV，淋巴细胞的平均数量浓度为 $c_{b}$（单位体积的细胞数）。每个穿过 HEV 的淋巴细胞要进入 TLS 实质，都需要经历三个连续的随机步骤：选择素介导的滚动、整合素介导的牢固黏附和血细胞渗出（跨内皮迁移）。设淋巴细胞成功完成滚动的概率为 $p_{r}$，在滚动后成功黏附的条件概率为 $p_{a}$，在黏附后成功进行血细胞渗出的条件概率为 $p_{t}$。假设 (i) 在所关注的时间窗口内具有平稳性和遍历性，(ii) 在单个细胞水平上是相互独立的，以及 (iii) $p_{r}$、$p_{a}$ 和 $p_{t}$ 不随时间变化，并反映了局部趋化因子和黏附受体呈递的综合效应。\n\n从细胞数量守恒（细胞通量等于体积流率乘以浓度）和序贯事件的基本概率法则出发，推导淋巴细胞进入 TLS 的预期进入速率 $J_{\\mathrm{in}}$（单位时间的细胞数）关于 $Q$、$c_{b}$、$p_{r}$、$p_{a}$ 和 $p_{t}$ 的闭式表达式。然后，使用以下生理上合理的参数值对 $J_{\\mathrm{in}}$ 进行数值计算：\n- 体积血流量: $Q = 1.2\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$\n- 循环淋巴细胞浓度: $c_{b} = 2.5 \\times 10^{6}\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}$\n- 滚动概率: $p_{r} = 0.35$\n- 黏附概率: $p_{a} = 0.60$\n- 迁移概率: $p_{t} = 0.70$\n\n将 $J_{\\mathrm{in}}$ 的最终数值答案以每分钟细胞数为单位表示，并四舍五入到三位有效数字。最终答案中不要包含推导公式；只报告计算出的值。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 循环淋巴细胞的平均数量浓度: $c_{b}$\n- 流经高内皮微静脉 (HEV) 的体积血流率: $Q$\n- 淋巴细胞成功滚动的概率: $p_{r}$\n- 成功滚动后牢固黏附的条件概率: $p_{a}$\n- 成功黏附后血细胞渗出的条件概率: $p_{t}$\n- 假设: (i) 平稳性和遍历性，(ii) 单个细胞的独立性，(iii) 概率 $p_{r}$、$p_{a}$、$p_{t}$ 不随时间变化。\n- 数值:\n  - $Q = 1.2\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$\n  - $c_{b} = 2.5 \\times 10^{6}\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}$\n  - $p_{r} = 0.35$\n  - $p_{a} = 0.60$\n  - $p_{t} = 0.70$\n- 目标: 推导预期淋巴细胞进入速率 $J_{\\mathrm{in}}$ 的闭式表达式，并计算其值（单位为细胞/分钟），四舍五入到三位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n评估问题的有效性。\n- **科学依据**：该问题使用标准的多步概率模型（滚动、黏附、血细胞渗出）来描述淋巴细胞外渗，这是免疫学和生物物理学的基石。该模型是一种简化，但基于已确立的科学原理。它是合理的。\n- **良定性**：该问题提供了所有必需的参数和明确的目标。通量、浓度和概率之间的关系定义明确，从而可以得到唯一解。该问题是良定的。\n- **客观性**：语言技术性强且精确，没有主观或模糊的术语。\n\n**步骤 3：结论与行动**\n该问题在科学上有效、自洽且良定。它没有所列举的缺陷。将推导解答。\n\n按要求从第一性原理开始推导。淋巴细胞的总通量，记为 $J_{\\mathrm{total}}$，表示单位时间内通过 HEV 的淋巴细胞总数。它由体积流率 $Q$ 和淋巴细胞的平均数量浓度 $c_{b}$ 的乘积给出。\n$$J_{\\mathrm{total}} = Q c_{b}$$\n该表达式基于运动流体中细胞数量守恒的原理。\n\n单个淋巴细胞要进入三级淋巴结构 (TLS) 的实质，必须成功完成一系列三个随机事件：滚动、黏附和血细胞渗出（迁移）。问题陈述了这些事件是序贯的，并提供了相关概率。设 $R$ 为成功滚动的事件，$A$ 为成功黏附的事件，$T$ 为成功迁移的事件。给定的概率是：\n- $P(R) = p_{r}$\n- $P(A|R) = p_{a}$ （黏附以滚动为条件）\n- $P(T|A \\cap R) = p_{t}$ （血细胞渗出以前两个步骤，即黏附和滚动为条件）\n\n单个淋巴细胞成功完成整个序列的概率 $p_{\\mathrm{entry}}$ 是联合事件 $R \\cap A \\cap T$ 的概率。使用条件概率的链式法则：\n$$p_{\\mathrm{entry}} = P(R \\cap A \\cap T) = P(T|A \\cap R) P(A|R) P(R)$$\n代入给定的符号概率：\n$$p_{\\mathrm{entry}} = p_{t} p_{a} p_{r}$$\n淋巴细胞进入 TLS 的预期进入速率 $J_{\\mathrm{in}}$ 是到达的淋巴细胞的总通量乘以任何单个淋巴细胞成功完成进入序列的概率。这是根据细胞独立性和平稳性的假设得出的。\n$$J_{\\mathrm{in}} = J_{\\mathrm{total}} \\times p_{\\mathrm{entry}}$$\n代入 $J_{\\mathrm{total}}$ 和 $p_{\\mathrm{entry}}$ 的表达式，得到最终的闭式表达式：\n$$J_{\\mathrm{in}} = Q c_{b} p_{r} p_{a} p_{t}$$\n现在，我们必须使用提供的参数对该表达式进行数值计算。一个关键步骤是确保量纲一致性。\n给定的值为：\n- $Q = 1.2\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$\n- $c_{b} = 2.5 \\times 10^{6}\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}$\n- $p_{r} = 0.35$\n- $p_{a} = 0.60$\n- $p_{t} = 0.70$\n\n$Q$ 的体积单位（$\\mu\\mathrm{L}$）和 $c_{b}$ 的体积单位（$\\mathrm{mL}$）不一致。我们必须将它们转换为一个共同的单位。我们使用转换因子 $1\\,\\mathrm{mL} = 1000\\,\\mu\\mathrm{L} = 10^{3}\\,\\mu\\mathrm{L}$，将 $Q$ 从 $\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$ 转换为 $\\mathrm{mL}\\,\\mathrm{min}^{-1}$。\n$$Q = 1.2\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1} = 1.2 \\times \\frac{1}{10^{3}}\\,\\mathrm{mL}\\,\\mathrm{min}^{-1} = 1.2 \\times 10^{-3}\\,\\mathrm{mL}\\,\\mathrm{min}^{-1}$$\n现在，将数值代入推导出的 $J_{\\mathrm{in}}$ 公式。\n$$J_{\\mathrm{in}} = (1.2 \\times 10^{-3}\\,\\mathrm{mL}\\,\\mathrm{min}^{-1}) \\times (2.5 \\times 10^{6}\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}) \\times (0.35) \\times (0.60) \\times (0.70)$$\n首先，我们计算流率和浓度的乘积：\n$$Q c_{b} = (1.2 \\times 10^{-3}) \\times (2.5 \\times 10^{6})\\,\\mathrm{cells}\\,\\mathrm{min}^{-1} = 3.0 \\times 10^{3}\\,\\mathrm{cells}\\,\\mathrm{min}^{-1}$$\n接下来，我们计算概率的乘积：\n$$p_{r} p_{a} p_{t} = 0.35 \\times 0.60 \\times 0.70 = 0.21 \\times 0.70 = 0.147$$\n最后，我们计算预期进入速率 $J_{\\mathrm{in}}$：\n$$J_{\\mathrm{in}} = (3.0 \\times 10^{3}\\,\\mathrm{cells}\\,\\mathrm{min}^{-1}) \\times 0.147 = 441\\,\\mathrm{cells}\\,\\mathrm{min}^{-1}$$\n问题要求答案四舍五入到三位有效数字。计算值 $441$ 已经有三位有效数字。我们必须用指定的科学记数法格式 $a \\times 10^b$ 来表示它，其中 $1 \\le |a|  10$。\n$$J_{\\mathrm{in}} = 441 = 4.41 \\times 10^{2}\\,\\mathrm{cells}\\,\\mathrm{min}^{-1}$$\n这是最终的数值答案。", "answer": "$$\\boxed{4.41 \\times 10^{2}}$$", "id": "2895372"}, {"introduction": "虽然组织学图像可以定性地显示 B 细胞和 T 细胞的隔离，但现代免疫学要求定量的严谨性。这项高级计算练习向您介绍空间统计学领域，提供一种强大的方法来衡量 TLS 内细胞组织的程度。通过实现 Ripley's K-函数的估计量，您将学习如何客观地确定观察到的细胞模式是代表真实的隔离、随机混合还是共定位——这是分析高参数成像数据的关键技能。[@problem_id:2895404]", "problem": "给定一项源于免疫学中三级淋巴结构 (Tertiary Lymphoid Structures, TLS) 研究的量化任务：对圆形 TLS 内 B 细胞和 T 细胞的空间分离或共定位进行建模，并量化其与空间随机性的偏差。将 TLS 表示为一个半径为 $R$（以任意长度单位，缩写为 a.l.u.）的二维圆形观察窗，并将细胞位置表示为两种类型的点：B 细胞和 T 细胞。\n\n使用的基本原理和定义：\n- 在均匀空间泊松点过程（完全空间随机性，缩写为 CSR）中，一个典型点在距离 $r$ 内的期望邻居数量与面积 $ \\pi r^2 $ 成正比。对于两个强度恒定的独立类型，交叉类型邻居的期望与目标类型的强度和 $ \\pi r^2 $ 成比例。\n- 令 $ \\lambda_B $ 和 $ \\lambda_T $ 分别表示 B 细胞和 T 细胞的（恒定）强度，定义为单位面积内的数量。\n- 交叉型 Ripley K 函数，记作 $K_{BT}(r)$，定义为一个典型 B 细胞在距离 $r$ 内的 T 细胞邻居的期望数量除以 $ \\lambda_T $。在类型独立且均匀的条件下，$K_{BT}(r) = \\pi r^2$。\n- 通常使用方差稳定变换 $L_{BT}(r) = \\sqrt{K_{BT}(r) / \\pi}$，因此在独立性假设下，$L_{BT}(r) - r$ 的期望值为 $0$。\n\n问题要求：\n1) 从第一性原理出发，推导并实现一个在圆形观察窗内对两种点类型的交叉型函数 $K_{BT}(r)$ 的一致估计量。使用适用于圆形窗口的边界（缩减样本）边缘校正：对于每个半径 $r$，只有其半径为 $r$ 的完整圆形邻域都位于观察窗内的 B 细胞“焦点”才能计入邻居，并按 T 细胞强度进行归一化。令 $A$ 表示窗口面积。您的估计量必须使用：\n   - $ \\lambda_T = N_T / A $，其中 $ N_T $ 是 T 细胞的数量，$ A = \\pi R^2 $。\n   - 对于每个半径 $ r $，只包括那些到圆形边界的距离至少为 $ r $ 的 B 细胞；令此类 B 细胞的数量为 $ N_B^{\\ast}(r) $。\n   - 对于每个这样的合格 B 细胞，计算其欧几里得距离 $ r $ 内的 T 细胞数量。\n2) 计算 $ L_{BT}(r) = \\sqrt{ K_{BT}(r) / \\pi } $ 以及偏差 $ \\Delta(r) = L_{BT}(r) - r $。\n3) 定义一个标量分离汇总统计量，即 $ \\Delta(r) $ 在给定的离散半径网格 $ \\{ r_k \\} $ 上的算术平均值。以 a.l.u. 为单位报告此平均偏差。直观上，负值表示分离（规避），正值表示吸引（共定位），接近零的值表示在所考察的尺度上与独立性一致。\n4) 必须按照测试套件中的规定实现合成数据生成。所有随机数生成必须完全按照规定设置种子，以确保可复现性。\n5) 数值单位：所有距离和坐标均以任意长度单位（a.l.u.）表示。您的程序必须输出以 a.l.u. 为单位的平均偏差，每个测试用例四舍五入到六位小数。\n\n测试套件（三种情景，探究不同行为）：\n- 测试用例 1（独立性/CSR 基线）：\n  - 种子：$12345$\n  - 窗口半径：$R = 1.0$ a.l.u.\n  - 数量：$N_B = 150$，$N_T = 150$\n  - 生成方式：在半径为 $R$ 的圆内独立且均匀地抽取 B 点和 T 点。\n  - 半径网格：$ \\{ 0.05, 0.10, 0.15, 0.20, 0.25, 0.30 \\} $ a.l.u.\n\n- 测试用例 2（分离：两个分离的簇）：\n  - 种子：$202357$\n  - 窗口半径：$R = 1.0$ a.l.u.\n  - 数量：$N_B = 150$，$N_T = 150$\n  - 生成方式：从均值为 $(-0.4, 0.0)$、标准差为 $0.12$（各向同性）的二元正态分布中抽取 B 点，拒绝并重新采样任何落在半径为 $R$ 的圆外的点，直到恰好接受 $N_B$ 个点。用类似的方法抽取 T 点，均值为 $(+0.4, 0.0)$，标准差为 $0.12$，使用相同的拒绝规则。\n  - 半径网格：$ \\{ 0.05, 0.10, 0.15, 0.20, 0.25, 0.30 \\} $ a.l.u.\n\n- 测试用例 3（吸引：T 细胞聚集在 B 细胞周围）：\n  - 种子：$98765$\n  - 窗口半径：$R = 1.0$ a.l.u.\n  - 数量：$N_B = 150$，$N_T = 150$\n  - 生成方式：首先在半径为 $R$ 的圆内均匀抽取 $N_B$ 个 B 点。然后通过重复地随机均匀选择一个 B 点，并添加一个均值为 $(0,0)$、标准差为 $0.06$（各向同性）的独立二元正态偏移来生成 T 点。拒绝并重新采样任何落在圆外的 T 点，直到恰好接受 $N_T$ 个点。\n  - 半径网格：$ \\{ 0.05, 0.10, 0.15, 0.20, 0.25, 0.30 \\} $ a.l.u.\n\n算法输出：\n- 对于每个测试用例，计算 $ \\Delta(r) $ 在所提供的半径网格上的平均值。每个输出必须是一个浮点数（以 a.l.u. 为单位），四舍五入到六位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3]\"），顺序与测试用例（1、2、3）相同。", "solution": "问题陈述经过验证，被认为是具有科学依据、提法恰当且客观的。它在空间统计学应用于免疫学领域提出了一个清晰、可形式化的任务，并提供了所有必要的参数和定义。陈述中没有矛盾、歧义或违反科学原则之处。因此，该问题被判定为**有效**，并给出完整解答。\n\n这个问题的核心是为交叉型 Ripley's K 函数（记作 $K_{BT}(r)$）实现一个特定的估计量，用以分析代表三级淋巴结构（TLS）的圆形域内两种细胞群——B 细胞和 T 细胞——的空间关系。我们将使用从此函数导出的汇总统计量来量化与空间独立性的偏差。\n\n首先，我们按要求从第一性原理出发形式化该估计量。设 B 细胞位置集合为 $B = \\{\\mathbf{x}_i\\}_{i=1}^{N_B}$，T 细胞位置集合为 $T = \\{\\mathbf{y}_j\\}_{j=1}^{N_T}$，其中 $\\mathbf{x}_i, \\mathbf{y}_j \\in \\mathbb{R}^2$。观察窗是一个以原点为中心、半径为 $R$ 的圆盘 $W$，其面积为 $A = \\pi R^2$。T 细胞的强度（单位面积的点数）估计为 $\\hat{\\lambda}_T = N_T / A$。\n\n问题指定了边界（或缩减样本）边缘校正。对于给定的分析半径 $r$，只有那些离 $W$ 边界足够远的 B 细胞才被用作计算邻居的焦点。这确保了每个焦点周围半径为 $r$ 的整个邻域都包含在观察窗内，从而避免了估计未观察到的邻居。对于半径为 $R$ 的圆形窗口，一个点 $\\mathbf{x}_i$ 如果其到原点的距离满足 $||\\mathbf{x}_i|| \\le R - r$，则它是一个合格的焦点。\n\n令 $N_B^*(r)$ 为在给定半径 $r$ 下此类合格 B 细胞的数量：\n$$ N_B^*(r) = \\sum_{i=1}^{N_B} \\mathbb{I}(||\\mathbf{x}_i|| \\le R - r) $$\n其中 $\\mathbb{I}(\\cdot)$ 是指示函数，当其参数为真时为 $1$，否则为 $0$。我们假设对于分析网格中的所有半径 $r$，$N_B^*(r)  0$，这是一个基于问题参数的合理假设。\n\n交叉型 K 函数的估计量 $\\hat{K}_{BT}(r)$ 定义为在一个合格 B 细胞距离 $r$ 内发现的 T 细胞的平均数量，再除以 T 细胞强度 $\\hat{\\lambda}_T$ 进行归一化。公式为：\n$$ \\hat{K}_{BT}(r) = \\frac{1}{\\hat{\\lambda}_T N_B^*(r)} \\sum_{i=1}^{N_B} \\sum_{j=1}^{N_T} \\mathbb{I}(||\\mathbf{x}_i - \\mathbf{y}_j|| \\le r) \\mathbb{I}(||\\mathbf{x}_i|| \\le R-r) $$\n代入 $\\hat{\\lambda}_T = N_T / A$ 并整理，我们得到计算公式：\n$$ \\hat{K}_{BT}(r) = \\frac{A}{N_T N_B^*(r)} \\sum_{\\{\\mathbf{x}_i : ||\\mathbf{x}_i|| \\le R-r\\}} \\left( \\sum_{j=1}^{N_T} \\mathbb{I}(||\\mathbf{x}_i - \\mathbf{y}_j|| \\le r) \\right) $$\n\n接下来，我们应用方差稳定变换得到 $L$ 函数，它在完全空间随机性（CSR）和两个点过程独立的零假设下将 K 函数线性化。\n$$ \\hat{L}_{BT}(r) = \\sqrt{\\frac{\\hat{K}_{BT}(r)}{\\pi}} $$\n在 CSR 条件下，理论期望为 $L_{BT}(r) = r$。因此，与该期望的偏差 $\\Delta(r)$ 提供了一个在尺度 $r$ 上衡量聚集或分离的度量。\n$$ \\hat{\\Delta}(r) = \\hat{L}_{BT}(r) - r $$\n$\\hat{\\Delta}(r)$ 的正值表明吸引或共定位，而负值表明分离或规避。接近 $0$ 的值与空间独立性相符。\n\n最后，问题要求一个单一的汇总统计量，即 $\\hat{\\Delta}(r)$ 在离散半径网格 $\\{r_k\\}_{k=1}^M$ 上的算术平均值：\n$$ \\bar{\\Delta} = \\frac{1}{M} \\sum_{k=1}^M \\hat{\\Delta}(r_k) $$\n\n对于每个测试用例，实现将按以下步骤进行：\n1.  使用指定的种子初始化伪随机数生成器，以确保可复现性。\n2.  根据每个用例的规则（均匀、分离双峰或吸引）生成 $N_B$ 个 B 细胞和 $N_T$ 个 T 细胞的点模式。这涉及到拒绝采样，以确保所有点都落在半径为 $R$ 的圆形窗口内。\n3.  对于所提供网格中的每个半径 $r_k$：\n    a. 通过选择那些满足 $||\\mathbf{x}_i|| \\le R-r_k$ 的 B 细胞来确定合格 B 细胞集合。\n    b. 如果合格 B 细胞的数量 $N_B^*(r_k)$ 为 $0$，则估计量未定义。然而，考虑到给定的参数，这种情况预计不会发生。\n    c. 对于每个合格的 B 细胞，计算其欧几里得距离 $r_k$ 内的 T 细胞数量。\n    d. 将这些计数在所有合格 B 细胞上求和。\n    e. 使用推导出的公式计算 $\\hat{K}_{BT}(r_k)$、$\\hat{L}_{BT}(r_k)$ 和 $\\hat{\\Delta}(r_k)$。\n4.  计算所有计算出的 $\\hat{\\Delta}(r_k)$ 值的算术平均值。这个平均值是该测试用例的最终结果，将四舍五入到六位小数后报告。\n\n此系统性步骤将空间点过程分析的理论原理正确地转化为具体的计算算法，满足了问题陈述的所有要求。", "answer": "[-0.003504,-0.165030,0.015923]", "id": "2895404"}]}