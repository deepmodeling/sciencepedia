{"hands_on_practices": [{"introduction": "免疫相关不良事件 (irAEs) 的诊断极具挑战性，因为其临床表现常与其他疾病（如感染或肿瘤进展）重叠。贝叶斯定理为我们提供了一个强大的定量框架，用于根据新的诊断证据（例如复合诊断评估的结果）来更新我们对诊断的置信度。本练习 [@problem_id:2858117] 将指导您如何运用贝叶斯定理，结合检测的灵敏度 ($S_e$) 和特异性 ($S_p$)，精确计算获得阳性结果后患者患有irAE的后验概率，从而将诊断不确定性转化为具体的概率值。", "problem": "一名正在接受程序性死亡-1 (PD-1) 免疫检查点抑制剂 (ICI) 治疗的转移性黑色素瘤患者，出现了新发的呼吸困难和干咳。您正在考虑将ICI相关性肺炎作为鉴别诊断的一部分。在进行进一步的侵入性检查之前，您采用了一种非侵入性的复合诊断评估方法，该方法整合了高分辨率胸部计算机断层扫描 (CT) 的影像模式和支气管肺泡灌洗液的细胞因子特征。在一个接受ICI治疗的患者的验证队列中，该复合检验对于ICI相关性肺炎显示出$0.85$的敏感性，对于包括感染和疾病进展相关的淋巴管播散在内的其他呼吸道症状原因，显示出$0.90$的特异性。在您当前的情况下，根据流行病学和临床背景，您估计ICI相关性肺炎的检验前概率为$0.10$。\n\n您得到了一个阳性的检测结果。从敏感性和特异性关于条件概率的定义以及全概率定律出发，使用贝叶斯定理推导一个在给定阳性检测结果下患病的检验后概率的表达式。然后使用所提供的数值评估该表达式。将您的最终答案表示为小数，并四舍五入到四位有效数字。", "solution": "该问题要求使用给定的检验前概率、敏感性和特异性数据，计算在检测结果为阳性的情况下患病的检验后概率。这是贝叶斯定理的直接应用。我们首先正式定义事件和概率。\n\n设$D$为患者患有ICI相关性肺炎的事件。\n设$D^c$为互补事件，即患者没有患ICI相关性肺炎。\n设$+$表示阳性检测结果。\n设$-$表示阴性检测结果。\n\n问题陈述中给出的信息可以转化为以下概率术语：\n疾病的检验前概率，或在此背景下的患病率，为$P(D) = 0.10$。\n检验的敏感性是指在患病的情况下检测结果为阳性的概率。这是一个条件概率：$S_e = P(+|D) = 0.85$。\n检验的特异性是指在未患病的情况下检测结果为阴性的概率：$S_p = P(-|D^c) = 0.90$。\n\n从检验前概率，我们可以推导出互补事件的概率：\n$$P(D^c) = 1 - P(D) = 1 - 0.10 = 0.90$$\n\n我们被要求计算在检测结果为阳性的情况下患病的检验后概率，即条件概率$P(D|+)$。\n\n贝叶斯定理为此计算提供了正式的结构：\n$$P(D|+) = \\frac{P(+|D) P(D)}{P(+)}$$\n\n分母中的项$P(+)$表示获得阳性检测结果的总概率。它可以利用全概率定律计算，该定律将事件$+$在由$D$和$D^c$定义的样本空间上进行划分：\n$$P(+) = P(+ \\cap D) + P(+ \\cap D^c)$$\n使用条件概率的定义，$P(A \\cap B) = P(A|B)P(B)$，我们可以将其重写为：\n$$P(+) = P(+|D) P(D) + P(+|D^c) P(D^c)$$\n\n我们有$P(+|D)$、$P(D)$和$P(D^c)$的值。$P(+|D^c)$这一项，即未患病患者得到阳性检测结果的概率（假阳性率），必须从特异性中导出。对于未患病的患者，获得阳性或阴性结果的事件是互补的。因此：\n$$P(+|D^c) + P(-|D^c) = 1$$\n我们可以解出假阳性率：\n$$P(+|D^c) = 1 - P(-|D^c) = 1 - S_p = 1 - 0.90 = 0.10$$\n\n现在我们将此代回全概率定律的表达式中：\n$$P(+) = (P(+|D) \\cdot P(D)) + ((1 - S_p) \\cdot (1 - P(D)))$$\n\n最后，我们将$P(+)$的完整表达式代入贝叶斯定理的分母中，得到用敏感性、特异性和检验前概率表示的检验后概率的通用公式：\n$$P(D|+) = \\frac{P(+|D) P(D)}{P(+|D) P(D) + P(+|D^c) P(D^c)} = \\frac{S_e \\cdot P(D)}{S_e \\cdot P(D) + (1 - S_p) \\cdot (1 - P(D))}$$\n\n这就是所要求的推导表达式。现在我们使用提供的数值来评估这个表达式。\n分子是真阳性的概率：\n$$P(+|D) P(D) = 0.85 \\times 0.10 = 0.085$$\n分母由两部分组成。第一部分是真阳性概率，我们刚刚计算出为$0.085$。第二部分是假阳性概率：\n$$P(+|D^c) P(D^c) = (1 - S_p) \\cdot (1 - P(D)) = (1 - 0.90) \\times (1 - 0.10) = 0.10 \\times 0.90 = 0.090$$\n阳性检测的总概率是这两个概率之和：\n$$P(+) = 0.085 + 0.090 = 0.175$$\n\n现在我们完成检验后概率的计算：\n$$P(D|+) = \\frac{0.085}{0.175}$$\n为了简化分数：\n$$P(D|+) = \\frac{85}{175} = \\frac{17 \\times 5}{35 \\times 5} = \\frac{17}{35}$$\n进行除法运算以获得小数值：\n$$P(D|+) = \\frac{17}{35} \\approx 0.4857142857...$$\n按照要求四舍五入到四位有效数字，我们得到$0.4857$。这意味着，对于一个检验前概率为$10\\%$的患者，这项复合检验的阳性结果将患有ICI相关性肺炎的概率提高到大约$48.6\\%$。", "answer": "$$\\boxed{0.4857}$$", "id": "2858117"}, {"introduction": "准确诊断irAE后，下一步便是评估和选择最有效的治疗方案。本练习 [@problem_id:2858082] 将我们的视角从诊断转向治疗决策，介绍临床流行病学中的两个核心指标：绝对风险降低 (Absolute Risk Reduction, $ARR$) 和需治疗人数 (Number Needed to Treat, $NNT$)。通过计算这些指标，我们可以量化特定干预措施（如早期使用英夫利西单抗）的临床效益，从而更好地解读临床试验数据并将其应用于实践，理解治疗对预防严重irAE的真实影响。", "problem": "一个接受抗程序性死亡蛋白1（anti-PD-1）免疫检查点抑制剂治疗转移性黑色素瘤的患者队列正在监测其免疫相关不良事件，特别是免疫介导的结肠炎。在出现$2$级腹泻时，通过内镜和生物标志物特征前瞻性地识别出一个高风险亚组，并为该亚组提供在皮质类固醇治疗基础上加用 infliximab 的早期肿瘤坏死因子-α (TNF-$\\alpha$) 阻断治疗。历史数据显示，在没有早期使用 infliximab 的情况下，该高风险亚组进展为严重结肠炎（定义为住院、需要静脉注射皮质类固醇超过$72$小时，或在$8$周内进行结肠切除术）的概率为$0.40$。在一个接受早期 infliximab 治疗的匹配同期队列中，在相同时间范围内观察到的进展为严重结肠炎的概率为$0.15$。\n\n仅使用临床流行病学中绝对风险、绝对风险降低和需治数目的标准定义，计算在该高风险亚组中，使用早期 infliximab 治疗严重结肠炎的绝对风险降低值，以及在此情况下预防一例严重结肠炎病例所需的相应需治数目。将绝对风险降低表示为小数，需治数目表示为精确整数。无需四舍五入。答案中不要使用百分号。", "solution": "首先将对题目陈述进行严格的验证。\n\n**步骤1：提取已知条件**\n以下信息是从题目陈述中逐字提供或直接推断出来的：\n- 一个转移性黑色素瘤患者队列正在接受抗程序性死亡蛋白$1$ (anti-PD-$1$) 抑制剂治疗。\n- 基于$2$级腹泻和特定的生物标志物，识别出一个高风险亚组。\n- 这个高风险亚组是本分析的对象。\n- 关注的事件是进展为严重结肠炎，定义为住院、需要静脉注射皮质类固醇超过$72$小时，或在$8$周内进行结肠切除术。\n- 对照组是该高风险亚组的一个历史队列，仅使用皮质类固醇治疗（没有早期使用 infliximab）。\n- 对照组中事件的绝对风险为 $AR_{c} = 0.40$。\n- 干预组是该高风险亚组的一个匹配的同期队列，在皮质类固醇治疗的基础上，接受了早期肿瘤坏死因子-α (TNF-$\\alpha$) 阻断剂 (infliximab) 的治疗。\n- 干预组中事件的绝对风险为 $AR_{t} = 0.15$。\n- 任务是计算绝对风险降低（$ARR$）和需治数目（$NNT$）。\n- $ARR$ 的要求格式是小数。\n- $NNT$ 的要求格式是精确整数。\n\n**步骤2：题目陈述的验证**\n对题目的有效性进行评估：\n- **科学依据：** 题目设置在真实的临床背景中。Anti-PD-$1$疗法、免疫相关性结肠炎以及使用 infliximab 治疗皮质类固醇难治性结肠炎都是现代肿瘤学和免疫学中的标准概念。提供的风险概率在此类临床环境中是合理的。题目在科学上和事实上是合理的。\n- **适定性和客观性：** 题目清楚地定义了人群、干预措施、结局，并提供了所有必要的定量数据。“绝对风险降低”和“需治数目”这两个术语在临床流行病学中有标准、明确的定义。题目是客观且适定的，存在唯一解。\n- **完整性和一致性：** 题目是自洽的。它提供了两个必要的风险值（$AR_{c}$ 和 $AR_{t}$），由此可以唯一确定 $ARR$ 和 $NNT$。不存在矛盾。\n\n**步骤3：结论**\n题目被认为是有效的。它是基本流行病学原理在一个临床相关情景中的直接应用。将推导出解答。\n\n**解答推导**\n解答需要计算两个标准的流行病学指标：绝对风险降低（$ARR$）和需治数目（$NNT$）。\n\n设 $AR_{c}$ 为对照组（仅使用皮质类固醇的标准治疗）中进展为严重结肠炎的绝对风险。\n设 $AR_{t}$ 为治疗组（早期 infliximab 加皮质类固醇）中进展为严重结肠炎的绝对风险。\n\n根据题目陈述，我们有：\n$$ AR_{c} = 0.40 $$\n$$ AR_{t} = 0.15 $$\n\n绝对风险降低（$ARR$）定义为对照组和治疗组之间事件发生率的差异。它量化了因干预措施而带来的风险降低。\n公式为：\n$$ ARR = AR_{c} - AR_{t} $$\n代入给定值：\n$$ ARR = 0.40 - 0.15 = 0.25 $$\n题目要求将此值表示为小数，而 $0.25$ 正是小数形式。\n\n需治数目（$NNT$）定义为为了预防一个额外的不良结局，必须接受干预治疗的平均患者人数。在数学上，它是绝对风险降低的倒数。\n公式为：\n$$ NNT = \\frac{1}{ARR} $$\n使用上面计算出的 $ARR$ 值：\n$$ NNT = \\frac{1}{0.25} $$\n由于 $0.25$ 等价于分数 $\\frac{1}{4}$，计算变为：\n$$ NNT = \\frac{1}{\\frac{1}{4}} = 4 $$\n题目要求 $NNT$ 为一个精确整数。结果为 $4$，满足此条件。这意味着，平均而言，该高风险亚组中必须有 $4$ 名患者接受早期 infliximab 治疗，才能预防一例进展为严重结肠炎的病例。\n\n计算出的两个值是绝对风险降低，$0.25$，和需治数目，$4$。这些将按要求以行矩阵的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.25  4 \\end{pmatrix}}$$", "id": "2858082"}, {"introduction": "为了更深层次地理解并最终预测irAE的发生，我们需要构建能够描述其内在生物学动态的数学模型。本练习 [@problem_id:2858061] 介绍了一种基于概率论的强大建模方法，它将irAE的发生视为多个随机生物学阶段累积的结果。通过应用伽玛分布 ($Gamma(k, \\theta)$)，我们可以将关于发病机制的假设（例如，需要经过两个连续的随机过程）与可观察到的临床数据（事件发生时间）联系起来，为探索这些复杂事件的发病机制提供一个定量的理论框架。", "problem": "一项队列研究调查了在开始针对程序性死亡蛋白 $1$ (PD-$1$) 的免疫检查点抑制剂 (ICI) 治疗后，免疫介导性肝炎的发病时间。从机理上讲，假设发病需要经过 $2$ 个连续的、限速的免疫生物学阶段：抗原致敏和效应T细胞浸润。假设每个阶段的持续时间是一个独立的、服从指数分布的等待时间，具有共同的率参数 $\\lambda$，这反映了每个阶段都是无记忆的随机过程。令总发病时间 $T$ 为这 $2$ 个独立指数等待时间之和。根据更新理论和生存分析中经过充分检验的结果， $k$ 个独立同分布的指数等待时间之和服从伽马 (爱尔朗) 分布，其形状参数为 $k$，尺度参数为 $\\theta = 1/\\lambda$。\n\n假设临床特征表明，每个阶段的尺度参数为 $\\theta = 3$ 周，形状参数为 $k = 2$。从上述机理表示以及指数分布和作为指数分布之和的伽马分布的核心定义出发，推导累积分布函数 $F_{T}(t)$，并用它来计算形状参数 $k=2$、尺度参数 $\\theta=3$ 周的伽马模型在第 $6$ 周时的累积发病概率，即 $F_{T}(6)$。请用精确的闭式解形式表示最终答案；不要进行近似计算。给出 $F_{T}(6)$ 的一个单独的最终值，不带单位。", "solution": "问题陈述在科学上是合理的、提法恰当、客观，并包含足够的信息以得到唯一解。因此，我们开始进行推导。\n\n问题假定总发病时间 $T$ 是两个独立同分布 (i.i.d.) 的随机变量 $T_1$ 和 $T_2$ 之和，每个变量代表一个连续生物学阶段的持续时间。\n$$\nT = T_1 + T_2\n$$\n假设每个阶段的持续时间服从具有共同率参数 $\\lambda$ 的指数分布。对于率参数为 $\\lambda$ 的指数随机变量 $X$，其概率密度函数 (PDF) 由下式给出：\n$$\nf_X(x) = \\lambda \\exp(-\\lambda x) \\quad \\text{for } x \\ge 0\n$$\n问题陈述指出，$k$ 个独立同分布的指数变量之和服从伽马分布。对于 $k=2$， $T$ 的结果分布是形状参数为 $k=2$、率参数为 $\\lambda$ 的伽马分布，也称为爱尔朗-2 分布。由于 $T_1$ 和 $T_2$ 是独立的，我们可以通过计算两个指数概率密度函数的卷积来推导其概率密度函数。对于 $t \\ge 0$， $T = T_1 + T_2$ 的概率密度函数为：\n$$\nf_T(t) = \\int_0^t f_{T_1}(\\tau) f_{T_2}(t-\\tau) d\\tau\n$$\n代入指数概率密度函数：\n$$\nf_T(t) = \\int_0^t (\\lambda \\exp(-\\lambda \\tau)) (\\lambda \\exp(-\\lambda (t-\\tau))) d\\tau\n$$\n$$\nf_T(t) = \\int_0^t \\lambda^2 \\exp(-\\lambda\\tau - \\lambda t + \\lambda\\tau) d\\tau = \\int_0^t \\lambda^2 \\exp(-\\lambda t) d\\tau\n$$\n项 $\\lambda^2 \\exp(-\\lambda t)$ 相对于积分变量 $\\tau$ 是一个常数。\n$$\nf_T(t) = \\lambda^2 \\exp(-\\lambda t) \\int_0^t d\\tau = \\lambda^2 t \\exp(-\\lambda t) \\quad \\text{for } t \\ge 0\n$$\n这确实是形状参数为 $k=2$、率参数为 $\\lambda$ 的伽马分布的概率密度函数。使用形状-尺度参数化的一般伽马概率密度函数为 $f(t; k, \\theta) = \\frac{t^{k-1}\\exp(-t/\\theta)}{\\theta^k \\Gamma(k)}$。当 $k=2$ 且尺度 $\\theta = 1/\\lambda$ 时，该式变为 $\\frac{t^{2-1}\\exp(-t\\lambda)}{(1/\\lambda)^2 \\Gamma(2)} = \\lambda^2 t \\exp(-\\lambda t)$，因为伽马函数 $\\Gamma(2) = (2-1)! = 1$。我们从第一性原理出发的推导是一致的。\n\n问题提供了一个尺度参数 $\\theta = 3$ 周。率参数 $\\lambda$ 是一个相关参数，是尺度的倒数：\n$$\n\\lambda = \\frac{1}{\\theta} = \\frac{1}{3}\n$$\n因此，发病时间 $T$ 的概率密度函数为：\n$$\nf_T(t) = \\left(\\frac{1}{3}\\right)^2 t \\exp(-t/3) = \\frac{1}{9} t \\exp(-t/3)\n$$\n下一步是推导累积分布函数 (CDF) $F_T(t)$，它是概率密度函数从 $0$ 到 $t$ 的积分：\n$$\nF_T(t) = P(T \\le t) = \\int_0^t f_T(u) du = \\int_0^t \\frac{1}{9} u \\exp(-u/3) du\n$$\n我们使用分部积分法 $\\int v dw = vw - \\int w dv$ 来求解这个积分。令：\n- $v = u \\implies dv = du$\n- $dw = \\frac{1}{9} \\exp(-u/3) du \\implies w = \\int \\frac{1}{9} \\exp(-u/3) du = \\frac{1}{9}(-3)\\exp(-u/3) = -\\frac{1}{3}\\exp(-u/3)$\n\n应用该公式：\n$$\nF_T(t) = \\left[ u \\left(-\\frac{1}{3}\\exp(-u/3)\\right) \\right]_0^t - \\int_0^t \\left(-\\frac{1}{3}\\exp(-u/3)\\right) du\n$$\n$$\nF_T(t) = \\left[ -\\frac{t}{3}\\exp(-t/3) - 0 \\right] + \\frac{1}{3} \\int_0^t \\exp(-u/3) du\n$$\n$$\nF_T(t) = -\\frac{t}{3}\\exp(-t/3) + \\frac{1}{3} \\left[ -3\\exp(-u/3) \\right]_0^t\n$$\n$$\nF_T(t) = -\\frac{t}{3}\\exp(-t/3) + \\frac{1}{3} \\left( -3\\exp(-t/3) - (-3\\exp(0)) \\right)\n$$\n由于 $\\exp(0) = 1$：\n$$\nF_T(t) = -\\frac{t}{3}\\exp(-t/3) - \\exp(-t/3) + 1\n$$\n对表达式进行因式分解，我们得到伽马($k=2, \\theta=3$)分布的累积分布函数：\n$$\nF_T(t) = 1 - \\left(1 + \\frac{t}{3}\\right)\\exp(-t/3)\n$$\n推导完成。现在我们需要计算到第 $6$ 周时的累积发病概率，这对应于计算 $F_T(t)$ 在 $t=6$ 时的值。\n$$\nF_T(6) = 1 - \\left(1 + \\frac{6}{3}\\right)\\exp(-6/3)\n$$\n$$\nF_T(6) = 1 - (1 + 2)\\exp(-2)\n$$\n$$\nF_T(6) = 1 - 3\\exp(-2)\n$$\n这就是精确的闭式解。题目没有要求也不需要进行近似计算。", "answer": "$$\n\\boxed{1 - 3 \\exp(-2)}\n$$", "id": "2858061"}]}