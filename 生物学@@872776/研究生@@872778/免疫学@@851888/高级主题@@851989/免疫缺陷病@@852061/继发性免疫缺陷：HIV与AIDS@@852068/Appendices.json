{"hands_on_practices": [{"introduction": "艾滋病病毒（HIV）致病性的核心在于其极高的突变率，这是理解其免疫逃逸和耐药性出现的关键。本练习将通过应用基础概率论，特别是泊松分布近似，来量化单个病毒复制周期中产生的新突变数量[@problem_id:2887993]。通过这个计算，我们可以具体地把握HIV惊人的进化潜力，为后续理解其与宿主免疫系统的长期对抗奠定基础。", "problem": "人类免疫缺陷病毒 (HIV) 通过快速产生遗传多样性以实现免疫逃逸，从而部分导致获得性免疫缺陷综合征 (艾滋病)。考虑1型人类免疫缺陷病毒 (HIV-1) 的一个复制周期，在此期间逆转录酶将一个长度为 $9.7 \\times 10^{3}$ 个核苷酸的单链RNA基因组复制成互补DNA。设每次复制时每个碱基的点突变概率为 $3 \\times 10^{-5}$，并假设不同碱基上的突变独立发生，且每个碱基在每个周期内最多发生一次突变。仅使用以下基本原理：(i) 在一个周期内，整个基因组的点突变总数可以建模为每个碱基上独立的伯努利随机变量之和，以及 (ii) 在稀有事件、多次试验的极限情况下，这个总和可以很好地用一个泊松分布来近似，其均值等于伯努利均值之和，请从第一性原理出发，推导每个复制周期的期望点突变数以及在单个周期内至少发生一个点突变的概率。\n\n将您的最终答案以行矩阵 $\\begin{pmatrix} \\lambda  \\Pr(\\text{至少一个}) \\end{pmatrix}$ 的形式报告，其中 $\\lambda$ 是期望突变数，$\\Pr(\\text{至少一个})$ 是至少发生一个点突变的概率。将您的数值答案四舍五入到 $4$ 位有效数字。将概率表示为小数（而非百分比）。不需要单位。", "solution": "问题陈述具有科学依据，表述清晰且客观。所提供的HIV-1基因组长度和逆转录酶错误率的数据与已有的生物学文献一致。该建模方法，即使用伯努利试验之和，并在多次试验的稀有事件情况下使用泊松分布进行近似，是概率论的一个标准且正确的应用。因此，该问题是有效的，可以按要求从第一性原理进行求解。\n\n设 $N$ 为HIV-1基因组中的核苷酸碱基数，设 $p$ 为每个复制周期中每个碱基的点突变概率。\n给定值为：\n- 基因组长度, $N = 9.7 \\times 10^{3}$。\n- 突变概率, $p = 3 \\times 10^{-5}$。\n\n根据提供的第一个原理，我们将 $N$ 个碱基中每一个碱基上突变的发生建模为一个独立的伯努利试验。设 $X_i$ 为第 $i$ 个碱基发生突变的指示随机变量，其中 $i$ 的范围从 $1$ 到 $N$。\n如果发生突变，变量 $X_i$ 取值为 $1$，否则取值为 $0$。\n$$\nX_i = \\begin{cases} 1  \\text{概率为 } p \\\\ 0  \\text{概率为 } 1-p \\end{cases}\n$$\n单个伯努利试验 $X_i$ 的期望值为 $E[X_i] = (1 \\times p) + (0 \\times (1-p)) = p$。\n\n整个基因组的点突变总数，我们记为 $K$，是这些独立指示变量的总和：\n$$\nK = \\sum_{i=1}^{N} X_i\n$$\n首先要推导的是每个复制周期的期望点突变数，我们称之为 $\\lambda$。根据期望的线性性，随机变量之和的期望等于它们各自期望之和。\n$$\n\\lambda = E[K] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i]\n$$\n由于对所有 $i$ 都有 $E[X_i] = p$，因此简化为：\n$$\n\\lambda = \\sum_{i=1}^{N} p = Np\n$$\n代入给定的数值：\n$$\n\\lambda = (9.7 \\times 10^{3}) \\times (3 \\times 10^{-5}) = 29.1 \\times 10^{-2} = 0.291\n$$\n这是每个周期的期望突变数。\n\n根据提供的第二个原理，对于大量的试验（$N = 9700$ 很大）和每次试验中很小的成功概率（$p = 3 \\times 10^{-5}$ 很小），总和 $K$ 的分布（其形式上是二项分布 $B(N, p)$）可以精确地用均值为 $\\lambda = Np$ 的泊松分布来近似。\n因此，我们将随机变量 $K$ 建模为服从泊松分布，$K \\sim \\text{Poisson}(\\lambda)$，其中 $\\lambda = 0.291$。泊松分布的概率质量函数为：\n$$\n\\Pr(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\n其中 $k$ 是事件发生的次数。\n\n第二个要推导的量是在单个周期内至少发生一个点突变的概率，即 $\\Pr(K \\ge 1)$。计算其互补事件（即发生零次突变）的概率 $\\Pr(K=0)$，然后用 $1$ 减去这个概率，在计算上更简单。\n$$\n\\Pr(K \\ge 1) = 1 - \\Pr(K=0)\n$$\n使用 $k=0$ 时的泊松概率质量函数：\n$$\n\\Pr(K=0) = \\frac{\\lambda^{0} \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda)\n$$\n因此，至少发生一次突变的概率是：\n$$\n\\Pr(K \\ge 1) = 1 - \\exp(-\\lambda)\n$$\n代入计算出的值 $\\lambda = 0.291$：\n$$\n\\Pr(K \\ge 1) = 1 - \\exp(-0.291)\n$$\n我们现在计算数值：\n$$\n\\exp(-0.291) \\approx 0.74751040\n$$\n$$\n\\Pr(K \\ge 1) \\approx 1 - 0.74751040 = 0.25248960\n$$\n问题要求将结果四舍五入到 $4$ 位有效数字。\n期望突变数是 $\\lambda = 0.291$。保留 $4$ 位有效数字，为 $0.2910$。\n至少发生一次突变的概率是 $\\Pr(K \\ge 1) \\approx 0.25248960$。保留 $4$ 位有效数字，为 $0.2525$。\n\n最终答案需以包含这两个值的行矩阵形式报告。", "answer": "$$\\boxed{\\begin{pmatrix} 0.2910  0.2525 \\end{pmatrix}}$$", "id": "2887993"}, {"introduction": "在单个复制周期之后，我们转向病毒在宿主体内的长期动态。临床上，慢性感染期的病毒载量“设定点”是预测疾病进展速度的关键指标，它反映了病毒复制与宿主免疫清除之间达成的动态平衡。本练习将引导你使用一个经典的目标细胞限制模型，通过推导病毒设定点的数学表达式，来深入理解病毒复制、靶细胞供给以及免疫应答（如细胞毒性T淋巴细胞的杀伤效应 $\\Delta$）等因素如何共同决定慢性感染的走向[@problem_id:2888047]。", "problem": "宿主体内的人类免疫缺陷病毒 (HIV) 动力学可以通过一个靶细胞限制模型来近似，该模型包含三个状态变量：未感染的靶CD4$^{+}$ T细胞 $T(t)$，产毒性感染细胞 $I(t)$，以及游离病毒 $V(t)$。设 $s$ 表示新靶细胞的恒定供给率，$d$ 是未感染靶细胞的人均死亡率，$\\beta$ 是感染率常数，$p$ 是每个感染细胞的人均病毒粒子产生率，$c$ 是游离病毒的人均清除率。感染细胞的人均死亡率是基线病毒细胞病变效应 $\\delta_{b}$ 和由细胞毒性T淋巴细胞 (CTL) 介导的杀伤所致的免疫介导增加量 $\\Delta$ 的总和，因此总的感染细胞损失率为 $\\delta = \\delta_{b} + \\Delta$，其中 $\\Delta \\ge 0$。考虑以下系统\n$$\n\\frac{dT}{dt} = s - d\\,T - \\beta\\,V\\,T,\\qquad\n\\frac{dI}{dt} = \\beta\\,V\\,T - \\delta\\,I,\\qquad\n\\frac{dV}{dt} = p\\,I - c\\,V.\n$$\n假设参数值均为严格正数，并且存在一个慢性感染平衡点，使得 $V^{\\ast} > 0$。将慢性感染的病毒设定点定义为稳态值 $V^{\\ast}$。\n\n任务：\n- 仅从上述模型和定义出发，推导 $V^{\\ast}$ 的闭式表达式，使其成为靶细胞供给 $s$ 和免疫介导增加量 $\\Delta$ 的显式函数，并用 $s$、$\\Delta$、$\\delta_{b}$、$\\beta$、$d$、$p$ 和 $c$ 表示。\n- 定义绝对灵敏度系数 $S_{s} = \\partial V^{\\ast} / \\partial s$ 和 $S_{\\Delta} = \\partial V^{\\ast} / \\partial \\Delta$，并用相同的参数推导各自的闭式表达式。\n- 将您的最终结果以单行矩阵 $\\big[V^{\\ast},\\,S_{s},\\,S_{\\Delta}\\big]$ 的形式给出。请用代数表达式作答，不要代入数值，并且最终表达式中不包含单位。", "solution": "所给出的问题是数学与生物学中动力系统分析的一个标准练习，并且完全有效。它具有科学依据，是适定的、客观的，并包含了唯一解所需的所有信息。我们将开始推导。\n\n该系统由以下常微分方程描述：\n$$\n\\frac{dT}{dt} = s - d\\,T - \\beta\\,V\\,T\n$$\n$$\n\\frac{dI}{dt} = \\beta\\,V\\,T - \\delta\\,I\n$$\n$$\n\\frac{dV}{dt} = p\\,I - c\\,V\n$$\n一个慢性感染平衡点，记为 $(T^{\\ast}, I^{\\ast}, V^{\\ast})$，是一个稳态解，其中时间导数为零且 $V^{\\ast} > 0$。将方程左侧设为零，得到以下代数系统：\n$$\ns - d\\,T^{\\ast} - \\beta\\,V^{\\ast}\\,T^{\\ast} = 0 \\quad (1)\n$$\n$$\n\\beta\\,V^{\\ast}\\,T^{\\ast} - \\delta\\,I^{\\ast} = 0 \\quad (2)\n$$\n$$\np\\,I^{\\ast} - c\\,V^{\\ast} = 0 \\quad (3)\n$$\n问题规定了存在一个平衡点，其中 $V^{\\ast} > 0$。所有参数都是严格正数。\n\n从方程 $(3)$，我们求解稳态感染细胞数量 $I^{\\ast}$，用游离病毒数量 $V^{\\ast}$ 表示：\n$$\np\\,I^{\\ast} = c\\,V^{\\ast} \\implies I^{\\ast} = \\frac{c}{p}V^{\\ast}\n$$\n由于 $p > 0$，$c > 0$ 且 $V^{\\ast} > 0$，因此 $I^{\\ast} > 0$。\n\n接下来，将 $I^{\\ast}$ 的这个表达式代入方程 $(2)$：\n$$\n\\beta\\,V^{\\ast}\\,T^{\\ast} - \\delta\\left(\\frac{c}{p}V^{\\ast}\\right) = 0\n$$\n由于 $V^{\\ast} > 0$，我们可以用 $V^{\\ast}$ 除以该方程来求解稳态未感染靶细胞数量 $T^{\\ast}$：\n$$\n\\beta\\,T^{\\ast} - \\frac{\\delta c}{p} = 0 \\implies T^{\\ast} = \\frac{\\delta c}{\\beta p}\n$$\n现在，将定义 $\\delta = \\delta_{b} + \\Delta$ 代入 $T^{\\ast}$ 的表达式中：\n$$\nT^{\\ast} = \\frac{(\\delta_{b} + \\Delta)c}{\\beta p}\n$$\n最后，我们使用方程 $(1)$ 来找到病毒设定点 $V^{\\ast}$ 的表达式。我们重排方程 $(1)$ 以分离出 $V^{\\ast}$：\n$$\n\\beta\\,V^{\\ast}\\,T^{\\ast} = s - d\\,T^{\\ast} \\implies V^{\\ast} = \\frac{s - d\\,T^{\\ast}}{\\beta\\,T^{\\ast}} = \\frac{s}{\\beta T^{\\ast}} - \\frac{d}{\\beta}\n$$\n将推导出的 $T^{\\ast}$ 表达式代入这个 $V^{\\ast}$ 的方程中：\n$$\nV^{\\ast} = \\frac{s}{\\beta \\left( \\frac{(\\delta_{b} + \\Delta)c}{\\beta p} \\right)} - \\frac{d}{\\beta}\n$$\n化简第一项，得到 $V^{\\ast}$ 作为 $s$ 和 $\\Delta$ 的函数的最终表达式：\n$$\nV^{\\ast}(s, \\Delta) = \\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta}\n$$\n这是第一个要求的结果。\n\n第二个任务是推导绝对灵敏度系数 $S_{s} = \\frac{\\partial V^{\\ast}}{\\partial s}$ 和 $S_{\\Delta} = \\frac{\\partial V^{\\ast}}{\\partial \\Delta}$。\n\n为了求 $S_{s}$，我们将 $V^{\\ast}$ 对 $s$求导，同时保持所有其他参数不变：\n$$\nS_{s} = \\frac{\\partial V^{\\ast}}{\\partial s} = \\frac{\\partial}{\\partial s} \\left( \\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta} \\right)\n$$\n第二项 $-\\frac{d}{\\beta}$ 关于 $s$ 是常数。导数是：\n$$\nS_{s} = \\frac{p}{c(\\delta_{b} + \\Delta)}\n$$\n这是关于靶细胞供给率的灵敏度。\n\n为了求 $S_{\\Delta}$，我们将 $V^{\\ast}$ 对 $\\Delta$求导，同时保持所有其他参数不变：\n$$\nS_{\\Delta} = \\frac{\\partial V^{\\ast}}{\\partial \\Delta} = \\frac{\\partial}{\\partial \\Delta} \\left( \\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta} \\right)\n$$\n第二项同样是常数。对于第一项，我们对 $(\\delta_{b} + \\Delta)^{-1}$ 应用链式法则或幂法则求导：\n$$\nS_{\\Delta} = \\frac{sp}{c} \\frac{\\partial}{\\partial \\Delta} \\left( (\\delta_{b} + \\Delta)^{-1} \\right) = \\frac{sp}{c} \\left( -1 \\cdot (\\delta_{b} + \\Delta)^{-2} \\cdot \\frac{\\partial}{\\partial \\Delta}(\\delta_{b} + \\Delta) \\right)\n$$\n由于 $\\frac{\\partial}{\\partial \\Delta}(\\delta_{b} + \\Delta) = 1$，该表达式简化为：\n$$\nS_{\\Delta} = - \\frac{sp}{c(\\delta_{b} + \\Delta)^{2}}\n$$\n这是关于免疫介导杀伤率增加的灵敏度。\n\n最终结果是由这三个推导出的表达式组成的行矩阵：$[V^{\\ast}, S_{s}, S_{\\Delta}]$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta}  \\frac{p}{c(\\delta_{b} + \\Delta)}  -\\frac{sp}{c(\\delta_{b} + \\Delta)^{2}} \\end{pmatrix}}$$", "id": "2888047"}, {"introduction": "最后，我们将视角从单个宿主扩展到整个人群。有效的HIV预防策略必须系统性地整合生物医学干预（如抗逆转录病毒治疗ART和暴露前预防PrEP）、个人行为以及病毒传播所依赖的社交网络结构。这项高级练习将指导你构建一个综合性的数学模型，运用概率生成函数这一强大工具，来预测在复杂的接触网络中，各项预防措施组合使用时的预期效果，从而定量评估公共卫生干预的群体水平影响[@problem_id:2887979]。", "problem": "一个具有人类免疫缺陷病毒（HIV）和获得性免疫缺陷综合征（AIDS）风险的人群，由一个无向接触网络表示，其中每个节点代表一个个体，边代表在一个长度为一个单位的固定时间窗口内的同期性伴侣关系。您将对结合行为干预和生物医学预防措施下的预期单位时间间隔内HIV发病率（该时间间隔内人均新增感染数）进行建模，且仅从以下基本假设和定义出发：\n\n- 在没有任何预防措施的情况下，一名感染者和一名易感者之间的一次性行为导致传播的基线单次行为概率为 $p_0$。\n- 在每段伴侣关系中，性行为在整个时间间隔内独立发生，并且每段伴侣关系在该时间间隔内的行为次数是一个固定的整数 $c$，所有伴侣关系均相同。\n- 在某次行为中使用避孕套的事件以概率 $u$ 独立发生，并将单次行为的传播概率乘以一个因子 $(1 - e)$，其中 $e$ 是避孕套在预防单次行为传播方面的生物学有效性。\n- 行为改变可以同时修改：\n  - 避孕套使用概率，通过将 $u$ 乘以一个因子 $b_u$ 来实现，并约定有效使用概率被截断至单位区间，即 $\\min\\{1, b_u u\\}$。\n  - 接触网络度分布，通过将度数乘以一个因子 $b_d$ 来实现（对于下面给出的分布，这被解释为平均度的减少）。\n- 生物医学预防包括：\n  - 对感染者的抗逆转录病毒疗法（ART）覆盖，覆盖率为 $f_I \\in [0,1]$，其降低单次行为传染性的生物学有效性为 $r_I \\in [0,1]$，平均依从性为 $a_I \\in [0,1]$，该依从性线性调整生物学有效性。\n  - 对易感者的暴露前预防（PrEP）覆盖，覆盖率为 $f_S \\in [0,1]$，其降低单次行为易感性的生物学有效性为 $r_S \\in [0,1]$，平均依从性为 $a_S \\in [0,1]$，该依从性线性调整生物学有效性。\n- ART和PrEP状态在个体间是独立的，并且与行为中是否使用避孕套无关。所有对单次行为传播概率的乘法性降低效应以乘法方式结合。\n- 时间间隔开始时的初始感染比例（患病率）为 $i \\in [0,1]$。在给定患病率的条件下，感染状态的分布与度数无关。\n- 接触网络是一个配置模型类型的随机网络，其度分布为 $P(K=k)$，并且在上述假设下，邻居的感染状态相对于存根(stubs)是独立的。\n- 您可以利用以下事实：如果一个易感者的度为 $K$，且每个邻居以概率 $i$ 被感染，那么在给定 $K$ 的条件下，感染邻居的数量服从 $\\mathrm{Binomial}(K, i)$ 分布。您也可以使用度分布的概率生成函数 $G(s) = \\sum_{k=0}^{\\infty} P(K=k) s^k$ 作为工具来表示关于 $K$ 的期望。\n- 考虑三种容许的度分布，在应用度乘子 $b_d$ 之前，其参数化如下：\n  - 规则度 $k_0$（每个节点恰好有 $k_0$ 个伴侣）。\n  - 均值为 $z$ 的泊松分布。\n  - 在 $\\{0,1,2,\\dots\\}$ 上均值为 $m$ 的几何分布（即成功概率为 $p = 1/(1+m)$）。\n  行为改变后，对 $b_d$ 的调整解释如下：\n  - 规则网络：新的度为 $k' = b_d \\, k_0$，您可以假设在测试套件中 $k'$ 是一个整数。\n  - 泊松网络：新的均值为 $z' = b_d \\, z$。\n  - 几何网络：新的均值为 $m' = b_d \\, m$。\n- 所有代表比例的输出必须以小数形式表示，不得使用百分号。\n\n任务：\n\n- 仅根据这些假设，并使用独立伯努利试验和概率生成函数的基本原理，推导出一个关于参数 $\\{p_0, c, u, e, b_u, f_I, r_I, a_I, f_S, r_S, a_S, i\\}$ 和带有行为乘子 $b_d$ 的度分布的预期单位时间间隔内发病率的闭式表达式。您的表达式在根据所述调整进行解释时，必须对上面列出的三种度分布中的任何一种都有效。\n- 实现一个程序，为以下参数集的测试套件评估此预期发病率。对于每个测试案例，报告该时间间隔内的预期发病率，结果为浮点数，并精确到小数点后 $6$ 位。\n\n测试套件（每个项目符号为一个测试案例）：\n\n- 案例 A（泊松网络上的一般混合预防）：\n  - 度分布：均值为 $z = 3.0$ 的泊松分布，行为乘子 $b_d = 1.0$。\n  - 每段伴侣关系的行为次数：$c = 10$。\n  - 基线单次行为传播概率：$p_0 = 0.0013$。\n  - 避孕套使用：$u = 0.4$，避孕套有效性 $e = 0.9$，避孕套使用乘子 $b_u = 1.0$。\n  - ART：覆盖率 $f_I = 0.6$，有效性 $r_I = 0.96$，依从性 $a_I = 0.9$。\n  - PrEP：覆盖率 $f_S = 0.2$，有效性 $r_S = 0.86$，依从性 $a_S = 0.8$。\n  - 初始患病率：$i = 0.12$。\n- 案例 B（规则网络上的高度预防）：\n  - 度分布：度为 $k_0 = 4$ 的规则网络，行为乘子 $b_d = 1.0$。\n  - 每段伴侣关系的行为次数：$c = 8$。\n  - 基线单次行为传播概率：$p_0 = 0.0013$。\n  - 避孕套使用：$u = 0.8$，避孕套有效性 $e = 0.95$，避孕套使用乘子 $b_u = 1.0$。\n  - ART：覆盖率 $f_I = 0.9$，有效性 $r_I = 0.96$，依从性 $a_I = 0.95$。\n  - PrEP：覆盖率 $f_S = 0.5$，有效性 $r_S = 0.92$，依从性 $a_S = 0.9$。\n  - 初始患病率：$i = 0.10$。\n- 案例 C（泊松网络上的无预防基线）：\n  - 度分布：均值为 $z = 5.0$ 的泊松分布，行为乘子 $b_d = 1.0$。\n  - 每段伴侣关系的行为次数：$c = 12$。\n  - 基线单次行为传播概率：$p_0 = 0.0013$。\n  - 避孕套使用：$u = 0.0$，避孕套有效性 $e = 0.9$，避孕套使用乘子 $b_u = 1.0$。\n  - ART：覆盖率 $f_I = 0.0$，有效性 $r_I = 0.96$，依从性 $a_I = 1.0$。\n  - PrEP：覆盖率 $f_S = 0.0$，有效性 $r_S = 0.86$，依从性 $a_S = 1.0$。\n  - 初始患病率：$i = 0.10$。\n- 案例 D（几何网络上的行为改变导致度数减少和避孕套使用增加）：\n  - 度分布：均值为 $m = 2.0$ 的几何分布，行为乘子 $b_d = 0.5$。\n  - 每段伴侣关系的行为次数：$c = 10$。\n  - 基线单次行为传播概率：$p_0 = 0.0013$。\n  - 避孕套使用：$u = 0.5$，避孕套有效性 $e = 0.9$，避孕套使用乘子 $b_u = 1.2$。\n  - ART：覆盖率 $f_I = 0.5$，有效性 $r_I = 0.96$，依从性 $a_I = 0.8$。\n  - PrEP：覆盖率 $f_S = 0.3$，有效性 $r_S = 0.86$，依从性 $a_S = 0.7$。\n  - 初始患病率：$i = 0.10$。\n- 案例 E（边缘案例：规则网络上的零患病率）：\n  - 度分布：度为 $k_0 = 3$ 的规则网络，行为乘子 $b_d = 1.0$。\n  - 每段伴侣关系的行为次数：$c = 15$。\n  - 基线单次行为传播概率：$p_0 = 0.0013$。\n  - 避孕套使用：$u = 0.5$，避孕套有效性 $e = 0.9$，避孕套使用乘子 $b_u = 1.0$。\n  - ART：覆盖率 $f_I = 0.5$，有效性 $r_I = 0.96$，依从性 $a_I = 0.9$。\n  - PrEP：覆盖率 $f_S = 0.5$，有效性 $r_S = 0.92$，依从性 $a_S = 0.9$。\n  - 初始患病率：$i = 0.0$。\n- 案例 F（边缘案例：泊松网络上每段伴侣关系的行为次数为零）：\n  - 度分布：均值为 $z = 10.0$ 的泊松分布，行为乘子 $b_d = 1.0$。\n  - 每段伴侣关系的行为次数：$c = 0$。\n  - 基线单次行为传播概率：$p_0 = 0.0013$。\n  - 避孕套使用：$u = 0.5$，避孕套有效性 $e = 0.9$，避孕套使用乘子 $b_u = 1.0$。\n  - ART：覆盖率 $f_I = 0.5$，有效性 $r_I = 0.96$，依从性 $a_I = 0.9$。\n  - PrEP：覆盖率 $f_S = 0.5$，有效性 $r_S = 0.92$，依从性 $a_S = 0.9$。\n  - 初始患病率：$i = 0.20$。\n\n程序输出规范：\n\n- 您的程序必须生成单行输出，其中包含一个Python风格的列表，内含按上述案例顺序排列的 $6$ 个发病率结果，每个值都四舍五入到小数点后恰好 $6$ 位，例如 $[x_1,x_2,x_3,x_4,x_5,x_6]$，其中每个 $x_j$ 都是一个小数（无百分号）。", "solution": "该问题已经过验证，被认为是科学上合理的、提法得当且无矛盾的。所提供的假设是流行病学建模的标准假设，参数也在合理范围内。因此，可以推导出解决方案。\n\n目标是求出预期的单位时间间隔内HIV发病率，记为 $I_{frac}$。这被定义为预期的人均新增感染数。给定一个规模为 $N$、初始HIV患病率为 $i$ 的人群，易感个体数量为 $N(1-i)$。根据期望的线性性质，并假设所有易感个体在以其特定属性（如度或PrEP状态）为条件之前在统计上是等价的，发病率可以表示为：\n$$\nI_{frac} = \\frac{\\mathbb{E}[\\text{new infections}]}{N} = \\frac{N(1-i) \\times P(\\text{infection} | \\text{susceptible})}{N} = (1-i) P(\\text{infection} | \\text{susceptible})\n$$\n此处，$P(\\text{infection} | \\text{susceptible})$ 是指一个随机选择的易感个体在该时间间隔内被感染的概率。计算不被感染的概率 $P(\\text{no infection} | \\text{susceptible})$ 更为直接。\n$$\nP(\\text{infection} | \\text{susceptible}) = 1 - P(\\text{no infection} | \\text{susceptible})\n$$\n一个易感个体的状态根据其是否使用暴露前预防（PrEP）进行分层。比例为 $f_S$ 的易感者正在使用PrEP，比例为 $(1-f_S)$ 的易感者则没有。根据全概率定律：\n$$\nP(\\text{no infection} | \\text{susceptible}) = (1-f_S) P(\\text{no inf} | \\text{no PrEP}) + f_S P(\\text{no inf} | \\text{on PrEP})\n$$\n现在我们来确定一个度为 $K$ 的易感个体保持未被感染的概率。他们的 $K$ 个伴侣中的每一个都以概率 $i$ 独立地被感染。如果一个个体没有被其任何已感染的伴侣感染，那么他将保持未被感染状态。设 $q_{ns}$ 是在整个时间间隔内不被单个已感染伴侣感染的概率。如果一个个体有 $K_I$ 个已感染的伴侣，假设跨伴侣关系的传播事件是独立的，那么保持未感染的概率是 $(q_{ns})^{K_I}$。\n\n对于一个度为 $K$ 的易感个体，其感染伴侣的数量 $K_I$ 服从二项分布，$K_I \\sim \\mathrm{Binomial}(K, i)$。我们可以对感染伴侣的数量求平均：\n$$\nP(\\text{no infection} | K) = \\mathbb{E}_{K_I|K} \\left[ (q_{ns})^{K_I} \\right] = \\sum_{k_i=0}^{K} (q_{ns})^{k_i} \\binom{K}{k_i} i^{k_i} (1-i)^{K-k_i} = (i \\cdot q_{ns} + (1-i))^K\n$$\n这是 $( (1-i) + i \\cdot q_{ns} )^K$ 的二项式展开。\n\n为了得到无条件的保持未感染的概率，我们必须对度分布 $P(K=k)$ 求平均。这可以通过使用度分布的概率生成函数（PGF）$G(s) = \\mathbb{E}[s^K] = \\sum_k P(K=k) s^k$ 来实现。\n$$\nP(\\text{no infection}) = \\mathbb{E}_K[P(\\text{no infection} | K)] = \\mathbb{E}_K[(1 - i + i \\cdot q_{ns})^K] = G(1 - i + i \\cdot q_{ns})\n$$\n概率 $q_{ns}$ 取决于易感个体是否正在使用PrEP。首先，我们定义有效单次行为传播概率，它是一系列降低因子的乘积。有效的避孕套使用概率是 $u' = \\min\\{1, b_u u\\}$。从一个已感染伴侣的单次行为传播概率会因避孕套的使用和该伴侣的ART状态而降低。从一个随机已感染伴侣到一个未使用PrEP的易感者的平均单次行为传播概率是：\n$$\n\\tilde{p} = p_0 (1 - u'e) (1 - f_I r_I a_I)\n$$\n在一段伴侣关系中的 $c$ 次独立行为中，不被这一个伴侣感染的概率是 $(1-\\tilde{p})^c$。设此概率为 $q_{ns, noPrEP}$：\n$$\nq_{ns, noPrEP} = (1 - \\tilde{p})^c = \\left(1 - p_0 (1 - \\min\\{1, b_u u\\}e) (1 - f_I r_I a_I)\\right)^c\n$$\n对于一个正在使用PrEP的易感个体，其易感性会进一步乘以一个因子 $(1-r_S a_S)$ 而降低。单次行为的概率是 $\\tilde{p}(1-r_S a_S)$。不被一个已感染伴侣感染的概率是 $q_{ns, PrEP}$：\n$$\nq_{ns, PrEP} = (1 - \\tilde{p}(1 - r_S a_S))^c = \\left(1 - p_0 (1 - \\min\\{1, b_u u\\}e) (1 - f_I r_I a_I)(1 - r_S a_S)\\right)^c\n$$\n现在我们可以使用PGF来表示这两种易感类型的存活概率，其中PGF对应于应用了行为乘子 $b_d$ 后的度分布：\n设 $s_{noPrEP} = 1 - i + i \\cdot q_{ns, noPrEP}$ 和 $s_{PrEP} = 1 - i + i \\cdot q_{ns, PrEP}$。\n$$\nP(\\text{no inf} | \\text{no PrEP}) = G(s_{noPrEP})\n$$\n$$\nP(\\text{no inf} | \\text{on PrEP}) = G(s_{PrEP})\n$$\n一个随机易感者保持未感染的总概率是：\n$$\nP(\\text{no infection} | \\text{susceptible}) = (1-f_S)G(s_{noPrEP}) + f_S G(s_{PrEP})\n$$\n最后，将此代回 $I_{frac}$ 的表达式中：\n$$\nI_{frac} = (1-i) \\left[ 1 - \\left( (1-f_S)G(s_{noPrEP}) + f_S G(s_{PrEP}) \\right) \\right]\n$$\n行为修正后的度分布的PGFs是：\n1.  **规则网络**：原始度为 $k_0$，新度为 $k' = b_d k_0$。\n    $$G(s) = s^{k'}$$\n2.  **泊松网络**：原始均值为 $z$，新均值为 $z' = b_d z$。\n    $$G(s) = e^{z'(s-1)}$$\n3.  **几何网络**：原始均值为 $m$，新均值为 $m' = b_d m$。分布为 $P(k) = (1-p)^{k}p$，其中 $k=0,1,2,\\dots$ 且 $p=1/(1+m')$。\n    $$G(s) = \\frac{p}{1-(1-p)s} = \\frac{1/(1+m')}{1-s(m'/(1+m'))} = \\frac{1}{1+m'(1-s)}$$\n该实现将计算 $q_{ns, noPrEP}$ 和 $q_{ns, PrEP}$，然后计算它们对应的PGF参数 $s_{noPrEP}$ 和 $s_{PrEP}$。它会根据网络类型选择合适的PGF，在这些参数点上求值，根据PrEP覆盖率 $f_S$ 组合结果，并计算最终的发病率 $I_{frac}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It defines the test cases, calculates the incidence for each, and prints the formatted result.\n    \"\"\"\n\n    test_cases = [\n        # Case A: general mixed prevention on Poisson network\n        {\n            \"dist_type\": \"poisson\", \"dist_param\": 3.0, \"b_d\": 1.0, \"c\": 10, \"p_0\": 0.0013,\n            \"u\": 0.4, \"e\": 0.9, \"b_u\": 1.0, \"f_I\": 0.6, \"r_I\": 0.96, \"a_I\": 0.9,\n            \"f_S\": 0.2, \"r_S\": 0.86, \"a_S\": 0.8, \"i\": 0.12,\n        },\n        # Case B: high prevention on regular network\n        {\n            \"dist_type\": \"regular\", \"dist_param\": 4, \"b_d\": 1.0, \"c\": 8, \"p_0\": 0.0013,\n            \"u\": 0.8, \"e\": 0.95, \"b_u\": 1.0, \"f_I\": 0.9, \"r_I\": 0.96, \"a_I\": 0.95,\n            \"f_S\": 0.5, \"r_S\": 0.92, \"a_S\": 0.9, \"i\": 0.10,\n        },\n        # Case C: no prevention baseline on Poisson network\n        {\n            \"dist_type\": \"poisson\", \"dist_param\": 5.0, \"b_d\": 1.0, \"c\": 12, \"p_0\": 0.0013,\n            \"u\": 0.0, \"e\": 0.9, \"b_u\": 1.0, \"f_I\": 0.0, \"r_I\": 0.96, \"a_I\": 1.0,\n            \"f_S\": 0.0, \"r_S\": 0.86, \"a_S\": 1.0, \"i\": 0.10,\n        },\n        # Case D: behavior change reduces degree and increases condom use on geometric network\n        {\n            \"dist_type\": \"geometric\", \"dist_param\": 2.0, \"b_d\": 0.5, \"c\": 10, \"p_0\": 0.0013,\n            \"u\": 0.5, \"e\": 0.9, \"b_u\": 1.2, \"f_I\": 0.5, \"r_I\": 0.96, \"a_I\": 0.8,\n            \"f_S\": 0.3, \"r_S\": 0.86, \"a_S\": 0.7, \"i\": 0.10,\n        },\n        # Case E: edge case: zero prevalence on regular network\n        {\n            \"dist_type\": \"regular\", \"dist_param\": 3, \"b_d\": 1.0, \"c\": 15, \"p_0\": 0.0013,\n            \"u\": 0.5, \"e\": 0.9, \"b_u\": 1.0, \"f_I\": 0.5, \"r_I\": 0.96, \"a_I\": 0.9,\n            \"f_S\": 0.5, \"r_S\": 0.92, \"a_S\": 0.9, \"i\": 0.0,\n        },\n        # Case F: edge case: zero acts per partnership on Poisson network\n        {\n            \"dist_type\": \"poisson\", \"dist_param\": 10.0, \"b_d\": 1.0, \"c\": 0, \"p_0\": 0.0013,\n            \"u\": 0.5, \"e\": 0.9, \"b_u\": 1.0, \"f_I\": 0.5, \"r_I\": 0.96, \"a_I\": 0.9,\n            \"f_S\": 0.5, \"r_S\": 0.92, \"a_S\": 0.9, \"i\": 0.20,\n        },\n    ]\n\n    def pgf_regular(s, k_prime):\n        return s ** k_prime\n\n    def pgf_poisson(s, z_prime):\n        return np.exp(z_prime * (s - 1))\n\n    def pgf_geometric(s, m_prime):\n        if 1 + m_prime * (1 - s) == 0:\n            return np.inf  # Should not happen with valid inputs\n        return 1 / (1 + m_prime * (1 - s))\n\n    def calculate_incidence(params):\n        \"\"\"\n        Calculates the expected one-interval incidence fraction based on the derived formula.\n        \"\"\"\n        # Unpack parameters\n        dist_type = params[\"dist_type\"]\n        dist_param = params[\"dist_param\"]\n        b_d = params[\"b_d\"]\n        c = params[\"c\"]\n        p_0 = params[\"p_0\"]\n        u = params[\"u\"]\n        e = params[\"e\"]\n        b_u = params[\"b_u\"]\n        f_I = params[\"f_I\"]\n        r_I = params[\"r_I\"]\n        a_I = params[\"a_I\"]\n        f_S = params[\"f_S\"]\n        r_S = params[\"r_S\"]\n        a_S = params[\"a_S\"]\n        i = params[\"i\"]\n\n        # Handle edge cases for i and c\n        if i == 0.0 or c == 0:\n            return 0.0\n\n        # Step 1: Calculate effective parameters\n        u_prime = min(1.0, b_u * u)\n\n        # Step 2: Calculate per-act transmission probability from a random infected partner to a non-PrEP susceptible\n        p_tilde = p_0 * (1 - u_prime * e) * (1 - f_I * r_I * a_I)\n\n        # Step 3: Calculate probability of NOT being infected by one infected partner over c acts\n        # For a susceptible not on PrEP\n        q_ns_no_prep = (1 - p_tilde) ** c\n        # For a susceptible on PrEP\n        q_ns_prep = (1 - p_tilde * (1 - r_S * a_S)) ** c\n\n        # Step 4: Calculate PGF arguments\n        s_no_prep = 1 - i * (1 - q_ns_no_prep)\n        s_prep = 1 - i * (1 - q_ns_prep)\n        \n        # Step 5: Evaluate PGFs\n        if dist_type == \"regular\":\n            k_prime = b_d * dist_param\n            g_no_prep = pgf_regular(s_no_prep, k_prime)\n            g_prep = pgf_regular(s_prep, k_prime)\n        elif dist_type == \"poisson\":\n            z_prime = b_d * dist_param\n            g_no_prep = pgf_poisson(s_no_prep, z_prime)\n            g_prep = pgf_poisson(s_prep, z_prime)\n        elif dist_type == \"geometric\":\n            m_prime = b_d * dist_param\n            g_no_prep = pgf_geometric(s_no_prep, m_prime)\n            g_prep = pgf_geometric(s_prep, m_prime)\n        else:\n            raise ValueError(\"Unknown distribution type\")\n\n        # Step 6: Calculate overall probability of not being infected for a susceptible\n        prob_no_infection_given_susceptible = (1 - f_S) * g_no_prep + f_S * g_prep\n\n        # Step 7: Calculate final incidence fraction\n        incidence_fraction = (1 - i) * (1 - prob_no_infection_given_susceptible)\n\n        return incidence_fraction\n\n    results = []\n    for case in test_cases:\n        result = calculate_incidence(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2887979"}]}