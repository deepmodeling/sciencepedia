{"hands_on_practices": [{"introduction": "要研究菌群失调，我们首先需要一种量化其变化的方法。β多样性是衡量不同微生物群落组成差异的关键概念。本练习 [@problem_id:2846581] 将引导你使用一个标准生态学指标——Bray-Curtis相异度，来计算和比较由疾病和短期饮食变化引起的肠道菌群改变。通过这个实践，你将能理解如何定量地区分与疾病相关的显著菌群变化和生理性的正常波动。", "problem": "一个研究团队正在研究，伴随短期饮食转变而来的肠道微生物组组成变化，是否可以使用样本间多样性度量，来与疾病相关的菌群失调区分开。考虑五个黏膜相关菌群，其顺序如下：Clostridia（产丁酸）、Bacteroidia、Proteobacteria（Gammaproteobacteria）、Actinobacteria（Bifidobacterium）、Verrucomicrobia（Akkermansia）。通过相对丰度对三个样本进行了分析，每个样本的相对丰度总和为$1$：一个基线时的健康个体，记为$H$；同一个健康个体在经过为期两周的低纤维、高脂肪饮食后，记为$H_{\\mathrm{diet}}$；以及一个患有活动性炎症性肠病（IBD）的患者，记为$D$。相对丰度如下：\n- $H = (0.40,\\ 0.35,\\ 0.05,\\ 0.10,\\ 0.10)$\n- $H_{\\mathrm{diet}} = (0.35,\\ 0.38,\\ 0.10,\\ 0.05,\\ 0.12)$\n- $D = (0.18,\\ 0.20,\\ 0.45,\\ 0.10,\\ 0.07)$\n\n从 Bray–Curtis 相异度作为衡量非负丰度样本间组成差异（β多样性）指标的标准第一性原理定义出发，并仅利用以下事实：(i) 丰度为非负值，以及 (ii) 每个相对丰度向量的总和为$1$，请执行以下操作：\n\n1) 推导两个相对丰度向量之间的 Bray–Curtis 相异度的简化表达式，该表达式用按分量的最小值或按分量的绝对差表示。\n\n2) 使用您推导的表达式，计算样本对 $(H,\\ H_{\\mathrm{diet}})$ 和 $(H,\\ D)$ 的 Bray–Curtis 相异度。\n\n3) 将分离指数 $S$ 定义为这两个相异度之差，即 $S = \\Delta(H,\\ D) - \\Delta(H,\\ H_{\\mathrm{diet}})$，其中 $\\Delta(\\cdot,\\cdot)$ 表示 Bray–Curtis 相异度。计算 $S$ 的值，并用一句话解释，在此情境下，β多样性是否能将疾病相关的菌群失调与饮食引起的变化区分开。\n\n答案规格：\n- 将您的最终数值结果表示为一个单行矩阵，其中依次包含 $\\Delta(H,\\ H_{\\mathrm{diet}})$、$\\Delta(H,\\ D)$ 和 $S$。\n- 将所有三个条目四舍五入至四位有效数字。\n- 无需单位。", "solution": "该问题要求推导并应用 Bray-Curtis 相异度，以区分由饮食转变引起的微生物群落变化与疾病状态相关的变化。分析过程分为三个不同的部分：推导、计算和解释。\n\n首先，对问题陈述进行验证。\n问题提供了针对5个细菌分类单元的三个相对丰度向量：$H$、$H_{\\mathrm{diet}}$ 和 $D$。每个向量的分量都是非负的，且总和为1。目标是使用标准的生态学度量——Bray-Curtis 相异度，来量化和比较组成上的变化。该问题在微生物生态学和免疫学方面具有科学依据，提法明确且提供了所有必要信息，表述客观。不存在科学、逻辑或事实上的矛盾。因此，该问题被视为有效，可以构建解决方案。\n\n第1部分：简化的 Bray-Curtis 相异度表达式的推导。\n\n两个样本丰度向量 $X = (x_1, x_2, \\ldots, x_N)$ 和 $Y = (y_1, y_2, \\ldots, y_N)$ 之间的 Bray-Curtis 相异度 $\\Delta(X, Y)$ 的标准定义由下式给出：\n$$\n\\Delta(X, Y) = \\frac{\\sum_{i=1}^N |x_i - y_i|}{\\sum_{i=1}^N (x_i + y_i)}\n$$\n此定义对任何非负丰度数据都有效。问题指明，这些向量代表相对丰度，这就施加了每个向量的分量总和为$1$的约束。\n$$\n\\sum_{i=1}^N x_i = 1\n$$\n$$\n\\sum_{i=1}^N y_i = 1\n$$\n这个约束显著简化了相异度公式的分母。通过应用求和的可加性：\n$$\n\\sum_{i=1}^N (x_i + y_i) = \\sum_{i=1}^N x_i + \\sum_{i=1}^N y_i = 1 + 1 = 2\n$$\n将此结果代入原始定义，得到相对丰度向量的简化表达式：\n$$\n\\Delta(X, Y) = \\frac{\\sum_{i=1}^N |x_i - y_i|}{2} = \\frac{1}{2} \\sum_{i=1}^N |x_i - y_i|\n$$\n这就是所要求的用按分量的绝对差表示的表达式。\n\n为了完整起见，我们推导用按分量的最小值表示的等价表达式。Bray-Curtis 相似度 $C_{BC}$ 定义为：\n$$\nC_{BC}(X, Y) = \\frac{2 \\sum_{i=1}^N \\min(x_i, y_i)}{\\sum_{i=1}^N (x_i + y_i)}\n$$\n对于相对丰度，分母为$2$，因此相似度变为按分量的最小值之和：\n$$\nC_{BC}(X, Y) = \\sum_{i=1}^N \\min(x_i, y_i)\n$$\n那么相异度为 $\\Delta = 1 - C_{BC}$，即：\n$$\n\\Delta(X, Y) = 1 - \\sum_{i=1}^N \\min(x_i, y_i)\n$$\n这两种形式是等价的，可以通过使用恒等式 $|a - b| = a + b - 2\\min(a, b)$（对于任意非负数 $a$ 和 $b$）来证实。对于分量总和为1的向量 $X$ 和 $Y$，对所有分量求和可得 $\\sum |x_i - y_i| = \\sum x_i + \\sum y_i - 2\\sum\\min(x_i, y_i) = 1 + 1 - 2\\sum\\min(x_i, y_i) = 2(1 - \\sum\\min(x_i, y_i))$。两边除以2即可证明其等价性。在后续的计算中，将使用基于绝对差的形式。\n\n第2部分：成对相异度的计算。\n\n给定的相对丰度向量为：\n$H = (0.40, 0.35, 0.05, 0.10, 0.10)$\n$H_{\\mathrm{diet}} = (0.35, 0.38, 0.10, 0.05, 0.12)$\n$D = (0.18, 0.20, 0.45, 0.10, 0.07)$\n\n首先，我们计算健康基线样本与饮食转变后样本之间的相异度 $\\Delta(H, H_{\\mathrm{diet}})$。\n绝对差之和为：\n$$\n\\sum_{i=1}^5 |H_i - H_{\\mathrm{diet}, i}| = |0.40 - 0.35| + |0.35 - 0.38| + |0.05 - 0.10| + |0.10 - 0.05| + |0.10 - 0.12|\n$$\n$$\n= 0.05 + 0.03 + 0.05 + 0.05 + 0.02 = 0.20\n$$\nBray-Curtis 相异度为：\n$$\n\\Delta(H, H_{\\mathrm{diet}}) = \\frac{1}{2} \\times 0.20 = 0.10\n$$\n\n接下来，我们计算健康基线样本与疾病样本之间的相异度 $\\Delta(H, D)$。\n绝对差之和为：\n$$\n\\sum_{i=1}^5 |H_i - D_i| = |0.40 - 0.18| + |0.35 - 0.20| + |0.05 - 0.45| + |0.10 - 0.10| + |0.10 - 0.07|\n$$\n$$\n= 0.22 + 0.15 + 0.40 + 0.00 + 0.03 = 0.80\n$$\nBray-Curtis 相异度为：\n$$\n\\Delta(H, D) = \\frac{1}{2} \\times 0.80 = 0.40\n$$\n\n第3部分：分离指数 $S$ 的计算与解释。\n\n分离指数 $S$ 定义为两个已计算相异度之差：\n$$\nS = \\Delta(H, D) - \\Delta(H, H_{\\mathrm{diet}})\n$$\n使用第2部分计算出的值：\n$$\nS = 0.40 - 0.10 = 0.30\n$$\n$\\Delta(H, H_{\\mathrm{diet}})$ 的值代表由饮食引起的组成变化的幅度，而 $\\Delta(H, D)$ 代表与疾病相关的变化幅度，两者都是相对于健康基线而言。与疾病相关的相异度值（$\\Delta=0.40$）是饮食转变引起的相异度值（$\\Delta=0.10$）的四倍。正的分离指数 $S=0.30$ 量化了这一差异。\n\n解释：正的分离指数表明，通过 Bray-Curtis 相异度测量的β多样性，能有效地将与疾病相关的较大组成变化同饮食引起的较小变化区分开来。\n\n最后，将结果 $\\Delta(H, H_{\\mathrm{diet}}) = 0.10$、$\\Delta(H, D) = 0.40$ 和 $S = 0.30$ 按要求四舍五入到四位有效数字，得到 $0.1000$、$0.4000$ 和 $0.3000$。这些结果将以指定的矩阵格式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1000  0.4000  0.3000 \\end{pmatrix}}\n$$", "id": "2846581"}, {"introduction": "在量化了菌群变化之后，下一个关键问题是探究其背后的生态学机制。生态位理论为我们提供了理解微生物与其环境相互作用的强大框架。本练习 [@problem_id:2846613] 构建了一个基于Monod动力学和李比希最低量定律的模型，以阐明肠道炎症如何通过产生新的电子受体（如硝酸盐和氧气）来重塑肠道微环境，从而为肠杆菌科等兼性厌氧菌提供竞争优势。这个模型生动地展示了宿主免疫反应如何主动选择并驱动特定细菌的“疯长”，这是菌群失调中的一个典型现象。", "problem": "哺乳动物肠道内的炎症会产生宿主衍生的电子受体，从而重塑生态位。诱导型一氧化氮合酶 (iNOS) 产生氮氧化物，这些氮氧化物被氧化成硝酸盐；同时，活性氧 (ROS) 会使少量氧气渗漏到邻近肠腔的黏液层中。根据生态位理论和 Liebig 最低量定律，微生物的实现生长速率受相关生态位轴上最限制性资源的限制（此处为电子供体和电子受体）。考虑一个充分混合的黏液微生境，其中恒定供应浓度为 $C$ 的有机碳源，以及两种宿主衍生的电子受体：浓度为 $O$ 的氧气和浓度为 $N$ 的硝酸盐。两个功能群相互竞争：一个类似肠杆菌科 (Enterobacteriaceae) 的兼性厌氧菌 $E$，它可以使用氧气或硝酸盐进行呼吸作用；另一个是专性厌氧发酵菌 $A$，它不利用 $O$ 或 $N$ 进行呼吸。\n\n假设生长遵循 Monod 动力学和 Liebig 定律。物种 $E$ 使用氧气呼吸时的比生长速率为\n$$\n\\mu_{E,O} \\;=\\; \\mu^{\\max}_{E,O}\\,\\min\\!\\left(\\frac{C}{K_{C,E} + C},\\,\\frac{O}{K_{O} + O}\\right),\n$$\n使用硝酸盐呼吸时的比生长速率为\n$$\n\\mu_{E,N} \\;=\\; \\mu^{\\max}_{E,N}\\,\\min\\!\\left(\\frac{C}{K_{C,E} + C},\\,\\frac{N}{K_{N} + N}\\right).\n$$\n物种 $E$ 会采用能产生更高实现速率的呼吸模式，即\n$$\n\\mu_{E} \\;=\\; \\max\\!\\left(\\mu_{E,O},\\,\\mu_{E,N}\\right).\n$$\n专性厌氧菌 $A$ 发酵相同的碳源，其比生长速率为\n$$\n\\mu_{A} \\;=\\; \\mu^{\\max}_{A}\\,\\frac{C}{K_{C,A} + C}.\n$$\n\n给定以下代表发炎状态下黏液微环境的参数值：碳源 $C = 10\\,\\mathrm{mM}$，氧气 $O = 5\\,\\mu\\mathrm{M}$，硝酸盐 $N = 200\\,\\mu\\mathrm{M}$；对于物种 $E$：$\\mu^{\\max}_{E,O} = 1.2\\,\\mathrm{h}^{-1}$，$\\mu^{\\max}_{E,N} = 0.8\\,\\mathrm{h}^{-1}$，$K_{C,E} = 2\\,\\mathrm{mM}$，$K_{O} = 1\\,\\mu\\mathrm{M}$，$K_{N} = 50\\,\\mu\\mathrm{M}$；对于物种 $A$：$\\mu^{\\max}_{A} = 0.5\\,\\mathrm{h}^{-1}$，$K_{C,A} = 1\\,\\mathrm{mM}$。\n\n以生态位理论为概念基础，简要说明在这些条件下，为何炎症期间产生的宿主衍生氧和硝酸盐，相比于专性厌氧菌，更有利于类似肠杆菌科 (Enterobacteriaceae) 生物的爆发性增殖，然后计算倍数生长优势\n$$\nR \\;=\\; \\frac{\\mu_{E}}{\\mu_{A}}.\n$$\n将 $R$ 以无量纲数的形式报告。将答案四舍五入到三位有效数字。", "solution": "问题陈述已提交以供验证。\n\n**步骤 1：提取已知条件**\n\n明确的已知条件是：\n资源浓度：\n- 碳源：$C = 10\\,\\mathrm{mM}$\n- 氧气：$O = 5\\,\\mu\\mathrm{M}$\n- 硝酸盐：$N = 200\\,\\mu\\mathrm{M}$\n\n兼性厌氧菌 $E$ 的生长速率模型：\n- 使用氧气时的比生长速率：$\\mu_{E,O} = \\mu^{\\max}_{E,O}\\,\\min\\!\\left(\\frac{C}{K_{C,E} + C},\\,\\frac{O}{K_{O} + O}\\right)$\n- 使用硝酸盐时的比生长速率：$\\mu_{E,N} = \\mu^{\\max}_{E,N}\\,\\min\\!\\left(\\frac{C}{K_{C,E} + C},\\,\\frac{N}{K_{N} + N}\\right)$\n- 总比生长速率：$\\mu_{E} = \\max\\!\\left(\\mu_{E,O},\\,\\mu_{E,N}\\right)$\n\n物种 $E$ 的参数：\n- 使用氧气时的最大比生长速率：$\\mu^{\\max}_{E,O} = 1.2\\,\\mathrm{h}^{-1}$\n- 使用硝酸盐时的最大比生长速率：$\\mu^{\\max}_{E,N} = 0.8\\,\\mathrm{h}^{-1}$\n- 碳的半饱和常数：$K_{C,E} = 2\\,\\mathrm{mM}$\n- 氧的半饱和常数：$K_{O} = 1\\,\\mu\\mathrm{M}$\n- 硝酸盐的半饱和常数：$K_{N} = 50\\,\\mu\\mathrm{M}$\n\n专性厌氧菌 $A$ 的生长速率模型：\n- 比生长速率：$\\mu_{A} = \\mu^{\\max}_{A}\\,\\frac{C}{K_{C,A} + C}$\n\n物种 $A$ 的参数：\n- 最大比生长速率：$\\mu^{\\max}_{A} = 0.5\\,\\mathrm{h}^{-1}$\n- 碳的半饱和常数：$K_{C,A} = 1\\,\\mathrm{mM}$\n\n目标：\n- 解释为什么炎症对物种 $E$ 比对物种 $A$ 更有利。\n- 计算倍数生长优势 $R = \\frac{\\mu_{E}}{\\mu_{A}}$。\n- 将 $R$ 报告并四舍五入到三位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据充分：** 该问题牢固地建立在微生物生态学和免疫学的既定原则之上。它使用了 Monod 动力学和 Liebig 最低量定律，这些都是微生物生长的标准数学模型。所描述的情景——炎症驱动电子受体的产生，从而有利于肠杆菌科 (Enterobacteriaceae) 的爆发性增殖——是一个有充分文献记载的现象。所给出的参数值被说明是具有代表性的，并且在生物学上是合理的。\n2.  **问题定义良好：** 这是一个良态问题。所有必要的方程、变量和常数都已提供，可以计算出生长优势比 $R$ 的唯一数值解。\n3.  **客观性：** 问题陈述是客观的，并使用了精确的技术语言。它不包含主观或基于观点的论断。\n4.  **完整性与一致性：** 该问题是自洽的。计算所需的所有参数值都已给出。每个 Monod 项内的单位是一致的（例如，$C$ 和 $K_{C,E}$ 的单位都是 $\\mathrm{mM}$；$O$ 和 $K_{O}$ 的单位都是 $\\mu\\mathrm{M}$），这使得饱和项按要求成为无量纲的。\n\n**步骤 3：结论与行动**\n\n该问题是有效的。它科学合理、定义良好、客观，并包含所有必要信息。继续进行求解。\n\n解决方案需要两部分：一个概念性解释和一个定量计算。\n\n**概念性解释**\n\n生态位理论主张，一个生物体的生态成功取决于其性状和环境中资源的可用性。在哺乳动物肠道的背景下，主要的生态位维度包括可用的营养物（如碳源等电子供体）和电子受体。\n\n在健康、稳态的肠道中，环境是严格厌氧的。由于缺乏如氧和硝酸盐等强效电子受体，代谢格局由发酵主导。像专性厌氧菌 $A$ 这样的生物高度适应这个生态位，为可发酵的碳源而竞争。像 $E$ 这样的兼性厌氧菌也必须依赖发酵，这是一个比呼吸作用能量效率低的过程。\n\n炎症从根本上改变了生态位。宿主的免疫反应涉及诱导型一氧化氮合酶 (iNOS) 和 NADPH 氧化酶等酶，会产生高活性的氮和氧物质。这些物质被转化为硝酸盐 ($NO_3^−$)，并将微量的氧气 ($O_2$) 引入肠腔，尤其是在上皮细胞附近。\n\n这个由宿主驱动的过程通过引入先前不存在的电子受体，创造了新的生态位机会。根据问题的模型，兼性厌氧菌 $E$ 能够利用氧气和硝酸盐进行呼吸。与发酵相比，呼吸作用从每摩尔碳源中产生的能量要多得多，这转化为更高的潜在生长速率 ($\\mu^{\\max}$)。根据定义，专性厌氧菌 $A$ 不能利用这些电子受体。其生长仍然受到发酵效率的限制。\n\n因此，宿主炎症反应引入的氧和硝酸盐为类似肠杆菌科 (Enterobacteriaceae) 的生物 ($E$) 提供了明显的竞争优势。它们能够转换到更高效的代谢方式（呼吸作用），使其生长速度超过专性厌氧菌 ($A$)，后者是适应非发炎、厌氧环境的专家。这种基于资源的优势解释了在与肠道炎症相关的菌群失调期间，这类兼性厌氧菌特有的“爆发性增殖”现象。\n\n**定量计算**\n\n我们的任务是计算倍数生长优势 $R = \\frac{\\mu_{E}}{\\mu_{A}}$。这需要在给定条件下计算比生长速率 $\\mu_{E}$ 和 $\\mu_{A}$。\n\n首先，我们计算专性厌氧菌的生长速率 $\\mu_{A}$：\n$$\n\\mu_{A} = \\mu^{\\max}_{A}\\,\\frac{C}{K_{C,A} + C}\n$$\n代入给定值：\n$C = 10\\,\\mathrm{mM}$，$K_{C,A} = 1\\,\\mathrm{mM}$，$\\mu^{\\max}_{A} = 0.5\\,\\mathrm{h}^{-1}$。\n$$\n\\mu_{A} = 0.5\\,\\mathrm{h}^{-1} \\times \\frac{10}{1 + 10} = 0.5\\,\\mathrm{h}^{-1} \\times \\frac{10}{11} = \\frac{5}{11}\\,\\mathrm{h}^{-1}\n$$\n\n接下来，我们计算兼性厌氧菌的生长速率 $\\mu_{E}$。这首先需要计算通过氧呼吸和硝酸盐呼吸的潜在生长速率 $\\mu_{E,O}$ 和 $\\mu_{E,N}$，然后选择其中的最大值。\n\n我们计算各个 Monod 饱和项：\n- 碳源项：$\\frac{C}{K_{C,E} + C} = \\frac{10}{2 + 10} = \\frac{10}{12} = \\frac{5}{6}$\n- 氧气项：$\\frac{O}{K_{O} + O} = \\frac{5}{1 + 5} = \\frac{5}{6}$\n- 硝酸盐项：$\\frac{N}{K_{N} + N} = \\frac{200}{50 + 200} = \\frac{200}{250} = \\frac{4}{5}$\n\n现在，我们使用 Liebig 最低量定律计算 $\\mu_{E,O}$：\n$$\n\\mu_{E,O} = \\mu^{\\max}_{E,O}\\,\\min\\!\\left(\\frac{C}{K_{C,E} + C},\\,\\frac{O}{K_{O} + O}\\right)\n$$\n当 $\\mu^{\\max}_{E,O} = 1.2\\,\\mathrm{h}^{-1}$ 时：\n$$\n\\mu_{E,O} = 1.2\\,\\mathrm{h}^{-1} \\times \\min\\!\\left(\\frac{5}{6}, \\frac{5}{6}\\right) = 1.2\\,\\mathrm{h}^{-1} \\times \\frac{5}{6} = \\frac{6}{5}\\,\\mathrm{h}^{-1} \\times \\frac{5}{6} = 1.0\\,\\mathrm{h}^{-1}\n$$\n在这种情况下，生长同时受到碳和氧的限制。\n\n接下来，我们计算 $\\mu_{E,N}$：\n$$\n\\mu_{E,N} = \\mu^{\\max}_{E,N}\\,\\min\\!\\left(\\frac{C}{K_{C,E} + C},\\,\\frac{N}{K_{N} + N}\\right)\n$$\n当 $\\mu^{\\max}_{E,N} = 0.8\\,\\mathrm{h}^{-1}$。我们必须比较碳源项和硝酸盐项：$\\frac{5}{6} \\approx 0.833$ 和 $\\frac{4}{5} = 0.8$。最小值是硝酸盐项。\n$$\n\\mu_{E,N} = 0.8\\,\\mathrm{h}^{-1} \\times \\min\\!\\left(\\frac{5}{6}, \\frac{4}{5}\\right) = 0.8\\,\\mathrm{h}^{-1} \\times \\frac{4}{5} = \\frac{4}{5}\\,\\mathrm{h}^{-1} \\times \\frac{4}{5} = \\frac{16}{25}\\,\\mathrm{h}^{-1} = 0.64\\,\\mathrm{h}^{-1}\n$$\n在这种情况下，生长受到硝酸盐可用性的限制。\n\n物种 $E$ 的实际生长速率是两种呼吸途径可达到的速率中的最大值：\n$$\n\\mu_{E} = \\max(\\mu_{E,O}, \\mu_{E,N}) = \\max(1.0\\,\\mathrm{h}^{-1}, 0.64\\,\\mathrm{h}^{-1}) = 1.0\\,\\mathrm{h}^{-1}\n$$\n物种 $E$ 将优先使用氧呼吸，因为它能产生更高的生长速率。\n\n最后，我们计算倍数生长优势比 $R$：\n$$\nR = \\frac{\\mu_{E}}{\\mu_{A}} = \\frac{1.0\\,\\mathrm{h}^{-1}}{\\frac{5}{11}\\,\\mathrm{h}^{-1}} = \\frac{11}{5} = 2.2\n$$\n问题要求答案四舍五入到三位有效数字。\n\n$R = 2.20$", "answer": "$$\n\\boxed{2.20}\n$$", "id": "2846613"}, {"introduction": "菌群失调的最终影响体现在其对宿主免疫系统的调节上，特别是对适应性免疫平衡的破坏。在肠道中，辅助性T细胞17（Th17）和调节性T细胞（Treg）的平衡对于维持免疫稳态至关重要。本练习 [@problem_id:2846629] 采用系统生物学的方法，构建一个包含关键细胞因子（如IL-6和TGF-β）和转录因子（如RORγt和Foxp3）的动力学模型。通过这个练习，你将学习如何将复杂的免疫调控网络转化为数学方程，并预测来自微生物的“菌群失调”信号如何打破平衡，使免疫反应倾向于促炎的Th17表型。", "problem": "为涉及白细胞介素-6 (IL-6)、转化生长因子-β (TGF-β)、RAR相关孤儿受体γt (RORγt) 和叉头框蛋白P3 (Foxp3) 的耦合免疫调节网络，构建一个机制性的、无量纲的动力学系统，该系统能够捕捉微生物刺激如何调节T调节细胞 (Treg) 与T辅助细胞17 (Th17) 之间的平衡。使用平衡法则原理，即对于任何物种 $X$，其时间演化由 $dX/dt = \\text{合成} - \\text{清除}$ 给出，并使用基于受体-配体和基因调控激活/抑制的可饱和Hill函数来模拟调控过程。\n\n将状态变量定义如下：$I$ 代表 IL-6，$T$ 代表 TGF-β，$R$ 代表 RORγt，$F$ 代表 Foxp3，每个变量都代表一个无量纲的浓度。令 $M \\ge 0$ 代表一个无量纲的微生物刺激水平（作为菌群失调强度的代理）。使用以下Hill型函数：激活函数 $H(x;K,n) = x^n/(K^n + x^n)$ 和抑制函数 $J(x;K,n) = 1/(1+(x/K)^n)$。假设合成是相应激活和抑制作用的乘积，清除为一级反应。\n\n你的任务是 (i) 写出以下常微分方程组，该方程组需符合以下免疫学原理：TGF-β与IL-6共同促进RORγt，TGF-β单独促进Foxp3而IL-6抑制它，Foxp3和RORγt相互拮抗，IL-6由基础水平、微生物和表达RORγt的细胞产生，TGF-β由基础水平和表达Foxp3的细胞产生：\n$$\n\\frac{dI}{dt} = p_{I0} + p_{IM}\\,M + p_{IR}\\,H\\!\\left(R;K_{R\\to I},n_{R\\to I}\\right) - d_I\\,I,\n$$\n$$\n\\frac{dT}{dt} = p_{T0} + p_{TF}\\,H\\!\\left(F;K_{F\\to T},n_{F\\to T}\\right) - d_T\\,T,\n$$\n$$\n\\frac{dR}{dt} = k_R\\,H\\!\\left(T;K_{T\\to R},n_{T\\to R}\\right)\\,H\\!\\left(I;K_{I\\to R},n_{I\\to R}\\right)\\,J\\!\\left(F;K_{F\\dashv R},n_{F\\dashv R}\\right) - d_R\\,R,\n$$\n$$\n\\frac{dF}{dt} = k_F\\,H\\!\\left(T;K_{T\\to F},n_{T\\to F}\\right)\\,J\\!\\left(I;K_{I\\dashv F},n_{I\\dashv F}\\right)\\,J\\!\\left(R;K_{R\\dashv F},n_{R\\dashv F}\\right) - d_F\\,F.\n$$\n\n所有量均为无量纲且单位任意但一致，清除速率常数的单位为任意时间单位的倒数。对所有测试用例使用以下固定参数值：\n- IL-6模块：$p_{I0} = 0.05$, $p_{IM} = 1.5$, $p_{IR} = 0.5$, $d_I = 1.0$, $K_{R\\to I} = 1.0$, $n_{R\\to I} = 2.0$。\n- TGF-β模块：$p_{T0} = 0.05$, $p_{TF} = 0.8$, $d_T = 0.5$, $K_{F\\to T} = 1.0$, $n_{F\\to T} = 2.0$。\n- RORγt模块：$k_R = 1.2$, $d_R = 0.3$, $K_{T\\to R} = 0.5$, $n_{T\\to R} = 2.0$, $K_{I\\to R} = 0.5$, $n_{I\\to R} = 2.0$, $K_{F\\dashv R} = 0.7$, $n_{F\\dashv R} = 2.0$。\n- Foxp3模块：$k_F = 1.0$, $d_F = 0.3$, $K_{T\\to F} = 0.4$, $n_{T\\to F} = 2.0$, $K_{I\\dashv F} = 0.5$, $n_{I\\dashv F} = 2.0$, $K_{R\\dashv F} = 0.7$, $n_{R\\dashv F} = 2.0$。\n\n对于给定的 $M$，将稳态定义为任何满足四个方程右侧等于 $0$ 的 $(I^\\ast,T^\\ast,R^\\ast,F^\\ast)$。将 Treg/Th17 比率定义为稳态比值 $F^\\ast/R^\\ast$（无量纲）。如果 $R^\\ast$ 在数值上与 $0$ 无法区分，则通过除以 $\\max(R^\\ast,\\epsilon)$ 来将其视为一个大的有限数，其中 $\\epsilon > 0$ 是一个固定的小数；取 $\\epsilon = 10^{-9}$。\n\n实现一个程序，对于下面指定的每个 $M$ 值，数值计算出一个正稳态，并返回相应的 Treg/Th17 比率 $F^\\ast/R^\\ast$，保留 $3$ 位小数：\n- 测试集微生物输入 $M$：$[0.0, 0.2, 1.0, 3.0, 10.0]$。\n\n你的程序必须：\n- 仅使用给定的参数值和上述定义。\n- 确保计算出的稳态所有四个变量均为非负。\n- 尝试通过求根法直接求解稳态方程；如果无法得到满意的解，则回退到对常微分方程进行前向时间积分以逼近稳态。\n- 对于每个 $M$，输出一个等于 $F^\\ast/R^\\ast$ 的浮点数，保留 $3$ 位小数。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果（例如，\"[x1,x2,x3,x4,x5]\"），其中每个 $x_i$ 是对应于测试集顺序中相应 $M$ 值的四舍五入后的浮点数。不应打印任何额外文本。因为所有量都是无量纲的，所以输出中不需要物理单位。本问题不涉及角度，也不使用百分比；所有比率均表示为保留 $3$ 位小数的十进制数。", "solution": "所提出的问题是计算系统生物学中的一个有效练习。它具有科学依据，问题定义明确且客观。它提供了一整套方程、参数和一个明确的计算目标。我将继续进行求解。\n\n该问题要求分析一个动力学系统，该系统模拟了T辅助细胞分化为T调节细胞 (Treg) 和T辅助细胞17 (Th17) 亚型的过程，这是一个由细胞因子和转录因子相互作用调控的过程。系统状态由四种物质的无量纲浓度描述：Interleukin-6 ($I$)、Transforming Growth Factor-β ($T$)、RORγt ($R$) 和 Foxp3 ($F$)。该系统的动力学由一组四个耦合的常微分方程 (ODE) 控制，其中每个物种 $X$ 的演化遵循平衡法则 $\\frac{dX}{dt} = \\text{合成} - \\text{清除}$。调控相互作用使用标准的Hill函数建模：激活函数 $H(x; K, n) = \\frac{x^n}{K^n + x^n}$ 和抑制函数 $J(x; K, n) = \\frac{1}{1 + (x/K)^n}$。\n\n完整的常微分方程组如下：\n$$\n\\frac{dI}{dt} = p_{I0} + p_{IM}\\,M + p_{IR}\\,H(R; K_{R\\to I}, n_{R\\to I}) - d_I\\,I\n$$\n$$\n\\frac{dT}{dt} = p_{T0} + p_{TF}\\,H(F; K_{F\\to T}, n_{F\\to T}) - d_T\\,T\n$$\n$$\n\\frac{dR}{dt} = k_R\\,H(T; K_{T\\to R}, n_{T\\to R})\\,H(I; K_{I\\to R}, n_{I\\to R})\\,J(F; K_{F\\dashv R}, n_{F\\dashv R}) - d_R\\,R\n$$\n$$\n\\frac{dF}{dt} = k_F\\,H(T; K_{T\\to F}, n_{T\\to F})\\,J(I; K_{I\\dashv F}, n_{I\\dashv F})\\,J(R; K_{R\\dashv F}, n_{R\\dashv F}) - d_F\\,F\n$$\n在这里，$M$ 是外部微生物刺激输入。所有参数都提供了固定的数值。\n\n目标是为指定的 $M$ 值找到一个非负稳态 $(I^\\ast, T^\\ast, R^\\ast, F^\\ast)$。稳态是状态空间中的一个点，在该点系统不再演化，即所有时间导数均为零。令 $\\frac{dI}{dt} = \\frac{dT}{dt} = \\frac{dR}{dt} = \\frac{dF}{dt} = 0$ 将常微分方程组转化为一个关于变量 $I, T, R, F$ 的四个耦合的非线性代数方程组。\n\n需要一种数值方法来求解该系统。问题中指定的方案是一个稳健的两阶段策略：\n1.  **求根法**：主要方法是求解代数方程组 $f(y) = 0$，其中 $y = (I, T, R, F)$，$f$ 是常微分方程右侧项组成的向量。为此，我们使用 `scipy.optimize.root` 函数。由于迭代数值求解器对初始猜测值很敏感，我们尝试从状态空间中两个不同的合理点开始寻找解。只有当求解器成功收敛且所得状态向量的所有分量均为非负时，解才被认为是有效的，因为负浓度在物理上是无意义的。\n\n2.  **时间积分（备用方案）**：如果求根法未能产生物理上有效的解，我们采取备用策略。我们通过从一个确定的初始条件开始对常微分方程进行数值积分，来模拟系统的时间演化，直到达到稳态。我们使用 `scipy.integrate.solve_ivp` 函数，并选用一个适合潜在刚性系统的求解器。通过从零浓度状态（即 $y_0 = (0, 0, 0, 0)$）开始积分，我们模拟了系统从基态的响应。这种方法保证了非负性，因为模型中的产生项总是非负的，确保了浓度不会降到零以下。积分在足够长的时间间隔内进行，以确保收敛到一个稳定的稳态，其值即为模拟结束时的最终状态向量。\n\n一旦为给定的 $M$ 值确定了一个有效的非负稳态 $(I^\\ast, T^\\ast, R^\\ast, F^\\ast)$，就可以计算 Treg/Th17 比率。该比率定义为 $F^\\ast / R^\\ast$。为了处理 $R^\\ast$ 接近或等于零的情况（这代表一个Th17群体可忽略不计的状态），该比率计算为 $F^\\ast / \\max(R^\\ast, \\epsilon)$，使用一个小的正则化常数 $\\epsilon = 10^{-9}$。\n\n对提供的测试集中的每个 $M$ 值应用此计算过程。所得比率四舍五入到小数点后 $3$ 位，并按指定格式呈现。\n\n```python\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the steady state of the Treg/Th17 immunoregulatory network\n    and calculates the F-star/R-star ratio for different microbial stimulation levels.\n    \"\"\"\n\n    # Fixed parameter values for the model\n    params = {\n        # IL-6 module\n        'p_I0': 0.05, 'p_IM': 1.5, 'p_IR': 0.5, 'd_I': 1.0,\n        'K_R_to_I': 1.0, 'n_R_to_I': 2.0,\n        # TGF-beta module\n        'p_T0': 0.05, 'p_TF': 0.8, 'd_T': 0.5,\n        'K_F_to_T': 1.0, 'n_F_to_T': 2.0,\n        # RORgt module\n        'k_R': 1.2, 'd_R': 0.3, 'K_T_to_R': 0.5, 'n_T_to_R': 2.0,\n        'K_I_to_R': 0.5, 'n_I_to_R': 2.0, 'K_F_inh_R': 0.7, 'n_F_inh_R': 2.0,\n        # Foxp3 module\n        'k_F': 1.0, 'd_F': 0.3, 'K_T_to_F': 0.4, 'n_T_to_F': 2.0,\n        'K_I_inh_F': 0.5, 'n_I_inh_F': 2.0, 'K_R_inh_F': 0.7, 'n_R_inh_F': 2.0,\n    }\n\n    # Hill functions\n    def H(x, K, n):\n        # Activation\n        x_safe = max(0, x)\n        return x_safe**n / (K**n + x_safe**n)\n\n    def J(x, K, n):\n        # Inhibition\n        x_safe = max(0, x)\n        return 1.0 / (1.0 + (x_safe / K)**n)\n\n    def ode_system(t, y, M, p):\n        I, T, R, F = y\n\n        # dI/dt\n        h_R_I = H(R, p['K_R_to_I'], p['n_R_to_I'])\n        dI_dt = p['p_I0'] + p['p_IM'] * M + p['p_IR'] * h_R_I - p['d_I'] * I\n\n        # dT/dt\n        h_F_T = H(F, p['K_F_to_T'], p['n_F_to_T'])\n        dT_dt = p['p_T0'] + p['p_TF'] * h_F_T - p['d_T'] * T\n\n        # dR/dt\n        h_T_R = H(T, p['K_T_to_R'], p['n_T_to_R'])\n        h_I_R = H(I, p['K_I_to_R'], p['n_I_to_R'])\n        j_F_R = J(F, p['K_F_inh_R'], p['n_F_inh_R'])\n        dR_dt = p['k_R'] * h_T_R * h_I_R * j_F_R - p['d_R'] * R\n\n        # dF/dt\n        h_T_F = H(T, p['K_T_to_F'], p['n_T_to_F'])\n        j_I_F = J(I, p['K_I_inh_F'], p['n_I_inh_F'])\n        j_R_F = J(R, p['K_R_inh_F'], p['n_R_inh_F'])\n        dF_dt = p['k_F'] * h_T_F * j_I_F * j_R_F - p['d_F'] * F\n\n        return [dI_dt, dT_dt, dR_dt, dF_dt]\n\n    test_cases_M = [0.0, 0.2, 1.0, 3.0, 10.0]\n    results = []\n    epsilon = 1e-9\n\n    for M in test_cases_M:\n        def objective_func(y):\n            return ode_system(0, y, M, params)\n\n        # Attempt 1: Root finding with multiple initial guesses\n        initial_guesses = [\n            np.array([0.1, 0.1, 0.1, 0.1]),\n            np.array([1.0, 1.0, 1.0, 1.0])\n        ]\n        \n        steady_state = None\n        for guess in initial_guesses:\n            sol_root = root(objective_func, guess, method='hybr')\n            if sol_root.success and np.all(sol_root.x >= 0):\n                steady_state = sol_root.x\n                break\n        \n        # Attempt 2: Fallback to time integration\n        if steady_state is None:\n            y0 = [0.0, 0.0, 0.0, 0.0]\n            t_span = [0, 2000] # Long time horizon to ensure convergence\n            \n            def ode_for_ivp(t, y):\n                return ode_system(t, y, M, params)\n            \n            sol_ivp = solve_ivp(ode_for_ivp, t_span, y0, method='Radau', dense_output=False)\n            \n            if sol_ivp.success:\n                steady_state = sol_ivp.y[:, -1]\n            else:\n                # This case indicates failure of both methods, should not happen for this problem\n                results.append(np.nan)\n                continue\n        \n        if np.any(steady_state  0):\n           # If the final state is somehow negative, which is unphysical\n           # treat this particular case as an error\n           results.append(np.nan)\n           continue\n\n        I_star, T_star, R_star, F_star = steady_state\n        \n        # Calculate the Treg/Th17 ratio\n        ratio = F_star / max(R_star, epsilon)\n        results.append(round(ratio, 3))\n\n    # This function is not called in the XML, but provided for local execution.\n    # The final output will be printed in the answer tag.\n    # print(f\"[{','.join(map(str, results))}]\")\n    return f\"[{','.join(map(str, results))}]\"\n\n# The result is generated by running the `solve` function.\n# solve()\n```", "answer": "[5.275,3.313,0.769,0.187,0.054]", "id": "2846629"}]}