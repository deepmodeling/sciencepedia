{"hands_on_practices": [{"introduction": "任何T细胞介导的免疫应答，无论是抗感染还是自身免疫，都始于抗原呈递细胞（APC）表面由主要组织相容性复合物（MHC）分子呈递的肽。呈递在细胞表面的肽-MHC复合物的密度，是决定T细胞能否被有效激活的关键参数。本练习将指导你从基本的生物物理原理出发，推导并计算这一密度，从而将分子水平的结合动力学与细胞水平的抗原呈递现象直接联系起来。[@problem_id:2867150]", "problem": "一个抗原呈递细胞 (APC) 加工一种与宿主肽结构相似的微生物肽，这种情况与分子模拟相关。在肽加载区室中，II类主要组织相容性复合体 (MHC) 分子根据平衡质量作用动力学与肽结合。假设 HLA-DM 的催化编辑产生平衡分布，并且一旦加载，肽-MHC复合物就会运输到细胞表面而不再发生肽交换，因此内体的平衡占据分数会传播到细胞表面。在稳态下，对单一微生物肽种类，在过量不与此 MHC 结合的无关背景肽存在的情况下，通过微粒体加载实验测得以下参数：\n- 微生物肽与 MHC 的解离常数，$K_{D} = 1.5 \\times 10^{-7}\\ \\mathrm{M}$。\n- 加载区室中特定于微生物肽的总肽浓度，$[P]_{\\mathrm{T}} = 2.0 \\times 10^{-6}\\ \\mathrm{M}$。\n- 加载区室中可用于结合的总 MHC 浓度，$[M]_{\\mathrm{T}} = 2.0 \\times 10^{-7}\\ \\mathrm{M}$。\n- 在相关时间窗口内，每个细胞到达质膜的 MHC 分子总数，$N_{\\mathrm{M}} = 1.20 \\times 10^{5}$。\n\n仅从 $1{:}1$ 结合反应的解离常数定义和质量守恒出发，推导结合复合物浓度 $[PM]$ 和 MHC 占据分数 $f = [PM]/[M]_{\\mathrm{T}}$ 作为 $K_{D}$、$[P]_{\\mathrm{T}}$ 和 $[M]_{\\mathrm{T}}$ 函数的精确有限配体平衡表达式。然后，使用提供的数值，计算细胞表面微生物肽的抗原呈递密度，定义为 $D = f \\times N_{\\mathrm{M}}$，以每个细胞的拷贝数表示。\n\n简要解释在分子模拟的背景下，交叉反应性微生物肽的呈递密度 $D$ 升高如何在机制上促进自身反应性T细胞的旁观者激活，但不要在您的数值答案中报告此定性评估。\n\n将 $D$ 的最终数值答案四舍五入到四位有效数字。以每个细胞的拷贝数表示最终值。如果存在百分比，必须表示为小数，而不是使用百分号。", "solution": "该问题要求推导平衡状态下肽-MHC复合物浓度 $[PM]$ 的表达式，然后计算细胞表面的抗原呈递密度。对问题陈述的验证证实了其科学依据充分、问题设定良好且客观。它基于生物化学动力学和免疫学的基本原理。所有必要数据均已提供，且参数在物理上合理的范围内。因此，我们可以进行求解。\n\n肽 $P$ 与主要组织相容性复合体 (MHC) 分子 $M$ 结合形成复合物 $PM$ 的过程由可逆反应描述：\n$$ P + M \\rightleftharpoons PM $$\n在平衡状态下，游离反应物和产物的浓度之间的关系由解离常数 $K_{D}$ 定义：\n$$ K_{D} = \\frac{[P][M]}{[PM]} $$\n其中 $[P]$ 和 $[M]$ 分别是游离肽和游离 MHC 的平衡浓度，$[PM]$ 是结合复合物的平衡浓度。\n\n该系统是封闭的，因此肽的总浓度 $[P]_{\\mathrm{T}}$ 和 MHC 的总浓度 $[M]_{\\mathrm{T}}$ 是守恒的。这通过质量守恒定律表示：\n$$ [P]_{\\mathrm{T}} = [P] + [PM] $$\n$$ [M]_{\\mathrm{T}} = [M] + [PM] $$\n根据这些守恒方程，我们可以用总浓度和结合复合物浓度来表示游离浓度：\n$$ [P] = [P]_{\\mathrm{T}} - [PM] $$\n$$ [M] = [M]_{\\mathrm{T}} - [PM] $$\n将 $[P]$ 和 $[M]$ 的这些表达式代入 $K_{D}$ 的定义中，得到一个仅含 $[PM]$ 和已知总浓度的方程：\n$$ K_{D} = \\frac{([P]_{\\mathrm{T}} - [PM])([M]_{\\mathrm{T}} - [PM])}{[PM]} $$\n为了求解 $[PM]$，我们将此方程重排为标准二次型 $ax^2 + bx + c = 0$，其中 $x = [PM]$。\n$$ K_{D}[PM] = ([P]_{\\mathrm{T}} - [PM])([M]_{\\mathrm{T}} - [PM]) $$\n$$ K_{D}[PM] = [P]_{\\mathrm{T}}[M]_{\\mathrm{T}} - [P]_{\\mathrm{T}}[PM] - [M]_{\\mathrm{T}}[PM] + [PM]^2 $$\n$$ [PM]^2 - ([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})[PM] + [P]_{\\mathrm{T}}[M]_{\\mathrm{T}} = 0 $$\n这是结合复合物平衡浓度 $[PM]$ 的精确二次方程。其解由二次公式给出：\n$$ [PM] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\n其中 $a = 1$，$b = -([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})$，且 $c = [P]_{\\mathrm{T}}[M]_{\\mathrm{T}}$。\n代入这些系数，我们得到：\n$$ [PM] = \\frac{([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D}) \\pm \\sqrt{([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})^2 - 4[P]_{\\mathrm{T}}[M]_{\\mathrm{T}}}}{2} $$\n我们必须选择物理上现实的根。复合物的浓度 $[PM]$ 不能超过任一总浓度 $[P]_{\\mathrm{T}}$ 或 $[M]_{\\mathrm{T}}$。我们来检验正根。项 $([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})$ 严格大于 $\\sqrt{([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})^2 - 4[P]_{\\mathrm{T}}[M]_{\\mathrm{T}}}$。然而，分子中的和可能导致 $[PM] > \\min([P]_{\\mathrm{T}}, [M]_{\\mathrm{T}})$。例如，在紧密结合的极限情况下 ($K_{D} \\to 0$)，带有正根的分子近似为 $([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}}) + |[P]_{\\mathrm{T}} - [M]_{\\mathrm{T}}|$。如果 $[P]_{\\mathrm{T}} > [M]_{\\mathrm{T}}$，这变为 $2[P]_{\\mathrm{T}}$，得出 $[PM] \\approx [P]_{\\mathrm{T}}$，这违反了约束条件 $[PM] \\leq [M]_{\\mathrm{T}}$。在相同极限下，负根得出 $([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}}) - |[P]_{\\mathrm{T}} - [M]_{\\mathrm{T}}|$，如果 $[P]_{\\mathrm{T}} > [M]_{\\mathrm{T}}$，则正确地得到 $2[M]_{\\mathrm{T}}$ (所以 $[PM] \\approx [M]_{\\mathrm{T}}$)；如果 $[M]_{\\mathrm{T}} > [P]_{\\mathrm{T}}$，则得到 $2[P]_{\\mathrm{T}}$ (所以 $[PM] \\approx [P]_{\\mathrm{T}}$)。在两种情况下，负根都正确地解析为 $[PM] \\approx \\min([P]_{\\mathrm{T}}, [M]_{\\mathrm{T}})$。因此，物理上正确的解是：\n$$ [PM] = \\frac{1}{2}\\left( ([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D}) - \\sqrt{([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})^2 - 4[P]_{\\mathrm{T}}[M]_{\\mathrm{T}}} \\right) $$\nMHC 占据分数 $f$ 定义为与肽结合的总 MHC 的比例：\n$$ f = \\frac{[PM]}{[M]_{\\mathrm{T}}} $$\n代入 $[PM]$ 的表达式，得到 $f$ 的最终形式：\n$$ f = \\frac{1}{2[M]_{\\mathrm{T}}}\\left( ([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D}) - \\sqrt{([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})^2 - 4[P]_{\\mathrm{T}}[M]_{\\mathrm{T}}} \\right) $$\n\n现在我们使用提供的参数计算数值：\n$K_{D} = 1.5 \\times 10^{-7}\\ \\mathrm{M}$\n$[P]_{\\mathrm{T}} = 2.0 \\times 10^{-6}\\ \\mathrm{M}$\n$[M]_{\\mathrm{T}} = 2.0 \\times 10^{-7}\\ \\mathrm{M}$\n$N_{\\mathrm{M}} = 1.20 \\times 10^{5}$\n\n首先，我们计算 $[PM]$ 表达式所需的各项：\n$$ [P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D} = (2.0 \\times 10^{-6}) + (0.2 \\times 10^{-6}) + (0.15 \\times 10^{-6}) = 2.35 \\times 10^{-6}\\ \\mathrm{M} $$\n$$ 4[P]_{\\mathrm{T}}[M]_{\\mathrm{T}} = 4(2.0 \\times 10^{-6})(2.0 \\times 10^{-7}) = 1.6 \\times 10^{-12}\\ \\mathrm{M}^2 $$\n$$ ([P]_{\\mathrm{T}} + [M]_{\\mathrm{T}} + K_{D})^2 = (2.35 \\times 10^{-6})^2 = 5.5225 \\times 10^{-12}\\ \\mathrm{M}^2 $$\n平方根下的项是：\n$$ \\sqrt{5.5225 \\times 10^{-12} - 1.6 \\times 10^{-12}} = \\sqrt{3.9225 \\times 10^{-12}} = 1.98053... \\times 10^{-6}\\ \\mathrm{M} $$\n现在，我们计算 $[PM]$：\n$$ [PM] = \\frac{1}{2}(2.35 \\times 10^{-6} - 1.98053... \\times 10^{-6}) = \\frac{1}{2}(0.36946... \\times 10^{-6}) = 1.8473... \\times 10^{-7}\\ \\mathrm{M} $$\n接下来，我们计算占据分数 $f$：\n$$ f = \\frac{[PM]}{[M]_{\\mathrm{T}}} = \\frac{1.8473... \\times 10^{-7}\\ \\mathrm{M}}{2.0 \\times 10^{-7}\\ \\mathrm{M}} = 0.92367... $$\n最后，我们计算抗原呈递密度 $D$，即细胞表面的微生物肽-MHC复合物总数：\n$$ D = f \\times N_{\\mathrm{M}} = (0.92367...) \\times (1.20 \\times 10^{5}) = 110841.0... $$\n按要求四舍五入到四位有效数字，得到：\n$$ D \\approx 1.108 \\times 10^{5} \\text{ copies per cell} $$\n\n问题的定性部分要求解释交叉反应性微生物肽的呈递密度 $D$ 升高如何有助于自身反应性T细胞的旁观者激活。\n模拟自身肽的微生物肽的呈递密度 $D$ 升高是自身免疫的关键启动因素。这种高密度确保了对任何其T细胞受体 (TCRs) 能够结合此微生物肽-MHC (pMHC) 复合物的T细胞提供强烈的激活信号。在分子模拟的情况下，这些响应的T细胞的一部分是自身反应性克隆，其TCRs发生交叉反应，既能识别外来的微生物肽，也能识别结构相似的自身肽。这些交叉反应性T细胞的强力激活会在局部组织环境中引发强烈的炎症级联反应，其特征是分泌促炎细胞因子，如 $\\gamma$-干扰素和白细胞介素-2。\n这种强烈的炎症环境是导致旁观者激活的直接联系。高浓度的细胞因子和抗原呈递细胞 (APCs) 上共刺激分子的上调，显著降低了附近所有T细胞的激活阈值。因此，其他自身反应性T细胞克隆——它们特异于不同的自身肽，并且与最初的微生物抗原不发生交叉反应——在遇到其同源自身pMHC时也可能被激活，即使后者是以低密度（在其他情况下非刺激性的密度）呈递的。这种由初级免疫反应提供的炎症环境使得不相关的自身反应性淋巴细胞得以激活的现象，就是旁观者激活。因此，高密度的模拟肽 $D$ 不仅作为直接激活交叉反应性T细胞的触发器，而且还创造了激活更广泛的自身反应性T细胞谱系所必需的炎症条件，从而引发更广泛的自身免疫攻击。", "answer": "$$\\boxed{1.108 \\times 10^{5}}$$", "id": "2867150"}, {"introduction": "在理解了抗原如何被呈递后，下一个核心问题是：为什么一个T细胞会同时识别外来病原体肽和自身肽？这根植于两者在结构上的相似性，即分子模拟。本练习将引导你使用一个简化但功能强大的模型来量化这种相似性，并对T细胞受体（TCR）识别的关键氨基酸残基赋予更高的权重。通过将计算出的相似性得分与一个基于统计学推导的阈值进行比较，你将学会如何对分子模拟的风险做出数据驱动的评估。[@problem_id:2867151]", "problem": "一名临床医生怀疑，一种自身免疫反应是由微生物肽和自身肽之间的分子模拟引发的，该自身肽由一个主要组织相容性复合体 (MHC) I类等位基因呈递，其锚定残基位于位置$2$和$9$。在MHC I类呈递中，锚定残基主要决定肽与MHC的结合，而肽中央凸起部分与T细胞受体 (TCR) 的接触主要决定TCR的识别。考虑以下一个与MHC I类分子结合的9-肽模型，其中位置$2$和$9$是锚定位置，位置$3$到$7$是主要的TCR接触残基。定义微生物肽和自身肽之间的加权相似性得分$S$为\n$$\nS \\equiv w_{t}\\,X_{t} + w_{a}\\,X_{a},\n$$\n其中$X_{t}$是在TCR接触位置$\\{3,4,5,6,7\\}$上完全匹配的残基数量，$X_{a}$是在锚定位置$\\{2,9\\}$上完全匹配的残基数量，$w_{t} = 2$，且$w_{a} = 1$。给出两个9-肽：\n- 自身肽: ALYGFVYLL\n- 微生物肽: ALFGFVFIL\n\n任务：\n1) 计算这对肽的加权相似性得分$S$。\n2) 为了判断相似性是否可能由偶然产生，将不相关的肽对建模为具有独立同分布的残基，且氨基酸呈均匀分布。在此零假设模型下，每个位置完全匹配的概率为$p = \\frac{1}{20}$。将$X_{t} \\sim \\mathrm{Binomial}(n_{t}, p)$（其中$n_{t} = 5$）和$X_{a} \\sim \\mathrm{Binomial}(n_{a}, p)$（其中$n_{a} = 2$）视为独立的，因为它们涉及不相交的位置。推导$S$的零假设均值$\\mu_{S}$和方差$\\sigma_{S}^{2}$，并设定一个保守的高风险模拟阈值\n$$\nT \\equiv \\mu_{S} + 3\\,\\sigma_{S}.\n$$\n数值计算$T$。\n\n在区分分子模拟和旁观者激活的背景下，解释为何TCR接触匹配的权重高于锚定匹配的权重，以及为何使用三倍标准差规则来定义高风险阈值的免疫学原理。将计算出的相似性得分和阈值作为两个数字报告。将阈值四舍五入到4位有效数字。", "solution": "首先对问题进行验证。\n\n步骤1：提取已知条件。\n- 所考虑的系统是T细胞受体(TCR)、肽和I类主要组织相容性复合体(MHC)分子之间的相互作用。\n- 肽是一个9-肽。\n- 锚定残基位置为$\\{2, 9\\}$。\n- TCR接触残基位置为$\\{3,4,5,6,7\\}$。\n- 加权相似性得分$S$定义为$S \\equiv w_{t}\\,X_{t} + w_{a}\\,X_{a}$。\n- $X_{t}$是在$n_{t} = 5$个TCR接触位置上完全匹配的氨基酸数量。\n- $X_{a}$是在$n_{a} = 2$个锚定位置上完全匹配的氨基酸数量。\n- 权重为$w_{t} = 2$和$w_{a} = 1$。\n- 用于比较的两个肽是：\n  - 自身肽：ALYGFVYLL\n  - 微生物肽：ALFGFVFIL\n- 为随机相似性提出了一个零假设模型：\n  - 残基是独立同分布的(i.i.d.)。\n  - 每个位置完全匹配的概率为$p = \\frac{1}{20}$。\n  - $X_{t}$被建模为二项随机变量：$X_{t} \\sim \\mathrm{Binomial}(n_{t}, p)$，其中$n_{t} = 5$。\n  - $X_{a}$被建模为二项随机变量：$X_{a} \\sim \\mathrm{Binomial}(n_{a}, p)$，其中$n_{a} = 2$。\n  - $X_{t}$和$X_{a}$在统计上是独立的。\n- 高风险模拟阈值定义为$T \\equiv \\mu_{S} + 3\\,\\sigma_{S}$，其中$\\mu_{S}$和$\\sigma_{S}^{2}$分别是零假设模型下$S$的均值和方差。\n- 任务是：1) 计算给定肽对的$S$值。2) 推导$\\mu_{S}$和$\\sigma_{S}^{2}$，然后计算$T$（四舍五入到4位有效数字）。3) 在区分分子模拟和旁观者激活的背景下，解释权重方案和统计阈值的免疫学原理。\n\n步骤2：使用提取的已知条件进行验证。\n- 科学依据：该问题是分子模拟的一个简化但有效的定量模型，分子模拟是免疫学中一个公认的概念。锚定残基和TCR接触残基的作用被正确陈述。使用二项分布来模拟随机匹配是一种标准的统计方法。该问题具有科学依据。\n- 适定性：该问题提供了所有必要的定义、数据和一组明确的任务。模型被完全指定，可以计算出唯一的解。\n- 客观性：该问题以精确、客观的语言陈述，没有主观论断。\n\n步骤3：结论与行动。\n该问题有效。这是一个适定的、有科学依据的定量免疫学问题。将提供完整的解答。\n\n第一个任务是计算给定肽对的加权相似性得分$S$。我们将自身肽和微生物肽对齐，并计算指定位置上完全匹配的数量。\n自身肽：      $A_1 L_2 Y_3 G_4 F_5 V_6 Y_7 L_8 L_9$\n微生物肽： $A_1 L_2 F_3 G_4 F_5 V_6 F_7 I_8 L_9$\n\nTCR接触位置是$\\{3,4,5,6,7\\}$。\n- 位置$3$：Y vs. F (不匹配)\n- 位置$4$：G vs. G (匹配)\n- 位置$5$：F vs. F (匹配)\n- 位置$6$：V vs. V (匹配)\n- 位置$7$：Y vs. F (不匹配)\nTCR接触位置的匹配数量为$X_{t} = 3$。\n\n锚定位置是$\\{2,9\\}$。\n- 位置$2$：L vs. L (匹配)\n- 位置$9$：L vs. L (匹配)\n锚定位置的匹配数量为$X_{a} = 2$。\n\n使用加权相似性得分的公式，$S = w_{t}X_{t} + w_{a}X_{a}$：\n$$ S = (2)(3) + (1)(2) = 6 + 2 = 8 $$\n\n第二个任务是描述$S$的零分布并计算阈值$T$。令$S$为随机变量$S = w_{t}X_{t} + w_{a}X_{a}$，其中$X_{t} \\sim \\mathrm{Binomial}(n_{t}, p)$和$X_{a} \\sim \\mathrm{Binomial}(n_{a}, p)$是独立的。参数为$w_{t}=2$, $w_{a}=1$, $n_{t}=5$, $n_{a}=2$以及$p=\\frac{1}{20}$。\n\n我们首先推导$S$的均值$\\mu_{S}$。利用期望的线性性质：\n$$ \\mu_{S} = E[S] = E[w_{t}X_{t} + w_{a}X_{a}] = w_{t}E[X_{t}] + w_{a}E[X_{a}] $$\n二项分布$\\mathrm{Binomial}(n, p)$的均值为$np$。\n$$ E[X_{t}] = n_{t}p = 5 \\times \\frac{1}{20} = \\frac{5}{20} = \\frac{1}{4} $$\n$$ E[X_{a}] = n_{a}p = 2 \\times \\frac{1}{20} = \\frac{2}{20} = \\frac{1}{10} $$\n将这些代入$\\mu_{S}$的表达式中：\n$$ \\mu_{S} = (2)\\left(\\frac{1}{4}\\right) + (1)\\left(\\frac{1}{10}\\right) = \\frac{1}{2} + \\frac{1}{10} = \\frac{5}{10} + \\frac{1}{10} = \\frac{6}{10} = 0.6 $$\n\n接下来，我们推导$S$的方差$\\sigma_{S}^{2}$。由于$X_{t}$和$X_{a}$是独立的，它们加权和的方差是它们方差的加权和：\n$$ \\sigma_{S}^{2} = \\mathrm{Var}(S) = \\mathrm{Var}(w_{t}X_{t} + w_{a}X_{a}) = w_{t}^{2}\\mathrm{Var}(X_{t}) + w_{a}^{2}\\mathrm{Var}(X_{a}) $$\n二项分布$\\mathrm{Binomial}(n, p)$的方差为$np(1-p)$。\n$$ 1 - p = 1 - \\frac{1}{20} = \\frac{19}{20} $$\n$$ \\mathrm{Var}(X_{t}) = n_{t}p(1-p) = 5 \\left(\\frac{1}{20}\\right) \\left(\\frac{19}{20}\\right) = \\frac{95}{400} = \\frac{19}{80} $$\n$$ \\mathrm{Var}(X_{a}) = n_{a}p(1-p) = 2 \\left(\\frac{1}{20}\\right) \\left(\\frac{19}{20}\\right) = \\frac{38}{400} = \\frac{19}{200} $$\n将这些代入$\\sigma_{S}^{2}$的表达式中：\n$$ \\sigma_{S}^{2} = (2)^{2}\\left(\\frac{19}{80}\\right) + (1)^{2}\\left(\\frac{19}{200}\\right) = 4\\left(\\frac{19}{80}\\right) + \\frac{19}{200} = \\frac{19}{20} + \\frac{19}{200} = \\frac{190}{200} + \\frac{19}{200} = \\frac{209}{200} = 1.045 $$\n\n最后，我们计算阈值$T = \\mu_{S} + 3\\sigma_{S}$。\n$$ \\sigma_{S} = \\sqrt{\\sigma_{S}^{2}} = \\sqrt{1.045} $$\n$$ T = 0.6 + 3\\sqrt{1.045} \\approx 0.6 + 3(1.0222524) \\approx 0.6 + 3.0667572 \\approx 3.6667572 $$\n四舍五入到4位有效数字，我们得到$T = 3.667$。\n\n第三个任务是解释免疫学原理。\n权重方案$w_{t}  w_{a}$在免疫学上是合理的，因为分子模拟本质上是T细胞交叉反应的一种现象。T细胞要被激活，其TCR必须以足够的亲和力和持续时间物理结合到肽-MHC (pMHC) 复合物上。这种相互作用主要由暴露出来并可供TCR接触的肽残基决定——在此模型中，即位置$\\{3,4,5,6,7\\}$。因此，这些位置上的匹配是共享TCR识别的有力预测指标。相比之下，锚定残基（位置$\\{2,9\\}$）被埋在MHC结合沟内。它们的作用是将肽固定在MHC分子上，以便在细胞表面进行呈递。虽然对呈递至关重要，但锚定位置的相似性并不直接意味着两种不同肽的暴露面会被同一个TCR识别。许多具有不同TCR接触残基的肽可以通过相同的锚定残基与同一个MHC等位基因结合。因此，为了模拟真实交叉反应的可能性，为TCR接触界面的匹配分配更高的权重是合乎逻辑的。\n\n阈值$T = \\mu_{S} + 3\\sigma_{S}$提供了一个统计上严格的标准，用于区分特定的高相似性事件（指示分子模拟）与非特异性或随机事件。分子模拟是一种抗原特异性机制，其中外来肽与自身肽之间的序列/结构相似性导致针对病原体的免疫反应错误地靶向自身组织。相反，旁观者激活是一种抗原非依赖性机制。在高度炎症的环境中，例如在严重感染期间，细胞因子可以非特异性地降低T细胞的激活阈值，导致对病原体不具特异性的自身反应性T细胞被激活并造成组织损伤。零假设模型描述了在随机、不相关的肽对之间预期观察到的相似性得分$S$的分布。阈值$T$设定在均值以上三个标准差处，建立了一个统计稀有性的截断点。如果给定肽对的计算相似性得分$S$超过此阈值（即$S  T$），则观察到的相似性极不可能是偶然产生的（在正态近似下，$p \\approx 0.0013$）。这为支持分子模拟是自身免疫的可能机制提供了强有力的统计证据。如果$S \\le T$，则相似性不具有统计显著性，不能排除其偶然发生的可能性。在这种情况下，旁观者激活将被认为是任何观察到的自身免疫更可能的解释，因为没有强有力的证据表明存在特异性交叉反应。这种保守的阈值最大限度地减少了假阳性率，确保只有具有异常高相似性的肽对才被标记为分子模拟的潜在候选者。\n在本案例中，计算出的得分$S=8$远大于阈值$T=3.667$，这有力地表明微生物肽和自身肽之间的相似性并非偶然，分子模拟是所怀疑的自身免疫反应的一个非常合理的机制。", "answer": "$$\n\\boxed{\\begin{pmatrix} 8  3.667 \\end{pmatrix}}\n$$", "id": "2867151"}, {"introduction": "在前两个练习建立的分子呈递和识别概念的基础上，这最后一个练习将带你进入系统层面。你将亲手实现一个B细胞亲和力成熟的动力学模型，这是适应性免疫的核心过程。这个计算机模拟提供了一个强大的“沙盒”，让你能够探索抗原丰度、分子模拟的程度以及背景炎症（旁观者效应）等因素如何随着时间的推移动态地相互作用，从而塑造B细胞库的构成，并可能最终导致高频率自身反应性克隆的出现。[@problem_id:2867190]", "problem": "构建一个B细胞亲和力成熟的最小确定性动力学模型，该模型描述了仅当病原体抗原稀缺时，脱靶自身结合才会产生选择优势的条件。您的模型必须源自并符合以下免疫学基本原理：(i) 克隆选择，即B细胞竞争抗原和生存信号；(ii) 受体占据和下游辅助表现出饱和响应，可用S型函数和Hill型函数捕捉；(iii) 分子模拟，即交叉反应性使病原体亲和力和自身亲和力相关联；(iv) 旁观者激活，即炎性环境提供独立于抗原捕获的辅助。目标是定义一个在离散周期内的精确迭代更新规则，并计算可量化的结果。\n\n实例化该动力学方案的模型规范与约束：\n- 克隆初始化。存在 $N$ 个不同的B细胞克隆，索引为 $i \\in \\{1,\\dots,N\\}$，每个克隆的特征是病原体亲和力 $a_i^{(0)} \\in [0,1]$ 和自身亲和力 $b_i^{(0)} \\in [0,1]$，以及初始群体权重 $w_i^{(0)}$。通过 $u_i = \\{ i \\cdot \\varphi \\}$ 定义小数部分初始化，其中 $\\varphi = (\\sqrt{5}-1)/2$。设置 $a_i^{(0)} = u_i$， $b_i^{(0)} = r \\cdot u_i + (1-r)\\cdot(1-u_i)$ 来编码分子模拟相关性 $r \\in [0,1]$（其中 $r=1$ 意味着完全模拟）。设置 $w_i^{(0)} = 1/N$。\n- 环境与门控。设病原体抗原丰度为 $A_p \\ge 0$，自身抗原丰度为 $A_s \\ge 0$，炎症强度为 $I \\ge 0$。通过Hill函数定义针对源于自身选择优势的稀缺性门控\n$$\ns(A_p) = \\frac{1}{1 + \\left(\\frac{A_p}{K}\\right)^h},\n$$\n其中 $K0$ 且Hill系数 $h0$。这使得当 $A_p \\gg K$ 时，源于自身的优势可忽略不计，而当 $A_p \\ll K$ 时则变得显著。\n- 每周期辅助分数。在每个周期 $t \\in \\{0,1,\\dots,T-1\\}$ 中，定义每个克隆的辅助分数\n$$\nH_i^{(t)} = a_i^{(t)} \\cdot A_p + \\alpha \\cdot s(A_p) \\cdot b_i^{(t)} \\cdot A_s + \\beta \\cdot I,\n$$\n其中 $\\alpha \\ge 0$ 缩放源于自身的优势（由 $s(A_p)$ 门控），$\\beta \\ge 0$ 缩放旁观者激活。\n- 生存与选择。生存倾向是 $H_i^{(t)}$ 高于辅助阈值 $\\theta$ 的S型函数，陡峭度为 $k0$，并带有一个随自身亲和力增加而增加的乘法性删除惩罚：\n$$\nq_i^{(t)} = \\sigma\\!\\left(k \\left(H_i^{(t)} - \\theta\\right)\\right) \\cdot \\left(1 - \\delta \\cdot b_i^{(t)}\\right),\n\\quad\n\\sigma(x) = \\frac{1}{1+e^{-x}},\n$$\n其中 $\\delta \\in [0,1]$。将 $q_i^{(t)}$ 限制在区间 $[0,1]$ 内。更新权重并重新归一化至总和为1：\n$$\n\\tilde{w}_i^{(t+1)} = w_i^{(t)} \\cdot q_i^{(t)}, \\quad\nw_i^{(t+1)} = \\frac{\\tilde{w}_i^{(t+1)}}{\\sum_{j=1}^N \\tilde{w}_j^{(t+1)}}.\n$$\n如果 $\\sum_{j=1}^N \\tilde{w}_j^{(t+1)} = 0$，则重置 $w_i^{(t+1)} = 1/N$。\n- 体细胞高频突变与交叉反应性的协同进化。每个周期选择后，应用一个确定性更新，该更新捕捉了病原体亲和力的选择偏向性突变和自身亲和力的模拟耦合漂移：\n$$\n\\Delta a_i^{(t)} = \\mu \\, \\eta \\, \\left(1 - a_i^{(t)}\\right),\n$$\n$$\n\\Delta b_i^{(t)} = \\mu \\, \\eta \\, \\Big( r \\cdot \\left(1 - b_i^{(t)}\\right) - (1-r)\\cdot b_i^{(t)} \\Big),\n$$\n其中突变率 $\\mu \\in [0,1]$ 且步长 $\\eta0$。然后设置\n$$\na_i^{(t+1)} = \\min\\{1,\\max\\{0,a_i^{(t)} + \\Delta a_i^{(t)}\\}\\}, \\quad\nb_i^{(t+1)} = \\min\\{1,\\max\\{0,b_i^{(t)} + \\Delta b_i^{(t)}\\}\\}.\n$$\n这些更新捕捉了对改善病原体结合的偏向，以及自身亲和力以与模拟度 $r$ 成正比的强度协同进化的趋势；重要的是，对 $H_i^{(t)}$ 的源于自身的贡献仅在稀缺条件下通过 $s(A_p)$ 激活。\n- T个周期后的结果。定义自身反应性克隆的加权分数为\n$$\nF_{\\text{self}} = \\sum_{i=1}^N w_i^{(T)} \\cdot \\mathbf{1}\\{ b_i^{(T)} \\ge \\tau \\},\n$$\n其中自身反应性阈值为 $\\tau \\in [0,1]$，加权平均病原体亲和力为\n$$\n\\bar{a} = \\sum_{i=1}^N w_i^{(T)} \\cdot a_i^{(T)},\n$$\n以及自身免疫指标为\n$$\nA_{\\text{auto}} = \\mathbf{1}\\{ F_{\\text{self}} \\ge \\phi \\},\n$$\n其中自身免疫阈值为 $\\phi \\in [0,1]$。\n\n实现要求：\n- 您必须针对一个案例中固定的 $(A_p,A_s,I)$，实现上述给出的精确的确定性迭代，共进行 $T$ 个周期。模型中没有任何随机性。\n- 您的程序必须为每个测试用例计算三元组 $[F_{\\text{self}}, \\bar{a}, A_{\\text{auto}}]$，其中 $F_{\\text{self}}$ 和 $\\bar{a}$ 四舍五入到四位小数，而 $A_{\\text{auto}}$ 是整数 $0$ 或 $1$。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个测试用例报告为一个方括号括起来的三元组，且不含空格。例如，输出必须类似 $[\\![x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$，但需替换为数值且不含空格。\n\n测试套件。在以下四个参数集上运行您的程序；每个案例使用相同的突变和决策阈值，但具有不同的 $(A_p,r,I)$，以探测在稀缺与丰度条件下分子模拟和旁观者激活的情况：\n- 所有案例的共享参数: $N=200$, $T=50$, $A_s=1.0$, $\\alpha=0.5$, $\\beta=0.3$, $\\delta=0.3$, $\\theta=0.6$, $k=4.0$, $\\mu=0.2$, $\\eta=0.05$, $K=0.3$, $h=2.0$, $\\tau=0.7$, $\\phi=0.35$。\n- 案例 1 (病原体抗原丰足，自身优势被抑制): $(A_p=1.0, r=0.8, I=0.2)$。\n- 案例 2 (病原体抗原稀缺，自身优势被激活): $(A_p=0.05, r=0.8, I=0.2)$。\n- 案例 3 (病原体抗原稀缺但为反相关模拟): $(A_p=0.05, r=0.0, I=0.0)$。\n- 案例 4 (中度稀缺伴随强旁观者激活): $(A_p=0.2, r=0.8, I=1.0)$。\n\n您的程序必须以精确格式 $[[F_{\\text{self}}^{(1)},\\bar{a}^{(1)},A_{\\text{auto}}^{(1)}],[F_{\\text{self}}^{(2)},\\bar{a}^{(2)},A_{\\text{auto}}^{(2)}],[F_{\\text{self}}^{(3)},\\bar{a}^{(3)},A_{\\text{auto}}^{(3)}],[F_{\\text{self}}^{(4)},\\bar{a}^{(4)},A_{\\text{auto}}^{(4)}]]$ 输出单行，不含空格，其中上标索引案例1到4。", "solution": "所提出的问题是理论免疫学和计算生物学中一个有效且定义明确的练习。它要求实现和分析一个关于B细胞亲和力成熟的最小确定性动力学模型。该模型建立在已确立的免疫学原理之上，包括克隆选择、分子模拟和旁观者激活。所有参数、初始条件和迭代更新规则都以数学精度指定，使得问题明确无歧义且可通过算法求解。问题没有科学或逻辑上的不一致，并且是自洽的。因此，可以通过直接实现指定的动力学来构建解决方案。\n\n问题的核心是模拟一个包含 $N$ 个B细胞克隆的群体在 $T$ 个离散时间周期内的演化。每个克隆 $i$ 的特征在于其对病原体抗原的亲和力 $a_i^{(t)}$、对自身抗原的亲和力 $b_i^{(t)}$ 及其相对种群大小（或权重） $w_i^{(t)}$。模拟过程如下。\n\n**步骤 1：初始化（周期 $t=0$ 时）**\n\n系统的初始状态是为 $N$ 个克隆定义的。\n初始病原体亲和力 $a_i^{(0)}$ 使用黄金比例 $\\varphi = (\\sqrt{5}-1)/2$ 倍数的小数部分分布在区间 $[0,1]$ 内。具体来说，我们为 $i \\in \\{1,\\dots,N\\}$ 定义一个序列 $u_i = \\{ i \\cdot \\varphi \\}$，并设置 $a_i^{(0)} = u_i$。这种方法确保了一个间距良好、不重复且覆盖整个区间的序列。\n\n初始自身亲和力 $b_i^{(0)}$ 通过分子模拟相关参数 $r \\in [0,1]$ 与病原体亲和力耦合，公式如下：\n$$\nb_i^{(0)} = r \\cdot a_i^{(0)} + (1-r) \\cdot (1-a_i^{(0)})\n$$\n如果 $r=1$，我们有 $b_i^{(0)} = a_i^{(0)}$，表示完全模拟。如果 $r=0$，我们有 $b_i^{(0)} = 1 - a_i^{(0)}$，表示完全反相关。对于 $r \\in (0,1)$，该关系是这两个极端之间的线性插值。\n\n初始群体权重被设置为均匀的，$w_i^{(0)} = 1/N$，表明对任何克隆都没有先验偏好。\n\n**步骤 2：迭代周期动力学（对于 $t=0, 1, \\dots, T-1$）**\n\n对于每个周期，一系列计算确定了系统在下一个周期 $t+1$ 的状态。\n\n**2a. 环境门控：**\n自身抗原结合的影响受病原体抗原 $A_p$ 可用性的门控。这通过Hill函数建模：\n$$\ns(A_p) = \\frac{1}{1 + \\left(\\frac{A_p}{K}\\right)^h}\n$$\n其中 $K$ 是半效应浓度，$h$ 是控制开关陡峭度的Hill系数。当病原体抗原丰足时（$A_p \\gg K$），$s(A_p) \\approx 0$，自身反应项被关闭。当病原体抗原稀缺时（$A_p \\ll K$），$s(A_p) \\approx 1$，自身反应项被激活。\n\n**2b. 每克隆辅助分数：**\n每个克隆接收到一个总“辅助”分数 $H_i^{(t)}$，这决定了其生存和增殖的可能性。这个分数是三个贡献的线性组合：\n$$\nH_i^{(t)} = a_i^{(t)} \\cdot A_p + \\alpha \\cdot s(A_p) \\cdot b_i^{(t)} \\cdot A_s + \\beta \\cdot I\n$$\n- 第一项，$a_i^{(t)} \\cdot A_p$，代表源于与病原体抗原结合的辅助。\n- 第二项，$\\alpha \\cdot s(A_p) \\cdot b_i^{(t)} \\cdot A_s$，代表通过交叉反应性结合到自身抗原 $A_s$ 而获得的辅助，由因子 $\\alpha$ 缩放。此项受到稀缺性门控 $s(A_p)$ 的关键调节。\n- 第三项，$\\beta \\cdot I$，代表由于一般炎性环境 $I$（旁观者激活）而产生的抗原非依赖性辅助，由 $\\beta$ 缩放。\n\n**2c. 生存与选择：**\n每个克隆的生存倾向 $q_i^{(t)}$ 是根据其辅助分数和自身亲和力计算的。\n$$\nq_i^{(t)} = \\sigma\\!\\left(k \\left(H_i^{(t)} - \\theta\\right)\\right) \\cdot \\left(1 - \\delta \\cdot b_i^{(t)}\\right)\n$$\n- 逻辑斯谛函数 $\\sigma(x) = 1/(1+e^{-x})$ 为选择提供了一个“软”阈值。如果一个克隆的辅助分数 $H_i^{(t)}$ 超过阈值 $\\theta$，它就会生存和扩增。参数 $k$ 控制此选择的严格性。\n- 项 $(1 - \\delta \\cdot b_i^{(t)})$ 对自身反应性施加惩罚，代表一种外周耐受机制。具有高自身亲和力 $b_i^{(t)}$ 的克隆会以与参数 $\\delta$ 相关的概率被清除。$q_i^{(t)}$ 的值被限制在 $[0,1]$ 区间内。\n\n然后根据这些生存倾向更新群体权重：\n$$\n\\tilde{w}_i^{(t+1)} = w_i^{(t)} \\cdot q_i^{(t)}\n$$\n这些更新后的权重随后被重新归一化至总和为一，以模拟对有限资源的竞争：\n$$\nw_i^{(t+1)} = \\frac{\\tilde{w}_i^{(t+1)}}{\\sum_{j=1}^N \\tilde{w}_j^{(t+1)}}\n$$\n如果所有克隆都被淘汰（$\\sum_j \\tilde{w}_j^{(t+1)} = 0$），则将群体重置为均匀分布，$w_i^{(t+1)} = 1/N$。\n\n**2d. 体细胞高频突变：**\n选择之后，存活克隆的亲和力会发生演化。该模型使用确定性更新规则。病原体亲和力的变化是：\n$$\n\\Delta a_i^{(t)} = \\mu \\, \\eta \\, \\left(1 - a_i^{(t)}\\right)\n$$\n这将病原体亲和力 $a_i$ 推向其最大值1，其速率与突变率 $\\mu$、步长 $\\eta$ 以及与最大值的距离成正比。这捕捉了亲和力成熟的定向性。\n\n自身亲和力的变化与模拟参数 $r$ 耦合：\n$$\n\\Delta b_i^{(t)} = \\mu \\, \\eta \\, \\Big( r \\cdot \\left(1 - b_i^{(t)}\\right) - (1-r)\\cdot b_i^{(t)} \\Big) = \\mu \\, \\eta \\, \\left( r - b_i^{(t)} \\right)\n$$\n这个更新将自身亲和力 $b_i$ 推向值 $r$。因此，高模拟度（$r \\approx 1$）将导致自身亲和力随病原体亲和力一同增加，而低模拟度（$r \\approx 0$）将选择具有低自身亲和力的克隆。\n\n下一个周期的新亲和力则为 $a_i^{(t+1)} = a_i^{(t)} + \\Delta a_i^{(t)}$ 和 $b_i^{(t+1)} = b_i^{(t)} + \\Delta b_i^{(t)}$，其值被限制在区间 $[0,1]$ 内。\n\n**步骤 3：最终结果计算**\n\n经过 $T$ 个周期后，模拟终止，并根据最终状态 $(w_i^{(T)}, a_i^{(T)}, b_i^{(T)})$ 计算三个结果指标。\n- 自身反应性克隆的加权分数 $F_{\\text{self}}$ 是其最终自身亲和力 $b_i^{(T)}$ 超过阈值 $\\tau$ 的克隆的总权重：\n$$\nF_{\\text{self}} = \\sum_{i=1}^N w_i^{(T)} \\cdot \\mathbf{1}\\{ b_i^{(T)} \\ge \\tau \\}\n$$\n- 加权平均病原体亲和力 $\\bar{a}$ 衡量B细胞反应的总体有效性：\n$$\n\\bar{a} = \\sum_{i=1}^N w_i^{(T)} \\cdot a_i^{(T)}\n$$\n- 自身免疫指标 $A_{\\text{auto}}$ 是一个二元标志，如果自身反应性分数 $F_{\\text{self}}$ 超过一个临界阈值 $\\phi$，则为1，否则为0：\n$$\nA_{\\text{auto}} = \\mathbf{1}\\{ F_{\\text{self}} \\ge \\phi \\}\n$$\n\n实现将包括一个遍历所提供的四个测试用例的主循环。对于每个案例，设置参数 $(A_p, r, I)$，并生成初始状态。然后模拟迭代 $T=50$ 个周期，在每一步应用权重和亲和力的更新规则。最后，计算三个结果指标，按规定进行四舍五入，并格式化以备最终输出。指明使用NumPy对克隆群体进行高效的向量运算。", "answer": "$$\n\\boxed{[[0.0,0.9255,0],[0.4905,0.9577,1],[0.0,0.4851,0],[0.9989,0.9996,1]]}\n$$", "id": "2867190"}]}