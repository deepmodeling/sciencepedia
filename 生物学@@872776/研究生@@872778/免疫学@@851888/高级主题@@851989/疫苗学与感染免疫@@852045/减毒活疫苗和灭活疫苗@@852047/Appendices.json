{"hands_on_practices": [{"introduction": "减活疫苗和灭活疫苗之间的一个基本区别在于它们在宿主体内的抗原动力学。减活疫苗能够复制，提供一个持续且不断增长的抗原来源，而灭活疫苗则提供一个单次、随时间衰减的抗原推注。本练习将使用常微分方程（ODE）这一强大的数学工具，来形式化地描述这一差异，并通过计算病毒载量曲线下的总面积（即总抗原暴露量）来定量比较这两种平台。这为理解不同疫苗类型如何刺激免疫系统提供了动态的视角。[@problem_id:2864497]", "problem": "一种减毒活病毒疫苗在时间 $t=0$ 时接种，初始病毒载量为 $V(0)=V_{0}$ ($0  V_{0}  K$)。在 $0 \\le t  \\tau$ 期间，其载量遵循逻辑斯谛增长 $\\frac{dV}{dt} = r V\\left(1-\\frac{V}{K}\\right)$；在 $t \\ge \\tau$ 期间，遵循指数衰减 $\\frac{dV}{dt} = -\\mu V$。一种灭活疫苗提供初始剂量为 $A_{0}$ 的抗原，并以速率 $\\mu_{a}$ 清除: $\\frac{dA}{dt}=-\\mu_{a}A$。为使两种疫苗的总抗原暴露量相等，即 $\\int_{0}^{\\infty} A(t)\\,dt = \\int_{0}^{\\infty} V(t)\\,dt$，需要多大的初始剂量 $A_0$？", "solution": "问题陈述已根据所需标准进行解析和验证。\n\n提取的已知条件：\n1.  对于减毒活疫苗，病毒载量 $V(t)$ 遵循一个分段常微分方程 (ODE) 系统。\n2.  对于 $0 \\le t  \\tau$：$\\frac{dV}{dt} = r V\\left(1-\\frac{V}{K}\\right)$，初始条件为 $V(0)=V_{0}$。参数为复制率 $r>0$，承载能力 $K>0$，初始载量 $V_{0}$ 满足 $0  V_{0}  K$。切换到适应性应答的时间为 $\\tau>0$。\n3.  对于 $t \\ge \\tau$：$\\frac{dV}{dt} = -\\mu V$，清除率为 $\\mu>0$。病毒载量在 $t=\\tau$ 时是连续的，因此 $V(\\tau^{+})=V(\\tau^{-})$。\n4.  对于灭活疫苗，抗原载量 $A(t)$ 的动态过程为 $\\frac{dA}{dt}=-\\mu_{a}A$，初始条件为 $A(0)=A_{0}$，清除率为 $\\mu_{a}>0$。\n5.  目标是求出灭活疫苗的初始推注剂量 $A_{0}$，使其产生的累积抗原暴露量与减毒活疫苗相同，这由等式 $\\int_{0}^{\\infty} A(t)\\,dt = \\int_{0}^{\\infty} V(t)\\,dt$ 定义。\n\n验证结论：\n该问题具有科学依据，使用了数学免疫学中的标准房室模型（逻辑斯谛增长和指数衰减）。问题提法得当，所有必要的参数和条件都已定义，确保存在唯一解。语言客观、精确。该问题是求解和积分常微分方程的标准练习，不含任何所列的无效性缺陷。因此，该问题被视为**有效**。我们继续进行求解。\n\n任务是通过令曲线 $A(t)$ 和 $V(t)$ 下的总面积相等来求出 $A_{0}$ 的表达式。\n\n首先，我们计算灭活疫苗的累积暴露量。控制方程为 $\\frac{dA}{dt} = -\\mu_{a}A$，初始条件为 $A(0)=A_{0}$。这是一个可分离的一阶线性 ODE，其解为 $A(t) = A_{0}\\exp(-\\mu_{a}t)$。累积暴露量是其在整个时间过程中的积分：\n$$ \\int_{0}^{\\infty} A(t)\\,dt = \\int_{0}^{\\infty} A_{0}\\exp(-\\mu_{a}t)\\,dt = A_{0}\\left[-\\frac{1}{\\mu_{a}}\\exp(-\\mu_{a}t)\\right]_{0}^{\\infty} = A_{0}\\left(0 - \\left(-\\frac{1}{\\mu_{a}}\\right)\\right) = \\frac{A_{0}}{\\mu_{a}} $$\n\n接下来，我们计算减毒活疫苗的累积暴露量 $\\int_{0}^{\\infty} V(t)\\,dt$。这个积分必须分成两部分，对应于动态过程的两个阶段：\n$$ \\int_{0}^{\\infty} V(t)\\,dt = \\int_{0}^{\\tau} V(t)\\,dt + \\int_{\\tau}^{\\infty} V(t)\\,dt $$\n\n对于第二阶段 $t \\ge \\tau$，动态过程服从 $\\frac{dV}{dt} = -\\mu V$。其解为 $V(t) = V(\\tau)\\exp(-\\mu(t-\\tau))$，其中 $V(\\tau)$ 是第一阶段结束时的病毒载量。此清除阶段的暴露量为：\n$$ \\int_{\\tau}^{\\infty} V(t)\\,dt = \\int_{\\tau}^{\\infty} V(\\tau)\\exp(-\\mu(t-\\tau))\\,dt $$\n使用换元法 $s = t-\\tau$，积分变为：\n$$ \\int_{0}^{\\infty} V(\\tau)\\exp(-\\mu s)\\,ds = V(\\tau)\\left[-\\frac{1}{\\mu}\\exp(-\\mu s)\\right]_{0}^{\\infty} = \\frac{V(\\tau)}{\\mu} $$\n\n对于第一阶段 $0 \\le t  \\tau$，病毒载量遵循逻辑斯谛方程 $\\frac{dV}{dt} = rV\\left(1-\\frac{V}{K}\\right)$。为了求积分 $\\int_{0}^{\\tau} V(t)\\,dt$，我们可以重新整理 ODE 本身，而不是先解出 $V(t)$ 再对得到的复杂表达式进行积分。\n$$ \\frac{1}{V}\\frac{dV}{dt} = r\\left(1-\\frac{V}{K}\\right) = r - \\frac{r}{K}V $$\n整理得到 $V$：\n$$ V = K - \\frac{K}{r} \\frac{1}{V}\\frac{dV}{dt} $$\n现在，我们将此表达式对时间从 $t=0$ 到 $t=\\tau$ 进行积分：\n$$ \\int_{0}^{\\tau} V(t)\\,dt = \\int_{0}^{\\tau} K\\,dt - \\frac{K}{r} \\int_{0}^{\\tau} \\frac{1}{V(t)}\\frac{dV}{dt}\\,dt $$\n第一个积分很简单，就是 $K\\tau$。第二个积分是一个全微分：\n$$ \\int_{0}^{\\tau} \\frac{1}{V}\\frac{dV}{dt}\\,dt = \\int_{V(0)}^{V(\\tau)} \\frac{1}{V}\\,dV = [\\ln(V)]_{V_{0}}^{V(\\tau)} = \\ln(V(\\tau)) - \\ln(V_{0}) = \\ln\\left(\\frac{V(\\tau)}{V_{0}}\\right) $$\n因此，第一阶段的暴露量为：\n$$ \\int_{0}^{\\tau} V(t)\\,dt = K\\tau - \\frac{K}{r}\\ln\\left(\\frac{V(\\tau)}{V_{0}}\\right) $$\n这个表达式可以简化。我们使用逻辑斯谛方程的已知解，它将 $V(\\tau)$ 与 $V_{0}$ 联系起来：\n$$ V(\\tau) = \\frac{K V_{0} \\exp(r\\tau)}{K - V_{0} + V_{0}\\exp(r\\tau)} $$\n由此，可以建立一个恒等式：$\\frac{K}{r}\\ln\\left(\\frac{K-V_0}{K-V(\\tau)}\\right) = K\\tau - \\frac{K}{r}\\ln\\left(\\frac{V(\\tau)}{V_0}\\right)$。我们计算对数的宗量：\n$$ \\frac{K-V_{0}}{K-V(\\tau)} = \\frac{K-V_{0}}{K - \\frac{K V_{0} \\exp(r\\tau)}{K - V_{0} + V_{0}\\exp(r\\tau)}} = \\frac{(K-V_{0})(K - V_{0} + V_{0}\\exp(r\\tau))}{K(K - V_{0} + V_{0}\\exp(r\\tau)) - K V_{0} \\exp(r\\tau)} = \\frac{(K-V_{0})(K - V_{0} + V_{0}\\exp(r\\tau))}{K(K-V_0)} = \\frac{K - V_{0} + V_{0}\\exp(r\\tau)}{K} = 1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1) $$\n因此，第一阶段的积分具有更紧凑的形式：\n$$ \\int_{0}^{\\tau} V(t)\\,dt = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) $$\n\n减毒活疫苗的总累积暴露量是两个阶段暴露量的总和：\n$$ \\int_{0}^{\\infty} V(t)\\,dt = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V(\\tau)}{\\mu} $$\n我们用上面找到的新分母来表示 $V(\\tau)$：\n$$ V(\\tau) = \\frac{K V_{0} \\exp(r\\tau)}{K(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1))} = \\frac{V_{0}\\exp(r\\tau)}{1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)} $$\n将此代入总暴露量表达式中，得到：\n$$ \\int_{0}^{\\infty} V(t)\\,dt = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{1}{\\mu}\\frac{V_{0}\\exp(r\\tau)}{1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)} $$\n\n最后，我们令两种疫苗的累积暴露量相等，解出 $A_{0}$：\n$$ \\frac{A_{0}}{\\mu_{a}} = \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V_{0}\\exp(r\\tau)}{\\mu\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right)} $$\n$$ A_{0} = \\mu_{a}\\left[ \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V_{0}\\exp(r\\tau)}{\\mu\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right)} \\right] $$\n这就是所要求的 $A_{0}$ 的闭式解析表达式。", "answer": "$$\\boxed{\\mu_{a}\\left[ \\frac{K}{r}\\ln\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right) + \\frac{V_{0}\\exp(r\\tau)}{\\mu\\left(1 + \\frac{V_{0}}{K}(\\exp(r\\tau)-1)\\right)} \\right]}$$", "id": "2864497"}, {"introduction": "了解疫苗的抗原剂量是评估其潜力的第一步，但这仅仅是故事的开始。为了有效激活B细胞应答，真正关键的是可及的抗原表位数量与能够识别它们的特异性B细胞数量之间的比例。本练习将引导你从第一性原理出发，建立一个定量框架，将灭活疫苗中蛋白质的宏观质量（以微克计）转化为一个具体的免疫学比率——每个特异性前体B细胞对应的表位数。这个过程将疫苗配方与在细胞水平上激活稀有免疫细胞这一核心挑战直接联系起来。[@problem_id:2864489]", "problem": "一份灭活蛋白疫苗剂量包含确定质量的纯化抗原，该抗原呈现构象性B细胞表位。请你从第一性原理出发，构建一个定量框架，将给药的蛋白质质量转换为初级引流淋巴结（dLN）中可用的总表位拷贝数的估计值，然后将其与该淋巴结中存在的预期未致敏表位特异性B细胞前体数量相关联，从而得出每个前体细胞的表位可用性比率。\n\n仅使用以下基本依据和定义：\n- 抗原分子数等于摩尔数乘以阿伏伽德罗常数（阿伏伽德罗常数 $N_A$ 为 $N_A = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$）。\n- 摩尔数等于质量除以分子量，并保持单位一致（使用 $1\\ \\mu\\mathrm{g} = 10^{-6}\\ \\mathrm{g}$）。\n- 如果每个抗原分子呈现 $c_e$ 个表位拷贝，那么总表位拷贝数等于分子数乘以 $c_e$。\n- 如果在灭活和制剂后，有比例为 $q$ 的抗原分子保留了正确的表位构象，并且给药剂量中有比例为 $h$ 的部分以完整的、B细胞可及的形式到达并保留在dLN中，那么dLN中总的可及表位拷贝数将按乘积 $q h$ 进行缩放。\n- dLN中预期的未致敏表位特异性B细胞前体数量等于该淋巴结中的B细胞总数 $N_B$ 乘以其前体频率 $f_p$。\n\n假设在初始抗原到达时，由B细胞受体引起的配体耗竭可以忽略不计（因此计算表位时不需要进行占有率校正），并且给定分子上的表位拷贝是可独立接触的。\n\n请根据参数 $m$、$M_W$、$N_A$、$c_e$、$q$、$h$、$N_B$ 和 $f_p$，推导一个量纲一致的表达式，用于表示比率 $R$（定义为dLN中每个表位特异性未致敏B细胞前体的可及表位拷贝数）。然后使用以下科学上合理的参数值对 $R$ 进行数值计算：\n- 剂量蛋白质量 $m = 15\\ \\mu\\mathrm{g}$，\n- 抗原分子量 $M_W = 6.3 \\times 10^{4}\\ \\mathrm{g/mol}$，\n- 每个抗原分子的表位拷贝数 $c_e = 1$，\n- 抗原完整性分数 $q = 0.05$，\n- dLN递送和保留分数 $h = 0.05$，\n- dLN中的B细胞总数 $N_B = 2.0 \\times 10^{7}$，\n- 未致敏表位特异性B细胞前体频率 $f_p = 1.0 \\times 10^{-5}$。\n\n将 $R$ 的最终值以纯数（拷贝数/细胞）形式报告。将您的答案四舍五入至三位有效数字。", "solution": "首先必须对所述问题进行严格验证。\n\n**步骤1：提取已知条件**\n- 抗原分子数是摩尔数与阿伏伽德罗常数 $N_A = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$ 的乘积。\n- 摩尔数是质量除以分子量。提供了单位换算：$1\\ \\mu\\mathrm{g} = 10^{-6}\\ \\mathrm{g}$。\n- 总表位拷贝数 = (分子数) $\\times c_e$，其中 $c_e$ 是每个分子的表位拷贝数。\n- 引流淋巴结（dLN）中的可及表位拷贝数是给药的总表位数按两个因子进行缩放：$q$（具有正确构象的比例）和 $h$（到达dLN的比例）。\n- dLN中预期的未致敏表位特异性B细胞前体数量是该淋巴结中B细胞总数 $N_B$ 与前体频率 $f_p$ 的乘积。\n- 待推导的比率是 $R = (\\text{dLN中的可及表位拷贝数}) / (\\text{dLN中的未致敏表位特异性B细胞前体数})$。\n- 推导将使用以下参数表示：剂量蛋白质量 $m$、抗原分子量 $M_W$、阿伏伽德罗常数 $N_A$、每个分子的表位拷贝数 $c_e$、抗原完整性分数 $q$、dLN递送分数 $h$、dLN中的B细胞总数 $N_B$ 和前体频率 $f_p$。\n- 用于计算的数值：\n  - $m = 15\\ \\mu\\mathrm{g}$\n  - $M_W = 6.3 \\times 10^{4}\\ \\mathrm{g/mol}$\n  - $c_e = 1$\n  - $q = 0.05$\n  - $h = 0.05$\n  - $N_B = 2.0 \\times 10^{7}$\n  - $f_p = 1.0 \\times 10^{-5}$\n\n**步骤2：验证**\n该问题在科学上基于化学（化学计量学）和免疫学（疫苗抗原递送和B细胞生物学）的基本原理。问题提法恰当，为获得唯一解提供了所有必要的定义、常数和变量。语言客观、精确。所述参数是且确实是科学上合理的。该问题是定量免疫学中一个可形式化且相关的练习。它没有违反任何指定的无效标准。\n\n**步骤3：结论**\n问题有效。将构建解答。\n\n任务是推导比率 $R$ 的表达式，该比率定义为dLN中每个表位特异性未致敏B细胞前体的可及表位拷贝数。\n$$R = \\frac{\\text{dLN中可及表位拷贝数}}{\\text{dLN中表位特异性B细胞前体数}}$$\n让我们根据给定的第一性原理构建分子和分母。\n\n首先，我们确定分子：dLN中可及表位拷贝数，我们将其表示为 $E_{acc}$。\n给药的蛋白质质量为 $m$。问题以微克（$\\mu\\mathrm{g}$）为单位指定了 $m$ 的值。为了与以 $\\mathrm{g/mol}$ 为单位的分子量 $M_W$ 保持量纲一致性，我们必须将质量 $m$ 转换为克。使用提供的换算关系，以克为单位的质量是 $m \\times 10^{-6}\\ \\mathrm{g}$。\n抗原的摩尔数 $n_{ag}$ 是以克为单位的质量除以分子量：\n$$n_{ag} = \\frac{m \\times 10^{-6}}{M_W}$$\n给药的抗原分子总数 $N_{ag}$ 是摩尔数乘以阿伏伽德罗常数 $N_A$：\n$$N_{ag} = n_{ag} \\times N_A = \\frac{m \\times 10^{-6} \\times N_A}{M_W}$$\n每个抗原分子呈现 $c_e$ 个表位拷贝。因此，给药的总表位拷贝数 $E_{total}$ 为：\n$$E_{total} = N_{ag} \\times c_e = \\frac{m \\times 10^{-6} \\times N_A \\times c_e}{M_W}$$\n根据问题陈述，这些表位中只有比例为 $q$ 的部分构象完整，而在这些构象完整的部分中，又只有比例为 $h$ 的部分以可及形式递送并保留在dLN中。因此，dLN中可及表位的总数 $E_{acc}$ 为：\n$$E_{acc} = E_{total} \\times q \\times h = \\frac{m \\times 10^{-6} \\times N_A \\times c_e \\times q \\times h}{M_W}$$\n这是我们比率 $R$ 的分子。\n\n接下来，我们确定分母：dLN中表位特异性未致敏B细胞前体的数量，我们将其表示为 $N_{spec}$。\n这由dLN中B细胞总数 $N_B$ 与表位特异性前体频率 $f_p$ 的乘积给出：\n$$N_{spec} = N_B \\times f_p$$\n这是我们比率 $R$ 的分母。\n\n现在，我们可以通过将 $E_{acc}$ 除以 $N_{spec}$ 来写出比率 $R$ 的完整表达式：\n$$R = \\frac{E_{acc}}{N_{spec}} = \\frac{\\left(\\frac{m \\times 10^{-6} \\times N_A \\times c_e \\times q \\times h}{M_W}\\right)}{N_B \\times f_p}$$\n这个表达式可以更清晰地写成：\n$$R = \\frac{m \\times 10^{-6} \\times N_A \\times c_e \\times q \\times h}{M_W \\times N_B \\times f_p}$$\n这就是所要求的量纲一致的表达式。分子是一个纯数（表位拷贝数），分母也是一个纯数（细胞数），这使得 $R$ 成为一个无量纲的比率（拷贝数/细胞）。\n\n最后，我们使用提供的数值来计算 $R$：\n- $m = 15$\n- $N_A = 6.022 \\times 10^{23}\\ \\mathrm{mol}^{-1}$\n- $c_e = 1$\n- $q = 0.05$\n- $h = 0.05$\n- $M_W = 6.3 \\times 10^{4}\\ \\mathrm{g/mol}$\n- $N_B = 2.0 \\times 10^{7}$\n- $f_p = 1.0 \\times 10^{-5}$\n\n将这些值代入推导出的 $R$ 表达式中：\n$$R = \\frac{15 \\times 10^{-6} \\times (6.022 \\times 10^{23}) \\times 1 \\times 0.05 \\times 0.05}{(6.3 \\times 10^{4}) \\times (2.0 \\times 10^{7}) \\times (1.0 \\times 10^{-5})}$$\n我们分别计算分子和分母。\n分子：\n$$15 \\times 10^{-6} \\times 6.022 \\times 10^{23} \\times 1 \\times 0.05 \\times 0.05 = (15 \\times 6.022 \\times 0.0025) \\times 10^{23-6}$$\n$$= 0.225825 \\times 10^{17} = 2.25825 \\times 10^{16}$$\n分母：\n$$(6.3 \\times 10^{4}) \\times (2.0 \\times 10^{7}) \\times (1.0 \\times 10^{-5}) = (6.3 \\times 2.0 \\times 1.0) \\times 10^{4+7-5}$$\n$$= 12.6 \\times 10^{6} = 1.26 \\times 10^{7}$$\n现在，我们计算比率 $R$：\n$$R = \\frac{2.25825 \\times 10^{16}}{1.26 \\times 10^{7}} = \\frac{2.25825}{1.26} \\times 10^{16-7}$$\n$$R \\approx 1.7922619... \\times 10^{9}$$\n问题要求结果四舍五入到三位有效数字。\n$$R \\approx 1.79 \\times 10^{9}$$\n这个最终值表示在指定条件下，淋巴结中可及抗原表位与特异性B细胞的比率。", "answer": "$$\\boxed{1.79 \\times 10^{9}}$$", "id": "2864489"}, {"introduction": "疫苗接种的最终目标是提供临床保护，而现代疫苗学的一个核心任务是找到可量化的“保护相关物”（correlate of protection）。本练习将介绍如何使用一个强大的统计模型——逻辑斯谛回归——来精确描述可测量的免疫应答（如中和抗体滴度）与预防疾病的保护概率之间的关系。通过建立这个定量框架，我们不仅可以比较不同疫苗的效力，预测其在人群中的表现，还能更深入地理解疫苗发挥作用的机制。[@problem_id:2864475]", "problem": "一个疫苗效力模型假定，中和抗体滴度 $T$ 通过一个带有对数预测变量的逻辑回归来调节保护概率 $P$：保护概率为 $P(T) = \\dfrac{1}{1+\\exp\\!\\left(-(\\alpha + \\beta \\ln T)\\right)}$，其中 $\\ln$ 表示自然对数。该公式与以下观察结果一致：中和滴度在不同稀释度下呈倍增关系，以及免疫学中的剂量-反应关系通常是S型的。保护比值为 $O(T) = \\dfrac{P(T)}{1-P(T)}$。考虑了两种疫苗平台：减活疫苗（Live-Attenuated (LA)）和灭活疫苗（Inactivated (IN)），每种平台都由其自身的参数 $(\\alpha,\\beta)$ 来表征，其中 $\\alpha$ 是截距，$\\beta$ 是相对于 $\\ln T$ 的斜率。\n\n从该模型出发，且仅基于概率、比值和逻辑函数的基本定义，推导出计算以下内容所需的表达式：\n- 计算保护概率 $P(T)$。\n- 根据 $\\beta$ 和 $f$ 量化滴度的倍数变化 $f$ 对比值 $O(T)$ 的影响。\n- 计算达到指定目标保护概率 $p^\\star$ 所需的滴度 $T^\\star$。\n\n您的任务是编写一个完整的、可运行的程序，该程序实现这些推导出的表达式，并用以下测试套件对其进行评估。在整个过程中使用自然对数。所有概率必须表示为 $[0,1]$ 区间内的小数。\n\n测试套件参数：\n- 减活疫苗 (LA): $\\alpha_{\\mathrm{LA}}=-3.0$, $\\beta_{\\mathrm{LA}}=2.2$。\n- 灭活疫苗 (IN): $\\alpha_{\\mathrm{IN}}=-2.5$, $\\beta_{\\mathrm{IN}}=1.3$。\n- 滴度: $T_{1}=100$, $T_{2}=0.5$, $T_{3}=10000$。\n- 倍数变化: $f_{1}=4$, $f_{2}=2$。\n- 目标保护概率: $p^\\star=0.8$。\n- 用于边缘情况比值乘数评估的额外斜率: $\\beta_{\\mathrm{small}}=0.1$, $\\beta_{\\mathrm{large}}=3.0$。\n\n您的程序必须完全按照以下顺序计算：\n$1.$ 使用 $(\\alpha_{\\mathrm{LA}},\\beta_{\\mathrm{LA}})$ 和 $T_{1}$ 计算 $P_{\\mathrm{LA}}(T_{1})$。\n$2.$ 使用 $(\\alpha_{\\mathrm{IN}},\\beta_{\\mathrm{IN}})$ 和 $T_{1}$ 计算 $P_{\\mathrm{IN}}(T_{1})$。\n$3.$ 使用 $(\\alpha_{\\mathrm{LA}},\\beta_{\\mathrm{LA}})$ 和 $T_{2}$ 计算 $P_{\\mathrm{LA}}(T_{2})$。\n$4.$ 使用 $(\\alpha_{\\mathrm{IN}},\\beta_{\\mathrm{IN}})$ 和 $T_{3}$ 计算 $P_{\\mathrm{IN}}(T_{3})$。\n$5.$ 在LA条件下，滴度增加 $f_{1}$ 倍的比值乘数，即当 $T \\mapsto f_{1}T$ 时，$O(T)$ 变化的因子，给定 $\\beta_{\\mathrm{LA}}$。\n$6.$ 在IN条件下，滴度增加 $f_{1}$ 倍的比值乘数，给定 $\\beta_{\\mathrm{IN}}$。\n$7.$ 在LA条件下，达到 $p^\\star$ 所需的滴度 $T^\\star_{\\mathrm{LA}}$。\n$8.$ 在IN条件下，达到 $p^\\star$ 所需的滴度 $T^\\star_{\\mathrm{IN}}$。\n$9.$ 当斜率为 $\\beta_{\\mathrm{small}}$ 时，滴度增加 $f_{2}$ 倍的比值乘数。\n$10.$ 当斜率为 $\\beta_{\\mathrm{large}}$ 时，滴度增加 $f_{2}$ 倍的比值乘数。\n\n覆盖性设计：\n- 第 $1$–$2$ 项测试中等滴度下的一般用途预测（常规路径）。\n- 第 $3$ 项测试极低滴度（接近基线的边缘情况）。\n- 第 $4$ 项测试极高滴度（饱和边缘情况）。\n- 第 $5$–$6$ 项测试通过倍数变化对两种疫苗类型比值的影响来解释 $\\beta$。\n- 第 $7$–$8$ 项测试通过反演求解达到目标保护水平所需的滴度。\n- 第 $9$–$10$ 项测试比值乘数在极小和极大斜率下的边界行为。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按上述顺序排列、用方括号括起来的逗号分隔结果列表。在打印前将每个浮点数四舍五入到 $6$ 位小数。例如，打印出的行应类似于一个包含 $10$ 个十进制数的Python列表字面量，方括号外无额外文本或空格。\n\n约束条件：\n- 所有 $\\ln$ 运算均使用自然对数。\n- 在计算 $\\ln T$ 时，始终假定 $T0$。\n- 所有返回的量必须是实数。", "solution": "该问题已经过严格验证，被认为是有效的。它在科学上基于既定的免疫学和生物统计学原理，问题陈述清晰，所有必要参数均已定义，并以客观、明确的语言表述。所提出的模型，即对对数预测变量进行逻辑回归，是分析生物学中剂量-反应关系的一种标准方法。所要求的任务是该模型的直接应用和反演，这些在数学上是可靠的，在逻辑上是一致的。因此，我们可以进行推导和求解。\n\n目标是基于所提供的关于保护概率 $P(T)$ 作为抗体滴度 $T$ 的函数的逻辑模型，为三个量推导出表达式：\n$1$. 保护概率 $P(T)$。\n$2$. 比值乘数，即对于给定的滴度倍数变化 $f$，保护比值 $O(T)$ 增加的因子。\n$3$. 达到指定目标保护概率 $p^\\star$ 所需的滴度 $T^\\star$。\n\n基本模型如下：\n$$P(T) = \\frac{1}{1 + \\exp(-(\\alpha + \\beta \\ln T))}$$\n其中 $\\alpha$ 是截距，$\\beta$ 是斜率参数。\n\n**推导1：保护概率 $P(T)$**\n\n$P(T)$ 的表达式已在问题陈述中直接给出。它是应用于 $\\ln T$ 的线性预测变量的标准S型函数或逻辑函数。线性预测变量为 $z = \\alpha + \\beta \\ln T$。因此，用于实现的公式如下所示：\n$$P(T) = \\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T)}}$$\n该公式将用于计算测试套件中的第 $1$、$2$、$3$ 和 $4$ 项。\n\n**推导2：滴度倍数变化的比值乘数**\n\n事件的比值定义为事件发生的概率与事件不发生的概率之比。在这里，保护比值为：\n$$O(T) = \\frac{P(T)}{1 - P(T)}$$\n首先，我们推导 $O(T)$ 的显式表达式。不被保护的概率为：\n$$1 - P(T) = 1 - \\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T)}} = \\frac{1 + e^{-(\\alpha + \\beta \\ln T)} - 1}{1 + e^{-(\\alpha + \\beta \\ln T)}} = \\frac{e^{-(\\alpha + \\beta \\ln T)}}{1 + e^{-(\\alpha + \\beta \\ln T)}}$$\n将这些代入比值的定义中：\n$$O(T) = \\frac{\\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T)}}}{\\frac{e^{-(\\alpha + \\beta \\ln T)}}{1 + e^{-(\\alpha + \\beta \\ln T)}}} = \\frac{1}{e^{-(\\alpha + \\beta \\ln T)}} = e^{\\alpha + \\beta \\ln T}$$\n这揭示了逻辑模型的一个关键特性：比值的自然对数，即对数比值（logit），是预测变量的线性函数。\n$$\\ln(O(T)) = \\alpha + \\beta \\ln T$$\n现在，考虑一个新的滴度 $T'$，它是原始滴度 $T$ 的 $f$ 倍，即 $T' = f \\cdot T$。新的比值为 $O(T') = O(fT)$。\n$$O(fT) = e^{\\alpha + \\beta \\ln(fT)}$$\n使用对数性质 $\\ln(ab) = \\ln a + \\ln b$，我们得到：\n$$O(fT) = e^{\\alpha + \\beta (\\ln f + \\ln T)} = e^{\\alpha + \\beta \\ln T + \\beta \\ln f} = (e^{\\alpha + \\beta \\ln T}) \\cdot (e^{\\beta \\ln f})$$\n注意到第一项就是原始比值 $O(T)$，我们得到：\n$$O(fT) = O(T) \\cdot e^{\\beta \\ln f}$$\n可以使用对数的幂法则 $y \\ln x = \\ln(x^y)$ 来简化 $e^{\\beta \\ln f}$ 这一项：\n$$e^{\\beta \\ln f} = e^{\\ln(f^\\beta)} = f^\\beta$$\n因此，比值乘数（即新比值与旧比值的比率）为：\n$$\\text{比值乘数} = \\frac{O(fT)}{O(T)} = f^\\beta$$\n这个非常简洁的表达式表明，对于一个使用对数转换预测变量的逻辑模型，预测变量的 $f$ 倍变化会导致比值乘以 $f^\\beta$。该表达式将用于计算第 $5$、$6$、$9$ 和 $10$ 项。\n\n**推导3：达到目标保护水平所需的滴度 $T^\\star$**\n\n我们旨在找到与目标保护概率 $p^\\star$ 相对应的滴度 $T^\\star$。我们设 $P(T^\\star) = p^\\star$，然后解出 $T^\\star$。\n$$p^\\star = \\frac{1}{1 + e^{-(\\alpha + \\beta \\ln T^\\star)}}$$\n我们进行代数重排以分离出 $T^\\star$：\n$$1 + e^{-(\\alpha + \\beta \\ln T^\\star)} = \\frac{1}{p^\\star}$$\n$$e^{-(\\alpha + \\beta \\ln T^\\star)} = \\frac{1}{p^\\star} - 1 = \\frac{1 - p^\\star}{p^\\star}$$\n对两边取自然对数：\n$$-(\\alpha + \\beta \\ln T^\\star) = \\ln\\left(\\frac{1 - p^\\star}{p^\\star}\\right)$$\n使用性质 $\\ln(1/x) = -\\ln(x)$：\n$$\\alpha + \\beta \\ln T^\\star = -\\ln\\left(\\frac{1 - p^\\star}{p^\\star}\\right) = \\ln\\left(\\left(\\frac{1 - p^\\star}{p^\\star}\\right)^{-1}\\right) = \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right)$$\n这一项 $\\ln(p^\\star / (1 - p^\\star))$ 是 $p^\\star$ 的logit值。现在，我们求解 $\\ln T^\\star$：\n$$\\beta \\ln T^\\star = \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right) - \\alpha$$\n$$\\ln T^\\star = \\frac{1}{\\beta} \\left( \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right) - \\alpha \\right)$$\n最后，我们取指数以求得 $T^\\star$：\n$$T^\\star = \\exp\\left( \\frac{1}{\\beta} \\left( \\ln\\left(\\frac{p^\\star}{1 - p^\\star}\\right) - \\alpha \\right) \\right)$$\n这就是计算达到目标保护水平所需滴度的公式。它将用于计算第 $7$ 和 $8$ 项。\n\n现在，这三个推导出的表达式将在一个程序中实现，用以计算测试套件的指定量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vaccine efficacy modeling problem by implementing the derived formulas\n    and evaluating them for the given test suite.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    # Live-Attenuated (LA) model parameters\n    alpha_la = -3.0\n    beta_la = 2.2\n\n    # Inactivated (IN) model parameters\n    alpha_in = -2.5\n    beta_in = 1.3\n\n    # Test titers\n    T1 = 100.0\n    T2 = 0.5\n    T3 = 10000.0\n\n    # Fold changes\n    f1 = 4.0\n    f2 = 2.0\n\n    # Target protection probability\n    p_star = 0.8\n\n    # Additional slopes for edge-case evaluation\n    beta_small = 0.1\n    beta_large = 3.0\n\n    # --- Derived Functions ---\n\n    def calculate_protection_probability(T, alpha, beta):\n        \"\"\"\n        Computes protection probability P(T) using the logistic regression model.\n        P(T) = 1 / (1 + exp(-(alpha + beta * ln(T))))\n        \"\"\"\n        # Ensure T > 0 for log operation\n        if T = 0:\n            return 0.0\n        linear_predictor = alpha + beta * np.log(T)\n        return 1.0 / (1.0 + np.exp(-linear_predictor))\n\n    def calculate_odds_multiplier(f, beta):\n        \"\"\"\n        Computes the odds multiplier for an f-fold increase in titer.\n        Multiplier = f^beta\n        \"\"\"\n        return f ** beta\n\n    def calculate_target_titer(p_star, alpha, beta):\n        \"\"\"\n        Computes the titer T* required to achieve a target protection probability p*.\n        T* = exp((logit(p*) - alpha) / beta)\n        where logit(p*) = ln(p* / (1 - p*))\n        \"\"\"\n        # Ensure p_star is a valid probability (0  p_star  1)\n        if not (0  p_star  1):\n            raise ValueError(\"Target probability must be between 0 and 1.\")\n        \n        logit_p_star = np.log(p_star / (1.0 - p_star))\n        log_T_star = (logit_p_star - alpha) / beta\n        return np.exp(log_T_star)\n\n    # --- Computation for the Test Suite ---\n    results = []\n\n    # 1. P_LA(T1) using (alpha_la, beta_la) and T1\n    results.append(calculate_protection_probability(T1, alpha_la, beta_la))\n\n    # 2. P_IN(T1) using (alpha_in, beta_in) and T1\n    results.append(calculate_protection_probability(T1, alpha_in, beta_in))\n\n    # 3. P_LA(T2) using (alpha_la, beta_la) and T2\n    results.append(calculate_protection_probability(T2, alpha_la, beta_la))\n\n    # 4. P_IN(T3) using (alpha_in, beta_in) and T3\n    results.append(calculate_protection_probability(T3, alpha_in, beta_in))\n\n    # 5. Odds multiplier for f1 under LA (beta_la)\n    results.append(calculate_odds_multiplier(f1, beta_la))\n\n    # 6. Odds multiplier for f1 under IN (beta_in)\n    results.append(calculate_odds_multiplier(f1, beta_in))\n\n    # 7. Titer T*_LA to achieve p* under LA\n    results.append(calculate_target_titer(p_star, alpha_la, beta_la))\n\n    # 8. Titer T*_IN to achieve p* under IN\n    results.append(calculate_target_titer(p_star, alpha_in, beta_in))\n\n    # 9. Odds multiplier for f2 with beta_small\n    results.append(calculate_odds_multiplier(f2, beta_small))\n\n    # 10. Odds multiplier for f2 with beta_large\n    results.append(calculate_odds_multiplier(f2, beta_large))\n\n    # --- Final Output Formatting ---\n    # Format results to 6 decimal places and print in the required format.\n    formatted_results = [f'{x:.6f}' for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solution\nsolve()\n\n```", "id": "2864475"}]}