{"hands_on_practices": [{"introduction": "抗病毒免疫的一个核心机制是将病毒肽呈递在I类主要组织相容性复合体（MHC I）上，从而激活细胞毒性T淋巴细胞。许多病毒已经进化出破坏这一通路的策略，例如抑制抗原加工相关转运体（TAP）。本练习 [@problem_id:2879485] 旨在引导您建立一个简单的动力学模型，来量化病毒对TAP的抑制如何影响细胞表面肽-MHC复合物的数量。这项实践有助于培养将生物过程转化为动力学方程并求解稳态解的基本技能，这是定量免疫学研究的基础。", "problem": "一种胞质病毒蛋白被加工成肽，这些肽可以呈递在I类主要组织相容性复合体（MHC I）上给细胞毒性T淋巴细胞。考虑一个最小化的、充分混合的模型，其中蛋白酶体在胞质中以恒定速率 $\\lambda$（单位时间内的肽数量）生成抗原肽。肽通过抗原加工相关转运体（TAP）转运至内质网（ER），其有效转运参数为 $t$（无量纲，表示单位时间内成功递送的生成肽的比例）。在内质网中，假设肽加载到MHC I上的过程是迅速且非速率限制的，因此每个成功转运的肽都恰好产生一个加载了肽的MHC I复合物。加载了肽的复合物通过一个有效的一级过程从内质网室中丢失（通过输出和净更新），其速率常数为 $\\delta$（单位时间），该过程总括了所有将加载了肽的MHC I从内质网中移除的过程。\n\n一种病毒抑制剂特异性地降低了TAP的功能，使得有效转运参数按比例因子 $\\theta$（$0  \\theta  1$）缩减，而所有其他过程保持不变。假设空的MHC I和分子伴侣过量存在，因此肽的供应和转运是形成加载了肽的复合物的唯一限制因素，并忽略肽的编辑和解离。\n\n在这些假设下，从通量守恒（稳态时加载复合物的流入等于流出）和一级损失动力学出发，推导一个关于内质网中加载了肽的MHC I复合物在稳态时的数量的闭式解析表达式，该表达式用 $\\lambda$、$t$、$\\delta$ 和 $\\theta$ 表示。将您的答案以符号形式表示为 $\\lambda$、$t$、$\\delta$ 和 $\\theta$ 的函数。", "solution": "该问题要求推导内质网（ER）中加载了肽的I类主要组织相容性复合体（MHC I）复合物在稳态时的数量。我将首先验证问题陈述。\n\n步骤1：提取已知条件\n- `$\\lambda$`：胞质中抗原肽生成的恒定速率（肽数量/时间）。\n- `$t$`：抗原加工相关转运体（TAP）的有效转运参数，一个无量纲的分数。\n- `$\\delta$`：从内质网中丢失已加载MHC I复合物的一级速率常数（1/时间）。\n- `$\\theta$`：由于病毒抑制剂导致的TAP功能的无量纲缩放因子，$0  \\theta  1$。\n- 条件：问题需要在稳态下求解，此时复合物的流入等于流出。\n- 假设1：肽加载到MHC I上是迅速且非速率限制的。\n- 假设2：每个成功转运的肽恰好产生一个加载了肽的MHC I复合物。\n- 假设3：加载复合物的丢失是一个一级过程。\n- 假设4：空的MHC I和分子伴侣过量存在。\n- 假设5：肽的供应和转运是唯一的限制因素。\n- 假设6：忽略肽的编辑和解离。\n\n步骤2：使用提取的已知条件进行验证\n该问题描述了一个简化的但动力学上标准的抗原呈递模型。参数定义清晰，其量纲一致。`$\\lambda$`的单位是[数量]/[时间]。`$t$`和`$\\theta$`是无量纲的效率。`$\\delta$`的单位是[1]/[时间]。目标是求出稳态时的复合物数量，这将是一个代表计数的无量纲量。生成速率为 `$\\lambda t \\theta$`，单位是[数量]/[时间]。损失速率为 `$\\delta N$`，其中`$N$`是复合物的数量，单位为[数量]/[时间]。物理和数学设置是自洽和一致的。这些假设虽然是理想化的，但对于创建一个可处理的模型是标准的，并且没有引入科学谬误。在数学免疫学的背景下，该问题是适定的、客观的且具有科学依据的。\n\n步骤3：结论与行动\n问题是有效的。将推导一个解。\n\n设 `$N_{ss}$` 代表稳态时内质网中加载了肽的MHC I复合物的数量。问题要求从稳态时的通量守恒原理开始，该原理规定这些复合物的生成速率必须等于其移除速率。\n\n我们必须首先构建生成速率（流入）的表达式。\n胞质中肽的生成速率给定为 `$\\lambda$`。\n这些肽由TAP转运至内质网。正常的转运效率由无量纲参数 `$t$` 给出。病毒抑制剂将此效率降低了因子 `$\\theta$`。因此，受抑制剂影响的转运效率是乘积 `$t\\theta$`。\n肽成功转运到内质网的速率是生成速率与有效转运效率的乘积：`$\\lambda t \\theta$`。\n根据问题陈述，肽的加载是迅速的，并且每个转运的肽都恰好产生一个加载了肽的MHC I复合物。因此，加载了肽的MHC I复合物的生成速率等于肽的转运速率。\n$$\n\\text{Rate}_{\\text{formation}} = \\lambda t \\theta\n$$\n\n接下来，我们构建损失速率（流出）的表达式。\n问题指出，加载的复合物从内质网中丢失是一个一级过程，速率常数为 `$\\delta$`。对于一级过程，损失速率与存在的物质数量成正比。在这种情况下，该数量是复合物的数量 `$N_{ss}$`。\n因此，加载了肽的MHC I复合物的损失速率是：\n$$\n\\text{Rate}_{\\text{loss}} = \\delta N_{ss}\n$$\n\n在稳态时，系统不随时间变化，这意味着生成速率必须与损失速率相平衡。\n$$\n\\text{Rate}_{\\text{formation}} = \\text{Rate}_{\\text{loss}}\n$$\n代入上面推导的表达式，我们得到平衡方程：\n$$\n\\lambda t \\theta = \\delta N_{ss}\n$$\n\n最后一步是解这个代数方程以求得 `$N_{ss}$`，即加载了肽的MHC I复合物的稳态数量。通过重新排列各项，我们分离出 `$N_{ss}$`。\n$$\nN_{ss} = \\frac{\\lambda t \\theta}{\\delta}\n$$\n此表达式按要求提供了稳态复合物数量，作为给定参数 `$\\lambda$`、`$t$`、`$\\theta$` 和 `$\\delta$` 的函数。", "answer": "$$\\boxed{\\frac{\\lambda t \\theta}{\\delta}}$$", "id": "2879485"}, {"introduction": "除了适应性免疫，病原体首先要面对的是宿主的先天免疫反应，其中I型干扰素（IFN）通路是关键防线。该通路是一个复杂的信号网络，病毒选择在哪个节点进行干预对其成功复制至关重要。本练习 [@problem_id:2879459] 提供了一个情景，其中病毒可采用兩種不同的拮抗策略，要求您从逻辑上推断哪一種能更有效地抑制宿主的免疫反应。这项实践旨在强调理解信号网络拓扑结构（如冗余性和瓶颈）的重要性，这对于评估病毒或药物抑制剂的有效性至关重要。", "problem": "一种感染人成纤维细胞的病毒面临着先天免疫系统，在该系统中，胞质模式识别受体信号通路汇集于接头蛋白，这些接头蛋白招募并激活TANK结合激酶$1$（TBK$1$），以磷酸化干扰素调节因子$3$（IRF$3$），从而使IRF$3$能够二聚化并转运入核。在大多数非浆细胞样树突状细胞中，基础水平的干扰素调节因子$7$（IRF$7$）含量很低，因此第一波I型干扰素的产生主要依赖于IRF$3$。通过干扰素-$\\alpha/\\beta$受体的自分泌I型干扰素信号传导驱动Janus激酶（JAK）和信号转导与转录激活子（STAT）的激活，形成干扰素刺激基因因子$3$（ISGF$3$）复合物（STAT$1$/STAT$2$/IRF$9$），该复合物会放大干扰素刺激基因（ISGs）的表达。在这种细胞类型中，诸如干扰素基因刺激因子（STING）、线粒体抗病毒信号蛋白（MAVS）和含TIR结构域的接头蛋白诱导干扰素-$\\beta$（TRIF）等接头蛋白，其拷贝数相对于上游受体和下游激酶较低，因此接头蛋白的可用性成为信号通量的限制因素。\n\n该病毒可以编码两种拮抗剂之一：\n- 拮抗剂$X$与TBK$1$结合，阻止其在Ser$172$位点的激活环磷酸化，但不会降解TBK$1$或接头蛋白。\n- 拮抗剂$Y$与核运蛋白-$\\beta$（importin-$\\beta$）结合，特异性地阻止磷酸化的IRF$3$二聚体进入细胞核，而不影响NF-$\\kappa$B或丝裂原活化蛋白激酶通路。\n\n假设以下基本事实：\n- 在IRF$3$磷酸化水平上存在激酶冗余性（当被适当搭建支架时，核因子kappa-B激酶抑制剂epsilon，IKK$\\varepsilon$，也能磷酸化IRF$3$），而IRF$3$二聚体的核内输入对于IRF$3$依赖性转录是必需的。\n- 在缺乏核内IRF$3$的情况下，仅NF-$\\kappa$B的激活不足以驱动干扰素-$\\beta$的转录。\n- 在接头蛋白受限的条件下，任何能够磷酸化IRF$3$的残余激酶仍必须通过与接头蛋白相关的复合物进行招募或搭建支架，但即使是少量进入细胞核的IRF$3$二聚体也足以启动自分泌干扰素扩增环路。\n\n当接头蛋白丰度受限时，以下哪个陈述最好地对比了这两种病毒策略的后果，并正确推断出哪种策略能更有效地减弱全局ISG的诱导？\n\nA. 抑制TBK$1$磷酸化会更有效，因为它能在所有接头蛋白平台上阻止IRF$3$和IRF$7$的激活，从而完全消除I型干扰素，而不管接头蛋白是否受限。\n\nB. 抑制IRF$3$的核转运会更有效，因为它绕过了激酶水平的冗余性（TBK$1$和IKK$\\varepsilon$），同时阻断了初始的干扰素-$\\beta$波和干扰素受体介导的扩增环路，这在接头蛋白丰度受限时尤为关键。\n\nC. 这两种干预措施在抑制ISG方面效果相当，因为它们位于单一的线性通路中，因此在任何接头蛋白丰度下都会以相同程度减少产出。\n\nD. 当接头蛋白丰度受限时，限速步骤位于上游，因此如下游扰动（如阻断IRF$3$核输入）影响甚微；因此，抑制TBK$1$磷酸化在抑制ISG方面更为优越。\n\nE. 阻断TBK$1$磷酸化保留了NF-$\\kappa$B的激活，使得干扰素-$\\beta$的转录得以进行；因此，其效果不如阻断IRF$3$的核转运。", "solution": "在进行解答之前，首先对问题陈述的有效性进行严格评估。\n\n### 步骤1：提取已知条件\n- **细胞背景**：人成纤维细胞。\n- **信号通路**：胞质模式识别受体信号通路汇集于接头蛋白，这些接头蛋白招募并激活TANK结合激酶$1$（$TBK1$）。\n- **$TBK1$功能**：磷酸化干扰素调节因子$3$（$IRF3$）。\n- **$IRF3$激活**：磷酸化使$IRF3$能够二聚化并转运入核。\n- **初始干扰素波**：由于干扰素调节因子$7$（$IRF7$）的基础水平较低，主要依赖于$IRF3$。\n- **扩增环路**：通过干扰素-$\\alpha/\\beta$受体的自分泌I型干扰素信号传导激活Janus激酶（$JAK$）和信号转导与转录激活子（$STAT$），形成干扰素刺激基因因子$3$（$ISGF3$）复合物（$STAT1$/$STAT2$/$IRF9$）。\n- **$ISGF3$功能**：放大干扰素刺激基因（$ISGs$）的表达。\n- **限速步骤**：接头蛋白（干扰素基因刺激因子（$STING$）、线粒体抗病毒信号蛋白（$MAVS$）、含TIR结构域的接头蛋白诱导干扰素-$\\beta$（$TRIF$））的拷贝数较低，使得接头蛋白的可用性成为信号通量的限制因素。\n- **拮抗剂$X$**：与$TBK1$结合，并阻止其在Ser$172$位点的激活环磷酸化。不降解$TBK1$或接头蛋白。\n- **拮抗剂$Y$**：与核运蛋白-$\\beta$结合，并特异性地阻止磷酸化的$IRF3$二聚体进入细胞核。不影响$NF-\\kappa B$或丝裂原活化蛋白激酶通路。\n- **基本事实1**：存在激酶冗余性；在有支架的情况下，核因子kappa-B激酶抑制剂epsilon（$IKK\\varepsilon$）也能磷酸化$IRF3$。\n- **基本事实2**：$IRF3$二聚体的核输入对于$IRF3$依赖性转录是必需的。\n- **基本事实3**：在没有核内$IRF3$的情况下，仅凭$NF-\\kappa B$的激活不足以驱动干扰素-$\\beta$的转录。\n- **基本事实4**：即使是少量进入细胞核的$IRF3$二聚体也足以启动自分泌干扰素扩增环路。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述描述了一个详细但简化的免疫信号场景。\n- **科学依据**：所描述的通路——从PRR识别到$TBK1$/$IKK\\varepsilon$激活、$IRF3$磷酸化、干扰素-$\\beta$产生以及JAK-STAT扩增——是先天抗病毒免疫的基石。所有提到的蛋白质（$TBK1$、$IRF3$、$STING$、$MAVS$、$TRIF$、$IKK\\varepsilon$、$STATs$等）的作用都与已建立的分子免疫学知识一致。病毒拮抗剂靶向该通路特定节点的概念是病毒学的核心主题。\n- **问题定义良好**：该问题在一个特定的生物物理约束（限制性接头蛋白浓度）下，对两种不同的病毒策略进行了清晰的比较。基本事实提供了必要的规则，以推导出关于这两种策略相对效能的唯一且有意义的答案。\n- **客观性**：语言精确且技术性强。所有陈述都在问题背景下作为事实呈现，没有主观性或模糊性。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个结构良好、科学上合理的题目，旨在测试对信号通路逻辑、冗余性和限速步骤的理解。将推导解答。\n\n### 解答推导\n核心任务是在接头蛋白是限制性资源这一关键条件下，比较两种病毒拮抗剂$X$和$Y$在抑制宿主干扰素反应中的效能。\n\n初始I型干扰素反应的通路可总结如下：\n$1$. 病毒检测 $\\rightarrow$ 接头蛋白支架（$STING/MAVS/TRIF$）\n$2$. 接头蛋白支架 $\\rightarrow$ 激酶（$TBK1$或$IKK\\varepsilon$）的招募和激活\n$3$. 激酶激活 $\\rightarrow$ $IRF3$的磷酸化\n$4$. $IRF3$磷酸化 $\\rightarrow$ $IRF3$二聚化\n$5$. $IRF3$二聚化 $\\rightarrow$ 通过核运蛋白-$\\beta$进入细胞核\n$6$. 核内$IRF3$ $\\rightarrow$ 初始干扰素-$\\beta$（$IFN-\\beta$）的转录\n$7$. $IFN-\\beta$分泌 $\\rightarrow$ 通过$IFNAR$进行自分泌信号传导\n$8$. $IFNAR$信号传导 $\\rightarrow$ $JAK/STAT$激活 $\\rightarrow$ $ISGF3$形成\n$9$. $ISGF3$形成 $\\rightarrow$ 大量干扰素刺激基因（$ISGs$）的转录\n\n让我们在此背景下分析这两种拮抗剂。\n\n**拮抗剂$X$的分析：**\n拮抗剂$X$抑制$TBK1$的激活。然而，问题明确指出存在激酶冗余性：$IKK\\varepsilon$在适当的支架上也能磷酸化$IRF3$。由于拮抗剂$X$对$TBK1$具有特异性，它使得由$IKK\\varepsilon$介导的通路保持完整。因为接头蛋白是限制性的，所以只能形成少量的信号复合物。任何招募$IKK\\varepsilon$（代替或补充$TBK1$）的复合物都能够磷酸化$IRF3$。问题指出，即使是少量到达细胞核的磷酸化$IRF3$二聚体也足以启动强大的正反馈扩增环路。因此，由于激酶冗余性，拮抗剂$X$提供的抑制是有“漏洞”的，而这种漏洞足以触发全面的反应。\n\n**拮抗剂$Y$的分析：**\n拮抗剂$Y$抑制磷酸化的$IRF3$二聚体进入细胞核。这一步发生在$IRF3$磷酸化之后。关键的是，问题指出这一步对于$IRF3$依赖性转录是*必需的*，并且没有提到该输入机制存在冗余性。这意味着拮抗剂$Y$造成了一个完全的瓶颈。无论$IRF3$是由$TBK1$还是由冗余的激酶$IKK\\varepsilon$磷酸化的，所产生的磷酸化$IRF3$二聚体都无法进入细胞核。通过阻止$IRF3$进入细胞核，拮抗剂$Y$完全阻止了$IFN-\\beta$的初始转录。如果初始的$IFN-\\beta$波缺失，那么涉及$ISGF3$和全局$ISG$诱导的整个扩增环路就无法启动。\n\n**比较与结论：**\n拮抗剂$Y$靶向通路中一个下游的、非冗余的、必需的步骤。这为整个干扰素反应提供了一个彻底而稳固的阻断。拮抗剂$X$靶向一个存在冗余机制的步骤，使其阻断作用天生就不完全或有“漏洞”。考虑到即使是微弱的信号也能被大规模放大，一个有漏洞的抑制剂远不如一个完全的抑制剂有效。因此，阻断$IRF3$核输入（拮抗剂$Y$）的策略在减弱全局$ISG$诱导方面比阻断$TBK1$激活（拮抗剂$X$）更有效，尤其是在接头蛋白受限的特定条件下。\n\n### 逐项分析选项\n\n**A. 抑制$TBK1$磷酸化会更有效，因为它能在所有接头蛋白平台上阻止IRF$3$和IRF$7$的激活，从而完全消除I型干扰素，而不管接头蛋白是否受限。**\n此陈述不正确。它没有考虑到与$IKK\\varepsilon$的指定激酶冗余性，$IKK\\varepsilon$仍然可以磷酸化$IRF3$以及后来的$IRF7$。因此，这种抑制不是“完全的”。声称“不管接头蛋白是否受限”也与问题的重点相悖。\n\n**结论：错误**\n\n**B. 抑制$IRF3$的核转运会更有效，因为它绕过了激酶水平的冗余性（$TBK1$和IKK$\\varepsilon$），同时阻断了初始的干扰素-$\\beta$波和干扰素受体介导的扩增环路，这在接头蛋白丰度受限时尤为关键。**\n此陈述正确。它精确地指出了拮抗剂$Y$机制的关键优势：它靶向冗余激酶下游的一个单一、必需的步骤，从而造成完全的阻断。它正确地将阻止初始波与阻止扩增环路联系起来，并正确地指出，当一个微弱的初始信号（由于接头蛋白受限）仍能被放大时，完全阻断的重要性就更加突出了。\n\n**结论：正确**\n\n**C. 这两种干预措施在抑制ISG方面效果相当，因为它们位于单一的线性通路中，因此在任何接头蛋白丰度下都会以相同程度减少产出。**\n此陈述不正确。由于$IKK\\varepsilon$的并行、冗余的激酶活性，该通路并非“单一线性”通路。因为一个干预措施靶向一个冗余步骤，而另一个靶向一个非冗余步骤，所以它们的效果不相当。\n\n**结论：错误**\n\n**D. 当接头蛋白丰度受限时，限速步骤位于上游，因此如下游扰动（如阻断IRF$3$核输入）影响甚微；因此，抑制TBK$1$磷酸化在抑制ISG方面更为优越。**\n此陈述显示了有缺陷的逻辑。虽然接头蛋白浓度限制了信号传导的*最大速率*，但这并不意味着下游抑制无效。恰恰相反，因为扩增环路可以由一个非常微弱的信号触发，所以在下游的瓶颈处进行完全阻断是防止任何信号启动此扩增的*最*有效策略。认为该扰动“影响甚微”的结论是错误的。\n\n**结论：错误**\n\n**E. 阻断TBK$1$磷酸化保留了NF-$\\kappa$B的激活，使得干扰素-$\\beta$的转录得以进行；因此，其效果不如阻断IRF$3$的核转运。**\n此陈述包含错误的推理。虽然“效果较差”的结论是正确的，但给出的理由是错误的。问题明确指出，“在缺乏核内$IRF3$的情况下，仅凭$NF-\\kappa B$的激活不足以驱动干扰素-$\\beta$的转录”。由于两种拮抗剂都会导致核内$IRF3$的缺失（$Y$完全缺失，$X$大部分缺失），因此在此背景下，$NF-\\kappa B$是否激活与$IFN-\\beta$的转录无关。效能差异的核心原因是激酶冗余性，而不是$NF-\\kappa B$的状态。\n\n**结论：错误**", "answer": "$$\\boxed{B}$$", "id": "2879459"}, {"introduction": "接下来，我们将视角从单个细胞内的事件提升到群体动态层面。抗原变异是病原体逃避宿主抗体反应的强大策略，其经典例子是布氏锥虫（Trypanosoma brucei）利用其可变表面糖蛋白（VSG）库进行抗原转换。这项高级练习 [@problem_id:2879483] 要求您将免疫清除与新抗原变体生成之间的竞争建模为一个随机过程。通过推导并计算免疫逃逸的期望时间，您将运用概率论的概念来理解病原体群体如何在强大的免疫压力下得以持续存在。", "problem": "要求您将一个抗原变异的生物学场景转化为一个可定量精确、可检验的计算。在原生动物寄生虫 Trypanosoma brucei 中，免疫逃逸是通过在变异表面糖蛋白 (Variant Surface Glycoprotein, VSG) 基因之间进行切换来介导的。假设有一个大小为 $N$ 的变异表面糖蛋白 (VSG) 库，包含可能的抗原性不同的基因；基因转换率为每天每谱系 $\\gamma$，这会产生切换尝试；对于表达被识别的 VSG 的谱系，免疫清除率为每天每谱系 $c$。这里，一个被识别的谱系指的是当前表达的 VSG 先前已暴露于免疫系统的寄生虫；此类谱系以速率 $c$ 被清除。一次切换尝试产生一个新的、未被识别的 VSG 的概率等于剩余未使用 VSG 的比例，如果在开始时已有一个 VSG 在使用，则该概率为 $(N-1)/N$。将早期动态建模为针对被识别谱系数量的线性出生-死亡-创新过程，其中“出生”事件对应于成功的创新（出现表达先前未使用过的 VSG 的谱系），“死亡”事件对应于对被识别谱系的免疫清除。从时间 $t=0$ 时的一个单一被识别谱系开始。\n\n仅使用以下基本原理：\n- 抗原切换和免疫清除事件可以被建模为独立的泊松过程，在小的时间间隔内具有恒定的风险率（无记忆性）。\n- 在一个线性出生-死亡过程中，若每个谱系的出生率为 $b$，死亡率为 $d$，那么从一个谱系开始的起始种群，到第一个事件（出生或死亡）发生的时间呈指数分布，其速率为 $b + d$。\n\n将免疫逃逸时间 $T$ 定义为直到第一次成功创新事件发生的时间（即，出现表达先前未使用过的 VSG 的谱系的时刻）。如果起始谱系的免疫清除发生在任何创新之前，则免疫逃逸永不发生，并且在这种轨迹中，对无条件期望免疫逃逸时间的贡献计为 $0$。假设基因库足够大，以至于单次成功创新导致的消耗在第一次逃逸事件发生前不会产生反馈影响；因此，在开始时，每个谱系的创新风险率为 $b = \\gamma \\cdot \\frac{N-1}{N}$，每个谱系的清除风险率为 $d = c$。\n\n任务：\n- 从第一性原理出发，推导无条件期望免疫逃逸时间 $\\mathbb{E}[T]$（以天为单位）的显式表达式，该表达式仅用 $N$、$\\gamma$ 和 $c$ 表示。除上述内容外，不要假设任何额外的模型结构，并确保您的推导指明了无记忆性和全期望定律的作用。\n- 实现一个程序，为一组固定的参数集计算 $\\mathbb{E}[T]$。所有速率都以天为单位，最终答案必须以天为单位，以浮点数形式给出。\n\n测试集（每个三元组为 $(N, \\gamma, c)$，其中 $N$ 无单位，$\\gamma$ 和 $c$ 的单位为 $\\text{day}^{-1}$）：\n- 情况 A: $(N, \\gamma, c) = (1000, 0.02, 0.1)$\n- 情况 B: $(N, \\gamma, c) = (1, 0.1, 0.1)$\n- 情况 C: $(N, \\gamma, c) = (100, 0.0, 0.5)$\n- 情况 D: $(N, \\gamma, c) = (100, 0.5, 0.0)$\n- 情况 E: $(N, \\gamma, c) = (50, 0.05, 0.5)$\n- 情况 F: $(N, \\gamma, c) = (1000, 0.5, 5.0)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表顺序与测试集相同，其中每个条目是计算出的 $\\mathbb{E}[T]$（以天为单位），格式化为小数点后恰好有六位的浮点数。例如，一个有效的输出格式是 $[x_1,x_2,x_3,x_4,x_5,x_6]$，其中每个 $x_i$ 是一个小数点后有六位的浮点数。", "solution": "问题陈述已经过评估，并被确定为有效。它具有科学依据，内容自洽，并且定量精确。它描述了两个随机过程之间的经典竞争，并置于一个生物学相关的背景中。因此，我们可以进行严谨的推导。\n\n系统在时间 $t=0$ 时始于一个单一的被识别的寄生虫谱系。该谱系受到两个独立的、相互竞争的随机事件的影响，这些事件被建模为泊松过程：\n$1$. **成功创新（出生）：** 寄生虫切换到一个新的、未被识别的变异表面糖蛋白 (VSG)。此事件对应于免疫逃逸。该事件的每个谱系发生率被指定为 $b$。\n$2$. **免疫清除（死亡）：** 现有的被识别谱系被宿主免疫系统摧毁。该事件的每个谱系发生率被指定为 $d$。\n\n问题提供了定义这些速率的参数。切换尝试的速率是 $\\gamma$。一次切换成功（即，产生一个新的VSG）的概率是大小为 $N$ 的基因库中未使用VSG的比例。在当前有一个VSG被使用的情况下，这个概率是 $\\frac{N-1}{N}$。此处做出简化假设，即对于第一个事件，该概率保持不变。因此，成功创新的有效速率是：\n$$b = \\gamma \\cdot \\frac{N-1}{N}$$\n对于一个被识别谱系的免疫清除率直接给出为 $c$。因此：\n$$d = c$$\n\n设 $T_b$ 为到第一次创新事件发生时间的随机变量，$T_d$ 为到第一次清除事件发生时间的随机变量。基于泊松过程的假设，两者都是独立的，且服从指数分布：\n- $T_b \\sim \\text{Exponential}(b)$\n- $T_d \\sim \\text{Exponential}(d)$\n\n免疫逃逸时间 $T$ 被定义为第一次成功创新的时间。然而，一个关键条件被施加：如果清除发生在创新之前（$T_d  T_b$），该轨迹不会导致免疫逃逸，其对无条件期望时间 $\\mathbb{E}[T]$ 的贡献被定义为 $0$。这意味着我们要计算一个随机变量 $T_{eff}$ 的期望，其定义为：\n$$\nT_{eff} =\n\\begin{cases}\nT_b  \\text{if } T_b \\leq T_d \\\\\n0  \\text{if } T_d  T_b\n\\end{cases}\n$$\n我们求解 $\\mathbb{E}[T_{eff}]$。使用全期望定律，我们可以写出：\n$$\\mathbb{E}[T_{eff}] = \\mathbb{E}[T_{eff} | T_b \\leq T_d] P(T_b \\leq T_d) + \\mathbb{E}[T_{eff} | T_d  T_b] P(T_d  T_b)$$\n根据 $T_{eff}$ 的定义：\n- 如果 $T_d  T_b$，那么 $T_{eff} = 0$，所以其期望为 $\\mathbb{E}[0] = 0$。第二项消失。\n- 如果 $T_b \\leq T_d$，那么 $T_{eff} = T_b$。\n\n因此，表达式简化为：\n$$\\mathbb{E}[T_{eff}] = \\mathbb{E}[T_b | T_b \\leq T_d] P(T_b \\leq T_d)$$\n\n我们通过计算这个乘积的两个部分来继续。\n\n首先，概率 $P(T_b \\leq T_d)$ 是一个速率为 $b$ 的指数随机变量小于或等于一个速率为 $d$ 的独立指数随机变量的概率。这是竞争指数分布的一个标准结果：\n$$P(T_b \\leq T_d) = \\frac{b}{b+d}$$\n这一项代表了谱系在被清除之前成功创新的概率。\n\n其次，我们必须找到条件期望 $\\mathbb{E}[T_b | T_b \\leq T_d]$。令 $T_{min} = \\min(T_b, T_d)$ 为第一个事件发生的时间，无论是哪个事件。由于独立指数随机变量的性质，$T_{min}$ 也服从指数分布，其速率等于各个速率之和：\n$$T_{min} \\sim \\text{Exponential}(b+d)$$\n因此，到这个第一个事件发生的期望时间是 $\\mathbb{E}[T_{min}] = \\frac{1}{b+d}$。\n指数分布的无记忆性的一个基本推论是，第一个事件发生的时间 $T_{min}$ 与哪个事件先发生（即是 $T_b \\leq T_d$ 还是 $T_d  T_b$）是独立的。\n在条件 $T_b \\leq T_d$ 下，创新时间 $T_b$ 正是第一个事件发生的时间 $T_{min}$。因此：\n$$\\mathbb{E}[T_b | T_b \\leq T_d] = \\mathbb{E}[T_{min} | T_b \\leq T_d]$$\n由于第一个事件的时间和身份是独立的，所以对身份的条件化不会改变时间的期望：\n$$\\mathbb{E}[T_{min} | T_b \\leq T_d] = \\mathbb{E}[T_{min}] = \\frac{1}{b+d}$$\n这是在逃逸发生的前提下，条件期望逃逸时间。\n\n最后，我们将这些部分组合起来，以找到问题所定义的无条件期望。问题将此量称为 $\\mathbb{E}[T]$，因此我们采用该表示法。\n$$\\mathbb{E}[T] = \\left(\\frac{1}{b+d}\\right) \\cdot \\left(\\frac{b}{b+d}\\right) = \\frac{b}{(b+d)^2}$$\n\n将 $b$ 和 $d$ 的表达式用给定的参数 $N$、$\\gamma$ 和 $c$ 代入：\n$$\\mathbb{E}[T] = \\frac{\\gamma \\frac{N-1}{N}}{\\left(\\gamma \\frac{N-1}{N} + c\\right)^2}$$\n这是从第一性原理推导出的最终表达式。如果创新不可能（即，如果 $\\gamma=0$ 或 $N=1$，这使得 $b=0$），它正确地计算为 $0$。在没有免疫清除（$c=0$）的情况下，该表达式正确地简化为 $\\mathbb{E}[T] = \\frac{1}{b}$，这是第一次创新事件的平均时间，因为此时逃逸是必然发生的。该公式是稳健的，并概括了所指定的动态过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the unconditional expected immune escape time for a series of test cases.\n    \"\"\"\n    # Test suite: each tuple is (N, gamma, c)\n    # N: size of VSG archive (unitless)\n    # gamma: gene conversion rate (per day)\n    # c: immune clearance rate (per day)\n    test_cases = [\n        (1000, 0.02, 0.1),  # Case A\n        (1, 0.1, 0.1),      # Case B\n        (100, 0.0, 0.5),    # Case C\n        (100, 0.5, 0.0),    # Case D\n        (50, 0.05, 0.5),    # Case E\n        (1000, 0.5, 5.0),   # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        N, gamma, c = case\n        \n        # Per-lineage innovation hazard (birth rate 'b').\n        # This is the product of the switching attempt rate (gamma) and the\n        # probability of choosing a novel antigen ((N-1)/N).\n        # We handle N=1, where (N-1)/N = 0, leading to b=0.\n        if N = 1:\n            b = 0.0\n        else:\n            b = gamma * (N - 1) / N\n        \n        # Per-lineage clearance hazard (death rate 'd').\n        d = c\n        \n        # The denominator of the derived formula is (b+d)^2.\n        # A denominator of zero occurs only if b=0 and d=0. In this case,\n        # the numerator b is also 0, and no event can occur. The escape\n        # probability is zero, so the expected time (as defined) is 0.\n        denominator = (b + d)**2\n        \n        if denominator == 0.0:\n            expected_time = 0.0\n        else:\n            # The derived expression for the unconditional expected immune escape time E[T]\n            # is b / (b + d)^2.\n            expected_time = b / denominator\n            \n        results.append(expected_time)\n\n    # Format the final output as a comma-separated list of floating-point numbers\n    # with six digits after the decimal point, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2879483"}]}