{"hands_on_practices": [{"introduction": "为了研究免疫球蛋白的类别转换，我们首先必须能够准确地对其进行量化。本练习模拟了一个常见的流式细胞术实验情景，要求您将原始的细胞群体百分比转化为精确的类别转换重组（CSR）频率。掌握这种定量分析是解读免疫学数据并从此类实验中得出有效结论的关键技能 [@problem_id:2858720]。", "problem": "一个纯化的鼠源幼稚B淋巴细胞群体在体外条件下被刺激，以诱导向免疫球蛋白G亚类1（IgG1）的类别转换重组（CSR）。类别转换重组（CSR）定义为由重组驱动的免疫球蛋白重链恒定区的替换，这会改变同种型（例如，从免疫球蛋白M（IgM）变为免疫球蛋白G亚类1（IgG1）），而不改变抗原结合的可变区。使用流式细胞术在基线和刺激后对细胞表面的免疫球蛋白重链同种型进行定量。假设以下科学标准的测量和生物学前提作为定量的基础：\n- CSR导致在同一重链基因座上获得IgG1恒定区，并在完成后失去IgM恒定区。\n- 流式细胞术检测表面蛋白；进行CSR的细胞可以瞬时共表达两种同种型，产生一个IgM阳性和IgG1阳性的双阳性群体。\n- 某个同种型门控报告的百分比包括落入该门控内的任何双阳性细胞。\n- 在整个测量区间内，总的活B细胞比例保持稳定，终点出现的免疫球蛋白G亚类1（IgG1）阳性细胞源于初始免疫球蛋白M（IgM）阳性B细胞的CSR。\n- 基线时的免疫球蛋白G亚类1（IgG1）阳性率可以忽略不计。\n\n给定以下流式细胞术观察结果：\n- 在基线时，免疫球蛋白M（IgM）阳性细胞的比例为$90\\%$。\n- 在$72$小时，免疫球蛋白M（IgM）阳性细胞的比例为$40\\%$，免疫球蛋白G亚类1（IgG1）阳性细胞的比例为$50\\%$，而免疫球蛋白M（IgM）阳性和免疫球蛋白G亚类1（IgG1）阳性的双阳性细胞比例为$10\\%$。\n\n将向免疫球蛋白G亚类1（IgG1）的CSR频率操作性地定义为：到$72$小时时间点，初始免疫球蛋白M（IgM）阳性群体中已完成向免疫球蛋白G亚类1（IgG1）CSR的细胞所占的比例，其中完成的标志是细胞在$72$小时时为免疫球蛋白G亚类1（IgG1）阳性且免疫球蛋白M（IgM）阴性。仅使用给定的测量值计算此CSR频率。将最终答案表示为一个无单位小数。将答案四舍五入至三位有效数字。", "solution": "该问题要求基于体外B淋巴细胞培养的流式细胞术数据，计算向免疫球蛋白G亚类1（IgG1）的类别转换重组（CSR）频率。问题陈述已经过验证，被认为是科学上合理、一致且定义明确的。我们可以着手求解。\n\n设总的活B淋巴细胞群体归一化为$1$。问题中给出的比例代表相对于此总体的亚群。我们根据所提供的数据定义以下变量：\n\n- $M_0$：基线时间点（$t=0$）时免疫球蛋白M（IgM）阳性细胞的比例。根据问题，$M_0 = 0.90$。\n- $M_{72}$：$72$小时时间点时IgM阳性细胞的比例。根据问题，$M_{72} = 0.40$。\n- $G_{72}$：$72$小时时间点时IgG1阳性细胞的比例。根据问题，$G_{72} = 0.50$。\n- $(M \\cap G)_{72}$：$72$小时时间点时IgM和IgG1双阳性细胞的比例。根据问题，$(M \\cap G)_{72} = 0.10$。\n\nCSR频率，我们记为$F_{CSR}$，操作性地定义为到$72$小时时间点，初始IgM阳性群体中已完成CSR的细胞所占的比例。CSR完成的标志是细胞为IgG1阳性且IgM阴性。\n\n首先，我们必须确定已完成CSR的细胞在总细胞群体中所占的比例。这些是在$t=72$小时时IgG1阳性但IgM阴性的细胞。我们将这个比例记为$G_{sp}$，其中‘sp’代表IgG1‘单阳性’。这个群体是所有IgG1阳性细胞中排除了双阳性（IgM阳性和IgG1阳性）细胞后的集合。\n\nIgG1阳性细胞的总比例$G_{72}$是两个不相交群体的总和：IgG1单阳性细胞（$G_{sp}$）和IgG1与IgM双阳性细胞（$(M \\cap G)_{72}$）。这可以表示为：\n$$G_{72} = G_{sp} + (M \\cap G)_{72}$$\n我们可以解出$G_{sp}$，即已完成CSR的细胞比例：\n$$G_{sp} = G_{72} - (M \\cap G)_{72}$$\n代入给定值：\n$$G_{sp} = 0.50 - 0.10 = 0.40$$\n因此，总活B细胞群体中有$40\\%$的细胞已经完成了向IgG1的CSR。\n\n接下来，我们必须构建CSR频率$F_{CSR}$的分数。定义指明此频率是相对于*初始*IgM阳性群体的。这个初始群体的大小，作为总群体的比例，由$M_0$给出。\n$$M_0 = 0.90$$\n问题陈述指出，IgG1阳性细胞源于初始的IgM阳性群体。因此，我们频率计算的分子是已完成CSR的细胞比例（$G_{sp}$），分母是初始时IgM阳性的细胞比例（$M_0$）。\n\n因此，CSR频率计算为以下比率：\n$$F_{CSR} = \\frac{G_{sp}}{M_0}$$\n代入计算出的和给定的值：\n$$F_{CSR} = \\frac{0.40}{0.90} = \\frac{4}{9}$$\n为了以四舍五入到三位有效数字的小数形式提供最终答案，我们进行除法运算：\n$$F_{CSR} \\approx 0.4444...$$\n四舍五入到三位有效数字，我们得到：\n$$F_{CSR} \\approx 0.444$$\n该值代表在$72$小时标记时，原始表达IgM的B细胞中成功转换至产生IgG1并停止产生IgM的细胞所占的比例。", "answer": "$$\\boxed{0.444}$$", "id": "2858720"}, {"introduction": "除了对CSR进行量化之外，更深入的理解需要剖析其底层的分子机制。本问题要求您扮演一位分子免疫学家的角色，预测在两种关键DNA修复蛋白UNG和MSH2缺失时所产生的不同细胞表型。此练习将磨练您将特定分子功能与复杂生物学结果联系起来的能力，这是免疫学机制研究的核心组成部分 [@problem_id:2858698]。", "problem": "一位研究者比较了缺乏尿嘧啶-DNA糖基化酶（UNG; UNG$^{-/-}$）或mutS同源物$2$（MSH$2$; MSH$2^{-/-}$）的小鼠B细胞中的免疫球蛋白类别转换重组（CSR）。细胞在能诱导多个受体转换区（$S$区）发生稳健的种系转录和相当增殖的条件下被激活。该研究者从同一批培养物中量化了三个读数：（i）双链断裂（DSB）连接点侧翼的转换区DNA中的突变谱，（ii）$S\\mu$-受体连接点处微同源补丁长度的分布，以及（iii）转换后同种型的相对分布。\n\n请使用以下基本事实作为您推理的起点。活化诱导性胞苷脱氨酶（AID）将转录的转换区中的胞嘧啶脱氨基为尿嘧啶，产生$U{:}G$错配。尿嘧啶-DNA糖基化酶（UNG）切除尿嘧啶以产生脱碱基位点，这些位点被切开产生切口，进而可转化为DSB；此途径倾向于产生包括$C{:}G$颠换在内的错误特征。由MSH$2$–MSH$6$启动的错配修复（MMR）系统能识别$U{:}G$错配，并能招募核酸外切酶活性以在对侧链上产生缺口和切口，从而生成DSB；在易错修复过程中，此途径是许多$A{:}T$碱基突变的基础。CSR DSB通过经典非同源末端连接（NHEJ）来解决，但当末端加工受损或末端被切除时，会启用微同源介导的替代性末端连接（alt-EJ），这会增加连接点处微同源的平均长度。同种型分布取决于DSB形成和连接的效率以及单个$S$区的内在可及性（重复序列的长度和种系转录的水平）。\n\n哪个选项最能预测并区分在三种读数中观察到的UNG$^{-/-}$与MSH$2^{-/-}$ B细胞的表型？\n\nA. UNG$^{-/-}$ B细胞显示的突变谱以$C{:}G$对上的$C{\\to}T/G{\\to}A$转换为主，同时$C{:}G$颠换减少；与野生型相比，连接点处的微同源性有适度增加，但平均比MSH$2^{-/-}$中的短；残余的CSR偏向于其$S$区被高度转录且较长的同种型。MSH$2^{-/-}$ B细胞由于UNG依赖的脱碱基位点加工而保留了$C{:}G$颠换，但$A{:}T$突变减少；连接点处微同源性显著增加，与alt-EJ使用增多一致；同种型分布相对保留，因为UNG驱动的DSB形成在各个$S$区中仍广泛有效。\n\nB. UNG$^{-/-}$ B细胞的突变谱转向$A{:}T$碱基突变，伴有$C{:}G$颠换增加；由于更精确的NHEJ，连接点微同源性减少；同种型使用偏向于具有最短$S$区的同种型。MSH$2^{-/-}$ B细胞在所有三种读数上均显示相反的模式。\n\nC. MSH$2^{-/-}$ B细胞显示的突变谱以$A{:}T$碱基改变为主，伴有较少的$C{:}G$转换；连接点微同源性与野生型无法区分；同种型使用受到严重限制，因为MMR是CSR DSB的唯一产生者。UNG$^{-/-}$ B细胞显示出接近野生型的突变谱和同种型分布。\n\nD. UNG$^{-/-}$和MSH$2^{-/-}$ B细胞具有基本相同的突变谱和微同源谱，因为AID单独决定了这些属性；在匹配的刺激条件下，同种型分布与野生型相比保持不变。", "solution": "该问题陈述已经过评估，被认为是有效的。它在科学上基于免疫学的既定原则，特别是免疫球蛋白类别转换重组（$CSR$）的分子机制。问题提法得当、客观，并提供了足够的基本事实来进行严谨的演绎分析。因此，我们将着手进行分析。\n\n核心过程由活化诱导性胞苷脱氨酶（$AID$）启动，它将转录的转换区（$S$区）中的胞嘧啶（$C$）转化为尿嘧啶（$U$），产生$U{:}G$错配。将这些错配解决为$CSR$所需的双链断裂（$DSB$）通过两条主要的并行途径进行。\n\n$1$. 碱基切除修复（$BER$）途径，由尿嘧啶-DNA糖基化酶（$UNG$）启动。$UNG$切除尿嘧啶，产生一个脱碱基（脱嘧啶/脱嘌呤）位点。该位点随后被一种核酸内切酶切开，此类切口的累积可导致一个$DSB$。在易错修复过程中，此途径在机制上与$C{:}G$对上颠换突变的产生相关。\n\n$2$. 错配修复（$MMR$）途径，由识别$U{:}G$错配的$MSH2{–}MSH6$复合物启动。这会招募下游因子，包括核酸外切酶，它们可以产生切口和缺口，随后被加工成$DSB$。问题陈述指出，在修复过程中，此途径是$A{:}T$碱基对突变的一个来源。\n\n产生的$DSB$主要通过经典非同源末端连接（$NHEJ$）来连接。如果末端受损或加工异常，则会启用一种利用微同源区域的替代性末端连接途径（$alt-EJ$）。这导致连接点处具有更长的微同源补丁。\n\n我们现在将基于这些原则分析每种基因敲除的预测表型。\n\n**$UNG^{-/-}$ 小鼠B细胞分析**\n\n在缺乏$UNG$的情况下，切除尿嘧啶的主要途径被禁用。因此：\n\n- **读数（i）：突变谱：** 由$AID$产生的$U{:}G$错配无法通过$UNG$依赖性途径进行处理。因此，导致$C{:}G$颠换的机制受到严重损害，预计此类突变会急剧减少。持续存在的$U{:}G$错配将在DNA复制过程中被解决。如果含有$U$的链作为模板，就会发生$C{:}G \\to T{:}A$的转换突变。这导致突变谱主要由$C{\\to}T$（以及互补链上的$G{\\to}A$）转换主导。$MSH2$依赖性途径仍然活跃，但其主要作用是形成$DSB$，并且根据问题陈述，是产生$A{:}T$突变，而不是将初始的$U{:}G$损伤解决为转换。因此，其定义性特征是$C{:}G$转换增加和$C{:}G$颠换减少。\n\n- **读数（ii）：连接点处的微同源性：** 众所周知，$UNG^{-/-} B$细胞中的$CSR$会受到严重损害，因为$UNG$途径是$DSB$的主要来源。残余的$CSR$依赖于效率较低的$MSH2$依赖性途径。低效或延迟的$DSB$形成可能导致DNA末端结构改变，使其成为经典$NHEJ$的不良底物。基本事实规定，受损的末端加工会启用$alt-EJ$。因此，我们预测与野生型细胞相比，断裂连接点处微同源的使用会增加。\n\n- **读数（iii）：同种型分布：** 由于$DSB$形成存在严重缺陷，$CSR$的总体效率大大降低。为了发生残余的转换，系统变得高度依赖于受体$S$区的内在属性。更长且转录水平更高的$S$区会积累更高密度的$AID$诱导损伤，从而随机地增加低效的备用途径（$MMR$依赖性）成功产生$DSB$的概率。因此，转换后同种型的分布将偏向于那些具有最“可及”$S$区的同种型（即那些具有高种系转录率和更大长度的同种型）。\n\n**$MSH2^{-/-}$ 小鼠B细胞分析**\n\n在缺乏$MSH2$的情况下，用于处理$U{:}G$错配的$MMR$途径被禁用。因此：\n\n- **读数（i）：突变谱：** $UNG$依赖性途径完全完整，并成为处理$U{:}G$错配以形成$DSB$的唯一主要途径。该途径产生脱碱基位点，其加工与$C{:}G$颠换有关。因此，$C{:}G$颠换将被保留。问题还指出，$MMR$途径是许多$A{:}T$碱基突变的基础。在$MSH2$缺失的情况下，这个突变来源被消除，导致$A{:}T$碱基对的突变减少。\n\n- **读数（ii）：连接点处的微同源性：** 虽然$UNG$途径能有效产生$DSB$，但$MSH2$和$MMR$机制在协调更广泛的DNA损伤反应中发挥作用，包括招募和调控用于末端连接的修复因子。$MSH2$的缺失可能导致在协调$NHEJ$进行干净连接方面出现缺陷，从而导致异常的末端加工和增加的切除。这将修复分流至$alt-EJ$途径，导致连接点处微同源平均长度的显著增加。\n\n- **读数（iii）：同种型分布：** $S$区中$DSB$形成的主要机制，即$UNG$依赖性途径，仍然功能完全。尽管与野生型相比，总体$CSR$效率有所降低，但该途径“广泛有效”，可以作用于任何被$AID$靶向的$S$区。因此，不同$S$区之间$DSB$形成的相对效率不应像在$UNG^{-/-}$情况下那样发生剧烈改变。因此，与野生型细胞相比，相对同种型分布预计将大体上保留。\n\n**选项评估**\n\n**A.** 此选项陈述：\n- 对于$UNG^{-/-}$：突变谱以$C{\\to}T/G{\\to}A$转换为主，伴有$C{:}G$颠换减少；微同源性适度增加；同种型偏向于高度转录、长的$S$区。\n- 对于$MSH2^{-/-}$：保留$C{:}G$颠换，伴有$A{:}T$突变减少；微同源性显著增加；同种型分布相对保留。\n此选项与我们对两种基因型在所有三个读数上的推导完全一致。关于$UNG^{-/-}$中微同源性比$MSH2^{-/-}$中短的比较性陈述在机制上也是合理的，因为已知$MSH2$的缺失会导致更严重的末端连接缺陷。\n**结论：正确。**\n\n**B.** 此选项声称对于$UNG^{-/-}$细胞：突变谱转向$A{:}T$碱基突变，$C{:}G$颠换增加，微同源性减少，以及偏向于短$S$区。这些说法中的每一个都与从基本事实推导出的正确预测正好相反。\n**结论：不正确。**\n\n**C.** 此选项声称对于$MSH2^{-/-}$细胞：突变谱以$A{:}T$碱基改变为主，微同源性与野生型无法区分，并且$MMR$是$CSR$ $DSB$的唯一产生者。第一个说法与预期的$A{:}T$突变减少相矛盾。第二个说法与$MMR$在修复协调中的作用不一致。第三个说法是一个基本事实错误，因为问题明确描述了$UNG$依赖性途径。\n**结论：不正确。**\n\n**D.** 此选项声称$UNG^{-/-}$和$MSH2^{-/-}$的表型基本相同，因为$AID$单独决定了结果。这在根本上是有缺陷的。它忽略了问题的核心概念：正是不同的修复途径（$UNG$ vs. $MSH2$）对初始$AID$诱导损伤的下游加工区分了最终结果。这些表型是可证明是不同的，而非相同。\n**结论：不正确。**\n\n基于对所提供基本原则的严谨分析，选项A是唯一准确预测并区分$UNG^{-/-}$和$MSH2^{-/-}$ B细胞表型的选项。", "answer": "$$\\boxed{A}$$", "id": "2858698"}, {"introduction": "巩固我们对生物机制理解的最后一步，往往是将其数学化建模。这个高级练习将指导您把一个关于CSR中DNA修复的假说形式化为一个计算模拟。通过建立和测试一个概率模型，您将学习现代计算生物学如何为验证机理性的见解和生成定量的、可复现的预测提供一个强大的框架 [@problem_id:2858641]。", "problem": "你需要形式化并检验一个关于免疫球蛋白类别转换重组的机理预测。这需要使用一个可复现的模拟，将生物学假设映射到一个离散概率模型。其生物学基础是，免疫球蛋白类别转换重组在转换区产生双链断裂，在野生型条件下，这些断裂主要通过经典非同源末端连接（c-NHEJ）进行修复。Ku 异源二聚体结合 DNA 末端，保护它们免受广泛切除。在 Ku 缺陷的情况下，修复转向替代性末端连接（也称为微同源介导的末端连接），该机制依赖于短同源序列的退火，并倾向于产生更长的缺失和增加连接处的微同源性。从这些原理和基本的概率定义出发，你将实现一个模拟来验证 Ku 缺陷会增加缺失大小和微同源性使用的预测。\n\n需要使用的建模假设：\n- 在条件 $C \\in \\{\\text{WT},\\ \\text{Ku-def}\\}$下，设以碱基对为单位的缺失大小为一个非负整数随机变量 $D_C$，微同源性长度为一个非负整数随机变量 $M_C$。\n- 对每个连接，通过 $D_C = G\\!\\left(p^{(D)}_C\\right) - 1$ 和 $M_C = G\\!\\left(p^{(M)}_C\\right) - 1$ 对 $D_C$ 和 $M_C$ 进行采样，其中 $G(p)$ 是在 $\\{1,2,3,\\dots\\}$ 上的几何随机变量，参数为 $p \\in (0,1]$，使得 $\\mathbb{P}[G(p)=k] = (1-p)^{k-1}p$ 且 $\\mathbb{E}[G(p)-1] = \\dfrac{1-p}{p}$。这一选择反映了对切除或退火延伸步骤的无记忆计数，直到发生停止事件，降低 $p$ 会增加平均长度。\n- 对每个测试用例，在每种条件下精确模拟 $N$ 个连接，使用相同的伪随机数生成器种子以确保可复现性。\n\n每个测试用例需要计算的验证指标：\n- 设 $\\overline{D}_{\\text{WT}}$ 和 $\\overline{D}_{\\text{Ku}}$ 分别是 $D_{\\text{WT}}$ 和 $D_{\\text{Ku}}$ 的样本均值；定义布尔值 $B_D = \\left[\\overline{D}_{\\text{Ku}} > \\overline{D}_{\\text{WT}}\\right]$。\n- 设 $\\overline{M}_{\\text{WT}}$ 和 $\\overline{M}_{\\text{Ku}}$ 分别是 $M_{\\text{WT}}$ 和 $M_{\\text{Ku}}$ 的样本均值；定义布尔值 $B_M = \\left[\\overline{M}_{\\text{Ku}} > \\overline{M}_{\\text{WT}}\\right]$。\n- 对每个特征执行一次单侧 Mann–Whitney $U$ 检验，备择假设为 Ku 缺陷型分布随机性地大于野生型分布。将 $p$ 值表示为 $p_D$ 和 $p_M$。使用显著性阈值 $\\alpha = 0.01$ 并定义布尔值 $S_D = \\left[p_D < \\alpha\\right]$ 和 $S_M = \\left[p_M < \\alpha\\right]$。\n- 报告 $p_D$ 和 $p_M$，四舍五入到 $6$ 位小数。\n\n实现约束：\n- 对每个测试用例使用一个带有指定整数种子 $\\sigma$ 的伪随机数生成器，以使模拟具有确定性和可复现性。\n- 按照下文规定，在每个测试用例的每种条件下，使用恰好 $N$ 个模拟连接。\n\n测试套件：\n对于以下每个测试用例，使用给定的参数为野生型（WT）和 Ku 缺陷型（Ku-def）条件模拟 $N$ 个连接。所有参数都是在 $(0,1]$ 范围内的无单位概率，计数是无单位整数。\n- 测试用例 A（理想路径）：$N=500$, $\\sigma=137$, $p^{(D)}_{\\text{WT}}=0.60$, $p^{(D)}_{\\text{Ku}}=0.20$, $p^{(M)}_{\\text{WT}}=0.85$, $p^{(M)}_{\\text{Ku}}=0.30$。\n- 测试用例 B（中等效应）：$N=500$, $\\sigma=271828$, $p^{(D)}_{\\text{WT}}=0.50$, $p^{(D)}_{\\text{Ku}}=0.35$, $p^{(M)}_{\\text{WT}}=0.65$, $p^{(M)}_{\\text{Ku}}=0.45$。\n- 测试用例 C（近零边界）：$N=500$, $\\sigma=314159$, $p^{(D)}_{\\text{WT}}=0.50$, $p^{(D)}_{\\text{Ku}}=0.48$, $p^{(M)}_{\\text{WT}}=0.55$, $p^{(M)}_{\\text{Ku}}=0.53$。\n- 测试用例 D（极端偏移）：$N=500$, $\\sigma=42$, $p^{(D)}_{\\text{WT}}=0.70$, $p^{(D)}_{\\text{Ku}}=0.15$, $p^{(M)}_{\\text{WT}}=0.90$, $p^{(M)}_{\\text{Ku}}=0.25$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，包含一个由方括号括起来的、逗号分隔的结果列表。\n- 每个测试用例的结果本身必须是一个列表，顺序为 $[B_D,\\ B_M,\\ p_D,\\ p_M,\\ S_D,\\ S_M]$，其中 $p_D$ 和 $p_M$ 是四舍五入到恰好 $6$ 位小数的浮点数。\n- 对于完整的测试套件，输出因此必须是一个包含 $4$ 个列表的列表，每个测试用例一个，例如 $[[\\dots],[\\dots],[\\dots],[\\dots]]$，打印在单行上。\n\n计算说明：\n- 此问题不涉及角度和物理单位。", "solution": "该问题要求通过概率模拟来验证一个生物学假设。该假设认为，在 Ku 缺陷细胞中，免疫球蛋白类别转换重组过程中的 DNA 双链断裂修复会转向一种导致更大缺失和更多微同源性使用的机制，与野生型细胞相比。这将使用一个离散概率模型进行形式化和检验。\n\n**问题验证**\n\n首先，我评估问题陈述的有效性。\n\n1.  **已知条件提取**：\n    *   **模型**：对于条件 $C \\in \\{\\text{WT}, \\text{Ku-def}\\}$，缺失大小 $D_C$ 和微同源性长度 $M_C$ 是随机变量。\n    *   **分布**：$D_C$ 和 $M_C$ 被建模为移位几何随机变量：$D_C = G(p^{(D)}_C) - 1$ 和 $M_C = G(p^{(M)}_C) - 1$。随机变量 $G(p)$ 服从在 $\\{1, 2, 3, \\dots\\}$ 上的几何分布，其概率质量函数为 $\\mathbb{P}[G(p)=k] = (1-p)^{k-1}p$。期望值被给出为 $\\mathbb{E}[G(p)-1] = (1-p)/p$。\n    *   **模拟参数**：每个测试用例都指定了要模拟的连接数 $N$、一个伪随机数生成器种子 $\\sigma$ 以及成功概率 $p^{(D)}_{\\text{WT}}$、 $p^{(D)}_{\\text{Ku}}$、 $p^{(M)}_{\\text{WT}}$、 $p^{(M)}_{\\text{Ku}}$。\n    *   **评估指标**：对于每个测试用例，我们必须计算：\n        *   $B_D = [\\overline{D}_{\\text{Ku}} > \\overline{D}_{\\text{WT}}]$ 和 $B_M = [\\overline{M}_{\\text{Ku}} > \\overline{M}_{\\text{WT}}]$，其中 $\\overline{D}$ 和 $\\overline{M}$ 是样本均值。\n        *   $p_D$ 和 $p_M$，即来自单侧 Mann-Whitney U 检验的 $p$ 值。\n        *   $S_D = [p_D < 0.01]$ 和 $S_M = [p_M < 0.01]$。\n    *   **测试套件**：提供了四个测试用例（A、B、C、D）及其具体的参数值。\n    *   **输出格式**：单行打印一个包含四个列表的列表，其中每个内部列表的格式为 $[B_D, B_M, p_D, p_M, S_D, S_M]$，其中 $p$ 值为四舍五入到 6 位小数的浮点数。\n\n2.  **有效性检查**：\n    *   **科学依据**：该问题在免疫学和分子生物学方面有充分的依据。Ku 在非同源末端连接中的作用及其缺陷的后果是已确立的科学概念。使用概率模型来模拟这些效应是计算生物学中一种标准且有效的方法。\n    *   **适定性**：问题陈述是完全明确的。模拟所需的所有参数（$N, \\sigma, p$ 值）都已提供。统计指标的定义清晰明确。使用种子确保了可复现性，从而得到唯一的解。移位几何分布的均值公式 $\\mathbb{E}[G(p)-1] = (1-p)/p$ 是正确的，因为 $\\mathbb{E}[G(p)] = 1/p$。\n    *   **客观性**：语言精确、量化，并且没有主观偏见。\n\n3.  **结论**：问题陈述是**有效的**。它在科学上是合理的，在数学上是适定的，客观且完整。我将继续进行求解。\n\n**基于原理的解决方案设计**\n\n将遵循从问题原理中导出的逻辑步骤序列来实施解决方案。\n\n**1. 模型实现**\n问题的核心是模拟随机变量 $D_C$ 和 $M_C$。模型指定它们服从移位几何分布。在 $\\{1, 2, 3, \\ldots\\}$ 上的几何随机变量 $G(p)$ 计算了直到第一次成功为止的伯努利试验次数。因此，产生的随机变量 $G(p)-1$ 计算了第一次成功之前的失败次数。这是一个无记忆过程，对于像 DNA 末端切除或微同源性退火这样的生物过程来说，这是一个合理的一阶近似，在这些过程中，过程持续进行，直到在每一步以概率 $p$ 发生一个随机的“停止”事件。\n\nKu 缺陷增加缺失和微同源性长度的生物学假设，是通过设置停止概率使得 $p_{\\text{Ku}} < p_{\\text{WT}}$ 来编码的。这意味着在终止前预期的步骤数更大，因为 $\\mathbb{E}[G(p)-1] = (1-p)/p$ 是 $p \\in (0, 1]$ 上的一个单调递减函数。\n\n对于每个测试用例，我们将执行以下模拟步骤：\n*   使用指定的种子 $\\sigma$ 初始化一个伪随机数生成器，以确保可复现性。\n*   使用它们各自的概率参数（$p^{(D)}_{\\text{WT}}, p^{(D)}_{\\text{Ku}}, p^{(M)}_{\\text{WT}}, p^{(M)}_{\\text{Ku}}$）为四个随机变量（$D_{\\text{WT}}, D_{\\text{Ku}}, M_{\\text{WT}}, M_{\\text{Ku}}$）中的每一个生成 $N$ 个样本。这是通过从几何分布中采样并从每个变异数中减去 1 来实现的。`numpy.random.Generator.geometric` 函数适合此任务。\n\n**2. 统计验证**\n一旦生成了模拟数据集，我们必须计算指定的验证指标，以在模拟数据上检验假设。\n*   **样本均值**：将计算样本均值（$\\overline{D}_{\\text{WT}}, \\overline{D}_{\\text{Ku}}, \\overline{M}_{\\text{WT}}, \\overline{M}_{\\text{Ku}}$）。然后通过比较 Ku 缺陷样本的均值与野生型样本的均值来确定布尔值 $B_D$ 和 $B_M$。这些布尔值直接检验了模拟是否在样本平均值上产生了预期的趋势。\n*   **假设检验**：需要使用 Mann-Whitney U 检验进行更严格的统计比较。这是一种适用于比较两个独立样本的非参数检验，并且不假设数据服从特定分布（例如，正态分布），这在这里是合适的。该检验评估一个分布是否随机性地大于另一个。问题指定了一个单侧备择假设：Ku 缺陷型分布随机性地大于野生型。这对应于 `scipy.stats.mannwhitneyu` 中的 `alternative='greater'` 选项。\n*   从这些检验中获得的 $p$ 值，$p_D$ 和 $p_M$，量化了反对原假设（即分布相同）的证据。我们将这些 $p$ 值与给定的显著性水平 $\\alpha = 0.01$ 进行比较，以确定布尔值 $S_D$ 和 $S_M$，指示观察到的增加是否具有统计显著性。\n\n**3. 算法结构**\n一个主函数将遍历提供的四个测试用例。对于每个案例，一个辅助函数将执行模拟和分析逻辑：\n*   接收参数 $N, \\sigma$ 和四个 $p$ 值。\n*   生成四个大小为 $N$ 的数据集。\n*   计算样本均值和布尔值 $B_D, B_M$。\n*   执行两次 Mann-Whitney U 检验以获得 $p_D, p_M$。\n*   计算显著性布尔值 $S_D, S_M$。\n*   以指定的列表格式 $[B_D, B_M, \\text{round}(p_D, 6), \\text{round}(p_M, 6), S_D, S_M]$ 返回结果。\n\n所有测试用例的结果将被收集到一个列表的列表中。这个最终的数据结构将被转换为一个紧凑的字符串表示，并作为单行打印到标准输出，遵循指定的格式。到字符串的转换将仔细进行，以匹配所需的视觉格式 `[[...],[...]]`，不带多余字符。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A (happy path)\n        {'N': 500, 'sigma': 137,    'p_d_wt': 0.60, 'p_d_ku': 0.20, 'p_m_wt': 0.85, 'p_m_ku': 0.30},\n        # Test case B (moderate effect)\n        {'N': 500, 'sigma': 271828, 'p_d_wt': 0.50, 'p_d_ku': 0.35, 'p_m_wt': 0.65, 'p_m_ku': 0.45},\n        # Test case C (near-null boundary)\n        {'N': 500, 'sigma': 314159, 'p_d_wt': 0.50, 'p_d_ku': 0.48, 'p_m_wt': 0.55, 'p_m_ku': 0.53},\n        # Test case D (extreme shift)\n        {'N': 500, 'sigma': 42,     'p_d_wt': 0.70, 'p_d_ku': 0.15, 'p_m_wt': 0.90, 'p_m_ku': 0.25},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = simulate_and_analyze(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list of lists creates the desired [[...], [...]] structure.\n    # .replace(\" \", \"\") makes the output compact as is common for machine-readable formats.\n    output_string = str(results).replace(\" \", \"\")\n    print(output_string)\n\ndef simulate_and_analyze(params):\n    \"\"\"\n    Performs the simulation and statistical analysis for a single test case.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the case.\n\n    Returns:\n        list: A list of results in the format [B_D, B_M, p_D, p_M, S_D, S_M].\n    \"\"\"\n    N = params['N']\n    sigma = params['sigma']\n    p_d_wt = params['p_d_wt']\n    p_d_ku = params['p_d_ku']\n    p_m_wt = params['p_m_wt']\n    p_m_ku = params['p_m_ku']\n    alpha = 0.01\n\n    # Initialize the pseudorandom number generator with the specified seed for reproducibility.\n    rng = np.random.default_rng(seed=sigma)\n\n    # Generate samples from the shifted geometric distribution G(p)-1.\n    # The numpy.random.Generator.geometric function samples from G(p) on {1, 2, ...}.\n    d_wt = rng.geometric(p=p_d_wt, size=N) - 1\n    d_ku = rng.geometric(p=p_d_ku, size=N) - 1\n    m_wt = rng.geometric(p=p_m_wt, size=N) - 1\n    m_ku = rng.geometric(p=p_m_ku, size=N) - 1\n\n    # Calculate sample means for deletion size and microhomology length.\n    mean_d_wt = np.mean(d_wt)\n    mean_d_ku = np.mean(d_ku)\n    mean_m_wt = np.mean(m_wt)\n    mean_m_ku = np.mean(m_ku)\n\n    # Determine B_D and B_M, the booleans for whether Ku-def mean is greater than WT mean.\n    B_D = bool(mean_d_ku > mean_d_wt)\n    B_M = bool(mean_m_ku > mean_m_wt)\n\n    # Perform one-sided Mann–Whitney U tests.\n    # Alternative hypothesis: the distribution of the first sample (Ku-def) is\n    # stochastically greater than the distribution of the second sample (WT).\n    res_d = stats.mannwhitneyu(d_ku, d_wt, alternative='greater')\n    p_D = res_d.pvalue\n\n    res_m = stats.mannwhitneyu(m_ku, m_wt, alternative='greater')\n    p_M = res_m.pvalue\n\n    # Determine S_D and S_M, the booleans for statistical significance.\n    S_D = bool(p_D < alpha)\n    S_M = bool(p_M < alpha)\n    \n    # Round p-values to 6 decimal places as specified.\n    p_D_rounded = round(p_D, 6)\n    p_M_rounded = round(p_M, 6)\n\n    return [B_D, B_M, p_D_rounded, p_M_rounded, S_D, S_M]\n\nsolve()\n```", "id": "2858641"}]}