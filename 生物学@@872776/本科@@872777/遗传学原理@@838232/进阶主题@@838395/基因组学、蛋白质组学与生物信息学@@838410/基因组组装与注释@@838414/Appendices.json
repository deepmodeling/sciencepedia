{"hands_on_practices": [{"introduction": "在开始任何基因组分析之前，我们首先需要处理存储序列数据的文本文件。FASTA 格式是生物信息学中表示核酸或蛋白质序列的通用标准。本练习将帮助你掌握一项基本技能：从众多文件格式中准确识别出 FASTA 格式，这是确保你的分析工具能够正确读取数据的第一步。[@problem_id:1493807]", "problem": "一位计算生物学家正在处理一个新分离细菌的全基因组测序项目的数据。测序核心设施提供了几个文本文件，每个文件包含一部分组装好的基因组。分析软件要求输入的DNA序列数据为标准的FASTA格式。以下是五个不同文件的摘录。您的任务是识别哪个摘录代表了以正确的FASTA格式存储的序列。\n\n**A.**\n```\n>Contig_1_B.anthracis_strain_Ames_length=5227295\nAGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAAAAAAGAGTGTCTGATAGCAGCTTCTG\nAACTGGTTACCTGCCGTGAGTAAATTAAAATTTTATTGACTTAGGTCACTAAATACTTTAACCAATATAGGCATA\n```\n\n**B.**\n```\nAGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAAAAAAGAGTGTCTGATAGCAGCTTCTG\nAACTGGTTACCTGCCGTGAGTAAATTAAAATTTTATTGACTTAGGTCACTAAATACTTTAACCAATATAGGCATA\n```\n\n**C.**\n```\n@Contig_1_B.anthracis\nAGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAAAAAAGAGTGTCTGATAGCAGCTTCTG\n+\n!''*((((***+))%%%++)(%%%%).1***-+*''))**5(5-2*./....-/2234'44555666655....\n```\n\n**D.**\n```\nLOCUS       Contig_1      5227295 bp    DNA     linear   CON 26-JUL-2024\nDEFINITION  B. anthracis strain Ames, complete genome.\nACCESSION   AE016879\nORIGIN\n        1 agcttttcattctgactgcaacgggcaatatgtctctgtgtggattaaaaaaagagtgtc\n       61 tgatagcagcttctgaactggttacctgccgtgagtaaattaaaattttattgacttag\n```\n\n**E.**\n```\nContig_1,AGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAA,B.anthracis_Ames\n```", "solution": "要识别正确的FASTA格式，我们需要了解其特定结构。FASTA格式是一种基于文本的格式，用于表示核苷酸序列或肽序列，其中碱基对或氨基酸使用单字母代码表示。FASTA格式的序列包含两个主要部分：\n\n1.  **标题行**：这是一个单行，必须以大于号（`>`）开头。该行的其余部分包含序列的唯一标识符，并通常包含其他描述性信息。对于`>`符号之后的内容没有严格的规定。\n2.  **序列数据**：标题行之后的行包含序列本身。序列可以写在单行上，也可以分成多行。包含序列数据的行不能以`>`开头。\n\n现在，我们将根据这个定义来分析每个选项。\n\n**选项 A：** 该摘录以一个以`>`符号开头的行（`>Contig_1_B.anthracis...`）开始。这作为标题行。随后的行包含一系列字符（A, C, G, T），代表核苷酸序列。这个结构完全符合FASTA格式的定义。\n\n**选项 B：** 该摘录仅包含序列数据。它缺少必须以`>`开头的强制性标题行。这通常被称为“原始”或“纯文本”序列格式，而不是FASTA格式。\n\n**选项 C：** 该摘录以一个以@符号（`@`）开头的行开始，而不是`>`。其后是一个序列行，一个仅包含加号（`+`）的行，然后是一行代表质量得分的ASCII字符。这种四行结构是FASTQ格式的特征，该格式常用于原始测序读数，并包含每个碱基的质量信息。它不是FASTA格式。\n\n**选项 D：** 该摘录展示了一种高度结构化的格式，带有`LOCUS`、`DEFINITION`、`ACCESSION`和`ORIGIN`等关键字。序列数据本身也标注了行号。这是GenBank文件的典型格式，该文件除了序列外还包含丰富的注释。它不是FASTA格式。\n\n**选项 E：** 该摘录显示了信息由逗号分隔的单行。这是一种分隔格式，例如逗号分隔值（CSV）文件。它不遵循FASTA格式所要求的`>`标题行和随后的序列行结构。\n\n基于这个逐步分析，只有选项A符合FASTA格式的规则。", "answer": "$$\\boxed{A}$$", "id": "1493807"}, {"introduction": "将测序读段（reads）拼接成更长的连续序列（contigs）后，我们必须评估拼接结果的质量。N50 统计量是衡量基因组拼接连续性的核心指标，一个更高的 N50 值通常意味着拼接出的基因组更完整、碎片化程度更低。通过这个练习，你将学会如何计算 N50，从而能够量化比较不同拼接策略的优劣。[@problem_id:1493824]", "problem": "一个生物信息学团队正在对一种新发现的古菌物种进行基因组组装。测序后，他们使用了两种不同的组装算法，得到了两组不同的连续DNA序列（重叠群，contigs）。为了评估和比较这两次组装的质量，该团队需要计算几个指标，其中最重要的一个是N50统计量。\n\nN50统计量是衡量组装连续性的一个指标。它被定义为这样一个重叠群的长度，该重叠群是构成总组装长度至少50%的最小重叠群集合中，长度最短的那个。\n\n您获得了其中一个输出“Assembly Alpha”的完整重叠群长度列表。重叠群的长度（单位为千碱基，kb）如下：\n`110, 15, 95, 6, 25, 45, 70, 4`\n\n计算Assembly Alpha的N50统计量。请以千碱基（kb）为单位，提供一个单一的数字作为答案。", "solution": "目标是根据给定的“Assembly Alpha”的重叠群长度集合，计算N50统计量。提供的重叠群长度（单位为千碱基，kb）为：`110, 15, 95, 6, 25, 45, 70, 4`。\n\n步骤1：计算组装的总长度。\n我们将所有重叠群的长度相加：\n$$ \\text{Total Length} = 110 + 15 + 95 + 6 + 25 + 45 + 70 + 4 $$\n$$ \\text{Total Length} = 370 \\text{ kb} $$\n\n步骤2：确定总组装长度的50%阈值。\n这是我们的重叠群长度累加和必须达到或超过的目标值。\n$$ 50\\% \\text{ of Total Length} = 0.5 \\times 370 \\text{ kb} = 185 \\text{ kb} $$\n\n步骤3：将重叠群长度按降序排序。\n将重叠群从最长到最短排列对于计算N50至关重要。\n排序后的列表：`110, 95, 70, 45, 25, 15, 6, 4`\n\n步骤4：计算排序后重叠群长度的累加和。\n我们从最大的重叠群开始，逐一将其长度相加，直到累加和大于或等于步骤2中计算出的50%阈值。\n\n- 加上第一个（最长的）重叠群：\n  累加和 = `110` kb。这个值小于 `185` kb。\n\n- 加上第二长的重叠群：\n  累加和 = `110 + 95 = 205` kb。\n\n这个累加和（`205` kb）是第一个大于或等于50%阈值（`185` kb）的和。\n\n步骤5：确定N50值。\nN50统计量被定义为：在为达到此阈值而累加的重叠群集合中，长度最短的那个重叠群的长度。在我们的例子中，这个重叠群集合是`{110, 95}`。这个集合中最短的重叠群是`95` kb。因此，N50值就是我们最后加入的那个重叠群的长度。\n\nAssembly Alpha的N50值为`95` kb。", "answer": "$$\\boxed{95}$$", "id": "1493824"}, {"introduction": "基因组拼接完成后，下一个挑战是识别其中的功能元件，例如基因，但这常常因假基因（pseudogenes）的存在而变得复杂。现代基因组学通过整合多种数据类型来解决这一问题，其中 DNA 甲基化等表观遗传学信息尤为重要。这个高级练习将向你展示如何利用甲基化数据来区分一个活跃表达的功能基因和一个被沉默的假基因，这体现了基于多重证据进行精确注释的真实科研思路。[@problem_id:1493808]", "problem": "一个生物信息学家团队正在为一个新测序的植物 *Arabidopsis fictitia* 完善基因组注释。他们的分析确定了两个不同的基因组位点，下文称为位点 A 和位点 B，这两个位点都与一个相关物种中已被充分表征的 *PHOTOCHROME Z* (*PHZ*) 基因显示出高度的序列同源性。其中一个位点是真正的、有功能的 *PHZ* 基因，而另一个是无功能的、被沉默的反转录假基因。初步的序列分析结果并不明确；两个位点似乎都缺少内含子，并且序列组装中的假象掩盖了任一位点 poly-A 尾或靶位点重复的存在。\n\n为了解决这一不确定性，该团队生成了全基因组亚硫酸氢盐测序 (WGBS) 数据，该数据可测量单个 CpG 二核苷酸处的 DNA 甲基化水平。从生物学上讲，基因启动子区域内 CpG 位点的高甲基化与转录沉默密切相关，而在基因主体内观察到的中度甲基化通常与基因表达有关。\n\n为了通过计算区分功能基因和假基因，提出了一个“功能位点分数”(FLS)。FLS 使用以下公式计算：\n$$\n\\text{FLS} = \\left( \\frac{1}{N_B} \\sum_{i=1}^{N_B} m_{B,i} \\right) \\cdot \\exp \\left( -k \\cdot \\left( \\frac{1}{N_P} \\sum_{j=1}^{N_P} m_{P,j} \\right) \\right)\n$$\n其中：\n- $m_{P,j}$ 是启动子区域内第 $j$ 个 CpG 位点的甲基化率（从 0 到 1）。\n- $N_P$ 是在启动子中分析的 CpG 位点总数。\n- $m_{B,i}$ 是基因主体内第 $i$ 个 CpG 位点的甲基化率。\n- $N_B$ 是在基因主体中分析的 CpG 位点总数。\n- $k$ 是一个无量纲常数，代表启动子甲基化的抑制强度，给定值为 $k=5.0$。\n\n两个位点的启动子和基因主体区域中 CpG 位点的甲基化数据如下所示。\n\n**位点 A 数据：**\n- 启动子 CpG 甲基化率 ($m_P$): 0.05, 0.12, 0.08, 0.15\n- 基因主体 CpG 甲基化率 ($m_B$): 0.72, 0.65, 0.75, 0.80, 0.58\n\n**位点 B 数据：**\n- 启动子 CpG 甲基化率 ($m_P$): 0.85, 0.78, 0.90, 0.81, 0.76\n- 基因主体 CpG 甲基化率 ($m_B$): 0.15, 0.25, 0.20, 0.10\n\n预计功能基因的 FLS 将显著高于被沉默的假基因。计算功能基因的 FLS。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用给定的功能位点分数定义：\n$$\n\\text{FLS}=\\left(\\frac{1}{N_{B}}\\sum_{i=1}^{N_{B}}m_{B,i}\\right)\\cdot \\exp\\left(-k\\cdot \\left(\\frac{1}{N_{P}}\\sum_{j=1}^{N_{P}}m_{P,j}\\right)\\right),\n$$\n其中 $k=5.0$。功能基因应具有较高的 FLS，因此我们计算两个位点的 FLS 并选择较大的值。\n\n对于位点 A，启动子有 $N_{P}=4$ 个 CpG 位点，值为 $0.05,0.12,0.08,0.15$。启动子的平均值为\n$$\n\\bar{m}_{P}^{A}=\\frac{0.05+0.12+0.08+0.15}{4}=\\frac{0.40}{4}=0.10.\n$$\n基因主体有 $N_{B}=5$ 个 CpG 位点，值为 $0.72,0.65,0.75,0.80,0.58$。基因主体的平均值为\n$$\n\\bar{m}_{B}^{A}=\\frac{0.72+0.65+0.75+0.80+0.58}{5}=\\frac{3.50}{5}=0.70.\n$$\n因此，\n$$\n\\text{FLS}_{A}=0.70\\cdot \\exp\\left(-5.0\\cdot 0.10\\right)=0.70\\cdot \\exp(-0.5)\\approx 0.70\\cdot 0.6065306597\\approx 0.4245714618.\n$$\n\n对于位点 B，启动子有 $N_{P}=5$ 个 CpG 位点，值为 $0.85,0.78,0.90,0.81,0.76$。启动子的平均值为\n$$\n\\bar{m}_{P}^{B}=\\frac{0.85+0.78+0.90+0.81+0.76}{5}=\\frac{4.10}{5}=0.82.\n$$\n基因主体有 $N_{B}=4$ 个 CpG 位点，值为 $0.15,0.25,0.20,0.10$。基因主体的平均值为\n$$\n\\bar{m}_{B}^{B}=\\frac{0.15+0.25+0.20+0.10}{4}=\\frac{0.70}{4}=0.175.\n$$\n因此，\n$$\n\\text{FLS}_{B}=0.175\\cdot \\exp\\left(-5.0\\cdot 0.82\\right)=0.175\\cdot \\exp(-4.10)\\approx 0.175\\cdot 0.016572675\\approx 0.002900218.\n$$\n\n由于 $\\text{FLS}_{A}\\gg \\text{FLS}_{B}$，位点 A 对应于功能基因。所需的 FLS，四舍五入到三位有效数字，为\n$$\n\\text{FLS}_{\\text{functional}}=\\text{FLS}_{A}\\approx 0.425.\n$$", "answer": "$$\\boxed{0.425}$$", "id": "1493808"}]}