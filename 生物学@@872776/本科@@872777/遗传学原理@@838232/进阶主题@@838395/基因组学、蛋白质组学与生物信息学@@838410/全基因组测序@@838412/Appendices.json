{"hands_on_practices": [{"introduction": "在全基因组测序中，一个核心的衡量标准是“测序深度”或“覆盖度”。它代表了基因组中每个碱基被独立测序的平均次数，是评估测序数据量是否充足以及组装结果可靠性的关键指标。通过这个练习，你将学会如何根据项目产生的总数据量和预估的基因组大小，计算这一基本参数。[@problem_id:1534614]", "problem": "一个遗传学家团队正在进行一项全基因组鸟枪法测序项目，以组装一种新发现的极端环境植物的基因组。测序仪器产生了大量的短 DNA 读段数据集。经过过滤和质量控制后，产生的序列数据总量为 150 吉碱基 (Gb)。根据初步的细胞学和流式细胞术分析，该植物单倍体基因组的估计大小为 5 吉碱基 (Gb)。\n\n计算该测序项目达到的平均覆盖深度。", "solution": "平均覆盖深度（也称为覆盖倍数）定义为测序的总碱基数除以单倍体基因组的大小。设 $C$ 表示覆盖深度，$B$ 表示测序的总碱基数，$G$ 表示单倍体基因组的大小。则\n$$\nC=\\frac{B}{G}.\n$$\n当 $B=150\\,\\text{Gb}$ 且 $G=5\\,\\text{Gb}$ 时，代入可得\n$$\nC=\\frac{150\\,\\text{Gb}}{5\\,\\text{Gb}}=30.\n$$\n吉碱基单位相互抵消，留下一个无量纲的覆盖倍数。因此，平均覆盖深度为 $30$。", "answer": "$$\\boxed{30}$$", "id": "1534614"}, {"introduction": "在进行复杂的基因组组装之前，对原始测序数据进行质量控制至关重要。K-mer分析是一种无需组装、直接分析测序读段（reads）的强大技术，它能揭示基因组的复杂性、重复序列含量以及是否存在污染。这个实践将挑战你像生物信息学家一样，通过解读一个假设的k-mer频率分布图来诊断样本中潜在的污染问题，这是一个非常实用的技能。[@problem_id:1534597]", "problem": "一位基因组学研究人员正在对一个液体培养物进行全基因组测序 (WGS) 实验，该培养物被推测含有一种名为 *Vibrio cholerae* 的纯种细菌菌株。作为基因组组装前的初步质量控制步骤，研究人员对原始测序读长进行了 k-mer 分析。在此分析中，使用的 k-mer 长度为 21。\n\n该分析生成了一个频率直方图，其中 x 轴表示特定 21-mer 序列在数据集中出现的次数（其频率），y 轴表示具有该频率的不同 21-mer 的数量。直方图显示出两个清晰、独立且近似钟形的峰。第一个主峰的中心频率约为 30，第二个更大的峰的中心频率约为 90。在频率为 1 处还有一个对应于测序错误的更小、更尖锐的峰，但在本分析中可以忽略。\n\n假设存在的任何细菌的基因组大小和复杂性相似，以下哪个陈述为这些观察结果提供了最合理的解释？\n\nA. *Vibrio cholerae* 基因组包含一个大的重复元件家族，这些元件在整个基因组中平均以三拷贝的形式存在。\n\nB. 该培养物被一种噬菌体（一种感染细菌的病毒）污染，且噬菌体颗粒的丰度是 *Vibrio cholerae* 细胞丰度的三倍。\n\nC. 测序过程存在缺陷，来自 DNA 正向链的读长以 30x 的深度测序，而来自反向链的读长以 90x 的深度测序。\n\nD. 该培养物被另一种细菌污染，且污染菌种的丰度大约是 *Vibrio cholerae* 丰度的三分之一。\n\nE. 该培养物被另一种细菌污染，且 *Vibrio cholerae* 的丰度大约是污染菌种丰度的三分之一。", "solution": "k-mer 直方图绘制的是，对于每个 k-mer，其在读长数据集中的计数（x 轴）与具有该计数的不同 k-mer 的数量（y 轴）之间的关系。对于一个被均匀测序的单一、非冗余基因组，独特 k-mer 的计数分布在平均覆盖度周围呈近似钟形。如果一个 k-mer 在基因组中以拷贝数 $r$ 出现，其期望计数将乘以 $r$，在 $rC$ 附近产生一个峰，其中 $C$ 是独特序列的平均覆盖度。\n\n对于基因组混合物，每个基因组 $i$ 都会在与其测序覆盖度成正比的平均 k-mer 计数 $\\mu_{i}$ 处贡献一个自己的峰。设 $B$ 为测序的总碱基数，$f_{i}$ 为源自基因组 $i$ 的碱基比例，$G_{i}$ 为基因组大小。基因组 $i$ 的平均深度（因此也是独特 k-mer 的平均 21-mer 计数）为\n$$\n\\mu_{i} = \\frac{B f_{i}}{G_{i}}.\n$$\n因此，对于两个基因组 $1$ 和 $2$，\n$$\n\\frac{\\mu_{2}}{\\mu_{1}} = \\frac{f_{2} G_{1}}{f_{1} G_{2}}.\n$$\n根据问题中任何存在的细菌基因组都具有相似大小和复杂性的假设，我们取 $G_{1} \\approx G_{2}$，从而得到\n$$\n\\frac{\\mu_{2}}{\\mu_{1}} \\approx \\frac{f_{2}}{f_{1}}.\n$$\n观察到的峰值分别在约 $30$ 和 $90$ 处，这意味着\n$$\n\\frac{90}{30} \\approx 3 \\quad \\Rightarrow \\quad \\frac{f_{\\text{higher}}}{f_{\\text{lower}}} \\approx 3,\n$$\n即，一个菌种的丰度大约是另一个菌种的三倍。\n\n此外，对于每个物种，其峰下的面积（贡献的不同 21-mer 的总数）与基因组大小和复杂性成比例；当 $G_{1} \\approx G_{2}$ 时，峰面积相似。因为对于给定的平均值 $\\mu$，k-mer 计数的方差近似为 $\\mu$（类泊松抽样），所以具有较大 $\\mu$ 的分布更窄（标准差为 $\\sqrt{\\mu}$），因此在相似面积下其峰显得更高。因此，90 处的较高峰对应于丰度更高的物种。\n\n现在评估各个选项：\n\n- A: 三拷贝重复会为重复的 k-mer 在 $3C$ 附近产生一个次级峰，但独特部分仍会在 $C$ 处产生一个主峰。要使 $3C$ 峰大于 $C$ 峰，大多数不同的 21-mer 必须来自三拷贝重复，这对于典型的细菌基因组来说是不太可能的，并且通常还会在其他多重性上产生额外的峰。这比混合物种的解释更不合理。\n\n- B: 噬菌体的基因组要小得多，并且不符合对细菌“大小和复杂性相似”的假设。颗粒丰度的三倍差异不能直接导致 k-mer 直方图中观察到的两个类似细菌的主峰；噬菌体贡献的独特 k-mer 会少得多，使其不太可能产生一个与细菌相当的主峰。\n\n- C: 以不同深度测序正向和反向链不会产生两个不同的 k-mer 覆盖度峰，因为 k-mer 计数通常会汇总两条链的计数（并且通常会将反向互补序列进行规范化）。链特异性的深度不平衡不会将 k-mer 直方图分裂成两个不同多重性的独立峰。\n\n- D 和 E: 两种基因组大小相似的细菌的混合物自然会产生两个峰，其平均计数与其相对丰度成正比。比率 $90/30 \\approx 3$ 表明丰度相差三倍，而 90 处的较高峰必定是丰度更高的物种。在一个本应是 *Vibrio cholerae* 纯菌株的培养物中，最可能的情况是 *Vibrio cholerae* 仍然是主要成分，而污染物的丰度大约是其三分之一。这直接对应于陈述 D。\n\n因此，与直方图、峰位置所暗示的丰度比以及基因组大小相似的假设相一致的最合理解释是 D。", "answer": "$$\\boxed{D}$$", "id": "1534597"}, {"introduction": "为了获得既完整又高度准确的基因组序列，研究人员常采用“混合组装”策略，即结合长读段测序（保证连续性）和短读段测序（保证准确性）的优势。此练习模拟了这一前沿方法中的一个关键步骤——“抛光”（polishing），即利用高精度的短读段来校正初步组装草图中的错误。你需要通过定量分析，计算并评估这一过程对最终基因组准确率的提升效果。[@problem_id:1534611]", "problem": "一个基因组学实验室正在对从热液喷口分离出的一种新发现的细菌进行基因组测序。他们的目标是生成一个高度准确、完整的基因组序列。他们采用了一种混合组装策略，使用了两种不同的测序技术。\n\n首先，他们使用易出错的长读长测序技术生成一个初步的草图组装。这个草图组装代表了完整的基因组，其总大小为 $G = 5.20$ 百万碱基对（Mbp）。质量评估显示，这个初步的长读长组装的总体碱基准确率为 $A_L = 99.20\\%$。\n\n接下来，为了提高序列质量，他们进行了高通量、高准确度的短读长测序。然后，他们使用一个生物信息学的“校正”流程将这些短读长序列比对回长读长草图组装上并纠正错误。这个校正流程的性能先前已经过基准测试，并由两个关键指标来表征：\n1.  该流程成功识别并纠正了初始长读长组装中存在的 $98.5\\%$ 的单核苷酸错误。\n2.  该流程并非完美；由于短读长序列中的随机错误和模糊比对，它也会错误地修改初始组装中已经正确的一小部分碱基，从而引入新的错误。这种情况发生的比率为 $0.0040\\%$。\n\n计算经过校正的混合组装的最终总体碱基准确率。将你的答案表示为小数值（例如，99%的准确率应写为0.99）。将最终答案四舍五入到五位有效数字。", "solution": "设 $A_{L}$ 为初始准确率，$E_{L}=1-A_{L}$ 为初始错误率。设 $r_{c}$ 为校正过程纠正的初始错误的比例，设 $r_{f}$ 为校正过程将初始正确的碱基变为错误的比例。\n\n给定 $A_{L}=0.9920$，$E_{L}=1-A_{L}=0.0080$，$r_{c}=0.985$，以及 $r_{f}=0.000040$。\n\n最终的准确率是以下两项之和：\n- 保持正确的初始正确碱基：$A_{L}(1-r_{f})$，\n- 被纠正的初始错误碱基：$E_{L}r_{c}$。\n\n因此，\n$$\nA_{\\text{final}}=A_{L}(1-r_{f})+E_{L}r_{c}.\n$$\n代入给定值，\n$$\nA_{\\text{final}}=0.9920(1-0.000040)+0.0080\\times 0.985\n=0.9920\\times 0.99996+0.00788\n=0.99196032+0.00788\n=0.99984032.\n$$\n四舍五入到五位有效数字，得到 $0.99984$。", "answer": "$$\\boxed{0.99984}$$", "id": "1534611"}]}