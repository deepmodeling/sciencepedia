{"hands_on_practices": [{"introduction": "许多测序项目的主要目标是为一个基因组创建一个高质量的“从头”组装。我们衡量一个组装质量的好坏，不仅看其总大小，更看重其连续性——即它由多少个、多长的片段组成。N50统计量是量化这种连续性的标准方法，更高的N50值意味着组装的碎片化程度更低、更完整，这也是长读长测序技术的一个关键优势。这项练习将让你亲身体验计算和解读N50值，这是基因组学中的一项基本技能，通过比较两个假设的组装结果[@problem_id:1501367]，你将亲眼看到测序技术的选择对最终结果的巨大影响。", "problem": "一个分子生物学家团队正在研究一种新发现的真菌物种的基因组。该基因组的大小估计约为20兆碱基（Mb）。为了创建一个参考基因组，他们采用了两种不同的脱氧核糖核酸（DNA）测序和组装流程，得到了两个不同的草图组装，他们将其标记为组装A和组装B。\n\n基因组组装的质量通常通过其连续性来衡量，而连续性可以用N50统计量来量化。N50定义为这样一个最小的重叠群（contig）长度，使得长度大于或等于该长度的重叠群的总长度至少占组装基因组总序列的一半。在这些计算中，假设1兆碱基（Mb）= 1,000千碱基（kb）。\n\n这两个组装的内容如下：\n- **组装A** 包括：5个100 kb的重叠群，10个80 kb的重叠群，20个60 kb的重叠群，150个50 kb的重叠群，100个40 kb的重叠群，以及300个20 kb的重叠群。\n- **组装B** 包括：一个7 Mb的重叠群，一个5 Mb的重叠群，一个3 Mb的重叠群，一个2 Mb的重叠群，一个1 Mb的重叠群，以及四个0.5 Mb的重叠群。\n\n基于对这两个组装的分析，以下哪个陈述是关于所用测序技术的最准确结论？\n\nA. 组装A很可能是使用长读长测序生成的，因为它有更多的重叠群，这表明对基因组的覆盖更全面。\nB. 组装A很可能是使用长读长测序生成的，因为它的N50值较小，这是长读长测序较高错误率的特征。\nC. 组装B很可能是使用长读长测序生成的，因为较大的N50表示更好的组装连续性，这是使用较长读长跨越重复区域的一个主要优势。\nD. 组装B很可能是使用长读长测序生成的，因为其组装总大小正好是20 Mb，与估计值完全匹配。\nE. 仅凭这些数据无法确定测序技术；还需要关于读长错误率的信息。", "solution": "这个问题的目标是比较两个基因组组装，计算它们各自的N50值，并利用这些信息推断每个组装可能使用了哪种测序技术（长读长与短读长）。\n\n首先，我们必须计算每个组装的总大小，以验证它们具有可比性，并为N50计算找到中点。\n\n对于组装A，总大小是其所有重叠群长度的总和：\n总大小 A = (5 * 100 kb) + (10 * 80 kb) + (20 * 60 kb) + (150 * 50 kb) + (100 * 40 kb) + (300 * 20 kb)\n总大小 A = 500 kb + 800 kb + 1,200 kb + 7,500 kb + 4,000 kb + 6,000 kb\n总大小 A = 20,000 kb = 20 Mb。\n\n对于组装B，总大小是：\n总大小 B = (1 * 7 Mb) + (1 * 5 Mb) + (1 * 3 Mb) + (1 * 2 Mb) + (1 * 1 Mb) + (4 * 0.5 Mb)\n总大小 B = 7 Mb + 5 Mb + 3 Mb + 2 Mb + 1 Mb + 2 Mb\n总大小 B = 20 Mb。\n\n两个组装的总大小均为20 Mb。为了计算N50，我们需要找到一个重叠群长度，使得长度大于或等于该长度的重叠群的累积大小达到组装总大小的50%，即 0.5 * 20 Mb = 10 Mb。\n\n现在，我们来计算组装A的N50。我们需要以千碱基（kb）为单位进行计算。目标累积大小是10,000 kb。我们将重叠群按大小降序排列，并计算它们总长度的累积和：\n1.  100 kb的重叠群：5 * 100 kb = 500 kb。累积和 = 500 kb。\n2.  80 kb的重叠群：10 * 80 kb = 800 kb。累积和 = 500 kb + 800 kb = 1,300 kb。\n3.  60 kb的重叠群：20 * 60 kb = 1,200 kb。累积和 = 1,300 kb + 1,200 kb = 2,500 kb。\n4.  50 kb的重叠群：150 * 50 kb = 7,500 kb。累积和 = 2,500 kb + 7,500 kb = 10,000 kb。\n\n在包含所有50 kb的重叠群后，累积和正好达到10,000 kb。根据定义，N50是这组中最小的重叠群长度，因此组装A的N50是50 kb。\n\n接下来，我们计算组装B的N50。目标累积大小是10 Mb。我们将重叠群按大小降序排列，并计算它们长度的累积和：\n1.  7 Mb的重叠群：1 * 7 Mb = 7 Mb。累积和 = 7 Mb。\n2.  5 Mb的重叠群：1 * 5 Mb = 5 Mb。累积和 = 7 Mb + 5 Mb = 12 Mb。\n\n在包含5 Mb的重叠群后，累积和（12 Mb）超过了10 Mb的目标。因此，组装B的N50是这个重叠群的长度，即5 Mb。\n\n现在我们比较这两个组装。\n- 组装A：N50 = 50 kb = 0.05 Mb\n- 组装B：N50 = 5 Mb\n\n组装B的N50是组装A的N50的100倍。更高的N50值表示组装的连续性更好，碎片化程度更低。长读长测序技术（例如PacBio、Oxford Nanopore）产生非常长的读长，可以跨越基因组中的重复或复杂区域。这些区域很难用短读长（例如Illumina）进行组装，会导致组装中断，产生大量较小的重叠群。因此，长读长技术通常能产生连续性高得多、N50值大得多的组装结果。组装B具有高达5 Mb的N50，是长读长组装的典型特征。组装A具有高度碎片化的性质和低至50 kb的N50，是短读长组装的典型特征。\n\n最后，我们来评估给出的选项：\nA：错误。重叠群数量越多表明组装越碎片化，质量越低，这是短读长技术的典型特征，而非长读长技术。\nB：错误。较小的N50表示组装更碎片化，这不是一个成功的长读长组装项目的特征。长读长的主要优势是获得高的N50值。\nC：正确。与组装A（50 kb）相比，组装B的N50（5 Mb）要大得多。这种卓越的连续性是长读长测序技术的标志性成就，该技术擅长解决通常会使短读长组装碎片化的重复基因组元件。\nD：错误。两个组装的总大小都是20 Mb，因此这不是它们之间的区别特征。\nE：错误。尽管像错误率这样的其他指标对于全面了解组装质量很重要，但N50的差异如此之大，并且是读长长度的直接结果，因此它可作为区分底层测序技术的一个非常有力的主要指标。\n\n因此，最准确的结论是组装B很可能是使用长读长测序生成的。", "answer": "$$\\boxed{C}$$", "id": "1501367"}, {"introduction": "除了生成线性的基因组图谱，长读长测序在解析复杂的基因组结构特征方面也表现出色。许多细菌含有称为质粒的环状DNA分子，用短读长测序很难证明一个组装好的序列是真正的环状，而不是一个线性片段。然而，一条测序了整个质粒的长读长就能为环状结构提供确切的证据。这项练习是一个思想实验，旨在挑战你想象测序数据在比对时的样子；理解这种“环绕”比对模式[@problem_id:1501345]对于解读长读长数据和验证基因组结构至关重要。", "problem": "一位研究人员正在研究一种新型细菌，并使用计算方法组装了其基因组。组装结果包含一个推定的环状质粒，总长度为15,000个碱基对 (bp)。为了验证组装结果并确认该质粒确实是环状的，研究人员对该细菌的遗传物质进行了长读长测序。获得了一条长度约为15,000 bp的高质量单读长，它似乎跨越了整个质粒分子。\n\n组装好的15,000 bp质粒序列被用作线性参考序列。该参考序列只是将环状序列从一个任意的核苷酸（被指定为位置1）开始“展开”，到位置15,000结束。这条长读长是从环状质粒生成的线性核苷酸序列，它也有一个起始点，但这个起始点是随机的，不一定与参考序列的位置1相对应。\n\n当这条单长读长通过计算与线性参考序列进行比对时，以下哪种描述最能体现出能证实该质粒为环状的预期比对模式？\n\nA. 这条15,000 bp的读长连续地进行比对，从参考序列的位置1开始，到位置15,000精确结束。\nB. 该读长在可视化时被分裂成两个片段。读长的起始端比对到参考序列末端附近的一个区域，而读长的末端比对到参考序列起始端附近的一个区域。\nC. 该读长比对到参考序列的正中间，使得参考序列的起始端和末端各有大约7,500 bp未被比对上。\nD. 该读长从参考序列的位置1比对到位置15,000，但在其中心部分显示出一个大的缺失，表明有一个片段丢失。\nE. 该读长比对到参考序列，但读长的一个大的中心部分相对于参考序列是倒位的。", "solution": "设环状质粒的总长度为 $L=15000$ 个碱基对。环状分子的线性参考序列是通过在位置 $L$ 和 $1$ 之间选择一个任意切点，然后列出从位置 $1$ 到位置 $L$ 的环状序列而获得的。由环状质粒产生的单条长读长始于环上的一个随机位置；记这个起始位置相对于线性参考序列的偏移量为 $s$，其中 $s\\in\\{1,\\dots,L\\}$。\n\n因为该读长跨越了整个环，其序列等于从位置 $s$ 开始并连续延伸 $L$ 个碱基的环状序列。在线性参考序列的坐标中，这意味着读长的前缀对应于区间 $[s,L]$，而读长的后缀对应于区间 $[1,s-1]$。当与线性化的参考序列进行比对时，这会产生一个跨越线性参考序列人为断点的分裂式比对：读长的起始端比对到参考序列的末端附近（接近位置 $L$ 的位置），而读长的末端比对到参考序列的起始端附近（接近位置 $1$ 的位置）。\n\n只有在 $s=1$ 的特殊情况下，读长才会从线性参考序列的位置 $1$ 连续比对到位置 $L$；对于一个随机的起始点，这并非普遍预期的结果。因此：\n- 选项A只会在 $s=1$ 时发生，这是一个特例，而不是环状分子的典型模式。\n- 选项B符合预期的跨参考序列两端的分裂式比对，这是由于环绕环状起点造成的，也是证实环状特性的标志。\n- 选项C描述了一个内部比对块，两侧有未比对上的区域，而不是环状性的环绕特征。\n- 选项D表明存在缺失，而不是环状环绕。\n- 选项E表明存在倒位，而不是环状环绕。\n\n因此，证实环状特性的比对模式是分裂式比对，即读长的起始端映射到参考序列的末端附近，其末端映射到起始端附近，这与选项B相对应。", "answer": "$$\\boxed{B}$$", "id": "1501345"}, {"introduction": "长读长测序最强大的应用之一是在医学领域，它可以识别出其他方法可能漏掉的遗传变异。长读长可以单次跨越大的插入或缺失（称为结构性变异），从而精确地确定它们的大小和在基因中的位置。这一点至关重要，因为这类变异可能会极大地改变蛋白质的功能。这个问题[@problem_id:1501350]将测序的技术操作与其生物学后果联系起来，你将利用长读长测序的结果，追踪一个基因插入从DNA层面到蛋白质层面的影响，并计算其大小的变化——这是理解遗传性疾病的关键一步。", "problem": "一位分子遗传学家正在研究一名疑似患有影响结缔组织的遗传性疾病的患者。利用长读长测序技术，这位遗传学家分析了*Fibrillogen-Associated Protein 1 (FGAP1)*基因。数据显示，许多比对到该基因的读长在第11号外显子内包含一个大的插入片段。在参考基因组中，第11号外显子长330个碱基对 (bp)。患者的读长显示，一个新颖的1,500 bp序列正好插入到该外显子第120个核苷酸之后。由参考等位基因产生的野生型FGAP1蛋白由950个氨基酸组成。对这1,500 bp插入序列的生物信息学分析证实，其中不包含任何框内终止密码子。假设单个氨基酸的平均分子量为110道尔顿 (Da)，并且这个改变了的等位基因被转录和翻译成一个稳定的蛋白质，计算突变型FGAP1蛋白的预测分子量。以千道尔顿 (kDa) 为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "我们已知FGAP1参考编码序列产生一个长度为 $L_{\\text{wt}}=950$ 个氨基酸的蛋白质。一个 $1{,}500$ bp的插入发生在第11号外显子内，位于第 $120$ 个核苷酸之后。编码是以三联体形式进行的，因此插入片段所编码的氨基酸数量即为其包含的密码子数量：\n$$\nL_{\\text{ins}}=\\frac{1{,}500\\ \\text{bp}}{3\\ \\text{bp/codon}}=500\\ \\text{amino acids}.\n$$\n因为 $120$ 可被 $3$ 整除，且插入片段的长度也是 $3$ 的倍数，所以阅读框得以保留。生物信息学分析表明插入片段中没有框内终止密码子，因此翻译会穿过插入片段并正常继续。因此，突变蛋白的长度为\n$$\nL_{\\text{mut}}=L_{\\text{wt}}+L_{\\text{ins}}=950+500=1{,}450\\ \\text{amino acids}.\n$$\n使用每个氨基酸的平均分子量 $m_{\\text{aa}}=110\\ \\text{Da/amino acid}$，突变蛋白的分子量（以道尔顿为单位）为\n$$\nM_{\\text{mut}}=L_{\\text{mut}}\\,m_{\\text{aa}}=1{,}450\\times 110=159{,}500\\ \\text{Da}.\n$$\n换算成千道尔顿，\n$$\nM_{\\text{mut}}=159.5\\ \\text{kDa}.\n$$\n四舍五入到三位有效数字，得到\n$$\n1.60\\times 10^{2}\\ \\text{kDa}.\n$$\n根据指令，我们仅以指定的单位 (kDa) 报告数值，即 $1.60\\times 10^{2}$。", "answer": "$$\\boxed{1.60 \\times 10^{2}}$$", "id": "1501350"}]}