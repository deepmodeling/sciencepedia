{"hands_on_practices": [{"introduction": "在任何单细胞基因组学分析中，第一步关键任务是进行质量控制，以区分高质量的细胞数据和技术噪音。这个练习将模拟单细胞RNA测序（scRNA-seq）数据分析的初始筛选步骤，帮助你学习如何利用基本指标（如UMI总数和检测到的基因数）来识别那些未能成功捕获活细胞的“空液滴”。掌握这一基本技能对于确保后续分析的准确性和可靠性至关重要[@problem_id:1520761]。", "problem": "在一个典型的基于液滴的单细胞RNA测序（scRNA-seq）实验中，细胞悬浮液被分配到数百万个微小的油滴中。每个液滴被设计为包含一个细胞和一个微珠。每个微珠表面都覆盖着数百万个拷贝的独特DNA序列，称为“条形码”（barcode），它使得来自单个液滴的所有RNA分子都能被标记，并能在之后追溯其来源。此外，每个捕获的RNA分子都会被一个唯一的分子标识符（UMI）标记，这是一个短的随机序列，使研究人员能够计算原始RNA转录本的绝对数量，从而防止在测序过程中的扩增导致的过度计数。\n\n分析scRNA-seq数据时的一个关键挑战是区分成功捕获了活细胞的液滴和未能捕获细胞但可能含有来自初始悬浮液中裂解细胞的少量环境RNA的“空液滴”。\n\n一位研究人员进行了一项scRNA-seq实验，并获得了四个代表性条形码的数据摘要。对于每个条形码，分析流程报告了计数的UMI总数以及从这些UMI中检测到的不同基因的总数。摘要如下：\n\n*   **条形码 GATC：** 共检测到 12,540 个UMI，对应 3,150 个不同的基因。\n*   **条形码 CCTA：** 共检测到 9,880 个UMI，对应 2,890 个不同的基因。\n*   **条形码 TGAN：** 共检测到 150 个UMI，对应 85 个不同的基因。\n*   **条形码 AGCT：** 共检测到 11,060 个UMI，对应 3,010 个不同的基因。\n\n根据这些信息，哪个条形码最有可能代表一个空液滴？\n\nA. GATC\n\nB. CCTA\n\nC. TGAN\n\nD. AGCT", "solution": "我们用 $U$ 表示为一个条形码检测到的唯一分子标识符（UMI）的总数，用 $G$ 表示从这些UMI中观察到的不同基因的总数。在基于液滴的scRNA-seq中，包含活的单个细胞的液滴通常表现出高 $U$ 和高 $G$，这反映了细胞内的RNA含量。相比之下，空液滴主要捕获的是少量且稀疏的环境RNA，导致其 $U$ 和 $G$ 值要小得多。这是拐点法（knee/inflection methods）和能够识别环境RNA的测试（ambient-RNA-aware tests）所使用的核心原理：$U$ 值低了几个数量级且相应地 $G$ 值也低的液滴被分类为空液滴。\n\n将此标准应用于这四个条形码：\n- GATC: $U=12540$, $G=3150$\n- CCTA: $U=9880$, $G=2890$\n- TGAN: $U=150$, $G=85$\n- AGCT: $U=11060$, $G=3010$\n\nGATC、CCTA 和 AGCT 这三个条形码的 $U$ 值很大，在 $10^{4}$ 的数量级， $G$ 值也很大，在 $10^{3}$ 的数量级，这与包含单个细胞的液滴相符。条形码 TGAN 的 $U=150$ 且 $G=85$，比其他条形码小了几个数量级，这是环境背景的特征。因此，TGAN 最有可能代表一个空液滴。", "answer": "$$\\boxed{C}$$", "id": "1520761"}, {"introduction": "在获得了高质量的细胞数据之后，下一个核心挑战是解读这些细胞的身份和功能。这个练习将带你进入单细胞数据可视化的世界，通过一个名为UMAP的降维图谱来探索细胞异质性。你将学习如何通过特定基因的表达模式来识别和标记细胞簇，这一过程类似于在地图上寻找地标，是定义细胞类型和状态的基础[@problem_id:1520807]。", "problem": "一组发育生物学家正在使用单细胞RNA测序（scRNA-seq）技术研究来自小鼠胚胎的组织样本，该技术可以测量数千个单个细胞的基因表达谱。处理数据后，他们使用一种名为统一流形逼近与投影（UMAP）的降维算法来可视化数据。在生成的UMAP图中，每个点代表一个细胞，具有相似整体基因表达模式的细胞彼此靠近。\n\n该分析识别出五个不同的细胞簇，据推测这些细胞簇代表了胚胎组织中存在的不同细胞类型。为了表征这些细胞簇，一位研究人員将特定基因 *Fgf8* 的表达水平叠加到UMAP图上。他们观察到，五个簇中的一个簇里的细胞一致地高表达 *Fgf8*，而其他四个簇中的细胞几乎不表达或完全不表达该基因。\n\n仅根据这一观察，最准确的科学结论是什么？\n\nA. *Fgf8* 是该高表达簇所代表的细胞群体的标记基因。\n\nB. *Fgf8* 编码的蛋白质是组织中所有细胞生存最关键的蛋白质。\n\nC. *Fgf8* 的表达是UMAP分析过程中形成该特定细胞簇的直接原因。\n\nD. UMAP可视化存在缺陷，因为像 *Fgf8* 这样的功能重要基因应在所有细胞类型中表达。\n\nE. 高表达簇内的每个细胞都以完全相同的速率转录 *Fgf8* 基因。", "solution": "1. 明确数据类型和可视化原理：单细胞RNA测序测量每个细胞中许多基因的转錄本丰度，生成一个高维表达矩阵。像UMAP这样的降维方法将细胞嵌入低维空间，使得具有相似全局转录组谱的细胞彼此靠近。因此，UMAP中的簇反映了整体基因表达模式的相似性，而不必然是任何单个基因的作用。\n\n2. 解读单个基因表达的叠加图：在UMAP上叠加特定基因的表达，可以显示该基因在何处相对富集。给出的观察结果是，一个簇显示出 Fgf8 的一致性高表达，而其他四个簇几乎不表达。这表明在该数据集中，Fgf8 的表达与该簇中的细胞有特异性关联。\n\n3. 定义标记基因的概念：标记基因在操作上定义为一个基因，其表达相对于其他细胞群体而言，对某个特定的细胞群体是特异的或显著富集的，从而能够识别该群体。观察到 Fgf8 在一个簇中高表达，而在其他簇中低表达或缺失，这与 Fgf8 在此数据集中作为该群体的标记基因是一致的。\n\n4. 根据原则评估其他解释：\n- 反对B：仅从转录本丰度模式无法得出关于该蛋白质对所有细胞生存至关重要性的任何结论。此外，该基因在四个簇中表达极少，这反驳了从该数据集推断出其具有普遍生存作用的观点。\n- 反对C：UMAP是一种基于全局表达相似性的无监督方法；虽然 Fgf8 对整体表达谱有贡献，但声称其表达是形成簇的直接原因是不合理的。\n- 反对D：认为功能重要的基因必须在所有细胞类型中表达的期望是错误的；许多基因具有受限的、谱系或状态特异性的表达。基于此，该可视化并无缺陷。\n- 反对E：“一致性高”在色阶上的表现并不意味着所有细胞的转录速率完全相同；scRNA-seq数据存在噪声，并且可视化通常使用阈值或连续色阶，这可能会掩盖细胞间的变异性。\n\n5. 结论：仅基于该观察，最准确的结论是 Fgf8 可用作该分析中高表达簇所代表的细胞群体的标记基因，与选项A一致。", "answer": "$$\\boxed{A}$$", "id": "1520807"}, {"introduction": "单细胞基因组学的一个强大应用是比较不同条件下（例如，药物处理与对照组）细胞状态的变化。然而，要得出可靠的结论，我们必须采用恰当的统计方法。这个练习将揭示为什么传统的统计检验（如t检验）不适用于分析单细胞测序数据，并强调理解数据自身独特的统计特性（如零膨胀和高变异性）的重要性[@problem_id:1520754]。", "problem": "一个免疫学家团队正在研究一种名为“Immunomodulin”的新药对脾脏细胞组成的影响。他们使用单细胞RNA测序（scRNA-seq）技术来比较两组小鼠的脾细胞：一组用Immunomodulin治疗，另一组用安慰剂治疗作为对照组。数据处理后，计算分析识别出几个不同的细胞簇。该团队专注于一个被鉴定为“滤泡辅助T细胞”（Tfh）的特定细胞簇。\n\n他们的目标是鉴定在治疗组和对照组之间，Tfh细胞簇内差异表达的基因。一位初级分析师提出了一个直接的方法：对于每个基因，计算治疗组中所有Tfh细胞的平均表达计数，并使用标准的双样本t检验将其与对照组中所有Tfh细胞的平均表达计数进行比较。\n\n然而，一位高级生物信息学家立即指出，这种方法在统计学上不适用于scRNA-seq数据。下列哪个陈述提供了最根本和关键的统计学原因，解释了为什么简单地使用t检验比较平均表达计数对于此类数据是无效的？\n\nA. 将脾脏组织解离成单细胞的过程会引入显著的机械应力，导致随机的基因表达伪影，这些伪影无法通过t检验进行建模。\n\nB. 治疗组和对照组中捕获的Tfh细胞簇的总细胞数可能不同，这违反了t检验的等样本量假设。\n\nC. 在一个细胞簇内，任何给定基因的表达数据都不是正态分布的；它们是离散计数，其特点是零值比例高和方差大（过离散），这违反了t检验的核心假设。\n\nD. 用于将细胞分配到“滤泡辅助T细胞”簇的计算算法可能错误分类了一些细胞，从而在分析中引入了来自其他细胞类型的噪声。\n\nE. 治疗组和对照组的测序实验在不同日期进行，引入了技术性的批次效应，这混淆了平均表达值的比较。", "solution": "我们将初级分析师的提议形式化如下：对于Tfh细胞簇内的每个基因，设治疗组的观测值为 $X_{1j}$（$j=1,\\dots,n_{1}$），对照组的观测值为 $X_{2k}$（$k=1,\\dots,n_{2}$），其中每个 $X$ 是每个细胞的表达计数。预期的假设检验是\n$$\nH_{0}:\\mu_{1}=\\mu_{2} \\quad \\text{versus} \\quad H_{A}:\\mu_{1}\\neq\\mu_{2},\n$$\n通过双样本t检验实现，其检验统计量为Welch形式\n$$\nt=\\frac{\\bar{X}_{1}-\\bar{X}_{2}}{\\sqrt{\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}}},\n$$\n其中 $\\bar{X}_{i}$ 和 $s_{i}^{2}$ 分别是第 $i$ 组的样本均值和方差。\n\n双样本t检验（标准或Welch）严重依赖于分布假设：每个组内的观测值是独立同分布的，具有近似正态的误差和连续的支撑集，并且在 $H_{0}$ 下，标准化均值差异的抽样分布遵循t分布。Welch的版本放宽了等方差假设，但仍然要求组均值具有近似正态性，而这基于的底层数据不能是严重非正态的，尤其不能是具有点质量和强均值-方差耦合的高度离散数据。\n\n对于scRNA-seq计数数据，在一种细胞类型中，对于任何给定的基因，数据 $X_{ij}$ 是离散的非负整数，由于生物稀疏性和技术性脱扣（technical dropouts），零值的比例很高，并且它们表现出过离散（overdispersion），即\n$$\n\\operatorname{Var}(X_{ij}) \\gg \\mathbb{E}[X_{ij}],\n$$\n相对于泊松基线而言。这通常需要使用负二项模型或零膨胀模型。这种分布远非正态分布，并且具有由计数数据固有的均值-方差关系驱动的异方差性。因此，对于原始的scRNA-seq计数数据，双样本t检验的核心分布假设（正态性和适用于t参考分布的误差结构）被违反，使得通过t检验简单比较均值在统计上是无效的。\n\n讨论干扰项：样本量不等（B）不会使Welch t检验无效；批次效应（E）、错误分类（D）和解离伪影（A）是重要的实践问题，但它们不是导致t检验不适用于原始计数数据的根本分布原因。最关键和根本的原因是scRNA-seq计数的非正态、零膨胀、过离散和离散的性质，这在选项C中得到了概括。", "answer": "$$\\boxed{C}$$", "id": "1520754"}]}