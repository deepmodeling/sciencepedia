{"hands_on_practices": [{"introduction": "哈迪-温伯格平衡的卡方检验是群体遗传学中的一个基本工具。本练习将指导你完成计算卡方（$\\chi^2$）统计量的核心步骤，为你打下坚实的基础。通过分析一个果蝇群体的基因型数据，你将学会如何从观测数据出发，计算等位基因频率，推导期望的基因型数量，并最终量化观测值与理论预测之间的偏差 ([@problem_id:1525127])。", "problem": "一位遗传学家正在研究一个已被维持了许多代的隔离的实验室果蝇 (*Drosophila melanogaster*) 种群。该研究的重点是残翅基因座上的等位基因频率。控制长翅的野生型等位基因（记为 `$+$`）对控制残翅的隐性等位基因（记为 `$vg$`）呈完全显性。从该种群中随机抽取了1200只成年果蝇，并使用分子标记对其进行基因分型。三种可能基因型的观察计数如下：512个基因型为 $+/+$ 的个体，568个基因型为 $+/vg$ 的个体，以及120个基因型为 $vg/vg$ 的个体。\n\n研究人员希望量化这些观察计数与哈迪-温伯格平衡模型预测的理论计数之间的偏差。对此，一种标准方法是计算卡方（$\\chi^2$）统计量，其公式为 $\\chi^2 = \\sum \\frac{(O - E)^2}{E}$，其中 $O$ 代表观察计数，$E$ 代表平衡原假设下的期望计数。\n\n计算该种群数据的 $\\chi^2$ 统计量的值。将最终答案保留三位有效数字。", "solution": "设总样本量为 $N=1200$，观察到的基因型计数为 $O_{++}=512$，$O_{+vg}=568$，以及 $O_{vgvg}=120$。设 $p$ 为 $+$ 等位基因的频率，$q$ 为 $vg$ 等位基因的频率，且 $p+q=1$。从基因型计数中估算等位基因频率：\n$$\np=\\frac{2O_{++}+O_{+vg}}{2N}=\\frac{2\\cdot 512+568}{2\\cdot 1200}=\\frac{1592}{2400}=\\frac{199}{300},\\quad q=1-p=\\frac{101}{300}.\n$$\n在哈迪-温伯格平衡条件下，期望的基因型计数为\n$$\nE_{++}=Np^{2}=1200\\left(\\frac{199}{300}\\right)^{2}=\\frac{39601}{75},\\quad\nE_{+vg}=N(2pq)=1200\\cdot 2\\cdot \\frac{199}{300}\\cdot \\frac{101}{300}=\\frac{40198}{75},\\quad\nE_{vgvg}=Nq^{2}=1200\\left(\\frac{101}{300}\\right)^{2}=\\frac{10201}{75}.\n$$\n卡方统计量为 $\\chi^{2}=\\sum \\frac{(O-E)^{2}}{E}$，因此逐项计算：\n$$\n\\frac{(O_{++}-E_{++})^{2}}{E_{++}}=\\frac{\\left(512-\\frac{39601}{75}\\right)^{2}}{\\frac{39601}{75}}\n=\\frac{\\left(\\frac{38400-39601}{75}\\right)^{2}}{\\frac{39601}{75}}\n=\\frac{\\left(\\frac{-1201}{75}\\right)^{2}}{\\frac{39601}{75}}\n=\\frac{1442401}{75\\cdot 39601},\n$$\n$$\n\\frac{(O_{+vg}-E_{+vg})^{2}}{E_{+vg}}=\\frac{\\left(568-\\frac{40198}{75}\\right)^{2}}{\\frac{40198}{75}}\n=\\frac{\\left(\\frac{42600-40198}{75}\\right)^{2}}{\\frac{40198}{75}}\n=\\frac{\\left(\\frac{2402}{75}\\right)^{2}}{\\frac{40198}{75}}\n=\\frac{5769604}{75\\cdot 40198},\n$$\n$$\n\\frac{(O_{vgvg}-E_{vgvg})^{2}}{E_{vgvg}}=\\frac{\\left(120-\\frac{10201}{75}\\right)^{2}}{\\frac{10201}{75}}\n=\\frac{\\left(\\frac{9000-10201}{75}\\right)^{2}}{\\frac{10201}{75}}\n=\\frac{\\left(\\frac{-1201}{75}\\right)^{2}}{\\frac{10201}{75}}\n=\\frac{1442401}{75\\cdot 10201}.\n$$\n因此，\n$$\n\\chi^{2}=\\frac{1442401}{75\\cdot 39601}+\\frac{5769604}{75\\cdot 40198}+\\frac{1442401}{75\\cdot 10201}\\approx 4.28468.\n$$\n保留三位有效数字得到 $\\chi^{2}\\approx 4.28$。", "answer": "$$\\boxed{4.28}$$", "id": "1525127"}, {"introduction": "计算出卡方值只是分析的第一步，更关键的是如何解读这个数值并做出科学的结论。本练习将带你进入假设检验的决策过程，你将把计算出的卡方统计量与给定的临界值进行比较。这个过程能帮助你判断一个群体的基因型频率是否显著偏离了哈迪-温伯格平衡的预期，从而决定是接受还是拒绝原假设 ([@problem_id:1525163])。", "problem": "一家生物技术公司为进行遗传学研究，饲养了一个大型的、随机交配的果蝇（*Drosophila melanogaster*）种群。一个控制眼睛颜色的特定基因有两个等位基因：一个是显性等位基因，决定红眼（$R$）；另一个是隐性等位基因，决定深褐色眼（$r$）。利用先进的分子标记，该公司能够区分纯合显性（$RR$）和杂合（$Rr$）个体，这两种个体都表现为红眼。\n\n最近对该种群中1000只果蝇的随机样本进行的一次普查得出了以下计数：\n- 380只红眼纯合子（$RR$）\n- 440只红眼杂合子（$Rr$）\n- 180只深褐色眼个体（$rr$）\n\n首席遗传学家想要检验这个种群关于该眼色基因是否处于哈迪-温伯格平衡状态。使用标准的统计显著性水平 $\\alpha = 0.05$，适当的分析得出的临界卡方（$\\chi^2$）值为3.841。根据该数据的计算出的$\\chi^2$统计量与临界值的比较，应得出什么结论？\n\nA. 该种群处于哈迪-温伯格平衡状态，因为计算出的$\\chi^2$值小于3.841。\n\nB. 该种群不处于哈迪-温伯格平衡状态，因为计算出的$\\chi^2$值大于3.841。\n\nC. 该种群处于哈迪-温伯格平衡状态，尽管与预期频率相比杂合子数量不足。\n\nD. 由于等位基因计数方法存在根本性错误，该种群不处于哈迪-温伯格平衡状态。\n\nE. 由于样本量1000对于这种规模的种群来说太小，检验结果不确定。", "solution": "设观察到的基因型计数为 $O_{RR}=380$，$O_{Rr}=440$，$O_{rr}=180$，总数为 $N=1000$。在哈迪-温伯格平衡（HWE）状态下，基因型频率分别为：$RR$ 为 $p^{2}$，$Rr$ 为 $2pq$，$rr$ 为 $q^{2}$，其中 $p$ 是等位基因 $R$ 的频率，$q=1-p$ 是等位基因 $r$ 的频率。\n\n使用观察到的基因型计数估计等位基因频率：\n$$\np=\\frac{2O_{RR}+O_{Rr}}{2N},\\quad q=\\frac{2O_{rr}+O_{Rr}}{2N}.\n$$\n代入计数可得：\n$$\np=\\frac{2\\cdot 380+440}{2\\cdot 1000}=\\frac{1200}{2000}=\\frac{3}{5},\\quad q=\\frac{2\\cdot 180+440}{2000}=\\frac{800}{2000}=\\frac{2}{5}.\n$$\n\n在HWE下的预期基因型计数为：\n$$\nE_{RR}=Np^{2}=1000\\cdot\\left(\\frac{3}{5}\\right)^{2}=360,\\quad\nE_{Rr}=N(2pq)=1000\\cdot 2\\cdot\\frac{3}{5}\\cdot\\frac{2}{5}=480,\\quad\nE_{rr}=Nq^{2}=1000\\cdot\\left(\\frac{2}{5}\\right)^{2}=160.\n$$\n\n使用卡方拟合优度统计量：\n$$\n\\chi^{2}=\\sum_{\\text{genotypes}}\\frac{(O-E)^{2}}{E}\n=\\frac{(380-360)^{2}}{360}+\\frac{(440-480)^{2}}{480}+\\frac{(180-160)^{2}}{160}.\n$$\n计算每一项：\n$$\n\\frac{(20)^{2}}{360}=\\frac{400}{360}=\\frac{10}{9},\\quad\n\\frac{(-40)^{2}}{480}=\\frac{1600}{480}=\\frac{10}{3},\\quad\n\\frac{(20)^{2}}{160}=\\frac{400}{160}=\\frac{5}{2}.\n$$\n因此，\n$$\n\\chi^{2}=\\frac{10}{9}+\\frac{10}{3}+\\frac{5}{2}=\\frac{125}{18}\\approx 6.944.\n$$\n\n因为 $p$ 是从数据中估计的，所以自由度为 $3-1-1=1$。在显著性水平 $\\alpha=0.05$ 和 $1$ 自由度下，给出的临界值为 $3.841$。由于 $\\chi^{2}\\approx 6.944 > 3.841$，我们拒绝HWE的原假设。因此，适当的结论是该种群不处于哈迪-温伯格平衡状态。\n\n正确选项是B。", "answer": "$$\\boxed{B}$$", "id": "1525163"}, {"introduction": "当卡方检验的结果表明群体偏离了哈迪-温伯格平衡时，一个自然而然的问题是：这种偏差具体是由哪种或哪几种基因型造成的？本练习将引导你进行更深层次的分析，通过分解卡方统计量，计算每个基因型对总偏差的贡献。这种方法可以揭示偏差的内在结构，例如，是由于杂合子过多还是纯合子不足，从而为进一步的演化机制研究提供线索 ([@problem_id:2396513])。", "problem": "在一个包含 $n$ 个二倍体个体的队列中，对一个双等位基因的常染色体位点进行了基因分型。观测到的基因型计数为 $O_{AA}=150$、$O_{Aa}=300$ 和 $O_{aa}=50$，因此 $n=500$。在哈迪-温伯格平衡 (HWE) 的零假设下，使用该样本估计等位基因 $A$ 的频率，然后求出相应的期望基因型计数。使用基于这些期望计数的 HWE 卡方 ($\\chi^{2}$) 拟合优度检验框架，计算每个基因型 $g\\in\\{AA,Aa,aa\\}$ 的贡献值 $\\left(O_{g}-E_{g}\\right)^{2}/E_{g}$，并确定最大的单个贡献值。仅报告此最大单个贡献值的数值。将您的答案四舍五入到三位有效数字。", "solution": "第一步是根据观测到的样本数据估计等位基因频率。设 $\\hat{p}$ 为等位基因 $A$ 的估计频率，$\\hat{q}$ 为等位基因 $a$ 的估计频率。在 $n=500$ 个二倍体个体的样本中，等位基因总数为 $2n = 1000$。等位基因 $A$ 的频率通过计算所有 $A$ 等位基因的数量并除以等位基因总数得到。\n\n$A$ 等位基因的数量由 $2 \\times O_{AA} + O_{Aa}$ 给出。\n$$ \\text{Count}(A) = 2 \\times 150 + 300 = 300 + 300 = 600 $$\n因此，等位基因 $A$ 的估计频率为：\n$$ \\hat{p} = \\frac{2 \\times O_{AA} + O_{Aa}}{2n} = \\frac{600}{1000} = 0.6 $$\n\n同样，$a$ 等位基因的数量由 $2 \\times O_{aa} + O_{Aa}$ 给出。\n$$ \\text{Count}(a) = 2 \\times 50 + 300 = 100 + 300 = 400 $$\n等位基因 $a$ 的估计频率为：\n$$ \\hat{q} = \\frac{2 \\times O_{aa} + O_{Aa}}{2n} = \\frac{400}{1000} = 0.4 $$\n作为一个必要的检验，等位基因频率之和必须为1：$\\hat{p} + \\hat{q} = 0.6 + 0.4 = 1.0$。这是正确的。\n\n接下来，在哈迪-温伯格平衡的零假设下，我们使用这些估计的等位基因频率计算期望的基因型计数 ($E_{g}$)。期望的基因型频率为 $P(AA) = \\hat{p}^2$、$P(Aa) = 2\\hat{p}\\hat{q}$ 和 $P(aa) = \\hat{q}^2$。期望的计数是这些频率乘以总样本量 $n$。\n\n基因型 $AA$ 的期望计数为：\n$$ E_{AA} = n \\times \\hat{p}^2 = 500 \\times (0.6)^2 = 500 \\times 0.36 = 180 $$\n\n基因型 $Aa$ 的期望计数为：\n$$ E_{Aa} = n \\times 2\\hat{p}\\hat{q} = 500 \\times 2 \\times 0.6 \\times 0.4 = 500 \\times 0.48 = 240 $$\n\n基因型 $aa$ 的期望计数为：\n$$ E_{aa} = n \\times \\hat{q}^2 = 500 \\times (0.4)^2 = 500 \\times 0.16 = 80 $$\n作为检验，期望计数之和必须等于总样本量：$E_{AA} + E_{Aa} + E_{aa} = 180 + 240 + 80 = 500 = n$。这也是正确的。\n\n最后，我们使用公式 $\\frac{(O_{g}-E_{g})^{2}}{E_{g}}$ 计算每个基因型对卡方统计量的贡献。\n\n对于基因型 $AA$：\n$$ \\chi_{AA}^2 = \\frac{(O_{AA} - E_{AA})^2}{E_{AA}} = \\frac{(150 - 180)^2}{180} = \\frac{(-30)^2}{180} = \\frac{900}{180} = 5 $$\n\n对于基因型 $Aa$：\n$$ \\chi_{Aa}^2 = \\frac{(O_{Aa} - E_{Aa})^2}{E_{Aa}} = \\frac{(300 - 240)^2}{240} = \\frac{(60)^2}{240} = \\frac{3600}{240} = 15 $$\n\n对于基因型 $aa$：\n$$ \\chi_{aa}^2 = \\frac{(O_{aa} - E_{aa})^2}{E_{aa}} = \\frac{(50 - 80)^2}{80} = \\frac{(-30)^2}{80} = \\frac{900}{80} = 11.25 $$\n\n每个基因型的贡献值分别为 $5$、$15$ 和 $11.25$。问题要求确定最大的单个贡献值。\n$$ \\max(\\chi_{AA}^2, \\chi_{Aa}^2, \\chi_{aa}^2) = \\max(5, 15, 11.25) = 15 $$\n该值为整数。问题指定四舍五入到三位有效数字。数字 $15$ 有两位有效数字。要用三位有效数字表示，必须写成 $15.0$。", "answer": "$$\\boxed{15.0}$$", "id": "2396513"}]}