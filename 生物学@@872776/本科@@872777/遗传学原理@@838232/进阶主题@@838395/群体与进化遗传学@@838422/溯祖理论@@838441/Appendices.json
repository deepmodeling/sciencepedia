{"hands_on_practices": [{"introduction": "合并理论的一个基本假设是，当回溯时间时，任何一对谱系都有同等的机会率先合并成一个共同祖先。这个练习将通过一个直接的概率计算，帮助你掌握这一核心原则，并理解在给定样本中特定合并事件发生的可能性。", "problem": "一位群体遗传学家正在使用一个简化的种群动态模型来研究一个物种的祖先。在这个模型中，假定种群规模在时间上是庞大且恒定的。这位遗传学家从四个标记为 A、B、C 和 D 的不同个体中收集 DNA，并向后追溯它们的遗传历史。这些个体中的每一个都代表一个独特的遗传谱系。\n\n一个“合并事件”被定义为过去两个不同谱系追溯到一个最近共同祖先 (MRCA) 的时刻。该模型的基本假设是，当回溯时间时，任何一对现存的谱系都是同样可能下一个发生合并的。\n\n给定四个谱系（A、B、C 和 D）的初始样本，第一个发生的合并事件恰好是谱系 A 和 B 合并的精确概率是多少？\n\n请用最简分数表示你的答案。", "solution": "问题要求在四个谱系（A、B、C 和 D）的样本中，特定的一对谱系 (A, B) 成为第一个合并的概率。\n\n问题中陈述的核心原则是，任何一对现存的谱系都是同样可能下一个发生合并的。因此，要解决这个问题，我们需要确定可能合并的配对总数，然后计算我们感兴趣的特定结果与这个总数的比率。\n\n首先，我们确定样本中的谱系总数，即 $n=4$。一个合并事件涉及这些谱系中恰好两个的合并。所以，我们的任务是计算从集合 {A, B, C, D} 中可以形成多少个不同的谱系配对。这是一个组合问题，具体来说是从 4 个项目中选择 2 个。\n\n从一个包含 $n$ 个项目的集合中选择 $k$ 个项目的方法数由二项式系数 $\\binom{n}{k}$ 给出，计算如下：\n$$ \\binom{n}{k} = \\frac{n!}{k!(n-k)!} $$\n在我们的例子中，$n=4$ 且 $k=2$。所以，第一次合并事件的可能配对总数为：\n$$ \\binom{4}{2} = \\frac{4!}{2!(4-2)!} = \\frac{4!}{2!2!} = \\frac{4 \\times 3 \\times 2 \\times 1}{(2 \\times 1)(2 \\times 1)} = \\frac{24}{4} = 6 $$\n这 6 种可能的配对是：(A, B)、(A, C)、(A, D)、(B, C)、(B, D) 和 (C, D)。\n\n根据模型的假设，这 6 个可能的合并事件中的任何一个都同样可能是第一个发生的。这 6 对的集合代表了第一次合并事件所有可能结果的整个样本空间。\n\n我们感兴趣的特定事件是谱系 A 和 B 的合并。这对应于可能结果中的一个：配对 (A, B)。\n\n特定事件的概率是有利结果数与所有可能结果总数的比率。\n有利结果数（A 和 B 合并）= 1。\n所有可能结果总数（任意一对合并）= 6。\n\n因此，概率 $P$ 为：\n$$ P(\\text{A与B首先合并}) = \\frac{\\text{有利结果数}}{\\text{所有可能结果总数}} = \\frac{1}{6} $$\n答案要求以最简分数的形式给出，而 $\\frac{1}{6}$ 就是最简分数。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1477306"}, {"introduction": "在理解了哪一对谱系可能首先合并之后，一个自然而然的问题是：合并事件大约在*何时*发生？本练习引入了“等待时间”这一合并理论的基石概念。你将计算在一个样本中，直到第一次合并事件发生所需经历的预期世代数，从而将事件概率与演化时间尺度联系起来。", "problem": "考虑一个大小恒为 $N$ 个体的理想二倍体种群。在此模型中，世代是离散且不重叠的。我们假设某一世代中的每个等位基因都是从上一代的完整基因库中随机选取的一个等位基因的完美拷贝。任何亲代世代的基因库总共包含 $2N$ 个等位基因。\n\n当向后追溯等位基因的祖先时，“溯祖事件”被定义为两个不同的遗传谱系在紧邻的上一代中源自同一个亲代等位基因的时刻。\n\n假设您从当前种群中收集了一个包含四个不同等位基因的样本。您希望向后追溯它们的祖先。计算在这四个谱系中的任意一对之间发生第一次溯祖事件，需要回溯的期望代数。这样的事件会将您样本中不同祖先谱系的数量从四个减少到三个。\n\n用包含种群大小 $N$ 的解析公式表示您的答案。", "solution": "我们使用 Wright–Fisher 模型来为大小恒为 $N$ 的二倍体种群的繁殖建模，因此 $t-1$ 代中的 $2N$ 个等位基因中的每一个，对于 $t$ 代的任何一个等位基因来说，都是一个等可能的亲本。将 $k$ 个抽样谱系向后追溯一代，每个谱系都独立地从 $2N$ 个亲代等位基因中均匀随机选择一个亲本等位基因。\n\n对于任意一对特定的谱系，它们在紧邻的上一代发生溯祖（即，两者选择了同一个亲代等位基因）的概率是\n$$\n\\frac{1}{2N},\n$$\n因为在第一个谱系选择了一个祖先后，第二个谱系必须在 $2N$ 个等可能的等位基因中选择与之相同的那个。\n\n当有 $k=4$ 个谱系时，存在 $\\binom{4}{2}=6$ 个无序对。在标准溯祖近似（忽略了多个谱系同时发生溯祖的概率，这是一个 $(2N)^{-2}$ 阶的事件）下，每一代至少有一对谱系发生溯祖的概率是\n$$\np=\\binom{4}{2}\\cdot\\frac{1}{2N}=\\frac{6}{2N}=\\frac{3}{N}.\n$$\n因为每回溯一代，要么发生一次溯祖事件（减少谱系数量），要么所有四个谱系保持独立，并且在每一步中情况都以相同的概率更新，所以到第一次溯祖事件的等待时间 $T$（以代为单位）服从成功参数为 $p$ 的几何分布。因此，直到第一次溯祖事件发生的期望代数是\n$$\n\\mathbb{E}[T]=\\frac{1}{p}=\\frac{N}{3}.\n$$", "answer": "$$\\boxed{\\frac{N}{3}}$$", "id": "1477286"}, {"introduction": "现在，我们将综合运用前面学到的知识，来解答一个宏观问题：一个样本所有成员的共同祖先生活在多久以前？这个最终练习将引导你推导“最近共同祖先的总预期时间”（TMRCA）。通过将每个合并阶段的预期等待时间累加起来，你将得出品种遗传学中一个至关重要的结论，并体会到合并理论的强大预测能力。", "problem": "在群体遗传学中，赖特-费舍尔模型为理解遗传漂变提供了一个简化的数学框架。考虑一个由 $N$ 个个体组成的、大小恒定的稳定、隔离的二倍体物种种群。这意味着在每一代中，该种群的基因库中任何给定基因都有 $2N$ 个拷贝。在这个种群中，我们从当前代中抽取 $n$ 个基因拷贝（其中 $2 \\le n \\le 2N$），并希望随时间回溯它们的祖先。所有谱系最终都将追溯到一个共同的祖先基因拷贝。我们感兴趣的是这 $n$ 个基因样本的最近共同祖先的期望时间（TMRCA）。\n\n假设遵循赖特-费舍尔模型的原理，即每一代的整个基因库都是通过从上一代基因库中有放回地抽样形成的，请为这 $n$ 个抽样基因拷贝的期望TMRCA推导出一个闭式解析表达式。您的答案应以世代为单位，并表示为种群大小 $N$ 和样本大小 $n$ 的函数。", "solution": "该问题要求计算一个大小为 $N$ 的二倍体种群中 $n$ 个基因拷贝样本的最近共同祖先的期望时间（TMRCA）。根据赖特-费舍尔模型，种群中总共有 $2N$ 个基因拷贝。我们可以随时间向后追溯这 $n$ 个样本的谱系。\n\n让我们用 $k$ 表示在某个过去的世代中不同祖先谱系的数量。最初，在抽样时，我们有 $k=n$ 个不同的谱系。随着时间回溯，这些谱系会合并（即，找到一个共同的祖先）。当所有谱系都合并成一个单一祖先时，即 $k=1$ 时，这个过程完成。到达最近共同祖先的总时间是谱系数量从 $n$ 减少到 $n-1$，从 $n-1$ 减少到 $n-2$，依此类推，直到从 2 减少到 1 的各段等待时间之和。\n\n让我们考虑当存在 $k$ 个不同谱系时的系统。任意两个特定谱系在紧邻的上一代找到其共同祖先的概率，等于它们都是从同一个亲代基因拷贝而来的概率。在一个有 $2N$ 个基因拷贝的种群中，这个概率是 $\\frac{1}{2N}$。\n\n当我们有 $k$ 个谱系时，有 $\\binom{k}{2}$ 对不同的谱系可能发生合并。在上一代发生一次合并事件的概率是谱系对的数量乘以单个谱系对发生合并的概率。我们假设对于大的 $N$ 值，在单一代中发生一次以上合并事件的概率是可忽略不计的。\n因此，当有 $k$ 个谱系时，发生一次合并事件的概率是：\n$$P_k = \\binom{k}{2} \\frac{1}{2N} = \\frac{k(k-1)}{2} \\frac{1}{2N} = \\frac{k(k-1)}{4N}$$\n\n一次合并事件发生的等待时间（即谱系数量从 $k$ 减少到 $k-1$ 所需的时间）服从成功概率为 $P_k$ 的几何分布。这个时间间隔的期望等待时间 $E[T_k]$ 是成功概率的倒数：\n$$E[T_k] = \\frac{1}{P_k} = \\frac{4N}{k(k-1)}$$\n\n到达最近共同祖先的总期望时间 $E[T_{\\text{total}}]$ 是谱系数量从 $n$ 减少到 2 的每个时间间隔的期望等待时间之和。我们将从 $k=2$ 到 $k=n$ 的各项求和。\n$$E[T_{\\text{total}}] = \\sum_{k=2}^{n} E[T_k] = \\sum_{k=2}^{n} \\frac{4N}{k(k-1)}$$\n我们可以从求和式中提出常数 $4N$：\n$$E[T_{\\text{total}}] = 4N \\sum_{k=2}^{n} \\frac{1}{k(k-1)}$$\n为了计算这个和，我们对求和式中的项使用部分分式分解：\n$$\\frac{1}{k(k-1)} = \\frac{A}{k} + \\frac{B}{k-1}$$\n两边乘以 $k(k-1)$ 得到 $1 = A(k-1) + Bk$。\n如果我们令 $k=1$，得到 $1 = B(1) \\implies B=1$。\n如果我们令 $k=0$，得到 $1 = A(-1) \\implies A=-1$。\n所以，分解式为：\n$$\\frac{1}{k(k-1)} = \\frac{1}{k-1} - \\frac{1}{k}$$\n现在我们将此代入我们的求和式中。该和成为一个裂项级数：\n$$E[T_{\\text{total}}] = 4N \\sum_{k=2}^{n} \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right)$$\n让我们展开求和的各项：\n当 $k=2$ 时：$\\frac{1}{1} - \\frac{1}{2}$\n当 $k=3$ 时：$\\frac{1}{2} - \\frac{1}{3}$\n当 $k=4$ 时：$\\frac{1}{3} - \\frac{1}{4}$\n...\n当 $k=n$ 时：$\\frac{1}{n-1} - \\frac{1}{n}$\n\n将这些项相加，所有的中间项都相互抵消：\n$$\\sum_{k=2}^{n} \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right) = \\left(1 - \\frac{1}{2}\\right) + \\left(\\frac{1}{2} - \\frac{1}{3}\\right) + \\left(\\frac{1}{3} - \\frac{1}{4}\\right) + \\dots + \\left(\\frac{1}{n-1} - \\frac{1}{n}\\right) = 1 - \\frac{1}{n}$$\n将这个结果代回到总期望时间的表达式中：\n$$E[T_{\\text{total}}] = 4N \\left(1 - \\frac{1}{n}\\right)$$\n这就是以世代为单位的期望TMRCA的闭式解析表达式。", "answer": "$$\\boxed{4N\\left(1 - \\frac{1}{n}\\right)}$$", "id": "1477323"}]}