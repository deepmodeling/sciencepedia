## 引言
[连锁不平衡](@entry_id:146203)与单倍型是[群体遗传学](@entry_id:146344)的核心概念，它们描述了基因在[染色体](@entry_id:276543)上并非独立遗传，而是以特定组合（单倍型）形式传递的现象，以及这些组合在群体中非随机关联（[连锁不平衡](@entry_id:146203)）的程度。理解这些概念是破译基因组信息、揭示疾病遗传基础和追溯演化历史的关键。

尽管孟德尔的[自由组合定律](@entry_id:145562)是遗传学的基础，但现实中位于同一[染色体](@entry_id:276543)上的基因往往倾向于一同遗传。本文旨在系统性地解决这一现象，阐明为何以及如何量化等位基因之间的关联性，以及这些关联模式所蕴含的生物学意义。

读者将通过本文学习到[连锁不平衡](@entry_id:146203)与单倍型的完整知识体系。在“原理与机制”一章，我们将建立核心定义和量化方法。接着，“应用与交叉学科联系”一章将展示这些原理如何在疾病定位、演化研究乃至神经科学等领域大放异彩。最后，“动手实践”部分将通过具体问题，巩固并应用所学知识。这套结构化的学习路径将引导你从基础理论平稳过渡到前沿应用，让你全面掌握连锁不平衡与单倍型这一强大的[遗传分析](@entry_id:167901)工具。

## 原理与机制

在本章中，我们将深入探讨[连锁不平衡](@entry_id:146203)与单倍型的核心原理与机制。在前一章介绍背景知识的基础上，我们将系统性地解构这些概念，从最基本的定义出发，逐步探索量化它们的方法，并最终理解塑造其在基因组中[分布](@entry_id:182848)的进化力量。

### 单倍型：[染色体](@entry_id:276543)上的等位基因组合

在遗传学中，一个[基因座](@entry_id:177958)（locus）上的特定DNA序列被称为一个**等位基因（allele）**。对于一个二倍体生物，其体细胞中的每一对同源[染色体](@entry_id:276543)都分别携带了每个[基因座](@entry_id:177958)的一个等位基因。当我们考察单个[染色体](@entry_id:276543)时，位于该[染色体](@entry_id:276543)上不同[基因座](@entry_id:177958)的一系列等位基因的特定组合，就构成了**单倍型（haplotype）**。这个词源于“单倍体基因型”（haploid genotype），精确地描述了遗传自单个亲本的[染色体](@entry_id:276543)片段上的等位基因构成。

为了更清晰地理解，让我们考虑一个在两个[基因座](@entry_id:177958)上均为杂合的个体，其基因为$R/r ; T/t$。这意味着在第一[基因座](@entry_id:177958)上，该个体拥有$R$和$r$两个等位基因；在第二[基因座](@entry_id:177958)上，拥有$T$和$t$两个等位基因。这两个[基因座](@entry_id:177958)的等位基因在同源[染色体](@entry_id:276543)对上的[排列](@entry_id:136432)方式，被称为**[连锁相](@entry_id:201938)（phase）**。存在两种可能的[连锁相](@entry_id:201938)配置 [@problem_id:1501150]：

1.  **顺式连锁（Coupling or Cis Phase）**：显性（或野生型）等位基因位于同一条[染色体](@entry_id:276543)上，而隐性（或突变型）等位基因位于另一条同源[染色体](@entry_id:276543)上。对于上述个体，这意味着其两条[染色体](@entry_id:276543)分别携带$RT$和$rt$单倍型。这种配置可以表示为 $RT/rt$。

2.  **反式连锁（Repulsion or Trans Phase）**：一个显性等位基因与一个[隐性等位基因](@entry_id:274167)位于同一条[染色体](@entry_id:276543)上。这意味着该个体的两条[染色体](@entry_id:276543)分别携带$Rt$和$rT$单倍型。这种配置可以表示为 $Rt/rT$。

[连锁相](@entry_id:201938)的确定对于群体遗传学研究至关重要。然而，在标准的基因分型技术中，我们通常只能确定一个个体的基因型（例如，$AaBb$），而无法直接获知其单倍型组合是$AB/ab$还是$Ab/aB$。这种基因型数据被称为是**未定相的（unphased）**。这种不确定性带来了挑战：仅凭未定相的基因型数据，我们无法精确计算群体中特定单倍型的确切数量。

例如，在一个包含多个基因型的群体样本中，对于基因型为$AABB$的个体，我们确定其贡献了两个$AB$单倍型；对于$AABb$的个体，我们确定其贡献了一个$AB$和一个$Ab$单倍型。但对于双杂合子$AaBb$，情况变得模糊。它可能处于顺式连锁（$AB/ab$），不贡献$Ab$单倍型；也可能处于反式连锁（$Ab/aB$），贡献一个$Ab$单倍型。因此，群体中$Ab$单倍型的总数只能被确定在一个范围内，其上下限取决于所有双杂合子个体的[连锁相](@entry_id:201938) [@problem_id:1501136]。[统计推断](@entry_id:172747)方法，如最大期望算法（Expectation-Maximization algorithm），常被用来从这些未定相的数据中估计最可能的单倍型频率。

### 连锁平衡与不平衡：量化等位基因关联性

在群体遗传学中，一个核心问题是：不同[基因座](@entry_id:177958)上的等位基因是独立遗传的，还是彼此之间存在关联？这个问题的答案引出了连锁平衡与[连锁不平衡](@entry_id:146203)的概念。

**连锁平衡（Linkage Equilibrium, LE）**是理想化的状态，可以视作一种遗传学上的零假设。在这种状态下，一个单倍型在其群体中的频率等于其所包含的各个[等位基因频率](@entry_id:146872)的乘积。换言之，特定等位基因在某个[基因座](@entry_id:177958)上的出现，与其在另一[基因座](@entry_id:177958)上和哪个等位基因组合在一起是完全[随机和](@entry_id:266003)独立的。例如，对于两个[基因座](@entry_id:177958)的等位基因$A/a$和$B/b$，如果群体处于连锁平衡状态，那么$AB$单倍型的频率（$P_{AB}$）将等于$A$等位基因的频率（$p_A$）与$B$等位基因的频率（$p_B$）的乘积：

$P_{AB} = p_A p_B$

然而，在真实群体中，这种理想状态常常被打破。当一个单倍型的观测频率不等于其组分[等位基因频率](@entry_id:146872)的乘积时，我们就称这两个[基因座](@entry_id:177958)处于**连锁不平衡（Linkage Disequilibrium, LD）**状态。LD意味着等位基因之间存在非随机的关联。

为了量化这种偏离程度，群体遗传学家定义了**连锁不平衡系数（coefficient of linkage disequilibrium）**，通常用**$D$**表示。对于等位基因$A$和$B$，$D$的计算公式为：

$D = P_{AB} - p_A p_B$

$D$值衡量了观测到的$AB$单倍型频率与在连锁平衡假设下期望频率之间的差异。

*   如果 $D = 0$，表示两个[基因座](@entry_id:177958)处于连锁平衡状态。
*   如果 $D > 0$，表示$A$和$B$等位基因（以及$a$和$b$）同时出现的频率高于预期，这通常被称为顺式关联。
*   如果 $D < 0$，表示$A$和$b$等位基因（以及$a$和$B$）同时出现的频率高于预期，这被称为反式关联。

利用$D$值，我们可以描述所有四种可能的单倍型频率 [@problem_id:1501138] [@problem_id:1944771]：

$P_{AB} = p_A p_B + D$
$P_{Ab} = p_A p_b - D$
$P_{aB} = p_a p_B - D$
$P_{ab} = p_a p_b + D$

这组关系式是理解LD的基石。例如，如果我们通过抽样调查一个群体，获得了各个单倍型的计数，我们就能计算出$D$值。假设在一个包含1000条[染色体](@entry_id:276543)的样本中，我们观察到$CG$单倍型有600个，$CA$有50个，$TG$有150个，$TA$有200个。首先计算[等位基因频率](@entry_id:146872)：$p_C = (600+50)/1000 = 0.65$，$p_G = (600+150)/1000 = 0.75$。然后计算$CG$单倍型的频率：$P_{CG} = 600/1000 = 0.6$。最后计算$D$：

$D = P_{CG} - p_C p_G = 0.6 - (0.65 \times 0.75) = 0.6 - 0.4875 = 0.1125$

这个正值表明，在这个群体中，$C$等位基因和$G$等位基因倾向于一起出现在同一条[染色体](@entry_id:276543)上，其关联程度超过了随机组合的预期 [@problem_id:1944761]。

### 塑造连锁不平衡的进化力量

连锁不平衡并非一个静态属性，而是由多种进化力量共同塑造的动态过程。我们可以将这些力量分为两类：削弱LD的力量和产生LD的力量。群体中观测到的LD水平，正是这些力量相互抗衡的结果。

#### 重组：削弱LD的主要力量

**遗传重组（Genetic Recombination）**是[减数分裂](@entry_id:140926)期间同源[染色体](@entry_id:276543)之间发生交换（即交换）的结果，它是打破现有等位基因组合并创造新单倍型的主要机制。当两个[基因座](@entry_id:177958)位于同一[染色体](@entry_id:276543)上时，它们之间发生重组的概率被称为**重组率（recombination rate）**，用$r$表示。[重组率](@entry_id:203271)与两个[基因座](@entry_id:177958)之间的物理距离密切相关：距离越远，重组率越高（上限为0.5，等同于位于不同[染色体](@entry_id:276543)上的[自由组合](@entry_id:141921)）。

重组的作用是不断地将群体推向连锁平衡。在[随机交配](@entry_id:149892)的群体中，如果没有其他进化力量的干扰，LD会随着世代的推移而衰减。衰减的速率由[重组率](@entry_id:203271)$r$决定。第$t$代的LD系数$D_t$与初始的LD系数$D_0$之间的关系如下：

$D_t = D_0 (1-r)^t$

这个公式揭示了一个关键点：LD的衰减是几何级的。[重组率](@entry_id:203271)$r$越大（即[基因座](@entry_id:177958)相距越远），$(1-r)$的值越小，LD衰减得就越快。相反，如果两个[基因座](@entry_id:177958)物理上非常接近，导致$r$很小，那么LD的衰减就会非常缓慢，这种关联可以持续许多代 [@problem_id:1944727]。这直接解释了为什么在基因组中，物理距离近的标记往往表现出更强的LD。

#### 突变：新单倍型的最终来源

**突变（Mutation）**是遗传变异的最终来源，也是产生LD的一个根本原因。当一个新突变发生时，它必然出现在一条特定的[染色体](@entry_id:276543)上，这条[染色体](@entry_id:276543)在其他[基因座](@entry_id:177958)上已经拥有了一套确定的等位基因。

设想一个原本在M[基因座](@entry_id:177958)上是固定的（只有$M$等位基因）的群体。此时，该[基因座](@entry_id:177958)与任何其他[基因座](@entry_id:177958)（如Q[基因座](@entry_id:177958)，有$Q$和$q$等位基因）之间不存在LD。现在，假设一个$M$等位基因突变成了新的$m$等位基因，而这个突变恰好发生在一根携带$Q$等位基因的[染色体](@entry_id:276543)上。在这一瞬间，群体中所有携带$m$等位基因的[染色体](@entry_id:276543)（此时只有一根）也都携带$Q$等位基因。$Qm$单倍型存在，而$qm$单倍型不存在。这种新等位基因与特定遗传背景的绝对关联，就是一种极端的[连锁不平衡](@entry_id:146203) [@problem_id:1501164]。因此，每个新突变都以与特定单倍型完全连锁的方式进入群体，从而创造出LD。后续的重组事件会逐渐打破这种初始的关联。

#### 遗传漂变：单倍型频率的随机波动

**遗传漂变（Genetic Drift）**是指在有限大小的群体中，由于[抽样误差](@entry_id:182646)导致的等位基因（以及单倍型）频率的随机波动。漂变在[小群](@entry_id:198763)体中尤为显著，它也能有效地产生LD。

一个经典的例子是**[奠基者效应](@entry_id:146976)（Founder Effect）**。当一小部分个体从一个大的、处于连锁平衡的群体中分离出来，建立一个新的孤立群体时，这些奠基者所携带的单倍型组合可能因偶然的抽样而偏离原来的平衡状态。例如，即使来源群体中$AB$, $Ab$, $aB$, $ab$四种单倍型频率符合平衡预期，一个仅由5个个体组成的奠基群体可能碰巧携带了不成比例的$AB$单倍型。在这个新建立的奠基群体中，即使两个[基因座](@entry_id:177958)位于不同[染色体](@entry_id:276543)上（$r=0.5$），也会立即产生LD [@problem_id:1501157]。随着新群体的繁衍，这种由漂变偶然产生的LD可能会被固定下来或进一步改变。

#### 种群混合：混合产生不平衡

当两个或多个先前隔离、且[等位基因频率](@entry_id:146872)不同的群体发生合并时，这一过程被称为**种群混合（Population Admixture）**。即使每个源群体内部都处于连锁平衡状态，混合后的新群体几乎总是会表现出LD。

这个现象的产生是纯粹的数学结果。假设一个“高地”群体和一个“低地”群体，两者内部均为连锁平衡。但“高地”群体的$A$等位基因频率很高而$B$等位基因频率很低，而“低地”群体则相反。当这两个群体以等比例混合时，新形成的混合群体同时获得了大量来自高地的$Ab$型个体（等位基因$A$和$b$频率高）和大量来自低地的$aB$型个体（等位基因$a$和$B$频率高）。这导致在混合群体中，$Ab$和$aB$单倍型的频率远高于基于混合群体平均[等位基因频率](@entry_id:146872)所计算的[期望值](@entry_id:153208)。结果就是在混合群体中产生了显著的（通常是负的）LD [@problem_id:1501182]。这种由混合产生的LD是人类群体遗传学研究中的一个重要考虑因素，因为它能反映群体的历史迁徙和融合事件。

### LD的高级度量与基因组特征

虽然$D$是LD的基础度量，但它存在一个局限性：其取值范围受到相关[等位基因频率](@entry_id:146872)的制约。这使得在不同等位基因频率的[基因座](@entry_id:177958)之间比较LD强度变得困难。为了克服这一点，遗传学家发展出了[标准化](@entry_id:637219)的LD度量。

#### LD的[标准化](@entry_id:637219)：$D'$ 与 $r^2$

两个最常用的[标准化](@entry_id:637219)LD度量是$D'$（D prime）和$r^2$（r-squared）。

**$D'$** 是将$D$值用其可能达到的最大[绝对值](@entry_id:147688)$D_{max}$进行[标准化](@entry_id:637219)后的结果：

$D' = \frac{D}{D_{max}}$

其中，$D_{max}$的计算方式为：如果 $D > 0$，$D_{max} = \min(p_A p_b, p_a p_B)$；如果 $D < 0$，$D_{max} = \min(p_A p_B, p_a p_b)$。$D'$的取值范围为-1到1。$|D'|=1$意味着四个可能的单倍型中至少有一个不存在。这表明历史上没有发生过（或后代已丢失）能够产生该缺失单倍型的重组或突变事件。因此，$D'$常被用来推断位点间的重组历史。

**$r^2$**，即**平方[相关系数](@entry_id:147037)（squared correlation coefficient）**，是另一个重要的度量，其计算公式为：

$r^2 = \frac{D^2}{p_A p_a p_B p_b}$

$r^2$的取值范围为0到1。它衡量了两个位点等位基因状态的[统计相关性](@entry_id:267552)或可预测性。如果$r^2=1$，意味着知道一个位点的等位基因就可以完美地预测另一个位点的等位基因。如果$r^2=0$，则两者完全不相关。$r^2$在全基因组关联研究（GWAS）中尤其重要，因为它直接关系到一个标记SNP（[单核苷酸多态性](@entry_id:173601)）在多大程度上能够“标记”或代表另一个功能性但未测量的变异。

$D'$和$r^2$提供了互补的信息。一个引人注目的情况是，两个位点可能表现出完美的连锁（$|D'|=1$）但相关性却很低（$r^2$接近0）。这种情况通常发生在两个位点的等位基因频率差异悬殊时。例如，假设一个罕见的等位基因$A$总是与常见的等位基因$B$一起出现（即$Ab$单倍型缺失，$D'=1$）。尽管如此，因为$A$本身就很罕见，所以知道一个个体拥有$B$等位基因并不能提供多少关于其在A位点状态的信息（它很可能还是$a$）。因此，预测能力很弱，$r^2$值很低 [@problem_id:1944765]。理解这两种度量的差异对于解释LD数据至关重要。

#### 单倍型块：基因组中的LD岛屿

由于重组是侵蚀LD的主要力量，且其在基因组上的发生率并非[均匀分布](@entry_id:194597)，这导致LD在基因组上也呈现出不均匀的模式。基因组的某些区域可能存在**[重组热点](@entry_id:163601)（recombination hotspots）**，在这些区域内重组频繁发生，导致LD迅速衰减。而在另一些区域，历史重组事件非常少。

这些[重组率](@entry_id:203271)极低的区域被称为**单倍型块（Haplotype Blocks）**。一个单倍型块是指一段连续的DNA区域，其内部的遗传标记（如SNPs）之间表现出强烈的[连锁不平衡](@entry_id:146203)（通常用高$r^2$值衡量），并且该区域内的单倍型多样性很低。这意味着在这段区域里，大部分[染色体](@entry_id:276543)只携带少数几种常见的单倍型。可以把一个单倍型块想象成一个几乎被完整地作为一个单位进行遗传的“遗传街区”，而[重组热点](@entry_id:163601)则是分隔这些街区的“大道” [@problem_id:1944761]。

单倍型块的概念极大地简化了对人类基因组变异的研究。通过识别这些块，研究人员无需对块内的每一个变异进行基因分型，只需选择少数几个“标签SNP”（tag SNPs），即可有效地捕捉该块内大部分的遗传信息。这构成了现代基因组学研究，尤其是[全基因组](@entry_id:195052)关联分析（GWAS）的基础，使其能够在成本可控的范围内高效地扫描整个基因组以寻找与疾病相关的基因区域。