## 引言
在遗传学研究中，分析多个基因如何共同传递给后代是核心任务之一。然而，随着所研究基因数量的增加，传统的潘尼氏方格法很快就因其指数级增长的复杂性而变得不切实际。为了克服这一障碍，遗传学家开发了一种更为高效且逻辑清晰的工具——**[分支图](@entry_id:274587)法**。这种方法将复杂的遗传问题简化为一系列概率计算，不仅极大地提高了分析效率，也加深了我们对[孟德尔遗传定律](@entry_id:276507)背后概率本质的理解。本文旨在系统性地介绍[分支图](@entry_id:274587)法，帮助读者从基本原理掌握到高级应用。

在接下来的内容中，我们将分三步深入探索[分支图](@entry_id:274587)法。**第一章“原理与机制”**将揭示该方法背后的[孟德尔定律](@entry_id:143590)和[概率论基础](@entry_id:158925)，并展示如何构建[分支图](@entry_id:274587)来计算基因型和[表型比](@entry_id:189865)例。**第二章“应用与跨学科联系”**将视野拓宽至真实世界的复杂遗传情境，探讨该方法在农业育种、上位效应、[基因连锁](@entry_id:143355)和[性连锁遗传](@entry_id:143671)等非孟德尔现象中的强大适应性。最后，在**第三章“动手实践”**部分，你将有机会通过解决一系列精心挑选的遗传学问题，将理论知识转化为实际的解题能力，从而真正内化这一强大的分析工具。

## 原理与机制

当分析一个涉及多个基因的遗传杂交时，传统的潘尼氏方格（Punnett square）很快就变得不切实际。一个双基因杂交需要一个 $4 \times 4$ 的方格，一个三基因杂交需要一个 $8 \times 8$ 的方格，而一个四基因杂交则需要一个包含 $256$ 个格子的庞大图表。随着基因数量的增加，这种方法的复杂性呈指数级增长，不仅绘制耗时，而且容易出错。为了克服这一挑战，遗传学家开发了一种更高效、更具扩展性的分析工具：**[分支图](@entry_id:274587)法（forked-line method）**。

[分支图](@entry_id:274587)法是一种基于概率论的系统性方法，它将一个多基因杂交问题分解为一系列独立的单基因杂交问题。通过应用概率的**[乘法法则](@entry_id:144424)（product rule）**，我们可以轻松地计算出任何特定基因型或表型组合在后代中出现的预期比例。该方法的美妙之处在于其逻辑的清晰性和应用的广[泛性](@entry_id:161765)，它不仅适用于经典的[孟德尔遗传](@entry_id:156036)，还能灵活地扩展到更复杂的遗传现象，如[不完全显性](@entry_id:143623)、上位效应、[外显不全](@entry_id:261398)和[基因连锁](@entry_id:143355)。

### 核心原理：[分离定律](@entry_id:265049)、[自由组合](@entry_id:141921)与概率论

[分支图](@entry_id:274587)法的基础是孟德尔的两大遗传定律。

首先是**[孟德尔分离定律](@entry_id:149761)（Mendel's Law of Segregation）**，该定律指出，在形成配子时，等位基因对的两个成员会彼此分离，使得每个配子只随机地接收两个等位基因中的一个。对于一个杂合子（例如 $Aa$），它会以相等的概率产生两种类型的配子：携带显性等位基因 $A$ 的配子和携带隐性等位基因 $a$ 的配子。因此，$P(A) = \frac{1}{2}$ 且 $P(a) = \frac{1}{2}$。这一定律是计算单基因杂交后代比例的基础。例如，在一个 $Aa \times Aa$ 的自交中，后代的基因型比例为 $1(AA) : 2(Aa) : 1(aa)$，[表型比](@entry_id:189865)例（在[完全显性](@entry_id:146900)下）为 $3(A\_) : 1(aa)$。

其次是**[自由组合定律](@entry_id:145562)（Law of Independent Assortment）**，它指出位于不同[染色体](@entry_id:276543)上或同一[染色体](@entry_id:276543)上相距很远的基因，在配子形成过程中会独立地进行分离和组合。这意味着一个基因的等位基因如何遗传，不会影响另一个基因的等位基因的遗传。正是这一定律为我们使用概率的乘法法则提供了理论依据。[乘法法则](@entry_id:144424)指出，两个或多个独立事件同时发生的概率，是它们各自发生概率的乘积。

因此，要计算一个多基因杂合同步发生的概率，我们可以先分别计算每个单基因事件的概率，然后将它们相乘。

### [分支图](@entry_id:274587)法的基本构建

让我们通过一个典型的双基因杂交来构建一个[分支图](@entry_id:274587)。假设我们正在研究一种植物，其花瓣质地（$S/s$）和叶片颜色（$G/g$）由两对独立遗传的基因控制，且显性等位基因（$S$ 表示光滑， $G$ 表示绿色）[完全显性](@entry_id:146900)。我们对一个双杂合子（$SsGg$）进行自交。

我们可以将这个双基因杂交分解为两个独立的单基因杂交：
1.  对于花瓣质地：$Ss \times Ss \to \frac{3}{4}$ 光滑 ($S\_$) : $\frac{1}{4}$ 皱缩 ($ss$)
2.  对于叶片颜色：$Gg \times Gg \to \frac{3}{4}$ 绿色 ($G\_$) : $\frac{1}{4}$ 黄色 ($gg$)

现在，我们可以使用[分支图](@entry_id:274587)来组合这些概率。我们从第一个基因的[表型比](@entry_id:189865)例开始，然后为每个表型“[分叉](@entry_id:270606)”出第二个基因的[表型比](@entry_id:189865)例：

-   以 $\frac{3}{4}$ 的概率出现光滑表型 ($S\_$)。在这些植物中，叶片颜色将遵循其独立的 $3:1$ 分离：
    -   $\frac{3}{4}$ 的概率是绿色 ($G\_$)
    -   $\frac{1}{4}$ 的概率是黄色 ($gg$)
-   以 $\frac{1}{4}$ 的概率出现皱缩表型 ($ss$)。同样，在这些植物中，叶片颜色也遵循 $3:1$ 的分离：
    -   $\frac{3}{4}$ 的概率是绿色 ($G\_$)
    -   $\frac{1}{4}$ 的概率是黄色 ($gg$)

通过将沿每条路径的概率相乘，我们得到四种表型的预期比例：
-   $P(\text{光滑, 绿色}) = P(S\_) \times P(G\_) = \frac{3}{4} \times \frac{3}{4} = \frac{9}{16}$
-   $P(\text{光滑, 黄色}) = P(S\_) \times P(gg) = \frac{3}{4} \times \frac{1}{4} = \frac{3}{16}$
-   $P(\text{皱缩, 绿色}) = P(ss) \times P(G\_) = \frac{1}{4} \times \frac{3}{4} = \frac{3}{16}$
-   $P(\text{皱缩, 黄色}) = P(ss) \times P(gg) = \frac{1}{4} \times \frac{1}{4} = \frac{1}{16}$

这完美地重现了经典的 $9:3:3:1$ [表型比](@entry_id:189865)。

[分支图](@entry_id:274587)法同样适用于计算特定的**基因型**比例。在这种情况下，我们使用单基因杂交的 $1:2:1$ 基因型比例。例如，在一个虚构的龙焰百合中，一个双杂合子 $PpSs$ 自交，我们想知道后代中 $ppSs$ 基因型的比例 [@problem_id:1488551]。
-   首先考虑 $P$ 基因：$Pp \times Pp$ 产生 $pp$ 基因型的概率是 $\frac{1}{4}$。
-   然后考虑 $S$ 基因：$Ss \times Ss$ 产生 $Ss$ 基因型的概率是 $\frac{1}{2}$。
-   由于两个基因独立遗传，我们将这两个概率相乘：$P(ppSs) = P(pp) \times P(Ss) = \frac{1}{4} \times \frac{1}{2} = \frac{1}{8}$。

### 扩展到多基因杂交及高级概率应用

[分支图](@entry_id:274587)法的真正威力在于其处理多个基因时的简洁性。例如，在一个四基因杂交 $AaBbCcDd \times AaBbCcDd$ 中，计算表现出全部四种显性表型的后代比例，使用潘尼氏方格是极其繁琐的 [@problem_id:1488481]。而使用[分支图](@entry_id:274587)法，我们只需认识到，对于每个独立的基因，表现出显性表型的概率是 $\frac{3}{4}$。因此，全部四种性状都表现为显性的概率就是：
$P(A\_B\_C\_D\_) = P(A\_) \times P(B\_) \times P(C\_) \times P(D\_) = (\frac{3}{4})^4 = \frac{81}{256}$

我们还可以利用概率论解决更复杂的问题。例如，在一个双基因杂交中，随机选择的F2后代至少表现出一种隐性表型的概率是多少？[@problem_id:1488487] 直接计算（显性-隐性、隐性-显性、隐性-隐性三种情况的概率之和）是可行的，但更简洁的方法是使用**[补集](@entry_id:161099)法则**。 “至少一个隐性”的对立面是“全部为显性”。我们已经知道全部为显性的概率是 $\frac{9}{16}$。因此：
$P(\text{至少一个隐性}) = 1 - P(\text{全为显性}) = 1 - \frac{9}{16} = \frac{7}{16}$

对于涉及“恰好 k 个”或“至少 k 个”显性/隐性性状的问题，我们可以应用**二项分布**的原理。
首先，让我们考虑配子形成。一个三[杂合子](@entry_id:276964) $AaBbCc$ 会产生多少种配子？由于每个[基因座](@entry_id:177958)的等位基因以 $\frac{1}{2}$ 的概率进入配子，我们可以计算携带特定数量显性等位基因的配子比例。例如，携带恰好一个显性等位基因的配子（$Abc$, $aBc$, $abC$）的比例是多少？[@problem_id:1488534] 我们可以使用[二项概率公式](@entry_id:262699) $P(X=k) = \binom{n}{k}p^k(1-p)^{n-k}$，其中 $n=3$ 个基因， $k=1$ 个显性等位基因， $p=\frac{1}{2}$ 是在一个[基因座](@entry_id:177958)上获得显性等位基因的概率。
$P(X=1) = \binom{3}{1}(\frac{1}{2})^1(\frac{1}{2})^{3-1} = 3 \times \frac{1}{2} \times \frac{1}{4} = \frac{3}{8}$

同样，这个概念也可以应用于后代表型。假设一个三[杂合子](@entry_id:276964) $AaBbCc$ 自交，我们想知道后代中至少表现出两种显性表型的比例 [@problem_id:1488512]。在这里，$n=3$ 个性状，$p = \frac{3}{4}$ 是任一性状表现为显性的概率。我们需要计算 $P(X \geq 2) = P(X=2) + P(X=3)$。
$P(X=2) = \binom{3}{2}(\frac{3}{4})^2(\frac{1}{4})^{1} = 3 \times \frac{9}{16} \times \frac{1}{4} = \frac{27}{64}$
$P(X=3) = \binom{3}{3}(\frac{3}{4})^3(\frac{1}{4})^{0} = 1 \times \frac{27}{64} \times 1 = \frac{27}{64}$
$P(X \geq 2) = \frac{27}{64} + \frac{27}{64} = \frac{54}{64} = \frac{27}{32}$

### 超越孟德尔：[分支图](@entry_id:274587)法在复杂遗传中的应用

[分支图](@entry_id:274587)法的强大之处在于它能轻松适应[非孟德尔遗传](@entry_id:145787)模式。只要我们可以确定单个（或相互作用的）性状的[遗传概率](@entry_id:271420)，就可以将其整合到[分支图](@entry_id:274587)的框架中。

#### [不完全显性](@entry_id:143623) (Incomplete Dominance)
当存在[不完全显性](@entry_id:143623)时，[杂合子](@entry_id:276964)的表型介于两个纯[合子](@entry_id:146894)之间。这导致单基因杂交的[表型比](@entry_id:189865)例从 $3:1$ 变为 $1:2:1$。[分支图](@entry_id:274587)法可以无缝地处理这种变化。例如，在金鱼草中，花色由[不完全显性](@entry_id:143623)基因控制（$C^R C^R$ 为红色，$C^W C^W$ 为白色，$C^R C^W$ 为粉色），而株高由[完全显性](@entry_id:146900)基因控制（$T$ 为高，$t$ 为矮）。对 $C^R C^W Tt$ 进行自交 [@problem_id:1488500]，我们可以构建如下[分支图](@entry_id:274587)：
-   花色比例：$\frac{1}{4}$ 红色 : $\frac{1}{2}$ 粉色 : $\frac{1}{4}$ 白色
-   株高比例：$\frac{3}{4}$ 高 : $\frac{1}{4}$ 矮

结合起来，例如粉色高株的概率为 $P(\text{粉色, 高}) = P(\text{粉色}) \times P(\text{高}) = \frac{1}{2} \times \frac{3}{4} = \frac{3}{8} = \frac{6}{16}$。通过对所有组合进行计算，我们可以得出后代的[表型比](@entry_id:189865)例为 $3$ (红高) : $6$ (粉高) : $3$ (白高) : $1$ (红矮) : $2$ (粉矮) : $1$ (白矮)。

#### 上位效应 (Epistasis)
**上位效应**是指一个[基因座](@entry_id:177958)的等位基因会掩盖或修饰另一个不同[基因座](@entry_id:177958)等位基因的[表型效应](@entry_id:200052)。在香豌豆中，紫色花的产生需要两个基因（$C$ 和 $P$）都至少有一个显性等位基因。任何其他基因型组合（$C\_pp$、$ccP\_$ 或 $ccpp$）都会产生白色花。这种被称为**[互补基因作用](@entry_id:275716)**的上位效应，导致 $CcPp \times CcPp$ 杂交的后代中，紫色与白色的[表型比](@entry_id:189865)例不是 $9:3:3:1$，而是 $9:7$。
-   $P(\text{紫色}) = P(C\_P\_) = \frac{9}{16}$
-   $P(\text{白色}) = P(C\_pp) + P(ccP\_) + P(ccpp) = \frac{3}{16} + \frac{3}{16} + \frac{1}{16} = \frac{7}{16}$

即使存在上位效应，只要其他基因是独立遗传的，我们依然可以使用[分支图](@entry_id:274587)法。例如，如果还有一个独立的基因控制株高（$D$ 为高，$d$ 为矮），要计算一个三杂合子自交后代中白色花高茎植物的比例 [@problem_id:1488525]，我们可以将花色的 $9:7$ 比例与株高的 $3:1$ 比例结合：
$P(\text{白色, 高}) = P(\text{白色}) \times P(\text{高}) = \frac{7}{16} \times \frac{3}{4} = \frac{21}{64} \approx 0.328$

#### [外显不全](@entry_id:261398) (Incomplete Penetrance)
**[外显不全](@entry_id:261398)**是指即使个体拥有某个显性基因型，也未必会表现出相应的显性表型。[外显率](@entry_id:275658)（penetrance）就是指具有特定基因型的个体中表现出相应表型的百分比。[分支图](@entry_id:274587)法可以通过在最后一步乘以一个[外显率](@entry_id:275658)概率来解决这个问题。
假设在一个虚构的灯笼鱼中，等位基因 $L$ 控制发光，但其[外显率](@entry_id:275658)只有 $0.75$（75%）。在一个 $CcLl \times CcLl$ 的杂交中，我们首先计算基因型比例和基础表型概率 [@problem_id:1488508]。
-   $P(L\_) = \frac{3}{4}$；$P(ll) = \frac{1}{4}$
-   $P(C\_) = \frac{3}{4}$；$P(cc) = \frac{1}{4}$

现在我们计算最终的发光表型概率：
-   $P(\text{发光}) = P(L\_) \times (\text{外显率}) = \frac{3}{4} \times 0.75 = \frac{9}{16}$
-   $P(\text{不发光}) = P(ll) + P(L\_) \times (1 - \text{外显率}) = \frac{1}{4} + \frac{3}{4} \times (1 - 0.75) = \frac{1}{4} + \frac{3}{16} = \frac{7}{16}$

然后，我们可以将这些修正后的表型概率与颜色基因的概率在[分支图](@entry_id:274587)中组合，例如：
$P(\text{蓝色, 发光}) = P(C\_) \times P(\text{发光}) = \frac{3}{4} \times \frac{9}{16} = \frac{27}{64}$

#### [基因连锁](@entry_id:143355) (Gene Linkage)
当两个基因位于同一条[染色体](@entry_id:276543)上时，它们倾向于一起被继承，这种现象称为**[基因连锁](@entry_id:143355)（gene linkage）**。此时，[自由组合定律](@entry_id:145562)不再适用，我们不能简单地将它们的概率相乘。然而，[分支图](@entry_id:274587)法依然有用。我们可以将连锁的基因视为一个“区块”，计算这个区块内部的配子概率，然后将整个区块与独立遗传的其他基因在[分支图](@entry_id:274587)中进行组合。

[连锁基因](@entry_id:264106)之间通过**重组（recombination）**可以产生新的等位基因组合。两个[基因座](@entry_id:177958)之间的重组频率（以[厘摩](@entry_id:262359)/cM为单位）等于它们产生的[重组配子](@entry_id:261332)的比例。对于一个来自纯系亲本杂交的、[连锁基因](@entry_id:264106)呈顺式构型（coupling phase, $AB/ab$）的双杂合子，其产生的四种配子的频率为：
-   亲本型配子：$P(AB) = P(ab) = \frac{1-r}{2}$
-   重组型配子：$P(Ab) = P(aB) = \frac{r}{2}$
其中 $r$ 是重组频率。

考虑一个三杂合子虾 $AaBbCc$，其中 $A$ 和 $B$ [基因连锁](@entry_id:143355)，重组频率为 $22$ cM ($r=0.22$)，而 $C$ 基因独立遗传。该虾与一个完全隐性的个体（$aabbcc$）进行[测交](@entry_id:156683) [@problem_id:1488531]。我们想知道后代中表现为长触角（显性）、绿色生物光（隐性）、光滑甲壳（显性）的比例，即表型为 $A\_bbC\_$。

由于是测交，后代的表型完全由三[杂合子](@entry_id:276964)亲本提供的配子决定。要得到 $A\_bbC\_$ 的后代，该亲本必须提供 $AbC$ 类型的配子。
1.  首先，我们处理连锁的 $A$ 和 $B$ 基因。我们需要 $Ab$ 配子。由于亲本是 $AB/ab$ 构型，$Ab$ 是重组型配子。其频率为 $P(Ab) = \frac{r}{2} = \frac{0.22}{2} = 0.11$。
2.  接下来，我们处理独立遗传的 $C$ 基因。我们需要 $C$ 配子。由于亲本是 $Cc$，$P(C) = \frac{1}{2} = 0.5$。
3.  最后，由于连锁区块（A/B）与基因 C 是独立遗传的，我们应用乘法法则：
$P(AbC \text{ 配子}) = P(Ab) \times P(C) = 0.11 \times 0.5 = 0.055$

因此，预期后代中有 $0.055$（或 $5.5\%$）的个体表现为长触角、绿色生物光和光滑甲壳。这个例子完美地展示了[分支图](@entry_id:274587)法如何通过将[连锁基因](@entry_id:264106)作为一个整体来处理，从而优雅地解决了看似复杂的问题。

综上所述，[分支图](@entry_id:274587)法不仅是解决多基因杂交问题的强大计算工具，更是一个深刻体现了遗传学核心概率原理的逻辑框架。掌握了这种方法，就能够系统地、准确地预测从简单到复杂的各种遗传模式下的后代[分布](@entry_id:182848)。