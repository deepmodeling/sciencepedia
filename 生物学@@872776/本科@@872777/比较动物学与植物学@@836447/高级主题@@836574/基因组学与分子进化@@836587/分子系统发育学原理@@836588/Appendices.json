{"hands_on_practices": [{"introduction": "系统发育分析通常始于比较DNA序列。然而，仅简单地计算两个序列之间的差异（称为p距离）可能会低估它们真实的进化分歧，因为随着时间的推移，同一位点可能发生多次替换。本练习将介绍Jukes-Cantor模型，这是一个基础工具，它通过校正这些不可见的突变，为我们提供一个更准确的每个位点平均替换数估算值 [@problem_id:1771220]。", "problem": "一位分子生物学家正在对两种新分离的极端环境古菌株进行系统发育研究。该研究涉及比较这两种菌株之间保守的一个特定功能基因。在对两种菌株的同源基因区域进行测序和比对后，该生物学家观察到：比对后的核苷酸序列总长度为800个碱基对（bp），并且在40个核苷酸位置上存在差异。\n\n为了估算进化分歧，该生物学家决定应用Jukes-Cantor核苷酸替换模型。该模型是最简单的模型之一，它假设四种核苷酸（A、C、G、T）之间的任何替换都具有相等的替换率，并且核苷酸频率相等。Jukes-Cantor距离（$d$）校正了观察到的差异比例，以解释可能在同一位点发生的多次替换，从而提供了每个位点的平均替换数的估计值。\n\n计算这两个序列的Jukes-Cantor距离 $d$。将您的答案以无量纲数值的形式报告，并四舍五入到三位有效数字。", "solution": "观察到的核苷酸差异比例是差异位点数除以比对的总长度。在800个碱基对中有40个差异，因此该比例为\n$$\np=\\frac{40}{800}=\\frac{1}{20}.\n$$\n根据Jukes-Cantor模型，校正后的距离（每个位点的替换数）为\n$$\nd=-\\frac{3}{4}\\ln\\!\\left(1-\\frac{4}{3}p\\right).\n$$\n代入 $p=\\frac{1}{20}$，\n$$\nd=-\\frac{3}{4}\\ln\\!\\left(1-\\frac{4}{3}\\cdot\\frac{1}{20}\\right)\n=-\\frac{3}{4}\\ln\\!\\left(1-\\frac{1}{15}\\right)\n=-\\frac{3}{4}\\ln\\!\\left(\\frac{14}{15}\\right).\n$$\n进行数值计算，\n$$\n\\ln\\!\\left(\\frac{14}{15}\\right)\\approx -0.068992856,\n$$\n所以\n$$\nd\\approx -\\frac{3}{4}\\times(-0.068992856)=0.051744642.\n$$\n四舍五入到三位有效数字，\n$$\nd\\approx 0.0517.\n$$", "answer": "$$\\boxed{0.0517}$$", "id": "1771220"}, {"introduction": "一旦我们估算出所有物种对之间的进化距离，下一个挑战就是将这些关系以系统发育树的形式呈现出来。邻接法（Neighbor-Joining algorithm）是一种强大且广泛应用的距离法，它通过迭代地将最邻近的分类单元组合在一起来实现这一目标。本练习将引导您完成该算法关键的第一步，展示其如何识别第一对要合并的“邻居”[@problem_id:1771208]。", "problem": "一个植物学家团队正在研究五种新发现的向日葵物种之间的进化关系。他们对每个物种的特定基因进行了测序，并计算了一个成对遗传距离矩阵，该矩阵量化了每对物种之间的分化程度。这些物种是 *Helianthus arcanus* (HA)、*Helianthus borealis* (HB)、*Helianthus campestris* (HC)、*Helianthus deserticola* (HD) 和 *Helianthus elegans* (HE)。\n\n植物学家们决定使用邻接法 (Neighbor-Joining, NJ) 算法构建一个系统发育树。你的任务是执行该算法的第一步，以确定哪两个物种最先被组合在一起，形成一个新的内部节点。\n\n遗传距离矩阵如下所示，其中的值代表了无单位的遗传分化度量：\n\n|        | HA | HB | HC | HD | HE |\n| :----: | :-: | :-: | :-: | :-: | :-: |\n| **HA** | 0  | 5  | 4  | 7  | 6  |\n| **HB** | 5  | 0  | 7  | 10 | 9  |\n| **HC** | 4  | 7  | 0  | 7  | 6  |\n| **HD** | 7  | 10 | 7  | 0  | 5  |\n| **HE** | 6  | 9  | 6  | 5  | 0  |\n\n根据这个矩阵，以下哪个陈述正确描述了邻接法算法第一步连接的结果？\n\nA. (*H. deserticola*, *H. elegans*) 对被连接。从这个新节点到其他物种的新距离为：到 *H. arcanus* 为 4，到 *H. borealis* 为 7，到 *H. campestris* 为 4。\n\nB. (*H. arcanus*, *H. borealis*) 对被连接。从这个新节点到其他物种的新距离为：到 *H. campestris* 为 3，到 *H. deserticola* 为 6，到 *H. elegans* 为 5。\n\nC. (*H. arcanus*, *H. campestris*) 对被连接。从这个新节点到其他物种的新距离为：到 *H. borealis* 为 4，到 *H. deserticola* 为 5，到 *H. elegans* 为 4。\n\nD. (*H. deserticola*, *H. elegans*) 对被连接。从这个新节点到其他物种的新距离为：到 *H. arcanus* 为 3，到 *H. borealis* 为 2，到 *H. campestris* 为 3。\n\nE. (*H. campestris*, *H. deserticola*) 对被连接。从这个新节点到其他物种的新距离为：到 *H. arcanus* 为 5.5，到 *H. borealis* 为 8，到 *H. elegans* 为 4。", "solution": "要执行邻接法 (NJ) 算法的第一步，对于分类单元 $\\{\\mathrm{HA}, \\mathrm{HB}, \\mathrm{HC}, \\mathrm{HD}, \\mathrm{HE}\\}$ 和距离矩阵 $d(i,j)$，需要计算行和 $r_{i}=\\sum_{k} d(i,k)$ 以及 $Q$ 矩阵的元素\n$$\nQ(i,j)=(n-2)\\,d(i,j)-r_{i}-r_{j},\n$$\n其中 $n=5$。\n\n首先计算行和：\n$$\n\\begin{aligned}\nr_{\\mathrm{HA}}=d(\\mathrm{HA},\\mathrm{HB})+d(\\mathrm{HA},\\mathrm{HC})+d(\\mathrm{HA},\\mathrm{HD})+d(\\mathrm{HA},\\mathrm{HE})=5+4+7+6=22,\\\\\nr_{\\mathrm{HB}}=5+7+10+9=31,\\\\\nr_{\\mathrm{HC}}=4+7+7+6=24,\\\\\nr_{\\mathrm{HD}}=7+10+7+5=29,\\\\\nr_{\\mathrm{HE}}=6+9+6+5=26.\n\\end{aligned}\n$$\n当 $n-2=3$ 时，计算 $Q$ 值：\n$$\n\\begin{aligned}\nQ(\\mathrm{HA},\\mathrm{HB})=3\\cdot 5-22-31=15-53=-38,\\\\\nQ(\\mathrm{HA},\\mathrm{HC})=3\\cdot 4-22-24=12-46=-34,\\\\\nQ(\\mathrm{HA},\\mathrm{HD})=3\\cdot 7-22-29=21-51=-30,\\\\\nQ(\\mathrm{HA},\\mathrm{HE})=3\\cdot 6-22-26=18-48=-30,\\\\\nQ(\\mathrm{HB},\\mathrm{HC})=3\\cdot 7-31-24=21-55=-34,\\\\\nQ(\\mathrm{HB},\\mathrm{HD})=3\\cdot 10-31-29=30-60=-30,\\\\\nQ(\\mathrm{HB},\\mathrm{HE})=3\\cdot 9-31-26=27-57=-30,\\\\\nQ(\\mathrm{HC},\\mathrm{HD})=3\\cdot 7-24-29=21-53=-32,\\\\\nQ(\\mathrm{HC},\\mathrm{HE})=3\\cdot 6-24-26=18-50=-32,\\\\\nQ(\\mathrm{HD},\\mathrm{HE})=3\\cdot 5-29-26=15-55=-40.\n\\end{aligned}\n$$\n最小的 $Q$ 值是 $Q(\\mathrm{HD},\\mathrm{HE})=-40$，因此第一个连接的对是 $(\\mathrm{HD},\\mathrm{HE})$。\n\nNJ 归约法给出了从连接 $\\mathrm{HD}$ 和 $\\mathrm{HE}$ 的新节点 $U$ 到任何剩余分类单元 $k$ 的距离，其计算公式为\n$$\nd(U,k)=\\frac{d(\\mathrm{HD},k)+d(\\mathrm{HE},k)-d(\\mathrm{HD},\\mathrm{HE})}{2}.\n$$\n对于 $k\\in\\{\\mathrm{HA},\\mathrm{HB},\\mathrm{HC}\\}$，使用 $d(\\mathrm{HD},\\mathrm{HE})=5$ 计算这些距离：\n$$\n\\begin{aligned}\nd(U,\\mathrm{HA})=\\frac{d(\\mathrm{HD},\\mathrm{HA})+d(\\mathrm{HE},\\mathrm{HA})-d(\\mathrm{HD},\\mathrm{HE})}{2}=\\frac{7+6-5}{2}=4,\\\\\nd(U,\\mathrm{HB})=\\frac{10+9-5}{2}=7,\\\\\nd(U,\\mathrm{HC})=\\frac{7+6-5}{2}=4.\n\\end{aligned}\n$$\n因此，第一个连接是 $(\\mathrm{HD},\\mathrm{HE})$，其到 $\\mathrm{HA}$ 的新距离为 $4$，到 $\\mathrm{HB}$ 的新距离为 $7$，到 $\\mathrm{HC}$ 的新距离为 $4$，这与选项 A 相符。", "answer": "$$\\boxed{A}$$", "id": "1771208"}, {"introduction": "系统发育学中的一个关键假设是，单个基因的进化历史能够反映其所属物种的进化历史。然而，情况并非总是如此，尤其是在新近分化的物种中，祖先群体的遗传变异可能尚未完全“分拣”，这种现象被称为不完全谱系分选（Incomplete Lineage Sorting, ILS）。本练习将运用溯祖理论来计算发生此类基因树与物种树不一致的概率，从而阐明现代系统基因组学中的一个关键概念 [@problem_id:1771187]。", "problem": "一个进化生物学家团队正在研究三种亲缘关系很近的夏威夷蟋蟀的系统发育关系：*Laupala kona*（物种 K）、*Laupala parakona*（物种 P）和 *Laupala cerasina*（物种 C）。基于大量的形态学和地质学数据，真实的物种树被确切地确定为 ((K, P), C)，其中物种 K 和 P 是姐妹群。物种 K 和 P 之间的分化发生在 $1.2$ 百万年前，它们的共同祖先与导致物种 C 的谱系在更早的 $1.8$ 百万年前分化。\n\n对于一个特定的中性进化的基因座，您的任务是计算一个基因树（根据每个物种一个个体的序列数据估算）与物种树不一致的概率。假设所有祖先种群都是二倍体，具有恒定的有效种群大小 $N_e = 100,000$ 个个体，世代时间恰好为一年。所讨论的不一致性发生在来自 K 和 P 的基因谱系在它们的共同祖先种群与 C 谱系合并之前未能合并，从而导致在更深层的祖先种群中谱系的随机分选。\n\n计算这个基因树-物种树不一致的概率。将最终答案四舍五入到四位有效数字。", "solution": "我们在恒定有效大小的二倍体种群中，使用标准中性溯祖模型对基因谱系进行建模。设真实的物种树为 $((K,P),C)$，K–P 的分化时间为 $t_{KP}$，它们的祖先与 C 的分化时间为 $t_{KPC}$，两者都以年为单位向后追溯。分隔这两个物种形成事件的内部支的长度是 $\\Delta t = t_{KPC} - t_{KP}$。设世代时间为 $\\gamma$（年/代），该分支以世代为单位的持续时间是\n$$\nT \\equiv \\frac{\\Delta t}{\\gamma}.\n$$\n对于一个大小为 $N_{e}$ 的二倍体种群中的两个谱系，合并时间服从指数分布，速率为每代 $\\lambda = \\frac{1}{2N_{e}}$。因此，K 和 P 谱系在 $T$ 代内未能合并的概率是\n$$\n\\Pr(\\text{在 }[t_{KP},t_{KPC}]\\text{ 内未合并}) = \\exp\\!\\left(-\\frac{T}{2N_{e}}\\right).\n$$\n如果它们在 $t_{KPC}$ 时刻之前未能合并，那么有三个谱系进入更深层的祖先种群。在中性条件下，在一个随机交配的种群中，三个谱系中的第一对合并同样可能地是三对中的任何一对；因此，在有三个谱系进入的条件下，基因树与物种树不一致的概率为 $\\frac{2}{3}$。\n\n因此，基因树-物种树不一致的总概率为\n$$\n\\Pr(\\text{不一致}) = \\frac{2}{3}\\exp\\!\\left(-\\frac{T}{2N_{e}}\\right).\n$$\n代入给定值 $t_{KP} = 1.2\\times 10^{6}$ 年， $t_{KPC} = 1.8\\times 10^{6}$ 年， $\\Delta t = 0.6\\times 10^{6}$ 年， $\\gamma = 1$ 年/代，以及 $N_{e} = 1.0\\times 10^{5}$，我们得到 $T = 6.0\\times 10^{5}$ 代，并且\n$$\n\\frac{T}{2N_{e}} = \\frac{6.0\\times 10^{5}}{2.0\\times 10^{5}} = 3.\n$$\n因此，\n$$\n\\Pr(\\text{不一致}) = \\frac{2}{3}\\exp(-3) \\approx 0.0331913789,\n$$\n四舍五入到四位有效数字后是 $0.03319$。", "answer": "$$\\boxed{0.03319}$$", "id": "1771187"}]}