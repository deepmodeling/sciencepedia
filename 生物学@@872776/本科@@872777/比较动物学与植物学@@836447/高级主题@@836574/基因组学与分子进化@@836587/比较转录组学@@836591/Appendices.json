{"hands_on_practices": [{"introduction": "在比较不同物种或条件下的基因表达时，直接比较原始测序读数（raw read counts）可能会因测序深度和基因长度等技术差异而产生误导。因此，我们必须对数据进行标准化处理，以进行公平的比较。本练习将指导你完成一个核心计算任务：使用一种常见的标准化方法（每百万转录本的转录本数，TPM），计算一个关键的比较指标——log2倍数变化（log2 fold change），以量化基因表达水平的差异 [@problem_id:1740523]。", "problem": "在比较转录组学领域，研究人员分析不同物种或条件下的基因表达模式，以理解进化适应。一种常用的技术是RNA测序 (RNA-seq)，该技术可量化每个基因的信使RNA分子的丰度。为了准确比较表达水平，原始读数必须进行标准化。一种广泛使用的标准化方法是每百万转录本 (TPM)。基因 $i$ 的TPM计算如下：\n$$TPM_i = \\left( \\frac{N_i / L_i}{\\sum_{j=1}^{M} (N_j / L_j)} \\right) \\times 10^6$$\n其中 $N_i$ 是基因 $i$ 的原始读数，$L_i$ 是基因 $i$ 转录本的长度，分母中的求和是针对转录组中所有 $M$ 个基因进行的。\n\n考虑一个比较适应阳光的仙人掌 (*Opuntia ficus-indica*) 和适应荫蔽的蕨类 (*Asplenium nidus*) 的实验。编码1,5-二磷酸核酮糖羧化酶/加氧酶 (RuBisCO) 小亚基的基因（记为 *rbcS*），因其在光合作用中的核心作用而备受关注。\n\n获得了以下数据：\n\n对于适应阳光的仙人掌：\n- *rbcS* 基因的原始读数，$N_{\\text{cactus}}$: $150,000$\n- *rbcS* 转录本的长度，$L_{\\text{cactus}}$: $0.80$ 千碱基 (kb)\n- 所有基因的 (读数 / 转录本长度) 之和，$\\sum (N_j/L_j)_{\\text{cactus}}$: $9.5 \\times 10^6$ 读数/kb\n\n对于适应荫蔽的蕨类：\n- *rbcS* 基因的原始读数，$N_{\\text{fern}}$: $40,000$\n- *rbcS* 转录本的长度，$L_{\\text{fern}}$: $0.75$ 千碱基 (kb)\n- 所有基因的 (读数 / 转录本长度) 之和，$\\sum (N_j/L_j)_{\\text{fern}}$: $8.0 \\times 10^6$ 读数/kb\n\n使用这些数据，计算仙人掌中 *rbcS* 基因表达相对于蕨类的 log2 倍数变化。log2 倍数变化定义为两种表达水平的比率 ($TPM_{\\text{cactus}} / TPM_{\\text{fern}}$) 的以2为底的对数。将最终答案四舍五入到三位有效数字。", "solution": "给定 TPM 定义如下：\n$$TPM_{i}=\\left(\\frac{N_{i}/L_{i}}{\\sum_{j=1}^{M}\\left(N_{j}/L_{j}\\right)}\\right)\\times 10^{6}。$$\n对于仙人掌和蕨类，TPM 值的比率为\n$$\\frac{TPM_{\\text{cactus}}}{TPM_{\\text{fern}}}=\\frac{\\left(\\frac{N_{\\text{cactus}}}{L_{\\text{cactus}}}\\right)\\big/\\left(\\sum(N_{j}/L_{j})_{\\text{cactus}}\\right)}{\\left(\\frac{N_{\\text{fern}}}{L_{\\text{fern}}}\\right)\\big/\\left(\\sum(N_{j}/L_{j})_{\\text{fern}}\\right)}=\\frac{N_{\\text{cactus}}\\,L_{\\text{fern}}\\,\\sum(N_{j}/L_{j})_{\\text{fern}}}{L_{\\text{cactus}}\\,N_{\\text{fern}}\\,\\sum(N_{j}/L_{j})_{\\text{cactus}}}。$$\n代入给定值 $N_{\\text{cactus}}=150{,}000$，$L_{\\text{cactus}}=0.80$，$\\sum(N_{j}/L_{j})_{\\text{cactus}}=9.5\\times 10^{6}$，$N_{\\text{fern}}=40{,}000$，$L_{\\text{fern}}=0.75$，$\\sum(N_{j}/L_{j})_{\\text{fern}}=8.0\\times 10^{6}$，我们得到\n$$\\frac{TPM_{\\text{cactus}}}{TPM_{\\text{fern}}}=\\frac{150{,}000\\times 0.75\\times 8.0\\times 10^{6}}{0.80\\times 40{,}000\\times 9.5\\times 10^{6}}。$$\n分步计算分子和分母：\n$$150{,}000\\times 0.75=112{,}500,\\quad 112{,}500\\times 8.0\\times 10^{6}=9.0\\times 10^{11},$$\n$$0.80\\times 40{,}000=32{,}000,\\quad 32{,}000\\times 9.5\\times 10^{6}=3.04\\times 10^{11}。$$\n因此，\n$$\\frac{TPM_{\\text{cactus}}}{TPM_{\\text{fern}}}=\\frac{9.0\\times 10^{11}}{3.04\\times 10^{11}}=\\frac{900}{304}=\\frac{225}{76}。$$\nlog2 倍数变化为\n$$\\log_{2}\\!\\left(\\frac{TPM_{\\text{cactus}}}{TPM_{\\text{fern}}}\\right)=\\log_{2}\\!\\left(\\frac{225}{76}\\right)=\\frac{\\ln\\!\\left(\\frac{225}{76}\\right)}{\\ln(2)}。$$\n数值上，$\\frac{225}{76}\\approx 2.9605263158$，所以\n$$\\ln\\!\\left(\\frac{225}{76}\\right)\\approx 1.0853668273,\\quad \\ln(2)\\approx 0.6931471806,$$\n$$\\log_{2}\\!\\left(\\frac{225}{76}\\right)\\approx \\frac{1.0853668273}{0.6931471806}\\approx 1.56585334。$$\n四舍五入到三位有效数字，得到 $1.57$。", "answer": "$$\\boxed{1.57}$$", "id": "1740523"}, {"introduction": "一次转录组学实验通常会产生数万个基因的表达数据，从中筛选出真正具有生物学意义的候选基因是一项核心挑战。为了客观地做出选择，研究人员通常会同时使用两个标准：统计显著性（以 $p$ 值表示）和生物学效应大小（以倍数变化表示）。本练习将让你实践如何应用这些标准来筛选差异表达基因，这是一项解读转录组数据的基本技能 [@problem_id:1740518]。", "problem": "一个进化生物学家团队正在研究与灵长类动物视觉相关的遗传适应。他们利用核糖核酸测序（RNA-seq）进行了一项比较转录组学研究，以比较夜行性灵长类动物（实验对象）和昼行性灵长类动物（对照对象）视网膜组织中的基因表达。其目标是识别在夜行性灵长类动物中显著上调的基因，因为这些基因可能在增强夜视能力中发挥作用。\n\n分析得出了一个基因列表，其中包含用于统计显著性的相应p值，以及一个表示表达差异大小和方向的`log2(FoldChange)`值。正的`log2(FoldChange)`值表示在夜行性灵长类动物中有较高的表达，而负值则表示较低的表达。\n\n研究人员将一个有前景的、可用于后续功能性研究的候选基因定义为同时满足以下两个标准的基因：\n1.  其表达必须显示出统计学上的显著变化，定义为`p-value  0.01`。\n2.  其必须在感兴趣的方向（在夜行性灵长类动物中上调）上具有生物学显著性，定义为`log2(FoldChange)  1.5`。\n\n以下是五个候选基因的数据。\n\n*   基因 *VisOps-A*: `p-value = 0.008`, `log2(FoldChange) = 2.1`\n*   基因 *Cryp-B*: `p-value = 0.002`, `log2(FoldChange) = 1.1`\n*   基因 *Rhod-C*: `p-value = 0.045`, `log2(FoldChange) = 3.2`\n*   基因 *Phot-D*: `p-value = 0.0005`, `log2(FoldChange) = -2.5`\n*   基因 *Noc-E*: `p-value = 0.15`, `log2(FoldChange) = 0.5`\n\n根据指定的标准，下列哪个基因是关于夜视适应后续研究的最有前景的候选者？\n\nA. *VisOps-A*\n\nB. *Cryp-B*\n\nC. *Rhod-C*\n\nD. *Phot-D*\n\nE. *Noc-E*", "solution": "我们已知一个基因成为有前景的候选者需要同时满足两个标准：由 $p  0.01$ 定义的统计学显著性，以及由 $\\log_{2}(\\text{FoldChange}) > 1.5$ 定义的在感兴趣方向上的生物学显著性。我们根据这些不等式来评估每个基因。\n\n对于VisOps-A，我们有 $p=0.008$ 和 $\\log_{2}(\\text{FoldChange})=2.1$。因为 $0.008  0.01$ 且 $2.1 > 1.5$，所以两个标准都满足。\n\n对于Cryp-B，我们有 $p=0.002$ 和 $\\log_{2}(\\text{FoldChange})=1.1$。统计学标准 $0.002  0.01$ 得到满足，但生物学标准 $1.1 > 1.5$ 不成立，因此它不满足第二个标准。\n\n对于Rhod-C，我们有 $p=0.045$ 和 $\\log_{2}(\\text{FoldChange})=3.2$。生物学标准 $3.2 > 1.5$ 得到满足，但统计学标准 $0.045  0.01$ 不成立，因此它不满足第一个标准。\n\n对于Phot-D，我们有 $p=0.0005$ 和 $\\log_{2}(\\text{FoldChange})=-2.5$。尽管 $0.0005  0.01$ 满足统计学标准，但生物学标准要求 $\\log_{2}(\\text{FoldChange}) > 1.5$，而这是不成立的，因为 $-2.5$ 是负值，不在感兴趣的方向上。\n\n对于Noc-E，我们有 $p=0.15$ 和 $\\log_{2}(\\text{FoldChange})=0.5$。统计学标准 $0.15  0.01$ 不成立，生物学标准 $0.5 > 1.5$ 也不成立。\n\n只有VisOps-A同时满足 $p  0.01$ 和 $\\log_{2}(\\text{FoldChange}) > 1.5$，因此它是最有前景的后续研究候选者。", "answer": "$$\\boxed{A}$$", "id": "1740518"}, {"introduction": "在进行任何数据分析之前，缜密的实验设计和对技术局限性的深刻理解至关重要。这个思想实验探讨了比较转录组学中一个常见的陷阱：当比较基因组大小或倍性水平差异巨大的物种时会发生什么。通过这个练习，你将理解为什么直接比较原始读数是不可靠的，并再次体会到数据标准化的必要性 [@problem_id:1740495]。", "problem": "植物学家Evelyn Reed博士正在通过比较一种野生二倍体草莓物种（*Fragaria vesca*，含有2套染色体）和一种大果商业化八倍体草莓（*Fragaria x ananassa*，含有8套染色体）来研究果实大小的分子基础。她的实验包括从每个物种的等量（$10^6$个细胞）叶片细胞中提取总信使核糖核酸（mRNA）。然后她为每个样本准备了一个核糖核酸测序（RNA-seq）文库。两个文库都在同一台机器上进行测序，且测序总深度相同，这意味着为二倍体样本产生的总读数（reads）与为八倍体样本产生的总读数相等。\n\nEvelyn Reed博士关注一个特定的基因*Gene-X*，该基因在二倍体物种中是已知的单拷贝基因，并且在八倍体物种中有一个明确的一对一直系同源基因。假设在特定的测试条件下，*Gene-X*在两个物种中的表达水平完全相同，即每个细胞中*Gene-X*的mRNA转录本数量相同。\n\n当Evelyn Reed博士直接比较两个物种之间*Gene-X*的原始读数计数时，以下哪种结果是倍性差异最可能导致的后果？\n\nA. *Gene-X*的原始读数计数在八倍体中将大约是二倍体的四倍，反映了染色体组数量的四倍增加。\nB. *Gene-X*的原始读数计数在两个物种中将大致相同，因为每个细胞的转录本数量相同，并且使用了相同数量的细胞。\nC. 这种比较是无效的，因为八倍体草莓的不同亚基因组中拥有多个相似的基因拷贝（同源异位基因），导致无法将读数唯一地分配给*Gene-X*的真正直系同源基因。\nD. *Gene-X*的原始读数计数在八倍体物种中将显著低于二倍体物种。\nE. 由于多倍体生物中转录错误率的增加，原始读数计数将高度可变且没有明显趋势。", "solution": "定义$n$为每个样本的细胞数，$m_{X}$为每个细胞中Gene-X的转录本数量（假设在两个物种中相同），$D$为每个文库的总测序读数（在物种间相等）。\n\n那么每个文库中Gene-X转录本的绝对数量为\n$$\nM_{X} = n m_{X}.\n$$\n设$M_{\\text{tot,d}}$和$M_{\\text{tot,o}}$分别表示二倍体和八倍体文库中mRNA分子的总数。由于更高的倍性和转录组复杂性，最合理的假设是\n$$\nM_{\\text{tot,o}}  M_{\\text{tot,d}}.\n$$\n\n假设文库制备和测序是无偏的，读数是大致按照转录本丰度比例进行抽样的。因此，Gene-X的预期原始读数计数为\n$$\nR_{d} = D \\cdot \\frac{M_{X}}{M_{\\text{tot,d}}}, \\qquad R_{o} = D \\cdot \\frac{M_{X}}{M_{\\text{tot,o}}}.\n$$\n计算其比值得出\n$$\n\\frac{R_{o}}{R_{d}} = \\frac{M_{\\text{tot,d}}}{M_{\\text{tot,o}}}  1,\n$$\n因为$M_{\\text{tot,o}} > M_{\\text{tot,d}}$，而$D$和$M_{X}$在物种间是相等的。因此，尽管两个样本中Gene-X转录本的绝对数量（$M_{X}$）相同，但八倍体文库中Gene-X分子的比例较小，所以在相同的测序深度下，其原始读数计数预计会更低。\n\n这排除了：\n- A，因为每个细胞的表达是固定的，在八倍体中并没有高出四倍。\n- B，因为在固定深度下，原始计数反映的是相对丰度，而不仅仅是绝对分子数。\n- C，因为问题规定了存在明确的一对一直系同源基因，从而消除了比对的模糊性。\n- E，因为在这些假设下，转录错误率的增加既没有被暗示，也不是导致系统性原始计数差异的驱动因素。\n\n因此，最可能的结果是八倍体样本中Gene-X的原始读数计数低于二倍体样本。", "answer": "$$\\boxed{D}$$", "id": "1740495"}]}