{"hands_on_practices": [{"introduction": "生物多样性不仅仅是物种数量的简单计数。为了更全面地理解群落结构，生态学家使用希尔数（Hill numbers）这一统一框架，它通过一个参数 $q$ 来调整对稀有或常见物种的敏感度。这个练习 [@problem_id:1733547] 将通过比较两个结构截然不同的群落，展示如何利用希尔数来量化“有效物种数”，从而揭示物种丰富度和均匀度如何共同塑造我们对多样性的理解。", "problem": "在生态学研究中，生物多样性通常使用希尔数（Hill numbers）进行量化，它为测量多样性提供了一个统一的框架。阶为 $q$ 的希尔数，记作 $^qD$，是衡量群落中物种有效数量的一种度量。其定义公式为：\n\n$$^qD = \\left( \\sum_{i=1}^{S} p_i^q \\right)^{\\frac{1}{1-q}}$$\n\n其中 $S$ 是物种总数（物种丰富度），$p_i$ 是第 $i$ 个物种的相对丰度。阶数 $q$ 决定了该指数对物种丰度的敏感性。通常使用三个关键的 $q$ 值：\n\n-   当 $q=0$ 时，公式简化为 $^0D = S$，这即是物种丰富度。\n-   当 $q=1$ 时，该公式无定义，但其在 $q \\to 1$ 时的极限得出 $^1D = \\exp\\left(-\\sum_{i=1}^{S} p_i \\ln(p_i)\\right)$。这是香农多样性指数（Shannon diversity index）的指数形式，代表了群落中“常见”或“典型”物种的有效数量。\n-   当 $q=2$ 时，公式给出 $^2D = 1 / \\left(\\sum_{i=1}^{S} p_i^2\\right)$。这是辛普森集中度指数（Simpson concentration index）的倒数，代表了“优势”或“极丰度”物种的有效数量。\n\n一位生态学家从两个不同的生境中采集了昆虫种群样本，我们称之为Alpha群落和Beta群落。从每个群落中都收集了总共100个个体。丰度数据如下：\n\n-   **Alpha群落**：共鉴定出10个物种。一个物种高度优势，有91个个体，而其余九个物种各只有1个个体。\n-   **Beta群落**：共鉴定出10个物种。该群落呈现出完全均匀的分布，10个物种中的每一个都有10个个体。\n\n根据这些信息，计算Beta群落中常见物种的有效数量（$^1D$）与Alpha群落中常见物种的有效数量之比。将你的最终答案四舍五入到三位有效数字。", "solution": "我们要求的是常见物种有效数量的比率，即阶数 $q=1$ 的希尔数，由其连续扩展形式定义：\n$$\n{}^{1}D=\\exp\\left(-\\sum_{i=1}^{S} p_{i}\\ln(p_{i})\\right).\n$$\n设 $R$ 表示所求比率 $R=\\dfrac{{}^{1}D_{\\text{Beta}}}{{}^{1}D_{\\text{Alpha}}}$。\n\nBeta群落有 $S=10$ 个物种，其比例均等，$p_{i}=\\dfrac{10}{100}=\\dfrac{1}{10}$ 对所有 $i$ 成立。那么\n$$\n-\\sum_{i=1}^{10}p_{i}\\ln(p_{i})=-10\\left(\\frac{1}{10}\\right)\\ln\\left(\\frac{1}{10}\\right)=-\\ln\\left(\\frac{1}{10}\\right)=\\ln(10),\n$$\n所以\n$$\n{}^{1}D_{\\text{Beta}}=\\exp\\big(\\ln(10)\\big)=10.\n$$\n\nAlpha群落有一个优势物种，其比例为 $p_{1}=\\dfrac{91}{100}=0.91$，以及九个稀有物种，每个物种的比例为 $p_{i}=\\dfrac{1}{100}=0.01$（对于 $i=2,\\dots,10$）。其以奈特（nats）为单位的香农熵是\n$$\nH_{\\text{Alpha}}=-\\left[0.91\\,\\ln(0.91)+9\\left(0.01\\,\\ln(0.01)\\right)\\right]\n=-\\left[0.91\\,\\ln(0.91)+0.09\\,\\ln(0.01)\\right].\n$$\n使用 $\\ln(0.01)=-2\\ln(10)$，这变为\n$$\nH_{\\text{Alpha}}=-0.91\\,\\ln(0.91)+0.18\\,\\ln(10),\n$$\n因此\n$$\n{}^{1}D_{\\text{Alpha}}=\\exp\\!\\left(-0.91\\,\\ln(0.91)+0.18\\,\\ln(10)\\right).\n$$\n\n所以，该比率为\n$$\nR=\\frac{{}^{1}D_{\\text{Beta}}}{{}^{1}D_{\\text{Alpha}}}\n=\\exp\\!\\left(\\ln(10)-\\big[-0.91\\,\\ln(0.91)+0.18\\,\\ln(10)\\big]\\right)\n=\\exp\\!\\left(0.82\\,\\ln(10)+0.91\\,\\ln(0.91)\\right).\n$$\n为了得到所需的数值，计算对数：\n$$\n\\ln(10)\\approx 2.302585093,\\quad \\ln(0.91)\\approx -0.094310679,\n$$\n所以\n$$\n0.82\\,\\ln(10)+0.91\\,\\ln(0.91)\\approx 0.82\\cdot 2.302585093+0.91\\cdot(-0.094310679)\\approx 1.802297058,\n$$\n因此\n$$\nR=\\exp(1.802297058)\\approx 6.06356.\n$$\n四舍五入到三位有效数字，该比率为 $6.06$。", "answer": "$$\\boxed{6.06}$$", "id": "1733547"}, {"introduction": "生态系统在受到干扰后，其生物多样性会如何变化？这个练习 [@problem_id:1733550] 模拟了一次选择性采伐事件，并要求你计算和比较干扰前后的物种丰富度（$S$）和均匀度（$J'$）。通过这个看似矛盾（物种增多但均匀度下降）的案例，你将学会区分多样性的这两个关键组成部分，并理解它们在评估群落结构变化中的不同作用。", "problem": "一位生态学家正在研究一次选择性采伐事件对一个温带森林样地生物多样性的影响。此次采伐特别针对并移除了大量的最常见冠层树种——*Quercus dominus*。群落数据是通过对采伐前（基线状态）和采伐事件五年后（受扰状态）的1000棵成年树木进行标准化普查收集的。\n\n数据如下：\n\n**基线状态群落（采伐前）：**\n- *Quercus dominus*：500个个体\n- *Fagus grandis*：300个个体\n- *Acer rubrum*：200个个体\n\n**受扰状态群落（采伐后）：**\n- *Quercus dominus*：50个个体\n- *Betula populifolia*（一个新的先锋物种）：800个个体\n- *Fagus grandis*：50个个体\n- *Acer rubrum*：50个个体\n- *Prunus serotina*（一个新的先锋物种）：50个个体\n\n为了量化群落结构的变化，该生态学家使用了两个关键指标：物种丰富度（$S$）和Pielou均匀度指数（$J'$）。物种丰富度就是存在的不同物种的总数。Pielou均匀度指数是使用Shannon-Wiener多样性指数（$H'$）计算的。\n\nShannon-Wiener指数由以下公式给出：\n$$H' = -\\sum_{i=1}^{S} p_i \\ln(p_i)$$\n其中 $S$ 是物种丰富度，$p_i$ 是属于第 $i$ 个物种的个体所占的比例。\n\nPielou均匀度指数，用于衡量个体在物种间的分布均匀程度，由以下公式给出：\n$$J' = \\frac{H'}{\\ln(S)}$$\n$J'$ 的值接近1表示高均匀度，而接近0则表示低均匀度（一个或少数几个物种占优势）。\n\n计算受扰状态群落的Pielou均匀度指数与基线状态群落的Pielou均匀度指数之比。将最终答案四舍五入至三位有效数字。", "solution": "给定两个群落，每个群落的总丰度 $N=1000$。基线状态的物种丰富度为 $S_{\\text{base}}=3$，受扰状态的物种丰富度为 $S_{\\text{dist}}=5$。对每个群落，我们计算Shannon-Wiener指数\n$$\nH'=-\\sum_{i=1}^{S} p_{i}\\ln(p_{i}),\n$$\n其中 $p_{i}$ 是物种 $i$ 中个体的比例，然后计算Pielou均匀度\n$$\nJ'=\\frac{H'}{\\ln(S)}.\n$$\n所求的比率为\n$$\nR=\\frac{J'_{\\text{dist}}}{J'_{\\text{base}}}=\\frac{H'_{\\text{dist}}}{\\ln(5)}\\cdot\\frac{\\ln(3)}{H'_{\\text{base}}}=\\frac{H'_{\\text{dist}}\\ln(3)}{H'_{\\text{base}}\\ln(5)}.\n$$\n\n基线状态的比例为 $p_{1}=0.5$，$p_{2}=0.3$，$p_{3}=0.2$。因此\n$$\nH'_{\\text{base}}=-\\left[0.5\\ln(0.5)+0.3\\ln(0.3)+0.2\\ln(0.2)\\right].\n$$\n使用 $\\ln(0.5)=-\\ln(2)$，$\\ln(0.3)=\\ln(3)-\\ln(10)$ 和 $\\ln(0.2)=-\\ln(5)$ 进行数值计算，\n$$\n0.5\\ln(0.5)=-0.34657359027997264,\\quad 0.3\\ln(0.3)=-0.36119184129778083,\\quad 0.2\\ln(0.2)=-0.3218875824868201,\n$$\n所以\n$$\nH'_{\\text{base}}=1.0296530140645736.\n$$\n\n受扰状态的比例为 $p_{\\text{Betula}}=0.8$，其他四个物种各占 $p=0.05$。因此\n$$\nH'_{\\text{dist}}=-\\left[0.8\\ln(0.8)+4\\cdot 0.05\\ln(0.05)\\right].\n$$\n使用 $\\ln(0.8)=\\ln(4)-\\ln(5)=-0.2231435513142097$ 和 $\\ln(0.05)=-\\ln(20)=-2.995732273553991$，\n$$\n0.8\\ln(0.8)=-0.17851484105136776,\\quad 4\\cdot 0.05\\ln(0.05)=-0.5991464547107982,\n$$\n所以\n$$\nH'_{\\text{dist}}=0.777661295762166.\n$$\n\n那么\n$$\nJ'_{\\text{base}}=\\frac{1.0296530140645736}{\\ln(3)}\\approx \\frac{1.0296530140645736}{1.0986122886681098}\\approx 0.9372306,\n$$\n$$\nJ'_{\\text{dist}}=\\frac{0.777661295762166}{\\ln(5)}\\approx \\frac{0.777661295762166}{1.6094379124341003}\\approx 0.4831881.\n$$\n因此，比率为\n$$\nR=\\frac{J'_{\\text{dist}}}{J'_{\\text{base}}}\\approx \\frac{0.4831881}{0.9372306}\\approx 0.515549\\approx 0.516\\ \\text{（保留三位有效数字）}。\n$$", "answer": "$$\\boxed{0.516}$$", "id": "1733550"}, {"introduction": "当我们比较两个不同地点的群落时，仅仅知道它们有多“不同”（即 β 多样性）是不够的，我们更想知道这种差异的来源。这个高级练习 [@problem_id:1733586] 介绍了一种将 β 多样性分解为物种更替（turnover）和嵌套（nestedness）两个组分的方法。通过分析一个受农业影响的河流样点与一个原始样点的数据，你将学会如何诊断驱动群落变化的主要生态过程，是物种的相互替换还是物种的丧失。", "problem": "一个水生生态学家团队正在研究农业径流对 Veridian River 鱼类群落的影响。他们从两个地点收集了有无数据：A点，一个未受污染的源头溪流；B点，一个邻近集约化农田的下游河段。生态学家们希望将这两个地点之间的总β多样性分解为其两个可加性组分：物种周转和嵌套导致的非相似性。这种分解有助于诊断驱动群落变化的主要生态过程（即，物种是否被其他物种所替代，或者受影响地点的群落是否仅仅是原始地点群落的一个更小的、嵌套的子集）。\n\n以下列表表示在每个地点发现的所有鱼类物种的唯一标识符：\n\n**A点（未受污染）：**\n`{F1, F2, F3, F4, F5, F6, F7, F8, F9, F10, F11, F12, F13, F14, F15, F16}`\n\n**B点（受影响）：**\n`{F2, F4, F6, F8, F17, F18, F19, F20, F21, F22}`\n\n为了进行分析，您将使用以下标准公式来划分β多样性。设 $a$ 为两个地点共有的物种数量，$b$ 为A点独有的物种数量，$c$ 为B点独有的物种数量。\n\n周转组分 $\\beta_{turn}$，它量化了物种的替代，由以下公式给出：\n$$ \\beta_{turn} = \\frac{\\min(b, c)}{a + \\min(b, c)} $$\n\n嵌套导致的组分 $\\beta_{nest}$，它量化了因一个群落是另一个群落的子集而产生的非相似性，由以下公式给出：\n$$ \\beta_{nest} = \\frac{|b - c|}{2a + b + c} \\times \\frac{a}{a + \\min(b, c)} $$\n\n计算周转组分与嵌套导致的组分的比率 $\\frac{\\beta_{turn}}{\\beta_{nest}}$。以单个数值形式提供您的答案，保留三位有效数字。", "solution": "我们首先确定公式所需的计数。A点的集合是 $\\{F1,\\dots,F16\\}$，有 16 个物种。B点的集合是 $\\{F2,F4,F6,F8,F17,F18,F19,F20,F21,F22\\}$，有 10 个物种。两者的交集是 $\\{F2,F4,F6,F8\\}$，因此两个地点共有的物种数量为 $a=4$。A点独有的物种数量为 $b=16-4=12$。B点独有的物种数量为 $c=10-4=6$。\n\n计算周转组分：\n$$\n\\beta_{turn}=\\frac{\\min(b,c)}{a+\\min(b,c)}=\\frac{\\min(12,6)}{4+\\min(12,6)}=\\frac{6}{4+6}=\\frac{6}{10}=\\frac{3}{5}.\n$$\n\n计算嵌套导致的组分：\n$$\n\\beta_{nest}=\\frac{|b-c|}{2a+b+c}\\times\\frac{a}{a+\\min(b,c)}=\\frac{|12-6|}{2\\cdot 4+12+6}\\times\\frac{4}{4+6}=\\frac{6}{26}\\times\\frac{4}{10}.\n$$\n化简：\n$$\n\\beta_{nest}=\\frac{3}{13}\\times\\frac{2}{5}=\\frac{6}{65}.\n$$\n\n计算比率：\n$$\n\\frac{\\beta_{turn}}{\\beta_{nest}}=\\frac{\\frac{3}{5}}{\\frac{6}{65}}=\\frac{3}{5}\\cdot\\frac{65}{6}=\\frac{195}{30}=6.5.\n$$\n\n保留三位有效数字，该比率为 $6.50$。", "answer": "$$\\boxed{6.50}$$", "id": "1733586"}]}