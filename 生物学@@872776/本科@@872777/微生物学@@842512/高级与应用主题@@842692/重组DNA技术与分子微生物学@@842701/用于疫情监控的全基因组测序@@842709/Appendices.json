{"hands_on_practices": [{"introduction": "原始的全基因组测序数据不可避免地会包含测序错误和生物信息学分析流程中产生的假象。为了准确地重建病原体的传播链，我们必须首先将这些“噪音”从真实的遗传变异“信号”中分离出来。本练习将引导你应用一套在生物信息学分析中常用的质量控制标准，来筛选由测序数据检出的单核苷酸多态性（SNPs），这是一个确保后续系统发育分析可靠性的基础且关键的步骤[@problem_id:2105558]。", "problem": "一位微生物学家正在分析全基因组测序 (WGS) 数据，以调查一起医院内感染爆发事件。一项在患者分离株与环境样本之间的比较，产生了一个包含310个潜在单核苷酸多态性 (SNP) 的原始列表。为确保只有高质量的变异被用于系统发育分析，我们采用了一套标准的筛选方案。\n\n一个SNP若要通过筛选并被视为有效，需满足以下标准：\n1.  **质量分数 (QUAL):** Phred定标的质量分数大于50。\n2.  **测序深度 (DP):** 测序深度至少为20且不超过200。\n3.  **等位基因频率 (AF):** 变异等位基因的频率大于0.90。\n\n对这310个原始SNP的分析提供了以下未能满足一项或多项标准的SNP数量：\n*   集合 Q：60个SNP的QUAL分数等于或小于50。\n*   集合 D：45个SNP的DP不在可接受范围 [20, 200] 内。\n*   集合 A：55个SNP的AF等于或小于0.90。\n*   交集 $Q \\cap D$：15个SNP同时未满足QUAL和DP标准。\n*   交集 $Q \\cap A$：20个SNP同时未满足QUAL和AF标准。\n*   交集 $D \\cap A$：12个SNP同时未满足DP和AF标准。\n*   交集 $Q \\cap D \\cap A$：7个SNP三项标准均未满足。\n\n计算通过所有三项筛选标准并因此被视为高置信度变异的SNP数量。以整数形式提供最终答案。", "solution": "设 $N_{\\text{total}}$ 表示原始SNP的总数，设 $Q$、$D$ 和 $A$ 分别为未满足QUAL、DP和AF标准的SNP集合。未满足至少一项标准的SNP数量是并集 $Q \\cup D \\cup A$ 的基数，根据容斥原理可得：\n$$\n|Q \\cup D \\cup A| = |Q| + |D| + |A| - |Q \\cap D| - |Q \\cap A| - |D \\cap A| + |Q \\cap D \\cap A|.\n$$\n代入给定值：\n$$\n|Q \\cup D \\cup A| = 60 + 45 + 55 - 15 - 20 - 12 + 7 = 120.\n$$\n通过所有三项标准的SNP数量等于总数减去至少未满足一项标准的数量：\n$$\nN_{\\text{pass}} = N_{\\text{total}} - |Q \\cup D \\cup A| = 310 - 120 = 190.\n$$", "answer": "$$\\boxed{190}$$", "id": "2105558"}, {"introduction": "在获得了高质量的SNP列表后，下一个挑战是如何正确解读它们的演化意义。本练习聚焦于一个核心问题：水平基因转移（HGT），它可能导致遗传距离被高估，从而误导我们对传播事件的判断。通过计算和比较“朴素”核苷酸差异度与“克隆”核苷酸差异度，你将学会量化HGT对演化距离估算的影响，并理解为准确重建爆发事件而识别“克隆骨架”的重要性[@problem_id:2105590]。", "problem": "在一次食源性疾病暴发的公共卫生调查中，流行病学家使用全基因组测序 (WGS) 来追踪一种疑似病原体的传播，该病原体是一种高度重组的细菌物种。从两名不同患者（患者1和患者2）收集的分离株中对基因组进行测序。\n\n将两个基因组序列进行比对后，确定总比对基因组长度为 $L_{total} = 4.50 \\times 10^6$ 个碱基对。简单的成对比较显示，两个分离株之间总共有 $N_{total} = 215$ 个单核苷酸多态性 (SNPs)。\n\n进一步的生物信息学分析表明，在两个分离株的最近共同祖先之后，其中一个分离株的谱系中发生了一次大规模的水平基因转移 (HGT) 事件。一个长度为 $L_{HGT} = 6.00 \\times 10^4$ 个碱基对的连续基因组区域被确定为转移片段。在这个特定区域内，有 $N_{HGT} = 185$ 个SNPs。基因组的其余部分，被称为“克隆框架”，被假定为通过二分裂和点突变进行垂直进化。\n\n为了量化这次HGT事件对进化距离估算的影响，请计算朴素成对核苷酸差异与校正后的克隆核苷酸差异之比。朴素差异 $d_{naive}$ 是使用整个基因组中的所有SNPs计算的。校正后的克隆差异 $d_{clonal}$ 仅使用在克隆框架内发现的SNPs计算。\n\n计算比率 $\\frac{d_{naive}}{d_{clonal}}$ 并将最终答案四舍五入到三位有效数字。", "solution": "给定总比对基因组长度 $L_{total} = 4.50 \\times 10^{6}$，总SNPs数量 $N_{total} = 215$，HGT片段长度 $L_{HGT} = 6.00 \\times 10^{4}$，其中包含 $N_{HGT} = 185$ 个SNPs。克隆框架不包括HGT区域。\n\n将朴素差异定义为整个基因组的总SNP密度：\n$$\nd_{naive} = \\frac{N_{total}}{L_{total}}.\n$$\n将克隆差异定义为仅在克隆框架内的SNP密度。克隆框架的长度和SNP数量为\n$$\nL_{clonal} = L_{total} - L_{HGT}, \\quad N_{clonal} = N_{total} - N_{HGT}.\n$$\n因此，\n$$\nd_{clonal} = \\frac{N_{clonal}}{L_{clonal}}.\n$$\n所求比率为\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{\\frac{N_{total}}{L_{total}}}{\\frac{N_{clonal}}{L_{clonal}}} = \\frac{N_{total} L_{clonal}}{N_{clonal} L_{total}}.\n$$\n代入给定值：\n$$\nL_{clonal} = 4.50 \\times 10^{6} - 6.00 \\times 10^{4} = 4.44 \\times 10^{6}, \\quad N_{clonal} = 215 - 185 = 30.\n$$\n因此，\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{215 \\times \\left(4.44 \\times 10^{6}\\right)}{30 \\times \\left(4.50 \\times 10^{6}\\right)} = \\frac{215}{30} \\cdot \\frac{4.44}{4.50}.\n$$\n精确简化：\n$$\n\\frac{215}{30} = \\frac{43}{6}, \\quad \\frac{4.44}{4.50} = \\frac{444}{450} = \\frac{74}{75},\n$$\n所以\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{43}{6} \\cdot \\frac{74}{75} = \\frac{1591}{225} \\approx 7.071\\overline{1}.\n$$\n四舍五入到三位有效数字，结果为 $7.07$。", "answer": "$$\\boxed{7.07}$$", "id": "2105590"}, {"introduction": "WGS在疫情监测中的最终威力体现在它与传统流行病学数据的整合上。这个高级练习模拟了一个真实世界的场景，即仅靠遗传数据不足以解析传播链。你将应用一个量化模型，该模型结合了SNP距离与患者的位置和时间信息，以识别最可能的未被观察到的中间传播者，从而展示多学科方法如何解决复杂的流行病学难题[@problem_id:2105596]。", "problem": "一家医院正在进行一项调查，以了解一次细菌爆发的传播动态。已对所有已知感染患者的分离株进行了全基因组测序（WGS）。任意两个分离株之间的遗传相关性通过它们基因组之间的单核苷酸多态性（SNP）差异数量来量化。\n\n调查人员正重点关注两名特定患者，病例 K1 和病例 K2，他们被怀疑是同一传播链的一部分。然而，他们分离株之间的遗传距离大于直接传播事件的预期值，这表明存在一个或多个未被观察到的中间患者。另外四名患者（P1、P2、P3 和 P4）在同一时期住院，但最初未被认为是该特定传播链的一部分，现在正被评估为潜在的中间人。\n\n为了确定连接 K1 和 K2 的最可能的中间人，为每个潜在的中间患者（PI）计算了一个“传播合理性评分”（TPS）。TPS 最高的患者被认为是最可能的缺失环节。TPS 定义为遗传评分和流行病学评分的乘积：\n$$TPS(PI) = S_{genetic}(PI) \\times S_{epid}(PI)$$\n遗传评分 $S_{genetic}(PI)$ 衡量中间人的基因组在 K1 和 K2 之间的路径上的拟合程度。它由以下公式给出：\n$$S_{genetic}(PI) = \\frac{1}{1 + |(\\text{SNP(K1, PI)} + \\text{SNP(PI, K2)}) - \\text{SNP(K1, K2)}|}$$\n其中 $\\text{SNP(A, B)}$ 是患者 A 和患者 B 之间的 SNP 距离。\n\n流行病学评分 $S_{epid}(PI)$ 根据位置和时间确定通过中间人的传播路径是否可能。其定义为：\n$$S_{epid}(PI) = L(\\text{K1, PI}) \\times L(\\text{PI, K2})$$\n术语 $L(\\text{A, B})$ 代表从患者 A 到患者 B 的一个合理的传播联系。如果以下两个条件都满足，$L(\\text{A, B}) = 1$，否则 $L(\\text{A, B}) = 0$：\n1.  **时空重叠**：患者 A 和患者 B 在同一病房至少待满一天。\n2.  **因果方向性**：患者 B 的症状发作日严格晚于患者 A 的症状发作日。\n\n相关数据如下所示。\n\n**表1：SNP 距离矩阵**\n| | K1 | K2 | P1 | P2 | P3 | P4 |\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n| **K1**| 0 | 12 | 5 | 8 | 13 | 4 |\n| **K2**| 12 | 0 | 7 | 4 | 6 | 9 |\n| **P1**| 5 | 7 | 0 | 6 | 9 | 3 |\n| **P2**| 8 | 4 | 6 | 0 | 10 | 7 |\n| **P3**| 13 | 6 | 9 | 10 | 0 | 11|\n| **P4**| 4 | 9 | 3 | 7 | 11 | 0 |\n\n**表2：患者流行病学数据**\n| 患者 | 症状发作日 | 病房停留时间 |\n|:---:|:---:|:---|\n| **K1**| 5 | A病房 (第 1 - 8 天) |\n| **K2**| 20 | C病房 (第 18 - 25 天) |\n| **P1**| 12 | A病房 (第 7 - 10 天), C病房 (第 17 - 21 天) |\n| **P2**| 10 | B病房 (第 6 - 12 天), D病房 (第 12 - 16 天) |\n| **P3**| 14 | A病房 (第 6 - 12 天), C病房 (第 15 - 20 天) |\n| **P4**| 9 | A病房 (第 2 - 6 天) |\n\n根据最高的传播合理性评分，哪位患者最可能是连接病例 K1 和病例 K2 的未被观察到的中间人？\n\nA. P1\n\nB. P2\n\nC. P3\n\nD. P4", "solution": "我们需要为每个潜在中间人 $PI \\in \\{P1,P2,P3,P4\\}$ 计算传播合理性评分\n$$\nTPS(PI) = S_{genetic}(PI) \\times S_{epid}(PI),\n$$\n其中\n$$\nS_{genetic}(PI) = \\frac{1}{1 + |(\\text{SNP(K1, PI)} + \\text{SNP(PI, K2)}) - \\text{SNP(K1, K2)}|}\n$$\n以及\n$$\nS_{epid}(PI) = L(\\text{K1, PI}) \\times L(\\text{PI, K2}).\n$$\n链接指标 $L(\\text{A, B})$ 等于 $1$ 当且仅当以下两个条件都成立：(i) A 和 B 在同一病房有至少一整天的重叠，并且 (ii) B 的发病日严格晚于 A 的发病日；否则 $L(\\text{A, B})=0$。我们使用表2中的病房停留区间和发病日以及表1中的SNP距离。\n\n首先，通过评估 $L(\\text{K1, PI})$ 和 $L(\\text{PI, K2})$ 来计算 $S_{epid}$。\n\n对于 $PI = P1$：\n- $L(\\text{K1, P1})$：K1 在 $[1,8]$ 天位于A病房，P1 在 $[7,10]$ 天位于A病房。重叠时间为 $[7,8]$，包含至少一整天。发病时间满足 $12 > 5$。因此 $L(\\text{K1, P1})=1$。\n- $L(\\text{P1, K2})$：P1 在 $[17,21]$ 天位于C病房，K2 在 $[18,25]$ 天位于C病房。重叠时间为 $[18,21]$，包含至少一整天。发病时间满足 $20 > 12$。因此 $L(\\text{P1, K2})=1$。\n因此 $S_{epid}(P1) = 1 \\times 1 = 1$。\n\n对于 $PI = P2$：\n- $L(\\text{K1, P2})$：K1 在A病房；P2 仅在B病房和D病房，所以没有同病房重叠。因此 $L(\\text{K1, P2})=0$。\n- $L(\\text{P2, K2})$：K2 在C病房；P2 不在C病房。因此 $L(\\text{P2, K2})=0$。\n因此 $S_{epid}(P2) = 0 \\times 0 = 0$。\n\n对于 $PI = P3$：\n- $L(\\text{K1, P3})$：K1 在 $[1,8]$ 天位于A病房，P3 在 $[6,12]$ 天位于A病房。重叠时间为 $[6,8]$，有至少一整天，并且 $14 > 5$。因此 $L(\\text{K1, P3})=1$。\n- $L(\\text{P3, K2})$：P3 在 $[15,20]$ 天位于C病房，K2 在 $[18,25]$ 天位于C病房。重叠时间为 $[18,20]$，有至少一整天，并且 $20 > 14$。因此 $L(\\text{P3, K2})=1$。\n因此 $S_{epid}(P3) = 1 \\times 1 = 1$。\n\n对于 $PI = P4$：\n- $L(\\text{K1, P4})$：K1 在 $[1,8]$ 天位于A病房，P4 在 $[2,6]$ 天位于A病房。重叠时间为 $[2,6]$，有至少一整天，并且 $9 > 5$。因此 $L(\\text{K1, P4})=1$。\n- $L(\\text{P4, K2})$：P4 仅在A病房；K2 仅在C病房。没有同病房重叠，所以 $L(\\text{P4, K2})=0$。\n因此 $S_{epid}(P4) = 1 \\times 0 = 0$。\n\n接下来，使用表1中的SNP距离计算每个 $PI$ 的 $S_{genetic}$，注意 $\\text{SNP(K1, K2)} = 12$。\n\n对于 $PI = P1$：\n$$\n\\text{SNP(K1, P1)} = 5,\\quad \\text{SNP(P1, K2)} = 7,\\quad 5 + 7 = 12.\n$$\n因此\n$$\nS_{genetic}(P1) = \\frac{1}{1 + |12 - 12|} = \\frac{1}{1 + 0} = 1.\n$$\n\n对于 $PI = P2$：\n$$\n\\text{SNP(K1, P2)} = 8,\\quad \\text{SNP(P2, K2)} = 4,\\quad 8 + 4 = 12.\n$$\n因此\n$$\nS_{genetic}(P2) = \\frac{1}{1 + |12 - 12|} = 1.\n$$\n\n对于 $PI = P3$：\n$$\n\\text{SNP(K1, P3)} = 13,\\quad \\text{SNP(P3, K2)} = 6,\\quad 13 + 6 = 19.\n$$\n因此\n$$\nS_{genetic}(P3) = \\frac{1}{1 + |19 - 12|} = \\frac{1}{1 + 7} = \\frac{1}{8}.\n$$\n\n对于 $PI = P4$：\n$$\n\\text{SNP(K1, P4)} = 4,\\quad \\text{SNP(P4, K2)} = 9,\\quad 4 + 9 = 13.\n$$\n因此\n$$\nS_{genetic}(P4) = \\frac{1}{1 + |13 - 12|} = \\frac{1}{1 + 1} = \\frac{1}{2}.\n$$\n\n最后，计算 $TPS$：\n- $TPS(P1) = S_{genetic}(P1) \\times S_{epid}(P1) = 1 \\times 1 = 1$。\n- $TPS(P2) = 1 \\times 0 = 0$。\n- $TPS(P3) = \\frac{1}{8} \\times 1 = \\frac{1}{8}$。\n- $TPS(P4) = \\frac{1}{2} \\times 0 = 0$。\n\n最高的传播合理性评分是 $P1$ 的。因此，最可能的中间人是选项A。", "answer": "$$\\boxed{A}$$", "id": "2105596"}]}