{"hands_on_practices": [{"introduction": "从零开始组装基因组（*de novo* 组装）就像是用数百万个微小、重叠的碎片拼凑一个复杂的拼图。本练习将介绍一种强大而巧妙的计算方法——德布莱因图（De Bruijn graph），它将寻找重叠序列的问题转化为在图中寻找路径的问题。通过这个练习，你将亲身体验这一核心生物信息学算法的魅力。[@problem_id:2290987]", "problem": "一位分子生物学家正在对一种新发现的嗜极细菌的短线性DNA片段进行*从头*基因组组装。测序过程产生了一组短的、重叠的读段（reads）。为了重建原始DNA序列，该生物学家采用了一种德布鲁因图（De Bruijn graph）组装策略。该过程首先将所有测序读段分解成一个完整的k-mers集合，k-mers是长度为固定值 $k$ 的短子串。\n\n对于本次特定的组装，使用了 $k=4$ 的值。从读段中获得的全部4-mers的完整、无序集合是：\n`{ ATGC, TGCG, GCGT, CGTA, GTAC, TACG, ACGT, CGTG }`\n\n您的任务是从这组4-mers中重建原始的、连续的DNA序列。为此，您必须首先构建相应的德布鲁因图。在这个特定的图模型中：\n1.  图的节点（或顶点）是所有唯一的(k-1)-mers。(k-1)-mer是一个长度为 $k-1=3$ 的序列。这些节点源自给定集合中每个4-mer的前缀（前3个碱基）和后缀（后3个碱基）。\n2.  当且仅当集合中存在一个4-mer，其前缀是 `U` 且后缀是 `V` 时，从节点 `U` 到节点 `V` 画一条有向边。集合中的每个4-mer都精确对应图中的一条有向边。\n\n通过找到那条遍历每条边一次且仅一次的唯一路径，确定原始线性片段的完整DNA序列。", "solution": "问题要求我们使用德布鲁因图从一组k-mers重建一个DNA序列。给定的k-mers集合（$k=4$）是`{ATGC, TGCG, GCGT, CGTA, GTAC, TACG, ACGT, CGTG}`。\n\n**第一步：确定德布鲁因图的节点。**\n节点是唯一的(k-1)-mers，即3-mers（三核苷酸）。我们可以通过列出所有给定4-mers的前缀和后缀来找到它们。\n\n这些4-mers是：\n- `ATGC`: 前缀 `ATG`，后缀 `TGC`\n- `TGCG`: 前缀 `TGC`，后缀 `GCG`\n- `GCGT`: 前缀 `GCG`，后缀 `CGT`\n- `CGTA`: 前缀 `CGT`，后缀 `GTA`\n- `GTAC`: 前缀 `GTA`，后缀 `TAC`\n- `TACG`: 前缀 `TAC`，后缀 `ACG`\n- `ACGT`: 前缀 `ACG`，后缀 `CGT`\n- `CGTG`: 前缀 `CGT`，后缀 `GTG`\n\n所有前缀的集合是`{ATG, TGC, GCG, CGT, GTA, TAC, ACG}`。\n所有后缀的集合是`{TGC, GCG, CGT, GTA, TAC, ACG, GTG}`。\n\n唯一节点的完整集合是这两个集合的并集：\n节点 = `{ATG, TGC, GCG, CGT, GTA, TAC, ACG, GTG}`。\n\n**第二步：构建有向边。**\n每个4-mer对应一条从其前缀节点到其后缀节点的有向边。\n\n- `ATGC` → 从 `ATG` 到 `TGC` 的边\n- `TGCG` → 从 `TGC` 到 `GCG` 的边\n- `GCGT` → 从 `GCG` 到 `CGT` 的边\n- `CGTA` → 从 `CGT` 到 `GTA` 的边\n- `GTAC` → 从 `GTA` 到 `TAC` 的边\n- `TACG` → 从 `TAC` 到 `ACG` 的边\n- `ACGT` → 从 `ACG` 到 `CGT` 的边\n- `CGTG` → 从 `CGT` 到 `GTG` 的边\n\n**第三步：找到欧拉路径的起始和终点节点。**\n重建序列需要找到一条欧拉路径，这是一条访问每条边一次且仅一次的路径。对于有向图，存在欧拉路径的充要条件是：图是连通的，并且最多有一个顶点的 `出度 - 入度 = 1`，最多有一个顶点的 `入度 - 出度 = 1`，所有其他顶点的 `入度 = 出度`。\n\n我们来计算每个节点的入度和出度：\n- **ATG**: 出度 = 1 (到 TGC)，入度 = 0。差值 = +1。这是起始节点。\n- **TGC**: 出度 = 1 (到 GCG)，入度 = 1 (来自 ATG)。差值 = 0。\n- **GCG**: 出度 = 1 (到 CGT)，入度 = 1 (来自 TGC)。差值 = 0。\n- **CGT**: 出度 = 2 (到 GTA, 到 GTG)，入度 = 2 (来自 GCG, 来自 ACG)。差值 = 0。\n- **GTA**: 出度 = 1 (到 TAC)，入度 = 1 (来自 CGT)。差值 = 0。\n- **TAC**: 出度 = 1 (到 ACG)，入度 = 1 (来自 GTA)。差值 = 0。\n- **ACG**: 出度 = 1 (到 CGT)，入度 = 1 (来自 TAC)。差值 = 0。\n- **GTG**: 出度 = 0，入度 = 1 (来自 CGT)。差值 = -1。这是终点节点。\n\n该图有一个起始节点（`ATG`）和一个终点节点（`GTG`），因此存在一条唯一的欧拉路径。\n\n**第四步：追踪欧拉路径并重建序列。**\n路径从节点 `ATG` 开始。序列以起始节点的字符串 `ATG` 开始。然后，我们依次追加路径中遍历的每个后续k-mer的最后一个字符。\n\n1.  从 `ATG` 开始。唯一的出边对应k-mer `ATGC`。当前序列：`ATGC`。我们现在到达节点 `TGC`。\n2.  从 `TGC` 出发，出边对应 `TGCG`。我们追加最后一个字符 `G`。序列：`ATGCG`。我们现在到达节点 `GCG`。\n3.  从 `GCG` 出发，出边对应 `GCGT`。我们追加 `T`。序列：`ATGCGT`。我们现在到达节点 `CGT`。\n4.  从 `CGT` 出发，有两条出边，`CGTA` 和 `CGTG`。我们知道 `GTG` 是整个路径的终点节点，所以除非别无选择，否则我们不应该现在就走通往 `GTG` 的边。让我们选择 `CGTA` 对应的边。我们追加 `A`。序列：`ATGCGTA`。我们现在到达节点 `GTA`。\n5.  从 `GTA` 出发，出边对应 `GTAC`。追加 `C`。序列：`ATGCGTAC`。我们现在到达节点 `TAC`。\n6.  从 `TAC` 出发，出边对应 `TACG`。追加 `G`。序列：`ATGCGTACG`。我们现在到达节点 `ACG`。\n7.  从 `ACG` 出发，出边对应 `ACGT`。追加 `T`。序列：`ATGCGTACGT`。这让我们回到了节点 `CGT`。\n8.  我们再次到达 `CGT`。`CGTA` 对应的边已经被使用。从 `CGT` 出发的唯一未使用的边是通往 `CGTG` 的那条。我们遍历这条边。追加 `G`。序列：`ATGCGTACGTG`。我们到达终点节点 `GTG`。\n\n所有8条边（k-mers）都已被使用一次且仅一次。路径从 `ATG` 开始，到 `GTG` 结束。最终重建的序列就是我们构建的这个字符串。\n\n最终序列：`ATGCGTACGTG`。", "answer": "$$\\boxed{ATGCGTACGTG}$$", "id": "2290987"}, {"introduction": "在组装出一段DNA序列后，下一个关键步骤是进行注释——即在序列中寻找功能性元件，例如基因。本练习将聚焦于基因预测的一个基本环节：通过扫描起始密码子和终止密码子来定位开放阅读框（Open Reading Frames, ORFs）。掌握这项技能是将原始测序数据转化为生物学意义的基础。[@problem_id:2291009]", "problem": "在分子生物学中，开放阅读框 (ORF) 是一段连续的DNA序列，具有被翻译成蛋白质的潜力。它从一个起始密码子开始，到同一阅读框中的一个终止密码子结束。\n\n考虑以下单链DNA序列，它代表了从一种新发现的细菌中获得的一个片段：\n`5'-AGCTTAGCATGCTAGGCGATTACGTAGCATGATTGCCGACTAGCATAA-3'`\n\n为解决此问题，我们将根据以下具体规则定义ORF：\n1.  起始密码子仅为 `ATG`。\n2.  终止密码子为 `TAA`、`TAG` 或 `TGA`。\n3.  一个ORF以一个起始密码子 (`ATG`) 开始，并以其后遇到的第一个“同框”的终止密码子 (`TAA`、`TAG` 或 `TGA`) 结束。如果从起始密码子的第一个碱基到终止密码子的第一个碱基的核苷酸数量是3的倍数，则该终止密码子被认为是同框的。\n4.  ORF序列包括从起始密码子的开始到终止密码子的结束的所有核苷酸（含两端）。\n\n请分析所提供的DNA序列，并根据这些规则识别所有可能的ORF。您的任务是确定最长可能ORF的核苷酸序列。", "solution": "我们仅考虑所提供的5'到3'方向的单链序列，并应用ORF规则：一个ORF从起始密码子ATG开始，到集合{TAA, TAG, TGA}中第一个后续的同框终止密码子结束。如果一个终止密码子位于位置$j$，一个起始密码子位于位置$i$，当且仅当$j-i$是$3$的倍数时，该终止密码子是同框的，即存在$k \\in \\mathbb{Z}_{\\ge 0}$使得$j = i + 3k$。\n\n从5'端开始，将核苷酸索引为位置$1,2,\\dots,48$。给定的序列是：\nAGCTTAGCATGCTAGGCGATTACGTAGCATGATTGCCGACTAGCATAA,\n其核苷酸位置如下：\n1 A, 2 G, 3 C, 4 T, 5 T, 6 A, 7 G, 8 C, 9 A, 10 T, 11 G, 12 C, 13 T, 14 A, 15 G, 16 G, 17 C, 18 G, 19 A, 20 T, 21 T, 22 A, 23 C, 24 G, 25 T, 26 A, 27 G, 28 C, 29 A, 30 T, 31 G, 32 A, 33 T, 34 T, 35 G, 36 C, 37 C, 38 G, 39 A, 40 C, 41 T, 42 A, 43 G, 44 C, 45 A, 46 T, 47 A, 48 A.\n\n通过扫描三联体$(i,i+1,i+2)$来识别所有起始密码子ATG：\n- 在位置$9$–$11$：ATG (起始)。\n- 在位置$29$–$31$：ATG (起始)。\n没有其他ATG出现。\n\n对于从$i=9$开始的起始密码子（密码子 9–11 = ATG），检查后续的同框密码子$(9$–$11)$, $(12$–$14)$, $(15$–$17)$, $(18$–$20)$, $(21$–$23)$, $(24$–$26)$, $(27$–$29)$, $(30$–$32)$：\n- 9–11: ATG (起始),\n- 12–14: CTA,\n- 15–17: GGC,\n- 18–20: GAT,\n- 21–23: TAC,\n- 24–26: GTA,\n- 27–29: GCA,\n- 30–32: TGA (终止)。\n第一个同框的终止密码子是位于$j=30$的TGA，并且$j-i=30-9=21=3 \\times 7$，因此它是同框的。所以，这个ORF跨越位置$9$到$32$（含两端），长度为$32-9+1=24$个核苷酸，序列为：\nATG CTA GGC GAT TAC GTA GCA TGA,\n即，ATGCTAGGCGATTACGTAGCATGA。\n\n对于从$i=29$开始的起始密码子（密码子 29–31 = ATG），检查后续的同框密码子$(29$–$31)$, $(32$–$34)$, $(35$–$37)$, $(38$–$40)$, $(41$–$43)$：\n- 29–31: ATG (起始),\n- 32–34: ATT,\n- 35–37: GCC,\n- 38–40: GAC,\n- 41–43: TAG (终止)。\n第一个同框的终止密码子是位于$j=41$的TAG，并且$j-i=41-29=12=3 \\times 4$，因此它是同框的。所以，这个ORF跨越位置$29$到$43$（含两端），长度为$43-29+1=15$个核苷酸，序列为：\nATG ATT GCC GAC TAG,\n即，ATGATTGCCGACTAG。\n\n比较长度，$24 > 15$，所以最长的ORF是从位置$9$开始到位置$32$结束的那个，其核苷酸序列为ATGCTAGGCGATTACGTAGCATGA。", "answer": "$$\\boxed{ATGCTAGGCGATTACGTAGCATGA}$$", "id": "2291009"}, {"introduction": "现代基因测序不仅能确定A、T、C、G的排列顺序，还能提供定量信息。本练习将展示测序的“读段深度”（read depth）如何作为一种强大的诊断工具，用于检测基因拷贝数的改变——这是一种在癌症研究和临床遗传学中至关重要的结构变异。这个实践突显了从定性序列分析向量化基因组学分析的转变。[@problem_id:2290956]", "problem": "一个临床研究实验室对来自一名患者肿瘤的DNA样本进行全基因组测序（WGS）。对测序数据进行分析以确定测序深度，其定义为比对到参考基因组上每个位置的独立测序读段的数量。对于像人类这样的二倍体生物，其常染色体的正常拷贝数为2。对此患者样本的分析显示，全基因组的平均测序深度 $C_{avg}$ 为 $45.0\\text{x}$。对一个已知的癌基因（我们称之为 `OG-1`）的详细分析表明，该基因区域的平均测序深度 $C_{OG1}$ 为 $112.5\\text{x}$。\n\n假设局部平均测序深度与该区域的DNA拷贝数成正比，请计算患者肿瘤细胞中 `OG-1` 基因最可能的整数拷贝数。", "solution": "定义测序深度和拷贝数之间的比例关系：对于任意基因组区域，设 $C$ 表示测序深度，$N$ 表示拷贝数，$k$ 为比例常数，则有 $C = k N$。\n\n以二倍体生物中的常染色体为基准，平均拷贝数为 $N_{avg} = 2$，测得的平均测序深度为 $C_{avg}$，可得\n$$\nC_{avg} = k \\cdot 2 \\quad \\Rightarrow \\quad k = \\frac{C_{avg}}{2}.\n$$\n\n对于测序深度为 $C_{OG1}$、拷贝数为 $N_{OG1}$ 的基因 OG-1，同样的比例关系给出\n$$\nC_{OG1} = k \\, N_{OG1} \\quad \\Rightarrow \\quad N_{OG1} = \\frac{C_{OG1}}{k} = \\frac{C_{OG1}}{C_{avg}/2} = \\frac{2 C_{OG1}}{C_{avg}}.\n$$\n\n代入给定值 $C_{OG1} = 112.5$ 和 $C_{avg} = 45.0$，\n$$\nN_{OG1} = \\frac{2 \\cdot 112.5}{45.0} = \\frac{225}{45.0} = 5.\n$$\n\n由于拷贝数是整数，因此 OG-1 最可能的整数拷贝数为 $5$。", "answer": "$$\\boxed{5}$$", "id": "2290956"}]}