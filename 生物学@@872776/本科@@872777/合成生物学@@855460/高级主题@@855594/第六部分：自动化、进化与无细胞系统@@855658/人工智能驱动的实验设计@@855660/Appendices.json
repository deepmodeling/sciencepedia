{"hands_on_practices": [{"introduction": "在合成生物学中，人工智能驱动的设计始于对“设计空间”的理解，即所有可能的生物变体的集合。本练习通过一个具体的蛋白质工程场景，让您亲手计算设计空间的巨大规模，从而体会为何蛮力筛选不可行，而必须借助人工智能进行高效探索。[@problem_id:2018103]", "problem": "一家合成生物学初创公司正在使用一个人工智能（AI）平台来设计一种用于生物成像应用的新型荧光蛋白。起点是一种野生型蛋白，由100个氨基酸组成的单链构成。AI模型预测，通过引入恰好两个点突变，可以使该蛋白质的荧光最大化。点突变定义为将单个位置的氨基酸改变为任何其他一种标准氨基酸。假设有20种标准的蛋白质氨基酸，计算AI必须探索的设计空间的总大小。这对应于与野生型序列相比，恰好有两个氨基酸不同的独特蛋白质变体的总数。", "solution": "我们必须计算在恰好两个位置上与野生型不同的所有蛋白质变体的数量。\n\n- 序列中有 $100$ 个位置。选择恰好两个不同的位置进行突变是一个组合问题，因为这两个位置的顺序无关紧要。根据组合公式，选择这些位置的方法数是\n$$\n\\binom{100}{2}.\n$$\n\n- 对于每个选定的位置，原始氨基酸必须被更改为另一种不同的氨基酸。有 $20$ 种标准氨基酸，因此每个位置有 $20-1=19$ 种可能的替换。这两个位置的选择是独立的，得到\n$$\n19 \\times 19 = 19^{2}\n$$\n种对于一对固定位置的替换选择。\n\n- 根据计数中的乘法原理，具有恰好两个突变的变体总数是\n$$\nN=\\binom{100}{2} \\times 19^{2}.\n$$", "answer": "$$\\boxed{\\binom{100}{2}\\times 19^{2}}$$", "id": "2018103"}, {"introduction": "在广阔的设计空间中，人工智能需要一个明确的目标来进行导航。本练习将向您展示如何将一个真实的生物工程问题——在最大化蛋白质产量的同时最小化昂贵诱导剂的成本——转化为一个数学上的“目标函数”。通过求解这个函数的最优解，您将体验到人工智能优化过程的核心步骤。[@problem_id:2018121]", "problem": "在一个现代化的生物铸造厂中，一个人工智能（AI）体负责优化一种治疗性蛋白质的生产。在细菌培养物中，这种蛋白质的合成是由一种特定的化学物质诱导的，而已知最终的蛋白质产量 $Y$ 是诱导剂浓度 $[I]$ 的函数，并遵循一个饱和模型。该关系由以下方程描述：\n$$Y([I]) = \\frac{Y_{\\text{max}} [I]}{K + [I]}$$\n其中 $Y_{\\text{max}}$ 是最大可能蛋白质产量，$K$ 是饱和常数，代表产量达到其最大值一半时的诱导剂浓度。\n\n诱导剂价格昂贵，其成本与所用浓度成正比。为了平衡高产量的收益与诱导剂的成本，AI使用一个效用函数 $U([I])$，并旨在将其最大化：\n$$U([I]) = Y([I]) - \\lambda [I]$$\n在此，$\\lambda$ 是一个正常数，代表诱导剂的边际成本，并已归一化为与产量相同的单位。假设系统参数满足 $\\frac{Y_{\\text{max}}}{\\lambda} > K$，这确保了使用非零量的诱导剂是有益的。\n\n你的任务是确定AI为最大化此效用函数应选择的最佳诱导剂浓度 $[I]_{\\text{opt}}$。请用 $Y_{\\text{max}}$、$K$ 和 $\\lambda$ 将你的答案表示为单个符号表达式。", "solution": "我们需要关于 $[I] \\geq 0$ 最大化效用函数 $U([I]) = Y([I]) - \\lambda [I]$，其中 $Y([I]) = \\dfrac{Y_{\\text{max}}[I]}{K + [I]}$ 且 $\\lambda > 0$，$K > 0$，$Y_{\\text{max}} > 0$。由于当 $[I] > -K$ 时 $U$ 是可微的，并且可行域为 $[I] \\geq 0$，我们使用一阶最优性条件并验证二阶条件。\n\n首先使用商法则计算 $Y([I])$ 的导数。令 $g([I]) = Y_{\\text{max}}[I]$ 和 $h([I]) = K + [I]$。那么 $g'([I]) = Y_{\\text{max}}$ 且 $h'([I]) = 1$，商法则给出\n$$\n\\frac{dY}{d[I]} = \\frac{g'([I])h([I]) - g([I])h'([I])}{h([I])^{2}} = \\frac{Y_{\\text{max}}(K + [I]) - Y_{\\text{max}}[I]}{(K + [I])^{2}} = \\frac{Y_{\\text{max}}K}{(K + [I])^{2}}.\n$$\n因此，\n$$\n\\frac{dU}{d[I]} = \\frac{dY}{d[I]} - \\lambda = \\frac{Y_{\\text{max}}K}{(K + [I])^{2}} - \\lambda.\n$$\n令导数为零以获得一阶条件：\n$$\n\\frac{Y_{\\text{max}}K}{(K + [I])^{2}} - \\lambda = 0 \\quad \\Longrightarrow \\quad (K + [I])^{2} = \\frac{Y_{\\text{max}}K}{\\lambda}.\n$$\n取正平方根（因为对于 $[I] \\geq 0$，有 $K + [I] > 0$），\n$$\nK + [I] = \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}} \\quad \\Longrightarrow \\quad [I]_{\\text{opt}} = \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}} - K.\n$$\n为确认这是一个最大值，计算二阶导数：\n$$\n\\frac{d^{2}U}{d[I]^{2}} = \\frac{d}{d[I]}\\left(\\frac{Y_{\\text{max}}K}{(K + [I])^{2}}\\right) = -\\frac{2Y_{\\text{max}}K}{(K + [I])^{3}}  0 \\quad \\text{for} \\quad [I] \\geq 0,\n$$\n这确保了 $U$ 在 $[I]$ 上是严格凹函数，并且该临界点是其定义域上的全局最大值，除非它位于 $[I] \\geq 0$ 之外。假设 $\\dfrac{Y_{\\text{max}}}{\\lambda}  K$ 意味着\n$$\n\\frac{Y_{\\text{max}}K}{\\lambda}  K^{2} \\quad \\Longrightarrow \\quad \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}}  K \\quad \\Longrightarrow \\quad [I]_{\\text{opt}}  0,\n$$\n所以最优解是内部解并且是可行的。因此，最佳诱导剂浓度为\n$$\n[I]_{\\text{opt}} = \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}} - K.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}}-K}$$", "id": "2018121"}, {"introduction": "人工智能在实验设计中的应用远不止是寻找最优解，它更是一个加速科学发现的强大工具。本项进阶练习将引导您运用因果推理的思维，设计一组最精简的基因扰动实验，以区分两种关于调控网络工作机制的竞争假说。这体现了AI驱动的“设计-构建-测试-学习”循环在揭示复杂生物学机制方面的核心价值。[@problem_id:2018119]", "problem": "在合成生物学领域，一个研究团队设计了一种细菌菌株来生产一种有价值的治疗性化合物。该生产途径的最后一个限速步骤由基因A编码的酶P_A催化。当细胞暴露于一种外部诱导剂分子时，观察到总通路流量（表示为 $F$）显著增加。这种诱导剂会激活一个主调节因子（MR）蛋白。然而，MR控制流量 $F$ 的确切机制尚不清楚。现有两种相互竞争的假说被提出：\n\n**假说 H1（转录级联）：** 活化的MR直接与基因A的启动子结合，增加其转录。由此导致的P_A蛋白浓度的增加是观察到流量 $F$ 增加的唯一原因。\n\n**假说 H2（代谢变构）：** 基因A以恒定的组成型水平表达，产生基础量的P_A。而活化的MR则直接增加另一个基因——基因B的转录。基因B的蛋白质产物P_B是一种合成小分子代谢物M的酶。然后，这个代谢物M作为P_A酶的变构激活剂，增加其催化活性，从而增加流量 $F$。在此模型中，P_A的浓度在诱导后不发生改变。\n\n您的任务是设计一个实验方案，以确定哪个假说是正确的。您可以使用以下实验能力：\n1.  控制诱导剂分子的存在与否。\n2.  通过CRISPR干扰（CRISPRi）创建靶向基因敲降的菌株，这能有效沉默特定基因的转录（例如，“CRISPRi-A”菌株的基因A被沉默）。\n3.  从一个强的、非调控的启动子出发，创建组成型过表达（OE）特定基因的菌株，从而使其蛋白质产物浓度高且恒定（例如，“OE-A”菌株持续产生高水平的P_A）。\n\n明确区分模型 H1 和模型 H2 所需的**最小实验条件集**是什么？一个“实验条件”被定义为特定细菌菌株和诱导剂状态的唯一组合。唯一可用的测量指标是最终的通路流量 $F$。如果两组条件的数量相同，则需要最少独特基因改造菌株的集合为最小集。\n\nA. 在三个条件下测量流量：1) 野生型加诱导剂，2) CRISPRi-A 菌株加诱导剂，3) CRISPRi-B 菌株加诱导剂。\n\nB. 在两个条件下测量流量：1) 野生型加诱导剂，2) CRISPRi-B 菌株加诱导剂。\n\nC. 在三个条件下测量流量：1) 野生型不加诱导剂，2) 野生型加诱导剂，3) CRISPRi-A 菌株加诱导剂。\n\nD. 在两个条件下测量流量：1) OE-A 菌株不加诱导剂，2) OE-B 菌株不加诱导剂。\n\nE. 在两个条件下测量流量：1) 野生型不加诱导剂，2) OE-A 菌株加诱导剂。", "solution": "这个问题的核心是应用因果推理来确定哪一组扰动能够揭示真实的底层网络结构。如果一个扰动对两种假说能产生不同的预测结果，那么它就是信息性的。目标是找到由这类信息性实验组成的最小集合。\n\n首先，让我们为每个假说形式化其因果路径。设`Inducer`（诱导剂）为输入，`Flux`（流量）为输出。`txn(X)`表示基因X的转录，`[P_X]`是蛋白质X的浓度，`act(P_A)`是蛋白质P_A的活性。\n\n**假说 H1（转录级联）：**\n因果链是：\n`Inducer → MR → txn(A) → [P_A] → Flux`\n在此模型中，基因B是无关的。\n\n**假说 H2（代谢变构）：**\n存在两个并行过程。基因A是组成型表达的，而基因B是被诱导的。\n`Constitutive Promoter → txn(A) → [P_A]`\n`Inducer → MR → txn(B) → [P_B] → [Metabolite M] ⇢ act(P_A)`\n流量是P_A浓度和活性的函数：`Flux = f([P_A], act(P_A))`。虚线箭头`⇢`代表变构激活。\n\n根据问题陈述确认的基础行为是，向野生型（WT）菌株中添加诱导剂会增加流量。\n*   （WT，无诱导剂）→ 低流量\n*   （WT，有诱导剂）→ 高流量\n\n现在，我们评估选项中提出的扰动，看它们是否能够区分 H1 和 H2。如果一个实验在一个假说下的预测流量为“高”而在另一个假说下为“低”，那么该实验就是可区分的。\n\n**关键扰动分析：**\n\n1.  **CRISPRi-A（基因A敲降）：** 这会沉默`txn(A)`。\n    *   在H1中，`txn(A)`在主因果路径上。沉默它会打破这个链条，导致[P_A]低，因此即使有诱导剂，流量也为**低**。\n    *   在H2中，需要`txn(A)`才能产生任何P_A蛋白。沉默它将导致没有P_A，因此无论是否有诱导剂或激活剂M的存在，流量都为**低**。\n    *   **结论：** CRISPRi-A对于区分H1和H2是**非信息性的**，因为它在两种情况下都会导致低流量。\n\n2.  **CRISPRi-B（基因B敲降）：** 这会沉默`txn(B)`。\n    *   在H1中，基因B不属于该通路。此扰动没有效果。在有诱导剂的情况下，流量将为**高**。\n    *   在H2中，`txn(B)`对于产生激活剂M至关重要。沉默它会打破被诱导的通路。P_A的活性将保持在其基础低水平。流量将为**低**。\n    *   **结论：** CRISPRi-B（有诱导剂时）是**信息性的**。\n\n3.  **OE-A（A的过表达）：** 这会将`[P_A]`设定为一个高的恒定水平，绕过其天然启动子。考虑在没有诱导剂的情况下进行此实验。\n    *   在H1中，高的`[P_A]`直接导致**高流量**。这绕过了对诱导剂和MR的需求。\n    *   在H2中，这会产生高浓度的P_A，但由于没有诱导剂，变构激活剂M不会产生。P_A酶保持在低活性状态。流量将为**低**。\n    *   **结论：** OE-A（无诱导剂时）是**信息性的**。\n\n4.  **OE-B（B的过表达）：** 这会将`[P_B]`设定为一个高的恒定水平。考虑在没有诱导剂的情况下进行此实验。\n    *   在H1中，这对`MR → Gene A`通路没有影响。没有诱导剂，基因A不被转录，因此流量保持**低**。\n    *   在H2中，过表达P_B会导致高水平的激活剂M。然后，这个M会激活组成型表达的P_A，导致**高流量**。这绕过了对诱导剂的需求。\n    *   **结论：** OE-B（无诱导剂时）是**信息性的**。\n\n现在我们根据充分性和最小性评估给定的选项。\n\n*   **A. {（WT，诱导剂），（CRISPRi-A，诱导剂），（CRISPRi-B，诱导剂）}：** 这个集合有3个条件。它包含了非信息性的CRISPRi-A实验。虽然与（WT，诱导剂）对照组相比，CRISPRi-B实验是信息性的，但该集合不是最小的，因为它包含了一个不必要的实验。\n\n*   **B. {（WT，诱导剂），（CRISPRi-B，诱导剂）}：** 这个集合有2个条件。\n    *   H1预测：（高流量，高流量）\n    *   H2预测：（高流量，低流量）\n    *   结果是不同的。这个集合是充分的。它需要2个条件和1个改造菌株（CRISPRi-B）。\n\n*   **C. {（WT，无诱导剂），（WT，诱导剂），（CRISPRi-A，诱导剂）}：** 这个集合有3个条件。它包括了基线实验和非信息性的CRISPRi-A实验。它不能区分H1和H2。\n\n*   **D. {（OE-A，无诱导剂），（OE-B，无诱导剂）}：** 这个集合有2个条件。\n    *   H1预测：（高流量，低流量）\n    *   H2预测：（低流量，高流量）\n    *   结果是不同的。这个集合是充分的。它需要2个条件和2个改造菌株（OE-A和OE-B）。\n\n*   **E. {（WT，无诱导剂），（OE-A，诱导剂）}：** 这个集合有2个条件。让我们分析（OE-A，诱导剂）这个实验。\n    *   在H1中，诱导剂引起`txn(A)`，而OE-A也产生P_A。结果是**高流量**。\n    *   在H2中，诱导剂产生激活剂M，而OE-A提供高水平的P_A。M激活P_A。结果是**高流量**。\n    *   这个实验不是信息性的。该集合无法区分。\n\n**最终比较与选择：**\n我们剩下选项B和D。两者都是充分的，并且都需要2个实验条件。\n*   集合B需要2个条件和1个改造菌株。\n*   集合D需要2个条件和2个改造菌株。\n\n问题陈述了一个决胜规则：“如果两组条件的数量相同，则需要最少独特基因改造菌株的集合为最小集。”\n\n根据这个规则，集合B优于集合D，因为它除了野生型外只需要创建一个新菌株（CRISPRi-B），而集合D需要两个新菌株（OE-A和OE-B）。\n\n因此，最小的实验条件集由选项B给出。", "answer": "$$\\boxed{B}$$", "id": "2018119"}]}