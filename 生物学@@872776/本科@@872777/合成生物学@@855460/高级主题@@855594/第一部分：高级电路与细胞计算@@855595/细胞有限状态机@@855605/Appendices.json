{"hands_on_practices": [{"introduction": "第一个练习是一个基础热身。理解细胞有限状态机（FSM）的第一步，是能够根据给定的规则和外部输入序列，准确地追踪系统的状态变化。在这个问题中 [@problem_id:2025665]，我们将分析一个假设的光遗传学开关，通过逐步追踪其行为来预测其最终状态，这就像逐行运行计算机程序一样。", "problem": "在合成生物学领域，研究人员设计人工基因电路来为细胞编程新的行为。考虑一种经过基因工程改造的细菌，其运动能力由光遗传学开关控制，该系统利用光来控制基因表达。这种细菌的行为可以被建模为一个离散时间有限状态机 (FSM)，这是一种具有有限数量状态的计算数学模型。\n\n该系统具有单一的二进制输入，光照（$L$），其中 $L=1$ 表示光照开启，$L=0$ 表示光照关闭。该细菌的状态由以下四种可能性之一来描述：\n- $S_0$：运动且响应。细胞处于活跃运动状态，并能对光刺激做出反应。\n- $S_1$：固着且响应。细胞是静止的，附着在表面上，并能对光刺激做出反应。\n- $S_2$：运动且不应期。细胞在移动，但处于一个时间步的冷却期，在此期间它不能对光做出反应。\n- $S_3$：固着且不应期。细胞是静止的，但处于一个时间步的冷却期，在此期间它不能对光做出反应。\n\n在每个时间步，从时间 $t$ 到 $t+1$ 的状态转换遵循以下规则：\n1. 如果细胞在时间 $t$ 处于响应状态（$S_0$ 或 $S_1$），且光照开启（$L(t)=1$），它将切换其表型（运动 $\\leftrightarrow$ 固着）并在时间 $t+1$ 进入相应的不应期状态。具体来说，$S_0$ 状态转换到 $S_3$，$S_1$ 状态转换到 $S_2$。\n2. 如果细胞在时间 $t$ 处于响应状态（$S_0$ 或 $S_1$），且光照关闭（$L(t)=0$），其状态不发生改变。在 $t+1$ 时的状态与在 $t$ 时的状态相同。\n3. 如果细胞在时间 $t$ 处于不应期状态（$S_2$ 或 $S_3$），它将在时间 $t+1$ 转换到其相应的响应状态（$S_2 \\rightarrow S_0$，$S_3 \\rightarrow S_1$），无论光输入 $L(t)$如何。\n\n假设一个细菌在时间 $t=0$ 时处于状态 $S_1$（固着且响应）。然后它受到一系列光输入，分别为 $L(0)=1$，$L(1)=0$，$L(2)=1$ 和 $L(3)=1$。在时间 $t=4$ 时，该细菌处于什么状态？\n\nA. $S_0$\n\nB. $S_1$\n\nC. $S_2$\n\nD. $S_3$", "solution": "该问题要求计算一个有限状态机 (FSM) 在一系列输入后所处的最终状态。我们需要从 $t=0$ 到 $t=4$ 的每个时间间隔，一步一步地追踪细菌的状态，并应用给定的转换规则。\n\n初始状态为 $S(0) = S_1$。输入的光照序列为 $L = \\{L(0), L(1), L(2), L(3)\\} = \\{1, 0, 1, 1\\}$。\n\n**时间步 1 (从 $t=0$ 到 $t=1$):**\n- $t=0$ 时的当前状态：$S(0) = S_1$ (固着且响应)。\n- $t=0$ 时的输入：$L(0) = 1$。\n- 适用规则：细胞处于响应状态（$S_1$）且光照开启（$L=1$）。我们应用规则1。细胞从固着状态切换到运动状态，并进入不应期状态。因此，状态转换为 $S_1 \\rightarrow S_2$。\n- $t=1$ 时的状态：$S(1) = S_2$。\n\n**时间步 2 (从 $t=1$ 到 $t=2$):**\n- $t=1$ 时的当前状态：$S(1) = S_2$ (运动且不应期)。\n- $t=1$ 时的输入：$L(1) = 0$。\n- 适用规则：细胞处于不应期状态（$S_2$）。我们应用规则3，该规则指出状态转换与光输入无关。细胞转换到其相应的响应状态。因此，状态转换为 $S_2 \\rightarrow S_0$。\n- $t=2$ 时的状态：$S(2) = S_0$。\n\n**时间步 3 (从 $t=2$ 到 $t=3$):**\n- $t=2$ 时的当前状态：$S(2) = S_0$ (运动且响应)。\n- $t=2$ 时的输入：$L(2) = 1$。\n- 适用规则：细胞处于响应状态（$S_0$）且光照开启（$L=1$）。我们应用规则1。细胞从运动状态切换到固着状态，并进入不应期状态。因此，状态转换为 $S_0 \\rightarrow S_3$。\n- $t=3$ 时的状态：$S(3) = S_3$。\n\n**时间步 4 (从 $t=3$ 到 $t=4$):**\n- $t=3$ 时的当前状态：$S(3) = S_3$ (固着且不应期)。\n- $t=3$ 时的输入：$L(3) = 1$。\n- 适用规则：细胞处于不应期状态（$S_3$）。我们应用规则3，该规则与光输入无关。细胞转换到其相应的响应状态。因此，状态转换为 $S_3 \\rightarrow S_1$。\n- $t=4$ 时的状态：$S(4) = S_1$。\n\n在处理完整个输入序列后，细菌在时间 $t=4$ 时的最终状态是 $S_1$。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2025665"}, {"introduction": "从分析现有系统到设计新系统，是工程学中的关键一步。这个练习 [@problem_id:2025697] 挑战你像合成生物学家一样思考，去创造一个特定的功能：一个只对精确化学信号序列作出响应的“组合锁”。你的目标是将这些设计要求转化为定义有限状态机的状态和转换规则的形式化语言。", "problem": "一个合成生物学家团队正在使用有限状态机 (FSM) 架构设计一种细胞“密码锁”。这种工程细胞被设计为仅在以精确、预定义的顺序暴露于三种不同的化学诱导剂后，才会产生一种特定的报告蛋白。如果诱导剂的添加顺序错误，细胞必须进入一个永久性的、不可逆的失败状态，从此状态无法恢复以产生报告蛋白。\n\n该系统具有以下组成部分：\n- **状态**：细胞可以存在于五种状态之一：\n    - `S0`：初始的“锁定”基态。\n    - `S1`：接收到第一个正确诱导剂后的状态。\n    - `S2`：接收到第二个正确诱导剂后的状态。\n    - `S3`：最终的“解锁”状态，在此状态下会产生报告蛋白。该状态是一个锁存状态，意味着一旦进入，细胞将无限期地保持在该状态。\n    - `SF`：一个不可逆的“失败”状态。一旦进入，细胞将无限期地保持在该状态。\n\n- **输入**：在任何给定时间，细胞暴露于四种可能的输入条件之一：\n    - `A`：仅存在阿拉伯糖。\n    - `T`：仅存在脱水四环素 (aTc)。\n    - `I`：仅存在异丙基-β-D-1-硫代半乳糖苷 (IPTG)。\n    - `N`：无任何诱导剂。\n\n- **逻辑**：\n    1. 到达解锁状态 `S3` 所需的序列是阿拉伯糖 (`A`)，然后是 aTc (`T`)，最后是 IPTG (`I`)。\n    2. 细胞从状态 `S0` 开始。\n    3. 在到达 `S3` 之前的任何阶段，暴露于不正确的诱导剂都会使细胞进入失败状态 `SF`。\n    4. 如果细胞处于正确的中间状态（`S1` 或 `S2`），并且诱导剂被移除（输入 `N`），或者如果它重新暴露于先前正确的诱导剂，它应保持当前状态，等待序列中的下一个正确信号。\n\n您的任务是确定此细胞 FSM 的正确状态转换表。状态转换表示为 `(当前状态, 输入) -> 下一状态`。以下哪组转换正确描述了密码锁细胞的行为？\n\nA.\n`(S0, A) -> S1`, `(S0, T) -> SF`, `(S0, I) -> SF`, `(S0, N) -> S0`\n`(S1, T) -> S2`, `(S1, I) -> SF`, `(S1, A) -> S1`, `(S1, N) -> S1`\n`(S2, I) -> S3`, `(S2, A) -> S2`, `(S2, T) -> S2`, `(S2, N) -> S2`\n`(S3, any) -> S3`, `(SF, any) -> SF`\n\nB.\n`(S0, A) -> S1`, `(S0, T) -> SF`, `(S0, I) -> SF`, `(S0, N) -> S0`\n`(S1, T) -> S2`, `(S1, I) -> S0`, `(S1, A) -> S1`, `(S1, N) -> S0`\n`(S2, I) -> S3`, `(S2, A) -> S0`, `(S2, T) -> S2`, `(S2, N) -> S0`\n`(S3, any) -> S3`, `(SF, N) -> S0`\n\nC.\n`(S0, A) -> S1`, `(S0, T) -> S1`, `(S0, I) -> S1`, `(S0, N) -> S0`\n`(S1, T) -> S2`, `(S1, I) -> SF`, `(S1, A) -> S1`, `(S1, N) -> S1`\n`(S2, I) -> S3`, `(S2, A) -> SF`, `(S2, T) -> S2`, `(S2, N) -> S2`\n`(S3, any) -> S3`, `(SF, any) -> SF`\n\nD.\n`(S0, A) -> S1`, `(S0, T) -> SF`, `(S0, I) -> SF`, `(S0, N) -> S0`\n`(S1, I) -> S2`, `(S1, T) -> SF`, `(S1, A) -> S1`, `(S1, N) -> S1`\n`(S2, T) -> S3`, `(S2, A) -> S2`, `(S2, I) -> S2`, `(S2, N) -> S2`\n`(S3, any) -> S3`, `(SF, any) -> SF`", "solution": "要解决此问题，我们必须根据问题陈述中提供的规则构建状态转换表。我们将逐一分析每个状态所需的转换。对于状态 `S3` 和 `SF`，`any` 输入条件指的是任何可能的输入：`A`、`T`、`I` 或 `N`。\n\n**状态 S0 (初始状态):**\n细胞从 `S0` 开始。第一个正确的输入是阿拉伯糖 (`A`)。\n- 如果输入是 `A`，细胞应转换到 `S1`。因此，`(S0, A) -> S1`。\n- 任何其他诱导剂，`T` 或 `I`，都是不正确的第一个输入。这应使细胞进入失败状态 `SF`。因此，`(S0, T) -> SF` 和 `(S0, I) -> SF`。\n- 如果没有诱导剂存在（输入 `N`），细胞保持其初始状态。因此，`(S0, N) -> S0`。\n从 `S0` 开始的转换是：`(S0, A) -> S1`, `(S0, T) -> SF`, `(S0, I) -> SF`, `(S0, N) -> S0`。\n\n**状态 S1 (已接收第一个正确输入):**\n细胞在正确处理输入 `A` 后处于状态 `S1`。下一个正确的输入是 aTc (`T`)。\n- 如果输入是 `T`，细胞应转换到 `S2`。因此，`(S1, T) -> S2`。\n- 在此阶段，输入 `I` 是不正确的。这应使细胞进入失败状态 `SF`。因此，`(S1, I) -> SF`。\n- 根据规则，如果细胞重新暴露于先前正确的诱导剂 (`A`) 或如果诱导剂被移除 (`N`)，它应保持其当前状态。因此，`(S1, A) -> S1` 和 `(S1, N) -> S1`。\n从 `S1` 开始的转换是：`(S1, T) -> S2`, `(S1, I) -> SF`, `(S1, A) -> S1`, `(S1, N) -> S1`。\n\n**状态 S2 (已接收第二个正确输入):**\n细胞在正确处理序列 `A` 然后 `T` 后处于状态 `S2`。最后一个正确的输入是 IPTG (`I`)。\n- 如果输入是 `I`，细胞完成序列并转换到解锁状态 `S3`。因此，`(S2, I) -> S3`。\n- 重新暴露于先前正确的诱导剂（`A` 或 `T`）或移除诱导剂（`N`）应使细胞保持其状态。因此，`(S2, A) -> S2`、`(S2, T) -> S2` 和 `(S2, N) -> S2`。请注意，在此序列阶段暴露于 `A` 是一个不正确的输入，但规则规定了在暴露于*先前正确的*诱导剂时保持状态。如果我们严格解释“不正确的诱导剂”，`(S2, A) -> SF` 也将是一个有效的设计，但规则 4 指导我们选择 `(S2, A) -> S2`。让我们基于此重新检查选项。所有接近正确的选项，如 A 和 D，都使用 `(S2, A) -> S2` 和 `(S2, T) -> S2`。这证实了细胞在重新暴露于序列中先前的信号时应“保持”其状态的解释。\n从 `S2` 开始的转换是：`(S2, I) -> S3`, `(S2, A) -> S2`, `(S2, T) -> S2`, `(S2, N) -> S2`。\n\n**状态 S3 (解锁状态):**\n问题陈述 `S3` 是一个“锁存”状态，意味着一旦进入，细胞将无限期地保持在该状态。\n- 因此，对于任何输入（`A`、`T`、`I` 或 `N`），细胞都停留在 `S3` 中。我们可以将其写为 `(S3, any) -> S3`。\n\n**状态 SF (失败状态):**\n问题陈述 `SF` 是一个“不可逆的”失败状态。一旦进入，细胞将无限期地保持在该状态。\n- 因此，对于任何输入（`A`、`T`、`I` 或 `N`），细胞都停留在 `SF` 中。我们可以将其写为 `(SF, any) -> SF`。\n\n**与选项比较：**\n让我们将我们推导出的转换表整理出来，并与给定的选项进行比较。\n- 我们推导出的表：\n    - `(S0, A) -> S1`, `(S0, T) -> SF`, `(S0, I) -> SF`, `(S0, N) -> S0`\n    - `(S1, T) -> S2`, `(S1, I) -> SF`, `(S1, A) -> S1`, `(S1, N) -> S1`\n    - `(S2, I) -> S3`, `(S2, A) -> S2`, `(S2, T) -> S2`, `(S2, N) -> S2`\n    - `(S3, any) -> S3`, `(SF, any) -> SF`\n\n- **选项 A：** 这与我们推导出的表完全匹配。\n- **选项 B：** 此选项在遇到不正确输入 `(S1, I) -> S0` 或移除诱导剂 `(S1, N) -> S0` 时错误地将状态重置为 `S0`，这违反了规则 4 和对永久性失败状态的要求。它还错误地显示失败状态 `SF` 是可逆的 `(SF, N) -> S0`。\n- **选项 C：** 此选项错误地假设任何诱导剂都可以启动序列（`(S0, T) -> S1`, `(S0, I) -> S1`），违反了特定的序列要求。\n- **选项 D：** 此选项在第一步之后有错误的诱导剂序列。它要求 `I` 然后是 `T`（`(S1, I) -> S2` 然后 `(S2, T) -> S3`），这与要求的 `A -> T -> I` 序列相矛盾。\n\n因此，唯一正确模拟指定细胞 FSM 的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "2025697"}, {"introduction": "有限状态机简洁、离散的状态是如何从复杂、连续的生物化学世界中产生的？最后一个练习 [@problem_id:2025679] 通过探索一个作为记忆开关的基因线路来弥合这一差距。你将分析蛋白质生产和降解等连续过程，如何与正反馈回路和临界阈值相结合，从而产生能够区分长短信号的状态机的离散、“全或无”行为。", "problem": "一个合成生物学家团队正在细菌中开发一种细胞有限状态机（FSM），用作记忆电路，以区分瞬时和持续的环境信号。该电路设计用于响应化学诱导剂L-阿拉伯糖（Ara），并由以下遗传部件组成：\n\n1.  **计时蛋白 (TP):** TP的基因受Ara诱导型启动子 `pBAD` 的控制。当培养基中存在Ara时，TP被生产。当Ara被移除时，TP的生产停止，现有的TP以特征寿命 $\\tau_{TP}$ 降解。\n\n2.  **记忆蛋白 (MP):** 该蛋白有两种形式：非活性状态 $\\text{MP}_i$ 和活性状态 $\\text{MP}_a$。$\\text{MP}_i$ 的基因受一个组成型启动子的控制，这意味着 $\\text{MP}_i$ 总是以一个恒定的低速率被生产。\n\n3.  **转换与激活逻辑：**\n    *   计时蛋白TP作为一种酶，将 $\\text{MP}_i$ 转化为 $\\text{MP}_a$。\n    *   活性形式 $\\text{MP}_a$ 是一个转录激活因子。它结合到自身的启动子 `pMP` 上，形成一个正反馈回路。它也结合到报告基因启动子 `pRep` 上。\n    *   需要一个临界阈值浓度的 $\\text{MP}_a$，记为 $[\\text{MP}_a]_{\\text{crit}}$，来稳定地激活 `pMP` 启动子并将系统“锁定”在一个自我维持的状态。一旦锁定，$\\text{MP}_a$ 的生产就不再依赖于TP的存在。\n\n4.  **报告蛋白 (RFP):** 使用一种红色荧光蛋白（RFP）作为输出。其基因由 `pRep` 启动子控制，该启动子被 $\\text{MP}_a$ 激活。只有当 $\\text{MP}_a$ 的浓度达到或超过 $[\\text{MP}_a]_{\\text{crit}}$ 时，才能观察到显著的RFP表达。\n\n系统的特征时间使得持续 $T_{\\text{short}} = 5$ 分钟的Ara“短脉冲”不足以使 $\\text{MP}_a$ 的浓度达到 $[\\text{MP}_a]_{\\text{crit}}$。然而，持续 $T_{\\text{long}} = 60$ 分钟的Ara“长脉冲”足以将 $[\\text{MP}_a]$ 推高到远超 $[\\text{MP}_a]_{\\text{crit}}$ 的水平，并锁定记忆开关。\n\n进行了一项实验，将这些工程菌的培养物（初始不含Ara且无RFP表达）置于以下一系列条件下：\n1.  从 `t = 0` 分钟到 `t = 60` 分钟：将培养物暴露在高浓度的Ara中。\n2.  从 `t = 60` 分钟到 `t = 120` 分钟：将培养物洗涤并转移到不含Ara的培养基中。此持续时间远长于 $\\tau_{TP}$，足以让所有TP降解。\n3.  从 `t = 120` 分钟到 `t = 125` 分钟：再次将培养物暴露在高浓度的Ara中。\n4.  对于 `t > 125` 分钟：将培养物移回不含Ara的培养基中，并进行长时间观察。\n\n根据所描述的遗传电路行为，在实验结束很长时间后（例如，在 `t = 24` 小时），细菌中RFP的表达状态会是怎样？\n\nA. RFP表达将是关闭的，因为最后的阿拉伯糖脉冲是短脉冲。\n\nB. RFP表达将是开启的，因为第一个长脉冲的阿拉伯糖足以永久激活记忆开关。\n\nC. RFP表达在第一个脉冲后会短暂开启，但在间歇期会关闭并保持关闭状态。\n\nD. RFP表达会随着阿拉伯糖的添加和移除而同步地开启和关闭。\n\nE. RFP表达将达到一个中间的稳定水平，该水平低于长脉冲期间达到的最大水平。", "solution": "将输入建模为二元Ara信号，并写出与描述一致的最小动力学。令 $a(t)\\in\\{0,1\\}$ 表示Ara的存在。当 $a(t)=1$ 时，计时蛋白（TP）由 $pBAD$ 产生，并以寿命 $\\tau_{\\mathrm{TP}}$ 降解，因此\n$$\n\\frac{d[\\mathrm{TP}]}{dt}=\\alpha_{\\mathrm{TP}}\\,a(t)-\\delta_{\\mathrm{TP}}[\\mathrm{TP}],\\qquad \\delta_{\\mathrm{TP}}=\\frac{1}{\\tau_{\\mathrm{TP}}}.\n$$\n记忆蛋白活性形式 $[\\mathrm{MP}_{a}]$ 是通过TP依赖性的非活性 $[\\mathrm{MP}_{i}]$ 转换而产生的，并且一旦系统被锁定，则通过一个不需要TP的、MP依赖的正反馈产生。一个最小的粗粒度形式是\n$$\n\\frac{d[\\mathrm{MP}_{i}]}{dt}=\\alpha_{0}+\\alpha_{\\mathrm{fb}}\\,H([\\mathrm{MP}_{a}])-\\gamma_{i}[\\mathrm{MP}_{i}]-k\\,\\![\\mathrm{TP}][\\mathrm{MP}_{i}],\n$$\n$$\n\\frac{d[\\mathrm{MP}_{a}]}{dt}=k\\,\\![\\mathrm{TP}][\\mathrm{MP}_{i}]+\\Phi([\\mathrm{MP}_{a}])-\\gamma_{a}[\\mathrm{MP}_{a}],\n$$\n其中 $H$ 是 $p\\mathrm{MP}$ 启动子的激活函数（例如，希尔函数），而 $\\Phi([\\mathrm{MP}_{a}])$ 捕捉了正反馈一旦启动后，不依赖于TP的 $[\\mathrm{MP}_{a}]$ 的有效生产。该电路被设计成存在一个临界阈值 $[\\mathrm{MP}_{a}]_{\\mathrm{crit}}$，具有以下性质：\n- 如果 $[\\mathrm{MP}_{a}][\\mathrm{MP}_{a}]_{\\mathrm{crit}}$ 且 $[\\mathrm{TP}]=0$，自主动力学会弛豫到一个低的、关闭的固定点，其中 $[\\mathrm{MP}_{a}][\\mathrm{MP}_{a}]_{\\mathrm{crit}}$。\n- 如果 $[\\mathrm{MP}_{a}]\\ge [\\mathrm{MP}_{a}]_{\\mathrm{crit}}$，通过 $p\\mathrm{MP}$ 的正反馈会将系统锁定在一个高的、开启的固定点 $[\\mathrm{MP}_{a}]_{\\mathrm{on}}\\ge [\\mathrm{MP}_{a}]_{\\mathrm{crit}}$，即使在 $[\\mathrm{TP}]=0$ 时也是如此，即 $\\Phi([\\mathrm{MP}_{a}])$ 在没有Ara的情况下维持生产。\n\n报告蛋白RFP由被 $[\\mathrm{MP}_{a}]$ 激活的 $p\\mathrm{Rep}$ 驱动，因此只有当 $[\\mathrm{MP}_{a}]\\ge [\\mathrm{MP}_{a}]_{\\mathrm{crit}}$ 时才会发生显著的RFP表达。\n\n现在我们来分析实验的时间线。最初，在持续时间 $T_{\\mathrm{long}}$ 内 $a(t)=1$，$T_{\\mathrm{long}}$ 的选择使得TP驱动项 $k[\\mathrm{TP}][\\mathrm{MP}_{i}]$ 导致 $[\\mathrm{MP}_{a}]$ 越过阈值：\n$$\n[\\mathrm{MP}_{a}](T_{\\mathrm{long}})\\ge [\\mathrm{MP}_{a}]_{\\mathrm{crit}}.\n$$\n根据设计，这个长脉冲足以超过阈值并启动正反馈；因此，对于 $t\\ge T_{\\mathrm{long}}$，即使TP后来被移除，轨迹也会被吸引到开启的固定点 $[\\mathrm{MP}_{a}]_{\\mathrm{on}}$。\n\n接下来，Ara被移除，持续时间远长于 $\\tau_{\\mathrm{TP}}$，因此从TP的方程来看，\n$$\na(t)=0\\ \\text{for a long interval} \\quad\\Longrightarrow\\quad [\\mathrm{TP}](t)\\to 0.\n$$\n然而，因为在长脉冲结束时 $[\\mathrm{MP}_{a}]\\ge [\\mathrm{MP}_{a}]_{\\mathrm{crit}}$，在 $[\\mathrm{TP}]=0$ 时的自主动力学维持在\n$$\n\\frac{d[\\mathrm{MP}_{a}]}{dt}=\\Phi([\\mathrm{MP}_{a}])-\\gamma_{a}[\\mathrm{MP}_{a}]=0\n$$\n高的、稳定的固定点 $[\\mathrm{MP}_{a}]_{\\mathrm{on}}\\ge [\\mathrm{MP}_{a}]_{\\mathrm{crit}}$。因此，在洗涤期间，记忆保持在锁定的开启状态。\n\n随后一个持续时间为 $T_{\\mathrm{short}}$ 的短Ara脉冲（其中 $T_{\\mathrm{short}}", "answer": "$$\\boxed{B}$$", "id": "2025679"}]}