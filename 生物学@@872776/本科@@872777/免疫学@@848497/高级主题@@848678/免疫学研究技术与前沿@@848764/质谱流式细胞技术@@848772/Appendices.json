{"hands_on_practices": [{"introduction": "在质谱流式实验中，抗体 panel 的设计是决定成败的第一步。这项练习将引导你思考如何为抗体选择合适的金属同位素标签，特别是当你的目标是识别一个非常稀有的细胞群体时。你需要权衡同位素的信号强度和纯度，以最大化信噪比，从而确保微弱的信号不会被背景噪声或来自其他通道的信号溢出所淹没。[@problem_id:2247593]", "problem": "一位研究人员正在设计一项实验，使用飞行时间质谱流式细胞技术 (CyTOF) 来识别人骨髓中一种非常罕见的祖细胞群。这种罕见细胞群的定义是其独特地表达表面标志物 PROX-1，同时 CD34 呈阳性，CD38 呈阴性 (PROX-1+, CD34+, CD38-)。样本中绝大多数细胞是 CD34+ 但 PROX-1- 的祖细胞。\n\n研究人员有三种可用的抗体：抗 PROX-1、抗 CD34 和抗 CD38。为了检测这些抗体，必须将它们与重金属同位素偶联。为每种抗体选择同位素对实验的成功至关重要。可用的纯化金属同位素的特性如下：\n\n- **同位素 X（基于镧）：** 具有 98 的极高相对信号强度和 99.9% 的同位素纯度。\n- **同位素 Y（基于铋）：** 具有 90 的高相对信号强度和 99.8% 的同位素纯度。\n- **同位素 Z（基于镉）：** 具有 99 的极高相对信号强度，但同位素纯度较低，为 94.0%。低同位素纯度会导致信号“溢出”，即信号在相邻的质量通道中被错误检测到。\n\n鉴于目标是明确地识别极其罕见的 PROX-1+ 细胞群，以下哪种抗体-同位素配对策略对本实验是最佳的？\n\nA. 抗 PROX-1 使用同位素 Y，抗 CD34 使用同位素 Z，抗 CD38 使用同位素 X。\n\nB. 抗 CD34 使用同位素 X，抗 PROX-1 使用同位素 Z，抗 CD38 使用同位素 Y。\n\nC. 抗 PROX-1 使用同位素 X，抗 CD34 使用同位素 Z，抗 CD38 使用同位素 Y。\n\nD. 抗 PROX-1 使用同位素 Z，抗 CD34 使用同位素 X，抗 CD38 使用同位素 Y。\n\nE. 抗 CD38 使用同位素 X，抗 CD34 使用同位素 Y，抗 PROX-1 使用同位素 Z。", "solution": "实验的主要目标是准确、灵敏地检测由 PROX-1 表达定义的非常罕见的细胞群。在质谱流式细胞技术中，为抗体组 (panel) 中的抗体分配金属同位素的策略，即所谓的抗体组合设计 (panel design)，对于从背景噪音和人为产物中分辨出罕见细胞群至关重要。\n\n首先，我们来分析这些标志物以及它们所定义的细胞群。CD34 是祖细胞的常见标志物，因此 CD34+ 细胞群数量庞大且丰富。CD38 在此用作阴性筛选的标志物，这意味着我们感兴趣的是缺乏该标志物的细胞。PROX-1 是定义我们感兴趣的特定、罕见细胞群的关键标志物。因此，检测 PROX-1 信号是实验中最关键和最具挑战性的方面。\n\n在检测罕见事件时，有两个因素至关重要：信号强度（灵敏度）和信号特异性（低背景/溢出）。需要强信号来将罕见的阳性细胞与仪器噪音区分开（高灵敏度）。需要高信号特异性来确保检测到的信号确实来自目标标志物，而不是来自另一个更丰富的标志物通道的溢出伪影（高纯度）。\n\n让我们在此背景下评估可用同位素的特性：\n- **同位素 X：** 提供了极高信号强度 (98) 和最高同位素纯度 (99.9%) 的组合。这使其成为需要以最高置信度和最小干扰进行检测的标志物的理想选择。\n- **同位素 Y：** 也是一个极好的选择，具有高信号强度 (90) 和高纯度 (99.8%)。其强度略低于同位素 X。\n- **同位素 Z：** 代表了一种权衡。它具有最高的信号强度 (99)，但其较低的同位素纯度 (94.0%) 意味着它会在相邻的质量通道中引起显著的溢出。如果将此同位素与针对丰富标志物（如 CD34）的抗体配对，其强烈的信号会“溢出”到其他通道中，可能为其他标志物产生假阳性信号。相反，如果一个罕见标志物被放置在被同位素 Z 标记的丰富标志物所占据的通道旁边，溢出可能会污染罕见标志物的通道，从而掩盖真实信号。\n\n最佳策略是将最好的同位素分配给最关键的标志物。在这种情况下，罕见细胞群的标志物 PROX-1 必须以尽可能高的保真度进行检测。因此，抗 PROX-1 抗体应与同位素 X 偶联，因为它具有高灵敏度和极高纯度的最佳组合。这确保了为数不多的 PROX-1+ 细胞能获得一个干净、强烈的信号。\n\n现在，我们必须分配剩余的同位素。抗 CD34 抗体靶向一个非常丰富的细胞群。将同位素 Z（高强度、低纯度）分配给 CD34 是一个合乎逻辑的选择。CD34 的信号将非常明亮，因此尽管会接收到一些溢出信号，它仍然很容易被识别。虽然它会向其他通道产生*向外*的溢出，但这是一个可控的问题，特别是当用于 PROX-1 的最敏感通道受到高纯度的保护时。\n\n最后，剩下的抗体，抗 CD38，可以被分配最后一个同位素，即同位素 Y。同位素 Y 是一个高质量的标签，适用于这个用于阴性圈门的标志物。\n\n让我们根据这个逻辑评估给出的选项：\n- A: 将同位素 Y 分配给抗 PROX-1。这是一个不错的选择，但不是绝对最好的，因为同位素 X 更优。它还将高纯度的同位素 X 分配给了 CD38，而 CD38 并非最关键的标志物。\n- B: 将最好的同位素 (X) 分配给最丰富的标志物 (CD34)，并将对于罕见标志物而言最差的同位素（Z，因其纯度低）分配给抗 PROX-1。这是一个致命的错误，因为来自其他通道的溢出很可能会掩盖罕见的 PROX-1 信号，导致检测失败。\n- C: 将抗 PROX-1 分配给同位素 X（最佳选择），将抗 CD34 分配给同位素 Z（对于丰富标志物是合乎逻辑的选择），并将抗 CD38 分配给同位素 Y（合适）。该策略通过为罕见细胞群的标志物提供最好的标签来正确地优先考虑它，同时将有问题但信号明亮的标签分配给最丰富的标志物，因为在该标志物上其缺点造成的损害较小。\n- D 和 E: 两者都将低纯度的同位素 Z 分配给抗 PROX-1，这对于检测罕见细胞群来说是错误的策略。\n\n因此，最佳策略是选项 C 中描述的策略。", "answer": "$$\\boxed{C}$$", "id": "2247593"}, {"introduction": "精心设计的实验也可能因为简单的操作失误而出错。本练习模拟了一个在样本混合前进行金属标签细胞条形码（barcoding）标记时可能发生的常见移液错误。通过分析最终数据中不符合预期的结果——一个条码通道为空，而另一个通道的细胞数量加倍——你将学习如何像侦探一样倒推出实验过程中究竟发生了什么，这种基于数据的故障排除能力对于任何实验室科学家都至关重要。[@problem_id:2247633]", "problem": "一名研究人员正在使用飞行时间质谱流式细胞术（CyTOF）分析来自四个不同患者样本的免疫细胞群。为了在混合样本进行分析后区分它们，采用了一种称为质量标签细胞条形码的技术。在这个具体方案中，使用了四种独特的基于钯的条形码试剂，每个样本一种。\n\n实验计划如下：\n- 样本 P1 将用试剂 Pd-104 进行条形码标记。\n- 样本 P2 将用试剂 Pd-105 进行条形码标记。\n- 样本 P3 将用试剂 Pd-108 进行条形码标记。\n- 样本 P4 将用试剂 Pd-110 进行条形码标记。\n\n在单独的条形码标记反应后，将四个样本洗涤，然后合并（混合）到一个试管中，用一组金属偶联抗体进行染色，并进行后续的 CyTOF 分析。研究人员预计在数据解析后会看到四个独立的细胞群，每个细胞群对应一种钯条形码，并且含有相似数量的细胞。\n\n然而，在分析数据时，研究人员观察到结果与预期有显著偏差。条形码 Pd-105 的数据通道完全是空的（包含零个细胞事件），而条形码 Pd-110 的通道大约包含预期数量两倍的细胞事件。Pd-104 和 Pd-108 的通道显示了预期的事件数。\n\n假设所有试剂和仪器都功能正常，以下哪一个在混合前添加条形码试剂步骤中发生的单一移液错误，能够完美地解释这个失真的结果？\n\nA. 研究人员忘记向样本 P2 中添加 Pd-105 条形码试剂，并且也忘记将样本 P2 添加到最终的混合管中。\n\nB. 研究人员意外地将 Pd-110 条形码试剂添加到了装有样本 P2 的试管中，而不是正确的 Pd-105 条形码试剂。\n\nC. 在最后的混合步骤中，研究人员忘记添加装有已标记条形码的样本 P2 的试管，并意外地第二次添加了装有已标记条形码的样本 P4 的试管。\n\nD. P2 (Pd-105) 和 P4 (Pd-110) 的条形码试剂被完全交换了；Pd-110 被添加到了 P2 中，而 Pd-105 被添加到了 P4 中。\n\nE. Pd-105 条形码试剂已降解且失效，导致样本 P2 的条形码标记失败。", "solution": "目标是在添加条形码试剂步骤中找出一个单一的移液错误，该错误能够解释观察到的数据：Pd-105 通道中没有细胞，Pd-110 通道中的细胞数量是预期的两倍，而 Pd-104 和 Pd-108 通道中的计数正常。\n\n我们首先确定预期状态与观察状态。\n**预期状态：**\n- 样本 P1 用 Pd-104 进行条形码标记 (P1-104)。\n- 样本 P2 用 Pd-105 进行条形码标记 (P2-105)。\n- 样本 P3 用 Pd-108 进行条形码标记 (P3-108)。\n- 样本 P4 用 Pd-110 进行条形码标记 (P4-110)。\n混合后，仪器应该在 104、105、108 和 110 通道中检测到四个独立的细胞群。\n\n**观察状态：**\n- 通道 104：包含预期数量的细胞（来自 P1）。\n- 通道 105：是空的。\n- 通道 108：包含预期数量的细胞（来自 P3）。\n- 通道 110：包含预期数量两倍的细胞。\n\n**逻辑推导：**\n1.  Pd-105 通道为空意味着没有任何细胞被成功地用 Pd-105 条形码标记。由于样本 P2 被指定使用此条形码，这表明 P2 的条形码标记过程出了问题。\n2.  Pd-110 通道中的细胞计数加倍意味着来自两个不同样本的细胞都被用 Pd-110 条形码标记了。我们知道 P4 按计划应该用 Pd-110 标记。因此，必定有第二个样本也被无意中用 Pd-110 标记了。\n3.  结合这两个推论，最合乎逻辑的结论是，本应接受 Pd-105 条形码的样本 P2，却错误地接受了 Pd-110 条形码。这一个错误就能同时解释为什么 Pd-105 通道是空的，以及为什么 Pd-110 通道的计数是双倍的。\n\n让我们追踪这个假设的错误：\n- P1 用 Pd-104 进行条形码标记（正确）。\n- P2 被错误地用 Pd-110 进行条形码标记（而不是 Pd-105）。\n- P3 用 Pd-108 进行条形码标记（正确）。\n- P4 用 Pd-110 进行条形码标记（正确）。\n\n当这些样本被混合并分析时：\n- Pd-104 通道将包含来自样本 P1 的细胞。\n- Pd-105 通道将是空的，因为没有样本用该试剂标记。\n- Pd-108 通道将包含来自样本 P3 的细胞。\n- Pd-110 通道将同时包含来自样本 P2 和样本 P4 的细胞，导致计数加倍。\n\n这种情况与观察到的数据完全吻合。现在我们来评估给出的选项。\n\n**A. 研究人员忘记向样本 P2 中添加 Pd-105 条形码试剂，并且也忘记将样本 P2 添加到最终的混合管中。**\n这个选项描述了两个独立的错误：一个是遗漏试剂，另一个是遗漏样本。题目规定是*单一*移液错误。因此，这个选项不正确。\n\n**B. 研究人员意外地将 Pd-110 条形码试剂添加到了装有样本 P2 的试管中，而不是正确的 Pd-105 条形码试剂。**\n这描述了一个单一的错误：在标记样本 P2 时用错了试剂瓶（Pd-110）。正如我们上面的逻辑推导所示，这个单一的错误完美地解释了观察到的失真数据的所有方面。这个选项是正确的。\n\n**C. 在最后的混合步骤中，研究人员忘记添加装有已标记条形码的样本 P2 的试管，并意外地第二次添加了装有已标记条形码的样本 P4 的试管。**\n这个选项描述了两个不同的错误：一个是遗漏（忘记 P2），另一个是重复操作（重复添加 P4）。题目规定是*单一*错误。此外，题目明确指出错误发生在“添加条形码试剂步骤”，而不是“最后的混合步骤”。因此，这个选项在两个方面都是不正确的。\n\n**D. P2 (Pd-105) 和 P4 (Pd-110) 的条形码试剂被完全交换了；Pd-110 被添加到了 P2 中，而 Pd-105 被添加到了 P4 中。**\n如果发生了这种交换，最终状态将是：P1-104, P2-110, P3-108, P4-105。所有四种条形码都会出现在最终的混合物中，每种都有正常的细胞计数。唯一的问题是 P2 和 P4 的身份被互换了。这与观察到的空通道和双倍计数通道不符。因此，这个选项不正确。\n\n**E. Pd-105 条形码试剂已降解且失效，导致样本 P2 的条形码标记失败。**\n这可以解释为什么 Pd-105 通道是空的。然而，来自样本 P2 的细胞仍然会存在于最终的混合样本中，只是没有钯条形码。它们不会获得 Pd-110 条形码，并且在分析过程中很可能作为“未标记条形码”或“碎片”被过滤掉。这个错误无法解释为什么 Pd-110 通道的细胞计数会加倍。因此，这个选项不正确。\n\n基于这一步步的分析，选项 B 是唯一能够完全解释所有观察到的差异的单一错误。", "answer": "$$\\boxed{B}$$", "id": "2247633"}, {"introduction": "获取高质量的数据后，最后一步是通过计算分析来识别细胞群，而选择正确的算法与优秀的实验设计同等重要。这个思想实验将挑战你比较两种经典的聚类方法：一种基于质心（如 k-means），另一种基于密度（如 DBSCAN）。通过理解它们在处理一个被弥散大细胞群包围的稀有、紧凑细胞群时的不同表现，你将建立起对算法如何工作的直觉，从而在面对复杂数据时做出更明智的选择。[@problem_id:2247603]", "problem": "在一项使用质谱流式细胞术（CyTOF）的免疫学实验中，研究人员正在分析一份外周血单个核细胞（PBMC）样本，以识别一个罕见的活化T细胞群。为了便于分析，通过关注两个关键表面标志物（标志物X和标志物Y）的表达水平，对高维数据进行了简化。数据集包含1000个细胞，可描述如下：\n\n-   **细胞群A：** 一个由980个“背景”细胞组成的弥散群体，这些细胞大致均匀分布在由坐标$(x, y)$定义的二维标志物空间中，其中$x$和$y$的取值范围均为0到10。\n-   **细胞群B：** 一个由20个“活化”细胞组成的罕见、紧凑的群体。该群体中的所有细胞都位于一个半径为$R_B = 0.2$、中心坐标为$(5, 5)$的小圆形区域内。\n\n考虑使用两种不同的算法来通过计算将细胞群B识别为一个独立的簇。\n\n1.  **k-均值聚类（k-means Clustering）：** 一种基于质心的算法，它将数据划分成预先指定数量（$k$）的簇。该算法迭代地将每个数据点分配给最近的质心（均值）所在的簇，然后重新计算每个质心的位置，使其成为分配给该簇的所有点的均值。对于本问题，算法以$k=2$个质心进行初始化，分别为位于$(2, 8)$的$C_1$和位于$(5, 4.8)$的$C_2$。如果算法收敛后，其中一个最终簇包含来自细胞群B的所有20个细胞，并且包含来自细胞群A的细胞不超过20个，则认为该簇“分离”出了细胞群B。\n\n2.  **DBSCAN（基于密度的带噪声应用空间聚类）：** 一种基于密度的算法，它将紧密排列的点组合在一起，并将位于低密度区域的孤立点标记为噪声。该算法由两个参数定义：`epsilon` ($\\epsilon$)，即一个点周围的邻域半径；以及`minPts`，即形成一个密集区域（核心点）所需的最小点数。对于本问题，参数设置为$\\epsilon = 0.3$和`minPts` = 10。如果细胞群B的所有20个细胞被识别为一个与背景细胞分离的单一簇，则认为该簇“分离”出了细胞群B。\n\n基于这两种算法的原理和细胞群的特性，确定最可能的结果。\n\n以下哪个陈述准确地描述了应用这两种算法的结果？\n\nA. k-均值算法将成功分离细胞群B，但DBSCAN算法将失败。\n\nB. DBSCAN算法将成功分离细胞群B，但k-均值算法将失败。\n\nC. k-均值算法和DBSCAN算法都将成功分离细胞群B。\n\nD. k-均值算法和DBSCAN算法都将无法分离细胞群B。\n\nE. 根据所提供的信息无法确定结果。", "solution": "我们将问题设定形式化。设方形标志物空间为 $S = [0,10]\\times[0,10]$，因此 $|S| = 100$。细胞群A包含980个大致均匀分布在$S$上的点。定义背景空间密度为\n$$\n\\rho_{A} = \\frac{980}{|S|} = \\frac{980}{100} = \\frac{49}{5}.\n$$\n细胞群B包含20个点，这些点位于闭圆盘\n$$\nD = \\{(x,y) : (x-5)^{2} + (y-5)^{2} \\leq R_{B}^{2}\\}, \\quad R_{B} = 0.2.\n$$\n\n对$k=2$的k-均值算法进行分析。该算法通过质心的Voronoi单元对点进行划分。特别地，当$k=2$时，收敛后的决策边界是一条直线（最终质心连线的垂直平分线），每个簇是$S$与一个半平面的交集。任何包含点$(5,5)$的簇，必定是$S$与一个包含中心对称集$S$中心的半平面的交集。对于一个中心对称的凸集，任何一个切割线，如果其对应的半平面包含中心，那么该半平面的面积至少是总面积的一半。因此，包含$(5,5)$的k-均值簇区域的面积至少为\n$$\n\\frac{|S|}{2} = \\frac{100}{2} = 50.\n$$\n因此，分配到包含$(5,5)$的簇中的细胞群A背景点的期望数量至少为\n$$\n\\mathbb{E}[N_{A,\\text{cluster}}] \\geq \\rho_{A} \\cdot 50 = \\frac{49}{5}\\cdot 50 = 490,\n$$\n这远远超过了允许的最多20个背景点的限制。由于细胞群B位于$(5,5)$，任何包含所有20个B细胞的k-均值簇都必须包含$(5,5)$，因此至少会包含大约490个A细胞。因此，在给定的分离标准下，k-均值算法无法分离出细胞群B。\n\n对$\\epsilon = 0.3$、$\\text{minPts} = 10$的DBSCAN算法进行分析。如果一个点的闭合$\\epsilon$-球体内至少包含$\\text{minPts}$个点（根据标准约定，包括其自身），则该点为核心点。对于任何背景点，在距离$\\epsilon$内，背景邻居（包括其自身）的期望数量为\n$$\n\\mathbb{E}[N_{A,\\epsilon}] = \\rho_{A}\\cdot \\pi \\epsilon^{2} = \\frac{49}{5}\\cdot \\pi \\left(\\frac{3}{10}\\right)^{2} = \\frac{441\\pi}{500}.\n$$\n由于 $\\frac{441\\pi}{500}  9$（因此严格小于$\\text{minPts}-1$），仅背景本身不会产生核心点；背景点是噪声，或者最多是边界点，它们不会形成簇，也不会通过核心点链连接成簇。\n\n现在考虑细胞群B。因为 $R_{B} = 0.2$ 且 $\\epsilon = 0.3$，所以$D$中的点相对于$\\epsilon$是紧密排列的。即使在一种极端排列下，即所有20个B点都位于半径为$R_B$的圆周上且等距分布，对于任何这样的点，在距离$\\epsilon$内的B邻居数量至少为\n$$\n2 \\left\\lfloor \\frac{2\\arcsin\\!\\left(\\frac{\\epsilon}{2R_{B}}\\right)}{2\\pi/20} \\right\\rfloor\n= 2 \\left\\lfloor \\frac{20}{\\pi}\\arcsin\\!\\left(\\frac{3}{4}\\right) \\right\\rfloor\n= 2\\cdot 5 = 10,\n$$\n因为在半径为$R_B$的圆上，弦长条件为$2R_{B}\\sin(\\theta/2)\\leq \\epsilon$，所以角邻域的半宽度为$\\theta/2 \\leq \\arcsin(\\epsilon/(2R_{B}))$，而对于20个等距分布的点，角间距为$2\\pi/20$。因此，每个B点在距离$\\epsilon$内至少有10个B邻居，这意味着对于$\\text{minPts} = 10$的设定，每个B点都是一个核心点。在$D$内部更典型（紧凑）的排列中，由于$\\epsilon > R_B$，局部邻居计数会更大，因此将存在多个核心点，并且所有20个点都是密度可达的，从而形成一个单一的DBSCAN簇。\n\n由于在给定的$\\epsilon$和$\\text{minPts}$下，背景点不会形成核心点，所以高密度的B簇不会与低密度的背景合并。因此，DBSCAN将细胞群B识别为一个单一、独立的簇，满足了给定的分离标准。\n\n结论。在给定的标准下，k-均值算法未能分离出细胞群B，而DBSCAN算法在$\\epsilon = 0.3$和$\\text{minPts}=10$的条件下，对于一个中心在$(5,5)$、半径为$0.2$的紧凑群体，则成功分离。", "answer": "$$\\boxed{B}$$", "id": "2247603"}]}