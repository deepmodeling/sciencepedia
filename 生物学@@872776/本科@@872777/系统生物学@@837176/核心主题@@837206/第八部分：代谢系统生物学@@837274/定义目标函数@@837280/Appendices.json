{"hands_on_practices": [{"introduction": "系统生物学的一个核心挑战是根据实验数据校准模型。本练习将展示如何构建一个统一的目标函数——加权平方误差和，它能将来自不同来源（如蛋白质浓度和mRNA水平）的测量数据整合为一个连贯的“拟合优度”得分。计算这个分数是寻找能够最佳解释所观察到的生物学现象的模型参数的第一步。[@problem_id:1427249]", "problem": "一位系统生物学家正在为一个细胞信号通路开发一个数学模型。在这个通路中，一个外部信号触发了一个蛋白质（我们称之为`P`）的磷酸化。该蛋白质的磷酸化形式`pP`，随后作为转录因子，增加一个特定基因`G`的表达。该模型由一组参数$\\theta$描述，旨在预测`pP`的浓度以及来自基因`G`的mRNA随时间的相对丰度。\n\n为了验证模型并找到最佳参数，这位生物学家收集了两种不同类型的实验数据：\n1.  **磷酸化蛋白质组学数据**：`pP`浓度的测量值。\n    -   在时间 $t_1 = 10 \\text{ min}$，测得的`pP`浓度为 $45.2 \\text{ nM}$，测量标准差为 $\\sigma_1 = 3.5 \\text{ nM}$。\n    -   在时间 $t_2 = 20 \\text{ min}$，测得的`pP`浓度为 $88.9 \\text{ nM}$，测量标准差为 $\\sigma_2 = 6.1 \\text{ nM}$。\n2.  **基因表达数据**：使用定量聚合酶链式反应（qPCR）测量的来自基因`G`的mRNA的相对丰度。\n    -   在时间 $t_3 = 60 \\text{ min}$，测得的`G`-mRNA的相对丰度为 $8.2$ 单位，测量标准差为 $\\sigma_3 = 0.7$ 单位。\n\n这位生物学家正在测试一个特定的参数集 $\\theta_0$。使用这组参数，模型给出以下预测：\n-   在 $t_1 = 10 \\text{ min}$ 时预测的`pP`浓度为 $41.8 \\text{ nM}$。\n-   在 $t_2 = 20 \\text{ min}$ 时预测的`pP`浓度为 $95.3 \\text{ nM}$。\n-   在 $t_3 = 60 \\text{ min}$ 时预测的`G`-mRNA相对丰度为 $9.4$ 单位。\n\n为了量化参数集 $\\theta_0$ 对数据的解释程度，您需要计算一个目标函数。计算实验数据与模型预测之间的总加权平方误差和的值。假设遵循标准的统计实践，即每个平方误差项的权重是相应实验测量值方差的倒数。最终答案是一个无量纲的量。将您的最终答案四舍五入到三位有效数字。", "solution": "目标是计算一个目标函数的值，具体来说是加权平方误差和（通常表示为 $\\chi^2$），它量化了在给定参数集下实验测量值与模型预测值之间的差异。\n\n加权平方误差和的通用公式是：\n$$ \\chi^2 = \\sum_{i=1}^{N} w_i (y_i^{\\text{exp}} - y_i^{\\text{model}})^2 $$\n其中 $N$ 是数据点的总数，$y_i^{\\text{exp}}$ 是第 $i$ 个实验测量值，$y_i^{\\text{model}}$ 是相应的模型预测值，而 $w_i$ 是第 $i$ 个数据点的权重。\n\n问题陈述，每个项的权重是相应测量值方差的倒数。方差 $\\sigma_i^2$ 是标准差 $\\sigma_i$ 的平方。因此，权重 $w_i$ 由 $w_i = \\frac{1}{\\sigma_i^2}$ 给出。\n\n将此代入通用公式，得到需要计算的特定目标函数：\n$$ \\chi^2 = \\sum_{i=1}^{N} \\frac{(y_i^{\\text{exp}} - y_i^{\\text{model}})^2}{\\sigma_i^2} $$\n\n我们有三个实验数据点，所以 $N=3$。让我们从问题陈述中确定每个数据点的值。\n\n**数据点 1：在 $t_1 = 10$ min 时的`pP`浓度**\n-   实验测量值：$y_1^{\\text{exp}} = 45.2 \\text{ nM}$\n-   模型预测值：$y_1^{\\text{model}} = 41.8 \\text{ nM}$\n-   标准差：$\\sigma_1 = 3.5 \\text{ nM}$\n\n**数据点 2：在 $t_2 = 20$ min 时的`pP`浓度**\n-   实验测量值：$y_2^{\\text{exp}} = 88.9 \\text{ nM}$\n-   模型预测值：$y_2^{\\text{model}} = 95.3 \\text{ nM}$\n-   标准差：$\\sigma_2 = 6.1 \\text{ nM}$\n\n**数据点 3：在 $t_3 = 60$ min 时的`G`-mRNA丰度**\n-   实验测量值：$y_3^{\\text{exp}} = 8.2 \\text{ 单位}$\n-   模型预测值：$y_3^{\\text{model}} = 9.4 \\text{ 单位}$\n-   标准差：$\\sigma_3 = 0.7 \\text{ 单位}$\n\n现在我们可以计算每个数据点对总 $\\chi^2$ 值的贡献。\n\n**第 1 项：**\n$$ \\frac{(y_1^{\\text{exp}} - y_1^{\\text{model}})^2}{\\sigma_1^2} = \\frac{(45.2 - 41.8)^2}{(3.5)^2} = \\frac{(3.4)^2}{12.25} = \\frac{11.56}{12.25} \\approx 0.943673 $$\n\n**第 2 项：**\n$$ \\frac{(y_2^{\\text{exp}} - y_2^{\\text{model}})^2}{\\sigma_2^2} = \\frac{(88.9 - 95.3)^2}{(6.1)^2} = \\frac{(-6.4)^2}{37.21} = \\frac{40.96}{37.21} \\approx 1.099435 $$\n\n**第 3 项：**\n$$ \\frac{(y_3^{\\text{exp}} - y_3^{\\text{model}})^2}{\\sigma_3^2} = \\frac{(8.2 - 9.4)^2}{(0.7)^2} = \\frac{(-1.2)^2}{0.49} = \\frac{1.44}{0.49} \\approx 2.938775 $$\n\n总加权平方误差和是这三项的总和：\n$$ \\chi^2 = 0.943673 + 1.099435 + 2.938775 = 4.981883 $$\n\n问题要求将答案四舍五入到三位有效数字。\n计算出的值为 $4.981883$。前三位有效数字是 4、9 和 8。下一位数字是 1，小于 5，因此我们向下舍入。\n\n因此，最终答案是 $4.98$。", "answer": "$$\\boxed{4.98}$$", "id": "1427249"}, {"introduction": "流平衡分析（FBA）是预测代谢通量的强大工具，但它需要一个明确的目标。本练习将引导您完成定义最常见目标——细胞生长——的基本过程，该目标由“生物质目标函数”表示。您将学习如何将实验测量的细胞组分数据转化为一个精确的化学计量方程，以供模型进行优化。[@problem_id:2038523]", "problem": "在合成生物学领域，流平衡分析（Flux Balance Analysis, FBA）是一种强大的计算方法，用于预测生物体基因组尺度模型中的代谢流分布。FBA 的一个关键组成部分是“生物质目标函数”，这是一个伪反应，代表了合成所有细胞组分以产生1克干重（gDW）所需的化学计量。\n\n考虑一种假设的微生物 *Artificium aedificator*，为了建模目的，其生物质已被简化。该生物体的干重由三类大分子组成：结构蛋白（Structurin, S）、能量蛋白（Energin, E）和信息蛋白（Informatin, I）。其1克干重的组成如下：\n- 0.600 克结构蛋白 (S)\n- 0.300 克能量蛋白 (E)\n- 0.100 克信息蛋白 (I)\n\n这些大分子由三种前体代谢物合成：一种通用氨基酸（Amino Acid, AA）、一种通用核苷酸（Nucleotide, NT）和一种通用脂肪酸（Fatty Acid, FA）。大分子的合成反应由以下化学计量式给出：\n- 结构蛋白的合成：$8 \\text{ AA} + 2 \\text{ FA} \\longrightarrow 1 \\text{ S}$\n- 能量蛋白的合成：$10 \\text{ FA} \\longrightarrow 1 \\text{ E}$\n- 信息蛋白的合成：$12 \\text{ NT} \\longrightarrow 1 \\text{ I}$\n\n前体和大分子的摩尔质量已确定为：\n- AA的摩尔质量：$0.110 \\text{ g/mmol}$\n- NT的摩尔质量：$0.330 \\text{ g/mmol}$\n- FA的摩尔质量：$0.280 \\text{ g/mmol}$\n- S的摩尔质量：$1.440 \\text{ g/mmol}$\n- E的摩尔质量：$2.800 \\text{ g/mmol}$\n- I的摩尔质量：$3.960 \\text{ g/mmol}$\n\n下列哪个化学计量方程正确表示了产生1克干重（gDW）*A. aedificator* 的生物质目标函数？\n\nA. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{40}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nB. $\\frac{24}{5} \\text{ AA} + \\frac{6}{5} \\text{ NT} + \\frac{21}{5} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nC. $8 \\text{ AA} + 12 \\text{ NT} + 12 \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nD. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{92}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$", "solution": "目标：推导AA、NT和FA的生物质目标函数系数（单位：mmol/gDW），使得它们的组合能够精确产生1克干重（gDW）的生物质，该生物质由0.600克S、0.300克E和0.100克I组成，并与大分子合成的化学计量和摩尔质量一致。\n\n1) 使用公式 $n = \\frac{m}{M}$，根据给定的质量（单位：克）和摩尔质量（单位：克/毫摩尔），将大分子的质量分数转换为摩尔数（mmol）：\n$$\nn_{S} = \\frac{0.600}{1.440} = \\frac{600}{1440} = \\frac{5}{12} \\text{ mmol},\\quad\nn_{E} = \\frac{0.300}{2.800} = \\frac{300}{2800} = \\frac{3}{28} \\text{ mmol},\\quad\nn_{I} = \\frac{0.100}{3.960} = \\frac{100}{3960} = \\frac{5}{198} \\text{ mmol}.\n$$\n\n2) 使用合成化学计量计算每1克干重所需的前体量：\n- 结构蛋白：$8\\,\\text{AA} + 2\\,\\text{FA} \\longrightarrow 1\\,\\text{S}$。对于 $n_{S} = \\frac{5}{12}$ mmol 的 S：\n$$\n\\text{来自S的AA}: 8\\,n_{S} = 8 \\cdot \\frac{5}{12} = \\frac{10}{3} \\text{ mmol},\\quad\n\\text{来自S的FA}: 2\\,n_{S} = 2 \\cdot \\frac{5}{12} = \\frac{5}{6} \\text{ mmol}.\n$$\n- 能量蛋白：$10\\,\\text{FA} \\longrightarrow 1\\,\\text{E}$。对于 $n_{E} = \\frac{3}{28}$ mmol 的 E：\n$$\n\\text{来自E的FA}: 10\\,n_{E} = 10 \\cdot \\frac{3}{28} = \\frac{15}{14} \\text{ mmol}.\n$$\n- 信息蛋白：$12\\,\\text{NT} \\longrightarrow 1\\,\\text{I}$。对于 $n_{I} = \\frac{5}{198}$ mmol 的 I：\n$$\n\\text{来自I的NT}: 12\\,n_{I} = 12 \\cdot \\frac{5}{198} = \\frac{60}{198} = \\frac{10}{33} \\text{ mmol}.\n$$\n\n3) 汇总所有大分子对前体的需求：\n$$\nn_{\\text{AA}} = \\frac{10}{3},\\quad\nn_{\\text{NT}} = \\frac{10}{33},\\quad\nn_{\\text{FA}} = \\frac{5}{6} + \\frac{15}{14} = \\frac{35}{42} + \\frac{45}{42} = \\frac{80}{42} = \\frac{40}{21}.\n$$\n\n4) 因此，生物质目标函数（每1克干重）为：\n$$\n\\frac{10}{3}\\,\\text{AA} + \\frac{10}{33}\\,\\text{NT} + \\frac{40}{21}\\,\\text{FA} \\longrightarrow 1\\,\\text{gDW}.\n$$\n\n5) 使用前体摩尔质量 $M_{\\text{AA}} = 0.110$, $M_{\\text{NT}} = 0.330$, $M_{\\text{FA}} = 0.280$ 克/毫摩尔进行质量守恒检查：\n$$\nm_{\\text{AA}} = \\frac{10}{3} \\cdot 0.110 = \\frac{1.1}{3} \\text{ g},\\quad\nm_{\\text{NT}} = \\frac{10}{33} \\cdot 0.330 = \\frac{3.3}{33} = 0.100 \\text{ g},\\quad\nm_{\\text{FA}} = \\frac{40}{21} \\cdot 0.280 = \\frac{11.2}{21} \\text{ g}.\n$$\n求和得到\n$$\n\\frac{1.1}{3} + 0.100 + \\frac{11.2}{21} = 0.366\\overline{6} + 0.100 + 0.533\\overline{3} = 1.000 \\text{ g},\n$$\n确认总质量为正确的1克干重。这与选项A相符。", "answer": "$$\\boxed{A}$$", "id": "2038523"}, {"introduction": "除了静态模型，系统生物学还模拟动态过程，例如生物反应器中的细胞生长。生物过程工程中的一个关键目标是最大化单位时间内的总产量。本问题演示了如何通过对收获速率进行积分来推导总产量的目标函数，而收获速率本身取决于由微分方程描述的种群动态。[@problem_id:1427311]", "problem": "一个生物工程团队正在设计一个优化的分批发酵过程，使用一种基因工程酵母菌株来生产重组蛋白。生物反应器内酵母种群的生长可以用逻辑斯谛动力学模型来描述。\n\n生物量浓度，记为 $X(t)$，单位为克/升 (g/L)，作为时间 $t$ (单位为小时, h) 的函数，由以下微分方程描述：\n$$\n\\frac{dX}{dt} = \\mu X(t) \\left(1 - \\frac{X(t)}{K}\\right)\n$$\n其中 $\\mu$ 是最大比生长速率 (单位为 $h^{-1}$)，$K$ 是生物反应器环境的环境承载能力 (单位为 g/L)。\n\n为了收集蛋白产物，该团队实施了一种连续收获策略。培养物以速率 $H(t)$ 从反应器中移出，该速率与当前的生物量浓度成正比：\n$$\nH(t) = h X(t)\n$$\n此处，$h$ 是恒定的收获努力系数 (单位为 $h^{-1}$)。生物反应器运行一个固定的时间周期 $T$ 小时，起始生物量浓度为 $X(0) = X_0$。\n\n为了进行下一阶段的优化，即找到使总产量最大化的 $h$ 值，团队首先需要一个关于过程结果的数学模型。你的任务是推导这个优化问题的目标函数。具体来说，推导在从 $t=0$ 到 $t=T$ 的整个操作周期内的总收获生物量 $Y$ 的闭式解析表达式。该表达式应为收获努力系数 $h$ 以及已知系统参数 $\\mu, K, T,$ 和 $X_0$ 的函数。在你的推导中，假设生长速率始终超过收获努力，即 $\\mu > h > 0$。", "solution": "生物量进行逻辑斯谛增长，并根据其当前浓度按比例连续收获。因此，反应器内的生物量浓度满足带比例收获的逻辑斯谛增长模型：\n$$\n\\frac{dX}{dt}=\\mu X\\left(1-\\frac{X}{K}\\right)-hX=(\\mu-h)X-\\frac{\\mu}{K}X^{2}.\n$$\n定义正常数 $r\\equiv\\mu-h$ 和 $a\\equiv\\mu/K$。微分方程变为\n$$\n\\frac{dX}{dt}=rX-aX^{2}.\n$$\n分离变量并使用部分分式：\n$$\n\\int\\frac{dX}{X(r-aX)}=\\int dt,\n$$\n$$\n\\frac{1}{X(r-aX)}=\\frac{A}{X}+\\frac{B}{r-aX},\\quad 1=A(r-aX)+BX.\n$$\n匹配系数可得 $Ar=1$ 和 $B=Aa$，因此 $A=\\frac{1}{r}$ 且 $B=\\frac{a}{r}$。于是，\n$$\n\\int\\left(\\frac{1}{r}\\frac{1}{X}+\\frac{a}{r}\\frac{1}{r-aX}\\right)dX=\\int dt,\n$$\n$$\n\\frac{1}{r}\\ln X-\\frac{1}{r}\\ln(r-aX)=t+C,\n$$\n其中使用了 $\\int\\frac{1}{r-aX}\\,dX=-\\frac{1}{a}\\ln(r-aX)$。合并对数项并取指数：\n$$\n\\frac{1}{r}\\ln\\!\\left(\\frac{X}{r-aX}\\right)=t+C\\;\\;\\Longrightarrow\\;\\;\\frac{X}{r-aX}=C_{1}\\exp(rt).\n$$\n解出 $X(t)$：\n$$\nX=C_{1}r\\exp(rt)-C_{1}a\\exp(rt)X\\;\\;\\Longrightarrow\\;\\;X\\bigl(1+C_{1}a\\exp(rt)\\bigr)=C_{1}r\\exp(rt),\n$$\n$$\nX(t)=\\frac{C_{1}r\\exp(rt)}{1+C_{1}a\\exp(rt)}=\\frac{r/a}{1+C\\exp(-rt)},\n$$\n其中 $C\\equiv\\frac{1}{C_{1}a}$。代入初始条件 $X(0)=X_{0}$：\n$$\nX_{0}=\\frac{r/a}{1+C}\\;\\;\\Longrightarrow\\;\\;C=\\frac{r}{aX_{0}}-1=\\frac{K_{\\text{eff}}}{X_{0}}-1,\n$$\n其中有效环境承载能力为 $K_{\\text{eff}}\\equiv\\frac{r}{a}=\\frac{(\\mu-h)K}{\\mu}$。因此\n$$\nX(t)=\\frac{K_{\\text{eff}}}{1+\\left(\\frac{K_{\\text{eff}}-X_{0}}{X_{0}}\\right)\\exp(-rt)}.\n$$\n在 $[0,T]$ 上的总收获生物量为\n$$\nY=\\int_{0}^{T}H(t)\\,dt=\\int_{0}^{T}hX(t)\\,dt=h\\frac{r}{a}\\int_{0}^{T}\\frac{dt}{1+C\\exp(-rt)}.\n$$\n通过将 $\\frac{1}{1+C\\exp(-rt)}$ 写为 $\\frac{\\exp(rt)}{\\exp(rt)+C}$ 并进行换元 $y=\\exp(rt)$（于是 $dy=r\\exp(rt)\\,dt$ 且 $dt=\\frac{dy}{ry}$）来计算该积分：\n$$\n\\int_{0}^{T}\\frac{dt}{1+C\\exp(-rt)}=\\int_{0}^{T}\\frac{\\exp(rt)}{\\exp(rt)+C}\\,dt=\\frac{1}{r}\\int_{y=1}^{y=\\exp(rT)}\\frac{1}{y+C}\\,dy\n=\\frac{1}{r}\\left[\\ln(y+C)\\right]_{1}^{\\exp(rT)}=\\frac{1}{r}\\left(\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)\\right).\n$$\n因此，\n$$\nY=h\\frac{r}{a}\\cdot\\frac{1}{r}\\left(\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)\\right)=\\frac{h}{a}\\left(\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)\\right).\n$$\n使用 $a=\\mu/K$，$r=\\mu-h$，以及 $C=\\frac{K_{\\text{eff}}-X_{0}}{X_{0}}$，其中 $K_{\\text{eff}}=\\frac{(\\mu-h)K}{\\mu}$。那么 $1+C=\\frac{K_{\\text{eff}}}{X_{0}}$ 并且\n$$\n\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)=\\ln\\left(\\frac{X_{0}\\exp(rT)+K_{\\text{eff}}-X_{0}}{K_{\\text{eff}}}\\right)\n=\\ln\\left(1+\\frac{X_{0}\\bigl(\\exp(rT)-1\\bigr)}{K_{\\text{eff}}}\\right).\n$$\n代入 $K_{\\text{eff}}=\\frac{rK}{\\mu}$ 和 $a=\\mu/K$ 得到\n$$\nY=\\frac{hK}{\\mu}\\ln\\left(1+\\frac{\\mu X_{0}}{(\\mu-h)K}\\bigl(\\exp\\bigl((\\mu-h)T\\bigr)-1\\bigr)\\right),\n$$\n这就是总收获生物量作为 $h$ 和已知参数的函数的闭式表达式。", "answer": "$$\\boxed{\\frac{hK}{\\mu}\\ln\\!\\left(1+\\frac{\\mu X_{0}}{(\\mu-h)K}\\left(\\exp\\!\\bigl((\\mu-h)T\\bigr)-1\\right)\\right)}$$", "id": "1427311"}]}