{"hands_on_practices": [{"introduction": "本练习将引导你直接应用节俭通量平衡分析（pFBA）方法。通过分析一个包含两条竞争途径的简单假设网络，你将学习应用其核心的两步优化过程：首先最大化生物学目标，然后最小化实现该目标所需的总代谢成本。这项实践 [@problem_id:1456653] 旨在揭示 pFBA 所依据的核心原则——代谢效率。", "problem": "我们正在研究一种假设的微生物，以探究其生产一种有价值的生物质前体的潜力。其简化的核心代谢可由以下这组不可逆反应描述，其中 $S_{ext}$ 是外部底物，A、B 和 C 是内源代谢物：\n- 反应1 ($R_1$)：底物吸收，$S_{ext} \\xrightarrow{v_1} A$\n- 反应2 ($R_2$)：直接转化，$A \\xrightarrow{v_2} B$\n- 反应3 ($R_3$)：替代途径起始，$A \\xrightarrow{v_3} C$\n- 反应4 ($R_4$)：替代途径末端，$C \\xrightarrow{v_4} B$\n- 反应5 ($R_5$)：生物质生产，$B \\xrightarrow{v_5} \\text{Biomass}$\n\n该微生物在稳态下运行。底物 $S_{ext}$ 的吸收是有限的，使得通量 $v_1$ 不能超过 $10.0 \\text{ mmol} \\cdot \\text{gDW}^{-1} \\cdot \\text{h}^{-1}$。所有内部反应也都是不可逆的，这意味着它们的通量不能为负值。\n\n你的任务是应用节俭通量平衡分析 (pFBA)，这是一种首先最大化生物学目标，然后找到实现该最大值所需的最高效通量分布的方法。确定唯一的稳态通量分布向量 $(v_1, v_2, v_3, v_4, v_5)$，该向量既能最大化生物质生产速率 ($v_5$)，又能最小化为达到此最大值所需的所有代谢通量总和。\n\n将你的答案表示为一个由五个通量数值 $(v_1, v_2, v_3, v_4, v_5)$ 组成的行向量，单位为 $\\text{mmol} \\cdot \\text{gDW}^{-1} \\cdot \\text{h}^{-1}$。", "solution": "设通量为 $v_{1},\\dots,v_{5}$，均为不可逆，因此对于所有 $i$ 都有 $v_{i}\\geq 0$，且吸收上限为 $v_{1}\\leq 10$。在稳态下，内源代谢物满足质量平衡：\n- 对于 $A$：$v_{1}-v_{2}-v_{3}=0$。\n- 对于 $C$：$v_{3}-v_{4}=0$。\n- 对于 $B$：$v_{2}+v_{4}-v_{5}=0$。\n\n首先，最大化生物学目标 $v_{5}$。根据平衡方程，消去 $v_{2},v_{4}$：\n$$\nv_{2}=v_{1}-v_{3},\\quad v_{4}=v_{3},\\quad v_{5}=v_{2}+v_{4}=(v_{1}-v_{3})+v_{3}=v_{1}.\n$$\n因此 $v_{5}=v_{1}$。在 $0\\leq v_{1}\\leq 10$ 的条件下，当 $v_{1}=10$ 时达到最大值，得到 $v_{5}^{\\max}=10$。\n\n其次，固定 $v_{5}=10$ 并最小化总通量 $T=\\sum_{i=1}^{5}v_{i}$，约束条件与之前相同（节俭FBA）。在 $v_{1}=10$，$v_{5}=10$，以及 $v_{2}=10-v_{3}$，$v_{4}=v_{3}$ 的条件下，计算\n$$\nT=v_{1}+v_{2}+v_{3}+v_{4}+v_{5}=10+(10-v_{3})+v_{3}+v_{3}+10=30+v_{3}.\n$$\n由于 $v_{3}\\geq 0$，$T$ 的最小值在 $v_{3}=0$ 时取得，得到\n$$\nv_{3}^{*}=0,\\quad v_{2}^{*}=10,\\quad v_{4}^{*}=0,\\quad v_{1}^{*}=10,\\quad v_{5}^{*}=10.\n$$\n该解是唯一的，因为在可行集上，$T=30+v_{3}$ 是关于 $v_{3}$ 严格单调递增的。\n\n因此，唯一的 pFBA 通量向量是 $(v_{1},v_{2},v_{3},v_{4},v_{5})=(10,10,0,0,10)$。", "answer": "$$\\boxed{\\begin{pmatrix}10  10  0  0  10\\end{pmatrix}}$$", "id": "1456653"}, {"introduction": "在掌握基础之后，这个问题引入了一个更真实的、包含可逆反应的代谢网络。你的任务是处理这种新增的复杂性，在这种情况下，细胞可以灵活地选择反应进行的方向。这项实践 [@problem_id:1456660] 将挑战你不仅要决定使用哪条途径，还要学会如何优化可逆反应的通量，以同时满足最大化生长和最小化总代谢投入的目标。", "problem": "一位系统生物学家正在研究一种新型细菌 *Metabolicus efficiens* 的中心代谢。该生物体的主要目标是最大化其生长速率，该速率与一种关键生物质前体 P 的生成速率成正比。次要目标是细胞经济性原则，即以最小的总代谢负荷实现这一最大生长。该负荷可以通过最小化所有代谢通量绝对值之和来建模。这个两步优化过程被称为节俭通量平衡分析 (pFBA)。\n\n简化的代谢网络由以下在伪稳态下运行的反应描述。所有通量 $v_i$ 的单位均为 $\\text{mmol} \\cdot \\text{gDW}^{-1} \\cdot \\text{h}^{-1}$。\n\n*   $v_S$：底物摄取，$S_{ext} \\rightarrow S$。底物摄取受到限制，使得 $0 \\le v_S \\le 10$。\n*   $v_1$：$S \\rightarrow 2A$ (不可逆)\n*   $v_2$：$A \\rightarrow P$ (不可逆)\n*   $v_3$：$S \\rightarrow B$ (不可逆)\n*   $v_4$：$B \\rightarrow P$ (不可逆)\n*   $v_5$：$A \\leftrightarrow B$ (可逆)\n*   $v_{bio}$：生物质生成，$P \\rightarrow \\text{Biomass}$ (不可逆)\n\n通量 $v_{bio}$ 代表生长速率，是需要最大化的主要目标。中间代谢物是 S、A、B 和 P。\n\n首先，确定最大可能的生物质生成速率 $v_{bio, max}$。然后，找到一个特定的通量分布，该分布在实现此最大速率的同时，也最小化所有通量绝对值之总和 $\\sum_{i} |v_i|$，其中求和涵盖了网络中的所有反应 ($v_S, v_1, v_2, v_3, v_4, v_5, v_{bio}$)。\n\n计算这个最小的通量绝对值总和。以 $\\text{mmol} \\cdot \\text{gDW}^{-1} \\cdot \\text{h}^{-1}$ 为单位表示您的答案。", "solution": "设通量为 $v_{S}, v_{1}, v_{2}, v_{3}, v_{4}, v_{5}, v_{bio}$，其约束条件为 $0 \\leq v_{S} \\leq 10$，$v_{1}, v_{2}, v_{3}, v_{4}, v_{bio} \\geq 0$ 以及 $v_{5} \\in \\mathbb{R}$。内部代谢物 $S, A, B, P$ 的伪稳态施加了以下平衡方程：\n$$\n\\text{S:}\\quad v_{S} - v_{1} - v_{3} = 0,\n$$\n$$\n\\text{A:}\\quad 2 v_{1} - v_{2} - v_{5} = 0 \\;\\Rightarrow\\; v_{2} = 2 v_{1} - v_{5},\n$$\n$$\n\\text{B:}\\quad v_{3} + v_{5} - v_{4} = 0 \\;\\Rightarrow\\; v_{4} = v_{3} + v_{5},\n$$\n$$\n\\text{P:}\\quad v_{2} + v_{4} - v_{bio} = 0 \\;\\Rightarrow\\; v_{bio} = v_{2} + v_{4}.\n$$\n\n主要目标 (最大化 $v_{bio}$)：将 $v_{2}$ 和 $v_{4}$ 代入 P 的平衡方程：\n$$\nv_{bio} = (2 v_{1} - v_{5}) + (v_{3} + v_{5}) = 2 v_{1} + v_{3}.\n$$\n根据 S 的平衡方程，$v_{S} = v_{1} + v_{3}$。对于固定的 $v_{S}$，\n$$\nv_{bio} = 2 v_{1} + v_{3} = (v_{1} + v_{3}) + v_{1} = v_{S} + v_{1},\n$$\n当取 $v_{1} = v_{S}$ 和 $v_{3} = 0$ (满足 $v_{1}, v_{3} \\geq 0$) 时，该值最大化。由于 $v_{S} \\leq 10$，最大摄取率为 $v_{S} = 10$，得到\n$$\nv_{1} = 10,\\quad v_{3} = 0,\\quad v_{bio, \\max} = 2 v_{1} + v_{3} = 20.\n$$\n\n次要目标 (在 $v_{bio} = 20$ 的条件下最小化 $\\sum_{i} |v_{i}|$)：当 $v_{1} = 10, v_{3} = 0$ 时，使用 A 和 B 的平衡方程得到\n$$\nv_{2} = 2 v_{1} - v_{5} = 20 - v_{5},\\quad v_{4} = v_{3} + v_{5} = v_{5}.\n$$\n不可逆性要求 $v_{2} \\geq 0$ 和 $v_{4} \\geq 0$，因此 $0 \\leq v_{5} \\leq 20$。同时，$v_{bio} = v_{2} + v_{4} = 20$ 自动成立。\n\n通量绝对值之总和为\n$$\nJ(v_{5}) = |v_{S}| + |v_{1}| + |v_{2}| + |v_{3}| + |v_{4}| + |v_{5}| + |v_{bio}|.\n$$\n对于 $0 \\leq v_{5} \\leq 20$，所有这些通量都是非负的，因此可以去掉绝对值符号：\n$$\nJ(v_{5}) = 10 + 10 + (20 - v_{5}) + 0 + v_{5} + v_{5} + 20 = 60 + v_{5}.\n$$\n当 $v_{5} = 0$ 时，此表达式最小化，得到\n$$\nJ_{\\min} = 60.\n$$\n相应的节俭通量分布为 $v_{S} = 10$, $v_{1} = 10$, $v_{2} = 20$, $v_{3} = 0$, $v_{4} = 0$, $v_{5} = 0$, $v_{bio} = 20$，最小的通量绝对值总和为 $60 \\text{ mmol} \\cdot \\text{gDW}^{-1} \\cdot \\text{h}^{-1}$。", "answer": "$$\\boxed{60}$$", "id": "1456660"}, {"introduction": "最后的这项练习将重点从定量计算转向定性推理，这是系统生物学中的一项关键技能。你无需计算一个精确的通量分布，而是需要预测整个系统如何响应环境条件的变化——具体来说，是营养限制。这个思想实验 [@problem_id:1456664] 将加深你对 pFBA 如何模拟细胞适应性以及生长与资源效率之间基本权衡的理解。", "problem": "一位系统生物学家正在使用一个计算模型来研究一种假设细菌的新陈代谢。该模型基于节俭通量平衡分析（Parsimonious Flux Balance Analysis, pFBA）的原理，这是一种用于预测细胞内代谢反应速率（通量）的优化框架。pFBA过程包括两个连续的优化阶段：\n\n1.  **第一阶段（生物质最大化）：** 执行标准的通量平衡分析（FBA），以找到生物质生产的最大可能速率（即“生长速率”），这被视为细胞的主要目标。这是在满足所有化学计量和热力学约束（包括从环境中吸收营养物质的最大速率）的条件下实现的。设此阶段的结果为最优生物质通量 $Z_{opt}$。\n\n2.  **第二阶段（通量最小化）：** 将生物质生产速率固定为第一阶段得到的最优值 $Z_{opt}$。然后，执行第二次优化，以找到一个满足此生长速率的通量分布，同时最小化网络中所有反应通量绝对值之和。这种“节俭”解代表了在给定最优生长速率下代谢效率最高的状态。\n\n该生物学家的初始模拟是在一种生长培养基中进行的，其中主要碳源是葡萄糖，并定义了其最大摄取通量。然后，该生物学家决定通过降低葡萄糖摄取通量的上限来模拟一种胁迫条件，从而有效地模拟一个营养较贫乏的环境。模型的所有其他参数保持不变。\n\n假设在初始模拟中，葡萄糖的摄取是生长的限制因素，那么这一变化对pFBA模拟的两个关键输出会产生什么预期的定性影响？\n\nA. 最优生物质通量将减少，最小化的总通量之和也将减少。\n\nB. 最优生物质通量将减少，最小化的总通量之和将增加。\n\nC. 最优生物质通量将减少，最小化的总通量之和将保持不变。\n\nD. 最优生物质通量将保持不变，最小化的总通量之和将减少。\n\nE. 最优生物质通量将保持不变，最小化的总通量之和也将保持不变。\n\nF. 最优生物质通量将增加，最小化的总通量之和也将增加。", "solution": "设代谢网络由稳态约束 $S v = 0$ 表示，通量边界为 $l \\leq v \\leq u$，生物质生产通量由 $Z = c^{\\top} v$ 给出。将葡萄糖摄取通量表示为 $v_{\\text{glc}}$，其上限为 $u_{\\text{glc}}$。\n\n第一阶段（FBA）求解\n$$\n\\max_{v}\\; c^{\\top} v \\quad \\text{subject to} \\quad S v = 0,\\quad l \\leq v \\leq u.\n$$\n如果在初始最优点葡萄糖摄取是限制性的，那么约束 $v_{\\text{glc}} \\leq u_{\\text{glc}}$ 在最优点是激活的，即 $v_{\\text{glc}} = u_{\\text{glc}}$，并且最优生物质通量满足\n$$\nZ_{\\text{opt}} = c^{\\top} v^{\\star}, \\quad v^{\\star}_{\\text{glc}} = u_{\\text{glc}}.\n$$\n现在将葡萄糖上限降低到一个更小的值 $u_{\\text{glc}}'  u_{\\text{glc}}$，所有其他约束保持不变。这会严格缩小可行域：\n$$\n\\{v: S v = 0,\\; l \\leq v \\leq u,\\; v_{\\text{glc}} \\leq u_{\\text{glc}}'\\} \\subset \\{v: S v = 0,\\; l \\leq v \\leq u,\\; v_{\\text{glc}} \\leq u_{\\text{glc}}\\}.\n$$\n由于目标是在一个更小的可行集上进行最大化，新的最优生物质通量是非增的。因为 $v_{\\text{glc}}$ 是绑定且限制性的，$u_{\\text{glc}}$ 的减少在新的最优点是激活的，所以可行集的减小移除了先前的最大化点，意味着严格的减少：\n$$\nZ_{\\text{opt}}'  Z_{\\text{opt}}.\n$$\n\n然后，第二阶段（pFBA）固定 $c^{\\top} v = Z_{\\text{opt}}'$ 并最小化总通量大小。一个标准的线性规划形式是最小化 $\\sum_{i} (v_{i}^{+} + v_{i}^{-})$，其中 $v = v^{+} - v^{-}$ 且 $v^{+}, v^{-} \\geq 0$，但为了推理，考虑 $\\sum_{i} |v_{i}|$ 就足够了：\n$$\n\\min_{v}\\; \\sum_{i} |v_{i}| \\quad \\text{subject to} \\quad S v = 0,\\; l \\leq v \\leq u',\\; c^{\\top} v = Z_{\\text{opt}}',\n$$\n其中 $u'$ 与 $u$ 的不同仅在于 $u_{\\text{glc}}'  u_{\\text{glc}}$。\n\n设 $v^{\\text{pfba}}$ 是在原始设置下，生物质为 $Z_{\\text{opt}}$ 且葡萄糖边界为 $u_{\\text{glc}}$ 时的pFBA解。定义缩放因子\n$$\n\\alpha \\equiv \\frac{Z_{\\text{opt}}'}{Z_{\\text{opt}}}.\n$$\n在葡萄糖限制、网络和产率不变的情况下，$\\alpha \\in (0,1)$ 并且 $v' \\equiv \\alpha v^{\\text{pfba}}$ 满足：\n- 稳态：$S v' = S(\\alpha v^{\\text{pfba}}) = \\alpha S v^{\\text{pfba}} = 0$。\n- 边界：对于任何具有边界 $l_{i} \\leq v_{i} \\leq u_{i}$ 的组分，通过 $\\alpha \\in (0,1)$ 进行缩放会保持可行性，因为 $v^{\\text{pfba}}$ 是可行的，并且对于可逆通量有 $l_{i} \\leq 0 \\leq u_{i}$，对于不可逆通量有 $0 \\leq l_{i} \\leq v_{i}^{\\text{pfba}} \\leq u_{i}$，这意味着 $0 \\leq \\alpha v_{i}^{\\text{pfba}} \\leq v_{i}^{\\text{pfba}} \\leq u_{i}$。\n- 特别是对于葡萄糖，根据在葡萄糖限制下 $Z_{\\text{opt}}'$ 的构造，有 $(v')_{\\text{glc}} = \\alpha v^{\\text{pfba}}_{\\text{glc}} = \\alpha u_{\\text{glc}} \\leq u_{\\text{glc}}'$。\n- 生物质：$c^{\\top} v' = \\alpha c^{\\top} v^{\\text{pfba}} = \\alpha Z_{\\text{opt}} = Z_{\\text{opt}}'$。\n\n因此，$v'$ 对于新的第二阶段问题是可行的，其目标值为\n$$\n\\sum_{i} |v'_{i}| = \\sum_{i} |\\alpha v^{\\text{pfba}}_{i}| = \\alpha \\sum_{i} |v^{\\text{pfba}}_{i}|.\n$$\n由于 $\\alpha \\in (0,1)$，这提供了一个可行解，其总通量之和严格小于之前的值。因为pFBA最小化这个和，所以新的最小化和不能超过这个可行值，因此相对于原始的最小化和也必须严格减少。\n\n因此：\n- 最优生物质通量减少。\n- 最小化的总通量之和减少。\n\n这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1456664"}]}