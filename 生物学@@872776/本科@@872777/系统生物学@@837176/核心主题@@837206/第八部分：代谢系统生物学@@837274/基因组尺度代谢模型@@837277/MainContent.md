## 引言
基因组尺度[代谢模型](@entry_id:167873)（Genome-scale Metabolic Models, GEMs）是系统生物学中的一个核心工具，它在基因型和细胞表型之间架起了一座定量的桥梁。随着基因组测序成本的急剧下降，我们获得了海量的遗传信息，但这引出了一个关键问题：我们如何利用一个生物体的基因组蓝图来系统性地预测其在特定环境下的生长、生产和适应能力？GEMs正是为了解决这一知识鸿沟而发展起来的。它通过将基因组中编码的代谢功能整合到一个全局的、数学上严谨的网络中，使得对复杂代谢行为的定量预测成为可能。

本文将系统地介绍基因组尺度[代谢模型](@entry_id:167873)的理论与实践。读者将通过以下三个章节，从基础到前沿，全面掌握这一强大工具：
- **原理与机制**：我们将深入探讨构建一个GEM的核心步骤，从[基因-蛋白质-反应关联](@entry_id:273837)（GPR）的建立到[化学计量矩阵](@entry_id:275342)的形成。你将学习到[通量平衡分析](@entry_id:155597)（FBA）背后的数学原理，理解伪[稳态假设](@entry_id:269399)如何简化问题，以及如何通过设定目标函数来预测细胞的最优行为。
- **应用与跨学科连接**：本章将展示GEMs在多个领域的强大应用，包括如何指导代谢工程中的[菌株设计](@entry_id:755492)，如何在医学研究中识别药物靶点，如何整合[多组学](@entry_id:148370)数据以提高模型预测的准确性，以及如何将模型扩展到模拟复杂的[微生物群落](@entry_id:167568)和[宿主-病原体相互作用](@entry_id:271586)。
- **动手实践**：通过一系列精心设计的计算练习，你将有机会亲手应用所学知识，设置模拟环境，分析[基因敲除](@entry_id:145810)的影响，并探索复杂的[遗传相互作用](@entry_id:177731)。

让我们首先进入第一章，深入了解将一个静态的基因组序列转变为一个可预测的动态[代谢模型](@entry_id:167873)的底层原理和机制。

## 原理与机制

在介绍了基因组尺度[代谢模型](@entry_id:167873)（GEMs）的背景和意义之后，本章将深入探讨其构建和分析所依据的核心原理与数学机制。我们将从一个带注释的基因组出发，逐步构建一个可计算的[代谢网络模型](@entry_id:751920)，并阐明如何运用该模型来预测细胞的表型。

### 从基因组到网络：化学计量学表示

构建一个基因组尺度[代谢模型](@entry_id:167873)的起点是生物体的遗传蓝图——其注释完整的基因组。这个过程的第一步，是将基因的[功能预测](@entry_id:176901)转化为一个具体的生化反应列表。[@problem_id:1436029]

#### [基因-蛋白质-反应](@entry_id:261823)（GPR）关联

基因本身不直接参与代谢，而是编码催化代谢反应的蛋白质（即酶）。因此，模型必须包含一种形式化的规则来连接基因与它们所催化或调控的反应。这种连接被称为**[基因-蛋白质-反应](@entry_id:261823)（GPR）关联**。[GPR关联](@entry_id:273837)使用[布尔逻辑](@entry_id:143377)（`AND`, `OR`）来精确描述基因、蛋白质和反应之间的关系。

例如，一个需要多个不同[蛋白质亚基](@entry_id:178628)才能形成的酶复合物，其对应的[GPR规则](@entry_id:274031)会使用`AND`连接编码这些亚基的基因。反之，如果一个反应可以被多种独立的酶（即**[同工酶](@entry_id:171985)**）催化，那么[GPR规则](@entry_id:274031)会使用`OR`来连接编码这些[同工酶](@entry_id:171985)的基因。考虑一个将底物`S`转化为产物`P`的反应`R1`，它可以被由`geneA`编码的`Enzyme-Alpha`或由`geneB`编码的`Enzyme-Beta`独立催化。这种“两者择一即可”的生物学事实，在模型中被翻译为`geneA OR geneB`的[GPR规则](@entry_id:274031)。[@problem_id:1436007] 这个逻辑关联使得模型能够预测基因敲除的后果：如果`geneA`被删除，只要`geneB`仍然功能正常，反应`R1`依然可以进行。

通过系统性地对基因组中的所有代谢相关基因应用这一过程，并借助KEGG或MetaCyc等生化数据库，研究者可以生成一个初步的反应列表，这个列表构成了有机体代谢能力的草图。

#### 化学计量矩阵

获得了反应列表后，下一步是将其组装成一个严谨的数学结构，即**化学计量矩阵**（stoichiometric matrix），通常表示为 $S$。[@problem_id:1436029] 这个矩阵是所有基于约束的[代谢模型](@entry_id:167873)的核心。

按照惯例，矩阵 $S$ 的维度为 $m \times n$，其中 $m$ 代表模型中**内部代谢物**的数量，而 $n$ 代表**反应**（或通量）的数量。矩阵中的每个元素 $S_{ij}$ 表示代谢物 $i$ 在反应 $j$ 中的[化学计量系数](@entry_id:204082)。我们遵循一个标准约定：反应物（被消耗的物质）的系数为负，而产物（被生成的物质）的系数为正。如果一个代谢物不参与某个反应，其对应的系数则为零。

为了更具体地理解这一点，让我们考虑一个简单的[代谢网络](@entry_id:166711) [@problem_id:1436053]：
1.  **R1:** $A + B \rightarrow C$
2.  **R2:** $C \rightarrow D + E$
3.  **R3:** $D \rightarrow A$
4.  **R4:** $B_{ext} \rightarrow B$ （从环境中吸收B）
5.  **R5:** $E \rightarrow E_{ext}$ （向环境中分泌E）

在这个网络中，带有下标`ext`的物质（$B_{ext}$ 和 $E_{ext}$）被视为**外部代谢物**，它们代表[系统与环境](@entry_id:142270)的接口，不作为矩阵的行。而 $A, B, C, D, E$ 则是**内部代谢物**。因此，我们有 $m = 5$ 种内部代谢物。模型中共有 $n = 5$ 个反应。所以，这个网络的[化学计量矩阵](@entry_id:275342) $S$ 是一个 $5 \times 5$ 的矩阵。

如果我们以 $(A, B, C, D, E)$ 的顺序列出代谢物（行），以 $(R1, R2, R3, R4, R5)$ 的顺序列出反应（列），矩阵 $S$ 的第一列（代表反应R1: $A + B \rightarrow C$）将会是：
$$
\begin{pmatrix} -1 \\ -1 \\ 1 \\ 0 \\ 0 \end{pmatrix}
$$
这表示反应R1每发生一次，就会消耗1个单位的A和1个单位的B，同时生成1个单位的C。通过为网络中的每个反应构建这样一个列向量，我们便可完整地构建出整个化学计量矩阵 $S$。

### 支配性原则：伪[稳态假设](@entry_id:269399)

构建了化学计量矩阵 $S$ 后，我们需要一个支配性原则来描述网络在特定时间点的行为。代谢网络中每个反应的速率，或称为**通量**（flux），可以用一个向量 $v$ 来表示，其中 $v_j$ 是反应 $j$ 的净速率。代谢物浓度向量 $[M]$ 的动态变化可以用以下[微分方程](@entry_id:264184)描述：
$$
\frac{d[M]}{dt} = S \cdot v
$$
这个方程表明，每种代谢物浓度的变化率是所有产生它的反应通量之和减去所有消耗它的反应通量之和。

然而，求解这个复杂的[非线性动力学](@entry_id:190195)系统通常是不可行的。幸运的是，我们可以引入一个强大且在生物学上合理的简化，即**伪[稳态假设](@entry_id:269399)**（pseudo-steady state assumption）。该假设基于一个观察：细胞内大多数小分子代谢物的周转速率（秒至分钟级）远快于[细胞生长](@entry_id:175634)和分裂的速率（小时级）。因此，在研究生长等较长时间尺度的表型时，我们可以合理地假设所有**内部代谢物**的浓度保持恒定。[@problem_id:1436045]

这一假设的直接数学推论是，对于任何内部代谢物，其净生产率为零：
$$
\frac{d[M_{internal}]}{dt} = 0
$$
这意味着，对于矩阵 $S$ 中对应于内部代谢物的每一行，以下方程都成立：
$$
(S \cdot v)_i = 0
$$
将所有内部代谢物的[方程组](@entry_id:193238)合起来，我们就得到了约束[代谢模型](@entry_id:167873)的核心方程：
$$
S \cdot v = 0
$$
这个简单的线性方程组极大地简化了问题。它将一个动态问题转化为一个代数约束问题，定义了一个在伪[稳态](@entry_id:182458)下所有可能的通量[分布](@entry_id:182848)所构成的可行空间。这个方程的含义是，在任何时刻，每一种内部代谢物的总生产速率必须精确地等于其总消耗速率。[@problem_id:2496281]

### 定义[系统边界](@entry_id:158917)与能力

方程 $S \cdot v = 0$ 确立了[质量守恒](@entry_id:204015)的约束，但它本身允许无限多的解。为了定义一个在生物学上现实的解空间，我们必须施加额外的约束，这些约束通过设定每个反应通量 $v_j$ 的**上下界**（bounds）来实现，即 $l_j \le v_j \le u_j$。这些**通量界限**（flux bounds）共同编码了[热力学](@entry_id:141121)、酶容量和环境可用 nutrient 等多方面的限制。[@problem_id:2496281]

根据反应在模型中的角色，其在[化学计量矩阵](@entry_id:275342) $S$ 中的表示和其通量界限的设置具有鲜明的特征 [@problem_id:2496352]：

*   **内部反应（Internal Reactions）**：这些是发生在细胞内部的生化转化和区室间转运。由于[质量守恒](@entry_id:204015)，任何一个内部反应都必须至少有一个反应物和一个产物，因此其在 $S$ 矩阵中对应的列至少有两个非零项（一个负值，一个正值）。其界限用于编码反应的**[可逆性](@entry_id:143146)**。对于一个不[可逆反应](@entry_id:202665)，其通量必须为非负值，因此下界 $l_i = 0$。对于可逆反应，通量可以为正也可以为负，因此下界 $l_i  0$。

*   **交换反应（Exchange Reactions）**：这些是模型与外界环境进行物质交换的“伪反应”。它们不遵守质量守恒，因为环境被视为无限大的源或汇。一个交换反应通常只涉及一种**胞外**代谢物，因此其在 $S$ 矩阵中对应的列只有一个非零项。按照惯例，对于胞外代谢物 $M[e]$ 的交换反应 $M[e] \rightarrow \emptyset$，其在 $S$ 矩阵中对应的条目为 $-1$。根据通量的符号：
    *   $v_i  0$ 表示 $M[e]$ 被消耗，代表**分泌**（secretion）到环境中。
    *   $v_i  0$ 表示反应逆向进行，即 $M[e]$ 被生产，代表从环境中**吸收**（uptake）。
    因此，通过设置负的下界（$l_i  0$）来允许吸收，通过设置正的[上界](@entry_id:274738)（$u_i > 0$）来允许分泌。培养基的成分就是通过设定这些交换反应的界限来模拟的。

*   **需求反应和汇反应（Demand and Sink Reactions）**：这些也是伪反应，但它们作用于**胞内**代谢物。它们是重要的建模工具，用于代表代谢物被用于模型未明确包含的生物合成过程，或在模型开发阶段允许某些代谢物被移除。一个典型的需求反应 $M[c] \rightarrow \emptyset$ 在 $S$ 矩阵中也只有一个非零项（$-1$），作为该胞内代谢物的“汇”。

在这些汇反应中，有一个至关重要且特殊的反应，即**生物质反应**（biomass reaction）。这个[合成反应](@entry_id:150159)被设计用来消耗所有已知的细胞前体物质——如氨基酸、[核苷酸](@entry_id:275639)、脂质和辅因子——并按照实验测定的细胞干重组分，以精确的[化学计量](@entry_id:137450)比例将它们组合起来，生成一个单位的“生物质”。在伪[稳态](@entry_id:182458)的约束下，细胞若要生长，必须有净的前体物质合成。生物质反应提供了一个汇，允许这些前体物质被消耗，从而使得净生产成为可能。至关重要的是，这个反应的通量 $v_{biomass}$ 成为了[细胞生长](@entry_id:175634)速率的直接数学代理。[@problem_id:1445675]

### 预测细胞行为：[通量平衡分析](@entry_id:155597)

至此，我们已经定义了一个由约束条件 $S \cdot v = 0$ 和 $l \le v \le u$ 所界定的可行通量[分布](@entry_id:182848)空间。然而，这个空间内仍然存在无数种可能的代谢状态。我们如何从中找出一个最能代表细胞真实行为的解呢？这里我们需要一个**[目标函数](@entry_id:267263)**（objective function）。

对于在营养丰富的环境中快速生长的微生物，一个强有力的进化假设是，自然选择倾向于那些能够最快增殖的个体。[@problem_id:1434450] 更快的生长速率意味着在竞争中能更快地占据资源，从而获得进化优势。基于这一假设，最常用的[目标函数](@entry_id:267263)便是**最大化生物质反应的通量**。

将所有要素整合起来，我们得到了**[通量平衡分析](@entry_id:155597)**（Flux Balance Analysis, FBA）的标准数学形式。FBA 是一个**线性规划**（Linear Programming, LP）问题 [@problem_id:2496281]：
$$
\begin{align*}
\text{最大化} \quad  c^{T}v \\
\text{约束于} \quad  S v = 0 \\
 l \le v \le u
\end{align*}
$$
其中：
*   $v$ 是待求解的通量向量。
*   $S v = 0$ 是伪[稳态](@entry_id:182458)约束。
*   $l \le v \le u$ 是通量界限约束。
*   $c$ 是一个目标向量。为了最大化生长，我们将 $c$ 向量中对应于生物质反应 $v_{biomass}$ 的元素设为1，其余所有元素设为0。这样，目标函数 $c^T v$ 就简化为 $v_{biomass}$。

FBA之所以强大，在于它是一个线性规划问题。这意味着其[目标函数](@entry_id:267263)和所有约束条件都是变量 $v$ 的线性函数。这保证了我们可以使用高效的算法找到全局最优解。这种线性是通过将复杂的酶动力学抽象为简单的通量上下界来实现的，这是一种有效的简化，使得对[全基因组](@entry_id:195052)范围的[复杂网络](@entry_id:261695)进行计算分析成为可能。

### 超越单一解：探索表型景观

标准的FBA计算会返回一个能够实现最大目标值（例如，最大生长速率）的通量[分布](@entry_id:182848)。然而，一个重要的事实是，这个最优解往往**不是唯一的**。可能存在多种甚至无数种不同的内部通量[分布](@entry_id:182848)方式，它们都能达到完全相同的最优目标值。这种现象被称为**替代最优解**（alternative optima）。

为了探索整个最优[解空间](@entry_id:200470)，而不仅仅是找到其中的一个点，我们可以使用**通量变异性分析**（Flux Variability Analysis, FVA）。FVA的工作原理如下：首先，像标准FBA一样计算出最优目标值（例如 $v_{biomass}^{opt}$）。然后，在保持这个最优目标值不变的额外约束下（即 $c^T v = v_{biomass}^{opt}$），对模型中的每一个反应 $v_j$ 分别进行最小化和最大化计算。

通过FVA，我们得到的不是反应 $v_j$ 的单个通量值，而是其在所有替代最优解中可能取值的区间 $[v_j^{min}, v_j^{max}]$。这个区间的大小反映了该反应在维持[最优表型](@entry_id:178127)时的灵活性。

例如，在一个网络中，代谢物`C`可以通过两种[同工酶](@entry_id:171985)催化的反应（`v_essential_1` 和 `v_essential_2`）生成`E`。假设FBA为了最大化生长，需要`C`的总消耗速率为10 mmol/gDW/hr。一个标准的FBA求解器可能会给出一个特解，如 $v_{essential\_1} = 5$ 和 $v_{essential\_2} = 5$。然而，FVA会揭示，在保持最大生长的条件下，`v_essential_1` 的通量实际上可以在 $[0, 10]$ 的整个区间内变化，只要 $v_{essential\_2}$ 相应地调整以确保两者的总和为10即可。[@problem_id:1436021] 这表明网络在该处具有高度的冗余性和灵活性。

### 精炼预测：替代性目标函数

将最大化生物质作为[目标函数](@entry_id:267263)的假设虽然强大，但并非放之四海而皆准。它最适用于描述经过长期进化适应、达到生长最优状态的野生型菌株。但是，当细胞遭遇突然的遗传或环境扰动（例如基因敲除）时，情况可能会有所不同。

在这种情况下，细胞的调控系统可能来不及立即找到新的全局最优点。FBA预测的是扰动后网络理论上的**最大潜力**，这可以被看作是细胞经过长期[适应性进化](@entry_id:176122)后可能达到的状态。然而，细胞在扰动后的**短期生理响应**可能遵循不同的逻辑。

**代谢调整最小化**（Minimization of Metabolic Adjustment, MOMA）是基于这一考虑提出的替代理论。MOMA假设，在扰动发生后，细胞会尽量少地改变其代谢状态，其新的通量[分布](@entry_id:182848)将是与原始野生型通量[分布](@entry_id:182848)**欧几里得距离最近**的一个[可行解](@entry_id:634783)。[@problem_id:1436011]

MOMA的[优化问题](@entry_id:266749)不再是最大化生物质，而是最小化与野生型通量向量 $v_{wt}$ 的二次偏差：
$$
\min_{\mathbf{v} \in \mathcal{F}_{mut}}\,||\mathbf{v}-\mathbf{v}_{wt}||_{2}^{2}
$$
其中 $\mathcal{F}_{mut}$ 是突变体模型的可行通量空间。

MOMA预测的生长速率通常是次优的，即低于FBA所预测的理论最大值。实验观察表明，许多[基因敲除](@entry_id:145810)突变株在短期内的确表现出次优生长。当实验测量到的突变体代谢表型显示出与野生型高度相似的通量模式（除了必要的绕路途径外），并且生长速率显著低于FBA的预测时，MOMA的假设——即系统进行最小化的重新调整——提供了比FBA更准确的解释。[@problem_id:1436011] 这突显了选择与生物学问题相匹配的[目标函数](@entry_id:267263)的重要性，并展示了[代谢建模](@entry_id:273696)如何帮助我们探索不同的生物学假设。