{"hands_on_practices": [{"introduction": "为了大规模分析代谢网络，我们首先需要用标准化的数学格式来表示单个生化反应。本练习将介绍化学计量向量的概念，它是构建定义整个网络的化学计量矩阵 ($S$) 的基本构件[@problem_id:1445968]。掌握将化学方程式转换为向量是应用计算方法解决生物学问题的第一步。", "problem": "在系统生物学中，代谢途径通过化学计量矩阵进行数学表示。该矩阵中的每一列都是一个代表单一反应的向量，其条目对应于所涉及代谢物的化学计量系数。\n\n考虑肌肉细胞中无氧糖酵解的总反应，这是一个提供快速能量的过程。在该途径中，一个葡萄糖分子被无氧转化为两个乳酸分子。这一转化与能量产生相耦合，导致从两个二磷酸腺苷 (ADP) 分子和两个无机磷酸盐 (Pi) 分子净合成两个三磷酸腺苷 (ATP) 分子。\n\n你的任务是确定该总反应的化学计量向量。该向量应按指定顺序列出以下代谢物的系数：\n1. 葡萄糖\n2. ATP\n3. ADP\n4. Pi\n5. 乳酸\n\n请遵循标准惯例，即反应物的化学计量系数为负，产物的化学计量系数为正。将最终答案表示为单一行矩阵。", "solution": "化学计量向量通过为写成标准形式 $\\sum_{i} \\nu_{i} X_{i} = 0$ 的反应中的每种代谢物 $X_{i}$ 分配一个系数 $\\nu_{i}$ 来表示总反应，其中惯例是反应物的系数为负，产物的系数为正。\n\n所述的肌肉细胞中总的无氧糖酵解是：一个葡萄糖分子转化为两个乳酸分子，同时从两个ADP和两个无机磷酸盐(Pi)净合成两个ATP。明确写出该反应，\n$$\\text{葡萄糖} + 2\\,\\text{ADP} + 2\\,\\text{Pi} \\longrightarrow 2\\,\\text{乳酸} + 2\\,\\text{ATP}.$$\n\n应用符号约定：\n- 葡萄糖是反应物，被消耗：系数为-1。\n- ATP是产物，被生成：系数为+2。\n- ADP是反应物，被消耗：系数为-2。\n- Pi是反应物，被消耗：系数为-2。\n- 乳酸是产物，被生成：系数为+2。\n\n将这些系数按指定顺序 [葡萄糖, ATP, ADP, Pi, 乳酸] 排列，得到化学计量行向量\n$$\\begin{pmatrix} -1  2  -2  -2  2 \\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}-1  2  -2  -2  2\\end{pmatrix}}$$", "id": "1445968"}, {"introduction": "代谢建模的一个关键应用是预测细胞生长。为此，我们需要一个“生物质目标函数”，它代表了合成新细胞组分所需的能量和物质成本。本练习将引导你计算合成一个简化生物质所需的ATP成本[@problem_id:1445985]，从而揭示这一概念的内涵，展示如何将生物组分数据转化为一个可量化的优化目标。", "problem": "一种假设的细菌 *Metabolicus simplicius* 因其生产生物质的效率而被研究。其干生物质由多种大分子组成，但为了简化模型，我们只考虑其蛋白质和脂质含量。研究发现，其干生物质按质量计含有 50.0% 的蛋白质和 20.0% 的脂质。\n\n为构建生物质合成模型，做出以下假设：\n1.  所有蛋白质都可由单一重复单体，即氨基酸丙氨酸（Alanine，摩尔质量 $M_{Ala} = 89.09 \\text{ g/mol}$）来表示。\n2.  所有脂质都可由单一重复单体，即脂肪酸棕榈酸（Palmitic Acid，摩尔质量 $M_{PA} = 256.42 \\text{ g/mol}$）来表示。\n3.  从中心代谢前体合成这些单体所需的能量成本（以三磷酸腺苷（ATP）计）为：\n    - 每合成一个丙氨酸分子需要 5 个 ATP 分子。\n    - 每合成一个棕榈酸分子需要 40 个 ATP 分子。\n4.  聚合（将单体组装成大分子）的能量成本为：\n    - 每形成一个肽键（将氨基酸连接成蛋白质）需要 4 个 ATP 分子。\n    - 每将一个棕榈酸分子并入脂质结构需要 2 个 ATP 分子。\n5.  对于所涉及的大聚合物，假设形成蛋白质质量所需的肽键数量等于丙氨酸单体的数量。\n\n基于此模型，计算合成 1.00 克该细菌干生物质所需的 ATP 总摩尔数。将最终答案以“摩尔 ATP/克生物质”为单位表示，并四舍五入至三位有效数字。", "solution": "我们将 1.00 克干生物质建模为含有 0.500 的蛋白质质量分数和 0.200 的脂质质量分数。因此，产生 ATP 需求的质量为\n$$\nm_{\\text{prot}}=0.500 \\text{ g}, \\quad m_{\\text{lip}}=0.200 \\text{ g}.\n$$\n使用给定的单体表示和摩尔质量，相应的单体摩尔数为\n$$\nn_{\\text{Ala}}=\\frac{m_{\\text{prot}}}{M_{\\text{Ala}}}=\\frac{0.500}{89.09} \\text{ mol}, \\qquad\nn_{\\text{PA}}=\\frac{m_{\\text{lip}}}{M_{\\text{PA}}}=\\frac{0.200}{256.42} \\text{ mol}.\n$$\n每个丙氨酸并入蛋白质的 ATP 成本等于单体合成和聚合成本的总和。根据假设，肽键的数量等于丙氨酸单体的数量，因此\n$$\n\\text{ATP per Ala} = 5 + 4 = 9,\n$$\n得到\n$$\nn_{\\text{ATP,prot}} = 9\\,n_{\\text{Ala}} = 9\\left(\\frac{0.500}{89.09}\\right) \\text{ mol}.\n$$\n类似地，对于脂质，每个棕榈酸并入的 ATP 成本等于\n$$\n\\text{ATP per PA} = 40 + 2 = 42,\n$$\n得到\n$$\nn_{\\text{ATP,lip}} = 42\\,n_{\\text{PA}} = 42\\left(\\frac{0.200}{256.42}\\right) \\text{ mol}.\n$$\n合成 1.00 克模型生物质所需的总 ATP 为\n$$\nn_{\\text{ATP,tot}} = n_{\\text{ATP,prot}} + n_{\\text{ATP,lip}} \n= 9\\left(\\frac{0.500}{89.09}\\right) + 42\\left(\\frac{0.200}{256.42}\\right) \\text{ mol}.\n$$\n进行数值计算，\n$$\nn_{\\text{Ala}} \\approx \\frac{0.500}{89.09} \\approx 5.6123\\times 10^{-3} \\text{ mol}, \\quad\nn_{\\text{ATP,prot}} \\approx 9 \\times 5.6123\\times 10^{-3} = 5.05107\\times 10^{-2} \\text{ mol},\n$$\n$$\nn_{\\text{PA}} \\approx \\frac{0.200}{256.42} \\approx 7.7997\\times 10^{-4} \\text{ mol}, \\quad\nn_{\\text{ATP,lip}} \\approx 42 \\times 7.7997\\times 10^{-4} = 3.27587568\\times 10^{-2} \\text{ mol}.\n$$\n因此，\n$$\nn_{\\text{ATP,tot}} \\approx 5.05107\\times 10^{-2} + 3.27587568\\times 10^{-2}\n= 8.32694568\\times 10^{-2} \\text{ mol}.\n$$\n由于这是针对 1.00 克生物质的，结果的单位是“摩尔 ATP/克生物质”。四舍五入至三位有效数字，得到\n$$\n0.0833。\n$$", "answer": "$$\\boxed{0.0833}$$", "id": "1445985"}, {"introduction": "一旦我们定义了代谢网络及其目标，我们就可以使用流平衡分析来预测其在特定约束下的最大能力。本问题模拟了一个细胞膜“泄漏”（leaky）影响ATP产量的真实场景。通过解决这个小型的优化问题[@problem_id:2404803]，你将应用稳态分析 ($Sv=0$) 和流速约束的核心原则来确定系统的代谢能力，从而获得基因组尺度建模背后逻辑的实践经验。", "problem": "一个最小化的、质量平衡的化学计量模型用于量化被动质子扩散（膜的渗漏）对三磷酸腺苷（ATP）生产能力的影响。考虑在内膜外侧（周质/膜间隙）有一个由代谢物 $H_p$ 代表的单一集总质子池。还原当量由一个抽象代谢物 $Red$ 代表。对于所追踪的代谢物，所有通量都必须按照 $S v = 0$ 的意义作稳态处理。定义了以下反应：\n- 还原当量供应：$R_{in}: \\ \\emptyset \\rightarrow Red$，通量为 $v_{in}$，边界为 $0 \\le v_{in} \\le R_{max}$。\n- 电子传递链质子泵：$R_{pump}: \\ Red \\rightarrow \\emptyset + s \\ H_p$，通量为 $v_{pump}$，边界为 $0 \\le v_{pump} \\le U_{pump}$。这里 $s$ 是每消耗单位还原当量所泵送的质子数。\n- ATP合酶：$R_{ATP}: \\ p \\ H_p \\rightarrow \\emptyset$，通量为 $v_{ATP}$，边界为 $v_{ATP} \\ge 0$。这里 $p$ 是每合成一个ATP所需的质子数，$v_{ATP}$ 直接等于ATP的生产速率。\n- 质子渗漏：$R_{leak}: \\ H_p \\rightarrow \\emptyset$，通量 $v_{leak}$ 固定为一个指定的常数 $L$（即 $v_{leak} = L$）。这模拟了消耗质子动势的被动质子扩散。\n\n令决策变量向量为 $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$，其中 $v_{sink} \\ge 0$ 允许任何未使用的还原当量被排出（$Red \\rightarrow \\emptyset$）以满足 $Red$ 的平衡。$Red$ 和 $H_p$ 的稳态质量平衡为：\n- $Red$: $v_{in} - v_{pump} - v_{sink} = 0$。\n- $H_p$: $s \\ v_{pump} - p \\ v_{ATP} - v_{leak} = 0$。\n\n所有通量的单位均为毫摩尔每克干重每小时，即 $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$，所有参数 $R_{max}$、$U_{pump}$、$s$、$p$、$L$ 均为非负实数，其含义如下：\n- $R_{max}$：还原当量供应 $v_{in}$ 的上限。\n- $U_{pump}$：电子传递链泵送通量 $v_{pump}$ 的上限。\n- $s$：每消耗单位 $Red$ 所泵送的质子数。\n- $p$：每合成一个ATP所消耗的质子数。\n- $L$：固定的质子渗漏通量 $v_{leak}$。\n\n任务：对于下面的每一组参数，计算满足上述约束的最大可行ATP生产速率 $v_{ATP}^\\star$。如果不存在稳态解（约束不可行），则返回 $-1.0$。\n\n您必须只使用所述的模型、稳态平衡和边界条件。将每个结果表示为 $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$ 单位的实数，并四舍五入到六位小数。\n\n测试套件（每种情况为 $(R_{max}, U_{pump}, s, p, L)$）：\n1. $(10, 8, 10, 4, 0)$\n2. $(10, 8, 10, 4, 10)$\n3. $(10, 8, 10, 4, 85)$\n4. $(5, 100, 10, 4, 10)$\n5. $(12, 12, 10, 3.67, 0)$\n\n最终输出格式：您的程序应生成单行输出，包含五个结果，形式为逗号分隔的列表并用方括号括起，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 都按要求四舍五入到六位小数。", "solution": "所提出的问题是一个约束优化任务，可以形式化为一个线性规划问题。目标是在一个简化的代谢模型中，确定在满足一系列化学计量和容量约束条件下的最大三磷酸腺苷生产速率 $v_{ATP}$。\n\n该系统由以下变量和约束定义：\n\n**决策变量：** 通量向量为 $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$。\n\n**稳态质量平衡：**\n1. 对于还原当量 $Red$：$v_{in} - v_{pump} - v_{sink} = 0$。\n2. 对于质子 $H_p$：$s \\cdot v_{pump} - p \\cdot v_{ATP} - v_{leak} = 0$。\n\n**通量边界和条件：**\n3. $0 \\le v_{in} \\le R_{max}$\n4. $0 \\le v_{pump} \\le U_{pump}$\n5. $v_{ATP} \\ge 0$\n6. $v_{leak} = L$\n7. $v_{sink} \\ge 0$\n\n任务是最大化目标函数 $f(v) = v_{ATP}$。\n\n我们将通过简化约束系统来解析地解决这个问题。\n\n从平衡(1)和约束(7)，我们推导出 $v_{sink} = v_{in} - v_{pump} \\ge 0$，这意味着一个重要的耦合关系：$v_{in} \\ge v_{pump}$。将此与约束(3)结合，我们发现 $v_{pump} \\le v_{in} \\le R_{max}$，这为泵送通量建立了一个上限：$v_{pump} \\le R_{max}$。\n\n从平衡(2)和条件(6)，我们将 $v_{ATP}$ 表示为 $v_{pump}$ 的函数：\n$p \\cdot v_{ATP} = s \\cdot v_{pump} - v_{leak} = s \\cdot v_{pump} - L$。\n对于一个物理上有意义的问题，ATP合成需要质子动势，参数 $p$（每个ATP所需的质子数）必须严格为正，即 $p > 0$。所有提供的测试用例都满足此条件。在这个必要假设下，我们可以写出：\n$$v_{ATP} = \\frac{s \\cdot v_{pump} - L}{p}$$\n\n目标是最大化 $v_{ATP}$。由于参数 $s$ 和 $p$ 是正常数，最大化 $v_{ATP}$ 等价于最大化通量 $v_{pump}$。因此，问题简化为寻找 $v_{pump}$ 的最大可行值。\n\n让我们整合所有关于 $v_{pump}$ 的约束：\na. 根据约束(4)，$0 \\le v_{pump} \\le U_{pump}$。\nb. 根据从约束(1)、(3)和(7)推导出的结果，$v_{pump} \\le R_{max}$。\nc. 根据约束(5)，$v_{ATP} \\ge 0$，这意味着 $\\frac{s \\cdot v_{pump} - L}{p} \\ge 0$。在 $p>0$ 和 $s>0$（对于功能性泵是如此）的情况下，这简化为 $s \\cdot v_{pump} - L \\ge 0$，即 $v_{pump} \\ge \\frac{L}{s}$。\n\n综合这些， $v_{pump}$ 的可行范围是：\n$$ \\frac{L}{s} \\le v_{pump} \\le \\min(U_{pump}, R_{max}) $$\n\n为了使一个可行的稳态解存在，这个区间必须是非空的。这要求下限小于或等于上限：\n$$ \\frac{L}{s} \\le \\min(U_{pump}, R_{max}) $$\n\n如果这个条件不满足，则约束是矛盾的，使得系统不可行。在这种情况下，不存在稳态解，指定的输出为 $-1.0$。\n\n如果条件满足，则存在一组可行的通量。为了最大化 $v_{pump}$（从而最大化 $v_{ATP}$），我们必须从其可行范围中选择最大值。令此最优通量为 $v_{pump}^\\star$：\n$$ v_{pump}^\\star = \\min(U_{pump}, R_{max}) $$\n这个值代表了通过质子泵的有效最大通量，该通量受到还原当量可用性（受 $R_{max}$ 限制）或泵本身固有能力（受 $U_{pump}$ 限制）的瓶颈制约。\n\n然后，通过将 $v_{pump}^\\star$ 代入推导出的 $v_{ATP}$ 表达式来计算最大ATP生产速率 $v_{ATP}^\\star$：\n$$ v_{ATP}^\\star = \\frac{s \\cdot v_{pump}^\\star - L}{p} = \\frac{s \\cdot \\min(U_{pump}, R_{max}) - L}{p} $$\n这个最终表达式为计算每组参数所需的值提供了一个直接的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum feasible ATP production rate for a series of metabolic models.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (R_max, U_pump, s, p, L)\n    test_cases = [\n        (10, 8, 10, 4, 0),\n        (10, 8, 10, 4, 10),\n        (10, 8, 10, 4, 85),\n        (5, 100, 10, 4, 10),\n        (12, 12, 10, 3.67, 0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_max, U_pump, s, p, L = case\n\n        # The maximum possible flux through the pump is limited by the supply of\n        # reducing equivalents (R_max) and the pump's own capacity (U_pump).\n        v_pump_effective_max = min(R_max, U_pump)\n\n        # For ATP synthesis to be non-negative (v_ATP >= 0), the proton pumping\n        # rate must be sufficient to overcome the passive proton leak (L).\n        # The condition is s * v_pump - L >= 0.\n        # This gives a minimum required v_pump.\n        # We must handle the case s=0 to avoid division by zero.\n        # If s=0 and L>0, the condition can never be met, so it's infeasible.\n        # If s=0 and L=0, the condition becomes 0 >= 0, and v_pump_min_req is 0.\n        if s == 0:\n            if L > 0:\n                # Infeasible if pump doesn't work but there is a leak\n                v_pump_min_req = float('inf')\n            else:\n                # No leak, no pumping needed to overcome it\n                v_pump_min_req = 0.0\n        else:\n            v_pump_min_req = L / s\n\n        # A steady-state solution is feasible only if the maximum possible pump flux\n        # is greater than or equal to the minimum required pump flux.\n        if v_pump_effective_max >= v_pump_min_req:\n            # If feasible, we maximize v_ATP by maximizing v_pump.\n            # The optimal v_pump is its effective maximum value.\n            v_pump_star = v_pump_effective_max\n            \n            # The parameter p must be > 0 for ATP synthesis to be well-defined.\n            # The problem context and test cases imply p > 0.\n            if p > 0:\n                v_atp_star = (s * v_pump_star - L) / p\n            else:\n                # If p=0, ATP can be produced 'for free'.\n                # If s*v_pump_star - L == 0, v_ATP is not constrained.\n                # If s*v_pump_star - L != 0, it's a contradiction.\n                # This case represents a poorly defined model, but we can treat v_ATP as 0\n                # or infeasible. Problem statement implies p > 0.\n                v_atp_star = -1.0 # Fallback for malformed problem not in tests.\n            \n            results.append(v_atp_star)\n        else:\n            # If the constraints cannot be simultaneously satisfied, the system is infeasible.\n            results.append(-1.0)\n    \n    # Format results to six decimal places as specified.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2404803"}]}