{"hands_on_practices": [{"introduction": "为了充分理解瓦茨-斯特罗加茨模型如何生成“小世界”网络，我们首先必须分析其初始状态——规则环形晶格的特性。这个练习将引导你计算该网络的直径，这是衡量其“大小”的一个指标，它揭示了为什么这种高度有序的初始状态本身并不是许多现实世界系统的理想模型。通过一个假设的代谢网络情景，你将亲身体会到在一个纯粹的规则网络中，信息或物质的传播是多么缓慢。[@problem_id:1474578]", "problem": "一个假想微生物的简单代谢网络模型由 $N$ 种不同的代谢物组成，这些代谢物排列成一个环形。连接这些代谢物的酶促反应形成了一种称为规则环形晶格的结构。在这个晶格中，每种代谢物都与其 $K$ 个最近邻进行催化连接，环的每一侧各有 $K/2$ 个邻居。这种结构等价于 Watts-Strogatz 网络的初始状态，其中重连概率为零 ($p=0$)。假设 $K$ 是一个小的偶数。\n\n在代谢物数量非常大（$N \\gg K \\gg 1$）的极限情况下，确定这个代谢网络的大致直径。直径 $D$ 定义为任意两种代谢物之间最长最短路径的长度，其中路径长度是反应步数。请提供一个用 $N$ 和 $K$ 表示的直径的闭式表达式。", "solution": "问题要求计算一个具有 $N$ 个节点和连接度为 $K$ 的规则环形晶格的直径。直径 $D$ 定义为网络中任意两个节点之间的最长最短路径。\n\n首先，我们来理解网络的结构和路径的性质。节点代表代谢物，边代表酶促反应。路径长度是连接两种代谢物的序列中的反应数或边数。我们要寻找任意两种代谢物之间的最短路径，然后在这些最短路径中找到最大值。\n\n由于环形晶格的对称性，从任何一个节点到所有其他节点的最短路径距离集合都是相同的。因此，我们可以通过选择一个源节点（我们将其标记为节点 0）并找到离它“最远”的代谢物来简化问题。到这个最远代谢物的最短路径就是网络的直径。\n\n在一个有 $N$ 个节点的环上，节点 0 与另一个节点 $j$ 之间沿圆周的距离可以顺时针测量（$j$ 步）或逆时针测量（$N-j$ 步）。这两者中较短的一个就是环上距离，由 $m_j = \\min(j, N-j)$ 给出。在这个环上距离意义下最远的节点是大约在环中点的那个节点，即 $j \\approx N/2$。对于这个节点，环上距离是最大的：$m_{\\text{max}} \\approx N/2$。\n\n接下来，我们必须将这个环上距离转换为路径长度（反应数）。每种代谢物都与其 $K$ 个最近邻相连。这意味着在两个方向上都存在到环上距离为 $1, 2, \\dots, K/2$ 的节点的连接。设 $k = K/2$。这意味着在单个反应步中（穿过一条边），我们沿环最多可以“跳跃” $k$ 个位置。\n\n为了找到到达环上距离为 $m$ 的节点的最短路径长度，我们需要找到覆盖距离 $m$ 所需的、最大尺寸为 $k$ 的跳跃的最小次数。这由上取整函数给出，因为即使是很小的剩余距离也需要一个完整的额外步骤。到达环上距离为 $m$ 的节点的最短路径长度 $d$ 是：\n$$d = \\left\\lceil \\frac{m}{k} \\right\\rceil$$\n\n为了找到直径 $D$，我们需要找到到最远节点的路径长度，该节点位于最大环上距离 $m_{\\text{max}} \\approx N/2$ 处。将此代入我们的路径长度公式：\n$$D = \\left\\lceil \\frac{m_{\\text{max}}}{k} \\right\\rceil \\approx \\left\\lceil \\frac{N/2}{k} \\right\\rceil$$\n\n现在，我们代入 $k = K/2$：\n$$D \\approx \\left\\lceil \\frac{N/2}{K/2} \\right\\rceil = \\left\\lceil \\frac{N}{K} \\right\\rceil$$\n\n问题要求在大网络（$N \\gg K$）的极限下的近似表达式。在此极限下，比率 $N/K$ 是一个大数。对于任何大数值 $x$，上取整函数 $\\lceil x \\rceil$ 近似等于 $x$。因此，我们可以将直径近似为：\n$$D \\approx \\frac{N}{K}$$\n\n这个表达式代表了代谢网络的近似直径，也就是将任意起始底物转化为任意最终产物所需的最长的最短反应序列。", "answer": "$$\\boxed{\\frac{N}{K}}$$", "id": "1474578"}, {"introduction": "在了解了规则晶格的“大世界”特性之后，我们现在转向瓦茨-斯特罗加茨模型中驱动变化的核心机制：重连过程。参数 $p$ 控制着引入网络的随机性程度，对网络的最终结构有决定性影响。这个练习旨在通过计算重连边的期望数量，让你对 $p$ 的作用有一个直接而定量的理解，体会它是如何创造出连接网络远端区域的“捷径”的。[@problem_id:1474591]", "problem": "Watts-Strogatz (WS) 模型提供了一个生成具有小世界特性的图的过程，例如短平均路径长度和高聚类系数。该过程从一个规则环形网络开始，并引入一定量的受控随机性。\n\n考虑构建一个具有 $N$ 个节点的 WS 网络。最初，这些节点排列成一个环，每个节点都与其 $K$ 个最近的邻居相连，每侧各有 $K/2$ 个邻居。假设 $N$ 很大，$K$ 是一个偶数，且 $N > K$。\n\n然后应用重连过程如下：对于每个节点 $i$（从 $i=0$ 到 $N-1$），连接它与其 $K/2$ 个顺时针邻居的每条边都被逐一考虑。这些边中的每一条都以概率 $p$ 进行重连。如果一条边 $(i, j)$ 被选中进行重连，它将被一条新边 $(i, m)$ 替换，其中新的目标节点 $m$ 是从所有可能的节点中均匀随机选择的，约束条件是 $m \\neq i$ 且不会创建重复的边 $(i, m)$。这个过程对原始网络中的每条相关边都恰好应用一次。\n\n给定参数 $N$、$K$ 和 $p$，推导在此过程完成后图中重连边的总期望数的闭式解析表达式。", "solution": "在初始的规则环形网络中，无向边的总数是\n$$\nE_{0}=\\frac{N K}{2},\n$$\n因为 $N$ 个节点中的每个节点度为 $K$，并且在对度求和时，每条无向边被计算了两次。\n\n在 WS 重连步骤中，对于每个节点 $i$，只考虑从 $i$ 到其顺时针邻居的 $K/2$ 条边，且每条这样的边都恰好被处理一次。因此，被考虑进行重连的边的总数恰好是\n$$\nM=N \\cdot \\frac{K}{2}=\\frac{N K}{2}.\n$$\n\n对于每条被考虑的边 $e$，定义指示随机变量 $X_{e}$ 为：如果该边被重连，则 $X_{e}=1$，否则 $X_{e}=0$。根据构造规则，每条被考虑的边以概率 $p$ 进行重连，所以 $\\mathbb{E}[X_{e}]=p$。重连边的总数是 $X=\\sum_{e=1}^{M} X_{e}$。根据期望的线性性（这不要求独立性），$\\mathbb{E}[X]=\\sum_{e=1}^{M} \\mathbb{E}[X_{e}]=M p=\\frac{N K p}{2}$。选择新端点 $m$ 的约束只影响新连接的分布，而不影响一条边被选中进行重连的事件，对于每条被考虑的边，该事件的概率仍然为 $p$。因此，重连边总期望数的闭式表达式为 $\\frac{N K p}{2}$。", "answer": "$$\\boxed{\\frac{N K p}{2}}$$", "id": "1474591"}, {"introduction": "最后一个练习将理论带入实践，模拟了计算神经科学家的工作流程。当你面对一个真实的生物网络（如线虫的连接组）时，一个关键任务是检验理论模型是否能描述观测到的数据。这个练习将展示如何通过调整模型参数（邻居数 $k$ 和重连概率 $p$）来拟合经验数据，这是科学建模中的一项核心技能，它连接了抽象模型与真实世界现象之间的鸿沟。[@problem_id:1474603]", "problem": "一个计算神经科学家团队正在分析一种新发现的小型线虫的结构连接组。通过绘制所有突触连接，他们构建了一个包含 $N=2000$ 个神经元的网络。他们的分析揭示了该网络的两个关键宏观特性：每个神经元的平均连接数（平均度）为 $\\langle k \\rangle_{data} = 12.3$，全局聚类系数为 $C_{data} = 0.15$。\n\n该团队决定使用 Watts-Strogatz (WS) 模型来对该连接组进行建模。WS 模型从一个包含 $N$ 个节点的规则环形晶格开始，其中每个节点都与其 $K$ 个最近邻相连（每侧 $K/2$ 个，其中 $K$ 是一个偶数）。然后，每条边以概率 $p$ 重新连接到一个新的、随机选择的节点。\n\n该模型由参数 $N$、$K$ 和 $p$ 定义。研究人员将 $N$ 设置为与神经元数量相匹配。对于参数 $K$，他们选择最接近经验测量的平均度 $\\langle k \\rangle_{data}$ 的偶数，因为最终 WS 网络的平均度约等于 $K$。\n\n为了完成模型，他们需要确定重连概率 $p$。他们假设可以通过将模型的期望聚类系数与经验观测值 $C_{data}$ 相匹配来估计 $p$ 的值。\n\nWS 网络的聚类系数 $C_{WS}(p, K)$ 的近似公式由下式给出：\n$$C_{WS}(p, K) \\approx C_{0}(1-p)^3$$\n其中 $C_{0}$ 是初始规则晶格（当 $p=0$ 时）的聚类系数，由下式给出：\n$$C_{0} = \\frac{3(K-2)}{4(K-1)}$$\n\n假设这种建模方法是有效的，计算出能够再现线虫连接组观测到的聚类系数所需的重连概率 $p$。将最终答案四舍五入到三位有效数字。", "solution": "我们给定一个 Watts-Strogatz 模型，其参数选择为与数据匹配：$N=2000$，且 $K$ 取为最接近观测到的平均度 $\\langle k \\rangle_{data}=12.3$ 的偶数。由于最接近 $12.3$ 的偶数是 $12$，我们设 $K=12$。\n\nWS 模型中的聚类系数近似为\n$$\nC_{WS}(p,K) \\approx C_{0}(1-p)^{3},\n$$\n其中初始规则晶格的聚类系数为\n$$\nC_{0} = \\frac{3(K-2)}{4(K-1)}.\n$$\n对于 $K=12$，\n$$\nC_{0} = \\frac{3(12-2)}{4(12-1)} = \\frac{30}{44} = \\frac{15}{22}.\n$$\n\n通过 $C_{WS}(p,K)=C_{data}$ 将模型与观测到的聚类系数 $C_{data}=0.15$ 相匹配，得到\n$$\nC_{data} = C_{0}(1-p)^{3} \\quad \\Longrightarrow \\quad (1-p)^{3} = \\frac{C_{data}}{C_{0}}.\n$$\n因此，\n$$\n1-p = \\left(\\frac{C_{data}}{C_{0}}\\right)^{\\frac{1}{3}}, \\quad \\text{so} \\quad p = 1 - \\left(\\frac{C_{data}}{C_{0}}\\right)^{\\frac{1}{3}}.\n$$\n\n代入 $C_{data}=0.15=\\frac{3}{20}$ 和 $C_{0}=\\frac{15}{22}$，\n$$\n\\frac{C_{data}}{C_{0}} = \\frac{\\frac{3}{20}}{\\frac{15}{22}} = \\frac{3}{20}\\cdot\\frac{22}{15} = \\frac{66}{300} = \\frac{11}{50}.\n$$\n因此，\n$$\np = 1 - \\left(\\frac{11}{50}\\right)^{\\frac{1}{3}}.\n$$\n对立方根进行数值计算并四舍五入到三位有效数字，得到\n$$\np \\approx 1 - 0.603681 \\approx 0.396.\n$$", "answer": "$$\\boxed{0.396}$$", "id": "1474603"}]}