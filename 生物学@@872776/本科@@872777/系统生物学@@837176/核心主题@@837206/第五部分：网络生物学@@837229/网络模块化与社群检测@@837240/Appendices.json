{"hands_on_practices": [{"introduction": "模块度（Modularity, $Q$）是衡量网络划分为社区（community）优劣程度的关键指标。一个好的社区划分应该具有社区内部连接紧密而社区之间连接稀疏的特点，这对应着较高的 $Q$ 值。本练习将通过计算和比较同一个网络的两种不同划分方案的模块度，让你掌握评估社区结构质量的基本技能 [@problem_id:1452201]。", "problem": "在系统生物学中，网络常被用来模拟生物实体之间的相互作用。一种常见的类型是蛋白质-蛋白质相互作用（PPI）网络，其中节点代表蛋白质，边代表它们之间的物理相互作用。一个关键任务是在这些网络中识别出“社群”或“模块”，它们通常对应于蛋白质复合物或功能通路。特定社群结构（或称为划分）的质量可以通过一个称为模块度（用 $Q$ 表示）的度量来量化。较高的模块度分数表示一个更好的划分，其中社群内部的连接密集，而社群之间的连接稀疏。\n\n考虑一个由8个蛋白质（标记为P1到P8）组成的小型PPI网络。其相互作用（边）如下：\n(P1, P2), (P1, P3), (P2, P3), (P2, P4), (P3, P4), (P4, P5), (P5, P6), (P5, P7), (P6, P7), (P6, P8), (P7, P8).\n\n两种相互竞争的假设提出了将该网络划分为两个功能模块的不同方式。\n- **划分 A**：社群 1 = {P1, P2, P3, P4}，社群 2 = {P5, P6, P7, P8}\n- **划分 B**：社群 1 = {P1, P2, P3}，社群 2 = {P4, P5, P6, P7, P8}\n\n给定划分的模块度 $Q$ 使用以下公式计算：\n$$Q = \\sum_{c=1}^{N_c} \\left[ \\frac{L_c}{m} - \\left( \\frac{D_c}{2m} \\right)^2 \\right]$$\n其中：\n- $N_c$ 是社群的总数。\n- $m$ 是网络中边的总数。\n- $L_c$ 是两端都在社群 $c$ 内部的边的数量。\n- $D_c$ 是社群 $c$ 中所有节点的度之和。（节点的度是连接到该节点的边的数量）。\n\n计算划分A的模块度分数 $Q_A$ 和划分B的模块度分数 $Q_B$。以下哪个选项正确报告了这些值？\n\nA. $Q_A = \\frac{9}{22}$， $Q_B = \\frac{34}{121}$\n\nB. $Q_A = \\frac{34}{121}$， $Q_B = \\frac{9}{22}$\n\nC. $Q_A = \\frac{7}{22}$， $Q_B = \\frac{23}{121}$\n\nD. $Q_A = \\frac{45}{121}$， $Q_B = \\frac{34}{121}$\n\nE. $Q_A = \\frac{9}{22}$， $Q_B = \\frac{9}{22}$", "solution": "我们列举网络并精确计算模块度。\n\n该网络有以下边：\n(P1,P2), (P1,P3), (P2,P3), (P2,P4), (P3,P4), (P4,P5), (P5,P6), (P5,P7), (P6,P7), (P6,P8), (P7,P8),\n因此边的总数是 $m=11$。\n\n节点的度为：\n$\\deg(P1)=2$, $\\deg(P2)=3$, $\\deg(P3)=3$, $\\deg(P4)=3$, $\\deg(P5)=3$, $\\deg(P6)=3$, $\\deg(P7)=3$, $\\deg(P8)=2$,\n它们的和为 $22=2m$，这证实了 $m=11$。\n\n一个划分的模块度为\n$$\nQ=\\sum_{c=1}^{N_{c}}\\left[\\frac{L_{c}}{m}-\\left(\\frac{D_{c}}{2m}\\right)^{2}\\right],\n$$\n其中 $L_{c}$ 是社群 $c$ 内部的边数，而 $D_{c}$ 是社群 $c$ 中节点的度之和。\n\n划分 A：社群 1 $=\\{P1,P2,P3,P4\\}$，社群 2 $=\\{P5,P6,P7,P8\\}$。\n- 对于社群 1，内部边为 $(P1,P2),(P1,P3),(P2,P3),(P2,P4),(P3,P4)$，因此 $L_{1}=5$。度之和为 $D_{1}=\\deg(P1)+\\deg(P2)+\\deg(P3)+\\deg(P4)=2+3+3+3=11$。\n- 对于社群 2，内部边为 $(P5,P6),(P5,P7),(P6,P7),(P6,P8),(P7,P8)$，因此 $L_{2}=5$。度之和为 $D_{2}=\\deg(P5)+\\deg(P6)+\\deg(P7)+\\deg(P8)=3+3+3+2=11$。\n\n因此，\n$$\nQ_{A}=\\left[\\frac{5}{11}-\\left(\\frac{11}{22}\\right)^{2}\\right]+\\left[\\frac{5}{11}-\\left(\\frac{11}{22}\\right)^{2}\\right]\n=2\\left[\\frac{5}{11}-\\frac{1}{4}\\right]\n=2\\left[\\frac{20}{44}-\\frac{11}{44}\\right]\n=2\\cdot\\frac{9}{44}\n=\\frac{9}{22}.\n$$\n\n划分 B：社群 1 $=\\{P1,P2,P3\\}$，社群 2 $=\\{P4,P5,P6,P7,P8\\}$。\n- 对于社群 1，内部边为 $(P1,P2),(P1,P3),(P2,P3)$，因此 $L_{1}=3$。度之和为 $D_{1}=\\deg(P1)+\\deg(P2)+\\deg(P3)=2+3+3=8$。\n- 对于社群 2，内部边为 $(P4,P5),(P5,P6),(P5,P7),(P6,P7),(P6,P8),(P7,P8)$，因此 $L_{2}=6$。度之和为 $D_{2}=\\deg(P4)+\\deg(P5)+\\deg(P6)+\\deg(P7)+\\deg(P8)=3+3+3+3+2=14$。\n\n因此，\n$$\nQ_{B}=\\left[\\frac{3}{11}-\\left(\\frac{8}{22}\\right)^{2}\\right]+\\left[\\frac{6}{11}-\\left(\\frac{14}{22}\\right)^{2}\\right]\n=\\left[\\frac{3}{11}-\\frac{16}{121}\\right]+\\left[\\frac{6}{11}-\\frac{49}{121}\\right]\n=\\left[\\frac{33}{121}-\\frac{16}{121}\\right]+\\left[\\frac{66}{121}-\\frac{49}{121}\\right]\n=\\frac{17}{121}+\\frac{17}{121}\n=\\frac{34}{121}.\n$$\n\n与选项比较，$Q_{A}=\\frac{9}{22}$ 和 $Q_{B}=\\frac{34}{121}$ 对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1452201"}, {"introduction": "在识别出网络中的社区之后，下一步是分析单个节点在网络结构中的角色。参与系数（Participation Coefficient, $P_i$）是一个非常有用的指标，它帮助我们区分主要在自身社区内发挥作用的“省内中心节点”（provincial hubs）和连接不同社区的“连接器中心节点”（connector hubs）。通过本练习，你将学会如何计算参与系数，从而理解一个中心节点在已划分的网络中的功能角色 [@problem_id:1452179]。", "problem": "在系统生物学中，细胞功能通常由相互作用的蛋白质群组执行，这可以建模为蛋白质-蛋白质相互作用（PPI）网络。这些网络通常表现出模块化结构，其中连接紧密的蛋白质形成社区或模块，执行特定的生物学功能。蛋白质的作用可以通过其连接模式来表征。\n\n考虑一个由10种蛋白质组成的小型假设PPI网络：P1、P2、P3、P4、P5、P6、P7、P8、P9 和 P10。一项分析已将该网络划分为两个不同的功能模块：\n-   模块 A：{P1, P2, P3, P4, P5}\n-   模块 B：{P6, P7, P8, P9, P10}\n\n观察到的相互作用被认为是无向的，如下所示：\n-   P1 与 P2、P3、P4、P6、P7 相互作用。\n-   P2 与 P3、P5 相互作用。\n-   P3 与 P4 相互作用。\n-   P4 与 P5 相互作用。\n-   P6 与 P7、P10 相互作用。\n-   P7 与 P8 相互作用。\n-   P8 与 P9 相互作用。\n-   P9 与 P10 相互作用。\n\n为了量化一个蛋白质是主要在其自身模块内相互作用，还是充当不同模块之间的桥梁，可以计算其*参与系数* $P_i$。蛋白质 $i$ 的参与系数由以下公式定义：\n$$P_i = 1 - \\sum_{s=1}^{N_M} \\left( \\frac{k_{is}}{k_i} \\right)^2$$\n其中 $k_i$ 是蛋白质 $i$ 的总相互作用数（其度），$N_M$ 是网络中模块的总数，而 $k_{is}$ 是蛋白质 $i$ 与模块 $s$ 中蛋白质的相互作用数。\n\n蛋白质P1因其相对较高的连接数而成为一个枢纽。为了确定它是一个“区域性”枢纽（主要在其自身模块内相互作用）还是一个“连接性”枢纽（连接不同模块），请计算蛋白质P1的参与系数。\n\n请将您的答案以小数形式给出，并四舍五入到三位有效数字。", "solution": "我们有两个模块，因此设 $N_{M}=2$，模块 $A=\\{P1,P2,P3,P4,P5\\}$ 和模块 $B=\\{P6,P7,P8,P9,P10\\}$。对于蛋白质 $P1$，观察到的相互作用对象是 $P2,P3,P4,P6,P7$，因此其总度为\n$$k_{1}=5.$$\n与模块 $A$ 内的相互作用对象是 $P2,P3,P4$，所以\n$$k_{1A}=3,$$\n与模块 $B$ 的相互作用对象是 $P6,P7$，所以\n$$k_{1B}=2.$$\n使用参与系数的定义\n$$P_{1}=1-\\sum_{s=1}^{N_{M}}\\left(\\frac{k_{1s}}{k_{1}}\\right)^{2}=1-\\left[\\left(\\frac{k_{1A}}{k_{1}}\\right)^{2}+\\left(\\frac{k_{1B}}{k_{1}}\\right)^{2}\\right],$$\n我们代入数值得到\n$$P_{1}=1-\\left[\\left(\\frac{3}{5}\\right)^{2}+\\left(\\frac{2}{5}\\right)^{2}\\right]=1-\\left(\\frac{9}{25}+\\frac{4}{25}\\right)=1-\\frac{13}{25}=\\frac{12}{25}。$$\n转换为小数并四舍五入到三位有效数字，得到 $0.480$。", "answer": "$$\\boxed{0.480}$$", "id": "1452179"}, {"introduction": "评估社区划分固然重要，但我们首先需要方法来*发现*这些社区结构。Girvan-Newman算法是一种经典的社区发现方法，其核心思想是逐步移除连接不同社区的“桥梁”边。本练习将介绍用于识别这些桥梁边的关键指标——边介数中心性（edge betweenness centrality），并通过一个简化采样场景的计算，让你为理解分裂式聚类算法（divisive clustering algorithms）打下基础 [@problem_id:1452189]。", "problem": "在系统生物学中，识别大型生物网络中的关键功能模块是一项基本任务。一种常见的社区检测方法是 Girvan-Newman 算法，该算法通过迭代地移除具有最高“边介数中心性”的边，将网络分解成不同的社区。对于给定的边 $e$，其介数中心性 $C_B(e)$ 定义为，对于所有可能的不同节点对，穿过该边 $e$ 的最短路径数量占总最短路径数量的比例之和：\n$$C_B(e) = \\sum_{s \\neq t} \\frac{\\sigma_{st}(e)}{\\sigma_{st}}$$\n其中 $\\sigma_{st}$ 是节点 $s$ 和 $t$ 之间的最短路径总数，而 $\\sigma_{st}(e)$ 是这些最短路径中穿过边 $e$ 的数量。\n\n对于非常大的网络，例如一个完整的人类蛋白质-蛋白质相互作用（PPI）网络，精确计算 $C_B(e)$ 在计算上是不可行的。一种实用的替代方法是通过对一小部分节点对进行采样来估计中心性。本题探讨的就是这样一种近似方法。\n\n考虑一个由六个蛋白质（标记为 A、B、C、D、E 和 F）组成的小型无权子网络。观察到的相互作用由以下边表示：(A,B)、(A,C)、(B,D)、(C,D)、(D,E) 和 (E,F)。\n\n为了估计边介数，随机抽取了一个包含六个源-目标对的集合：{(A, F), (B, F), (C, F), (A, E), (B, C), (D, F)}。\n\n你的任务是计算边 $e = (\\text{D,E})$ 的**采样边介数**，我们将其定义为*仅*对这组特定的采样对计算的中心性总和。请以单一数字形式给出你的答案。", "solution": "给定一个无权无向图，其边为 (A,B)、(A,C)、(B,D)、(C,D)、(D,E)、(E,F)。对于一条边 $e$，其边介数中心性定义为\n$$C_{B}(e)=\\sum_{s\\neq t}\\frac{\\sigma_{st}(e)}{\\sigma_{st}},$$\n其中 $\\sigma_{st}$ 是节点 $s$ 和 $t$ 之间的最短路径总数，而 $\\sigma_{st}(e)$ 是这些最短路径中穿过 $e$ 的数量。采样边介数将此求和限制在采样的有序源-目标对集合 $S$ 上。对于给定的样本 $S=\\{(A,F),(B,F),(C,F),(A,E),(B,C),(D,F)\\}$ 和边 $e=(D,E)$，我们计算\n$$C_{B}^{S}(D,E)=\\sum_{(s,t)\\in S}\\frac{\\sigma_{st}(D,E)}{\\sigma_{st}}.$$\n\n因为该图是无权的，所以最短路径具有最少的边数。我们对每个采样对进行评估：\n\n对于 $(A,F)$，从 $A$ 到 $F$ 的最短路径长度为 $4$：路径为 $A\\to B\\to D\\to E\\to F$ 或 $A\\to C\\to D\\to E\\to F$。因此 $\\sigma_{AF}=2$，两条路径都包含 $(D,E)$，所以 $\\sigma_{AF}(D,E)=2$，得出 $\\frac{\\sigma_{AF}(D,E)}{\\sigma_{AF}}=1$。\n\n对于 $(B,F)$，唯一的最短路径是 $B\\to D\\to E\\to F$，长度为 $3$，所以 $\\sigma_{BF}=1$ 且它包含 $(D,E)$，因此 $\\frac{\\sigma_{BF}(D,E)}{\\sigma_{BF}}=1$。\n\n对于 $(C,F)$，唯一的最短路径是 $C\\to D\\to E\\to F$，所以 $\\sigma_{CF}=1$ 且它包含 $(D,E)$，因此 $\\frac{\\sigma_{CF}(D,E)}{\\sigma_{CF}}=1$。\n\n对于 $(A,E)$，最短路径长度为 $3$：$A\\to B\\to D\\to E$ 和 $A\\to C\\to D\\to E$。因此 $\\sigma_{AE}=2$，两条路径都包含 $(D,E)$，所以 $\\sigma_{AE}(D,E)=2$，得出 $\\frac{\\sigma_{AE}(D,E)}{\\sigma_{AE}}=1$。\n\n对于 $(B,C)$，最短路径长度为 $2$：$B\\to D\\to C$ 和 $B\\to A\\to C$。两条路径都不使用 $(D,E)$，所以 $\\sigma_{BC}=2$ 且 $\\sigma_{BC}(D,E)=0$，得出 $\\frac{\\sigma_{BC}(D,E)}{\\sigma_{BC}}=0$。\n\n对于 $(D,F)$，唯一的最短路径是 $D\\to E\\to F$，所以 $\\sigma_{DF}=1$ 且它包含 $(D,E)$，因此 $\\frac{\\sigma_{DF}(D,E)}{\\sigma_{DF}}=1$。\n\n将这些贡献相加得出\n$$C_{B}^{S}(D,E)=1+1+1+1+0+1=5.$$", "answer": "$$\\boxed{5}$$", "id": "1452189"}]}