{"hands_on_practices": [{"introduction": "为了对生物网络进行计算分析，我们首先必须将其转化为数学格式。本练习将介绍完成此任务最基本的工具：邻接矩阵。通过为一个简单的信号级联反应构建矩阵，你将直接看到无权图如何仅捕捉连接的存在与否，而加权图如何增添一个关键的定量细节层，例如生化效率 [@problem_id:1477790]。", "problem": "在系统生物学中，蛋白质相互作用网络通常表示为图。考虑一个涉及三种蛋白质P1、P2和P3的简单线性信号级联。在这个级联中，蛋白质P1通过磷酸化激活蛋白质P2，随后，蛋白质P2也通过磷酸化激活蛋白质P3。这三种蛋白质之间没有其他相互作用，例如自激活或反向激活。\n\n我们可以使用两种不同的图表示来对此系统建模：\n\n1.  一个**无权有向图**，其中当且仅当蛋白质$i$激活蛋白质$j$时，存在一条从$i$到$j$的边。\n2.  一个**加权有向图**，其中从蛋白质$i$到蛋白质$j$的边的权重代表了磷酸化事件的生化效率。P1激活P2的效率是$0.85$，P2激活P3的效率是$0.60$。边权重为零表示没有相互作用。\n\n你的任务是确定这两种表示的邻接矩阵。设无权邻接矩阵为$A_U$，加权邻接矩阵为$A_W$。对于这两个矩阵，行和列都应按(P1, P2, P3)的顺序对应于这些蛋白质。在有向图的邻接矩阵中，第$i$行第$j$列的元素代表从节点$i$到节点$j$的连接。\n\n以下哪个选项正确地给出了邻接矩阵对$(A_U, A_W)$？\n\nA. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0.85 & 0 & 0.60 \\\\ 0 & 0.60 & 0 \\end{pmatrix}$\n\nB. $A_U = \\begin{pmatrix} 0 & 0 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0.85 & 0 & 0 \\\\ 0 & 0.60 & 0 \\end{pmatrix}$\n\nC. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0 & 0 & 0.60 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n\nD. $A_U = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0 & 0 & 0.60 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n\nE. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.60 & 0 \\\\ 0 & 0 & 0.85 \\\\ 0 & 0 & 0 \\end{pmatrix}$", "solution": "在节点顺序为$(\\text{P1}, \\text{P2}, \\text{P3})$的有向邻接矩阵中，元素$A_{ij}$表示从节点$i$到节点$j$的一条边。对于无权情况，如果存在从$i$到$j$的激活，则$A_{ij}=1$，否则$A_{ij}=0$。对于加权情况，如果存在从$i$到$j$的激活，$A_{ij}$等于给定的效率值；如果没有相互作用，则$A_{ij}=0$。\n\n该信号级联明确指定了两条有向边：$\\text{P1} \\rightarrow \\text{P2}$ 和 $\\text{P2} \\rightarrow \\text{P3}$，没有其他相互作用。因此，无权邻接矩阵必须在位置$(1,2)$和$(2,3)$处为1，其他位置为0：\n$$\nA_{U}=\\begin{pmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n加权邻接矩阵在相同位置使用给定的效率值，$0.85$表示$\\text{P1} \\rightarrow \\text{P2}$，$0.60$表示$\\text{P2} \\rightarrow \\text{P3}$：\n$$\nA_{W}=\\begin{pmatrix}\n0 & 0.85 & 0 \\\\\n0 & 0 & 0.60 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n与选项比较，这对矩阵与选项C完全匹配。其他选项要么包含了反向或额外的边，要么交换了权重，要么交换了加权和无权矩阵。", "answer": "$$\\boxed{C}$$", "id": "1477790"}, {"introduction": "一旦网络被表示为图，我们就可以提出诸如“信号传播的最有效路径是什么？”之类的问题。本练习探讨了该问题的答案如何完全取决于我们如何定义“有效”。你将比较“最短路径”在无权网络（最少步骤）与加权网络（权重代表时间）中的生物学意义，从而揭示加权图如何为系统动态提供更细致、且往往更真实的视角 [@problem_id:1477754]。", "problem": "一位系统生物学家正在为一个信号转导通路建模，该通路始于细胞表面受体蛋白的激活，终于细胞核内目标转录因子的激活。该通路被表示为一个有向图，其中蛋白质是节点，相互作用（例如，磷酸化事件）是边。这位生物学家考虑了该网络的两种不同模型。\n\n**模型1：无权网络**\n在此模型中，如果已知蛋白质A直接激活蛋白质B，则存在一条从A到B的边。所有边都被同等对待。此网络中两节点间的“最短路径”定义为包含最少边数的路径。\n\n**模型2：加权网络**\n此模型使用与模型1相同的节点和边。然而，每条从蛋白质A到蛋白质B的边都被赋予一个正权重 $w(A, B)$，它表示激活信号从A传播到B所需的平均时间（以毫秒为单位）。此网络中两节点间的“最短路径”定义为其边的权重之和最小的路径。\n\n在这两种模型中，从初始受体到最终转录因子的最短路径最准确的生物学解释是什么？\n\nA. 在无权网络中，它代表具有最少连续蛋白质激活步骤的通路。在加权网络中，它代表允许信号从受体到靶标以最快速度传播的通路。\n\nB. 在无权网络中，它代表允许信号以最快速度传播的通路。在加权网络中，它代表具有最少连续蛋白质激活步骤的通路。\n\nC. 在两种网络中，最短路径都标识了信号传播最节能的路线，因为更少或更快的步骤与更低的三磷酸腺苷（ATP）消耗相关。\n\nD. 在无权网络中，它代表细胞内物理上最紧凑的通路。在加权网络中，它代表对随机蛋白质失活最鲁棒的通路。\n\nE. 在两种网络中，最短路径都标识了从受体到靶标进化上最保守的通路。", "solution": "将模型1的有向图定义为 $G=(V,E)$，其中源（受体）为 $s \\in V$，目标（转录因子）为 $t \\in V$。一条从 $s$ 到 $t$ 的路径 $P$ 可以写作 $P=(v_{0}=s,v_{1},\\dots,v_{k}=t)$，其中边为 $\\left(v_{i-1},v_{i}\\right) \\in E$。在无权网络中，路径的长度是边的数量：\n$$\nL(P)=k.\n$$\n最短路径是在所有 $s \\to t$ 路径中使 $L(P)$ 最小化的路径。从生物学角度看，每条边对应于从一个蛋白质到下一个蛋白质的直接激活事件（例如，磷酸化）。因此，最小化 $L(P)$ 标识了从受体到转录因子具有最少连续蛋白质激活步骤的通路。\n\n对于模型2，使用相同的 $G=(V,E)$，但分配一个正权重函数 $w:E \\to \\mathbb{R}_{>0}$，其中 $w(A,B)$ 是激活信号从 $A$ 传播到 $B$ 的平均时间。一条路径 $P=(v_{0}=s,\\dots,v_{k}=t)$ 的成本（总时间）是\n$$\nC(P)=\\sum_{i=1}^{k} w\\!\\left(v_{i-1},v_{i}\\right).\n$$\n最短路径是在所有 $s \\to t$ 路径中使 $C(P)$ 最小化的路径。由于权重代表传播时间，最小化 $C(P)$ 可以得出从受体到转录因子期望信号传输最快的通路。这不一定会最小化步骤数；一条具有更多但更快的边的路径可能总时间更短。\n\n评估选项：\n- A符合定义：无权最短路径对应于最少的激活步骤；加权最短路径对应于最快的传播（最小总时间）。\n- B颠倒了这些解释，因此是错误的。\n- C引入了能量效率和ATP消耗的概念，这些在图的定义中没有指定或编码；这里的最短路径不一定使能量最小化。\n- D援引了物理紧凑性和鲁棒性，这些不能由边的数量或时间权重来表示；两种解释都不能从定义中得出。\n- E援引了进化保守性，这既不能由边的数量也不能由时间权重来编码。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1477754"}, {"introduction": "除了静态路径，加权图还使我们能够模拟生物系统的动态行为，例如信号传播的速度。在这个高级练习中，你将把信号传导过程建模为随机游走，并计算平均首次通过时间（MFPT）——即信号到达其目标的平均时间。通过比较一个简单的无权模型和一个基于酶动力学速率的更真实的加权模型，你将量化不同的建模假设如何导致对系统性能的预测产生差异 [@problem_id:1477791]。", "problem": "一位系统生物学家正在为一个胞内信号通路开发一个计算模型。该通路可以简化为一个由四个相互作用的蛋白质组成的有向图：一个受体（节点1）、两个中间激酶（节点2和节点3）以及一个目标转录因子（节点4）。信号的流向由以下连接表示：从节点1到节点2和节点3；从节点2到节点3和节点4；以及从节点3到节点2和节点4。\n\n信号传导过程被建模为一个离散时间随机游走，其中一个信号包在时间 $t=0$ 时从受体（节点1）发出。当信号首次到达作为吸收态的转录因子（节点4）时，该过程结束。该生物学家希望比较两种不同的信号传播模型，并量化它们之间的预测分歧。\n\n**模型A（无权）：** 这是一个朴素模型，其中在任何给定节点上的信号以相等的概率转移到其连接的任一下游邻居节点。\n\n**模型B（加权）：** 该模型融入了生物化学动力学。信号从节点 `u` 转移到下游邻居节点 `v` 的概率与节点 `v` 处蛋白质的催化活性成正比。该活性由一个速率常数 $k_v$ 表征。因此，转移概率由 $P_{u \\to v} = k_v / \\sum_{w \\in N(u)} k_w$ 给出，其中 $N(u)$ 是 `u` 的所有下游邻居节点的集合。对于该通路，速率常数给定为：$k_2 = k$，$k_3 = 3k$ 和 $k_4 = 2k$，其中 $k$ 是某个基础速率。\n\n您的任务是分析这两个模型的预测分歧。计算比率 $\\mathcal{R} = \\frac{\\langle T_{1 \\to 4} \\rangle_{\\text{A}}}{\\langle T_{1 \\to 4} \\rangle_{\\text{B}}}$，其中 $\\langle T_{1 \\to 4} \\rangle_{\\text{A}}$ 和 $\\langle T_{1 \\to 4} \\rangle_{\\text{B}}$ 分别是在模型A和模型B下，信号从节点1传播到节点4的平均首次通过时间（MFPT）。请以精确分数的形式给出您的答案。", "solution": "问题要求计算在一个有向图上的随机游走的两种不同模型中，从节点1到节点4的平均首次通过时间（MFPT）的比率。设 $T_i$ 表示从节点 $i$ 开始到达目标节点4的MFPT。根据定义，从目标节点到其自身的MFPT为零，所以 $T_4 = 0$。\n\n对于任何非目标节点 $i$，其MFPT可以表示为1加上从其邻居节点出发的MFPT的加权平均值，权重为转移概率。通用公式为：\n$$T_i = 1 + \\sum_{j \\in N(i)} P_{i \\to j} T_j$$\n其中 $N(i)$ 是节点 $i$ 的下游邻居节点集合，$P_{i \\to j}$ 是从节点 $i$ 转移到节点 $j$ 的概率。\n\n图的结构如下：\n- 节点1的邻居为 $N(1) = \\{2, 3\\}$。\n- 节点2的邻居为 $N(2) = \\{3, 4\\}$。\n- 节点3的邻居为 $N(3) = \\{2, 4\\}$。\n- 节点4是吸收目标。\n\n我们需要求解 $T_1$。为此，我们为 $T_1, T_2, T_3$ 建立一个线性方程组：\n1.  $T_1 = 1 + P_{1 \\to 2} T_2 + P_{1 \\to 3} T_3$\n2.  $T_2 = 1 + P_{2 \\to 3} T_3 + P_{2 \\to 4} T_4 = 1 + P_{2 \\to 3} T_3$ （因为 $T_4=0$）\n3.  $T_3 = 1 + P_{3 \\to 2} T_2 + P_{3 \\to 4} T_4 = 1 + P_{3 \\to 2} T_2$ （因为 $T_4=0$）\n\n现在我们对每个模型求解这个方程组。\n\n**模型A：无权图**\n\n在这个模型中，向邻居节点的转移是等概率的。\n- 从节点1（2个邻居）：$P_{1 \\to 2} = 1/2$，$P_{1 \\to 3} = 1/2$。\n- 从节点2（2个邻居）：$P_{2 \\to 3} = 1/2$，$P_{2 \\to 4} = 1/2$。\n- 从节点3（2个邻居）：$P_{3 \\to 2} = 1/2$，$P_{3 \\to 4} = 1/2$。\n\n将这些概率代入方程组：\n2.  $T_2 = 1 + \\frac{1}{2} T_3$\n3.  $T_3 = 1 + \\frac{1}{2} T_2$\n\n这是一个关于 $T_2$ 和 $T_3$ 的二元线性方程组。我们将方程(3)代入(2)：\n$T_2 = 1 + \\frac{1}{2} \\left(1 + \\frac{1}{2} T_2\\right) = 1 + \\frac{1}{2} + \\frac{1}{4} T_2 = \\frac{3}{2} + \\frac{1}{4} T_2$\n$T_2 - \\frac{1}{4} T_2 = \\frac{3}{2} \\implies \\frac{3}{4} T_2 = \\frac{3}{2} \\implies T_2 = 2$。\n\n现在，我们使用方程(3)求解 $T_3$：\n$T_3 = 1 + \\frac{1}{2}(2) = 1 + 1 = 2$。\n\n最后，我们使用方程(1)计算 $T_1$：\n$T_1 = 1 + \\frac{1}{2} T_2 + \\frac{1}{2} T_3 = 1 + \\frac{1}{2}(2) + \\frac{1}{2}(2) = 1 + 1 + 1 = 3$。\n所以，对于模型A，$\\langle T_{1 \\to 4} \\rangle_{\\text{A}} = 3$。\n\n**模型B：加权图**\n\n转移概率 $P_{u \\to v}$ 与目标节点的速率常数 $k_v$ 成正比。给定 $k_2=k$，$k_3=3k$ 和 $k_4=2k$。\n- 从节点1 ($N(1) = \\{2, 3\\}$)：归一化因子为 $\\sum_{w \\in N(1)} k_w = k_2 + k_3 = k + 3k = 4k$。\n  $P_{1 \\to 2} = \\frac{k_2}{4k} = \\frac{k}{4k} = \\frac{1}{4}$。\n  $P_{1 \\to 3} = \\frac{k_3}{4k} = \\frac{3k}{4k} = \\frac{3}{4}$。\n\n- 从节点2 ($N(2) = \\{3, 4\\}$)：归一化因子为 $\\sum_{w \\in N(2)} k_w = k_3 + k_4 = 3k + 2k = 5k$。\n  $P_{2 \\to 3} = \\frac{k_3}{5k} = \\frac{3k}{5k} = \\frac{3}{5}$。\n  $P_{2 \\to 4} = \\frac{k_4}{5k} = \\frac{2k}{5k} = \\frac{2}{5}$。\n\n- 从节点3 ($N(3) = \\{2, 4\\}$)：归一化因子为 $\\sum_{w \\in N(3)} k_w = k_2 + k_4 = k + 2k = 3k$。\n  $P_{3 \\to 2} = \\frac{k_2}{3k} = \\frac{k}{3k} = \\frac{1}{3}$。\n  $P_{3 \\to 4} = \\frac{k_4}{3k} = \\frac{2k}{3k} = \\frac{2}{3}$。\n\n现在，我们将这些概率代入我们的通用方程组：\n2.  $T_2 = 1 + P_{2 \\to 3} T_3 = 1 + \\frac{3}{5} T_3$\n3.  $T_3 = 1 + P_{3 \\to 2} T_2 = 1 + \\frac{1}{3} T_2$\n\n我们求解这个新的关于 $T_2$ 和 $T_3$ 的方程组。将(3)代入(2)：\n$T_2 = 1 + \\frac{3}{5} \\left(1 + \\frac{1}{3} T_2\\right) = 1 + \\frac{3}{5} + \\frac{1}{5} T_2 = \\frac{8}{5} + \\frac{1}{5} T_2$\n$T_2 - \\frac{1}{5} T_2 = \\frac{8}{5} \\implies \\frac{4}{5} T_2 = \\frac{8}{5} \\implies T_2 = 2$。\n\n使用这个值代入方程(3)来求解 $T_3$：\n$T_3 = 1 + \\frac{1}{3}(2) = 1 + \\frac{2}{3} = \\frac{5}{3}$。\n\n最后，我们使用方程(1)计算模型B的 $T_1$：\n$T_1 = 1 + P_{1 \\to 2} T_2 + P_{1 \\to 3} T_3 = 1 + \\frac{1}{4}(2) + \\frac{3}{4}\\left(\\frac{5}{3}\\right)$\n$T_1 = 1 + \\frac{2}{4} + \\frac{15}{12} = 1 + \\frac{1}{2} + \\frac{5}{4}$\n$T_1 = \\frac{4}{4} + \\frac{2}{4} + \\frac{5}{4} = \\frac{11}{4}$。\n所以，对于模型B，$\\langle T_{1 \\to 4} \\rangle_{\\text{B}} = \\frac{11}{4}$。\n\n**计算比率 $\\mathcal{R}$**\n\n最后一步是计算这两个MFPT的比率：\n$\\mathcal{R} = \\frac{\\langle T_{1 \\to 4} \\rangle_{\\text{A}}}{\\langle T_{1 \\to 4} \\rangle_{\\text{B}}} = \\frac{3}{\\frac{11}{4}} = 3 \\times \\frac{4}{11} = \\frac{12}{11}$。", "answer": "$$\\boxed{\\frac{12}{11}}$$", "id": "1477791"}]}