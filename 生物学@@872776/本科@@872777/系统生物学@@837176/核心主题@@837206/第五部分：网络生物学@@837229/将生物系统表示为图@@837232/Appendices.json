{"hands_on_practices": [{"introduction": "本练习通过一个熟悉的场景——家庭内部的疾病传播，为图论提供了一个直观的切入点。你将学习如何将物理接触的描述转化为一个无向图，并用邻接矩阵来表示它。这项基本技能是分析网络结构如何影响疾病传播等过程的第一步。", "problem": "考虑一个用于模拟疾病传播的小型、孤立的家庭。该家庭由四名成员组成：Alice、Bob、Charlie 和 David。在这个家庭内部，有助于传播的直接接触发生在特定的成员对之间。两位家长 Alice 和 Bob 彼此有直接接触。每位家长都与他们的两个孩子 Charlie 和 David 有直接接触。两个孩子之间也有直接接触。不存在其他直接接触的情况。\n\n一个潜在的传播网络可以用邻接矩阵 $A$ 来表示，其中如果个体 $i$ 和个体 $j$ 有直接接触，则矩阵元素 $A_{ij}$ 为 1，否则为 0。根据定义，个体不与自身接触。\n\n构建这个家庭的邻接矩阵 $A$。矩阵的行和列应按字母顺序对应于个体：1. Alice, 2. Bob, 3. Charlie, 4. David。您的答案必须是完整的矩阵。", "solution": "我们将该家庭建模为一个无向简单图，其顶点按以下顺序排列：1: Alice, 2: Bob, 3: Charlie, 4: David。根据邻接矩阵 $A$ 的定义，如果个体 $i$ 和 $j$ 有直接接触，我们设 $A_{ij}=1$，否则设 $A_{ij}=0$，并且由于没有人与自己接触，所以 $A_{ii}=0$。\n\n根据描述：\n- Alice 和 Bob 有接触，所以 $A_{12}=A_{21}=1$。\n- 每位家长都与每个孩子有接触：Alice 与 Charlie 和 David 的接触得到 $A_{13}=A_{31}=1$ 和 $A_{14}=A_{41}=1$，Bob 与 Charlie 和 David 的接触得到 $A_{23}=A_{32}=1$ 和 $A_{24}=A_{42}=1$。\n- 两个孩子之间有接触，所以 $A_{34}=A_{43}=1$。\n- 不存在其他接触，且所有对角线元素均为零：$A_{11}=A_{22}=A_{33}=A_{44}=0$。\n\n因此，所有非对角线元素均为 1，而对角线元素均为 0，得到\n$$\nA=\\begin{pmatrix}\n0  & 1  & 1  & 1\\\\\n1  & 0  & 1  & 1\\\\\n1  & 1  & 0  & 1\\\\\n1  & 1  & 1  & 0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0  & 1  & 1  & 1\\\\ 1  & 0  & 1  & 1\\\\ 1  & 1  & 0  & 1\\\\ 1  & 1  & 1  & 0\\end{pmatrix}}$$", "id": "1462969"}, {"introduction": "在掌握了基础知识后，这个练习将我们的重点从物理接触转移到基因调控的抽象世界。我们将一个简单的基因调控回路建模为有向图，其中箭头表示影响的流向（激活或抑制）。通过分析此图中的路径[@problem_id:1463020]，你将练习如何从网络模型中提取定量的结构特性，这是理解网络基序和动态的关键任务。", "problem": "在系统生物学中，基因调控网络通常被建模为有向图，以分析其结构并预测其行为。考虑一个细胞内基因调控回路的简化模型，该模型涉及一个外部信号和三个基因。其组成部分及相互作用如下：\n\n1.  一个外部信号分子（记为 $S$）激活基因 $G_1$ 的表达。\n2.  基因 $G_1$ 的蛋白质产物作为转录因子，激活基因 $G_2$ 和基因 $G_3$ 的表达。\n3.  基因 $G_2$ 的蛋白质产物抑制基因 $G_1$ 的表达，形成一个负反馈回路。\n4.  基因 $G_3$ 是该特定通路的终端输出；其蛋白质产物不调控 $S$、$G_1$ 或 $G_2$。\n\n这个网络可以表示为一个有向图，其节点是四个组成部分 $\\{S, G_1, G_2, G_3\\}$。如果 $X$ 直接导致 $Y$ 的状态或表达发生变化（激活或抑制），则存在一条从节点 $X$ 到节点 $Y$ 的有向边。\n\n该图中一条长度为 $k$ 的路径被定义为一个包含 $k+1$ 个节点的序列 $(v_0, v_1, \\dots, v_k)$，使得对于所有从 $1$ 到 $k$ 的 $i$，都存在一条从 $v_{i-1}$ 到 $v_i$ 的有向边。计算该整个网络中存在的长度为3的不同路径的总数。", "solution": "我们首先将生物学描述转化为一个有向图，其节点为 $\\{S, G_1, G_2, G_3\\}$，有向边由所述的调控相互作用给出：\n- $S \\to G_1$（$S$ 激活 $G_1$），\n- $G_1 \\to G_2$ 和 $G_1 \\to G_3$（$G_1$ 激活 $G_2$ 和 $G_3$），\n- $G_2 \\to G_1$（$G_2$ 抑制 $G_1$），\n- $G_3$ 没有出边。\n\n一条长度为3的有向路径是一个序列 $(v_0, v_1, v_2, v_3)$，其边为 $v_0 \\to v_1 \\to v_2 \\to v_3$。我们可以通过直接枚举或使用邻接矩阵法来计算此类路径的数量。\n\n使用邻接矩阵法，将节点排序为 $(S, G_1, G_2, G_3)$，并定义邻接矩阵 $A$：如果存在从节点 $i$ 到节点 $j$ 的边，则 $A_{ij}=1$，否则 $A_{ij}=0$。则\n$$\nA=\\begin{pmatrix}\n0  & 1  & 0  & 0\\\\\n0  & 0  & 1  & 1\\\\\n0  & 1  & 0  & 0\\\\\n0  & 0  & 0  & 0\n\\end{pmatrix}.\n$$\n图论中的一个标准结论是，$(A^k)_{ij}$ 等于从节点 $i$ 到节点 $j$ 的长度为 $k$ 的有向路径的数量。因此，长度为3的路径总数是 $A^3$ 所有元素之和。计算\n$$\nA^{2}=\\begin{pmatrix}\n0  & 0  & 1  & 1\\\\\n0  & 1  & 0  & 0\\\\\n0  & 0  & 1  & 1\\\\\n0  & 0  & 0  & 0\n\\end{pmatrix},\n\\qquad\nA^{3}=\\begin{pmatrix}\n0  & 1  & 0  & 0\\\\\n0  & 0  & 1  & 1\\\\\n0  & 1  & 0  & 0\\\\\n0  & 0  & 0  & 0\n\\end{pmatrix}.\n$$\n将 $A^3$ 的所有元素相加，得到 $1+2+1+0=4$。\n\n为了完整起见，我们明确地枚举出所有长度为3的不同路径：\n- $S \\to G_1 \\to G_2 \\to G_1$\n- $G_1 \\to G_2 \\to G_1 \\to G_2$\n- $G_1 \\to G_2 \\to G_1 \\to G_3$\n- $G_2 \\to G_1 \\to G_2 \\to G_1$\n\n总共有 $4$ 条这样的路径，与矩阵计算的结果相符。", "answer": "$$\\boxed{4}$$", "id": "1463020"}, {"introduction": "最后的这个练习展示了图模型在系统生物学中的预测能力。你将处理一个包含激活和抑制相互作用的信号通路，并遵循特定的逻辑规则。此项挑战是利用这个模型来预测药物干预所产生的连锁效应[@problem_id:1462975]，这阐明了这些抽象表示如何作为假设检验和理解系统级响应的强大工具。请注意，问题中描述的初始状态是一个假设性设置，旨在清晰地检验你对网络传播的理解。", "problem": "一个细胞决策通路的简化模型由一个有向图表示，该图包含8个蛋白质组分，标记为P1到P8。组分P1是一个受体，它受到一个持续的外部信号刺激，意味着其状态始终为“激活”。组分之间的连接和调控效应（相互作用）被描述为一个形式为（源，目标，效应）的有向边列表：\n\n*   (P1, P2, 激活)\n*   (P1, P3, 激活)\n*   (P2, P4, 激活)\n*   (P2, P5, 抑制)\n*   (P3, P5, 激活)\n*   (P3, P6, 抑制)\n*   (P4, P7, 激活)\n*   (P5, P7, 抑制)\n*   (P6, P8, 激活)\n*   (P7, P8, 抑制)\n\n任何组分（源P1除外）的活性状态由调控它的组分的状态决定。一个组分为“激活”的规则是它必须同时满足两个条件：\n1.  至少有一个激活它的上游组分是“激活”状态。\n2.  所有抑制它的上游组分都是“非激活”状态。\n\n如果这两个条件中任何一个不被满足，该组分就变为“非激活”。没有激活输入的组分始终是“非激活”的。没有抑制输入的组分被认为默认满足第二个条件。\n\n我们假设，在任何干预之前，一个持续的信号环境已经导致了一个基线状态，在该状态下所有8个组分都是“激活”的。然后引入一种高特异性药物，它完全并永久地与组分P2结合，迫使其状态变为“非激活”。这种抑制的影响接着在网络中传播，直到所有组分达到一个新的、稳定的活性状态平衡。\n\n计算在这个新的平衡中处于“非激活”状态的组分总数。", "solution": "令 $s_i \\in \\{0, 1\\}$ 表示 $P_i$ 的活性，其中 $1$ 代表激活，$0$ 代表非激活。受体 $P_1$ 持续受激，因此 $s_1=1$。药物永久性地使 $P_2$ 非激活，因此 $s_2=0$。\n\n对于任意组分 $P_i$，其激活输入集为 $A_i$，抑制输入集为 $I_i$，更新规则为\n$$\ns_i = \\left(\\bigvee_{j \\in A_i} s_j\\right) \\land \\left(\\bigwedge_{k \\in I_i} \\neg s_k\\right),\n$$\n约定空的析取为 $0$（没有激活物意味着非激活），空的合取为 $1$（没有抑制物意味着该条件被满足）。\n\n鉴于这是一个无环图，我们按拓扑顺序评估每个节点：\n\n对于 $P_3$，$A_3=\\{1\\}$ 且 $I_3=\\varnothing$。因此\n$$\ns_3 = (\\bigvee_{j \\in \\{1\\}} s_j) \\land 1 = s_1 \\land 1 = 1.\n$$\n\n对于 $P_4$，$A_4=\\{2\\}$ 且 $I_4=\\varnothing$。因此\n$$\ns_4 = (\\bigvee_{j \\in \\{2\\}} s_j) \\land 1 = s_2 \\land 1 = 0.\n$$\n\n对于 $P_5$，$A_5=\\{3\\}$ 且 $I_5=\\{2\\}$。因此\n$$\ns_5 = (\\bigvee_{j \\in \\{3\\}} s_j) \\land (\\bigwedge_{k \\in \\{2\\}} \\neg s_k) = s_3 \\land \\neg s_2 = 1 \\land \\neg 0 = 1.\n$$\n\n对于 $P_6$，$A_6=\\varnothing$ 且 $I_6=\\{3\\}$。因此\n$$\ns_6 = (\\bigvee_{j \\in \\varnothing} s_j) \\land (\\bigwedge_{k \\in \\{3\\}} \\neg s_k) = 0 \\land \\neg s_3 = 0.\n$$\n\n对于 $P_7$，$A_7=\\{4\\}$ 且 $I_7=\\{5\\}$。因此\n$$\ns_7 = s_4 \\land \\neg s_5 = 0 \\land \\neg 1 = 0.\n$$\n\n对于 $P_8$，$A_8=\\{6\\}$ 且 $I_8=\\{7\\}$。因此\n$$\ns_8 = s_6 \\land \\neg s_7 = 0 \\land \\neg 0 = 0.\n$$\n\n因此，在新的平衡中，非激活的组分是 $P_2, P_4, P_6, P_7, P_8$，总共有 $5$ 个组分。", "answer": "$$\\boxed{5}$$", "id": "1462975"}]}