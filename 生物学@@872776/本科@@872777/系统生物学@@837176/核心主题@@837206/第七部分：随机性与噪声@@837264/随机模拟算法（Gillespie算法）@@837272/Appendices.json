{"hands_on_practices": [{"introduction": "掌握随机模拟算法的第一步是理解其核心引擎：反应倾向性（propensity）。一个系统的总倾向性 $a_0$ 决定了下一次反应事件发生的频率，是驱动整个随机过程的关键。这个练习将通过一个基础的基因表达模型，带你亲手计算总倾向性，让你体会如何量化系统中所有可能事件的瞬时总发生率。[@problem_id:1468248]", "problem": "考虑一个细胞内单个基因表达的简化随机模型。该模型关注一种特定信使核糖核酸（mRNA）分子的数量，记为 $M$。两个反应控制着 mRNA 群体的动态变化：\n\n1.  **转录**：产生一个 mRNA 分子。这是一个零级反应，形式为 $\\emptyset \\rightarrow M$，以恒定的反应倾向发生。\n2.  **降解**：一个已有的 mRNA 分子被降解。这是一个一级反应，形式为 $M \\rightarrow \\emptyset$，其具有一个随机速率常数。\n\n一个反应的反应倾向代表其瞬时概率速率。在特定时刻，系统的状态由 mRNA 分子数 $n_M$ 定义。\n\n给定以下参数：\n- 恒定生成反应倾向：$k_p = 10.5 \\text{ s}^{-1}$\n- 降解速率常数：$k_d = 0.12 \\text{ s}^{-1}$\n- 当前 mRNA 分子数：$n_M = 150$\n\n计算此刻系统的总反应倾向 $a_0$。总反应倾向是随机模拟算法中的一个关键量，因为它决定了到下一次反应事件发生的时间。答案以 $\\text{s}^{-1}$ 为单位，并四舍五入至三位有效数字。", "solution": "在随机化学动力学框架（Gillespie）中，每个反应的反应倾向是在给定当前状态下其发生的瞬时速率。\n\n- 对于零级转录反应 $\\emptyset \\rightarrow M$，其反应倾向是恒定的：\n$$\na_{\\text{prod}} = k_{p}.\n$$\n\n- 对于一级降解反应 $M \\rightarrow \\emptyset$，其反应倾向与当前分子数成正比：\n$$\na_{\\text{deg}} = k_{d}\\, n_{M}.\n$$\n\n总反应倾向是所有反应倾向之和：\n$$\na_{0} = a_{\\text{prod}} + a_{\\text{deg}} = k_{p} + k_{d}\\, n_{M}.\n$$\n\n代入给定值 $k_{p} = 10.5\\,\\text{s}^{-1}$，$k_{d} = 0.12\\,\\text{s}^{-1}$ 和 $n_{M} = 150$，我们得到\n$$\na_{0} = 10.5 + 0.12 \\times 150 = 10.5 + 18.0 = 28.5.\n$$\n\n因此，总反应倾向为 $28.5\\,\\text{s}^{-1}$，保留三位有效数字即为 $28.5$。", "answer": "$$\\boxed{28.5}$$", "id": "1468248"}, {"introduction": "在随机的世界里，当多个反应路径相互竞争时，系统如何“选择”下一步的走向？这取决于每个反应的相对可能性。这个练习探讨了一个常见的生物学场景——两种激酶竞争同一个底物，让你计算特定反应发生的概率，从而揭示随机模拟算法如何处理系统中的决策点。[@problem_id:1468285]", "problem": "一个细胞含有一种信号蛋白 `P`，它可以通过磷酸化被激活。该磷酸化过程可由两种不同的酶——激酶A（$K_A$）和激酶B（$K_B$）——催化。该系统是充分混合的，并且可以通过以下两个基元化学反应进行建模：\n\n1.  $P + K_A \\xrightarrow{c_A} P^* + K_A$\n2.  $P + K_B \\xrightarrow{c_B} P^* + K_B$\n\n在此，$P^*$ 代表该蛋白质的磷酸化（活性）形式。这些反应分别以二级反应速率常数 $c_A$ 和 $c_B$ 进行。这些常数包含了关于每对反应物分子的反应速率的信息。\n\n在某一特定时刻，系统中含有 $n_P$ 个底物蛋白 $P$ 分子、$n_A$ 个激酶A分子和 $n_B$ 个激酶B分子。\n\n假设对这些反应进行随机性描述，请确定系统中下一个发生的反应是一个 $P$ 分子被一个 $K_A$ 分子磷酸化的概率。请用 $c_A$、$c_B$、$n_A$ 和 $n_B$ 的符号表达式来表示你的答案。", "solution": "我们采用随机化学动力学（Gillespie）框架。对于两种不同物质 $X$ 和 $Y$ 之间，二级反应速率常数为 $c$ 的基元双分子反应，其倾向函数是 $c$ 与不同反应物对的数量（即 $n_{X}n_{Y}$）的乘积。因此，这两个反应通道的倾向函数为\n$$\na_{A}=c_{A}\\,n_{P}\\,n_{A},\\qquad a_{B}=c_{B}\\,n_{P}\\,n_{B}.\n$$\n总倾向函数为\n$$\na_{0}=a_{A}+a_{B}=c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}.\n$$\n根据 Gillespie 理论，下一个发生的反应是某一特定通道的概率，等于该通道的倾向函数除以总倾向函数。因此，下一个反应是由 $K_{A}$ 催化的磷酸化反应的概率是\n$$\n\\frac{a_{A}}{a_{0}}=\\frac{c_{A}\\,n_{P}\\,n_{A}}{c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}}.\n$$\n从分子和分母中提出公因子 $n_{P}$（假设 $n_{P}0$ 以便反应可以发生），得到\n$$\n\\frac{c_{A}\\,n_{A}}{c_{A}\\,n_{A}+c_{B}\\,n_{B}}.\n$$\n该表达式仅依赖于 $c_{A}$、$c_{B}$、$n_{A}$ 和 $n_{B}$，符合题目要求。", "answer": "$$\\boxed{\\frac{c_{A}n_{A}}{c_{A}n_{A}+c_{B}n_{B}}}$$", "id": "1468285"}, {"introduction": "随机模拟算法的真正威力在于它能够揭示确定性模型可能忽略的系统级行为。通过成千上万次独立的模拟运行，我们可以构建出系统状态的统计分布，从而洞察其长期动态特性。这个练习要求你分析一个从模拟数据中得到的双峰分布直方图，它是一个揭示基因调控网络中“双稳态”这一关键涌现特性的典型例子。[@problem_id:1468228]", "problem": "一位计算生物学家正在研究一个简单的基因开关模型。在这个模型中，一个单一的基因可以处于非激活状态 $G_{off}$ 或激活状态 $G_{on}$。当基因处于激活状态时，它会产生一种蛋白质 $P$。这种蛋白质作为一种转录因子，通过与基因的启动子区域结合，促进从非激活状态到激活状态的转换，从而促进其自身的产生。蛋白质 $P$ 也会随时间降解。该系统由以下一组反应描述：\n\n1.  $G_{off} \\xrightarrow{k_{on}} G_{on}$ (基础激活)\n2.  $G_{on} \\xrightarrow{k_{off}} G_{off}$ (失活)\n3.  $G_{on} \\xrightarrow{k_{p}} G_{on} + P$ (蛋白质合成)\n4.  $P \\xrightarrow{\\gamma} \\emptyset$ (蛋白质降解)\n5.  $G_{off} + 2P \\xrightarrow{k_{fb}} G_{on} + 2P$ (协同正反馈激活)\n\n为了理解系统的长期行为，该生物学家使用一种随机算法进行计算机模拟。模拟初始化时，基因处于 $G_{off}$ 状态，蛋白质 $P$ 的分子数量为零。总共执行了 10,000 次独立的模拟运行。每次运行都模拟了足够长的时间，以确保系统达到统计稳态。\n\n在 10,000 次运行的每一次的最终时间点，记录蛋白质 $P$ 的分子数量。当使用这 10,000 个数据点绘制直方图时，观察到一个显著的特征：其分布不是单一的钟形曲线。相反，它显示出两个明显且分离良好的峰。一个峰集中在非常低的 $P$ 分子数量处，而另一个峰则集中在远高于此的 $P$ 分子数量处。很少有模拟运行的结果分子数落在两个峰之间的区域。\n\n基于随机模拟的这一观察结果，关于该基因调控网络的稳态行为，最可能的结论是什么？\n\nA. 系统表现出双稳态性，意味着它有两个不同的稳定稳态：一个蛋白质数量低，一个蛋白质数量高。直方图反映了在任一稳态附近发现系统的概率。\n\nB. 模拟运行的时间不够长。如果延长模拟时间，两个峰最终会合并成一个峰，代表系统唯一的真实稳态。\n\nC. 这两个峰是模拟噪声的产物。更精确的模拟方法会消除这种噪声，并揭示出蛋白质数量的单一、明确的稳态值。\n\nD. 基于常微分方程的系统确定性模型必定是错误的，因为它只能预测稳态蛋白质浓度的单一值。\n\nE. 两个峰的出现是初始条件的直接结果。为了观察到单一稳态，模拟应该用平均数量的蛋白质分子进行初始化，而不是零。", "solution": "我们分析反应和随机观察所暗示的定性稳态行为。该网络通过 $G_{off}+2P \\xrightarrow{k_{fb}} G_{on}+2P$ 包含协同正反馈，这产生了一个随 $P$ 以非线性、S形方式增加的激活速率。这是双稳态性的一个典型机制。\n\n为了将其形式化，我们考虑描述平均蛋白质水平和启动子活性的确定性平均场方程。设 $p(t)$ 表示平均蛋白质丰度，设 $g(t)$ 为基因处于激活状态 $G_{on}$ 的概率（或大细胞群体中的比例）。基因转换速率为：\n- 从 $G_{off}$ 到 $G_{on}$ 的激活速率：$a(p)$，包括基础激活和正反馈。在协同学数为2的情况下，$a(p)$ 是 $p$ 的一个增函数，其增长近似于系数为2的希尔函数。一个方便的参数化是\n$$\na(p)=k_{on}+k_{fb}\\,h(p),\n$$\n其中 $h(p)$ 是 $p$ 的增函数，满足 $h(0)=0$ 且对于中等大小的 $p$ 有 $h(p)\\sim p^{2}$（例如，$h(p)=\\frac{p^{2}}{K^{2}+p^{2}}$，最多相差一个乘法因子），失活速率为 $k_{off}$。\n- 启动子占据动力学遵循\n$$\n\\frac{dg}{dt}=a(p)\\,(1-g)-k_{off}\\,g.\n$$\n在快启动子的准稳态下（或恰好在稳态下），\n$$\ng^{*}(p)=\\frac{a(p)}{a(p)+k_{off}}=\\frac{k_{on}+k_{fb}\\,h(p)}{k_{on}+k_{off}+k_{fb}\\,h(p)}.\n$$\n\n蛋白质动力学源于在激活状态下的合成和降解：\n$$\n\\frac{dp}{dt}=k_{p}\\,g(t)-\\gamma\\,p.\n$$\n在稳态下，代入 $g^{*}(p)$ 得到不动点条件\n$$\np^{*}=\\frac{k_{p}}{\\gamma}\\,g^{*}(p^{*})=\\frac{k_{p}}{\\gamma}\\,\\frac{k_{on}+k_{fb}\\,h(p^{*})}{k_{on}+k_{off}+k_{fb}\\,h(p^{*})}.\n$$\n因为 $h(p)$ 是一个有效希尔系数为2的S形函数，所以右侧是 $p^{*}$ 的一个递增、饱和的S形函数。在图形上，这条曲线与恒等线 $p^{*}$ 的交点可以是一个或三个。对于足够强的反馈（即 $k_{fb}$ 相对于 $k_{off}$ 较大，且有合适的 $k_{p}/\\gamma$ 和 $K$），存在三个交点：两个稳定的不动点 $p^{*}_{low}$ 和 $p^{*}_{high}$，以及一个不稳定的不动点 $p^{*}_{mid}$ 将它们分开。稳定性取决于净产生减去降解的导数的符号，\n$$\nf(p)=k_{p}\\,g^{*}(p)-\\gamma p,\\quad f'(p^{*})  0 \\text{ for stability},\n$$\n而S形的 $g^{*}(p)$ 通常得出 $f'(p^{*}_{low})  0$、 $f'(p^{*}_{mid}) > 0$ 和 $f'(p^{*}_{high})  0$。\n\n在随机设定中，平稳分布 $P_{ss}(p)$ 集中在稳定不动点附近，而在不稳定点附近受到抑制。更形式化地说，在弱噪声近似下，可以写出 $P_{ss}(p)\\propto \\exp(-U(p)/\\epsilon)$，其中 $U(p)$ 是一个有效势，在稳定不动点处有极小值；这产生一个双峰分布，两个峰位于 $p^{*}_{low}$ 和 $p^{*}_{high}$ 附近，谷底位于 $p^{*}_{mid}$ 附近。观测到的具有两个分离良好的峰且中间样本极少的直方图，正是双稳态性的标志。\n\n我们现在评估各个选项：\n- A：与上述分析一致；协同正反馈支持两个稳定稳态，并且随机稳态在两个吸引盆之间是双峰的。这与观察到的两个峰相匹配。\n- B：如果存在唯一的稳态，平稳分布将是单峰的；增加模拟时间不会使两个真实的峰在平稳状态下合并成一个。因此，该选项不成立。\n- C：模拟噪声会使分布变宽，但不会在10,000次长时间运行中系统性地稳健地产生两个明显、分离良好的峰。双峰性反映了潜在的动力学，而不是数值伪影。\n- D：具有正反馈和协同性的确定性ODE模型可以表现出多个稳态；声称它们只能预测单一稳态是错误的。\n- E：长时间后的平稳分布与初始条件无关。从零开始并不能解释稳态下持续的双峰性。\n\n因此，最可能的结论是选项A中所述的双稳态性。", "answer": "$$\\boxed{A}$$", "id": "1468228"}]}