{"hands_on_practices": [{"introduction": "深度学习模型理解的是数字语言，而不是生物实体。因此，在预测分子相互作用时，我们的首要任务是将蛋白质等复杂的生物分子转化为模型可以处理的数值格式。这个过程被称为特征工程，是构建任何生物信息学预测模型的基石。这项练习将带你亲手实践这一关键步骤，学习如何基于氨基酸的理化性质构建特征向量，并应用数据归一化这一标准技术来提高模型训练的稳定性和效率。[@problem_id:1426736]", "problem": "在生物信息学领域，机器学习模型常被用于预测蛋白质的结构和功能。这个过程中的一个关键首要步骤是，将氨基酸等定性生物实体转换为计算机可以处理的定量数值表示。这种转换被称为特征工程。\n\n您的任务是根据特定氨基酸的一些基本理化性质，为其创建一个数值特征向量。我们为您提供了一小组氨基酸的以下数据：\n\n| 氨基酸 | 符号 | 疏水性（Kyte-Doolittle 标度） | 分子量（Da） | pH 7.4下的净电荷 |\n| :--- | :---: | :---: | :---: | :---: |\n| Alanine | A | 1.8 | 89.1 | 0 |\n| Glycine | G | -0.4 | 75.1 | 0 |\n| Leucine | L | 3.8 | 131.2 | 0 |\n| Lysine | K | -3.9 | 146.2 | +1 |\n| Glutamic Acid | E | -3.5 | 147.1 | -1 |\n\n为确保每个属性对模型的贡献公平，并将所有值归一到一个共同的范围内，您必须对每个属性应用最小-最大归一化。一个值 $x$ 的最小-最大归一化公式为：\n\n$$x_{\\text{norm}} = \\frac{x - x_{\\min}}{x_{\\max} - x_{\\min}}$$\n\n其中，$x_{\\min}$ 和 $x_{\\max}$ 是指在所提供表格的整个数据集中，该特定属性的最小值和最大值。\n\n使用表格中的数据，计算 **Glutamic Acid (E)** 的三维归一化特征向量。该向量应为 $[v_1, v_2, v_3]$ 的形式，其中 $v_1$ 是归一化疏水性，$v_2$ 是归一化分子量，$v_3$ 是归一化净电荷。\n\n将您的答案表示为一个无量纲的行向量。向量的每个数值分量四舍五入到三位有效数字。", "solution": "目标是使用所提供的数据和最小-最大归一化公式，计算 Glutamic Acid (E) 的归一化特征向量。该特征向量有三个分量：归一化疏水性 ($v_1$)、归一化分子量 ($v_2$) 和归一化净电荷 ($v_3$)。\n\n**第一步：确定 Glutamic Acid (E) 的值。**\n从表格中可知，Glutamic Acid 的属性如下：\n- 疏水性, $x_{\\text{hydro}}$ = -3.5\n- 分子量, $x_{\\text{mw}}$ = 147.1 Da\n- 净电荷, $x_{\\text{charge}}$ = -1\n\n**第二步：从整个数据集中确定每个属性的最小值和最大值。**\n\n**对于疏水性：**\n- 值为：1.8, -0.4, 3.8, -3.9, -3.5。\n- 最小值, $x_{\\text{hydro, min}} = -3.9$ (来自 Lysine)。\n- 最大值, $x_{\\text{hydro, max}} = 3.8$ (来自 Leucine)。\n\n**对于分子量：**\n- 值为：89.1, 75.1, 131.2, 146.2, 147.1。\n- 最小值, $x_{\\text{mw, min}} = 75.1$ (来自 Glycine)。\n- 最大值, $x_{\\text{mw, max}} = 147.1$ (来自 Glutamic Acid)。\n\n**对于净电荷：**\n- 值为：0, 0, 0, +1, -1。\n- 最小值, $x_{\\text{charge, min}} = -1$ (来自 Glutamic Acid)。\n- 最大值, $x_{\\text{charge, max}} = +1$ (来自 Lysine)。\n\n**第三步：对 Glutamic Acid 的每个属性应用最小-最大归一化公式。**\n\n**分量1：归一化疏水性 ($v_1$)**\n使用公式 $x_{\\text{norm}} = (x - x_{\\min}) / (x_{\\max} - x_{\\min})$：\n$$v_1 = \\frac{x_{\\text{hydro}} - x_{\\text{hydro, min}}}{x_{\\text{hydro, max}} - x_{\\text{hydro, min}}} = \\frac{-3.5 - (-3.9)}{3.8 - (-3.9)} = \\frac{0.4}{7.7}$$\n$$v_1 \\approx 0.05194805...$$\n四舍五入到三位有效数字，我们得到 $v_1 = 0.0519$。\n\n**分量2：归一化分子量 ($v_2$)**\n$$v_2 = \\frac{x_{\\text{mw}} - x_{\\text{mw, min}}}{x_{\\text{mw, max}} - x_{\\text{mw, min}}} = \\frac{147.1 - 75.1}{147.1 - 75.1} = \\frac{72.0}{72.0} = 1$$\n该值恰好为 1。为了表示为三位有效数字，我们将其写为 $v_2 = 1.00$。\n\n**分量3：归一化净电荷 ($v_3$)**\n$$v_3 = \\frac{x_{\\text{charge}} - x_{\\text{charge, min}}}{x_{\\text{charge, max}} - x_{\\text{charge, min}}} = \\frac{-1 - (-1)}{1 - (-1)} = \\frac{0}{2} = 0$$\n该值恰好为 0。为了使其精度与其他分量（两位小数）保持一致，我们将其写为 $v_3 = 0.00$。这种表示法包含一位有效数字（最后一个零），但在这种情况下是表示精确零的标准方式。\n\n**第四步：组装最终的特征向量。**\nGlutamic Acid (E) 的归一化特征向量为 $[v_1, v_2, v_3]$。\n代入计算并四舍五入后的值：\n$$[0.0519, 1.00, 0.00]$$\n按要求，这以行向量的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.0519  1.00  0.00 \\end{pmatrix}}$$", "id": "1426736"}, {"introduction": "一旦我们将蛋白质转化为数值特征向量，下一步就是设计一个能够从中学习规律的“大脑”——也就是我们的深度学习模型。这项练习将揭开神经网络的神秘面纱，让你通过计算一个简单网络的可训练参数总数来理解其内部结构。理解模型的参数量有助于我们评估其学习能力（即模型容量）和训练所需的计算成本，这是设计和选择合适模型架构的基础。[@problem_id:1426734]", "problem": "一个计算生物学团队正在设计一个简单的前馈神经网络 (FNN)，用于预测蛋白质 A 和蛋白质 B 这两种蛋白质是否会相互作用。该模型的设计如下：\n\n1.  **输入表示：** 每种蛋白质由一个长度为 $D$ 的数值特征向量来表征。在此模型中，$D=50$。神经网络的输入是通过将蛋白质 A 的特征向量与蛋白质 B 的特征向量连接（concatenate）形成一个更大的单一向量。\n\n2.  **网络架构：** 该网络有一个输入层、两个隐藏层和一个输出层。\n    *   第一个隐藏层包含 $H_1 = 128$ 个神经元。\n    *   第二个隐藏层包含 $H_2 = 64$ 个神经元。\n    *   输出层由单个神经元组成，该神经元产生一个与相互作用概率相关的值。\n\n3.  **连接性：** 网络在连续层之间是全连接的。隐藏层和输出层中的每个神经元都有一个相关的可训练偏置项。\n\n基于此架构，计算整个网络中可训练参数的总数（即所有权重和偏置的总和）。", "solution": "输入由两个长度为 $D$ 的向量连接而成，因此输入维度为 $I=2D$。\n\n对于一个从 $n_{\\text{in}}$ 个输入映射到 $n_{\\text{out}}$ 个输出且带有偏置的全连接层，可训练参数的数量等于 $n_{\\text{in}} n_{\\text{out}} + n_{\\text{out}}$（权重加偏置）。\n\n将此应用于每一层：\n- 输入层到第一个隐藏层：$n_{\\text{in}} = I = 2D$，$n_{\\text{out}} = H_{1}$。参数：$(2D)H_{1} + H_{1} = (2D+1)H_{1}$。\n- 第一个隐藏层到第二个隐藏层：$n_{\\text{in}} = H_{1}$，$n_{\\text{out}} = H_{2}$。参数：$H_{1}H_{2} + H_{2} = (H_{1}+1)H_{2}$。\n- 第二个隐藏层到输出层：$n_{\\text{in}} = H_{2}$，$n_{\\text{out}} = 1$。参数：$H_{2}\\cdot 1 + 1 = H_{2}+1$。\n\n因此，可训练参数的总数为\n$$\nP = (2D+1)H_{1} + (H_{1}+1)H_{2} + (H_{2}+1).\n$$\n代入 $D=50$, $H_{1}=128$, $H_{2}=64$：\n$$\nP = (2\\cdot 50 + 1)\\cdot 128 + (128+1)\\cdot 64 + (64+1).\n$$\n计算每一项：\n$$\n(100+1)\\cdot 128 = 101\\cdot 128 = 12928,\n$$\n$$\n(128+1)\\cdot 64 = 129\\cdot 64 = 8256,\n$$\n$$\n64+1 = 65.\n$$\n求和：\n$$\nP = 12928 + 8256 + 65 = 21249.\n$$", "answer": "$$\\boxed{21249}$$", "id": "1426734"}, {"introduction": "模型构建和训练完成后，我们如何判断它是否真的有效？特别是在像虚拟药物筛选这样“大海捞针”的真实场景中，这个问题尤为关键。这项练习探讨了模型性能评估这一核心议题，揭示了为何像准确率（accuracy）这样的常用指标在处理类别不平衡的生物数据时会产生误导。通过这项练习，你将学会使用如精确率（precision）和召回率（recall）等更具信息量的指标，对模型的真实表现做出公正的评价。[@problem_id:1426729]", "problem": "在一个计算药物发现项目中，一位研究人员训练了一个图神经网络（GNN）来进行虚拟筛选。其目标是从一个大型分子库中识别出哪些分子是“活性”的，即它们很可能与特定的靶蛋白结合。\n\n该模型在一个包含1,000,000个候选分子的数据集上进行测试。在这个数据集中，根据以往的实验工作可知，恰好有100个分子是活性的，其余999,900个是非活性的。\n\n运行筛选后，GNN的预测得出以下结果：\n- 在100个实际的活性分子中，模型正确识别了80个。\n- 在999,900个实际的非活性分子中，模型错误地将1,920个识别为活性。\n\n基于这些信息，执行以下任务：\n1.  计算模型的准确率，即所有预测中正确的比例。\n2.  对于“活性”类别，计算模型的精确率（预测为阳性的样本中实际为阳性的比例）和召回率（实际为阳性的样本中被正确识别的比例）。\n3.  考虑到虚拟筛选的背景，其主要目标是找到稀有的活性化合物，同时最大限度地减少对假阳性样本的后续实验浪费，请评估该模型的性能。需要考虑计算出的指标和数据集严重的类别不平衡问题。\n\n下列哪个陈述对模型性能提供了最准确的评估，并为该任务提供了最佳的评估策略？\n\nA. 模型的准确率极高，表明其整体性能出色，适合用于识别活性化合物。\n\nB. 由于大量的真阴性样本，模型的准确率具有误导性的高。精确率-召回率曲线下面积（AUPRC）会是一个信息量更大的指标，因为它能更好地说明在不平衡数据集中，寻找活性化合物与避免假警报之间的权衡。\n\nC. 模型的召回率很高，但其精确率极低。因此，该模型是无用的，因为一个有用的模型必须同时具有高精确率和高召回率。准确率仍然是快速总结性能的最佳单一指标。\n\nD. 准确率和AUPRC提供的信息量是相等的。它们之间的选择仅取决于用户对特定性能分数的偏好。\n\nE. 模型的性能很差，其低精确率表明了这一点。在这种情况下，一个更好的指标是F1分数，因为AUPRC过于复杂难以解释，且仅在精确率高时才有用。", "solution": "根据描述定义混淆矩阵的各项。真阳性（True Positives）的数量为 $TP=80$，因为模型正确识别了100个实际活性分子中的80个。假阴性（False Negatives）的数量为 $FN=100-80=20$。在 $999{,}900$ 个实际非活性分子中，模型将 $1{,}920$ 个预测为活性，这些是假阳性（False Positives），即 $FP=1{,}920$。因此，真阴性（True Negatives）的数量为 $TN=999{,}900-1{,}920=997{,}980$。样本总数为 $N=1{,}000{,}000$。\n\n准确率定义为正确预测的比例：\n$$\n\\text{Accuracy}=\\frac{TP+TN}{N}=\\frac{80+997{,}980}{1{,}000{,}000}=\\frac{998{,}060}{1{,}000{,}000}=0.99806.\n$$\n\n对于活性类别，精确率是预测为阳性的样本中实际为阳性的比例，召回率是实际为阳性的样本中被正确识别的比例。根据定义，\n$$\n\\text{Precision}=\\frac{TP}{TP+FP}=\\frac{80}{80+1{,}920}=\\frac{80}{2{,}000}=0.04,\n$$\n$$\n\\text{Recall}=\\frac{TP}{TP+FN}=\\frac{80}{80+20}=\\frac{80}{100}=0.8.\n$$\n\n在具有严重类别不平衡的虚拟筛选背景下解释这些结果：准确率 $0.99806$ 主要由大量的真阴性样本决定，因此在评估模型寻找稀有活性物质并同时控制假阳性的能力方面具有误导性。召回率 $0.8$ 表明模型找回了大部分实际的活性物质，但精确率 $0.04$ 非常低，这意味着存在大量假阳性，并会导致后续实验的大量浪费。需要一种能够捕捉在不同阈值下识别活性物质与限制假阳性之间权衡的评估方法；精确率-召回率曲线及其曲线下面积（AUPRC）特别适用于不平衡问题，并且比准确率更好地直接反映这种权衡。因此，最准确的评估和最合适的评估策略在选项B中陈述。", "answer": "$$\\boxed{B}$$", "id": "1426729"}]}