{"hands_on_practices": [{"introduction": "在深入研究复杂的高维点云数据之前，我们可以通过更简单的图结构来理解拓扑不变量。本练习将一个生物网络（食物网）模型化为一个图，并要求计算其欧拉示性数和贝蒂数，这两个都是描述网络连通性和环路结构的基本指标。通过这个练习，你将把图论的知识与拓扑学的核心概念联系起来，为后续更复杂的分析打下基础 [@problem_id:1475170]。", "problem": "在系统生物学中，网络理论和拓扑学方法被用来分析复杂生物系统的结构和鲁棒性。例如，一个食物网可以表示为一个图，其中物种是顶点，捕食者-猎物相互作用是边。该图的拓扑特征可以揭示重要的生态学特性。\n\n考虑一个简化的淡水池塘生态系统，它由四个物种组成：Algae、Snails、Crayfish 和 Bass。营养相互作用如下：\n- Snails 以 Algae 为食。\n- Crayfish 以 Algae 和 Snails 为食。\n- Bass 以 Snails 和 Crayfish 为食。\n\n这个食物网可以被建模为一个简单的无向图，其中每个物种是一个顶点，如果两个物种之间存在捕食关系，则它们之间有一条边连接。对于这个图，确定两个关键的拓扑不变量：欧拉示性数 $\\chi$ 和第一贝蒂数 $b_1$。贝蒂数 $b_1$ 量化了网络结构中独立的一维“孔”或环的数量。\n\n你的答案应该是一个整数对，表示 $(\\chi, b_1)$ 的值。", "solution": "将该生态系统建模为一个简单的无向图，每个物种对应一个顶点，如果两个物种之间存在捕食关系，则它们之间有一条边。\n\n列出顶点和边：\n- 顶点：Algae (A)、Snails (S)、Crayfish (C)、Bass (B)，所以 $V=4$。\n- 由营养关系产生的边：\n  - $S$–$A$ (Snails 以 Algae 为食)，\n  - $C$–$A$ 和 $C$–$S$ (Crayfish 以 Algae 和 Snails 为食)，\n  - $B$–$S$ 和 $B$–$C$ (Bass 以 Snails 和 Crayfish 为食)。\n这些是五条不同的边，所以 $E=5$。\n\n连通性：每个顶点都通过这些边相连，因此连通分量的数量为 $c=1$。\n\n对于一个被视为一维CW复形/单纯复形（没有填充面）的图，其欧拉示性数为\n$$\n\\chi = V - E.\n$$\n代入 $V=4$ 和 $E=5$ 得\n$$\n\\chi = 4 - 5 = -1.\n$$\n\n图的第一贝蒂数是圈数\n$$\nb_{1} = E - V + c.\n$$\n代入 $E=5$、$V=4$ 和 $c=1$ 得\n$$\nb_{1} = 5 - 4 + 1 = 2.\n$$\n\n因此，所求的数对 $(\\chi, b_{1})$ 是 $(-1, 2)$。", "answer": "$$\\boxed{(-1, 2)}$$", "id": "1475170"}, {"introduction": "许多生物学数据，例如蛋白质中原子的坐标，天然地以点云形式存在。这个练习将引导你体验持久同源性的核心机制——Vietoris-Rips滤子。你将通过计算一个肽链结构中第一个环（“1-维环路”）出现的精确距离阈值 $\\epsilon$，从而具体地理解拓扑特征是如何从原始数据中“诞生”的 [@problem_id:1475179]。", "problem": "在系统生物学中，拓扑数据分析（Topological Data Analysis, TDA）为分析复杂生物数据的“形状”提供了一个强大的框架。一个常见的应用是通过将蛋白质表示为其α-碳原子的点云来研究其构象。然后，在此点云上构建Vietoris-Rips复形，以捕捉其在不同空间尺度下的拓扑特征。\n\nVietoris-Rips复形 $VR(\\epsilon)$，是在一个点集上构建的单纯复形，其中：\n1. 顶点是点本身。\n2. 如果任意两点之间的欧几里得距离小于或等于一个距离参数 $\\epsilon$，则在这两点之间连接一条边。\n3. 如果三个点的所有三条成对距离都小于或等于 $\\epsilon$，则这三个点形成一个三角形（或2-单纯形）。\n4. 更高维的单纯形（例如，四面体）也以类似的方式形成。\n\n随着 $\\epsilon$ 的增加，会形成更多的连接，复形的拓扑结构也会发生变化。一个关键事件是出现一个“孔”或1-环，这是一个由边组成的闭合回路，但在该 $\\epsilon$ 值下，它不是复形内任何三角形集合的边界。\n\n考虑一个小的肽片段，其结构由其五个α-碳原子 $P_1$ 到 $P_5$ 的三维坐标近似表示，单位为埃（Å）：\n$P_1 = (0.0, 5.0, 0.1)$\n$P_2 = (4.0, 2.0, -0.2)$\n$P_3 = (3.0, -3.0, 0.3)$\n$P_4 = (-3.0, -3.0, -0.1)$\n$P_5 = (-4.0, 2.0, 0.2)$\n\n确定在该点云的Vietoris-Rips滤子中，第一个非平凡1-环出现的最小距离阈值 $\\epsilon$。请用埃（Å）表示您的答案，并四舍五入到三位有效数字。", "solution": "我们寻求在由五个点 $P_{1},\\dots,P_{5}$ 构建的Vietoris-Rips滤子中，第一个非平凡$1$-环（即一个未被任何$2$-单纯形填充的边之环）首次出现的最小阈值 $\\epsilon$。在Vietoris-Rips复形 $VR(\\epsilon)$ 中，如果点 $P_i$ 和 $P_j$ 之间的欧几里得距离 $d_{ij}$ 满足 $d_{ij} \\leq \\epsilon$，则存在一条边 $\\{i,j\\}$。如果三条成对距离都 $\\leq \\epsilon$，则存在一个位于 $\\{i,j,k\\}$ 上的三角形。\n\n给定的坐标是：\n$P_{1}=(0.0,5.0,0.1)$, $P_{2}=(4.0,2.0,-0.2)$, $P_{3}=(3.0,-3.0,0.3)$, $P_{4}=(-3.0,-3.0,-0.1)$, $P_{5}=(-4.0,2.0,0.2)$。\n\n首先计算欧几里得距离。使用 $d_{ij}^{2}=(\\Delta x)^{2}+(\\Delta y)^{2}+(\\Delta z)^{2}$，我们得到五条“周长”边（根据坐标所建议的自然循环顺序 $1\\to 2\\to 3\\to 4\\to 5\\to 1$）：\n$$\n\\begin{aligned}\nd_{12}^{2}=(-4)^{2}+3^{2}+0.3^{2}=16+9+0.09=25.09, {12}=\\sqrt{25.09},\\\\\nd_{23}^{2}=1^{2}+5^{2}+(-0.5)^{2}=1+25+0.25=26.25, {23}=\\sqrt{26.25},\\\\\nd_{34}^{2}=6^{2}+0^{2}+0.4^{2}=36+0+0.16=36.16, {34}=\\sqrt{36.16},\\\\\nd_{45}^{2}=1^{2}+(-5)^{2}+(-0.3)^{2}=1+25+0.09=26.09, {45}=\\sqrt{26.09},\\\\\nd_{51}^{2}=(-4)^{2}+(-3)^{2}+0.1^{2}=16+9+0.01=25.01, {51}=\\sqrt{25.01}.\n\\end{aligned}\n$$\n不相邻的“对角线”距离为：\n$$\n\\begin{aligned}\nd_{13}^{2}=(-3)^{2}+8^{2}+(-0.2)^{2}=9+64+0.04=73.04,\\\\\nd_{24}^{2}=7^{2}+5^{2}+(-0.1)^{2}=49+25+0.01=74.01,\\\\\nd_{35}^{2}=7^{2}+(-5)^{2}+0.1^{2}=49+25+0.01=74.01,\\\\\nd_{41}^{2}=(-3)^{2}+(-8)^{2}+(-0.2)^{2}=9+64+0.04=73.04,\\\\\nd_{52}^{2}=(-8)^{2}+0^{2}+0.4^{2}=64+0+0.16=64.16.\n\\end{aligned}\n$$\n\n当所有五条周长边都存在，且没有任何三角形集合填充该环时，第一个$1$-环就出现了。当 $\\epsilon$ 达到 $\\{d_{12},d_{23},d_{34},d_{45},d_{51}\\}$ 中的最大值，即 $d_{34}=\\sqrt{36.16}$ 时，所有周长边都存在。在 $\\epsilon=d_{34}$ 时，检查是否存在三角形：任何由三个连续顶点（如 $\\{1,2,3\\}$）组成的三角形，都需要相应的对角线（如 $d_{13}$）也满足该阈值。然而，所有对角线距离的平方都远大于 $36.16$ (最短的对角线距离的平方是 $d_{52}^2 = 64.16$)，因此 $d_{13},d_{24},d_{35},d_{41},d_{52} > \\sqrt{36.16}$。因此，在 $\\epsilon=\\sqrt{36.16}$ 时，不存在三角形，所以由五条周长边形成的环未被填充，构成了一个非平凡的$1$-环。\n\n因此，第一个非平凡$1$-环出现的最小阈值是 $\\epsilon=\\sqrt{36.16}$，其十进制值四舍五入到三位有效数字后为 $6.01$ 埃。", "answer": "$$\\boxed{6.01}$$", "id": "1475179"}, {"introduction": "在识别出拓扑特征及其持久性之后，下一步是解释和利用这些信息。本练习介绍了一种将持久性图中的（诞生，死亡）点对转化为更稳定、更实用的函数表示——持久性景观——的方法。通过为一个简单的例子绘制景观图，你将学习到这种总结性工具是如何捕捉关于特征生命周期的关键信息的，为后续的数据比较和机器学习应用铺平道路 [@problem_id:1475107]。", "problem": "一位系统生物学家正在使用一种基于拓扑数据分析 (TDA) 的计算方法，研究一种大分子酶的构象变化。该分析将蛋白质的结构表示为三维空间中的一个点云，并追踪当结构随时间波动时，通道（维度为1的拓扑特征，或 $H_1$）的出现和消失。每个通道的“生命周期”被记录在一个持续性图中。\n\n持续性图是二维平面中的一个点集 $p = (b, d)$，其中 $b$ 是一个特征的“出生时间”，$d$ 是其“死亡时间”，且满足 $d  b$。从这个图中，可以构建一组称为持续性景观的函数。\n\n对于图中的每个点 $p = (b, d)$，一个对应的“帐篷”函数 $f_p(x)$ 定义为：\n$$f_p(x) = \\max(0, \\min(x-b, d-x))$$\n这个函数是一个三角形，其底边在x轴上的区间 $[b, d]$，其顶点在 $x = \\frac{b+d}{2}$ 处，高度为 $\\frac{d-b}{2}$。\n\n第一个持续性景观函数，记为 $\\lambda_1(x)$，则定义为所有这些帐篷函数的逐点最大值：\n$$\\lambda_1(x) = \\max_{p} \\{ f_p(x) \\}$$\n其中最大值是针对持续性图中的所有点 $p$ 求得的。\n\n假设对该酶的分析，其 $H_1$ 特征产生了一个只包含两个点的简单持续性图：$p_1 = (1, 7)$ 和 $p_2 = (4, 8)$。以下哪个陈述最好地描述了所得的第一个持续性景观函数 $\\lambda_1(x)$ 的形状？\n\nA. 一个单一的三角形峰。\n\nB. 两个独立的、不重叠的三角形峰。\n\nC. 一个具有两个峰的形状，一个为全局最大值，一个为局部最大值。\n\nD. 一个顶部平坦（平台）的梯形形状。\n\nE. 一个具有单一峰的形状，其宽度大于任何一个独立帐篷函数的底边宽度。", "solution": "我们根据给定的持续性图中的点来构建这两个帐篷函数。对于一个点 $p=(b,d)$，帐篷函数为 $f_{p}(x)=\\max\\left(0,\\min(x-b,d-x)\\right)$，它在 $[b,d]$ 上是三角形的，顶点在 $x=(b+d)/2$ 处，高度为 $(d-b)/2$。\n\n对于 $p_{1}=(1,7)$，底边为 $[1,7]$，顶点在 $x=(1+7)/2=4$ 处，高度为 $(7-1)/2=3$。因此\n$$\nf_{1}(x)=\\begin{cases}\n0,  x\\le 1, \\\\\nx-1,  1 \\le x \\le 4, \\\\\n7-x,  4 \\le x \\le 7, \\\\\n0,  x \\ge 7.\n\\end{cases}\n$$\n对于 $p_{2}=(4,8)$，底边为 $[4,8]$，顶点在 $x=(4+8)/2=6$ 处，高度为 $(8-4)/2=2$。因此\n$$\nf_{2}(x)=\\begin{cases}\n0,  x \\le 4, \\\\\nx-4,  4 \\le x \\le 6, \\\\\n8-x,  6 \\le x \\le 8, \\\\\n0,  x \\ge 8.\n\\end{cases}\n$$\n\n第一个持续性景观为 $\\lambda_{1}(x)=\\max\\{f_{1}(x),f_{2}(x)\\}$。在区间 $[1,4]$ 上，只有 $f_{1}$ 非零，并且线性增加，在 $x=4$ 时达到 $3$。在 $[4,7]$ 上，两者都非零。在这个重叠区域，它们的交点可以通过求解方程 $7-x=x-4$ 得到，即 $2x=11$，所以 $x=5.5$。此时的共同值为 $f_{1}(5.5)=f_{2}(5.5)=7-5.5=1.5$。因此，在 $[4, 5.5]$ 上，$f_{1}(x) \\ge f_{2}(x)$，所以 $\\lambda_{1}(x)$ 从 $3$ 减少到 $1.5$；而在 $[5.5, 6]$ 上，$f_{2}(x) > f_{1}(x)$，所以 $\\lambda_{1}(x)$ 从 $1.5$ 增加到 $x=6$ 时的值 $2$。在 $[6,8]$ 上，$f_{2}(x)$ 占主导地位并减少，在 $x=8$ 时达到 $0$。\n\n因此 $\\lambda_{1}(x)$ 有两个峰：一个在 $x=4$ 处高度为 $3$ 的全局最大值，和一个在 $x=6$ 处高度为 $2$ 的较小的局部最大值，两者被位于 $x=5.5$ 的一个局部最小值所分隔。这对应于一个具有两个峰的形状，一个为全局最大值，一个为局部最大值。", "answer": "$$\\boxed{C}$$", "id": "1475107"}]}