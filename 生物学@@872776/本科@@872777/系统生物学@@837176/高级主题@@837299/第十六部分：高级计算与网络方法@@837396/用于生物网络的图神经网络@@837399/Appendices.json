{"hands_on_practices": [{"introduction": "在应用图神经网络（GNN）于任何生物系统之前，首要步骤是将该系统转化为机器可读的图结构。本练习将带领您实践这一基础技能，将一个简单的代谢途径转换为两种GNN分析中常用的标准数字格式：邻接矩阵和边列表。掌握数据表示是成功构建GNN模型的关键第一步。", "problem": "在系统生物学中，代谢途径通常被建模为图，以供图神经网络（GNNs）等机器学习算法进行分析。考虑一个涉及四种代谢物（M1、M2、M3 和 M4）的简单假设性代谢途径。该途径中的生化反应定义了我们图中的连接，具体如下：\n\n1.  代谢物 M1 是底物，被转化为代谢物 M2。\n2.  代谢物 M2 是底物，可以被转化为代谢物 M3。\n3.  代谢物 M2 也可以通过一个独立的反应被转化为代谢物 M4。\n\n这些反应可以表示为一个有向图，其中从节点 `u` 到节点 `v` 的边表示代谢物 `u` 是产生代谢物 `v` 的反应的底物。为了能被 GNN 处理，这个图必须被转换成数值格式。两种常见的格式是邻接矩阵和边列表。\n\n假设代谢物按以下顺序被索引为节点：M1=1, M2=2, M3=3, M4=4。邻接矩阵 $A$ 是一个方阵，其中如果存在从节点 $i$ 到节点 $j$ 的有向边，则条目 $A_{ij}$ 为 1，否则为 0。边列表是一个包含数对的列表，其中每个数对 `[source, target]` 表示一条有向边。\n\n根据所描述的途径，以下哪个选项正确地提供了图的邻接矩阵和边列表表示？\n\nA.\n邻接矩阵:\n$$\n\\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  1 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix}\n$$\n边列表: `[[1, 2], [2, 3], [2, 4]]`\n\nB.\n邻接矩阵:\n$$\n\\begin{pmatrix} 0  1  0  0 \\\\ 1  0  1  1 \\\\ 0  1  0  0 \\\\ 0  1  0  0 \\end{pmatrix}\n$$\n边列表: `[[1, 2], [2, 1], [2, 3], [3, 2], [2, 4], [4, 2]]`\n\nC.\n邻接矩阵:\n$$\n\\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix}\n$$\n边列表: `[[1, 2], [2, 3]]`\n\nD.\n邻接矩阵:\n$$\n\\begin{pmatrix} 0  0  0  0 \\\\ 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  1  0  0 \\end{pmatrix}\n$$\n边列表: `[[2, 1], [3, 2], [4, 2]]`", "solution": "该途径定义了有向反应：M1 到 M2，M2 到 M3，以及 M2 到 M4。根据节点索引 M1=1, M2=2, M3=3, M4=4，这些反应所蕴含的有向边是 $(1,2)$、$(2,3)$ 和 $(2,4)$。\n\n根据邻接矩阵 $A$ 的定义，如果存在从节点 $i$ 到节点 $j$ 的有向边，则 $A_{ij}=1$，否则 $A_{ij}=0$。因此，唯一的非零条目是 $A_{12}=1$、$A_{23}=1$ 和 $A_{24}=1$，所有其他条目均为 $0$。这得到\n$$\nA=\\begin{pmatrix}\n0  1  0  0\\\\\n0  0  1  1\\\\\n0  0  0  0\\\\\n0  0  0  0\n\\end{pmatrix}.\n$$\n边列表是记录相同边的有向数对集合，即 $[[1,2],[2,3],[2,4]]$。\n\n与选项进行比较：\n- 选项 A 恰好具有此邻接矩阵和边列表，因此是正确的。\n- 选项 B 包含了不存在的额外反向边 $(2,1)$、$(3,2)$ 和 $(4,2)$，因此是不正确的。\n- 选项 C 遗漏了边 $(2,4)$，因此是不完整且不正确的。\n- 选项 D 反转了所有边的方向，因此是不正确的。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1436682"}, {"introduction": "一旦我们将生物网络表示为图，下一步就是理解GNN如何从中学习。本练习将通过一个具体计算来揭示GNN的核心机制——“消息传递”。我们将模拟在蛋白质-蛋白质相互作用（PPI）网络中，一个蛋白质节点如何根据其邻居节点的信息来更新自身特征，从而让您亲手体验GNN单层更新的核心过程。", "problem": "在系统生物学领域，图神经网络（GNNs）是从网络结构化数据（如蛋白质-蛋白质相互作用（PPI）网络）中学习的强大工具。考虑一个简单的GNN模型，该模型旨在根据蛋白质之间的连接来更新其特征。\n\n我们关注一个PPI网络的一小部分，其中涉及一个中心蛋白质 Protein V，它与两个相邻蛋白质 Protein U1 和 Protein U2 相互作用。每个蛋白质都由一个二维特征向量描述。向量的第一个元素代表蛋白质的归一化表达水平，第二个元素代表其线粒体定位分数。\n\n初始特征向量如下：\n- Protein V: $h_V = [0.1, 0.9]$\n- Protein U1: $h_{U1} = [0.2, 0.3]$\n- Protein U2: $h_{U2} = [0.6, 0.1]$\n\nGNN通过单个消息传递步骤执行更新，以找到 Protein V 的新特征向量（表示为 $h'_V$）。此过程包括两个阶段：\n\n1.  **聚合（Aggregation）：** 通过对 Protein V 的所有邻居的特征向量进行逐元素求和，创建一个聚合邻居向量 $h_{N(V)}$。\n2.  **更新（Update）：** 将聚合邻居向量 $h_{N(V)}$ 与 Protein V 的原始特征向量 $h_V$ 相加，然后对结果应用逐元素的修正线性单元（ReLU）激活函数，从而计算出新的特征向量 $h'_V$。ReLU函数对向量的每个分量定义为 $\\text{ReLU}(x) = \\max(0, x)$。\n\n计算 Protein V 的更新后特征向量 $h'_V$。", "solution": "我们已知三个蛋白质的初始特征向量：\n$$\nh_{V}=\\begin{bmatrix}0.1 & 0.9\\end{bmatrix},\\quad\nh_{U1}=\\begin{bmatrix}0.2 & 0.3\\end{bmatrix},\\quad\nh_{U2}=\\begin{bmatrix}0.6 & 0.1\\end{bmatrix}.\n$$\n聚合步骤：聚合邻居向量是邻居特征的逐元素和，\n$$\nh_{N(V)}=h_{U1}+h_{U2}\n=\\begin{bmatrix}0.2 & 0.3\\end{bmatrix}+\\begin{bmatrix}0.6 & 0.1\\end{bmatrix}\n=\\begin{bmatrix}0.8 & 0.4\\end{bmatrix}.\n$$\n更新步骤：将逐元素的ReLU函数应用于 $h_{V}$ 和 $h_{N(V)}$ 的和，\n$$\nh'_{V}=\\operatorname{ReLU}\\!\\big(h_{V}+h_{N(V)}\\big)\n=\\operatorname{ReLU}\\!\\left(\\begin{bmatrix}0.1 & 0.9\\end{bmatrix}+\\begin{bmatrix}0.8 & 0.4\\end{bmatrix}\\right)\n=\\operatorname{ReLU}\\!\\begin{bmatrix}0.9 & 1.3\\end{bmatrix}.\n$$\n由于每个分量都为正，因此对于两个分量都有 $\\operatorname{ReLU}(x)=x$，所以\n$$\nh'_{V}=\\begin{bmatrix}0.9 & 1.3\\end{bmatrix}.\n$$", "answer": "$$\\boxed{\\begin{bmatrix}0.9 & 1.3\\end{bmatrix}}$$", "id": "1436694"}, {"introduction": "GNN的强大之处在于通过堆叠多个计算层，使得信息能够在网络中传播得更远。本练习将展示这一多层信息传播的过程，追踪一个信号在简化的信号通路中的逐层传递。通过计算，您将直观地看到一个节点的最终表示是如何整合来自网络中更远处节点的信息的。", "problem": "在系统生物学的研究中，蛋白质信号通路通常被建模为图，其中蛋白质是节点，它们之间的相互作用是边。我们可以使用图神经网络（GNN）来学习这些蛋白质的表示，这些表示能够捕获其局部网络环境的信息。\n\n考虑一个由四个蛋白质 A、B、C 和 D 组成的简化线性信号通路。这可以表示为一个无向图，其中节点是蛋白质，边代表相互作用：(A, B)，(B, C) 和 (C, D)。\n\n最初，每个蛋白质都有一个标量特征值，代表一种特定的生物化学性质。设第 $k=0$ 层的初始特征值表示为 $h^{(0)}$。在我们的通路中，信号起源于蛋白质 A，因此其初始特征值为 $h_A^{(0)} = w$，而其他蛋白质处于基础状态，特征值为零：$h_B^{(0)} = 0$，$h_C^{(0)} = 0$ 和 $h_D^{(0)} = 0$。\n\nGNN 在每一层更新每个蛋白质的特征值。对于下一层 $k+1$ 的任何蛋白质（节点）$v$，其更新规则是其自身特征值和当前层 $k$ 中其直接邻居特征值的函数。具体来说，新的特征值是节点本身及其邻居特征值的平均值。在数学上，更新规则是：\n$$h_v^{(k+1)} = \\frac{1}{|\\mathcal{N}(v)| + 1} \\left( h_v^{(k)} + \\sum_{u \\in \\mathcal{N}(v)} h_u^{(k)} \\right)$$\n其中 $\\mathcal{N}(v)$ 是节点 $v$ 的邻居集合，而 $|\\mathcal{N}(v)|$ 是邻居的数量。\n\n计算网络在处理了整整三个 GNN 层的信息后，蛋白质 D 的特征值 $h_D$（即，求 $h_D^{(3)}$）。请用包含 $w$ 的符号表达式表示你的答案。", "solution": "我们将无向路径图 A-B-C-D 建模，其邻居集合为 $\\mathcal{N}(A)=\\{B\\}$，$\\mathcal{N}(B)=\\{A,C\\}$，$\\mathcal{N}(C)=\\{B,D\\}$ 和 $\\mathcal{N}(D)=\\{C\\}$。逐层的更新规则是\n$$\nh_v^{(k+1)}=\\frac{1}{|\\mathcal{N}(v)|+1}\\left(h_v^{(k)}+\\sum_{u\\in\\mathcal{N}(v)}h_u^{(k)}\\right),\n$$\n对于每个节点，该规则变为\n$$\nh_A^{(k+1)}=\\frac{h_A^{(k)}+h_B^{(k)}}{2},\\quad\nh_B^{(k+1)}=\\frac{h_B^{(k)}+h_A^{(k)}+h_C^{(k)}}{3},\\quad\nh_C^{(k+1)}=\\frac{h_C^{(k)}+h_B^{(k)}+h_D^{(k)}}{3},\\quad\nh_D^{(k+1)}=\\frac{h_D^{(k)}+h_C^{(k)}}{2}.\n$$\n初始特征值为\n$$\nh_A^{(0)}=w,\\quad h_B^{(0)}=0,\\quad h_C^{(0)}=0,\\quad h_D^{(0)}=0,\n$$\n我们逐层进行计算。\n\n在 $k=1$ 时：\n$$\nh_A^{(1)}=\\frac{w+0}{2}=\\frac{w}{2},\\quad\nh_B^{(1)}=\\frac{0+w+0}{3}=\\frac{w}{3},\\quad\nh_C^{(1)}=\\frac{0+0+0}{3}=0,\\quad\nh_D^{(1)}=\\frac{0+0}{2}=0.\n$$\n\n在 $k=2$ 时：\n$$\nh_A^{(2)}=\\frac{\\frac{w}{2}+\\frac{w}{3}}{2}=\\frac{5w}{12},\\quad\nh_B^{(2)}=\\frac{\\frac{w}{3}+\\frac{w}{2}+0}{3}=\\frac{5w}{18},\\quad\nh_C^{(2)}=\\frac{0+\\frac{w}{3}+0}{3}=\\frac{w}{9},\\quad\nh_D^{(2)}=\\frac{0+0}{2}=0.\n$$\n\n在 $k=3$ 时：\n$$\nh_A^{(3)}=\\frac{\\frac{5w}{12}+\\frac{5w}{18}}{2}=\\frac{25w}{72},\\quad\nh_B^{(3)}=\\frac{\\frac{5w}{18}+\\frac{5w}{12}+\\frac{w}{9}}{3}=\\frac{29w}{108},\\quad\nh_C^{(3)}=\\frac{\\frac{w}{9}+\\frac{5w}{18}+0}{3}=\\frac{7w}{54},\\quad\nh_D^{(3)}=\\frac{0+\\frac{w}{9}}{2}=\\frac{w}{18}.\n$$\n\n因此，三层之后蛋白质 D 的特征值是 $h_D^{(3)}=\\frac{w}{18}$。", "answer": "$$\\boxed{\\frac{w}{18}}$$", "id": "1436705"}]}