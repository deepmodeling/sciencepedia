{"hands_on_practices": [{"introduction": "这个入门练习将带你亲手体验持久同源性的基本构造过程。通过为一个代表蛋白质位置的简单点集构建Vietoris-Rips滤子，你将直观地看到随着尺度参数 $\\epsilon$ 的变化，离散的数据点如何生长成复杂的拓扑形状。这项实践是理解拓扑特征（如连通分支和环）如何“诞生”和“消亡”的关键第一步。[@problem_id:1457473]", "problem": "在系统生物学中，拓扑数据分析被用于研究细胞内分子的空间组织。考虑一个简化模型，其中四个关键信号蛋白的位置已通过超分辨率显微技术确定。这些蛋白被标记为P1、P2、P3和P4，并被视为二维平面上的点，其坐标如下（单位：纳米，nm）：\n- P1: (0, 0)\n- P2: (3, 0)\n- P3: (0, 4)\n- P4: (3, 4)\n\n为了分析这些蛋白的聚类情况，我们可以构建一系列称为Vietoris-Rips滤子的单纯复形。一个单纯复形是点（0-单纯形）、连接点对的边（1-单纯形）、连接点三元组的填充三角形（2-单纯形）及其高维对应物的集合。\n\n对于给定的半径 $\\epsilon$，Vietoris-Rips (VR) 复形的构建方式如下：一组$k+1$个蛋白位置形成一个$k$-单纯形，当且仅当该组中任意两个位置之间的欧几里得距离小于或等于$2\\epsilon$。该滤子是通过逐渐增加$\\epsilon$而生成的一系列VR复形。\n\n滤子中每个复形的拓扑结构可以通过其贝蒂数来刻画。就我们的目的而言，我们关心的是：\n- $\\beta_0$：复形中连通分量的数量。\n- $\\beta_1$：复形中一维环或“孔洞”的数量。\n\n对于三个特定的滤子值$\\epsilon_1 = 1.6 \\text{ nm}$、$\\epsilon_2 = 2.1 \\text{ nm}$和$\\epsilon_3 = 2.6 \\text{ nm}$，请确定在每个步骤中得到的Vietoris-Rips复形的贝蒂数$\\beta_0$和$\\beta_1$。\n\n请将您的六个结果以$(\\beta_0(\\epsilon_1), \\beta_1(\\epsilon_1), \\beta_0(\\epsilon_2), \\beta_1(\\epsilon_2), \\beta_0(\\epsilon_3), \\beta_1(\\epsilon_3))$的顺序表示为单个行矩阵。", "solution": "该问题要求计算在三个不同半径$\\epsilon$下，由四个点P1(0, 0)、P2(3, 0)、P3(0, 4)和P4(3, 4)构建的Vietoris-Rips (VR) 复形的贝蒂数$\\beta_0$和$\\beta_1$。\n\n首先，我们计算所有点对之间的欧几里得距离。令$d(Pi, Pj)$为蛋白$i$和蛋白$j$之间的距离。\n- $d(P1, P2) = \\sqrt{(3-0)^2 + (0-0)^2} = \\sqrt{9} = 3$\n- $d(P1, P3) = \\sqrt{(0-0)^2 + (4-0)^2} = \\sqrt{16} = 4$\n- $d(P1, P4) = \\sqrt{(3-0)^2 + (4-0)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$\n- $d(P2, P3) = \\sqrt{(0-3)^2 + (4-0)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$\n- $d(P2, P4) = \\sqrt{(3-3)^2 + (4-0)^2} = \\sqrt{16} = 4$\n- $d(P3, P4) = \\sqrt{(3-0)^2 + (4-4)^2} = \\sqrt{9} = 3$\n\n唯一的距离集合是$\\{3, 4, 5\\}$。根据VR复形的定义，如果两点之间的距离$d$小于或等于直径$2\\epsilon$，则这两点之间存在一条边（1-单纯形）。如果三点之间的所有三个点对距离都$\\le 2\\epsilon$，则这三点上存在一个三角形（2-单纯形）。\n\n**步骤1：对$\\epsilon_1 = 1.6$ nm的分析**\n\n形成单纯形的条件是$d \\le 2\\epsilon_1 = 2 \\times 1.6 = 3.2$。\n我们检查哪些点对距离满足此条件：\n- $d(P1, P2) = 3 \\le 3.2$ (边P1-P2形成)\n- $d(P3, P4) = 3 \\le 3.2$ (边P3-P4形成)\n- 所有其他距离（4和5）都大于3.2。\n\n在$\\epsilon_1=1.6$时，复形由四个顶点（0-单纯形）和两条边（1-单纯形）：{P1, P2}和{P3, P4}组成。\n- 为了找到$\\beta_0$，我们计算连通分量的数量。这些点形成两个独立的连通分量：一个包含{P1, P2}，另一个包含{P3, P4}。因此，$\\beta_0(\\epsilon_1) = 2$。\n- 为了找到$\\beta_1$，我们寻找一维孔洞（环）。该复形中没有环。因此，$\\beta_1(\\epsilon_1) = 0$。\n\n**步骤2：对$\\epsilon_2 = 2.1$ nm的分析**\n\n形成单纯形的条件是$d \\le 2\\epsilon_2 = 2 \\times 2.1 = 4.2$。\n我们检查哪些点对距离满足此条件：\n- 距离为3的：$d(P1, P2)$和$d(P3, P4)$均$\\le 4.2$。\n- 距离为4的：$d(P1, P3)$和$d(P2, P4)$均$\\le 4.2$。\n- 距离为5的：$d(P1, P4)$和$d(P2, P3)$均$> 4.2$。\n\n形成的边有 (P1, P2)、(P3, P4)、(P1, P3) 和 (P2, P4)。\n- 为了找到$\\beta_0$，我们检查连通性。边(P1, P3)连接了上一步中的两个连通分量。例如，P1连接到P3，P3连接到P4，P4连接到P2（通过P1和P3）。现在所有四个点都在一个单一的连通分量中。因此，$\\beta_0(\\epsilon_2) = 1$。\n- 为了找到$\\beta_1$，我们寻找孔洞。这四条边形成一个环：P1-P3-P4-P2-P1。这是一个潜在的一维孔洞。如果这个环不是2-单纯形（三角形）集合的边界，那么孔洞就存在。我们需要检查是否有任何三角形形成。\n    - 三角形{P1, P2, P3}？需要$d(P2, P3) = 5$，大于4.2。不形成。\n    - 三角形{P1, P3, P4}？需要$d(P1, P4) = 5$，大于4.2。不形成。\n    - 三角形{P1, P2, P4}？需要$d(P1, P4) = 5$，大于4.2。不形成。\n    - 三角形{P2, P4, P3}？需要$d(P2, P3) = 5$，大于4.2。不形成。\n由于没有形成2-单纯形，这个环没有被填充。它代表一个真正的一维孔洞。因此，$\\beta_1(\\epsilon_2) = 1$。\n\n**步骤3：对$\\epsilon_3 = 2.6$ nm的分析**\n\n形成单纯形的条件是$d \\le 2\\epsilon_3 = 2 \\times 2.6 = 5.2$。\n我们检查哪些点对距离满足此条件：\n- 距离为3、4和5的所有距离都$\\le 5.2$。\n这意味着所有可能的点对都由一条边连接。该图是完全图$K_4$。\n- 由于图是连通的，$\\beta_0(\\epsilon_3) = 1$。\n- 为了找到$\\beta_1$，我们检查上一步中的孔洞是否已被填充。我们寻找2-单纯形。\n    - 三角形{P1, P2, P3}：距离为{3, 4, 5}。所有距离都$\\le 5.2$。这个2-单纯形形成。\n    - 三角形{P1, P3, P4}：距离为{4, 5, 3}。所有距离都$\\le 5.2$。这个2-单纯形形成。\n    - 三角形{P2, P4, P3}：距离为{4, 5, 3}。所有距离都$\\le 5.2$。这个2-单纯形形成。\n    - 三角形{P1, P2, P4}：距离为{3, 5, 4}。所有距离都$\\le 5.2$。这个2-单纯形形成。\n上一步中的环P1-P3-P4-P2-P1现在被填充了。例如，这个环可以看作是两个三角形{P1, P3, P4}和{P1, P4, P2}的并集的边界。由于这个环现在是一个2-链（2-单纯形的和）的边界，它在同调意义下不再代表一个孔洞。事实上，这四个点以及它们所有的连接边和面构成了一个四面体（一个3-单纯形），它是可收缩的，没有孔洞。因此，$\\beta_1(\\epsilon_3) = 0$。\n\n结果总结：\n- 对于$\\epsilon_1 = 1.6$：$(\\beta_0, \\beta_1) = (2, 0)$\n- 对于$\\epsilon_2 = 2.1$：$(\\beta_0, \\beta_1) = (1, 1)$\n- 对于$\\epsilon_3 = 2.6$：$(\\beta_0, \\beta_1) = (1, 0)$\n\n要求的最终答案是行矩阵$(\\beta_0(\\epsilon_1), \\beta_1(\\epsilon_1), \\beta_0(\\epsilon_2), \\beta_1(\\epsilon_2), \\beta_0(\\epsilon_3), \\beta_1(\\epsilon_3))$。\n这对应于$(2, 0, 1, 1, 1, 0)$。", "answer": "$$\\boxed{\\begin{pmatrix} 2  0  1  1  1  0 \\end{pmatrix}}$$", "id": "1457473"}, {"introduction": "一旦我们从数据中计算出持久性，结果通常会以持久性条形码的形式呈现。这个练习将重点从“构建”转向“解读”：你将学习如何阅读条形码来回答一个具体的生物学问题。这项实践旨在训练你将抽象的拓扑数据（“条形”的生灭）转化为关于细胞聚类等现实世界现象的有意义的结论。[@problem_id:1457508]", "problem": "一位系统生物学家正在使用拓扑数据分析（TDA）的技术来分析一个发育中的细胞集落的空间组织。在某个特定时间点，记录了单个细胞的位置。为了理解其聚类行为，计算了第0维同调群（$H_0$）的持续性条形码。该条形码追踪了随着“连接半径”$\\epsilon$的增加，连通分量（细胞簇）的形成与合并过程。\n\n条形码中的每个条都由一对值 $(\\epsilon_{\\text{birth}}, \\epsilon_{\\text{death}})$ 表示，其中：\n- $\\epsilon_{\\text{birth}}$ 是一个新的、孤立的簇出现的半径。对于本分析，单个细胞从一开始就存在，因此所有主要分量的 $\\epsilon_{\\text{birth}} = 0$。\n- $\\epsilon_{\\text{death}}$ 是该簇与另一个更早出现的簇合并，从而作为一个独立的分量“消亡”的半径。\n\n有一个分量，在所有细胞都连接起来后代表整个集落，它会无限持续存在。这由一个无穷大的消亡时间表示。\n\n这位生物学家获得了以下（诞生，消亡）对的集合，其中半径 $\\epsilon$ 以微米（$\\mu$m）为单位测量：\n`{(0, 1.2), (0, 4.5), (0, 2.8), (0, 9.1), (0, 0.7), (0, 3.6), (0, infinity)}`\n\n根据这些持续性数据，当连接半径恰好为 $\\epsilon = 3.0$ $\\mu$m 时，存在多少个不同的细胞簇？", "solution": "我们分析 $H_0$ 持续性条形码，其中每个连通分量由一个区间 $(\\epsilon_{\\text{birth}}, \\epsilon_{\\text{death}})$ 表示。在给定的尺度 $\\epsilon$ 下，连通分量的数量等于其区间包含 $\\epsilon$ 的条的数量，依据的惯例是：当 $\\epsilon_{\\text{birth}} \\le \\epsilon   \\epsilon_{\\text{death}}$ 时，一个条是“存活”的，因为分量在 $\\epsilon = \\epsilon_{\\text{death}}$ 时与一个更早的分量合并而消亡。\n\n形式上，在尺度 $\\epsilon$ 下的簇的数量为\n$$\nN(\\epsilon) = \\left|\\left\\{i : \\epsilon_{\\text{birth},i} \\le \\epsilon   \\epsilon_{\\text{death},i}\\right\\}\\right|.\n$$\n鉴于所有主要分量的 $\\epsilon_{\\text{birth}} = 0$，这可以简化为\n$$\nN(\\epsilon) = \\left|\\left\\{i : \\epsilon   \\epsilon_{\\text{death},i}\\right\\}\\right|.\n$$\n\n给出的消亡时间为 $\\{0.7, 1.2, 2.8, 3.6, 4.5, 9.1, \\infty\\}$。在 $\\epsilon = 3.0$ 时，满足 $\\epsilon_{\\text{death}} \\le 3.0$ 的分量已经消亡，而满足 $\\epsilon_{\\text{death}} > 3.0$ 的分量仍然存活。大于 $3.0$ 的消亡时间是 $3.6$、$4.5$、$9.1$ 和 $\\infty$。因此，\n$$\nN(3.0) = 4.\n$$\n因此，在 $\\epsilon = 3.0$ 时，有 $4$ 个不同的簇。", "answer": "$$\\boxed{4}$$", "id": "1457508"}, {"introduction": "持久同源性的最终目标通常不是生成漂亮的图片，而是提取可用于进一步分析的定量特征。这个高级练习展示了持久同源性在现代系统生物学研究中的一个强大应用：模型校准。你将使用从持久性图中提取的特征来优化一个生物模拟模型的参数，从而学习如何利用拓扑数据来连接实验观察与理论模型。[@problem_id:1457466]", "problem": "一位系统生物学研究员正在开发一个计算模型，以理解组织形态发生，即生物组织形成形状的过程。他们正在使用一种随机的基于智能体的模型（Agent-Based Model, ABM），其中单个细胞被模拟为基于一组规则相互作用的智能体。他们模型中的一个关键未知数是一个无量纲参数 $\\lambda$，它代表细胞间粘附的强度。\n\n为了校准这个参数，该研究员使用拓扑数据分析。通过使用持续同调来分析来自模拟和实验的细胞空间排列，该方法可以跨越一系列空间尺度跟踪拓扑特征（如连通分量或孔洞）的诞生和消亡。这个过程在一个称为持续性图的二维平面上生成一组点。对于这个问题，图中的一个主导点，记为 $(b, d)$，被认为是组织大尺度结构的主要描述符。这里，$b$ 是特征的“诞生”尺度，$d$ 是其“消亡”尺度。\n\n由于ABM的随机性，对于给定的 $\\lambda$ 值，模拟出的主导点 $(b, d)$ 在每次运行中都会变化。这些点的分布均值 $\\mu_{sim}(\\lambda) = (b_{sim}(\\lambda), d_{sim}(\\lambda))$，已经通过将线性函数拟合到大量的模拟数据中得到了表征：\n$b_{sim}(\\lambda) = \\alpha_b \\lambda + \\beta_b$\n$d_{sim}(\\lambda) = \\alpha_d \\lambda + \\beta_d$\n\n同时，对一组真实组织样本的显微镜图像进行了并行分析。这个实验分析产生了一个平均主导持续性点 $\\mu_{exp} = (b_{exp}, d_{exp})$。目标是找到粘附参数的最优值 $\\lambda_{opt}$，使得模拟输出与实验观察结果最佳匹配。“最佳拟合”的标准是最小化平均模拟点和平均实验点之间的平方欧几里得距离 $L(\\lambda) = \\|\\mu_{sim}(\\lambda) - \\mu_{exp}\\|^2$。\n\n给定以下经验确定的常数和实验结果：\n- 模型常数：$\\alpha_b = 0.50$, $\\beta_b = 1.00$, $\\alpha_d = -0.80$, $\\beta_d = 12.0$\n- 实验点：$\\mu_{exp} = (b_{exp}, d_{exp}) = (3.00, 7.00)$\n\n计算粘附参数的最优值 $\\lambda_{opt}$。将您的最终答案四舍五入至三位有效数字。", "solution": "模拟的平均主导点为 $\\mu_{sim}(\\lambda) = (b_{sim}(\\lambda), d_{sim}(\\lambda))$，其中\n$$\nb_{sim}(\\lambda) = \\alpha_{b}\\lambda + \\beta_{b}, \\quad d_{sim}(\\lambda) = \\alpha_{d}\\lambda + \\beta_{d}.\n$$\n要最小化的损失是到 $\\mu_{exp} = (b_{exp}, d_{exp})$ 的平方欧几里得距离：\n$$\nL(\\lambda) = \\left(\\alpha_{b}\\lambda + \\beta_{b} - b_{exp}\\right)^{2} + \\left(\\alpha_{d}\\lambda + \\beta_{d} - d_{exp}\\right)^{2}.\n$$\n将 $L(\\lambda)$ 对 $\\lambda$ 求导，并令其等于零以求最小值点：\n$$\n\\frac{dL}{d\\lambda} = 2\\alpha_{b}\\left(\\alpha_{b}\\lambda + \\beta_{b} - b_{exp}\\right) + 2\\alpha_{d}\\left(\\alpha_{d}\\lambda + \\beta_{d} - d_{exp}\\right) = 0.\n$$\n整理可得\n$$\n\\left(\\alpha_{b}^{2} + \\alpha_{d}^{2}\\right)\\lambda + \\alpha_{b}\\left(\\beta_{b} - b_{exp}\\right) + \\alpha_{d}\\left(\\beta_{d} - d_{exp}\\right) = 0,\n$$\n所以最优参数是\n$$\n\\lambda_{opt} = -\\frac{\\alpha_{b}\\left(\\beta_{b} - b_{exp}\\right) + \\alpha_{d}\\left(\\beta_{d} - d_{exp}\\right)}{\\alpha_{b}^{2} + \\alpha_{d}^{2}}.\n$$\n代入给定值 $\\alpha_{b} = 0.50$, $\\beta_{b} = 1.00$, $\\alpha_{d} = -0.80$, $\\beta_{d} = 12.0$, $b_{exp} = 3.00$, $d_{exp} = 7.00$：\n$$\n\\beta_{b} - b_{exp} = -2.00,\\quad \\beta_{d} - d_{exp} = 5.00,\n$$\n$$\n\\alpha_{b}\\left(\\beta_{b} - b_{exp}\\right) = 0.50 \\times (-2.00) = -1.00,\\quad \\alpha_{d}\\left(\\beta_{d} - d_{exp}\\right) = (-0.80)\\times 5.00 = -4.00,\n$$\n$$\n\\alpha_{b}^{2} + \\alpha_{d}^{2} = (0.50)^{2} + (-0.80)^{2} = 0.25 + 0.64 = 0.89.\n$$\n因此，\n$$\n\\lambda_{opt} = -\\frac{-1.00 - 4.00}{0.89} = \\frac{5.00}{0.89} = \\frac{500}{89} \\approx 5.6179775.\n$$\n四舍五入到三位有效数字，$\\lambda_{opt} \\approx 5.62$。", "answer": "$$\\boxed{5.62}$$", "id": "1457466"}]}