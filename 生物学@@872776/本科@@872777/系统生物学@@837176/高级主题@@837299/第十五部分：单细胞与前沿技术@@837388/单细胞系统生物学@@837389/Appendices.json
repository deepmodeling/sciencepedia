{"hands_on_practices": [{"introduction": "本练习 ([@problem_id:1466140]) 将介绍生物系统中稳态 (steady-state) 的基本概念。我们将使用一个简单的蛋白质生成和降解模型，来理解这两个过程之间的平衡如何决定细胞内蛋白质分子的平均数量，这是系统生物学的一个核心原理。", "problem": "在合成生物学领域，一位研究人员正在研究一种经过基因工程改造以产生特定蛋白质的单细胞生物。该蛋白质的产生和降解可以用一个简单的随机模型来描述。新的蛋白质分子以恒定的平均速率 $k_s$ 合成。每个现有的蛋白质分子在单位时间内都有一个恒定的降解概率，该过程由一级速率常数 $\\gamma_p$ 描述。\n\n该系统的实验测量确定了以下参数：\n- 平均合成速率 $k_s$ 为每分钟 120 个分子。\n- 降解速率常数 $\\gamma_p$ 为每小时 3.0。\n\n假设系统已达到统计稳态，计算单个细胞中存在的蛋白质分子的期望（平均）数量。", "solution": "设 $N(t)$ 表示蛋白质拷贝数，并设 $n(t) = \\mathbb{E}[N(t)]$ 为其平均值。对于速率为 $k_{s}$ 的零级合成（与 $N$ 无关）和单分子速率常数为 $\\gamma_{p}$ 的一级降解，平均值遵循以下线性常微分方程：\n$$\n\\frac{dn}{dt} = k_{s} - \\gamma_{p}\\,n.\n$$\n在统计稳态下，$\\frac{dn}{dt} = 0$，因此：\n$$\n0 = k_{s} - \\gamma_{p}\\,n_{\\text{ss}} \\quad \\Rightarrow \\quad n_{\\text{ss}} = \\frac{k_{s}}{\\gamma_{p}}.\n$$\n\n为了使用给定参数计算 $n_{\\text{ss}}$，我们必须使用一致的时间单位。将 $\\gamma_{p} = 3.0 \\text{ per hour}$ 转换为以分钟为单位，得到：\n$$\n\\gamma_{p} = \\frac{3}{60} \\text{ per minute} = \\frac{1}{20} \\text{ per minute}.\n$$\n当 $k_{s} = 120 \\text{ molecules per minute}$ 时，稳态平均值为：\n$$\nn_{\\text{ss}} = \\frac{120}{\\frac{1}{20}} = 120 \\times 20 = 2400.\n$$\n因此，稳态下蛋白质分子的期望数量为 2400。", "answer": "$$\\boxed{2400}$$", "id": "1466140"}, {"introduction": "在理解单个基因表达的基础上，本练习 ([@problem_id:1466136]) 将演示如何综合多个基因的信息来评估整个生物通路的活性。你将学习一种计算通路活性得分的实用方法，这是一种解读复杂的单细胞数据集和揭示代谢异质性的常用技术。", "problem": "一位系统生物学家正在分析一个小型单细胞RNA测序（scRNA-seq）数据集，以了解代谢异质性。该数据集包含四个不同细胞中几个基因的表达计数。这位生物学家希望通过计算通路活性得分，来量化每个细胞内一个特定代谢通路（我们称之为“代谢通路X”）的活性。\n\n基因 $g$ 在细胞 $c$ 中的表达计数数据 $E_{gc}$ 如下表所示：\n\n| 基因   | 细胞1 | 细胞2 | 细胞3 | 细胞4 |\n|:-------|:------|:------|:------|:------|\n| GCK    | 12    | 10    | 50    | 15    |\n| PFK    | 8     | 9     | 35    | 6     |\n| PKM    | 24    | 28    | 70    | 20    |\n| ACTB   | 150   | 155   | 145   | 160   |\n\n代谢通路X由基因集合 $\\{\\text{GCK}, \\text{PFK}, \\text{PKM}\\}$ 定义。基因ACTB是一个看家基因，不属于该通路。\n\n对于一个给定的细胞 $c$，其通路活性得分 $S_c$ 通过以下三步程序计算：\n1. 对于每个基因 $g$ 和细胞 $c$，从原始表达计数 $E_{gc}$ 计算对数转换后的表达值 $X_{gc}$，使用的公式为 $X_{gc} = \\ln(E_{gc} + 1)$。\n2. 对于属于代谢通路X的每个基因 $g$，通过计算其在所有四个细胞中的 $X_{gc}$ 值的算术平均值，来得到其平均对数转换表达值 $\\mu_g$。\n3. 某个特定细胞（例如细胞 $c^*$）的通路活性得分，是通过计算该细胞中所有属于代谢通路X的基因 $g$ 的中心化对数表达值 $(X_{gc^*} - \\mu_g)$ 的算术平均值得出的。\n\n使用此程序，计算细胞3的通路活性得分。将您的最终答案四舍五入到四位有效数字。", "solution": "我们已知原始表达计数 $E_{gc}$ 以及一个三步程序，用于计算细胞3中由基因 $\\{ \\text{GCK}, \\text{PFK}, \\text{PKM} \\}$ 构成的代谢通路X的活性得分。\n\n步骤1：对于每个基因 $g$ 和细胞 $c$，计算 $X_{gc} = \\ln(E_{gc} + 1)$。\n对于这三个基因在四个细胞中的情况：\n数值（自然对数）：\n$\\ln(13)=2.564949357$，$\\ln(11)=2.397895273$，$\\ln(51)=3.931825633$，$\\ln(16)=2.772588722$；\n$\\ln(9)=2.197224577$，$\\ln(10)=2.302585093$，$\\ln(36)=3.583518938$，$\\ln(7)=1.945910149$；\n$\\ln(25)=3.218875825$，$\\ln(29)=3.367295830$，$\\ln(71)=4.262679877$，$\\ln(21)=3.044522438$。\n\n步骤2：对于每个通路基因 $g$，计算其在所有细胞中的平均对数表达值：\n$$\n\\mu_{\\text{GCK}}=\\frac{\\ln(13)+\\ln(11)+\\ln(51)+\\ln(16)}{4}=\\frac{11.667258985}{4}=2.916814746,\n$$\n$$\n\\mu_{\\text{PFK}}=\\frac{\\ln(9)+\\ln(10)+\\ln(36)+\\ln(7)}{4}=\\frac{10.029238758}{4}=2.507309689,\n$$\n$$\n\\mu_{\\text{PKM}}=\\frac{\\ln(25)+\\ln(29)+\\ln(71)+\\ln(21)}{4}=\\frac{13.893373970}{4}=3.473343492.\n$$\n\n步骤3：计算细胞3的通路活性得分，即通路基因的中心化对数表达值的平均值：\n$$\nS_{\\text{Cell3}}=\\frac{1}{3}\\left[\\left(X_{\\text{GCK},3}-\\mu_{\\text{GCK}}\\right)+\\left(X_{\\text{PFK},3}-\\mu_{\\text{PFK}}\\right)+\\left(X_{\\text{PKM},3}-\\mu_{\\text{PKM}}\\right)\\right].\n$$\n代入细胞3的值 $X_{\\text{GCK},3}=\\ln(51)=3.931825633$，$X_{\\text{PFK},3}=\\ln(36)=3.583518938$，$X_{\\text{PKM},3}=\\ln(71)=4.262679877$，我们得到中心化项：\n$$\n3.931825633-2.916814746=1.015010886,\n$$\n$$\n3.583518938-2.507309689=1.076209249,\n$$\n$$\n4.262679877-3.473343492=0.789336385.\n$$\n因此，\n$$\nS_{\\text{Cell3}}=\\frac{1}{3}\\left(1.015010886+1.076209249+0.789336385\\right)=\\frac{2.880556520}{3}=0.960185507.\n$$\n四舍五入到四位有效数字，得到 0.9602。", "answer": "$$\\boxed{0.9602}$$", "id": "1466136"}, {"introduction": "单细胞数据往往充满噪声且不完整。本练习 ([@problem_id:1466146]) 探讨了一个关键挑战：数据“脱落”(dropout) 现象。通过一个简化的插补 (imputation) 算法，你将亲眼看到为“修复”数据而设计的方法如何无意中引入人为的相关性，这凸显了对生物信息学流程进行批判性评估的重要性。", "problem": "在单细胞RNA测序 (scRNA-seq) 中，测量了数千个单个细胞中数千个基因的表达水平。这项技术的一个常见问题是“脱扣”（dropout）现象，即细胞中实际表达的基因未被检测到，导致最终数据矩阵中出现零计数。这些技术性假象会使下游分析复杂化，例如确定基因之间的关系。\n\n为了解决这个问题，生物信息学家通常使用插补算法来估计缺失值。然而，这些方法有时会引入原始生物系统中不存在的新的、人为的关系。\n\n考虑一个简化的 scRNA-seq 实验，测量四个细胞（细胞 1、细胞 2、细胞 3 和细胞 4）中两个基因（基因 A 和基因 B）的表达。由于脱扣现象，观察到的表达矩阵如下：\n\n| | 基因 A | 基因 B |\n| :--- | :---: | :---: |\n| **细胞 1** | 10 | 0 |\n| **细胞 2** | 10 | 10 |\n| **细胞 3** | 0 | 1 |\n| **细胞 4**| 1 | 10 |\n\n您的任务是对此矩阵应用一个简单的插补算法。该算法是 k-近邻 (k-NN) 插补的一个简化版本，其中 $k=1$。对于矩阵中的每个零值条目，该算法按以下步骤进行：\n1. 识别出包含零值的细胞的单个最近邻。细胞之间的距离是使用其观察到的表达向量（即表中的相应行）计算的标准欧几里得距离。\n2. 用识别出的最近邻细胞中该基因的表达值替换该零值。\n\n对所有零值条目执行此插补，以生成一个密集的、经过插补的矩阵。完成插补后，计算基因 A 和基因 B 表达之间的皮尔逊相关系数。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "设四个细胞的观察表达向量为：\n$$\nx_{1}=(10,0),\\quad x_{2}=(10,10),\\quad x_{3}=(0,1),\\quad x_{4}=(1,10).\n$$\n细胞 $i$ 和 $j$ 之间的欧几里得距离是：\n$$\nd(x_{i},x_{j})=\\sqrt{(A_{i}-A_{j})^{2}+(B_{i}-B_{j})^{2}}.\n$$\n\n对于细胞 1（其基因 B 的值为零），计算距离：\n$$\nd(x_{1},x_{2})=\\sqrt{(10-10)^{2}+(0-10)^{2}}=10,\n$$\n$$\nd(x_{1},x_{3})=\\sqrt{(10-0)^{2}+(0-1)^{2}}=\\sqrt{101},\n$$\n$$\nd(x_{1},x_{4})=\\sqrt{(10-1)^{2}+(0-10)^{2}}=\\sqrt{181}.\n$$\n最近邻是细胞 2。插补 $B_{1}\\leftarrow B_{2}=10$。\n\n对于细胞 3（其基因 A 的值为零），计算距离：\n$$\nd(x_{3},x_{1})=\\sqrt{(0-10)^{2}+(1-0)^{2}}=\\sqrt{101},\n$$\n$$\nd(x_{3},x_{2})=\\sqrt{(0-10)^{2}+(1-10)^{2}}=\\sqrt{181},\n$$\n$$\nd(x_{3},x_{4})=\\sqrt{(0-1)^{2}+(1-10)^{2}}=\\sqrt{82}.\n$$\n最近邻是细胞 4。插补 $A_{3}\\leftarrow A_{4}=1$。\n\n因此，插补后的矩阵是：\n$$\n(A,B)=\\bigl[(10,10),\\ (10,10),\\ (1,1),\\ (1,10)\\bigr].\n$$\n\n设向量为：\n$$\n\\mathbf{a}=(10,10,1,1),\\quad \\mathbf{b}=(10,10,1,10).\n$$\n皮尔逊相关系数为：\n$$\nr=\\frac{\\sum_{i=1}^{4}(a_{i}-\\bar{a})(b_{i}-\\bar{b})}{\\sqrt{\\sum_{i=1}^{4}(a_{i}-\\bar{a})^{2}}\\;\\sqrt{\\sum_{i=1}^{4}(b_{i}-\\bar{b})^{2}}},\n$$\n其中均值为：\n$$\n\\bar{a}=\\frac{10+10+1+1}{4}=\\frac{22}{4}=5.5,\n$$\n$$\n\\bar{b}=\\frac{10+10+1+10}{4}=\\frac{31}{4}=7.75.\n$$\n计算总和：\n$$\n\\sum(a_{i}-\\bar{a})(b_{i}-\\bar{b})=(4.5)(2.25)+(4.5)(2.25)+(-4.5)(-6.75)+(-4.5)(2.25)=40.5,\n$$\n$$\n\\sum(a_{i}-\\bar{a})^{2}=4\\cdot(4.5)^{2}=81,\n$$\n$$\n\\sum(b_{i}-\\bar{b})^{2}=3\\cdot(2.25)^{2}+(-6.75)^{2}=60.75.\n$$\n因此，\n$$\nr=\\frac{40.5}{\\sqrt{81\\cdot 60.75}}=\\frac{40.5}{9\\sqrt{60.75}}.\n$$\n注意 $60.75=\\frac{243}{4}$，所以：\n$$\n\\sqrt{81\\cdot 60.75}=\\sqrt{\\frac{81\\cdot 243}{4}}=\\frac{81\\sqrt{3}}{2},\n$$\n$$\nr=\\frac{81/2}{81\\sqrt{3}/2}=\\frac{1}{\\sqrt{3}}.\n$$\n四舍五入到三位有效数字得到 0.577。", "answer": "$$\\boxed{0.577}$$", "id": "1466146"}]}