{"hands_on_practices": [{"introduction": "单细胞 RNA 测序分析的第一步是严格的质量控制，以确保后续分析的可靠性。本练习模拟了一个关键的质控环节：根据线粒体基因的表达比例过滤掉低质量细胞，这是衡量细胞健康状况的常用指标。通过这个练习，你将学会如何应用一个标准的统计学方法来设定客观的过滤阈值，这是任何 scRNA-seq 数据分析流程中必不可少的基础技能。[@problem_id:1465907]", "problem": "在单细胞RNA测序 (scRNA-seq) 实验中，一个关键的质量控制步骤是过滤掉低质量的细胞。细胞健康状况不佳（例如细胞应激或细胞膜破裂）的一个常见指标是源自线粒体的信使RNA (mRNA) 转录本所占的比例异常地高。健康、完整的细胞通常具有较低的线粒体基因表达百分比。\n\n一位生物信息学家分析了一个大的细胞群体，并总结了线粒体基因百分比的分布情况。统计摘要显示，该分布的第一四分位数 (Q1) 为 3.5%，第三四分位数 (Q3) 为 9.0%。\n\n为了客观地移除线粒体含量高的异常细胞，一种常见的统计方法是基于四分位距 (IQR) 设定一个上限阈值。该规则将此阈值定义为 $Q3 + 1.5 \\times IQR$，其中 $IQR = Q3 - Q1$。任何线粒体基因百分比超过此阈值的细胞都被视为低质量细胞，并从后续分析中移除。\n\n计算此过滤阈值的数值。将最终答案表示为小数，并四舍五入到三位有效数字。", "solution": "异常值上限阈值由规则 $Q3 + 1.5 \\times IQR$ 定义，其中 $IQR = Q3 - Q1$。\n\n给定 $Q1 = 0.035$ 和 $Q3 = 0.090$，计算四分位距：\n$$\nIQR = Q3 - Q1 = 0.090 - 0.035 = 0.055.\n$$\n计算异常值阈值：\n$$\n\\text{阈值} = Q3 + 1.5 \\times IQR = 0.090 + 1.5 \\times 0.055 = 0.090 + 0.0825 = 0.1725.\n$$\n四舍五入到三位有效数字，阈值为 $0.173$。", "answer": "$$\\boxed{0.173}$$", "id": "1465907"}, {"introduction": "在单细胞数据分析中，我们经常同时使用降维可视化（如 UMAP）和差异表达基因分析来解释细胞异质性。然而，当这两种分析的结果看似矛盾时，就需要深入的生物学解读。这个练习提出了一个经典场景：UMAP 图上邻近的细胞簇之间却存在大量差异表达基因，旨在训练你批判性地思考 UMAP 可视化的真正含义，并理解它如何与差异表达分析相结合，从而揭示细胞状态转变等连续的生物学过程。[@problem_id:1465887]", "problem": "在单细胞基因组学领域，一位研究人员正在使用单细胞RNA测序技术分析一个免疫细胞数据集。使用的主要可视化工具是均匀流形近似与投影（Uniform Manifold Approximation and Projection, UMAP），它将高维的基因表达数据（每个细胞约20,000个基因的测量值）降维到一个二维图中。在这个图上，具有相似表达谱的细胞被聚类成簇。\n\n研究人员观察到两个不同的细胞簇，即簇A和簇B，它们在UMAP图上紧密相邻，彼此之间只有很小的间隙。基于这种邻近性，最初的假设是这两个簇代表非常相似的细胞状态。然而，随后对簇A和簇B进行的差异基因表达分析显示，有超过500个基因的表达水平存在统计学上的显著差异（经过多重检验校正后）。\n\n鉴于这两个看似矛盾的结果——在UMAP图上位置邻近但存在大量差异表达基因——最可能的生物学解释是什么？\n\nA. 差异表达分析存在缺陷。UMAP图上簇的邻近性是高度生物学相似性的确切证据，这意味着差异表达基因应该非常少，甚至没有。\n\nB. 这两个簇代表功能上相同的细胞，数百个差异表达基因都是由单细胞数据固有的统计噪声导致的假阳性结果。\n\nC. UMAP算法失效并产生了一个误导性的可视化结果；这两个簇实际上是生物学上不相关的细胞类型，本应在图上相距很远。\n\nD. 这两个簇很可能代表了一个连续生物学过程（如细胞分化或激活）中两个不同但密切相关的状态。UMAP上的邻近性反映了它们在这个连续过程中的联系，而差异表达则突显了细胞从一个状态过渡到下一个状态时发生的活跃转录变化。\n\nE. 簇A和簇B中的细胞来自两个完全不同的实验，被错误地混合在一起，观察到的差异纯粹是技术性假象。", "solution": "我们通过考虑UMAP的特性和单细胞RNA测序中差异表达的本质来解释这一明显的矛盾。\n\n首先，UMAP是一种非线性降维方法，其目的是将高维空间中的局部邻域结构保留到二维空间中。UMAP图上的邻近性反映了细胞共享邻域或位于所学习到的流形的邻近区域；它不提供全局相似性的度量保证，也不保证与转录距离成线性比例关系。因此，两个相邻且间隙很小的簇可以表明它们沿着一个连续的轨迹（例如，分化、激活或细胞周期进程）相连，即使许多基因正在发生变化。\n\n其次，单细胞数据中的差异表达分析通常会在密切相关的状态之间检测到许多具有统计学显著差异的基因，尤其是在细胞数量众多且多重检验得到适当控制的情况下。在生物学转变过程中，细胞可以经历广泛但协调的转录重编程，其中每个基因的变化可能不大但数量众多；这些变化的总和可以产生数百个显著基因，而这与UMAP上的邻近性并不矛盾。\n\n评估各个选项：\n- A是错误的，因为UMAP的邻近性并非高度生物学相似性（即差异表达最少）的确切证据；它反映的是局部流形结构，沿着邻近的轨迹仍然可以有许多基因发生变化。\n- B是不可信的，因为经过多重检验校正后，数百个显著基因不太可能全部是假阳性；当得到适当控制时，单细胞方法经常能在相邻状态之间检测到大量的差异表达基因集。\n- C是不太可能的，因为UMAP完全失效导致不相关的类型相邻并不是最简洁的解释；此外，UMAP通常会保留局部连通性，相邻性与共享流形一致，而非完全不相关。\n- D是最符合逻辑的解释：这些簇是沿着一个连续过程（如分化或激活）的两个不同但密切相关的状态。UMAP的邻近性反映了这种连续性，而大量的差异表达基因集则反映了转变过程中的活跃转录变化。\n- E意味着技术性混合或批次效应；这类假象通常会造成与技术协变量一致的分离，并且在质量控制中通常很明显。所描述的紧密相邻、间隙小以及生物学上连贯的差异表达，更符合真实的生物学连续过程，而不是纯粹的技术假象。\n\n因此，最可能的生物学解释是，这两个簇代表了一个连续过程中的相邻状态，而差异表达反映了这一转变背后的转录程序。", "answer": "$$\\boxed{D}$$", "id": "1465887"}, {"introduction": "当实验设计包含多个变量时（例如，不同的细胞类型和不同的处理条件），简单的两组比较已不足以揭示复杂的生物学现象。本练习将引导你进入更高级的统计建模世界，学习如何使用线性模型来剖析基因表达中的“交互效应”。通过构建和解释一个包含交互项的模型，你将能够精确地量化药物对一种细胞类型的影响与对另一种细胞类型的影响有何不同，这是在系统生物学研究中提出并验证复杂假设的核心能力。[@problem_id:1465892]", "problem": "在一项系统生物学研究中，研究人员正在调查免疫系统对一种新药的反应。他们进行了一项单细胞RNA测序 (scRNA-seq) 实验，以测量从两组受试者（一个对照组和一个药物处理组）中分离出的两种不同细胞类型（细胞类型A和细胞类型B）的基因表达。\n\n对于一个特定的目标基因，一位生物统计学家提出了一个线性模型来描述其预期的经对数转换和标准化的表达量，记为 $E$。该模型使用两个指示变量 $x_{cond}$ 和 $x_{type}$ 以及一组系数 $\\beta_0, \\beta_c, \\beta_t, \\beta_{int}$，将 $E$ 与实验条件和细胞类型关联起来。\n\n该模型由以下方程给出：\n$$E = \\beta_0 + \\beta_c x_{cond} + \\beta_t x_{type} + \\beta_{int} x_{cond} x_{type}$$\n\n指示变量编码如下：\n- 对于实验条件：对照组为 $x_{cond} = -1$，处理组为 $x_{cond} = +1$。\n- 对于细胞类型：细胞类型A为 $x_{type} = -1$，细胞类型B为 $x_{type} = +1$。\n\n研究人员特别感兴趣的是那些药物在细胞类型B中的效果与在细胞类型A中不同的基因。为了量化这一点，他们希望计算一个“差异性治疗效果”。这被定义为细胞类型B中由治疗引起的表达变化量，减去细胞类型A中由治疗引起的表达变化量。\n\n根据所提供的模型，推导这个差异性治疗效果关于模型系数的符号表达式。", "solution": "我们从线性模型开始\n$$E=\\beta_{0}+\\beta_{c}x_{cond}+\\beta_{t}x_{type}+\\beta_{int}x_{cond}x_{type}.$$\n将固定细胞类型的治疗诱导变化定义为处理条件和对照条件之间的差异。令 $x_{type}=s$，其中 $s\\in\\{-1,+1\\}$ 分别代表细胞类型A和细胞类型B。那么\n$$E_{\\text{treated},s}=\\beta_{0}+\\beta_{c}(+1)+\\beta_{t}s+\\beta_{int}(+1)s=\\beta_{0}+\\beta_{c}+\\beta_{t}s+\\beta_{int}s,$$\n$$E_{\\text{control},s}=\\beta_{0}+\\beta_{c}(-1)+\\beta_{t}s+\\beta_{int}(-1)s=\\beta_{0}-\\beta_{c}+\\beta_{t}s-\\beta_{int}s.$$\n细胞类型 $s$ 的治疗效果是\n$$\\Delta(s)=E_{\\text{treated},s}-E_{\\text{control},s}=(\\beta_{0}+\\beta_{c}+\\beta_{t}s+\\beta_{int}s)-(\\beta_{0}-\\beta_{c}+\\beta_{t}s-\\beta_{int}s).$$\n消去共同项后得到\n$$\\Delta(s)=2\\beta_{c}+2\\beta_{int}s.$$\n对于细胞类型B， $s=+1$，所以 $\\Delta(+1)=2\\beta_{c}+2\\beta_{int}$。对于细胞类型A， $s=-1$，所以 $\\Delta(-1)=2\\beta_{c}-2\\beta_{int}$。差异性治疗效果，定义为细胞类型B中的治疗效果减去细胞类型A中的治疗效果，即\n$$\\Delta(+1)-\\Delta(-1)=(2\\beta_{c}+2\\beta_{int})-(2\\beta_{c}-2\\beta_{int})=4\\beta_{int}.$$\n因此，所求的表达式是 $4\\beta_{int}$。", "answer": "$$\\boxed{4\\beta_{int}}$$", "id": "1465892"}]}