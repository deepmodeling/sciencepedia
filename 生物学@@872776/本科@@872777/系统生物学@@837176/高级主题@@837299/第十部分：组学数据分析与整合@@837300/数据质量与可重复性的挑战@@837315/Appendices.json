{"hands_on_practices": [{"introduction": "科学研究的再现性始于对已发表数据的批判性评估。一项研究结果的核心不仅仅是平均值，更在于其不确定性的大小；没有误差范围的报告会使其可靠性存疑。这个练习 [@problem_id:1422054] 将指导你如何利用原始数据计算置信区间，这是评估研究结论稳健性的基本功，也是确保科学透明度的关键一步。", "problem": "一篇发表在细胞生物学期刊上的论文声称，一种名为“Inhibitor-7”的新药能显著降低一种名为“Kinase-Z”的蛋白质的表达水平。该论文展示了一个简单的条形图，显示对照组的平均表达水平为120任意荧光单位(AFU)，而使用Inhibitor-7治疗的组的平均表达水平为85 AFU。至关重要的是，该出版物未能报告样本量、方差或任何形式的误差棒，这使得评估该研究结果的可靠性变得困难。\n\n幸运的是，你发现了原始的实验记录本，其中包含了药物治疗组五个样本的原始数据。这五个样本测得的Kinase-Z表达水平分别为：\n82, 95, 78, 80, 90 (单位均为AFU)。\n\n为恰当评估该说法，请计算经Inhibitor-7治疗的总体中Kinase-Z真实平均表达水平的95%置信区间的上限。在计算中，你可以使用95%置信水平下自由度为4的t临界值，即 $t = 2.776$。\n\n答案以任意荧光单位(AFU)表示，并四舍五入到三位有效数字。", "solution": "题目要求我们基于小样本计算真实均值的双侧95%置信区间的上限，因此我们使用学生t区间。对于一个样本量为 $n$ 的样本，其95%置信区间的上限为\n$$\n\\bar{x} + t_{\\alpha/2,\\,n-1}\\,\\frac{s}{\\sqrt{n}},\n$$\n其中 $\\bar{x}$ 是样本均值，$s$ 是以 $n-1$ 为分母计算的样本标准差，$t_{\\alpha/2,\\,n-1}$ 是t临界值。这里 $n=5$ 且 $t_{0.975,\\,4}=2.776$。\n\n设观测值为 $x_{1}=82$, $x_{2}=95$, $x_{3}=78$, $x_{4}=80$, $x_{5}=90$ (单位为AFU)。样本均值为\n$$\n\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{5}x_{i}=\\frac{82+95+78+80+90}{5}=\\frac{425}{5}=85.\n$$\n计算离差平方和：\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=(-3)^{2}+10^{2}+(-7)^{2}+(-5)^{2}+5^{2}=9+100+49+25+25=208.\n$$\n无偏样本方差和标准差分别为\n$$\ns^{2}=\\frac{1}{n-1}\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2}=\\frac{208}{4}=52,\\quad s=\\sqrt{52}.\n$$\n均值标准误为\n$$\n\\mathrm{SE}=\\frac{s}{\\sqrt{n}}=\\frac{\\sqrt{52}}{\\sqrt{5}}=\\sqrt{\\frac{52}{5}}.\n$$\n因此，95%置信区间的上限为\n$$\nU=\\bar{x}+t_{0.975,\\,4}\\,\\mathrm{SE}=85+2.776\\,\\sqrt{\\frac{52}{5}}.\n$$\n数值上，$\\sqrt{\\frac{52}{5}}\\approx 3.224903099$，所以\n$$\nU\\approx 85+2.776\\times 3.224903099\\approx 85+8.95233\\approx 93.95233.\n$$\n四舍五入到三位有效数字，上限为 $94.0$ (单位为AFU)。", "answer": "$$\\boxed{94.0}$$", "id": "1422054"}, {"introduction": "在进行复杂的统计检验之前，数据质量控制（QC）是必不可少的步骤，它就像是数据分析中的侦探工作。一个简单的数据可视化图表，如主成分分析（PCA），往往能揭示实验过程中可能发生的严重错误。本练习 [@problem_id:1422075] 将向你展示如何解读PCA图来诊断样本标签错误这一常见问题，这对于保障数据完整性和后续分析的有效性至关重要。", "problem": "一个学生研究团队正在研究健康人支气管上皮细胞与感染一种常见呼吸道病毒的细胞之间的转录组差异。他们收集了20个独立的细胞培养样本。其中10个样本进行模拟感染，标记为`Control_01`至`Control_10`。另外10个样本感染了病毒，标记为`Infected_01`至`Infected_10`。24小时后，他们进行RNA测序（RNA-Seq），以测量每个样本中数千个基因的表达水平。\n\n为了对数据进行宏观观察，他们进行主成分分析（PCA），这是一种用于可视化样本间总体变异的降维技术。当他们绘制前两个主成分时，观察到两个界限分明、分离良好的数据点簇。正如预期的那样，9个`Control`样本形成一个簇，所有10个`Infected`样本形成另一个簇。然而，最初标记为`Control_08`的样本数据点恰好位于`Infected`样本簇的中心。\n\n假设计算分析流程没有重大错误（例如，PCA算法运行正确），并且不存在未被发现的复杂生物学现象，以下哪项是对这一观察结果最可能且最简约（最简单）的解释？\n\nA. `Control_08`细胞系中发生了罕见的自发突变，导致其基因表达谱与病毒感染细胞的表达谱巧合地趋于一致。\n\nB. 在RNA-Seq数据处理过程中，一个随机的硬件错误（例如，计算机内存中的比特翻转）损坏了`Control_08`的数据文件，使其看起来像一个感染样本。\n\nC. `Control_08`的RNA提取过程失败，导致没有遗传物质被测序，分析软件将其分配到图中的一个默认位置。\n\nD. `Control_08`样本在实验流程中的某个环节（例如，样本收集、铺板或收获）被错误标记，实际上它是一个被贴错标签的感染样本。\n\nE. 测序仪引入了一种系统性偏差，该偏差仅特异性地影响了`Control_08`样本，改变了其整个基因表达谱。", "solution": "我们首先根据底层数据来解释PCA结果。PCA通过寻找能捕获最大方差的正交方向，将高维的基因表达谱映射到低维空间。当样本形成对应于对照组和感染组的两个分离良好的簇时，这表明数据中的主要变异轴线反映了感染状态，并且组内的生物学和技术变异性相对于感染效应来说很小。\n\n观察到九个对照样本聚在一起，所有十个感染样本也聚在一起，而标记为Control_08的样本恰好位于感染簇的中心，这意味着Control_08的全局转录组与感染样本高度相似，而与其他对照样本不同。位于感染簇的中心，特别表明其在许多基因上具有高度的整体一致性，而不仅仅是部分相似。\n\n现在我们根据经验上的合理性、典型的失败模式和简约性原则来评估每个提议的解释：\n\nA. Control_08中发生罕见自发突变，导致其表达与感染细胞相匹配，这是极不可能的。病毒感染会诱导协调的全基因组范围的变化，涉及抗病毒反应、代谢重构以及许多基因的通路水平转变。单个自发突变不可能在数千个基因上可预测地重现这种广泛的“类感染”程序，也不会将该样本置于感染样本簇的中心。这不符合简约性原则。\n\nB. 随机的硬件错误损坏了Control_08的数据，使其特异性地类似于感染样本的表达谱，这是极其不可能的。随机的比特翻转实际上是随机噪声，不会产生与感染簇中心点紧密对齐的、连贯的、具有生物学结构的模式。此外，这种损坏通常会产生可检测的文件错误或无意义的指标，而不是一个清晰的、类别一致的表达谱。\n\nC. RNA提取失败会导致极低的读数计数或数据缺失，这在下游的质量控制（QC）中会被标记出来。PCA不会分配默认位置；信息信号很少的样本通常会表现为离群值或被排除，它们不会恰好落在一个具有生物学连贯性的簇的中心。因此，这与观察到的精确的“类感染”位置不符。\n\nD. Control_08的错误标记是与数据一致的最简约且最常见的解释。在收集、铺板或收获过程中的标签互换或跟踪错误是实验流程中有据可查的实际问题。如果Control_08实际上被感染但被错误标记，它就应该与感染样本聚类；位于簇的中心正是一个典型的感染样本所预期的位置。\n\nE. 由测序仪引起的、仅影响Control_08的系统性偏差是不太可能的。平台或泳道效应通常会影响一批样本，而不是单个样本，而且这种效应通常不会将一个对照样本的表达谱转变为与感染样本中心点紧密匹配的谱。一个设备特有的伪影在一个样本中如此选择性地与感染信号对齐，是不符合简约性原则的。\n\n鉴于计算流程正确且不存在未被发现的复杂生物学现象的假设，具有最高合理性和简约性的解释是工作流程中的样本错误标记事件。因此，最可能的解释是，Control_08实际上是一个被贴错标签的感染样本。", "answer": "$$\\boxed{D}$$", "id": "1422075"}, {"introduction": "在系统生物学中，即使是完美的数据，我们选择的分析工具也会影响最终结果，这构成了计算再现性的核心挑战。不同的生物信息学流程，尽管在理论上都是有效的，却可能指向不完全相同的生物学结论。本练习 [@problem_id:1422097] 将让你通过计算Jaccard指数，来量化两种不同分析方法结果之间的一致性，从而让你亲身体验评估分析方法稳健性的重要性。", "problem": "一位系统生物学研究人员正在研究细胞对一种新药的反应。他们进行了一项核糖核酸测序（RNA-seq）实验，以比较处理过的细胞培养物与未经处理的对照培养物中的基因表达。原始测序数据经过处理，以识别被该药物显著上调的基因。\n\n为确保其研究结果的稳健性，该研究人员使用两种不同且广泛使用的计算流程：“QuantFlow”和“ExpressAlign”来分析相同的原始数据。每个流程都会根据统计显著性生成一个排序的基因列表。研究人员决定比较每个流程识别出的前10个最显著上调的基因。\n\n来自QuantFlow流程的前10个基因集合，我们称之为集合Q，是：\n{GENE01, GENE03, GENE04, GENE05, GENE07, GENE08, GENE11, GENE12, GENE15, GENE17}\n\n来自ExpressAlign流程的前10个基因集合，我们称之为集合E，是：\n{GENE02, GENE03, GENE05, GENE06, GENE07, GENE09, GENE11, GENE15, GENE18, GENE20}\n\n为了量化两种分析方法之间的一致性，请计算这两个基因集合Q和E的Jaccard指数。Jaccard指数是衡量两个集合相似度的指标，其定义为两个集合交集的大小除以并集的大小。\n\n将您的答案表示为小数，并四舍五入到三位有效数字。", "solution": "我们被要求计算两个集合 $Q$ 和 $E$ 的Jaccard指数，定义如下\n$$\nQ=\\{\\text{GENE01}, \\text{GENE03}, \\text{GENE04}, \\text{GENE05}, \\text{GENE07}, \\text{GENE08}, \\text{GENE11}, \\text{GENE12}, \\text{GENE15}, \\text{GENE17}\\},\n$$\n$$\nE=\\{\\text{GENE02}, \\text{GENE03}, \\text{GENE05}, \\text{GENE06}, \\text{GENE07}, \\text{GENE09}, \\text{GENE11}, \\text{GENE15}, \\text{GENE18}, \\text{GENE20}\\}.\n$$\nJaccard指数 $J$ 的定义为\n$$\nJ=\\frac{|Q\\cap E|}{|Q\\cup E|}.\n$$\n显式地计算交集：\n$$\nQ\\cap E=\\{\\text{GENE03}, \\text{GENE05}, \\text{GENE07}, \\text{GENE11}, \\text{GENE15}\\},\n$$\n所以\n$$\n|Q\\cap E|=5.\n$$\n使用恒等式 $|A\\cup B|=|A|+|B|-|A\\cap B|$ 计算并集的大小：\n$$\n|Q|=10,\\quad |E|=10,\\quad |Q\\cup E|=10+10-5=15.\n$$\n因此，\n$$\nJ=\\frac{5}{15}=\\frac{1}{3}.\n$$\n表示为小数并四舍五入到三位有效数字，得到\n$$\n\\frac{1}{3}=0.\\overline{3}\\approx 0.333 \\text{（保留三位有效数字）}.\n$$", "answer": "$$\\boxed{0.333}$$", "id": "1422097"}]}