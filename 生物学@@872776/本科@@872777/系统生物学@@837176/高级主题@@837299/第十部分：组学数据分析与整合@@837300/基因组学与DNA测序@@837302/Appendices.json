{"hands_on_practices": [{"introduction": "基因组测序的核心挑战在于如何将数百万个短的DNA序列“读段”拼接成完整的染色体序列。这个练习模拟了“重叠-布局-共有序列”(Overlap-Layout-Consensus)策略的第一步，这是一个直观的从头组装方法。通过解决这个如同拼图游戏般的问题，你将亲身体验基因组组装的基本逻辑。[@problem_id:2290971]", "problem": "在一个基因组测序项目中，从一个生物体染色体的单一、非重复区域获得了三个短的、重叠的DNA片段，称为“读长”（reads）。您的任务是通过找到这些读长之间正确的重叠部分，进行*de novo*组装，以重建被称为contig的单一、最长的可能连续DNA序列。下面提供了三个读长：\n\n- 读长 1: `AGCTTAGGCT`\n- 读长 2: `AGGCTACGT`\n- 读长 3: `ACGTACGAT`\n\n确定组装好的contig的完整序列。答案应为代表该DNA序列的单个字符串。", "solution": "我们需要通过最大化读长之间的重叠来组装一个最短共同超串。定义两个字符串 $X$ 和 $Y$ 之间的重叠函数为\n$$\n\\operatorname{ovl}(X,Y)=\\max\\{k \\in \\mathbb{N} \\mid \\text{the suffix of } X \\text{ of length } k \\text{ equals the prefix of } Y \\text{ of length } k\\}.\n$$\n计算两两之间的有向重叠：\n- 对于 $R_{1}=\\text{AGCTTAGGCT}$ 和 $R_{2}=\\text{AGGCTACGT}$，最长重叠为 $\\operatorname{ovl}(R_{1},R_{2})=5$，匹配的子串是 $\\text{AGGCT}$。不存在更长的匹配，因为 $R_{1}$ 的长度为6的后缀是 $\\text{TAGGCT}$，不等于 $R_{2}$ 的前缀。\n- 对于 $R_{2}$ 和 $R_{3}=\\text{ACGTACGAT}$，最长重叠为 $\\operatorname{ovl}(R_{2},R_{3})=4$，匹配的子串是 $\\text{ACGT}$。长度为5的重叠会要求 $R_{2}$ 的后缀 $\\text{TACGT}$ 与 $R_{3}$ 的前缀匹配，但实际上并不匹配。\n- 在 $(R_{1},R_{3})$、$(R_{3},R_{1})$、$(R_{2},R_{1})$ 和 $(R_{3},R_{2})$ 这些配对中，所有其他的有向重叠都为零，因为在每种情况下，第一个字符串的任何非平凡后缀都不等于第二个字符串的前缀。\n\n因此，唯一的最大重叠排序是 $R_{1} \\rightarrow R_{2} \\rightarrow R_{3}$。通过拼接并移除重叠部分来进行组装：\n- 使用5个碱基的重叠 $\\text{AGGCT}$ 合并 $R_{1}$ 和 $R_{2}$，得到 $\\text{AGCTTAGGCTACGT}$。\n- 将此结果与 $R_{3}$ 使用4个碱基的重叠 $\\text{ACGT}$（即当前字符串的后缀和 $R_{3}$ 的前缀）合并，得到最终的contig $\\text{AGCTTAGGCTACGTACGAT}$。\n\n令 $\\ell(\\cdot)$ 表示字符串长度。最终长度为\n$$\n\\ell(R_{1})+\\ell(R_{2})-\\operatorname{ovl}(R_{1},R_{2})+\\ell(R_{3})-\\operatorname{ovl}(R_{2},R_{3})=10+9-5+9-4=19,\n$$\n与组装好的序列长度一致。因此，组装好的contig是 AGCTTAGGCTACGTACGAT。", "answer": "$$\\boxed{AGCTTAGGCTACGTACGAT}$$", "id": "2290971"}, {"introduction": "虽然简单的重叠方法很直观，但在处理大规模测序数据和重复序列时会遇到困难。德布鲁因图 (De Bruijn graph) 提供了一种计算上更高效、更强大的组装策略，它将生物学问题巧妙地转化为了一个图论问题。在这个练习中，你将通过构建一个“序列地图”并寻找正确的路径，来从一堆碎片化的k-mer中重建原始DNA序列。[@problem_id:2290987]", "problem": "一位分子生物学家正在对一种新发现的嗜极细菌的短线性DNA片段进行*从头*基因组组装。测序过程产生了一组短的、重叠的读段。为了重建原始DNA序列，该生物学家采用了一种德布莱因图组装策略。该过程首先将所有测序读段分解为一个完整的k-mer集合，k-mer是长度为$k$的短子串。\n\n对于本次特定的组装，使用了$k=4$的值。从读段中获得的所有4-mer的完整、无序集合是：\n`{ ATGC, TGCG, GCGT, CGTA, GTAC, TACG, ACGT, CGTG }`\n\n你的任务是从这组4-mer中重建原始的、连续的DNA序列。为此，你必须首先构建相应的德布莱因图。在这个特定的图模型中：\n1.  图的节点（或顶点）是所有唯一的(k-1)-mer。(k-1)-mer是长度为$k-1=3$的序列。这些节点来自于给定集合中每个4-mer的前缀（前3个碱基）和后缀（后3个碱基）。\n2.  从节点`U`到节点`V`画一条有向边，当且仅当集合中存在一个4-mer，其前缀是`U`，后缀是`V`。集合中的每个4-mer都精确对应图中的一条有向边。\n\n通过找到一条遍历每条边恰好一次的唯一路径，确定原始线性片段的完整DNA序列。", "solution": "问题要求我们使用德布莱因图从一组k-mer中重建DNA序列。给定的k-mer集合（$k=4$）是`{ATGC, TGCG, GCGT, CGTA, GTAC, TACG, ACGT, CGTG}`。\n\n**步骤1：确定德布莱因图的节点。**\n节点是唯一的(k-1)-mer，即3-mer（三核苷酸）。我们可以通过列出所有给定的4-mer的前缀和后缀来找到它们。\n\n这些4-mer是：\n- `ATGC`：前缀`ATG`，后缀`TGC`\n- `TGCG`：前缀`TGC`，后缀`GCG`\n- `GCGT`：前缀`GCG`，后缀`CGT`\n- `CGTA`：前缀`CGT`，后缀`GTA`\n- `GTAC`：前缀`GTA`，后缀`TAC`\n- `TACG`：前缀`TAC`，后缀`ACG`\n- `ACGT`：前缀`ACG`，后缀`CGT`\n- `CGTG`：前缀`CGT`，后缀`GTG`\n\n所有前缀的集合是`{ATG, TGC, GCG, CGT, GTA, TAC, ACG}`。\n所有后缀的集合是`{TGC, GCG, CGT, GTA, TAC, ACG, GTG}`。\n\n唯一的节点完整集合是这两个集合的并集：\n节点 = `{ATG, TGC, GCG, CGT, GTA, TAC, ACG, GTG}`。\n\n**步骤2：构建有向边。**\n每个4-mer对应一条从其前缀节点到其后缀节点的有向边。\n\n- `ATGC` → 从`ATG`到`TGC`的边\n- `TGCG` → 从`TGC`到`GCG`的边\n- `GCGT` → 从`GCG`到`CGT`的边\n- `CGTA` → 从`CGT`到`GTA`的边\n- `GTAC` → 从`GTA`到`TAC`的边\n- `TACG` → 从`TAC`到`ACG`的边\n- `ACGT` → 从`ACG`到`CGT`的边\n- `CGTG` → 从`CGT`到`GTG`的边\n\n**步骤3：找到欧拉路径的起始节点和终止节点。**\n重建序列需要找到一条欧拉路径，即一条恰好访问每条边一次的路径。对于有向图，存在欧拉路径的充要条件是：图是连通的，并且最多有一个顶点的`出度 - 入度 = 1`，最多有一个顶点的`入度 - 出度 = 1`，而所有其他顶点的`入度 = 出度`。\n\n让我们计算每个节点的入度和出度：\n- **ATG**：出度 = 1（到 TGC），入度 = 0。差值 = +1。这是起始节点。\n- **TGC**：出度 = 1（到 GCG），入度 = 1（来自 ATG）。差值 = 0。\n- **GCG**：出度 = 1（到 CGT），入度 = 1（来自 TGC）。差值 = 0。\n- **CGT**：出度 = 2（到 GTA，到 GTG），入度 = 2（来自 GCG，来自 ACG）。差值 = 0。\n- **GTA**：出度 = 1（到 TAC），入度 = 1（来自 CGT）。差值 = 0。\n- **TAC**：出度 = 1（到 ACG），入度 = 1（来自 GTA）。差值 = 0。\n- **ACG**：出度 = 1（到 CGT），入度 = 1（来自 TAC）。差值 = 0。\n- **GTG**：出度 = 0，入度 = 1（来自 CGT）。差值 = -1。这是终止节点。\n\n该图有一个起始节点（`ATG`）和一个终止节点（`GTG`），因此存在一条唯一的欧拉路径。\n\n**步骤4：追踪欧拉路径并重建序列。**\n路径从节点`ATG`开始。序列以起始节点的字符串`ATG`开始。然后我们追加路径中遍历的每个后续k-mer的最后一个字符。\n\n1.  从`ATG`开始。唯一的出边对应k-mer `ATGC`。目前序列：`ATGC`。我们现在到达节点`TGC`。\n2.  从`TGC`出发，出边对应`TGCG`。我们追加最后一个字符`G`。序列：`ATGCG`。我们现在到达节点`GCG`。\n3.  从`GCG`出发，出边对应`GCGT`。我们追加`T`。序列：`ATGCGT`。我们现在到达节点`CGT`。\n4.  从`CGT`出发，有两条出边，对应`CGTA`和`CGTG`。我们知道`GTG`是整个路径的最终节点，所以我们暂时不应该遍历到`GTG`的边，除非它是唯一的选择。让我们走`CGTA`对应的边。我们追加`A`。序列：`ATGCGTA`。我们现在到达节点`GTA`。\n5.  从`GTA`出发，出边对应`GTAC`。追加`C`。序列：`ATGCGTAC`。我们现在到达节点`TAC`。\n6.  从`TAC`出发，出边对应`TACG`。追加`G`。序列：`ATGCGTACG`。我们现在到达节点`ACG`。\n7.  从`ACG`出发，出边对应`ACGT`。追加`T`。序列：`ATGCGTACGT`。这让我们回到节点`CGT`。\n8.  我们再次到达`CGT`。对应`CGTA`的边已经被使用。从`CGT`出发唯一未使用的边是对应`CGTG`的边。我们遍历这条边。追加`G`。序列：`ATGCGTACGTG`。我们到达最终节点`GTG`。\n\n所有8条边（k-mer）都恰好被使用了一次。路径从`ATG`开始，到`GTG`结束。最终重建的序列就是我们构建的字符串。\n\n最终序列：`ATGCGTACGTG`。", "answer": "$$\\boxed{ATGCGTACGTG}$$", "id": "2290987"}, {"introduction": "完成基因组组装后，我们如何判断其质量？N50是评估组装连续性的一个核心指标，它告诉我们构成组装基因组主体部分的大片段的典型长度。通过这个练习，你将学会计算这一重要统计量，从而能够量化比较不同组装策略的优劣，这是任何基因组学项目中的关键评估步骤。[@problem_id:1436278]", "problem": "一个生物信息学研究小组正在对一种新发现的微生物进行*从头*基因组组装。测序后，他们使用了两种不同的组装程序，“Assembler-X”和“Assembler-Y”，生成了两组不同的重叠群（contigs）。评估组装质量的一个关键指标是其连续性，这通常通过N50统计量来量化。N50值代表的是一组最长的重叠群中最小重叠群的长度，这组重叠群的总长度至少覆盖了组装总长度的50%。\n\n现提供两种组装的完整重叠群长度列表（单位为千碱基对，kbp）：\n\n**Assembler-X 重叠群长度 (kbp):**\n`198.2, 15.1, 45.3, 121.0, 78.5, 22.7, 153.6, 9.4, 55.8`\n\n**Assembler-Y 重叠群长度 (kbp):**\n`250.5, 5.2, 180.1, 44.6, 99.8, 12.1`\n\n请计算由 **Assembler-X** 生成的基因组草图的重叠群N50值。答案以千碱基对（kbp）为单位，并四舍五入到三位有效数字。", "solution": "N50 被定义为一组最大重叠群中最小重叠群的长度，这组重叠群的累积长度至少是总组装长度的一半。\n\n对于 Assembler-X，其重叠群长度（单位kbp）如下：\n$$198.2,\\;15.1,\\;45.3,\\;121.0,\\;78.5,\\;22.7,\\;153.6,\\;9.4,\\;55.8.$$\n\n1) 计算组装总长度：\n$$L_{\\text{total}}=198.2+15.1+45.3+121.0+78.5+22.7+153.6+9.4+55.8=699.6.$$\n\n2) 计算总长度的一半：\n$$\\frac{1}{2}L_{\\text{total}}=0.5\\times 699.6=349.8.$$\n\n3) 将重叠群按非递增顺序（从大到小）排序并计算累积和：\n$$\\text{排序后： }198.2,\\;153.6,\\;121.0,\\;78.5,\\;55.8,\\;45.3,\\;22.7,\\;15.1,\\;9.4.$$\n累加第一个重叠群后：\n$$198.2349.8.$$\n累加第二个重叠群后：\n$$198.2+153.6=351.8\\geq 349.8.$$\n\n因此，累积长度达到总长度一半的最长重叠群集合为 $\\{198.2,\\,153.6\\}$，N50是该集合中最小重叠群的长度：\n$$N50=153.6\\ \\text{kbp}.$$\n\n四舍五入到三位有效数字后为：\n$$N50=154\\ \\text{kbp}.$$", "answer": "$$\\boxed{154}$$", "id": "1436278"}]}