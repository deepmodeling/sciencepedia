{"hands_on_practices": [{"introduction": "像基因本体论 (Gene Ontology, GO) 这样的生物学本体是功能强大的工具，因为它们将知识构建成图谱结构。这项练习 [@problem_id:1419513] 提供了将本体视为有向无环图 (DAG) 的动手实践，以量化生物学术语之间的关系。通过计算路径长度和识别共同祖先，你将掌握理解和执行语义相似性分析的基础技能。", "problem": "基因本体论（Gene Ontology, GO）为我们关于基因和蛋白质功能的知识提供了一种结构化、可计算的表示。它被组织成一个有向无环图（DAG），其中每个术语代表一个生物学概念，有向边代表从更具体的术语（子代）到更一般的术语（亲代）的关系，例如'is_a'（是）或'part_of'（是……的一部分）。\n\n请考虑以下GO‘生物学过程’本体论的简化子集，其中列出了每个术语的亲代。术语‘biological_process’ (GO:0008150) 是该层次结构的根，没有亲代。\n\n*   **术语 (ID): 亲代**\n*   'cellular_process' (GO:0009987): {'biological_process'}\n*   'metabolic_process' (GO:0008152): {'biological_process'}\n*   'cellular_component_organization' (GO:0016043): {'cellular_process'}\n*   'catabolic_process' (GO:0009056): {'cellular_process', 'metabolic_process'}\n*   'organelle_organization' (GO:0007031): {'cellular_component_organization'}\n*   'autophagy' (GO:0006914): {'catabolic_process'}\n*   'organelle_fission' (GO:0044594): {'organelle_organization'}\n*   'selective_autophagy' (GO:0043936): {'autophagy'}\n*   'mitochondrial_fission' (GO:0000266): {'organelle_fission'}\n*   'mitophagy' (GO:0000422): {'selective_autophagy'}\n\n对于本体论中的任意两个术语，我们可以定义它们之间的一条路径，该路径向上遍历层次结构至一个共同祖先，然后再向下。两个术语之间的“最短路径长度”定义为：从第一个术语向上到它们的最特异共同祖先（Most Specific Common Ancestor, MSCA）的路径上的边数，与从第二个术语向上到同一个MSCA的路径上的边数之和。\n\n最特异共同祖先（MSCA）是两个术语的共同祖先中深度最大的那个。术语的“深度”是指从根（‘biological_process’）到该术语的最长可能路径上的边数。\n\n请根据所提供的本体论结构，计算‘mitophagy’ (GO:0000422) 和‘mitochondrial_fission’ (GO:0000266) 之间的最短路径长度。", "solution": "我们首先将亲代关系列为向上（从子代到亲代）的边。对于每个查询的术语，我们通过反复追溯其亲代直至根来枚举其所有祖先。\n\nmitophagy (GO:0000422) 的祖先：\nmitophagy → selective_autophagy → autophagy → catabolic_process → {cellular_process, metabolic_process} → biological_process.\n因此，祖先集为 $\\{\\text{mitophagy}, \\text{selective\\_autophagy}, \\text{autophagy}, \\text{catabolic\\_process}, \\text{cellular\\_process}, \\text{metabolic\\_process}, \\text{biological\\_process}\\}$。\n\nmitochondrial_fission (GO:0000266) 的祖先：\nmitochondrial_fission → organelle_fission → organelle_organization → cellular_component_organization → cellular_process → biological_process.\n因此，祖先集为 $\\{\\text{mitochondrial\\_fission}, \\text{organelle\\_fission}, \\text{organelle\\_organization}, \\text{cellular\\_component\\_organization}, \\text{cellular\\_process}, \\text{biological\\_process}\\}$。\n\n共同祖先是 $\\{\\text{cellular\\_process}, \\text{biological\\_process}\\}$。为了确定最特异共同祖先（MSCA），我们比较它们的深度，深度定义为从根 $\\text{biological\\_process}$ 到该术语的最长路径上的边数。我们有：\n- $\\text{depth}(\\text{biological\\_process}) = 0$。\n- $\\text{depth}(\\text{cellular\\_process}) = 1$。\n\n因此，MSCA是 $\\text{cellular\\_process}$。\n\n最短路径长度定义为从每个术语向上到MSCA的边数之和。计算这些向上的距离：\n- 从 mitophagy 到 cellular_process: mitophagy → selective_autophagy (1) → autophagy (2) → catabolic_process (3) → cellular_process (4)，得到 $4$ 条边。\n- 从 mitochondrial_fission 到 cellular_process: mitochondrial_fission → organelle_fission (1) → organelle_organization (2) → cellular_component_organization (3) → cellular_process (4)，得到 $4$ 条边。\n\n将这些距离相加，得到最短路径长度：\n$$4 + 4 = 8.$$", "answer": "$$\\boxed{8}$$", "id": "1419513"}, {"introduction": "系统生物学研究常常涉及创建新的量化指标来分析复杂的网络。这个问题 [@problem_id:1419478] 挑战你将“代谢串扰”这一生物学概念形式化为一个针对酶的“渗漏指数”。这项练习将培养你将定性的生物学思想转化为计算框架的能力，这是从网络数据中生成新颖的、数据驱动的假设的一项关键技能。", "problem": "在对大规模代谢网络的研究中，一个关键的挑战是识别不同功能通路之间存在显著“串扰”的点。解决这个问题的一种方法是识别“泄漏”酶，这些酶产生的代谢物随后被多种机制上不相关的下游通路所消耗。\n\n为了将此问题形式化，我们引入一个评分系统。让我们考虑一个简化的代谢网络模型，该模型包含一组酶、化合物、通路和高级通路类别。\n\n1.  **跨通路影响 (CPI)**：对于给定的化合物 $c$，其 CPI 值（记作 $I(c)$）量化了消耗该化合物的通路的多样性。设 $\\mathcal{P}_c$ 是使用化合物 $c$ 作为底物的独特通路的集合。设 $\\mathcal{K}_p$ 是通路 $p$ 的高级代谢类别。CPI 定义为 $\\mathcal{P}_c$ 中属于不同高级类别的所有不同通路对 $\\{p_i, p_j\\}$ 的总数。即，\n    $$I(c) = \\left| \\left\\{ \\{p_i, p_j\\} \\mid p_i, p_j \\in \\mathcal{P}_c, p_i \\neq p_j, \\text{ and } \\mathcal{K}_{p_i} \\neq \\mathcal{K}_{p_j} \\right\\} \\right|$$\n\n2.  **泄漏指数 (LI)**：对于给定的酶 $e$，其 LI 值（记作 $\\Lambda(e)$）衡量了其“泄漏”的倾向。设 $\\mathcal{C}_e$ 是由酶 $e$ 催化的反应所生成的所有产物化合物的集合。LI 是其所有产物的 CPI 之和。\n    $$\\Lambda(e) = \\sum_{c \\in \\mathcal{C}_e} I(c)$$\n\n给定一个假设的代谢网络的以下数据：\n\n**酶-产物关系：**\n- 酶 E1 产生化合物 C1。\n- 酶 E2 产生化合物 C2。\n- 酶 E3 产生化合物 C2 和 C3。\n- 酶 E4 产生化合物 C1。\n- 酶 E5 产生化合物 C4。\n\n**化合物被通路消耗的情况：**\n- C1 是通路 P1, P2, P5, P6 的底物。\n- C2 是通路 P3, P7 的底物。\n- C3 是通路 P1, P4 的底物。\n- C4 是通路 P2, P3, P4, P8 的底物。\n\n**通路分类：**\n- 类别 A: P1, P2\n- 类别 B: P3, P4\n- 类别 C: P5, P6\n- 类别 D: P7, P8\n\n根据所提供的数据和定义，下列哪种酶的泄漏指数 (LI) 最高？\n\nA. E1\n\nB. E2\n\nC. E3\n\nD. E4\n\nE. E5", "solution": "目标是找出具有最高泄漏指数 (LI) 的酶。酶的 LI 是其产物的跨通路影响 (CPI) 分数之和。我们必须首先计算每个相关化合物（C1, C2, C3, C4）的 CPI，然后使用这些值来计算每种酶（E1, E2, E3, E4, E5）的 LI。\n\n**步骤 1：计算每个化合物的跨通路影响 (CPI)。**\n\nCPI, $I(c)$, 是属于不同类别的消耗通路对 $\\{p_i, p_j\\}$ 的数量。一个系统性的计算方法是，找出通路对的总数，然后减去属于*同一*类别的通路对的数量。设 $N$ 是消耗化合物 $c$ 的通路总数，设 $n_k$ 是这些通路中属于类别 $k$ 的数量。那么 CPI 就是 $I(c) = \\binom{N}{2} - \\sum_k \\binom{n_k}{2}$。\n\n-   **化合物 C1：**\n    被通路 $\\mathcal{P}_{C1} = \\{\\text{P1, P2, P5, P6}\\}$ 消耗。通路总数 $N = 4$。\n    这些通路的类别是：\n    - P1: 类别 A\n    - P2: 类别 A\n    - P5: 类别 C\n    - P6: 类别 C\n    我们有 2 条通路在类别 A 中 ($n_A = 2$)，2 条通路在类别 C 中 ($n_C = 2$)。\n    $I(C1) = \\binom{4}{2} - \\left( \\binom{2}{2} + \\binom{2}{2} \\right) = \\frac{4 \\times 3}{2} - (1 + 1) = 6 - 2 = 4$。\n\n-   **化合物 C2：**\n    被通路 $\\mathcal{P}_{C2} = \\{\\text{P3, P7}\\}$ 消耗。通路总数 $N = 2$。\n    这些通路的类别是：\n    - P3: 类别 B\n    - P7: 类别 D\n    我们有 1 条通路在类别 B 中 ($n_B = 1$)，1 条通路在类别 D 中 ($n_D = 1$)。\n    $I(C2) = \\binom{2}{2} - \\left( \\binom{1}{2} + \\binom{1}{2} \\right) = 1 - (0 + 0) = 1$。\n    （唯一的通路对是 {P3, P7}，它们属于不同类别）。\n\n-   **化合物 C3：**\n    被通路 $\\mathcal{P}_{C3} = \\{\\text{P1, P4}\\}$ 消耗。通路总数 $N = 2$。\n    这些通路的类别是：\n    - P1: 类别 A\n    - P4: 类别 B\n    我们有 1 条通路在类别 A 中 ($n_A = 1$)，1 条通路在类别 B 中 ($n_B = 1$)。\n    $I(C3) = \\binom{2}{2} - \\left( \\binom{1}{2} + \\binom{1}{2} \\right) = 1 - (0 + 0) = 1$。\n    （唯一的通路对是 {P1, P4}，它们属于不同类别）。\n\n-   **化合物 C4：**\n    被通路 $\\mathcal{P}_{C4} = \\{\\text{P2, P3, P4, P8}\\}$ 消耗。通路总数 $N = 4$。\n    这些通路的类别是：\n    - P2: 类别 A\n    - P3: 类别 B\n    - P4: 类别 B\n    - P8: 类别 D\n    我们有 1 条通路在类别 A 中 ($n_A = 1$)，2 条通路在类别 B 中 ($n_B = 2$)，1 条通路在类别 D 中 ($n_D = 1$)。\n    $I(C4) = \\binom{4}{2} - \\left( \\binom{1}{2} + \\binom{2}{2} + \\binom{1}{2} \\right) = 6 - (0 + 1 + 0) = 5$。\n\n**步骤 2：计算每种酶的泄漏指数 (LI)。**\n\nLI, $\\Lambda(e)$, 是酶 $e$ 的产物的 CPI 之和。\n-   **酶 E1：**\n    产生 C1。\n    $\\Lambda(E1) = I(C1) = 4$。\n\n-   **酶 E2：**\n    产生 C2。\n    $\\Lambda(E2) = I(C2) = 1$。\n\n-   **酶 E3：**\n    产生 C2 和 C3。\n    $\\Lambda(E3) = I(C2) + I(C3) = 1 + 1 = 2$。\n\n-   **酶 E4：**\n    产生 C1。\n    $\\Lambda(E4) = I(C1) = 4$。\n\n-   **酶 E5：**\n    产生 C4。\n    $\\Lambda(E5) = I(C4) = 5$。\n\n**步骤 3：比较 LI 值并找出最大值。**\n\n计算出的 LI 值为：\n-   $\\Lambda(E1) = 4$\n-   $\\Lambda(E2) = 1$\n-   $\\Lambda(E3) = 2$\n-   $\\Lambda(E4) = 4$\n-   $\\Lambda(E5) = 5$\n\nLI 的最大值为 5，对应于酶 E5。因此，E5 具有最高的泄漏指数。这对应于选项 E。", "answer": "$$\\boxed{E}$$", "id": "1419478"}, {"introduction": "解决信息冲突是生物信息学的一项核心任务，而得出可靠的结论需要整合多种证据。这项高级练习 [@problem_id:1419495] 模拟了一个真实的研究场景，你必须为一个假想基因解决其功能注释的冲突。你将学习应用一个加权评分系统，结合来自序列同源性、蛋白质结构域和基因共表达的数据，这展示了一种在基因组学中进行数据驱动决策的强大方法。", "problem": "一个计算生物学家团队正在对一种新测序的嗜极古菌 *Thermovibrio syntheticus* 进行代谢重建。他们在泛酸生物合成途径中发现了一个关键的缺失环节，具体来说是催化L-天冬氨酸转化为β-丙氨酸的反应。由基因 `TS_1337` 编码的一个假设蛋白是填补这一缺失功能的主要候选者。然而，两个主要的生物学数据库对该酶的身份提供了相互矛盾的预测。\n\n- 京都基因与基因组百科全书 (KEGG) 的注释流程表明，`TS_1337` 编码一种**天冬氨酸-1-脱羧酶 (PanD)**，其酶学委员会 (EC) 编号为 4.1.1.11。\n- Reactome 数据库的注释表明，`TS_1337` 编码一种**谷氨酸脱羧酶 (GAD)**，其EC编号为 4.1.1.15，已知该酶在一些相关生物体中对L-天冬氨酸具有混杂活性。\n\n为解决这一冲突，您必须应用一个定量证据整合框架。每个候选酶（PanD 和 GAD）的整合证据得分 $S$ 通过以下加权公式计算：\n$$S = 0.4 \\times S_{\\text{homology}} + 0.3 \\times S_{\\text{domain}} + 0.3 \\times S_{\\text{coexpression}}$$\n\n您获得了以下几项生物信息学数据：\n\n1.  **同源性证据 ($S_{\\text{homology}}$):** 使用 TS_1337 蛋白质序列对一个经整理的参考数据库进行了 BLASTp 搜索。一个蛋白质序列与自身比对的比特分为 580。\n    - 与一个经过验证的 PanD 蛋白的最高比特分比对为 450。\n    - 与一个经过验证的 GAD 蛋白的最高比特分比对为 310。\n    同源性得分定义为候选者的比特分与自身比对的比特分之比：$S_{\\text{homology}} = \\frac{\\text{bit-score}}{\\text{self-score}}$。\n\n2.  **蛋白质结构域证据 ($S_{\\text{domain}}$):** 使用 InterProScan 分析了 TS_1337 的蛋白质序列，并将其组成的结构域与 PanD 和 GAD 酶家族的典型结构域进行了比较。\n    - 在 TS_1337 蛋白质中识别出的结构域：{IPR002047, IPR001633, IPR036858}\n    - PanD 家族的典型结构域：{IPR002047, IPR001633, IPR020846}\n    - GAD 家族的典型结构域：{IPR002047, IPR019866}\n    结构域得分由 TS_1337 中的结构域集合 ($A$) 与候选家族的典型结构域集合 ($B$) 之间的 Jaccard 相似系数定义：$S_{\\text{domain}} = \\frac{|A \\cap B|}{|A \\cup B|}$。\n\n3.  **基因共表达证据 ($S_{\\text{coexpression}}$):** 对转录组数据的分析确定了 10 个与 `TS_1337` 高度共表达的其他基因。它们的功能通过其参与的通路进行了注释。\n    - 6个共表达基因属于“泛酸与辅酶A生物合成”通路 (KEGG map: ko00770)。\n    - 2个共表达基因属于“谷氨酸代谢”通路 (KEGG map: ko00250)。\n    - 2个共表达基因无法在功能上进行表征。\n    PanD 酶是 ko00770 通路的典型成员，而 GAD 酶是 ko00250 通路的典型成员。候选者的共表达得分是属于该候选者主要代谢通路的*已表征*共表达基因所占的比例。\n\n您的任务是计算 PanD 和 GAD 的总证据得分。然后，为了量化对更优注释的置信度，请计算可能性更大的候选者的总分与可能性较小的候选者的总分之比。\n\n计算这个置信度比率。将您的最终答案四舍五入到三位有效数字。", "solution": "整合证据得分定义为\n$$S=0.4\\,S_{\\text{homology}}+0.3\\,S_{\\text{domain}}+0.3\\,S_{\\text{coexpression}},$$\n其中 $S_{\\text{homology}}=\\frac{\\text{bit-score}}{\\text{self-score}}$，$S_{\\text{domain}}=\\frac{|A\\cap B|}{|A\\cup B|}$，且 $S_{\\text{coexpression}}$ 等于候选者主要通路中已表征共表达基因的比例。\n\n同源性证据：\n- 自身比特分为 $580$。\n- PanD 最佳匹配比特分 $450$ 得到 $S_{\\text{homology}}^{\\text{PanD}}=\\frac{450}{580}=\\frac{45}{58}$。\n- GAD 最佳匹配比特分 $310$ 得到 $S_{\\text{homology}}^{\\text{GAD}}=\\frac{310}{580}=\\frac{31}{58}$。\n\n结构域证据：\n- TS\\_1337 的结构域 $A=\\{\\text{IPR002047},\\text{IPR001633},\\text{IPR036858}\\}$。\n- PanD 典型结构域 $B_{\\text{PanD}}=\\{\\text{IPR002047},\\text{IPR001633},\\text{IPR020846}\\}$ 得到 $|A\\cap B_{\\text{PanD}}|=2$，$|A\\cup B_{\\text{PanD}}|=4$，因此 $S_{\\text{domain}}^{\\text{PanD}}=\\frac{2}{4}=\\frac{1}{2}$。\n- GAD 典型结构域 $B_{\\text{GAD}}=\\{\\text{IPR002047},\\text{IPR019866}\\}$ 得到 $|A\\cap B_{\\text{GAD}}|=1$，$|A\\cup B_{\\text{GAD}}|=4$，因此 $S_{\\text{domain}}^{\\text{GAD}}=\\frac{1}{4}$。\n\n共表达证据：\n- 10个共表达基因中，2个未被表征，因此有 $8$ 个已表征。\n- PanD 通路基因：$6$个，因此 $S_{\\text{coexpression}}^{\\text{PanD}}=\\frac{6}{8}=\\frac{3}{4}$。\n- GAD 通路基因：$2$个，因此 $S_{\\text{coexpression}}^{\\text{GAD}}=\\frac{2}{8}=\\frac{1}{4}$。\n\n使用 $0.4=\\frac{2}{5}$ 和 $0.3=\\frac{3}{10}$ 计算总分：\n$$S^{\\text{PanD}}=\\frac{2}{5}\\cdot\\frac{45}{58}+\\frac{3}{10}\\cdot\\frac{1}{2}+\\frac{3}{10}\\cdot\\frac{3}{4}\n=\\frac{9}{29}+\\frac{3}{20}+\\frac{9}{40}\n=\\frac{795}{1160}=\\frac{159}{232},$$\n$$S^{\\text{GAD}}=\\frac{2}{5}\\cdot\\frac{31}{58}+\\frac{3}{10}\\cdot\\frac{1}{4}+\\frac{3}{10}\\cdot\\frac{1}{4}\n=\\frac{31}{145}+\\frac{3}{40}+\\frac{3}{40}\n=\\frac{211}{580}.$$\n\n由于 $S^{\\text{PanD}}>S^{\\text{GAD}}$，PanD 的可能性更大。置信度比率为\n$$\\text{Ratio}=\\frac{S^{\\text{PanD}}}{S^{\\text{GAD}}}\n=\\frac{\\frac{159}{232}}{\\frac{211}{580}}\n=\\frac{159\\cdot 580}{232\\cdot 211}\n=\\frac{23055}{12238}\\approx 1.883886.$$\n\n四舍五入到三位有效数字，该比率为 $1.88$。", "answer": "$$\\boxed{1.88}$$", "id": "1419495"}]}