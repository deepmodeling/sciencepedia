{"hands_on_practices": [{"introduction": "定量系统药理学的核心是使用数学模型来描述和预测药物对生物系统的影响。本练习将介绍描述剂量-反应关系的基石——希尔方程。通过一个关于代谢物丁酸盐如何影响免疫细胞分化的假设场景，您将直接应用希尔函数，这有助于您建立关于浓度变化如何根据系统的敏感性参数（如 $EC_{50}$ 和希尔系数 $n$）转化为生物效应变化的直观理解。[@problem_id:2859953]", "problem": "在炎症性肠病 (IBD) 的黏膜免疫调节背景下，考虑短链脂肪酸 (SCFA) 丁酸盐，一种微生物代谢物，已知其通过抑制组蛋白去乙酰化酶 (HDAC) 来增强叉头盒蛋白P3 (Foxp3) 调节性T细胞 (Tregs) 的分化。假设初始CD4 T细胞中Foxp3的稳态诱导速率通过一种协同、可饱和的响应依赖于丁酸盐浓度，其特征在于半数有效浓度 (EC50) 和希尔系数，并且在所考虑的条件下具有恒定的最大诱导能力。\n\n假设一项膳食纤维干预将结肠中的丁酸盐浓度从 $0.2\\ \\mathrm{mM}$ 增加到 $1.0\\ \\mathrm{mM}$。Treg对丁酸盐诱导响应的药效学敏感性参数为 $EC_{50}=0.5\\ \\mathrm{mM}$ 和希尔系数 $n=2$。假设非丁酸盐效应保持不变，且最大Treg诱导能力恒定，计算当丁酸盐浓度从 $0.2\\ \\mathrm{mM}$ 上升到 $1.0\\ \\mathrm{mM}$ 时，归一化Foxp3诱导效应的倍数变化。\n\n将您的最终答案表示为单个无量纲数。以最简精确分数形式给出结果，不带单位。", "solution": "我们从配体协同、可饱和响应的标准药效学表示开始，该响应由希尔型函数建模。对于配体浓度 $[B]$（此处为丁酸盐），其对在最大容量 $E_{\\max}$ 处饱和的输出 $E([B])$ 的归一化效应由下式给出\n$$\nE([B]) \\;=\\; E_{\\max}\\,\\frac{[B]^{n}}{EC_{50}^{n} + [B]^{n}},\n$$\n其中 $EC_{50}$ 是半数有效浓度，$n$ 是捕捉协同性的希尔系数。此表示方法源于推广至协同结合和下游信号放大的平衡占据原理，这些原理在药效学剂量-反应行为中已得到充分证实。\n\n我们被要求计算当丁酸盐浓度从 $[B]_{1} = 0.2\\ \\mathrm{mM}$ 增加到 $[B]_{2} = 1.0\\ \\mathrm{mM}$ 时，归一化诱导效应的倍数变化，给定 $EC_{50} = 0.5\\ \\mathrm{mM}$ 和 $n=2$。倍数变化 $F$ 定义为\n$$\nF \\;=\\; \\frac{E([B]_{2})}{E([B]_{1})}.\n$$\n使用上面的希尔形式，我们进行代入并注意到 $E_{\\max}$ 会消去：\n$$\nF \\;=\\; \\frac{E_{\\max}\\,\\frac{[B]_{2}^{n}}{EC_{50}^{n} + [B]_{2}^{n}}}{E_{\\max}\\,\\frac{[B]_{1}^{n}}{EC_{50}^{n} + [B]_{1}^{n}}}\n\\;=\\; \\frac{\\frac{[B]_{2}^{n}}{EC_{50}^{n} + [B]_{2}^{n}}}{\\frac{[B]_{1}^{n}}{EC_{50}^{n} + [B]_{1}^{n}}}\n\\;=\\; \\frac{[B]_{2}^{n}}{EC_{50}^{n} + [B]_{2}^{n}} \\cdot \\frac{EC_{50}^{n} + [B]_{1}^{n}}{[B]_{1}^{n}}.\n$$\n现在代入 $n=2$，$[B]_{2} = 1.0\\ \\mathrm{mM}$，$[B]_{1} = 0.2\\ \\mathrm{mM}$ 和 $EC_{50} = 0.5\\ \\mathrm{mM}$：\n$$\n[B]_{2}^{2} = (1.0)^{2} = 1,\\quad [B]_{1}^{2} = (0.2)^{2} = 0.04,\\quad EC_{50}^{2} = (0.5)^{2} = 0.25.\n$$\n因此，\n$$\nF \\;=\\; \\frac{1}{0.25 + 1} \\cdot \\frac{0.25 + 0.04}{0.04}\n\\;=\\; \\frac{1}{1.25} \\cdot \\frac{0.29}{0.04}.\n$$\n将十进制数量转换为精确的有理数：\n$$\n1.25 \\;=\\; \\frac{5}{4},\\quad 0.29 \\;=\\; \\frac{29}{100},\\quad 0.04 \\;=\\; \\frac{4}{100}.\n$$\n因此，\n$$\nF \\;=\\; \\frac{1}{\\frac{5}{4}} \\cdot \\frac{\\frac{29}{100}}{\\frac{4}{100}}\n\\;=\\; \\frac{4}{5} \\cdot \\frac{29}{4}\n\\;=\\; \\frac{29}{5}.\n$$\n因此，归一化Foxp3诱导效应的倍数变化为精确分数 $29/5$。", "answer": "$$\\boxed{\\frac{29}{5}}$$", "id": "2859953"}, {"introduction": "几乎所有药物作用的第一步都是与靶点受体的结合。这个练习将带您超越简单的即插即用公式，挑战您从基本原理出发构建一个结合模型。您将从质量作用定律和质量守恒定律出发，推导出一个更真实的模型，该模型考虑了“配体耗尽”这一重要的现实世界现象，即药物浓度并非远超其靶点。通过这个过程，您将揭示简化模型背后的假设，并学会分析靶点浓度显著影响游离药物浓度的系统。[@problem_id:2813040]", "problem": "一种固醇类激素在细胞核中根据单位点可逆结合平衡与其同源核受体 (NR) 结合。设核受体总浓度为 $R_{T} = 10\\ \\text{nM}$，解离常数（定义为 $K_{d} = \\frac{[R][L]}{[RL]}$）为 $K_{d} = 5\\ \\text{nM}$。向细胞核中加入配体，使其总浓度达到已知的 $L_{T}$，并且因与受体结合而引起的配体耗尽不能先验地忽略。从质量作用定律、$K_{d}$ 的定义以及受体和配体的质量守恒出发，完成以下任务：\n\n1. 推导受体占有率 $f(L_{T})$（定义为 $f(L_{T}) = \\frac{[RL]}{R_{T}}$）的解析表达式，该表达式是 $R_{T}$、$K_{d}$ 和 $L_{T}$ 的函数，且不假设游离配体浓度等于总配体浓度。\n\n2. 使用你推导的表达式，计算当 $L_{T} = 1\\ \\text{nM}$、$L_{T} = 5\\ \\text{nM}$ 和 $L_{T} = 50\\ \\text{nM}$ 时的受体占有率。\n\n3. 假设转录输出 $T(L_{T})$ 与占有率成正比，且基础活性可忽略不计，即 $T(L_{T}) = \\alpha\\, f(L_{T})$，其中 $\\alpha$ 为某个比例常数（任意单位），因此最大转录输出为 $T_{\\max} = \\alpha$。使用你推导的 $f(L_{T})$，写出 $T(L_{T})$ 的表达式（以比例常数 $\\alpha$ 表示），并推断转录响应作为 $L_{T}$ 函数的定性形状。\n\n4. 在此模型下，确定能产生 $T(L_{T}^{(0.8)}) = 0.8\\, T_{\\max}$ 的总配体浓度 $L_{T}^{(0.8)}$。你的最终答案需以 $\\text{nM}$ 为单位表示，并四舍五入到三位有效数字。", "solution": "问题陈述具有科学依据、提法明确且完整。它描述了一个带有配体耗尽的标准可逆结合平衡，这是定量药理学和系统生物学中一个常见且重要的案例。我们将按要求进行推导和计算。\n\n配体 $L$ 与受体 $R$ 的结合由以下可逆反应描述：\n$$ R + L \\rightleftharpoons RL $$\n在平衡状态下，该系统由三个基本关系决定。\n\n解离常数 $K_{d}$ 定义为：\n$$ K_{d} = \\frac{[R][L]}{[RL]} $$\n其中 $[R]$、$[L]$ 和 $[RL]$ 分别是游离受体、游离配体和受体-配体复合物的平衡浓度。\n\n受体的质量守恒为：\n$$ R_{T} = [R] + [RL] $$\n其中 $R_{T}$ 是总受体浓度。\n\n配体的质量守恒为：\n$$ L_{T} = [L] + [RL] $$\n其中 $L_{T}$ 是总配体浓度。问题指明了 $[L]$ 不一定等于 $L_{T}$，当因结合引起的配体耗尽显著时，这是一种正确的方法。\n\n第 $1$ 部分：推导受体占有率 $f(L_{T})$。\n\n我们的目标是找到受体占有率 $f(L_{T}) = \\frac{[RL]}{R_{T}}$ 的表达式，该表达式用已知量 $R_{T}$、$L_{T}$ 和 $K_{d}$ 表示。为此，我们必须首先找到 $[RL]$ 的表达式。\n\n根据质量守恒方程，我们用复合物浓度 $[RL]$ 来表示游离浓度：\n$$ [R] = R_{T} - [RL] $$\n$$ [L] = L_{T} - [RL] $$\n将这些表达式代入 $K_{d}$ 的定义中：\n$$ K_{d} = \\frac{(R_{T} - [RL])(L_{T} - [RL])}{[RL]} $$\n我们现在必须求解这个关于 $[RL]$ 的方程。重新整理方程得到：\n$$ K_{d}[RL] = (R_{T} - [RL])(L_{T} - [RL]) $$\n$$ K_{d}[RL] = R_{T}L_{T} - R_{T}[RL] - L_{T}[RL] + [RL]^2 $$\n将所有项移到一边，得到一个关于 $[RL]$ 的二次方程：\n$$ [RL]^2 - (R_{T} + L_{T} + K_{d})[RL] + R_{T}L_{T} = 0 $$\n这是一个标准形式为 $ax^2 + bx + c = 0$ 的二次方程，其中 $x = [RL]$，$a = 1$，$b = -(R_{T} + L_{T} + K_{d})$，$c = R_{T}L_{T}$。解由二次公式给出：\n$$ [RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\n$$ [RL] = \\frac{(R_{T} + L_{T} + K_{d}) \\pm \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2} $$\n我们必须选择具有物理意义的根。复合物 $[RL]$ 的浓度不能超过受体总浓度 ($R_{T}$) 或配体总浓度 ($L_{T}$)。正根会得出一个大于 $R_{T} + L_{T}$ 的 $[RL]$ 值，这在物理上是不可能的。因此，我们必须选择负根。\n$$ [RL] = \\frac{(R_{T} + L_{T} + K_{d}) - \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2} $$\n将 $[RL]$ 除以 $R_{T}$，即可得到受体占有率 $f(L_{T})$：\n$$ f(L_{T}) = \\frac{[RL]}{R_{T}} = \\frac{(R_{T} + L_{T} + K_{d}) - \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2R_{T}} $$\n这就是所要求的解析表达式。\n\n第 $2$ 部分：计算受体占有率。\n\n给定 $R_{T} = 10\\ \\text{nM}$ 和 $K_{d} = 5\\ \\text{nM}$。我们使用推导出的 $f(L_{T})$ 表达式来计算三种不同总配体浓度下的占有率。\n\n对于 $L_{T} = 1\\ \\text{nM}$：\n$$ f(1) = \\frac{(10 + 1 + 5) - \\sqrt{(10 + 1 + 5)^2 - 4(10)(1)}}{2(10)} $$\n$$ f(1) = \\frac{16 - \\sqrt{16^2 - 40}}{20} = \\frac{16 - \\sqrt{256 - 40}}{20} = \\frac{16 - \\sqrt{216}}{20} $$\n$$ f(1) = \\frac{16 - 6\\sqrt{6}}{20} = \\frac{8 - 3\\sqrt{6}}{10} \\approx 0.0652 $$\n\n对于 $L_{T} = 5\\ \\text{nM}$：\n$$ f(5) = \\frac{(10 + 5 + 5) - \\sqrt{(10 + 5 + 5)^2 - 4(10)(5)}}{2(10)} $$\n$$ f(5) = \\frac{20 - \\sqrt{20^2 - 200}}{20} = \\frac{20 - \\sqrt{400 - 200}}{20} = \\frac{20 - \\sqrt{200}}{20} $$\n$$ f(5) = \\frac{20 - 10\\sqrt{2}}{20} = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.293 $$\n\n对于 $L_{T} = 50\\ \\text{nM}$：\n$$ f(50) = \\frac{(10 + 50 + 5) - \\sqrt{(10 + 50 + 5)^2 - 4(10)(50)}}{2(10)} $$\n$$ f(50) = \\frac{65 - \\sqrt{65^2 - 2000}}{20} = \\frac{65 - \\sqrt{4225 - 2000}}{20} = \\frac{65 - \\sqrt{2225}}{20} $$\n$$ f(50) = \\frac{65 - 5\\sqrt{89}}{20} = \\frac{13 - \\sqrt{89}}{4} \\approx 0.892 $$\n\n第 $3$ 部分：转录响应的定性形状。\n\n转录输出 $T(L_{T})$ 与占有率 $f(L_{T})$ 成正比，即 $T(L_{T}) = \\alpha\\, f(L_{T})$。最大输出为 $T_{\\max} = \\alpha$。因此，转录响应曲线作为 $L_{T}$ 的函数，其形状与占有率曲线 $f(L_{T})$ 相同，只是在垂直方向上按常数 $\\alpha$进行了缩放。\n根据 $f(L_{T})$ 的表达式：\n- 当 $L_{T} = 0$ 时，$[RL] = 0$，所以 $f(0) = 0$。响应从零开始。\n- 随着 $L_{T}$ 的增加，$[RL]$ 也增加。对导数 $\\frac{df}{dL_{T}}$ 的简单分析表明它总是正的，因此函数是单调递增的。\n- 当 $L_{T} \\to \\infty$ 时，受体达到饱和。在此极限下，$[RL] \\to R_{T}$，这意味着 $f(L_{T}) \\to 1$。\n因此，转录响应 $T(L_{T})$ 从 0 开始，随 $L_{T}$ 单调增加，并渐近地趋近于一个最大值 $T_{\\max} = \\alpha$。其形状是一条饱和的、类双曲线的曲线，这是由质量作用定律决定的剂量-反应关系的典型特征。\n\n第 $4$ 部分：计算 $L_{T}^{(0.8)}$。\n\n我们需要找到能产生最大转录输出 $80\\%$ 的总配体浓度 $L_{T}^{(0.8)}$。\n$$ T(L_{T}^{(0.8)}) = 0.8\\, T_{\\max} $$\n代入 $T(L_{T})$ 和 $T_{\\max}$ 的定义：\n$$ \\alpha\\, f(L_{T}^{(0.8)}) = 0.8\\, \\alpha $$\n这可以简化为寻找使受体占有率为 $0.8$ 的配体浓度：\n$$ f(L_{T}^{(0.8)}) = 0.8 $$\n根据定义，$f(L_{T}) = \\frac{[RL]}{R_{T}}$。所以我们有：\n$$ \\frac{[RL]}{R_{T}} = 0.8 \\implies [RL] = 0.8\\, R_{T} $$\n使用给定值 $R_{T} = 10\\ \\text{nM}$：\n$$ [RL] = 0.8 \\times 10\\ \\text{nM} = 8\\ \\text{nM} $$\n现在我们必须找到产生此复合物平衡浓度的总配体浓度 $L_{T}$。我们可以利用基本方程进行反向推算。\n首先，求出游离受体浓度 $[R]$：\n$$ [R] = R_{T} - [RL] = 10\\ \\text{nM} - 8\\ \\text{nM} = 2\\ \\text{nM} $$\n接下来，使用 $K_{d}$ 的定义来求出游离配体浓度 $[L]$：\n$$ K_{d} = \\frac{[R][L]}{[RL]} \\implies [L] = \\frac{K_{d}[RL]}{[R]} $$\n使用 $K_{d} = 5\\ \\text{nM}$：\n$$ [L] = \\frac{(5\\ \\text{nM})(8\\ \\text{nM})}{2\\ \\text{nM}} = 20\\ \\text{nM} $$\n最后，使用配体的质量平衡方程来求出总配体浓度 $L_{T}$：\n$$ L_{T} = [L] + [RL] $$\n$$ L_{T}^{(0.8)} = 20\\ \\text{nM} + 8\\ \\text{nM} = 28\\ \\text{nM} $$\n问题要求答案四舍五入到三位有效数字，即 $28.0\\ \\text{nM}$。", "answer": "$$\n\\boxed{28.0}\n$$", "id": "2813040"}, {"introduction": "从充满噪声的实验数据中提取有意义的生物学参数，是定量系统药理学的一项中心任务。这项实践将理论模型与真实世界的研究联系起来。您将学习如何使用非线性最小二乘法回归，将理论模型（如希尔方程）拟合到剂量-反应数据中，从而估计如 $EC_{50}$ 等关键参数，并量化我们对这些估计值的信心。这是一项现代定量生物学的基石技能，能让您体会如何将原始测量数据转化为关于信号通路敏感性的可操作见解。[@problem_id:2961642]", "problem": "您正在研究由表皮生长因子（EGF）激活的 Ras-丝裂原活化蛋白激酶（Ras-MAPK）信号级联反应，具体方法是测量稳态下磷酸化细胞外信号调节激酶（ERK）的比例随细胞外配体浓度的变化。假设以下常用于受体介导的协同激活信号传导的基础理论：(i) 受体-配体结合遵循质量作用定律，(ii) 稳态下的信号输出是被占据或激活的受体比例及其下游协同步骤的单调函数，以及 (iii) 各剂量下的测量噪声是独立同分布的高斯噪声，且方差恒定。在这些假设下，一个与活化 Ras 比例和随后的 ERK 磷酸化相符的协同激活模型，使用一个具有四个参数的可饱和、单调和协同的函数，将配体浓度 $c$ 映射到响应 $y(c)$：基础响应 $B$（无单位分数）、最大响应 $T$（无单位分数）、半数有效浓度 $EC_{50}$（单位 nM）和一个 Hill 系数 $n$（无单位，$n>0$）。参数 $EC_{50}$ 定义为响应值介于 $B$ 和 $T$ 中间点时的浓度 $c$。在高斯噪声下的非线性回归意味着参数的最大似然估计会最小化残差平方和。\n\n任务：对于下方的每个数据集，通过非线性最小二乘法，将一个与要点 (i)–(iii) 一致且参数为 $(B,T,EC_{50},n)$ 的协同激活模型拟合到所提供的剂量-响应数据。然后，利用参数估计的渐近正态近似，从估计的参数协方差计算 $EC_{50}$ 的双侧 $0.95$ 置信区间（使用 Student $t$ 分布的分位数，其自由度等于数据点数减去参数数量）。最终结果必须以纳摩尔（nM）为单位报告。\n\n数据集（每个响应都是稳态下磷酸化 ERK 的比例，无单位）：\n\n- 数据集 A（典型上皮细胞系中的 EGF；具有广泛覆盖范围的“理想路径”）\n  - 浓度（nM）：$0$, $0.1$, $0.3$, $1$, $3$, $10$, $30$。\n  - 响应（无单位）：$0.050$, $0.077$, $0.130$, $0.328$, $0.605$, $0.843$, $0.911$。\n\n- 数据集 B（Ras 依赖背景下的神经生长因子样协同机制）\n  - 浓度（nM）：$0$, $0.01$, $0.03$, $0.1$, $0.3$, $1$, $3$, $10$。\n  - 响应（无单位）：$0.020$, $0.0208$, $0.0272$, $0.096$, $0.380$, $0.694$, $0.739$, $0.743$。\n\n- 数据集 C（剂量敏感度较低的突变体；在测试范围内未完全饱和）\n  - 浓度（nM）：$0$, $1$, $3$, $10$, $30$, $100$。\n  - 响应（无单位）：$0.100$, $0.157$, $0.203$, $0.295$, $0.382$, $0.484$。\n\n- 数据集 D（接近零的基础响应；更宽的动态范围和更高的 $EC_{50}$）\n  - 浓度（nM）：$0$, $5$, $10$, $30$, $50$, $100$, $300$。\n  - 响应（无单位）：$0.000$, $0.033$, $0.086$, $0.314$, $0.503$, $0.743$, $0.930$。\n\n拟合要求和约束条件：\n- 使用一个四参数协同激活模型，其参数为 $(B,T,EC_{50},n)$，满足 $0 \\le B \\le T \\le 1$，$EC_{50} > 0$（单位 nM），以及 $n \\in (0,5]$。\n- 使用非线性最小二乘法同时估计所有四个参数。\n- 使用基于 Jacobian 矩阵的参数估计渐近协方差来计算 $EC_{50}$ 的标准误，并使用自由度为 $N-4$（其中 $N$ 是数据集中的数据点数量）的 Student $t$ 分位数构建双侧 $0.95$ 置信区间。\n- 将 $EC_{50}$ 及其置信区间边界以 nM 为单位表示为浮点数。\n- 将所有报告的数值输出四舍五入到 $4$ 位有效数字。\n\n测试套件和预期输出：\n- 程序必须将所有四个数据集 A–D 作为一个固定的测试套件进行处理。\n- 对于每个数据集，计算并返回一个包含估计的 $EC_{50}$（单位 nM）及其双侧 $0.95$ 置信区间的下限和上限（单位 nM）的三元组，每个值都四舍五入到 $4$ 位有效数字。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个数据集的三元组都包含在自己的方括号中，并按 $[A,B,C,D]$ 的顺序排列。例如，格式必须完全像 $[[a\\_1,a\\_2,a\\_3],[b\\_1,b\\_2,b\\_3],[c\\_1,c\\_2,c\\_3],[d\\_1,d\\_2,d\\_3]]$，其中每个 $a\\_i$、$b\\_i$、$c\\_i$、$d\\_i$ 是以 nM 为单位且四舍五入到 $4$ 位有效数字的浮点数。不得打印任何额外文本。", "solution": "我们利用第一性原理，将 Ras-丝裂原活化蛋白激酶（Ras-MAPK）级联反应的生物学机制与协同剂量-响应模型联系起来。受体-配体相互作用遵循质量作用定律：被占据的受体比例随配体浓度 $c$ 单调增加。Ras-MAPK 中的下游招募和激活步骤可以表现出协同性，从而有效地产生一个通过指数为 $n$ 的 S 型变换依赖于 $c$ 的响应。在稳态下，符合这些原理的一个最小且广泛使用的映射是一个可饱和的单调函数，其参数包括基础活性 $B$、最大活性 $T$、半数最大效应浓度 $EC_{50}$ 以及控制表观协同性的 Hill 系数 $n$。半数有效浓度 $EC_{50}$ 定义为响应值介于 $B$ 和 $T$ 中间点时的条件。\n\n从统计学的角度来看，假设在不同浓度下噪声是独立同分布的、方差恒定的高斯噪声；那么参数的最大似然估计会最小化残差平方和。因此，非线性最小二乘法是一个合适的估计器。设模型表示为\n$$\ny(c; \\theta) \\equiv B + (T - B)\\,\\frac{c^{n}}{EC_{50}^{n} + c^{n}},\n$$\n其参数向量为 $\\theta = (B, T, EC_{50}, n)$。约束条件 $0 \\le B \\le T \\le 1$、$EC_{50} > 0$ 和 $n \\in (0,5]$ 确保了生物学上的真实性（响应是分数，浓度是正数，协同性是有限且为正）。\n\n给定数据 $\\{(c_i, y_i)\\}_{i=1}^{N}$，非线性最小二乘估计器求解\n$$\n\\hat{\\theta} = \\arg\\min_{\\theta} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\theta)\\right]^2.\n$$\n在标准正则性条件下，$\\hat{\\theta}$ 是渐近正态的，其协方差可以通过观测到的 Fisher 信息的逆来近似。Gauss–Newton 近似得出\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) \\approx s^2 \\left(J^\\top J\\right)^{-1},\n$$\n其中 $J$ 是 Jacobian 矩阵，其元素为\n$$\nJ_{i,k} = \\frac{\\partial y(c_i;\\theta)}{\\partial \\theta_k}\\Bigg|_{\\theta=\\hat{\\theta}},\n$$\n而 $s^2$ 是残差方差估计量\n$$\ns^2 = \\frac{1}{N - p} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\hat{\\theta})\\right]^2,\n$$\n其中 $p=4$ 是参数的数量。许多非线性最小二乘法的软件实现，包括信赖域反射算法，会计算 $\\left(J^\\top J\\right)^{-1}$ 的估计值，并将其乘以 $s^2$ 以生成参数协方差矩阵的估计值。\n\n为了计算 $EC_{50}$ 的双侧 $0.95$ 置信区间，从协方差矩阵中提取 $EC_{50}$ 分量的方差估计值 $\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})$，即对应的对角线元素。标准误为\n$$\n\\mathrm{SE}(\\widehat{EC_{50}}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})}.\n$$\n当自由度为 $\\nu = N - p$ 时，置信水平为 $0.95$ 的双侧置信区间为\n$$\n\\widehat{EC_{50}} \\pm t_{1 - \\alpha/2,\\,\\nu}\\ \\mathrm{SE}(\\widehat{EC_{50}}),\n$$\n其中 $\\alpha = 1 - 0.95 = 0.05$，而 $t_{1 - \\alpha/2,\\,\\nu}$ 是具有 $\\nu$ 自由度的 Student $t$ 分布的 $(1 - \\alpha/2)$ 分位数。\n\n每个数据集的算法规划：\n1. 组合浓度向量 $c_i$（单位 nM）和响应向量 $y_i$（无单位）。\n2. 使用带边界约束 $0 \\le B \\le 1$, $0 \\le T \\le 1$, $EC_{50} \\in (0, \\infty)$ 和 $n \\in (0,5]$ 的非线性最小二乘法拟合四参数模型 $y(c;\\theta)$。一个有效的初始化方法是：将 $B$ 设为观测到的最小响应，将 $T$ 设为观测到的最大响应，将 $EC_{50}$ 设为正浓度值的中位数，将 $n$ 设为 $1$。\n3. 获取基于 Jacobian 矩阵的参数协方差矩阵，并计算 $\\widehat{EC_{50}}$ 的标准误。\n4. 当 $\\nu = N - 4$ 时，计算 $t_{1 - 0.025,\\,\\nu}$ 并构建 $EC_{50}$ 的双侧 $0.95$ 置信区间。\n5. 将点估计值和区间边界以 nM 为单位表示，并将每个值四舍五入到 $4$ 位有效数字。\n6. 按 $[A,B,C,D]$ 的顺序，使用格式 $[[a_1,a_2,a_3],[b_1,b_2,b_3],[c_1,c_2,c_3],[d_1,d_2,d_3]]$ 输出单行结果，其中每个数据集的三元组为 $[\\widehat{EC_{50}}, \\mathrm{CI}_{\\mathrm{low}}, \\mathrm{CI}_{\\mathrm{high}}]$。\n\n所提供的数据集涵盖了对 Ras-MAPK 信号推断至关重要的互补情景：具有良好动态范围的典型 S 型响应、具有亚纳摩尔级灵敏度的高度协同机制、因斜率平缓和不完全饱和而对可识别性构成挑战的情况，以及浓度跨越两个数量级的近零基础响应机制。带边界约束的非线性回归和渐近协方差计算共同产生了具有科学意义的 $EC_{50}$ 估计值及其置信区间，所有值均以纳摩尔为单位，适用于比较不同条件下的信号传导灵敏度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import t as student_t\n\ndef hill_response(c, B, T, EC50, n):\n    # Cooperative activation model, c in nM, responses unitless\n    # Ensure safe power for zero concentration: c**n is 0 when c=0 and n>0\n    return B + (T - B) * (np.power(c, n)) / (np.power(EC50, n) + np.power(c, n))\n\ndef fit_hill_and_ci(c, y):\n    c = np.asarray(c, dtype=float)\n    y = np.asarray(y, dtype=float)\n\n    # Initial guesses\n    B0 = float(np.clip(np.min(y), 0.0, 1.0))\n    T0 = float(np.clip(np.max(y), 0.0, 1.0))\n    # Avoid EC50 initialization at 0 due to zero concentrations; use median of positive concentrations\n    positive_c = c[c > 0]\n    EC500 = float(np.median(positive_c)) if positive_c.size > 0 else 1.0\n    n0 = 1.0\n\n    p0 = [B0, T0, EC500, n0]\n\n    # Bounds: 0 = B = 1, 0 = T = 1, EC50 in (1e-12, 1e9], n in (1e-6, 5]\n    # Also enforce B = T by using independent bounds and relying on optimizer; data typically ensure B=T.\n    lower_bounds = [0.0, 0.0, 1e-12, 1e-6]\n    upper_bounds = [1.0, 1.0, 1e9, 5.0]\n\n    # Fit\n    popt, pcov = curve_fit(\n        hill_response, c, y,\n        p0=p0, bounds=(lower_bounds, upper_bounds),\n        method='trf', max_nfev=10000\n    )\n\n    # Degrees of freedom\n    N = y.size\n    p = 4\n    dof = max(N - p, 1)\n\n    # curve_fit with absolute_sigma=False scales pcov by reduced chi^2 internally,\n    # but we will keep it as provided (already scaled) for standard errors.\n    # Extract standard error for EC50\n    se = np.sqrt(np.diag(pcov))\n    se_ec50 = float(se[2])\n\n    ec50_hat = float(popt[2])\n\n    # Two-sided 95% CI using Student t\n    alpha = 0.05\n    tcrit = float(student_t.ppf(1 - alpha/2.0, dof))\n    ci_low = ec50_hat - tcrit * se_ec50\n    ci_high = ec50_hat + tcrit * se_ec50\n\n    # Enforce positivity for CI bounds (biologically EC50 > 0)\n    ci_low = max(ci_low, 0.0)\n\n    return ec50_hat, ci_low, ci_high\n\ndef round_sig(x, sig=4):\n    if x == 0 or not np.isfinite(x):\n        return \"0\"\n    # Use general format with specified significant digits\n    return f\"{x:.{sig}g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Dataset A\n    c_A = np.array([0.0, 0.1, 0.3, 1.0, 3.0, 10.0, 30.0], dtype=float)\n    y_A = np.array([0.050, 0.077, 0.130, 0.328, 0.605, 0.843, 0.911], dtype=float)\n\n    # Dataset B\n    c_B = np.array([0.0, 0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0], dtype=float)\n    y_B = np.array([0.020, 0.0208, 0.0272, 0.096, 0.380, 0.694, 0.739, 0.743], dtype=float)\n\n    # Dataset C\n    c_C = np.array([0.0, 1.0, 3.0, 10.0, 30.0, 100.0], dtype=float)\n    y_C = np.array([0.100, 0.157, 0.203, 0.295, 0.382, 0.484], dtype=float)\n\n    # Dataset D\n    c_D = np.array([0.0, 5.0, 10.0, 30.0, 50.0, 100.0, 300.0], dtype=float)\n    y_D = np.array([0.000, 0.033, 0.086, 0.314, 0.503, 0.743, 0.930], dtype=float)\n\n    test_cases = [\n        (c_A, y_A),\n        (c_B, y_B),\n        (c_C, y_C),\n        (c_D, y_D),\n    ]\n\n    results = []\n    for c, y in test_cases:\n        ec50_hat, ci_low, ci_high = fit_hill_and_ci(c, y)\n        # Round to 4 significant figures as strings\n        results.append([round_sig(ec50_hat, 4), round_sig(ci_low, 4), round_sig(ci_high, 4)])\n\n    # Final print statement in the exact required format.\n    # Ensure single-line, nested list with comma-separated values.\n    formatted = \"[\" + \",\".join(\"[\" + \",\".join(map(str, triple)) + \"]\" for triple in results) + \"]\"\n    print(formatted)\n\nsolve()\n```", "id": "2961642"}]}