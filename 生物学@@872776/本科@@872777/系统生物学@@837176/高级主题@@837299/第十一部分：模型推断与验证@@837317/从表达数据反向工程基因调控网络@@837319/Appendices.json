{"hands_on_practices": [{"introduction": "假设存在调控关系最直接的方法之一是观察两个基因的表达水平是否同步变化。相关系数是实现此目的的主要工具，但并非所有相关性都是平等的。本练习旨在强调线性和单调关系之间的关键区别——这是生物系统中常见的特征，并说明为什么选择正确的统计量度（如斯皮尔曼相关性）对于准确捕捉这些联系至关重要。[@problem_id:1463699]", "problem": "一位系统生物学家正在研究一个基因调控网络（GRN）中潜在的调控相互作用。假设是转录因子基因 A 的表达正向调控靶基因 B 的表达。为了检验这一假设，该生物学家在六个独立的实验中测量了两种基因的表达水平（以任意单位计）。得到的数据对（基因 A 的表达量，基因 B 的表达量）如下：\n\n(1.0, 9.0), (2.0, 17.0), (5.0, 33.0), (10.0, 50.0), (20.0, 67.0), (50.0, 83.0)\n\n该生物学家希望使用相关系数来量化基因 A 和基因 B 表达水平之间关联的强度。两种常用的系数是皮尔逊相关系数（$r$）和斯皮尔曼等级相关系数（$\\rho$）。该生物学家计算出的值为 $r \\approx 0.82$ 和 $\\rho = 1.0$。\n\n根据所提供的数据和计算出的系数，以下哪个陈述是对该情况最准确的评估？\n\nA. 皮尔逊系数（$r \\approx 0.82$）和斯皮尔曼系数（$\\rho = 1.0$）的计算都是正确的，并且皮尔逊系数是识别这种潜在调控关系的更合适的度量。\n\nB. 皮尔逊系数（$r \\approx 0.82$）和斯皮尔曼系数（$\\rho = 1.0$）的计算都是正确的，并且斯皮尔曼系数是识别这种潜在调控关系的更合适的度量。\n\nC. 皮尔逊系数的计算不正确，但斯皮尔曼系数（$\\rho = 1.0$）的计算是正确的。斯皮尔曼系数是更合适的度量。\n\nD. 斯皮尔曼系数的计算不正确，但皮尔逊系数（$r \\approx 0.82$）的计算是正确的。皮尔逊系数是更合适的度量。\n\nE. 两个计算出的相关系数都不正确。", "solution": "问题要求我们判断皮尔逊和斯皮尔曼相关系数对于代表基因表达水平的给定数据集的适用性，并验证给定的计算值。\n\n首先，让我们理解这两个系数之间的区别。\n- **皮尔逊相关系数（$r$）** 衡量两个连续变量之间*线性*关系的强度和方向。它对异常值敏感，并假设数据近似正态分布。其取值范围为 -1 到 +1，其中 +1 表示完美的正线性相关，-1 表示完美的负线性相关，0 表示没有线性相关。\n- **斯皮尔曼等级相关系数（$\\rho$）** 衡量两个变量之间*单调*关系的强度和方向。单调关系是指变量倾向于向相同的相对方向移动，但不一定以恒定的速率（即，不一定是线性的）。它是通过计算两个变量的秩次的皮尔逊相关性来得出的。其取值范围也为 -1 到 +1。\n\n设基因 A 的表达量为变量 $X$，基因 B 的表达量为变量 $Y$。\n数据点如下：\n$X = [1.0, 2.0, 5.0, 10.0, 20.0, 50.0]$\n$Y = [9.0, 17.0, 33.0, 50.0, 67.0, 83.0]$\n\n**步骤 1：定性分析关系。**\n随着 $X$ 值的增加，$Y$ 的值也持续增加。这表明存在一个正向的单调关系。然而，这种关系并非完全线性。例如，$X$ 从 1 变为 2（差值为 1）对应于 $Y$ 从 9 变为 17（差值为 8），而 $X$ 从 20 变为 50（差值为 30）对应于 $Y$ 从 67 变为 83（差值为 16）。变化率不是恒定的，这表明存在一个非线性但单调的关系，可能表现出饱和现象，这在生物系统中很常见。\n\n**步骤 2：验证斯皮尔曼等级相关系数（$\\rho$）。**\n为了计算 $\\rho$，我们首先需要找到 $X$ 和 $Y$ 的秩次。秩次是数据点在有序列表中的位置。\n$X$ 的值已经按升序排列：$1.0, 2.0, 5.0, 10.0, 20.0, 50.0$。\n所以，$X$ 的秩次（$R_X$）是：$[1, 2, 3, 4, 5, 6]$。\n\n$Y$ 的值也按升序排列：$9.0, 17.0, 33.0, 50.0, 67.0, 83.0$。\n所以，$Y$ 的秩次（$R_Y$）是：$[1, 2, 3, 4, 5, 6]$。\n\n斯皮尔曼系数 $\\rho$ 是秩次变量 $R_X$ 和 $R_Y$ 的皮尔逊系数。由于对于所有数据点都有 $R_X = R_Y$，这些秩次具有完美的正线性关系。因此，它们的相关性恰好为 1。\n所以，$\\rho = 1.0$。问题中给出的值是正确的。\n\n**步骤 3：验证皮尔逊相关系数（$r$）。**\n皮尔逊系数的公式是：\n$$r = \\frac{\\sum_{i=1}^{n}(x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n}(x_i - \\bar{x})^2 \\sum_{i=1}^{n}(y_i - \\bar{y})^2}}$$\n其中 $n=6$。\n\n首先，我们计算均值 $\\bar{x}$ 和 $\\bar{y}$：\n$\\bar{x} = \\frac{1.0 + 2.0 + 5.0 + 10.0 + 20.0 + 50.0}{6} = \\frac{88.0}{6} \\approx 14.67$\n$\\bar{y} = \\frac{9.0 + 17.0 + 33.0 + 50.0 + 67.0 + 83.0}{6} = \\frac{259.0}{6} \\approx 43.17$\n\n接下来，我们计算公式所需的总和：\n$\\sum (x_i - \\bar{x})(y_i - \\bar{y}) = (1-14.67)(9-43.17) + \\dots + (50-14.67)(83-43.17) \\approx 2503.33$\n$\\sum (x_i - \\bar{x})^2 = (1-14.67)^2 + \\dots + (50-14.67)^2 \\approx 1739.33$\n$\\sum (y_i - \\bar{y})^2 = (9-43.17)^2 + \\dots + (83-43.17)^2 \\approx 2534.83$\n\n现在，我们可以计算 $r$：\n$$r = \\frac{2503.33}{\\sqrt{1739.33 \\times 2534.83}} = \\frac{2503.33}{\\sqrt{4408930.1}} = \\frac{2503.33}{2099.75} \\approx 0.8245$$\n四舍五入到两位小数得到 $r \\approx 0.82$。问题中给出的值是正确的。\n\n**步骤 4：确定更合适的系数。**\n我们已经确认两个计算出的系数都是正确的。现在我们必须决定哪一个更适合从这些数据中推断调控关系。\n数据表现出强烈的单调关系（$\\rho = 1.0$），但并非完全线性（$r \\approx 0.82  1.0$）。在生物学中，特别是在基因调控中，由于转录因子结合位点饱和等效应，关系通常是单调但非线性的。皮尔逊系数作为线性度的度量，会因为这种非线性而受到影响，从而低估了潜在单调关联的强度。\n相比之下，斯皮尔曼系数专门用于测量单调关系，无论其是否线性。$\\rho = 1.0$ 的值完美地捕捉了这样一个事实：即随着基因 A 表达的增加，基因 B 的表达也总是增加。这对于潜在的正向调控相互作用来说是一个非常强的信号。\n因此，在这种情况下，斯皮尔曼系数是更合适、信息量更大的度量。\n\n**步骤 5：选择正确的选项。**\n根据我们的分析：\n- 皮尔逊（$r \\approx 0.82$）和斯皮尔曼（$\\rho = 1.0$）系数的计算都是正确的。\n- 斯皮尔曼系数更适合这种非线性、单调的数据。\n\n这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1463699"}, {"introduction": "虽然相关性可以衡量关联的强度，但它并不能描述调控的底层逻辑。一种强大而有效的替代方法是使用布尔逻辑对基因调控进行建模，即基因要么处于“开”状态，要么处于“关”状态。本练习将挑战您根据实验结果进行逆向工程，推导出控制目标基因表达的精确逻辑规则（例如与、或、非），这是基因调控网络（GRN）离散建模的一项基本技能。[@problem_id:1463718]", "problem": "一位系统生物学家正在研究一个细菌物种内的小型基因调控网络（GRN）。该网络由三个转录因子TF-A、TF-B和TF-C组成，它们被认为调控一个目标基因——基因G。为了理解其调控逻辑，该生物学家进行了一系列实验，在实验中控制每个转录因子的存在或缺失，并观察基因G的最终表达情况。在这个简化的布尔模型中，状态“1”表示存在或表达（ON），而“0”表示缺失或不表达（OFF）。汇编的实验数据显示在下表中：\n\n| 实验编号 | TF-A状态 | TF-B状态 | TF-C状态 | 基因G状态 |\n| :---: | :---: | :---: | :---: | :---: |\n| 1 | 0 | 0 | 0 | 0 |\n| 2 | 0 | 0 | 1 | 0 |\n| 3 | 0 | 1 | 0 | 0 |\n| 4 | 0 | 1 | 1 | 0 |\n| 5 | 1 | 0 | 0 | 1 |\n| 6 | 1 | 0 | 1 | 1 |\n| 7 | 1 | 1 | 0 | 0 |\n| 8 | 1 | 1 | 1 | 0 |\n\n你的任务是根据转录因子的状态，推导出控制基因G表达的逻辑规则。设$A$、$B$和$C$分别表示TF-A、TF-B和TF-C的布尔状态。逻辑与运算符用乘法表示（例如，$A*B$），逻辑或运算符用加法表示（例如，$A+B$），逻辑非运算符用撇号表示（例如，$A'$）。\n\n下列哪个布尔表达式能准确地将基因G的状态表示为转录因子状态的函数？\n\nA. $G = A + B'$\n\nB. $G = A * C$\n\nC. $G = (A * B)'$\n\nD. $G = A * B'$\n\nE. $G = B + C'$\n\nF. $G = A + C$", "solution": "我们从真值表中读出使基因G为ON（开启）的输入组合。从数据中可知，当且仅当$(A,B,C)=(1,0,0)$和$(1,0,1)$时，$G=1$。以$A$为最高有效位，写出其规范的最小项之和形式为：\n$$\nG(A,B,C)=A B' C' + A B' C.\n$$\n提取公因式$A B'$：\n$$\nG = A B' (C' + C).\n$$\n应用互补律$C' + C = 1$：\n$$\nG = A B' \\cdot 1.\n$$\n应用同一律$X \\cdot 1 = X$：\n$$\nG = A B'.\n$$\n因此，该布尔规则与$C$无关，等于$A B'$，对应于选项D。快速核对所有实验可以证实，当且仅当$A=1$且$B=0$时，$G=1$，否则$G=0$，这与表格数据相符。", "answer": "$$\\boxed{D}$$", "id": "1463718"}, {"introduction": "在现实中，一个目标基因往往受到许多潜在转录因子的调控，我们的任务是从大量候选项中识别出真正的调控因子。这是一个经典的“特征选择”问题。本练习介绍了一种强大的机器学习技术——LASSO回归，它可以在构建预测模型的同时，通过将不相关的调控因子系数缩减为零来简化模型。您将练习一种黄金标准流程，即交叉验证，来选择最优模型，从而在预测准确性与模型简洁性之间取得平衡。[@problem_id:1463681]", "problem": "一位计算生物学家正在开发一个模型，以根据一组潜在调控基因的表达谱来预测目标基因的表达水平。该模型是一个惩罚线性回归模型，其中一个用 $\\lambda$ 表示的正则化参数控制着模型的复杂度。较小的 $\\lambda$ 会导致更复杂的模型，而较大的 $\\lambda$ 则通过将一些调控系数收缩至恰好为零，从而产生更简单的模型。\n\n为了确定 $\\lambda$ 的最优值，这位生物学家进行了一次参数扫描。可用的基因表达数据集被划分为 $K=5$ 个大小相等且不相交的子集，通常称为“折”。对于每个候选的 $\\lambda$ 值，使用来自 $K-1=4$ 折的数据训练一个模型，然后在剩下的一折（“测试折”）上进行评估。这个过程重复 $K=5$ 次，每一折都恰好作为测试折一次。在测试折上的性能通过平均预测平方误差来量化。\n\n下表总结了结果，显示了在四个不同的 $\\lambda$ 值下，5个折各自的平均预测平方误差。\n\n| $\\lambda$ | 第1折误差 | 第2折误差 | 第3折误差 | 第4折误差 | 第5折误差 |\n| :-------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n|   0.01    |     0.35     |     0.42     |     0.38     |     0.51     |     0.33     |\n|   0.10    |     0.25     |     0.29     |     0.22     |     0.31     |     0.28     |\n|   1.00    |     0.26     |     0.28     |     0.29     |     0.30     |     0.27     |\n|   10.0    |     0.85     |     0.88     |     0.82     |     0.90     |     0.86     |\n\n正则化参数的最优值 $\\lambda_{opt}$ 根据以下简约性准则来选择：\n\n1.  对于每个 $\\lambda$ 值，计算 $K$ 折的平均误差 $E_\\lambda$。\n2.  对于每个 $\\lambda$ 值，计算平均值的标准误差 $SE_\\lambda$。它由各折误差的样本标准差除以折数 $K$ 的平方根得出。\n3.  找出产生最低平均误差 $E_{min}$ 的 $\\lambda$ 值，记为 $\\lambda_{min}$。设与此模型相关的标准误差为 $SE_{min}$。\n4.  最优值 $\\lambda_{opt}$ 是满足其平均误差 $E_\\lambda$ 不超过最小平均误差加一个标准误差的 $\\lambda$ 的最大值。也就是说，$\\lambda_{opt}$ 是测试集合中满足条件 $E_\\lambda \\leq E_{min} + SE_{min}$ 的最大 $\\lambda$ 值。这个准则偏好于性能在统计上与最佳模型相似的更简单的模型（更大的 $\\lambda$）。\n\n根据所提供的数据和选择准则，正则化参数的最优值 $\\lambda_{opt}$ 是多少？", "solution": "我们应用 $K=5$ 的 $K$-折交叉验证简约性准则。对于每个 $\\lambda$，计算平均误差 $E_{\\lambda}$ 和平均值的标准误差 $SE_{\\lambda}$，其中\n$$\nE_{\\lambda}=\\frac{1}{K}\\sum_{i=1}^{K} e_{i,\\lambda}, \\quad s_{\\lambda}=\\sqrt{\\frac{1}{K-1}\\sum_{i=1}^{K}\\left(e_{i,\\lambda}-E_{\\lambda}\\right)^{2}}, \\quad SE_{\\lambda}=\\frac{s_{\\lambda}}{\\sqrt{K}}.\n$$\n\n计算每个 $\\lambda$ 的 $E_{\\lambda}$：\n$$\nE_{0.01}=\\frac{0.35+0.42+0.38+0.51+0.33}{5}=\\frac{1.99}{5}=0.398,\n$$\n$$\nE_{0.10}=\\frac{0.25+0.29+0.22+0.31+0.28}{5}=\\frac{1.35}{5}=0.27,\n$$\n$$\nE_{1.00}=\\frac{0.26+0.28+0.29+0.30+0.27}{5}=\\frac{1.40}{5}=0.28,\n$$\n$$\nE_{10.0}=\\frac{0.85+0.88+0.82+0.90+0.86}{5}=\\frac{4.31}{5}=0.862.\n$$\n最小平均误差为 $E_{\\min}=0.27$，此时 $\\lambda_{\\min}=0.10$。\n\n计算 $SE_{\\min}=SE_{0.10}$。首先，计算与 $E_{0.10}=0.27$ 的离差平方和：\n$$\n(0.25-0.27)^{2}+(0.29-0.27)^{2}+(0.22-0.27)^{2}+(0.31-0.27)^{2}+(0.28-0.27)^{2}\n$$\n$$\n=0.0004+0.0004+0.0025+0.0016+0.0001=0.0050.\n$$\n因此，\n$$\ns_{0.10}^{2}=\\frac{0.0050}{4}=0.00125,\\quad s_{0.10}=\\sqrt{0.00125},\n$$\n$$\nSE_{0.10}=\\frac{\\sqrt{0.00125}}{\\sqrt{5}}=\\sqrt{\\frac{0.00125}{5}}=\\sqrt{0.00025} \\approx 0.01581\n$$\n因此简约性阈值为\n$$\nT=E_{\\min}+SE_{\\min}=0.27+0.01581 = 0.28581\n$$\n\n选择满足 $E_{\\lambda}\\leq T$ 的最大测试 $\\lambda$ 值：\n$$\nE_{0.01}=0.398 > 0.28581,\\quad E_{0.10}=0.27\\leq 0.28581,\\quad E_{1.00}=0.28\\leq 0.28581,\\quad E_{10.0}=0.862 > 0.28581\n$$\n满足该准则的最大 $\\lambda$ 是 $\\lambda_{\\text{opt}}=1.00$。", "answer": "$$\\boxed{1.00}$$", "id": "1463681"}]}