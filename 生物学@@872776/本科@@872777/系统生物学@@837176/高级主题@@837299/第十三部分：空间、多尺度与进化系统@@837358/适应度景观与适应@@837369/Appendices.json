{"hands_on_practices": [{"introduction": "在我们能够将适应度景观可视化之前，我们首先需要理解它所代表的“基因型空间”的广阔性。这个练习将让你亲身体会到，随着基因数量的增加，这个空间的规模是如何迅速增长的——这一现象被称为组合爆炸。通过计算一个简单系统中可能的基因型总数，你将为理解进化路径的复杂性奠定基础 [@problem_id:1434214]。", "problem": "在进化生物学和系统生物学中，“基因型空间”是指给定生物体或系统的所有可能遗传构型的集合。理解这个空间的大小是分析适应度景观和进化路径等概念的根本第一步。\n\n考虑一个病毒耐药性发展的简化模型。抗性表型由病毒基因组内特定数量的位置（称为位点）上的突变决定。我们假设在每个位点上，都恰好有两种可能的变体或等位基因：原始的、易感的“野生型”等位基因和新的、抗性的“突变型”等位基因。每个位点有两种可能等位基因的系统称为双等位基因系统。病毒在所有相关位点上的特定等位基因组合定义了其基因型。\n\n首先，计算一个简单的病毒株可能存在的独特基因型总数，其中抗性由 $L_1 = 3$ 个独立的双等位基因位点控制。\n\n其次，计算一个更复杂的病毒株可能存在的独特基因型总数，其中抗性涉及 $L_2 = 10$ 个独立的双等位基因位点。\n\n你的最终答案应该是两个整数，分别对应于 $L_1$ 和 $L_2$ 两种情况下的基因型数量。", "solution": "每个基因型是在每个位点上选择一个等位基因的结果。对于一个有 $L$ 个独立的双等位基因位点的系统，每个位点 $i$ 有 $2$ 种可能的等位基因。根据乘法法则，不同基因型的总数是所有位点上选择数的乘积：\n$$\nN(L)=\\prod_{i=1}^{L} 2=2^{L}.\n$$\n对于具有 $L_{1}=3$ 个位点的简单病毒株，\n$$\nN(L_{1})=2^{L_{1}}=2^{3}=8.\n$$\n对于具有 $L_{2}=10$ 个位点的复杂病毒株，\n$$\nN(L_{2})=2^{L_{2}}=2^{10}=1024.\n$$\n因此，所要求的两种基因型数量分别为 $8$ 和 $1024$。", "answer": "$$\\boxed{\\begin{pmatrix}8  1024\\end{pmatrix}}$$", "id": "1434214"}, {"introduction": "理解了基因型空间的规模后，下一步是为空间中的每个点赋予一个适应度值，从而构建出景观。这个问题将我们从离散的基因型空间带入一个连续的适应度景观，在这里我们可以运用微积分来预测进化的方向 [@problem_id:1434207]。它阐释了适应性“爬山”的核心思想，即在选择压力下，种群会倾向于向适应度梯度最陡峭的方向移动。", "problem": "在一项合成生物学实验中，一个细菌种群被设计成其适应度 $F$ 取决于两种蛋白质（蛋白质X和蛋白质Y）的细胞内浓度。设它们的浓度分别用 $x$ 和 $y$ 表示，单位为任意单位 (a.u.)。高浓度的蛋白质X是有益的，而高浓度的蛋白质Y是有害的。这种关系由以下适应度函数量化，该函数模拟了X的激活作用和Y的抑制作用的综合效应：\n$$F(x, y) = F_{max} \\left( \\frac{x^n}{K_x^n + x^n} \\right) \\left( \\frac{K_y^n}{K_y^n + y^n} \\right)$$\n该系统的参数如下：\n- 最大适应度，$F_{max} = 1.0$ (无量纲)\n- 希尔系数，$n = 2$\n- 蛋白质X的半最大激活常数，$K_x = 10 \\text{ a.u.}$\n- 蛋白质Y的半最大抑制常数，$K_y = 20 \\text{ a.u.}$\n\n最初，细菌种群的平均蛋白质表达状态为 $(x_0, y_0) = (K_x, K_y)$。假设在环境的选择压力下，该种群将“贪婪地”进化，意味着其蛋白质表达水平将沿着适应度景观上最陡峭的上升方向变化。\n\n确定初始的适应方向。将此方向表示为适应度函数在点 $(x_0, y_0)$ 处的梯度向量与x轴正方向所成的角度。答案以度为单位，并四舍五入到三位有效数字。", "solution": "种群沿着最陡峭的上升方向适应，该方向由梯度向量 $\\nabla F(x,y) = \\left( \\frac{\\partial F}{\\partial x}, \\frac{\\partial F}{\\partial y} \\right)$ 给出。\n\n令 $A(x) = \\frac{x^{n}}{K_{x}^{n} + x^{n}}$ 和 $R(y) = \\frac{K_{y}^{n}}{K_{y}^{n} + y^{n}}$，则 $F(x,y) = F_{\\max} A(x) R(y)$。\n\n那么\n$$\n\\frac{\\partial F}{\\partial x} = F_{\\max} R(y) A'(x), \\quad \\frac{\\partial F}{\\partial y} = F_{\\max} A(x) R'(y).\n$$\n使用商法则计算 $A'(x)$，其中 $f(x) = x^{n}$ 且 $g(x) = K_{x}^{n} + x^{n}$：\n$$\nA'(x) = \\frac{f'(x)g(x) - f(x)g'(x)}{g(x)^{2}} = \\frac{n x^{n-1} (K_{x}^{n} + x^{n}) - x^{n} n x^{n-1}}{(K_{x}^{n} + x^{n})^{2}} = \\frac{n K_{x}^{n} x^{n-1}}{(K_{x}^{n} + x^{n})^{2}}.\n$$\n类似地，\n$$\nR'(y) = \\frac{0 \\cdot (K_{y}^{n} + y^{n}) - K_{y}^{n} \\cdot n y^{n-1}}{(K_{y}^{n} + y^{n})^{2}} = - \\frac{n K_{y}^{n} y^{n-1}}{(K_{y}^{n} + y^{n})^{2}}.\n$$\n在点 $(x_{0}, y_{0}) = (K_{x}, K_{y})$ 处求值：\n$$\nA(K_{x}) = \\frac{K_{x}^{n}}{K_{x}^{n} + K_{x}^{n}} = \\frac{1}{2}, \\quad R(K_{y}) = \\frac{K_{y}^{n}}{K_{y}^{n} + K_{y}^{n}} = \\frac{1}{2},\n$$\n$$\nA'(K_{x}) = \\frac{n K_{x}^{n} K_{x}^{n-1}}{(2 K_{x}^{n})^{2}} = \\frac{n}{4 K_{x}}, \\quad R'(K_{y}) = - \\frac{n K_{y}^{n} K_{y}^{n-1}}{(2 K_{y}^{n})^{2}} = - \\frac{n}{4 K_{y}}.\n$$\n因此，\n$$\n\\left. \\frac{\\partial F}{\\partial x} \\right|_{(K_{x},K_{y})} = F_{\\max} \\cdot \\frac{1}{2} \\cdot \\frac{n}{4 K_{x}} = \\frac{F_{\\max} n}{8 K_{x}}, \\quad\n\\left. \\frac{\\partial F}{\\partial y} \\right|_{(K_{x},K_{y})} = F_{\\max} \\cdot \\frac{1}{2} \\cdot \\left( - \\frac{n}{4 K_{y}} \\right) = - \\frac{F_{\\max} n}{8 K_{y}}.\n$$\n因此，在点 $(K_{x}, K_{y})$ 处的梯度为\n$$\n\\nabla F(K_{x}, K_{y}) = \\left( \\frac{F_{\\max} n}{8 K_{x}}, \\, - \\frac{F_{\\max} n}{8 K_{y}} \\right).\n$$\n该向量与x轴正方向所成的角度 $\\theta$ 满足\n$$\n\\tan \\theta = \\frac{ \\left. \\frac{\\partial F}{\\partial y} \\right|_{(K_{x},K_{y})} }{ \\left. \\frac{\\partial F}{\\partial x} \\right|_{(K_{x},K_{y})} } = \\frac{ - \\frac{F_{\\max} n}{8 K_{y}} }{ \\frac{F_{\\max} n}{8 K_{x}} } = - \\frac{K_{x}}{K_{y}}.\n$$\n当 $F_{\\max} = 1$, $n = 2$, $K_{x} = 10$, 且 $K_{y} = 20$ 时，上式变为\n$$\n\\tan \\theta = - \\frac{10}{20} = - \\frac{1}{2}.\n$$\n由于x分量为正，y分量为负，梯度位于第四象限，所以\n$$\n\\theta = \\arctan\\!\\left( - \\frac{1}{2} \\right) = - \\frac{180}{\\pi} \\arctan\\!\\left( \\frac{1}{2} \\right) \\approx -26.565051\\ \\text{degrees}.\n$$\n四舍五入到三位有效数字，初始适应方向为 $-26.6$ 度。", "answer": "$$\\boxed{-26.6}$$", "id": "1434207"}, {"introduction": "真实的适应度景观很少是平滑的山丘；它们通常是“崎岖的”，充满了多个山峰和山谷。这个练习深入探讨了这种崎岖景观的复杂性，它直接影响着进化的可预测性 [@problem_id:1434220]。通过分析一个虽小但完整的景观，你将学会识别局部最优点（local fitness peak）等关键特征，并追踪可能的进化路径，从而深入理解景观结构是如何决定适应过程的。", "problem": "在演化系统生物学中，适应度景观（fitness landscape）是指从一组基因型到其适应度值的映射。考虑一个具有4个基因座的单倍体生物的简化模型，其中每个基因座可以有两个等位基因中的一个（用0或1表示）。因此，一个基因型可以用一个4位二进制字符串表示，从'0000'（野生型）到'1111'。下表给出了16种可能基因型中每一种的适应度（以繁殖率衡量）。\n\n| 基因型   | 适应度 | 基因型   | 适应度 |\n| :------: | :-----: | :------: | :-----: |\n| 0000     | 1.0     | 1000     | 2.5     |\n| 0001     | 0.7     | 1001     | 2.2     |\n| 0010     | 2.8     | 1010     | 4.5     |\n| 0011     | 2.7     | 1011     | 7.0     |\n| 0100     | 0.8     | 1100     | 5.0     |\n| 0101     | 4.0     | 1101     | 3.5     |\n| 0110     | 1.5     | 1110     | 6.0     |\n| 0111     | 3.8     | 1111     | 8.0     |\n\n我们定义以下术语：\n- 单步突变（single-step mutation）是指二进制字符串中恰好改变一个数字（例如，'1010'是'1011'的单步突变体）。\n- “全局适应度峰”（global fitness peak）是整个景观中具有最高适应度值的基因型。\n- “局部适应度峰”（local fitness peak）是一个适应度严格大于其所有单步突变邻居的基因型。全局峰也被认为是一个局部峰。\n- “适应性路径”（adaptive path）是一个基因型序列，从初始基因型开始，到目标基因型结束，序列中的每个后续基因型都是通过单步突变到达的，并且具有严格更高的适应度值。\n\n设 $L$ 是该景观中局部适应度峰的总数。设 $P$ 是从野生型基因型'0000'到全局适应度峰的不同适应性路径的数量。\n\n计算比率 $P/L$，这是一个将演化的可预测性与景观的崎岖性联系起来的度量。将您的最终答案四舍五入到两位有效数字。", "solution": "我们将基因型视为一个四维超立方体的顶点，如果两个基因型之间仅相差一个比特，则它们之间存在一条边。设 $f(g)$ 表示基因型 $g$ 的适应度。一个适应性步骤是从 $g$ 到 $h$ 的一条边，其汉明距离为1且 $f(h)f(g)$。所有适应性步骤的集合定义了一个按适应度递增方向排列的有向无环图 (DAG)。因此，从 $0000$ 到 $1111$ 的一条适应性路径就是这个DAG中从 $0000$ 到 $1111$ 的一条有向路径。\n\n首先，通过找出表中的最大适应度来确定全局峰。最大值为 $f(1111)=8.0$，所以全局峰是 $1111$。\n\n接下来，计算局部峰的数量。如果一个基因型 $g$ 对于它的四个单步邻居 $h$ 中的每一个，都有 $f(g)f(h)$，那么它就是一个局部峰。我们检查每个基因型：\n\n- $0000$：邻居 $1000$ ($2.5$)、$0100$ ($0.8$)、$0010$ ($2.8$)、$0001$ ($0.7$)。由于 $2.51.0$ 且 $2.81.0$，不是一个峰。\n- $0001$：邻居 $1001$ ($2.2$)、$0101$ ($4.0$)、$0011$ ($2.7$)、$0000$ ($1.0$)。由于有几个邻居的适应度更高，不是一个峰。\n- $0010$：邻居 $1010$ ($4.5$)、$0110$ ($1.5$)、$0000$ ($1.0$)、$0011$ ($2.7$)。由于 $4.52.8$，不是一个峰。\n- $0011$：邻居 $1011$ ($7.0$)、$0111$ ($3.8$)、$0001$ ($0.7$)、$0010$ ($2.8$)。由于邻居 $1011$ ($7.0$)、$0111$ ($3.8$) 和 $0010$ ($2.8$) 的适应度更高，不是一个峰。\n- $0100$：邻居 $1100$ ($5.0$)、$0000$ ($1.0$)、$0110$ ($1.5$)、$0101$ ($4.0$)。由于其所有邻居 $1100$ ($5.0$)、$0000$ ($1.0$)、$0110$ ($1.5$) 和 $0101$ ($4.0$) 的适应度都更高，不是一个峰。\n- $0101$：邻居 $1101$ ($3.5$)、$0001$ ($0.7$)、$0111$ ($3.8$)、$0100$ ($0.8$)。所有邻居的适应度都更低：$4.03.5$，$4.00.7$，$4.03.8$，$4.00.8$。因此 $0101$ 是一个局部峰。\n- $0110$：邻居 $1110$ ($6.0$)、$0010$ ($2.8$)、$0100$ ($0.8$)、$0111$ ($3.8$)。由于有几个邻居的适应度更高，不是一个峰。\n- $0111$：邻居 $1111$ ($8.0$)、$0011$ ($2.7$)、$0101$ ($4.0$)、$0110$ ($1.5$)。由于 $8.03.8$ 且 $4.03.8$，不是一个峰。\n- $1000$：邻居 $0000$ ($1.0$)、$1100$ ($5.0$)、$1010$ ($4.5$)、$1001$ ($2.2$)。由于 $5.02.5$ 且 $4.52.5$，不是一个峰。\n- $1001$：邻居 $0001$ ($0.7$)、$1101$ ($3.5$)、$1011$ ($7.0$)、$1000$ ($2.5$)。由于邻居 $1101$ ($3.5$)、$1011$ ($7.0$) 和 $1000$ ($2.5$) 的适应度更高，不是一个峰。\n- $1010$：邻居 $0010$ ($2.8$)、$1110$ ($6.0$)、$1000$ ($2.5$)、$1011$ ($7.0$)。由于邻居 $1110$ ($6.0$) 和 $1011$ ($7.0$) 的适应度更高，不是一个峰。\n- $1011$：邻居 $0011$ ($2.7$)、$1111$ ($8.0$)、$1001$ ($2.2$)、$1010$ ($4.5$)。由于 $8.07.0$，不是一个峰。\n- $1100$：邻居 $0100$ ($0.8$)、$1000$ ($2.5$)、$1110$ ($6.0$)、$1101$ ($3.5$)。由于 $6.05.0$，不是一个峰。\n- $1101$：邻居 $0101$ ($4.0$)、$1001$ ($2.2$)、$1111$ ($8.0$)、$1100$ ($5.0$)。由于邻居 $0101$ ($4.0$)、$1111$ ($8.0$) 和 $1100$ ($5.0$) 的适应度更高，不是一个峰。\n- $1110$：邻居 $0110$ ($1.5$)、$1010$ ($4.5$)、$1100$ ($5.0$)、$1111$ ($8.0$)。由于 $8.06.0$，不是一个峰。\n- $1111$：作为全局最大值，所有邻居的适应度都更低；它是一个局部峰。\n\n因此，局部适应度峰的总数是 $L=2$（即 $0101$ 和 $1111$）。\n\n现在计算 $P$，即从 $0000$ 到 $1111$ 的适应性路径的数量。通过列出从 $0000$ 可达的节点的出边（适应度更高的单步邻居）来构建DAG：\n\n- 从 $0000$ ($1.0$)：到 $1000$ ($2.5$)、$0010$ ($2.8$)。\n- 从 $1000$ ($2.5$)：到 $1100$ ($5.0$)、$1010$ ($4.5$)。\n- 从 $0010$ ($2.8$)：到 $1010$ ($4.5$)。\n- 从 $1100$ ($5.0$)：到 $1110$ ($6.0$)。\n- 从 $1010$ ($4.5$)：到 $1110$ ($6.0$)、$1011$ ($7.0$)。\n- 从 $1110$ ($6.0$)：到 $1111$ ($8.0$)。\n- 从 $1011$ ($7.0$)：到 $1111$ ($8.0$)。\n\n将 $N(g)$ 定义为该DAG中从基因型 $g$ 到 $1111$ 的有向路径的数量。使用动态规划（在可达集合内从高适应度到低适应度的拓扑顺序），设定终止条件 $N(1111)=1$，对于任何其他节点 $g$：\n$$\nN(g)=\\sum_{h:\\,h\\text{ is a single-step neighbor of }g,\\;f(h)f(g)} N(h).\n$$\n从汇点向上评估：\n$$\nN(1111)=1,\\quad N(1110)=N(1111)=1,\\quad N(1011)=N(1111)=1,\n$$\n$$\nN(1010)=N(1110)+N(1011)=1+1=2,\\quad N(1100)=N(1110)=1,\n$$\n$$\nN(1000)=N(1100)+N(1010)=1+2=3,\\quad N(0010)=N(1010)=2,\n$$\n$$\nN(0000)=N(1000)+N(0010)=3+2=5.\n$$\n因此 $P=5$。\n\n最后，计算该比率并四舍五入到两位有效数字：\n$$\n\\frac{P}{L}=\\frac{5}{2}=2.5.\n$$\n因此，保留两位有效数字，该比率为 $2.5$。", "answer": "$$\\boxed{2.5}$$", "id": "1434220"}]}