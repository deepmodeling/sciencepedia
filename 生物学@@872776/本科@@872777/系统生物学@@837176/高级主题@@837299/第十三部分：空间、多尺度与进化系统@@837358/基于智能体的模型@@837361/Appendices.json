{"hands_on_practices": [{"introduction": "本练习将介绍群体遗传学中最基本的概念之一——遗传漂变。通过对一个小型细菌群体进行建模，你将看到仅凭随机机会如何导致等位基因频率在代际间发生波动。此计算练习演示了 Wright-Fisher 模型的核心机制，这是演化理论的基石，并突显了随机性在小群体中的重要作用。[@problem_id:1415652]", "problem": "在一个合成生物学实验室中，使用一个简单的基于智能体的模型来研究一个受控细菌种群中的遗传漂变。种群大小在各代之间保持恒定，为 $N=10$。这些细菌经过基因工程改造，可以表达两种相互排斥的荧光蛋白等位基因之一：一种是绿色荧光蛋白 (GFP)，我们标记为等位基因 'G'；另一种是红色荧光蛋白 (RFP)，标记为等位基因 'R'。这些等位基因是选择性中性的，不提供任何生存或繁殖优势。\n\n在模拟开始时（第 0 代），种群由 $N_G = 3$ 个带有等位基因 'G' 的细菌和 $N_R = 7$ 个带有等位基因 'R' 的细菌组成。\n\n下一代（第 1 代）的种群是通过对第 0 代种群进行 $N$ 次独立抽样事件而创建的。每个抽样事件包括从第 0 代种群中*有放回地*随机选择一个细菌，并为新一代创建一个它的完美副本。\n\n计算第 1 代中带有等位基因 'G' 的细菌数量与第 0 代中带有等位基因 'G' 的细菌数量相同的概率。将最终答案四舍五入到三位有效数字。", "solution": "该设置对应于从一个有限种群中进行有放回抽样，其中 $N$ 次抽样中的每一次都独立地以等于其初始频率的概率产生等位基因 G。设 $N$ 为每代的细菌总数，设 $N_{G}$ 和 $N_{R}$ 分别为第 0 代中等位基因 G 和 R 的数量。在任何单次抽样中选中一个 G 细菌的概率是\n$$\np=\\frac{N_{G}}{N}, \\quad 1-p=\\frac{N_{R}}{N}.\n$$\n由于下一代是通过 $N$ 次有放回的独立抽样形成的，第 1 代中 G 等位基因的数量（记为 $X$）服从参数为 $N$ 和 $p$ 的二项分布。因此，对于任何 $k \\in \\{0,1,\\dots,N\\}$，\n$$\n\\Pr(X=k)=\\binom{N}{k}p^{k}(1-p)^{N-k}.\n$$\n我们要求的是第 1 代中 G 等位基因的数量与第 0 代完全相同的概率，即 $k=N_{G}$。代入 $N=10$、$N_{G}=3$ 和 $N_{R}=7$ 可得\n$$\n\\Pr(X=3)=\\binom{10}{3}\\left(\\frac{3}{10}\\right)^{3}\\left(\\frac{7}{10}\\right)^{7}.\n$$\n计算每个因子：\n$$\n\\binom{10}{3}=120,\\quad \\left(\\frac{3}{10}\\right)^{3}=\\frac{27}{1000}=0.027,\\quad \\left(\\frac{7}{10}\\right)^{7}=\\frac{7^{7}}{10^{7}}=\\frac{823543}{10000000}=0.0823543.\n$$\n因此\n$$\n\\Pr(X=3)=120 \\times 0.027 \\times 0.0823543=0.266827932.\n$$\n四舍五入到三位有效数字得到\n$$\n0.267.\n$$", "answer": "$$\\boxed{0.267}$$", "id": "1415652"}, {"introduction": "在群体智能体概念的基础上，本练习引入了突变和自然选择这两个关键要素。你将模拟一个正在接受药物治疗的肿瘤细胞群体，其中罕见的突变事件可以产生具有生存优势的耐药细胞。此练习展示了基于智能体的模型如何捕捉动态演化的过程，并有助于理解现代医学面临的最重大的挑战之一。[@problem_id:1415705]", "problem": "我们使用一个简化的离散时间随机模型来研究肿瘤细胞群体中耐药性的出现。该群体由两种类型的细胞组成：药物敏感型 (S) 和耐药型 (R)。模拟在时间 $t=0$ 开始，初始群体包含 $N_0$ 个敏感型细胞，没有耐药型细胞。从 $t=0$ 开始持续进行药物治疗。\n\n在每个离散时间步，每个细胞的命运根据以下规则独立地确定：\n\n1.  **存活：** 在一个时间步开始时，一个类型为 $i \\in \\{S, R\\}$ 的细胞以概率 $1-p_i$ 存活，其中 $p_i$ 是细胞死亡的概率。如果细胞没有存活，它将从群体中被移除。\n2.  **分裂：** 如果一个类型为 $i$ 的细胞存活下来，它会尝试分裂。分裂成功的概率为 $g_i$。一次成功的分裂会用两个新的子细胞取代亲代细胞。如果分裂不成功，亲代细胞将作为同类型的单个细胞保留在群体中。\n3.  **突变：** 对于一个敏感型 (S) 细胞，一次成功的分裂事件以 $1-\\mu$ 的概率产生两个敏感型子细胞。以概率 $\\mu$，分裂会产生一个敏感型和一个耐药型子细胞。一个耐药型 (R) 细胞的分裂总是产生两个耐药型子细胞。\n\n模型的参数如下：\n-   初始敏感型细胞数量, $N_0 = 1000$\n-   S 细胞的死亡概率, $p_S = 0.50$\n-   存活的 S 细胞的分裂概率, $g_S = 0.80$\n-   R 细胞的死亡概率, $p_R = 0.10$\n-   存活的 R 细胞的分裂概率, $g_R = 0.90$\n-   每个 S 细胞分裂的突变概率, $\\mu = 0.01$\n\n计算在时间 $t=2$ 时群体中的细胞总数（包括敏感型和耐药型）的期望值。将最终答案四舍五入到四位有效数字。", "solution": "我们通过期望的线性性和单个时间步的平均后代矩阵来计算期望群体数量。对于一个时间步开始时的单个敏感型细胞 (S)：\n- 它以概率 $p_{S}$ 死亡，贡献 0 个细胞。\n- 它以概率 $1-p_{S}$ 存活。在存活的条件下：\n  - 它以概率 $g_{S}$ 分裂；一次成功的分裂产生两个子细胞。按类型划分的子细胞期望数量为：S 型子细胞 $2(1-\\mu)+1\\cdot\\mu=2-\\mu$，以及 R 型子细胞 $0\\cdot(1-\\mu)+1\\cdot\\mu=\\mu$。\n  - 它以概率 $1-g_{S}$ 分裂失败；亲代细胞仍然是一个 S 细胞。\n\n因此，从一个 S 亲代细胞经过一个步骤后，S 细胞和 R 细胞的期望数量是\n$$\nE_{S\\to S}=(1-p_{S})\\big[g_{S}(2-\\mu)+(1-g_{S})\\cdot 1\\big],\\qquad\nE_{S\\to R}=(1-p_{S})\\big[g_{S}\\mu+(1-g_{S})\\cdot 0\\big]=(1-p_{S})g_{S}\\mu.\n$$\n定义\n$$\na \\equiv (1-p_{S})\\big[g_{S}(2-\\mu)+(1-g_{S})\\big],\\qquad c \\equiv (1-p_{S})g_{S}\\mu.\n$$\n\n对于一个耐药型细胞 (R)：\n- 它以概率 $p_{R}$ 死亡，贡献 0 个细胞。\n- 它以概率 $1-p_{R}$ 存活。在存活的条件下：\n  - 它以概率 $g_{R}$ 分裂，产生两个 R 细胞。\n  - 它以概率 $1-g_{R}$ 分裂失败，并仍然是一个 R 细胞。\n\n因此，从一个 R 亲代细胞得到的 R 细胞的期望数量是\n$$\nE_{R\\to R}=(1-p_{R})\\big[2g_{R}+(1-g_{R})\\cdot 1\\big]=(1-p_{R})(1+g_{R}),\n$$\n并且 $E_{R\\to S}=0$。定义\n$$\nd \\equiv (1-p_{R})(1+g_{R}).\n$$\n\n设时间 $t$ 的期望状态向量为 $v_{t}=\\begin{pmatrix}S_{t}\\\\ R_{t}\\end{pmatrix}$。单步期望更新为\n$$\nv_{t+1}=M v_{t},\\qquad M=\\begin{pmatrix} a  0 \\\\ c  d \\end{pmatrix}.\n$$\n在初始条件 $v_{0}=\\begin{pmatrix}N_{0}\\\\ 0\\end{pmatrix}$ 下，我们得到\n$$\nv_{1}=M v_{0}=\\begin{pmatrix} aN_{0}\\\\ cN_{0}\\end{pmatrix},\\qquad\nv_{2}=M v_{1}=\\begin{pmatrix} a^{2}N_{0}\\\\ c(a+d)N_{0}\\end{pmatrix}.\n$$\n因此，在 $t=2$ 时细胞总数的期望值为\n$$\nT_{2}=S_{2}+R_{2}=N_{0}\\big[a^{2}+c(a+d)\\big].\n$$\n\n代入给定的参数 $N_{0}=1000$, $p_{S}=0.50$, $g_{S}=0.80$, $p_{R}=0.10$, $g_{R}=0.90$, $\\mu=0.01$：\n$$\na=(1-0.50)\\big[0.80(2-0.01)+(1-0.80)\\big]=0.50\\big[0.80\\cdot 1.99+0.20\\big]=0.50(1.592+0.20)=0.896,\n$$\n$$\nc=(1-0.50)\\cdot 0.80\\cdot 0.01=0.004,\\qquad d=(1-0.10)(1+0.90)=0.90\\cdot 1.90=1.71.\n$$\n那么\n$$\na^{2}=0.896^{2}=0.802816,\\qquad a+d=0.896+1.71=2.606,\\qquad c(a+d)=0.004\\cdot 2.606=0.010424,\n$$\n$$\na^{2}+c(a+d)=0.802816+0.010424=0.81324,\\qquad T_{2}=1000\\cdot 0.81324=813.24.\n$$\n四舍五入到四位有效数字得到 $813.2$。", "answer": "$$\\boxed{813.2}$$", "id": "1415705"}, {"introduction": "最后的这个练习将实现一个从短期模拟到长期分析预测的飞跃，这是系统生物学中的一项关键技能。通过将智能体的行为（死亡、分裂）定义为其内部状态（年龄）的函数，你将推导出群体整体增长率 $\\lambda$ 的方程。这个问题完美地诠释了“涌现”这一概念，展示了宏观的群体属性是如何直接从支配单个智能体的微观规则中产生的。[@problem_id:1415649]", "problem": "考虑一个用于模拟生物反应器中合成分微生物种群动态的基于主体的模型 (ABM)。每个主体的状态由其内部年龄计数器 $a$ 定义，它是一个非负整数，表示自其创建以来所经过的时间步数。模拟以离散的时间步进行。\n\n在每个时间步开始时，年龄为 $a$ 的每个主体都会经历以下三种互斥事件之一：\n1.  **死亡**：主体死亡并从模拟中移除。此事件发生的概率为 $P_{\\text{death}}(a)$。\n2.  **分裂**：主体被移除，并由两个年龄均为 $a=0$ 的新子代主体替代。此事件发生的概率为 $P_{\\text{div}}(a)$。\n3.  **存活**：主体存活到下一个时间步，届时其年龄将变为 $a+1$。此事件发生的概率为 $P_{\\text{surv}}(a) = 1 - P_{\\text{death}}(a) - P_{\\text{div}}(a)$。\n\n对于这个特定模型，事件概率定义如下：\n- 由于基础代谢负荷，死亡概率对所有年龄均恒定：$P_{\\text{death}}(a) = \\delta$。\n- 分裂是一种工程行为，仅在特定的成熟年龄 $A$（一个正整数）时触发。在此年龄的分裂概率为 $p_{div}$。对于所有其他年龄，分裂概率为零。形式上，$P_{\\text{div}}(a) = p_{div}$ 如果 $a=A$，且 $P_{\\text{div}}(a)=0$ 如果 $a \\neq A$。\n\n参数 $\\delta$ 和 $p_{div}$ 是正常数，且它们的和小于一：$\\delta + p_{div}  1$。\n\n模拟运行很长时间后，种群进入稳定的指数增长状态，其中时间 $t$ 的主体总数 $N(t)$ 在每个时间步都按一个常数因子 $\\lambda$ 增长，即 $N(t+1) = \\lambda N(t)$。这意味着种群已达到稳定的年龄分布。\n\n您的任务是确定长期种群增长因子 $\\lambda$。请用参数 $A$、$p_{div}$ 和 $\\delta$ 将您的答案表示为单个闭式解析表达式。", "solution": "设 $N_a(t)$ 为时间步 $t$ 时年龄为 $a$ 的主体数量。总种群为 $N(t) = \\sum_{a=0}^{\\infty} N_a(t)$。\n问题陈述，经过很长时间后，种群达到稳定的年龄分布并以因子 $\\lambda$ 指数增长。这意味着任何特定年龄 $a$ 的主体数量在每个时间步也以相同的因子增长，即 $N_a(t+1) = \\lambda N_a(t)$。\n这使我们能够将时间 $t$ 时年龄为 $a$ 的主体数量表示为 $N_a(t) = k_a \\lambda^t$，其中 $k_a$ 代表在稳定增长的种群中年龄为 $a$ 的主体的恒定比例。\n\n种群的动态可以用一组差分方程来描述。在时间 $t+1$ 时年龄为 $a$ 的主体，必然是在时间 $t$ 时年龄为 $a-1$ 且存活下来并未分裂的主体。在时间 $t+1$ 时年龄为 $a$ (对于 $a \\ge 1$) 的主体数量由下式给出：\n$$N_a(t+1) = N_{a-1}(t) \\times P_{\\text{surv}}(a-1)$$\n代入 $N_a(t) = k_a \\lambda^t$，我们得到：\n$$k_a \\lambda^{t+1} = k_{a-1} \\lambda^t \\times P_{\\text{surv}}(a-1)$$\n两边同除以 $\\lambda^t$，我们得到系数 $k_a$ 的一个递推关系：\n$$\\lambda k_a = k_{a-1} P_{\\text{surv}}(a-1) \\implies k_a = \\frac{k_{a-1}}{\\lambda} P_{\\text{surv}}(a-1)$$\n我们可以通过将 $k_a$ 用 $k_0$ 表示来解这个递推关系：\n$$k_a = k_0 \\lambda^{-a} \\prod_{i=0}^{a-1} P_{\\text{surv}}(i)$$\n\n现在我们必须考虑概率的具体形式。\n$P_{\\text{death}}(a) = \\delta$\n$P_{\\text{div}}(a) = p_{div}$ 对于 $a=A$ 成立，其他情况下为 $0$。\n因此，存活概率 $P_{\\text{surv}}(a) = 1 - P_{\\text{death}}(a) - P_{\\text{div}}(a)$ 为：\n- 对于 $a \\neq A$，$P_{\\text{surv}}(a) = 1 - \\delta$。\n- $P_{\\text{surv}}(A) = 1 - \\delta - p_{div}$。\n\n我们需要计算乘积 $\\prod_{i=0}^{A-1} P_{\\text{surv}}(i)$ 来求 $k_A$。由于 $A$ 是一个正整数，该乘积中的索引 $i$ 的取值范围是从 $0$ 到 $A-1$。在这个范围内，$i \\neq A$，所以乘积中的所有项都有 $P_{\\text{surv}}(i) = 1 - \\delta$。\n$$\\prod_{i=0}^{A-1} P_{\\text{surv}}(i) = \\prod_{i=0}^{A-1} (1 - \\delta) = (1 - \\delta)^A$$\n现在我们可以写出 $k_A$ 的表达式：\n$$k_A = k_0 \\lambda^{-A} (1-\\delta)^A$$\n\n接下来，我们建立新主体（年龄为0）的创建方程。新主体是通过现有主体的分裂产生的。一个年龄为 $a$ 的主体分裂时会产生两个年龄为 0 的新主体。在时间 $t+1$ 的新主体数量是在时间 $t$ 时所有年龄组产生的后代之和：\n$$N_0(t+1) = \\sum_{a=0}^{\\infty} 2 \\times N_a(t) \\times P_{\\text{div}}(a)$$\n由于 $P_{\\text{div}}(a)$ 仅在 $a=A$ 时非零，所以这个和可以简化为一项：\n$$N_0(t+1) = 2 \\times N_A(t) \\times P_{\\text{div}}(A) = 2 N_A(t) p_{div}$$\n代入稳定增长形式 $N_a(t) = k_a \\lambda^t$：\n$$k_0 \\lambda^{t+1} = 2 (k_A \\lambda^t) p_{div}$$\n两边同除以 $\\lambda^t$ 得到在稳定增长时关联不同年龄组的特征方程：\n$$\\lambda k_0 = 2 k_A p_{div}$$\n这个方程对于该系统也称为欧拉-洛特卡方程。它表明，经增长调整后的新主体数量由繁殖主体的数量及其繁殖力决定。\n\n为了求解 $\\lambda$，我们将 $k_A$ 关于 $k_0$ 的表达式代入这个特征方程：\n$$\\lambda k_0 = 2 \\left( k_0 \\lambda^{-A} (1-\\delta)^A \\right) p_{div}$$\n因为对于一个非灭绝的种群，$k_0$ 必须为非零，所以我们可以将两边同除以 $k_0$：\n$$\\lambda = 2 p_{div} \\lambda^{-A} (1-\\delta)^A$$\n现在，我们求解 $\\lambda$。将两边同乘以 $\\lambda^A$：\n$$\\lambda \\cdot \\lambda^A = 2 p_{div} (1-\\delta)^A$$\n$$\\lambda^{A+1} = 2 p_{div} (1-\\delta)^A$$\n最后，对两边取 $(A+1)$ 次方根，得到长期增长因子 $\\lambda$ 的表达式：\n$$\\lambda = \\left[ 2 p_{div} (1-\\delta)^A \\right]^{\\frac{1}{A+1}}$$", "answer": "$$\\boxed{\\left(2 p_{div} (1-\\delta)^{A}\\right)^{\\frac{1}{A+1}}}$$", "id": "1415649"}]}