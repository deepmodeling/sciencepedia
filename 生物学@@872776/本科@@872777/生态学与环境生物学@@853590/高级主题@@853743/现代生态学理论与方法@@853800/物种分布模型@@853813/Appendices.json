{"hands_on_practices": [{"introduction": "一个物种的生态策略（特化种 vs. 泛化种）会直接影响其分布模型的特性。本练习将通过一个量化过程，帮助你理解为什么生态位狭窄的特化种通常能构建出具有更高“预测敏锐度”的模型。我们将运用微积分来探索生态位宽度 $\\sigma$ 与模型对环境变化敏感度之间的关系 [@problem_id:1882305]。", "problem": "一位生态学家正在为两种假想的甲虫物种开发物种分布模型（SDM），以了解它们的存在与土壤酸度的关系。该生态学家假设，在特定地点发现每个物种的概率主要由该地点的土壤pH值决定。\n\n- 物种S是一个“特化物种”，已知仅在狭窄范围的酸性土壤中才能繁衍生息。\n- 物种G是一个“泛化物种”，能耐受更广泛的土壤pH值范围。\n\n基于大量的实地数据，该生态学家将存在概率 $P(x)$ 建模为土壤pH值（用变量 $x$ 表示）的函数。对于这两个物种，其概率遵循高斯响应曲线：\n$$P(x) = \\exp\\left(-\\frac{(x - x_{opt})^2}{2\\sigma^2}\\right)$$\n在此模型中，$x_{opt}$ 代表物种最有可能被发现的最适土壤pH值，参数 $\\sigma$ 量化了物种生态位的宽度。较小的 $\\sigma$ 表示特化物种，而较大的 $\\sigma$ 表示泛化物种。\n\n模型参数确定如下：\n- 对于这两个物种，最适pH值为 $x_{opt} = 5.5$。\n- 对于特化物种S，生态位宽度参数为 $\\sigma_S = 0.4$。\n- 对于泛化物种G，生态位宽度参数为 $\\sigma_G = 2.0$。\n\n对于给定的环境条件，物种分布模型（SDM）的“预测锐度”可与存在概率响应环境变化的快慢相关联。具有更高最大变化率（更陡的梯度）的模型被认为具有更强的预测能力，因为环境的微小差异会导致预测概率发生巨大而明确的变化。\n\n计算特化物种S的存在概率最大可能变化率与泛化物种G的存在概率最大可能变化率之比。即，计算比率 $\\frac{\\max|dP_S/dx|}{\\max|dP_G/dx|}$ 的值。您的答案应该是一个实数。", "solution": "对于给定的物种，其参数为 $x_{opt}$ 和 $\\sigma$，存在概率为\n$$\nP(x)=\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\n使用链式法则对 $x$ 求导。设\n$$\nE(x)=-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}},\n$$\n使得 $P(x)=\\exp(E(x))$ 且\n$$\n\\frac{dP}{dx}=\\exp(E(x))\\frac{dE}{dx}.\n$$\n计算\n$$\n\\frac{dE}{dx}=-\\frac{1}{2\\sigma^{2}}\\cdot 2(x-x_{opt})=-\\frac{x-x_{opt}}{\\sigma^{2}},\n$$\n因此\n$$\n\\frac{dP}{dx}=-\\frac{x-x_{opt}}{\\sigma^{2}}\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\n绝对变化率为\n$$\n\\left|\\frac{dP}{dx}\\right|=\\frac{|x-x_{opt}|}{\\sigma^{2}}\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\n设 $y=|x-x_{opt}|$，其中 $y\\ge 0$，并定义\n$$\nf(y)=\\frac{y}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right).\n$$\n为求 $f$ 的最大值，对其求导：\n$$\nf'(y)=\\frac{1}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)+\\frac{y}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)\\left(-\\frac{y}{\\sigma^{2}}\\right)\n=\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)\\left(\\frac{1}{\\sigma^{2}}-\\frac{y^{2}}{\\sigma^{4}}\\right).\n$$\n令 $f'(y)=0$ 以求临界点：\n$$\n\\frac{1}{\\sigma^{2}}-\\frac{y^{2}}{\\sigma^{4}}=0\\quad\\Longrightarrow\\quad y^{2}=\\sigma^{2}\\quad\\Longrightarrow\\quad y=\\sigma.\n$$\n由于 $f(0)=0$ 且当 $y\\to\\infty$ 时 $f(y)\\to 0$，因此在 $y=\\sigma$ 处的临界点给出全局最大值。因此，最大绝对斜率为\n$$\n\\max\\left|\\frac{dP}{dx}\\right|=f(\\sigma)=\\frac{\\sigma}{\\sigma^{2}}\\exp\\!\\left(-\\frac{\\sigma^{2}}{2\\sigma^{2}}\\right)=\\frac{1}{\\sigma}\\exp\\!\\left(-\\frac{1}{2}\\right).\n$$\n对于参数分别为 $\\sigma_{S}$ 和 $\\sigma_{G}$ 的物种S和G，\n$$\n\\frac{\\max|dP_{S}/dx|}{\\max|dP_{G}/dx|}=\\frac{\\exp(-1/2)/\\sigma_{S}}{\\exp(-1/2)/\\sigma_{G}}=\\frac{\\sigma_{G}}{\\sigma_{S}}.\n$$\n代入 $\\sigma_{S}=0.4$ 和 $\\sigma_{G}=2.0$ 可得\n$$\n\\frac{\\max|dP_{S}/dx|}{\\max|dP_{G}/dx|}=\\frac{2.0}{0.4}=5.\n$$", "answer": "$$\\boxed{5}$$", "id": "1882305"}, {"introduction": "在构建模型之前，我们必须确保所用的环境预测变量之间不存在信息冗余，这个问题被称为“多重共线性”。本练习将演示一种标准方法，即使用方差膨胀因子（$VIF$）来系统地识别并剔除相关的变量。这是一个确保模型稳定性和可解释性的关键数据预处理步骤 [@problem_id:1882322]。", "problem": "一位生态学家正在为一种珍稀高山植物物种开发物种分布模型 (SDM)。为了避免多重共线性问题，该生态学家决定使用基于方差膨胀因子 (VIF) 的逐步选择程序，对一组四个潜在的气候预测变量进行预处理。初始变量集为：\n- $V_1$: 年平均温度\n- $V_2$: 年总降水量\n- $V_3$: 年温差\n- $V_4$: 海拔\n\n预测变量 $V_j$ 的 VIF 计算公式为 $VIF_j = \\frac{1}{1 - R^2_j}$，其中 $R^2_j$ 是将 $V_j$ 与当前集合中所有其他预测变量进行线性回归得到的决定系数。\n\n选择程序如下：\n1. 计算当前集合中所有变量的 VIF。\n2. 找出 VIF 最高的变量。\n3. 如果该最高 VIF 大于阈值 5.0，则从集合中移除该变量。\n4. 对剩余变量重复此过程，直到集合中所有变量的 VIF 均小于或等于 5.0。\n\n可用的线性回归分析数据如下：\n\n**第 1 轮 (集合: {$V_1, V_2, V_3, V_4$}):**\n- $V_1$ 对 {$V_2, V_3, V_4$} 的回归: $R^2_1 = 0.980$\n- $V_2$ 对 {$V_1, V_3, V_4$} 的回归: $R^2_2 = 0.600$\n- $V_3$ 对 {$V_1, V_2, V_4$} 的回归: $R^2_3 = 0.750$\n- $V_4$ 对 {$V_1, V_2, V_3$} 的回归: $R^2_4 = 0.970$\n\n从第 1 轮中移除 VIF 最高的变量后，重复该分析。\n\n**第 2 轮 (剩余变量):**\n将剩余变量表示为一个新集合。这个新集合的决定系数如下：\n- $V_2$ 对 {$V_3, V_4$} 的回归: $R^2_2 = 0.450$\n- $V_3$ 对 {$V_2, V_4$} 的回归: $R^2_3 = 0.300$\n- $V_4$ 对 {$V_2, V_3$} 的回归: $R^2_4 = 0.820$\n\n从第 2 轮中移除 VIF 最高的变量后，对最后一对变量重复该分析。\n\n**第 3 轮 (最后一对):**\n- 两个剩余变量之间回归的决定系数为 0.200。\n\n根据此逐步程序，最终模型应保留哪一组变量？\n\nA. {$V_1, V_2$}\n\nB. {$V_2, V_3$}\n\nC. {$V_2, V_4$}\n\nD. {$V_1, V_3, V_4$}\n\nE. {$V_2, V_3, V_4$}", "solution": "题目要求我们使用方差膨胀因子 (VIF) 进行逐步变量选择，移除阈值为 5.0。变量 $V_j$ 的 VIF 由公式 $VIF_j = \\frac{1}{1 - R^2_j}$ 给出。\n\n**第 1 轮：初始集合 {$V_1, V_2, V_3, V_4$}**\n\n首先，我们使用提供的 $R^2$ 值计算四个初始变量中每一个的 VIF。\n\n对于 $V_1$：\n$VIF_1 = \\frac{1}{1 - R^2_1} = \\frac{1}{1 - 0.980} = \\frac{1}{0.020} = 50.0$\n\n对于 $V_2$：\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.600} = \\frac{1}{0.400} = 2.5$\n\n对于 $V_3$：\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.750} = \\frac{1}{0.250} = 4.0$\n\n对于 $V_4$：\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.970} = \\frac{1}{0.030} \\approx 33.33$\n\n计算出的 VIF 值为：$VIF_1 = 50.0$，$VIF_2 = 2.5$，$VIF_3 = 4.0$，$VIF_4 \\approx 33.33$。\n\n根据程序，我们找出 VIF 最高的变量。这个变量是 $V_1$，其 $VIF_1 = 50.0$。\n然后我们将此值与阈值 5.0 进行比较。由于 $50.0 > 5.0$，我们必须移除变量 $V_1$。\n\n下一轮的剩余变量集是 {$V_2, V_3, V_4$}。\n\n**第 2 轮：集合 {$V_2, V_3, V_4$}**\n\n现在我们使用为第 2 轮提供的 $R^2$ 值，对剩余变量重复该过程。注意，第 2 轮的题目陈述是自包含的，并不要求我们知道移除了哪个变量，但我们的分步推导已经确定是 $V_1$ 被移除，因此新的回归是 $V_2$ 对 {$V_3, V_4$} 的回归，$V_3$ 对 {$V_2, V_4$} 的回归，以及 $V_4$ 对 {$V_2, V_3$} 的回归。\n\n对于 $V_2$：\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.450} = \\frac{1}{0.550} \\approx 1.82$\n\n对于 $V_3$：\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.300} = \\frac{1}{0.700} \\approx 1.43$\n\n对于 $V_4$：\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.820} = \\frac{1}{0.180} \\approx 5.56$\n\n新的 VIF 值为：$VIF_2 \\approx 1.82$，$VIF_3 \\approx 1.43$，$VIF_4 \\approx 5.56$。\n\n该集合中 VIF 最高的变量是 $V_4$，其 $VIF_4 \\approx 5.56$。\n我们将其与阈值进行比较：$5.56 > 5.0$。因此，我们必须移除变量 $V_4$。\n\n剩余的变量集是 {$V_2, V_3$}。\n\n**第 3 轮：集合 {$V_2, V_3$}**\n\n最后，我们分析最后剩下的一对变量 {$V_2, V_3$}。当只有两个变量时，它们的 VIF 是相同的。$V_2$ 对 $V_3$ 回归的 $R^2$ 与 $V_3$ 对 $V_2$ 回归的 $R^2$ 相同。题目说明这个值为 0.200。\n\n两个剩余变量的 VIF 均为：\n$VIF_{final} = \\frac{1}{1 - 0.200} = \\frac{1}{0.800} = 1.25$\n\n我们检查该 VIF 值是否大于阈值 5.0。由于 $1.25 \\le 5.0$，未满足移除条件。逐步选择程序停止。\n\n最终模型要保留的变量集是 {$V_2, V_3$}。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1882322"}, {"introduction": "构建模型后，我们如何判断其优劣？本练习将带你逐步计算物种分布模型文献中最常用的两个性能指标：受试者工作特征曲线下面积（$AUC$）和真实技能统计量（$TSS$）。掌握这些计算方法，对于批判性地评估自己和他人的模型至关重要，尤其是在处理像本例中一样的数据量有限的挑战性情景时 [@problem_id:1882368]。", "problem": "一位生态学家正在为一种新发现的极度稀有的深海珊瑚 *Corallium profundum* 开发物种分布模型 (SDM)。该物种仅在九个不同的地点被观测到。由于样本量极小，这位生态学家担心模型出现过拟合，因此选择使用留一法交叉验证方法进行模型评估。\n\n在此过程中，对于九个存在点中的每一个，都使用其余八个点训练一个模型，然后用该模型预测被留出的那个点的生境适宜度（一个从0到1的值）。九个存在点的预测生境适宜度得分如下：\n{0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81, 0.75, 0.70}\n\n为了评估模型区分适宜生境与不适宜生境的能力，该模型还预测了1000个随机“背景”点的适宜度，这些背景点代表了研究区域内的环境条件范围。评估将使用两个指标：受试者工作特征曲线 (ROC) 下的面积 (AUC) 和真技能统计量 (TSS)。\n\n对于AUC的计算，有以下数据可用。它显示了对于九个存在点得分中的每一个，1000个背景点中有多少个点的预测适宜度得分低于该存在点。\n- 得分为0.99时，有995个背景点的得分较低。\n- 得分为0.98时，有980个背景点的得分较低。\n- 得分为0.96时，有960个背景点的得分较低。\n- 得分为0.94时，有930个背景点的得分较低。\n- 得分为0.90时，有890个背景点的得分较低。\n- 得分为0.85时，有840个背景点的得分较低。\n- 得分为0.81时，有785个背景点的得分较低。\n- 得分为0.75时，有700个背景点的得分较低。\n- 得分为0.70时，有670个背景点的得分较低。\n\nAUC可以计算为得分低于给定存在点的背景点所占的平均比例。\n\n对于TSS的计算，必须使用一个阈值将连续的适宜度得分转换为二元预测（存在/不存在）。生态学家使用的阈值为 $T = 0.80$。任何得分大于0.80的地点被预测为“存在”，任何得分小于或等于0.80的地点被预测为“不存在”。根据模型对1000个背景点的预测，发现其中220个点的适宜度得分大于0.80。\n\nTSS的计算公式为：$TSS = \\text{Sensitivity} + \\text{Specificity} - 1$。\n- 敏感度（或真阳性率）是指实际存在点被正确预测为存在的比例。\n- 特异度（或真阴性率）是指实际不存在（背景）点被正确预测为不存在的比例。\n\n根据所提供的数据，计算AUC和TSS的值。将两个最终值四舍五入到三位有效数字。以下哪个陈述是正确的？\n\nA. AUC为0.861，TSS为0.558。\n\nB. AUC为0.861，TSS为0.635。\n\nC. AUC为0.775，TSS为0.558。\n\nD. AUC为0.900，TSS为0.778。\n\nE. AUC为0.850，TSS为0.780。", "solution": "目标是根据所提供的物种分布模型输出，计算两个模型性能指标：曲线下面积 (AUC) 和真技能统计量 (TSS)。\n\n**步骤1：计算曲线下面积 (AUC)**\n\n问题陈述AUC可以计算为得分低于给定存在点的背景点的平均比例。我们有9个存在点和1000个背景点。\n\n对于9个存在点得分中的每一个，我们都已知得分更低的背景点的数量。我们首先计算每个存在点的比例，然后对这些比例求平均值。\n\n比例为：\n- 对于得分0.99：$995 / 1000 = 0.995$\n- 对于得分0.98：$980 / 1000 = 0.980$\n- 对于得分0.96：$960 / 1000 = 0.960$\n- 对于得分0.94：$930 / 1000 = 0.930$\n- 对于得分0.90：$890 / 1000 = 0.890$\n- 对于得分0.85：$840 / 1000 = 0.840$\n- 对于得分0.81：$785 / 1000 = 0.785$\n- 对于得分0.75：$700 / 1000 = 0.700$\n- 对于得分0.70：$670 / 1000 = 0.670$\n\n现在，我们计算这些比例的平均值：\n$$ \\text{AUC} = \\frac{0.995 + 0.980 + 0.960 + 0.930 + 0.890 + 0.840 + 0.785 + 0.700 + 0.670}{9} $$\n比例的总和是：\n$$ \\text{Sum} = 7.750 $$\n平均值为：\n$$ \\text{AUC} = \\frac{7.750}{9} \\approx 0.86111... $$\n四舍五入到三位有效数字，我们得到 $\\text{AUC} = 0.861$。\n\n**步骤2：计算真技能统计量 (TSS)**\n\nTSS的计算需要使用给定的阈值 $T = 0.80$ 将连续的预测值分类为二元结果（存在/不存在）。\n$TSS = \\text{Sensitivity} + \\text{Specificity} - 1$。\n\n首先，我们需要通过确定真阳性 (TP)、假阴性 (FN)、真阴性 (TN) 和假阳性 (FP) 的数量来构建一个混淆矩阵。\n\n**存在数据分析：**\n我们有9个实际存在点，其得分如下：{0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81, 0.75, 0.70}。\n- 如果一个地点的得分 $> 0.80$，则被预测为“存在”。\n- 如果一个地点的得分 $\\le 0.80$，则被预测为“不存在”。\n\n大于0.80的得分有 {0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81}。共有7个这样的得分。这些是真阳性 (TP)。\n$$ \\text{TP} = 7 $$\n小于或等于0.80的得分有 {0.75, 0.70}。共有2个这样的得分。这些是假阴性 (FN)，即实际存在但被错误预测为不存在的地点。\n$$ \\text{FN} = 2 $$\n实际存在点的总数是 $N_{presence} = TP + FN = 7 + 2 = 9$。\n\n**背景（不存在）数据分析：**\n我们有1000个背景点，在本次评估中我们将其视作不存在点。\n- 问题陈述，1000个背景点中有220个点的适宜度得分大于0.80。这些是实际不存在但被错误预测为存在的点，因此它们是假阳性 (FP)。\n$$ \\text{FP} = 220 $$\n- 剩下的背景点的得分必定小于或等于0.80。这些是被正确预测为不存在的点，因此它们是真阴性 (TN)。\n$$ \\text{TN} = 1000 - \\text{FP} = 1000 - 220 = 780 $$\n实际不存在点的总数是 $N_{absence} = FP + TN = 220 + 780 = 1000$。\n\n**步骤3：计算敏感度、特异度和TSS**\n\n- **敏感度** (真阳性率) = $\\frac{\\text{TP}}{N_{presence}} = \\frac{7}{9}$\n- **特异度** (真阴性率) = $\\frac{\\text{TN}}{N_{absence}} = \\frac{780}{1000} = 0.78$\n\n现在，我们可以计算TSS：\n$$ \\text{TSS} = \\text{Sensitivity} + \\text{Specificity} - 1 $$\n$$ \\text{TSS} = \\frac{7}{9} + 0.78 - 1 $$\n$$ \\text{TSS} \\approx 0.7777... + 0.78 - 1 = 1.5577... - 1 = 0.5577... $$\n四舍五入到三位有效数字，我们得到 $\\text{TSS} = 0.558$。\n\n**结论**\n\n计算出的值为 $\\text{AUC} \\approx 0.861$ 和 $\\text{TSS} \\approx 0.558$。将这些值与给定的选项进行比较，我们发现选项A与我们的结果相符。\n- A. AUC为0.861，TSS为0.558。\n- B. AUC为0.861，TSS为0.635。\n- C. AUC为0.775，TSS为0.558。\n- D. AUC为0.900，TSS为0.778。\n- E. AUC为0.850，TSS为0.780。\n\n正确的选项是A。", "answer": "$$\\boxed{A}$$", "id": "1882368"}]}