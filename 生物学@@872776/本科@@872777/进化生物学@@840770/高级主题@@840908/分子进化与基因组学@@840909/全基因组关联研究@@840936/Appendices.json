{"hands_on_practices": [{"introduction": "在分析全基因组关联研究（GWAS）的结果时，最基本的任务便是识别出潜在的遗传信号。一项GWAS会产生成千上万个p值，而分析的第一步就是找出其中最强的信号，即对应最低p值的位点。本练习 [@problem_id:1494347] 旨在训练学生解读和比较这些数值的核心技能，这是正确阅读GWAS摘要统计数据或曼哈顿图的关键一步。", "problem": "一个遗传学家团队正在进行一项全基因组关联分析 (GWAS)，以鉴定与一种名为“Photonic Aversion Syndrome”的新发现复杂疾病相关的遗传变异。该研究分析了一个由患者和健康对照组成的大型队列全基因组中的数十万个单核苷酸多态性 (SNP)。在对每个 SNP 进行统计检验后，研究人员鉴定出四个显示出最显著关联信号的有潜力的候选 SNP，每个 SNP 都位于不同的染色体上。这四个主要 SNP 的结果总结如下：\n\n*   **SNP rs314159：** 位于6号染色体上，关联 p 值为 $8.1 \\times 10^{-8}$。\n*   **SNP rs271828：** 位于14号染色体上，关联 p 值为 $2.2 \\times 10^{-7}$。\n*   **SNP rs161803：** 位于2号染色体上，关联 p 值为 $5.3 \\times 10^{-9}$。\n*   **SNP rs450288：** 位于20号染色体上，关联 p 值为 $1.9 \\times 10^{-8}$。\n\n根据这些数据，哪个染色体上的 SNP 与 Photonic Aversion Syndrome 关联的统计学证据最强？\n\nA. 2号染色体\nB. 6号染色体\nC. 14号染色体\nD. 20号染色体", "solution": "我们已知来自独立 SNP 的四个关联 p 值：\n- 6号染色体：$p_{6} = 8.1 \\times 10^{-8}$。\n- 14号染色体：$p_{14} = 2.2 \\times 10^{-7}$。\n- 2号染色体：$p_{2} = 5.3 \\times 10^{-9}$。\n- 20号染色体：$p_{20} = 1.9 \\times 10^{-8}$。\n原理：在假设检验中，p 值越小，表示关联的统计学证据越强（即反对原假设的证据越强）。当比较科学记数法表示的数字 $a \\times 10^b$（其中 $1 \\leq a  10$）时，大小比较主要取决于指数 $b$；指数越小（即负得越多），其值越小。\n\n比较指数，我们有 $-9$、$-8$、$-8$ 和 $-7$。因此，指数为 $-9$ 的 $p_{2}$ 是所有值中最小的。为了完整起见，我们可以将它们排序：$$ 5.3 \\times 10^{-9}  1.9 \\times 10^{-8}  8.1 \\times 10^{-8}  2.2 \\times 10^{-7} $$\n因此，2号染色体上的 SNP 具有最强的关联统计学证据。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1494347"}, {"introduction": "在解读数据结果之后，我们必须批判性地评估其有效性。如果研究设计存在缺陷，一个统计上显著的p值也可能毫无意义。本练习 [@problem_id:1494331] 提出了一个贴近现实的科研场景，其中系统性误差（即“批次效应”）导致了大规模的假阳性结果，这教导我们在大型遗传学研究中，严谨的实验设计和数据质量控制至关重要。", "problem": "一个大型研究联盟正在进行一项全基因组关联研究（GWAS），以识别与“航空代谢综合征”（Aero-Metabolic Syndrome, AMS）相关的遗传变异。AMS是一种复杂的呼吸系统疾病。该研究设计包括从一个专业呼吸科诊所网络中招募的 `10,000` 名病例，以及从一个普通人群健康登记库中挑选的 `10,000` 名对照。为了高效地管理大样本量，基因分型过程被分散进行。所有 `10,000` 名病例的DNA样本在一个中心实验室使用“BioArray v2.0”平台进行处理，并对数百万个单核苷酸多态性（SNPs）进行基因分型。与此同时，所有 `10,000` 名对照的DNA样本在另一个机构使用“GenoChip v3.5”平台进行处理和基因分型。\n\n在合并来自两个平台的数据并进行标准的质量控制后，对每个SNP进行了统计关联检验。分析揭示了一个惊人的结果：分布在每条染色体上的数万个SNP显示出与AMS存在统计上显著的关联，这远远超出了复杂疾病GWAS的典型发现。\n\n下列哪个选项为这种全基因组范围内显著关联过多的现象提供了最合理的解释？\n\nA. 群体分层：病例组和对照组来自具有系统性不同遗传背景的群体，这些与遗传背景相关的等位基因频率差异被误解为疾病关联。\nB. 多基因结构：AMS是一种高度多基因的疾病，其遗传风险确实是由遍布整个基因组的数万个常见变异的累积微小效应所决定的。\nC. 选择偏倚：从专业诊所招募病例导致队列中的疾病形式更为严重，从而富集了大量在普通人群对照中未发现的、罕见的、高影响的变异。\nD. 系统性基因分型偏倚：两种不同的基因分型平台在等位基因测量上存在微小、一致且平台特异性的不准确性，由于这些不准确性与病例-对照标签完全相关，从而产生了广泛的假阳性信号。\nE. 隐性亲缘关系：病例组在不知情的情况下包含了大量有近亲关系的个体，这违反了样本独立性的统计假设，并夸大了在家族内部共享的基因座上的关联信号。", "solution": "我们将每个SNP的关联检验形式化为等位基因卡方检验或关于基因型的病例状态逻辑回归。设 $Y \\in \\{0,1\\}$ 表示病例状态，$G \\in \\{0,1,2\\}$ 表示编码后的基因型，对于每个SNP，在逻辑斯蒂模型 $\\ln\\left(\\frac{\\Pr(Y=1 \\mid G)}{\\Pr(Y=0 \\mid G)}\\right) = \\alpha + \\beta_{G} G$ 中考虑原假设 $H_{0}: \\beta_{G} = 0$。在模型设定正确且没有混杂因素的情况下，得分或沃尔德检验统计量在 $H_{0}$ 下服从渐近的 $\\chi^{2}_{1}$ 分布，因此，对于复杂疾病，除了少数真实关联外，整个基因组的 $p$ 值在原假设下应近似服从均匀分布。\n\n观察到的模式是全基因组范围内，每条染色体上都有过多的显著关联，数以万计的SNP达到了显著性水平。如此普遍的膨胀（inflation）表明存在一种系统性地偏离原假设的现象，影响了绝大部分的SNP。我们通过将每个选项与检验行为联系起来进行审查。\n\n选项B（多基因结构）：对于一个高度多基因的性状，许多变异具有微小的真实效应。在严格的全基因组阈值 $\\alpha_{GW}$（例如，$\\alpha_{GW} \\approx 5 \\times 10^{-8}$）下检测一个SNP的统计功效取决于关联检验的非中心参数 $\\Lambda$。对于一个加性检验，一个标准的近似公式为 $\\Lambda \\approx N_{\\text{eff}} \\cdot 2 p (1 - p) \\cdot (\\ln \\theta)^{2}$，其中 $p$ 是次要等位基因频率，$\\theta$ 是每等位基因的比值比，而 $N_{\\text{eff}}$ 是一个由病例和对照数量决定的有效样本量函数。对于具有很小 $\\ln \\theta$ 的现实复杂性状，即使 $N_{\\text{eff}}$ 很大，在 $\\alpha_{GW}$ 水平上的统计功效也有限。因此，仅凭多基因性，用这个样本量并不能产生数万个全基因组显著的位点；它会产生一个可以通过LD得分回归或多基因评分等方法检测到的多基因信号，而不是普遍的单个SNP显著性。\n\n选项C（倾向于严重性的选择偏倚）：招募更严重的病例可能会富集罕见的、高影响的变异。基因芯片主要针对常见变异；罕见的、效应严重的等位基因通常标记不良。此外，这种富集不会在整个基因组的常见SNP上产生一致的等位基因频率差异；它不会在常见变异上产生广泛的假阳性。\n\n选项E（隐性亲缘关系）：亲缘关系违反了独立性假设，如果不进行建模，会影响方差估计并夸大检验统计量。然而，这种膨胀通常取决于共享模式，并且在所有SNP上并非一致；在实践中，它会产生一个适度的、全基因组范围的膨胀因子，有时还会产生局部信号，而不会在所有染色体上产生数万个显著关联。此外，亲缘关系会减小有效样本量，这通常会减少而不是在使用恰当的标准误后大规模增加全基因组显著位点的数量。\n\n选项A（群体分层）：病例和对照之间系统性的遗传背景差异会因人口历史而非疾病导致全基因组范围的等位基因频率差异，从而在许多SNP上夸大关联统计量。如果不加以校正，这很可能造成广泛的显著性。然而，标准的GWAS流程包括对遗传主成分的校正，这通常能缓解大部分的群体分层效应。虽然A可以解释广泛的膨胀，但本研究的设计提供了一个更直接、更强的混杂来源。\n\n选项D（来自不同平台的系统性基因分型偏倚）：在这里，基因分型平台与表型完全混杂：所有病例使用BioArray v2.0，所有对照使用GenoChip v3.5。设 $B \\in \\{0,1\\}$ 表示平台，病例为 $B=1$，对照为 $B=0$。设真实的加性基因型为 $G$，但测量的基因型为 $\\tilde{G} = G + \\epsilon_{B}$，其中由于差异性检出、差异性缺失或探针化学的差异，导致 $E[\\epsilon_{1}] \\neq E[\\epsilon_{0}]$ 或误差分布因平台而异。病例和对照之间测量的平均基因型的期望差异为\n$$\nE[\\tilde{G} \\mid Y=1] - E[\\tilde{G} \\mid Y=0] = \\underbrace{E[G \\mid Y=1] - E[G \\mid Y=0]}_{\\Delta \\text{ (真实效应)}} + \\underbrace{E[\\epsilon_{1}] - E[\\epsilon_{0}]}_{\\delta \\text{ (平台偏倚)}}.\n$$\n在大多数SNP的原假设下，$\\Delta = 0$，但只要存在平台特异性的检出偏倚，就有 $\\delta \\neq 0$。由于 $B$ 与 $Y$ 完全共线性，因此无法在关联模型中对 $B$ 进行校正；遗漏变量偏倚会将平台引起的差异归因于基因型系数，从而产生虚假的关联。等位基因卡方检验的检验统计量近似为\n$$\nT \\approx \\frac{\\left(\\hat{p}_{\\text{病例}} - \\hat{p}_{\\text{对照}}\\right)^{2}}{\\hat{V}},\n$$\n其中 $\\hat{p}_{\\text{病例}}$ 和 $\\hat{p}_{\\text{对照}}$ 是观测到的等位基因频率，而 $\\hat{V}$ 是原假设下的估计方差。如果由于平台偏倚，在许多SNP上都有 $\\hat{p}_{\\text{病例}} - \\hat{p}_{\\text{对照}} \\approx \\delta$，那么 $T$ 就会在全基因组范围内被夸大。与随机非差异性测量误差（会减弱关联）不同，这是一种与结局状态相关的差异性错分，它会同时在许多SNP上使结果偏离原假设，这与观察到的在所有染色体上出现数万个显著位点的模式完全吻合。\n\n鉴于所有病例和对照都在不同机构使用不同平台进行基因分型的具体设计细节，与病例-对照状态完全相关的、系统性的、平台特异性的基因分型偏倚是对此全基因组显著关联过多的最合理和最直接的解释。\n\n因此，正确选项是D。", "answer": "$$\\boxed{D}$$", "id": "1494331"}, {"introduction": "在识别出潜在信号并考虑了实验混杂因素后，我们必须采用正确的统计阈值来判断其显著性。本练习 [@problem_id:1494362] 旨在解决GWAS中的“多重检验”这一核心问题。它清晰地解释了为何传统的显著性水平（如 $p \\lt 0.05$）在此类研究中不再适用，并演示了如何通过Bonferroni校正方法计算调整后的p值阈值，为理解全基因组显著性水平的由来提供了坚实的理论基础。", "problem": "一个遗传学家团队正在进行一项全基因组关联研究（GWAS），以识别与一种新发现的复杂疾病相关的遗传标记。GWAS涉及扫描许多个体的基因组，以确定与对照组相比，任何特定的遗传变异是否在患有该疾病的人群中更常见。本研究中分析的遗传变异是单核苷酸多态性（SNPs）。\n\n在这项特定研究中，研究人员正在同时测试 $m = 1,000,000$ 个独立的SNPs，以寻找它们与该疾病的统计关联。传统上，对于单个统计检验，显著性的p值阈值（alpha水平）设定为 $\\alpha = 0.05$。然而，进行如此大量的检验会显著增加纯粹由偶然机会获得至少一个“假阳性”结果（I型错误）的概率。\n\n为了应对这个多重检验问题，研究团队决定控制总体错误率（FWER），其定义为在所有进行的检验中犯一个或多个I型错误的概率。他们的目标是使FWER保持在0.05或以下。为实现这一目标，他们将对其显著性阈值应用Bonferroni校正。\n\n给定被检验的独立SNPs数量和期望的FWER，计算单个SNP要被认为是统计显著的，所必须满足的新的、经过Bonferroni校正的p值阈值。请用科学记数法表示您的答案。", "solution": "根据Bonferroni程序，总体错误率满足Bonferroni不等式：\n$$\n\\text{FWER} \\leq \\sum_{i=1}^{m} \\alpha_{i}.\n$$\n如果 $m$ 个检验中的每一个都以相同的单次检验显著性水平 $\\alpha^{*}$ 进行，那么\n$$\n\\text{FWER} \\leq m \\alpha^{*}.\n$$\n为了将FWER控制在期望的水平 $\\alpha$，选择 $\\alpha^{*}$ 使得\n$$\nm \\alpha^{*} \\leq \\alpha \\quad \\Rightarrow \\quad \\alpha^{*} = \\frac{\\alpha}{m}.\n$$\n当 $\\alpha = 0.05$ 且 $m = 1{,}000{,}000 = 10^{6}$ 时，我们将 $0.05 = 5 \\times 10^{-2}$ 写入并计算\n$$\n\\alpha^{*} = \\frac{5 \\times 10^{-2}}{10^{6}} = 5 \\times 10^{-2-6} = 5 \\times 10^{-8}.\n$$\n因此，经过Bonferroni校正的p值阈值为 $5 \\times 10^{-8}$。", "answer": "$$\\boxed{5 \\times 10^{-8}}$$", "id": "1494362"}]}