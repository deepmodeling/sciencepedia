## 引言
在群体遗传学中，一个核心挑战是从复杂的基因组数据中解读塑造物种演化历程的无形力量。我们观察到的遗传变异模式，究竟是随机遗传漂变的产物，还是自然选择或剧烈种群历史变迁留下的印记？为了解答这一问题，科学家们开发了多种统计工具，其中，由日本遗传学家田岛文生（Fumio Tajima）在1989年提出的 [Tajima's D](@entry_id:166949) 统计量，已成为一块不可或缺的基石。它提供了一种精巧的方法来检验 DNA 序列数据是否符合中性进化模型的期望，从而揭示可能存在的选择压力或人口动态变化。

本文旨在系统地介绍 [Tajima's D](@entry_id:166949) 统计量，带领读者从基本原理走向前沿应用。在“**原理与机制**”一章中，我们将深入剖析该统计量的核心思想，即比较两种对遗传多样性的不同估算，并阐明其为何对不同频率的等位基因具有差异化的敏感性。随后，在“**应用与跨学科联系**”一章，我们将通过一系列真实世界的案例，展示 [Tajima's D](@entry_id:166949) 如何被用来推断群体扩张或瓶颈等历史事件，以及如何作为基因组“扫描仪”来定位发生过选择性清除或[平衡选择](@entry_id:150481)的关键基因。最后，“**动手实践**”部分将提供具体的计算练习，帮助读者巩固理论知识，将抽象概念转化为可操作的技能。通过这三个章节的学习，您将掌握一个强大的工具，用以从 DNA 序列中解读生命演化的故事。

## 原理与机制

在[群体遗传学](@entry_id:146344)中，理解塑造遗传变异的进化力量是核心目标之一。[Tajima's D](@entry_id:166949) 统计量是检验 DNA 序列数据中多态性模式是否偏离中性进化模型的关键工具。本章将深入探讨 [Tajima's D](@entry_id:166949) 的基本原理、其核心机制，以及如何解释其结果以推断群体的进化历史。

### [遗传多样性](@entry_id:201444)的双重估算

中性分子进化理论预测，在一个大小恒定、处于[突变-漂变平衡](@entry_id:204457)状态的群体中，[遗传多样性](@entry_id:201444)的不同衡量方式应指向一个共同的参数。这个参数是群体突变率，通常表示为 $\theta$，对于[二倍体](@entry_id:268054)生物，其定义为 $\theta = 4N_e\mu$，其中 $N_e$ 是有效群体大小，$\mu$ 是每个世代每个位点的[中性突变](@entry_id:176508)率。[Tajima's D](@entry_id:166949) 统计量的根本思想，是比较对 $\theta$ 的两个不同估算值 [@problem_id:1968046]。

#### [核苷酸多样性](@entry_id:164565) ($\pi$)

第一个估算子是**[核苷酸多样性](@entry_id:164565) (nucleotide diversity)**，用符号 $\pi$ 表示。它被定义为从群体中随机抽取的两条序列之间，单位点[核苷酸](@entry_id:275639)差异数的平均值。因此，$\pi$ 有时也被记为 $\hat{\theta}_\pi$。计算 $\pi$ 的步骤如下：
1.  计算样本中所有可能的序列对。对于一个包含 $n$ 条序列的样本，总共有 $\binom{n}{2}$ 个序列对。
2.  对每一个序列对，计算它们之间[核苷酸](@entry_id:275639)差异的总数。
3.  将所有序列对的差异数相加，然后除以序列对的总数，得到平[均差](@entry_id:138238)异数 $k$。
4.  最后，将 $k$ 除以序列的长度 $L$，得到单位点的平[均差](@entry_id:138238)异数，即 $\pi = k/L$。

在标[准中性](@entry_id:184567)模型（Standard Neutral Model, SNM）的假设下，$\pi$ 是 $\theta$ 的一个无偏估计，即 $E[\pi] = \theta$。

#### Watterson 估算子 ($\theta_W$)

第二个估算子由遗传学家 Warren Watterson 提出，因此被称为 **Watterson 估算子 (Watterson's estimator)**，记为 $\theta_W$ 或 $\hat{\theta}_S$。该估算子基于样本中**分离位点 (segregating sites)** 的数量，用 $S$ 表示。分离位点是指在序列比对中，至少观察到两种不同[核苷酸](@entry_id:275639)的位点。

$\theta_W$ 的计算公式为：
$$ \hat{\theta}_W = \frac{S/L}{a_n} $$
其中 $S$ 是分离位点的总数，$L$ 是序列长度，$n$ 是样本大小（序列数量），而 $a_n$ 是一个仅依赖于样本大小的校正因子，其计算公式为 $a_n = \sum_{i=1}^{n-1} \frac{1}{i}$。与 $\pi$ 一样，在标[准中性](@entry_id:184567)模型的假设下，$\theta_W$ 也是 $\theta$ 的一个无偏估计，即 $E[\theta_W] = \theta$。

由于 $\pi$ 和 $\theta_W$ 都是对同一参数 $\theta$ 的估计，中性理论预测它们的[期望值](@entry_id:153208)应该相等。因此，如果一个群体的进化历史符合标[准中性](@entry_id:184567)模型，我们预期在样本中计算出的 $\pi$ 和 $\theta_W$ 的值会非常接近。[Tajima's D](@entry_id:166949) 检验正是基于这一核心预测 [@problem_id:1968045]。

### 核心机制：对等位基因频率的不同敏感性

为何两种对同一参数的估算会产生差异？关键在于它们对不同频率的等位基因的敏感性不同。这种差异是理解 [Tajima's D](@entry_id:166949) 统计量背后机制的钥匙。

Watterson 估算子 $\theta_W$ 直接来源于分离位点的总数 $S$。这意味着，每一个分离位点，无论其变异等位基因在群体中的频率是高是低，都对 $S$ 做出相同的贡献（即贡献为 1）。一个仅在一条序列中出现的“单例”变异 (singleton) 和一个在近半数序列中出现的变异，对 $S$ 的影响是完全一样的。

相比之下，[核苷酸多样性](@entry_id:164565) $\pi$ 的计算方式赋予了不同频率的等位基因不同的权重。一个分离位点对 $\pi$ 的贡献，取决于该位点上不同[核苷酸](@entry_id:275639)的频率。具体而言，如果在一个有 $n$ 条序列的样本中，某个位点上变异等位基因的拷贝数为 $k$（参考等位基因的拷贝数为 $n-k$），那么在该位点上随机抽取的两条序列存在差异的概率与乘积 $k(n-k)$ 成正比。这个乘积在[等位基因频率](@entry_id:146872)处于中间水平时（即 $k \approx n/2$）达到最大值，而在等位基因频率极低（如 $k=1$）或极高时（如 $k=n-1$）为最小值。

我们可以通过一个具体的例子来阐明这一点 [@problem_id:1968037]。假设我们分析了 $n=25$ 条序列，并发现了两个分离位点。在 X 位点，一个稀有等位基因出现了 2 次；在 Y 位点，一个频率中等的等位基因出现了 12 次。
- 对于 Watterson 估算子，X 位点和 Y 位点都是分离位点，它们对 $S$ 的贡献是相等的。
- 对于[核苷酸多样性](@entry_id:164565) $\pi$，Y 位点（频率中等）的贡献远大于 X 位点（频率稀有），因为在 Y 位点上随机抽取的两条序列存在差异的可能性要大得多。计算表明，Y 位点对 $\pi$ 的贡献与 X 位点对 $\pi$ 的贡献之比高达 $\frac{12 \times 13}{2 \times 23} = \frac{156}{46} \approx 3.39$。

这个例子清晰地表明，$\pi$ 对中等频率的等位基因更为敏感，而 $\theta_W$ 则不成比例地受到稀有等位基因数量的影响。

### [位点频率谱](@entry_id:163689) (SFS) 与估算子偏差

这种不同的敏感性直接与**[位点频率谱](@entry_id:163689) (Site Frequency Spectrum, SFS)** 相关。SFS 是一个[分布](@entry_id:182848)，描述了在一个样本中，不同频率的变异等位基因（[多态性](@entry_id:159475)位点）的数量。[Tajima's D](@entry_id:166949) 实际上是对 SFS 形状的一种总结。

- **当 SFS 偏向稀有等位基因时**：如果一个群体中存在大量稀有变异（例如，大量的“单例”变异，即仅在单个个体中发现的突变），这将导致分离位点总数 $S$ 大幅增加。然而，由于这些变异频率极低，它们对成对差异的平均值 $\pi$ 的贡献非常小。因此，在这种情况下，我们会观察到 $\theta_W$ 的值被不成比例地拉高，而 $\pi$ 的值相对较低，导致 $\theta_W > \pi$ [@problem_id:1968042] [@problem_id:1968024]。

- **当 SFS 偏向中等频率等位基因时**：如果群体中存在过量的中等频率等位基因，这些位点会极大地增加成对序列间的差异数。因此，$\pi$ 的值会显著增大。虽然这些位点同样对 $S$ 有贡献，但 $\pi$ 的增幅会超过 $\theta_W$。因此，我们会观察到 $\pi > \theta_W$。

- **当 SFS 符合中性期望时**：在标[准中性](@entry_id:184567)模型下，SFS 的形状是可预测的。群体中稀有等位基因的数量（通常较多）和中等频率等位基因的数量（通常较少）处于一种平衡状态，这种平衡恰好使得 $\pi \approx \theta_W$ [@problem_id:1968052]。

### [Tajima's D](@entry_id:166949) 统计量的定义与解释

[Tajima's D](@entry_id:166949) 统计量将 $\pi$ 和 $\theta_W$ 之间的差异进行了[标准化](@entry_id:637219)。其定义为：
$$ D = \frac{d}{\sqrt{\widehat{\text{Var}}(d)}} = \frac{\pi - \theta_W}{\sqrt{e_1 S + e_2 S(S-1)}} $$
这里的分子 $d = \pi - \theta_W$ 是两个估算子的原始差异（注意，在实际计算中，$\pi$ 和 $\theta_W$ 需调整为相同的单位，如总差异数与由 S 估计的总差异数）。分母是该差异 $d$ 的[方差](@entry_id:200758)的估计值，它依赖于样本大小 $n$ 和分离位点数 $S$（通过常数 $e_1$ 和 $e_2$ 体现）。将原始差异[标准化](@entry_id:637219)的好处是，它使得 D 值的解释不依赖于潜在的 $\theta$ 值，从而可以在不同基因或不同研究之间进行比较。

根据 $D$ 值的正负和大小，我们可以对群体的进化历史做出推断：

- **$D \approx 0$**：表示 $\pi \approx \theta_W$。这个结果与标[准中性](@entry_id:184567)模型的期望相符。它表明，没有证据拒绝群体处于一个大小稳定、经历[突变-漂变平衡](@entry_id:204457)且无选择作用的[零假设](@entry_id:265441) [@problem_id:1968052]。

- **$D  0$**：表示 $\pi  \theta_W$。这说明群体中存在过量的稀有等位基因 [@problem_id:1968033]。导致负 D 值的两个主要[进化过程](@entry_id:175749)是 [@problem_id:1968032]：
    1.  **群体扩张 (Population Expansion)**：当一个群体在近期快速增长时，许多新的突变会进入群体。这些新突变都处于非常低的频率，因为它们没有足够的时间通过遗传漂变达到更高的频率。这导致了 SFS 向稀有变异偏移 [@problem_id:1968045]。
    2.  **[正选择](@entry_id:165327)（[定向选择](@entry_id:136267)）或[背景选择](@entry_id:167635) (Positive or Background Selection)**：一次**[选择性清除](@entry_id:169307) (selective sweep)**，即一个有利突变被迅速固定，会将其连锁的周边中性变异一同带向固定，从而消除该区域的变异。之后，新的突变开始重新积累，这些新突变都是稀有的。此外，**[背景选择](@entry_id:167635)**，即在一个基因组区域内，纯化选择不断地清除新产生的有害突变，也会顺带清除与之连锁的中性多态性。这个过程不成比例地移除了那些存在时间较长、可能已漂变到中等频率的较老的中性变异，从而使得留下的中性变异谱系偏向于较年轻的、稀有的变异 [@problem_id:1968039]。

- **$D > 0$**：表示 $\pi > \theta_W$。这说明群体中存在过量的中等频率等位基因。导致正 D 值的两个主要进化过程是 [@problem_id:1968032]：
    1.  **[群体瓶颈](@entry_id:154577)或群体结构 (Population Bottleneck or Structure)**：当一个群体经历剧烈的规模缩小时（瓶颈），许多稀有等位基因会因[遗传漂变](@entry_id:145594)而丢失。幸存下来的等位基因在群体恢复后，其相对比例中，中等频率的等位基因会显得过量。类似的，如果一个样本实际上来自几个分化的亚群，也会人为地制造出中等频率等位基因过量的现象。
    2.  **[平衡选择](@entry_id:150481) (Balancing Selection)**：某些形式的自然选择，如[超显性](@entry_id:268017)（[杂合子优势](@entry_id:143056)），会主动维持多个等位基因在群体中以中等频率共存。这直接导致了 $\pi$ 相对于 $\theta_W$ 的增加。

### 实践中的考量

在实际应用 [Tajima's D](@entry_id:166949) 时，有几个重要的因素需要考虑。

首先，让我们通过一个计算实例来巩固理解 [@problem_id:1968045]。假设对一个高山植物的样本（$n=20$）进行测序，得到 $S = 40$ 个分离位点，以及平均成对差异数 $\pi = 6.20$（此处 $\pi$ 指总差异数，非单位点）。对于 $n=20$，相关常数为 $a_1=3.5977$，$e_1=0.02514$，$e_2=0.004470$。
1.  计算 Watterson 估算子（总差异数形式）：$\theta_W = S/a_1 = 40 / 3.5977 \approx 11.12$。
2.  计算分子：$d = \pi - \theta_W = 6.20 - 11.12 = -4.92$。
3.  计算分母：$\sqrt{e_1 S + e_2 S^2} = \sqrt{0.02514 \times 40 + 0.004470 \times 40^2} \approx \sqrt{1.0056 + 7.152} \approx 2.86$。
4.  计算 [Tajima's D](@entry_id:166949)：$D = -4.92 / 2.86 \approx -1.72$。
这个显著的负值表明群体中存在过量的稀有等位基因，这可能是近期群体扩张或[选择性清除](@entry_id:169307)的结果。

其次，必须考虑**[统计功效](@entry_id:197129) (statistical power)** 的问题，尤其是当样本量较小时。[Tajima's D](@entry_id:166949) 的显著性取决于其[绝对值](@entry_id:147688)的大小。然而，当样本量 $n$ 很小时，对 $\pi$ 和 $S$ 的估计值的[方差](@entry_id:200758)会非常大。这个高[方差](@entry_id:200758)会反映在 D 统计量的分母上，使其值变大。因此，即使群体中真实存在偏离中性的 SFS（即分子不为零），一个大的分母也可能导致 D 值接近于零，从而无法拒绝[零假设](@entry_id:265441)。这就是为什么使用小样本（例如 $n=5$）很难获得统计上显著的 D 值的原因；一个不显著的结果并不一定意味着群体严格遵循中性模型，可能仅仅是因为检验的功效不足 [@problem_id:1968048]。因此，在解释 [Tajima's D](@entry_id:166949) 结果时，样本量是一个至关重要的考量因素。