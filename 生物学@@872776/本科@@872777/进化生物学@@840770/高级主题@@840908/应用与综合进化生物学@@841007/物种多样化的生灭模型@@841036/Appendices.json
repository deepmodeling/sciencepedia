{"hands_on_practices": [{"introduction": "要真正掌握出生-死亡模型，一个绝佳的起点是理解其核心的随机性。即使在整体条件有利（即谱系形成速率 $\\lambda$ 高于绝灭速率 $\\mu$）的情况下，一个新生的谱系也可能因为偶然事件而走向终结。这个练习将通过一个经典的场景——单个物种开拓新大陆——来引导你计算其最终绝灭的概率，从而揭示宏观演化过程中随机性的深刻影响 [@problem_id:1911784]。", "problem": "一个进化生物学家团队正在研究一个新的分支（clade）的长期演化命运。该分支起源于一个创始物种，该物种殖民了一个原始、孤立的大陆。为了模拟其多样化过程，他们采用了一个简单的连续时间生灭模型。\n\n在这个模型中，适用以下规则：\n1.  过程在时间 $t=0$ 时从单个物种开始。\n2.  大陆上存在的每个物种都有一个恒定的单位物种成种率 $\\lambda$。成种是一个物种分裂成两个不同物种的事件。\n3.  每个物种也有一个恒定的单位物种灭绝率 $\\mu$。\n4.  如果在任何给定时间存在 $N$ 个物种，则整个分支的总成种率为 $N\\lambda$，总灭绝率为 $N\\mu$。\n5.  不同物种的演化命运彼此独立。\n\n生物学家们正在分析一个环境条件有利于多样化的情景，即成种率严格大于灭绝率（$\\lambda > \\mu$）。即使在这些有利条件下，由于随机事件，整个分支仍有可能灭绝，尤其是在物种数量较少时。\n\n计算这个从单个创始物种开始的整个分支最终将灭绝的概率。用 $\\lambda$ 和 $\\mu$ 表示你的答案，形式为一个闭式解析表达式。", "solution": "令 $q$ 表示从单个物种开始，分支最终灭绝的概率。考虑一个长度为 $\\mathrm{d}t$ 的微小时间间隔。在此时间间隔内，对于这个单物种，可能发生三种不相交的事件：\n- 以概率 $\\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)$ 发生一次成种事件，产生两个后代物种。根据分支和独立性假设，这两个后代谱系独立地灭绝，因此在此事件下灭绝的概率是 $q^{2}$。\n- 以概率 $\\mu\\,\\mathrm{d}t + o(\\mathrm{d}t)$，该物种灭绝，从而整个分支以概率 $1$ 灭绝。\n- 以概率 $1 - (\\lambda + \\mu)\\,\\mathrm{d}t + o(\\mathrm{d}t)$，没有事件发生，灭绝概率仍然是 $q$。\n\n应用全概率公式，并保留 $\\mathrm{d}t$ 的一阶项，可得\n$$\nq \\,=\\, \\lambda\\,\\mathrm{d}t\\, q^{2} \\;+\\; \\mu\\,\\mathrm{d}t \\cdot 1 \\;+\\; \\bigl(1 - (\\lambda + \\mu)\\,\\mathrm{d}t\\bigr)\\, q \\;+\\; o(\\mathrm{d}t).\n$$\n两边减去 $q$，再除以 $\\mathrm{d}t$，并取 $\\mathrm{d}t \\to 0$ 的极限，得到\n$$\n0 \\,=\\, \\lambda\\,(q^{2} - q) \\;+\\; \\mu\\,(1 - q).\n$$\n整理后得到二次方程\n$$\n\\lambda q^{2} - (\\lambda + \\mu) q + \\mu \\,=\\, 0.\n$$\n它可以因式分解为\n$$\n(\\lambda q - \\mu)(q - 1) \\,=\\, 0,\n$$\n因此候选解为 $q = \\mu/\\lambda$ 和 $q = 1$。灭绝概率是与该过程一致的在 $[0,1]$ 区间内的最小根。对于 $\\lambda > \\mu$ 的超临界过程，我们有 $\\mu/\\lambda < 1$，灭绝概率为\n$$\nq \\,=\\, \\frac{\\mu}{\\lambda}.\n$$\n（为了完整性，当 $\\lambda \\leq \\mu$ 时，唯一的可接受根是 $q = 1$。）在所述的 $\\lambda > \\mu$ 假设下，所求的灭绝概率是 $\\mu/\\lambda$。", "answer": "$$\\boxed{\\frac{\\mu}{\\lambda}}$$", "id": "1911784"}, {"introduction": "理论模型为我们提供了理解演化过程的框架，但真实世界的数据又该如何分析呢？演化生物学家常常面对多种关于谱系多样化动态的替代理论假说，例如，多样化速率是恒定的，还是会随着物种数量的增加而减慢？这个练习将带你进入系统发育比较方法学的核心，学习如何使用赤池信息准则（Akaike Information Criterion, AIC）来比较不同出生-死亡模型的拟合优度，从而以定量的方式评估哪种演化假说能更好地解释观察到的系统发育树 [@problem_id:1911781]。", "problem": "一位进化生物学家正在使用一个经过时间校准的分子系统发育树，研究一个深海珊瑚演化支的多样化动态。为了检验关于宏观进化过程的竞争性假说，该生物学家将两种不同的随机生灭模型拟合到系统发育树中观察到的分支时间上。\n\n第一个模型是恒定速率生灭（CR-BD）模型。该模型假定物种形成速率（$\\lambda$）和物种灭绝速率（$\\mu$）在整个时间和所有谱系中都是恒定的。由于它估计两个参数（$\\lambda$和$\\mu$），该模型有 $k=2$ 个自由参数。经过数值优化，该模型的最大对数似然值为 $\\ln(L_{\\text{CR-BD}}) = -152.8$。\n\n第二个模型是多样性依赖性物种形成（DDS）模型。该模型假设灭绝速率（$\\mu$）是恒定的，但物种形成速率随着当代谱系数量 $N$ 的增加而线性下降。物种形成速率由 $\\lambda(N) = \\lambda_0 - \\alpha N$ 给出，其中 $\\lambda_0$ 是初始物种形成速率，$\\alpha$ 量化了多样性依赖性的强度。该模型有三个自由参数（$\\lambda_0$、$\\alpha$ 和 $\\mu$），所以 $k=3$。DDS模型的最大对数似然值为 $\\ln(L_{\\text{DDS}}) = -149.5$。\n\n为了比较这两个模型的解释力，同时对DDS模型增加的复杂性进行惩罚，该生物学家使用了一种基于赤池信息准z则（AIC）的模型选择方法。一个模型的AIC值使用以下公式计算：\n$$ \\text{AIC} = 2k - 2\\ln(L) $$\n其中 $k$ 是模型中的自由参数数量，$\\ln(L)$ 是最大化对数似然值。较低的AIC值表示模型拟合得更好。\n\n一个集合中每个模型的相对支持度可以用赤池权重 $w_i$ 来表示。要为一个来自 $R$ 个候选模型集合中的模型 $i$ 计算这个值，首先要计算其AIC值与集合中最小AIC值之间的差值：$\\Delta_i = \\text{AIC}_i - \\text{AIC}_{\\text{min}}$。然后，模型 $i$ 的赤池权重由下式给出：\n$$ w_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{R} \\exp(-\\frac{1}{2}\\Delta_j)} $$\n赤池权重 $w_i$ 可以被解释为在给定数据的情况下，模型 $i$ 是该集合中最佳模型的概率。\n\n使用所提供的信息，计算多样性依赖性物种形成（DDS）模型的赤池权重。将最终答案四舍五入到三位有效数字。", "solution": "我们需要使用赤池信息准则来比较两个模型。根据定义，\n$$ \\text{AIC} = 2k - 2\\ln(L). $$\n\n对于CR-BD模型，有 $k=2$ 和 $\\ln(L_{\\text{CR-BD}})=-152.8$，\n$$ \\text{AIC}_{\\text{CR-BD}} = 2\\cdot 2 - 2(-152.8) = 4 + 305.6 = 309.6. $$\n\n对于DDS模型，有 $k=3$ 和 $\\ln(L_{\\text{DDS}})=-149.5$，\n$$ \\text{AIC}_{\\text{DDS}} = 2\\cdot 3 - 2(-149.5) = 6 + 299.0 = 305.0. $$\n\n最小AIC是 $\\text{AIC}_{\\text{min}}=305.0$ (DDS)。AIC的差值为\n$$ \\Delta_{\\text{DDS}} = 305.0 - 305.0 = 0, \\quad \\Delta_{\\text{CR-BD}} = 309.6 - 305.0 = 4.6. $$\n\n对于 $R=2$ 个模型，DDS模型的赤池权重是\n$$ w_{\\text{DDS}} = \\frac{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right)}{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right) + \\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{CR-BD}}\\right)} = \\frac{1}{1 + \\exp\\!\\left(-\\frac{1}{2}\\cdot 4.6\\right)} = \\frac{1}{1 + \\exp(-2.3)}. $$\n\n数值上，$\\exp(-2.3) \\approx 0.1002588435$，因此\n$$ w_{\\text{DDS}} \\approx \\frac{1}{1 + 0.1002588435} \\approx 0.908877. $$\n\n四舍五入到三位有效数字得到 $0.909$。", "answer": "$$\\boxed{0.909}$$", "id": "1911781"}, {"introduction": "在上一项练习中，我们学习了如何从一组候选模型中选出“最佳”模型。然而，一个关键的后续问题是：这个所谓的“最佳”模型，是否真的足够好地描述了我们的数据？此练习将介绍一种重要的模型验证技术——拟合优度检验。你将学习如何通过将经验数据的某个统计特征（此处为树的不平衡度）与从模型中模拟出的大量数据进行比较，来检验模型的有效性，这对于确保我们科学推断的可靠性至关重要 [@problem_id:1911791]。", "problem": "一位演化生物学家正在研究一个由10个现存物种组成的特定分支的演化动态。一个代表它们演化关系的系统发育树已被重建。该生物学家希望评估观测到的系统发育树的形状是否与一个恒定速率的演化模型（一个“生死过程”）相符。\n\n为此，对观测到的树计算了一个特定的树不平衡度量。这个“总不平衡分数”的计算方法如下：对于树的9个内部节点（分叉点）中的每一个，计算从该节点分出的两个子分支中末端物种（叶尖）数量的绝对差。整个树的总不平衡分数是所有内部节点上这些绝对差的总和。\n\n对于观测到的经验树，其9个内部节点上物种的划分由以下数对给出，其中每个数对 $(N_L, N_R)$ 分别代表左右两个子分支中的物种数量：\n\n(1, 9), (1, 8), (1, 7), (1, 6), (1, 5), (1, 4), (1, 3), (1, 2), (1, 1)\n\n为了确定观测到的树的不平衡度是否异常，该生物学家的研究小组进行了大量的模拟。他们假设该分支的演化遵循恒定速率的生死模型，并在此基础上生成了2000个不同的、每个都包含10个物种的系统发育树。对于这2000个模拟树中的每一个，他们都计算了相同的总不平衡分数。他们的分析显示，在这些模拟树中，有82个树的总不balance分数大于或等于从观测到的经验树计算出的分数。\n\n根据这些信息，计算统计p值。p值代表在原假设（即该分支根据模拟的恒定速率生死过程演化）成立的情况下，观测到一个与经验树同样不平衡或更不平衡的树的概率。请将你的答案表示为小数，并四舍五入到三位有效数字。", "solution": "将一个具有9个内部节点的有根二叉树的总不平衡分数定义为\n$$\nS=\\sum_{j=1}^{9}\\left|N_{L,j}-N_{R,j}\\right|,\n$$\n其中 $N_{L,j}$ 和 $N_{R,j}$ 是内部节点 $j$ 处左右两个子分支中的叶尖数量。对于观测到的树，给定的数对是 $(1,9),(1,8),(1,7),(1,6),(1,5),(1,4),(1,3),(1,2),(1,1)$，因此绝对差为 $8,7,6,5,4,3,2,1,0$，它们的总和为\n$$\nS_{\\text{obs}}=8+7+6+5+4+3+2+1+0=36.\n$$\n为了在原假设（恒定速率生死过程）下评估其显著性，我们使用基于模拟树的蒙特卡洛p值。如果生成了 $M$ 个模拟树，其中有 $k$ 个树满足 $S^{(i)}\\geq S_{\\text{obs}}$，那么上尾p值的蒙特卡洛估计值为\n$$\n\\hat{p}=\\frac{k}{M}.\n$$\n在这里，$M=2000$ 且 $k=82$，所以\n$$\n\\hat{p}=\\frac{82}{2000}=\\frac{41}{1000}=0.041.\n$$\n四舍五入到三位有效数字，结果是 $0.0410$。", "answer": "$$\\boxed{0.0410}$$", "id": "1911791"}]}