{"hands_on_practices": [{"introduction": "在真实的自然环境中，种群并非完全隔离。来自不同环境的个体迁徙（基因流）可能会引入在本地适应不良的等位基因。这个练习将探讨一个经典的“拔河”场景：一方面，本地的自然选择倾向于让某个等位基因（在此例中是“固着”行为）的频率增加以应对特定捕食者；另一方面，持续的基因流则会引入与之相反的等位基因。通过计算平衡状态下的等位基因频率[@problem_id:1956461]，你将亲身体会到，即使是少量的迁徙也能如何阻止一个优势等位基因达到完全固定，从而在种群中维持遗传变异。", "problem": "在许多淡水生态系统中，蜉蝣的幼虫（稚虫）面临来自不同来源的捕食，这导致了独特的反捕食策略的演化。本研究在两个相邻的河流生境中探讨了这一现象。\n\n一个广阔的上游河流系统栖息着底栖的石蝇捕食者。在这种环境中，蜉蝣稚虫演化出一种“漂流”逃避行为。这一行为由一个具有两个等位基因C和D的基因座控制。漂流等位基因D相对于紧附等位基因C为显性。因此，基因型为DD和DC的个体是“漂流者”，而只有基因型为CC的个体是“紧附者”。在广阔的上游河流系统中，对非漂流稚虫的持续捕食已使D等位基因达到固定（频率为1.0）。\n\n这条河流入一个更小、更隔离的下游生境，那里没有石蝇，主要的捕食者是依靠视觉捕食的鱼类。在这个以鱼类为主的环境中，隐蔽的“紧附”行为提供了显著的生存优势。“紧附者”稚虫（基因型CC）的适应度最高，可归一化为1。相比之下，“漂流者”稚虫（基因型DD和DC）在采取逃避反应时对鱼类而言非常显眼，因此其相对适应度较低，为$1-s$，其中$s=0.40$是针对漂流表型的选择系数。\n\n每一代，下游生境中蜉蝣种群的一部分（比例为$m=0.050$）由来自上游种群的新迁入个体组成。假设下游种群已经建立足够长的时间，在迁徙和自然选择的相互作用下达到了一个稳定状态，请计算紧附等位基因C的非零平衡频率。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "该问题要求计算在一个同时受局部选择和基因流（迁徙）影响的种群中，隐性“紧附”等位基因（C）的稳定非零平衡频率。设 $q$ 为C等位基因的频率，$p$ 为显性“漂流”等位基因（D）的频率，使得 $p+q=1$。\n\n下游种群每一代的生活史事件顺序是先迁徙后选择。\n\n步骤1：建立迁徙对等位基因频率影响的模型。\n设 $q_t$ 为一代开始时（迁徙前）下游种群中C等位基因的频率。种群中比例为 $m$ 的部分被来自上游源种群的迁入者替换，在上游源种群中C的频率为 $q_{source} = 0$。迁徙后C等位基因的频率 $q_{mig}$ 是本地频率和迁入者频率的加权平均值：\n$$q_{mig} = (1-m)q_t + m q_{source}$$\n已知 $m = 0.050$ 且 $q_{source} = 0$，方程变为：\n$$q_{mig} = (1-0.050)q_t = 0.950 q_t$$\n\n步骤2：建立选择对迁徙后基因库影响的模型。\n选择作用于下游种群的基因型，其等位基因频率现在为 $q_{mig}$ 和 $p_{mig} = 1 - q_{mig}$。假设种群在迁徙后随机交配，则选择前的基因型频率由哈迪-温伯格比例给出：\n- DD的频率: $f(DD) = p_{mig}^2$\n- DC的频率: $f(DC) = 2p_{mig}q_{mig}$\n- CC的频率: $f(CC) = q_{mig}^2$\n\n这些基因型的相对适应度值（$W$）如下：\n- 漂流者（DD和DC）的适应度: $W_{DD} = W_{DC} = 1-s = 1-0.40 = 0.60$\n- 紧附者（CC）的适应度: $W_{CC} = 1$\n\n种群的平均适应度 $\\bar{W}$ 是各基因型适应度按其频率加权的平均值：\n$$\\bar{W} = f(DD)W_{DD} + f(DC)W_{DC} + f(CC)W_{CC}$$\n$$\\bar{W} = p_{mig}^2(1-s) + 2p_{mig}q_{mig}(1-s) + q_{mig}^2(1)$$\n提取公因式 $(1-s)$:\n$$\\bar{W} = (p_{mig}^2 + 2p_{mig}q_{mig})(1-s) + q_{mig}^2$$\n由于 $p_{mig}^2 + 2p_{mig}q_{mig} + q_{mig}^2 = (p_{mig}+q_{mig})^2 = 1$，我们可以写出 $p_{mig}^2 + 2p_{mig}q_{mig} = 1 - q_{mig}^2$。\n$$\\bar{W} = (1-q_{mig}^2)(1-s) + q_{mig}^2 = 1 - s + sq_{mig}^2$$\n\n步骤3：计算下一代的等位基因频率。\n下一代C等位基因的频率 $q_{t+1}$ 是选择后基因库中C等位基因的频率。这是通过将来自每个基因型的C等位基因的频率按其适应度加权求和，然后除以平均适应度得到的。\nC等位基因的频率来自一半的DC个体和所有的CC个体。\n$$q_{t+1} = \\frac{(p_{mig}q_{mig}) W_{DC} + q_{mig}^2 W_{CC}}{\\bar{W}}$$\n$$q_{t+1} = \\frac{p_{mig}q_{mig}(1-s) + q_{mig}^2(1)}{1-s+sq_{mig}^2}$$\n从分子中提取公因式 $q_{mig}$：\n$$q_{t+1} = \\frac{q_{mig}(p_{mig}(1-s) + q_{mig})}{1-s+sq_{mig}^2}$$\n代入 $p_{mig} = 1-q_{mig}$:\n$$q_{t+1} = \\frac{q_{mig}((1-q_{mig})(1-s) + q_{mig})}{1-s+sq_{mig}^2} = \\frac{q_{mig}(1-s-q_{mig}+sq_{mig} + q_{mig})}{1-s+sq_{mig}^2}$$\n$$q_{t+1} = \\frac{q_{mig}(1-s+sq_{mig})}{1-s+sq_{mig}^2}$$\n\n步骤4：求解平衡频率。\n在平衡状态下，等位基因频率是稳定的，所以 $q_{t+1} = q_t = \\hat{q}$。\n我们将 $q_{mig} = (1-m)\\hat{q}$ 代入 $q_{t+1}$ 的方程中：\n$$\\hat{q} = \\frac{((1-m)\\hat{q})(1-s+s(1-m)\\hat{q})}{1-s+s((1-m)\\hat{q})^2}$$\n一个解是平凡平衡 $\\hat{q}=0$。为了找到非零平衡，我们将等式两边同时除以 $\\hat{q}$ (假设 $\\hat{q} \\neq 0$):\n$$1 = \\frac{(1-m)(1-s+s(1-m)\\hat{q})}{1-s+s(1-m)^2\\hat{q}^2}$$\n整理方程：\n$$1-s+s(1-m)^2\\hat{q}^2 = (1-m)(1-s+s(1-m)\\hat{q})$$\n$$1-s+s(1-m)^2\\hat{q}^2 = (1-m)(1-s) + s(1-m)^2\\hat{q}$$\n$$1-s+s(1-m)^2\\hat{q}^2 = 1-s-m+ms + s(1-m)^2\\hat{q}$$\n消去 $1-s$ 项并将所有项移到一边，得到一个关于 $\\hat{q}$ 的二次方程：\n$$s(1-m)^2\\hat{q}^2 - s(1-m)^2\\hat{q} + m - ms = 0$$\n$$s(1-m)^2\\hat{q}^2 - s(1-m)^2\\hat{q} + m(1-s) = 0$$\n\n步骤5：求解二次方程。\n我们使用二次方程求根公式 $\\hat{q} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中：\n$a = s(1-m)^2$\n$b = -s(1-m)^2$\n$c = m(1-s)$\n\n$$\\hat{q} = \\frac{s(1-m)^2 \\pm \\sqrt{(-s(1-m)^2)^2 - 4(s(1-m)^2)(m(1-s))}}{2s(1-m)^2}$$\n$$\\hat{q} = \\frac{s(1-m)^2 \\pm s(1-m)^2 \\sqrt{1 - \\frac{4sm(1-s)(1-m)^2}{s^2(1-m)^4}}}{2s(1-m)^2}$$\n$$\\hat{q} = \\frac{1}{2} \\left( 1 \\pm \\sqrt{1 - \\frac{4m(1-s)}{s(1-m)^2}} \\right)$$\n\n步骤6：代入数值。\n已知 $s = 0.40$ 且 $m = 0.050$:\n平方根下的项是：\n$$1 - \\frac{4(0.050)(1-0.40)}{0.40(1-0.050)^2} = 1 - \\frac{0.20 \\times 0.60}{0.40 \\times (0.95)^2} = 1 - \\frac{0.12}{0.40 \\times 0.9025} = 1 - \\frac{0.12}{0.361}$$\n$$1 - 0.33240997... = 0.66759003...$$\n平方根是：\n$$\\sqrt{0.66759003...} \\approx 0.81706182$$\n$\\hat{q}$ 的两个可能的平衡值是：\n$$\\hat{q}_1 = \\frac{1 + 0.81706182}{2} \\approx 0.90853091$$\n$$\\hat{q}_2 = \\frac{1 - 0.81706182}{2} \\approx 0.09146909$$\n\n选择作用于一个隐性有利等位基因（C）。在这种情况下，存在一个阈值频率，低于该频率时，该等位基因会因为在杂合子中大部分“隐藏”起来而免受正选择，从而丢失。来自该等位基因缺失的种群的迁徙进一步压低了其频率。较低的平衡点 $\\hat{q}_2 \\approx 0.091$ 代表了这个不稳定的临界点。如果C的频率降到该值以下，它将被淘汰（趋向于 $\\hat{q}=0$）。如果高于该值，它将增加，直到达到较高的稳定平衡。因此，稳定的非零平衡频率是 $\\hat{q}_1$。\n\n$\\hat{q} \\approx 0.90853091$\n\n四舍五入到三位有效数字，我们得到 0.909。", "answer": "$$\\boxed{0.909}$$", "id": "1956461"}, {"introduction": "在捕食者与猎物的军备竞赛中，一个性状的适应性并非总是恒定不变的。在许多情况下，“稀有”本身就是一种优势。这个练习探讨了负频率依赖选择（negative frequency-dependent selection），即一种策略的成功率会随着其变得普遍而下降。在这个假设的植物与象鼻虫的系统中[@problem_id:1956477]，当大多数植物都采取“耐心”的二年生策略时，专门捕食它们的象鼻虫数量会随之增加，反而使得稀有的“速生”一年生策略因为能够避开天敌而更具优势。推导出平衡频率的过程将向你展示，频率依赖选择是维持种群内多种策略（即遗传多态性）共存的强大机制。", "problem": "一种名为*Silene noctiflora*的二年生植物，面临着一种特化象鼻虫对其种子的强烈捕食。这种选择压力导致在控制该植物生活史策略的单个基因座上出现了稳定的遗传多态性。该基因座上存在两种等位基因：'A'和'B'。\n\n拥有至少一个'A'等位基因的植株会采取“加速”的一年生策略，在第一年开花并结实。这种策略使其能够完全避免被捕食，因为象鼻虫的生命周期是同步的，只在第二年出现并攻击植株。然而，这种快速发育会带来显著的生理成本，与未受捕食的二年生植株相比，其总存活种子产量会减少一个固定的比例 $c_A$。\n\n具有纯合'BB'基因型的植株则采取“耐心”的二年生策略，在第二年开花结实。这些植株不承受生理成本 $c_A$。但它们会遭受象鼻虫的捕食。象鼻虫捕食的有效性是密度依赖性的。具体来说，任何一株二年生植株上被象鼻虫破坏的种子比例，与种群中二年生等位基因'B'的频率成正比。这种关系由表达式 $d \\cdot q$ 描述，其中 $q$ 是等位基因'B'的频率， $d$ 是一个无量纲的捕食强度系数。参数 $c_A$ 和 $d$ 是小于1的正数常量。\n\n为简化起见，可以假设存在一个大型的随机交配种群，其中策略的适应度仅由其预期的种子产量决定。设每种策略的适应度与其产生的存活种子数量成正比。\n\n假设种群已达到一个稳定的一年生和二年生策略共存的多态性平衡，推导二年生等位基因'B'的平衡频率的符号表达式。", "solution": "设 $p$ 为等位基因'A'的频率，$q$ 为等位基因'B'的频率，且 $p+q=1$。适应度与预期的存活种子产量成正比。我们可以将未受捕食的二年生植株的基准种子产量归一化为1。\n\n根据问题描述，等位基因'A'对一年生策略是显性的。因此，具有基因型 $AA$ 和 $AB$ 的个体是一年生，其适应度因生理成本而降低：\n$$W_{AA} = W_{AB} = 1 - c_A$$\n\n具有基因型 $BB$ 的个体是二年生，其适应度受频率依赖性捕食的影响：\n$$W_{BB} = 1 - d \\cdot q$$\n\n在多态性平衡点，两种等位基因的边际适应度（marginal fitness）相等，即 $\\bar{w}_A = \\bar{w}_B$。\n\n等位基因'A'的边际适应度是携带它的个体（基因型 $AA$ 和 $AB$）的适应度的加权平均。在一个随机交配的种群中，一个'A'等位基因与另一个'A'等位基因结合的概率为 $p$，与'B'等位基因结合的概率为 $q$。因此：\n$$\\bar{w}_A = p \\cdot W_{AA} + q \\cdot W_{AB} = p(1-c_A) + q(1-c_A) = (p+q)(1-c_A) = 1-c_A$$\n\n类似地，等位基因'B'的边际适应度是：\n$$\\bar{w}_B = p \\cdot W_{AB} + q \\cdot W_{BB} = p(1-c_A) + q(1-dq)$$\n\n在平衡状态下，设置 $\\bar{w}_A = \\bar{w}_B$:\n$$1-c_A = p(1-c_A) + q(1-dq)$$\n用 $p=1-q$ 替换 $p$:\n$$1-c_A = (1-q)(1-c_A) + q(1-dq)$$\n展开右侧：\n$$1-c_A = (1-c_A) - q(1-c_A) + q(1-dq)$$\n$$1-c_A = 1-c_A - q + qc_A + q - dq^2$$\n$$0 = qc_A - dq^2$$\n$$0 = q(c_A - dq)$$\n\n这个方程有两个解：$q=0$（等位基因'B'丢失）或 $c_A - dq = 0$。\n为了维持多态性平衡（即'A'和'B'共存），$q$ 必须大于零。因此，我们取第二个解：\n$$c_A = dq$$\n求解平衡频率 $q$：\n$$q = \\frac{c_A}{d}$$", "answer": "$$\\boxed{\\frac{c_{A}}{d}}$$", "id": "1956477"}, {"introduction": "我们将从单一群体的动态模型，转向一个更广阔、更真实的地理格局。本练习以共同演化的地理镶嵌理论（Geographic Mosaic Theory of Coevolution, GMTC）为框架，该理论认为共同演化发生在由选择压力极强的“热点”区域和压力较弱的“冷点”区域组成的镶嵌景观中。这个高级练习[@problem_id:1956481]在一个简化的“热点-冷点”模型中，综合了基因流、代价高昂的防御以及频率依赖选择等多种因素。通过求解该系统在平衡状态下的平均适应度，你将得出一个深刻的结论：它揭示了一个种群因其适应性策略本身的代价（$c$）以及因不断有适应不良的基因从外部流入（$m$）而必须承受的“遗传负荷”（genetic load）。", "problem": "考虑一个基于共同演化的地理镶嵌理论框架的简化捕食者-猎物系统模型。一个猎物物种栖息于两个不同的斑块：一个大陆上的大型“冷点”和一个岛屿上的小型“热点”。在冷点中，不存在捕食者；而在热点中，捕食者存在并主动捕食猎物。\n\n猎物抵抗捕食的防御能力由一个具有两个等位基因的单一基因座控制：一个显性等位基因 `D` 提供完全的防御，一个隐性等位基因 `S` 使猎物易受攻击。在没有捕食者的冷点中，自然选择不利于有代价的防御等位基因，经过演化时间，`S` 等位基因已被固定。因此，冷点种群中 `D` 等位基因的频率为零。\n\n在热点中，猎物个体的适合度取决于其基因型，具体如下：\n- 携带至少一个 `D` 等位基因的个体（基因型为 `DD` 或 `DS`）得到完全防御，但为维持防御机制需支付一个适合度代价 `c`。其适合度为 `w_D = 1 - c`。\n- 易感个体（基因型为 `SS`）不支付此代价，但它们会遭受捕食。捕食强度是频率依赖的；捕食者在捕猎更常见的猎物类型时效率更高。易感个体的适合度为 `w_S = 1 - s_p f_S`，其中 `s_p` 是由捕食引起的最大选择系数（当易感者是唯一的猎物类型时），`f_S` 是热点猎物种群中 `S` 等位基因的频率。\n\n热点是一个种群汇，它从冷点接收持续的、单向的迁入流。每一代，热点种群中比例为 `m` 的部分会被来自冷点的个体所取代。热点内的生活史分两步进行：首先，基于上述定义的适合度值发生自然选择；其次，发生迁移。\n\n设 `p_H` 为热点中 `D` 等位基因的频率。在一个世代内，由选择引起的等位基因频率变化可以用标准的群体遗传学方程建模：\n$$ \\Delta p_{H, \\text{sel}} = \\frac{p_H(1-p_H)(w_D - w_S)}{\\bar{w}_H} $$\n其中 `\\bar{w}_H` 是热点种群的平均适合度。选择之后，迁移会更新等位基因频率。\n\n假设在选择和基因流的共同压力下，热点种群达到了一个稳定的、非平凡的 (`p_H > 0`) 平衡等位基因频率，请为此平衡状态下猎物种群的平均适合度 `\\bar{w}_H` 推导一个闭式解析表达式。你的表达式应只用防御代价 `c` 和迁移率 `m` 来表示。", "solution": "设 $p \\equiv p_{H}$ 表示在一个世代开始时（选择前）热点中等位基因 $D$ 的频率。在热点中，有防御能力的携带者的适合度为 $w_{D} = 1 - c$，易感个体（基因型SS）的适合度为 $w_{S} = 1 - s_{p} f_{S} = 1 - s_{p}(1 - p)$（根据题意，$f_S = 1-p$）。在给定的选择模型下，热点内部因选择引起的等位基因频率变化为\n$$\n\\Delta p_{\\text{sel}} = \\frac{p(1 - p)\\left(w_{D} - w_{S}\\right)}{\\bar{w}_{H}} = \\frac{p(1 - p)\\left((1-c) - (1 - s_{p}(1 - p))\\right)}{\\bar{w}_{H}} = \\frac{p(1 - p)\\left(-c + s_{p}(1 - p)\\right)}{\\bar{w}_{H}}.\n$$\n选择之后，发生迁移。迁移将热点种群中比例为 $m$ 的部分替换为来自冷点（其 $p=0$）的迁入者。因此，迁移后的等位基因频率 $p'$ 为：\n$$\np' = (1 - m)\\left(p + \\Delta p_{\\text{sel}}\\right) + m \\cdot 0 = (1-m)(p + \\Delta p_{\\text{sel}}).\n$$\n在 $p>0$ 的稳定平衡点，我们有 $p' = p$，这意味着\n$$\np = (1 - m)\\left(p + \\Delta p_{\\text{sel}}\\right) \\quad \\Longrightarrow \\quad \\Delta p_{\\text{sel}} = \\frac{m}{1 - m}\\,p.\n$$\n将此式与选择表达式相等，并因 $p>0$ 而消去 $p$，得到\n$$\n\\frac{(1 - p)\\left(-c + s_{p}(1 - p)\\right)}{\\bar{w}_{H}} = \\frac{m}{1 - m},\n$$\n从而\n$$\n\\bar{w}_{H} = (1 - p)\\left(-c + s_{p}(1 - p)\\right)\\frac{1 - m}{m}.\n$$\n另外，热点种群的平均适合度由各基因型频率及其适合度决定：\n$$\n\\bar{w}_{H} = f(DD,DS)w_D + f(SS)w_S = (1 - (1-p)^2)(1-c) + (1-p)^2(1-s_p(1-p)).\n$$\n这是一个复杂的表达式。然而，我们可以使用一个更简单的、基于等位基因边际适合度的平均值（这与问题中给出的$\\Delta p_{\\text{sel}}$模型一致）:\n$$\n\\bar{w}_{H} = p_{\\text{D-pheno}} \\cdot w_D + (1-p_{\\text{S-pheno}}) \\cdot w_S \\approx p \\cdot w_D + (1-p) \\cdot w_S\n$$\n这个简化模型定义了 $\\bar{w}_{H} = p(1 - c) + (1 - p)\\left[1 - s_{p}(1 - p)\\right] = 1 - c p - s_{p}(1 - p)^{2}$。\n设 $x \\equiv 1 - p$。那么关于 $\\bar{w}_{H}$ 的两个表达式变为：\n$$\n\\bar{w}_{H} = x\\left(-c + s_{p}x\\right)\\frac{1 - m}{m} \\quad \\text{和} \\quad \\bar{w}_{H} = 1 - c(1-x) - s_{p}x^{2} = 1 - c + c x - s_{p}x^{2}.\n$$\n令二者相等并化简：\n$$\nx\\left(-c + s_{p}x\\right)(1 - m) = m\\left(1 - c + c x - s_{p}x^{2}\\right)\n$$\n$$\n(-cx + s_px^2)(1-m) = m - mc + mcx - ms_px^2\n$$\n$$\n-cx + s_px^2 + mcx - ms_px^2 = m - mc + mcx - ms_px^2\n$$\n$$\n-cx + s_px^2 = m - mc\n$$\n$$\ns_{p}x^{2} - c x - m(1 - c) = 0.\n$$\n这个二次方程给出了平衡状态下的 $x$ 值。我们可以利用它来简化 $\\bar{w}_{H}$ 的表达式。从方程中，我们得到 $s_{p}x^{2} = c x + m(1 - c)$。将此恒等式代入第二个 $\\bar{w}_{H}$ 的表达式中：\n$$\n\\bar{w}_{H} = 1 - c + c x - s_{p}x^{2} = 1 - c + c x - \\left[c x + m(1 - c)\\right]\n$$\n$$\n\\bar{w}_{H} = 1 - c + c x - c x - m(1 - c) = 1 - c - m + mc\n$$\n$$\n\\bar{w}_{H} = (1 - c)(1 - m).\n$$\n因此，在稳定的、非平凡的平衡点，热点中的平均适合度仅取决于防御代价 $c$ 和迁移率 $m$，并由下式给出：\n$$\n\\bar{w}_{H}^{*} = (1 - m)(1 - c).\n$$", "answer": "$$\\boxed{(1 - m)(1 - c)}$$", "id": "1956481"}]}