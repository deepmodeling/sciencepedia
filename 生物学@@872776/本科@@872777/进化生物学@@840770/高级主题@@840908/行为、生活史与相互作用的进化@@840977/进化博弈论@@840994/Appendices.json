{"hands_on_practices": [{"introduction": "理论是重要的，但真正的理解来自于实践。本章提供了一系列精心设计的练习，旨在将进化博弈论的抽象概念应用于具体的生物学情景。第一个练习将我们带入微生物的世界，探讨合作与背叛之间的基本冲突。在这个关于酵母细胞的假设场景中，我们将学习如何构建一个收益矩阵，并计算进化稳定策略（ESS）下的种群平衡频率，这是进化博弈论中的一项核心技能 [@problem_id:1927021]。", "problem": "在一个巨大且混合均匀的酵母细胞群体中，个体竞争有限的资源包。群体中观察到两种由基因决定的行为策略：“合作者”（Cooperator）和“背叛者”（Defector）。当两个个体遇到一个资源包时，它们的互动和收益（以适应度为单位）由各自的策略决定。资源包的营养价值为 $V$。\n\n互动规则如下：\n- 如果两个合作者相遇，它们会平分资源，没有任何冲突。\n- 如果一个合作者和一个背叛者相遇，合作者会不战而降，将全部资源让给背叛者。\n- 如果两个背叛者相遇，它们会为资源进行一场代价高昂的代谢冲突。这场冲突是对称的，每个个体都有同等机会赢得整个资源包。输家一无所获。在这种相遇中，每个背叛者的期望收益为 $\\frac{V-C}{2}$，其中 $C$ 是与冲突相关的代谢成本。\n\n已知冲突的代谢成本大于资源的价值，即 $C > V > 0$。\n\n假设该系统达到一个演化稳定状态，确定群体中合作者的均衡频率。请用包含 $V$ 和 $C$ 的符号表达式表示你的答案。", "solution": "设 $x$ 表示群体中合作者（C）的均衡频率；因此背叛者（D）的频率为 $1-x$。\n\n根据互动规则：\n- C vs. C：每个获得 $V/2$。\n- C vs. D：C 获得 $0$，D 获得 $V$。\n- D vs. D：每个获得 $(V-C)/2$。\n\n合作者的期望收益是其与不同类型对手相遇的概率加权平均值：\n$$\nE_{C} = x \\cdot \\frac{V}{2} + (1-x) \\cdot 0 = \\frac{xV}{2}\n$$\n背叛者的期望收益是：\n$$\nE_{D} = x \\cdot V + (1-x) \\cdot \\frac{V-C}{2}\n$$\n\n在一个两种策略都存在的混合策略演化稳定状态中，它们的期望收益必须相等：\n$$\nE_{C} = E_{D}\n$$\n代入 $E_{C}$ 和 $E_{D}$ 的表达式可得\n$$\n\\frac{xV}{2} = xV + (1-x)\\frac{V-C}{2}\n$$\n两边同乘以 $2$，\n$$\nxV = 2xV + (1-x)(V-C)\n$$\n整理得，\n$$\nxV - 2xV = (1-x)(V-C)\n\\quad \\Longrightarrow \\quad\n- xV = (1-x)(V-C)\n$$\n将所有项移到一边，\n$$\n(1-x)(V-C) + xV = 0\n$$\n展开并合并含 $x$ 的项，\n$$\n(V-C) - x(V-C) + xV = 0\n\\quad \\Longrightarrow \\quad\n(V-C) + x\\big(- (V-C) + V\\big) = 0\n$$\n由于 $- (V-C) + V = C$，这可以简化为\n$$\n(V-C) + xC = 0\n\\quad \\Longrightarrow \\quad\nxC = C - V\n\\quad \\Longrightarrow \\quad\nx = 1 - \\frac{V}{C}\n$$\n\n已知 $C > V > 0$，这导致 $0 < x < 1$，所以这是一个内部混合状态的均衡。因此，合作者的演化稳定频率是 $1 - \\frac{V}{C}$。", "answer": "$$\\boxed{1 - \\frac{V}{C}}$$", "id": "1927021"}, {"introduction": "生物个体间的相互作用并非总是发生在陌生个体之间，亲缘关系在进化中扮演着至关重要的角色。下一个练习将博弈论与亲缘选择理论相结合，探讨了同类相食这一看似矛盾的行为。通过分析在一个有亲缘关系的幼体种群中“同类相食”策略的进化，你将运用汉密尔顿法则来确定一个行为得以演化的临界条件 [@problem_id:1927008]。这个练习旨在阐明，当博弈的参与者是亲属时，我们如何将基因的视角——即内含适应性——纳入考量。", "problem": "在某些于临时性池塘中发育的两栖动物幼体物种中，食物短缺可能导致同类相食。我们可以使用博弈论来模拟这种行为的演化。考虑一个大型幼体种群，其中存在两种截然不同、由基因决定的觅食策略：“同类相食者”和“和平主义者”。\n\n个体的成功取决于其自身策略以及与之互动的幼体的策略。我们可以将适应度收益定义为相对于一个零基准，该基准代表一个“和平主义”觅食者与另一个“和平主义”觅食者互动时的适应度。互动定义如下：\n\n-   当一个“和平主义”幼体与另一个“和平主义”幼体互动时，它们的互动收益为0。\n-   当一个“同类相食者”幼体与一个“和平主义”幼体互动时，“同类相食者”从这顿饭中获得适应度收益 $b$，“和平主义”幼体被吃掉，承担适应度成本 $c$。因此，“同类相食者”的收益为 $b$，“和平主义者”的收益为 $-c$。\n-   当两个“同类相食者”幼体互动时，它们会战斗。每个都有50%的几率获胜（并吃掉对方），以及50%的几率失败（并被对方吃掉）。在这种相遇中，每个“同类相食者”的期望收益为 $\\frac{b-c}{2}$。\n\n假设池塘中的幼体之间存在亲缘关系，并且两个随机互动的个体之间的平均亲缘系数为 $r$。在一个完全由“和平主义”觅食者组成的种群中，通过突变出现了一个罕见的“同类相食者”等位基因。为了使这种“同类相食者”策略受到亲缘选择的青睐并增加其频率，收益与成本的比率 $\\frac{b}{c}$ 必须超过一个临界阈值。\n\n确定这个比率 $\\frac{b}{c}$ 的临界阈值。你的答案应该是一个用给定参数表示的表达式。", "solution": "我们使用汉密尔顿法则来应用亲缘选择。对于一个罕见的突变体，其几乎所有的互动都是与使用“和平主义”策略的原有群体成员进行的，因此我们将一个“同类相食者”对一个“和平主义者”行动的广义适应度与基准的“和平主义者”-“和平主义者”互动（双方收益均为零）进行比较。\n\n设行动者为“同类相食者”，接受者为“和平主义”对手。相对于基准，对行动者适应度的直接影响是收益 $b$。对接受者适应度的影响是损失 $c$。考虑到行动者和接受者之间的亲缘度为 $r$，该行为引起的广义适应度变化为\n$$\n\\Delta W = b + r(-c) = b - rc\n$$\n根据汉密尔顿法则，当 $\\Delta W > 0$ 时，突变的“同类相食者”策略会受到青睐并增加，即\n$$\nb - rc > 0 \\quad \\Longleftrightarrow \\quad \\frac{b}{c} > r\n$$\n因此，$\\frac{b}{c}$ 的临界阈值是 $r$。", "answer": "$$\\boxed{r}$$", "id": "1927008"}, {"introduction": "最后，我们将把抽象的策略与它们在真实种群中的遗传基础联系起来。行为策略通常由基因决定，它们的命运也遵循群体遗传学的规律。这个具有挑战性的综合练习将“鹰-鸽博弈”模型扩展到一个包含三种策略（鹰、鸽、评估者）的二倍体种群中，其中每种策略都由特定的基因型决定 [@problem_id:1926979]。你需要将哈迪-温伯格平衡原理与博弈论的收益计算相结合，来确定等位基因频率的稳定平衡点。通过这个练习，你将深入理解行为的进化是如何在基因层面展开的，从而将博弈论与群体遗传学融会贯通。", "problem": "在一个大的、随机交配的二倍体种群中，个体在成对资源竞争中采用的策略由一个具有两个等位基因 $A_H$ 和 $A_D$ 的单一基因座决定。假设在每一代开始时，种群处于哈迪-温伯格平衡状态。三种可能的基因型对应三种不同的行为策略：\n-   基因型为 $A_H A_H$ 的个体采用“鹰”策略，总是将冲突升级为战斗。\n-   基因型为 $A_D A_D$ 的个体采用“鸽”策略，从不升级冲突。\n-   杂合子个体 ($A_H A_D$) 采用“评估者”策略。\n\n竞争是为了价值为 $V$ 的资源。两只鹰之间的战斗导致一个个体赢得资源，另一个则遭受成本为 $C > V$ 的伤害；因此，鹰与鹰相遇的平均收益为 $(V-C)/2$。当鸽与鸽相遇时，它们共享资源，每个获得 $V/2$ 的收益。在鹰与鸽的任何混合竞争中，鸽立即撤退，获得收益0，而鹰获得全部资源 $V$。\n\n评估者的行为是有条件的。当评估者遇到鸽时，它的行为像鹰，获得资源 $V$。当评估者遇到鹰时，它会识别到危险并撤退，获得收益0。当两个评估者相遇时，它们会进行一场成本为 $d$ 的无害展示来解决争端，之后一个撤退，另一个获得资源；因此平均收益为 $V/2 - d$。\n\n每个基因型的适应度由一个基准适应度分量加上这些竞争的平均收益决定。种群可以稳定在一个多态性平衡状态，其中等位基因 $A_H$ 和 $A_D$ 都被保留下来。种群中杂合的评估者个体的比例在 $A_H$ 等位基因的特定频率下达到最大值。\n\n假设展示成本 $d$ 可以忽略不计 ($d=0$)，确定比率 $C/V$ 的精确值，该值将导致系统的稳定多态性平衡恰好出现在使种群中评估者比例最大化的等位基因频率上。", "solution": "设 $p$ 为等位基因 $A_H$ 的频率，$q=1-p$ 为等位基因 $A_D$ 的频率。在随机交配和哈迪-温伯格平衡的假设下，三种基因型的频率（也即三种策略的频率）为：\n-   鹰的频率 ($x_H$)：$p^2$\n-   评估者的频率 ($x_A$)：$2pq = 2p(1-p)$\n-   鸽的频率 ($x_D$)：$q^2 = (1-p)^2$\n\n问题要求一个与评估者频率最大化相关的条件。评估者的频率由 $f(p) = 2p(1-p) = 2p - 2p^2$ 给出。为了求最大值，我们对 $p$ 求导并令其为零：\n$$ \\frac{df}{dp} = 2 - 4p = 0 \\implies p = \\frac{1}{2} $$\n因此，当等位基因频率为 $p=q=0.5$ 时，种群中评估者的比例最大化。所以，问题要求的是使稳定平衡点出现在 $p=0.5$ 处的 $C/V$ 的值。\n\n接下来，我们确定每种策略的适应度。一个个体采用某种策略的适应度是其与种群中所有可能对手相遇的平均收益。设 $E_H, E_A, E_D$ 分别为鹰、评估者和鸽策略的平均收益。\n\n一个个体采用策略 $S_i$ 对抗采用策略 $S_j$ 的对手的收益由以下收益矩阵给出：\n-   鹰 (对 鹰, 评估者, 鸽): $(\\frac{V-C}{2}, V, V)$\n-   评估者 (对 鹰, 评估者, 鸽): $(0, \\frac{V}{2}-d, V)$\n-   鸽 (对 鹰, 评估者, 鸽): $(0, 0, \\frac{V}{2})$\n\n每种策略的平均收益是其对抗所有对手收益的加权平均，权重为对手的频率。当 $d=0$ 时：\n$$ E_H = x_H \\left(\\frac{V-C}{2}\\right) + x_A V + x_D V = p^2 \\left(\\frac{V-C}{2}\\right) + 2p(1-p)V + (1-p)^2 V $$\n$$ E_A = x_H (0) + x_A \\left(\\frac{V}{2}\\right) + x_D V = 2p(1-p)\\frac{V}{2} + (1-p)^2 V $$\n$$ E_D = x_H (0) + x_A (0) + x_D \\left(\\frac{V}{2}\\right) = (1-p)^2 \\frac{V}{2} $$\n\n每个基因型的适应度被视为与其所表达策略的收益成正比。设 $W_{HH}$、$W_{AD}$、$W_{DD}$ 分别为基因型 $A_H A_H$、$A_H A_D$ 和 $A_D A_D$ 的适应度。我们有 $W_{HH} \\propto E_H$，$W_{AD} \\propto E_A$ 和 $W_{DD} \\propto E_D$。不失一般性，我们可以将基准适应度设为零，因此 $W_{HH} = E_H$，$W_{AD} = E_A$，$W_{DD} = E_D$。\n\n当两个等位基因的边际适应度 $W_{A_H}$ 和 $W_{A_D}$ 相等时，出现多态性平衡（$0 < p < 1$）。\n一个等位基因的边际适应度是携带该基因的基因型的平均适应度，按其在该等位基因携带者中的频率加权。\n$$ W_{A_H} = p W_{HH} + q W_{AD} $$\n$$ W_{A_D} = p W_{AD} + q W_{DD} $$\n平衡条件 $W_{A_H} = W_{A_D}$ 变为：\n$$ p W_{HH} + q W_{AD} = p W_{AD} + q W_{DD} $$\n$$ p E_H + (1-p) E_A = p E_A + (1-p) E_D $$\n我们在寻找使此平衡点位于 $p=0.5$ 的条件。将 $p=0.5$（因此 $q=1-p=0.5$）代入平衡方程：\n$$ 0.5 E_H + 0.5 E_A = 0.5 E_A + 0.5 E_D $$\n这可以简化为：\n$$ E_H = E_D $$\n这个关键的洞见意味着，要在 $p=0.5$ 处存在一个平衡，鹰的适应度必须等于一个 $p=0.5$ 的种群中鸽的适应度。\n\n现在，我们计算在 $p=0.5$ 时的 $E_H$ 和 $E_D$。\n在 $p=0.5$ 时，策略频率为：\n-   $x_H = p^2 = (0.5)^2 = 0.25$\n-   $x_A = 2p(1-p) = 2(0.5)(0.5) = 0.5$\n-   $x_D = (1-p)^2 = (0.5)^2 = 0.25$\n\n此时鹰的平均收益是：\n$$ E_H(p=0.5) = (0.25)\\left(\\frac{V-C}{2}\\right) + (0.5)V + (0.25)V = \\frac{V-C}{8} + 0.75V = \\frac{V-C+6V}{8} = \\frac{7V-C}{8} $$\n此时鸽的平均收益是：\n$$ E_D(p=0.5) = (0.25)(0) + (0.5)(0) + (0.25)\\left(\\frac{V}{2}\\right) = \\frac{V}{8} $$\n令 $E_H(p=0.5) = E_D(p=0.5)$：\n$$ \\frac{7V-C}{8} = \\frac{V}{8} $$\n$$ 7V - C = V $$\n$$ 6V = C $$\n两边除以 $V$ 得到所需比率：\n$$ \\frac{C}{V} = 6 $$\n这个平衡是稳定的。我们可以通过检查边界处的入侵条件来验证这一点。如果 $C=6V$，那么 $C>V$。在一个纯鹰种群（$p=1$）中，突变评估者的收益是 $E_A(p=1)=0$，而原住鹰的收益是 $E_H(p=1)=(V-C)/2 = (V-6V)/2 = -5V/2 < 0$。因此 $E_A>E_H$，等位基因 $A_D$ 入侵成功。在一个纯鸽种群（$p=0$）中，突变评估者的收益是 $E_A(p=0)=V$，而原住鸽的收益是 $E_D(p=0)=V/2$。由于 $E_A>E_D$，等位基因 $A_H$ 入侵成功。由于两个边界平衡都是不稳定的，系统必须收敛到 $p=0.5$ 的内部平衡点。", "answer": "$$\\boxed{6}$$", "id": "1926979"}]}