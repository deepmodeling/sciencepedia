{"hands_on_practices": [{"introduction": "研究纬度多样性梯度的第一步是能够量化生物多样性。本练习将介绍一个广泛使用的指标——辛普森多样性指数，该指数同时考虑了物种数量（丰富度）和物种的相对丰度（均匀度）。通过将此指数应用于假设的热带和温带森林数据，你将亲手实践如何计算生物多样性，并理解其数值在生态学背景下的具体含义 [@problem_id:1943649]。", "problem": "一位生态学家正在通过比较两个不同森林生态系统的树木物种组成，来研究纬度多样性梯度。第一个地点是哥斯达黎加的热带雨林，第二个是北美的温带落叶林。在每个生态系统内，生态学家对多个样地进行了调查，并汇总了所观察到的每个树种的个体总数。\n\n两个地点的汇总数据如下：\n\n**地点A：热带雨林**\n- 物种1：15个个体\n- 物种2：12个个体\n- 物种3：18个个体\n- 物种4：10个个体\n- 物种5：14个个体\n- 物种6：9个个体\n- 物种7：16个个体\n- 物种8：11个个体\n- 物种9：13个个体\n- 物种10：20个个体\n\n**地点B：温带落叶林**\n- 物种1：85个个体\n- 物种2：40个个体\n- 物种3：10个个体\n- 物种4：5个个体\n\n为了量化和比较生物多样性，生态学家使用了辛普森多样性指数。该指数定义为 $1 - D$，其中 $D$ 是辛普森优势度指数，由公式 $D = \\sum_{i=1}^{S} \\left(\\frac{n_i}{N}\\right)^2$ 给出。在此公式中，$S$ 是一个地点的物种总数，$n_i$ 是第 $i$ 个物种的个体数量，而 $N$ 是该地点所有物种的个体总数。\n\n计算热带雨林地点（地点A）的辛普森多样性指数与温带落叶林地点（地点B）的辛普森多样性指数的比率。将您的最终答案四舍五入至三位有效数字。", "solution": "我们使用辛普森多样性指数，其定义为 $1 - D$，其中 $D = \\sum_{i=1}^{S} \\left(\\frac{n_{i}}{N}\\right)^{2}$，$N$ 是该地点的个体总数，$n_{i}$ 是物种 $i$ 的数量。\n\n对于地点A（热带雨林），个体总数为\n$$\nN_{A} = 15+12+18+10+14+9+16+11+13+20 = 138.\n$$\n计算数量的平方和：\n$$\n\\sum n_{i}^{2} = 15^{2}+12^{2}+18^{2}+10^{2}+14^{2}+9^{2}+16^{2}+11^{2}+13^{2}+20^{2} = 2016.\n$$\n因此，\n$$\nD_{A} = \\frac{\\sum n_{i}^{2}}{N_{A}^{2}} = \\frac{2016}{138^{2}} = \\frac{2016}{19044} = \\frac{56}{529},\n$$\n而辛普森多样性指数为\n$$\n\\text{SID}_{A} = 1 - D_{A} = 1 - \\frac{56}{529} = \\frac{473}{529}.\n$$\n\n对于地点B（温带落叶林），个体总数为\n$$\nN_{B} = 85+40+10+5 = 140.\n$$\n计算数量的平方和：\n$$\n\\sum n_{i}^{2} = 85^{2}+40^{2}+10^{2}+5^{2} = 8950.\n$$\n因此，\n$$\nD_{B} = \\frac{\\sum n_{i}^{2}}{N_{B}^{2}} = \\frac{8950}{140^{2}} = \\frac{8950}{19600} = \\frac{179}{392},\n$$\n而辛普森多样性指数为\n$$\n\\text{SID}_{B} = 1 - D_{B} = 1 - \\frac{179}{392} = \\frac{213}{392}.\n$$\n\n所要求的地点A与地点B的辛普森多样性指数之比为\n$$\nR = \\frac{\\text{SID}_{A}}{\\text{SID}_{B}} = \\frac{\\frac{473}{529}}{\\frac{213}{392}} = \\frac{473 \\times 392}{529 \\times 213} = \\frac{185416}{112677}.\n$$\n计算该分数值得到\n$$\nR \\approx 1.645706\\ldots\n$$\n四舍五入至三位有效数字，\n$$\nR \\approx 1.65.\n$$", "answer": "$$\\boxed{1.65}$$", "id": "1943649"}, {"introduction": "除了描述纬度多样性梯度这一现象，科学家们还致力于探究其演化起源。一个重要的假说认为，热带地区拥有更高的物种形成速率，是“物种演化的摇篮”。本练习将展示如何利用带有时间尺度的分子系统发育树，来检验关于宏观演化速率的假说 [@problem_id:1943673]。通过计算并比较一个热带支系和一个温带支系的净物种多样化速率，你将学习到一种从现存物种数据推断长期演化动态的基本方法。", "problem": "一位演化生物学家正在研究一个假想植物科 Floribundaceae 内部的纬度多样性梯度。该科的带有年代标定的分子系统发育树已经构建完成，并且所有现存物种的地理分布范围也已确定。该科由两个主要的姐妹分支组成：一个“温带分支”，其成员物种仅限于温带地区；以及一个“热带分支”，其成员物种仅发现于热带地区。\n\n为检验热带地区多样化速率更高的假说，该生物学家使用一个简单的矩量法估计量来计算净多样化速率（$r$），即物种形成速率减去物种灭绝速率。该速率使用以下公式计算：\n$$r = \\frac{\\ln(N)}{t}$$\n其中，$N$ 是一个分支中现存物种的数量，$t$ 是该分支冠群的年龄（从现在回到该分支所有现存成员的最近共同祖先的时间）。\n\n系统发育分析提供了以下数据：\n- 温带分支包含4个现存物种，其冠群年龄为1500万年。\n- 热带分支包含12个现存物种，其冠群年龄为2000万年。\n\n根据这些信息，计算热带分支与温带分支的净多样化速率之比（$r_{tropical} / r_{temperate}$）。请将最终答案以四舍五入到三位有效数字的数值形式报告。", "solution": "净多样化速率的矩量法估计量由下式给出\n$$\nr=\\frac{\\ln(N)}{t}.\n$$\n对于热带分支，当 $N_{tropical}=12$ 且 $t_{tropical}=20.0$ 时，估计的速率为\n$$\nr_{tropical}=\\frac{\\ln(12)}{20}.\n$$\n对于温带分支，当 $N_{temperate}=4$ 且 $t_{temperate}=15.0$ 时，估计的速率为\n$$\nr_{temperate}=\\frac{\\ln(4)}{15}.\n$$\n所求的比率为\n$$\n\\frac{r_{tropical}}{r_{temperate}}=\\frac{\\frac{\\ln(12)}{20}}{\\frac{\\ln(4)}{15}}=\\frac{15}{20}\\cdot\\frac{\\ln(12)}{\\ln(4)}=\\frac{3}{4}\\cdot\\frac{\\ln(12)}{\\ln(4)}.\n$$\n使用 $\\ln(12)=\\ln(3\\cdot 4)=\\ln(3)+\\ln(4)$，上式变为\n$$\n\\frac{r_{tropical}}{r_{temperate}}=\\frac{3}{4}\\left(1+\\frac{\\ln(3)}{\\ln(4)}\\right).\n$$\n数值上，\n$$\n\\ln(3)\\approx 1.098612289,\\quad \\ln(4)\\approx 1.386294361,\n$$\n因此\n$$\n\\frac{\\ln(3)}{\\ln(4)}\\approx 0.79248,\\quad 1+\\frac{\\ln(3)}{\\ln(4)}\\approx 1.79248,\n$$\n并且\n$$\n\\frac{r_{tropical}}{r_{temperate}}\\approx \\frac{3}{4}\\times 1.79248\\approx 1.34436.\n$$\n四舍五入到三位有效数字，得到 $1.34$。", "answer": "$$\\boxed{1.34}$$", "id": "1943673"}, {"introduction": "对纬度多样性梯度的生态学解释常常涉及气候因素，但这些因素（如温度和降水）之间往往存在相关性，这使得区分它们的独立影响变得十分困难。这项进阶练习将介绍偏相关分析，这是一种在统计学上 disentangle（解开）多个相互作用变量之间关系的有效方法。通过计算在统计上控制了降水量的影响之后，物种丰富度与温度之间的相关性，你将掌握一项关键的分析技能，从而能够从简单的相关性分析迈向对复杂生态系统中因果关系的更精细理解 [@problem_id:2584997]。", "problem": "在一项对横跨热带至温带纬度的 $n$ 个生态区中脊椎动物和被子植物物种丰富度的全球比较分析中，研究人员通过量化物种丰富度与气候的协变关系来评估纬度多样性梯度。令 $R$ 表示对数转换后的物种丰富度，$T$ 表示年平均温度，$P$ 表示年平均降水量。根据广泛的生态观测可知，物种丰富度倾向于向赤道方向增加，那里的气候通常更温暖、更湿润，但温度和降水量可能存在协变，这使得因果解释变得复杂。\n\n为了在排除 $P$ 的影响后，单独研究 $R$ 和 $T$ 之间的关联，研究人员需要计算在控制了 $P$ 的情况下 $R$ 和 $T$ 之间的偏相关。他们从数据集中估计出以下样本皮尔逊相关系数：$r_{RT} = 0.72$，$r_{RP} = 0.65$ 和 $r_{TP} = 0.40$。\n\n从偏相关的定义出发，即偏相关是每个焦点变量对控制变量进行线性回归后的残差之间的相关性，并仅使用皮尔逊相关和线性回归的基本性质，计算在控制 $P$ 的情况下 $R$ 和 $T$ 之间的偏相关。将您的答案四舍五入到三位有效数字。", "solution": "所述问题具有科学依据，提法恰当且客观。它提供了计算一个明确定义的统计量（偏相关系数）所需的所有数据，并要求从第一性原理进行推导。参数值在所述的生态学背景下是符合实际的。因此，该问题是有效的，我将着手解决。\n\n目标是计算在控制年平均降水量 ($P$) 的情况下，对数转换后的物种丰富度 ($R$) 与年平均温度 ($T$) 之间的偏相关。这个量记为 $r_{RT \\cdot P}$，定义为 $R$ 和 $T$ 各自对 $P$ 进行线性回归后所得残差之间的皮尔逊相关。\n\n设变量 $R$、$T$ 和 $P$ 由随机变量表示。为使推导清晰，我们可以不失一般性地假设这些变量已被标准化，均值为 $0$，方差为 $1$。任意两个此类标准化变量（例如 $X$ 和 $Y$）之间的皮尔逊相关系数简化为 $r_{XY} = E[XY]$，它们的方差为 $E[X^2] = 1$。这个初始假设不影响偏相关的最终公式，因为该公式与原始变量的均值和方差无关。\n\n首先，我们进行 $R$ 对 $P$ 和 $T$ 对 $P$ 的简单线性回归。\n$R$ 对 $P$ 回归的线性模型是 $R = \\beta_{RP} P + \\epsilon_R$，其中 $\\epsilon_R$ 是残差。对于标准化变量，斜率 $\\beta_{RP}$ 的普通最小二乘估计等于相关系数，因此 $\\beta_{RP} = r_{RP}$。$R$ 的残差因此为：\n$$ \\epsilon_R = R - r_{RP} P $$\n类似地，对于 $T$ 对 $P$ 的回归，我们有 $T = \\beta_{TP} P + \\epsilon_T$，其中 $\\beta_{TP} = r_{TP}$。$T$ 的残差为：\n$$ \\epsilon_T = T - r_{TP} P $$\n偏相关 $r_{RT \\cdot P}$ 是这两个残差 $\\epsilon_R$ 和 $\\epsilon_T$ 之间的相关性。\n$$ r_{RT \\cdot P} = \\text{Corr}(\\epsilon_R, \\epsilon_T) = \\frac{\\text{Cov}(\\epsilon_R, \\epsilon_T)}{\\sqrt{\\text{Var}(\\epsilon_R) \\text{Var}(\\epsilon_T)}} $$\n现在我们必须推导协方差项和方差项的表达式。\n\n残差的期望值为 $E[\\epsilon_R] = E[R - r_{RP} P] = E[R] - r_{RP} E[P] = 0 - r_{RP} \\cdot 0 = 0$。类似地，$E[\\epsilon_T] = 0$。\n\n分子中的协方差项是：\n$$ \\text{Cov}(\\epsilon_R, \\epsilon_T) = E[(\\epsilon_R - E[\\epsilon_R])(\\epsilon_T - E[\\epsilon_T])] = E[\\epsilon_R \\epsilon_T] $$\n代入残差的表达式：\n$$ E[(R - r_{RP} P)(T - r_{TP} P)] = E[RT - r_{TP} R P - r_{RP} P T + r_{RP} r_{TP} P^2] $$\n根据期望的线性性质：\n$$ E[RT] - r_{TP} E[RP] - r_{RP} E[PT] + r_{RP} r_{TP} E[P^2] $$\n对于标准化变量，$E[RT] = r_{RT}$，$E[RP] = r_{RP}$，$E[PT] = r_{TP}$，且 $E[P^2] = \\text{Var}(P) = 1$。\n代入这些恒等式：\n$$ \\text{Cov}(\\epsilon_R, \\epsilon_T) = r_{RT} - r_{TP} r_{RP} - r_{RP} r_{TP} + r_{RP} r_{TP} (1) = r_{RT} - r_{RP} r_{TP} $$\n接下来，我们推导分母中的方差项。由于残差的均值为零，方差是其平方的期望。\n$$ \\text{Var}(\\epsilon_R) = E[\\epsilon_R^2] = E[(R - r_{RP} P)^2] = E[R^2 - 2 r_{RP} RP + r_{RP}^2 P^2] $$\n$$ = E[R^2] - 2 r_{RP} E[RP] + r_{RP}^2 E[P^2] $$\n对于标准化变量，$E[R^2] = 1$，$E[RP] = r_{RP}$，且 $E[P^2] = 1$。\n$$ \\text{Var}(\\epsilon_R) = 1 - 2 r_{RP} (r_{RP}) + r_{RP}^2 (1) = 1 - 2 r_{RP}^2 + r_{RP}^2 = 1 - r_{RP}^2 $$\n根据对称性，另一个残差的方差为：\n$$ \\text{Var}(\\epsilon_T) = 1 - r_{TP}^2 $$\n现在我们组合成偏相关系数的完整公式：\n$$ r_{RT \\cdot P} = \\frac{r_{RT} - r_{RP} r_{TP}}{\\sqrt{(1 - r_{RP}^2)(1 - r_{TP}^2)}} $$\n问题提供了以下样本相关系数：\n$r_{RT} = 0.72$\n$r_{RP} = 0.65$\n$r_{TP} = 0.40$\n\n我们将这些值代入推导出的公式中。\n分子是：\n$$ 0.72 - (0.65)(0.40) = 0.72 - 0.26 = 0.46 $$\n分母是：\n$$ \\sqrt{(1 - 0.65^2)(1 - 0.40^2)} = \\sqrt{(1 - 0.4225)(1 - 0.16)} = \\sqrt{(0.5775)(0.84)} $$\n$$ = \\sqrt{0.4851} \\approx 0.6964912 $$\n偏相关是分子与分母的比值：\n$$ r_{RT \\cdot P} = \\frac{0.46}{0.6964912} \\approx 0.6603808 $$\n问题要求将答案四舍五入到三位有效数字。\n$$ r_{RT \\cdot P} \\approx 0.660 $$\n这个结果表示在从物种丰富度和温度两个变量中移除了降水量的线性效应后，它们之间的相关性。", "answer": "$$\\boxed{0.660}$$", "id": "2584997"}]}