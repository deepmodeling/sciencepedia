{"hands_on_practices": [{"introduction": "掌握单系群、并系群和多系群的定义的最好方法，是从最核心的概念——单系群（或演化支）——开始。这个练习将生物学的叙事背景剥离，让我们可以专注于系统发育树的拓扑结构本身。通过直接解读用于表示演化树的标准语言“纽域克格式”(Newick format)，你将练习如何应用单系群的严格定义，即包含一个最近共同祖先及其所有后代。[@problem_id:2810418] 这项基本功是准确识别自然演化单元的关键。", "problem": "一个包含五个分类单元的有根、完全二分的系统发育树由 Newick 字符串 \"(((A,B),C),(D,E));\" 编码。将其解释为一棵单独的有根树，其中最外层的分组定义了根分裂。使用基于最近共同祖先 (MRCA) 和后代包含关系的常规定义，对此树的集合 $ \\{A,B,C\\} $ 进行分类，并选择其理由与第一性原理最一致的选项。选择一项：\n\nA. 单系群；$\\mathrm{MRCA}(\\{A,B,C\\})$ 在此有根树上的后代恰好是 $ \\{A,B,C\\} $，因此该群包含了其 MRCA 的所有后代。\n\nB. 并系群；$\\mathrm{MRCA}(\\{A,B,C\\})$ 是根节点，而该群排除了该祖先的后代 $D$ 和 $E$。\n\nC. 复系群；分类单元 $A$ 和 $B$ 共享一个不包含 $C$ 的祖先，因此形成 $ \\{A,B,C\\} $ 需要合并缺少共同祖先的谱系。\n\nD. 无法确定；没有外群来确定树的根，无法评估单系性，且此表示是无根的。", "solution": "首先必须评估问题陈述的有效性。\n\n**第一步：提取已知条件**\n- 问题描述了一个包含 $5$ 个分类单元的系统发育树，标记为 $A$、$B$、$C$、$D$ 和 $E$。\n- 该系统发育树被说明是“有根的”和“完全二分的”。\n- 拓扑结构由 Newick 字符串给出：`(((A,B),C),(D,E));`。\n- 根的位置由规则指定：“最外层的分组定义了根分裂”。\n- 任务是根据单系群、并系群和复系群的常规定义，对分类单元集合 $ \\{A,B,C\\} $ 进行分类，这些定义基于最近共同祖先 (MRCA) 和后代包含关系。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：问题采用了系统发育系统学的基本概念，包括 Newick 表示法、有根树以及单系群、并系群和复系群的定义。这些是进化生物学中标准且公认的原则。该问题在科学上是合理的。\n- **适定性**：Newick 字符串 `(((A,B),C),(D,E));` 提供了对树拓扑的明确描述。关于树是“有根的”以及“最外层的分组定义了根分裂”的陈述消除了关于根位置的任何歧义。根据所提供的信息和标准定义，对特定集合 $ \\{A,B,C\\} $ 进行分类的任务是清晰的，并且有一个唯一的、确定性的解。\n- **客观性和完整性**：问题以精确、客观的语言陈述。它包含了进行逻辑推导所需的所有必要信息。没有信息缺失或相互矛盾。例如，关于树是“有根的”的明确陈述预先排除了任何潜在的歧义。\n\n**第三步：结论与行动**\n问题陈述是有效的。这是一个适定的、有科学依据的问题，可以用系统发育学的第一性原理来解决。我将继续进行解答。\n\n**解答推导**\n首先，必须根据给定的 Newick 字符串 `(((A,B),C),(D,E));` 构建系统发育树。嵌套的括号表示支系。\n1. 最内层的括号 `(A,B)` 表示分类单元 $A$ 和 $B$ 是姐妹分类单元，共享一个直接的共同祖先。我们将此祖先节点称为 $n_1$。\n2. 下一层分组 `((A,B),C)` 表示包含 $ \\{A,B\\} $ 的支系与分类单元 $C$ 是姐妹关系。因此，$A$、$B$ 和 $C$ 的最近共同祖先是 $n_1$ 和 $C$ 的父节点。我们将此祖先节点称为 $n_2$。\n3. 分组 `(D,E)` 表示分类单元 $D$ 和 $E$ 是姐妹分类单元，共享一个直接的共同祖先，我们可以称之为节点 $n_3$。\n4. 最外层的分组 `(((A,B),C),(D,E))` 连接了支系 `((A,B),C)` 和支系 `(D,E)`。根据问题规定，它们的共同祖先是整个树的根。我们将根节点称为 $R$。\n\n最终的树结构如下：\n- 根节点 $R$ 有两个直接后代：节点 $n_2$ 和节点 $n_3$。\n- 节点 $n_2$ 是支系 $ \\{A,B,C\\} $ 的祖先。它的直接后代是节点 $n_1$ 和分类单元 $C$。\n- 节点 $n_1$ 是支系 $ \\{A,B\\} $ 的祖先。它的直接后代是分类单元 $A$ 和分类单元 $B$。\n- 节点 $n_3$ 是支系 $ \\{D,E\\} $ 的祖先。它的直接后代是分类单元 $D$ 和分类单元 $E$。\n\n接下来，我们将系统发育群体的标准定义应用于集合 $S = \\{A,B,C\\}$。\n- **单系群** (clade) 是一个包含一个共同祖先及其所有后代的分类单元集合。要使一个分类单元集合 $S$ 成为单系群，它必须等价于 $\\mathrm{MRCA}(S)$ 的所有末端后代集合，记为 $D(\\mathrm{MRCA}(S))$。因此，我们必须有 $S = D(\\mathrm{MRCA}(S))$。\n- **并系群** 包含一个共同祖先，但排除了其一个或多个后代。因此，$S \\subset D(\\mathrm{MRCA}(S))$。\n- **复系群** 源自两个或多个不同的祖先谱系，并且其成员的最近共同祖先不包括在该群体的定义特征中。\n\n我们来分析集合 $S = \\{A,B,C\\}$：\n1. 确定该群体的最近共同祖先 (MRCA)：$\\mathrm{MRCA}(\\{A,B,C\\})$。根据树结构，$A$ 和 $B$ 的共同祖先是 $n_1$。$\\{A,B\\}$ 和 $C$ 的共同祖先是 $n_2$。因此，$\\mathrm{MRCA}(\\{A,B,C\\}) = n_2$。\n2. 确定此 MRCA 的所有末端后代：$D(n_2)$。以 $n_2$ 为根的子树是 `((A,B),C)`。从 $n_2$ 派生出的末端分类单元（叶节点）恰好是 $A$、$B$ 和 $C$。所以，$D(n_2) = \\{A,B,C\\}$。\n3. 将群体 $S$ 与其 MRCA 的所有后代集合进行比较。我们有 $S = \\{A,B,C\\}$ 和 $D(\\mathrm{MRCA}(S)) = D(n_2) = \\{A,B,C\\}$。由于 $S = D(\\mathrm{MRCA}(S))$，群体 $ \\{A,B,C\\} $ 完全符合**单系群**的定义。\n\n**选项评估**\n\nA. **单系群；$\\mathrm{MRCA}(\\{A,B,C\\})$ 在此有根树上的后代恰好是 $ \\{A,B,C\\} $，因此该群包括其 MRCA 的所有后代。**\n该选项指出该群体是单系群。这与我们的推导相符。理由是该群体的 $\\mathrm{MRCA}$，即节点 $n_2$，其完整的后代集合为 $ \\{A,B,C\\} $。这正是单系性的条件。推理合理且正确。\n结论：**正确**。\n\nB. **并系群；$\\mathrm{MRCA}(\\{A,B,C\\})$ 是根节点，而该群排除了该祖先的后代 $D$ 和 $E$。**\n该选项声称该群体是并系群。这与我们的推导相矛盾。其理由的前提“$\\mathrm{MRCA}(\\{A,B,C\\})$ 是根节点”是错误的。$ \\{A,B,C\\} $ 的最*近*共同祖先是节点 $n_2$，它是根节点 $R$ 的一个后代。根节点 $R$ 是所有五个分类单元 $ \\{A,B,C,D,E\\} $ 的 $\\mathrm{MRCA}$，而不仅仅是 $ \\{A,B,C\\} $ 的。因为前提不正确，整个理由是无效的。\n结论：**不正确**。\n\nC. **复系群；分类单元 $A$ 和 $B$ 共享一个不包含 $C$ 的祖先，因此形成 $ \\{A,B,C\\} $ 需要合并缺少共同祖先的谱系。**\n该选项声称该群体是复系群，这是不正确的。其理由有缺陷。虽然 $A$ 和 $B$ 确实比它们与 $C$ 共享一个更近的祖先 ($n_1$)，但这是支系内层次结构的基础，而不是支持复系性的论据。群体 $ \\{A,B,C\\} $ 是一个支系，因为它包含其自身的 MRCA ($n_2$) 及其所有后代。该理由曲解了复系性的定义，复系性适用于其成员的 MRCA 不被视为该群体一部分的群体，这通常是由于趋同进化。群体 $ \\{A,B,C\\} $ 是一个单一、完整的谱系。\n结论：**不正确**。\n\nD. **无法确定；没有外群来确定树的根，无法评估单系性，且此表示是无根的。**\n该选项声称状态无法确定。这是错误的。其理由称该树是“无根的”。这直接与问题陈述相矛盾，问题陈述明确说明了“一个**有根的**……系统发育树”，并提供了从 Newick 字符串解释根的规则。由于该树的根是明确的，单系性可以并且已经被评估。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2810418"}, {"introduction": "接下来，我们来探讨一个在系统发育学中常见的问题：并系群。当一个类群包含其最近共同祖先，但有意或无意地排除了一部分后代时，它就构成了并系群。这个练习通过一个古生物学的假想场景，生动地展示了新的化石证据如何挑战并修正我们对一个类群的认知，揭示一个曾被认为是单系群的分类单元实际上是并系群。[@problem_id:1948234] 这个案例强调了科学分类是一种可检验的假说，它会随着新发现而不断演进。", "problem": "在古生物学中，生物的分类会随着新的化石证据而频繁更新。考虑一个关于两大类已灭绝节肢动物的假想案例。Megalopteridae科是一个大型、已被充分确立的捕食性类群，其定义依据是一套独特的翅脉模式，并被广泛接受为一个单系群。另一个规模小得多的独立科，Micrognathidae科，仅包含*Petiolus*属，其定义依据是一种独特的、小型化的口器形态。数十年来，基于形态学分析，Micrognathidae科一直被归类为整个Megalopteridae科的姐妹群。\n\n最近，发现了一个新的化石层，其中包含保存异常完好的标本。描述了一个新物种，它具有*Petiolus*属明确、独特的口器形态。然而，它也明确无误地拥有所有定义了Spinicaudinae亚科的共享衍生翅脉模式，而该亚科深嵌于Megalopteridae科的系统发育树内部。这一发现迫使系统发育进行重大修订，表明整个*Petiolus*属（也就是Micrognathidae科）并非一个姐妹群，而实际上是一个从Spinicaudinae亚科内部演化出来的高度特化谱系。\n\n基于这一新证据，Megalopteridae科原有的分组（即在*Petiolus*属被重新分类*之前*所定义的那个类群）现在在分类学上应如何描述？\n\nA. 单系群\nB. 多系群\nC. 并系群\nD. 一个分类阶元\nE. 一个姐妹分类单元", "solution": "我们首先回顾标准的系统发育定义。一个单系群（演化支）包含一个最近的共同祖先及其所有后代。一个并系群包含一个最近的共同祖先，但排除了至少一个后代谱系。一个多系群组合了在该类群内部不共享一个直接共同祖先的分类单元，通常是基于趋同性状组合而成的。一个分类阶元是一个明确的非演化支分组，由相似的组织水平定义，在实践中是一种并系群。一个姐妹分类单元是系统发育树中的一个相对位置，而不是一个类群内部凝聚性的属性。\n\n最初，Micrognathidae科（*Petiolus*属）被置于整个Megalopteridae科的姐妹群位置。在该假说下，Megalopteridae被认为是一个与Micrognathidae相分离的演化支。新的化石表明，*Petiolus*属拥有Spinicaudinae亚科的定义性共源性状，而该亚科深嵌于Megalopteridae科内部。因此，*Petiolus*属（也就是Micrognathidae科）并非位于Megalopteridae科之外，而是源自Megalopteridae科内部的一个后代谱系。\n\n考虑重新分类前Megalopteridae科的原始界定范围。它包含了同样衍生出Spinicaudinae亚科以及（如今已证明的）*Petiolus*属的那个祖先，但它明确排除了*Petiolus*属（该属被作为Micrognathidae科置于其外）。由于*Petiolus*属是该祖先的一个后代谱系，原有的Megalopteridae科因排除了*Petiolus*属，而未能包含其最近共同祖先的所有后代。\n\n根据定义，一个包含最近共同祖先但排除了至少一个后代的类群是并系群。它不是单系群，因为它遗漏了一个后代谱系。它不是多系群，因为所包含的分类单元在该类群内部仍然共享它们的最近共同祖先。虽然人们可以通俗地将这样一个非演化支的组合称为一个分类阶元，但对原分组的精确系统发育诊断是并系群。“姐妹分类单元”描述的不是原始类群的性质，而是演化支之间的相对位置关系。\n\n因此，鉴于新证据，原有的Megalopteridae科（按先前排除*Petiolus*属的定义）必须被描述为并系群。", "answer": "$$\\boxed{C}$$", "id": "1948234"}, {"introduction": "最后，我们来处理最具有迷惑性的一类分组：多系群。这个高级练习将向你介绍一种量化方法——性状一致性指数（Consistency Index），来检测趋同演化或性状返祖导致的同塑性（homoplasy）。[@problem_id:2591319] 理解同塑性与多系群之间的联系至关重要，因为它揭示了为什么仅凭性状的相似性来判断演化关系是不可靠的，以及为何基于趋同性状建立的类群是人为的、非自然的。", "problem": "在一项涉及动物和植物类群的比较系统发育分析中，考虑有根树 `\"((A,(B,C)),(D,E))\"` 和一个单一的无序二态形态性状 $C_1$。该性状在分类单元 $A$ 和 $D$ 中被记录为状态 $0$，在分类单元 $B$、$C$ 和 $E$ 中被记录为状态 $1$。使用最大简约法进行性状优化，计算该树上性状 $C_1$ 的一致性指数，然后根据你的优化结果，判断 $C_1$ 在此树上是否为无同源异形（homoplasy-free），以及表现出状态 $1$ 的分类单元集合相对于给定的拓扑结构是单系群、并系群还是复系群。请以精确分数的形式给出一致性指数的最终数值答案。不要四舍五入。", "solution": "所述问题需要经过验证。\n\n步骤 1：提取已知条件。\n- 有根树拓扑：`\"((A,(B,C)),(D,E))\"`\n- 性状 $C_1$：单一、无序、二态的形态性状。\n- 性状 $C_1$ 的状态分布：\n  - 分类单元 $A$：状态 $0$。\n  - 分类单元 $B$：状态 $1$。\n  - 分类单元 $C$：状态 $1$。\n  - 分类单元 $D$：状态 $0$。\n  - 分类单元 $E$：状态 $1$。\n- 方法：最大简约法下的性状优化。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为它使用了系统发育系统学领域的标准概念和算法，即最大简约法、一致性指数以及生物类群的分类（单系、并系、复系）。该问题提法明确，提供了清晰定义的树拓扑结构、所有末端分类单元的性状状态数据以及指定的分析方法。所有术语都是标准的且无歧义。问题设定是自洽且一致的；没有矛盾或缺失的数据。因此，该问题被认定为有效。\n\n步骤 3：结论和行动。\n问题有效。将推导解答。\n\n解答需要三个不同的部分：计算性状 $C_1$ 的一致性指数，判断 $C_1$ 是否为无同源异形，以及对表现出状态 $1$ 的分类单元群组进行分类。\n\n首先，我们来表示树的结构。Newick 格式字符串 `\"((A,(B,C)),(D,E))\"` 表示一个有根树。为了清晰起见，我们可以标记内部节点：\n- 令 $n_1$ 为分类单元 $B$ 和 $C$ 的最近共同祖先 (MRCA)。\n- 令 $n_2$ 为分类单元 $A$ 和节点 $n_1$ 的最近共同祖先。\n- 令 $n_3$ 为分类单元 $D$ 和 $E$ 的最近共同祖先。\n- 令 $n_4$ 为树的根节点，即节点 $n_2$ 和 $n_3$ 的最近共同祖先。\n\n主要任务是找出性状 $C_1$ 在这棵树上的长度 ($L$)，这是在最大简约原则下解释观察到的状态分布所需的最少状态改变次数。这可以通过用于无序性状的 Fitch 算法来计算。\n\n该算法分两步进行。我们只需要第一步（自下而上）来确定长度 $L$。\n令 $S(k)$ 为节点 $k$ 的可能状态集。\n1.  为末端分类单元（叶节点）初始化状态集：\n    - $S(A) = \\{0\\}$\n    - $S(B) = \\{1\\}$\n    - $S(C) = \\{1\\}$\n    - $S(D) = \\{0\\}$\n    - $S(E) = \\{1\\}$\n2.  从叶节点到根节点遍历树，计算内部节点的状态集。对于任何具有直接后代 $i$ 和 $j$ 的内部节点 $p$：\n    - 如果 $S(i) \\cap S(j) \\neq \\emptyset$，则 $S(p) = S(i) \\cap S(j)$。\n    - 如果 $S(i) \\cap S(j) = \\emptyset$，则 $S(p) = S(i) \\cup S(j)$，并且长度 $L$ 增加 $1$。\n\n让我们应用这个过程，从长度 $L=0$ 开始：\n- 对于节点 $n_1$ (后代 $B, C$)：$S(B) = \\{1\\}$，$S(C) = \\{1\\}$。交集为 $S(B) \\cap S(C) = \\{1\\} \\neq \\emptyset$。因此，$S(n_1) = \\{1\\}$。长度保持为 $L=0$。\n- 对于节点 $n_3$ (后代 $D, E$)：$S(D) = \\{0\\}$，$S(E) = \\{1\\}$。交集为 $S(D) \\cap S(E) = \\emptyset$。因此，$S(n_3) = S(D) \\cup S(E) = \\{0, 1\\}$。长度增加：$L = 0 + 1 = 1$。\n- 对于节点 $n_2$ (后代 $A, n_1$)：$S(A) = \\{0\\}$，$S(n_1) = \\{1\\}$。交集为 $S(A) \\cap S(n_1) = \\emptyset$。因此，$S(n_2) = S(A) \\cup S(n_1) = \\{0, 1\\}$。长度再次增加：$L = 1 + 1 = 2$。\n- 对于节点 $n_4$ (根节点，后代 $n_2, n_3$)：$S(n_2) = \\{0, 1\\}$，$S(n_3) = \\{0, 1\\}$。交集 $S(n_2) \\cap S(n_3) = \\{0, 1\\} \\neq \\emptyset$。因此，$S(n_4) = \\{0, 1\\}$。长度不增加。\n\n最终的简约性得分，即长度，为 $L=2$。\n\n接下来，我们计算一致性指数 ($CI$)。公式为 $CI = \\frac{m}{L}$，其中 $m$ 是该性状可能的最小步数，而 $L$ 是在树上观察到的步数（简约性得分）。\n$m$ 的值由 $s-1$ 给出，其中 $s$ 是分类单元中存在的不同性状状态的数量。这里，存在状态 $0$ 和 $1$，所以 $s=2$。\n因此，$m = 2 - 1 = 1$。\n一致性指数是 $CI = \\frac{m}{L} = \\frac{1}{2}$。\n\n现在，我们必须确定性状 $C_1$ 是否为无同源异形。一个性状是无同源异形的，当且仅当其演化可以用最少的可能变化次数来解释，即如果 $L=m$。这等价于条件 $CI=1$。\n在本例中，$L=2$ 且 $m=1$。由于 $L > m$，该性状需要比最小可能变化次数更多的次数才能映射到树上。因此，性状 $C_1$ **不是**无同源异形的。它表现出同源异形。\n\n最后，我们对表现出状态 $1$ 的分类单元群组进行分类。该群组是 $ \\{B, C, E\\} $。\n- 如果一个群组包含一个祖先及其所有后代，则该群组是**单系群**。\n- 如果一个群组包含一个祖先但排除了其一个或多个后代，则该群组是**并系群**。\n- 如果一个群组的成员源自两个或多个不同的祖先谱系，并且其定义性状状态是趋同的或是祖征共享（symplesiomorphy，共享的祖先性状），则该群组是**复系群**。根据定义，一个复系群的最近共同祖先不是该群组的成员。在支序分类学中更关键的是，由同源异形性状状态定义的群组是复系群。\n\n让我们找到群组 $ \\{B, C, E\\} $ 的最近共同祖先 (MRCA)。$B$ 和 $C$ 的 MRCA 是 $n_1$。{$B, C$} 和 $E$ 的 MRCA 是 $n_1$ 和 $E$ 的 MRCA，也就是根节点 $n_4$。\n包含 $ \\{B, C, E\\} $ 所有成员的最小演化支是以 $n_4$ 为根的整棵树，它也包括分类单元 $A$ 和 $D$。由于群组 $ \\{B, C, E\\} $ 排除了分类单元 $A$ 和 $D$，所以它不是单系群。\n\n并系群和复系群之间的区别取决于定义性状状态的演化历史。我们的简约性分析已经确定性状状态 $1$ 是同源异形的 ($L > m$)。这意味着状态 $1$ 要么是独立出现多次（趋同演化），要么是出现一次后又发生了一次或多次丢失（逆转）。\n让我们检查两种同样简约的状态重建中的一种。如果我们将状态 $0$ 分配给根节点 $n_4$，那么我们必须假设在通往节点 $n_1$ 的分支上发生了从 $0 \\to 1$ 的变化（以解释 $B$ 和 $C$），并在通往分类单元 $E$ 的分支上发生了另一次独立的从 $0 \\to 1$ 的变化。\n在这种情况下，演化支 $(B,C)$ 中的性状状态 $1$ 和分类单元 $E$ 中的状态 $1$ 不是同源的；它们是趋同的。根据定义，一个其定义性状是趋同的群组是**复系群**。\n$ \\{B, C, E\\} $ 的成员并非从它们的直接共同祖先（$n_4$，被重建为状态 $0$）那里共享了状态 $1$。这种分组是基于非同源的相似性。因此，表现出状态 $1$ 的分类单元集合是复系群。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2591319"}]}