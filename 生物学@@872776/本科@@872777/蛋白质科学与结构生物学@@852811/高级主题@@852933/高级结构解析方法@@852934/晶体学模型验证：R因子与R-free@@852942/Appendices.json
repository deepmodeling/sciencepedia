{"hands_on_practices": [{"introduction": "晶体学中的R因子（R-factor）是评估原子模型与实验衍射数据吻合程度的基石。在我们深入探讨模型验证的精妙之处前，掌握这个基本指标的计算方法至关重要。本练习将让你直接应用R因子的公式，根据给定的统计总和计算其数值，从而将抽象概念转化为具体操作，巩固你对这一关键质量指标的理解。", "problem": "在X射线晶体学中，一个分子的精修原子模型的质量是通过将其与实验收集的衍射数据进行比较来评估的。用于此比较的一个主要指标是晶体学R因子，它量化了观测到的结构因子振幅 $|F_{obs}|$ 与根据原子模型计算出的结构因子振幅 $|F_{calc}|$ 之间的差异。\n\n一位生物化学家刚刚完成了一种新型酶的晶体结构的精修。分析得出，对所有测量的衍射点（$h$）而言，所有观测到的结构因子振幅的总和为：\n$$ \\sum_{h} |F_{obs}|_h = 125,500 $$\n观测振幅与计算振幅之间绝对差值的总和为：\n$$ \\sum_{h} ||F_{obs}|_h - |F_{calc}|_h| = 26,360 $$\n\n计算该模型的晶体学R因子。将您的答案以小数形式表示，并四舍五入至三位有效数字。", "solution": "晶体学R因子量化了观测与计算的结构因子振幅之间的差异，其定义为\n$$\nR = \\frac{\\sum_{h} \\left|\\,|F_{obs}|_{h} - |F_{calc}|_{h}\\,\\right|}{\\sum_{h} |F_{obs}|_{h}}.\n$$\n代入给定的总和，\n$$\nR = \\frac{26{,}360}{125{,}500}.\n$$\n用公因数20约分，得到\n$$\nR = \\frac{1318}{6275}.\n$$\n计算小数值：\n$$\nR = \\frac{26360}{125500} \\approx 0.21004\\ldots\n$$\n四舍五入至三位有效数字，得到\n$$\nR \\approx 0.210.\n$$", "answer": "$$\\boxed{0.210}$$", "id": "2120345"}, {"introduction": "虽然R因子衡量了模型与用于优化的数据之间的拟合度，但它无法防止“过拟合”。为此，晶体学家引入R-free作为一种独立的交叉验证指标。这个思想实验 [@problem_id:2120346] 探讨了一个常见的操作失误——将用于计算R-free的测试集数据混入模型优化过程中——所带来的直接后果，旨在强调保持R-free数据完全独立的至关重要性。", "problem": "在大分子X射线晶体学中，精修后的原子模型的质量是通过与实验衍射数据进行比较来评估的，评估指标包括R因子（或$R_{\\text{work}}$）和$R_{\\text{free}}$值。$R_{\\text{work}}$是使用衍射点的“工作集”计算得出的，该工作集包含绝大多数数据（通常为90-95%），并直接用于计算精修过程以优化模型参数。$R_{\\text{free}}$是从一小部分“测试集”的衍射点计算得出的，这些衍射点被有意地从该精修过程中排除。\n\n一名学生正处于精修蛋白质晶体结构的最后阶段。由于在设置精修软件时出错，该学生意外地将指定的$R_{\\text{free}}$测试集中的衍射点包含在了用于精修计算的数据池中。精修过程完成后，软件报告了最终的$R_{\\text{work}}$和$R_{\\text{free}}$值。\n\n下列哪项结果是这一特定错误最直接和必然的后果？\n\nA. $R_{\\text{work}}$会非常低，但$R_{\\text{free}}$会显著更高，表明模型存在严重过拟合。\n\nB. $R_{\\text{work}}$和$R_{\\text{free}}$都会异常高，表明模型与整体数据拟合不佳。\n\nC. $R_{\\text{work}}$和$R_{\\text{free}}$值都会很低且彼此几乎相同。\n\nD. $R_{\\text{work}}$会异常高，而$R_{\\text{free}}$会非常低。\n\nE. 精修将无法收敛，软件会产生错误信息而不是最终的R因子。", "solution": "将在衍射点集 $S$ 上计算的R因子定义为\n$$\nR(S)=\\frac{\\sum_{h\\in S}\\left|F_{h}^{\\mathrm{obs}}-F_{h}^{\\mathrm{calc}}\\right|}{\\sum_{h\\in S}\\left|F_{h}^{\\mathrm{obs}}\\right|}.\n$$\n在标准操作中，完整数据集被划分为两个不相交的集合：工作集 $S_{\\mathrm{work}}$ 和测试（R-free）集 $S_{\\mathrm{free}}$，且 $S_{\\mathrm{work}}\\cap S_{\\mathrm{free}}=\\emptyset$。精修过程通过仅在工作集上最小化一个目标函数（例如，加权最小二乘或似然目标函数）来优化模型参数 $\\theta$，\n$$\n\\min_{\\theta}\\ \\Phi(\\theta)=\\sum_{h\\in S_{\\mathrm{work}}} w_{h}\\left|F_{h}^{\\mathrm{obs}}-F_{h}^{\\mathrm{calc}}(\\theta)\\right|^{2},\n$$\n因此 $R_{\\mathrm{work}}=R(S_{\\mathrm{work}})$ 反映了模型与用于精修的数据的拟合程度，而 $R_{\\mathrm{free}}=R(S_{\\mathrm{free}})$ 则作为一种独立的验证，因为 $S_{\\mathrm{free}}$ 被排除在精修之外。在正确的流程下，独立性通常意味着 $R_{\\mathrm{free}}\\ge R_{\\mathrm{work}}$，如果两者之间的正差距变大，则可诊断为过拟合。\n\n在所述的错误设置中，学生将R-free衍射点包含在了精修计算中。记 $S_{\\mathrm{refine}}=S_{\\mathrm{work}}\\cup S_{\\mathrm{free}}$。那么精修后的参数是通过以下方式获得的：\n$$\n\\min_{\\theta}\\ \\Phi(\\theta)=\\sum_{h\\in S_{\\mathrm{refine}}} w_{h}\\left|F_{h}^{\\mathrm{obs}}-F_{h}^{\\mathrm{calc}}(\\theta)\\right|^{2},\n$$\n这会明确地最小化 $S_{\\mathrm{work}}$ 和 $S_{\\mathrm{free}}$ 两者的残差。因此，模型被直接优化以拟合 $S_{\\mathrm{free}}$ 中的衍射点，从而破坏了R-free的独立性。由于两个子集都用于相同的优化过程， $S_{\\mathrm{work}}$ 和 $S_{\\mathrm{free}}$ 上的残差分布会变得相似，导致\n$$\nR_{\\mathrm{free}}\\approx R_{\\mathrm{work}},\n$$\n并且预期这两个值都会达到精修过程在所见数据上能达到的最低水平。\n\n评估各个选项：\n- 选项A（低 $R_{\\mathrm{work}}$ 但显著更高的 $R_{\\mathrm{free}}$）描述的是当 $S_{\\mathrm{free}}$ 被排除时发生的过拟合；当测试集泄漏到精修中时，这不是其结果。\n- 选项B（两者都异常高）与精修过程刚刚最小化了所有包含的衍射点的残差这一事实相矛盾。\n- 选项C（低且几乎相同的 $R_{\\mathrm{work}}$ 和 $R_{\\mathrm{free}}$）与 $S_{\\mathrm{free}}$ 被包含在精修中从而失去独立性这一直接后果相匹配。\n- 选项D（高 $R_{\\mathrm{work}}$，低 $R_{\\mathrm{free}}$）与精修的工作原理不一致，因为工作集的拟合程度至少会与任何被排除的集合一样好。\n- 选项E（精修失败）不是必然的结果；软件通常会完成精修，只是验证过程受到了损害。\n\n因此，最直接和必然的后果是 $R_{\\mathrm{free}}$ 会人为地变得与 $R_{\\mathrm{work}}$ 相似，两者都变得很低且几乎相同。", "answer": "$$\\boxed{C}$$", "id": "2120346"}, {"introduction": "R-free作为诊断工具的可靠性在很大程度上取决于测试集的构建方式。这个实践问题 [@problem_id:2120332] 探讨了一个关键的统计学方面：测试集的大小。通过思考使用过少衍射点所带来的陷阱，你将理解为什么一个具有统计学意义的样本对于确保R-free值是模型质量的稳健衡量、而非随机噪声至关重要。", "problem": "在X射线晶体学中，建立分子初始原子模型后的一个关键步骤是根据实验测量的衍射数据对其进行精修。为了评估精修后模型的质量并防止过拟合，晶体学家使用两个指标：R因子（或$R_{\\text{work}}$）和$R_{\\text{free}}$。R因子用于衡量“工作集”衍射点的观测结构因子振幅（$|F_{\\text{obs}}|$）与计算结构因子振幅（$|F_{\\text{calc}}|$）之间的一致性，工作集通常包含90-95%直接用于精修过程的数据。$R_{\\text{free}}$的计算方法与R因子相同，但是针对一小部分“测试集”衍射点（通常为5-10%）进行的，这部分数据完全不参与精修计算。$R$因子和$R_{\\text{free}}$之间的显著差异是过拟合的典型标志。\n\n一名研究生正在精修一个蛋白质结构。为了尽可能多地使用数据来改善模型，他们决定使用一个异常小的测试集，只将总独立衍射点的1%分配给$R_{\\text{free}}$计算，而将其余99%用于$R_{\\text{work}}$集。以下哪项描述了这一决定最直接且最显著的统计缺陷？\n\nA. R因子将被被人为地抬高，表明模型比实际情况更差。\n\nB. 由于巨大的随机抽样误差，$R_{\\text{free}}$值在统计上将变得不可靠，使其成为一个衡量模型质量的糟糕指标。\n\nC. 该过程将在衍射点的选择中引入系统性偏差，从而破坏最终的电子密度图。\n\nD. 使用99%的工作集将导致精修软件收敛过慢，使计算不切实际。\n\nE. 无论模型的实际质量如何，$R_{\\text{free}}$值都将系统性地且显著地高于R因子。", "solution": "为每个衍射点 $h$ 定义量 $X_{h}=\\left||F_{obs}(h)|-|F_{calc}(h)|\\right|$ 和 $Y_{h}=|F_{obs}(h)|$。对于任何大小为 $n_{S}$ 的衍射点集 $S$（工作集 $W$ 或测试集 $T$），在 $S$ 上计算的晶体学残差可以写为\n$$\nR_{S}=\\frac{\\sum_{h\\in S}X_{h}}{\\sum_{h\\in S}Y_{h}}=\\frac{\\bar{X}_{S}}{\\bar{Y}_{S}},\n$$\n其中 $\\bar{X}_{S}=\\frac{1}{n_{S}}\\sum_{h\\in S}X_{h}$ 且 $\\bar{Y}_{S}=\\frac{1}{n_{S}}\\sum_{h\\in S}Y_{h}$。\n\n假设衍射点被随机划分到 $W$ 和 $T$ 中，这是无偏估计的要求。设总体均值为 $\\mu_{X}=\\mathbb{E}[X_{h}]$ 和 $\\mu_{Y}=\\mathbb{E}[Y_{h}]$，$(X_{h},Y_{h})$ 的协方差矩阵为\n$$\n\\Sigma=\\begin{pmatrix}\n\\sigma_{X}^{2}  \\sigma_{XY} \\\\\n\\sigma_{XY}  \\sigma_{Y}^{2}\n\\end{pmatrix}.\n$$\n根据多元中心极限定理，$(\\bar{X}_{S},\\bar{Y}_{S})$ 近似服从均值为 $(\\mu_{X},\\mu_{Y})$、协方差为 $\\Sigma/n_{S}$ 的正态分布。对平滑映射 $g(x,y)=x/y$ 使用delta方法，$R_{S}=g(\\bar{X}_{S},\\bar{Y}_{S})$ 的方差满足\n$$\n\\operatorname{Var}(R_{S})\\approx\\frac{1}{n_{S}}\\left(\\nabla g(\\mu_{X},\\mu_{Y})^{\\top}\\Sigma\\,\\nabla g(\\mu_{X},\\mu_{Y})\\right),\n$$\n其中\n$$\n\\nabla g(x,y)=\\left(\\frac{\\partial}{\\partial x}\\frac{x}{y},\\frac{\\partial}{\\partial y}\\frac{x}{y}\\right)=\\left(\\frac{1}{y},-\\frac{x}{y^{2}}\\right).\n$$\n因此，\n$$\n\\operatorname{Var}(R_{S})\\approx \\frac{1}{n_{S}}\\left(\\frac{\\sigma_{X}^{2}}{\\mu_{Y}^{2}}-2\\frac{\\mu_{X}\\sigma_{XY}}{\\mu_{Y}^{3}}+\\frac{\\mu_{X}^{2}\\sigma_{Y}^{2}}{\\mu_{Y}^{4}}\\right).\n$$\n关键结果是 $1/n_{S}$ 的缩放关系：$R_{S}$ 的统计不确定性与集合 $S$ 中衍射点的数量成反比递减。\n\n设独立衍射点的总数为 $N$，测试集分数为 $f_{t}$，因此 $n_{T}=f_{t}N$。那么\n$$\n\\operatorname{Var}(R_{\\text{free}})\\approx \\frac{C}{f_{t}N},\n$$\n其中 $C$ 是一个由 $(X_{h},Y_{h})$ 的潜在分布决定的常数。如果 $f_{t}$ 过小，$n_{T}$ 会减小，方差会成比例地增大，导致 $R_{\\text{free}}$ 出现大的随机抽样误差。这使得 $R_{\\text{free}}$ 成为一个充满噪声且不可靠的泛化性能估计，也使其成为一个防范过拟合的糟糕指标。\n\n评估各个选项：\n- A是错误的：扩大工作集不会人为地抬高$R$；相反，过拟合风险可能会压低$R_{\\text{work}}$。\n- B是正确的：一个非常小的$n_{T}$会导致$R_{\\text{free}}$的高方差，从而破坏其可靠性。\n- C是错误的：只要进行适当的随机选择，就不会引入系统性偏差；主要问题是方差，而不是偏差。\n- D是错误的：精修收敛速度并不主要受工作集大小的微小变化影响。\n- E是错误的：$R_{\\text{free}}$通常高于$R_{\\text{work}}$，但当测试集很小时，这种偏差不是系统性的；随机性占主导地位。\n\n因此，最直接且最显著的统计缺陷是，由于测试集过小导致的大抽样误差，使得$R_{\\text{free}}$变得不可靠。", "answer": "$$\\boxed{B}$$", "id": "2120332"}]}