{"hands_on_practices": [{"introduction": "系统发育树是揭示基因进化历史的关键工具。通过这个练习，你将学会一项基本技能：如何在树状图中精确定位代表基因重复事件的分支点，这是理解旁系同源基因起源的基础。[@problem_id:2136489]", "problem": "在分子进化中，拥有共同祖先的基因被称为同源基因。同源性可以进一步细分。直系同源基因是指在不同物种中发现的、在物种形成事件中由共同祖先基因分化而来的同源基因。旁系同源基因是指在单个物种内（或跨物种）因基因复制事件而产生的同源基因。理解这一区别是解读基因功能和进化历史的关键。\n\n一位进化生物学家重建了人类和鸡的几种珠蛋白基因的系统发育关系。得到的无标度系统发育树，仅显示分支模式（拓扑结构），其嵌套文本格式表示如下：\n\n`(Myoglobin_Human, ((Alpha_Human, Alpha_Chicken), (Beta_Human, Beta_Chicken)));`\n\n在这种格式中，括号内的一组项目比括号外的项目拥有更近的共同祖先。例如，`(A, B)` 表示 A 和 B 在树中是彼此最亲近的亲缘。\n\n根据这棵系统发育树，以下哪个节点代表了导致不同的α-珠蛋白和β-珠蛋白基因家族产生的祖先基因复制事件？\n\nA. Alpha_Human 和 Alpha_Chicken 的最近共同祖先。\n\nB. Beta_Human 和 Beta_Chicken 的最近共同祖先。\n\nC. 树中所有α-珠蛋白和β-珠蛋白的最近共同祖先。\n\nD. 树中所有基因（包括 Myoglobin_Human）的最近共同祖先。", "solution": "目标是找出系统发育树上对应于α-珠蛋白和β-珠蛋白谱系分离的基因复制事件的节点。为此，我们必须分析树结构所描述的关系：`(Myoglobin_Human, ((Alpha_Human, Alpha_Chicken), (Beta_Human, Beta_Chicken)))`。\n\n首先，我们来理解树的拓扑结构告诉了我们什么。\n- 最外层的分支将 `Myoglobin_Human` 与其余基因分离开。这意味着肌红蛋白是这组α-和β-珠蛋白的外群。\n- 下一个分支层级是 `((Alpha_Human, Alpha_Chicken), (Beta_Human, Beta_Chicken))`。这个节点将树分为两个主要的演化支（组）：一个包含所有α-珠蛋白，另一个包含所有β-珠蛋白。\n- 在α-珠蛋白演化支内部，结构是 `(Alpha_Human, Alpha_Chicken)`。这意味着人类α-珠蛋白和鸡α-珠蛋白共享一个共同祖先。\n- 同样地，在β-珠蛋白演化支内部，结构是 `(Beta_Human, Beta_Chicken)`，意味着人类和鸡的β-珠蛋白共享一个共同祖先。\n\n现在，我们根据直系同源基因和旁系同源基因的定义来评估每个选项。\n- 直系同源基因产生于物种形成。在树上，一个物种形成节点是不同物种中相同基因的共同祖先。\n- 旁系同源基因产生于基因复制。在树上，一个复制节点是不同（但同源）基因的共同祖先。这次分裂早于携带这些基因的生物随后发生的物种形成事件。\n\n我们来逐一分析这些选项：\n\nA. Alpha_Human 和 Alpha_Chicken 的最近共同祖先。\n这个节点代表了导致人类α-珠蛋白基因和鸡α-珠蛋白基因分化的事件。由于这是两个不同物种中*相同类型*的基因（α-珠蛋白），它们的分化是由于分开了通往人类和鸡的进化谱系的物种形成事件。因此，Alpha_Human 和 Alpha_Chicken 是直系同源基因，这个节点代表一个物种形成事件。\n\nB. Beta_Human 和 Beta_Chicken 的最近共同祖先。\n与选项A类似，这个节点代表了两个不同物种中*相同类型*的基因（β-珠蛋白）的分化。这也是一个物种形成事件，并且 Beta_Human 和 Beta_Chicken 是直系同源基因。\n\nD. 树中所有基因（包括 Myoglobin_Human）的最近共同祖先。\n这个节点代表了树中最深的分裂，它将肌红蛋白谱系与血红蛋白（α和β）谱系分离开来。这确实是一个基因复制事件，但它是一个更为古老的事件，创造了肌红蛋白和珠蛋白基因家族，而不是分离α-珠蛋白和β-珠蛋白的事件。\n\nC. 树中所有α-珠蛋白和β-珠蛋白的最近共同祖先。\n这个节点是两个不同组的祖先：α-珠蛋白组 `(Alpha_Human, Alpha_Chicken)` 和β-珠蛋白组 `(Beta_Human, Beta_Chicken)`。该节点的事件创造了两个独立的谱系，其中一个将演化为α-珠蛋白，另一个将演化为β-珠蛋白。这正是基因复制事件的定义。这次复制之后，两个基因拷贝（前α-珠蛋白和前β-珠蛋白）存在于人类和鸡的共同祖先中。然后，随着人类和鸡后来分化（物种形成），它们各自继承了一个α-珠蛋白基因的拷贝和一个β-珠蛋白基因的拷贝。因此，任何α-珠蛋白都是任何β-珠蛋白的旁系同源基因（例如，Alpha_Human 是 Beta_Human 的旁系同源基因）。这个节点正确地标识了创造α-和β-珠蛋白家族的基因复制事件。", "answer": "$$\\boxed{C}$$", "id": "2136489"}, {"introduction": "在生物信息学实践中，我们经常使用BLAST等工具来寻找同源基因，但结果并非总是一一对应。这个练习模拟了一个真实的研究场景，你需要结合全基因组复制这样的重大进化事件知识，来正确解读查询结果中出现的更复杂的进化关系（共直系同源）。[@problem_id:2136482]", "problem": "一位分子生物学家正在研究一种人类蛋白质，我们称之为h-ProteinX。为了在其他物种中寻找相关蛋白质，该研究人员使用h-ProteinX的氨基酸序列作为查询序列，对斑马鱼（*Danio rerio*）的整个翻译基因组进行了基础局部比对搜索工具（BLAST）搜索。搜索产生了两个不同的、具有统计学意义的匹配结果，我们称之为z-ProteinY和z-ProteinZ。\n\n根据进化研究，一个公认的事实是，在硬骨鱼类（包括斑马鱼）的谱系从导向四足动物（包括人类）的谱系分化*之后*，前者发生了一次全基因组复制事件。\n\n根据这些信息，下列哪个陈述最准确地描述了h-ProteinX、z-ProteinY和z-ProteinZ之间的进化关系？\n\nA. h-ProteinX是z-ProteinY的直系同源物，且h-ProteinX是z-ProteinZ的旁系同源物。\n\nB. z-ProteinY和z-ProteinZ互为直系同源物。\n\nC. h-ProteinX是z-ProteinY和z-ProteinZ的共同直系同源物；z-ProteinY和z-ProteinZ是旁系同源物。\n\nD. h-ProteinX、z-ProteinY和z-ProteinZ三者互为旁系同源物。\n\nE. h-ProteinX是z-ProteinY和z-ProteinZ两者的旁系同源物。", "solution": "定义直系同源（orthology）和旁系同源（paralogy）。直系同源物（Orthologs）是因物种形成事件而分化的同源基因，而旁系同源物（paralogs）是在某一谱系内部因基因重复事件而分化的同源基因。\n\n确定物种历史和事件发生的时间顺序。硬骨鱼类特有的全基因组复制发生在导向斑马鱼的谱系从导向人类的谱系分化之后。因此，我们考虑一个存在于四足动物和硬骨魚類共同祖先中的祖先基因。在人类-硬骨鱼类分化后，斑马鱼谱系经历了一次复制，产生了两个拷贝，也就是现在观察到的z-ProteinY和z-ProteinZ。人类谱系保留了单个拷贝，即h-ProteinX。\n\n根据事件发生的时间顺序推断基因关系。因为产生z-ProteinY和z-ProteinZ的复制事件发生在人类-硬骨鱼类分化之后，所以这两个斑马鱼基因都可以追溯到复制前的单个祖先基因，该基因也是h-ProteinX的祖先。因此，h-ProteinX与z-ProteinY和z-ProteinZ均为直系同源关系；具体来说，它们是h-ProteinX的共同直系同源物。在斑马鱼体内，z-ProteinY和z-ProteinZ是由复制产生的，因此它们是旁系同源物（在全基因组复制后产生的旁系同源物通常被称为ohnologs）。\n\n评估选项：\n- A是错误的，因为复制发生在物种形成之后；因此h-ProteinX不可能是z-ProteinZ的旁系同源物。\n- B是错误的，因为z-ProteinY和z-ProteinZ不是直系同源物；它们是旁系同源物。\n- C是正确的：h-ProteinX是z-ProteinY和z-ProteinZ的共同直系同源物，并且z-ProteinY和z-ProteinZ是旁系同源物。\n- D是错误的，因为并非全部三个都是旁系同源物；此处的跨物种关系是直系同源关系。\n- E是错误的，因为考虑到物种形成后的复制事件，h-ProteinX不是斑马鱼基因的旁系同源物。\n\n因此，最准确的陈述是选项C。", "answer": "$$\\boxed{C}$$", "id": "2136482"}, {"introduction": "有时，一个基因家族的进化史（基因树）似乎与物种本身的进化史（物种树）不一致。这个更具挑战性的练习将引导你完成“基因树-物种树协调”的过程，通过推断最少的基因重复和丢失事件来解释这些差异，从而为基因家族的进化构建一个完整的故事。[@problem_id:2136499]", "problem": "一个进化生物学家团队正在研究一个新发现的名为“Resistases”的酶家族，该家族在几种细菌中赋予了对一类新型抗生素的抗性。正在研究的四个物种是*大肠杆菌* (*Escherichia coli*, Ecoli)、*肠道沙门氏菌* (*Salmonella enterica*, Sent)、*鼠疫耶尔森菌* (*Yersinia pestis*, Ypest)和*铜绿假单胞菌* (*Pseudomonas aeruginosa*, Paer)。已确定的物种系统发育（代表了它们的进化关系）以 Newick 格式给出：`((Ecoli,Sent),Ypest),Paer);`。在这种表示法中，一对括号包含一个演化支，逗号分隔姐妹分类单元。\n\n通过基因组测序，该团队在*大肠杆菌* (*E. coli*) 中鉴定出属于 Resistase 家族的基因 `ResA_Ecoli` 和 `ResB_Ecoli`，在*肠道沙门氏菌* (*S. enterica*) 中鉴定出 `ResA_Sent`，在*鼠疫耶尔森菌* (*Y. pestis*) 中鉴定出 `ResA_Ypest`，在*铜绿假单胞菌* (*P. aeruginosa*) 中鉴定出 `ResA_Paer`。对这些基因序列的系统发育分析产生了以下基因树，同样以 Newick 格式表示：`(((ResA_Ecoli,ResB_Ecoli),ResA_Sent),(ResA_Ypest,ResA_Paer));`。\n\n为了理解该基因家族的进化历史，团队需要将基因树与物种树进行协调。这个过程涉及到假设基因重复和基因丢失事件来解释任何不一致之处。假设给定的物种树和基因树是正确的，要解释观察到的基因系统发育，需要的最少基因重复和基因丢失事件总数是多少？", "solution": "我们将物种系统发育解释为 Paer 是包含 Ypest 和 (Ecoli, Sent) 对的演化支的姐妹群，即，其有根拓扑结构的内部物种节点定义如下：设 $N_{1}$ 是 Ecoli 和 Sent 的最近共同祖先，设 $N_{2}$ 是 $N_{1}$ 和 Ypest 的最近共同祖先，设 $N_{3}$ 是根，即 $N_{2}$ 和 Paer 的最近共同祖先。因此，物种树为 `(((Ecoli,Sent),Ypest),Paer))`。\n\n基因树的叶节点为 $a=\\text{ResA\\_Ecoli}$、$b=\\text{ResB\\_Ecoli}$、$c=\\text{ResA\\_Sent}$、$d=\\text{ResA\\_Ypest}$、$e=\\text{ResA\\_Paer}$，内部节点定义为 $x_{1}=\\mathrm{LCA}(a,b)$、$x_{2}=\\mathrm{LCA}(x_{1},c)$、$x_{3}=\\mathrm{LCA}(d,e)$，以及根节点 $g_{R}=\\mathrm{LCA}(x_{2},x_{3})$。协调过程使用标准的最近共同祖先（LCA）映射 $s(\\cdot)$，该映射将基因节点映射到物种节点，其定义为物种树中该基因节点所有后代物种的最近共同祖先。\n\n计算物种映射：\n- 对于叶节点：$s(a)=\\text{Ecoli}$，$s(b)=\\text{Ecoli}$，$s(c)=\\text{Sent}$，$s(d)=\\text{Ypest}$，$s(e)=\\text{Paer}$。\n- 对于内部节点：$s(x_{1})=\\mathrm{LCA}(\\text{Ecoli},\\text{Ecoli})=\\text{Ecoli}$，$s(x_{2})=\\mathrm{LCA}(\\text{Ecoli},\\text{Sent})=N_{1}$，$s(x_{3})=\\mathrm{LCA}(\\text{Ypest},\\text{Paer})=N_{3}$，以及 $s(g_{R})=\\mathrm{LCA}(\\text{Ecoli},\\text{Sent},\\text{Ypest},\\text{Paer})=N_{3}$。\n\n使用以下标准将每个内部基因节点分类为重复或物种形成：如果一个基因节点 $u$ 的映射 $s(u)$ 与其至少一个子节点 $v$ 的映射 $s(v)$ 相同，则该节点为重复事件；否则为物种形成事件。\n- 在 $x_{1}$ 处，$s(x_{1})=\\text{Ecoli}$ 且其两个子节点都映射到 $\\text{Ecoli}$，所以 $x_{1}$ 是一个重复事件（两个 Ecoli 旁系同源基因）。\n- 在 $x_{2}$ 处，$s(x_{2})=N_{1}$ 而其子节点映射到 $\\text{Ecoli}$ 和 $\\text{Sent}$，所以 $x_{2}$ 是一个物种形成事件。\n- 在 $x_{3}$ 处，$s(x_{3})=N_{3}$ 而其子节点映射到 $\\text{Ypest}$ 和 $\\text{Paer}$（$N_{3}$ 的不同子分支），所以 $x_{3}$ 是一个物种形成事件。\n- 在 $g_{R}$ 处，$s(g_{R})=N_{3}$ 且其子节点分别映射到 $N_{1}$ 和 $N_{3}$，因此 $s(g_{R})=s(x_{3})$，$g_{R}$ 是一个重复事件。\n\n因此，所需的最少重复事件数量为 $2$（在 $g_{R}$ 和 $x_{1}$ 处）。\n\n接下来，使用标准路径覆盖法计算丢失事件。对于每个内部基因节点 $u$，对于其每个子节点 $v$，考虑在物种树中从 $s(u)$ 向下到 $s(v)$ 的路径。节点 $u$ 的所有子节点的这些路径的并集决定了物种树内的一个子树 $T_{u}$。对于 $T_{u}$ 上的每个物种节点，该物种节点的任何未包含在 $T_{u}$ 中的子边都对 $u$ 处的丢失事件贡献一次。\n\n- 对于 $g_{R}$：$s(g_{R})=N_{3}$，其子节点的映射为 $s(x_{2})=N_{1}$ 和 $s(x_{3})=N_{3}$。路径为 $N_{3}\\to N_{2}\\to N_{1}$ 和在 $N_{3}$ 处的平凡路径。因此 $T_{g_{R}}$ 包含边 $(N_{3},N_{2})$ 和 $(N_{2},N_{1})$。在 $N_{3}$ 处，缺失的子边是 $(N_{3},\\text{Paer})$，产生 $1$ 次丢失；在 $N_{2}$ 处，缺失的子边是 $(N_{2},\\text{Ypest})$，产生 $1$ 次丢失；此处在 $N_{1}$ 不计数丢失。因此在 $g_{R}$ 处有 $2$ 次丢失。\n\n- 对于 $x_{2}$：$s(x_{2})=N_{1}$，其子节点映射到 $\\text{Ecoli}$ 和 $\\text{Sent}$。路径覆盖了 $(N_{1},\\text{Ecoli})$ 和 $(N_{1},\\text{Sent})$，因此在 $x_{2}$ 处有 $0$ 次丢失。\n\n- 对于 $x_{1}$：$s(x_{1})=\\text{Ecoli}$ 且其两个子节点都映射到 $\\text{Ecoli}$；路径中没有物种树的边，因此在 $x_{1}$ 处有 $0$ 次丢失。\n\n- 对于 $x_{3}$：$s(x_{3})=N_{3}$，其子节点映射到 $\\text{Ypest}$ 和 $\\text{Paer}$。路径为 $N_{3}\\to N_{2}\\to \\text{Ypest}$ 和 $N_{3}\\to \\text{Paer}$，所以 $T_{x_{3}}$ 包括 $(N_{3},N_{2})$、$(N_{2},\\text{Ypest})$ 和 $(N_{3},\\text{Paer})$。在 $N_{3}$ 处，两个子边都被覆盖（没有丢失）；在 $N_{2}$ 处，缺失的子边是 $(N_{2},N_{1})$，产生 $1$ 次丢失。因此在 $x_{3}$ 处有 $1$ 次丢失。\n\n将所有内部节点的丢失事件相加，得到 $2+0+0+1=3$ 次丢失。这个计数是最小的：在 $N_{3}$ 发生重复后，产生 Ecoli/Sent 演化支的一个拷贝必须在 $\\text{Paer}$ 分支和 $\\text{Ypest}$ 分支上丢失（两次丢失），而产生 Ypest/Paer 演化支的另一个拷贝必须在 $N_{1}$ 分支上丢失（一次丢失）。\n\n因此，事件的最小总数等于重复次数加上丢失次数，即 $2+3=5$。", "answer": "$$\\boxed{5}$$", "id": "2136499"}]}