{"hands_on_practices": [{"introduction": "Understanding the behavior of weakly nonlinear oscillators is a cornerstone of nonlinear analysis, as many complex systems can be modeled as small perturbations of simpler linear ones. This practice [@problem_id:2731668] guides you through the application of the method of averaging, a powerful technique used to derive the slow dynamics governing the amplitude and phase of an oscillation. By completing this exercise, you will gain proficiency in predicting the existence and characteristics of limit cycles directly from a system's governing equations.", "problem": "Consider the weakly nonlinear oscillator governed by the second-order ordinary differential equation (ODE)\n$$\n\\ddot{x} + x = \\varepsilon f(x,\\dot{x}),\n$$\nwith $0  \\varepsilon \\ll 1$, where\n$$\nf(x,\\dot{x}) = \\alpha \\dot{x} - \\beta x^{2}\\dot{x} - \\gamma \\dot{x}^{3},\n$$\nand $\\alpha, \\beta, \\gamma$ are real parameters. Assume $\\alpha > 0$ and $\\beta + 3\\gamma > 0$ so that a unique, stable, finite-amplitude limit cycle may exist.\n\nUsing first-order averaging theory starting from the unforced linear oscillator $\\ddot{x} + x = 0$ as the base system, derive the averaged slow-flow equations for the amplitude $r(t)$ and phase $\\phi(t)$ by writing the state in polar form $x(t) = r(t)\\cos(\\theta(t))$ and $\\dot{x}(t) = -r(t)\\sin(\\theta(t))$ with $\\theta(t) = t + \\phi(t)$, and applying averaging over one period of the base oscillation. From the averaged amplitude equation, determine all fixed points and identify the nonzero fixed point corresponding to a limit cycle amplitude.\n\nProvide as your final answer only the exact closed-form analytic expression for the nonzero fixed-point amplitude in terms of $\\alpha$, $\\beta$, and $\\gamma$. Do not provide any intermediate steps in the final answer. No numerical approximation or rounding is required.", "solution": "The problem presented is a standard exercise in the analysis of weakly nonlinear oscillators using perturbation methods. The problem is well-posed, scientifically sound, and provides all necessary information for its resolution. I will proceed with the derivation.\n\nThe governing equation is a second-order ordinary differential equation:\n$$\n\\ddot{x} + x = \\varepsilon f(x,\\dot{x})\n$$\nwhere $0  \\varepsilon \\ll 1$ and $f(x,\\dot{x}) = \\alpha \\dot{x} - \\beta x^{2}\\dot{x} - \\gamma \\dot{x}^{3}$. We are tasked with finding the amplitude of the limit cycle using the method of averaging.\n\nWe employ the van der Pol transformation to polar coordinates, as suggested:\n$$\nx(t) = r(t)\\cos(\\theta(t))\n$$\n$$\n\\dot{x}(t) = -r(t)\\sin(\\theta(t))\n$$\nwhere the phase is defined as $\\theta(t) = t + \\phi(t)$. The variables $r(t)$ and $\\phi(t)$ are assumed to be slowly varying, which is a key assumption of the method.\n\nDifferentiating $x(t)$ with respect to time gives:\n$$\n\\dot{x} = \\dot{r}\\cos\\theta - r\\dot{\\theta}\\sin\\theta\n$$\nBy comparing this with the imposed condition $\\dot{x} = -r\\sin\\theta$ and substituting $\\dot{\\theta} = 1 + \\dot{\\phi}$, we obtain the first constraint on the slow variables:\n$$\n\\dot{r}\\cos\\theta - r(1+\\dot{\\phi})\\sin\\theta = -r\\sin\\theta\n$$\n$$\n\\dot{r}\\cos\\theta - r\\dot{\\phi}\\sin\\theta = 0\n$$\n\nNext, we differentiate $\\dot{x}(t)$ with respect to time:\n$$\n\\ddot{x} = -\\dot{r}\\sin\\theta - r\\dot{\\theta}\\cos\\theta\n$$\nSubstituting this and $x = r\\cos\\theta$ into the original ODE yields:\n$$\n(-\\dot{r}\\sin\\theta - r\\dot{\\theta}\\cos\\theta) + r\\cos\\theta = \\varepsilon f(r\\cos\\theta, -r\\sin\\theta)\n$$\nUsing $\\dot{\\theta} = 1+\\dot{\\phi}$ again, we find the second constraint:\n$$\n-\\dot{r}\\sin\\theta - r(1+\\dot{\\phi})\\cos\\theta + r\\cos\\theta = \\varepsilon f(x, \\dot{x})\n$$\n$$\n-\\dot{r}\\sin\\theta - r\\dot{\\phi}\\cos\\theta = \\varepsilon f(x, \\dot{x})\n$$\n\nWe now have a system of two linear equations for $\\dot{r}$ and $\\dot{\\phi}$:\n$$\n\\begin{cases}\n\\dot{r}\\cos\\theta - r\\dot{\\phi}\\sin\\theta = 0 \\\\\n-\\dot{r}\\sin\\theta - r\\dot{\\phi}\\cos\\theta = \\varepsilon f(x, \\dot{x})\n\\end{cases}\n$$\nSolving this system for $\\dot{r}$ and $\\dot{\\phi}$ yields the exact evolution equations for the amplitude and phase:\n$$\n\\dot{r} = -\\varepsilon f(x, \\dot{x})\\sin\\theta\n$$\n$$\n\\dot{\\phi} = -\\frac{\\varepsilon}{r}f(x, \\dot{x})\\cos\\theta\n$$\nNow, we express the function $f(x, \\dot{x})$ in terms of $r$ and $\\theta$:\n$$\nf(r\\cos\\theta, -r\\sin\\theta) = \\alpha(-r\\sin\\theta) - \\beta(r\\cos\\theta)^{2}(-r\\sin\\theta) - \\gamma(-r\\sin\\theta)^{3}\n$$\n$$\nf(r\\cos\\theta, -r\\sin\\theta) = -r\\alpha\\sin\\theta + r^{3}\\beta\\cos^{2}\\theta\\sin\\theta + r^{3}\\gamma\\sin^{3}\\theta\n$$\nSubstituting this into the equation for $\\dot{r}$:\n$$\n\\dot{r} = -\\varepsilon(-r\\alpha\\sin\\theta + r^{3}\\beta\\cos^{2}\\theta\\sin\\theta + r^{3}\\gamma\\sin^{3}\\theta)\\sin\\theta\n$$\n$$\n\\dot{r} = \\varepsilon(r\\alpha\\sin^{2}\\theta - r^{3}\\beta\\cos^{2}\\theta\\sin^{2}\\theta - r^{3}\\gamma\\sin^{4}\\theta)\n$$\nThe method of first-order averaging states that the slow dynamics of $r$ can be approximated by averaging the right-hand side of its evolution equation over one period of the fast variable $\\theta$, from $0$ to $2\\pi$. The slow variable $r$ is treated as a constant during this integration. The averaged equation, denoted $\\langle\\dot{r}\\rangle$, is:\n$$\n\\langle\\dot{r}\\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\varepsilon(r\\alpha\\sin^{2}\\theta - r^{3}\\beta\\cos^{2}\\theta\\sin^{2}\\theta - r^{3}\\gamma\\sin^{4}\\theta) d\\theta\n$$\nTo evaluate this, we use the following standard definite integrals:\n$$\n\\int_{0}^{2\\pi} \\sin^{2}\\theta \\,d\\theta = \\pi\n$$\n$$\n\\int_{0}^{2\\pi} \\cos^{2}\\theta\\sin^{2}\\theta \\,d\\theta = \\int_{0}^{2\\pi} \\frac{1}{4}\\sin^{2}(2\\theta) \\,d\\theta = \\frac{\\pi}{4}\n$$\n$$\n\\int_{0}^{2\\pi} \\sin^{4}\\theta \\,d\\theta = \\int_{0}^{2\\pi} \\left(\\frac{1-\\cos(2\\theta)}{2}\\right)^{2} d\\theta = \\frac{1}{4} \\int_{0}^{2\\pi} (1 - 2\\cos(2\\theta) + \\cos^{2}(2\\theta)) d\\theta = \\frac{1}{4}(2\\pi - 0 + \\pi) = \\frac{3\\pi}{4}\n$$\nSubstituting these results into the averaged equation:\n$$\n\\langle\\dot{r}\\rangle = \\frac{\\varepsilon}{2\\pi} \\left( r\\alpha(\\pi) - r^{3}\\beta\\left(\\frac{\\pi}{4}\\right) - r^{3}\\gamma\\left(\\frac{3\\pi}{4}\\right) \\right)\n$$\n$$\n\\langle\\dot{r}\\rangle = \\frac{\\varepsilon r}{2} \\left(\\alpha - \\frac{r^{2}}{4}\\beta - \\frac{3r^{2}}{4}\\gamma\\right)\n$$\n$$\n\\langle\\dot{r}\\rangle = \\frac{\\varepsilon r}{8} \\left(4\\alpha - r^{2}(\\beta + 3\\gamma)\\right)\n$$\nThe fixed points of this averaged amplitude equation are found by setting $\\langle\\dot{r}\\rangle = 0$. This gives two solutions:\n$1$. $r = 0$, which is the trivial fixed point corresponding to the equilibrium at the origin.\n$2$. $4\\alpha - r^{2}(\\beta + 3\\gamma) = 0$, which corresponds to a nonzero amplitude of a limit cycle.\n\nWe solve the second case for $r$:\n$$\nr^{2}(\\beta + 3\\gamma) = 4\\alpha\n$$\n$$\nr^{2} = \\frac{4\\alpha}{\\beta + 3\\gamma}\n$$\nSince amplitude $r$ must be positive, we take the positive square root:\n$$\nr = \\sqrt{\\frac{4\\alpha}{\\beta + 3\\gamma}} = 2\\sqrt{\\frac{\\alpha}{\\beta + 3\\gamma}}\n$$\nThe problem states that $\\alpha > 0$ and $\\beta + 3\\gamma > 0$, which guarantees that the expression under the square root is positive and well-defined, leading to a real, finite amplitude for the limit cycle. A stability analysis of the fixed point confirms it is stable, as the derivative of the right-hand side with respect to $r$, evaluated at this fixed point, is $-\\varepsilon\\alpha$, which is negative. This confirms that it represents a stable limit cycle.", "answer": "$$\\boxed{2\\sqrt{\\frac{\\alpha}{\\beta + 3\\gamma}}}$$", "id": "2731668"}, {"introduction": "A deep understanding of nonlinear systems often involves synthesizing insights from different analytical frameworks, such as absolute stability criteria and methods for predicting oscillations. In this challenging exercise [@problem_id:2731651], you will explore a system poised at the very edge of stability as determined by the Circle Criterion, and then use the Describing Function method to predict the properties of the limit cycle that emerges. This practice illuminates the powerful connection between these two cornerstone concepts in nonlinear control, showing how they provide a more complete picture of system behavior.", "problem": "Consider a Light-Utilization with Restricted-Element (Lur’e) feedback interconnection consisting of a stable, strictly proper, single-input single-output linear time-invariant plant and a static, odd, memoryless nonlinearity in the forward path with unity negative feedback. The plant is\n$$\nG(s) \\;=\\; \\frac{K}{\\,s\\left(1+\\frac{s}{\\omega_{p}}\\right)^{2}}\\,,\n$$\nwhere $K > 0$ and $\\omega_{p} > 0$ are real parameters, and the nonlinearity is the symmetric saturation\n$$\n\\varphi(e) \\;=\\; \\begin{cases}\nM\\,\\mathrm{sign}(e),  |e|\\ge M \\\\[4pt]\ne,  |e|  M,\n\\end{cases}\n$$\nwith $M > 0$. This nonlinearity is sector-bounded in the sector $\\left[0,1\\right]$.\n\n1) Using fundamental definitions of the Nyquist plot and the circle criterion for sector-bounded nonlinearities, show that for the choice $K = 2\\,\\omega_{p}$, the Nyquist locus of $G(j\\omega)$ touches the boundary of the circle criterion exclusion region corresponding to the sector $\\left[0,1\\right]$ at exactly one frequency, and that this touching occurs at the frequency where the open-loop phase is $-\\pi$ radians.\n\n2) Starting from the Fourier-series definition of the describing function for an odd, memoryless nonlinearity, derive the real describing function $N(A)$ for the given symmetric saturation nonlinearity, expressed in terms of the sinusoidal input amplitude $A$ and the limit $M$.\n\n3) Using the harmonic balance condition for self-excited oscillations, $G(j\\omega) N(A) \\approx -1$, determine the oscillation amplitude $A^{\\star}$ and angular frequency $\\omega^{\\star}$ predicted by the describing function method for the marginal case $K = 2\\,\\omega_{p}$ constructed in part (1). You must show your reasoning from first principles, including the phase and magnitude conditions for harmonic balance.\n\nExpress $\\omega^{\\star}$ in radians per second. Report your final result as a row matrix $\\bigl(A^{\\star},\\,\\omega^{\\star}\\bigr)$. No numerical rounding is required; give your answer in closed form.", "solution": "The posed problem will be analyzed in three parts as requested, following a critical validation of its premises.\n\nThe problem is determined to be valid, despite a minor linguistic imprecision in Part 1. The term \"touches\" is interpreted in the sense of \"intersects,\" as a formal analysis of tangency shows no such point exists. The problem is a standard exercise in nonlinear control theory, covering the circle criterion and the describing function method, and all provided data and conditions are scientifically sound, consistent, and sufficient for a unique solution under a standard convention.\n\n**Part 1: Analysis using the Circle Criterion**\n\nThe system consists of a linear time-invariant (LTI) plant $G(s)$ and a static nonlinearity $\\varphi(e)$ in a unity negative feedback loop. The nonlinearity $\\varphi(e)$ is a symmetric saturation function, which has a slope of $1$ for $|e|  M$ and $0$ for $|e|  M$. The function value $\\varphi(e)$ divided by its input $e$ is always in the range $[0, 1]$. Thus, the nonlinearity belongs to the sector $[k_1, k_2] = [0, 1]$.\n\nThe circle criterion for absolute stability of a system with a sector-bounded nonlinearity in $[k_1, k_2]=[0,1]$ requires that the Nyquist plot of the LTI element, $G(j\\omega)$, for $\\omega \\in (0, \\infty)$, must not enter the exclusion region. For the sector $[0, 1]$, this exclusion region is the half-plane to the left of the vertical line $\\text{Re}(z) = -1/k_2 = -1$. The boundary of this region is the line $\\text{Re}(z) = -1$.\n\nThe problem asks to show that for $K = 2\\omega_p$, the Nyquist locus $G(j\\omega)$ intersects this boundary at a single frequency, and that this is the frequency where the phase is $-\\pi$ radians.\n\nFirst, we determine the phase crossover frequency, $\\omega_{pc}$, where the phase of $G(j\\omega)$ is $-\\pi$.\nThe plant transfer function is $G(s) = \\frac{K}{s(1+s/\\omega_p)^2}$.\nThe phase is given by:\n$$\n\\angle G(j\\omega) = \\angle(K) - \\angle(j\\omega) - 2\\angle(1+j\\omega/\\omega_p) = 0 - \\frac{\\pi}{2} - 2\\arctan\\left(\\frac{\\omega}{\\omega_p}\\right)\n$$\nSetting the phase to $-\\pi$:\n$$\n-\\frac{\\pi}{2} - 2\\arctan\\left(\\frac{\\omega_{pc}}{\\omega_p}\\right) = -\\pi\n$$\n$$\n-2\\arctan\\left(\\frac{\\omega_{pc}}{\\omega_p}\\right) = -\\frac{\\pi}{2}\n$$\n$$\n\\arctan\\left(\\frac{\\omega_{pc}}{\\omega_p}\\right) = \\frac{\\pi}{4}\n$$\nThis yields $\\frac{\\omega_{pc}}{\\omega_p} = \\tan(\\frac{\\pi}{4}) = 1$, so the phase crossover frequency is $\\omega^\\star = \\omega_{pc} = \\omega_p$.\n\nNext, we evaluate the transfer function $G(j\\omega)$ at this frequency, $\\omega = \\omega_p$, using the specified parameter condition $K=2\\omega_p$:\n$$\nG(j\\omega_p) = \\frac{K}{j\\omega_p(1+j\\omega_p/\\omega_p)^2} = \\frac{K}{j\\omega_p(1+j)^2} = \\frac{K}{j\\omega_p(1 + 2j - 1)} = \\frac{K}{j\\omega_p(2j)} = \\frac{K}{-2\\omega_p}\n$$\nSubstituting $K = 2\\omega_p$:\n$$\nG(j\\omega_p) = \\frac{2\\omega_p}{-2\\omega_p} = -1\n$$\nThis result, $G(j\\omega_p)=-1+j0$, demonstrates that the Nyquist locus passes through the point $(-1, 0)$ at the frequency $\\omega_p$. This point lies on the exclusion boundary $\\text{Re}(z) = -1$.\n\nFinally, we must show that this intersection occurs at *exactly one* frequency. We derive the real part of $G(j\\omega)$:\n$$\nG(j\\omega) = \\frac{K}{j\\omega(1-\\omega^2/\\omega_p^2 + 2j\\omega/\\omega_p)} = \\frac{K}{-2\\omega^2/\\omega_p + j\\omega(1-\\omega^2/\\omega_p^2)}\n$$\nMultiplying the numerator and denominator by the complex conjugate of the denominator gives:\n$$\n\\text{Re}[G(j\\omega)] = \\frac{K(-2\\omega^2/\\omega_p)}{(-2\\omega^2/\\omega_p)^2 + \\omega^2(1-\\omega^2/\\omega_p^2)^2} = \\frac{-2K\\omega^2/\\omega_p}{\\omega^2(1+\\omega^2/\\omega_p^2)^2} = \\frac{-2K/\\omega_p}{(1+\\omega^2/\\omega_p^2)^2}\n$$\nWe seek the frequencies $\\omega$ where $\\text{Re}[G(j\\omega)] = -1$. Using $K=2\\omega_p$:\n$$\n\\frac{-2(2\\omega_p)/\\omega_p}{(1+\\omega^2/\\omega_p^2)^2} = -1 \\implies \\frac{-4}{(1+\\omega^2/\\omega_p^2)^2} = -1\n$$\n$$\n(1+\\omega^2/\\omega_p^2)^2 = 4\n$$\nSince $1+\\omega^2/\\omega_p^2$ must be positive, we take the positive square root:\n$$\n1+\\frac{\\omega^2}{\\omega_p^2} = 2 \\implies \\frac{\\omega^2}{\\omega_p^2} = 1\n$$\nFor $\\omega > 0$, the only solution is $\\omega=\\omega_p$. This confirms that the Nyquist locus intersects the boundary of the circle criterion exclusion region at exactly one frequency, $\\omega_p$, which is the phase crossover frequency.\n\n**Part 2: Derivation of the Describing Function**\n\nThe describing function $N(A)$ for an odd, memoryless nonlinearity $\\varphi(e)$ with a sinusoidal input $e(t) = A\\sin(\\omega t)$ is the ratio of the amplitude of the fundamental frequency component of the output to the input amplitude $A$. It is given by:\n$$\nN(A) = \\frac{1}{\\pi A} \\int_0^{2\\pi} \\varphi(A\\sin\\theta)\\sin\\theta \\, d\\theta\n$$\nwhere $\\theta = \\omega t$.\nFor the given saturation nonlinearity, we have two cases based on the input amplitude $A$.\n\nCase 1: $A \\le M$. The input amplitude is never large enough to cause saturation. Thus, $\\varphi(e) = e$, and $\\varphi(A\\sin\\theta) = A\\sin\\theta$.\n$$\nN(A) = \\frac{1}{\\pi A} \\int_0^{2\\pi} (A\\sin\\theta)\\sin\\theta \\, d\\theta = \\frac{1}{\\pi} \\int_0^{2\\pi} \\sin^2\\theta \\, d\\theta = \\frac{1}{\\pi} \\left[ \\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4} \\right]_0^{2\\pi} = 1\n$$\n\nCase 2: $A > M$. Saturation occurs. The output is linear when $|A\\sin\\theta|  M$ and is clipped to $\\pm M$ when $|A\\sin\\theta| \\ge M$. Let $\\alpha = \\arcsin(M/A)$, where $0  \\alpha  \\pi/2$. Due to symmetry, we can integrate over one quadrant and multiply by four:\n$$\nN(A) = \\frac{4}{\\pi A} \\int_0^{\\pi/2} \\varphi(A\\sin\\theta)\\sin\\theta \\, d\\theta\n$$\nThe integral is split at $\\theta=\\alpha$:\n- For $0 \\le \\theta  \\alpha$, $A\\sin\\theta  M$, so $\\varphi(A\\sin\\theta) = A\\sin\\theta$.\n- For $\\alpha \\le \\theta \\le \\pi/2$, $A\\sin\\theta \\ge M$, so $\\varphi(A\\sin\\theta) = M$.\n$$\nN(A) = \\frac{4}{\\pi A} \\left[ \\int_0^\\alpha (A\\sin^2\\theta) \\, d\\theta + \\int_\\alpha^{\\pi/2} M\\sin\\theta \\, d\\theta \\right]\n$$\nWe evaluate the integrals:\n$$\n\\int_0^\\alpha A\\sin^2\\theta \\, d\\theta = A\\left[ \\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4} \\right]_0^\\alpha = \\frac{A}{2}(\\alpha - \\sin\\alpha\\cos\\alpha)\n$$\n$$\n\\int_\\alpha^{\\pi/2} M\\sin\\theta \\, d\\theta = M[-\\cos\\theta]_\\alpha^{\\pi/2} = M\\cos\\alpha\n$$\nSubstituting these back:\n$$\nN(A) = \\frac{4}{\\pi A} \\left[ \\frac{A}{2}(\\alpha - \\sin\\alpha\\cos\\alpha) + M\\cos\\alpha \\right] = \\frac{2}{\\pi}(\\alpha - \\sin\\alpha\\cos\\alpha) + \\frac{4M}{\\pi A}\\cos\\alpha\n$$\nUsing $\\sin\\alpha = M/A$ and $\\cos\\alpha = \\sqrt{1-(M/A)^2} = \\frac{\\sqrt{A^2-M^2}}{A}$:\n$$\nN(A) = \\frac{2}{\\pi}\\left(\\alpha - \\frac{M}{A}\\frac{\\sqrt{A^2-M^2}}{A}\\right) + \\frac{4M}{\\pi A}\\frac{\\sqrt{A^2-M^2}}{A} = \\frac{2\\alpha}{\\pi} + \\frac{2M\\sqrt{A^2-M^2}}{\\pi A^2}\n$$\nSo, the full describing function is:\n$$\nN(A) = \\begin{cases} 1,  A \\le M \\\\ \\frac{2}{\\pi}\\left( \\arcsin\\left(\\frac{M}{A}\\right) + \\frac{M\\sqrt{A^2-M^2}}{A^2} \\right),  A > M \\end{cases}\n$$\n\n**Part 3: Harmonic Balance Analysis**\n\nThe describing function method predicts self-excited oscillations (limit cycles) at an amplitude $A^\\star$ and frequency $\\omega^\\star$ that satisfy the harmonic balance equation:\n$$\n1 + G(j\\omega^\\star) N(A^\\star) = 0 \\quad \\text{or} \\quad G(j\\omega^\\star) = -\\frac{1}{N(A^\\star)}\n$$\nSince the describing function $N(A)$ for saturation is purely real and positive, the right side of the equation, $-1/N(A^\\star)$, is a negative real number. This imposes two conditions:\n1. Phase condition: $\\angle G(j\\omega^\\star) = -\\pi$.\n2. Magnitude condition: $|G(j\\omega^\\star)| = 1/N(A^\\star)$.\n\nFrom Part 1, we know that for the case $K=2\\omega_p$, the phase condition is met at a unique frequency $\\omega^\\star = \\omega_p$.\nAt this frequency, we also found that $|G(j\\omega_p)|=|-1|=1$.\n\nSubstituting these into the magnitude condition:\n$$\n1 = \\frac{1}{N(A^\\star)} \\implies N(A^\\star) = 1\n$$\nWe now consult the expression for $N(A)$ from Part 2 to find the amplitude $A^\\star$ for which $N(A^\\star)=1$.\nFrom the derivation, we found that $N(A)=1$ for all amplitudes $A \\le M$. For $A>M$, the function $N(A)$ is strictly decreasing from $1$ towards $0$.\nTherefore, the condition $N(A^\\star)=1$ is satisfied for any amplitude $A^\\star$ in the interval $(0, M]$.\n\nThis result indicates a neutrally stable family of oscillations. The linear system with gain $K=2\\omega_p$ is marginally stable with poles at $\\pm j\\omega_p$. Any oscillation with amplitude up to $M$ behaves as a purely linear phenomenon. A limit cycle, in the context of nonlinear dynamics, is typically understood as an oscillation whose amplitude is determined and stabilized by the nonlinearity. The smallest amplitude at which the nonlinearity is engaged is $A=M$. For any amplitude greater than this, the effective gain $N(A)$ would drop below $1$, damping the oscillation. Therefore, the sustained oscillation is predicted at the boundary of the linear region. We select the maximal amplitude from the valid range.\n\nThus, the predicted amplitude is $A^\\star = M$.\nThe predicted oscillation frequency is $\\omega^\\star = \\omega_p$.\nThe result is the pair $(A^\\star, \\omega^\\star)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} M  \\omega_{p} \\end{pmatrix}\n}\n$$", "id": "2731651"}, {"introduction": "Beyond analytical techniques for continuous-time systems, the computational exploration of discrete-time maps offers a window into more complex phenomena like frequency locking and chaos. This hands-on computational problem [@problem_id:2731669] uses the canonical circle map to investigate how a nonlinear system responds to periodic forcing, a phenomenon central to fields from physics to biology. By numerically generating the 'Devil's staircase,' you will visualize the intricate structure of frequency-locked regions, known as Arnold tongues, and gain practical experience in the computational analysis of nonlinear dynamics.", "problem": "Consider the discrete-time circle map defined by the lifted dynamics\n$$\nx_{k+1} \\;=\\; x_k \\;+\\; \\Omega \\;-\\; \\frac{K}{2\\pi}\\,\\sin(2\\pi x_k),\n$$\nwhere $x_k \\in \\mathbb{R}$, $K \\ge 0$ is the nonlinearity parameter, and $\\Omega \\in [0,1]$ is a normalized forcing frequency. The physical phase on the circle is $\\theta_k = x_k \\bmod 1$. The rotation number is defined by the limit\n$$\n\\rho(K,\\Omega) \\;=\\; \\lim_{n\\to\\infty} \\frac{x_n - x_0}{n},\n$$\nwhich exists for this system under broad conditions and is independent of $x_0$ for ergodic regimes. As a function of $\\Omega$ (for fixed $K$), the map $\\Omega \\mapsto \\rho(K,\\Omega)$ is known to form a nondecreasing staircase whose plateaus indicate frequency locking (also called mode locking), where $\\rho$ takes rational values $p/q$ over nonzero intervals of $\\Omega$. This fractal monotone function is often called the Devil’s staircase.\n\nYour task is to numerically approximate $\\rho(K,\\Omega)$ over a grid of $\\Omega$ values for several fixed $K$ values, detect frequency-locked plateaus where $\\rho$ is rational with small denominator, and measure plateau widths. Use only the definition of the rotation number via the lifted dynamics and basic numerical iteration.\n\nUse the following numerical procedure and detection criteria.\n\n- For each pair $(K,\\Omega)$ on a specified grid, approximate the rotation number by iterating the lifted map starting from $x_0=0$:\n  1. Run a transient of $N_{\\mathrm{tr}}$ steps to reduce sensitivity to initial conditions.\n  2. Then run $N_{\\mathrm{avg}}$ steps and compute\n     $$\n     \\widehat{\\rho}(K,\\Omega) \\;=\\; \\frac{x_{N_{\\mathrm{tr}}+N_{\\mathrm{avg}}} - x_{N_{\\mathrm{tr}}}}{N_{\\mathrm{avg}}}.\n     $$\n- To identify frequency locking at a given $(K,\\Omega)$, approximate $\\widehat{\\rho}$ by a rational $p/q$ with $1 \\le q \\le q_{\\max}$ using best rational approximation (for example, continued fractions). Declare the point locked if\n  $$\n  \\left| \\widehat{\\rho}(K,\\Omega) - \\frac{p}{q} \\right| \\le \\varepsilon_{\\mathrm{lock}},\n  $$\n  and record the label $(p,q)$.\n- To identify a plateau for a given $K$ and a sweep of $\\Omega$ values, find contiguous runs of $\\Omega$ where all points are locked with the same $(p,q)$. The plateau width is the difference between the largest and smallest $\\Omega$ in the run. Accept a plateau if it contains at least $m_{\\min}$ grid points and has width at least $w_{\\min}$.\n\nAdopt the following fixed numerical settings for all computations in this problem:\n- Use $N_{\\mathrm{tr}} = 1500$, $N_{\\mathrm{avg}} = 3000$.\n- Use a uniform grid of $\\Omega$ in $[0,1]$ with $N_{\\Omega} = 401$ points (including endpoints), that is, step size $1/400$.\n- Use $q_{\\max} = 8$, locking tolerance $\\varepsilon_{\\mathrm{lock}} = 5\\times 10^{-4}$, minimum plateau width $w_{\\min} = 0.01$, and minimum plateau points $m_{\\min} = 3$.\n- Use $x_0 = 0$ for all runs.\n\nTest Suite.\nYou must evaluate the following four test cases, each defined by $(K,\\Omega_{\\min},\\Omega_{\\max},N_{\\Omega},q_{\\max},w_{\\min})$:\n1. $K = 0.0$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8$, $w_{\\min} = 0.01$.\n2. $K = 0.5$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8$, $w_{\\min} = 0.01$.\n3. $K = 1.0$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8$, $w_{\\min} = 0.01$.\n4. $K = 1.2$, $\\Omega_{\\min} = 0.0$, $\\Omega_{\\max} = 1.0$, $N_{\\Omega} = 401$, $q_{\\max} = 8$, $w_{\\min} = 0.01$.\n\nFor each test case, your program must:\n- Compute the list of accepted plateaus for the given $K$ over the grid of $\\Omega$.\n- Return three outputs per test case:\n  1. The integer total number of accepted plateaus.\n  2. A boolean indicating whether the $1:2$ locked plateau (that is, $\\rho = 1/2$) is present among the accepted plateaus.\n  3. The width of the widest accepted plateau as a real number rounded to $4$ decimal places.\n\nFinal Output Format.\nYour program should produce a single line of output containing the results for the four test cases as a comma-separated list of lists enclosed in square brackets. Each inner list corresponds to one test case in the order above and must have the form $[\\text{count},\\text{bool},\\text{width}]$, for example:\n$[[3,True,0.1250],[\\dots],[\\dots],[\\dots]]$.\nNo units are involved in this problem. Angles inside the sine function are in radians by definition of the map. All floating-point outputs must be rounded to $4$ decimal places as specified above before printing.", "solution": "The problem requires a numerical investigation of the standard circle map, a fundamental model in the study of nonlinear dynamical systems and frequency-locking phenomena. The objective is to approximate the rotation number $\\rho(K,\\Omega)$ across a grid of forcing frequencies $\\Omega$ for several values of the nonlinearity parameter $K$, and to identify and characterize the frequency-locked plateaus, known as Arnold tongues.\n\nThe solution is constructed by directly implementing the procedures specified in the problem statement. The methodology follows a hierarchical structure based on first principles.\n\nAt the core of the analysis is the rotation number, defined as $\\rho = \\lim_{n\\to\\infty} (x_n - x_0)/n$. This quantity measures the average asymptotic rate of change of the system's phase. We are instructed to compute a numerical approximation, $\\widehat{\\rho}$, by iterating the lifted map:\n$$\nx_{k+1} = x_k + \\Omega - \\frac{K}{2\\pi}\\sin(2\\pi x_k)\n$$\nThe calculation for each pair $(K, \\Omega)$ begins with $x_0 = 0$. The first $N_{\\mathrm{tr}} = 1500$ iterations are discarded as a transient phase to ensure the system has settled onto its attractor. The subsequent $N_{\\mathrm{avg}} = 3000$ iterations are used to compute the average frequency:\n$$\n\\widehat{\\rho}(K,\\Omega) = \\frac{x_{N_{\\mathrm{tr}}+N_{\\mathrm{avg}}} - x_{N_{\\mathrm{tr}}}}{N_{\\mathrm{avg}}}\n$$\nThis procedure is systematically applied to every point on a uniform grid of $N_{\\Omega} = 401$ values of $\\Omega$ in the interval $[0,1]$ for each specified test case $K$.\n\nOnce $\\widehat{\\rho}$ is computed for a given $\\Omega$, the next step is to test for frequency locking. This is a classification task. A point is deemed locked if its numerically computed rotation number is sufficiently close to a simple rational number. This is implemented via a two-step process:\n1.  **Best Rational Approximation**: For each $\\widehat{\\rho}$, we find the best rational approximation $p/q$ where the denominator $q$ does not exceed a maximum value, $q_{\\max} = 8$. This is accomplished algorithmically using the method of continued fractions, which is efficiently implemented in standard libraries.\n2.  **Locking Condition**: The point $(\\Omega, \\widehat{\\rho})$ is classified as locked with rational number $p/q$ if the absolute difference between the computed rotation number and its rational approximation is within a specified tolerance:\n    $$\n    \\left| \\widehat{\\rho}(K,\\Omega) - \\frac{p}{q} \\right| \\le \\varepsilon_{\\mathrm{lock}}\n    $$\n    where $\\varepsilon_{\\mathrm{lock}} = 5 \\times 10^{-4}$. If this condition is met, the state is labeled with the pair $(p,q)$; otherwise, it is considered unlocked.\n\nAfter all points on the $\\Omega$-grid for a given $K$ have been classified, the resulting sequence of labels is scanned to identify plateaus. A plateau is defined as a contiguous sub-sequence of grid points that are all locked to the identical rational number $(p,q)$.\n\nEach identified potential plateau is then subjected to validation criteria to filter out spurious or insignificant results. A segment is accepted as a valid plateau only if it satisfies both of the following conditions:\n- It must comprise at least $m_{\\min} = 3$ consecutive grid points.\n- The span of the $\\Omega$ values in the segment, defined as $\\Omega_{\\max} - \\Omega_{\\min}$ for that segment, must be at least $w_{\\min} = 0.01$.\n\nFinally, for each value of $K$, the set of accepted plateaus is analyzed to extract the required summary metrics:\n1.  The total count of accepted plateaus.\n2.  A Boolean flag indicating whether a plateau corresponding to the $1:2$ frequency lock ($\\rho = 1/2$) is present in the accepted set.\n3.  The width of the widest plateau found, rounded to four decimal places. For the case of no accepted plateaus, this width is reported as $0$.\n\nThis entire computational procedure is encapsulated in a program that iterates through the four specified values of $K$, performs the analysis for each, and formats the final results into a single line of output as required. The case $K=0$ serves as a baseline, where the map is linear ($x_{k+1} = x_k + \\Omega$) and thus $\\rho=\\Omega$. In this linear case, true plateaus cannot form, and the specified validation criteria correctly filter out any artifacts from the rational approximation process, as expected. For $K>0$, the nonlinearity induces true frequency-locking, and the algorithm is designed to detect and measure the resulting plateaus.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom fractions import Fraction\n\ndef solve():\n    \"\"\"\n    Solves the circle map problem by numerically approximating rotation numbers,\n    detecting frequency-locked plateaus, and reporting statistics for several\n    nonlinearity parameters K.\n    \"\"\"\n    # Define the fixed numerical settings from the problem statement.\n    N_TR = 1500\n    N_AVG = 3000\n    EPS_LOCK = 5e-4\n    M_MIN = 3\n    X0 = 0.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (K, Omega_min, Omega_max, N_Omega, q_max, w_min)\n        (0.0, 0.0, 1.0, 401, 8, 0.01),\n        (0.5, 0.0, 1.0, 401, 8, 0.01),\n        (1.0, 0.0, 1.0, 401, 8, 0.01),\n        (1.2, 0.0, 1.0, 401, 8, 0.01),\n    ]\n\n    all_case_results = []\n    for K, omega_min, omega_max, n_omega, q_max, w_min in test_cases:\n        # Create the grid of Omega values.\n        omega_grid = np.linspace(omega_min, omega_max, n_omega)\n        locked_states = []\n\n        # Pre-compute the K-dependent term for efficiency.\n        k_term = K / (2 * np.pi)\n\n        # Iterate over each Omega to compute rho_hat and determine its locked state.\n        for omega in omega_grid:\n            x = X0\n            \n            # 1. Iterate the map to compute rho_hat.\n            # Transient steps.\n            for _ in range(N_TR):\n                x = x + omega - k_term * np.sin(2 * np.pi * x)\n            \n            x_transient = x\n            \n            # Averaging steps.\n            for _ in range(N_AVG):\n                x = x + omega - k_term * np.sin(2 * np.pi * x)\n            \n            x_final = x\n            \n            rho_hat = (x_final - x_transient) / N_AVG\n            \n            # 2. Find best rational approximation p/q.\n            frac = Fraction(rho_hat).limit_denominator(q_max)\n            p, q = frac.numerator, frac.denominator\n            \n            # 3. Check for frequency locking.\n            if abs(rho_hat - p / q) = EPS_LOCK and q >= 1:\n                locked_states.append((p, q))\n            else:\n                locked_states.append(None)\n        \n        # 4. Identify and validate plateaus from contiguous locked states.\n        accepted_plateaus = []\n        i = 0\n        while i  n_omega:\n            current_state = locked_states[i]\n            if current_state is None:\n                i += 1\n                continue\n            \n            # A potential plateau starts at index i.\n            start_index = i\n            j = i + 1\n            while j  n_omega and locked_states[j] == current_state:\n                j += 1\n            end_index = j - 1\n            \n            # Apply validation criteria for the identified segment.\n            num_points = end_index - start_index + 1\n            if num_points >= M_MIN:\n                width = omega_grid[end_index] - omega_grid[start_index]\n                if width >= w_min:\n                    p_val, q_val = current_state\n                    plateau_info = {'p': p_val, 'q': q_val, 'width': width}\n                    accepted_plateaus.append(plateau_info)\n            \n            i = j  # Continue search from the end of the current segment.\n        \n        # 5. Compute the required output metrics for the current test case.\n        count = len(accepted_plateaus)\n        has_1_2 = any(p['p'] == 1 and p['q'] == 2 for p in accepted_plateaus)\n        \n        max_width = 0.0\n        if accepted_plateaus:\n            max_width = max(p['width'] for p in accepted_plateaus)\n            \n        all_case_results.append([count, has_1_2, max_width])\n    \n    # Final print statement in the exact required format.\n    result_strings = []\n    for count, has_bool, width in all_case_results:\n        bool_str = 'True' if has_bool else 'False'\n        width_str = f\"{round(width, 4):.4f}\" # Round then format\n        result_strings.append(f\"[{count},{bool_str},{width_str}]\")\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2731669"}]}