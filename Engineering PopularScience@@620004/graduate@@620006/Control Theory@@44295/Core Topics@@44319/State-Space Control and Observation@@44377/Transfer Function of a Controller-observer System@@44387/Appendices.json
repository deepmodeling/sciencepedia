{"hands_on_practices": [{"introduction": "A cornerstone of observer-based control is the separation principle, which allows the controller and observer to be designed independently. This exercise provides a foundational proof from first principles, demonstrating how the closed-loop transfer function from a reference input $r(t)$ to the plant output $y(t)$ is determined solely by the state-feedback gain $K$ and is independent of the observer gain $L$. By working through this derivation [@problem_id:2755501], you will solidify your understanding of why, under ideal zero initial condition assumptions, the observer's dynamics do not influence the system's reference-tracking behavior.", "problem": "Consider the single-input single-output linear time-invariant plant described by the state-space equations\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\nwith\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -3 & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad D = 0.$$\nThe plant is controlled by a dynamic output-feedback controller formed by a full-state observer (Luenberger observer) and a state-feedback law. The observer is\n$$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - \\hat{y}(t)\\big), \\quad \\hat{y}(t) = C \\hat{x}(t),$$\nwith observer gain\n$$L = \\begin{pmatrix} 46 \\\\ 413 \\end{pmatrix},$$\nand the control input is\n$$u(t) = -K \\hat{x}(t) + N r(t), \\quad K = \\begin{pmatrix} 7 & 3 \\end{pmatrix},$$\nwhere $r(t)$ is the reference input and $N$ is a scalar prefilter chosen to achieve unit steady-state tracking for a step reference under ideal conditions. Assume zero initial conditions $x(0) = 0$ and $\\hat{x}(0) = 0$.\n\nUsing only the definitions of the Laplace transform for linear time-invariant systems and the state-space representation of the controller-observer interconnection, do the following:\n\n1. Derive the closed-loop reference-to-output transfer function $T_{yr}(s) = \\frac{Y(s)}{R(s)}$ explicitly in terms of the given matrices and gains, and determine the value of the prefilter $N$ that yields unit steady-state gain for a unit step reference $r(t) = 1$ for $t \\ge 0$.\n2. Compute the time-domain response $y(t)$ for $t \\ge 0$ to the unit step reference by performing an inverse Laplace transform of $T_{yr}(s)\\frac{1}{s}$.\n3. Briefly discuss, from first principles of the closed-loop state-space formulation, why the observer poles do not affect this reference-tracking response in the ideal case specified by the initial conditions.\n\nProvide your final answer as a single closed-form expression for $y(t)$ for $t \\ge 0$. No numerical rounding is required, and no physical units are needed.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard problem in linear control theory and contains sufficient information for a unique, verifiable solution. We will proceed with the derivation and calculation.\n\nThe system is described by the plant equations:\n$$ \\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t) $$\nand the observer-based controller:\n$$ \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C\\hat{x}(t)) $$\n$$ u(t) = -K \\hat{x}(t) + N r(t) $$\nTo analyze the closed-loop system, we introduce the state estimation error $e(t) = x(t) - \\hat{x}(t)$. The derivative of the error is:\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = [A x(t) + B u(t)] - [A \\hat{x}(t) + B u(t) + L(C x(t) - C \\hat{x}(t))] $$\n$$ \\dot{e}(t) = A(x(t) - \\hat{x}(t)) - LC(x(t) - \\hat{x}(t)) = (A - LC)e(t) $$\nThe control input $u(t)$ can be expressed in terms of $x(t)$ and $e(t)$:\n$$ u(t) = -K \\hat{x}(t) + N r(t) = -K(x(t) - e(t)) + N r(t) = -K x(t) + K e(t) + N r(t) $$\nSubstituting this into the plant state equation gives:\n$$ \\dot{x}(t) = A x(t) + B(-K x(t) + K e(t) + N r(t)) = (A - BK)x(t) + BK e(t) + BN r(t) $$\nWe can now write the full closed-loop dynamics using the augmented state vector $\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$:\n$$ \\frac{d}{dt} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} + \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix} r(t) $$\n$$ y(t) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} $$\nThe system matrix is block upper-triangular, which exemplifies the separation principle: the closed-loop eigenvalues are the union of the eigenvalues of the state-feedback regulator, given by $\\det(sI - (A-BK)) = 0$, and the eigenvalues of the observer, given by $\\det(sI - (A-LC)) = 0$.\n\nTaking the Laplace transform of the augmented system, with initial conditions $x(0)=0$ and $\\hat{x}(0)=0$ (which implies $e(0) = x(0) - \\hat{x}(0) = 0$), we get:\n$$ s \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} + \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix} R(s) $$\nThis decouples into two equations:\n$$ s X(s) = (A-BK)X(s) + BK E(s) + BN R(s) $$\n$$ s E(s) = (A-LC)E(s) $$\nFrom the second equation, $(sI - (A-LC))E(s) = e(0)$. Since $e(0)=0$, we have $E(s)=0$ for all $s$ for which $(sI-(A-LC))$ is invertible. This means the error state remains zero for all time.\nThe first equation thus simplifies to:\n$$ s X(s) = (A-BK)X(s) + BN R(s) $$\n$$ (sI - (A-BK))X(s) = BN R(s) \\implies X(s) = (sI - (A-BK))^{-1} BN R(s) $$\nThe output is $Y(s) = C X(s)$. Therefore, the transfer function $T_{yr}(s) = Y(s)/R(s)$ is:\n$$ T_{yr}(s) = N C(sI - (A-BK))^{-1} B $$\nThis answers the first part of the question regarding the form of the transfer function. We now substitute the given matrices:\n$A = \\begin{pmatrix} 0 & 1 \\\\ -3 & -4 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$, $K = \\begin{pmatrix} 7 & 3 \\end{pmatrix}$.\nFirst, calculate $A-BK$:\n$$ BK = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 7 & 3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 7 & 3 \\end{pmatrix} $$\n$$ A-BK = \\begin{pmatrix} 0 & 1 \\\\ -3 & -4 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ 7 & 3 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -10 & -7 \\end{pmatrix} $$\nNow, find $(sI - (A-BK))^{-1}$:\n$$ sI - (A-BK) = \\begin{pmatrix} s & -1 \\\\ 10 & s+7 \\end{pmatrix} $$\n$$ \\det(sI - (A-BK)) = s(s+7) - (10)(-1) = s^2 + 7s + 10 $$\n$$ (sI - (A-BK))^{-1} = \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} $$\nNow, we compute $C(sI - (A-BK))^{-1} B$:\n$$ C(sI - (A-BK))^{-1} B = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n$$ = \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{s^2+7s+10} $$\nThe transfer function is $T_{yr}(s) = \\frac{N}{s^2+7s+10}$.\nTo achieve unit steady-state gain for a step input, the DC gain must be $1$. We use the Final Value Theorem, which states that for a stable system, the steady-state value is $\\lim_{s \\to 0} s Y(s) = \\lim_{s \\to 0} s T_{yr}(s) \\frac{1}{s} = T_{yr}(0)$.\n$$ T_{yr}(0) = \\frac{N}{0^2+7(0)+10} = \\frac{N}{10} $$\nSetting $T_{yr}(0) = 1$ yields $\\frac{N}{10} = 1$, so $N=10$.\nThe closed-loop transfer function is $T_{yr}(s) = \\frac{10}{s^2+7s+10}$.\n\nFor the second task, we compute the time-domain response $y(t)$ for a unit step reference $r(t)=1$ for $t \\ge 0$, which means $R(s) = \\frac{1}{s}$.\n$$ Y(s) = T_{yr}(s) R(s) = \\frac{10}{s^2+7s+10} \\cdot \\frac{1}{s} = \\frac{10}{s(s+2)(s+5)} $$\nWe use partial fraction expansion:\n$$ Y(s) = \\frac{A_{pfe}}{s} + \\frac{B_{pfe}}{s+2} + \\frac{C_{pfe}}{s+5} $$\nThe coefficients are found using the residue method:\n$$ A_{pfe} = \\lim_{s \\to 0} s Y(s) = \\lim_{s \\to 0} \\frac{10}{(s+2)(s+5)} = \\frac{10}{(2)(5)} = 1 $$\n$$ B_{pfe} = \\lim_{s \\to -2} (s+2) Y(s) = \\lim_{s \\to -2} \\frac{10}{s(s+5)} = \\frac{10}{(-2)(3)} = -\\frac{5}{3} $$\n$$ C_{pfe} = \\lim_{s \\to -5} (s+5) Y(s) = \\lim_{s \\to -5} \\frac{10}{s(s+2)} = \\frac{10}{(-5)(-3)} = \\frac{10}{15} = \\frac{2}{3} $$\nThus,\n$$ Y(s) = \\frac{1}{s} - \\frac{5}{3} \\frac{1}{s+2} + \\frac{2}{3} \\frac{1}{s+5} $$\nTaking the inverse Laplace transform gives the time response for $t \\ge 0$:\n$$ y(t) = 1 - \\frac{5}{3}\\exp(-2t) + \\frac{2}{3}\\exp(-5t) $$\n\nFinally, for the third task, we explain why the observer poles do not affect the reference-tracking response. The response of the system to both an input and initial conditions is given by the full solution to the state equations. In the Laplace domain, for the augmented system $(x, e)$, this is:\n$$ \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = (sI - \\mathcal{A}_{cl})^{-1} \\left( \\begin{pmatrix} x(0) \\\\ e(0) \\end{pmatrix} + \\mathcal{B}_{cl} R(s) \\right) $$\nwhere $\\mathcal{A}_{cl} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix}$ and $\\mathcal{B}_{cl} = \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix}$.\nThe output is $Y(s) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = C X(s)$. We only need to solve for $X(s)$:\n$$ \\begin{pmatrix} sI-(A-BK) & -BK \\\\ 0 & sI-(A-LC) \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = \\begin{pmatrix} x(0)+BNR(s) \\\\ e(0) \\end{pmatrix} $$\nThis gives $(sI-(A-LC))E(s) = e(0)$ and $(sI-(A-BK))X(s) - BK E(s) = x(0)+BNR(s)$.\nSolving for $E(s)$ and $X(s)$:\n$$ E(s) = (sI-(A-LC))^{-1} e(0) $$\n$$ X(s) = (sI-(A-BK))^{-1} (x(0) + BNR(s)) + (sI-(A-BK))^{-1} BK (sI-(A-LC))^{-1} e(0) $$\nThe output is $Y(s) = C X(s)$. The expression for $Y(s)$ has three parts: response to $R(s)$, response to $x(0)$, and response to $e(0)$. The observer poles, which are the poles of $(sI-(A-LC))^{-1}$, only appear in the term multiplied by the initial estimation error $e(0)$.\nThe problem specifies the ideal case where system and observer start from rest: $x(0)=0$ and $\\hat{x}(0)=0$. This implies $e(0) = x(0) - \\hat{x}(0) = 0$. With $x(0)=0$ and $e(0)=0$, the expression for $X(s)$ simplifies to:\n$$ X(s) = (sI-(A-BK))^{-1} BNR(s) $$\nThe resulting output response $Y(s) = C(sI-(A-BK))^{-1} BNR(s)$ depends only on the regulator poles (eigenvalues of $A-BK$) and not on the observer poles (eigenvalues of $A-LC$). The observer modes are not excited because the initial estimation error is zero. This is a direct consequence of the separation principle and the specified zero initial conditions.", "answer": "$$\n\\boxed{1 - \\frac{5}{3}\\exp(-2t) + \\frac{2}{3}\\exp(-5t)}\n$$", "id": "2755501"}, {"introduction": "While the separation principle provides elegant decoupling in an ideal setting, its limitations become apparent when considering real-world imperfections like measurement noise. This practice shifts the focus to the system's response to noise, guiding you to derive the transfer function from sensor noise $v(t)$ to the plant output $y(t)$. This derivation [@problem_id:2755436] reveals that the observer gain $L$ plays a critical role in noise propagation, highlighting a fundamental design trade-off between estimation speed and noise amplification.", "problem": "Consider a strictly proper, Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) plant given in state-space form by the equations\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\nwith\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.$$\nAn observer-based state-feedback controller is implemented with full-order Luenberger observer and static state feedback. The controller uses the measured output\n$$y_{m}(t) = y(t) + v(t),$$\nwhere $v(t)$ is additive measurement noise. The control law and observer are\n$$u(t) = -K \\hat{x}(t), \\quad \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big),$$\nwith gains\n$$K = \\begin{pmatrix} 6 & 4 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}.$$\nAssume zero initial conditions for $x(t)$ and $\\hat{x}(t)$. Using only fundamental state-space relations and the definition of the Luenberger observer, derive the closed-loop transfer function from the measurement noise input $v(t)$ to the plant output $y(t)$. Present your final answer as a single real-rational function of the Laplace variable $s$, denoted $G_{v \\to y}(s)$, where $Y(s) = G_{v \\to y}(s) V(s)$ under zero initial conditions. Then, by analyzing the derived expression, identify any finite zeros introduced by the observer dynamics and explain qualitatively how their locations depend on the observer gain $L$.\n\nYour final answer must be the single analytic expression for $G_{v \\to y}(s)$ in closed form. No numerical rounding is required and no units are needed.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim:\n- Plant model: $\\dot{x}(t) = A x(t) + B u(t)$, $y(t) = C x(t)$\n- Plant matrices: $A = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$\n- Measured output: $y_{m}(t) = y(t) + v(t)$\n- Control law: $u(t) = -K \\hat{x}(t)$\n- Observer dynamics: $\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big)$\n- Gain matrices: $K = \\begin{pmatrix} 6 & 4 \\end{pmatrix}$, $L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}$\n- Initial conditions: $x(0)=0$ and $\\hat{x}(0)=0$.\n- Objective: Derive the transfer function $G_{v \\to y}(s) = Y(s)/V(s)$ and analyze the zeros introduced by the observer.\n\nThe validation is performed. The problem is scientifically grounded in established principles of linear control theory, specifically the design of observer-based state-feedback controllers. It is well-posed, with all necessary data and definitions provided for a unique solution to be derived. The problem is objective and uses precise, standard terminology. No contradictions, ambiguities, or factual unsoundness are present. Therefore, the problem is deemed valid and a solution will be furnished.\n\nThe derivation will proceed from first principles using state-space analysis, which is the most rigorous method. The overall closed-loop system dynamics are described by the plant state $x(t)$ and the observer state $\\hat{x}(t)$. A more insightful representation is achieved using the plant state $x(t)$ and the estimation error $e(t) = x(t) - \\hat{x}(t)$.\n\nFirst, we derive the dynamics of the estimation error $e(t)$.\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\nSubstituting the given equations for $\\dot{x}(t)$ and $\\dot{\\hat{x}}(t)$:\n$$ \\dot{e}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(y_m(t) - C\\hat{x}(t))\\big) $$\nThe terms $B u(t)$ cancel. We substitute $y_m(t) = y(t) + v(t) = C x(t) + v(t)$:\n$$ \\dot{e}(t) = A x(t) - A \\hat{x}(t) - L\\big(C x(t) + v(t) - C\\hat{x}(t)\\big) $$\nGrouping terms with $x(t)$ and $\\hat{x}(t)$:\n$$ \\dot{e}(t) = A \\big(x(t) - \\hat{x}(t)\\big) - L C \\big(x(t) - \\hat{x}(t)\\big) - L v(t) $$\nRecognizing $e(t) = x(t) - \\hat{x}(t)$, we obtain the error dynamics:\n$$ \\dot{e}(t) = (A - LC) e(t) - L v(t) $$\nThis equation shows that the error dynamics are driven by the measurement noise $v(t)$ and are independent of the state $x(t)$, a key feature of the Luenberger observer.\n\nNext, we derive the dynamics of the plant state $x(t)$ under feedback. The control law is $u(t) = -K \\hat{x}(t)$. We express $\\hat{x}(t)$ as $x(t) - e(t)$.\n$$ u(t) = -K (x(t) - e(t)) $$\nSubstituting this into the plant state equation:\n$$ \\dot{x}(t) = A x(t) + B u(t) = A x(t) - B K (x(t) - e(t)) $$\n$$ \\dot{x}(t) = (A - BK) x(t) + BK e(t) $$\nThe state dynamics depend on both the state $x(t)$ and the estimation error $e(t)$.\n\nWe now have a combined state-space system in terms of the state vector $\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$:\n$$ \\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -L \\end{pmatrix} v(t) $$\nThe output equation is $y(t) = C x(t) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$.\n\nThe block-triangular structure of the system matrix demonstrates the separation principle: the poles of the closed-loop system are the union of the controller poles (eigenvalues of $A-BK$) and the observer poles (eigenvalues of $A-LC$).\n\nWe apply the Laplace transform to these equations, with zero initial conditions:\n$$ sX(s) = (A-BK)X(s) + BKE(s) $$\n$$ sE(s) = (A-LC)E(s) - LV(s) $$\n$$ Y(s) = CX(s) $$\n\nFrom the second equation, we solve for $E(s)$:\n$$ (sI - (A-LC))E(s) = -LV(s) \\implies E(s) = -(sI - A + LC)^{-1} L V(s) $$\nFrom the first equation, we solve for $X(s)$:\n$$ (sI - (A-BK))X(s) = BKE(s) \\implies X(s) = (sI - A + BK)^{-1} BKE(s) $$\nSubstituting the expression for $E(s)$ into the one for $X(s)$:\n$$ X(s) = -(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\nFinally, we find the output $Y(s)$:\n$$ Y(s) = CX(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\nThe transfer function $G_{v \\to y}(s) = Y(s)/V(s)$ is therefore:\n$$ G_{v \\to y}(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L $$\nNow, we substitute the given numerical matrices.\n\nFirst, calculate the controller matrix $A_c = A-BK$:\n$$ BK = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} $$\n$$ A_c = A - BK = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -10 & -7 \\end{pmatrix} $$\nThe characteristic polynomial for the controller is $\\det(sI - A_c) = \\det\\begin{pmatrix} s & -1 \\\\ 10 & s+7 \\end{pmatrix} = s(s+7) + 10 = s^2 + 7s + 10$.\n\nNext, calculate the observer matrix $A_o = A-LC$:\n$$ LC = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 10 & 0 \\\\ 8 & 0 \\end{pmatrix} $$\n$$ A_o = A - LC = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix} - \\begin{pmatrix} 10 & 0 \\\\ 8 & 0 \\end{pmatrix} = \\begin{pmatrix} -10 & 1 \\\\ -12 & -3 \\end{pmatrix} $$\nThe characteristic polynomial for the observer is $\\det(sI - A_o) = \\det\\begin{pmatrix} s+10 & -1 \\\\ 12 & s+3 \\end{pmatrix} = (s+10)(s+3) + 12 = s^2 + 13s + 30 + 12 = s^2 + 13s + 42$.\n\nThe denominator of $G_{v \\to y}(s)$ is the product of these two characteristic polynomials:\n$$ D(s) = (s^2 + 7s + 10)(s^2 + 13s + 42) = s^4 + 20s^3 + 143s^2 + 424s + 420 $$\nThe numerator is $N(s) = -C \\cdot \\text{adj}(sI - A_c) \\cdot BK \\cdot \\text{adj}(sI - A_o) \\cdot L$.\n$$ \\text{adj}(sI - A_c) = \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} $$\n$$ \\text{adj}(sI - A_o) = \\begin{pmatrix} s+3 & 1 \\\\ -12 & s+10 \\end{pmatrix} $$\nWe compute the product of terms:\nLet $T_1 = C \\cdot \\text{adj}(sI - A_c) = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} = \\begin{pmatrix} s+7 & 1 \\end{pmatrix}$.\nLet $T_2 = \\text{adj}(sI - A_o) \\cdot L = \\begin{pmatrix} s+3 & 1 \\\\ -12 & s+10 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} 10(s+3) + 8 \\\\ -120 + 8(s+10) \\end{pmatrix} = \\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix}$.\nThe numerator is $N(s) = -T_1 \\cdot BK \\cdot T_2$. This grouping is incorrect. A correct calculation is:\n$$ N(s) = -\\big(C \\cdot \\text{adj}(sI - A_c)\\big) \\cdot BK \\cdot \\big(\\text{adj}(sI - A_o) \\cdot L) $$\nThis is still not right. Products must be taken in order.\n$$ N(s) = - C \\cdot \\text{adj}(sI - A_c) \\cdot BK \\cdot \\text{adj}(sI - A_o) \\cdot L $$\nLet's compute $M = \\text{adj}(sI - A_c) \\cdot BK \\cdot \\text{adj}(sI - A_o)$:\n$$ M_1 = \\text{adj}(sI - A_c) \\cdot BK = \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 6 & 4 \\\\ 6s & 4s \\end{pmatrix} $$\n$$ M = M_1 \\cdot \\text{adj}(sI - A_o) = \\begin{pmatrix} 6 & 4 \\\\ 6s & 4s \\end{pmatrix} \\begin{pmatrix} s+3 & 1 \\\\ -12 & s+10 \\end{pmatrix} = \\begin{pmatrix} 6(s+3)-48 & 6+4(s+10) \\\\ 6s(s+3)-48s & 6s+4s(s+10) \\end{pmatrix} = \\begin{pmatrix} 6s-30 & 4s+46 \\\\ 6s^2-30s & 4s^2+46s \\end{pmatrix} $$\nNow, $N(s) = - C \\cdot M \\cdot L$:\n$$ N(s) = -\\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 6s-30 & 4s+46 \\\\ \\dots & \\dots \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} = -\\begin{pmatrix} 6s-30 & 4s+46 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} $$\n$$ N(s) = - \\big( 10(6s-30) + 8(4s+46) \\big) = - (60s - 300 + 32s + 368) = -(92s+68) $$\nThus, the transfer function is:\n$$ G_{v \\to y}(s) = \\frac{-(92s+68)}{s^4 + 20s^3 + 143s^2 + 424s + 420} $$\n\nFor the second part of the question, we analyze this expression. The transfer function has a single finite zero at the root of the numerator, $s_z$, where $92s_z + 68 = 0$, which gives $s_z = -68/92 = -17/23$.\nThis zero is not present in the original plant, which has a transfer function $P(s) = C(sI-A)^{-1}B = \\frac{1}{s^2+3s+4}$ and no finite zeros. The zero is introduced by the controller-observer combination.\nThe zero of $G_{v \\to y}(s)$ is the zero of the dynamic compensator transfer function, $C_K(s)$, which maps the measured output $y_m$ to the control input $u$. This compensator is given by $C_K(s) = -K(sI - A + BK + LC)^{-1}L$. The zeros of $C_K(s)$ are the roots of the numerator polynomial $-K \\cdot \\text{adj}(sI - A + BK + LC) \\cdot L$.\nOur explicit calculation of this numerator was $N(s) = -(92s+68)$. We can see that its coefficients depend on the product of gain elements from $K$ and $L$. For instance, the coefficient of $s$ is $k_1l_1+k_2l_2=6(10)+4(8)=92$. The location of the zero is a ratio of two linear combinations of the observer gains $l_1$ and $l_2$. Therefore, the location of this zero is directly manipulated by the choice of the observer gain matrix $L$. Varying $L$ reshapes the numerator polynomial of the compensator and, consequently, shifts the transmission zero from the measurement noise to the plant output.", "answer": "$$ \\boxed{\\frac{-92s-68}{s^4 + 20s^3 + 143s^2 + 424s + 420}} $$", "id": "2755436"}, {"introduction": "Effective controller design often involves focusing only on the essential dynamics of a system. This exercise introduces the concept of structural reduction by applying the Kalman decomposition to a state-space model. The goal is to isolate the controllable and observable subspace, which exclusively determines the system's input-output transfer function. By completing this analysis [@problem_id:2755429], you will determine the minimal order required for an observer, a crucial step in designing efficient, reduced-order estimators that are fundamental to modern control practice.", "problem": "Consider the Linear Time-Invariant (LTI) plant given by the state-space realization with state vector $x \\in \\mathbb{R}^{5}$, input $u \\in \\mathbb{R}$, and output $y \\in \\mathbb{R}$:\n$$\nA \\;=\\; \\begin{bmatrix}\n0 & 1 & 0 & 0 & 0\\\\\n-2 & -3 & 0 & 0 & 0\\\\\n0 & 0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & -4 & 0\\\\\n0 & 0 & 0 & 0 & -5\n\\end{bmatrix},\\quad\nB \\;=\\; \\begin{bmatrix}\n0\\\\\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{bmatrix},\\quad\nC \\;=\\; \\begin{bmatrix}\n1 & 0 & 0 & 1 & 0\n\\end{bmatrix},\\quad\nD \\;=\\; 0.\n$$\nYou are asked to determine the smallest observer order that preserves all closed-loop transfer maps involving the plantâ€™s measured output $y$ and applied input $u$. Proceed as follows:\n- Starting from the definitions of controllability and observability subspaces, perform a Kalman decomposition of the plant by identifying the controllable/observable, controllable/unobservable, uncontrollable/observable, and uncontrollable/unobservable components of the state.\n- Using only fundamental definitions, determine which state components contribute to the input-output transfer behavior between $u$ and $y$.\n- Based on your decomposition, identify the smallest observer order that preserves all closed-loop transfer maps whose external signals are $y$ and $u$.\n\nYour final answer must be a single integer equal to this smallest observer order. No rounding is required and no units are involved. Provide the final answer as instructed.", "solution": "The problem as stated is well-defined, self-contained, and grounded in the fundamental principles of linear control theory. It is a valid problem and we shall proceed to find the solution.\n\nThe core of the problem lies in the Kalman decomposition of the state space $\\mathbb{R}^{n}$, where $n=5$. This decomposition partitions the state space into four orthogonal subspaces based on the properties of controllability and observability:\n$1$. The controllable and observable subspace, $X_{co}$.\n$2$. The controllable and unobservable subspace, $X_{c\\bar{o}}$.\n$3$. The uncontrollable and observable subspace, $X_{\\bar{c}o}$.\n$4$. The uncontrollable and unobservable subspace, $X_{\\bar{c}\\bar{o}}$.\n\nThe transfer function mapping the input $u$ to the output $y$, given by $G(s) = C(sI-A)^{-1}B + D$, is determined exclusively by the dynamics of the controllable and observable subspace, $X_{co}$. The order of the minimal state-space realization of $G(s)$, known as the McMillan degree, is equal to the dimension of $X_{co}$.\n\nThe problem asks for the smallest observer order required to preserve all closed-loop transfer maps involving the input $u$ and the output $y$. Any controller that shapes the input-output behavior can only be designed based on the system's minimal realization. To implement such a controller using an observer-based feedback structure, one must estimate the states of this minimal realization. Consequently, the minimum required order for such an observer is the dimension of the controllable and observable subspace, $\\dim(X_{co})$.\n\nOur task is to find this dimension. We begin by analyzing the controllability and observability of the system. The state matrix $A$ and the input and output matrices $B$ and $C$ are given as:\n$$\nA \\;=\\; \\begin{bmatrix}\n0 & 1 & 0 & 0 & 0\\\\\n-2 & -3 & 0 & 0 & 0\\\\\n0 & 0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & -4 & 0\\\\\n0 & 0 & 0 & 0 & -5\n\\end{bmatrix},\\quad\nB \\;=\\; \\begin{bmatrix}\n0\\\\\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{bmatrix},\\quad\nC \\;=\\; \\begin{bmatrix}\n1 & 0 & 0 & 1 & 0\n\\end{bmatrix}\n$$\nThe matrix $A$ is block-diagonal. This structure permits a modal analysis of controllability and observability. Let us define the state vector as $x = [x_1, x_2, x_3, x_4, x_5]^T$. The system can be decomposed into four subsystems associated with the blocks of $A$:\nSubsystem $1$: States $(x_1, x_2)$.\n$A_1 = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$, $B_1 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, $C_1 = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$.\nSubsystem $2$: State $x_3$.\n$A_2 = [-1]$, $B_2 = [1]$, $C_2 = [0]$.\nSubsystem $3$: State $x_4$.\n$A_3 = [-4]$, $B_3 = [0]$, $C_3 = [1]$.\nSubsystem $4$: State $x_5$.\n$A_4 = [-5]$, $B_4 = [0]$, $C_4 = [0]$.\n\nFirst, we determine the controllable subspace, $\\mathcal{R}(\\mathcal{C})$, which is the span of the states corresponding to the controllable subsystems.\n- For Subsystem $1$, the controllability matrix is $\\mathcal{C}_1 = [B_1 \\ A_1B_1] = \\begin{bmatrix} 0 & 1 \\\\ 1 & -3 \\end{bmatrix}$. Since $\\det(\\mathcal{C}_1) = -1 \\neq 0$, this subsystem is controllable. The states $x_1$ and $x_2$ are controllable.\n- For Subsystem $2$, we have a scalar system with $B_2 = 1 \\neq 0$. This subsystem is controllable. The state $x_3$ is controllable.\n- For Subsystem $3$, $B_3 = 0$. This subsystem is uncontrollable. The state $x_4$ is uncontrollable.\n- For Subsystem $4$, $B_4 = 0$. This subsystem is uncontrollable. The state $x_5$ is uncontrollable.\nThe controllable subspace is therefore spanned by the basis vectors corresponding to the controllable states:\n$\\mathcal{R}(\\mathcal{C}) = \\text{span}\\{e_1, e_2, e_3\\}$, where $e_i$ is the $i$-th standard basis vector in $\\mathbb{R}^{5}$. The dimension of the controllable subspace is $3$.\n\nNext, we determine the observable subspace, which is the orthogonal complement of the unobservable subspace $\\mathcal{N}(\\mathcal{O})$. We analyze the observability of each subsystem.\n- For Subsystem $1$, the observability matrix is $\\mathcal{O}_1 = \\begin{bmatrix} C_1 \\\\ C_1A_1 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$. Since $\\det(\\mathcal{O}_1) = 1 \\neq 0$, this subsystem is observable. The states $x_1$ and $x_2$ are observable.\n- For Subsystem $2$, $C_2 = 0$. This subsystem is unobservable. The state $x_3$ is unobservable.\n- For Subsystem $3$, we have a scalar system with $C_3 = 1 \\neq 0$. This subsystem is observable. The state $x_4$ is observable.\n- For Subsystem $4$, $C_4 = 0$. This subsystem is unobservable. The state $x_5$ is unobservable.\nThe unobservable subspace is spanned by the basis vectors corresponding to the unobservable states:\n$\\mathcal{N}(\\mathcal{O}) = \\text{span}\\{e_3, e_5\\}$.\nThe observable subspace is the orthogonal complement, $\\mathcal{R}(\\mathcal{O}^T) = \\mathcal{N}(\\mathcal{O})^\\perp = \\text{span}\\{e_1, e_2, e_4\\}$. The dimension of the observable subspace is $3$.\n\nNow we perform the Kalman decomposition by finding the intersections of these subspaces.\n- The controllable and observable subspace is $X_{co} = \\mathcal{R}(\\mathcal{C}) \\cap \\mathcal{R}(\\mathcal{O}^T) = \\text{span}\\{e_1, e_2, e_3\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_1, e_2\\}$.\n- The controllable and unobservable subspace is $X_{c\\bar{o}} = \\mathcal{R}(\\mathcal{C}) \\cap \\mathcal{N}(\\mathcal{O}) = \\text{span}\\{e_1, e_2, e_3\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_3\\}$.\n- The uncontrollable and observable subspace is $X_{\\bar{c}o} = \\mathcal{R}(\\mathcal{C})^\\perp \\cap \\mathcal{R}(\\mathcal{O}^T) = \\text{span}\\{e_4, e_5\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_4\\}$.\n- The uncontrollable and unobservable subspace is $X_{\\bar{c}\\bar{o}} = \\mathcal{R}(\\mathcal{C})^\\perp \\cap \\mathcal{N}(\\mathcal{O}) = \\text{span}\\{e_4, e_5\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_5\\}$.\n\nThe dimension of the controllable and observable subspace is $\\dim(X_{co}) = 2$.\nAs reasoned earlier, this dimension corresponds to the McMillan degree of the system's transfer function $G(s)$ and represents the order of the minimal realization. A minimal-order observer designed to implement any I/O-based controller must estimate the states of this minimal realization.\n\nTherefore, the smallest observer order that preserves all closed-loop transfer maps involving $u$ and $y$ is equal to the dimension of the controllable and observable subspace.\n$\\text{Smallest observer order} = \\dim(X_{co}) = 2$.", "answer": "$$\n\\boxed{2}\n$$", "id": "2755429"}]}